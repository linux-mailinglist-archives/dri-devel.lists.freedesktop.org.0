Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 24C5136F7D0
	for <lists+dri-devel@lfdr.de>; Fri, 30 Apr 2021 11:25:23 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CE4306F50D;
	Fri, 30 Apr 2021 09:25:15 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x532.google.com (mail-ed1-x532.google.com
 [IPv6:2a00:1450:4864:20::532])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 31D006F503
 for <dri-devel@lists.freedesktop.org>; Fri, 30 Apr 2021 09:25:12 +0000 (UTC)
Received: by mail-ed1-x532.google.com with SMTP id h10so81801468edt.13
 for <dri-devel@lists.freedesktop.org>; Fri, 30 Apr 2021 02:25:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=0l02agDnOuVLB+MouQtP5QkSpgJ0lhF+vC/Ibhz6sX8=;
 b=SBWtMIkUHLbKs+fw3ZlE8flxmHrc1zABfH3090knFVll31bEiDadHhSuDUrDD5IcLj
 8Vcwc7NkbZBugtx4JFuUFhMrnjdrEhvkrctj7KpkdqIE/TBSgMdaTuRbTkcyv8gY94rg
 AWEdQDNtztYpCCZll7s5LjF4SxNR7yVVlbGrhdnKyrl6ml/7j/arhswrVJxGli/GUuZp
 Af97dqvnUjFjIYWFsuLMfugk4Jmyr2JuCjO6mHQdierXNr2rOmvZck0Zr5YKb3QKvPZ9
 2eGRi/dWpy3og6xB5B5SkjcHGdoc4WHckyfd4V4cleEzkvpkhwjIER1CqSVaf3YMyTrp
 /3/w==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=0l02agDnOuVLB+MouQtP5QkSpgJ0lhF+vC/Ibhz6sX8=;
 b=Z6nynYqy/dtoUHfRk+z93HnKP2v30lDVvwsd+mQ5i3IkzXqDHqb561fiZCU+r4vM9S
 ce/emV4jEORz8LOTOUfv5Vhgzb33vOoltqzLeToebOR4NGmBgGazGHPP+aNJvfMo5HVE
 V5uSaAwxlSO82UAI6ZENpkfmu0VGmoOwT4N5W99fDiayaESOuNQWGIs7Nn/27WBZ0FUp
 FLHpmHMAWdVkIPDly0oLc6BkO4TOS2X3I236ko+MsO26+C1OI2GJs8sl6fogVnvs0d9x
 n3vqs0ymQsIX7PY4gML/WAiBmACh013Q/Ct9GYtuObV2vbSMp41vFoBR9IACGPxPfGjR
 Un8g==
X-Gm-Message-State: AOAM533+5A/2fbkBTfFcp54zqI7T4211Evji/EEKtNt7mSTHQR+SIxTA
 hkUXaQz6g820yX77xXPq8TFNPSyDAjw=
X-Google-Smtp-Source: ABdhPJyJQpYThR5eR569GmcsWp7LDGYohI5CmFtE9vDQT/BMFFcgn/Fh1aJKgBjm+W3y4gCBHbKPXg==
X-Received: by 2002:a05:6402:35c9:: with SMTP id
 z9mr4690731edc.94.1619774710933; 
 Fri, 30 Apr 2021 02:25:10 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:d08c:9633:b7a2:37e2])
 by smtp.gmail.com with ESMTPSA id h23sm1550959ejx.90.2021.04.30.02.25.10
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 30 Apr 2021 02:25:10 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 02/13] drm/ttm: always initialize the full ttm_resource
Date: Fri, 30 Apr 2021 11:24:57 +0200
Message-Id: <20210430092508.60710-2-christian.koenig@amd.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20210430092508.60710-1-christian.koenig@amd.com>
References: <20210430092508.60710-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: daniel.vetter@ffwll.ch, matthew.william.auld@gmail.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW5pdCBhbGwgZmllbGRzIGluIHR0bV9yZXNvdXJjZV9hbGxvYygpIHdoZW4gd2UgY3JlYXRlIGEg
bmV3IHJlc291cmNlLgoKU2lnbmVkLW9mZi1ieTogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0aWFu
LmtvZW5pZ0BhbWQuY29tPgpSZXZpZXdlZC1ieTogTWF0dGhldyBBdWxkIDxtYXR0aGV3LmF1bGRA
aW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYyB8
ICAyIC0tCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5jICAgICAgICAgICAgfCAyNiArKysr
LS0tLS0tLS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGlsLmMg
ICAgICAgfCAgNCArKy0tCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9yZXNvdXJjZS5jICAgICAg
fCAgOSArKysrKysrKysKIDQgZmlsZXMgY2hhbmdlZCwgMTUgaW5zZXJ0aW9ucygrKSwgMjYgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X3R0bS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jCmluZGV4IDdi
YTc2MWU4MzNiYS4uMmY3NTgwZDJlZTcxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfdHRtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X3R0bS5jCkBAIC0xMDE1LDggKzEwMTUsNiBAQCBpbnQgYW1kZ3B1X3R0bV9hbGxvY19nYXJ0
KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8pCiAJfSBlbHNlIHsKIAogCQkvKiBhbGxvY2F0
ZSBHQVJUIHNwYWNlICovCi0JCXRtcCA9IGJvLT5tZW07Ci0JCXRtcC5tbV9ub2RlID0gTlVMTDsK
IAkJcGxhY2VtZW50Lm51bV9wbGFjZW1lbnQgPSAxOwogCQlwbGFjZW1lbnQucGxhY2VtZW50ID0g
JnBsYWNlbWVudHM7CiAJCXBsYWNlbWVudC5udW1fYnVzeV9wbGFjZW1lbnQgPSAxOwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm8uYyBiL2RyaXZlcnMvZ3B1L2RybS90dG0v
dHRtX2JvLmMKaW5kZXggZGY2M2EwN2E3MGRlLi41NWYxZGRjZjIyYjYgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1f
Ym8uYwpAQCAtNTA3LDExICs1MDcsNiBAQCBzdGF0aWMgaW50IHR0bV9ib19ldmljdChzdHJ1Y3Qg
dHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQlyZXR1cm4gdHRtX3R0X2NyZWF0ZShibywgZmFsc2Up
OwogCX0KIAotCWV2aWN0X21lbSA9IGJvLT5tZW07Ci0JZXZpY3RfbWVtLm1tX25vZGUgPSBOVUxM
OwotCWV2aWN0X21lbS5idXMub2Zmc2V0ID0gMDsKLQlldmljdF9tZW0uYnVzLmFkZHIgPSBOVUxM
OwotCiAJcmV0ID0gdHRtX2JvX21lbV9zcGFjZShibywgJnBsYWNlbWVudCwgJmV2aWN0X21lbSwg
Y3R4KTsKIAlpZiAocmV0KSB7CiAJCWlmIChyZXQgIT0gLUVSRVNUQVJUU1lTKSB7CkBAIC04Njcs
MTIgKzg2Miw4IEBAIHN0YXRpYyBpbnQgdHRtX2JvX2JvdW5jZV90ZW1wX2J1ZmZlcihzdHJ1Y3Qg
dHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQkJCSAgICAgc3RydWN0IHR0bV9wbGFjZSAqaG9wKQog
ewogCXN0cnVjdCB0dG1fcGxhY2VtZW50IGhvcF9wbGFjZW1lbnQ7CisJc3RydWN0IHR0bV9yZXNv
dXJjZSBob3BfbWVtOwogCWludCByZXQ7Ci0Jc3RydWN0IHR0bV9yZXNvdXJjZSBob3BfbWVtID0g
Km1lbTsKLQotCWhvcF9tZW0ubW1fbm9kZSA9IE5VTEw7Ci0JaG9wX21lbS5tZW1fdHlwZSA9IFRU
TV9QTF9TWVNURU07Ci0JaG9wX21lbS5wbGFjZW1lbnQgPSAwOwogCiAJaG9wX3BsYWNlbWVudC5u
dW1fcGxhY2VtZW50ID0gaG9wX3BsYWNlbWVudC5udW1fYnVzeV9wbGFjZW1lbnQgPSAxOwogCWhv
cF9wbGFjZW1lbnQucGxhY2VtZW50ID0gaG9wX3BsYWNlbWVudC5idXN5X3BsYWNlbWVudCA9IGhv
cDsKQEAgLTg5NCwxOSArODg1LDE0IEBAIHN0YXRpYyBpbnQgdHRtX2JvX21vdmVfYnVmZmVyKHN0
cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJCQkgICAgICBzdHJ1Y3QgdHRtX3BsYWNlbWVu
dCAqcGxhY2VtZW50LAogCQkJICAgICAgc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4ICpjdHgpCiB7
Ci0JaW50IHJldCA9IDA7CiAJc3RydWN0IHR0bV9wbGFjZSBob3A7CiAJc3RydWN0IHR0bV9yZXNv
dXJjZSBtZW07CisJaW50IHJldDsKIAogCWRtYV9yZXN2X2Fzc2VydF9oZWxkKGJvLT5iYXNlLnJl
c3YpOwogCiAJbWVtc2V0KCZob3AsIDAsIHNpemVvZihob3ApKTsKIAotCW1lbS5udW1fcGFnZXMg
PSBQQUdFX0FMSUdOKGJvLT5iYXNlLnNpemUpID4+IFBBR0VfU0hJRlQ7Ci0JbWVtLmJ1cy5vZmZz
ZXQgPSAwOwotCW1lbS5idXMuYWRkciA9IE5VTEw7Ci0JbWVtLm1tX25vZGUgPSBOVUxMOwotCiAJ
LyoKIAkgKiBEZXRlcm1pbmUgd2hlcmUgdG8gbW92ZSB0aGUgYnVmZmVyLgogCSAqCkBAIC0xMDI3
LDYgKzEwMTMsNyBAQCBpbnQgdHRtX2JvX2luaXRfcmVzZXJ2ZWQoc3RydWN0IHR0bV9kZXZpY2Ug
KmJkZXYsCiAJCQkgc3RydWN0IGRtYV9yZXN2ICpyZXN2LAogCQkJIHZvaWQgKCpkZXN0cm95KSAo
c3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICopKQogeworCXN0YXRpYyBjb25zdCBzdHJ1Y3QgdHRt
X3BsYWNlIHN5c19tZW0gPSB7IC5tZW1fdHlwZSA9IFRUTV9QTF9TWVNURU0gfTsKIAlib29sIGxv
Y2tlZDsKIAlpbnQgcmV0ID0gMDsKIApAQCAtMTAzOCwxMyArMTAyNSw4IEBAIGludCB0dG1fYm9f
aW5pdF9yZXNlcnZlZChzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwKIAliby0+YmRldiA9IGJkZXY7
CiAJYm8tPnR5cGUgPSB0eXBlOwogCWJvLT5wYWdlX2FsaWdubWVudCA9IHBhZ2VfYWxpZ25tZW50
OwotCWJvLT5tZW0ubWVtX3R5cGUgPSBUVE1fUExfU1lTVEVNOwotCWJvLT5tZW0ubnVtX3BhZ2Vz
ID0gUEFHRV9BTElHTihzaXplKSA+PiBQQUdFX1NISUZUOwotCWJvLT5tZW0ubW1fbm9kZSA9IE5V
TEw7Ci0JYm8tPm1lbS5idXMub2Zmc2V0ID0gMDsKLQliby0+bWVtLmJ1cy5hZGRyID0gTlVMTDsK
Kwl0dG1fcmVzb3VyY2VfYWxsb2MoYm8sICZzeXNfbWVtLCAmYm8tPm1lbSk7CiAJYm8tPm1vdmlu
ZyA9IE5VTEw7Ci0JYm8tPm1lbS5wbGFjZW1lbnQgPSAwOwogCWJvLT5waW5fY291bnQgPSAwOwog
CWJvLT5zZyA9IHNnOwogCWlmIChyZXN2KSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
dHRtL3R0bV9ib191dGlsLmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGlsLmMKaW5k
ZXggZWZiN2U5YzM0YWI0Li5hZThiNjE0NjA3MjQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS90dG0vdHRtX2JvX3V0aWwuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGls
LmMKQEAgLTY2NCw2ICs2NjQsNyBAQCBFWFBPUlRfU1lNQk9MKHR0bV9ib19tb3ZlX2FjY2VsX2Ns
ZWFudXApOwogCiBpbnQgdHRtX2JvX3BpcGVsaW5lX2d1dHRpbmcoc3RydWN0IHR0bV9idWZmZXJf
b2JqZWN0ICpibykKIHsKKwlzdGF0aWMgY29uc3Qgc3RydWN0IHR0bV9wbGFjZSBzeXNfbWVtID0g
eyAubWVtX3R5cGUgPSBUVE1fUExfU1lTVEVNIH07CiAJc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0
ICpnaG9zdDsKIAlpbnQgcmV0OwogCkBAIC02NzYsOCArNjc3LDcgQEAgaW50IHR0bV9ib19waXBl
bGluZV9ndXR0aW5nKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8pCiAJaWYgKHJldCkKIAkJ
dHRtX2JvX3dhaXQoYm8sIGZhbHNlLCBmYWxzZSk7CiAKLQltZW1zZXQoJmJvLT5tZW0sIDAsIHNp
emVvZihiby0+bWVtKSk7Ci0JYm8tPm1lbS5tZW1fdHlwZSA9IFRUTV9QTF9TWVNURU07CisJdHRt
X3Jlc291cmNlX2FsbG9jKGJvLCAmc3lzX21lbSwgJmJvLT5tZW0pOwogCWJvLT50dG0gPSBOVUxM
OwogCiAJZG1hX3Jlc3ZfdW5sb2NrKCZnaG9zdC0+YmFzZS5fcmVzdik7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9yZXNvdXJjZS5jIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90
dG1fcmVzb3VyY2UuYwppbmRleCBmYzM1MTcwMGQwMzUuLmNlYzJlNmZiMWM1MiAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fcmVzb3VyY2UuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vdHRtL3R0bV9yZXNvdXJjZS5jCkBAIC0zMyw2ICszMywxNSBAQCBpbnQgdHRtX3Jlc291cmNl
X2FsbG9jKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJCXR0bV9tYW5hZ2VyX3R5cGUo
Ym8tPmJkZXYsIHJlcy0+bWVtX3R5cGUpOwogCiAJcmVzLT5tbV9ub2RlID0gTlVMTDsKKwlyZXMt
PnN0YXJ0ID0gMDsKKwlyZXMtPm51bV9wYWdlcyA9IFBGTl9VUChiby0+YmFzZS5zaXplKTsKKwly
ZXMtPm1lbV90eXBlID0gcGxhY2UtPm1lbV90eXBlOworCXJlcy0+cGxhY2VtZW50ID0gcGxhY2Ut
PmZsYWdzOworCXJlcy0+YnVzLmFkZHIgPSBOVUxMOworCXJlcy0+YnVzLm9mZnNldCA9IDA7CisJ
cmVzLT5idXMuaXNfaW9tZW0gPSBmYWxzZTsKKwlyZXMtPmJ1cy5jYWNoaW5nID0gdHRtX2NhY2hl
ZDsKKwogCXJldHVybiBtYW4tPmZ1bmMtPmFsbG9jKG1hbiwgYm8sIHBsYWNlLCByZXMpOwogfQog
Ci0tIAoyLjI1LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9y
ZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZl
bAo=
