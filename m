Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 9D1144ADA7
	for <lists+dri-devel@lfdr.de>; Wed, 19 Jun 2019 00:10:29 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6DAAE6E265;
	Tue, 18 Jun 2019 22:10:27 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ua1-x943.google.com (mail-ua1-x943.google.com
 [IPv6:2607:f8b0:4864:20::943])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 168986E265
 for <dri-devel@lists.freedesktop.org>; Tue, 18 Jun 2019 22:10:26 +0000 (UTC)
Received: by mail-ua1-x943.google.com with SMTP id 34so7692465uar.8
 for <dri-devel@lists.freedesktop.org>; Tue, 18 Jun 2019 15:10:26 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc:content-transfer-encoding;
 bh=JOxAk+z+pSo05o3ILvgyuqhb6qQtI6SCgUWBMEpVZio=;
 b=q7W9Z3Famv32VeZy3EGtiBIoSm38txeTXx1OJVfPWDOSXGQOPLHZAJrnPat2NeQw40
 p1N4f3Y4JtXmvqYKoPiMA4WjA/ZdFojfQBcDrkKC2PMJBToUB7LarupUIHXQblcShSf3
 TP2rXTSP6ENK6NTvkRa+Gvj9ro8KLK+5fSeHsbChBWtrlTNhiMQjh6yd2MdK8//XWXtB
 f0R4wQ40JfX36K+WO9g2ZO0uMJjHGZlmfhQxXZ+40CleBdQ/NSuHeo4FQhkfDOjYDkiI
 I3EnK3lsIQ+gfrUc6PwECXIiFNExX1UV+tIz39NECISKUVdenrBV82Pp2875W/PZIDqB
 NIgw==
X-Gm-Message-State: APjAAAXBC3nTpiFsTVxTpyMTe+86hmMfvtUghhlQiriZdd3IHcLPllHd
 L1soiC3Vz5zx44pICJr+lLe3tQY2sj6JaCtyA1k=
X-Google-Smtp-Source: APXvYqzH5eZ4P28bohxS3LyU2sUexAkQT2syBl355wSi/rtx0KsC9L34n6fH8hTzkFgDiprrDvyiQBjJ0AaS5oq63kc=
X-Received: by 2002:a9f:21d6:: with SMTP id 80mr33627112uac.60.1560895825096; 
 Tue, 18 Jun 2019 15:10:25 -0700 (PDT)
MIME-Version: 1.0
References: <cover.1560820888.git.rodrigosiqueiramelo@gmail.com>
 <4787369d4927fa709da050e7481e48102842fd97.1560820888.git.rodrigosiqueiramelo@gmail.com>
 <20190618093356.GR12905@phenom.ffwll.local>
In-Reply-To: <20190618093356.GR12905@phenom.ffwll.local>
From: Rodrigo Siqueira <rodrigosiqueiramelo@gmail.com>
Date: Tue, 18 Jun 2019 19:10:14 -0300
Message-ID: <CADKXj+4W8W-2UE0=r4p_dY9uwO_Suusigszq7B_U-rbU=tMHMg@mail.gmail.com>
Subject: Re: [PATCH V2 5/5] drm/vkms: Add support for writeback
To: Rodrigo Siqueira <rodrigosiqueiramelo@gmail.com>,
 Brian Starkey <brian.starkey@arm.com>, 
 Liviu Dudau <liviu.dudau@arm.com>, Haneen Mohammed <hamohammed.sa@gmail.com>, 
 Simon Ser <contact@emersion.fr>, dri-devel <dri-devel@lists.freedesktop.org>, 
 Linux Kernel Mailing List <linux-kernel@vger.kernel.org>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc:content-transfer-encoding;
 bh=JOxAk+z+pSo05o3ILvgyuqhb6qQtI6SCgUWBMEpVZio=;
 b=U0pGwNxg+KbdILSBlq2xQUmRsFjU2LnHbiTRcB/YLsBZ8uOsB0zV5+zKR/LH3KWJLR
 Tt+WzeKLz3iTnCvbRH/QHrvFg/JI4LZvBc1WvgIOR8IY6PBiRTDKcAbdS58Ns251a+Lt
 IrmTKf5zkgQFu70dJ5z30686n4j6dPvRUroj9Mj+H218Y9j42E2CyNT2HB0FVZJyFvOq
 usKjLWdY7BcxZQ6sUad5Zs3+/g1ZT1LnLkkJcLZTxqUR/XHOvBE9g7ObBovnDV6/cs85
 S7LNP7Ngl6fZZ4NtJ2aDBs9cdKNF2B5NpgT2WtpuA+jsLKnWk6VhHO4u0WtP4orlyvy3
 /qKg==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gVHVlLCBKdW4gMTgsIDIwMTkgYXQgNjozNCBBTSBEYW5pZWwgVmV0dGVyIDxkYW5pZWxAZmZ3
bGwuY2g+IHdyb3RlOgo+Cj4gT24gTW9uLCBKdW4gMTcsIDIwMTkgYXQgMTE6NDU6NTVQTSAtMDMw
MCwgUm9kcmlnbyBTaXF1ZWlyYSB3cm90ZToKPiA+IFRoaXMgcGF0Y2ggaW1wbGVtZW50cyB0aGUg
bmVjZXNzYXJ5IGZ1bmN0aW9ucyB0byBhZGQgd3JpdGViYWNrIHN1cHBvcnQKPiA+IGZvciB2a21z
LiBUaGlzIGZlYXR1cmUgaXMgdXNlZnVsIGZvciB0ZXN0aW5nIGNvbXBvc2l0b3JzIGlmIHlvdSBk
b24ndAo+ID4gaGF2ZSBoYXJkd2FyZSB3aXRoIHdyaXRlYmFjayBzdXBwb3J0Lgo+ID4KPiA+IENo
YW5nZSBpbiBWMjoKPiA+IC0gUmV3b3JrIHNpZ25hbCBjb21wbGV0aW9uIChCcmlhbikKPiA+IC0g
SW50ZWdyYXRlcyB3cml0ZWJhY2sgd2l0aCBhY3RpdmVfcGxhbmVzIChEYW5pZWwpCj4gPiAtIENv
bXBvc2UgY3Vyc29yIChEYW5pZWwpCj4KPiBOb3QgcXVpdGUgd2hhdCBJIGhhZCBpbiBtaW5kIC4u
LiBteSBpZGVhIHdhcyB0byByZXVzZSB0aGUgY3JjIHdvcmtlcgo+IChoZW5jZSByZW5hbWluZyBh
bGwgdGhhdCBzdHVmZiB0byB2a21zX2NvbXBvc2VyKS4gVGhlIHByb2JsZW0gaGVyZSBpcyB0aGF0
Cj4gbm93IHdlIGhhdmUgdGhlIGJsZW5kL2NvbXBvc2UgY29kZSBkdXBsaWNhdGVkLCBhdCBsZWFz
dCBwYXJ0cyBvZiBpdC4gUGx1cwo+IGlmIHlvdSBlbmFibGUgYm90aCBjcmMgYW5kIHdyaXRlYmFj
aywgdGhlbiB3ZSBjb21wb3NlIDJ4LCB3aGljaCBpcyBhIGJpdAo+IHRvbyBtdWNoLgo+Cj4gUm91
Z2ggc2tldGNoIG9mIGFuIGltcGxlbWVudGF0aW9uOgo+Cj4gLSBhZGQgd3JpdGViYWNrX3BlbmRp
bmcsIGxpa2Ugd2UgaGF2ZSBjcmNfcGVuZGluZyBhbHJlYWR5LiBEaWZmZXJlbmNlIGlzCj4gICB0
aGF0IHdyaXRlYmFjayBpcyBvbmUtc2hvdCwgaS5lLiBzZXQgaXQgaW4gYXRvbWljX2NoZWNrIHNv
bWV3aGVyZSwgY2xlYXIKPiAgIGl0IGluIHRoZSBjcmNfd29ya2VyICh3ZWxsLCBjb21wb3Nlcl93
b3JrZXIgbm93KS4gdmJsYW5rIGhydGltZXIgd2lsbAo+ICAgbm90IHJlLWVuYWJsZSB0aGF0IG9u
ZSAodW5saWtlIGNyY19wZW5kaW5nKS4KPgo+IC0gaW4gdGhlIGNyYyB3b3JrZXIsIGlmIHdyaXRl
YmFja19wZW5kaW5nIGlzIHNldCwgdGhlbiBjb21wb3NlIGV2ZXJ5dGhpbmcKPiAgIGludG8gdGhl
IHdyaXRlYmFjayBidWZmZXIgaW5zdGVhZCBvZiBpbnRvIG91ciBwcml2YXRlIGNyYyBidWZmZXIu
IEV4Y2VwdAo+ICAgdGhhdCB3ZSB1c2UgZGlmZmVyZW50IG1lbW9yeSwgY3JjIGNvbXB1dGF0aW9u
IHdpbGwgYmUgZG9uZSBleGFjdGx5IHRoZQo+ICAgc2FtZS4gRm9yIHN1YnNlcXVlbnQgZnJhbWVz
IHdpdGggdGhlIHNhbWUgY3J0Y19zdGF0ZSB3ZSB3aWxsIGFnYWluIHVzZQo+ICAgdGhlIG5vcm1h
bCBjcmMgYnVmZmVyIHRvIGNvbXBvc2UgJiBjb21wdXRlIHRoZSBjcmMuCj4KPiBUaGUgYmVuZWZp
dCBoZXJlIGlzIHRoYXQgd2UnbGwgb25seSBoYXZlIG9uZSBwbGFjZSBpbiB2a21zIHRoYXQgZG9l
cwo+IGNvbXBvc2luZywgc28gaWYgd2UgYWRkIGxvdHMgbW9yZSBmZWF0dXJlcyBpbiB0aGUgZnV0
dXJlLCBpdCdsbCBiZSBtdWNoCj4gZWFzaWVyIHRvIG1haW50YWluLiBBbHNvIHNpbmNlIHRoaXMg
Z3VhcmFudGVlcyB0aGF0IHRoZSBjcmMgd2lsbCBtYXRjaAo+IGV4YWN0bHkgd2hhdCB3ZSd2ZSB3
cml0dGVuIGJhY2ssIHdlIGNhbiB1c2UgdGhlIGNyYyB0byBoZWxwIHZhbGlkYXRlIG91cgo+IHdy
aXRlYmFjayBjb2RlLgoKVGhhbmtzIGZvciB5b3VyIHJldmlldyBhbmQgY29tbWVudHMsIEkgdGhp
bmsgdGhhdCBJIHVuZGVyc3Rvb2QgYWxsIG9mCnRoZW0uIEnigJlsbCBwcmVwYXJlIGEgVjMuCgo+
IENoZWVycywgRGFuaWVsCj4KPiA+Cj4gPiBTaWduZWQtb2ZmLWJ5OiBSb2RyaWdvIFNpcXVlaXJh
IDxyb2RyaWdvc2lxdWVpcmFtZWxvQGdtYWlsLmNvbT4KPiA+IC0tLQo+ID4gIGRyaXZlcnMvZ3B1
L2RybS92a21zL01ha2VmaWxlICAgICAgICAgfCAgIDMgKy0KPiA+ICBkcml2ZXJzL2dwdS9kcm0v
dmttcy92a21zX2Rydi5jICAgICAgIHwgICA3ICsrCj4gPiAgZHJpdmVycy9ncHUvZHJtL3ZrbXMv
dmttc19kcnYuaCAgICAgICB8ICAgNiArCj4gPiAgZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19v
dXRwdXQuYyAgICB8ICAgNiArCj4gPiAgZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc193cml0ZWJh
Y2suYyB8IDE2NiArKysrKysrKysrKysrKysrKysrKysrKysrKwo+ID4gIDUgZmlsZXMgY2hhbmdl
ZCwgMTg3IGluc2VydGlvbnMoKyksIDEgZGVsZXRpb24oLSkKPiA+ICBjcmVhdGUgbW9kZSAxMDA2
NDQgZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc193cml0ZWJhY2suYwo+ID4KPiA+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vdmttcy9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS92a21z
L01ha2VmaWxlCj4gPiBpbmRleCBiNGMwNDA4NTRiZDYuLjA5MWU2ZmE2NDNkMSAxMDA2NDQKPiA+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS92a21zL01ha2VmaWxlCj4gPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vdmttcy9NYWtlZmlsZQo+ID4gQEAgLTYsNiArNiw3IEBAIHZrbXMteSA6PSBcCj4gPiAg
ICAgICB2a21zX2NydGMubyBcCj4gPiAgICAgICB2a21zX2dlbS5vIFwKPiA+ICAgICAgIHZrbXNf
Y29tcG9zZXIubyBcCj4gPiAtICAgICB2a21zX2NyYy5vCj4gPiArICAgICB2a21zX2NyYy5vIFwK
PiA+ICsgICAgIHZrbXNfd3JpdGViYWNrLm8KPiA+Cj4gPiAgb2JqLSQoQ09ORklHX0RSTV9WS01T
KSArPSB2a21zLm8KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdmttcy92a21zX2Ry
di5jIGIvZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19kcnYuYwo+ID4gaW5kZXggOTY2YjNkNjUz
MTg5Li5kODcwNzc5YWJmOWQgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vdmttcy92
a21zX2Rydi5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vdmttcy92a21zX2Rydi5jCj4gPiBA
QCAtMzAsNiArMzAsMTAgQEAgYm9vbCBlbmFibGVfY3Vyc29yOwo+ID4gIG1vZHVsZV9wYXJhbV9u
YW1lZChlbmFibGVfY3Vyc29yLCBlbmFibGVfY3Vyc29yLCBib29sLCAwNDQ0KTsKPiA+ICBNT0RV
TEVfUEFSTV9ERVNDKGVuYWJsZV9jdXJzb3IsICJFbmFibGUvRGlzYWJsZSBjdXJzb3Igc3VwcG9y
dCIpOwo+ID4KPiA+ICtib29sIGVuYWJsZV93cml0ZWJhY2s7Cj4gPiArbW9kdWxlX3BhcmFtX25h
bWVkKGVuYWJsZV93cml0ZWJhY2ssIGVuYWJsZV93cml0ZWJhY2ssIGJvb2wsIDA0NDQpOwo+ID4g
K01PRFVMRV9QQVJNX0RFU0MoZW5hYmxlX3dyaXRlYmFjaywgIkVuYWJsZS9EaXNhYmxlIHdyaXRl
YmFjayBjb25uZWN0b3IiKTsKPiA+ICsKPiA+ICBzdGF0aWMgY29uc3Qgc3RydWN0IGZpbGVfb3Bl
cmF0aW9ucyB2a21zX2RyaXZlcl9mb3BzID0gewo+ID4gICAgICAgLm93bmVyICAgICAgICAgID0g
VEhJU19NT0RVTEUsCj4gPiAgICAgICAub3BlbiAgICAgICAgICAgPSBkcm1fb3BlbiwKPiA+IEBA
IC0xNTgsNiArMTYyLDkgQEAgc3RhdGljIGludCBfX2luaXQgdmttc19pbml0KHZvaWQpCj4gPiAg
ICAgICAgICAgICAgIGdvdG8gb3V0X2Zpbmk7Cj4gPiAgICAgICB9Cj4gPgo+ID4gKyAgICAgaWYg
KGVuYWJsZV93cml0ZWJhY2spCj4gPiArICAgICAgICAgICAgIERSTV9JTkZPKCJXcml0ZWJhY2sg
Y29ubmVjdG9yIGVuYWJsZWQiKTsKPiA+ICsKPiA+ICAgICAgIHJldCA9IHZrbXNfbW9kZXNldF9p
bml0KHZrbXNfZGV2aWNlKTsKPiA+ICAgICAgIGlmIChyZXQpCj4gPiAgICAgICAgICAgICAgIGdv
dG8gb3V0X2Zpbmk7Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19k
cnYuaCBiL2RyaXZlcnMvZ3B1L2RybS92a21zL3ZrbXNfZHJ2LmgKPiA+IGluZGV4IGFkNjNkYmU1
ZTk5NC4uYmYzZmE3MzdiM2Q3IDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL3ZrbXMv
dmttc19kcnYuaAo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19kcnYuaAo+ID4g
QEAgLTcsNiArNyw3IEBACj4gPiAgI2luY2x1ZGUgPGRybS9kcm0uaD4KPiA+ICAjaW5jbHVkZSA8
ZHJtL2RybV9nZW0uaD4KPiA+ICAjaW5jbHVkZSA8ZHJtL2RybV9lbmNvZGVyLmg+Cj4gPiArI2lu
Y2x1ZGUgPGRybS9kcm1fd3JpdGViYWNrLmg+Cj4gPiAgI2luY2x1ZGUgPGxpbnV4L2hydGltZXIu
aD4KPiA+Cj4gPiAgI2RlZmluZSBYUkVTX01JTiAgICAyMAo+ID4gQEAgLTE5LDYgKzIwLDcgQEAK
PiA+ICAjZGVmaW5lIFlSRVNfTUFYICA4MTkyCj4gPgo+ID4gIGV4dGVybiBib29sIGVuYWJsZV9j
dXJzb3I7Cj4gPiArZXh0ZXJuIGJvb2wgZW5hYmxlX3dyaXRlYmFjazsKPiA+Cj4gPiAgc3RydWN0
IHZrbXNfZGF0YSB7Cj4gPiAgICAgICBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyIGZiOwo+ID4gQEAg
LTYzLDYgKzY1LDcgQEAgc3RydWN0IHZrbXNfb3V0cHV0IHsKPiA+ICAgICAgIHN0cnVjdCBkcm1f
Y3J0YyBjcnRjOwo+ID4gICAgICAgc3RydWN0IGRybV9lbmNvZGVyIGVuY29kZXI7Cj4gPiAgICAg
ICBzdHJ1Y3QgZHJtX2Nvbm5lY3RvciBjb25uZWN0b3I7Cj4gPiArICAgICBzdHJ1Y3QgZHJtX3dy
aXRlYmFja19jb25uZWN0b3Igd2JfY29ubmVjdG9yOwo+ID4gICAgICAgc3RydWN0IGhydGltZXIg
dmJsYW5rX2hydGltZXI7Cj4gPiAgICAgICBrdGltZV90IHBlcmlvZF9uczsKPiA+ICAgICAgIHN0
cnVjdCBkcm1fcGVuZGluZ192YmxhbmtfZXZlbnQgKmV2ZW50Owo+ID4gQEAgLTE0Myw0ICsxNDYs
NyBAQCBpbnQgdmttc192ZXJpZnlfY3JjX3NvdXJjZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMsIGNv
bnN0IGNoYXIgKnNvdXJjZV9uYW1lLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVf
dCAqdmFsdWVzX2NudCk7Cj4gPiAgdm9pZCB2a21zX2NyY193b3JrX2hhbmRsZShzdHJ1Y3Qgd29y
a19zdHJ1Y3QgKndvcmspOwo+ID4KPiA+ICsvKiBXcml0ZWJhY2sgKi8KPiA+ICtpbnQgZW5hYmxl
X3dyaXRlYmFja19jb25uZWN0b3Ioc3RydWN0IHZrbXNfZGV2aWNlICp2a21zZGV2KTsKPiA+ICsK
PiA+ICAjZW5kaWYgLyogX1ZLTVNfRFJWX0hfICovCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL3ZrbXMvdmttc19vdXRwdXQuYyBiL2RyaXZlcnMvZ3B1L2RybS92a21zL3ZrbXNfb3V0
cHV0LmMKPiA+IGluZGV4IGZiMTk0MWE2NTIyYy4uM2IwOTNhZThmMzczIDEwMDY0NAo+ID4gLS0t
IGEvZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19vdXRwdXQuYwo+ID4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL3ZrbXMvdmttc19vdXRwdXQuYwo+ID4gQEAgLTg0LDYgKzg0LDEyIEBAIGludCB2a21z
X291dHB1dF9pbml0KHN0cnVjdCB2a21zX2RldmljZSAqdmttc2RldiwgaW50IGluZGV4KQo+ID4g
ICAgICAgICAgICAgICBnb3RvIGVycl9hdHRhY2g7Cj4gPiAgICAgICB9Cj4gPgo+ID4gKyAgICAg
aWYgKGVuYWJsZV93cml0ZWJhY2spIHsKPiA+ICsgICAgICAgICAgICAgcmV0ID0gZW5hYmxlX3dy
aXRlYmFja19jb25uZWN0b3Iodmttc2Rldik7Cj4gPiArICAgICAgICAgICAgIGlmIChyZXQpCj4g
PiArICAgICAgICAgICAgICAgICAgICAgRFJNX0VSUk9SKCJGYWlsZWQgdG8gaW5pdCB3cml0ZWJh
Y2sgY29ubmVjdG9yXG4iKTsKPiA+ICsgICAgIH0KPiA+ICsKPiA+ICAgICAgIGRybV9tb2RlX2Nv
bmZpZ19yZXNldChkZXYpOwo+ID4KPiA+ICAgICAgIHJldHVybiAwOwo+ID4gZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS92a21zL3ZrbXNfd3JpdGViYWNrLmMgYi9kcml2ZXJzL2dwdS9kcm0v
dmttcy92a21zX3dyaXRlYmFjay5jCj4gPiBuZXcgZmlsZSBtb2RlIDEwMDY0NAo+ID4gaW5kZXgg
MDAwMDAwMDAwMDAwLi41NjYzMmViMzkzY2IKPiA+IC0tLSAvZGV2L251bGwKPiA+ICsrKyBiL2Ry
aXZlcnMvZ3B1L2RybS92a21zL3ZrbXNfd3JpdGViYWNrLmMKPiA+IEBAIC0wLDAgKzEsMTY2IEBA
Cj4gPiArLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjArCj4gPiArCj4gPiArI2lu
Y2x1ZGUgInZrbXNfZHJ2LmgiCj4gPiArI2luY2x1ZGUgInZrbXNfY29tcG9zZXIuaCIKPiA+ICsj
aW5jbHVkZSA8ZHJtL2RybV93cml0ZWJhY2suaD4KPiA+ICsjaW5jbHVkZSA8ZHJtL2RybV9wcm9i
ZV9oZWxwZXIuaD4KPiA+ICsjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWNfaGVscGVyLmg+Cj4gPiAr
I2luY2x1ZGUgPGRybS9kcm1fZ2VtX2ZyYW1lYnVmZmVyX2hlbHBlci5oPgo+ID4gKwo+ID4gK3N0
YXRpYyBjb25zdCB1MzIgdmttc193Yl9mb3JtYXRzW10gPSB7Cj4gPiArICAgICBEUk1fRk9STUFU
X1hSR0I4ODg4LAo+ID4gK307Cj4gPiArCj4gPiArc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY29u
bmVjdG9yX2Z1bmNzIHZrbXNfd2JfY29ubmVjdG9yX2Z1bmNzID0gewo+ID4gKyAgICAgLmZpbGxf
bW9kZXMgPSBkcm1faGVscGVyX3Byb2JlX3NpbmdsZV9jb25uZWN0b3JfbW9kZXMsCj4gPiArICAg
ICAuZGVzdHJveSA9IGRybV9jb25uZWN0b3JfY2xlYW51cCwKPiA+ICsgICAgIC5yZXNldCA9IGRy
bV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9yZXNldCwKPiA+ICsgICAgIC5hdG9taWNfZHVwbGlj
YXRlX3N0YXRlID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2R1cGxpY2F0ZV9zdGF0ZSwK
PiA+ICsgICAgIC5hdG9taWNfZGVzdHJveV9zdGF0ZSA9IGRybV9hdG9taWNfaGVscGVyX2Nvbm5l
Y3Rvcl9kZXN0cm95X3N0YXRlLAo+ID4gK307Cj4gPiArCj4gPiArc3RhdGljIGludCB2a21zX3di
X2VuY29kZXJfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlciwKPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGRybV9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBz
dHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiA+ICt7Cj4gPiArICAgICBz
dHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYjsKPiA+ICsgICAgIGNvbnN0IHN0cnVjdCBkcm1fZGlz
cGxheV9tb2RlICptb2RlID0gJmNydGNfc3RhdGUtPm1vZGU7Cj4gPiArCj4gPiArICAgICBpZiAo
IWNvbm5fc3RhdGUtPndyaXRlYmFja19qb2IgfHwgIWNvbm5fc3RhdGUtPndyaXRlYmFja19qb2It
PmZiKQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gMDsKPiA+ICsKPiA+ICsgICAgIGZiID0gY29u
bl9zdGF0ZS0+d3JpdGViYWNrX2pvYi0+ZmI7Cj4gPiArICAgICBpZiAoZmItPndpZHRoICE9IG1v
ZGUtPmhkaXNwbGF5IHx8IGZiLT5oZWlnaHQgIT0gbW9kZS0+dmRpc3BsYXkpIHsKPiA+ICsgICAg
ICAgICAgICAgRFJNX0RFQlVHX0tNUygiSW52YWxpZCBmcmFtZWJ1ZmZlciBzaXplICV1eCV1XG4i
LAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgIGZiLT53aWR0aCwgZmItPmhlaWdodCk7
Cj4gPiArICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwo+ID4gKyAgICAgfQo+ID4gKwo+ID4g
KyAgICAgaWYgKGZiLT5mb3JtYXQtPmZvcm1hdCAhPSBEUk1fRk9STUFUX1hSR0I4ODg4KSB7Cj4g
PiArICAgICAgICAgICAgIHN0cnVjdCBkcm1fZm9ybWF0X25hbWVfYnVmIGZvcm1hdF9uYW1lOwo+
ID4gKwo+ID4gKyAgICAgICAgICAgICBEUk1fREVCVUdfS01TKCJJbnZhbGlkIHBpeGVsIGZvcm1h
dCAlc1xuIiwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICBkcm1fZ2V0X2Zvcm1hdF9u
YW1lKGZiLT5mb3JtYXQtPmZvcm1hdCwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICZmb3JtYXRfbmFtZSkpOwo+ID4gKyAgICAgICAgICAgICByZXR1
cm4gLUVJTlZBTDsKPiA+ICsgICAgIH0KPiA+ICsKPiA+ICsgICAgIHJldHVybiAwOwo+ID4gK30K
PiA+ICsKPiA+ICtzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9lbmNvZGVyX2hlbHBlcl9mdW5jcyB2
a21zX3diX2VuY29kZXJfaGVscGVyX2Z1bmNzID0gewo+ID4gKyAgICAgLmF0b21pY19jaGVjayA9
IHZrbXNfd2JfZW5jb2Rlcl9hdG9taWNfY2hlY2ssCj4gPiArfTsKPiA+ICsKPiA+ICtzdGF0aWMg
aW50IHZrbXNfd2JfY29ubmVjdG9yX2dldF9tb2RlcyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29u
bmVjdG9yKQo+ID4gK3sKPiA+ICsgICAgIHN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjb25uZWN0
b3ItPmRldjsKPiA+ICsKPiA+ICsgICAgIHJldHVybiBkcm1fYWRkX21vZGVzX25vZWRpZChjb25u
ZWN0b3IsIGRldi0+bW9kZV9jb25maWcubWF4X3dpZHRoLAo+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGRldi0+bW9kZV9jb25maWcubWF4X2hlaWdodCk7Cj4gPiArfQo+ID4g
Kwo+ID4gK3N0YXRpYyBpbnQgdmttc193Yl9wcmVwYXJlX2pvYihzdHJ1Y3QgZHJtX3dyaXRlYmFj
a19jb25uZWN0b3IgKndiX2Nvbm5lY3RvciwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgc3RydWN0IGRybV93cml0ZWJhY2tfam9iICpqb2IpCj4gPiArewo+ID4gKyAgICAgc3RydWN0
IHZrbXNfZ2VtX29iamVjdCAqdmttc19vYmo7Cj4gPiArICAgICBzdHJ1Y3QgZHJtX2dlbV9vYmpl
Y3QgKmdlbV9vYmo7Cj4gPiArICAgICBpbnQgcmV0Owo+ID4gKwo+ID4gKyAgICAgaWYgKCFqb2It
PmZiKQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gMDsKPiA+ICsKPiA+ICsgICAgIGdlbV9vYmog
PSBkcm1fZ2VtX2ZiX2dldF9vYmooam9iLT5mYiwgMCk7Cj4gPiArICAgICByZXQgPSB2a21zX2dl
bV92bWFwKGdlbV9vYmopOwo+ID4gKyAgICAgaWYgKHJldCkgewo+ID4gKyAgICAgICAgICAgICBE
Uk1fRVJST1IoInZtYXAgZmFpbGVkOiAlZFxuIiwgcmV0KTsKPiA+ICsgICAgICAgICAgICAgcmV0
dXJuIHJldDsKPiA+ICsgICAgIH0KPiA+ICsKPiA+ICsgICAgIHZrbXNfb2JqID0gZHJtX2dlbV90
b192a21zX2dlbShnZW1fb2JqKTsKPiA+ICsgICAgIGpvYi0+cHJpdiA9IHZrbXNfb2JqLT52YWRk
cjsKPiA+ICsKPiA+ICsgICAgIHJldHVybiAwOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9p
ZCB2a21zX3diX2NsZWFudXBfam9iKHN0cnVjdCBkcm1fd3JpdGViYWNrX2Nvbm5lY3RvciAqY29u
bmVjdG9yLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGRybV93cml0
ZWJhY2tfam9iICpqb2IpCj4gPiArewo+ID4gKyAgICAgc3RydWN0IGRybV9nZW1fb2JqZWN0ICpn
ZW1fb2JqOwo+ID4gKwo+ID4gKyAgICAgaWYgKCFqb2ItPmZiKQo+ID4gKyAgICAgICAgICAgICBy
ZXR1cm47Cj4gPiArCj4gPiArICAgICBnZW1fb2JqID0gZHJtX2dlbV9mYl9nZXRfb2JqKGpvYi0+
ZmIsIDApOwo+ID4gKyAgICAgdmttc19nZW1fdnVubWFwKGdlbV9vYmopOwo+ID4gK30KPiA+ICsK
PiA+ICtzdGF0aWMgdm9pZCB2a21zX3diX2F0b21pY19jb21taXQoc3RydWN0IGRybV9jb25uZWN0
b3IgKmNvbm4sCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBkcm1f
Y29ubmVjdG9yX3N0YXRlICpzdGF0ZSkKPiA+ICt7Cj4gPiArICAgICBzdHJ1Y3Qgdmttc19kZXZp
Y2UgKnZrbXNkZXYgPSBkcm1fZGV2aWNlX3RvX3ZrbXNfZGV2aWNlKGNvbm4tPmRldik7Cj4gPiAr
ICAgICBzdHJ1Y3Qgdmttc19vdXRwdXQgKm91dHB1dCA9ICZ2a21zZGV2LT5vdXRwdXQ7Cj4gPiAr
ICAgICBzdHJ1Y3Qgdmttc19jcnRjX3N0YXRlICpjcnRjX3N0YXRlID0gb3V0cHV0LT5jcmNfc3Rh
dGU7Cj4gPiArICAgICBzdHJ1Y3QgZHJtX3dyaXRlYmFja19jb25uZWN0b3IgKndiX2Nvbm4gPSAm
b3V0cHV0LT53Yl9jb25uZWN0b3I7Cj4gPiArICAgICBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0
ZSAqY29ubl9zdGF0ZSA9IHdiX2Nvbm4tPmJhc2Uuc3RhdGU7Cj4gPiArICAgICB2b2lkICpwcml2
X2RhdGEgPSBjb25uX3N0YXRlLT53cml0ZWJhY2tfam9iLT5wcml2Owo+ID4gKyAgICAgc3RydWN0
IHZrbXNfZGF0YSAqcHJpbWFyeV9kYXRhID0gTlVMTDsKPiA+ICsgICAgIHN0cnVjdCB2a21zX2Rh
dGEgKmN1cnNvcl9kYXRhID0gTlVMTDsKPiA+ICsgICAgIHN0cnVjdCBkcm1fZnJhbWVidWZmZXIg
KmZiID0gTlVMTDsKPiA+ICsgICAgIHN0cnVjdCB2a21zX2dlbV9vYmplY3QgKnZrbXNfb2JqOwo+
ID4gKyAgICAgc3RydWN0IGRybV9nZW1fb2JqZWN0ICpnZW1fb2JqOwo+ID4gKwo+ID4gKyAgICAg
aWYgKCFjb25uX3N0YXRlKQo+ID4gKyAgICAgICAgICAgICByZXR1cm47Cj4gPiArCj4gPiArICAg
ICBpZiAoIWNvbm5fc3RhdGUtPndyaXRlYmFja19qb2IgfHwgIWNvbm5fc3RhdGUtPndyaXRlYmFj
a19qb2ItPmZiKSB7Cj4gPiArICAgICAgICAgICAgIERSTV9ERUJVR19EUklWRVIoIkRpc2FibGUg
d3JpdGViYWNrXG4iKTsKPiA+ICsgICAgICAgICAgICAgcmV0dXJuOwo+ID4gKyAgICAgfQo+ID4g
Kwo+ID4gKyAgICAgaWYgKGNydGNfc3RhdGUtPm51bV9hY3RpdmVfcGxhbmVzID49IDEpCj4gPiAr
ICAgICAgICAgICAgIHByaW1hcnlfZGF0YSA9IGNydGNfc3RhdGUtPmFjdGl2ZV9wbGFuZXNbMF0t
PmRhdGE7Cj4gPiArCj4gPiArICAgICBpZiAoY3J0Y19zdGF0ZS0+bnVtX2FjdGl2ZV9wbGFuZXMg
PT0gMikKPiA+ICsgICAgICAgICAgICAgY3Vyc29yX2RhdGEgPSBjcnRjX3N0YXRlLT5hY3RpdmVf
cGxhbmVzWzFdLT5kYXRhOwo+ID4gKwo+ID4gKyAgICAgaWYgKCFwcmltYXJ5X2RhdGEpCj4gPiAr
ICAgICAgICAgICAgIHJldHVybjsKPiA+ICsKPiA+ICsgICAgIGZiID0gJnByaW1hcnlfZGF0YS0+
ZmI7Cj4gPiArICAgICBnZW1fb2JqID0gZHJtX2dlbV9mYl9nZXRfb2JqKGZiLCAwKTsKPiA+ICsg
ICAgIHZrbXNfb2JqID0gZHJtX2dlbV90b192a21zX2dlbShnZW1fb2JqKTsKPiA+ICsKPiA+ICsg
ICAgIGlmICghdmttc19vYmotPnZhZGRyIHx8ICFwcml2X2RhdGEpCj4gPiArICAgICAgICAgICAg
IHJldHVybjsKPiA+ICsKPiA+ICsgICAgIGRybV93cml0ZWJhY2tfcXVldWVfam9iKHdiX2Nvbm4s
IHN0YXRlKTsKPiA+ICsKPiA+ICsgICAgIG1lbWNweShwcml2X2RhdGEsIHZrbXNfb2JqLT52YWRk
ciwgdmttc19vYmotPmdlbS5zaXplKTsKPiA+ICsgICAgIGlmIChjdXJzb3JfZGF0YSkKPiA+ICsg
ICAgICAgICAgICAgY29tcG9zZV9jdXJzb3IoY3Vyc29yX2RhdGEsIHByaW1hcnlfZGF0YSwgcHJp
dl9kYXRhKTsKPiA+ICsKPiA+ICsgICAgIGRybV93cml0ZWJhY2tfc2lnbmFsX2NvbXBsZXRpb24o
d2JfY29ubiwgMCk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Nv
bm5lY3Rvcl9oZWxwZXJfZnVuY3Mgdmttc193Yl9jb25uX2hlbHBlcl9mdW5jcyA9IHsKPiA+ICsg
ICAgIC5nZXRfbW9kZXMgPSB2a21zX3diX2Nvbm5lY3Rvcl9nZXRfbW9kZXMsCj4gPiArICAgICAu
cHJlcGFyZV93cml0ZWJhY2tfam9iID0gdmttc193Yl9wcmVwYXJlX2pvYiwKPiA+ICsgICAgIC5j
bGVhbnVwX3dyaXRlYmFja19qb2IgPSB2a21zX3diX2NsZWFudXBfam9iLAo+ID4gKyAgICAgLmF0
b21pY19jb21taXQgPSB2a21zX3diX2F0b21pY19jb21taXQsCj4gPiArfTsKPiA+ICsKPiA+ICtp
bnQgZW5hYmxlX3dyaXRlYmFja19jb25uZWN0b3Ioc3RydWN0IHZrbXNfZGV2aWNlICp2a21zZGV2
KQo+ID4gK3sKPiA+ICsgICAgIHN0cnVjdCBkcm1fd3JpdGViYWNrX2Nvbm5lY3RvciAqd2IgPSAm
dmttc2Rldi0+b3V0cHV0LndiX2Nvbm5lY3RvcjsKPiA+ICsKPiA+ICsgICAgIHZrbXNkZXYtPm91
dHB1dC53Yl9jb25uZWN0b3IuZW5jb2Rlci5wb3NzaWJsZV9jcnRjcyA9IDE7Cj4gPiArICAgICBk
cm1fY29ubmVjdG9yX2hlbHBlcl9hZGQoJndiLT5iYXNlLCAmdmttc193Yl9jb25uX2hlbHBlcl9m
dW5jcyk7Cj4gPiArCj4gPiArICAgICByZXR1cm4gZHJtX3dyaXRlYmFja19jb25uZWN0b3JfaW5p
dCgmdmttc2Rldi0+ZHJtLCB3YiwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICZ2a21zX3diX2Nvbm5lY3Rvcl9mdW5jcywKPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICZ2a21zX3diX2VuY29kZXJfaGVscGVyX2Z1bmNzLAo+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmttc193Yl9mb3Jt
YXRzLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQVJSQVlf
U0laRSh2a21zX3diX2Zvcm1hdHMpKTsKPiA+ICt9Cj4gPiArCj4gPiAtLQo+ID4gMi4yMS4wCj4K
PiAtLQo+IERhbmllbCBWZXR0ZXIKPiBTb2Z0d2FyZSBFbmdpbmVlciwgSW50ZWwgQ29ycG9yYXRp
b24KPiBodHRwOi8vYmxvZy5mZndsbC5jaAoKCgotLSAKClJvZHJpZ28gU2lxdWVpcmEKaHR0cHM6
Ly9zaXF1ZWlyYS50ZWNoCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9w
Lm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1k
ZXZlbA==
