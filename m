Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 1EB26109936
	for <lists+dri-devel@lfdr.de>; Tue, 26 Nov 2019 07:29:54 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 675A36E20A;
	Tue, 26 Nov 2019 06:29:45 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mailgw01.mediatek.com (unknown [210.61.82.183])
 by gabe.freedesktop.org (Postfix) with ESMTP id 0BFAF89BCD
 for <dri-devel@lists.freedesktop.org>; Tue, 26 Nov 2019 06:29:38 +0000 (UTC)
X-UUID: 30de7753cec14cb7b5d907923dd4e66a-20191126
X-UUID: 30de7753cec14cb7b5d907923dd4e66a-20191126
Received: from mtkcas06.mediatek.inc [(172.21.101.30)] by mailgw01.mediatek.com
 (envelope-from <bibby.hsieh@mediatek.com>)
 (Cellopoint E-mail Firewall v4.1.10 Build 0809 with TLS)
 with ESMTP id 279550704; Tue, 26 Nov 2019 14:29:35 +0800
Received: from mtkcas08.mediatek.inc (172.21.101.126) by
 mtkmbs05n1.mediatek.inc (172.21.101.15) with Microsoft SMTP Server (TLS) id
 15.0.1395.4; Tue, 26 Nov 2019 14:29:26 +0800
Received: from mtksdccf07.mediatek.inc (172.21.84.99) by mtkcas08.mediatek.inc
 (172.21.101.73) with Microsoft SMTP Server id 15.0.1395.4 via
 Frontend Transport; Tue, 26 Nov 2019 14:29:15 +0800
From: Bibby Hsieh <bibby.hsieh@mediatek.com>
To: David Airlie <airlied@linux.ie>, Matthias Brugger
 <matthias.bgg@gmail.com>, Daniel Vetter <daniel.vetter@ffwll.ch>,
 <dri-devel@lists.freedesktop.org>, <linux-mediatek@lists.infradead.org>
Subject: [PATCH 5/7] drm/mediatek: update cursors by using async atomic update
Date: Tue, 26 Nov 2019 14:29:30 +0800
Message-ID: <20191126062932.19773-6-bibby.hsieh@mediatek.com>
X-Mailer: git-send-email 2.18.0
In-Reply-To: <20191126062932.19773-1-bibby.hsieh@mediatek.com>
References: <20191126062932.19773-1-bibby.hsieh@mediatek.com>
MIME-Version: 1.0
X-MTK: N
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; d=mediatek.com; s=dk; 
 h=Content-Transfer-Encoding:Content-Type:MIME-Version:References:In-Reply-To:Message-ID:Date:Subject:CC:To:From;
 bh=Qp6ClDPIXeK2bCy7c/Xq118mHkXeUzIyZ4WImgi/Uu8=; 
 b=b6wWn+8NR1VxEdbbHlfgQPNQx+eMmCg/wJKDvafWyx74KhHow0mlxxqWUbF6jkRd8MNON0yyht9hfNFQOMX83raT5USJ+l+h6yaUyTwALdeHWvDbb/ZqaBnp5VgbdQwFOfggI8TJpa6HSY9F2nOQpxVX2k29z4pqLzguAUxtOuc=;
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: drinkcat@chromium.org, srv_heupstream@mediatek.com,
 linux-kernel@vger.kernel.org, tfiga@chromium.org,
 Thierry Reding <thierry.reding@gmail.com>,
 linux-arm-kernel@lists.infradead.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

U3VwcG9ydCB0byBhc3luYyB1cGRhdGVzIG9mIGN1cnNvcnMgYnkgdXNpbmcgdGhlIG5ldyBhdG9t
aWMNCmludGVyZmFjZSBmb3IgdGhhdC4NCg0KU2lnbmVkLW9mZi1ieTogQmliYnkgSHNpZWggPGJp
YmJ5LmhzaWVoQG1lZGlhdGVrLmNvbT4NCi0tLQ0KIGRyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9t
dGtfZHJtX2NydGMuYyAgfCA0MSArKysrKysrKysrKysrKysrKystDQogZHJpdmVycy9ncHUvZHJt
L21lZGlhdGVrL210a19kcm1fY3J0Yy5oICB8ICAzICsrDQogZHJpdmVycy9ncHUvZHJtL21lZGlh
dGVrL210a19kcm1fZHJ2LmMgICB8ICA0ICsrDQogZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210
a19kcm1fZHJ2LmggICB8ICAzICstDQogZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1f
cGxhbmUuYyB8IDUwICsrKysrKysrKysrKysrKysrKysrKysrKw0KIGRyaXZlcnMvZ3B1L2RybS9t
ZWRpYXRlay9tdGtfZHJtX3BsYW5lLmggfCAgMiArDQogNiBmaWxlcyBjaGFuZ2VkLCAxMDAgaW5z
ZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkNCg0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9tZWRpYXRlay9tdGtfZHJtX2NydGMuYyBiL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtf
ZHJtX2NydGMuYw0KaW5kZXggNDA4YTZkNmExNWJhLi5jNDU3NTkxYTE3NmUgMTAwNjQ0DQotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9jcnRjLmMNCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2NydGMuYw0KQEAgLTQxLDcgKzQxLDcgQEAgc3RydWN0
IG10a19kcm1fY3J0YyB7DQogCXN0cnVjdCBkcm1fcGxhbmUJCSpwbGFuZXM7DQogCXVuc2lnbmVk
IGludAkJCWxheWVyX25yOw0KIAlib29sCQkJCXBlbmRpbmdfcGxhbmVzOw0KLQ0KKwlib29sICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvcl91cGRhdGU7DQogCXZvaWQgX19pb21lbQkJ
CSpjb25maWdfcmVnczsNCiAJY29uc3Qgc3RydWN0IG10a19tbXN5c19yZWdfZGF0YSAqbW1zeXNf
cmVnX2RhdGE7DQogCXN0cnVjdCBtdGtfZGlzcF9tdXRleAkJKm11dGV4Ow0KQEAgLTQwOSw3ICs0
MDksOSBAQCBzdGF0aWMgdm9pZCBtdGtfY3J0Y19kZHBfY29uZmlnKHN0cnVjdCBkcm1fY3J0YyAq
Y3J0YykNCiAJCQlwbGFuZV9zdGF0ZS0+cGVuZGluZy5jb25maWcgPSBmYWxzZTsNCiAJCX0NCiAJ
CW10a19jcnRjLT5wZW5kaW5nX3BsYW5lcyA9IGZhbHNlOw0KLQkJbXRrX2F0b21pY19zdGF0ZV9w
dXRfcXVldWUoYXRvbWljX3N0YXRlKTsNCisJCWlmICghbXRrX2NydGMtPmN1cnNvcl91cGRhdGUp
DQorCQkJbXRrX2F0b21pY19zdGF0ZV9wdXRfcXVldWUoYXRvbWljX3N0YXRlKTsNCisJCW10a19j
cnRjLT5jdXJzb3JfdXBkYXRlID0gZmFsc2U7DQogCX0NCiB9DQogDQpAQCAtNDI1LDYgKzQyNyw0
MSBAQCBpbnQgbXRrX2RybV9jcnRjX3BsYW5lX2NoZWNrKHN0cnVjdCBkcm1fY3J0YyAqY3J0Yywg
c3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQogCXJldHVybiAwOw0KIH0NCiANCit2b2lkIG10a19k
cm1fY3J0Y19jdXJzb3JfdXBkYXRlKHN0cnVjdCBkcm1fY3J0YyAqY3J0Yywgc3RydWN0IGRybV9w
bGFuZSAqcGxhbmUsDQorCQkJCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm5ld19zdGF0ZSkNCit7
DQorCXN0cnVjdCBtdGtfZHJtX3ByaXZhdGUgKnByaXYgPSBjcnRjLT5kZXYtPmRldl9wcml2YXRl
Ow0KKwlzdHJ1Y3QgbXRrX2RybV9jcnRjICptdGtfY3J0YyA9IHRvX210a19jcnRjKGNydGMpOw0K
Kwljb25zdCBzdHJ1Y3QgZHJtX3BsYW5lX2hlbHBlcl9mdW5jcyAqcGxhbmVfaGVscGVyX2Z1bmNz
ID0NCisJCQlwbGFuZS0+aGVscGVyX3ByaXZhdGU7DQorCWludCBpOw0KKw0KKwlpZiAoIW10a19j
cnRjLT5lbmFibGVkKQ0KKwkJcmV0dXJuOw0KKw0KKwltdXRleF9sb2NrKCZwcml2LT5od19sb2Nr
KTsNCisJcGxhbmVfaGVscGVyX2Z1bmNzLT5hdG9taWNfdXBkYXRlKHBsYW5lLCBuZXdfc3RhdGUp
Ow0KKw0KKwlmb3IgKGkgPSAwOyBpIDwgbXRrX2NydGMtPmxheWVyX25yOyBpKyspIHsNCisJCXN0
cnVjdCBkcm1fcGxhbmUgKnBsYW5lID0gJm10a19jcnRjLT5wbGFuZXNbaV07DQorCQlzdHJ1Y3Qg
bXRrX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZTsNCisNCisJCXBsYW5lX3N0YXRlID0gdG9fbXRr
X3BsYW5lX3N0YXRlKHBsYW5lLT5zdGF0ZSk7DQorCQlpZiAocGxhbmVfc3RhdGUtPnBlbmRpbmcu
Y3Vyc29yX2RpcnR5KSB7DQorCQkJcGxhbmVfc3RhdGUtPnBlbmRpbmcuY29uZmlnID0gdHJ1ZTsN
CisJCQlwbGFuZV9zdGF0ZS0+cGVuZGluZy5jdXJzb3JfdXBkYXRlID0gZmFsc2U7DQorCQkJcGxh
bmVfc3RhdGUtPnBlbmRpbmcuY3Vyc29yX2RpcnR5ID0gZmFsc2U7DQorCQl9DQorCX0NCisJbXRr
X2NydGMtPnBlbmRpbmdfcGxhbmVzID0gdHJ1ZTsNCisJaWYgKHByaXYtPmRhdGEtPnNoYWRvd19y
ZWdpc3Rlcikgew0KKwkJbXRrX2Rpc3BfbXV0ZXhfYWNxdWlyZShtdGtfY3J0Yy0+bXV0ZXgpOw0K
KwkJbXRrX2NydGNfZGRwX2NvbmZpZyhjcnRjKTsNCisJCW10a19kaXNwX211dGV4X3JlbGVhc2Uo
bXRrX2NydGMtPm11dGV4KTsNCisJfQ0KKwltdXRleF91bmxvY2soJnByaXYtPmh3X2xvY2spOw0K
K30NCisNCiBzdGF0aWMgdm9pZCBtdGtfZHJtX2NydGNfYXRvbWljX2VuYWJsZShzdHJ1Y3QgZHJt
X2NydGMgKmNydGMsDQogCQkJCSAgICAgICBzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKm9sZF9zdGF0
ZSkNCiB7DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fY3J0
Yy5oIGIvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fY3J0Yy5oDQppbmRleCA2YWZl
MWMxOTU1N2EuLjQyYTNmNjUwZjU2NCAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvZ3B1L2RybS9tZWRp
YXRlay9tdGtfZHJtX2NydGMuaA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19k
cm1fY3J0Yy5oDQpAQCAtMjIsNCArMjIsNyBAQCBpbnQgbXRrX2RybV9jcnRjX2NyZWF0ZShzdHJ1
Y3QgZHJtX2RldmljZSAqZHJtX2RldiwNCiBpbnQgbXRrX2RybV9jcnRjX3BsYW5lX2NoZWNrKHN0
cnVjdCBkcm1fY3J0YyAqY3J0Yywgc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQogCQkJICAgICBz
dHJ1Y3QgbXRrX3BsYW5lX3N0YXRlICpzdGF0ZSk7DQogDQordm9pZCBtdGtfZHJtX2NydGNfY3Vy
c29yX3VwZGF0ZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMsIHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5l
LA0KKwkJCQlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSk7DQorDQogI2VuZGlm
IC8qIE1US19EUk1fQ1JUQ19IICovDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21lZGlh
dGVrL210a19kcm1fZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9kcnYu
Yw0KaW5kZXggOTc5NDlkZWUyYWYwLi4zODg0YTg5YTA3ZTYgMTAwNjQ0DQotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9kcnYuYw0KKysrIGIvZHJpdmVycy9ncHUvZHJtL21l
ZGlhdGVrL210a19kcm1fZHJ2LmMNCkBAIC00MCwxMiArNDAsMTUgQEAgc3RhdGljIHZvaWQgbXRr
X2RybV9hdG9taWNfaGVscGVyX2NvbW1pdF90YWlsX3JwbQ0KIAkJKHN0cnVjdCBkcm1fYXRvbWlj
X3N0YXRlICpvbGRfc3RhdGUpDQogew0KIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gb2xkX3N0
YXRlLT5kZXY7DQorCXN0cnVjdCBtdGtfZHJtX3ByaXZhdGUgKnByaXZhdGUgPSBkZXYtPmRldl9w
cml2YXRlOw0KIA0KIAlkcm1fYXRvbWljX2hlbHBlcl93YWl0X2Zvcl9mZW5jZXMoZGV2LCBvbGRf
c3RhdGUsIGZhbHNlKTsNCisJbXV0ZXhfbG9jaygmcHJpdmF0ZS0+aHdfbG9jayk7DQogCWRybV9h
dG9taWNfaGVscGVyX2NvbW1pdF9tb2Rlc2V0X2Rpc2FibGVzKGRldiwgb2xkX3N0YXRlKTsNCiAJ
ZHJtX2F0b21pY19oZWxwZXJfY29tbWl0X21vZGVzZXRfZW5hYmxlcyhkZXYsIG9sZF9zdGF0ZSk7
DQogCWRybV9hdG9taWNfaGVscGVyX2NvbW1pdF9wbGFuZXMoZGV2LCBvbGRfc3RhdGUsDQogCQkJ
CQlEUk1fUExBTkVfQ09NTUlUX0FDVElWRV9PTkxZKTsNCisJbXV0ZXhfdW5sb2NrKCZwcml2YXRl
LT5od19sb2NrKTsNCiAJZHJtX2F0b21pY19oZWxwZXJfZmFrZV92Ymxhbmsob2xkX3N0YXRlKTsN
CiAJZHJtX2F0b21pY19oZWxwZXJfY29tbWl0X2h3X2RvbmUob2xkX3N0YXRlKTsNCiAJZHJtX2F0
b21pY19oZWxwZXJfd2FpdF9mb3JfdmJsYW5rcyhkZXYsIG9sZF9zdGF0ZSk7DQpAQCAtMzU3LDYg
KzM2MCw3IEBAIHN0YXRpYyBpbnQgbXRrX2RybV9rbXNfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAq
ZHJtKQ0KIAlJTklUX1dPUksoJnByaXZhdGUtPnVucmVmZXJlbmNlLndvcmssIG10a191bnJlZmVy
ZW5jZV93b3JrKTsNCiAJSU5JVF9MSVNUX0hFQUQoJnByaXZhdGUtPnVucmVmZXJlbmNlLmxpc3Qp
Ow0KIAlzcGluX2xvY2tfaW5pdCgmcHJpdmF0ZS0+dW5yZWZlcmVuY2UubG9jayk7DQorCW11dGV4
X2luaXQoJnByaXZhdGUtPmh3X2xvY2spOw0KIA0KIAlyZXR1cm4gMDsNCiANCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9kcnYuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9tZWRpYXRlay9tdGtfZHJtX2Rydi5oDQppbmRleCAzYzQyMzgzZGVkYjAuLjA0M2JkMmQyMTBm
MiAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2Rydi5oDQor
KysgYi9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9kcnYuaA0KQEAgLTU0LDcgKzU0
LDggQEAgc3RydWN0IG10a19kcm1fcHJpdmF0ZSB7DQogCQkvKiBsb2NrIGZvciB1bnJlZmVyZW5j
ZSBsaXN0ICovDQogCQlzcGlubG9ja190CQlsb2NrOw0KIAl9IHVucmVmZXJlbmNlOw0KLQ0KKwkv
KiBsb2NrIGZvciBkaXNwbGF5IGh3IGFjY2VzcyAqLw0KKwlzdHJ1Y3QgbXV0ZXggaHdfbG9jazsN
CiAJYm9vbCBkbWFfcGFybXNfYWxsb2NhdGVkOw0KIH07DQogDQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fcGxhbmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9tZWRp
YXRlay9tdGtfZHJtX3BsYW5lLmMNCmluZGV4IGNkN2M5N2ViN2VlNi4uZDdhODg1M2Q5NGExIDEw
MDY0NA0KLS0tIGEvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fcGxhbmUuYw0KKysr
IGIvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fcGxhbmUuYw0KQEAgLTcsNiArNyw3
IEBADQogI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljLmg+DQogI2luY2x1ZGUgPGRybS9kcm1fYXRv
bWljX2hlbHBlci5oPg0KICNpbmNsdWRlIDxkcm0vZHJtX2ZvdXJjYy5oPg0KKyNpbmNsdWRlIDxk
cm0vZHJtX2F0b21pY191YXBpLmg+DQogI2luY2x1ZGUgPGRybS9kcm1fcGxhbmVfaGVscGVyLmg+
DQogI2luY2x1ZGUgPGRybS9kcm1fZ2VtX2ZyYW1lYnVmZmVyX2hlbHBlci5oPg0KIA0KQEAgLTcw
LDYgKzcxLDUwIEBAIHN0YXRpYyB2b2lkIG10a19kcm1fcGxhbmVfZGVzdHJveV9zdGF0ZShzdHJ1
Y3QgZHJtX3BsYW5lICpwbGFuZSwNCiAJa2ZyZWUodG9fbXRrX3BsYW5lX3N0YXRlKHN0YXRlKSk7
DQogfQ0KIA0KK3N0YXRpYyBpbnQgbXRrX3BsYW5lX2F0b21pY19hc3luY19jaGVjayhzdHJ1Y3Qg
ZHJtX3BsYW5lICpwbGFuZSwNCisJCQkJCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnN0YXRlKQ0K
K3sNCisJc3RydWN0IGRybV9jcnRjX3N0YXRlICpjcnRjX3N0YXRlOw0KKw0KKwlpZiAocGxhbmUg
IT0gc3RhdGUtPmNydGMtPmN1cnNvcikNCisJCXJldHVybiAtRUlOVkFMOw0KKw0KKwlpZiAoIXBs
YW5lLT5zdGF0ZSkNCisJCXJldHVybiAtRUlOVkFMOw0KKw0KKwlpZiAoIXBsYW5lLT5zdGF0ZS0+
ZmIpDQorCQlyZXR1cm4gLUVJTlZBTDsNCisNCisJaWYgKHN0YXRlLT5zdGF0ZSkNCisJCWNydGNf
c3RhdGUgPSBkcm1fYXRvbWljX2dldF9leGlzdGluZ19jcnRjX3N0YXRlKHN0YXRlLT5zdGF0ZSwN
CisJCQkJCQkJCXN0YXRlLT5jcnRjKTsNCisJZWxzZSAvKiBTcGVjaWFsIGNhc2UgZm9yIGFzeW5j
aHJvbm91cyBjdXJzb3IgdXBkYXRlcy4gKi8NCisJCWNydGNfc3RhdGUgPSBzdGF0ZS0+Y3J0Yy0+
c3RhdGU7DQorDQorCXJldHVybiBkcm1fYXRvbWljX2hlbHBlcl9jaGVja19wbGFuZV9zdGF0ZShw
bGFuZS0+c3RhdGUsIGNydGNfc3RhdGUsDQorCQkJCQkJICAgRFJNX1BMQU5FX0hFTFBFUl9OT19T
Q0FMSU5HLA0KKwkJCQkJCSAgIERSTV9QTEFORV9IRUxQRVJfTk9fU0NBTElORywNCisJCQkJCQkg
ICB0cnVlLCB0cnVlKTsNCit9DQorDQorc3RhdGljIHZvaWQgbXRrX3BsYW5lX2F0b21pY19hc3lu
Y191cGRhdGUoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQorCQkJCQkgIHN0cnVjdCBkcm1fcGxh
bmVfc3RhdGUgKm5ld19zdGF0ZSkNCit7DQorCXN0cnVjdCBtdGtfcGxhbmVfc3RhdGUgKnN0YXRl
ID0gdG9fbXRrX3BsYW5lX3N0YXRlKHBsYW5lLT5zdGF0ZSk7DQorDQorCXBsYW5lLT5zdGF0ZS0+
Y3J0Y194ID0gbmV3X3N0YXRlLT5jcnRjX3g7DQorCXBsYW5lLT5zdGF0ZS0+Y3J0Y195ID0gbmV3
X3N0YXRlLT5jcnRjX3k7DQorCXBsYW5lLT5zdGF0ZS0+Y3J0Y19oID0gbmV3X3N0YXRlLT5jcnRj
X2g7DQorCXBsYW5lLT5zdGF0ZS0+Y3J0Y193ID0gbmV3X3N0YXRlLT5jcnRjX3c7DQorCXBsYW5l
LT5zdGF0ZS0+c3JjX3ggPSBuZXdfc3RhdGUtPnNyY194Ow0KKwlwbGFuZS0+c3RhdGUtPnNyY195
ID0gbmV3X3N0YXRlLT5zcmNfeTsNCisJcGxhbmUtPnN0YXRlLT5zcmNfaCA9IG5ld19zdGF0ZS0+
c3JjX2g7DQorCXBsYW5lLT5zdGF0ZS0+c3JjX3cgPSBuZXdfc3RhdGUtPnNyY193Ow0KKwlzdGF0
ZS0+cGVuZGluZy5jdXJzb3JfdXBkYXRlID0gdHJ1ZTsNCisNCisJbXRrX2RybV9jcnRjX2N1cnNv
cl91cGRhdGUobmV3X3N0YXRlLT5jcnRjLCBwbGFuZSwgbmV3X3N0YXRlKTsNCit9DQorDQogc3Rh
dGljIGNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfZnVuY3MgbXRrX3BsYW5lX2Z1bmNzID0gew0KIAku
dXBkYXRlX3BsYW5lID0gZHJtX2F0b21pY19oZWxwZXJfdXBkYXRlX3BsYW5lLA0KIAkuZGlzYWJs
ZV9wbGFuZSA9IGRybV9hdG9taWNfaGVscGVyX2Rpc2FibGVfcGxhbmUsDQpAQCAtMTQxLDYgKzE4
Niw5IEBAIHN0YXRpYyB2b2lkIG10a19wbGFuZV9hdG9taWNfdXBkYXRlKHN0cnVjdCBkcm1fcGxh
bmUgKnBsYW5lLA0KIAlzdGF0ZS0+cGVuZGluZy5yb3RhdGlvbiA9IHBsYW5lLT5zdGF0ZS0+cm90
YXRpb247DQogCXdtYigpOyAvKiBNYWtlIHN1cmUgdGhlIGFib3ZlIHBhcmFtZXRlcnMgYXJlIHNl
dCBiZWZvcmUgdXBkYXRlICovDQogCXN0YXRlLT5wZW5kaW5nLmRpcnR5ID0gdHJ1ZTsNCisNCisJ
aWYgKHN0YXRlLT5wZW5kaW5nLmN1cnNvcl91cGRhdGUpDQorCQlzdGF0ZS0+cGVuZGluZy5jdXJz
b3JfZGlydHkgPSB0cnVlOw0KIH0NCiANCiBzdGF0aWMgdm9pZCBtdGtfcGxhbmVfYXRvbWljX2Rp
c2FibGUoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQpAQCAtMTU4LDYgKzIwNiw4IEBAIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgZHJtX3BsYW5lX2hlbHBlcl9mdW5jcyBtdGtfcGxhbmVfaGVscGVyX2Z1
bmNzID0gew0KIAkuYXRvbWljX2NoZWNrID0gbXRrX3BsYW5lX2F0b21pY19jaGVjaywNCiAJLmF0
b21pY191cGRhdGUgPSBtdGtfcGxhbmVfYXRvbWljX3VwZGF0ZSwNCiAJLmF0b21pY19kaXNhYmxl
ID0gbXRrX3BsYW5lX2F0b21pY19kaXNhYmxlLA0KKwkuYXRvbWljX2FzeW5jX3VwZGF0ZSA9IG10
a19wbGFuZV9hdG9taWNfYXN5bmNfdXBkYXRlLA0KKwkuYXRvbWljX2FzeW5jX2NoZWNrID0gbXRr
X3BsYW5lX2F0b21pY19hc3luY19jaGVjaywNCiB9Ow0KIA0KIGludCBtdGtfcGxhbmVfaW5pdChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwNCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9wbGFuZS5oIGIvZHJpdmVycy9n
cHUvZHJtL21lZGlhdGVrL210a19kcm1fcGxhbmUuaA0KaW5kZXggNzYwODg1ZTM1YjI3Li4xMTNh
MTAzNDQ4MDUgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9w
bGFuZS5oDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9wbGFuZS5oDQpA
QCAtMjIsNiArMjIsOCBAQCBzdHJ1Y3QgbXRrX3BsYW5lX3BlbmRpbmdfc3RhdGUgew0KIAl1bnNp
Z25lZCBpbnQJCQloZWlnaHQ7DQogCXVuc2lnbmVkIGludAkJCXJvdGF0aW9uOw0KIAlib29sCQkJ
CWRpcnR5Ow0KKwlib29sCQkJCWN1cnNvcl9kaXJ0eTsNCisJYm9vbAkJCQljdXJzb3JfdXBkYXRl
Ow0KIH07DQogDQogc3RydWN0IG10a19wbGFuZV9zdGF0ZSB7DQotLSANCjIuMTguMA0KX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxp
bmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
