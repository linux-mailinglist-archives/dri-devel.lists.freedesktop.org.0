Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8E6FF2D43F6
	for <lists+dri-devel@lfdr.de>; Wed,  9 Dec 2020 15:10:11 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E322D6E171;
	Wed,  9 Dec 2020 14:10:06 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x544.google.com (mail-ed1-x544.google.com
 [IPv6:2a00:1450:4864:20::544])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BF60A6E171
 for <dri-devel@lists.freedesktop.org>; Wed,  9 Dec 2020 14:10:04 +0000 (UTC)
Received: by mail-ed1-x544.google.com with SMTP id dk8so1715107edb.1
 for <dri-devel@lists.freedesktop.org>; Wed, 09 Dec 2020 06:10:04 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=fAfze8F+3vpNFKh6szjqJgk0FJqsEEejfTudnOlUuvU=;
 b=VY8MscLkniunPmBMlxzOv1TIP9s0rZZskz0zO7r4WURQFIJA14bePguerz6k28OwDt
 t+bNohPfLD3/gfOWqhMoWZOxoPQW8pfVc5fN85l4OUWKikZ2CtRHTsE1ah8st+hOGjRq
 6SlZc04iDBpnG/vfWuCR3CmSZp6X7RJvppfzLv2VCx9GQ/PoVa+4TpLxPAqurmmlFZwk
 6zObCKAXJkBKcu1jUu+VSATVIfI9URFCM3VJJ8mfFbuJyMa1NQmSA6zH2HZwE8LdWZ2L
 i8yoWtBzCuamDzdE2YMIpnNdfplu/Hel26744IhQj7X1oH2exNTRdZxb4LlXfmTZuK7s
 CSAQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=fAfze8F+3vpNFKh6szjqJgk0FJqsEEejfTudnOlUuvU=;
 b=otfZfg1Tnvx6C0v58c2XoqMIoxlBtVnc6qjCpAbzh76GDhPEYKpefm1K7BE8DUCz0Z
 SE3yDm3iVccfV9LFJSQWVq4w6N3AsSQc6RPxwUDbP1OIzMzbdWRxJ2bqOz7Lkb3xpt9M
 Mj1/iEcSFv0KdtxvpAWSjveTZZOOtZcNbaDAryc9NMFUcXQ1KVOMHFMLovq/nzvH6PJo
 HS75+nU29SA5sWOU9teyVGSfNzSSrh/orjJRfMDoMJYqaak/n+vlhg6b9qmtkSs4yWC5
 I4Ev9z0XOF8B8AA+HBdyeUp5ASzhAZOULbebMH2ijUT6c6ZXuf0SEoB/hc3MKZOU8OsZ
 Ao8g==
X-Gm-Message-State: AOAM531MsVsv4FuWHBgtiMYbTey0QfLQOoLWDI3XoLuTFQvl6bspMZNh
 URaIAkpdLom5mLMh9J1yB9XO2ynsc8M=
X-Google-Smtp-Source: ABdhPJzNb+fnOiw5hnISVb5t6bBxJ7MJNYXGpHCymRHjb0Ft1cVVbxU89UvNdGlVLu4CBOorJ0T1Rg==
X-Received: by 2002:a05:6402:13d1:: with SMTP id
 a17mr2147512edx.202.1607523002496; 
 Wed, 09 Dec 2020 06:10:02 -0800 (PST)
Received: from abel.fritz.box ([2a02:908:1252:fb60:ebed:a488:5b85:a327])
 by smtp.gmail.com with ESMTPSA id u23sm1611674ejy.87.2020.12.09.06.10.01
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Wed, 09 Dec 2020 06:10:01 -0800 (PST)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH] drm/ttm: cleanup BO size handling v2
Date: Wed,  9 Dec 2020 15:10:00 +0100
Message-Id: <20201209141000.1794-1-christian.koenig@amd.com>
X-Mailer: git-send-email 2.25.1
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QmFzZWQgb24gYW4gaWRlYSBmcm9tIERhdmUsIGJ1dCBjbGVhbmVkIHVwIGEgYml0LgoKV2UgaGFk
IG11bHRpcGxlIGZpZWxkcyBmb3IgZXNzZW50aWFsbHkgdGhlIHNhbWUgdGhpbmcuCgpOb3cgYm8t
PmJhc2Uuc2l6ZSBpcyB0aGUgb3JpZ2luYWwgc2l6ZSBvZiB0aGUgQk8gaW4KYXJiaXRyYXJ5IHVu
aXRzLCB1c3VhbGx5IGJ5dGVzLgoKYm8tPm1lbS5udW1fcGFnZXMgaXMgdGhlIHNpemUgaW4gbnVt
YmVyIG9mIHBhZ2VzIGluIHRoZQpyZXNvdXJjZSBkb21haW4gb2YgYm8tPm1lbS5tZW1fdHlwZS4K
CnYyOiB1c2UgdGhlIEdFTSBvYmplY3Qgc2l6ZSBpbnN0ZWFkIG9mIHRoZSBCTyBzaXplCgpTaWdu
ZWQtb2ZmLWJ5OiBDaHJpc3RpYW4gS8O2bmlnIDxjaHJpc3RpYW4ua29lbmlnQGFtZC5jb20+ClJl
dmlld2VkLWJ5OiBIdWFuZyBSdWkgPHJheS5odWFuZ0BhbWQuY29tPiAodjEpCi0tLQogZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RtYV9idWYuYyAgIHwgIDIgKy0KIGRyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nbWMuYyAgICAgICB8ICAyICstCiBkcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfb2JqZWN0LmMgICAgfCAgMiArLQogZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X29iamVjdC5oICAgIHwgIDQgKy0tCiBkcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfdHJhY2UuaCAgICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jICAgICAgIHwgIDYgKystLQogZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvbWVzX3YxMF8xLmMgICAgICAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9u
b3V2ZWF1L25vdXZlYXVfYm8uYyAgICAgICAgICB8IDEwICsrKy0tLQogZHJpdmVycy9ncHUvZHJt
L25vdXZlYXUvbm91dmVhdV9kaXNwbGF5LmMgICAgIHwgIDYgKystLQogZHJpdmVycy9ncHUvZHJt
L25vdXZlYXUvbm91dmVhdV9wcmltZS5jICAgICAgIHwgIDQgKy0tCiBkcml2ZXJzL2dwdS9kcm0v
bm91dmVhdS9udjE3X2ZlbmNlLmMgICAgICAgICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL25v
dXZlYXUvbnY1MF9mZW5jZS5jICAgICAgICAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9xeGwv
cXhsX29iamVjdC5oICAgICAgICAgICAgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vcmFkZW9u
L3JhZGVvbl9jcy5jICAgICAgICAgICAgfCAgMyArLQogZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9y
YWRlb25fb2JqZWN0LmMgICAgICAgIHwgMTMgKysrKy0tLS0KIGRyaXZlcnMvZ3B1L2RybS9yYWRl
b24vcmFkZW9uX29iamVjdC5oICAgICAgICB8ICA0ICstLQogZHJpdmVycy9ncHUvZHJtL3JhZGVv
bi9yYWRlb25fcHJpbWUuYyAgICAgICAgIHwgIDQgKy0tCiBkcml2ZXJzL2dwdS9kcm0vcmFkZW9u
L3JhZGVvbl90cmFjZS5oICAgICAgICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9y
YWRlb25fdHRtLmMgICAgICAgICAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2Jv
LmMgICAgICAgICAgICAgICAgICB8IDMzICsrKysrKy0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1
L2RybS90dG0vdHRtX2JvX3V0aWwuYyAgICAgICAgICAgICB8IDEyICsrKy0tLS0KIGRyaXZlcnMv
Z3B1L2RybS90dG0vdHRtX2JvX3ZtLmMgICAgICAgICAgICAgICB8ICA2ICsrLS0KIGRyaXZlcnMv
Z3B1L2RybS90dG0vdHRtX3R0LmMgICAgICAgICAgICAgICAgICB8ICAyICstCiBkcml2ZXJzL2dw
dS9kcm0vdm13Z2Z4L3Ztd2dmeF9ibGl0LmMgICAgICAgICAgfCAgNCArLS0KIGRyaXZlcnMvZ3B1
L2RybS92bXdnZngvdm13Z2Z4X2JvLmMgICAgICAgICAgICB8ICA2ICsrLS0KIGRyaXZlcnMvZ3B1
L2RybS92bXdnZngvdm13Z2Z4X2NvdGFibGUuYyAgICAgICB8ICAyICstCiBkcml2ZXJzL2dwdS9k
cm0vdm13Z2Z4L3Ztd2dmeF9leGVjYnVmLmMgICAgICAgfCAgNCArLS0KIGRyaXZlcnMvZ3B1L2Ry
bS92bXdnZngvdm13Z2Z4X2dtcmlkX21hbmFnZXIuYyB8ICA1ICsrLQogZHJpdmVycy9ncHUvZHJt
L3Ztd2dmeC92bXdnZnhfa21zLmMgICAgICAgICAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS92
bXdnZngvdm13Z2Z4X3BhZ2VfZGlydHkuYyAgICB8ICA4ICsrLS0tCiBkcml2ZXJzL2dwdS9kcm0v
dm13Z2Z4L3Ztd2dmeF9yZXNvdXJjZS5jICAgICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL3Zt
d2dmeC92bXdnZnhfc2hhZGVyLmMgICAgICAgIHwgIDMgKy0KIGRyaXZlcnMvZ3B1L2RybS92bXdn
Zngvdm13Z2Z4X3N0ZHUuYyAgICAgICAgICB8ICA0ICstLQogZHJpdmVycy9ncHUvZHJtL3Ztd2dm
eC92bXdnZnhfc3VyZmFjZS5jICAgICAgIHwgIDcgKystLQogaW5jbHVkZS9kcm0vdHRtL3R0bV9i
b19hcGkuaCAgICAgICAgICAgICAgICAgIHwgIDkgKystLS0KIGluY2x1ZGUvZHJtL3R0bS90dG1f
cmVzb3VyY2UuaCAgICAgICAgICAgICAgICB8ICAxIC0KIDM2IGZpbGVzIGNoYW5nZWQsIDgyIGlu
c2VydGlvbnMoKyksIDEwMiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfZG1hX2J1Zi5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2RtYV9idWYuYwppbmRleCBlNTkxOWVmY2E4NzAuLmM0YzkzZjE5ZDI3MyAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RtYV9idWYuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZG1hX2J1Zi5jCkBAIC0yNjksNyAr
MjY5LDcgQEAgc3RhdGljIHN0cnVjdCBzZ190YWJsZSAqYW1kZ3B1X2RtYV9idWZfbWFwKHN0cnVj
dCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFjaCwKIAljYXNlIFRUTV9QTF9UVDoKIAkJc2d0ID0g
ZHJtX3ByaW1lX3BhZ2VzX3RvX3NnKG9iai0+ZGV2LAogCQkJCQkgICAgYm8tPnRiby50dG0tPnBh
Z2VzLAotCQkJCQkgICAgYm8tPnRiby5udW1fcGFnZXMpOworCQkJCQkgICAgYm8tPnRiby50dG0t
Pm51bV9wYWdlcyk7CiAJCWlmIChJU19FUlIoc2d0KSkKIAkJCXJldHVybiBzZ3Q7CiAKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nbWMuYyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nbWMuYwppbmRleCAwNTZjYjg3ZDA5ZWEuLjUyYmNk
MWI1NTgyZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dt
Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nbWMuYwpAQCAtMTIx
LDcgKzEyMSw3IEBAIHVpbnQ2NF90IGFtZGdwdV9nbWNfYWdwX2FkZHIoc3RydWN0IHR0bV9idWZm
ZXJfb2JqZWN0ICpibykKIHsKIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGFtZGdwdV90
dG1fYWRldihiby0+YmRldik7CiAKLQlpZiAoYm8tPm51bV9wYWdlcyAhPSAxIHx8IGJvLT50dG0t
PmNhY2hpbmcgPT0gdHRtX2NhY2hlZCkKKwlpZiAoYm8tPnR0bS0+bnVtX3BhZ2VzICE9IDEgfHwg
Ym8tPnR0bS0+Y2FjaGluZyA9PSB0dG1fY2FjaGVkKQogCQlyZXR1cm4gQU1ER1BVX0JPX0lOVkFM
SURfT0ZGU0VUOwogCiAJaWYgKGJvLT50dG0tPmRtYV9hZGRyZXNzWzBdICsgUEFHRV9TSVpFID49
IGFkZXYtPmdtYy5hZ3Bfc2l6ZSkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV9vYmplY3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9v
YmplY3QuYwppbmRleCBjNmM5NzIzZDNkOGEuLjM4MWVjYzQ3ODhkNSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X29iamVjdC5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9vYmplY3QuYwpAQCAtNzg3LDcgKzc4Nyw3IEBAIGludCBh
bWRncHVfYm9fa21hcChzdHJ1Y3QgYW1kZ3B1X2JvICpibywgdm9pZCAqKnB0cikKIAlpZiAociA8
IDApCiAJCXJldHVybiByOwogCi0JciA9IHR0bV9ib19rbWFwKCZiby0+dGJvLCAwLCBiby0+dGJv
Lm51bV9wYWdlcywgJmJvLT5rbWFwKTsKKwlyID0gdHRtX2JvX2ttYXAoJmJvLT50Ym8sIDAsIGJv
LT50Ym8ubWVtLm51bV9wYWdlcywgJmJvLT5rbWFwKTsKIAlpZiAocikKIAkJcmV0dXJuIHI7CiAK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9vYmplY3QuaCBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9vYmplY3QuaAppbmRleCBlZDQ3Y2Jh
YzRmNzUuLmE5OWE1Y2RlNDJkZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X29iamVjdC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9vYmplY3QuaApAQCAtMTc0LDEyICsxNzQsMTIgQEAgc3RhdGljIGlubGluZSB2b2lkIGFtZGdw
dV9ib191bnJlc2VydmUoc3RydWN0IGFtZGdwdV9ibyAqYm8pCiAKIHN0YXRpYyBpbmxpbmUgdW5z
aWduZWQgbG9uZyBhbWRncHVfYm9fc2l6ZShzdHJ1Y3QgYW1kZ3B1X2JvICpibykKIHsKLQlyZXR1
cm4gYm8tPnRiby5udW1fcGFnZXMgPDwgUEFHRV9TSElGVDsKKwlyZXR1cm4gYm8tPnRiby5iYXNl
LnNpemU7CiB9CiAKIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgYW1kZ3B1X2JvX25ncHVfcGFnZXMo
c3RydWN0IGFtZGdwdV9ibyAqYm8pCiB7Ci0JcmV0dXJuIChiby0+dGJvLm51bV9wYWdlcyA8PCBQ
QUdFX1NISUZUKSAvIEFNREdQVV9HUFVfUEFHRV9TSVpFOworCXJldHVybiBiby0+dGJvLmJhc2Uu
c2l6ZSAvIEFNREdQVV9HUFVfUEFHRV9TSVpFOwogfQogCiBzdGF0aWMgaW5saW5lIHVuc2lnbmVk
IGFtZGdwdV9ib19ncHVfcGFnZV9hbGlnbm1lbnQoc3RydWN0IGFtZGdwdV9ibyAqYm8pCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHJhY2UuaCBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90cmFjZS5oCmluZGV4IGVlOTQ4MGQxNGNiYy4u
MjA3MTVkZGJiNzQ2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfdHJhY2UuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHJhY2Uu
aApAQCAtMTI3LDcgKzEyNyw3IEBAIFRSQUNFX0VWRU5UKGFtZGdwdV9ib19jcmVhdGUsCiAKIAkg
ICAgVFBfZmFzdF9hc3NpZ24oCiAJCQkgICBfX2VudHJ5LT5ibyA9IGJvOwotCQkJICAgX19lbnRy
eS0+cGFnZXMgPSBiby0+dGJvLm51bV9wYWdlczsKKwkJCSAgIF9fZW50cnktPnBhZ2VzID0gYm8t
PnRiby5tZW0ubnVtX3BhZ2VzOwogCQkJICAgX19lbnRyeS0+dHlwZSA9IGJvLT50Ym8ubWVtLm1l
bV90eXBlOwogCQkJICAgX19lbnRyeS0+cHJlZmVyID0gYm8tPnByZWZlcnJlZF9kb21haW5zOwog
CQkJICAgX19lbnRyeS0+YWxsb3cgPSBiby0+YWxsb3dlZF9kb21haW5zOwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jCmluZGV4IGVjOTNkNGZkYWJiZC4uNTM0Njg5MWEzZjcz
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jCkBAIC02MzYsNyArNjM2
LDcgQEAgc3RhdGljIGludCBhbWRncHVfYm9fbW92ZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3Qg
KmJvLCBib29sIGV2aWN0LAogCiBvdXQ6CiAJLyogdXBkYXRlIHN0YXRpc3RpY3MgKi8KLQlhdG9t
aWM2NF9hZGQoKHU2NCliby0+bnVtX3BhZ2VzIDw8IFBBR0VfU0hJRlQsICZhZGV2LT5udW1fYnl0
ZXNfbW92ZWQpOworCWF0b21pYzY0X2FkZChiby0+YmFzZS5zaXplLCAmYWRldi0+bnVtX2J5dGVz
X21vdmVkKTsKIAlhbWRncHVfYm9fbW92ZV9ub3RpZnkoYm8sIGV2aWN0LCBuZXdfbWVtKTsKIAly
ZXR1cm4gMDsKIH0KQEAgLTIxMzEsNyArMjEzMSw3IEBAIGludCBhbWRncHVfZmlsbF9idWZmZXIo
c3RydWN0IGFtZGdwdV9ibyAqYm8sCiAJCQlyZXR1cm4gcjsKIAl9CiAKLQludW1fcGFnZXMgPSBi
by0+dGJvLm51bV9wYWdlczsKKwludW1fcGFnZXMgPSBiby0+dGJvLm1lbS5udW1fcGFnZXM7CiAJ
bW1fbm9kZSA9IGJvLT50Ym8ubWVtLm1tX25vZGU7CiAJbnVtX2xvb3BzID0gMDsKIAl3aGlsZSAo
bnVtX3BhZ2VzKSB7CkBAIC0yMTYxLDcgKzIxNjEsNyBAQCBpbnQgYW1kZ3B1X2ZpbGxfYnVmZmVy
KHN0cnVjdCBhbWRncHVfYm8gKmJvLAogCQl9CiAJfQogCi0JbnVtX3BhZ2VzID0gYm8tPnRiby5u
dW1fcGFnZXM7CisJbnVtX3BhZ2VzID0gYm8tPnRiby5tZW0ubnVtX3BhZ2VzOwogCW1tX25vZGUg
PSBiby0+dGJvLm1lbS5tbV9ub2RlOwogCiAJd2hpbGUgKG51bV9wYWdlcykgewpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbWVzX3YxMF8xLmMgYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9tZXNfdjEwXzEuYwppbmRleCA5ODVlNDU0NDYzZTEuLjdmMzA2MjlmMjFh
MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbWVzX3YxMF8xLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbWVzX3YxMF8xLmMKQEAgLTU1NCw3ICs1NTQs
NyBAQCBzdGF0aWMgaW50IG1lc192MTBfMV9hbGxvY2F0ZV9lb3BfYnVmKHN0cnVjdCBhbWRncHVf
ZGV2aWNlICphZGV2KQogCQlyZXR1cm4gcjsKIAl9CiAKLQltZW1zZXQoZW9wLCAwLCBhZGV2LT5t
ZXMuZW9wX2dwdV9vYmotPnRiby5tZW0uc2l6ZSk7CisJbWVtc2V0KGVvcCwgMCwgYWRldi0+bWVz
LmVvcF9ncHVfb2JqLT50Ym8uYmFzZS5zaXplKTsKIAogCWFtZGdwdV9ib19rdW5tYXAoYWRldi0+
bWVzLmVvcF9ncHVfb2JqKTsKIAlhbWRncHVfYm9fdW5yZXNlcnZlKGFkZXYtPm1lcy5lb3BfZ3B1
X29iaik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2JvLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2JvLmMKaW5kZXggYmM1NDJhYzRjNGI2
Li5jMWE2NzViOGZjNDMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZl
YXVfYm8uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2JvLmMKQEAgLTQ3
MywxMCArNDczLDEwIEBAIG5vdXZlYXVfYm9fcGluKHN0cnVjdCBub3V2ZWF1X2JvICpudmJvLCB1
aW50MzJfdCBkb21haW4sIGJvb2wgY29udGlnKQogCiAJc3dpdGNoIChiby0+bWVtLm1lbV90eXBl
KSB7CiAJY2FzZSBUVE1fUExfVlJBTToKLQkJZHJtLT5nZW0udnJhbV9hdmFpbGFibGUgLT0gYm8t
Pm1lbS5zaXplOworCQlkcm0tPmdlbS52cmFtX2F2YWlsYWJsZSAtPSBiby0+YmFzZS5zaXplOwog
CQlicmVhazsKIAljYXNlIFRUTV9QTF9UVDoKLQkJZHJtLT5nZW0uZ2FydF9hdmFpbGFibGUgLT0g
Ym8tPm1lbS5zaXplOworCQlkcm0tPmdlbS5nYXJ0X2F2YWlsYWJsZSAtPSBiby0+YmFzZS5zaXpl
OwogCQlicmVhazsKIAlkZWZhdWx0OgogCQlicmVhazsKQEAgLTUwNCwxMCArNTA0LDEwIEBAIG5v
dXZlYXVfYm9fdW5waW4oc3RydWN0IG5vdXZlYXVfYm8gKm52Ym8pCiAJaWYgKCFudmJvLT5iby5w
aW5fY291bnQpIHsKIAkJc3dpdGNoIChiby0+bWVtLm1lbV90eXBlKSB7CiAJCWNhc2UgVFRNX1BM
X1ZSQU06Ci0JCQlkcm0tPmdlbS52cmFtX2F2YWlsYWJsZSArPSBiby0+bWVtLnNpemU7CisJCQlk
cm0tPmdlbS52cmFtX2F2YWlsYWJsZSArPSBiby0+YmFzZS5zaXplOwogCQkJYnJlYWs7CiAJCWNh
c2UgVFRNX1BMX1RUOgotCQkJZHJtLT5nZW0uZ2FydF9hdmFpbGFibGUgKz0gYm8tPm1lbS5zaXpl
OworCQkJZHJtLT5nZW0uZ2FydF9hdmFpbGFibGUgKz0gYm8tPmJhc2Uuc2l6ZTsKIAkJCWJyZWFr
OwogCQlkZWZhdWx0OgogCQkJYnJlYWs7CkBAIC05MTMsNyArOTEzLDcgQEAgbm91dmVhdV9ib192
bV9iaW5kKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sIHN0cnVjdCB0dG1fcmVzb3VyY2Ug
Km5ld19yZWcsCiAJCXJldHVybiAwOwogCiAJaWYgKGRybS0+Y2xpZW50LmRldmljZS5pbmZvLmZh
bWlseSA+PSBOVl9ERVZJQ0VfSU5GT19WMF9DRUxTSVVTKSB7Ci0JCSpuZXdfdGlsZSA9IG52MTBf
Ym9fc2V0X3RpbGluZyhkZXYsIG9mZnNldCwgbmV3X3JlZy0+c2l6ZSwKKwkJKm5ld190aWxlID0g
bnYxMF9ib19zZXRfdGlsaW5nKGRldiwgb2Zmc2V0LCBiby0+YmFzZS5zaXplLAogCQkJCQkgICAg
ICAgbnZiby0+bW9kZSwgbnZiby0+emV0YSk7CiAJfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vbm91dmVhdS9ub3V2ZWF1X2Rpc3BsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1
L25vdXZlYXVfZGlzcGxheS5jCmluZGV4IGJjZWI0OGEyZGZjYS4uNTg0ZDFmMWZlYmNiIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2Rpc3BsYXkuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2Rpc3BsYXkuYwpAQCAtMjg4LDkgKzI4OCw5
IEBAIG5vdXZlYXVfY2hlY2tfYmxfc2l6ZShzdHJ1Y3Qgbm91dmVhdV9kcm0gKmRybSwgc3RydWN0
IG5vdXZlYXVfYm8gKm52Ym8sCiAKIAlEUk1fREVCVUdfS01TKCJvZmZzZXQ9JXUgc3RyaWRlPSV1
IGg9JXUgdGlsZV9tb2RlPTB4JTAyeCBidz0ldSBiaD0ldSBnb2Jfc2l6ZT0ldSBibF9zaXplPSVs
bHUgc2l6ZT0lbHVcbiIsCiAJCSAgICAgIG9mZnNldCwgc3RyaWRlLCBoLCB0aWxlX21vZGUsIGJ3
LCBiaCwgZ29iX3NpemUsIGJsX3NpemUsCi0JCSAgICAgIG52Ym8tPmJvLm1lbS5zaXplKTsKKwkJ
ICAgICAgbnZiby0+Ym8uYmFzZS5zaXplKTsKIAotCWlmIChibF9zaXplICsgb2Zmc2V0ID4gbnZi
by0+Ym8ubWVtLnNpemUpCisJaWYgKGJsX3NpemUgKyBvZmZzZXQgPiBudmJvLT5iby5iYXNlLnNp
emUpCiAJCXJldHVybiAtRVJBTkdFOwogCiAJcmV0dXJuIDA7CkBAIC0zNjMsNyArMzYzLDcgQEAg
bm91dmVhdV9mcmFtZWJ1ZmZlcl9uZXcoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKIAkJfSBlbHNl
IHsKIAkJCXVpbnQzMl90IHNpemUgPSBtb2RlX2NtZC0+cGl0Y2hlc1tpXSAqIGhlaWdodDsKIAot
CQkJaWYgKHNpemUgKyBtb2RlX2NtZC0+b2Zmc2V0c1tpXSA+IG52Ym8tPmJvLm1lbS5zaXplKQor
CQkJaWYgKHNpemUgKyBtb2RlX2NtZC0+b2Zmc2V0c1tpXSA+IG52Ym8tPmJvLmJhc2Uuc2l6ZSkK
IAkJCQlyZXR1cm4gLUVSQU5HRTsKIAkJfQogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9ub3V2ZWF1L25vdXZlYXVfcHJpbWUuYyBiL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZl
YXVfcHJpbWUuYwppbmRleCAyZjE2YjUyNDkyODMuLjM0NzQ4ODY4NWY3NCAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9wcmltZS5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9ub3V2ZWF1L25vdXZlYXVfcHJpbWUuYwpAQCAtMzAsOSArMzAsOSBAQAogc3RydWN0IHNn
X3RhYmxlICpub3V2ZWF1X2dlbV9wcmltZV9nZXRfc2dfdGFibGUoc3RydWN0IGRybV9nZW1fb2Jq
ZWN0ICpvYmopCiB7CiAJc3RydWN0IG5vdXZlYXVfYm8gKm52Ym8gPSBub3V2ZWF1X2dlbV9vYmpl
Y3Qob2JqKTsKLQlpbnQgbnBhZ2VzID0gbnZiby0+Ym8ubnVtX3BhZ2VzOwogCi0JcmV0dXJuIGRy
bV9wcmltZV9wYWdlc190b19zZyhvYmotPmRldiwgbnZiby0+Ym8udHRtLT5wYWdlcywgbnBhZ2Vz
KTsKKwlyZXR1cm4gZHJtX3ByaW1lX3BhZ2VzX3RvX3NnKG9iai0+ZGV2LCBudmJvLT5iby50dG0t
PnBhZ2VzLAorCQkJCSAgICAgbnZiby0+Ym8udHRtLT5udW1fcGFnZXMpOwogfQogCiBzdHJ1Y3Qg
ZHJtX2dlbV9vYmplY3QgKm5vdXZlYXVfZ2VtX3ByaW1lX2ltcG9ydF9zZ190YWJsZShzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2LApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbnYx
N19mZW5jZS5jIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbnYxN19mZW5jZS5jCmluZGV4IDEy
NTNmZGVjNzEyZC4uYjFjZDhkN2RkODdkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbm91
dmVhdS9udjE3X2ZlbmNlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbnYxN19mZW5j
ZS5jCkBAIC04MCw3ICs4MCw3IEBAIG52MTdfZmVuY2VfY29udGV4dF9uZXcoc3RydWN0IG5vdXZl
YXVfY2hhbm5lbCAqY2hhbikKIAlzdHJ1Y3QgbnYxMF9mZW5jZV9jaGFuICpmY3R4OwogCXN0cnVj
dCB0dG1fcmVzb3VyY2UgKnJlZyA9ICZwcml2LT5iby0+Ym8ubWVtOwogCXUzMiBzdGFydCA9IHJl
Zy0+c3RhcnQgKiBQQUdFX1NJWkU7Ci0JdTMyIGxpbWl0ID0gc3RhcnQgKyByZWctPnNpemUgLSAx
OworCXUzMiBsaW1pdCA9IHN0YXJ0ICsgcHJpdi0+Ym8tPmJvLmJhc2Uuc2l6ZSAtIDE7CiAJaW50
IHJldCA9IDA7CiAKIAlmY3R4ID0gY2hhbi0+ZmVuY2UgPSBremFsbG9jKHNpemVvZigqZmN0eCks
IEdGUF9LRVJORUwpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbnY1MF9m
ZW5jZS5jIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbnY1MF9mZW5jZS5jCmluZGV4IDQ0NzIz
OGUzY2JlNy4uMTYyNTgyNjUwNWY2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVh
dS9udjUwX2ZlbmNlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbnY1MF9mZW5jZS5j
CkBAIC0zOSw3ICszOSw3IEBAIG52NTBfZmVuY2VfY29udGV4dF9uZXcoc3RydWN0IG5vdXZlYXVf
Y2hhbm5lbCAqY2hhbikKIAlzdHJ1Y3QgbnYxMF9mZW5jZV9jaGFuICpmY3R4OwogCXN0cnVjdCB0
dG1fcmVzb3VyY2UgKnJlZyA9ICZwcml2LT5iby0+Ym8ubWVtOwogCXUzMiBzdGFydCA9IHJlZy0+
c3RhcnQgKiBQQUdFX1NJWkU7Ci0JdTMyIGxpbWl0ID0gc3RhcnQgKyByZWctPnNpemUgLSAxOwor
CXUzMiBsaW1pdCA9IHN0YXJ0ICsgcHJpdi0+Ym8tPmJvLmJhc2Uuc2l6ZSAtIDE7CiAJaW50IHJl
dDsKIAogCWZjdHggPSBjaGFuLT5mZW5jZSA9IGt6YWxsb2Moc2l6ZW9mKCpmY3R4KSwgR0ZQX0tF
Uk5FTCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF9vYmplY3QuaCBiL2Ry
aXZlcnMvZ3B1L2RybS9xeGwvcXhsX29iamVjdC5oCmluZGV4IGViZjI0YzlkMmJmMi4uZTYwYThm
ODhlMjI2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF9vYmplY3QuaAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF9vYmplY3QuaApAQCAtNTAsNyArNTAsNyBAQCBzdGF0
aWMgaW5saW5lIHZvaWQgcXhsX2JvX3VucmVzZXJ2ZShzdHJ1Y3QgcXhsX2JvICpibykKIAogc3Rh
dGljIGlubGluZSB1bnNpZ25lZCBsb25nIHF4bF9ib19zaXplKHN0cnVjdCBxeGxfYm8gKmJvKQog
ewotCXJldHVybiBiby0+dGJvLm51bV9wYWdlcyA8PCBQQUdFX1NISUZUOworCXJldHVybiBiby0+
dGJvLmJhc2Uuc2l6ZTsKIH0KIAogc3RhdGljIGlubGluZSB1NjQgcXhsX2JvX21tYXBfb2Zmc2V0
KHN0cnVjdCBxeGxfYm8gKmJvKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9y
YWRlb25fY3MuYyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX2NzLmMKaW5kZXggMjFj
ZTJmOTUwMmMwLi40ZjM1YzMyOTU3YmUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yYWRl
b24vcmFkZW9uX2NzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fY3MuYwpA
QCAtNDAxLDcgKzQwMSw4IEBAIHN0YXRpYyBpbnQgY21wX3NpemVfc21hbGxlcl9maXJzdCh2b2lk
ICpwcml2LCBzdHJ1Y3QgbGlzdF9oZWFkICphLAogCXN0cnVjdCByYWRlb25fYm9fbGlzdCAqbGIg
PSBsaXN0X2VudHJ5KGIsIHN0cnVjdCByYWRlb25fYm9fbGlzdCwgdHYuaGVhZCk7CiAKIAkvKiBT
b3J0IEEgYmVmb3JlIEIgaWYgQSBpcyBzbWFsbGVyLiAqLwotCXJldHVybiAoaW50KWxhLT5yb2Jq
LT50Ym8ubnVtX3BhZ2VzIC0gKGludClsYi0+cm9iai0+dGJvLm51bV9wYWdlczsKKwlyZXR1cm4g
KGludClsYS0+cm9iai0+dGJvLm1lbS5udW1fcGFnZXMgLQorCQkoaW50KWxiLT5yb2JqLT50Ym8u
bWVtLm51bV9wYWdlczsKIH0KIAogLyoqCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcmFk
ZW9uL3JhZGVvbl9vYmplY3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX29iamVj
dC5jCmluZGV4IGFiODFlMzVjYjA2MC4uOWE5OTk5MzBlM2RkIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9vYmplY3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vcmFk
ZW9uL3JhZGVvbl9vYmplY3QuYwpAQCAtNTQsMjAgKzU0LDE5IEBAIHN0YXRpYyB2b2lkIHJhZGVv
bl91cGRhdGVfbWVtb3J5X3VzYWdlKHN0cnVjdCByYWRlb25fYm8gKmJvLAogCQkJCSAgICAgICB1
bnNpZ25lZCBtZW1fdHlwZSwgaW50IHNpZ24pCiB7CiAJc3RydWN0IHJhZGVvbl9kZXZpY2UgKnJk
ZXYgPSBiby0+cmRldjsKLQl1NjQgc2l6ZSA9ICh1NjQpYm8tPnRiby5udW1fcGFnZXMgPDwgUEFH
RV9TSElGVDsKIAogCXN3aXRjaCAobWVtX3R5cGUpIHsKIAljYXNlIFRUTV9QTF9UVDoKIAkJaWYg
KHNpZ24gPiAwKQotCQkJYXRvbWljNjRfYWRkKHNpemUsICZyZGV2LT5ndHRfdXNhZ2UpOworCQkJ
YXRvbWljNjRfYWRkKGJvLT50Ym8uYmFzZS5zaXplLCAmcmRldi0+Z3R0X3VzYWdlKTsKIAkJZWxz
ZQotCQkJYXRvbWljNjRfc3ViKHNpemUsICZyZGV2LT5ndHRfdXNhZ2UpOworCQkJYXRvbWljNjRf
c3ViKGJvLT50Ym8uYmFzZS5zaXplLCAmcmRldi0+Z3R0X3VzYWdlKTsKIAkJYnJlYWs7CiAJY2Fz
ZSBUVE1fUExfVlJBTToKIAkJaWYgKHNpZ24gPiAwKQotCQkJYXRvbWljNjRfYWRkKHNpemUsICZy
ZGV2LT52cmFtX3VzYWdlKTsKKwkJCWF0b21pYzY0X2FkZChiby0+dGJvLmJhc2Uuc2l6ZSwgJnJk
ZXYtPnZyYW1fdXNhZ2UpOwogCQllbHNlCi0JCQlhdG9taWM2NF9zdWIoc2l6ZSwgJnJkZXYtPnZy
YW1fdXNhZ2UpOworCQkJYXRvbWljNjRfc3ViKGJvLT50Ym8uYmFzZS5zaXplLCAmcmRldi0+dnJh
bV91c2FnZSk7CiAJCWJyZWFrOwogCX0KIH0KQEAgLTI1Niw3ICsyNTUsNyBAQCBpbnQgcmFkZW9u
X2JvX2ttYXAoc3RydWN0IHJhZGVvbl9ibyAqYm8sIHZvaWQgKipwdHIpCiAJCX0KIAkJcmV0dXJu
IDA7CiAJfQotCXIgPSB0dG1fYm9fa21hcCgmYm8tPnRibywgMCwgYm8tPnRiby5udW1fcGFnZXMs
ICZiby0+a21hcCk7CisJciA9IHR0bV9ib19rbWFwKCZiby0+dGJvLCAwLCBiby0+dGJvLm1lbS5u
dW1fcGFnZXMsICZiby0+a21hcCk7CiAJaWYgKHIpIHsKIAkJcmV0dXJuIHI7CiAJfQpAQCAtNjEw
LDcgKzYwOSw3IEBAIGludCByYWRlb25fYm9fZ2V0X3N1cmZhY2VfcmVnKHN0cnVjdCByYWRlb25f
Ym8gKmJvKQogb3V0OgogCXJhZGVvbl9zZXRfc3VyZmFjZV9yZWcocmRldiwgaSwgYm8tPnRpbGlu
Z19mbGFncywgYm8tPnBpdGNoLAogCQkJICAgICAgIGJvLT50Ym8ubWVtLnN0YXJ0IDw8IFBBR0Vf
U0hJRlQsCi0JCQkgICAgICAgYm8tPnRiby5udW1fcGFnZXMgPDwgUEFHRV9TSElGVCk7CisJCQkg
ICAgICAgYm8tPnRiby5iYXNlLnNpemUpOwogCXJldHVybiAwOwogfQogCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9vYmplY3QuaCBiL2RyaXZlcnMvZ3B1L2RybS9y
YWRlb24vcmFkZW9uX29iamVjdC5oCmluZGV4IGQ2MDZlOWE5MzVlMy4uOTg5NmQ4MjMxZmU1IDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9vYmplY3QuaAorKysgYi9k
cml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9vYmplY3QuaApAQCAtMTA5LDEyICsxMDksMTIg
QEAgc3RhdGljIGlubGluZSB1NjQgcmFkZW9uX2JvX2dwdV9vZmZzZXQoc3RydWN0IHJhZGVvbl9i
byAqYm8pCiAKIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgbG9uZyByYWRlb25fYm9fc2l6ZShzdHJ1
Y3QgcmFkZW9uX2JvICpibykKIHsKLQlyZXR1cm4gYm8tPnRiby5udW1fcGFnZXMgPDwgUEFHRV9T
SElGVDsKKwlyZXR1cm4gYm8tPnRiby5iYXNlLnNpemU7CiB9CiAKIHN0YXRpYyBpbmxpbmUgdW5z
aWduZWQgcmFkZW9uX2JvX25ncHVfcGFnZXMoc3RydWN0IHJhZGVvbl9ibyAqYm8pCiB7Ci0JcmV0
dXJuIChiby0+dGJvLm51bV9wYWdlcyA8PCBQQUdFX1NISUZUKSAvIFJBREVPTl9HUFVfUEFHRV9T
SVpFOworCXJldHVybiBiby0+dGJvLmJhc2Uuc2l6ZSAvIFJBREVPTl9HUFVfUEFHRV9TSVpFOwog
fQogCiBzdGF0aWMgaW5saW5lIHVuc2lnbmVkIHJhZGVvbl9ib19ncHVfcGFnZV9hbGlnbm1lbnQo
c3RydWN0IHJhZGVvbl9ibyAqYm8pCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9u
L3JhZGVvbl9wcmltZS5jIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fcHJpbWUuYwpp
bmRleCAwODhkMzlhNTFjMGQuLjBhMDlkYmFiYTI4OSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL3JhZGVvbi9yYWRlb25fcHJpbWUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3Jh
ZGVvbl9wcmltZS5jCkBAIC0zNCw5ICszNCw5IEBACiBzdHJ1Y3Qgc2dfdGFibGUgKnJhZGVvbl9n
ZW1fcHJpbWVfZ2V0X3NnX3RhYmxlKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqKQogewogCXN0
cnVjdCByYWRlb25fYm8gKmJvID0gZ2VtX3RvX3JhZGVvbl9ibyhvYmopOwotCWludCBucGFnZXMg
PSBiby0+dGJvLm51bV9wYWdlczsKIAotCXJldHVybiBkcm1fcHJpbWVfcGFnZXNfdG9fc2cob2Jq
LT5kZXYsIGJvLT50Ym8udHRtLT5wYWdlcywgbnBhZ2VzKTsKKwlyZXR1cm4gZHJtX3ByaW1lX3Bh
Z2VzX3RvX3NnKG9iai0+ZGV2LCBiby0+dGJvLnR0bS0+cGFnZXMsCisJCQkJICAgICBiby0+dGJv
LnR0bS0+bnVtX3BhZ2VzKTsKIH0KIAogc3RydWN0IGRybV9nZW1fb2JqZWN0ICpyYWRlb25fZ2Vt
X3ByaW1lX2ltcG9ydF9zZ190YWJsZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LApkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fdHJhY2UuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9yYWRlb24vcmFkZW9uX3RyYWNlLmgKaW5kZXggYzkzZjNhYjNjNGUzLi4xNzI5Y2I5YTk1YzUg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX3RyYWNlLmgKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fdHJhY2UuaApAQCAtMjIsNyArMjIsNyBAQCBU
UkFDRV9FVkVOVChyYWRlb25fYm9fY3JlYXRlLAogCiAJICAgIFRQX2Zhc3RfYXNzaWduKAogCQkJ
ICAgX19lbnRyeS0+Ym8gPSBibzsKLQkJCSAgIF9fZW50cnktPnBhZ2VzID0gYm8tPnRiby5udW1f
cGFnZXM7CisJCQkgICBfX2VudHJ5LT5wYWdlcyA9IGJvLT50Ym8ubWVtLm51bV9wYWdlczsKIAkJ
CSAgICksCiAJICAgIFRQX3ByaW50aygiYm89JXAsIHBhZ2VzPSV1IiwgX19lbnRyeS0+Ym8sIF9f
ZW50cnktPnBhZ2VzKQogKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFk
ZW9uX3R0bS5jIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fdHRtLmMKaW5kZXggYTM0
MzJjNjM0M2JhLi5lYTM2NWFjNmY0ZjEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yYWRl
b24vcmFkZW9uX3R0bS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX3R0bS5j
CkBAIC0yNzQsNyArMjc0LDcgQEAgc3RhdGljIGludCByYWRlb25fYm9fbW92ZShzdHJ1Y3QgdHRt
X2J1ZmZlcl9vYmplY3QgKmJvLCBib29sIGV2aWN0LAogCiBvdXQ6CiAJLyogdXBkYXRlIHN0YXRp
c3RpY3MgKi8KLQlhdG9taWM2NF9hZGQoKHU2NCliby0+bnVtX3BhZ2VzIDw8IFBBR0VfU0hJRlQs
ICZyZGV2LT5udW1fYnl0ZXNfbW92ZWQpOworCWF0b21pYzY0X2FkZChiby0+YmFzZS5zaXplLCAm
cmRldi0+bnVtX2J5dGVzX21vdmVkKTsKIAlyYWRlb25fYm9fbW92ZV9ub3RpZnkoYm8sIGV2aWN0
LCBuZXdfbWVtKTsKIAlyZXR1cm4gMDsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90
dG0vdHRtX2JvLmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5jCmluZGV4IDAyY2M1ZDI0
N2MwZC4uNGVlZWI5Y2IwZDcyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9i
by5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvLmMKQEAgLTczLDggKzczLDggQEAg
c3RhdGljIHZvaWQgdHRtX2JvX21lbV9zcGFjZV9kZWJ1ZyhzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmpl
Y3QgKmJvLAogCWludCBpLCBtZW1fdHlwZTsKIAogCWRybV9wcmludGYoJnAsICJObyBzcGFjZSBm
b3IgJXAgKCVsdSBwYWdlcywgJWx1SywgJWx1TSlcbiIsCi0JCSAgIGJvLCBiby0+bWVtLm51bV9w
YWdlcywgYm8tPm1lbS5zaXplID4+IDEwLAotCQkgICBiby0+bWVtLnNpemUgPj4gMjApOworCQkg
ICBibywgYm8tPm1lbS5udW1fcGFnZXMsIGJvLT5iYXNlLnNpemUgPj4gMTAsCisJCSAgIGJvLT5i
YXNlLnNpemUgPj4gMjApOwogCWZvciAoaSA9IDA7IGkgPCBwbGFjZW1lbnQtPm51bV9wbGFjZW1l
bnQ7IGkrKykgewogCQltZW1fdHlwZSA9IHBsYWNlbWVudC0+cGxhY2VtZW50W2ldLm1lbV90eXBl
OwogCQlkcm1fcHJpbnRmKCZwLCAiICBwbGFjZW1lbnRbJWRdPTB4JTA4WCAoJWQpXG4iLApAQCAt
MjY4LDcgKzI2OCw3IEBAIHN0YXRpYyBpbnQgdHRtX2JvX2hhbmRsZV9tb3ZlX21lbShzdHJ1Y3Qg
dHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQlnb3RvIG91dF9lcnI7CiAJfQogCi0JY3R4LT5ieXRl
c19tb3ZlZCArPSBiby0+bnVtX3BhZ2VzIDw8IFBBR0VfU0hJRlQ7CisJY3R4LT5ieXRlc19tb3Zl
ZCArPSBiby0+YmFzZS5zaXplOwogCXJldHVybiAwOwogCiBvdXRfZXJyOgpAQCAtOTg1LDggKzk4
NSw3IEBAIHN0YXRpYyBpbnQgdHRtX2JvX21vdmVfYnVmZmVyKHN0cnVjdCB0dG1fYnVmZmVyX29i
amVjdCAqYm8sCiAKIAltZW1zZXQoJmhvcCwgMCwgc2l6ZW9mKGhvcCkpOwogCi0JbWVtLm51bV9w
YWdlcyA9IGJvLT5udW1fcGFnZXM7Ci0JbWVtLnNpemUgPSBtZW0ubnVtX3BhZ2VzIDw8IFBBR0Vf
U0hJRlQ7CisJbWVtLm51bV9wYWdlcyA9IFBBR0VfQUxJR04oYm8tPmJhc2Uuc2l6ZSkgPj4gUEFH
RV9TSElGVDsKIAltZW0ucGFnZV9hbGlnbm1lbnQgPSBiby0+bWVtLnBhZ2VfYWxpZ25tZW50Owog
CW1lbS5idXMub2Zmc2V0ID0gMDsKIAltZW0uYnVzLmFkZHIgPSBOVUxMOwpAQCAtMTEwMiw3ICsx
MTAxLDcgQEAgRVhQT1JUX1NZTUJPTCh0dG1fYm9fdmFsaWRhdGUpOwogCiBpbnQgdHRtX2JvX2lu
aXRfcmVzZXJ2ZWQoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCiAJCQkgc3RydWN0IHR0bV9i
dWZmZXJfb2JqZWN0ICpibywKLQkJCSB1bnNpZ25lZCBsb25nIHNpemUsCisJCQkgc2l6ZV90IHNp
emUsCiAJCQkgZW51bSB0dG1fYm9fdHlwZSB0eXBlLAogCQkJIHN0cnVjdCB0dG1fcGxhY2VtZW50
ICpwbGFjZW1lbnQsCiAJCQkgdWludDMyX3QgcGFnZV9hbGlnbm1lbnQsCkBAIC0xMTEzLDkgKzEx
MTIsOCBAQCBpbnQgdHRtX2JvX2luaXRfcmVzZXJ2ZWQoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJk
ZXYsCiAJCQkgdm9pZCAoKmRlc3Ryb3kpIChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKikpCiB7
CiAJc3RydWN0IHR0bV9tZW1fZ2xvYmFsICptZW1fZ2xvYiA9ICZ0dG1fbWVtX2dsb2I7Ci0JaW50
IHJldCA9IDA7Ci0JdW5zaWduZWQgbG9uZyBudW1fcGFnZXM7CiAJYm9vbCBsb2NrZWQ7CisJaW50
IHJldCA9IDA7CiAKIAlyZXQgPSB0dG1fbWVtX2dsb2JhbF9hbGxvYyhtZW1fZ2xvYiwgYWNjX3Np
emUsIGN0eCk7CiAJaWYgKHJldCkgewpAQCAtMTEyNywxNiArMTEyNSw2IEBAIGludCB0dG1fYm9f
aW5pdF9yZXNlcnZlZChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKIAkJcmV0dXJuIC1FTk9N
RU07CiAJfQogCi0JbnVtX3BhZ2VzID0gKHNpemUgKyBQQUdFX1NJWkUgLSAxKSA+PiBQQUdFX1NI
SUZUOwotCWlmIChudW1fcGFnZXMgPT0gMCkgewotCQlwcl9lcnIoIklsbGVnYWwgYnVmZmVyIG9i
amVjdCBzaXplXG4iKTsKLQkJaWYgKGRlc3Ryb3kpCi0JCQkoKmRlc3Ryb3kpKGJvKTsKLQkJZWxz
ZQotCQkJa2ZyZWUoYm8pOwotCQl0dG1fbWVtX2dsb2JhbF9mcmVlKG1lbV9nbG9iLCBhY2Nfc2l6
ZSk7Ci0JCXJldHVybiAtRUlOVkFMOwotCX0KIAliby0+ZGVzdHJveSA9IGRlc3Ryb3kgPyBkZXN0
cm95IDogdHRtX2JvX2RlZmF1bHRfZGVzdHJveTsKIAogCWtyZWZfaW5pdCgmYm8tPmtyZWYpOwpA
QCAtMTE0NSwxMCArMTEzMyw4IEBAIGludCB0dG1fYm9faW5pdF9yZXNlcnZlZChzdHJ1Y3QgdHRt
X2JvX2RldmljZSAqYmRldiwKIAlJTklUX0xJU1RfSEVBRCgmYm8tPnN3YXApOwogCWJvLT5iZGV2
ID0gYmRldjsKIAliby0+dHlwZSA9IHR5cGU7Ci0JYm8tPm51bV9wYWdlcyA9IG51bV9wYWdlczsK
LQliby0+bWVtLnNpemUgPSBudW1fcGFnZXMgPDwgUEFHRV9TSElGVDsKIAliby0+bWVtLm1lbV90
eXBlID0gVFRNX1BMX1NZU1RFTTsKLQliby0+bWVtLm51bV9wYWdlcyA9IGJvLT5udW1fcGFnZXM7
CisJYm8tPm1lbS5udW1fcGFnZXMgPSBQQUdFX0FMSUdOKHNpemUpID4+IFBBR0VfU0hJRlQ7CiAJ
Ym8tPm1lbS5tbV9ub2RlID0gTlVMTDsKIAliby0+bWVtLnBhZ2VfYWxpZ25tZW50ID0gcGFnZV9h
bGlnbm1lbnQ7CiAJYm8tPm1lbS5idXMub2Zmc2V0ID0gMDsKQEAgLTExNjYsOSArMTE1MiwxMCBA
QCBpbnQgdHRtX2JvX2luaXRfcmVzZXJ2ZWQoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCiAJ
fQogCWlmICghdHRtX2JvX3VzZXNfZW1iZWRkZWRfZ2VtX29iamVjdChibykpIHsKIAkJLyoKLQkJ
ICogYm8uZ2VtIGlzIG5vdCBpbml0aWFsaXplZCwgc28gd2UgaGF2ZSB0byBzZXR1cCB0aGUKKwkJ
ICogYm8uYmFzZSBpcyBub3QgaW5pdGlhbGl6ZWQsIHNvIHdlIGhhdmUgdG8gc2V0dXAgdGhlCiAJ
CSAqIHN0cnVjdCBlbGVtZW50cyB3ZSB3YW50IHVzZSByZWdhcmRsZXNzLgogCQkgKi8KKwkJYm8t
PmJhc2Uuc2l6ZSA9IHNpemU7CiAJCWRtYV9yZXN2X2luaXQoJmJvLT5iYXNlLl9yZXN2KTsKIAkJ
ZHJtX3ZtYV9ub2RlX3Jlc2V0KCZiby0+YmFzZS52bWFfbm9kZSk7CiAJfQpAQCAtMTIxMCw3ICsx
MTk3LDcgQEAgRVhQT1JUX1NZTUJPTCh0dG1fYm9faW5pdF9yZXNlcnZlZCk7CiAKIGludCB0dG1f
Ym9faW5pdChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKIAkJc3RydWN0IHR0bV9idWZmZXJf
b2JqZWN0ICpibywKLQkJdW5zaWduZWQgbG9uZyBzaXplLAorCQlzaXplX3Qgc2l6ZSwKIAkJZW51
bSB0dG1fYm9fdHlwZSB0eXBlLAogCQlzdHJ1Y3QgdHRtX3BsYWNlbWVudCAqcGxhY2VtZW50LAog
CQl1aW50MzJfdCBwYWdlX2FsaWdubWVudCwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90
dG0vdHRtX2JvX3V0aWwuYyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3V0aWwuYwppbmRl
eCA1YmJjMTMzOWQyOGUuLjM5OGQ1MDEzZmMzOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L3R0bS90dG1fYm9fdXRpbC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3V0aWwu
YwpAQCAtNDMxLDkgKzQzMSw5IEBAIGludCB0dG1fYm9fa21hcChzdHJ1Y3QgdHRtX2J1ZmZlcl9v
YmplY3QgKmJvLAogCiAJbWFwLT52aXJ0dWFsID0gTlVMTDsKIAltYXAtPmJvID0gYm87Ci0JaWYg
KG51bV9wYWdlcyA+IGJvLT5udW1fcGFnZXMpCisJaWYgKG51bV9wYWdlcyA+IGJvLT5tZW0ubnVt
X3BhZ2VzKQogCQlyZXR1cm4gLUVJTlZBTDsKLQlpZiAoc3RhcnRfcGFnZSA+IGJvLT5udW1fcGFn
ZXMpCisJaWYgKChzdGFydF9wYWdlICsgbnVtX3BhZ2VzKSA+IGJvLT5tZW0ubnVtX3BhZ2VzKQog
CQlyZXR1cm4gLUVJTlZBTDsKIAogCXJldCA9IHR0bV9tZW1faW9fcmVzZXJ2ZShiby0+YmRldiwg
JmJvLT5tZW0pOwpAQCAtNDg1LDE0ICs0ODUsMTQgQEAgaW50IHR0bV9ib192bWFwKHN0cnVjdCB0
dG1fYnVmZmVyX29iamVjdCAqYm8sIHN0cnVjdCBkbWFfYnVmX21hcCAqbWFwKQogCiAJaWYgKG1l
bS0+YnVzLmlzX2lvbWVtKSB7CiAJCXZvaWQgX19pb21lbSAqdmFkZHJfaW9tZW07Ci0JCXNpemVf
dCBzaXplID0gYm8tPm51bV9wYWdlcyA8PCBQQUdFX1NISUZUOwogCiAJCWlmIChtZW0tPmJ1cy5h
ZGRyKQogCQkJdmFkZHJfaW9tZW0gPSAodm9pZCBfX2lvbWVtICopbWVtLT5idXMuYWRkcjsKIAkJ
ZWxzZSBpZiAobWVtLT5idXMuY2FjaGluZyA9PSB0dG1fd3JpdGVfY29tYmluZWQpCi0JCQl2YWRk
cl9pb21lbSA9IGlvcmVtYXBfd2MobWVtLT5idXMub2Zmc2V0LCBzaXplKTsKKwkJCXZhZGRyX2lv
bWVtID0gaW9yZW1hcF93YyhtZW0tPmJ1cy5vZmZzZXQsCisJCQkJCQkgYm8tPmJhc2Uuc2l6ZSk7
CiAJCWVsc2UKLQkJCXZhZGRyX2lvbWVtID0gaW9yZW1hcChtZW0tPmJ1cy5vZmZzZXQsIHNpemUp
OworCQkJdmFkZHJfaW9tZW0gPSBpb3JlbWFwKG1lbS0+YnVzLm9mZnNldCwgYm8tPmJhc2Uuc2l6
ZSk7CiAKIAkJaWYgKCF2YWRkcl9pb21lbSkKIAkJCXJldHVybiAtRU5PTUVNOwpAQCAtNTE3LDcg
KzUxNyw3IEBAIGludCB0dG1fYm9fdm1hcChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLCBz
dHJ1Y3QgZG1hX2J1Zl9tYXAgKm1hcCkKIAkJICogb3IgdG8gbWFrZSB0aGUgYnVmZmVyIG9iamVj
dCBsb29rIGNvbnRpZ3VvdXMuCiAJCSAqLwogCQlwcm90ID0gdHRtX2lvX3Byb3QoYm8sIG1lbSwg
UEFHRV9LRVJORUwpOwotCQl2YWRkciA9IHZtYXAodHRtLT5wYWdlcywgYm8tPm51bV9wYWdlcywg
MCwgcHJvdCk7CisJCXZhZGRyID0gdm1hcCh0dG0tPnBhZ2VzLCB0dG0tPm51bV9wYWdlcywgMCwg
cHJvdCk7CiAJCWlmICghdmFkZHIpCiAJCQlyZXR1cm4gLUVOT01FTTsKIApkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm9fdm0uYyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRt
X2JvX3ZtLmMKaW5kZXggMTQ0YTQ5NDBiNmI2Li42ZGM5NmNmNjY3NDQgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3ZtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90
dG1fYm9fdm0uYwpAQCAtMTk4LDcgKzE5OCw3IEBAIHN0YXRpYyB2bV9mYXVsdF90IHR0bV9ib192
bV9pbnNlcnRfaHVnZShzdHJ1Y3Qgdm1fZmF1bHQgKnZtZiwKIAogCS8qIEZhdWx0IHNob3VsZCBu
b3QgY3Jvc3MgYm8gYm91bmRhcnkuICovCiAJcGFnZV9vZmZzZXQgJj0gfihmYXVsdF9wYWdlX3Np
emUgLSAxKTsKLQlpZiAocGFnZV9vZmZzZXQgKyBmYXVsdF9wYWdlX3NpemUgPiBiby0+bnVtX3Bh
Z2VzKQorCWlmIChwYWdlX29mZnNldCArIGZhdWx0X3BhZ2Vfc2l6ZSA+IGJvLT5tZW0ubnVtX3Bh
Z2VzKQogCQlnb3RvIG91dF9mYWxsYmFjazsKIAogCWlmIChiby0+bWVtLmJ1cy5pc19pb21lbSkK
QEAgLTMwNiw3ICszMDYsNyBAQCB2bV9mYXVsdF90IHR0bV9ib192bV9mYXVsdF9yZXNlcnZlZChz
dHJ1Y3Qgdm1fZmF1bHQgKnZtZiwKIAlwYWdlX2xhc3QgPSB2bWFfcGFnZXModm1hKSArIHZtYS0+
dm1fcGdvZmYgLQogCQlkcm1fdm1hX25vZGVfc3RhcnQoJmJvLT5iYXNlLnZtYV9ub2RlKTsKIAot
CWlmICh1bmxpa2VseShwYWdlX29mZnNldCA+PSBiby0+bnVtX3BhZ2VzKSkKKwlpZiAodW5saWtl
bHkocGFnZV9vZmZzZXQgPj0gYm8tPm1lbS5udW1fcGFnZXMpKQogCQlyZXR1cm4gVk1fRkFVTFRf
U0lHQlVTOwogCiAJcHJvdCA9IHR0bV9pb19wcm90KGJvLCAmYm8tPm1lbSwgcHJvdCk7CkBAIC00
NjksNyArNDY5LDcgQEAgaW50IHR0bV9ib192bV9hY2Nlc3Moc3RydWN0IHZtX2FyZWFfc3RydWN0
ICp2bWEsIHVuc2lnbmVkIGxvbmcgYWRkciwKIAkJIDw8IFBBR0VfU0hJRlQpOwogCWludCByZXQ7
CiAKLQlpZiAobGVuIDwgMSB8fCAob2Zmc2V0ICsgbGVuKSA+PiBQQUdFX1NISUZUID4gYm8tPm51
bV9wYWdlcykKKwlpZiAobGVuIDwgMSB8fCAob2Zmc2V0ICsgbGVuKSA+PiBQQUdFX1NISUZUID4g
Ym8tPm1lbS5udW1fcGFnZXMpCiAJCXJldHVybiAtRUlPOwogCiAJcmV0ID0gdHRtX2JvX3Jlc2Vy
dmUoYm8sIHRydWUsIGZhbHNlLCBOVUxMKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90
dG0vdHRtX3R0LmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV90dC5jCmluZGV4IDc3YmE3ODQ0
MjVkZC4uN2Y3NWExMzE2M2YwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV90
dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3R0LmMKQEAgLTEyOSw3ICsxMjksNyBA
QCBzdGF0aWMgdm9pZCB0dG1fdHRfaW5pdF9maWVsZHMoc3RydWN0IHR0bV90dCAqdHRtLAogCQkJ
ICAgICAgIHVpbnQzMl90IHBhZ2VfZmxhZ3MsCiAJCQkgICAgICAgZW51bSB0dG1fY2FjaGluZyBj
YWNoaW5nKQogewotCXR0bS0+bnVtX3BhZ2VzID0gYm8tPm51bV9wYWdlczsKKwl0dG0tPm51bV9w
YWdlcyA9IFBBR0VfQUxJR04oYm8tPmJhc2Uuc2l6ZSkgPj4gUEFHRV9TSElGVDsKIAl0dG0tPmNh
Y2hpbmcgPSB0dG1fY2FjaGVkOwogCXR0bS0+cGFnZV9mbGFncyA9IHBhZ2VfZmxhZ3M7CiAJdHRt
LT5kbWFfYWRkcmVzcyA9IE5VTEw7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4
L3Ztd2dmeF9ibGl0LmMgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9ibGl0LmMKaW5k
ZXggZjIxODgxZTA4N2RiLi45ZjI3NzlkZGNmMDggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS92bXdnZngvdm13Z2Z4X2JsaXQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dm
eF9ibGl0LmMKQEAgLTQ4Miw4ICs0ODIsOCBAQCBpbnQgdm13X2JvX2NwdV9ibGl0KHN0cnVjdCB0
dG1fYnVmZmVyX29iamVjdCAqZHN0LAogCWQuc3JjX2FkZHIgPSBOVUxMOwogCWQuZHN0X3BhZ2Vz
ID0gZHN0LT50dG0tPnBhZ2VzOwogCWQuc3JjX3BhZ2VzID0gc3JjLT50dG0tPnBhZ2VzOwotCWQu
ZHN0X251bV9wYWdlcyA9IGRzdC0+bnVtX3BhZ2VzOwotCWQuc3JjX251bV9wYWdlcyA9IHNyYy0+
bnVtX3BhZ2VzOworCWQuZHN0X251bV9wYWdlcyA9IGRzdC0+bWVtLm51bV9wYWdlczsKKwlkLnNy
Y19udW1fcGFnZXMgPSBzcmMtPm1lbS5udW1fcGFnZXM7CiAJZC5kc3RfcHJvdCA9IHR0bV9pb19w
cm90KGRzdCwgJmRzdC0+bWVtLCBQQUdFX0tFUk5FTCk7CiAJZC5zcmNfcHJvdCA9IHR0bV9pb19w
cm90KHNyYywgJnNyYy0+bWVtLCBQQUdFX0tFUk5FTCk7CiAJZC5kaWZmID0gZGlmZjsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2JvLmMgYi9kcml2ZXJzL2dwdS9k
cm0vdm13Z2Z4L3Ztd2dmeF9iby5jCmluZGV4IDI2M2Q3NmFlNDNmMC4uNjNkYmM0NGVlYmUwIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9iby5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2JvLmMKQEAgLTIyMyw3ICsyMjMsNyBAQCBpbnQgdm13
X2JvX3Bpbl9pbl9zdGFydF9vZl92cmFtKHN0cnVjdCB2bXdfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJ
dWludDMyX3QgbmV3X2ZsYWdzOwogCiAJcGxhY2UgPSB2bXdfdnJhbV9wbGFjZW1lbnQucGxhY2Vt
ZW50WzBdOwotCXBsYWNlLmxwZm4gPSBiby0+bnVtX3BhZ2VzOworCXBsYWNlLmxwZm4gPSBiby0+
bWVtLm51bV9wYWdlczsKIAlwbGFjZW1lbnQubnVtX3BsYWNlbWVudCA9IDE7CiAJcGxhY2VtZW50
LnBsYWNlbWVudCA9ICZwbGFjZTsKIAlwbGFjZW1lbnQubnVtX2J1c3lfcGxhY2VtZW50ID0gMTsK
QEAgLTI0NCw3ICsyNDQsNyBAQCBpbnQgdm13X2JvX3Bpbl9pbl9zdGFydF9vZl92cmFtKHN0cnVj
dCB2bXdfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJICogdGhhdCBzaXR1YXRpb24uCiAJICovCiAJaWYg
KGJvLT5tZW0ubWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0gJiYKLQkgICAgYm8tPm1lbS5zdGFydCA8
IGJvLT5udW1fcGFnZXMgJiYKKwkgICAgYm8tPm1lbS5zdGFydCA8IGJvLT5tZW0ubnVtX3BhZ2Vz
ICYmCiAJICAgIGJvLT5tZW0uc3RhcnQgPiAwICYmCiAJICAgIGJ1Zi0+YmFzZS5waW5fY291bnQg
PT0gMCkgewogCQljdHguaW50ZXJydXB0aWJsZSA9IGZhbHNlOwpAQCAtMzkxLDcgKzM5MSw3IEBA
IHZvaWQgKnZtd19ib19tYXBfYW5kX2NhY2hlKHN0cnVjdCB2bXdfYnVmZmVyX29iamVjdCAqdmJv
KQogCWlmICh2aXJ0dWFsKQogCQlyZXR1cm4gdmlydHVhbDsKIAotCXJldCA9IHR0bV9ib19rbWFw
KGJvLCAwLCBiby0+bnVtX3BhZ2VzLCAmdmJvLT5tYXApOworCXJldCA9IHR0bV9ib19rbWFwKGJv
LCAwLCBiby0+bWVtLm51bV9wYWdlcywgJnZiby0+bWFwKTsKIAlpZiAocmV0KQogCQlEUk1fRVJS
T1IoIkJ1ZmZlciBvYmplY3QgbWFwIGZhaWxlZDogJWQuXG4iLCByZXQpOwogCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9jb3RhYmxlLmMgYi9kcml2ZXJzL2dwdS9k
cm0vdm13Z2Z4L3Ztd2dmeF9jb3RhYmxlLmMKaW5kZXggOTg0ZDg4ODQzNTdkLi5hMDc3ZTQyMGQy
ZmYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2NvdGFibGUuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9jb3RhYmxlLmMKQEAgLTQzMCw3ICs0
MzAsNyBAQCBzdGF0aWMgaW50IHZtd19jb3RhYmxlX3Jlc2l6ZShzdHJ1Y3Qgdm13X3Jlc291cmNl
ICpyZXMsIHNpemVfdCBuZXdfc2l6ZSkKIAkgKiBEbyBhIHBhZ2UgYnkgcGFnZSBjb3B5IG9mIENP
VGFibGVzLiBUaGlzIGVsaW1pbmF0ZXMgc2xvdyB2bWFwKClzLgogCSAqIFRoaXMgc2hvdWxkIHJl
YWxseSBiZSBhIFRUTSB1dGlsaXR5LgogCSAqLwotCWZvciAoaSA9IDA7IGkgPCBvbGRfYm8tPm51
bV9wYWdlczsgKytpKSB7CisJZm9yIChpID0gMDsgaSA8IG9sZF9iby0+bWVtLm51bV9wYWdlczsg
KytpKSB7CiAJCWJvb2wgZHVtbXk7CiAKIAkJcmV0ID0gdHRtX2JvX2ttYXAob2xkX2JvLCBpLCAx
LCAmb2xkX21hcCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9l
eGVjYnVmLmMgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9leGVjYnVmLmMKaW5kZXgg
ZTY3ZTJlOGY2ZTZmLi42YzAxNjAwMTcyMWQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92
bXdnZngvdm13Z2Z4X2V4ZWNidWYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dm
eF9leGVjYnVmLmMKQEAgLTEwNDIsNyArMTA0Miw3IEBAIHN0YXRpYyBpbnQgdm13X3F1ZXJ5X2Jv
X3N3aXRjaF9wcmVwYXJlKHN0cnVjdCB2bXdfcHJpdmF0ZSAqZGV2X3ByaXYsCiAKIAlpZiAodW5s
aWtlbHkobmV3X3F1ZXJ5X2JvICE9IHN3X2NvbnRleHQtPmN1cl9xdWVyeV9ibykpIHsKIAotCQlp
ZiAodW5saWtlbHkobmV3X3F1ZXJ5X2JvLT5iYXNlLm51bV9wYWdlcyA+IDQpKSB7CisJCWlmICh1
bmxpa2VseShuZXdfcXVlcnlfYm8tPmJhc2UubWVtLm51bV9wYWdlcyA+IDQpKSB7CiAJCQlWTVdf
REVCVUdfVVNFUigiUXVlcnkgYnVmZmVyIHRvbyBsYXJnZS5cbiIpOwogCQkJcmV0dXJuIC1FSU5W
QUw7CiAJCX0KQEAgLTE1NDEsNyArMTU0MSw3IEBAIHN0YXRpYyBpbnQgdm13X2NtZF9kbWEoc3Ry
dWN0IHZtd19wcml2YXRlICpkZXZfcHJpdiwKIAkJcmV0dXJuIHJldDsKIAogCS8qIE1ha2Ugc3Vy
ZSBETUEgZG9lc24ndCBjcm9zcyBCTyBib3VuZGFyaWVzLiAqLwotCWJvX3NpemUgPSB2bXdfYm8t
PmJhc2UubnVtX3BhZ2VzICogUEFHRV9TSVpFOworCWJvX3NpemUgPSB2bXdfYm8tPmJhc2UuYmFz
ZS5zaXplOwogCWlmICh1bmxpa2VseShjbWQtPmJvZHkuZ3Vlc3QucHRyLm9mZnNldCA+IGJvX3Np
emUpKSB7CiAJCVZNV19ERUJVR19VU0VSKCJJbnZhbGlkIERNQSBvZmZzZXQuXG4iKTsKIAkJcmV0
dXJuIC1FSU5WQUw7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9n
bXJpZF9tYW5hZ2VyLmMgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9nbXJpZF9tYW5h
Z2VyLmMKaW5kZXggOGZlMjZlMzJmOTIwLi4xNzc0OTYwZDFiODkgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2dtcmlkX21hbmFnZXIuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vdm13Z2Z4L3Ztd2dmeF9nbXJpZF9tYW5hZ2VyLmMKQEAgLTY0LDIwICs2NCwxOSBAQCBz
dGF0aWMgaW50IHZtd19nbXJpZF9tYW5fZ2V0X25vZGUoc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5h
Z2VyICptYW4sCiAJc3Bpbl9sb2NrKCZnbWFuLT5sb2NrKTsKIAogCWlmIChnbWFuLT5tYXhfZ21y
X3BhZ2VzID4gMCkgewotCQlnbWFuLT51c2VkX2dtcl9wYWdlcyArPSBiby0+bnVtX3BhZ2VzOwor
CQlnbWFuLT51c2VkX2dtcl9wYWdlcyArPSBtZW0tPm51bV9wYWdlczsKIAkJaWYgKHVubGlrZWx5
KGdtYW4tPnVzZWRfZ21yX3BhZ2VzID4gZ21hbi0+bWF4X2dtcl9wYWdlcykpCiAJCQlnb3RvIG5v
c3BhY2U7CiAJfQogCiAJbWVtLT5tbV9ub2RlID0gZ21hbjsKIAltZW0tPnN0YXJ0ID0gaWQ7Ci0J
bWVtLT5udW1fcGFnZXMgPSBiby0+bnVtX3BhZ2VzOwogCiAJc3Bpbl91bmxvY2soJmdtYW4tPmxv
Y2spOwogCXJldHVybiAwOwogCiBub3NwYWNlOgotCWdtYW4tPnVzZWRfZ21yX3BhZ2VzIC09IGJv
LT5udW1fcGFnZXM7CisJZ21hbi0+dXNlZF9nbXJfcGFnZXMgLT0gbWVtLT5udW1fcGFnZXM7CiAJ
c3Bpbl91bmxvY2soJmdtYW4tPmxvY2spOwogCWlkYV9mcmVlKCZnbWFuLT5nbXJfaWRhLCBpZCk7
CiAJcmV0dXJuIC1FTk9TUEM7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Zt
d2dmeF9rbXMuYyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2ttcy5jCmluZGV4IGJj
NjdmMmI5MzBlMS4uN2RjOTYxMjVlNWMyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdm13
Z2Z4L3Ztd2dmeF9rbXMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9rbXMu
YwpAQCAtMTIyMCw3ICsxMjIwLDcgQEAgc3RhdGljIGludCB2bXdfa21zX25ld19mcmFtZWJ1ZmZl
cl9ibyhzdHJ1Y3Qgdm13X3ByaXZhdGUgKmRldl9wcml2LAogCWludCByZXQ7CiAKIAlyZXF1ZXN0
ZWRfc2l6ZSA9IG1vZGVfY21kLT5oZWlnaHQgKiBtb2RlX2NtZC0+cGl0Y2hlc1swXTsKLQlpZiAo
dW5saWtlbHkocmVxdWVzdGVkX3NpemUgPiBiby0+YmFzZS5udW1fcGFnZXMgKiBQQUdFX1NJWkUp
KSB7CisJaWYgKHVubGlrZWx5KHJlcXVlc3RlZF9zaXplID4gYm8tPmJhc2UuYmFzZS5zaXplKSkg
ewogCQlEUk1fRVJST1IoIlNjcmVlbiBidWZmZXIgb2JqZWN0IHNpemUgaXMgdG9vIHNtYWxsICIK
IAkJCSAgImZvciByZXF1ZXN0ZWQgbW9kZS5cbiIpOwogCQlyZXR1cm4gLUVJTlZBTDsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3BhZ2VfZGlydHkuYyBiL2RyaXZl
cnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3BhZ2VfZGlydHkuYwppbmRleCAwYjc2YjNkMTdkNGMu
LjBhOTAwYWZjNjZmZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhf
cGFnZV9kaXJ0eS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3BhZ2VfZGly
dHkuYwpAQCAtMjMyLDcgKzIzMiw3IEBAIHZvaWQgdm13X2JvX2RpcnR5X3VubWFwKHN0cnVjdCB2
bXdfYnVmZmVyX29iamVjdCAqdmJvLAogaW50IHZtd19ib19kaXJ0eV9hZGQoc3RydWN0IHZtd19i
dWZmZXJfb2JqZWN0ICp2Ym8pCiB7CiAJc3RydWN0IHZtd19ib19kaXJ0eSAqZGlydHkgPSB2Ym8t
PmRpcnR5OwotCXBnb2ZmX3QgbnVtX3BhZ2VzID0gdmJvLT5iYXNlLm51bV9wYWdlczsKKwlwZ29m
Zl90IG51bV9wYWdlcyA9IHZiby0+YmFzZS5tZW0ubnVtX3BhZ2VzOwogCXNpemVfdCBzaXplLCBh
Y2Nfc2l6ZTsKIAlpbnQgcmV0OwogCXN0YXRpYyBzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHggY3R4
ID0gewpAQCAtNDEzLDcgKzQxMyw3IEBAIHZtX2ZhdWx0X3Qgdm13X2JvX3ZtX21rd3JpdGUoc3Ry
dWN0IHZtX2ZhdWx0ICp2bWYpCiAJCXJldHVybiByZXQ7CiAKIAlwYWdlX29mZnNldCA9IHZtZi0+
cGdvZmYgLSBkcm1fdm1hX25vZGVfc3RhcnQoJmJvLT5iYXNlLnZtYV9ub2RlKTsKLQlpZiAodW5s
aWtlbHkocGFnZV9vZmZzZXQgPj0gYm8tPm51bV9wYWdlcykpIHsKKwlpZiAodW5saWtlbHkocGFn
ZV9vZmZzZXQgPj0gYm8tPm1lbS5udW1fcGFnZXMpKSB7CiAJCXJldCA9IFZNX0ZBVUxUX1NJR0JV
UzsKIAkJZ290byBvdXRfdW5sb2NrOwogCX0KQEAgLTQ1Niw3ICs0NTYsNyBAQCB2bV9mYXVsdF90
IHZtd19ib192bV9mYXVsdChzdHJ1Y3Qgdm1fZmF1bHQgKnZtZikKIAogCQlwYWdlX29mZnNldCA9
IHZtZi0+cGdvZmYgLQogCQkJZHJtX3ZtYV9ub2RlX3N0YXJ0KCZiby0+YmFzZS52bWFfbm9kZSk7
Ci0JCWlmIChwYWdlX29mZnNldCA+PSBiby0+bnVtX3BhZ2VzIHx8CisJCWlmIChwYWdlX29mZnNl
dCA+PSBiby0+bWVtLm51bV9wYWdlcyB8fAogCQkgICAgdm13X3Jlc291cmNlc19jbGVhbih2Ym8s
IHBhZ2Vfb2Zmc2V0LAogCQkJCQlwYWdlX29mZnNldCArIFBBR0VfU0laRSwKIAkJCQkJJmFsbG93
ZWRfcHJlZmF1bHQpKSB7CkBAIC01MzEsNyArNTMxLDcgQEAgdm1fZmF1bHRfdCB2bXdfYm9fdm1f
aHVnZV9mYXVsdChzdHJ1Y3Qgdm1fZmF1bHQgKnZtZiwKIAogCQlwYWdlX29mZnNldCA9IHZtZi0+
cGdvZmYgLQogCQkJZHJtX3ZtYV9ub2RlX3N0YXJ0KCZiby0+YmFzZS52bWFfbm9kZSk7Ci0JCWlm
IChwYWdlX29mZnNldCA+PSBiby0+bnVtX3BhZ2VzIHx8CisJCWlmIChwYWdlX29mZnNldCA+PSBi
by0+bWVtLm51bV9wYWdlcyB8fAogCQkgICAgdm13X3Jlc291cmNlc19jbGVhbih2Ym8sIHBhZ2Vf
b2Zmc2V0LAogCQkJCQlwYWdlX29mZnNldCArIFBBR0VfU0laRSwKIAkJCQkJJmFsbG93ZWRfcHJl
ZmF1bHQpKSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9yZXNv
dXJjZS5jIGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfcmVzb3VyY2UuYwppbmRleCAw
MGI1MzU4MzFhN2EuLmY2ZThmZGZjNzZlNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Zt
d2dmeC92bXdnZnhfcmVzb3VyY2UuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dm
eF9yZXNvdXJjZS5jCkBAIC0zNjAsNyArMzYwLDcgQEAgc3RhdGljIGludCB2bXdfcmVzb3VyY2Vf
YnVmX2FsbG9jKHN0cnVjdCB2bXdfcmVzb3VyY2UgKnJlcywKIAlpbnQgcmV0OwogCiAJaWYgKGxp
a2VseShyZXMtPmJhY2t1cCkpIHsKLQkJQlVHX09OKHJlcy0+YmFja3VwLT5iYXNlLm51bV9wYWdl
cyAqIFBBR0VfU0laRSA8IHNpemUpOworCQlCVUdfT04ocmVzLT5iYWNrdXAtPmJhc2UuYmFzZS5z
aXplIDwgc2l6ZSk7CiAJCXJldHVybiAwOwogCX0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL3Ztd2dmeC92bXdnZnhfc2hhZGVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dm
eF9zaGFkZXIuYwppbmRleCBmMzI4YWE1ODM5YTIuLmU3NmE3MjBmODQxZSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfc2hhZGVyLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL3Ztd2dmeC92bXdnZnhfc2hhZGVyLmMKQEAgLTg1Niw4ICs4NTYsNyBAQCBzdGF0aWMgaW50
IHZtd19zaGFkZXJfZGVmaW5lKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHN0cnVjdCBkcm1fZmls
ZSAqZmlsZV9wcml2LAogCQkJcmV0dXJuIHJldDsKIAkJfQogCi0JCWlmICgodTY0KWJ1ZmZlci0+
YmFzZS5udW1fcGFnZXMgKiBQQUdFX1NJWkUgPAotCQkgICAgKHU2NClzaXplICsgKHU2NClvZmZz
ZXQpIHsKKwkJaWYgKCh1NjQpYnVmZmVyLT5iYXNlLmJhc2Uuc2l6ZSA8ICh1NjQpc2l6ZSArICh1
NjQpb2Zmc2V0KSB7CiAJCQlWTVdfREVCVUdfVVNFUigiSWxsZWdhbCBidWZmZXItIG9yIHNoYWRl
ciBzaXplLlxuIik7CiAJCQlyZXQgPSAtRUlOVkFMOwogCQkJZ290byBvdXRfYmFkX2FyZzsKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3N0ZHUuYyBiL2RyaXZlcnMv
Z3B1L2RybS92bXdnZngvdm13Z2Z4X3N0ZHUuYwppbmRleCA1YjA0ZWMwNDdlZjMuLjI3YWIyYzUw
MzEyYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfc3RkdS5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3N0ZHUuYwpAQCAtNTEyLDcgKzUxMiw3
IEBAIHN0YXRpYyB2b2lkIHZtd19zdGR1X2JvX2ZpZm9fY29tbWl0KHN0cnVjdCB2bXdfa21zX2Rp
cnR5ICpkaXJ0eSkKIAljbWQtPmJvZHkuaG9zdC5taXBtYXAgPSAwOwogCWNtZC0+Ym9keS50cmFu
c2ZlciA9IGRkaXJ0eS0+dHJhbnNmZXI7CiAJc3VmZml4LT5zdWZmaXhTaXplID0gc2l6ZW9mKCpz
dWZmaXgpOwotCXN1ZmZpeC0+bWF4aW11bU9mZnNldCA9IGRkaXJ0eS0+YnVmLT5iYXNlLm51bV9w
YWdlcyAqIFBBR0VfU0laRTsKKwlzdWZmaXgtPm1heGltdW1PZmZzZXQgPSBkZGlydHktPmJ1Zi0+
YmFzZS5iYXNlLnNpemU7CiAKIAlpZiAoZGRpcnR5LT50cmFuc2ZlciA9PSBTVkdBM0RfV1JJVEVf
SE9TVF9WUkFNKSB7CiAJCWJsaXRfc2l6ZSArPSBzaXplb2Yoc3RydWN0IHZtd19zdGR1X3VwZGF0
ZSk7CkBAIC0xMjM4LDcgKzEyMzgsNyBAQCBzdGF0aWMgdWludDMyX3Qgdm13X3N0ZHVfYm9fcG9w
dWxhdGVfdXBkYXRlKHN0cnVjdCB2bXdfZHVfdXBkYXRlX3BsYW5lICAqdXBkYXRlLAogCXZmYmJv
ID0gY29udGFpbmVyX29mKHVwZGF0ZS0+dmZiLCB0eXBlb2YoKnZmYmJvKSwgYmFzZSk7CiAKIAlz
dWZmaXgtPnN1ZmZpeFNpemUgPSBzaXplb2YoKnN1ZmZpeCk7Ci0Jc3VmZml4LT5tYXhpbXVtT2Zm
c2V0ID0gdmZiYm8tPmJ1ZmZlci0+YmFzZS5udW1fcGFnZXMgKiBQQUdFX1NJWkU7CisJc3VmZml4
LT5tYXhpbXVtT2Zmc2V0ID0gdmZiYm8tPmJ1ZmZlci0+YmFzZS5iYXNlLnNpemU7CiAKIAl2bXdf
c3RkdV9wb3B1bGF0ZV91cGRhdGUoJnN1ZmZpeFsxXSwgc3RkdS0+YmFzZS51bml0LCBiYi0+eDEs
IGJiLT54MiwKIAkJCQkgYmItPnkxLCBiYi0+eTIpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL3Ztd2dmeC92bXdnZnhfc3VyZmFjZS5jIGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdn
Znhfc3VyZmFjZS5jCmluZGV4IDM5MTRiZmVlMDUzMy4uZmE5YmUzMGJlYzZjIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9zdXJmYWNlLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL3Ztd2dmeC92bXdnZnhfc3VyZmFjZS5jCkBAIC0xNTUwLDggKzE1NTAsNyBAQCB2bXdf
Z2Jfc3VyZmFjZV9kZWZpbmVfaW50ZXJuYWwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKIAkJCQkJ
ICZyZXMtPmJhY2t1cCwKIAkJCQkJICZ1c2VyX3NyZi0+YmFja3VwX2Jhc2UpOwogCQlpZiAocmV0
ID09IDApIHsKLQkJCWlmIChyZXMtPmJhY2t1cC0+YmFzZS5udW1fcGFnZXMgKiBQQUdFX1NJWkUg
PAotCQkJICAgIHJlcy0+YmFja3VwX3NpemUpIHsKKwkJCWlmIChyZXMtPmJhY2t1cC0+YmFzZS5i
YXNlLnNpemUgPCByZXMtPmJhY2t1cF9zaXplKSB7CiAJCQkJVk1XX0RFQlVHX1VTRVIoIlN1cmZh
Y2UgYmFja3VwIGJ1ZmZlciB0b28gc21hbGwuXG4iKTsKIAkJCQl2bXdfYm9fdW5yZWZlcmVuY2Uo
JnJlcy0+YmFja3VwKTsKIAkJCQlyZXQgPSAtRUlOVkFMOwpAQCAtMTYxNCw3ICsxNjEzLDcgQEAg
dm13X2diX3N1cmZhY2VfZGVmaW5lX2ludGVybmFsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJ
aWYgKHJlcy0+YmFja3VwKSB7CiAJCXJlcC0+YnVmZmVyX21hcF9oYW5kbGUgPQogCQkJZHJtX3Zt
YV9ub2RlX29mZnNldF9hZGRyKCZyZXMtPmJhY2t1cC0+YmFzZS5iYXNlLnZtYV9ub2RlKTsKLQkJ
cmVwLT5idWZmZXJfc2l6ZSA9IHJlcy0+YmFja3VwLT5iYXNlLm51bV9wYWdlcyAqIFBBR0VfU0la
RTsKKwkJcmVwLT5idWZmZXJfc2l6ZSA9IHJlcy0+YmFja3VwLT5iYXNlLmJhc2Uuc2l6ZTsKIAkJ
cmVwLT5idWZmZXJfaGFuZGxlID0gYmFja3VwX2hhbmRsZTsKIAl9IGVsc2UgewogCQlyZXAtPmJ1
ZmZlcl9tYXBfaGFuZGxlID0gMDsKQEAgLTE2OTIsNyArMTY5MSw3IEBAIHZtd19nYl9zdXJmYWNl
X3JlZmVyZW5jZV9pbnRlcm5hbChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogCXJlcC0+Y3JlcC5i
dWZmZXJfaGFuZGxlID0gYmFja3VwX2hhbmRsZTsKIAlyZXAtPmNyZXAuYnVmZmVyX21hcF9oYW5k
bGUgPQogCQlkcm1fdm1hX25vZGVfb2Zmc2V0X2FkZHIoJnNyZi0+cmVzLmJhY2t1cC0+YmFzZS5i
YXNlLnZtYV9ub2RlKTsKLQlyZXAtPmNyZXAuYnVmZmVyX3NpemUgPSBzcmYtPnJlcy5iYWNrdXAt
PmJhc2UubnVtX3BhZ2VzICogUEFHRV9TSVpFOworCXJlcC0+Y3JlcC5idWZmZXJfc2l6ZSA9IHNy
Zi0+cmVzLmJhY2t1cC0+YmFzZS5iYXNlLnNpemU7CiAKIAlyZXAtPmNyZXEudmVyc2lvbiA9IGRy
bV92bXdfZ2Jfc3VyZmFjZV92MTsKIAlyZXAtPmNyZXEuc3ZnYTNkX2ZsYWdzX3VwcGVyXzMyX2Jp
dHMgPQpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19hcGkuaCBiL2luY2x1ZGUv
ZHJtL3R0bS90dG1fYm9fYXBpLmgKaW5kZXggNzliOTM2N2UwZmZkLi4wZDRlM2ZjY2FhOGEgMTAw
NjQ0Ci0tLSBhL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmgKKysrIGIvaW5jbHVkZS9kcm0v
dHRtL3R0bV9ib19hcGkuaApAQCAtMTI1LDcgKzEyNSw2IEBAIHN0cnVjdCB0dG1fYnVmZmVyX29i
amVjdCB7CiAJc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXY7CiAJZW51bSB0dG1fYm9fdHlwZSB0
eXBlOwogCXZvaWQgKCpkZXN0cm95KSAoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICopOwotCXVu
c2lnbmVkIGxvbmcgbnVtX3BhZ2VzOwogCXNpemVfdCBhY2Nfc2l6ZTsKIAogCS8qKgpAQCAtMzk3
LDEzICszOTYsMTEgQEAgc2l6ZV90IHR0bV9ib19kbWFfYWNjX3NpemUoc3RydWN0IHR0bV9ib19k
ZXZpY2UgKmJkZXYsCiAKIGludCB0dG1fYm9faW5pdF9yZXNlcnZlZChzdHJ1Y3QgdHRtX2JvX2Rl
dmljZSAqYmRldiwKIAkJCSBzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAotCQkJIHVuc2ln
bmVkIGxvbmcgc2l6ZSwKLQkJCSBlbnVtIHR0bV9ib190eXBlIHR5cGUsCisJCQkgc2l6ZV90IHNp
emUsIGVudW0gdHRtX2JvX3R5cGUgdHlwZSwKIAkJCSBzdHJ1Y3QgdHRtX3BsYWNlbWVudCAqcGxh
Y2VtZW50LAogCQkJIHVpbnQzMl90IHBhZ2VfYWxpZ25tZW50LAogCQkJIHN0cnVjdCB0dG1fb3Bl
cmF0aW9uX2N0eCAqY3R4LAotCQkJIHNpemVfdCBhY2Nfc2l6ZSwKLQkJCSBzdHJ1Y3Qgc2dfdGFi
bGUgKnNnLAorCQkJIHNpemVfdCBhY2Nfc2l6ZSwgc3RydWN0IHNnX3RhYmxlICpzZywKIAkJCSBz
dHJ1Y3QgZG1hX3Jlc3YgKnJlc3YsCiAJCQkgdm9pZCAoKmRlc3Ryb3kpIChzdHJ1Y3QgdHRtX2J1
ZmZlcl9vYmplY3QgKikpOwogCkBAIC00NDUsNyArNDQyLDcgQEAgaW50IHR0bV9ib19pbml0X3Jl
c2VydmVkKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAogICogLUVSRVNUQVJUU1lTOiBJbnRl
cnJ1cHRlZCBieSBzaWduYWwgd2hpbGUgc2xlZXBpbmcgd2FpdGluZyBmb3IgcmVzb3VyY2VzLgog
ICovCiBpbnQgdHRtX2JvX2luaXQoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0
dG1fYnVmZmVyX29iamVjdCAqYm8sCi0JCXVuc2lnbmVkIGxvbmcgc2l6ZSwgZW51bSB0dG1fYm9f
dHlwZSB0eXBlLAorCQlzaXplX3Qgc2l6ZSwgZW51bSB0dG1fYm9fdHlwZSB0eXBlLAogCQlzdHJ1
Y3QgdHRtX3BsYWNlbWVudCAqcGxhY2VtZW50LAogCQl1aW50MzJfdCBwYWdlX2FsaWdubWVudCwg
Ym9vbCBpbnRlcnJ1YnRpYmxlLCBzaXplX3QgYWNjX3NpemUsCiAJCXN0cnVjdCBzZ190YWJsZSAq
c2csIHN0cnVjdCBkbWFfcmVzdiAqcmVzdiwKZGlmZiAtLWdpdCBhL2luY2x1ZGUvZHJtL3R0bS90
dG1fcmVzb3VyY2UuaCBiL2luY2x1ZGUvZHJtL3R0bS90dG1fcmVzb3VyY2UuaAppbmRleCBmNDhh
NzBkMzlhYzUuLmFkNmRhOTk3NzBlOSAxMDA2NDQKLS0tIGEvaW5jbHVkZS9kcm0vdHRtL3R0bV9y
ZXNvdXJjZS5oCisrKyBiL2luY2x1ZGUvZHJtL3R0bS90dG1fcmVzb3VyY2UuaApAQCAtMTcxLDcg
KzE3MSw2IEBAIHN0cnVjdCB0dG1fYnVzX3BsYWNlbWVudCB7CiBzdHJ1Y3QgdHRtX3Jlc291cmNl
IHsKIAl2b2lkICptbV9ub2RlOwogCXVuc2lnbmVkIGxvbmcgc3RhcnQ7Ci0JdW5zaWduZWQgbG9u
ZyBzaXplOwogCXVuc2lnbmVkIGxvbmcgbnVtX3BhZ2VzOwogCXVpbnQzMl90IHBhZ2VfYWxpZ25t
ZW50OwogCXVpbnQzMl90IG1lbV90eXBlOwotLSAKMi4yNS4xCgpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1k
ZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcv
bWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWwK
