Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8907F6FE01
	for <lists+dri-devel@lfdr.de>; Mon, 22 Jul 2019 12:43:39 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 61BAB89BF6;
	Mon, 22 Jul 2019 10:43:29 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from smtp.domeneshop.no (smtp.domeneshop.no
 [IPv6:2a01:5b40:0:3005::1])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 575FC8979F
 for <dri-devel@lists.freedesktop.org>; Mon, 22 Jul 2019 10:43:26 +0000 (UTC)
Received: from 211.81-166-168.customer.lyse.net ([81.166.168.211]:55388
 helo=localhost.localdomain)
 by smtp.domeneshop.no with esmtpsa (TLS1.2:ECDHE_RSA_AES_128_CBC_SHA1:128)
 (Exim 4.84_2) (envelope-from <noralf@tronnes.org>)
 id 1hpVmu-0001lD-BZ; Mon, 22 Jul 2019 12:43:24 +0200
From: =?UTF-8?q?Noralf=20Tr=C3=B8nnes?= <noralf@tronnes.org>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v2 2/9] drm/tinydrm: Rename variable mipi -> dbi
Date: Mon, 22 Jul 2019 12:43:05 +0200
Message-Id: <20190722104312.16184-3-noralf@tronnes.org>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190722104312.16184-1-noralf@tronnes.org>
References: <20190722104312.16184-1-noralf@tronnes.org>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; d=tronnes.org; s=ds201810; 
 h=Content-Transfer-Encoding:Content-Type:MIME-Version:References:In-Reply-To:Message-Id:Date:Subject:Cc:To:From;
 bh=Fz1NOC9fgIlQfiebTJ4UWRAG1viyVc5VtNPDcIh1kCE=; 
 b=fxvcPXxTkeHdke6gYkCv3vQ1SNDmulb26ti/LSVw9TzRIY6v/EhkYPiLAHx48gK5dJ6+hAcWgc+7fShs7bzLo69jhXeEyGKiArT3gKz+R/eYmckHBzCcAG6MskpIgIuoqZJVOtoycRq5ykmHLNI2w1aMOxtZ9OFG2ezomtJzSJHB/rcfgKrlSg03z4k1B9gJk3mA6yHLMG78eMJa4XaCU8XyPnhjmvNbCI3Uu4ZMyJIwA4wuExHNhVDj8dIJ1ZA1GtmnQibzG4SR8NmbXtWo99uzMPf80Qu5weEjXeZ1O3vadO3XaM5ZbnVntFXs69t6oL7MHbjpmKv0Qw9N33oF6w==;
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: sam@ravnborg.org, david@lechnology.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

c3RydWN0IG1pcGlfZGJpIGlzIGdvaW5nIHRvIGJlIHNwbGl0IGludG8gYW4gaW50ZXJmYWNlIHBh
cnQgYW5kIGEgZGlzcGxheQpwaXBlbGluZSBwYXJ0LiBUaGUgaW50ZXJmYWNlIHBhcnQgY2FuIGJl
IHVzZWQgYnkgZHJpdmVycyB0aGF0IG5lZWQgdG8KaW5pdGlhbGl6ZSB0aGUgY29udHJvbGxlciwg
YnV0IHRoYXQgd29uJ3QgdXBsb2FkIHRoZSBmcmFtZWJ1ZmZlciBvdmVyCnRoaXMgaW50ZXJmYWNl
LgoKdGlueWRybSB1c2VzIHRoZSB2YXJpYWJsZSBuYW1lICdtaXBpJyBidXQgdGhpcyBpcyBub3Qg
YSBnb29kIG5hbWUgc2luY2UKTUlQSSByZWZlcnMgdG8gYSBsb3Qgb2Ygc3RhbmRhcmRzLiBUaGlz
IHBhdGNoIGNoYW5nZXMgdGhlIHZhcmlhYmxlIG5hbWUKdG8gJ2RiaScgd2hlcmUgaXQgcmVmZXJz
IHRvIHRoZSBpbnRlcmZhY2UgcGFydCBvZiBzdHJ1Y3QgbWlwaV9kYmkuCgpGdW5jdGlvbnMgdGhh
dCB1c2UgYm90aCBmdXR1cmUgcGFydHMgd2lsbCBoYXZlIGJvdGggdmFyaWFibGVzIHRlbXBvcmFy
aWx5CnBvaW50aW5nIHRvIHRoZSBzYW1lIHN0cnVjdHVyZS4KCkNjOiBFcmljIEFuaG9sdCA8ZXJp
Y0BhbmhvbHQubmV0PgpDYzogRGF2aWQgTGVjaG5lciA8ZGF2aWRAbGVjaG5vbG9neS5jb20+ClJl
dmlld2VkLWJ5OiBTYW0gUmF2bmJvcmcgPHNhbUByYXZuYm9yZy5vcmc+ClNpZ25lZC1vZmYtYnk6
IE5vcmFsZiBUcsO4bm5lcyA8bm9yYWxmQHRyb25uZXMub3JnPgotLS0KIGRyaXZlcnMvZ3B1L2Ry
bS90aW55ZHJtL2h4ODM1N2QuYyAgfCAgMzEgKysrLS0tCiBkcml2ZXJzL2dwdS9kcm0vdGlueWRy
bS9pbGk5MjI1LmMgIHwgMTM1ICsrKysrKysrKysrKystLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1
L2RybS90aW55ZHJtL2lsaTkzNDEuYyAgfCAgNTUgKysrKysrLS0tLS0KIGRyaXZlcnMvZ3B1L2Ry
bS90aW55ZHJtL21pMDI4M3F0LmMgfCAgNTUgKysrKysrLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS90
aW55ZHJtL21pcGktZGJpLmMgfCAxNTMgKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0KIGRy
aXZlcnMvZ3B1L2RybS90aW55ZHJtL3N0NzU4Ni5jICAgfCAgNjIgKysrKysrLS0tLS0tCiBkcml2
ZXJzL2dwdS9kcm0vdGlueWRybS9zdDc3MzVyLmMgIHwgIDQ5ICsrKystLS0tLQogaW5jbHVkZS9k
cm0vdGlueWRybS9taXBpLWRiaS5oICAgICB8ICAyMCArKy0tCiA4IGZpbGVzIGNoYW5nZWQsIDI5
MSBpbnNlcnRpb25zKCspLCAyNjkgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL3Rpbnlkcm0vaHg4MzU3ZC5jIGIvZHJpdmVycy9ncHUvZHJtL3Rpbnlkcm0vaHg4MzU3
ZC5jCmluZGV4IDdkMmRmYTkyYjY2MS4uZjUwM2QxNGFhMzZiIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vdGlueWRybS9oeDgzNTdkLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3Rpbnlkcm0v
aHg4MzU3ZC5jCkBAIC00OCw2ICs0OCw3IEBAIHN0YXRpYyB2b2lkIHl4MjQwcXYyOV9lbmFibGUo
c3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBlLAogCQkJICAgICBzdHJ1Y3QgZHJt
X3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKIHsKIAlzdHJ1Y3QgbWlwaV9kYmkgKm1pcGkgPSBk
cm1fdG9fbWlwaV9kYmkocGlwZS0+Y3J0Yy5kZXYpOworCXN0cnVjdCBtaXBpX2RiaSAqZGJpID0g
bWlwaTsKIAl1OCBhZGRyX21vZGU7CiAJaW50IHJldCwgaWR4OwogCkBAIC02MywyMiArNjQsMjIg
QEAgc3RhdGljIHZvaWQgeXgyNDBxdjI5X2VuYWJsZShzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5
X3BpcGUgKnBpcGUsCiAJCWdvdG8gb3V0X2VuYWJsZTsKIAogCS8qIHNldGV4dGMgKi8KLQltaXBp
X2RiaV9jb21tYW5kKG1pcGksIEhYODM1N0RfU0VURVhUQywgMHhGRiwgMHg4MywgMHg1Nyk7CisJ
bWlwaV9kYmlfY29tbWFuZChkYmksIEhYODM1N0RfU0VURVhUQywgMHhGRiwgMHg4MywgMHg1Nyk7
CiAJbXNsZWVwKDE1MCk7CiAKIAkvKiBzZXRSR0Igd2hpY2ggYWxzbyBlbmFibGVzIFNETyAqLwot
CW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgSFg4MzU3RF9TRVRSR0IsIDB4MDAsIDB4MDAsIDB4MDYs
IDB4MDYpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBIWDgzNTdEX1NFVFJHQiwgMHgwMCwgMHgw
MCwgMHgwNiwgMHgwNik7CiAKIAkvKiAtMS41MlYgKi8KLQltaXBpX2RiaV9jb21tYW5kKG1pcGks
IEhYODM1N0RfU0VUQ09NLCAweDI1KTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgSFg4MzU3RF9T
RVRDT00sIDB4MjUpOwogCiAJLyogTm9ybWFsIG1vZGUgNzBIeiwgSWRsZSBtb2RlIDU1IEh6ICov
Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBIWDgzNTdEX1NFVE9TQywgMHg2OCk7CisJbWlwaV9k
YmlfY29tbWFuZChkYmksIEhYODM1N0RfU0VUT1NDLCAweDY4KTsKIAogCS8qIFNldCBQYW5lbCAt
IEJHUiwgR2F0ZSBkaXJlY3Rpb24gc3dhcHBlZCAqLwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwg
SFg4MzU3RF9TRVRQQU5FTCwgMHgwNSk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIEhYODM1N0Rf
U0VUUEFORUwsIDB4MDUpOwogCi0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBIWDgzNTdEX1NFVFBP
V0VSLAorCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBIWDgzNTdEX1NFVFBPV0VSLAogCQkJIDB4MDAs
ICAvKiBOb3QgZGVlcCBzdGFuZGJ5ICovCiAJCQkgMHgxNSwgIC8qIEJUICovCiAJCQkgMHgxQywg
IC8qIFZTUFIgKi8KQEAgLTg2LDcgKzg3LDcgQEAgc3RhdGljIHZvaWQgeXgyNDBxdjI5X2VuYWJs
ZShzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCiAJCQkgMHg4MywgIC8qIEFQ
ICovCiAJCQkgMHhBQSk7ICAvKiBGUyAqLwogCi0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBIWDgz
NTdEX1NFVFNUQkEsCisJbWlwaV9kYmlfY29tbWFuZChkYmksIEhYODM1N0RfU0VUU1RCQSwKIAkJ
CSAweDUwLCAgLyogT1BPTiBub3JtYWwgKi8KIAkJCSAweDUwLCAgLyogT1BPTiBpZGxlICovCiAJ
CQkgMHgwMSwgIC8qIFNUQkEgKi8KQEAgLTk0LDcgKzk1LDcgQEAgc3RhdGljIHZvaWQgeXgyNDBx
djI5X2VuYWJsZShzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCiAJCQkgMHgx
RSwgIC8qIFNUQkEgKi8KIAkJCSAweDA4KTsgIC8qIEdFTiAqLwogCi0JbWlwaV9kYmlfY29tbWFu
ZChtaXBpLCBIWDgzNTdEX1NFVENZQywKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgSFg4MzU3RF9T
RVRDWUMsCiAJCQkgMHgwMiwgIC8qIE5XIDB4MDIgKi8KIAkJCSAweDQwLCAgLyogUlROICovCiAJ
CQkgMHgwMCwgIC8qIERJViAqLwpAQCAtMTAzLDcgKzEwNCw3IEBAIHN0YXRpYyB2b2lkIHl4MjQw
cXYyOV9lbmFibGUoc3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBlLAogCQkJIDB4
MEQsICAvKiBHRE9OICovCiAJCQkgMHg3OCk7ICAvKiBHRE9GRiAqLwogCi0JbWlwaV9kYmlfY29t
bWFuZChtaXBpLCBIWDgzNTdEX1NFVEdBTU1BLAorCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBIWDgz
NTdEX1NFVEdBTU1BLAogCQkJIDB4MDIsCiAJCQkgMHgwQSwKIAkJCSAweDExLApAQCAtMTQwLDIx
ICsxNDEsMjEgQEAgc3RhdGljIHZvaWQgeXgyNDBxdjI5X2VuYWJsZShzdHJ1Y3QgZHJtX3NpbXBs
ZV9kaXNwbGF5X3BpcGUgKnBpcGUsCiAJCQkgMHgwMSk7CiAKIAkvKiAxNiBiaXQgKi8KLQltaXBp
X2RiaV9jb21tYW5kKG1pcGksIE1JUElfRENTX1NFVF9QSVhFTF9GT1JNQVQsCisJbWlwaV9kYmlf
Y29tbWFuZChkYmksIE1JUElfRENTX1NFVF9QSVhFTF9GT1JNQVQsCiAJCQkgTUlQSV9EQ1NfUElY
RUxfRk1UXzE2QklUKTsKIAogCS8qIFRFIG9mZiAqLwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwg
TUlQSV9EQ1NfU0VUX1RFQVJfT04sIDB4MDApOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBNSVBJ
X0RDU19TRVRfVEVBUl9PTiwgMHgwMCk7CiAKIAkvKiB0ZWFyIGxpbmUgKi8KLQltaXBpX2RiaV9j
b21tYW5kKG1pcGksIE1JUElfRENTX1NFVF9URUFSX1NDQU5MSU5FLCAweDAwLCAweDAyKTsKKwlt
aXBpX2RiaV9jb21tYW5kKGRiaSwgTUlQSV9EQ1NfU0VUX1RFQVJfU0NBTkxJTkUsIDB4MDAsIDB4
MDIpOwogCiAJLyogRXhpdCBTbGVlcCAqLwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgTUlQSV9E
Q1NfRVhJVF9TTEVFUF9NT0RFKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgTUlQSV9EQ1NfRVhJ
VF9TTEVFUF9NT0RFKTsKIAltc2xlZXAoMTUwKTsKIAogCS8qIGRpc3BsYXkgb24gKi8KLQltaXBp
X2RiaV9jb21tYW5kKG1pcGksIE1JUElfRENTX1NFVF9ESVNQTEFZX09OKTsKKwltaXBpX2RiaV9j
b21tYW5kKGRiaSwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlfT04pOwogCXVzbGVlcF9yYW5nZSg1MDAw
LCA3MDAwKTsKIAogb3V0X2VuYWJsZToKQEAgLTE3Miw3ICsxNzMsNyBAQCBzdGF0aWMgdm9pZCB5
eDI0MHF2MjlfZW5hYmxlKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlwZSAqcGlwZSwKIAkJ
YWRkcl9tb2RlID0gSFg4MzU3RF9NQURDVExfTVYgfCBIWDgzNTdEX01BRENUTF9NWDsKIAkJYnJl
YWs7CiAJfQotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgTUlQSV9EQ1NfU0VUX0FERFJFU1NfTU9E
RSwgYWRkcl9tb2RlKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgTUlQSV9EQ1NfU0VUX0FERFJF
U1NfTU9ERSwgYWRkcl9tb2RlKTsKIAltaXBpX2RiaV9lbmFibGVfZmx1c2gobWlwaSwgY3J0Y19z
dGF0ZSwgcGxhbmVfc3RhdGUpOwogb3V0X2V4aXQ6CiAJZHJtX2Rldl9leGl0KGlkeCk7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdGlueWRybS9pbGk5MjI1LmMgYi9kcml2ZXJzL2dwdS9k
cm0vdGlueWRybS9pbGk5MjI1LmMKaW5kZXggNjJmMjliMmZhZjc0Li5jODM3ZDE0MjMzNjIgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS90aW55ZHJtL2lsaTkyMjUuYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vdGlueWRybS9pbGk5MjI1LmMKQEAgLTY4LDExICs2OCwxMSBAQAogI2RlZmluZSBJ
TEk5MjI1X0dBTU1BX0NPTlRST0xfOQkJMHg1OAogI2RlZmluZSBJTEk5MjI1X0dBTU1BX0NPTlRS
T0xfMTAJMHg1OQogCi1zdGF0aWMgaW5saW5lIGludCBpbGk5MjI1X2NvbW1hbmQoc3RydWN0IG1p
cGlfZGJpICptaXBpLCB1OCBjbWQsIHUxNiBkYXRhKQorc3RhdGljIGlubGluZSBpbnQgaWxpOTIy
NV9jb21tYW5kKHN0cnVjdCBtaXBpX2RiaSAqZGJpLCB1OCBjbWQsIHUxNiBkYXRhKQogewogCXU4
IHBhclsyXSA9IHsgZGF0YSA+PiA4LCBkYXRhICYgMHhmZiB9OwogCi0JcmV0dXJuIG1pcGlfZGJp
X2NvbW1hbmRfYnVmKG1pcGksIGNtZCwgcGFyLCAyKTsKKwlyZXR1cm4gbWlwaV9kYmlfY29tbWFu
ZF9idWYoZGJpLCBjbWQsIHBhciwgMik7CiB9CiAKIHN0YXRpYyB2b2lkIGlsaTkyMjVfZmJfZGly
dHkoc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIsIHN0cnVjdCBkcm1fcmVjdCAqcmVjdCkKQEAg
LTgxLDcgKzgxLDggQEAgc3RhdGljIHZvaWQgaWxpOTIyNV9mYl9kaXJ0eShzdHJ1Y3QgZHJtX2Zy
YW1lYnVmZmVyICpmYiwgc3RydWN0IGRybV9yZWN0ICpyZWN0KQogCXN0cnVjdCBtaXBpX2RiaSAq
bWlwaSA9IGRybV90b19taXBpX2RiaShmYi0+ZGV2KTsKIAl1bnNpZ25lZCBpbnQgaGVpZ2h0ID0g
cmVjdC0+eTIgLSByZWN0LT55MTsKIAl1bnNpZ25lZCBpbnQgd2lkdGggPSByZWN0LT54MiAtIHJl
Y3QtPngxOwotCWJvb2wgc3dhcCA9IG1pcGktPnN3YXBfYnl0ZXM7CisJc3RydWN0IG1pcGlfZGJp
ICpkYmkgPSBtaXBpOworCWJvb2wgc3dhcCA9IGRiaS0+c3dhcF9ieXRlczsKIAl1MTYgeF9zdGFy
dCwgeV9zdGFydDsKIAl1MTYgeDEsIHgyLCB5MSwgeTI7CiAJaW50IGlkeCwgcmV0ID0gMDsKQEAg
LTk4LDcgKzk5LDcgQEAgc3RhdGljIHZvaWQgaWxpOTIyNV9mYl9kaXJ0eShzdHJ1Y3QgZHJtX2Zy
YW1lYnVmZmVyICpmYiwgc3RydWN0IGRybV9yZWN0ICpyZWN0KQogCiAJRFJNX0RFQlVHX0tNUygi
Rmx1c2hpbmcgW0ZCOiVkXSAiIERSTV9SRUNUX0ZNVCAiXG4iLCBmYi0+YmFzZS5pZCwgRFJNX1JF
Q1RfQVJHKHJlY3QpKTsKIAotCWlmICghbWlwaS0+ZGMgfHwgIWZ1bGwgfHwgc3dhcCB8fAorCWlm
ICghZGJpLT5kYyB8fCAhZnVsbCB8fCBzd2FwIHx8CiAJICAgIGZiLT5mb3JtYXQtPmZvcm1hdCA9
PSBEUk1fRk9STUFUX1hSR0I4ODg4KSB7CiAJCXRyID0gbWlwaS0+dHhfYnVmOwogCQlyZXQgPSBt
aXBpX2RiaV9idWZfY29weShtaXBpLT50eF9idWYsIGZiLCByZWN0LCBzd2FwKTsKQEAgLTE0Mywx
NSArMTQ0LDE1IEBAIHN0YXRpYyB2b2lkIGlsaTkyMjVfZmJfZGlydHkoc3RydWN0IGRybV9mcmFt
ZWJ1ZmZlciAqZmIsIHN0cnVjdCBkcm1fcmVjdCAqcmVjdCkKIAkJYnJlYWs7CiAJfQogCi0JaWxp
OTIyNV9jb21tYW5kKG1pcGksIElMSTkyMjVfSE9SSVpfV0lORE9XX0FERFJfMSwgeDIpOwotCWls
aTkyMjVfY29tbWFuZChtaXBpLCBJTEk5MjI1X0hPUklaX1dJTkRPV19BRERSXzIsIHgxKTsKLQlp
bGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9WRVJUX1dJTkRPV19BRERSXzEsIHkyKTsKLQlp
bGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9WRVJUX1dJTkRPV19BRERSXzIsIHkxKTsKKwlp
bGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X0hPUklaX1dJTkRPV19BRERSXzEsIHgyKTsKKwlp
bGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X0hPUklaX1dJTkRPV19BRERSXzIsIHgxKTsKKwlp
bGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X1ZFUlRfV0lORE9XX0FERFJfMSwgeTIpOworCWls
aTkyMjVfY29tbWFuZChkYmksIElMSTkyMjVfVkVSVF9XSU5ET1dfQUREUl8yLCB5MSk7CiAKLQlp
bGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9SQU1fQUREUkVTU19TRVRfMSwgeF9zdGFydCk7
Ci0JaWxpOTIyNV9jb21tYW5kKG1pcGksIElMSTkyMjVfUkFNX0FERFJFU1NfU0VUXzIsIHlfc3Rh
cnQpOworCWlsaTkyMjVfY29tbWFuZChkYmksIElMSTkyMjVfUkFNX0FERFJFU1NfU0VUXzEsIHhf
c3RhcnQpOworCWlsaTkyMjVfY29tbWFuZChkYmksIElMSTkyMjVfUkFNX0FERFJFU1NfU0VUXzIs
IHlfc3RhcnQpOwogCi0JcmV0ID0gbWlwaV9kYmlfY29tbWFuZF9idWYobWlwaSwgSUxJOTIyNV9X
UklURV9EQVRBX1RPX0dSQU0sIHRyLAorCXJldCA9IG1pcGlfZGJpX2NvbW1hbmRfYnVmKGRiaSwg
SUxJOTIyNV9XUklURV9EQVRBX1RPX0dSQU0sIHRyLAogCQkJCSAgIHdpZHRoICogaGVpZ2h0ICog
Mik7CiBlcnJfbXNnOgogCWlmIChyZXQpCkBAIC0xODUsNiArMTg2LDcgQEAgc3RhdGljIHZvaWQg
aWxpOTIyNV9waXBlX2VuYWJsZShzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUs
CiAJc3RydWN0IG1pcGlfZGJpICptaXBpID0gZHJtX3RvX21pcGlfZGJpKHBpcGUtPmNydGMuZGV2
KTsKIAlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHBsYW5lX3N0YXRlLT5mYjsKIAlzdHJ1
Y3QgZGV2aWNlICpkZXYgPSBwaXBlLT5jcnRjLmRldi0+ZGV2OworCXN0cnVjdCBtaXBpX2RiaSAq
ZGJpID0gbWlwaTsKIAlzdHJ1Y3QgZHJtX3JlY3QgcmVjdCA9IHsKIAkJLngxID0gMCwKIAkJLngy
ID0gZmItPndpZHRoLApAQCAtMTk5LDcgKzIwMSw3IEBAIHN0YXRpYyB2b2lkIGlsaTkyMjVfcGlw
ZV9lbmFibGUoc3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBlLAogCiAJRFJNX0RF
QlVHX0tNUygiXG4iKTsKIAotCW1pcGlfZGJpX2h3X3Jlc2V0KG1pcGkpOworCW1pcGlfZGJpX2h3
X3Jlc2V0KGRiaSk7CiAKIAkvKgogCSAqIFRoZXJlIGRvbid0IHNlZW0gdG8gYmUgdHdvIGV4YW1w
bGUgaW5pdCBzZXF1ZW5jZXMgdGhhdCBtYXRjaCwgc28KQEAgLTIwNywyNyArMjA5LDI3IEBAIHN0
YXRpYyB2b2lkIGlsaTkyMjVfcGlwZV9lbmFibGUoc3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9w
aXBlICpwaXBlLAogCSAqIGh0dHBzOi8vZ2l0aHViLmNvbS9Oa2F3dS9URlRfMjJfSUxJOTIyNS9i
bG9iL21hc3Rlci9zcmMvVEZUXzIyX0lMSTkyMjUuY3BwCiAJICovCiAKLQlyZXQgPSBpbGk5MjI1
X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9QT1dFUl9DT05UUk9MXzEsIDB4MDAwMCk7CisJcmV0ID0g
aWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9QT1dFUl9DT05UUk9MXzEsIDB4MDAwMCk7CiAJ
aWYgKHJldCkgewogCQlEUk1fREVWX0VSUk9SKGRldiwgIkVycm9yIHNlbmRpbmcgY29tbWFuZCAl
ZFxuIiwgcmV0KTsKIAkJZ290byBvdXRfZXhpdDsKIAl9Ci0JaWxpOTIyNV9jb21tYW5kKG1pcGks
IElMSTkyMjVfUE9XRVJfQ09OVFJPTF8yLCAweDAwMDApOwotCWlsaTkyMjVfY29tbWFuZChtaXBp
LCBJTEk5MjI1X1BPV0VSX0NPTlRST0xfMywgMHgwMDAwKTsKLQlpbGk5MjI1X2NvbW1hbmQobWlw
aSwgSUxJOTIyNV9QT1dFUl9DT05UUk9MXzQsIDB4MDAwMCk7Ci0JaWxpOTIyNV9jb21tYW5kKG1p
cGksIElMSTkyMjVfUE9XRVJfQ09OVFJPTF81LCAweDAwMDApOworCWlsaTkyMjVfY29tbWFuZChk
YmksIElMSTkyMjVfUE9XRVJfQ09OVFJPTF8yLCAweDAwMDApOworCWlsaTkyMjVfY29tbWFuZChk
YmksIElMSTkyMjVfUE9XRVJfQ09OVFJPTF8zLCAweDAwMDApOworCWlsaTkyMjVfY29tbWFuZChk
YmksIElMSTkyMjVfUE9XRVJfQ09OVFJPTF80LCAweDAwMDApOworCWlsaTkyMjVfY29tbWFuZChk
YmksIElMSTkyMjVfUE9XRVJfQ09OVFJPTF81LCAweDAwMDApOwogCiAJbXNsZWVwKDQwKTsKIAot
CWlsaTkyMjVfY29tbWFuZChtaXBpLCBJTEk5MjI1X1BPV0VSX0NPTlRST0xfMiwgMHgwMDE4KTsK
LQlpbGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9QT1dFUl9DT05UUk9MXzMsIDB4NjEyMSk7
Ci0JaWxpOTIyNV9jb21tYW5kKG1pcGksIElMSTkyMjVfUE9XRVJfQ09OVFJPTF80LCAweDAwNmYp
OwotCWlsaTkyMjVfY29tbWFuZChtaXBpLCBJTEk5MjI1X1BPV0VSX0NPTlRST0xfNSwgMHg0OTVm
KTsKLQlpbGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9QT1dFUl9DT05UUk9MXzEsIDB4MDgw
MCk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9QT1dFUl9DT05UUk9MXzIsIDB4MDAx
OCk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9QT1dFUl9DT05UUk9MXzMsIDB4NjEy
MSk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9QT1dFUl9DT05UUk9MXzQsIDB4MDA2
Zik7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9QT1dFUl9DT05UUk9MXzUsIDB4NDk1
Zik7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9QT1dFUl9DT05UUk9MXzEsIDB4MDgw
MCk7CiAKIAltc2xlZXAoMTApOwogCi0JaWxpOTIyNV9jb21tYW5kKG1pcGksIElMSTkyMjVfUE9X
RVJfQ09OVFJPTF8yLCAweDEwM2IpOworCWlsaTkyMjVfY29tbWFuZChkYmksIElMSTkyMjVfUE9X
RVJfQ09OVFJPTF8yLCAweDEwM2IpOwogCiAJbXNsZWVwKDUwKTsKIApAQCAtMjQ1LDQxICsyNDcs
NDEgQEAgc3RhdGljIHZvaWQgaWxpOTIyNV9waXBlX2VuYWJsZShzdHJ1Y3QgZHJtX3NpbXBsZV9k
aXNwbGF5X3BpcGUgKnBpcGUsCiAJCWFtX2lkID0gMHgyODsKIAkJYnJlYWs7CiAJfQotCWlsaTky
MjVfY29tbWFuZChtaXBpLCBJTEk5MjI1X0RSSVZFUl9PVVRQVVRfQ09OVFJPTCwgMHgwMTFjKTsK
LQlpbGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9MQ0RfQUNfRFJJVklOR19DT05UUk9MLCAw
eDAxMDApOwotCWlsaTkyMjVfY29tbWFuZChtaXBpLCBJTEk5MjI1X0VOVFJZX01PREUsIDB4MTAw
MCB8IGFtX2lkKTsKLQlpbGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9ESVNQTEFZX0NPTlRS
T0xfMSwgMHgwMDAwKTsKLQlpbGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9CTEFOS19QRVJJ
T0RfQ09OVFJPTF8xLCAweDA4MDgpOwotCWlsaTkyMjVfY29tbWFuZChtaXBpLCBJTEk5MjI1X0ZS
QU1FX0NZQ0xFX0NPTlRST0wsIDB4MTEwMCk7Ci0JaWxpOTIyNV9jb21tYW5kKG1pcGksIElMSTky
MjVfSU5URVJGQUNFX0NPTlRST0wsIDB4MDAwMCk7Ci0JaWxpOTIyNV9jb21tYW5kKG1pcGksIElM
STkyMjVfT1NDSUxMQVRJT05fQ09OVFJPTCwgMHgwZDAxKTsKLQlpbGk5MjI1X2NvbW1hbmQobWlw
aSwgSUxJOTIyNV9WQ0lfUkVDWUNMSU5HLCAweDAwMjApOwotCWlsaTkyMjVfY29tbWFuZChtaXBp
LCBJTEk5MjI1X1JBTV9BRERSRVNTX1NFVF8xLCAweDAwMDApOwotCWlsaTkyMjVfY29tbWFuZCht
aXBpLCBJTEk5MjI1X1JBTV9BRERSRVNTX1NFVF8yLCAweDAwMDApOworCWlsaTkyMjVfY29tbWFu
ZChkYmksIElMSTkyMjVfRFJJVkVSX09VVFBVVF9DT05UUk9MLCAweDAxMWMpOworCWlsaTkyMjVf
Y29tbWFuZChkYmksIElMSTkyMjVfTENEX0FDX0RSSVZJTkdfQ09OVFJPTCwgMHgwMTAwKTsKKwlp
bGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X0VOVFJZX01PREUsIDB4MTAwMCB8IGFtX2lkKTsK
KwlpbGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X0RJU1BMQVlfQ09OVFJPTF8xLCAweDAwMDAp
OworCWlsaTkyMjVfY29tbWFuZChkYmksIElMSTkyMjVfQkxBTktfUEVSSU9EX0NPTlRST0xfMSwg
MHgwODA4KTsKKwlpbGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X0ZSQU1FX0NZQ0xFX0NPTlRS
T0wsIDB4MTEwMCk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9JTlRFUkZBQ0VfQ09O
VFJPTCwgMHgwMDAwKTsKKwlpbGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X09TQ0lMTEFUSU9O
X0NPTlRST0wsIDB4MGQwMSk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9WQ0lfUkVD
WUNMSU5HLCAweDAwMjApOworCWlsaTkyMjVfY29tbWFuZChkYmksIElMSTkyMjVfUkFNX0FERFJF
U1NfU0VUXzEsIDB4MDAwMCk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9SQU1fQURE
UkVTU19TRVRfMiwgMHgwMDAwKTsKIAotCWlsaTkyMjVfY29tbWFuZChtaXBpLCBJTEk5MjI1X0dB
VEVfU0NBTl9DT05UUk9MLCAweDAwMDApOwotCWlsaTkyMjVfY29tbWFuZChtaXBpLCBJTEk5MjI1
X1ZFUlRJQ0FMX1NDUk9MTF8xLCAweDAwZGIpOwotCWlsaTkyMjVfY29tbWFuZChtaXBpLCBJTEk5
MjI1X1ZFUlRJQ0FMX1NDUk9MTF8yLCAweDAwMDApOwotCWlsaTkyMjVfY29tbWFuZChtaXBpLCBJ
TEk5MjI1X1ZFUlRJQ0FMX1NDUk9MTF8zLCAweDAwMDApOwotCWlsaTkyMjVfY29tbWFuZChtaXBp
LCBJTEk5MjI1X1BBUlRJQUxfRFJJVklOR19QT1NfMSwgMHgwMGRiKTsKLQlpbGk5MjI1X2NvbW1h
bmQobWlwaSwgSUxJOTIyNV9QQVJUSUFMX0RSSVZJTkdfUE9TXzIsIDB4MDAwMCk7CisJaWxpOTIy
NV9jb21tYW5kKGRiaSwgSUxJOTIyNV9HQVRFX1NDQU5fQ09OVFJPTCwgMHgwMDAwKTsKKwlpbGk5
MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X1ZFUlRJQ0FMX1NDUk9MTF8xLCAweDAwZGIpOworCWls
aTkyMjVfY29tbWFuZChkYmksIElMSTkyMjVfVkVSVElDQUxfU0NST0xMXzIsIDB4MDAwMCk7CisJ
aWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9WRVJUSUNBTF9TQ1JPTExfMywgMHgwMDAwKTsK
KwlpbGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X1BBUlRJQUxfRFJJVklOR19QT1NfMSwgMHgw
MGRiKTsKKwlpbGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X1BBUlRJQUxfRFJJVklOR19QT1Nf
MiwgMHgwMDAwKTsKIAotCWlsaTkyMjVfY29tbWFuZChtaXBpLCBJTEk5MjI1X0dBTU1BX0NPTlRS
T0xfMSwgMHgwMDAwKTsKLQlpbGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9HQU1NQV9DT05U
Uk9MXzIsIDB4MDgwOCk7Ci0JaWxpOTIyNV9jb21tYW5kKG1pcGksIElMSTkyMjVfR0FNTUFfQ09O
VFJPTF8zLCAweDA4MGEpOwotCWlsaTkyMjVfY29tbWFuZChtaXBpLCBJTEk5MjI1X0dBTU1BX0NP
TlRST0xfNCwgMHgwMDBhKTsKLQlpbGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9HQU1NQV9D
T05UUk9MXzUsIDB4MGEwOCk7Ci0JaWxpOTIyNV9jb21tYW5kKG1pcGksIElMSTkyMjVfR0FNTUFf
Q09OVFJPTF82LCAweDA4MDgpOwotCWlsaTkyMjVfY29tbWFuZChtaXBpLCBJTEk5MjI1X0dBTU1B
X0NPTlRST0xfNywgMHgwMDAwKTsKLQlpbGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9HQU1N
QV9DT05UUk9MXzgsIDB4MGEwMCk7Ci0JaWxpOTIyNV9jb21tYW5kKG1pcGksIElMSTkyMjVfR0FN
TUFfQ09OVFJPTF85LCAweDA3MTApOwotCWlsaTkyMjVfY29tbWFuZChtaXBpLCBJTEk5MjI1X0dB
TU1BX0NPTlRST0xfMTAsIDB4MDcxMCk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9H
QU1NQV9DT05UUk9MXzEsIDB4MDAwMCk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9H
QU1NQV9DT05UUk9MXzIsIDB4MDgwOCk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9H
QU1NQV9DT05UUk9MXzMsIDB4MDgwYSk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9H
QU1NQV9DT05UUk9MXzQsIDB4MDAwYSk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9H
QU1NQV9DT05UUk9MXzUsIDB4MGEwOCk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9H
QU1NQV9DT05UUk9MXzYsIDB4MDgwOCk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9H
QU1NQV9DT05UUk9MXzcsIDB4MDAwMCk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9H
QU1NQV9DT05UUk9MXzgsIDB4MGEwMCk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9H
QU1NQV9DT05UUk9MXzksIDB4MDcxMCk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9H
QU1NQV9DT05UUk9MXzEwLCAweDA3MTApOwogCi0JaWxpOTIyNV9jb21tYW5kKG1pcGksIElMSTky
MjVfRElTUExBWV9DT05UUk9MXzEsIDB4MDAxMik7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJ
OTIyNV9ESVNQTEFZX0NPTlRST0xfMSwgMHgwMDEyKTsKIAogCW1zbGVlcCg1MCk7CiAKLQlpbGk5
MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9ESVNQTEFZX0NPTlRST0xfMSwgMHgxMDE3KTsKKwlp
bGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X0RJU1BMQVlfQ09OVFJPTF8xLCAweDEwMTcpOwog
CiAJbWlwaS0+ZW5hYmxlZCA9IHRydWU7CiAJaWxpOTIyNV9mYl9kaXJ0eShmYiwgJnJlY3QpOwpA
QCAtMjkwLDYgKzI5Miw3IEBAIHN0YXRpYyB2b2lkIGlsaTkyMjVfcGlwZV9lbmFibGUoc3RydWN0
IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBlLAogc3RhdGljIHZvaWQgaWxpOTIyNV9waXBl
X2Rpc2FibGUoc3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBlKQogewogCXN0cnVj
dCBtaXBpX2RiaSAqbWlwaSA9IGRybV90b19taXBpX2RiaShwaXBlLT5jcnRjLmRldik7CisJc3Ry
dWN0IG1pcGlfZGJpICpkYmkgPSBtaXBpOwogCiAJRFJNX0RFQlVHX0tNUygiXG4iKTsKIApAQCAt
MzAzLDMzICszMDYsMzMgQEAgc3RhdGljIHZvaWQgaWxpOTIyNV9waXBlX2Rpc2FibGUoc3RydWN0
IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBlKQogCWlmICghbWlwaS0+ZW5hYmxlZCkKIAkJ
cmV0dXJuOwogCi0JaWxpOTIyNV9jb21tYW5kKG1pcGksIElMSTkyMjVfRElTUExBWV9DT05UUk9M
XzEsIDB4MDAwMCk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9ESVNQTEFZX0NPTlRS
T0xfMSwgMHgwMDAwKTsKIAltc2xlZXAoNTApOwotCWlsaTkyMjVfY29tbWFuZChtaXBpLCBJTEk5
MjI1X1BPV0VSX0NPTlRST0xfMiwgMHgwMDA3KTsKKwlpbGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5
MjI1X1BPV0VSX0NPTlRST0xfMiwgMHgwMDA3KTsKIAltc2xlZXAoNTApOwotCWlsaTkyMjVfY29t
bWFuZChtaXBpLCBJTEk5MjI1X1BPV0VSX0NPTlRST0xfMSwgMHgwYTAyKTsKKwlpbGk5MjI1X2Nv
bW1hbmQoZGJpLCBJTEk5MjI1X1BPV0VSX0NPTlRST0xfMSwgMHgwYTAyKTsKIAogCW1pcGktPmVu
YWJsZWQgPSBmYWxzZTsKIH0KIAotc3RhdGljIGludCBpbGk5MjI1X2RiaV9jb21tYW5kKHN0cnVj
dCBtaXBpX2RiaSAqbWlwaSwgdTggKmNtZCwgdTggKnBhciwKK3N0YXRpYyBpbnQgaWxpOTIyNV9k
YmlfY29tbWFuZChzdHJ1Y3QgbWlwaV9kYmkgKmRiaSwgdTggKmNtZCwgdTggKnBhciwKIAkJCSAg
ICAgICBzaXplX3QgbnVtKQogewotCXN0cnVjdCBzcGlfZGV2aWNlICpzcGkgPSBtaXBpLT5zcGk7
CisJc3RydWN0IHNwaV9kZXZpY2UgKnNwaSA9IGRiaS0+c3BpOwogCXVuc2lnbmVkIGludCBicHcg
PSA4OwogCXUzMiBzcGVlZF9oejsKIAlpbnQgcmV0OwogCi0JZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNs
ZWVwKG1pcGktPmRjLCAwKTsKKwlncGlvZF9zZXRfdmFsdWVfY2Fuc2xlZXAoZGJpLT5kYywgMCk7
CiAJc3BlZWRfaHogPSBtaXBpX2RiaV9zcGlfY21kX21heF9zcGVlZChzcGksIDEpOwogCXJldCA9
IG1pcGlfZGJpX3NwaV90cmFuc2ZlcihzcGksIHNwZWVkX2h6LCA4LCBjbWQsIDEpOwogCWlmIChy
ZXQgfHwgIW51bSkKIAkJcmV0dXJuIHJldDsKIAotCWlmICgqY21kID09IElMSTkyMjVfV1JJVEVf
REFUQV9UT19HUkFNICYmICFtaXBpLT5zd2FwX2J5dGVzKQorCWlmICgqY21kID09IElMSTkyMjVf
V1JJVEVfREFUQV9UT19HUkFNICYmICFkYmktPnN3YXBfYnl0ZXMpCiAJCWJwdyA9IDE2OwogCi0J
Z3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKG1pcGktPmRjLCAxKTsKKwlncGlvZF9zZXRfdmFsdWVf
Y2Fuc2xlZXAoZGJpLT5kYywgMSk7CiAJc3BlZWRfaHogPSBtaXBpX2RiaV9zcGlfY21kX21heF9z
cGVlZChzcGksIG51bSk7CiAKIAlyZXR1cm4gbWlwaV9kYmlfc3BpX3RyYW5zZmVyKHNwaSwgc3Bl
ZWRfaHosIGJwdywgcGFyLCBudW0pOwpAQCAtMzc3LDYgKzM4MCw3IEBAIHN0YXRpYyBpbnQgaWxp
OTIyNV9wcm9iZShzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpKQogCXN0cnVjdCBkZXZpY2UgKmRldiA9
ICZzcGktPmRldjsKIAlzdHJ1Y3QgZHJtX2RldmljZSAqZHJtOwogCXN0cnVjdCBtaXBpX2RiaSAq
bWlwaTsKKwlzdHJ1Y3QgbWlwaV9kYmkgKmRiaTsKIAlzdHJ1Y3QgZ3Bpb19kZXNjICpyczsKIAl1
MzIgcm90YXRpb24gPSAwOwogCWludCByZXQ7CkBAIC0zODUsNiArMzg5LDcgQEAgc3RhdGljIGlu
dCBpbGk5MjI1X3Byb2JlKHN0cnVjdCBzcGlfZGV2aWNlICpzcGkpCiAJaWYgKCFtaXBpKQogCQly
ZXR1cm4gLUVOT01FTTsKIAorCWRiaSA9IG1pcGk7CiAJZHJtID0gJm1pcGktPmRybTsKIAlyZXQg
PSBkZXZtX2RybV9kZXZfaW5pdChkZXYsIGRybSwgJmlsaTkyMjVfZHJpdmVyKTsKIAlpZiAocmV0
KSB7CkBAIC0zOTQsMTAgKzM5OSwxMCBAQCBzdGF0aWMgaW50IGlsaTkyMjVfcHJvYmUoc3RydWN0
IHNwaV9kZXZpY2UgKnNwaSkKIAogCWRybV9tb2RlX2NvbmZpZ19pbml0KGRybSk7CiAKLQltaXBp
LT5yZXNldCA9IGRldm1fZ3Bpb2RfZ2V0KGRldiwgInJlc2V0IiwgR1BJT0RfT1VUX0hJR0gpOwot
CWlmIChJU19FUlIobWlwaS0+cmVzZXQpKSB7CisJZGJpLT5yZXNldCA9IGRldm1fZ3Bpb2RfZ2V0
KGRldiwgInJlc2V0IiwgR1BJT0RfT1VUX0hJR0gpOworCWlmIChJU19FUlIoZGJpLT5yZXNldCkp
IHsKIAkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8gZ2V0IGdwaW8gJ3Jlc2V0J1xuIik7
Ci0JCXJldHVybiBQVFJfRVJSKG1pcGktPnJlc2V0KTsKKwkJcmV0dXJuIFBUUl9FUlIoZGJpLT5y
ZXNldCk7CiAJfQogCiAJcnMgPSBkZXZtX2dwaW9kX2dldChkZXYsICJycyIsIEdQSU9EX09VVF9M
T1cpOwpAQCAtNDA4LDEyICs0MTMsMTIgQEAgc3RhdGljIGludCBpbGk5MjI1X3Byb2JlKHN0cnVj
dCBzcGlfZGV2aWNlICpzcGkpCiAKIAlkZXZpY2VfcHJvcGVydHlfcmVhZF91MzIoZGV2LCAicm90
YXRpb24iLCAmcm90YXRpb24pOwogCi0JcmV0ID0gbWlwaV9kYmlfc3BpX2luaXQoc3BpLCBtaXBp
LCBycyk7CisJcmV0ID0gbWlwaV9kYmlfc3BpX2luaXQoc3BpLCBkYmksIHJzKTsKIAlpZiAocmV0
KQogCQlyZXR1cm4gcmV0OwogCiAJLyogb3ZlcnJpZGUgdGhlIGNvbW1hbmQgZnVuY3Rpb24gc2V0
IGluICBtaXBpX2RiaV9zcGlfaW5pdCgpICovCi0JbWlwaS0+Y29tbWFuZCA9IGlsaTkyMjVfZGJp
X2NvbW1hbmQ7CisJZGJpLT5jb21tYW5kID0gaWxpOTIyNV9kYmlfY29tbWFuZDsKIAogCXJldCA9
IG1pcGlfZGJpX2luaXQobWlwaSwgJmlsaTkyMjVfcGlwZV9mdW5jcywgJmlsaTkyMjVfbW9kZSwg
cm90YXRpb24pOwogCWlmIChyZXQpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdGlueWRy
bS9pbGk5MzQxLmMgYi9kcml2ZXJzL2dwdS9kcm0vdGlueWRybS9pbGk5MzQxLmMKaW5kZXggY2Iw
YTBkZGJjMDkwLi4wNWJhNWFiMTdlYzYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS90aW55
ZHJtL2lsaTkzNDEuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdGlueWRybS9pbGk5MzQxLmMKQEAg
LTU0LDYgKzU0LDcgQEAgc3RhdGljIHZvaWQgeXgyNDBxdjI5X2VuYWJsZShzdHJ1Y3QgZHJtX3Np
bXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCiAJCQkgICAgIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUg
KnBsYW5lX3N0YXRlKQogewogCXN0cnVjdCBtaXBpX2RiaSAqbWlwaSA9IGRybV90b19taXBpX2Ri
aShwaXBlLT5jcnRjLmRldik7CisJc3RydWN0IG1pcGlfZGJpICpkYmkgPSBtaXBpOwogCXU4IGFk
ZHJfbW9kZTsKIAlpbnQgcmV0LCBpZHg7CiAKQEAgLTY4LDQ3ICs2OSw0NyBAQCBzdGF0aWMgdm9p
ZCB5eDI0MHF2MjlfZW5hYmxlKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlwZSAqcGlwZSwK
IAlpZiAocmV0ID09IDEpCiAJCWdvdG8gb3V0X2VuYWJsZTsKIAotCW1pcGlfZGJpX2NvbW1hbmQo
bWlwaSwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlfT0ZGKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwg
TUlQSV9EQ1NfU0VUX0RJU1BMQVlfT0ZGKTsKIAotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgSUxJ
OTM0MV9QV0NUUkxCLCAweDAwLCAweGMxLCAweDMwKTsKLQltaXBpX2RiaV9jb21tYW5kKG1pcGks
IElMSTkzNDFfUFdSU0VRLCAweDY0LCAweDAzLCAweDEyLCAweDgxKTsKLQltaXBpX2RiaV9jb21t
YW5kKG1pcGksIElMSTkzNDFfRFRDVFJMQSwgMHg4NSwgMHgwMCwgMHg3OCk7Ci0JbWlwaV9kYmlf
Y29tbWFuZChtaXBpLCBJTEk5MzQxX1BXQ1RSTEEsIDB4MzksIDB4MmMsIDB4MDAsIDB4MzQsIDB4
MDIpOwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgSUxJOTM0MV9QVU1QQ1RSTCwgMHgyMCk7Ci0J
bWlwaV9kYmlfY29tbWFuZChtaXBpLCBJTEk5MzQxX0RUQ1RSTEIsIDB4MDAsIDB4MDApOworCW1p
cGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5MzQxX1BXQ1RSTEIsIDB4MDAsIDB4YzEsIDB4MzApOwor
CW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5MzQxX1BXUlNFUSwgMHg2NCwgMHgwMywgMHgxMiwg
MHg4MSk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIElMSTkzNDFfRFRDVFJMQSwgMHg4NSwgMHgw
MCwgMHg3OCk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIElMSTkzNDFfUFdDVFJMQSwgMHgzOSwg
MHgyYywgMHgwMCwgMHgzNCwgMHgwMik7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIElMSTkzNDFf
UFVNUENUUkwsIDB4MjApOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5MzQxX0RUQ1RSTEIs
IDB4MDAsIDB4MDApOwogCiAJLyogUG93ZXIgQ29udHJvbCAqLwotCW1pcGlfZGJpX2NvbW1hbmQo
bWlwaSwgSUxJOTM0MV9QV0NUUkwxLCAweDIzKTsKLQltaXBpX2RiaV9jb21tYW5kKG1pcGksIElM
STkzNDFfUFdDVFJMMiwgMHgxMCk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIElMSTkzNDFfUFdD
VFJMMSwgMHgyMyk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIElMSTkzNDFfUFdDVFJMMiwgMHgx
MCk7CiAJLyogVkNPTSAqLwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgSUxJOTM0MV9WTUNUUkwx
LCAweDNlLCAweDI4KTsKLQltaXBpX2RiaV9jb21tYW5kKG1pcGksIElMSTkzNDFfVk1DVFJMMiwg
MHg4Nik7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIElMSTkzNDFfVk1DVFJMMSwgMHgzZSwgMHgy
OCk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIElMSTkzNDFfVk1DVFJMMiwgMHg4Nik7CiAKIAkv
KiBNZW1vcnkgQWNjZXNzIENvbnRyb2wgKi8KLQltaXBpX2RiaV9jb21tYW5kKG1pcGksIE1JUElf
RENTX1NFVF9QSVhFTF9GT1JNQVQsIE1JUElfRENTX1BJWEVMX0ZNVF8xNkJJVCk7CisJbWlwaV9k
YmlfY29tbWFuZChkYmksIE1JUElfRENTX1NFVF9QSVhFTF9GT1JNQVQsIE1JUElfRENTX1BJWEVM
X0ZNVF8xNkJJVCk7CiAKIAkvKiBGcmFtZSBSYXRlICovCi0JbWlwaV9kYmlfY29tbWFuZChtaXBp
LCBJTEk5MzQxX0ZSTUNUUjEsIDB4MDAsIDB4MWIpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJ
TEk5MzQxX0ZSTUNUUjEsIDB4MDAsIDB4MWIpOwogCiAJLyogR2FtbWEgKi8KLQltaXBpX2RiaV9j
b21tYW5kKG1pcGksIElMSTkzNDFfRU4zR0FNLCAweDAwKTsKLQltaXBpX2RiaV9jb21tYW5kKG1p
cGksIE1JUElfRENTX1NFVF9HQU1NQV9DVVJWRSwgMHgwMSk7Ci0JbWlwaV9kYmlfY29tbWFuZCht
aXBpLCBJTEk5MzQxX1BHQU1DVFJMLAorCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5MzQxX0VO
M0dBTSwgMHgwMCk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIE1JUElfRENTX1NFVF9HQU1NQV9D
VVJWRSwgMHgwMSk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIElMSTkzNDFfUEdBTUNUUkwsCiAJ
CQkgMHgwZiwgMHgzMSwgMHgyYiwgMHgwYywgMHgwZSwgMHgwOCwgMHg0ZSwgMHhmMSwKIAkJCSAw
eDM3LCAweDA3LCAweDEwLCAweDAzLCAweDBlLCAweDA5LCAweDAwKTsKLQltaXBpX2RiaV9jb21t
YW5kKG1pcGksIElMSTkzNDFfTkdBTUNUUkwsCisJbWlwaV9kYmlfY29tbWFuZChkYmksIElMSTkz
NDFfTkdBTUNUUkwsCiAJCQkgMHgwMCwgMHgwZSwgMHgxNCwgMHgwMywgMHgxMSwgMHgwNywgMHgz
MSwgMHhjMSwKIAkJCSAweDQ4LCAweDA4LCAweDBmLCAweDBjLCAweDMxLCAweDM2LCAweDBmKTsK
IAogCS8qIEREUkFNICovCi0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBJTEk5MzQxX0VUTU9ELCAw
eDA3KTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgSUxJOTM0MV9FVE1PRCwgMHgwNyk7CiAKIAkv
KiBEaXNwbGF5ICovCi0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBJTEk5MzQxX0RJU0NUUkwsIDB4
MDgsIDB4ODIsIDB4MjcsIDB4MDApOwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgTUlQSV9EQ1Nf
RVhJVF9TTEVFUF9NT0RFKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgSUxJOTM0MV9ESVNDVFJM
LCAweDA4LCAweDgyLCAweDI3LCAweDAwKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgTUlQSV9E
Q1NfRVhJVF9TTEVFUF9NT0RFKTsKIAltc2xlZXAoMTAwKTsKIAotCW1pcGlfZGJpX2NvbW1hbmQo
bWlwaSwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlfT04pOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBN
SVBJX0RDU19TRVRfRElTUExBWV9PTik7CiAJbXNsZWVwKDEwMCk7CiAKIG91dF9lbmFibGU6CkBA
IC0xMjgsNyArMTI5LDcgQEAgc3RhdGljIHZvaWQgeXgyNDBxdjI5X2VuYWJsZShzdHJ1Y3QgZHJt
X3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCiAJCWJyZWFrOwogCX0KIAlhZGRyX21vZGUgfD0g
SUxJOTM0MV9NQURDVExfQkdSOwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgTUlQSV9EQ1NfU0VU
X0FERFJFU1NfTU9ERSwgYWRkcl9tb2RlKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgTUlQSV9E
Q1NfU0VUX0FERFJFU1NfTU9ERSwgYWRkcl9tb2RlKTsKIAltaXBpX2RiaV9lbmFibGVfZmx1c2go
bWlwaSwgY3J0Y19zdGF0ZSwgcGxhbmVfc3RhdGUpOwogb3V0X2V4aXQ6CiAJZHJtX2Rldl9leGl0
KGlkeCk7CkBAIC0xNzcsNiArMTc4LDcgQEAgc3RhdGljIGludCBpbGk5MzQxX3Byb2JlKHN0cnVj
dCBzcGlfZGV2aWNlICpzcGkpCiAJc3RydWN0IGRldmljZSAqZGV2ID0gJnNwaS0+ZGV2OwogCXN0
cnVjdCBkcm1fZGV2aWNlICpkcm07CiAJc3RydWN0IG1pcGlfZGJpICptaXBpOworCXN0cnVjdCBt
aXBpX2RiaSAqZGJpOwogCXN0cnVjdCBncGlvX2Rlc2MgKmRjOwogCXUzMiByb3RhdGlvbiA9IDA7
CiAJaW50IHJldDsKQEAgLTE4NSw2ICsxODcsNyBAQCBzdGF0aWMgaW50IGlsaTkzNDFfcHJvYmUo
c3RydWN0IHNwaV9kZXZpY2UgKnNwaSkKIAlpZiAoIW1pcGkpCiAJCXJldHVybiAtRU5PTUVNOwog
CisJZGJpID0gbWlwaTsKIAlkcm0gPSAmbWlwaS0+ZHJtOwogCXJldCA9IGRldm1fZHJtX2Rldl9p
bml0KGRldiwgZHJtLCAmaWxpOTM0MV9kcml2ZXIpOwogCWlmIChyZXQpIHsKQEAgLTE5NCwxMCAr
MTk3LDEwIEBAIHN0YXRpYyBpbnQgaWxpOTM0MV9wcm9iZShzdHJ1Y3Qgc3BpX2RldmljZSAqc3Bp
KQogCiAJZHJtX21vZGVfY29uZmlnX2luaXQoZHJtKTsKIAotCW1pcGktPnJlc2V0ID0gZGV2bV9n
cGlvZF9nZXRfb3B0aW9uYWwoZGV2LCAicmVzZXQiLCBHUElPRF9PVVRfSElHSCk7Ci0JaWYgKElT
X0VSUihtaXBpLT5yZXNldCkpIHsKKwlkYmktPnJlc2V0ID0gZGV2bV9ncGlvZF9nZXRfb3B0aW9u
YWwoZGV2LCAicmVzZXQiLCBHUElPRF9PVVRfSElHSCk7CisJaWYgKElTX0VSUihkYmktPnJlc2V0
KSkgewogCQlEUk1fREVWX0VSUk9SKGRldiwgIkZhaWxlZCB0byBnZXQgZ3BpbyAncmVzZXQnXG4i
KTsKLQkJcmV0dXJuIFBUUl9FUlIobWlwaS0+cmVzZXQpOworCQlyZXR1cm4gUFRSX0VSUihkYmkt
PnJlc2V0KTsKIAl9CiAKIAlkYyA9IGRldm1fZ3Bpb2RfZ2V0X29wdGlvbmFsKGRldiwgImRjIiwg
R1BJT0RfT1VUX0xPVyk7CkBAIC0yMTIsNyArMjE1LDcgQEAgc3RhdGljIGludCBpbGk5MzQxX3By
b2JlKHN0cnVjdCBzcGlfZGV2aWNlICpzcGkpCiAKIAlkZXZpY2VfcHJvcGVydHlfcmVhZF91MzIo
ZGV2LCAicm90YXRpb24iLCAmcm90YXRpb24pOwogCi0JcmV0ID0gbWlwaV9kYmlfc3BpX2luaXQo
c3BpLCBtaXBpLCBkYyk7CisJcmV0ID0gbWlwaV9kYmlfc3BpX2luaXQoc3BpLCBkYmksIGRjKTsK
IAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
dGlueWRybS9taTAyODNxdC5jIGIvZHJpdmVycy9ncHUvZHJtL3Rpbnlkcm0vbWkwMjgzcXQuYwpp
bmRleCBmMjFkNThkY2FhNWEuLmFkYzhjNDg3MmQzZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL3Rpbnlkcm0vbWkwMjgzcXQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdGlueWRybS9taTAy
ODNxdC5jCkBAIC01Miw2ICs1Miw3IEBAIHN0YXRpYyB2b2lkIG1pMDI4M3F0X2VuYWJsZShzdHJ1
Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCiAJCQkgICAgc3RydWN0IGRybV9wbGFu
ZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCiB7CiAJc3RydWN0IG1pcGlfZGJpICptaXBpID0gZHJtX3Rv
X21pcGlfZGJpKHBpcGUtPmNydGMuZGV2KTsKKwlzdHJ1Y3QgbWlwaV9kYmkgKmRiaSA9IG1pcGk7
CiAJdTggYWRkcl9tb2RlOwogCWludCByZXQsIGlkeDsKIApAQCAtNjYsNDcgKzY3LDQ3IEBAIHN0
YXRpYyB2b2lkIG1pMDI4M3F0X2VuYWJsZShzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUg
KnBpcGUsCiAJaWYgKHJldCA9PSAxKQogCQlnb3RvIG91dF9lbmFibGU7CiAKLQltaXBpX2RiaV9j
b21tYW5kKG1pcGksIE1JUElfRENTX1NFVF9ESVNQTEFZX09GRik7CisJbWlwaV9kYmlfY29tbWFu
ZChkYmksIE1JUElfRENTX1NFVF9ESVNQTEFZX09GRik7CiAKLQltaXBpX2RiaV9jb21tYW5kKG1p
cGksIElMSTkzNDFfUFdDVFJMQiwgMHgwMCwgMHg4MywgMHgzMCk7Ci0JbWlwaV9kYmlfY29tbWFu
ZChtaXBpLCBJTEk5MzQxX1BXUlNFUSwgMHg2NCwgMHgwMywgMHgxMiwgMHg4MSk7Ci0JbWlwaV9k
YmlfY29tbWFuZChtaXBpLCBJTEk5MzQxX0RUQ1RSTEEsIDB4ODUsIDB4MDEsIDB4NzkpOwotCW1p
cGlfZGJpX2NvbW1hbmQobWlwaSwgSUxJOTM0MV9QV0NUUkxBLCAweDM5LCAweDJjLCAweDAwLCAw
eDM0LCAweDAyKTsKLQltaXBpX2RiaV9jb21tYW5kKG1pcGksIElMSTkzNDFfUFVNUENUUkwsIDB4
MjApOwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgSUxJOTM0MV9EVENUUkxCLCAweDAwLCAweDAw
KTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgSUxJOTM0MV9QV0NUUkxCLCAweDAwLCAweDgzLCAw
eDMwKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgSUxJOTM0MV9QV1JTRVEsIDB4NjQsIDB4MDMs
IDB4MTIsIDB4ODEpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5MzQxX0RUQ1RSTEEsIDB4
ODUsIDB4MDEsIDB4NzkpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5MzQxX1BXQ1RSTEEs
IDB4MzksIDB4MmMsIDB4MDAsIDB4MzQsIDB4MDIpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJ
TEk5MzQxX1BVTVBDVFJMLCAweDIwKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgSUxJOTM0MV9E
VENUUkxCLCAweDAwLCAweDAwKTsKIAogCS8qIFBvd2VyIENvbnRyb2wgKi8KLQltaXBpX2RiaV9j
b21tYW5kKG1pcGksIElMSTkzNDFfUFdDVFJMMSwgMHgyNik7Ci0JbWlwaV9kYmlfY29tbWFuZCht
aXBpLCBJTEk5MzQxX1BXQ1RSTDIsIDB4MTEpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5
MzQxX1BXQ1RSTDEsIDB4MjYpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5MzQxX1BXQ1RS
TDIsIDB4MTEpOwogCS8qIFZDT00gKi8KLQltaXBpX2RiaV9jb21tYW5kKG1pcGksIElMSTkzNDFf
Vk1DVFJMMSwgMHgzNSwgMHgzZSk7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBJTEk5MzQxX1ZN
Q1RSTDIsIDB4YmUpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5MzQxX1ZNQ1RSTDEsIDB4
MzUsIDB4M2UpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5MzQxX1ZNQ1RSTDIsIDB4YmUp
OwogCiAJLyogTWVtb3J5IEFjY2VzcyBDb250cm9sICovCi0JbWlwaV9kYmlfY29tbWFuZChtaXBp
LCBNSVBJX0RDU19TRVRfUElYRUxfRk9STUFULCBNSVBJX0RDU19QSVhFTF9GTVRfMTZCSVQpOwor
CW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBNSVBJX0RDU19TRVRfUElYRUxfRk9STUFULCBNSVBJX0RD
U19QSVhFTF9GTVRfMTZCSVQpOwogCiAJLyogRnJhbWUgUmF0ZSAqLwotCW1pcGlfZGJpX2NvbW1h
bmQobWlwaSwgSUxJOTM0MV9GUk1DVFIxLCAweDAwLCAweDFiKTsKKwltaXBpX2RiaV9jb21tYW5k
KGRiaSwgSUxJOTM0MV9GUk1DVFIxLCAweDAwLCAweDFiKTsKIAogCS8qIEdhbW1hICovCi0JbWlw
aV9kYmlfY29tbWFuZChtaXBpLCBJTEk5MzQxX0VOM0dBTSwgMHgwOCk7Ci0JbWlwaV9kYmlfY29t
bWFuZChtaXBpLCBNSVBJX0RDU19TRVRfR0FNTUFfQ1VSVkUsIDB4MDEpOwotCW1pcGlfZGJpX2Nv
bW1hbmQobWlwaSwgSUxJOTM0MV9QR0FNQ1RSTCwKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgSUxJ
OTM0MV9FTjNHQU0sIDB4MDgpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBNSVBJX0RDU19TRVRf
R0FNTUFfQ1VSVkUsIDB4MDEpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5MzQxX1BHQU1D
VFJMLAogCQkgICAgICAgMHgxZiwgMHgxYSwgMHgxOCwgMHgwYSwgMHgwZiwgMHgwNiwgMHg0NSwg
MHg4NywKIAkJICAgICAgIDB4MzIsIDB4MGEsIDB4MDcsIDB4MDIsIDB4MDcsIDB4MDUsIDB4MDAp
OwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgSUxJOTM0MV9OR0FNQ1RSTCwKKwltaXBpX2RiaV9j
b21tYW5kKGRiaSwgSUxJOTM0MV9OR0FNQ1RSTCwKIAkJICAgICAgIDB4MDAsIDB4MjUsIDB4Mjcs
IDB4MDUsIDB4MTAsIDB4MDksIDB4M2EsIDB4NzgsCiAJCSAgICAgICAweDRkLCAweDA1LCAweDE4
LCAweDBkLCAweDM4LCAweDNhLCAweDFmKTsKIAogCS8qIEREUkFNICovCi0JbWlwaV9kYmlfY29t
bWFuZChtaXBpLCBJTEk5MzQxX0VUTU9ELCAweDA3KTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwg
SUxJOTM0MV9FVE1PRCwgMHgwNyk7CiAKIAkvKiBEaXNwbGF5ICovCi0JbWlwaV9kYmlfY29tbWFu
ZChtaXBpLCBJTEk5MzQxX0RJU0NUUkwsIDB4MGEsIDB4ODIsIDB4MjcsIDB4MDApOwotCW1pcGlf
ZGJpX2NvbW1hbmQobWlwaSwgTUlQSV9EQ1NfRVhJVF9TTEVFUF9NT0RFKTsKKwltaXBpX2RiaV9j
b21tYW5kKGRiaSwgSUxJOTM0MV9ESVNDVFJMLCAweDBhLCAweDgyLCAweDI3LCAweDAwKTsKKwlt
aXBpX2RiaV9jb21tYW5kKGRiaSwgTUlQSV9EQ1NfRVhJVF9TTEVFUF9NT0RFKTsKIAltc2xlZXAo
MTAwKTsKIAotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlfT04p
OworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBNSVBJX0RDU19TRVRfRElTUExBWV9PTik7CiAJbXNs
ZWVwKDEwMCk7CiAKIG91dF9lbmFibGU6CkBAIC0xMzIsNyArMTMzLDcgQEAgc3RhdGljIHZvaWQg
bWkwMjgzcXRfZW5hYmxlKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlwZSAqcGlwZSwKIAkJ
YnJlYWs7CiAJfQogCWFkZHJfbW9kZSB8PSBJTEk5MzQxX01BRENUTF9CR1I7Ci0JbWlwaV9kYmlf
Y29tbWFuZChtaXBpLCBNSVBJX0RDU19TRVRfQUREUkVTU19NT0RFLCBhZGRyX21vZGUpOworCW1p
cGlfZGJpX2NvbW1hbmQoZGJpLCBNSVBJX0RDU19TRVRfQUREUkVTU19NT0RFLCBhZGRyX21vZGUp
OwogCW1pcGlfZGJpX2VuYWJsZV9mbHVzaChtaXBpLCBjcnRjX3N0YXRlLCBwbGFuZV9zdGF0ZSk7
CiBvdXRfZXhpdDoKIAlkcm1fZGV2X2V4aXQoaWR4KTsKQEAgLTE4MSw2ICsxODIsNyBAQCBzdGF0
aWMgaW50IG1pMDI4M3F0X3Byb2JlKHN0cnVjdCBzcGlfZGV2aWNlICpzcGkpCiAJc3RydWN0IGRl
dmljZSAqZGV2ID0gJnNwaS0+ZGV2OwogCXN0cnVjdCBkcm1fZGV2aWNlICpkcm07CiAJc3RydWN0
IG1pcGlfZGJpICptaXBpOworCXN0cnVjdCBtaXBpX2RiaSAqZGJpOwogCXN0cnVjdCBncGlvX2Rl
c2MgKmRjOwogCXUzMiByb3RhdGlvbiA9IDA7CiAJaW50IHJldDsKQEAgLTE4OSw2ICsxOTEsNyBA
QCBzdGF0aWMgaW50IG1pMDI4M3F0X3Byb2JlKHN0cnVjdCBzcGlfZGV2aWNlICpzcGkpCiAJaWYg
KCFtaXBpKQogCQlyZXR1cm4gLUVOT01FTTsKIAorCWRiaSA9IG1pcGk7CiAJZHJtID0gJm1pcGkt
PmRybTsKIAlyZXQgPSBkZXZtX2RybV9kZXZfaW5pdChkZXYsIGRybSwgJm1pMDI4M3F0X2RyaXZl
cik7CiAJaWYgKHJldCkgewpAQCAtMTk4LDEwICsyMDEsMTAgQEAgc3RhdGljIGludCBtaTAyODNx
dF9wcm9iZShzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpKQogCiAJZHJtX21vZGVfY29uZmlnX2luaXQo
ZHJtKTsKIAotCW1pcGktPnJlc2V0ID0gZGV2bV9ncGlvZF9nZXRfb3B0aW9uYWwoZGV2LCAicmVz
ZXQiLCBHUElPRF9PVVRfSElHSCk7Ci0JaWYgKElTX0VSUihtaXBpLT5yZXNldCkpIHsKKwlkYmkt
PnJlc2V0ID0gZGV2bV9ncGlvZF9nZXRfb3B0aW9uYWwoZGV2LCAicmVzZXQiLCBHUElPRF9PVVRf
SElHSCk7CisJaWYgKElTX0VSUihkYmktPnJlc2V0KSkgewogCQlEUk1fREVWX0VSUk9SKGRldiwg
IkZhaWxlZCB0byBnZXQgZ3BpbyAncmVzZXQnXG4iKTsKLQkJcmV0dXJuIFBUUl9FUlIobWlwaS0+
cmVzZXQpOworCQlyZXR1cm4gUFRSX0VSUihkYmktPnJlc2V0KTsKIAl9CiAKIAlkYyA9IGRldm1f
Z3Bpb2RfZ2V0X29wdGlvbmFsKGRldiwgImRjIiwgR1BJT0RfT1VUX0xPVyk7CkBAIC0yMjAsNyAr
MjIzLDcgQEAgc3RhdGljIGludCBtaTAyODNxdF9wcm9iZShzdHJ1Y3Qgc3BpX2RldmljZSAqc3Bp
KQogCiAJZGV2aWNlX3Byb3BlcnR5X3JlYWRfdTMyKGRldiwgInJvdGF0aW9uIiwgJnJvdGF0aW9u
KTsKIAotCXJldCA9IG1pcGlfZGJpX3NwaV9pbml0KHNwaSwgbWlwaSwgZGMpOworCXJldCA9IG1p
cGlfZGJpX3NwaV9pbml0KHNwaSwgZGJpLCBkYyk7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsK
IApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Rpbnlkcm0vbWlwaS1kYmkuYyBiL2RyaXZl
cnMvZ3B1L2RybS90aW55ZHJtL21pcGktZGJpLmMKaW5kZXggMzdhNzNiNGMwZjg1Li45M2I5YjNh
YzU1NjggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS90aW55ZHJtL21pcGktZGJpLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL3Rpbnlkcm0vbWlwaS1kYmkuYwpAQCAtMTAwLDE3ICsxMDAsMTcg
QEAgc3RhdGljIGNvbnN0IHU4IG1pcGlfZGJpX2Rjc19yZWFkX2NvbW1hbmRzW10gPSB7CiAJMCwg
Lyogc2VudGluZWwgKi8KIH07CiAKLXN0YXRpYyBib29sIG1pcGlfZGJpX2NvbW1hbmRfaXNfcmVh
ZChzdHJ1Y3QgbWlwaV9kYmkgKm1pcGksIHU4IGNtZCkKK3N0YXRpYyBib29sIG1pcGlfZGJpX2Nv
bW1hbmRfaXNfcmVhZChzdHJ1Y3QgbWlwaV9kYmkgKmRiaSwgdTggY21kKQogewogCXVuc2lnbmVk
IGludCBpOwogCi0JaWYgKCFtaXBpLT5yZWFkX2NvbW1hbmRzKQorCWlmICghZGJpLT5yZWFkX2Nv
bW1hbmRzKQogCQlyZXR1cm4gZmFsc2U7CiAKIAlmb3IgKGkgPSAwOyBpIDwgMHhmZjsgaSsrKSB7
Ci0JCWlmICghbWlwaS0+cmVhZF9jb21tYW5kc1tpXSkKKwkJaWYgKCFkYmktPnJlYWRfY29tbWFu
ZHNbaV0pCiAJCQlyZXR1cm4gZmFsc2U7Ci0JCWlmIChjbWQgPT0gbWlwaS0+cmVhZF9jb21tYW5k
c1tpXSkKKwkJaWYgKGNtZCA9PSBkYmktPnJlYWRfY29tbWFuZHNbaV0pCiAJCQlyZXR1cm4gdHJ1
ZTsKIAl9CiAKQEAgLTExOSw3ICsxMTksNyBAQCBzdGF0aWMgYm9vbCBtaXBpX2RiaV9jb21tYW5k
X2lzX3JlYWQoc3RydWN0IG1pcGlfZGJpICptaXBpLCB1OCBjbWQpCiAKIC8qKgogICogbWlwaV9k
YmlfY29tbWFuZF9yZWFkIC0gTUlQSSBEQ1MgcmVhZCBjb21tYW5kCi0gKiBAbWlwaTogTUlQSSBz
dHJ1Y3R1cmUKKyAqIEBkYmk6IE1JUEkgREJJIHN0cnVjdHVyZQogICogQGNtZDogQ29tbWFuZAog
ICogQHZhbDogVmFsdWUgcmVhZAogICoKQEAgLTEyOCwyMSArMTI4LDIxIEBAIHN0YXRpYyBib29s
IG1pcGlfZGJpX2NvbW1hbmRfaXNfcmVhZChzdHJ1Y3QgbWlwaV9kYmkgKm1pcGksIHU4IGNtZCkK
ICAqIFJldHVybnM6CiAgKiBaZXJvIG9uIHN1Y2Nlc3MsIG5lZ2F0aXZlIGVycm9yIGNvZGUgb24g
ZmFpbHVyZS4KICAqLwotaW50IG1pcGlfZGJpX2NvbW1hbmRfcmVhZChzdHJ1Y3QgbWlwaV9kYmkg
Km1pcGksIHU4IGNtZCwgdTggKnZhbCkKK2ludCBtaXBpX2RiaV9jb21tYW5kX3JlYWQoc3RydWN0
IG1pcGlfZGJpICpkYmksIHU4IGNtZCwgdTggKnZhbCkKIHsKLQlpZiAoIW1pcGktPnJlYWRfY29t
bWFuZHMpCisJaWYgKCFkYmktPnJlYWRfY29tbWFuZHMpCiAJCXJldHVybiAtRUFDQ0VTOwogCi0J
aWYgKCFtaXBpX2RiaV9jb21tYW5kX2lzX3JlYWQobWlwaSwgY21kKSkKKwlpZiAoIW1pcGlfZGJp
X2NvbW1hbmRfaXNfcmVhZChkYmksIGNtZCkpCiAJCXJldHVybiAtRUlOVkFMOwogCi0JcmV0dXJu
IG1pcGlfZGJpX2NvbW1hbmRfYnVmKG1pcGksIGNtZCwgdmFsLCAxKTsKKwlyZXR1cm4gbWlwaV9k
YmlfY29tbWFuZF9idWYoZGJpLCBjbWQsIHZhbCwgMSk7CiB9CiBFWFBPUlRfU1lNQk9MKG1pcGlf
ZGJpX2NvbW1hbmRfcmVhZCk7CiAKIC8qKgogICogbWlwaV9kYmlfY29tbWFuZF9idWYgLSBNSVBJ
IERDUyBjb21tYW5kIHdpdGggcGFyYW1ldGVyKHMpIGluIGFuIGFycmF5Ci0gKiBAbWlwaTogTUlQ
SSBzdHJ1Y3R1cmUKKyAqIEBkYmk6IE1JUEkgREJJIHN0cnVjdHVyZQogICogQGNtZDogQ29tbWFu
ZAogICogQGRhdGE6IFBhcmFtZXRlciBidWZmZXIKICAqIEBsZW46IEJ1ZmZlciBsZW5ndGgKQEAg
LTE1MCw3ICsxNTAsNyBAQCBFWFBPUlRfU1lNQk9MKG1pcGlfZGJpX2NvbW1hbmRfcmVhZCk7CiAg
KiBSZXR1cm5zOgogICogWmVybyBvbiBzdWNjZXNzLCBuZWdhdGl2ZSBlcnJvciBjb2RlIG9uIGZh
aWx1cmUuCiAgKi8KLWludCBtaXBpX2RiaV9jb21tYW5kX2J1ZihzdHJ1Y3QgbWlwaV9kYmkgKm1p
cGksIHU4IGNtZCwgdTggKmRhdGEsIHNpemVfdCBsZW4pCitpbnQgbWlwaV9kYmlfY29tbWFuZF9i
dWYoc3RydWN0IG1pcGlfZGJpICpkYmksIHU4IGNtZCwgdTggKmRhdGEsIHNpemVfdCBsZW4pCiB7
CiAJdTggKmNtZGJ1ZjsKIAlpbnQgcmV0OwpAQCAtMTYwLDkgKzE2MCw5IEBAIGludCBtaXBpX2Ri
aV9jb21tYW5kX2J1ZihzdHJ1Y3QgbWlwaV9kYmkgKm1pcGksIHU4IGNtZCwgdTggKmRhdGEsIHNp
emVfdCBsZW4pCiAJaWYgKCFjbWRidWYpCiAJCXJldHVybiAtRU5PTUVNOwogCi0JbXV0ZXhfbG9j
aygmbWlwaS0+Y21kbG9jayk7Ci0JcmV0ID0gbWlwaS0+Y29tbWFuZChtaXBpLCBjbWRidWYsIGRh
dGEsIGxlbik7Ci0JbXV0ZXhfdW5sb2NrKCZtaXBpLT5jbWRsb2NrKTsKKwltdXRleF9sb2NrKCZk
YmktPmNtZGxvY2spOworCXJldCA9IGRiaS0+Y29tbWFuZChkYmksIGNtZGJ1ZiwgZGF0YSwgbGVu
KTsKKwltdXRleF91bmxvY2soJmRiaS0+Y21kbG9jayk7CiAKIAlrZnJlZShjbWRidWYpOwogCkBA
IC0xNzEsNyArMTcxLDcgQEAgaW50IG1pcGlfZGJpX2NvbW1hbmRfYnVmKHN0cnVjdCBtaXBpX2Ri
aSAqbWlwaSwgdTggY21kLCB1OCAqZGF0YSwgc2l6ZV90IGxlbikKIEVYUE9SVF9TWU1CT0wobWlw
aV9kYmlfY29tbWFuZF9idWYpOwogCiAvKiBUaGlzIHNob3VsZCBvbmx5IGJlIHVzZWQgYnkgbWlw
aV9kYmlfY29tbWFuZCgpICovCi1pbnQgbWlwaV9kYmlfY29tbWFuZF9zdGFja2J1ZihzdHJ1Y3Qg
bWlwaV9kYmkgKm1pcGksIHU4IGNtZCwgdTggKmRhdGEsIHNpemVfdCBsZW4pCitpbnQgbWlwaV9k
YmlfY29tbWFuZF9zdGFja2J1ZihzdHJ1Y3QgbWlwaV9kYmkgKmRiaSwgdTggY21kLCB1OCAqZGF0
YSwgc2l6ZV90IGxlbikKIHsKIAl1OCAqYnVmOwogCWludCByZXQ7CkBAIC0xODAsNyArMTgwLDcg
QEAgaW50IG1pcGlfZGJpX2NvbW1hbmRfc3RhY2tidWYoc3RydWN0IG1pcGlfZGJpICptaXBpLCB1
OCBjbWQsIHU4ICpkYXRhLCBzaXplX3QgbGUKIAlpZiAoIWJ1ZikKIAkJcmV0dXJuIC1FTk9NRU07
CiAKLQlyZXQgPSBtaXBpX2RiaV9jb21tYW5kX2J1ZihtaXBpLCBjbWQsIGJ1ZiwgbGVuKTsKKwly
ZXQgPSBtaXBpX2RiaV9jb21tYW5kX2J1ZihkYmksIGNtZCwgYnVmLCBsZW4pOwogCiAJa2ZyZWUo
YnVmKTsKIApAQCAtMjQ0LDcgKzI0NCw4IEBAIHN0YXRpYyB2b2lkIG1pcGlfZGJpX2ZiX2RpcnR5
KHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLCBzdHJ1Y3QgZHJtX3JlY3QgKnJlY3QpCiAJc3Ry
dWN0IG1pcGlfZGJpICptaXBpID0gZHJtX3RvX21pcGlfZGJpKGZiLT5kZXYpOwogCXVuc2lnbmVk
IGludCBoZWlnaHQgPSByZWN0LT55MiAtIHJlY3QtPnkxOwogCXVuc2lnbmVkIGludCB3aWR0aCA9
IHJlY3QtPngyIC0gcmVjdC0+eDE7Ci0JYm9vbCBzd2FwID0gbWlwaS0+c3dhcF9ieXRlczsKKwlz
dHJ1Y3QgbWlwaV9kYmkgKmRiaSA9IG1pcGk7CisJYm9vbCBzd2FwID0gZGJpLT5zd2FwX2J5dGVz
OwogCWludCBpZHgsIHJldCA9IDA7CiAJYm9vbCBmdWxsOwogCXZvaWQgKnRyOwpAQCAtMjU5LDcg
KzI2MCw3IEBAIHN0YXRpYyB2b2lkIG1pcGlfZGJpX2ZiX2RpcnR5KHN0cnVjdCBkcm1fZnJhbWVi
dWZmZXIgKmZiLCBzdHJ1Y3QgZHJtX3JlY3QgKnJlY3QpCiAKIAlEUk1fREVCVUdfS01TKCJGbHVz
aGluZyBbRkI6JWRdICIgRFJNX1JFQ1RfRk1UICJcbiIsIGZiLT5iYXNlLmlkLCBEUk1fUkVDVF9B
UkcocmVjdCkpOwogCi0JaWYgKCFtaXBpLT5kYyB8fCAhZnVsbCB8fCBzd2FwIHx8CisJaWYgKCFk
YmktPmRjIHx8ICFmdWxsIHx8IHN3YXAgfHwKIAkgICAgZmItPmZvcm1hdC0+Zm9ybWF0ID09IERS
TV9GT1JNQVRfWFJHQjg4ODgpIHsKIAkJdHIgPSBtaXBpLT50eF9idWY7CiAJCXJldCA9IG1pcGlf
ZGJpX2J1Zl9jb3B5KG1pcGktPnR4X2J1ZiwgZmIsIHJlY3QsIHN3YXApOwpAQCAtMjY5LDE0ICsy
NzAsMTQgQEAgc3RhdGljIHZvaWQgbWlwaV9kYmlfZmJfZGlydHkoc3RydWN0IGRybV9mcmFtZWJ1
ZmZlciAqZmIsIHN0cnVjdCBkcm1fcmVjdCAqcmVjdCkKIAkJdHIgPSBjbWFfb2JqLT52YWRkcjsK
IAl9CiAKLQltaXBpX2RiaV9jb21tYW5kKG1pcGksIE1JUElfRENTX1NFVF9DT0xVTU5fQUREUkVT
UywKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgTUlQSV9EQ1NfU0VUX0NPTFVNTl9BRERSRVNTLAog
CQkJIChyZWN0LT54MSA+PiA4KSAmIDB4ZmYsIHJlY3QtPngxICYgMHhmZiwKIAkJCSAoKHJlY3Qt
PngyIC0gMSkgPj4gOCkgJiAweGZmLCAocmVjdC0+eDIgLSAxKSAmIDB4ZmYpOwotCW1pcGlfZGJp
X2NvbW1hbmQobWlwaSwgTUlQSV9EQ1NfU0VUX1BBR0VfQUREUkVTUywKKwltaXBpX2RiaV9jb21t
YW5kKGRiaSwgTUlQSV9EQ1NfU0VUX1BBR0VfQUREUkVTUywKIAkJCSAocmVjdC0+eTEgPj4gOCkg
JiAweGZmLCByZWN0LT55MSAmIDB4ZmYsCiAJCQkgKChyZWN0LT55MiAtIDEpID4+IDgpICYgMHhm
ZiwgKHJlY3QtPnkyIC0gMSkgJiAweGZmKTsKIAotCXJldCA9IG1pcGlfZGJpX2NvbW1hbmRfYnVm
KG1pcGksIE1JUElfRENTX1dSSVRFX01FTU9SWV9TVEFSVCwgdHIsCisJcmV0ID0gbWlwaV9kYmlf
Y29tbWFuZF9idWYoZGJpLCBNSVBJX0RDU19XUklURV9NRU1PUllfU1RBUlQsIHRyLAogCQkJCSAg
IHdpZHRoICogaGVpZ2h0ICogMik7CiBlcnJfbXNnOgogCWlmIChyZXQpCkBAIC0zNTYsNiArMzU3
LDcgQEAgc3RhdGljIHZvaWQgbWlwaV9kYmlfYmxhbmsoc3RydWN0IG1pcGlfZGJpICptaXBpKQog
CXUxNiBoZWlnaHQgPSBkcm0tPm1vZGVfY29uZmlnLm1pbl9oZWlnaHQ7CiAJdTE2IHdpZHRoID0g
ZHJtLT5tb2RlX2NvbmZpZy5taW5fd2lkdGg7CiAJc2l6ZV90IGxlbiA9IHdpZHRoICogaGVpZ2h0
ICogMjsKKwlzdHJ1Y3QgbWlwaV9kYmkgKmRiaSA9IG1pcGk7CiAJaW50IGlkeDsKIAogCWlmICgh
ZHJtX2Rldl9lbnRlcihkcm0sICZpZHgpKQpAQCAtMzYzLDExICszNjUsMTEgQEAgc3RhdGljIHZv
aWQgbWlwaV9kYmlfYmxhbmsoc3RydWN0IG1pcGlfZGJpICptaXBpKQogCiAJbWVtc2V0KG1pcGkt
PnR4X2J1ZiwgMCwgbGVuKTsKIAotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgTUlQSV9EQ1NfU0VU
X0NPTFVNTl9BRERSRVNTLCAwLCAwLAorCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBNSVBJX0RDU19T
RVRfQ09MVU1OX0FERFJFU1MsIDAsIDAsCiAJCQkgKHdpZHRoID4+IDgpICYgMHhGRiwgKHdpZHRo
IC0gMSkgJiAweEZGKTsKLQltaXBpX2RiaV9jb21tYW5kKG1pcGksIE1JUElfRENTX1NFVF9QQUdF
X0FERFJFU1MsIDAsIDAsCisJbWlwaV9kYmlfY29tbWFuZChkYmksIE1JUElfRENTX1NFVF9QQUdF
X0FERFJFU1MsIDAsIDAsCiAJCQkgKGhlaWdodCA+PiA4KSAmIDB4RkYsIChoZWlnaHQgLSAxKSAm
IDB4RkYpOwotCW1pcGlfZGJpX2NvbW1hbmRfYnVmKG1pcGksIE1JUElfRENTX1dSSVRFX01FTU9S
WV9TVEFSVCwKKwltaXBpX2RiaV9jb21tYW5kX2J1ZihkYmksIE1JUElfRENTX1dSSVRFX01FTU9S
WV9TVEFSVCwKIAkJCSAgICAgKHU4ICopbWlwaS0+dHhfYnVmLCBsZW4pOwogCiAJZHJtX2Rldl9l
eGl0KGlkeCk7CkBAIC01OTYsMjUgKzU5OCwyNSBAQCBFWFBPUlRfU1lNQk9MKG1pcGlfZGJpX3Jl
bGVhc2UpOwogCiAvKioKICAqIG1pcGlfZGJpX2h3X3Jlc2V0IC0gSGFyZHdhcmUgcmVzZXQgb2Yg
Y29udHJvbGxlcgotICogQG1pcGk6IE1JUEkgREJJIHN0cnVjdHVyZQorICogQGRiaTogTUlQSSBE
Qkkgc3RydWN0dXJlCiAgKgogICogUmVzZXQgY29udHJvbGxlciBpZiB0aGUgJm1pcGlfZGJpLT5y
ZXNldCBncGlvIGlzIHNldC4KICAqLwotdm9pZCBtaXBpX2RiaV9od19yZXNldChzdHJ1Y3QgbWlw
aV9kYmkgKm1pcGkpCit2b2lkIG1pcGlfZGJpX2h3X3Jlc2V0KHN0cnVjdCBtaXBpX2RiaSAqZGJp
KQogewotCWlmICghbWlwaS0+cmVzZXQpCisJaWYgKCFkYmktPnJlc2V0KQogCQlyZXR1cm47CiAK
LQlncGlvZF9zZXRfdmFsdWVfY2Fuc2xlZXAobWlwaS0+cmVzZXQsIDApOworCWdwaW9kX3NldF92
YWx1ZV9jYW5zbGVlcChkYmktPnJlc2V0LCAwKTsKIAl1c2xlZXBfcmFuZ2UoMjAsIDEwMDApOwot
CWdwaW9kX3NldF92YWx1ZV9jYW5zbGVlcChtaXBpLT5yZXNldCwgMSk7CisJZ3Bpb2Rfc2V0X3Zh
bHVlX2NhbnNsZWVwKGRiaS0+cmVzZXQsIDEpOwogCW1zbGVlcCgxMjApOwogfQogRVhQT1JUX1NZ
TUJPTChtaXBpX2RiaV9od19yZXNldCk7CiAKIC8qKgogICogbWlwaV9kYmlfZGlzcGxheV9pc19v
biAtIENoZWNrIGlmIGRpc3BsYXkgaXMgb24KLSAqIEBtaXBpOiBNSVBJIERCSSBzdHJ1Y3R1cmUK
KyAqIEBkYmk6IE1JUEkgREJJIHN0cnVjdHVyZQogICoKICAqIFRoaXMgZnVuY3Rpb24gY2hlY2tz
IHRoZSBQb3dlciBNb2RlIHJlZ2lzdGVyIChpZiByZWFkYWJsZSkgdG8gc2VlIGlmCiAgKiBkaXNw
bGF5IG91dHB1dCBpcyB0dXJuZWQgb24uIFRoaXMgY2FuIGJlIHVzZWQgdG8gc2VlIGlmIHRoZSBi
b290bG9hZGVyCkBAIC02MjQsMTEgKzYyNiwxMSBAQCBFWFBPUlRfU1lNQk9MKG1pcGlfZGJpX2h3
X3Jlc2V0KTsKICAqIFJldHVybnM6CiAgKiB0cnVlIGlmIHRoZSBkaXNwbGF5IGNhbiBiZSB2ZXJp
ZmllZCB0byBiZSBvbiwgZmFsc2Ugb3RoZXJ3aXNlLgogICovCi1ib29sIG1pcGlfZGJpX2Rpc3Bs
YXlfaXNfb24oc3RydWN0IG1pcGlfZGJpICptaXBpKQorYm9vbCBtaXBpX2RiaV9kaXNwbGF5X2lz
X29uKHN0cnVjdCBtaXBpX2RiaSAqZGJpKQogewogCXU4IHZhbDsKIAotCWlmIChtaXBpX2RiaV9j
b21tYW5kX3JlYWQobWlwaSwgTUlQSV9EQ1NfR0VUX1BPV0VSX01PREUsICZ2YWwpKQorCWlmICht
aXBpX2RiaV9jb21tYW5kX3JlYWQoZGJpLCBNSVBJX0RDU19HRVRfUE9XRVJfTU9ERSwgJnZhbCkp
CiAJCXJldHVybiBmYWxzZTsKIAogCXZhbCAmPSB+RENTX1BPV0VSX01PREVfUkVTRVJWRURfTUFT
SzsKQEAgLTY0Nyw2ICs2NDksNyBAQCBFWFBPUlRfU1lNQk9MKG1pcGlfZGJpX2Rpc3BsYXlfaXNf
b24pOwogc3RhdGljIGludCBtaXBpX2RiaV9wb3dlcm9uX3Jlc2V0X2NvbmRpdGlvbmFsKHN0cnVj
dCBtaXBpX2RiaSAqbWlwaSwgYm9vbCBjb25kKQogewogCXN0cnVjdCBkZXZpY2UgKmRldiA9IG1p
cGktPmRybS5kZXY7CisJc3RydWN0IG1pcGlfZGJpICpkYmkgPSBtaXBpOwogCWludCByZXQ7CiAK
IAlpZiAobWlwaS0+cmVndWxhdG9yKSB7CkBAIC02NTcsMTEgKzY2MCwxMSBAQCBzdGF0aWMgaW50
IG1pcGlfZGJpX3Bvd2Vyb25fcmVzZXRfY29uZGl0aW9uYWwoc3RydWN0IG1pcGlfZGJpICptaXBp
LCBib29sIGNvbmQpCiAJCX0KIAl9CiAKLQlpZiAoY29uZCAmJiBtaXBpX2RiaV9kaXNwbGF5X2lz
X29uKG1pcGkpKQorCWlmIChjb25kICYmIG1pcGlfZGJpX2Rpc3BsYXlfaXNfb24oZGJpKSkKIAkJ
cmV0dXJuIDE7CiAKLQltaXBpX2RiaV9od19yZXNldChtaXBpKTsKLQlyZXQgPSBtaXBpX2RiaV9j
b21tYW5kKG1pcGksIE1JUElfRENTX1NPRlRfUkVTRVQpOworCW1pcGlfZGJpX2h3X3Jlc2V0KGRi
aSk7CisJcmV0ID0gbWlwaV9kYmlfY29tbWFuZChkYmksIE1JUElfRENTX1NPRlRfUkVTRVQpOwog
CWlmIChyZXQpIHsKIAkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8gc2VuZCByZXNldCBj
b21tYW5kICglZClcbiIsIHJldCk7CiAJCWlmIChtaXBpLT5yZWd1bGF0b3IpCkBAIC02NzQsNyAr
Njc3LDcgQEAgc3RhdGljIGludCBtaXBpX2RiaV9wb3dlcm9uX3Jlc2V0X2NvbmRpdGlvbmFsKHN0
cnVjdCBtaXBpX2RiaSAqbWlwaSwgYm9vbCBjb25kKQogCSAqIHBlciBNSVBJIERTQyBzcGVjIHNo
b3VsZCB3YWl0IDVtcyBhZnRlciBzb2Z0IHJlc2V0LiBJZiB3ZSBkaWRuJ3QsCiAJICogd2UgYXNz
dW1lIHdvcnN0IGNhc2UgYW5kIHdhaXQgMTIwbXMuCiAJICovCi0JaWYgKG1pcGktPnJlc2V0KQor
CWlmIChkYmktPnJlc2V0KQogCQl1c2xlZXBfcmFuZ2UoNTAwMCwgMjAwMDApOwogCWVsc2UKIAkJ
bXNsZWVwKDEyMCk7CkBAIC03NjMsMTUgKzc2NiwxNSBAQCBzdGF0aWMgYm9vbCBtaXBpX2RiaV9t
YWNoaW5lX2xpdHRsZV9lbmRpYW4odm9pZCkKICAqICAgICA3NjU0MzIxMAogICovCiAKLXN0YXRp
YyBpbnQgbWlwaV9kYmlfc3BpMWVfdHJhbnNmZXIoc3RydWN0IG1pcGlfZGJpICptaXBpLCBpbnQg
ZGMsCitzdGF0aWMgaW50IG1pcGlfZGJpX3NwaTFlX3RyYW5zZmVyKHN0cnVjdCBtaXBpX2RiaSAq
ZGJpLCBpbnQgZGMsCiAJCQkJICAgY29uc3Qgdm9pZCAqYnVmLCBzaXplX3QgbGVuLAogCQkJCSAg
IHVuc2lnbmVkIGludCBicHcpCiB7CiAJYm9vbCBzd2FwX2J5dGVzID0gKGJwdyA9PSAxNiAmJiBt
aXBpX2RiaV9tYWNoaW5lX2xpdHRsZV9lbmRpYW4oKSk7Ci0Jc2l6ZV90IGNodW5rLCBtYXhfY2h1
bmsgPSBtaXBpLT50eF9idWY5X2xlbjsKLQlzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpID0gbWlwaS0+
c3BpOworCXNpemVfdCBjaHVuaywgbWF4X2NodW5rID0gZGJpLT50eF9idWY5X2xlbjsKKwlzdHJ1
Y3Qgc3BpX2RldmljZSAqc3BpID0gZGJpLT5zcGk7CiAJc3RydWN0IHNwaV90cmFuc2ZlciB0ciA9
IHsKLQkJLnR4X2J1ZiA9IG1pcGktPnR4X2J1ZjksCisJCS50eF9idWYgPSBkYmktPnR4X2J1Zjks
CiAJCS5iaXRzX3Blcl93b3JkID0gOCwKIAl9OwogCXN0cnVjdCBzcGlfbWVzc2FnZSBtOwpAQCAt
NzkxLDcgKzc5NCw3IEBAIHN0YXRpYyBpbnQgbWlwaV9kYmlfc3BpMWVfdHJhbnNmZXIoc3RydWN0
IG1pcGlfZGJpICptaXBpLCBpbnQgZGMsCiAJCQlyZXR1cm4gLUVJTlZBTDsKIAogCQkvKiBDb21t
YW5kOiBwYWQgbm8tb3AncyAoemVyb2VzKSBhdCBiZWdpbm5pbmcgb2YgYmxvY2sgKi8KLQkJZHN0
ID0gbWlwaS0+dHhfYnVmOTsKKwkJZHN0ID0gZGJpLT50eF9idWY5OwogCQltZW1zZXQoZHN0LCAw
LCA5KTsKIAkJZHN0WzhdID0gKnNyYzsKIAkJdHIubGVuID0gOTsKQEAgLTgxMSw3ICs4MTQsNyBA
QCBzdGF0aWMgaW50IG1pcGlfZGJpX3NwaTFlX3RyYW5zZmVyKHN0cnVjdCBtaXBpX2RiaSAqbWlw
aSwgaW50IGRjLAogCiAJCWNodW5rID0gbWluKGxlbiwgbWF4X2NodW5rKTsKIAkJbGVuIC09IGNo
dW5rOwotCQlkc3QgPSBtaXBpLT50eF9idWY5OworCQlkc3QgPSBkYmktPnR4X2J1Zjk7CiAKIAkJ
aWYgKGNodW5rIDwgOCkgewogCQkJdTggdmFsLCBjYXJyeSA9IDA7CkBAIC04ODEsMTEgKzg4NCwx
MSBAQCBzdGF0aWMgaW50IG1pcGlfZGJpX3NwaTFlX3RyYW5zZmVyKHN0cnVjdCBtaXBpX2RiaSAq
bWlwaSwgaW50IGRjLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IG1pcGlfZGJpX3NwaTFf
dHJhbnNmZXIoc3RydWN0IG1pcGlfZGJpICptaXBpLCBpbnQgZGMsCitzdGF0aWMgaW50IG1pcGlf
ZGJpX3NwaTFfdHJhbnNmZXIoc3RydWN0IG1pcGlfZGJpICpkYmksIGludCBkYywKIAkJCQkgIGNv
bnN0IHZvaWQgKmJ1Ziwgc2l6ZV90IGxlbiwKIAkJCQkgIHVuc2lnbmVkIGludCBicHcpCiB7Ci0J
c3RydWN0IHNwaV9kZXZpY2UgKnNwaSA9IG1pcGktPnNwaTsKKwlzdHJ1Y3Qgc3BpX2RldmljZSAq
c3BpID0gZGJpLT5zcGk7CiAJc3RydWN0IHNwaV90cmFuc2ZlciB0ciA9IHsKIAkJLmJpdHNfcGVy
X3dvcmQgPSA5LAogCX07CkBAIC04OTcsMTEgKzkwMCwxMSBAQCBzdGF0aWMgaW50IG1pcGlfZGJp
X3NwaTFfdHJhbnNmZXIoc3RydWN0IG1pcGlfZGJpICptaXBpLCBpbnQgZGMsCiAJaW50IHJldDsK
IAogCWlmICghc3BpX2lzX2Jwd19zdXBwb3J0ZWQoc3BpLCA5KSkKLQkJcmV0dXJuIG1pcGlfZGJp
X3NwaTFlX3RyYW5zZmVyKG1pcGksIGRjLCBidWYsIGxlbiwgYnB3KTsKKwkJcmV0dXJuIG1pcGlf
ZGJpX3NwaTFlX3RyYW5zZmVyKGRiaSwgZGMsIGJ1ZiwgbGVuLCBicHcpOwogCiAJdHIuc3BlZWRf
aHogPSBtaXBpX2RiaV9zcGlfY21kX21heF9zcGVlZChzcGksIGxlbik7Ci0JbWF4X2NodW5rID0g
bWlwaS0+dHhfYnVmOV9sZW47Ci0JZHN0MTYgPSBtaXBpLT50eF9idWY5OworCW1heF9jaHVuayA9
IGRiaS0+dHhfYnVmOV9sZW47CisJZHN0MTYgPSBkYmktPnR4X2J1Zjk7CiAKIAlpZiAoZHJtX2Rl
YnVnICYgRFJNX1VUX0RSSVZFUikKIAkJcHJfZGVidWcoIltkcm06JXNdIGRjPSVkLCBtYXhfY2h1
bms9JXp1LCB0cmFuc2ZlcnM6XG4iLApAQCAtOTQ0LDMwICs5NDcsMzAgQEAgc3RhdGljIGludCBt
aXBpX2RiaV9zcGkxX3RyYW5zZmVyKHN0cnVjdCBtaXBpX2RiaSAqbWlwaSwgaW50IGRjLAogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IG1pcGlfZGJpX3R5cGVjMV9jb21tYW5kKHN0cnVjdCBt
aXBpX2RiaSAqbWlwaSwgdTggKmNtZCwKK3N0YXRpYyBpbnQgbWlwaV9kYmlfdHlwZWMxX2NvbW1h
bmQoc3RydWN0IG1pcGlfZGJpICpkYmksIHU4ICpjbWQsCiAJCQkJICAgdTggKnBhcmFtZXRlcnMs
IHNpemVfdCBudW0pCiB7CiAJdW5zaWduZWQgaW50IGJwdyA9ICgqY21kID09IE1JUElfRENTX1dS
SVRFX01FTU9SWV9TVEFSVCkgPyAxNiA6IDg7CiAJaW50IHJldDsKIAotCWlmIChtaXBpX2RiaV9j
b21tYW5kX2lzX3JlYWQobWlwaSwgKmNtZCkpCisJaWYgKG1pcGlfZGJpX2NvbW1hbmRfaXNfcmVh
ZChkYmksICpjbWQpKQogCQlyZXR1cm4gLUVOT1RTVVBQOwogCiAJTUlQSV9EQklfREVCVUdfQ09N
TUFORCgqY21kLCBwYXJhbWV0ZXJzLCBudW0pOwogCi0JcmV0ID0gbWlwaV9kYmlfc3BpMV90cmFu
c2ZlcihtaXBpLCAwLCBjbWQsIDEsIDgpOworCXJldCA9IG1pcGlfZGJpX3NwaTFfdHJhbnNmZXIo
ZGJpLCAwLCBjbWQsIDEsIDgpOwogCWlmIChyZXQgfHwgIW51bSkKIAkJcmV0dXJuIHJldDsKIAot
CXJldHVybiBtaXBpX2RiaV9zcGkxX3RyYW5zZmVyKG1pcGksIDEsIHBhcmFtZXRlcnMsIG51bSwg
YnB3KTsKKwlyZXR1cm4gbWlwaV9kYmlfc3BpMV90cmFuc2ZlcihkYmksIDEsIHBhcmFtZXRlcnMs
IG51bSwgYnB3KTsKIH0KIAogLyogTUlQSSBEQkkgVHlwZSBDIE9wdGlvbiAzICovCiAKLXN0YXRp
YyBpbnQgbWlwaV9kYmlfdHlwZWMzX2NvbW1hbmRfcmVhZChzdHJ1Y3QgbWlwaV9kYmkgKm1pcGks
IHU4ICpjbWQsCitzdGF0aWMgaW50IG1pcGlfZGJpX3R5cGVjM19jb21tYW5kX3JlYWQoc3RydWN0
IG1pcGlfZGJpICpkYmksIHU4ICpjbWQsCiAJCQkJCXU4ICpkYXRhLCBzaXplX3QgbGVuKQogewot
CXN0cnVjdCBzcGlfZGV2aWNlICpzcGkgPSBtaXBpLT5zcGk7CisJc3RydWN0IHNwaV9kZXZpY2Ug
KnNwaSA9IGRiaS0+c3BpOwogCXUzMiBzcGVlZF9oeiA9IG1pbl90KHUzMiwgTUlQSV9EQklfTUFY
X1NQSV9SRUFEX1NQRUVELAogCQkJICAgICBzcGktPm1heF9zcGVlZF9oeiAvIDIpOwogCXN0cnVj
dCBzcGlfdHJhbnNmZXIgdHJbMl0gPSB7CkBAIC0xMDA0LDcgKzEwMDcsNyBAQCBzdGF0aWMgaW50
IG1pcGlfZGJpX3R5cGVjM19jb21tYW5kX3JlYWQoc3RydWN0IG1pcGlfZGJpICptaXBpLCB1OCAq
Y21kLAogCQlyZXR1cm4gLUVOT01FTTsKIAogCXRyWzFdLnJ4X2J1ZiA9IGJ1ZjsKLQlncGlvZF9z
ZXRfdmFsdWVfY2Fuc2xlZXAobWlwaS0+ZGMsIDApOworCWdwaW9kX3NldF92YWx1ZV9jYW5zbGVl
cChkYmktPmRjLCAwKTsKIAogCXNwaV9tZXNzYWdlX2luaXRfd2l0aF90cmFuc2ZlcnMoJm0sIHRy
LCBBUlJBWV9TSVpFKHRyKSk7CiAJcmV0ID0gc3BpX3N5bmMoc3BpLCAmbSk7CkBAIC0xMDI4LDQx
ICsxMDMxLDQxIEBAIHN0YXRpYyBpbnQgbWlwaV9kYmlfdHlwZWMzX2NvbW1hbmRfcmVhZChzdHJ1
Y3QgbWlwaV9kYmkgKm1pcGksIHU4ICpjbWQsCiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIGlu
dCBtaXBpX2RiaV90eXBlYzNfY29tbWFuZChzdHJ1Y3QgbWlwaV9kYmkgKm1pcGksIHU4ICpjbWQs
CitzdGF0aWMgaW50IG1pcGlfZGJpX3R5cGVjM19jb21tYW5kKHN0cnVjdCBtaXBpX2RiaSAqZGJp
LCB1OCAqY21kLAogCQkJCSAgIHU4ICpwYXIsIHNpemVfdCBudW0pCiB7Ci0Jc3RydWN0IHNwaV9k
ZXZpY2UgKnNwaSA9IG1pcGktPnNwaTsKKwlzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpID0gZGJpLT5z
cGk7CiAJdW5zaWduZWQgaW50IGJwdyA9IDg7CiAJdTMyIHNwZWVkX2h6OwogCWludCByZXQ7CiAK
LQlpZiAobWlwaV9kYmlfY29tbWFuZF9pc19yZWFkKG1pcGksICpjbWQpKQotCQlyZXR1cm4gbWlw
aV9kYmlfdHlwZWMzX2NvbW1hbmRfcmVhZChtaXBpLCBjbWQsIHBhciwgbnVtKTsKKwlpZiAobWlw
aV9kYmlfY29tbWFuZF9pc19yZWFkKGRiaSwgKmNtZCkpCisJCXJldHVybiBtaXBpX2RiaV90eXBl
YzNfY29tbWFuZF9yZWFkKGRiaSwgY21kLCBwYXIsIG51bSk7CiAKIAlNSVBJX0RCSV9ERUJVR19D
T01NQU5EKCpjbWQsIHBhciwgbnVtKTsKIAotCWdwaW9kX3NldF92YWx1ZV9jYW5zbGVlcChtaXBp
LT5kYywgMCk7CisJZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKGRiaS0+ZGMsIDApOwogCXNwZWVk
X2h6ID0gbWlwaV9kYmlfc3BpX2NtZF9tYXhfc3BlZWQoc3BpLCAxKTsKIAlyZXQgPSBtaXBpX2Ri
aV9zcGlfdHJhbnNmZXIoc3BpLCBzcGVlZF9oeiwgOCwgY21kLCAxKTsKIAlpZiAocmV0IHx8ICFu
dW0pCiAJCXJldHVybiByZXQ7CiAKLQlpZiAoKmNtZCA9PSBNSVBJX0RDU19XUklURV9NRU1PUllf
U1RBUlQgJiYgIW1pcGktPnN3YXBfYnl0ZXMpCisJaWYgKCpjbWQgPT0gTUlQSV9EQ1NfV1JJVEVf
TUVNT1JZX1NUQVJUICYmICFkYmktPnN3YXBfYnl0ZXMpCiAJCWJwdyA9IDE2OwogCi0JZ3Bpb2Rf
c2V0X3ZhbHVlX2NhbnNsZWVwKG1pcGktPmRjLCAxKTsKKwlncGlvZF9zZXRfdmFsdWVfY2Fuc2xl
ZXAoZGJpLT5kYywgMSk7CiAJc3BlZWRfaHogPSBtaXBpX2RiaV9zcGlfY21kX21heF9zcGVlZChz
cGksIG51bSk7CiAKIAlyZXR1cm4gbWlwaV9kYmlfc3BpX3RyYW5zZmVyKHNwaSwgc3BlZWRfaHos
IGJwdywgcGFyLCBudW0pOwogfQogCiAvKioKLSAqIG1pcGlfZGJpX3NwaV9pbml0IC0gSW5pdGlh
bGl6ZSBNSVBJIERCSSBTUEkgaW50ZXJmYWNlZCBjb250cm9sbGVyCisgKiBtaXBpX2RiaV9zcGlf
aW5pdCAtIEluaXRpYWxpemUgTUlQSSBEQkkgU1BJIGludGVyZmFjZQogICogQHNwaTogU1BJIGRl
dmljZQotICogQG1pcGk6ICZtaXBpX2RiaSBzdHJ1Y3R1cmUgdG8gaW5pdGlhbGl6ZQorICogQGRi
aTogTUlQSSBEQkkgc3RydWN0dXJlIHRvIGluaXRpYWxpemUKICAqIEBkYzogRC9DIGdwaW8gKG9w
dGlvbmFsKQogICoKLSAqIFRoaXMgZnVuY3Rpb24gc2V0cyAmbWlwaV9kYmktPmNvbW1hbmQsIGVu
YWJsZXMgJm1pcGktPnJlYWRfY29tbWFuZHMgZm9yIHRoZQorICogVGhpcyBmdW5jdGlvbiBzZXRz
ICZtaXBpX2RiaS0+Y29tbWFuZCwgZW5hYmxlcyAmbWlwaV9kYmktPnJlYWRfY29tbWFuZHMgZm9y
IHRoZQogICogdXN1YWwgcmVhZCBjb21tYW5kcy4gSXQgc2hvdWxkIGJlIGZvbGxvd2VkIGJ5IGEg
Y2FsbCB0byBtaXBpX2RiaV9pbml0KCkgb3IKICAqIGEgZHJpdmVyLXNwZWNpZmljIGluaXQuCiAg
KgpAQCAtMTA3OCw3ICsxMDgxLDcgQEAgc3RhdGljIGludCBtaXBpX2RiaV90eXBlYzNfY29tbWFu
ZChzdHJ1Y3QgbWlwaV9kYmkgKm1pcGksIHU4ICpjbWQsCiAgKiBSZXR1cm5zOgogICogWmVybyBv
biBzdWNjZXNzLCBuZWdhdGl2ZSBlcnJvciBjb2RlIG9uIGZhaWx1cmUuCiAgKi8KLWludCBtaXBp
X2RiaV9zcGlfaW5pdChzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpLCBzdHJ1Y3QgbWlwaV9kYmkgKm1p
cGksCitpbnQgbWlwaV9kYmlfc3BpX2luaXQoc3RydWN0IHNwaV9kZXZpY2UgKnNwaSwgc3RydWN0
IG1pcGlfZGJpICpkYmksCiAJCSAgICAgIHN0cnVjdCBncGlvX2Rlc2MgKmRjKQogewogCXN0cnVj
dCBkZXZpY2UgKmRldiA9ICZzcGktPmRldjsKQEAgLTExMDIsMjMgKzExMDUsMjMgQEAgaW50IG1p
cGlfZGJpX3NwaV9pbml0KHN0cnVjdCBzcGlfZGV2aWNlICpzcGksIHN0cnVjdCBtaXBpX2RiaSAq
bWlwaSwKIAkJfQogCX0KIAotCW1pcGktPnNwaSA9IHNwaTsKLQltaXBpLT5yZWFkX2NvbW1hbmRz
ID0gbWlwaV9kYmlfZGNzX3JlYWRfY29tbWFuZHM7CisJZGJpLT5zcGkgPSBzcGk7CisJZGJpLT5y
ZWFkX2NvbW1hbmRzID0gbWlwaV9kYmlfZGNzX3JlYWRfY29tbWFuZHM7CiAKIAlpZiAoZGMpIHsK
LQkJbWlwaS0+Y29tbWFuZCA9IG1pcGlfZGJpX3R5cGVjM19jb21tYW5kOwotCQltaXBpLT5kYyA9
IGRjOworCQlkYmktPmNvbW1hbmQgPSBtaXBpX2RiaV90eXBlYzNfY29tbWFuZDsKKwkJZGJpLT5k
YyA9IGRjOwogCQlpZiAobWlwaV9kYmlfbWFjaGluZV9saXR0bGVfZW5kaWFuKCkgJiYgIXNwaV9p
c19icHdfc3VwcG9ydGVkKHNwaSwgMTYpKQotCQkJbWlwaS0+c3dhcF9ieXRlcyA9IHRydWU7CisJ
CQlkYmktPnN3YXBfYnl0ZXMgPSB0cnVlOwogCX0gZWxzZSB7Ci0JCW1pcGktPmNvbW1hbmQgPSBt
aXBpX2RiaV90eXBlYzFfY29tbWFuZDsKLQkJbWlwaS0+dHhfYnVmOV9sZW4gPSBTWl8xNks7Ci0J
CW1pcGktPnR4X2J1ZjkgPSBkZXZtX2ttYWxsb2MoZGV2LCBtaXBpLT50eF9idWY5X2xlbiwgR0ZQ
X0tFUk5FTCk7Ci0JCWlmICghbWlwaS0+dHhfYnVmOSkKKwkJZGJpLT5jb21tYW5kID0gbWlwaV9k
YmlfdHlwZWMxX2NvbW1hbmQ7CisJCWRiaS0+dHhfYnVmOV9sZW4gPSBTWl8xNks7CisJCWRiaS0+
dHhfYnVmOSA9IGRldm1fa21hbGxvYyhkZXYsIGRiaS0+dHhfYnVmOV9sZW4sIEdGUF9LRVJORUwp
OworCQlpZiAoIWRiaS0+dHhfYnVmOSkKIAkJCXJldHVybiAtRU5PTUVNOwogCX0KIAotCW11dGV4
X2luaXQoJm1pcGktPmNtZGxvY2spOworCW11dGV4X2luaXQoJmRiaS0+Y21kbG9jayk7CiAKIAlE
Uk1fREVCVUdfRFJJVkVSKCJTUEkgc3BlZWQ6ICV1TUh6XG4iLCBzcGktPm1heF9zcGVlZF9oeiAv
IDEwMDAwMDApOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdGlueWRybS9zdDc1ODYu
YyBiL2RyaXZlcnMvZ3B1L2RybS90aW55ZHJtL3N0NzU4Ni5jCmluZGV4IDQwNDZiMGZjM2Y3YS4u
ODMzOWU3ZGM1ZDkyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdGlueWRybS9zdDc1ODYu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vdGlueWRybS9zdDc1ODYuYwpAQCAtMTE1LDYgKzExNSw3
IEBAIHN0YXRpYyBpbnQgc3Q3NTg2X2J1Zl9jb3B5KHZvaWQgKmRzdCwgc3RydWN0IGRybV9mcmFt
ZWJ1ZmZlciAqZmIsCiBzdGF0aWMgdm9pZCBzdDc1ODZfZmJfZGlydHkoc3RydWN0IGRybV9mcmFt
ZWJ1ZmZlciAqZmIsIHN0cnVjdCBkcm1fcmVjdCAqcmVjdCkKIHsKIAlzdHJ1Y3QgbWlwaV9kYmkg
Km1pcGkgPSBkcm1fdG9fbWlwaV9kYmkoZmItPmRldik7CisJc3RydWN0IG1pcGlfZGJpICpkYmkg
PSBtaXBpOwogCWludCBzdGFydCwgZW5kLCBpZHgsIHJldCA9IDA7CiAKIAlpZiAoIW1pcGktPmVu
YWJsZWQpCkBAIC0xMzcsMTQgKzEzOCwxNCBAQCBzdGF0aWMgdm9pZCBzdDc1ODZfZmJfZGlydHko
c3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIsIHN0cnVjdCBkcm1fcmVjdCAqcmVjdCkKIAlzdGFy
dCA9IHJlY3QtPngxIC8gMzsKIAllbmQgPSByZWN0LT54MiAvIDM7CiAKLQltaXBpX2RiaV9jb21t
YW5kKG1pcGksIE1JUElfRENTX1NFVF9DT0xVTU5fQUREUkVTUywKKwltaXBpX2RiaV9jb21tYW5k
KGRiaSwgTUlQSV9EQ1NfU0VUX0NPTFVNTl9BRERSRVNTLAogCQkJIChzdGFydCA+PiA4KSAmIDB4
RkYsIHN0YXJ0ICYgMHhGRiwKIAkJCSAoZW5kID4+IDgpICYgMHhGRiwgKGVuZCAtIDEpICYgMHhG
Rik7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBNSVBJX0RDU19TRVRfUEFHRV9BRERSRVNTLAor
CW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBNSVBJX0RDU19TRVRfUEFHRV9BRERSRVNTLAogCQkJIChy
ZWN0LT55MSA+PiA4KSAmIDB4RkYsIHJlY3QtPnkxICYgMHhGRiwKIAkJCSAocmVjdC0+eTIgPj4g
OCkgJiAweEZGLCAocmVjdC0+eTIgLSAxKSAmIDB4RkYpOwogCi0JcmV0ID0gbWlwaV9kYmlfY29t
bWFuZF9idWYobWlwaSwgTUlQSV9EQ1NfV1JJVEVfTUVNT1JZX1NUQVJULAorCXJldCA9IG1pcGlf
ZGJpX2NvbW1hbmRfYnVmKGRiaSwgTUlQSV9EQ1NfV1JJVEVfTUVNT1JZX1NUQVJULAogCQkJCSAg
ICh1OCAqKW1pcGktPnR4X2J1ZiwKIAkJCQkgICAoZW5kIC0gc3RhcnQpICogKHJlY3QtPnkyIC0g
cmVjdC0+eTEpKTsKIGVycl9tc2c6CkBAIC0xNzgsNiArMTc5LDcgQEAgc3RhdGljIHZvaWQgc3Q3
NTg2X3BpcGVfZW5hYmxlKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlwZSAqcGlwZSwKIHsK
IAlzdHJ1Y3QgbWlwaV9kYmkgKm1pcGkgPSBkcm1fdG9fbWlwaV9kYmkocGlwZS0+Y3J0Yy5kZXYp
OwogCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmZiOworCXN0cnVj
dCBtaXBpX2RiaSAqZGJpID0gbWlwaTsKIAlzdHJ1Y3QgZHJtX3JlY3QgcmVjdCA9IHsKIAkJLngx
ID0gMCwKIAkJLngyID0gZmItPndpZHRoLApAQCAtMTk2LDI5ICsxOTgsMjkgQEAgc3RhdGljIHZv
aWQgc3Q3NTg2X3BpcGVfZW5hYmxlKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlwZSAqcGlw
ZSwKIAlpZiAocmV0KQogCQlnb3RvIG91dF9leGl0OwogCi0JbWlwaV9kYmlfY29tbWFuZChtaXBp
LCBTVDc1ODZfQVVUT19SRUFEX0NUUkwsIDB4OWYpOwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwg
U1Q3NTg2X09UUF9SV19DVFJMLCAweDAwKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgU1Q3NTg2
X0FVVE9fUkVBRF9DVFJMLCAweDlmKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgU1Q3NTg2X09U
UF9SV19DVFJMLCAweDAwKTsKIAogCW1zbGVlcCgxMCk7CiAKLQltaXBpX2RiaV9jb21tYW5kKG1p
cGksIFNUNzU4Nl9PVFBfUkVBRCk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIFNUNzU4Nl9PVFBf
UkVBRCk7CiAKIAltc2xlZXAoMjApOwogCi0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBTVDc1ODZf
T1RQX0NUUkxfT1VUKTsKLQltaXBpX2RiaV9jb21tYW5kKG1pcGksIE1JUElfRENTX0VYSVRfU0xF
RVBfTU9ERSk7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBNSVBJX0RDU19TRVRfRElTUExBWV9P
RkYpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBTVDc1ODZfT1RQX0NUUkxfT1VUKTsKKwltaXBp
X2RiaV9jb21tYW5kKGRiaSwgTUlQSV9EQ1NfRVhJVF9TTEVFUF9NT0RFKTsKKwltaXBpX2RiaV9j
b21tYW5kKGRiaSwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlfT0ZGKTsKIAogCW1zbGVlcCg1MCk7CiAK
LQltaXBpX2RiaV9jb21tYW5kKG1pcGksIFNUNzU4Nl9TRVRfVk9QX09GRlNFVCwgMHgwMCk7Ci0J
bWlwaV9kYmlfY29tbWFuZChtaXBpLCBTVDc1ODZfU0VUX1ZPUCwgMHhlMywgMHgwMCk7Ci0JbWlw
aV9kYmlfY29tbWFuZChtaXBpLCBTVDc1ODZfU0VUX0JJQVNfU1lTVEVNLCAweDAyKTsKLQltaXBp
X2RiaV9jb21tYW5kKG1pcGksIFNUNzU4Nl9TRVRfQk9PU1RfTEVWRUwsIDB4MDQpOwotCW1pcGlf
ZGJpX2NvbW1hbmQobWlwaSwgU1Q3NTg2X0VOQUJMRV9BTkFMT0csIDB4MWQpOwotCW1pcGlfZGJp
X2NvbW1hbmQobWlwaSwgU1Q3NTg2X1NFVF9OTElORV9JTlYsIDB4MDApOwotCW1pcGlfZGJpX2Nv
bW1hbmQobWlwaSwgU1Q3NTg2X0RJU1BfTU9ERV9HUkFZKTsKLQltaXBpX2RiaV9jb21tYW5kKG1p
cGksIFNUNzU4Nl9FTkFCTEVfRERSQU0sIDB4MDIpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBT
VDc1ODZfU0VUX1ZPUF9PRkZTRVQsIDB4MDApOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBTVDc1
ODZfU0VUX1ZPUCwgMHhlMywgMHgwMCk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIFNUNzU4Nl9T
RVRfQklBU19TWVNURU0sIDB4MDIpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBTVDc1ODZfU0VU
X0JPT1NUX0xFVkVMLCAweDA0KTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgU1Q3NTg2X0VOQUJM
RV9BTkFMT0csIDB4MWQpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBTVDc1ODZfU0VUX05MSU5F
X0lOViwgMHgwMCk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIFNUNzU4Nl9ESVNQX01PREVfR1JB
WSk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIFNUNzU4Nl9FTkFCTEVfRERSQU0sIDB4MDIpOwog
CiAJc3dpdGNoIChtaXBpLT5yb3RhdGlvbikgewogCWRlZmF1bHQ6CkBAIC0yMzQsMTkgKzIzNiwx
OSBAQCBzdGF0aWMgdm9pZCBzdDc1ODZfcGlwZV9lbmFibGUoc3RydWN0IGRybV9zaW1wbGVfZGlz
cGxheV9waXBlICpwaXBlLAogCQlhZGRyX21vZGUgPSBTVDc1ODZfRElTUF9DVFJMX01YOwogCQli
cmVhazsKIAl9Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBNSVBJX0RDU19TRVRfQUREUkVTU19N
T0RFLCBhZGRyX21vZGUpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBNSVBJX0RDU19TRVRfQURE
UkVTU19NT0RFLCBhZGRyX21vZGUpOwogCi0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBTVDc1ODZf
U0VUX0RJU1BfRFVUWSwgMHg3Zik7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBTVDc1ODZfU0VU
X1BBUlRfRElTUCwgMHhhMCk7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBNSVBJX0RDU19TRVRf
UEFSVElBTF9BUkVBLCAweDAwLCAweDAwLCAweDAwLCAweDc3KTsKLQltaXBpX2RiaV9jb21tYW5k
KG1pcGksIE1JUElfRENTX0VYSVRfSU5WRVJUX01PREUpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJp
LCBTVDc1ODZfU0VUX0RJU1BfRFVUWSwgMHg3Zik7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIFNU
NzU4Nl9TRVRfUEFSVF9ESVNQLCAweGEwKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgTUlQSV9E
Q1NfU0VUX1BBUlRJQUxfQVJFQSwgMHgwMCwgMHgwMCwgMHgwMCwgMHg3Nyk7CisJbWlwaV9kYmlf
Y29tbWFuZChkYmksIE1JUElfRENTX0VYSVRfSU5WRVJUX01PREUpOwogCiAJbXNsZWVwKDEwMCk7
CiAKIAltaXBpLT5lbmFibGVkID0gdHJ1ZTsKIAlzdDc1ODZfZmJfZGlydHkoZmIsICZyZWN0KTsK
IAotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlfT04pOworCW1p
cGlfZGJpX2NvbW1hbmQoZGJpLCBNSVBJX0RDU19TRVRfRElTUExBWV9PTik7CiBvdXRfZXhpdDoK
IAlkcm1fZGV2X2V4aXQoaWR4KTsKIH0KQEAgLTMxOCw2ICszMjAsNyBAQCBzdGF0aWMgaW50IHN0
NzU4Nl9wcm9iZShzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpKQogCXN0cnVjdCBkZXZpY2UgKmRldiA9
ICZzcGktPmRldjsKIAlzdHJ1Y3QgZHJtX2RldmljZSAqZHJtOwogCXN0cnVjdCBtaXBpX2RiaSAq
bWlwaTsKKwlzdHJ1Y3QgbWlwaV9kYmkgKmRiaTsKIAlzdHJ1Y3QgZ3Bpb19kZXNjICphMDsKIAl1
MzIgcm90YXRpb24gPSAwOwogCXNpemVfdCBidWZzaXplOwpAQCAtMzI3LDYgKzMzMCw3IEBAIHN0
YXRpYyBpbnQgc3Q3NTg2X3Byb2JlKHN0cnVjdCBzcGlfZGV2aWNlICpzcGkpCiAJaWYgKCFtaXBp
KQogCQlyZXR1cm4gLUVOT01FTTsKIAorCWRiaSA9IG1pcGk7CiAJZHJtID0gJm1pcGktPmRybTsK
IAlyZXQgPSBkZXZtX2RybV9kZXZfaW5pdChkZXYsIGRybSwgJnN0NzU4Nl9kcml2ZXIpOwogCWlm
IChyZXQpIHsKQEAgLTMzOCwxMCArMzQyLDEwIEBAIHN0YXRpYyBpbnQgc3Q3NTg2X3Byb2JlKHN0
cnVjdCBzcGlfZGV2aWNlICpzcGkpCiAKIAlidWZzaXplID0gKHN0NzU4Nl9tb2RlLnZkaXNwbGF5
ICsgMikgLyAzICogc3Q3NTg2X21vZGUuaGRpc3BsYXk7CiAKLQltaXBpLT5yZXNldCA9IGRldm1f
Z3Bpb2RfZ2V0KGRldiwgInJlc2V0IiwgR1BJT0RfT1VUX0hJR0gpOwotCWlmIChJU19FUlIobWlw
aS0+cmVzZXQpKSB7CisJZGJpLT5yZXNldCA9IGRldm1fZ3Bpb2RfZ2V0KGRldiwgInJlc2V0Iiwg
R1BJT0RfT1VUX0hJR0gpOworCWlmIChJU19FUlIoZGJpLT5yZXNldCkpIHsKIAkJRFJNX0RFVl9F
UlJPUihkZXYsICJGYWlsZWQgdG8gZ2V0IGdwaW8gJ3Jlc2V0J1xuIik7Ci0JCXJldHVybiBQVFJf
RVJSKG1pcGktPnJlc2V0KTsKKwkJcmV0dXJuIFBUUl9FUlIoZGJpLT5yZXNldCk7CiAJfQogCiAJ
YTAgPSBkZXZtX2dwaW9kX2dldChkZXYsICJhMCIsIEdQSU9EX09VVF9MT1cpOwpAQCAtMzUyLDEy
ICszNTYsMTIgQEAgc3RhdGljIGludCBzdDc1ODZfcHJvYmUoc3RydWN0IHNwaV9kZXZpY2UgKnNw
aSkKIAogCWRldmljZV9wcm9wZXJ0eV9yZWFkX3UzMihkZXYsICJyb3RhdGlvbiIsICZyb3RhdGlv
bik7CiAKLQlyZXQgPSBtaXBpX2RiaV9zcGlfaW5pdChzcGksIG1pcGksIGEwKTsKKwlyZXQgPSBt
aXBpX2RiaV9zcGlfaW5pdChzcGksIGRiaSwgYTApOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7
CiAKIAkvKiBDYW5ub3QgcmVhZCBmcm9tIHRoaXMgY29udHJvbGxlciB2aWEgU1BJICovCi0JbWlw
aS0+cmVhZF9jb21tYW5kcyA9IE5VTEw7CisJZGJpLT5yZWFkX2NvbW1hbmRzID0gTlVMTDsKIAog
CXJldCA9IG1pcGlfZGJpX2luaXRfd2l0aF9mb3JtYXRzKG1pcGksICZzdDc1ODZfcGlwZV9mdW5j
cywKIAkJCQkJIHN0NzU4Nl9mb3JtYXRzLCBBUlJBWV9TSVpFKHN0NzU4Nl9mb3JtYXRzKSwKQEAg
LTM3Miw3ICszNzYsNyBAQCBzdGF0aWMgaW50IHN0NzU4Nl9wcm9iZShzdHJ1Y3Qgc3BpX2Rldmlj
ZSAqc3BpKQogCSAqIGJ5dGVzIG9uIGxpdHRsZS1lbmRpYW4gc3lzdGVtcyBhbmQgY2F1c2VzIG91
dCBvZiBvcmRlciBkYXRhIHRvIGJlCiAJICogc2VudCB0byB0aGUgZGlzcGxheSkuCiAJICovCi0J
bWlwaS0+c3dhcF9ieXRlcyA9IHRydWU7CisJZGJpLT5zd2FwX2J5dGVzID0gdHJ1ZTsKIAogCWRy
bV9tb2RlX2NvbmZpZ19yZXNldChkcm0pOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
dGlueWRybS9zdDc3MzVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vdGlueWRybS9zdDc3MzVyLmMKaW5k
ZXggMTUxNzQ5MDM1YTE5Li40MzA5YWUyOTk3NjYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS90aW55ZHJtL3N0NzczNXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdGlueWRybS9zdDc3MzVy
LmMKQEAgLTQzLDYgKzQzLDcgQEAgc3RhdGljIHZvaWQgamRfdDE4MDAzX3QwMV9waXBlX2VuYWJs
ZShzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCiAJCQkJICAgICAgc3RydWN0
IGRybV9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCiB7CiAJc3RydWN0IG1pcGlfZGJpICptaXBp
ID0gZHJtX3RvX21pcGlfZGJpKHBpcGUtPmNydGMuZGV2KTsKKwlzdHJ1Y3QgbWlwaV9kYmkgKmRi
aSA9IG1pcGk7CiAJaW50IHJldCwgaWR4OwogCXU4IGFkZHJfbW9kZTsKIApAQCAtNTcsMjEgKzU4
LDIxIEBAIHN0YXRpYyB2b2lkIGpkX3QxODAwM190MDFfcGlwZV9lbmFibGUoc3RydWN0IGRybV9z
aW1wbGVfZGlzcGxheV9waXBlICpwaXBlLAogCiAJbXNsZWVwKDE1MCk7CiAKLQltaXBpX2RiaV9j
b21tYW5kKG1pcGksIE1JUElfRENTX0VYSVRfU0xFRVBfTU9ERSk7CisJbWlwaV9kYmlfY29tbWFu
ZChkYmksIE1JUElfRENTX0VYSVRfU0xFRVBfTU9ERSk7CiAJbXNsZWVwKDUwMCk7CiAKLQltaXBp
X2RiaV9jb21tYW5kKG1pcGksIFNUNzczNVJfRlJNQ1RSMSwgMHgwMSwgMHgyYywgMHgyZCk7Ci0J
bWlwaV9kYmlfY29tbWFuZChtaXBpLCBTVDc3MzVSX0ZSTUNUUjIsIDB4MDEsIDB4MmMsIDB4MmQp
OwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgU1Q3NzM1Ul9GUk1DVFIzLCAweDAxLCAweDJjLCAw
eDJkLCAweDAxLCAweDJjLAorCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBTVDc3MzVSX0ZSTUNUUjEs
IDB4MDEsIDB4MmMsIDB4MmQpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBTVDc3MzVSX0ZSTUNU
UjIsIDB4MDEsIDB4MmMsIDB4MmQpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBTVDc3MzVSX0ZS
TUNUUjMsIDB4MDEsIDB4MmMsIDB4MmQsIDB4MDEsIDB4MmMsCiAJCQkgMHgyZCk7Ci0JbWlwaV9k
YmlfY29tbWFuZChtaXBpLCBTVDc3MzVSX0lOVkNUUiwgMHgwNyk7Ci0JbWlwaV9kYmlfY29tbWFu
ZChtaXBpLCBTVDc3MzVSX1BXQ1RSMSwgMHhhMiwgMHgwMiwgMHg4NCk7Ci0JbWlwaV9kYmlfY29t
bWFuZChtaXBpLCBTVDc3MzVSX1BXQ1RSMiwgMHhjNSk7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBp
LCBTVDc3MzVSX1BXQ1RSMywgMHgwYSwgMHgwMCk7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBT
VDc3MzVSX1BXQ1RSNCwgMHg4YSwgMHgyYSk7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBTVDc3
MzVSX1BXQ1RSNSwgMHg4YSwgMHhlZSk7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBTVDc3MzVS
X1ZNQ1RSMSwgMHgwZSk7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBNSVBJX0RDU19FWElUX0lO
VkVSVF9NT0RFKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgU1Q3NzM1Ul9JTlZDVFIsIDB4MDcp
OworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBTVDc3MzVSX1BXQ1RSMSwgMHhhMiwgMHgwMiwgMHg4
NCk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIFNUNzczNVJfUFdDVFIyLCAweGM1KTsKKwltaXBp
X2RiaV9jb21tYW5kKGRiaSwgU1Q3NzM1Ul9QV0NUUjMsIDB4MGEsIDB4MDApOworCW1pcGlfZGJp
X2NvbW1hbmQoZGJpLCBTVDc3MzVSX1BXQ1RSNCwgMHg4YSwgMHgyYSk7CisJbWlwaV9kYmlfY29t
bWFuZChkYmksIFNUNzczNVJfUFdDVFI1LCAweDhhLCAweGVlKTsKKwltaXBpX2RiaV9jb21tYW5k
KGRiaSwgU1Q3NzM1Ul9WTUNUUjEsIDB4MGUpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBNSVBJ
X0RDU19FWElUX0lOVkVSVF9NT0RFKTsKIAlzd2l0Y2ggKG1pcGktPnJvdGF0aW9uKSB7CiAJZGVm
YXVsdDoKIAkJYWRkcl9tb2RlID0gU1Q3NzM1Ul9NWCB8IFNUNzczNVJfTVk7CkBAIC04NiwyMCAr
ODcsMjAgQEAgc3RhdGljIHZvaWQgamRfdDE4MDAzX3QwMV9waXBlX2VuYWJsZShzdHJ1Y3QgZHJt
X3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCiAJCWFkZHJfbW9kZSA9IFNUNzczNVJfTVkgfCBT
VDc3MzVSX01WOwogCQlicmVhazsKIAl9Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBNSVBJX0RD
U19TRVRfQUREUkVTU19NT0RFLCBhZGRyX21vZGUpOwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwg
TUlQSV9EQ1NfU0VUX1BJWEVMX0ZPUk1BVCwKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgTUlQSV9E
Q1NfU0VUX0FERFJFU1NfTU9ERSwgYWRkcl9tb2RlKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwg
TUlQSV9EQ1NfU0VUX1BJWEVMX0ZPUk1BVCwKIAkJCSBNSVBJX0RDU19QSVhFTF9GTVRfMTZCSVQp
OwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgU1Q3NzM1Ul9HQU1DVFJQMSwgMHgwMiwgMHgxYywg
MHgwNywgMHgxMiwgMHgzNywKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgU1Q3NzM1Ul9HQU1DVFJQ
MSwgMHgwMiwgMHgxYywgMHgwNywgMHgxMiwgMHgzNywKIAkJCSAweDMyLCAweDI5LCAweDJkLCAw
eDI5LCAweDI1LCAweDJiLCAweDM5LCAweDAwLCAweDAxLAogCQkJIDB4MDMsIDB4MTApOwotCW1p
cGlfZGJpX2NvbW1hbmQobWlwaSwgU1Q3NzM1Ul9HQU1DVFJOMSwgMHgwMywgMHgxZCwgMHgwNywg
MHgwNiwgMHgyZSwKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgU1Q3NzM1Ul9HQU1DVFJOMSwgMHgw
MywgMHgxZCwgMHgwNywgMHgwNiwgMHgyZSwKIAkJCSAweDJjLCAweDI5LCAweDJkLCAweDJlLCAw
eDJlLCAweDM3LCAweDNmLCAweDAwLCAweDAwLAogCQkJIDB4MDIsIDB4MTApOwotCW1pcGlfZGJp
X2NvbW1hbmQobWlwaSwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlfT04pOworCW1pcGlfZGJpX2NvbW1h
bmQoZGJpLCBNSVBJX0RDU19TRVRfRElTUExBWV9PTik7CiAKIAltc2xlZXAoMTAwKTsKIAotCW1p
cGlfZGJpX2NvbW1hbmQobWlwaSwgTUlQSV9EQ1NfRU5URVJfTk9STUFMX01PREUpOworCW1pcGlf
ZGJpX2NvbW1hbmQoZGJpLCBNSVBJX0RDU19FTlRFUl9OT1JNQUxfTU9ERSk7CiAKIAltc2xlZXAo
MjApOwogCkBAIC0xNTEsNiArMTUyLDcgQEAgc3RhdGljIGludCBzdDc3MzVyX3Byb2JlKHN0cnVj
dCBzcGlfZGV2aWNlICpzcGkpCiAJc3RydWN0IGRldmljZSAqZGV2ID0gJnNwaS0+ZGV2OwogCXN0
cnVjdCBkcm1fZGV2aWNlICpkcm07CiAJc3RydWN0IG1pcGlfZGJpICptaXBpOworCXN0cnVjdCBt
aXBpX2RiaSAqZGJpOwogCXN0cnVjdCBncGlvX2Rlc2MgKmRjOwogCXUzMiByb3RhdGlvbiA9IDA7
CiAJaW50IHJldDsKQEAgLTE1OSw2ICsxNjEsNyBAQCBzdGF0aWMgaW50IHN0NzczNXJfcHJvYmUo
c3RydWN0IHNwaV9kZXZpY2UgKnNwaSkKIAlpZiAoIW1pcGkpCiAJCXJldHVybiAtRU5PTUVNOwog
CisJZGJpID0gbWlwaTsKIAlkcm0gPSAmbWlwaS0+ZHJtOwogCXJldCA9IGRldm1fZHJtX2Rldl9p
bml0KGRldiwgZHJtLCAmc3Q3NzM1cl9kcml2ZXIpOwogCWlmIChyZXQpIHsKQEAgLTE2OCwxMCAr
MTcxLDEwIEBAIHN0YXRpYyBpbnQgc3Q3NzM1cl9wcm9iZShzdHJ1Y3Qgc3BpX2RldmljZSAqc3Bp
KQogCiAJZHJtX21vZGVfY29uZmlnX2luaXQoZHJtKTsKIAotCW1pcGktPnJlc2V0ID0gZGV2bV9n
cGlvZF9nZXQoZGV2LCAicmVzZXQiLCBHUElPRF9PVVRfSElHSCk7Ci0JaWYgKElTX0VSUihtaXBp
LT5yZXNldCkpIHsKKwlkYmktPnJlc2V0ID0gZGV2bV9ncGlvZF9nZXQoZGV2LCAicmVzZXQiLCBH
UElPRF9PVVRfSElHSCk7CisJaWYgKElTX0VSUihkYmktPnJlc2V0KSkgewogCQlEUk1fREVWX0VS
Uk9SKGRldiwgIkZhaWxlZCB0byBnZXQgZ3BpbyAncmVzZXQnXG4iKTsKLQkJcmV0dXJuIFBUUl9F
UlIobWlwaS0+cmVzZXQpOworCQlyZXR1cm4gUFRSX0VSUihkYmktPnJlc2V0KTsKIAl9CiAKIAlk
YyA9IGRldm1fZ3Bpb2RfZ2V0KGRldiwgImRjIiwgR1BJT0RfT1VUX0xPVyk7CkBAIC0xODYsMTIg
KzE4OSwxMiBAQCBzdGF0aWMgaW50IHN0NzczNXJfcHJvYmUoc3RydWN0IHNwaV9kZXZpY2UgKnNw
aSkKIAogCWRldmljZV9wcm9wZXJ0eV9yZWFkX3UzMihkZXYsICJyb3RhdGlvbiIsICZyb3RhdGlv
bik7CiAKLQlyZXQgPSBtaXBpX2RiaV9zcGlfaW5pdChzcGksIG1pcGksIGRjKTsKKwlyZXQgPSBt
aXBpX2RiaV9zcGlfaW5pdChzcGksIGRiaSwgZGMpOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7
CiAKIAkvKiBDYW5ub3QgcmVhZCBmcm9tIEFkYWZydWl0IDEuOCIgZGlzcGxheSB2aWEgU1BJICov
Ci0JbWlwaS0+cmVhZF9jb21tYW5kcyA9IE5VTEw7CisJZGJpLT5yZWFkX2NvbW1hbmRzID0gTlVM
TDsKIAogCXJldCA9IG1pcGlfZGJpX2luaXQobWlwaSwgJmpkX3QxODAwM190MDFfcGlwZV9mdW5j
cywgJmpkX3QxODAwM190MDFfbW9kZSwgcm90YXRpb24pOwogCWlmIChyZXQpCmRpZmYgLS1naXQg
YS9pbmNsdWRlL2RybS90aW55ZHJtL21pcGktZGJpLmggYi9pbmNsdWRlL2RybS90aW55ZHJtL21p
cGktZGJpLmgKaW5kZXggMzkzMzIzZjg3ZTEyLi4wNGI1NGVjNjFiYzIgMTAwNjQ0Ci0tLSBhL2lu
Y2x1ZGUvZHJtL3Rpbnlkcm0vbWlwaS1kYmkuaAorKysgYi9pbmNsdWRlL2RybS90aW55ZHJtL21p
cGktZGJpLmgKQEAgLTU5LDcgKzU5LDcgQEAgc3RydWN0IG1pcGlfZGJpIHsKIAlzdHJ1Y3Qgc3Bp
X2RldmljZSAqc3BpOwogCWJvb2wgZW5hYmxlZDsKIAlzdHJ1Y3QgbXV0ZXggY21kbG9jazsKLQlp
bnQgKCpjb21tYW5kKShzdHJ1Y3QgbWlwaV9kYmkgKm1pcGksIHU4ICpjbWQsIHU4ICpwYXJhbSwg
c2l6ZV90IG51bSk7CisJaW50ICgqY29tbWFuZCkoc3RydWN0IG1pcGlfZGJpICpkYmksIHU4ICpj
bWQsIHU4ICpwYXJhbSwgc2l6ZV90IG51bSk7CiAJY29uc3QgdTggKnJlYWRfY29tbWFuZHM7CiAJ
c3RydWN0IGdwaW9fZGVzYyAqZGM7CiAJdTE2ICp0eF9idWY7CkBAIC03Nyw3ICs3Nyw3IEBAIHN0
YXRpYyBpbmxpbmUgc3RydWN0IG1pcGlfZGJpICpkcm1fdG9fbWlwaV9kYmkoc3RydWN0IGRybV9k
ZXZpY2UgKmRybSkKIAlyZXR1cm4gY29udGFpbmVyX29mKGRybSwgc3RydWN0IG1pcGlfZGJpLCBk
cm0pOwogfQogCi1pbnQgbWlwaV9kYmlfc3BpX2luaXQoc3RydWN0IHNwaV9kZXZpY2UgKnNwaSwg
c3RydWN0IG1pcGlfZGJpICptaXBpLAoraW50IG1pcGlfZGJpX3NwaV9pbml0KHN0cnVjdCBzcGlf
ZGV2aWNlICpzcGksIHN0cnVjdCBtaXBpX2RiaSAqZGJpLAogCQkgICAgICBzdHJ1Y3QgZ3Bpb19k
ZXNjICpkYyk7CiBpbnQgbWlwaV9kYmlfaW5pdF93aXRoX2Zvcm1hdHMoc3RydWN0IG1pcGlfZGJp
ICptaXBpLAogCQkJICAgICAgIGNvbnN0IHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlwZV9m
dW5jcyAqZnVuY3MsCkBAIC05NCw4ICs5NCw4IEBAIHZvaWQgbWlwaV9kYmlfZW5hYmxlX2ZsdXNo
KHN0cnVjdCBtaXBpX2RiaSAqbWlwaSwKIAkJCSAgIHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSwKIAkJCSAgIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnBsYW5fc3RhdGUpOwogdm9p
ZCBtaXBpX2RiaV9waXBlX2Rpc2FibGUoc3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpw
aXBlKTsKLXZvaWQgbWlwaV9kYmlfaHdfcmVzZXQoc3RydWN0IG1pcGlfZGJpICptaXBpKTsKLWJv
b2wgbWlwaV9kYmlfZGlzcGxheV9pc19vbihzdHJ1Y3QgbWlwaV9kYmkgKm1pcGkpOwordm9pZCBt
aXBpX2RiaV9od19yZXNldChzdHJ1Y3QgbWlwaV9kYmkgKmRiaSk7Citib29sIG1pcGlfZGJpX2Rp
c3BsYXlfaXNfb24oc3RydWN0IG1pcGlfZGJpICpkYmkpOwogaW50IG1pcGlfZGJpX3Bvd2Vyb25f
cmVzZXQoc3RydWN0IG1pcGlfZGJpICptaXBpKTsKIGludCBtaXBpX2RiaV9wb3dlcm9uX2NvbmRp
dGlvbmFsX3Jlc2V0KHN0cnVjdCBtaXBpX2RiaSAqbWlwaSk7CiAKQEAgLTEwMywxNCArMTAzLDE0
IEBAIHUzMiBtaXBpX2RiaV9zcGlfY21kX21heF9zcGVlZChzdHJ1Y3Qgc3BpX2RldmljZSAqc3Bp
LCBzaXplX3QgbGVuKTsKIGludCBtaXBpX2RiaV9zcGlfdHJhbnNmZXIoc3RydWN0IHNwaV9kZXZp
Y2UgKnNwaSwgdTMyIHNwZWVkX2h6LAogCQkJICB1OCBicHcsIGNvbnN0IHZvaWQgKmJ1Ziwgc2l6
ZV90IGxlbik7CiAKLWludCBtaXBpX2RiaV9jb21tYW5kX3JlYWQoc3RydWN0IG1pcGlfZGJpICpt
aXBpLCB1OCBjbWQsIHU4ICp2YWwpOwotaW50IG1pcGlfZGJpX2NvbW1hbmRfYnVmKHN0cnVjdCBt
aXBpX2RiaSAqbWlwaSwgdTggY21kLCB1OCAqZGF0YSwgc2l6ZV90IGxlbik7Ci1pbnQgbWlwaV9k
YmlfY29tbWFuZF9zdGFja2J1ZihzdHJ1Y3QgbWlwaV9kYmkgKm1pcGksIHU4IGNtZCwgdTggKmRh
dGEsIHNpemVfdCBsZW4pOworaW50IG1pcGlfZGJpX2NvbW1hbmRfcmVhZChzdHJ1Y3QgbWlwaV9k
YmkgKmRiaSwgdTggY21kLCB1OCAqdmFsKTsKK2ludCBtaXBpX2RiaV9jb21tYW5kX2J1ZihzdHJ1
Y3QgbWlwaV9kYmkgKmRiaSwgdTggY21kLCB1OCAqZGF0YSwgc2l6ZV90IGxlbik7CitpbnQgbWlw
aV9kYmlfY29tbWFuZF9zdGFja2J1ZihzdHJ1Y3QgbWlwaV9kYmkgKmRiaSwgdTggY21kLCB1OCAq
ZGF0YSwgc2l6ZV90IGxlbik7CiBpbnQgbWlwaV9kYmlfYnVmX2NvcHkodm9pZCAqZHN0LCBzdHJ1
Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwKIAkJICAgICAgc3RydWN0IGRybV9yZWN0ICpjbGlwLCBi
b29sIHN3YXApOwogLyoqCiAgKiBtaXBpX2RiaV9jb21tYW5kIC0gTUlQSSBEQ1MgY29tbWFuZCB3
aXRoIG9wdGlvbmFsIHBhcmFtZXRlcihzKQotICogQG1pcGk6IE1JUEkgc3RydWN0dXJlCisgKiBA
ZGJpOiBNSVBJIERCSSBzdHJ1Y3R1cmUKICAqIEBjbWQ6IENvbW1hbmQKICAqIEBzZXEuLi46IE9w
dGlvbmFsIHBhcmFtZXRlcihzKQogICoKQEAgLTEyMCwxMCArMTIwLDEwIEBAIGludCBtaXBpX2Ri
aV9idWZfY29weSh2b2lkICpkc3QsIHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLAogICogUmV0
dXJuczoKICAqIFplcm8gb24gc3VjY2VzcywgbmVnYXRpdmUgZXJyb3IgY29kZSBvbiBmYWlsdXJl
LgogICovCi0jZGVmaW5lIG1pcGlfZGJpX2NvbW1hbmQobWlwaSwgY21kLCBzZXEuLi4pIFwKKyNk
ZWZpbmUgbWlwaV9kYmlfY29tbWFuZChkYmksIGNtZCwgc2VxLi4uKSBcCiAoeyBcCiAJdTggZFtd
ID0geyBzZXEgfTsgXAotCW1pcGlfZGJpX2NvbW1hbmRfc3RhY2tidWYobWlwaSwgY21kLCBkLCBB
UlJBWV9TSVpFKGQpKTsgXAorCW1pcGlfZGJpX2NvbW1hbmRfc3RhY2tidWYoZGJpLCBjbWQsIGQs
IEFSUkFZX1NJWkUoZCkpOyBcCiB9KQogCiAjaWZkZWYgQ09ORklHX0RFQlVHX0ZTCi0tIAoyLjIw
LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1k
ZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczov
L2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
