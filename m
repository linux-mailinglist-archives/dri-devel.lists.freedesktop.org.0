Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 990E146AC1
	for <lists+dri-devel@lfdr.de>; Fri, 14 Jun 2019 22:39:04 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 86505897EE;
	Fri, 14 Jun 2019 20:37:22 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x542.google.com (mail-ed1-x542.google.com
 [IPv6:2a00:1450:4864:20::542])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B199489791
 for <dri-devel@lists.freedesktop.org>; Fri, 14 Jun 2019 20:37:14 +0000 (UTC)
Received: by mail-ed1-x542.google.com with SMTP id k8so5229236eds.7
 for <dri-devel@lists.freedesktop.org>; Fri, 14 Jun 2019 13:37:14 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=i7b4aMzWB/WvLzJyM0068ZKDt/gpd+E2Uf4LQesfRzU=;
 b=aSxZsxhawaMdFrISMxTDmMoziiKilsXt1JXQr+D+DGFv/h02QInShf7TagW2+soFFK
 05zdn7eKZZ5f0oTuZSaYJIssAAWXJTX1xm126+I7NSYmB7tnf4zCLphBNCtKCJrcVdRU
 KXMvbYWuo81rmWDwcCc48WiXAd2tWjDoZimeT/3DFIiU5JXZHgm4cxKyyC96wTw9rg0m
 bbqp7Mz61vFAxtj0lOQ9FmyatzquKD87ORY3AKCnjEpIUHUAmtrsy6eIv0/PgcyapoJW
 Eh4nQAw2MLyHiC4wvSa0MhN5TpXt8TmxGM1C0zop7IFK01XozFv+ah4hTDl+z4fhbNzs
 cvKg==
X-Gm-Message-State: APjAAAUDayjaa/ymKh/VUUx3Cmnf7pYF4QBsQAxgrxd5idkIGRxs2kEP
 ABUEwQdrO3YWhVPheOvH0M4sP8PV2/0=
X-Google-Smtp-Source: APXvYqySRtB5ypeTVjemu40jrdWCCaj2w1io7c4tI6zuzHrCcLQMW4wp/TXRntYVXffkcA5jyRKbAw==
X-Received: by 2002:a50:e619:: with SMTP id y25mr20408830edm.247.1560544632521; 
 Fri, 14 Jun 2019 13:37:12 -0700 (PDT)
Received: from phenom.ffwll.local ([2a02:168:569e:0:3106:d637:d723:e855])
 by smtp.gmail.com with ESMTPSA id n15sm1166672edd.49.2019.06.14.13.37.11
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Fri, 14 Jun 2019 13:37:11 -0700 (PDT)
From: Daniel Vetter <daniel.vetter@ffwll.ch>
To: DRI Development <dri-devel@lists.freedesktop.org>
Subject: [PATCH 44/59] drm/mediatek: Use drm_atomic_helper_wait_for_fences
Date: Fri, 14 Jun 2019 22:36:00 +0200
Message-Id: <20190614203615.12639-45-daniel.vetter@ffwll.ch>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190614203615.12639-1-daniel.vetter@ffwll.ch>
References: <20190614203615.12639-1-daniel.vetter@ffwll.ch>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ffwll.ch; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=i7b4aMzWB/WvLzJyM0068ZKDt/gpd+E2Uf4LQesfRzU=;
 b=dhOuzubKjdkfVoKkTkm4N8ahWcM2rt9CH14I1ODo7taD5BPCyYx9bAaW/IT/qORDBW
 hr6eYBnUIPye8r8viclR8ATjtqBJ5ZS8tehHQJjKJnkMG8gmCTLNuFZefjCZVjUBB8j3
 a7GBO1OmXKoRFszfKKq7zXvp0D7e+fPIFYppw=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Daniel Vetter <daniel.vetter@ffwll.ch>,
 Intel Graphics Development <intel-gfx@lists.freedesktop.org>,
 Matthias Brugger <matthias.bgg@gmail.com>, linux-mediatek@lists.infradead.org,
 Daniel Vetter <daniel.vetter@intel.com>, linux-arm-kernel@lists.infradead.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SWYgd2UgdXNlIHRoZSBnZW0gZmIgaGVscGVyIGFzIHRoZSBwcmVwYXJlX2ZiIGhvb2ssIHBsdXMg
dGhlCmRybV9wcmltZS5jIGltcG9ydCBoZWxwZXJzIG5vdyBhdXRvbWF0aWNhbGx5IHNldHRpbmcg
b2JqLT5yZXN2LCB3ZSBjYW4KdXNlIHRoZSBzaGFyZWQgaGVscGVycyB0byB3YWl0IGZvciBmZW5j
ZXMgaW5zdGVhZCBvZiByb2xsaW5nIG91ciBvd24uCk5vdGUgdGhhdCB0aGlzIHJlbGllcyBvbiBt
dGsgc2V0dGluZyBkcm1fZmItPm9iaiwgd2hpY2ggaXMgYWxyZWFkeQpkb25lIGluIG10a19kcm1f
ZnJhbWVidWZmZXJfaW5pdCgpLgoKQXNpZGU6IFByb2JhYmx5IGNhbiB1c2UgdGhlIGRlZmF1bHQg
Y29tbWl0X3RhaWwgd2l0aCB0aGlzIGFnYWluLCBidXQgSQpkaWRuJ3QgY2hlY2sgZm9yIHRoYXQu
CgpTaWduZWQtb2ZmLWJ5OiBEYW5pZWwgVmV0dGVyIDxkYW5pZWwudmV0dGVyQGludGVsLmNvbT4K
Q2M6IENLIEh1IDxjay5odUBtZWRpYXRlay5jb20+CkNjOiBQaGlsaXBwIFphYmVsIDxwLnphYmVs
QHBlbmd1dHJvbml4LmRlPgpDYzogTWF0dGhpYXMgQnJ1Z2dlciA8bWF0dGhpYXMuYmdnQGdtYWls
LmNvbT4KQ2M6IGxpbnV4LWFybS1rZXJuZWxAbGlzdHMuaW5mcmFkZWFkLm9yZwpDYzogbGludXgt
bWVkaWF0ZWtAbGlzdHMuaW5mcmFkZWFkLm9yZwotLS0KIGRyaXZlcnMvZ3B1L2RybS9tZWRpYXRl
ay9tdGtfZHJtX2Rydi5jICAgfCAxMiArLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vbWVkaWF0
ZWsvbXRrX2RybV9mYi5jICAgIHwgMjggLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJz
L2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9mYi5oICAgIHwgIDEgLQogZHJpdmVycy9ncHUvZHJt
L21lZGlhdGVrL210a19kcm1fcGxhbmUuYyB8ICAyICsrCiA0IGZpbGVzIGNoYW5nZWQsIDMgaW5z
ZXJ0aW9ucygrKSwgNDAgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L21lZGlhdGVrL210a19kcm1fZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2Ry
bV9kcnYuYwppbmRleCBkZDhkYWI1NjI1MDAuLjJkNWNhZjUzMjQzMSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fZHJ2LmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L21lZGlhdGVrL210a19kcm1fZHJ2LmMKQEAgLTM4LDIyICszOCwxMiBAQCBzdGF0aWMgdm9pZCBt
dGtfYXRvbWljX3NjaGVkdWxlKHN0cnVjdCBtdGtfZHJtX3ByaXZhdGUgKnByaXZhdGUsCiAJc2No
ZWR1bGVfd29yaygmcHJpdmF0ZS0+Y29tbWl0LndvcmspOwogfQogCi1zdGF0aWMgdm9pZCBtdGtf
YXRvbWljX3dhaXRfZm9yX2ZlbmNlcyhzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpCi17
Ci0Jc3RydWN0IGRybV9wbGFuZSAqcGxhbmU7Ci0Jc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqbmV3
X3BsYW5lX3N0YXRlOwotCWludCBpOwotCi0JZm9yX2VhY2hfbmV3X3BsYW5lX2luX3N0YXRlKHN0
YXRlLCBwbGFuZSwgbmV3X3BsYW5lX3N0YXRlLCBpKQotCQltdGtfZmJfd2FpdChuZXdfcGxhbmVf
c3RhdGUtPmZiKTsKLX0KLQogc3RhdGljIHZvaWQgbXRrX2F0b21pY19jb21wbGV0ZShzdHJ1Y3Qg
bXRrX2RybV9wcml2YXRlICpwcml2YXRlLAogCQkJCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpz
dGF0ZSkKIHsKIAlzdHJ1Y3QgZHJtX2RldmljZSAqZHJtID0gcHJpdmF0ZS0+ZHJtOwogCi0JbXRr
X2F0b21pY193YWl0X2Zvcl9mZW5jZXMoc3RhdGUpOworCWRybV9hdG9taWNfaGVscGVyX3dhaXRf
Zm9yX2ZlbmNlcyhkcm0sIHN0YXRlLCBmYWxzZSk7CiAKIAkvKgogCSAqIE1lZGlhdGVrIGRybSBz
dXBwb3J0cyBydW50aW1lIFBNLCBzbyBwbGFuZSByZWdpc3RlcnMgY2Fubm90IGJlCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9mYi5jIGIvZHJpdmVycy9ncHUv
ZHJtL21lZGlhdGVrL210a19kcm1fZmIuYwppbmRleCA0YzNhZDdkZTJkM2IuLjM5NmJhNDk3OTg2
ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fZmIuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9mYi5jCkBAIC00OSwzNCArNDksNiBA
QCBzdGF0aWMgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqbXRrX2RybV9mcmFtZWJ1ZmZlcl9pbml0
KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJcmV0dXJuIGZiOwogfQogCi0vKgotICogV2FpdCBm
b3IgYW55IGV4Y2x1c2l2ZSBmZW5jZSBpbiBmYidzIGdlbSBvYmplY3QncyByZXNlcnZhdGlvbiBv
YmplY3QuCi0gKgotICogUmV0dXJucyAtRVJFU1RBUlRTWVMgaWYgaW50ZXJydXB0ZWQsIGVsc2Ug
MC4KLSAqLwotaW50IG10a19mYl93YWl0KHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiKQotewot
CXN0cnVjdCBkcm1fZ2VtX29iamVjdCAqZ2VtOwotCXN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3Qg
KnJlc3Y7Ci0JbG9uZyByZXQ7Ci0KLQlpZiAoIWZiKQotCQlyZXR1cm4gMDsKLQotCWdlbSA9IGZi
LT5vYmpbMF07Ci0JaWYgKCFnZW0gfHwgIWdlbS0+ZG1hX2J1ZiB8fCAhZ2VtLT5kbWFfYnVmLT5y
ZXN2KQotCQlyZXR1cm4gMDsKLQotCXJlc3YgPSBnZW0tPmRtYV9idWYtPnJlc3Y7Ci0JcmV0ID0g
cmVzZXJ2YXRpb25fb2JqZWN0X3dhaXRfdGltZW91dF9yY3UocmVzdiwgZmFsc2UsIHRydWUsCi0J
CQkJCQkgIE1BWF9TQ0hFRFVMRV9USU1FT1VUKTsKLQkvKiBNQVhfU0NIRURVTEVfVElNRU9VVCBv
biBzdWNjZXNzLCAtRVJFU1RBUlRTWVMgaWYgaW50ZXJydXB0ZWQgKi8KLQlpZiAoV0FSTl9PTihy
ZXQgPCAwKSkKLQkJcmV0dXJuIHJldDsKLQotCXJldHVybiAwOwotfQotCiBzdHJ1Y3QgZHJtX2Zy
YW1lYnVmZmVyICptdGtfZHJtX21vZGVfZmJfY3JlYXRlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYs
CiAJCQkJCSAgICAgICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUsCiAJCQkJCSAgICAgICBjb25zdCBz
dHJ1Y3QgZHJtX21vZGVfZmJfY21kMiAqY21kKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L21lZGlhdGVrL210a19kcm1fZmIuaCBiL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJt
X2ZiLmgKaW5kZXggNmI4MGMyOGUzM2NmLi5lYjY0ZDI2MDAxYzYgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2ZiLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL21l
ZGlhdGVrL210a19kcm1fZmIuaApAQCAtNiw3ICs2LDYgQEAKICNpZm5kZWYgTVRLX0RSTV9GQl9I
CiAjZGVmaW5lIE1US19EUk1fRkJfSAogCi1pbnQgbXRrX2ZiX3dhaXQoc3RydWN0IGRybV9mcmFt
ZWJ1ZmZlciAqZmIpOwogc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqbXRrX2RybV9tb2RlX2ZiX2Ny
ZWF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogCQkJCQkgICAgICAgc3RydWN0IGRybV9maWxl
ICpmaWxlLAogCQkJCQkgICAgICAgY29uc3Qgc3RydWN0IGRybV9tb2RlX2ZiX2NtZDIgKmNtZCk7
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9wbGFuZS5jIGIv
ZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fcGxhbmUuYwppbmRleCBmMmVmODNhZWQ2
ZjkuLjQyY2M5ODIzZWFhYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210
a19kcm1fcGxhbmUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9wbGFu
ZS5jCkBAIC04LDYgKzgsNyBAQAogI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljLmg+CiAjaW5jbHVk
ZSA8ZHJtL2RybV9hdG9taWNfaGVscGVyLmg+CiAjaW5jbHVkZSA8ZHJtL2RybV9wbGFuZV9oZWxw
ZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2dlbV9mcmFtZWJ1ZmZlcl9oZWxwZXIuaD4KIAogI2lu
Y2x1ZGUgIm10a19kcm1fY3J0Yy5oIgogI2luY2x1ZGUgIm10a19kcm1fZGRwX2NvbXAuaCIKQEAg
LTE0Niw2ICsxNDcsNyBAQCBzdGF0aWMgdm9pZCBtdGtfcGxhbmVfYXRvbWljX2Rpc2FibGUoc3Ry
dWN0IGRybV9wbGFuZSAqcGxhbmUsCiB9CiAKIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX3BsYW5l
X2hlbHBlcl9mdW5jcyBtdGtfcGxhbmVfaGVscGVyX2Z1bmNzID0geworCS5wcmVwYXJlX2ZiID0g
ZHJtX2dlbV9mYl9wcmVwYXJlX2ZiLAogCS5hdG9taWNfY2hlY2sgPSBtdGtfcGxhbmVfYXRvbWlj
X2NoZWNrLAogCS5hdG9taWNfdXBkYXRlID0gbXRrX3BsYW5lX2F0b21pY191cGRhdGUsCiAJLmF0
b21pY19kaXNhYmxlID0gbXRrX3BsYW5lX2F0b21pY19kaXNhYmxlLAotLSAKMi4yMC4xCgpfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFp
bGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5m
cmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
