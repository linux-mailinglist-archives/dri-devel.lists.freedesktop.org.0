Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 8255EFC5A0
	for <lists+dri-devel@lfdr.de>; Thu, 14 Nov 2019 12:45:53 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 860F06E1CD;
	Thu, 14 Nov 2019 11:45:50 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 88F286E1CD
 for <dri-devel@lists.freedesktop.org>; Thu, 14 Nov 2019 11:45:49 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id A637CACCA;
 Thu, 14 Nov 2019 11:45:47 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: kraxel@redhat.com, airlied@redhat.com, daniel.vetter@ffwll.ch,
 yc_chen@aspeedtech.com, sam@ravnborg.org
Subject: [PATCH] drm/ast: Fix potential NULL-pointer read during atomic mode
 setting
Date: Thu, 14 Nov 2019 12:45:32 +0100
Message-Id: <20191114114532.31551-1-tzimmermann@suse.de>
X-Mailer: git-send-email 2.23.0
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Zimmermann <tzimmermann@suse.de>, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

V2hlbiBlbmFibGluZyB0aGUgQ1JUQyBhZnRlciB3YWtpbmcgdXAgZnJvbSBhIHBvd2VyLXNhdmlu
ZyBtb2RlLCB0aGUKcHJpbWFyeSBwbGFuZSdzIGZyYW1lYnVmZmVyIG1pZ2h0IGJlIE5VTEwsIHdo
aWNoIGxlYWRzIHRvIGEgc3RhY2sgdHJhY2UKYXMgc2hvd24gYmVsb3cuCgogIFsgIDYzMi42MjQ2
MDhdIEJVRzoga2VybmVsIE5VTEwgcG9pbnRlciBkZXJlZmVyZW5jZSwgYWRkcmVzczogMDAwMDAw
MDAwMDAwMDA0OAogIFsgIDYzMi42MjQ2MzFdICNQRjogc3VwZXJ2aXNvciByZWFkIGFjY2VzcyBp
biBrZXJuZWwgbW9kZQogIFsgIDYzMi42MjQ2MzldICNQRjogZXJyb3JfY29kZSgweDAwMDApIC0g
bm90LXByZXNlbnQgcGFnZQogIFsgIDYzMi42MjQ2NDddIFBHRCAwIFA0RCAwCiAgWyAgNjMyLjYy
NDY1NF0gT29wczogMDAwMCBbIzFdIFNNUCBQVEkKICBbICA2MzIuNjI0NjYyXSBDUFU6IDAgUElE
OiAyMDgyIENvbW06IGdub21lLXNoZWxsIFRhaW50ZWQ6IEcgICAgICAgICAgICBFICAgICA1LjQu
MC1yYzctMS1kZWZhdWx0KyAjMTE0CiAgWyAgNjMyLjYyNDY3M10gSGFyZHdhcmUgbmFtZTogU3Vu
IE1pY3Jvc3lzdGVtcyBTVU4gRklSRSBYMjI3MCBNMi9TVU4gRklSRSBYMjI3MCBNMiwgQklPUyAy
LjA1ICAgIDA3LzAxLzIwMTAKICBbICA2MzIuNjI0Njg5XSBSSVA6IDAwMTA6YXN0X2NydGNfaGVs
cGVyX2F0b21pY19lbmFibGUrMHg3ZC8weDY4MCBbYXN0XQogIFsgIDYzMi42MjQ2OThdIENvZGU6
IDQ4IDhiIDgwIGUwIDAyIDAwIDAwIDRjIDhiIDYwIDEwIDMxIGMwIGYzIDQ4IGFiIDQ4IDhiIDgz
IDc4IDA0IDAwIDAwIDRjIDg5IGVmIDQ4IDhkIDcwIDE4IGU4IDlhIGU5IDU1IGNlIDQ4IDhiIDgz
IDc4IDA0IDAwIDAwIDw0OT4gOGIgN2MgMjQgNDggNGMgODkgZWEgNGMgOGQgNDQgMjQgMjggNDgg
OGQgNGMgMjQgMjAgNDggOGQgNzAgMTgKICBbICA2MzIuNjI0NzE4XSBSU1A6IDAwMTg6ZmZmZmJl
OWVjMTIzZmE0MCBFRkxBR1M6IDAwMDEwMjQ2CiAgWyAgNjMyLjYyNDcyNl0gUkFYOiBmZmZmOTVh
MTNjZmQzNDAwIFJCWDogZmZmZjk1YTEzY2YzMjAwMCBSQ1g6IDAwMDAwMDAwMDAwMDAwMDAKICBb
ICA2MzIuNjI0NzM1XSBSRFg6IDAwMDAwMDAwMDAwMDAwMDAgUlNJOiBmZmZmOTVhMTNjZmQzNGU4
IFJESTogZmZmZmJlOWVjMTIzZmI0MAogIFsgIDYzMi42MjQ3NDRdIFJCUDogZmZmZmJlOWVjMTIz
ZmI4MCBSMDg6IDAwMDAwMDAwMDAwMDAwMDAgUjA5OiAwMDAwMDAwMDAwMDAwMDAzCiAgWyAgNjMy
LjYyNDc1M10gUjEwOiAwMDAwMDAwMDAwMDAwMDAwIFIxMTogMDAwMDAwMDAwMDAwMDAwMCBSMTI6
IDAwMDAwMDAwMDAwMDAwMDAKICBbICA2MzIuNjI0NzYyXSBSMTM6IGZmZmZiZTllYzEyM2ZhNzAg
UjE0OiBmZmZmOTVhMTNiZWI3MDAwIFIxNTogZmZmZjk1YTEzY2YzMjgwMAogIFsgIDYzMi42MjQ3
NzJdIEZTOiAgMDAwMDdmNmQyNzYzZTE0MCgwMDAwKSBHUzpmZmZmOTVhMTM0MDAwMDAwKDAwMDAp
IGtubEdTOjAwMDAwMDAwMDAwMDAwMDAKICBbICA2MzIuNjI0NzgyXSBDUzogIDAwMTAgRFM6IDAw
MDAgRVM6IDAwMDAgQ1IwOiAwMDAwMDAwMDgwMDUwMDMzCiAgWyAgNjMyLjYyNDc5MF0gQ1IyOiAw
MDAwMDAwMDAwMDAwMDQ4IENSMzogMDAwMDAwMDExOTJmODAwNCBDUjQ6IDAwMDAwMDAwMDAwMjA2
ZjAKICBbICA2MzIuNjI0ODAwXSBDYWxsIFRyYWNlOgogIFsgIDYzMi42MjQ4MTFdICA/IF9fbG9j
a19hY3F1aXJlKzB4NDA5LzB4N2MwCiAgWyAgNjMyLjYyNDgzMF0gIGRybV9hdG9taWNfaGVscGVy
X2NvbW1pdF9tb2Rlc2V0X2VuYWJsZXMrMHgxYWYvMHgyMDAKICBbICA2MzIuNjI0ODQwXSAgZHJt
X2F0b21pY19oZWxwZXJfY29tbWl0X3RhaWwrMHgzMi8weDcwCiAgWyAgNjMyLjYyNDg0OV0gIGNv
bW1pdF90YWlsKzB4YzcvMHgxMTAKICBbICA2MzIuNjI0ODU3XSAgZHJtX2F0b21pY19oZWxwZXJf
Y29tbWl0KzB4MTIxLzB4MTMwCiAgWyAgNjMyLjYyNDg2N10gIGRybV9hdG9taWNfY29ubmVjdG9y
X2NvbW1pdF9kcG1zKzB4ZDcvMHgxMDAKICBbICA2MzIuNjI0ODc4XSAgc2V0X3Byb3BlcnR5X2F0
b21pYysweGFmLzB4MTEwCiAgWyAgNjMyLjYyNDg5MF0gIGRybV9tb2RlX29ial9zZXRfcHJvcGVy
dHlfaW9jdGwrMHhiYi8weDE5MAogIFsgIDYzMi42MjQ4OTldICA/IGRybV9tb2RlX29ial9maW5k
X3Byb3BfaWQrMHg0MC8weDQwCiAgWyAgNjMyLjYyNDkwOV0gIGRybV9pb2N0bF9rZXJuZWwrMHg4
Ni8weGQwCiAgWyAgNjMyLjYyNDkxOF0gIGRybV9pb2N0bCsweDFlNC8weDM2YgogIFsgIDYzMi42
MjQ5MjVdICA/IGRybV9tb2RlX29ial9maW5kX3Byb3BfaWQrMHg0MC8weDQwCiAgWyAgNjMyLjYy
NDkzOV0gIGRvX3Zmc19pb2N0bCsweDRiZC8weDZlMAogIFsgIDYzMi42MjQ5NDldICBrc3lzX2lv
Y3RsKzB4NWUvMHg5MAogIFsgIDYzMi42MjQ5NTddICBfX3g2NF9zeXNfaW9jdGwrMHgxNi8weDIw
CiAgWyAgNjMyLjYyNDk2Nl0gIGRvX3N5c2NhbGxfNjQrMHg1YS8weDIyMAogIFsgIDYzMi42MjQ5
NzZdICBlbnRyeV9TWVNDQUxMXzY0X2FmdGVyX2h3ZnJhbWUrMHg0OS8weGJlCiAgWyAgNjMyLjYy
NDk4NF0gUklQOiAwMDMzOjB4N2Y2ZDJiMGRlMzg3CiAgWyAgNjMyLjYyNDk5MV0gQ29kZTogMDAg
MDAgOTAgNDggOGIgMDUgZjkgOWEgMGMgMDAgNjQgYzcgMDAgMjYgMDAgMDAgMDAgNDggYzcgYzAg
ZmYgZmYgZmYgZmYgYzMgNjYgMmUgMGYgMWYgODQgMDAgMDAgMDAgMDAgMDAgYjggMTAgMDAgMDAg
MDAgMGYgMDUgPDQ4PiAzZCAwMSBmMCBmZiBmZiA3MyAwMSBjMyA0OCA4YiAwZCBjOSA5YSAwYyAw
MCBmNyBkOCA2NCA4OSAwMSA0OAogIFsgIDYzMi42MjUwMTFdIFJTUDogMDAyYjowMDAwN2ZmZmI0
OWRlZjM4IEVGTEFHUzogMDAwMDAyNDYgT1JJR19SQVg6IDAwMDAwMDAwMDAwMDAwMTAKICBbICA2
MzIuNjI1MDIxXSBSQVg6IGZmZmZmZmZmZmZmZmZmZGEgUkJYOiAwMDAwN2ZmZmI0OWRlZjcwIFJD
WDogMDAwMDdmNmQyYjBkZTM4NwogIFsgIDYzMi42MjUwMzBdIFJEWDogMDAwMDdmZmZiNDlkZWY3
MCBSU0k6IDAwMDAwMDAwYzAxODY0YmEgUkRJOiAwMDAwMDAwMDAwMDAwMDA5CiAgWyAgNjMyLjYy
NTA0MF0gUkJQOiAwMDAwMDAwMGMwMTg2NGJhIFIwODogMDAwMDAwMDAwMDAwMDAwMCBSMDk6IDAw
MDAwMDAwYzBjMGMwYzAKICBbICA2MzIuNjI1MDQ5XSBSMTA6IDAwMDAwMDAwMDAwMDAwMzAgUjEx
OiAwMDAwMDAwMDAwMDAwMjQ2IFIxMjogMDAwMDU1YmMzNjdlYjkyMAogIFsgIDYzMi42MjUwNThd
IFIxMzogMDAwMDAwMDAwMDAwMDAwOSBSMTQ6IDAwMDAwMDAwMDAwMDAwMDIgUjE1OiAwMDAwMDAw
MDAwMDAwMDAwCiAgWyAgNjMyLjYyNTA3MV0gTW9kdWxlcyBsaW5rZWQgaW46IGVidGFibGVfZmls
dGVyKEUpIGVidGFibGVzKEUpIGlwNnRhYmxlX2ZpbHRlcihFKSBpcDZfdGFibGVzKEUpIGlwdGFi
bGVfZmlsdGVyKEUpIGlwX3RhYmxlcyhFKSB4X3RhYmxlcyhFKSBhZl9wYWNrZXQoRSkgc2NzaV90
cmFuc3BvcnRfaXNjc2koRSkgZG1pX3N5c2ZzKEUpIG1zcihFKSB4ZnMoRSkgaW50ZWxfcG93ZXJj
bGFtcChFKSBjb3JldGVtcChFKSBrKQogIFsgIDYzMi42MjUxODVdIENSMjogMDAwMDAwMDAwMDAw
MDA0OAoKVGhlIFNUUiBpcwoKICAqIHN0YXJ0IGdkbSBhbmQgd2FpdCBmb3IgaXQgdG8gc3dpdGNo
IG9mZiB0aGUgZGlzcGxheQogICogd2FrZSB1cCB0aGUgZGlzcGxheSBieSBwcmVzc2luZyBhIGtl
eQoKVGhlIGZpeCBhdm9pZHMgZGVyZWZlcmVuY2luZyB0aGUgcG9pbnRlciBhbmQgcG9zdHBvbmVz
IG1vZGVzZXR0aW5nIHVudGlsCnRoZXJlJ3MgYSBmcmFtZWJ1ZmZlciBib3VuZCB0byB0aGUgQ1JU
Qy4KClNpZ25lZC1vZmYtYnk6IFRob21hcyBaaW1tZXJtYW5uIDx0emltbWVybWFubkBzdXNlLmRl
PgpGaXhlczogYjQ4ZTFiNmZmZDI4ICgiZHJtL2FzdDogQWRkIENSVEMgaGVscGVycyBmb3IgYXRv
bWljIG1vZGVzZXR0aW5nIikKQ2M6IEdlcmQgSG9mZm1hbm4gPGtyYXhlbEByZWRoYXQuY29tPgpD
YzogRGF2ZSBBaXJsaWUgPGFpcmxpZWRAcmVkaGF0LmNvbT4KQ2M6IERhbmllbCBWZXR0ZXIgPGRh
bmllbC52ZXR0ZXJAZmZ3bGwuY2g+CkNjOiAiWS5DLiBDaGVuIiA8eWNfY2hlbkBhc3BlZWR0ZWNo
LmNvbT4KQ2M6IFNhbSBSYXZuYm9yZyA8c2FtQHJhdm5ib3JnLm9yZz4KLS0tCiBkcml2ZXJzL2dw
dS9kcm0vYXN0L2FzdF9tb2RlLmMgfCAxMyArKysrKysrKysrKystCiAxIGZpbGUgY2hhbmdlZCwg
MTIgaW5zZXJ0aW9ucygrKSwgMSBkZWxldGlvbigtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9hc3QvYXN0X21vZGUuYyBiL2RyaXZlcnMvZ3B1L2RybS9hc3QvYXN0X21vZGUuYwppbmRl
eCA0NzI1ZWM5MTFhNjYuLmIxNzNhOGU1YzAwYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2FzdC9hc3RfbW9kZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hc3QvYXN0X21vZGUuYwpAQCAt
Nzc0LDcgKzc3NCw4IEBAIHN0YXRpYyBpbnQgYXN0X2NydGNfaGVscGVyX2F0b21pY19jaGVjayhz
dHJ1Y3QgZHJtX2NydGMgKmNydGMsCiAJCQkJCSAgICAgICAmYWRqdXN0ZWRfbW9kZSwgJnZiaW9z
X21vZGUpOwogCQlpZiAoIXN1Y2MpCiAJCQlyZXR1cm4gLUVJTlZBTDsKLQl9CisJfSBlbHNlCisJ
CXN0YXRlLT5tb2RlX2NoYW5nZWQgPSB0cnVlOwogCiAJcmV0dXJuIDA7CiB9CkBAIC04MjQsNiAr
ODI1LDkgQEAgYXN0X2NydGNfaGVscGVyX2F0b21pY19lbmFibGUoc3RydWN0IGRybV9jcnRjICpj
cnRjLAogCXN0cnVjdCBhc3RfdmJpb3NfbW9kZV9pbmZvIHZiaW9zX21vZGU7CiAJYm9vbCBzdWNj
OwogCisJaWYgKCFmYikKKwkJcmV0dXJuOworCiAJbWVtc2V0KCZhZGp1c3RlZF9tb2RlLCAwLCBz
aXplb2YoYWRqdXN0ZWRfbW9kZSkpOwogCWRybV9tb2RlX2NvcHkoJmFkanVzdGVkX21vZGUsICZj
cnRjLT5zdGF0ZS0+YWRqdXN0ZWRfbW9kZSk7CiAKQEAgLTgzMiw2ICs4MzYsMTMgQEAgYXN0X2Ny
dGNfaGVscGVyX2F0b21pY19lbmFibGUoc3RydWN0IGRybV9jcnRjICpjcnRjLAogCWlmIChXQVJO
X09OX09OQ0UoIXN1Y2MpKQogCQlyZXR1cm47CiAKKwkvKgorCSAqIFRPRE86IFNvbWUgb2YgdGhl
IHJlZ2lzdGVycycgdmFsdWVzIGRlcGVuZCBvbiB0aGUgZnJhbWVidWZmZXIKKwkgKiAgICAgICBj
b25maWd1cmF0aW9uLiBUbyByZXNvbHZlIHRoaXMsIGZ1bGx5IHNlcGFyYXRlIHRoZSBtb2RlCisJ
ICoJIHNldHRpbmcgZnJvbSB0aGUgZnJhbWVidWZmZXIgdXBkYXRlLiBUaGUgdmJpb3MgbW9kZSBp
bmZvCisJICogICAgICAgc2hvdWxkIGJlIGdhdGhlcmVkIGJ5IGF0b21pY19jaGVjaywgdGhlIGZy
YW1lYnVmZmVyIHJlZ3MKKwkgKiAgICAgICBzaG91bGQgYmUgc2V0IGluIHByaW1hcnkgcGxhbmUn
cyB1cGRhdGUgZnVuY3Rpb24uCisJICovCiAJYXN0X3NldF92Ymlvc19tb2RlX3JlZyhjcnRjLCAm
YWRqdXN0ZWRfbW9kZSwgJnZiaW9zX21vZGUpOwogCWFzdF9zZXRfaW5kZXhfcmVnKGFzdCwgQVNU
X0lPX0NSVENfUE9SVCwgMHhhMSwgMHgwNik7CiAJYXN0X3NldF9zdGRfcmVnKGNydGMsICZhZGp1
c3RlZF9tb2RlLCAmdmJpb3NfbW9kZSk7Ci0tIAoyLjIzLjAKCl9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRl
dmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9t
YWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
