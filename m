Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1E939E4C2
	for <lists+dri-devel@lfdr.de>; Mon, 29 Apr 2019 16:29:39 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 209FB8921A;
	Mon, 29 Apr 2019 14:29:36 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-wr1-x441.google.com (mail-wr1-x441.google.com
 [IPv6:2a00:1450:4864:20::441])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 527DF8921A;
 Mon, 29 Apr 2019 14:29:35 +0000 (UTC)
Received: by mail-wr1-x441.google.com with SMTP id s18so16449507wrp.0;
 Mon, 29 Apr 2019 07:29:35 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=IS8HFK/qq0CJzFuhj+5MIu22MiZ1PnuxAdQdgkqCIVQ=;
 b=btmRgCwmRXmApm+7qpDFqIdUyOqxhqFV8/88jlkP2e+s3+qQzB6rpCUV8S/PIITCzj
 cwAhQphvLGLazI8VjcbwneLRIgNyZbqepSQIkdFKRFPJM0voiuOBErsELkr3VJs1nR67
 vKDN6sMf0PaP+htg/j2btUOor4YISyYH/jzf+iQTYJOkfNhR+uU2hZuoo67cvtPXQtZj
 2djeGo4jn7tp8V6Y2y5QLeigCvaj4AbQrx+mfBu+saOYCBdqev2mGKn/TOOIebrotTwd
 ZqHxA4Voc2Bp9bct1NxWo51+/7QsgLwA15ilSqMlMz5TfyRFHyAKxxSgXswSTdlb1eMq
 SbuA==
X-Gm-Message-State: APjAAAVgcSNQp333IhCXTPmljgg5PWP70ngRbKSjkgg7s4O3hU/0OSWJ
 rETbbY3X5IeV/8bBjQFCB6gWvpDWFL7UAb08Yn4=
X-Google-Smtp-Source: APXvYqzbpNx8x5WHGFzel+TZIU96tlUACsHYBm/8n1WljupYHqfP4h2SUU4sGueCuUN0rgsBySRtJ0RezFkK2Ttczng=
X-Received: by 2002:adf:a2d6:: with SMTP id t22mr167985wra.299.1556548173934; 
 Mon, 29 Apr 2019 07:29:33 -0700 (PDT)
MIME-Version: 1.0
References: <20190426214016.24667-1-mario.kleiner.de@gmail.com>
 <20190426214016.24667-4-mario.kleiner.de@gmail.com>
 <5d4ae0b9-f4b6-b317-2e5c-95581d154e6c@amd.com>
In-Reply-To: <5d4ae0b9-f4b6-b317-2e5c-95581d154e6c@amd.com>
From: Mario Kleiner <mario.kleiner.de@gmail.com>
Date: Mon, 29 Apr 2019 16:29:21 +0200
Message-ID: <CAEsyxyh0XXiPHp=qCyzaee-ksvUJOatvpD9rVwXU1cyhUaDO8A@mail.gmail.com>
Subject: Re: [PATCH 3/3] drm/amd/display: Compensate for pre-DCE12 BTR-VRR hw
 limitations. (v3)
To: "Kazlauskas, Nicholas" <Nicholas.Kazlauskas@amd.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=IS8HFK/qq0CJzFuhj+5MIu22MiZ1PnuxAdQdgkqCIVQ=;
 b=Oe/LOGtG6lV62I7EZ1dKN7ufAgSTFKgcpvCRbPy47R8EXZu+Yjj6Am+2UiKC2y9iA5
 O/1E9RqdHNYcjOV4ebxtqdOfOBKKqVwByzBhf0LF884OxSW05231TGKpmdh9ODD/EoHG
 WMrWWHRUMULbB9dkY6j+E4ZqAgjL/vp0QQI7Us6FyaJLZPo4CnqfMJ99yzKZLM+h8WCn
 8TAmBeM3FabBNjXHMvULRw8I4mGOUqbivldlb6iFPDNVLY6RlS3DuC4FCVl6DtaEeCFQ
 jUEKmafoReM18ptDOC9nMheXyv4/uwY4u6Ks72uLKdpm/4YHBVuwGn1AAZjdfIz9tdZF
 vYOQ==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: "dri-devel@lists.freedesktop.org" <dri-devel@lists.freedesktop.org>,
 "amd-gfx@lists.freedesktop.org" <amd-gfx@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gTW9uLCBBcHIgMjksIDIwMTkgYXQgMjo1MSBQTSBLYXpsYXVza2FzLCBOaWNob2xhcwo8Tmlj
aG9sYXMuS2F6bGF1c2thc0BhbWQuY29tPiB3cm90ZToKPgo+IE9uIDQvMjYvMTkgNTo0MCBQTSwg
TWFyaW8gS2xlaW5lciB3cm90ZToKPiA+IFByZS1EQ0UxMiBuZWVkcyBzcGVjaWFsIHRyZWF0bWVu
dCBmb3IgQlRSIC8gbG93IGZyYW1lcmF0ZQo+ID4gY29tcGVuc2F0aW9uIGZvciBtb3JlIHN0YWJs
ZSBiZWhhdmlvdXI6Cj4gPgo+ID4gQWNjb3JkaW5nIHRvIGNvbW1lbnRzIGluIHRoZSBjb2RlIGFu
ZCBzb21lIHRlc3Rpbmcgb24gRENFLTgKPiA+IGFuZCBEQ0UtMTEsIERDRS0xMSBhbmQgZWFybGll
ciBvbmx5IGFwcGx5IFZUT1RBTF9NSU4vTUFYCj4gPiBwcm9ncmFtbWluZyB3aXRoIGEgbGFnIG9m
IG9uZSBmcmFtZSwgc28gdGhlIHNwZWNpYWwgQlRSIGh3Cj4gPiBwcm9ncmFtbWluZyBmb3IgaW50
ZXJtZWRpYXRlIGZpeGVkIGR1cmF0aW9uIGZyYW1lcyBtdXN0IGJlCj4gPiBkb25lIGluc2lkZSB0
aGUgY3VycmVudCBmcmFtZSBhdCBmbGlwIHN1Ym1pc3Npb24gaW4gYXRvbWljCj4gPiBjb21taXQg
dGFpbCwgaWUuIG9uZSB2YmxhbmsgZWFybGllciwgYW5kIHRoZSBmaXhlZCByZWZyZXNoCj4gPiBp
bnRlcm1lZGlhdGUgZnJhbWUgbW9kZSBtdXN0IGJlIGFsc28gdGVybWluYXRlZCBvbmUgdmJsYW5r
Cj4gPiBlYXJsaWVyIG9uIHByZS1EQ0UxMiBkaXNwbGF5IGVuZ2luZXMuCj4gPgo+ID4gVG8gYWNo
aWV2ZSBwcm9wZXIgdGVybWluYXRpb24gb24gPCBEQ0UtMTIgc2hpZnQgdGhlIHBvaW50Cj4gPiB3
aGVuIHRoZSBzd2l0Y2gtYmFjayBmcm9tIGZpeGVkIHZibGFuayBkdXJhdGlvbiB0byB2YXJpYWJs
ZQo+ID4gdmJsYW5rIGR1cmF0aW9uIGhhcHBlbnMgZnJvbSB0aGUgc3RhcnQgb2YgVkJMQU5LICh2
YmxhbmsgaXJxLAo+ID4gYXMgZG9uZSBvbiBEQ0UtMTIrKSB0byBiYWNrLXBvcmNoIG9yIGVuZCBv
ZiBWQkxBTksgKGhhbmRsZWQKPiA+IGJ5IHZ1cGRhdGUgaXJxIGhhbmRsZXIpLiBXZSBtdXN0IGxl
YXZlIHRoZSBzd2l0Y2gtYmFjayBjb2RlCj4gPiBpbnNpZGUgVkJMQU5LIGlycSBmb3IgRENFMTIr
LCBhcyBiZWZvcmUuCj4gPgo+ID4gRG9pbmcgdGhpcywgd2UgZ2V0IG11Y2ggYmV0dGVyIGJlaGF2
aW91ciBvZiBCVFIgZm9yIHVwLXN3ZWVwcywKPiA+IGllLiBnb2luZyBmcm9tIHNob3J0IHRvIGxv
bmcgZnJhbWUgZHVyYXRpb25zICh+aGlnaCB0byBsb3cgZnBzKQo+ID4gYW5kIGZvciBjb25zdGFu
dCBmcmFtZXJhdGUgZmxpcHMsIGFzIHRlc3RlZCBvbiBEQ0UtOCBhbmQKPiA+IERDRS0xMS4gQmVo
YXZpb3VyIGlzIHN0aWxsIG5vdCBxdWl0ZSBhcyBnb29kIGFzIG9uIERDTi0xCj4gPiB0aG91Z2gu
Cj4gPgo+ID4gT24gZG93bi1zd2VlcHMsIGdvaW5nIGZyb20gbG9uZyB0byBzaG9ydCBmcmFtZSBk
dXJhdGlvbnMKPiA+IChsb3cgZnBzIHRvIGhpZ2ggZnBzKSA8IERDRS0xMiBpcyBhIGxpdHRsZSBi
aXQgaW1wcm92ZWQsCj4gPiBhbHRob3VnaCBieSBmYXIgbm90IGFzIG11Y2ggYXMgZm9yIHVwLXN3
ZWVwcyBhbmQgY29uc3RhbnQKPiA+IGZwcy4KPiA+Cj4gPiB2MjogRml4IHNvbWUgd3JvbmcgbG9j
a2luZywgYXMgcG9pbnRlZCBvdXQgYnkgTmljaG9sYXMuCj4gPiB2MzogU2ltcGxpZnkgaWYtY29u
ZGl0aW9uIGluIHZ1cGRhdGUtaXJxIC0gbml0IGJ5IE5pY2hvbGFzLgo+ID4gU2lnbmVkLW9mZi1i
eTogTWFyaW8gS2xlaW5lciA8bWFyaW8ua2xlaW5lci5kZUBnbWFpbC5jb20+Cj4KPiBSZXZpZXdl
ZC1ieTogTmljaG9sYXMgS2F6bGF1c2thcyA8bmljaG9sYXMua2F6bGF1c2thc0BhbWQuY29tPgo+
CgpUaGFua3MuCgo+IEknZCBsaWtlIHRvIHB1c2ggcGF0Y2hlcyAxKzMgaWYgeW91J3JlIG9rYXkg
d2l0aCB0aGlzLgo+CgpZZXMgcGxlYXNlISBJJ2QgbG92ZSB0byBoYXZlIHRoZXNlIGluIExpbnV4
IDUuMiwgc28gdGhhdCB3b3VsZCBiZSB0aGUKZmlyc3Qgd2VsbCBzdWl0YWJsZSBrZXJuZWwgdG8g
dGFyZ2V0IGZvciBteSBzcGVjaWZpYyBWUlIgdXNlIGNhc2VzLgoKPiBJIGNhbiBzZWUgdGhlIHZh
bHVlIGluIHRoZSAybmQgcGF0Y2ggZnJvbSB0aGUgZ3JhcGhzIGFuZCB0ZXN0Cj4gYXBwbGljYXRp
b24geW91J3ZlIHBvc3RlZCBidXQgaXQnbGwgbGlrZWx5IHRha2Ugc29tZSB0aW1lIHRvIGRvIHRo
b3JvdWdoCj4gcmV2aWV3IGFuZCB0ZXN0aW5nIG9uIHRoaXMuCj4KCkkgdW5kZXJzdGFuZC4KCj4g
VGhlIHF1ZXN0aW9uIHRoYXQgbmVlZHMgdG8gYmUgZXhhbWluZWQgd2l0aCB0aGUgc2Vjb25kIGlz
IHdoYXQgdGhlCj4gb3B0aW1hbCBtYXJnaW4gaXMsIGlmIGFueSwgZm9yIHR5cGljYWwgdXNlY2Fz
ZXMgYWNyb3NzIGNvbW1vbiBtb25pdG9yCj4gcmFuZ2VzLiBOb3QgYWxsIG1vbml0b3JzIHRoYXQg
c3VwcG9ydCBCVFIgaGF2ZSB0aGUgc2FtZSByYW5nZSwgYW5kIG1hbnkKPiBoYXZlIGEgbG93ZXIg
Ym91bmQgb2YgfjQ4SHouIFRvIG1lIH41M0h6IHNvdW5kcyByYXRoZXIgZWFybHkgdG8gYmUKPiBl
bnRlcmluZywgYnV0IEknbSBub3Qgc3VyZSBob3cgaXQgYWZmZWN0cyB0aGUgdXNlciBleHBlcmll
bmNlIG92ZXJhbGwuCj4KClRoYXQncyBpbmRlZWQgYSB0cmlja3kgdHVuaW5nIHByb2JsZW0gYW5k
IGkgZGlkbid0IHNwZW5kIG11Y2ggdGhvdWdodApvbiB0aGF0LiBKdXN0IHRvb2sgdGhlIEJUUl9F
WElUX01BUkdJTiBhbHJlYWR5IGRlZmluZWQgYXMgMiBtc2VjcywKYmVjYXVzZSBpdCB3YXMgY29u
dmVuaWVudGx5IHRoZXJlIGZvciB0aGUgZXhpdCBwYXRoIGFuZCB0aGlzIHdheSBpdAp3YXMgbmlj
ZWx5IHN5bW1ldHJpYyB0byB0aGUgQlRSIGV4aXQgcGF0aC4gMSBtc2VjIG9yIGxlc3MgbWlnaHQg
anVzdApiZSBhcyBnb29kLCBvciBzb21ldGhpbmcgbW9yZSBmYW5jeSBhbmQgYWRhcHRpdmUuIEJ1
dCBtb3N0IHZhbHVlIGNvbWVzCmZyb20gcGF0Y2ggMy8zIGFueXdheS4KCkF0bS4gaSBkb24ndCBo
YXZlIGEgRnJlZXN5bmMgY2FwYWJsZSBkaXNwbGF5IGF0IGFsbCwgc28gaSBkb24ndCBrbm93Cmhv
dyB3ZWxsIHRoaXMgcGF0Y2ggd29ya3Mgb3V0IHdydC4gZmxpY2tlciBldGMsIGkgY2FuIG9ubHkg
bG9vayBhdCBteQpwbG90cyBhbmQgdGhlIG91dHB1dCBvZiB0aGUga21zX3ZyciBpZ3QgdGVzdC4g
SSBqdXN0IGhhY2tlZCB0aGUgZHJpdmVyCnRvIGFjY2VwdCBhbnkgRFAgb3IgSERNSSBkaXNwbGF5
IGFzIFZSUiBjYXBhYmxlLCBzbyBpIGNhbiBydW4gdGhlCnN5bnRoZXRpYyB0aW1pbmcgdGVzdHMg
YmxpbmRseSAoQSBHLVN5bmMgZGlzcGxheSBtb3N0bHkgZ29lcyBibGFuayBvcgp0ZWxscyBtZSBh
IHNhZCAiT3V0IG9mIHJhbmdlIHNpZ25hbCIgb24gaXRzIE9TRCwgYSBIRE1JLT5WR0EgY29ubmVj
dGVkCkNSVCBtb25pdG9yIGN5Y2xlcyBiZXR3ZWVuICJPdXQgb2YgcmFuZ2UiLCBibGFjaywgYW5k
IHNvbWUgaGVhdmlseQpkaXN0b3J0ZWQgaW1hZ2UpLiBUaGUgRy1TeW5jIGRpc3BsYXkgaGFzIGEg
MzAgLSAxNDQgSHogcmFuZ2UgYW5kIG15CmZha2luZyBwYXRjaCBldmVuIHNldCBhIHJhbmdlIDI1
IC0gMTQ0IEh6IGZvciBtb3N0IHRlc3RzLgoKSSBhbHNvIHRob3VnaHQgYWJvdXQgc2VuZGluZyBt
eSAiZmFrZSBWUlIgZGlzcGxheSIgcGF0Y2ggYWZ0ZXIKY2xlYW5pbmcgaXQgdXAuIEkgY291bGQg
YWRkIHNvbWUgYW1kZ3B1IG1vZHVsZSBwYXJhbWV0ZXIsIGUuZy4sIGJvb2wKYW1kZ3B1LmZha2V2
cnJvdXRwdXQsCnRoYXQgaWYgc2V0IHRvIDEgd291bGQgYWxsb3cgdGhlIGRyaXZlciB0byBhY2Nl
cHQgYW55IERQL0hETUkgZGlzcGxheQphcyBWUlIgY2FwYWJsZSwgcGFyc2luZyB0aGUgVlJSIHJh
bmdlIGZyb20gRURJRCBpZiBwcmVzZW50ICh0aGF0IHdvcmtzCmZvciBHLVN5bmMgZGlzcGxheXMp
IG9yIGp1c3QgZmFraW5nIGEgcmFuZ2UgbGlrZSAzMCAtIDE0NCBIeiBvcgp3aGF0ZXZlciBpcyBy
ZWFsaXN0aWM/IEEgYmxhbmtlZCBvdXQgZGlzcGxheSBpcyBib3JpbmcgdG8gbG9vayBhdCwgYnV0
CmF0IGxlYXN0IGl0IGFsbG93cyB0byBydW4gdGltaW5nIHRlc3RzIG9yIHRoZSBJR1Qga21zX3Zy
ciB0ZXN0cwp3aXRob3V0IHRoZSBuZWVkIGZvciBhIGRlZGljYXRlZCBGcmVlU3luYyBkaXNwbGF5
LgoKRnJvbSByZWFkaW5nIG9uIHRoZSB3ZWIgSSB1bmRlcnN0YW5kIHRoYXQgIkZyZWVTeW5jMiBI
RFIiIGRpc3BsYXlzIGFyZQphbHNvIEhEUiBjYXBhYmxlIGFuZCBnbyB0aHJvdWdoIHNvbWUgdGVz
dGluZyBhbmQgY2VydGlmaWNhdGlvbiBhdCBBTUQKd3J0LiB0byBtaW5pbWFsIGZsaWNrZXI/IFdv
dWxkIHlvdSBoYXZlIHNvbWUgcmVjb21tZW5kYXRpb24gb3IKcG9pbnRlcnMgdG8gYSBkaXNwbGF5
IGkgY291bGQgYnV5IGlmIGkgbmVlZGVkIGEgbGFyZ2UgVlJSIHJhbmdlLAptaW5pbWFsIGZsaWNr
ZXIgYW5kIGFsc28gZ29vZCBIRFIgY2FwYWJpbGl0aWVzIC0gaWRlYWxseSB3aXRoIGxvY2FsbHkK
ZGltbWFibGUgYmFja2xpZ2h0IG9yIHN1Y2g/IEkgd2lsbCBwcm9iYWJseSBoYXZlIHRoZSBtb25l
eSB0byBidXkgb25lCkZyZWVTeW5jIGRpc3BsYXksIGJ1dCB0aGF0IHNob3VsZCBhbHNvIGJlIHVz
ZWFibGUgZm9yIHdvcmtpbmcgb24gSERSCnJlbGF0ZWQgc3R1ZmYuCgpUaGFua3MsCi1tYXJpbwoK
PiBOaWNob2xhcyBLYXpsYXVza2FzCj4KPiA+IC0tLQo+ID4gICAuLi4vZ3B1L2RybS9hbWQvZGlz
cGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtLmMgfCA0OCArKysrKysrKysrKysrKysrKy0tCj4gPiAg
IDEgZmlsZSBjaGFuZ2VkLCA0NCBpbnNlcnRpb25zKCspLCA0IGRlbGV0aW9ucygtKQo+ID4KPiA+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdw
dV9kbS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG0u
Ywo+ID4gaW5kZXggNzZiNmU2MjE3OTNmLi45MmIzYzJjZWM3ZGQgMTAwNjQ0Cj4gPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbS5jCj4gPiArKysg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbS5jCj4gPiBA
QCAtMzY0LDYgKzM2NCw3IEBAIHN0YXRpYyB2b2lkIGRtX3Z1cGRhdGVfaGlnaF9pcnEodm9pZCAq
aW50ZXJydXB0X3BhcmFtcykKPiA+ICAgICAgIHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0g
aXJxX3BhcmFtcy0+YWRldjsKPiA+ICAgICAgIHN0cnVjdCBhbWRncHVfY3J0YyAqYWNydGM7Cj4g
PiAgICAgICBzdHJ1Y3QgZG1fY3J0Y19zdGF0ZSAqYWNydGNfc3RhdGU7Cj4gPiArICAgICB1bnNp
Z25lZCBsb25nIGZsYWdzOwo+ID4KPiA+ICAgICAgIGFjcnRjID0gZ2V0X2NydGNfYnlfb3RnX2lu
c3QoYWRldiwgaXJxX3BhcmFtcy0+aXJxX3NyYyAtIElSUV9UWVBFX1ZVUERBVEUpOwo+ID4KPiA+
IEBAIC0zNzksOCArMzgwLDI1IEBAIHN0YXRpYyB2b2lkIGRtX3Z1cGRhdGVfaGlnaF9pcnEodm9p
ZCAqaW50ZXJydXB0X3BhcmFtcykKPiA+ICAgICAgICAgICAgICAgICogcGFnZS1mbGlwIGNvbXBs
ZXRpb24gZXZlbnRzIHRoYXQgaGF2ZSBiZWVuIHF1ZXVlZCB0byB1cwo+ID4gICAgICAgICAgICAg
ICAgKiBpZiBhIHBhZ2VmbGlwIGhhcHBlbmVkIGluc2lkZSBmcm9udC1wb3JjaC4KPiA+ICAgICAg
ICAgICAgICAgICovCj4gPiAtICAgICAgICAgICAgIGlmIChhbWRncHVfZG1fdnJyX2FjdGl2ZShh
Y3J0Y19zdGF0ZSkpCj4gPiArICAgICAgICAgICAgIGlmIChhbWRncHVfZG1fdnJyX2FjdGl2ZShh
Y3J0Y19zdGF0ZSkpIHsKPiA+ICAgICAgICAgICAgICAgICAgICAgICBkcm1fY3J0Y19oYW5kbGVf
dmJsYW5rKCZhY3J0Yy0+YmFzZSk7Cj4gPiArCj4gPiArICAgICAgICAgICAgICAgICAgICAgLyog
QlRSIHByb2Nlc3NpbmcgZm9yIHByZS1EQ0UxMiBBU0lDcyAqLwo+ID4gKyAgICAgICAgICAgICAg
ICAgICAgIGlmIChhY3J0Y19zdGF0ZS0+c3RyZWFtICYmCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgICAgIGFkZXYtPmZhbWlseSA8IEFNREdQVV9GQU1JTFlfQUkpIHsKPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHNwaW5fbG9ja19pcnFzYXZlKCZhZGV2LT5kZGV2LT5ldmVudF9s
b2NrLCBmbGFncyk7Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RfZnJlZXN5
bmNfaGFuZGxlX3ZfdXBkYXRlKAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGFkZXYtPmRtLmZyZWVzeW5jX21vZHVsZSwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBhY3J0Y19zdGF0ZS0+c3RyZWFtLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICZhY3J0Y19zdGF0ZS0+dnJyX3BhcmFtcyk7Cj4gPiArCj4gPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBkY19zdHJlYW1fYWRqdXN0X3ZtaW5fdm1heCgKPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGV2LT5kbS5kYywKPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBhY3J0Y19zdGF0ZS0+c3RyZWFtLAo+ID4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICZhY3J0Y19zdGF0ZS0+dnJyX3BhcmFtcy5hZGp1c3Qp
Owo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9y
ZSgmYWRldi0+ZGRldi0+ZXZlbnRfbG9jaywgZmxhZ3MpOwo+ID4gKyAgICAgICAgICAgICAgICAg
ICAgIH0KPiA+ICsgICAgICAgICAgICAgfQo+ID4gICAgICAgfQo+ID4gICB9Cj4gPgo+ID4gQEAg
LTM5MCw2ICs0MDgsNyBAQCBzdGF0aWMgdm9pZCBkbV9jcnRjX2hpZ2hfaXJxKHZvaWQgKmludGVy
cnVwdF9wYXJhbXMpCj4gPiAgICAgICBzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGlycV9w
YXJhbXMtPmFkZXY7Cj4gPiAgICAgICBzdHJ1Y3QgYW1kZ3B1X2NydGMgKmFjcnRjOwo+ID4gICAg
ICAgc3RydWN0IGRtX2NydGNfc3RhdGUgKmFjcnRjX3N0YXRlOwo+ID4gKyAgICAgdW5zaWduZWQg
bG9uZyBmbGFnczsKPiA+Cj4gPiAgICAgICBhY3J0YyA9IGdldF9jcnRjX2J5X290Z19pbnN0KGFk
ZXYsIGlycV9wYXJhbXMtPmlycV9zcmMgLSBJUlFfVFlQRV9WQkxBTkspOwo+ID4KPiA+IEBAIC00
MTIsOSArNDMxLDEwIEBAIHN0YXRpYyB2b2lkIGRtX2NydGNfaGlnaF9pcnEodm9pZCAqaW50ZXJy
dXB0X3BhcmFtcykKPiA+ICAgICAgICAgICAgICAgICovCj4gPiAgICAgICAgICAgICAgIGFtZGdw
dV9kbV9jcnRjX2hhbmRsZV9jcmNfaXJxKCZhY3J0Yy0+YmFzZSk7Cj4gPgo+ID4gLSAgICAgICAg
ICAgICBpZiAoYWNydGNfc3RhdGUtPnN0cmVhbSAmJgo+ID4gKyAgICAgICAgICAgICBpZiAoYWNy
dGNfc3RhdGUtPnN0cmVhbSAmJiBhZGV2LT5mYW1pbHkgPj0gQU1ER1BVX0ZBTUlMWV9BSSAmJgo+
ID4gICAgICAgICAgICAgICAgICAgYWNydGNfc3RhdGUtPnZycl9wYXJhbXMuc3VwcG9ydGVkICYm
Cj4gPiAgICAgICAgICAgICAgICAgICBhY3J0Y19zdGF0ZS0+ZnJlZXN5bmNfY29uZmlnLnN0YXRl
ID09IFZSUl9TVEFURV9BQ1RJVkVfVkFSSUFCTEUpIHsKPiA+ICsgICAgICAgICAgICAgICAgICAg
ICBzcGluX2xvY2tfaXJxc2F2ZSgmYWRldi0+ZGRldi0+ZXZlbnRfbG9jaywgZmxhZ3MpOwo+ID4g
ICAgICAgICAgICAgICAgICAgICAgIG1vZF9mcmVlc3luY19oYW5kbGVfdl91cGRhdGUoCj4gPiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGV2LT5kbS5mcmVlc3luY19tb2R1bGUsCj4g
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3J0Y19zdGF0ZS0+c3RyZWFtLAo+ID4g
QEAgLTQyNCw2ICs0NDQsNyBAQCBzdGF0aWMgdm9pZCBkbV9jcnRjX2hpZ2hfaXJxKHZvaWQgKmlu
dGVycnVwdF9wYXJhbXMpCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGV2LT5k
bS5kYywKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjcnRjX3N0YXRlLT5zdHJl
YW0sCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmYWNydGNfc3RhdGUtPnZycl9w
YXJhbXMuYWRqdXN0KTsKPiA+ICsgICAgICAgICAgICAgICAgICAgICBzcGluX3VubG9ja19pcnFy
ZXN0b3JlKCZhZGV2LT5kZGV2LT5ldmVudF9sb2NrLCBmbGFncyk7Cj4gPiAgICAgICAgICAgICAg
IH0KPiA+ICAgICAgIH0KPiA+ICAgfQo+ID4gQEAgLTQ4NzgsOCArNDg5OSwxMCBAQCBzdGF0aWMg
dm9pZCB1cGRhdGVfZnJlZXN5bmNfc3RhdGVfb25fc3RyZWFtKAo+ID4gICAgICAgc3RydWN0IGRj
X3BsYW5lX3N0YXRlICpzdXJmYWNlLAo+ID4gICAgICAgdTMyIGZsaXBfdGltZXN0YW1wX2luX3Vz
KQo+ID4gICB7Cj4gPiAtICAgICBzdHJ1Y3QgbW9kX3Zycl9wYXJhbXMgdnJyX3BhcmFtcyA9IG5l
d19jcnRjX3N0YXRlLT52cnJfcGFyYW1zOwo+ID4gKyAgICAgc3RydWN0IG1vZF92cnJfcGFyYW1z
IHZycl9wYXJhbXM7Cj4gPiAgICAgICBzdHJ1Y3QgZGNfaW5mb19wYWNrZXQgdnJyX2luZm9wYWNr
ZXQgPSB7MH07Cj4gPiArICAgICBzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGRtLT5hZGV2
Owo+ID4gKyAgICAgdW5zaWduZWQgbG9uZyBmbGFnczsKPiA+Cj4gPiAgICAgICBpZiAoIW5ld19z
dHJlYW0pCj4gPiAgICAgICAgICAgICAgIHJldHVybjsKPiA+IEBAIC00ODkyLDYgKzQ5MTUsOSBA
QCBzdGF0aWMgdm9pZCB1cGRhdGVfZnJlZXN5bmNfc3RhdGVfb25fc3RyZWFtKAo+ID4gICAgICAg
aWYgKCFuZXdfc3RyZWFtLT50aW1pbmcuaF90b3RhbCB8fCAhbmV3X3N0cmVhbS0+dGltaW5nLnZf
dG90YWwpCj4gPiAgICAgICAgICAgICAgIHJldHVybjsKPiA+Cj4gPiArICAgICBzcGluX2xvY2tf
aXJxc2F2ZSgmYWRldi0+ZGRldi0+ZXZlbnRfbG9jaywgZmxhZ3MpOwo+ID4gKyAgICAgdnJyX3Bh
cmFtcyA9IG5ld19jcnRjX3N0YXRlLT52cnJfcGFyYW1zOwo+ID4gKwo+ID4gICAgICAgaWYgKHN1
cmZhY2UpIHsKPiA+ICAgICAgICAgICAgICAgbW9kX2ZyZWVzeW5jX2hhbmRsZV9wcmVmbGlwKAo+
ID4gICAgICAgICAgICAgICAgICAgICAgIGRtLT5mcmVlc3luY19tb2R1bGUsCj4gPiBAQCAtNDg5
OSw2ICs0OTI1LDEyIEBAIHN0YXRpYyB2b2lkIHVwZGF0ZV9mcmVlc3luY19zdGF0ZV9vbl9zdHJl
YW0oCj4gPiAgICAgICAgICAgICAgICAgICAgICAgbmV3X3N0cmVhbSwKPiA+ICAgICAgICAgICAg
ICAgICAgICAgICBmbGlwX3RpbWVzdGFtcF9pbl91cywKPiA+ICAgICAgICAgICAgICAgICAgICAg
ICAmdnJyX3BhcmFtcyk7Cj4gPiArCj4gPiArICAgICAgICAgICAgIGlmIChhZGV2LT5mYW1pbHkg
PCBBTURHUFVfRkFNSUxZX0FJICYmCj4gPiArICAgICAgICAgICAgICAgICBhbWRncHVfZG1fdnJy
X2FjdGl2ZShuZXdfY3J0Y19zdGF0ZSkpIHsKPiA+ICsgICAgICAgICAgICAgICAgICAgICBtb2Rf
ZnJlZXN5bmNfaGFuZGxlX3ZfdXBkYXRlKGRtLT5mcmVlc3luY19tb2R1bGUsCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdfc3RyZWFtLCAm
dnJyX3BhcmFtcyk7Cj4gPiArICAgICAgICAgICAgIH0KPiA+ICAgICAgIH0KPiA+Cj4gPiAgICAg
ICBtb2RfZnJlZXN5bmNfYnVpbGRfdnJyX2luZm9wYWNrZXQoCj4gPiBAQCAtNDkzMCw2ICs0OTYy
LDggQEAgc3RhdGljIHZvaWQgdXBkYXRlX2ZyZWVzeW5jX3N0YXRlX29uX3N0cmVhbSgKPiA+ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5iYXNl
LmlkLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIChpbnQpbmV3X2NydGNfc3RhdGUt
PmJhc2UudnJyX2VuYWJsZWQsCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGludCl2
cnJfcGFyYW1zLnN0YXRlKTsKPiA+ICsKPiA+ICsgICAgIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUo
JmFkZXYtPmRkZXYtPmV2ZW50X2xvY2ssIGZsYWdzKTsKPiA+ICAgfQo+ID4KPiA+ICAgc3RhdGlj
IHZvaWQgcHJlX3VwZGF0ZV9mcmVlc3luY19zdGF0ZV9vbl9zdHJlYW0oCj4gPiBAQCAtNDkzNyw4
ICs0OTcxLDEwIEBAIHN0YXRpYyB2b2lkIHByZV91cGRhdGVfZnJlZXN5bmNfc3RhdGVfb25fc3Ry
ZWFtKAo+ID4gICAgICAgc3RydWN0IGRtX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+ID4g
ICB7Cj4gPiAgICAgICBzdHJ1Y3QgZGNfc3RyZWFtX3N0YXRlICpuZXdfc3RyZWFtID0gbmV3X2Ny
dGNfc3RhdGUtPnN0cmVhbTsKPiA+IC0gICAgIHN0cnVjdCBtb2RfdnJyX3BhcmFtcyB2cnJfcGFy
YW1zID0gbmV3X2NydGNfc3RhdGUtPnZycl9wYXJhbXM7Cj4gPiArICAgICBzdHJ1Y3QgbW9kX3Zy
cl9wYXJhbXMgdnJyX3BhcmFtczsKPiA+ICAgICAgIHN0cnVjdCBtb2RfZnJlZXN5bmNfY29uZmln
IGNvbmZpZyA9IG5ld19jcnRjX3N0YXRlLT5mcmVlc3luY19jb25maWc7Cj4gPiArICAgICBzdHJ1
Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGRtLT5hZGV2Owo+ID4gKyAgICAgdW5zaWduZWQgbG9u
ZyBmbGFnczsKPiA+Cj4gPiAgICAgICBpZiAoIW5ld19zdHJlYW0pCj4gPiAgICAgICAgICAgICAg
IHJldHVybjsKPiA+IEBAIC00OTUwLDYgKzQ5ODYsOSBAQCBzdGF0aWMgdm9pZCBwcmVfdXBkYXRl
X2ZyZWVzeW5jX3N0YXRlX29uX3N0cmVhbSgKPiA+ICAgICAgIGlmICghbmV3X3N0cmVhbS0+dGlt
aW5nLmhfdG90YWwgfHwgIW5ld19zdHJlYW0tPnRpbWluZy52X3RvdGFsKQo+ID4gICAgICAgICAg
ICAgICByZXR1cm47Cj4gPgo+ID4gKyAgICAgc3Bpbl9sb2NrX2lycXNhdmUoJmFkZXYtPmRkZXYt
PmV2ZW50X2xvY2ssIGZsYWdzKTsKPiA+ICsgICAgIHZycl9wYXJhbXMgPSBuZXdfY3J0Y19zdGF0
ZS0+dnJyX3BhcmFtczsKPiA+ICsKPiA+ICAgICAgIGlmIChuZXdfY3J0Y19zdGF0ZS0+dnJyX3N1
cHBvcnRlZCAmJgo+ID4gICAgICAgICAgIGNvbmZpZy5taW5fcmVmcmVzaF9pbl91aHogJiYKPiA+
ICAgICAgICAgICBjb25maWcubWF4X3JlZnJlc2hfaW5fdWh6KSB7Cj4gPiBAQCAtNDk3MCw2ICs1
MDA5LDcgQEAgc3RhdGljIHZvaWQgcHJlX3VwZGF0ZV9mcmVlc3luY19zdGF0ZV9vbl9zdHJlYW0o
Cj4gPiAgICAgICAgICAgICAgICAgICAgICAgc2l6ZW9mKHZycl9wYXJhbXMuYWRqdXN0KSkgIT0g
MCk7Cj4gPgo+ID4gICAgICAgbmV3X2NydGNfc3RhdGUtPnZycl9wYXJhbXMgPSB2cnJfcGFyYW1z
Owo+ID4gKyAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmYWRldi0+ZGRldi0+ZXZlbnRfbG9j
aywgZmxhZ3MpOwo+ID4gICB9Cj4gPgo+ID4gICBzdGF0aWMgdm9pZCBhbWRncHVfZG1faGFuZGxl
X3Zycl90cmFuc2l0aW9uKHN0cnVjdCBkbV9jcnRjX3N0YXRlICpvbGRfc3RhdGUsCj4gPgo+Cl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBt
YWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3Rz
LmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
