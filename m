Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 18BA89D671
	for <lists+dri-devel@lfdr.de>; Mon, 26 Aug 2019 21:26:37 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D6F716E2BC;
	Mon, 26 Aug 2019 19:26:33 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from bhuna.collabora.co.uk (bhuna.collabora.co.uk [46.235.227.227])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 02CE66E2B8;
 Mon, 26 Aug 2019 19:26:32 +0000 (UTC)
Received: from [127.0.0.1] (localhost [127.0.0.1])
 (Authenticated sender: andrzej.p) with ESMTPSA id EF9A2283D3B
From: Andrzej Pietrasiewicz <andrzej.p@collabora.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH RESEND 02/14] drm/radeon: Provide ddc symlink in connector
 sysfs directory
Date: Mon, 26 Aug 2019 21:25:44 +0200
Message-Id: <3c8b030bb89ec5aeafdb3c294cb6b3403d8c0601.1566845537.git.andrzej.p@collabora.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <cover.1566845537.git.andrzej.p@collabora.com>
References: <cover.1566845537.git.andrzej.p@collabora.com>
In-Reply-To: <cover.1566845537.git.andrzej.p@collabora.com>
References: <cover.1566845537.git.andrzej.p@collabora.com>
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Neil Armstrong <narmstrong@baylibre.com>, David Airlie <airlied@linux.ie>,
 Bhawanpreet Lakha <Bhawanpreet.Lakha@amd.com>,
 Thierry Reding <thierry.reding@gmail.com>,
 Laurent Pinchart <Laurent.pinchart@ideasonboard.com>, kernel@collabora.com,
 Anthony Koo <Anthony.Koo@amd.com>, linux-samsung-soc@vger.kernel.org,
 Tomi Valkeinen <tomi.valkeinen@ti.com>, David Francis <David.Francis@amd.com>,
 Krzysztof Kozlowski <krzk@kernel.org>, Jonathan Hunter <jonathanh@nvidia.com>,
 linux-rockchip@lists.infradead.org, Kukjin Kim <kgene@kernel.org>,
 linux-arm-kernel@lists.infradead.org, linux-arm-msm@vger.kernel.org,
 Uma Shankar <uma.shankar@intel.com>, freedreno@lists.freedesktop.org,
 linux-tegra@vger.kernel.org, Jonas Karlman <jonas@kwiboo.se>,
 Leo Li <sunpeng.li@amd.com>, linux-kernel@vger.kernel.org,
 intel-gfx@lists.freedesktop.org, Mamta Shukla <mamtashukla555@gmail.com>,
 linux-mediatek@lists.infradead.org, Jyri Sarha <jsarha@ti.com>,
 Rodrigo Vivi <rodrigo.vivi@intel.com>,
 Matthias Brugger <matthias.bgg@gmail.com>,
 Thomas Gleixner <tglx@linutronix.de>, Sean Paul <sean@poorly.run>,
 Allison Randal <allison@lohutok.net>, Jernej Skrabec <jernej.skrabec@siol.net>,
 amd-gfx@lists.freedesktop.org, Enrico Weigelt <info@metux.net>,
 Seung-Woo Kim <sw0312.kim@samsung.com>,
 Nicholas Kazlauskas <nicholas.kazlauskas@amd.com>,
 Todor Tomov <todor.tomov@linaro.org>,
 Kyungmin Park <kyungmin.park@samsung.com>,
 Alex Deucher <alexander.deucher@amd.com>, Shawn Guo <shawnguo@kernel.org>,
 =?UTF-8?q?Christian=20K=C3=B6nig?= <christian.koenig@amd.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VXNlIHRoZSBkZGMgcG9pbnRlciBwcm92aWRlZCBieSB0aGUgZ2VuZXJpYyBjb25uZWN0b3IuCgpT
aWduZWQtb2ZmLWJ5OiBBbmRyemVqIFBpZXRyYXNpZXdpY3ogPGFuZHJ6ZWoucEBjb2xsYWJvcmEu
Y29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX2Nvbm5lY3RvcnMuYyB8IDE0
MyArKysrKysrKysrKysrKystLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCAxMDcgaW5zZXJ0aW9ucygr
KSwgMzYgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9y
YWRlb25fY29ubmVjdG9ycy5jIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fY29ubmVj
dG9ycy5jCmluZGV4IGM2MGQxYTQ0ZDIyYS4uNjJkMzdlZGRmOTljIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9jb25uZWN0b3JzLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL3JhZGVvbi9yYWRlb25fY29ubmVjdG9ycy5jCkBAIC0xODcwLDYgKzE4NzAsNyBAQCByYWRl
b25fYWRkX2F0b21fY29ubmVjdG9yKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJc3RydWN0IHJh
ZGVvbl9jb25uZWN0b3JfYXRvbV9kaWcgKnJhZGVvbl9kaWdfY29ubmVjdG9yOwogCXN0cnVjdCBk
cm1fZW5jb2RlciAqZW5jb2RlcjsKIAlzdHJ1Y3QgcmFkZW9uX2VuY29kZXIgKnJhZGVvbl9lbmNv
ZGVyOworCXN0cnVjdCBpMmNfYWRhcHRlciAqZGRjID0gTlVMTDsKIAl1aW50MzJfdCBzdWJwaXhl
bF9vcmRlciA9IFN1YlBpeGVsTm9uZTsKIAlib29sIHNoYXJlZF9kZGMgPSBmYWxzZTsKIAlib29s
IGlzX2RwX2JyaWRnZSA9IGZhbHNlOwpAQCAtMTk0NywxNyArMTk0OCwyMSBAQCByYWRlb25fYWRk
X2F0b21fY29ubmVjdG9yKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJCXJhZGVvbl9jb25uZWN0
b3ItPmNvbl9wcml2ID0gcmFkZW9uX2RpZ19jb25uZWN0b3I7CiAJCWlmIChpMmNfYnVzLT52YWxp
ZCkgewogCQkJcmFkZW9uX2Nvbm5lY3Rvci0+ZGRjX2J1cyA9IHJhZGVvbl9pMmNfbG9va3VwKHJk
ZXYsIGkyY19idXMpOwotCQkJaWYgKHJhZGVvbl9jb25uZWN0b3ItPmRkY19idXMpCisJCQlpZiAo
cmFkZW9uX2Nvbm5lY3Rvci0+ZGRjX2J1cykgewogCQkJCWhhc19hdXggPSB0cnVlOwotCQkJZWxz
ZQorCQkJCWRkYyA9ICZyYWRlb25fY29ubmVjdG9yLT5kZGNfYnVzLT5hZGFwdGVyOworCQkJfSBl
bHNlIHsKIAkJCQlEUk1fRVJST1IoIkRQOiBGYWlsZWQgdG8gYXNzaWduIGRkYyBidXMhIENoZWNr
IGRtZXNnIGZvciBpMmMgZXJyb3JzLlxuIik7CisJCQl9CiAJCX0KIAkJc3dpdGNoIChjb25uZWN0
b3JfdHlwZSkgewogCQljYXNlIERSTV9NT0RFX0NPTk5FQ1RPUl9WR0E6CiAJCWNhc2UgRFJNX01P
REVfQ09OTkVDVE9SX0RWSUE6CiAJCWRlZmF1bHQ6Ci0JCQlkcm1fY29ubmVjdG9yX2luaXQoZGV2
LCAmcmFkZW9uX2Nvbm5lY3Rvci0+YmFzZSwKLQkJCQkJICAgJnJhZGVvbl9kcF9jb25uZWN0b3Jf
ZnVuY3MsIGNvbm5lY3Rvcl90eXBlKTsKKwkJCWRybV9jb25uZWN0b3JfaW5pdF93aXRoX2RkYyhk
ZXYsICZyYWRlb25fY29ubmVjdG9yLT5iYXNlLAorCQkJCQkJICAgICZyYWRlb25fZHBfY29ubmVj
dG9yX2Z1bmNzLAorCQkJCQkJICAgIGNvbm5lY3Rvcl90eXBlLAorCQkJCQkJICAgIGRkYyk7CiAJ
CQlkcm1fY29ubmVjdG9yX2hlbHBlcl9hZGQoJnJhZGVvbl9jb25uZWN0b3ItPmJhc2UsCiAJCQkJ
CQkgJnJhZGVvbl9kcF9jb25uZWN0b3JfaGVscGVyX2Z1bmNzKTsKIAkJCWNvbm5lY3Rvci0+aW50
ZXJsYWNlX2FsbG93ZWQgPSB0cnVlOwpAQCAtMTk3OSw4ICsxOTg0LDEwIEBAIHJhZGVvbl9hZGRf
YXRvbV9jb25uZWN0b3Ioc3RydWN0IGRybV9kZXZpY2UgKmRldiwKIAkJY2FzZSBEUk1fTU9ERV9D
T05ORUNUT1JfSERNSUE6CiAJCWNhc2UgRFJNX01PREVfQ09OTkVDVE9SX0hETUlCOgogCQljYXNl
IERSTV9NT0RFX0NPTk5FQ1RPUl9EaXNwbGF5UG9ydDoKLQkJCWRybV9jb25uZWN0b3JfaW5pdChk
ZXYsICZyYWRlb25fY29ubmVjdG9yLT5iYXNlLAotCQkJCQkgICAmcmFkZW9uX2RwX2Nvbm5lY3Rv
cl9mdW5jcywgY29ubmVjdG9yX3R5cGUpOworCQkJZHJtX2Nvbm5lY3Rvcl9pbml0X3dpdGhfZGRj
KGRldiwgJnJhZGVvbl9jb25uZWN0b3ItPmJhc2UsCisJCQkJCQkgICAgJnJhZGVvbl9kcF9jb25u
ZWN0b3JfZnVuY3MsCisJCQkJCQkgICAgY29ubmVjdG9yX3R5cGUsCisJCQkJCQkgICAgZGRjKTsK
IAkJCWRybV9jb25uZWN0b3JfaGVscGVyX2FkZCgmcmFkZW9uX2Nvbm5lY3Rvci0+YmFzZSwKIAkJ
CQkJCSAmcmFkZW9uX2RwX2Nvbm5lY3Rvcl9oZWxwZXJfZnVuY3MpOwogCQkJZHJtX29iamVjdF9h
dHRhY2hfcHJvcGVydHkoJnJhZGVvbl9jb25uZWN0b3ItPmJhc2UuYmFzZSwKQEAgLTIwMjcsOCAr
MjAzNCwxMCBAQCByYWRlb25fYWRkX2F0b21fY29ubmVjdG9yKHN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYsCiAJCQlicmVhazsKIAkJY2FzZSBEUk1fTU9ERV9DT05ORUNUT1JfTFZEUzoKIAkJY2FzZSBE
Uk1fTU9ERV9DT05ORUNUT1JfZURQOgotCQkJZHJtX2Nvbm5lY3Rvcl9pbml0KGRldiwgJnJhZGVv
bl9jb25uZWN0b3ItPmJhc2UsCi0JCQkJCSAgICZyYWRlb25fbHZkc19icmlkZ2VfY29ubmVjdG9y
X2Z1bmNzLCBjb25uZWN0b3JfdHlwZSk7CisJCQlkcm1fY29ubmVjdG9yX2luaXRfd2l0aF9kZGMo
ZGV2LCAmcmFkZW9uX2Nvbm5lY3Rvci0+YmFzZSwKKwkJCQkJCSAgICAmcmFkZW9uX2x2ZHNfYnJp
ZGdlX2Nvbm5lY3Rvcl9mdW5jcywKKwkJCQkJCSAgICBjb25uZWN0b3JfdHlwZSwKKwkJCQkJCSAg
ICBkZGMpOwogCQkJZHJtX2Nvbm5lY3Rvcl9oZWxwZXJfYWRkKCZyYWRlb25fY29ubmVjdG9yLT5i
YXNlLAogCQkJCQkJICZyYWRlb25fZHBfY29ubmVjdG9yX2hlbHBlcl9mdW5jcyk7CiAJCQlkcm1f
b2JqZWN0X2F0dGFjaF9wcm9wZXJ0eSgmcmFkZW9uX2Nvbm5lY3Rvci0+YmFzZS5iYXNlLApAQCAt
MjA0MiwxMyArMjA1MSwxOCBAQCByYWRlb25fYWRkX2F0b21fY29ubmVjdG9yKHN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYsCiAJfSBlbHNlIHsKIAkJc3dpdGNoIChjb25uZWN0b3JfdHlwZSkgewogCQlj
YXNlIERSTV9NT0RFX0NPTk5FQ1RPUl9WR0E6Ci0JCQlkcm1fY29ubmVjdG9yX2luaXQoZGV2LCAm
cmFkZW9uX2Nvbm5lY3Rvci0+YmFzZSwgJnJhZGVvbl92Z2FfY29ubmVjdG9yX2Z1bmNzLCBjb25u
ZWN0b3JfdHlwZSk7Ci0JCQlkcm1fY29ubmVjdG9yX2hlbHBlcl9hZGQoJnJhZGVvbl9jb25uZWN0
b3ItPmJhc2UsICZyYWRlb25fdmdhX2Nvbm5lY3Rvcl9oZWxwZXJfZnVuY3MpOwogCQkJaWYgKGky
Y19idXMtPnZhbGlkKSB7CiAJCQkJcmFkZW9uX2Nvbm5lY3Rvci0+ZGRjX2J1cyA9IHJhZGVvbl9p
MmNfbG9va3VwKHJkZXYsIGkyY19idXMpOwogCQkJCWlmICghcmFkZW9uX2Nvbm5lY3Rvci0+ZGRj
X2J1cykKIAkJCQkJRFJNX0VSUk9SKCJWR0E6IEZhaWxlZCB0byBhc3NpZ24gZGRjIGJ1cyEgQ2hl
Y2sgZG1lc2cgZm9yIGkyYyBlcnJvcnMuXG4iKTsKKwkJCQllbHNlCisJCQkJCWRkYyA9ICZyYWRl
b25fY29ubmVjdG9yLT5kZGNfYnVzLT5hZGFwdGVyOwogCQkJfQorCQkJZHJtX2Nvbm5lY3Rvcl9p
bml0X3dpdGhfZGRjKGRldiwgJnJhZGVvbl9jb25uZWN0b3ItPmJhc2UsCisJCQkJCQkgICAgJnJh
ZGVvbl92Z2FfY29ubmVjdG9yX2Z1bmNzLAorCQkJCQkJICAgIGNvbm5lY3Rvcl90eXBlLAorCQkJ
CQkJICAgIGRkYyk7CisJCQlkcm1fY29ubmVjdG9yX2hlbHBlcl9hZGQoJnJhZGVvbl9jb25uZWN0
b3ItPmJhc2UsICZyYWRlb25fdmdhX2Nvbm5lY3Rvcl9oZWxwZXJfZnVuY3MpOwogCQkJcmFkZW9u
X2Nvbm5lY3Rvci0+ZGFjX2xvYWRfZGV0ZWN0ID0gdHJ1ZTsKIAkJCWRybV9vYmplY3RfYXR0YWNo
X3Byb3BlcnR5KCZyYWRlb25fY29ubmVjdG9yLT5iYXNlLmJhc2UsCiAJCQkJCQkgICAgICByZGV2
LT5tb2RlX2luZm8ubG9hZF9kZXRlY3RfcHJvcGVydHksCkBAIC0yMDY3LDEzICsyMDgxLDE4IEBA
IHJhZGVvbl9hZGRfYXRvbV9jb25uZWN0b3Ioc3RydWN0IGRybV9kZXZpY2UgKmRldiwKIAkJCWNv
bm5lY3Rvci0+ZG91Ymxlc2Nhbl9hbGxvd2VkID0gdHJ1ZTsKIAkJCWJyZWFrOwogCQljYXNlIERS
TV9NT0RFX0NPTk5FQ1RPUl9EVklBOgotCQkJZHJtX2Nvbm5lY3Rvcl9pbml0KGRldiwgJnJhZGVv
bl9jb25uZWN0b3ItPmJhc2UsICZyYWRlb25fdmdhX2Nvbm5lY3Rvcl9mdW5jcywgY29ubmVjdG9y
X3R5cGUpOwotCQkJZHJtX2Nvbm5lY3Rvcl9oZWxwZXJfYWRkKCZyYWRlb25fY29ubmVjdG9yLT5i
YXNlLCAmcmFkZW9uX3ZnYV9jb25uZWN0b3JfaGVscGVyX2Z1bmNzKTsKIAkJCWlmIChpMmNfYnVz
LT52YWxpZCkgewogCQkJCXJhZGVvbl9jb25uZWN0b3ItPmRkY19idXMgPSByYWRlb25faTJjX2xv
b2t1cChyZGV2LCBpMmNfYnVzKTsKIAkJCQlpZiAoIXJhZGVvbl9jb25uZWN0b3ItPmRkY19idXMp
CiAJCQkJCURSTV9FUlJPUigiRFZJQTogRmFpbGVkIHRvIGFzc2lnbiBkZGMgYnVzISBDaGVjayBk
bWVzZyBmb3IgaTJjIGVycm9ycy5cbiIpOworCQkJCWVsc2UKKwkJCQkJZGRjID0gJnJhZGVvbl9j
b25uZWN0b3ItPmRkY19idXMtPmFkYXB0ZXI7CiAJCQl9CisJCQlkcm1fY29ubmVjdG9yX2luaXRf
d2l0aF9kZGMoZGV2LCAmcmFkZW9uX2Nvbm5lY3Rvci0+YmFzZSwKKwkJCQkJCSAgICAmcmFkZW9u
X3ZnYV9jb25uZWN0b3JfZnVuY3MsCisJCQkJCQkgICAgY29ubmVjdG9yX3R5cGUsCisJCQkJCQkg
ICAgZGRjKTsKKwkJCWRybV9jb25uZWN0b3JfaGVscGVyX2FkZCgmcmFkZW9uX2Nvbm5lY3Rvci0+
YmFzZSwgJnJhZGVvbl92Z2FfY29ubmVjdG9yX2hlbHBlcl9mdW5jcyk7CiAJCQlyYWRlb25fY29u
bmVjdG9yLT5kYWNfbG9hZF9kZXRlY3QgPSB0cnVlOwogCQkJZHJtX29iamVjdF9hdHRhY2hfcHJv
cGVydHkoJnJhZGVvbl9jb25uZWN0b3ItPmJhc2UuYmFzZSwKIAkJCQkJCSAgICAgIHJkZXYtPm1v
ZGVfaW5mby5sb2FkX2RldGVjdF9wcm9wZXJ0eSwKQEAgLTIwOTgsMTMgKzIxMTcsMTggQEAgcmFk
ZW9uX2FkZF9hdG9tX2Nvbm5lY3RvcihzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogCQkJCWdvdG8g
ZmFpbGVkOwogCQkJcmFkZW9uX2RpZ19jb25uZWN0b3ItPmlncF9sYW5lX2luZm8gPSBpZ3BfbGFu
ZV9pbmZvOwogCQkJcmFkZW9uX2Nvbm5lY3Rvci0+Y29uX3ByaXYgPSByYWRlb25fZGlnX2Nvbm5l
Y3RvcjsKLQkJCWRybV9jb25uZWN0b3JfaW5pdChkZXYsICZyYWRlb25fY29ubmVjdG9yLT5iYXNl
LCAmcmFkZW9uX2R2aV9jb25uZWN0b3JfZnVuY3MsIGNvbm5lY3Rvcl90eXBlKTsKLQkJCWRybV9j
b25uZWN0b3JfaGVscGVyX2FkZCgmcmFkZW9uX2Nvbm5lY3Rvci0+YmFzZSwgJnJhZGVvbl9kdmlf
Y29ubmVjdG9yX2hlbHBlcl9mdW5jcyk7CiAJCQlpZiAoaTJjX2J1cy0+dmFsaWQpIHsKIAkJCQly
YWRlb25fY29ubmVjdG9yLT5kZGNfYnVzID0gcmFkZW9uX2kyY19sb29rdXAocmRldiwgaTJjX2J1
cyk7CiAJCQkJaWYgKCFyYWRlb25fY29ubmVjdG9yLT5kZGNfYnVzKQogCQkJCQlEUk1fRVJST1Io
IkRWSTogRmFpbGVkIHRvIGFzc2lnbiBkZGMgYnVzISBDaGVjayBkbWVzZyBmb3IgaTJjIGVycm9y
cy5cbiIpOworCQkJCWVsc2UKKwkJCQkJZGRjID0gJnJhZGVvbl9jb25uZWN0b3ItPmRkY19idXMt
PmFkYXB0ZXI7CiAJCQl9CisJCQlkcm1fY29ubmVjdG9yX2luaXRfd2l0aF9kZGMoZGV2LCAmcmFk
ZW9uX2Nvbm5lY3Rvci0+YmFzZSwKKwkJCQkJCSAgICAmcmFkZW9uX2R2aV9jb25uZWN0b3JfZnVu
Y3MsCisJCQkJCQkgICAgY29ubmVjdG9yX3R5cGUsCisJCQkJCQkgICAgZGRjKTsKKwkJCWRybV9j
b25uZWN0b3JfaGVscGVyX2FkZCgmcmFkZW9uX2Nvbm5lY3Rvci0+YmFzZSwgJnJhZGVvbl9kdmlf
Y29ubmVjdG9yX2hlbHBlcl9mdW5jcyk7CiAJCQlzdWJwaXhlbF9vcmRlciA9IFN1YlBpeGVsSG9y
aXpvbnRhbFJHQjsKIAkJCWRybV9vYmplY3RfYXR0YWNoX3Byb3BlcnR5KCZyYWRlb25fY29ubmVj
dG9yLT5iYXNlLmJhc2UsCiAJCQkJCQkgICAgICByZGV2LT5tb2RlX2luZm8uY29oZXJlbnRfbW9k
ZV9wcm9wZXJ0eSwKQEAgLTIxNTUsMTMgKzIxNzksMTggQEAgcmFkZW9uX2FkZF9hdG9tX2Nvbm5l
Y3RvcihzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogCQkJCWdvdG8gZmFpbGVkOwogCQkJcmFkZW9u
X2RpZ19jb25uZWN0b3ItPmlncF9sYW5lX2luZm8gPSBpZ3BfbGFuZV9pbmZvOwogCQkJcmFkZW9u
X2Nvbm5lY3Rvci0+Y29uX3ByaXYgPSByYWRlb25fZGlnX2Nvbm5lY3RvcjsKLQkJCWRybV9jb25u
ZWN0b3JfaW5pdChkZXYsICZyYWRlb25fY29ubmVjdG9yLT5iYXNlLCAmcmFkZW9uX2R2aV9jb25u
ZWN0b3JfZnVuY3MsIGNvbm5lY3Rvcl90eXBlKTsKLQkJCWRybV9jb25uZWN0b3JfaGVscGVyX2Fk
ZCgmcmFkZW9uX2Nvbm5lY3Rvci0+YmFzZSwgJnJhZGVvbl9kdmlfY29ubmVjdG9yX2hlbHBlcl9m
dW5jcyk7CiAJCQlpZiAoaTJjX2J1cy0+dmFsaWQpIHsKIAkJCQlyYWRlb25fY29ubmVjdG9yLT5k
ZGNfYnVzID0gcmFkZW9uX2kyY19sb29rdXAocmRldiwgaTJjX2J1cyk7CiAJCQkJaWYgKCFyYWRl
b25fY29ubmVjdG9yLT5kZGNfYnVzKQogCQkJCQlEUk1fRVJST1IoIkhETUk6IEZhaWxlZCB0byBh
c3NpZ24gZGRjIGJ1cyEgQ2hlY2sgZG1lc2cgZm9yIGkyYyBlcnJvcnMuXG4iKTsKKwkJCQllbHNl
CisJCQkJCWRkYyA9ICZyYWRlb25fY29ubmVjdG9yLT5kZGNfYnVzLT5hZGFwdGVyOwogCQkJfQor
CQkJZHJtX2Nvbm5lY3Rvcl9pbml0X3dpdGhfZGRjKGRldiwgJnJhZGVvbl9jb25uZWN0b3ItPmJh
c2UsCisJCQkJCQkgICAgJnJhZGVvbl9kdmlfY29ubmVjdG9yX2Z1bmNzLAorCQkJCQkJICAgIGNv
bm5lY3Rvcl90eXBlLAorCQkJCQkJICAgIGRkYyk7CisJCQlkcm1fY29ubmVjdG9yX2hlbHBlcl9h
ZGQoJnJhZGVvbl9jb25uZWN0b3ItPmJhc2UsICZyYWRlb25fZHZpX2Nvbm5lY3Rvcl9oZWxwZXJf
ZnVuY3MpOwogCQkJZHJtX29iamVjdF9hdHRhY2hfcHJvcGVydHkoJnJhZGVvbl9jb25uZWN0b3It
PmJhc2UuYmFzZSwKIAkJCQkJCSAgICAgIHJkZXYtPm1vZGVfaW5mby5jb2hlcmVudF9tb2RlX3By
b3BlcnR5LAogCQkJCQkJICAgICAgMSk7CkBAIC0yMjA1LDE1ICsyMjM0LDIwIEBAIHJhZGVvbl9h
ZGRfYXRvbV9jb25uZWN0b3Ioc3RydWN0IGRybV9kZXZpY2UgKmRldiwKIAkJCQlnb3RvIGZhaWxl
ZDsKIAkJCXJhZGVvbl9kaWdfY29ubmVjdG9yLT5pZ3BfbGFuZV9pbmZvID0gaWdwX2xhbmVfaW5m
bzsKIAkJCXJhZGVvbl9jb25uZWN0b3ItPmNvbl9wcml2ID0gcmFkZW9uX2RpZ19jb25uZWN0b3I7
Ci0JCQlkcm1fY29ubmVjdG9yX2luaXQoZGV2LCAmcmFkZW9uX2Nvbm5lY3Rvci0+YmFzZSwgJnJh
ZGVvbl9kcF9jb25uZWN0b3JfZnVuY3MsIGNvbm5lY3Rvcl90eXBlKTsKLQkJCWRybV9jb25uZWN0
b3JfaGVscGVyX2FkZCgmcmFkZW9uX2Nvbm5lY3Rvci0+YmFzZSwgJnJhZGVvbl9kcF9jb25uZWN0
b3JfaGVscGVyX2Z1bmNzKTsKIAkJCWlmIChpMmNfYnVzLT52YWxpZCkgewogCQkJCXJhZGVvbl9j
b25uZWN0b3ItPmRkY19idXMgPSByYWRlb25faTJjX2xvb2t1cChyZGV2LCBpMmNfYnVzKTsKLQkJ
CQlpZiAocmFkZW9uX2Nvbm5lY3Rvci0+ZGRjX2J1cykKKwkJCQlpZiAocmFkZW9uX2Nvbm5lY3Rv
ci0+ZGRjX2J1cykgewogCQkJCQloYXNfYXV4ID0gdHJ1ZTsKLQkJCQllbHNlCisJCQkJCWRkYyA9
ICZyYWRlb25fY29ubmVjdG9yLT5kZGNfYnVzLT5hZGFwdGVyOworCQkJCX0gZWxzZSB7CiAJCQkJ
CURSTV9FUlJPUigiRFA6IEZhaWxlZCB0byBhc3NpZ24gZGRjIGJ1cyEgQ2hlY2sgZG1lc2cgZm9y
IGkyYyBlcnJvcnMuXG4iKTsKKwkJCQl9CiAJCQl9CisJCQlkcm1fY29ubmVjdG9yX2luaXRfd2l0
aF9kZGMoZGV2LCAmcmFkZW9uX2Nvbm5lY3Rvci0+YmFzZSwKKwkJCQkJCSAgICAmcmFkZW9uX2Rw
X2Nvbm5lY3Rvcl9mdW5jcywKKwkJCQkJCSAgICBjb25uZWN0b3JfdHlwZSwKKwkJCQkJCSAgICBk
ZGMpOworCQkJZHJtX2Nvbm5lY3Rvcl9oZWxwZXJfYWRkKCZyYWRlb25fY29ubmVjdG9yLT5iYXNl
LCAmcmFkZW9uX2RwX2Nvbm5lY3Rvcl9oZWxwZXJfZnVuY3MpOwogCQkJc3VicGl4ZWxfb3JkZXIg
PSBTdWJQaXhlbEhvcml6b250YWxSR0I7CiAJCQlkcm1fb2JqZWN0X2F0dGFjaF9wcm9wZXJ0eSgm
cmFkZW9uX2Nvbm5lY3Rvci0+YmFzZS5iYXNlLAogCQkJCQkJICAgICAgcmRldi0+bW9kZV9pbmZv
LmNvaGVyZW50X21vZGVfcHJvcGVydHksCkBAIC0yMjU1LDE1ICsyMjg5LDIwIEBAIHJhZGVvbl9h
ZGRfYXRvbV9jb25uZWN0b3Ioc3RydWN0IGRybV9kZXZpY2UgKmRldiwKIAkJCQlnb3RvIGZhaWxl
ZDsKIAkJCXJhZGVvbl9kaWdfY29ubmVjdG9yLT5pZ3BfbGFuZV9pbmZvID0gaWdwX2xhbmVfaW5m
bzsKIAkJCXJhZGVvbl9jb25uZWN0b3ItPmNvbl9wcml2ID0gcmFkZW9uX2RpZ19jb25uZWN0b3I7
Ci0JCQlkcm1fY29ubmVjdG9yX2luaXQoZGV2LCAmcmFkZW9uX2Nvbm5lY3Rvci0+YmFzZSwgJnJh
ZGVvbl9lZHBfY29ubmVjdG9yX2Z1bmNzLCBjb25uZWN0b3JfdHlwZSk7Ci0JCQlkcm1fY29ubmVj
dG9yX2hlbHBlcl9hZGQoJnJhZGVvbl9jb25uZWN0b3ItPmJhc2UsICZyYWRlb25fZHBfY29ubmVj
dG9yX2hlbHBlcl9mdW5jcyk7CiAJCQlpZiAoaTJjX2J1cy0+dmFsaWQpIHsKIAkJCQlyYWRlb25f
Y29ubmVjdG9yLT5kZGNfYnVzID0gcmFkZW9uX2kyY19sb29rdXAocmRldiwgaTJjX2J1cyk7Ci0J
CQkJaWYgKHJhZGVvbl9jb25uZWN0b3ItPmRkY19idXMpCisJCQkJaWYgKHJhZGVvbl9jb25uZWN0
b3ItPmRkY19idXMpIHsKIAkJCQkJaGFzX2F1eCA9IHRydWU7Ci0JCQkJZWxzZQorCQkJCQlkZGMg
PSAmcmFkZW9uX2Nvbm5lY3Rvci0+ZGRjX2J1cy0+YWRhcHRlcjsKKwkJCQl9IGVsc2UgewogCQkJ
CQlEUk1fRVJST1IoIkRQOiBGYWlsZWQgdG8gYXNzaWduIGRkYyBidXMhIENoZWNrIGRtZXNnIGZv
ciBpMmMgZXJyb3JzLlxuIik7CisJCQkJfQogCQkJfQorCQkJZHJtX2Nvbm5lY3Rvcl9pbml0X3dp
dGhfZGRjKGRldiwgJnJhZGVvbl9jb25uZWN0b3ItPmJhc2UsCisJCQkJCQkgICAgJnJhZGVvbl9l
ZHBfY29ubmVjdG9yX2Z1bmNzLAorCQkJCQkJICAgIGNvbm5lY3Rvcl90eXBlLAorCQkJCQkJICAg
IGRkYyk7CisJCQlkcm1fY29ubmVjdG9yX2hlbHBlcl9hZGQoJnJhZGVvbl9jb25uZWN0b3ItPmJh
c2UsICZyYWRlb25fZHBfY29ubmVjdG9yX2hlbHBlcl9mdW5jcyk7CiAJCQlkcm1fb2JqZWN0X2F0
dGFjaF9wcm9wZXJ0eSgmcmFkZW9uX2Nvbm5lY3Rvci0+YmFzZS5iYXNlLAogCQkJCQkJICAgICAg
ZGV2LT5tb2RlX2NvbmZpZy5zY2FsaW5nX21vZGVfcHJvcGVydHksCiAJCQkJCQkgICAgICBEUk1f
TU9ERV9TQ0FMRV9GVUxMU0NSRUVOKTsKQEAgLTIyNzQsNyArMjMxMywxMCBAQCByYWRlb25fYWRk
X2F0b21fY29ubmVjdG9yKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJCWNhc2UgRFJNX01PREVf
Q09OTkVDVE9SX1NWSURFTzoKIAkJY2FzZSBEUk1fTU9ERV9DT05ORUNUT1JfQ29tcG9zaXRlOgog
CQljYXNlIERSTV9NT0RFX0NPTk5FQ1RPUl85UGluRElOOgotCQkJZHJtX2Nvbm5lY3Rvcl9pbml0
KGRldiwgJnJhZGVvbl9jb25uZWN0b3ItPmJhc2UsICZyYWRlb25fdHZfY29ubmVjdG9yX2Z1bmNz
LCBjb25uZWN0b3JfdHlwZSk7CisJCQlkcm1fY29ubmVjdG9yX2luaXRfd2l0aF9kZGMoZGV2LCAm
cmFkZW9uX2Nvbm5lY3Rvci0+YmFzZSwKKwkJCQkJCSAgICAmcmFkZW9uX3R2X2Nvbm5lY3Rvcl9m
dW5jcywKKwkJCQkJCSAgICBjb25uZWN0b3JfdHlwZSwKKwkJCQkJCSAgICBkZGMpOwogCQkJZHJt
X2Nvbm5lY3Rvcl9oZWxwZXJfYWRkKCZyYWRlb25fY29ubmVjdG9yLT5iYXNlLCAmcmFkZW9uX3R2
X2Nvbm5lY3Rvcl9oZWxwZXJfZnVuY3MpOwogCQkJcmFkZW9uX2Nvbm5lY3Rvci0+ZGFjX2xvYWRf
ZGV0ZWN0ID0gdHJ1ZTsKIAkJCWRybV9vYmplY3RfYXR0YWNoX3Byb3BlcnR5KCZyYWRlb25fY29u
bmVjdG9yLT5iYXNlLmJhc2UsCkBAIC0yMjk0LDEzICsyMzM2LDE4IEBAIHJhZGVvbl9hZGRfYXRv
bV9jb25uZWN0b3Ioc3RydWN0IGRybV9kZXZpY2UgKmRldiwKIAkJCQlnb3RvIGZhaWxlZDsKIAkJ
CXJhZGVvbl9kaWdfY29ubmVjdG9yLT5pZ3BfbGFuZV9pbmZvID0gaWdwX2xhbmVfaW5mbzsKIAkJ
CXJhZGVvbl9jb25uZWN0b3ItPmNvbl9wcml2ID0gcmFkZW9uX2RpZ19jb25uZWN0b3I7Ci0JCQlk
cm1fY29ubmVjdG9yX2luaXQoZGV2LCAmcmFkZW9uX2Nvbm5lY3Rvci0+YmFzZSwgJnJhZGVvbl9s
dmRzX2Nvbm5lY3Rvcl9mdW5jcywgY29ubmVjdG9yX3R5cGUpOwotCQkJZHJtX2Nvbm5lY3Rvcl9o
ZWxwZXJfYWRkKCZyYWRlb25fY29ubmVjdG9yLT5iYXNlLCAmcmFkZW9uX2x2ZHNfY29ubmVjdG9y
X2hlbHBlcl9mdW5jcyk7CiAJCQlpZiAoaTJjX2J1cy0+dmFsaWQpIHsKIAkJCQlyYWRlb25fY29u
bmVjdG9yLT5kZGNfYnVzID0gcmFkZW9uX2kyY19sb29rdXAocmRldiwgaTJjX2J1cyk7CiAJCQkJ
aWYgKCFyYWRlb25fY29ubmVjdG9yLT5kZGNfYnVzKQogCQkJCQlEUk1fRVJST1IoIkxWRFM6IEZh
aWxlZCB0byBhc3NpZ24gZGRjIGJ1cyEgQ2hlY2sgZG1lc2cgZm9yIGkyYyBlcnJvcnMuXG4iKTsK
KwkJCQllbHNlCisJCQkJCWRkYyA9ICZyYWRlb25fY29ubmVjdG9yLT5kZGNfYnVzLT5hZGFwdGVy
OwogCQkJfQorCQkJZHJtX2Nvbm5lY3Rvcl9pbml0X3dpdGhfZGRjKGRldiwgJnJhZGVvbl9jb25u
ZWN0b3ItPmJhc2UsCisJCQkJCQkgICAgJnJhZGVvbl9sdmRzX2Nvbm5lY3Rvcl9mdW5jcywKKwkJ
CQkJCSAgICBjb25uZWN0b3JfdHlwZSwKKwkJCQkJCSAgICBkZGMpOworCQkJZHJtX2Nvbm5lY3Rv
cl9oZWxwZXJfYWRkKCZyYWRlb25fY29ubmVjdG9yLT5iYXNlLCAmcmFkZW9uX2x2ZHNfY29ubmVj
dG9yX2hlbHBlcl9mdW5jcyk7CiAJCQlkcm1fb2JqZWN0X2F0dGFjaF9wcm9wZXJ0eSgmcmFkZW9u
X2Nvbm5lY3Rvci0+YmFzZS5iYXNlLAogCQkJCQkJICAgICAgZGV2LT5tb2RlX2NvbmZpZy5zY2Fs
aW5nX21vZGVfcHJvcGVydHksCiAJCQkJCQkgICAgICBEUk1fTU9ERV9TQ0FMRV9GVUxMU0NSRUVO
KTsKQEAgLTIzNDQsNiArMjM5MSw3IEBAIHJhZGVvbl9hZGRfbGVnYWN5X2Nvbm5lY3RvcihzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2LAogCXN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2ID0gZGV2LT5k
ZXZfcHJpdmF0ZTsKIAlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yOwogCXN0cnVjdCBy
YWRlb25fY29ubmVjdG9yICpyYWRlb25fY29ubmVjdG9yOworCXN0cnVjdCBpMmNfYWRhcHRlciAq
ZGRjID0gTlVMTDsKIAl1aW50MzJfdCBzdWJwaXhlbF9vcmRlciA9IFN1YlBpeGVsTm9uZTsKIAog
CWlmIChjb25uZWN0b3JfdHlwZSA9PSBEUk1fTU9ERV9DT05ORUNUT1JfVW5rbm93bikKQEAgLTIz
NzgsMTMgKzI0MjYsMTggQEAgcmFkZW9uX2FkZF9sZWdhY3lfY29ubmVjdG9yKHN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYsCiAKIAlzd2l0Y2ggKGNvbm5lY3Rvcl90eXBlKSB7CiAJY2FzZSBEUk1fTU9E
RV9DT05ORUNUT1JfVkdBOgotCQlkcm1fY29ubmVjdG9yX2luaXQoZGV2LCAmcmFkZW9uX2Nvbm5l
Y3Rvci0+YmFzZSwgJnJhZGVvbl92Z2FfY29ubmVjdG9yX2Z1bmNzLCBjb25uZWN0b3JfdHlwZSk7
Ci0JCWRybV9jb25uZWN0b3JfaGVscGVyX2FkZCgmcmFkZW9uX2Nvbm5lY3Rvci0+YmFzZSwgJnJh
ZGVvbl92Z2FfY29ubmVjdG9yX2hlbHBlcl9mdW5jcyk7CiAJCWlmIChpMmNfYnVzLT52YWxpZCkg
ewogCQkJcmFkZW9uX2Nvbm5lY3Rvci0+ZGRjX2J1cyA9IHJhZGVvbl9pMmNfbG9va3VwKHJkZXYs
IGkyY19idXMpOwogCQkJaWYgKCFyYWRlb25fY29ubmVjdG9yLT5kZGNfYnVzKQogCQkJCURSTV9F
UlJPUigiVkdBOiBGYWlsZWQgdG8gYXNzaWduIGRkYyBidXMhIENoZWNrIGRtZXNnIGZvciBpMmMg
ZXJyb3JzLlxuIik7CisJCQllbHNlCisJCQkJZGRjID0gJnJhZGVvbl9jb25uZWN0b3ItPmRkY19i
dXMtPmFkYXB0ZXI7CiAJCX0KKwkJZHJtX2Nvbm5lY3Rvcl9pbml0X3dpdGhfZGRjKGRldiwgJnJh
ZGVvbl9jb25uZWN0b3ItPmJhc2UsCisJCQkJCSAgICAmcmFkZW9uX3ZnYV9jb25uZWN0b3JfZnVu
Y3MsCisJCQkJCSAgICBjb25uZWN0b3JfdHlwZSwKKwkJCQkJICAgIGRkYyk7CisJCWRybV9jb25u
ZWN0b3JfaGVscGVyX2FkZCgmcmFkZW9uX2Nvbm5lY3Rvci0+YmFzZSwgJnJhZGVvbl92Z2FfY29u
bmVjdG9yX2hlbHBlcl9mdW5jcyk7CiAJCXJhZGVvbl9jb25uZWN0b3ItPmRhY19sb2FkX2RldGVj
dCA9IHRydWU7CiAJCWRybV9vYmplY3RfYXR0YWNoX3Byb3BlcnR5KCZyYWRlb25fY29ubmVjdG9y
LT5iYXNlLmJhc2UsCiAJCQkJCSAgICAgIHJkZXYtPm1vZGVfaW5mby5sb2FkX2RldGVjdF9wcm9w
ZXJ0eSwKQEAgLTIzOTUsMTMgKzI0NDgsMTggQEAgcmFkZW9uX2FkZF9sZWdhY3lfY29ubmVjdG9y
KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJCWNvbm5lY3Rvci0+ZG91Ymxlc2Nhbl9hbGxvd2Vk
ID0gdHJ1ZTsKIAkJYnJlYWs7CiAJY2FzZSBEUk1fTU9ERV9DT05ORUNUT1JfRFZJQToKLQkJZHJt
X2Nvbm5lY3Rvcl9pbml0KGRldiwgJnJhZGVvbl9jb25uZWN0b3ItPmJhc2UsICZyYWRlb25fdmdh
X2Nvbm5lY3Rvcl9mdW5jcywgY29ubmVjdG9yX3R5cGUpOwotCQlkcm1fY29ubmVjdG9yX2hlbHBl
cl9hZGQoJnJhZGVvbl9jb25uZWN0b3ItPmJhc2UsICZyYWRlb25fdmdhX2Nvbm5lY3Rvcl9oZWxw
ZXJfZnVuY3MpOwogCQlpZiAoaTJjX2J1cy0+dmFsaWQpIHsKIAkJCXJhZGVvbl9jb25uZWN0b3It
PmRkY19idXMgPSByYWRlb25faTJjX2xvb2t1cChyZGV2LCBpMmNfYnVzKTsKIAkJCWlmICghcmFk
ZW9uX2Nvbm5lY3Rvci0+ZGRjX2J1cykKIAkJCQlEUk1fRVJST1IoIkRWSUE6IEZhaWxlZCB0byBh
c3NpZ24gZGRjIGJ1cyEgQ2hlY2sgZG1lc2cgZm9yIGkyYyBlcnJvcnMuXG4iKTsKKwkJCWVsc2UK
KwkJCQlkZGMgPSAmcmFkZW9uX2Nvbm5lY3Rvci0+ZGRjX2J1cy0+YWRhcHRlcjsKIAkJfQorCQlk
cm1fY29ubmVjdG9yX2luaXRfd2l0aF9kZGMoZGV2LCAmcmFkZW9uX2Nvbm5lY3Rvci0+YmFzZSwK
KwkJCQkJICAgICZyYWRlb25fdmdhX2Nvbm5lY3Rvcl9mdW5jcywKKwkJCQkJICAgIGNvbm5lY3Rv
cl90eXBlLAorCQkJCQkgICAgZGRjKTsKKwkJZHJtX2Nvbm5lY3Rvcl9oZWxwZXJfYWRkKCZyYWRl
b25fY29ubmVjdG9yLT5iYXNlLCAmcmFkZW9uX3ZnYV9jb25uZWN0b3JfaGVscGVyX2Z1bmNzKTsK
IAkJcmFkZW9uX2Nvbm5lY3Rvci0+ZGFjX2xvYWRfZGV0ZWN0ID0gdHJ1ZTsKIAkJZHJtX29iamVj
dF9hdHRhY2hfcHJvcGVydHkoJnJhZGVvbl9jb25uZWN0b3ItPmJhc2UuYmFzZSwKIAkJCQkJICAg
ICAgcmRldi0+bW9kZV9pbmZvLmxvYWRfZGV0ZWN0X3Byb3BlcnR5LApAQCAtMjQxMywxMyArMjQ3
MSwxOCBAQCByYWRlb25fYWRkX2xlZ2FjeV9jb25uZWN0b3Ioc3RydWN0IGRybV9kZXZpY2UgKmRl
diwKIAkJYnJlYWs7CiAJY2FzZSBEUk1fTU9ERV9DT05ORUNUT1JfRFZJSToKIAljYXNlIERSTV9N
T0RFX0NPTk5FQ1RPUl9EVklEOgotCQlkcm1fY29ubmVjdG9yX2luaXQoZGV2LCAmcmFkZW9uX2Nv
bm5lY3Rvci0+YmFzZSwgJnJhZGVvbl9kdmlfY29ubmVjdG9yX2Z1bmNzLCBjb25uZWN0b3JfdHlw
ZSk7Ci0JCWRybV9jb25uZWN0b3JfaGVscGVyX2FkZCgmcmFkZW9uX2Nvbm5lY3Rvci0+YmFzZSwg
JnJhZGVvbl9kdmlfY29ubmVjdG9yX2hlbHBlcl9mdW5jcyk7CiAJCWlmIChpMmNfYnVzLT52YWxp
ZCkgewogCQkJcmFkZW9uX2Nvbm5lY3Rvci0+ZGRjX2J1cyA9IHJhZGVvbl9pMmNfbG9va3VwKHJk
ZXYsIGkyY19idXMpOwogCQkJaWYgKCFyYWRlb25fY29ubmVjdG9yLT5kZGNfYnVzKQogCQkJCURS
TV9FUlJPUigiRFZJOiBGYWlsZWQgdG8gYXNzaWduIGRkYyBidXMhIENoZWNrIGRtZXNnIGZvciBp
MmMgZXJyb3JzLlxuIik7CisJCQllbHNlCisJCQkJZGRjID0gJnJhZGVvbl9jb25uZWN0b3ItPmRk
Y19idXMtPmFkYXB0ZXI7CiAJCX0KKwkJZHJtX2Nvbm5lY3Rvcl9pbml0X3dpdGhfZGRjKGRldiwg
JnJhZGVvbl9jb25uZWN0b3ItPmJhc2UsCisJCQkJCSAgICAmcmFkZW9uX2R2aV9jb25uZWN0b3Jf
ZnVuY3MsCisJCQkJCSAgICBjb25uZWN0b3JfdHlwZSwKKwkJCQkJICAgIGRkYyk7CisJCWRybV9j
b25uZWN0b3JfaGVscGVyX2FkZCgmcmFkZW9uX2Nvbm5lY3Rvci0+YmFzZSwgJnJhZGVvbl9kdmlf
Y29ubmVjdG9yX2hlbHBlcl9mdW5jcyk7CiAJCWlmIChjb25uZWN0b3JfdHlwZSA9PSBEUk1fTU9E
RV9DT05ORUNUT1JfRFZJSSkgewogCQkJcmFkZW9uX2Nvbm5lY3Rvci0+ZGFjX2xvYWRfZGV0ZWN0
ID0gdHJ1ZTsKIAkJCWRybV9vYmplY3RfYXR0YWNoX3Byb3BlcnR5KCZyYWRlb25fY29ubmVjdG9y
LT5iYXNlLmJhc2UsCkBAIC0yNDM2LDcgKzI0OTksMTAgQEAgcmFkZW9uX2FkZF9sZWdhY3lfY29u
bmVjdG9yKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJY2FzZSBEUk1fTU9ERV9DT05ORUNUT1Jf
U1ZJREVPOgogCWNhc2UgRFJNX01PREVfQ09OTkVDVE9SX0NvbXBvc2l0ZToKIAljYXNlIERSTV9N
T0RFX0NPTk5FQ1RPUl85UGluRElOOgotCQlkcm1fY29ubmVjdG9yX2luaXQoZGV2LCAmcmFkZW9u
X2Nvbm5lY3Rvci0+YmFzZSwgJnJhZGVvbl90dl9jb25uZWN0b3JfZnVuY3MsIGNvbm5lY3Rvcl90
eXBlKTsKKwkJZHJtX2Nvbm5lY3Rvcl9pbml0X3dpdGhfZGRjKGRldiwgJnJhZGVvbl9jb25uZWN0
b3ItPmJhc2UsCisJCQkJCSAgICAmcmFkZW9uX3R2X2Nvbm5lY3Rvcl9mdW5jcywKKwkJCQkJICAg
IGNvbm5lY3Rvcl90eXBlLAorCQkJCQkgICAgZGRjKTsKIAkJZHJtX2Nvbm5lY3Rvcl9oZWxwZXJf
YWRkKCZyYWRlb25fY29ubmVjdG9yLT5iYXNlLCAmcmFkZW9uX3R2X2Nvbm5lY3Rvcl9oZWxwZXJf
ZnVuY3MpOwogCQlyYWRlb25fY29ubmVjdG9yLT5kYWNfbG9hZF9kZXRlY3QgPSB0cnVlOwogCQkv
KiBSUzQwMCxSQzQxMCxSUzQ4MCBjaGlwc2V0IHNlZW1zIHRvIHJlcG9ydCBhIGxvdApAQCAtMjQ1
OCwxMyArMjUyNCwxOCBAQCByYWRlb25fYWRkX2xlZ2FjeV9jb25uZWN0b3Ioc3RydWN0IGRybV9k
ZXZpY2UgKmRldiwKIAkJY29ubmVjdG9yLT5kb3VibGVzY2FuX2FsbG93ZWQgPSBmYWxzZTsKIAkJ
YnJlYWs7CiAJY2FzZSBEUk1fTU9ERV9DT05ORUNUT1JfTFZEUzoKLQkJZHJtX2Nvbm5lY3Rvcl9p
bml0KGRldiwgJnJhZGVvbl9jb25uZWN0b3ItPmJhc2UsICZyYWRlb25fbHZkc19jb25uZWN0b3Jf
ZnVuY3MsIGNvbm5lY3Rvcl90eXBlKTsKLQkJZHJtX2Nvbm5lY3Rvcl9oZWxwZXJfYWRkKCZyYWRl
b25fY29ubmVjdG9yLT5iYXNlLCAmcmFkZW9uX2x2ZHNfY29ubmVjdG9yX2hlbHBlcl9mdW5jcyk7
CiAJCWlmIChpMmNfYnVzLT52YWxpZCkgewogCQkJcmFkZW9uX2Nvbm5lY3Rvci0+ZGRjX2J1cyA9
IHJhZGVvbl9pMmNfbG9va3VwKHJkZXYsIGkyY19idXMpOwogCQkJaWYgKCFyYWRlb25fY29ubmVj
dG9yLT5kZGNfYnVzKQogCQkJCURSTV9FUlJPUigiTFZEUzogRmFpbGVkIHRvIGFzc2lnbiBkZGMg
YnVzISBDaGVjayBkbWVzZyBmb3IgaTJjIGVycm9ycy5cbiIpOworCQkJZWxzZQorCQkJCWRkYyA9
ICZyYWRlb25fY29ubmVjdG9yLT5kZGNfYnVzLT5hZGFwdGVyOwogCQl9CisJCWRybV9jb25uZWN0
b3JfaW5pdF93aXRoX2RkYyhkZXYsICZyYWRlb25fY29ubmVjdG9yLT5iYXNlLAorCQkJCQkgICAg
JnJhZGVvbl9sdmRzX2Nvbm5lY3Rvcl9mdW5jcywKKwkJCQkJICAgIGNvbm5lY3Rvcl90eXBlLAor
CQkJCQkgICAgZGRjKTsKKwkJZHJtX2Nvbm5lY3Rvcl9oZWxwZXJfYWRkKCZyYWRlb25fY29ubmVj
dG9yLT5iYXNlLCAmcmFkZW9uX2x2ZHNfY29ubmVjdG9yX2hlbHBlcl9mdW5jcyk7CiAJCWRybV9v
YmplY3RfYXR0YWNoX3Byb3BlcnR5KCZyYWRlb25fY29ubmVjdG9yLT5iYXNlLmJhc2UsCiAJCQkJ
CSAgICAgIGRldi0+bW9kZV9jb25maWcuc2NhbGluZ19tb2RlX3Byb3BlcnR5LAogCQkJCQkgICAg
ICBEUk1fTU9ERV9TQ0FMRV9GVUxMU0NSRUVOKTsKLS0gCjIuMTcuMQoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApk
cmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Au
b3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
