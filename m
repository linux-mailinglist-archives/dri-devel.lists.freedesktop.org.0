Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 071EF329CE
	for <lists+dri-devel@lfdr.de>; Mon,  3 Jun 2019 09:40:52 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E48CD892A8;
	Mon,  3 Jun 2019 07:40:43 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-pg1-x543.google.com (mail-pg1-x543.google.com
 [IPv6:2607:f8b0:4864:20::543])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B36A4898C2
 for <dri-devel@lists.freedesktop.org>; Mon,  3 Jun 2019 04:33:27 +0000 (UTC)
Received: by mail-pg1-x543.google.com with SMTP id e6so6259538pgd.9
 for <dri-devel@lists.freedesktop.org>; Sun, 02 Jun 2019 21:33:27 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=2Kwlb/5SiHsOyNhbzKStBJCJEYsXKEdQeHEGccB6G4g=;
 b=Pnk5b677bh4rVNFvumhjTQ/0mlp/VLayVMatmxueytGSeZINCZV7tD2yF+aWL3328j
 OXqqfbdC0jYl3uy9zBQWsUjk31ssF/CVcmutcdqXHIq1S1eJPlXfKwtcmpDdUvRj1atF
 gV6IqhAeWxkjh426I4QCzKlq7MW2ic9qHSfRGCVa2Az2acs/5Ms3RGsZhHh5vun/nAdo
 KBy8tP+pjSaxnhd0gPvun+cpLJqdvR+N4VDIRZW3qr0N+RM9CkCm6/w49hnG+aOyXTqp
 NJDty+ypPXK7tFIspZW8YqUMsoPfbBW63g2O+dqjAcN46sj+aRJmoUtTQo3ghwa5bvQ8
 SOKg==
X-Gm-Message-State: APjAAAU95qQePcZBlJsnqejHDEAki4obgzmUuKlm+1ozXMUeEpk22Bsm
 yhrHbVh/81uR4p8thV8CXels7Q==
X-Google-Smtp-Source: APXvYqwnwggViSS4JCbJAT4hNQZ/yjlwEWzdESELTSgpREOdMiTdp8VpKcMTR6NQXz/c1G1TpHLexA==
X-Received: by 2002:a63:18e:: with SMTP id 136mr25981553pgb.277.1559536407123; 
 Sun, 02 Jun 2019 21:33:27 -0700 (PDT)
Received: from localhost ([2401:fa00:1:b:e688:dfd2:a1a7:2956])
 by smtp.gmail.com with ESMTPSA id h12sm2623108pfr.38.2019.06.02.21.33.22
 (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
 Sun, 02 Jun 2019 21:33:26 -0700 (PDT)
From: Cheng-Yi Chiang <cychiang@chromium.org>
To: linux-kernel@vger.kernel.org
Subject: [PATCH 1/7] video: add HDMI state notifier support
Date: Mon,  3 Jun 2019 12:32:45 +0800
Message-Id: <20190603043251.226549-2-cychiang@chromium.org>
X-Mailer: git-send-email 2.22.0.rc1.257.g3120a18244-goog
In-Reply-To: <20190603043251.226549-1-cychiang@chromium.org>
References: <20190603043251.226549-1-cychiang@chromium.org>
MIME-Version: 1.0
X-Mailman-Approved-At: Mon, 03 Jun 2019 07:40:43 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=chromium.org; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=2Kwlb/5SiHsOyNhbzKStBJCJEYsXKEdQeHEGccB6G4g=;
 b=P6sxjq2jhBsuLFH1QG7yv4BIJAceIkzfv21qakj+ocuLcqfruJgk8Nknotu7hXPdaC
 EQcrUw8uZQZtGwzDPMO+UKmcFiYcFtWe24y7eP0FnYNYU9Oeb7vNiFUhp8MUd4YT8VaQ
 MaqS3sJXoC3FphFKT1F25QPEx3fflQgHYxwRo=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: alsa-devel@alsa-project.org, David Airlie <airlied@linux.ie>,
 dri-devel@lists.freedesktop.org, Liam Girdwood <lgirdwood@gmail.com>,
 Hans Verkuil <hverkuil@xs4all.nl>,
 Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
 Cheng-Yi Chiang <cychiang@chromium.org>, Takashi Iwai <tiwai@suse.com>,
 linux-rockchip@lists.infradead.org, Hans Verkuil <hans.verkuil@cisco.com>,
 dgreid@chromium.org, linux-media@vger.kernel.org, devicetree@vger.kernel.org,
 tzungbi@chromium.org, Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>,
 Russell King <rmk+kernel@armlinux.org.uk>, Rob Herring <robh+dt@kernel.org>,
 Jaroslav Kysela <perex@perex.cz>, linux-arm-kernel@lists.infradead.org,
 Greg Kroah-Hartman <gregkh@linuxfoundation.org>, dianders@chromium.org,
 Mark Brown <broonie@kernel.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogSGFucyBWZXJrdWlsIDxoYW5zLnZlcmt1aWxAY2lzY28uY29tPgoKQWRkIHN1cHBvcnQg
Zm9yIEhETUkgaG90cGx1ZyBhbmQgRURJRCBub3RpZmllcnMsIHdoaWNoIGlzIHVzZWQgdG8gY29u
dmV5CmluZm9ybWF0aW9uIGZyb20gSERNSSBkcml2ZXJzIHRvIHRoZWlyIENFQyBhbmQgYXVkaW8g
Y291bnRlcnBhcnRzLgoKQmFzZWQgb24gYW4gZWFybGllciB2ZXJzaW9uIGZyb20gUnVzc2VsbCBL
aW5nOgoKaHR0cHM6Ly9wYXRjaHdvcmsua2VybmVsLm9yZy9wYXRjaC85Mjc3MDQzLwoKVGhlIGhk
bWlfbm90aWZpZXIgaXMgYSByZWZlcmVuY2UgY291bnRlZCBvYmplY3QgY29udGFpbmluZyB0aGUg
SERNSSBzdGF0ZQpvZiBhbiBIRE1JIGRldmljZS4KCldoZW4gYSBuZXcgbm90aWZpZXIgaXMgcmVn
aXN0ZXJlZCB0aGUgY3VycmVudCBzdGF0ZSB3aWxsIGJlIHJlcG9ydGVkIHRvCnRoYXQgbm90aWZp
ZXIgYXQgcmVnaXN0cmF0aW9uIHRpbWUuCgpCYXNlZCBvbiBIYW5zIFZlcmt1aWwncyBwYXRjaDoK
Cmh0dHBzOi8vcGF0Y2h3b3JrLmtlcm5lbC5vcmcvcGF0Y2gvOTQ3MjUyMS8KCk1vZGlmaWVkIGJ5
IENoZW5nLVlpIENoaWFuZzoKIC0gQWRkIGEgc2VjdGlvbiBpbiBNQUlOVEFJTkVSLgogLSBDaGFu
Z2VzIGNvbm5lY3RlZCBhbmQgaGFzX2VsZCB0byBiaXRmaWVsZCBvZiB1bnNpZ25lZCBpbnQuCiAt
IE90aGVyIG1pbm9yIGZpeGVzIHRvIHBhc3MgY2hlY2twYXRjaC5wbCAtLXN0cmljdCBjaGVja3Mu
CgpTaWduZWQtb2ZmLWJ5OiBIYW5zIFZlcmt1aWwgPGhhbnMudmVya3VpbEBjaXNjby5jb20+CkFj
a2VkLWJ5OiBQaGlsaXBwIFphYmVsIDxwLnphYmVsQHBlbmd1dHJvbml4LmRlPgpTaWduZWQtb2Zm
LWJ5OiBDaGVuZy1ZaSBDaGlhbmcgPGN5Y2hpYW5nQGNocm9taXVtLm9yZz4KLS0tClRoZSBvcmln
aW5hbCBwYXRjaCBpcyBhdApodHRwczovL2xvcmUua2VybmVsLm9yZy9saW51eC1hcm0ta2VybmVs
LzIwMTYxMjEzMTUwODEzLjM3OTY2LTItaHZlcmt1aWxAeHM0YWxsLm5sCgogTUFJTlRBSU5FUlMg
ICAgICAgICAgICAgICAgICAgfCAgIDYgKysKIGRyaXZlcnMvdmlkZW8vS2NvbmZpZyAgICAgICAg
IHwgICAzICsKIGRyaXZlcnMvdmlkZW8vTWFrZWZpbGUgICAgICAgIHwgICAxICsKIGRyaXZlcnMv
dmlkZW8vaGRtaS1ub3RpZmllci5jIHwgMTQ1ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysKIGluY2x1ZGUvbGludXgvaGRtaS1ub3RpZmllci5oIHwgMTEyICsrKysrKysrKysrKysr
KysrKysrKysrKysrCiA1IGZpbGVzIGNoYW5nZWQsIDI2NyBpbnNlcnRpb25zKCspCiBjcmVhdGUg
bW9kZSAxMDA2NDQgZHJpdmVycy92aWRlby9oZG1pLW5vdGlmaWVyLmMKIGNyZWF0ZSBtb2RlIDEw
MDY0NCBpbmNsdWRlL2xpbnV4L2hkbWktbm90aWZpZXIuaAoKZGlmZiAtLWdpdCBhL01BSU5UQUlO
RVJTIGIvTUFJTlRBSU5FUlMKaW5kZXggNWNmYmVhNGNlNTc1Li5mZmI3Mzc2Zjk1MDkgMTAwNjQ0
Ci0tLSBhL01BSU5UQUlORVJTCisrKyBiL01BSU5UQUlORVJTCkBAIC0xNjY3Niw2ICsxNjY3Niwx
MiBAQCBXOglodHRwczovL2xpbnV4dHYub3JnCiBTOglNYWludGFpbmVkCiBGOglkcml2ZXJzL21l
ZGlhL3BsYXRmb3JtL3ZpY29kZWMvKgogCitWSURFTyBGUkFNRVdPUksKK006CUhhbnMgVmVya3Vp
bCA8aHZlcmt1aWxAeHM0YWxsLm5sPgorTDoJbGludXgtbWVkaWFAdmdlci5rZXJuZWwub3JnCitG
Oglkcml2ZXJzL3ZpZGVvL2hkbWktbm90aWZpZXIuKgorUzoJTWFpbnRhaW5lZAorCiBWSURFTyBN
VUxUSVBMRVhFUiBEUklWRVIKIE06CVBoaWxpcHAgWmFiZWwgPHAuemFiZWxAcGVuZ3V0cm9uaXgu
ZGU+CiBMOglsaW51eC1tZWRpYUB2Z2VyLmtlcm5lbC5vcmcKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
dmlkZW8vS2NvbmZpZyBiL2RyaXZlcnMvdmlkZW8vS2NvbmZpZwppbmRleCA4M2QzZDI3MWNhMTUu
LjAwMGJhOWJjMGFlNyAxMDA2NDQKLS0tIGEvZHJpdmVycy92aWRlby9LY29uZmlnCisrKyBiL2Ry
aXZlcnMvdmlkZW8vS2NvbmZpZwpAQCAtMzQsNiArMzQsOSBAQCBjb25maWcgVklERU9NT0RFX0hF
TFBFUlMKIGNvbmZpZyBIRE1JCiAJYm9vbAogCitjb25maWcgSERNSV9OT1RJRklFUlMKKwlib29s
CisKIGVuZGlmICMgSEFTX0lPTUVNCiAKIGlmIFZUCmRpZmYgLS1naXQgYS9kcml2ZXJzL3ZpZGVv
L01ha2VmaWxlIGIvZHJpdmVycy92aWRlby9NYWtlZmlsZQppbmRleCBkZjc2NTBhZGVkZTkuLmVm
ZjQ3MzYxMDJjYSAxMDA2NDQKLS0tIGEvZHJpdmVycy92aWRlby9NYWtlZmlsZQorKysgYi9kcml2
ZXJzL3ZpZGVvL01ha2VmaWxlCkBAIC0xLDYgKzEsNyBAQAogIyBTUERYLUxpY2Vuc2UtSWRlbnRp
ZmllcjogR1BMLTIuMAogb2JqLSQoQ09ORklHX1ZHQVNUQVRFKSAgICAgICAgICAgICs9IHZnYXN0
YXRlLm8KIG9iai0kKENPTkZJR19IRE1JKSAgICAgICAgICAgICAgICArPSBoZG1pLm8KK29iai0k
KENPTkZJR19IRE1JX05PVElGSUVSUykgICAgICArPSBoZG1pLW5vdGlmaWVyLm8KIAogb2JqLSQo
Q09ORklHX1ZUKQkJICArPSBjb25zb2xlLwogb2JqLSQoQ09ORklHX0ZCX1NUSSkJCSAgKz0gY29u
c29sZS8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvdmlkZW8vaGRtaS1ub3RpZmllci5jIGIvZHJpdmVy
cy92aWRlby9oZG1pLW5vdGlmaWVyLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MDAwMDAwLi5kMWVlZGY2NjE2NDgKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL3ZpZGVvL2hk
bWktbm90aWZpZXIuYwpAQCAtMCwwICsxLDE0NSBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IEdQTC0yLjAKKy8qIGhkbWktbm90aWZpZXIuYyAtIG5vdGlmeSBpbnRlcmVzdGVkIHBhcnRp
ZXMgb2YgKGRpcyljb25uZWN0IGFuZCBFRElECisgKiBldmVudHMKKyAqCisgKiBDb3B5cmlnaHQg
MjAxNiBSdXNzZWxsIEtpbmcgPHJtaytrZXJuZWxAYXJtLmxpbnV4Lm9yZy51az4KKyAqIENvcHly
aWdodCAyMDE2IENpc2NvIFN5c3RlbXMsIEluYy4gYW5kL29yIGl0cyBhZmZpbGlhdGVzLgorICog
QWxsIHJpZ2h0cyByZXNlcnZlZC4KKyAqLworCisjaW5jbHVkZSA8bGludXgvZXhwb3J0Lmg+Cisj
aW5jbHVkZSA8bGludXgvaGRtaS1ub3RpZmllci5oPgorI2luY2x1ZGUgPGxpbnV4L3N0cmluZy5o
PgorI2luY2x1ZGUgPGxpbnV4L3NsYWIuaD4KKyNpbmNsdWRlIDxsaW51eC9saXN0Lmg+CisKK3N0
YXRpYyBMSVNUX0hFQUQoaGRtaV9ub3RpZmllcnMpOworc3RhdGljIERFRklORV9NVVRFWChoZG1p
X25vdGlmaWVyc19sb2NrKTsKKworc3RydWN0IGhkbWlfbm90aWZpZXIgKmhkbWlfbm90aWZpZXJf
Z2V0KHN0cnVjdCBkZXZpY2UgKmRldikKK3sKKwlzdHJ1Y3QgaGRtaV9ub3RpZmllciAqbjsKKwor
CW11dGV4X2xvY2soJmhkbWlfbm90aWZpZXJzX2xvY2spOworCWxpc3RfZm9yX2VhY2hfZW50cnko
biwgJmhkbWlfbm90aWZpZXJzLCBoZWFkKSB7CisJCWlmIChuLT5kZXYgPT0gZGV2KSB7CisJCQlt
dXRleF91bmxvY2soJmhkbWlfbm90aWZpZXJzX2xvY2spOworCQkJa3JlZl9nZXQoJm4tPmtyZWYp
OworCQkJcmV0dXJuIG47CisJCX0KKwl9CisJbiA9IGt6YWxsb2Moc2l6ZW9mKCpuKSwgR0ZQX0tF
Uk5FTCk7CisJaWYgKCFuKQorCQlnb3RvIHVubG9jazsKKwluLT5kZXYgPSBkZXY7CisJbXV0ZXhf
aW5pdCgmbi0+bG9jayk7CisJQkxPQ0tJTkdfSU5JVF9OT1RJRklFUl9IRUFEKCZuLT5ub3RpZmll
cnMpOworCWtyZWZfaW5pdCgmbi0+a3JlZik7CisJbGlzdF9hZGRfdGFpbCgmbi0+aGVhZCwgJmhk
bWlfbm90aWZpZXJzKTsKK3VubG9jazoKKwltdXRleF91bmxvY2soJmhkbWlfbm90aWZpZXJzX2xv
Y2spOworCXJldHVybiBuOworfQorRVhQT1JUX1NZTUJPTF9HUEwoaGRtaV9ub3RpZmllcl9nZXQp
OworCitzdGF0aWMgdm9pZCBoZG1pX25vdGlmaWVyX3JlbGVhc2Uoc3RydWN0IGtyZWYgKmtyZWYp
Cit7CisJc3RydWN0IGhkbWlfbm90aWZpZXIgKm4gPQorCQljb250YWluZXJfb2Yoa3JlZiwgc3Ry
dWN0IGhkbWlfbm90aWZpZXIsIGtyZWYpOworCisJbXV0ZXhfbG9jaygmaGRtaV9ub3RpZmllcnNf
bG9jayk7CisJbGlzdF9kZWwoJm4tPmhlYWQpOworCW11dGV4X3VubG9jaygmaGRtaV9ub3RpZmll
cnNfbG9jayk7CisJa2ZyZWUobi0+ZWRpZCk7CisJa2ZyZWUobik7Cit9CisKK3ZvaWQgaGRtaV9u
b3RpZmllcl9wdXQoc3RydWN0IGhkbWlfbm90aWZpZXIgKm4pCit7CisJa3JlZl9wdXQoJm4tPmty
ZWYsIGhkbWlfbm90aWZpZXJfcmVsZWFzZSk7Cit9CitFWFBPUlRfU1lNQk9MX0dQTChoZG1pX25v
dGlmaWVyX3B1dCk7CisKK2ludCBoZG1pX25vdGlmaWVyX3JlZ2lzdGVyKHN0cnVjdCBoZG1pX25v
dGlmaWVyICpuLCBzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgKm5iKQoreworCWludCByZXQgPSBibG9j
a2luZ19ub3RpZmllcl9jaGFpbl9yZWdpc3Rlcigmbi0+bm90aWZpZXJzLCBuYik7CisKKwlpZiAo
cmV0KQorCQlyZXR1cm4gcmV0OworCWtyZWZfZ2V0KCZuLT5rcmVmKTsKKwltdXRleF9sb2NrKCZu
LT5sb2NrKTsKKwlpZiAobi0+Y29ubmVjdGVkKSB7CisJCWJsb2NraW5nX25vdGlmaWVyX2NhbGxf
Y2hhaW4oJm4tPm5vdGlmaWVycywgSERNSV9DT05ORUNURUQsIG4pOworCQlpZiAobi0+ZWRpZF9z
aXplKQorCQkJYmxvY2tpbmdfbm90aWZpZXJfY2FsbF9jaGFpbigmbi0+bm90aWZpZXJzLAorCQkJ
CQkJICAgICBIRE1JX05FV19FRElELCBuKTsKKwkJaWYgKG4tPmhhc19lbGQpCisJCQlibG9ja2lu
Z19ub3RpZmllcl9jYWxsX2NoYWluKCZuLT5ub3RpZmllcnMsCisJCQkJCQkgICAgIEhETUlfTkVX
X0VMRCwgbik7CisJfQorCW11dGV4X3VubG9jaygmbi0+bG9jayk7CisJcmV0dXJuIDA7Cit9CitF
WFBPUlRfU1lNQk9MX0dQTChoZG1pX25vdGlmaWVyX3JlZ2lzdGVyKTsKKworaW50IGhkbWlfbm90
aWZpZXJfdW5yZWdpc3RlcihzdHJ1Y3QgaGRtaV9ub3RpZmllciAqbiwgc3RydWN0IG5vdGlmaWVy
X2Jsb2NrICpuYikKK3sKKwlpbnQgcmV0ID0gYmxvY2tpbmdfbm90aWZpZXJfY2hhaW5fdW5yZWdp
c3Rlcigmbi0+bm90aWZpZXJzLCBuYik7CisKKwlpZiAocmV0ID09IDApCisJCWhkbWlfbm90aWZp
ZXJfcHV0KG4pOworCXJldHVybiByZXQ7Cit9CitFWFBPUlRfU1lNQk9MX0dQTChoZG1pX25vdGlm
aWVyX3VucmVnaXN0ZXIpOworCit2b2lkIGhkbWlfZXZlbnRfY29ubmVjdChzdHJ1Y3QgaGRtaV9u
b3RpZmllciAqbikKK3sKKwltdXRleF9sb2NrKCZuLT5sb2NrKTsKKwluLT5jb25uZWN0ZWQgPSB0
cnVlOworCWJsb2NraW5nX25vdGlmaWVyX2NhbGxfY2hhaW4oJm4tPm5vdGlmaWVycywgSERNSV9D
T05ORUNURUQsIG4pOworCW11dGV4X3VubG9jaygmbi0+bG9jayk7Cit9CitFWFBPUlRfU1lNQk9M
X0dQTChoZG1pX2V2ZW50X2Nvbm5lY3QpOworCit2b2lkIGhkbWlfZXZlbnRfZGlzY29ubmVjdChz
dHJ1Y3QgaGRtaV9ub3RpZmllciAqbikKK3sKKwltdXRleF9sb2NrKCZuLT5sb2NrKTsKKwluLT5j
b25uZWN0ZWQgPSBmYWxzZTsKKwluLT5oYXNfZWxkID0gZmFsc2U7CisJbi0+ZWRpZF9zaXplID0g
MDsKKwlibG9ja2luZ19ub3RpZmllcl9jYWxsX2NoYWluKCZuLT5ub3RpZmllcnMsIEhETUlfRElT
Q09OTkVDVEVELCBuKTsKKwltdXRleF91bmxvY2soJm4tPmxvY2spOworfQorRVhQT1JUX1NZTUJP
TF9HUEwoaGRtaV9ldmVudF9kaXNjb25uZWN0KTsKKworaW50IGhkbWlfZXZlbnRfbmV3X2VkaWQo
c3RydWN0IGhkbWlfbm90aWZpZXIgKm4sIGNvbnN0IHZvaWQgKmVkaWQsIHNpemVfdCBzaXplKQor
eworCW11dGV4X2xvY2soJm4tPmxvY2spOworCWlmIChuLT5lZGlkX2FsbG9jYXRlZF9zaXplIDwg
c2l6ZSkgeworCQl2b2lkICpwID0ga21hbGxvYyhzaXplLCBHRlBfS0VSTkVMKTsKKworCQlpZiAo
IXApIHsKKwkJCW11dGV4X3VubG9jaygmbi0+bG9jayk7CisJCQlyZXR1cm4gLUVOT01FTTsKKwkJ
fQorCQlrZnJlZShuLT5lZGlkKTsKKwkJbi0+ZWRpZCA9IHA7CisJCW4tPmVkaWRfYWxsb2NhdGVk
X3NpemUgPSBzaXplOworCX0KKwltZW1jcHkobi0+ZWRpZCwgZWRpZCwgc2l6ZSk7CisJbi0+ZWRp
ZF9zaXplID0gc2l6ZTsKKwlibG9ja2luZ19ub3RpZmllcl9jYWxsX2NoYWluKCZuLT5ub3RpZmll
cnMsIEhETUlfTkVXX0VESUQsIG4pOworCW11dGV4X3VubG9jaygmbi0+bG9jayk7CisJcmV0dXJu
IDA7Cit9CitFWFBPUlRfU1lNQk9MX0dQTChoZG1pX2V2ZW50X25ld19lZGlkKTsKKwordm9pZCBo
ZG1pX2V2ZW50X25ld19lbGQoc3RydWN0IGhkbWlfbm90aWZpZXIgKm4sIGNvbnN0IHU4IGVsZFsx
MjhdKQoreworCW11dGV4X2xvY2soJm4tPmxvY2spOworCW1lbWNweShuLT5lbGQsIGVsZCwgc2l6
ZW9mKG4tPmVsZCkpOworCW4tPmhhc19lbGQgPSB0cnVlOworCWJsb2NraW5nX25vdGlmaWVyX2Nh
bGxfY2hhaW4oJm4tPm5vdGlmaWVycywgSERNSV9ORVdfRUxELCBuKTsKKwltdXRleF91bmxvY2so
Jm4tPmxvY2spOworfQorRVhQT1JUX1NZTUJPTF9HUEwoaGRtaV9ldmVudF9uZXdfZWxkKTsKZGlm
ZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvaGRtaS1ub3RpZmllci5oIGIvaW5jbHVkZS9saW51eC9o
ZG1pLW5vdGlmaWVyLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5j
OGYzNTExMGUzZTMKLS0tIC9kZXYvbnVsbAorKysgYi9pbmNsdWRlL2xpbnV4L2hkbWktbm90aWZp
ZXIuaApAQCAtMCwwICsxLDExMiBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0y
LjAKKyAqIGhkbWktbm90aWZpZXIuaCAtIG5vdGlmeSBpbnRlcmVzdGVkIHBhcnRpZXMgb2YgKGRp
cyljb25uZWN0IGFuZCBFRElECisgKiBldmVudHMKKyAqCisgKiBDb3B5cmlnaHQgMjAxNiBSdXNz
ZWxsIEtpbmcgPHJtaytrZXJuZWxAYXJtLmxpbnV4Lm9yZy51az4KKyAqIENvcHlyaWdodCAyMDE2
IENpc2NvIFN5c3RlbXMsIEluYy4gYW5kL29yIGl0cyBhZmZpbGlhdGVzLgorICogQWxsIHJpZ2h0
cyByZXNlcnZlZC4KKyAqLworCisjaWZuZGVmIExJTlVYX0hETUlfTk9USUZJRVJfSAorI2RlZmlu
ZSBMSU5VWF9IRE1JX05PVElGSUVSX0gKKworI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CisjaW5j
bHVkZSA8bGludXgvbm90aWZpZXIuaD4KKyNpbmNsdWRlIDxsaW51eC9rcmVmLmg+CisKK2VudW0g
eworCUhETUlfQ09OTkVDVEVELAorCUhETUlfRElTQ09OTkVDVEVELAorCUhETUlfTkVXX0VESUQs
CisJSERNSV9ORVdfRUxELAorfTsKKworc3RydWN0IGRldmljZTsKKworc3RydWN0IGhkbWlfbm90
aWZpZXIgeworCS8qIExvY2sgdG8gcHJvdGVjdCBjYWxsYmFjayByZWdpc3RyYXRpb24gYW5kIG5v
dGlmaWNhdGlvbi4gKi8KKwlzdHJ1Y3QgbXV0ZXggbG9jazsKKwlzdHJ1Y3QgbGlzdF9oZWFkIGhl
YWQ7CisJc3RydWN0IGtyZWYga3JlZjsKKwlzdHJ1Y3QgYmxvY2tpbmdfbm90aWZpZXJfaGVhZCBu
b3RpZmllcnM7CisJc3RydWN0IGRldmljZSAqZGV2OworCisJLyogQ3VycmVudCBzdGF0ZSAqLwor
CXVuc2lnbmVkIGludCBjb25uZWN0ZWQgOiAxOworCXVuc2lnbmVkIGludCBoYXNfZWxkIDogMTsK
Kwl1bnNpZ25lZCBjaGFyIGVsZFsxMjhdOworCXZvaWQgKmVkaWQ7CisJc2l6ZV90IGVkaWRfc2l6
ZTsKKwlzaXplX3QgZWRpZF9hbGxvY2F0ZWRfc2l6ZTsKK307CisKKy8qKgorICogaGRtaV9ub3Rp
Zmllcl9nZXQgLSBmaW5kIG9yIGNyZWF0ZSBhIG5ldyBoZG1pX25vdGlmaWVyIGZvciB0aGUgZ2l2
ZW4gZGV2aWNlLgorICogQGRldjogZGV2aWNlIHRoYXQgc2VuZHMgdGhlIGV2ZW50cy4KKyAqCisg
KiBJZiBhIG5vdGlmaWVyIGZvciBkZXZpY2UgQGRldiBhbHJlYWR5IGV4aXN0cywgdGhlbiBpbmNy
ZWFzZSB0aGUgcmVmY291bnQKKyAqIGFuZCByZXR1cm4gdGhhdCBub3RpZmllci4KKyAqCisgKiBJ
ZiBpdCBkb2Vzbid0IGV4aXN0LCB0aGVuIGFsbG9jYXRlIGEgbmV3IG5vdGlmaWVyIHN0cnVjdCBh
bmQgcmV0dXJuIGEKKyAqIHBvaW50ZXIgdG8gdGhhdCBuZXcgc3RydWN0LgorICoKKyAqIFJldHVy
biBOVUxMIGlmIHRoZSBtZW1vcnkgY291bGQgbm90IGJlIGFsbG9jYXRlZC4KKyAqLworc3RydWN0
IGhkbWlfbm90aWZpZXIgKmhkbWlfbm90aWZpZXJfZ2V0KHN0cnVjdCBkZXZpY2UgKmRldik7CisK
Ky8qKgorICogaGRtaV9ub3RpZmllcl9wdXQgLSBkZWNyZWFzZSByZWZjb3VudCBhbmQgZGVsZXRl
IHdoZW4gdGhlIHJlZmNvdW50IHJlYWNoZXMgMC4KKyAqIEBuOiBub3RpZmllcgorICovCit2b2lk
IGhkbWlfbm90aWZpZXJfcHV0KHN0cnVjdCBoZG1pX25vdGlmaWVyICpuKTsKKworLyoqCisgKiBo
ZG1pX25vdGlmaWVyX3JlZ2lzdGVyIC0gcmVnaXN0ZXIgdGhlIG5vdGlmaWVyIHdpdGggdGhlIG5v
dGlmaWVyX2Jsb2NrLgorICogQG46IHRoZSBIRE1JIG5vdGlmaWVyCisgKiBAbmI6IHRoZSBub3Rp
Zmllcl9ibG9jaworICovCitpbnQgaGRtaV9ub3RpZmllcl9yZWdpc3RlcihzdHJ1Y3QgaGRtaV9u
b3RpZmllciAqbiwgc3RydWN0IG5vdGlmaWVyX2Jsb2NrICpuYik7CisKKy8qKgorICogaGRtaV9u
b3RpZmllcl91bnJlZ2lzdGVyIC0gdW5yZWdpc3RlciB0aGUgbm90aWZpZXIgd2l0aCB0aGUgbm90
aWZpZXJfYmxvY2suCisgKiBAbjogdGhlIEhETUkgbm90aWZpZXIKKyAqIEBuYjogdGhlIG5vdGlm
aWVyX2Jsb2NrCisgKi8KK2ludCBoZG1pX25vdGlmaWVyX3VucmVnaXN0ZXIoc3RydWN0IGhkbWlf
bm90aWZpZXIgKm4sCisJCQkgICAgIHN0cnVjdCBub3RpZmllcl9ibG9jayAqbmIpOworCisvKioK
KyAqIGhkbWlfZXZlbnRfY29ubmVjdCAtIHNlbmQgYSBjb25uZWN0IGV2ZW50LgorICogQG46IHRo
ZSBIRE1JIG5vdGlmaWVyCisgKgorICogU2VuZCBhbiBIRE1JX0NPTk5FQ1RFRCBldmVudCB0byBh
bnkgcmVnaXN0ZXJlZCBwYXJ0aWVzLgorICovCit2b2lkIGhkbWlfZXZlbnRfY29ubmVjdChzdHJ1
Y3QgaGRtaV9ub3RpZmllciAqbik7CisKKy8qKgorICogaGRtaV9ldmVudF9kaXNjb25uZWN0IC0g
c2VuZCBhIGRpc2Nvbm5lY3QgZXZlbnQuCisgKiBAbjogdGhlIEhETUkgbm90aWZpZXIKKyAqCisg
KiBTZW5kIGFuIEhETUlfRElTQ09OTkVDVEVEIGV2ZW50IHRvIGFueSByZWdpc3RlcmVkIHBhcnRp
ZXMuCisgKi8KK3ZvaWQgaGRtaV9ldmVudF9kaXNjb25uZWN0KHN0cnVjdCBoZG1pX25vdGlmaWVy
ICpuKTsKKworLyoqCisgKiBoZG1pX2V2ZW50X25ld19lZGlkIC0gc2VuZCBhIG5ldyBFRElEIGV2
ZW50LgorICogQG46IHRoZSBIRE1JIG5vdGlmaWVyCisgKgorICogU2VuZCBhbiBIRE1JX05FV19F
RElEIGV2ZW50IHRvIGFueSByZWdpc3RlcmVkIHBhcnRpZXMuCisgKiBUaGlzIGZ1bmN0aW9uIHdp
bGwgbWFrZSBhIGNvcHkgdGhlIEVESUQgc28gaXQgY2FuIHJldHVybiAtRU5PTUVNIGlmCisgKiBu
byBtZW1vcnkgY291bGQgYmUgYWxsb2NhdGVkLgorICovCitpbnQgaGRtaV9ldmVudF9uZXdfZWRp
ZChzdHJ1Y3QgaGRtaV9ub3RpZmllciAqbiwgY29uc3Qgdm9pZCAqZWRpZCwgc2l6ZV90IHNpemUp
OworCisvKioKKyAqIGhkbWlfZXZlbnRfbmV3X2VsZCAtIHNlbmQgYSBuZXcgRUxEIGV2ZW50Lgor
ICogQG46IHRoZSBIRE1JIG5vdGlmaWVyCisgKgorICogU2VuZCBhbiBIRE1JX05FV19FTEQgZXZl
bnQgdG8gYW55IHJlZ2lzdGVyZWQgcGFydGllcy4KKyAqLwordm9pZCBoZG1pX2V2ZW50X25ld19l
bGQoc3RydWN0IGhkbWlfbm90aWZpZXIgKm4sIGNvbnN0IHU4IGVsZFsxMjhdKTsKKworI2VuZGlm
Ci0tIAoyLjIyLjAucmMxLjI1Ny5nMzEyMGExODI0NC1nb29nCgpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1k
ZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcv
bWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
