Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 854204E12D
	for <lists+dri-devel@lfdr.de>; Fri, 21 Jun 2019 09:23:40 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E6BDC6E849;
	Fri, 21 Jun 2019 07:23:17 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from inva021.nxp.com (inva021.nxp.com [92.121.34.21])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8A3DF88EB5
 for <dri-devel@lists.freedesktop.org>; Thu, 20 Jun 2019 13:30:35 +0000 (UTC)
Received: from inva021.nxp.com (localhost [127.0.0.1])
 by inva021.eu-rdc02.nxp.com (Postfix) with ESMTP id F166C200F4A;
 Thu, 20 Jun 2019 15:30:33 +0200 (CEST)
Received: from inva024.eu-rdc02.nxp.com (inva024.eu-rdc02.nxp.com
 [134.27.226.22])
 by inva021.eu-rdc02.nxp.com (Postfix) with ESMTP id DFF60200791;
 Thu, 20 Jun 2019 15:30:33 +0200 (CEST)
Received: from fsr-ub1664-120.ea.freescale.net
 (fsr-ub1664-120.ea.freescale.net [10.171.82.81])
 by inva024.eu-rdc02.nxp.com (Postfix) with ESMTP id 68A3720629;
 Thu, 20 Jun 2019 15:30:33 +0200 (CEST)
From: Robert Chiras <robert.chiras@nxp.com>
To: Thierry Reding <thierry.reding@gmail.com>, Sam Ravnborg <sam@ravnborg.org>,
 David Airlie <airlied@linux.ie>, Daniel Vetter <daniel@ffwll.ch>,
 Rob Herring <robh+dt@kernel.org>, Mark Rutland <mark.rutland@arm.com>
Subject: [PATCH v3 2/2] drm/panel: Add support for Raydium RM67191 panel driver
Date: Thu, 20 Jun 2019 16:30:28 +0300
Message-Id: <1561037428-13855-3-git-send-email-robert.chiras@nxp.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1561037428-13855-1-git-send-email-robert.chiras@nxp.com>
References: <1561037428-13855-1-git-send-email-robert.chiras@nxp.com>
X-Virus-Scanned: ClamAV using ClamSMTP
X-Mailman-Approved-At: Fri, 21 Jun 2019 07:22:42 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Robert Chiras <robert.chiras@nxp.com>, devicetree@vger.kernel.org,
 linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org,
 linux-imx@nxp.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBwYXRjaCBhZGRzIFJheWRpdW0gUk02NzE5MSBURlQgTENEIHBhbmVsIGRyaXZlciAoTUlQ
SS1EU0kKcHJvdG9jb2wpLgoKU2lnbmVkLW9mZi1ieTogUm9iZXJ0IENoaXJhcyA8cm9iZXJ0LmNo
aXJhc0BueHAuY29tPgpSZXZpZXdlZC1ieTogU2FtIFJhdm5ib3JnIDxzYW1AcmF2bmJvcmcub3Jn
PgotLS0KIE1BSU5UQUlORVJTICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAg
NiArCiBkcml2ZXJzL2dwdS9kcm0vcGFuZWwvS2NvbmZpZyAgICAgICAgICAgICAgICAgfCAgIDkg
KwogZHJpdmVycy9ncHUvZHJtL3BhbmVsL01ha2VmaWxlICAgICAgICAgICAgICAgIHwgICAxICsK
IGRyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1yYXlkaXVtLXJtNjcxOTEuYyB8IDY5MCArKysr
KysrKysrKysrKysrKysrKysrKysrKwogNCBmaWxlcyBjaGFuZ2VkLCA3MDYgaW5zZXJ0aW9ucygr
KQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1yYXlkaXVt
LXJtNjcxOTEuYwoKZGlmZiAtLWdpdCBhL01BSU5UQUlORVJTIGIvTUFJTlRBSU5FUlMKaW5kZXgg
N2EyZjQ4Ny4uY2Q5MzAzMGUgMTAwNjQ0Ci0tLSBhL01BSU5UQUlORVJTCisrKyBiL01BSU5UQUlO
RVJTCkBAIC01MDg5LDYgKzUwODksMTIgQEAgUzoJTWFpbnRhaW5lZAogRjoJZHJpdmVycy9ncHUv
ZHJtL3F4bC8KIEY6CWluY2x1ZGUvdWFwaS9kcm0vcXhsX2RybS5oCiAKK0RSTSBEUklWRVIgRk9S
IFJBWURJVU0gUk02NzE5MSBQQU5FTFMKK006CVJvYmVydCBDaGlyYXMgPHJvYmVydC5jaGlyYXNA
bnhwLmNvbT4KK1M6CU1haW50YWluZWQKK0Y6CWRyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1y
YXlkaXVtLXJtNjcxOTEuYworRjoJRG9jdW1lbnRhdGlvbi9kZXZpY2V0cmVlL2JpbmRpbmdzL2Rp
c3BsYXkvcGFuZWwvcmF5ZGl1bSxybTY3MTkxLnR4dAorCiBEUk0gRFJJVkVSIEZPUiBSQUdFIDEy
OCBWSURFTyBDQVJEUwogUzoJT3JwaGFuIC8gT2Jzb2xldGUKIEY6CWRyaXZlcnMvZ3B1L2RybS9y
MTI4LwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmVsL0tjb25maWcgYi9kcml2ZXJz
L2dwdS9kcm0vcGFuZWwvS2NvbmZpZwppbmRleCBkOWQ5MzFhLi44YmUxYWMxIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvS2NvbmZpZworKysgYi9kcml2ZXJzL2dwdS9kcm0vcGFu
ZWwvS2NvbmZpZwpAQCAtMTU5LDYgKzE1OSwxNSBAQCBjb25maWcgRFJNX1BBTkVMX1JBU1BCRVJS
WVBJX1RPVUNIU0NSRUVOCiAJICBQaSA3IiBUb3VjaHNjcmVlbi4gIFRvIGNvbXBpbGUgdGhpcyBk
cml2ZXIgYXMgYSBtb2R1bGUsCiAJICBjaG9vc2UgTSBoZXJlLgogCitjb25maWcgRFJNX1BBTkVM
X1JBWURJVU1fUk02NzE5MQorCXRyaXN0YXRlICJSYXlkaXVtIFJNNjcxOTEgRkhEIDEwODB4MTky
MCBEU0kgdmlkZW8gbW9kZSBwYW5lbCIKKwlkZXBlbmRzIG9uIE9GCisJZGVwZW5kcyBvbiBEUk1f
TUlQSV9EU0kKKwlkZXBlbmRzIG9uIEJBQ0tMSUdIVF9DTEFTU19ERVZJQ0UKKwloZWxwCisJICBT
YXkgWSBoZXJlIGlmIHlvdSB3YW50IHRvIGVuYWJsZSBzdXBwb3J0IGZvciBSYXlkaXVtIFJNNjcx
OTEgRkhECisJICAoMTA4MHgxOTIwKSBEU0kgcGFuZWwuCisKIGNvbmZpZyBEUk1fUEFORUxfUkFZ
RElVTV9STTY4MjAwCiAJdHJpc3RhdGUgIlJheWRpdW0gUk02ODIwMCA3MjB4MTI4MCBEU0kgdmlk
ZW8gbW9kZSBwYW5lbCIKIAlkZXBlbmRzIG9uIE9GCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vcGFuZWwvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvTWFrZWZpbGUKaW5kZXgg
ZmIwY2IzYS4uMWZjMGY2OCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3BhbmVsL01ha2Vm
aWxlCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9NYWtlZmlsZQpAQCAtMTQsNiArMTQsNyBA
QCBvYmotJChDT05GSUdfRFJNX1BBTkVMX09SSVNFVEVDSF9PVE04MDA5QSkgKz0gcGFuZWwtb3Jp
c2V0ZWNoLW90bTgwMDlhLm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfT1NEX09TRDEwMVQyNTg3
XzUzVFMpICs9IHBhbmVsLW9zZC1vc2QxMDF0MjU4Ny01M3RzLm8KIG9iai0kKENPTkZJR19EUk1f
UEFORUxfUEFOQVNPTklDX1ZWWDEwRjAzNE4wMCkgKz0gcGFuZWwtcGFuYXNvbmljLXZ2eDEwZjAz
NG4wMC5vCiBvYmotJChDT05GSUdfRFJNX1BBTkVMX1JBU1BCRVJSWVBJX1RPVUNIU0NSRUVOKSAr
PSBwYW5lbC1yYXNwYmVycnlwaS10b3VjaHNjcmVlbi5vCitvYmotJChDT05GSUdfRFJNX1BBTkVM
X1JBWURJVU1fUk02NzE5MSkgKz0gcGFuZWwtcmF5ZGl1bS1ybTY3MTkxLm8KIG9iai0kKENPTkZJ
R19EUk1fUEFORUxfUkFZRElVTV9STTY4MjAwKSArPSBwYW5lbC1yYXlkaXVtLXJtNjgyMDAubwog
b2JqLSQoQ09ORklHX0RSTV9QQU5FTF9ST0NLVEVDSF9KSDA1N04wMDkwMCkgKz0gcGFuZWwtcm9j
a3RlY2gtamgwNTduMDA5MDAubwogb2JqLSQoQ09ORklHX0RSTV9QQU5FTF9ST05CT19SQjA3MEQz
MCkgKz0gcGFuZWwtcm9uYm8tcmIwNzBkMzAubwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L3BhbmVsL3BhbmVsLXJheWRpdW0tcm02NzE5MS5jIGIvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3Bh
bmVsLXJheWRpdW0tcm02NzE5MS5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAu
LmM0ZDdkZmQKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvcGFuZWwt
cmF5ZGl1bS1ybTY3MTkxLmMKQEAgLTAsMCArMSw2OTAgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVu
dGlmaWVyOiBHUEwtMi4wCisvKgorICogUmF5ZGl1bSBSTTY3MTkxIE1JUEktRFNJIHBhbmVsIGRy
aXZlcgorICoKKyAqIENvcHlyaWdodCAyMDE5IE5YUAorICovCisKKyNpbmNsdWRlIDxsaW51eC9i
YWNrbGlnaHQuaD4KKyNpbmNsdWRlIDxsaW51eC9kZWxheS5oPgorI2luY2x1ZGUgPGxpbnV4L2dw
aW8vY29uc3VtZXIuaD4KKyNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KKyNpbmNsdWRlIDxsaW51
eC9vZi5oPgorI2luY2x1ZGUgPGxpbnV4L3JlZ3VsYXRvci9jb25zdW1lci5oPgorCisjaW5jbHVk
ZSA8dmlkZW8vbWlwaV9kaXNwbGF5Lmg+CisjaW5jbHVkZSA8dmlkZW8vb2ZfdmlkZW9tb2RlLmg+
CisjaW5jbHVkZSA8dmlkZW8vdmlkZW9tb2RlLmg+CisKKyNpbmNsdWRlIDxkcm0vZHJtX2NydGMu
aD4KKyNpbmNsdWRlIDxkcm0vZHJtX21pcGlfZHNpLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wYW5l
bC5oPgorI2luY2x1ZGUgPGRybS9kcm1fcHJpbnQuaD4KKworLyogUGFuZWwgc3BlY2lmaWMgY29s
b3ItZm9ybWF0IGJpdHMgKi8KKyNkZWZpbmUgQ09MX0ZNVF8xNkJQUCAweDU1CisjZGVmaW5lIENP
TF9GTVRfMThCUFAgMHg2NgorI2RlZmluZSBDT0xfRk1UXzI0QlBQIDB4NzcKKworLyogV3JpdGUg
TWFudWZhY3R1cmUgQ29tbWFuZCBTZXQgQ29udHJvbCAqLworI2RlZmluZSBXUk1BVUNDVFIgMHhG
RQorCisvKiBNYW51ZmFjdHVyZXIgQ29tbWFuZCBTZXQgcGFnZXMgKENNRDIpICovCitzdHJ1Y3Qg
Y21kX3NldF9lbnRyeSB7CisJdTggY21kOworCXU4IHBhcmFtOworfTsKKworLyoKKyAqIFRoZXJl
IGlzIG5vIGRlc2NyaXB0aW9uIGluIHRoZSBSZWZlcmVuY2UgTWFudWFsIGFib3V0IHRoZXNlIGNv
bW1hbmRzLgorICogV2UgcmVjZWl2ZWQgdGhlbSBmcm9tIHZlbmRvciwgc28ganVzdCB1c2UgdGhl
bSBhcyBpcy4KKyAqLworc3RhdGljIGNvbnN0IHN0cnVjdCBjbWRfc2V0X2VudHJ5IG1hbnVmYWN0
dXJlcl9jbWRfc2V0W10gPSB7CisJezB4RkUsIDB4MEJ9LAorCXsweDI4LCAweDQwfSwKKwl7MHgy
OSwgMHg0Rn0sCisJezB4RkUsIDB4MEV9LAorCXsweDRCLCAweDAwfSwKKwl7MHg0QywgMHgwRn0s
CisJezB4NEQsIDB4MjB9LAorCXsweDRFLCAweDQwfSwKKwl7MHg0RiwgMHg2MH0sCisJezB4NTAs
IDB4QTB9LAorCXsweDUxLCAweEMwfSwKKwl7MHg1MiwgMHhFMH0sCisJezB4NTMsIDB4RkZ9LAor
CXsweEZFLCAweDBEfSwKKwl7MHgxOCwgMHgwOH0sCisJezB4NDIsIDB4MDB9LAorCXsweDA4LCAw
eDQxfSwKKwl7MHg0NiwgMHgwMn0sCisJezB4NzIsIDB4MDl9LAorCXsweEZFLCAweDBBfSwKKwl7
MHgyNCwgMHgxN30sCisJezB4MDQsIDB4MDd9LAorCXsweDFBLCAweDBDfSwKKwl7MHgwRiwgMHg0
NH0sCisJezB4RkUsIDB4MDR9LAorCXsweDAwLCAweDBDfSwKKwl7MHgwNSwgMHgwOH0sCisJezB4
MDYsIDB4MDh9LAorCXsweDA4LCAweDA4fSwKKwl7MHgwOSwgMHgwOH0sCisJezB4MEEsIDB4RTZ9
LAorCXsweDBCLCAweDhDfSwKKwl7MHgxQSwgMHgxMn0sCisJezB4MUUsIDB4RTB9LAorCXsweDI5
LCAweDkzfSwKKwl7MHgyQSwgMHg5M30sCisJezB4MkYsIDB4MDJ9LAorCXsweDMxLCAweDAyfSwK
Kwl7MHgzMywgMHgwNX0sCisJezB4MzcsIDB4MkR9LAorCXsweDM4LCAweDJEfSwKKwl7MHgzQSwg
MHgxRX0sCisJezB4M0IsIDB4MUV9LAorCXsweDNELCAweDI3fSwKKwl7MHgzRiwgMHg4MH0sCisJ
ezB4NDAsIDB4NDB9LAorCXsweDQxLCAweEUwfSwKKwl7MHg0RiwgMHgyRn0sCisJezB4NTAsIDB4
MUV9LAorCXsweEZFLCAweDA2fSwKKwl7MHgwMCwgMHhDQ30sCisJezB4MDUsIDB4MDV9LAorCXsw
eDA3LCAweEEyfSwKKwl7MHgwOCwgMHhDQ30sCisJezB4MEQsIDB4MDN9LAorCXsweDBGLCAweEEy
fSwKKwl7MHgzMiwgMHhDQ30sCisJezB4MzcsIDB4MDV9LAorCXsweDM5LCAweDgzfSwKKwl7MHgz
QSwgMHhDQ30sCisJezB4NDEsIDB4MDR9LAorCXsweDQzLCAweDgzfSwKKwl7MHg0NCwgMHhDQ30s
CisJezB4NDksIDB4MDV9LAorCXsweDRCLCAweEEyfSwKKwl7MHg0QywgMHhDQ30sCisJezB4NTEs
IDB4MDN9LAorCXsweDUzLCAweEEyfSwKKwl7MHg3NSwgMHhDQ30sCisJezB4N0EsIDB4MDN9LAor
CXsweDdDLCAweDgzfSwKKwl7MHg3RCwgMHhDQ30sCisJezB4ODIsIDB4MDJ9LAorCXsweDg0LCAw
eDgzfSwKKwl7MHg4NSwgMHhFQ30sCisJezB4ODYsIDB4MEZ9LAorCXsweDg3LCAweEZGfSwKKwl7
MHg4OCwgMHgwMH0sCisJezB4OEEsIDB4MDJ9LAorCXsweDhDLCAweEEyfSwKKwl7MHg4RCwgMHhF
QX0sCisJezB4OEUsIDB4MDF9LAorCXsweDhGLCAweEU4fSwKKwl7MHhGRSwgMHgwNn0sCisJezB4
OTAsIDB4MEF9LAorCXsweDkyLCAweDA2fSwKKwl7MHg5MywgMHhBMH0sCisJezB4OTQsIDB4QTh9
LAorCXsweDk1LCAweEVDfSwKKwl7MHg5NiwgMHgwRn0sCisJezB4OTcsIDB4RkZ9LAorCXsweDk4
LCAweDAwfSwKKwl7MHg5QSwgMHgwMn0sCisJezB4OUMsIDB4QTJ9LAorCXsweEFDLCAweDA0fSwK
Kwl7MHhGRSwgMHgwNn0sCisJezB4QjEsIDB4MTJ9LAorCXsweEIyLCAweDE3fSwKKwl7MHhCMywg
MHgxN30sCisJezB4QjQsIDB4MTd9LAorCXsweEI1LCAweDE3fSwKKwl7MHhCNiwgMHgxMX0sCisJ
ezB4QjcsIDB4MDh9LAorCXsweEI4LCAweDA5fSwKKwl7MHhCOSwgMHgwNn0sCisJezB4QkEsIDB4
MDd9LAorCXsweEJCLCAweDE3fSwKKwl7MHhCQywgMHgxN30sCisJezB4QkQsIDB4MTd9LAorCXsw
eEJFLCAweDE3fSwKKwl7MHhCRiwgMHgxN30sCisJezB4QzAsIDB4MTd9LAorCXsweEMxLCAweDE3
fSwKKwl7MHhDMiwgMHgxN30sCisJezB4QzMsIDB4MTd9LAorCXsweEM0LCAweDBGfSwKKwl7MHhD
NSwgMHgwRX0sCisJezB4QzYsIDB4MDB9LAorCXsweEM3LCAweDAxfSwKKwl7MHhDOCwgMHgxMH0s
CisJezB4RkUsIDB4MDZ9LAorCXsweDk1LCAweEVDfSwKKwl7MHg4RCwgMHhFRX0sCisJezB4NDQs
IDB4RUN9LAorCXsweDRDLCAweEVDfSwKKwl7MHgzMiwgMHhFQ30sCisJezB4M0EsIDB4RUN9LAor
CXsweDdELCAweEVDfSwKKwl7MHg3NSwgMHhFQ30sCisJezB4MDAsIDB4RUN9LAorCXsweDA4LCAw
eEVDfSwKKwl7MHg4NSwgMHhFQ30sCisJezB4QTYsIDB4MjF9LAorCXsweEE3LCAweDA1fSwKKwl7
MHhBOSwgMHgwNn0sCisJezB4ODIsIDB4MDZ9LAorCXsweDQxLCAweDA2fSwKKwl7MHg3QSwgMHgw
N30sCisJezB4MzcsIDB4MDd9LAorCXsweDA1LCAweDA2fSwKKwl7MHg0OSwgMHgwNn0sCisJezB4
MEQsIDB4MDR9LAorCXsweDUxLCAweDA0fSwKK307CisKK3N0YXRpYyBjb25zdCB1MzIgcmFkX2J1
c19mb3JtYXRzW10gPSB7CisJTUVESUFfQlVTX0ZNVF9SR0I4ODhfMVgyNCwKKwlNRURJQV9CVVNf
Rk1UX1JHQjY2Nl8xWDE4LAorCU1FRElBX0JVU19GTVRfUkdCNTY1XzFYMTYsCit9OworCitzdHJ1
Y3QgcmFkX3BhbmVsIHsKKwlzdHJ1Y3QgZHJtX3BhbmVsIHBhbmVsOworCXN0cnVjdCBtaXBpX2Rz
aV9kZXZpY2UgKmRzaTsKKworCXN0cnVjdCBncGlvX2Rlc2MgKnJlc2V0OworCXN0cnVjdCBiYWNr
bGlnaHRfZGV2aWNlICpiYWNrbGlnaHQ7CisKKwlib29sIHByZXBhcmVkOworCWJvb2wgZW5hYmxl
ZDsKKworCXN0cnVjdCB2aWRlb21vZGUgdm07CisJdTMyIHdpZHRoX21tOworCXUzMiBoZWlnaHRf
bW07Cit9OworCitzdGF0aWMgaW5saW5lIHN0cnVjdCByYWRfcGFuZWwgKnRvX3JhZF9wYW5lbChz
dHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKK3sKKwlyZXR1cm4gY29udGFpbmVyX29mKHBhbmVsLCBz
dHJ1Y3QgcmFkX3BhbmVsLCBwYW5lbCk7Cit9CisKK3N0YXRpYyBpbnQgcmFkX3BhbmVsX3B1c2hf
Y21kX2xpc3Qoc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpKQoreworCXNpemVfdCBpOworCXNp
emVfdCBjb3VudCA9IEFSUkFZX1NJWkUobWFudWZhY3R1cmVyX2NtZF9zZXQpOworCWludCByZXQg
PSAwOworCisJZm9yIChpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKKwkJY29uc3Qgc3RydWN0IGNt
ZF9zZXRfZW50cnkgKmVudHJ5ID0gJm1hbnVmYWN0dXJlcl9jbWRfc2V0W2ldOworCQl1OCBidWZm
ZXJbMl0gPSB7IGVudHJ5LT5jbWQsIGVudHJ5LT5wYXJhbSB9OworCisJCXJldCA9IG1pcGlfZHNp
X2dlbmVyaWNfd3JpdGUoZHNpLCAmYnVmZmVyLCBzaXplb2YoYnVmZmVyKSk7CisJCWlmIChyZXQg
PCAwKQorCQkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXR1cm4gcmV0OworfTsKKworc3RhdGljIGlu
dCBjb2xvcl9mb3JtYXRfZnJvbV9kc2lfZm9ybWF0KGVudW0gbWlwaV9kc2lfcGl4ZWxfZm9ybWF0
IGZvcm1hdCkKK3sKKwlzd2l0Y2ggKGZvcm1hdCkgeworCWNhc2UgTUlQSV9EU0lfRk1UX1JHQjU2
NToKKwkJcmV0dXJuIENPTF9GTVRfMTZCUFA7CisJY2FzZSBNSVBJX0RTSV9GTVRfUkdCNjY2Ogor
CWNhc2UgTUlQSV9EU0lfRk1UX1JHQjY2Nl9QQUNLRUQ6CisJCXJldHVybiBDT0xfRk1UXzE4QlBQ
OworCWNhc2UgTUlQSV9EU0lfRk1UX1JHQjg4ODoKKwkJcmV0dXJuIENPTF9GTVRfMjRCUFA7CisJ
ZGVmYXVsdDoKKwkJcmV0dXJuIENPTF9GTVRfMjRCUFA7IC8qIGZvciBiYWNrd2FyZCBjb21wYXRp
YmlsaXR5ICovCisJfQorfTsKKworc3RhdGljIGludCByYWRfcGFuZWxfcHJlcGFyZShzdHJ1Y3Qg
ZHJtX3BhbmVsICpwYW5lbCkKK3sKKwlzdHJ1Y3QgcmFkX3BhbmVsICpyYWQgPSB0b19yYWRfcGFu
ZWwocGFuZWwpOworCisJaWYgKHJhZC0+cHJlcGFyZWQpCisJCXJldHVybiAwOworCisJaWYgKHJh
ZC0+cmVzZXQpIHsKKwkJZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKHJhZC0+cmVzZXQsIDEpOwor
CQl1c2xlZXBfcmFuZ2UoMzAwMCwgNTAwMCk7CisJCWdwaW9kX3NldF92YWx1ZV9jYW5zbGVlcChy
YWQtPnJlc2V0LCAwKTsKKwkJdXNsZWVwX3JhbmdlKDE4MDAwLCAyMDAwMCk7CisJfQorCisJcmFk
LT5wcmVwYXJlZCA9IHRydWU7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCByYWRfcGFu
ZWxfdW5wcmVwYXJlKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQoreworCXN0cnVjdCByYWRfcGFu
ZWwgKnJhZCA9IHRvX3JhZF9wYW5lbChwYW5lbCk7CisKKwlpZiAoIXJhZC0+cHJlcGFyZWQpCisJ
CXJldHVybiAwOworCisJLyoKKwkgKiBSaWdodCBhZnRlciBhc3NlcnRpbmcgdGhlIHJlc2V0LCB3
ZSBuZWVkIHRvIHJlbGVhc2UgaXQsIHNvIHRoYXQgdGhlCisJICogdG91Y2ggZHJpdmVyIGNhbiBo
YXZlIGFuIGFjdGl2ZSBjb25uZWN0aW9uIHdpdGggdGhlIHRvdWNoIGNvbnRyb2xsZXIKKwkgKiBl
dmVuIGFmdGVyIHRoZSBkaXNwbGF5IGlzIHR1cm5lZCBvZmYuCisJICovCisJaWYgKHJhZC0+cmVz
ZXQpIHsKKwkJZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKHJhZC0+cmVzZXQsIDEpOworCQl1c2xl
ZXBfcmFuZ2UoMTUwMDAsIDE3MDAwKTsKKwkJZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKHJhZC0+
cmVzZXQsIDApOworCX0KKworCXJhZC0+cHJlcGFyZWQgPSBmYWxzZTsKKworCXJldHVybiAwOwor
fQorCitzdGF0aWMgaW50IHJhZF9wYW5lbF9lbmFibGUoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwp
Cit7CisJc3RydWN0IHJhZF9wYW5lbCAqcmFkID0gdG9fcmFkX3BhbmVsKHBhbmVsKTsKKwlzdHJ1
Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kgPSByYWQtPmRzaTsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYg
PSAmZHNpLT5kZXY7CisJaW50IGNvbG9yX2Zvcm1hdCA9IGNvbG9yX2Zvcm1hdF9mcm9tX2RzaV9m
b3JtYXQoZHNpLT5mb3JtYXQpOworCWludCByZXQ7CisKKwlpZiAocmFkLT5lbmFibGVkKQorCQly
ZXR1cm4gMDsKKworCWRzaS0+bW9kZV9mbGFncyB8PSBNSVBJX0RTSV9NT0RFX0xQTTsKKworCXJl
dCA9IHJhZF9wYW5lbF9wdXNoX2NtZF9saXN0KGRzaSk7CisJaWYgKHJldCA8IDApIHsKKwkJRFJN
X0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8gc2VuZCBNQ1MgKCVkKVxuIiwgcmV0KTsKKwkJZ290
byBmYWlsOworCX0KKworCS8qIFNlbGVjdCBVc2VyIENvbW1hbmQgU2V0IHRhYmxlIChDTUQxKSAq
LworCXJldCA9IG1pcGlfZHNpX2dlbmVyaWNfd3JpdGUoZHNpLCAodThbXSl7IFdSTUFVQ0NUUiwg
MHgwMCB9LCAyKTsKKwlpZiAocmV0IDwgMCkKKwkJZ290byBmYWlsOworCisJLyogU29mdHdhcmUg
cmVzZXQgKi8KKwlyZXQgPSBtaXBpX2RzaV9kY3Nfc29mdF9yZXNldChkc2kpOworCWlmIChyZXQg
PCAwKSB7CisJCURSTV9ERVZfRVJST1IoZGV2LCAiRmFpbGVkIHRvIGRvIFNvZnR3YXJlIFJlc2V0
ICglZClcbiIsIHJldCk7CisJCWdvdG8gZmFpbDsKKwl9CisKKwl1c2xlZXBfcmFuZ2UoMTUwMDAs
IDE3MDAwKTsKKworCS8qIFNldCBEU0kgbW9kZSAqLworCXJldCA9IG1pcGlfZHNpX2dlbmVyaWNf
d3JpdGUoZHNpLCAodThbXSl7IDB4QzIsIDB4MEIgfSwgMik7CisJaWYgKHJldCA8IDApIHsKKwkJ
RFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8gc2V0IERTSSBtb2RlICglZClcbiIsIHJldCk7
CisJCWdvdG8gZmFpbDsKKwl9CisJLyogU2V0IHRlYXIgT04gKi8KKwlyZXQgPSBtaXBpX2RzaV9k
Y3Nfc2V0X3RlYXJfb24oZHNpLCBNSVBJX0RTSV9EQ1NfVEVBUl9NT0RFX1ZCTEFOSyk7CisJaWYg
KHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8gc2V0IHRlYXIgT04g
KCVkKVxuIiwgcmV0KTsKKwkJZ290byBmYWlsOworCX0KKwkvKiBTZXQgdGVhciBzY2FubGluZSAq
LworCXJldCA9IG1pcGlfZHNpX2Rjc19zZXRfdGVhcl9zY2FubGluZShkc2ksIDB4MzgwKTsKKwlp
ZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGRldiwgIkZhaWxlZCB0byBzZXQgdGVhciBz
Y2FubGluZSAoJWQpXG4iLCByZXQpOworCQlnb3RvIGZhaWw7CisJfQorCS8qIFNldCBwaXhlbCBm
b3JtYXQgKi8KKwlyZXQgPSBtaXBpX2RzaV9kY3Nfc2V0X3BpeGVsX2Zvcm1hdChkc2ksIGNvbG9y
X2Zvcm1hdCk7CisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiSW50ZXJmYWNlIGNvbG9yIGZv
cm1hdCBzZXQgdG8gMHgleFxuIiwKKwkJCSAgICAgY29sb3JfZm9ybWF0KTsKKwlpZiAocmV0IDwg
MCkgeworCQlEUk1fREVWX0VSUk9SKGRldiwgIkZhaWxlZCB0byBzZXQgcGl4ZWwgZm9ybWF0ICgl
ZClcbiIsIHJldCk7CisJCWdvdG8gZmFpbDsKKwl9CisJLyogRXhpdCBzbGVlcCBtb2RlICovCisJ
cmV0ID0gbWlwaV9kc2lfZGNzX2V4aXRfc2xlZXBfbW9kZShkc2kpOworCWlmIChyZXQgPCAwKSB7
CisJCURSTV9ERVZfRVJST1IoZGV2LCAiRmFpbGVkIHRvIGV4aXQgc2xlZXAgbW9kZSAoJWQpXG4i
LCByZXQpOworCQlnb3RvIGZhaWw7CisJfQorCisJdXNsZWVwX3JhbmdlKDUwMDAsIDcwMDApOwor
CisJcmV0ID0gbWlwaV9kc2lfZGNzX3NldF9kaXNwbGF5X29uKGRzaSk7CisJaWYgKHJldCA8IDAp
IHsKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8gc2V0IGRpc3BsYXkgT04gKCVkKVxu
IiwgcmV0KTsKKwkJZ290byBmYWlsOworCX0KKworCWJhY2tsaWdodF9lbmFibGUocmFkLT5iYWNr
bGlnaHQpOworCisJcmFkLT5lbmFibGVkID0gdHJ1ZTsKKworCXJldHVybiAwOworCitmYWlsOgor
CWlmIChyYWQtPnJlc2V0KQorCQlncGlvZF9zZXRfdmFsdWVfY2Fuc2xlZXAocmFkLT5yZXNldCwg
MSk7CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IHJhZF9wYW5lbF9kaXNhYmxlKHN0
cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQoreworCXN0cnVjdCByYWRfcGFuZWwgKnJhZCA9IHRvX3Jh
ZF9wYW5lbChwYW5lbCk7CisJc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpID0gcmFkLT5kc2k7
CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmRzaS0+ZGV2OworCWludCByZXQ7CisKKwlpZiAoIXJh
ZC0+ZW5hYmxlZCkKKwkJcmV0dXJuIDA7CisKKwlkc2ktPm1vZGVfZmxhZ3MgfD0gTUlQSV9EU0lf
TU9ERV9MUE07CisKKwliYWNrbGlnaHRfZGlzYWJsZShyYWQtPmJhY2tsaWdodCk7CisKKwl1c2xl
ZXBfcmFuZ2UoMTAwMDAsIDEyMDAwKTsKKworCXJldCA9IG1pcGlfZHNpX2Rjc19zZXRfZGlzcGxh
eV9vZmYoZHNpKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGRldiwgIkZhaWxl
ZCB0byBzZXQgZGlzcGxheSBPRkYgKCVkKVxuIiwgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisK
Kwl1c2xlZXBfcmFuZ2UoNTAwMCwgMTAwMDApOworCisJcmV0ID0gbWlwaV9kc2lfZGNzX2VudGVy
X3NsZWVwX21vZGUoZHNpKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGRldiwg
IkZhaWxlZCB0byBlbnRlciBzbGVlcCBtb2RlICglZClcbiIsIHJldCk7CisJCXJldHVybiByZXQ7
CisJfQorCisJcmFkLT5lbmFibGVkID0gZmFsc2U7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGlj
IGludCByYWRfcGFuZWxfZ2V0X21vZGVzKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQoreworCXN0
cnVjdCByYWRfcGFuZWwgKnJhZCA9IHRvX3JhZF9wYW5lbChwYW5lbCk7CisJc3RydWN0IGRldmlj
ZSAqZGV2ID0gJnJhZC0+ZHNpLT5kZXY7CisJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3Rv
ciA9IHBhbmVsLT5jb25uZWN0b3I7CisJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGU7CisJ
dTMyICpidXNfZmxhZ3MgPSAmY29ubmVjdG9yLT5kaXNwbGF5X2luZm8uYnVzX2ZsYWdzOworCisJ
bW9kZSA9IGRybV9tb2RlX2NyZWF0ZShjb25uZWN0b3ItPmRldik7CisJaWYgKCFtb2RlKSB7CisJ
CURSTV9ERVZfRVJST1IoZGV2LCAiRmFpbGVkIHRvIGNyZWF0ZSBkaXNwbGF5IG1vZGUhXG4iKTsK
KwkJcmV0dXJuIDA7CisJfQorCisJZHJtX2Rpc3BsYXlfbW9kZV9mcm9tX3ZpZGVvbW9kZSgmcmFk
LT52bSwgbW9kZSk7CisJbW9kZS0+d2lkdGhfbW0gPSByYWQtPndpZHRoX21tOworCW1vZGUtPmhl
aWdodF9tbSA9IHJhZC0+aGVpZ2h0X21tOworCWNvbm5lY3Rvci0+ZGlzcGxheV9pbmZvLndpZHRo
X21tID0gcmFkLT53aWR0aF9tbTsKKwljb25uZWN0b3ItPmRpc3BsYXlfaW5mby5oZWlnaHRfbW0g
PSByYWQtPmhlaWdodF9tbTsKKwltb2RlLT50eXBlID0gRFJNX01PREVfVFlQRV9EUklWRVIgfCBE
Uk1fTU9ERV9UWVBFX1BSRUZFUlJFRDsKKworCWlmIChyYWQtPnZtLmZsYWdzICYgRElTUExBWV9G
TEFHU19ERV9ISUdIKQorCQkqYnVzX2ZsYWdzIHw9IERSTV9CVVNfRkxBR19ERV9ISUdIOworCWlm
IChyYWQtPnZtLmZsYWdzICYgRElTUExBWV9GTEFHU19ERV9MT1cpCisJCSpidXNfZmxhZ3MgfD0g
RFJNX0JVU19GTEFHX0RFX0xPVzsKKwlpZiAocmFkLT52bS5mbGFncyAmIERJU1BMQVlfRkxBR1Nf
UElYREFUQV9ORUdFREdFKQorCQkqYnVzX2ZsYWdzIHw9IERSTV9CVVNfRkxBR19QSVhEQVRBX05F
R0VER0U7CisJaWYgKHJhZC0+dm0uZmxhZ3MgJiBESVNQTEFZX0ZMQUdTX1BJWERBVEFfUE9TRURH
RSkKKwkJKmJ1c19mbGFncyB8PSBEUk1fQlVTX0ZMQUdfUElYREFUQV9QT1NFREdFOworCisJZHJt
X21vZGVfcHJvYmVkX2FkZChwYW5lbC0+Y29ubmVjdG9yLCBtb2RlKTsKKworCWRybV9kaXNwbGF5
X2luZm9fc2V0X2J1c19mb3JtYXRzKCZjb25uZWN0b3ItPmRpc3BsYXlfaW5mbywKKwkJCQkJIHJh
ZF9idXNfZm9ybWF0cywKKwkJCQkJIEFSUkFZX1NJWkUocmFkX2J1c19mb3JtYXRzKSk7CisJcmV0
dXJuIDE7Cit9CisKK3N0YXRpYyBpbnQgcmFkX2JsX2dldF9icmlnaHRuZXNzKHN0cnVjdCBiYWNr
bGlnaHRfZGV2aWNlICpibCkKK3sKKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kgPSBibF9n
ZXRfZGF0YShibCk7CisJc3RydWN0IHJhZF9wYW5lbCAqcmFkID0gbWlwaV9kc2lfZ2V0X2RydmRh
dGEoZHNpKTsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmZHNpLT5kZXY7CisJdTE2IGJyaWdodG5l
c3M7CisJaW50IHJldDsKKworCWlmICghcmFkLT5wcmVwYXJlZCkKKwkJcmV0dXJuIDA7CisKKwlE
Uk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJcbiIpOworCisJZHNpLT5tb2RlX2ZsYWdzICY9IH5N
SVBJX0RTSV9NT0RFX0xQTTsKKworCXJldCA9IG1pcGlfZHNpX2Rjc19nZXRfZGlzcGxheV9icmln
aHRuZXNzKGRzaSwgJmJyaWdodG5lc3MpOworCWlmIChyZXQgPCAwKQorCQlyZXR1cm4gcmV0Owor
CisJYmwtPnByb3BzLmJyaWdodG5lc3MgPSBicmlnaHRuZXNzOworCisJcmV0dXJuIGJyaWdodG5l
c3MgJiAweGZmOworfQorCitzdGF0aWMgaW50IHJhZF9ibF91cGRhdGVfc3RhdHVzKHN0cnVjdCBi
YWNrbGlnaHRfZGV2aWNlICpibCkKK3sKKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kgPSBi
bF9nZXRfZGF0YShibCk7CisJc3RydWN0IHJhZF9wYW5lbCAqcmFkID0gbWlwaV9kc2lfZ2V0X2Ry
dmRhdGEoZHNpKTsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmZHNpLT5kZXY7CisJaW50IHJldCA9
IDA7CisKKwlpZiAoIXJhZC0+cHJlcGFyZWQpCisJCXJldHVybiAwOworCisJRFJNX0RFVl9ERUJV
R19EUklWRVIoZGV2LCAiTmV3IGJyaWdodG5lc3M6ICVkXG4iLCBibC0+cHJvcHMuYnJpZ2h0bmVz
cyk7CisKKwlkc2ktPm1vZGVfZmxhZ3MgJj0gfk1JUElfRFNJX01PREVfTFBNOworCisJcmV0ID0g
bWlwaV9kc2lfZGNzX3NldF9kaXNwbGF5X2JyaWdodG5lc3MoZHNpLCBibC0+cHJvcHMuYnJpZ2h0
bmVzcyk7CisJaWYgKHJldCA8IDApCisJCXJldHVybiByZXQ7CisKKwlyZXR1cm4gMDsKK30KKwor
c3RhdGljIGNvbnN0IHN0cnVjdCBiYWNrbGlnaHRfb3BzIHJhZF9ibF9vcHMgPSB7CisJLnVwZGF0
ZV9zdGF0dXMgPSByYWRfYmxfdXBkYXRlX3N0YXR1cywKKwkuZ2V0X2JyaWdodG5lc3MgPSByYWRf
YmxfZ2V0X2JyaWdodG5lc3MsCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9wYW5lbF9m
dW5jcyByYWRfcGFuZWxfZnVuY3MgPSB7CisJLnByZXBhcmUgPSByYWRfcGFuZWxfcHJlcGFyZSwK
KwkudW5wcmVwYXJlID0gcmFkX3BhbmVsX3VucHJlcGFyZSwKKwkuZW5hYmxlID0gcmFkX3BhbmVs
X2VuYWJsZSwKKwkuZGlzYWJsZSA9IHJhZF9wYW5lbF9kaXNhYmxlLAorCS5nZXRfbW9kZXMgPSBy
YWRfcGFuZWxfZ2V0X21vZGVzLAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkaXNwbGF5X3Rp
bWluZyByYWRfZGVmYXVsdF90aW1pbmcgPSB7CisJLnBpeGVsY2xvY2sgPSB7IDEzMjAwMDAwMCwg
MTMyMDAwMDAwLCAxMzIwMDAwMDAgfSwKKwkuaGFjdGl2ZSA9IHsgMTA4MCwgMTA4MCwgMTA4MCB9
LAorCS5oZnJvbnRfcG9yY2ggPSB7IDIwLCAyMCwgMjAgfSwKKwkuaHN5bmNfbGVuID0geyAyLCAy
LCAyIH0sCisJLmhiYWNrX3BvcmNoID0geyAzNCwgMzQsIDM0IH0sCisJLnZhY3RpdmUgPSB7IDE5
MjAsIDE5MjAsIDE5MjAgfSwKKwkudmZyb250X3BvcmNoID0geyAxMCwgMTAsIDEwIH0sCisJLnZz
eW5jX2xlbiA9IHsgMiwgMiwgMiB9LAorCS52YmFja19wb3JjaCA9IHsgNCwgNCwgNCB9LAorCS5m
bGFncyA9IERJU1BMQVlfRkxBR1NfSFNZTkNfTE9XIHwKKwkJIERJU1BMQVlfRkxBR1NfVlNZTkNf
TE9XIHwKKwkJIERJU1BMQVlfRkxBR1NfREVfTE9XIHwKKwkJIERJU1BMQVlfRkxBR1NfUElYREFU
QV9ORUdFREdFLAorfTsKKworc3RhdGljIGludCByYWRfcGFuZWxfcHJvYmUoc3RydWN0IG1pcGlf
ZHNpX2RldmljZSAqZHNpKQoreworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZkc2ktPmRldjsKKwlz
dHJ1Y3QgZGV2aWNlX25vZGUgKm5wID0gZGV2LT5vZl9ub2RlOworCXN0cnVjdCByYWRfcGFuZWwg
KnBhbmVsOworCXN0cnVjdCBiYWNrbGlnaHRfcHJvcGVydGllcyBibF9wcm9wczsKKwlpbnQgcmV0
OworCXUzMiB2aWRlb19tb2RlOworCisJcGFuZWwgPSBkZXZtX2t6YWxsb2MoJmRzaS0+ZGV2LCBz
aXplb2YoKnBhbmVsKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFwYW5lbCkKKwkJcmV0dXJuIC1FTk9N
RU07CisKKwltaXBpX2RzaV9zZXRfZHJ2ZGF0YShkc2ksIHBhbmVsKTsKKworCXBhbmVsLT5kc2kg
PSBkc2k7CisKKwlkc2ktPmZvcm1hdCA9IE1JUElfRFNJX0ZNVF9SR0I4ODg7CisJZHNpLT5tb2Rl
X2ZsYWdzID0gIE1JUElfRFNJX01PREVfVklERU9fSFNFIHwgTUlQSV9EU0lfTU9ERV9WSURFTyB8
CisJCQkgICBNSVBJX0RTSV9DTE9DS19OT05fQ09OVElOVU9VUzsKKworCXJldCA9IG9mX3Byb3Bl
cnR5X3JlYWRfdTMyKG5wLCAidmlkZW8tbW9kZSIsICZ2aWRlb19tb2RlKTsKKwlpZiAoIXJldCkg
eworCQlzd2l0Y2ggKHZpZGVvX21vZGUpIHsKKwkJY2FzZSAwOgorCQkJLyogYnVyc3QgbW9kZSAq
LworCQkJZHNpLT5tb2RlX2ZsYWdzIHw9IE1JUElfRFNJX01PREVfVklERU9fQlVSU1Q7CisJCQli
cmVhazsKKwkJY2FzZSAxOgorCQkJLyogbm9uLWJ1cnN0IG1vZGUgd2l0aCBzeW5jIGV2ZW50ICov
CisJCQlicmVhazsKKwkJY2FzZSAyOgorCQkJLyogbm9uLWJ1cnN0IG1vZGUgd2l0aCBzeW5jIHB1
bHNlICovCisJCQlkc2ktPm1vZGVfZmxhZ3MgfD0gTUlQSV9EU0lfTU9ERV9WSURFT19TWU5DX1BV
TFNFOworCQkJYnJlYWs7CisJCWRlZmF1bHQ6CisJCQlkZXZfd2FybihkZXYsICJpbnZhbGlkIHZp
ZGVvIG1vZGUgJWRcbiIsIHZpZGVvX21vZGUpOworCQkJYnJlYWs7CisJCX0KKwl9CisKKwlyZXQg
PSBvZl9wcm9wZXJ0eV9yZWFkX3UzMihucCwgImRzaS1sYW5lcyIsICZkc2ktPmxhbmVzKTsKKwlp
ZiAocmV0IDwgMCkgeworCQlkZXZfZXJyKGRldiwgIkZhaWxlZCB0byBnZXQgZHNpLWxhbmVzIHBy
b3BlcnR5ICglZClcbiIsIHJldCk7CisJCXJldHVybiByZXQ7CisJfQorCisJdmlkZW9tb2RlX2Zy
b21fdGltaW5nKCZyYWRfZGVmYXVsdF90aW1pbmcsICZwYW5lbC0+dm0pOworCisJb2ZfcHJvcGVy
dHlfcmVhZF91MzIobnAsICJ3aWR0aC1tbSIsICZwYW5lbC0+d2lkdGhfbW0pOworCW9mX3Byb3Bl
cnR5X3JlYWRfdTMyKG5wLCAiaGVpZ2h0LW1tIiwgJnBhbmVsLT5oZWlnaHRfbW0pOworCisJcGFu
ZWwtPnJlc2V0ID0gZGV2bV9ncGlvZF9nZXQoZGV2LCAicmVzZXQiLCBHUElPRF9PVVRfTE9XKTsK
KworCWlmIChJU19FUlIocGFuZWwtPnJlc2V0KSkKKwkJcGFuZWwtPnJlc2V0ID0gTlVMTDsKKwll
bHNlCisJCWdwaW9kX3NldF92YWx1ZV9jYW5zbGVlcChwYW5lbC0+cmVzZXQsIDEpOworCisJbWVt
c2V0KCZibF9wcm9wcywgMCwgc2l6ZW9mKGJsX3Byb3BzKSk7CisJYmxfcHJvcHMudHlwZSA9IEJB
Q0tMSUdIVF9SQVc7CisJYmxfcHJvcHMuYnJpZ2h0bmVzcyA9IDI1NTsKKwlibF9wcm9wcy5tYXhf
YnJpZ2h0bmVzcyA9IDI1NTsKKworCXBhbmVsLT5iYWNrbGlnaHQgPSBkZXZtX2JhY2tsaWdodF9k
ZXZpY2VfcmVnaXN0ZXIoZGV2LCBkZXZfbmFtZShkZXYpLAorCQkJCQkJCSAgZGV2LCBkc2ksCisJ
CQkJCQkJICAmcmFkX2JsX29wcywKKwkJCQkJCQkgICZibF9wcm9wcyk7CisJaWYgKElTX0VSUihw
YW5lbC0+YmFja2xpZ2h0KSkgeworCQlyZXQgPSBQVFJfRVJSKHBhbmVsLT5iYWNrbGlnaHQpOwor
CQlkZXZfZXJyKGRldiwgIkZhaWxlZCB0byByZWdpc3RlciBiYWNrbGlnaHQgKCVkKVxuIiwgcmV0
KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlkcm1fcGFuZWxfaW5pdCgmcGFuZWwtPnBhbmVsKTsK
KwlwYW5lbC0+cGFuZWwuZnVuY3MgPSAmcmFkX3BhbmVsX2Z1bmNzOworCXBhbmVsLT5wYW5lbC5k
ZXYgPSBkZXY7CisJZGV2X3NldF9kcnZkYXRhKGRldiwgcGFuZWwpOworCisJcmV0ID0gZHJtX3Bh
bmVsX2FkZCgmcGFuZWwtPnBhbmVsKTsKKworCWlmIChyZXQgPCAwKQorCQlyZXR1cm4gcmV0Owor
CisJcmV0ID0gbWlwaV9kc2lfYXR0YWNoKGRzaSk7CisJaWYgKHJldCA8IDApCisJCWRybV9wYW5l
bF9yZW1vdmUoJnBhbmVsLT5wYW5lbCk7CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50
IHJhZF9wYW5lbF9yZW1vdmUoc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpKQoreworCXN0cnVj
dCByYWRfcGFuZWwgKnJhZCA9IG1pcGlfZHNpX2dldF9kcnZkYXRhKGRzaSk7CisJc3RydWN0IGRl
dmljZSAqZGV2ID0gJmRzaS0+ZGV2OworCWludCByZXQ7CisKKwlyZXQgPSBtaXBpX2RzaV9kZXRh
Y2goZHNpKTsKKwlpZiAocmV0IDwgMCkKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8g
ZGV0YWNoIGZyb20gaG9zdCAoJWQpXG4iLAorCQkJICAgICAgcmV0KTsKKworCWRybV9wYW5lbF9y
ZW1vdmUoJnJhZC0+cGFuZWwpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIHJhZF9w
YW5lbF9zaHV0ZG93bihzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kpCit7CisJc3RydWN0IHJh
ZF9wYW5lbCAqcmFkID0gbWlwaV9kc2lfZ2V0X2RydmRhdGEoZHNpKTsKKworCXJhZF9wYW5lbF9k
aXNhYmxlKCZyYWQtPnBhbmVsKTsKKwlyYWRfcGFuZWxfdW5wcmVwYXJlKCZyYWQtPnBhbmVsKTsK
K30KKworc3RhdGljIGludCBfX21heWJlX3VudXNlZCByYWRfcGFuZWxfc3VzcGVuZChzdHJ1Y3Qg
ZGV2aWNlICpkZXYpCit7CisJc3RydWN0IHJhZF9wYW5lbCAqcmFkID0gZGV2X2dldF9kcnZkYXRh
KGRldik7CisKKwlpZiAoIXJhZC0+cmVzZXQpCisJCXJldHVybiAwOworCisJZGV2bV9ncGlvZF9w
dXQoZGV2LCByYWQtPnJlc2V0KTsKKwlyYWQtPnJlc2V0ID0gTlVMTDsKKworCXJldHVybiAwOwor
fQorCitzdGF0aWMgaW50IF9fbWF5YmVfdW51c2VkIHJhZF9wYW5lbF9yZXN1bWUoc3RydWN0IGRl
dmljZSAqZGV2KQoreworCXN0cnVjdCByYWRfcGFuZWwgKnJhZCA9IGRldl9nZXRfZHJ2ZGF0YShk
ZXYpOworCisJaWYgKHJhZC0+cmVzZXQpCisJCXJldHVybiAwOworCisJcmFkLT5yZXNldCA9IGRl
dm1fZ3Bpb2RfZ2V0KGRldiwgInJlc2V0IiwgR1BJT0RfT1VUX0xPVyk7CisJaWYgKElTX0VSUihy
YWQtPnJlc2V0KSkKKwkJcmFkLT5yZXNldCA9IE5VTEw7CisKKwlyZXR1cm4gUFRSX0VSUl9PUl9a
RVJPKHJhZC0+cmVzZXQpOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRldl9wbV9vcHMgcmFk
X3BtX29wcyA9IHsKKwlTRVRfUlVOVElNRV9QTV9PUFMocmFkX3BhbmVsX3N1c3BlbmQsIHJhZF9w
YW5lbF9yZXN1bWUsIE5VTEwpCisJU0VUX1NZU1RFTV9TTEVFUF9QTV9PUFMocmFkX3BhbmVsX3N1
c3BlbmQsIHJhZF9wYW5lbF9yZXN1bWUpCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IG9mX2Rl
dmljZV9pZCByYWRfb2ZfbWF0Y2hbXSA9IHsKKwl7IC5jb21wYXRpYmxlID0gInJheWRpdW0scm02
NzE5MSIsIH0sCisJeyAvKiBzZW50aW5lbCAqLyB9Cit9OworTU9EVUxFX0RFVklDRV9UQUJMRShv
ZiwgcmFkX29mX21hdGNoKTsKKworc3RhdGljIHN0cnVjdCBtaXBpX2RzaV9kcml2ZXIgcmFkX3Bh
bmVsX2RyaXZlciA9IHsKKwkuZHJpdmVyID0geworCQkubmFtZSA9ICJwYW5lbC1yYXlkaXVtLXJt
NjcxOTEiLAorCQkub2ZfbWF0Y2hfdGFibGUgPSByYWRfb2ZfbWF0Y2gsCisJCS5wbQk9ICZyYWRf
cG1fb3BzLAorCX0sCisJLnByb2JlID0gcmFkX3BhbmVsX3Byb2JlLAorCS5yZW1vdmUgPSByYWRf
cGFuZWxfcmVtb3ZlLAorCS5zaHV0ZG93biA9IHJhZF9wYW5lbF9zaHV0ZG93biwKK307Cittb2R1
bGVfbWlwaV9kc2lfZHJpdmVyKHJhZF9wYW5lbF9kcml2ZXIpOworCitNT0RVTEVfQVVUSE9SKCJS
b2JlcnQgQ2hpcmFzIDxyb2JlcnQuY2hpcmFzQG54cC5jb20+Iik7CitNT0RVTEVfREVTQ1JJUFRJ
T04oIkRSTSBEcml2ZXIgZm9yIFJheWRpdW0gUk02NzE5MSBNSVBJIERTSSBwYW5lbCIpOworTU9E
VUxFX0xJQ0VOU0UoIkdQTCB2MiIpOwotLSAKMi43LjQKCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVs
QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWls
bWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
