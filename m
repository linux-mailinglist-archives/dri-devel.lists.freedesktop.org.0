Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 9716191158
	for <lists+dri-devel@lfdr.de>; Sat, 17 Aug 2019 17:25:32 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 22FE66EAA5;
	Sat, 17 Aug 2019 15:24:33 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from relmlie5.idc.renesas.com (relmlor1.renesas.com
 [210.160.252.171])
 by gabe.freedesktop.org (Postfix) with ESMTP id 9E39F6E2AC
 for <dri-devel@lists.freedesktop.org>; Thu, 15 Aug 2019 11:05:23 +0000 (UTC)
X-IronPort-AV: E=Sophos;i="5.64,388,1559487600"; d="scan'208";a="24088321"
Received: from unknown (HELO relmlir6.idc.renesas.com) ([10.200.68.152])
 by relmlie5.idc.renesas.com with ESMTP; 15 Aug 2019 20:05:23 +0900
Received: from fabrizio-dev.ree.adwin.renesas.com (unknown [10.226.36.196])
 by relmlir6.idc.renesas.com (Postfix) with ESMTP id D83E1417763E;
 Thu, 15 Aug 2019 20:05:19 +0900 (JST)
From: Fabrizio Castro <fabrizio.castro@bp.renesas.com>
To: Laurent Pinchart <laurent.pinchart@ideasonboard.com>,
 David Airlie <airlied@linux.ie>, Daniel Vetter <daniel@ffwll.ch>
Subject: [PATCH v2 7/9] drm: rcar-du: lvds: Add dual-LVDS panels support
Date: Thu, 15 Aug 2019 12:04:31 +0100
Message-Id: <1565867073-24746-8-git-send-email-fabrizio.castro@bp.renesas.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1565867073-24746-1-git-send-email-fabrizio.castro@bp.renesas.com>
References: <1565867073-24746-1-git-send-email-fabrizio.castro@bp.renesas.com>
X-Mailman-Approved-At: Sat, 17 Aug 2019 15:24:21 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Fabrizio Castro <fabrizio.castro@bp.renesas.com>,
 Simon Horman <horms@verge.net.au>,
 Chris Paterson <Chris.Paterson2@renesas.com>,
 Geert Uytterhoeven <geert+renesas@glider.be>, dri-devel@lists.freedesktop.org,
 Biju Das <biju.das@bp.renesas.com>, linux-renesas-soc@vger.kernel.org,
 Kieran Bingham <kieran.bingham+renesas@ideasonboard.com>,
 Jacopo Mondi <jacopo+renesas@jmondi.org>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBwYXRjaCBhZGRzIHN1cHBvcnQgZm9yIGR1YWwtTFZEUyBwYW5lbHMuCgpJdCdzIHZlcnkg
aW1wb3J0YW50IHRoYXQgd2UgY29vcmRpbmF0ZSB0aGUgZWZmb3J0cyBvZiBib3RoIHRoZQpwcmlt
YXJ5IGVuY29kZXIgYW5kIHRoZSBjb21wYW5pb24gZW5jb2RlciB0byBnZXQgdGhlIHJpZ2h0CnBp
Y3R1cmUgb24gdGhlIHBhbmVsLCB0aGVyZWZvcmUgdGhpcyBwYXRjaCBhZGRzIHNvbWUgY29kZQp0
byB3b3JrIG91dCBpZiBldmVuIGFuZCBvZGQgcGl4ZWxzIG5lZWQgc3dhcHBpbmcuCldoZW4gdGhl
IGVuY29kZXJzIGFyZSBjb25uZWN0ZWQgdG8gYSBMVkRTIHBhbmVsLCB0aGUgYXNzdW1wdGlvbgpp
cyB0aGF0IGJ5IGRlZmF1bHQgdGhlIHBhbmVsIGV4cGVjdHMgZXZlbiBwaXhlbHMgKDAsIDIsIDQs
IGV0Yy4pCm9uIHRoZSBmaXJzdCBpbnB1dCBwb3J0LCBhbmQgb2RkIHBpeGVscyAoMSwgMywgNSwg
ZXRjLikgb24gdGhlCnNlY29uZHMgcG9ydC4gV2hlbiBEUk1fTElOS19EVUFMX0xWRFNfT0REX0VW
RU4gaXMgZm91bmQgYW1vbmcgdGhlCmxpbmsgZmxhZ3MsIHRoZSBkaXNwbGF5IGV4cGVjdHMgb2Rk
IHBpeGVscyBvbiB0aGUgZmlyc3QgaW5wdXQKcG9ydCwgYW5kIGV2ZW4gcGl4ZWxzIG9uIHRoZSBz
ZWNvbmQgcG9ydC4gQXMgYSByZXN1bHQsIHRoZSB3YXkKdGhlIGVuY29kZXJzIGFyZSBjb25uZWN0
ZWQgdG8gdGhlIHBhbmVsIG1heSB0cmlnZ2VyIHBpeGVsIChkYXRhKQpzd2FwcGluZy4KClNpZ25l
ZC1vZmYtYnk6IEZhYnJpemlvIENhc3RybyA8ZmFicml6aW8uY2FzdHJvQGJwLnJlbmVzYXMuY29t
PgoKLS0tCnYxLT52MjoKKiBuZXcgcGF0Y2gsIHJlc3VsdGluZyBmcm9tIExhdXJlbnQncyBmZWVk
YmFjawoKIGRyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfbHZkcy5jIHwgMTIxICsrKysrKysr
KysrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLQogMSBmaWxlIGNoYW5nZWQsIDgxIGluc2VydGlv
bnMoKyksIDQwIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yY2Fy
LWR1L3JjYXJfbHZkcy5jIGIvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9sdmRzLmMKaW5k
ZXggNDFkMjhmNC4uNWMyNDg4NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUv
cmNhcl9sdmRzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9sdmRzLmMKQEAg
LTIyLDYgKzIyLDggQEAKICNpbmNsdWRlIDxkcm0vZHJtX2JyaWRnZS5oPgogI2luY2x1ZGUgPGRy
bS9kcm1fcGFuZWwuaD4KICNpbmNsdWRlIDxkcm0vZHJtX3Byb2JlX2hlbHBlci5oPgorI2luY2x1
ZGUgPGRybS9kcm1fdGltaW5ncy5oPgorI2luY2x1ZGUgPGRybS9kcm1fb2YuaD4KIAogI2luY2x1
ZGUgInJjYXJfbHZkcy5oIgogI2luY2x1ZGUgInJjYXJfbHZkc19yZWdzLmgiCkBAIC02OSw2ICs3
MSw3IEBAIHN0cnVjdCByY2FyX2x2ZHMgewogCiAJc3RydWN0IGRybV9icmlkZ2UgKmNvbXBhbmlv
bjsKIAlib29sIGR1YWxfbGluazsKKwlib29sIHN0cmlwZV9zd2FwX2RhdGE7CiB9OwogCiAjZGVm
aW5lIGJyaWRnZV90b19yY2FyX2x2ZHMoYikgXApAQCAtNDM5LDEyICs0NDIsMjAgQEAgc3RhdGlj
IHZvaWQgcmNhcl9sdmRzX2VuYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQogCXJjYXJf
bHZkc193cml0ZShsdmRzLCBMVkRDSENSLCBsdmRoY3IpOwogCiAJaWYgKGx2ZHMtPmluZm8tPnF1
aXJrcyAmIFJDQVJfTFZEU19RVUlSS19EVUFMX0xJTkspIHsKLQkJLyoKLQkJICogQ29uZmlndXJl
IHZlcnRpY2FsIHN0cmlwZSBiYXNlZCBvbiB0aGUgbW9kZSBvZiBvcGVyYXRpb24gb2YKLQkJICog
dGhlIGNvbm5lY3RlZCBkZXZpY2UuCi0JCSAqLwotCQlyY2FyX2x2ZHNfd3JpdGUobHZkcywgTFZE
U1RSSVBFLAotCQkJCWx2ZHMtPmR1YWxfbGluayA/IExWRFNUUklQRV9TVF9PTiA6IDApOworCQl1
MzIgbHZkc3RyaXBlID0gMDsKKworCQlpZiAobHZkcy0+ZHVhbF9saW5rKQorCQkJLyoKKwkJCSAq
IENvbmZpZ3VyZSB2ZXJ0aWNhbCBzdHJpcGUgYmFzZWQgb24gdGhlIG1vZGUgb2YKKwkJCSAqIG9w
ZXJhdGlvbiBvZiB0aGUgY29ubmVjdGVkIGRldmljZS4KKwkJCSAqCisJCQkgKiBTVF9TV0FQIGZy
b20gTFZEMVNUUklQRSBpcyByZXNlcnZlZCwgZG8gbm90IHNldAorCQkJICogaW4gdGhlIGNvbXBh
bmlvbiBMVkRTCisJCQkgKi8KKwkJCWx2ZHN0cmlwZSA9IExWRFNUUklQRV9TVF9PTiB8CisJCQkJ
KGx2ZHMtPmNvbXBhbmlvbiAmJiBsdmRzLT5zdHJpcGVfc3dhcF9kYXRhID8KKwkJCQkgTFZEU1RS
SVBFX1NUX1NXQVAgOiAwKTsKKwkJcmNhcl9sdmRzX3dyaXRlKGx2ZHMsIExWRFNUUklQRSwgbHZk
c3RyaXBlKTsKIAl9CiAKIAkvKgpAQCAtNzA2LDEzICs3MTcsMzEgQEAgc3RhdGljIGludCByY2Fy
X2x2ZHNfcGFyc2VfZHRfY29tcGFuaW9uKHN0cnVjdCByY2FyX2x2ZHMgKmx2ZHMpCiAJcmV0dXJu
IHJldDsKIH0KIAorc3RhdGljIGludCByY2FyX2x2ZHNfZ2V0X3JlbW90ZV9wb3J0X3JlZyhzdHJ1
Y3QgZGV2aWNlX25vZGUgKm5wKQoreworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqZW5kcG9pbnRfbm9k
ZSwgKnJlbW90ZV9lbmRwb2ludDsKKwlzdHJ1Y3Qgb2ZfZW5kcG9pbnQgZW5kcG9pbnQ7CisKKwll
bmRwb2ludF9ub2RlID0gb2ZfZ3JhcGhfZ2V0X2VuZHBvaW50X2J5X3JlZ3MobnAsIDEsIDApOwor
CWlmICghZW5kcG9pbnRfbm9kZSkKKwkJcmV0dXJuIC1FTk9ERVY7CisJcmVtb3RlX2VuZHBvaW50
ID0gb2ZfZ3JhcGhfZ2V0X3JlbW90ZV9lbmRwb2ludChlbmRwb2ludF9ub2RlKTsKKwlpZiAoIXJl
bW90ZV9lbmRwb2ludCkgeworCQlvZl9ub2RlX3B1dChlbmRwb2ludF9ub2RlKTsKKwkJcmV0dXJu
IC1FTk9ERVY7CisJfQorCW9mX2dyYXBoX3BhcnNlX2VuZHBvaW50KHJlbW90ZV9lbmRwb2ludCwg
JmVuZHBvaW50KTsKKwlvZl9ub2RlX3B1dChlbmRwb2ludF9ub2RlKTsKKwlvZl9ub2RlX3B1dChy
ZW1vdGVfZW5kcG9pbnQpOworCisJcmV0dXJuIGVuZHBvaW50LnBvcnQ7Cit9CisKIHN0YXRpYyBp
bnQgcmNhcl9sdmRzX3BhcnNlX2R0KHN0cnVjdCByY2FyX2x2ZHMgKmx2ZHMpCiB7CiAJc3RydWN0
IGRldmljZV9ub2RlICpsb2NhbF9vdXRwdXQgPSBOVUxMOwotCXN0cnVjdCBkZXZpY2Vfbm9kZSAq
cmVtb3RlX2lucHV0ID0gTlVMTDsKIAlzdHJ1Y3QgZGV2aWNlX25vZGUgKnJlbW90ZSA9IE5VTEw7
Ci0Jc3RydWN0IGRldmljZV9ub2RlICpub2RlOwotCWJvb2wgaXNfYnJpZGdlID0gZmFsc2U7CisJ
Y29uc3Qgc3RydWN0IGRybV90aW1pbmdzICp0aW1pbmdzID0gTlVMTDsKIAlpbnQgcmV0ID0gMDsK
IAogCWxvY2FsX291dHB1dCA9IG9mX2dyYXBoX2dldF9lbmRwb2ludF9ieV9yZWdzKGx2ZHMtPmRl
di0+b2Zfbm9kZSwgMSwgMCk7CkBAIC03NDAsNDUgKzc2OSw1NyBAQCBzdGF0aWMgaW50IHJjYXJf
bHZkc19wYXJzZV9kdChzdHJ1Y3QgcmNhcl9sdmRzICpsdmRzKQogCQlnb3RvIGRvbmU7CiAJfQog
Ci0JcmVtb3RlX2lucHV0ID0gb2ZfZ3JhcGhfZ2V0X3JlbW90ZV9lbmRwb2ludChsb2NhbF9vdXRw
dXQpOworCXJldCA9IGRybV9vZl9maW5kX3BhbmVsX29yX2JyaWRnZShsdmRzLT5kZXYtPm9mX25v
ZGUsIDEsIDAsCisJCQkJCSAgJmx2ZHMtPnBhbmVsLCAmbHZkcy0+bmV4dF9icmlkZ2UpOworCWlm
IChyZXQpIHsKKwkJcmV0ID0gLUVQUk9CRV9ERUZFUjsKKwkJZ290byBkb25lOworCX0KKwlpZiAo
bHZkcy0+aW5mby0+cXVpcmtzICYgUkNBUl9MVkRTX1FVSVJLX0RVQUxfTElOSykgeworCQlpZiAo
bHZkcy0+bmV4dF9icmlkZ2UpCisJCQl0aW1pbmdzID0gbHZkcy0+bmV4dF9icmlkZ2UtPnRpbWlu
Z3M7CisJCWVsc2UKKwkJCXRpbWluZ3MgPSBsdmRzLT5wYW5lbC0+dGltaW5nczsKKwkJaWYgKHRp
bWluZ3MpCisJCQlsdmRzLT5kdWFsX2xpbmsgPSB0aW1pbmdzLT5kdWFsX2xpbms7CisJfQogCi0J
Zm9yX2VhY2hfZW5kcG9pbnRfb2Zfbm9kZShyZW1vdGUsIG5vZGUpIHsKLQkJaWYgKG5vZGUgIT0g
cmVtb3RlX2lucHV0KSB7CisJaWYgKGx2ZHMtPmR1YWxfbGluaykgeworCQlyZXQgPSByY2FyX2x2
ZHNfcGFyc2VfZHRfY29tcGFuaW9uKGx2ZHMpOworCQlpZiAobHZkcy0+Y29tcGFuaW9uICYmIHRp
bWluZ3MpIHsKKwkJCWludCBvdXJfcG9ydCwgY29tcF9wb3J0OworCQkJYm9vbCBvZGRfZXZlbl9m
bGFnID0gdGltaW5ncy0+bGlua19mbGFncyAmCisJCQkJCQlEUk1fTElOS19EVUFMX0xWRFNfT0RE
X0VWRU47CisJCQlvdXJfcG9ydCA9IHJjYXJfbHZkc19nZXRfcmVtb3RlX3BvcnRfcmVnKAorCQkJ
CQkJbHZkcy0+ZGV2LT5vZl9ub2RlKTsKKwkJCWlmIChvdXJfcG9ydCA8IDApIHsKKwkJCQlyZXQg
PSBvdXJfcG9ydDsKKwkJCQlnb3RvIGRvbmU7CisJCQl9CisJCQljb21wX3BvcnQgPSByY2FyX2x2
ZHNfZ2V0X3JlbW90ZV9wb3J0X3JlZygKKwkJCQkJCWx2ZHMtPmNvbXBhbmlvbi0+b2Zfbm9kZSk7
CisJCQlpZiAoY29tcF9wb3J0IDwgMCkgeworCQkJCXJldCA9IGNvbXBfcG9ydDsKKwkJCQlnb3Rv
IGRvbmU7CisJCQl9CiAJCQkvKgotCQkJICogV2UndmUgZm91bmQgb25lIGVuZHBvaW50IG90aGVy
IHRoYW4gdGhlIGlucHV0LCB0aGlzCi0JCQkgKiBtdXN0IGJlIGEgYnJpZGdlLgorCQkJICogV2Ug
bmVlZCB0byBtYXRjaCB0aGUgcG9ydCB3aGVyZSB3ZSBnZW5lcmF0ZSBldmVuCisJCQkgKiBwaXhl
bHMgKDAsIDIsIDQsIGV0Yy4pIHRvIHRoZSBwb3J0IHdoZXJlIHRoZSBzaW5rCisJCQkgKiBleHBl
Y3RzIHRvIHJlY2VpdmUgZXZlbiBwaXhlbHMsIHNhbWUgdGhpbmcgZm9yIHRoZQorCQkJICogb2Rk
IHBpeGVscy4gU3dhcCB0aGUgZ2VuZXJhdGlvbiBvZiBldmVuIGFuZCBvZGQKKwkJCSAqIHBpeGVs
cyBpZiB0aGUgY29ubmVjdGlvbiByZXF1aXJlcyBpdC4KKwkJCSAqIEJ5IGRlZmF1bHQgKHdoZW4g
RFJNX0xJTktfRFVBTF9MVkRTX09ERF9FVkVOIGlzIG5vdAorCQkJICogc3BlY2lmaWVkKSB0aGUg
c2luayBleHBlY3RzIGV2ZW4gcGl4ZWxzIG9uIHRoZQorCQkJICogZmlyc3QgaW5wdXQgcG9ydCwg
YW5kIG9kZCBwaXhlbHMgb24gdGhlIHNlY29uZCBwb3J0LgogCQkJICovCi0JCQlpc19icmlkZ2Ug
PSB0cnVlOwotCQkJb2Zfbm9kZV9wdXQobm9kZSk7Ci0JCQlicmVhazsKKwkJCWlmICgoKGNvbXBf
cG9ydCAtIG91cl9wb3J0ID4gMCkgJiYgIG9kZF9ldmVuX2ZsYWcpIHx8CisJCQkgICAgKChjb21w
X3BvcnQgLSBvdXJfcG9ydCA8IDApICYmICFvZGRfZXZlbl9mbGFnKSkKKwkJCQlsdmRzLT5zdHJp
cGVfc3dhcF9kYXRhID0gdHJ1ZTsKIAkJfQogCX0KIAotCWlmIChpc19icmlkZ2UpIHsKLQkJbHZk
cy0+bmV4dF9icmlkZ2UgPSBvZl9kcm1fZmluZF9icmlkZ2UocmVtb3RlKTsKLQkJaWYgKCFsdmRz
LT5uZXh0X2JyaWRnZSkgewotCQkJcmV0ID0gLUVQUk9CRV9ERUZFUjsKLQkJCWdvdG8gZG9uZTsK
LQkJfQotCi0JCWlmIChsdmRzLT5pbmZvLT5xdWlya3MgJiBSQ0FSX0xWRFNfUVVJUktfRFVBTF9M
SU5LKQotCQkJbHZkcy0+ZHVhbF9saW5rID0gbHZkcy0+bmV4dF9icmlkZ2UtPnRpbWluZ3MKLQkJ
CQkJPyBsdmRzLT5uZXh0X2JyaWRnZS0+dGltaW5ncy0+ZHVhbF9saW5rCi0JCQkJCTogZmFsc2U7
Ci0JfSBlbHNlIHsKLQkJbHZkcy0+cGFuZWwgPSBvZl9kcm1fZmluZF9wYW5lbChyZW1vdGUpOwot
CQlpZiAoSVNfRVJSKGx2ZHMtPnBhbmVsKSkgewotCQkJcmV0ID0gUFRSX0VSUihsdmRzLT5wYW5l
bCk7Ci0JCQlnb3RvIGRvbmU7Ci0JCX0KLQl9Ci0KLQlpZiAobHZkcy0+ZHVhbF9saW5rKQotCQly
ZXQgPSByY2FyX2x2ZHNfcGFyc2VfZHRfY29tcGFuaW9uKGx2ZHMpOwotCiBkb25lOgogCW9mX25v
ZGVfcHV0KGxvY2FsX291dHB1dCk7Ci0Jb2Zfbm9kZV9wdXQocmVtb3RlX2lucHV0KTsKIAlvZl9u
b2RlX3B1dChyZW1vdGUpOwogCiAJLyoKLS0gCjIuNy40CgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZl
bEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFp
bG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
