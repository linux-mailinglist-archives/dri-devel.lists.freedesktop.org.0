Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 449F1796D0
	for <lists+dri-devel@lfdr.de>; Mon, 29 Jul 2019 21:56:04 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id AA66B6E1DE;
	Mon, 29 Jul 2019 19:55:58 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from smtp.domeneshop.no (smtp.domeneshop.no
 [IPv6:2a01:5b40:0:3005::1])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 930B889D44
 for <dri-devel@lists.freedesktop.org>; Mon, 29 Jul 2019 19:55:49 +0000 (UTC)
Received: from 211.81-166-168.customer.lyse.net ([81.166.168.211]:57528
 helo=localhost.localdomain)
 by smtp.domeneshop.no with esmtpsa (TLS1.2:ECDHE_RSA_AES_128_CBC_SHA1:128)
 (Exim 4.84_2) (envelope-from <noralf@tronnes.org>)
 id 1hsBkJ-0003F7-JT; Mon, 29 Jul 2019 21:55:47 +0200
From: =?UTF-8?q?Noralf=20Tr=C3=B8nnes?= <noralf@tronnes.org>
To: dri-devel@lists.freedesktop.org
Subject: [RFC 4/4] drm/panel/ili9341: Support mi0283qt
Date: Mon, 29 Jul 2019 21:55:26 +0200
Message-Id: <20190729195526.13337-5-noralf@tronnes.org>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190729195526.13337-1-noralf@tronnes.org>
References: <20190729195526.13337-1-noralf@tronnes.org>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; d=tronnes.org; s=ds201810; 
 h=Content-Transfer-Encoding:Content-Type:MIME-Version:References:In-Reply-To:Message-Id:Date:Subject:Cc:To:From;
 bh=KNGCt61vX2I/DRcW15xPpSLupMQXpJaAG8McKoIyPHE=; 
 b=ngT487CJhZZOWEsCqGdINpkc0DucKcKgpAvE/ctxF8td2BuPRNjq6A2JEKB8Y+/QxAKMagO/uRz1mX7Rb5ear+6vJ2cOzm1CQ4c3N8E0Jyc72hjaLE1+SWD2K60h8Zzmry2Hq1tCYWqN+aI3aHSXqWFxfXDd0TNQoiXpx20cMlZSEEw4rAtls7GotuFv2uIw5rMmckElqUkOL6XTjgDXQR2HL7Bu8hKz9ImtpL2U+o+kZ3qzO9TMiVUWL050jHWa/0GLCiRG5l/iL1PiQ12l5Io/U/4jUJUrwEz6o06Di0PvVwiVIU2j5PmgjrSj+rPbH1FYpjHFS3L7k5YbH9VZXQ==;
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: daniel.vetter@ffwll.ch, josef@lusticky.cz, thierry.reding@gmail.com,
 laurent.pinchart@ideasonboard.com, sam@ravnborg.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

U2lnbmVkLW9mZi1ieTogTm9yYWxmIFRyw7hubmVzIDxub3JhbGZAdHJvbm5lcy5vcmc+Ci0tLQog
ZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLWlsaXRlay1pbGk5MzQxLmMgfCAxNzkgKysrKysr
KysrKysrKysrKysrLQogMSBmaWxlIGNoYW5nZWQsIDE3MCBpbnNlcnRpb25zKCspLCA5IGRlbGV0
aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1pbGl0ZWst
aWxpOTM0MS5jIGIvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLWlsaXRlay1pbGk5MzQxLmMK
aW5kZXggYTc1NWYzZTYwMTExLi5kZDMzM2E2NDIxNTkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9wYW5lbC9wYW5lbC1pbGl0ZWstaWxpOTM0MS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9w
YW5lbC9wYW5lbC1pbGl0ZWstaWxpOTM0MS5jCkBAIC0yMSwxMCArMjEsMTMgQEAKICNpbmNsdWRl
IDxsaW51eC9ncGlvL2NvbnN1bWVyLmg+CiAjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+CiAjaW5j
bHVkZSA8bGludXgvb2ZfZGV2aWNlLmg+CisjaW5jbHVkZSA8bGludXgvb2ZfZ3JhcGguaD4KICNp
bmNsdWRlIDxsaW51eC9zcGkvc3BpLmg+CiAKICNpbmNsdWRlIDx2aWRlby9taXBpX2Rpc3BsYXku
aD4KIAorI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljX2hlbHBlci5oPgorI2luY2x1ZGUgPGRybS9k
cm1fZHJ2Lmg+CiAjaW5jbHVkZSA8ZHJtL2RybV9tb2Rlcy5oPgogI2luY2x1ZGUgPGRybS9kcm1f
cGFuZWwuaD4KICNpbmNsdWRlIDxkcm0vZHJtX3ByaW50Lmg+CkBAIC0zMiwxMCArMzUsMjUgQEAK
IAogLyogSUxJOTM0MSBleHRlbmRlZCByZWdpc3RlciBzZXQgKFZlbmRvciBDb21tYW5kIFNldCkg
Ki8KICNkZWZpbmUgSUxJOTM0MV9JRk1PREUgICAgICAgICAweEIwIC8vIGNsb2NrIHBvbGFyaXR5
CisjZGVmaW5lIElMSTkzNDFfRlJNQ1RSMSAgICAgICAgMHhiMQorI2RlZmluZSBJTEk5MzQxX0RJ
U0NUUkwgICAgICAgIDB4YjYKKyNkZWZpbmUgSUxJOTM0MV9FVE1PRCAgICAgICAgICAweGI3Cisj
ZGVmaW5lIElMSTkzNDFfUFdDVFJMMSAgICAgICAgMHhjMAorI2RlZmluZSBJTEk5MzQxX1BXQ1RS
TDIgICAgICAgIDB4YzEKKyNkZWZpbmUgSUxJOTM0MV9WTUNUUkwxICAgICAgICAweGM1CisjZGVm
aW5lIElMSTkzNDFfVk1DVFJMMiAgICAgICAgMHhjNworI2RlZmluZSBJTEk5MzQxX1BXQ1RSTEEg
ICAgICAgIDB4Y2IKKyNkZWZpbmUgSUxJOTM0MV9QV0NUUkxCICAgICAgICAweGNmCiAjZGVmaW5l
IElMSTkzNDFfSUZDVEwgICAgICAgICAgMHhGNiAvLyBpbnRlcmZhY2UgY29ucm9sCiAjZGVmaW5l
IElMSTkzNDFfUEdBTUNUUkwgICAgICAgMHhFMCAvLyBwb3NpdGl2ZSBnYW1tYSBjb250cm9sCiAj
ZGVmaW5lIElMSTkzNDFfTkdBTUNUUkwgICAgICAgMHhFMSAvLyBuZWdhdGl2ZSBnYW1tYSBjb250
cm9sCisjZGVmaW5lIElMSTkzNDFfRFRDVFJMQSAgICAgICAgMHhlOAorI2RlZmluZSBJTEk5MzQx
X0RUQ1RSTEIgICAgICAgIDB4ZWEKKyNkZWZpbmUgSUxJOTM0MV9QV1JTRVEgICAgICAgICAweGVk
CisjZGVmaW5lIElMSTkzNDFfRU4zR0FNICAgICAgICAgMHhmMgorI2RlZmluZSBJTEk5MzQxX1BV
TVBDVFJMICAgICAgIDB4ZjcKIAorI2RlZmluZSBJTEk5MzQxX01BRENUTF9CR1IgICAgIEJJVCgz
KQogI2RlZmluZSBJTEk5MzQxX01BRENUTF9NViAgICAgIEJJVCg1KQogI2RlZmluZSBJTEk5MzQx
X01BRENUTF9NWCAgICAgIEJJVCg2KQogI2RlZmluZSBJTEk5MzQxX01BRENUTF9NWSAgICAgIEJJ
VCg3KQpAQCAtNDQsMTUgKzYyLDE4IEBACiAgKiBzdHJ1Y3QgaWxpOTM0MV9jb25maWcgLSB0aGUg
ZGlzcGxheSBzcGVjaWZpYyBjb25maWd1cmF0aW9uCiAgKiBAZnVuY3M6IFBhbmVsIGZ1bmN0aW9u
cwogICogQG1vZGU6IERpc3BsYXkgbW9kZQorICogQGNvbW1hbmRfbW9kZV9vbmx5OiBQYW5lbCBv
bmx5IHN1cHBvcnRzIGNvbW1hbmQgbW9kZQogICovCiBzdHJ1Y3QgaWxpOTM0MV9jb25maWcgewog
CWNvbnN0IHN0cnVjdCBkcm1fcGFuZWxfZnVuY3MgKmZ1bmNzOwogCWNvbnN0IHN0cnVjdCBkcm1f
ZGlzcGxheV9tb2RlICptb2RlOworCWJvb2wgY29tbWFuZF9tb2RlX29ubHk7CiB9OwogCiBzdHJ1
Y3QgaWxpOTM0MSB7CiAJc3RydWN0IGRybV9wYW5lbCBwYW5lbDsKLQlzdHJ1Y3QgbWlwaV9kYmkg
ZGJpOworCXN0cnVjdCBtaXBpX2RiaV9kZXYgZGJpZGV2OworCWJvb2wgY29tbWFuZF9tb2RlOwog
CXN0cnVjdCBiYWNrbGlnaHRfZGV2aWNlICpiYWNrbGlnaHQ7CiAJY29uc3Qgc3RydWN0IGlsaTkz
NDFfY29uZmlnICpjb25mOwogfTsKQEAgLTY0LDcgKzg1LDcgQEAgc3RhdGljIGlubGluZSBzdHJ1
Y3QgaWxpOTM0MSAqcGFuZWxfdG9faWxpOTM0MShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKIAog
c3RhdGljIGludCBpbGk5MzQxX2RlaW5pdChzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCwgc3RydWN0
IGlsaTkzNDEgKmlsaSkKIHsKLQlzdHJ1Y3QgbWlwaV9kYmkgKmRiaSA9ICZpbGktPmRiaTsKKwlz
dHJ1Y3QgbWlwaV9kYmkgKmRiaSA9ICZpbGktPmRiaWRldi5kYmk7CiAKIAltaXBpX2RiaV9jb21t
YW5kKGRiaSwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlfT0ZGKTsKIAltaXBpX2RiaV9jb21tYW5kKGRi
aSwgTUlQSV9EQ1NfRU5URVJfU0xFRVBfTU9ERSk7CkBAIC03NCw3ICs5NSw3IEBAIHN0YXRpYyBp
bnQgaWxpOTM0MV9kZWluaXQoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwsIHN0cnVjdCBpbGk5MzQx
ICppbGkpCiAKIHN0YXRpYyBpbnQgZHQwMjRjdGZ0X2luaXQoc3RydWN0IGRybV9wYW5lbCAqcGFu
ZWwsIHN0cnVjdCBpbGk5MzQxICppbGkpCiB7Ci0Jc3RydWN0IG1pcGlfZGJpICpkYmkgPSAmaWxp
LT5kYmk7CisJc3RydWN0IG1pcGlfZGJpICpkYmkgPSAmaWxpLT5kYmlkZXYuZGJpOwogCiAJLyog
SFcgLyBTVyBSZXNldCBkaXNwbGF5IGFuZCB3YWl0ICovCiAJbWlwaV9kYmlfaHdfcmVzZXQoZGJp
KTsKQEAgLTE2NCw2ICsxODUsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21v
ZGUgcHJnYl8yNDB4MzIwX21vZGUgPSB7CiAJLmhlaWdodF9tbSA9IDQ5LAogfTsKIAorLyogVGhp
cyBpcyBub3QgdXNlZCBpbiBjb21tYW5kIG1vZGUgKi8KIHN0YXRpYyBpbnQgaWxpOTM0MV9nZXRf
bW9kZXMoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwpCiB7CiAJc3RydWN0IGRybV9jb25uZWN0b3Ig
KmNvbm5lY3RvciA9IHBhbmVsLT5jb25uZWN0b3I7CkBAIC0yMDEsMTkgKzIyMywxMjUgQEAgc3Rh
dGljIGNvbnN0IHN0cnVjdCBpbGk5MzQxX2NvbmZpZyBkdDAyNGN0ZnRfZGF0YSA9IHsKIAkubW9k
ZSA9ICZwcmdiXzI0MHgzMjBfbW9kZSwKIH07CiAKK3N0YXRpYyBpbnQgbWkwMjgzcXRfcHJlcGFy
ZShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKK3sKKwlzdHJ1Y3QgaWxpOTM0MSAqaWxpID0gcGFu
ZWxfdG9faWxpOTM0MShwYW5lbCk7CisJc3RydWN0IG1pcGlfZGJpICpkYmkgPSAmaWxpLT5kYmlk
ZXYuZGJpOworCXU4IGFkZHJfbW9kZTsKKwlpbnQgcmV0OworCisJRFJNX0RFQlVHX0tNUygiXG4i
KTsKKworCXJldCA9IG1pcGlfZGJpX3Bvd2Vyb25fY29uZGl0aW9uYWxfcmVzZXQoJmlsaS0+ZGJp
ZGV2KTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0dXJuIHJldDsKKwlpZiAocmV0ID09IDEpCisJCWdv
dG8gb3V0X2VuYWJsZTsKKwltaXBpX2RiaV9od19yZXNldChkYmkpOworCisJbWlwaV9kYmlfY29t
bWFuZChkYmksIE1JUElfRENTX1NFVF9ESVNQTEFZX09GRik7CisKKwltaXBpX2RiaV9jb21tYW5k
KGRiaSwgSUxJOTM0MV9QV0NUUkxCLCAweDAwLCAweDgzLCAweDMwKTsKKwltaXBpX2RiaV9jb21t
YW5kKGRiaSwgSUxJOTM0MV9QV1JTRVEsIDB4NjQsIDB4MDMsIDB4MTIsIDB4ODEpOworCW1pcGlf
ZGJpX2NvbW1hbmQoZGJpLCBJTEk5MzQxX0RUQ1RSTEEsIDB4ODUsIDB4MDEsIDB4NzkpOworCW1p
cGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5MzQxX1BXQ1RSTEEsIDB4MzksIDB4MmMsIDB4MDAsIDB4
MzQsIDB4MDIpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5MzQxX1BVTVBDVFJMLCAweDIw
KTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgSUxJOTM0MV9EVENUUkxCLCAweDAwLCAweDAwKTsK
KworCS8qIFBvd2VyIENvbnRyb2wgKi8KKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgSUxJOTM0MV9Q
V0NUUkwxLCAweDI2KTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgSUxJOTM0MV9QV0NUUkwyLCAw
eDExKTsKKwkvKiBWQ09NICovCisJbWlwaV9kYmlfY29tbWFuZChkYmksIElMSTkzNDFfVk1DVFJM
MSwgMHgzNSwgMHgzZSk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIElMSTkzNDFfVk1DVFJMMiwg
MHhiZSk7CisKKwkvKiBNZW1vcnkgQWNjZXNzIENvbnRyb2wgKi8KKwltaXBpX2RiaV9jb21tYW5k
KGRiaSwgTUlQSV9EQ1NfU0VUX1BJWEVMX0ZPUk1BVCwgTUlQSV9EQ1NfUElYRUxfRk1UXzE2QklU
KTsKKworCS8qIEZyYW1lIFJhdGUgKi8KKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgSUxJOTM0MV9G
Uk1DVFIxLCAweDAwLCAweDFiKTsKKworCS8qIEdhbW1hICovCisJbWlwaV9kYmlfY29tbWFuZChk
YmksIElMSTkzNDFfRU4zR0FNLCAweDA4KTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgTUlQSV9E
Q1NfU0VUX0dBTU1BX0NVUlZFLCAweDAxKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgSUxJOTM0
MV9QR0FNQ1RSTCwKKwkJICAgICAgIDB4MWYsIDB4MWEsIDB4MTgsIDB4MGEsIDB4MGYsIDB4MDYs
IDB4NDUsIDB4ODcsCisJCSAgICAgICAweDMyLCAweDBhLCAweDA3LCAweDAyLCAweDA3LCAweDA1
LCAweDAwKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgSUxJOTM0MV9OR0FNQ1RSTCwKKwkJICAg
ICAgIDB4MDAsIDB4MjUsIDB4MjcsIDB4MDUsIDB4MTAsIDB4MDksIDB4M2EsIDB4NzgsCisJCSAg
ICAgICAweDRkLCAweDA1LCAweDE4LCAweDBkLCAweDM4LCAweDNhLCAweDFmKTsKKworCS8qIERE
UkFNICovCisJbWlwaV9kYmlfY29tbWFuZChkYmksIElMSTkzNDFfRVRNT0QsIDB4MDcpOworCisJ
LyogRGlzcGxheSAqLworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5MzQxX0RJU0NUUkwsIDB4
MGEsIDB4ODIsIDB4MjcsIDB4MDApOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBNSVBJX0RDU19F
WElUX1NMRUVQX01PREUpOworCW1zbGVlcCgxMDApOworCisJbWlwaV9kYmlfY29tbWFuZChkYmks
IE1JUElfRENTX1NFVF9ESVNQTEFZX09OKTsKKwltc2xlZXAoMTAwKTsKKworb3V0X2VuYWJsZToK
KwkvKiBUaGUgUGlURlQgKGlsaTkzNDApIGhhcyBhIGhhcmR3YXJlIHJlc2V0IGNpcmN1aXQgdGhh
dAorCSAqIHJlc2V0cyBvbmx5IG9uIHBvd2VyLW9uIGFuZCBub3Qgb24gZWFjaCByZWJvb3QgdGhy
b3VnaAorCSAqIGEgZ3BpbyBsaWtlIHRoZSBycGktZGlzcGxheSBkb2VzLgorCSAqIEFzIGEgcmVz
dWx0LCB3ZSBuZWVkIHRvIGFsd2F5cyBhcHBseSB0aGUgcm90YXRpb24gdmFsdWUKKwkgKiByZWdh
cmRsZXNzIG9mIHRoZSBkaXNwbGF5ICJvbi9vZmYiIHN0YXRlLgorCSAqLworCXN3aXRjaCAoaWxp
LT5kYmlkZXYucm90YXRpb24pIHsKKwlkZWZhdWx0OgorCQlhZGRyX21vZGUgPSBJTEk5MzQxX01B
RENUTF9NViB8IElMSTkzNDFfTUFEQ1RMX01ZIHwKKwkJCSAgICBJTEk5MzQxX01BRENUTF9NWDsK
KwkJYnJlYWs7CisJY2FzZSA5MDoKKwkJYWRkcl9tb2RlID0gSUxJOTM0MV9NQURDVExfTVk7CisJ
CWJyZWFrOworCWNhc2UgMTgwOgorCQlhZGRyX21vZGUgPSBJTEk5MzQxX01BRENUTF9NVjsKKwkJ
YnJlYWs7CisJY2FzZSAyNzA6CisJCWFkZHJfbW9kZSA9IElMSTkzNDFfTUFEQ1RMX01YOworCQli
cmVhazsKKwl9CisJYWRkcl9tb2RlIHw9IElMSTkzNDFfTUFEQ1RMX0JHUjsKKwltaXBpX2RiaV9j
b21tYW5kKGRiaSwgTUlQSV9EQ1NfU0VUX0FERFJFU1NfTU9ERSwgYWRkcl9tb2RlKTsKKworCXJl
dHVybiAwOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9wYW5lbF9mdW5jcyBtaTAyODNx
dF9kcm1fZnVuY3MgPSB7CisJLmRpc2FibGUgPSBpbGk5MzQxX2Rpc2FibGUsCisJLnVucHJlcGFy
ZSA9IGlsaTkzNDFfdW5wcmVwYXJlLAorCS5wcmVwYXJlID0gbWkwMjgzcXRfcHJlcGFyZSwKKwku
ZW5hYmxlID0gaWxpOTM0MV9lbmFibGUsCisJLmdldF9tb2RlcyA9IGlsaTkzNDFfZ2V0X21vZGVz
LAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlIG1pMDI4M3F0X21v
ZGUgPSB7CisJRFJNX1NJTVBMRV9NT0RFKDMyMCwgMjQwLCA1OCwgNDMpLAorfTsKKworc3RhdGlj
IGNvbnN0IHN0cnVjdCBpbGk5MzQxX2NvbmZpZyBtaTAyODNxdF9kYXRhID0geworCS5mdW5jcyA9
ICZtaTAyODNxdF9kcm1fZnVuY3MsCisJLm1vZGUgPSAmbWkwMjgzcXRfbW9kZSwKKwkuY29tbWFu
ZF9tb2RlX29ubHkgPSB0cnVlLAorfTsKKwogc3RhdGljIGludCBpbGk5MzQxX3Byb2JlKHN0cnVj
dCBzcGlfZGV2aWNlICpzcGkpCiB7CiAJc3RydWN0IGRldmljZSAqZGV2ID0gJnNwaS0+ZGV2Owog
CXN0cnVjdCBpbGk5MzQxICppbGk7CiAJc3RydWN0IG1pcGlfZGJpICpkYmk7CiAJc3RydWN0IGdw
aW9fZGVzYyAqZGNfZ3BpbzsKKwlzdHJ1Y3QgZGV2aWNlX25vZGUgKnBvcnQ7CiAJaW50IHJldDsK
IAotCWlsaSA9IGRldm1fa3phbGxvYyhkZXYsIHNpemVvZigqaWxpKSwgR0ZQX0tFUk5FTCk7CisJ
aWxpID0ga3phbGxvYyhzaXplb2YoKmlsaSksIEdGUF9LRVJORUwpOwogCWlmICghaWxpKQogCQly
ZXR1cm4gLUVOT01FTTsKIAotCWRiaSA9ICZpbGktPmRiaTsKKwlkYmkgPSAmaWxpLT5kYmlkZXYu
ZGJpOwogCiAJc3BpX3NldF9kcnZkYXRhKHNwaSwgaWxpKTsKIApAQCAtMjU1LDIzICszODMsNTUg
QEAgc3RhdGljIGludCBpbGk5MzQxX3Byb2JlKHN0cnVjdCBzcGlfZGV2aWNlICpzcGkpCiAJaWxp
LT5wYW5lbC5kZXYgPSBkZXY7CiAJaWxpLT5wYW5lbC5mdW5jcyA9IGlsaS0+Y29uZi0+ZnVuY3M7
CiAKLQlyZXR1cm4gZHJtX3BhbmVsX2FkZCgmaWxpLT5wYW5lbCk7CisJcG9ydCA9IG9mX2dldF9j
aGlsZF9ieV9uYW1lKGRldi0+b2Zfbm9kZSwgInBvcnQiKTsKKwlpZiAocG9ydCkKKwkJb2Zfbm9k
ZV9wdXQocG9ydCk7CisJZWxzZQorCQlpbGktPmNvbW1hbmRfbW9kZSA9IHRydWU7CisKKwlpZiAo
aWxpLT5jb25mLT5jb21tYW5kX21vZGVfb25seSkKKwkJaWxpLT5jb21tYW5kX21vZGUgPSB0cnVl
OworCisJaWYgKGlsaS0+Y29tbWFuZF9tb2RlKQorCQlyZXQgPSBkcm1fbWlwaV9kYmlfcGFuZWxf
cmVnaXN0ZXIoJmlsaS0+cGFuZWwsICZpbGktPmRiaWRldiwgaWxpLT5jb25mLT5tb2RlKTsKKwll
bHNlCisJCXJldCA9IGRybV9wYW5lbF9hZGQoJmlsaS0+cGFuZWwpOworCisJcmV0dXJuIHJldDsK
IH0KIAogc3RhdGljIGludCBpbGk5MzQxX3JlbW92ZShzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpKQog
ewogCXN0cnVjdCBpbGk5MzQxICppbGkgPSBzcGlfZ2V0X2RydmRhdGEoc3BpKTsKIAotCWRybV9w
YW5lbF9yZW1vdmUoJmlsaS0+cGFuZWwpOworCWlmIChpbGktPmNvbW1hbmRfbW9kZSkgeworCQlz
dHJ1Y3QgZHJtX2RldmljZSAqZHJtID0gJmlsaS0+ZGJpZGV2LmRybTsKIAotCWlsaTkzNDFfZGlz
YWJsZSgmaWxpLT5wYW5lbCk7Ci0JaWxpOTM0MV91bnByZXBhcmUoJmlsaS0+cGFuZWwpOworCQlk
cm1fZGV2X3VucGx1Zyhkcm0pOworCQlkcm1fYXRvbWljX2hlbHBlcl9zaHV0ZG93bihkcm0pOwor
CX0gZWxzZSB7CisJCWRybV9wYW5lbF9yZW1vdmUoJmlsaS0+cGFuZWwpOworCisJCWlsaTkzNDFf
ZGlzYWJsZSgmaWxpLT5wYW5lbCk7CisJCWlsaTkzNDFfdW5wcmVwYXJlKCZpbGktPnBhbmVsKTsK
KwkJa2ZyZWUoaWxpKTsKKwl9CiAKIAlyZXR1cm4gMDsKIH0KIAorc3RhdGljIHZvaWQgaWxpOTM0
MV9zaHV0ZG93bihzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpKQoreworCXN0cnVjdCBpbGk5MzQxICpp
bGkgPSBzcGlfZ2V0X2RydmRhdGEoc3BpKTsKKworCWlmIChpbGktPmNvbW1hbmRfbW9kZSkKKwkJ
ZHJtX2F0b21pY19oZWxwZXJfc2h1dGRvd24oJmlsaS0+ZGJpZGV2LmRybSk7Cit9CisKIHN0YXRp
YyBjb25zdCBzdHJ1Y3Qgb2ZfZGV2aWNlX2lkIGlsaTkzNDFfb2ZfbWF0Y2hbXSA9IHsKIAl7IC5j
b21wYXRpYmxlID0gImRpc3BsYXl0ZWNoLGR0MDI0Y3RmdCIsIC5kYXRhID0gJmR0MDI0Y3RmdF9k
YXRhIH0sCisvKgl7IC5jb21wYXRpYmxlID0gIm11bHRpLWlubm8sbWkwMjgzcXQiLCAuZGF0YSA9
ICZtaTAyODNxdF9kYXRhIH0sICovCisJeyAuY29tcGF0aWJsZSA9ICJtaSxtaTAyODNxdCIsIC5k
YXRhID0gJm1pMDI4M3F0X2RhdGEgfSwKIAl7IC8qIHNlbnRpbmVsICovIH0KIH07CiBNT0RVTEVf
REVWSUNFX1RBQkxFKG9mLCBpbGk5MzQxX29mX21hdGNoKTsKQEAgLTI3OSw2ICs0MzksNyBAQCBN
T0RVTEVfREVWSUNFX1RBQkxFKG9mLCBpbGk5MzQxX29mX21hdGNoKTsKIHN0YXRpYyBzdHJ1Y3Qg
c3BpX2RyaXZlciBpbGk5MzQxX2RyaXZlciA9IHsKIAkucHJvYmUgPSBpbGk5MzQxX3Byb2JlLAog
CS5yZW1vdmUgPSBpbGk5MzQxX3JlbW92ZSwKKwkuc2h1dGRvd24gPSBpbGk5MzQxX3NodXRkb3du
LAogCS5kcml2ZXIgPSB7CiAJCS5uYW1lID0gInBhbmVsLWlsaXRlay1pbGk5MzQxIiwKIAkJLm9m
X21hdGNoX3RhYmxlID0gaWxpOTM0MV9vZl9tYXRjaCwKLS0gCjIuMjAuMQoKX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlz
dApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0
b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
