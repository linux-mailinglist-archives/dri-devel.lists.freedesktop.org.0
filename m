Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id E6E80173A0
	for <lists+dri-devel@lfdr.de>; Wed,  8 May 2019 10:26:54 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 5CEE189690;
	Wed,  8 May 2019 08:26:42 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7EF07895C8
 for <dri-devel@lists.freedesktop.org>; Wed,  8 May 2019 08:26:38 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id AAD28AE51;
 Wed,  8 May 2019 08:26:36 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: daniel@ffwll.ch, airlied@linux.ie, kraxel@redhat.com,
 christian.koenig@amd.com, ray.huang@amd.com, hdegoede@redhat.com,
 noralf@tronnes.org, sam@ravnborg.org, z.liuxinliang@hisilicon.com,
 zourongrong@gmail.com, kong.kongxinwei@hisilicon.com,
 puck.chen@hisilicon.com
Subject: [PATCH v5 01/20] drm: Add |struct drm_gem_vram_object| and helpers
Date: Wed,  8 May 2019 10:26:11 +0200
Message-Id: <20190508082630.15116-2-tzimmermann@suse.de>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190508082630.15116-1-tzimmermann@suse.de>
References: <20190508082630.15116-1-tzimmermann@suse.de>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Zimmermann <tzimmermann@suse.de>, dri-devel@lists.freedesktop.org,
 virtualization@lists.linux-foundation.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIHR5cGUgfHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0fCBpbXBsZW1lbnRzIGEgR0VNIG9i
amVjdCBmb3Igc2ltcGxlCmZyYW1lYnVmZmVyIGRldmljZXMgd2l0aCBkZWRpY2F0ZWQgdmlkZW8g
bWVtb3J5LiBUaGUgQk8gaXMgZWl0aGVyIGxvY2F0ZWQKaW4gVlJBTSBvciBzeXN0ZW0gbWVtb3J5
LgoKVGhlIGltcGxlbWVudGF0aW9uIGhhcyBiZWVuIGNyZWF0ZWQgZnJvbSB0aGUgcmVzcGVjdGl2
ZSBjb2RlIGluIGFzdCwKYm9jaHMgYW5kIG1nYWcyMDAuIFRoZXNlIGRyaXZlcnMgY29weSB0aGVp
ciBpbXBsZW1lbnRhdGlvbiBmcm9tIGVhY2gKb3RoZXI7IGV4Y2VwdCBmb3IgdGhlIG5hbWVzIG9m
IHNldmVyYWwgZGF0YSB0eXBlcy4gVGhlIGhlbHBlcnMgYXJlCmN1cnJlbnRseSBidWlsZCB3aXRo
IFRUTSwgYnV0IHRoaXMgaXMgY29uc2lkZXJlZCBhbiBpbXBsZW1lbnRhdGlvbgpkZXRhaWwgYW5k
IG1heSBjaGFuZ2UgaW4gZnV0dXJlIHVwZGF0ZXMuCgp2NToKCSogZG8gV0FSTl9PTl9PTkNFIGZv
ciBwaW4tY291bnQgbWlzbWF0Y2hlcwoJKiBhbGxvY2F0ZSBvbmx5IDIgZW50cmllcyBpbiBwbGFj
ZW1lbnRzIGFycmF5CnY0OgoJKiBjbGVhbnVwcyBmcm9tIGNoZWNrcGF0Y2gucGwKCSogcmVtb3Zl
ZCBzZXZlcmFsIGZpeGVkLXNpemUgdHlwZXMgZnJvbSBpbnRlcmZhY2VzCgkqIERSTV9WUkFNX0hF
TFBFUiBub3cgc2VsZWN0cyBEUk1fVFRNCgkqIHJlbW92ZSBzZXBhcmF0ZSBjb25maWcgb3B0aW9u
IGZvciBHRU0gVlJBTQp2MjoKCSogcmVuYW1lIHRvIHxzdHJ1Y3QgZHJtX2dlbV92cmFtX29iamVj
dHwKCSogbW92ZSBkcm1faXNfZ2VtX3R0bSgpIHRvIGEgbGF0ZXIgcGF0Y2ggaW4gdGhlIHNlcmll
cwoJKiBhZGQgZHJtX2dlbV92cmFtX2ttYXBfYXQoKQoJKiByZXR1cm4gaXNfaW9tZW0gZnJvbSBr
bWFwIGZ1bmN0aW9ucwoJKiByZWRlZmluZSBUVE0gcGxhY2VtZW50IGZsYWdzIGZvciBwdWJsaWMg
aW50ZXJmYWNlCgkqIGRvY3VtZW50YXRpb24gZml4ZXMKClNpZ25lZC1vZmYtYnk6IFRob21hcyBa
aW1tZXJtYW5uIDx0emltbWVybWFubkBzdXNlLmRlPgotLS0KIERvY3VtZW50YXRpb24vZ3B1L2Ry
bS1tbS5yc3QgICAgICAgICAgICAgfCAgMTUgKwogZHJpdmVycy9ncHUvZHJtL0tjb25maWcgICAg
ICAgICAgICAgICAgICB8ICAgNyArCiBkcml2ZXJzL2dwdS9kcm0vTWFrZWZpbGUgICAgICAgICAg
ICAgICAgIHwgICA0ICsKIGRyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMgICAg
fCA0MTIgKysrKysrKysrKysrKysrKysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9kcm1fdnJhbV9o
ZWxwZXJfY29tbW9uLmMgfCAgIDYgKwogaW5jbHVkZS9kcm0vZHJtX2dlbV92cmFtX2hlbHBlci5o
ICAgICAgICB8ICA5MiArKysrKwogNiBmaWxlcyBjaGFuZ2VkLCA1MzYgaW5zZXJ0aW9ucygrKQog
Y3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMK
IGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vZHJtX3ZyYW1faGVscGVyX2NvbW1v
bi5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgaW5jbHVkZS9kcm0vZHJtX2dlbV92cmFtX2hlbHBlci5o
CgpkaWZmIC0tZ2l0IGEvRG9jdW1lbnRhdGlvbi9ncHUvZHJtLW1tLnJzdCBiL0RvY3VtZW50YXRp
b24vZ3B1L2RybS1tbS5yc3QKaW5kZXggNTRhNjk2ZDk2MWE3Li5hM2I2ODUwODk1MTIgMTAwNjQ0
Ci0tLSBhL0RvY3VtZW50YXRpb24vZ3B1L2RybS1tbS5yc3QKKysrIGIvRG9jdW1lbnRhdGlvbi9n
cHUvZHJtLW1tLnJzdApAQCAtMzgwLDYgKzM4MCwyMSBAQCBHRU0gQ01BIEhlbHBlciBGdW5jdGlv
bnMgUmVmZXJlbmNlCiAuLiBrZXJuZWwtZG9jOjogZHJpdmVycy9ncHUvZHJtL2RybV9nZW1fY21h
X2hlbHBlci5jCiAgICA6ZXhwb3J0OgogCitWUkFNIEhlbHBlciBGdW5jdGlvbiBSZWZlcmVuY2UK
Kz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQorCitHRU0gVlJBTSBIZWxwZXIgRnVuY3Rp
b25zIFJlZmVyZW5jZQorLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKworLi4g
a2VybmVsLWRvYzo6IGRyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMKKyAgIDpk
b2M6IG92ZXJ2aWV3CisKKy4uIGtlcm5lbC1kb2M6OiBpbmNsdWRlL2RybS9kcm1fZ2VtX3ZyYW1f
aGVscGVyLmgKKyAgIDppbnRlcm5hbDoKKworLi4ga2VybmVsLWRvYzo6IGRyaXZlcnMvZ3B1L2Ry
bS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMKKyAgIDpleHBvcnQ6CisKIFZNQSBPZmZzZXQgTWFuYWdl
cgogPT09PT09PT09PT09PT09PT09CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9LY29u
ZmlnIGIvZHJpdmVycy9ncHUvZHJtL0tjb25maWcKaW5kZXggMjI2N2U4NGQ1Y2I0Li4xM2Q3YjMy
MWRiMGQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9LY29uZmlnCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9LY29uZmlnCkBAIC0xNjAsNiArMTYwLDEzIEBAIGNvbmZpZyBEUk1fVFRNCiAJICBH
UFUgbWVtb3J5IHR5cGVzLiBXaWxsIGJlIGVuYWJsZWQgYXV0b21hdGljYWxseSBpZiBhIGRldmlj
ZSBkcml2ZXIKIAkgIHVzZXMgaXQuCiAKK2NvbmZpZyBEUk1fVlJBTV9IRUxQRVIKKwl0cmlzdGF0
ZQorCWRlcGVuZHMgb24gRFJNCisJc2VsZWN0IERSTV9UVE0KKwloZWxwCisJICBIZWxwZXJzIGZv
ciBWUkFNIG1lbW9yeSBtYW5hZ2VtZW50CisKIGNvbmZpZyBEUk1fR0VNX0NNQV9IRUxQRVIKIAli
b29sCiAJZGVwZW5kcyBvbiBEUk0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9NYWtlZmls
ZSBiL2RyaXZlcnMvZ3B1L2RybS9NYWtlZmlsZQppbmRleCA3MmY1MDM2ZDliZmEuLmVkNDliMjQ4
MDc2NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL01ha2VmaWxlCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9NYWtlZmlsZQpAQCAtMzIsNiArMzIsMTAgQEAgZHJtLSQoQ09ORklHX0FHUCkgKz0g
ZHJtX2FncHN1cHBvcnQubwogZHJtLSQoQ09ORklHX0RFQlVHX0ZTKSArPSBkcm1fZGVidWdmcy5v
IGRybV9kZWJ1Z2ZzX2NyYy5vCiBkcm0tJChDT05GSUdfRFJNX0xPQURfRURJRF9GSVJNV0FSRSkg
Kz0gZHJtX2VkaWRfbG9hZC5vCiAKK2RybV92cmFtX2hlbHBlci15IDo9IGRybV9nZW1fdnJhbV9o
ZWxwZXIubyBcCisJCSAgICAgZHJtX3ZyYW1faGVscGVyX2NvbW1vbi5vCitvYmotJChDT05GSUdf
RFJNX1ZSQU1fSEVMUEVSKSArPSBkcm1fdnJhbV9oZWxwZXIubworCiBkcm1fa21zX2hlbHBlci15
IDo9IGRybV9jcnRjX2hlbHBlci5vIGRybV9kcF9oZWxwZXIubyBkcm1fZHNjLm8gZHJtX3Byb2Jl
X2hlbHBlci5vIFwKIAkJZHJtX3BsYW5lX2hlbHBlci5vIGRybV9kcF9tc3RfdG9wb2xvZ3kubyBk
cm1fYXRvbWljX2hlbHBlci5vIFwKIAkJZHJtX2ttc19oZWxwZXJfY29tbW9uLm8gZHJtX2RwX2R1
YWxfbW9kZV9oZWxwZXIubyBcCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2dlbV92
cmFtX2hlbHBlci5jIGIvZHJpdmVycy9ncHUvZHJtL2RybV9nZW1fdnJhbV9oZWxwZXIuYwpuZXcg
ZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjc2MWE1NDY0MTJmOAotLS0gL2Rl
di9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMKQEAgLTAs
MCArMSw0MTIgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9yLWxhdGVy
CisKKyNpbmNsdWRlIDxkcm0vZHJtX2dlbV92cmFtX2hlbHBlci5oPgorI2luY2x1ZGUgPGRybS90
dG0vdHRtX3BhZ2VfYWxsb2MuaD4KKworLyoqCisgKiBET0M6IG92ZXJ2aWV3CisgKgorICogVGhp
cyBsaWJyYXJ5IHByb3ZpZGVzIGEgR0VNIGJ1ZmZlciBvYmplY3QgdGhhdCBpcyBiYWNrZWQgYnkg
dmlkZW8gUkFNCisgKiAoVlJBTSkuIEl0IGNhbiBiZSB1c2VkIGZvciBmcmFtZWJ1ZmZlciBkZXZp
Y2VzIHdpdGggZGVkaWNhdGVkIG1lbW9yeS4KKyAqLworCisvKgorICogQnVmZmVyLW9iamVjdHMg
aGVscGVycworICovCisKK3N0YXRpYyB2b2lkIGRybV9nZW1fdnJhbV9jbGVhbnVwKHN0cnVjdCBk
cm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8pCit7CisJLyogV2UgZ290IGhlcmUgdmlhIHR0bV9ib19w
dXQoKSwgd2hpY2ggbWVhbnMgdGhhdCB0aGUKKwkgKiBUVE0gYnVmZmVyIG9iamVjdCBpbiAnYm8n
IGhhcyBhbHJlYWR5IGJlZW4gY2xlYW5lZAorCSAqIHVwOyBvbmx5IHJlbGVhc2UgdGhlIEdFTSBv
YmplY3QuCisJICovCisJZHJtX2dlbV9vYmplY3RfcmVsZWFzZSgmZ2JvLT5nZW0pOworfQorCitz
dGF0aWMgdm9pZCBkcm1fZ2VtX3ZyYW1fZGVzdHJveShzdHJ1Y3QgZHJtX2dlbV92cmFtX29iamVj
dCAqZ2JvKQoreworCWRybV9nZW1fdnJhbV9jbGVhbnVwKGdibyk7CisJa2ZyZWUoZ2JvKTsKK30K
Kworc3RhdGljIHZvaWQgdHRtX2J1ZmZlcl9vYmplY3RfZGVzdHJveShzdHJ1Y3QgdHRtX2J1ZmZl
cl9vYmplY3QgKmJvKQoreworCXN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8gPSBkcm1f
Z2VtX3ZyYW1fb2ZfYm8oYm8pOworCisJZHJtX2dlbV92cmFtX2Rlc3Ryb3koZ2JvKTsKK30KKwor
c3RhdGljIHZvaWQgZHJtX2dlbV92cmFtX3BsYWNlbWVudChzdHJ1Y3QgZHJtX2dlbV92cmFtX29i
amVjdCAqZ2JvLAorCQkJCSAgIHVuc2lnbmVkIGxvbmcgcGxfZmxhZykKK3sKKwl1bnNpZ25lZCBp
bnQgaTsKKwl1bnNpZ25lZCBpbnQgYyA9IDA7CisKKwlnYm8tPnBsYWNlbWVudC5wbGFjZW1lbnQg
PSBnYm8tPnBsYWNlbWVudHM7CisJZ2JvLT5wbGFjZW1lbnQuYnVzeV9wbGFjZW1lbnQgPSBnYm8t
PnBsYWNlbWVudHM7CisKKwlpZiAocGxfZmxhZyAmIFRUTV9QTF9GTEFHX1ZSQU0pCisJCWdiby0+
cGxhY2VtZW50c1tjKytdLmZsYWdzID0gVFRNX1BMX0ZMQUdfV0MgfAorCQkJCQkgICAgIFRUTV9Q
TF9GTEFHX1VOQ0FDSEVEIHwKKwkJCQkJICAgICBUVE1fUExfRkxBR19WUkFNOworCisJaWYgKHBs
X2ZsYWcgJiBUVE1fUExfRkxBR19TWVNURU0pCisJCWdiby0+cGxhY2VtZW50c1tjKytdLmZsYWdz
ID0gVFRNX1BMX01BU0tfQ0FDSElORyB8CisJCQkJCSAgICAgVFRNX1BMX0ZMQUdfU1lTVEVNOwor
CisJaWYgKCFjKQorCQlnYm8tPnBsYWNlbWVudHNbYysrXS5mbGFncyA9IFRUTV9QTF9NQVNLX0NB
Q0hJTkcgfAorCQkJCQkgICAgIFRUTV9QTF9GTEFHX1NZU1RFTTsKKworCWdiby0+cGxhY2VtZW50
Lm51bV9wbGFjZW1lbnQgPSBjOworCWdiby0+cGxhY2VtZW50Lm51bV9idXN5X3BsYWNlbWVudCA9
IGM7CisKKwlmb3IgKGkgPSAwOyBpIDwgYzsgKytpKSB7CisJCWdiby0+cGxhY2VtZW50c1tpXS5m
cGZuID0gMDsKKwkJZ2JvLT5wbGFjZW1lbnRzW2ldLmxwZm4gPSAwOworCX0KK30KKworc3RhdGlj
IGludCBkcm1fZ2VtX3ZyYW1faW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAorCQkJICAgICBz
dHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKKwkJCSAgICAgc3RydWN0IGRybV9nZW1fdnJhbV9v
YmplY3QgKmdibywKKwkJCSAgICAgc2l6ZV90IHNpemUsIHVuc2lnbmVkIGxvbmcgcGdfYWxpZ24s
CisJCQkgICAgIGJvb2wgaW50ZXJydXB0aWJsZSkKK3sKKwlpbnQgcmV0OworCXNpemVfdCBhY2Nf
c2l6ZTsKKworCXJldCA9IGRybV9nZW1fb2JqZWN0X2luaXQoZGV2LCAmZ2JvLT5nZW0sIHNpemUp
OworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwlhY2Nfc2l6ZSA9IHR0bV9ib19kbWFfYWNj
X3NpemUoYmRldiwgc2l6ZSwgc2l6ZW9mKCpnYm8pKTsKKworCWdiby0+Ym8uYmRldiA9IGJkZXY7
CisJZHJtX2dlbV92cmFtX3BsYWNlbWVudChnYm8sIFRUTV9QTF9GTEFHX1ZSQU0gfCBUVE1fUExf
RkxBR19TWVNURU0pOworCisJcmV0ID0gdHRtX2JvX2luaXQoYmRldiwgJmdiby0+Ym8sIHNpemUs
IHR0bV9ib190eXBlX2RldmljZSwKKwkJCSAgJmdiby0+cGxhY2VtZW50LCBwZ19hbGlnbiwgaW50
ZXJydXB0aWJsZSwgYWNjX3NpemUsCisJCQkgIE5VTEwsIE5VTEwsIHR0bV9idWZmZXJfb2JqZWN0
X2Rlc3Ryb3kpOworCWlmIChyZXQpCisJCWdvdG8gZXJyX2RybV9nZW1fb2JqZWN0X3JlbGVhc2U7
CisKKwlyZXR1cm4gMDsKKworZXJyX2RybV9nZW1fb2JqZWN0X3JlbGVhc2U6CisJZHJtX2dlbV9v
YmplY3RfcmVsZWFzZSgmZ2JvLT5nZW0pOworCXJldHVybiByZXQ7Cit9CisKKy8qKgorICogZHJt
X2dlbV92cmFtX2NyZWF0ZSgpIC0gQ3JlYXRlcyBhIFZSQU0tYmFja2VkIEdFTSBvYmplY3QKKyAq
IEBkZXY6CQl0aGUgRFJNIGRldmljZQorICogQGJkZXY6CQl0aGUgVFRNIEJPIGRldmljZSBiYWNr
aW5nIHRoZSBvYmplY3QKKyAqIEBzaXplOgkJdGhlIGJ1ZmZlciBzaXplIGluIGJ5dGVzCisgKiBA
cGdfYWxpZ246CQl0aGUgYnVmZmVyJ3MgYWxpZ25tZW50IGluIG11bHRpcGxlcyBvZiB0aGUgcGFn
ZSBzaXplCisgKiBAaW50ZXJydXB0aWJsZToJc2xlZXAgaW50ZXJydXB0aWJsZSBpZiB3YWl0aW5n
IGZvciBtZW1vcnkKKyAqCisgKiBSZXR1cm5zOgorICogQSBuZXcgaW5zdGFuY2Ugb2YgJnN0cnVj
dCBkcm1fZ2VtX3ZyYW1fb2JqZWN0IG9uIHN1Y2Nlc3MsIG9yCisgKiBhbiBFUlJfUFRSKCktZW5j
b2RlZCBlcnJvciBjb2RlIG90aGVyd2lzZS4KKyAqLworc3RydWN0IGRybV9nZW1fdnJhbV9vYmpl
Y3QgKmRybV9nZW1fdnJhbV9jcmVhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKKwkJCQkJCXN0
cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAorCQkJCQkJc2l6ZV90IHNpemUsCisJCQkJCQl1bnNp
Z25lZCBsb25nIHBnX2FsaWduLAorCQkJCQkJYm9vbCBpbnRlcnJ1cHRpYmxlKQoreworCXN0cnVj
dCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm87CisJaW50IHJldDsKKworCWdibyA9IGt6YWxsb2Mo
c2l6ZW9mKCpnYm8pLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWdibykKKwkJcmV0dXJuIEVSUl9QVFIo
LUVOT01FTSk7CisKKwlyZXQgPSBkcm1fZ2VtX3ZyYW1faW5pdChkZXYsIGJkZXYsIGdibywgc2l6
ZSwgcGdfYWxpZ24sIGludGVycnVwdGlibGUpOworCWlmIChyZXQgPCAwKQorCQlnb3RvIGVycl9r
ZnJlZTsKKworCXJldHVybiBnYm87CisKK2Vycl9rZnJlZToKKwlrZnJlZShnYm8pOworCXJldHVy
biBFUlJfUFRSKHJldCk7Cit9CitFWFBPUlRfU1lNQk9MKGRybV9nZW1fdnJhbV9jcmVhdGUpOwor
CisvKioKKyAqIGRybV9nZW1fdnJhbV9wdXQoKSAtIFJlbGVhc2VzIGEgcmVmZXJlbmNlIHRvIGEg
VlJBTS1iYWNrZWQgR0VNIG9iamVjdAorICogQGdibzoJdGhlIEdFTSBWUkFNIG9iamVjdAorICoK
KyAqIFNlZSB0dG1fYm9fcHV0KCkgZm9yIG1vcmUgaW5mb3JtYXRpb24uCisgKi8KK3ZvaWQgZHJt
X2dlbV92cmFtX3B1dChzdHJ1Y3QgZHJtX2dlbV92cmFtX29iamVjdCAqZ2JvKQoreworCXR0bV9i
b19wdXQoJmdiby0+Ym8pOworfQorRVhQT1JUX1NZTUJPTChkcm1fZ2VtX3ZyYW1fcHV0KTsKKwor
LyoqCisgKiBkcm1fZ2VtX3ZyYW1fcmVzZXJ2ZSgpIC0gUmVzZXJ2ZXMgYSBWUkFNLWJhY2tlZCBH
RU0gb2JqZWN0CisgKiBAZ2JvOgl0aGUgR0VNIFZSQU0gb2JqZWN0CisgKiBAbm9fd2FpdDoJZG9u
J3Qgd2FpdCBmb3IgYnVmZmVyIG9iamVjdCB0byBiZWNvbWUgYXZhaWxhYmxlCisgKgorICogU2Vl
IHR0bV9ib19yZXNlcnZlKCkgZm9yIG1vcmUgaW5mb3JtYXRpb24uCisgKgorICogUmV0dXJuczoK
KyAqIDAgb24gc3VjY2Vzcywgb3IKKyAqIGEgbmVnYXRpdmUgZXJyb3IgY29kZSBvdGhlcndpc2UK
KyAqLworaW50IGRybV9nZW1fdnJhbV9yZXNlcnZlKHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0
ICpnYm8sIGJvb2wgbm9fd2FpdCkKK3sKKwlyZXR1cm4gdHRtX2JvX3Jlc2VydmUoJmdiby0+Ym8s
IHRydWUsIG5vX3dhaXQsIE5VTEwpOworfQorRVhQT1JUX1NZTUJPTChkcm1fZ2VtX3ZyYW1fcmVz
ZXJ2ZSk7CisKKy8qKgorICogZHJtX2dlbV92cmFtX3VucmVzZXJ2ZSgpIC0gXAorCVJlbGVhc2Ug
YSByZXNlcnZhdGlvbiBhY3F1aXJlZCBieSBkcm1fZ2VtX3ZyYW1fcmVzZXJ2ZSgpCisgKiBAZ2Jv
Ogl0aGUgR0VNIFZSQU0gb2JqZWN0CisgKgorICogU2VlIHR0bV9ib191bnJlc2VydmUoKSBmb3Ig
bW9yZSBpbmZvcm1hdGlvbi4KKyAqLwordm9pZCBkcm1fZ2VtX3ZyYW1fdW5yZXNlcnZlKHN0cnVj
dCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8pCit7CisJdHRtX2JvX3VucmVzZXJ2ZSgmZ2JvLT5i
byk7Cit9CitFWFBPUlRfU1lNQk9MKGRybV9nZW1fdnJhbV91bnJlc2VydmUpOworCisvKioKKyAq
IGRybV9nZW1fdnJhbV9tbWFwX29mZnNldCgpIC0gUmV0dXJucyBhIEdFTSBWUkFNIG9iamVjdCdz
IG1tYXAgb2Zmc2V0CisgKiBAZ2JvOgl0aGUgR0VNIFZSQU0gb2JqZWN0CisgKgorICogU2VlIGRy
bV92bWFfbm9kZV9vZmZzZXRfYWRkcigpIGZvciBtb3JlIGluZm9ybWF0aW9uLgorICoKKyAqIFJl
dHVybnM6CisgKiBUaGUgYnVmZmVyIG9iamVjdCdzIG9mZnNldCBmb3IgdXNlcnNwYWNlIG1hcHBp
bmdzIG9uIHN1Y2Nlc3MsIG9yCisgKiAwIGlmIG5vIG9mZnNldCBpcyBhbGxvY2F0ZWQuCisgKi8K
K3U2NCBkcm1fZ2VtX3ZyYW1fbW1hcF9vZmZzZXQoc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3Qg
KmdibykKK3sKKwlyZXR1cm4gZHJtX3ZtYV9ub2RlX29mZnNldF9hZGRyKCZnYm8tPmJvLnZtYV9u
b2RlKTsKK30KK0VYUE9SVF9TWU1CT0woZHJtX2dlbV92cmFtX21tYXBfb2Zmc2V0KTsKKworLyoq
CisgKiBkcm1fZ2VtX3ZyYW1fb2Zmc2V0KCkgLSBcCisJUmV0dXJucyBhIEdFTSBWUkFNIG9iamVj
dCdzIG9mZnNldCBpbiB2aWRlbyBtZW1vcnkKKyAqIEBnYm86CXRoZSBHRU0gVlJBTSBvYmplY3QK
KyAqCisgKiBUaGlzIGZ1bmN0aW9uIHJldHVybnMgdGhlIGJ1ZmZlciBvYmplY3QncyBvZmZzZXQg
aW4gdGhlIGRldmljZSdzIHZpZGVvCisgKiBtZW1vcnkuIFRoZSBidWZmZXIgb2JqZWN0IGhhcyB0
byBiZSBwaW5uZWQgdG8gJVRUTV9QTF9WUkFNLgorICoKKyAqIFJldHVybnM6CisgKiBUaGUgYnVm
ZmVyIG9iamVjdCdzIG9mZnNldCBpbiB2aWRlbyBtZW1vcnkgb24gc3VjY2Vzcywgb3IKKyAqIGEg
bmVnYXRpdmUgZXJybm8gY29kZSBvdGhlcndpc2UuCisgKi8KK3M2NCBkcm1fZ2VtX3ZyYW1fb2Zm
c2V0KHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8pCit7CisJaWYgKFdBUk5fT05fT05D
RSghZ2JvLT5waW5fY291bnQpKQorCQlyZXR1cm4gKHM2NCktRU5PREVWOworCXJldHVybiBnYm8t
PmJvLm9mZnNldDsKK30KK0VYUE9SVF9TWU1CT0woZHJtX2dlbV92cmFtX29mZnNldCk7CisKKy8q
KgorICogZHJtX2dlbV92cmFtX3BpbigpIC0gUGlucyBhIEdFTSBWUkFNIG9iamVjdCBpbiBhIHJl
Z2lvbi4KKyAqIEBnYm86CXRoZSBHRU0gVlJBTSBvYmplY3QKKyAqIEBwbF9mbGFnOglhIGJpdG1h
c2sgb2YgcG9zc2libGUgbWVtb3J5IHJlZ2lvbnMKKyAqCisgKiBQaW5uaW5nIGEgYnVmZmVyIG9i
amVjdCBlbnN1cmVzIHRoYXQgaXQgaXMgbm90IGV2aWN0ZWQgZnJvbQorICogYSBtZW1vcnkgcmVn
aW9uLiBBIHBpbm5lZCBidWZmZXIgb2JqZWN0IGhhcyB0byBiZSB1bnBpbm5lZCBiZWZvcmUKKyAq
IGl0IGNhbiBiZSBwaW5uZWQgdG8gYW5vdGhlciByZWdpb24uCisgKgorICogUmV0dXJuczoKKyAq
IDAgb24gc3VjY2Vzcywgb3IKKyAqIGEgbmVnYXRpdmUgZXJyb3IgY29kZSBvdGhlcndpc2UuCisg
Ki8KK2ludCBkcm1fZ2VtX3ZyYW1fcGluKHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8s
IHVuc2lnbmVkIGxvbmcgcGxfZmxhZykKK3sKKwlpbnQgaSwgcmV0OworCXN0cnVjdCB0dG1fb3Bl
cmF0aW9uX2N0eCBjdHggPSB7IGZhbHNlLCBmYWxzZSB9OworCisJaWYgKGdiby0+cGluX2NvdW50
KSB7CisJCSsrZ2JvLT5waW5fY291bnQ7CisJCXJldHVybiAwOworCX0KKworCWRybV9nZW1fdnJh
bV9wbGFjZW1lbnQoZ2JvLCBwbF9mbGFnKTsKKwlmb3IgKGkgPSAwOyBpIDwgZ2JvLT5wbGFjZW1l
bnQubnVtX3BsYWNlbWVudDsgKytpKQorCQlnYm8tPnBsYWNlbWVudHNbaV0uZmxhZ3MgfD0gVFRN
X1BMX0ZMQUdfTk9fRVZJQ1Q7CisKKwlyZXQgPSB0dG1fYm9fdmFsaWRhdGUoJmdiby0+Ym8sICZn
Ym8tPnBsYWNlbWVudCwgJmN0eCk7CisJaWYgKHJldCA8IDApCisJCXJldHVybiByZXQ7CisKKwln
Ym8tPnBpbl9jb3VudCA9IDE7CisKKwlyZXR1cm4gMDsKK30KK0VYUE9SVF9TWU1CT0woZHJtX2dl
bV92cmFtX3Bpbik7CisKKy8qKgorICogZHJtX2dlbV92cmFtX3VucGluKCkgLSBVbnBpbnMgYSBH
RU0gVlJBTSBvYmplY3QKKyAqIEBnYm86CXRoZSBHRU0gVlJBTSBvYmplY3QKKyAqCisgKiBSZXR1
cm5zOgorICogMCBvbiBzdWNjZXNzLCBvcgorICogYSBuZWdhdGl2ZSBlcnJvciBjb2RlIG90aGVy
d2lzZS4KKyAqLworaW50IGRybV9nZW1fdnJhbV91bnBpbihzdHJ1Y3QgZHJtX2dlbV92cmFtX29i
amVjdCAqZ2JvKQoreworCWludCBpLCByZXQ7CisJc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4IGN0
eCA9IHsgZmFsc2UsIGZhbHNlIH07CisKKwlpZiAoV0FSTl9PTl9PTkNFKCFnYm8tPnBpbl9jb3Vu
dCkpCisJCXJldHVybiAwOworCisJLS1nYm8tPnBpbl9jb3VudDsKKwlpZiAoZ2JvLT5waW5fY291
bnQpCisJCXJldHVybiAwOworCisJZm9yIChpID0gMDsgaSA8IGdiby0+cGxhY2VtZW50Lm51bV9w
bGFjZW1lbnQgOyArK2kpCisJCWdiby0+cGxhY2VtZW50c1tpXS5mbGFncyAmPSB+VFRNX1BMX0ZM
QUdfTk9fRVZJQ1Q7CisKKwlyZXQgPSB0dG1fYm9fdmFsaWRhdGUoJmdiby0+Ym8sICZnYm8tPnBs
YWNlbWVudCwgJmN0eCk7CisJaWYgKHJldCA8IDApCisJCXJldHVybiByZXQ7CisKKwlyZXR1cm4g
MDsKK30KK0VYUE9SVF9TWU1CT0woZHJtX2dlbV92cmFtX3VucGluKTsKKworLyoqCisgKiBkcm1f
Z2VtX3ZyYW1fcHVzaF90b19zeXN0ZW0oKSAtIFwKKwlVbnBpbnMgYSBHRU0gVlJBTSBvYmplY3Qg
YW5kIG1vdmVzIGl0IHRvIHN5c3RlbSBtZW1vcnkKKyAqIEBnYm86CXRoZSBHRU0gVlJBTSBvYmpl
Y3QKKyAqCisgKiBUaGlzIG9wZXJhdGlvbiBvbmx5IHdvcmtzIGlmIHRoZSBjYWxsZXIgaG9sZHMg
dGhlIGZpbmFsIHBpbiBvbiB0aGUKKyAqIGJ1ZmZlciBvYmplY3QuCisgKgorICogUmV0dXJuczoK
KyAqIDAgb24gc3VjY2Vzcywgb3IKKyAqIGEgbmVnYXRpdmUgZXJyb3IgY29kZSBvdGhlcndpc2Uu
CisgKi8KK2ludCBkcm1fZ2VtX3ZyYW1fcHVzaF90b19zeXN0ZW0oc3RydWN0IGRybV9nZW1fdnJh
bV9vYmplY3QgKmdibykKK3sKKwlpbnQgaSwgcmV0OworCXN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0
eCBjdHggPSB7IGZhbHNlLCBmYWxzZSB9OworCisJaWYgKFdBUk5fT05fT05DRSghZ2JvLT5waW5f
Y291bnQpKQorCQlyZXR1cm4gMDsKKworCS0tZ2JvLT5waW5fY291bnQ7CisJaWYgKGdiby0+cGlu
X2NvdW50KQorCQlyZXR1cm4gMDsKKworCWlmIChnYm8tPmttYXAudmlydHVhbCkKKwkJdHRtX2Jv
X2t1bm1hcCgmZ2JvLT5rbWFwKTsKKworCWRybV9nZW1fdnJhbV9wbGFjZW1lbnQoZ2JvLCBUVE1f
UExfRkxBR19TWVNURU0pOworCWZvciAoaSA9IDA7IGkgPCBnYm8tPnBsYWNlbWVudC5udW1fcGxh
Y2VtZW50IDsgKytpKQorCQlnYm8tPnBsYWNlbWVudHNbaV0uZmxhZ3MgfD0gVFRNX1BMX0ZMQUdf
Tk9fRVZJQ1Q7CisKKwlyZXQgPSB0dG1fYm9fdmFsaWRhdGUoJmdiby0+Ym8sICZnYm8tPnBsYWNl
bWVudCwgJmN0eCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCXJldHVybiAwOworfQor
RVhQT1JUX1NZTUJPTChkcm1fZ2VtX3ZyYW1fcHVzaF90b19zeXN0ZW0pOworCisvKioKKyAqIGRy
bV9nZW1fdnJhbV9rbWFwX2F0KCkgLSBNYXBzIGEgR0VNIFZSQU0gb2JqZWN0IGludG8ga2VybmVs
IGFkZHJlc3Mgc3BhY2UKKyAqIEBnYm86CXRoZSBHRU0gVlJBTSBvYmplY3QKKyAqIEBtYXA6CWVz
dGFibGlzaCBhIG1hcHBpbmcgaWYgbmVjZXNzYXJ5CisgKiBAaXNfaW9tZW06CXJldHVybnMgdHJ1
ZSBpZiB0aGUgbWFwcGVkIG1lbW9yeSBpcyBJL08gbWVtb3J5LCBvciBmYWxzZSBcCisJb3RoZXJ3
aXNlOyBjYW4gYmUgTlVMTAorICogQGttYXA6CXRoZSBtYXBwaW5nJ3Mga21hcCBvYmplY3QKKyAq
CisgKiBUaGlzIGZ1bmN0aW9uIG1hcHMgdGhlIGJ1ZmZlciBvYmplY3QgaW50byB0aGUga2VybmVs
J3MgYWRkcmVzcyBzcGFjZQorICogb3IgcmV0dXJucyB0aGUgY3VycmVudCBtYXBwaW5nLiBJZiB0
aGUgcGFyYW1ldGVyIG1hcCBpcyBmYWxzZSwgdGhlCisgKiBmdW5jdGlvbiBvbmx5IHF1ZXJpZXMg
dGhlIGN1cnJlbnQgbWFwcGluZywgYnV0IGRvZXMgbm90IGVzdGFibGlzaCBhCisgKiBuZXcgb25l
LgorICoKKyAqIFJldHVybnM6CisgKiBUaGUgYnVmZmVycyB2aXJ0dWFsIGFkZHJlc3MgaWYgbWFw
cGVkLCBvcgorICogTlVMTCBpZiBub3QgbWFwcGVkLCBvcgorICogYW4gRVJSX1BUUigpLWVuY29k
ZWQgZXJyb3IgY29kZSBvdGhlcndpc2UuCisgKi8KK3ZvaWQgKmRybV9nZW1fdnJhbV9rbWFwX2F0
KHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8sIGJvb2wgbWFwLAorCQkJICAgYm9vbCAq
aXNfaW9tZW0sIHN0cnVjdCB0dG1fYm9fa21hcF9vYmogKmttYXApCit7CisJaW50IHJldDsKKwor
CWlmIChrbWFwLT52aXJ0dWFsIHx8ICFtYXApCisJCWdvdG8gb3V0OworCisJcmV0ID0gdHRtX2Jv
X2ttYXAoJmdiby0+Ym8sIDAsIGdiby0+Ym8ubnVtX3BhZ2VzLCBrbWFwKTsKKwlpZiAocmV0KQor
CQlyZXR1cm4gRVJSX1BUUihyZXQpOworCitvdXQ6CisJaWYgKCFpc19pb21lbSkKKwkJcmV0dXJu
IGttYXAtPnZpcnR1YWw7CisJaWYgKCFrbWFwLT52aXJ0dWFsKSB7CisJCSppc19pb21lbSA9IGZh
bHNlOworCQlyZXR1cm4gTlVMTDsKKwl9CisJcmV0dXJuIHR0bV9rbWFwX29ial92aXJ0dWFsKGtt
YXAsIGlzX2lvbWVtKTsKK30KK0VYUE9SVF9TWU1CT0woZHJtX2dlbV92cmFtX2ttYXBfYXQpOwor
CisvKioKKyAqIGRybV9nZW1fdnJhbV9rbWFwKCkgLSBNYXBzIGEgR0VNIFZSQU0gb2JqZWN0IGlu
dG8ga2VybmVsIGFkZHJlc3Mgc3BhY2UKKyAqIEBnYm86CXRoZSBHRU0gVlJBTSBvYmplY3QKKyAq
IEBtYXA6CWVzdGFibGlzaCBhIG1hcHBpbmcgaWYgbmVjZXNzYXJ5CisgKiBAaXNfaW9tZW06CXJl
dHVybnMgdHJ1ZSBpZiB0aGUgbWFwcGVkIG1lbW9yeSBpcyBJL08gbWVtb3J5LCBvciBmYWxzZSBc
CisJb3RoZXJ3aXNlOyBjYW4gYmUgTlVMTAorICoKKyAqIFRoaXMgZnVuY3Rpb24gbWFwcyB0aGUg
YnVmZmVyIG9iamVjdCBpbnRvIHRoZSBrZXJuZWwncyBhZGRyZXNzIHNwYWNlCisgKiBvciByZXR1
cm5zIHRoZSBjdXJyZW50IG1hcHBpbmcuIElmIHRoZSBwYXJhbWV0ZXIgbWFwIGlzIGZhbHNlLCB0
aGUKKyAqIGZ1bmN0aW9uIG9ubHkgcXVlcmllcyB0aGUgY3VycmVudCBtYXBwaW5nLCBidXQgZG9l
cyBub3QgZXN0YWJsaXNoIGEKKyAqIG5ldyBvbmUuCisgKgorICogUmV0dXJuczoKKyAqIFRoZSBi
dWZmZXJzIHZpcnR1YWwgYWRkcmVzcyBpZiBtYXBwZWQsIG9yCisgKiBOVUxMIGlmIG5vdCBtYXBw
ZWQsIG9yCisgKiBhbiBFUlJfUFRSKCktZW5jb2RlZCBlcnJvciBjb2RlIG90aGVyd2lzZS4KKyAq
Lwordm9pZCAqZHJtX2dlbV92cmFtX2ttYXAoc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKmdi
bywgYm9vbCBtYXAsCisJCQlib29sICppc19pb21lbSkKK3sKKwlyZXR1cm4gZHJtX2dlbV92cmFt
X2ttYXBfYXQoZ2JvLCBtYXAsIGlzX2lvbWVtLCAmZ2JvLT5rbWFwKTsKK30KK0VYUE9SVF9TWU1C
T0woZHJtX2dlbV92cmFtX2ttYXApOworCisvKioKKyAqIGRybV9nZW1fdnJhbV9rdW5tYXBfYXQo
KSAtIFVubWFwcyBhIEdFTSBWUkFNIG9iamVjdAorICogQGdibzoJdGhlIEdFTSBWUkFNIG9iamVj
dAorICogQGttYXA6CXRoZSBtYXBwaW5nJ3Mga21hcCBvYmplY3QKKyAqLwordm9pZCBkcm1fZ2Vt
X3ZyYW1fa3VubWFwX2F0KHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8sCisJCQkgICAg
c3RydWN0IHR0bV9ib19rbWFwX29iaiAqa21hcCkKK3sKKwlpZiAoIWttYXAtPnZpcnR1YWwpCisJ
CXJldHVybjsKKworCXR0bV9ib19rdW5tYXAoa21hcCk7CisJa21hcC0+dmlydHVhbCA9IE5VTEw7
Cit9CitFWFBPUlRfU1lNQk9MKGRybV9nZW1fdnJhbV9rdW5tYXBfYXQpOworCisvKioKKyAqIGRy
bV9nZW1fdnJhbV9rdW5tYXAoKSAtIFVubWFwcyBhIEdFTSBWUkFNIG9iamVjdAorICogQGdibzoJ
dGhlIEdFTSBWUkFNIG9iamVjdAorICovCit2b2lkIGRybV9nZW1fdnJhbV9rdW5tYXAoc3RydWN0
IGRybV9nZW1fdnJhbV9vYmplY3QgKmdibykKK3sKKwlkcm1fZ2VtX3ZyYW1fa3VubWFwX2F0KGdi
bywgJmdiby0+a21hcCk7Cit9CitFWFBPUlRfU1lNQk9MKGRybV9nZW1fdnJhbV9rdW5tYXApOwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2RybV92cmFtX2hlbHBlcl9jb21tb24uYyBiL2Ry
aXZlcnMvZ3B1L2RybS9kcm1fdnJhbV9oZWxwZXJfY29tbW9uLmMKbmV3IGZpbGUgbW9kZSAxMDA2
NDQKaW5kZXggMDAwMDAwMDAwMDAwLi43YzI1ZGFjYTE4ZDAKLS0tIC9kZXYvbnVsbAorKysgYi9k
cml2ZXJzL2dwdS9kcm0vZHJtX3ZyYW1faGVscGVyX2NvbW1vbi5jCkBAIC0wLDAgKzEsNiBAQAor
Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb3ItbGF0ZXIKKworI2luY2x1ZGUg
PGxpbnV4L21vZHVsZS5oPgorCitNT0RVTEVfREVTQ1JJUFRJT04oIkRSTSBWUkFNIG1lbW9yeS1t
YW5hZ2VtZW50IGhlbHBlcnMiKTsKK01PRFVMRV9MSUNFTlNFKCJHUEwiKTsKZGlmZiAtLWdpdCBh
L2luY2x1ZGUvZHJtL2RybV9nZW1fdnJhbV9oZWxwZXIuaCBiL2luY2x1ZGUvZHJtL2RybV9nZW1f
dnJhbV9oZWxwZXIuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjU4
MDJkZDY5NDkzOQotLS0gL2Rldi9udWxsCisrKyBiL2luY2x1ZGUvZHJtL2RybV9nZW1fdnJhbV9o
ZWxwZXIuaApAQCAtMCwwICsxLDkyIEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BM
LTIuMC1vci1sYXRlciAqLworCisjaWZuZGVmIERSTV9HRU1fVlJBTV9IRUxQRVJfSAorI2RlZmlu
ZSBEUk1fR0VNX1ZSQU1fSEVMUEVSX0gKKworI2luY2x1ZGUgPGRybS9kcm1fZ2VtLmg+CisjaW5j
bHVkZSA8ZHJtL3R0bS90dG1fYm9fYXBpLmg+CisjaW5jbHVkZSA8ZHJtL3R0bS90dG1fcGxhY2Vt
ZW50Lmg+CisjaW5jbHVkZSA8bGludXgva2VybmVsLmg+IC8qIGZvciBjb250YWluZXJfb2YoKSAq
LworCitzdHJ1Y3QgZmlscDsKKworI2RlZmluZSBEUk1fR0VNX1ZSQU1fUExfRkxBR19WUkFNCVRU
TV9QTF9GTEFHX1ZSQU0KKyNkZWZpbmUgRFJNX0dFTV9WUkFNX1BMX0ZMQUdfU1lTVEVNCVRUTV9Q
TF9GTEFHX1NZU1RFTQorCisvKgorICogQnVmZmVyLW9iamVjdCBoZWxwZXJzCisgKi8KKworLyoq
CisgKiBzdHJ1Y3QgZHJtX2dlbV92cmFtX29iamVjdCAtIEdFTSBvYmplY3QgYmFja2VkIGJ5IFZS
QU0KKyAqIEBnZW06CUdFTSBvYmplY3QKKyAqIEBibzoJCVRUTSBidWZmZXIgb2JqZWN0CisgKiBA
a21hcDoJTWFwcGluZyBpbmZvcm1hdGlvbiBmb3IgQGJvCisgKiBAcGxhY2VtZW50OglUVE0gcGxh
Y2VtZW50IGluZm9ybWF0aW9uLiBTdXBwb3J0ZWQgcGxhY2VtZW50cyBhcmUgXAorCSVUVE1fUExf
VlJBTSBhbmQgJVRUTV9QTF9TWVNURU0KKyAqIEBwbGFjZW1lbnRzOglUVE0gcGxhY2VtZW50IGlu
Zm9ybWF0aW9uLgorICogQHBpbl9jb3VudDoJUGluIGNvdW50ZXIKKyAqCisgKiBUaGUgdHlwZSBz
dHJ1Y3QgZHJtX2dlbV92cmFtX29iamVjdCByZXByZXNlbnRzIGEgR0VNIG9iamVjdCB0aGF0IGlz
CisgKiBiYWNrZWQgYnkgVlJBTS4gSXQgY2FuIGJlIHVzZWQgZm9yIHNpbXBsZSBmcmFtZWJ1ZmZl
ciBkZXZpY2VzIHdpdGgKKyAqIGRlZGljYXRlZCBtZW1vcnkuIFRoZSBidWZmZXIgb2JqZWN0IGNh
biBiZSBldmljdGVkIHRvIHN5c3RlbSBtZW1vcnkgaWYKKyAqIHZpZGVvIG1lbW9yeSBiZWNvbWVz
IHNjYXJjZS4KKyAqLworc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgeworCXN0cnVjdCBkcm1f
Z2VtX29iamVjdCBnZW07CisJc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0IGJvOworCXN0cnVjdCB0
dG1fYm9fa21hcF9vYmoga21hcDsKKworCS8qIFN1cHBvcnRlZCBwbGFjZW1lbnRzIGFyZSAlVFRN
X1BMX1ZSQU0gYW5kICVUVE1fUExfU1lTVEVNICovCisJc3RydWN0IHR0bV9wbGFjZW1lbnQgcGxh
Y2VtZW50OworCXN0cnVjdCB0dG1fcGxhY2UgcGxhY2VtZW50c1syXTsKKworCWludCBwaW5fY291
bnQ7Cit9OworCisvKioKKyAqIFJldHVybnMgdGhlIGNvbnRhaW5lciBvZiB0eXBlICZzdHJ1Y3Qg
ZHJtX2dlbV92cmFtX29iamVjdAorICogZm9yIGZpZWxkIGJvLgorICogQGJvOgkJdGhlIFZSQU0g
YnVmZmVyIG9iamVjdAorICogUmV0dXJuczoJVGhlIGNvbnRhaW5pbmcgR0VNIFZSQU0gb2JqZWN0
CisgKi8KK3N0YXRpYyBpbmxpbmUgc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKmRybV9nZW1f
dnJhbV9vZl9ibygKKwlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvKQoreworCXJldHVybiBj
b250YWluZXJfb2YoYm8sIHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0LCBibyk7Cit9CisKKy8q
KgorICogUmV0dXJucyB0aGUgY29udGFpbmVyIG9mIHR5cGUgJnN0cnVjdCBkcm1fZ2VtX3ZyYW1f
b2JqZWN0CisgKiBmb3IgZmllbGQgZ2VtLgorICogQGdlbToJdGhlIEdFTSBvYmplY3QKKyAqIFJl
dHVybnM6CVRoZSBjb250YWluaW5nIEdFTSBWUkFNIG9iamVjdAorICovCitzdGF0aWMgaW5saW5l
IHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpkcm1fZ2VtX3ZyYW1fb2ZfZ2VtKAorCXN0cnVj
dCBkcm1fZ2VtX29iamVjdCAqZ2VtKQoreworCXJldHVybiBjb250YWluZXJfb2YoZ2VtLCBzdHJ1
Y3QgZHJtX2dlbV92cmFtX29iamVjdCwgZ2VtKTsKK30KKworc3RydWN0IGRybV9nZW1fdnJhbV9v
YmplY3QgKmRybV9nZW1fdnJhbV9jcmVhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKKwkJCQkJ
CXN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAorCQkJCQkJc2l6ZV90IHNpemUsCisJCQkJCQl1
bnNpZ25lZCBsb25nIHBnX2FsaWduLAorCQkJCQkJYm9vbCBpbnRlcnJ1cHRpYmxlKTsKK3ZvaWQg
ZHJtX2dlbV92cmFtX3B1dChzdHJ1Y3QgZHJtX2dlbV92cmFtX29iamVjdCAqZ2JvKTsKK2ludCBk
cm1fZ2VtX3ZyYW1fcmVzZXJ2ZShzdHJ1Y3QgZHJtX2dlbV92cmFtX29iamVjdCAqZ2JvLCBib29s
IG5vX3dhaXQpOwordm9pZCBkcm1fZ2VtX3ZyYW1fdW5yZXNlcnZlKHN0cnVjdCBkcm1fZ2VtX3Zy
YW1fb2JqZWN0ICpnYm8pOwordTY0IGRybV9nZW1fdnJhbV9tbWFwX29mZnNldChzdHJ1Y3QgZHJt
X2dlbV92cmFtX29iamVjdCAqZ2JvKTsKK3M2NCBkcm1fZ2VtX3ZyYW1fb2Zmc2V0KHN0cnVjdCBk
cm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8pOworaW50IGRybV9nZW1fdnJhbV9waW4oc3RydWN0IGRy
bV9nZW1fdnJhbV9vYmplY3QgKmdibywgdW5zaWduZWQgbG9uZyBwbF9mbGFnKTsKK2ludCBkcm1f
Z2VtX3ZyYW1fdW5waW4oc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKmdibyk7CitpbnQgZHJt
X2dlbV92cmFtX3B1c2hfdG9fc3lzdGVtKHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8p
Owordm9pZCAqZHJtX2dlbV92cmFtX2ttYXBfYXQoc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3Qg
KmdibywgYm9vbCBtYXAsCisJCQkgICBib29sICppc19pb21lbSwgc3RydWN0IHR0bV9ib19rbWFw
X29iaiAqa21hcCk7Cit2b2lkICpkcm1fZ2VtX3ZyYW1fa21hcChzdHJ1Y3QgZHJtX2dlbV92cmFt
X29iamVjdCAqZ2JvLCBib29sIG1hcCwKKwkJCWJvb2wgKmlzX2lvbWVtKTsKK3ZvaWQgZHJtX2dl
bV92cmFtX2t1bm1hcF9hdChzdHJ1Y3QgZHJtX2dlbV92cmFtX29iamVjdCAqZ2JvLAorCQkJICAg
IHN0cnVjdCB0dG1fYm9fa21hcF9vYmogKmttYXApOwordm9pZCBkcm1fZ2VtX3ZyYW1fa3VubWFw
KHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8pOworCisjZW5kaWYKLS0gCjIuMjEuMAoK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVs
IG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlz
dHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
