Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8884682CAE
	for <lists+dri-devel@lfdr.de>; Tue,  6 Aug 2019 09:25:50 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1C1C26E303;
	Tue,  6 Aug 2019 07:24:43 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from onstation.org (onstation.org [52.200.56.107])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 815FE6E1E9;
 Tue,  6 Aug 2019 00:22:59 +0000 (UTC)
Received: from localhost.localdomain (c-98-239-145-235.hsd1.wv.comcast.net
 [98.239.145.235])
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits))
 (No client certificate requested) (Authenticated sender: masneyb)
 by onstation.org (Postfix) with ESMTPSA id 7E3B33E956;
 Tue,  6 Aug 2019 00:22:58 +0000 (UTC)
From: Brian Masney <masneyb@onstation.org>
To: agross@kernel.org, robdclark@gmail.com, sean@poorly.run,
 robh+dt@kernel.org, bjorn.andersson@linaro.org
Subject: [PATCH v5 5/7] soc: qcom: add OCMEM driver
Date: Mon,  5 Aug 2019 20:22:27 -0400
Message-Id: <20190806002229.8304-6-masneyb@onstation.org>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190806002229.8304-1-masneyb@onstation.org>
References: <20190806002229.8304-1-masneyb@onstation.org>
X-Mailman-Approved-At: Tue, 06 Aug 2019 07:24:35 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=onstation.org; s=default; t=1565050978;
 bh=f3M5io30Sg80mz08mQvla5zlHcHn+KSdB0m+6q0jDZQ=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=T4AUKdV/vCSyoVYSpXgvTBhbeDmBUxBmUXREtdwJIT0G4JpaOCHKJLhmd+ocszYcM
 LDsch55lK6e9eLnTzXVjRbZg5Ml+V1tTT/Ib7jtlB/WrfsJMYes/78vXuE4xz2X6DK
 5Ybh/amqu/GV0uPiLxWkCkd0+CUQv7I6Z8lwrCV8=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: mark.rutland@arm.com, devicetree@vger.kernel.org, jonathan@marek.ca,
 airlied@linux.ie, linux-arm-msm@vger.kernel.org, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, freedreno@lists.freedesktop.org
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIE9DTUVNIGRyaXZlciBoYW5kbGVzIGFsbG9jYXRpb24gYW5kIGNvbmZpZ3VyYXRpb24gb2Yg
dGhlIE9uIENoaXAKTUVNb3J5IHRoYXQgaXMgcHJlc2VudCBvbiBzb21lIFNuYXBkcmFnb24gU29D
cy4gRGV2aWNlcyB3aGljaCBoYXZlCk9DTUVNIGRvIG5vdCBoYXZlIEdNRU0gaW5zaWRlIHRoZSBH
UFUgY29yZSwgc28gdGhlIEdQVSBtdXN0IGluc3RlYWQKdXNlIE9DTUVNIHRvIGJlIGZ1bmN0aW9u
YWwuIFNpbmNlIHRoZSBHUFUgaXMgY3VycmVudGx5IHRoZSBvbmx5IE9DTUVNCnVzZXIgd2l0aCBh
biB1cHN0cmVhbSBkcml2ZXIsIHRoaXMgaXMganVzdCBhIG1pbmltYWwgaW1wbGVtZW50YXRpb24K
c3VmZmljaWVudCBmb3Igc3RhdGljYWxseSBhbGxvY2F0aW5nIHRvIHRoZSBHUFUgaXQncyBjaHVu
ayBvZiBPQ01FTS4KClRoaXMgZHJpdmVyIGN1cnJlbnRseSBkb2VzIG5vdCByZWFkIHRoZSBnbXUt
c3JhbSBub2RlIHRoYXQgaXMgZGVzY3JpYmVkCmluIHRoZSBkZXZpY2UgdHJlZSBiaW5kaW5ncy4g
VGhlIHN0YXJ0aW5nIG1lbW9yeSBhZGRyZXNzIG9mIHRoZSBHUFUncwpyZXNlcnZlZCBtZW1vcnkg
cmVnaW9uIGlzIGhhcmRjb2RlZCB0byB6ZXJvIHRvIG1hdGNoIHdoYXQgdGhlIGhhcmR3YXJlCmV4
cGVjdHMuIFRoZSBkcml2ZXIgY2FuIGJlIHVwZGF0ZWQgdG8gcmVhZCB0aGUgcmVzZXJ2ZWQgbWVt
b3J5IHJlZ2lvbnMKZnJvbSBkZXZpY2UgdHJlZSBvbmNlIG90aGVyIHVzZXJzIG9mIE9DTUVNIGFy
ZSBhZGRlZCB1cHN0cmVhbS4KClNpZ25lZC1vZmYtYnk6IEJyaWFuIE1hc25leSA8bWFzbmV5YkBv
bnN0YXRpb24ub3JnPgpDby1kZXZlbG9wZWQtYnk6IFJvYiBDbGFyayA8cm9iZGNsYXJrQGdtYWls
LmNvbT4KU2lnbmVkLW9mZi1ieTogUm9iIENsYXJrIDxyb2JkY2xhcmtAZ21haWwuY29tPgpSZXZp
ZXdlZC1ieTogQmpvcm4gQW5kZXJzc29uIDxiam9ybi5hbmRlcnNzb25AbGluYXJvLm9yZz4KLS0t
CkNoYW5nZXMgc2luY2UgdjQ6Ci0gQ2hhbmdlICdHUEwnIHRvICdHUEwgdjInIGluIE1PRFVMRV9M
SUNFTlNFCgpDaGFuZ2VzIHNpbmNlIHYzOgotIE5vbmUKCkNoYW5nZXMgc2luY2UgdjIKLSBDaGFu
Z2VkIHN0YXRpYyBpbmxpbmUgc3R1YnMgcmV0dXJuIC1FTk9ERVYgd2hlbiBPQ01FTSBpcyBub3QK
ICBjb25maWd1cmVkIGludG8gdGhlIGtlcm5lbC4KCkNoYW5nZXMgc2luY2UgdjE6Ci0gb2NtZW1f
YWxsb2NhdGUoKTogY2hlY2sgZm9yIGFsaWdubWVudCBhbmQgbWluaW11bSBhbGxvY2F0aW9uIHNp
emUuCiAgVGhlIDY0SyB2YWx1ZXMgY2FtZSBmcm9tIHRoZSBkb3duc3RyZWFtIE1TTSBrZXJuZWwg
c291cmNlcy4KLSBhZGQgbG9ja2luZyB0byBtZW1vcnkgYWxsb2NhdGlvbnMgYmFzZWQgb24gdGhl
IGNsaWVudAotIHVzZSBjbGtfYnVsa18qKCkgZnVuY3Rpb25zCi0gcmVuYW1lIHFjb20sb2NtZW0t
bXNtODk3NCB0byBxY29tLG1zbTg5NzQtb2NtZW0KLSByZW5hbWUgcmVnLW5hbWVzIHRvIGN0cmwg
YW5kIG1lbQotIHJlbW92ZSBvY21lbS54bWwuaCBmaWxlOyB1c2UgRklFTERfUFJFUCgpIGluc3Rl
YWQgZm9yIHNvbWUgbmljZSBjbGVhbnVwcwotIGFkZCBzdGF0aWMgaW5saW5lIG5vb3AgdmVyc2lv
bnMgb2YgcHVibGljLWZhY2luZyBmdW5jdGlvbnMgd2hlbiBvY21lbQogIGlzIGRpc2FibGVkIHRv
IHJlbW92ZSAjaWZkZWZzIGluIGFkcmVudV9ncHUuYwotIHVzZSB1bnNpZ25lZCBsb25nIGZvciBt
ZW1vcnkgYWRkcmVzc2VzCi0gbW92ZSBvY21lbV9kZXZfcmVtb3ZlKCkgYmVsb3cgX3Byb2JlKCkg
ZnVuY3Rpb24KLSByZW1vdmUgZXJyb3IgY2hlY2sgZnJvbSBwbGF0Zm9ybV9nZXRfcmVzb3VyY2Vf
YnluYW1lIGZvciBjdHJsIHJlc291cmNlCi0gYWRkIE1PRFVMRV9ERVNDUklQVElPTigpIGFuZCBN
T0RVTEVfTElDRU5TRSgpCi0gYWRkIGRlc2NyaXB0aW9uIHRvIHRvcCBvZiBvY21lbS5bY2hdCi0g
Y29ycmVjdCB0aGluIG1vZGUgYml0IGluIHVwZGF0ZV9vY21lbSgpCi0gYWRkICdXQVJOX09OKGNs
aWVudCAhPSBPQ01FTV9HUkFQSElDUyknIHRvIGRldmljZV9hZGRyZXNzKCkKLSBtYWtlIG9mX2dl
dF9vY21lbSByZXR1cm4gZXJyb3IgY29kZXMgdmlhIEVSUl9QVFIgaW5zdGVhZCBvZiBOVUxMCi0g
b2NtZW1fe2FsbG9jYXRlLGZyZWV9IC0gV0FSTl9PTigpIGlmIGNsaWVudCAhPSBPQ01FTV9HUkFQ
SElDUy4KICBTaW1wbGlmeSBpZiBzdGF0ZW1lbnRzLgotIGFsbG93IE5VTEwgdG8gYmUgcGFzc2Vk
IGludG8gb2NtZW1fZnJlZQotIHJlbW92ZSB1bm5lY2Vzc2FyeSBpbml0aWFsaXphdGlvbiBvZiBp
IGluIHVwZGF0ZV9vY21lbSgpCi0gYWRkIGRldl9kYmcgdG8gb2NtZW1fYWxsb2NhdGUKCkNoYW5n
ZXMgc2luY2UgUm9iJ3MgbGFzdCB2ZXJzaW9uIG9mIHRoaXMgcGF0Y2ggZnJvbSAyMDE1OgpodHRw
czovL3BhdGNod29yay5rZXJuZWwub3JnL3BhdGNoLzczNzk4MDEvCi0gcmVmb3JtYXR0ZWQgZHJp
dmVyIHRvIGFsbG93IG11bHRpcGxlIGluc3RhbmNlcwotIHVwZGF0ZWQgbG9nZ2luZyBvZiBlcnJv
ciBwYXRocyBkdXJpbmcgZGV2aWNlIHByb2JpbmcKLSByZW1vdmUgdW51c2VkIHBzZ3NjX2N0cmwK
LSByZW1vdmUgX2NsayBmcm9tIGNsb2NrIG5hbWVzCi0gcHJvcGFnYXRlIGVycm9yIGNvZGUgZnJv
bSBkZXZtX2lvcmVtYXBfcmVzb3VyY2UoKQotIHVzZSBkZXZpY2VfZ2V0X21hdGNoX2RhdGEoKQot
IFNQRFggbGljZW5zZSB0YWdzCi0gcmVtb3ZlIFFDT01fU01EIGluIEtjb25maWcKLSBzZWxlY3Qg
QVJDSF9RQ09NIGluIEtjb25maWcKLSBzZWxlY3QgQVJDSF9RQ09NIGluIEtjb25maWcKLSBzZWxl
Y3QgUUNPTV9TQ00gaW4gS2NvbmZpZwotIGxvbmdlciBkZXNjcmlwdGlvbiBpbiBLY29uZmlnCgog
ZHJpdmVycy9zb2MvcWNvbS9LY29uZmlnICB8ICAxMCArCiBkcml2ZXJzL3NvYy9xY29tL01ha2Vm
aWxlIHwgICAxICsKIGRyaXZlcnMvc29jL3Fjb20vb2NtZW0uYyAgfCA0MzMgKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysKIGluY2x1ZGUvc29jL3Fjb20vb2NtZW0uaCAgfCAg
NjIgKysrKysrCiA0IGZpbGVzIGNoYW5nZWQsIDUwNiBpbnNlcnRpb25zKCspCiBjcmVhdGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9zb2MvcWNvbS9vY21lbS5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgaW5j
bHVkZS9zb2MvcWNvbS9vY21lbS5oCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zb2MvcWNvbS9LY29u
ZmlnIGIvZHJpdmVycy9zb2MvcWNvbS9LY29uZmlnCmluZGV4IGE2ZDFiZmIxNzI3OS4uZDE4ZWI4
M2IxMGRhIDEwMDY0NAotLS0gYS9kcml2ZXJzL3NvYy9xY29tL0tjb25maWcKKysrIGIvZHJpdmVy
cy9zb2MvcWNvbS9LY29uZmlnCkBAIC03NCw2ICs3NCwxNiBAQCBjb25maWcgUUNPTV9NRFRfTE9B
REVSCiAJdHJpc3RhdGUKIAlzZWxlY3QgUUNPTV9TQ00KIAorY29uZmlnIFFDT01fT0NNRU0KKwl0
cmlzdGF0ZSAiUXVhbGNvbW0gT24gQ2hpcCBNZW1vcnkgKE9DTUVNKSBkcml2ZXIiCisJZGVwZW5k
cyBvbiBBUkNIX1FDT00KKwlzZWxlY3QgUUNPTV9TQ00KKwloZWxwCisgICAgICAgICAgVGhlIE9u
IENoaXAgTWVtb3J5IChPQ01FTSkgYWxsb2NhdG9yIGFsbG93cyB2YXJpb3VzIGNsaWVudHMgdG8K
KyAgICAgICAgICBhbGxvY2F0ZSBtZW1vcnkgZnJvbSBPQ01FTSBiYXNlZCBvbiBwZXJmb3JtYW5j
ZSwgbGF0ZW5jeSBhbmQgcG93ZXIKKyAgICAgICAgICByZXF1aXJlbWVudHMuIFRoaXMgaXMgdHlw
aWNhbGx5IHVzZWQgYnkgdGhlIEdQVSwgY2FtZXJhL3ZpZGVvLCBhbmQKKyAgICAgICAgICBhdWRp
byBjb21wb25lbnRzIG9uIHNvbWUgU25hcGRyYWdvbiBTb0NzLgorCiBjb25maWcgUUNPTV9QTQog
CWJvb2wgIlF1YWxjb21tIFBvd2VyIE1hbmFnZW1lbnQiCiAJZGVwZW5kcyBvbiBBUkNIX1FDT00g
JiYgIUFSTTY0CmRpZmYgLS1naXQgYS9kcml2ZXJzL3NvYy9xY29tL01ha2VmaWxlIGIvZHJpdmVy
cy9zb2MvcWNvbS9NYWtlZmlsZQppbmRleCBlZWIwODhiZWIxNWYuLmRmYzM3ODAxNGEzMyAxMDA2
NDQKLS0tIGEvZHJpdmVycy9zb2MvcWNvbS9NYWtlZmlsZQorKysgYi9kcml2ZXJzL3NvYy9xY29t
L01ha2VmaWxlCkBAIC02LDYgKzYsNyBAQCBvYmotJChDT05GSUdfUUNPTV9DT01NQU5EX0RCKSAr
PSBjbWQtZGIubwogb2JqLSQoQ09ORklHX1FDT01fR0xJTktfU1NSKSArPQlnbGlua19zc3Iubwog
b2JqLSQoQ09ORklHX1FDT01fR1NCSSkJKz0JcWNvbV9nc2JpLm8KIG9iai0kKENPTkZJR19RQ09N
X01EVF9MT0FERVIpCSs9IG1kdF9sb2FkZXIubworb2JqLSQoQ09ORklHX1FDT01fT0NNRU0pCSs9
IG9jbWVtLm8KIG9iai0kKENPTkZJR19RQ09NX1BNKQkrPQlzcG0ubwogb2JqLSQoQ09ORklHX1FD
T01fUU1JX0hFTFBFUlMpCSs9IHFtaV9oZWxwZXJzLm8KIHFtaV9oZWxwZXJzLXkJKz0gcW1pX2Vu
Y2RlYy5vIHFtaV9pbnRlcmZhY2UubwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zb2MvcWNvbS9vY21l
bS5jIGIvZHJpdmVycy9zb2MvcWNvbS9vY21lbS5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4
IDAwMDAwMDAwMDAwMC4uM2E1NDA0NDA3NmE1Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9z
b2MvcWNvbS9vY21lbS5jCkBAIC0wLDAgKzEsNDMzIEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRp
ZmllcjogR1BMLTIuMC1vbmx5CisvKgorICogVGhlIE9uIENoaXAgTWVtb3J5IChPQ01FTSkgYWxs
b2NhdG9yIGFsbG93cyB2YXJpb3VzIGNsaWVudHMgdG8gYWxsb2NhdGUKKyAqIG1lbW9yeSBmcm9t
IE9DTUVNIGJhc2VkIG9uIHBlcmZvcm1hbmNlLCBsYXRlbmN5IGFuZCBwb3dlciByZXF1aXJlbWVu
dHMuCisgKiBUaGlzIGlzIHR5cGljYWxseSB1c2VkIGJ5IHRoZSBHUFUsIGNhbWVyYS92aWRlbywg
YW5kIGF1ZGlvIGNvbXBvbmVudHMgb24KKyAqIHNvbWUgU25hcGRyYWdvbiBTb0NzLgorICoKKyAq
IENvcHlyaWdodCAoQykgMjAxOSBCcmlhbiBNYXNuZXkgPG1hc25leWJAb25zdGF0aW9uLm9yZz4K
KyAqIENvcHlyaWdodCAoQykgMjAxNSBSZWQgSGF0LiBBdXRob3I6IFJvYiBDbGFyayA8cm9iZGNs
YXJrQGdtYWlsLmNvbT4KKyAqLworCisjaW5jbHVkZSA8bGludXgvYml0ZmllbGQuaD4KKyNpbmNs
dWRlIDxsaW51eC9jbGsuaD4KKyNpbmNsdWRlIDxsaW51eC9pby5oPgorI2luY2x1ZGUgPGxpbnV4
L2tlcm5lbC5oPgorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgorI2luY2x1ZGUgPGxpbnV4L29m
X2RldmljZS5oPgorI2luY2x1ZGUgPGxpbnV4L3BsYXRmb3JtX2RldmljZS5oPgorI2luY2x1ZGUg
PGxpbnV4L3Fjb21fc2NtLmg+CisjaW5jbHVkZSA8bGludXgvc2l6ZXMuaD4KKyNpbmNsdWRlIDxs
aW51eC9zbGFiLmg+CisjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KKyNpbmNsdWRlIDxzb2MvcWNv
bS9vY21lbS5oPgorCitlbnVtIHJlZ2lvbl9tb2RlIHsKKwlXSURFX01PREUgPSAweDAsCisJVEhJ
Tl9NT0RFLAorCU1PREVfREVGQVVMVCA9IFdJREVfTU9ERSwKK307CisKK2VudW0gb2NtZW1fbWFj
cm9fc3RhdGUgeworCVBBU1NUSFJPVUdIID0gMCwKKwlQRVJJX09OID0gMSwKKwlDT1JFX09OID0g
MiwKKwlDTEtfT0ZGID0gNCwKK307CisKK3N0cnVjdCBvY21lbV9yZWdpb24geworCWJvb2wgaW50
ZXJsZWF2ZWQ7CisJZW51bSByZWdpb25fbW9kZSBtb2RlOworCXVuc2lnbmVkIGludCBudW1fbWFj
cm9zOworCWVudW0gb2NtZW1fbWFjcm9fc3RhdGUgbWFjcm9fc3RhdGVbNF07CisJdW5zaWduZWQg
bG9uZyBtYWNyb19zaXplOworCXVuc2lnbmVkIGxvbmcgcmVnaW9uX3NpemU7Cit9OworCitzdHJ1
Y3Qgb2NtZW1fY29uZmlnIHsKKwl1aW50OF90IG51bV9yZWdpb25zOworCXVuc2lnbmVkIGxvbmcg
bWFjcm9fc2l6ZTsKK307CisKK3N0cnVjdCBvY21lbSB7CisJc3RydWN0IGRldmljZSAqZGV2Owor
CWNvbnN0IHN0cnVjdCBvY21lbV9jb25maWcgKmNvbmZpZzsKKwlzdHJ1Y3QgcmVzb3VyY2UgKm1l
bW9yeTsKKwl2b2lkIF9faW9tZW0gKm1taW87CisJdW5zaWduZWQgaW50IG51bV9wb3J0czsKKwl1
bnNpZ25lZCBpbnQgbnVtX21hY3JvczsKKwlib29sIGludGVybGVhdmVkOworCXN0cnVjdCBvY21l
bV9yZWdpb24gKnJlZ2lvbnM7CisJdW5zaWduZWQgbG9uZyBhY3RpdmVfYWxsb2NhdGlvbnM7Cit9
OworCisjZGVmaW5lIE9DTUVNX01JTl9BTElHTgkJCQlTWl82NEsKKyNkZWZpbmUgT0NNRU1fTUlO
X0FMTE9DCQkJCVNaXzY0SworCisjZGVmaW5lIE9DTUVNX1JFR19IV19WRVJTSU9OCQkJMHgwMDAw
MDAwMAorI2RlZmluZSBPQ01FTV9SRUdfSFdfUFJPRklMRQkJCTB4MDAwMDAwMDQKKworI2RlZmlu
ZSBPQ01FTV9SRUdfUkVHSU9OX01PREVfQ1RMCQkweDAwMDAxMDAwCisjZGVmaW5lIE9DTUVNX1JF
R0lPTl9NT0RFX0NUTF9SRUcwX1RISU4JCTB4MDAwMDAwMDEKKyNkZWZpbmUgT0NNRU1fUkVHSU9O
X01PREVfQ1RMX1JFRzFfVEhJTgkJMHgwMDAwMDAwMgorI2RlZmluZSBPQ01FTV9SRUdJT05fTU9E
RV9DVExfUkVHMl9USElOCQkweDAwMDAwMDA0CisjZGVmaW5lIE9DTUVNX1JFR0lPTl9NT0RFX0NU
TF9SRUczX1RISU4JCTB4MDAwMDAwMDgKKworI2RlZmluZSBPQ01FTV9SRUdfR0ZYX01QVV9TVEFS
VAkJCTB4MDAwMDEwMDQKKyNkZWZpbmUgT0NNRU1fUkVHX0dGWF9NUFVfRU5ECQkJMHgwMDAwMTAw
OAorCisjZGVmaW5lIE9DTUVNX0hXX1BST0ZJTEVfTlVNX1BPUlRTKHZhbCkJCUZJRUxEX1BSRVAo
MHgwMDAwMDAwZiwgKHZhbCkpCisjZGVmaW5lIE9DTUVNX0hXX1BST0ZJTEVfTlVNX01BQ1JPUyh2
YWwpCUZJRUxEX1BSRVAoMHgwMDAwM2YwMCwgKHZhbCkpCisKKyNkZWZpbmUgT0NNRU1fSFdfUFJP
RklMRV9MQVNUX1JFR05fSEFMRlNJWkUJMHgwMDAxMDAwMAorI2RlZmluZSBPQ01FTV9IV19QUk9G
SUxFX0lOVEVSTEVBVklORwkJMHgwMDAyMDAwMAorI2RlZmluZSBPQ01FTV9SRUdfR0VOX1NUQVRV
UwkJCTB4MDAwMDAwMGMKKworI2RlZmluZSBPQ01FTV9SRUdfUFNHU0NfU1RBVFVTCQkJMHgwMDAw
MDAzOAorI2RlZmluZSBPQ01FTV9SRUdfUFNHU0NfQ1RMKGkwKQkJCSgweDAwMDAwMDNjICsgMHgx
KihpMCkpCisKKyNkZWZpbmUgT0NNRU1fUFNHU0NfQ1RMX01BQ1JPMF9NT0RFKHZhbCkJRklFTERf
UFJFUCgweDAwMDAwMDA3LCAodmFsKSkKKyNkZWZpbmUgT0NNRU1fUFNHU0NfQ1RMX01BQ1JPMV9N
T0RFKHZhbCkJRklFTERfUFJFUCgweDAwMDAwMDcwLCAodmFsKSkKKyNkZWZpbmUgT0NNRU1fUFNH
U0NfQ1RMX01BQ1JPMl9NT0RFKHZhbCkJRklFTERfUFJFUCgweDAwMDAwNzAwLCAodmFsKSkKKyNk
ZWZpbmUgT0NNRU1fUFNHU0NfQ1RMX01BQ1JPM19NT0RFKHZhbCkJRklFTERfUFJFUCgweDAwMDA3
MDAwLCAodmFsKSkKKworI2RlZmluZSBPQ01FTV9DTEtfQ09SRV9JRFgJCQkwCitzdGF0aWMgc3Ry
dWN0IGNsa19idWxrX2RhdGEgb2NtZW1fY2xrc1tdID0geworCXsKKwkJLmlkID0gImNvcmUiLAor
CX0sCisJeworCQkuaWQgPSAiaWZhY2UiLAorCX0sCit9OworCitzdGF0aWMgaW5saW5lIHZvaWQg
b2NtZW1fd3JpdGUoc3RydWN0IG9jbWVtICpvY21lbSwgdTMyIHJlZywgdTMyIGRhdGEpCit7CisJ
d3JpdGVsKGRhdGEsIG9jbWVtLT5tbWlvICsgcmVnKTsKK30KKworc3RhdGljIGlubGluZSB1MzIg
b2NtZW1fcmVhZChzdHJ1Y3Qgb2NtZW0gKm9jbWVtLCB1MzIgcmVnKQoreworCXJldHVybiByZWFk
bChvY21lbS0+bW1pbyArIHJlZyk7Cit9CisKK3N0YXRpYyB2b2lkIHVwZGF0ZV9vY21lbShzdHJ1
Y3Qgb2NtZW0gKm9jbWVtKQoreworCXVpbnQzMl90IHJlZ2lvbl9tb2RlX2N0cmwgPSAweDA7CisJ
aW50IGk7CisKKwlpZiAoIXFjb21fc2NtX29jbWVtX2xvY2tfYXZhaWxhYmxlKCkpIHsKKwkJZm9y
IChpID0gMDsgaSA8IG9jbWVtLT5jb25maWctPm51bV9yZWdpb25zOyBpKyspIHsKKwkJCXN0cnVj
dCBvY21lbV9yZWdpb24gKnJlZ2lvbiA9ICZvY21lbS0+cmVnaW9uc1tpXTsKKworCQkJaWYgKHJl
Z2lvbi0+bW9kZSA9PSBUSElOX01PREUpCisJCQkJcmVnaW9uX21vZGVfY3RybCB8PSBCSVQoaSk7
CisJCX0KKworCQlkZXZfZGJnKG9jbWVtLT5kZXYsICJvY21lbV9yZWdpb25fbW9kZV9jb250cm9s
ICV4XG4iLAorCQkJcmVnaW9uX21vZGVfY3RybCk7CisJCW9jbWVtX3dyaXRlKG9jbWVtLCBPQ01F
TV9SRUdfUkVHSU9OX01PREVfQ1RMLCByZWdpb25fbW9kZV9jdHJsKTsKKwl9CisKKwlmb3IgKGkg
PSAwOyBpIDwgb2NtZW0tPmNvbmZpZy0+bnVtX3JlZ2lvbnM7IGkrKykgeworCQlzdHJ1Y3Qgb2Nt
ZW1fcmVnaW9uICpyZWdpb24gPSAmb2NtZW0tPnJlZ2lvbnNbaV07CisJCXUzMiBkYXRhOworCisJ
CWRhdGEgPSBPQ01FTV9QU0dTQ19DVExfTUFDUk8wX01PREUocmVnaW9uLT5tYWNyb19zdGF0ZVsw
XSkgfAorCQkJT0NNRU1fUFNHU0NfQ1RMX01BQ1JPMV9NT0RFKHJlZ2lvbi0+bWFjcm9fc3RhdGVb
MV0pIHwKKwkJCU9DTUVNX1BTR1NDX0NUTF9NQUNSTzJfTU9ERShyZWdpb24tPm1hY3JvX3N0YXRl
WzJdKSB8CisJCQlPQ01FTV9QU0dTQ19DVExfTUFDUk8zX01PREUocmVnaW9uLT5tYWNyb19zdGF0
ZVszXSk7CisKKwkJb2NtZW1fd3JpdGUob2NtZW0sIE9DTUVNX1JFR19QU0dTQ19DVEwoaSksIGRh
dGEpOworCX0KK30KKworc3RhdGljIHVuc2lnbmVkIGxvbmcgcGh5c190b19vZmZzZXQoc3RydWN0
IG9jbWVtICpvY21lbSwKKwkJCQkgICAgdW5zaWduZWQgbG9uZyBhZGRyKQoreworCWlmIChhZGRy
IDwgb2NtZW0tPm1lbW9yeS0+c3RhcnQgfHwgYWRkciA+PSBvY21lbS0+bWVtb3J5LT5lbmQpCisJ
CXJldHVybiAwOworCisJcmV0dXJuIGFkZHIgLSBvY21lbS0+bWVtb3J5LT5zdGFydDsKK30KKwor
c3RhdGljIHVuc2lnbmVkIGxvbmcgZGV2aWNlX2FkZHJlc3Moc3RydWN0IG9jbWVtICpvY21lbSwK
KwkJCQkgICAgZW51bSBvY21lbV9jbGllbnQgY2xpZW50LAorCQkJCSAgICB1bnNpZ25lZCBsb25n
IGFkZHIpCit7CisJV0FSTl9PTihjbGllbnQgIT0gT0NNRU1fR1JBUEhJQ1MpOworCisJLyogVE9E
TzogZ3B1IHVzZXMgcGh5c190b19vZmZzZXQsIGJ1dCBvdGhlcnMgZG8gbm90Li4gKi8KKwlyZXR1
cm4gcGh5c190b19vZmZzZXQob2NtZW0sIGFkZHIpOworfQorCitzdGF0aWMgdm9pZCB1cGRhdGVf
cmFuZ2Uoc3RydWN0IG9jbWVtICpvY21lbSwgc3RydWN0IG9jbWVtX2J1ZiAqYnVmLAorCQkJIGVu
dW0gb2NtZW1fbWFjcm9fc3RhdGUgbXN0YXRlLCBlbnVtIHJlZ2lvbl9tb2RlIHJtb2RlKQorewor
CXVuc2lnbmVkIGxvbmcgb2Zmc2V0ID0gMDsKKwlpbnQgaSwgajsKKworCWZvciAoaSA9IDA7IGkg
PCBvY21lbS0+Y29uZmlnLT5udW1fcmVnaW9uczsgaSsrKSB7CisJCXN0cnVjdCBvY21lbV9yZWdp
b24gKnJlZ2lvbiA9ICZvY21lbS0+cmVnaW9uc1tpXTsKKworCQlpZiAoYnVmLT5vZmZzZXQgPD0g
b2Zmc2V0ICYmIG9mZnNldCA8IGJ1Zi0+b2Zmc2V0ICsgYnVmLT5sZW4pCisJCQlyZWdpb24tPm1v
ZGUgPSBybW9kZTsKKworCQlmb3IgKGogPSAwOyBqIDwgcmVnaW9uLT5udW1fbWFjcm9zOyBqKysp
IHsKKwkJCWlmIChidWYtPm9mZnNldCA8PSBvZmZzZXQgJiYKKwkJCSAgICBvZmZzZXQgPCBidWYt
Pm9mZnNldCArIGJ1Zi0+bGVuKQorCQkJCXJlZ2lvbi0+bWFjcm9fc3RhdGVbal0gPSBtc3RhdGU7
CisKKwkJCW9mZnNldCArPSByZWdpb24tPm1hY3JvX3NpemU7CisJCX0KKwl9CisKKwl1cGRhdGVf
b2NtZW0ob2NtZW0pOworfQorCitzdHJ1Y3Qgb2NtZW0gKm9mX2dldF9vY21lbShzdHJ1Y3QgZGV2
aWNlICpkZXYpCit7CisJc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldjsKKwlzdHJ1Y3QgZGV2
aWNlX25vZGUgKmRldm5vZGU7CisKKwlkZXZub2RlID0gb2ZfcGFyc2VfcGhhbmRsZShkZXYtPm9m
X25vZGUsICJvY21lbSIsIDApOworCWlmICghZGV2bm9kZSkgeworCQlkZXZfZXJyKGRldiwgIkNh
bm5vdCBsb29rIHVwIG9jbWVtIHBoYW5kbGVcbiIpOworCQlyZXR1cm4gRVJSX1BUUigtRU5PREVW
KTsKKwl9CisKKwlwZGV2ID0gb2ZfZmluZF9kZXZpY2VfYnlfbm9kZShkZXZub2RlKTsKKwlpZiAo
IXBkZXYpIHsKKwkJZGV2X2VycihkZXYsICJDYW5ub3QgZmluZCBkZXZpY2Ugbm9kZSAlc1xuIiwg
ZGV2bm9kZS0+bmFtZSk7CisJCXJldHVybiBFUlJfUFRSKC1FUFJPQkVfREVGRVIpOworCX0KKwor
CXJldHVybiBwbGF0Zm9ybV9nZXRfZHJ2ZGF0YShwZGV2KTsKK30KK0VYUE9SVF9TWU1CT0wob2Zf
Z2V0X29jbWVtKTsKKworc3RydWN0IG9jbWVtX2J1ZiAqb2NtZW1fYWxsb2NhdGUoc3RydWN0IG9j
bWVtICpvY21lbSwgZW51bSBvY21lbV9jbGllbnQgY2xpZW50LAorCQkJCSB1bnNpZ25lZCBsb25n
IHNpemUpCit7CisJc3RydWN0IG9jbWVtX2J1ZiAqYnVmOworCWludCByZXQ7CisKKwkvKiBUT0RP
OiBhZGQgc3VwcG9ydCBmb3Igb3RoZXIgY2xpZW50cy4uLiAqLworCWlmIChXQVJOX09OKGNsaWVu
dCAhPSBPQ01FTV9HUkFQSElDUykpCisJCXJldHVybiBFUlJfUFRSKC1FTk9ERVYpOworCisJaWYg
KHNpemUgPCBPQ01FTV9NSU5fQUxMT0MgfHwgIUlTX0FMSUdORUQoc2l6ZSwgT0NNRU1fTUlOX0FM
SUdOKSkKKwkJcmV0dXJuIEVSUl9QVFIoLUVJTlZBTCk7CisKKwlpZiAodGVzdF9hbmRfc2V0X2Jp
dF9sb2NrKEJJVChjbGllbnQpLCAmb2NtZW0tPmFjdGl2ZV9hbGxvY2F0aW9ucykpCisJCXJldHVy
biBFUlJfUFRSKC1FQlVTWSk7CisKKwlidWYgPSBremFsbG9jKHNpemVvZigqYnVmKSwgR0ZQX0tF
Uk5FTCk7CisJaWYgKCFidWYpIHsKKwkJcmV0ID0gLUVOT01FTTsKKwkJZ290byBlcnJfdW5sb2Nr
OworCX0KKworCWJ1Zi0+b2Zmc2V0ID0gMDsKKwlidWYtPmFkZHIgPSBkZXZpY2VfYWRkcmVzcyhv
Y21lbSwgY2xpZW50LCBidWYtPm9mZnNldCk7CisJYnVmLT5sZW4gPSBzaXplOworCisJdXBkYXRl
X3JhbmdlKG9jbWVtLCBidWYsIENPUkVfT04sIFdJREVfTU9ERSk7CisKKwlpZiAocWNvbV9zY21f
b2NtZW1fbG9ja19hdmFpbGFibGUoKSkgeworCQlyZXQgPSBxY29tX3NjbV9vY21lbV9sb2NrKFFD
T01fU0NNX09DTUVNX0dSQVBISUNTX0lELAorCQkJCQkgIGJ1Zi0+b2Zmc2V0LCBidWYtPmxlbiwg
V0lERV9NT0RFKTsKKwkJaWYgKHJldCkgeworCQkJZGV2X2VycihvY21lbS0+ZGV2LCAiY291bGQg
bm90IGxvY2s6ICVkXG4iLCByZXQpOworCQkJcmV0ID0gLUVJTlZBTDsKKwkJCWdvdG8gZXJyX2tm
cmVlOworCQl9CisJfSBlbHNlIHsKKwkJb2NtZW1fd3JpdGUob2NtZW0sIE9DTUVNX1JFR19HRlhf
TVBVX1NUQVJULCBidWYtPm9mZnNldCk7CisJCW9jbWVtX3dyaXRlKG9jbWVtLCBPQ01FTV9SRUdf
R0ZYX01QVV9FTkQsCisJCQkgICAgYnVmLT5vZmZzZXQgKyBidWYtPmxlbik7CisJfQorCisJZGV2
X2RiZyhvY21lbS0+ZGV2LCAidXNpbmcgJWxkSyBvZiBPQ01FTSBhdCAweCUwOGx4IGZvciBjbGll
bnQgJWRcbiIsCisJCXNpemUgLyAxMDI0LCBidWYtPmFkZHIsIGNsaWVudCk7CisKKwlyZXR1cm4g
YnVmOworCitlcnJfa2ZyZWU6CisJa2ZyZWUoYnVmKTsKK2Vycl91bmxvY2s6CisJY2xlYXJfYml0
X3VubG9jayhCSVQoY2xpZW50KSwgJm9jbWVtLT5hY3RpdmVfYWxsb2NhdGlvbnMpOworCisJcmV0
dXJuIEVSUl9QVFIocmV0KTsKK30KK0VYUE9SVF9TWU1CT0wob2NtZW1fYWxsb2NhdGUpOworCit2
b2lkIG9jbWVtX2ZyZWUoc3RydWN0IG9jbWVtICpvY21lbSwgZW51bSBvY21lbV9jbGllbnQgY2xp
ZW50LAorCQlzdHJ1Y3Qgb2NtZW1fYnVmICpidWYpCit7CisJLyogVE9ETzogYWRkIHN1cHBvcnQg
Zm9yIG90aGVyIGNsaWVudHMuLi4gKi8KKwlpZiAoV0FSTl9PTihjbGllbnQgIT0gT0NNRU1fR1JB
UEhJQ1MpKQorCQlyZXR1cm47CisKKwl1cGRhdGVfcmFuZ2Uob2NtZW0sIGJ1ZiwgQ0xLX09GRiwg
TU9ERV9ERUZBVUxUKTsKKworCWlmIChxY29tX3NjbV9vY21lbV9sb2NrX2F2YWlsYWJsZSgpKSB7
CisJCWludCByZXQ7CisKKwkJcmV0ID0gcWNvbV9zY21fb2NtZW1fdW5sb2NrKFFDT01fU0NNX09D
TUVNX0dSQVBISUNTX0lELAorCQkJCQkgICAgYnVmLT5vZmZzZXQsIGJ1Zi0+bGVuKTsKKwkJaWYg
KHJldCkKKwkJCWRldl9lcnIob2NtZW0tPmRldiwgImNvdWxkIG5vdCB1bmxvY2s6ICVkXG4iLCBy
ZXQpOworCX0gZWxzZSB7CisJCW9jbWVtX3dyaXRlKG9jbWVtLCBPQ01FTV9SRUdfR0ZYX01QVV9T
VEFSVCwgMHgwKTsKKwkJb2NtZW1fd3JpdGUob2NtZW0sIE9DTUVNX1JFR19HRlhfTVBVX0VORCwg
MHgwKTsKKwl9CisKKwlrZnJlZShidWYpOworCisJY2xlYXJfYml0X3VubG9jayhCSVQoY2xpZW50
KSwgJm9jbWVtLT5hY3RpdmVfYWxsb2NhdGlvbnMpOworfQorRVhQT1JUX1NZTUJPTChvY21lbV9m
cmVlKTsKKworc3RhdGljIGludCBvY21lbV9kZXZfcHJvYmUoc3RydWN0IHBsYXRmb3JtX2Rldmlj
ZSAqcGRldikKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmcGRldi0+ZGV2OworCXVuc2lnbmVk
IGxvbmcgcmVnLCByZWdpb25fc2l6ZTsKKwlpbnQgaSwgaiwgcmV0LCBudW1fYmFua3M7CisJc3Ry
dWN0IHJlc291cmNlICpyZXM7CisJc3RydWN0IG9jbWVtICpvY21lbTsKKworCWlmICghcWNvbV9z
Y21faXNfYXZhaWxhYmxlKCkpCisJCXJldHVybiAtRVBST0JFX0RFRkVSOworCisJb2NtZW0gPSBk
ZXZtX2t6YWxsb2MoZGV2LCBzaXplb2YoKm9jbWVtKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFvY21l
bSkKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlvY21lbS0+ZGV2ID0gZGV2OworCW9jbWVtLT5jb25m
aWcgPSBkZXZpY2VfZ2V0X21hdGNoX2RhdGEoZGV2KTsKKworCXJldCA9IGRldm1fY2xrX2J1bGtf
Z2V0KGRldiwgQVJSQVlfU0laRShvY21lbV9jbGtzKSwgb2NtZW1fY2xrcyk7CisJaWYgKHJldCkg
eworCQlpZiAocmV0ICE9IC1FUFJPQkVfREVGRVIpCisJCQlkZXZfZXJyKGRldiwgIlVuYWJsZSB0
byBnZXQgY2xvY2tzXG4iKTsKKworCQlyZXR1cm4gcmV0OworCX0KKworCXJlcyA9IHBsYXRmb3Jt
X2dldF9yZXNvdXJjZV9ieW5hbWUocGRldiwgSU9SRVNPVVJDRV9NRU0sICJjdHJsIik7CisJb2Nt
ZW0tPm1taW8gPSBkZXZtX2lvcmVtYXBfcmVzb3VyY2UoJnBkZXYtPmRldiwgcmVzKTsKKwlpZiAo
SVNfRVJSKG9jbWVtLT5tbWlvKSkgeworCQlkZXZfZXJyKCZwZGV2LT5kZXYsICJGYWlsZWQgdG8g
aW9yZW1hcCBvY21lbV9jdHJsIHJlc291cmNlXG4iKTsKKwkJcmV0dXJuIFBUUl9FUlIob2NtZW0t
Pm1taW8pOworCX0KKworCW9jbWVtLT5tZW1vcnkgPSBwbGF0Zm9ybV9nZXRfcmVzb3VyY2VfYnlu
YW1lKHBkZXYsIElPUkVTT1VSQ0VfTUVNLAorCQkJCQkJICAgICAibWVtIik7CisJaWYgKCFvY21l
bS0+bWVtb3J5KSB7CisJCWRldl9lcnIoZGV2LCAiQ291bGQgbm90IGdldCBtZW0gcmVnaW9uXG4i
KTsKKwkJcmV0dXJuIC1FTlhJTzsKKwl9CisKKwkvKiBUaGUgY29yZSBjbG9jayBpcyBzeW5jaHJv
bm91cyB3aXRoIGdyYXBoaWNzICovCisJV0FSTl9PTihjbGtfc2V0X3JhdGUob2NtZW1fY2xrc1tP
Q01FTV9DTEtfQ09SRV9JRFhdLmNsaywgMTAwMCkgPCAwKTsKKworCXJldCA9IGNsa19idWxrX3By
ZXBhcmVfZW5hYmxlKEFSUkFZX1NJWkUob2NtZW1fY2xrcyksIG9jbWVtX2Nsa3MpOworCWlmIChy
ZXQpIHsKKwkJZGV2X2luZm8ob2NtZW0tPmRldiwgIkZhaWxlZCB0byBlbmFibGUgY2xvY2tzXG4i
KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlpZiAocWNvbV9zY21fcmVzdG9yZV9zZWNfY2ZnX2F2
YWlsYWJsZSgpKSB7CisJCWRldl9kYmcoZGV2LCAiY29uZmlndXJpbmcgc2NtXG4iKTsKKwkJcmV0
ID0gcWNvbV9zY21fcmVzdG9yZV9zZWNfY2ZnKFFDT01fU0NNX09DTUVNX0RFVl9JRCwgMCk7CisJ
CWlmIChyZXQpIHsKKwkJCWRldl9lcnIoZGV2LCAiQ291bGQgbm90IGVuYWJsZSBzZWN1cmUgY29u
ZmlndXJhdGlvblxuIik7CisJCQlnb3RvIGVycl9jbGtfZGlzYWJsZTsKKwkJfQorCX0KKworCXJl
ZyA9IG9jbWVtX3JlYWQob2NtZW0sIE9DTUVNX1JFR19IV19QUk9GSUxFKTsKKwlvY21lbS0+bnVt
X3BvcnRzID0gT0NNRU1fSFdfUFJPRklMRV9OVU1fUE9SVFMocmVnKTsKKwlvY21lbS0+bnVtX21h
Y3JvcyA9IE9DTUVNX0hXX1BST0ZJTEVfTlVNX01BQ1JPUyhyZWcpOworCW9jbWVtLT5pbnRlcmxl
YXZlZCA9ICEhKHJlZyAmIE9DTUVNX0hXX1BST0ZJTEVfSU5URVJMRUFWSU5HKTsKKworCW51bV9i
YW5rcyA9IG9jbWVtLT5udW1fcG9ydHMgLyAyOworCXJlZ2lvbl9zaXplID0gb2NtZW0tPmNvbmZp
Zy0+bWFjcm9fc2l6ZSAqIG51bV9iYW5rczsKKworCWRldl9pbmZvKGRldiwgIiV1IHBvcnRzLCAl
dSByZWdpb25zLCAldSBtYWNyb3MsICVzaW50ZXJsZWF2ZWRcbiIsCisJCSBvY21lbS0+bnVtX3Bv
cnRzLCBvY21lbS0+Y29uZmlnLT5udW1fcmVnaW9ucywKKwkJIG9jbWVtLT5udW1fbWFjcm9zLCBv
Y21lbS0+aW50ZXJsZWF2ZWQgPyAiIiA6ICJub3QgIik7CisKKwlvY21lbS0+cmVnaW9ucyA9IGRl
dm1fa2NhbGxvYyhkZXYsIG9jbWVtLT5jb25maWctPm51bV9yZWdpb25zLAorCQkJCSAgICAgIHNp
emVvZihzdHJ1Y3Qgb2NtZW1fcmVnaW9uKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFvY21lbS0+cmVn
aW9ucykgeworCQlyZXQgPSAtRU5PTUVNOworCQlnb3RvIGVycl9jbGtfZGlzYWJsZTsKKwl9CisK
Kwlmb3IgKGkgPSAwOyBpIDwgb2NtZW0tPmNvbmZpZy0+bnVtX3JlZ2lvbnM7IGkrKykgeworCQlz
dHJ1Y3Qgb2NtZW1fcmVnaW9uICpyZWdpb24gPSAmb2NtZW0tPnJlZ2lvbnNbaV07CisKKwkJaWYg
KFdBUk5fT04obnVtX2JhbmtzID4gQVJSQVlfU0laRShyZWdpb24tPm1hY3JvX3N0YXRlKSkpIHsK
KwkJCXJldCA9IC1FSU5WQUw7CisJCQlnb3RvIGVycl9jbGtfZGlzYWJsZTsKKwkJfQorCisJCXJl
Z2lvbi0+bW9kZSA9IE1PREVfREVGQVVMVDsKKwkJcmVnaW9uLT5udW1fbWFjcm9zID0gbnVtX2Jh
bmtzOworCisJCWlmIChpID09IChvY21lbS0+Y29uZmlnLT5udW1fcmVnaW9ucyAtIDEpICYmCisJ
CSAgICByZWcgJiBPQ01FTV9IV19QUk9GSUxFX0xBU1RfUkVHTl9IQUxGU0laRSkgeworCQkJcmVn
aW9uLT5tYWNyb19zaXplID0gb2NtZW0tPmNvbmZpZy0+bWFjcm9fc2l6ZSAvIDI7CisJCQlyZWdp
b24tPnJlZ2lvbl9zaXplID0gcmVnaW9uX3NpemUgLyAyOworCQl9IGVsc2UgeworCQkJcmVnaW9u
LT5tYWNyb19zaXplID0gb2NtZW0tPmNvbmZpZy0+bWFjcm9fc2l6ZTsKKwkJCXJlZ2lvbi0+cmVn
aW9uX3NpemUgPSByZWdpb25fc2l6ZTsKKwkJfQorCisJCWZvciAoaiA9IDA7IGogPCBBUlJBWV9T
SVpFKHJlZ2lvbi0+bWFjcm9fc3RhdGUpOyBqKyspCisJCQlyZWdpb24tPm1hY3JvX3N0YXRlW2pd
ID0gQ0xLX09GRjsKKwl9CisKKwlwbGF0Zm9ybV9zZXRfZHJ2ZGF0YShwZGV2LCBvY21lbSk7CisK
KwlyZXR1cm4gMDsKKworZXJyX2Nsa19kaXNhYmxlOgorCWNsa19idWxrX2Rpc2FibGVfdW5wcmVw
YXJlKEFSUkFZX1NJWkUob2NtZW1fY2xrcyksIG9jbWVtX2Nsa3MpOworCXJldHVybiByZXQ7Cit9
CisKK3N0YXRpYyBpbnQgb2NtZW1fZGV2X3JlbW92ZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpw
ZGV2KQoreworCWNsa19idWxrX2Rpc2FibGVfdW5wcmVwYXJlKEFSUkFZX1NJWkUob2NtZW1fY2xr
cyksIG9jbWVtX2Nsa3MpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3Qg
b2NtZW1fY29uZmlnIG9jbWVtXzg5NzRfY29uZmlnID0geworCS5udW1fcmVnaW9ucyA9IDMsCisJ
Lm1hY3JvX3NpemUgPSBTWl8xMjhLLAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBvZl9kZXZp
Y2VfaWQgb2NtZW1fb2ZfbWF0Y2hbXSA9IHsKKwl7IC5jb21wYXRpYmxlID0gInFjb20sbXNtODk3
NC1vY21lbSIsIC5kYXRhID0gJm9jbWVtXzg5NzRfY29uZmlnIH0sCisJeyB9Cit9OworCitNT0RV
TEVfREVWSUNFX1RBQkxFKG9mLCBvY21lbV9vZl9tYXRjaCk7CisKK3N0YXRpYyBzdHJ1Y3QgcGxh
dGZvcm1fZHJpdmVyIG9jbWVtX2RyaXZlciA9IHsKKwkucHJvYmUgPSBvY21lbV9kZXZfcHJvYmUs
CisJLnJlbW92ZSA9IG9jbWVtX2Rldl9yZW1vdmUsCisJLmRyaXZlciA9IHsKKwkJLm5hbWUgPSAi
b2NtZW0iLAorCQkub2ZfbWF0Y2hfdGFibGUgPSBvY21lbV9vZl9tYXRjaCwKKwl9LAorfTsKKwor
bW9kdWxlX3BsYXRmb3JtX2RyaXZlcihvY21lbV9kcml2ZXIpOworCitNT0RVTEVfREVTQ1JJUFRJ
T04oIk9uIENoaXAgTWVtb3J5IChPQ01FTSkgYWxsb2NhdG9yIGZvciBzb21lIFNuYXBkcmFnb24g
U29DcyIpOworTU9EVUxFX0xJQ0VOU0UoIkdQTCB2MiIpOwpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9z
b2MvcWNvbS9vY21lbS5oIGIvaW5jbHVkZS9zb2MvcWNvbS9vY21lbS5oCm5ldyBmaWxlIG1vZGUg
MTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uYTBhZTMzNmJhNzhiCi0tLSAvZGV2L251bGwKKysr
IGIvaW5jbHVkZS9zb2MvcWNvbS9vY21lbS5oCkBAIC0wLDAgKzEsNjIgQEAKKy8qIFNQRFgtTGlj
ZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkgKi8KKy8qCisgKiBUaGUgT24gQ2hpcCBNZW1v
cnkgKE9DTUVNKSBhbGxvY2F0b3IgYWxsb3dzIHZhcmlvdXMgY2xpZW50cyB0byBhbGxvY2F0ZQor
ICogbWVtb3J5IGZyb20gT0NNRU0gYmFzZWQgb24gcGVyZm9ybWFuY2UsIGxhdGVuY3kgYW5kIHBv
d2VyIHJlcXVpcmVtZW50cy4KKyAqIFRoaXMgaXMgdHlwaWNhbGx5IHVzZWQgYnkgdGhlIEdQVSwg
Y2FtZXJhL3ZpZGVvLCBhbmQgYXVkaW8gY29tcG9uZW50cyBvbgorICogc29tZSBTbmFwZHJhZ29u
IFNvQ3MuCisgKgorICogQ29weXJpZ2h0IChDKSAyMDE5IEJyaWFuIE1hc25leSA8bWFzbmV5YkBv
bnN0YXRpb24ub3JnPgorICogQ29weXJpZ2h0IChDKSAyMDE1IFJlZCBIYXQuIEF1dGhvcjogUm9i
IENsYXJrIDxyb2JkY2xhcmtAZ21haWwuY29tPgorICovCisKKyNpZm5kZWYgX19PQ01FTV9IX18K
KyNkZWZpbmUgX19PQ01FTV9IX18KKworZW51bSBvY21lbV9jbGllbnQgeworCS8qIEdNRU0gY2xp
ZW50cyAqLworCU9DTUVNX0dSQVBISUNTID0gMHgwLAorCS8qCisJICogVE9ETyBhZGQgbW9yZSBv
bmNlIG9jbWVtX2FsbG9jYXRlKCkgaXMgY2xldmVyIGVub3VnaCB0bworCSAqIGRlYWwgd2l0aCBt
dWx0aXBsZSBjbGllbnRzLgorCSAqLworCU9DTUVNX0NMSUVOVF9NQVgsCit9OworCitzdHJ1Y3Qg
b2NtZW07CisKK3N0cnVjdCBvY21lbV9idWYgeworCXVuc2lnbmVkIGxvbmcgb2Zmc2V0OworCXVu
c2lnbmVkIGxvbmcgYWRkcjsKKwl1bnNpZ25lZCBsb25nIGxlbjsKK307CisKKyNpZiBJU19FTkFC
TEVEKENPTkZJR19RQ09NX09DTUVNKQorCitzdHJ1Y3Qgb2NtZW0gKm9mX2dldF9vY21lbShzdHJ1
Y3QgZGV2aWNlICpkZXYpOworc3RydWN0IG9jbWVtX2J1ZiAqb2NtZW1fYWxsb2NhdGUoc3RydWN0
IG9jbWVtICpvY21lbSwgZW51bSBvY21lbV9jbGllbnQgY2xpZW50LAorCQkJCSB1bnNpZ25lZCBs
b25nIHNpemUpOwordm9pZCBvY21lbV9mcmVlKHN0cnVjdCBvY21lbSAqb2NtZW0sIGVudW0gb2Nt
ZW1fY2xpZW50IGNsaWVudCwKKwkJc3RydWN0IG9jbWVtX2J1ZiAqYnVmKTsKKworI2Vsc2UgLyog
SVNfRU5BQkxFRChDT05GSUdfUUNPTV9PQ01FTSkgKi8KKworc3RhdGljIGlubGluZSBzdHJ1Y3Qg
b2NtZW0gKm9mX2dldF9vY21lbShzdHJ1Y3QgZGV2aWNlICpkZXYpCit7CisJcmV0dXJuIEVSUl9Q
VFIoLUVOT0RFVik7Cit9CisKK3N0YXRpYyBpbmxpbmUgc3RydWN0IG9jbWVtX2J1ZiAqb2NtZW1f
YWxsb2NhdGUoc3RydWN0IG9jbWVtICpvY21lbSwKKwkJCQkJICAgICAgIGVudW0gb2NtZW1fY2xp
ZW50IGNsaWVudCwKKwkJCQkJICAgICAgIHVuc2lnbmVkIGxvbmcgc2l6ZSkKK3sKKwlyZXR1cm4g
RVJSX1BUUigtRU5PREVWKTsKK30KKworc3RhdGljIGlubGluZSB2b2lkIG9jbWVtX2ZyZWUoc3Ry
dWN0IG9jbWVtICpvY21lbSwgZW51bSBvY21lbV9jbGllbnQgY2xpZW50LAorCQkJICAgICAgc3Ry
dWN0IG9jbWVtX2J1ZiAqYnVmKQoreworfQorCisjZW5kaWYgLyogSVNfRU5BQkxFRChDT05GSUdf
UUNPTV9PQ01FTSkgKi8KKworI2VuZGlmIC8qIF9fT0NNRU1fSF9fICovCi0tIAoyLjIxLjAKCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBt
YWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3Rz
LmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
