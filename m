Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 30B8D2C14E
	for <lists+dri-devel@lfdr.de>; Tue, 28 May 2019 10:29:29 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B090989CC1;
	Tue, 28 May 2019 08:29:26 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from fllv0016.ext.ti.com (fllv0016.ext.ti.com [198.47.19.142])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6B11E89D7F
 for <dri-devel@lists.freedesktop.org>; Tue, 28 May 2019 08:29:05 +0000 (UTC)
Received: from fllv0035.itg.ti.com ([10.64.41.0])
 by fllv0016.ext.ti.com (8.15.2/8.15.2) with ESMTP id x4S8T0cd055634;
 Tue, 28 May 2019 03:29:00 -0500
Received: from DFLE104.ent.ti.com (dfle104.ent.ti.com [10.64.6.25])
 by fllv0035.itg.ti.com (8.15.2/8.15.2) with ESMTPS id x4S8T0DF009307
 (version=TLSv1.2 cipher=AES256-GCM-SHA384 bits=256 verify=FAIL);
 Tue, 28 May 2019 03:29:00 -0500
Received: from DFLE103.ent.ti.com (10.64.6.24) by DFLE104.ent.ti.com
 (10.64.6.25) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P256) id 15.1.1713.5; Tue, 28
 May 2019 03:29:00 -0500
Received: from lelv0327.itg.ti.com (10.180.67.183) by DFLE103.ent.ti.com
 (10.64.6.24) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P256) id 15.1.1713.5 via
 Frontend Transport; Tue, 28 May 2019 03:29:00 -0500
Received: from deskari.ti.com (ileax41-snat.itg.ti.com [10.172.224.153])
 by lelv0327.itg.ti.com (8.15.2/8.15.2) with ESMTP id x4S8Rxur125039;
 Tue, 28 May 2019 03:28:58 -0500
From: Tomi Valkeinen <tomi.valkeinen@ti.com>
To: <dri-devel@lists.freedesktop.org>, Andrzej Hajda <a.hajda@samsung.com>,
 Laurent Pinchart <Laurent.pinchart@ideasonboard.com>, Lucas Stach
 <l.stach@pengutronix.de>,
 Andrey Gusakov <andrey.gusakov@cogentembedded.com>,
 Philipp Zabel <p.zabel@pengutronix.de>, Andrey Smirnov
 <andrew.smirnov@gmail.com>, Peter Ujfalusi <peter.ujfalusi@ti.com>, Jyri
 Sarha <jsarha@ti.com>, Benoit Parrot <bparrot@ti.com>
Subject: [PATCHv4 23/24] drm/bridge: tc358767: add IRQ and HPD support
Date: Tue, 28 May 2019 11:27:46 +0300
Message-ID: <20190528082747.3631-24-tomi.valkeinen@ti.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190528082747.3631-1-tomi.valkeinen@ti.com>
References: <20190528082747.3631-1-tomi.valkeinen@ti.com>
MIME-Version: 1.0
X-EXCLAIMER-MD-CONFIG: e1e8a2fd-e40a-4ac6-ac9b-f7e9cc9ee180
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ti.com; s=ti-com-17Q1; t=1559032140;
 bh=77d0+pEjam8yNhyHp4QaManWDWY4Busn/6BA4XOSGqY=;
 h=From:To:CC:Subject:Date:In-Reply-To:References;
 b=kD1mNLElPKdmMl4yh0ZovtS22NXTRbaLtsphxFAdvvdp6Daxhw0u98gIyR4z47wt4
 7mvMsstVfB6HmfiYViACDF+GxluqvcWlGuUYG6m8yiaK0cO/Q6xFCbNL27FjgAl9hy
 XPooXyqGKfD9VyJsTrsz01Jxgj22EKCgdrT7p+1k=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Tomi Valkeinen <tomi.valkeinen@ti.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIHN1cHBvcnQgZm9yIGludGVycnVwdCBhbmQgaG90cGx1ZyBoYW5kbGluZy4gQm90aCBhcmUg
b3B0aW9uYWwuCgpTaWduZWQtb2ZmLWJ5OiBUb21pIFZhbGtlaW5lbiA8dG9taS52YWxrZWluZW5A
dGkuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9icmlkZ2UvdGMzNTg3NjcuYyB8IDE2MyArKysr
KysrKysrKysrKysrKysrKysrKysrKy0tLS0KIDEgZmlsZSBjaGFuZ2VkLCAxNDUgaW5zZXJ0aW9u
cygrKSwgMTggZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2JyaWRn
ZS90YzM1ODc2Ny5jIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS90YzM1ODc2Ny5jCmluZGV4IGI4
MjBhNTllZjI5ZS4uNzI2NjZlMDcwMDdhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYnJp
ZGdlL3RjMzU4NzY3LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS90YzM1ODc2Ny5jCkBA
IC03MSw2ICs3MSw3IEBACiAKIC8qIFN5c3RlbSAqLwogI2RlZmluZSBUQ19JRFJFRwkJMHgwNTAw
CisjZGVmaW5lIFNZU1NUQVQJCQkweDA1MDgKICNkZWZpbmUgU1lTQ1RSTAkJCTB4MDUxMAogI2Rl
ZmluZSBEUDBfQVVEU1JDX05PX0lOUFVUCQkoMCA8PCAzKQogI2RlZmluZSBEUDBfQVVEU1JDX0ky
U19SWAkJKDEgPDwgMykKQEAgLTc5LDkgKzgwLDE2IEBACiAjZGVmaW5lIERQMF9WSURTUkNfRFBJ
X1JYCQkoMiA8PCAwKQogI2RlZmluZSBEUDBfVklEU1JDX0NPTE9SX0JBUgkJKDMgPDwgMCkKICNk
ZWZpbmUgR1BJT00JCQkweDA1NDAKKyNkZWZpbmUgR1BJT0MJCQkweDA1NDQKKyNkZWZpbmUgR1BJ
T08JCQkweDA1NDgKICNkZWZpbmUgR1BJT0kJCQkweDA1NGMKICNkZWZpbmUgSU5UQ1RMX0cJCTB4
MDU2MAogI2RlZmluZSBJTlRTVFNfRwkJMHgwNTY0CisKKyNkZWZpbmUgSU5UX1NZU0VSUgkJQklU
KDE2KQorI2RlZmluZSBJTlRfR1BJT19IKHgpCQkoMSA8PCAoeCA9PSAwID8gMiA6IDEwKSkKKyNk
ZWZpbmUgSU5UX0dQSU9fTEMoeCkJCSgxIDw8ICh4ID09IDAgPyAzIDogMTEpKQorCiAjZGVmaW5l
IElOVF9HUDBfTENOVAkJMHgwNTg0CiAjZGVmaW5lIElOVF9HUDFfTENOVAkJMHgwNTg4CiAKQEAg
LTIxOSw2ICsyMjcsMTIgQEAgc3RydWN0IHRjX2RhdGEgewogCXN0cnVjdCBncGlvX2Rlc2MJKnNk
X2dwaW87CiAJc3RydWN0IGdwaW9fZGVzYwkqcmVzZXRfZ3BpbzsKIAlzdHJ1Y3QgY2xrCQkqcmVm
Y2xrOworCisJLyogZG8gd2UgaGF2ZSBJUlEgKi8KKwlib29sCQkJaGF2ZV9pcnE7CisKKwkvKiBI
UEQgcGluIG51bWJlciAoMCBvciAxKSBvciAtRU5PREVWICovCisJaW50CQkJaHBkX3BpbjsKIH07
CiAKIHN0YXRpYyBpbmxpbmUgc3RydWN0IHRjX2RhdGEgKmF1eF90b190YyhzdHJ1Y3QgZHJtX2Rw
X2F1eCAqYSkKQEAgLTExMDksNiArMTEyMywxMiBAQCBzdGF0aWMgdm9pZCB0Y19icmlkZ2VfZW5h
YmxlKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UpCiAJc3RydWN0IHRjX2RhdGEgKnRjID0gYnJp
ZGdlX3RvX3RjKGJyaWRnZSk7CiAJaW50IHJldDsKIAorCXJldCA9IHRjX2dldF9kaXNwbGF5X3By
b3BzKHRjKTsKKwlpZiAocmV0IDwgMCkgeworCQlkZXZfZXJyKHRjLT5kZXYsICJmYWlsZWQgdG8g
cmVhZCBkaXNwbGF5IHByb3BzOiAlZFxuIiwgcmV0KTsKKwkJcmV0dXJuOworCX0KKwogCXJldCA9
IHRjX21haW5fbGlua19lbmFibGUodGMpOwogCWlmIChyZXQgPCAwKSB7CiAJCWRldl9lcnIodGMt
PmRldiwgIm1haW4gbGluayBlbmFibGUgZXJyb3I6ICVkXG4iLCByZXQpOwpAQCAtMTIyMSwxOSAr
MTI0MSw0MCBAQCBzdGF0aWMgaW50IHRjX2Nvbm5lY3Rvcl9nZXRfbW9kZXMoc3RydWN0IGRybV9j
b25uZWN0b3IgKmNvbm5lY3RvcikKIAlyZXR1cm4gY291bnQ7CiB9CiAKLXN0YXRpYyB2b2lkIHRj
X2Nvbm5lY3Rvcl9zZXRfcG9sbGluZyhzdHJ1Y3QgdGNfZGF0YSAqdGMsCi0JCQkJICAgICBzdHJ1
Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQotewotCS8qIFRPRE86IGFkZCBzdXBwb3J0IGZv
ciBIUEQgKi8KLQljb25uZWN0b3ItPnBvbGxlZCA9IERSTV9DT05ORUNUT1JfUE9MTF9DT05ORUNU
IHwKLQkJCSAgICBEUk1fQ09OTkVDVE9SX1BPTExfRElTQ09OTkVDVDsKLX0KLQogc3RhdGljIGNv
bnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX2hlbHBlcl9mdW5jcyB0Y19jb25uZWN0b3JfaGVscGVy
X2Z1bmNzID0gewogCS5nZXRfbW9kZXMgPSB0Y19jb25uZWN0b3JfZ2V0X21vZGVzLAogfTsKIAor
c3RhdGljIGVudW0gZHJtX2Nvbm5lY3Rvcl9zdGF0dXMgdGNfY29ubmVjdG9yX2RldGVjdChzdHJ1
Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAorCQkJCQkJICAgICBib29sIGZvcmNlKQorewor
CXN0cnVjdCB0Y19kYXRhICp0YyA9IGNvbm5lY3Rvcl90b190Yyhjb25uZWN0b3IpOworCWJvb2wg
Y29ubjsKKwl1MzIgdmFsOworCWludCByZXQ7CisKKwlpZiAodGMtPmhwZF9waW4gPCAwKSB7CisJ
CWlmICh0Yy0+cGFuZWwpCisJCQlyZXR1cm4gY29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQ7CisJ
CWVsc2UKKwkJCXJldHVybiBjb25uZWN0b3Jfc3RhdHVzX3Vua25vd247CisJfQorCisJdGNfcmVh
ZChHUElPSSwgJnZhbCk7CisKKwljb25uID0gdmFsICYgQklUKHRjLT5ocGRfcGluKTsKKworCWlm
IChjb25uKQorCQlyZXR1cm4gY29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQ7CisJZWxzZQorCQly
ZXR1cm4gY29ubmVjdG9yX3N0YXR1c19kaXNjb25uZWN0ZWQ7CisKK2VycjoKKwlyZXR1cm4gY29u
bmVjdG9yX3N0YXR1c191bmtub3duOworfQorCiBzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9jb25u
ZWN0b3JfZnVuY3MgdGNfY29ubmVjdG9yX2Z1bmNzID0geworCS5kZXRlY3QgPSB0Y19jb25uZWN0
b3JfZGV0ZWN0LAogCS5maWxsX21vZGVzID0gZHJtX2hlbHBlcl9wcm9iZV9zaW5nbGVfY29ubmVj
dG9yX21vZGVzLAogCS5kZXN0cm95ID0gZHJtX2Nvbm5lY3Rvcl9jbGVhbnVwLAogCS5yZXNldCA9
IGRybV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9yZXNldCwKQEAgLTEyNDgsNyArMTI4OSw3IEBA
IHN0YXRpYyBpbnQgdGNfYnJpZGdlX2F0dGFjaChzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQog
CXN0cnVjdCBkcm1fZGV2aWNlICpkcm0gPSBicmlkZ2UtPmRldjsKIAlpbnQgcmV0OwogCi0JLyog
Q3JlYXRlIGVEUCBjb25uZWN0b3IgKi8KKwkvKiBDcmVhdGUgRFAvZURQIGNvbm5lY3RvciAqLwog
CWRybV9jb25uZWN0b3JfaGVscGVyX2FkZCgmdGMtPmNvbm5lY3RvciwgJnRjX2Nvbm5lY3Rvcl9o
ZWxwZXJfZnVuY3MpOwogCXJldCA9IGRybV9jb25uZWN0b3JfaW5pdChkcm0sICZ0Yy0+Y29ubmVj
dG9yLCAmdGNfY29ubmVjdG9yX2Z1bmNzLAogCQkJCSB0Yy0+cGFuZWwgPyBEUk1fTU9ERV9DT05O
RUNUT1JfZURQIDoKQEAgLTEyNTYsNiArMTI5NywxNSBAQCBzdGF0aWMgaW50IHRjX2JyaWRnZV9h
dHRhY2goc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSkKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0
OwogCisJLyogRG9uJ3QgcG9sbCBpZiBkb24ndCBoYXZlIEhQRCBjb25uZWN0ZWQgKi8KKwlpZiAo
dGMtPmhwZF9waW4gPj0gMCkgeworCQlpZiAodGMtPmhhdmVfaXJxKQorCQkJdGMtPmNvbm5lY3Rv
ci5wb2xsZWQgPSBEUk1fQ09OTkVDVE9SX1BPTExfSFBEOworCQllbHNlCisJCQl0Yy0+Y29ubmVj
dG9yLnBvbGxlZCA9IERSTV9DT05ORUNUT1JfUE9MTF9DT05ORUNUIHwKKwkJCQkJICAgICAgIERS
TV9DT05ORUNUT1JfUE9MTF9ESVNDT05ORUNUOworCX0KKwogCWlmICh0Yy0+cGFuZWwpCiAJCWRy
bV9wYW5lbF9hdHRhY2godGMtPnBhbmVsLCAmdGMtPmNvbm5lY3Rvcik7CiAKQEAgLTEzMjIsNiAr
MTM3Miw0OSBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHJlZ21hcF9jb25maWcgdGNfcmVnbWFwX2Nv
bmZpZyA9IHsKIAkudmFsX2Zvcm1hdF9lbmRpYW4gPSBSRUdNQVBfRU5ESUFOX0xJVFRMRSwKIH07
CiAKK3N0YXRpYyBpcnFyZXR1cm5fdCB0Y19pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcp
Cit7CisJc3RydWN0IHRjX2RhdGEgKnRjID0gYXJnOworCXUzMiB2YWw7CisJaW50IHI7CisKKwly
ID0gcmVnbWFwX3JlYWQodGMtPnJlZ21hcCwgSU5UU1RTX0csICZ2YWwpOworCWlmIChyKQorCQly
ZXR1cm4gSVJRX05PTkU7CisKKwlpZiAoIXZhbCkKKwkJcmV0dXJuIElSUV9OT05FOworCisJaWYg
KHZhbCAmIElOVF9TWVNFUlIpIHsKKwkJdTMyIHN0YXQgPSAwOworCisJCXJlZ21hcF9yZWFkKHRj
LT5yZWdtYXAsIFNZU1NUQVQsICZzdGF0KTsKKworCQlkZXZfZXJyKHRjLT5kZXYsICJzeXNlcnIg
JXhcbiIsIHN0YXQpOworCX0KKworCWlmICh0Yy0+aHBkX3BpbiA+PSAwICYmIHRjLT5icmlkZ2Uu
ZGV2KSB7CisJCS8qCisJCSAqIEggaXMgdHJpZ2dlcmVkIHdoZW4gdGhlIEdQSU8gZ29lcyBoaWdo
LgorCQkgKgorCQkgKiBMQyBpcyB0cmlnZ2VyZWQgd2hlbiB0aGUgR1BJTyBnb2VzIGxvdyBhbmQg
c3RheXMgbG93IGZvcgorCQkgKiB0aGUgZHVyYXRpb24gb2YgTENOVAorCQkgKi8KKwkJYm9vbCBo
ID0gdmFsICYgSU5UX0dQSU9fSCh0Yy0+aHBkX3Bpbik7CisJCWJvb2wgbGMgPSB2YWwgJiBJTlRf
R1BJT19MQyh0Yy0+aHBkX3Bpbik7CisKKwkJZGV2X2RiZyh0Yy0+ZGV2LCAiR1BJTyVkOiAlcyAl
c1xuIiwgdGMtPmhwZF9waW4sCisJCQloID8gIkgiIDogIiIsIGxjID8gIkxDIiA6ICIiKTsKKwor
CQlpZiAoaCB8fCBsYykKKwkJCWRybV9rbXNfaGVscGVyX2hvdHBsdWdfZXZlbnQodGMtPmJyaWRn
ZS5kZXYpOworCX0KKworCXJlZ21hcF93cml0ZSh0Yy0+cmVnbWFwLCBJTlRTVFNfRywgdmFsKTsK
KworCXJldHVybiBJUlFfSEFORExFRDsKK30KKwogc3RhdGljIGludCB0Y19wcm9iZShzdHJ1Y3Qg
aTJjX2NsaWVudCAqY2xpZW50LCBjb25zdCBzdHJ1Y3QgaTJjX2RldmljZV9pZCAqaWQpCiB7CiAJ
c3RydWN0IGRldmljZSAqZGV2ID0gJmNsaWVudC0+ZGV2OwpAQCAtMTM3Myw2ICsxNDY2LDMzIEBA
IHN0YXRpYyBpbnQgdGNfcHJvYmUoc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCwgY29uc3Qgc3Ry
dWN0IGkyY19kZXZpY2VfaWQgKmlkKQogCQlyZXR1cm4gcmV0OwogCX0KIAorCXJldCA9IG9mX3By
b3BlcnR5X3JlYWRfdTMyKGRldi0+b2Zfbm9kZSwgInRvc2hpYmEsaHBkLXBpbiIsCisJCQkJICAg
JnRjLT5ocGRfcGluKTsKKwlpZiAocmV0KSB7CisJCXRjLT5ocGRfcGluID0gLUVOT0RFVjsKKwl9
IGVsc2UgeworCQlpZiAodGMtPmhwZF9waW4gPCAwIHx8IHRjLT5ocGRfcGluID4gMSkgeworCQkJ
ZGV2X2VycihkZXYsICJmYWlsZWQgdG8gcGFyc2UgSFBEIG51bWJlclxuIik7CisJCQlyZXR1cm4g
cmV0OworCQl9CisJfQorCisJaWYgKGNsaWVudC0+aXJxID4gMCkgeworCQkvKiBlbmFibGUgU3lz
RXJyICovCisJCXJlZ21hcF93cml0ZSh0Yy0+cmVnbWFwLCBJTlRDVExfRywgSU5UX1NZU0VSUik7
CisKKwkJcmV0ID0gZGV2bV9yZXF1ZXN0X3RocmVhZGVkX2lycShkZXYsIGNsaWVudC0+aXJxLAor
CQkJCQkJTlVMTCwgdGNfaXJxX2hhbmRsZXIsCisJCQkJCQlJUlFGX09ORVNIT1QsCisJCQkJCQki
dGMzNTg3NjctaXJxIiwgdGMpOworCQlpZiAocmV0KSB7CisJCQlkZXZfZXJyKGRldiwgImZhaWxl
ZCB0byByZWdpc3RlciBkcCBpbnRlcnJ1cHRcbiIpOworCQkJcmV0dXJuIHJldDsKKwkJfQorCisJ
CXRjLT5oYXZlX2lycSA9IHRydWU7CisJfQorCiAJcmV0ID0gcmVnbWFwX3JlYWQodGMtPnJlZ21h
cCwgVENfSURSRUcsICZ0Yy0+cmV2KTsKIAlpZiAocmV0KSB7CiAJCWRldl9lcnIodGMtPmRldiwg
ImNhbiBub3QgcmVhZCBkZXZpY2UgSUQ6ICVkXG4iLCByZXQpOwpAQCAtMTM4Niw2ICsxNTA2LDIy
IEBAIHN0YXRpYyBpbnQgdGNfcHJvYmUoc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCwgY29uc3Qg
c3RydWN0IGkyY19kZXZpY2VfaWQgKmlkKQogCiAJdGMtPmFzc3IgPSAodGMtPnJldiA9PSAweDY2
MDEpOyAvKiBFbmFibGUgQVNTUiBmb3IgZURQIHBhbmVscyAqLwogCisJaWYgKHRjLT5ocGRfcGlu
ID49IDApIHsKKwkJdTMyIGxjbnRfcmVnID0gdGMtPmhwZF9waW4gPT0gMCA/IElOVF9HUDBfTENO
VCA6IElOVF9HUDFfTENOVDsKKwkJdTMyIGhfbGMgPSBJTlRfR1BJT19IKHRjLT5ocGRfcGluKSB8
IElOVF9HUElPX0xDKHRjLT5ocGRfcGluKTsKKworCQkvKiBTZXQgTENOVCB0byAybXMgKi8KKwkJ
cmVnbWFwX3dyaXRlKHRjLT5yZWdtYXAsIGxjbnRfcmVnLAorCQkJICAgICBjbGtfZ2V0X3JhdGUo
dGMtPnJlZmNsaykgKiAyIC8gMTAwMCk7CisJCS8qIFdlIG5lZWQgdGhlICJhbHRlcm5hdGUiIG1v
ZGUgZm9yIEhQRCAqLworCQlyZWdtYXBfd3JpdGUodGMtPnJlZ21hcCwgR1BJT00sIEJJVCh0Yy0+
aHBkX3BpbikpOworCisJCWlmICh0Yy0+aGF2ZV9pcnEpIHsKKwkJCS8qIGVuYWJsZSBIICYgTEMg
Ki8KKwkJCXJlZ21hcF91cGRhdGVfYml0cyh0Yy0+cmVnbWFwLCBJTlRDVExfRywgaF9sYywgaF9s
Yyk7CisJCX0KKwl9CisKIAlyZXQgPSB0Y19hdXhfbGlua19zZXR1cCh0Yyk7CiAJaWYgKHJldCkK
IAkJcmV0dXJuIHJldDsKQEAgLTEzOTgsMTIgKzE1MzQsNiBAQCBzdGF0aWMgaW50IHRjX3Byb2Jl
KHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQsIGNvbnN0IHN0cnVjdCBpMmNfZGV2aWNlX2lkICpp
ZCkKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCi0JcmV0ID0gdGNfZ2V0X2Rpc3BsYXlfcHJv
cHModGMpOwotCWlmIChyZXQpCi0JCWdvdG8gZXJyX3VucmVnaXN0ZXJfYXV4OwotCi0JdGNfY29u
bmVjdG9yX3NldF9wb2xsaW5nKHRjLCAmdGMtPmNvbm5lY3Rvcik7Ci0KIAl0Yy0+YnJpZGdlLmZ1
bmNzID0gJnRjX2JyaWRnZV9mdW5jczsKIAl0Yy0+YnJpZGdlLm9mX25vZGUgPSBkZXYtPm9mX25v
ZGU7CiAJZHJtX2JyaWRnZV9hZGQoJnRjLT5icmlkZ2UpOwpAQCAtMTQxMSw5ICsxNTQxLDYgQEAg
c3RhdGljIGludCB0Y19wcm9iZShzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50LCBjb25zdCBzdHJ1
Y3QgaTJjX2RldmljZV9pZCAqaWQpCiAJaTJjX3NldF9jbGllbnRkYXRhKGNsaWVudCwgdGMpOwog
CiAJcmV0dXJuIDA7Ci1lcnJfdW5yZWdpc3Rlcl9hdXg6Ci0JZHJtX2RwX2F1eF91bnJlZ2lzdGVy
KCZ0Yy0+YXV4KTsKLQlyZXR1cm4gcmV0OwogfQogCiBzdGF0aWMgaW50IHRjX3JlbW92ZShzdHJ1
Y3QgaTJjX2NsaWVudCAqY2xpZW50KQotLSAKVGV4YXMgSW5zdHJ1bWVudHMgRmlubGFuZCBPeSwg
UG9ya2thbGFua2F0dSAyMiwgMDAxODAgSGVsc2lua2kuClktdHVubnVzL0J1c2luZXNzIElEOiAw
NjE1NTIxLTQuIEtvdGlwYWlra2EvRG9taWNpbGU6IEhlbHNpbmtpCgpfX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRy
aS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5v
cmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
