Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id D2FA1FC143
	for <lists+dri-devel@lfdr.de>; Thu, 14 Nov 2019 09:09:37 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 152856E329;
	Thu, 14 Nov 2019 08:08:01 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
X-Greylist: delayed 370 seconds by postgrey-1.36 at gabe;
 Thu, 14 Nov 2019 05:55:47 UTC
Received: from alexa-out-blr-02.qualcomm.com (alexa-out-blr-02.qualcomm.com
 [103.229.18.198])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 14D186E0A0;
 Thu, 14 Nov 2019 05:55:46 +0000 (UTC)
Received: from ironmsg02-blr.qualcomm.com ([10.86.208.131])
 by alexa-out-blr-02.qualcomm.com with ESMTP/TLS/AES256-SHA;
 14 Nov 2019 11:19:35 +0530
IronPort-SDR: VCwIU6ST0YHjpp+A8fMy4sc0Oc0DL5w4hpf2qMpQnijYy4LXhU8sYbryqJm6F6nu4dmk+3WZK1
 W3jDOPh+LBzjlZrZ4wH3DsIjZkZH6hnUochfhEo0F2P93Nchv5PMUvS2yE1ikitpShlxitY3wL
 THBnbyCAjxXFV/xjp+kae0694Fe7G2kYl95qKPlwNMClxktv2rPdibOSEcEEPiFEKw1Qglhpwa
 +lhJ5ycbh76UIc1y9yiXuAU2fZZlnk6u04OMkdyTWu5Lkr9PQMwZ7Cikq0brfqMCgeLfHp3NEy
 zEPXKuJzIPXfWmYkQim0b1jj
Received: from dhar-linux.qualcomm.com ([10.204.66.25])
 by ironmsg02-blr.qualcomm.com with ESMTP; 14 Nov 2019 11:19:10 +0530
Received: by dhar-linux.qualcomm.com (Postfix, from userid 2306995)
 id 092583AE6; Thu, 14 Nov 2019 11:19:09 +0530 (IST)
From: Shubhashree Dhar <dhar@codeaurora.org>
To: dri-devel@lists.freedesktop.org, linux-arm-msm@vger.kernel.org,
 freedreno@lists.freedesktop.org, devicetree@vger.kernel.org
Subject: [v1] msm: disp: dpu1: add support to access hw irqs regs depending on
 revision
Date: Thu, 14 Nov 2019 11:18:56 +0530
Message-Id: <1573710536-26889-1-git-send-email-dhar@codeaurora.org>
X-Mailer: git-send-email 1.9.1
X-Mailman-Approved-At: Thu, 14 Nov 2019 08:07:50 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Shubhashree Dhar <dhar@codeaurora.org>, linux-kernel@vger.kernel.org,
 abhinavk@codeaurora.org, seanpaul@chromium.org, hoegsberg@chromium.org,
 chandanu@codeaurora.org
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

Q3VycmVudCBjb2RlIGFzc3VtZXMgdGhhdCBhbGwgdGhlIGlycXMgcmVnaXN0ZXJzIG9mZnNldHMg
Y2FuIGJlCmFjY2Vzc2VkIGluIGFsbCB0aGUgaHcgcmV2aXNpb25zOyB0aGlzIGlzIG5vdCB0aGUg
Y2FzZSBmb3Igc29tZQp0YXJnZXRzIHRoYXQgc2hvdWxkIG5vdCBhY2Nlc3Mgc29tZSBvZiB0aGUg
aXJxIHJlZ2lzdGVycy4KVGhpcyBjaGFuZ2UgYWRkcyB0aGUgc3VwcG9ydCB0byBzZWxlY3RpdmVs
eSByZW1vdmUgdGhlIGlycXMgdGhhdAphcmUgbm90IHN1cHBvcnRlZCBpbiBzb21lIG9mIHRoZSBo
dyByZXZpc2lvbnMuCgpDaGFuZ2UtSWQ6IEk2MDUyYjgyMzdiNzAzYTFhOWVkZDUzODkzZTA0Zjdi
ZDcyMjIzZGExClNpZ25lZC1vZmYtYnk6IFNodWJoYXNocmVlIERoYXIgPGRoYXJAY29kZWF1cm9y
YS5vcmc+Ci0tLQogZHJpdmVycy9ncHUvZHJtL21zbS9kaXNwL2RwdTEvZHB1X2h3X2NhdGFsb2cu
YyAgICB8ICAgMSArCiBkcml2ZXJzL2dwdS9kcm0vbXNtL2Rpc3AvZHB1MS9kcHVfaHdfY2F0YWxv
Zy5oICAgIHwgICAzICsKIGRyaXZlcnMvZ3B1L2RybS9tc20vZGlzcC9kcHUxL2RwdV9od19pbnRl
cnJ1cHRzLmMgfCAgMjIgKy0KIGRyaXZlcnMvZ3B1L2RybS9tc20vZGlzcC9kcHUxL2RwdV9od19p
bnRlcnJ1cHRzLmggfCAgIDEgKwogZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLXZpc2lvbm94
LXJtNjkyOTkuYyAgICB8IDQ3OCArKysrKysrKysrKysrKysrKysrKysrCiA1IGZpbGVzIGNoYW5n
ZWQsIDUwMCBpbnNlcnRpb25zKCspLCA1IGRlbGV0aW9ucygtKQogY3JlYXRlIG1vZGUgMTAwNjQ0
IGRyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC12aXNpb25veC1ybTY5Mjk5LmMKCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vbXNtL2Rpc3AvZHB1MS9kcHVfaHdfY2F0YWxvZy5jIGIvZHJp
dmVycy9ncHUvZHJtL21zbS9kaXNwL2RwdTEvZHB1X2h3X2NhdGFsb2cuYwppbmRleCAwNGM4YzQ0
Li4zNTdlMTViIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbXNtL2Rpc3AvZHB1MS9kcHVf
aHdfY2F0YWxvZy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vZGlzcC9kcHUxL2RwdV9od19j
YXRhbG9nLmMKQEAgLTQyMSw2ICs0MjEsNyBAQCBzdGF0aWMgdm9pZCBzZG04NDVfY2ZnX2luaXQo
c3RydWN0IGRwdV9tZHNzX2NmZyAqZHB1X2NmZykKIAkJLnJlZ19kbWFfY291bnQgPSAxLAogCQku
ZG1hX2NmZyA9IHNkbTg0NV9yZWdkbWEsCiAJCS5wZXJmID0gc2RtODQ1X3BlcmZfZGF0YSwKKwkJ
Lm1kc3NfaXJxc1swXSA9IDB4M2ZmLAogCX07CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9tc20vZGlzcC9kcHUxL2RwdV9od19jYXRhbG9nLmggYi9kcml2ZXJzL2dwdS9kcm0vbXNt
L2Rpc3AvZHB1MS9kcHVfaHdfY2F0YWxvZy5oCmluZGV4IGVjNzZiODY4Li5kZWY4YTNmIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbXNtL2Rpc3AvZHB1MS9kcHVfaHdfY2F0YWxvZy5oCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vZGlzcC9kcHUxL2RwdV9od19jYXRhbG9nLmgKQEAgLTY0
Niw2ICs2NDYsNyBAQCBzdHJ1Y3QgZHB1X3BlcmZfY2ZnIHsKICAqIEBkbWFfZm9ybWF0cyAgICAg
ICAgU3VwcG9ydGVkIGZvcm1hdHMgZm9yIGRtYSBwaXBlCiAgKiBAY3Vyc29yX2Zvcm1hdHMgICAg
IFN1cHBvcnRlZCBmb3JtYXRzIGZvciBjdXJzb3IgcGlwZQogICogQHZpZ19mb3JtYXRzICAgICAg
ICBTdXBwb3J0ZWQgZm9ybWF0cyBmb3IgdmlnIHBpcGUKKyAqIEBtZHNzX2lycXMgICAgICAgICAg
Qml0bWFwIHdpdGggdGhlIGlycXMgc3VwcG9ydGVkIGJ5IHRoZSB0YXJnZXQKICAqLwogc3RydWN0
IGRwdV9tZHNzX2NmZyB7CiAJdTMyIGh3dmVyc2lvbjsKQEAgLTY4NCw2ICs2ODUsOCBAQCBzdHJ1
Y3QgZHB1X21kc3NfY2ZnIHsKIAlzdHJ1Y3QgZHB1X2Zvcm1hdF9leHRlbmRlZCAqZG1hX2Zvcm1h
dHM7CiAJc3RydWN0IGRwdV9mb3JtYXRfZXh0ZW5kZWQgKmN1cnNvcl9mb3JtYXRzOwogCXN0cnVj
dCBkcHVfZm9ybWF0X2V4dGVuZGVkICp2aWdfZm9ybWF0czsKKworCURFQ0xBUkVfQklUTUFQKG1k
c3NfaXJxcywgQklUU19QRVJfQllURSAqIHNpemVvZihsb25nKSk7CiB9OwogCiBzdHJ1Y3QgZHB1
X21kc3NfaHdfY2ZnX2hhbmRsZXIgewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21zbS9k
aXNwL2RwdTEvZHB1X2h3X2ludGVycnVwdHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vZGlzcC9k
cHUxL2RwdV9od19pbnRlcnJ1cHRzLmMKaW5kZXggOGJmYTdkMC4uMmEzNjM0YyAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL21zbS9kaXNwL2RwdTEvZHB1X2h3X2ludGVycnVwdHMuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vbXNtL2Rpc3AvZHB1MS9kcHVfaHdfaW50ZXJydXB0cy5jCkBAIC04
MDAsNyArODAwLDggQEAgc3RhdGljIHZvaWQgZHB1X2h3X2ludHJfZGlzcGF0Y2hfaXJxKHN0cnVj
dCBkcHVfaHdfaW50ciAqaW50ciwKIAkJc3RhcnRfaWR4ID0gcmVnX2lkeCAqIDMyOwogCQllbmRf
aWR4ID0gc3RhcnRfaWR4ICsgMzI7CiAKLQkJaWYgKHN0YXJ0X2lkeCA+PSBBUlJBWV9TSVpFKGRw
dV9pcnFfbWFwKSB8fAorCQlpZiAoIXRlc3RfYml0KHJlZ19pZHgsICZpbnRyLT5pcnFfbWFzaykg
fHwKKwkJCXN0YXJ0X2lkeCA+PSBBUlJBWV9TSVpFKGRwdV9pcnFfbWFwKSB8fAogCQkJCWVuZF9p
ZHggPiBBUlJBWV9TSVpFKGRwdV9pcnFfbWFwKSkKIAkJCWNvbnRpbnVlOwogCkBAIC05NTUsOCAr
OTU2LDExIEBAIHN0YXRpYyBpbnQgZHB1X2h3X2ludHJfY2xlYXJfaXJxcyhzdHJ1Y3QgZHB1X2h3
X2ludHIgKmludHIpCiAJaWYgKCFpbnRyKQogCQlyZXR1cm4gLUVJTlZBTDsKIAotCWZvciAoaSA9
IDA7IGkgPCBBUlJBWV9TSVpFKGRwdV9pbnRyX3NldCk7IGkrKykKLQkJRFBVX1JFR19XUklURSgm
aW50ci0+aHcsIGRwdV9pbnRyX3NldFtpXS5jbHJfb2ZmLCAweGZmZmZmZmZmKTsKKwlmb3IgKGkg
PSAwOyBpIDwgQVJSQVlfU0laRShkcHVfaW50cl9zZXQpOyBpKyspIHsKKwkJaWYodGVzdF9iaXQo
aSwgJmludHItPmlycV9tYXNrKSkKKwkJCURQVV9SRUdfV1JJVEUoJmludHItPmh3LAorCQkJCQlk
cHVfaW50cl9zZXRbaV0uY2xyX29mZiwgMHhmZmZmZmZmZik7CisJfQogCiAJLyogZW5zdXJlIHJl
Z2lzdGVyIHdyaXRlcyBnbyB0aHJvdWdoICovCiAJd21iKCk7CkBAIC05NzEsOCArOTc1LDExIEBA
IHN0YXRpYyBpbnQgZHB1X2h3X2ludHJfZGlzYWJsZV9pcnFzKHN0cnVjdCBkcHVfaHdfaW50ciAq
aW50cikKIAlpZiAoIWludHIpCiAJCXJldHVybiAtRUlOVkFMOwogCi0JZm9yIChpID0gMDsgaSA8
IEFSUkFZX1NJWkUoZHB1X2ludHJfc2V0KTsgaSsrKQotCQlEUFVfUkVHX1dSSVRFKCZpbnRyLT5o
dywgZHB1X2ludHJfc2V0W2ldLmVuX29mZiwgMHgwMDAwMDAwMCk7CisJZm9yIChpID0gMDsgaSA8
IEFSUkFZX1NJWkUoZHB1X2ludHJfc2V0KTsgaSsrKSB7CisJCWlmKHRlc3RfYml0KGksICZpbnRy
LT5pcnFfbWFzaykpCisJCQlEUFVfUkVHX1dSSVRFKCZpbnRyLT5odywKKwkJCQkJZHB1X2ludHJf
c2V0W2ldLmVuX29mZiwgMHgwMDAwMDAwMCk7CisJfQogCiAJLyogZW5zdXJlIHJlZ2lzdGVyIHdy
aXRlcyBnbyB0aHJvdWdoICovCiAJd21iKCk7CkBAIC05OTEsNiArOTk4LDEwIEBAIHN0YXRpYyB2
b2lkIGRwdV9od19pbnRyX2dldF9pbnRlcnJ1cHRfc3RhdHVzZXMoc3RydWN0IGRwdV9od19pbnRy
ICppbnRyKQogCiAJc3Bpbl9sb2NrX2lycXNhdmUoJmludHItPmlycV9sb2NrLCBpcnFfZmxhZ3Mp
OwogCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGRwdV9pbnRyX3NldCk7IGkrKykgeworCisJ
CWlmKCF0ZXN0X2JpdChpLCAmaW50ci0+aXJxX21hc2spKQorCQkJY29udGludWU7CisKIAkJLyog
UmVhZCBpbnRlcnJ1cHQgc3RhdHVzICovCiAJCWludHItPnNhdmVfaXJxX3N0YXR1c1tpXSA9IERQ
VV9SRUdfUkVBRCgmaW50ci0+aHcsCiAJCQkJZHB1X2ludHJfc2V0W2ldLnN0YXR1c19vZmYpOwpA
QCAtMTExNSw2ICsxMTI2LDcgQEAgc3RydWN0IGRwdV9od19pbnRyICpkcHVfaHdfaW50cl9pbml0
KHZvaWQgX19pb21lbSAqYWRkciwKIAkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7CiAJfQogCisJ
aW50ci0+aXJxX21hc2sgPSBtLT5tZHNzX2lycXNbMF07CiAJc3Bpbl9sb2NrX2luaXQoJmludHIt
PmlycV9sb2NrKTsKIAogCXJldHVybiBpbnRyOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L21zbS9kaXNwL2RwdTEvZHB1X2h3X2ludGVycnVwdHMuaCBiL2RyaXZlcnMvZ3B1L2RybS9tc20v
ZGlzcC9kcHUxL2RwdV9od19pbnRlcnJ1cHRzLmgKaW5kZXggNGVkY2Y0MC4uZmM5Yzk4NiAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL21zbS9kaXNwL2RwdTEvZHB1X2h3X2ludGVycnVwdHMu
aAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL2Rpc3AvZHB1MS9kcHVfaHdfaW50ZXJydXB0cy5o
CkBAIC0xODcsNiArMTg3LDcgQEAgc3RydWN0IGRwdV9od19pbnRyIHsKIAl1MzIgKnNhdmVfaXJx
X3N0YXR1czsKIAl1MzIgaXJxX2lkeF90Ymxfc2l6ZTsKIAlzcGlubG9ja190IGlycV9sb2NrOwor
CXVuc2lnbmVkIGxvbmcgaXJxX21hc2s7CiB9OwogCiAvKioKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9wYW5lbC9wYW5lbC12aXNpb25veC1ybTY5Mjk5LmMgYi9kcml2ZXJzL2dwdS9kcm0v
cGFuZWwvcGFuZWwtdmlzaW9ub3gtcm02OTI5OS5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4
IDAwMDAwMDAwLi4xYmJkNDBkCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL3Bh
bmVsL3BhbmVsLXZpc2lvbm94LXJtNjkyOTkuYwpAQCAtMCwwICsxLDQ3OCBAQAorLy8gU1BEWC1M
aWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAKKy8qCisgKiBDb3B5cmlnaHQgKGMpIDIwMTksIFRo
ZSBMaW51eCBGb3VuZGF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLgorICovCisKKyNpbmNsdWRl
IDxkcm0vZHJtX3BhbmVsLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9taXBpX2RzaS5oPgorI2luY2x1
ZGUgPGRybS9kcm1fbW9kZXMuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3BhbmVsLmg+CisjaW5jbHVk
ZSA8ZHJtL2RybV9wcmludC5oPgorCisjaW5jbHVkZSA8bGludXgvb2ZfZ3Bpby5oPgorI2luY2x1
ZGUgPGxpbnV4L2dwaW8vY29uc3VtZXIuaD4KKyNpbmNsdWRlIDxsaW51eC9vZl9kZXZpY2UuaD4K
KyNpbmNsdWRlIDxsaW51eC9vZl9ncmFwaC5oPgorI2luY2x1ZGUgPGxpbnV4L3BpbmN0cmwvY29u
c3VtZXIuaD4KKyNpbmNsdWRlIDxsaW51eC9yZWd1bGF0b3IvY29uc3VtZXIuaD4KKyNpbmNsdWRl
IDxsaW51eC9iYWNrbGlnaHQuaD4KKyNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KKyNpbmNsdWRl
IDxsaW51eC9kZWxheS5oPgorCisjaW5jbHVkZSA8dmlkZW8vbWlwaV9kaXNwbGF5Lmg+CisKK3N0
YXRpYyBjb25zdCBjaGFyICogY29uc3QgcmVndWxhdG9yX25hbWVzW10gPSB7CisJInZkZGEiLAor
CSJ2ZGQzcDMiLAorfTsKKworc3RhdGljIHVuc2lnbmVkIGxvbmcgY29uc3QgcmVndWxhdG9yX2Vu
YWJsZV9sb2Fkc1tdID0geworCTMyMDAwLAorCTEzMjAwLAorfTsKKworc3RhdGljIHVuc2lnbmVk
IGxvbmcgY29uc3QgcmVndWxhdG9yX2Rpc2FibGVfbG9hZHNbXSA9IHsKKwk4MCwKKwk4MCwKK307
CisKK3N0cnVjdCBjbWRfc2V0IHsKKwl1OCBjb21tYW5kc1s0XTsKKwl1OCBzaXplOworfTsKKwor
c3RydWN0IHJtNjkyOTlfY29uZmlnIHsKKwl1MzIgd2lkdGhfbW07CisJdTMyIGhlaWdodF9tbTsK
Kwljb25zdCBjaGFyICpwYW5lbF9uYW1lOworCWNvbnN0IHN0cnVjdCBjbWRfc2V0ICpwYW5lbF9v
bl9jbWRzOworCXUzMiBudW1fb25fY21kczsKKwljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9k
ZSAqZG07Cit9OworCitzdHJ1Y3QgdmlzaW9ub3hfcm02OTI5OSB7CisJc3RydWN0IGRldmljZSAq
ZGV2OworCXN0cnVjdCBkcm1fcGFuZWwgcGFuZWw7CisKKwlzdHJ1Y3QgcmVndWxhdG9yX2J1bGtf
ZGF0YSBzdXBwbGllc1tBUlJBWV9TSVpFKHJlZ3VsYXRvcl9uYW1lcyldOworCisJc3RydWN0IGdw
aW9fZGVzYyAqcmVzZXRfZ3BpbzsKKworCXN0cnVjdCBiYWNrbGlnaHRfZGV2aWNlICpiYWNrbGln
aHQ7CisKKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2k7CisJY29uc3Qgc3RydWN0IHJtNjky
OTlfY29uZmlnICpjb25maWc7CisJYm9vbCBwcmVwYXJlZDsKKwlib29sIGVuYWJsZWQ7Cit9Owor
CitzdGF0aWMgaW5saW5lIHN0cnVjdCB2aXNpb25veF9ybTY5Mjk5ICpwYW5lbF90b19jdHgoc3Ry
dWN0IGRybV9wYW5lbCAqcGFuZWwpCit7CisJcmV0dXJuIGNvbnRhaW5lcl9vZihwYW5lbCwgc3Ry
dWN0IHZpc2lvbm94X3JtNjkyOTksIHBhbmVsKTsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBj
bWRfc2V0IHFjb21fcm02OTI5OV8xMDgwcF9wYW5lbF9tYWdpY19jbWRzW10gPSB7CisJeyB7IDB4
ZmUsIDB4MDAgfSwgMiB9LAorCXsgeyAweGMyLCAweDA4IH0sIDIgfSwKKwl7IHsgMHgzNSwgMHgw
MCB9LCAyIH0sCisJeyB7IDB4NTEsIDB4ZmYgfSwgMiB9LAorfTsKKworc3RhdGljIGludCB2aXNp
b25veF9kY3Nfd3JpdGUoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwsIHUzMiBjb21tYW5kKQorewor
CXN0cnVjdCB2aXNpb25veF9ybTY5Mjk5ICpjdHggPSBwYW5lbF90b19jdHgocGFuZWwpOworCWlu
dCBpID0gMCwgcmV0OworCisJcmV0ID0gbWlwaV9kc2lfZGNzX3dyaXRlKGN0eC0+ZHNpLCBjb21t
YW5kLCBOVUxMLCAwKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGN0eC0+ZGV2
LAorCQkJImNtZCAweCV4IGZhaWxlZCBmb3IgZHNpID0gJWRcbiIsCisJCQljb21tYW5kLCBpKTsK
Kwl9CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IHZpc2lvbm94X2Rjc193cml0ZV9i
dWYoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwsCisJdTMyIHNpemUsIGNvbnN0IHU4ICpidWYpCit7
CisJc3RydWN0IHZpc2lvbm94X3JtNjkyOTkgKmN0eCA9IHBhbmVsX3RvX2N0eChwYW5lbCk7CisJ
aW50IHJldCA9IDA7CisJaW50IGkgPSAwOworCisJcmV0ID0gbWlwaV9kc2lfZGNzX3dyaXRlX2J1
ZmZlcihjdHgtPmRzaSwgYnVmLCBzaXplKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VS
Uk9SKGN0eC0+ZGV2LAorCQkJImZhaWxlZCB0byB0eCBjbWQgWyVkXSwgZXJyOiAlZFxuIiwgaSwg
cmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50
IHZpc2lvbm94XzM1NTk3X3Bvd2VyX29uKHN0cnVjdCB2aXNpb25veF9ybTY5Mjk5ICpjdHgpCit7
CisJaW50IHJldCwgaTsKKwlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShjdHgtPnN1cHBsaWVz
KTsgaSsrKSB7CisJCXJldCA9IHJlZ3VsYXRvcl9zZXRfbG9hZChjdHgtPnN1cHBsaWVzW2ldLmNv
bnN1bWVyLAorCQkJCQlyZWd1bGF0b3JfZW5hYmxlX2xvYWRzW2ldKTsKKwkJaWYgKHJldCkKKwkJ
CXJldHVybiByZXQ7CisJfQorCisJcmV0ID0gcmVndWxhdG9yX2J1bGtfZW5hYmxlKEFSUkFZX1NJ
WkUoY3R4LT5zdXBwbGllcyksIGN0eC0+c3VwcGxpZXMpOworCWlmIChyZXQgPCAwKQorCQlyZXR1
cm4gcmV0OworCisJLyoKKwkgKiBSZXNldCBzZXF1ZW5jZSBvZiB2aXNpb25veCBwYW5lbCByZXF1
aXJlcyB0aGUgcGFuZWwgdG8gYmUKKwkgKiBvdXQgb2YgcmVzZXQgZm9yIDEwbXMsIGZvbGxvd2Vk
IGJ5IGJlaW5nIGhlbGQgaW4gcmVzZXQKKwkgKiBmb3IgMTBtcyBhbmQgdGhlbiBvdXQgYWdhaW4K
KwkgKi8KKwlncGlvZF9zZXRfdmFsdWUoY3R4LT5yZXNldF9ncGlvLCAxKTsKKwl1c2xlZXBfcmFu
Z2UoMTAwMDAsIDIwMDAwKTsKKwlncGlvZF9zZXRfdmFsdWUoY3R4LT5yZXNldF9ncGlvLCAwKTsK
Kwl1c2xlZXBfcmFuZ2UoMTAwMDAsIDIwMDAwKTsKKwlncGlvZF9zZXRfdmFsdWUoY3R4LT5yZXNl
dF9ncGlvLCAxKTsKKwl1c2xlZXBfcmFuZ2UoMTAwMDAsIDIwMDAwKTsKKworCXJldHVybiAwOwor
fQorCitzdGF0aWMgaW50IHZpc2lvbm94X3JtNjkyOTlfcG93ZXJfb2ZmKHN0cnVjdCB2aXNpb25v
eF9ybTY5Mjk5ICpjdHgpCit7CisJaW50IHJldCA9IDA7CisJaW50IGk7CisKKwlncGlvZF9zZXRf
dmFsdWUoY3R4LT5yZXNldF9ncGlvLCAwKTsKKworCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpF
KGN0eC0+c3VwcGxpZXMpOyBpKyspIHsKKwkJcmV0ID0gcmVndWxhdG9yX3NldF9sb2FkKGN0eC0+
c3VwcGxpZXNbaV0uY29uc3VtZXIsCisJCQkJcmVndWxhdG9yX2Rpc2FibGVfbG9hZHNbaV0pOwor
CQlpZiAocmV0KSB7CisJCQlEUk1fREVWX0VSUk9SKGN0eC0+ZGV2LAorCQkJCSJyZWd1bGF0b3Jf
c2V0X2xvYWQgZmFpbGVkICVkXG4iLCByZXQpOworCQkJcmV0dXJuIHJldDsKKwkJfQorCX0KKwor
CXJldCA9IHJlZ3VsYXRvcl9idWxrX2Rpc2FibGUoQVJSQVlfU0laRShjdHgtPnN1cHBsaWVzKSwg
Y3R4LT5zdXBwbGllcyk7CisJaWYgKHJldCkgeworCQlEUk1fREVWX0VSUk9SKGN0eC0+ZGV2LAor
CQkJInJlZ3VsYXRvcl9idWxrX2Rpc2FibGUgZmFpbGVkICVkXG4iLCByZXQpOworCX0KKwlyZXR1
cm4gcmV0OworfQorCitzdGF0aWMgaW50IHZpc2lvbm94X3JtNjkyOTlfZGlzYWJsZShzdHJ1Y3Qg
ZHJtX3BhbmVsICpwYW5lbCkKK3sKKwlzdHJ1Y3QgdmlzaW9ub3hfcm02OTI5OSAqY3R4ID0gcGFu
ZWxfdG9fY3R4KHBhbmVsKTsKKwlpbnQgcmV0OworCisJaWYgKCFjdHgtPmVuYWJsZWQpCisJCXJl
dHVybiAwOworCisJaWYgKGN0eC0+YmFja2xpZ2h0KSB7CisJCXJldCA9IGJhY2tsaWdodF9kaXNh
YmxlKGN0eC0+YmFja2xpZ2h0KTsKKwkJaWYgKHJldCA8IDApCisJCQlEUk1fREVWX0VSUk9SKGN0
eC0+ZGV2LCAiYmFja2xpZ2h0IGRpc2FibGUgZmFpbGVkICVkXG4iLAorCQkJCXJldCk7CisJfQor
CisJY3R4LT5lbmFibGVkID0gZmFsc2U7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgdmlz
aW9ub3hfcm02OTI5OV91bnByZXBhcmUoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwpCit7CisJc3Ry
dWN0IHZpc2lvbm94X3JtNjkyOTkgKmN0eCA9IHBhbmVsX3RvX2N0eChwYW5lbCk7CisJaW50IHJl
dCA9IDA7CisKKwlpZiAoIWN0eC0+cHJlcGFyZWQpCisJCXJldHVybiAwOworCisJY3R4LT5kc2kt
Pm1vZGVfZmxhZ3MgPSAwOworCisJcmV0ID0gdmlzaW9ub3hfZGNzX3dyaXRlKHBhbmVsLCBNSVBJ
X0RDU19TRVRfRElTUExBWV9PRkYpOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9ERVZfRVJST1Io
Y3R4LT5kZXYsCisJCQkic2V0X2Rpc3BsYXlfb2ZmIGNtZCBmYWlsZWQgcmV0ID0gJWRcbiIsCisJ
CQlyZXQpOworCX0KKworCS8qIDEyMG1zIGRlbGF5IHJlcXVpcmVkIGhlcmUgYXMgcGVyIERDUyBz
cGVjICovCisJbXNsZWVwKDEyMCk7CisKKwlyZXQgPSB2aXNpb25veF9kY3Nfd3JpdGUocGFuZWws
IE1JUElfRENTX0VOVEVSX1NMRUVQX01PREUpOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9ERVZf
RVJST1IoY3R4LT5kZXYsCisJCQkiZW50ZXJfc2xlZXAgY21kIGZhaWxlZCByZXQgPSAlZFxuIiwg
cmV0KTsKKwl9CisKKwlyZXQgPSB2aXNpb25veF9ybTY5Mjk5X3Bvd2VyX29mZihjdHgpOworCWlm
IChyZXQgPCAwKQorCQlEUk1fREVWX0VSUk9SKGN0eC0+ZGV2LCAicG93ZXJfb2ZmIGZhaWxlZCBy
ZXQgPSAlZFxuIiwgcmV0KTsKKworCWN0eC0+cHJlcGFyZWQgPSBmYWxzZTsKKwlyZXR1cm4gcmV0
OworfQorCitzdGF0aWMgaW50IHZpc2lvbm94X3JtNjkyOTlfcHJlcGFyZShzdHJ1Y3QgZHJtX3Bh
bmVsICpwYW5lbCkKK3sKKwlzdHJ1Y3QgdmlzaW9ub3hfcm02OTI5OSAqY3R4ID0gcGFuZWxfdG9f
Y3R4KHBhbmVsKTsKKwlpbnQgcmV0OworCWludCBpOworCWNvbnN0IHN0cnVjdCBjbWRfc2V0ICpw
YW5lbF9vbl9jbWRzOworCWNvbnN0IHN0cnVjdCBybTY5Mjk5X2NvbmZpZyAqY29uZmlnOworCXUz
MiBudW1fY21kczsKKworCWlmIChjdHgtPnByZXBhcmVkKQorCQlyZXR1cm4gMDsKKworCXJldCA9
IHZpc2lvbm94XzM1NTk3X3Bvd2VyX29uKGN0eCk7CisJaWYgKHJldCA8IDApCisJCXJldHVybiBy
ZXQ7CisKKwljdHgtPmRzaS0+bW9kZV9mbGFncyB8PSBNSVBJX0RTSV9NT0RFX0xQTTsKKworCWNv
bmZpZyA9IGN0eC0+Y29uZmlnOworCXBhbmVsX29uX2NtZHMgPSBjb25maWctPnBhbmVsX29uX2Nt
ZHM7CisJbnVtX2NtZHMgPSBjb25maWctPm51bV9vbl9jbWRzOworCisJZm9yIChpID0gMDsgaSA8
IG51bV9jbWRzOyBpKyspIHsKKwkJcmV0ID0gdmlzaW9ub3hfZGNzX3dyaXRlX2J1ZihwYW5lbCwK
KwkJCQlwYW5lbF9vbl9jbWRzW2ldLnNpemUsCisJCQkJCXBhbmVsX29uX2NtZHNbaV0uY29tbWFu
ZHMpOworCQlpZiAocmV0IDwgMCkgeworCQkJRFJNX0RFVl9FUlJPUihjdHgtPmRldiwKKwkJCQki
Y21kIHNldCB0eCBmYWlsZWQgaSA9ICVkIHJldCA9ICVkXG4iLAorCQkJCQlpLCByZXQpOworCQkJ
Z290byBwb3dlcl9vZmY7CisJCX0KKwl9CisKKwlyZXQgPSB2aXNpb25veF9kY3Nfd3JpdGUocGFu
ZWwsIE1JUElfRENTX0VYSVRfU0xFRVBfTU9ERSk7CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0RF
Vl9FUlJPUihjdHgtPmRldiwKKwkJCSJleGl0X3NsZWVwX21vZGUgY21kIGZhaWxlZCByZXQgPSAl
ZFxuIiwKKwkJCXJldCk7CisJCWdvdG8gcG93ZXJfb2ZmOworCX0KKworCS8qIFBlciBEU0kgc3Bl
YyB3YWl0IDEyMG1zIGFmdGVyIHNlbmRpbmcgZXhpdCBzbGVlcCBEQ1MgY29tbWFuZCAqLworCW1z
bGVlcCgxMjApOworCisJcmV0ID0gdmlzaW9ub3hfZGNzX3dyaXRlKHBhbmVsLCBNSVBJX0RDU19T
RVRfRElTUExBWV9PTik7CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihjdHgtPmRl
diwKKwkJCSJzZXRfZGlzcGxheV9vbiBjbWQgZmFpbGVkIHJldCA9ICVkXG4iLCByZXQpOworCQln
b3RvIHBvd2VyX29mZjsKKwl9CisKKwkvKiBQZXIgRFNJIHNwZWMgd2FpdCAxMjBtcyBhZnRlciBz
ZW5kaW5nIHNldF9kaXNwbGF5X29uIERDUyBjb21tYW5kICovCisJbXNsZWVwKDEyMCk7CisKKwlj
dHgtPnByZXBhcmVkID0gdHJ1ZTsKKworCXJldHVybiAwOworCitwb3dlcl9vZmY6CisJaWYgKHZp
c2lvbm94X3JtNjkyOTlfcG93ZXJfb2ZmKGN0eCkpCisJCURSTV9ERVZfRVJST1IoY3R4LT5kZXYs
ICJwb3dlcl9vZmYgZmFpbGVkXG4iKTsKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IHZp
c2lvbm94X3JtNjkyOTlfZW5hYmxlKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQoreworCXN0cnVj
dCB2aXNpb25veF9ybTY5Mjk5ICpjdHggPSBwYW5lbF90b19jdHgocGFuZWwpOworCWludCByZXQ7
CisKKwlpZiAoY3R4LT5lbmFibGVkKQorCQlyZXR1cm4gMDsKKworCWlmIChjdHgtPmJhY2tsaWdo
dCkgeworCQlyZXQgPSBiYWNrbGlnaHRfZW5hYmxlKGN0eC0+YmFja2xpZ2h0KTsKKwkJaWYgKHJl
dCA8IDApCisJCQlEUk1fREVWX0VSUk9SKGN0eC0+ZGV2LCAiYmFja2xpZ2h0IGVuYWJsZSBmYWls
ZWQgJWRcbiIsCisJCQkJCQkgIHJldCk7CisJfQorCisJY3R4LT5lbmFibGVkID0gdHJ1ZTsKKwor
CXJldHVybiAwOworfQorCitzdGF0aWMgaW50IHZpc2lvbm94X3JtNjkyOTlfZ2V0X21vZGVzKHN0
cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQoreworCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0
b3IgPSBwYW5lbC0+Y29ubmVjdG9yOworCXN0cnVjdCB2aXNpb25veF9ybTY5Mjk5ICpjdHggPSBw
YW5lbF90b19jdHgocGFuZWwpOworCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlOworCWNv
bnN0IHN0cnVjdCBybTY5Mjk5X2NvbmZpZyAqY29uZmlnOworCisJY29uZmlnID0gY3R4LT5jb25m
aWc7CisJbW9kZSA9IGRybV9tb2RlX2NyZWF0ZShjb25uZWN0b3ItPmRldik7CisJaWYgKCFtb2Rl
KSB7CisJCURSTV9ERVZfRVJST1IoY3R4LT5kZXYsCisJCQkiZmFpbGVkIHRvIGNyZWF0ZSBhIG5l
dyBkaXNwbGF5IG1vZGVcbiIpOworCQlyZXR1cm4gMDsKKwl9CisKKwljb25uZWN0b3ItPmRpc3Bs
YXlfaW5mby53aWR0aF9tbSA9IGNvbmZpZy0+d2lkdGhfbW07CisJY29ubmVjdG9yLT5kaXNwbGF5
X2luZm8uaGVpZ2h0X21tID0gY29uZmlnLT5oZWlnaHRfbW07CisJZHJtX21vZGVfY29weShtb2Rl
LCBjb25maWctPmRtKTsKKwltb2RlLT50eXBlID0gRFJNX01PREVfVFlQRV9EUklWRVIgfCBEUk1f
TU9ERV9UWVBFX1BSRUZFUlJFRDsKKwlkcm1fbW9kZV9wcm9iZWRfYWRkKGNvbm5lY3RvciwgbW9k
ZSk7CisKKwlyZXR1cm4gMTsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fcGFuZWxfZnVu
Y3MgdmlzaW9ub3hfcm02OTI5OV9kcm1fZnVuY3MgPSB7CisJLmRpc2FibGUgPSB2aXNpb25veF9y
bTY5Mjk5X2Rpc2FibGUsCisJLnVucHJlcGFyZSA9IHZpc2lvbm94X3JtNjkyOTlfdW5wcmVwYXJl
LAorCS5wcmVwYXJlID0gdmlzaW9ub3hfcm02OTI5OV9wcmVwYXJlLAorCS5lbmFibGUgPSB2aXNp
b25veF9ybTY5Mjk5X2VuYWJsZSwKKwkuZ2V0X21vZGVzID0gdmlzaW9ub3hfcm02OTI5OV9nZXRf
bW9kZXMsCit9OworCitzdGF0aWMgaW50IHZpc2lvbm94X3JtNjkyOTlfcGFuZWxfYWRkKHN0cnVj
dCB2aXNpb25veF9ybTY5Mjk5ICpjdHgpCit7CisJc3RydWN0IGRldmljZSAqZGV2ID0gY3R4LT5k
ZXY7CisJaW50IHJldCwgaTsKKwljb25zdCBzdHJ1Y3Qgcm02OTI5OV9jb25maWcgKmNvbmZpZzsK
KworCWNvbmZpZyA9IGN0eC0+Y29uZmlnOworCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGN0
eC0+c3VwcGxpZXMpOyBpKyspCisJCWN0eC0+c3VwcGxpZXNbaV0uc3VwcGx5ID0gcmVndWxhdG9y
X25hbWVzW2ldOworCisJcmV0ID0gZGV2bV9yZWd1bGF0b3JfYnVsa19nZXQoZGV2LCBBUlJBWV9T
SVpFKGN0eC0+c3VwcGxpZXMpLAorCQkJCSAgICAgIGN0eC0+c3VwcGxpZXMpOworCWlmIChyZXQg
PCAwKQorCQlyZXR1cm4gcmV0OworCisJY3R4LT5yZXNldF9ncGlvID0gZGV2bV9ncGlvZF9nZXQo
ZGV2LCAicmVzZXQiLCBHUElPRF9PVVRfTE9XKTsKKwlpZiAoSVNfRVJSKGN0eC0+cmVzZXRfZ3Bp
bykpIHsKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJjYW5ub3QgZ2V0IHJlc2V0IGdwaW8gJWxkXG4i
LAorCQkJUFRSX0VSUihjdHgtPnJlc2V0X2dwaW8pKTsKKwkJcmV0dXJuIFBUUl9FUlIoY3R4LT5y
ZXNldF9ncGlvKTsKKwl9CisKKwlyZXQgPSBncGlvZF9kaXJlY3Rpb25fb3V0cHV0KGN0eC0+cmVz
ZXRfZ3BpbywgMCk7CisJaWYocmV0IDwgMCkgeworCQlwcl9lcnIoImRpcmVjdGlvbiBvdXRwdXQg
ZmFpbGVkIFxuIik7CisJfQorCisJZHJtX3BhbmVsX2luaXQoJmN0eC0+cGFuZWwpOworCWN0eC0+
cGFuZWwuZGV2ID0gZGV2OworCWN0eC0+cGFuZWwuZnVuY3MgPSAmdmlzaW9ub3hfcm02OTI5OV9k
cm1fZnVuY3M7CisJZHJtX3BhbmVsX2FkZCgmY3R4LT5wYW5lbCk7CisKKwlyZXR1cm4gMDsKK30K
Kworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlIHFjb21fc2M3MTgwX210cF8x
MDgwcF9tb2RlID0geworCS5uYW1lID0gIjEwODB4MjI0OCIsCisJLmNsb2NrID0gMTU4Njk1LAor
CS5oZGlzcGxheSA9IDEwODAsCisJLmhzeW5jX3N0YXJ0ID0gMTA4MCArIDI2LAorCS5oc3luY19l
bmQgPSAxMDgwICsgMjYgKyAyLAorCS5odG90YWwgPSAxMDgwICsgMjYgKyAyICsgMzYsCisJLnZk
aXNwbGF5ID0gMjI0OCwKKwkudnN5bmNfc3RhcnQgPSAyMjQ4ICsgNTYsCisJLnZzeW5jX2VuZCA9
IDIyNDggKyA1NiArIDQsCisJLnZ0b3RhbCA9IDIyNDggKyA1NiArIDQgKyA0LAorCS52cmVmcmVz
aCA9IDYwLAorCS5mbGFncyA9IDAsCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IHJtNjkyOTlf
Y29uZmlnIHJtNjkyOTlfZGlyID0geworCS53aWR0aF9tbSA9IDc0LAorCS5oZWlnaHRfbW0gPSAx
MzEsCisJLnBhbmVsX25hbWUgPSAicWNvbV9zZG04NDVfbXRwXzJrX3BhbmVsIiwKKwkuZG0gPSAm
cWNvbV9zYzcxODBfbXRwXzEwODBwX21vZGUsCisJLnBhbmVsX29uX2NtZHMgPSBxY29tX3JtNjky
OTlfMTA4MHBfcGFuZWxfbWFnaWNfY21kcywKKwkubnVtX29uX2NtZHMgPSBBUlJBWV9TSVpFKHFj
b21fcm02OTI5OV8xMDgwcF9wYW5lbF9tYWdpY19jbWRzKSwKK307CisKK3N0YXRpYyBpbnQgdmlz
aW9ub3hfcm02OTI5OV9wcm9iZShzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kpCit7CisJc3Ry
dWN0IGRldmljZSAqZGV2ID0gJmRzaS0+ZGV2OworCXN0cnVjdCB2aXNpb25veF9ybTY5Mjk5ICpj
dHg7CisJaW50IHJldCA9IDA7CisKKwljdHggPSBkZXZtX2t6YWxsb2MoZGV2LCBzaXplb2YoKmN0
eCksIEdGUF9LRVJORUwpOworCisJaWYgKCFjdHgpCisJCXJldHVybiAtRU5PTUVNOworCisJY3R4
LT5jb25maWcgPSBvZl9kZXZpY2VfZ2V0X21hdGNoX2RhdGEoZGV2KTsKKworCWlmICghY3R4LT5j
b25maWcpIHsKKwkJZGV2X2VycihkZXYsICJtaXNzaW5nIGRldmljZSBjb25maWd1cmF0aW9uXG4i
KTsKKwkJcmV0dXJuIC1FTk9ERVY7CisJfQorCisJbWlwaV9kc2lfc2V0X2RydmRhdGEoZHNpLCBj
dHgpOworCisJY3R4LT5kZXYgPSBkZXY7CisJY3R4LT5kc2kgPSBkc2k7CisKKwlyZXQgPSB2aXNp
b25veF9ybTY5Mjk5X3BhbmVsX2FkZChjdHgpOworCWlmIChyZXQpIHsKKwkJRFJNX0RFVl9FUlJP
UihkZXYsICJmYWlsZWQgdG8gYWRkIHBhbmVsXG4iKTsKKwkJZ290byBlcnJfcGFuZWxfYWRkOwor
CX0KKworCWRzaS0+bGFuZXMgPSA0OworCWRzaS0+Zm9ybWF0ID0gTUlQSV9EU0lfRk1UX1JHQjg4
ODsKKwlkc2ktPm1vZGVfZmxhZ3MgPSBNSVBJX0RTSV9NT0RFX1ZJREVPIHwgTUlQSV9EU0lfTU9E
RV9MUE0gfAorCQlNSVBJX0RTSV9DTE9DS19OT05fQ09OVElOVU9VUzsKKwlyZXQgPSBtaXBpX2Rz
aV9hdHRhY2goZHNpKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGRldiwKKwkJ
CSJkc2kgYXR0YWNoIGZhaWxlZCByZXQgPSAlZFxuIiwgcmV0KTsKKwkJZ290byBlcnJfZHNpX2F0
dGFjaDsKKwl9CisKKwlyZXR1cm4gMDsKKworZXJyX2RzaV9hdHRhY2g6CisJZHJtX3BhbmVsX3Jl
bW92ZSgmY3R4LT5wYW5lbCk7CitlcnJfcGFuZWxfYWRkOgorCW1pcGlfZHNpX2RldmljZV91bnJl
Z2lzdGVyKGRzaSk7CisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCB2aXNpb25veF9ybTY5
Mjk5X3JlbW92ZShzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kpCit7CisJc3RydWN0IHZpc2lv
bm94X3JtNjkyOTkgKmN0eCA9IG1pcGlfZHNpX2dldF9kcnZkYXRhKGRzaSk7CisKKwlpZiAoY3R4
LT5kc2kpIHsKKwkJbWlwaV9kc2lfZGV0YWNoKGN0eC0+ZHNpKTsKKwkJbWlwaV9kc2lfZGV2aWNl
X3VucmVnaXN0ZXIoY3R4LT5kc2kpOworCX0KKworCWRybV9wYW5lbF9yZW1vdmUoJmN0eC0+cGFu
ZWwpOworCXJldHVybiAwOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IG9mX2RldmljZV9pZCB2
aXNpb25veF9ybTY5Mjk5X29mX21hdGNoW10gPSB7CisJeworCQkuY29tcGF0aWJsZSA9ICJ2aXNp
b25veCxybTY5Mjk5LTEwODBwLWRpc3BsYXkiLAorCQkuZGF0YSA9ICZybTY5Mjk5X2RpciwKKwl9
LAorCXsgfQorfTsKK01PRFVMRV9ERVZJQ0VfVEFCTEUob2YsIHZpc2lvbm94X3JtNjkyOTlfb2Zf
bWF0Y2gpOworCitzdGF0aWMgc3RydWN0IG1pcGlfZHNpX2RyaXZlciB2aXNpb25veF9ybTY5Mjk5
X2RyaXZlciA9IHsKKwkuZHJpdmVyID0geworCQkubmFtZSA9ICJwYW5lbC12aXNpb25veC1ybTY5
Mjk5IiwKKwkJLm9mX21hdGNoX3RhYmxlID0gdmlzaW9ub3hfcm02OTI5OV9vZl9tYXRjaCwKKwl9
LAorCS5wcm9iZSA9IHZpc2lvbm94X3JtNjkyOTlfcHJvYmUsCisJLnJlbW92ZSA9IHZpc2lvbm94
X3JtNjkyOTlfcmVtb3ZlLAorfTsKK21vZHVsZV9taXBpX2RzaV9kcml2ZXIodmlzaW9ub3hfcm02
OTI5OV9kcml2ZXIpOworCitNT0RVTEVfREVTQ1JJUFRJT04oIlZJU0lPTk9YIFJNNjkyOTkgRFNJ
IFBhbmVsIERyaXZlciIpOworTU9EVUxFX0xJQ0VOU0UoIkdQTCB2MiIpOwotLSAKMS45LjEKCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBt
YWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3Rz
LmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
