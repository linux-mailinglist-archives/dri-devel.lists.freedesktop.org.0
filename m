Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id CE225160509
	for <lists+dri-devel@lfdr.de>; Sun, 16 Feb 2020 18:27:26 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 67A0A6E46C;
	Sun, 16 Feb 2020 17:27:06 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from asav22.altibox.net (asav22.altibox.net [109.247.116.9])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 06AD56E456
 for <dri-devel@lists.freedesktop.org>; Sun, 16 Feb 2020 17:27:00 +0000 (UTC)
Received: from localhost.localdomain (unknown [81.166.168.211])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-SHA256 (128/128 bits))
 (No client certificate requested)
 (Authenticated sender: noralf.tronnes@ebnett.no)
 by asav22.altibox.net (Postfix) with ESMTPSA id 25A9D200F1;
 Sun, 16 Feb 2020 18:21:41 +0100 (CET)
From: =?UTF-8?q?Noralf=20Tr=C3=B8nnes?= <noralf@tronnes.org>
To: broonie@kernel.org,
	balbi@kernel.org,
	lee.jones@linaro.org
Subject: [RFC 7/9] drm: Add Multifunction USB Device display driver
Date: Sun, 16 Feb 2020 18:21:15 +0100
Message-Id: <20200216172117.49832-8-noralf@tronnes.org>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20200216172117.49832-1-noralf@tronnes.org>
References: <20200216172117.49832-1-noralf@tronnes.org>
MIME-Version: 1.0
X-CMAE-Score: 0
X-CMAE-Analysis: v=2.3 cv=ZvHD1ezG c=1 sm=1 tr=0
 a=OYZzhG0JTxDrWp/F2OJbnw==:117 a=OYZzhG0JTxDrWp/F2OJbnw==:17
 a=jpOVt7BSZ2e4Z31A5e1TngXxSK0=:19 a=IkcTkHD0fZMA:10 a=M51BFTxLslgA:10
 a=SJz97ENfAAAA:8 a=9BuUX6pRhsC96qv7cPsA:9 a=7yrdoAaASxDrdOGF:21
 a=1pP-XCHQzciLwiWz:21 a=QEXdDO2ut3YA:10 a=vFet0B0WnEQeilDPIY6i:22
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: linux-usb@vger.kernel.org, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIE11bHRpZnVuY3Rpb24gVVNCIERldmljZSBoYXMgb3B0aW9uYWwgc3VwcG9ydCBmb3IgZGlz
cGxheXMuCkxaNCBjb21wcmVzc2lvbiBpcyB1c2VkIGlmIHRoZSBkZXZpY2Ugc3VwcG9ydHMgaXQu
CgpUaGUgZHJpdmVyIGlzIE1JVCBsaWNlbnNlZCBpbiB0aGUgaG9wZSB0aGF0IHBhcnRzIG9mIGl0
IGNhbiBiZSB1c2VkIG9uCnRoZSBCU0Qncy4KClNpZ25lZC1vZmYtYnk6IE5vcmFsZiBUcsO4bm5l
cyA8bm9yYWxmQHRyb25uZXMub3JnPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9LY29uZmlnICAgICAg
IHwgICAgMiArCiBkcml2ZXJzL2dwdS9kcm0vTWFrZWZpbGUgICAgICB8ICAgIDEgKwogZHJpdmVy
cy9ncHUvZHJtL211ZC9LY29uZmlnICAgfCAgIDE1ICsKIGRyaXZlcnMvZ3B1L2RybS9tdWQvTWFr
ZWZpbGUgIHwgICAgMyArCiBkcml2ZXJzL2dwdS9kcm0vbXVkL211ZF9kcm0uYyB8IDExOTggKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vbXVkL211ZF9k
cm0uaCB8ICAxMzcgKysrKwogNiBmaWxlcyBjaGFuZ2VkLCAxMzU2IGluc2VydGlvbnMoKykKIGNy
ZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbXVkL0tjb25maWcKIGNyZWF0ZSBtb2Rl
IDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbXVkL01ha2VmaWxlCiBjcmVhdGUgbW9kZSAxMDA2NDQg
ZHJpdmVycy9ncHUvZHJtL211ZC9tdWRfZHJtLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJz
L2dwdS9kcm0vbXVkL211ZF9kcm0uaAoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9LY29u
ZmlnIGIvZHJpdmVycy9ncHUvZHJtL0tjb25maWcKaW5kZXggYmZkYWRjMzY2N2UwLi44ZGRjMGQw
ZTgyY2MgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9LY29uZmlnCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9LY29uZmlnCkBAIC0zODcsNiArMzg3LDggQEAgc291cmNlICJkcml2ZXJzL2dwdS9k
cm0vYXNwZWVkL0tjb25maWciCiAKIHNvdXJjZSAiZHJpdmVycy9ncHUvZHJtL21jZGUvS2NvbmZp
ZyIKIAorc291cmNlICJkcml2ZXJzL2dwdS9kcm0vbXVkL0tjb25maWciCisKICMgS2VlcCBsZWdh
Y3kgZHJpdmVycyBsYXN0CiAKIG1lbnVjb25maWcgRFJNX0xFR0FDWQpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL01ha2VmaWxlCmluZGV4IDlm
MWM3YzQ4NmY4OC4uNWE1ZWFiNTk4ZDM5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vTWFr
ZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL01ha2VmaWxlCkBAIC0xMjIsMyArMTIyLDQgQEAg
b2JqLSQoQ09ORklHX0RSTV9MSU1BKSAgKz0gbGltYS8KIG9iai0kKENPTkZJR19EUk1fUEFORlJP
U1QpICs9IHBhbmZyb3N0Lwogb2JqLSQoQ09ORklHX0RSTV9BU1BFRURfR0ZYKSArPSBhc3BlZWQv
CiBvYmotJChDT05GSUdfRFJNX01DREUpICs9IG1jZGUvCitvYmoteQkJCSs9IG11ZC8KZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9tdWQvS2NvbmZpZyBiL2RyaXZlcnMvZ3B1L2RybS9tdWQv
S2NvbmZpZwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjQ0MGU5OTRj
YTBhMgotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9tdWQvS2NvbmZpZwpAQCAt
MCwwICsxLDE1IEBACisjIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9yLWxhdGVy
CisKK2NvbmZpZyBEUk1fTVVECisJdHJpc3RhdGUgIk11bHRpZnVuY3Rpb24gVVNCIERldmljZSBE
aXNwbGF5IgorCWRlcGVuZHMgb24gRFJNICYmIFVTQiAmJiBNRkRfTVVECisJc2VsZWN0IExaNF9D
T01QUkVTUworCXNlbGVjdCBEUk1fS01TX0hFTFBFUgorCisJc2VsZWN0IERSTV9HRU1fQ01BX0hF
TFBFUgorCXNlbGVjdCBEUk1fR0VNX1NITUVNX0hFTFBFUgorCisJc2VsZWN0IEJBQ0tMSUdIVF9D
TEFTU19ERVZJQ0UKKwloZWxwCisJIFRoaXMgaXMgYSBLTVMgZHJpdmVyIGZvciBNdWx0aWZ1bmN0
aW9uIFVTQiBEZXZpY2UgZGlzcGxheXMgb3IgZGlzcGxheQorCSBhZGFwdGVycy4KZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9tdWQvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vbXVkL01h
a2VmaWxlCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uZDU5NDFkMzNi
Y2Q5Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL211ZC9NYWtlZmlsZQpAQCAt
MCwwICsxLDMgQEAKKyMgU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb3ItbGF0ZXIK
Kworb2JqLSQoQ09ORklHX0RSTV9NVUQpCQkJKz0gbXVkX2RybS5vCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vbXVkL211ZF9kcm0uYyBiL2RyaXZlcnMvZ3B1L2RybS9tdWQvbXVkX2RybS5j
Cm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uNTFiYTc1Njk0MGZkCi0t
LSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL211ZC9tdWRfZHJtLmMKQEAgLTAsMCAr
MSwxMTk4IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCisvKgorICogQ29weXJp
Z2h0IDIwMjAgTm9yYWxmIFRyw7hubmVzCisgKi8KKworI2luY2x1ZGUgPGxpbnV4L2RtYS1idWYu
aD4KKyNpbmNsdWRlIDxsaW51eC9tZmQvbXVkLmg+CisjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+
CisjaW5jbHVkZSA8bGludXgvcGxhdGZvcm1fZGV2aWNlLmg+CisjaW5jbHVkZSA8bGludXgvcmVn
bWFwLmg+CisjaW5jbHVkZSA8bGludXgvdXNiLmg+CisjaW5jbHVkZSA8bGludXgvd2FpdC5oPgor
I2luY2x1ZGUgPGxpbnV4L3dvcmtxdWV1ZS5oPgorCisjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWMu
aD4KKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pY19oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJt
X2F0b21pY19zdGF0ZV9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2Nvbm5lY3Rvci5oPgor
I2luY2x1ZGUgPGRybS9kcm1fZGFtYWdlX2hlbHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fZHJ2
Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV9lbmNvZGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9mYl9o
ZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2ZpbGUuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2Zv
cm1hdF9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2ZvdXJjYy5oPgorI2luY2x1ZGUgPGRy
bS9kcm1fZnJhbWVidWZmZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2dlbV9jbWFfaGVscGVyLmg+
CisvLyNpbmNsdWRlIDxkcm0vZHJtX2dlbV9zaG1lbV9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0v
ZHJtX2dlbV9mcmFtZWJ1ZmZlcl9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3Byb2JlX2hl
bHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fcmVjdC5oPgorI2luY2x1ZGUgPGRybS9kcm1fc2lt
cGxlX2ttc19oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3ZibGFuay5oPgorCisjaW5jbHVk
ZSAibXVkX2RybS5oIgorCisvKgorICogZnJlZXJ1bjogVXNlcnNwYWNlIGlzIHRvbGQgdGhhdCB0
aGUgZmx1c2ggaGFwcGVuZGVkIGltbWVkaWF0ZWx5LCBiZWZvcmUgdGhlIHdvcmtlciBoYXMgYmVn
dW4uCisgKiAgICAgICAgICBVc2VmdWwgaWYgdGhlIHJlbmRlcmluZyBsb29wIGhhbmRsZXMgc2V2
ZXJhbCBkaXNwbGF5cyBvbmUgYWZ0ZXIgdGhlIG90aGVyLgorICogc3RlYWR5OiAgTm90aWZ5IHVz
ZXJzcGFjZSBhdCBhIGZpeGVkIGludGVydmFsIChGUFMpLgorICogaW5saW5lOiAgRG8gZmx1c2hp
bmcgYmVmb3JlIHJldHVybmluZyB0byB1c2Vyc3BhY2UgZnJvbSB0aGUgdXBkYXRlIGZ1bmN0aW9u
LgorICoKKyAqIFJhdGlvbmFsZToKKyAqIEluIGEgd29yc3QgY2FzZSBzY2VuYXJpbyBhIGZ1bGwg
YnVmZmVyIHVwZGF0ZSBjYW4gdGFrZSAxIHNlY29uZC4KKyAqCisgKiBJIGJlbGlldmUgV2F5bGFu
ZC9XZXN0b24gaGFzIG9uZSByZW5kZXJpbmcgbG9vcCBwZXIgZGlzcGxheS9kZXZpY2UgYW5kIGlm
IHNvIGRvZXNuJ3QgbmVlZCBhbnkgc3BlY2lhbCB0cmVhdG1lbnQuCisgKiBGb3IgWG9yZyBJIGdv
dCB0aGUgaW1wcmVzc2lvbiB0aGF0IGl0IHJ1bnMgZXZlcnl0aGluZyBpbiBvbmUgbG9vcCBhbmQg
b25lIHNsb3cgZGV2aWNlIHdpbGwgc2xvdyBldmVyeXRoaW5nIGRvd24uCisgKiBGb3IgZ2FtZXMg
b24gZW1iZWRkZWQgSSBiZWxpZXZlIG1heWJlIGEgZml4ZWQgcmF0ZSBpcyBiZXN0LgorICoKKyAq
IEknZCBhcHByZWNpYXRlIGFueSBpbnNpZ2h0IGludG8gaG93IHVzZXJzcGFjZSBvcGVyYXRlcyBp
biB0aGlzIHJlZ2FyZC4KKyAqLworc3RhdGljIGludCBwYWdlZmxpcDsKK21vZHVsZV9wYXJhbShw
YWdlZmxpcCwgaW50LCAwNjQ0KTsKK01PRFVMRV9QQVJNX0RFU0MocGFnZWZsaXAsICJwYWdlZmxp
cCBzdHJhdGVneTogMD1mcmVlcnVuLCAxPXN0ZWFkeSwgMj1pbmxpbmUgW2RlZmF1bHQ9MF0iKTsK
KworI2RlZmluZSBNVURfRFJNX1BBR0VGTElQX0ZSRUVSVU4gICAgMAorI2RlZmluZSBNVURfRFJN
X1BBR0VGTElQX1NURUFEWSAgICAgMQorI2RlZmluZSBNVURfRFJNX1BBR0VGTElQX0lOTElORSAg
ICAgMgorCitzdHJ1Y3QgbXVkX2RybV9kYW1hZ2UgeworCXN0cnVjdCBsaXN0X2hlYWQgbGlzdDsK
KwlzdHJ1Y3QgZHJtX3JlY3QgcmVjdDsKKwlrdGltZV90IHRpbWU7Cit9OworCitzdHJ1Y3QgbXVk
X2RybV9kZXZpY2UgeworCXN0cnVjdCBkcm1fZGV2aWNlIGRybTsKKwlzdHJ1Y3QgZHJtX3NpbXBs
ZV9kaXNwbGF5X3BpcGUgcGlwZTsKKwlzdHJ1Y3QgdXNiX2RldmljZSAqdXNiOworCXN0cnVjdCBy
ZWdtYXAgKnJlZ21hcDsKKworCXZvaWQgKmJ1ZjsKKwlzaXplX3QgYnVmX2xlbjsKKworCXN0cnVj
dCBtdXRleCBsb2NrOworCisJYm9vbCBydW47CisJc3RydWN0IHdvcmtxdWV1ZV9zdHJ1Y3QJKndv
cmtxOworCXN0cnVjdCB3b3JrX3N0cnVjdCB3b3JrOworCXdhaXRfcXVldWVfaGVhZF90IHdhaXRx
OworCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiOworCXN0cnVjdCBsaXN0X2hlYWQgZGFtYWdl
bGlzdDsKKwl1bnNpZ25lZCBpbnQgYXZlcmFnZV9wYWdlZmxpcF9tczsKK307CisKK3N0YXRpYyBp
bmxpbmUgc3RydWN0IG11ZF9kcm1fZGV2aWNlICp0b19tdWRfZHJtX2RldmljZShzdHJ1Y3QgZHJt
X2RldmljZSAqZHJtKQoreworCXJldHVybiBjb250YWluZXJfb2YoZHJtLCBzdHJ1Y3QgbXVkX2Ry
bV9kZXZpY2UsIGRybSk7Cit9CisKKy8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCisvKiBUT0RPOiBN
b3ZlIHRvIGRybV9lbmNvZGVyLmMgKi8KKworc3RhdGljIHZvaWQgZHJtX2VuY29kZXJfZHVtbXlf
Y2xlYW51cChzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIpCit7CisJZHJtX2VuY29kZXJfY2xl
YW51cChlbmNvZGVyKTsKKwlrZnJlZShlbmNvZGVyKTsKK30KKworc3RhdGljIGNvbnN0IHN0cnVj
dCBkcm1fZW5jb2Rlcl9mdW5jcyBkcm1fZW5jb2Rlcl9kdW1teV9mdW5jcyA9IHsKKwkuZGVzdHJv
eSA9IGRybV9lbmNvZGVyX2R1bW15X2NsZWFudXAsCit9OworCitzdGF0aWMgc3RydWN0IGRybV9l
bmNvZGVyICpkcm1fZW5jb2Rlcl9jcmVhdGVfZHVtbXkoc3RydWN0IGRybV9kZXZpY2UgKmRldiwg
aW50IGVuY29kZXJfdHlwZSkKK3sKKwlzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXI7CisJaW50
IHJldDsKKworCWVuY29kZXIgPSBremFsbG9jKHNpemVvZigqZW5jb2RlciksIEdGUF9LRVJORUwp
OworCWlmICghZW5jb2RlcikKKwkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7CisKKwlyZXQgPSBk
cm1fZW5jb2Rlcl9pbml0KGRldiwgZW5jb2RlciwgJmRybV9lbmNvZGVyX2R1bW15X2Z1bmNzLAor
CQkJICAgICAgIGVuY29kZXJfdHlwZSwgTlVMTCk7CisJaWYgKHJldCkgeworCQlrZnJlZShlbmNv
ZGVyKTsKKwkJcmV0dXJuIEVSUl9QVFIocmV0KTsKKwl9CisKKwlyZXR1cm4gZW5jb2RlcjsKK30K
KworLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KKy8qIFRPRE86IE1vdmUgdG8gZHJtX3NpbXBsZV9r
bXNfaGVscGVyLmMgKi8KKworc3RhdGljIHZvaWQgZHJtX3NpbXBsZV9jb25uZWN0b3JfY2xlYW51
cChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQoreworCWRybV9jb25uZWN0b3JfY2xl
YW51cChjb25uZWN0b3IpOworCWtmcmVlKGNvbm5lY3Rvcik7Cit9CisKK3N0YXRpYyBjb25zdCBz
dHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9mdW5jcyBkcm1fc2ltcGxlX2Nvbm5lY3Rvcl9mdW5jcyA9IHsK
KwkuZmlsbF9tb2RlcyA9IGRybV9oZWxwZXJfcHJvYmVfc2luZ2xlX2Nvbm5lY3Rvcl9tb2RlcywK
KwkuZGVzdHJveSA9IGRybV9zaW1wbGVfY29ubmVjdG9yX2NsZWFudXAsCisJLnJlc2V0ID0gZHJt
X2F0b21pY19oZWxwZXJfY29ubmVjdG9yX3Jlc2V0LAorCS5hdG9taWNfZHVwbGljYXRlX3N0YXRl
ID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2R1cGxpY2F0ZV9zdGF0ZSwKKwkuYXRvbWlj
X2Rlc3Ryb3lfc3RhdGUgPSBkcm1fYXRvbWljX2hlbHBlcl9jb25uZWN0b3JfZGVzdHJveV9zdGF0
ZSwKK307CisKK3N0YXRpYyBzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqCitkcm1fc2ltcGxlX2Nvbm5l
Y3Rvcl9jcmVhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgY29uc3Qgc3RydWN0IGRybV9jb25u
ZWN0b3JfaGVscGVyX2Z1bmNzICpmdW5jcywgaW50IGNvbm5lY3Rvcl90eXBlKQoreworCXN0cnVj
dCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3I7CisJaW50IHJldDsKKworCWNvbm5lY3RvciA9IGt6
YWxsb2Moc2l6ZW9mKCpjb25uZWN0b3IpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWNvbm5lY3RvcikK
KwkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7CisKKwlkcm1fY29ubmVjdG9yX2hlbHBlcl9hZGQo
Y29ubmVjdG9yLCBmdW5jcyk7CisJcmV0ID0gZHJtX2Nvbm5lY3Rvcl9pbml0KGRldiwgY29ubmVj
dG9yLCAmZHJtX3NpbXBsZV9jb25uZWN0b3JfZnVuY3MsIGNvbm5lY3Rvcl90eXBlKTsKKwlpZiAo
cmV0KSB7CisJCWtmcmVlKGNvbm5lY3Rvcik7CisJCXJldHVybiBFUlJfUFRSKHJldCk7CisJfQor
CisJcmV0dXJuIGNvbm5lY3RvcjsKK30KKworLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KKworc3Rh
dGljIGludCBtdWRfZHJtX3JlYWQoc3RydWN0IG11ZF9kcm1fZGV2aWNlICptZHJtLCB1bnNpZ25l
ZCBpbnQgcmVnbnIsCisJCQl1MzIgKnZhbHMsIHNpemVfdCB2YWxfY291bnQpCit7CisJc2l6ZV90
IHZhbF9sZW4gPSB2YWxfY291bnQgKiBzaXplb2YodTMyKTsKKwl1MzIgKnZhbF9idWY7CisJaW50
IHJldDsKKworCXZhbF9idWYgPSBrbWFsbG9jKHZhbF9sZW4sIEdGUF9LRVJORUwpOworCWlmICgh
dmFsX2J1ZikKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlyZXQgPSByZWdtYXBfYnVsa19yZWFkKG1k
cm0tPnJlZ21hcCwgcmVnbnIsIHZhbF9idWYsIHZhbF9jb3VudCk7CisJaWYgKCFyZXQpCisJCW1l
bWNweSh2YWxzLCB2YWxfYnVmLCB2YWxfbGVuKTsKKwlrZnJlZSh2YWxfYnVmKTsKKworCXJldHVy
biByZXQ7Cit9CisKK3N0YXRpYyBpbnQgbXVkX2RybV93cml0ZShzdHJ1Y3QgbXVkX2RybV9kZXZp
Y2UgKm1kcm0sIHVuc2lnbmVkIGludCByZWduciwKKwkJCSBjb25zdCB1MzIgKnZhbHMsIHNpemVf
dCB2YWxfY291bnQpCit7CisJY29uc3QgdTMyICp2YWxfYnVmOworCWludCByZXQ7CisKKwlpZiAo
dmFsX2NvdW50ID09IDEpCisJCXJldHVybiByZWdtYXBfd3JpdGUobWRybS0+cmVnbWFwLCByZWdu
ciwgKnZhbHMpOworCisJdmFsX2J1ZiA9IGttZW1kdXAodmFscywgdmFsX2NvdW50ICogc2l6ZW9m
KCp2YWxfYnVmKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCF2YWxfYnVmKQorCQlyZXR1cm4gLUVOT01F
TTsKKworCXJldCA9IHJlZ21hcF9idWxrX3dyaXRlKG1kcm0tPnJlZ21hcCwgcmVnbnIsIHZhbF9i
dWYsIHZhbF9jb3VudCk7CisJa2ZyZWUodmFsX2J1Zik7CisKKwlyZXR1cm4gcmV0OworfQorCitz
dGF0aWMgaW50IG11ZF9kcm1fY29ubmVjdG9yX2RldGVjdChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAq
Y29ubmVjdG9yLAorCQkJCSAgICBzdHJ1Y3QgZHJtX21vZGVzZXRfYWNxdWlyZV9jdHggKmN0eCwK
KwkJCQkgICAgYm9vbCBmb3JjZSkKK3sKKwlzdHJ1Y3QgbXVkX2RybV9kZXZpY2UgKm1kcm0gPSB0
b19tdWRfZHJtX2RldmljZShjb25uZWN0b3ItPmRldik7CisJdW5zaWduZWQgaW50IHN0YXR1cywg
cmVnbnI7CisJaW50IHJldDsKKworCXJlZ25yID0gTVVEX0RSTV9SRUdfQ09OTkVDVE9SX1NUQVRV
UyArIGNvbm5lY3Rvci0+aW5kZXg7CisJcmV0ID0gcmVnbWFwX3JlYWQobWRybS0+cmVnbWFwLCBy
ZWduciwgJnN0YXR1cyk7CisJcHJpbnRrKCIlczogaW5kZXg9JXUsIHN0YXR1cz0ldSwgcmV0PSVk
XG4iLCBfX2Z1bmNfXywgY29ubmVjdG9yLT5pbmRleCwgc3RhdHVzLCByZXQpOworCWlmIChyZXQg
fHwgc3RhdHVzID4gY29ubmVjdG9yX3N0YXR1c191bmtub3duKQorCQlzdGF0dXMgPSBjb25uZWN0
b3Jfc3RhdHVzX2Rpc2Nvbm5lY3RlZDsKKworCXJldHVybiBzdGF0dXM7Cit9CisKK3N0YXRpYyB2
b2lkICptdWRfZHJtX2Nvbm5lY3Rvcl9nZXRfZWRpZChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29u
bmVjdG9yKQoreworCXN0cnVjdCBtdWRfZHJtX2RldmljZSAqbWRybSA9IHRvX211ZF9kcm1fZGV2
aWNlKGNvbm5lY3Rvci0+ZGV2KTsKKwl1bnNpZ25lZCBpbnQgZWRpZF9sZW4sIHJlZ25yOworCXZv
aWQgKmVkaWQgPSBOVUxMOworCWludCByZXQ7CisKKwlyZWduciA9IE1VRF9EUk1fUkVHX0NPTk5F
Q1RPUl9FRElEX0xFTiArIGNvbm5lY3Rvci0+aW5kZXg7CisJcmV0ID0gcmVnbWFwX3JlYWQobWRy
bS0+cmVnbWFwLCByZWduciwgJmVkaWRfbGVuKTsKKwlwcmludGsoIiVzOiBpbmRleD0ldSwgZWRp
ZF9sZW49JXUsIHJldD0lZFxuIiwgX19mdW5jX18sCisJCWNvbm5lY3Rvci0+aW5kZXgsIGVkaWRf
bGVuLCByZXQpOworCWlmIChyZXQgfHwgIWVkaWRfbGVuKQorCQlyZXR1cm4gTlVMTDsKKworCWVk
aWQgPSBrbWFsbG9jKGVkaWRfbGVuLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWVkaWQpCisJCXJldHVy
biBOVUxMOworCisJcmVnbnIgPSBNVURfRFJNX1JFR19DT05ORUNUT1JfRURJRCArIChjb25uZWN0
b3ItPmluZGV4ICogTVVEX0RSTV9DT05ORUNUT1JfRURJRF9CTE9DS19NQVgpOworCXJldCA9IHJl
Z21hcF9yYXdfcmVhZChtZHJtLT5yZWdtYXAsIHJlZ25yLCBlZGlkLCBlZGlkX2xlbik7CisJaWYg
KHJldCkgeworCQlrZnJlZShlZGlkKTsKKwkJcmV0dXJuIE5VTEw7CisJfQorCisJcmV0dXJuIGVk
aWQ7Cit9CisKK3N0YXRpYyBpbnQgbXVkX2RybV9jb25uZWN0b3JfZ2V0X21vZGVzKHN0cnVjdCBk
cm1fY29ubmVjdG9yICpjb25uZWN0b3IpCit7CisJc3RydWN0IG11ZF9kcm1fZGV2aWNlICptZHJt
ID0gdG9fbXVkX2RybV9kZXZpY2UoY29ubmVjdG9yLT5kZXYpOworCXN0cnVjdCBtdWRfZHJtX2Rp
c3BsYXlfbW9kZSAqbW9kZXMgPSBOVUxMOworCXN0cnVjdCByZWdtYXAgKnJlZ21hcCA9IG1kcm0t
PnJlZ21hcDsKKwl1bnNpZ25lZCBpbnQgaSwgcmVnX251bV9tb2RlcywgcmVnbnI7CisJaW50IHJl
dCwgbnVtX21vZGVzID0gMDsKKwl2b2lkICplZGlkID0gTlVMTDsKKworCXByaW50aygiJXM6IGlu
ZGV4PSV1XG4iLCBfX2Z1bmNfXywgY29ubmVjdG9yLT5pbmRleCk7CisKKwkvLyBGSVhNRTogZ2Fk
Z2V0IHNpZGUgaGFzOiBtY29ubi0+Y2FwYWJpbGl0aWVzIHw9IE1VRF9EUk1fQ09OTkVDVE9SX0NB
UF9FRElEOworCWlmIChjb25uZWN0b3ItPmNvbm5lY3Rvcl90eXBlICE9IERSTV9NT0RFX0NPTk5F
Q1RPUl9WSVJUVUFMKSB7CisJCWVkaWQgPSBtdWRfZHJtX2Nvbm5lY3Rvcl9nZXRfZWRpZChjb25u
ZWN0b3IpOworCQlkcm1fY29ubmVjdG9yX3VwZGF0ZV9lZGlkX3Byb3BlcnR5KGNvbm5lY3Rvciwg
ZWRpZCk7CisJfQorCisJcmVnbnIgPSBNVURfRFJNX1JFR19DT05ORUNUT1JfTU9ERVNfQ09VTlQg
KyBjb25uZWN0b3ItPmluZGV4OworCXJldCA9IHJlZ21hcF9yZWFkKHJlZ21hcCwgcmVnbnIsICZy
ZWdfbnVtX21vZGVzKTsKKwlwcmludGsoIiAgICBudW1fbW9kZXM9JWQsIHJldD0lZFxuIiwgcmVn
X251bV9tb2RlcywgcmV0KTsKKwlpZiAocmV0KSB7CisJCWlmIChlZGlkKQorCQkJbnVtX21vZGVz
ID0gZHJtX2FkZF9lZGlkX21vZGVzKGNvbm5lY3RvciwgZWRpZCk7CisJfSBlbHNlIGlmIChyZWdf
bnVtX21vZGVzKSB7CisJCW1vZGVzID0ga21hbGxvY19hcnJheShyZWdfbnVtX21vZGVzLCBzaXpl
b2YoKm1vZGVzKSwgR0ZQX0tFUk5FTCk7CisJCWlmICghbW9kZXMpCisJCQlnb3RvIGZyZWU7CisK
KwkJcmVnbnIgPSBNVURfRFJNX1JFR19DT05ORUNUT1JfTU9ERVMgKyBjb25uZWN0b3ItPmluZGV4
OworCQlyZXQgPSByZWdtYXBfYnVsa19yZWFkKHJlZ21hcCwgcmVnbnIsIG1vZGVzLAorCQkJCSAg
ICAgICByZWdfbnVtX21vZGVzICogTVVEX0RSTV9ESVNQTEFZX01PREVfRklFTERTKTsKKwkJaWYg
KHJldCkKKwkJCWdvdG8gZnJlZTsKKworCQlmb3IgKGkgPSAwOyBpIDwgcmVnX251bV9tb2Rlczsg
aSsrKSB7CisJCQlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZTsKKworCQkJbW9kZSA9IGRy
bV9tb2RlX2NyZWF0ZShjb25uZWN0b3ItPmRldik7CisJCQlpZiAoIW1vZGUpCisJCQkJZ290byBm
cmVlOworCisJCQltdWRfZHJtX3RvX2Rpc3BsYXlfbW9kZShtb2RlLCAmbW9kZXNbaV0pOworCQkJ
ZHJtX21vZGVfcHJvYmVkX2FkZChjb25uZWN0b3IsIG1vZGUpOworCQkJcHJpbnRrKCIgICAgTW9k
ZWxpbmUgIiBEUk1fTU9ERV9GTVQgIlxuIiwgRFJNX01PREVfQVJHKG1vZGUpKTsKKwkJCW51bV9t
b2RlcysrOworCQl9CisJfQorZnJlZToKKwlrZnJlZShlZGlkKTsKKwlrZnJlZShtb2Rlcyk7CisK
KwkvKiBQcmV2ZW50IGRybV9oZWxwZXJfcHJvYmVfc2luZ2xlX2Nvbm5lY3Rvcl9tb2RlcygpIGZy
b20gYWRkaW5nIG1vZGVzICovCisJaWYgKCFudW1fbW9kZXMgJiYgY29ubmVjdG9yLT5zdGF0dXMg
PT0gY29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQpCisJCWNvbm5lY3Rvci0+c3RhdHVzID0gY29u
bmVjdG9yX3N0YXR1c191bmtub3duOworCisJcmV0dXJuIG51bV9tb2RlczsKK30KKworc3RhdGlj
IGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX2hlbHBlcl9mdW5jcyBtdWRfZHJtX2Nvbm5lY3Rv
cl9mdW5jcyA9IHsKKwkuZGV0ZWN0X2N0eCA9IG11ZF9kcm1fY29ubmVjdG9yX2RldGVjdCwKKwku
Z2V0X21vZGVzID0gbXVkX2RybV9jb25uZWN0b3JfZ2V0X21vZGVzLAorfTsKKworc3RhdGljIGlu
dCBtdWRfZHJtX2NyZWF0ZV90dl9wcm9wZXJ0aWVzKHN0cnVjdCBtdWRfZHJtX2RldmljZSAqbWRy
bSwgc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKK3sKKwl1bnNpZ25lZCBpbnQgaSwg
bnVtX21vZGVzLCBkZWZ2YWw7CisJY29uc3QgY2hhciAqKm1vZGVzOworCXNpemVfdCBidWZfbGVu
OworCWNoYXIgKmJ1ZjsKKwlpbnQgcmV0OworCisJcmV0ID0gcmVnbWFwX3JlYWQobWRybS0+cmVn
bWFwLCBNVURfRFJNX1JFR19UVl9NT0RFU19DT1VOVCwgJm51bV9tb2Rlcyk7CisJcHJpbnRrKCIg
ICAgTVVEX0RSTV9SRUdfVFZfTU9ERVNfQ09VTlQ9JXUsIHJldD0lZFxuIiwgbnVtX21vZGVzLCBy
ZXQpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisJaWYgKCFudW1fbW9kZXMpCisJCXJldHVy
biAtRUlOVkFMOworCisJYnVmX2xlbiA9IG51bV9tb2RlcyAqIERSTV9QUk9QX05BTUVfTEVOOwor
CW1vZGVzID0ga21hbGxvY19hcnJheShudW1fbW9kZXMsIHNpemVvZigqbW9kZXMpLCBHRlBfS0VS
TkVMKTsKKwlidWYgPSBrbWFsbG9jKGJ1Zl9sZW4sIEdGUF9LRVJORUwpOworCWlmICghbW9kZXMg
fHwgIWJ1ZikgeworCQlyZXQgPSAtRU5PTUVNOworCQlnb3RvIGZyZWU7CisJfQorCisJcmV0ID0g
cmVnbWFwX3Jhd19yZWFkKG1kcm0tPnJlZ21hcCwgTVVEX0RSTV9SRUdfVFZfTU9ERVMsIGJ1Ziwg
YnVmX2xlbik7CisJaWYgKHJldCkKKwkJZ290byBmcmVlOworCisJZm9yIChpID0gMDsgaSA8IG51
bV9tb2RlczsgaSsrKSB7CisJCW1vZGVzW2ldID0gJmJ1ZltpICogRFJNX1BST1BfTkFNRV9MRU5d
OworCQlwcmludGsoIiAgICBuYW1lc1sldV09JXNcbiIsIGksIG1vZGVzW2ldKTsKKwl9CisKKwly
ZXQgPSByZWdtYXBfcmVhZChtZHJtLT5yZWdtYXAsIE1VRF9EUk1fUkVHX0NPTk5FQ1RPUl9UVl9N
T0RFICsgY29ubmVjdG9yLT5pbmRleCwgJmRlZnZhbCk7CisJcHJpbnRrKCIgICAgTVVEX0RSTV9S
RUdfQ09OTkVDVE9SX1RWX01PREU6ICV1XG4iLCBkZWZ2YWwpOworCisJcmV0ID0gZHJtX21vZGVf
Y3JlYXRlX3R2X3Byb3BlcnRpZXMoY29ubmVjdG9yLT5kZXYsIG51bV9tb2RlcywgbW9kZXMpOwor
CWlmIChyZXQpCisJCWdvdG8gZnJlZTsKKworCWRybV9vYmplY3RfYXR0YWNoX3Byb3BlcnR5KCZj
b25uZWN0b3ItPmJhc2UsCisJCQkJICAgY29ubmVjdG9yLT5kZXYtPm1vZGVfY29uZmlnLnR2X21v
ZGVfcHJvcGVydHksCisJCQkJICAgZGVmdmFsKTsKK2ZyZWU6CisJa2ZyZWUobW9kZXMpOworCWtm
cmVlKGJ1Zik7CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IG11ZF9kcm1fY29ubmVj
dG9yX2NyZWF0ZShzdHJ1Y3QgbXVkX2RybV9kZXZpY2UgKm1kcm0sIGludCBjb25uZWN0b3JfdHlw
ZSkKK3sKKwlzdHJ1Y3QgZHJtX2RldmljZSAqZHJtID0gJm1kcm0tPmRybTsKKwlzdHJ1Y3QgZHJt
X2Nvbm5lY3RvciAqY29ubmVjdG9yOworCXN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcjsKKwl1
bnNpZ25lZCBpbnQgdmFsOworCWludCByZXQ7CisKKwljb25uZWN0b3IgPSBkcm1fc2ltcGxlX2Nv
bm5lY3Rvcl9jcmVhdGUoZHJtLCAmbXVkX2RybV9jb25uZWN0b3JfZnVuY3MsIGNvbm5lY3Rvcl90
eXBlKTsKKwlpZiAoSVNfRVJSKGNvbm5lY3RvcikpCisJCXJldHVybiBQVFJfRVJSKGNvbm5lY3Rv
cik7CisKKwljb25uZWN0b3ItPnBvbGxlZCA9IChEUk1fQ09OTkVDVE9SX1BPTExfQ09OTkVDVCB8
IERSTV9DT05ORUNUT1JfUE9MTF9ESVNDT05ORUNUKTsKKworCXByaW50aygiJXM6IGluZGV4PSV1
XG4iLCBfX2Z1bmNfXywgY29ubmVjdG9yLT5pbmRleCk7CisKKwlyZXQgPSByZWdtYXBfcmVhZCht
ZHJtLT5yZWdtYXAsIE1VRF9EUk1fUkVHX0NPTk5FQ1RPUl9DQVBTICsgY29ubmVjdG9yLT5pbmRl
eCwgJnZhbCk7CisJcHJpbnRrKCIgICAgTVVEX0RSTV9SRUdfQ09OTkVDVE9SX0NBUFM6ICV4XG4i
LCB2YWwpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwlpZiAoISh2YWwgJiAoTVVEX0RS
TV9DT05ORUNUT1JfQ0FQX01PREUgfCBNVURfRFJNX0NPTk5FQ1RPUl9DQVBfRURJRCkpKSB7CisJ
CXByaW50aygiXG5cbk5FRUQgTU9ERSBvciBFRElEXG4iKTsKKwl9CisKKwlpZiAodmFsICYgTVVE
X0RSTV9DT05ORUNUT1JfQ0FQX1RWKSB7CisJCXJldCA9IG11ZF9kcm1fY3JlYXRlX3R2X3Byb3Bl
cnRpZXMobWRybSwgY29ubmVjdG9yKTsKKwkJaWYgKHJldCkKKwkJCXByaW50aygiRkFJTEVEIHRv
IGNyZWF0ZSB0diBwcm9wcywgcmV0PSVkXG4iLCByZXQpOworCX0KKworCS8qIFRoZSBmaXJzdCBj
b25uZWN0b3IgaXMgYXR0YWNoZWQgdG8gdGhlIHNpbXBsZSBwaXBlIGVuY29kZXIgKi8KKwlpZiAo
IWNvbm5lY3Rvci0+aW5kZXgpIHsKKwkJZW5jb2RlciA9ICZtZHJtLT5waXBlLmVuY29kZXI7CisJ
fSBlbHNlIHsKKwkJZW5jb2RlciA9IGRybV9lbmNvZGVyX2NyZWF0ZV9kdW1teShkcm0sIERSTV9N
T0RFX0VOQ09ERVJfTk9ORSk7CisJCWlmIChJU19FUlIoZW5jb2RlcikpCisJCQlyZXR1cm4gUFRS
X0VSUihlbmNvZGVyKTsKKworCQllbmNvZGVyLT5wb3NzaWJsZV9jcnRjcyA9IDE7CisJfQorCisJ
cmV0dXJuIGRybV9jb25uZWN0b3JfYXR0YWNoX2VuY29kZXIoY29ubmVjdG9yLCBlbmNvZGVyKTsK
K30KKworc3RhdGljIGxvbmcgbXVkX2RybV90aHJvdWdocHV0KGt0aW1lX3QgZW5kLCBrdGltZV90
IGJlZ2luLCBzaXplX3QgbGVuKQoreworCWxvbmcgdGhyb3VnaHB1dDsKKworCXRocm91Z2hwdXQg
PSBrdGltZV91c19kZWx0YShlbmQsIGJlZ2luKTsKKwl0aHJvdWdocHV0ID0gdGhyb3VnaHB1dCA/
IChsZW4gKiAxMDAwKSAvIHRocm91Z2hwdXQgOiAwOworCXRocm91Z2hwdXQgPSB0aHJvdWdocHV0
ICogMTAwMCAvIDEwMjQ7CisKKwlyZXR1cm4gdGhyb3VnaHB1dDsKK30KKworc3RhdGljIGludCBt
dWRfZHJtX2ZiX2NvcHkoc3RydWN0IG11ZF9kcm1fZGV2aWNlICptZHJtLCBzdHJ1Y3QgZHJtX3Jl
Y3QgKnJlY3QsIHNpemVfdCAqbGVuKQoreworCXN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmlt
cG9ydF9hdHRhY2g7CisJc3RydWN0IG11ZF9kcm1fZGFtYWdlICpkYW1hZ2UgPSBOVUxMOworCXN0
cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiOworCWt0aW1lX3Qgc3RhcnQgPSAwOworCWludCByZXQg
PSAwOworCXZvaWQgKnZtYXA7CisJa3RpbWVfdCB0MSwgdDI7CisKKwltdXRleF9sb2NrKCZtZHJt
LT5sb2NrKTsKKworCWlmIChwYWdlZmxpcCA9PSBNVURfRFJNX1BBR0VGTElQX1NURUFEWSkKKwkJ
c3RhcnQgPSBrdGltZV9nZXQoKTsKKworCWZiID0gbWRybS0+ZmI7CisJaWYgKCFmYikgeworCQly
ZXQgPSAtRU5PRU5UOworCQlnb3RvIHVubG9jazsKKwl9CisKKwlkYW1hZ2UgPSBsaXN0X2ZpcnN0
X2VudHJ5X29yX251bGwoJm1kcm0tPmRhbWFnZWxpc3QsIHN0cnVjdCBtdWRfZHJtX2RhbWFnZSwg
bGlzdCk7CisJaWYgKCFkYW1hZ2UpCisJCWdvdG8gcHV0X2ZiOworCisJbGlzdF9kZWwoJmRhbWFn
ZS0+bGlzdCk7CisKKwkqcmVjdCA9IGRhbWFnZS0+cmVjdDsKKworCXByaW50aygiRmx1c2hpbmcg
W0ZCOiVkXSAiIERSTV9SRUNUX0ZNVCAiIGR0PSVsbGQgbXNcbiIsIGZiLT5iYXNlLmlkLAorCQlE
Uk1fUkVDVF9BUkcocmVjdCksIGt0aW1lX21zX2RlbHRhKGt0aW1lX2dldCgpLCBkYW1hZ2UtPnRp
bWUpKTsKKworCSpsZW4gPSBkcm1fcmVjdF93aWR0aChyZWN0KSAqIGRybV9yZWN0X2hlaWdodChy
ZWN0KSAqIGZiLT5mb3JtYXQtPmNwcFswXTsKKworCS8qIFJlZ21hcCByZXN0cmljdGlvbiwgdGhl
IHJlZ2lzdGVyIHZhbHVlIGlzIDMyLWJpdCAqLworCWlmICgqbGVuICUgc2l6ZW9mKHUzMikpIHsK
KwkJaW50IGFkal94ID0gZHJtX3JlY3Rfd2lkdGgocmVjdCkgJSBzaXplb2YodTMyKTsKKwkJaW50
IGFkal95ID0gZHJtX3JlY3RfaGVpZ2h0KHJlY3QpICUgc2l6ZW9mKHUzMik7CisJCXN0cnVjdCBk
cm1fcmVjdCBhZGpfcmVjdCA9ICpyZWN0OworCisJCWlmIChhZGpfeCkgeworCQkJYWRqX3ggPSBz
aXplb2YodTMyKSAtIGFkal94OworCQkJaWYgKGFkal9yZWN0LngxIC0gYWRqX3ggPj0gMCkKKwkJ
CQlhZGpfcmVjdC54MSAtPSBhZGpfeDsKKwkJCWVsc2UgaWYgKGFkal9yZWN0LngyICsgYWRqX3gg
PD0gZmItPndpZHRoKQorCQkJCWFkal9yZWN0LngyICs9IGFkal94OworCQl9CisKKwkJaWYgKGFk
al95KSB7CisJCQlhZGpfeSA9IHNpemVvZih1MzIpIC0gYWRqX3k7CisJCQlpZiAoYWRqX3JlY3Qu
eTEgLSBhZGpfeSA+PSAwKQorCQkJCWFkal9yZWN0LnkxIC09IGFkal95OworCQkJZWxzZSBpZiAo
YWRqX3JlY3QueTIgKyBhZGpfeSA8PSBmYi0+aGVpZ2h0KQorCQkJCWFkal9yZWN0LnkyICs9IGFk
al95OworCQl9CisKKwkJaWYgKGRybV9yZWN0X3dpZHRoKCZhZGpfcmVjdCkgJSBzaXplb2YodTMy
KSB8fCBkcm1fcmVjdF9oZWlnaHQoJmFkal9yZWN0KSAlIHNpemVvZih1MzIpKQorCQkJZHJtX3Jl
Y3RfaW5pdChyZWN0LCAwLCAwLCBmYi0+d2lkdGgsIGZiLT5oZWlnaHQpOworCQllbHNlCisJCQkq
cmVjdCA9IGFkal9yZWN0OworCisJCSpsZW4gPSBkcm1fcmVjdF93aWR0aChyZWN0KSAqIGRybV9y
ZWN0X2hlaWdodChyZWN0KSAqIGZiLT5mb3JtYXQtPmNwcFswXTsKKwkJcHJpbnRrKCIgICAgQURK
VVNURUQgIiBEUk1fUkVDVF9GTVQgIlxuIiwgRFJNX1JFQ1RfQVJHKHJlY3QpKTsKKwl9CisKKwlp
ZiAoKmxlbiA+IG1kcm0tPmJ1Zl9sZW4pIHsKKwkJcmV0ID0gLUUyQklHOworCQlnb3RvIHB1dF9m
YjsKKwl9CisKKwl0MSA9IGt0aW1lX2dldCgpOworCS8vIEZJWE1FOiBLY29uZmlnOiBzZWxlY3Qg
RFJNX0tNU19DTUFfSEVMUEVSCisJdm1hcCA9IHRvX2RybV9nZW1fY21hX29iaihmYi0+b2JqWzBd
KS0+dmFkZHI7CisvLwl2bWFwID0gZHJtX2dlbV9zaG1lbV92bWFwKGZiLT5vYmpbMF0pOworCXQy
ID0ga3RpbWVfZ2V0KCk7CisJaWYgKElTX0VSUih2bWFwKSkgeworCQlyZXQgPSBQVFJfRVJSKHZt
YXApOworCQlnb3RvIHB1dF9mYjsKKwl9CisKKwlwcmludGsoIiAgdm1hcDogJWxsZCBtc1xuIiwg
a3RpbWVfbXNfZGVsdGEodDIsIHQxKSk7CisKKwlpbXBvcnRfYXR0YWNoID0gZmItPm9ialswXS0+
aW1wb3J0X2F0dGFjaDsKKworCWlmIChpbXBvcnRfYXR0YWNoKSB7CisJCXJldCA9IGRtYV9idWZf
YmVnaW5fY3B1X2FjY2VzcyhpbXBvcnRfYXR0YWNoLT5kbWFidWYsIERNQV9GUk9NX0RFVklDRSk7
CisJCWlmIChyZXQpCisJCQlnb3RvIHVubWFwOworCX0KKworCS8qCisJICogQWx3YXlzIGNvcHkg
c2luY2Ugd2UgY2FuJ3QgcGFzcyB0aGUgc2htZW0gYnVmZmVyIHN0cmFpZ2h0IGluIHNpbmNlIGl0
CisJICogcmVzdWx0cyBpbiBzbG9vdyB1bmNhY2hlZCByZWFkcyBpbiB0aGUgY29tcHJlc3Nvci4g
QU5EIHRoZXJlJ3Mgc3JjIGJ1ZiBzdHJpZGUgdG8gY29uc2lkZXIuLi4KKwkgKgorCSAqIFNwZWVk
IHVwIGNvcHkgaWYgdXBkYXRlIGlzIGZ1bGwgYW5kIHN0cmlkZSBtYXRjaGVzLgorCSAqLworCS8v
IEZJWE1FOiBCaWcgZW5kaWFuIGhvc3QKKwlpZiAoKmxlbiA9PSBmYi0+aGVpZ2h0ICogZmItPnBp
dGNoZXNbMF0pCisJCW1lbWNweShtZHJtLT5idWYsIHZtYXAsICpsZW4pOworCWVsc2UKKwkJZHJt
X2ZiX21lbWNweShtZHJtLT5idWYsIHZtYXAsIGZiLCByZWN0KTsKKworCWlmIChpbXBvcnRfYXR0
YWNoKQorCQlyZXQgPSBkbWFfYnVmX2VuZF9jcHVfYWNjZXNzKGltcG9ydF9hdHRhY2gtPmRtYWJ1
ZiwgRE1BX0ZST01fREVWSUNFKTsKK3VubWFwOgorLy8JZHJtX2dlbV9zaG1lbV92dW5tYXAoZmIt
Pm9ialswXSwgdm1hcCk7CisKKwlpZiAocGFnZWZsaXAgPT0gTVVEX0RSTV9QQUdFRkxJUF9TVEVB
RFkgJiYgIXJldCAmJgorCSAgICBkcm1fcmVjdF93aWR0aChyZWN0KSA9PSBmYi0+d2lkdGggJiYg
ZHJtX3JlY3RfaGVpZ2h0KHJlY3QpID09IGZiLT5oZWlnaHQpIHsKKwkJdW5zaWduZWQgaW50IGR1
cmF0aW9uID0ga3RpbWVfbXNfZGVsdGEoa3RpbWVfZ2V0KCksIHN0YXJ0KTsKKwkJdW5zaWduZWQg
aW50IG9sZCA9IG1kcm0tPmF2ZXJhZ2VfcGFnZWZsaXBfbXM7CisKKwkJaWYgKCFtZHJtLT5hdmVy
YWdlX3BhZ2VmbGlwX21zKQorCQkJbWRybS0+YXZlcmFnZV9wYWdlZmxpcF9tcyA9IGR1cmF0aW9u
OworCQllbHNlCisJCQltZHJtLT5hdmVyYWdlX3BhZ2VmbGlwX21zID0gKGR1cmF0aW9uICogMyAv
IDEwKSArIChtZHJtLT5hdmVyYWdlX3BhZ2VmbGlwX21zICogNyAvIDEwKTsKKwkJaWYgKG9sZCAh
PSBtZHJtLT5hdmVyYWdlX3BhZ2VmbGlwX21zKQorCQkJcHJpbnRrKCJhdmVyYWdlX3BhZ2VmbGlw
X21zPSV1ICgldSlcbiIsIG1kcm0tPmF2ZXJhZ2VfcGFnZWZsaXBfbXMsIG9sZCk7CisJfQorCitw
dXRfZmI6CisJaWYgKGxpc3RfZW1wdHkoJm1kcm0tPmRhbWFnZWxpc3QpKSB7CisJCWRybV9mcmFt
ZWJ1ZmZlcl9wdXQoZmIpOworCQltZHJtLT5mYiA9IE5VTEw7CisJfQordW5sb2NrOgorCW11dGV4
X3VubG9jaygmbWRybS0+bG9jayk7CisKKwlrZnJlZShkYW1hZ2UpOworCisJcmV0dXJuIHJldDsK
K30KKworc3RhdGljIGludCBtdWRfZHJtX3dyaXRlX3JlY3Qoc3RydWN0IG11ZF9kcm1fZGV2aWNl
ICptZHJtLCBzdHJ1Y3QgZHJtX3JlY3QgKnJlY3QpCit7CisJdTMyIGRyZWN0WzRdOworCisJZHJl
Y3RbMF0gPSByZWN0LT54MTsKKwlkcmVjdFsxXSA9IHJlY3QtPnkxOworCWRyZWN0WzJdID0gZHJt
X3JlY3Rfd2lkdGgocmVjdCk7CisJZHJlY3RbM10gPSBkcm1fcmVjdF9oZWlnaHQocmVjdCk7CisK
KwlyZXR1cm4gbXVkX2RybV93cml0ZShtZHJtLCBNVURfRFJNX1JFR19SRUNUX1gsIGRyZWN0LCA0
KTsKK30KKworc3RhdGljIHZvaWQgbXVkX2RybV9mYl9kaXJ0eShzdHJ1Y3QgbXVkX2RybV9kZXZp
Y2UgKm1kcm0pCit7CisJc3RydWN0IGRybV9yZWN0IHJlY3Q7CisJc2l6ZV90IGxlbiA9IDA7CisJ
aW50IHJldCwgaWR4OworCWJvb2wgZGVidWcgPSB0cnVlOworCWt0aW1lX3QgdDEsIHQyLCB0Mywg
dDQ7CisKKwlpZiAoIWRybV9kZXZfZW50ZXIoJm1kcm0tPmRybSwgJmlkeCkpCisJCXJldHVybjsK
KworCWlmIChkZWJ1ZykKKwkJdDEgPSBrdGltZV9nZXQoKTsKKworCXJldCA9IG11ZF9kcm1fZmJf
Y29weShtZHJtLCAmcmVjdCwgJmxlbik7CisJaWYgKHJldCkKKwkJZ290byBvdXRfZXhpdDsKKwor
CWlmIChkZWJ1ZykKKwkJdDIgPSBrdGltZV9nZXQoKTsKKworCXJldCA9IG11ZF9kcm1fd3JpdGVf
cmVjdChtZHJtLCAmcmVjdCk7CisJaWYgKHJldCkKKwkJZ290byBvdXRfZXhpdDsKKworCWlmIChk
ZWJ1ZykKKwkJdDMgPSBrdGltZV9nZXQoKTsKKworCXJldCA9IHJlZ21hcF9yYXdfd3JpdGUobWRy
bS0+cmVnbWFwLCBNVURfRFJNX1JFR19CVUZGRVIsIG1kcm0tPmJ1ZiwgbGVuKTsKKworCWlmIChk
ZWJ1ZykgeworCQl0NCA9IGt0aW1lX2dldCgpOworCisJCWlmIChsZW4gPj0gU1pfNjRLKQorCQkJ
cHJpbnRrKCIgICBTWl82NEs6ICVsbGQgbXMgbGVuPSV6dVxuIiwga3RpbWVfbXNfZGVsdGEodDQs
IHQzKSwgbGVuKTsKKworCQlwcmludGsoIiAgIG91dCwgcmV0PSVkOiB0b3RhbCAlbGQga0IvcyAo
JWxsZCBtcyksIG1lbWNweSAlbGQga0IvcyAoJWxsZCBtcyksIHRyYW5zZmVyICVsZCBrQi9zICgl
bGxkIG1zKVxuIiwKKwkJCXJldCwKKwkJCW11ZF9kcm1fdGhyb3VnaHB1dCh0NCwgdDEsIGxlbiks
CisJCQlrdGltZV9tc19kZWx0YSh0NCwgdDEpLAorCQkJbXVkX2RybV90aHJvdWdocHV0KHQyLCB0
MSwgbGVuKSwKKwkJCWt0aW1lX21zX2RlbHRhKHQyLCB0MSksCisJCQltdWRfZHJtX3Rocm91Z2hw
dXQodDQsIHQzLCBsZW4pLAorCQkJa3RpbWVfbXNfZGVsdGEodDQsIHQzKQorCQkJKTsKKwl9Citv
dXRfZXhpdDoKKwlkcm1fZGV2X2V4aXQoaWR4KTsKK30KKworc3RhdGljIHZvaWQgbXVkX2RybV93
b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKK3sKKwlzdHJ1Y3QgbXVkX2RybV9kZXZpY2Ug
Km1kcm0gPSBjb250YWluZXJfb2Yod29yaywgc3RydWN0IG11ZF9kcm1fZGV2aWNlLCB3b3JrKTsK
KworCXByaW50aygiJXM6IElOXG4iLCBfX2Z1bmNfXyk7CisKKwl3aGlsZSAobWRybS0+cnVuKSB7
CisJCW11ZF9kcm1fZmJfZGlydHkobWRybSk7CisKKwkJd2FpdF9ldmVudChtZHJtLT53YWl0cSwg
IW1kcm0tPnJ1biB8fCBtZHJtLT5mYik7CisKKwkJcHJpbnRrKCIlczogTE9PUDogbWRybS0+cnVu
PSV1LCBtZHJtLT5mYj0lcHhcbiIsIF9fZnVuY19fLCBtZHJtLT5ydW4sIG1kcm0tPmZiKTsKKwl9
CisJcHJpbnRrKCIlczogT1VUXG4iLCBfX2Z1bmNfXyk7Cit9CisKK3N0YXRpYyBib29sIGRybV9y
ZWN0X2luY2x1ZGUoc3RydWN0IGRybV9yZWN0ICpyMSwgY29uc3Qgc3RydWN0IGRybV9yZWN0ICpy
MikKK3sKKwlyZXR1cm4gcjEtPngxID49IHIyLT54MSAmJiByMS0+eDIgPD0gcjItPngyICYmIHIx
LT55MSA+PSByMi0+eTEgJiYgcjEtPnkyIDw9IHIyLT55MjsKK30KKworc3RhdGljIHZvaWQgbXVk
X2RybV9mYl9tYXJrX2RpcnR5KHN0cnVjdCBtdWRfZHJtX2RldmljZSAqbWRybSwKKwkJCQkgIHN0
cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9sZF9zdGF0ZSwKKwkJCQkgIHN0cnVjdCBkcm1fcGxhbmVf
c3RhdGUgKnN0YXRlKQoreworCXN0cnVjdCBkcm1fYXRvbWljX2hlbHBlcl9kYW1hZ2VfaXRlciBp
dGVyOworCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKm9sZF9mYiA9IE5VTEw7CisJc3RydWN0IG11
ZF9kcm1fZGFtYWdlICpkYW1hZ2U7CisJa3RpbWVfdCB0aW1lID0ga3RpbWVfZ2V0KCk7CisJc3Ry
dWN0IGRybV9yZWN0IHJlY3Q7CisJYm9vbCB3YWtldXAgPSBmYWxzZTsKKwlib29sIGRlYnVnID0g
dHJ1ZTsKKwl1bnNpZ25lZCBpbnQgbnVtID0gMDsKKworCW11dGV4X2xvY2soJm1kcm0tPmxvY2sp
OworCisJaWYgKGRlYnVnKSB7CisJCWlmICghbGlzdF9lbXB0eSgmbWRybS0+ZGFtYWdlbGlzdCkp
IHsKKwkJCXN0cnVjdCBsaXN0X2hlYWQgKnBvczsKKworCQkJbGlzdF9mb3JfZWFjaChwb3MsICZt
ZHJtLT5kYW1hZ2VsaXN0KQorCQkJCW51bSsrOworCQl9CisJfQorCisJd2FrZXVwID0gIW1kcm0t
PmZiOworCisJaWYgKG1kcm0tPmZiICE9IHN0YXRlLT5mYikgeworCQlvbGRfZmIgPSBtZHJtLT5m
YjsKKwkJZHJtX2ZyYW1lYnVmZmVyX2dldChzdGF0ZS0+ZmIpOworCQltZHJtLT5mYiA9IHN0YXRl
LT5mYjsKKwl9CisKKwlkcm1fYXRvbWljX2hlbHBlcl9kYW1hZ2VfaXRlcl9pbml0KCZpdGVyLCBv
bGRfc3RhdGUsIHN0YXRlKTsKKwlkcm1fYXRvbWljX2Zvcl9lYWNoX3BsYW5lX2RhbWFnZSgmaXRl
ciwgJnJlY3QpIHsKKwkJaWYgKCFsaXN0X2VtcHR5KCZtZHJtLT5kYW1hZ2VsaXN0KSkgeworCQkJ
c3RydWN0IG11ZF9kcm1fZGFtYWdlICp0bXA7CisJCQlib29sIGZvdW5kOworCisJCQkvKiBJcyB0
aGUgcmVjdGFuZ2xlIGFscmVhZHkgY292ZXJlZD8gKi8KKwkJCWZvdW5kID0gZmFsc2U7CisJCQls
aXN0X2Zvcl9lYWNoX2VudHJ5KGRhbWFnZSwgJm1kcm0tPmRhbWFnZWxpc3QsIGxpc3QpIHsKKwkJ
CQlpZiAoZHJtX3JlY3RfaW5jbHVkZSgmcmVjdCwgJmRhbWFnZS0+cmVjdCkpIHsKKwkJCQkJZm91
bmQgPSB0cnVlOworCQkJCQlicmVhazsKKwkJCQl9CisJCQl9CisJCQlpZiAoZm91bmQpCisJCQkJ
Y29udGludWU7CisKKwkJCS8qIERvZXMgdGhlIHJlY3RhbmdsZSBjb3ZlciBleGlzdGluZyBvbmVz
PyAqLworCQkJZm91bmQgPSBmYWxzZTsKKwkJCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShkYW1h
Z2UsIHRtcCwgJm1kcm0tPmRhbWFnZWxpc3QsIGxpc3QpIHsKKwkJCQlpZiAoZHJtX3JlY3RfaW5j
bHVkZSgmZGFtYWdlLT5yZWN0LCAmcmVjdCkpIHsKKwkJCQkJaWYgKCFmb3VuZCkgeworCQkJCQkJ
ZGFtYWdlLT5yZWN0ID0gcmVjdDsKKwkJCQkJCWZvdW5kID0gdHJ1ZTsKKwkJCQkJfSBlbHNlIHsK
KwkJCQkJCWxpc3RfZGVsKCZkYW1hZ2UtPmxpc3QpOworCQkJCQkJa2ZyZWUoZGFtYWdlKTsKKwkJ
CQkJfQorCQkJCX0KKwkJCX0KKwkJCWlmIChmb3VuZCkKKwkJCQljb250aW51ZTsKKworCQkJLyog
SXMgdGhlIHJlY3RhbmdsZSBhZGphY2VudCB0byBhbiBleGlzdGluZyBvbmU/ICovCisJCQlmb3Vu
ZCA9IGZhbHNlOworCQkJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKGRhbWFnZSwgdG1wLCAmbWRy
bS0+ZGFtYWdlbGlzdCwgbGlzdCkgeworCQkJCXN0cnVjdCBkcm1fcmVjdCBib3ggPSB7CisJCQkJ
CS54MSA9IGRhbWFnZS0+cmVjdC54MSAtIGRybV9yZWN0X3dpZHRoKCZyZWN0KSwKKwkJCQkJLngy
ID0gZGFtYWdlLT5yZWN0LngyICsgZHJtX3JlY3Rfd2lkdGgoJnJlY3QpLAorCQkJCQkueTEgPSBk
YW1hZ2UtPnJlY3QueTEgLSBkcm1fcmVjdF9oZWlnaHQoJnJlY3QpLAorCQkJCQkueTIgPSBkYW1h
Z2UtPnJlY3QueTIgKyBkcm1fcmVjdF9oZWlnaHQoJnJlY3QpLAorCQkJCX07CisKKwkJCQlpZiAo
cmVjdC54MSA+PSBib3gueDEgJiYgcmVjdC54MiA8PSBib3gueDIgJiYKKwkJCQkgICAgcmVjdC55
MSA+PSBib3gueTEgJiYgcmVjdC55MiA8PSBib3gueTIpIHsKKwkJCQkJZGFtYWdlLT5yZWN0Lngx
ID0gbWluKGRhbWFnZS0+cmVjdC54MSwgcmVjdC54MSk7CisJCQkJCWRhbWFnZS0+cmVjdC54MiA9
IG1heChkYW1hZ2UtPnJlY3QueDIsIHJlY3QueDIpOworCQkJCQlkYW1hZ2UtPnJlY3QueTEgPSBt
aW4oZGFtYWdlLT5yZWN0LnkxLCByZWN0LnkxKTsKKwkJCQkJZGFtYWdlLT5yZWN0LnkyID0gbWF4
KGRhbWFnZS0+cmVjdC55MiwgcmVjdC55Mik7CisJCQkJCWZvdW5kID0gdHJ1ZTsKKwkJCQkJYnJl
YWs7CisJCQkJfQorCQkJfQorCQkJaWYgKGZvdW5kKQorCQkJCWNvbnRpbnVlOworCQl9CisKKwkJ
ZGFtYWdlID0ga3phbGxvYyhzaXplb2YoKmRhbWFnZSksIEdGUF9LRVJORUwpOworCQlpZiAoIWRh
bWFnZSkKKwkJCWJyZWFrOworCisJCWRhbWFnZS0+dGltZSA9IHRpbWU7CisJCWRhbWFnZS0+cmVj
dCA9IHJlY3Q7CisJCWxpc3RfYWRkX3RhaWwoJmRhbWFnZS0+bGlzdCwgJm1kcm0tPmRhbWFnZWxp
c3QpOworCX0KKworCXByaW50aygiJXM6IHdha2V1cD0ldSwgZmI9W0ZCOiVkXSwgb2xkX2ZiPVtG
QjolZF1cbiIsIF9fZnVuY19fLAorCQl3YWtldXAsIHN0YXRlLT5mYi0+YmFzZS5pZCwgb2xkX2Zi
ID8gb2xkX2ZiLT5iYXNlLmlkIDogLTEpOworCisJaWYgKGRlYnVnKSB7CisJCWlmICghbGlzdF9l
bXB0eSgmbWRybS0+ZGFtYWdlbGlzdCkpIHsKKwkJCXN0cnVjdCBsaXN0X2hlYWQgKnBvczsKKwkJ
CXVuc2lnbmVkIGludCBudW0yID0gMDsKKworCQkJbGlzdF9mb3JfZWFjaChwb3MsICZtZHJtLT5k
YW1hZ2VsaXN0KQorCQkJCW51bTIrKzsKKworCQkJaWYgKG51bSAhPSBudW0yKSB7CisJCQkJa3Rp
bWVfdCB0ID0ga3RpbWVfZ2V0KCk7CisKKwkJCQlwcmludGsoIiAgICBkYW1hZ2VsaXN0OiBudW09
JXUgbnVtMj0ldVxuIiwgbnVtLCBudW0yKTsKKwkJCQlsaXN0X2Zvcl9lYWNoX2VudHJ5KGRhbWFn
ZSwgJm1kcm0tPmRhbWFnZWxpc3QsIGxpc3QpCisJCQkJCXByaW50aygiICAgICAgICAiIERSTV9S
RUNUX0ZNVCAiIGR0PSVsbGQgbXNcbiIsCisJCQkJCQlEUk1fUkVDVF9BUkcoJmRhbWFnZS0+cmVj
dCksCisJCQkJCQlrdGltZV9tc19kZWx0YSh0LCBkYW1hZ2UtPnRpbWUpKTsKKwkJCX0KKwkJfSBl
bHNlIHsKKwkJCXByaW50aygiICAgIGRhbWFnZWxpc3QgaXMgZW1wdHk6IG51bT0ldVxuIiwgbnVt
KTsKKwkJfQorCX0KKworCW11dGV4X3VubG9jaygmbWRybS0+bG9jayk7CisKKwlpZiAocGFnZWZs
aXAgIT0gTVVEX0RSTV9QQUdFRkxJUF9JTkxJTkUgJiYgd2FrZXVwKQorCQl3YWtlX3VwKCZtZHJt
LT53YWl0cSk7CisKKwlpZiAob2xkX2ZiKQorCQlkcm1fZnJhbWVidWZmZXJfcHV0KG9sZF9mYik7
Cit9CisKK3N0YXRpYyBpbnQgbXVkX2RybV9waXBlX2NoZWNrKHN0cnVjdCBkcm1fc2ltcGxlX2Rp
c3BsYXlfcGlwZSAqcGlwZSwKKwkJCSAgICAgIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnBsYW5l
X3N0YXRlLAorCQkJICAgICAgc3RydWN0IGRybV9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQorewor
CXN0cnVjdCBtdWRfZHJtX2RldmljZSAqbWRybSA9IHRvX211ZF9kcm1fZGV2aWNlKHBpcGUtPmNy
dGMuZGV2KTsKKwlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpvbGRfZmIgPSBwaXBlLT5wbGFuZS5z
dGF0ZS0+ZmI7CisJc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBwbGFuZV9zdGF0ZS0+ZmI7
CisJYm9vbCBjaGVjayA9IGZhbHNlOworCWludCByZXQ7CisKKwlwcmludGsoIiVzOlxuIiwgX19m
dW5jX18pOworCisJLyogRklYTUU6IFNob3VsZCB3ZSBiZSBmbGV4aWJsZSBhbmQgbGV0IHRoZSBk
ZXZpY2UgZGVjaWRlIHRoaXM/ICovCisJLyogT25seSBvbmUgY29ubmVjdG9yIGlzIHN1cHBvcnRl
ZCAqLworCWlmIChod2VpZ2h0MzIoY3J0Y19zdGF0ZS0+Y29ubmVjdG9yX21hc2spID4gMSkKKwkJ
cmV0dXJuIC1FSU5WQUw7CisKKwlpZiAoZHJtX2F0b21pY19jcnRjX25lZWRzX21vZGVzZXQoY3J0
Y19zdGF0ZSkpIHsKKwkJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUgPSAmY3J0
Y19zdGF0ZS0+bW9kZTsKKwkJaW50IGNvbm5lY3Rvcl9pZHggPSBmZnMoY3J0Y19zdGF0ZS0+Y29u
bmVjdG9yX21hc2spIC0gMTsKKwkJc3RydWN0IG11ZF9kcm1fZGlzcGxheV9tb2RlIGRtb2RlOwor
CisJCXByaW50aygiICAgIG1vZGVfY2hhbmdlZD0ldSwgYWN0aXZlX2NoYW5nZWQ9JXUsIGNvbm5l
Y3RvcnNfY2hhbmdlZD0ldSIsCisJCQljcnRjX3N0YXRlLT5tb2RlX2NoYW5nZWQsIGNydGNfc3Rh
dGUtPmFjdGl2ZV9jaGFuZ2VkLAorCQkJY3J0Y19zdGF0ZS0+Y29ubmVjdG9yc19jaGFuZ2VkKTsK
KwkJcHJpbnRrKCIgICAgY29ubmVjdG9yX2lkeD0lZFxuIiwgY29ubmVjdG9yX2lkeCk7CisKKwkJ
aWYgKGNvbm5lY3Rvcl9pZHggPCAwKQorCQkJcmV0dXJuIC1FSU5WQUw7CisKKwkJLyogUmVnbWFw
IHJlc3RyaWN0aW9uICovCisJCWlmIChmYiAmJiAoZmItPndpZHRoICogZmItPmhlaWdodCAqIGZi
LT5mb3JtYXQtPmNwcFswXSkgJSBzaXplb2YodTMyKSkgeworCQkJRFJNX0RFVl9ERUJVR19LTVMo
ZmItPmRldi0+ZGV2LAorCQkJCSJbRkI6JWRdIFVuc3VwcG9ydGVkIHdpZHRoKCV1KS9oZWlnaHQo
JXUpL2Zvcm1hdCgweCV4KSBjb21ib1xuIiwKKwkJCQlmYi0+YmFzZS5pZCwgZmItPndpZHRoLCBm
Yi0+aGVpZ2h0LCBmYi0+Zm9ybWF0LT5mb3JtYXQpOworCQkJcmV0dXJuIC1FSU5WQUw7CisJCX0K
KworCQlyZXQgPSByZWdtYXBfd3JpdGUobWRybS0+cmVnbWFwLCBNVURfRFJNX1JFR19TRVRfQ09O
TkVDVE9SLCBjb25uZWN0b3JfaWR4KTsKKwkJaWYgKHJldCkgeworCQkJcHJpbnRrKCIgICAgTVVE
X0RSTV9SRUdfU0VUX0NPTk5FQ1RPUjogcmV0PSVkXG4iLCByZXQpOworCQkJcmV0dXJuIHJldDsK
KwkJfQorCisJCXByaW50aygiICAgIE1vZGVsaW5lICIgRFJNX01PREVfRk1UICJcbiIsIERSTV9N
T0RFX0FSRyhtb2RlKSk7CisKKwkJbXVkX2RybV9mcm9tX2Rpc3BsYXlfbW9kZSgmZG1vZGUsIG1v
ZGUpOworCQlyZXQgPSBtdWRfZHJtX3dyaXRlKG1kcm0sIE1VRF9EUk1fUkVHX1NFVF9NT0RFLCAo
dTMyICopJmRtb2RlLAorCQkJCSAgICBNVURfRFJNX0RJU1BMQVlfTU9ERV9GSUVMRFMpOworCQlp
ZiAocmV0KSB7CisJCQlwcmludGsoIiAgICBNVURfRFJNX1JFR19TRVRfTU9ERTogcmV0PSVkXG4i
LCByZXQpOworCQkJcmV0dXJuIHJldDsKKwkJfQorCisJCWNoZWNrID0gdHJ1ZTsKKwl9CisKKwlw
cmludGsoIiAgICBvbGRfZmI9W0ZCOiVkXSwgZmI9W0ZCOiVkXVxuIiwgb2xkX2ZiID8gb2xkX2Zi
LT5iYXNlLmlkIDogLTEsCisJCWZiID8gZmItPmJhc2UuaWQgOiAtMSk7CisKKwlpZiAoZmIpIHsK
KwkJaWYgKCFvbGRfZmIgfHwgb2xkX2ZiLT53aWR0aCAhPSBmYi0+d2lkdGggfHwgb2xkX2ZiLT5o
ZWlnaHQgIT0gZmItPmhlaWdodCB8fAorCQkgICAgb2xkX2ZiLT5mb3JtYXQtPmZvcm1hdCAhPSBm
Yi0+Zm9ybWF0LT5mb3JtYXQpIHsKKwkJCXByaW50aygiICAgIENSRUFURSBGQlxuIik7CisKKwkJ
CXJldCA9IHJlZ21hcF93cml0ZShtZHJtLT5yZWdtYXAsIE1VRF9EUk1fUkVHX1NFVF9GT1JNQVQs
IGZiLT5mb3JtYXQtPmZvcm1hdCk7CisJCQlpZiAocmV0KSB7CisJCQkJcHJpbnRrKCIgICAgTVVE
X0RSTV9SRUdfU0VUX0ZPUk1BVDogcmV0PSVkXG4iLCByZXQpOworCQkJCXJldHVybiByZXQ7CisJ
CQl9CisKKwkJCWNoZWNrID0gdHJ1ZTsKKwkJfQorCX0KKworCWlmIChjaGVjaykgeworCQlwcmlu
dGsoIiAgICBSVU4gQ0hFQ0tcbiIpOworCisJCXJldCA9IHJlZ21hcF93cml0ZShtZHJtLT5yZWdt
YXAsIE1VRF9EUk1fUkVHX1NFVF9DT01NSVQsIE1VRF9EUk1fQ09NTUlUX0NIRUNLKTsKKwkJaWYg
KHJldCkgeworCQkJcHJpbnRrKCIgICAgTVVEX0RSTV9SRUdfU0VUX0NPTU1JVCBDSEVDSzogcmV0
PSVkXG4iLCByZXQpOworCQkJcmV0dXJuIHJldDsKKwkJfQorCX0KKworCXJldHVybiAwOworfQor
CitzdGF0aWMgdm9pZCBtdWRfZHJtX3BpcGVfdXBkYXRlKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3Bs
YXlfcGlwZSAqcGlwZSwKKwkJCQlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpvbGRfc3RhdGUpCit7
CisJc3RydWN0IG11ZF9kcm1fZGV2aWNlICptZHJtID0gdG9fbXVkX2RybV9kZXZpY2UocGlwZS0+
Y3J0Yy5kZXYpOworCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnN0YXRlID0gcGlwZS0+cGxhbmUu
c3RhdGU7CisJc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBzdGF0ZS0+ZmI7CisJc3RydWN0
IGRybV9jcnRjICpjcnRjID0gJnBpcGUtPmNydGM7CisJa3RpbWVfdCBzdGFydCA9IDAsIGVuZCA9
IDA7CisJaW50IGlkeCwgcmV0ID0gMDsKKworCWlmIChmYikKKwkJcHJpbnRrKCIlczogW0ZCOiVk
XSBmbGlwPSVzIGV2ZW50PSVzXG4iLCBfX2Z1bmNfXywKKwkJCWZiLT5iYXNlLmlkLCBvbGRfc3Rh
dGUtPmZiICYmIGZiICE9IG9sZF9zdGF0ZS0+ZmIgPyAieWVzIiA6ICJubyIsCisJCQljcnRjLT5z
dGF0ZS0+ZXZlbnQgPyAieWVzIiA6ICJubyIpOworCWVsc2UKKwkJcHJpbnRrKCIlczogW05PRkJd
IGV2ZW50PSVzXG4iLCBfX2Z1bmNfXywgY3J0Yy0+c3RhdGUtPmV2ZW50ID8gInllcyIgOiAibm8i
KTsKKworCWlmICghZHJtX2Rldl9lbnRlcihjcnRjLT5kZXYsICZpZHgpKQorCQlnb3RvIHNlbmRf
ZXZlbnQ7CisKKwlpZiAoIW9sZF9zdGF0ZS0+ZmIpIHsKKwkJcHJpbnRrKCIgICAgRU5BQkxFIENS
VENcbiIpOworCQlyZXQgPSByZWdtYXBfd3JpdGUobWRybS0+cmVnbWFwLCBNVURfRFJNX1JFR19Q
SVBFX0VOQUJMRSwgMSk7CisJCWlmIChyZXQpCisJCQlwcmludGsoIiAgICBNVURfRFJNX1JFR19Q
SVBFX0VOQUJMRT0xOiByZXQ9JWRcbiIsIHJldCk7CisJfQorCisJaWYgKHBhZ2VmbGlwID09IE1V
RF9EUk1fUEFHRUZMSVBfU1RFQURZKQorCQlzdGFydCA9IGt0aW1lX2dldCgpOworCisJaWYgKGZi
KQorCQltdWRfZHJtX2ZiX21hcmtfZGlydHkobWRybSwgb2xkX3N0YXRlLCBzdGF0ZSk7CisKKwlp
ZiAocGFnZWZsaXAgPT0gTVVEX0RSTV9QQUdFRkxJUF9TVEVBRFkpCisJCWVuZCA9IGt0aW1lX2dl
dCgpOworCisJaWYgKHBhZ2VmbGlwID09IE1VRF9EUk1fUEFHRUZMSVBfSU5MSU5FKQorCQltdWRf
ZHJtX2ZiX2RpcnR5KG1kcm0pOworCisJaWYgKGZiICYmIGRybV9hdG9taWNfY3J0Y19uZWVkc19t
b2Rlc2V0KGNydGMtPnN0YXRlKSkgeworCQlyZXQgPSByZWdtYXBfd3JpdGUobWRybS0+cmVnbWFw
LCBNVURfRFJNX1JFR19TRVRfQ09NTUlULCBNVURfRFJNX0NPTU1JVF9BUFBMWSk7CisJCWlmIChy
ZXQpCisJCQlwcmludGsoIiAgICBNVURfRFJNX1JFR19TRVRfQ09NTUlUOiByZXQ9JWRcbiIsIHJl
dCk7CisJfQorCisJaWYgKCFmYikgeworCQlwcmludGsoIiAgICBESVNBQkxFIENSVENcbiIpOwor
CQlyZXQgPSByZWdtYXBfd3JpdGUobWRybS0+cmVnbWFwLCBNVURfRFJNX1JFR19QSVBFX0VOQUJM
RSwgMCk7CisJCWlmIChyZXQpCisJCQlwcmludGsoIiAgICBNVURfRFJNX1JFR19QSVBFX0VOQUJM
RT0wOiByZXQ9JWRcbiIsIHJldCk7CisJfQorCisJZHJtX2Rldl9leGl0KGlkeCk7CisKK3NlbmRf
ZXZlbnQ6CisJaWYgKGNydGMtPnN0YXRlLT5ldmVudCkgeworCQlpZiAocGFnZWZsaXAgPT0gTVVE
X0RSTV9QQUdFRkxJUF9TVEVBRFkpIHsKKwkJCXVuc2lnbmVkIGludCBkdXJhdGlvbiA9IGt0aW1l
X21zX2RlbHRhKGVuZCwgc3RhcnQpOworCisJCQlpZiAoZHVyYXRpb24gPCBtZHJtLT5hdmVyYWdl
X3BhZ2VmbGlwX21zKSB7CisJCQkJcHJpbnRrKCJwYWdlZmxpcCB3YWl0ICV1IG1zXG4iLCBtZHJt
LT5hdmVyYWdlX3BhZ2VmbGlwX21zIC0gZHVyYXRpb24pOworCQkJCW1zbGVlcChtZHJtLT5hdmVy
YWdlX3BhZ2VmbGlwX21zIC0gZHVyYXRpb24pOworCQkJfSBlbHNlIHsKKwkJCQlwcmludGsoInBh
Z2VmbGlwIG5vd2FpdCAtJXUgbXNcbiIsIGR1cmF0aW9uIC0gbWRybS0+YXZlcmFnZV9wYWdlZmxp
cF9tcyk7CisJCQl9CisJCX0KKworCQlzcGluX2xvY2tfaXJxKCZjcnRjLT5kZXYtPmV2ZW50X2xv
Y2spOworCQlkcm1fY3J0Y19zZW5kX3ZibGFua19ldmVudChjcnRjLCBjcnRjLT5zdGF0ZS0+ZXZl
bnQpOworCQljcnRjLT5zdGF0ZS0+ZXZlbnQgPSBOVUxMOworCQlzcGluX3VubG9ja19pcnEoJmNy
dGMtPmRldi0+ZXZlbnRfbG9jayk7CisJfQorCisJaWYgKHJldCkKKwkJcHJpbnRrKCIlczogRmFp
bGVkIHRvIFVQREFURTogJWRcbiIsIF9fZnVuY19fLCByZXQpOworfQorCitzdGF0aWMgdm9pZCBt
dWRfZHJtX3BpcGVfZW5hYmxlKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlwZSAqcGlwZSwK
KwkJCQlzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCisJCQkJc3RydWN0IGRybV9w
bGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCit7CisJc3RydWN0IG11ZF9kcm1fZGV2aWNlICptZHJt
ID0gdG9fbXVkX2RybV9kZXZpY2UocGlwZS0+Y3J0Yy5kZXYpOworCisJcHJpbnRrKCIlczpcbiIs
IF9fZnVuY19fKTsKKworCW11dGV4X2xvY2soJm1kcm0tPmxvY2spOworCW1kcm0tPnJ1biA9IHRy
dWU7CisJbXV0ZXhfdW5sb2NrKCZtZHJtLT5sb2NrKTsKKworCXF1ZXVlX3dvcmsobWRybS0+d29y
a3EsICZtZHJtLT53b3JrKTsKK30KKworc3RhdGljIHZvaWQgbXVkX2RybV9waXBlX2Rpc2FibGUo
c3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBlKQoreworCXN0cnVjdCBtdWRfZHJt
X2RldmljZSAqbWRybSA9IHRvX211ZF9kcm1fZGV2aWNlKHBpcGUtPmNydGMuZGV2KTsKKworCXBy
aW50aygiJXM6XG4iLCBfX2Z1bmNfXyk7CisKKwltdXRleF9sb2NrKCZtZHJtLT5sb2NrKTsKKwlt
ZHJtLT5ydW4gPSBmYWxzZTsKKwltdXRleF91bmxvY2soJm1kcm0tPmxvY2spOworCisJd2FrZV91
cCgmbWRybS0+d2FpdHEpOworCWNhbmNlbF93b3JrX3N5bmMoJm1kcm0tPndvcmspOworCisJbXV0
ZXhfbG9jaygmbWRybS0+bG9jayk7CisKKwlpZiAobWRybS0+ZmIpIHsKKwkJZHJtX2ZyYW1lYnVm
ZmVyX3B1dChtZHJtLT5mYik7CisJCW1kcm0tPmZiID0gTlVMTDsKKwl9CisKKwlpZiAoIWxpc3Rf
ZW1wdHkoJm1kcm0tPmRhbWFnZWxpc3QpKSB7CisJCXN0cnVjdCBtdWRfZHJtX2RhbWFnZSAqZGFt
YWdlLCAqdG1wOworCisJCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShkYW1hZ2UsIHRtcCwgJm1k
cm0tPmRhbWFnZWxpc3QsIGxpc3QpIHsKKwkJCWxpc3RfZGVsKCZkYW1hZ2UtPmxpc3QpOworCQkJ
a2ZyZWUoZGFtYWdlKTsKKwkJfQorCX0KKworCW11dGV4X3VubG9jaygmbWRybS0+bG9jayk7Cit9
CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGVfZnVuY3MgbXVk
X2RybV9waXBlX2Z1bmNzID0geworCS5jaGVjayAgICAgID0gbXVkX2RybV9waXBlX2NoZWNrLAor
CS51cGRhdGUJICAgID0gbXVkX2RybV9waXBlX3VwZGF0ZSwKKwkuZW5hYmxlCSAgICA9IG11ZF9k
cm1fcGlwZV9lbmFibGUsCisJLmRpc2FibGUgICAgPSBtdWRfZHJtX3BpcGVfZGlzYWJsZSwKKwku
cHJlcGFyZV9mYiA9IGRybV9nZW1fZmJfc2ltcGxlX2Rpc3BsYXlfcGlwZV9wcmVwYXJlX2ZiLAor
fTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fbW9kZV9jb25maWdfZnVuY3MgbXVkX2RybV9t
b2RlX2NvbmZpZ19mdW5jcyA9IHsKKwkuZmJfY3JlYXRlID0gZHJtX2dlbV9mYl9jcmVhdGVfd2l0
aF9kaXJ0eSwKKwkuYXRvbWljX2NoZWNrID0gZHJtX2F0b21pY19oZWxwZXJfY2hlY2ssCisJLmF0
b21pY19jb21taXQgPSBkcm1fYXRvbWljX2hlbHBlcl9jb21taXQsCit9OworCitzdGF0aWMgY29u
c3QgdWludDY0X3QgbXVkX2RybV9waXBlX21vZGlmaWVyc1tdID0geworCURSTV9GT1JNQVRfTU9E
X0xJTkVBUiwKKwlEUk1fRk9STUFUX01PRF9JTlZBTElECit9OworCitzdGF0aWMgdm9pZCBtdWRf
ZHJtX2RyaXZlcl9yZWxlYXNlKHN0cnVjdCBkcm1fZGV2aWNlICpkcm0pCit7CisJc3RydWN0IG11
ZF9kcm1fZGV2aWNlICptZHJtID0gdG9fbXVkX2RybV9kZXZpY2UoZHJtKTsKKworCXByaW50aygi
JXM6XG4iLCBfX2Z1bmNfXyk7CisKKwlkcm1fbW9kZV9jb25maWdfY2xlYW51cChkcm0pOworCWRy
bV9kZXZfZmluaShkcm0pOworCXZmcmVlKG1kcm0tPmJ1Zik7CisKKwlpZiAobWRybS0+d29ya3Ep
CisJCWRlc3Ryb3lfd29ya3F1ZXVlKG1kcm0tPndvcmtxKTsKKworCW11dGV4X2Rlc3Ryb3koJm1k
cm0tPmxvY2spOworCisJa2ZyZWUobWRybSk7Cit9CisKK0RFRklORV9EUk1fR0VNX0NNQV9GT1BT
KG11ZF9kcm1fZm9wcyk7CisvL0RFRklORV9EUk1fR0VNX1NITUVNX0ZPUFMobXVkX2RybV9mb3Bz
KTsKKworc3RhdGljIHN0cnVjdCBkcm1fZHJpdmVyIG11ZF9kcm1fZHJtX2RyaXZlciA9IHsKKwku
ZHJpdmVyX2ZlYXR1cmVzID0gRFJJVkVSX01PREVTRVQgfCBEUklWRVJfR0VNIHwgRFJJVkVSX0FU
T01JQywKKworCS5uYW1lCQkJPSAibXVkX2RybSIsCisJLmRlc2MJCQk9ICJNdWx0aWZ1bmN0aW9u
IFVTQiBEZXZpY2UgRGlzcGxheSIsCisJLmRhdGUJCQk9ICIyMDE5MDgyNiIsCisJLm1ham9yCQkJ
PSAxLAorCS5taW5vcgkJCT0gMCwKKworCS5yZWxlYXNlCQk9IG11ZF9kcm1fZHJpdmVyX3JlbGVh
c2UsCisJLmZvcHMJCQk9ICZtdWRfZHJtX2ZvcHMsCisJRFJNX0dFTV9DTUFfVk1BUF9EUklWRVJf
T1BTLAorLy8JRFJNX0dFTV9TSE1FTV9EUklWRVJfT1BTLAorfTsKKworc3RhdGljIGludCBtdWRf
ZHJtX3Byb2JlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpCit7CisJc3RydWN0IGRldmlj
ZSAqZGV2ID0gJnBkZXYtPmRldjsKKwlzdHJ1Y3QgbXVkX2NlbGxfcGRhdGEgKnBkYXRhID0gZGV2
X2dldF9wbGF0ZGF0YShkZXYpOworCXVuc2lnbmVkIGludCBudW1fY29ubmVjdG9ycywgbnVtX2Zv
cm1hdHM7CisJc3RydWN0IG11ZF9kcm1fZGV2aWNlICptZHJtOworCXN0cnVjdCBkcm1fZGV2aWNl
ICpkcm07CisJc3RydWN0IHJlZ21hcCAqcmVnbWFwOworCXUzMiB2YWxzWzRdLCAqZm9ybWF0czsK
KwlpbnQgcmV0LCBpOworCXN0cnVjdCByZWdtYXBfY29uZmlnIG11ZF9kcm1fcmVnbWFwX2NvbmZp
ZyA9IHsKKwkJLnJlZ19iaXRzID0gMzIsCisJCS52YWxfYml0cyA9IDMyLAorCQkuY2FjaGVfdHlw
ZSA9IFJFR0NBQ0hFX05PTkUsCisJfTsKKworCS8qIEZJWE1FOiBSZW1vdmUgaWYgQ01BIGlzIG5v
dCB1c2VkICovCisJaWYgKCFkZXYtPmNvaGVyZW50X2RtYV9tYXNrKSB7CisJCXJldCA9IGRtYV9j
b2VyY2VfbWFza19hbmRfY29oZXJlbnQoZGV2LCBETUFfQklUX01BU0soMzIpKTsKKwkJaWYgKHJl
dCkgeworCQkJZGV2X3dhcm4oZGV2LCAiRmFpbGVkIHRvIHNldCBkbWEgbWFzayAlZFxuIiwgcmV0
KTsKKwkJCXJldHVybiByZXQ7CisJCX0KKwl9CisKKwltZHJtID0ga3phbGxvYyhzaXplb2YoKm1k
cm0pLCBHRlBfS0VSTkVMKTsKKwlpZiAoIW1kcm0pCisJCXJldHVybiAtRU5PTUVNOworCisJZHJt
ID0gJm1kcm0tPmRybTsKKwlyZXQgPSBkZXZtX2RybV9kZXZfaW5pdChkZXYsIGRybSwgJm11ZF9k
cm1fZHJtX2RyaXZlcik7CisJaWYgKHJldCkgeworCQlrZnJlZShtZHJtKTsKKwkJcmV0dXJuIHJl
dDsKKwl9CisKKwlkcm1fbW9kZV9jb25maWdfaW5pdChkcm0pOworCWRybS0+bW9kZV9jb25maWcu
ZnVuY3MgPSAmbXVkX2RybV9tb2RlX2NvbmZpZ19mdW5jczsKKworCW1kcm0tPnVzYiA9IGludGVy
ZmFjZV90b191c2JkZXYocGRhdGEtPmludGVyZmFjZSk7CisKKwltdXRleF9pbml0KCZtZHJtLT5s
b2NrKTsKKworCUlOSVRfTElTVF9IRUFEKCZtZHJtLT5kYW1hZ2VsaXN0KTsKKworCUlOSVRfV09S
SygmbWRybS0+d29yaywgbXVkX2RybV93b3JrKTsKKwlpbml0X3dhaXRxdWV1ZV9oZWFkKCZtZHJt
LT53YWl0cSk7CisKKwltZHJtLT53b3JrcSA9IGFsbG9jX3dvcmtxdWV1ZSgibXVkX2RybSIsIDAs
IDApOworCWlmICghbWRybS0+d29ya3EpCisJCXJldHVybiAtRU5PTUVNOworCisJcmVnbWFwID0g
ZGV2bV9yZWdtYXBfaW5pdF91c2IoZGV2LCBwZGF0YS0+aW50ZXJmYWNlLCBwZGF0YS0+aW5kZXgs
CisJCQkJICAgICAgJm11ZF9kcm1fcmVnbWFwX2NvbmZpZyk7CisJaWYgKElTX0VSUihyZWdtYXAp
KQorCQlyZXR1cm4gUFRSX0VSUihyZWdtYXApOworCisJbWRybS0+cmVnbWFwID0gcmVnbWFwOwor
CisJbWRybS0+YnVmX2xlbiA9IFNaXzhNOworCW1kcm0tPmJ1ZiA9IHZtYWxsb2MobWRybS0+YnVm
X2xlbik7CisJaWYgKCFtZHJtLT5idWYpCisJCXJldHVybiAtRU5PTUVNOworCisJcmV0ID0gbXVk
X2RybV9yZWFkKG1kcm0sIE1VRF9EUk1fUkVHX01JTl9XSURUSCwgdmFscywgNCk7CisJaWYgKHJl
dCkKKwkJcmV0dXJuIHJldDsKKworCWRybS0+bW9kZV9jb25maWcubWluX3dpZHRoID0gdmFsc1sw
XTsKKwlkcm0tPm1vZGVfY29uZmlnLm1heF93aWR0aCA9IHZhbHNbMV07CisJZHJtLT5tb2RlX2Nv
bmZpZy5taW5faGVpZ2h0ID0gdmFsc1syXTsKKwlkcm0tPm1vZGVfY29uZmlnLm1heF9oZWlnaHQg
PSB2YWxzWzNdOworCisJcHJpbnRrKCJtaW5fd2lkdGg9JXUsIG1heF93aWR0aD0ldSwgbWluX2hl
aWdodD0ldSwgbWF4X2hlaWdodD0ldVxuIiwKKwkJZHJtLT5tb2RlX2NvbmZpZy5taW5fd2lkdGgs
IGRybS0+bW9kZV9jb25maWcubWF4X3dpZHRoLAorCQlkcm0tPm1vZGVfY29uZmlnLm1pbl9oZWln
aHQsIGRybS0+bW9kZV9jb25maWcubWF4X2hlaWdodCk7CisKKwlyZXQgPSByZWdtYXBfcmVhZChy
ZWdtYXAsIE1VRF9EUk1fUkVHX0ZPUk1BVFNfQ09VTlQsICZudW1fZm9ybWF0cyk7CisJcHJpbnRr
KCIgICAgTVVEX0RSTV9SRUdfRk9STUFUU19DT1VOVD0ldSwgcmV0PSVkXG4iLCBudW1fZm9ybWF0
cywgcmV0KTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJaWYgKCFudW1fZm9ybWF0cyB8
fCBudW1fZm9ybWF0cyA+IChNVURfRFJNX1JFR19GT1JNQVRTX01BWCAtIE1VRF9EUk1fUkVHX0ZP
Uk1BVFMpKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCWZvcm1hdHMgPSBkZXZtX2ttYWxsb2NfYXJy
YXkoZGV2LCBudW1fZm9ybWF0cywgc2l6ZW9mKHUzMiksIEdGUF9LRVJORUwpOworCWlmICghZm9y
bWF0cykKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlyZXQgPSByZWdtYXBfYnVsa19yZWFkKHJlZ21h
cCwgTVVEX0RSTV9SRUdfRk9STUFUUywgZm9ybWF0cywgbnVtX2Zvcm1hdHMpOworCXByaW50aygi
ICAgIE1VRF9EUk1fUkVHX0ZPUk1BVFM6IHJldD0lZFxuIiwgcmV0KTsKKwlpZiAocmV0KQorCQly
ZXR1cm4gcmV0OworCisJZm9yIChpID0gMDsgaSA8IG51bV9mb3JtYXRzOyBpKyspCisJCXByaW50
aygiICAgICAgMHglMDh4XG4iLCBmb3JtYXRzW2ldKTsKKworCXJldCA9IGRybV9zaW1wbGVfZGlz
cGxheV9waXBlX2luaXQoZHJtLCAmbWRybS0+cGlwZSwgJm11ZF9kcm1fcGlwZV9mdW5jcywKKwkJ
CQkJICAgZm9ybWF0cywgbnVtX2Zvcm1hdHMsCisJCQkJCSAgIG11ZF9kcm1fcGlwZV9tb2RpZmll
cnMsIE5VTEwpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwlkcm1fcGxhbmVfZW5hYmxl
X2ZiX2RhbWFnZV9jbGlwcygmbWRybS0+cGlwZS5wbGFuZSk7CisKKwlkZXZtX2tmcmVlKGRldiwg
Zm9ybWF0cyk7CisKKwlyZXQgPSByZWdtYXBfcmVhZChyZWdtYXAsIE1VRF9EUk1fUkVHX05VTV9D
T05ORUNUT1JTLCAmbnVtX2Nvbm5lY3RvcnMpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisK
KwlwcmludGsoIk1VRF9EUk1fUkVHX05VTV9DT05ORUNUT1JTPSV1XG4iLCBudW1fY29ubmVjdG9y
cyk7CisKKwlpZiAoIW51bV9jb25uZWN0b3JzIHx8IG51bV9jb25uZWN0b3JzID4gMTYpCisJCXJl
dHVybiAtRUlOVkFMOworCisJZm9yIChpID0gMDsgaSA8IG51bV9jb25uZWN0b3JzOyBpKyspIHsK
KwkJdW5zaWduZWQgaW50IGNvbm5fdHlwZTsKKworCQlyZXQgPSByZWdtYXBfcmVhZChyZWdtYXAs
IE1VRF9EUk1fUkVHX0NPTk5FQ1RPUl9UWVBFICsgaSwgJmNvbm5fdHlwZSk7CisJCWlmIChyZXQp
CisJCQlyZXR1cm4gcmV0OworCisJCS8qIFJFVklTSVQ6IFRoaXMgbmVlZHMgdG8gYmUgdXBkYXRl
ZCBhcyBuZXcgdHlwZXMgYXJlIGFkZGVkICovCisJCWlmIChjb25uX3R5cGUgPiBEUk1fTU9ERV9D
T05ORUNUT1JfU1BJKQorCQkJcmV0dXJuIC1FSU5WQUw7CisKKwkJcmV0ID0gbXVkX2RybV9jb25u
ZWN0b3JfY3JlYXRlKG1kcm0sIGNvbm5fdHlwZSk7CisJCWlmIChyZXQpCisJCQlyZXR1cm4gcmV0
OworCX0KKworCWRybV9tb2RlX2NvbmZpZ19yZXNldChkcm0pOworCisJZHJtX2ttc19oZWxwZXJf
cG9sbF9pbml0KGRybSk7CisKKwlwbGF0Zm9ybV9zZXRfZHJ2ZGF0YShwZGV2LCBkcm0pOworCisJ
cmV0ID0gZHJtX2Rldl9yZWdpc3Rlcihkcm0sIDApOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7
CisKKy8vCWRybV9mYmRldl9nZW5lcmljX3NldHVwKGRybSwgMTYpOworCisJcmV0dXJuIDA7Cit9
CisKK3N0YXRpYyBpbnQgbXVkX2RybV9yZW1vdmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRl
dikKK3sKKwlzdHJ1Y3QgZHJtX2RldmljZSAqZHJtID0gcGxhdGZvcm1fZ2V0X2RydmRhdGEocGRl
dik7CisKKwlwcmludGsoIiVzOlxuIiwgX19mdW5jX18pOworCisJZHJtX2ttc19oZWxwZXJfcG9s
bF9maW5pKGRybSk7CisJZHJtX2Rldl91bnBsdWcoZHJtKTsKKwlkcm1fYXRvbWljX2hlbHBlcl9z
aHV0ZG93bihkcm0pOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgcGxhdGZvcm1f
ZHJpdmVyIG11ZF9kcm1fZHJpdmVyID0geworCS5kcml2ZXIubmFtZQk9ICJtdWQtZHJtIiwKKwku
cHJvYmUJCT0gbXVkX2RybV9wcm9iZSwKKwkucmVtb3ZlCQk9IG11ZF9kcm1fcmVtb3ZlLAorfTsK
KworbW9kdWxlX3BsYXRmb3JtX2RyaXZlcihtdWRfZHJtX2RyaXZlcik7CisKK01PRFVMRV9BTElB
UygicGxhdGZvcm06bXVkLWRybSIpOworTU9EVUxFX0FVVEhPUigiTm9yYWxmIFRyw7hubmVzIik7
CitNT0RVTEVfTElDRU5TRSgiRHVhbCBNSVQvR1BMIik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vbXVkL211ZF9kcm0uaCBiL2RyaXZlcnMvZ3B1L2RybS9tdWQvbXVkX2RybS5oCm5ldyBm
aWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uOGFjZTYzZWQyZDQyCi0tLSAvZGV2
L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL211ZC9tdWRfZHJtLmgKQEAgLTAsMCArMSwxMzcg
QEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVQgKi8KKy8qCisgKiBDb3B5cmlnaHQg
MjAyMCBOb3JhbGYgVHLDuG5uZXMKKyAqLworCisjaWZuZGVmIF9fTElOVVhfTVVEX0RSTV9ICisj
ZGVmaW5lIF9fTElOVVhfTVVEX0RSTV9ICisKKyNpbmNsdWRlIDxkcm0vZHJtX21vZGVzLmg+CisK
KyNkZWZpbmUgTVVEX0RSTV9ESVNQTEFZX01PREVfRklFTERTCTE1CisKK3N0cnVjdCBtdWRfZHJt
X2Rpc3BsYXlfbW9kZSB7CisJdTMyIGNsb2NrOworCXUzMiBoZGlzcGxheTsKKwl1MzIgaHN5bmNf
c3RhcnQ7CisJdTMyIGhzeW5jX2VuZDsKKwl1MzIgaHRvdGFsOworCXUzMiBoc2tldzsKKwl1MzIg
dmRpc3BsYXk7CisJdTMyIHZzeW5jX3N0YXJ0OworCXUzMiB2c3luY19lbmQ7CisJdTMyIHZ0b3Rh
bDsKKwl1MzIgdnNjYW47CisKKwl1MzIgdnJlZnJlc2g7CisKKwl1MzIgZmxhZ3M7CisJdTMyIHR5
cGU7CisKKwl1MzIgcGljdHVyZV9hc3BlY3RfcmF0aW87Cit9IF9fcGFja2VkOworCitzdGF0aWMg
aW5saW5lIHZvaWQgbXVkX2RybV9mcm9tX2Rpc3BsYXlfbW9kZShzdHJ1Y3QgbXVkX2RybV9kaXNw
bGF5X21vZGUgKmRzdCwKKwkJCQkJICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAq
c3JjKQoreworCWRzdC0+Y2xvY2sgPSBzcmMtPmNsb2NrOworCWRzdC0+aGRpc3BsYXkgPSBzcmMt
PmhkaXNwbGF5OworCWRzdC0+aHN5bmNfc3RhcnQgPSBzcmMtPmhzeW5jX3N0YXJ0OworCWRzdC0+
aHN5bmNfZW5kID0gc3JjLT5oc3luY19lbmQ7CisJZHN0LT5odG90YWwgPSBzcmMtPmh0b3RhbDsK
Kwlkc3QtPmhza2V3ID0gc3JjLT5oc2tldzsKKwlkc3QtPnZkaXNwbGF5ID0gc3JjLT52ZGlzcGxh
eTsKKwlkc3QtPnZzeW5jX3N0YXJ0ID0gc3JjLT52c3luY19zdGFydDsKKwlkc3QtPnZzeW5jX2Vu
ZCA9IHNyYy0+dnN5bmNfZW5kOworCWRzdC0+dnRvdGFsID0gc3JjLT52dG90YWw7CisJZHN0LT52
c2NhbiA9IHNyYy0+dnNjYW47CisJZHN0LT52cmVmcmVzaCA9IHNyYy0+dnJlZnJlc2g7CisJZHN0
LT5mbGFncyA9IHNyYy0+ZmxhZ3M7CisJZHN0LT50eXBlID0gc3JjLT50eXBlOworCWRzdC0+cGlj
dHVyZV9hc3BlY3RfcmF0aW8gPSBzcmMtPnBpY3R1cmVfYXNwZWN0X3JhdGlvOworfQorCitzdGF0
aWMgaW5saW5lIHZvaWQgbXVkX2RybV90b19kaXNwbGF5X21vZGUoc3RydWN0IGRybV9kaXNwbGF5
X21vZGUgKmRzdCwKKwkJCQkJICAgY29uc3Qgc3RydWN0IG11ZF9kcm1fZGlzcGxheV9tb2RlICpz
cmMpCit7CisJZHN0LT5jbG9jayA9IHNyYy0+Y2xvY2s7CisJZHN0LT5oZGlzcGxheSA9IHNyYy0+
aGRpc3BsYXk7CisJZHN0LT5oc3luY19zdGFydCA9IHNyYy0+aHN5bmNfc3RhcnQ7CisJZHN0LT5o
c3luY19lbmQgPSBzcmMtPmhzeW5jX2VuZDsKKwlkc3QtPmh0b3RhbCA9IHNyYy0+aHRvdGFsOwor
CWRzdC0+aHNrZXcgPSBzcmMtPmhza2V3OworCWRzdC0+dmRpc3BsYXkgPSBzcmMtPnZkaXNwbGF5
OworCWRzdC0+dnN5bmNfc3RhcnQgPSBzcmMtPnZzeW5jX3N0YXJ0OworCWRzdC0+dnN5bmNfZW5k
ID0gc3JjLT52c3luY19lbmQ7CisJZHN0LT52dG90YWwgPSBzcmMtPnZ0b3RhbDsKKwlkc3QtPnZz
Y2FuID0gc3JjLT52c2NhbjsKKwlkc3QtPnZyZWZyZXNoID0gc3JjLT52cmVmcmVzaDsKKwlkc3Qt
PmZsYWdzID0gc3JjLT5mbGFnczsKKwlkc3QtPnR5cGUgPSBzcmMtPnR5cGU7CisJZHN0LT5waWN0
dXJlX2FzcGVjdF9yYXRpbyA9IHNyYy0+cGljdHVyZV9hc3BlY3RfcmF0aW87CisJZHJtX21vZGVf
c2V0X25hbWUoZHN0KTsKK30KKworI2RlZmluZSBNVURfRFJNX1JFR19NSU5fV0lEVEgJCQkweDAw
MDEKKyNkZWZpbmUgTVVEX0RSTV9SRUdfTUFYX1dJRFRICQkJMHgwMDAyCisjZGVmaW5lIE1VRF9E
Uk1fUkVHX01JTl9IRUlHSFQJCQkweDAwMDMKKyNkZWZpbmUgTVVEX0RSTV9SRUdfTUFYX0hFSUdI
VAkJCTB4MDAwNAorCisjZGVmaW5lIE1VRF9EUk1fUkVHX05VTV9DT05ORUNUT1JTCQkweDAwMDUK
KworI2RlZmluZSBNVURfRFJNX1JFR19UVl9NT0RFU19DT1VOVAkJMHgwMDEwCisjZGVmaW5lIE1V
RF9EUk1fUkVHX1RWX01PREVTCQkJMHgwMDExCisKKyNkZWZpbmUgTVVEX0RSTV9SRUdfUElQRV9F
TkFCTEUJCQkweDAwNzAKKworI2RlZmluZSBNVURfRFJNX1JFR19SRUNUX1gJCQkweDAwNzEKKyNk
ZWZpbmUgTVVEX0RSTV9SRUdfUkVDVF9ZCQkJMHgwMDcyCisjZGVmaW5lIE1VRF9EUk1fUkVHX1JF
Q1RfV0lEVEgJCQkweDAwNzMKKyNkZWZpbmUgTVVEX0RSTV9SRUdfUkVDVF9IRUlHSFQJCQkweDAw
NzQKKworI2RlZmluZSBNVURfRFJNX1JFR19TRVRfQ09OTkVDVE9SCQkweDAwNTAKKyNkZWZpbmUg
TVVEX0RSTV9SRUdfU0VUX01PREUJCQkweDAwNTEKKyNkZWZpbmUgTVVEX0RSTV9SRUdfU0VUX01P
REVfTUFYCQkweDAwNWYKKyNkZWZpbmUgTVVEX0RSTV9SRUdfU0VUX0ZPUk1BVAkJCTB4MDA2MAor
I2RlZmluZSBNVURfRFJNX1JFR19TRVRfQ09NTUlUCQkJMHgwMDYxCisgICNkZWZpbmUgTVVEX0RS
TV9DT01NSVRfQ0hFQ0sJCQkxCisgICNkZWZpbmUgTVVEX0RSTV9DT01NSVRfQVBQTFkJCQkyCisK
KyNkZWZpbmUgTVVEX0RSTV9SRUdfRk9STUFUU19DT1VOVAkJMHgwMTAwCisjZGVmaW5lIE1VRF9E
Uk1fUkVHX0ZPUk1BVFMJCQkweDAxMDEKKyNkZWZpbmUgTVVEX0RSTV9SRUdfRk9STUFUU19NQVgJ
CQkweDAxZmYKKworI2RlZmluZSBNVURfRFJNX01BWF9DT05ORUNUT1JTCQkJMTYKKworI2RlZmlu
ZSBNVURfRFJNX1JFR19DT05ORUNUT1JfVFlQRQkJMHgxMDAwCisjZGVmaW5lIE1VRF9EUk1fUkVH
X0NPTk5FQ1RPUl9DQVBTCQkweDEwMTAKKyAgI2RlZmluZSBNVURfRFJNX0NPTk5FQ1RPUl9DQVBf
TU9ERQkJQklUKDApCisgICNkZWZpbmUgTVVEX0RSTV9DT05ORUNUT1JfQ0FQX0VESUQJCUJJVCgx
KQorICAjZGVmaW5lIE1VRF9EUk1fQ09OTkVDVE9SX0NBUF9UVgkJQklUKDIpCisjZGVmaW5lIE1V
RF9EUk1fUkVHX0NPTk5FQ1RPUl9TVEFUVVMJCTB4MTAyMAorI2RlZmluZSBNVURfRFJNX1JFR19D
T05ORUNUT1JfRURJRF9MRU4JCTB4MTAzMAorI2RlZmluZSBNVURfRFJNX1JFR19DT05ORUNUT1Jf
TU9ERVNfQ09VTlQJMHgxMDUwCisjZGVmaW5lIE1VRF9EUk1fUkVHX0NPTk5FQ1RPUl9UVl9NT0RF
CQkweDEwNzAKKyNkZWZpbmUgTVVEX0RSTV9SRUdfQ09OTkVDVE9SX0VESUQJCTB4MjAwMAorICAj
ZGVmaW5lIE1VRF9EUk1fQ09OTkVDVE9SX0VESURfQkxPQ0tfTUFYCTQwOTYKKyNkZWZpbmUgTVVE
X0RSTV9SRUdfQ09OTkVDVE9SX0VESURfTUFYCQkweDVmZmYgLy8gMTYgKiA0MDk2IC8gNCA9IDE2
Mzg0ID0gMHg0MDAwCisjZGVmaW5lIE1VRF9EUk1fUkVHX0NPTk5FQ1RPUl9NT0RFUwkJMHg2MDAw
CisgICNkZWZpbmUgTVVEX0RSTV9DT05ORUNUT1JfTU9ERVNfQ09VTlRfTUFYCTY0CisgICNkZWZp
bmUgTVVEX0RSTV9DT05ORUNUT1JfTU9ERVNfQkxPQ0tfTUFYCShNVURfRFJNX0NPTk5FQ1RPUl9N
T0RFU19DT1VOVF9NQVggKiBNVURfRFJNX0RJU1BMQVlfTU9ERV9GSUVMRFMpCisjZGVmaW5lIE1V
RF9EUk1fUkVHX0NPTk5FQ1RPUl9NT0RFU19NQVgJCTB4MTRmZmYgLy8gMTYgKiA2NCAqICgxNSAq
IDQpID0gNjE0NDAgPSAweGYwMDAKKyNkZWZpbmUgTVVEX0RSTV9SRUdfQ09OTkVDVE9SX01BWAkJ
MHgxNGZmZgorCisjZGVmaW5lIE1VRF9EUk1fUkVHX0JVRkZFUgkJCTB4MTAwMDAwMDAKKworc3Ry
dWN0IG11ZF9kcm1fZ2FkZ2V0OworCitpbnQgbXVkX2RybV9nYWRnZXRfd3JpdGVyZWcoc3RydWN0
IG11ZF9kcm1fZ2FkZ2V0ICptZGcsIHVuc2lnbmVkIGludCByZWduciwKKwkJCSAgICBjb25zdCB2
b2lkICpidWYsIHNpemVfdCBsZW4sIHU4IGNvbXByZXNzaW9uKTsKK2ludCBtdWRfZHJtX2dhZGdl
dF9yZWFkcmVnKHN0cnVjdCBtdWRfZHJtX2dhZGdldCAqbWRnLCB1bnNpZ25lZCBpbnQgcmVnbnIs
CisJCQkgICB2b2lkICpidWYsIHNpemVfdCAqbGVuLCB1OCBjb21wcmVzc2lvbik7Cit2b2lkIG11
ZF9kcm1fZ2FkZ2V0X2VuYWJsZShzdHJ1Y3QgbXVkX2RybV9nYWRnZXQgKm1kZyk7Cit2b2lkIG11
ZF9kcm1fZ2FkZ2V0X2Rpc2FibGUoc3RydWN0IG11ZF9kcm1fZ2FkZ2V0ICptZGcpOworc3RydWN0
IG11ZF9kcm1fZ2FkZ2V0ICptdWRfZHJtX2dhZGdldF9pbml0KHVuc2lnbmVkIGludCBtaW5vcl9p
ZCwKKwkJCQkJICAgc2l6ZV90IG1heF90cmFuc2Zlcl9zaXplKTsKKworI2VuZGlmCi0tIAoyLjIz
LjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1k
ZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczov
L2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbAo=
