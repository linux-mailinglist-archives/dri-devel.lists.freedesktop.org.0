Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id E9DA7DF591
	for <lists+dri-devel@lfdr.de>; Mon, 21 Oct 2019 21:03:22 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0704A6E0BA;
	Mon, 21 Oct 2019 19:03:18 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-pl1-x644.google.com (mail-pl1-x644.google.com
 [IPv6:2607:f8b0:4864:20::644])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E01A46E1F9
 for <dri-devel@lists.freedesktop.org>; Mon, 21 Oct 2019 19:03:15 +0000 (UTC)
Received: by mail-pl1-x644.google.com with SMTP id v5so2351344ply.10
 for <dri-devel@lists.freedesktop.org>; Mon, 21 Oct 2019 12:03:15 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references;
 bh=aZL/3d1/h8RCc0nddpikyAjJxLVmuM26/wtYP52MfEI=;
 b=nzAwBI6GJrbOza39SBoAuqMtceq3ucuWRq0DWhiApOvAHKLdt2JBpunEdHIyqlmzpb
 zzwdkdJl9VVueQDNm60Q3IBZqji7Jy8DJ/Oxj3EeA13Rs162a+ae9lQ/WQCLaOhqtKP0
 cnXUc7efT9vh0ldGcOW8kEUTzVP3YMCqZw5qyMc8V5wvMzS1h6EhOcfr2oqjwn1BRwj7
 DpuaRnkFDRdtw+ClBTp4wDR19ccbceSNEP4Ai+Axiyelsum6USCut1WOmibgJtW5xDM0
 04p1DTkGCTWlvxAewFpCUsSbbQSR9W5YSmfvuRPpoVdFH5xQFAIblFRYVQe4GJWviKYs
 WzJA==
X-Gm-Message-State: APjAAAVwx37VMS2NORhNwjLLwUaw6EvCrQNm5DztL7bziOx+sPi/w4C6
 ffQRCtOcDoIRtDL1BTs1Xrdm4A==
X-Google-Smtp-Source: APXvYqzIjcILNPbPm9b2HRaEQlR9uN2x+zb1d7ck/K5c3Nu2uOKdUFO6EKGUHSriVblNd3xzV0myhQ==
X-Received: by 2002:a17:902:bd8c:: with SMTP id
 q12mr2810497pls.257.1571684595320; 
 Mon, 21 Oct 2019 12:03:15 -0700 (PDT)
Received: from localhost.localdomain ([2601:1c2:680:1319:692:26ff:feda:3a81])
 by smtp.gmail.com with ESMTPSA id
 127sm16223673pfy.56.2019.10.21.12.03.14
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 21 Oct 2019 12:03:14 -0700 (PDT)
From: John Stultz <john.stultz@linaro.org>
To: lkml <linux-kernel@vger.kernel.org>
Subject: [PATCH v13 2/5] dma-buf: heaps: Add heap helpers
Date: Mon, 21 Oct 2019 19:03:07 +0000
Message-Id: <20191021190310.85221-3-john.stultz@linaro.org>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20191021190310.85221-1-john.stultz@linaro.org>
References: <20191021190310.85221-1-john.stultz@linaro.org>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=linaro.org; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references;
 bh=aZL/3d1/h8RCc0nddpikyAjJxLVmuM26/wtYP52MfEI=;
 b=D/ETzjvXVJtoIz7whSpLNHmkoiXeoGfpsxtTnzQ/FGjY3hOOoFBlYVNTuaql6JkPGf
 +4XUFtRoVDIwNguYhHfoWb4anW67aVLUs7aZNKRaKPla5fRFcyj/uZ9D4X1oyEwiCWVO
 xlohsUsm4mPqY3yhsEf2/IJ5q4mKmCQDNP8ovPY9AOPjuiA5Y3zXlJmydihDfUKoeyEb
 VlezVyu5DbHuOWk9jeq4BGBMpIGPjV9wmaaparjBAZze37Zo5BDwtuTuuWPi5S2mZoDm
 NC2Nx0m1U6GKnFxkqylmzW6IXmiN2JixwRW936A7E/vZmPUKwia5X6eKVFk3s2aOvUQ/
 irRg==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Hillf Danton <hdanton@sina.com>, Sudipto Paul <Sudipto.Paul@arm.com>,
 Vincent Donnefort <Vincent.Donnefort@arm.com>, Chenbo Feng <fengc@google.com>,
 Alistair Strachan <astrachan@google.com>, Liam Mark <lmark@codeaurora.org>,
 Christoph Hellwig <hch@infradead.org>, dri-devel@lists.freedesktop.org,
 "Andrew F . Davis" <afd@ti.com>, Hridya Valsaraju <hridya@google.com>,
 Pratik Patel <pratikp@codeaurora.org>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIGdlbmVyaWMgaGVscGVyIGRtYWJ1ZiBvcHMgZm9yIGRtYSBoZWFwcywgc28gd2UgY2FuIHJl
ZHVjZQp0aGUgYW1vdW50IG9mIGR1cGxpY2F0aXZlIGNvZGUgZm9yIHRoZSBleHBvcnRlZCBkbWFi
dWZzLgoKVGhpcyBjb2RlIGlzIGFuIGV2b2x1dGlvbiBvZiB0aGUgQW5kcm9pZCBJT04gaW1wbGVt
ZW50YXRpb24sIHNvCnRoYW5rcyB0byBpdHMgb3JpZ2luYWwgYXV0aG9ycyBhbmQgbWFpbnRhaW50
ZXJzOgogIFJlYmVjY2EgU2NodWx0eiBaYXZpbiwgQ29saW4gQ3Jvc3MsIExhdXJhIEFiYm90dCwg
YW5kIG90aGVycyEKCkNjOiBMYXVyYSBBYmJvdHQgPGxhYmJvdHRAcmVkaGF0LmNvbT4KQ2M6IEJl
bmphbWluIEdhaWduYXJkIDxiZW5qYW1pbi5nYWlnbmFyZEBsaW5hcm8ub3JnPgpDYzogU3VtaXQg
U2Vtd2FsIDxzdW1pdC5zZW13YWxAbGluYXJvLm9yZz4KQ2M6IExpYW0gTWFyayA8bG1hcmtAY29k
ZWF1cm9yYS5vcmc+CkNjOiBQcmF0aWsgUGF0ZWwgPHByYXRpa3BAY29kZWF1cm9yYS5vcmc+CkNj
OiBCcmlhbiBTdGFya2V5IDxCcmlhbi5TdGFya2V5QGFybS5jb20+CkNjOiBWaW5jZW50IERvbm5l
Zm9ydCA8VmluY2VudC5Eb25uZWZvcnRAYXJtLmNvbT4KQ2M6IFN1ZGlwdG8gUGF1bCA8U3VkaXB0
by5QYXVsQGFybS5jb20+CkNjOiBBbmRyZXcgRi4gRGF2aXMgPGFmZEB0aS5jb20+CkNjOiBDaHJp
c3RvcGggSGVsbHdpZyA8aGNoQGluZnJhZGVhZC5vcmc+CkNjOiBDaGVuYm8gRmVuZyA8ZmVuZ2NA
Z29vZ2xlLmNvbT4KQ2M6IEFsaXN0YWlyIFN0cmFjaGFuIDxhc3RyYWNoYW5AZ29vZ2xlLmNvbT4K
Q2M6IEhyaWR5YSBWYWxzYXJhanUgPGhyaWR5YUBnb29nbGUuY29tPgpDYzogSGlsbGYgRGFudG9u
IDxoZGFudG9uQHNpbmEuY29tPgpDYzogZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpS
ZXZpZXdlZC1ieTogQmVuamFtaW4gR2FpZ25hcmQgPGJlbmphbWluLmdhaWduYXJkQGxpbmFyby5v
cmc+ClJldmlld2VkLWJ5OiBCcmlhbiBTdGFya2V5IDxicmlhbi5zdGFya2V5QGFybS5jb20+CkFj
a2VkLWJ5OiBMYXVyYSBBYmJvdHQgPGxhYmJvdHRAcmVkaGF0LmNvbT4KVGVzdGVkLWJ5OiBBeWFu
IEt1bWFyIEhhbGRlciA8YXlhbi5oYWxkZXJAYXJtLmNvbT4KU2lnbmVkLW9mZi1ieTogSm9obiBT
dHVsdHogPGpvaG4uc3R1bHR6QGxpbmFyby5vcmc+Ci0tLQp2MjoKKiBSZW1vdmVkIGNhY2hlIG1h
bmFnZW1lbnQgcGVyZm9ybWFuY2UgaGFjayB0aGF0IEkgaGFkCiAgYWNjaWRlbnRhbGx5IGZvbGRl
ZCBpbi4KKiBSZW1vdmVkIHN0YXRzIGNvZGUgdGhhdCB3YXMgaW4gaGVscGVycwoqIExvdHMgb2Yg
Y2hlY2twYXRjaCBjbGVhbnVwcwp2MzoKKiBVbmlubGluZSBJTklUX0hFQVBfSEVMUEVSX0JVRkZF
UiAoc3VnZ2VzdGVkIGJ5IENocmlzdG9waCkKKiBTd2l0Y2ggdG8gV0FSTiBvbiBidWZmZXIgZGVz
dHJveSBmYWlsdXJlIChzdWdnZXN0ZWQgYnkgQnJpYW4pCiogYnVmZmVyLT5rbWFwX2NudCBkZWNy
ZW1lbnRpbmcgY2xlYW51cCAoc3VnZ2VzdGVkIGJ5IENocmlzdG9waCkKKiBFeHRyYSBidWZmZXIt
PnZhZGRyIGNoZWNraW5nIGluIGRtYV9oZWFwX2RtYV9idWZfa21hcAogIChzdWdnZXN0ZWQgYnkg
QnJpYW4pCiogU3dpdGNoIHRvX2hlbHBlcl9idWZmZXIgZnJvbSBtYWNybyB0byBpbmxpbmUgZnVu
Y3Rpb24KICAoc3VnZ2VzdGVkIGJ5IEJlbmphbWluKQoqIFJlbmFtZSBrbWFwLT52bWFwIChmb2xk
ZWQgaW4gZnJvbSBBbmRyZXcpCiogVXNlIHZtYXAgZm9yIHZtYXBwaW5nIC0gbm90IGJlZ2luX2Nw
dV9hY2Nlc3MgKGZvbGRlZCBpbiBmcm9tCiAgQW5kcmV3KQoqIERyb3Aga21hcCBmb3Igbm93LCBh
cyBpdHMgb3B0aW9uYWwgKGZvbGRlZCBpbiBmcm9tIEFuZHJldykKKiBGb2xkIGRtYV9oZWFwX21h
cF91c2VyIGludG8gdGhlIHNpbmdsZSBjYWxsZXIgKGZvbGVkIGluIGZyb20KICBBbmRyZXcpCiog
Rm9sZGVkIGluIHBhdGNoIGZyb20gQW5kcmV3IHRvIHRyYWNrIHBhZ2UgbGlzdCBwZXIgaGVhcCBu
b3QKICBzZ2xpc3QsIHdoaWNoIHNpbXBsaWZpZXMgdGhlIHRyYWNraW5nIGxvZ2ljCnY0OgoqIE1v
dmVkIGRtYS1oZWFwLmggY2hhbmdlIG91dCB0byBwcmV2aW91cyBwYXRjaAp2NjoKKiBNaW5vciBj
bGVhbnVwcyBhbmQgdHlwbyBmaXhlcyBzdWdnZXN0ZWQgYnkgQnJpYW4Kdjc6CiogUmVtb3ZlZCBz
dHJheSA7CiogTWFrZSBpbml0X2hlYXBfaGVscGVyX2J1ZmZlciBsb3dlcmNhc2UsIGFzIHN1Z2dl
c3RlZCBieSBDaHJpc3RvcGgKKiBBZGQgZG1hYnVmIGV4cG9ydCBoZWxwZXIgdG8gcmVkdWNlIGJv
aWxlcnBsYXRlIGNvZGUKdjg6CiogUmVtb3ZlIHVudXNlZCBwcml2YXRlX2ZsYWdzIHZhbHVlCiog
Q29uZGVuc2UgZG1hX2hlYXBfYnVmZmVyIGFuZCBoZWFwX2hlbHBlcl9idWZmZXIgKHN1Z2dlc3Rl
ZCBieQogIENocmlzdG9waCkKKiBGaXggaW5kZW50YXRpb24gYnkgdXNpbmcgc2hvcnRlciBhcmd1
bWVudCBuYW1lcyAoc3VnZ2VzdGVkIGJ5CiAgQ2hyaXN0b3BoKQoqIEFkZCBmbHVzaF9rZXJuZWxf
dm1hcF9yYW5nZS9pbnZhbGlkYXRlX2tlcm5lbF92bWFwX3JhbmdlIGNhbGxzCiAgKHN1Z2dlc3Rl
ZCBieSBDaHJpc3RvcGgpCiogQ2hlY2twYXRjaCB3aGl0ZXNwYWNlIGZpeHVwcwp2OToKKiBNaW5v
ciBjbGVhbnVwcyBzdWdnZXN0ZWQgYnkgQnJpYW4gU3RhcmtleQp2MTA6CiogRml4IG1pc3Npbmcg
dm1hbGxvYy5oIGluY2x1c2lvbiBpbiBoZWFwIGhlbHBlcnMgKGZvdW5kIGJ5CiAga2J1aWxkIHRl
c3Qgcm9ib3QgPGxrcEBpbnRlbC5jb20+KQp2MTI6CiogQWRkIHN5bWJvbCBleHBvcnRzIGZvciBo
ZWFwcyBhcyBtb2R1bGVzCnYxMzoKKiBSZS1yZW1vdmUgc3ltYm9sIGV4cG9ydHMsIHBlciBkaXNj
dXNzaW9uIHdpdGggQnJpYW4sIGFzIEknbGwKICByZXN1Ym1pdCB0aGUgY2hhbmdlIGZvciByZXZp
ZXcgaW5kZXBlbmRlbnRseS4KLS0tCiBkcml2ZXJzL2RtYS1idWYvTWFrZWZpbGUgICAgICAgICAg
ICAgfCAgIDEgKwogZHJpdmVycy9kbWEtYnVmL2hlYXBzL01ha2VmaWxlICAgICAgIHwgICAyICsK
IGRyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9oZWFwLWhlbHBlcnMuYyB8IDI2OCArKysrKysrKysrKysr
KysrKysrKysrKysrKysKIGRyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9oZWFwLWhlbHBlcnMuaCB8ICA1
NSArKysrKysKIDQgZmlsZXMgY2hhbmdlZCwgMzI2IGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2Rl
IDEwMDY0NCBkcml2ZXJzL2RtYS1idWYvaGVhcHMvTWFrZWZpbGUKIGNyZWF0ZSBtb2RlIDEwMDY0
NCBkcml2ZXJzL2RtYS1idWYvaGVhcHMvaGVhcC1oZWxwZXJzLmMKIGNyZWF0ZSBtb2RlIDEwMDY0
NCBkcml2ZXJzL2RtYS1idWYvaGVhcHMvaGVhcC1oZWxwZXJzLmgKCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2RtYS1idWYvTWFrZWZpbGUgYi9kcml2ZXJzL2RtYS1idWYvTWFrZWZpbGUKaW5kZXggY2Fl
ZTVlYjNkMzUxLi45YzE5MDAyNmJmYWIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9NYWtl
ZmlsZQorKysgYi9kcml2ZXJzL2RtYS1idWYvTWFrZWZpbGUKQEAgLTIsNiArMiw3IEBACiBvYmot
eSA6PSBkbWEtYnVmLm8gZG1hLWZlbmNlLm8gZG1hLWZlbmNlLWFycmF5Lm8gZG1hLWZlbmNlLWNo
YWluLm8gXAogCSBkbWEtcmVzdi5vIHNlcW5vLWZlbmNlLm8KIG9iai0kKENPTkZJR19ETUFCVUZf
SEVBUFMpCSs9IGRtYS1oZWFwLm8KK29iai0kKENPTkZJR19ETUFCVUZfSEVBUFMpCSs9IGhlYXBz
Lwogb2JqLSQoQ09ORklHX1NZTkNfRklMRSkJCSs9IHN5bmNfZmlsZS5vCiBvYmotJChDT05GSUdf
U1dfU1lOQykJCSs9IHN3X3N5bmMubyBzeW5jX2RlYnVnLm8KIG9iai0kKENPTkZJR19VRE1BQlVG
KQkJKz0gdWRtYWJ1Zi5vCmRpZmYgLS1naXQgYS9kcml2ZXJzL2RtYS1idWYvaGVhcHMvTWFrZWZp
bGUgYi9kcml2ZXJzL2RtYS1idWYvaGVhcHMvTWFrZWZpbGUKbmV3IGZpbGUgbW9kZSAxMDA2NDQK
aW5kZXggMDAwMDAwMDAwMDAwLi5kZTQ5ODk4MTEyZGIKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2
ZXJzL2RtYS1idWYvaGVhcHMvTWFrZWZpbGUKQEAgLTAsMCArMSwyIEBACisjIFNQRFgtTGljZW5z
ZS1JZGVudGlmaWVyOiBHUEwtMi4wCitvYmoteQkJCQkJKz0gaGVhcC1oZWxwZXJzLm8KZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9oZWFwLWhlbHBlcnMuYyBiL2RyaXZlcnMvZG1h
LWJ1Zi9oZWFwcy9oZWFwLWhlbHBlcnMuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAw
MDAwMDAwMDAuLjc1MGJlZjRlOTAyZAotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZG1hLWJ1
Zi9oZWFwcy9oZWFwLWhlbHBlcnMuYwpAQCAtMCwwICsxLDI2OCBAQAorLy8gU1BEWC1MaWNlbnNl
LUlkZW50aWZpZXI6IEdQTC0yLjAKKyNpbmNsdWRlIDxsaW51eC9kZXZpY2UuaD4KKyNpbmNsdWRl
IDxsaW51eC9kbWEtYnVmLmg+CisjaW5jbHVkZSA8bGludXgvZXJyLmg+CisjaW5jbHVkZSA8bGlu
dXgvaGlnaG1lbS5oPgorI2luY2x1ZGUgPGxpbnV4L2lkci5oPgorI2luY2x1ZGUgPGxpbnV4L2xp
c3QuaD4KKyNpbmNsdWRlIDxsaW51eC9zbGFiLmg+CisjaW5jbHVkZSA8bGludXgvdWFjY2Vzcy5o
PgorI2luY2x1ZGUgPGxpbnV4L3ZtYWxsb2MuaD4KKyNpbmNsdWRlIDx1YXBpL2xpbnV4L2RtYS1o
ZWFwLmg+CisKKyNpbmNsdWRlICJoZWFwLWhlbHBlcnMuaCIKKwordm9pZCBpbml0X2hlYXBfaGVs
cGVyX2J1ZmZlcihzdHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICpidWZmZXIsCisJCQkgICAgIHZv
aWQgKCpmcmVlKShzdHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICopKQoreworCWJ1ZmZlci0+cHJp
dl92aXJ0ID0gTlVMTDsKKwltdXRleF9pbml0KCZidWZmZXItPmxvY2spOworCWJ1ZmZlci0+dm1h
cF9jbnQgPSAwOworCWJ1ZmZlci0+dmFkZHIgPSBOVUxMOworCWJ1ZmZlci0+cGFnZWNvdW50ID0g
MDsKKwlidWZmZXItPnBhZ2VzID0gTlVMTDsKKwlJTklUX0xJU1RfSEVBRCgmYnVmZmVyLT5hdHRh
Y2htZW50cyk7CisJYnVmZmVyLT5mcmVlID0gZnJlZTsKK30KKworc3RydWN0IGRtYV9idWYgKmhl
YXBfaGVscGVyX2V4cG9ydF9kbWFidWYoc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVmZmVy
LAorCQkJCQkgIGludCBmZF9mbGFncykKK3sKKwlERUZJTkVfRE1BX0JVRl9FWFBPUlRfSU5GTyhl
eHBfaW5mbyk7CisKKwlleHBfaW5mby5vcHMgPSAmaGVhcF9oZWxwZXJfb3BzOworCWV4cF9pbmZv
LnNpemUgPSBidWZmZXItPnNpemU7CisJZXhwX2luZm8uZmxhZ3MgPSBmZF9mbGFnczsKKwlleHBf
aW5mby5wcml2ID0gYnVmZmVyOworCisJcmV0dXJuIGRtYV9idWZfZXhwb3J0KCZleHBfaW5mbyk7
Cit9CisKK3N0YXRpYyB2b2lkICpkbWFfaGVhcF9tYXBfa2VybmVsKHN0cnVjdCBoZWFwX2hlbHBl
cl9idWZmZXIgKmJ1ZmZlcikKK3sKKwl2b2lkICp2YWRkcjsKKworCXZhZGRyID0gdm1hcChidWZm
ZXItPnBhZ2VzLCBidWZmZXItPnBhZ2Vjb3VudCwgVk1fTUFQLCBQQUdFX0tFUk5FTCk7CisJaWYg
KCF2YWRkcikKKwkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7CisKKwlyZXR1cm4gdmFkZHI7Cit9
CisKK3N0YXRpYyB2b2lkIGRtYV9oZWFwX2J1ZmZlcl9kZXN0cm95KHN0cnVjdCBoZWFwX2hlbHBl
cl9idWZmZXIgKmJ1ZmZlcikKK3sKKwlpZiAoYnVmZmVyLT52bWFwX2NudCA+IDApIHsKKwkJV0FS
TigiJXM6IGJ1ZmZlciBzdGlsbCBtYXBwZWQgaW4gdGhlIGtlcm5lbFxuIiwgX19mdW5jX18pOwor
CQl2dW5tYXAoYnVmZmVyLT52YWRkcik7CisJfQorCisJYnVmZmVyLT5mcmVlKGJ1ZmZlcik7Cit9
CisKK3N0YXRpYyB2b2lkICpkbWFfaGVhcF9idWZmZXJfdm1hcF9nZXQoc3RydWN0IGhlYXBfaGVs
cGVyX2J1ZmZlciAqYnVmZmVyKQoreworCXZvaWQgKnZhZGRyOworCisJaWYgKGJ1ZmZlci0+dm1h
cF9jbnQpIHsKKwkJYnVmZmVyLT52bWFwX2NudCsrOworCQlyZXR1cm4gYnVmZmVyLT52YWRkcjsK
Kwl9CisJdmFkZHIgPSBkbWFfaGVhcF9tYXBfa2VybmVsKGJ1ZmZlcik7CisJaWYgKElTX0VSUih2
YWRkcikpCisJCXJldHVybiB2YWRkcjsKKwlidWZmZXItPnZhZGRyID0gdmFkZHI7CisJYnVmZmVy
LT52bWFwX2NudCsrOworCXJldHVybiB2YWRkcjsKK30KKworc3RhdGljIHZvaWQgZG1hX2hlYXBf
YnVmZmVyX3ZtYXBfcHV0KHN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKmJ1ZmZlcikKK3sKKwlp
ZiAoIS0tYnVmZmVyLT52bWFwX2NudCkgeworCQl2dW5tYXAoYnVmZmVyLT52YWRkcik7CisJCWJ1
ZmZlci0+dmFkZHIgPSBOVUxMOworCX0KK30KKworc3RydWN0IGRtYV9oZWFwc19hdHRhY2htZW50
IHsKKwlzdHJ1Y3QgZGV2aWNlICpkZXY7CisJc3RydWN0IHNnX3RhYmxlIHRhYmxlOworCXN0cnVj
dCBsaXN0X2hlYWQgbGlzdDsKK307CisKK3N0YXRpYyBpbnQgZG1hX2hlYXBfYXR0YWNoKHN0cnVj
dCBkbWFfYnVmICpkbWFidWYsCisJCQkgICBzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICphdHRh
Y2htZW50KQoreworCXN0cnVjdCBkbWFfaGVhcHNfYXR0YWNobWVudCAqYTsKKwlzdHJ1Y3QgaGVh
cF9oZWxwZXJfYnVmZmVyICpidWZmZXIgPSBkbWFidWYtPnByaXY7CisJaW50IHJldDsKKworCWEg
PSBremFsbG9jKHNpemVvZigqYSksIEdGUF9LRVJORUwpOworCWlmICghYSkKKwkJcmV0dXJuIC1F
Tk9NRU07CisKKwlyZXQgPSBzZ19hbGxvY190YWJsZV9mcm9tX3BhZ2VzKCZhLT50YWJsZSwgYnVm
ZmVyLT5wYWdlcywKKwkJCQkJYnVmZmVyLT5wYWdlY291bnQsIDAsCisJCQkJCWJ1ZmZlci0+cGFn
ZWNvdW50IDw8IFBBR0VfU0hJRlQsCisJCQkJCUdGUF9LRVJORUwpOworCWlmIChyZXQpIHsKKwkJ
a2ZyZWUoYSk7CisJCXJldHVybiByZXQ7CisJfQorCisJYS0+ZGV2ID0gYXR0YWNobWVudC0+ZGV2
OworCUlOSVRfTElTVF9IRUFEKCZhLT5saXN0KTsKKworCWF0dGFjaG1lbnQtPnByaXYgPSBhOwor
CisJbXV0ZXhfbG9jaygmYnVmZmVyLT5sb2NrKTsKKwlsaXN0X2FkZCgmYS0+bGlzdCwgJmJ1ZmZl
ci0+YXR0YWNobWVudHMpOworCW11dGV4X3VubG9jaygmYnVmZmVyLT5sb2NrKTsKKworCXJldHVy
biAwOworfQorCitzdGF0aWMgdm9pZCBkbWFfaGVhcF9kZXRhY2goc3RydWN0IGRtYV9idWYgKmRt
YWJ1ZiwKKwkJCSAgICBzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICphdHRhY2htZW50KQorewor
CXN0cnVjdCBkbWFfaGVhcHNfYXR0YWNobWVudCAqYSA9IGF0dGFjaG1lbnQtPnByaXY7CisJc3Ry
dWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyID0gZG1hYnVmLT5wcml2OworCisJbXV0ZXhf
bG9jaygmYnVmZmVyLT5sb2NrKTsKKwlsaXN0X2RlbCgmYS0+bGlzdCk7CisJbXV0ZXhfdW5sb2Nr
KCZidWZmZXItPmxvY2spOworCisJc2dfZnJlZV90YWJsZSgmYS0+dGFibGUpOworCWtmcmVlKGEp
OworfQorCitzdGF0aWMKK3N0cnVjdCBzZ190YWJsZSAqZG1hX2hlYXBfbWFwX2RtYV9idWYoc3Ry
dWN0IGRtYV9idWZfYXR0YWNobWVudCAqYXR0YWNobWVudCwKKwkJCQkgICAgICBlbnVtIGRtYV9k
YXRhX2RpcmVjdGlvbiBkaXJlY3Rpb24pCit7CisJc3RydWN0IGRtYV9oZWFwc19hdHRhY2htZW50
ICphID0gYXR0YWNobWVudC0+cHJpdjsKKwlzdHJ1Y3Qgc2dfdGFibGUgKnRhYmxlOworCisJdGFi
bGUgPSAmYS0+dGFibGU7CisKKwlpZiAoIWRtYV9tYXBfc2coYXR0YWNobWVudC0+ZGV2LCB0YWJs
ZS0+c2dsLCB0YWJsZS0+bmVudHMsCisJCQlkaXJlY3Rpb24pKQorCQl0YWJsZSA9IEVSUl9QVFIo
LUVOT01FTSk7CisJcmV0dXJuIHRhYmxlOworfQorCitzdGF0aWMgdm9pZCBkbWFfaGVhcF91bm1h
cF9kbWFfYnVmKHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFjaG1lbnQsCisJCQkJICAg
c3RydWN0IHNnX3RhYmxlICp0YWJsZSwKKwkJCQkgICBlbnVtIGRtYV9kYXRhX2RpcmVjdGlvbiBk
aXJlY3Rpb24pCit7CisJZG1hX3VubWFwX3NnKGF0dGFjaG1lbnQtPmRldiwgdGFibGUtPnNnbCwg
dGFibGUtPm5lbnRzLCBkaXJlY3Rpb24pOworfQorCitzdGF0aWMgdm1fZmF1bHRfdCBkbWFfaGVh
cF92bV9mYXVsdChzdHJ1Y3Qgdm1fZmF1bHQgKnZtZikKK3sKKwlzdHJ1Y3Qgdm1fYXJlYV9zdHJ1
Y3QgKnZtYSA9IHZtZi0+dm1hOworCXN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKmJ1ZmZlciA9
IHZtYS0+dm1fcHJpdmF0ZV9kYXRhOworCisJdm1mLT5wYWdlID0gYnVmZmVyLT5wYWdlc1t2bWYt
PnBnb2ZmXTsKKwlnZXRfcGFnZSh2bWYtPnBhZ2UpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRp
YyBjb25zdCBzdHJ1Y3Qgdm1fb3BlcmF0aW9uc19zdHJ1Y3QgZG1hX2hlYXBfdm1fb3BzID0gewor
CS5mYXVsdCA9IGRtYV9oZWFwX3ZtX2ZhdWx0LAorfTsKKworc3RhdGljIGludCBkbWFfaGVhcF9t
bWFwKHN0cnVjdCBkbWFfYnVmICpkbWFidWYsIHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hKQor
eworCXN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKmJ1ZmZlciA9IGRtYWJ1Zi0+cHJpdjsKKwor
CWlmICgodm1hLT52bV9mbGFncyAmIChWTV9TSEFSRUQgfCBWTV9NQVlTSEFSRSkpID09IDApCisJ
CXJldHVybiAtRUlOVkFMOworCisJdm1hLT52bV9vcHMgPSAmZG1hX2hlYXBfdm1fb3BzOworCXZt
YS0+dm1fcHJpdmF0ZV9kYXRhID0gYnVmZmVyOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2
b2lkIGRtYV9oZWFwX2RtYV9idWZfcmVsZWFzZShzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmKQorewor
CXN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKmJ1ZmZlciA9IGRtYWJ1Zi0+cHJpdjsKKworCWRt
YV9oZWFwX2J1ZmZlcl9kZXN0cm95KGJ1ZmZlcik7Cit9CisKK3N0YXRpYyBpbnQgZG1hX2hlYXBf
ZG1hX2J1Zl9iZWdpbl9jcHVfYWNjZXNzKHN0cnVjdCBkbWFfYnVmICpkbWFidWYsCisJCQkJCSAg
ICAgZW51bSBkbWFfZGF0YV9kaXJlY3Rpb24gZGlyZWN0aW9uKQoreworCXN0cnVjdCBoZWFwX2hl
bHBlcl9idWZmZXIgKmJ1ZmZlciA9IGRtYWJ1Zi0+cHJpdjsKKwlzdHJ1Y3QgZG1hX2hlYXBzX2F0
dGFjaG1lbnQgKmE7CisJaW50IHJldCA9IDA7CisKKwltdXRleF9sb2NrKCZidWZmZXItPmxvY2sp
OworCisJaWYgKGJ1ZmZlci0+dm1hcF9jbnQpCisJCWludmFsaWRhdGVfa2VybmVsX3ZtYXBfcmFu
Z2UoYnVmZmVyLT52YWRkciwgYnVmZmVyLT5zaXplKTsKKworCWxpc3RfZm9yX2VhY2hfZW50cnko
YSwgJmJ1ZmZlci0+YXR0YWNobWVudHMsIGxpc3QpIHsKKwkJZG1hX3N5bmNfc2dfZm9yX2NwdShh
LT5kZXYsIGEtPnRhYmxlLnNnbCwgYS0+dGFibGUubmVudHMsCisJCQkJICAgIGRpcmVjdGlvbik7
CisJfQorCW11dGV4X3VubG9jaygmYnVmZmVyLT5sb2NrKTsKKworCXJldHVybiByZXQ7Cit9CisK
K3N0YXRpYyBpbnQgZG1hX2hlYXBfZG1hX2J1Zl9lbmRfY3B1X2FjY2VzcyhzdHJ1Y3QgZG1hX2J1
ZiAqZG1hYnVmLAorCQkJCQkgICBlbnVtIGRtYV9kYXRhX2RpcmVjdGlvbiBkaXJlY3Rpb24pCit7
CisJc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyID0gZG1hYnVmLT5wcml2OworCXN0
cnVjdCBkbWFfaGVhcHNfYXR0YWNobWVudCAqYTsKKworCW11dGV4X2xvY2soJmJ1ZmZlci0+bG9j
ayk7CisKKwlpZiAoYnVmZmVyLT52bWFwX2NudCkKKwkJZmx1c2hfa2VybmVsX3ZtYXBfcmFuZ2Uo
YnVmZmVyLT52YWRkciwgYnVmZmVyLT5zaXplKTsKKworCWxpc3RfZm9yX2VhY2hfZW50cnkoYSwg
JmJ1ZmZlci0+YXR0YWNobWVudHMsIGxpc3QpIHsKKwkJZG1hX3N5bmNfc2dfZm9yX2RldmljZShh
LT5kZXYsIGEtPnRhYmxlLnNnbCwgYS0+dGFibGUubmVudHMsCisJCQkJICAgICAgIGRpcmVjdGlv
bik7CisJfQorCW11dGV4X3VubG9jaygmYnVmZmVyLT5sb2NrKTsKKworCXJldHVybiAwOworfQor
CitzdGF0aWMgdm9pZCAqZG1hX2hlYXBfZG1hX2J1Zl92bWFwKHN0cnVjdCBkbWFfYnVmICpkbWFi
dWYpCit7CisJc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyID0gZG1hYnVmLT5wcml2
OworCXZvaWQgKnZhZGRyOworCisJbXV0ZXhfbG9jaygmYnVmZmVyLT5sb2NrKTsKKwl2YWRkciA9
IGRtYV9oZWFwX2J1ZmZlcl92bWFwX2dldChidWZmZXIpOworCW11dGV4X3VubG9jaygmYnVmZmVy
LT5sb2NrKTsKKworCXJldHVybiB2YWRkcjsKK30KKworc3RhdGljIHZvaWQgZG1hX2hlYXBfZG1h
X2J1Zl92dW5tYXAoc3RydWN0IGRtYV9idWYgKmRtYWJ1Ziwgdm9pZCAqdmFkZHIpCit7CisJc3Ry
dWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyID0gZG1hYnVmLT5wcml2OworCisJbXV0ZXhf
bG9jaygmYnVmZmVyLT5sb2NrKTsKKwlkbWFfaGVhcF9idWZmZXJfdm1hcF9wdXQoYnVmZmVyKTsK
KwltdXRleF91bmxvY2soJmJ1ZmZlci0+bG9jayk7Cit9CisKK2NvbnN0IHN0cnVjdCBkbWFfYnVm
X29wcyBoZWFwX2hlbHBlcl9vcHMgPSB7CisJLm1hcF9kbWFfYnVmID0gZG1hX2hlYXBfbWFwX2Rt
YV9idWYsCisJLnVubWFwX2RtYV9idWYgPSBkbWFfaGVhcF91bm1hcF9kbWFfYnVmLAorCS5tbWFw
ID0gZG1hX2hlYXBfbW1hcCwKKwkucmVsZWFzZSA9IGRtYV9oZWFwX2RtYV9idWZfcmVsZWFzZSwK
KwkuYXR0YWNoID0gZG1hX2hlYXBfYXR0YWNoLAorCS5kZXRhY2ggPSBkbWFfaGVhcF9kZXRhY2gs
CisJLmJlZ2luX2NwdV9hY2Nlc3MgPSBkbWFfaGVhcF9kbWFfYnVmX2JlZ2luX2NwdV9hY2Nlc3Ms
CisJLmVuZF9jcHVfYWNjZXNzID0gZG1hX2hlYXBfZG1hX2J1Zl9lbmRfY3B1X2FjY2VzcywKKwku
dm1hcCA9IGRtYV9oZWFwX2RtYV9idWZfdm1hcCwKKwkudnVubWFwID0gZG1hX2hlYXBfZG1hX2J1
Zl92dW5tYXAsCit9OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9kbWEtYnVmL2hlYXBzL2hlYXAtaGVs
cGVycy5oIGIvZHJpdmVycy9kbWEtYnVmL2hlYXBzL2hlYXAtaGVscGVycy5oCm5ldyBmaWxlIG1v
ZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uOTExYzkzMWY3ZjA2Ci0tLSAvZGV2L251bGwK
KysrIGIvZHJpdmVycy9kbWEtYnVmL2hlYXBzL2hlYXAtaGVscGVycy5oCkBAIC0wLDAgKzEsNTUg
QEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovCisvKgorICogRE1BQlVG
IEhlYXBzIGhlbHBlciBjb2RlCisgKgorICogQ29weXJpZ2h0IChDKSAyMDExIEdvb2dsZSwgSW5j
LgorICogQ29weXJpZ2h0IChDKSAyMDE5IExpbmFybyBMdGQuCisgKi8KKworI2lmbmRlZiBfSEVB
UF9IRUxQRVJTX0gKKyNkZWZpbmUgX0hFQVBfSEVMUEVSU19ICisKKyNpbmNsdWRlIDxsaW51eC9k
bWEtaGVhcC5oPgorI2luY2x1ZGUgPGxpbnV4L2xpc3QuaD4KKworLyoqCisgKiBzdHJ1Y3QgaGVh
cF9oZWxwZXJfYnVmZmVyIC0gaGVscGVyIGJ1ZmZlciBtZXRhZGF0YQorICogQGhlYXA6CQliYWNr
IHBvaW50ZXIgdG8gdGhlIGhlYXAgdGhlIGJ1ZmZlciBjYW1lIGZyb20KKyAqIEBkbWFidWY6CQli
YWNraW5nIGRtYS1idWYgZm9yIHRoaXMgYnVmZmVyCisgKiBAc2l6ZToJCXNpemUgb2YgdGhlIGJ1
ZmZlcgorICogQGZsYWdzOgkJYnVmZmVyIHNwZWNpZmljIGZsYWdzCisgKiBAcHJpdl92aXJ0CQlw
b2ludGVyIHRvIGhlYXAgc3BlY2lmaWMgcHJpdmF0ZSB2YWx1ZQorICogQGxvY2sJCW11dGV4dCB0
byBwcm90ZWN0IHRoZSBkYXRhIGluIHRoaXMgc3RydWN0dXJlCisgKiBAdm1hcF9jbnQJCWNvdW50
IG9mIHZtYXAgcmVmZXJlbmNlcyBvbiB0aGUgYnVmZmVyCisgKiBAdmFkZHIJCXZtYXAnZWQgdmly
dHVhbCBhZGRyZXNzCisgKiBAcGFnZWNvdW50CQludW1iZXIgb2YgcGFnZXMgaW4gdGhlIGJ1ZmZl
cgorICogQHBhZ2VzCQlsaXN0IG9mIHBhZ2UgcG9pbnRlcnMKKyAqIEBhdHRhY2htZW50cwkJbGlz
dCBvZiBkZXZpY2UgYXR0YWNobWVudHMKKyAqCisgKiBAZnJlZQkJaGVhcCBjYWxsYmFjayB0byBm
cmVlIHRoZSBidWZmZXIKKyAqLworc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciB7CisJc3RydWN0
IGRtYV9oZWFwICpoZWFwOworCXN0cnVjdCBkbWFfYnVmICpkbWFidWY7CisJc2l6ZV90IHNpemU7
CisJdW5zaWduZWQgbG9uZyBmbGFnczsKKworCXZvaWQgKnByaXZfdmlydDsKKwlzdHJ1Y3QgbXV0
ZXggbG9jazsKKwlpbnQgdm1hcF9jbnQ7CisJdm9pZCAqdmFkZHI7CisJcGdvZmZfdCBwYWdlY291
bnQ7CisJc3RydWN0IHBhZ2UgKipwYWdlczsKKwlzdHJ1Y3QgbGlzdF9oZWFkIGF0dGFjaG1lbnRz
OworCisJdm9pZCAoKmZyZWUpKHN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKmJ1ZmZlcik7Cit9
OworCit2b2lkIGluaXRfaGVhcF9oZWxwZXJfYnVmZmVyKHN0cnVjdCBoZWFwX2hlbHBlcl9idWZm
ZXIgKmJ1ZmZlciwKKwkJCSAgICAgdm9pZCAoKmZyZWUpKHN0cnVjdCBoZWFwX2hlbHBlcl9idWZm
ZXIgKikpOworCitzdHJ1Y3QgZG1hX2J1ZiAqaGVhcF9oZWxwZXJfZXhwb3J0X2RtYWJ1ZihzdHJ1
Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICpidWZmZXIsCisJCQkJCSAgaW50IGZkX2ZsYWdzKTsKKwor
ZXh0ZXJuIGNvbnN0IHN0cnVjdCBkbWFfYnVmX29wcyBoZWFwX2hlbHBlcl9vcHM7CisjZW5kaWYg
LyogX0hFQVBfSEVMUEVSU19IICovCi0tIAoyLjE3LjEKCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVs
QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWls
bWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
