Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id A61D0316A00
	for <lists+dri-devel@lfdr.de>; Wed, 10 Feb 2021 16:21:28 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2C0EC6EC9B;
	Wed, 10 Feb 2021 15:21:20 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ej1-x62f.google.com (mail-ej1-x62f.google.com
 [IPv6:2a00:1450:4864:20::62f])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1D8B16EC98
 for <dri-devel@lists.freedesktop.org>; Wed, 10 Feb 2021 15:21:18 +0000 (UTC)
Received: by mail-ej1-x62f.google.com with SMTP id lg21so4916302ejb.3
 for <dri-devel@lists.freedesktop.org>; Wed, 10 Feb 2021 07:21:17 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:subject:date:message-id:in-reply-to:references:mime-version
 :content-transfer-encoding;
 bh=i0DkTtmrG+IGB4KttN5exS51YhdY5oVcsPvg8YYZ9Qw=;
 b=NTPwDGMeYmN8vlv1uZmyUeZMFdDTqo0MnPHGevE89/sz1fn+MDQ0ttBHstWf6Inljn
 O7ThLuSwDOvcWgTlyD3yzuCeqPUMeBYjgtPXAM4PrRb60KUUCTGfYI76RXLM4mMa+g/W
 8IuUWb3VZbBTNp+agjdaJgLh5TNBSrUYUeIMu32EgtrfBofci8nis0aPp0wEw8w2DITN
 VlzwvfuuLQX0GzP4eryQgDNFCEz191mNaS//AD5cfcR8p3Ed/RqLSNYTbTM0gExrASzC
 02PID/xGeIt9u5aqaX4THDFkDyz5q33jjE+vvtnSvRdPzjxcT2H2esXzzJE649iwlsWr
 g1/w==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=i0DkTtmrG+IGB4KttN5exS51YhdY5oVcsPvg8YYZ9Qw=;
 b=IdNpJgrozBMhOuc/zIKW8dP42X5pW9W1rnscbG1jtrpBrei2txNRIeDKdzk6mLdK9E
 //C5iLI1XWe9BsTycj+LjCfjePf2MGAFWUYPp5VCU5zfyCYXDZRbyqxhU+EU2eQoCHfd
 PkxAPI+5oOYuaQ3ZW7MzDn9obHcSFhQ7zPiVh4uwK8P3ZSpKoL9dHixchbIcG4vrMgBv
 t15kR2aQ4OUf+dVdnuUXoCmrTAIuirPumxma88mNtSaDr3Ym4bNUrxBPRRU2GKQgOgYp
 IKJ1GmNRLZUji3TQCDnoYXN1cybbUZ710oJcJhgsIdW/pifehO5C5vx+CQfffqHD2YH8
 Z3WA==
X-Gm-Message-State: AOAM531uTbBq47YfJwSuD8Jv0siADbbOxF8tJY8ivANy/GJNWBHN6f/G
 KDRGPZYyJkXyweZM+D791p5FP17Qiwx+CA==
X-Google-Smtp-Source: ABdhPJyLfSnzYxk10Zj6TGiBvn8Guo+GbneHug4OCrKJBrnNzV98BAwPygk3Txo88ge5d2jPVyo0hg==
X-Received: by 2002:a17:906:b752:: with SMTP id
 fx18mr3514662ejb.17.1612970476636; 
 Wed, 10 Feb 2021 07:21:16 -0800 (PST)
Received: from abel.fritz.box ([2a02:908:1252:fb60:f16b:8c3:1c30:3103])
 by smtp.gmail.com with ESMTPSA id m7sm1447923ejk.52.2021.02.10.07.21.16
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Wed, 10 Feb 2021 07:21:16 -0800 (PST)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: dri-devel@lists.freedesktop.org,
	ray.huang@amd.com
Subject: [PATCH 2/3] drm/ttm: remove swap LRU
Date: Wed, 10 Feb 2021 16:21:13 +0100
Message-Id: <20210210152114.1134-2-christian.koenig@amd.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20210210152114.1134-1-christian.koenig@amd.com>
References: <20210210152114.1134-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW5zdGVhZCBldmljdCByb3VuZCByb2JpbiBmcm9tIGVhY2ggZGV2aWNlcyBTWVNURU0gYW5kIFRU
IGRvbWFpbi4KClNpZ25lZC1vZmYtYnk6IENocmlzdGlhbiBLw7ZuaWcgPGNocmlzdGlhbi5rb2Vu
aWdAYW1kLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5jICAgICAgICB8IDMx
ICsrLS0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm9fdXRpbC5jICAgfCAg
MSAtCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9kZXZpY2UuYyAgICB8IDU5ICsrKysrKysrKysr
KysrKysrKysrKy0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9kcnYuYyB8
ICAyICstCiBpbmNsdWRlL2RybS90dG0vdHRtX2JvX2FwaS5oICAgICAgICB8ICAxIC0KIGluY2x1
ZGUvZHJtL3R0bS90dG1fYm9fZHJpdmVyLmggICAgIHwgIDEgLQogaW5jbHVkZS9kcm0vdHRtL3R0
bV9kZXZpY2UuaCAgICAgICAgfCAgNyArLS0tCiA3IGZpbGVzIGNoYW5nZWQsIDUxIGluc2VydGlv
bnMoKyksIDUxIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90dG0v
dHRtX2JvLmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5jCmluZGV4IGQzMzU3OGExMTJi
NC4uYTFiZTg4YmUzNTdiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvLmMKQEAgLTczLDcgKzczLDYgQEAgc3Rh
dGljIHZvaWQgdHRtX2JvX2RlbF9mcm9tX2xydShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJv
KQogewogCXN0cnVjdCB0dG1fZGV2aWNlICpiZGV2ID0gYm8tPmJkZXY7CiAKLQlsaXN0X2RlbF9p
bml0KCZiby0+c3dhcCk7CiAJbGlzdF9kZWxfaW5pdCgmYm8tPmxydSk7CiAKIAlpZiAoYmRldi0+
ZnVuY3MtPmRlbF9mcm9tX2xydV9ub3RpZnkpCkBAIC0xMDQsMTQgKzEwMyw2IEBAIHZvaWQgdHRt
X2JvX21vdmVfdG9fbHJ1X3RhaWwoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAogCW1h
biA9IHR0bV9tYW5hZ2VyX3R5cGUoYmRldiwgbWVtLT5tZW1fdHlwZSk7CiAJbGlzdF9tb3ZlX3Rh
aWwoJmJvLT5scnUsICZtYW4tPmxydVtiby0+cHJpb3JpdHldKTsKLQlpZiAobWFuLT51c2VfdHQg
JiYgYm8tPnR0bSAmJgotCSAgICAhKGJvLT50dG0tPnBhZ2VfZmxhZ3MgJiAoVFRNX1BBR0VfRkxB
R19TRyB8Ci0JCQkJICAgICBUVE1fUEFHRV9GTEFHX1NXQVBQRUQpKSkgewotCQlzdHJ1Y3QgbGlz
dF9oZWFkICpzd2FwOwotCi0JCXN3YXAgPSAmdHRtX2dsb2Iuc3dhcF9scnVbYm8tPnByaW9yaXR5
XTsKLQkJbGlzdF9tb3ZlX3RhaWwoJmJvLT5zd2FwLCBzd2FwKTsKLQl9CiAKIAlpZiAoYmRldi0+
ZnVuY3MtPmRlbF9mcm9tX2xydV9ub3RpZnkpCiAJCWJkZXYtPmZ1bmNzLT5kZWxfZnJvbV9scnVf
bm90aWZ5KGJvKTsKQEAgLTEyNiw5ICsxMTcsNiBAQCB2b2lkIHR0bV9ib19tb3ZlX3RvX2xydV90
YWlsKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJCQl0dG1fYm9fYnVsa19tb3ZlX3Nl
dF9wb3MoJmJ1bGstPnZyYW1bYm8tPnByaW9yaXR5XSwgYm8pOwogCQkJYnJlYWs7CiAJCX0KLQkJ
aWYgKGJvLT50dG0gJiYgIShiby0+dHRtLT5wYWdlX2ZsYWdzICYKLQkJCQkgKFRUTV9QQUdFX0ZM
QUdfU0cgfCBUVE1fUEFHRV9GTEFHX1NXQVBQRUQpKSkKLQkJCXR0bV9ib19idWxrX21vdmVfc2V0
X3BvcygmYnVsay0+c3dhcFtiby0+cHJpb3JpdHldLCBibyk7CiAJfQogfQogRVhQT1JUX1NZTUJP
TCh0dG1fYm9fbW92ZV90b19scnVfdGFpbCk7CkBAIC0xNjYsMjAgKzE1NCw2IEBAIHZvaWQgdHRt
X2JvX2J1bGtfbW92ZV9scnVfdGFpbChzdHJ1Y3QgdHRtX2xydV9idWxrX21vdmUgKmJ1bGspCiAJ
CWxpc3RfYnVsa19tb3ZlX3RhaWwoJm1hbi0+bHJ1W2ldLCAmcG9zLT5maXJzdC0+bHJ1LAogCQkJ
CSAgICAmcG9zLT5sYXN0LT5scnUpOwogCX0KLQotCWZvciAoaSA9IDA7IGkgPCBUVE1fTUFYX0JP
X1BSSU9SSVRZOyArK2kpIHsKLQkJc3RydWN0IHR0bV9scnVfYnVsa19tb3ZlX3BvcyAqcG9zID0g
JmJ1bGstPnN3YXBbaV07Ci0JCXN0cnVjdCBsaXN0X2hlYWQgKmxydTsKLQotCQlpZiAoIXBvcy0+
Zmlyc3QpCi0JCQljb250aW51ZTsKLQotCQlkbWFfcmVzdl9hc3NlcnRfaGVsZChwb3MtPmZpcnN0
LT5iYXNlLnJlc3YpOwotCQlkbWFfcmVzdl9hc3NlcnRfaGVsZChwb3MtPmxhc3QtPmJhc2UucmVz
dik7Ci0KLQkJbHJ1ID0gJnR0bV9nbG9iLnN3YXBfbHJ1W2ldOwotCQlsaXN0X2J1bGtfbW92ZV90
YWlsKGxydSwgJnBvcy0+Zmlyc3QtPnN3YXAsICZwb3MtPmxhc3QtPnN3YXApOwotCX0KIH0KIEVY
UE9SVF9TWU1CT0wodHRtX2JvX2J1bGtfbW92ZV9scnVfdGFpbCk7CiAKQEAgLTEwNTYsNyArMTAz
MCw2IEBAIGludCB0dG1fYm9faW5pdF9yZXNlcnZlZChzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwK
IAlrcmVmX2luaXQoJmJvLT5rcmVmKTsKIAlJTklUX0xJU1RfSEVBRCgmYm8tPmxydSk7CiAJSU5J
VF9MSVNUX0hFQUQoJmJvLT5kZGVzdHJveSk7Ci0JSU5JVF9MSVNUX0hFQUQoJmJvLT5zd2FwKTsK
IAliby0+YmRldiA9IGJkZXY7CiAJYm8tPnR5cGUgPSB0eXBlOwogCWJvLT5tZW0ubWVtX3R5cGUg
PSBUVE1fUExfU1lTVEVNOwpAQCAtMTE5MSw2ICsxMTY0LDEwIEBAIGludCB0dG1fYm9fc3dhcG91
dChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLCBzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHgg
KmN0eCwKIAlib29sIGxvY2tlZDsKIAlpbnQgcmV0OwogCisJaWYgKCFiby0+dHRtIHx8IGJvLT50
dG0tPnBhZ2VfZmxhZ3MgJiAoVFRNX1BBR0VfRkxBR19TRyB8CisJCQkJCSAgICAgICBUVE1fUEFH
RV9GTEFHX1NXQVBQRUQpKQorCQlyZXR1cm4gZmFsc2U7CisKIAlpZiAoIXR0bV9ib19ldmljdF9z
d2Fwb3V0X2FsbG93YWJsZShibywgY3R4LCAmbG9ja2VkLCBOVUxMKSkKIAkJcmV0dXJuIC1FQlVT
WTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm9fdXRpbC5jIGIvZHJp
dmVycy9ncHUvZHJtL3R0bS90dG1fYm9fdXRpbC5jCmluZGV4IDAzMWU1ODE5ZmVjNC4uYTJhMTdj
ODRjZWIzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGlsLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm9fdXRpbC5jCkBAIC0zMDMsNyArMzAzLDYgQEAg
c3RhdGljIGludCB0dG1fYnVmZmVyX29iamVjdF90cmFuc2ZlcihzdHJ1Y3QgdHRtX2J1ZmZlcl9v
YmplY3QgKmJvLAogCWF0b21pY19pbmMoJnR0bV9nbG9iLmJvX2NvdW50KTsKIAlJTklUX0xJU1Rf
SEVBRCgmZmJvLT5iYXNlLmRkZXN0cm95KTsKIAlJTklUX0xJU1RfSEVBRCgmZmJvLT5iYXNlLmxy
dSk7Ci0JSU5JVF9MSVNUX0hFQUQoJmZiby0+YmFzZS5zd2FwKTsKIAlmYm8tPmJhc2UubW92aW5n
ID0gTlVMTDsKIAlkcm1fdm1hX25vZGVfcmVzZXQoJmZiby0+YmFzZS5iYXNlLnZtYV9ub2RlKTsK
IApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fZGV2aWNlLmMgYi9kcml2ZXJz
L2dwdS9kcm0vdHRtL3R0bV9kZXZpY2UuYwppbmRleCBkZmMyYTdlNGU0OTAuLjUwNjRmN2RiNzhh
YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fZGV2aWNlLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL3R0bS90dG1fZGV2aWNlLmMKQEAgLTY3LDcgKzY3LDYgQEAgc3RhdGljIGlu
dCB0dG1fZ2xvYmFsX2luaXQodm9pZCkKIAl1bnNpZ25lZCBsb25nIG51bV9wYWdlczsKIAlzdHJ1
Y3Qgc3lzaW5mbyBzaTsKIAlpbnQgcmV0ID0gMDsKLQl1bnNpZ25lZCBpOwogCiAJbXV0ZXhfbG9j
aygmdHRtX2dsb2JhbF9tdXRleCk7CiAJaWYgKCsrdHRtX2dsb2JfdXNlX2NvdW50ID4gMSkKQEAg
LTkwLDggKzg5LDYgQEAgc3RhdGljIGludCB0dG1fZ2xvYmFsX2luaXQodm9pZCkKIAkJZ290byBv
dXQ7CiAJfQogCi0JZm9yIChpID0gMDsgaSA8IFRUTV9NQVhfQk9fUFJJT1JJVFk7ICsraSkKLQkJ
SU5JVF9MSVNUX0hFQUQoJmdsb2ItPnN3YXBfbHJ1W2ldKTsKIAlJTklUX0xJU1RfSEVBRCgmZ2xv
Yi0+ZGV2aWNlX2xpc3QpOwogCWF0b21pY19zZXQoJmdsb2ItPmJvX2NvdW50LCAwKTsKIApAQCAt
MTA5LDI3ICsxMDYsNTkgQEAgc3RhdGljIGludCB0dG1fZ2xvYmFsX2luaXQodm9pZCkKIGxvbmcg
dHRtX2dsb2JhbF9zd2Fwb3V0KHN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0eCAqY3R4LCBnZnBfdCBn
ZnBfZmxhZ3MpCiB7CiAJc3RydWN0IHR0bV9nbG9iYWwgKmdsb2IgPSAmdHRtX2dsb2I7CisJc3Ry
dWN0IHR0bV9kZXZpY2UgKmJkZXY7CisJaW50IHJldCA9IC1FQlVTWTsKKworCW11dGV4X2xvY2so
JnR0bV9nbG9iYWxfbXV0ZXgpOworCWxpc3RfZm9yX2VhY2hfZW50cnkoYmRldiwgJmdsb2ItPmRl
dmljZV9saXN0LCBkZXZpY2VfbGlzdCkgeworCQlyZXQgPSB0dG1fZGV2aWNlX3N3YXBvdXQoYmRl
diwgY3R4LCBnZnBfZmxhZ3MpOworCQlpZiAocmV0ID4gMCkgeworCQkJbGlzdF9tb3ZlX3RhaWwo
JmJkZXYtPmRldmljZV9saXN0LCAmZ2xvYi0+ZGV2aWNlX2xpc3QpOworCQkJYnJlYWs7CisJCX0K
Kwl9CisJbXV0ZXhfdW5sb2NrKCZ0dG1fZ2xvYmFsX211dGV4KTsKKwlyZXR1cm4gcmV0OworfQor
RVhQT1JUX1NZTUJPTCh0dG1fZ2xvYmFsX3N3YXBvdXQpOworCitsb25nIHR0bV9kZXZpY2Vfc3dh
cG91dChzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4ICpj
dHgsCisJCQlnZnBfdCBnZnBfZmxhZ3MpCit7CisJc3RydWN0IHR0bV9nbG9iYWwgKmdsb2IgPSAm
dHRtX2dsb2I7CisJc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYW47CiAJc3RydWN0IHR0
bV9idWZmZXJfb2JqZWN0ICpibzsKLQl1bnNpZ25lZCBpOworCXVuc2lnbmVkIGksIGo7CiAJaW50
IHJldDsKIAogCXNwaW5fbG9jaygmZ2xvYi0+bHJ1X2xvY2spOwotCWZvciAoaSA9IDA7IGkgPCBU
VE1fTUFYX0JPX1BSSU9SSVRZOyArK2kpIHsKLQkJbGlzdF9mb3JfZWFjaF9lbnRyeShibywgJmds
b2ItPnN3YXBfbHJ1W2ldLCBzd2FwKSB7Ci0JCQl1aW50MzJfdCBudW1fcGFnZXMgPSBiby0+dHRt
LT5udW1fcGFnZXM7Ci0KLQkJCXJldCA9IHR0bV9ib19zd2Fwb3V0KGJvLCBjdHgsIGdmcF9mbGFn
cyk7Ci0JCQkvKiB0dG1fYm9fc3dhcG91dCBoYXMgZHJvcHBlZCB0aGUgbHJ1X2xvY2sgKi8KLQkJ
CWlmICghcmV0KQotCQkJCXJldHVybiBudW1fcGFnZXM7Ci0JCQlpZiAocmV0ICE9IC1FQlVTWSkK
LQkJCQlyZXR1cm4gcmV0OworCWZvciAoaSA9IFRUTV9QTF9TWVNURU07IGkgPCBUVE1fTlVNX01F
TV9UWVBFUzsgKytpKSB7CisJCW1hbiA9IHR0bV9tYW5hZ2VyX3R5cGUoYmRldiwgaSk7CisJCWlm
ICghbWFuIHx8ICFtYW4tPnVzZV90dCkKKwkJCWNvbnRpbnVlOworCisJCWZvciAoaiA9IDA7IGog
PCBUVE1fTUFYX0JPX1BSSU9SSVRZOyArK2opIHsKKwkJCWxpc3RfZm9yX2VhY2hfZW50cnkoYm8s
ICZtYW4tPmxydVtqXSwgbHJ1KSB7CisJCQkJbG9uZyBudW1fcGFnZXMgPSBiby0+dHRtLT5udW1f
cGFnZXM7CisKKwkJCQlpZiAoIWJvLT50dG0gfHwKKwkJCQkgICAgYm8tPnR0bS0+cGFnZV9mbGFn
cyAmIFRUTV9QQUdFX0ZMQUdfU0cgfHwKKwkJCQkgICAgYm8tPnR0bS0+cGFnZV9mbGFncyAmIFRU
TV9QQUdFX0ZMQUdfU1dBUFBFRCkKKwkJCQkJY29udGludWU7CisKKwkJCQlyZXQgPSB0dG1fYm9f
c3dhcG91dChibywgY3R4LCBnZnBfZmxhZ3MpOworCQkJCS8qIHR0bV9ib19zd2Fwb3V0IGhhcyBk
cm9wcGVkIHRoZSBscnVfbG9jayAqLworCQkJCWlmICghcmV0KQorCQkJCQlyZXR1cm4gbnVtX3Bh
Z2VzOworCQkJCWlmIChyZXQgIT0gLUVCVVNZKQorCQkJCQlyZXR1cm4gcmV0OworCQkJfQogCQl9
CiAJfQogCXNwaW5fdW5sb2NrKCZnbG9iLT5scnVfbG9jayk7CiAJcmV0dXJuIDA7CiB9Ci1FWFBP
UlRfU1lNQk9MKHR0bV9nbG9iYWxfc3dhcG91dCk7CitFWFBPUlRfU1lNQk9MKHR0bV9kZXZpY2Vf
c3dhcG91dCk7CiAKIHN0YXRpYyB2b2lkIHR0bV9pbml0X3N5c21hbihzdHJ1Y3QgdHRtX2Rldmlj
ZSAqYmRldikKIHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2Ry
di5jIGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfZHJ2LmMKaW5kZXggMDFkYTM1NWI4
NmYzLi5jZWY4OTYxMjYzNjEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13
Z2Z4X2Rydi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2Rydi5jCkBAIC0x
Mzg0LDcgKzEzODQsNyBAQCBzdGF0aWMgaW50IHZtd19wbV9mcmVlemUoc3RydWN0IGRldmljZSAq
a2RldikKIAl2bXdfZXhlY2J1Zl9yZWxlYXNlX3Bpbm5lZF9ibyhkZXZfcHJpdik7CiAJdm13X3Jl
c291cmNlX2V2aWN0X2FsbChkZXZfcHJpdik7CiAJdm13X3JlbGVhc2VfZGV2aWNlX2Vhcmx5KGRl
dl9wcml2KTsKLQl3aGlsZSAodHRtX2dsb2JhbF9zd2Fwb3V0KCZjdHgsIEdGUF9LRVJORUwpID4g
MCk7CisJd2hpbGUgKHR0bV9kZXZpY2Vfc3dhcG91dCgmZGV2X3ByaXYtPmJkZXYsICZjdHgsIEdG
UF9LRVJORUwpID09IDApOwogCWlmIChkZXZfcHJpdi0+ZW5hYmxlX2ZiKQogCQl2bXdfZmlmb19y
ZXNvdXJjZV9kZWMoZGV2X3ByaXYpOwogCWlmIChhdG9taWNfcmVhZCgmZGV2X3ByaXYtPm51bV9m
aWZvX3Jlc291cmNlcykgIT0gMCkgewpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0vdHRtL3R0bV9i
b19hcGkuaCBiL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmgKaW5kZXggNTA0NGFjMzMwODU4
Li4zNTg3ZjY2MGU4ZjQgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmgK
KysrIGIvaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19hcGkuaApAQCAtMTQ0LDcgKzE0NCw2IEBAIHN0
cnVjdCB0dG1fYnVmZmVyX29iamVjdCB7CiAKIAlzdHJ1Y3QgbGlzdF9oZWFkIGxydTsKIAlzdHJ1
Y3QgbGlzdF9oZWFkIGRkZXN0cm95OwotCXN0cnVjdCBsaXN0X2hlYWQgc3dhcDsKIAogCS8qKgog
CSAqIE1lbWJlcnMgcHJvdGVjdGVkIGJ5IGEgYm8gcmVzZXJ2YXRpb24uCmRpZmYgLS1naXQgYS9p
bmNsdWRlL2RybS90dG0vdHRtX2JvX2RyaXZlci5oIGIvaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19k
cml2ZXIuaAppbmRleCA4OTU5YzAwNzVjZmQuLmQwMDdmZWVmNzY3NiAxMDA2NDQKLS0tIGEvaW5j
bHVkZS9kcm0vdHRtL3R0bV9ib19kcml2ZXIuaAorKysgYi9pbmNsdWRlL2RybS90dG0vdHRtX2Jv
X2RyaXZlci5oCkBAIC02OSw3ICs2OSw2IEBAIHN0cnVjdCB0dG1fbHJ1X2J1bGtfbW92ZV9wb3Mg
ewogc3RydWN0IHR0bV9scnVfYnVsa19tb3ZlIHsKIAlzdHJ1Y3QgdHRtX2xydV9idWxrX21vdmVf
cG9zIHR0W1RUTV9NQVhfQk9fUFJJT1JJVFldOwogCXN0cnVjdCB0dG1fbHJ1X2J1bGtfbW92ZV9w
b3MgdnJhbVtUVE1fTUFYX0JPX1BSSU9SSVRZXTsKLQlzdHJ1Y3QgdHRtX2xydV9idWxrX21vdmVf
cG9zIHN3YXBbVFRNX01BWF9CT19QUklPUklUWV07CiB9OwogCiAvKgpkaWZmIC0tZ2l0IGEvaW5j
bHVkZS9kcm0vdHRtL3R0bV9kZXZpY2UuaCBiL2luY2x1ZGUvZHJtL3R0bS90dG1fZGV2aWNlLmgK
aW5kZXggNmEwYjI2N2Q0ZmU2Li5jZGE2ZWZiNGMzNGIgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvZHJt
L3R0bS90dG1fZGV2aWNlLmgKKysrIGIvaW5jbHVkZS9kcm0vdHRtL3R0bV9kZXZpY2UuaApAQCAt
NjMsMTEgKzYzLDYgQEAgZXh0ZXJuIHN0cnVjdCB0dG1fZ2xvYmFsIHsKIAkgKi8KIAlzdHJ1Y3Qg
bGlzdF9oZWFkIGRldmljZV9saXN0OwogCi0JLyoqCi0JICogUHJvdGVjdGVkIGJ5IHRoZSBscnVf
bG9jay4KLQkgKi8KLQlzdHJ1Y3QgbGlzdF9oZWFkIHN3YXBfbHJ1W1RUTV9NQVhfQk9fUFJJT1JJ
VFldOwotCiAJLyoqCiAJICogSW50ZXJuYWwgcHJvdGVjdGlvbi4KIAkgKi8KQEAgLTI5OCw2ICsy
OTMsOCBAQCBzdHJ1Y3QgdHRtX2RldmljZSB7CiB9OwogCiBsb25nIHR0bV9nbG9iYWxfc3dhcG91
dChzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHggKmN0eCwgZ2ZwX3QgZ2ZwX2ZsYWdzKTsKK2xvbmcg
dHRtX2RldmljZV9zd2Fwb3V0KHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LCBzdHJ1Y3QgdHRtX29w
ZXJhdGlvbl9jdHggKmN0eCwKKwkJICAgICAgIGdmcF90IGdmcF9mbGFncyk7CiAKIHN0YXRpYyBp
bmxpbmUgc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICoKIHR0bV9tYW5hZ2VyX3R5cGUoc3Ry
dWN0IHR0bV9kZXZpY2UgKmJkZXYsIGludCBtZW1fdHlwZSkKLS0gCjIuMjUuMQoKX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcg
bGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRl
c2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVsCg==
