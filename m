Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 45C76D3AA6
	for <lists+dri-devel@lfdr.de>; Fri, 11 Oct 2019 10:17:45 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CDBB06EBCA;
	Fri, 11 Oct 2019 08:17:41 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 851E16EBCA;
 Fri, 11 Oct 2019 08:17:40 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx07.intmail.prod.int.phx2.redhat.com
 [10.5.11.22])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id B3BC618CB8E0;
 Fri, 11 Oct 2019 08:17:39 +0000 (UTC)
Received: from jason-ThinkPad-X1-Carbon-6th.redhat.com
 (ovpn-12-241.pek2.redhat.com [10.72.12.241])
 by smtp.corp.redhat.com (Postfix) with ESMTP id F13B8100EBDE;
 Fri, 11 Oct 2019 08:17:07 +0000 (UTC)
From: Jason Wang <jasowang@redhat.com>
To: kvm@vger.kernel.org, linux-s390@vger.kernel.org,
 linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org,
 intel-gfx@lists.freedesktop.org, intel-gvt-dev@lists.freedesktop.org,
 kwankhede@nvidia.com, alex.williamson@redhat.com, mst@redhat.com,
 tiwei.bie@intel.com
Subject: [PATCH V3 1/7] mdev: class id support
Date: Fri, 11 Oct 2019 16:15:51 +0800
Message-Id: <20191011081557.28302-2-jasowang@redhat.com>
In-Reply-To: <20191011081557.28302-1-jasowang@redhat.com>
References: <20191011081557.28302-1-jasowang@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.22
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.6.2
 (mx1.redhat.com [10.5.110.63]); Fri, 11 Oct 2019 08:17:40 +0000 (UTC)
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: christophe.de.dinechin@gmail.com, sebott@linux.ibm.com, airlied@linux.ie,
 Jason Wang <jasowang@redhat.com>, heiko.carstens@de.ibm.com,
 kevin.tian@intel.com, virtualization@lists.linux-foundation.org,
 rob.miller@broadcom.com, lulu@redhat.com, eperezma@redhat.com,
 pasic@linux.ibm.com, borntraeger@de.ibm.com, haotian.wang@sifive.com,
 zhi.a.wang@intel.com, farman@linux.ibm.com, idos@mellanox.com,
 gor@linux.ibm.com, cunming.liang@intel.com, rodrigo.vivi@intel.com,
 xiao.w.wang@intel.com, freude@linux.ibm.com, parav@mellanox.com,
 zhihong.wang@intel.com, akrowiak@linux.ibm.com, netdev@vger.kernel.org,
 cohuck@redhat.com, oberpar@linux.ibm.com, maxime.coquelin@redhat.com,
 lingshan.zhu@intel.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

TWRldiBidXMgb25seSBzdXBwb3J0cyB2ZmlvIGRyaXZlciByaWdodCBub3csIHNvIGl0IGRvZXNu
J3QgaW1wbGVtZW50Cm1hdGNoIG1ldGhvZC4gQnV0IGluIHRoZSBmdXR1cmUsIHdlIG1heSBhZGQg
ZHJpdmVycyBvdGhlciB0aGFuIHZmaW8sCnRoZSBmaXJzdCBkcml2ZXIgY291bGQgYmUgdmlydGlv
LW1kZXYuIFRoaXMgbWVhbnMgd2UgbmVlZCB0byBhZGQKZGV2aWNlIGNsYXNzIGlkIHN1cHBvcnQg
aW4gYnVzIG1hdGNoIG1ldGhvZCB0byBwYWlyIHRoZSBtZGV2IGRldmljZQphbmQgbWRldiBkcml2
ZXIgY29ycmVjdGx5LgoKU28gdGhpcyBwYXRjaCBhZGRzIGlkX3RhYmxlIHRvIG1kZXZfZHJpdmVy
IGFuZCBjbGFzc19pZCBmb3IgbWRldgpkZXZpY2Ugd2l0aCB0aGUgbWF0Y2ggbWV0aG9kIGZvciBt
ZGV2IGJ1cy4KClNpZ25lZC1vZmYtYnk6IEphc29uIFdhbmcgPGphc293YW5nQHJlZGhhdC5jb20+
Ci0tLQogRG9jdW1lbnRhdGlvbi9kcml2ZXItYXBpL3ZmaW8tbWVkaWF0ZWQtZGV2aWNlLnJzdCB8
ICA3ICsrKysrKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9rdm1ndC5jICAgICAgICAgICAg
ICAgICAgfCAgMSArCiBkcml2ZXJzL3MzOTAvY2lvL3ZmaW9fY2N3X29wcy5jICAgICAgICAgICAg
ICAgICAgIHwgIDEgKwogZHJpdmVycy9zMzkwL2NyeXB0by92ZmlvX2FwX29wcy5jICAgICAgICAg
ICAgICAgICB8ICAxICsKIGRyaXZlcnMvdmZpby9tZGV2L21kZXZfY29yZS5jICAgICAgICAgICAg
ICAgICAgICAgfCAxMSArKysrKysrKysrKwogZHJpdmVycy92ZmlvL21kZXYvbWRldl9kcml2ZXIu
YyAgICAgICAgICAgICAgICAgICB8IDE0ICsrKysrKysrKysrKysrCiBkcml2ZXJzL3ZmaW8vbWRl
di9tZGV2X3ByaXZhdGUuaCAgICAgICAgICAgICAgICAgIHwgIDEgKwogZHJpdmVycy92ZmlvL21k
ZXYvdmZpb19tZGV2LmMgICAgICAgICAgICAgICAgICAgICB8ICA2ICsrKysrKwogaW5jbHVkZS9s
aW51eC9tZGV2LmggICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICA4ICsrKysrKysrCiBp
bmNsdWRlL2xpbnV4L21vZF9kZXZpY2V0YWJsZS5oICAgICAgICAgICAgICAgICAgIHwgIDggKysr
KysrKysKIHNhbXBsZXMvdmZpby1tZGV2L21ib2Nocy5jICAgICAgICAgICAgICAgICAgICAgICAg
fCAgMSArCiBzYW1wbGVzL3ZmaW8tbWRldi9tZHB5LmMgICAgICAgICAgICAgICAgICAgICAgICAg
IHwgIDEgKwogc2FtcGxlcy92ZmlvLW1kZXYvbXR0eS5jICAgICAgICAgICAgICAgICAgICAgICAg
ICB8ICAxICsKIDEzIGZpbGVzIGNoYW5nZWQsIDYwIGluc2VydGlvbnMoKyksIDEgZGVsZXRpb24o
LSkKCmRpZmYgLS1naXQgYS9Eb2N1bWVudGF0aW9uL2RyaXZlci1hcGkvdmZpby1tZWRpYXRlZC1k
ZXZpY2UucnN0IGIvRG9jdW1lbnRhdGlvbi9kcml2ZXItYXBpL3ZmaW8tbWVkaWF0ZWQtZGV2aWNl
LnJzdAppbmRleCAyNWViN2Q1YjgzNGIuLjIwMzVlNDhkYTdiMiAxMDA2NDQKLS0tIGEvRG9jdW1l
bnRhdGlvbi9kcml2ZXItYXBpL3ZmaW8tbWVkaWF0ZWQtZGV2aWNlLnJzdAorKysgYi9Eb2N1bWVu
dGF0aW9uL2RyaXZlci1hcGkvdmZpby1tZWRpYXRlZC1kZXZpY2UucnN0CkBAIC0xMDIsMTIgKzEw
MiwxNCBAQCBzdHJ1Y3R1cmUgdG8gcmVwcmVzZW50IGEgbWVkaWF0ZWQgZGV2aWNlJ3MgZHJpdmVy
OjoKICAgICAgICogQHByb2JlOiBjYWxsZWQgd2hlbiBuZXcgZGV2aWNlIGNyZWF0ZWQKICAgICAg
ICogQHJlbW92ZTogY2FsbGVkIHdoZW4gZGV2aWNlIHJlbW92ZWQKICAgICAgICogQGRyaXZlcjog
ZGV2aWNlIGRyaXZlciBzdHJ1Y3R1cmUKKyAgICAgICogQGlkX3RhYmxlOiB0aGUgaWRzIHNlcnZp
Y2VkIGJ5IHRoaXMgZHJpdmVyCiAgICAgICAqLwogICAgICBzdHJ1Y3QgbWRldl9kcml2ZXIgewog
CSAgICAgY29uc3QgY2hhciAqbmFtZTsKIAkgICAgIGludCAgKCpwcm9iZSkgIChzdHJ1Y3QgZGV2
aWNlICpkZXYpOwogCSAgICAgdm9pZCAoKnJlbW92ZSkgKHN0cnVjdCBkZXZpY2UgKmRldik7CiAJ
ICAgICBzdHJ1Y3QgZGV2aWNlX2RyaXZlciAgICBkcml2ZXI7CisJICAgICBjb25zdCBzdHJ1Y3Qg
bWRldl9jbGFzc19pZCAqaWRfdGFibGU7CiAgICAgIH07CiAKIEEgbWVkaWF0ZWQgYnVzIGRyaXZl
ciBmb3IgbWRldiBzaG91bGQgdXNlIHRoaXMgc3RydWN0dXJlIGluIHRoZSBmdW5jdGlvbiBjYWxs
cwpAQCAtMTY1LDEyICsxNjcsMTUgQEAgcmVnaXN0ZXIgaXRzZWxmIHdpdGggdGhlIG1kZXYgY29y
ZSBkcml2ZXI6OgogCWV4dGVybiBpbnQgIG1kZXZfcmVnaXN0ZXJfZGV2aWNlKHN0cnVjdCBkZXZp
Y2UgKmRldiwKIAkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3Qg
bWRldl9wYXJlbnRfb3BzICpvcHMpOwogCitJdCBpcyBhbHNvIHJlcXVpcmVkIHRvIHNwZWNpZnkg
dGhlIGNsYXNzX2lkIHRocm91Z2g6OgorCisJZXh0ZXJuIGludCBtZGV2X3NldF9jbGFzcyhzdHJ1
Y3QgZGV2aWNlICpkZXYsIHUxNiBpZCk7CisKIEhvd2V2ZXIsIHRoZSBtZGV2X3BhcmVudF9vcHMg
c3RydWN0dXJlIGlzIG5vdCByZXF1aXJlZCBpbiB0aGUgZnVuY3Rpb24gY2FsbAogdGhhdCBhIGRy
aXZlciBzaG91bGQgdXNlIHRvIHVucmVnaXN0ZXIgaXRzZWxmIHdpdGggdGhlIG1kZXYgY29yZSBk
cml2ZXI6OgogCiAJZXh0ZXJuIHZvaWQgbWRldl91bnJlZ2lzdGVyX2RldmljZShzdHJ1Y3QgZGV2
aWNlICpkZXYpOwogCi0KIE1lZGlhdGVkIERldmljZSBNYW5hZ2VtZW50IEludGVyZmFjZSBUaHJv
dWdoIHN5c2ZzCiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQva3ZtZ3QuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9rdm1ndC5jCmluZGV4IDM0M2Q3OWMxY2I3ZS4uMTdlOWQ0
NjM0Yzg0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQva3ZtZ3QuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQva3ZtZ3QuYwpAQCAtNjc4LDYgKzY3OCw3IEBAIHN0
YXRpYyBpbnQgaW50ZWxfdmdwdV9jcmVhdGUoc3RydWN0IGtvYmplY3QgKmtvYmosIHN0cnVjdCBt
ZGV2X2RldmljZSAqbWRldikKIAkJICAgICBkZXZfbmFtZShtZGV2X2RldihtZGV2KSkpOwogCXJl
dCA9IDA7CiAKKwltZGV2X3NldF9jbGFzcyhtZGV2LCBNREVWX0lEX1ZGSU8pOwogb3V0OgogCXJl
dHVybiByZXQ7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL3MzOTAvY2lvL3ZmaW9fY2N3X29wcy5j
IGIvZHJpdmVycy9zMzkwL2Npby92ZmlvX2Njd19vcHMuYwppbmRleCBmMGQ3MWFiNzdjNTAuLmI1
ZDIyMzg4MmM2YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9zMzkwL2Npby92ZmlvX2Njd19vcHMuYwor
KysgYi9kcml2ZXJzL3MzOTAvY2lvL3ZmaW9fY2N3X29wcy5jCkBAIC0xMjksNiArMTI5LDcgQEAg
c3RhdGljIGludCB2ZmlvX2Njd19tZGV2X2NyZWF0ZShzdHJ1Y3Qga29iamVjdCAqa29iaiwgc3Ry
dWN0IG1kZXZfZGV2aWNlICptZGV2KQogCQkJICAgcHJpdmF0ZS0+c2NoLT5zY2hpZC5zc2lkLAog
CQkJICAgcHJpdmF0ZS0+c2NoLT5zY2hpZC5zY2hfbm8pOwogCisJbWRldl9zZXRfY2xhc3MobWRl
diwgTURFVl9JRF9WRklPKTsKIAlyZXR1cm4gMDsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9z
MzkwL2NyeXB0by92ZmlvX2FwX29wcy5jIGIvZHJpdmVycy9zMzkwL2NyeXB0by92ZmlvX2FwX29w
cy5jCmluZGV4IDVjMGY1M2M2ZGRlNy4uNDdkZjFjNTkzYzM1IDEwMDY0NAotLS0gYS9kcml2ZXJz
L3MzOTAvY3J5cHRvL3ZmaW9fYXBfb3BzLmMKKysrIGIvZHJpdmVycy9zMzkwL2NyeXB0by92Zmlv
X2FwX29wcy5jCkBAIC0zNDMsNiArMzQzLDcgQEAgc3RhdGljIGludCB2ZmlvX2FwX21kZXZfY3Jl
YXRlKHN0cnVjdCBrb2JqZWN0ICprb2JqLCBzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYpCiAJbGlz
dF9hZGQoJm1hdHJpeF9tZGV2LT5ub2RlLCAmbWF0cml4X2Rldi0+bWRldl9saXN0KTsKIAltdXRl
eF91bmxvY2soJm1hdHJpeF9kZXYtPmxvY2spOwogCisJbWRldl9zZXRfY2xhc3MobWRldiwgTURF
Vl9JRF9WRklPKTsKIAlyZXR1cm4gMDsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy92ZmlvL21k
ZXYvbWRldl9jb3JlLmMgYi9kcml2ZXJzL3ZmaW8vbWRldi9tZGV2X2NvcmUuYwppbmRleCBiNTU4
ZDRjZmQwODIuLjcyNGU5Yjk4NDFkOCAxMDA2NDQKLS0tIGEvZHJpdmVycy92ZmlvL21kZXYvbWRl
dl9jb3JlLmMKKysrIGIvZHJpdmVycy92ZmlvL21kZXYvbWRldl9jb3JlLmMKQEAgLTQ1LDYgKzQ1
LDEyIEBAIHZvaWQgbWRldl9zZXRfZHJ2ZGF0YShzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYsIHZv
aWQgKmRhdGEpCiB9CiBFWFBPUlRfU1lNQk9MKG1kZXZfc2V0X2RydmRhdGEpOwogCit2b2lkIG1k
ZXZfc2V0X2NsYXNzKHN0cnVjdCBtZGV2X2RldmljZSAqbWRldiwgdTE2IGlkKQoreworCW1kZXYt
PmNsYXNzX2lkID0gaWQ7Cit9CitFWFBPUlRfU1lNQk9MKG1kZXZfc2V0X2NsYXNzKTsKKwogc3Ry
dWN0IGRldmljZSAqbWRldl9kZXYoc3RydWN0IG1kZXZfZGV2aWNlICptZGV2KQogewogCXJldHVy
biAmbWRldi0+ZGV2OwpAQCAtMTM1LDYgKzE0MSw3IEBAIHN0YXRpYyBpbnQgbWRldl9kZXZpY2Vf
cmVtb3ZlX2NiKHN0cnVjdCBkZXZpY2UgKmRldiwgdm9pZCAqZGF0YSkKICAqIG1kZXZfcmVnaXN0
ZXJfZGV2aWNlIDogUmVnaXN0ZXIgYSBkZXZpY2UKICAqIEBkZXY6IGRldmljZSBzdHJ1Y3R1cmUg
cmVwcmVzZW50aW5nIHBhcmVudCBkZXZpY2UuCiAgKiBAb3BzOiBQYXJlbnQgZGV2aWNlIG9wZXJh
dGlvbiBzdHJ1Y3R1cmUgdG8gYmUgcmVnaXN0ZXJlZC4KKyAqIEBpZDogY2xhc3MgaWQuCiAgKgog
ICogQWRkIGRldmljZSB0byBsaXN0IG9mIHJlZ2lzdGVyZWQgcGFyZW50IGRldmljZXMuCiAgKiBS
ZXR1cm5zIGEgbmVnYXRpdmUgdmFsdWUgb24gZXJyb3IsIG90aGVyd2lzZSAwLgpAQCAtMzI0LDYg
KzMzMSw5IEBAIGludCBtZGV2X2RldmljZV9jcmVhdGUoc3RydWN0IGtvYmplY3QgKmtvYmosCiAJ
aWYgKHJldCkKIAkJZ290byBvcHNfY3JlYXRlX2ZhaWw7CiAKKwlpZiAoIW1kZXYtPmNsYXNzX2lk
KQorCQlnb3RvIGNsYXNzX2lkX2ZhaWw7CisKIAlyZXQgPSBkZXZpY2VfYWRkKCZtZGV2LT5kZXYp
OwogCWlmIChyZXQpCiAJCWdvdG8gYWRkX2ZhaWw7CkBAIC0zNDAsNiArMzUwLDcgQEAgaW50IG1k
ZXZfZGV2aWNlX2NyZWF0ZShzdHJ1Y3Qga29iamVjdCAqa29iaiwKIAogc3lzZnNfZmFpbDoKIAlk
ZXZpY2VfZGVsKCZtZGV2LT5kZXYpOworY2xhc3NfaWRfZmFpbDoKIGFkZF9mYWlsOgogCXBhcmVu
dC0+b3BzLT5yZW1vdmUobWRldik7CiBvcHNfY3JlYXRlX2ZhaWw6CmRpZmYgLS1naXQgYS9kcml2
ZXJzL3ZmaW8vbWRldi9tZGV2X2RyaXZlci5jIGIvZHJpdmVycy92ZmlvL21kZXYvbWRldl9kcml2
ZXIuYwppbmRleCAwZDMyMjNhZWUyMGIuLmI3YzQwY2U4NmVlMyAxMDA2NDQKLS0tIGEvZHJpdmVy
cy92ZmlvL21kZXYvbWRldl9kcml2ZXIuYworKysgYi9kcml2ZXJzL3ZmaW8vbWRldi9tZGV2X2Ry
aXZlci5jCkBAIC02OSw4ICs2OSwyMiBAQCBzdGF0aWMgaW50IG1kZXZfcmVtb3ZlKHN0cnVjdCBk
ZXZpY2UgKmRldikKIAlyZXR1cm4gMDsKIH0KIAorc3RhdGljIGludCBtZGV2X21hdGNoKHN0cnVj
dCBkZXZpY2UgKmRldiwgc3RydWN0IGRldmljZV9kcml2ZXIgKmRydikKK3sKKwl1bnNpZ25lZCBp
bnQgaTsKKwlzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYgPSB0b19tZGV2X2RldmljZShkZXYpOwor
CXN0cnVjdCBtZGV2X2RyaXZlciAqbWRydiA9IHRvX21kZXZfZHJpdmVyKGRydik7CisJY29uc3Qg
c3RydWN0IG1kZXZfY2xhc3NfaWQgKmlkcyA9IG1kcnYtPmlkX3RhYmxlOworCisJZm9yIChpID0g
MDsgaWRzW2ldLmlkOyBpKyspCisJCWlmIChpZHNbaV0uaWQgPT0gbWRldi0+Y2xhc3NfaWQpCisJ
CQlyZXR1cm4gMTsKKwlyZXR1cm4gMDsKK30KKwogc3RydWN0IGJ1c190eXBlIG1kZXZfYnVzX3R5
cGUgPSB7CiAJLm5hbWUJCT0gIm1kZXYiLAorCS5tYXRjaAkJPSBtZGV2X21hdGNoLAogCS5wcm9i
ZQkJPSBtZGV2X3Byb2JlLAogCS5yZW1vdmUJCT0gbWRldl9yZW1vdmUsCiB9OwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy92ZmlvL21kZXYvbWRldl9wcml2YXRlLmggYi9kcml2ZXJzL3ZmaW8vbWRldi9t
ZGV2X3ByaXZhdGUuaAppbmRleCA3ZDkyMjk1MGNhYWYuLmM2NWY0MzZjMTg2OSAxMDA2NDQKLS0t
IGEvZHJpdmVycy92ZmlvL21kZXYvbWRldl9wcml2YXRlLmgKKysrIGIvZHJpdmVycy92ZmlvL21k
ZXYvbWRldl9wcml2YXRlLmgKQEAgLTMzLDYgKzMzLDcgQEAgc3RydWN0IG1kZXZfZGV2aWNlIHsK
IAlzdHJ1Y3Qga29iamVjdCAqdHlwZV9rb2JqOwogCXN0cnVjdCBkZXZpY2UgKmlvbW11X2Rldmlj
ZTsKIAlib29sIGFjdGl2ZTsKKwl1MTYgY2xhc3NfaWQ7CiB9OwogCiAjZGVmaW5lIHRvX21kZXZf
ZGV2aWNlKGRldikJY29udGFpbmVyX29mKGRldiwgc3RydWN0IG1kZXZfZGV2aWNlLCBkZXYpCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL3ZmaW8vbWRldi92ZmlvX21kZXYuYyBiL2RyaXZlcnMvdmZpby9t
ZGV2L3ZmaW9fbWRldi5jCmluZGV4IDMwOTY0YTRlMGEyOC4uZmQyYTRkOWEzZjI2IDEwMDY0NAot
LS0gYS9kcml2ZXJzL3ZmaW8vbWRldi92ZmlvX21kZXYuYworKysgYi9kcml2ZXJzL3ZmaW8vbWRl
di92ZmlvX21kZXYuYwpAQCAtMTIwLDEwICsxMjAsMTYgQEAgc3RhdGljIHZvaWQgdmZpb19tZGV2
X3JlbW92ZShzdHJ1Y3QgZGV2aWNlICpkZXYpCiAJdmZpb19kZWxfZ3JvdXBfZGV2KGRldik7CiB9
CiAKK3N0YXRpYyBzdHJ1Y3QgbWRldl9jbGFzc19pZCBpZF90YWJsZVtdID0geworCXsgTURFVl9J
RF9WRklPIH0sCisJeyAwIH0sCit9OworCiBzdGF0aWMgc3RydWN0IG1kZXZfZHJpdmVyIHZmaW9f
bWRldl9kcml2ZXIgPSB7CiAJLm5hbWUJPSAidmZpb19tZGV2IiwKIAkucHJvYmUJPSB2ZmlvX21k
ZXZfcHJvYmUsCiAJLnJlbW92ZQk9IHZmaW9fbWRldl9yZW1vdmUsCisJLmlkX3RhYmxlID0gaWRf
dGFibGUsCiB9OwogCiBzdGF0aWMgaW50IF9faW5pdCB2ZmlvX21kZXZfaW5pdCh2b2lkKQpkaWZm
IC0tZ2l0IGEvaW5jbHVkZS9saW51eC9tZGV2LmggYi9pbmNsdWRlL2xpbnV4L21kZXYuaAppbmRl
eCAwY2UzMGNhNzhkYjAuLmE3NTcwY2YxM2JhNCAxMDA2NDQKLS0tIGEvaW5jbHVkZS9saW51eC9t
ZGV2LmgKKysrIGIvaW5jbHVkZS9saW51eC9tZGV2LmgKQEAgLTExOCw2ICsxMTgsNyBAQCBzdHJ1
Y3QgbWRldl90eXBlX2F0dHJpYnV0ZSBtZGV2X3R5cGVfYXR0cl8jI19uYW1lID0JCVwKICAqIEBw
cm9iZTogY2FsbGVkIHdoZW4gbmV3IGRldmljZSBjcmVhdGVkCiAgKiBAcmVtb3ZlOiBjYWxsZWQg
d2hlbiBkZXZpY2UgcmVtb3ZlZAogICogQGRyaXZlcjogZGV2aWNlIGRyaXZlciBzdHJ1Y3R1cmUK
KyAqIEBpZF90YWJsZTogdGhlIGlkcyBzZXJ2aWNlZCBieSB0aGlzIGRyaXZlcgogICoKICAqKi8K
IHN0cnVjdCBtZGV2X2RyaXZlciB7CkBAIC0xMjUsMTIgKzEyNiwxNCBAQCBzdHJ1Y3QgbWRldl9k
cml2ZXIgewogCWludCAgKCpwcm9iZSkoc3RydWN0IGRldmljZSAqZGV2KTsKIAl2b2lkICgqcmVt
b3ZlKShzdHJ1Y3QgZGV2aWNlICpkZXYpOwogCXN0cnVjdCBkZXZpY2VfZHJpdmVyIGRyaXZlcjsK
Kwljb25zdCBzdHJ1Y3QgbWRldl9jbGFzc19pZCAqaWRfdGFibGU7CiB9OwogCiAjZGVmaW5lIHRv
X21kZXZfZHJpdmVyKGRydikJY29udGFpbmVyX29mKGRydiwgc3RydWN0IG1kZXZfZHJpdmVyLCBk
cml2ZXIpCiAKIHZvaWQgKm1kZXZfZ2V0X2RydmRhdGEoc3RydWN0IG1kZXZfZGV2aWNlICptZGV2
KTsKIHZvaWQgbWRldl9zZXRfZHJ2ZGF0YShzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYsIHZvaWQg
KmRhdGEpOwordm9pZCBtZGV2X3NldF9jbGFzcyhzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYsIHUx
NiBpZCk7CiBjb25zdCBndWlkX3QgKm1kZXZfdXVpZChzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYp
OwogCiBleHRlcm4gc3RydWN0IGJ1c190eXBlIG1kZXZfYnVzX3R5cGU7CkBAIC0xNDUsNCArMTQ4
LDkgQEAgc3RydWN0IGRldmljZSAqbWRldl9wYXJlbnRfZGV2KHN0cnVjdCBtZGV2X2RldmljZSAq
bWRldik7CiBzdHJ1Y3QgZGV2aWNlICptZGV2X2RldihzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYp
Owogc3RydWN0IG1kZXZfZGV2aWNlICptZGV2X2Zyb21fZGV2KHN0cnVjdCBkZXZpY2UgKmRldik7
CiAKK2VudW0geworCU1ERVZfSURfVkZJTyA9IDEsCisJLyogTmV3IGVudHJpZXMgbXVzdCBiZSBh
ZGRlZCBoZXJlICovCit9OworCiAjZW5kaWYgLyogTURFVl9IICovCmRpZmYgLS1naXQgYS9pbmNs
dWRlL2xpbnV4L21vZF9kZXZpY2V0YWJsZS5oIGIvaW5jbHVkZS9saW51eC9tb2RfZGV2aWNldGFi
bGUuaAppbmRleCA1NzE0ZmQzNWE4M2MuLmYzMmM2ZTQ0ZmIxYSAxMDA2NDQKLS0tIGEvaW5jbHVk
ZS9saW51eC9tb2RfZGV2aWNldGFibGUuaAorKysgYi9pbmNsdWRlL2xpbnV4L21vZF9kZXZpY2V0
YWJsZS5oCkBAIC04MjEsNCArODIxLDEyIEBAIHN0cnVjdCB3bWlfZGV2aWNlX2lkIHsKIAljb25z
dCB2b2lkICpjb250ZXh0OwogfTsKIAorLyoqCisgKiBzdHJ1Y3QgbWRldl9jbGFzc19pZCAtIE1E
RVYgZGV2aWNlIGNsYXNzIGlkZW50aWZpZXIKKyAqIEBpZDogVXNlZCB0byBpZGVudGlmeSBhIHNw
ZWNpZmljIGNsYXNzIG9mIGRldmljZSwgZS5nIHZmaW8tbWRldiBkZXZpY2UuCisgKi8KK3N0cnVj
dCBtZGV2X2NsYXNzX2lkIHsKKwlfX3UxNiBpZDsKK307CisKICNlbmRpZiAvKiBMSU5VWF9NT0Rf
REVWSUNFVEFCTEVfSCAqLwpkaWZmIC0tZ2l0IGEvc2FtcGxlcy92ZmlvLW1kZXYvbWJvY2hzLmMg
Yi9zYW1wbGVzL3ZmaW8tbWRldi9tYm9jaHMuYwppbmRleCBhYzVjOGMxN2IxZmYuLmZkODQ5MWU1
OGZlMiAxMDA2NDQKLS0tIGEvc2FtcGxlcy92ZmlvLW1kZXYvbWJvY2hzLmMKKysrIGIvc2FtcGxl
cy92ZmlvLW1kZXYvbWJvY2hzLmMKQEAgLTU2MSw2ICs1NjEsNyBAQCBzdGF0aWMgaW50IG1ib2No
c19jcmVhdGUoc3RydWN0IGtvYmplY3QgKmtvYmosIHN0cnVjdCBtZGV2X2RldmljZSAqbWRldikK
IAltYm9jaHNfcmVzZXQobWRldik7CiAKIAltYm9jaHNfdXNlZF9tYnl0ZXMgKz0gdHlwZS0+bWJ5
dGVzOworCW1kZXZfc2V0X2NsYXNzKG1kZXYsIE1ERVZfSURfVkZJTyk7CiAJcmV0dXJuIDA7CiAK
IGVycl9tZW06CmRpZmYgLS1naXQgYS9zYW1wbGVzL3ZmaW8tbWRldi9tZHB5LmMgYi9zYW1wbGVz
L3ZmaW8tbWRldi9tZHB5LmMKaW5kZXggY2M4NmJmNjU2NmU0Li44ODk0NzJiMDY3MDggMTAwNjQ0
Ci0tLSBhL3NhbXBsZXMvdmZpby1tZGV2L21kcHkuYworKysgYi9zYW1wbGVzL3ZmaW8tbWRldi9t
ZHB5LmMKQEAgLTI2OSw2ICsyNjksNyBAQCBzdGF0aWMgaW50IG1kcHlfY3JlYXRlKHN0cnVjdCBr
b2JqZWN0ICprb2JqLCBzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYpCiAJbWRweV9yZXNldChtZGV2
KTsKIAogCW1kcHlfY291bnQrKzsKKwltZGV2X3NldF9jbGFzcyhtZGV2LCBNREVWX0lEX1ZGSU8p
OwogCXJldHVybiAwOwogfQogCmRpZmYgLS1naXQgYS9zYW1wbGVzL3ZmaW8tbWRldi9tdHR5LmMg
Yi9zYW1wbGVzL3ZmaW8tbWRldi9tdHR5LmMKaW5kZXggY2U4NGEzMDBhNGRhLi42MTg4MTBjYTQz
MzEgMTAwNjQ0Ci0tLSBhL3NhbXBsZXMvdmZpby1tZGV2L210dHkuYworKysgYi9zYW1wbGVzL3Zm
aW8tbWRldi9tdHR5LmMKQEAgLTc1NSw2ICs3NTUsNyBAQCBzdGF0aWMgaW50IG10dHlfY3JlYXRl
KHN0cnVjdCBrb2JqZWN0ICprb2JqLCBzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYpCiAJbGlzdF9h
ZGQoJm1kZXZfc3RhdGUtPm5leHQsICZtZGV2X2RldmljZXNfbGlzdCk7CiAJbXV0ZXhfdW5sb2Nr
KCZtZGV2X2xpc3RfbG9jayk7CiAKKwltZGV2X3NldF9jbGFzcyhtZGV2LCBNREVWX0lEX1ZGSU8p
OwogCXJldHVybiAwOwogfQogCi0tIAoyLjE5LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxp
c3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFu
L2xpc3RpbmZvL2RyaS1kZXZlbA==
