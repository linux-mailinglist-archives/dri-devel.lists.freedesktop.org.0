Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 7756636F7D8
	for <lists+dri-devel@lfdr.de>; Fri, 30 Apr 2021 11:25:32 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9EDC06F50A;
	Fri, 30 Apr 2021 09:25:25 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ej1-x62b.google.com (mail-ej1-x62b.google.com
 [IPv6:2a00:1450:4864:20::62b])
 by gabe.freedesktop.org (Postfix) with ESMTPS id D89AA6F508
 for <dri-devel@lists.freedesktop.org>; Fri, 30 Apr 2021 09:25:19 +0000 (UTC)
Received: by mail-ej1-x62b.google.com with SMTP id zg3so22637037ejb.8
 for <dri-devel@lists.freedesktop.org>; Fri, 30 Apr 2021 02:25:19 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=MrHVgs4uQtR736I8oYDwmYOWH+Ni1lmHqgNkrNb90MI=;
 b=ZI0OWhW0u72jW0iO6Gpcxo1lkxlxrew/3PelPeuJbfoXcE0HiPzQbJj2Q1RTnBYEvq
 O3GnvcxDMxW+8HCB6RW+1uaHm/gRSHc2Nhv/pnsnn8jrNoiRboHr4x9IXLrAV3R43A6F
 XLt+OsMPbucq18ECoet0J+JGTTNrX+racJ32aRxddvhHs/RsXE2dKmvJVmxk6UHy/tFO
 rQ/rptPqrrugBrvp2TLHLw5oc6E9FPfcP/KPu0oBhAPRRZXxg21k3dk7SeWuwvUu8DrE
 ByuhkIkVbpJl06evNDF4eCI4ONIwGnCDcWcciRYeCNDx9OylVclhrO3hlNm4m6HJpOrk
 Uevw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=MrHVgs4uQtR736I8oYDwmYOWH+Ni1lmHqgNkrNb90MI=;
 b=GGSIGxw1Cl1j1sgthMcbG/JJd0EHvBzbWlSdNLzpsoAdU08J7t/jDRmUKOsKdDdI3f
 4twBpVrcXvSI/1qDBzLTVZvT4SX3K4rW1G7EQMDvTWNzyG0zw6GyrVSqCHO/CzllOLBy
 90XsRBU7WQMA/rgH+Upz1lpAxw1L/7+3qjA6cTpzxCRuwa7I3Syy/v+3CgnczhcP3UfT
 gTqMNfdoG9Sc5J2gWxtpS0KTYBuVZk9W8OkM25oEhRhzcfpR0r3k5MFqOjLKhKVd3Zbx
 KAvkNiRBir1Tdg9ldg/acbKFWDrgWedSH83RSXLmWGecreZ5IyIe59pr9KVp2ODwSko0
 GWAw==
X-Gm-Message-State: AOAM531qvZqJVlMh03hlW84/zZKDWptTmlZJJ8LcZ04JEle07xPL7wTR
 h6wNlpiAfNk97G+k3Ed6E1Jry3gnnw8=
X-Google-Smtp-Source: ABdhPJwyXgTB+D63bClP1bqq7rjRRsCk2Qml1Epax8BiQCkoIjfLM1hGC+EX43fQdF4JUSqtFn94Ig==
X-Received: by 2002:a17:907:c0d:: with SMTP id
 ga13mr1529750ejc.413.1619774718447; 
 Fri, 30 Apr 2021 02:25:18 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:d08c:9633:b7a2:37e2])
 by smtp.gmail.com with ESMTPSA id h23sm1550959ejx.90.2021.04.30.02.25.17
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 30 Apr 2021 02:25:18 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 13/13] drm/ttm: flip the switch for driver allocated resources
Date: Fri, 30 Apr 2021 11:25:08 +0200
Message-Id: <20210430092508.60710-13-christian.koenig@amd.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20210430092508.60710-1-christian.koenig@amd.com>
References: <20210430092508.60710-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: daniel.vetter@ffwll.ch, matthew.william.auld@gmail.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW5zdGVhZCBvZiBib3RoIGRyaXZlciBhbmQgVFRNIGFsbG9jYXRpbmcgbWVtb3J5IGZpbmFsaXpl
IGVtYmVkZGluZyB0aGUKdHRtX3Jlc291cmNlIG9iamVjdCBhcyBiYXNlIGludG8gdGhlIGRyaXZl
ciBiYWNrZW5kcy4KClNpZ25lZC1vZmYtYnk6IENocmlzdGlhbiBLw7ZuaWcgPGNocmlzdGlhbi5r
b2VuaWdAYW1kLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZ3R0
X21nci5jICAgfCA0NCArKysrKystLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X29iamVjdC5jICAgIHwgIDIgKy0KIC4uLi9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X3Jlc19jdXJzb3IuaCAgICB8ICA1ICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfdnJhbV9tZ3IuYyAgfCA2MCArKysrKysrKystLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0v
ZHJtX2dlbV92cmFtX2hlbHBlci5jICAgICAgICAgfCAgMyArLQogZHJpdmVycy9ncHUvZHJtL25v
dXZlYXUvbm91dmVhdV9iby5jICAgICAgICAgIHwgIDggKy0tCiBkcml2ZXJzL2dwdS9kcm0vbm91
dmVhdS9ub3V2ZWF1X21lbS5jICAgICAgICAgfCAxMSArKy0tCiBkcml2ZXJzL2dwdS9kcm0vbm91
dmVhdS9ub3V2ZWF1X21lbS5oICAgICAgICAgfCAxNCArKy0tLQogZHJpdmVycy9ncHUvZHJtL25v
dXZlYXUvbm91dmVhdV90dG0uYyAgICAgICAgIHwgMzIgKysrKystLS0tLQogZHJpdmVycy9ncHUv
ZHJtL3R0bS90dG1fcmFuZ2VfbWFuYWdlci5jICAgICAgIHwgMjMgKysrLS0tLQogZHJpdmVycy9n
cHUvZHJtL3R0bS90dG1fcmVzb3VyY2UuYyAgICAgICAgICAgIHwgMTUgKy0tLS0KIGRyaXZlcnMv
Z3B1L2RybS90dG0vdHRtX3N5c19tYW5hZ2VyLmMgICAgICAgICB8IDEyICsrLS0KIGRyaXZlcnMv
Z3B1L2RybS92bXdnZngvdm13Z2Z4X2dtcmlkX21hbmFnZXIuYyB8IDI0ICsrKystLS0tCiBkcml2
ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF90aHAuYyAgICAgICAgICAgfCAyNyArKysrLS0tLS0K
IGluY2x1ZGUvZHJtL3R0bS90dG1fcmFuZ2VfbWFuYWdlci5oICAgICAgICAgICB8ICAzICstCiBp
bmNsdWRlL2RybS90dG0vdHRtX3Jlc291cmNlLmggICAgICAgICAgICAgICAgfCA0MyArKysrKyst
LS0tLS0tCiAxNiBmaWxlcyBjaGFuZ2VkLCAxNDAgaW5zZXJ0aW9ucygrKSwgMTg2IGRlbGV0aW9u
cygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9ndHRf
bWdyLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZ3R0X21nci5jCmluZGV4
IDJlN2RmZmQzNjE0ZC4uZDZjMTk2MGFiZjY0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfZ3R0X21nci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV9ndHRfbWdyLmMKQEAgLTQwLDggKzQwLDcgQEAgdG9fZ3R0X21ncihzdHJ1Y3Qg
dHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbikKIHN0YXRpYyBpbmxpbmUgc3RydWN0IGFtZGdwdV9n
dHRfbm9kZSAqCiB0b19hbWRncHVfZ3R0X25vZGUoc3RydWN0IHR0bV9yZXNvdXJjZSAqcmVzKQog
ewotCXJldHVybiBjb250YWluZXJfb2YocmVzLT5tbV9ub2RlLCBzdHJ1Y3QgYW1kZ3B1X2d0dF9u
b2RlLAotCQkJICAgIGJhc2UubW1fbm9kZXNbMF0pOworCXJldHVybiBjb250YWluZXJfb2YocmVz
LCBzdHJ1Y3QgYW1kZ3B1X2d0dF9ub2RlLCBiYXNlLmJhc2UpOwogfQogCiAvKioKQEAgLTkyLDEz
ICs5MSwxMyBAQCBzdGF0aWMgREVWSUNFX0FUVFIobWVtX2luZm9fZ3R0X3VzZWQsIFNfSVJVR08s
CiAvKioKICAqIGFtZGdwdV9ndHRfbWdyX2hhc19nYXJ0X2FkZHIgLSBDaGVjayBpZiBtZW0gaGFz
IGFkZHJlc3Mgc3BhY2UKICAqCi0gKiBAbWVtOiB0aGUgbWVtIG9iamVjdCB0byBjaGVjaworICog
QHJlczogdGhlIG1lbSBvYmplY3QgdG8gY2hlY2sKICAqCiAgKiBDaGVjayBpZiBhIG1lbSBvYmpl
Y3QgaGFzIGFscmVhZHkgYWRkcmVzcyBzcGFjZSBhbGxvY2F0ZWQuCiAgKi8KLWJvb2wgYW1kZ3B1
X2d0dF9tZ3JfaGFzX2dhcnRfYWRkcihzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0pCitib29sIGFt
ZGdwdV9ndHRfbWdyX2hhc19nYXJ0X2FkZHIoc3RydWN0IHR0bV9yZXNvdXJjZSAqcmVzKQogewot
CXN0cnVjdCBhbWRncHVfZ3R0X25vZGUgKm5vZGUgPSB0b19hbWRncHVfZ3R0X25vZGUobWVtKTsK
KwlzdHJ1Y3QgYW1kZ3B1X2d0dF9ub2RlICpub2RlID0gdG9fYW1kZ3B1X2d0dF9ub2RlKHJlcyk7
CiAKIAlyZXR1cm4gZHJtX21tX25vZGVfYWxsb2NhdGVkKCZub2RlLT5iYXNlLm1tX25vZGVzWzBd
KTsKIH0KQEAgLTExNiwxOSArMTE1LDIwIEBAIGJvb2wgYW1kZ3B1X2d0dF9tZ3JfaGFzX2dhcnRf
YWRkcihzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0pCiBzdGF0aWMgaW50IGFtZGdwdV9ndHRfbWdy
X25ldyhzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiwKIAkJCSAgICAgIHN0cnVjdCB0
dG1fYnVmZmVyX29iamVjdCAqdGJvLAogCQkJICAgICAgY29uc3Qgc3RydWN0IHR0bV9wbGFjZSAq
cGxhY2UsCi0JCQkgICAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0pCisJCQkgICAgICBzdHJ1
Y3QgdHRtX3Jlc291cmNlICoqcmVzKQogewogCXN0cnVjdCBhbWRncHVfZ3R0X21nciAqbWdyID0g
dG9fZ3R0X21ncihtYW4pOworCXVpbnQzMl90IG51bV9wYWdlcyA9IFBGTl9VUCh0Ym8tPmJhc2Uu
c2l6ZSk7CiAJc3RydWN0IGFtZGdwdV9ndHRfbm9kZSAqbm9kZTsKIAlpbnQgcjsKIAogCXNwaW5f
bG9jaygmbWdyLT5sb2NrKTsKLQlpZiAoKHRiby0+cmVzb3VyY2UgPT0gbWVtIHx8IHRiby0+cmVz
b3VyY2UtPm1lbV90eXBlICE9IFRUTV9QTF9UVCkgJiYKLQkgICAgYXRvbWljNjRfcmVhZCgmbWdy
LT5hdmFpbGFibGUpIDwgbWVtLT5udW1fcGFnZXMpIHsKKwlpZiAodGJvLT5yZXNvdXJjZSAmJiB0
Ym8tPnJlc291cmNlLT5tZW1fdHlwZSAhPSBUVE1fUExfVFQgJiYKKwkgICAgYXRvbWljNjRfcmVh
ZCgmbWdyLT5hdmFpbGFibGUpIDwgbnVtX3BhZ2VzKSB7CiAJCXNwaW5fdW5sb2NrKCZtZ3ItPmxv
Y2spOwogCQlyZXR1cm4gLUVOT1NQQzsKIAl9Ci0JYXRvbWljNjRfc3ViKG1lbS0+bnVtX3BhZ2Vz
LCAmbWdyLT5hdmFpbGFibGUpOworCWF0b21pYzY0X3N1YihudW1fcGFnZXMsICZtZ3ItPmF2YWls
YWJsZSk7CiAJc3Bpbl91bmxvY2soJm1nci0+bG9jayk7CiAKIAlub2RlID0ga3phbGxvYyhzdHJ1
Y3Rfc2l6ZShub2RlLCBiYXNlLm1tX25vZGVzLCAxKSwgR0ZQX0tFUk5FTCk7CkBAIC0xNDQsMjkg
KzE0NCwyOCBAQCBzdGF0aWMgaW50IGFtZGdwdV9ndHRfbWdyX25ldyhzdHJ1Y3QgdHRtX3Jlc291
cmNlX21hbmFnZXIgKm1hbiwKIAkJc3Bpbl9sb2NrKCZtZ3ItPmxvY2spOwogCQlyID0gZHJtX21t
X2luc2VydF9ub2RlX2luX3JhbmdlKCZtZ3ItPm1tLAogCQkJCQkJJm5vZGUtPmJhc2UubW1fbm9k
ZXNbMF0sCi0JCQkJCQltZW0tPm51bV9wYWdlcywKLQkJCQkJCXRiby0+cGFnZV9hbGlnbm1lbnQs
IDAsCi0JCQkJCQlwbGFjZS0+ZnBmbiwgcGxhY2UtPmxwZm4sCisJCQkJCQludW1fcGFnZXMsIHRi
by0+cGFnZV9hbGlnbm1lbnQsCisJCQkJCQkwLCBwbGFjZS0+ZnBmbiwgcGxhY2UtPmxwZm4sCiAJ
CQkJCQlEUk1fTU1fSU5TRVJUX0JFU1QpOwogCQlzcGluX3VubG9jaygmbWdyLT5sb2NrKTsKIAkJ
aWYgKHVubGlrZWx5KHIpKQogCQkJZ290byBlcnJfZnJlZTsKIAotCQltZW0tPnN0YXJ0ID0gbm9k
ZS0+YmFzZS5tbV9ub2Rlc1swXS5zdGFydDsKKwkJbm9kZS0+YmFzZS5iYXNlLnN0YXJ0ID0gbm9k
ZS0+YmFzZS5tbV9ub2Rlc1swXS5zdGFydDsKIAl9IGVsc2UgewogCQlub2RlLT5iYXNlLm1tX25v
ZGVzWzBdLnN0YXJ0ID0gMDsKLQkJbm9kZS0+YmFzZS5tbV9ub2Rlc1swXS5zaXplID0gbWVtLT5u
dW1fcGFnZXM7Ci0JCW1lbS0+c3RhcnQgPSBBTURHUFVfQk9fSU5WQUxJRF9PRkZTRVQ7CisJCW5v
ZGUtPmJhc2UubW1fbm9kZXNbMF0uc2l6ZSA9IG5vZGUtPmJhc2UuYmFzZS5udW1fcGFnZXM7CisJ
CW5vZGUtPmJhc2UuYmFzZS5zdGFydCA9IEFNREdQVV9CT19JTlZBTElEX09GRlNFVDsKIAl9CiAK
LQltZW0tPm1tX25vZGUgPSAmbm9kZS0+YmFzZS5tbV9ub2Rlc1swXTsKKwkqcmVzID0gJm5vZGUt
PmJhc2UuYmFzZTsKIAlyZXR1cm4gMDsKIAogZXJyX2ZyZWU6CiAJa2ZyZWUobm9kZSk7CiAKIGVy
cl9vdXQ6Ci0JYXRvbWljNjRfYWRkKG1lbS0+bnVtX3BhZ2VzLCAmbWdyLT5hdmFpbGFibGUpOwor
CWF0b21pYzY0X2FkZChudW1fcGFnZXMsICZtZ3ItPmF2YWlsYWJsZSk7CiAKIAlyZXR1cm4gcjsK
IH0KQEAgLTE4MCwyMSArMTc5LDE2IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2d0dF9tZ3JfbmV3KHN0
cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuLAogICogRnJlZSB0aGUgYWxsb2NhdGVkIEdU
VCBhZ2Fpbi4KICAqLwogc3RhdGljIHZvaWQgYW1kZ3B1X2d0dF9tZ3JfZGVsKHN0cnVjdCB0dG1f
cmVzb3VyY2VfbWFuYWdlciAqbWFuLAotCQkJICAgICAgIHN0cnVjdCB0dG1fcmVzb3VyY2UgKm1l
bSkKKwkJCSAgICAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlICpyZXMpCiB7CisJc3RydWN0IGFtZGdw
dV9ndHRfbm9kZSAqbm9kZSA9IHRvX2FtZGdwdV9ndHRfbm9kZShyZXMpOwogCXN0cnVjdCBhbWRn
cHVfZ3R0X21nciAqbWdyID0gdG9fZ3R0X21ncihtYW4pOwotCXN0cnVjdCBhbWRncHVfZ3R0X25v
ZGUgKm5vZGU7Ci0KLQlpZiAoIW1lbS0+bW1fbm9kZSkKLQkJcmV0dXJuOwotCi0Jbm9kZSA9IHRv
X2FtZGdwdV9ndHRfbm9kZShtZW0pOwogCiAJc3Bpbl9sb2NrKCZtZ3ItPmxvY2spOwogCWlmIChk
cm1fbW1fbm9kZV9hbGxvY2F0ZWQoJm5vZGUtPmJhc2UubW1fbm9kZXNbMF0pKQogCQlkcm1fbW1f
cmVtb3ZlX25vZGUoJm5vZGUtPmJhc2UubW1fbm9kZXNbMF0pOwogCXNwaW5fdW5sb2NrKCZtZ3It
PmxvY2spOwotCWF0b21pYzY0X2FkZChtZW0tPm51bV9wYWdlcywgJm1nci0+YXZhaWxhYmxlKTsK
KwlhdG9taWM2NF9hZGQocmVzLT5udW1fcGFnZXMsICZtZ3ItPmF2YWlsYWJsZSk7CiAKIAlrZnJl
ZShub2RlKTsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9vYmplY3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9vYmplY3QuYwpp
bmRleCBlNjY5YTNhZGFjNDQuLjg0MTQyZWVkNjZkZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X29iamVjdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV9vYmplY3QuYwpAQCAtMTMxNSw3ICsxMzE1LDcgQEAgdm9pZCBhbWRncHVf
Ym9fcmVsZWFzZV9ub3RpZnkoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibykKIAlpZiAoYm8t
PmJhc2UucmVzdiA9PSAmYm8tPmJhc2UuX3Jlc3YpCiAJCWFtZGdwdV9hbWRrZmRfcmVtb3ZlX2Zl
bmNlX29uX3B0X3BkX2JvcyhhYm8pOwogCi0JaWYgKGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgIT0g
VFRNX1BMX1ZSQU0gfHwgIWJvLT5yZXNvdXJjZS0+bW1fbm9kZSB8fAorCWlmIChiby0+cmVzb3Vy
Y2UtPm1lbV90eXBlICE9IFRUTV9QTF9WUkFNIHx8CiAJICAgICEoYWJvLT5mbGFncyAmIEFNREdQ
VV9HRU1fQ1JFQVRFX1ZSQU1fV0lQRV9PTl9SRUxFQVNFKSkKIAkJcmV0dXJuOwogCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcmVzX2N1cnNvci5oIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3Jlc19jdXJzb3IuaAppbmRleCA0MGYyYWRm
MzA1YmMuLjU5ZTBmZWZiMTVhYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X3Jlc19jdXJzb3IuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9h
bWRncHVfcmVzX2N1cnNvci5oCkBAIC0yOCw2ICsyOCw3IEBACiAKICNpbmNsdWRlIDxkcm0vZHJt
X21tLmg+CiAjaW5jbHVkZSA8ZHJtL3R0bS90dG1fcmVzb3VyY2UuaD4KKyNpbmNsdWRlIDxkcm0v
dHRtL3R0bV9yYW5nZV9tYW5hZ2VyLmg+CiAKIC8qIHN0YXRlIGJhY2sgZm9yIHdhbGtpbmcgb3Zl
ciB2cmFtX21nciBhbmQgZ3R0X21nciBhbGxvY2F0aW9ucyAqLwogc3RydWN0IGFtZGdwdV9yZXNf
Y3Vyc29yIHsKQEAgLTUzLDcgKzU0LDcgQEAgc3RhdGljIGlubGluZSB2b2lkIGFtZGdwdV9yZXNf
Zmlyc3Qoc3RydWN0IHR0bV9yZXNvdXJjZSAqcmVzLAogewogCXN0cnVjdCBkcm1fbW1fbm9kZSAq
bm9kZTsKIAotCWlmICghcmVzIHx8ICFyZXMtPm1tX25vZGUpIHsKKwlpZiAoIXJlcykgewogCQlj
dXItPnN0YXJ0ID0gc3RhcnQ7CiAJCWN1ci0+c2l6ZSA9IHNpemU7CiAJCWN1ci0+cmVtYWluaW5n
ID0gc2l6ZTsKQEAgLTYzLDcgKzY0LDcgQEAgc3RhdGljIGlubGluZSB2b2lkIGFtZGdwdV9yZXNf
Zmlyc3Qoc3RydWN0IHR0bV9yZXNvdXJjZSAqcmVzLAogCiAJQlVHX09OKHN0YXJ0ICsgc2l6ZSA+
IHJlcy0+bnVtX3BhZ2VzIDw8IFBBR0VfU0hJRlQpOwogCi0Jbm9kZSA9IHJlcy0+bW1fbm9kZTsK
Kwlub2RlID0gdG9fdHRtX3JhbmdlX21ncl9ub2RlKHJlcyktPm1tX25vZGVzOwogCXdoaWxlIChz
dGFydCA+PSBub2RlLT5zaXplIDw8IFBBR0VfU0hJRlQpCiAJCXN0YXJ0IC09IG5vZGUrKy0+c2l6
ZSA8PCBQQUdFX1NISUZUOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfdnJhbV9tZ3IuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92
cmFtX21nci5jCmluZGV4IGQ1OWVjMDdjNzdiYi4uYzhmZWFlNzg4ZTc5IDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdnJhbV9tZ3IuYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdnJhbV9tZ3IuYwpAQCAtMjE1LDE5ICsyMTUsMjAg
QEAgc3RhdGljIHU2NCBhbWRncHVfdnJhbV9tZ3JfdmlzX3NpemUoc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYsCiB1NjQgYW1kZ3B1X3ZyYW1fbWdyX2JvX3Zpc2libGVfc2l6ZShzdHJ1Y3QgYW1k
Z3B1X2JvICpibykKIHsKIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGFtZGdwdV90dG1f
YWRldihiby0+dGJvLmJkZXYpOwotCXN0cnVjdCB0dG1fcmVzb3VyY2UgKm1lbSA9IGJvLT50Ym8u
cmVzb3VyY2U7Ci0Jc3RydWN0IGRybV9tbV9ub2RlICpub2RlcyA9IG1lbS0+bW1fbm9kZTsKLQl1
bnNpZ25lZCBwYWdlcyA9IG1lbS0+bnVtX3BhZ2VzOworCXN0cnVjdCB0dG1fcmVzb3VyY2UgKnJl
cyA9IGJvLT50Ym8ucmVzb3VyY2U7CisJdW5zaWduZWQgcGFnZXMgPSByZXMtPm51bV9wYWdlczsK
KwlzdHJ1Y3QgZHJtX21tX25vZGUgKm1tOwogCXU2NCB1c2FnZTsKIAogCWlmIChhbWRncHVfZ21j
X3ZyYW1fZnVsbF92aXNpYmxlKCZhZGV2LT5nbWMpKQogCQlyZXR1cm4gYW1kZ3B1X2JvX3NpemUo
Ym8pOwogCi0JaWYgKG1lbS0+c3RhcnQgPj0gYWRldi0+Z21jLnZpc2libGVfdnJhbV9zaXplID4+
IFBBR0VfU0hJRlQpCisJaWYgKHJlcy0+c3RhcnQgPj0gYWRldi0+Z21jLnZpc2libGVfdnJhbV9z
aXplID4+IFBBR0VfU0hJRlQpCiAJCXJldHVybiAwOwogCi0JZm9yICh1c2FnZSA9IDA7IG5vZGVz
ICYmIHBhZ2VzOyBwYWdlcyAtPSBub2Rlcy0+c2l6ZSwgbm9kZXMrKykKLQkJdXNhZ2UgKz0gYW1k
Z3B1X3ZyYW1fbWdyX3Zpc19zaXplKGFkZXYsIG5vZGVzKTsKKwltbSA9ICZjb250YWluZXJfb2Yo
cmVzLCBzdHJ1Y3QgdHRtX3JhbmdlX21ncl9ub2RlLCBiYXNlKS0+bW1fbm9kZXNbMF07CisJZm9y
ICh1c2FnZSA9IDA7IHBhZ2VzOyBwYWdlcyAtPSBtbS0+c2l6ZSwgbW0rKykKKwkJdXNhZ2UgKz0g
YW1kZ3B1X3ZyYW1fbWdyX3Zpc19zaXplKGFkZXYsIG1tKTsKIAogCXJldHVybiB1c2FnZTsKIH0K
QEAgLTM2Myw3ICszNjQsNyBAQCBzdGF0aWMgdm9pZCBhbWRncHVfdnJhbV9tZ3JfdmlydF9zdGFy
dChzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0sCiBzdGF0aWMgaW50IGFtZGdwdV92cmFtX21ncl9u
ZXcoc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYW4sCiAJCQkgICAgICAgc3RydWN0IHR0
bV9idWZmZXJfb2JqZWN0ICp0Ym8sCiAJCQkgICAgICAgY29uc3Qgc3RydWN0IHR0bV9wbGFjZSAq
cGxhY2UsCi0JCQkgICAgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqbWVtKQorCQkJICAgICAgIHN0
cnVjdCB0dG1fcmVzb3VyY2UgKipyZXMpCiB7CiAJdW5zaWduZWQgbG9uZyBscGZuLCBudW1fbm9k
ZXMsIHBhZ2VzX3Blcl9ub2RlLCBwYWdlc19sZWZ0LCBwYWdlczsKIAlzdHJ1Y3QgYW1kZ3B1X3Zy
YW1fbWdyICptZ3IgPSB0b192cmFtX21ncihtYW4pOwpAQCAtMzg0LDcgKzM4NSw3IEBAIHN0YXRp
YyBpbnQgYW1kZ3B1X3ZyYW1fbWdyX25ldyhzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1h
biwKIAkJbWF4X2J5dGVzIC09IEFNREdQVV9WTV9SRVNFUlZFRF9WUkFNOwogCiAJLyogYmFpbCBv
dXQgcXVpY2tseSBpZiB0aGVyZSdzIGxpa2VseSBub3QgZW5vdWdoIFZSQU0gZm9yIHRoaXMgQk8g
Ki8KLQltZW1fYnl0ZXMgPSAodTY0KW1lbS0+bnVtX3BhZ2VzIDw8IFBBR0VfU0hJRlQ7CisJbWVt
X2J5dGVzID0gdGJvLT5iYXNlLnNpemU7CiAJaWYgKGF0b21pYzY0X2FkZF9yZXR1cm4obWVtX2J5
dGVzLCAmbWdyLT51c2FnZSkgPiBtYXhfYnl0ZXMpIHsKIAkJciA9IC1FTk9TUEM7CiAJCWdvdG8g
ZXJyb3Jfc3ViOwpAQCAtNDAyLDcgKzQwMyw3IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X3ZyYW1fbWdy
X25ldyhzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiwKICNlbmRpZgogCQlwYWdlc19w
ZXJfbm9kZSA9IG1heF90KHVpbnQzMl90LCBwYWdlc19wZXJfbm9kZSwKIAkJCQkgICAgIHRiby0+
cGFnZV9hbGlnbm1lbnQpOwotCQludW1fbm9kZXMgPSBESVZfUk9VTkRfVVAobWVtLT5udW1fcGFn
ZXMsIHBhZ2VzX3Blcl9ub2RlKTsKKwkJbnVtX25vZGVzID0gRElWX1JPVU5EX1VQKFBGTl9VUCht
ZW1fYnl0ZXMpLCBwYWdlc19wZXJfbm9kZSk7CiAJfQogCiAJbm9kZSA9IGt2bWFsbG9jKHN0cnVj
dF9zaXplKG5vZGUsIG1tX25vZGVzLCBudW1fbm9kZXMpLApAQCAtNDE4LDggKzQxOSw3IEBAIHN0
YXRpYyBpbnQgYW1kZ3B1X3ZyYW1fbWdyX25ldyhzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIg
Km1hbiwKIAlpZiAocGxhY2UtPmZsYWdzICYgVFRNX1BMX0ZMQUdfVE9QRE9XTikKIAkJbW9kZSA9
IERSTV9NTV9JTlNFUlRfSElHSDsKIAotCW1lbS0+c3RhcnQgPSAwOwotCXBhZ2VzX2xlZnQgPSBt
ZW0tPm51bV9wYWdlczsKKwlwYWdlc19sZWZ0ID0gbm9kZS0+YmFzZS5udW1fcGFnZXM7CiAKIAkv
KiBMaW1pdCBtYXhpbXVtIHNpemUgdG8gMkdCIGR1ZSB0byBTRyB0YWJsZSBsaW1pdGF0aW9ucyAq
LwogCXBhZ2VzID0gbWluKHBhZ2VzX2xlZnQsIDJVTCA8PCAoMzAgLSBQQUdFX1NISUZUKSk7CkBA
IC00NDcsNyArNDQ3LDcgQEAgc3RhdGljIGludCBhbWRncHVfdnJhbV9tZ3JfbmV3KHN0cnVjdCB0
dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuLAogCQl9CiAKIAkJdmlzX3VzYWdlICs9IGFtZGdwdV92
cmFtX21ncl92aXNfc2l6ZShhZGV2LCAmbm9kZS0+bW1fbm9kZXNbaV0pOwotCQlhbWRncHVfdnJh
bV9tZ3JfdmlydF9zdGFydChtZW0sICZub2RlLT5tbV9ub2Rlc1tpXSk7CisJCWFtZGdwdV92cmFt
X21ncl92aXJ0X3N0YXJ0KCZub2RlLT5iYXNlLCAmbm9kZS0+bW1fbm9kZXNbaV0pOwogCQlwYWdl
c19sZWZ0IC09IHBhZ2VzOwogCQkrK2k7CiAKQEAgLTQ1NywxMCArNDU3LDEwIEBAIHN0YXRpYyBp
bnQgYW1kZ3B1X3ZyYW1fbWdyX25ldyhzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiwK
IAlzcGluX3VubG9jaygmbWdyLT5sb2NrKTsKIAogCWlmIChpID09IDEpCi0JCW1lbS0+cGxhY2Vt
ZW50IHw9IFRUTV9QTF9GTEFHX0NPTlRJR1VPVVM7CisJCW5vZGUtPmJhc2UucGxhY2VtZW50IHw9
IFRUTV9QTF9GTEFHX0NPTlRJR1VPVVM7CiAKIAlhdG9taWM2NF9hZGQodmlzX3VzYWdlLCAmbWdy
LT52aXNfdXNhZ2UpOwotCW1lbS0+bW1fbm9kZSA9ICZub2RlLT5tbV9ub2Rlc1swXTsKKwkqcmVz
ID0gJm5vZGUtPmJhc2U7CiAJcmV0dXJuIDA7CiAKIGVycm9yX2ZyZWU6CkBAIC00ODMsMjggKzQ4
MywyMiBAQCBzdGF0aWMgaW50IGFtZGdwdV92cmFtX21ncl9uZXcoc3RydWN0IHR0bV9yZXNvdXJj
ZV9tYW5hZ2VyICptYW4sCiAgKiBGcmVlIHRoZSBhbGxvY2F0ZWQgVlJBTSBhZ2Fpbi4KICAqLwog
c3RhdGljIHZvaWQgYW1kZ3B1X3ZyYW1fbWdyX2RlbChzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFn
ZXIgKm1hbiwKLQkJCQlzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0pCisJCQkJc3RydWN0IHR0bV9y
ZXNvdXJjZSAqcmVzKQogeworCXN0cnVjdCB0dG1fcmFuZ2VfbWdyX25vZGUgKm5vZGUgPSB0b190
dG1fcmFuZ2VfbWdyX25vZGUocmVzKTsKIAlzdHJ1Y3QgYW1kZ3B1X3ZyYW1fbWdyICptZ3IgPSB0
b192cmFtX21ncihtYW4pOwogCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gdG9fYW1kZ3B1
X2RldmljZShtZ3IpOwotCXN0cnVjdCB0dG1fcmFuZ2VfbWdyX25vZGUgKm5vZGU7CiAJdWludDY0
X3QgdXNhZ2UgPSAwLCB2aXNfdXNhZ2UgPSAwOwotCXVuc2lnbmVkIHBhZ2VzID0gbWVtLT5udW1f
cGFnZXM7Ci0Jc3RydWN0IGRybV9tbV9ub2RlICpub2RlczsKLQotCWlmICghbWVtLT5tbV9ub2Rl
KQotCQlyZXR1cm47Ci0KLQlub2RlID0gdG9fdHRtX3JhbmdlX21ncl9ub2RlKG1lbSk7Ci0Jbm9k
ZXMgPSAmbm9kZS0+bW1fbm9kZXNbMF07CisJdW5zaWduZWQgaSwgcGFnZXMgPSByZXMtPm51bV9w
YWdlczsKIAogCXNwaW5fbG9jaygmbWdyLT5sb2NrKTsKLQl3aGlsZSAocGFnZXMpIHsKLQkJcGFn
ZXMgLT0gbm9kZXMtPnNpemU7Ci0JCWRybV9tbV9yZW1vdmVfbm9kZShub2Rlcyk7Ci0JCXVzYWdl
ICs9IG5vZGVzLT5zaXplIDw8IFBBR0VfU0hJRlQ7Ci0JCXZpc191c2FnZSArPSBhbWRncHVfdnJh
bV9tZ3JfdmlzX3NpemUoYWRldiwgbm9kZXMpOwotCQkrK25vZGVzOworCWZvciAoaSA9IDAsIHBh
Z2VzID0gcmVzLT5udW1fcGFnZXM7IHBhZ2VzOworCSAgICAgcGFnZXMgLT0gbm9kZS0+bW1fbm9k
ZXNbaV0uc2l6ZSwgKytpKSB7CisJCXN0cnVjdCBkcm1fbW1fbm9kZSAqbW0gPSAmbm9kZS0+bW1f
bm9kZXNbaV07CisKKwkJZHJtX21tX3JlbW92ZV9ub2RlKG1tKTsKKwkJdXNhZ2UgKz0gbW0tPnNp
emUgPDwgUEFHRV9TSElGVDsKKwkJdmlzX3VzYWdlICs9IGFtZGdwdV92cmFtX21ncl92aXNfc2l6
ZShhZGV2LCBtbSk7CiAJfQogCWFtZGdwdV92cmFtX21ncl9kb19yZXNlcnZlKG1hbik7CiAJc3Bp
bl91bmxvY2soJm1nci0+bG9jayk7CkBAIC01MjksNyArNTIzLDcgQEAgc3RhdGljIHZvaWQgYW1k
Z3B1X3ZyYW1fbWdyX2RlbChzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiwKICAqIEFs
bG9jYXRlIGFuZCBmaWxsIGEgc2cgdGFibGUgZnJvbSBhIFZSQU0gYWxsb2NhdGlvbi4KICAqLwog
aW50IGFtZGdwdV92cmFtX21ncl9hbGxvY19zZ3Qoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYs
Ci0JCQkgICAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0sCisJCQkgICAgICBzdHJ1Y3QgdHRt
X3Jlc291cmNlICpyZXMsCiAJCQkgICAgICB1NjQgb2Zmc2V0LCB1NjQgbGVuZ3RoLAogCQkJICAg
ICAgc3RydWN0IGRldmljZSAqZGV2LAogCQkJICAgICAgZW51bSBkbWFfZGF0YV9kaXJlY3Rpb24g
ZGlyLApAQCAtNTQ1LDcgKzUzOSw3IEBAIGludCBhbWRncHVfdnJhbV9tZ3JfYWxsb2Nfc2d0KHN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAogCQlyZXR1cm4gLUVOT01FTTsKIAogCS8qIERldGVy
bWluZSB0aGUgbnVtYmVyIG9mIERSTV9NTSBub2RlcyB0byBleHBvcnQgKi8KLQlhbWRncHVfcmVz
X2ZpcnN0KG1lbSwgb2Zmc2V0LCBsZW5ndGgsICZjdXJzb3IpOworCWFtZGdwdV9yZXNfZmlyc3Qo
cmVzLCBvZmZzZXQsIGxlbmd0aCwgJmN1cnNvcik7CiAJd2hpbGUgKGN1cnNvci5yZW1haW5pbmcp
IHsKIAkJbnVtX2VudHJpZXMrKzsKIAkJYW1kZ3B1X3Jlc19uZXh0KCZjdXJzb3IsIGN1cnNvci5z
aXplKTsKQEAgLTU2NSw3ICs1NTksNyBAQCBpbnQgYW1kZ3B1X3ZyYW1fbWdyX2FsbG9jX3NndChz
dHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIAkgKiBhbmQgdGhlIG51bWJlciBvZiBieXRlcyBm
cm9tIGl0LiBBY2Nlc3MgdGhlIGZvbGxvd2luZwogCSAqIERSTV9NTSBub2RlKHMpIGlmIG1vcmUg
YnVmZmVyIG5lZWRzIHRvIGV4cG9ydGVkCiAJICovCi0JYW1kZ3B1X3Jlc19maXJzdChtZW0sIG9m
ZnNldCwgbGVuZ3RoLCAmY3Vyc29yKTsKKwlhbWRncHVfcmVzX2ZpcnN0KHJlcywgb2Zmc2V0LCBs
ZW5ndGgsICZjdXJzb3IpOwogCWZvcl9lYWNoX3NndGFibGVfc2coKCpzZ3QpLCBzZywgaSkgewog
CQlwaHlzX2FkZHJfdCBwaHlzID0gY3Vyc29yLnN0YXJ0ICsgYWRldi0+Z21jLmFwZXJfYmFzZTsK
IAkJc2l6ZV90IHNpemUgPSBjdXJzb3Iuc2l6ZTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX2dlbV92cmFtX2hl
bHBlci5jCmluZGV4IDE3YTRjNWQ0N2I2YS4uMmExMjI5YjgzNjRlIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vZHJtX2dlbV92cmFtX2hlbHBlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9k
cm1fZ2VtX3ZyYW1faGVscGVyLmMKQEAgLTI1MCw3ICsyNTAsOCBAQCBFWFBPUlRfU1lNQk9MKGRy
bV9nZW1fdnJhbV9wdXQpOwogc3RhdGljIHU2NCBkcm1fZ2VtX3ZyYW1fcGdfb2Zmc2V0KHN0cnVj
dCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8pCiB7CiAJLyogS2VlcCBUVE0gYmVoYXZpb3IgZm9y
IG5vdywgcmVtb3ZlIHdoZW4gZHJpdmVycyBhcmUgYXVkaXRlZCAqLwotCWlmIChXQVJOX09OX09O
Q0UoIWdiby0+Ym8ucmVzb3VyY2UtPm1tX25vZGUpKQorCWlmIChXQVJOX09OX09OQ0UoIWdiby0+
Ym8ucmVzb3VyY2UgfHwKKwkJCSBnYm8tPmJvLnJlc291cmNlLT5tZW1fdHlwZSA9PSBUVE1fUExf
U1lTVEVNKSkKIAkJcmV0dXJuIDA7CiAKIAlyZXR1cm4gZ2JvLT5iby5yZXNvdXJjZS0+c3RhcnQ7
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2JvLmMgYi9kcml2
ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2JvLmMKaW5kZXggYmU1NDZhMmQzZTM2Li43M2Rk
ZjhjODYxYTMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfYm8u
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2JvLmMKQEAgLTkxOCwxMiAr
OTE4LDggQEAgc3RhdGljIHZvaWQgbm91dmVhdV9ib19tb3ZlX250Znkoc3RydWN0IHR0bV9idWZm
ZXJfb2JqZWN0ICpibywKIAkJfQogCX0KIAotCWlmIChuZXdfcmVnKSB7Ci0JCWlmIChuZXdfcmVn
LT5tbV9ub2RlKQotCQkJbnZiby0+b2Zmc2V0ID0gKG5ld19yZWctPnN0YXJ0IDw8IFBBR0VfU0hJ
RlQpOwotCQllbHNlCi0JCQludmJvLT5vZmZzZXQgPSAwOwotCX0KKwlpZiAobmV3X3JlZykKKwkJ
bnZiby0+b2Zmc2V0ID0gKG5ld19yZWctPnN0YXJ0IDw8IFBBR0VfU0hJRlQpOwogCiB9CiAKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfbWVtLmMgYi9kcml2ZXJz
L2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X21lbS5jCmluZGV4IGExMDQ5ZTlmZWVlMS4uMGRlNjU0
OWZiODc1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X21lbS5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfbWVtLmMKQEAgLTE3OCwyNSAr
MTc4LDI0IEBAIHZvaWQKIG5vdXZlYXVfbWVtX2RlbChzdHJ1Y3QgdHRtX3Jlc291cmNlICpyZWcp
CiB7CiAJc3RydWN0IG5vdXZlYXVfbWVtICptZW0gPSBub3V2ZWF1X21lbShyZWcpOwotCWlmICgh
bWVtKQotCQlyZXR1cm47CisKIAlub3V2ZWF1X21lbV9maW5pKG1lbSk7Ci0Ja2ZyZWUocmVnLT5t
bV9ub2RlKTsKLQlyZWctPm1tX25vZGUgPSBOVUxMOworCWtmcmVlKG1lbSk7CiB9CiAKIGludAog
bm91dmVhdV9tZW1fbmV3KHN0cnVjdCBub3V2ZWF1X2NsaSAqY2xpLCB1OCBraW5kLCB1OCBjb21w
LAotCQlzdHJ1Y3QgdHRtX3Jlc291cmNlICpyZWcpCisJCXN0cnVjdCB0dG1fcmVzb3VyY2UgKipy
ZXMpCiB7CiAJc3RydWN0IG5vdXZlYXVfbWVtICptZW07CiAKIAlpZiAoIShtZW0gPSBremFsbG9j
KHNpemVvZigqbWVtKSwgR0ZQX0tFUk5FTCkpKQogCQlyZXR1cm4gLUVOT01FTTsKKwogCW1lbS0+
Y2xpID0gY2xpOwogCW1lbS0+a2luZCA9IGtpbmQ7CiAJbWVtLT5jb21wID0gY29tcDsKIAotCXJl
Zy0+bW1fbm9kZSA9IG1lbTsKKwkqcmVzID0gJm1lbS0+YmFzZTsKIAlyZXR1cm4gMDsKIH0KZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfbWVtLmggYi9kcml2ZXJz
L2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X21lbS5oCmluZGV4IDNhNmExYmUyZWQ1Mi4uMmMwMTE2
NmE5MGYyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X21lbS5o
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfbWVtLmgKQEAgLTYsMTIgKzYs
NiBAQCBzdHJ1Y3QgdHRtX3R0OwogI2luY2x1ZGUgPG52aWYvbWVtLmg+CiAjaW5jbHVkZSA8bnZp
Zi92bW0uaD4KIAotc3RhdGljIGlubGluZSBzdHJ1Y3Qgbm91dmVhdV9tZW0gKgotbm91dmVhdV9t
ZW0oc3RydWN0IHR0bV9yZXNvdXJjZSAqcmVnKQotewotCXJldHVybiByZWctPm1tX25vZGU7Ci19
Ci0KIHN0cnVjdCBub3V2ZWF1X21lbSB7CiAJc3RydWN0IHR0bV9yZXNvdXJjZSBiYXNlOwogCXN0
cnVjdCBub3V2ZWF1X2NsaSAqY2xpOwpAQCAtMjEsOCArMTUsMTQgQEAgc3RydWN0IG5vdXZlYXVf
bWVtIHsKIAlzdHJ1Y3QgbnZpZl92bWEgdm1hWzJdOwogfTsKIAorc3RhdGljIGlubGluZSBzdHJ1
Y3Qgbm91dmVhdV9tZW0gKgorbm91dmVhdV9tZW0oc3RydWN0IHR0bV9yZXNvdXJjZSAqcmVnKQor
eworCXJldHVybiBjb250YWluZXJfb2YocmVnLCBzdHJ1Y3Qgbm91dmVhdV9tZW0sIGJhc2UpOwor
fQorCiBpbnQgbm91dmVhdV9tZW1fbmV3KHN0cnVjdCBub3V2ZWF1X2NsaSAqLCB1OCBraW5kLCB1
OCBjb21wLAotCQkgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqKTsKKwkJICAgIHN0cnVjdCB0dG1f
cmVzb3VyY2UgKiopOwogdm9pZCBub3V2ZWF1X21lbV9kZWwoc3RydWN0IHR0bV9yZXNvdXJjZSAq
KTsKIGludCBub3V2ZWF1X21lbV92cmFtKHN0cnVjdCB0dG1fcmVzb3VyY2UgKiwgYm9vbCBjb250
aWcsIHU4IHBhZ2UpOwogaW50IG5vdXZlYXVfbWVtX2hvc3Qoc3RydWN0IHR0bV9yZXNvdXJjZSAq
LCBzdHJ1Y3QgdHRtX3R0ICopOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUv
bm91dmVhdV90dG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfdHRtLmMKaW5k
ZXggNWU1Y2UyZWM4OWYwLi43MjNmZWQyN2ZlNzcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9ub3V2ZWF1L25vdXZlYXVfdHRtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91
dmVhdV90dG0uYwpAQCAtNDYsNyArNDYsNyBAQCBzdGF0aWMgaW50CiBub3V2ZWF1X3ZyYW1fbWFu
YWdlcl9uZXcoc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYW4sCiAJCQkgc3RydWN0IHR0
bV9idWZmZXJfb2JqZWN0ICpibywKIAkJCSBjb25zdCBzdHJ1Y3QgdHRtX3BsYWNlICpwbGFjZSwK
LQkJCSBzdHJ1Y3QgdHRtX3Jlc291cmNlICpyZWcpCisJCQkgc3RydWN0IHR0bV9yZXNvdXJjZSAq
KnJlcykKIHsKIAlzdHJ1Y3Qgbm91dmVhdV9ibyAqbnZibyA9IG5vdXZlYXVfYm8oYm8pOwogCXN0
cnVjdCBub3V2ZWF1X2RybSAqZHJtID0gbm91dmVhdV9iZGV2KGJvLT5iZGV2KTsKQEAgLTU1LDE1
ICs1NSwxNSBAQCBub3V2ZWF1X3ZyYW1fbWFuYWdlcl9uZXcoc3RydWN0IHR0bV9yZXNvdXJjZV9t
YW5hZ2VyICptYW4sCiAJaWYgKGRybS0+Y2xpZW50LmRldmljZS5pbmZvLnJhbV9zaXplID09IDAp
CiAJCXJldHVybiAtRU5PTUVNOwogCi0JcmV0ID0gbm91dmVhdV9tZW1fbmV3KCZkcm0tPm1hc3Rl
ciwgbnZiby0+a2luZCwgbnZiby0+Y29tcCwgcmVnKTsKKwlyZXQgPSBub3V2ZWF1X21lbV9uZXco
JmRybS0+bWFzdGVyLCBudmJvLT5raW5kLCBudmJvLT5jb21wLCByZXMpOwogCWlmIChyZXQpCiAJ
CXJldHVybiByZXQ7CiAKLQl0dG1fcmVzb3VyY2VfaW5pdChibywgcGxhY2UsIHJlZy0+bW1fbm9k
ZSk7CisJdHRtX3Jlc291cmNlX2luaXQoYm8sIHBsYWNlLCAqcmVzKTsKIAotCXJldCA9IG5vdXZl
YXVfbWVtX3ZyYW0ocmVnLCBudmJvLT5jb250aWcsIG52Ym8tPnBhZ2UpOworCXJldCA9IG5vdXZl
YXVfbWVtX3ZyYW0oKnJlcywgbnZiby0+Y29udGlnLCBudmJvLT5wYWdlKTsKIAlpZiAocmV0KSB7
Ci0JCW5vdXZlYXVfbWVtX2RlbChyZWcpOworCQlub3V2ZWF1X21lbV9kZWwoKnJlcyk7CiAJCXJl
dHVybiByZXQ7CiAJfQogCkBAIC03OSwxOCArNzksMTggQEAgc3RhdGljIGludAogbm91dmVhdV9n
YXJ0X21hbmFnZXJfbmV3KHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuLAogCQkJIHN0
cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJCQkgY29uc3Qgc3RydWN0IHR0bV9wbGFjZSAq
cGxhY2UsCi0JCQkgc3RydWN0IHR0bV9yZXNvdXJjZSAqcmVnKQorCQkJIHN0cnVjdCB0dG1fcmVz
b3VyY2UgKipyZXMpCiB7CiAJc3RydWN0IG5vdXZlYXVfYm8gKm52Ym8gPSBub3V2ZWF1X2JvKGJv
KTsKIAlzdHJ1Y3Qgbm91dmVhdV9kcm0gKmRybSA9IG5vdXZlYXVfYmRldihiby0+YmRldik7CiAJ
aW50IHJldDsKIAotCXJldCA9IG5vdXZlYXVfbWVtX25ldygmZHJtLT5tYXN0ZXIsIG52Ym8tPmtp
bmQsIG52Ym8tPmNvbXAsIHJlZyk7CisJcmV0ID0gbm91dmVhdV9tZW1fbmV3KCZkcm0tPm1hc3Rl
ciwgbnZiby0+a2luZCwgbnZiby0+Y29tcCwgcmVzKTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0
OwogCi0JdHRtX3Jlc291cmNlX2luaXQoYm8sIHBsYWNlLCByZWctPm1tX25vZGUpOwotCXJlZy0+
c3RhcnQgPSAwOworCXR0bV9yZXNvdXJjZV9pbml0KGJvLCBwbGFjZSwgKnJlcyk7CisJKCpyZXMp
LT5zdGFydCA9IDA7CiAJcmV0dXJuIDA7CiB9CiAKQEAgLTEwMywyNyArMTAzLDI3IEBAIHN0YXRp
YyBpbnQKIG52MDRfZ2FydF9tYW5hZ2VyX25ldyhzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIg
Km1hbiwKIAkJICAgICAgc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAkJICAgICAgY29u
c3Qgc3RydWN0IHR0bV9wbGFjZSAqcGxhY2UsCi0JCSAgICAgIHN0cnVjdCB0dG1fcmVzb3VyY2Ug
KnJlZykKKwkJICAgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqKnJlcykKIHsKIAlzdHJ1Y3Qgbm91
dmVhdV9ibyAqbnZibyA9IG5vdXZlYXVfYm8oYm8pOwogCXN0cnVjdCBub3V2ZWF1X2RybSAqZHJt
ID0gbm91dmVhdV9iZGV2KGJvLT5iZGV2KTsKIAlzdHJ1Y3Qgbm91dmVhdV9tZW0gKm1lbTsKIAlp
bnQgcmV0OwogCi0JcmV0ID0gbm91dmVhdV9tZW1fbmV3KCZkcm0tPm1hc3RlciwgbnZiby0+a2lu
ZCwgbnZiby0+Y29tcCwgcmVnKTsKLQltZW0gPSBub3V2ZWF1X21lbShyZWcpOworCXJldCA9IG5v
dXZlYXVfbWVtX25ldygmZHJtLT5tYXN0ZXIsIG52Ym8tPmtpbmQsIG52Ym8tPmNvbXAsIHJlcyk7
CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIAotCXR0bV9yZXNvdXJjZV9pbml0KGJvLCBwbGFj
ZSwgcmVnLT5tbV9ub2RlKTsKKwltZW0gPSBub3V2ZWF1X21lbSgqcmVzKTsKKwl0dG1fcmVzb3Vy
Y2VfaW5pdChibywgcGxhY2UsICpyZXMpOwogCXJldCA9IG52aWZfdm1tX2dldCgmbWVtLT5jbGkt
PnZtbS52bW0sIFBURVMsIGZhbHNlLCAxMiwgMCwKLQkJCSAgIChsb25nKXJlZy0+bnVtX3BhZ2Vz
IDw8IFBBR0VfU0hJRlQsICZtZW0tPnZtYVswXSk7CisJCQkgICAobG9uZykoKnJlcyktPm51bV9w
YWdlcyA8PCBQQUdFX1NISUZULCAmbWVtLT52bWFbMF0pOwogCWlmIChyZXQpIHsKLQkJbm91dmVh
dV9tZW1fZGVsKHJlZyk7CisJCW5vdXZlYXVfbWVtX2RlbCgqcmVzKTsKIAkJcmV0dXJuIHJldDsK
IAl9CiAKLQlyZWctPnN0YXJ0ID0gbWVtLT52bWFbMF0uYWRkciA+PiBQQUdFX1NISUZUOworCSgq
cmVzKS0+c3RhcnQgPSBtZW0tPnZtYVswXS5hZGRyID4+IFBBR0VfU0hJRlQ7CiAJcmV0dXJuIDA7
CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3JhbmdlX21hbmFnZXIu
YyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3JhbmdlX21hbmFnZXIuYwppbmRleCBjZTVkMDdj
YTM4NGMuLmMzMmUxYWVlMjQ4MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1f
cmFuZ2VfbWFuYWdlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3JhbmdlX21hbmFn
ZXIuYwpAQCAtNTgsNyArNTgsNyBAQCB0b19yYW5nZV9tYW5hZ2VyKHN0cnVjdCB0dG1fcmVzb3Vy
Y2VfbWFuYWdlciAqbWFuKQogc3RhdGljIGludCB0dG1fcmFuZ2VfbWFuX2FsbG9jKHN0cnVjdCB0
dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuLAogCQkJICAgICAgIHN0cnVjdCB0dG1fYnVmZmVyX29i
amVjdCAqYm8sCiAJCQkgICAgICAgY29uc3Qgc3RydWN0IHR0bV9wbGFjZSAqcGxhY2UsCi0JCQkg
ICAgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqbWVtKQorCQkJICAgICAgIHN0cnVjdCB0dG1fcmVz
b3VyY2UgKipyZXMpCiB7CiAJc3RydWN0IHR0bV9yYW5nZV9tYW5hZ2VyICpybWFuID0gdG9fcmFu
Z2VfbWFuYWdlcihtYW4pOwogCXN0cnVjdCB0dG1fcmFuZ2VfbWdyX25vZGUgKm5vZGU7CkBAIC04
MywzNyArODMsMzAgQEAgc3RhdGljIGludCB0dG1fcmFuZ2VfbWFuX2FsbG9jKHN0cnVjdCB0dG1f
cmVzb3VyY2VfbWFuYWdlciAqbWFuLAogCiAJc3Bpbl9sb2NrKCZybWFuLT5sb2NrKTsKIAlyZXQg
PSBkcm1fbW1faW5zZXJ0X25vZGVfaW5fcmFuZ2UobW0sICZub2RlLT5tbV9ub2Rlc1swXSwKLQkJ
CQkJICBtZW0tPm51bV9wYWdlcywgYm8tPnBhZ2VfYWxpZ25tZW50LCAwLAorCQkJCQkgIG5vZGUt
PmJhc2UubnVtX3BhZ2VzLAorCQkJCQkgIGJvLT5wYWdlX2FsaWdubWVudCwgMCwKIAkJCQkJICBw
bGFjZS0+ZnBmbiwgbHBmbiwgbW9kZSk7CiAJc3Bpbl91bmxvY2soJnJtYW4tPmxvY2spOwogCi0J
aWYgKHVubGlrZWx5KHJldCkpIHsKKwlpZiAodW5saWtlbHkocmV0KSkKIAkJa2ZyZWUobm9kZSk7
Ci0JfSBlbHNlIHsKLQkJbWVtLT5tbV9ub2RlID0gJm5vZGUtPm1tX25vZGVzWzBdOwotCQltZW0t
PnN0YXJ0ID0gbm9kZS0+bW1fbm9kZXNbMF0uc3RhcnQ7Ci0JfQorCWVsc2UKKwkJbm9kZS0+YmFz
ZS5zdGFydCA9IG5vZGUtPm1tX25vZGVzWzBdLnN0YXJ0OwogCiAJcmV0dXJuIHJldDsKIH0KIAog
c3RhdGljIHZvaWQgdHRtX3JhbmdlX21hbl9mcmVlKHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdl
ciAqbWFuLAotCQkJICAgICAgIHN0cnVjdCB0dG1fcmVzb3VyY2UgKm1lbSkKKwkJCSAgICAgICBz
dHJ1Y3QgdHRtX3Jlc291cmNlICpyZXMpCiB7CisJc3RydWN0IHR0bV9yYW5nZV9tZ3Jfbm9kZSAq
bm9kZSA9IHRvX3R0bV9yYW5nZV9tZ3Jfbm9kZShyZXMpOwogCXN0cnVjdCB0dG1fcmFuZ2VfbWFu
YWdlciAqcm1hbiA9IHRvX3JhbmdlX21hbmFnZXIobWFuKTsKLQlzdHJ1Y3QgdHRtX3JhbmdlX21n
cl9ub2RlICpub2RlOwotCi0JaWYgKCFtZW0tPm1tX25vZGUpCi0JCXJldHVybjsKLQotCW5vZGUg
PSB0b190dG1fcmFuZ2VfbWdyX25vZGUobWVtKTsKIAogCXNwaW5fbG9jaygmcm1hbi0+bG9jayk7
CiAJZHJtX21tX3JlbW92ZV9ub2RlKCZub2RlLT5tbV9ub2Rlc1swXSk7CiAJc3Bpbl91bmxvY2so
JnJtYW4tPmxvY2spOwogCiAJa2ZyZWUobm9kZSk7Ci0JbWVtLT5tbV9ub2RlID0gTlVMTDsKIH0K
IAogc3RhdGljIHZvaWQgdHRtX3JhbmdlX21hbl9kZWJ1ZyhzdHJ1Y3QgdHRtX3Jlc291cmNlX21h
bmFnZXIgKm1hbiwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3Jlc291cmNl
LmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9yZXNvdXJjZS5jCmluZGV4IGI0MTJhZTUxNWU5
OC4uMmE2ODE0NTU3MmNjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9yZXNv
dXJjZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3Jlc291cmNlLmMKQEAgLTI5LDcg
KzI5LDYgQEAgdm9pZCB0dG1fcmVzb3VyY2VfaW5pdChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3Qg
KmJvLAogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgdHRtX3BsYWNlICpwbGFj
ZSwKICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqcmVzKQogewot
CXJlcy0+bW1fbm9kZSA9IE5VTEw7CiAJcmVzLT5zdGFydCA9IDA7CiAJcmVzLT5udW1fcGFnZXMg
PSBQRk5fVVAoYm8tPmJhc2Uuc2l6ZSk7CiAJcmVzLT5tZW1fdHlwZSA9IHBsYWNlLT5tZW1fdHlw
ZTsKQEAgLTQ3LDE5ICs0Niw4IEBAIGludCB0dG1fcmVzb3VyY2VfYWxsb2Moc3RydWN0IHR0bV9i
dWZmZXJfb2JqZWN0ICpibywKIHsKIAlzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiA9
CiAJCXR0bV9tYW5hZ2VyX3R5cGUoYm8tPmJkZXYsIHBsYWNlLT5tZW1fdHlwZSk7Ci0Jc3RydWN0
IHR0bV9yZXNvdXJjZSAqcmVzOwotCWludCByOwotCi0JcmVzID0ga21hbGxvYyhzaXplb2YoKnJl
cyksIEdGUF9LRVJORUwpOwotCXR0bV9yZXNvdXJjZV9pbml0KGJvLCBwbGFjZSwgcmVzKTsKLQly
ID0gbWFuLT5mdW5jLT5hbGxvYyhtYW4sIGJvLCBwbGFjZSwgcmVzKTsKLQlpZiAocikgewotCQlr
ZnJlZShyZXMpOwotCQlyZXR1cm4gcjsKLQl9CiAKLQkqcmVzX3B0ciA9IHJlczsKLQlyZXR1cm4g
MDsKKwlyZXR1cm4gbWFuLT5mdW5jLT5hbGxvYyhtYW4sIGJvLCBwbGFjZSwgcmVzX3B0cik7CiB9
CiAKIHZvaWQgdHRtX3Jlc291cmNlX2ZyZWUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywg
c3RydWN0IHR0bV9yZXNvdXJjZSAqKnJlcykKQEAgLTcxLDcgKzU5LDYgQEAgdm9pZCB0dG1fcmVz
b3VyY2VfZnJlZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLCBzdHJ1Y3QgdHRtX3Jlc291
cmNlICoqcmVzKQogCiAJbWFuID0gdHRtX21hbmFnZXJfdHlwZShiby0+YmRldiwgKCpyZXMpLT5t
ZW1fdHlwZSk7CiAJbWFuLT5mdW5jLT5mcmVlKG1hbiwgKnJlcyk7Ci0Ja2ZyZWUoKnJlcyk7CiAJ
KnJlcyA9IE5VTEw7CiB9CiBFWFBPUlRfU1lNQk9MKHR0bV9yZXNvdXJjZV9mcmVlKTsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3N5c19tYW5hZ2VyLmMgYi9kcml2ZXJzL2dw
dS9kcm0vdHRtL3R0bV9zeXNfbWFuYWdlci5jCmluZGV4IGE5MjYxMTRlZGZlNS4uM2I5ZTc2YWJl
OTdlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9zeXNfbWFuYWdlci5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3N5c19tYW5hZ2VyLmMKQEAgLTgsMjAgKzgsMjAg
QEAKIHN0YXRpYyBpbnQgdHRtX3N5c19tYW5fYWxsb2Moc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5h
Z2VyICptYW4sCiAJCQkgICAgIHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJCQkgICAg
IGNvbnN0IHN0cnVjdCB0dG1fcGxhY2UgKnBsYWNlLAotCQkJICAgICBzdHJ1Y3QgdHRtX3Jlc291
cmNlICptZW0pCisJCQkgICAgIHN0cnVjdCB0dG1fcmVzb3VyY2UgKipyZXMpCiB7Ci0JbWVtLT5t
bV9ub2RlID0ga3phbGxvYyhzaXplb2YoKm1lbSksIEdGUF9LRVJORUwpOwotCWlmICghbWVtLT5t
bV9ub2RlKQorCSpyZXMgPSBremFsbG9jKHNpemVvZigqKnJlcyksIEdGUF9LRVJORUwpOworCWlm
ICghKnJlcykKIAkJcmV0dXJuIC1FTk9NRU07CiAKLQl0dG1fcmVzb3VyY2VfaW5pdChibywgcGxh
Y2UsIG1lbS0+bW1fbm9kZSk7CisJdHRtX3Jlc291cmNlX2luaXQoYm8sIHBsYWNlLCAqcmVzKTsK
IAlyZXR1cm4gMDsKIH0KIAogc3RhdGljIHZvaWQgdHRtX3N5c19tYW5fZnJlZShzdHJ1Y3QgdHRt
X3Jlc291cmNlX21hbmFnZXIgKm1hbiwKLQkJCSAgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqbWVt
KQorCQkJICAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlICpyZXMpCiB7Ci0Ja2ZyZWUobWVtLT5tbV9u
b2RlKTsKKwlrZnJlZShyZXMpOwogfQogCiBzdGF0aWMgY29uc3Qgc3RydWN0IHR0bV9yZXNvdXJj
ZV9tYW5hZ2VyX2Z1bmMgdHRtX3N5c19tYW5hZ2VyX2Z1bmMgPSB7CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9nbXJpZF9tYW5hZ2VyLmMgYi9kcml2ZXJzL2dwdS9k
cm0vdm13Z2Z4L3Ztd2dmeF9nbXJpZF9tYW5hZ2VyLmMKaW5kZXggODJhNWU2NDg5ODEwLi4zNTQy
MTlhMjdmMzEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2dtcmlk
X21hbmFnZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9nbXJpZF9tYW5h
Z2VyLmMKQEAgLTUyLDE2ICs1MiwxNiBAQCBzdGF0aWMgc3RydWN0IHZtd2dmeF9nbXJpZF9tYW4g
KnRvX2dtcmlkX21hbmFnZXIoc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYQogc3RhdGlj
IGludCB2bXdfZ21yaWRfbWFuX2dldF9ub2RlKHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAq
bWFuLAogCQkJCSAgc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAkJCQkgIGNvbnN0IHN0
cnVjdCB0dG1fcGxhY2UgKnBsYWNlLAotCQkJCSAgc3RydWN0IHR0bV9yZXNvdXJjZSAqbWVtKQor
CQkJCSAgc3RydWN0IHR0bV9yZXNvdXJjZSAqKnJlcykKIHsKIAlzdHJ1Y3Qgdm13Z2Z4X2dtcmlk
X21hbiAqZ21hbiA9IHRvX2dtcmlkX21hbmFnZXIobWFuKTsKIAlpbnQgaWQ7CiAKLQltZW0tPm1t
X25vZGUgPSBrbWFsbG9jKHNpemVvZigqbWVtKSwgR0ZQX0tFUk5FTCk7Ci0JaWYgKCFtZW0tPm1t
X25vZGUpCisJKnJlcyA9IGttYWxsb2Moc2l6ZW9mKCpyZXMpLCBHRlBfS0VSTkVMKTsKKwlpZiAo
ISpyZXMpCiAJCXJldHVybiAtRU5PTUVNOwogCi0JdHRtX3Jlc291cmNlX2luaXQoYm8sIHBsYWNl
LCBtZW0tPm1tX25vZGUpOworCXR0bV9yZXNvdXJjZV9pbml0KGJvLCBwbGFjZSwgKnJlcyk7CiAK
IAlpZCA9IGlkYV9hbGxvY19tYXgoJmdtYW4tPmdtcl9pZGEsIGdtYW4tPm1heF9nbXJfaWRzIC0g
MSwgR0ZQX0tFUk5FTCk7CiAJaWYgKGlkIDwgMCkKQEAgLTcwLDM0ICs3MCwzNCBAQCBzdGF0aWMg
aW50IHZtd19nbXJpZF9tYW5fZ2V0X25vZGUoc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICpt
YW4sCiAJc3Bpbl9sb2NrKCZnbWFuLT5sb2NrKTsKIAogCWlmIChnbWFuLT5tYXhfZ21yX3BhZ2Vz
ID4gMCkgewotCQlnbWFuLT51c2VkX2dtcl9wYWdlcyArPSBtZW0tPm51bV9wYWdlczsKKwkJZ21h
bi0+dXNlZF9nbXJfcGFnZXMgKz0gKCpyZXMpLT5udW1fcGFnZXM7CiAJCWlmICh1bmxpa2VseShn
bWFuLT51c2VkX2dtcl9wYWdlcyA+IGdtYW4tPm1heF9nbXJfcGFnZXMpKQogCQkJZ290byBub3Nw
YWNlOwogCX0KIAotCW1lbS0+bW1fbm9kZSA9IGdtYW47Ci0JbWVtLT5zdGFydCA9IGlkOworCSgq
cmVzKS0+c3RhcnQgPSBpZDsKIAogCXNwaW5fdW5sb2NrKCZnbWFuLT5sb2NrKTsKIAlyZXR1cm4g
MDsKIAogbm9zcGFjZToKLQlnbWFuLT51c2VkX2dtcl9wYWdlcyAtPSBtZW0tPm51bV9wYWdlczsK
KwlnbWFuLT51c2VkX2dtcl9wYWdlcyAtPSAoKnJlcyktPm51bV9wYWdlczsKIAlzcGluX3VubG9j
aygmZ21hbi0+bG9jayk7CiAJaWRhX2ZyZWUoJmdtYW4tPmdtcl9pZGEsIGlkKTsKKwlrZnJlZSgq
cmVzKTsKIAlyZXR1cm4gLUVOT1NQQzsKIH0KIAogc3RhdGljIHZvaWQgdm13X2dtcmlkX21hbl9w
dXRfbm9kZShzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiwKLQkJCQkgICBzdHJ1Y3Qg
dHRtX3Jlc291cmNlICptZW0pCisJCQkJICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqcmVzKQogewog
CXN0cnVjdCB2bXdnZnhfZ21yaWRfbWFuICpnbWFuID0gdG9fZ21yaWRfbWFuYWdlcihtYW4pOwog
Ci0JaWRhX2ZyZWUoJmdtYW4tPmdtcl9pZGEsIG1lbS0+c3RhcnQpOworCWlkYV9mcmVlKCZnbWFu
LT5nbXJfaWRhLCByZXMtPnN0YXJ0KTsKIAlzcGluX2xvY2soJmdtYW4tPmxvY2spOwotCWdtYW4t
PnVzZWRfZ21yX3BhZ2VzIC09IG1lbS0+bnVtX3BhZ2VzOworCWdtYW4tPnVzZWRfZ21yX3BhZ2Vz
IC09IHJlcy0+bnVtX3BhZ2VzOwogCXNwaW5fdW5sb2NrKCZnbWFuLT5sb2NrKTsKLQlrZnJlZSht
ZW0tPm1tX25vZGUpOworCWtmcmVlKHJlcyk7CiB9CiAKIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdHRt
X3Jlc291cmNlX21hbmFnZXJfZnVuYyB2bXdfZ21yaWRfbWFuYWdlcl9mdW5jOwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfdGhwLmMgYi9kcml2ZXJzL2dwdS9kcm0v
dm13Z2Z4L3Ztd2dmeF90aHAuYwppbmRleCA4NzY1ODM1Njk2YWMuLjJhM2QzNDY4ZTRlMCAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfdGhwLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfdGhwLmMKQEAgLTUxLDcgKzUxLDcgQEAgc3RhdGljIGlu
dCB2bXdfdGhwX2luc2VydF9hbGlnbmVkKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiBz
dGF0aWMgaW50IHZtd190aHBfZ2V0X25vZGUoc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICpt
YW4sCiAJCQkgICAgc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAkJCSAgICBjb25zdCBz
dHJ1Y3QgdHRtX3BsYWNlICpwbGFjZSwKLQkJCSAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0p
CisJCQkgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqKnJlcykKIHsKIAlzdHJ1Y3Qgdm13X3RocF9t
YW5hZ2VyICpybWFuID0gdG9fdGhwX21hbmFnZXIobWFuKTsKIAlzdHJ1Y3QgZHJtX21tICptbSA9
ICZybWFuLT5tbTsKQEAgLTc4LDI2ICs3OCwyNyBAQCBzdGF0aWMgaW50IHZtd190aHBfZ2V0X25v
ZGUoc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYW4sCiAJc3Bpbl9sb2NrKCZybWFuLT5s
b2NrKTsKIAlpZiAoSVNfRU5BQkxFRChDT05GSUdfSEFWRV9BUkNIX1RSQU5TUEFSRU5UX0hVR0VQ
QUdFX1BVRCkpIHsKIAkJYWxpZ25fcGFnZXMgPSAoSFBBR0VfUFVEX1NJWkUgPj4gUEFHRV9TSElG
VCk7Ci0JCWlmIChtZW0tPm51bV9wYWdlcyA+PSBhbGlnbl9wYWdlcykgeworCQlpZiAobm9kZS0+
YmFzZS5udW1fcGFnZXMgPj0gYWxpZ25fcGFnZXMpIHsKIAkJCXJldCA9IHZtd190aHBfaW5zZXJ0
X2FsaWduZWQoYm8sIG1tLCAmbm9kZS0+bW1fbm9kZXNbMF0sCi0JCQkJCQkgICAgIGFsaWduX3Bh
Z2VzLCBwbGFjZSwgbWVtLAotCQkJCQkJICAgICBscGZuLCBtb2RlKTsKKwkJCQkJCSAgICAgYWxp
Z25fcGFnZXMsIHBsYWNlLAorCQkJCQkJICAgICAmbm9kZS0+YmFzZSwgbHBmbiwgbW9kZSk7CiAJ
CQlpZiAoIXJldCkKIAkJCQlnb3RvIGZvdW5kX3VubG9jazsKIAkJfQogCX0KIAogCWFsaWduX3Bh
Z2VzID0gKEhQQUdFX1BNRF9TSVpFID4+IFBBR0VfU0hJRlQpOwotCWlmIChtZW0tPm51bV9wYWdl
cyA+PSBhbGlnbl9wYWdlcykgeworCWlmIChub2RlLT5iYXNlLm51bV9wYWdlcyA+PSBhbGlnbl9w
YWdlcykgewogCQlyZXQgPSB2bXdfdGhwX2luc2VydF9hbGlnbmVkKGJvLCBtbSwgJm5vZGUtPm1t
X25vZGVzWzBdLAotCQkJCQkgICAgIGFsaWduX3BhZ2VzLCBwbGFjZSwgbWVtLCBscGZuLAotCQkJ
CQkgICAgIG1vZGUpOworCQkJCQkgICAgIGFsaWduX3BhZ2VzLCBwbGFjZSwgJm5vZGUtPmJhc2Us
CisJCQkJCSAgICAgbHBmbiwgbW9kZSk7CiAJCWlmICghcmV0KQogCQkJZ290byBmb3VuZF91bmxv
Y2s7CiAJfQogCiAJcmV0ID0gZHJtX21tX2luc2VydF9ub2RlX2luX3JhbmdlKG1tLCAmbm9kZS0+
bW1fbm9kZXNbMF0sCi0JCQkJCSAgbWVtLT5udW1fcGFnZXMsIGJvLT5wYWdlX2FsaWdubWVudCwg
MCwKKwkJCQkJICBub2RlLT5iYXNlLm51bV9wYWdlcywKKwkJCQkJICBiby0+cGFnZV9hbGlnbm1l
bnQsIDAsCiAJCQkJCSAgcGxhY2UtPmZwZm4sIGxwZm4sIG1vZGUpOwogZm91bmRfdW5sb2NrOgog
CXNwaW5fdW5sb2NrKCZybWFuLT5sb2NrKTsKQEAgLTEwNSwyMCArMTA2LDE4IEBAIHN0YXRpYyBp
bnQgdm13X3RocF9nZXRfbm9kZShzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiwKIAlp
ZiAodW5saWtlbHkocmV0KSkgewogCQlrZnJlZShub2RlKTsKIAl9IGVsc2UgewotCQltZW0tPm1t
X25vZGUgPSAmbm9kZS0+bW1fbm9kZXNbMF07Ci0JCW1lbS0+c3RhcnQgPSBub2RlLT5tbV9ub2Rl
c1swXS5zdGFydDsKKwkJbm9kZS0+YmFzZS5zdGFydCA9IG5vZGUtPm1tX25vZGVzWzBdLnN0YXJ0
OworCQkqcmVzID0gJm5vZGUtPmJhc2U7CiAJfQogCiAJcmV0dXJuIHJldDsKIH0KIAotCi0KIHN0
YXRpYyB2b2lkIHZtd190aHBfcHV0X25vZGUoc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICpt
YW4sCi0JCQkgICAgIHN0cnVjdCB0dG1fcmVzb3VyY2UgKm1lbSkKKwkJCSAgICAgc3RydWN0IHR0
bV9yZXNvdXJjZSAqcmVzKQogeworCXN0cnVjdCB0dG1fcmFuZ2VfbWdyX25vZGUgKm5vZGUgPSB0
b190dG1fcmFuZ2VfbWdyX25vZGUocmVzKTsKIAlzdHJ1Y3Qgdm13X3RocF9tYW5hZ2VyICpybWFu
ID0gdG9fdGhwX21hbmFnZXIobWFuKTsKLQlzdHJ1Y3QgdHRtX3JhbmdlX21ncl9ub2RlICogbm9k
ZSA9IG1lbS0+bW1fbm9kZTsKIAogCXNwaW5fbG9jaygmcm1hbi0+bG9jayk7CiAJZHJtX21tX3Jl
bW92ZV9ub2RlKCZub2RlLT5tbV9ub2Rlc1swXSk7CmRpZmYgLS1naXQgYS9pbmNsdWRlL2RybS90
dG0vdHRtX3JhbmdlX21hbmFnZXIuaCBiL2luY2x1ZGUvZHJtL3R0bS90dG1fcmFuZ2VfbWFuYWdl
ci5oCmluZGV4IGUwMmI2YzhkMzU1ZS4uMjJiNmZhNDJhYzIwIDEwMDY0NAotLS0gYS9pbmNsdWRl
L2RybS90dG0vdHRtX3JhbmdlX21hbmFnZXIuaAorKysgYi9pbmNsdWRlL2RybS90dG0vdHRtX3Jh
bmdlX21hbmFnZXIuaApAQCAtMzAsOCArMzAsNyBAQCBzdHJ1Y3QgdHRtX3JhbmdlX21ncl9ub2Rl
IHsKIHN0YXRpYyBpbmxpbmUgc3RydWN0IHR0bV9yYW5nZV9tZ3Jfbm9kZSAqCiB0b190dG1fcmFu
Z2VfbWdyX25vZGUoc3RydWN0IHR0bV9yZXNvdXJjZSAqcmVzKQogewotCXJldHVybiBjb250YWlu
ZXJfb2YocmVzLT5tbV9ub2RlLCBzdHJ1Y3QgdHRtX3JhbmdlX21ncl9ub2RlLAotCQkJICAgIG1t
X25vZGVzWzFdKTsKKwlyZXR1cm4gY29udGFpbmVyX29mKHJlcywgc3RydWN0IHR0bV9yYW5nZV9t
Z3Jfbm9kZSwgYmFzZSk7CiB9CiAKIGludCB0dG1fcmFuZ2VfbWFuX2luaXQoc3RydWN0IHR0bV9k
ZXZpY2UgKmJkZXYsCmRpZmYgLS1naXQgYS9pbmNsdWRlL2RybS90dG0vdHRtX3Jlc291cmNlLmgg
Yi9pbmNsdWRlL2RybS90dG0vdHRtX3Jlc291cmNlLmgKaW5kZXggODAzZTQ4NzVkNzc5Li40YWJi
OTViOWZkMTEgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvZHJtL3R0bS90dG1fcmVzb3VyY2UuaAorKysg
Yi9pbmNsdWRlL2RybS90dG0vdHRtX3Jlc291cmNlLmgKQEAgLTQ1LDQ2ICs0NSwzOCBAQCBzdHJ1
Y3QgdHRtX3Jlc291cmNlX21hbmFnZXJfZnVuYyB7CiAJICoKIAkgKiBAbWFuOiBQb2ludGVyIHRv
IGEgbWVtb3J5IHR5cGUgbWFuYWdlci4KIAkgKiBAYm86IFBvaW50ZXIgdG8gdGhlIGJ1ZmZlciBv
YmplY3Qgd2UncmUgYWxsb2NhdGluZyBzcGFjZSBmb3IuCi0JICogQHBsYWNlbWVudDogUGxhY2Vt
ZW50IGRldGFpbHMuCi0JICogQGZsYWdzOiBBZGRpdGlvbmFsIHBsYWNlbWVudCBmbGFncy4KLQkg
KiBAbWVtOiBQb2ludGVyIHRvIGEgc3RydWN0IHR0bV9yZXNvdXJjZSB0byBiZSBmaWxsZWQgaW4u
CisJICogQHBsYWNlOiBQbGFjZW1lbnQgZGV0YWlscy4KKwkgKiBAcmVzOiBSZXN1bHRpbmcgcG9p
bnRlciB0byB0aGUgdHRtX3Jlc291cmNlLgogCSAqCiAJICogVGhpcyBmdW5jdGlvbiBzaG91bGQg
YWxsb2NhdGUgc3BhY2UgaW4gdGhlIG1lbW9yeSB0eXBlIG1hbmFnZWQKLQkgKiBieSBAbWFuLiBQ
bGFjZW1lbnQgZGV0YWlscyBpZgotCSAqIGFwcGxpY2FibGUgYXJlIGdpdmVuIGJ5IEBwbGFjZW1l
bnQuIElmIHN1Y2Nlc3NmdWwsCi0JICogQG1lbTo6bW1fbm9kZSBzaG91bGQgYmUgc2V0IHRvIGEg
bm9uLW51bGwgdmFsdWUsIGFuZAotCSAqIEBtZW06OnN0YXJ0IHNob3VsZCBiZSBzZXQgdG8gYSB2
YWx1ZSBpZGVudGlmeWluZyB0aGUgYmVnaW5uaW5nCisJICogYnkgQG1hbi4gUGxhY2VtZW50IGRl
dGFpbHMgaWYgYXBwbGljYWJsZSBhcmUgZ2l2ZW4gYnkgQHBsYWNlLiBJZgorCSAqIHN1Y2Nlc3Nm
dWwsIGEgZmlsbGVkIGluIHR0bV9yZXNvdXJjZSBvYmplY3Qgc2hvdWxkIGJlIHJldHVybmVkIGlu
CisJICogQHJlcy4gQHJlczo6c3RhcnQgc2hvdWxkIGJlIHNldCB0byBhIHZhbHVlIGlkZW50aWZ5
aW5nIHRoZSBiZWdpbm5pbmcKIAkgKiBvZiB0aGUgcmFuZ2UgYWxsb2NhdGVkLCBhbmQgdGhlIGZ1
bmN0aW9uIHNob3VsZCByZXR1cm4gemVyby4KLQkgKiBJZiB0aGUgbWVtb3J5IHJlZ2lvbiBhY2Nv
bW1vZGF0ZSB0aGUgYnVmZmVyIG9iamVjdCwgQG1lbTo6bW1fbm9kZQotCSAqIHNob3VsZCBiZSBz
ZXQgdG8gTlVMTCwgYW5kIHRoZSBmdW5jdGlvbiBzaG91bGQgcmV0dXJuIDAuCisJICogSWYgdGhl
IG1hbmFnZXIgY2FuJ3QgZnVsZmlsbCB0aGUgcmVxdWVzdCAtRU5PU1BDIHNob3VsZCBiZSByZXR1
cm5lZC4KIAkgKiBJZiBhIHN5c3RlbSBlcnJvciBvY2N1cnJlZCwgcHJldmVudGluZyB0aGUgcmVx
dWVzdCB0byBiZSBmdWxmaWxsZWQsCiAJICogdGhlIGZ1bmN0aW9uIHNob3VsZCByZXR1cm4gYSBu
ZWdhdGl2ZSBlcnJvciBjb2RlLgogCSAqCi0JICogTm90ZSB0aGF0IEBtZW06Om1tX25vZGUgd2ls
bCBvbmx5IGJlIGRlcmVmZXJlbmNlZCBieQotCSAqIHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdl
ciBmdW5jdGlvbnMgYW5kIG9wdGlvbmFsbHkgYnkgdGhlIGRyaXZlciwKLQkgKiB3aGljaCBoYXMg
a25vd2xlZGdlIG9mIHRoZSB1bmRlcmx5aW5nIHR5cGUuCi0JICoKLQkgKiBUaGlzIGZ1bmN0aW9u
IG1heSBub3QgYmUgY2FsbGVkIGZyb20gd2l0aGluIGF0b21pYyBjb250ZXh0LCBzbwotCSAqIGFu
IGltcGxlbWVudGF0aW9uIGNhbiBhbmQgbXVzdCB1c2UgZWl0aGVyIGEgbXV0ZXggb3IgYSBzcGlu
bG9jayB0bwotCSAqIHByb3RlY3QgYW55IGRhdGEgc3RydWN0dXJlcyBtYW5hZ2luZyB0aGUgc3Bh
Y2UuCisJICogVGhpcyBmdW5jdGlvbiBtYXkgbm90IGJlIGNhbGxlZCBmcm9tIHdpdGhpbiBhdG9t
aWMgY29udGV4dCBhbmQgbmVlZHMKKwkgKiB0byB0YWtlIGNhcmUgb2YgaXRzIG93biBsb2NraW5n
IHRvIHByb3RlY3QgYW55IGRhdGEgc3RydWN0dXJlcworCSAqIG1hbmFnaW5nIHRoZSBzcGFjZS4K
IAkgKi8KIAlpbnQgICgqYWxsb2MpKHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuLAog
CQkgICAgICBzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQkgICAgICBjb25zdCBzdHJ1
Y3QgdHRtX3BsYWNlICpwbGFjZSwKLQkJICAgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqbWVtKTsK
KwkJICAgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqKnJlcyk7CiAKIAkvKioKIAkgKiBzdHJ1Y3Qg
dHRtX3Jlc291cmNlX21hbmFnZXJfZnVuYyBtZW1iZXIgZnJlZQogCSAqCiAJICogQG1hbjogUG9p
bnRlciB0byBhIG1lbW9yeSB0eXBlIG1hbmFnZXIuCi0JICogQG1lbTogUG9pbnRlciB0byBhIHN0
cnVjdCB0dG1fcmVzb3VyY2UgdG8gYmUgZmlsbGVkIGluLgorCSAqIEByZXM6IFBvaW50ZXIgdG8g
YSBzdHJ1Y3QgdHRtX3Jlc291cmNlIHRvIGJlIGZyZWVkLgogCSAqCi0JICogVGhpcyBmdW5jdGlv
biBmcmVlcyBtZW1vcnkgdHlwZSByZXNvdXJjZXMgcHJldmlvdXNseSBhbGxvY2F0ZWQKLQkgKiBh
bmQgdGhhdCBhcmUgaWRlbnRpZmllZCBieSBAbWVtOjptbV9ub2RlIGFuZCBAbWVtOjpzdGFydC4g
TWF5IG5vdAotCSAqIGJlIGNhbGxlZCBmcm9tIHdpdGhpbiBhdG9taWMgY29udGV4dC4KKwkgKiBU
aGlzIGZ1bmN0aW9uIGZyZWVzIG1lbW9yeSB0eXBlIHJlc291cmNlcyBwcmV2aW91c2x5IGFsbG9j
YXRlZC4KKwkgKiBNYXkgbm90IGJlIGNhbGxlZCBmcm9tIHdpdGhpbiBhdG9taWMgY29udGV4dC4K
IAkgKi8KIAl2b2lkICgqZnJlZSkoc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYW4sCi0J
CSAgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqbWVtKTsKKwkJICAgICBzdHJ1Y3QgdHRtX3Jlc291
cmNlICpyZXMpOwogCiAJLyoqCiAJICogc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyX2Z1bmMg
bWVtYmVyIGRlYnVnCkBAIC0xNTgsOSArMTUwLDkgQEAgc3RydWN0IHR0bV9idXNfcGxhY2VtZW50
IHsKIC8qKgogICogc3RydWN0IHR0bV9yZXNvdXJjZQogICoKLSAqIEBtbV9ub2RlOiBNZW1vcnkg
bWFuYWdlciBub2RlLgotICogQHNpemU6IFJlcXVlc3RlZCBzaXplIG9mIG1lbW9yeSByZWdpb24u
Ci0gKiBAbnVtX3BhZ2VzOiBBY3R1YWwgc2l6ZSBvZiBtZW1vcnkgcmVnaW9uIGluIHBhZ2VzLgor
ICogQHN0YXJ0OiBTdGFydCBvZiB0aGUgYWxsb2NhdGlvbi4KKyAqIEBudW1fcGFnZXM6IEFjdHVh
bCBzaXplIG9mIHJlc291cmNlIGluIHBhZ2VzLgorICogQG1lbV90eXBlOiBSZXNvdXJjZSB0eXBl
IG9mIHRoZSBhbGxvY2F0aW9uLgogICogQHBsYWNlbWVudDogUGxhY2VtZW50IGZsYWdzLgogICog
QGJ1czogUGxhY2VtZW50IG9uIGlvIGJ1cyBhY2Nlc3NpYmxlIHRvIHRoZSBDUFUKICAqCkBAIC0x
NjgsNyArMTYwLDYgQEAgc3RydWN0IHR0bV9idXNfcGxhY2VtZW50IHsKICAqIGJ1ZmZlciBvYmpl
Y3QuCiAgKi8KIHN0cnVjdCB0dG1fcmVzb3VyY2UgewotCXZvaWQgKm1tX25vZGU7CiAJdW5zaWdu
ZWQgbG9uZyBzdGFydDsKIAl1bnNpZ25lZCBsb25nIG51bV9wYWdlczsKIAl1aW50MzJfdCBtZW1f
dHlwZTsKLS0gCjIuMjUuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0
b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJp
LWRldmVsCg==
