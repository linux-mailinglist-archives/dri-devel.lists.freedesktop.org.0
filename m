Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id A7AF2113C84
	for <lists+dri-devel@lfdr.de>; Thu,  5 Dec 2019 08:44:58 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2A6796F592;
	Thu,  5 Dec 2019 07:44:41 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-io1-xd43.google.com (mail-io1-xd43.google.com
 [IPv6:2607:f8b0:4864:20::d43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 538526F57B
 for <dri-devel@lists.freedesktop.org>; Thu,  5 Dec 2019 06:16:24 +0000 (UTC)
Received: by mail-io1-xd43.google.com with SMTP id c16so2384751ioh.6
 for <dri-devel@lists.freedesktop.org>; Wed, 04 Dec 2019 22:16:24 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=sagxzG2UOJgqtCWMTEvuG8BujWW/Ac96ALrG1/iNc1g=;
 b=qPrrwqM3aFdQaJmGxjJnQun7KtIn/x+X6N3ocShPi+t1ITg73Kj6LgkrioUiH8xUTX
 MoSmDD7GZAmpSjD6pl6hCxaS2TcJgCxQVHTKxOGvDzh4q3Gu9pUW6c7PcMSNMATHHG9M
 PRlilvB8VY2ZELWZgsE7lLaAe3Lp49IacN1jfjXP1Qnmcz9PkWR2ph7NxeKNBZg0x+m5
 pDXvXzSBYkBBuxgT3ecIeKcYfns+8jLAgc5gZjvq2NJOm8g+LQTTy3HTsz2lg/XzOEu6
 pFJYTBS5YbVSEpkF9Wl2A2BmIvHN9AJBuUSXqJ0qseWbCh0XbCRweJFhha/YRKsnALB4
 KwQg==
X-Gm-Message-State: APjAAAWjh8cudeCk2U4nOUz8lQuO5SLs93EDgvo0Rc2/WH5/To4x4vQP
 PnsCaQkS+s7o4dBTpyFjJ36v6DA3ekBGqSoKJp32cQ==
X-Google-Smtp-Source: APXvYqwd0SY25U4cq3pwuC4ufVW/oZZK/mthsjkNg5Pt9lukryHB6LaDPd57XgXny29wudUpug6IojBLFRTn9swdYmo=
X-Received: by 2002:a02:b18d:: with SMTP id t13mr158882jah.4.1575526583427;
 Wed, 04 Dec 2019 22:16:23 -0800 (PST)
MIME-Version: 1.0
References: <1574817475-22378-2-git-send-email-yongqiang.niu@mediatek.com>
In-Reply-To: <1574817475-22378-2-git-send-email-yongqiang.niu@mediatek.com>
From: Hsin-Yi Wang <hsinyi@chromium.org>
Date: Thu, 5 Dec 2019 14:15:57 +0800
Message-ID: <CAJMQK-iDnOWCYmxcREGschD=sDfU6yKpUu+koP3YDeO3MPCdhQ@mail.gmail.com>
Subject: Re: [v1,1/2] drm/mediatek: Fixup external display black screen issue
To: Yongqiang Niu <yongqiang.niu@mediatek.com>
X-Mailman-Approved-At: Thu, 05 Dec 2019 07:44:39 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=chromium.org; s=google;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=sagxzG2UOJgqtCWMTEvuG8BujWW/Ac96ALrG1/iNc1g=;
 b=OpbZtYc602v9GzttMW4clzIL5MO4H74stJoLKvSgJ9YuuzxyAVwKg2x2E5bGNMS8Ix
 VDGM0ySfeLoY9+ChJHUdC74eBzZEuLW95Lorx6yqi4GfEEPEMk7F9nkm/1HdMBuXIe8W
 5dmUXfLm7RO8hDMjSRzUREtQ0GULXDZwxm5Vk=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Mark Rutland <mark.rutland@arm.com>,
 Devicetree List <devicetree@vger.kernel.org>, David Airlie <airlied@linux.ie>,
 lkml <linux-kernel@vger.kernel.org>, dri-devel@lists.freedesktop.org,
 Matthias Brugger <matthias.bgg@gmail.com>, Rob Herring <robh+dt@kernel.org>,
 linux-mediatek@lists.infradead.org,
 "moderated list:ARM/FREESCALE IMX / MXC ARM ARCHITECTURE"
 <linux-arm-kernel@lists.infradead.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gV2VkLCBOb3YgMjcsIDIwMTkgYXQgMToxNyBBTSA8eW9uZ3FpYW5nLm5pdUBtZWRpYXRlay5j
b20+IHdyb3RlOgo+Cj4gRnJvbTogWW9uZ3FpYW5nIE5pdSA8eW9uZ3FpYW5nLm5pdUBtZWRpYXRl
ay5jb20+Cj4KPiBQcm9ibGVtOgo+IG92ZXJsYXkgaGFuZ3VwIHdoZW4gZXh0ZXJuYWwgZGlzcGxh
eSBob3RwbHV0IHRlc3QKPgo+IEZpeDoKPiBkaXNhYmxlIG92ZXJsYXkgd2hlbiBjcnRjIGRpc2Fi
bGUKPgo+IFNpZ25lZC1vZmYtYnk6IFlvbmdxaWFuZyBOaXUgPHlvbmdxaWFuZy5uaXVAbWVkaWF0
ZWsuY29tPgo+IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9jcnRjLmMg
fCAzOSArKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0tLS0KPiAgMSBmaWxlIGNoYW5nZWQs
IDI1IGluc2VydGlvbnMoKyksIDE0IGRlbGV0aW9ucygtKQo+Cj4gLS0KPiAxLjguMS4xLmRpcnR5
Cj4KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fY3J0Yy5j
IGIvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fY3J0Yy5jCj4gaW5kZXggNGZiMzQ2
Yy4uN2VjYTAyZiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2Ry
bV9jcnRjLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9jcnRjLmMK
PiBAQCAtMzY5LDYgKzM2OSwyMCBAQCBzdGF0aWMgaW50IG10a19jcnRjX2RkcF9od19pbml0KHN0
cnVjdCBtdGtfZHJtX2NydGMgKm10a19jcnRjKQo+ICAgICAgICAgbXRrX2Rpc3BfbXV0ZXhfYWRk
X2NvbXAobXRrX2NydGMtPm11dGV4LCBtdGtfY3J0Yy0+ZGRwX2NvbXBbaV0tPmlkKTsKPiAgICAg
ICAgIG10a19kaXNwX211dGV4X2VuYWJsZShtdGtfY3J0Yy0+bXV0ZXgpOwo+Cj4gKyAgICAgICAv
KiBJbml0aWFsbHkgY29uZmlndXJlIGFsbCBwbGFuZXMgKi8KPiArICAgICAgIGZvciAoaSA9IDA7
IGkgPCBtdGtfY3J0Yy0+bGF5ZXJfbnI7IGkrKykgewo+ICsgICAgICAgICAgICAgICBzdHJ1Y3Qg
ZHJtX3BsYW5lICpwbGFuZSA9ICZtdGtfY3J0Yy0+cGxhbmVzW2ldOwo+ICsgICAgICAgICAgICAg
ICBzdHJ1Y3QgbXRrX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZTsKPiArICAgICAgICAgICAgICAg
c3RydWN0IG10a19kZHBfY29tcCAqY29tcDsKPiArICAgICAgICAgICAgICAgdW5zaWduZWQgaW50
IGxvY2FsX2xheWVyOwo+ICsKPiArICAgICAgICAgICAgICAgcGxhbmVfc3RhdGUgPSB0b19tdGtf
cGxhbmVfc3RhdGUocGxhbmUtPnN0YXRlKTsKPiArICAgICAgICAgICAgICAgY29tcCA9IG10a19k
cm1fZGRwX2NvbXBfZm9yX3BsYW5lKGNydGMsIHBsYW5lLCAmbG9jYWxfbGF5ZXIpOwo+ICsgICAg
ICAgICAgICAgICBpZiAoY29tcCkKPiArICAgICAgICAgICAgICAgICAgICAgICBtdGtfZGRwX2Nv
bXBfbGF5ZXJfY29uZmlnKGNvbXAsIGxvY2FsX2xheWVyLAo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhbmVfc3RhdGUsIE5VTEwpOwo+ICsgICAg
ICAgfQo+ICsKPiAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBtdGtfY3J0Yy0+ZGRwX2NvbXBfbnI7
IGkrKykgewo+ICAgICAgICAgICAgICAgICBzdHJ1Y3QgbXRrX2RkcF9jb21wICpjb21wID0gbXRr
X2NydGMtPmRkcF9jb21wW2ldOwo+ICAgICAgICAgICAgICAgICBlbnVtIG10a19kZHBfY29tcF9p
ZCBwcmV2Owo+IEBAIC0zODUsMjAgKzM5OSw2IEBAIHN0YXRpYyBpbnQgbXRrX2NydGNfZGRwX2h3
X2luaXQoc3RydWN0IG10a19kcm1fY3J0YyAqbXRrX2NydGMpCj4gICAgICAgICAgICAgICAgIG10
a19kZHBfY29tcF9zdGFydChjb21wKTsKPiAgICAgICAgIH0KPgo+IC0gICAgICAgLyogSW5pdGlh
bGx5IGNvbmZpZ3VyZSBhbGwgcGxhbmVzICovCj4gLSAgICAgICBmb3IgKGkgPSAwOyBpIDwgbXRr
X2NydGMtPmxheWVyX25yOyBpKyspIHsKPiAtICAgICAgICAgICAgICAgc3RydWN0IGRybV9wbGFu
ZSAqcGxhbmUgPSAmbXRrX2NydGMtPnBsYW5lc1tpXTsKPiAtICAgICAgICAgICAgICAgc3RydWN0
IG10a19wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGU7Cj4gLSAgICAgICAgICAgICAgIHN0cnVjdCBt
dGtfZGRwX2NvbXAgKmNvbXA7Cj4gLSAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBsb2NhbF9s
YXllcjsKPiAtCj4gLSAgICAgICAgICAgICAgIHBsYW5lX3N0YXRlID0gdG9fbXRrX3BsYW5lX3N0
YXRlKHBsYW5lLT5zdGF0ZSk7Cj4gLSAgICAgICAgICAgICAgIGNvbXAgPSBtdGtfZHJtX2RkcF9j
b21wX2Zvcl9wbGFuZShjcnRjLCBwbGFuZSwgJmxvY2FsX2xheWVyKTsKPiAtICAgICAgICAgICAg
ICAgaWYgKGNvbXApCj4gLSAgICAgICAgICAgICAgICAgICAgICAgbXRrX2RkcF9jb21wX2xheWVy
X2NvbmZpZyhjb21wLCBsb2NhbF9sYXllciwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHBsYW5lX3N0YXRlLCBOVUxMKTsKPiAtICAgICAgIH0KPiAt
Cj4gICAgICAgICByZXR1cm4gMDsKPgo+ICBlcnJfbXV0ZXhfdW5wcmVwYXJlOgo+IEBAIC02MDcs
MTAgKzYwNywyMSBAQCBzdGF0aWMgdm9pZCBtdGtfZHJtX2NydGNfYXRvbWljX2Rpc2FibGUoc3Ry
dWN0IGRybV9jcnRjICpjcnRjLAo+ICAgICAgICAgZm9yIChpID0gMDsgaSA8IG10a19jcnRjLT5s
YXllcl9ucjsgaSsrKSB7Cj4gICAgICAgICAgICAgICAgIHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5l
ID0gJm10a19jcnRjLT5wbGFuZXNbaV07Cj4gICAgICAgICAgICAgICAgIHN0cnVjdCBtdGtfcGxh
bmVfc3RhdGUgKnBsYW5lX3N0YXRlOwo+ICsgICAgICAgICAgICAgICBzdHJ1Y3QgbXRrX2RkcF9j
b21wICpjb21wID0gbXRrX2NydGMtPmRkcF9jb21wWzBdOwo+ICsgICAgICAgICAgICAgICB1bnNp
Z25lZCBpbnQgY29tcF9sYXllcl9uciA9IG10a19kZHBfY29tcF9sYXllcl9ucihjb21wKTsKPiAr
ICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGxvY2FsX2xheWVyOwo+Cj4gICAgICAgICAgICAg
ICAgIHBsYW5lX3N0YXRlID0gdG9fbXRrX3BsYW5lX3N0YXRlKHBsYW5lLT5zdGF0ZSk7Cj4gICAg
ICAgICAgICAgICAgIHBsYW5lX3N0YXRlLT5wZW5kaW5nLmVuYWJsZSA9IGZhbHNlOwo+ICAgICAg
ICAgICAgICAgICBwbGFuZV9zdGF0ZS0+cGVuZGluZy5jb25maWcgPSB0cnVlOwo+ICsKPiArICAg
ICAgICAgICAgICAgaWYgKGkgPj0gY29tcF9sYXllcl9ucikgewo+ICsgICAgICAgICAgICAgICAg
ICAgICAgIGNvbXAgPSBtdGtfY3J0Yy0+ZGRwX2NvbXBbMV07Cj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgbG9jYWxfbGF5ZXIgPSBpIC0gY29tcF9sYXllcl9ucjsKPiArICAgICAgICAgICAgICAg
fSBlbHNlCj4gKyAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxfbGF5ZXIgPSBpOwo+ICsgICAg
ICAgICAgICAgICBtdGtfZGRwX2NvbXBfbGF5ZXJfY29uZmlnKGNvbXAsIGxvY2FsX2xheWVyLAo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYW5lX3N0YXRlLCBO
VUxMKTsKVGhpcyBwYXJ0IHNob3VsZCBiZSBtb3ZlZCB0byBtdGtfY3J0Y19kZHBfaHdfZmluaSgp
LCBvciBhdCBsZWFzdApjYWxsZWQgYWZ0ZXIgZHJtX2NydGNfdmJsYW5rX29mZigpLiBPdGhlcndp
c2Ugd2Ugd291bGQgc2VlCmRybV93YWl0X29uZV92Ymxhbmsgd2FybmluZ3Mgb24gODE3MyB3aGVu
IGRpc3BsYXkgdHVybnMgb2ZmLgoKWyAgIDI1LjY5NjE4Ml0gQ2FsbCB0cmFjZToKWyAgIDI1LjY5
ODYyNF0gIGRybV93YWl0X29uZV92YmxhbmsrMHgxZjAvMHgxZmMKWyAgIDI1LjcwMjg4Nl0gIGRy
bV9jcnRjX3dhaXRfb25lX3ZibGFuaysweDIwLzB4MmMKWyAgIDI1LjcwNzQxNV0gIG10a19kcm1f
Y3J0Y19hdG9taWNfZGlzYWJsZSsweGYwLzB4MzA4ClsgICAyNS43MTIyODddICBkcm1fYXRvbWlj
X2hlbHBlcl9jb21taXRfbW9kZXNldF9kaXNhYmxlcysweDFiOC8weDNjMApbICAgMjUuNzE4NDYx
XSAgbXRrX2F0b21pY19jb21wbGV0ZSsweDg4LzB4MTZjClsgICAyNS43MjI2MzhdICBtdGtfYXRv
bWljX2NvbW1pdCsweGE4LzB4YjAKWyAgIDI1LjcyNjU1M10gIGRybV9hdG9taWNfY29tbWl0KzB4
NTAvMHg1YwpbICAgMjUuNzMwNDY5XSAgZHJtX2F0b21pY19oZWxwZXJfc2V0X2NvbmZpZysweDk4
LzB4YTAKWyAgIDI1LjczNTM0MV0gIGRybV9tb2RlX3NldGNydGMrMHgyODAvMHg2MDgKWyAgIDI1
LjczOTM0NF0gIGRybV9pb2N0bF9rZXJuZWwrMHhjYy8weDEwYwpbICAgMjUuNzQzMjYxXSAgZHJt
X2lvY3RsKzB4MjQwLzB4M2MwClsgICAyNS43NDY2NThdICBkcm1fY29tcGF0X2lvY3RsKzB4ZDgv
MHhlOApbICAgMjUuNzUwNDg3XSAgX19zZV9jb21wYXRfc3lzX2lvY3RsKzB4MTAwLzB4MjZmYwpb
ICAgMjUuNzU1MDA5XSAgX19hcm02NF9jb21wYXRfc3lzX2lvY3RsKzB4MjAvMHgyYwpbICAgMjUu
NzU5NTM0XSAgZWwwX3N2Y19jb21tb24rMHhhNC8weDE1NApbICAgMjUuNzYzMjc3XSAgZWwwX3N2
Y19jb21wYXRfaGFuZGxlcisweDJjLzB4MzgKWyAgIDI1Ljc2NzYyOF0gIGVsMF9zdmNfY29tcGF0
KzB4OC8weDE4ClsgICAyNS43NzExOTVdIC0tLVsgZW5kIHRyYWNlIGY0NjE5ZmRhYzhmMWMwZmYg
XS0tLQoKPgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpk
cmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0
cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
