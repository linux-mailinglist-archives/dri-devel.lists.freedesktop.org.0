Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 57CC04B6BA
	for <lists+dri-devel@lfdr.de>; Wed, 19 Jun 2019 13:09:13 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id DD2526E36F;
	Wed, 19 Jun 2019 11:09:09 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x542.google.com (mail-ed1-x542.google.com
 [IPv6:2a00:1450:4864:20::542])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 537656E36F
 for <dri-devel@lists.freedesktop.org>; Wed, 19 Jun 2019 11:09:08 +0000 (UTC)
Received: by mail-ed1-x542.google.com with SMTP id k8so26580305eds.7
 for <dri-devel@lists.freedesktop.org>; Wed, 19 Jun 2019 04:09:08 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:sender:date:from:to:cc:subject:message-id
 :mail-followup-to:references:mime-version:content-disposition
 :in-reply-to:user-agent;
 bh=Y4GSKeCxJOgBNmn285dQtmwkYvSlROxIywFguE4X2O8=;
 b=KNJvzGJvpdAcag3afzdp4hdYy+Pkhx/MbkjBucLArvR3kYH0MwrxkZQcx9Ueh9NgCM
 E6ixHMAQKO+YoSXFDC4IpeJpjcM8skvCCvylLKVaekbTsHUiJAaT+JbcRO5rc7D2Lb+I
 Ay2K1fFg8covIH2UuDewqK9r5Gv1QFNsstF2UQXEx+z7QRfXLGKINcvfSFyqUx8iLeyM
 eaqdUG3XG3DduD8r9tAiOJWFtFcGzeceh9Kxrzx5dJKh38nIuKF9OkSlShZj7KHT4S0E
 DwchY52bsMf0QemlwCZOxnbFr01fRFX1fls+TaIUWvvc3BwUkbnCV0MXY7+uhjp3wdBI
 5tPg==
X-Gm-Message-State: APjAAAX6GNy2qxUdpG7h3CDbdicksoiCXkKA2hmvjs8icQnLop1QkcgD
 qlaZszHJr88HkpeOTlYPT07fUA==
X-Google-Smtp-Source: APXvYqxN7fRiV5hi8HTQ63ymgdaFtW6z8GpHO8Q8ACquWKrp1cDzhV6vjBBRbkYE36i801HPT+hUcA==
X-Received: by 2002:aa7:d30b:: with SMTP id p11mr92006989edq.23.1560942546910; 
 Wed, 19 Jun 2019 04:09:06 -0700 (PDT)
Received: from phenom.ffwll.local ([2a02:168:569e:0:3106:d637:d723:e855])
 by smtp.gmail.com with ESMTPSA id g18sm5421605edh.13.2019.06.19.04.09.05
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Wed, 19 Jun 2019 04:09:06 -0700 (PDT)
Date: Wed, 19 Jun 2019 13:09:02 +0200
From: Daniel Vetter <daniel@ffwll.ch>
To: Gerd Hoffmann <kraxel@redhat.com>
Subject: Re: [PATCH v3 08/12] drm/virtio: rework virtio_gpu_execbuffer_ioctl
 fencing
Message-ID: <20190619110902.GO12905@phenom.ffwll.local>
Mail-Followup-To: Gerd Hoffmann <kraxel@redhat.com>,
 dri-devel@lists.freedesktop.org,
 Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
 Maxime Ripard <maxime.ripard@bootlin.com>,
 Sean Paul <sean@poorly.run>, David Airlie <airlied@linux.ie>,
 open list <linux-kernel@vger.kernel.org>,
 "open list:VIRTIO GPU DRIVER" <virtualization@lists.linux-foundation.org>
References: <20190619090420.6667-1-kraxel@redhat.com>
 <20190619090420.6667-9-kraxel@redhat.com>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <20190619090420.6667-9-kraxel@redhat.com>
X-Operating-System: Linux phenom 4.19.0-5-amd64 
User-Agent: Mutt/1.10.1 (2018-07-13)
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ffwll.ch; s=google;
 h=sender:date:from:to:cc:subject:message-id:mail-followup-to
 :references:mime-version:content-disposition:in-reply-to:user-agent;
 bh=Y4GSKeCxJOgBNmn285dQtmwkYvSlROxIywFguE4X2O8=;
 b=fWazkw0TX0zMESV9BeuzYc7r57HbzPWhl2QefHRfXlkuYhZXTAMe3lHCoH4S4uHslg
 eUp+EKWZ9cM7q1bKimUB89IjflyIj1R0vMKgj7WiFygkrSyKa77wqIYaeaKchjlE+SVw
 VhMNlHvU2/iLMeCEH1kJaUcnov8MRHZq9sjGQ=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Maxime Ripard <maxime.ripard@bootlin.com>,
 open list <linux-kernel@vger.kernel.org>, dri-devel@lists.freedesktop.org,
 "open list:VIRTIO GPU DRIVER" <virtualization@lists.linux-foundation.org>,
 David Airlie <airlied@linux.ie>, Sean Paul <sean@poorly.run>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gV2VkLCBKdW4gMTksIDIwMTkgYXQgMTE6MDQ6MTZBTSArMDIwMCwgR2VyZCBIb2ZmbWFubiB3
cm90ZToKPiBVc2UgZ2VtIHJlc2VydmF0aW9uIGhlbHBlcnMgYW5kIGRpcmVjdCByZXNlcnZhdGlv
bl9vYmplY3RfKiBjYWxscwo+IGluc3RlYWQgb2YgdHRtLgo+IAo+IHYzOiBBbHNvIGF0dGFjaCB0
aGUgYXJyYXkgb2YgZ2VtIG9iamVjdHMgdG8gdGhlIHZpcnRpbyBjb21tYW5kIGJ1ZmZlciwKPiBz
byB3ZSBjYW4gZHJvcCB0aGUgb2JqZWN0IHJlZmVyZW5jZXMgaW4gdGhlIGNvbXBsZXRpb24gY2Fs
bGJhY2suICBOZWVkZWQKPiBiZWNhdXNlIHR0bSBmZW5jZSBoZWxwZXJzIGdyYWIgYSByZWZlcmVu
Y2UgZm9yIHVzLCBidXQgZ2VtIGhlbHBlcnMKPiBkb24ndC4KPiAKPiBTaWduZWQtb2ZmLWJ5OiBH
ZXJkIEhvZmZtYW5uIDxrcmF4ZWxAcmVkaGF0LmNvbT4KCkkgdGhpbmsgdGhpcyBsb29rcyByZWFz
b25hYmxlIG5vdywgYnV0IHNpbmNlIGl0IG5vdyB0b3VjaGVzIHZpcnRpbwpsaWZldGltZSBtYW5h
Z2VtZW50IEknbSBub3Qgc3VyZSBJIGNhbiBjb252aW5jZSBteXNlbGYgb2YgaXRzIGNvcnJlY3Ru
ZXNzLgpJIGRpZG4ndCBzcG90IGFueXRoaW5nIGZ1bmRhbWVudGFsbHkgd3Jvbmcgd2l0aCB0aGUg
cmVtYWluaW5nIHBhdGNoZXMsIHNvCm9uIDgtMTI6CgpBY2tlZC1ieTogRGFuaWVsIFZldHRlciA8
ZGFuaWVsLnZldHRlckBmZndsbC5jaD4KCkJ1dCBJIHRoaW5rIHlvdSB3YW50IHNvbWVvbmUgd2l0
aCBjbHVlIGFib3V0IHZpcnRpbyB0byBkb3VibGUtY2hlY2sgc3R1ZmYKZG9lc24ndCBnZXQgbGVh
a2VkIG9yIHRoZSBkcml2ZXIgb29wc2VzIHNvbWV3aGVyZS4gU3BlY2lmaWNhbGx5IEknbSBub3QK
c3VyZSB3aGV0aGVyIHlvdSBoYXZlIHNvbWUgbW9yZSB0cmFwcyBsdXJraW5nIGFyb3VuZCBidWZm
ZXIgZGVzdHJ1Y3Rpb24sCnNpbmNlIHR0bSBrZWVwcyBzdHVmZiBvbiB0aGUgbHJ1IGZvciBsb25n
ZXIgdGhhbiBqdXN0IHVudGlsIGFsbCB0aGUgZmVuY2VzCmFyZSBzaWduYWxsZWQuCgpBbHNvLCBJ
IHN0cm9uZ2x5IHJlY29tbWVuZCB5b3UgZG8gYSB2ZXJ5IGJhc2ljIGlndCB0byBleGVyY2lzZSB0
aGlzLCBpLmUuCmFsbG9jYXRlIHNvbWUgYnVmZmVycywgc3VibWl0IHRoZW0gaW4gYSBkdW1tYnkg
b3AsIHRoZW4gY2xvc2UgdGhlIGVudGlyZQpkcm1mZC4gVGhlIG9sZCB2ZXJzaW9uIHNob3VsZCBh
dCBsZWFzdCBoYXZlIHRyaXBwZWQgb3ZlciBrYXNhbiwgbWF5YmUgZXZlbgpvb3BzZXMgc29tZXdo
ZXJlLgotRGFuaWVsCgo+IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfZHJ2
LmggICB8ICA2ICsrLQo+ICBkcml2ZXJzL2dwdS9kcm0vZHJtX2dlbV9hcnJheV9oZWxwZXIuYyB8
ICAyICsKPiAgZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X2lvY3RsLmMgfCA2MiArKysr
KysrKysrKy0tLS0tLS0tLS0tLS0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVf
dnEuYyAgICB8IDE2ICsrKystLS0KPiAgNCBmaWxlcyBjaGFuZ2VkLCA0MyBpbnNlcnRpb25zKCsp
LCA0MyBkZWxldGlvbnMoLSkKPiAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZpcnRp
by92aXJ0Z3B1X2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X2Rydi5oCj4g
aW5kZXggNzdhYzY5YThlNmNjLi41NzMxNzNjMzVjNDggMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL3ZpcnRpby92aXJ0Z3B1X2Rydi5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3ZpcnRp
by92aXJ0Z3B1X2Rydi5oCj4gQEAgLTMzLDYgKzMzLDcgQEAKPiAgCj4gICNpbmNsdWRlIDxkcm0v
ZHJtUC5oPgo+ICAjaW5jbHVkZSA8ZHJtL2RybV9nZW0uaD4KPiArI2luY2x1ZGUgPGRybS9kcm1f
Z2VtX2FycmF5X2hlbHBlci5oPgo+ICAjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWMuaD4KPiAgI2lu
Y2x1ZGUgPGRybS9kcm1fZW5jb2Rlci5oPgo+ICAjaW5jbHVkZSA8ZHJtL2RybV9mYl9oZWxwZXIu
aD4KPiBAQCAtMTE1LDkgKzExNiw5IEBAIHN0cnVjdCB2aXJ0aW9fZ3B1X3ZidWZmZXIgewo+ICAK
PiAgCWNoYXIgKnJlc3BfYnVmOwo+ICAJaW50IHJlc3Bfc2l6ZTsKPiAtCj4gIAl2aXJ0aW9fZ3B1
X3Jlc3BfY2IgcmVzcF9jYjsKPiAgCj4gKwlzdHJ1Y3QgZHJtX2dlbV9vYmplY3RfYXJyYXkgKm9i
anM7Cj4gIAlzdHJ1Y3QgbGlzdF9oZWFkIGxpc3Q7Cj4gIH07Cj4gIAo+IEBAIC0zMDEsNyArMzAy
LDggQEAgdm9pZCB2aXJ0aW9fZ3B1X2NtZF9jb250ZXh0X2RldGFjaF9yZXNvdXJjZShzdHJ1Y3Qg
dmlydGlvX2dwdV9kZXZpY2UgKnZnZGV2LAo+ICAJCQkJCSAgICB1aW50MzJfdCByZXNvdXJjZV9p
ZCk7Cj4gIHZvaWQgdmlydGlvX2dwdV9jbWRfc3VibWl0KHN0cnVjdCB2aXJ0aW9fZ3B1X2Rldmlj
ZSAqdmdkZXYsCj4gIAkJCSAgIHZvaWQgKmRhdGEsIHVpbnQzMl90IGRhdGFfc2l6ZSwKPiAtCQkJ
ICAgdWludDMyX3QgY3R4X2lkLCBzdHJ1Y3QgdmlydGlvX2dwdV9mZW5jZSAqZmVuY2UpOwo+ICsJ
CQkgICB1aW50MzJfdCBjdHhfaWQsIHN0cnVjdCB2aXJ0aW9fZ3B1X2ZlbmNlICpmZW5jZSwKPiAr
CQkJICAgc3RydWN0IGRybV9nZW1fb2JqZWN0X2FycmF5ICpvYmpzKTsKPiAgdm9pZCB2aXJ0aW9f
Z3B1X2NtZF90cmFuc2Zlcl9mcm9tX2hvc3RfM2Qoc3RydWN0IHZpcnRpb19ncHVfZGV2aWNlICp2
Z2RldiwKPiAgCQkJCQkgIHVpbnQzMl90IHJlc291cmNlX2lkLCB1aW50MzJfdCBjdHhfaWQsCj4g
IAkJCQkJICB1aW50NjRfdCBvZmZzZXQsIHVpbnQzMl90IGxldmVsLAo+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vZHJtX2dlbV9hcnJheV9oZWxwZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9k
cm1fZ2VtX2FycmF5X2hlbHBlci5jCj4gaW5kZXggZDM1Yzc3YzRhMDJkLi5mZGU2YzJlNjMyNTMg
MTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2RybV9nZW1fYXJyYXlfaGVscGVyLmMKPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX2dlbV9hcnJheV9oZWxwZXIuYwo+IEBAIC01Nyw2ICs1
Nyw3IEBAIGRybV9nZW1fYXJyYXlfZnJvbV9oYW5kbGVzKHN0cnVjdCBkcm1fZmlsZSAqZHJtX2Zp
bGUsIHUzMiAqaGFuZGxlcywgdTMyIG5lbnRzKQo+ICAJfQo+ICAJcmV0dXJuIG9ianM7Cj4gIH0K
PiArRVhQT1JUX1NZTUJPTChkcm1fZ2VtX2FycmF5X2Zyb21faGFuZGxlcyk7Cj4gIAo+ICAvKioK
PiAgICogZHJtX2dlbV9hcnJheV9wdXRfZnJlZSAtLSBwdXQgZ2VtIG9iamVjdHMgYW5kIGZyZWUg
YXJyYXkuCj4gQEAgLTc0LDMgKzc1LDQgQEAgdm9pZCBkcm1fZ2VtX2FycmF5X3B1dF9mcmVlKHN0
cnVjdCBkcm1fZ2VtX29iamVjdF9hcnJheSAqb2JqcykKPiAgCX0KPiAgCWRybV9nZW1fYXJyYXlf
ZnJlZShvYmpzKTsKPiAgfQo+ICtFWFBPUlRfU1lNQk9MKGRybV9nZW1fYXJyYXlfcHV0X2ZyZWUp
Owo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfaW9jdGwuYyBi
L2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8vdmlydGdwdV9pb2N0bC5jCj4gaW5kZXggNWNmZmQyZTU0
YzA0Li4yMWViZjVjZGI4YmMgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92
aXJ0Z3B1X2lvY3RsLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfaW9j
dGwuYwo+IEBAIC0xMDUsMTQgKzEwNSwxMSBAQCBzdGF0aWMgaW50IHZpcnRpb19ncHVfZXhlY2J1
ZmZlcl9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ICAJc3RydWN0
IGRybV92aXJ0Z3B1X2V4ZWNidWZmZXIgKmV4YnVmID0gZGF0YTsKPiAgCXN0cnVjdCB2aXJ0aW9f
Z3B1X2RldmljZSAqdmdkZXYgPSBkZXYtPmRldl9wcml2YXRlOwo+ICAJc3RydWN0IHZpcnRpb19n
cHVfZnByaXYgKnZmcHJpdiA9IGRybV9maWxlLT5kcml2ZXJfcHJpdjsKPiAtCXN0cnVjdCBkcm1f
Z2VtX29iamVjdCAqZ29iajsKPiAgCXN0cnVjdCB2aXJ0aW9fZ3B1X2ZlbmNlICpvdXRfZmVuY2U7
Cj4gLQlzdHJ1Y3QgdmlydGlvX2dwdV9vYmplY3QgKnFvYmo7Cj4gIAlpbnQgcmV0Owo+ICAJdWlu
dDMyX3QgKmJvX2hhbmRsZXMgPSBOVUxMOwo+ICAJdm9pZCBfX3VzZXIgKnVzZXJfYm9faGFuZGxl
cyA9IE5VTEw7Cj4gLQlzdHJ1Y3QgbGlzdF9oZWFkIHZhbGlkYXRlX2xpc3Q7Cj4gLQlzdHJ1Y3Qg
dHRtX3ZhbGlkYXRlX2J1ZmZlciAqYnVmbGlzdCA9IE5VTEw7Cj4gKwlzdHJ1Y3QgZHJtX2dlbV9v
YmplY3RfYXJyYXkgKmJ1Zmxpc3QgPSBOVUxMOwo+ICAJaW50IGk7Cj4gIAlzdHJ1Y3Qgd3dfYWNx
dWlyZV9jdHggdGlja2V0Owo+ICAJc3RydWN0IHN5bmNfZmlsZSAqc3luY19maWxlOwo+IEBAIC0x
NTUsMTUgKzE1MiwxMCBAQCBzdGF0aWMgaW50IHZpcnRpb19ncHVfZXhlY2J1ZmZlcl9pb2N0bChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ICAJCQlyZXR1cm4gb3V0X2ZlbmNl
X2ZkOwo+ICAJfQo+ICAKPiAtCUlOSVRfTElTVF9IRUFEKCZ2YWxpZGF0ZV9saXN0KTsKPiAgCWlm
IChleGJ1Zi0+bnVtX2JvX2hhbmRsZXMpIHsKPiAtCj4gIAkJYm9faGFuZGxlcyA9IGt2bWFsbG9j
X2FycmF5KGV4YnVmLT5udW1fYm9faGFuZGxlcywKPiAtCQkJCQkgICBzaXplb2YodWludDMyX3Qp
LCBHRlBfS0VSTkVMKTsKPiAtCQlidWZsaXN0ID0ga3ZtYWxsb2NfYXJyYXkoZXhidWYtPm51bV9i
b19oYW5kbGVzLAo+IC0JCQkJCSAgIHNpemVvZihzdHJ1Y3QgdHRtX3ZhbGlkYXRlX2J1ZmZlciks
Cj4gLQkJCQkJICAgR0ZQX0tFUk5FTCB8IF9fR0ZQX1pFUk8pOwo+IC0JCWlmICghYm9faGFuZGxl
cyB8fCAhYnVmbGlzdCkgewo+ICsJCQkJCSAgICBzaXplb2YodWludDMyX3QpLCBHRlBfS0VSTkVM
KTsKPiArCQlpZiAoIWJvX2hhbmRsZXMpIHsKPiAgCQkJcmV0ID0gLUVOT01FTTsKPiAgCQkJZ290
byBvdXRfdW51c2VkX2ZkOwo+ICAJCX0KPiBAQCAtMTc1LDI1ICsxNjcsMjIgQEAgc3RhdGljIGlu
dCB2aXJ0aW9fZ3B1X2V4ZWNidWZmZXJfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9p
ZCAqZGF0YSwKPiAgCQkJZ290byBvdXRfdW51c2VkX2ZkOwo+ICAJCX0KPiAgCj4gLQkJZm9yIChp
ID0gMDsgaSA8IGV4YnVmLT5udW1fYm9faGFuZGxlczsgaSsrKSB7Cj4gLQkJCWdvYmogPSBkcm1f
Z2VtX29iamVjdF9sb29rdXAoZHJtX2ZpbGUsIGJvX2hhbmRsZXNbaV0pOwo+IC0JCQlpZiAoIWdv
YmopIHsKPiAtCQkJCXJldCA9IC1FTk9FTlQ7Cj4gLQkJCQlnb3RvIG91dF91bnVzZWRfZmQ7Cj4g
LQkJCX0KPiAtCj4gLQkJCXFvYmogPSBnZW1fdG9fdmlydGlvX2dwdV9vYmooZ29iaik7Cj4gLQkJ
CWJ1Zmxpc3RbaV0uYm8gPSAmcW9iai0+dGJvOwo+IC0KPiAtCQkJbGlzdF9hZGQoJmJ1Zmxpc3Rb
aV0uaGVhZCwgJnZhbGlkYXRlX2xpc3QpOwo+ICsJCWJ1Zmxpc3QgPSBkcm1fZ2VtX2FycmF5X2Zy
b21faGFuZGxlcyhkcm1fZmlsZSwgYm9faGFuZGxlcywKPiArCQkJCQkJICAgICBleGJ1Zi0+bnVt
X2JvX2hhbmRsZXMpOwo+ICsJCWlmICghYnVmbGlzdCkgewo+ICsJCQlyZXQgPSAtRU5PRU5UOwo+
ICsJCQlnb3RvIG91dF91bnVzZWRfZmQ7Cj4gIAkJfQo+ICAJCWt2ZnJlZShib19oYW5kbGVzKTsK
PiAgCQlib19oYW5kbGVzID0gTlVMTDsKPiAgCX0KPiAgCj4gLQlyZXQgPSB2aXJ0aW9fZ3B1X29i
amVjdF9saXN0X3ZhbGlkYXRlKCZ0aWNrZXQsICZ2YWxpZGF0ZV9saXN0KTsKPiAtCWlmIChyZXQp
Cj4gLQkJZ290byBvdXRfZnJlZTsKPiArCWlmIChidWZsaXN0KSB7Cj4gKwkJcmV0ID0gZHJtX2dl
bV9sb2NrX3Jlc2VydmF0aW9ucyhidWZsaXN0LT5vYmpzLCBidWZsaXN0LT5uZW50cywKPiArCQkJ
CQkJJnRpY2tldCk7Cj4gKwkJaWYgKHJldCkKPiArCQkJZ290byBvdXRfdW51c2VkX2ZkOwo+ICsJ
fQo+ICAKPiAgCWJ1ZiA9IG1lbWR1cF91c2VyKHU2NF90b191c2VyX3B0cihleGJ1Zi0+Y29tbWFu
ZCksIGV4YnVmLT5zaXplKTsKPiAgCWlmIChJU19FUlIoYnVmKSkgewo+IEBAIC0yMTksMjUgKzIw
OCwyNiBAQCBzdGF0aWMgaW50IHZpcnRpb19ncHVfZXhlY2J1ZmZlcl9pb2N0bChzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ICAJCWZkX2luc3RhbGwob3V0X2ZlbmNlX2ZkLCBz
eW5jX2ZpbGUtPmZpbGUpOwo+ICAJfQo+ICAKPiArCWlmIChidWZsaXN0KSB7Cj4gKwkJZm9yIChp
ID0gMDsgaSA8IGV4YnVmLT5udW1fYm9faGFuZGxlczsgaSsrKQo+ICsJCQlyZXNlcnZhdGlvbl9v
YmplY3RfYWRkX2V4Y2xfZmVuY2UoYnVmbGlzdC0+b2Jqc1tpXS0+cmVzdiwKPiArCQkJCQkJCSAg
Jm91dF9mZW5jZS0+Zik7Cj4gKwkJZHJtX2dlbV91bmxvY2tfcmVzZXJ2YXRpb25zKGJ1Zmxpc3Qt
Pm9ianMsIGJ1Zmxpc3QtPm5lbnRzLAo+ICsJCQkJCSAgICAmdGlja2V0KTsKPiArCX0KPiArCj4g
IAl2aXJ0aW9fZ3B1X2NtZF9zdWJtaXQodmdkZXYsIGJ1ZiwgZXhidWYtPnNpemUsCj4gLQkJCSAg
ICAgIHZmcHJpdi0+Y3R4X2lkLCBvdXRfZmVuY2UpOwo+IC0KPiAtCXR0bV9ldV9mZW5jZV9idWZm
ZXJfb2JqZWN0cygmdGlja2V0LCAmdmFsaWRhdGVfbGlzdCwgJm91dF9mZW5jZS0+Zik7Cj4gLQo+
IC0JLyogZmVuY2UgdGhlIGNvbW1hbmQgYm8gKi8KPiAtCXZpcnRpb19ncHVfdW5yZWZfbGlzdCgm
dmFsaWRhdGVfbGlzdCk7Cj4gLQlrdmZyZWUoYnVmbGlzdCk7Cj4gKwkJCSAgICAgIHZmcHJpdi0+
Y3R4X2lkLCBvdXRfZmVuY2UsIGJ1Zmxpc3QpOwo+ICAJcmV0dXJuIDA7Cj4gIAo+ICBvdXRfbWVt
ZHVwOgo+ICAJa2ZyZWUoYnVmKTsKPiAgb3V0X3VucmVzdjoKPiAtCXR0bV9ldV9iYWNrb2ZmX3Jl
c2VydmF0aW9uKCZ0aWNrZXQsICZ2YWxpZGF0ZV9saXN0KTsKPiAtb3V0X2ZyZWU6Cj4gLQl2aXJ0
aW9fZ3B1X3VucmVmX2xpc3QoJnZhbGlkYXRlX2xpc3QpOwo+ICsJZHJtX2dlbV91bmxvY2tfcmVz
ZXJ2YXRpb25zKGJ1Zmxpc3QtPm9ianMsIGJ1Zmxpc3QtPm5lbnRzLCAmdGlja2V0KTsKPiAgb3V0
X3VudXNlZF9mZDoKPiAgCWt2ZnJlZShib19oYW5kbGVzKTsKPiAtCWt2ZnJlZShidWZsaXN0KTsK
PiArCWlmIChidWZsaXN0KQo+ICsJCWRybV9nZW1fYXJyYXlfcHV0X2ZyZWUoYnVmbGlzdCk7Cj4g
IAo+ICAJaWYgKG91dF9mZW5jZV9mZCA+PSAwKQo+ICAJCXB1dF91bnVzZWRfZmQob3V0X2ZlbmNl
X2ZkKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X3ZxLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfdnEuYwo+IGluZGV4IDZjMWE5MDcxNzUz
NS4uNmVmZWE0ZmNhMDEyIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8vdmly
dGdwdV92cS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X3ZxLmMKPiBA
QCAtMTkxLDcgKzE5MSw3IEBAIHZvaWQgdmlydGlvX2dwdV9kZXF1ZXVlX2N0cmxfZnVuYyhzdHJ1
Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gIAl9IHdoaWxlICghdmlydHF1ZXVlX2VuYWJsZV9jYih2
Z2Rldi0+Y3RybHEudnEpKTsKPiAgCXNwaW5fdW5sb2NrKCZ2Z2Rldi0+Y3RybHEucWxvY2spOwo+
ICAKPiAtCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShlbnRyeSwgdG1wLCAmcmVjbGFpbV9saXN0
LCBsaXN0KSB7Cj4gKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KGVudHJ5LCAmcmVjbGFpbV9saXN0LCBs
aXN0KSB7Cj4gIAkJcmVzcCA9IChzdHJ1Y3QgdmlydGlvX2dwdV9jdHJsX2hkciAqKWVudHJ5LT5y
ZXNwX2J1ZjsKPiAgCj4gIAkJdHJhY2VfdmlydGlvX2dwdV9jbWRfcmVzcG9uc2UodmdkZXYtPmN0
cmxxLnZxLCByZXNwKTsKPiBAQCAtMjE4LDE0ICsyMTgsMTggQEAgdm9pZCB2aXJ0aW9fZ3B1X2Rl
cXVldWVfY3RybF9mdW5jKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiAgCQl9Cj4gIAkJaWYg
KGVudHJ5LT5yZXNwX2NiKQo+ICAJCQllbnRyeS0+cmVzcF9jYih2Z2RldiwgZW50cnkpOwo+IC0K
PiAtCQlsaXN0X2RlbCgmZW50cnktPmxpc3QpOwo+IC0JCWZyZWVfdmJ1Zih2Z2RldiwgZW50cnkp
Owo+ICAJfQo+ICAJd2FrZV91cCgmdmdkZXYtPmN0cmxxLmFja19xdWV1ZSk7Cj4gIAo+ICAJaWYg
KGZlbmNlX2lkKQo+ICAJCXZpcnRpb19ncHVfZmVuY2VfZXZlbnRfcHJvY2Vzcyh2Z2RldiwgZmVu
Y2VfaWQpOwo+ICsKPiArCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShlbnRyeSwgdG1wLCAmcmVj
bGFpbV9saXN0LCBsaXN0KSB7Cj4gKwkJaWYgKGVudHJ5LT5vYmpzKQo+ICsJCQlkcm1fZ2VtX2Fy
cmF5X3B1dF9mcmVlKGVudHJ5LT5vYmpzKTsKPiArCQlsaXN0X2RlbCgmZW50cnktPmxpc3QpOwo+
ICsJCWZyZWVfdmJ1Zih2Z2RldiwgZW50cnkpOwo+ICsJfQo+ICB9Cj4gIAo+ICB2b2lkIHZpcnRp
b19ncHVfZGVxdWV1ZV9jdXJzb3JfZnVuYyhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gQEAg
LTkzOSw3ICs5NDMsOCBAQCB2b2lkIHZpcnRpb19ncHVfY21kX3RyYW5zZmVyX2Zyb21faG9zdF8z
ZChzdHJ1Y3QgdmlydGlvX2dwdV9kZXZpY2UgKnZnZGV2LAo+ICAKPiAgdm9pZCB2aXJ0aW9fZ3B1
X2NtZF9zdWJtaXQoc3RydWN0IHZpcnRpb19ncHVfZGV2aWNlICp2Z2RldiwKPiAgCQkJICAgdm9p
ZCAqZGF0YSwgdWludDMyX3QgZGF0YV9zaXplLAo+IC0JCQkgICB1aW50MzJfdCBjdHhfaWQsIHN0
cnVjdCB2aXJ0aW9fZ3B1X2ZlbmNlICpmZW5jZSkKPiArCQkJICAgdWludDMyX3QgY3R4X2lkLCBz
dHJ1Y3QgdmlydGlvX2dwdV9mZW5jZSAqZmVuY2UsCj4gKwkJCSAgIHN0cnVjdCBkcm1fZ2VtX29i
amVjdF9hcnJheSAqb2JqcykKPiAgewo+ICAJc3RydWN0IHZpcnRpb19ncHVfY21kX3N1Ym1pdCAq
Y21kX3A7Cj4gIAlzdHJ1Y3QgdmlydGlvX2dwdV92YnVmZmVyICp2YnVmOwo+IEBAIC05NDksNiAr
OTU0LDcgQEAgdm9pZCB2aXJ0aW9fZ3B1X2NtZF9zdWJtaXQoc3RydWN0IHZpcnRpb19ncHVfZGV2
aWNlICp2Z2RldiwKPiAgCj4gIAl2YnVmLT5kYXRhX2J1ZiA9IGRhdGE7Cj4gIAl2YnVmLT5kYXRh
X3NpemUgPSBkYXRhX3NpemU7Cj4gKwl2YnVmLT5vYmpzID0gb2JqczsKPiAgCj4gIAljbWRfcC0+
aGRyLnR5cGUgPSBjcHVfdG9fbGUzMihWSVJUSU9fR1BVX0NNRF9TVUJNSVRfM0QpOwo+ICAJY21k
X3AtPmhkci5jdHhfaWQgPSBjcHVfdG9fbGUzMihjdHhfaWQpOwo+IC0tIAo+IDIuMTguMQo+IAoK
LS0gCkRhbmllbCBWZXR0ZXIKU29mdHdhcmUgRW5naW5lZXIsIEludGVsIENvcnBvcmF0aW9uCmh0
dHA6Ly9ibG9nLmZmd2xsLmNoCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNr
dG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2Ry
aS1kZXZlbA==
