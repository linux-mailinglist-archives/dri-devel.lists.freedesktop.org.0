Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id C588B10ACF7
	for <lists+dri-devel@lfdr.de>; Wed, 27 Nov 2019 10:57:02 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1CFA26E25F;
	Wed, 27 Nov 2019 09:57:00 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-wm1-x344.google.com (mail-wm1-x344.google.com
 [IPv6:2a00:1450:4864:20::344])
 by gabe.freedesktop.org (Postfix) with ESMTPS id D3C5E6E25F
 for <dri-devel@lists.freedesktop.org>; Wed, 27 Nov 2019 09:56:58 +0000 (UTC)
Received: by mail-wm1-x344.google.com with SMTP id n5so6702084wmc.0
 for <dri-devel@lists.freedesktop.org>; Wed, 27 Nov 2019 01:56:58 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:date:from:to:cc:subject:message-id
 :mail-followup-to:references:mime-version:content-disposition
 :in-reply-to:user-agent;
 bh=4nxqM2ljOyvMminYRatpYDJ6G2Cnc/jXl/ctoZJW83M=;
 b=JwJl1Hb1PB7hQxZiq4pRevOpIX/qeurZdGvFOgGKBFXTvT8s7sRBWN+fNyszPn4WSV
 t8UijeltHZtHJQaEYBXoSTWtv0flfg9en8exr+v32n814rQyII9xc2CP2o6VX7r348Iq
 SF0ke0JiTLN+PZi15KuDE/gs8AwPaTN6GwuxsLoNe1QvotB/SywuJ59Fh0zCkgnm3d23
 o9cSgsXcctpWqWl8aVfP8/BmwDDu3b0xwennYyeg6P8lJ3XsXfDS3DkBu+r6d8dOLnjn
 FGG45GlIqWEhn6fIR6+1U/jnP0agNU3bdpp9ZNFJcVopOnYkhLGDZRo1VKBPPpJcrkD6
 ihEQ==
X-Gm-Message-State: APjAAAVhqn968lQxoLJESdROymyVbgF7huUWz2xHr5RNvaTIY8tidhLq
 R2SJjg34m2nUXQW0NpBReIOwWg==
X-Google-Smtp-Source: APXvYqybChoKvzBJe0qZmOguygfwtRjhAkDRwH2KLyFJgBjBSdPYOnvgrE4Flw1lqlNZpOfU4z3F/g==
X-Received: by 2002:a1c:610b:: with SMTP id v11mr3401069wmb.156.1574848617309; 
 Wed, 27 Nov 2019 01:56:57 -0800 (PST)
Received: from phenom.ffwll.local (212-51-149-96.fiber7.init7.net.
 [212.51.149.96])
 by smtp.gmail.com with ESMTPSA id f6sm18766987wrr.15.2019.11.27.01.56.55
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Wed, 27 Nov 2019 01:56:56 -0800 (PST)
Date: Wed, 27 Nov 2019 10:56:54 +0100
From: Daniel Vetter <daniel@ffwll.ch>
To: Bibby Hsieh <bibby.hsieh@mediatek.com>
Subject: Re: [PATCH 1/7] drm/mediatek: fix atomic_state reference counting
Message-ID: <20191127095654.GD29965@phenom.ffwll.local>
Mail-Followup-To: Bibby Hsieh <bibby.hsieh@mediatek.com>,
 David Airlie <airlied@linux.ie>,
 Matthias Brugger <matthias.bgg@gmail.com>,
 dri-devel@lists.freedesktop.org, linux-mediatek@lists.infradead.org,
 Philipp Zabel <p.zabel@pengutronix.de>,
 YT Shen <yt.shen@mediatek.com>,
 Thierry Reding <thierry.reding@gmail.com>,
 CK Hu <ck.hu@mediatek.com>, linux-arm-kernel@lists.infradead.org,
 tfiga@chromium.org, drinkcat@chromium.org,
 linux-kernel@vger.kernel.org, srv_heupstream@mediatek.com
References: <20191126062932.19773-1-bibby.hsieh@mediatek.com>
 <20191126062932.19773-2-bibby.hsieh@mediatek.com>
 <20191126084951.GQ29965@phenom.ffwll.local>
 <1574818912.27852.2.camel@mtksdaap41>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <1574818912.27852.2.camel@mtksdaap41>
X-Operating-System: Linux phenom 5.3.0-2-amd64 
User-Agent: Mutt/1.12.2 (2019-09-21)
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ffwll.ch; s=google;
 h=date:from:to:cc:subject:message-id:mail-followup-to:references
 :mime-version:content-disposition:in-reply-to:user-agent;
 bh=4nxqM2ljOyvMminYRatpYDJ6G2Cnc/jXl/ctoZJW83M=;
 b=R31Z7VoPUUJY6KT2xAjALKnYyIBrSVGoK4lXJrfZzGxM5XA/hZOGXro0Of9plFQSeN
 WAnkm8YrwCywO7U+fBLgFEwAhQlj2e25gtjrqSEBGbdTfLVotmmOVVm5jXv27LwBv3oN
 ArxE4LOsaKPaNQRRUSlm/gvS1jOuzp8FxmOzM=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: drinkcat@chromium.org, srv_heupstream@mediatek.com,
 David Airlie <airlied@linux.ie>, Daniel Vetter <daniel.vetter@ffwll.ch>,
 linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org,
 tfiga@chromium.org, Thierry Reding <thierry.reding@gmail.com>,
 linux-mediatek@lists.infradead.org, Matthias Brugger <matthias.bgg@gmail.com>,
 linux-arm-kernel@lists.infradead.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gV2VkLCBOb3YgMjcsIDIwMTkgYXQgMDk6NDE6NTJBTSArMDgwMCwgQmliYnkgSHNpZWggd3Jv
dGU6Cj4gT24gVHVlLCAyMDE5LTExLTI2IGF0IDA5OjQ5ICswMTAwLCBEYW5pZWwgVmV0dGVyIHdy
b3RlOgo+ID4gT24gVHVlLCBOb3YgMjYsIDIwMTkgYXQgMDI6Mjk6MjZQTSArMDgwMCwgQmliYnkg
SHNpZWggd3JvdGU6Cj4gPiA+IFRoZSBEUk0gY29yZSB0YWtlcyBjYXJlIG9mIGFsbCBhdG9taWMg
c3RhdGUgcmVmY291bnRpbmcuCj4gPiA+IEhvd2V2ZXIsIG1lZGlhdGVrIGRybSBkZWZlcnMgc29t
ZSB3b3JrIHRoYXQgYWNjZXNzZXMgcGxhbmVzCj4gPiA+IGFuZCBwbGFuZV9zdGF0ZXMgaW4gZHJt
X2F0b21pY19zdGF0ZSwgYW5kIG11c3QgdGhlcmVmb3JlCj4gPiA+IGtlZXAgaXRzIG93biBhdG9t
aWMgc3RhdGUgcmVmZXJlbmNlcyB1bnRpbCB0aGlzIHdvcmsgY29tcGxldGUuCj4gPiA+IAo+ID4g
PiBXZSB0YWtlIHRoZSBhdG9taWNfc3RhdGUgcmVmZXJlbmNlIGluIGF0b21pY19mdWxzaCgpIGFu
ZCBlbnN1cmUgYWxsIHRoZQo+ID4gPiBpbmZvcm1hdGlvbiBpbiBhdG9taWNfc3RhdGUgYWxyZWFk
eSB3YXMgdXBkYXRlZCBpbiBoYXJkd2FyZSBmb3IKPiA+ID4gc2hvd2luZyBvbiBzY3JlZW4gYW5k
IHRoZW4gc2NoZWR1bGVzIHVucmVmZXJlbmNlX3dvcmsgdG8gZHJvcCByZWZlcmVuY2VzCj4gPiA+
IG9uIGF0b21pY19zdGF0ZS4KPiA+ID4gCj4gPiA+IEZpeGVzOiAxMTlmNTE3MzYyOGEgKCJkcm0v
bWVkaWF0ZWs6IEFkZCBEUk0gRHJpdmVyIGZvciBNZWRpYXRlayBTb0MgTVQ4MTczLiIpCj4gPiA+
IAo+ID4gPiBTaWduZWQtb2ZmLWJ5OiBCaWJieSBIc2llaCA8YmliYnkuaHNpZWhAbWVkaWF0ZWsu
Y29tPgo+ID4gCj4gPiBUaGlzIGxvb2tzIHN0cmFuZ2UuIEZvciBvbmUgeW91IGltcGxlbWVudCB5
b3VyIG93biByZWZlcmVuY2UgY291bnRpbmcgLSBpZgo+ID4gZHJpdmVycyBoYXZlIGEgbmVlZCBm
b3IgZHJtX2F0b21pY19zdGF0ZV9wdXRfaXJxIHRoZW4gSQo+ID4gdGhpbmsgd2Ugc2hvdWxkIGlt
cGxlbWVudCB0aGlzIGluIHRoZSBjb3JlIGNvZGUuCj4gPiAKPiA+IFRoZSBvdGhlciBiaXQgaXMg
dGhhdCBhdG9taWMgY29tbWl0cyBhcmUgbWVhbnQgdG8gc2ltcGx5IHdhaXQgZm9yCj4gPiBldmVy
eXRoaW5nIHRvIGZpbmlzaCAtIGNvbW1pdF90YWlsIGRvZXNuJ3QgaG9sZCBsb2NrcywgaXQncyBv
bmx5IG9yZGVyZWQKPiA+IHRocm91Z2ggZHJtX2NydGNfY29tbWl0IGV2ZW50cyAoYXQgbGVhc3Qg
d2l0aCB0aGUgYXN5bmMgaW1wbGVtZW50YXRpb24gaW4KPiA+IHRoZSBoZWxwZXJzKSwgc28geW91
IGNhbiBqdXN0IGJsb2NrIHRoZXJlIHVudGlsIHlvdXIgaW50ZXJydXB0IGhhbmRsZXIgaXMKPiA+
IGRvbmUgcHJvY2Vzc2luZyB0aGUgY29tbWl0LiBEZXBlbmRpbmcgaG93IHlvdSB3YW50IHRvIGRv
IHRoaXMgeW91IG1pZ2h0Cj4gPiB3YW50IHRvIHdhaXQgYmVmb3JlIG9yIGFmdGVyIGRybV9hdG9t
aWNfaGVscGVyX2NvbW1pdF9od19kb25lKCkuCj4gCj4gT0ssIEkgd2lsbCB0cnkgdG8gYWRkIGEg
c2ltcGxlIHdhaXQvY29tcGxldGlvbiBiZWZvcmUKPiBkcm1fYXRvbWljX2hlbHBlcl9jb21taXRf
aHdfZG9uZSgpIHVudGlsIHRoZSBjb21taXQgd2FzIHByb2Nlc3NlZC4KCk5vdGUgdGhhdCB3YWl0
aW5nIGJlZm9yZSBod19kb25lIHN0YWxscyB0aGUgbmV4dCBjb21taXQuIFlvdSBvbmx5IHdhbnQg
dG8KZG8gdGhhdCBmb3IgZS5nLiBpcnEgaGFuZGxlciB0aGF0IHByb2dyYW1zIHJlZ2lzdGVycyBh
dCB2YmxhbmsuIElmIHlvdQpoYXZlIHNvbWUgY2xlYW51cCB3b3JrIHRoYXQgcnVucyBhZnRlciB0
aGUgbmV3IGZyYW1lIGlzIGFscmVhZHkgc2hvd2luZywKeW91IHNob3VsZCB3YWl0IGZvciB0aGF0
IF9hZnRlcl8gaHdfZG9uZSwgdG8gYXZvaWQgc3RhbGxpbmcgdGhlIG5leHQgZmxpcC4KCkFsc28g
aWYgeW91IHN0YWxsIGFmdGVyIGh3X2RvbmUsIHlvdSBuZWVkIHRvIG1ha2UgZWl0aGVyIG1ha2Ug
c3VyZSB5b3UKaGFuZGxlIGNvbmN1cnJlbmN5IGJldHdlZW4gbXVsdGlwbGUgY29tbWl0cyBmb3Ig
dGhhdCBwYXJ0IHlvdXJzZWxmIChzaW5jZQphbnl0aGluZyBhZnRlciBod19kb25lIGlzbid0IG9y
ZGVyZWQgYW55bW9yZSBieSB0aGUgZGVmYXVsdCBoZWxwZXIgc3R1ZmYpLgotRGFuaWVsCgo+IAo+
IFRoYW5rcy4KPiAKPiBCaWJieQo+ID4gLURhbmllbAo+ID4gCj4gPiA+IC0tLQo+ID4gPiAgZHJp
dmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fY3J0Yy5jIHwgMTEgKysrLQo+ID4gPiAgZHJp
dmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fZHJ2LmMgIHwgNzkgKysrKysrKysrKysrKysr
KysrKysrKysrKwo+ID4gPiAgZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fZHJ2Lmgg
IHwgIDkgKysrCj4gPiA+ICAzIGZpbGVzIGNoYW5nZWQsIDk3IGluc2VydGlvbnMoKyksIDIgZGVs
ZXRpb25zKC0pCj4gPiA+IAo+ID4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21lZGlh
dGVrL210a19kcm1fY3J0Yy5jIGIvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fY3J0
Yy5jCj4gPiA+IGluZGV4IDI5ZDA1ODJlOTBlOS4uNjhiOTJhZGM5NmJiIDEwMDY0NAo+ID4gPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9jcnRjLmMKPiA+ID4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fY3J0Yy5jCj4gPiA+IEBAIC03LDcgKzcs
NyBAQAo+ID4gPiAgI2luY2x1ZGUgPGxpbnV4L3BtX3J1bnRpbWUuaD4KPiA+ID4gIAo+ID4gPiAg
I2luY2x1ZGUgPGFzbS9iYXJyaWVyLmg+Cj4gPiA+IC0KPiA+ID4gKyNpbmNsdWRlIDxkcm0vZHJt
X2F0b21pYy5oPgo+ID4gPiAgI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljX2hlbHBlci5oPgo+ID4g
PiAgI2luY2x1ZGUgPGRybS9kcm1fcGxhbmVfaGVscGVyLmg+Cj4gPiA+ICAjaW5jbHVkZSA8ZHJt
L2RybV9wcm9iZV9oZWxwZXIuaD4KPiA+ID4gQEAgLTQ3LDYgKzQ3LDcgQEAgc3RydWN0IG10a19k
cm1fY3J0YyB7Cj4gPiA+ICAJc3RydWN0IG10a19kaXNwX211dGV4CQkqbXV0ZXg7Cj4gPiA+ICAJ
dW5zaWduZWQgaW50CQkJZGRwX2NvbXBfbnI7Cj4gPiA+ICAJc3RydWN0IG10a19kZHBfY29tcAkJ
KipkZHBfY29tcDsKPiA+ID4gKwlzdHJ1Y3QgZHJtX2NydGNfc3RhdGUJCSpvbGRfY3J0Y19zdGF0
ZTsKPiA+ID4gIH07Cj4gPiA+ICAKPiA+ID4gIHN0cnVjdCBtdGtfY3J0Y19zdGF0ZSB7Cj4gPiA+
IEBAIC0zNjIsNiArMzYzLDcgQEAgc3RhdGljIHZvaWQgbXRrX2NydGNfZGRwX2h3X2Zpbmkoc3Ry
dWN0IG10a19kcm1fY3J0YyAqbXRrX2NydGMpCj4gPiA+ICBzdGF0aWMgdm9pZCBtdGtfY3J0Y19k
ZHBfY29uZmlnKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykKPiA+ID4gIHsKPiA+ID4gIAlzdHJ1Y3Qg
bXRrX2RybV9jcnRjICptdGtfY3J0YyA9IHRvX210a19jcnRjKGNydGMpOwo+ID4gPiArCXN0cnVj
dCBkcm1fYXRvbWljX3N0YXRlICphdG9taWNfc3RhdGUgPSBtdGtfY3J0Yy0+b2xkX2NydGNfc3Rh
dGUtPnN0YXRlOwo+ID4gPiAgCXN0cnVjdCBtdGtfY3J0Y19zdGF0ZSAqc3RhdGUgPSB0b19tdGtf
Y3J0Y19zdGF0ZShtdGtfY3J0Yy0+YmFzZS5zdGF0ZSk7Cj4gPiA+ICAJc3RydWN0IG10a19kZHBf
Y29tcCAqY29tcCA9IG10a19jcnRjLT5kZHBfY29tcFswXTsKPiA+ID4gIAl1bnNpZ25lZCBpbnQg
aTsKPiA+ID4gQEAgLTM5OSw2ICs0MDEsNyBAQCBzdGF0aWMgdm9pZCBtdGtfY3J0Y19kZHBfY29u
ZmlnKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykKPiA+ID4gIAkJCXBsYW5lX3N0YXRlLT5wZW5kaW5n
LmNvbmZpZyA9IGZhbHNlOwo+ID4gPiAgCQl9Cj4gPiA+ICAJCW10a19jcnRjLT5wZW5kaW5nX3Bs
YW5lcyA9IGZhbHNlOwo+ID4gPiArCQltdGtfYXRvbWljX3N0YXRlX3B1dF9xdWV1ZShhdG9taWNf
c3RhdGUpOwo+ID4gPiAgCX0KPiA+ID4gIH0KPiA+ID4gIAo+ID4gPiBAQCAtNDk0LDYgKzQ5Nyw3
IEBAIHN0YXRpYyB2b2lkIG10a19kcm1fY3J0Y19hdG9taWNfYmVnaW4oc3RydWN0IGRybV9jcnRj
ICpjcnRjLAo+ID4gPiAgc3RhdGljIHZvaWQgbXRrX2RybV9jcnRjX2F0b21pY19mbHVzaChzdHJ1
Y3QgZHJtX2NydGMgKmNydGMsCj4gPiA+ICAJCQkJICAgICAgc3RydWN0IGRybV9jcnRjX3N0YXRl
ICpvbGRfY3J0Y19zdGF0ZSkKPiA+ID4gIHsKPiA+ID4gKwlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0
ZSAqb2xkX2F0b21pY19zdGF0ZSA9IG9sZF9jcnRjX3N0YXRlLT5zdGF0ZTsKPiA+ID4gIAlzdHJ1
Y3QgbXRrX2RybV9jcnRjICptdGtfY3J0YyA9IHRvX210a19jcnRjKGNydGMpOwo+ID4gPiAgCXN0
cnVjdCBtdGtfZHJtX3ByaXZhdGUgKnByaXYgPSBjcnRjLT5kZXYtPmRldl9wcml2YXRlOwo+ID4g
PiAgCXVuc2lnbmVkIGludCBwZW5kaW5nX3BsYW5lcyA9IDA7Cj4gPiA+IEBAIC01MTIsOCArNTE2
LDExIEBAIHN0YXRpYyB2b2lkIG10a19kcm1fY3J0Y19hdG9taWNfZmx1c2goc3RydWN0IGRybV9j
cnRjICpjcnRjLAo+ID4gPiAgCQkJcGVuZGluZ19wbGFuZXMgfD0gQklUKGkpOwo+ID4gPiAgCQl9
Cj4gPiA+ICAJfQo+ID4gPiAtCWlmIChwZW5kaW5nX3BsYW5lcykKPiA+ID4gKwlpZiAocGVuZGlu
Z19wbGFuZXMpIHsKPiA+ID4gIAkJbXRrX2NydGMtPnBlbmRpbmdfcGxhbmVzID0gdHJ1ZTsKPiA+
ID4gKwkJZHJtX2F0b21pY19zdGF0ZV9nZXQob2xkX2F0b21pY19zdGF0ZSk7Cj4gPiA+ICsJCW10
a19jcnRjLT5vbGRfY3J0Y19zdGF0ZSA9IG9sZF9jcnRjX3N0YXRlOwo+ID4gPiArCX0KPiA+ID4g
IAlpZiAoY3J0Yy0+c3RhdGUtPmNvbG9yX21nbXRfY2hhbmdlZCkKPiA+ID4gIAkJZm9yIChpID0g
MDsgaSA8IG10a19jcnRjLT5kZHBfY29tcF9ucjsgaSsrKQo+ID4gPiAgCQkJbXRrX2RkcF9nYW1t
YV9zZXQobXRrX2NydGMtPmRkcF9jb21wW2ldLCBjcnRjLT5zdGF0ZSk7Cj4gPiA+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9kcnYuYyBiL2RyaXZlcnMvZ3B1
L2RybS9tZWRpYXRlay9tdGtfZHJtX2Rydi5jCj4gPiA+IGluZGV4IDY1ODhkYzZkZDVlMy4uNmM2
ODI4M2I2MTI0IDEwMDY0NAo+ID4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRr
X2RybV9kcnYuYwo+ID4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9k
cnYuYwo+ID4gPiBAQCAtMTE1LDEwICsxMTUsODUgQEAgc3RhdGljIGludCBtdGtfYXRvbWljX2Nv
bW1pdChzdHJ1Y3QgZHJtX2RldmljZSAqZHJtLAo+ID4gPiAgCXJldHVybiAwOwo+ID4gPiAgfQo+
ID4gPiAgCj4gPiA+ICtzdHJ1Y3QgbXRrX2F0b21pY19zdGF0ZSB7Cj4gPiA+ICsJc3RydWN0IGRy
bV9hdG9taWNfc3RhdGUgYmFzZTsKPiA+ID4gKwlzdHJ1Y3QgbGlzdF9oZWFkIGxpc3Q7Cj4gPiA+
ICt9Owo+ID4gPiArCj4gPiA+ICtzdGF0aWMgaW5saW5lIHN0cnVjdCBtdGtfYXRvbWljX3N0YXRl
ICp0b19tdGtfc3RhdGUoc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnMpCj4gPiA+ICt7Cj4gPiA+
ICsJcmV0dXJuIGNvbnRhaW5lcl9vZihzLCBzdHJ1Y3QgbXRrX2F0b21pY19zdGF0ZSwgYmFzZSk7
Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4gK3ZvaWQgbXRrX2F0b21pY19zdGF0ZV9wdXRfcXVldWUo
c3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ID4gPiArewo+ID4gPiArCXN0cnVjdCBk
cm1fZGV2aWNlICpkcm0gPSBzdGF0ZS0+ZGV2Owo+ID4gPiArCXN0cnVjdCBtdGtfZHJtX3ByaXZh
dGUgKm10a19kcm0gPSBkcm0tPmRldl9wcml2YXRlOwo+ID4gPiArCXN0cnVjdCBtdGtfYXRvbWlj
X3N0YXRlICptdGtfc3RhdGUgPSB0b19tdGtfc3RhdGUoc3RhdGUpOwo+ID4gPiArCXVuc2lnbmVk
IGxvbmcgZmxhZ3M7Cj4gPiA+ICsKPiA+ID4gKwlzcGluX2xvY2tfaXJxc2F2ZSgmbXRrX2RybS0+
dW5yZWZlcmVuY2UubG9jaywgZmxhZ3MpOwo+ID4gPiArCWxpc3RfYWRkX3RhaWwoJm10a19zdGF0
ZS0+bGlzdCwgJm10a19kcm0tPnVucmVmZXJlbmNlLmxpc3QpOwo+ID4gPiArCXNwaW5fdW5sb2Nr
X2lycXJlc3RvcmUoJm10a19kcm0tPnVucmVmZXJlbmNlLmxvY2ssIGZsYWdzKTsKPiA+ID4gKwo+
ID4gPiArCXNjaGVkdWxlX3dvcmsoJm10a19kcm0tPnVucmVmZXJlbmNlLndvcmspOwo+ID4gPiAr
fQo+ID4gPiArCj4gPiA+ICtzdGF0aWMgdm9pZCBtdGtfdW5yZWZlcmVuY2Vfd29yayhzdHJ1Y3Qg
d29ya19zdHJ1Y3QgKndvcmspCj4gPiA+ICt7Cj4gPiA+ICsJc3RydWN0IG10a19kcm1fcHJpdmF0
ZSAqbXRrX2RybSA9IGNvbnRhaW5lcl9vZih3b3JrLAo+ID4gPiArCQkJc3RydWN0IG10a19kcm1f
cHJpdmF0ZSwgdW5yZWZlcmVuY2Uud29yayk7Cj4gPiA+ICsJdW5zaWduZWQgbG9uZyBmbGFnczsK
PiA+ID4gKwlzdHJ1Y3QgbXRrX2F0b21pY19zdGF0ZSAqc3RhdGUsICp0bXA7Cj4gPiA+ICsKPiA+
ID4gKwkvKgo+ID4gPiArCSAqIGZyYW1lYnVmZmVycyBjYW5ub3QgYmUgdW5yZWZlcmVuY2VkIGlu
IGF0b21pYyBjb250ZXh0Lgo+ID4gPiArCSAqIFRoZXJlZm9yZSwgb25seSBob2xkIHRoZSBzcGlu
bG9jayB3aGVuIGl0ZXJhdGluZyB1bnJlZmVyZW5jZV9saXN0LAo+ID4gPiArCSAqIGFuZCBkcm9w
IGl0IHdoZW4gZG9pbmcgdGhlIHVucmVmZXJlbmNlLgo+ID4gPiArCSAqLwo+ID4gPiArCXNwaW5f
bG9ja19pcnFzYXZlKCZtdGtfZHJtLT51bnJlZmVyZW5jZS5sb2NrLCBmbGFncyk7Cj4gPiA+ICsJ
bGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKHN0YXRlLCB0bXAsICZtdGtfZHJtLT51bnJlZmVyZW5j
ZS5saXN0LCBsaXN0KSB7Cj4gPiA+ICsJCWxpc3RfZGVsKCZzdGF0ZS0+bGlzdCk7Cj4gPiA+ICsJ
CXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJm10a19kcm0tPnVucmVmZXJlbmNlLmxvY2ssIGZsYWdz
KTsKPiA+ID4gKwkJZHJtX2F0b21pY19zdGF0ZV9wdXQoJnN0YXRlLT5iYXNlKTsKPiA+ID4gKwkJ
c3Bpbl9sb2NrX2lycXNhdmUoJm10a19kcm0tPnVucmVmZXJlbmNlLmxvY2ssIGZsYWdzKTsKPiA+
ID4gKwl9Cj4gPiA+ICsJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmbXRrX2RybS0+dW5yZWZlcmVu
Y2UubG9jaywgZmxhZ3MpOwo+ID4gPiArfQo+ID4gPiArCj4gPiA+ICtzdGF0aWMgc3RydWN0IGRy
bV9hdG9taWNfc3RhdGUgKgo+ID4gPiArCQltdGtfZHJtX2F0b21pY19zdGF0ZV9hbGxvYyhzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4gPiArewo+ID4gPiArCXN0cnVjdCBtdGtfYXRvbWljX3N0
YXRlICptdGtfc3RhdGU7Cj4gPiA+ICsKPiA+ID4gKwltdGtfc3RhdGUgPSBremFsbG9jKHNpemVv
ZigqbXRrX3N0YXRlKSwgR0ZQX0tFUk5FTCk7Cj4gPiA+ICsJaWYgKCFtdGtfc3RhdGUpCj4gPiA+
ICsJCXJldHVybiBOVUxMOwo+ID4gPiArCj4gPiA+ICsJaWYgKGRybV9hdG9taWNfc3RhdGVfaW5p
dChkZXYsICZtdGtfc3RhdGUtPmJhc2UpIDwgMCkgewo+ID4gPiArCQlrZnJlZShtdGtfc3RhdGUp
Owo+ID4gPiArCQlyZXR1cm4gTlVMTDsKPiA+ID4gKwl9Cj4gPiA+ICsKPiA+ID4gKwlJTklUX0xJ
U1RfSEVBRCgmbXRrX3N0YXRlLT5saXN0KTsKPiA+ID4gKwo+ID4gPiArCXJldHVybiAmbXRrX3N0
YXRlLT5iYXNlOwo+ID4gPiArfQo+ID4gPiArCj4gPiA+ICtzdGF0aWMgdm9pZCBtdGtfZHJtX2F0
b21pY19zdGF0ZV9mcmVlKHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKPiA+ID4gK3sK
PiA+ID4gKwlzdHJ1Y3QgbXRrX2F0b21pY19zdGF0ZSAqbXRrX3N0YXRlID0gdG9fbXRrX3N0YXRl
KHN0YXRlKTsKPiA+ID4gKwo+ID4gPiArCWRybV9hdG9taWNfc3RhdGVfZGVmYXVsdF9yZWxlYXNl
KHN0YXRlKTsKPiA+ID4gKwlrZnJlZShtdGtfc3RhdGUpOwo+ID4gPiArfQo+ID4gPiArCj4gPiA+
ICBzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9tb2RlX2NvbmZpZ19mdW5jcyBtdGtfZHJtX21vZGVf
Y29uZmlnX2Z1bmNzID0gewo+ID4gPiAgCS5mYl9jcmVhdGUgPSBtdGtfZHJtX21vZGVfZmJfY3Jl
YXRlLAo+ID4gPiAgCS5hdG9taWNfY2hlY2sgPSBkcm1fYXRvbWljX2hlbHBlcl9jaGVjaywKPiA+
ID4gIAkuYXRvbWljX2NvbW1pdCA9IG10a19hdG9taWNfY29tbWl0LAo+ID4gPiArCS5hdG9taWNf
c3RhdGVfYWxsb2MgPSBtdGtfZHJtX2F0b21pY19zdGF0ZV9hbGxvYywKPiA+ID4gKwkuYXRvbWlj
X3N0YXRlX2ZyZWUgPSBtdGtfZHJtX2F0b21pY19zdGF0ZV9mcmVlCj4gPiA+ICB9Owo+ID4gPiAg
Cj4gPiA+ICBzdGF0aWMgY29uc3QgZW51bSBtdGtfZGRwX2NvbXBfaWQgbXQyNzAxX210a19kZHBf
bWFpbltdID0gewo+ID4gPiBAQCAtMzM3LDYgKzQxMiwxMCBAQCBzdGF0aWMgaW50IG10a19kcm1f
a21zX2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRybSkKPiA+ID4gIAlkcm1fa21zX2hlbHBlcl9w
b2xsX2luaXQoZHJtKTsKPiA+ID4gIAlkcm1fbW9kZV9jb25maWdfcmVzZXQoZHJtKTsKPiA+ID4g
IAo+ID4gPiArCUlOSVRfV09SSygmcHJpdmF0ZS0+dW5yZWZlcmVuY2Uud29yaywgbXRrX3VucmVm
ZXJlbmNlX3dvcmspOwo+ID4gPiArCUlOSVRfTElTVF9IRUFEKCZwcml2YXRlLT51bnJlZmVyZW5j
ZS5saXN0KTsKPiA+ID4gKwlzcGluX2xvY2tfaW5pdCgmcHJpdmF0ZS0+dW5yZWZlcmVuY2UubG9j
ayk7Cj4gPiA+ICsKPiA+ID4gIAlyZXR1cm4gMDsKPiA+ID4gIAo+ID4gPiAgZXJyX3Vuc2V0X2Rt
YV9wYXJtczoKPiA+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtf
ZHJtX2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fZHJ2LmgKPiA+ID4g
aW5kZXggYjZhODI3MjhkNTYzLi5jMzdkODM1Y2Y5NDkgMTAwNjQ0Cj4gPiA+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2Rydi5oCj4gPiA+ICsrKyBiL2RyaXZlcnMvZ3B1
L2RybS9tZWRpYXRlay9tdGtfZHJtX2Rydi5oCj4gPiA+IEBAIC01NSw2ICs1NSwxMyBAQCBzdHJ1
Y3QgbXRrX2RybV9wcml2YXRlIHsKPiA+ID4gIAo+ID4gPiAgCXN0cnVjdCBkcm1fYXRvbWljX3N0
YXRlICpzdXNwZW5kX3N0YXRlOwo+ID4gPiAgCj4gPiA+ICsJc3RydWN0IHsKPiA+ID4gKwkJc3Ry
dWN0IHdvcmtfc3RydWN0CXdvcms7Cj4gPiA+ICsJCXN0cnVjdCBsaXN0X2hlYWQJbGlzdDsKPiA+
ID4gKwkJLyogbG9jayBmb3IgdW5yZWZlcmVuY2UgbGlzdCAqLwo+ID4gPiArCQlzcGlubG9ja190
CQlsb2NrOwo+ID4gPiArCX0gdW5yZWZlcmVuY2U7Cj4gPiA+ICsKPiA+ID4gIAlib29sIGRtYV9w
YXJtc19hbGxvY2F0ZWQ7Cj4gPiA+ICB9Owo+ID4gPiAgCj4gPiA+IEBAIC02Niw0ICs3Myw2IEBA
IGV4dGVybiBzdHJ1Y3QgcGxhdGZvcm1fZHJpdmVyIG10a19kcGlfZHJpdmVyOwo+ID4gPiAgZXh0
ZXJuIHN0cnVjdCBwbGF0Zm9ybV9kcml2ZXIgbXRrX2RzaV9kcml2ZXI7Cj4gPiA+ICBleHRlcm4g
c3RydWN0IHBsYXRmb3JtX2RyaXZlciBtdGtfbWlwaV90eF9kcml2ZXI7Cj4gPiA+ICAKPiA+ID4g
K3ZvaWQgbXRrX2F0b21pY19zdGF0ZV9wdXRfcXVldWUoc3RydWN0IGRybV9hdG9taWNfc3RhdGUg
KnN0YXRlKTsKPiA+ID4gKwo+ID4gPiAgI2VuZGlmIC8qIE1US19EUk1fRFJWX0ggKi8KPiA+ID4g
LS0gCj4gPiA+IDIuMTguMAo+ID4gCj4gCgotLSAKRGFuaWVsIFZldHRlcgpTb2Z0d2FyZSBFbmdp
bmVlciwgSW50ZWwgQ29ycG9yYXRpb24KaHR0cDovL2Jsb2cuZmZ3bGwuY2gKX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlz
dApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0
b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
