Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 16AEDEA4C1
	for <lists+dri-devel@lfdr.de>; Wed, 30 Oct 2019 21:30:39 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A1F9B6EB5B;
	Wed, 30 Oct 2019 20:30:36 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-yw1-xc43.google.com (mail-yw1-xc43.google.com
 [IPv6:2607:f8b0:4864:20::c43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A01A76EB5B
 for <dri-devel@lists.freedesktop.org>; Wed, 30 Oct 2019 20:30:35 +0000 (UTC)
Received: by mail-yw1-xc43.google.com with SMTP id s6so1322511ywe.5
 for <dri-devel@lists.freedesktop.org>; Wed, 30 Oct 2019 13:30:35 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=B6FpqH14hFft7pUWCQ+8hRUCMFY4DUkbPtttlr/k7RM=;
 b=ate/C2h4OabQ5mFudcN7+Hb/KBFsputP1OGEJxjssI/7mlA7S7Lw7n/ylhfX2B7MPP
 QUX3nrMQ/cB60N4x9xJ80mxLhbxbSXo6Fd9VDapSLJp/++iGVgt3WQ0A6xZlVNoUjB/6
 uuJNiEtF5GnoM5kZotijp6lCHyUbL7Rznn/0vSsqTUkioQ0OJX1hq7+xZQj9GoXU+OvW
 XgQP+ctOu2NvTOK6mepL0DHbnLVbXYHeIK7r95ovRUyTwutuH7ErohjCBYYdwqJ0o7Az
 rb6OVmHhG1X2sdy19tsuyRvBRkgd9XrmdGMsOILgvJav6lP9tPpiFPluhIhxxCnyWgIG
 3s3Q==
X-Gm-Message-State: APjAAAWMw7WSkoNmbco6KX9WoQdFGhHWPEtAlocFTP9lZOc7idA5xjUu
 SYhhkCL1MEHvzDbLFT8W3JSCQK6dNaE=
X-Google-Smtp-Source: APXvYqxVmw7MSEY0/hT9ZuOQEeutP/O+A9xovHgU06e0lgM12WV0zQ7f9zSKsH2a4mRdS7LHJiD1mw==
X-Received: by 2002:a81:7ac2:: with SMTP id v185mr1184192ywc.458.1572467434346; 
 Wed, 30 Oct 2019 13:30:34 -0700 (PDT)
Received: from rosewood.cam.corp.google.com
 ([2620:0:1013:11:89c6:2139:5435:371d])
 by smtp.gmail.com with ESMTPSA id h35sm416432ywk.63.2019.10.30.13.30.33
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Wed, 30 Oct 2019 13:30:33 -0700 (PDT)
From: Sean Paul <sean@poorly.run>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 2/5] Revert "dma-buf: heaps: Add CMA heap to dmabuf heaps"
Date: Wed, 30 Oct 2019 16:29:51 -0400
Message-Id: <20191030203003.101156-3-sean@poorly.run>
X-Mailer: git-send-email 2.24.0.rc0.303.g954a862665-goog
In-Reply-To: <20191030203003.101156-1-sean@poorly.run>
References: <20191030203003.101156-1-sean@poorly.run>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=poorly.run; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=B6FpqH14hFft7pUWCQ+8hRUCMFY4DUkbPtttlr/k7RM=;
 b=c/zVOMBC7jXLlWCXXTHISUru8FH/BOffylDZJmm0E7TPw9r8GsXiVQp18gniOkbYBp
 9wQQEIMB0xuHF2YhqNEBcvXhsUrW5aoG9dHz1B0geXTShvJaYmjM2Xs784NZoS7M0RSo
 TftqEsT8UtiRwMy6q3x0BLbbbRzk0O+CX8eXQ+idhREI/DfQAFGEpgePPfRSfnqBAIUo
 3dXAu5FF8E1docOp/4GWgMJsBr8KiMTRxdQhAdtr5mMskiBasI60DsQKljdEsSgeKhze
 C3XW7L1rXTIURbemEq11LZc30LkIacHPBlCPyHvNwkzFOVcHf+ZpiFExRgBM5935s9wq
 pt9Q==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: linaro-mm-sig@lists.linaro.org, Hillf Danton <hdanton@sina.com>,
 Sudipto Paul <Sudipto.Paul@arm.com>,
 Vincent Donnefort <Vincent.Donnefort@arm.com>, Sean Paul <sean@poorly.run>,
 Chenbo Feng <fengc@google.com>, Alistair Strachan <astrachan@google.com>,
 Liam Mark <lmark@codeaurora.org>, Christoph Hellwig <hch@infradead.org>,
 Sean Paul <seanpaul@chromium.org>, "Andrew F . Davis" <afd@ti.com>,
 Hridya Valsaraju <hridya@google.com>, Pratik Patel <pratikp@codeaurora.org>,
 linux-media@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogU2VhbiBQYXVsIDxzZWFucGF1bEBjaHJvbWl1bS5vcmc+CgpUaGlzIHJldmVydHMgY29t
bWl0IDQzZDcyMzhmYjlhYzg5N2IyOTkxMjM2OGIzMzU5ZTcyYmFlNDY5YzQuCgpUaGlzIHBhdGNo
c2V0IGRvZXNuJ3QgbWVldCB0aGUgVUFQSSByZXF1aXJlbWVudHMgc2V0IG91dCBpbiBbMV0gZm9y
IHRoZSBEUk0Kc3Vic3lzdGVtLiBPbmNlIHRoZSB1c2Vyc3BhY2UgY29tcG9uZW50IGlzIHJldmll
d2VkIGFuZCByZWFkeSBmb3IgbWVyZ2UKd2UgY2FuIHRyeSBhZ2Fpbi4KClsxXS0gaHR0cHM6Ly8w
MS5vcmcvbGludXhncmFwaGljcy9nZngtZG9jcy9kcm0vZ3B1L2RybS11YXBpLmh0bWwjb3Blbi1z
b3VyY2UtdXNlcnNwYWNlLXJlcXVpcmVtZW50cwoKRml4ZXM6IDQzZDcyMzhmYjlhYyAoImRtYS1i
dWY6IGhlYXBzOiBBZGQgQ01BIGhlYXAgdG8gZG1hYnVmIGhlYXBzIikKQ2M6IExhdXJhIEFiYm90
dCA8bGFiYm90dEByZWRoYXQuY29tPgpDYzogQmVuamFtaW4gR2FpZ25hcmQgPGJlbmphbWluLmdh
aWduYXJkQGxpbmFyby5vcmc+CkNjOiBTdW1pdCBTZW13YWwgPHN1bWl0LnNlbXdhbEBsaW5hcm8u
b3JnPgpDYzogTGlhbSBNYXJrIDxsbWFya0Bjb2RlYXVyb3JhLm9yZz4KQ2M6IFByYXRpayBQYXRl
bCA8cHJhdGlrcEBjb2RlYXVyb3JhLm9yZz4KQ2M6IEJyaWFuIFN0YXJrZXkgPEJyaWFuLlN0YXJr
ZXlAYXJtLmNvbT4KQ2M6IFZpbmNlbnQgRG9ubmVmb3J0IDxWaW5jZW50LkRvbm5lZm9ydEBhcm0u
Y29tPgpDYzogU3VkaXB0byBQYXVsIDxTdWRpcHRvLlBhdWxAYXJtLmNvbT4KQ2M6IEFuZHJldyBG
LiBEYXZpcyA8YWZkQHRpLmNvbT4KQ2M6IENocmlzdG9waCBIZWxsd2lnIDxoY2hAaW5mcmFkZWFk
Lm9yZz4KQ2M6IENoZW5ibyBGZW5nIDxmZW5nY0Bnb29nbGUuY29tPgpDYzogQWxpc3RhaXIgU3Ry
YWNoYW4gPGFzdHJhY2hhbkBnb29nbGUuY29tPgpDYzogSHJpZHlhIFZhbHNhcmFqdSA8aHJpZHlh
QGdvb2dsZS5jb20+CkNjOiBIaWxsZiBEYW50b24gPGhkYW50b25Ac2luYS5jb20+CkNjOiBkcmkt
ZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCkNjOiBCcmlhbiBTdGFya2V5IDxicmlhbi5zdGFy
a2V5QGFybS5jb20+CkNjOiBKb2huIFN0dWx0eiA8am9obi5zdHVsdHpAbGluYXJvLm9yZz4KQ2M6
ICJBbmRyZXcgRi4gRGF2aXMiIDxhZmRAdGkuY29tPgpDYzogbGludXgtbWVkaWFAdmdlci5rZXJu
ZWwub3JnCkNjOiBsaW5hcm8tbW0tc2lnQGxpc3RzLmxpbmFyby5vcmcKU2lnbmVkLW9mZi1ieTog
U2VhbiBQYXVsIDxzZWFuQHBvb3JseS5ydW4+Ci0tLQogZHJpdmVycy9kbWEtYnVmL2hlYXBzL0tj
b25maWcgICAgfCAgIDggLS0KIGRyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9NYWtlZmlsZSAgIHwgICAx
IC0KIGRyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9jbWFfaGVhcC5jIHwgMTc4IC0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0KIDMgZmlsZXMgY2hhbmdlZCwgMTg3IGRlbGV0aW9ucygtKQogZGVs
ZXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9jbWFfaGVhcC5jCgpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9kbWEtYnVmL2hlYXBzL0tjb25maWcgYi9kcml2ZXJzL2RtYS1idWYvaGVh
cHMvS2NvbmZpZwppbmRleCBhNWVlZjA2YzQyMjYuLjIwNTA1Mjc0NDE2OSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9kbWEtYnVmL2hlYXBzL0tjb25maWcKKysrIGIvZHJpdmVycy9kbWEtYnVmL2hlYXBz
L0tjb25maWcKQEAgLTQsMTEgKzQsMyBAQCBjb25maWcgRE1BQlVGX0hFQVBTX1NZU1RFTQogCWhl
bHAKIAkgIENob29zZSB0aGlzIG9wdGlvbiB0byBlbmFibGUgdGhlIHN5c3RlbSBkbWFidWYgaGVh
cC4gVGhlIHN5c3RlbSBoZWFwCiAJICBpcyBiYWNrZWQgYnkgcGFnZXMgZnJvbSB0aGUgYnVkZHkg
YWxsb2NhdG9yLiBJZiBpbiBkb3VidCwgc2F5IFkuCi0KLWNvbmZpZyBETUFCVUZfSEVBUFNfQ01B
Ci0JYm9vbCAiRE1BLUJVRiBDTUEgSGVhcCIKLQlkZXBlbmRzIG9uIERNQUJVRl9IRUFQUyAmJiBE
TUFfQ01BCi0JaGVscAotCSAgQ2hvb3NlIHRoaXMgb3B0aW9uIHRvIGVuYWJsZSBkbWEtYnVmIENN
QSBoZWFwLiBUaGlzIGhlYXAgaXMgYmFja2VkCi0JICBieSB0aGUgQ29udGlndW91cyBNZW1vcnkg
QWxsb2NhdG9yIChDTUEpLiBJZiB5b3VyIHN5c3RlbSBoYXMgdGhlc2UKLQkgIHJlZ2lvbnMsIHlv
dSBzaG91bGQgc2F5IFkgaGVyZS4KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9N
YWtlZmlsZSBiL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9NYWtlZmlsZQppbmRleCA2ZTU0Y2RlYzNk
YTAuLmQxODA4ZWNhMjU4MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9kbWEtYnVmL2hlYXBzL01ha2Vm
aWxlCisrKyBiL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9NYWtlZmlsZQpAQCAtMSw0ICsxLDMgQEAK
ICMgU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAKIG9iai15CQkJCQkrPSBoZWFwLWhl
bHBlcnMubwogb2JqLSQoQ09ORklHX0RNQUJVRl9IRUFQU19TWVNURU0pCSs9IHN5c3RlbV9oZWFw
Lm8KLW9iai0kKENPTkZJR19ETUFCVUZfSEVBUFNfQ01BKQkJKz0gY21hX2hlYXAubwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9kbWEtYnVmL2hlYXBzL2NtYV9oZWFwLmMgYi9kcml2ZXJzL2RtYS1idWYv
aGVhcHMvY21hX2hlYXAuYwpkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDY0OTI2YjVk
NzM1Li4wMDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVycy9kbWEtYnVmL2hlYXBzL2NtYV9oZWFwLmMK
KysrIC9kZXYvbnVsbApAQCAtMSwxNzggKzAsMCBAQAotLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IEdQTC0yLjAKLS8qCi0gKiBETUFCVUYgQ01BIGhlYXAgZXhwb3J0ZXIKLSAqCi0gKiBDb3B5
cmlnaHQgKEMpIDIwMTIsIDIwMTkgTGluYXJvIEx0ZC4KLSAqIEF1dGhvcjogPGJlbmphbWluLmdh
aWduYXJkQGxpbmFyby5vcmc+IGZvciBTVC1Fcmljc3Nvbi4KLSAqLwotCi0jaW5jbHVkZSA8bGlu
dXgvY21hLmg+Ci0jaW5jbHVkZSA8bGludXgvZGV2aWNlLmg+Ci0jaW5jbHVkZSA8bGludXgvZG1h
LWJ1Zi5oPgotI2luY2x1ZGUgPGxpbnV4L2RtYS1oZWFwLmg+Ci0jaW5jbHVkZSA8bGludXgvZG1h
LWNvbnRpZ3VvdXMuaD4KLSNpbmNsdWRlIDxsaW51eC9lcnIuaD4KLSNpbmNsdWRlIDxsaW51eC9l
cnJuby5oPgotI2luY2x1ZGUgPGxpbnV4L2hpZ2htZW0uaD4KLSNpbmNsdWRlIDxsaW51eC9tb2R1
bGUuaD4KLSNpbmNsdWRlIDxsaW51eC9zbGFiLmg+Ci0jaW5jbHVkZSA8bGludXgvc2NhdHRlcmxp
c3QuaD4KLSNpbmNsdWRlIDxsaW51eC9zY2hlZC9zaWduYWwuaD4KLQotI2luY2x1ZGUgImhlYXAt
aGVscGVycy5oIgotCi1zdHJ1Y3QgY21hX2hlYXAgewotCXN0cnVjdCBkbWFfaGVhcCAqaGVhcDsK
LQlzdHJ1Y3QgY21hICpjbWE7Ci19OwotCi1zdGF0aWMgdm9pZCBjbWFfaGVhcF9mcmVlKHN0cnVj
dCBoZWFwX2hlbHBlcl9idWZmZXIgKmJ1ZmZlcikKLXsKLQlzdHJ1Y3QgY21hX2hlYXAgKmNtYV9o
ZWFwID0gZG1hX2hlYXBfZ2V0X2RydmRhdGEoYnVmZmVyLT5oZWFwKTsKLQl1bnNpZ25lZCBsb25n
IG5yX3BhZ2VzID0gYnVmZmVyLT5wYWdlY291bnQ7Ci0Jc3RydWN0IHBhZ2UgKmNtYV9wYWdlcyA9
IGJ1ZmZlci0+cHJpdl92aXJ0OwotCi0JLyogZnJlZSBwYWdlIGxpc3QgKi8KLQlrZnJlZShidWZm
ZXItPnBhZ2VzKTsKLQkvKiByZWxlYXNlIG1lbW9yeSAqLwotCWNtYV9yZWxlYXNlKGNtYV9oZWFw
LT5jbWEsIGNtYV9wYWdlcywgbnJfcGFnZXMpOwotCWtmcmVlKGJ1ZmZlcik7Ci19Ci0KLS8qIGRt
YWJ1ZiBoZWFwIENNQSBvcGVyYXRpb25zIGZ1bmN0aW9ucyAqLwotc3RhdGljIGludCBjbWFfaGVh
cF9hbGxvY2F0ZShzdHJ1Y3QgZG1hX2hlYXAgKmhlYXAsCi0JCQkgICAgIHVuc2lnbmVkIGxvbmcg
bGVuLAotCQkJICAgICB1bnNpZ25lZCBsb25nIGZkX2ZsYWdzLAotCQkJICAgICB1bnNpZ25lZCBs
b25nIGhlYXBfZmxhZ3MpCi17Ci0Jc3RydWN0IGNtYV9oZWFwICpjbWFfaGVhcCA9IGRtYV9oZWFw
X2dldF9kcnZkYXRhKGhlYXApOwotCXN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKmhlbHBlcl9i
dWZmZXI7Ci0Jc3RydWN0IHBhZ2UgKmNtYV9wYWdlczsKLQlzaXplX3Qgc2l6ZSA9IFBBR0VfQUxJ
R04obGVuKTsKLQl1bnNpZ25lZCBsb25nIG5yX3BhZ2VzID0gc2l6ZSA+PiBQQUdFX1NISUZUOwot
CXVuc2lnbmVkIGxvbmcgYWxpZ24gPSBnZXRfb3JkZXIoc2l6ZSk7Ci0Jc3RydWN0IGRtYV9idWYg
KmRtYWJ1ZjsKLQlpbnQgcmV0ID0gLUVOT01FTTsKLQlwZ29mZl90IHBnOwotCi0JaWYgKGFsaWdu
ID4gQ09ORklHX0NNQV9BTElHTk1FTlQpCi0JCWFsaWduID0gQ09ORklHX0NNQV9BTElHTk1FTlQ7
Ci0KLQloZWxwZXJfYnVmZmVyID0ga3phbGxvYyhzaXplb2YoKmhlbHBlcl9idWZmZXIpLCBHRlBf
S0VSTkVMKTsKLQlpZiAoIWhlbHBlcl9idWZmZXIpCi0JCXJldHVybiAtRU5PTUVNOwotCi0JaW5p
dF9oZWFwX2hlbHBlcl9idWZmZXIoaGVscGVyX2J1ZmZlciwgY21hX2hlYXBfZnJlZSk7Ci0JaGVs
cGVyX2J1ZmZlci0+ZmxhZ3MgPSBoZWFwX2ZsYWdzOwotCWhlbHBlcl9idWZmZXItPmhlYXAgPSBo
ZWFwOwotCWhlbHBlcl9idWZmZXItPnNpemUgPSBsZW47Ci0KLQljbWFfcGFnZXMgPSBjbWFfYWxs
b2MoY21hX2hlYXAtPmNtYSwgbnJfcGFnZXMsIGFsaWduLCBmYWxzZSk7Ci0JaWYgKCFjbWFfcGFn
ZXMpCi0JCWdvdG8gZnJlZV9idWY7Ci0KLQlpZiAoUGFnZUhpZ2hNZW0oY21hX3BhZ2VzKSkgewot
CQl1bnNpZ25lZCBsb25nIG5yX2NsZWFyX3BhZ2VzID0gbnJfcGFnZXM7Ci0JCXN0cnVjdCBwYWdl
ICpwYWdlID0gY21hX3BhZ2VzOwotCi0JCXdoaWxlIChucl9jbGVhcl9wYWdlcyA+IDApIHsKLQkJ
CXZvaWQgKnZhZGRyID0ga21hcF9hdG9taWMocGFnZSk7Ci0KLQkJCW1lbXNldCh2YWRkciwgMCwg
UEFHRV9TSVpFKTsKLQkJCWt1bm1hcF9hdG9taWModmFkZHIpOwotCQkJLyoKLQkJCSAqIEF2b2lk
IHdhc3RpbmcgdGltZSB6ZXJvaW5nIG1lbW9yeSBpZiB0aGUgcHJvY2VzcwotCQkJICogaGFzIGJl
ZW4ga2lsbGVkIGJ5IGJ5IFNJR0tJTEwKLQkJCSAqLwotCQkJaWYgKGZhdGFsX3NpZ25hbF9wZW5k
aW5nKGN1cnJlbnQpKQotCQkJCWdvdG8gZnJlZV9jbWE7Ci0KLQkJCXBhZ2UrKzsKLQkJCW5yX2Ns
ZWFyX3BhZ2VzLS07Ci0JCX0KLQl9IGVsc2UgewotCQltZW1zZXQocGFnZV9hZGRyZXNzKGNtYV9w
YWdlcyksIDAsIHNpemUpOwotCX0KLQotCWhlbHBlcl9idWZmZXItPnBhZ2Vjb3VudCA9IG5yX3Bh
Z2VzOwotCWhlbHBlcl9idWZmZXItPnBhZ2VzID0ga21hbGxvY19hcnJheShoZWxwZXJfYnVmZmVy
LT5wYWdlY291bnQsCi0JCQkJCSAgICAgc2l6ZW9mKCpoZWxwZXJfYnVmZmVyLT5wYWdlcyksCi0J
CQkJCSAgICAgR0ZQX0tFUk5FTCk7Ci0JaWYgKCFoZWxwZXJfYnVmZmVyLT5wYWdlcykgewotCQly
ZXQgPSAtRU5PTUVNOwotCQlnb3RvIGZyZWVfY21hOwotCX0KLQotCWZvciAocGcgPSAwOyBwZyA8
IGhlbHBlcl9idWZmZXItPnBhZ2Vjb3VudDsgcGcrKykKLQkJaGVscGVyX2J1ZmZlci0+cGFnZXNb
cGddID0gJmNtYV9wYWdlc1twZ107Ci0KLQkvKiBjcmVhdGUgdGhlIGRtYWJ1ZiAqLwotCWRtYWJ1
ZiA9IGhlYXBfaGVscGVyX2V4cG9ydF9kbWFidWYoaGVscGVyX2J1ZmZlciwgZmRfZmxhZ3MpOwot
CWlmIChJU19FUlIoZG1hYnVmKSkgewotCQlyZXQgPSBQVFJfRVJSKGRtYWJ1Zik7Ci0JCWdvdG8g
ZnJlZV9wYWdlczsKLQl9Ci0KLQloZWxwZXJfYnVmZmVyLT5kbWFidWYgPSBkbWFidWY7Ci0JaGVs
cGVyX2J1ZmZlci0+cHJpdl92aXJ0ID0gY21hX3BhZ2VzOwotCi0JcmV0ID0gZG1hX2J1Zl9mZChk
bWFidWYsIGZkX2ZsYWdzKTsKLQlpZiAocmV0IDwgMCkgewotCQlkbWFfYnVmX3B1dChkbWFidWYp
OwotCQkvKiBqdXN0IHJldHVybiwgYXMgcHV0IHdpbGwgY2FsbCByZWxlYXNlIGFuZCB0aGF0IHdp
bGwgZnJlZSAqLwotCQlyZXR1cm4gcmV0OwotCX0KLQotCXJldHVybiByZXQ7Ci0KLWZyZWVfcGFn
ZXM6Ci0Ja2ZyZWUoaGVscGVyX2J1ZmZlci0+cGFnZXMpOwotZnJlZV9jbWE6Ci0JY21hX3JlbGVh
c2UoY21hX2hlYXAtPmNtYSwgY21hX3BhZ2VzLCBucl9wYWdlcyk7Ci1mcmVlX2J1ZjoKLQlrZnJl
ZShoZWxwZXJfYnVmZmVyKTsKLQlyZXR1cm4gcmV0OwotfQotCi1zdGF0aWMgY29uc3Qgc3RydWN0
IGRtYV9oZWFwX29wcyBjbWFfaGVhcF9vcHMgPSB7Ci0JLmFsbG9jYXRlID0gY21hX2hlYXBfYWxs
b2NhdGUsCi19OwotCi1zdGF0aWMgaW50IF9fYWRkX2NtYV9oZWFwKHN0cnVjdCBjbWEgKmNtYSwg
dm9pZCAqZGF0YSkKLXsKLQlzdHJ1Y3QgY21hX2hlYXAgKmNtYV9oZWFwOwotCXN0cnVjdCBkbWFf
aGVhcF9leHBvcnRfaW5mbyBleHBfaW5mbzsKLQotCWNtYV9oZWFwID0ga3phbGxvYyhzaXplb2Yo
KmNtYV9oZWFwKSwgR0ZQX0tFUk5FTCk7Ci0JaWYgKCFjbWFfaGVhcCkKLQkJcmV0dXJuIC1FTk9N
RU07Ci0JY21hX2hlYXAtPmNtYSA9IGNtYTsKLQotCWV4cF9pbmZvLm5hbWUgPSBjbWFfZ2V0X25h
bWUoY21hKTsKLQlleHBfaW5mby5vcHMgPSAmY21hX2hlYXBfb3BzOwotCWV4cF9pbmZvLnByaXYg
PSBjbWFfaGVhcDsKLQotCWNtYV9oZWFwLT5oZWFwID0gZG1hX2hlYXBfYWRkKCZleHBfaW5mbyk7
Ci0JaWYgKElTX0VSUihjbWFfaGVhcC0+aGVhcCkpIHsKLQkJaW50IHJldCA9IFBUUl9FUlIoY21h
X2hlYXAtPmhlYXApOwotCi0JCWtmcmVlKGNtYV9oZWFwKTsKLQkJcmV0dXJuIHJldDsKLQl9Ci0K
LQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCBhZGRfZGVmYXVsdF9jbWFfaGVhcCh2b2lkKQot
ewotCXN0cnVjdCBjbWEgKmRlZmF1bHRfY21hID0gZGV2X2dldF9jbWFfYXJlYShOVUxMKTsKLQlp
bnQgcmV0ID0gMDsKLQotCWlmIChkZWZhdWx0X2NtYSkKLQkJcmV0ID0gX19hZGRfY21hX2hlYXAo
ZGVmYXVsdF9jbWEsIE5VTEwpOwotCi0JcmV0dXJuIHJldDsKLX0KLW1vZHVsZV9pbml0KGFkZF9k
ZWZhdWx0X2NtYV9oZWFwKTsKLU1PRFVMRV9ERVNDUklQVElPTigiRE1BLUJVRiBDTUEgSGVhcCIp
OwotTU9EVUxFX0xJQ0VOU0UoIkdQTCB2MiIpOwotLSAKU2VhbiBQYXVsLCBTb2Z0d2FyZSBFbmdp
bmVlciwgR29vZ2xlIC8gQ2hyb21pdW0gT1MKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3Rz
LmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xp
c3RpbmZvL2RyaS1kZXZlbA==
