Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 3D98BF1BEC
	for <lists+dri-devel@lfdr.de>; Wed,  6 Nov 2019 18:01:14 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7F7326EDF0;
	Wed,  6 Nov 2019 17:01:10 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mo6-p01-ob.smtp.rzone.de (mo6-p01-ob.smtp.rzone.de
 [IPv6:2a01:238:20a:202:5301::9])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8E3A36EDEE
 for <dri-devel@lists.freedesktop.org>; Wed,  6 Nov 2019 17:01:09 +0000 (UTC)
X-RZG-AUTH: ":P3gBZUipdd93FF5ZZvYFPugejmSTVR2nRPhVORvLd4SsytBXQrEOHTIXs8PvtBNfIQ=="
X-RZG-CLASS-ID: mo00
Received: from localhost.localdomain by smtp.strato.de (RZmta 44.29.0 AUTH)
 with ESMTPSA id e07688vA6H13hLr
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (curve secp521r1 with
 521 ECDH bits, eq. 15360 bits RSA))
 (Client did not present a certificate);
 Wed, 6 Nov 2019 18:01:03 +0100 (CET)
From: Stephan Gerhold <stephan@gerhold.net>
To: Linus Walleij <linus.walleij@linaro.org>
Subject: [PATCH 1/7] drm/mcde: Provide vblank handling unconditionally
Date: Wed,  6 Nov 2019 17:58:29 +0100
Message-Id: <20191106165835.2863-2-stephan@gerhold.net>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191106165835.2863-1-stephan@gerhold.net>
References: <20191106165835.2863-1-stephan@gerhold.net>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 t=1573059666; 
 s=strato-dkim-0002; d=gerhold.net;
 h=References:In-Reply-To:Message-Id:Date:Subject:Cc:To:From:
 X-RZG-CLASS-ID:X-RZG-AUTH:From:Subject:Sender;
 bh=J9JocYh20QsCXMNRsdqwmGBXCwWcIOoZw3BRshFOX10=;
 b=qVM2SRSeYifQBDp5Phxovh+7DHgnwFsPIhd3nBYywfqbOqp4PTem02oDS1j/reTPdq
 sB4DUir839LnhfahZrtVbjUFjliBpM/On2fkn2h+Scu+H7EaBFKY9gLzI/5MxvNgPGd3
 Ds8/Um6XjlT2FGFDHAiDrNZZjMpwpeW4LzYRzLt1tDGzZHdQmrhNkG5nVtbZ4ZU8ZBHc
 tXarHoYCyDb05RZWTxL3uvi4riGupno7vfifd1R06fQHhMgOk3pz7FIsEh0uYJENVEne
 ZADA/6HFqhWKLAq2m0AFptmkYhxNM0r7sHRbN1eY5hcjbKbkN+38aDdm+ugZf9gkhB/m
 1KDg==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: David Airlie <airlied@linux.ie>, Stephan Gerhold <stephan@gerhold.net>,
 dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QXQgdGhlIG1vbWVudCwgdmJsYW5rIGhhbmRsaW5nIGlzIG9ubHkgZW5hYmxlZCB0b2dldGhlciB3
aXRoClRFIHN5bmNocm9uaXphdGlvbi4gSG93ZXZlciwgdGhlIHZibGFuayBJUlEgaXMgYWxzbyB3
b3JraW5nIHdpdGgKb24gZGlzcGxheXMgd2l0aG91dCBURSBzeW5jaHJvbml6YXRpb24gKGUuZy4g
RFNJIHZpZGVvIG1vZGUgcGFuZWxzKS4KSXQgc2VlbXMgbGlrZSB0aGUgdmJsYW5rIElSUSBpcyBh
Y3R1YWxseSBnZW5lcmF0ZWQgYnkgdGhlCk1DREUgaGFyZHdhcmUgZm9yIHRoZSBjaGFubmVsLgoK
VGhlcmVmb3JlLCB0aGUgdmJsYW5rIGhhbmRsaW5nIHNob3VsZCBiZSB3b3JraW5nIGNvcnJlY3Rs
eSBpbgphbGwgdGhlIGNhc2VzIGFuZCB3ZSBjYW4gZW5hYmxlIGl0IHVuY29uZGl0aW9uYWxseS4K
ClNpZ25lZC1vZmYtYnk6IFN0ZXBoYW4gR2VyaG9sZCA8c3RlcGhhbkBnZXJob2xkLm5ldD4KLS0t
CiBkcml2ZXJzL2dwdS9kcm0vbWNkZS9tY2RlX2Rpc3BsYXkuYyB8IDE1ICsrKysrLS0tLS0tLS0t
LQogZHJpdmVycy9ncHUvZHJtL21jZGUvbWNkZV9kcnYuYyAgICAgfCAxNiArKysrLS0tLS0tLS0t
LS0tCiAyIGZpbGVzIGNoYW5nZWQsIDkgaW5zZXJ0aW9ucygrKSwgMjIgZGVsZXRpb25zKC0pCgpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21jZGUvbWNkZV9kaXNwbGF5LmMgYi9kcml2ZXJz
L2dwdS9kcm0vbWNkZS9tY2RlX2Rpc3BsYXkuYwppbmRleCA3NTE0NTRhZTNjZDEuLjY1NTIyNDgx
YjM2NyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL21jZGUvbWNkZV9kaXNwbGF5LmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL21jZGUvbWNkZV9kaXNwbGF5LmMKQEAgLTkzNCwxMCArOTM0LDEw
IEBAIHN0YXRpYyB2b2lkIG1jZGVfZGlzcGxheV9lbmFibGUoc3RydWN0IGRybV9zaW1wbGVfZGlz
cGxheV9waXBlICpwaXBlLAogCQl2YWwgPSByZWFkbChtY2RlLT5yZWdzICsgTUNERV9DUkMpOwog
CQl2YWwgfD0gTUNERV9DUkNfU1lDRU4wOwogCQl3cml0ZWwodmFsLCBtY2RlLT5yZWdzICsgTUNE
RV9DUkMpOwotCi0JCWRybV9jcnRjX3ZibGFua19vbihjcnRjKTsKIAl9CiAKKwlkcm1fY3J0Y192
Ymxhbmtfb24oY3J0Yyk7CisKIAlkZXZfaW5mbyhkcm0tPmRldiwgIk1DREUgZGlzcGxheSBpcyBl
bmFibGVkXG4iKTsKIH0KIApAQCAtOTQ3LDggKzk0Nyw3IEBAIHN0YXRpYyB2b2lkIG1jZGVfZGlz
cGxheV9kaXNhYmxlKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlwZSAqcGlwZSkKIAlzdHJ1
Y3QgZHJtX2RldmljZSAqZHJtID0gY3J0Yy0+ZGV2OwogCXN0cnVjdCBtY2RlICptY2RlID0gZHJt
LT5kZXZfcHJpdmF0ZTsKIAotCWlmIChtY2RlLT50ZV9zeW5jKQotCQlkcm1fY3J0Y192Ymxhbmtf
b2ZmKGNydGMpOworCWRybV9jcnRjX3ZibGFua19vZmYoY3J0Yyk7CiAKIAkvKiBEaXNhYmxlIEZJ
Rk8gQSBmbG93ICovCiAJbWNkZV9kaXNhYmxlX2ZpZm8obWNkZSwgTUNERV9GSUZPX0EsIHRydWUp
OwpAQCAtMTA5Nyw2ICsxMDk2LDggQEAgc3RhdGljIHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlf
cGlwZV9mdW5jcyBtY2RlX2Rpc3BsYXlfZnVuY3MgPSB7CiAJLmVuYWJsZSA9IG1jZGVfZGlzcGxh
eV9lbmFibGUsCiAJLmRpc2FibGUgPSBtY2RlX2Rpc3BsYXlfZGlzYWJsZSwKIAkudXBkYXRlID0g
bWNkZV9kaXNwbGF5X3VwZGF0ZSwKKwkuZW5hYmxlX3ZibGFuayA9IG1jZGVfZGlzcGxheV9lbmFi
bGVfdmJsYW5rLAorCS5kaXNhYmxlX3ZibGFuayA9IG1jZGVfZGlzcGxheV9kaXNhYmxlX3ZibGFu
aywKIAkucHJlcGFyZV9mYiA9IGRybV9nZW1fZmJfc2ltcGxlX2Rpc3BsYXlfcGlwZV9wcmVwYXJl
X2ZiLAogfTsKIApAQCAtMTEyMywxMiArMTEyNCw2IEBAIGludCBtY2RlX2Rpc3BsYXlfaW5pdChz
dHJ1Y3QgZHJtX2RldmljZSAqZHJtKQogCQlEUk1fRk9STUFUX1lVVjQyMiwKIAl9OwogCi0JLyog
UHJvdmlkZSB2Ymxhbmsgb25seSB3aGVuIHdlIGhhdmUgVEUgZW5hYmxlZCAqLwotCWlmIChtY2Rl
LT50ZV9zeW5jKSB7Ci0JCW1jZGVfZGlzcGxheV9mdW5jcy5lbmFibGVfdmJsYW5rID0gbWNkZV9k
aXNwbGF5X2VuYWJsZV92Ymxhbms7Ci0JCW1jZGVfZGlzcGxheV9mdW5jcy5kaXNhYmxlX3ZibGFu
ayA9IG1jZGVfZGlzcGxheV9kaXNhYmxlX3ZibGFuazsKLQl9Ci0KIAlyZXQgPSBkcm1fc2ltcGxl
X2Rpc3BsYXlfcGlwZV9pbml0KGRybSwgJm1jZGUtPnBpcGUsCiAJCQkJCSAgICZtY2RlX2Rpc3Bs
YXlfZnVuY3MsCiAJCQkJCSAgIGZvcm1hdHMsIEFSUkFZX1NJWkUoZm9ybWF0cyksCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vbWNkZS9tY2RlX2Rydi5jIGIvZHJpdmVycy9ncHUvZHJtL21j
ZGUvbWNkZV9kcnYuYwppbmRleCA1NjQ5ODg3ZDJiOTAuLjBjY2QzYjAzMDhjMiAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL21jZGUvbWNkZV9kcnYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
bWNkZS9tY2RlX2Rydi5jCkBAIC0xNzksMTggKzE3OSwxMCBAQCBzdGF0aWMgaW50IG1jZGVfbW9k
ZXNldF9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkcm0pCiAJbW9kZV9jb25maWctPm1pbl9oZWln
aHQgPSAxOwogCW1vZGVfY29uZmlnLT5tYXhfaGVpZ2h0ID0gMTA4MDsKIAotCS8qCi0JICogQ3Vy
cmVudGx5IHdlIG9ubHkgc3VwcG9ydCB2YmxhbmsgaGFuZGxpbmcgb24gdGhlIERTSSBicmlkZ2Us
IHVzaW5nCi0JICogVEUgc3luY2hyb25pemF0aW9uLiBJZiBURSBzeW5jIGlzIG5vdCBzZXQgdXAs
IGl0IGlzIHN0aWxsIHBvc3NpYmxlCi0JICogdG8gcHVzaCBvdXQgYSBzaW5nbGUgdXBkYXRlIG9u
IGRlbWFuZCwgYnV0IHRoaXMgaXMgaGFyZCBmb3IgRFJNIHRvCi0JICogZXhwbG9pdC4KLQkgKi8K
LQlpZiAobWNkZS0+dGVfc3luYykgewotCQlyZXQgPSBkcm1fdmJsYW5rX2luaXQoZHJtLCAxKTsK
LQkJaWYgKHJldCkgewotCQkJZGV2X2Vycihkcm0tPmRldiwgImZhaWxlZCB0byBpbml0IHZibGFu
a1xuIik7Ci0JCQlnb3RvIG91dF9jb25maWc7Ci0JCX0KKwlyZXQgPSBkcm1fdmJsYW5rX2luaXQo
ZHJtLCAxKTsKKwlpZiAocmV0KSB7CisJCWRldl9lcnIoZHJtLT5kZXYsICJmYWlsZWQgdG8gaW5p
dCB2YmxhbmtcbiIpOworCQlnb3RvIG91dF9jb25maWc7CiAJfQogCiAJcmV0ID0gbWNkZV9kaXNw
bGF5X2luaXQoZHJtKTsKLS0gCjIuMjMuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlz
dGluZm8vZHJpLWRldmVs
