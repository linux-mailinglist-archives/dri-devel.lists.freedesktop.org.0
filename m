Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 38A432C47D9
	for <lists+dri-devel@lfdr.de>; Wed, 25 Nov 2020 19:44:45 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id DB0D86E8F0;
	Wed, 25 Nov 2020 18:44:39 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [216.205.24.124])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7164A6E8E3
 for <dri-devel@lists.freedesktop.org>; Wed, 25 Nov 2020 18:44:38 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1606329877;
 h=from:from:reply-to:reply-to:subject:subject:date:date:
 message-id:message-id:to:to:cc:cc:mime-version:mime-version:
 content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=x1ubu375lGfWf+fNMoowlNZQheWo8nCoKoLO42VQKgo=;
 b=byTO2RxCfES9vw/ZaCUP4Me28cd73xm5pOECJbnJZ6aJnKcaacKyZoDs10scboH70CPyIT
 gTTEMEI7dt6YUZYNWA0rRqRPwDQBHvHbB/2jYdbVzlv8Fz8nPeqL/LdNOJTaq/bXGMXU76
 JEbQKd+B185ZslGaIQvHZ7Xbkh6L0v0=
Received: from mail-qv1-f70.google.com (mail-qv1-f70.google.com
 [209.85.219.70]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-153-ebo5MG7xP9-yj5Vu99OXZw-1; Wed, 25 Nov 2020 13:44:35 -0500
X-MC-Unique: ebo5MG7xP9-yj5Vu99OXZw-1
Received: by mail-qv1-f70.google.com with SMTP id o16so3133721qvq.4
 for <dri-devel@lists.freedesktop.org>; Wed, 25 Nov 2020 10:44:35 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:message-id:subject:from:reply-to:to:cc:date
 :in-reply-to:references:organization:user-agent:mime-version
 :content-transfer-encoding;
 bh=x1ubu375lGfWf+fNMoowlNZQheWo8nCoKoLO42VQKgo=;
 b=qzrTQ2G/MhgKdNgLofh4UD4kzU02BOV5mm2oPo3Tu+UCkc/jGOrl5+5ypTWo6Z2bYR
 91W6tHKSr+zja/ZmNe6olPzysznugpptd2Oj7qSoKbh/nsjF/N+0JyYCoKXs33NGAQxu
 JnXXAJTf6sLkxSmE1VsTfk3GSBIbj8qd+PiDGgk5TepAGrNaaKaG+fdbsIEc9x5O6Hck
 E4oTbHvi4ysfD83MQWgF1N1WiSE/P8qjM33lbVSeeTMcc9/JNybafLU/VM8buQLc5KZ9
 fAFt9MeO8mfeTxQb2lko/TC+m9kahypiewAoouTcKcODWBEoOBBlMgucIT0IezbUV1zl
 cC8A==
X-Gm-Message-State: AOAM5331dfukvsdjLRUSE+BPOoL9MvE7pihraloj47npNGQrj1kTPtJv
 +KR8m3iHAop1bHbmKKytQT2LnhqM94MEENO6cLIr+5sKwIgDXkm/QYV3PuP8pHCO5PMd+IT5ITu
 jGsbfqc+ymlS9J58csPnxnTqEY2Xj
X-Received: by 2002:ac8:5ccc:: with SMTP id s12mr195440qta.309.1606329874720; 
 Wed, 25 Nov 2020 10:44:34 -0800 (PST)
X-Google-Smtp-Source: ABdhPJxzLx16k8efwRH46Ve2ZUincydna+PXAmWaLbjuq+TU99Q4eAY/6w1KEdyS1xpQrPPQbk9WbQ==
X-Received: by 2002:ac8:5ccc:: with SMTP id s12mr195423qta.309.1606329874483; 
 Wed, 25 Nov 2020 10:44:34 -0800 (PST)
Received: from Whitewolf.lyude.net
 (pool-108-49-102-102.bstnma.fios.verizon.net. [108.49.102.102])
 by smtp.gmail.com with ESMTPSA id b4sm137447qtt.52.2020.11.25.10.44.33
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Wed, 25 Nov 2020 10:44:33 -0800 (PST)
Message-ID: <3b1bf645662bc81d9c93ad0c74826d8f87d740cc.camel@redhat.com>
Subject: Re: [PATCH 3/3] drm/nouveau: clean up all clients on device removal
From: Lyude Paul <lyude@redhat.com>
To: Jeremy Cline <jcline@redhat.com>, Ben Skeggs <bskeggs@redhat.com>
Date: Wed, 25 Nov 2020 13:44:33 -0500
In-Reply-To: <20201103194912.184413-4-jcline@redhat.com>
References: <20201103194912.184413-1-jcline@redhat.com>
 <20201103194912.184413-4-jcline@redhat.com>
Organization: Red Hat
User-Agent: Evolution 3.38.1 (3.38.1-1.fc33)
MIME-Version: 1.0
Authentication-Results: relay.mimecast.com;
 auth=pass smtp.auth=CUSA124A263 smtp.mailfrom=lyude@redhat.com
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Reply-To: lyude@redhat.com
Cc: David Airlie <airlied@linux.ie>, nouveau@lists.freedesktop.org,
 dri-devel@lists.freedesktop.org, Karol Herbst <kherbst@redhat.com>,
 linux-kernel@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gVHVlLCAyMDIwLTExLTAzIGF0IDE0OjQ5IC0wNTAwLCBKZXJlbXkgQ2xpbmUgd3JvdGU6Cj4g
VGhlIHBvc3RjbG9zZSBoYW5kbGVyIGNhbiBydW4gYWZ0ZXIgdGhlIGRldmljZSBoYXMgYmVlbiBy
ZW1vdmVkIChvciB0aGUKPiBkcml2ZXIgaGFzIGJlZW4gdW5ib3VuZCkgc2luY2UgdXNlcnNwYWNl
IGNsaWVudHMgYXJlIGZyZWUgdG8gaG9sZCB0aGUKPiBmaWxlIG9wZW4gdGhlIGZpbGUgYXMgbG9u
ZyBhcyB0aGV5IHdhbnQuIEJlY2F1c2UgdGhlIGRldmljZSByZW1vdmFsCiAgICAgICAgICAgIF4K
ICAgICAgICAgdHlwbwoKPiBjYWxsYmFjayBmcmVlcyB0aGUgZW50aXJlIG5vdXZlYXVfZHJtIHN0
cnVjdHVyZSwgYW55IHJlZmVyZW5jZSB0byBpdCBpbgo+IHRoZSBwb3N0Y2xvc2UgaGFuZGxlciB3
aWxsIHJlc3VsdCBpbiBhIHVzZS1hZnRlci1mcmVlLgo+IAo+IFRvIHJlcHJvZHVjZSB0aGlzLCBv
bmUgbXVzdCBzaW1wbHkgb3BlbiB0aGUgZGV2aWNlIGZpbGUsIHVuYmluZCB0aGUKPiBkcml2ZXIg
KG9yIHBoeXNpY2FsbHkgcmVtb3ZlIHRoZSBkZXZpY2UpLCBhbmQgdGhlbiBjbG9zZSB0aGUgZGV2
aWNlCj4gZmlsZS4gVGhpcyB3YXMgZm91bmQgYW5kIGNhbiBiZSByZXByb2R1Y2VkIGVhc2lseSB3
aXRoIHRoZSBJR1QKPiBjb3JlX2hvdHVucGx1ZyB0ZXN0cy4KPiAKPiBUbyBhdm9pZCB0aGlzLCBh
bGwgY2xpZW50cyBhcmUgY2xlYW5lZCB1cCBpbiB0aGUgZGV2aWNlIGZpbmlhbGl6YXRpb24KPiBy
YXRoZXIgdGhhbiBkZWZlcnJpbmcgaXQgdG8gdGhlIHBvc3RjbG9zZSBoYW5kbGVyLCBhbmQgdGhl
IHBvc3RjbG9zZQo+IGhhbmRsZXIgaXMgcHJvdGVjdGVkIGJ5IGEgY3JpdGljYWwgc2VjdGlvbiB3
aGljaCBlbnN1cmVzIHRoZQo+IGRybV9kZXZfdW5wbHVnKCkgYW5kIHRoZSBwb3N0Y2xvc2UgaGFu
ZGxlciB3b24ndCByYWNlLgo+IAo+IFRoaXMgaXMgbm90IGFuIGlkZWFsIGZpeCwgc2luY2UgYXMg
SSB1bmRlcnN0YW5kIHRoZSBwcm9wb3NlZCBwbGFuIGZvcgo+IHRoZSBrZXJuZWw8LT51c2Vyc3Bh
Y2UgaW50ZXJmYWNlIGZvciBob3RwbHVnIHN1cHBvcnQsIGRlc3Ryb3lpbmcgdGhlCj4gY2xpZW50
IGJlZm9yZSB0aGUgZmlsZSBpcyBjbG9zZWQgd2lsbCBjYXVzZSBwcm9ibGVtcy4gSG93ZXZlciwg
SSBiZWxpZXZlCj4gdG8gcHJvcGVybHkgZml4IHRoaXMgaXNzdWUsIHRoZSBsaWZldGltZSBvZiB0
aGUgbm91dmVhdV9kcm0gc3RydWN0dXJlCj4gbmVlZHMgdG8gYmUgZXh0ZW5kZWQgdG8gbWF0Y2gg
dGhlIGRybV9kZXZpY2UsIGFuZCB0aGlzIHByb3ZlZCB0byBiZSBhCj4gcmF0aGVyIGludmFzaXZl
IGNoYW5nZS4gVGh1cywgSSd2ZSBicm9rZW4gdGhpcyBvdXQgc28gdGhlIGZpeCBjYW4gYmUKPiBl
YXNpbHkgYmFja3BvcnRlZC4KCkpGWUkgLSBpZiB0aGUgaW50ZW50IGlzIGZvciB0aGlzIHRvIGJl
IGJhY2twb3J0ZWQsIHlvdSBzaG91bGQgYWRkOgoKQ2M6IHN0YWJsZUB2Z2VyLmtlcm5lbC5vcmcg
Cj4gU2lnbmVkLW9mZi1ieTogSmVyZW15IENsaW5lIDxqY2xpbmVAcmVkaGF0LmNvbT4KPiAtLS0K
PiDCoGRyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfZHJtLmMgfCAzMCArKysrKysrKysr
KysrKysrKysrKysrKysrKysKPiDCoDEgZmlsZSBjaGFuZ2VkLCAzMCBpbnNlcnRpb25zKCspCj4g
Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfZHJtLmMKPiBi
L2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfZHJtLmMKPiBpbmRleCBkMTgyYjg3NzI1
OGEuLjc0ZmFiNzc3ZjRkMCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9u
b3V2ZWF1X2RybS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9kcm0u
Ywo+IEBAIC02MjgsNiArNjI4LDcgQEAgbm91dmVhdV9kcm1fZGV2aWNlX2luaXQoc3RydWN0IGRy
bV9kZXZpY2UgKmRldikKPiDCoHN0YXRpYyB2b2lkCj4gwqBub3V2ZWF1X2RybV9kZXZpY2VfZmlu
aShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+IMKgewo+ICvCoMKgwqDCoMKgwqDCoHN0cnVjdCBu
b3V2ZWF1X2NsaSAqY2xpLCAqdGVtcF9jbGk7Cj4gwqDCoMKgwqDCoMKgwqDCoHN0cnVjdCBub3V2
ZWF1X2RybSAqZHJtID0gbm91dmVhdV9kcm0oZGV2KTsKPiDCoAo+IMKgwqDCoMKgwqDCoMKgwqBp
ZiAobm91dmVhdV9wbW9wc19ydW50aW1lKCkpIHsKPiBAQCAtNjUyLDYgKzY1MywyNCBAQCBub3V2
ZWF1X2RybV9kZXZpY2VfZmluaShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+IMKgwqDCoMKgwqDC
oMKgwqBub3V2ZWF1X3R0bV9maW5pKGRybSk7Cj4gwqDCoMKgwqDCoMKgwqDCoG5vdXZlYXVfdmdh
X2ZpbmkoZHJtKTsKPiDCoAo+ICvCoMKgwqDCoMKgwqDCoC8qCj4gK8KgwqDCoMKgwqDCoMKgICog
VGhlcmUgbWF5IGJlIGV4aXN0aW5nIGNsaWVudHMgZnJvbSBhcy15ZXQgdW5jbG9zZWQgZmlsZXMu
IEZvciBub3csCj4gK8KgwqDCoMKgwqDCoMKgICogY2xlYW4gdGhlbSB1cCBoZXJlIHJhdGhlciB0
aGFuIGRlZmVycmluZyB1bnRpbCB0aGUgZmlsZSBpcyBjbG9zZWQsCj4gK8KgwqDCoMKgwqDCoMKg
ICogYnV0IHRoaXMgbGlrZWx5IG5vdCBjb3JyZWN0IGlmIHdlIHdhbnQgdG8gc3VwcG9ydCBob3Qt
dW5wbHVnZ2luZwo+ICvCoMKgwqDCoMKgwqDCoCAqIHByb3Blcmx5Lgo+ICvCoMKgwqDCoMKgwqDC
oCAqLwo+ICvCoMKgwqDCoMKgwqDCoG11dGV4X2xvY2soJmRybS0+Y2xpZW50c19sb2NrKTsKPiAr
wqDCoMKgwqDCoMKgwqBsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUoY2xpLCB0ZW1wX2NsaSwgJmRy
bS0+Y2xpZW50cywgaGVhZCkgewo+ICvCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqBsaXN0
X2RlbCgmY2xpLT5oZWFkKTsKPiArwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgbXV0ZXhf
bG9jaygmY2xpLT5tdXRleCk7Cj4gK8KgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoGlmIChj
bGktPmFiaTE2KQo+ICvCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDC
oMKgbm91dmVhdV9hYmkxNl9maW5pKGNsaS0+YWJpMTYpOwo+ICvCoMKgwqDCoMKgwqDCoMKgwqDC
oMKgwqDCoMKgwqBtdXRleF91bmxvY2soJmNsaS0+bXV0ZXgpOwo+ICvCoMKgwqDCoMKgwqDCoMKg
wqDCoMKgwqDCoMKgwqBub3V2ZWF1X2NsaV9maW5pKGNsaSk7Cj4gK8KgwqDCoMKgwqDCoMKgwqDC
oMKgwqDCoMKgwqDCoGtmcmVlKGNsaSk7Cj4gK8KgwqDCoMKgwqDCoMKgfQo+ICvCoMKgwqDCoMKg
wqDCoG11dGV4X3VubG9jaygmZHJtLT5jbGllbnRzX2xvY2spOwo+ICsKPiDCoMKgwqDCoMKgwqDC
oMKgbm91dmVhdV9jbGlfZmluaSgmZHJtLT5jbGllbnQpOwo+IMKgwqDCoMKgwqDCoMKgwqBub3V2
ZWF1X2NsaV9maW5pKCZkcm0tPm1hc3Rlcik7Cj4gwqDCoMKgwqDCoMKgwqDCoG52aWZfcGFyZW50
X2R0b3IoJmRybS0+cGFyZW50KTsKPiBAQCAtMTExMCw2ICsxMTI5LDE2IEBAIG5vdXZlYXVfZHJt
X3Bvc3RjbG9zZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBzdHJ1Y3QKPiBkcm1fZmlsZSAqZnBy
aXYpCj4gwqB7Cj4gwqDCoMKgwqDCoMKgwqDCoHN0cnVjdCBub3V2ZWF1X2NsaSAqY2xpID0gbm91
dmVhdV9jbGkoZnByaXYpOwo+IMKgwqDCoMKgwqDCoMKgwqBzdHJ1Y3Qgbm91dmVhdV9kcm0gKmRy
bSA9IG5vdXZlYXVfZHJtKGRldik7Cj4gK8KgwqDCoMKgwqDCoMKgaW50IGRldl9pbmRleDsKPiAr
Cj4gK8KgwqDCoMKgwqDCoMKgLyoKPiArwqDCoMKgwqDCoMKgwqAgKiBUaGUgZGV2aWNlIGlzIGdv
bmUsIGFuZCBhcyBpdCBjdXJyZW50bHkgc3RhbmRzIGFsbCBjbGllbnRzIGFyZQo+ICvCoMKgwqDC
oMKgwqDCoCAqIGNsZWFuZWQgdXAgaW4gdGhlIHJlbW92YWwgY29kZXBhdGguIEluIHRoZSBmdXR1
cmUgdGhpcyBtYXkgY2hhbmdlCj4gK8KgwqDCoMKgwqDCoMKgICogc28gdGhhdCB3ZSBjYW4gc3Vw
cG9ydCBob3QtdW5wbHVnZ2luZywgYnV0IGZvciBub3cgd2UgaW1tZWRpYXRlbHkKPiArwqDCoMKg
wqDCoMKgwqAgKiByZXR1cm4gdG8gYXZvaWQgYSBkb3VibGUtZnJlZSBzaXR1YXRpb24uCj4gK8Kg
wqDCoMKgwqDCoMKgICovCj4gK8KgwqDCoMKgwqDCoMKgaWYgKCFkcm1fZGV2X2VudGVyKGRldiwg
JmRldl9pbmRleCkpCj4gK8KgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoHJldHVybjsKPiDC
oAo+IMKgwqDCoMKgwqDCoMKgwqBwbV9ydW50aW1lX2dldF9zeW5jKGRldi0+ZGV2KTsKPiDCoAo+
IEBAIC0xMTI2LDYgKzExNTUsNyBAQCBub3V2ZWF1X2RybV9wb3N0Y2xvc2Uoc3RydWN0IGRybV9k
ZXZpY2UgKmRldiwgc3RydWN0Cj4gZHJtX2ZpbGUgKmZwcml2KQo+IMKgwqDCoMKgwqDCoMKgwqBr
ZnJlZShjbGkpOwo+IMKgwqDCoMKgwqDCoMKgwqBwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRl
di0+ZGV2KTsKPiDCoMKgwqDCoMKgwqDCoMKgcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGV2
LT5kZXYpOwo+ICvCoMKgwqDCoMKgwqDCoGRybV9kZXZfZXhpdChkZXZfaW5kZXgpOwo+IMKgfQo+
IMKgCj4gwqBzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9pb2N0bF9kZXNjCgotLSAKU2luY2VyZWx5
LAogICBMeXVkZSBQYXVsIChzaGUvaGVyKQogICBTb2Z0d2FyZSBFbmdpbmVlciBhdCBSZWQgSGF0
CiAgIApOb3RlOiBJIGRlYWwgd2l0aCBhIGxvdCBvZiBlbWFpbHMgYW5kIGhhdmUgYSBsb3Qgb2Yg
YnVncyBvbiBteSBwbGF0ZS4gSWYgeW91J3ZlCmFza2VkIG1lIGEgcXVlc3Rpb24sIGFyZSB3YWl0
aW5nIGZvciBhIHJldmlldy9tZXJnZSBvbiBhIHBhdGNoLCBldGMuIGFuZCBJCmhhdmVuJ3QgcmVz
cG9uZGVkIGluIGEgd2hpbGUsIHBsZWFzZSBmZWVsIGZyZWUgdG8gc2VuZCBtZSBhbm90aGVyIGVt
YWlsIHRvIGNoZWNrCm9uIG15IHN0YXR1cy4gSSBkb24ndCBiaXRlIQoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApk
cmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Au
b3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVsCg==
