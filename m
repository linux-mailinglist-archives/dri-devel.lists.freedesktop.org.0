Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 799B3B0BA5
	for <lists+dri-devel@lfdr.de>; Thu, 12 Sep 2019 11:40:56 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2BBE26EC83;
	Thu, 12 Sep 2019 09:40:54 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 326296EC52;
 Thu, 12 Sep 2019 09:40:52 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx03.intmail.prod.int.phx2.redhat.com
 [10.5.11.13])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 782F030860CB;
 Thu, 12 Sep 2019 09:40:51 +0000 (UTC)
Received: from jason-ThinkPad-X1-Carbon-6th.redhat.com
 (ovpn-12-89.pek2.redhat.com [10.72.12.89])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 31D6B60852;
 Thu, 12 Sep 2019 09:40:31 +0000 (UTC)
From: Jason Wang <jasowang@redhat.com>
To: kvm@vger.kernel.org, linux-s390@vger.kernel.org,
 linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org,
 intel-gfx@lists.freedesktop.org, intel-gvt-dev@lists.freedesktop.org,
 kwankhede@nvidia.com, alex.williamson@redhat.com
Subject: [RFC PATCH 1/2] mdev: device id support
Date: Thu, 12 Sep 2019 17:40:11 +0800
Message-Id: <20190912094012.29653-2-jasowang@redhat.com>
In-Reply-To: <20190912094012.29653-1-jasowang@redhat.com>
References: <20190912094012.29653-1-jasowang@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.13
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.44]); Thu, 12 Sep 2019 09:40:51 +0000 (UTC)
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: sebott@linux.ibm.com, mst@redhat.com, airlied@linux.ie,
 Jason Wang <jasowang@redhat.com>, heiko.carstens@de.ibm.com,
 virtualization@lists.linux-foundation.org, rob.miller@broadcom.com,
 pasic@linux.ibm.com, borntraeger@de.ibm.com, zhi.a.wang@intel.com,
 farman@linux.ibm.com, idos@mellanox.com, gor@linux.ibm.com,
 cunming.liang@intel.com, xiao.w.wang@intel.com, freude@linux.ibm.com,
 rodrigo.vivi@intel.com, lingshan.zhu@intel.com, akrowiak@linux.ibm.com,
 tiwei.bie@intel.com, pmorel@linux.ibm.com, cohuck@redhat.com,
 oberpar@linux.ibm.com, maxime.coquelin@redhat.com, zhihong.wang@intel.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

TWRldiBidXMgb25seSBzdXBwb3J0IHZmaW8gZHJpdmVyIHJpZ2h0IG5vdywgc28gaXQgZG9lc24n
dCBpbXBsZW1lbnQKbWF0Y2ggbWV0aG9kLiBCdXQgaW4gdGhlIGZ1dHVyZSwgd2UgbWF5IGFkZCBk
cml2ZXJzIG90aGVyIHRoYW4gdmZpbywKb25lIGV4YW1wbGUgaXMgdmlydGlvLW1kZXZbMV0gZHJp
dmVyLiBUaGlzIG1lYW5zIHdlIG5lZWQgdG8gYWRkIGRldmljZQppZCBzdXBwb3J0IGluIGJ1cyBt
YXRjaCBtZXRob2QgdG8gcGFpciB0aGUgbWRldiBkZXZpY2UgYW5kIG1kZXYgZHJpdmVyCmNvcnJl
Y3RseS4KClNvIHRoaXMgcGF0Y2ggYWRkIGlkX3RhYmxlIHRvIG1kZXZfZHJpdmVyIGFuZCBpZCBm
b3IgbWRldiBwYXJlbnQsIGFuZAppbXBsZW1lbnQgdGhlIG1hdGNoIG1ldGhvZCBmb3IgbWRldiBi
dXMuCgpbMV0gaHR0cHM6Ly9sa21sLm9yZy9sa21sLzIwMTkvOS8xMC8xMzUKClNpZ25lZC1vZmYt
Ynk6IEphc29uIFdhbmcgPGphc293YW5nQHJlZGhhdC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Z0L2t2bWd0LmMgIHwgIDIgKy0KIGRyaXZlcnMvczM5MC9jaW8vdmZpb19jY3dfb3Bz
LmMgICB8ICAyICstCiBkcml2ZXJzL3MzOTAvY3J5cHRvL3ZmaW9fYXBfb3BzLmMgfCAgMyArKy0K
IGRyaXZlcnMvdmZpby9tZGV2L21kZXZfY29yZS5jICAgICB8IDE0ICsrKysrKysrKysrKy0tCiBk
cml2ZXJzL3ZmaW8vbWRldi9tZGV2X2RyaXZlci5jICAgfCAxNCArKysrKysrKysrKysrKwogZHJp
dmVycy92ZmlvL21kZXYvbWRldl9wcml2YXRlLmggIHwgIDEgKwogZHJpdmVycy92ZmlvL21kZXYv
dmZpb19tZGV2LmMgICAgIHwgIDYgKysrKysrCiBpbmNsdWRlL2xpbnV4L21kZXYuaCAgICAgICAg
ICAgICAgfCAgNiArKysrKy0KIGluY2x1ZGUvbGludXgvbW9kX2RldmljZXRhYmxlLmggICB8ICA2
ICsrKysrKwogc2FtcGxlcy92ZmlvLW1kZXYvbWJvY2hzLmMgICAgICAgIHwgIDIgKy0KIHNhbXBs
ZXMvdmZpby1tZGV2L21kcHkuYyAgICAgICAgICB8ICAyICstCiBzYW1wbGVzL3ZmaW8tbWRldi9t
dHR5LmMgICAgICAgICAgfCAgMiArLQogMTIgZmlsZXMgY2hhbmdlZCwgNTEgaW5zZXJ0aW9ucygr
KSwgOSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQv
a3ZtZ3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9rdm1ndC5jCmluZGV4IDIzYWEzZTUw
Y2JmOC4uMTlkNTFhMzVmMDE5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQv
a3ZtZ3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQva3ZtZ3QuYwpAQCAtMTYyNSw3
ICsxNjI1LDcgQEAgc3RhdGljIGludCBrdm1ndF9ob3N0X2luaXQoc3RydWN0IGRldmljZSAqZGV2
LCB2b2lkICpndnQsIGNvbnN0IHZvaWQgKm9wcykKIAkJcmV0dXJuIC1FRkFVTFQ7CiAJaW50ZWxf
dmdwdV9vcHMuc3VwcG9ydGVkX3R5cGVfZ3JvdXBzID0ga3ZtX3ZncHVfdHlwZV9ncm91cHM7CiAK
LQlyZXR1cm4gbWRldl9yZWdpc3Rlcl9kZXZpY2UoZGV2LCAmaW50ZWxfdmdwdV9vcHMpOworCXJl
dHVybiBtZGV2X3JlZ2lzdGVyX3ZmaW9fZGV2aWNlKGRldiwgJmludGVsX3ZncHVfb3BzKTsKIH0K
IAogc3RhdGljIHZvaWQga3ZtZ3RfaG9zdF9leGl0KHN0cnVjdCBkZXZpY2UgKmRldikKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvczM5MC9jaW8vdmZpb19jY3dfb3BzLmMgYi9kcml2ZXJzL3MzOTAvY2lv
L3ZmaW9fY2N3X29wcy5jCmluZGV4IDVlYjYxMTE2Y2E2Zi4uZjg3ZDk0MDllMjkwIDEwMDY0NAot
LS0gYS9kcml2ZXJzL3MzOTAvY2lvL3ZmaW9fY2N3X29wcy5jCisrKyBiL2RyaXZlcnMvczM5MC9j
aW8vdmZpb19jY3dfb3BzLmMKQEAgLTU3OCw3ICs1NzgsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0
IG1kZXZfcGFyZW50X29wcyB2ZmlvX2Njd19tZGV2X29wcyA9IHsKIAogaW50IHZmaW9fY2N3X21k
ZXZfcmVnKHN0cnVjdCBzdWJjaGFubmVsICpzY2gpCiB7Ci0JcmV0dXJuIG1kZXZfcmVnaXN0ZXJf
ZGV2aWNlKCZzY2gtPmRldiwgJnZmaW9fY2N3X21kZXZfb3BzKTsKKwlyZXR1cm4gbWRldl9yZWdp
c3Rlcl92ZmlvX2RldmljZSgmc2NoLT5kZXYsICZ2ZmlvX2Njd19tZGV2X29wcyk7CiB9CiAKIHZv
aWQgdmZpb19jY3dfbWRldl91bnJlZyhzdHJ1Y3Qgc3ViY2hhbm5lbCAqc2NoKQpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9zMzkwL2NyeXB0by92ZmlvX2FwX29wcy5jIGIvZHJpdmVycy9zMzkwL2NyeXB0
by92ZmlvX2FwX29wcy5jCmluZGV4IDA2MDRiNDlhNGQzMi4uZWFjYmRlM2M3YTk3IDEwMDY0NAot
LS0gYS9kcml2ZXJzL3MzOTAvY3J5cHRvL3ZmaW9fYXBfb3BzLmMKKysrIGIvZHJpdmVycy9zMzkw
L2NyeXB0by92ZmlvX2FwX29wcy5jCkBAIC0xMjk1LDcgKzEyOTUsOCBAQCBpbnQgdmZpb19hcF9t
ZGV2X3JlZ2lzdGVyKHZvaWQpCiB7CiAJYXRvbWljX3NldCgmbWF0cml4X2Rldi0+YXZhaWxhYmxl
X2luc3RhbmNlcywgTUFYX1pERVZfRU5UUklFU19FWFQpOwogCi0JcmV0dXJuIG1kZXZfcmVnaXN0
ZXJfZGV2aWNlKCZtYXRyaXhfZGV2LT5kZXZpY2UsICZ2ZmlvX2FwX21hdHJpeF9vcHMpOworCXJl
dHVybiBtZGV2X3JlZ2lzdGVyX3ZmaW9fZGV2aWNlKCZtYXRyaXhfZGV2LT5kZXZpY2UsCisJCQkJ
CSAmdmZpb19hcF9tYXRyaXhfb3BzKTsKIH0KIAogdm9pZCB2ZmlvX2FwX21kZXZfdW5yZWdpc3Rl
cih2b2lkKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy92ZmlvL21kZXYvbWRldl9jb3JlLmMgYi9kcml2
ZXJzL3ZmaW8vbWRldi9tZGV2X2NvcmUuYwppbmRleCBiNTU4ZDRjZmQwODIuLmZjMDdmZjNlYmU5
NiAxMDA2NDQKLS0tIGEvZHJpdmVycy92ZmlvL21kZXYvbWRldl9jb3JlLmMKKysrIGIvZHJpdmVy
cy92ZmlvL21kZXYvbWRldl9jb3JlLmMKQEAgLTEzNSwxMSArMTM1LDE0IEBAIHN0YXRpYyBpbnQg
bWRldl9kZXZpY2VfcmVtb3ZlX2NiKHN0cnVjdCBkZXZpY2UgKmRldiwgdm9pZCAqZGF0YSkKICAq
IG1kZXZfcmVnaXN0ZXJfZGV2aWNlIDogUmVnaXN0ZXIgYSBkZXZpY2UKICAqIEBkZXY6IGRldmlj
ZSBzdHJ1Y3R1cmUgcmVwcmVzZW50aW5nIHBhcmVudCBkZXZpY2UuCiAgKiBAb3BzOiBQYXJlbnQg
ZGV2aWNlIG9wZXJhdGlvbiBzdHJ1Y3R1cmUgdG8gYmUgcmVnaXN0ZXJlZC4KKyAqIEBpZDogZGV2
aWNlIGlkLgogICoKICAqIEFkZCBkZXZpY2UgdG8gbGlzdCBvZiByZWdpc3RlcmVkIHBhcmVudCBk
ZXZpY2VzLgogICogUmV0dXJucyBhIG5lZ2F0aXZlIHZhbHVlIG9uIGVycm9yLCBvdGhlcndpc2Ug
MC4KICAqLwotaW50IG1kZXZfcmVnaXN0ZXJfZGV2aWNlKHN0cnVjdCBkZXZpY2UgKmRldiwgY29u
c3Qgc3RydWN0IG1kZXZfcGFyZW50X29wcyAqb3BzKQoraW50IG1kZXZfcmVnaXN0ZXJfZGV2aWNl
KHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCSBjb25zdCBzdHJ1Y3QgbWRldl9wYXJlbnRfb3BzICpv
cHMsCisJCQkgdTggaWQpCiB7CiAJaW50IHJldDsKIAlzdHJ1Y3QgbWRldl9wYXJlbnQgKnBhcmVu
dDsKQEAgLTE3NSw2ICsxNzgsNyBAQCBpbnQgbWRldl9yZWdpc3Rlcl9kZXZpY2Uoc3RydWN0IGRl
dmljZSAqZGV2LCBjb25zdCBzdHJ1Y3QgbWRldl9wYXJlbnRfb3BzICpvcHMpCiAKIAlwYXJlbnQt
PmRldiA9IGRldjsKIAlwYXJlbnQtPm9wcyA9IG9wczsKKwlwYXJlbnQtPmRldmljZV9pZCA9IGlk
OwogCiAJaWYgKCFtZGV2X2J1c19jb21wYXRfY2xhc3MpIHsKIAkJbWRldl9idXNfY29tcGF0X2Ns
YXNzID0gY2xhc3NfY29tcGF0X3JlZ2lzdGVyKCJtZGV2X2J1cyIpOwpAQCAtMjA4LDcgKzIxMiwx
MyBAQCBpbnQgbWRldl9yZWdpc3Rlcl9kZXZpY2Uoc3RydWN0IGRldmljZSAqZGV2LCBjb25zdCBz
dHJ1Y3QgbWRldl9wYXJlbnRfb3BzICpvcHMpCiAJCXB1dF9kZXZpY2UoZGV2KTsKIAlyZXR1cm4g
cmV0OwogfQotRVhQT1JUX1NZTUJPTChtZGV2X3JlZ2lzdGVyX2RldmljZSk7CisKK2ludCBtZGV2
X3JlZ2lzdGVyX3ZmaW9fZGV2aWNlKHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCSAgICAgIGNvbnN0
IHN0cnVjdCBtZGV2X3BhcmVudF9vcHMgKm9wcykKK3sKKwlyZXR1cm4gbWRldl9yZWdpc3Rlcl9k
ZXZpY2UoZGV2LCBvcHMsIE1ERVZfSURfVkZJTyk7Cit9CitFWFBPUlRfU1lNQk9MKG1kZXZfcmVn
aXN0ZXJfdmZpb19kZXZpY2UpOwogCiAvKgogICogbWRldl91bnJlZ2lzdGVyX2RldmljZSA6IFVu
cmVnaXN0ZXIgYSBwYXJlbnQgZGV2aWNlCmRpZmYgLS1naXQgYS9kcml2ZXJzL3ZmaW8vbWRldi9t
ZGV2X2RyaXZlci5jIGIvZHJpdmVycy92ZmlvL21kZXYvbWRldl9kcml2ZXIuYwppbmRleCAwZDMy
MjNhZWUyMGIuLmZkNWU5NTQxZDE4ZSAxMDA2NDQKLS0tIGEvZHJpdmVycy92ZmlvL21kZXYvbWRl
dl9kcml2ZXIuYworKysgYi9kcml2ZXJzL3ZmaW8vbWRldi9tZGV2X2RyaXZlci5jCkBAIC02OSw4
ICs2OSwyMiBAQCBzdGF0aWMgaW50IG1kZXZfcmVtb3ZlKHN0cnVjdCBkZXZpY2UgKmRldikKIAly
ZXR1cm4gMDsKIH0KIAorc3RhdGljIGludCBtZGV2X21hdGNoKHN0cnVjdCBkZXZpY2UgKmRldiwg
c3RydWN0IGRldmljZV9kcml2ZXIgKmRydikKK3sKKwl1bnNpZ25lZCBpbnQgaTsKKwlzdHJ1Y3Qg
bWRldl9kZXZpY2UgKm1kZXYgPSB0b19tZGV2X2RldmljZShkZXYpOworCXN0cnVjdCBtZGV2X2Ry
aXZlciAqbWRydiA9IHRvX21kZXZfZHJpdmVyKGRydik7CisJY29uc3Qgc3RydWN0IG1kZXZfZGV2
aWNlX2lkICppZHMgPSBtZHJ2LT5pZF90YWJsZTsKKworCWZvciAoaSA9IDA7IGlkc1tpXS5pZDsg
aSsrKQorCQlpZiAoaWRzW2ldLmlkID09IG1kZXYtPnBhcmVudC0+ZGV2aWNlX2lkKQorCQkJcmV0
dXJuIDE7CisJcmV0dXJuIDA7Cit9CisKIHN0cnVjdCBidXNfdHlwZSBtZGV2X2J1c190eXBlID0g
ewogCS5uYW1lCQk9ICJtZGV2IiwKKwkubWF0Y2gJCT0gbWRldl9tYXRjaCwKIAkucHJvYmUJCT0g
bWRldl9wcm9iZSwKIAkucmVtb3ZlCQk9IG1kZXZfcmVtb3ZlLAogfTsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvdmZpby9tZGV2L21kZXZfcHJpdmF0ZS5oIGIvZHJpdmVycy92ZmlvL21kZXYvbWRldl9w
cml2YXRlLmgKaW5kZXggN2Q5MjI5NTBjYWFmLi43ZmM4MTUzNjcxZTAgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvdmZpby9tZGV2L21kZXZfcHJpdmF0ZS5oCisrKyBiL2RyaXZlcnMvdmZpby9tZGV2L21k
ZXZfcHJpdmF0ZS5oCkBAIC0yMiw2ICsyMiw3IEBAIHN0cnVjdCBtZGV2X3BhcmVudCB7CiAJc3Ry
dWN0IGxpc3RfaGVhZCB0eXBlX2xpc3Q7CiAJLyogU3luY2hyb25pemUgZGV2aWNlIGNyZWF0aW9u
L3JlbW92YWwgd2l0aCBwYXJlbnQgdW5yZWdpc3RyYXRpb24gKi8KIAlzdHJ1Y3Qgcndfc2VtYXBo
b3JlIHVucmVnX3NlbTsKKwl1OCBkZXZpY2VfaWQ7CiB9OwogCiBzdHJ1Y3QgbWRldl9kZXZpY2Ug
ewpkaWZmIC0tZ2l0IGEvZHJpdmVycy92ZmlvL21kZXYvdmZpb19tZGV2LmMgYi9kcml2ZXJzL3Zm
aW8vbWRldi92ZmlvX21kZXYuYwppbmRleCAzMDk2NGE0ZTBhMjguLjg4N2M1N2YxMDg4MCAxMDA2
NDQKLS0tIGEvZHJpdmVycy92ZmlvL21kZXYvdmZpb19tZGV2LmMKKysrIGIvZHJpdmVycy92Zmlv
L21kZXYvdmZpb19tZGV2LmMKQEAgLTEyMCwxMCArMTIwLDE2IEBAIHN0YXRpYyB2b2lkIHZmaW9f
bWRldl9yZW1vdmUoc3RydWN0IGRldmljZSAqZGV2KQogCXZmaW9fZGVsX2dyb3VwX2RldihkZXYp
OwogfQogCitzdGF0aWMgc3RydWN0IG1kZXZfZGV2aWNlX2lkIGlkX3RhYmxlW10gPSB7CisJeyBN
REVWX0lEX1ZGSU8gfSwKKwl7IDAgfSwKK307CisKIHN0YXRpYyBzdHJ1Y3QgbWRldl9kcml2ZXIg
dmZpb19tZGV2X2RyaXZlciA9IHsKIAkubmFtZQk9ICJ2ZmlvX21kZXYiLAogCS5wcm9iZQk9IHZm
aW9fbWRldl9wcm9iZSwKIAkucmVtb3ZlCT0gdmZpb19tZGV2X3JlbW92ZSwKKwkuaWRfdGFibGUg
PSBpZF90YWJsZSwKIH07CiAKIHN0YXRpYyBpbnQgX19pbml0IHZmaW9fbWRldl9pbml0KHZvaWQp
CmRpZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L21kZXYuaCBiL2luY2x1ZGUvbGludXgvbWRldi5o
CmluZGV4IDBjZTMwY2E3OGRiMC4uZjg1MDQ1MzkyMTIwIDEwMDY0NAotLS0gYS9pbmNsdWRlL2xp
bnV4L21kZXYuaAorKysgYi9pbmNsdWRlL2xpbnV4L21kZXYuaApAQCAtMTE4LDYgKzExOCw3IEBA
IHN0cnVjdCBtZGV2X3R5cGVfYXR0cmlidXRlIG1kZXZfdHlwZV9hdHRyXyMjX25hbWUgPQkJXAog
ICogQHByb2JlOiBjYWxsZWQgd2hlbiBuZXcgZGV2aWNlIGNyZWF0ZWQKICAqIEByZW1vdmU6IGNh
bGxlZCB3aGVuIGRldmljZSByZW1vdmVkCiAgKiBAZHJpdmVyOiBkZXZpY2UgZHJpdmVyIHN0cnVj
dHVyZQorICogQGlkX3RhYmxlOiB0aGUgaWRzIHNlcnZpY2VkIGJ5IHRoaXMgZHJpdmVyLgogICoK
ICAqKi8KIHN0cnVjdCBtZGV2X2RyaXZlciB7CkBAIC0xMjUsNiArMTI2LDcgQEAgc3RydWN0IG1k
ZXZfZHJpdmVyIHsKIAlpbnQgICgqcHJvYmUpKHN0cnVjdCBkZXZpY2UgKmRldik7CiAJdm9pZCAo
KnJlbW92ZSkoc3RydWN0IGRldmljZSAqZGV2KTsKIAlzdHJ1Y3QgZGV2aWNlX2RyaXZlciBkcml2
ZXI7CisJY29uc3Qgc3RydWN0IG1kZXZfZGV2aWNlX2lkICppZF90YWJsZTsKIH07CiAKICNkZWZp
bmUgdG9fbWRldl9kcml2ZXIoZHJ2KQljb250YWluZXJfb2YoZHJ2LCBzdHJ1Y3QgbWRldl9kcml2
ZXIsIGRyaXZlcikKQEAgLTEzNSw3ICsxMzcsNyBAQCBjb25zdCBndWlkX3QgKm1kZXZfdXVpZChz
dHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYpOwogCiBleHRlcm4gc3RydWN0IGJ1c190eXBlIG1kZXZf
YnVzX3R5cGU7CiAKLWludCBtZGV2X3JlZ2lzdGVyX2RldmljZShzdHJ1Y3QgZGV2aWNlICpkZXYs
IGNvbnN0IHN0cnVjdCBtZGV2X3BhcmVudF9vcHMgKm9wcyk7CitpbnQgbWRldl9yZWdpc3Rlcl92
ZmlvX2RldmljZShzdHJ1Y3QgZGV2aWNlICpkZXYsIGNvbnN0IHN0cnVjdCBtZGV2X3BhcmVudF9v
cHMgKm9wcyk7CiB2b2lkIG1kZXZfdW5yZWdpc3Rlcl9kZXZpY2Uoc3RydWN0IGRldmljZSAqZGV2
KTsKIAogaW50IG1kZXZfcmVnaXN0ZXJfZHJpdmVyKHN0cnVjdCBtZGV2X2RyaXZlciAqZHJ2LCBz
dHJ1Y3QgbW9kdWxlICpvd25lcik7CkBAIC0xNDUsNCArMTQ3LDYgQEAgc3RydWN0IGRldmljZSAq
bWRldl9wYXJlbnRfZGV2KHN0cnVjdCBtZGV2X2RldmljZSAqbWRldik7CiBzdHJ1Y3QgZGV2aWNl
ICptZGV2X2RldihzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYpOwogc3RydWN0IG1kZXZfZGV2aWNl
ICptZGV2X2Zyb21fZGV2KHN0cnVjdCBkZXZpY2UgKmRldik7CiAKKyNkZWZpbmUgTURFVl9JRF9W
RklPIDEgLyogVkZJTyBkZXZpY2UgKi8KKwogI2VuZGlmIC8qIE1ERVZfSCAqLwpkaWZmIC0tZ2l0
IGEvaW5jbHVkZS9saW51eC9tb2RfZGV2aWNldGFibGUuaCBiL2luY2x1ZGUvbGludXgvbW9kX2Rl
dmljZXRhYmxlLmgKaW5kZXggNTcxNGZkMzVhODNjLi5mMWZjMTQzZGYwNDIgMTAwNjQ0Ci0tLSBh
L2luY2x1ZGUvbGludXgvbW9kX2RldmljZXRhYmxlLmgKKysrIGIvaW5jbHVkZS9saW51eC9tb2Rf
ZGV2aWNldGFibGUuaApAQCAtODIxLDQgKzgyMSwxMCBAQCBzdHJ1Y3Qgd21pX2RldmljZV9pZCB7
CiAJY29uc3Qgdm9pZCAqY29udGV4dDsKIH07CiAKKy8qIE1ERVYgKi8KKworc3RydWN0IG1kZXZf
ZGV2aWNlX2lkIHsKKwlfX3U4IGlkOworfTsKKwogI2VuZGlmIC8qIExJTlVYX01PRF9ERVZJQ0VU
QUJMRV9IICovCmRpZmYgLS1naXQgYS9zYW1wbGVzL3ZmaW8tbWRldi9tYm9jaHMuYyBiL3NhbXBs
ZXMvdmZpby1tZGV2L21ib2Nocy5jCmluZGV4IGFjNWM4YzE3YjFmZi4uNzFhNDQ2OWJlODVkIDEw
MDY0NAotLS0gYS9zYW1wbGVzL3ZmaW8tbWRldi9tYm9jaHMuYworKysgYi9zYW1wbGVzL3ZmaW8t
bWRldi9tYm9jaHMuYwpAQCAtMTQ2OCw3ICsxNDY4LDcgQEAgc3RhdGljIGludCBfX2luaXQgbWJv
Y2hzX2Rldl9pbml0KHZvaWQpCiAJaWYgKHJldCkKIAkJZ290byBmYWlsZWQyOwogCi0JcmV0ID0g
bWRldl9yZWdpc3Rlcl9kZXZpY2UoJm1ib2Noc19kZXYsICZtZGV2X2ZvcHMpOworCXJldCA9IG1k
ZXZfcmVnaXN0ZXJfdmZpb19kZXZpY2UoJm1ib2Noc19kZXYsICZtZGV2X2ZvcHMpOwogCWlmIChy
ZXQpCiAJCWdvdG8gZmFpbGVkMzsKIApkaWZmIC0tZ2l0IGEvc2FtcGxlcy92ZmlvLW1kZXYvbWRw
eS5jIGIvc2FtcGxlcy92ZmlvLW1kZXYvbWRweS5jCmluZGV4IGNjODZiZjY1NjZlNC4uZDMwMjlk
ZDI3ZDkxIDEwMDY0NAotLS0gYS9zYW1wbGVzL3ZmaW8tbWRldi9tZHB5LmMKKysrIGIvc2FtcGxl
cy92ZmlvLW1kZXYvbWRweS5jCkBAIC03NzUsNyArNzc1LDcgQEAgc3RhdGljIGludCBfX2luaXQg
bWRweV9kZXZfaW5pdCh2b2lkKQogCWlmIChyZXQpCiAJCWdvdG8gZmFpbGVkMjsKIAotCXJldCA9
IG1kZXZfcmVnaXN0ZXJfZGV2aWNlKCZtZHB5X2RldiwgJm1kZXZfZm9wcyk7CisJcmV0ID0gbWRl
dl9yZWdpc3Rlcl92ZmlvX2RldmljZSgmbWRweV9kZXYsICZtZGV2X2ZvcHMpOwogCWlmIChyZXQp
CiAJCWdvdG8gZmFpbGVkMzsKIApkaWZmIC0tZ2l0IGEvc2FtcGxlcy92ZmlvLW1kZXYvbXR0eS5j
IGIvc2FtcGxlcy92ZmlvLW1kZXYvbXR0eS5jCmluZGV4IDkyZTc3MGEwNmVhMi4uNzQ0Yzg4YTZi
MjJjIDEwMDY0NAotLS0gYS9zYW1wbGVzL3ZmaW8tbWRldi9tdHR5LmMKKysrIGIvc2FtcGxlcy92
ZmlvLW1kZXYvbXR0eS5jCkBAIC0xNDY4LDcgKzE0NjgsNyBAQCBzdGF0aWMgaW50IF9faW5pdCBt
dHR5X2Rldl9pbml0KHZvaWQpCiAJaWYgKHJldCkKIAkJZ290byBmYWlsZWQyOwogCi0JcmV0ID0g
bWRldl9yZWdpc3Rlcl9kZXZpY2UoJm10dHlfZGV2LmRldiwgJm1kZXZfZm9wcyk7CisJcmV0ID0g
bWRldl9yZWdpc3Rlcl92ZmlvX2RldmljZSgmbXR0eV9kZXYuZGV2LCAmbWRldl9mb3BzKTsKIAlp
ZiAocmV0KQogCQlnb3RvIGZhaWxlZDM7CiAKLS0gCjIuMTkuMQoKX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmkt
ZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
L21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
