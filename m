Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1A73C427EB
	for <lists+dri-devel@lfdr.de>; Wed, 12 Jun 2019 15:46:43 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 88F83894DD;
	Wed, 12 Jun 2019 13:46:40 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-vs1-xe42.google.com (mail-vs1-xe42.google.com
 [IPv6:2607:f8b0:4864:20::e42])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8620989565
 for <dri-devel@lists.freedesktop.org>; Wed, 12 Jun 2019 13:46:39 +0000 (UTC)
Received: by mail-vs1-xe42.google.com with SMTP id u124so10266023vsu.2
 for <dri-devel@lists.freedesktop.org>; Wed, 12 Jun 2019 06:46:39 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc:content-transfer-encoding;
 bh=u+XVeJ9yPMa5rPv/SLhzUwYQGxXqRs0+Mb4SQo4qZvQ=;
 b=JoED9jIBpCbZYxm5XR17+WLuV3CFRBL+Sv+xj9Tdod8gFbIRjeB44HndXVxQbL4lZW
 O0Zc7SyFHt1WAUa+kOVs913R1TtMTDhwn6s/w1oWOgkzYdh853tq6d7I/OhGZc4AGw54
 JJ3TxTwlpgU6LmULvXsPfQuIjOd3cuMlwI4aEq9p8ANEFyR8wVgt1zU1anDC2tQXL1/j
 C2W7wxuo2fECQJfbF88zrC3rmzqRmtV6kzzJiaxwM3Vb0qE3WclMAmQ4dUE70IomZQqS
 rwT2XqZ/bdqRLDGBFrtuBqz/9KI3UICZaW9lKqaVdtMSwPHWUIMSy87dEGUiOGED0rpy
 TpHQ==
X-Gm-Message-State: APjAAAUZkDmZ0lMJMJf1f0eChjE4E+V+j6Wqj0FzjeY8dxa11kK9yeUQ
 GW9yL5C4WjN2h+RC5dphn5/qePycjVxRndUOAsQ=
X-Google-Smtp-Source: APXvYqwu1yR1gMzNkl2Muj2zS4Uk2g7ljT5vaA5PoDDBipmobCt6ztIckDo4EcTcjHW0A0yWowiKXDKR1AzqTtga7og=
X-Received: by 2002:a67:2506:: with SMTP id l6mr16270960vsl.125.1560347198510; 
 Wed, 12 Jun 2019 06:46:38 -0700 (PDT)
MIME-Version: 1.0
References: <20190606222751.32567-1-daniel.vetter@ffwll.ch>
 <20190606222751.32567-10-daniel.vetter@ffwll.ch>
In-Reply-To: <20190606222751.32567-10-daniel.vetter@ffwll.ch>
From: Rodrigo Siqueira <rodrigosiqueiramelo@gmail.com>
Date: Wed, 12 Jun 2019 10:46:28 -0300
Message-ID: <CADKXj+7UK0Y=6rOb2hNW380mNCfjojsWTPcpEhuKEybxvw_rTQ@mail.gmail.com>
Subject: Re: [PATCH 09/10] drm/vkms: totally reworked crc data tracking
To: Daniel Vetter <daniel.vetter@ffwll.ch>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc:content-transfer-encoding;
 bh=u+XVeJ9yPMa5rPv/SLhzUwYQGxXqRs0+Mb4SQo4qZvQ=;
 b=BWDRBOE+h5T59+/44ht8FZQJW+YH8zAP4q5PZxlzdCsIbjLTdj8j9CwpfXIvf6ba/1
 4Qw018lLVHkoVpJEbRt1fKdCDztGfl9vhO3OF7HahMb50dSOwv/SBYKLBFYdgKrhDgsA
 Leboj5cZmAC0/x7CikzemwzFVHBriZD58yX6tiSnrSwZ+hiY8zt5elAyImQ/+jDBykjS
 659iKeWhpswOo8BSFEx/gWT5zb0oPhevsaX1+tkNSJJrzALf3cGeXvdlWuZAXDQ9ZxNX
 5yiLcPIdnGYEpUEQiwJEhWhTp1xsjJIRqpVD/Nb8ybeFbxajR/bKjMfGihiY/swiCqBT
 rGiA==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Daniel Vetter <daniel.vetter@intel.com>,
 DRI Development <dri-devel@lists.freedesktop.org>,
 Haneen Mohammed <hamohammed.sa@gmail.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gVGh1LCBKdW4gNiwgMjAxOSBhdCA3OjI4IFBNIERhbmllbCBWZXR0ZXIgPGRhbmllbC52ZXR0
ZXJAZmZ3bGwuY2g+IHdyb3RlOgo+Cj4gVGhlIGNyYyBjb21wdXRhdGlvbiB3b3JrZXIgbmVlZHMg
dG8gYmUgYWJsZSB0byBnZXQgYXQgc29tZSBkYXRhCj4gc3RydWN0dXJlcyBhbmQgZnJhbWVidWZm
ZXIgbWFwcGluZ3MsIHdoaWxlIHBvdGVudGlhbGx5IG1vcmUgYXRvbWljCj4gdXBkYXRlcyBhcmUg
Z29pbmcgb24uIFRoZSBzb2x1dGlvbiB0aHVzIGZhciBpcyB0byBjb3B5IHJlbGV2YW50IGJpdHMK
PiBhcm91bmQsIGJ1dCB0aGF0J3MgdmVyeSB0ZWRpb3VzLgo+Cj4gSGVyZSdzIGEgbmV3IGFwcHJv
YWNoLCB3aGljaCB0cmllcyB0byBiZSBtb3JlIGNsZXZlciwgYnV0IHJlbGllcyBvbiBhCj4gZmV3
IG5vdC1zby1vYnZpb3VzIHRoaW5nczoKPiAtIGNydGNfc3RhdGUgaXMgYWx3YXlzIHVwZGF0ZWQg
d2hlbiBhIHBsYW5lX3N0YXRlIGNoYW5nZXMuIFRoZXJlZm9yZQo+ICAgd2UgY2FuIGp1c3Qgc3R1
ZmYgcGxhbmVfc3RhdGUgcG9pbnRlcnMgaW50byBhIGNydGNfc3RhdGUuIFRoYXQKPiAgIHNvbHZl
cyB0aGUgcHJvYmxlbSBvZiBlYXNpbHkgZ2V0dGluZyBhdCB0aGUgbmVlZGVkIHBsYW5lX3N0YXRl
cy4KCkp1c3QgZm9yIGN1cmlvc2l0eSwgd2hlcmUgZXhhY3RseSB0aGUgY3JjdF9zdGF0ZSBpcyB1
cGRhdGVkPyBJZgpwb3NzaWJsZSwgY291bGQgeW91IGVsYWJvcmF0ZSBhIGxpdHRsZSBiaXQgYWJv
dXQgdGhpcz8KCj4gLSB3aXRoIHRoZSBmbHVzaGluZyBjaGFuZ2VzIGZyb20gcHJldmlvdXMgcGF0
Y2hlcyB0aGUgYWJvdmUgYWxzbyBob2xkcwo+ICAgd2l0aG91dCByYWNlcyBkdWUgdG8gdGhlIG5l
eHQgYXRvbWljIHVwZGF0ZSBiZWluZyBhIGJpdCBlYWdlciB3aXRoCj4gICBjbGVhbmluZyB1cCBw
ZW5kaW5nIHdvcmsgLSB3ZSBhbHdheXMgd2FpdCBmb3IgYWxsIGNyYyB3b3JrIGl0ZW1zIHRvCj4g
ICBjb21wbGV0ZSBiZWZvcmUgdW5tYXBwaW5nIGZyYW1lYnVmZmVycy4KPiAtIHdlIGFsc28gbmVl
ZCB0byBtYWtlIHN1cmUgdGhhdCB0aGUgaHJ0aW1lciBmaXJlcyBvZmYgdGhlIHJpZ2h0Cj4gICB3
b3JrZXIuIEtlZXAgYSBuZXcgZGlzdGluY3QgY3JjX3N0YXRlIHBvaW50ZXIsIHVuZGVyIHRoZQo+
ICAgdmttc19vdXRwdXQtPmxvY2sgcHJvdGVjdGlvbiBmb3IgdGhpcy4gTm90ZSB0aGF0IGNydGMt
PnN0YXRlIGlzCj4gICB1cGRhdGVkIHZlcnkgZWFybHkgaW4gdGhlIGF0b21pYyBjb21taXQsIHdh
eSBiZWZvcmUgd2UgYXJtIHRoZQo+ICAgdmJsYW5rIGV2ZW50IC0gdGhlIHZibGFuayBldmVudCBz
aG91bGQgYWx3YXlzIG1hdGNoIHRoZSBidWZmZXJzIHdlCj4gICB1c2UgdG8gY29tcHV0ZSB0aGUg
Y3JjLiBUaGlzIGFsc28gc29sdmVzIGFuIGlzc3VlIGluIHRoZSBocnRpbWVyLAo+ICAgd2hlcmUg
d2UndmUgYWNjZXNzZWQgZHJtX2NydGMtPnN0YXRlIHdpdGhvdXQgaG9sZGluZyB0aGUgcmlnaHQg
bG9ja3MKPiAgICh3ZSBoZWxkIG5vbmUgLSBvb3BzKS4KPiAtIGluIHRoZSB3b3JrZXIgaXRzZWxm
IHdlIGNhbiB0aGVuIGp1c3QgYWNjZXNzIHRoZSBwbGFuZSBzdGF0ZXMgd2UKPiAgIG5lZWQsIGFn
YWluIHNvbHZpbmcgYSBidW5jaCBvZiBvcmRlcmluZyBhbmQgbG9ja2luZyBpc3N1ZXMuCj4gICBB
Y2Nlc3NpbmcgcGxhbmUtPnN0YXRlIHJlcXVpcmVzIGxvY2tzLCBhY2Nlc3NpbmcgdGhlIHByaXZh
dGUKPiAgIHZrbXNfY3J0Y19zdGF0ZS0+YWN0aXZlX3BsYW5lcyBwb2ludGVyIG9ubHkgcmVxdWly
ZXMgdGhhdCB0aGUgbWVtb3J5Cj4gICBkb2Vzbid0IGdldCBmcmVlZCB0b28gZWFybHkuCj4KPiBU
aGUgaWRlYSBiZWhpbmQgdmttc19jcnRjX3N0YXRlLT5hY3RpdmVfcGxhbmVzIGlzIHRoYXQgdGhp
cyB3b3VsZAo+IGNvbnRhaW4gYWxsIHZpc2libGUgcGxhbmVzLCBpbiB6LW9yZGVyLCBhcyBhIGZp
cnN0IHN0ZXAgdG93YXJkcyBhIG1vcmUKPiBnZW5lcmljIGJsZW5kaW5nIGltcGxlbWVudGF0aW9u
Lgo+Cj4gTm90ZSB0aGF0IHRoaXMgcGF0Y2ggYWxzbyBmaXhlcyByYWNlcyBiZXR3ZWVuIHByZXBh
cmVfZmIvY2xlYW51cF9mYgo+IGFuZCB0aGUgY3JjIHdvcmtlciBhY2Nlc3NpbmcgLT52YWRkci4K
Pgo+IFNpZ25lZC1vZmYtYnk6IERhbmllbCBWZXR0ZXIgPGRhbmllbC52ZXR0ZXJAaW50ZWwuY29t
Pgo+IENjOiBSb2RyaWdvIFNpcXVlaXJhIDxyb2RyaWdvc2lxdWVpcmFtZWxvQGdtYWlsLmNvbT4K
PiBDYzogSGFuZWVuIE1vaGFtbWVkIDxoYW1vaGFtbWVkLnNhQGdtYWlsLmNvbT4KPiBDYzogRGFu
aWVsIFZldHRlciA8ZGFuaWVsQGZmd2xsLmNoPgo+IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vdmtt
cy92a21zX2NyYy5jICB8IDIxICsrKy0tLS0tLS0tCj4gIGRyaXZlcnMvZ3B1L2RybS92a21zL3Zr
bXNfY3J0Yy5jIHwgNjAgKysrKysrKysrKysrKysrKysrKysrKysrKysrKystLS0KPiAgZHJpdmVy
cy9ncHUvZHJtL3ZrbXMvdmttc19kcnYuaCAgfCAgOSArKysrLQo+ICAzIGZpbGVzIGNoYW5nZWQs
IDY3IGluc2VydGlvbnMoKyksIDIzIGRlbGV0aW9ucygtKQo+Cj4gZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS92a21zL3ZrbXNfY3JjLmMgYi9kcml2ZXJzL2dwdS9kcm0vdmttcy92a21zX2Ny
Yy5jCj4gaW5kZXggOWQxNWU1ZTg1ODMwLi4wZDMxY2ZjMzIwNDIgMTAwNjQ0Cj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL3ZrbXMvdmttc19jcmMuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS92a21z
L3ZrbXNfY3JjLmMKPiBAQCAtMTU5LDExICsxNTksOCBAQCB2b2lkIHZrbXNfY3JjX3dvcmtfaGFu
ZGxlKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBjcmNfd29yayk7Cj4gICAgICAgICBzdHJ1Y3QgZHJtX2Ny
dGMgKmNydGMgPSBjcnRjX3N0YXRlLT5iYXNlLmNydGM7Cj4gICAgICAgICBzdHJ1Y3Qgdmttc19v
dXRwdXQgKm91dCA9IGRybV9jcnRjX3RvX3ZrbXNfb3V0cHV0KGNydGMpOwo+IC0gICAgICAgc3Ry
dWN0IHZrbXNfZGV2aWNlICp2ZGV2ID0gY29udGFpbmVyX29mKG91dCwgc3RydWN0IHZrbXNfZGV2
aWNlLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91
dHB1dCk7Cj4gICAgICAgICBzdHJ1Y3Qgdmttc19jcmNfZGF0YSAqcHJpbWFyeV9jcmMgPSBOVUxM
Owo+ICAgICAgICAgc3RydWN0IHZrbXNfY3JjX2RhdGEgKmN1cnNvcl9jcmMgPSBOVUxMOwo+IC0g
ICAgICAgc3RydWN0IGRybV9wbGFuZSAqcGxhbmU7Cj4gICAgICAgICB1MzIgY3JjMzIgPSAwOwo+
ICAgICAgICAgdTY0IGZyYW1lX3N0YXJ0LCBmcmFtZV9lbmQ7Cj4gICAgICAgICBib29sIGNyY19w
ZW5kaW5nOwo+IEBAIC0xODQsMjEgKzE4MSwxMSBAQCB2b2lkIHZrbXNfY3JjX3dvcmtfaGFuZGxl
KHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiAgICAgICAgIGlmICghY3JjX3BlbmRpbmcpCj4g
ICAgICAgICAgICAgICAgIHJldHVybjsKPgo+IC0gICAgICAgZHJtX2Zvcl9lYWNoX3BsYW5lKHBs
YW5lLCAmdmRldi0+ZHJtKSB7Cj4gLSAgICAgICAgICAgICAgIHN0cnVjdCB2a21zX3BsYW5lX3N0
YXRlICp2cGxhbmVfc3RhdGU7Cj4gLSAgICAgICAgICAgICAgIHN0cnVjdCB2a21zX2NyY19kYXRh
ICpjcmNfZGF0YTsKPiArICAgICAgIGlmIChjcnRjX3N0YXRlLT5udW1fYWN0aXZlX3BsYW5lcyA+
PSAxKQo+ICsgICAgICAgICAgICAgICBwcmltYXJ5X2NyYyA9IGNydGNfc3RhdGUtPmFjdGl2ZV9w
bGFuZXNbMF0tPmNyY19kYXRhOwo+Cj4gLSAgICAgICAgICAgICAgIHZwbGFuZV9zdGF0ZSA9IHRv
X3ZrbXNfcGxhbmVfc3RhdGUocGxhbmUtPnN0YXRlKTsKPiAtICAgICAgICAgICAgICAgY3JjX2Rh
dGEgPSB2cGxhbmVfc3RhdGUtPmNyY19kYXRhOwo+IC0KPiAtICAgICAgICAgICAgICAgaWYgKGRy
bV9mcmFtZWJ1ZmZlcl9yZWFkX3JlZmNvdW50KCZjcmNfZGF0YS0+ZmIpID09IDApCj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgY29udGludWU7Cj4gLQo+IC0gICAgICAgICAgICAgICBpZiAocGxh
bmUtPnR5cGUgPT0gRFJNX1BMQU5FX1RZUEVfUFJJTUFSWSkKPiAtICAgICAgICAgICAgICAgICAg
ICAgICBwcmltYXJ5X2NyYyA9IGNyY19kYXRhOwo+IC0gICAgICAgICAgICAgICBlbHNlCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgY3Vyc29yX2NyYyA9IGNyY19kYXRhOwo+IC0gICAgICAgfQo+
ICsgICAgICAgaWYgKGNydGNfc3RhdGUtPm51bV9hY3RpdmVfcGxhbmVzID09IDIpCj4gKyAgICAg
ICAgICAgICAgIGN1cnNvcl9jcmMgPSBjcnRjX3N0YXRlLT5hY3RpdmVfcGxhbmVzWzFdLT5jcmNf
ZGF0YTsKPgo+ICAgICAgICAgaWYgKHByaW1hcnlfY3JjKQo+ICAgICAgICAgICAgICAgICBjcmMz
MiA9IF92a21zX2dldF9jcmMocHJpbWFyeV9jcmMsIGN1cnNvcl9jcmMpOwo+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vdmttcy92a21zX2NydGMuYyBiL2RyaXZlcnMvZ3B1L2RybS92a21z
L3ZrbXNfY3J0Yy5jCj4gaW5kZXggNDhhNzkzYmE0MDMwLi4xNDE1NmVkNzA0MTUgMTAwNjQ0Cj4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19jcnRjLmMKPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vdmttcy92a21zX2NydGMuYwo+IEBAIC0xLDYgKzEsNyBAQAo+ICAvLyBTUERYLUxpY2Vu
c2UtSWRlbnRpZmllcjogR1BMLTIuMCsKPgo+ICAjaW5jbHVkZSAidmttc19kcnYuaCIKPiArI2lu
Y2x1ZGUgPGRybS9kcm1fYXRvbWljLmg+Cj4gICNpbmNsdWRlIDxkcm0vZHJtX2F0b21pY19oZWxw
ZXIuaD4KPiAgI2luY2x1ZGUgPGRybS9kcm1fcHJvYmVfaGVscGVyLmg+Cj4KPiBAQCAtOSw3ICsx
MCw3IEBAIHN0YXRpYyBlbnVtIGhydGltZXJfcmVzdGFydCB2a21zX3ZibGFua19zaW11bGF0ZShz
dHJ1Y3QgaHJ0aW1lciAqdGltZXIpCj4gICAgICAgICBzdHJ1Y3Qgdmttc19vdXRwdXQgKm91dHB1
dCA9IGNvbnRhaW5lcl9vZih0aW1lciwgc3RydWN0IHZrbXNfb3V0cHV0LAo+ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmJsYW5rX2hydGltZXIpOwo+
ICAgICAgICAgc3RydWN0IGRybV9jcnRjICpjcnRjID0gJm91dHB1dC0+Y3J0YzsKPiAtICAgICAg
IHN0cnVjdCB2a21zX2NydGNfc3RhdGUgKnN0YXRlID0gdG9fdmttc19jcnRjX3N0YXRlKGNydGMt
PnN0YXRlKTsKPiArICAgICAgIHN0cnVjdCB2a21zX2NydGNfc3RhdGUgKnN0YXRlOwo+ICAgICAg
ICAgdTY0IHJldF9vdmVycnVuOwo+ICAgICAgICAgYm9vbCByZXQ7Cj4KPiBAQCAtMjMsNiArMjQs
NyBAQCBzdGF0aWMgZW51bSBocnRpbWVyX3Jlc3RhcnQgdmttc192Ymxhbmtfc2ltdWxhdGUoc3Ry
dWN0IGhydGltZXIgKnRpbWVyKQo+ICAgICAgICAgaWYgKCFyZXQpCj4gICAgICAgICAgICAgICAg
IERSTV9FUlJPUigidmttcyBmYWlsdXJlIG9uIGhhbmRsaW5nIHZibGFuayIpOwo+Cj4gKyAgICAg
ICBzdGF0ZSA9IG91dHB1dC0+Y3JjX3N0YXRlOwo+ICAgICAgICAgaWYgKHN0YXRlICYmIG91dHB1
dC0+Y3JjX2VuYWJsZWQpIHsKPiAgICAgICAgICAgICAgICAgdTY0IGZyYW1lID0gZHJtX2NydGNf
YWNjdXJhdGVfdmJsYW5rX2NvdW50KGNydGMpOwo+Cj4gQEAgLTEyNCwxMCArMTI2LDkgQEAgc3Rh
dGljIHZvaWQgdmttc19hdG9taWNfY3J0Y19kZXN0cm95X3N0YXRlKHN0cnVjdCBkcm1fY3J0YyAq
Y3J0YywKPgo+ICAgICAgICAgX19kcm1fYXRvbWljX2hlbHBlcl9jcnRjX2Rlc3Ryb3lfc3RhdGUo
c3RhdGUpOwo+Cj4gLSAgICAgICBpZiAodmttc19zdGF0ZSkgewo+IC0gICAgICAgICAgICAgICBX
QVJOX09OKHdvcmtfcGVuZGluZygmdmttc19zdGF0ZS0+Y3JjX3dvcmspKTsKPiAtICAgICAgICAg
ICAgICAga2ZyZWUodmttc19zdGF0ZSk7Cj4gLSAgICAgICB9Cj4gKyAgICAgICBXQVJOX09OKHdv
cmtfcGVuZGluZygmdmttc19zdGF0ZS0+Y3JjX3dvcmspKTsKPiArICAgICAgIGtmcmVlKHZrbXNf
c3RhdGUtPmFjdGl2ZV9wbGFuZXMpOwo+ICsgICAgICAga2ZyZWUodmttc19zdGF0ZSk7Cj4gIH0K
Pgo+ICBzdGF0aWMgdm9pZCB2a21zX2F0b21pY19jcnRjX3Jlc2V0KHN0cnVjdCBkcm1fY3J0YyAq
Y3J0YykKPiBAQCAtMTU2LDYgKzE1Nyw1MiBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9jcnRj
X2Z1bmNzIHZrbXNfY3J0Y19mdW5jcyA9IHsKPiAgICAgICAgIC52ZXJpZnlfY3JjX3NvdXJjZSAg
ICAgID0gdmttc192ZXJpZnlfY3JjX3NvdXJjZSwKPiAgfTsKPgo+ICtzdGF0aWMgaW50IHZrbXNf
Y3J0Y19hdG9taWNfY2hlY2soc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGRybV9jcnRjX3N0YXRlICpzdGF0ZSkKPiArewo+
ICsgICAgICAgc3RydWN0IHZrbXNfY3J0Y19zdGF0ZSAqdmttc19zdGF0ZSA9IHRvX3ZrbXNfY3J0
Y19zdGF0ZShzdGF0ZSk7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZTsKPiArICAg
ICAgIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlOwo+ICsgICAgICAgaW50IGkg
PSAwLCByZXQ7Cj4gKwo+ICsgICAgICAgaWYgKHZrbXNfc3RhdGUtPmFjdGl2ZV9wbGFuZXMpCj4g
KyAgICAgICAgICAgICAgIHJldHVybiAwOwo+ICsKPiArICAgICAgIHJldCA9IGRybV9hdG9taWNf
YWRkX2FmZmVjdGVkX3BsYW5lcyhzdGF0ZS0+c3RhdGUsIGNydGMpOwo+ICsgICAgICAgaWYgKHJl
dCA8IDApCj4gKyAgICAgICAgICAgICAgIHJldHVybiByZXQ7Cj4gKwo+ICsgICAgICAgZHJtX2Zv
cl9lYWNoX3BsYW5lX21hc2socGxhbmUsIGNydGMtPmRldiwgc3RhdGUtPnBsYW5lX21hc2spIHsK
CkluIHRoZSBkcm1fZm9yX2VhY2hfcGxhbmVfbWFzayBkb2N1bWVudGF0aW9uIHNheXM6IOKAnCBJ
dGVyYXRlIG92ZXIgYWxsCnBsYW5lcyBzcGVjaWZpZWQgYnkgYml0bWFza+KAnS4gSSBkaWQgbm90
IHVuZGVyc3RhbmQgd2hhdCBpdCBtZWFucyBieQrigJxzcGVjaWZpZWQgYnkgYml0bWFza+KAnSBh
bmQgdGhlIHVzZSBvZiB0aGlzIG1hY3JvIGluIHRoaXMgY29udGV4dC4gSQp0cmllZCB0byByZXBs
YWNlIGl0IGZvciBkcm1fZm9yX2VhY2hfcGxhbmUsIGJ1dCB0aGUgdGVzdCBqdXN0IGJyZWFrLgpD
b3VsZCB5b3UgZXhwbGFpbiBhIGxpdHRsZSBiaXQgdGhlIG1hZ2ljIGJlaGluZApkcm1fZm9yX2Vh
Y2hfcGxhbmVfbWFzaz8KCj4gKyAgICAgICAgICAgICAgIHBsYW5lX3N0YXRlID0gZHJtX2F0b21p
Y19nZXRfZXhpc3RpbmdfcGxhbmVfc3RhdGUoc3RhdGUtPnN0YXRlLAo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYW5l
KTsKPiArICAgICAgICAgICAgICAgV0FSTl9PTighcGxhbmVfc3RhdGUpOwo+ICsKPiArICAgICAg
ICAgICAgICAgaWYgKCFwbGFuZV9zdGF0ZS0+dmlzaWJsZSkKPiArICAgICAgICAgICAgICAgICAg
ICAgICBjb250aW51ZTsKPiArCj4gKyAgICAgICAgICAgICAgIGkrKzsKPiArICAgICAgIH0KPiAr
Cj4gKyAgICAgICB2a21zX3N0YXRlLT5hY3RpdmVfcGxhbmVzID0ga2NhbGxvYyhpLCBzaXplb2Yo
cGxhbmUpLCBHRlBfS0VSTkVMKTsKPiArICAgICAgIGlmICghdmttc19zdGF0ZS0+YWN0aXZlX3Bs
YW5lcykKPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gKyAgICAgICB2a21zX3N0
YXRlLT5udW1fYWN0aXZlX3BsYW5lcyA9IGk7Cj4gKwo+ICsgICAgICAgaSA9IDA7Cj4gKyAgICAg
ICBkcm1fZm9yX2VhY2hfcGxhbmVfbWFzayhwbGFuZSwgY3J0Yy0+ZGV2LCBzdGF0ZS0+cGxhbmVf
bWFzaykgewo+ICsgICAgICAgICAgICAgICBwbGFuZV9zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X2V4
aXN0aW5nX3BsYW5lX3N0YXRlKHN0YXRlLT5zdGF0ZSwKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFuZSk7Cj4gKwo+
ICsgICAgICAgICAgICAgICBpZiAoIXBsYW5lX3N0YXRlLT52aXNpYmxlKQo+ICsgICAgICAgICAg
ICAgICAgICAgICAgIGNvbnRpbnVlOwo+ICsKPiArICAgICAgICAgICAgICAgdmttc19zdGF0ZS0+
YWN0aXZlX3BsYW5lc1tpKytdID0KPiArICAgICAgICAgICAgICAgICAgICAgICB0b192a21zX3Bs
YW5lX3N0YXRlKHBsYW5lX3N0YXRlKTsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICByZXR1cm4g
MDsKPiArfQo+ICsKPiAgc3RhdGljIHZvaWQgdmttc19jcnRjX2F0b21pY19lbmFibGUoc3RydWN0
IGRybV9jcnRjICpjcnRjLAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0
cnVjdCBkcm1fY3J0Y19zdGF0ZSAqb2xkX3N0YXRlKQo+ICB7Cj4gQEAgLTE5NywxMCArMjQ0LDEz
IEBAIHN0YXRpYyB2b2lkIHZrbXNfY3J0Y19hdG9taWNfZmx1c2goc3RydWN0IGRybV9jcnRjICpj
cnRjLAo+ICAgICAgICAgICAgICAgICBjcnRjLT5zdGF0ZS0+ZXZlbnQgPSBOVUxMOwo+ICAgICAg
ICAgfQo+Cj4gKyAgICAgICB2a21zX291dHB1dC0+Y3JjX3N0YXRlID0gdG9fdmttc19jcnRjX3N0
YXRlKGNydGMtPnN0YXRlKTsKPiArCj4gICAgICAgICBzcGluX3VubG9ja19pcnEoJnZrbXNfb3V0
cHV0LT5sb2NrKTsKPiAgfQo+Cj4gIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2NydGNfaGVscGVy
X2Z1bmNzIHZrbXNfY3J0Y19oZWxwZXJfZnVuY3MgPSB7Cj4gKyAgICAgICAuYXRvbWljX2NoZWNr
ICAgPSB2a21zX2NydGNfYXRvbWljX2NoZWNrLAo+ICAgICAgICAgLmF0b21pY19iZWdpbiAgID0g
dmttc19jcnRjX2F0b21pY19iZWdpbiwKPiAgICAgICAgIC5hdG9taWNfZmx1c2ggICA9IHZrbXNf
Y3J0Y19hdG9taWNfZmx1c2gsCj4gICAgICAgICAuYXRvbWljX2VuYWJsZSAgPSB2a21zX2NydGNf
YXRvbWljX2VuYWJsZSwKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19k
cnYuaCBiL2RyaXZlcnMvZ3B1L2RybS92a21zL3ZrbXNfZHJ2LmgKPiBpbmRleCAyYTM1Mjk5YmZi
ODkuLjRlNzQ1MDExMWQ0NSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vdmttcy92a21z
X2Rydi5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19kcnYuaAo+IEBAIC00OSw2
ICs0OSwxMCBAQCBzdHJ1Y3Qgdmttc19jcnRjX3N0YXRlIHsKPiAgICAgICAgIHN0cnVjdCBkcm1f
Y3J0Y19zdGF0ZSBiYXNlOwo+ICAgICAgICAgc3RydWN0IHdvcmtfc3RydWN0IGNyY193b3JrOwo+
Cj4gKyAgICAgICBpbnQgbnVtX2FjdGl2ZV9wbGFuZXM7Cj4gKyAgICAgICAvKiBzdGFjayBvZiBh
Y3RpdmUgcGxhbmVzIGZvciBjcmMgY29tcHV0YXRpb24sIHNob3VsZCBiZSBpbiB6IG9yZGVyICov
Cj4gKyAgICAgICBzdHJ1Y3Qgdmttc19wbGFuZV9zdGF0ZSAqKmFjdGl2ZV9wbGFuZXM7Cj4gKwo+
ICAgICAgICAgLyogYmVsb3cgdGhyZWUgYXJlIHByb3RlY3RlZCBieSB2a21zX291dHB1dC5jcmNf
bG9jayAqLwo+ICAgICAgICAgYm9vbCBjcmNfcGVuZGluZzsKPiAgICAgICAgIHU2NCBmcmFtZV9z
dGFydDsKPiBAQCAtNjIsMTIgKzY2LDE1IEBAIHN0cnVjdCB2a21zX291dHB1dCB7Cj4gICAgICAg
ICBzdHJ1Y3QgaHJ0aW1lciB2YmxhbmtfaHJ0aW1lcjsKPiAgICAgICAgIGt0aW1lX3QgcGVyaW9k
X25zOwo+ICAgICAgICAgc3RydWN0IGRybV9wZW5kaW5nX3ZibGFua19ldmVudCAqZXZlbnQ7Cj4g
LSAgICAgICBib29sIGNyY19lbmFibGVkOwo+ICAgICAgICAgLyogb3JkZXJlZCB3cSBmb3IgY3Jj
X3dvcmsgKi8KPiAgICAgICAgIHN0cnVjdCB3b3JrcXVldWVfc3RydWN0ICpjcmNfd29ya3E7Cj4g
ICAgICAgICAvKiBwcm90ZWN0cyBjb25jdXJyZW50IGFjY2VzcyB0byBjcmNfZGF0YSAqLwo+ICAg
ICAgICAgc3BpbmxvY2tfdCBsb2NrOwo+Cj4gKyAgICAgICAvKiBwcm90ZWN0ZWQgYnkgQGxvY2sg
Ki8KPiArICAgICAgIGJvb2wgY3JjX2VuYWJsZWQ7Cj4gKyAgICAgICBzdHJ1Y3Qgdmttc19jcnRj
X3N0YXRlICpjcmNfc3RhdGU7Cj4gKwo+ICAgICAgICAgc3BpbmxvY2tfdCBjcmNfbG9jazsKPiAg
fTsKPgo+IC0tCj4gMi4yMC4xCj4KCgotLSAKClJvZHJpZ28gU2lxdWVpcmEKaHR0cHM6Ly9zaXF1
ZWlyYS50ZWNoCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
CmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpo
dHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
