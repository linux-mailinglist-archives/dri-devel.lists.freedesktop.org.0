Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 952B5A32A4
	for <lists+dri-devel@lfdr.de>; Fri, 30 Aug 2019 10:32:40 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EBDD46E34A;
	Fri, 30 Aug 2019 08:31:26 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mailgw01.mediatek.com (unknown [210.61.82.183])
 by gabe.freedesktop.org (Postfix) with ESMTP id D58F66E14A
 for <dri-devel@lists.freedesktop.org>; Thu, 29 Aug 2019 14:51:16 +0000 (UTC)
X-UUID: 0a3efaea5a164707bcda5a7e4804e00a-20190829
X-UUID: 0a3efaea5a164707bcda5a7e4804e00a-20190829
Received: from mtkcas09.mediatek.inc [(172.21.101.178)] by
 mailgw01.mediatek.com (envelope-from <yongqiang.niu@mediatek.com>)
 (Cellopoint E-mail Firewall v4.1.10 Build 0809 with TLS)
 with ESMTP id 560609409; Thu, 29 Aug 2019 22:51:12 +0800
Received: from mtkcas09.mediatek.inc (172.21.101.178) by
 mtkmbs01n1.mediatek.inc (172.21.101.68) with Microsoft SMTP Server (TLS) id
 15.0.1395.4; Thu, 29 Aug 2019 22:51:18 +0800
Received: from localhost.localdomain (10.17.3.153) by mtkcas09.mediatek.inc
 (172.21.101.73) with Microsoft SMTP Server id 15.0.1395.4 via Frontend
 Transport; Thu, 29 Aug 2019 22:51:17 +0800
From: <yongqiang.niu@mediatek.com>
To: CK Hu <ck.hu@mediatek.com>, Philipp Zabel <p.zabel@pengutronix.de>, Rob
 Herring <robh+dt@kernel.org>, Matthias Brugger <matthias.bgg@gmail.com>
Subject: [PATCH v5,
 12/32] drm/mediatek: add mmsys private data for ddp path config
Date: Thu, 29 Aug 2019 22:50:34 +0800
Message-ID: <1567090254-15566-13-git-send-email-yongqiang.niu@mediatek.com>
X-Mailer: git-send-email 1.8.1.1.dirty
In-Reply-To: <1567090254-15566-1-git-send-email-yongqiang.niu@mediatek.com>
References: <1567090254-15566-1-git-send-email-yongqiang.niu@mediatek.com>
MIME-Version: 1.0
X-MTK: N
X-Mailman-Approved-At: Fri, 30 Aug 2019 08:29:17 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Mark Rutland <mark.rutland@arm.com>, devicetree@vger.kernel.org,
 Yongqiang Niu <yongqiang.niu@mediatek.com>, David Airlie <airlied@linux.ie>,
 linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org,
 linux-mediatek@lists.infradead.org, linux-arm-kernel@lists.infradead.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogWW9uZ3FpYW5nIE5pdSA8eW9uZ3FpYW5nLm5pdUBtZWRpYXRlay5jb20+CgpUaGlzIHBh
dGNoIGFkZCBtbXN5cyBwcml2YXRlIGRhdGEgZm9yIGRkcCBwYXRoIGNvbmZpZwphbGwgdGhlc2Ug
cmVnaXN0ZXIgb2Zmc2V0IGFuZCB2YWx1ZSB3aWxsIGJlIGRpZmZlcmVudCBpbiBmdXR1cmUgU09D
CmFkZCB0aGVzZSBkZWZpbmUgaW50byBtbXN5cyBwcml2YXRlIGRhdGEKCXUzMiBvdmwwX21vdXRf
ZW47Cgl1MzIgcmRtYTFfc291dF9zZWxfaW47Cgl1MzIgcmRtYTFfc291dF9kc2kwOwoJdTMyIGRw
aTBfc2VsX2luOwoJdTMyIGRwaTBfc2VsX2luX3JkbWExOwoJdTMyIGRzaTBfc2VsX2luOwoJdTMy
IGRzaTBfc2VsX2luX3JkbWExOwoKU2lnbmVkLW9mZi1ieTogWW9uZ3FpYW5nIE5pdSA8eW9uZ3Fp
YW5nLm5pdUBtZWRpYXRlay5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19k
cm1fY3J0Yy5jIHwgIDQgKysKIGRyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2RkcC5j
ICB8IDg2ICsrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJt
L21lZGlhdGVrL210a19kcm1fZGRwLmggIHwgIDUgKysKIGRyaXZlcnMvZ3B1L2RybS9tZWRpYXRl
ay9tdGtfZHJtX2Rydi5jICB8ICAzICsrCiBkcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2Ry
bV9kcnYuaCAgfCAgMyArKwogNSBmaWxlcyBjaGFuZ2VkLCA3NiBpbnNlcnRpb25zKCspLCAyNSBk
ZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2Ry
bV9jcnRjLmMgYi9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9jcnRjLmMKaW5kZXgg
YzFlODkxZS4uYzYzZmYyYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210
a19kcm1fY3J0Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2NydGMu
YwpAQCAtNDEsNiArNDEsNyBAQCBzdHJ1Y3QgbXRrX2RybV9jcnRjIHsKIAlib29sCQkJCXBlbmRp
bmdfcGxhbmVzOwogCiAJdm9pZCBfX2lvbWVtCQkJKmNvbmZpZ19yZWdzOworCWNvbnN0IHN0cnVj
dCBtdGtfbW1zeXNfcmVnX2RhdGEgKm1tc3lzX3JlZ19kYXRhOwogCXN0cnVjdCBtdGtfZGlzcF9t
dXRleAkJKm11dGV4OwogCXVuc2lnbmVkIGludAkJCWRkcF9jb21wX25yOwogCXN0cnVjdCBtdGtf
ZGRwX2NvbXAJCSoqZGRwX2NvbXA7CkBAIC0yNTgsNiArMjU5LDcgQEAgc3RhdGljIGludCBtdGtf
Y3J0Y19kZHBfaHdfaW5pdChzdHJ1Y3QgbXRrX2RybV9jcnRjICptdGtfY3J0YykKIAlEUk1fREVC
VUdfRFJJVkVSKCJtZWRpYXRla19kZHBfZGRwX3BhdGhfc2V0dXBcbiIpOwogCWZvciAoaSA9IDA7
IGkgPCBtdGtfY3J0Yy0+ZGRwX2NvbXBfbnIgLSAxOyBpKyspIHsKIAkJbXRrX2RkcF9hZGRfY29t
cF90b19wYXRoKG10a19jcnRjLT5jb25maWdfcmVncywKKwkJCQkJIG10a19jcnRjLT5tbXN5c19y
ZWdfZGF0YSwKIAkJCQkJIG10a19jcnRjLT5kZHBfY29tcFtpXS0+aWQsCiAJCQkJCSBtdGtfY3J0
Yy0+ZGRwX2NvbXBbaSArIDFdLT5pZCk7CiAJCW10a19kaXNwX211dGV4X2FkZF9jb21wKG10a19j
cnRjLT5tdXRleCwKQEAgLTMwNiw2ICszMDgsNyBAQCBzdGF0aWMgdm9pZCBtdGtfY3J0Y19kZHBf
aHdfZmluaShzdHJ1Y3QgbXRrX2RybV9jcnRjICptdGtfY3J0YykKIAltdGtfZGlzcF9tdXRleF9k
aXNhYmxlKG10a19jcnRjLT5tdXRleCk7CiAJZm9yIChpID0gMDsgaSA8IG10a19jcnRjLT5kZHBf
Y29tcF9uciAtIDE7IGkrKykgewogCQltdGtfZGRwX3JlbW92ZV9jb21wX2Zyb21fcGF0aChtdGtf
Y3J0Yy0+Y29uZmlnX3JlZ3MsCisJCQkJCSAgICAgIG10a19jcnRjLT5tbXN5c19yZWdfZGF0YSwK
IAkJCQkJICAgICAgbXRrX2NydGMtPmRkcF9jb21wW2ldLT5pZCwKIAkJCQkJICAgICAgbXRrX2Ny
dGMtPmRkcF9jb21wW2kgKyAxXS0+aWQpOwogCQltdGtfZGlzcF9tdXRleF9yZW1vdmVfY29tcCht
dGtfY3J0Yy0+bXV0ZXgsCkBAIC01MzcsNiArNTQwLDcgQEAgaW50IG10a19kcm1fY3J0Y19jcmVh
dGUoc3RydWN0IGRybV9kZXZpY2UgKmRybV9kZXYsCiAJCXJldHVybiAtRU5PTUVNOwogCiAJbXRr
X2NydGMtPmNvbmZpZ19yZWdzID0gcHJpdi0+Y29uZmlnX3JlZ3M7CisJbXRrX2NydGMtPm1tc3lz
X3JlZ19kYXRhID0gcHJpdi0+ZGF0YS0+cmVnX2RhdGE7CiAJbXRrX2NydGMtPmRkcF9jb21wX25y
ID0gcGF0aF9sZW47CiAJbXRrX2NydGMtPmRkcF9jb21wID0gZGV2bV9rbWFsbG9jX2FycmF5KGRl
diwgbXRrX2NydGMtPmRkcF9jb21wX25yLAogCQkJCQkJc2l6ZW9mKCptdGtfY3J0Yy0+ZGRwX2Nv
bXApLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fZGRwLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9kZHAuYwppbmRleCBjOTNlMWI3Li4z
MzhjYzJmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9kZHAu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9kZHAuYwpAQCAtMTY3LDYg
KzE2NywxNiBAQCBzdHJ1Y3QgbXRrX2RkcCB7CiAJY29uc3Qgc3RydWN0IG10a19kZHBfZGF0YQkq
ZGF0YTsKIH07CiAKK3N0cnVjdCBtdGtfbW1zeXNfcmVnX2RhdGEgeworCXUzMiBvdmwwX21vdXRf
ZW47CisJdTMyIHJkbWExX3NvdXRfc2VsX2luOworCXUzMiByZG1hMV9zb3V0X2RwaTA7CisJdTMy
IGRwaTBfc2VsX2luOworCXUzMiBkcGkwX3NlbF9pbl9yZG1hMTsKKwl1MzIgZHNpMF9zZWxfaW47
CisJdTMyIGRzaTBfc2VsX2luX3JkbWExOworfTsKKwogc3RhdGljIGNvbnN0IHVuc2lnbmVkIGlu
dCBtdDI3MDFfbXV0ZXhfbW9kW0REUF9DT01QT05FTlRfSURfTUFYXSA9IHsKIAlbRERQX0NPTVBP
TkVOVF9CTFNdID0gTVQyNzAxX01VVEVYX01PRF9ESVNQX0JMUywKIAlbRERQX0NPTVBPTkVOVF9D
T0xPUjBdID0gTVQyNzAxX01VVEVYX01PRF9ESVNQX0NPTE9SLApAQCAtMjQ1LDE3ICsyNTUsMzQg
QEAgc3RydWN0IG10a19kZHAgewogCS5tdXRleF9zb2ZfcmVnID0gTVQyNzAxX0RJU1BfTVVURVgw
X1NPRjAsCiB9OwogCi1zdGF0aWMgdW5zaWduZWQgaW50IG10a19kZHBfbW91dF9lbihlbnVtIG10
a19kZHBfY29tcF9pZCBjdXIsCitjb25zdCBzdHJ1Y3QgbXRrX21tc3lzX3JlZ19kYXRhIG10Mjcw
MV9tbXN5c19yZWdfZGF0YSA9IHsKKwkub3ZsMF9tb3V0X2VuID0gRElTUF9SRUdfQ09ORklHX0RJ
U1BfT1ZMX01PVVRfRU4sCisJLmRzaTBfc2VsX2luID0gRElTUF9SRUdfQ09ORklHX0RTSV9TRUws
CisJLmRzaTBfc2VsX2luX3JkbWExID0gRFNJX1NFTF9JTl9SRE1BLAorfTsKKworY29uc3Qgc3Ry
dWN0IG10a19tbXN5c19yZWdfZGF0YSBtdDgxNzNfbW1zeXNfcmVnX2RhdGEgPSB7CisJLm92bDBf
bW91dF9lbiA9IERJU1BfUkVHX0NPTkZJR19ESVNQX09WTDBfTU9VVF9FTiwKKwkucmRtYTFfc291
dF9zZWxfaW4gPSBESVNQX1JFR19DT05GSUdfRElTUF9SRE1BMV9TT1VUX0VOLAorCS5yZG1hMV9z
b3V0X2RwaTAgPSBSRE1BMV9TT1VUX0RQSTAsCisJLmRwaTBfc2VsX2luID0gRElTUF9SRUdfQ09O
RklHX0RQSV9TRUxfSU4sCisJLmRwaTBfc2VsX2luX3JkbWExID0gRFBJMF9TRUxfSU5fUkRNQTEs
CisJLmRzaTBfc2VsX2luID0gRElTUF9SRUdfQ09ORklHX0RTSUVfU0VMX0lOLAorCS5kc2kwX3Nl
bF9pbl9yZG1hMSA9IERTSTBfU0VMX0lOX1JETUExLAorfTsKKworc3RhdGljIHVuc2lnbmVkIGlu
dCBtdGtfZGRwX21vdXRfZW4oY29uc3Qgc3RydWN0IG10a19tbXN5c19yZWdfZGF0YSAqZGF0YSwK
KwkJCQkgICAgZW51bSBtdGtfZGRwX2NvbXBfaWQgY3VyLAogCQkJCSAgICBlbnVtIG10a19kZHBf
Y29tcF9pZCBuZXh0LAogCQkJCSAgICB1bnNpZ25lZCBpbnQgKmFkZHIpCiB7CiAJdW5zaWduZWQg
aW50IHZhbHVlOwogCiAJaWYgKGN1ciA9PSBERFBfQ09NUE9ORU5UX09WTDAgJiYgbmV4dCA9PSBE
RFBfQ09NUE9ORU5UX0NPTE9SMCkgewotCQkqYWRkciA9IERJU1BfUkVHX0NPTkZJR19ESVNQX09W
TDBfTU9VVF9FTjsKKwkJKmFkZHIgPSBkYXRhLT5vdmwwX21vdXRfZW47CiAJCXZhbHVlID0gT1ZM
MF9NT1VUX0VOX0NPTE9SMDsKIAl9IGVsc2UgaWYgKGN1ciA9PSBERFBfQ09NUE9ORU5UX09WTDAg
JiYgbmV4dCA9PSBERFBfQ09NUE9ORU5UX1JETUEwKSB7Ci0JCSphZGRyID0gRElTUF9SRUdfQ09O
RklHX0RJU1BfT1ZMX01PVVRfRU47CisJCSphZGRyID0gZGF0YS0+b3ZsMF9tb3V0X2VuOwogCQl2
YWx1ZSA9IE9WTF9NT1VUX0VOX1JETUE7CiAJfSBlbHNlIGlmIChjdXIgPT0gRERQX0NPTVBPTkVO
VF9PRDAgJiYgbmV4dCA9PSBERFBfQ09NUE9ORU5UX1JETUEwKSB7CiAJCSphZGRyID0gRElTUF9S
RUdfQ09ORklHX0RJU1BfT0RfTU9VVF9FTjsKQEAgLTI5Nyw4ICszMjQsOCBAQCBzdGF0aWMgdW5z
aWduZWQgaW50IG10a19kZHBfbW91dF9lbihlbnVtIG10a19kZHBfY29tcF9pZCBjdXIsCiAJCSph
ZGRyID0gRElTUF9SRUdfQ09ORklHX0RJU1BfUkRNQTFfU09VVF9FTjsKIAkJdmFsdWUgPSBSRE1B
MV9TT1VUX0RTSTM7CiAJfSBlbHNlIGlmIChjdXIgPT0gRERQX0NPTVBPTkVOVF9SRE1BMSAmJiBu
ZXh0ID09IEREUF9DT01QT05FTlRfRFBJMCkgewotCQkqYWRkciA9IERJU1BfUkVHX0NPTkZJR19E
SVNQX1JETUExX1NPVVRfRU47Ci0JCXZhbHVlID0gUkRNQTFfU09VVF9EUEkwOworCQkqYWRkciA9
IGRhdGEtPnJkbWExX3NvdXRfc2VsX2luOworCQl2YWx1ZSA9IGRhdGEtPnJkbWExX3NvdXRfZHBp
MDsKIAl9IGVsc2UgaWYgKGN1ciA9PSBERFBfQ09NUE9ORU5UX1JETUExICYmIG5leHQgPT0gRERQ
X0NPTVBPTkVOVF9EUEkxKSB7CiAJCSphZGRyID0gRElTUF9SRUdfQ09ORklHX0RJU1BfUkRNQTFf
U09VVF9FTjsKIAkJdmFsdWUgPSBSRE1BMV9TT1VUX0RQSTE7CkBAIC0zMjQsNyArMzUxLDggQEAg
c3RhdGljIHVuc2lnbmVkIGludCBtdGtfZGRwX21vdXRfZW4oZW51bSBtdGtfZGRwX2NvbXBfaWQg
Y3VyLAogCXJldHVybiB2YWx1ZTsKIH0KIAotc3RhdGljIHVuc2lnbmVkIGludCBtdGtfZGRwX3Nl
bF9pbihlbnVtIG10a19kZHBfY29tcF9pZCBjdXIsCitzdGF0aWMgdW5zaWduZWQgaW50IG10a19k
ZHBfc2VsX2luKGNvbnN0IHN0cnVjdCBtdGtfbW1zeXNfcmVnX2RhdGEgKmRhdGEsCisJCQkJICAg
ZW51bSBtdGtfZGRwX2NvbXBfaWQgY3VyLAogCQkJCSAgIGVudW0gbXRrX2RkcF9jb21wX2lkIG5l
eHQsCiAJCQkJICAgdW5zaWduZWQgaW50ICphZGRyKQogewpAQCAtMzM0LDE0ICszNjIsMTQgQEAg
c3RhdGljIHVuc2lnbmVkIGludCBtdGtfZGRwX3NlbF9pbihlbnVtIG10a19kZHBfY29tcF9pZCBj
dXIsCiAJCSphZGRyID0gRElTUF9SRUdfQ09ORklHX0RJU1BfQ09MT1IwX1NFTF9JTjsKIAkJdmFs
dWUgPSBDT0xPUjBfU0VMX0lOX09WTDA7CiAJfSBlbHNlIGlmIChjdXIgPT0gRERQX0NPTVBPTkVO
VF9SRE1BMSAmJiBuZXh0ID09IEREUF9DT01QT05FTlRfRFBJMCkgewotCQkqYWRkciA9IERJU1Bf
UkVHX0NPTkZJR19EUElfU0VMX0lOOwotCQl2YWx1ZSA9IERQSTBfU0VMX0lOX1JETUExOworCQkq
YWRkciA9IGRhdGEtPmRwaTBfc2VsX2luOworCQl2YWx1ZSA9IGRhdGEtPmRwaTBfc2VsX2luX3Jk
bWExOwogCX0gZWxzZSBpZiAoY3VyID09IEREUF9DT01QT05FTlRfUkRNQTEgJiYgbmV4dCA9PSBE
RFBfQ09NUE9ORU5UX0RQSTEpIHsKIAkJKmFkZHIgPSBESVNQX1JFR19DT05GSUdfRFBJX1NFTF9J
TjsKIAkJdmFsdWUgPSBEUEkxX1NFTF9JTl9SRE1BMTsKIAl9IGVsc2UgaWYgKGN1ciA9PSBERFBf
Q09NUE9ORU5UX1JETUExICYmIG5leHQgPT0gRERQX0NPTVBPTkVOVF9EU0kwKSB7Ci0JCSphZGRy
ID0gRElTUF9SRUdfQ09ORklHX0RTSUVfU0VMX0lOOwotCQl2YWx1ZSA9IERTSTBfU0VMX0lOX1JE
TUExOworCQkqYWRkciA9IGRhdGEtPmRzaTBfc2VsX2luOworCQl2YWx1ZSA9IGRhdGEtPmRzaTBf
c2VsX2luX3JkbWExOwogCX0gZWxzZSBpZiAoY3VyID09IEREUF9DT01QT05FTlRfUkRNQTEgJiYg
bmV4dCA9PSBERFBfQ09NUE9ORU5UX0RTSTEpIHsKIAkJKmFkZHIgPSBESVNQX1JFR19DT05GSUdf
RFNJT19TRUxfSU47CiAJCXZhbHVlID0gRFNJMV9TRUxfSU5fUkRNQTE7CkBAIC0zODIsMzcgKzQx
MCw0NCBAQCBzdGF0aWMgdW5zaWduZWQgaW50IG10a19kZHBfc2VsX2luKGVudW0gbXRrX2RkcF9j
b21wX2lkIGN1ciwKIAlyZXR1cm4gdmFsdWU7CiB9CiAKLXN0YXRpYyB2b2lkIG10a19kZHBfc291
dF9zZWwodm9pZCBfX2lvbWVtICpjb25maWdfcmVncywKLQkJCSAgICAgZW51bSBtdGtfZGRwX2Nv
bXBfaWQgY3VyLAotCQkJICAgICBlbnVtIG10a19kZHBfY29tcF9pZCBuZXh0KQorc3RhdGljIHVu
c2lnbmVkIGludCBtdGtfZGRwX3NvdXRfc2VsKGNvbnN0IHN0cnVjdCBtdGtfbW1zeXNfcmVnX2Rh
dGEgKmRhdGEsCisJCQkJICAgICBlbnVtIG10a19kZHBfY29tcF9pZCBjdXIsCisJCQkJICAgICBl
bnVtIG10a19kZHBfY29tcF9pZCBuZXh0LAorCQkJCSAgICAgdW5zaWduZWQgaW50ICphZGRyKQog
eworCXVuc2lnbmVkIGludCB2YWx1ZTsKKwogCWlmIChjdXIgPT0gRERQX0NPTVBPTkVOVF9CTFMg
JiYgbmV4dCA9PSBERFBfQ09NUE9ORU5UX0RTSTApIHsKLQkJd3JpdGVsX3JlbGF4ZWQoQkxTX1RP
X0RTSV9SRE1BMV9UT19EUEkxLAotCQkJICAgICAgIGNvbmZpZ19yZWdzICsgRElTUF9SRUdfQ09O
RklHX09VVF9TRUwpOworCQkqYWRkciA9IERJU1BfUkVHX0NPTkZJR19PVVRfU0VMOworCQl2YWx1
ZSA9IEJMU19UT19EU0lfUkRNQTFfVE9fRFBJMTsKIAl9IGVsc2UgaWYgKGN1ciA9PSBERFBfQ09N
UE9ORU5UX0JMUyAmJiBuZXh0ID09IEREUF9DT01QT05FTlRfRFBJMCkgewotCQl3cml0ZWxfcmVs
YXhlZChCTFNfVE9fRFBJX1JETUExX1RPX0RTSSwKLQkJCSAgICAgICBjb25maWdfcmVncyArIERJ
U1BfUkVHX0NPTkZJR19PVVRfU0VMKTsKLQl9IGVsc2UgaWYgKGN1ciA9PSBERFBfQ09NUE9ORU5U
X1JETUExICYmIG5leHQgPT0gRERQX0NPTVBPTkVOVF9EU0kwKSB7Ci0JCXdyaXRlbF9yZWxheGVk
KERTSV9TRUxfSU5fUkRNQSwKLQkJCSAgICAgICBjb25maWdfcmVncyArIERJU1BfUkVHX0NPTkZJ
R19EU0lfU0VMKTsKKwkJKmFkZHIgPSBESVNQX1JFR19DT05GSUdfT1VUX1NFTDsKKwkJdmFsdWUg
PSBCTFNfVE9fRFBJX1JETUExX1RPX0RTSTsKKwl9IGVsc2UgeworCQl2YWx1ZSA9IDA7CiAJfQor
CisJcmV0dXJuIHZhbHVlOwogfQogCiB2b2lkIG10a19kZHBfYWRkX2NvbXBfdG9fcGF0aCh2b2lk
IF9faW9tZW0gKmNvbmZpZ19yZWdzLAorCQkJICAgICAgY29uc3Qgc3RydWN0IG10a19tbXN5c19y
ZWdfZGF0YSAqcmVnX2RhdGEsCiAJCQkgICAgICBlbnVtIG10a19kZHBfY29tcF9pZCBjdXIsCiAJ
CQkgICAgICBlbnVtIG10a19kZHBfY29tcF9pZCBuZXh0KQogewogCXVuc2lnbmVkIGludCBhZGRy
LCB2YWx1ZSwgcmVnOwogCi0JdmFsdWUgPSBtdGtfZGRwX21vdXRfZW4oY3VyLCBuZXh0LCAmYWRk
cik7CisJdmFsdWUgPSBtdGtfZGRwX21vdXRfZW4ocmVnX2RhdGEsIGN1ciwgbmV4dCwgJmFkZHIp
OwogCWlmICh2YWx1ZSkgewogCQlyZWcgPSByZWFkbF9yZWxheGVkKGNvbmZpZ19yZWdzICsgYWRk
cikgfCB2YWx1ZTsKIAkJd3JpdGVsX3JlbGF4ZWQocmVnLCBjb25maWdfcmVncyArIGFkZHIpOwog
CX0KIAotCW10a19kZHBfc291dF9zZWwoY29uZmlnX3JlZ3MsIGN1ciwgbmV4dCk7CisJdmFsdWUg
PSBtdGtfZGRwX3NvdXRfc2VsKHJlZ19kYXRhLCBjdXIsIG5leHQsICZhZGRyKTsKKwlpZiAodmFs
dWUpCisJCXdyaXRlbF9yZWxheGVkKHZhbHVlLCBjb25maWdfcmVncyArIGFkZHIpOwogCi0JdmFs
dWUgPSBtdGtfZGRwX3NlbF9pbihjdXIsIG5leHQsICZhZGRyKTsKKwl2YWx1ZSA9IG10a19kZHBf
c2VsX2luKHJlZ19kYXRhLCBjdXIsIG5leHQsICZhZGRyKTsKIAlpZiAodmFsdWUpIHsKIAkJcmVn
ID0gcmVhZGxfcmVsYXhlZChjb25maWdfcmVncyArIGFkZHIpIHwgdmFsdWU7CiAJCXdyaXRlbF9y
ZWxheGVkKHJlZywgY29uZmlnX3JlZ3MgKyBhZGRyKTsKQEAgLTQyMCwxOCArNDU1LDE5IEBAIHZv
aWQgbXRrX2RkcF9hZGRfY29tcF90b19wYXRoKHZvaWQgX19pb21lbSAqY29uZmlnX3JlZ3MsCiB9
CiAKIHZvaWQgbXRrX2RkcF9yZW1vdmVfY29tcF9mcm9tX3BhdGgodm9pZCBfX2lvbWVtICpjb25m
aWdfcmVncywKKwkJCQkgICBjb25zdCBzdHJ1Y3QgbXRrX21tc3lzX3JlZ19kYXRhICpyZWdfZGF0
YSwKIAkJCQkgICBlbnVtIG10a19kZHBfY29tcF9pZCBjdXIsCiAJCQkJICAgZW51bSBtdGtfZGRw
X2NvbXBfaWQgbmV4dCkKIHsKIAl1bnNpZ25lZCBpbnQgYWRkciwgdmFsdWUsIHJlZzsKIAotCXZh
bHVlID0gbXRrX2RkcF9tb3V0X2VuKGN1ciwgbmV4dCwgJmFkZHIpOworCXZhbHVlID0gbXRrX2Rk
cF9tb3V0X2VuKHJlZ19kYXRhLCBjdXIsIG5leHQsICZhZGRyKTsKIAlpZiAodmFsdWUpIHsKIAkJ
cmVnID0gcmVhZGxfcmVsYXhlZChjb25maWdfcmVncyArIGFkZHIpICYgfnZhbHVlOwogCQl3cml0
ZWxfcmVsYXhlZChyZWcsIGNvbmZpZ19yZWdzICsgYWRkcik7CiAJfQogCi0JdmFsdWUgPSBtdGtf
ZGRwX3NlbF9pbihjdXIsIG5leHQsICZhZGRyKTsKKwl2YWx1ZSA9IG10a19kZHBfc2VsX2luKHJl
Z19kYXRhLCBjdXIsIG5leHQsICZhZGRyKTsKIAlpZiAodmFsdWUpIHsKIAkJcmVnID0gcmVhZGxf
cmVsYXhlZChjb25maWdfcmVncyArIGFkZHIpICYgfnZhbHVlOwogCQl3cml0ZWxfcmVsYXhlZChy
ZWcsIGNvbmZpZ19yZWdzICsgYWRkcik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbWVk
aWF0ZWsvbXRrX2RybV9kZHAuaCBiL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2Rk
cC5oCmluZGV4IDgyN2JlNDIuLmM1NWNjNjMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9t
ZWRpYXRlay9tdGtfZHJtX2RkcC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtf
ZHJtX2RkcC5oCkBAIC0xMSwxMSArMTEsMTYgQEAKIHN0cnVjdCByZWdtYXA7CiBzdHJ1Y3QgZGV2
aWNlOwogc3RydWN0IG10a19kaXNwX211dGV4Oworc3RydWN0IG10a19tbXN5c19yZWdfZGF0YTsK
IAorZXh0ZXJuIGNvbnN0IHN0cnVjdCBtdGtfbW1zeXNfcmVnX2RhdGEgbXQyNzAxX21tc3lzX3Jl
Z19kYXRhOworZXh0ZXJuIGNvbnN0IHN0cnVjdCBtdGtfbW1zeXNfcmVnX2RhdGEgbXQ4MTczX21t
c3lzX3JlZ19kYXRhOwogdm9pZCBtdGtfZGRwX2FkZF9jb21wX3RvX3BhdGgodm9pZCBfX2lvbWVt
ICpjb25maWdfcmVncywKKwkJCSAgICAgIGNvbnN0IHN0cnVjdCBtdGtfbW1zeXNfcmVnX2RhdGEg
KnJlZ19kYXRhLAogCQkJICAgICAgZW51bSBtdGtfZGRwX2NvbXBfaWQgY3VyLAogCQkJICAgICAg
ZW51bSBtdGtfZGRwX2NvbXBfaWQgbmV4dCk7CiB2b2lkIG10a19kZHBfcmVtb3ZlX2NvbXBfZnJv
bV9wYXRoKHZvaWQgX19pb21lbSAqY29uZmlnX3JlZ3MsCisJCQkJICAgY29uc3Qgc3RydWN0IG10
a19tbXN5c19yZWdfZGF0YSAqcmVnX2RhdGEsCiAJCQkJICAgZW51bSBtdGtfZGRwX2NvbXBfaWQg
Y3VyLAogCQkJCSAgIGVudW0gbXRrX2RkcF9jb21wX2lkIG5leHQpOwogCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9kcnYuYyBiL2RyaXZlcnMvZ3B1L2RybS9t
ZWRpYXRlay9tdGtfZHJtX2Rydi5jCmluZGV4IDk1ZmRiZDAuLjI0NzFjZTkgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2Rydi5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9tZWRpYXRlay9tdGtfZHJtX2Rydi5jCkBAIC0xODksNiArMTg5LDcgQEAgc3RhdGljIGlu
dCBtdGtfYXRvbWljX2NvbW1pdChzdHJ1Y3QgZHJtX2RldmljZSAqZHJtLAogCS5tYWluX2xlbiA9
IEFSUkFZX1NJWkUobXQyNzAxX210a19kZHBfbWFpbiksCiAJLmV4dF9wYXRoID0gbXQyNzAxX210
a19kZHBfZXh0LAogCS5leHRfbGVuID0gQVJSQVlfU0laRShtdDI3MDFfbXRrX2RkcF9leHQpLAor
CS5yZWdfZGF0YSA9ICZtdDI3MDFfbW1zeXNfcmVnX2RhdGEsCiAJLnNoYWRvd19yZWdpc3RlciA9
IHRydWUsCiB9OwogCkBAIC0xOTksNiArMjAwLDcgQEAgc3RhdGljIGludCBtdGtfYXRvbWljX2Nv
bW1pdChzdHJ1Y3QgZHJtX2RldmljZSAqZHJtLAogCS5leHRfbGVuID0gQVJSQVlfU0laRShtdDI3
MTJfbXRrX2RkcF9leHQpLAogCS50aGlyZF9wYXRoID0gbXQyNzEyX210a19kZHBfdGhpcmQsCiAJ
LnRoaXJkX2xlbiA9IEFSUkFZX1NJWkUobXQyNzEyX210a19kZHBfdGhpcmQpLAorCS5yZWdfZGF0
YSA9ICZtdDgxNzNfbW1zeXNfcmVnX2RhdGEsCiB9OwogCiBzdGF0aWMgY29uc3Qgc3RydWN0IG10
a19tbXN5c19kcml2ZXJfZGF0YSBtdDgxNzNfbW1zeXNfZHJpdmVyX2RhdGEgPSB7CkBAIC0yMDYs
NiArMjA4LDcgQEAgc3RhdGljIGludCBtdGtfYXRvbWljX2NvbW1pdChzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZHJtLAogCS5tYWluX2xlbiA9IEFSUkFZX1NJWkUobXQ4MTczX210a19kZHBfbWFpbiksCiAJ
LmV4dF9wYXRoID0gbXQ4MTczX210a19kZHBfZXh0LAogCS5leHRfbGVuID0gQVJSQVlfU0laRSht
dDgxNzNfbXRrX2RkcF9leHQpLAorCS5yZWdfZGF0YSA9ICZtdDgxNzNfbW1zeXNfcmVnX2RhdGEs
CiB9OwogCiBzdGF0aWMgaW50IG10a19kcm1fa21zX2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRy
bSkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2Rydi5oIGIv
ZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fZHJ2LmgKaW5kZXggNTk4ZmYzZS4uODIz
YmE0MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fZHJ2LmgK
KysrIGIvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fZHJ2LmgKQEAgLTcsNiArNyw3
IEBACiAjZGVmaW5lIE1US19EUk1fRFJWX0gKIAogI2luY2x1ZGUgPGxpbnV4L2lvLmg+CisjaW5j
bHVkZSAibXRrX2RybV9kZHAuaCIKICNpbmNsdWRlICJtdGtfZHJtX2RkcF9jb21wLmgiCiAKICNk
ZWZpbmUgTUFYX0NSVEMJMwpAQCAtMjgsNiArMjksOCBAQCBzdHJ1Y3QgbXRrX21tc3lzX2RyaXZl
cl9kYXRhIHsKIAljb25zdCBlbnVtIG10a19kZHBfY29tcF9pZCAqdGhpcmRfcGF0aDsKIAl1bnNp
Z25lZCBpbnQgdGhpcmRfbGVuOwogCisJY29uc3Qgc3RydWN0IG10a19tbXN5c19yZWdfZGF0YSAq
cmVnX2RhdGE7CisKIAlib29sIHNoYWRvd19yZWdpc3RlcjsKIH07CiAKLS0gCjEuOC4xLjEuZGly
dHkKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1k
ZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczov
L2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
