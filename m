Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id A1043C02F5
	for <lists+dri-devel@lfdr.de>; Fri, 27 Sep 2019 12:08:06 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 03AFE6EEFA;
	Fri, 27 Sep 2019 10:07:59 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from relay1-d.mail.gandi.net (relay1-d.mail.gandi.net
 [217.70.183.193])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 46EB86EED9
 for <dri-devel@lists.freedesktop.org>; Fri, 27 Sep 2019 10:07:57 +0000 (UTC)
X-Originating-IP: 86.250.200.211
Received: from localhost.localdomain (lfbn-1-17395-211.w86-250.abo.wanadoo.fr
 [86.250.200.211])
 (Authenticated sender: paul.kocialkowski@bootlin.com)
 by relay1-d.mail.gandi.net (Postfix) with ESMTPSA id B0916240011;
 Fri, 27 Sep 2019 10:07:54 +0000 (UTC)
From: Paul Kocialkowski <paul.kocialkowski@bootlin.com>
To: dri-devel@lists.freedesktop.org, devicetree@vger.kernel.org,
 linux-kernel@vger.kernel.org
Subject: [PATCH v3 2/2] drm: Add support for the LogiCVC display controller
Date: Fri, 27 Sep 2019 12:07:38 +0200
Message-Id: <20190927100738.1863563-3-paul.kocialkowski@bootlin.com>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190927100738.1863563-1-paul.kocialkowski@bootlin.com>
References: <20190927100738.1863563-1-paul.kocialkowski@bootlin.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Mark Rutland <mark.rutland@arm.com>,
 Thomas Petazzoni <thomas.petazzoni@bootlin.com>,
 David Airlie <airlied@linux.ie>, Maxime Ripard <mripard@kernel.org>,
 Paul Kocialkowski <paul.kocialkowski@bootlin.com>,
 Rob Herring <robh+dt@kernel.org>, Sean Paul <sean@poorly.run>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW50cm9kdWNlcyBhIGRyaXZlciBmb3IgdGhlIExvZ2lDVkMgZGlzcGxheSBjb250cm9sbGVyLCBh
IHByb2dyYW1tYWJsZQpsb2dpYyBjb250cm9sbGVyIG9wdGltaXplZCBmb3IgdXNlIGluIFhpbGlu
eCBaeW5xLTcwMDAgU29DcyBhbmQgb3RoZXIKWGlsaW54IEZQR0FzLiBUaGUgY29udHJvbGxlciBp
cyBtb3N0bHkgY29uZmlndXJlZCBhdCBsb2dpYyBzeW50aGVzaXMKdGltZSBzbyBvbmx5IGEgc3Vi
c2V0IG9mIGNvbmZpZ3VyYXRpb24gaXMgbGVmdCBmb3IgdGhlIGRyaXZlciB0bwpoYW5kbGUuCgpU
aGUgZm9sbG93aW5nIGZlYXR1cmVzIGFyZSBpbXBsZW1lbnRlZCBhbmQgdGVzdGVkOgotIExWRFMg
NC1iaXQgaW50ZXJmYWNlOwotIFJHQjU2NSBwaXhlbCBmb3JtYXRzOwotIE11bHRpcGxlIGxheWVy
cyBhbmQgaGFyZHdhcmUgY29tcG9zaXRpb247Ci0gTGF5ZXItd2lkZSBhbHBoYSBtb2RlOwoKVGhl
IGZvbGxvd2luZyBmZWF0dXJlcyBhcmUgaW1wbGVtZW50ZWQgYnV0IHVudGVzdGVkOgotIE90aGVy
IFJHQiBwaXhlbCBmb3JtYXRzOwotIExheWVyIGZyYW1lYnVmZmVyIGNvbmZpZ3VyYXRpb24gZm9y
IHZlcnNpb24gNDsKLSBMb3dlc3QtbGF5ZXIgdXNlZCBhcyBiYWNrZ3JvdW5kIGNvbG9yOwotIFBl
ci1waXhlbCBhbHBoYSBtb2RlLgoKVGhlIGZvbGxvd2luZyBmZWF0dXJlcyBhcmUgbm90IGltcGxl
bWVudGVkOgotIFlVViBwaXhlbCBmb3JtYXRzOwotIERWSSwgTFZEUyAzLWJpdCwgSVRVNjU2IGFu
ZCBjYW1lcmEgbGluayBpbnRlcmZhY2VzOwotIEV4dGVybmFsIHBhcmFsbGVsIGlucHV0IGZvciBs
YXllcjsKLSBDb2xvci1rZXlpbmc7Ci0gTFVULWJhc2VkIGFscGhhIG1vZGVzLgoKQWRkaXRpb25h
bCBpbXBsZW1lbnRhdGlvbi1zcGVjaWZpYyBub3RlczoKLSBQYW5lbHMgYXJlIG9ubHkgZW5hYmxl
ZCBhZnRlciB0aGUgZmlyc3QgcGFnZSBmbGlwIHRvIGF2b2lkIGZsYXNoaW5nIGEKICB3aGl0ZSBz
Y3JlZW4uCi0gRGVwdGggdXNlZCBpbiBjb250ZXh0IG9mIHRoZSBMb2dpQ1ZDIGRyaXZlciBvbmx5
IGNvdW50cyBjb2xvciBjb21wb25lbnRzCiAgdG8gbWF0Y2ggdGhlIGRlZmluaXRpb24gb2YgdGhl
IHN5bnRoZXNpcyBwYXJhbWV0ZXJzLgoKU3VwcG9ydCBpcyBpbXBsZW1lbnRlZCBmb3IgYm90aCB2
ZXJzaW9uIDMgYW5kIDQgb2YgdGhlIGNvbnRyb2xsZXIuCgpXaXRoIHZlcnNpb24gMywgZnJhbWVi
dWZmZXJzIGFyZSBzdG9yZWQgaW4gYSBkZWRpY2F0ZWQgY29udGlndW91cwptZW1vcnkgYXJlYSwg
d2l0aCBhIGJhc2UgYWRkcmVzcyBoYXJkY29kZWQgZm9yIGVhY2ggbGF5ZXIuIFRoaXMgcmVxdWly
ZXMKdXNpbmcgYSBkZWRpY2F0ZWQgQ01BIHBvb2wgcmVnaXN0ZXJlZCBhdCB0aGUgYmFzZSBhZGRy
ZXNzIGFuZCB0d2Vha2luZyBhCmZldyBvZmZzZXQtcmVsYXRlZCByZWdpc3RlcnMgdG8gdHJ5IHRv
IHVzZSBhbnkgYnVmZmVyIGFsbG9jYXRlZCBmcm9tCnRoZSBwb29sLiBUaGlzIGlzIGRvbmUgb24g
YSBiZXN0LWVmZm9ydCBiYXNpcyB0byBoYXZlIHRoZSBoYXJkd2FyZSBjb3BlCndpdGggdGhlIERS
TSBmcmFtZWJ1ZmZlciBhbGxvY2F0aW9uIG1vZGVsIGFuZCB0aGVyZSBpcyBubyBndWFyYW50ZWUK
dGhhdCBlYWNoIGJ1ZmZlciBhbGxvY2F0ZWQgYnkgR0VNIENNQSBjYW4gYmUgdXNlZCBmb3IgYW55
IGxheWVyLgpJbiBwYXJ0aWN1bGFyLCBidWZmZXJzIGFsbG9jYXRlZCBiZWxvdyB0aGUgYmFzZSBh
ZGRyZXNzIGZvciBhIGxheWVyIGFyZQpndWFyYW50ZWVkIG5vdCB0byBiZSBjb25maWd1cmFibGUg
Zm9yIHRoYXQgbGF5ZXIuIFNlZSB0aGUgaW1wbGVtZW50YXRpb24gb2YKbG9naWN2Y19sYXllcl9i
dWZmZXJfZmluZF9zZXR1cCBmb3Igc3BlY2lmaWNzLgoKVmVyc2lvbiA0IGFsbG93cyBjb25maWd1
cmluZyBlYWNoIGJ1ZmZlciBhZGRyZXNzIGRpcmVjdGx5LCB3aGljaApndWFyYW50ZWVzIHRoYXQg
YW55IGJ1ZmZlciBjYW4gYmUgY29uZmlndXJlZC4KClNpZ25lZC1vZmYtYnk6IFBhdWwgS29jaWFs
a293c2tpIDxwYXVsLmtvY2lhbGtvd3NraUBib290bGluLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9k
cm0vS2NvbmZpZyAgICAgICAgICAgICAgICAgICAgIHwgICAyICsKIGRyaXZlcnMvZ3B1L2RybS9N
YWtlZmlsZSAgICAgICAgICAgICAgICAgICAgfCAgIDEgKwogZHJpdmVycy9ncHUvZHJtL2xvZ2lj
dmMvS2NvbmZpZyAgICAgICAgICAgICB8ICAgOCArCiBkcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9N
YWtlZmlsZSAgICAgICAgICAgIHwgICA0ICsKIGRyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2lj
dmNfY3J0Yy5jICAgICAgfCAyNzIgKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9s
b2dpY3ZjX2NydGMuaCAgICAgIHwgIDI1ICsKIGRyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2lj
dmNfZHJtLmMgICAgICAgfCA0NjcgKysrKysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vbG9n
aWN2Yy9sb2dpY3ZjX2RybS5oICAgICAgIHwgIDYwICsrCiBkcml2ZXJzL2dwdS9kcm0vbG9naWN2
Yy9sb2dpY3ZjX2ludGVyZmFjZS5jIHwgMjM1ICsrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vbG9n
aWN2Yy9sb2dpY3ZjX2ludGVyZmFjZS5oIHwgIDMyICsrCiBkcml2ZXJzL2dwdS9kcm0vbG9naWN2
Yy9sb2dpY3ZjX2xheWVyLmMgICAgIHwgNTk0ICsrKysrKysrKysrKysrKysrKysrCiBkcml2ZXJz
L2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2xheWVyLmggICAgIHwgIDY1ICsrKwogZHJpdmVycy9n
cHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19tb2RlLmMgICAgICB8IDEwMyArKysrCiBkcml2ZXJzL2dw
dS9kcm0vbG9naWN2Yy9sb2dpY3ZjX21vZGUuaCAgICAgIHwgIDE1ICsKIGRyaXZlcnMvZ3B1L2Ry
bS9sb2dpY3ZjL2xvZ2ljdmNfb2YuYyAgICAgICAgfCAyMDUgKysrKysrKwogZHJpdmVycy9ncHUv
ZHJtL2xvZ2ljdmMvbG9naWN2Y19vZi5oICAgICAgICB8ICAyOCArCiBkcml2ZXJzL2dwdS9kcm0v
bG9naWN2Yy9sb2dpY3ZjX3JlZ3MuaCAgICAgIHwgIDg4ICsrKwogMTcgZmlsZXMgY2hhbmdlZCwg
MjIwNCBpbnNlcnRpb25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xv
Z2ljdmMvS2NvbmZpZwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9sb2dpY3Zj
L01ha2VmaWxlCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9n
aWN2Y19jcnRjLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9s
b2dpY3ZjX2NydGMuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9sb2dpY3Zj
L2xvZ2ljdmNfZHJtLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9naWN2
Yy9sb2dpY3ZjX2RybS5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvZ2lj
dmMvbG9naWN2Y19pbnRlcmZhY2UuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2Ry
bS9sb2dpY3ZjL2xvZ2ljdmNfaW50ZXJmYWNlLmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJz
L2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2xheWVyLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2
ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2xheWVyLmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBk
cml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX21vZGUuYwogY3JlYXRlIG1vZGUgMTAwNjQ0
IGRyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfbW9kZS5oCiBjcmVhdGUgbW9kZSAxMDA2
NDQgZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19vZi5jCiBjcmVhdGUgbW9kZSAxMDA2
NDQgZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19vZi5oCiBjcmVhdGUgbW9kZSAxMDA2
NDQgZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19yZWdzLmgKCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vS2NvbmZpZyBiL2RyaXZlcnMvZ3B1L2RybS9LY29uZmlnCmluZGV4IGNk
MTFhM2JkZTE5Yy4uZjU1ZmM1OWViYWQ2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vS2Nv
bmZpZworKysgYi9kcml2ZXJzL2dwdS9kcm0vS2NvbmZpZwpAQCAtMzM4LDYgKzMzOCw4IEBAIHNv
dXJjZSAiZHJpdmVycy9ncHUvZHJtL2FyYy9LY29uZmlnIgogCiBzb3VyY2UgImRyaXZlcnMvZ3B1
L2RybS9oaXNpbGljb24vS2NvbmZpZyIKIAorc291cmNlICJkcml2ZXJzL2dwdS9kcm0vbG9naWN2
Yy9LY29uZmlnIgorCiBzb3VyY2UgImRyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9LY29uZmlnIgog
CiBzb3VyY2UgImRyaXZlcnMvZ3B1L2RybS96dGUvS2NvbmZpZyIKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9NYWtlZmlsZQppbmRleCBiMTQ3
Mjk2Mjg5OTMuLjAxYmYxM2Q2NDM5NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL01ha2Vm
aWxlCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9NYWtlZmlsZQpAQCAtMTAzLDYgKzEwMyw3IEBAIG9i
ai0kKENPTkZJR19EUk1fU1RNKSArPSBzdG0vCiBvYmotJChDT05GSUdfRFJNX1NUSSkgKz0gc3Rp
Lwogb2JqLSQoQ09ORklHX0RSTV9JTVgpICs9IGlteC8KIG9iai0kKENPTkZJR19EUk1fSU5HRU5J
QykgKz0gaW5nZW5pYy8KK29iai0kKENPTkZJR19EUk1fTE9HSUNWQykgKz0gbG9naWN2Yy8KIG9i
ai0kKENPTkZJR19EUk1fTUVESUFURUspICs9IG1lZGlhdGVrLwogb2JqLSQoQ09ORklHX0RSTV9N
RVNPTikJKz0gbWVzb24vCiBvYmoteQkJCSs9IGkyYy8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9sb2dpY3ZjL0tjb25maWcgYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9LY29uZmlnCm5l
dyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMzRkYWNhYmJiNDlhCi0tLSAv
ZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvS2NvbmZpZwpAQCAtMCwwICsx
LDggQEAKK2NvbmZpZyBEUk1fTE9HSUNWQworCXRyaXN0YXRlICJMb2dpQ1ZDIERSTSIKKwlkZXBl
bmRzIG9uIERSTQorCXNlbGVjdCBEUk1fS01TX0hFTFBFUgorCXNlbGVjdCBEUk1fS01TX0NNQV9I
RUxQRVIKKwlzZWxlY3QgRFJNX0dFTV9DTUFfSEVMUEVSCisJaGVscAorCSAgRFJNIGRpc3BsYXkg
ZHJpdmVyIGZvciB0aGUgbG9naUNWQyBwcm9ncmFtbWFibGUgbG9naWMgYmxvY2sgZnJvbSBYeWxv
bgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvTWFrZWZpbGUgYi9kcml2ZXJz
L2dwdS9kcm0vbG9naWN2Yy9NYWtlZmlsZQpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAw
MDAwMDAwMDAuLmMwOTUzMWZiZDZhZAotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9sb2dpY3ZjL01ha2VmaWxlCkBAIC0wLDAgKzEsNCBAQAorbG9naWN2Yy1kcm0teSArPSBsb2dp
Y3ZjX2NydGMubyBsb2dpY3ZjX2RybS5vIGxvZ2ljdmNfaW50ZXJmYWNlLm8gXAorCQkgbG9naWN2
Y19sYXllci5vIGxvZ2ljdmNfbW9kZS5vIGxvZ2ljdmNfb2YubworCitvYmotJChDT05GSUdfRFJN
X0xPR0lDVkMpICs9IGxvZ2ljdmMtZHJtLm8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9s
b2dpY3ZjL2xvZ2ljdmNfY3J0Yy5jIGIvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19j
cnRjLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5mMTNhYjYyZDE4
ZWYKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2Ny
dGMuYwpAQCAtMCwwICsxLDI3MiBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0y
LjArCisvKgorICogQ29weXJpZ2h0IChDKSAyMDE5IEJvb3RsaW4KKyAqIEF1dGhvcjogUGF1bCBL
b2NpYWxrb3dza2kgPHBhdWwua29jaWFsa293c2tpQGJvb3RsaW4uY29tPgorICovCisKKyNpbmNs
dWRlIDxsaW51eC9vZi5oPgorI2luY2x1ZGUgPGxpbnV4L29mX2dyYXBoLmg+CisjaW5jbHVkZSA8
bGludXgvdHlwZXMuaD4KKyNpbmNsdWRlIDxsaW51eC93b3JrcXVldWUuaD4KKyNpbmNsdWRlIDxk
cm0vZHJtX2F0b21pY19oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2NydGMuaD4KKyNpbmNs
dWRlIDxkcm0vZHJtX2Rydi5oPgorI2luY2x1ZGUgPGRybS9kcm1fZ2VtX2NtYV9oZWxwZXIuaD4K
KyNpbmNsdWRlIDxkcm0vZHJtX3ByaW50Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV92YmxhbmsuaD4K
KworI2luY2x1ZGUgImxvZ2ljdmNfY3J0Yy5oIgorI2luY2x1ZGUgImxvZ2ljdmNfZHJtLmgiCisj
aW5jbHVkZSAibG9naWN2Y19pbnRlcmZhY2UuaCIKKyNpbmNsdWRlICJsb2dpY3ZjX2xheWVyLmgi
CisjaW5jbHVkZSAibG9naWN2Y19yZWdzLmgiCisKKyNkZWZpbmUgbG9naWN2Y19jcnRjKGMpIFwK
Kwljb250YWluZXJfb2YoYywgc3RydWN0IGxvZ2ljdmNfY3J0YywgZHJtX2NydGMpCisKK3N0YXRp
YyBpbnQgbG9naWN2Y19jcnRjX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX2NydGMgKmRybV9jcnRj
LAorCQkJCSAgICAgc3RydWN0IGRybV9jcnRjX3N0YXRlICpzdGF0ZSkKK3sKKwlzdHJ1Y3QgZHJt
X2Rpc3BsYXlfbW9kZSAqbW9kZSA9ICZzdGF0ZS0+YWRqdXN0ZWRfbW9kZTsKKworCWlmIChtb2Rl
LT5mbGFncyAmIERSTV9NT0RFX0ZMQUdfSU5URVJMQUNFKQorCQlyZXR1cm4gLUVJTlZBTDsKKwor
CXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBsb2dpY3ZjX2NydGNfYXRvbWljX2JlZ2luKHN0
cnVjdCBkcm1fY3J0YyAqZHJtX2NydGMsCisJCQkJICAgICAgc3RydWN0IGRybV9jcnRjX3N0YXRl
ICpvbGRfc3RhdGUpCit7CisJc3RydWN0IGxvZ2ljdmNfY3J0YyAqY3J0YyA9IGxvZ2ljdmNfY3J0
Yyhkcm1fY3J0Yyk7CisJc3RydWN0IGRybV9kZXZpY2UgKmRybSA9IGRybV9jcnRjLT5kZXY7CisJ
dW5zaWduZWQgbG9uZyBmbGFnczsKKworCS8qIFJlZ2lzdGVyIHBlbmRpbmcgZXZlbnQsIG9ubHkg
aWYgdmJsYW5rIGlzIGFscmVhZHkgb24uICovCisJaWYgKGRybV9jcnRjLT5zdGF0ZS0+ZXZlbnQg
JiYgb2xkX3N0YXRlLT5hY3RpdmUpIHsKKwkJV0FSTl9PTihkcm1fY3J0Y192YmxhbmtfZ2V0KGRy
bV9jcnRjKSAhPSAwKTsKKworCQlzcGluX2xvY2tfaXJxc2F2ZSgmZHJtLT5ldmVudF9sb2NrLCBm
bGFncyk7CisJCWNydGMtPmV2ZW50ID0gZHJtX2NydGMtPnN0YXRlLT5ldmVudDsKKwkJc3Bpbl91
bmxvY2tfaXJxcmVzdG9yZSgmZHJtLT5ldmVudF9sb2NrLCBmbGFncyk7CisKKwkJZHJtX2NydGMt
PnN0YXRlLT5ldmVudCA9IE5VTEw7CisJfQorfQorCitzdGF0aWMgdm9pZCBsb2dpY3ZjX2NydGNf
YXRvbWljX2VuYWJsZShzdHJ1Y3QgZHJtX2NydGMgKmRybV9jcnRjLAorCQkJCSAgICAgICBzdHJ1
Y3QgZHJtX2NydGNfc3RhdGUgKm9sZF9zdGF0ZSkKK3sKKwlzdHJ1Y3QgbG9naWN2Y19jcnRjICpj
cnRjID0gbG9naWN2Y19jcnRjKGRybV9jcnRjKTsKKwlzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2lj
dmMgPSBjcnRjLT5sb2dpY3ZjOworCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlID0gJmRy
bV9jcnRjLT5zdGF0ZS0+YWRqdXN0ZWRfbW9kZTsKKwlzdHJ1Y3QgZHJtX2RldmljZSAqZHJtID0g
ZHJtX2NydGMtPmRldjsKKwl1bnNpZ25lZCBpbnQgaGFjdCwgaGZwLCBoc2wsIGhicDsKKwl1bnNp
Z25lZCBpbnQgdmFjdCwgdmZwLCB2c2wsIHZicDsKKwl1bnNpZ25lZCBsb25nIGZsYWdzOworCXUz
MiBjdHJsOworCisJLyogVGltaW5ncyAqLworCisJaGFjdCA9IG1vZGUtPmhkaXNwbGF5OworCWhm
cCA9IG1vZGUtPmhzeW5jX3N0YXJ0IC0gbW9kZS0+aGRpc3BsYXk7CisJaHNsID0gbW9kZS0+aHN5
bmNfZW5kIC0gbW9kZS0+aHN5bmNfc3RhcnQ7CisJaGJwID0gbW9kZS0+aHRvdGFsIC0gbW9kZS0+
aHN5bmNfZW5kOworCisJdmFjdCA9IG1vZGUtPnZkaXNwbGF5OworCXZmcCA9IG1vZGUtPnZzeW5j
X3N0YXJ0IC0gbW9kZS0+dmRpc3BsYXk7CisJdnNsID0gbW9kZS0+dnN5bmNfZW5kIC0gbW9kZS0+
dnN5bmNfc3RhcnQ7CisJdmJwID0gbW9kZS0+dnRvdGFsIC0gbW9kZS0+dnN5bmNfZW5kOworCisJ
cmVnbWFwX3dyaXRlKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNWQ19IU1lOQ19GUk9OVF9QT1JDSF9S
RUcsIGhmcCAtIDEpOworCXJlZ21hcF93cml0ZShsb2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNfSFNZ
TkNfUkVHLCBoc2wgLSAxKTsKKwlyZWdtYXBfd3JpdGUobG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZD
X0hTWU5DX0JBQ0tfUE9SQ0hfUkVHLCBoYnAgLSAxKTsKKwlyZWdtYXBfd3JpdGUobG9naWN2Yy0+
cmVnbWFwLCBMT0dJQ1ZDX0hSRVNfUkVHLCBoYWN0IC0gMSk7CisKKwlyZWdtYXBfd3JpdGUobG9n
aWN2Yy0+cmVnbWFwLCBMT0dJQ1ZDX1ZTWU5DX0ZST05UX1BPUkNIX1JFRywgdmZwIC0gMSk7CisJ
cmVnbWFwX3dyaXRlKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNWQ19WU1lOQ19SRUcsIHZzbCAtIDEp
OworCXJlZ21hcF93cml0ZShsb2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNfVlNZTkNfQkFDS19QT1JD
SF9SRUcsIHZicCAtIDEpOworCXJlZ21hcF93cml0ZShsb2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNf
VlJFU19SRUcsIHZhY3QgLSAxKTsKKworCS8qIFNpZ25hbHMgKi8KKworCWN0cmwgPSBMT0dJQ1ZD
X0NUUkxfSFNZTkNfRU5BQkxFIHwgTE9HSUNWQ19DVFJMX1ZTWU5DX0VOQUJMRSB8CisJICAgICAg
IExPR0lDVkNfQ1RSTF9ERV9FTkFCTEU7CisKKwlpZiAobW9kZS0+ZmxhZ3MgJiBEUk1fTU9ERV9G
TEFHX05IU1lOQykKKwkJY3RybCB8PSBMT0dJQ1ZDX0NUUkxfSFNZTkNfSU5WRVJUOworCisJaWYg
KG1vZGUtPmZsYWdzICYgRFJNX01PREVfRkxBR19OVlNZTkMpCisJCWN0cmwgfD0gTE9HSUNWQ19D
VFJMX1ZTWU5DX0lOVkVSVDsKKworCWlmIChsb2dpY3ZjLT5pbnRlcmZhY2UpIHsKKwkJc3RydWN0
IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciA9CisJCQkmbG9naWN2Yy0+aW50ZXJmYWNlLT5kcm1f
Y29ubmVjdG9yOworCQlzdHJ1Y3QgZHJtX2Rpc3BsYXlfaW5mbyAqZGlzcGxheV9pbmZvID0KKwkJ
CSZjb25uZWN0b3ItPmRpc3BsYXlfaW5mbzsKKworCQlpZiAoZGlzcGxheV9pbmZvLT5idXNfZmxh
Z3MgJiBEUk1fQlVTX0ZMQUdfREVfTE9XKQorCQkJY3RybCB8PSBMT0dJQ1ZDX0NUUkxfREVfSU5W
RVJUOworCisJCWlmIChkaXNwbGF5X2luZm8tPmJ1c19mbGFncyAmIERSTV9CVVNfRkxBR19QSVhE
QVRBX05FR0VER0UpCisJCQljdHJsIHw9IExPR0lDVkNfQ1RSTF9DTE9DS19JTlZFUlQ7CisJfQor
CisJcmVnbWFwX3VwZGF0ZV9iaXRzKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNWQ19DVFJMX1JFRywK
KwkJCSAgIExPR0lDVkNfQ1RSTF9IU1lOQ19FTkFCTEUgfAorCQkJICAgTE9HSUNWQ19DVFJMX0hT
WU5DX0lOVkVSVCB8CisJCQkgICBMT0dJQ1ZDX0NUUkxfVlNZTkNfRU5BQkxFIHwKKwkJCSAgIExP
R0lDVkNfQ1RSTF9WU1lOQ19JTlZFUlQgfAorCQkJICAgTE9HSUNWQ19DVFJMX0RFX0VOQUJMRSB8
CisJCQkgICBMT0dJQ1ZDX0NUUkxfREVfSU5WRVJUIHwKKwkJCSAgIExPR0lDVkNfQ1RSTF9QSVhF
TF9JTlZFUlQgfAorCQkJICAgTE9HSUNWQ19DVFJMX0NMT0NLX0lOVkVSVCwgY3RybCk7CisKKwkv
KiBHZW5lcmF0ZSBpbnRlcm5hbCBzdGF0ZSByZXNldC4gKi8KKwlyZWdtYXBfd3JpdGUobG9naWN2
Yy0+cmVnbWFwLCBMT0dJQ1ZDX0RUWVBFX1JFRywgMCk7CisKKwlkcm1fY3J0Y192Ymxhbmtfb24o
ZHJtX2NydGMpOworCisJLyogUmVnaXN0ZXIgb3VyIGV2ZW50IGFmdGVyIHZibGFuayBpcyBlbmFi
bGVkLiAqLworCWlmIChkcm1fY3J0Yy0+c3RhdGUtPmV2ZW50ICYmICFvbGRfc3RhdGUtPmFjdGl2
ZSkgeworCQlXQVJOX09OKGRybV9jcnRjX3ZibGFua19nZXQoZHJtX2NydGMpICE9IDApOworCisJ
CXNwaW5fbG9ja19pcnFzYXZlKCZkcm0tPmV2ZW50X2xvY2ssIGZsYWdzKTsKKwkJY3J0Yy0+ZXZl
bnQgPSBkcm1fY3J0Yy0+c3RhdGUtPmV2ZW50OworCQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZk
cm0tPmV2ZW50X2xvY2ssIGZsYWdzKTsKKworCQlkcm1fY3J0Yy0+c3RhdGUtPmV2ZW50ID0gTlVM
TDsKKwl9Cit9CisKK3N0YXRpYyB2b2lkIGxvZ2ljdmNfY3J0Y19hdG9taWNfZGlzYWJsZShzdHJ1
Y3QgZHJtX2NydGMgKmRybV9jcnRjLAorCQkJCQlzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKm9sZF9z
dGF0ZSkKK3sKKwlzdHJ1Y3QgbG9naWN2Y19jcnRjICpjcnRjID0gbG9naWN2Y19jcnRjKGRybV9j
cnRjKTsKKwlzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMgPSBjcnRjLT5sb2dpY3ZjOworCisJ
ZHJtX2NydGNfdmJsYW5rX29mZihkcm1fY3J0Yyk7CisKKwkvKiBEaXNhYmxlIGFuZCBjbGVhciBD
UlRDIGJpdHMuICovCisJcmVnbWFwX3VwZGF0ZV9iaXRzKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNW
Q19DVFJMX1JFRywKKwkJCSAgIExPR0lDVkNfQ1RSTF9IU1lOQ19FTkFCTEUgfAorCQkJICAgTE9H
SUNWQ19DVFJMX0hTWU5DX0lOVkVSVCB8CisJCQkgICBMT0dJQ1ZDX0NUUkxfVlNZTkNfRU5BQkxF
IHwKKwkJCSAgIExPR0lDVkNfQ1RSTF9WU1lOQ19JTlZFUlQgfAorCQkJICAgTE9HSUNWQ19DVFJM
X0RFX0VOQUJMRSB8CisJCQkgICBMT0dJQ1ZDX0NUUkxfREVfSU5WRVJUIHwKKwkJCSAgIExPR0lD
VkNfQ1RSTF9QSVhFTF9JTlZFUlQgfAorCQkJICAgTE9HSUNWQ19DVFJMX0NMT0NLX0lOVkVSVCwg
MCk7CisKKwkvKiBHZW5lcmF0ZSBpbnRlcm5hbCBzdGF0ZSByZXNldC4gKi8KKwlyZWdtYXBfd3Jp
dGUobG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZDX0RUWVBFX1JFRywgMCk7CisKKwkvKiBDb25zdW1l
IGxlZnRvdmVyIGV2ZW50IHNpbmNlIHZibGFuayBpcyBub3cgZGlzYWJsZWQuICovCisJaWYgKGRy
bV9jcnRjLT5zdGF0ZS0+ZXZlbnQgJiYgIWRybV9jcnRjLT5zdGF0ZS0+YWN0aXZlKSB7CisJCXNw
aW5fbG9ja19pcnEoJmRybV9jcnRjLT5kZXYtPmV2ZW50X2xvY2spOworCQlkcm1fY3J0Y19zZW5k
X3ZibGFua19ldmVudChkcm1fY3J0YywgZHJtX2NydGMtPnN0YXRlLT5ldmVudCk7CisJCXNwaW5f
dW5sb2NrX2lycSgmZHJtX2NydGMtPmRldi0+ZXZlbnRfbG9jayk7CisKKwkJZHJtX2NydGMtPnN0
YXRlLT5ldmVudCA9IE5VTEw7CisJfQorfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9jcnRj
X2hlbHBlcl9mdW5jcyBsb2dpY3ZjX2NydGNfaGVscGVyX2Z1bmNzID0geworCS5hdG9taWNfY2hl
Y2sJCT0gbG9naWN2Y19jcnRjX2F0b21pY19jaGVjaywKKwkuYXRvbWljX2JlZ2luCQk9IGxvZ2lj
dmNfY3J0Y19hdG9taWNfYmVnaW4sCisJLmF0b21pY19lbmFibGUJCT0gbG9naWN2Y19jcnRjX2F0
b21pY19lbmFibGUsCisJLmF0b21pY19kaXNhYmxlCQk9IGxvZ2ljdmNfY3J0Y19hdG9taWNfZGlz
YWJsZSwKK307CisKK3N0YXRpYyBpbnQgbG9naWN2Y19jcnRjX2VuYWJsZV92Ymxhbmsoc3RydWN0
IGRybV9jcnRjICpkcm1fY3J0YykKK3sKKwlzdHJ1Y3QgbG9naWN2Y19jcnRjICpjcnRjID0gbG9n
aWN2Y19jcnRjKGRybV9jcnRjKTsKKwlzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMgPSBjcnRj
LT5sb2dpY3ZjOworCisJLyogQ2xlYXIgYW55IHBlbmRpbmcgVl9TWU5DIGludGVycnVwdC4gKi8K
KwlyZWdtYXBfd3JpdGVfYml0cyhsb2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNfSU5UX1NUQVRfUkVH
LAorCQkJICBMT0dJQ1ZDX0lOVF9TVEFUX1ZfU1lOQywgTE9HSUNWQ19JTlRfU1RBVF9WX1NZTkMp
OworCisJLyogVW5tYXNrIFZfU1lOQyBpbnRlcnJ1cHQuICovCisJcmVnbWFwX3dyaXRlX2JpdHMo
bG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZDX0lOVF9NQVNLX1JFRywKKwkJCSAgTE9HSUNWQ19JTlRf
TUFTS19WX1NZTkMsIDApOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGxvZ2ljdmNf
Y3J0Y19kaXNhYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2NydGMgKmRybV9jcnRjKQoreworCXN0cnVj
dCBsb2dpY3ZjX2NydGMgKmNydGMgPSBsb2dpY3ZjX2NydGMoZHJtX2NydGMpOworCXN0cnVjdCBs
b2dpY3ZjX2RybSAqbG9naWN2YyA9IGNydGMtPmxvZ2ljdmM7CisKKwkvKiBNYXNrIFZfU1lOQyBp
bnRlcnJ1cHQuICovCisJcmVnbWFwX3dyaXRlX2JpdHMobG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZD
X0lOVF9NQVNLX1JFRywKKwkJCSAgTE9HSUNWQ19JTlRfTUFTS19WX1NZTkMsIExPR0lDVkNfSU5U
X01BU0tfVl9TWU5DKTsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY3J0Y19mdW5jcyBs
b2dpY3ZjX2NydGNfZnVuY3MgPSB7CisJLnJlc2V0CQkJPSBkcm1fYXRvbWljX2hlbHBlcl9jcnRj
X3Jlc2V0LAorCS5kZXN0cm95CQk9IGRybV9jcnRjX2NsZWFudXAsCisJLnNldF9jb25maWcJCT0g
ZHJtX2F0b21pY19oZWxwZXJfc2V0X2NvbmZpZywKKwkucGFnZV9mbGlwCQk9IGRybV9hdG9taWNf
aGVscGVyX3BhZ2VfZmxpcCwKKwkuYXRvbWljX2R1cGxpY2F0ZV9zdGF0ZQk9IGRybV9hdG9taWNf
aGVscGVyX2NydGNfZHVwbGljYXRlX3N0YXRlLAorCS5hdG9taWNfZGVzdHJveV9zdGF0ZQk9IGRy
bV9hdG9taWNfaGVscGVyX2NydGNfZGVzdHJveV9zdGF0ZSwKKwkuZW5hYmxlX3ZibGFuawkJPSBs
b2dpY3ZjX2NydGNfZW5hYmxlX3ZibGFuaywKKwkuZGlzYWJsZV92YmxhbmsJCT0gbG9naWN2Y19j
cnRjX2Rpc2FibGVfdmJsYW5rLAorfTsKKwordm9pZCBsb2dpY3ZjX2NydGNfdmJsYW5rX2hhbmRs
ZXIoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjKQoreworCXN0cnVjdCBsb2dpY3ZjX2NydGMg
KmNydGMgPSBsb2dpY3ZjLT5jcnRjOworCXN0cnVjdCBkcm1fZGV2aWNlICpkcm0gPSBsb2dpY3Zj
LT5kcm07CisJdW5zaWduZWQgbG9uZyBmbGFnczsKKworCWlmICghY3J0YykKKwkJcmV0dXJuOwor
CisJZHJtX2NydGNfaGFuZGxlX3ZibGFuaygmY3J0Yy0+ZHJtX2NydGMpOworCisJc3Bpbl9sb2Nr
X2lycXNhdmUoJmRybS0+ZXZlbnRfbG9jaywgZmxhZ3MpOworCWlmIChjcnRjLT5ldmVudCkgewor
CQlkcm1fY3J0Y19zZW5kX3ZibGFua19ldmVudCgmY3J0Yy0+ZHJtX2NydGMsIGNydGMtPmV2ZW50
KTsKKwkJZHJtX2NydGNfdmJsYW5rX3B1dCgmY3J0Yy0+ZHJtX2NydGMpOworCQljcnRjLT5ldmVu
dCA9IE5VTEw7CisJfQorCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRybS0+ZXZlbnRfbG9jaywg
ZmxhZ3MpOworfQorCitpbnQgbG9naWN2Y19jcnRjX2luaXQoc3RydWN0IGxvZ2ljdmNfZHJtICps
b2dpY3ZjKQoreworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqb2Zfbm9kZSA9IGxvZ2ljdmMtPmRybS0+
ZGV2LT5vZl9ub2RlOworCXN0cnVjdCBsb2dpY3ZjX2NydGMgKmNydGM7CisJc3RydWN0IGxvZ2lj
dmNfbGF5ZXIgKmxheWVyX3ByaW1hcnk7CisJaW50IHJldDsKKworCWNydGMgPSBkZXZtX2t6YWxs
b2MobG9naWN2Yy0+ZHJtLT5kZXYsIHNpemVvZigqY3J0YyksIEdGUF9LRVJORUwpOworCWlmICgh
Y3J0YykKKwkJcmV0dXJuIC1FTk9NRU07CisKKwljcnRjLT5sb2dpY3ZjID0gbG9naWN2YzsKKwor
CWxheWVyX3ByaW1hcnkgPSBsb2dpY3ZjX2xheWVyX2dldF9wcmltYXJ5KGxvZ2ljdmMpOworCWlm
ICghbGF5ZXJfcHJpbWFyeSkgeworCQlEUk1fRVJST1IoIkZhaWxlZCB0byBnZXQgcHJpbWFyeSBs
YXllclxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCXJldCA9IGRybV9jcnRjX2luaXRf
d2l0aF9wbGFuZXMobG9naWN2Yy0+ZHJtLCAmY3J0Yy0+ZHJtX2NydGMsCisJCQkJCSZsYXllcl9w
cmltYXJ5LT5kcm1fcGxhbmUsIE5VTEwsCisJCQkJCSZsb2dpY3ZjX2NydGNfZnVuY3MsIE5VTEwp
OworCWlmIChyZXQpIHsKKwkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gaW5pdGFsaXplIENSVENcbiIp
OworCQlyZXR1cm4gcmV0OworCX0KKworCWRybV9jcnRjX2hlbHBlcl9hZGQoJmNydGMtPmRybV9j
cnRjLCAmbG9naWN2Y19jcnRjX2hlbHBlcl9mdW5jcyk7CisKKwljcnRjLT5kcm1fY3J0Yy5wb3J0
ID0gb2ZfZ3JhcGhfZ2V0X3BvcnRfYnlfaWQob2Zfbm9kZSwgMSk7CisKKwlsb2dpY3ZjLT5jcnRj
ID0gY3J0YzsKKworCXJldHVybiAwOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xv
Z2ljdmMvbG9naWN2Y19jcnRjLmggYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2Ny
dGMuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmRmYTU1YzM3N2Fj
MwotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfY3J0
Yy5oCkBAIC0wLDAgKzEsMjUgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4w
KyAqLworLyoKKyAqIENvcHlyaWdodCAoQykgMjAxOSBCb290bGluCisgKiBBdXRob3I6IFBhdWwg
S29jaWFsa293c2tpIDxwYXVsLmtvY2lhbGtvd3NraUBib290bGluLmNvbT4KKyAqLworCisjaWZu
ZGVmIF9MT0dJQ1ZDX0NSVENfSF8KKyNkZWZpbmUgX0xPR0lDVkNfQ1JUQ19IXworCisjaW5jbHVk
ZSA8ZHJtL2RybV9jcnRjLmg+CisjaW5jbHVkZSA8ZHJtL2RybV92YmxhbmsuaD4KKworc3RydWN0
IGxvZ2ljdmNfZHJtOworCitzdHJ1Y3QgbG9naWN2Y19jcnRjIHsKKwlzdHJ1Y3QgbG9naWN2Y19k
cm0gKmxvZ2ljdmM7CisKKwlzdHJ1Y3QgZHJtX2NydGMgZHJtX2NydGM7CisJc3RydWN0IGRybV9w
ZW5kaW5nX3ZibGFua19ldmVudCAqZXZlbnQ7Cit9OworCit2b2lkIGxvZ2ljdmNfY3J0Y192Ymxh
bmtfaGFuZGxlcihzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMpOworaW50IGxvZ2ljdmNfY3J0
Y19pbml0KHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2Yyk7CisKKyNlbmRpZgpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19kcm0uYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9sb2dpY3ZjL2xvZ2ljdmNfZHJtLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MDAwMDAwLi5jOWExYTZiMzg2OTIKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
bG9naWN2Yy9sb2dpY3ZjX2RybS5jCkBAIC0wLDAgKzEsNDY3IEBACisvLyBTUERYLUxpY2Vuc2Ut
SWRlbnRpZmllcjogR1BMLTIuMCsKKy8qCisgKiBDb3B5cmlnaHQgKEMpIDIwMTkgQm9vdGxpbgor
ICogQXV0aG9yOiBQYXVsIEtvY2lhbGtvd3NraSA8cGF1bC5rb2NpYWxrb3dza2lAYm9vdGxpbi5j
b20+CisgKi8KKworI2luY2x1ZGUgPGxpbnV4L2Nsay5oPgorI2luY2x1ZGUgPGxpbnV4L21mZC9z
eXNjb24uaD4KKyNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KKyNpbmNsdWRlIDxsaW51eC9vZi5o
PgorI2luY2x1ZGUgPGxpbnV4L29mX2FkZHJlc3MuaD4KKyNpbmNsdWRlIDxsaW51eC9vZl9kZXZp
Y2UuaD4KKyNpbmNsdWRlIDxsaW51eC9vZl9yZXNlcnZlZF9tZW0uaD4KKyNpbmNsdWRlIDxsaW51
eC9yZWdtYXAuaD4KKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgorI2luY2x1ZGUgPGRybS9kcm1f
YXRvbWljX2hlbHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fZHJ2Lmg+CisjaW5jbHVkZSA8ZHJt
L2RybV9mYl9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2dlbV9jbWFfaGVscGVyLmg+Cisj
aW5jbHVkZSA8ZHJtL2RybV9wcmludC5oPgorCisjaW5jbHVkZSAibG9naWN2Y19jcnRjLmgiCisj
aW5jbHVkZSAibG9naWN2Y19kcm0uaCIKKyNpbmNsdWRlICJsb2dpY3ZjX2ludGVyZmFjZS5oIgor
I2luY2x1ZGUgImxvZ2ljdmNfbW9kZS5oIgorI2luY2x1ZGUgImxvZ2ljdmNfbGF5ZXIuaCIKKyNp
bmNsdWRlICJsb2dpY3ZjX29mLmgiCisjaW5jbHVkZSAibG9naWN2Y19yZWdzLmgiCisKK0RFRklO
RV9EUk1fR0VNX0NNQV9GT1BTKGxvZ2ljdmNfZHJtX2ZvcHMpOworCitzdGF0aWMgaW50IGxvZ2lj
dmNfZHJtX2dlbV9jbWFfZHVtYl9jcmVhdGUoc3RydWN0IGRybV9maWxlICpmaWxlX3ByaXYsCisJ
CQkJCSAgIHN0cnVjdCBkcm1fZGV2aWNlICpkcm0sCisJCQkJCSAgIHN0cnVjdCBkcm1fbW9kZV9j
cmVhdGVfZHVtYiAqYXJncykKK3sKKwlzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMgPSBkcm0t
PmRldl9wcml2YXRlOworCisJLyogU3RyaWRlIGlzIGFsd2F5cyBmaXhlZCB0byBpdHMgY29uZmln
dXJhdGlvbiB2YWx1ZS4gKi8KKwlhcmdzLT5waXRjaCA9IGxvZ2ljdmMtPmNvbmZpZy5yb3dfc3Ry
aWRlICogRElWX1JPVU5EX1VQKGFyZ3MtPmJwcCwgOCk7CisKKwlyZXR1cm4gZHJtX2dlbV9jbWFf
ZHVtYl9jcmVhdGVfaW50ZXJuYWwoZmlsZV9wcml2LCBkcm0sIGFyZ3MpOworfQorCitzdGF0aWMg
c3RydWN0IGRybV9kcml2ZXIgbG9naWN2Y19kcm1fZHJpdmVyID0geworCS5kcml2ZXJfZmVhdHVy
ZXMJCT0gRFJJVkVSX0dFTSB8IERSSVZFUl9NT0RFU0VUIHwKKwkJCQkJICBEUklWRVJfQVRPTUlD
LAorCisJLmZvcHMJCQkJPSAmbG9naWN2Y19kcm1fZm9wcywKKwkubmFtZQkJCQk9ICJsb2dpY3Zj
LWRybSIsCisJLmRlc2MJCQkJPSAiWHlsb24gTG9naUNWQyBEUk0gZHJpdmVyIiwKKwkuZGF0ZQkJ
CQk9ICIyMDE5MDMxOSIsCisJLm1ham9yCQkJCT0gMSwKKwkubWlub3IJCQkJPSAwLAorCisJRFJN
X0dFTV9DTUFfVk1BUF9EUklWRVJfT1BTLAorCS5kdW1iX2NyZWF0ZQkJCT0gbG9naWN2Y19kcm1f
Z2VtX2NtYV9kdW1iX2NyZWF0ZSwKK307CisKK3N0YXRpYyBzdHJ1Y3QgcmVnbWFwX2NvbmZpZyBs
b2dpY3ZjX2RybV9yZWdtYXBfY29uZmlnID0geworCS5yZWdfYml0cwk9IDMyLAorCS52YWxfYml0
cwk9IDMyLAorCS5yZWdfc3RyaWRlCT0gNCwKKwkubmFtZQkJPSAibG9naWN2Yy1kcm0iLAorfTsK
Kworc3RhdGljIGlycXJldHVybl90IGxvZ2ljdmNfZHJtX2lycV9oYW5kbGVyKGludCBpcnEsIHZv
aWQgKmRhdGEpCit7CisJc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjID0gZGF0YTsKKwlpcnFy
ZXR1cm5fdCByZXQgPSBJUlFfTk9ORTsKKwl1MzIgc3RhdCA9IDA7CisKKwkvKiBHZXQgcGVuZGlu
ZyBpbnRlcnJ1cHQgc291cmNlcy4gKi8KKwlyZWdtYXBfcmVhZChsb2dpY3ZjLT5yZWdtYXAsIExP
R0lDVkNfSU5UX1NUQVRfUkVHLCAmc3RhdCk7CisKKwkvKiBDbGVhciBhbGwgcGVuZGluZyBpbnRl
cnJ1cHQgc291cmNlcy4gKi8KKwlyZWdtYXBfd3JpdGUobG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZD
X0lOVF9TVEFUX1JFRywgc3RhdCk7CisKKwlpZiAoc3RhdCAmIExPR0lDVkNfSU5UX1NUQVRfVl9T
WU5DKSB7CisJCWxvZ2ljdmNfY3J0Y192YmxhbmtfaGFuZGxlcihsb2dpY3ZjKTsKKwkJcmV0ID0g
SVJRX0hBTkRMRUQ7CisJfQorCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBsb2dpY3Zj
X2RybV9jb25maWdfcGFyc2Uoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjKQoreworCXN0cnVj
dCBkZXZpY2Vfbm9kZSAqb2Zfbm9kZSA9IGxvZ2ljdmMtPmRybS0+ZGV2LT5vZl9ub2RlOworCXN0
cnVjdCBsb2dpY3ZjX2RybV9jb25maWcgKmNvbmZpZyA9ICZsb2dpY3ZjLT5jb25maWc7CisJc3Ry
dWN0IGRldmljZV9ub2RlICpsYXllcnNfbm9kZTsKKwlpbnQgcmV0OworCisJbG9naWN2Y19vZl9w
cm9wZXJ0eV9wYXJzZV9ib29sKG9mX25vZGUsICJ4eWxvbixkaXRoZXJpbmciLAorCQkJCSAgICAg
ICAmY29uZmlnLT5kaXRoZXJpbmcpOworCWxvZ2ljdmNfb2ZfcHJvcGVydHlfcGFyc2VfYm9vbChv
Zl9ub2RlLCAieHlsb24sYmFja2dyb3VuZC1sYXllciIsCisJCQkJICAgICAgICZjb25maWctPmJh
Y2tncm91bmRfbGF5ZXIpOworCWxvZ2ljdmNfb2ZfcHJvcGVydHlfcGFyc2VfYm9vbChvZl9ub2Rl
LCAieHlsb24sbGF5ZXJzLWNvbmZpZ3VyYWJsZSIsCisJCQkJICAgICAgICZjb25maWctPmxheWVy
c19jb25maWd1cmFibGUpOworCisJcmV0ID0gbG9naWN2Y19vZl9wcm9wZXJ0eV9wYXJzZV91MzIo
b2Zfbm9kZSwgInh5bG9uLGRpc3BsYXktaW50ZXJmYWNlIiwKKwkJCQkJICAgICZjb25maWctPmRp
c3BsYXlfaW50ZXJmYWNlKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJcmV0ID0gbG9n
aWN2Y19vZl9wcm9wZXJ0eV9wYXJzZV91MzIob2Zfbm9kZSwgInh5bG9uLGRpc3BsYXktY29sb3Jz
cGFjZSIsCisJCQkJCSAgICAmY29uZmlnLT5kaXNwbGF5X2NvbG9yc3BhY2UpOworCWlmIChyZXQp
CisJCXJldHVybiByZXQ7CisKKwlyZXQgPSBsb2dpY3ZjX29mX3Byb3BlcnR5X3BhcnNlX3UzMihv
Zl9ub2RlLCAieHlsb24sZGlzcGxheS1kZXB0aCIsCisJCQkJCSAgICAmY29uZmlnLT5kaXNwbGF5
X2RlcHRoKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJcmV0ID0gbG9naWN2Y19vZl9w
cm9wZXJ0eV9wYXJzZV91MzIob2Zfbm9kZSwgInh5bG9uLHJvdy1zdHJpZGUiLAorCQkJCQkgICAg
JmNvbmZpZy0+cm93X3N0cmlkZSk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCWxheWVy
c19ub2RlID0gb2ZfZ2V0X2NoaWxkX2J5X25hbWUob2Zfbm9kZSwgImxheWVycyIpOworCWlmICgh
bGF5ZXJzX25vZGUpIHsKKwkJRFJNX0VSUk9SKCJNaXNzaW5nIG5vbi1vcHRpb25hbCBsYXllcnMg
bm9kZVxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCWNvbmZpZy0+bGF5ZXJzX2NvdW50
ID0gb2ZfZ2V0X2NoaWxkX2NvdW50KGxheWVyc19ub2RlKTsKKwlpZiAoIWNvbmZpZy0+bGF5ZXJz
X2NvdW50KSB7CisJCURSTV9FUlJPUigiTWlzc2luZyBhIG5vbi1vcHRpb25hbCBsYXllcnMgY2hp
bGRyZW4gbm9kZVxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCXJldHVybiAwOworfQor
CitzdGF0aWMgdm9pZCBsb2dpY3ZjX3ZlcnNpb25fcHJpbnQoc3RydWN0IGxvZ2ljdmNfZHJtICps
b2dpY3ZjKQoreworCXUzMiB2ZXJzaW9uOworCisJcmVnbWFwX3JlYWQobG9naWN2Yy0+cmVnbWFw
LCBMT0dJQ1ZDX0lQX1ZFUlNJT05fUkVHLCAmdmVyc2lvbik7CisKKwlEUk1fSU5GTygiTG9naUNW
QyB2ZXJzaW9uICVkLiUwMmQuJWNcbiIsCisJCSAoaW50KUxPR0lDVkNfRklFTERfR0VUKExPR0lD
VkNfSVBfVkVSU0lPTl9NQUpPUiwgdmVyc2lvbiksCisJCSAoaW50KUxPR0lDVkNfRklFTERfR0VU
KExPR0lDVkNfSVBfVkVSU0lPTl9NSU5PUiwgdmVyc2lvbiksCisJCSAoY2hhcilMT0dJQ1ZDX0ZJ
RUxEX0dFVChMT0dJQ1ZDX0lQX1ZFUlNJT05fTEVWRUwsIHZlcnNpb24pICsKKwkJICdhJyk7Cit9
CisKK3N0YXRpYyBpbnQgbG9naWN2Y19jbG9ja3NfcHJlcGFyZShzdHJ1Y3QgbG9naWN2Y19kcm0g
KmxvZ2ljdmMpCit7CisJc3RydWN0IHsKKwkJc3RydWN0IGNsayAqKmNsazsKKwkJY2hhciAqbmFt
ZTsKKwkJYm9vbCBvcHRpb25hbDsKKwl9IGNsb2Nrc19tYXBbXSA9IHsKKwkJeworCQkJLmNsayA9
ICZsb2dpY3ZjLT52Y2xrLAorCQkJLm5hbWUgPSAidmNsayIsCisJCQkub3B0aW9uYWwgPSBmYWxz
ZSwKKwkJfSwKKwkJeworCQkJLmNsayA9ICZsb2dpY3ZjLT52Y2xrMiwKKwkJCS5uYW1lID0gInZj
bGsyIiwKKwkJCS5vcHRpb25hbCA9IHRydWUsCisJCX0sCisJCXsKKwkJCS5jbGsgPSAmbG9naWN2
Yy0+bHZkc2NsaywKKwkJCS5uYW1lID0gImx2ZHNjbGsiLAorCQkJLm9wdGlvbmFsID0gdHJ1ZSwK
KwkJfSwKKwkJeworCQkJLmNsayA9ICZsb2dpY3ZjLT5sdmRzY2xrbiwKKwkJCS5uYW1lID0gImx2
ZHNjbGtuIiwKKwkJCS5vcHRpb25hbCA9IHRydWUsCisJCX0sCisJfTsKKwl1bnNpZ25lZCBpbnQg
aTsKKwlpbnQgcmV0OworCisJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoY2xvY2tzX21hcCk7
IGkrKykgeworCQlzdHJ1Y3QgY2xrICpjbGs7CisKKwkJY2xrID0gZGV2bV9jbGtfZ2V0KGxvZ2lj
dmMtPmRybS0+ZGV2LCBjbG9ja3NfbWFwW2ldLm5hbWUpOworCQlpZiAoSVNfRVJSKGNsaykpIHsK
KwkJCWlmIChQVFJfRVJSKGNsaykgPT0gLUVOT0VOVCAmJiBjbG9ja3NfbWFwW2ldLm9wdGlvbmFs
KQorCQkJCWNvbnRpbnVlOworCisJCQlEUk1fRVJST1IoIk1pc3Npbmcgbm9uLW9wdGlvbmFsIGNs
b2NrICVzXG4iLAorCQkJCSAgY2xvY2tzX21hcFtpXS5uYW1lKTsKKworCQkJcmV0ID0gUFRSX0VS
UihjbGspOworCQkJZ290byBlcnJvcjsKKwkJfQorCisJCXJldCA9IGNsa19wcmVwYXJlX2VuYWJs
ZShjbGspOworCQlpZiAocmV0KSB7CisJCQlEUk1fRVJST1IoIkZhaWxlZCB0byBwcmVwYXJlIGFu
ZCBlbmFibGUgY2xvY2sgJXNcbiIsCisJCQkJICBjbG9ja3NfbWFwW2ldLm5hbWUpOworCQkJZ290
byBlcnJvcjsKKwkJfQorCisJCSpjbG9ja3NfbWFwW2ldLmNsayA9IGNsazsKKwl9CisKKwlyZXR1
cm4gMDsKKworZXJyb3I6CisJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoY2xvY2tzX21hcCk7
IGkrKykgeworCQlpZiAoISpjbG9ja3NfbWFwW2ldLmNsaykKKwkJCWNvbnRpbnVlOworCisJCWNs
a19kaXNhYmxlX3VucHJlcGFyZSgqY2xvY2tzX21hcFtpXS5jbGspOworCQkqY2xvY2tzX21hcFtp
XS5jbGsgPSBOVUxMOworCX0KKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgbG9naWN2
Y19jbG9ja3NfdW5wcmVwYXJlKHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YykKK3sKKwlzdHJ1
Y3QgY2xrICoqY2xvY2tzW10gPSB7CisJCSZsb2dpY3ZjLT52Y2xrLAorCQkmbG9naWN2Yy0+dmNs
azIsCisJCSZsb2dpY3ZjLT5sdmRzY2xrLAorCQkmbG9naWN2Yy0+bHZkc2Nsa24sCisJfTsKKwl1
bnNpZ25lZCBpbnQgaTsKKworCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGNsb2Nrcyk7IGkr
KykgeworCQlpZiAoISpjbG9ja3NbaV0pCisJCQljb250aW51ZTsKKworCQljbGtfZGlzYWJsZV91
bnByZXBhcmUoKmNsb2Nrc1tpXSk7CisJCSpjbG9ja3NbaV0gPSBOVUxMOworCX0KKworCXJldHVy
biAwOworfQorCitzdGF0aWMgaW50IGxvZ2ljdmNfZHJtX3Byb2JlKHN0cnVjdCBwbGF0Zm9ybV9k
ZXZpY2UgKnBkZXYpCit7CisJc3RydWN0IGRldmljZV9ub2RlICpvZl9ub2RlID0gcGRldi0+ZGV2
Lm9mX25vZGU7CisJc3RydWN0IGRldmljZV9ub2RlICpyZXNlcnZlZF9tZW1fbm9kZTsKKwlzdHJ1
Y3QgcmVzZXJ2ZWRfbWVtICpyZXNlcnZlZF9tZW0gPSBOVUxMOworCWNvbnN0IHN0cnVjdCBsb2dp
Y3ZjX2RybV9jYXBzICpjYXBzOworCXN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YzsKKwlzdHJ1
Y3QgZHJtX2RldmljZSAqZHJtOworCXN0cnVjdCByZWdtYXAgKnJlZ21hcDsKKwlzdHJ1Y3QgcmVz
b3VyY2UgcmVzOworCXZvaWQgX19pb21lbSAqYmFzZTsKKwlpbnQgaXJxOworCWludCByZXQ7CisK
KwljYXBzID0gb2ZfZGV2aWNlX2dldF9tYXRjaF9kYXRhKCZwZGV2LT5kZXYpOworCWlmICghY2Fw
cykKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlyZXQgPSBvZl9yZXNlcnZlZF9tZW1fZGV2aWNlX2lu
aXQoJnBkZXYtPmRldik7CisJaWYgKHJldCAmJiByZXQgIT0gLUVOT0RFVikgeworCQlEUk1fRVJS
T1IoIkZhaWxlZCB0byBpbml0IG1lbW9yeSByZWdpb25cbiIpOworCQlnb3RvIGVycm9yX2Vhcmx5
OworCX0KKworCXJlc2VydmVkX21lbV9ub2RlID0gb2ZfcGFyc2VfcGhhbmRsZShvZl9ub2RlLCAi
bWVtb3J5LXJlZ2lvbiIsIDApOworCWlmIChyZXNlcnZlZF9tZW1fbm9kZSkgeworCQlyZXNlcnZl
ZF9tZW0gPSBvZl9yZXNlcnZlZF9tZW1fbG9va3VwKHJlc2VydmVkX21lbV9ub2RlKTsKKwkJb2Zf
bm9kZV9wdXQocmVzZXJ2ZWRfbWVtX25vZGUpOworCX0KKworCS8qIEdldCByZWdtYXAgZnJvbSBz
eXNjb24gZmlyc3QgaWYgYXZhaWxhYmxlLiAqLworCXJlZ21hcCA9IHN5c2Nvbl9yZWdtYXBfbG9v
a3VwX2J5X3BoYW5kbGUob2Zfbm9kZSwgInh5bG9uLHN5c2NvbiIpOworCisJLyogVGhlbiBnZXQg
cmVnbWFwIGZyb20gcGFyZW50IGlmIGF2YWlsYWJsZS4gKi8KKwlpZiAoSVNfRVJSKHJlZ21hcCkg
JiYgb2Zfbm9kZS0+cGFyZW50KQorCQlyZWdtYXAgPSBzeXNjb25fbm9kZV90b19yZWdtYXAob2Zf
bm9kZS0+cGFyZW50KTsKKworCS8qIFJlZ2lzdGVyIG91ciBvd24gcmVnbWFwIG90aGVyd2lzZS4g
Ki8KKwlpZiAoSVNfRVJSKHJlZ21hcCkpIHsKKwkJcmV0ID0gb2ZfYWRkcmVzc190b19yZXNvdXJj
ZShvZl9ub2RlLCAwLCAmcmVzKTsKKwkJaWYgKHJldCkgeworCQkJRFJNX0VSUk9SKCJGYWlsZWQg
dG8gZ2V0IHJlc291cmNlIGZyb20gYWRkcmVzc1xuIik7CisJCQlnb3RvIGVycm9yX3Jlc2VydmVk
X21lbTsKKwkJfQorCisJCWJhc2UgPSBkZXZtX2lvcmVtYXBfcmVzb3VyY2UoJnBkZXYtPmRldiwg
JnJlcyk7CisJCWlmIChJU19FUlIoYmFzZSkpIHsKKwkJCURSTV9FUlJPUigiRmFpbGVkIHRvIG1h
cCBJL08gYmFzZVxuIik7CisJCQlyZXQgPSBQVFJfRVJSKGJhc2UpOworCQkJZ290byBlcnJvcl9y
ZXNlcnZlZF9tZW07CisJCX0KKworCQlsb2dpY3ZjX2RybV9yZWdtYXBfY29uZmlnLm1heF9yZWdp
c3RlciA9IHJlc291cmNlX3NpemUoJnJlcykgLQorCQkJCQkJCSA0OworCisJCXJlZ21hcCA9IGRl
dm1fcmVnbWFwX2luaXRfbW1pbygmcGRldi0+ZGV2LCBiYXNlLAorCQkJCQkgICAgICAgJmxvZ2lj
dmNfZHJtX3JlZ21hcF9jb25maWcpOworCQlpZiAoSVNfRVJSKHJlZ21hcCkpIHsKKwkJCURSTV9F
UlJPUigiRmFpbGVkIHRvIGNyZWF0ZSByZWdtYXAgZm9yIEkvT1xuIik7CisJCQlyZXQgPSBQVFJf
RVJSKHJlZ21hcCk7CisJCQlnb3RvIGVycm9yX3Jlc2VydmVkX21lbTsKKwkJfQorCX0KKworCWly
cSA9IHBsYXRmb3JtX2dldF9pcnEocGRldiwgMCk7CisJaWYgKGlycSA8IDApIHsKKwkJRFJNX0VS
Uk9SKCJGYWlsZWQgdG8gZ2V0IElSUVxuIik7CisJCXJldCA9IC1FTk9ERVY7CisJCWdvdG8gZXJy
b3JfcmVzZXJ2ZWRfbWVtOworCX0KKworCWRybSA9IGRybV9kZXZfYWxsb2MoJmxvZ2ljdmNfZHJt
X2RyaXZlciwgJnBkZXYtPmRldik7CisJaWYgKElTX0VSUihkcm0pKSB7CisJCXJldCA9IFBUUl9F
UlIoZHJtKTsKKwkJZ290byBlcnJvcl9yZXNlcnZlZF9tZW07CisJfQorCisJbG9naWN2YyA9IGRl
dm1fa3phbGxvYygmcGRldi0+ZGV2LCBzaXplb2YoKmxvZ2ljdmMpLCBHRlBfS0VSTkVMKTsKKwlp
ZiAoIWxvZ2ljdmMpIHsKKwkJcmV0ID0gLUVOT01FTTsKKwkJZ290byBlcnJvcl9sb2dpY3ZjOwor
CX0KKworCWxvZ2ljdmMtPmNhcHMgPSBjYXBzOworCWxvZ2ljdmMtPmRybSA9IGRybTsKKwlkcm0t
PmRldl9wcml2YXRlID0gbG9naWN2YzsKKwlwbGF0Zm9ybV9zZXRfZHJ2ZGF0YShwZGV2LCBsb2dp
Y3ZjKTsKKworCWxvZ2ljdmMtPnJlZ21hcCA9IHJlZ21hcDsKKwlJTklUX0xJU1RfSEVBRCgmbG9n
aWN2Yy0+bGF5ZXJzX2xpc3QpOworCisJaWYgKHJlc2VydmVkX21lbSkKKwkJbG9naWN2Yy0+cmVz
ZXJ2ZWRfbWVtX2Jhc2UgPSByZXNlcnZlZF9tZW0tPmJhc2U7CisKKwlyZXQgPSBsb2dpY3ZjX2Ns
b2Nrc19wcmVwYXJlKGxvZ2ljdmMpOworCWlmIChyZXQpIHsKKwkJRFJNX0VSUk9SKCJGYWlsZWQg
dG8gcHJlcGFyZSBjbG9ja3NcbiIpOworCQlnb3RvIGVycm9yX2xvZ2ljdmM7CisJfQorCisJcmV0
ID0gZGV2bV9yZXF1ZXN0X2lycShkcm0tPmRldiwgaXJxLCBsb2dpY3ZjX2RybV9pcnFfaGFuZGxl
ciwgMCwKKwkJCSAgICAgICBkZXZfbmFtZShkcm0tPmRldiksIGxvZ2ljdmMpOworCWlmIChyZXQp
IHsKKwkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gcmVxdWVzdCBJUlFcbiIpOworCQlnb3RvIGVycm9y
X2Nsb2NrczsKKwl9CisKKwlsb2dpY3ZjX3ZlcnNpb25fcHJpbnQobG9naWN2Yyk7CisKKwlyZXQg
PSBsb2dpY3ZjX2RybV9jb25maWdfcGFyc2UobG9naWN2Yyk7CisJaWYgKHJldCAmJiByZXQgIT0g
LUVOT0RFVikgeworCQlEUk1fRVJST1IoIkZhaWxlZCB0byBwYXJzZSBjb25maWdcbiIpOworCQln
b3RvIGVycm9yX2Nsb2NrczsKKwl9CisKKwlkcm1fbW9kZV9jb25maWdfaW5pdChkcm0pOworCisJ
cmV0ID0gbG9naWN2Y19sYXllcnNfaW5pdChsb2dpY3ZjKTsKKwlpZiAocmV0KSB7CisJCURSTV9F
UlJPUigiRmFpbGVkIHRvIGluaXRpYWxpemUgbGF5ZXJzXG4iKTsKKwkJZ290byBlcnJvcl9tb2Rl
X2NvbmZpZzsKKwl9CisKKwlyZXQgPSBsb2dpY3ZjX2NydGNfaW5pdChsb2dpY3ZjKTsKKwlpZiAo
cmV0KSB7CisJCURSTV9FUlJPUigiRmFpbGVkIHRvIGluaXRpYWxpemUgQ1JUQ1xuIik7CisJCWdv
dG8gZXJyb3JfbW9kZV9jb25maWc7CisJfQorCisJbG9naWN2Y19sYXllcnNfYXR0YWNoX2NydGMo
bG9naWN2Yyk7CisKKwlyZXQgPSBsb2dpY3ZjX2ludGVyZmFjZV9pbml0KGxvZ2ljdmMpOworCWlm
IChyZXQpIHsKKwkJaWYgKHJldCAhPSAtRVBST0JFX0RFRkVSKQorCQkJRFJNX0VSUk9SKCJGYWls
ZWQgdG8gaW5pdGlhbGl6ZSBpbnRlcmZhY2VcbiIpOworCisJCWdvdG8gZXJyb3JfbW9kZV9jb25m
aWc7CisJfQorCisJbG9naWN2Y19pbnRlcmZhY2VfYXR0YWNoX2NydGMobG9naWN2Yyk7CisKKwly
ZXQgPSBsb2dpY3ZjX21vZGVfaW5pdChsb2dpY3ZjKTsKKwlpZiAocmV0KSB7CisJCURSTV9FUlJP
UigiRmFpbGVkIHRvIGluaXRpYWxpemUgS01TXG4iKTsKKwkJZ290byBlcnJvcl9tb2RlX2NvbmZp
ZzsKKwl9CisKKwlyZXQgPSBkcm1fZGV2X3JlZ2lzdGVyKGRybSwgMCk7CisJaWYgKHJldCkgewor
CQlEUk1fRVJST1IoIkZhaWxlZCB0byByZWdpc3RlciBEUk0gZGV2aWNlXG4iKTsKKwkJZ290byBl
cnJvcl9tb2RlOworCX0KKworCXJldHVybiAwOworCitlcnJvcl9tb2RlOgorCWxvZ2ljdmNfbW9k
ZV9maW5pKGxvZ2ljdmMpOworCitlcnJvcl9tb2RlX2NvbmZpZzoKKwlkcm1fbW9kZV9jb25maWdf
Y2xlYW51cChkcm0pOworCitlcnJvcl9jbG9ja3M6CisJbG9naWN2Y19jbG9ja3NfdW5wcmVwYXJl
KGxvZ2ljdmMpOworCitlcnJvcl9sb2dpY3ZjOgorCWRybV9kZXZfcHV0KGRybSk7CisKK2Vycm9y
X3Jlc2VydmVkX21lbToKKwlvZl9yZXNlcnZlZF9tZW1fZGV2aWNlX3JlbGVhc2UoJnBkZXYtPmRl
dik7CisKK2Vycm9yX2Vhcmx5OgorCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgbG9naWN2
Y19kcm1fcmVtb3ZlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpCit7CisJc3RydWN0IGxv
Z2ljdmNfZHJtICpsb2dpY3ZjID0gcGxhdGZvcm1fZ2V0X2RydmRhdGEocGRldik7CisKKwlkcm1f
ZGV2X3VucmVnaXN0ZXIobG9naWN2Yy0+ZHJtKTsKKwlkcm1fYXRvbWljX2hlbHBlcl9zaHV0ZG93
bihsb2dpY3ZjLT5kcm0pOworCisJbG9naWN2Y19tb2RlX2ZpbmkobG9naWN2Yyk7CisKKwlkcm1f
bW9kZV9jb25maWdfY2xlYW51cChsb2dpY3ZjLT5kcm0pOworCisJbG9naWN2Y19jbG9ja3NfdW5w
cmVwYXJlKGxvZ2ljdmMpOworCisJZHJtX2Rldl9wdXQobG9naWN2Yy0+ZHJtKTsKKworCW9mX3Jl
c2VydmVkX21lbV9kZXZpY2VfcmVsZWFzZSgmcGRldi0+ZGV2KTsKKworCXJldHVybiAwOworfQor
CitzdGF0aWMgY29uc3Qgc3RydWN0IGxvZ2ljdmNfZHJtX2NhcHMgbG9naWN2Y19kcm1fY2Fwc18z
ID0geworCS5sYXllcl9hZGRyZXNzID0gZmFsc2UsCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0
IGxvZ2ljdmNfZHJtX2NhcHMgbG9naWN2Y19kcm1fY2Fwc180ID0geworCS5sYXllcl9hZGRyZXNz
ID0gdHJ1ZSwKK307CisKK3N0YXRpYyBzdHJ1Y3Qgb2ZfZGV2aWNlX2lkIGxvZ2ljdmNfZHJtX29m
X3RhYmxlW10gPSB7CisJeworCQkuY29tcGF0aWJsZSA9ICJ4eWxvbixsb2dpY3ZjLTMuMDIuYS1k
aXNwbGF5IiwKKwkJLmRhdGEgPSAmbG9naWN2Y19kcm1fY2Fwc18zLAorCX0sCisJeworCQkuY29t
cGF0aWJsZSA9ICJ4eWxvbixsb2dpY3ZjLTQuMDEuYS1kaXNwbGF5IiwKKwkJLmRhdGEgPSAmbG9n
aWN2Y19kcm1fY2Fwc180LAorCX0sCisJeyB9LAorfTsKK01PRFVMRV9ERVZJQ0VfVEFCTEUob2Ys
IGxvZ2ljdmNfZHJtX29mX3RhYmxlKTsKKworc3RhdGljIHN0cnVjdCBwbGF0Zm9ybV9kcml2ZXIg
bG9naWN2Y19kcm1fcGxhdGZvcm1fZHJpdmVyID0geworCS5wcm9iZQkJPSBsb2dpY3ZjX2RybV9w
cm9iZSwKKwkucmVtb3ZlCQk9IGxvZ2ljdmNfZHJtX3JlbW92ZSwKKwkuZHJpdmVyCQk9IHsKKwkJ
Lm5hbWUJCT0gImxvZ2ljdmMtZHJtIiwKKwkJLm9mX21hdGNoX3RhYmxlCT0gbG9naWN2Y19kcm1f
b2ZfdGFibGUsCisJfSwKK307CisKK21vZHVsZV9wbGF0Zm9ybV9kcml2ZXIobG9naWN2Y19kcm1f
cGxhdGZvcm1fZHJpdmVyKTsKKworTU9EVUxFX0FVVEhPUigiUGF1bCBLb2NpYWxrb3dza2kgPHBh
dWwua29jaWFsa293c2tpQGJvb3RsaW4uY29tPiIpOworTU9EVUxFX0RFU0NSSVBUSU9OKCJYeWxv
biBMb2dpQ1ZDIERSTSBkcml2ZXIiKTsKK01PRFVMRV9MSUNFTlNFKCJHUEwiKTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfZHJtLmggYi9kcml2ZXJzL2dwdS9k
cm0vbG9naWN2Yy9sb2dpY3ZjX2RybS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAw
MDAwMDAwMC4uY2M3MjhkNWE0YWVlCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2xvZ2ljdmMvbG9naWN2Y19kcm0uaApAQCAtMCwwICsxLDYwIEBACisvKiBTUERYLUxpY2Vuc2Ut
SWRlbnRpZmllcjogR1BMLTIuMCsgKi8KKy8qCisgKiBDb3B5cmlnaHQgKEMpIDIwMTkgQm9vdGxp
bgorICogQXV0aG9yOiBQYXVsIEtvY2lhbGtvd3NraSA8cGF1bC5rb2NpYWxrb3dza2lAYm9vdGxp
bi5jb20+CisgKi8KKworI2lmbmRlZiBfTE9HSUNWQ19EUk1fSF8KKyNkZWZpbmUgX0xPR0lDVkNf
RFJNX0hfCisKKyNpbmNsdWRlIDxsaW51eC9yZWdtYXAuaD4KKyNpbmNsdWRlIDxsaW51eC90eXBl
cy5oPgorI2luY2x1ZGUgPGRybS9kcm1fZGV2aWNlLmg+CisKKyNkZWZpbmUgTE9HSUNWQ19ESVNQ
TEFZX0lOVEVSRkFDRV9SR0IJCQkwCisjZGVmaW5lIExPR0lDVkNfRElTUExBWV9JTlRFUkZBQ0Vf
SVRVNjU2CQkxCisjZGVmaW5lIExPR0lDVkNfRElTUExBWV9JTlRFUkZBQ0VfTFZEU180QklUUwkJ
MgorI2RlZmluZSBMT0dJQ1ZDX0RJU1BMQVlfSU5URVJGQUNFX0xWRFNfNEJJVFNfQ0FNRVJBCTMK
KyNkZWZpbmUgTE9HSUNWQ19ESVNQTEFZX0lOVEVSRkFDRV9MVkRTXzNCSVRTCQk0CisjZGVmaW5l
IExPR0lDVkNfRElTUExBWV9JTlRFUkZBQ0VfRFZJCQkJNQorCisjZGVmaW5lIExPR0lDVkNfRElT
UExBWV9DT0xPUlNQQUNFX1JHQgkJMAorI2RlZmluZSBMT0dJQ1ZDX0RJU1BMQVlfQ09MT1JTUEFD
RV9ZVVY0MjIJMQorI2RlZmluZSBMT0dJQ1ZDX0RJU1BMQVlfQ09MT1JTUEFDRV9ZVVY0NDQJMgor
CitzdHJ1Y3QgbG9naWN2Y19jcnRjOworc3RydWN0IGxvZ2ljdmNfaW50ZXJmYWNlOworCitzdHJ1
Y3QgbG9naWN2Y19kcm1fY29uZmlnIHsKKwl1MzIgZGlzcGxheV9pbnRlcmZhY2U7CisJdTMyIGRp
c3BsYXlfY29sb3JzcGFjZTsKKwl1MzIgZGlzcGxheV9kZXB0aDsKKwl1MzIgcm93X3N0cmlkZTsK
Kwlib29sIGRpdGhlcmluZzsKKwlib29sIGJhY2tncm91bmRfbGF5ZXI7CisJYm9vbCBsYXllcnNf
Y29uZmlndXJhYmxlOworCXUzMiBsYXllcnNfY291bnQ7Cit9OworCitzdHJ1Y3QgbG9naWN2Y19k
cm1fY2FwcyB7CisJYm9vbCBsYXllcl9hZGRyZXNzOworfTsKKworc3RydWN0IGxvZ2ljdmNfZHJt
IHsKKwljb25zdCBzdHJ1Y3QgbG9naWN2Y19kcm1fY2FwcyAqY2FwczsKKwlzdHJ1Y3QgbG9naWN2
Y19kcm1fY29uZmlnIGNvbmZpZzsKKwlzdHJ1Y3QgZHJtX2RldmljZSAqZHJtOworCXBoeXNfYWRk
cl90IHJlc2VydmVkX21lbV9iYXNlOworCXN0cnVjdCByZWdtYXAgKnJlZ21hcDsKKworCXN0cnVj
dCBjbGsgKnZjbGs7CisJc3RydWN0IGNsayAqdmNsazI7CisJc3RydWN0IGNsayAqbHZkc2NsazsK
KwlzdHJ1Y3QgY2xrICpsdmRzY2xrbjsKKworCXN0cnVjdCBsaXN0X2hlYWQgbGF5ZXJzX2xpc3Q7
CisJc3RydWN0IGxvZ2ljdmNfY3J0YyAqY3J0YzsKKwlzdHJ1Y3QgbG9naWN2Y19pbnRlcmZhY2Ug
KmludGVyZmFjZTsKK307CisKKyNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xv
Z2ljdmMvbG9naWN2Y19pbnRlcmZhY2UuYyBiL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2lj
dmNfaW50ZXJmYWNlLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi43
OTJiMWZjMmE1ZjcKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9s
b2dpY3ZjX2ludGVyZmFjZS5jCkBAIC0wLDAgKzEsMjM1IEBACisvLyBTUERYLUxpY2Vuc2UtSWRl
bnRpZmllcjogR1BMLTIuMCsKKy8qCisgKiBDb3B5cmlnaHQgKEMpIDIwMTkgQm9vdGxpbgorICog
QXV0aG9yOiBQYXVsIEtvY2lhbGtvd3NraSA8cGF1bC5rb2NpYWxrb3dza2lAYm9vdGxpbi5jb20+
CisgKi8KKworI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9hdG9t
aWNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9icmlkZ2UuaD4KKyNpbmNsdWRlIDxkcm0v
ZHJtX2Nvbm5lY3Rvci5oPgorI2luY2x1ZGUgPGRybS9kcm1fY3J0Y19oZWxwZXIuaD4KKyNpbmNs
dWRlIDxkcm0vZHJtX2Rydi5oPgorI2luY2x1ZGUgPGRybS9kcm1fZW5jb2Rlci5oPgorI2luY2x1
ZGUgPGRybS9kcm1fZ2VtX2NtYV9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX21vZGVzZXRf
aGVscGVyX3Z0YWJsZXMuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX29mLmg+CisjaW5jbHVkZSA8ZHJt
L2RybV9wYW5lbC5oPgorI2luY2x1ZGUgPGRybS9kcm1fcHJpbnQuaD4KKyNpbmNsdWRlIDxkcm0v
ZHJtX3Byb2JlX2hlbHBlci5oPgorCisjaW5jbHVkZSAibG9naWN2Y19jcnRjLmgiCisjaW5jbHVk
ZSAibG9naWN2Y19kcm0uaCIKKyNpbmNsdWRlICJsb2dpY3ZjX2ludGVyZmFjZS5oIgorI2luY2x1
ZGUgImxvZ2ljdmNfcmVncy5oIgorCisjZGVmaW5lIGxvZ2ljdmNfaW50ZXJmYWNlX2Zyb21fZHJt
X2VuY29kZXIoYykgXAorCWNvbnRhaW5lcl9vZihjLCBzdHJ1Y3QgbG9naWN2Y19pbnRlcmZhY2Us
IGRybV9lbmNvZGVyKQorI2RlZmluZSBsb2dpY3ZjX2ludGVyZmFjZV9mcm9tX2RybV9jb25uZWN0
b3IoYykgXAorCWNvbnRhaW5lcl9vZihjLCBzdHJ1Y3QgbG9naWN2Y19pbnRlcmZhY2UsIGRybV9j
b25uZWN0b3IpCisKK3N0YXRpYyB2b2lkIGxvZ2ljdmNfZW5jb2Rlcl9lbmFibGUoc3RydWN0IGRy
bV9lbmNvZGVyICpkcm1fZW5jb2RlcikKK3sKKwlzdHJ1Y3QgbG9naWN2Y19pbnRlcmZhY2UgKmlu
dGVyZmFjZSA9CisJCWxvZ2ljdmNfaW50ZXJmYWNlX2Zyb21fZHJtX2VuY29kZXIoZHJtX2VuY29k
ZXIpOworCisJcmVnbWFwX3VwZGF0ZV9iaXRzKGludGVyZmFjZS0+bG9naWN2Yy0+cmVnbWFwLCBM
T0dJQ1ZDX1BPV0VSX0NUUkxfUkVHLAorCQkJICAgTE9HSUNWQ19QT1dFUl9DVFJMX1ZJREVPX0VO
QUJMRSwKKwkJCSAgIExPR0lDVkNfUE9XRVJfQ1RSTF9WSURFT19FTkFCTEUpOworCisJaWYgKGlu
dGVyZmFjZS0+ZHJtX3BhbmVsKSB7CisJCWRybV9wYW5lbF9wcmVwYXJlKGludGVyZmFjZS0+ZHJt
X3BhbmVsKTsKKworCQkvKiBFbmNvZGVyIGVuYWJsZSBpcyB0b28gZWFybHkgdG8gZW5hYmxlIHRo
ZSBwYW5lbCBhbmQgYSB3aGl0ZQorCQkgKiBzY3JlZW4gd2lsbCBiZSBzZWVuIGlmIHRoZSBwYW5l
bCBnZXRzIGVuYWJsZWQgYmVmb3JlIHRoZQorCQkgKiBmaXJzdCBwYWdlIGZsaXAgaXMgZG9uZSAo
YW5kIG5vIG90aGVyIGZyYW1lYnVmZmVyCisJCSAqIGNvbmZpZ3VyYXRpb24gcmVtYWlucyBmcm9t
IHRoZSBib290IHNvZnR3YXJlKS4gKi8KKwkJaW50ZXJmYWNlLT5kcm1fcGFuZWxfZW5hYmxlZCA9
IGZhbHNlOworCX0KK30KKworc3RhdGljIHZvaWQgbG9naWN2Y19lbmNvZGVyX2Rpc2FibGUoc3Ry
dWN0IGRybV9lbmNvZGVyICpkcm1fZW5jb2RlcikKK3sKKwlzdHJ1Y3QgbG9naWN2Y19pbnRlcmZh
Y2UgKmludGVyZmFjZSA9CisJCWxvZ2ljdmNfaW50ZXJmYWNlX2Zyb21fZHJtX2VuY29kZXIoZHJt
X2VuY29kZXIpOworCisJaWYgKGludGVyZmFjZS0+ZHJtX3BhbmVsKSB7CisJCWRybV9wYW5lbF9k
aXNhYmxlKGludGVyZmFjZS0+ZHJtX3BhbmVsKTsKKwkJZHJtX3BhbmVsX3VucHJlcGFyZShpbnRl
cmZhY2UtPmRybV9wYW5lbCk7CisJfQorfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9lbmNv
ZGVyX2hlbHBlcl9mdW5jcyBsb2dpY3ZjX2VuY29kZXJfaGVscGVyX2Z1bmNzID0geworCS5lbmFi
bGUJCQk9IGxvZ2ljdmNfZW5jb2Rlcl9lbmFibGUsCisJLmRpc2FibGUJCT0gbG9naWN2Y19lbmNv
ZGVyX2Rpc2FibGUsCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9lbmNvZGVyX2Z1bmNz
IGxvZ2ljdmNfZW5jb2Rlcl9mdW5jcyA9IHsKKwkuZGVzdHJveQkJPSBkcm1fZW5jb2Rlcl9jbGVh
bnVwLAorfTsKKworc3RhdGljIGludCBsb2dpY3ZjX2Nvbm5lY3Rvcl9nZXRfbW9kZXMoc3RydWN0
IGRybV9jb25uZWN0b3IgKmRybV9jb25uZWN0b3IpCit7CisJc3RydWN0IGxvZ2ljdmNfaW50ZXJm
YWNlICppbnRlcmZhY2UgPQorCQlsb2dpY3ZjX2ludGVyZmFjZV9mcm9tX2RybV9jb25uZWN0b3Io
ZHJtX2Nvbm5lY3Rvcik7CisKKwlpZiAoaW50ZXJmYWNlLT5kcm1fcGFuZWwpCisJCXJldHVybiBk
cm1fcGFuZWxfZ2V0X21vZGVzKGludGVyZmFjZS0+ZHJtX3BhbmVsKTsKKworCXJldHVybiAwOwor
fQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3JfaGVscGVyX2Z1bmNzIGxvZ2lj
dmNfY29ubmVjdG9yX2hlbHBlcl9mdW5jcyA9IHsKKwkuZ2V0X21vZGVzCQk9IGxvZ2ljdmNfY29u
bmVjdG9yX2dldF9tb2RlcywKK307CisKK3N0YXRpYyB2b2lkIGxvZ2ljdmNfY29ubmVjdG9yX2Rl
c3Ryb3koc3RydWN0IGRybV9jb25uZWN0b3IgKmRybV9jb25uZWN0b3IpCit7CisJc3RydWN0IGxv
Z2ljdmNfaW50ZXJmYWNlICppbnRlcmZhY2UgPQorCQlsb2dpY3ZjX2ludGVyZmFjZV9mcm9tX2Ry
bV9jb25uZWN0b3IoZHJtX2Nvbm5lY3Rvcik7CisKKwlpZiAoaW50ZXJmYWNlLT5kcm1fcGFuZWwp
CisJCWRybV9wYW5lbF9kZXRhY2goaW50ZXJmYWNlLT5kcm1fcGFuZWwpOworCisJZHJtX2Nvbm5l
Y3Rvcl9jbGVhbnVwKGRybV9jb25uZWN0b3IpOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRy
bV9jb25uZWN0b3JfZnVuY3MgbG9naWN2Y19jb25uZWN0b3JfZnVuY3MgPSB7CisJLnJlc2V0CQkJ
PSBkcm1fYXRvbWljX2hlbHBlcl9jb25uZWN0b3JfcmVzZXQsCisJLmZpbGxfbW9kZXMJCT0gZHJt
X2hlbHBlcl9wcm9iZV9zaW5nbGVfY29ubmVjdG9yX21vZGVzLAorCS5kZXN0cm95CQk9IGxvZ2lj
dmNfY29ubmVjdG9yX2Rlc3Ryb3ksCisJLmF0b21pY19kdXBsaWNhdGVfc3RhdGUJPSBkcm1fYXRv
bWljX2hlbHBlcl9jb25uZWN0b3JfZHVwbGljYXRlX3N0YXRlLAorCS5hdG9taWNfZGVzdHJveV9z
dGF0ZQk9IGRybV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9kZXN0cm95X3N0YXRlLAorfTsKKwor
c3RhdGljIGludCBsb2dpY3ZjX2ludGVyZmFjZV9lbmNvZGVyX3R5cGUoc3RydWN0IGxvZ2ljdmNf
ZHJtICpsb2dpY3ZjKQoreworCXN3aXRjaCAobG9naWN2Yy0+Y29uZmlnLmRpc3BsYXlfaW50ZXJm
YWNlKSB7CisJY2FzZSBMT0dJQ1ZDX0RJU1BMQVlfSU5URVJGQUNFX0xWRFNfNEJJVFM6CisJY2Fz
ZSBMT0dJQ1ZDX0RJU1BMQVlfSU5URVJGQUNFX0xWRFNfNEJJVFNfQ0FNRVJBOgorCWNhc2UgTE9H
SUNWQ19ESVNQTEFZX0lOVEVSRkFDRV9MVkRTXzNCSVRTOgorCQlyZXR1cm4gRFJNX01PREVfRU5D
T0RFUl9MVkRTOworCWNhc2UgTE9HSUNWQ19ESVNQTEFZX0lOVEVSRkFDRV9EVkk6CisJCXJldHVy
biBEUk1fTU9ERV9FTkNPREVSX1RNRFM7CisJY2FzZSBMT0dJQ1ZDX0RJU1BMQVlfSU5URVJGQUNF
X1JHQjoKKwkJcmV0dXJuIERSTV9NT0RFX0VOQ09ERVJfRFBJOworCWRlZmF1bHQ6CisJCXJldHVy
biBEUk1fTU9ERV9FTkNPREVSX05PTkU7CisJfQorfQorCitzdGF0aWMgaW50IGxvZ2ljdmNfaW50
ZXJmYWNlX2Nvbm5lY3Rvcl90eXBlKHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YykKK3sKKwlz
d2l0Y2ggKGxvZ2ljdmMtPmNvbmZpZy5kaXNwbGF5X2ludGVyZmFjZSkgeworCWNhc2UgTE9HSUNW
Q19ESVNQTEFZX0lOVEVSRkFDRV9MVkRTXzRCSVRTOgorCWNhc2UgTE9HSUNWQ19ESVNQTEFZX0lO
VEVSRkFDRV9MVkRTXzRCSVRTX0NBTUVSQToKKwljYXNlIExPR0lDVkNfRElTUExBWV9JTlRFUkZB
Q0VfTFZEU18zQklUUzoKKwkJcmV0dXJuIERSTV9NT0RFX0NPTk5FQ1RPUl9MVkRTOworCWNhc2Ug
TE9HSUNWQ19ESVNQTEFZX0lOVEVSRkFDRV9EVkk6CisJCXJldHVybiBEUk1fTU9ERV9DT05ORUNU
T1JfRFZJRDsKKwljYXNlIExPR0lDVkNfRElTUExBWV9JTlRFUkZBQ0VfUkdCOgorCQlyZXR1cm4g
RFJNX01PREVfQ09OTkVDVE9SX0RQSTsKKwlkZWZhdWx0OgorCQlyZXR1cm4gRFJNX01PREVfQ09O
TkVDVE9SX1Vua25vd247CisJfQorfQorCitzdGF0aWMgYm9vbCBsb2dpY3ZjX2ludGVyZmFjZV9u
YXRpdmVfY29ubmVjdG9yKHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YykKK3sKKwlzd2l0Y2gg
KGxvZ2ljdmMtPmNvbmZpZy5kaXNwbGF5X2ludGVyZmFjZSkgeworCWNhc2UgTE9HSUNWQ19ESVNQ
TEFZX0lOVEVSRkFDRV9EVkk6CisJCXJldHVybiB0cnVlOworCWRlZmF1bHQ6CisJCXJldHVybiBm
YWxzZTsKKwl9Cit9CisKK3ZvaWQgbG9naWN2Y19pbnRlcmZhY2VfYXR0YWNoX2NydGMoc3RydWN0
IGxvZ2ljdmNfZHJtICpsb2dpY3ZjKQoreworCXVpbnQzMl90IHBvc3NpYmxlX2NydGNzID0gZHJt
X2NydGNfbWFzaygmbG9naWN2Yy0+Y3J0Yy0+ZHJtX2NydGMpOworCisJbG9naWN2Yy0+aW50ZXJm
YWNlLT5kcm1fZW5jb2Rlci5wb3NzaWJsZV9jcnRjcyA9IHBvc3NpYmxlX2NydGNzOworfQorCitp
bnQgbG9naWN2Y19pbnRlcmZhY2VfaW5pdChzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMpCit7
CisJc3RydWN0IGxvZ2ljdmNfaW50ZXJmYWNlICppbnRlcmZhY2U7CisJc3RydWN0IGRldmljZV9u
b2RlICpvZl9ub2RlID0gbG9naWN2Yy0+ZHJtLT5kZXYtPm9mX25vZGU7CisJaW50IGVuY29kZXJf
dHlwZSA9IGxvZ2ljdmNfaW50ZXJmYWNlX2VuY29kZXJfdHlwZShsb2dpY3ZjKTsKKwlpbnQgY29u
bmVjdG9yX3R5cGUgPSBsb2dpY3ZjX2ludGVyZmFjZV9jb25uZWN0b3JfdHlwZShsb2dpY3ZjKTsK
Kwlib29sIG5hdGl2ZV9jb25uZWN0b3IgPSBsb2dpY3ZjX2ludGVyZmFjZV9uYXRpdmVfY29ubmVj
dG9yKGxvZ2ljdmMpOworCWludCByZXQ7CisKKwlpbnRlcmZhY2UgPSBkZXZtX2t6YWxsb2MobG9n
aWN2Yy0+ZHJtLT5kZXYsIHNpemVvZigqaW50ZXJmYWNlKSwKKwkJCQkgR0ZQX0tFUk5FTCk7CisJ
aWYgKCFpbnRlcmZhY2UpIHsKKwkJcmV0ID0gLUVOT01FTTsKKwkJZ290byBlcnJvcl9lYXJseTsK
Kwl9CisKKwlpbnRlcmZhY2UtPmxvZ2ljdmMgPSBsb2dpY3ZjOworCisJcmV0ID0gZHJtX29mX2Zp
bmRfcGFuZWxfb3JfYnJpZGdlKG9mX25vZGUsIDEsIDAsICZpbnRlcmZhY2UtPmRybV9wYW5lbCwK
KwkJCQkJICAmaW50ZXJmYWNlLT5kcm1fYnJpZGdlKTsKKwlpZiAocmV0ID09IC1FUFJPQkVfREVG
RVIpCisJCWdvdG8gZXJyb3JfZWFybHk7CisKKwlyZXQgPSBkcm1fZW5jb2Rlcl9pbml0KGxvZ2lj
dmMtPmRybSwgJmludGVyZmFjZS0+ZHJtX2VuY29kZXIsCisJCQkgICAgICAgJmxvZ2ljdmNfZW5j
b2Rlcl9mdW5jcywgZW5jb2Rlcl90eXBlLCBOVUxMKTsKKwlpZiAocmV0KSB7CisJCURSTV9FUlJP
UigiRmFpbGVkIHRvIGluaXRhbGl6ZSBlbmNvZGVyXG4iKTsKKwkJZ290byBlcnJvcl9lYXJseTsK
Kwl9CisKKwlkcm1fZW5jb2Rlcl9oZWxwZXJfYWRkKCZpbnRlcmZhY2UtPmRybV9lbmNvZGVyLAor
CQkJICAgICAgICZsb2dpY3ZjX2VuY29kZXJfaGVscGVyX2Z1bmNzKTsKKworCWlmIChuYXRpdmVf
Y29ubmVjdG9yIHx8IGludGVyZmFjZS0+ZHJtX3BhbmVsKSB7CisJCXJldCA9IGRybV9jb25uZWN0
b3JfaW5pdChsb2dpY3ZjLT5kcm0sCisJCQkJCSAmaW50ZXJmYWNlLT5kcm1fY29ubmVjdG9yLAor
CQkJCQkgJmxvZ2ljdmNfY29ubmVjdG9yX2Z1bmNzLAorCQkJCQkgY29ubmVjdG9yX3R5cGUpOwor
CQlpZiAocmV0KSB7CisJCQlEUk1fRVJST1IoIkZhaWxlZCB0byBpbml0YWxpemUgY29ubmVjdG9y
XG4iKTsKKwkJCWdvdG8gZXJyb3JfZW5jb2RlcjsKKwkJfQorCisJCWRybV9jb25uZWN0b3JfaGVs
cGVyX2FkZCgmaW50ZXJmYWNlLT5kcm1fY29ubmVjdG9yLAorCQkJCQkgJmxvZ2ljdmNfY29ubmVj
dG9yX2hlbHBlcl9mdW5jcyk7CisKKwkJcmV0ID0gZHJtX2Nvbm5lY3Rvcl9hdHRhY2hfZW5jb2Rl
cigmaW50ZXJmYWNlLT5kcm1fY29ubmVjdG9yLAorCQkJCQkJICAgJmludGVyZmFjZS0+ZHJtX2Vu
Y29kZXIpOworCQlpZiAocmV0KSB7CisJCQlEUk1fRVJST1IoIkZhaWxlZCB0byBhdHRhY2ggY29u
bmVjdG9yIHRvIGVuY29kZXJcbiIpOworCQkJZ290byBlcnJvcl9lbmNvZGVyOworCQl9CisJfQor
CisJaWYgKGludGVyZmFjZS0+ZHJtX3BhbmVsKSB7CisJCXJldCA9IGRybV9wYW5lbF9hdHRhY2go
aW50ZXJmYWNlLT5kcm1fcGFuZWwsCisJCQkJICAgICAgICZpbnRlcmZhY2UtPmRybV9jb25uZWN0
b3IpOworCQlpZiAocmV0KSB7CisJCQlEUk1fRVJST1IoIkZhaWxlZCB0byBhdHRhY2ggcGFuZWwg
dG8gY29ubmVjdG9yXG4iKTsKKwkJCWdvdG8gZXJyb3JfZW5jb2RlcjsKKwkJfQorCX0KKworCWlm
IChpbnRlcmZhY2UtPmRybV9icmlkZ2UpIHsKKwkJcmV0ID0gZHJtX2JyaWRnZV9hdHRhY2goJmlu
dGVyZmFjZS0+ZHJtX2VuY29kZXIsCisJCQkJCWludGVyZmFjZS0+ZHJtX2JyaWRnZSwgTlVMTCk7
CisJCWlmIChyZXQpIHsKKwkJCURSTV9FUlJPUigiRmFpbGVkIHRvIGF0dGFjaCBicmlkZ2UgdG8g
ZW5jb2RlclxuIik7CisJCQlnb3RvIGVycm9yX2VuY29kZXI7CisJCX0KKwl9CisKKwlsb2dpY3Zj
LT5pbnRlcmZhY2UgPSBpbnRlcmZhY2U7CisKKwlyZXR1cm4gMDsKKworZXJyb3JfZW5jb2RlcjoK
Kwlkcm1fZW5jb2Rlcl9jbGVhbnVwKCZpbnRlcmZhY2UtPmRybV9lbmNvZGVyKTsKKworZXJyb3Jf
ZWFybHk6CisJcmV0dXJuIHJldDsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb2dp
Y3ZjL2xvZ2ljdmNfaW50ZXJmYWNlLmggYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3Zj
X2ludGVyZmFjZS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uZDI3
YWJmZmY5MjlmCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9n
aWN2Y19pbnRlcmZhY2UuaApAQCAtMCwwICsxLDMyIEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRp
ZmllcjogR1BMLTIuMCsgKi8KKy8qCisgKiBDb3B5cmlnaHQgKEMpIDIwMTkgQm9vdGxpbgorICog
QXV0aG9yOiBQYXVsIEtvY2lhbGtvd3NraSA8cGF1bC5rb2NpYWxrb3dza2lAYm9vdGxpbi5jb20+
CisgKi8KKworI2lmbmRlZiBfTE9HSUNWQ19JTlRFUkZBQ0VfSF8KKyNkZWZpbmUgX0xPR0lDVkNf
SU5URVJGQUNFX0hfCisKKyNpbmNsdWRlIDxkcm0vZHJtX2JyaWRnZS5oPgorI2luY2x1ZGUgPGRy
bS9kcm1fY29ubmVjdG9yLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9lbmNvZGVyLmg+CisjaW5jbHVk
ZSA8ZHJtL2RybV9wYW5lbC5oPgorCitzdHJ1Y3QgbG9naWN2Y19kcm07CisKK3N0cnVjdCBsb2dp
Y3ZjX2ludGVyZmFjZSB7CisJc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjOworCisJc3RydWN0
IGRybV9lbmNvZGVyIGRybV9lbmNvZGVyOworCXN0cnVjdCBkcm1fY29ubmVjdG9yIGRybV9jb25u
ZWN0b3I7CisKKwlzdHJ1Y3QgZHJtX3BhbmVsICpkcm1fcGFuZWw7CisJc3RydWN0IGRybV9icmlk
Z2UgKmRybV9icmlkZ2U7CisKKwlib29sIGRybV9wYW5lbF9lbmFibGVkOworfTsKKwordm9pZCBs
b2dpY3ZjX2ludGVyZmFjZV9hdHRhY2hfY3J0YyhzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMp
OworaW50IGxvZ2ljdmNfaW50ZXJmYWNlX2luaXQoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3Zj
KTsKKworI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3Zj
X2xheWVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2xheWVyLmMKbmV3IGZp
bGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5jN2IwOTJkNTkyYWQKLS0tIC9kZXYv
bnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2xheWVyLmMKQEAgLTAs
MCArMSw1OTQgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wKworLyoKKyAq
IENvcHlyaWdodCAoQykgMjAxOSBCb290bGluCisgKiBBdXRob3I6IFBhdWwgS29jaWFsa293c2tp
IDxwYXVsLmtvY2lhbGtvd3NraUBib290bGluLmNvbT4KKyAqLworCisjaW5jbHVkZSA8bGludXgv
b2YuaD4KKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgorI2luY2x1ZGUgPGRybS9kcm1fYXRvbWlj
Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2Ry
bV9mYl9jbWFfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9mb3VyY2MuaD4KKyNpbmNsdWRl
IDxkcm0vZHJtX3BsYW5lLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wbGFuZV9oZWxwZXIuaD4KKyNp
bmNsdWRlIDxkcm0vZHJtX3ByaW50Lmg+CisKKyNpbmNsdWRlICJsb2dpY3ZjX2NydGMuaCIKKyNp
bmNsdWRlICJsb2dpY3ZjX2RybS5oIgorI2luY2x1ZGUgImxvZ2ljdmNfbGF5ZXIuaCIKKyNpbmNs
dWRlICJsb2dpY3ZjX29mLmgiCisjaW5jbHVkZSAibG9naWN2Y19yZWdzLmgiCisKKyNkZWZpbmUg
bG9naWN2Y19sYXllcihwKSBcCisJY29udGFpbmVyX29mKHAsIHN0cnVjdCBsb2dpY3ZjX2xheWVy
LCBkcm1fcGxhbmUpCisKK3N0YXRpYyB1aW50MzJfdCBsb2dpY3ZjX2xheWVyX2Zvcm1hdHNfcmdi
MTZbXSA9IHsKKwlEUk1fRk9STUFUX1JHQjU2NSwKKwlEUk1fRk9STUFUX0JHUjU2NSwKKwlEUk1f
Rk9STUFUX0lOVkFMSUQsCit9OworCitzdGF0aWMgdWludDMyX3QgbG9naWN2Y19sYXllcl9mb3Jt
YXRzX3JnYjI0W10gPSB7CisJRFJNX0ZPUk1BVF9YUkdCODg4OCwKKwlEUk1fRk9STUFUX1hCR1I4
ODg4LAorCURSTV9GT1JNQVRfSU5WQUxJRCwKK307CisKKy8qIFdoYXQgd2UgY2FsbCBkZXB0aCBp
biB0aGlzIGRyaXZlciBvbmx5IGNvdW50cyBjb2xvciBjb21wb25lbnRzLCBub3QgYWxwaGEuCisg
KiBUaGlzIGFsbG93cyB1cyB0byBzdGF5IGNvbXBhdGlibGUgd2l0aCB0aGUgTG9naUNWQyBiaXN0
cmVhbSBkZWZpbml0aW9ucy4gKi8KK3N0YXRpYyB1aW50MzJfdCBsb2dpY3ZjX2xheWVyX2Zvcm1h
dHNfcmdiMjRfYWxwaGFbXSA9IHsKKwlEUk1fRk9STUFUX0FSR0I4ODg4LAorCURSTV9GT1JNQVRf
QUJHUjg4ODgsCisJRFJNX0ZPUk1BVF9JTlZBTElELAorfTsKKworc3RhdGljIHN0cnVjdCBsb2dp
Y3ZjX2xheWVyX2Zvcm1hdHMgbG9naWN2Y19sYXllcl9mb3JtYXRzW10gPSB7CisJeworCQkuY29s
b3JzcGFjZQk9IExPR0lDVkNfTEFZRVJfQ09MT1JTUEFDRV9SR0IsCisJCS5kZXB0aAkJPSAxNiwK
KwkJLmZvcm1hdHMJPSBsb2dpY3ZjX2xheWVyX2Zvcm1hdHNfcmdiMTYsCisJfSwKKwl7CisJCS5j
b2xvcnNwYWNlCT0gTE9HSUNWQ19MQVlFUl9DT0xPUlNQQUNFX1JHQiwKKwkJLmRlcHRoCQk9IDI0
LAorCQkuZm9ybWF0cwk9IGxvZ2ljdmNfbGF5ZXJfZm9ybWF0c19yZ2IyNCwKKwl9LAorCXsKKwkJ
LmNvbG9yc3BhY2UJPSBMT0dJQ1ZDX0xBWUVSX0NPTE9SU1BBQ0VfUkdCLAorCQkuZGVwdGgJCT0g
MjQsCisJCS5hbHBoYQkJPSB0cnVlLAorCQkuZm9ybWF0cwk9IGxvZ2ljdmNfbGF5ZXJfZm9ybWF0
c19yZ2IyNF9hbHBoYSwKKwl9LAorCXsgfQorfTsKKworc3RhdGljIGJvb2wgbG9naWN2Y19sYXll
cl9mb3JtYXRfaW52ZXJ0ZWQodWludDMyX3QgZm9ybWF0KQoreworCXN3aXRjaCAoZm9ybWF0KSB7
CisJY2FzZSBEUk1fRk9STUFUX0JHUjU2NToKKwljYXNlIERSTV9GT1JNQVRfQkdSODg4OgorCWNh
c2UgRFJNX0ZPUk1BVF9YQkdSODg4ODoKKwljYXNlIERSTV9GT1JNQVRfQUJHUjg4ODg6CisJCXJl
dHVybiB0cnVlOworCWRlZmF1bHQ6CisJCXJldHVybiBmYWxzZTsKKwl9Cit9CisKK3N0YXRpYyBp
bnQgbG9naWN2Y19wbGFuZV9hdG9taWNfY2hlY2soc3RydWN0IGRybV9wbGFuZSAqZHJtX3BsYW5l
LAorCQkJCSAgICAgIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnN0YXRlKQoreworCXN0cnVjdCBs
b2dpY3ZjX2xheWVyICpsYXllciA9IGxvZ2ljdmNfbGF5ZXIoZHJtX3BsYW5lKTsKKwlzdHJ1Y3Qg
bG9naWN2Y19kcm0gKmxvZ2ljdmMgPSBsYXllci0+bG9naWN2YzsKKwlzdHJ1Y3QgZHJtX2NydGNf
c3RhdGUgKmNydGNfc3RhdGU7CisJaW50IG1pbl9zY2FsZSwgbWF4X3NjYWxlOworCWJvb2wgY2Fu
X3Bvc2l0aW9uOworCWludCByZXQ7CisKKwlpZiAoIXN0YXRlLT5jcnRjKQorCQlyZXR1cm4gMDsK
KworCWNydGNfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9leGlzdGluZ19jcnRjX3N0YXRlKHN0YXRl
LT5zdGF0ZSwKKwkJCQkJCQlzdGF0ZS0+Y3J0Yyk7CisJaWYgKFdBUk5fT04oIWNydGNfc3RhdGUp
KQorCQlyZXR1cm4gLUVJTlZBTDsKKworCWlmIChzdGF0ZS0+Y3J0Y194IDwgMCB8fCBzdGF0ZS0+
Y3J0Y195IDwgMCkgeworCQlEUk1fRVJST1IoIk5lZ2F0aXZlIG9uLUNSVEMgcG9zaXRpb25zIGFy
ZSBub3Qgc3VwcG9ydGVkLlxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCWlmICghbG9n
aWN2Yy0+Y2Fwcy0+bGF5ZXJfYWRkcmVzcykgeworCQlyZXQgPSBsb2dpY3ZjX2xheWVyX2J1ZmZl
cl9maW5kX3NldHVwKGxheWVyLCBzdGF0ZSwgTlVMTCk7CisJCWlmIChyZXQpIHsKKwkJCURSTV9F
UlJPUigiTm8gdmlhYmxlIHNldHVwIGZvciBidWZmZXIgZm91bmQuXG4iKTsKKwkJCXJldHVybiBy
ZXQ7CisJCX0KKwl9CisKKwltaW5fc2NhbGUgPSBEUk1fUExBTkVfSEVMUEVSX05PX1NDQUxJTkc7
CisJbWF4X3NjYWxlID0gRFJNX1BMQU5FX0hFTFBFUl9OT19TQ0FMSU5HOworCisJY2FuX3Bvc2l0
aW9uID0gKGRybV9wbGFuZS0+dHlwZSA9PSBEUk1fUExBTkVfVFlQRV9PVkVSTEFZICYmCisJCQls
YXllci0+aW5kZXggIT0gKGxvZ2ljdmMtPmNvbmZpZy5sYXllcnNfY291bnQgLSAxKSAmJgorCQkJ
bG9naWN2Yy0+Y29uZmlnLmxheWVyc19jb25maWd1cmFibGUpOworCisJcmV0ID0gZHJtX2F0b21p
Y19oZWxwZXJfY2hlY2tfcGxhbmVfc3RhdGUoc3RhdGUsIGNydGNfc3RhdGUsCisJCQkJCQkgIG1p
bl9zY2FsZSwgbWF4X3NjYWxlLAorCQkJCQkJICBjYW5fcG9zaXRpb24sIHRydWUpOworCWlmIChy
ZXQpIHsKKwkJRFJNX0VSUk9SKCJJbnZhbGlkIHBsYW5lIHN0YXRlXG5cbiIpOworCQlyZXR1cm4g
cmV0OworCX0KKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBsb2dpY3ZjX3BsYW5lX2F0
b21pY191cGRhdGUoc3RydWN0IGRybV9wbGFuZSAqZHJtX3BsYW5lLAorCQkJCQlzdHJ1Y3QgZHJt
X3BsYW5lX3N0YXRlICpvbGRfc3RhdGUpCit7CisJc3RydWN0IGxvZ2ljdmNfbGF5ZXIgKmxheWVy
ID0gbG9naWN2Y19sYXllcihkcm1fcGxhbmUpOworCXN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2
YyA9IGxheWVyLT5sb2dpY3ZjOworCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnN0YXRlID0gZHJt
X3BsYW5lLT5zdGF0ZTsKKwlzdHJ1Y3QgZHJtX2NydGMgKmRybV9jcnRjID0gJmxvZ2ljdmMtPmNy
dGMtPmRybV9jcnRjOworCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlID0gJmRybV9jcnRj
LT5zdGF0ZS0+YWRqdXN0ZWRfbW9kZTsKKwlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHN0
YXRlLT5mYjsKKwlzdHJ1Y3QgbG9naWN2Y19sYXllcl9idWZmZXJfc2V0dXAgc2V0dXAgPSB7fTsK
Kwl1MzIgaW5kZXggPSBsYXllci0+aW5kZXg7CisJdTMyIHJlZzsKKworCS8qIExheWVyIGRpbWVu
c2lvbnMgKi8KKworCXJlZ21hcF93cml0ZShsb2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNfTEFZRVJf
V0lEVEhfUkVHKGluZGV4KSwKKwkJICAgICBzdGF0ZS0+Y3J0Y193IC0gMSk7CisJcmVnbWFwX3dy
aXRlKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNWQ19MQVlFUl9IRUlHSFRfUkVHKGluZGV4KSwKKwkJ
ICAgICBzdGF0ZS0+Y3J0Y19oIC0gMSk7CisKKwlpZiAobG9naWN2Yy0+Y2Fwcy0+bGF5ZXJfYWRk
cmVzcykgeworCQlwaHlzX2FkZHJfdCBmYl9hZGRyID0gZHJtX2ZiX2NtYV9nZXRfZ2VtX2FkZHIo
ZmIsIHN0YXRlLCAwKTsKKworCQlyZWdtYXBfd3JpdGUobG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZD
X0xBWUVSX0FERFJFU1NfUkVHKGluZGV4KSwKKwkJCSAgICAgZmJfYWRkcik7CisJfSBlbHNlIHsK
KwkJLyogUmVseSBvbiBvZmZzZXRzIHRvIGNvbmZpZ3VyZSB0aGUgYWRkcmVzcy4gKi8KKworCQls
b2dpY3ZjX2xheWVyX2J1ZmZlcl9maW5kX3NldHVwKGxheWVyLCBzdGF0ZSwgJnNldHVwKTsKKwor
CQkvKiBMYXllciBtZW1vcnkgb2Zmc2V0cyAqLworCisJCXJlZ21hcF93cml0ZShsb2dpY3ZjLT5y
ZWdtYXAsIExPR0lDVkNfQlVGRkVSX1NFTF9SRUcsCisJCQkgICAgIExPR0lDVkNfQlVGRkVSX1NF
TF9WQUxVRShpbmRleCwgc2V0dXAuYnVmZmVyX3NlbCkpOworCQlyZWdtYXBfd3JpdGUobG9naWN2
Yy0+cmVnbWFwLCBMT0dJQ1ZDX0xBWUVSX0hPRkZTRVRfUkVHKGluZGV4KSwKKwkJCSAgICAgc2V0
dXAuaG9mZnNldCk7CisJCXJlZ21hcF93cml0ZShsb2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNfTEFZ
RVJfVk9GRlNFVF9SRUcoaW5kZXgpLAorCQkJICAgICBzZXR1cC52b2Zmc2V0KTsKKwl9CisKKwkv
KiBMYXllciBwb3NpdGlvbiAqLworCisJcmVnbWFwX3dyaXRlKGxvZ2ljdmMtPnJlZ21hcCwgTE9H
SUNWQ19MQVlFUl9IUE9TSVRJT05fUkVHKGluZGV4KSwKKwkJICAgICBtb2RlLT5oZGlzcGxheSAt
IDEgLSBzdGF0ZS0+Y3J0Y194KTsKKworCS8qIFZlcnRpY2FsIHBvc2l0aW9uIG11c3QgYmUgc2V0
IGxhc3QgdG8gc3luYyBsYXllciByZWdpc3RlciBjaGFuZ2VzLiAqLworCXJlZ21hcF93cml0ZShs
b2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNfTEFZRVJfVlBPU0lUSU9OX1JFRyhpbmRleCksCisJCSAg
ICAgbW9kZS0+dmRpc3BsYXkgLSAxIC0gc3RhdGUtPmNydGNfeSk7CisKKwkvKiBMYXllciBhbHBo
YSAqLworCisJaWYgKGxheWVyLT5jb25maWcuYWxwaGFfbW9kZSA9PSBMT0dJQ1ZDX0xBWUVSX0FM
UEhBX0xBWUVSKSB7CisJCXUzMiBhbHBoYV9iaXRzOworCQl1MzIgYWxwaGFfbWF4OworCQl1MzIg
YWxwaGE7CisKKwkJc3dpdGNoIChsYXllci0+Y29uZmlnLmRlcHRoKSB7CisJCWNhc2UgODoKKwkJ
CWFscGhhX2JpdHMgPSAzOworCQkJYnJlYWs7CisJCWNhc2UgMTY6CisJCQlpZiAobGF5ZXItPmNv
bmZpZy5jb2xvcnNwYWNlID09IExPR0lDVkNfTEFZRVJfQ09MT1JTUEFDRV9ZVVYpCisJCQkJYWxw
aGFfYml0cyA9IDg7CisJCQllbHNlCisJCQkJYWxwaGFfYml0cyA9IDY7CisJCQlicmVhazsKKwkJ
ZGVmYXVsdDoKKwkJCWFscGhhX2JpdHMgPSA4OworCQkJYnJlYWs7CisJCX0KKworCQlhbHBoYV9t
YXggPSBCSVQoYWxwaGFfYml0cykgLSAxOworCQlhbHBoYSA9IHN0YXRlLT5hbHBoYSAqIGFscGhh
X21heCAvIERSTV9CTEVORF9BTFBIQV9PUEFRVUU7CisKKwkJRFJNX0RFQlVHX0RSSVZFUigiU2V0
dGluZyBsYXllciAlZCBhbHBoYSB0byAlZC8lZFxuIiwgaW5kZXgsCisJCQkJIGFscGhhLCBhbHBo
YV9tYXgpOworCisJCXJlZ21hcF93cml0ZShsb2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNfTEFZRVJf
QUxQSEFfUkVHKGluZGV4KSwKKwkJCSAgICAgYWxwaGEpOworCX0KKworCS8qIExheWVyIGNvbnRy
b2wgKi8KKworCXJlZyA9IExPR0lDVkNfTEFZRVJfQ1RSTF9FTkFCTEU7CisKKwlpZiAobG9naWN2
Y19sYXllcl9mb3JtYXRfaW52ZXJ0ZWQoZmItPmZvcm1hdC0+Zm9ybWF0KSkKKwkJcmVnIHw9IExP
R0lDVkNfTEFZRVJfQ1RSTF9QSVhFTF9GT1JNQVRfSU5WRVJUOworCisJcmVnIHw9IExPR0lDVkNf
TEFZRVJfQ1RSTF9DT0xPUl9LRVlfRElTQUJMRTsKKworCXJlZ21hcF93cml0ZShsb2dpY3ZjLT5y
ZWdtYXAsIExPR0lDVkNfTEFZRVJfQ1RSTF9SRUcoaW5kZXgpLCByZWcpOworfQorCitzdGF0aWMg
dm9pZCBsb2dpY3ZjX3BsYW5lX2F0b21pY19kaXNhYmxlKHN0cnVjdCBkcm1fcGxhbmUgKmRybV9w
bGFuZSwKKwkJCQkJIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9sZF9zdGF0ZSkKK3sKKwlzdHJ1
Y3QgbG9naWN2Y19sYXllciAqbGF5ZXIgPSBsb2dpY3ZjX2xheWVyKGRybV9wbGFuZSk7CisJc3Ry
dWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjID0gbGF5ZXItPmxvZ2ljdmM7CisJdTMyIGluZGV4ID0g
bGF5ZXItPmluZGV4OworCisJcmVnbWFwX3dyaXRlKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNWQ19M
QVlFUl9DVFJMX1JFRyhpbmRleCksIDApOworfQorCitzdGF0aWMgc3RydWN0IGRybV9wbGFuZV9o
ZWxwZXJfZnVuY3MgbG9naWN2Y19wbGFuZV9oZWxwZXJfZnVuY3MgPSB7CisJLmF0b21pY19jaGVj
awkJPSBsb2dpY3ZjX3BsYW5lX2F0b21pY19jaGVjaywKKwkuYXRvbWljX3VwZGF0ZQkJPSBsb2dp
Y3ZjX3BsYW5lX2F0b21pY191cGRhdGUsCisJLmF0b21pY19kaXNhYmxlCQk9IGxvZ2ljdmNfcGxh
bmVfYXRvbWljX2Rpc2FibGUsCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9wbGFuZV9m
dW5jcyBsb2dpY3ZjX3BsYW5lX2Z1bmNzID0geworCS51cGRhdGVfcGxhbmUJCT0gZHJtX2F0b21p
Y19oZWxwZXJfdXBkYXRlX3BsYW5lLAorCS5kaXNhYmxlX3BsYW5lCQk9IGRybV9hdG9taWNfaGVs
cGVyX2Rpc2FibGVfcGxhbmUsCisJLmRlc3Ryb3kJCT0gZHJtX3BsYW5lX2NsZWFudXAsCisJLnJl
c2V0CQkJPSBkcm1fYXRvbWljX2hlbHBlcl9wbGFuZV9yZXNldCwKKwkuYXRvbWljX2R1cGxpY2F0
ZV9zdGF0ZQk9IGRybV9hdG9taWNfaGVscGVyX3BsYW5lX2R1cGxpY2F0ZV9zdGF0ZSwKKwkuYXRv
bWljX2Rlc3Ryb3lfc3RhdGUJPSBkcm1fYXRvbWljX2hlbHBlcl9wbGFuZV9kZXN0cm95X3N0YXRl
LAorfTsKKworaW50IGxvZ2ljdmNfbGF5ZXJfYnVmZmVyX2ZpbmRfc2V0dXAoc3RydWN0IGxvZ2lj
dmNfbGF5ZXIgKmxheWVyLAorCQkJCSAgICBzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpzdGF0ZSwK
KwkJCQkgICAgc3RydWN0IGxvZ2ljdmNfbGF5ZXJfYnVmZmVyX3NldHVwICpzZXR1cCkKK3sKKwlz
dHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMgPSBsYXllci0+bG9naWN2YzsKKwlzdHJ1Y3QgZHJt
X2ZyYW1lYnVmZmVyICpmYiA9IHN0YXRlLT5mYjsKKwkvKiBBbGwgdGhlIHN1cHBvcnRlZCBmb3Jt
YXRzIGhhdmUgYSBzaW5nbGUgZGF0YSBwbGFuZS4gKi8KKwl1MzIgbGF5ZXJfYnl0ZXNwcCA9IGZi
LT5mb3JtYXQtPmNwcFswXTsKKwl1MzIgbGF5ZXJfc3RyaWRlID0gbGF5ZXJfYnl0ZXNwcCAqIGxv
Z2ljdmMtPmNvbmZpZy5yb3dfc3RyaWRlOworCXUzMiBiYXNlX29mZnNldCA9IGxheWVyLT5jb25m
aWcuYmFzZV9vZmZzZXQgKiBsYXllcl9zdHJpZGU7CisJdTMyIGJ1ZmZlcl9vZmZzZXQgPSBsYXll
ci0+Y29uZmlnLmJ1ZmZlcl9vZmZzZXQgKiBsYXllcl9zdHJpZGU7CisJdTggYnVmZmVyX3NlbCA9
IDA7CisJdTE2IHZvZmZzZXQgPSAwOworCXUxNiBob2Zmc2V0ID0gMDsKKwlwaHlzX2FkZHJfdCBm
Yl9hZGRyOworCXUzMiBmYl9vZmZzZXQ7CisJdTMyIGdhcDsKKworCWlmICghbG9naWN2Yy0+cmVz
ZXJ2ZWRfbWVtX2Jhc2UpIHsKKwkJRFJNX0VSUk9SKCJObyByZXNlcnZlZCBtZW1vcnkgYmFzZSB3
YXMgcmVnaXN0ZXJlZCFcbiIpOworCQlyZXR1cm4gLUVOT01FTTsKKwl9CisKKwlmYl9hZGRyID0g
ZHJtX2ZiX2NtYV9nZXRfZ2VtX2FkZHIoZmIsIHN0YXRlLCAwKTsKKwlpZiAoZmJfYWRkciA8IGxv
Z2ljdmMtPnJlc2VydmVkX21lbV9iYXNlKSB7CisJCURSTV9FUlJPUigiRnJhbWVidWZmZXIgbWVt
b3J5IGJlbG93IHJlc2VydmVkIG1lbW9yeSBiYXNlIVxuIik7CisJCXJldHVybiAtRUlOVkFMOwor
CX0KKworCWZiX29mZnNldCA9ICh1MzIpIChmYl9hZGRyIC0gbG9naWN2Yy0+cmVzZXJ2ZWRfbWVt
X2Jhc2UpOworCisJaWYgKGZiX29mZnNldCA8IGJhc2Vfb2Zmc2V0KSB7CisJCURSTV9FUlJPUigi
RnJhbWVidWZmZXIgb2Zmc2V0IGJlbG93IGxheWVyIGJhc2Ugb2Zmc2V0IVxuIik7CisJCXJldHVy
biAtRUlOVkFMOworCX0KKworCWdhcCA9IGZiX29mZnNldCAtIGJhc2Vfb2Zmc2V0OworCisJLyog
VXNlIHRoZSBwb3NzaWJsZSB2aWRlbyBidWZmZXJzIHNlbGVjdGlvbi4gKi8KKwlpZiAoZ2FwICYm
IGJ1ZmZlcl9vZmZzZXQpIHsKKwkJYnVmZmVyX3NlbCA9IGdhcCAvIGJ1ZmZlcl9vZmZzZXQ7CisJ
CWlmIChidWZmZXJfc2VsID4gTE9HSUNWQ19CVUZGRVJfU0VMX01BWCkKKwkJCWJ1ZmZlcl9zZWwg
PSBMT0dJQ1ZDX0JVRkZFUl9TRUxfTUFYOworCisJCWdhcCAtPSBidWZmZXJfc2VsICogYnVmZmVy
X29mZnNldDsKKwl9CisKKwkvKiBVc2UgdGhlIHZlcnRpY2FsIG9mZnNldC4gKi8KKwlpZiAoZ2Fw
ICYmIGxheWVyX3N0cmlkZSAmJiBsb2dpY3ZjLT5jb25maWcubGF5ZXJzX2NvbmZpZ3VyYWJsZSkg
eworCQl2b2Zmc2V0ID0gZ2FwIC8gbGF5ZXJfc3RyaWRlOworCQlpZiAodm9mZnNldCA+IExPR0lD
VkNfTEFZRVJfVk9GRlNFVF9NQVgpCisJCQl2b2Zmc2V0ID0gTE9HSUNWQ19MQVlFUl9WT0ZGU0VU
X01BWDsKKworCQlnYXAgLT0gdm9mZnNldCAqIGxheWVyX3N0cmlkZTsKKwl9CisKKwkvKiBVc2Ug
dGhlIGhvcml6b250YWwgb2Zmc2V0LiAqLworCWlmIChnYXAgJiYgbGF5ZXJfYnl0ZXNwcCAmJiBs
b2dpY3ZjLT5jb25maWcubGF5ZXJzX2NvbmZpZ3VyYWJsZSkgeworCQlob2Zmc2V0ID0gZ2FwIC8g
bGF5ZXJfYnl0ZXNwcDsKKwkJaWYgKGhvZmZzZXQgPiBMT0dJQ1ZDX0RJTUVOU0lPTlNfTUFYKQor
CQkJaG9mZnNldCA9IExPR0lDVkNfRElNRU5TSU9OU19NQVg7CisKKwkJZ2FwIC09IGhvZmZzZXQg
KiBsYXllcl9ieXRlc3BwOworCX0KKworCWlmIChnYXApIHsKKwkJRFJNX0VSUk9SKCJVbmFibGUg
dG8gZmluZCBsYXllciAlZCBidWZmZXIgc2V0dXAgZm9yIDB4JXggYnl0ZSBnYXBcbiIsCisJCQkg
IGxheWVyLT5pbmRleCwgZmJfb2Zmc2V0IC0gYmFzZV9vZmZzZXQpOworCQlyZXR1cm4gLUVJTlZB
TDsKKwl9CisKKwlEUk1fREVCVUdfRFJJVkVSKCJGb3VuZCBsYXllciAlZCBidWZmZXIgc2V0dXAg
Zm9yIDB4JXggYnl0ZSBnYXA6XG4iLAorCQkJIGxheWVyLT5pbmRleCwgZmJfb2Zmc2V0IC0gYmFz
ZV9vZmZzZXQpOworCisJRFJNX0RFQlVHX0RSSVZFUigiLSBidWZmZXJfc2VsID0gMHgleCBjaHVu
a3Mgb2YgMHgleCBieXRlc1xuIiwKKwkJCSBidWZmZXJfc2VsLCBidWZmZXJfb2Zmc2V0KTsKKwlE
Uk1fREVCVUdfRFJJVkVSKCItIHZvZmZzZXQgPSAweCV4IGNodW5rcyBvZiAweCV4IGJ5dGVzXG4i
LCB2b2Zmc2V0LAorCQkJIGxheWVyX3N0cmlkZSk7CisJRFJNX0RFQlVHX0RSSVZFUigiLSBob2Zm
c2V0ID0gMHgleCBjaHVua3Mgb2YgMHgleCBieXRlc1xuIiwgaG9mZnNldCwKKwkJCSBsYXllcl9i
eXRlc3BwKTsKKworCWlmIChzZXR1cCkgeworCQlzZXR1cC0+YnVmZmVyX3NlbCA9IGJ1ZmZlcl9z
ZWw7CisJCXNldHVwLT52b2Zmc2V0ID0gdm9mZnNldDsKKwkJc2V0dXAtPmhvZmZzZXQgPSBob2Zm
c2V0OworCX0KKworCXJldHVybiAwOworfQorCitzdGF0aWMgc3RydWN0IGxvZ2ljdmNfbGF5ZXJf
Zm9ybWF0cyAqbG9naWN2Y19sYXllcl9mb3JtYXRzX2xvb2t1cChzdHJ1Y3QgbG9naWN2Y19sYXll
ciAqbGF5ZXIpCit7CisJYm9vbCBhbHBoYTsKKwl1bnNpZ25lZCBpbnQgaSA9IDA7CisKKwlhbHBo
YSA9IChsYXllci0+Y29uZmlnLmFscGhhX21vZGUgPT0gTE9HSUNWQ19MQVlFUl9BTFBIQV9QSVhF
TCk7CisKKwl3aGlsZSAobG9naWN2Y19sYXllcl9mb3JtYXRzW2ldLmZvcm1hdHMpIHsKKwkJaWYg
KGxvZ2ljdmNfbGF5ZXJfZm9ybWF0c1tpXS5jb2xvcnNwYWNlID09IGxheWVyLT5jb25maWcuY29s
b3JzcGFjZSAmJgorCQkgICAgbG9naWN2Y19sYXllcl9mb3JtYXRzW2ldLmRlcHRoID09IGxheWVy
LT5jb25maWcuZGVwdGggJiYKKwkJICAgIGxvZ2ljdmNfbGF5ZXJfZm9ybWF0c1tpXS5hbHBoYSA9
PSBhbHBoYSkKKwkJCXJldHVybiAmbG9naWN2Y19sYXllcl9mb3JtYXRzW2ldOworCisJCWkrKzsK
Kwl9CisKKwlyZXR1cm4gTlVMTDsKK30KKworc3RhdGljIHVuc2lnbmVkIGludCBsb2dpY3ZjX2xh
eWVyX2Zvcm1hdHNfY291bnQoc3RydWN0IGxvZ2ljdmNfbGF5ZXJfZm9ybWF0cyAqZm9ybWF0cykK
K3sKKwl1bnNpZ25lZCBpbnQgY291bnQgPSAwOworCisJd2hpbGUgKGZvcm1hdHMtPmZvcm1hdHNb
Y291bnRdICE9IERSTV9GT1JNQVRfSU5WQUxJRCkKKwkJY291bnQrKzsKKworCXJldHVybiBjb3Vu
dDsKK30KKworc3RhdGljIGludCBsb2dpY3ZjX2xheWVyX2NvbmZpZ19wYXJzZShzdHJ1Y3QgbG9n
aWN2Y19kcm0gKmxvZ2ljdmMsCisJCQkJICAgICAgc3RydWN0IGxvZ2ljdmNfbGF5ZXIgKmxheWVy
KQoreworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqb2Zfbm9kZSA9IGxheWVyLT5vZl9ub2RlOworCXN0
cnVjdCBsb2dpY3ZjX2xheWVyX2NvbmZpZyAqY29uZmlnID0gJmxheWVyLT5jb25maWc7CisJaW50
IHJldDsKKworCWxvZ2ljdmNfb2ZfcHJvcGVydHlfcGFyc2VfYm9vbChvZl9ub2RlLCAieHlsb24s
bGF5ZXItcHJpbWFyeSIsCisJCQkJICAgICAgICZjb25maWctPnByaW1hcnkpOworCisJcmV0ID0g
bG9naWN2Y19vZl9wcm9wZXJ0eV9wYXJzZV91MzIob2Zfbm9kZSwgInh5bG9uLGxheWVyLWNvbG9y
c3BhY2UiLAorCQkJCQkgICAgJmNvbmZpZy0+Y29sb3JzcGFjZSk7CisJaWYgKHJldCkKKwkJcmV0
dXJuIHJldDsKKworCXJldCA9IGxvZ2ljdmNfb2ZfcHJvcGVydHlfcGFyc2VfdTMyKG9mX25vZGUs
ICJ4eWxvbixsYXllci1kZXB0aCIsCisJCQkJCSAgICAmY29uZmlnLT5kZXB0aCk7CisJaWYgKHJl
dCkKKwkJcmV0dXJuIHJldDsKKworCXJldCA9IGxvZ2ljdmNfb2ZfcHJvcGVydHlfcGFyc2VfdTMy
KG9mX25vZGUsICJ4eWxvbixsYXllci1hbHBoYS1tb2RlIiwKKwkJCQkJICAgICZjb25maWctPmFs
cGhhX21vZGUpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwkvKiBNZW1vcnkgb2Zmc2V0
IGlzIG9ubHkgcmVsZXZhbnQgd2l0aG91dCBsYXllciBhZGRyZXNzIGNvbmZpZ3VyYXRpb24uICov
CisJaWYgKGxvZ2ljdmMtPmNhcHMtPmxheWVyX2FkZHJlc3MpCisJCXJldHVybiAwOworCisJcmV0
ID0gbG9naWN2Y19vZl9wcm9wZXJ0eV9wYXJzZV91MzIob2Zfbm9kZSwgInh5bG9uLGxheWVyLWJh
c2Utb2Zmc2V0IiwKKwkJCQkJICAgICZjb25maWctPmJhc2Vfb2Zmc2V0KTsKKwlpZiAocmV0KQor
CQlyZXR1cm4gcmV0OworCisJcmV0ID0gbG9naWN2Y19vZl9wcm9wZXJ0eV9wYXJzZV91MzIob2Zf
bm9kZSwgInh5bG9uLGxheWVyLWJ1ZmZlci1vZmZzZXQiLAorCQkJCQkgICAgJmNvbmZpZy0+YnVm
ZmVyX29mZnNldCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCXJldHVybiAwOworfQor
CitzdHJ1Y3QgbG9naWN2Y19sYXllciAqbG9naWN2Y19sYXllcl9nZXRfZnJvbV9pbmRleChzdHJ1
Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMsCisJCQkJCQkgICB1MzIgaW5kZXgpCit7CisJc3RydWN0
IGxvZ2ljdmNfbGF5ZXIgKmxheWVyOworCisJbGlzdF9mb3JfZWFjaF9lbnRyeShsYXllciwgJmxv
Z2ljdmMtPmxheWVyc19saXN0LCBsaXN0KQorCQlpZiAobGF5ZXItPmluZGV4ID09IGluZGV4KQor
CQkJcmV0dXJuIGxheWVyOworCisJcmV0dXJuIE5VTEw7Cit9CisKK3N0cnVjdCBsb2dpY3ZjX2xh
eWVyICpsb2dpY3ZjX2xheWVyX2dldF9mcm9tX3R5cGUoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dp
Y3ZjLAorCQkJCQkJICBlbnVtIGRybV9wbGFuZV90eXBlIHR5cGUpCit7CisJc3RydWN0IGxvZ2lj
dmNfbGF5ZXIgKmxheWVyOworCisJbGlzdF9mb3JfZWFjaF9lbnRyeShsYXllciwgJmxvZ2ljdmMt
PmxheWVyc19saXN0LCBsaXN0KQorCQlpZiAobGF5ZXItPmRybV9wbGFuZS50eXBlID09IHR5cGUp
CisJCQlyZXR1cm4gbGF5ZXI7CisKKwlyZXR1cm4gTlVMTDsKK30KKworc3RydWN0IGxvZ2ljdmNf
bGF5ZXIgKmxvZ2ljdmNfbGF5ZXJfZ2V0X3ByaW1hcnkoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dp
Y3ZjKQoreworCXJldHVybiBsb2dpY3ZjX2xheWVyX2dldF9mcm9tX3R5cGUobG9naWN2YywgRFJN
X1BMQU5FX1RZUEVfUFJJTUFSWSk7Cit9CisKK3N0YXRpYyBpbnQgbG9naWN2Y19sYXllcl9pbml0
KHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YywKKwkJCSAgICAgIHN0cnVjdCBkZXZpY2Vfbm9k
ZSAqb2Zfbm9kZSwgdTMyIGluZGV4KQoreworCXN0cnVjdCBsb2dpY3ZjX2xheWVyICpsYXllciA9
IE5VTEw7CisJc3RydWN0IGxvZ2ljdmNfbGF5ZXJfZm9ybWF0cyAqZm9ybWF0czsKKwl1bnNpZ25l
ZCBpbnQgZm9ybWF0c19jb3VudDsKKwllbnVtIGRybV9wbGFuZV90eXBlIHR5cGU7CisJdW5zaWdu
ZWQgaW50IHpwb3M7CisJaW50IHJldDsKKworCWxheWVyID0gZGV2bV9remFsbG9jKGxvZ2ljdmMt
PmRybS0+ZGV2LCBzaXplb2YoKmxheWVyKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFsYXllcikgewor
CQlyZXQgPSAtRU5PTUVNOworCQlnb3RvIGVycm9yOworCX0KKworCWxheWVyLT5sb2dpY3ZjID0g
bG9naWN2YzsKKwlsYXllci0+b2Zfbm9kZSA9IG9mX25vZGU7CisJbGF5ZXItPmluZGV4ID0gaW5k
ZXg7CisKKwlyZXQgPSBsb2dpY3ZjX2xheWVyX2NvbmZpZ19wYXJzZShsb2dpY3ZjLCBsYXllcik7
CisJaWYgKHJldCkgeworCQlEUk1fRVJST1IoIkZhaWxlZCB0byBwYXJzZSBjb25maWcgZm9yIGxh
eWVyICMlZFxuIiwgaW5kZXgpOworCQlnb3RvIGVycm9yOworCX0KKworCWZvcm1hdHMgPSBsb2dp
Y3ZjX2xheWVyX2Zvcm1hdHNfbG9va3VwKGxheWVyKTsKKwlpZiAoIWZvcm1hdHMpIHsKKwkJRFJN
X0VSUk9SKCJGYWlsZWQgdG8gbG9va3VwIGZvcm1hdHMgZm9yIGxheWVyICMlZFxuIiwgaW5kZXgp
OworCQlnb3RvIGVycm9yOworCX0KKworCWZvcm1hdHNfY291bnQgPSBsb2dpY3ZjX2xheWVyX2Zv
cm1hdHNfY291bnQoZm9ybWF0cyk7CisKKwkvKiBUaGUgZmluYWwgbGF5ZXIgY2FuIGJlIGNvbmZp
Z3VyZWQgYXMgYSBiYWNrZ3JvdW5kIGxheWVyLiAqLworCWlmIChsb2dpY3ZjLT5jb25maWcuYmFj
a2dyb3VuZF9sYXllciAmJgorCSAgICBpbmRleCA9PSAobG9naWN2Yy0+Y29uZmlnLmxheWVyc19j
b3VudCAtIDEpKSB7CisJCS8qIEEgemVybyB2YWx1ZSBmb3IgYmxhY2sgaXMgb25seSB2YWxpZCBm
b3IgUkdCLCBub3QgZm9yIFlVViwKKwkJICogc28gdGhpcyB3aWxsIG5lZWQgdG8gdGFrZSB0aGUg
Zm9ybWF0IGluIGFjY291bnQgZm9yIFlVVi4gKi8KKwkJdTMyIGJhY2tncm91bmQgPSAwOworCisJ
CURSTV9ERUJVR19EUklWRVIoIlVzaW5nIGxheWVyICMlZCBhcyBiYWNrZ3JvdW5kIGxheWVyXG4i
LAorCQkJCSBpbmRleCk7CisKKwkJcmVnbWFwX3dyaXRlKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNW
Q19CQUNLR1JPVU5EX0NPTE9SX1JFRywKKwkJCSAgICAgYmFja2dyb3VuZCk7CisKKwkJZGV2bV9r
ZnJlZShsb2dpY3ZjLT5kcm0tPmRldiwgbGF5ZXIpOworCisJCXJldHVybiAwOworCX0KKworCWlm
IChsYXllci0+Y29uZmlnLnByaW1hcnkpCisJCXR5cGUgPSBEUk1fUExBTkVfVFlQRV9QUklNQVJZ
OworCWVsc2UKKwkJdHlwZSA9IERSTV9QTEFORV9UWVBFX09WRVJMQVk7CisKKwlyZXQgPSBkcm1f
dW5pdmVyc2FsX3BsYW5lX2luaXQobG9naWN2Yy0+ZHJtLCAmbGF5ZXItPmRybV9wbGFuZSwgMCwK
KwkJCQkgICAgICAgJmxvZ2ljdmNfcGxhbmVfZnVuY3MsIGZvcm1hdHMtPmZvcm1hdHMsCisJCQkJ
ICAgICAgIGZvcm1hdHNfY291bnQsIE5VTEwsIHR5cGUsIE5VTEwpOworCWlmIChyZXQpIHsKKwkJ
RFJNX0VSUk9SKCJGYWlsZWQgdG8gaW5pdGlhbGl6ZSBsYXllciBwbGFuZVxuIik7CisJCXJldHVy
biByZXQ7CisJfQorCisJZHJtX3BsYW5lX2hlbHBlcl9hZGQoJmxheWVyLT5kcm1fcGxhbmUsICZs
b2dpY3ZjX3BsYW5lX2hlbHBlcl9mdW5jcyk7CisKKwl6cG9zID0gbG9naWN2Yy0+Y29uZmlnLmxh
eWVyc19jb3VudCAtIGluZGV4IC0gMTsKKwlEUk1fREVCVUdfRFJJVkVSKCJHaXZpbmcgbGF5ZXIg
IyVkIHpwb3MgJWRcbiIsIGluZGV4LCB6cG9zKTsKKworCWlmIChsYXllci0+Y29uZmlnLmFscGhh
X21vZGUgPT0gTE9HSUNWQ19MQVlFUl9BTFBIQV9MQVlFUikKKwkJZHJtX3BsYW5lX2NyZWF0ZV9h
bHBoYV9wcm9wZXJ0eSgmbGF5ZXItPmRybV9wbGFuZSk7CisKKwlkcm1fcGxhbmVfY3JlYXRlX3pw
b3NfaW1tdXRhYmxlX3Byb3BlcnR5KCZsYXllci0+ZHJtX3BsYW5lLCB6cG9zKTsKKworCURSTV9E
RUJVR19EUklWRVIoIlJlZ2lzdGVyaW5nIGxheWVyICMlZFxuIiwgaW5kZXgpOworCisJbGF5ZXIt
PmZvcm1hdHMgPSBmb3JtYXRzOworCisJbGlzdF9hZGRfdGFpbCgmbGF5ZXItPmxpc3QsICZsb2dp
Y3ZjLT5sYXllcnNfbGlzdCk7CisKKwlyZXR1cm4gMDsKKworZXJyb3I6CisJaWYgKGxheWVyKQor
CQlkZXZtX2tmcmVlKGxvZ2ljdmMtPmRybS0+ZGV2LCBsYXllcik7CisKKwlyZXR1cm4gcmV0Owor
fQorCitzdGF0aWMgdm9pZCBsb2dpY3ZjX2xheWVyX2Zpbmkoc3RydWN0IGxvZ2ljdmNfZHJtICps
b2dpY3ZjLAorCQkJICAgICAgIHN0cnVjdCBsb2dpY3ZjX2xheWVyICpsYXllcikKK3sKKwlsaXN0
X2RlbCgmbGF5ZXItPmxpc3QpOworCWRldm1fa2ZyZWUobG9naWN2Yy0+ZHJtLT5kZXYsIGxheWVy
KTsKK30KKwordm9pZCBsb2dpY3ZjX2xheWVyc19hdHRhY2hfY3J0YyhzdHJ1Y3QgbG9naWN2Y19k
cm0gKmxvZ2ljdmMpCit7CisJdWludDMyX3QgcG9zc2libGVfY3J0Y3MgPSBkcm1fY3J0Y19tYXNr
KCZsb2dpY3ZjLT5jcnRjLT5kcm1fY3J0Yyk7CisJc3RydWN0IGxvZ2ljdmNfbGF5ZXIgKmxheWVy
OworCisJbGlzdF9mb3JfZWFjaF9lbnRyeShsYXllciwgJmxvZ2ljdmMtPmxheWVyc19saXN0LCBs
aXN0KSB7CisJCWlmIChsYXllci0+ZHJtX3BsYW5lLnR5cGUgIT0gRFJNX1BMQU5FX1RZUEVfT1ZF
UkxBWSkKKwkJCWNvbnRpbnVlOworCisJCWxheWVyLT5kcm1fcGxhbmUucG9zc2libGVfY3J0Y3Mg
PSBwb3NzaWJsZV9jcnRjczsKKwl9Cit9CisKK2ludCBsb2dpY3ZjX2xheWVyc19pbml0KHN0cnVj
dCBsb2dpY3ZjX2RybSAqbG9naWN2YykKK3sKKwlzdHJ1Y3QgZGV2aWNlX25vZGUgKm9mX25vZGUg
PSBsb2dpY3ZjLT5kcm0tPmRldi0+b2Zfbm9kZTsKKwlzdHJ1Y3QgZGV2aWNlX25vZGUgKmxheWVy
X25vZGUgPSBOVUxMOworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqbGF5ZXJzX25vZGU7CisJc3RydWN0
IGxvZ2ljdmNfbGF5ZXIgKmxheWVyOworCXN0cnVjdCBsb2dpY3ZjX2xheWVyICpuZXh0OworCWlu
dCByZXQgPSAwOworCisJbGF5ZXJzX25vZGUgPSBvZl9nZXRfY2hpbGRfYnlfbmFtZShvZl9ub2Rl
LCAibGF5ZXJzIik7CisJaWYgKCFsYXllcnNfbm9kZSkgeworCQlEUk1fRVJST1IoIk5vIGxheWVy
cyBub2RlIGZvdW5kIGluIHRoZSBkZXNjcmlwdGlvblxuIik7CisJCXJldCA9IC1FTk9ERVY7CisJ
CWdvdG8gZXJyb3I7CisJfQorCisJZm9yX2VhY2hfY2hpbGRfb2Zfbm9kZShsYXllcnNfbm9kZSwg
bGF5ZXJfbm9kZSkgeworCQl1MzIgaW5kZXggPSAwOworCisJCWlmICghbG9naWN2Y19vZl9ub2Rl
X2lzX2xheWVyKGxheWVyX25vZGUpKQorCQkJY29udGludWU7CisKKwkJcmV0ID0gb2ZfcHJvcGVy
dHlfcmVhZF91MzIobGF5ZXJfbm9kZSwgInJlZyIsICZpbmRleCk7CisJCWlmIChyZXQpCisJCQlj
b250aW51ZTsKKworCQlsYXllciA9IGxvZ2ljdmNfbGF5ZXJfZ2V0X2Zyb21faW5kZXgobG9naWN2
YywgaW5kZXgpOworCQlpZiAobGF5ZXIpIHsKKwkJCURSTV9FUlJPUigiRHVwbGljYXRlZCBlbnRy
eSBmb3IgbGF5ZXIgIyVkXG4iLCBpbmRleCk7CisJCQljb250aW51ZTsKKwkJfQorCisJCXJldCA9
IGxvZ2ljdmNfbGF5ZXJfaW5pdChsb2dpY3ZjLCBsYXllcl9ub2RlLCBpbmRleCk7CisJCWlmIChy
ZXQpCisJCQlnb3RvIGVycm9yOworCisJCW9mX25vZGVfcHV0KGxheWVyX25vZGUpOworCX0KKwor
CW9mX25vZGVfcHV0KGxheWVyc19ub2RlKTsKKworCXJldHVybiAwOworCitlcnJvcjoKKwlsaXN0
X2Zvcl9lYWNoX2VudHJ5X3NhZmUobGF5ZXIsIG5leHQsICZsb2dpY3ZjLT5sYXllcnNfbGlzdCwg
bGlzdCkKKwkJbG9naWN2Y19sYXllcl9maW5pKGxvZ2ljdmMsIGxheWVyKTsKKworCXJldHVybiBy
ZXQ7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2xheWVy
LmggYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2xheWVyLmgKbmV3IGZpbGUgbW9k
ZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi43MWIzZjE3N2IwOTMKLS0tIC9kZXYvbnVsbAor
KysgYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2xheWVyLmgKQEAgLTAsMCArMSw2
NSBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjArICovCisvKgorICogQ29w
eXJpZ2h0IChDKSAyMDE5IEJvb3RsaW4KKyAqIEF1dGhvcjogUGF1bCBLb2NpYWxrb3dza2kgPHBh
dWwua29jaWFsa293c2tpQGJvb3RsaW4uY29tPgorICovCisKKyNpZm5kZWYgX0xPR0lDVkNfTEFZ
RVJfSF8KKyNkZWZpbmUgX0xPR0lDVkNfTEFZRVJfSF8KKworI2luY2x1ZGUgPGxpbnV4L29mLmg+
CisjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3BsYW5lLmg+CisK
KyNkZWZpbmUgTE9HSUNWQ19MQVlFUl9DT0xPUlNQQUNFX1JHQgkJMAorI2RlZmluZSBMT0dJQ1ZD
X0xBWUVSX0NPTE9SU1BBQ0VfWVVWCQkxCisKKyNkZWZpbmUgTE9HSUNWQ19MQVlFUl9BTFBIQV9M
QVlFUgkJMAorI2RlZmluZSBMT0dJQ1ZDX0xBWUVSX0FMUEhBX1BJWEVMCQkxCisKK3N0cnVjdCBs
b2dpY3ZjX2xheWVyX2J1ZmZlcl9zZXR1cCB7CisJdTggYnVmZmVyX3NlbDsKKwl1MTYgdm9mZnNl
dDsKKwl1MTYgaG9mZnNldDsKK307CisKK3N0cnVjdCBsb2dpY3ZjX2xheWVyX2NvbmZpZyB7CisJ
dTMyIGNvbG9yc3BhY2U7CisJdTMyIGRlcHRoOworCXUzMiBhbHBoYV9tb2RlOworCXUzMiBiYXNl
X29mZnNldDsKKwl1MzIgYnVmZmVyX29mZnNldDsKKwlib29sIHByaW1hcnk7Cit9OworCitzdHJ1
Y3QgbG9naWN2Y19sYXllcl9mb3JtYXRzIHsKKwl1MzIgY29sb3JzcGFjZTsKKwl1MzIgZGVwdGg7
CisJYm9vbCBhbHBoYTsKKwl1aW50MzJfdCAqZm9ybWF0czsKK307CisKK3N0cnVjdCBsb2dpY3Zj
X2xheWVyIHsKKwlzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmM7CisKKwlzdHJ1Y3QgbG9naWN2
Y19sYXllcl9jb25maWcgY29uZmlnOworCXN0cnVjdCBsb2dpY3ZjX2xheWVyX2Zvcm1hdHMgKmZv
cm1hdHM7CisJc3RydWN0IGRldmljZV9ub2RlICpvZl9ub2RlOworCisJc3RydWN0IGRybV9wbGFu
ZSBkcm1fcGxhbmU7CisJc3RydWN0IGxpc3RfaGVhZCBsaXN0OworCXUzMiBpbmRleDsKK307CisK
K2ludCBsb2dpY3ZjX2xheWVyX2J1ZmZlcl9maW5kX3NldHVwKHN0cnVjdCBsb2dpY3ZjX2xheWVy
ICpsYXllciwKKwkJCQkgICAgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqc3RhdGUsCisJCQkJICAg
IHN0cnVjdCBsb2dpY3ZjX2xheWVyX2J1ZmZlcl9zZXR1cCAqc2V0dXApOworc3RydWN0IGxvZ2lj
dmNfbGF5ZXIgKmxvZ2ljdmNfbGF5ZXJfZ2V0X2Zyb21faW5kZXgoc3RydWN0IGxvZ2ljdmNfZHJt
ICpsb2dpY3ZjLAorCQkJCQkJICAgdTMyIGluZGV4KTsKK3N0cnVjdCBsb2dpY3ZjX2xheWVyICps
b2dpY3ZjX2xheWVyX2dldF9mcm9tX3R5cGUoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjLAor
CQkJCQkJICBlbnVtIGRybV9wbGFuZV90eXBlIHR5cGUpOworc3RydWN0IGxvZ2ljdmNfbGF5ZXIg
KmxvZ2ljdmNfbGF5ZXJfZ2V0X3ByaW1hcnkoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjKTsK
K3ZvaWQgbG9naWN2Y19sYXllcnNfYXR0YWNoX2NydGMoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dp
Y3ZjKTsKK2ludCBsb2dpY3ZjX2xheWVyc19pbml0KHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2
Yyk7CisKKyNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2
Y19tb2RlLmMgYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX21vZGUuYwpuZXcgZmls
ZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjYwOTVkYTk3NWQ3YwotLS0gL2Rldi9u
dWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfbW9kZS5jCkBAIC0wLDAg
KzEsMTAzIEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCsKKy8qCisgKiBD
b3B5cmlnaHQgKEMpIDIwMTkgQm9vdGxpbgorICogQXV0aG9yOiBQYXVsIEtvY2lhbGtvd3NraSA8
cGF1bC5rb2NpYWxrb3dza2lAYm9vdGxpbi5jb20+CisgKi8KKworI2luY2x1ZGUgPGxpbnV4L3R5
cGVzLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWMuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2F0
b21pY19oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2NydGNfaGVscGVyLmg+CisjaW5jbHVk
ZSA8ZHJtL2RybV9kcnYuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2ZiX2NtYV9oZWxwZXIuaD4KKyNp
bmNsdWRlIDxkcm0vZHJtX2ZiX2hlbHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fZ2VtX2NtYV9o
ZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2dlbV9mcmFtZWJ1ZmZlcl9oZWxwZXIuaD4KKyNp
bmNsdWRlIDxkcm0vZHJtX21vZGVfY29uZmlnLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wYW5lbC5o
PgorI2luY2x1ZGUgPGRybS9kcm1fcHJpbnQuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3Byb2JlX2hl
bHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fdmJsYW5rLmg+CisKKyNpbmNsdWRlICJsb2dpY3Zj
X2RybS5oIgorI2luY2x1ZGUgImxvZ2ljdmNfaW50ZXJmYWNlLmgiCisjaW5jbHVkZSAibG9naWN2
Y19sYXllci5oIgorI2luY2x1ZGUgImxvZ2ljdmNfbW9kZS5oIgorCitzdGF0aWMgdm9pZCBsb2dp
Y3ZjX21vZGVfYXRvbWljX2NvbW1pdF90YWlsKHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpvbGRf
c3RhdGUpCit7CisJc3RydWN0IGRybV9kZXZpY2UgKmRybSA9IG9sZF9zdGF0ZS0+ZGV2OworCXN0
cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YyA9IGRybS0+ZGV2X3ByaXZhdGU7CisJc3RydWN0IGxv
Z2ljdmNfaW50ZXJmYWNlICppbnRlcmZhY2UgPSBsb2dpY3ZjLT5pbnRlcmZhY2U7CisKKwlkcm1f
YXRvbWljX2hlbHBlcl9jb21taXRfdGFpbChvbGRfc3RhdGUpOworCisJLyogRW5hYmxlIHRoZSBw
YW5lbCBhZnRlciB0aGUgZmlyc3QgY29tbWl0LCB3aGljaCBjb25jZXJucyBvdXIgcGFuZWwKKwkg
KiBzaW5jZSB3ZSBvbmx5IHN1cHBvcnQgYSBzaW5nbGUgaW50ZXJmYWNlLiAqLworCWlmIChpbnRl
cmZhY2UtPmRybV9wYW5lbCAmJiAhaW50ZXJmYWNlLT5kcm1fcGFuZWxfZW5hYmxlZCkgeworCQlk
cm1fcGFuZWxfZW5hYmxlKGludGVyZmFjZS0+ZHJtX3BhbmVsKTsKKwkJaW50ZXJmYWNlLT5kcm1f
cGFuZWxfZW5hYmxlZCA9IHRydWU7CisJfQorfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9t
b2RlX2NvbmZpZ19oZWxwZXJfZnVuY3MgbG9naWN2Y19tb2RlX2NvbmZpZ19oZWxwZXJfZnVuY3Mg
PSB7CisJLmF0b21pY19jb21taXRfdGFpbAk9IGxvZ2ljdmNfbW9kZV9hdG9taWNfY29tbWl0X3Rh
aWwsCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9tb2RlX2NvbmZpZ19mdW5jcyBsb2dp
Y3ZjX21vZGVfY29uZmlnX2Z1bmNzID0geworCS5mYl9jcmVhdGUJCT0gZHJtX2dlbV9mYl9jcmVh
dGUsCisJLm91dHB1dF9wb2xsX2NoYW5nZWQJPSBkcm1fZmJfaGVscGVyX291dHB1dF9wb2xsX2No
YW5nZWQsCisJLmF0b21pY19jaGVjawkJPSBkcm1fYXRvbWljX2hlbHBlcl9jaGVjaywKKwkuYXRv
bWljX2NvbW1pdAkJPSBkcm1fYXRvbWljX2hlbHBlcl9jb21taXQsCit9OworCitpbnQgbG9naWN2
Y19tb2RlX2luaXQoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjKQoreworCXN0cnVjdCBkcm1f
bW9kZV9jb25maWcgKm1vZGVfY29uZmlnID0gJmxvZ2ljdmMtPmRybS0+bW9kZV9jb25maWc7CisJ
c3RydWN0IGxvZ2ljdmNfbGF5ZXIgKmxheWVyX3ByaW1hcnk7CisJdWludDMyX3QgcHJlZmVycmVk
X2RlcHRoOworCWludCByZXQ7CisKKwlyZXQgPSBkcm1fdmJsYW5rX2luaXQobG9naWN2Yy0+ZHJt
LCBsb2dpY3ZjLT5kcm0tPm1vZGVfY29uZmlnLm51bV9jcnRjKTsKKwlpZiAocmV0KSB7CisJCURS
TV9FUlJPUigiRmFpbGVkIHRvIGluaXRpYWxpemUgdmJsYW5rXG4iKTsKKwkJcmV0dXJuIHJldDsK
Kwl9CisKKwlsYXllcl9wcmltYXJ5ID0gbG9naWN2Y19sYXllcl9nZXRfcHJpbWFyeShsb2dpY3Zj
KTsKKwlpZiAoIWxheWVyX3ByaW1hcnkpIHsKKwkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gZ2V0IHBy
aW1hcnkgbGF5ZXJcbiIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlwcmVmZXJyZWRfZGVw
dGggPSBsYXllcl9wcmltYXJ5LT5mb3JtYXRzLT5kZXB0aDsKKworCS8qIERSTSBjb3VudHMgYWxw
aGEgaW4gZGVwdGgsIG91ciBkcml2ZXIgZG9lc24ndC4gKi8KKwlpZiAobGF5ZXJfcHJpbWFyeS0+
Zm9ybWF0cy0+YWxwaGEpCisJCXByZWZlcnJlZF9kZXB0aCArPSA4OworCisJbW9kZV9jb25maWct
Pm1pbl93aWR0aCA9IDY0OworCW1vZGVfY29uZmlnLT5tYXhfd2lkdGggPSAyMDQ4OworCW1vZGVf
Y29uZmlnLT5taW5faGVpZ2h0ID0gMTsKKwltb2RlX2NvbmZpZy0+bWF4X2hlaWdodCA9IDIwNDg7
CisJbW9kZV9jb25maWctPnByZWZlcnJlZF9kZXB0aCA9IHByZWZlcnJlZF9kZXB0aDsKKwltb2Rl
X2NvbmZpZy0+ZnVuY3MgPSAmbG9naWN2Y19tb2RlX2NvbmZpZ19mdW5jczsKKwltb2RlX2NvbmZp
Zy0+aGVscGVyX3ByaXZhdGUgPSAmbG9naWN2Y19tb2RlX2NvbmZpZ19oZWxwZXJfZnVuY3M7CisK
Kwlkcm1fbW9kZV9jb25maWdfcmVzZXQobG9naWN2Yy0+ZHJtKTsKKworCXJldCA9IGRybV9mYmRl
dl9nZW5lcmljX3NldHVwKGxvZ2ljdmMtPmRybSwgcHJlZmVycmVkX2RlcHRoKTsKKwlpZiAocmV0
KSB7CisJCURSTV9FUlJPUigiRmFpbGVkIHRvIGluaXRpYWxpemUgZmJkZXZcbiIpOworCQlyZXR1
cm4gcmV0OworCX0KKworCWRybV9rbXNfaGVscGVyX3BvbGxfaW5pdChsb2dpY3ZjLT5kcm0pOwor
CisJcmV0dXJuIDA7Cit9CisKK3ZvaWQgbG9naWN2Y19tb2RlX2Zpbmkoc3RydWN0IGxvZ2ljdmNf
ZHJtICpsb2dpY3ZjKQoreworCWRybV9rbXNfaGVscGVyX3BvbGxfZmluaShsb2dpY3ZjLT5kcm0p
OworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19tb2RlLmgg
Yi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX21vZGUuaApuZXcgZmlsZSBtb2RlIDEw
MDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjY5MGRlZjE2MTlhNgotLS0gL2Rldi9udWxsCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfbW9kZS5oCkBAIC0wLDAgKzEsMTUgQEAK
Ky8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wKyAqLworLyoKKyAqIENvcHlyaWdo
dCAoQykgMjAxOSBCb290bGluCisgKiBBdXRob3I6IFBhdWwgS29jaWFsa293c2tpIDxwYXVsLmtv
Y2lhbGtvd3NraUBib290bGluLmNvbT4KKyAqLworCisjaWZuZGVmIF9MT0dJQ1ZDX01PREVfSF8K
KyNkZWZpbmUgX0xPR0lDVkNfTU9ERV9IXworCitzdHJ1Y3QgbG9naWN2Y19kcm07CisKK2ludCBs
b2dpY3ZjX21vZGVfaW5pdChzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMpOwordm9pZCBsb2dp
Y3ZjX21vZGVfZmluaShzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMpOworCisjZW5kaWYKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfb2YuYyBiL2RyaXZlcnMv
Z3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfb2YuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAw
MDAwMDAwMDAwMDAuLjE5YjdiYzVlYTU3MgotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9sb2dpY3ZjL2xvZ2ljdmNfb2YuYwpAQCAtMCwwICsxLDIwNSBAQAorLy8gU1BEWC1MaWNl
bnNlLUlkZW50aWZpZXI6IEdQTC0yLjArCisvKgorICogQ29weXJpZ2h0IChDKSAyMDE5IEJvb3Rs
aW4KKyAqIEF1dGhvcjogUGF1bCBLb2NpYWxrb3dza2kgPHBhdWwua29jaWFsa293c2tpQGJvb3Rs
aW4uY29tPgorICovCisKKyNpbmNsdWRlIDxkcm0vZHJtX3ByaW50Lmg+CisKKyNpbmNsdWRlICJs
b2dpY3ZjX2RybS5oIgorI2luY2x1ZGUgImxvZ2ljdmNfbGF5ZXIuaCIKKyNpbmNsdWRlICJsb2dp
Y3ZjX29mLmgiCisKK3N0YXRpYyBzdHJ1Y3QgbG9naWN2Y19vZl9wcm9wZXJ0eV9zdiBsb2dpY3Zj
X29mX2Rpc3BsYXlfaW50ZXJmYWNlX3N2W10gPSB7CisJeyAibHZkcy00Yml0cyIsCUxPR0lDVkNf
RElTUExBWV9JTlRFUkZBQ0VfTFZEU180QklUUyB9LAorCXsgImx2ZHMtM2JpdHMiLAlMT0dJQ1ZD
X0RJU1BMQVlfSU5URVJGQUNFX0xWRFNfM0JJVFMgfSwKKwl7IH0sCit9OworCitzdGF0aWMgc3Ry
dWN0IGxvZ2ljdmNfb2ZfcHJvcGVydHlfc3YgbG9naWN2Y19vZl9kaXNwbGF5X2NvbG9yc3BhY2Vf
c3ZbXSA9IHsKKwl7ICJyZ2IiLAlMT0dJQ1ZDX0RJU1BMQVlfQ09MT1JTUEFDRV9SR0IgfSwKKwl7
ICJ5dXY0MjIiLAlMT0dJQ1ZDX0RJU1BMQVlfQ09MT1JTUEFDRV9ZVVY0MjIgfSwKKwl7ICJ5dXY0
NDQiLAlMT0dJQ1ZDX0RJU1BMQVlfQ09MT1JTUEFDRV9ZVVY0NDQgfSwKKwl7IH0sCit9OworCitz
dGF0aWMgc3RydWN0IGxvZ2ljdmNfb2ZfcHJvcGVydHlfc3YgbG9naWN2Y19vZl9sYXllcl9jb2xv
cnNwYWNlX3N2W10gPSB7CisJeyAicmdiIiwJTE9HSUNWQ19MQVlFUl9DT0xPUlNQQUNFX1JHQiB9
LAorCXsgInl1diIsCUxPR0lDVkNfTEFZRVJfQ09MT1JTUEFDRV9ZVVYgfSwKKwl7IH0sCit9Owor
CitzdGF0aWMgc3RydWN0IGxvZ2ljdmNfb2ZfcHJvcGVydHlfc3YgbG9naWN2Y19vZl9sYXllcl9h
bHBoYV9tb2RlX3N2W10gPSB7CisJeyAibGF5ZXIiLAlMT0dJQ1ZDX0xBWUVSX0FMUEhBX0xBWUVS
IH0sCisJeyAicGl4ZWwiLAlMT0dJQ1ZDX0xBWUVSX0FMUEhBX1BJWEVMIH0sCisJeyB9LAorfTsK
Kworc3RhdGljIHN0cnVjdCBsb2dpY3ZjX29mX3Byb3BlcnR5IGxvZ2ljdmNfb2ZfcHJvcGVydGll
c1tdID0geworCXsKKwkJLm5hbWUJCT0gInh5bG9uLGRpc3BsYXktaW50ZXJmYWNlIiwKKwkJLnN2
CQk9IGxvZ2ljdmNfb2ZfZGlzcGxheV9pbnRlcmZhY2Vfc3YsCisJCS5yYW5nZQkJPSB7CisJCQlM
T0dJQ1ZDX0RJU1BMQVlfSU5URVJGQUNFX0xWRFNfNEJJVFMsCisJCQlMT0dJQ1ZDX0RJU1BMQVlf
SU5URVJGQUNFX0xWRFNfM0JJVFMsCisJCX0sCisJfSwKKwl7CisJCS5uYW1lCQk9ICJ4eWxvbixk
aXNwbGF5LWNvbG9yc3BhY2UiLAorCQkuc3YJCT0gbG9naWN2Y19vZl9kaXNwbGF5X2NvbG9yc3Bh
Y2Vfc3YsCisJCS5yYW5nZQkJPSB7CisJCQlMT0dJQ1ZDX0RJU1BMQVlfQ09MT1JTUEFDRV9SR0Is
CisJCQlMT0dJQ1ZDX0RJU1BMQVlfQ09MT1JTUEFDRV9ZVVY0NDQsCisJCX0sCisJfSwKKwl7CisJ
CS5uYW1lCQk9ICJ4eWxvbixkaXNwbGF5LWRlcHRoIiwKKwkJLnJhbmdlCQk9IHsgOCwgMjQgfSwK
Kwl9LAorCXsKKwkJLm5hbWUJCT0gInh5bG9uLHJvdy1zdHJpZGUiLAorCX0sCisJeworCQkubmFt
ZQkJPSAieHlsb24sZGl0aGVyaW5nIiwKKwkJLm9wdGlvbmFsCT0gdHJ1ZSwKKwl9LAorCXsKKwkJ
Lm5hbWUJCT0gInh5bG9uLGJhY2tncm91bmQtbGF5ZXIiLAorCQkub3B0aW9uYWwJPSB0cnVlLAor
CX0sCisJeworCQkubmFtZQkJPSAieHlsb24sbGF5ZXJzLWNvbmZpZ3VyYWJsZSIsCisJCS5vcHRp
b25hbAk9IHRydWUsCisJfSwKKwl7CisJCS5uYW1lCQk9ICJ4eWxvbixsYXllcnMtY291bnQiLAor
CX0sCisJeworCQkubmFtZQkJPSAieHlsb24sbGF5ZXItZGVwdGgiLAorCQkucmFuZ2UJCT0geyA4
LCAyNCB9LAorCX0sCisJeworCQkubmFtZQkJPSAieHlsb24sbGF5ZXItY29sb3JzcGFjZSIsCisJ
CS5zdgkJPSBsb2dpY3ZjX29mX2xheWVyX2NvbG9yc3BhY2Vfc3YsCisJCS5yYW5nZQkJPSB7CisJ
CQlMT0dJQ1ZDX0xBWUVSX0NPTE9SU1BBQ0VfUkdCLAorCQkJTE9HSUNWQ19MQVlFUl9DT0xPUlNQ
QUNFX1JHQiwKKwkJfSwKKwl9LAorCXsKKwkJLm5hbWUJCT0gInh5bG9uLGxheWVyLWFscGhhLW1v
ZGUiLAorCQkuc3YJCT0gbG9naWN2Y19vZl9sYXllcl9hbHBoYV9tb2RlX3N2LAorCQkucmFuZ2UJ
CT0geworCQkJTE9HSUNWQ19MQVlFUl9BTFBIQV9MQVlFUiwKKwkJCUxPR0lDVkNfTEFZRVJfQUxQ
SEFfUElYRUwsCisJCX0sCisJfSwKKwl7CisJCS5uYW1lCQk9ICJ4eWxvbixsYXllci1iYXNlLW9m
ZnNldCIsCisJfSwKKwl7CisJCS5uYW1lCQk9ICJ4eWxvbixsYXllci1idWZmZXItb2Zmc2V0IiwK
Kwl9LAorCXsKKwkJLm5hbWUJCT0gInh5bG9uLGxheWVyLXByaW1hcnkiLAorCQkub3B0aW9uYWwJ
PSB0cnVlLAorCX0sCisJeyB9LAorfTsKKworc3RhdGljIGludCBsb2dpY3ZjX29mX3Byb3BlcnR5
X3N2X3ZhbHVlKHN0cnVjdCBsb2dpY3ZjX29mX3Byb3BlcnR5X3N2ICpzdiwKKwkJCQkJY29uc3Qg
Y2hhciAqc3RyaW5nLCB1MzIgKnZhbHVlKQoreworCXVuc2lnbmVkIGludCBpID0gMDsKKworCXdo
aWxlIChzdltpXS5zdHJpbmcpIHsKKwkJaWYgKCFzdHJjbXAoc3ZbaV0uc3RyaW5nLCBzdHJpbmcp
KSB7CisJCQkqdmFsdWUgPSBzdltpXS52YWx1ZTsKKwkJCXJldHVybiAwOworCQl9CisKKwkJaSsr
OworCX0KKworCXJldHVybiAtRUlOVkFMOworfQorCitzdGF0aWMgc3RydWN0IGxvZ2ljdmNfb2Zf
cHJvcGVydHkgKmxvZ2ljdmNfb2ZfcHJvcGVydHlfbG9va3VwKGNvbnN0IGNoYXIgKm5hbWUpCit7
CisJdW5zaWduZWQgaW50IGkgPSAwOworCisJd2hpbGUgKGxvZ2ljdmNfb2ZfcHJvcGVydGllc1tp
XS5uYW1lKSB7CisJCWlmICghc3RyY21wKGxvZ2ljdmNfb2ZfcHJvcGVydGllc1tpXS5uYW1lLCBu
YW1lKSkKKwkJCXJldHVybiAmbG9naWN2Y19vZl9wcm9wZXJ0aWVzW2ldOworCisJCWkrKzsKKwl9
CisKKwlyZXR1cm4gTlVMTDsKK30KKworaW50IGxvZ2ljdmNfb2ZfcHJvcGVydHlfcGFyc2VfdTMy
KHN0cnVjdCBkZXZpY2Vfbm9kZSAqb2Zfbm9kZSwKKwkJCQkgIGNvbnN0IGNoYXIgKm5hbWUsIHUz
MiAqdGFyZ2V0KQoreworCXN0cnVjdCBsb2dpY3ZjX29mX3Byb3BlcnR5ICpwcm9wZXJ0eTsKKwlj
b25zdCBjaGFyICpzdHJpbmc7CisJdTMyIHZhbHVlOworCWludCByZXQ7CisKKwlwcm9wZXJ0eSA9
IGxvZ2ljdmNfb2ZfcHJvcGVydHlfbG9va3VwKG5hbWUpOworCWlmICghcHJvcGVydHkpCisJCXJl
dHVybiAtRUlOVkFMOworCisJaWYgKCFwcm9wZXJ0eS0+b3B0aW9uYWwgJiYgIW9mX3Byb3BlcnR5
X3JlYWRfYm9vbChvZl9ub2RlLCBuYW1lKSkgeworCQlEUk1fRVJST1IoIk1pc3Npbmcgbm9uLW9w
dGlvbmFsIE9GIHByb3BlcnR5ICVzXG4iLCBuYW1lKTsKKwkJcmV0dXJuIC1FTk9ERVY7CisJfQor
CisJaWYgKHByb3BlcnR5LT5zdikgeworCQlyZXQgPSBvZl9wcm9wZXJ0eV9yZWFkX3N0cmluZyhv
Zl9ub2RlLCBuYW1lLCAmc3RyaW5nKTsKKwkJaWYgKHJldCkgeworCQkJRFJNX0VSUk9SKCJGYWls
ZWQgdG8gcmVhZCBPRiBwcm9wZXJ0eSAlc1xuIiwgbmFtZSk7CisJCQlyZXR1cm4gcmV0OworCQl9
CisKKwkJcmV0ID0gbG9naWN2Y19vZl9wcm9wZXJ0eV9zdl92YWx1ZShwcm9wZXJ0eS0+c3YsIHN0
cmluZywKKwkJCQkJCSAgICZ2YWx1ZSk7CisJCWlmIChyZXQpIHsKKwkJCURSTV9FUlJPUigiRmFp
bGVkIHRvIG1hdGNoIE9GIHN0cmluZyAlc1xuIiwgbmFtZSk7CisJCQlyZXR1cm4gcmV0OworCQl9
CisJfSBlbHNlIHsKKwkJcmV0ID0gb2ZfcHJvcGVydHlfcmVhZF91MzIob2Zfbm9kZSwgbmFtZSwg
JnZhbHVlKTsKKwkJaWYgKHJldCkgeworCQkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gcmVhZCBPRiBw
cm9wZXJ0eSAlc1xuIiwgbmFtZSk7CisJCQlyZXR1cm4gcmV0OworCQl9CisJfQorCisJaWYgKHBy
b3BlcnR5LT5yYW5nZVswXSB8fCBwcm9wZXJ0eS0+cmFuZ2VbMV0pCisJCWlmICh2YWx1ZSA8IHBy
b3BlcnR5LT5yYW5nZVswXSB8fCB2YWx1ZSA+IHByb3BlcnR5LT5yYW5nZVsxXSkKKwkJCXJldHVy
biAtRVJBTkdFOworCisJKnRhcmdldCA9IHZhbHVlOworCisJcmV0dXJuIDA7Cit9CisKK3ZvaWQg
bG9naWN2Y19vZl9wcm9wZXJ0eV9wYXJzZV9ib29sKHN0cnVjdCBkZXZpY2Vfbm9kZSAqb2Zfbm9k
ZSwKKwkJCQkgICAgY29uc3QgY2hhciAqbmFtZSwgYm9vbCAqdGFyZ2V0KQoreworCXN0cnVjdCBs
b2dpY3ZjX29mX3Byb3BlcnR5ICpwcm9wZXJ0eTsKKworCXByb3BlcnR5ID0gbG9naWN2Y19vZl9w
cm9wZXJ0eV9sb29rdXAobmFtZSk7CisJaWYgKCFwcm9wZXJ0eSkgeworCQkqdGFyZ2V0ID0gZmFs
c2U7CisJCXJldHVybjsKKwl9CisKKwkqdGFyZ2V0ID0gb2ZfcHJvcGVydHlfcmVhZF9ib29sKG9m
X25vZGUsIG5hbWUpOworfQorCitib29sIGxvZ2ljdmNfb2Zfbm9kZV9pc19sYXllcihzdHJ1Y3Qg
ZGV2aWNlX25vZGUgKm9mX25vZGUpCit7CisJcmV0dXJuICFvZl9ub2RlX2NtcChvZl9ub2RlLT5u
YW1lLCAibGF5ZXIiKTsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xv
Z2ljdmNfb2YuaCBiL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfb2YuaApuZXcgZmls
ZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjVjNmYzZjMzNTAzYQotLS0gL2Rldi9u
dWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfb2YuaApAQCAtMCwwICsx
LDI4IEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCsgKi8KKy8qCisgKiBD
b3B5cmlnaHQgKEMpIDIwMTkgQm9vdGxpbgorICogQXV0aG9yOiBQYXVsIEtvY2lhbGtvd3NraSA8
cGF1bC5rb2NpYWxrb3dza2lAYm9vdGxpbi5jb20+CisgKi8KKworI2lmbmRlZiBfTE9HSUNWQ19P
Rl9IXworI2RlZmluZSBfTE9HSUNWQ19PRl9IXworCitzdHJ1Y3QgbG9naWN2Y19vZl9wcm9wZXJ0
eV9zdiB7CisJY29uc3QgY2hhciAqc3RyaW5nOworCXUzMiB2YWx1ZTsKK307CisKK3N0cnVjdCBs
b2dpY3ZjX29mX3Byb3BlcnR5IHsKKwljaGFyICpuYW1lOworCWJvb2wgb3B0aW9uYWw7CisJc3Ry
dWN0IGxvZ2ljdmNfb2ZfcHJvcGVydHlfc3YgKnN2OworCXUzMiByYW5nZVsyXTsKK307CisKK2lu
dCBsb2dpY3ZjX29mX3Byb3BlcnR5X3BhcnNlX3UzMihzdHJ1Y3QgZGV2aWNlX25vZGUgKm9mX25v
ZGUsCisJCQkJICBjb25zdCBjaGFyICpuYW1lLCB1MzIgKnRhcmdldCk7Cit2b2lkIGxvZ2ljdmNf
b2ZfcHJvcGVydHlfcGFyc2VfYm9vbChzdHJ1Y3QgZGV2aWNlX25vZGUgKm9mX25vZGUsCisJCQkJ
ICAgIGNvbnN0IGNoYXIgKm5hbWUsIGJvb2wgKnRhcmdldCk7Citib29sIGxvZ2ljdmNfb2Zfbm9k
ZV9pc19sYXllcihzdHJ1Y3QgZGV2aWNlX25vZGUgKm9mX25vZGUpOworCisjZW5kaWYKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfcmVncy5oIGIvZHJpdmVycy9n
cHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19yZWdzLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXgg
MDAwMDAwMDAwMDAwLi5kMGJlNWZlODQ4NTYKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dw
dS9kcm0vbG9naWN2Yy9sb2dpY3ZjX3JlZ3MuaApAQCAtMCwwICsxLDg4IEBACisvKiBTUERYLUxp
Y2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCsgKi8KKy8qCisgKiBDb3B5cmlnaHQgKEMpIDIwMTkg
Qm9vdGxpbgorICogQXV0aG9yOiBQYXVsIEtvY2lhbGtvd3NraSA8cGF1bC5rb2NpYWxrb3dza2lA
Ym9vdGxpbi5jb20+CisgKgorICogQ29weXJpZ2h0IChDKSAyMDE0IFh5bG9uIGQuby5vLgorICog
QXV0aG9yOiBEYXZvciBKb2phIDxkYXZvci5qb2phQGxvZ2ljYnJpY2tzLmNvbT4KKyAqLworCisj
aWZuZGVmIF9MT0dJQ1ZDX1JFR1NfSF8KKyNkZWZpbmUgX0xPR0lDVkNfUkVHU19IXworCisjZGVm
aW5lIExPR0lDVkNfRklFTERfR0VUKGZpZWxkLCB2YWx1ZSkgXAorCSgoKHZhbHVlKSAmIGZpZWxk
IyNfTUFTSykgPj4gZmllbGQjI19TSElGVCkKKyNkZWZpbmUgTE9HSUNWQ19GSUVMRF9TRVQoZmll
bGQsIHZhbHVlKSBcCisJKCgodmFsdWUpIDw8IGZpZWxkIyNfU0hJRlQpICYgZmllbGQjI19NQVNL
KQorCisjZGVmaW5lIExPR0lDVkNfRElNRU5TSU9OU19NQVgJCShCSVQoMTYpIC0gMSkKKworI2Rl
ZmluZSBMT0dJQ1ZDX0hTWU5DX0ZST05UX1BPUkNIX1JFRwkweDAwCisjZGVmaW5lIExPR0lDVkNf
SFNZTkNfUkVHCQkweDA4CisjZGVmaW5lIExPR0lDVkNfSFNZTkNfQkFDS19QT1JDSF9SRUcJMHgx
MAorI2RlZmluZSBMT0dJQ1ZDX0hSRVNfUkVHCQkweDE4CisjZGVmaW5lIExPR0lDVkNfVlNZTkNf
RlJPTlRfUE9SQ0hfUkVHCTB4MjAKKyNkZWZpbmUgTE9HSUNWQ19WU1lOQ19SRUcJCTB4MjgKKyNk
ZWZpbmUgTE9HSUNWQ19WU1lOQ19CQUNLX1BPUkNIX1JFRwkweDMwCisjZGVmaW5lIExPR0lDVkNf
VlJFU19SRUcJCTB4MzgKKworI2RlZmluZSBMT0dJQ1ZDX0NUUkxfUkVHCQkweDQwCisjZGVmaW5l
IExPR0lDVkNfQ1RSTF9DTE9DS19JTlZFUlQJQklUKDgpCisjZGVmaW5lIExPR0lDVkNfQ1RSTF9Q
SVhFTF9JTlZFUlQJQklUKDcpCisjZGVmaW5lIExPR0lDVkNfQ1RSTF9ERV9JTlZFUlQJCUJJVCg1
KQorI2RlZmluZSBMT0dJQ1ZDX0NUUkxfREVfRU5BQkxFCQlCSVQoNCkKKyNkZWZpbmUgTE9HSUNW
Q19DVFJMX1ZTWU5DX0lOVkVSVAlCSVQoMykKKyNkZWZpbmUgTE9HSUNWQ19DVFJMX1ZTWU5DX0VO
QUJMRQlCSVQoMikKKyNkZWZpbmUgTE9HSUNWQ19DVFJMX0hTWU5DX0lOVkVSVAlCSVQoMSkKKyNk
ZWZpbmUgTE9HSUNWQ19DVFJMX0hTWU5DX0VOQUJMRQlCSVQoMCkKKworI2RlZmluZSBMT0dJQ1ZD
X0RUWVBFX1JFRwkJMHg0OAorI2RlZmluZSBMT0dJQ1ZDX0JBQ0tHUk9VTkRfQ09MT1JfUkVHCTB4
NTAKKworI2RlZmluZSBMT0dJQ1ZDX0JVRkZFUl9TRUxfUkVHCQkweDU4CisjZGVmaW5lIExPR0lD
VkNfQlVGRkVSX1NFTF9WQUxVRShpLCB2KSBcCisJKEJJVCgxMCArIChpKSkgfCAoKHYpIDw8ICgy
ICogKGkpKSkpCisjZGVmaW5lIExPR0lDVkNfQlVGRkVSX1NFTF9NQVgJCTIKKworI2RlZmluZSBM
T0dJQ1ZDX0RPVUJMRV9DTFVUX1JFRwkJMHg2MAorCisjZGVmaW5lIExPR0lDVkNfSU5UX1NUQVRf
UkVHCQkweDY4CisjZGVmaW5lIExPR0lDVkNfSU5UX1NUQVRfVl9TWU5DCQlCSVQoNSkKKworI2Rl
ZmluZSBMT0dJQ1ZDX0lOVF9NQVNLX1JFRwkJMHg3MAorI2RlZmluZSBMT0dJQ1ZDX0lOVF9NQVNL
X1ZfU1lOQwkJQklUKDUpCisKKyNkZWZpbmUgTE9HSUNWQ19QT1dFUl9DVFJMX1JFRwkJMHg3OAor
I2RlZmluZSBMT0dJQ1ZDX1BPV0VSX0NUUkxfQkFDS0xJR0hUX0VOQUJMRQlCSVQoMCkKKyNkZWZp
bmUgTE9HSUNWQ19QT1dFUl9DVFJMX1ZERF9FTkFCTEUJCUJJVCgxKQorI2RlZmluZSBMT0dJQ1ZD
X1BPV0VSX0NUUkxfVkVFX0VOQUJMRQkJQklUKDIpCisjZGVmaW5lIExPR0lDVkNfUE9XRVJfQ1RS
TF9WSURFT19FTkFCTEUJCUJJVCgzKQorCisjZGVmaW5lIExPR0lDVkNfSVBfVkVSU0lPTl9SRUcJ
CTB4ZjgKKyNkZWZpbmUgTE9HSUNWQ19JUF9WRVJTSU9OX01BSk9SX01BU0sJR0VOTUFTSygxNiwg
MTEpCisjZGVmaW5lIExPR0lDVkNfSVBfVkVSU0lPTl9NQUpPUl9TSElGVAkxMQorI2RlZmluZSBM
T0dJQ1ZDX0lQX1ZFUlNJT05fTUlOT1JfTUFTSwlHRU5NQVNLKDEwLCA1KQorI2RlZmluZSBMT0dJ
Q1ZDX0lQX1ZFUlNJT05fTUlOT1JfU0hJRlQJNQorI2RlZmluZSBMT0dJQ1ZDX0lQX1ZFUlNJT05f
TEVWRUxfTUFTSwlHRU5NQVNLKDQsIDApCisjZGVmaW5lIExPR0lDVkNfSVBfVkVSU0lPTl9MRVZF
TF9TSElGVAkwCisKKyNkZWZpbmUgTE9HSUNWQ19MQVlFUl9BRERSRVNTX1JFRyhpKQkoMHgxMDAg
KyAoaSkgKiAweDgwKQorI2RlZmluZSBMT0dJQ1ZDX0xBWUVSX0hPRkZTRVRfUkVHKGkpCSgweDEw
MCArIChpKSAqIDB4ODApCisKKyNkZWZpbmUgTE9HSUNWQ19MQVlFUl9WT0ZGU0VUX1JFRyhpKQko
MHgxMDggKyAoaSkgKiAweDgwKQorI2RlZmluZSBMT0dJQ1ZDX0xBWUVSX1ZPRkZTRVRfTUFYCTQw
OTUKKworI2RlZmluZSBMT0dJQ1ZDX0xBWUVSX0hQT1NJVElPTl9SRUcoaSkJKDB4MTEwICsgKGkp
ICogMHg4MCkKKyNkZWZpbmUgTE9HSUNWQ19MQVlFUl9WUE9TSVRJT05fUkVHKGkpCSgweDExOCAr
IChpKSAqIDB4ODApCisjZGVmaW5lIExPR0lDVkNfTEFZRVJfV0lEVEhfUkVHKGkpCSgweDEyMCAr
IChpKSAqIDB4ODApCisjZGVmaW5lIExPR0lDVkNfTEFZRVJfSEVJR0hUX1JFRyhpKQkoMHgxMjgg
KyAoaSkgKiAweDgwKQorI2RlZmluZSBMT0dJQ1ZDX0xBWUVSX0FMUEhBX1JFRyhpKQkoMHgxMzAg
KyAoaSkgKiAweDgwKQorCisjZGVmaW5lIExPR0lDVkNfTEFZRVJfQ1RSTF9SRUcoaSkJKDB4MTM4
ICsgKGkpICogMHg4MCkKKyNkZWZpbmUgTE9HSUNWQ19MQVlFUl9DVFJMX0VOQUJMRQlCSVQoMCkK
KyNkZWZpbmUgTE9HSUNWQ19MQVlFUl9DVFJMX0NPTE9SX0tFWV9ESVNBQkxFCUJJVCgxKQorI2Rl
ZmluZSBMT0dJQ1ZDX0xBWUVSX0NUUkxfUElYRUxfRk9STUFUX0lOVkVSVAlCSVQoNCkKKworI2Rl
ZmluZSBMT0dJQ1ZDX0xBWUVSX0NPTE9SX0tFWV9SRUcoaSkJKDB4MTQwICsgKGkpICogMHg4MCkK
KworI2VuZGlmCi0tIAoyLjIzLjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVk
ZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZv
L2RyaS1kZXZlbA==
