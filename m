Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id E05AC5E6CB
	for <lists+dri-devel@lfdr.de>; Wed,  3 Jul 2019 16:33:59 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8216A6E150;
	Wed,  3 Jul 2019 14:33:57 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from bhuna.collabora.co.uk (bhuna.collabora.co.uk
 [IPv6:2a00:1098:0:82:1000:25:2eeb:e3e3])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 467B36E150;
 Wed,  3 Jul 2019 14:33:56 +0000 (UTC)
Received: from localhost (unknown [IPv6:2a01:e0a:2c:6930:5cf4:84a1:2763:fe0d])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256
 bits)) (No client certificate requested)
 (Authenticated sender: bbrezillon)
 by bhuna.collabora.co.uk (Postfix) with ESMTPSA id B936E270C00;
 Wed,  3 Jul 2019 15:33:54 +0100 (BST)
Date: Wed, 3 Jul 2019 16:33:51 +0200
From: Boris Brezillon <boris.brezillon@collabora.com>
To: Steven Price <steven.price@arm.com>
Subject: Re: [RFC PATCH] mesa: Export BOs in RW mode
Message-ID: <20190703163351.5fa5bc42@collabora.com>
In-Reply-To: <12e0bb1f-9a71-a120-7012-397fa0a16fd9@arm.com>
References: <20190703133357.10217-1-boris.brezillon@collabora.com>
 <CAL_JsqLb3qjzp8+9mj3SA=E_avsF7VnC=vji9YvePHvoiqgNgg@mail.gmail.com>
 <20190703155616.1ed02d49@collabora.com>
 <12e0bb1f-9a71-a120-7012-397fa0a16fd9@arm.com>
Organization: Collabora
X-Mailer: Claws Mail 3.17.3 (GTK+ 2.24.32; x86_64-redhat-linux-gnu)
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: ML mesa-dev <mesa-dev@lists.freedesktop.org>,
 Rob Herring <robh+dt@kernel.org>,
 Alyssa Rosenzweig <alyssa.rosenzweig@collabora.com>,
 dri-devel <dri-devel@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gV2VkLCAzIEp1bCAyMDE5IDE1OjEzOjI1ICswMTAwClN0ZXZlbiBQcmljZSA8c3RldmVuLnBy
aWNlQGFybS5jb20+IHdyb3RlOgoKPiBPbiAwMy8wNy8yMDE5IDE0OjU2LCBCb3JpcyBCcmV6aWxs
b24gd3JvdGU6Cj4gPiBPbiBXZWQsIDMgSnVsIDIwMTkgMDc6NDU6MzIgLTA2MDAKPiA+IFJvYiBI
ZXJyaW5nIDxyb2JoK2R0QGtlcm5lbC5vcmc+IHdyb3RlOgo+ID4gICAKPiA+PiBPbiBXZWQsIEp1
bCAzLCAyMDE5IGF0IDc6MzQgQU0gQm9yaXMgQnJlemlsbG9uCj4gPj4gPGJvcmlzLmJyZXppbGxv
bkBjb2xsYWJvcmEuY29tPiB3cm90ZTogIAo+ID4+Pgo+ID4+PiBFeHBvcnRlZCBCT3MgbWlnaHQg
YmUgaW1wb3J0ZWQgYmFjaywgdGhlbiBtbWFwKCktZWQgdG8gYmUgd3JpdHRlbgo+ID4+PiB0b28u
IE1vc3QgZHJpdmVycyBoYW5kbGUgdGhhdCBieSBtbWFwKCktaW5nIHRoZSBHRU0gaGFuZGxlIGFm
dGVyIGl0J3MKPiA+Pj4gYmVlbiBpbXBvcnRlZCwgYnV0LCBhY2NvcmRpbmcgdG8gWzFdLCB0aGlz
IGlzIGlsbGVnYWwuICAgIAo+ID4+Cj4gPj4gSXQncyBub3QgaWxsZWdhbCwgYnV0IGlzIHN1cHBv
c2VkIHRvIGdvIHRocnUgdGhlIGRtYWJ1ZiBtbWFwCj4gPj4gZnVuY3Rpb25zLiAgCj4gPiAKPiA+
IFRoYXQncyBiYXNpY2FsbHkgd2hhdCBJJ20gcHJvcG9zaW5nIGhlcmUsIGp1c3QgZGlkbid0IHBv
c3QgdGhlIHBhdGNoCj4gPiBza2lwcGluZyB0aGUgR0VUX09GRlNFVCBzdGVwIGFuZCBkb2luZyB0
aGUgbW1hcCgpIG9uIHRoZSBkbWFidWYgRkQKPiA+IGluc3RlYWQgb2YgdGhlIERSTS1ub2RlIG9u
ZSwgYnV0IEkgaGF2ZSBpdCB3b3JraW5nIGZvciBwYW5mcm9zdC4gIAo+IAo+IElmIHdlIHdhbnQg
dG8gd2UgY291bGQgbWFrZSB0aGUgUGFuZnJvc3Qga2VybmVsIGRyaXZlciBpbnRlcm5hbGx5IGNh
bGwKPiBkbWFfYnVmX21tYXAoKSBzbyB0aGF0IG1hcHBpbmcgdXNpbmcgdGhlIERSTS1ub2RlICJq
dXN0IHdvcmtzIi4gVGhpcyBpcwo+IGluZGVlZCB3aGF0IHRoZSBrYmFzZSBkcml2ZXIgZG9lcy4K
CldlbGwsIHVzZXJzcGFjZSBzaG91bGQgYXQgbGVhc3Qgc2tpcCBEUk1fSU9DVExfUEFORlJPU1Rf
TU1BUF9CTyAob3IKaWdub3JlIGl0cyByZXR1cm4gY29kZSksIHNvIGNhbGxpbmcgbW1hcCgpIG9u
IHRoZSBkbWFidWYgRkQgaW5zdGVhZCBvZgp0aGUgRFJNLW5vZGUgRkQgc2hvdWxkbid0IGJlIHRo
YXQgaGFyZC4KCj4gCj4gPj4gSG93ZXZlciwgbm9uZSBvZiB0aGUgZHJpdmVyIEkndmUgbG9va2Vk
IGF0IChldG5hdml2LCBtc20sCj4gPj4gdjNkLCB2Z2VtKSBkbyB0aGF0LiBJdCBwcm9iYWJseSB3
b3JrcyBiZWNhdXNlIGl0J3MgdGhlIHNhbWUgZHJpdmVyCj4gPj4gZG9pbmcgdGhlIGltcG9ydCBh
bmQgZXhwb3J0IG9yIGJvdGggZHJpdmVycyBoYXZlIGVzc2VudGlhbGx5IHRoZSBzYW1lCj4gPj4g
aW1wbGVtZW50YXRpb25zLiAgCj4gPiAKPiA+IFllcywgYnV0IG1heWJlIHRoYXQncyBzb21ldGhp
bmcgd2Ugc2hvdWxkIHN0YXJ0IGZpeGluZyBpZiBtbWFwKCktaW5nCj4gPiB0aGUgZG1hYnVmIGlz
IHRoZSByZWNvbW1lbmRlZCBzb2x1dGlvbi4gIAo+IAo+IEknbSBvcGVuIHRvIG9wdGlvbnMgaGVy
ZS4gVXNlciBzcGFjZSBjYWxsaW5nIG1tYXAoKSBvbiB0aGUgZG1hX2J1ZiBmaWxlCj4gZGVzY3Jp
cHRvciBzaG91bGQgYWx3YXlzIGJlIHNhZmUgKHRoZSBleHBvcnRlciBjYW4gZG8gd2hhdGV2ZXIg
aXMKPiBuZWNlc3NhcnkgdG8gbWFrZSBpdCB3b3JrKS4gSWYgdGhhdCBoYXBwZW5zIHRoZW4gdGhl
IHBhdGNoZXMgSSBwb3N0ZWQKPiBjbG9zZSBvZmYgdGhlIERSTSBub2RlIHZlcnNpb24gd2hpY2gg
Y291bGQgYmUgYnJva2VuIGlmIHRoZSBleHBvcnRlcgo+IG5lZWRzIHRvIGRvIGFueXRoaW5nIHRv
IHByZXBhcmUgdGhlIGJ1ZmZlciBmb3IgQ1BVIGFjY2VzcyAoaS5lLiBjYWNoZQo+IG1haW50ZW5h
bmNlKS4KClRhbGtpbmcgYWJvdXQgQ1BVIDwtPiBHUFUgc3luY3MsIEkgd2FzIHdvbmRlcmluZyBp
ZiB0aGUKbW1hcChnZW1faGFuZGxlKSBzdGVwIHdhcyBwcm92aWRpbmcgYW55IGd1YXJhbnRlZSB0
aGF0IHdvdWxkCmFsbG93IHVzIHRvIGlnbm9yZSBhbGwgdGhlIGNhY2hlIG1haW50ZW5hbmNlIG9w
ZXJhdGlvbnMgdGhhdCBhcmUKcmVxdWlyZWQgd2hlbiBtbWFwKCktaW5nIGEgZG1hYnVmIGRpcmVj
dGx5LiBOb3RlIHRoYXQgaW4gYm90aCBjYXNlcyB0aGUKZG1hYnVmIGlzIGltcG9ydGVkLgoKPiAK
PiBBbHRlcm5hdGl2ZWx5IGlmIHVzZXIgc3BhY2Ugd2FudHMvbmVlZHMgdG8gdXNlIHRoZSBETUEg
bm9kZSB0aGVuIHdlIGNhbgo+IHRha2UgYSBsb29rIGF0IHdoYXQgbmVlZHMgdG8gY2hhbmdlIGlu
IHRoZSBrZXJuZWwuIEZyb20gYSBxdWljayBsb29rIGF0Cj4gdGhlIGNvZGUgaXQgc2VlbXMgd2Un
ZCBuZWVkIHRvIHNwbGl0IGRybV9nZW1fbW1hcCgpIGludG8gYSBoZWxwZXIgc28KPiB0aGF0IGl0
IGNhbiByZXR1cm4gd2hldGhlciB0aGUgZXhwb3J0ZXIgaXMgaGFuZGxpbmcgZXZlcnl0aGluZyBv
ciBpZiB0aGUKPiBjYWxsZXIgbmVlZHMgdG8gZG8gc29tZSBtb3JlIHdvcmsgKGUuZy4gZHJtX2dl
bV9zaG1lbV9tbWFwKCkgbmVlZHMgdG8KPiBhbGxvY2F0ZSBiYWNraW5nIHBhZ2VzKS4gQnV0IGJl
Y2F1c2UgZHJtX2dlbV9tbWFwKCkgaXMgdXNlZCBhcyB0aGUKPiBkaXJlY3QgY2FsbGJhY2sgZm9y
IHNvbWUgZHJpdmVycyB3ZSdkIG5lZWQgdG8gcHJlc2VydmUgdGhlIGludGVyZmFjZS4KPiAKPiBU
aGUgYmVsb3cgKGNvbXBsZXRlbHkgdW50ZXN0ZWQpIHBhdGNoIGRlbW9uc3RyYXRlcyB0aGUgaWRl
YS4KPiAKPiBTdGV2ZQo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2dlbS5j
IGIvZHJpdmVycy9ncHUvZHJtL2RybV9nZW0uYwo+IGluZGV4IGE4YzQ0NjhmMDNkOS4uZGY2NjFl
MjRjYWRmIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtLmMKPiArKysgYi9k
cml2ZXJzL2dwdS9kcm0vZHJtX2dlbS5jCj4gQEAgLTExNDAsNyArMTE0MCw3IEBAIEVYUE9SVF9T
WU1CT0woZHJtX2dlbV9tbWFwX29iaik7Cj4gICAqIElmIHRoZSBjYWxsZXIgaXMgbm90IGdyYW50
ZWQgYWNjZXNzIHRvIHRoZSBidWZmZXIgb2JqZWN0LCB0aGUgbW1hcAo+IHdpbGwgZmFpbAo+ICAg
KiB3aXRoIEVBQ0NFUy4gUGxlYXNlIHNlZSB0aGUgdm1hIG1hbmFnZXIgZm9yIG1vcmUgaW5mb3Jt
YXRpb24uCj4gICAqLwo+IC1pbnQgZHJtX2dlbV9tbWFwKHN0cnVjdCBmaWxlICpmaWxwLCBzdHJ1
Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSkKPiAraW50IGRybV9nZW1fbW1hcF9oZWxwZXIoc3RydWN0
IGZpbGUgKmZpbHAsIHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hKQo+ICB7Cj4gIAlzdHJ1Y3Qg
ZHJtX2ZpbGUgKnByaXYgPSBmaWxwLT5wcml2YXRlX2RhdGE7Cj4gIAlzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2ID0gcHJpdi0+bWlub3ItPmRldjsKPiBAQCAtMTE4OSw2ICsxMTg5LDExIEBAIGludCBk
cm1fZ2VtX21tYXAoc3RydWN0IGZpbGUgKmZpbHAsIHN0cnVjdAo+IHZtX2FyZWFfc3RydWN0ICp2
bWEpCj4gIAkJdm1hLT52bV9mbGFncyAmPSB+Vk1fTUFZV1JJVEU7Cj4gIAl9Cj4gCj4gKwlpZiAo
b2JqLT5pbXBvcnRfYXR0YWNoKSB7Cj4gKwkJcmV0ID0gZG1hX2J1Zl9tbWFwKG9iai0+ZG1hX2J1
Ziwgdm1hLCAwKTsKPiArCQlyZXR1cm4gcmV0PzoxOwo+ICsJfQo+ICsKPiAgCXJldCA9IGRybV9n
ZW1fbW1hcF9vYmoob2JqLCBkcm1fdm1hX25vZGVfc2l6ZShub2RlKSA8PCBQQUdFX1NISUZULAo+
ICAJCQkgICAgICAgdm1hKTsKPiAKPiBAQCAtMTE5Niw2ICsxMjAxLDE2IEBAIGludCBkcm1fZ2Vt
X21tYXAoc3RydWN0IGZpbGUgKmZpbHAsIHN0cnVjdAo+IHZtX2FyZWFfc3RydWN0ICp2bWEpCj4g
Cj4gIAlyZXR1cm4gcmV0Owo+ICB9Cj4gKwo+ICtpbnQgZHJtX2dlbV9tbWFwKHN0cnVjdCBmaWxl
ICpmaWxwLCBzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSkKPiArewo+ICsJaW50IHJldDsKPiAr
Cj4gKwlyZXQgPSBkcm1fZ2VtX21tYXBfaGVscGVyKGZpbHAsIHZtYSk7Cj4gKwlpZiAocmV0ID09
IDEpCj4gKwkJcmV0dXJuIDA7Cj4gKwlyZXR1cm4gcmV0Owo+ICt9Cj4gIEVYUE9SVF9TWU1CT0wo
ZHJtX2dlbV9tbWFwKTsKPiAKPiAgdm9pZCBkcm1fZ2VtX3ByaW50X2luZm8oc3RydWN0IGRybV9w
cmludGVyICpwLCB1bnNpZ25lZCBpbnQgaW5kZW50LAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vZHJtX2dlbV9zaG1lbV9oZWxwZXIuYwo+IGIvZHJpdmVycy9ncHUvZHJtL2RybV9nZW1f
c2htZW1faGVscGVyLmMKPiBpbmRleCA0NzJlYTVkODFmODIuLmI4NWQ4NGU0ZDRhOCAxMDA2NDQK
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2dlbV9zaG1lbV9oZWxwZXIuYwo+ICsrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9kcm1fZ2VtX3NobWVtX2hlbHBlci5jCj4gQEAgLTQ2Niw4ICs0NjYsMTAg
QEAgaW50IGRybV9nZW1fc2htZW1fbW1hcChzdHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0Cj4gdm1f
YXJlYV9zdHJ1Y3QgKnZtYSkKPiAgCXN0cnVjdCBkcm1fZ2VtX3NobWVtX29iamVjdCAqc2htZW07
Cj4gIAlpbnQgcmV0Owo+IAo+IC0JcmV0ID0gZHJtX2dlbV9tbWFwKGZpbHAsIHZtYSk7Cj4gLQlp
ZiAocmV0KQo+ICsJcmV0ID0gZHJtX2dlbV9tbWFwX2hlbHBlcihmaWxwLCB2bWEpOwo+ICsJaWYg
KHJldCA9PSAxKQo+ICsJCXJldHVybiAwOyAvKiBFeHBvcnRlciBoYW5kbGVzIHRoZSBtYXBwaW5n
ICovCj4gKwllbHNlIGlmIChyZXQpCj4gIAkJcmV0dXJuIHJldDsKPiAKPiAgCXNobWVtID0gdG9f
ZHJtX2dlbV9zaG1lbV9vYmoodm1hLT52bV9wcml2YXRlX2RhdGEpOwoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApk
cmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Au
b3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
