Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 0D3C89C6AB
	for <lists+dri-devel@lfdr.de>; Mon, 26 Aug 2019 02:19:26 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7A4C16E150;
	Mon, 26 Aug 2019 00:19:05 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from onstation.org (onstation.org [52.200.56.107])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 25E826EC80;
 Fri, 23 Aug 2019 12:16:56 +0000 (UTC)
Received: from localhost.localdomain (wsip-184-191-162-253.sd.sd.cox.net
 [184.191.162.253])
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits))
 (No client certificate requested) (Authenticated sender: masneyb)
 by onstation.org (Postfix) with ESMTPSA id 2F8773E83A;
 Fri, 23 Aug 2019 12:16:54 +0000 (UTC)
From: Brian Masney <masneyb@onstation.org>
To: agross@kernel.org, robdclark@gmail.com, sean@poorly.run,
 robh+dt@kernel.org, bjorn.andersson@linaro.org
Subject: [PATCH v7 3/7] firmware: qcom: scm: add OCMEM lock/unlock interface
Date: Fri, 23 Aug 2019 05:16:33 -0700
Message-Id: <20190823121637.5861-4-masneyb@onstation.org>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190823121637.5861-1-masneyb@onstation.org>
References: <20190823121637.5861-1-masneyb@onstation.org>
MIME-Version: 1.0
X-Mailman-Approved-At: Mon, 26 Aug 2019 00:18:56 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=onstation.org; s=default; t=1566562615;
 bh=ARCZOnEhVAy5Qim6i4ZVFh52htTlXZFDp6eWNXzUNyk=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=elD65P21LEh0X+VLuoa3kOusrTWAxfQgArK5aIhvT3kR5T0vkgY0iGTdK0P2egoK5
 cUm5mhu/orFjxuYFRYAVrDoUR54z9oeMy19uV4lJvRtamirL7trjNJDUlukcaoGpLN
 f5SdvUWMtPIK5yPSGaFcCE4qTrJ5C9C843yz9YjA=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: mark.rutland@arm.com, devicetree@vger.kernel.org, jonathan@marek.ca,
 airlied@linux.ie, linux-arm-msm@vger.kernel.org, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, freedreno@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogUm9iIENsYXJrIDxyb2JkY2xhcmtAZ21haWwuY29tPgoKQWRkIHN1cHBvcnQgZm9yIHRo
ZSBPQ01FTSBsb2NrL3VubG9jayBpbnRlcmZhY2UgdGhhdCBpcyBuZWVkZWQgYnkgdGhlCk9uIENo
aXAgTUVNb3J5IChPQ01FTSkgdGhhdCBpcyBwcmVzZW50IG9uIHNvbWUgU25hcGRyYWdvbiBkZXZp
Y2VzLgoKU2lnbmVkLW9mZi1ieTogUm9iIENsYXJrIDxyb2JkY2xhcmtAZ21haWwuY29tPgpbbWFz
bmV5YkBvbnN0YXRpb24ub3JnOiBwb3J0ZWQgdG8gbGF0ZXN0IGtlcm5lbDsgbWlub3IgcmVmb3Jt
YXR0aW5nLl0KU2lnbmVkLW9mZi1ieTogQnJpYW4gTWFzbmV5IDxtYXNuZXliQG9uc3RhdGlvbi5v
cmc+ClJldmlld2VkLWJ5OiBCam9ybiBBbmRlcnNzb24gPGJqb3JuLmFuZGVyc3NvbkBsaW5hcm8u
b3JnPgotLS0KQ2hhbmdlcyBzaW5jZSB2NjoKLSBOb25lCgpDaGFuZ2VzIHNpbmNlIHY1OgotIE5v
bmUKCkNoYW5nZXMgc2luY2UgdjQ6Ci0gTm9uZQoKQ2hhbmdlcyBzaW5jZSB2MzoKLSBOb25lCgpD
aGFuZ2VzIHNpbmNlIHYyOgotIE5vbmUKCkNoYW5nZXMgc2luY2UgdjE6Ci0gTm9uZQoKUm9iJ3Mg
bGFzdCB2ZXJzaW9uIG9mIHRoaXMgcGF0Y2g6Cmh0dHBzOi8vcGF0Y2h3b3JrLmtlcm5lbC5vcmcv
cGF0Y2gvNzM0MDcxMS8KCiBkcml2ZXJzL2Zpcm13YXJlL3Fjb21fc2NtLTMyLmMgfCAzNSArKysr
KysrKysrKysrKysrKysrKysrKysrKysrKwogZHJpdmVycy9maXJtd2FyZS9xY29tX3NjbS02NC5j
IHwgMTIgKysrKysrKysrKwogZHJpdmVycy9maXJtd2FyZS9xY29tX3NjbS5jICAgIHwgNDAgKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKwogZHJpdmVycy9maXJtd2FyZS9xY29tX3Nj
bS5oICAgIHwgIDkgKysrKysrKysKIGluY2x1ZGUvbGludXgvcWNvbV9zY20uaCAgICAgICB8IDE1
ICsrKysrKysrKysrKysKIDUgZmlsZXMgY2hhbmdlZCwgMTExIGluc2VydGlvbnMoKykKCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2Zpcm13YXJlL3Fjb21fc2NtLTMyLmMgYi9kcml2ZXJzL2Zpcm13YXJl
L3Fjb21fc2NtLTMyLmMKaW5kZXggMjE1MDYxYzU4MWUxLi40YzI1MTRlNWUyNDkgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZmlybXdhcmUvcWNvbV9zY20tMzIuYworKysgYi9kcml2ZXJzL2Zpcm13YXJl
L3Fjb21fc2NtLTMyLmMKQEAgLTQ0Miw2ICs0NDIsNDEgQEAgaW50IF9fcWNvbV9zY21faGRjcF9y
ZXEoc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1Y3QgcWNvbV9zY21faGRjcF9yZXEgKnJlcSwKIAkJ
cmVxLCByZXFfY250ICogc2l6ZW9mKCpyZXEpLCByZXNwLCBzaXplb2YoKnJlc3ApKTsKIH0KIAor
aW50IF9fcWNvbV9zY21fb2NtZW1fbG9jayhzdHJ1Y3QgZGV2aWNlICpkZXYsIHUzMiBpZCwgdTMy
IG9mZnNldCwgdTMyIHNpemUsCisJCQkgIHUzMiBtb2RlKQoreworCXN0cnVjdCBvY21lbV90el9s
b2NrIHsKKwkJX19sZTMyIGlkOworCQlfX2xlMzIgb2Zmc2V0OworCQlfX2xlMzIgc2l6ZTsKKwkJ
X19sZTMyIG1vZGU7CisJfSByZXF1ZXN0OworCisJcmVxdWVzdC5pZCA9IGNwdV90b19sZTMyKGlk
KTsKKwlyZXF1ZXN0Lm9mZnNldCA9IGNwdV90b19sZTMyKG9mZnNldCk7CisJcmVxdWVzdC5zaXpl
ID0gY3B1X3RvX2xlMzIoc2l6ZSk7CisJcmVxdWVzdC5tb2RlID0gY3B1X3RvX2xlMzIobW9kZSk7
CisKKwlyZXR1cm4gcWNvbV9zY21fY2FsbChkZXYsIFFDT01fU0NNX09DTUVNX1NWQywgUUNPTV9T
Q01fT0NNRU1fTE9DS19DTUQsCisJCQkgICAgICZyZXF1ZXN0LCBzaXplb2YocmVxdWVzdCksIE5V
TEwsIDApOworfQorCitpbnQgX19xY29tX3NjbV9vY21lbV91bmxvY2soc3RydWN0IGRldmljZSAq
ZGV2LCB1MzIgaWQsIHUzMiBvZmZzZXQsIHUzMiBzaXplKQoreworCXN0cnVjdCBvY21lbV90el91
bmxvY2sgeworCQlfX2xlMzIgaWQ7CisJCV9fbGUzMiBvZmZzZXQ7CisJCV9fbGUzMiBzaXplOwor
CX0gcmVxdWVzdDsKKworCXJlcXVlc3QuaWQgPSBjcHVfdG9fbGUzMihpZCk7CisJcmVxdWVzdC5v
ZmZzZXQgPSBjcHVfdG9fbGUzMihvZmZzZXQpOworCXJlcXVlc3Quc2l6ZSA9IGNwdV90b19sZTMy
KHNpemUpOworCisJcmV0dXJuIHFjb21fc2NtX2NhbGwoZGV2LCBRQ09NX1NDTV9PQ01FTV9TVkMs
IFFDT01fU0NNX09DTUVNX1VOTE9DS19DTUQsCisJCQkgICAgICZyZXF1ZXN0LCBzaXplb2YocmVx
dWVzdCksIE5VTEwsIDApOworfQorCiB2b2lkIF9fcWNvbV9zY21faW5pdCh2b2lkKQogewogfQpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9maXJtd2FyZS9xY29tX3NjbS02NC5jIGIvZHJpdmVycy9maXJt
d2FyZS9xY29tX3NjbS02NC5jCmluZGV4IDkxZDVhZDdjZjU4Yi4uYzNhM2Q5ODc0ZGVmIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2Zpcm13YXJlL3Fjb21fc2NtLTY0LmMKKysrIGIvZHJpdmVycy9maXJt
d2FyZS9xY29tX3NjbS02NC5jCkBAIC0yNDEsNiArMjQxLDE4IEBAIGludCBfX3Fjb21fc2NtX2hk
Y3BfcmVxKHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IHFjb21fc2NtX2hkY3BfcmVxICpyZXEs
CiAJcmV0dXJuIHJldDsKIH0KIAoraW50IF9fcWNvbV9zY21fb2NtZW1fbG9jayhzdHJ1Y3QgZGV2
aWNlICpkZXYsIHVpbnQzMl90IGlkLCB1aW50MzJfdCBvZmZzZXQsCisJCQkgIHVpbnQzMl90IHNp
emUsIHVpbnQzMl90IG1vZGUpCit7CisJcmV0dXJuIC1FTk9UU1VQUDsKK30KKworaW50IF9fcWNv
bV9zY21fb2NtZW1fdW5sb2NrKHN0cnVjdCBkZXZpY2UgKmRldiwgdWludDMyX3QgaWQsIHVpbnQz
Ml90IG9mZnNldCwKKwkJCSAgICB1aW50MzJfdCBzaXplKQoreworCXJldHVybiAtRU5PVFNVUFA7
Cit9CisKIHZvaWQgX19xY29tX3NjbV9pbml0KHZvaWQpCiB7CiAJdTY0IGNtZDsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZmlybXdhcmUvcWNvbV9zY20uYyBiL2RyaXZlcnMvZmlybXdhcmUvcWNvbV9z
Y20uYwppbmRleCA0ODAyYWIxNzBmZTUuLjdlMjg1ZmYzOTYxZCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9maXJtd2FyZS9xY29tX3NjbS5jCisrKyBiL2RyaXZlcnMvZmlybXdhcmUvcWNvbV9zY20uYwpA
QCAtMTkxLDYgKzE5MSw0NiBAQCBib29sIHFjb21fc2NtX3Bhc19zdXBwb3J0ZWQodTMyIHBlcmlw
aGVyYWwpCiB9CiBFWFBPUlRfU1lNQk9MKHFjb21fc2NtX3Bhc19zdXBwb3J0ZWQpOwogCisvKioK
KyAqIHFjb21fc2NtX29jbWVtX2xvY2tfYXZhaWxhYmxlKCkgLSBpcyBPQ01FTSBsb2NrL3VubG9j
ayBpbnRlcmZhY2UgYXZhaWxhYmxlCisgKi8KK2Jvb2wgcWNvbV9zY21fb2NtZW1fbG9ja19hdmFp
bGFibGUodm9pZCkKK3sKKwlyZXR1cm4gX19xY29tX3NjbV9pc19jYWxsX2F2YWlsYWJsZShfX3Nj
bS0+ZGV2LCBRQ09NX1NDTV9PQ01FTV9TVkMsCisJCQkJCSAgICBRQ09NX1NDTV9PQ01FTV9MT0NL
X0NNRCk7Cit9CitFWFBPUlRfU1lNQk9MKHFjb21fc2NtX29jbWVtX2xvY2tfYXZhaWxhYmxlKTsK
KworLyoqCisgKiBxY29tX3NjbV9vY21lbV9sb2NrKCkgLSBjYWxsIE9DTUVNIGxvY2sgaW50ZXJm
YWNlIHRvIGFzc2lnbiBhbiBPQ01FTQorICogcmVnaW9uIHRvIHRoZSBzcGVjaWZpZWQgaW5pdGlh
dG9yCisgKgorICogQGlkOiAgICAgdHogaW5pdGlhdG9yIGlkCisgKiBAb2Zmc2V0OiBPQ01FTSBv
ZmZzZXQKKyAqIEBzaXplOiAgIE9DTUVNIHNpemUKKyAqIEBtb2RlOiAgIGFjY2VzcyBtb2RlIChX
SURFL05BUlJPVykKKyAqLworaW50IHFjb21fc2NtX29jbWVtX2xvY2soZW51bSBxY29tX3NjbV9v
Y21lbV9jbGllbnQgaWQsIHUzMiBvZmZzZXQsIHUzMiBzaXplLAorCQkJdTMyIG1vZGUpCit7CisJ
cmV0dXJuIF9fcWNvbV9zY21fb2NtZW1fbG9jayhfX3NjbS0+ZGV2LCBpZCwgb2Zmc2V0LCBzaXpl
LCBtb2RlKTsKK30KK0VYUE9SVF9TWU1CT0wocWNvbV9zY21fb2NtZW1fbG9jayk7CisKKy8qKgor
ICogcWNvbV9zY21fb2NtZW1fdW5sb2NrKCkgLSBjYWxsIE9DTUVNIHVubG9jayBpbnRlcmZhY2Ug
dG8gcmVsZWFzZSBhbiBPQ01FTQorICogcmVnaW9uIGZyb20gdGhlIHNwZWNpZmllZCBpbml0aWF0
b3IKKyAqCisgKiBAaWQ6ICAgICB0eiBpbml0aWF0b3IgaWQKKyAqIEBvZmZzZXQ6IE9DTUVNIG9m
ZnNldAorICogQHNpemU6ICAgT0NNRU0gc2l6ZQorICovCitpbnQgcWNvbV9zY21fb2NtZW1fdW5s
b2NrKGVudW0gcWNvbV9zY21fb2NtZW1fY2xpZW50IGlkLCB1MzIgb2Zmc2V0LCB1MzIgc2l6ZSkK
K3sKKwlyZXR1cm4gX19xY29tX3NjbV9vY21lbV91bmxvY2soX19zY20tPmRldiwgaWQsIG9mZnNl
dCwgc2l6ZSk7Cit9CitFWFBPUlRfU1lNQk9MKHFjb21fc2NtX29jbWVtX3VubG9jayk7CisKIC8q
KgogICogcWNvbV9zY21fcGFzX2luaXRfaW1hZ2UoKSAtIEluaXRpYWxpemUgcGVyaXBoZXJhbCBh
dXRoZW50aWNhdGlvbiBzZXJ2aWNlCiAgKgkJCSAgICAgICBzdGF0ZSBtYWNoaW5lIGZvciBhIGdp
dmVuIHBlcmlwaGVyYWwsIHVzaW5nIHRoZQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9maXJtd2FyZS9x
Y29tX3NjbS5oIGIvZHJpdmVycy9maXJtd2FyZS9xY29tX3NjbS5oCmluZGV4IDk5NTA2YmQ4NzNj
MC4uZWYyOTNlZTY3ZWMxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2Zpcm13YXJlL3Fjb21fc2NtLmgK
KysrIGIvZHJpdmVycy9maXJtd2FyZS9xY29tX3NjbS5oCkBAIC00Miw2ICs0MiwxNSBAQCBleHRl
cm4gaW50IF9fcWNvbV9zY21faGRjcF9yZXEoc3RydWN0IGRldmljZSAqZGV2LAogCiBleHRlcm4g
dm9pZCBfX3Fjb21fc2NtX2luaXQodm9pZCk7CiAKKyNkZWZpbmUgUUNPTV9TQ01fT0NNRU1fU1ZD
CQkJMHhmCisjZGVmaW5lIFFDT01fU0NNX09DTUVNX0xPQ0tfQ01ECQkweDEKKyNkZWZpbmUgUUNP
TV9TQ01fT0NNRU1fVU5MT0NLX0NNRAkJMHgyCisKK2V4dGVybiBpbnQgX19xY29tX3NjbV9vY21l
bV9sb2NrKHN0cnVjdCBkZXZpY2UgKmRldiwgdTMyIGlkLCB1MzIgb2Zmc2V0LAorCQkJCSB1MzIg
c2l6ZSwgdTMyIG1vZGUpOworZXh0ZXJuIGludCBfX3Fjb21fc2NtX29jbWVtX3VubG9jayhzdHJ1
Y3QgZGV2aWNlICpkZXYsIHUzMiBpZCwgdTMyIG9mZnNldCwKKwkJCQkgICB1MzIgc2l6ZSk7CisK
ICNkZWZpbmUgUUNPTV9TQ01fU1ZDX1BJTAkJMHgyCiAjZGVmaW5lIFFDT01fU0NNX1BBU19JTklU
X0lNQUdFX0NNRAkweDEKICNkZWZpbmUgUUNPTV9TQ01fUEFTX01FTV9TRVRVUF9DTUQJMHgyCmRp
ZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L3Fjb21fc2NtLmggYi9pbmNsdWRlL2xpbnV4L3Fjb21f
c2NtLmgKaW5kZXggMmQ1ZWZmNTA2ZTEzLi5iNDliNzM0ZDY2MmMgMTAwNjQ0Ci0tLSBhL2luY2x1
ZGUvbGludXgvcWNvbV9zY20uaAorKysgYi9pbmNsdWRlL2xpbnV4L3Fjb21fc2NtLmgKQEAgLTI0
LDYgKzI0LDE2IEBAIHN0cnVjdCBxY29tX3NjbV92bXBlcm0gewogCWludCBwZXJtOwogfTsKIAor
ZW51bSBxY29tX3NjbV9vY21lbV9jbGllbnQgeworCVFDT01fU0NNX09DTUVNX1VOVVNFRF9JRCA9
IDB4MCwKKwlRQ09NX1NDTV9PQ01FTV9HUkFQSElDU19JRCwKKwlRQ09NX1NDTV9PQ01FTV9WSURF
T19JRCwKKwlRQ09NX1NDTV9PQ01FTV9MUF9BVURJT19JRCwKKwlRQ09NX1NDTV9PQ01FTV9TRU5T
T1JTX0lELAorCVFDT01fU0NNX09DTUVNX09USEVSX09TX0lELAorCVFDT01fU0NNX09DTUVNX0RF
QlVHX0lELAorfTsKKwogI2RlZmluZSBRQ09NX1NDTV9WTUlEX0hMT1MgICAgICAgMHgzCiAjZGVm
aW5lIFFDT01fU0NNX1ZNSURfTVNTX01TQSAgICAweEYKICNkZWZpbmUgUUNPTV9TQ01fVk1JRF9X
TEFOICAgICAgIDB4MTgKQEAgLTQxLDYgKzUxLDExIEBAIGV4dGVybiBib29sIHFjb21fc2NtX2lz
X2F2YWlsYWJsZSh2b2lkKTsKIGV4dGVybiBib29sIHFjb21fc2NtX2hkY3BfYXZhaWxhYmxlKHZv
aWQpOwogZXh0ZXJuIGludCBxY29tX3NjbV9oZGNwX3JlcShzdHJ1Y3QgcWNvbV9zY21faGRjcF9y
ZXEgKnJlcSwgdTMyIHJlcV9jbnQsCiAJCQkgICAgIHUzMiAqcmVzcCk7CitleHRlcm4gYm9vbCBx
Y29tX3NjbV9vY21lbV9sb2NrX2F2YWlsYWJsZSh2b2lkKTsKK2V4dGVybiBpbnQgcWNvbV9zY21f
b2NtZW1fbG9jayhlbnVtIHFjb21fc2NtX29jbWVtX2NsaWVudCBpZCwgdTMyIG9mZnNldCwKKwkJ
CSAgICAgICB1MzIgc2l6ZSwgdTMyIG1vZGUpOworZXh0ZXJuIGludCBxY29tX3NjbV9vY21lbV91
bmxvY2soZW51bSBxY29tX3NjbV9vY21lbV9jbGllbnQgaWQsIHUzMiBvZmZzZXQsCisJCQkJIHUz
MiBzaXplKTsKIGV4dGVybiBib29sIHFjb21fc2NtX3Bhc19zdXBwb3J0ZWQodTMyIHBlcmlwaGVy
YWwpOwogZXh0ZXJuIGludCBxY29tX3NjbV9wYXNfaW5pdF9pbWFnZSh1MzIgcGVyaXBoZXJhbCwg
Y29uc3Qgdm9pZCAqbWV0YWRhdGEsCiAJCQkJICAgc2l6ZV90IHNpemUpOwotLSAKMi4yMS4wCgpf
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwg
bWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0
cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
