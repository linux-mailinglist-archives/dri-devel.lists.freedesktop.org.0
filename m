Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 850C7BBA7E
	for <lists+dri-devel@lfdr.de>; Mon, 23 Sep 2019 19:28:17 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 74F976E989;
	Mon, 23 Sep 2019 17:28:04 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6CB526E97C
 for <dri-devel@lists.freedesktop.org>; Mon, 23 Sep 2019 17:28:02 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id A8FC1B0DA;
 Mon, 23 Sep 2019 17:27:59 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: airlied@linux.ie, daniel@ffwll.ch, kraxel@redhat.com, sam@ravnborg.org,
 yc_chen@aspeedtech.com, corbet@lwn.net
Subject: [PATCH v2 03/12] drm/ast: Move cursor update code to ast_show_cursor()
Date: Mon, 23 Sep 2019 19:27:44 +0200
Message-Id: <20190923172753.26593-4-tzimmermann@suse.de>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190923172753.26593-1-tzimmermann@suse.de>
References: <20190923172753.26593-1-tzimmermann@suse.de>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Zimmermann <tzimmermann@suse.de>, dri-devel@lists.freedesktop.org,
 linux-doc@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QSBjYWxsIHRvIGFzdCdzIHNob3ctY3Vyc29yIGZ1bmN0aW9uIG5vdyByZWNlaXZlcyB0aGUgY3Vy
c29yIGltYWdlCmFuZCB1cGRhdGVzIHRoZSBidWZmZXIuIFRoZSBjaGFuZ2Ugc3BsaXRzIG9mZiBp
bWFnZSB1cGRhdGUgYW5kCmJhc2UtYWRkcmVzcyB1cGRhdGUgaW50byBzZXBhcmF0ZSBmdW5jdGlv
bnMuCgpTaWduZWQtb2ZmLWJ5OiBUaG9tYXMgWmltbWVybWFubiA8dHppbW1lcm1hbm5Ac3VzZS5k
ZT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vYXN0L2FzdF9tb2RlLmMgfCAxMjAgKysrKysrKysrKysr
KysrKysrKy0tLS0tLS0tLS0tLS0tCiAxIGZpbGUgY2hhbmdlZCwgNjkgaW5zZXJ0aW9ucygrKSwg
NTEgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FzdC9hc3RfbW9k
ZS5jIGIvZHJpdmVycy9ncHUvZHJtL2FzdC9hc3RfbW9kZS5jCmluZGV4IGE0Y2JmMmQ1ZWUwYS4u
MTI5NGYwNjEyZmQ1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYXN0L2FzdF9tb2RlLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2FzdC9hc3RfbW9kZS5jCkBAIC0xMDY0LDIzICsxMDY0LDYg
QEAgc3RhdGljIHZvaWQgYXN0X2kyY19kZXN0cm95KHN0cnVjdCBhc3RfaTJjX2NoYW4gKmkyYykK
IAlrZnJlZShpMmMpOwogfQogCi1zdGF0aWMgdm9pZCBhc3Rfc2hvd19jdXJzb3Ioc3RydWN0IGRy
bV9jcnRjICpjcnRjKQotewotCXN0cnVjdCBhc3RfcHJpdmF0ZSAqYXN0ID0gY3J0Yy0+ZGV2LT5k
ZXZfcHJpdmF0ZTsKLQl1OCBqcmVnOwotCi0JanJlZyA9IDB4MjsKLQkvKiBlbmFibGUgQVJHQiBj
dXJzb3IgKi8KLQlqcmVnIHw9IDE7Ci0JYXN0X3NldF9pbmRleF9yZWdfbWFzayhhc3QsIEFTVF9J
T19DUlRDX1BPUlQsIDB4Y2IsIDB4ZmMsIGpyZWcpOwotfQotCi1zdGF0aWMgdm9pZCBhc3RfaGlk
ZV9jdXJzb3Ioc3RydWN0IGRybV9jcnRjICpjcnRjKQotewotCXN0cnVjdCBhc3RfcHJpdmF0ZSAq
YXN0ID0gY3J0Yy0+ZGV2LT5kZXZfcHJpdmF0ZTsKLQlhc3Rfc2V0X2luZGV4X3JlZ19tYXNrKGFz
dCwgQVNUX0lPX0NSVENfUE9SVCwgMHhjYiwgMHhmYywgMHgwMCk7Ci19Ci0KIHN0YXRpYyB1MzIg
Y29weV9jdXJzb3JfaW1hZ2UodTggKnNyYywgdTggKmRzdCwgaW50IHdpZHRoLCBpbnQgaGVpZ2h0
KQogewogCXVuaW9uIHsKQEAgLTExMzcsNiArMTEyMCw3MiBAQCBzdGF0aWMgdTMyIGNvcHlfY3Vy
c29yX2ltYWdlKHU4ICpzcmMsIHU4ICpkc3QsIGludCB3aWR0aCwgaW50IGhlaWdodCkKIAlyZXR1
cm4gY3N1bTsKIH0KIAorc3RhdGljIGludCBhc3RfY3Vyc29yX3VwZGF0ZSh2b2lkICpkc3QsIHZv
aWQgKnNyYywgdW5zaWduZWQgaW50IHdpZHRoLAorCQkJICAgICB1bnNpZ25lZCBpbnQgaGVpZ2h0
KQoreworCXUzMiBjc3VtOworCisJLyogZG8gZGF0YSB0cmFuc2ZlciB0byBjdXJzb3IgY2FjaGUg
Ki8KKwljc3VtID0gY29weV9jdXJzb3JfaW1hZ2Uoc3JjLCBkc3QsIHdpZHRoLCBoZWlnaHQpOwor
CisJLyogd3JpdGUgY2hlY2tzdW0gKyBzaWduYXR1cmUgKi8KKwlkc3QgKz0gQVNUX0hXQ19TSVpF
OworCXdyaXRlbChjc3VtLCBkc3QpOworCXdyaXRlbCh3aWR0aCwgZHN0ICsgQVNUX0hXQ19TSUdO
QVRVUkVfU2l6ZVgpOworCXdyaXRlbChoZWlnaHQsIGRzdCArIEFTVF9IV0NfU0lHTkFUVVJFX1Np
emVZKTsKKwl3cml0ZWwoMCwgZHN0ICsgQVNUX0hXQ19TSUdOQVRVUkVfSE9UU1BPVFgpOworCXdy
aXRlbCgwLCBkc3QgKyBBU1RfSFdDX1NJR05BVFVSRV9IT1RTUE9UWSk7CisKKwlyZXR1cm4gMDsK
K30KKworc3RhdGljIHZvaWQgYXN0X2N1cnNvcl9zZXRfYmFzZShzdHJ1Y3QgYXN0X3ByaXZhdGUg
KmFzdCwgdTY0IGFkZHJlc3MpCit7CisJdTggYWRkcjAgPSAoYWRkcmVzcyA+PiAzKSAmIDB4ZmY7
CisJdTggYWRkcjEgPSAoYWRkcmVzcyA+PiAxMSkgJiAweGZmOworCXU4IGFkZHIyID0gKGFkZHJl
c3MgPj4gMTkpICYgMHhmZjsKKworCWFzdF9zZXRfaW5kZXhfcmVnKGFzdCwgQVNUX0lPX0NSVENf
UE9SVCwgMHhjOCwgYWRkcjApOworCWFzdF9zZXRfaW5kZXhfcmVnKGFzdCwgQVNUX0lPX0NSVENf
UE9SVCwgMHhjOSwgYWRkcjEpOworCWFzdF9zZXRfaW5kZXhfcmVnKGFzdCwgQVNUX0lPX0NSVENf
UE9SVCwgMHhjYSwgYWRkcjIpOworfQorCitzdGF0aWMgaW50IGFzdF9zaG93X2N1cnNvcihzdHJ1
Y3QgZHJtX2NydGMgKmNydGMsIHZvaWQgKmRzdCwgdm9pZCAqc3JjLAorCQkJICAgdW5zaWduZWQg
aW50IHdpZHRoLCB1bnNpZ25lZCBpbnQgaGVpZ2h0LAorCQkJICAgdTY0IGRzdF9ncHUpCit7CisJ
c3RydWN0IGFzdF9wcml2YXRlICphc3QgPSBjcnRjLT5kZXYtPmRldl9wcml2YXRlOworCXN0cnVj
dCBhc3RfY3J0YyAqYXN0X2NydGMgPSB0b19hc3RfY3J0YyhjcnRjKTsKKwlpbnQgcmV0OworCXU4
IGpyZWc7CisKKwlkc3QgKz0gKEFTVF9IV0NfU0laRSArIEFTVF9IV0NfU0lHTkFUVVJFX1NJWkUp
KmFzdC0+bmV4dF9jdXJzb3I7CisKKwlyZXQgPSBhc3RfY3Vyc29yX3VwZGF0ZShkc3QsIHNyYywg
d2lkdGgsIGhlaWdodCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKwlhc3RfY3Vyc29yX3Nl
dF9iYXNlKGFzdCwgZHN0X2dwdSk7CisKKwlhc3QtPm5leHRfY3Vyc29yID0gKGFzdC0+bmV4dF9j
dXJzb3IgKyAxKSAlIEFTVF9ERUZBVUxUX0hXQ19OVU07CisKKwlhc3RfY3J0Yy0+b2Zmc2V0X3gg
PSBBU1RfTUFYX0hXQ19XSURUSCAtIHdpZHRoOworCWFzdF9jcnRjLT5vZmZzZXRfeSA9IEFTVF9N
QVhfSFdDX1dJRFRIIC0gaGVpZ2h0OworCisJanJlZyA9IDB4MjsKKwkvKiBlbmFibGUgQVJHQiBj
dXJzb3IgKi8KKwlqcmVnIHw9IDE7CisJYXN0X3NldF9pbmRleF9yZWdfbWFzayhhc3QsIEFTVF9J
T19DUlRDX1BPUlQsIDB4Y2IsIDB4ZmMsIGpyZWcpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRp
YyB2b2lkIGFzdF9oaWRlX2N1cnNvcihzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCit7CisJc3RydWN0
IGFzdF9wcml2YXRlICphc3QgPSBjcnRjLT5kZXYtPmRldl9wcml2YXRlOworCisJYXN0X3NldF9p
bmRleF9yZWdfbWFzayhhc3QsIEFTVF9JT19DUlRDX1BPUlQsIDB4Y2IsIDB4ZmMsIDB4MDApOwor
fQorCiBzdGF0aWMgaW50IGFzdF9jdXJzb3Jfc2V0KHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKIAkJ
CSAgc3RydWN0IGRybV9maWxlICpmaWxlX3ByaXYsCiAJCQkgIHVpbnQzMl90IGhhbmRsZSwKQEAg
LTExNDQsMTIgKzExOTMsOSBAQCBzdGF0aWMgaW50IGFzdF9jdXJzb3Jfc2V0KHN0cnVjdCBkcm1f
Y3J0YyAqY3J0YywKIAkJCSAgdWludDMyX3QgaGVpZ2h0KQogewogCXN0cnVjdCBhc3RfcHJpdmF0
ZSAqYXN0ID0gY3J0Yy0+ZGV2LT5kZXZfcHJpdmF0ZTsKLQlzdHJ1Y3QgYXN0X2NydGMgKmFzdF9j
cnRjID0gdG9fYXN0X2NydGMoY3J0Yyk7CiAJc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmo7CiAJ
c3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKmdibzsKIAlzNjQgZHN0X2dwdTsKLQl1NjQgZ3B1
X2FkZHI7Ci0JdTMyIGNzdW07CiAJaW50IHJldDsKIAl1OCAqc3JjLCAqZHN0OwogCkBAIC0xMTg1
LDM3ICsxMjMxLDkgQEAgc3RhdGljIGludCBhc3RfY3Vyc29yX3NldChzdHJ1Y3QgZHJtX2NydGMg
KmNydGMsCiAJCWdvdG8gZXJyX2RybV9nZW1fdnJhbV92dW5tYXA7CiAJfQogCi0JZHN0ICs9IChB
U1RfSFdDX1NJWkUgKyBBU1RfSFdDX1NJR05BVFVSRV9TSVpFKSphc3QtPm5leHRfY3Vyc29yOwot
Ci0JLyogZG8gZGF0YSB0cmFuc2ZlciB0byBjdXJzb3IgY2FjaGUgKi8KLQljc3VtID0gY29weV9j
dXJzb3JfaW1hZ2Uoc3JjLCBkc3QsIHdpZHRoLCBoZWlnaHQpOwotCi0JLyogd3JpdGUgY2hlY2tz
dW0gKyBzaWduYXR1cmUgKi8KLQl7Ci0JCXN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpkc3Rf
Z2JvID0KLQkJCWRybV9nZW1fdnJhbV9vZl9nZW0oYXN0LT5jdXJzb3JfY2FjaGUpOwotCQl1OCAq
ZHN0ID0gZHJtX2dlbV92cmFtX2ttYXAoZHN0X2dibywgZmFsc2UsIE5VTEwpOwotCQlkc3QgKz0g
KEFTVF9IV0NfU0laRSArIEFTVF9IV0NfU0lHTkFUVVJFX1NJWkUpKmFzdC0+bmV4dF9jdXJzb3Ig
KyBBU1RfSFdDX1NJWkU7Ci0JCXdyaXRlbChjc3VtLCBkc3QpOwotCQl3cml0ZWwod2lkdGgsIGRz
dCArIEFTVF9IV0NfU0lHTkFUVVJFX1NpemVYKTsKLQkJd3JpdGVsKGhlaWdodCwgZHN0ICsgQVNU
X0hXQ19TSUdOQVRVUkVfU2l6ZVkpOwotCQl3cml0ZWwoMCwgZHN0ICsgQVNUX0hXQ19TSUdOQVRV
UkVfSE9UU1BPVFgpOwotCQl3cml0ZWwoMCwgZHN0ICsgQVNUX0hXQ19TSUdOQVRVUkVfSE9UU1BP
VFkpOwotCi0JCS8qIHNldCBwYXR0ZXJuIG9mZnNldCAqLwotCQlncHVfYWRkciA9ICh1NjQpZHN0
X2dwdTsKLQkJZ3B1X2FkZHIgKz0gKEFTVF9IV0NfU0laRSArIEFTVF9IV0NfU0lHTkFUVVJFX1NJ
WkUpKmFzdC0+bmV4dF9jdXJzb3I7Ci0JCWdwdV9hZGRyID4+PSAzOwotCQlhc3Rfc2V0X2luZGV4
X3JlZyhhc3QsIEFTVF9JT19DUlRDX1BPUlQsIDB4YzgsIGdwdV9hZGRyICYgMHhmZik7Ci0JCWFz
dF9zZXRfaW5kZXhfcmVnKGFzdCwgQVNUX0lPX0NSVENfUE9SVCwgMHhjOSwgKGdwdV9hZGRyID4+
IDgpICYgMHhmZik7Ci0JCWFzdF9zZXRfaW5kZXhfcmVnKGFzdCwgQVNUX0lPX0NSVENfUE9SVCwg
MHhjYSwgKGdwdV9hZGRyID4+IDE2KSAmIDB4ZmYpOwotCX0KLQlhc3RfY3J0Yy0+b2Zmc2V0X3gg
PSBBU1RfTUFYX0hXQ19XSURUSCAtIHdpZHRoOwotCWFzdF9jcnRjLT5vZmZzZXRfeSA9IEFTVF9N
QVhfSFdDX1dJRFRIIC0gaGVpZ2h0OwotCi0JYXN0LT5uZXh0X2N1cnNvciA9IChhc3QtPm5leHRf
Y3Vyc29yICsgMSkgJSBBU1RfREVGQVVMVF9IV0NfTlVNOwotCi0JYXN0X3Nob3dfY3Vyc29yKGNy
dGMpOworCXJldCA9IGFzdF9zaG93X2N1cnNvcihjcnRjLCBkc3QsIHNyYywgd2lkdGgsIGhlaWdo
dCwgZHN0X2dwdSk7CisJaWYgKHJldCkKKwkJZ290byBlcnJfZHJtX2dlbV92cmFtX2t1bm1hcDsK
IAogCWRybV9nZW1fdnJhbV92dW5tYXAoZ2JvLCBzcmMpOwogCWRybV9nZW1fb2JqZWN0X3B1dF91
bmxvY2tlZChvYmopOwotLSAKMi4yMy4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5m
cmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0
aW5mby9kcmktZGV2ZWw=
