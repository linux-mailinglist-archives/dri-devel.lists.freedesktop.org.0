Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 038CFF83FF
	for <lists+dri-devel@lfdr.de>; Tue, 12 Nov 2019 01:07:44 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 744306EA0C;
	Tue, 12 Nov 2019 00:07:21 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from hqemgate16.nvidia.com (hqemgate16.nvidia.com [216.228.121.65])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B56406EA0B
 for <dri-devel@lists.freedesktop.org>; Tue, 12 Nov 2019 00:07:17 +0000 (UTC)
Received: from hqpgpgate101.nvidia.com (Not Verified[216.228.121.13]) by
 hqemgate16.nvidia.com (using TLS: TLSv1.2, DES-CBC3-SHA)
 id <B5dc9f77d0000>; Mon, 11 Nov 2019 16:06:21 -0800
Received: from hqmail.nvidia.com ([172.20.161.6])
 by hqpgpgate101.nvidia.com (PGP Universal service);
 Mon, 11 Nov 2019 16:07:17 -0800
X-PGP-Universal: processed;
 by hqpgpgate101.nvidia.com on Mon, 11 Nov 2019 16:07:17 -0800
Received: from HQMAIL109.nvidia.com (172.20.187.15) by HQMAIL107.nvidia.com
 (172.20.187.13) with Microsoft SMTP Server (TLS) id 15.0.1473.3; Tue, 12 Nov
 2019 00:07:16 +0000
Received: from rnnvemgw01.nvidia.com (10.128.109.123) by HQMAIL109.nvidia.com
 (172.20.187.15) with Microsoft SMTP Server (TLS) id 15.0.1473.3 via
 Frontend Transport; Tue, 12 Nov 2019 00:07:15 +0000
Received: from blueforge.nvidia.com (Not Verified[10.110.48.28]) by
 rnnvemgw01.nvidia.com with Trustwave SEG (v7, 5, 8, 10121)
 id <B5dc9f7b20002>; Mon, 11 Nov 2019 16:07:15 -0800
From: John Hubbard <jhubbard@nvidia.com>
To: Andrew Morton <akpm@linux-foundation.org>
Subject: [PATCH v3 11/23] IB/{core, hw, umem}: set FOLL_PIN,
 FOLL_LONGTERM via pin_longterm_pages*()
Date: Mon, 11 Nov 2019 16:06:48 -0800
Message-ID: <20191112000700.3455038-12-jhubbard@nvidia.com>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191112000700.3455038-1-jhubbard@nvidia.com>
References: <20191112000700.3455038-1-jhubbard@nvidia.com>
MIME-Version: 1.0
X-NVConfidentiality: public
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=nvidia.com; s=n1; 
 t=1573517181; bh=5nX/THDsrOXdU0b+XUET79+1RnNMMrvnZjBYt5DvngE=;
 h=X-PGP-Universal:From:To:CC:Subject:Date:Message-ID:X-Mailer:
 In-Reply-To:References:MIME-Version:X-NVConfidentiality:
 Content-Transfer-Encoding:Content-Type;
 b=a5xgZrZr5Ib7OOgqqc8Afi9jpUPyK56KbytbYrThxUv8xQEpN1Z7ds54HklxwiErC
 2a+eH+pyET6Ra5wmbMV30IhV9k8m/4coaT9MWdeSfc0bua65zKIlk5fNkhm47pT5OU
 3YhmDNhefK8KVEyQhIubU9/lEkKlTfAqsaoKPiuLwgPp5SCIYnJkWGWuto63+etHXF
 FPu9Nkq1mJwv5xk6jTOf9QRU2FhNTp9H5k/GdHw7uv2p0Duzf/AaiIdIlJgmhUmEsl
 aIsTSFlvuyEufThNWAB/0+w9bl69hWNYGCbCeKVrvvf4T6J5NYaL2l4MqMhUlzDh+a
 QeeMzl+55wD2g==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Michal Hocko <mhocko@suse.com>, Jan Kara <jack@suse.cz>,
 kvm@vger.kernel.org, linux-doc@vger.kernel.org,
 David Airlie <airlied@linux.ie>, Dave Chinner <david@fromorbit.com>,
 dri-devel@lists.freedesktop.org, LKML <linux-kernel@vger.kernel.org>,
 linux-mm@kvack.org, Paul Mackerras <paulus@samba.org>,
 linux-kselftest@vger.kernel.org, Ira Weiny <ira.weiny@intel.com>,
 Jonathan Corbet <corbet@lwn.net>, linux-rdma@vger.kernel.org,
 Michael Ellerman <mpe@ellerman.id.au>, Christoph Hellwig <hch@infradead.org>,
 Jason Gunthorpe <jgg@ziepe.ca>, Vlastimil Babka <vbabka@suse.cz>,
 =?UTF-8?q?Bj=C3=B6rn=20T=C3=B6pel?= <bjorn.topel@intel.com>,
 linux-media@vger.kernel.org, Shuah Khan <shuah@kernel.org>,
 John Hubbard <jhubbard@nvidia.com>, linux-block@vger.kernel.org,
 =?UTF-8?q?J=C3=A9r=C3=B4me=20Glisse?= <jglisse@redhat.com>,
 Al Viro <viro@zeniv.linux.org.uk>, Dan Williams <dan.j.williams@intel.com>,
 Mauro Carvalho Chehab <mchehab@kernel.org>,
 Magnus Karlsson <magnus.karlsson@intel.com>, Jens Axboe <axboe@kernel.dk>,
 netdev@vger.kernel.org, Alex Williamson <alex.williamson@redhat.com>,
 linux-fsdevel@vger.kernel.org, bpf@vger.kernel.org,
 linuxppc-dev@lists.ozlabs.org, "David S . Miller" <davem@davemloft.net>,
 Mike Kravetz <mike.kravetz@oracle.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

Q29udmVydCBpbmZpbmliYW5kIHRvIHVzZSB0aGUgbmV3IHdyYXBwZXIgY2FsbHMsIGFuZCBzdG9w
CmV4cGxpY2l0bHkgc2V0dGluZyBGT0xMX0xPTkdURVJNIGF0IHRoZSBjYWxsIHNpdGVzLgoKVGhl
IG5ldyBwaW5fbG9uZ3Rlcm1fKigpIGNhbGxzIHJlcGxhY2UgZ2V0X3VzZXJfcGFnZXMqKCkKY2Fs
bHMsIGFuZCBzZXQgYm90aCBGT0xMX0xPTkdURVJNIGFuZCBhIG5ldyBGT0xMX1BJTgpmbGFnLiBU
aGUgRk9MTF9QSU4gZmxhZyByZXF1aXJlcyB0aGF0IHRoZSBjYWxsZXIgbXVzdApyZXR1cm4gdGhl
IHBhZ2VzIHZpYSBwdXRfdXNlcl9wYWdlKigpIGNhbGxzLCBidXQKaW5maW5pYmFuZCB3YXMgYWxy
ZWFkeSBkb2luZyB0aGF0IGFzIHBhcnQgb2YgYW4gZWFybGllcgpjb21taXQuCgpSZXZpZXdlZC1i
eTogSXJhIFdlaW55IDxpcmEud2VpbnlAaW50ZWwuY29tPgpTaWduZWQtb2ZmLWJ5OiBKb2huIEh1
YmJhcmQgPGpodWJiYXJkQG52aWRpYS5jb20+Ci0tLQogZHJpdmVycy9pbmZpbmliYW5kL2NvcmUv
dW1lbS5jICAgICAgICAgICAgICB8IDEwICsrKystLS0tLQogZHJpdmVycy9pbmZpbmliYW5kL2Nv
cmUvdW1lbV9vZHAuYyAgICAgICAgICB8IDI0ICsrKysrKysrKystLS0tLS0tLS0tLQogZHJpdmVy
cy9pbmZpbmliYW5kL2h3L2hmaTEvdXNlcl9wYWdlcy5jICAgICB8ICA0ICsrLS0KIGRyaXZlcnMv
aW5maW5pYmFuZC9ody9tdGhjYS9tdGhjYV9tZW1mcmVlLmMgfCAgMyArLS0KIGRyaXZlcnMvaW5m
aW5pYmFuZC9ody9xaWIvcWliX3VzZXJfcGFnZXMuYyAgfCAgOCArKystLS0tCiBkcml2ZXJzL2lu
ZmluaWJhbmQvaHcvcWliL3FpYl91c2VyX3NkbWEuYyAgIHwgIDIgKy0KIGRyaXZlcnMvaW5maW5p
YmFuZC9ody91c25pYy91c25pY191aW9tLmMgICAgfCAgOSArKysrLS0tLQogZHJpdmVycy9pbmZp
bmliYW5kL3N3L3Npdy9zaXdfbWVtLmMgICAgICAgICB8ICA1ICsrLS0tCiA4IGZpbGVzIGNoYW5n
ZWQsIDMxIGluc2VydGlvbnMoKyksIDM0IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvaW5maW5pYmFuZC9jb3JlL3VtZW0uYyBiL2RyaXZlcnMvaW5maW5pYmFuZC9jb3JlL3VtZW0u
YwppbmRleCAzZDY2NGEyNTM5ZWIuLjdmMDNmNzJlNmRjZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9p
bmZpbmliYW5kL2NvcmUvdW1lbS5jCisrKyBiL2RyaXZlcnMvaW5maW5pYmFuZC9jb3JlL3VtZW0u
YwpAQCAtMjcxLDExICsyNzEsMTEgQEAgc3RydWN0IGliX3VtZW0gKmliX3VtZW1fZ2V0KHN0cnVj
dCBpYl91ZGF0YSAqdWRhdGEsIHVuc2lnbmVkIGxvbmcgYWRkciwKIAlzZyA9IHVtZW0tPnNnX2hl
YWQuc2dsOwogCiAJd2hpbGUgKG5wYWdlcykgewotCQlyZXQgPSBnZXRfdXNlcl9wYWdlc19mYXN0
KGN1cl9iYXNlLAotCQkJCQkgIG1pbl90KHVuc2lnbmVkIGxvbmcsIG5wYWdlcywKLQkJCQkJCVBB
R0VfU0laRSAvCi0JCQkJCQlzaXplb2Yoc3RydWN0IHBhZ2UgKikpLAotCQkJCQkgIGd1cF9mbGFn
cyB8IEZPTExfTE9OR1RFUk0sIHBhZ2VfbGlzdCk7CisJCXJldCA9IHBpbl9sb25ndGVybV9wYWdl
c19mYXN0KGN1cl9iYXNlLAorCQkJCQkgICAgICBtaW5fdCh1bnNpZ25lZCBsb25nLCBucGFnZXMs
CisJCQkJCQkgICAgUEFHRV9TSVpFIC8KKwkJCQkJCSAgICBzaXplb2Yoc3RydWN0IHBhZ2UgKikp
LAorCQkJCQkgICAgICBndXBfZmxhZ3MsIHBhZ2VfbGlzdCk7CiAJCWlmIChyZXQgPCAwKQogCQkJ
Z290byB1bWVtX3JlbGVhc2U7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvaW5maW5pYmFuZC9jb3Jl
L3VtZW1fb2RwLmMgYi9kcml2ZXJzL2luZmluaWJhbmQvY29yZS91bWVtX29kcC5jCmluZGV4IDE2
M2ZmN2JhOTJiNy4uYjBhZTAzOWY4ODRkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2luZmluaWJhbmQv
Y29yZS91bWVtX29kcC5jCisrKyBiL2RyaXZlcnMvaW5maW5pYmFuZC9jb3JlL3VtZW1fb2RwLmMK
QEAgLTQ5NSw5ICs0OTUsOCBAQCBFWFBPUlRfU1lNQk9MKGliX3VtZW1fb2RwX3JlbGVhc2UpOwog
ICogVGhlIGZ1bmN0aW9uIHJldHVybnMgLUVGQVVMVCBpZiB0aGUgRE1BIG1hcHBpbmcgb3BlcmF0
aW9uIGZhaWxzLiBJdCByZXR1cm5zCiAgKiAtRUFHQUlOIGlmIGEgY29uY3VycmVudCBpbnZhbGlk
YXRpb24gcHJldmVudHMgdXMgZnJvbSB1cGRhdGluZyB0aGUgcGFnZS4KICAqCi0gKiBUaGUgcGFn
ZSBpcyByZWxlYXNlZCB2aWEgcHV0X3VzZXJfcGFnZSBldmVuIGlmIHRoZSBvcGVyYXRpb24gZmFp
bGVkLiBGb3IKLSAqIG9uLWRlbWFuZCBwaW5uaW5nLCB0aGUgcGFnZSBpcyByZWxlYXNlZCB3aGVu
ZXZlciBpdCBpc24ndCBzdG9yZWQgaW4gdGhlCi0gKiB1bWVtLgorICogVGhlIHBhZ2UgaXMgcmVs
ZWFzZWQgdmlhIHB1dF9wYWdlIGV2ZW4gaWYgdGhlIG9wZXJhdGlvbiBmYWlsZWQuIEZvciBvbi1k
ZW1hbmQKKyAqIHBpbm5pbmcsIHRoZSBwYWdlIGlzIHJlbGVhc2VkIHdoZW5ldmVyIGl0IGlzbid0
IHN0b3JlZCBpbiB0aGUgdW1lbS4KICAqLwogc3RhdGljIGludCBpYl91bWVtX29kcF9tYXBfZG1h
X3NpbmdsZV9wYWdlKAogCQlzdHJ1Y3QgaWJfdW1lbV9vZHAgKnVtZW1fb2RwLApAQCAtNTQyLDcg
KzU0MSw3IEBAIHN0YXRpYyBpbnQgaWJfdW1lbV9vZHBfbWFwX2RtYV9zaW5nbGVfcGFnZSgKIAl9
CiAKIG91dDoKLQlwdXRfdXNlcl9wYWdlKHBhZ2UpOworCXB1dF9wYWdlKHBhZ2UpOwogCiAJaWYg
KHJlbW92ZV9leGlzdGluZ19tYXBwaW5nKSB7CiAJCWliX3VtZW1fbm90aWZpZXJfc3RhcnRfYWNj
b3VudCh1bWVtX29kcCk7CkBAIC02MzksMTMgKzYzOCwxNCBAQCBpbnQgaWJfdW1lbV9vZHBfbWFw
X2RtYV9wYWdlcyhzdHJ1Y3QgaWJfdW1lbV9vZHAgKnVtZW1fb2RwLCB1NjQgdXNlcl92aXJ0LAog
CQkvKgogCQkgKiBOb3RlOiB0aGlzIG1pZ2h0IHJlc3VsdCBpbiByZWR1bmRlbnQgcGFnZSBnZXR0
aW5nLiBXZSBjYW4KIAkJICogYXZvaWQgdGhpcyBieSBjaGVja2luZyBkbWFfbGlzdCB0byBiZSAw
IGJlZm9yZSBjYWxsaW5nCi0JCSAqIGdldF91c2VyX3BhZ2VzLiBIb3dldmVyLCB0aGlzIG1ha2Ug
dGhlIGNvZGUgbXVjaCBtb3JlCi0JCSAqIGNvbXBsZXggKGFuZCBkb2Vzbid0IGdhaW4gdXMgbXVj
aCBwZXJmb3JtYW5jZSBpbiBtb3N0IHVzZQotCQkgKiBjYXNlcykuCisJCSAqIGdldF91c2VyX3Bh
Z2VzLiBIb3dldmVyLCB0aGlzIG1ha2VzIHRoZSBjb2RlIG11Y2gKKwkJICogbW9yZSBjb21wbGV4
IChhbmQgZG9lc24ndCBnYWluIHVzIG11Y2ggcGVyZm9ybWFuY2UgaW4gbW9zdAorCQkgKiB1c2Ug
Y2FzZXMpLgogCQkgKi8KIAkJbnBhZ2VzID0gZ2V0X3VzZXJfcGFnZXNfcmVtb3RlKG93bmluZ19w
cm9jZXNzLCBvd25pbmdfbW0sCi0JCQkJdXNlcl92aXJ0LCBndXBfbnVtX3BhZ2VzLAotCQkJCWZs
YWdzLCBsb2NhbF9wYWdlX2xpc3QsIE5VTEwsIE5VTEwpOworCQkJCQkgICAgICAgdXNlcl92aXJ0
LCBndXBfbnVtX3BhZ2VzLAorCQkJCQkgICAgICAgZmxhZ3MsIGxvY2FsX3BhZ2VfbGlzdCwgTlVM
TCwKKwkJCQkJICAgICAgIE5VTEwpOwogCQl1cF9yZWFkKCZvd25pbmdfbW0tPm1tYXBfc2VtKTsK
IAogCQlpZiAobnBhZ2VzIDwgMCkgewpAQCAtNjY1LDcgKzY2NSw3IEBAIGludCBpYl91bWVtX29k
cF9tYXBfZG1hX3BhZ2VzKHN0cnVjdCBpYl91bWVtX29kcCAqdW1lbV9vZHAsIHU2NCB1c2VyX3Zp
cnQsCiAJCQkJCXJldCA9IC1FRkFVTFQ7CiAJCQkJCWJyZWFrOwogCQkJCX0KLQkJCQlwdXRfdXNl
cl9wYWdlKGxvY2FsX3BhZ2VfbGlzdFtqXSk7CisJCQkJcHV0X3BhZ2UobG9jYWxfcGFnZV9saXN0
W2pdKTsKIAkJCQljb250aW51ZTsKIAkJCX0KIApAQCAtNjkyLDggKzY5Miw4IEBAIGludCBpYl91
bWVtX29kcF9tYXBfZG1hX3BhZ2VzKHN0cnVjdCBpYl91bWVtX29kcCAqdW1lbV9vZHAsIHU2NCB1
c2VyX3ZpcnQsCiAJCQkgKiBpYl91bWVtX29kcF9tYXBfZG1hX3NpbmdsZV9wYWdlKCkuCiAJCQkg
Ki8KIAkJCWlmIChucGFnZXMgLSAoaiArIDEpID4gMCkKLQkJCQlwdXRfdXNlcl9wYWdlcygmbG9j
YWxfcGFnZV9saXN0W2orMV0sCi0JCQkJCSAgICAgICBucGFnZXMgLSAoaiArIDEpKTsKKwkJCQly
ZWxlYXNlX3BhZ2VzKCZsb2NhbF9wYWdlX2xpc3RbaisxXSwKKwkJCQkJICAgICAgbnBhZ2VzIC0g
KGogKyAxKSk7CiAJCQlicmVhazsKIAkJfQogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvaW5maW5p
YmFuZC9ody9oZmkxL3VzZXJfcGFnZXMuYyBiL2RyaXZlcnMvaW5maW5pYmFuZC9ody9oZmkxL3Vz
ZXJfcGFnZXMuYwppbmRleCA0NjlhY2I5NjFmYmQuLjliNTViMGE3M2UyOSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9pbmZpbmliYW5kL2h3L2hmaTEvdXNlcl9wYWdlcy5jCisrKyBiL2RyaXZlcnMvaW5m
aW5pYmFuZC9ody9oZmkxL3VzZXJfcGFnZXMuYwpAQCAtMTA0LDkgKzEwNCw5IEBAIGludCBoZmkx
X2FjcXVpcmVfdXNlcl9wYWdlcyhzdHJ1Y3QgbW1fc3RydWN0ICptbSwgdW5zaWduZWQgbG9uZyB2
YWRkciwgc2l6ZV90IG5wCiAJCQkgICAgYm9vbCB3cml0YWJsZSwgc3RydWN0IHBhZ2UgKipwYWdl
cykKIHsKIAlpbnQgcmV0OwotCXVuc2lnbmVkIGludCBndXBfZmxhZ3MgPSBGT0xMX0xPTkdURVJN
IHwgKHdyaXRhYmxlID8gRk9MTF9XUklURSA6IDApOworCXVuc2lnbmVkIGludCBndXBfZmxhZ3Mg
PSAod3JpdGFibGUgPyBGT0xMX1dSSVRFIDogMCk7CiAKLQlyZXQgPSBnZXRfdXNlcl9wYWdlc19m
YXN0KHZhZGRyLCBucGFnZXMsIGd1cF9mbGFncywgcGFnZXMpOworCXJldCA9IHBpbl9sb25ndGVy
bV9wYWdlc19mYXN0KHZhZGRyLCBucGFnZXMsIGd1cF9mbGFncywgcGFnZXMpOwogCWlmIChyZXQg
PCAwKQogCQlyZXR1cm4gcmV0OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2luZmluaWJhbmQvaHcv
bXRoY2EvbXRoY2FfbWVtZnJlZS5jIGIvZHJpdmVycy9pbmZpbmliYW5kL2h3L210aGNhL210aGNh
X21lbWZyZWUuYwppbmRleCBlZGNjZmQ2ZTE3OGYuLmJlZWM3ZTRiOGE5NiAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9pbmZpbmliYW5kL2h3L210aGNhL210aGNhX21lbWZyZWUuYworKysgYi9kcml2ZXJz
L2luZmluaWJhbmQvaHcvbXRoY2EvbXRoY2FfbWVtZnJlZS5jCkBAIC00NzIsOCArNDcyLDcgQEAg
aW50IG10aGNhX21hcF91c2VyX2RiKHN0cnVjdCBtdGhjYV9kZXYgKmRldiwgc3RydWN0IG10aGNh
X3VhciAqdWFyLAogCQlnb3RvIG91dDsKIAl9CiAKLQlyZXQgPSBnZXRfdXNlcl9wYWdlc19mYXN0
KHVhZGRyICYgUEFHRV9NQVNLLCAxLAotCQkJCSAgRk9MTF9XUklURSB8IEZPTExfTE9OR1RFUk0s
IHBhZ2VzKTsKKwlyZXQgPSBwaW5fbG9uZ3Rlcm1fcGFnZXNfZmFzdCh1YWRkciAmIFBBR0VfTUFT
SywgMSwgRk9MTF9XUklURSwgcGFnZXMpOwogCWlmIChyZXQgPCAwKQogCQlnb3RvIG91dDsKIApk
aWZmIC0tZ2l0IGEvZHJpdmVycy9pbmZpbmliYW5kL2h3L3FpYi9xaWJfdXNlcl9wYWdlcy5jIGIv
ZHJpdmVycy9pbmZpbmliYW5kL2h3L3FpYi9xaWJfdXNlcl9wYWdlcy5jCmluZGV4IDZiZjc2NGU0
MTg5MS4uNjg0YTE0ZTE0ZDliIDEwMDY0NAotLS0gYS9kcml2ZXJzL2luZmluaWJhbmQvaHcvcWli
L3FpYl91c2VyX3BhZ2VzLmMKKysrIGIvZHJpdmVycy9pbmZpbmliYW5kL2h3L3FpYi9xaWJfdXNl
cl9wYWdlcy5jCkBAIC0xMDgsMTAgKzEwOCwxMCBAQCBpbnQgcWliX2dldF91c2VyX3BhZ2VzKHVu
c2lnbmVkIGxvbmcgc3RhcnRfcGFnZSwgc2l6ZV90IG51bV9wYWdlcywKIAogCWRvd25fcmVhZCgm
Y3VycmVudC0+bW0tPm1tYXBfc2VtKTsKIAlmb3IgKGdvdCA9IDA7IGdvdCA8IG51bV9wYWdlczsg
Z290ICs9IHJldCkgewotCQlyZXQgPSBnZXRfdXNlcl9wYWdlcyhzdGFydF9wYWdlICsgZ290ICog
UEFHRV9TSVpFLAotCQkJCSAgICAgbnVtX3BhZ2VzIC0gZ290LAotCQkJCSAgICAgRk9MTF9MT05H
VEVSTSB8IEZPTExfV1JJVEUgfCBGT0xMX0ZPUkNFLAotCQkJCSAgICAgcCArIGdvdCwgTlVMTCk7
CisJCXJldCA9IHBpbl9sb25ndGVybV9wYWdlcyhzdGFydF9wYWdlICsgZ290ICogUEFHRV9TSVpF
LAorCQkJCQkgbnVtX3BhZ2VzIC0gZ290LAorCQkJCQkgRk9MTF9XUklURSB8IEZPTExfRk9SQ0Us
CisJCQkJCSBwICsgZ290LCBOVUxMKTsKIAkJaWYgKHJldCA8IDApIHsKIAkJCXVwX3JlYWQoJmN1
cnJlbnQtPm1tLT5tbWFwX3NlbSk7CiAJCQlnb3RvIGJhaWxfcmVsZWFzZTsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvaW5maW5pYmFuZC9ody9xaWIvcWliX3VzZXJfc2RtYS5jIGIvZHJpdmVycy9pbmZp
bmliYW5kL2h3L3FpYi9xaWJfdXNlcl9zZG1hLmMKaW5kZXggMDUxOTBlZGMyNjExLi5mZDg2YTlk
MTkzNzAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvaW5maW5pYmFuZC9ody9xaWIvcWliX3VzZXJfc2Rt
YS5jCisrKyBiL2RyaXZlcnMvaW5maW5pYmFuZC9ody9xaWIvcWliX3VzZXJfc2RtYS5jCkBAIC02
NzAsNyArNjcwLDcgQEAgc3RhdGljIGludCBxaWJfdXNlcl9zZG1hX3Bpbl9wYWdlcyhjb25zdCBz
dHJ1Y3QgcWliX2RldmRhdGEgKmRkLAogCQllbHNlCiAJCQlqID0gbnBhZ2VzOwogCi0JCXJldCA9
IGdldF91c2VyX3BhZ2VzX2Zhc3QoYWRkciwgaiwgRk9MTF9MT05HVEVSTSwgcGFnZXMpOworCQly
ZXQgPSBwaW5fbG9uZ3Rlcm1fcGFnZXNfZmFzdChhZGRyLCBqLCAwLCBwYWdlcyk7CiAJCWlmIChy
ZXQgIT0gaikgewogCQkJaSA9IDA7CiAJCQlqID0gcmV0OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9p
bmZpbmliYW5kL2h3L3VzbmljL3VzbmljX3Vpb20uYyBiL2RyaXZlcnMvaW5maW5pYmFuZC9ody91
c25pYy91c25pY191aW9tLmMKaW5kZXggNjJlNmZmYTlhZDc4Li42YjkwY2ExYzM3NzEgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvaW5maW5pYmFuZC9ody91c25pYy91c25pY191aW9tLmMKKysrIGIvZHJp
dmVycy9pbmZpbmliYW5kL2h3L3VzbmljL3VzbmljX3Vpb20uYwpAQCAtMTQxLDExICsxNDEsMTAg
QEAgc3RhdGljIGludCB1c25pY191aW9tX2dldF9wYWdlcyh1bnNpZ25lZCBsb25nIGFkZHIsIHNp
emVfdCBzaXplLCBpbnQgd3JpdGFibGUsCiAJcmV0ID0gMDsKIAogCXdoaWxlIChucGFnZXMpIHsK
LQkJcmV0ID0gZ2V0X3VzZXJfcGFnZXMoY3VyX2Jhc2UsCi0JCQkJICAgICBtaW5fdCh1bnNpZ25l
ZCBsb25nLCBucGFnZXMsCi0JCQkJICAgICBQQUdFX1NJWkUgLyBzaXplb2Yoc3RydWN0IHBhZ2Ug
KikpLAotCQkJCSAgICAgZ3VwX2ZsYWdzIHwgRk9MTF9MT05HVEVSTSwKLQkJCQkgICAgIHBhZ2Vf
bGlzdCwgTlVMTCk7CisJCXJldCA9IHBpbl9sb25ndGVybV9wYWdlcyhjdXJfYmFzZSwKKwkJCQkJ
IG1pbl90KHVuc2lnbmVkIGxvbmcsIG5wYWdlcywKKwkJCQkJICAgICBQQUdFX1NJWkUgLyBzaXpl
b2Yoc3RydWN0IHBhZ2UgKikpLAorCQkJCQkgZ3VwX2ZsYWdzLCBwYWdlX2xpc3QsIE5VTEwpOwog
CiAJCWlmIChyZXQgPCAwKQogCQkJZ290byBvdXQ7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2luZmlu
aWJhbmQvc3cvc2l3L3Npd19tZW0uYyBiL2RyaXZlcnMvaW5maW5pYmFuZC9zdy9zaXcvc2l3X21l
bS5jCmluZGV4IGU5OTk4M2YwNzY2My4uMjBlNjYzZDdhZGE4IDEwMDY0NAotLS0gYS9kcml2ZXJz
L2luZmluaWJhbmQvc3cvc2l3L3Npd19tZW0uYworKysgYi9kcml2ZXJzL2luZmluaWJhbmQvc3cv
c2l3L3Npd19tZW0uYwpAQCAtNDI2LDkgKzQyNiw4IEBAIHN0cnVjdCBzaXdfdW1lbSAqc2l3X3Vt
ZW1fZ2V0KHU2NCBzdGFydCwgdTY0IGxlbiwgYm9vbCB3cml0YWJsZSkKIAkJd2hpbGUgKG5lbnRz
KSB7CiAJCQlzdHJ1Y3QgcGFnZSAqKnBsaXN0ID0gJnVtZW0tPnBhZ2VfY2h1bmtbaV0ucGxpc3Rb
Z290XTsKIAotCQkJcnYgPSBnZXRfdXNlcl9wYWdlcyhmaXJzdF9wYWdlX3ZhLCBuZW50cywKLQkJ
CQkJICAgIGZvbGxfZmxhZ3MgfCBGT0xMX0xPTkdURVJNLAotCQkJCQkgICAgcGxpc3QsIE5VTEwp
OworCQkJcnYgPSBwaW5fbG9uZ3Rlcm1fcGFnZXMoZmlyc3RfcGFnZV92YSwgbmVudHMsCisJCQkJ
CQlmb2xsX2ZsYWdzLCBwbGlzdCwgTlVMTCk7CiAJCQlpZiAocnYgPCAwKQogCQkJCWdvdG8gb3V0
X3NlbV91cDsKIAotLSAKMi4yNC4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVl
ZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5m
by9kcmktZGV2ZWw=
