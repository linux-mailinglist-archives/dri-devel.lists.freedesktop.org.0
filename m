Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 4ADA910D7EB
	for <lists+dri-devel@lfdr.de>; Fri, 29 Nov 2019 16:37:59 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0F7486E933;
	Fri, 29 Nov 2019 15:37:56 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from foss.arm.com (foss.arm.com [217.140.110.172])
 by gabe.freedesktop.org (Postfix) with ESMTP id 23FA46E933
 for <dri-devel@lists.freedesktop.org>; Fri, 29 Nov 2019 15:37:53 +0000 (UTC)
Received: from usa-sjc-imap-foss1.foss.arm.com (unknown [10.121.207.14])
 by usa-sjc-mx-foss1.foss.arm.com (Postfix) with ESMTP id 85DEA30E;
 Fri, 29 Nov 2019 07:37:53 -0800 (PST)
Received: from [10.1.194.43] (e112269-lin.cambridge.arm.com [10.1.194.43])
 by usa-sjc-imap-foss1.foss.arm.com (Postfix) with ESMTPSA id 9700D3F68E;
 Fri, 29 Nov 2019 07:37:52 -0800 (PST)
Subject: Re: [PATCH 7/8] drm/panfrost: Add the panfrost_gem_mapping concept
To: Boris Brezillon <boris.brezillon@collabora.com>,
 Rob Herring <robh+dt@kernel.org>, Tomeu Vizoso <tomeu@tomeuvizoso.net>,
 Alyssa Rosenzweig <alyssa.rosenzweig@collabora.com>
References: <20191129135908.2439529-1-boris.brezillon@collabora.com>
 <20191129135908.2439529-8-boris.brezillon@collabora.com>
From: Steven Price <steven.price@arm.com>
Message-ID: <77bce1fa-9213-f5d1-e2a0-2b17d9560749@arm.com>
Date: Fri, 29 Nov 2019 15:37:51 +0000
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.2.2
MIME-Version: 1.0
In-Reply-To: <20191129135908.2439529-8-boris.brezillon@collabora.com>
Content-Language: en-US
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: dri-devel@lists.freedesktop.org, stable@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gMjkvMTEvMjAxOSAxMzo1OSwgQm9yaXMgQnJlemlsbG9uIHdyb3RlOgo+IFdpdGggdGhlIGlu
dHJvZHVjdGlvbiBvZiBwZXItRkQgYWRkcmVzcyBzcGFjZSwgdGhlIHNhbWUgQk8gY2FuIGJlIG1h
cHBlZAo+IGluIGRpZmZlcmVudCBhZGRyZXNzIHNwYWNlIGlmIHRoZSBCTyBpcyBnbG9iYWxseSB2
aXNpYmxlIChHRU1fRkxJTkspCj4gYW5kIG9wZW5lZCBpbiBkaWZmZXJlbnQgY29udGV4dC4gVGhl
IGN1cnJlbnQgaW1wbGVtZW50YXRpb24gZG9lcyBub3QKPiB0YWtlIGNhc2UgaW50byBhY2NvdW50
LCBhbmQgYXR0YWNoZXMgdGhlIG1hcHBpbmcgZGlyZWN0bHkgdG8gdGhlCj4gcGFuZnJvc3RfZ2Vt
X29iamVjdC4KPiAKPiBMZXQncyBjcmVhdGUgYSBwYW5mcm9zdF9nZW1fbWFwcGluZyBzdHJ1Y3Qg
YW5kIGFsbG93IG11bHRpcGxlIG1hcHBpbmdzCj4gcGVyIEJPLgo+IAo+IFRoZSBtYXBwaW5ncyBh
cmUgcmVmY291bnRlZCwgd2hpY2ggaGVscHMgc29sdmUgYW5vdGhlciBwcm9ibGVtIHdoZXJlCj4g
bWFwcGluZ3Mgd2VyZSB0ZWFyZWQgZG93biAoR0VNIGhhbmRsZSBjbG9zZWQgYnkgdXNlcnNwYWNl
KSB3aGlsZSBHUFUKPiBqb2JzIGFjY2Vzc2luZyB0aG9zZSBCT3Mgd2VyZSBzdGlsbCBpbi1mbGln
aHQuIEpvYnMgbm93IGtlZXAgYQo+IHJlZmVyZW5jZSBvbiB0aGUgbWFwcGluZ3MgdGhleSB1c2Uu
Cj4gCj4gRml4ZXM6IGE1ZWZiNGM5YTU2MiAoImRybS9wYW5mcm9zdDogUmVzdHJ1Y3R1cmUgdGhl
IEdFTSBvYmplY3QgY3JlYXRpb24iKQo+IEZpeGVzOiA3MjgyZjc2NDVkMDYgKCJkcm0vcGFuZnJv
c3Q6IEltcGxlbWVudCBwZXIgRkQgYWRkcmVzcyBzcGFjZXMiKQo+IENjOiA8c3RhYmxlQHZnZXIu
a2VybmVsLm9yZz4KPiBTaWduZWQtb2ZmLWJ5OiBCb3JpcyBCcmV6aWxsb24gPGJvcmlzLmJyZXpp
bGxvbkBjb2xsYWJvcmEuY29tPgoKTG9va3MgZ29vZCwgc29tZSBtaW5vciBjb21tZW50cyBpbmxp
bmUuCgo+IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZHJ2LmMgICAg
ICAgfCAgOTIgKysrKysrKysrKystCj4gIGRyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9z
dF9nZW0uYyAgICAgICB8IDE0MCArKysrKysrKysrKysrKystLS0KPiAgZHJpdmVycy9ncHUvZHJt
L3BhbmZyb3N0L3BhbmZyb3N0X2dlbS5oICAgICAgIHwgIDQxICsrKystCj4gIC4uLi9ncHUvZHJt
L3BhbmZyb3N0L3BhbmZyb3N0X2dlbV9zaHJpbmtlci5jICB8ICAgNCArLQo+ICBkcml2ZXJzL2dw
dS9kcm0vcGFuZnJvc3QvcGFuZnJvc3Rfam9iLmMgICAgICAgfCAgMTMgKy0KPiAgZHJpdmVycy9n
cHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2pvYi5oICAgICAgIHwgICAxICsKPiAgZHJpdmVycy9n
cHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X21tdS5jICAgICAgIHwgIDYxICsrKystLS0tCj4gIGRy
aXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9tbXUuaCAgICAgICB8ICAgNiArLQo+ICBk
cml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfcGVyZmNudC5jICAgfCAgMzQgKysrLS0K
PiAgOSBmaWxlcyBjaGFuZ2VkLCAzMTggaW5zZXJ0aW9ucygrKSwgNzQgZGVsZXRpb25zKC0pCj4g
Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9kcnYuYyBi
L2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9kcnYuYwo+IGluZGV4IDc1MWRmOTc1
NTM0Zi4uYjQwNmI1MjQzYjQwIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9z
dC9wYW5mcm9zdF9kcnYuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9z
dF9kcnYuYwo+IEBAIC03OCw4ICs3OCwxMCBAQCBzdGF0aWMgaW50IHBhbmZyb3N0X2lvY3RsX2dl
dF9wYXJhbShzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwgdm9pZCAqZGF0YSwgc3RydWN0Cj4gIHN0
YXRpYyBpbnQgcGFuZnJvc3RfaW9jdGxfY3JlYXRlX2JvKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYs
IHZvaWQgKmRhdGEsCj4gIAkJc3RydWN0IGRybV9maWxlICpmaWxlKQo+ICB7Cj4gKwlzdHJ1Y3Qg
cGFuZnJvc3RfZmlsZV9wcml2ICpwcml2ID0gZmlsZS0+ZHJpdmVyX3ByaXY7Cj4gIAlzdHJ1Y3Qg
cGFuZnJvc3RfZ2VtX29iamVjdCAqYm87Cj4gIAlzdHJ1Y3QgZHJtX3BhbmZyb3N0X2NyZWF0ZV9i
byAqYXJncyA9IGRhdGE7Cj4gKwlzdHJ1Y3QgcGFuZnJvc3RfZ2VtX21hcHBpbmcgKm1hcHBpbmc7
Cj4gIAo+ICAJaWYgKCFhcmdzLT5zaXplIHx8IGFyZ3MtPnBhZCB8fAo+ICAJICAgIChhcmdzLT5m
bGFncyAmIH4oUEFORlJPU1RfQk9fTk9FWEVDIHwgUEFORlJPU1RfQk9fSEVBUCkpKQo+IEBAIC05
NSw3ICs5NywxNCBAQCBzdGF0aWMgaW50IHBhbmZyb3N0X2lvY3RsX2NyZWF0ZV9ibyhzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ICAJaWYgKElTX0VSUihibykpCj4gIAkJcmV0
dXJuIFBUUl9FUlIoYm8pOwo+ICAKPiAtCWFyZ3MtPm9mZnNldCA9IGJvLT5ub2RlLnN0YXJ0IDw8
IFBBR0VfU0hJRlQ7Cj4gKwltYXBwaW5nID0gcGFuZnJvc3RfZ2VtX21hcHBpbmdfZ2V0KGJvLCBw
cml2KTsKPiArCWlmICghbWFwcGluZykgewo+ICsJCWRybV9nZW1fb2JqZWN0X3B1dF91bmxvY2tl
ZCgmYm8tPmJhc2UuYmFzZSk7Cj4gKwkJcmV0dXJuIC1FSU5WQUw7Cj4gKwl9Cj4gKwo+ICsJYXJn
cy0+b2Zmc2V0ID0gbWFwcGluZy0+bW1ub2RlLnN0YXJ0IDw8IFBBR0VfU0hJRlQ7Cj4gKwlwYW5m
cm9zdF9nZW1fbWFwcGluZ19wdXQobWFwcGluZyk7Cj4gIAo+ICAJcmV0dXJuIDA7Cj4gIH0KPiBA
QCAtMTE5LDYgKzEyOCwxMSBAQCBwYW5mcm9zdF9sb29rdXBfYm9zKHN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYsCj4gIAkJICBzdHJ1Y3QgZHJtX3BhbmZyb3N0X3N1Ym1pdCAqYXJncywKPiAgCQkgIHN0
cnVjdCBwYW5mcm9zdF9qb2IgKmpvYikKPiAgewo+ICsJc3RydWN0IHBhbmZyb3N0X2ZpbGVfcHJp
diAqcHJpdiA9IGZpbGVfcHJpdi0+ZHJpdmVyX3ByaXY7Cj4gKwlzdHJ1Y3QgcGFuZnJvc3RfZ2Vt
X29iamVjdCAqYm87Cj4gKwl1bnNpZ25lZCBpbnQgaTsKPiArCWludCByZXQ7Cj4gKwo+ICAJam9i
LT5ib19jb3VudCA9IGFyZ3MtPmJvX2hhbmRsZV9jb3VudDsKPiAgCj4gIAlpZiAoIWpvYi0+Ym9f
Y291bnQpCj4gQEAgLTEzMCw5ICsxNDQsMzIgQEAgcGFuZnJvc3RfbG9va3VwX2JvcyhzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2LAo+ICAJaWYgKCFqb2ItPmltcGxpY2l0X2ZlbmNlcykKPiAgCQlyZXR1
cm4gLUVOT01FTTsKPiAgCj4gLQlyZXR1cm4gZHJtX2dlbV9vYmplY3RzX2xvb2t1cChmaWxlX3By
aXYsCj4gLQkJCQkgICAgICAodm9pZCBfX3VzZXIgKikodWludHB0cl90KWFyZ3MtPmJvX2hhbmRs
ZXMsCj4gLQkJCQkgICAgICBqb2ItPmJvX2NvdW50LCAmam9iLT5ib3MpOwo+ICsJcmV0ID0gZHJt
X2dlbV9vYmplY3RzX2xvb2t1cChmaWxlX3ByaXYsCj4gKwkJCQkgICAgICh2b2lkIF9fdXNlciAq
KSh1aW50cHRyX3QpYXJncy0+Ym9faGFuZGxlcywKPiArCQkJCSAgICAgam9iLT5ib19jb3VudCwg
JmpvYi0+Ym9zKTsKPiArCWlmIChyZXQpCj4gKwkJcmV0dXJuIHJldDsKPiArCj4gKwlqb2ItPm1h
cHBpbmdzID0ga3ZtYWxsb2NfYXJyYXkoam9iLT5ib19jb3VudCwKPiArCQkJCSAgICAgICBzaXpl
b2Yoc3RydWN0IHBhbmZyb3N0X2dlbV9tYXBwaW5nICopLAo+ICsJCQkJICAgICAgIEdGUF9LRVJO
RUwgfCBfX0dGUF9aRVJPKTsKPiArCWlmICgham9iLT5tYXBwaW5ncykKPiArCQlyZXR1cm4gLUVO
T01FTTsKPiArCj4gKwlmb3IgKGkgPSAwOyBpIDwgam9iLT5ib19jb3VudDsgaSsrKSB7Cj4gKwkJ
c3RydWN0IHBhbmZyb3N0X2dlbV9tYXBwaW5nICptYXBwaW5nOwo+ICsKPiArCQlibyA9IHRvX3Bh
bmZyb3N0X2JvKGpvYi0+Ym9zW2ldKTsKPiArCQltYXBwaW5nID0gcGFuZnJvc3RfZ2VtX21hcHBp
bmdfZ2V0KGJvLCBwcml2KTsKPiArCQlpZiAoIW1hcHBpbmcpIHsKPiArCQkJcmV0ID0gLUVJTlZB
TDsKPiArCQkJYnJlYWs7Cj4gKwkJfQo+ICsKPiArCQlqb2ItPm1hcHBpbmdzW2ldID0gbWFwcGlu
ZzsKPiArCX0KPiArCj4gKwlyZXR1cm4gcmV0Owo+ICB9Cj4gIAo+ICAvKioKPiBAQCAtMzIwLDcg
KzM1Nyw5IEBAIHN0YXRpYyBpbnQgcGFuZnJvc3RfaW9jdGxfbW1hcF9ibyhzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ICBzdGF0aWMgaW50IHBhbmZyb3N0X2lvY3RsX2dldF9i
b19vZmZzZXQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKPiAgCQkJICAgIHN0
cnVjdCBkcm1fZmlsZSAqZmlsZV9wcml2KQo+ICB7Cj4gKwlzdHJ1Y3QgcGFuZnJvc3RfZmlsZV9w
cml2ICpwcml2ID0gZmlsZV9wcml2LT5kcml2ZXJfcHJpdjsKPiAgCXN0cnVjdCBkcm1fcGFuZnJv
c3RfZ2V0X2JvX29mZnNldCAqYXJncyA9IGRhdGE7Cj4gKwlzdHJ1Y3QgcGFuZnJvc3RfZ2VtX21h
cHBpbmcgKm1hcHBpbmc7Cj4gIAlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdlbV9vYmo7Cj4gIAlz
dHJ1Y3QgcGFuZnJvc3RfZ2VtX29iamVjdCAqYm87Cj4gIAo+IEBAIC0zMzEsMTggKzM3MCwyNSBA
QCBzdGF0aWMgaW50IHBhbmZyb3N0X2lvY3RsX2dldF9ib19vZmZzZXQoc3RydWN0IGRybV9kZXZp
Y2UgKmRldiwgdm9pZCAqZGF0YSwKPiAgCX0KPiAgCWJvID0gdG9fcGFuZnJvc3RfYm8oZ2VtX29i
aik7Cj4gIAo+IC0JYXJncy0+b2Zmc2V0ID0gYm8tPm5vZGUuc3RhcnQgPDwgUEFHRV9TSElGVDsK
PiAtCj4gKwltYXBwaW5nID0gcGFuZnJvc3RfZ2VtX21hcHBpbmdfZ2V0KGJvLCBwcml2KTsKPiAg
CWRybV9nZW1fb2JqZWN0X3B1dF91bmxvY2tlZChnZW1fb2JqKTsKPiArCj4gKwlpZiAoIW1hcHBp
bmcpCj4gKwkJcmV0dXJuIC1FSU5WQUw7Cj4gKwo+ICsJYXJncy0+b2Zmc2V0ID0gbWFwcGluZy0+
bW1ub2RlLnN0YXJ0IDw8IFBBR0VfU0hJRlQ7Cj4gKwlwYW5mcm9zdF9nZW1fbWFwcGluZ19wdXQo
bWFwcGluZyk7Cj4gIAlyZXR1cm4gMDsKPiAgfQo+ICAKPiAgc3RhdGljIGludCBwYW5mcm9zdF9p
b2N0bF9tYWR2aXNlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gIAkJCQkg
IHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wcml2KQo+ICB7Cj4gKwlzdHJ1Y3QgcGFuZnJvc3RfZmls
ZV9wcml2ICpwcml2ID0gZmlsZV9wcml2LT5kcml2ZXJfcHJpdjsKPiAgCXN0cnVjdCBkcm1fcGFu
ZnJvc3RfbWFkdmlzZSAqYXJncyA9IGRhdGE7Cj4gIAlzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpw
ZmRldiA9IGRldi0+ZGV2X3ByaXZhdGU7Cj4gIAlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdlbV9v
Ymo7Cj4gKwlzdHJ1Y3QgcGFuZnJvc3RfZ2VtX29iamVjdCAqYm87Cj4gIAlpbnQgcmV0Owo+ICAK
PiAgCWdlbV9vYmogPSBkcm1fZ2VtX29iamVjdF9sb29rdXAoZmlsZV9wcml2LCBhcmdzLT5oYW5k
bGUpOwo+IEBAIC0zNjQsMTggKzQxMCw0OCBAQCBzdGF0aWMgaW50IHBhbmZyb3N0X2lvY3RsX21h
ZHZpc2Uoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKPiAgCWlmIChyZXQpCj4g
IAkJZ290byBvdXRfdW5sb2NrX29iamVjdF9uYW1lOwo+ICAKPiArCWJvID0gdG9fcGFuZnJvc3Rf
Ym8oZ2VtX29iaik7Cj4gKwo+ICAJbXV0ZXhfbG9jaygmcGZkZXYtPnNocmlua2VyX2xvY2spOwo+
ICsJbXV0ZXhfbG9jaygmYm8tPm1hcHBpbmdzLmxvY2spOwo+ICsJaWYgKGFyZ3MtPm1hZHYgPT0g
UEFORlJPU1RfTUFEVl9ET05UTkVFRCkgewo+ICsJCXN0cnVjdCBwYW5mcm9zdF9nZW1fbWFwcGlu
ZyAqZmlyc3QsICpsYXN0Owo+ICsKPiArCQlmaXJzdCA9IGxpc3RfZmlyc3RfZW50cnkoJmJvLT5t
YXBwaW5ncy5saXN0LAo+ICsJCQkJCSBzdHJ1Y3QgcGFuZnJvc3RfZ2VtX21hcHBpbmcsCj4gKwkJ
CQkJIG5vZGUpOwo+ICsJCWxhc3QgPSBsaXN0X2xhc3RfZW50cnkoJmJvLT5tYXBwaW5ncy5saXN0
LAo+ICsJCQkJICAgICAgIHN0cnVjdCBwYW5mcm9zdF9nZW1fbWFwcGluZywKPiArCQkJCSAgICAg
ICBub2RlKTsKPiArCj4gKwkJLyoKPiArCQkgKiBJZiB3ZSB3YW50IHRvIG1hcmsgdGhlIEJPIHB1
cmdlYWJsZSwgdGhlcmUgbXVzdCBiZSBvbmx5IG9uZQo+ICsJCSAqIHVzZXI6IHRoZSBjYWxsZXIg
RkQuCj4gKwkJICogV2UgY291bGQgZG8gc29tZXRoaW5nIHNtYXJ0ZXIgYW5kIG1hcmsgdGhlIEJP
IHB1cmdlYWJsZSBvbmx5Cj4gKwkJICogd2hlbiBhbGwgaXRzIHVzZXJzIGhhdmUgbWFya2VkIGl0
IHB1cmdlYWJsZSwgYnV0IGdsb2JhbGx5Cj4gKwkJICogdmlzaWJsZS9zaGFyZWQgQk9zIGFyZSBs
aWtlbHkgdG8gbmV2ZXIgYmUgbWFya2VkIHB1cmdlYWJsZQo+ICsJCSAqIGFueXdheSwgc28gbGV0
J3Mgbm90IGJvdGhlci4KPiArCQkgKi8KPiArCQlpZiAoZmlyc3QgIT0gbGFzdCB8fCBXQVJOX09O
X09OQ0UoZmlyc3QtPm1tdSAhPSAmcHJpdi0+bW11KSkgewo+ICsJCQlyZXQgPSAtRUlOVkFMOwo+
ICsJCQlnb3RvIG91dF91bmxvY2tfbWFwcGluZ3M7Cj4gKwkJfQo+ICsJfQo+ICsKPiAgCWFyZ3Mt
PnJldGFpbmVkID0gZHJtX2dlbV9zaG1lbV9tYWR2aXNlKGdlbV9vYmosIGFyZ3MtPm1hZHYpOwo+
ICAKPiAgCWlmIChhcmdzLT5yZXRhaW5lZCkgewo+IC0JCXN0cnVjdCBwYW5mcm9zdF9nZW1fb2Jq
ZWN0ICpibyA9IHRvX3BhbmZyb3N0X2JvKGdlbV9vYmopOwo+IC0KPiAgCQlpZiAoYXJncy0+bWFk
diA9PSBQQU5GUk9TVF9NQURWX0RPTlRORUVEKQo+ICAJCQlsaXN0X2FkZF90YWlsKCZiby0+YmFz
ZS5tYWR2X2xpc3QsCj4gIAkJCQkgICAgICAmcGZkZXYtPnNocmlua2VyX2xpc3QpOwo+ICAJCWVs
c2UgaWYgKGFyZ3MtPm1hZHYgPT0gUEFORlJPU1RfTUFEVl9XSUxMTkVFRCkKPiAgCQkJbGlzdF9k
ZWxfaW5pdCgmYm8tPmJhc2UubWFkdl9saXN0KTsKPiAgCX0KPiArCj4gKwlyZXQgPSAwOwoKTklU
OiBUaGlzIGlzIHVubmVjZXNzYXJ5IC0gcmV0IHdpbGwgYWxyZWFkeSBiZSAwLgoKPiArCj4gK291
dF91bmxvY2tfbWFwcGluZ3M6Cj4gKwltdXRleF91bmxvY2soJmJvLT5tYXBwaW5ncy5sb2NrKTsK
PiAgCW11dGV4X3VubG9jaygmcGZkZXYtPnNocmlua2VyX2xvY2spOwo+ICAKPiAgb3V0X3VubG9j
a19vYmplY3RfbmFtZToKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3Bh
bmZyb3N0X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2dlbS5jCj4g
aW5kZXggMzFkNjQxN2RkMjFjLi41YTJjNDYzYzQ1ZDMgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2dlbS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3Bh
bmZyb3N0L3BhbmZyb3N0X2dlbS5jCj4gQEAgLTI5LDYgKzI5LDEyIEBAIHN0YXRpYyB2b2lkIHBh
bmZyb3N0X2dlbV9mcmVlX29iamVjdChzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iaikKPiAgCWxp
c3RfZGVsX2luaXQoJmJvLT5iYXNlLm1hZHZfbGlzdCk7Cj4gIAltdXRleF91bmxvY2soJnBmZGV2
LT5zaHJpbmtlcl9sb2NrKTsKPiAgCj4gKwkvKgo+ICsJICogSWYgd2Ugc3RpbGwgaGF2ZSBtYXBw
aW5ncyBhdHRhY2hlZCB0byB0aGUgQk8sIHRoZXJlJ3MgYSBwcm9ibGVtIGluCj4gKwkgKiBvdXIg
cmVmY291bnRpbmcuCj4gKwkgKi8KPiArCVdBUk5fT05fT05DRSghbGlzdF9lbXB0eSgmYm8tPm1h
cHBpbmdzLmxpc3QpKTsKPiArCj4gIAlpZiAoYm8tPnNndHMpIHsKPiAgCQlpbnQgaTsKPiAgCQlp
bnQgbl9zZ3QgPSBiby0+YmFzZS5iYXNlLnNpemUgLyBTWl8yTTsKPiBAQCAtNDYsNiArNTIsNzAg
QEAgc3RhdGljIHZvaWQgcGFuZnJvc3RfZ2VtX2ZyZWVfb2JqZWN0KHN0cnVjdCBkcm1fZ2VtX29i
amVjdCAqb2JqKQo+ICAJZHJtX2dlbV9zaG1lbV9mcmVlX29iamVjdChvYmopOwo+ICB9Cj4gIAo+
ICtzdHJ1Y3QgcGFuZnJvc3RfZ2VtX21hcHBpbmcgKgo+ICtwYW5mcm9zdF9nZW1fbWFwcGluZ19n
ZXQoc3RydWN0IHBhbmZyb3N0X2dlbV9vYmplY3QgKmJvLAo+ICsJCQkgc3RydWN0IHBhbmZyb3N0
X2ZpbGVfcHJpdiAqcHJpdikKPiArewo+ICsJc3RydWN0IHBhbmZyb3N0X2dlbV9tYXBwaW5nICpt
YXBwaW5nID0gTlVMTCwgKml0ZXI7Cj4gKwo+ICsJbXV0ZXhfbG9jaygmYm8tPm1hcHBpbmdzLmxv
Y2spOwo+ICsJbGlzdF9mb3JfZWFjaF9lbnRyeShpdGVyLCAmYm8tPm1hcHBpbmdzLmxpc3QsIG5v
ZGUpIHsKPiArCQlpZiAoaXRlci0+bW11ID09ICZwcml2LT5tbXUpIHsKPiArCQkJa3JlZl9nZXQo
Jml0ZXItPnJlZmNvdW50KTsKPiArCQkJbWFwcGluZyA9IGl0ZXI7CgpBZGQgYSAiYnJlYWsiIGhl
cmUsIG9yIGEgV0FSTl9PTihtYXBwaW5nKSBpZiB5b3UgZG9uJ3QgdHJ1c3QgdGhhdAp0aGVyZSdz
IG9ubHkgZXZlciBvbmUgbWFwcGluZyBtYXRjaGluZyB0aGUgbW11Li4uIDspCgo+ICsJCX0KPiAr
CX0KPiArCW11dGV4X3VubG9jaygmYm8tPm1hcHBpbmdzLmxvY2spOwo+ICsKPiArCXJldHVybiBt
YXBwaW5nOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZAo+ICtwYW5mcm9zdF9nZW1fdGVhcmRvd25f
bWFwcGluZyhzdHJ1Y3QgcGFuZnJvc3RfZ2VtX21hcHBpbmcgKm1hcHBpbmcpCj4gK3sKPiArCXN0
cnVjdCBwYW5mcm9zdF9maWxlX3ByaXYgKnByaXY7Cj4gKwo+ICsJaWYgKG1hcHBpbmctPmFjdGl2
ZSkKPiArCQlwYW5mcm9zdF9tbXVfdW5tYXAobWFwcGluZyk7Cj4gKwo+ICsJcHJpdiA9IGNvbnRh
aW5lcl9vZihtYXBwaW5nLT5tbXUsIHN0cnVjdCBwYW5mcm9zdF9maWxlX3ByaXYsIG1tdSk7Cj4g
KwlzcGluX2xvY2soJnByaXYtPm1tX2xvY2spOwo+ICsJaWYgKGRybV9tbV9ub2RlX2FsbG9jYXRl
ZCgmbWFwcGluZy0+bW1ub2RlKSkKPiArCQlkcm1fbW1fcmVtb3ZlX25vZGUoJm1hcHBpbmctPm1t
bm9kZSk7Cj4gKwlzcGluX3VubG9jaygmcHJpdi0+bW1fbG9jayk7Cj4gK30KPiArCj4gK3N0YXRp
YyB2b2lkIHBhbmZyb3N0X2dlbV9tYXBwaW5nX3JlbGVhc2Uoc3RydWN0IGtyZWYgKmtyZWYpCj4g
K3sKPiArCXN0cnVjdCBwYW5mcm9zdF9nZW1fbWFwcGluZyAqbWFwcGluZzsKPiArCXN0cnVjdCBw
YW5mcm9zdF9maWxlX3ByaXYgKnByaXY7Cj4gKwo+ICsJbWFwcGluZyA9IGNvbnRhaW5lcl9vZihr
cmVmLCBzdHJ1Y3QgcGFuZnJvc3RfZ2VtX21hcHBpbmcsIHJlZmNvdW50KTsKPiArCXByaXYgPSBj
b250YWluZXJfb2YobWFwcGluZy0+bW11LCBzdHJ1Y3QgcGFuZnJvc3RfZmlsZV9wcml2LCBtbXUp
OwoKJ3ByaXYnIGlzbid0IHVzZWQKCj4gKwo+ICsJcGFuZnJvc3RfZ2VtX3RlYXJkb3duX21hcHBp
bmcobWFwcGluZyk7Cj4gKwlkcm1fZ2VtX29iamVjdF9wdXRfdW5sb2NrZWQoJm1hcHBpbmctPm9i
ai0+YmFzZS5iYXNlKTsKPiArCWtmcmVlKG1hcHBpbmcpOwo+ICt9Cj4gKwo+ICt2b2lkIHBhbmZy
b3N0X2dlbV9tYXBwaW5nX3B1dChzdHJ1Y3QgcGFuZnJvc3RfZ2VtX21hcHBpbmcgKm1hcHBpbmcp
Cj4gK3sKPiArCWlmICghbWFwcGluZykKPiArCQlyZXR1cm47Cj4gKwo+ICsJa3JlZl9wdXQoJm1h
cHBpbmctPnJlZmNvdW50LCBwYW5mcm9zdF9nZW1fbWFwcGluZ19yZWxlYXNlKTsKPiArfQo+ICsK
PiArdm9pZCBwYW5mcm9zdF9nZW1fdGVhcmRvd25fbWFwcGluZ3Moc3RydWN0IHBhbmZyb3N0X2dl
bV9vYmplY3QgKmJvKQo+ICt7Cj4gKwlzdHJ1Y3QgcGFuZnJvc3RfZ2VtX21hcHBpbmcgKm1hcHBp
bmc7Cj4gKwo+ICsJbXV0ZXhfbG9jaygmYm8tPm1hcHBpbmdzLmxvY2spOwo+ICsJbGlzdF9mb3Jf
ZWFjaF9lbnRyeShtYXBwaW5nLCAmYm8tPm1hcHBpbmdzLmxpc3QsIG5vZGUpCj4gKwkJcGFuZnJv
c3RfZ2VtX3RlYXJkb3duX21hcHBpbmcobWFwcGluZyk7Cj4gKwltdXRleF91bmxvY2soJmJvLT5t
YXBwaW5ncy5sb2NrKTsKPiArfQo+ICsKPiAgaW50IHBhbmZyb3N0X2dlbV9vcGVuKHN0cnVjdCBk
cm1fZ2VtX29iamVjdCAqb2JqLCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdikKPiAgewo+ICAJ
aW50IHJldDsKPiBAQCAtNTQsNiArMTI0LDE2IEBAIGludCBwYW5mcm9zdF9nZW1fb3BlbihzdHJ1
Y3QgZHJtX2dlbV9vYmplY3QgKm9iaiwgc3RydWN0IGRybV9maWxlICpmaWxlX3ByaXYpCj4gIAlz
dHJ1Y3QgcGFuZnJvc3RfZ2VtX29iamVjdCAqYm8gPSB0b19wYW5mcm9zdF9ibyhvYmopOwo+ICAJ
dW5zaWduZWQgbG9uZyBjb2xvciA9IGJvLT5ub2V4ZWMgPyBQQU5GUk9TVF9CT19OT0VYRUMgOiAw
Owo+ICAJc3RydWN0IHBhbmZyb3N0X2ZpbGVfcHJpdiAqcHJpdiA9IGZpbGVfcHJpdi0+ZHJpdmVy
X3ByaXY7Cj4gKwlzdHJ1Y3QgcGFuZnJvc3RfZ2VtX21hcHBpbmcgKm1hcHBpbmc7Cj4gKwo+ICsJ
bWFwcGluZyA9IGt6YWxsb2Moc2l6ZW9mKCptYXBwaW5nKSwgR0ZQX0tFUk5FTCk7Cj4gKwlpZiAo
IW1hcHBpbmcpCj4gKwkJcmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsJSU5JVF9MSVNUX0hFQUQoJm1h
cHBpbmctPm5vZGUpOwo+ICsJa3JlZl9pbml0KCZtYXBwaW5nLT5yZWZjb3VudCk7Cj4gKwlkcm1f
Z2VtX29iamVjdF9nZXQob2JqKTsKPiArCW1hcHBpbmctPm9iaiA9IGJvOwo+ICAKPiAgCS8qCj4g
IAkgKiBFeGVjdXRhYmxlIGJ1ZmZlcnMgY2Fubm90IGNyb3NzIGEgMTZNQiBib3VuZGFyeSBhcyB0
aGUgcHJvZ3JhbQo+IEBAIC02NiwzNyArMTQ2LDYxIEBAIGludCBwYW5mcm9zdF9nZW1fb3Blbihz
dHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iaiwgc3RydWN0IGRybV9maWxlICpmaWxlX3ByaXYpCj4g
IAllbHNlCj4gIAkJYWxpZ24gPSBzaXplID49IFNaXzJNID8gU1pfMk0gPj4gUEFHRV9TSElGVCA6
IDA7Cj4gIAo+IC0JYm8tPm1tdSA9ICZwcml2LT5tbXU7Cj4gKwltYXBwaW5nLT5tbXUgPSAmcHJp
di0+bW11Owo+ICAJc3Bpbl9sb2NrKCZwcml2LT5tbV9sb2NrKTsKPiAtCXJldCA9IGRybV9tbV9p
bnNlcnRfbm9kZV9nZW5lcmljKCZwcml2LT5tbSwgJmJvLT5ub2RlLAo+ICsJcmV0ID0gZHJtX21t
X2luc2VydF9ub2RlX2dlbmVyaWMoJnByaXYtPm1tLCAmbWFwcGluZy0+bW1ub2RlLAo+ICAJCQkJ
CSBzaXplID4+IFBBR0VfU0hJRlQsIGFsaWduLCBjb2xvciwgMCk7Cj4gIAlzcGluX3VubG9jaygm
cHJpdi0+bW1fbG9jayk7Cj4gIAlpZiAocmV0KQo+IC0JCXJldHVybiByZXQ7Cj4gKwkJZ290byBl
cnI7Cj4gIAo+ICAJaWYgKCFiby0+aXNfaGVhcCkgewo+IC0JCXJldCA9IHBhbmZyb3N0X21tdV9t
YXAoYm8pOwo+IC0JCWlmIChyZXQpIHsKPiAtCQkJc3Bpbl9sb2NrKCZwcml2LT5tbV9sb2NrKTsK
PiAtCQkJZHJtX21tX3JlbW92ZV9ub2RlKCZiby0+bm9kZSk7Cj4gLQkJCXNwaW5fdW5sb2NrKCZw
cml2LT5tbV9sb2NrKTsKPiAtCQl9Cj4gKwkJcmV0ID0gcGFuZnJvc3RfbW11X21hcChtYXBwaW5n
KTsKPiArCQlpZiAocmV0KQo+ICsJCQlnb3RvIGVycjsKPiAgCX0KPiArCj4gKwltdXRleF9sb2Nr
KCZvYmotPmRldi0+b2JqZWN0X25hbWVfbG9jayk7Cj4gKwkvKgo+ICsJICogV2UgbXVzdCBtYWtl
IHN1cmUgdGhlIEJPIGhhcyBub3QgYmVlbiBtYXJrZWQgcHVyZ2VhYmxlIGJlZm9yZQo+ICsJICog
YWRkaW5nIHRoZSBtYXBwaW5nLgo+ICsJICovCj4gKwlpZiAoYm8tPmJhc2UubWFkdiA9PSBQQU5G
Uk9TVF9NQURWX1dJTExORUVEKSB7Cj4gKwkJbXV0ZXhfbG9jaygmYm8tPm1hcHBpbmdzLmxvY2sp
Owo+ICsJCWxpc3RfYWRkX3RhaWwoJm1hcHBpbmctPm5vZGUsICZiby0+bWFwcGluZ3MubGlzdCk7
Cj4gKwkJbXV0ZXhfdW5sb2NrKCZiby0+bWFwcGluZ3MubG9jayk7Cj4gKwl9IGVsc2Ugewo+ICsJ
CXJldCA9IC1FSU5WQUw7Cj4gKwl9Cj4gKwltdXRleF91bmxvY2soJm9iai0+ZGV2LT5vYmplY3Rf
bmFtZV9sb2NrKTsKPiArCj4gKwlpZiAocmV0KQo+ICsJCWdvdG8gZXJyOwo+ICsKPiArCXJldHVy
biAwOwo+ICsKPiArZXJyOgo+ICsJcGFuZnJvc3RfZ2VtX21hcHBpbmdfcHV0KG1hcHBpbmcpOwo+
ICAJcmV0dXJuIHJldDsKClRoYXQgY2FuIGJlIHNpbXBsaWZpZWQgdG86CgplcnI6CglpZiAocmV0
KQoJCXBhbmZyb3N0X2dlbV9tYXBwaW5nX3B1dChtYXBwaW5nKTsKCXJldHVybiByZXQ7Cgo+ICB9
Cj4gIAo+ICB2b2lkIHBhbmZyb3N0X2dlbV9jbG9zZShzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9i
aiwgc3RydWN0IGRybV9maWxlICpmaWxlX3ByaXYpCj4gIHsKPiAtCXN0cnVjdCBwYW5mcm9zdF9n
ZW1fb2JqZWN0ICpibyA9IHRvX3BhbmZyb3N0X2JvKG9iaik7Cj4gIAlzdHJ1Y3QgcGFuZnJvc3Rf
ZmlsZV9wcml2ICpwcml2ID0gZmlsZV9wcml2LT5kcml2ZXJfcHJpdjsKPiArCXN0cnVjdCBwYW5m
cm9zdF9nZW1fb2JqZWN0ICpibyA9IHRvX3BhbmZyb3N0X2JvKG9iaik7Cj4gKwlzdHJ1Y3QgcGFu
ZnJvc3RfZ2VtX21hcHBpbmcgKm1hcHBpbmcgPSBOVUxMLCAqaXRlcjsKPiArCj4gKwltdXRleF9s
b2NrKCZiby0+bWFwcGluZ3MubG9jayk7Cj4gKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KGl0ZXIsICZi
by0+bWFwcGluZ3MubGlzdCwgbm9kZSkgewo+ICsJCWlmIChpdGVyLT5tbXUgPT0gJnByaXYtPm1t
dSkgewo+ICsJCQltYXBwaW5nID0gaXRlcjsKPiArCQkJbGlzdF9kZWwoJml0ZXItPm5vZGUpOwo+
ICsJCQlicmVhazsKPiArCQl9Cj4gKwl9Cj4gKwltdXRleF91bmxvY2soJmJvLT5tYXBwaW5ncy5s
b2NrKTsKPiAgCj4gLQlpZiAoYm8tPmlzX21hcHBlZCkKPiAtCQlwYW5mcm9zdF9tbXVfdW5tYXAo
Ym8pOwo+IC0KPiAtCXNwaW5fbG9jaygmcHJpdi0+bW1fbG9jayk7Cj4gLQlpZiAoZHJtX21tX25v
ZGVfYWxsb2NhdGVkKCZiby0+bm9kZSkpCj4gLQkJZHJtX21tX3JlbW92ZV9ub2RlKCZiby0+bm9k
ZSk7Cj4gLQlzcGluX3VubG9jaygmcHJpdi0+bW1fbG9jayk7Cj4gKwlwYW5mcm9zdF9nZW1fbWFw
cGluZ19wdXQobWFwcGluZyk7Cj4gIH0KPiAgCj4gIHN0YXRpYyBzdHJ1Y3QgZG1hX2J1ZiAqCj4g
QEAgLTE2Myw2ICsyNjcsOCBAQCBzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKnBhbmZyb3N0X2dlbV9j
cmVhdGVfb2JqZWN0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHNpemVfdAo+ICAJaWYgKCFvYmop
Cj4gIAkJcmV0dXJuIE5VTEw7Cj4gIAo+ICsJSU5JVF9MSVNUX0hFQUQoJm9iai0+bWFwcGluZ3Mu
bGlzdCk7Cj4gKwltdXRleF9pbml0KCZvYmotPm1hcHBpbmdzLmxvY2spOwo+ICAJb2JqLT5iYXNl
LmJhc2UuZnVuY3MgPSAmcGFuZnJvc3RfZ2VtX2Z1bmNzOwo+ICAKPiAgCXJldHVybiAmb2JqLT5i
YXNlLmJhc2U7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9z
dF9nZW0uaCBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9nZW0uaAo+IGluZGV4
IDRiMTdlNzMwODc2NC4uY2ExYmM5MDE5NjAwIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9wYW5mcm9zdC9wYW5mcm9zdF9nZW0uaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9z
dC9wYW5mcm9zdF9nZW0uaAo+IEBAIC0xMywyMyArMTMsNDYgQEAgc3RydWN0IHBhbmZyb3N0X2dl
bV9vYmplY3Qgewo+ICAJc3RydWN0IGRybV9nZW1fc2htZW1fb2JqZWN0IGJhc2U7Cj4gIAlzdHJ1
Y3Qgc2dfdGFibGUgKnNndHM7Cj4gIAo+IC0Jc3RydWN0IHBhbmZyb3N0X21tdSAqbW11Owo+IC0J
c3RydWN0IGRybV9tbV9ub2RlIG5vZGU7Cj4gLQlib29sIGlzX21hcHBlZAkJOjE7Cj4gKwkvKgo+
ICsJICogVXNlIGEgbGlzdCBmb3Igbm93LiBJZiBzZWFyY2hpbmcgYSBtYXBwaW5nIGV2ZXIgYmVj
b21lcyB0aGUKPiArCSAqIGJvdHRsZW5lY2ssIHdlIHNob3VsZCBjb25zaWRlciB1c2luZyBhbiBS
Qi10cmVlLCBvciBldmVuIGJldHRlciwKPiArCSAqIGxldCB0aGUgY29yZSBzdG9yZSBkcm1fZ2Vt
X29iamVjdF9tYXBwaW5nIGVudHJpZXMgKHdoZXJlIHdlCj4gKwkgKiBjb3VsZCBwbGFjZSBkcml2
ZXIgc3BlY2lmaWMgZGF0YSkgaW5zdGVhZCBvZiBkcm1fZ2VtX29iamVjdCBvbmVzCj4gKwkgKiBp
biBpdHMgZHJtX2ZpbGUtPm9iamVjdF9pZHIgdGFibGUuCj4gKwkgKgo+ICsJICogc3RydWN0IGRy
bV9nZW1fb2JqZWN0X21hcHBpbmcgewo+ICsJICoJc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmo7
Cj4gKwkgKgl2b2lkICpkcml2ZXJfcHJpdjsKPiArCSAqIH07Cj4gKwkgKi8KPiArCXN0cnVjdCB7
Cj4gKwkJc3RydWN0IGxpc3RfaGVhZCBsaXN0Owo+ICsJCXN0cnVjdCBtdXRleCBsb2NrOwo+ICsJ
fSBtYXBwaW5nczsKPiArCj4gIAlib29sIG5vZXhlYwkJOjE7Cj4gIAlib29sIGlzX2hlYXAJCTox
Owo+ICB9Owo+ICAKPiArc3RydWN0IHBhbmZyb3N0X2dlbV9tYXBwaW5nIHsKPiArCXN0cnVjdCBs
aXN0X2hlYWQgbm9kZTsKPiArCXN0cnVjdCBrcmVmIHJlZmNvdW50Owo+ICsJc3RydWN0IHBhbmZy
b3N0X2dlbV9vYmplY3QgKm9iajsKPiArCXN0cnVjdCBkcm1fbW1fbm9kZSBtbW5vZGU7Cj4gKwlz
dHJ1Y3QgcGFuZnJvc3RfbW11ICptbXU7Cj4gKwlib29sIGFjdGl2ZQkJOjE7Cj4gK307Cj4gKwo+
ICBzdGF0aWMgaW5saW5lCj4gIHN0cnVjdCAgcGFuZnJvc3RfZ2VtX29iamVjdCAqdG9fcGFuZnJv
c3RfYm8oc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmopCj4gIHsKPiAgCXJldHVybiBjb250YWlu
ZXJfb2YodG9fZHJtX2dlbV9zaG1lbV9vYmoob2JqKSwgc3RydWN0IHBhbmZyb3N0X2dlbV9vYmpl
Y3QsIGJhc2UpOwo+ICB9Cj4gIAo+IC1zdGF0aWMgaW5saW5lCj4gLXN0cnVjdCAgcGFuZnJvc3Rf
Z2VtX29iamVjdCAqZHJtX21tX25vZGVfdG9fcGFuZnJvc3RfYm8oc3RydWN0IGRybV9tbV9ub2Rl
ICpub2RlKQo+ICtzdGF0aWMgaW5saW5lIHN0cnVjdCBwYW5mcm9zdF9nZW1fbWFwcGluZyAqCj4g
K2RybV9tbV9ub2RlX3RvX3BhbmZyb3N0X21hcHBpbmcoc3RydWN0IGRybV9tbV9ub2RlICpub2Rl
KQo+ICB7Cj4gLQlyZXR1cm4gY29udGFpbmVyX29mKG5vZGUsIHN0cnVjdCBwYW5mcm9zdF9nZW1f
b2JqZWN0LCBub2RlKTsKPiArCXJldHVybiBjb250YWluZXJfb2Yobm9kZSwgc3RydWN0IHBhbmZy
b3N0X2dlbV9tYXBwaW5nLCBtbW5vZGUpOwo+ICB9Cj4gIAo+ICBzdHJ1Y3QgZHJtX2dlbV9vYmpl
Y3QgKnBhbmZyb3N0X2dlbV9jcmVhdGVfb2JqZWN0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHNp
emVfdCBzaXplKTsKPiBAQCAtNDksNiArNzIsMTIgQEAgaW50IHBhbmZyb3N0X2dlbV9vcGVuKHN0
cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqLCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdik7Cj4g
IHZvaWQgcGFuZnJvc3RfZ2VtX2Nsb3NlKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqLAo+ICAJ
CQlzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdik7Cj4gIAo+ICtzdHJ1Y3QgcGFuZnJvc3RfZ2Vt
X21hcHBpbmcgKgo+ICtwYW5mcm9zdF9nZW1fbWFwcGluZ19nZXQoc3RydWN0IHBhbmZyb3N0X2dl
bV9vYmplY3QgKmJvLAo+ICsJCQkgc3RydWN0IHBhbmZyb3N0X2ZpbGVfcHJpdiAqcHJpdik7Cj4g
K3ZvaWQgcGFuZnJvc3RfZ2VtX21hcHBpbmdfcHV0KHN0cnVjdCBwYW5mcm9zdF9nZW1fbWFwcGlu
ZyAqbWFwcGluZyk7Cj4gK3ZvaWQgcGFuZnJvc3RfZ2VtX3RlYXJkb3duX21hcHBpbmdzKHN0cnVj
dCBwYW5mcm9zdF9nZW1fb2JqZWN0ICpibyk7Cj4gKwo+ICB2b2lkIHBhbmZyb3N0X2dlbV9zaHJp
bmtlcl9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpOwo+ICB2b2lkIHBhbmZyb3N0X2dlbV9z
aHJpbmtlcl9jbGVhbnVwKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpOwo+ICAKPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2dlbV9zaHJpbmtlci5jIGIvZHJp
dmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2dlbV9zaHJpbmtlci5jCj4gaW5kZXggNDU4
ZjBmYTY4MTExLi5iMzZkZjMyNmM4NjAgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Bh
bmZyb3N0L3BhbmZyb3N0X2dlbV9zaHJpbmtlci5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3Bh
bmZyb3N0L3BhbmZyb3N0X2dlbV9zaHJpbmtlci5jCj4gQEAgLTM5LDExICszOSwxMyBAQCBwYW5m
cm9zdF9nZW1fc2hyaW5rZXJfY291bnQoc3RydWN0IHNocmlua2VyICpzaHJpbmtlciwgc3RydWN0
IHNocmlua19jb250cm9sICpzYwo+ICBzdGF0aWMgYm9vbCBwYW5mcm9zdF9nZW1fcHVyZ2Uoc3Ry
dWN0IGRybV9nZW1fb2JqZWN0ICpvYmopCj4gIHsKPiAgCXN0cnVjdCBkcm1fZ2VtX3NobWVtX29i
amVjdCAqc2htZW0gPSB0b19kcm1fZ2VtX3NobWVtX29iaihvYmopOwo+ICsJc3RydWN0IHBhbmZy
b3N0X2dlbV9vYmplY3QgKmJvID0gdG9fcGFuZnJvc3RfYm8ob2JqKTsKPiArCgpOSVQ6IEV4dHJh
IGJsYW5rIGxpbmUKClN0ZXZlCgo+ICAKPiAgCWlmICghbXV0ZXhfdHJ5bG9jaygmc2htZW0tPnBh
Z2VzX2xvY2spKQo+ICAJCXJldHVybiBmYWxzZTsKPiAgCj4gLQlwYW5mcm9zdF9tbXVfdW5tYXAo
dG9fcGFuZnJvc3RfYm8ob2JqKSk7Cj4gKwlwYW5mcm9zdF9nZW1fdGVhcmRvd25fbWFwcGluZ3Mo
Ym8pOwo+ICAJZHJtX2dlbV9zaG1lbV9wdXJnZV9sb2NrZWQob2JqKTsKPiAgCj4gIAltdXRleF91
bmxvY2soJnNobWVtLT5wYWdlc19sb2NrKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L3BhbmZyb3N0L3BhbmZyb3N0X2pvYi5jIGIvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZy
b3N0X2pvYi5jCj4gaW5kZXggY2RkOTQ0OGZiYmRkLi5jODVkNDViZTNiNWUgMTAwNjQ0Cj4gLS0t
IGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2pvYi5jCj4gKysrIGIvZHJpdmVy
cy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2pvYi5jCj4gQEAgLTI2OSw5ICsyNjksMjAgQEAg
c3RhdGljIHZvaWQgcGFuZnJvc3Rfam9iX2NsZWFudXAoc3RydWN0IGtyZWYgKnJlZikKPiAgCWRt
YV9mZW5jZV9wdXQoam9iLT5kb25lX2ZlbmNlKTsKPiAgCWRtYV9mZW5jZV9wdXQoam9iLT5yZW5k
ZXJfZG9uZV9mZW5jZSk7Cj4gIAo+IC0JaWYgKGpvYi0+Ym9zKSB7Cj4gKwlpZiAoam9iLT5tYXBw
aW5ncykgewo+ICAJCWZvciAoaSA9IDA7IGkgPCBqb2ItPmJvX2NvdW50OyBpKyspCj4gKwkJCXBh
bmZyb3N0X2dlbV9tYXBwaW5nX3B1dChqb2ItPm1hcHBpbmdzW2ldKTsKPiArCQlrdmZyZWUoam9i
LT5tYXBwaW5ncyk7Cj4gKwl9Cj4gKwo+ICsJaWYgKGpvYi0+Ym9zKSB7Cj4gKwkJc3RydWN0IHBh
bmZyb3N0X2dlbV9vYmplY3QgKmJvOwo+ICsKPiArCQlmb3IgKGkgPSAwOyBpIDwgam9iLT5ib19j
b3VudDsgaSsrKSB7Cj4gKwkJCWJvID0gdG9fcGFuZnJvc3RfYm8oam9iLT5ib3NbaV0pOwo+ICAJ
CQlkcm1fZ2VtX29iamVjdF9wdXRfdW5sb2NrZWQoam9iLT5ib3NbaV0pOwo+ICsJCX0KPiArCj4g
IAkJa3ZmcmVlKGpvYi0+Ym9zKTsKPiAgCX0KPiAgCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9qb2IuaCBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9w
YW5mcm9zdF9qb2IuaAo+IGluZGV4IDYyNDU0MTI4YTc5Mi4uYmJkM2JhOTdmZjY3IDEwMDY0NAo+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9qb2IuaAo+ICsrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9qb2IuaAo+IEBAIC0zMiw2ICszMiw3IEBA
IHN0cnVjdCBwYW5mcm9zdF9qb2Igewo+ICAKPiAgCS8qIEV4Y2x1c2l2ZSBmZW5jZXMgd2UgaGF2
ZSB0YWtlbiBmcm9tIHRoZSBCT3MgdG8gd2FpdCBmb3IgKi8KPiAgCXN0cnVjdCBkbWFfZmVuY2Ug
KippbXBsaWNpdF9mZW5jZXM7Cj4gKwlzdHJ1Y3QgcGFuZnJvc3RfZ2VtX21hcHBpbmcgKiptYXBw
aW5nczsKPiAgCXN0cnVjdCBkcm1fZ2VtX29iamVjdCAqKmJvczsKPiAgCXUzMiBib19jb3VudDsK
PiAgCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9tbXUu
YyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9tbXUuYwo+IGluZGV4IGEzZWQ2
NGExZjE1ZS4uNzYzY2ZjYTg4NmE3IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5m
cm9zdC9wYW5mcm9zdF9tbXUuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5m
cm9zdF9tbXUuYwo+IEBAIC0yNjksMTQgKzI2OSwxNSBAQCBzdGF0aWMgaW50IG1tdV9tYXBfc2co
c3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYsIHN0cnVjdCBwYW5mcm9zdF9tbXUgKm1tdSwK
PiAgCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1pbnQgcGFuZnJvc3RfbW11X21hcChzdHJ1Y3QgcGFu
ZnJvc3RfZ2VtX29iamVjdCAqYm8pCj4gK2ludCBwYW5mcm9zdF9tbXVfbWFwKHN0cnVjdCBwYW5m
cm9zdF9nZW1fbWFwcGluZyAqbWFwcGluZykKPiAgewo+ICsJc3RydWN0IHBhbmZyb3N0X2dlbV9v
YmplY3QgKmJvID0gbWFwcGluZy0+b2JqOwo+ICAJc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmog
PSAmYm8tPmJhc2UuYmFzZTsKPiAgCXN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2ID0gdG9f
cGFuZnJvc3RfZGV2aWNlKG9iai0+ZGV2KTsKPiAgCXN0cnVjdCBzZ190YWJsZSAqc2d0Owo+ICAJ
aW50IHByb3QgPSBJT01NVV9SRUFEIHwgSU9NTVVfV1JJVEU7Cj4gIAo+IC0JaWYgKFdBUk5fT04o
Ym8tPmlzX21hcHBlZCkpCj4gKwlpZiAoV0FSTl9PTihtYXBwaW5nLT5hY3RpdmUpKQo+ICAJCXJl
dHVybiAwOwo+ICAKPiAgCWlmIChiby0+bm9leGVjKQo+IEBAIC0yODYsMjUgKzI4NywyOCBAQCBp
bnQgcGFuZnJvc3RfbW11X21hcChzdHJ1Y3QgcGFuZnJvc3RfZ2VtX29iamVjdCAqYm8pCj4gIAlp
ZiAoV0FSTl9PTihJU19FUlIoc2d0KSkpCj4gIAkJcmV0dXJuIFBUUl9FUlIoc2d0KTsKPiAgCj4g
LQltbXVfbWFwX3NnKHBmZGV2LCBiby0+bW11LCBiby0+bm9kZS5zdGFydCA8PCBQQUdFX1NISUZU
LCBwcm90LCBzZ3QpOwo+IC0JYm8tPmlzX21hcHBlZCA9IHRydWU7Cj4gKwltbXVfbWFwX3NnKHBm
ZGV2LCBtYXBwaW5nLT5tbXUsIG1hcHBpbmctPm1tbm9kZS5zdGFydCA8PCBQQUdFX1NISUZULAo+
ICsJCSAgIHByb3QsIHNndCk7Cj4gKwltYXBwaW5nLT5hY3RpdmUgPSB0cnVlOwo+ICAKPiAgCXJl
dHVybiAwOwo+ICB9Cj4gIAo+IC12b2lkIHBhbmZyb3N0X21tdV91bm1hcChzdHJ1Y3QgcGFuZnJv
c3RfZ2VtX29iamVjdCAqYm8pCj4gK3ZvaWQgcGFuZnJvc3RfbW11X3VubWFwKHN0cnVjdCBwYW5m
cm9zdF9nZW1fbWFwcGluZyAqbWFwcGluZykKPiAgewo+ICsJc3RydWN0IHBhbmZyb3N0X2dlbV9v
YmplY3QgKmJvID0gbWFwcGluZy0+b2JqOwo+ICAJc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmog
PSAmYm8tPmJhc2UuYmFzZTsKPiAgCXN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2ID0gdG9f
cGFuZnJvc3RfZGV2aWNlKG9iai0+ZGV2KTsKPiAtCXN0cnVjdCBpb19wZ3RhYmxlX29wcyAqb3Bz
ID0gYm8tPm1tdS0+cGd0Ymxfb3BzOwo+IC0JdTY0IGlvdmEgPSBiby0+bm9kZS5zdGFydCA8PCBQ
QUdFX1NISUZUOwo+IC0Jc2l6ZV90IGxlbiA9IGJvLT5ub2RlLnNpemUgPDwgUEFHRV9TSElGVDsK
PiArCXN0cnVjdCBpb19wZ3RhYmxlX29wcyAqb3BzID0gbWFwcGluZy0+bW11LT5wZ3RibF9vcHM7
Cj4gKwl1NjQgaW92YSA9IG1hcHBpbmctPm1tbm9kZS5zdGFydCA8PCBQQUdFX1NISUZUOwo+ICsJ
c2l6ZV90IGxlbiA9IG1hcHBpbmctPm1tbm9kZS5zaXplIDw8IFBBR0VfU0hJRlQ7Cj4gIAlzaXpl
X3QgdW5tYXBwZWRfbGVuID0gMDsKPiAgCj4gLQlpZiAoV0FSTl9PTighYm8tPmlzX21hcHBlZCkp
Cj4gKwlpZiAoV0FSTl9PTighbWFwcGluZy0+YWN0aXZlKSkKPiAgCQlyZXR1cm47Cj4gIAo+IC0J
ZGV2X2RiZyhwZmRldi0+ZGV2LCAidW5tYXA6IGFzPSVkLCBpb3ZhPSVsbHgsIGxlbj0lengiLCBi
by0+bW11LT5hcywgaW92YSwgbGVuKTsKPiArCWRldl9kYmcocGZkZXYtPmRldiwgInVubWFwOiBh
cz0lZCwgaW92YT0lbGx4LCBsZW49JXp4IiwKPiArCQltYXBwaW5nLT5tbXUtPmFzLCBpb3ZhLCBs
ZW4pOwo+ICAKPiAgCXdoaWxlICh1bm1hcHBlZF9sZW4gPCBsZW4pIHsKPiAgCQlzaXplX3QgdW5t
YXBwZWRfcGFnZTsKPiBAQCAtMzE4LDggKzMyMiw5IEBAIHZvaWQgcGFuZnJvc3RfbW11X3VubWFw
KHN0cnVjdCBwYW5mcm9zdF9nZW1fb2JqZWN0ICpibykKPiAgCQl1bm1hcHBlZF9sZW4gKz0gcGdz
aXplOwo+ICAJfQo+ICAKPiAtCXBhbmZyb3N0X21tdV9mbHVzaF9yYW5nZShwZmRldiwgYm8tPm1t
dSwgYm8tPm5vZGUuc3RhcnQgPDwgUEFHRV9TSElGVCwgbGVuKTsKPiAtCWJvLT5pc19tYXBwZWQg
PSBmYWxzZTsKPiArCXBhbmZyb3N0X21tdV9mbHVzaF9yYW5nZShwZmRldiwgbWFwcGluZy0+bW11
LAo+ICsJCQkJIG1hcHBpbmctPm1tbm9kZS5zdGFydCA8PCBQQUdFX1NISUZULCBsZW4pOwo+ICsJ
bWFwcGluZy0+YWN0aXZlID0gZmFsc2U7Cj4gIH0KPiAgCj4gIHN0YXRpYyB2b2lkIG1tdV90bGJf
aW52X2NvbnRleHRfczEodm9pZCAqY29va2llKQo+IEBAIC0zOTQsMTAgKzM5OSwxMCBAQCB2b2lk
IHBhbmZyb3N0X21tdV9wZ3RhYmxlX2ZyZWUoc3RydWN0IHBhbmZyb3N0X2ZpbGVfcHJpdiAqcHJp
dikKPiAgCWZyZWVfaW9fcGd0YWJsZV9vcHMobW11LT5wZ3RibF9vcHMpOwo+ICB9Cj4gIAo+IC1z
dGF0aWMgc3RydWN0IHBhbmZyb3N0X2dlbV9vYmplY3QgKgo+IC1hZGRyX3RvX2RybV9tbV9ub2Rl
KHN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2LCBpbnQgYXMsIHU2NCBhZGRyKQo+ICtzdGF0
aWMgc3RydWN0IHBhbmZyb3N0X2dlbV9tYXBwaW5nICoKPiArYWRkcl90b19tYXBwaW5nKHN0cnVj
dCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2LCBpbnQgYXMsIHU2NCBhZGRyKQo+ICB7Cj4gLQlzdHJ1
Y3QgcGFuZnJvc3RfZ2VtX29iamVjdCAqYm8gPSBOVUxMOwo+ICsJc3RydWN0IHBhbmZyb3N0X2dl
bV9tYXBwaW5nICptYXBwaW5nID0gTlVMTDsKPiAgCXN0cnVjdCBwYW5mcm9zdF9maWxlX3ByaXYg
KnByaXY7Cj4gIAlzdHJ1Y3QgZHJtX21tX25vZGUgKm5vZGU7Cj4gIAl1NjQgb2Zmc2V0ID0gYWRk
ciA+PiBQQUdFX1NISUZUOwo+IEBAIC00MTgsOCArNDIzLDkgQEAgYWRkcl90b19kcm1fbW1fbm9k
ZShzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldiwgaW50IGFzLCB1NjQgYWRkcikKPiAgCWRy
bV9tbV9mb3JfZWFjaF9ub2RlKG5vZGUsICZwcml2LT5tbSkgewo+ICAJCWlmIChvZmZzZXQgPj0g
bm9kZS0+c3RhcnQgJiYKPiAgCQkgICAgb2Zmc2V0IDwgKG5vZGUtPnN0YXJ0ICsgbm9kZS0+c2l6
ZSkpIHsKPiAtCQkJYm8gPSBkcm1fbW1fbm9kZV90b19wYW5mcm9zdF9ibyhub2RlKTsKPiAtCQkJ
ZHJtX2dlbV9vYmplY3RfZ2V0KCZiby0+YmFzZS5iYXNlKTsKPiArCQkJbWFwcGluZyA9IGRybV9t
bV9ub2RlX3RvX3BhbmZyb3N0X21hcHBpbmcobm9kZSk7Cj4gKwo+ICsJCQlrcmVmX2dldCgmbWFw
cGluZy0+cmVmY291bnQpOwo+ICAJCQlicmVhazsKPiAgCQl9Cj4gIAl9Cj4gQEAgLTQyNyw3ICs0
MzMsNyBAQCBhZGRyX3RvX2RybV9tbV9ub2RlKHN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2
LCBpbnQgYXMsIHU2NCBhZGRyKQo+ICAJc3Bpbl91bmxvY2soJnByaXYtPm1tX2xvY2spOwo+ICBv
dXQ6Cj4gIAlzcGluX3VubG9jaygmcGZkZXYtPmFzX2xvY2spOwo+IC0JcmV0dXJuIGJvOwo+ICsJ
cmV0dXJuIG1hcHBpbmc7Cj4gIH0KPiAgCj4gICNkZWZpbmUgTlVNX0ZBVUxUX1BBR0VTIChTWl8y
TSAvIFBBR0VfU0laRSkKPiBAQCAtNDM2LDI4ICs0NDIsMzAgQEAgc3RhdGljIGludCBwYW5mcm9z
dF9tbXVfbWFwX2ZhdWx0X2FkZHIoc3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYsIGludCBh
cywKPiAgCQkJCSAgICAgICB1NjQgYWRkcikKPiAgewo+ICAJaW50IHJldCwgaTsKPiArCXN0cnVj
dCBwYW5mcm9zdF9nZW1fbWFwcGluZyAqYm9tYXBwaW5nOwo+ICAJc3RydWN0IHBhbmZyb3N0X2dl
bV9vYmplY3QgKmJvOwo+ICAJc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmc7Cj4gIAlwZ29m
Zl90IHBhZ2Vfb2Zmc2V0Owo+ICAJc3RydWN0IHNnX3RhYmxlICpzZ3Q7Cj4gIAlzdHJ1Y3QgcGFn
ZSAqKnBhZ2VzOwo+ICAKPiAtCWJvID0gYWRkcl90b19kcm1fbW1fbm9kZShwZmRldiwgYXMsIGFk
ZHIpOwo+IC0JaWYgKCFibykKPiArCWJvbWFwcGluZyA9IGFkZHJfdG9fbWFwcGluZyhwZmRldiwg
YXMsIGFkZHIpOwo+ICsJaWYgKCFib21hcHBpbmcpCj4gIAkJcmV0dXJuIC1FTk9FTlQ7Cj4gIAo+
ICsJYm8gPSBib21hcHBpbmctPm9iajsKPiAgCWlmICghYm8tPmlzX2hlYXApIHsKPiAgCQlkZXZf
V0FSTihwZmRldi0+ZGV2LCAibWF0Y2hpbmcgQk8gaXMgbm90IGhlYXAgdHlwZSAoR1BVIFZBID0g
JWxseCkiLAo+IC0JCQkgYm8tPm5vZGUuc3RhcnQgPDwgUEFHRV9TSElGVCk7Cj4gKwkJCSBib21h
cHBpbmctPm1tbm9kZS5zdGFydCA8PCBQQUdFX1NISUZUKTsKPiAgCQlyZXQgPSAtRUlOVkFMOwo+
ICAJCWdvdG8gZXJyX2JvOwo+ICAJfQo+IC0JV0FSTl9PTihiby0+bW11LT5hcyAhPSBhcyk7Cj4g
KwlXQVJOX09OKGJvbWFwcGluZy0+bW11LT5hcyAhPSBhcyk7Cj4gIAo+ICAJLyogQXNzdW1lIDJN
QiBhbGlnbm1lbnQgYW5kIHNpemUgbXVsdGlwbGUgKi8KPiAgCWFkZHIgJj0gfigodTY0KVNaXzJN
IC0gMSk7Cj4gIAlwYWdlX29mZnNldCA9IGFkZHIgPj4gUEFHRV9TSElGVDsKPiAtCXBhZ2Vfb2Zm
c2V0IC09IGJvLT5ub2RlLnN0YXJ0Owo+ICsJcGFnZV9vZmZzZXQgLT0gYm9tYXBwaW5nLT5tbW5v
ZGUuc3RhcnQ7Cj4gIAo+ICAJbXV0ZXhfbG9jaygmYm8tPmJhc2UucGFnZXNfbG9jayk7Cj4gIAo+
IEBAIC01MDksMTMgKzUxNywxNCBAQCBzdGF0aWMgaW50IHBhbmZyb3N0X21tdV9tYXBfZmF1bHRf
YWRkcihzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldiwgaW50IGFzLAo+ICAJCWdvdG8gZXJy
X21hcDsKPiAgCX0KPiAgCj4gLQltbXVfbWFwX3NnKHBmZGV2LCBiby0+bW11LCBhZGRyLCBJT01N
VV9XUklURSB8IElPTU1VX1JFQUQgfCBJT01NVV9OT0VYRUMsIHNndCk7Cj4gKwltbXVfbWFwX3Nn
KHBmZGV2LCBib21hcHBpbmctPm1tdSwgYWRkciwKPiArCQkgICBJT01NVV9XUklURSB8IElPTU1V
X1JFQUQgfCBJT01NVV9OT0VYRUMsIHNndCk7Cj4gIAo+IC0JYm8tPmlzX21hcHBlZCA9IHRydWU7
Cj4gKwlib21hcHBpbmctPmFjdGl2ZSA9IHRydWU7Cj4gIAo+ICAJZGV2X2RiZyhwZmRldi0+ZGV2
LCAibWFwcGVkIHBhZ2UgZmF1bHQgQCBBUyVkICVsbHgiLCBhcywgYWRkcik7Cj4gIAo+IC0JZHJt
X2dlbV9vYmplY3RfcHV0X3VubG9ja2VkKCZiby0+YmFzZS5iYXNlKTsKPiArCXBhbmZyb3N0X2dl
bV9tYXBwaW5nX3B1dChib21hcHBpbmcpOwo+ICAKPiAgCXJldHVybiAwOwo+ICAKPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X21tdS5oIGIvZHJpdmVycy9n
cHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X21tdS5oCj4gaW5kZXggN2M1YjY3NzVhZTIzLi40NGZj
MmVkZjYzY2UgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0
X21tdS5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X21tdS5oCj4g
QEAgLTQsMTIgKzQsMTIgQEAKPiAgI2lmbmRlZiBfX1BBTkZST1NUX01NVV9IX18KPiAgI2RlZmlu
ZSBfX1BBTkZST1NUX01NVV9IX18KPiAgCj4gLXN0cnVjdCBwYW5mcm9zdF9nZW1fb2JqZWN0Owo+
ICtzdHJ1Y3QgcGFuZnJvc3RfZ2VtX21hcHBpbmc7Cj4gIHN0cnVjdCBwYW5mcm9zdF9maWxlX3By
aXY7Cj4gIHN0cnVjdCBwYW5mcm9zdF9tbXU7Cj4gIAo+IC1pbnQgcGFuZnJvc3RfbW11X21hcChz
dHJ1Y3QgcGFuZnJvc3RfZ2VtX29iamVjdCAqYm8pOwo+IC12b2lkIHBhbmZyb3N0X21tdV91bm1h
cChzdHJ1Y3QgcGFuZnJvc3RfZ2VtX29iamVjdCAqYm8pOwo+ICtpbnQgcGFuZnJvc3RfbW11X21h
cChzdHJ1Y3QgcGFuZnJvc3RfZ2VtX21hcHBpbmcgKm1hcHBpbmcpOwo+ICt2b2lkIHBhbmZyb3N0
X21tdV91bm1hcChzdHJ1Y3QgcGFuZnJvc3RfZ2VtX21hcHBpbmcgKm1hcHBpbmcpOwo+ICAKPiAg
aW50IHBhbmZyb3N0X21tdV9pbml0KHN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2KTsKPiAg
dm9pZCBwYW5mcm9zdF9tbXVfZmluaShzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldik7Cj4g
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9wZXJmY250LmMg
Yi9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfcGVyZmNudC5jCj4gaW5kZXggMmMw
NGU4NThjNTBhLi42ODQ4MjA0NDhiZTMgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Bh
bmZyb3N0L3BhbmZyb3N0X3BlcmZjbnQuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9z
dC9wYW5mcm9zdF9wZXJmY250LmMKPiBAQCAtMjUsNyArMjUsNyBAQAo+ICAjZGVmaW5lIFY0X1NI
QURFUlNfUEVSX0NPUkVHUk9VUAk0Cj4gIAo+ICBzdHJ1Y3QgcGFuZnJvc3RfcGVyZmNudCB7Cj4g
LQlzdHJ1Y3QgcGFuZnJvc3RfZ2VtX29iamVjdCAqYm87Cj4gKwlzdHJ1Y3QgcGFuZnJvc3RfZ2Vt
X21hcHBpbmcgKm1hcHBpbmc7Cj4gIAlzaXplX3QgYm9zaXplOwo+ICAJdm9pZCAqYnVmOwo+ICAJ
c3RydWN0IHBhbmZyb3N0X2ZpbGVfcHJpdiAqdXNlcjsKPiBAQCAtNDksNyArNDksNyBAQCBzdGF0
aWMgaW50IHBhbmZyb3N0X3BlcmZjbnRfZHVtcF9sb2NrZWQoc3RydWN0IHBhbmZyb3N0X2Rldmlj
ZSAqcGZkZXYpCj4gIAlpbnQgcmV0Owo+ICAKPiAgCXJlaW5pdF9jb21wbGV0aW9uKCZwZmRldi0+
cGVyZmNudC0+ZHVtcF9jb21wKTsKPiAtCWdwdXZhID0gcGZkZXYtPnBlcmZjbnQtPmJvLT5ub2Rl
LnN0YXJ0IDw8IFBBR0VfU0hJRlQ7Cj4gKwlncHV2YSA9IHBmZGV2LT5wZXJmY250LT5tYXBwaW5n
LT5tbW5vZGUuc3RhcnQgPDwgUEFHRV9TSElGVDsKPiAgCWdwdV93cml0ZShwZmRldiwgR1BVX1BF
UkZDTlRfQkFTRV9MTywgZ3B1dmEpOwo+ICAJZ3B1X3dyaXRlKHBmZGV2LCBHUFVfUEVSRkNOVF9C
QVNFX0hJLCBncHV2YSA+PiAzMik7Cj4gIAlncHVfd3JpdGUocGZkZXYsIEdQVV9JTlRfQ0xFQVIs
Cj4gQEAgLTg5LDE3ICs4OSwyMiBAQCBzdGF0aWMgaW50IHBhbmZyb3N0X3BlcmZjbnRfZW5hYmxl
X2xvY2tlZChzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldiwKPiAgCWlmIChJU19FUlIoYm8p
KQo+ICAJCXJldHVybiBQVFJfRVJSKGJvKTsKPiAgCj4gLQlwZXJmY250LT5ibyA9IHRvX3BhbmZy
b3N0X2JvKCZiby0+YmFzZSk7Cj4gLQo+ICAJLyogTWFwIHRoZSBwZXJmY250IGJ1ZiBpbiB0aGUg
YWRkcmVzcyBzcGFjZSBhdHRhY2hlZCB0byBmaWxlX3ByaXYuICovCj4gLQlyZXQgPSBwYW5mcm9z
dF9nZW1fb3BlbigmcGVyZmNudC0+Ym8tPmJhc2UuYmFzZSwgZmlsZV9wcml2KTsKPiArCXJldCA9
IHBhbmZyb3N0X2dlbV9vcGVuKCZiby0+YmFzZSwgZmlsZV9wcml2KTsKPiAgCWlmIChyZXQpCj4g
IAkJZ290byBlcnJfcHV0X2JvOwo+ICAKPiArCXBlcmZjbnQtPm1hcHBpbmcgPSBwYW5mcm9zdF9n
ZW1fbWFwcGluZ19nZXQodG9fcGFuZnJvc3RfYm8oJmJvLT5iYXNlKSwKPiArCQkJCQkJICAgIHVz
ZXIpOwo+ICsJaWYgKCFwZXJmY250LT5tYXBwaW5nKSB7Cj4gKwkJcmV0ID0gLUVJTlZBTDsKPiAr
CQlnb3RvIGVycl9jbG9zZV9ibzsKPiArCX0KPiArCj4gIAlwZXJmY250LT5idWYgPSBkcm1fZ2Vt
X3NobWVtX3ZtYXAoJmJvLT5iYXNlKTsKPiAgCWlmIChJU19FUlIocGVyZmNudC0+YnVmKSkgewo+
ICAJCXJldCA9IFBUUl9FUlIocGVyZmNudC0+YnVmKTsKPiAtCQlnb3RvIGVycl9jbG9zZV9ibzsK
PiArCQlnb3RvIGVycl9wdXRfbWFwcGluZzsKPiAgCX0KPiAgCj4gIAkvKgo+IEBAIC0xNTQsMTIg
KzE1OSwxNyBAQCBzdGF0aWMgaW50IHBhbmZyb3N0X3BlcmZjbnRfZW5hYmxlX2xvY2tlZChzdHJ1
Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldiwKPiAgCWlmIChwYW5mcm9zdF9oYXNfaHdfaXNzdWUo
cGZkZXYsIEhXX0lTU1VFXzgxODYpKQo+ICAJCWdwdV93cml0ZShwZmRldiwgR1BVX1BSRkNOVF9U
SUxFUl9FTiwgMHhmZmZmZmZmZik7Cj4gIAo+ICsJLyogVGhlIEJPIHJlZiBpcyByZXRhaW5lZCBi
eSB0aGUgbWFwcGluZy4gKi8KPiArCWRybV9nZW1fb2JqZWN0X3B1dF91bmxvY2tlZCgmYm8tPmJh
c2UpOwo+ICsKPiAgCXJldHVybiAwOwo+ICAKPiAgZXJyX3Z1bm1hcDoKPiAtCWRybV9nZW1fc2ht
ZW1fdnVubWFwKCZwZXJmY250LT5iby0+YmFzZS5iYXNlLCBwZXJmY250LT5idWYpOwo+ICsJZHJt
X2dlbV9zaG1lbV92dW5tYXAoJmJvLT5iYXNlLCBwZXJmY250LT5idWYpOwo+ICtlcnJfcHV0X21h
cHBpbmc6Cj4gKwlwYW5mcm9zdF9nZW1fbWFwcGluZ19wdXQocGVyZmNudC0+bWFwcGluZyk7Cj4g
IGVycl9jbG9zZV9ibzoKPiAtCXBhbmZyb3N0X2dlbV9jbG9zZSgmcGVyZmNudC0+Ym8tPmJhc2Uu
YmFzZSwgZmlsZV9wcml2KTsKPiArCXBhbmZyb3N0X2dlbV9jbG9zZSgmYm8tPmJhc2UsIGZpbGVf
cHJpdik7Cj4gIGVycl9wdXRfYm86Cj4gIAlkcm1fZ2VtX29iamVjdF9wdXRfdW5sb2NrZWQoJmJv
LT5iYXNlKTsKPiAgCXJldHVybiByZXQ7Cj4gQEAgLTE4MiwxMSArMTkyLDExIEBAIHN0YXRpYyBp
bnQgcGFuZnJvc3RfcGVyZmNudF9kaXNhYmxlX2xvY2tlZChzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNl
ICpwZmRldiwKPiAgCQkgIEdQVV9QRVJGQ05UX0NGR19NT0RFKEdQVV9QRVJGQ05UX0NGR19NT0RF
X09GRikpOwo+ICAKPiAgCXBlcmZjbnQtPnVzZXIgPSBOVUxMOwo+IC0JZHJtX2dlbV9zaG1lbV92
dW5tYXAoJnBlcmZjbnQtPmJvLT5iYXNlLmJhc2UsIHBlcmZjbnQtPmJ1Zik7Cj4gKwlkcm1fZ2Vt
X3NobWVtX3Z1bm1hcCgmcGVyZmNudC0+bWFwcGluZy0+b2JqLT5iYXNlLmJhc2UsIHBlcmZjbnQt
PmJ1Zik7Cj4gIAlwZXJmY250LT5idWYgPSBOVUxMOwo+IC0JcGFuZnJvc3RfZ2VtX2Nsb3NlKCZw
ZXJmY250LT5iby0+YmFzZS5iYXNlLCBmaWxlX3ByaXYpOwo+IC0JZHJtX2dlbV9vYmplY3RfcHV0
X3VubG9ja2VkKCZwZXJmY250LT5iby0+YmFzZS5iYXNlKTsKPiAtCXBlcmZjbnQtPmJvID0gTlVM
TDsKPiArCXBhbmZyb3N0X2dlbV9jbG9zZSgmcGVyZmNudC0+bWFwcGluZy0+b2JqLT5iYXNlLmJh
c2UsIGZpbGVfcHJpdik7Cj4gKwlwYW5mcm9zdF9nZW1fbWFwcGluZ19wdXQocGVyZmNudC0+bWFw
cGluZyk7Cj4gKwlwZXJmY250LT5tYXBwaW5nID0gTlVMTDsKPiAgCXBtX3J1bnRpbWVfbWFya19s
YXN0X2J1c3kocGZkZXYtPmRldik7Cj4gIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChwZmRl
di0+ZGV2KTsKPiAgCj4gCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3Rv
cC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmkt
ZGV2ZWw=
