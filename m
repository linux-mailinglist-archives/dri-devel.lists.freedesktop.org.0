Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 507861F2141
	for <lists+dri-devel@lfdr.de>; Mon,  8 Jun 2020 23:06:56 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 403EA6E9AC;
	Mon,  8 Jun 2020 21:06:54 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-qk1-x742.google.com (mail-qk1-x742.google.com
 [IPv6:2607:f8b0:4864:20::742])
 by gabe.freedesktop.org (Postfix) with ESMTPS id AE0946E9AC
 for <dri-devel@lists.freedesktop.org>; Mon,  8 Jun 2020 21:06:53 +0000 (UTC)
Received: by mail-qk1-x742.google.com with SMTP id f18so18816918qkh.1
 for <dri-devel@lists.freedesktop.org>; Mon, 08 Jun 2020 14:06:53 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=poorly.run; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=d5zEDo2JBMgX5hYA19EEIcs++4DHZQS+dB8XbR2PlnY=;
 b=IF9akcHaoitPUD6p8uKeUlRUkvuEPt2QejFScv92q91/i8ywqeuBofi7QIHbFIH6gQ
 Ss3giVVj2MMhpZZD+dB0WSLVEyZmDs5wvXBXm/jwsFmLv7lsocr4fI/RySxmyOTtyUno
 BiZTrg6n9uv9E2+qOX7d8Fm2Gylc9EVBGVz2UKGGNek7fDZ5WVJoYvzvKE8Y/A8F/bu7
 dSIe2Rcj2Y3GvSI4Sn34bh0cr+CwYX7PpHMwCddX2eAgU5staYJJnb9SVtV5NpImGieq
 J9t6R1Q/rUjTDuwgvxZEysuNnlwu05l9n+q38jjYxkzgv6giQMrtSM/aBUzNa+9X3x+6
 06Ug==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=d5zEDo2JBMgX5hYA19EEIcs++4DHZQS+dB8XbR2PlnY=;
 b=VpgFg+RdyTAodnzlA/tEGkcGNBJSEazRkot7Rja4PbM40JaxgGaTH49MbEmj7kSh9t
 hJ8TdOvIolfjqbaJ8IbQLKbcZSwMKdPnwKbGSu013mfcSW9AYnQLRR25rj6Qj+vThNoj
 w9VZSRH2aqufNiSccP+qelFLjVFWgecRBtdi7ybgD4Whcumr6IPimz85wmlwikdZxu5a
 OGLZvq7XLSXDCbePY+8JS40eydTF7P3lGFDEhuWbd3G9LiCCrqh5Fmp0k1B6qoF1adbh
 Jd+XL4hTo3uGqrnUCJDsHXwIpgzXu0N18haBryvPF3cKFeE5es30qLaKl+2aAypPSU1c
 c6qA==
X-Gm-Message-State: AOAM5335cp0oNw+w+eqDra1iLCj7u+MZmDYN8llh+wDiAnaPVtYU3rk/
 lj51jM7dkujpJEtnmGyKFsO0PKVXufo=
X-Google-Smtp-Source: ABdhPJyjZByuVGa3aedRo3kpzH16ZQatvnmfOO5BoKgVNGkMbC1Gg6qDExz33wujL9IM2onErPBYUA==
X-Received: by 2002:a37:d95:: with SMTP id 143mr23371263qkn.496.1591650412545; 
 Mon, 08 Jun 2020 14:06:52 -0700 (PDT)
Received: from localhost (mobile-166-173-249-24.mycingular.net.
 [166.173.249.24])
 by smtp.gmail.com with ESMTPSA id s42sm8623013qtk.14.2020.06.08.14.06.51
 (version=TLS1_2 cipher=ECDHE-ECDSA-CHACHA20-POLY1305 bits=256/256);
 Mon, 08 Jun 2020 14:06:52 -0700 (PDT)
From: Sean Paul <sean@poorly.run>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v5 13/13] drm/print: Add tracefs support to the drm logging
 helpers
Date: Mon,  8 Jun 2020 17:05:03 -0400
Message-Id: <20200608210505.48519-14-sean@poorly.run>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200608210505.48519-1-sean@poorly.run>
References: <20200608210505.48519-1-sean@poorly.run>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: linux-doc@vger.kernel.org, Jonathan Corbet <corbet@lwn.net>,
 David Airlie <airlied@linux.ie>, daniel.vetter@ffwll.ch,
 Chris Wilson <chris@chris-wilson.co.uk>, Sean Paul <seanpaul@chromium.org>,
 tzimmermann@suse.de, Steven Rostedt <rostedt@goodmis.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogU2VhbiBQYXVsIDxzZWFucGF1bEBjaHJvbWl1bS5vcmc+CgpUaGlzIHBhdGNoIGFkZHMg
YSBuZXcgbW9kdWxlIHBhcmFtZXRlciBjYWxsZWQgZHJtLnRyYWNlIHdoaWNoIGFjY2VwdHMKdGhl
IHNhbWUgbWFzayBhcyBkcm0uZGVidWcuIFdoZW4gYSBkZWJ1ZyBjYXRlZ29yeSBpcyBlbmFibGVk
LCBsb2cKbWVzc2FnZXMgd2lsbCBiZSBwdXQgaW4gYSBuZXcgdHJhY2VmcyBpbnN0YW5jZSBjYWxs
ZWQgZHJtIGZvcgpjb25zdW1wdGlvbi4KClVzaW5nIHRoZSBuZXcgdHJhY2VmcyBpbnN0YW5jZSB3
aWxsIGFsbG93IGRpc3Ryb3MgdG8gZW5hYmxlIGRybSBsb2dnaW5nCmluIHByb2R1Y3Rpb24gd2l0
aG91dCBpbXBhY3RpbmcgcGVyZm9ybWFuY2Ugb3Igc3BhbW1pbmcgdGhlIHN5c3RlbQpsb2dzLgoK
Q2M6IERhbmllbCBWZXR0ZXIgPGRhbmllbC52ZXR0ZXJAZmZ3bGwuY2g+CkNjOiBEYXZpZCBBaXJs
aWUgPGFpcmxpZWRAZ21haWwuY29tPgpDYzogSmFuaSBOaWt1bGEgPGphbmkubmlrdWxhQGxpbnV4
LmludGVsLmNvbT4KQ2M6IEpvb25hcyBMYWh0aW5lbiA8am9vbmFzLmxhaHRpbmVuQGxpbnV4Lmlu
dGVsLmNvbT4KQ2M6IFBla2thIFBhYWxhbmVuIDxwcGFhbGFuZW5AZ21haWwuY29tPgpDYzogUm9i
IENsYXJrIDxyb2JkY2xhcmtAZ21haWwuY29tPgpDYzogU3RldmVuIFJvc3RlZHQgPHJvc3RlZHRA
Z29vZG1pcy5vcmc+CkNjOiBUaG9tYXMgWmltbWVybWFubiA8dHppbW1lcm1hbm5Ac3VzZS5kZT4K
Q2M6IFZpbGxlIFN5cmrDpGzDpCA8dmlsbGUuc3lyamFsYUBsaW51eC5pbnRlbC5jb20+CkNjOiBD
aHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KQ2M6IFN0ZXZlbiBSb3N0ZWR0
IDxyb3N0ZWR0QGdvb2RtaXMub3JnPgpTaWduZWQtb2ZmLWJ5OiBTZWFuIFBhdWwgPHNlYW5wYXVs
QGNocm9taXVtLm9yZz4KTGluazogaHR0cHM6Ly9wYXRjaHdvcmsuZnJlZWRlc2t0b3Aub3JnL3Bh
dGNoL21zZ2lkLzIwMTkxMDEwMjA0ODIzLjE5NTU0MC0xLXNlYW5AcG9vcmx5LnJ1biAjdjEKTGlu
azogaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvYXJjaGl2ZXMvZHJpLWRldmVsLzIwMTkt
Tm92ZW1iZXIvMjQzMjMwLmh0bWwgI3YyCkxpbms6IGh0dHBzOi8vcGF0Y2h3b3JrLmZyZWVkZXNr
dG9wLm9yZy9wYXRjaC9tc2dpZC8yMDE5MTIxMjIwMzMwMS4xNDI0MzctMS1zZWFuQHBvb3JseS5y
dW4gI3YzCkxpbms6IGh0dHBzOi8vcGF0Y2h3b3JrLmZyZWVkZXNrdG9wLm9yZy9wYXRjaC9tc2dp
ZC8yMDIwMDExNDE3MjE1NS4yMTU0NjMtMS1zZWFuQHBvb3JseS5ydW4gI3Y0CgpDaGFuZ2VzIGlu
IHY1OgotUmUtd3JpdGUgdG8gdXNlIHRyYWNlX2FycmF5IGFuZCB0aGUgdHJhY2VmcyBpbnN0YW5j
ZSBzdXBwb3J0Ci0tLQogRG9jdW1lbnRhdGlvbi9ncHUvZHJtLXVhcGkucnN0IHwgICA2ICsKIGRy
aXZlcnMvZ3B1L2RybS9kcm1fZHJ2LmMgICAgICB8ICAgMyArCiBkcml2ZXJzL2dwdS9kcm0vZHJt
X3ByaW50LmMgICAgfCAyMDkgKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tLS0tCiBpbmNs
dWRlL2RybS9kcm1fcHJpbnQuaCAgICAgICAgfCAgNjMgKysrKysrKystLQogNCBmaWxlcyBjaGFu
Z2VkLCAyNDEgaW5zZXJ0aW9ucygrKSwgNDAgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvRG9j
dW1lbnRhdGlvbi9ncHUvZHJtLXVhcGkucnN0IGIvRG9jdW1lbnRhdGlvbi9ncHUvZHJtLXVhcGku
cnN0CmluZGV4IDU2ZmVjNmVkMWFkOC4uMWMxYzRkMDQzZjQwIDEwMDY0NAotLS0gYS9Eb2N1bWVu
dGF0aW9uL2dwdS9kcm0tdWFwaS5yc3QKKysrIGIvRG9jdW1lbnRhdGlvbi9ncHUvZHJtLXVhcGku
cnN0CkBAIC0zMTIsNiArMzEyLDEyIEBAIERlYnVnZnMgU3VwcG9ydAogLi4ga2VybmVsLWRvYzo6
IGRyaXZlcnMvZ3B1L2RybS9kcm1fZGVidWdmcy5jCiAgICA6ZXhwb3J0OgogCitEUk0gVHJhY2lu
ZworLS0tLS0tLS0tLS0tLS0tCisKKy4uIGtlcm5lbC1kb2M6OiBkcml2ZXJzL2dwdS9kcm0vZHJt
X3ByaW50LmMKKyAgIDpkb2M6IERSTSBUcmFjaW5nCisKIFN5c2ZzIFN1cHBvcnQKID09PT09PT09
PT09PT0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2RybV9kcnYuYyBiL2RyaXZlcnMv
Z3B1L2RybS9kcm1fZHJ2LmMKaW5kZXggYmMzODMyMmYzMDZlLi44ODQwNGFmNzRjOWIgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9kcm1fZHJ2LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2Ry
bV9kcnYuYwpAQCAtMTEwOCwxMiArMTEwOCwxNSBAQCBzdGF0aWMgdm9pZCBkcm1fY29yZV9leGl0
KHZvaWQpCiAJZHJtX3N5c2ZzX2Rlc3Ryb3koKTsKIAlpZHJfZGVzdHJveSgmZHJtX21pbm9yc19p
ZHIpOwogCWRybV9jb25uZWN0b3JfaWRhX2Rlc3Ryb3koKTsKKwlkcm1fdHJhY2VfY2xlYW51cCgp
OwogfQogCiBzdGF0aWMgaW50IF9faW5pdCBkcm1fY29yZV9pbml0KHZvaWQpCiB7CiAJaW50IHJl
dDsKIAorCWRybV90cmFjZV9pbml0KCk7CisKIAlkcm1fY29ubmVjdG9yX2lkYV9pbml0KCk7CiAJ
aWRyX2luaXQoJmRybV9taW5vcnNfaWRyKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2RybV9wcmludC5jIGIvZHJpdmVycy9ncHUvZHJtL2RybV9wcmludC5jCmluZGV4IDRkOTg0YTAx
YjNhMy4uYzRiZWYzODkyMWRiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vZHJtX3ByaW50
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2RybV9wcmludC5jCkBAIC0zMSw2ICszMSw3IEBACiAj
aW5jbHVkZSA8bGludXgvbW9kdWxlcGFyYW0uaD4KICNpbmNsdWRlIDxsaW51eC9zZXFfZmlsZS5o
PgogI2luY2x1ZGUgPGxpbnV4L3NsYWIuaD4KKyNpbmNsdWRlIDxsaW51eC90cmFjZS5oPgogCiAj
aW5jbHVkZSA8ZHJtL2RybS5oPgogI2luY2x1ZGUgPGRybS9kcm1fZHJ2Lmg+CkBAIC00MywxNyAr
NDQsMzQgQEAKIHVuc2lnbmVkIGludCBfX2RybV9kZWJ1Z19zeXNsb2c7CiBFWFBPUlRfU1lNQk9M
KF9fZHJtX2RlYnVnX3N5c2xvZyk7CiAKLU1PRFVMRV9QQVJNX0RFU0MoZGVidWcsICJFbmFibGUg
ZGVidWcgb3V0cHV0LCB3aGVyZSBlYWNoIGJpdCBlbmFibGVzIGEgZGVidWcgY2F0ZWdvcnkuXG4i
Ci0iXHRcdEJpdCAwICgweDAxKSAgd2lsbCBlbmFibGUgQ09SRSBtZXNzYWdlcyAoZHJtIGNvcmUg
Y29kZSlcbiIKLSJcdFx0Qml0IDEgKDB4MDIpICB3aWxsIGVuYWJsZSBEUklWRVIgbWVzc2FnZXMg
KGRybSBjb250cm9sbGVyIGNvZGUpXG4iCi0iXHRcdEJpdCAyICgweDA0KSAgd2lsbCBlbmFibGUg
S01TIG1lc3NhZ2VzIChtb2Rlc2V0dGluZyBjb2RlKVxuIgotIlx0XHRCaXQgMyAoMHgwOCkgIHdp
bGwgZW5hYmxlIFBSSU1FIG1lc3NhZ2VzIChwcmltZSBjb2RlKVxuIgotIlx0XHRCaXQgNCAoMHgx
MCkgIHdpbGwgZW5hYmxlIEFUT01JQyBtZXNzYWdlcyAoYXRvbWljIGNvZGUpXG4iCi0iXHRcdEJp
dCA1ICgweDIwKSAgd2lsbCBlbmFibGUgVkJMIG1lc3NhZ2VzICh2YmxhbmsgY29kZSlcbiIKLSJc
dFx0Qml0IDcgKDB4ODApICB3aWxsIGVuYWJsZSBMRUFTRSBtZXNzYWdlcyAobGVhc2luZyBjb2Rl
KVxuIgotIlx0XHRCaXQgOCAoMHgxMDApIHdpbGwgZW5hYmxlIERQIG1lc3NhZ2VzIChkaXNwbGF5
cG9ydCBjb2RlKSIpOworLyoKKyAqIF9fZHJtX2RlYnVnX3RyYWNlOiBFbmFibGUgZGVidWcgb3V0
cHV0IGluIGRybSB0cmFjaW5nIGluc3RhbmNlLgorICogQml0bWFzayBvZiBEUk1fVVRfeC4gU2Vl
IGluY2x1ZGUvZHJtL2RybV9wcmludC5oIGZvciBkZXRhaWxzLgorICovCit1bnNpZ25lZCBpbnQg
X19kcm1fZGVidWdfdHJhY2U7CitFWFBPUlRfU1lNQk9MKF9fZHJtX2RlYnVnX3RyYWNlKTsKKwor
I2RlZmluZSBERUJVR19QQVJNX0RFU0MoZHN0KSBcCisiRW5hYmxlIGRlYnVnIG91dHB1dCB0byAi
IGRzdCAiLCB3aGVyZSBlYWNoIGJpdCBlbmFibGVzIGEgZGVidWcgY2F0ZWdvcnkuXG4iIFwKKyJc
dFx0Qml0IDAgKDB4MDEpICB3aWxsIGVuYWJsZSBDT1JFIG1lc3NhZ2VzIChkcm0gY29yZSBjb2Rl
KVxuIiBcCisiXHRcdEJpdCAxICgweDAyKSAgd2lsbCBlbmFibGUgRFJJVkVSIG1lc3NhZ2VzIChk
cm0gY29udHJvbGxlciBjb2RlKVxuIiBcCisiXHRcdEJpdCAyICgweDA0KSAgd2lsbCBlbmFibGUg
S01TIG1lc3NhZ2VzIChtb2Rlc2V0dGluZyBjb2RlKVxuIiBcCisiXHRcdEJpdCAzICgweDA4KSAg
d2lsbCBlbmFibGUgUFJJTUUgbWVzc2FnZXMgKHByaW1lIGNvZGUpXG4iIFwKKyJcdFx0Qml0IDQg
KDB4MTApICB3aWxsIGVuYWJsZSBBVE9NSUMgbWVzc2FnZXMgKGF0b21pYyBjb2RlKVxuIiBcCisi
XHRcdEJpdCA1ICgweDIwKSAgd2lsbCBlbmFibGUgVkJMIG1lc3NhZ2VzICh2YmxhbmsgY29kZSlc
biIgXAorIlx0XHRCaXQgNyAoMHg4MCkgIHdpbGwgZW5hYmxlIExFQVNFIG1lc3NhZ2VzIChsZWFz
aW5nIGNvZGUpXG4iIFwKKyJcdFx0Qml0IDggKDB4MTAwKSB3aWxsIGVuYWJsZSBEUCBtZXNzYWdl
cyAoZGlzcGxheXBvcnQgY29kZSkiCisKK01PRFVMRV9QQVJNX0RFU0MoZGVidWcsIERFQlVHX1BB
Uk1fREVTQygic3lzbG9nIikpOwogbW9kdWxlX3BhcmFtX25hbWVkKGRlYnVnLCBfX2RybV9kZWJ1
Z19zeXNsb2csIGludCwgMDYwMCk7CiAKK01PRFVMRV9QQVJNX0RFU0ModHJhY2UsIERFQlVHX1BB
Uk1fREVTQygidHJhY2VmcyIpKTsKK21vZHVsZV9wYXJhbV9uYW1lZCh0cmFjZSwgX19kcm1fZGVi
dWdfdHJhY2UsIGludCwgMDYwMCk7CisKKyNpZmRlZiBDT05GSUdfVFJBQ0lORworc3RydWN0IHRy
YWNlX2FycmF5ICp0cmFjZV9hcnI7CisjZW5kaWYKKwogdm9pZCBfX2RybV9wdXRzX2NvcmVkdW1w
KHN0cnVjdCBkcm1fcHJpbnRlciAqcCwgY29uc3QgY2hhciAqc3RyKQogewogCXN0cnVjdCBkcm1f
cHJpbnRfaXRlcmF0b3IgKml0ZXJhdG9yID0gcC0+YXJnOwpAQCAtMTY2LDYgKzE4NCwyMCBAQCB2
b2lkIF9fZHJtX3ByaW50Zm5fZGVidWdfc3lzbG9nKHN0cnVjdCBkcm1fcHJpbnRlciAqcCwgc3Ry
dWN0IHZhX2Zvcm1hdCAqdmFmKQogfQogRVhQT1JUX1NZTUJPTChfX2RybV9wcmludGZuX2RlYnVn
X3N5c2xvZyk7CiAKK3ZvaWQgX19kcm1fcHJpbnRmbl90cmFjZShzdHJ1Y3QgZHJtX3ByaW50ZXIg
KnAsIHN0cnVjdCB2YV9mb3JtYXQgKnZhZikKK3sKKwlkcm1fdHJhY2VfcHJpbnRmKCIlcyAlcFYi
LCBwLT5wcmVmaXgsIHZhZik7Cit9CitFWFBPUlRfU1lNQk9MKF9fZHJtX3ByaW50Zm5fdHJhY2Up
OworCit2b2lkIF9fZHJtX3ByaW50Zm5fZGVidWdfc3lzbG9nX2FuZF90cmFjZShzdHJ1Y3QgZHJt
X3ByaW50ZXIgKnAsCisJCQkJCSAgIHN0cnVjdCB2YV9mb3JtYXQgKnZhZikKK3sKKwlwcl9kZWJ1
ZygiJXMgJXBWIiwgcC0+cHJlZml4LCB2YWYpOworCWRybV90cmFjZV9wcmludGYoIiVzICVwViIs
IHAtPnByZWZpeCwgdmFmKTsKK30KK0VYUE9SVF9TWU1CT0woX19kcm1fcHJpbnRmbl9kZWJ1Z19z
eXNsb2dfYW5kX3RyYWNlKTsKKwogdm9pZCBfX2RybV9wcmludGZuX2VycihzdHJ1Y3QgZHJtX3By
aW50ZXIgKnAsIHN0cnVjdCB2YV9mb3JtYXQgKnZhZikKIHsKIAlwcl9lcnIoIipFUlJPUiogJXMg
JXBWIiwgcC0+cHJlZml4LCB2YWYpOwpAQCAtMjQ2LDYgKzI3OCwxNCBAQCB2b2lkIGRybV9kZXZf
cHJpbnRrKGNvbnN0IHN0cnVjdCBkZXZpY2UgKmRldiwgY29uc3QgY2hhciAqbGV2ZWwsCiAJc3Ry
dWN0IHZhX2Zvcm1hdCB2YWY7CiAJdmFfbGlzdCBhcmdzOwogCisJdmFfc3RhcnQoYXJncywgZm9y
bWF0KTsKKwl2YWYuZm10ID0gZm9ybWF0OworCXZhZi52YSA9ICZhcmdzOworCWRybV90cmFjZV9w
cmludGYoIiVzJXNbIiBEUk1fTkFNRSAiOiVwc10gJXBWIiwKKwkJCSBkZXYgPyBkZXZfbmFtZShk
ZXYpIDogIiIsZGV2ID8gIiAiIDogIiIsCisJCQkgX19idWlsdGluX3JldHVybl9hZGRyZXNzKDAp
LCAmdmFmKTsKKwl2YV9lbmQoYXJncyk7CisKIAl2YV9zdGFydChhcmdzLCBmb3JtYXQpOwogCXZh
Zi5mbXQgPSBmb3JtYXQ7CiAJdmFmLnZhID0gJmFyZ3M7CkBAIC0yNjcsMjEgKzMwNywzMCBAQCB2
b2lkIGRybV9kZXZfZGJnKGNvbnN0IHN0cnVjdCBkZXZpY2UgKmRldiwgZW51bSBkcm1fZGVidWdf
Y2F0ZWdvcnkgY2F0ZWdvcnksCiAJc3RydWN0IHZhX2Zvcm1hdCB2YWY7CiAJdmFfbGlzdCBhcmdz
OwogCi0JaWYgKCFkcm1fZGVidWdfZW5hYmxlZChjYXRlZ29yeSkpCi0JCXJldHVybjsKKwlpZiAo
ZHJtX2RlYnVnX3N5c2xvZ19lbmFibGVkKGNhdGVnb3J5KSkgeworCQl2YV9zdGFydChhcmdzLCBm
b3JtYXQpOworCQl2YWYuZm10ID0gZm9ybWF0OworCQl2YWYudmEgPSAmYXJnczsKIAotCXZhX3N0
YXJ0KGFyZ3MsIGZvcm1hdCk7Ci0JdmFmLmZtdCA9IGZvcm1hdDsKLQl2YWYudmEgPSAmYXJnczsK
KwkJaWYgKGRldikKKwkJCWRldl9wcmludGsoS0VSTl9ERUJVRywgZGV2LCAiWyIgRFJNX05BTUUg
IjolcHNdICVwViIsCisJCQkJX19idWlsdGluX3JldHVybl9hZGRyZXNzKDApLCAmdmFmKTsKKwkJ
ZWxzZQorCQkJcHJpbnRrKEtFUk5fREVCVUcgIlsiIERSTV9OQU1FICI6JXBzXSAlcFYiLAorCQkJ
X19idWlsdGluX3JldHVybl9hZGRyZXNzKDApLCAmdmFmKTsKIAotCWlmIChkZXYpCi0JCWRldl9w
cmludGsoS0VSTl9ERUJVRywgZGV2LCAiWyIgRFJNX05BTUUgIjolcHNdICVwViIsCi0JCQkgICBf
X2J1aWx0aW5fcmV0dXJuX2FkZHJlc3MoMCksICZ2YWYpOwotCWVsc2UKLQkJcHJpbnRrKEtFUk5f
REVCVUcgIlsiIERSTV9OQU1FICI6JXBzXSAlcFYiLAotCQkgICAgICAgX19idWlsdGluX3JldHVy
bl9hZGRyZXNzKDApLCAmdmFmKTsKKwkJdmFfZW5kKGFyZ3MpOworCX0KIAotCXZhX2VuZChhcmdz
KTsKKwlpZiAoZHJtX2RlYnVnX3RyYWNlX2VuYWJsZWQoY2F0ZWdvcnkpKSB7CisJCXZhX3N0YXJ0
KGFyZ3MsIGZvcm1hdCk7CisJCXZhZi5mbXQgPSBmb3JtYXQ7CisJCXZhZi52YSA9ICZhcmdzOwor
CQlkcm1fdHJhY2VfcHJpbnRmKCIlcyVzWyIgRFJNX05BTUUgIjolcHNdICVwViIsCisJCQkJIGRl
diA/IGRldl9uYW1lKGRldikgOiAiIiwgZGV2ID8gIiAiIDogIiIsCisJCQkJIF9fYnVpbHRpbl9y
ZXR1cm5fYWRkcmVzcygwKSwgJnZhZik7CisJCXZhX2VuZChhcmdzKTsKKwl9CiB9CiBFWFBPUlRf
U1lNQk9MKGRybV9kZXZfZGJnKTsKIApAQCAtMjkwLDE3ICszMzksMjUgQEAgdm9pZCBfX2RybV9k
YmcoZW51bSBkcm1fZGVidWdfY2F0ZWdvcnkgY2F0ZWdvcnksIGNvbnN0IGNoYXIgKmZvcm1hdCwg
Li4uKQogCXN0cnVjdCB2YV9mb3JtYXQgdmFmOwogCXZhX2xpc3QgYXJnczsKIAotCWlmICghZHJt
X2RlYnVnX2VuYWJsZWQoY2F0ZWdvcnkpKQotCQlyZXR1cm47CisJaWYgKGRybV9kZWJ1Z19zeXNs
b2dfZW5hYmxlZChjYXRlZ29yeSkpIHsKKwkJdmFfc3RhcnQoYXJncywgZm9ybWF0KTsKKwkJdmFm
LmZtdCA9IGZvcm1hdDsKKwkJdmFmLnZhID0gJmFyZ3M7CiAKLQl2YV9zdGFydChhcmdzLCBmb3Jt
YXQpOwotCXZhZi5mbXQgPSBmb3JtYXQ7Ci0JdmFmLnZhID0gJmFyZ3M7CisJCXByaW50ayhLRVJO
X0RFQlVHICJbIiBEUk1fTkFNRSAiOiVwc10gJXBWIiwKKwkJX19idWlsdGluX3JldHVybl9hZGRy
ZXNzKDApLCAmdmFmKTsKIAotCXByaW50ayhLRVJOX0RFQlVHICJbIiBEUk1fTkFNRSAiOiVwc10g
JXBWIiwKLQkgICAgICAgX19idWlsdGluX3JldHVybl9hZGRyZXNzKDApLCAmdmFmKTsKKwkJdmFf
ZW5kKGFyZ3MpOworCX0KIAotCXZhX2VuZChhcmdzKTsKKwlpZiAoZHJtX2RlYnVnX3RyYWNlX2Vu
YWJsZWQoY2F0ZWdvcnkpKSB7CisJCXZhX3N0YXJ0KGFyZ3MsIGZvcm1hdCk7CisJCXZhZi5mbXQg
PSBmb3JtYXQ7CisJCXZhZi52YSA9ICZhcmdzOworCQlkcm1fdHJhY2VfcHJpbnRmKCJbIiBEUk1f
TkFNRSAiOiVwc10gJXBWIiwKKwkJCQkgX19idWlsdGluX3JldHVybl9hZGRyZXNzKDApLCAmdmFm
KTsKKwkJdmFfZW5kKGFyZ3MpOworCX0KIH0KIEVYUE9SVF9TWU1CT0woX19kcm1fZGJnKTsKIApA
QCAtMzQ3LDMgKzQwNCw5NyBAQCB2b2lkIGRybV9wcmludF9yZWdzZXQzMihzdHJ1Y3QgZHJtX3By
aW50ZXIgKnAsIHN0cnVjdCBkZWJ1Z2ZzX3JlZ3NldDMyICpyZWdzZXQpCiAJfQogfQogRVhQT1JU
X1NZTUJPTChkcm1fcHJpbnRfcmVnc2V0MzIpOworCisKKy8qKgorICogRE9DOiBEUk0gVHJhY2lu
ZworICoKKyAqICp0bDtkciogRFJNIHRyYWNpbmcgaXMgYSBsaWdodHdlaWdodCBhbHRlcm5hdGl2
ZSB0byB0cmFkaXRpb25hbCBEUk0gZGVidWcKKyAqIGxvZ2dpbmcuCisgKgorICogV2hpbGUgRFJN
IGxvZ2dpbmcgaXMgcXVpdGUgY29udmVuaWVudCB3aGVuIHJlcHJvZHVjaW5nIGEgc3BlY2lmaWMg
aXNzdWUsIGl0CisgKiBkb2Vzbid0IGhlbHAgd2hlbiBzb21ldGhpbmcgZ29lcyB3cm9uZyB1bmV4
cGVjdGVkbHkuIFRoZXJlIGFyZSBhIGNvdXBsZQorICogcmVhc29ucyB3aHkgb25lIGRvZXMgbm90
IHdhbnQgdG8gZW5hYmxlIERSTSBsb2dnaW5nIGF0IGFsbCB0aW1lczoKKyAqCisgKiAxLiBXZSBk
b24ndCB3YW50IHRvIG92ZXJ3aGVsbSBzeXNsb2cgd2l0aCBkcm0gc3BhbSwgb3RoZXJzIGhhdmUg
dG8gdXNlIGl0IHRvbworICogMi4gQ29uc29sZSBsb2dnaW5nIGlzIHNsb3cKKyAqCisgKiBEUk0g
dHJhY2luZyBhaW1zIHRvIHNvbHZlIGJvdGggdGhlc2UgcHJvYmxlbXMuCisgKgorICogVG8gdXNl
IERSTSB0cmFjaW5nLCBzZXQgdGhlIGRybS50cmFjZSBtb2R1bGUgcGFyYW1ldGVyICh2aWEgY21k
bGluZSBvciBzeXNmcykKKyAqIHRvIGEgRFJNIGRlYnVnIGNhdGVnb3J5IG1hc2sgKHRoaXMgaXMg
YSBiaXRtYXNrIG9mICZkcm1fZGVidWdfY2F0ZWdvcnkKKyAqIHZhbHVlcyk6CisgKiA6OgorICoK
KyAqICAgIGVnOiBlY2hvIDB4MTA2ID4gL3N5cy9tb2R1bGUvZHJtL3BhcmFtZXRlcnMvdHJhY2UK
KyAqCisgKiBPbmNlIGFjdGl2ZSwgYWxsIGxvZyBtZXNzYWdlcyBpbiB0aGUgc3BlY2lmaWVkIGNh
dGVnb3JpZXMgd2lsbCBiZSB3cml0dGVuIHRvCisgKiB0aGUgRFJNIHRyYWNlLiBPbmNlIGF0IGNh
cGFjaXR5LCB0aGUgdHJhY2Ugd2lsbCBvdmVyd3JpdGUgb2xkIG1lc3NhZ2VzIHdpdGgKKyAqIG5l
dyBvbmVzLiBBdCBhbnkgcG9pbnQsIG9uZSBjYW4gcmVhZCB0aGUgdHJhY2UgZmlsZSB0byBleHRy
YWN0IHRoZSBwcmV2aW91cyBOCisgKiBEUk0gbWVzc2FnZXM6CisgKiA6OgorICoKKyAqICAgIGVn
OiBjYXQgL3N5cy9rZXJuZWwvdHJhY2luZy9pbnN0YW5jZXMvZHJtL3RyYWNlCisgKgorICogQ29u
c2lkZXJhdGlvbnMKKyAqICoqKioqKioqKioqKioqCisgKiBUaGUgdHJhY2UgaXMgc3Vic3lzdGVt
IHdpZGUsIHNvIGlmIHlvdSBoYXZlIG11bHRpcGxlIGRldmljZXMgYWN0aXZlLCB0aGV5CisgKiB3
aWxsIGJlIGFkZGluZyBsb2dzIHRvIHRoZSBzYW1lIHRyYWNlLgorICoKKyAqIFRoZSBjb250ZW50
cyBvZiB0aGUgRFJNIFRyYWNlIGFyZSAqKm5vdCoqIGNvbnNpZGVyZWQgVUFCSS4gKipETyBOT1Qg
ZGVwZW5kIG9uCisgKiB0aGUgdmFsdWVzIG9mIHRoZXNlIHRyYWNlcyBpbiB5b3VyIHVzZXJzcGFj
ZS4qKiBUaGVzZSB0cmFjZXMgYXJlIGludGVuZGVkIGZvcgorICogZW50ZXJ0YWlubWVudCBwdXJw
b3NlcyBvbmx5LiBUaGUgY29udGVudHMgb2YgdGhlc2UgbG9ncyBjYXJyeSBubyB3YXJyYW50eSwK
KyAqIGV4cHJlc3NlZCBvciBpbXBsaWVkLgorICovCisKKworI2lmZGVmIENPTkZJR19UUkFDSU5H
CisKKy8qKgorICogZHJtX3RyYWNlX2luaXQgLSBpbml0aWFsaXplcyB0aGUgZHJtIHRyYWNlIGFy
cmF5CisgKgorICogVGhpcyBmdW5jdGlvbiBmZXRjaGVzIChvciBjcmVhdGVzKSB0aGUgZHJtIHRy
YWNlIGFycmF5LiBUaGlzIHNob3VsZCBiZSBjYWxsZWQKKyAqIG9uY2Ugb24gZHJtIHN1YnN5c3Rl
bSBjcmVhdGlvbiBhbmQgbWF0Y2hlZCB3aXRoIGRybV90cmFjZV9jbGVhbnVwKCkuCisgKi8KK3Zv
aWQgZHJtX3RyYWNlX2luaXQoKQoreworCXRyYWNlX2FyciA9IHRyYWNlX2FycmF5X2dldF9ieV9u
YW1lKCJkcm0iKTsKKwlpZiAoIXRyYWNlX2FycikKKwkJcmV0dXJuOworfQorRVhQT1JUX1NZTUJP
TChkcm1fdHJhY2VfaW5pdCk7CisKKy8qKgorICogZHJtX3RyYWNlX3ByaW50ZiAtIGFkZHMgYW4g
ZW50cnkgdG8gdGhlIGRybSB0cmFjZWZzIGluc3RhbmNlCisgKiBAZm9ybWF0OiBwcmludGYgZm9y
bWF0IG9mIHRoZSBtZXNzYWdlIHRvIGFkZCB0byB0aGUgdHJhY2UKKyAqCisgKiBUaGlzIGZ1bmN0
aW9uIGFkZHMgYSBuZXcgZW50cnkgaW4gdGhlIGRybSB0cmFjZWZzIGluc3RhbmNlCisgKi8KK3Zv
aWQgZHJtX3RyYWNlX3ByaW50Zihjb25zdCBjaGFyICpmb3JtYXQsIC4uLikKK3sKKwlzdHJ1Y3Qg
dmFfZm9ybWF0IHZhZjsKKwl2YV9saXN0IGFyZ3M7CisKKwl2YV9zdGFydChhcmdzLCBmb3JtYXQp
OworCXZhZi5mbXQgPSBmb3JtYXQ7CisJdmFmLnZhID0gJmFyZ3M7CisJdHJhY2VfYXJyYXlfcHJp
bnRrKHRyYWNlX2FyciwgX1RISVNfSVBfLCAiJXBWIiwgJnZhZik7CisJdmFfZW5kKGFyZ3MpOwor
fQorCisvKioKKyAqIGRybV90cmFjZV9jbGVhbnVwIC0gZGVzdHJveXMgdGhlIGRybSB0cmFjZSBh
cnJheQorICoKKyAqIFRoaXMgZnVuY3Rpb24gZGVzdHJveXMgdGhlIGRybSB0cmFjZSBhcnJheSBj
cmVhdGVkIHdpdGggZHJtX3RyYWNlX2luaXQuIFRoaXMKKyAqIHNob3VsZCBiZSBjYWxsZWQgb25j
ZSBvbiBkcm0gc3Vic3lzdGVtIGNsb3NlIGFuZCBtYXRjaGVkIHdpdGgKKyAqIGRybV90cmFjZV9p
bml0KCkuCisgKi8KK3ZvaWQgZHJtX3RyYWNlX2NsZWFudXAoKQoreworCWlmICh0cmFjZV9hcnIp
IHsKKwkJdHJhY2VfYXJyYXlfcHV0KHRyYWNlX2Fycik7CisJCXRyYWNlX2FycmF5X2Rlc3Ryb3ko
dHJhY2VfYXJyKTsKKwl9Cit9CitFWFBPUlRfU1lNQk9MKGRybV90cmFjZV9jbGVhbnVwKTsKKyNl
bmRpZgpcIE5vIG5ld2xpbmUgYXQgZW5kIG9mIGZpbGUKZGlmZiAtLWdpdCBhL2luY2x1ZGUvZHJt
L2RybV9wcmludC5oIGIvaW5jbHVkZS9kcm0vZHJtX3ByaW50LmgKaW5kZXggODk4N2I5OGJiZmRh
Li4yODRmN2QzMjUwNTYgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvZHJtL2RybV9wcmludC5oCisrKyBi
L2luY2x1ZGUvZHJtL2RybV9wcmludC5oCkBAIC0zNiwxMiArMzYsMTMgQEAKIAogLyogRG8gKm5v
dCogdXNlIG91dHNpZGUgb2YgZHJtX3ByaW50LltjaF0hICovCiBleHRlcm4gdW5zaWduZWQgaW50
IF9fZHJtX2RlYnVnX3N5c2xvZzsKK2V4dGVybiB1bnNpZ25lZCBpbnQgX19kcm1fZGVidWdfdHJh
Y2U7CiAKIC8qKgogICogRE9DOiBwcmludAogICoKICAqIEEgc2ltcGxlIHdyYXBwZXIgZm9yIGRl
dl9wcmludGsoKSwgc2VxX3ByaW50ZigpLCBldGMuICBBbGxvd3Mgc2FtZQotICogZGVidWcgY29k
ZSB0byBiZSB1c2VkIGZvciBib3RoIGRlYnVnZnMgYW5kIHByaW50ayBsb2dnaW5nLgorICogZGVi
dWcgY29kZSB0byBiZSB1c2VkIGZvciBkZWJ1Z2ZzLCBwcmludGsgYW5kIHRyYWNlZnMgbG9nZ2lu
Zy4KICAqCiAgKiBGb3IgZXhhbXBsZTo6CiAgKgpAQCAtODYsNiArODcsOSBAQCB2b2lkIF9fZHJt
X3ByaW50Zm5fc2VxX2ZpbGUoc3RydWN0IGRybV9wcmludGVyICpwLCBzdHJ1Y3QgdmFfZm9ybWF0
ICp2YWYpOwogdm9pZCBfX2RybV9wdXRzX3NlcV9maWxlKHN0cnVjdCBkcm1fcHJpbnRlciAqcCwg
Y29uc3QgY2hhciAqc3RyKTsKIHZvaWQgX19kcm1fcHJpbnRmbl9pbmZvKHN0cnVjdCBkcm1fcHJp
bnRlciAqcCwgc3RydWN0IHZhX2Zvcm1hdCAqdmFmKTsKIHZvaWQgX19kcm1fcHJpbnRmbl9kZWJ1
Z19zeXNsb2coc3RydWN0IGRybV9wcmludGVyICpwLCBzdHJ1Y3QgdmFfZm9ybWF0ICp2YWYpOwor
dm9pZCBfX2RybV9wcmludGZuX3RyYWNlKHN0cnVjdCBkcm1fcHJpbnRlciAqcCwgc3RydWN0IHZh
X2Zvcm1hdCAqdmFmKTsKK3ZvaWQgX19kcm1fcHJpbnRmbl9kZWJ1Z19zeXNsb2dfYW5kX3RyYWNl
KHN0cnVjdCBkcm1fcHJpbnRlciAqcCwKKwkJCQkJICAgc3RydWN0IHZhX2Zvcm1hdCAqdmFmKTsK
IHZvaWQgX19kcm1fcHJpbnRmbl9lcnIoc3RydWN0IGRybV9wcmludGVyICpwLCBzdHJ1Y3QgdmFf
Zm9ybWF0ICp2YWYpOwogdm9pZCBfX2RybV9wcmludGZuX25vb3Aoc3RydWN0IGRybV9wcmludGVy
ICpwLCBzdHJ1Y3QgdmFfZm9ybWF0ICp2YWYpOwogCkBAIC0yMTksNyArMjIzLDggQEAgc3RhdGlj
IGlubGluZSBzdHJ1Y3QgZHJtX3ByaW50ZXIgZHJtX2luZm9fcHJpbnRlcihzdHJ1Y3QgZGV2aWNl
ICpkZXYpCiB9CiAKIC8qKgotICogZHJtX2RlYnVnX3ByaW50ZXIgLSBjb25zdHJ1Y3QgYSAmZHJt
X3ByaW50ZXIgdGhhdCBvdXRwdXRzIHRvIHByX2RlYnVnKCkKKyAqIGRybV9kZWJ1Z19wcmludGVy
IC0gY29uc3RydWN0IGEgJmRybV9wcmludGVyIHRoYXQgb3V0cHV0cyB0byBwcl9kZWJ1ZygpIGFu
ZAorICogZHJtIHRyYWNlZnMKICAqIEBwcmVmaXg6IGRlYnVnIG91dHB1dCBwcmVmaXgKICAqCiAg
KiBSRVRVUk5TOgpAQCAtMjI4LDcgKzIzMyw3IEBAIHN0YXRpYyBpbmxpbmUgc3RydWN0IGRybV9w
cmludGVyIGRybV9pbmZvX3ByaW50ZXIoc3RydWN0IGRldmljZSAqZGV2KQogc3RhdGljIGlubGlu
ZSBzdHJ1Y3QgZHJtX3ByaW50ZXIgZHJtX2RlYnVnX3ByaW50ZXIoY29uc3QgY2hhciAqcHJlZml4
KQogewogCXN0cnVjdCBkcm1fcHJpbnRlciBwID0gewotCQkucHJpbnRmbiA9IF9fZHJtX3ByaW50
Zm5fZGVidWdfc3lzbG9nLAorCQkucHJpbnRmbiA9IF9fZHJtX3ByaW50Zm5fZGVidWdfc3lzbG9n
X2FuZF90cmFjZSwKIAkJLnByZWZpeCA9IHByZWZpeAogCX07CiAJcmV0dXJuIHA7CkBAIC0yNTQs
MTQgKzI1OSwxNCBAQCBzdGF0aWMgaW5saW5lIHN0cnVjdCBkcm1fcHJpbnRlciBkcm1fZXJyX3By
aW50ZXIoY29uc3QgY2hhciAqcHJlZml4KQogICogZW51bSBkcm1fZGVidWdfY2F0ZWdvcnkgLSBU
aGUgRFJNIGRlYnVnIGNhdGVnb3JpZXMKICAqCiAgKiBFYWNoIG9mIHRoZSBEUk0gZGVidWcgbG9n
Z2luZyBtYWNyb3MgdXNlIGEgc3BlY2lmaWMgY2F0ZWdvcnksIGFuZCB0aGUgbG9nZ2luZwotICog
aXMgZmlsdGVyZWQgYnkgdGhlIGRybS5kZWJ1ZyBtb2R1bGUgcGFyYW1ldGVyLiBUaGlzIGVudW0g
c3BlY2lmaWVzIHRoZSB2YWx1ZXMKLSAqIGZvciB0aGUgaW50ZXJmYWNlLgorICogaXMgZmlsdGVy
ZWQgYnkgdGhlIGRybS5kZWJ1ZyBhbmQgZHJtLnRyYWNlIG1vZHVsZSBwYXJhbWV0ZXJzLiBUaGlz
IGVudW0KKyAqIHNwZWNpZmllcyB0aGUgdmFsdWVzIGZvciB0aGUgaW50ZXJmYWNlLgogICoKICAq
IEVhY2ggRFJNX0RFQlVHXzxDQVRFR09SWT4gbWFjcm8gbG9ncyB0byBEUk1fVVRfPENBVEVHT1JZ
PiBjYXRlZ29yeSwgZXhjZXB0CiAgKiBEUk1fREVCVUcoKSBsb2dzIHRvIERSTV9VVF9DT1JFLgog
ICoKLSAqIEVuYWJsaW5nIHZlcmJvc2UgZGVidWcgbWVzc2FnZXMgaXMgZG9uZSB0aHJvdWdoIHRo
ZSBkcm0uZGVidWcgcGFyYW1ldGVyLCBlYWNoCi0gKiBjYXRlZ29yeSBiZWluZyBlbmFibGVkIGJ5
IGEgYml0OgorICogRW5hYmxpbmcgdmVyYm9zZSBkZWJ1ZyBtZXNzYWdlcyBpcyBkb25lIHRocm91
Z2ggdGhlIGRybS5kZWJ1ZyBhbmQgZHJtLnRyYWNlCisgKiBwYXJhbWV0ZXJzLCBlYWNoIGNhdGVn
b3J5IGJlaW5nIGVuYWJsZWQgYnkgYSBiaXQ6CiAgKgogICogIC0gZHJtLmRlYnVnPTB4MSB3aWxs
IGVuYWJsZSBDT1JFIG1lc3NhZ2VzCiAgKiAgLSBkcm0uZGVidWc9MHgyIHdpbGwgZW5hYmxlIERS
SVZFUiBtZXNzYWdlcwpAQCAtMjcwLDEwICsyNzUsMTQgQEAgc3RhdGljIGlubGluZSBzdHJ1Y3Qg
ZHJtX3ByaW50ZXIgZHJtX2Vycl9wcmludGVyKGNvbnN0IGNoYXIgKnByZWZpeCkKICAqICAtIGRy
bS5kZWJ1Zz0weDFmZiB3aWxsIGVuYWJsZSBhbGwgbWVzc2FnZXMKICAqCiAgKiBBbiBpbnRlcmVz
dGluZyBmZWF0dXJlIGlzIHRoYXQgaXQncyBwb3NzaWJsZSB0byBlbmFibGUgdmVyYm9zZSBsb2dn
aW5nIGF0Ci0gKiBydW4tdGltZSBieSBlY2hvaW5nIHRoZSBkZWJ1ZyB2YWx1ZSBpbiBpdHMgc3lz
ZnMgbm9kZTo6CisgKiBydW4tdGltZSBieSBlY2hvaW5nIHRoZSBkZWJ1ZyBjYXRlZ29yeSB2YWx1
ZSBpbiBpdHMgc3lzZnMgbm9kZTo6CiAgKgorICogICAjIEZvciBzeXNsb2cgbG9nZ2luZzoKICAq
ICAgIyBlY2hvIDB4ZiA+IC9zeXMvbW9kdWxlL2RybS9wYXJhbWV0ZXJzL2RlYnVnCiAgKgorICog
ICAjIEZvciB0cmFjZWZzIGxvZ2dpbmc6CisgKiAgICMgZWNobyAweGYgPiAvc3lzL21vZHVsZS9k
cm0vcGFyYW1ldGVycy90cmFjZQorICoKICAqLwogZW51bSBkcm1fZGVidWdfY2F0ZWdvcnkgewog
CS8qKgpAQCAtMzI1LDE0ICszMzQsMjAgQEAgc3RhdGljIGlubGluZSBib29sIGRybV9kZWJ1Z19z
eXNsb2dfZW5hYmxlZChlbnVtIGRybV9kZWJ1Z19jYXRlZ29yeSBjYXRlZ29yeSkKIAlyZXR1cm4g
dW5saWtlbHkoX19kcm1fZGVidWdfc3lzbG9nICYgY2F0ZWdvcnkpOwogfQogCitzdGF0aWMgaW5s
aW5lIGJvb2wgZHJtX2RlYnVnX3RyYWNlX2VuYWJsZWQoZW51bSBkcm1fZGVidWdfY2F0ZWdvcnkg
Y2F0ZWdvcnkpCit7CisJcmV0dXJuIHVubGlrZWx5KF9fZHJtX2RlYnVnX3RyYWNlICYgY2F0ZWdv
cnkpOworfQorCiBzdGF0aWMgaW5saW5lIGJvb2wgZHJtX2RlYnVnX2VuYWJsZWQoZW51bSBkcm1f
ZGVidWdfY2F0ZWdvcnkgY2F0ZWdvcnkpCiB7Ci0JcmV0dXJuIGRybV9kZWJ1Z19zeXNsb2dfZW5h
YmxlZChjYXRlZ29yeSk7CisJcmV0dXJuIGRybV9kZWJ1Z19zeXNsb2dfZW5hYmxlZChjYXRlZ29y
eSkgfHwKKwkgICAgICAgZHJtX2RlYnVnX3RyYWNlX2VuYWJsZWQoY2F0ZWdvcnkpOwogfQogCiAv
KioKICAqIGRybV9kZWJ1Z19jYXRlZ29yeV9wcmludGVyIC0gY29uc3RydWN0IGEgJmRybV9wcmlu
dGVyIHRoYXQgb3V0cHV0cyB0bwotICogcHJfZGVidWcoKSBpZiBlbmFibGVkIGZvciB0aGUgZ2l2
ZW4gY2F0ZWdvcnkuCisgKiBwcl9kZWJ1ZygpIGFuZC9vciB0aGUgZHJtIHRyYWNlZnMgaW5zdGFu
Y2UgaWYgZW5hYmxlZCBmb3IgdGhlIGdpdmVuIGNhdGVnb3J5LgogICogQGNhdGVnb3J5OiB0aGUg
RFJNX1VUXyogbWVzc2FnZSBjYXRlZ29yeSB0aGlzIG1lc3NhZ2UgYmVsb25ncyB0bwogICogQHBy
ZWZpeDogdHJhY2Ugb3V0cHV0IHByZWZpeAogICoKQEAgLTM0Nyw4ICszNjIsMTMgQEAgZHJtX2Rl
YnVnX2NhdGVnb3J5X3ByaW50ZXIoZW51bSBkcm1fZGVidWdfY2F0ZWdvcnkgY2F0ZWdvcnksCiAJ
CS5wcmVmaXggPSBwcmVmaXgKIAl9OwogCi0JaWYgKGRybV9kZWJ1Z19zeXNsb2dfZW5hYmxlZChj
YXRlZ29yeSkpIHsKKwlpZiAoZHJtX2RlYnVnX3N5c2xvZ19lbmFibGVkKGNhdGVnb3J5KSAmJgor
CSAgICBkcm1fZGVidWdfdHJhY2VfZW5hYmxlZChjYXRlZ29yeSkpIHsKKwkJcC5wcmludGZuID0g
X19kcm1fcHJpbnRmbl9kZWJ1Z19zeXNsb2dfYW5kX3RyYWNlOworCX0gZWxzZSBpZiAoZHJtX2Rl
YnVnX3N5c2xvZ19lbmFibGVkKGNhdGVnb3J5KSkgewogCQlwLnByaW50Zm4gPSBfX2RybV9wcmlu
dGZuX2RlYnVnX3N5c2xvZzsKKwl9IGVsc2UgaWYgKGRybV9kZWJ1Z190cmFjZV9lbmFibGVkKGNh
dGVnb3J5KSkgeworCQlwLnByaW50Zm4gPSBfX2RybV9wcmludGZuX3RyYWNlOwogCX0gZWxzZSB7
CiAJCVdBUk4oMSwgIkRlYnVnIGNhdGVnb3J5ICVkIGlzIGluYWN0aXZlLiIsIGNhdGVnb3J5KTsK
IAkJcC5wcmludGZuID0gX19kcm1fcHJpbnRmbl9ub29wOwpAQCAtMzU3LDYgKzM3NywyNyBAQCBk
cm1fZGVidWdfY2F0ZWdvcnlfcHJpbnRlcihlbnVtIGRybV9kZWJ1Z19jYXRlZ29yeSBjYXRlZ29y
eSwKIAlyZXR1cm4gcDsKIH0KIAorCisjaWZkZWYgQ09ORklHX1RSQUNJTkcKK3ZvaWQgZHJtX3Ry
YWNlX2luaXQodm9pZCk7CitfX3ByaW50ZigxLCAyKQordm9pZCBkcm1fdHJhY2VfcHJpbnRmKGNv
bnN0IGNoYXIgKmZvcm1hdCwgLi4uKTsKK3ZvaWQgZHJtX3RyYWNlX2NsZWFudXAodm9pZCk7Cisj
ZWxzZQorc3RhdGljIGlubGluZSB2b2lkIGRybV90cmFjZV9pbml0KHZvaWQpCit7Cit9CisKK19f
cHJpbnRmKDEsIDIpCitzdGF0aWMgaW5saW5lIHZvaWQgZHJtX3RyYWNlX3ByaW50Zihjb25zdCBj
aGFyICpmb3JtYXQsIC4uLikKK3sKK30KKworc3RhdGljIGlubGluZSB2b2lkIGRybV90cmFjZV9j
bGVhbnVwKHZvaWQpCit7Cit9CisjZW5kaWYKKwogLyoKICAqIHN0cnVjdCBkZXZpY2UgYmFzZWQg
bG9nZ2luZwogICoKLS0gClNlYW4gUGF1bCwgU29mdHdhcmUgRW5naW5lZXIsIEdvb2dsZSAvIENo
cm9taXVtIE9TCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
XwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcK
aHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWwK
