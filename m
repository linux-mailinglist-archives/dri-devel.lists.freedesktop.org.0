Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id EEB161BE7E0
	for <lists+dri-devel@lfdr.de>; Wed, 29 Apr 2020 21:55:42 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 10F516F3BE;
	Wed, 29 Apr 2020 19:55:35 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-qv1-xf44.google.com (mail-qv1-xf44.google.com
 [IPv6:2607:f8b0:4864:20::f44])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2113F6F3AE
 for <dri-devel@lists.freedesktop.org>; Wed, 29 Apr 2020 19:55:28 +0000 (UTC)
Received: by mail-qv1-xf44.google.com with SMTP id t8so1808467qvw.5
 for <dri-devel@lists.freedesktop.org>; Wed, 29 Apr 2020 12:55:28 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=poorly.run; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=Q2DeyukvVUG+F/tSua3J0o+Jo+IuXD3uC3kdijpW1AU=;
 b=PdqTuxhSzwc/w4PS2n7DYAR4gQ9cqJLEEARjUwBLG7hJKtstuE3TqIUCHZVSyDw1ah
 Tf4GC0772mUW9agYsqh0DdZgQqv5xjN8VKy4ukG1mPm0H/EaqzjRkpYg9FC8hRxugKmX
 7+1t2X82kQRJImQmR8/lAXcdJSkm8fKQTfTZRxUZLZCCNczcvvE1rHf9cyff/Q6z9hCU
 3pPFsRzDZ4sbffFhdNzeQZETj6oXABOBaA9UtBo/imdQng/2dIw8JuMEClNIBhZxgoHj
 uo7XzYygxs28MazIZppDDTGmoGO/hl9eP4y7uQgM8wZodZOvwa6Cwjt0N53C+K4SPwYP
 nNZA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=Q2DeyukvVUG+F/tSua3J0o+Jo+IuXD3uC3kdijpW1AU=;
 b=IQ1zIfm4vTk103fV9JKdo7PkzALKBHjocWvVJBBSEpl46SWyutVo3at3feYTaaBqAs
 iBWU1RY6eSFajgzDkIMOXVw7P+dDKcCOumiMZxovyFuMv0526q1ZQVXHZg27R3tEBHtH
 hzHDg+8weDVbDRbYQgwHfMEAd++6CKep/ExrIKI7l3yAp4skBziC51AN3laSjylgEdH0
 LJNSMrZ22qgscfZCHHhyQXQIugPo6pL5ZTjL1bFUSghI9DRaNEZfg3YHzjUIfccHdWub
 7Xxb/wjDLga8BxFBOJxXUQP1+vOKIvOb73CA6OtxBoh2dbuK08++w7HgSlf9fqnlCSG6
 nQhQ==
X-Gm-Message-State: AGi0PuaWUfY6r+j96P6dSIla+jValzOpnXCZBPGxS3y3JLQzxn+eB1GV
 KPx+u0L5ajMFgsQt7M9hOzA3GmqztLI=
X-Google-Smtp-Source: APiQypJZ5BdurhNuD+qQWBtuBsvRYWAl6/WpldIs7D6sJjyrHnHxarGOcuU7C6H8KRENEbj2t6vAAA==
X-Received: by 2002:a0c:f38d:: with SMTP id i13mr35046859qvk.187.1588190126910; 
 Wed, 29 Apr 2020 12:55:26 -0700 (PDT)
Received: from localhost (mobile-166-170-55-34.mycingular.net. [166.170.55.34])
 by smtp.gmail.com with ESMTPSA id t75sm111339qke.127.2020.04.29.12.55.25
 (version=TLS1_2 cipher=ECDHE-ECDSA-CHACHA20-POLY1305 bits=256/256);
 Wed, 29 Apr 2020 12:55:26 -0700 (PDT)
From: Sean Paul <sean@poorly.run>
To: dri-devel@lists.freedesktop.org,
	intel-gfx@lists.freedesktop.org
Subject: [PATCH v6 12/16] drm/i915: Plumb port through hdcp init
Date: Wed, 29 Apr 2020 15:54:58 -0400
Message-Id: <20200429195502.39919-13-sean@poorly.run>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200429195502.39919-1-sean@poorly.run>
References: <20200429195502.39919-1-sean@poorly.run>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: daniel.vetter@ffwll.ch, seanpaul@chromium.org, juston.li@intel.com,
 rodrigo.vivi@intel.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogU2VhbiBQYXVsIDxzZWFucGF1bEBjaHJvbWl1bS5vcmc+CgpUaGlzIHBhdGNoIHBsdW1i
cyBwb3J0IHRocm91Z2ggaGRjcCBpbml0IGluc3RlYWQgb2YgcmVseWluZyBvbgppbnRlbF9hdHRh
Y2hlZF9lbmNvZGVyKCkgdG8gcmV0dXJuIGEgbm9uLU5VTEwgZW5jb2RlciB3aGljaCB3b24ndCB3
b3JrCmZvciBNU1QgY29ubmVjdG9ycy4KCkNjOiBWaWxsZSBTeXJqw6Rsw6QgPHZpbGxlLnN5cmph
bGFAbGludXguaW50ZWwuY29tPgpTaWduZWQtb2ZmLWJ5OiBTZWFuIFBhdWwgPHNlYW5wYXVsQGNo
cm9taXVtLm9yZz4KCkNoYW5nZXMgaW4gdjU6Ci1BZGRlZCB0byB0aGUgc2V0CkNoYW5nZXMgaW4g
djY6Ci1Ob25lCgpTaWduZWQtb2ZmLWJ5OiBTZWFuIFBhdWwgPHNlYW5wYXVsQGNocm9taXVtLm9y
Zz4KTGluazogaHR0cHM6Ly9wYXRjaHdvcmsuZnJlZWRlc2t0b3Aub3JnL3BhdGNoL21zZ2lkLzIw
MjAwMzA1MjAxMjM2LjE1MjMwNy0xMy1zZWFuQHBvb3JseS5ydW4gI3Y1Ci0tLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcF9oZGNwLmMgfCAgMyArKy0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRjcC5jICAgIHwgMTEgKysrKysrLS0tLS0KIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRjcC5oICAgIHwgIDIgKy0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRtaS5jICAgIHwgIDIgKy0KIDQgZmlsZXMgY2hh
bmdlZCwgMTAgaW5zZXJ0aW9ucygrKSwgOCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwX2hkY3AuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHBfaGRjcC5jCmluZGV4IDJjOTRkZmJmZTRjYi4uNTIyMDdm
NzY3ZjQ4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rw
X2hkY3AuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwX2hkY3Au
YwpAQCAtNjMwLDcgKzYzMCw4IEBAIGludCBpbnRlbF9kcF9pbml0X2hkY3Aoc3RydWN0IGludGVs
X2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCiAJCXJldHVybiAwOwogCiAJaWYgKCFpbnRl
bF9kcF9pc19lZHAoaW50ZWxfZHApKQotCQlyZXR1cm4gaW50ZWxfaGRjcF9pbml0KGludGVsX2Nv
bm5lY3RvciwgJmludGVsX2RwX2hkY3Bfc2hpbSk7CisJCXJldHVybiBpbnRlbF9oZGNwX2luaXQo
aW50ZWxfY29ubmVjdG9yLCBwb3J0LAorCQkJCSAgICAgICAmaW50ZWxfZHBfaGRjcF9zaGltKTsK
IAogCXJldHVybiAwOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9oZGNwLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2hkY3Au
YwppbmRleCAwYzAwYmJjM2Y2NmUuLjA0MWZlMWY2OWI3MyAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9oZGNwLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9oZGNwLmMKQEAgLTE5NTUsNiArMTk1NSw3IEBAIHN0YXRpYyBlbnVt
IG1laV9md190YyBpbnRlbF9nZXRfbWVpX2Z3X3RjKGVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNj
b2RlcikKIH0KIAogc3RhdGljIGludCBpbml0aWFsaXplX2hkY3BfcG9ydF9kYXRhKHN0cnVjdCBp
bnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwKKwkJCQkgICAgIGVudW0gcG9ydCBwb3J0LAogCQkJ
CSAgICAgY29uc3Qgc3RydWN0IGludGVsX2hkY3Bfc2hpbSAqc2hpbSkKIHsKIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwpA
QCAtMTk2Miw4ICsxOTYzLDcgQEAgc3RhdGljIGludCBpbml0aWFsaXplX2hkY3BfcG9ydF9kYXRh
KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwKIAlzdHJ1Y3QgaGRjcF9wb3J0X2Rh
dGEgKmRhdGEgPSAmaGRjcC0+cG9ydF9kYXRhOwogCiAJaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
PCAxMikKLQkJZGF0YS0+ZndfZGRpID0KLQkJCWludGVsX2dldF9tZWlfZndfZGRpX2luZGV4KGlu
dGVsX2F0dGFjaGVkX2VuY29kZXIoY29ubmVjdG9yKS0+cG9ydCk7CisJCWRhdGEtPmZ3X2RkaSA9
IGludGVsX2dldF9tZWlfZndfZGRpX2luZGV4KHBvcnQpOwogCWVsc2UKIAkJLyoKIAkJICogQXMg
cGVyIE1FIEZXIEFQSSBleHBlY3RhdGlvbiwgZm9yIEdFTiAxMissIGZ3X2RkaSBpcyBmaWxsZWQK
QEAgLTIwMzAsMTQgKzIwMzAsMTQgQEAgdm9pZCBpbnRlbF9oZGNwX2NvbXBvbmVudF9pbml0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAl9CiB9CiAKLXN0YXRpYyB2b2lkIGlu
dGVsX2hkY3AyX2luaXQoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLAorc3RhdGlj
IHZvaWQgaW50ZWxfaGRjcDJfaW5pdChzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3Is
IGVudW0gcG9ydCBwb3J0LAogCQkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfaGRjcF9zaGltICpz
aGltKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0
b3ItPmJhc2UuZGV2KTsKIAlzdHJ1Y3QgaW50ZWxfaGRjcCAqaGRjcCA9ICZjb25uZWN0b3ItPmhk
Y3A7CiAJaW50IHJldDsKIAotCXJldCA9IGluaXRpYWxpemVfaGRjcF9wb3J0X2RhdGEoY29ubmVj
dG9yLCBzaGltKTsKKwlyZXQgPSBpbml0aWFsaXplX2hkY3BfcG9ydF9kYXRhKGNvbm5lY3Rvciwg
cG9ydCwgc2hpbSk7CiAJaWYgKHJldCkgewogCQlkcm1fZGJnX2ttcygmaTkxNS0+ZHJtLCAiTWVp
IGhkY3AgZGF0YSBpbml0IGZhaWxlZFxuIik7CiAJCXJldHVybjsKQEAgLTIwNDcsNiArMjA0Nyw3
IEBAIHN0YXRpYyB2b2lkIGludGVsX2hkY3AyX2luaXQoc3RydWN0IGludGVsX2Nvbm5lY3RvciAq
Y29ubmVjdG9yLAogfQogCiBpbnQgaW50ZWxfaGRjcF9pbml0KHN0cnVjdCBpbnRlbF9jb25uZWN0
b3IgKmNvbm5lY3RvciwKKwkJICAgIGVudW0gcG9ydCBwb3J0LAogCQkgICAgY29uc3Qgc3RydWN0
IGludGVsX2hkY3Bfc2hpbSAqc2hpbSkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwpAQCAtMjA1Nyw3ICsyMDU4LDcg
QEAgaW50IGludGVsX2hkY3BfaW5pdChzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3Is
CiAJCXJldHVybiAtRUlOVkFMOwogCiAJaWYgKGlzX2hkY3AyX3N1cHBvcnRlZChkZXZfcHJpdikp
Ci0JCWludGVsX2hkY3AyX2luaXQoY29ubmVjdG9yLCBzaGltKTsKKwkJaW50ZWxfaGRjcDJfaW5p
dChjb25uZWN0b3IsIHBvcnQsIHNoaW0pOwogCiAJcmV0ID0KIAlkcm1fY29ubmVjdG9yX2F0dGFj
aF9jb250ZW50X3Byb3RlY3Rpb25fcHJvcGVydHkoJmNvbm5lY3Rvci0+YmFzZSwKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRjcC5oIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9oZGNwLmgKaW5kZXggODZiYmFlYzEyMGNjLi4xYmJm
NWI2N2VkMGEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
aGRjcC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRjcC5oCkBA
IC0yMiw3ICsyMiw3IEBAIGVudW0gdHJhbnNjb2RlcjsKIHZvaWQgaW50ZWxfaGRjcF9hdG9taWNf
Y2hlY2soc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKIAkJCSAgICAgc3RydWN0IGRy
bV9jb25uZWN0b3Jfc3RhdGUgKm9sZF9zdGF0ZSwKIAkJCSAgICAgc3RydWN0IGRybV9jb25uZWN0
b3Jfc3RhdGUgKm5ld19zdGF0ZSk7Ci1pbnQgaW50ZWxfaGRjcF9pbml0KHN0cnVjdCBpbnRlbF9j
b25uZWN0b3IgKmNvbm5lY3RvciwKK2ludCBpbnRlbF9oZGNwX2luaXQoc3RydWN0IGludGVsX2Nv
bm5lY3RvciAqY29ubmVjdG9yLCBlbnVtIHBvcnQgcG9ydCwKIAkJICAgIGNvbnN0IHN0cnVjdCBp
bnRlbF9oZGNwX3NoaW0gKmhkY3Bfc2hpbSk7CiBpbnQgaW50ZWxfaGRjcF9lbmFibGUoc3RydWN0
IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLAogCQkgICAgICBlbnVtIHRyYW5zY29kZXIgY3B1
X3RyYW5zY29kZXIsIHU4IGNvbnRlbnRfdHlwZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2hkbWkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfaGRtaS5jCmluZGV4IDkzY2Q4YTJhNGJlMS4uOWM1YjQwZTRjMGM0IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2hkbWkuYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2hkbWkuYwpAQCAtMzI0MCw3ICszMjQwLDcg
QEAgdm9pZCBpbnRlbF9oZG1pX2luaXRfY29ubmVjdG9yKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3Bv
cnQgKmludGVsX2RpZ19wb3J0LAogCWludGVsX2hkbWktPmF0dGFjaGVkX2Nvbm5lY3RvciA9IGlu
dGVsX2Nvbm5lY3RvcjsKIAogCWlmIChpc19oZGNwX3N1cHBvcnRlZChkZXZfcHJpdiwgcG9ydCkp
IHsKLQkJaW50IHJldCA9IGludGVsX2hkY3BfaW5pdChpbnRlbF9jb25uZWN0b3IsCisJCWludCBy
ZXQgPSBpbnRlbF9oZGNwX2luaXQoaW50ZWxfY29ubmVjdG9yLCBwb3J0LAogCQkJCQkgICZpbnRl
bF9oZG1pX2hkY3Bfc2hpbSk7CiAJCWlmIChyZXQpCiAJCQlkcm1fZGJnX2ttcygmZGV2X3ByaXYt
PmRybSwKLS0gClNlYW4gUGF1bCwgU29mdHdhcmUgRW5naW5lZXIsIEdvb2dsZSAvIENocm9taXVt
IE9TCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmkt
ZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6
Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWwK
