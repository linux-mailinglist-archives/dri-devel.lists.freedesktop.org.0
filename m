Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 1AC63796CE
	for <lists+dri-devel@lfdr.de>; Mon, 29 Jul 2019 21:55:57 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3B4766E1D8;
	Mon, 29 Jul 2019 19:55:50 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from smtp.domeneshop.no (smtp.domeneshop.no
 [IPv6:2a01:5b40:0:3005::1])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3E22F89D44
 for <dri-devel@lists.freedesktop.org>; Mon, 29 Jul 2019 19:55:49 +0000 (UTC)
Received: from 211.81-166-168.customer.lyse.net ([81.166.168.211]:57528
 helo=localhost.localdomain)
 by smtp.domeneshop.no with esmtpsa (TLS1.2:ECDHE_RSA_AES_128_CBC_SHA1:128)
 (Exim 4.84_2) (envelope-from <noralf@tronnes.org>)
 id 1hsBkJ-0003F7-8z; Mon, 29 Jul 2019 21:55:47 +0200
From: =?UTF-8?q?Noralf=20Tr=C3=B8nnes?= <noralf@tronnes.org>
To: dri-devel@lists.freedesktop.org
Subject: [RFC 3/4] drm/mipi-dbi: Support command mode panel drivers
Date: Mon, 29 Jul 2019 21:55:25 +0200
Message-Id: <20190729195526.13337-4-noralf@tronnes.org>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190729195526.13337-1-noralf@tronnes.org>
References: <20190729195526.13337-1-noralf@tronnes.org>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; d=tronnes.org; s=ds201810; 
 h=Content-Transfer-Encoding:Content-Type:MIME-Version:References:In-Reply-To:Message-Id:Date:Subject:Cc:To:From;
 bh=iUsAn6d1xonZz2FlYpvAh2knModBIOcpF6Herk4RzKk=; 
 b=WlyaknEB+NAHQw8WErrA3h23DHAG5QjeIpXDrAhz+UwVKwS+INg0Ge7QDqKlwtxvJRI7xA/EyFUALYFOHr7KEFXEEIlHhWyLa1slusffPCaU+1t1e825k7MWQXCe7Sj+pxVvpkukKWURoY7YN/cr4taSb0fGzbgZ1980T0QI2t5moiv/aJxz24S0e79U+QzBBLU6Cj3v8BM3gW1ew5qvwfOOLIUxLn5DVdZVFMrc+TBjWmEvnKJYAGI/tcN4E4WnkaU62ohytpy+bosMYmqRG3Z/QmRRoy/jzzUBmwKUiVXLSv0o0DGvI1Wt2S6oku1CpJRKIILGNlggPPGYQRYZEQ==;
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: daniel.vetter@ffwll.ch, josef@lusticky.cz, thierry.reding@gmail.com,
 laurent.pinchart@ideasonboard.com, sam@ravnborg.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBhZGRzIGEgZnVuY3Rpb24gdGhhdCByZWdpc3RlcnMgYSBEUk0gZHJpdmVyIGZvciB1c2Ug
d2l0aCBNSVBJIERCSQpwYW5lbHMgaW4gY29tbWFuZCBtb2RlLiBUaGF0IGlzLCBmcmFtZWJ1ZmZl
ciB1cGxvYWQgb3ZlciBEQkkuCgpTaWduZWQtb2ZmLWJ5OiBOb3JhbGYgVHLDuG5uZXMgPG5vcmFs
ZkB0cm9ubmVzLm9yZz4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vZHJtX21pcGlfZGJpLmMgfCAxMTAg
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiBpbmNsdWRlL2RybS9kcm1fbWlwaV9k
YmkuaCAgICAgfCAgIDggKysrCiAyIGZpbGVzIGNoYW5nZWQsIDExOCBpbnNlcnRpb25zKCspCgpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2RybV9taXBpX2RiaS5jIGIvZHJpdmVycy9ncHUv
ZHJtL2RybV9taXBpX2RiaS5jCmluZGV4IDE5NjFmNzEzYWFhYi4uZWY2Yjg0M2VhZjMxIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vZHJtX21pcGlfZGJpLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2RybV9taXBpX2RiaS5jCkBAIC0xMCw2ICsxMCw3IEBACiAjaW5jbHVkZSA8bGludXgvZG1h
LWJ1Zi5oPgogI2luY2x1ZGUgPGxpbnV4L2dwaW8vY29uc3VtZXIuaD4KICNpbmNsdWRlIDxsaW51
eC9tb2R1bGUuaD4KKyNpbmNsdWRlIDxsaW51eC9wcm9wZXJ0eS5oPgogI2luY2x1ZGUgPGxpbnV4
L3JlZ3VsYXRvci9jb25zdW1lci5oPgogI2luY2x1ZGUgPGxpbnV4L3NwaS9zcGkuaD4KIApAQCAt
MTcsMTEgKzE4LDEzIEBACiAjaW5jbHVkZSA8ZHJtL2RybV9kYW1hZ2VfaGVscGVyLmg+CiAjaW5j
bHVkZSA8ZHJtL2RybV9kcnYuaD4KICNpbmNsdWRlIDxkcm0vZHJtX2dlbV9jbWFfaGVscGVyLmg+
CisjaW5jbHVkZSA8ZHJtL2RybV9mYl9oZWxwZXIuaD4KICNpbmNsdWRlIDxkcm0vZHJtX2Zvcm1h
dF9oZWxwZXIuaD4KICNpbmNsdWRlIDxkcm0vZHJtX2ZvdXJjYy5oPgogI2luY2x1ZGUgPGRybS9k
cm1fZ2VtX2ZyYW1lYnVmZmVyX2hlbHBlci5oPgogI2luY2x1ZGUgPGRybS9kcm1fbWlwaV9kYmku
aD4KICNpbmNsdWRlIDxkcm0vZHJtX21vZGVzLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wYW5lbC5o
PgogI2luY2x1ZGUgPGRybS9kcm1fcHJvYmVfaGVscGVyLmg+CiAjaW5jbHVkZSA8ZHJtL2RybV9y
ZWN0Lmg+CiAjaW5jbHVkZSA8ZHJtL2RybV92YmxhbmsuaD4KQEAgLTU5Nyw2ICs2MDAsMTEzIEBA
IHZvaWQgbWlwaV9kYmlfcmVsZWFzZShzdHJ1Y3QgZHJtX2RldmljZSAqZHJtKQogfQogRVhQT1JU
X1NZTUJPTChtaXBpX2RiaV9yZWxlYXNlKTsKIAorc3RhdGljIHZvaWQgZHJtX21pcGlfZGJpX3Bh
bmVsX3BpcGVfZW5hYmxlKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlwZSAqcGlwZSwKKwkJ
CQkJICAgc3RydWN0IGRybV9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAorCQkJCQkgICBzdHJ1Y3Qg
ZHJtX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKK3sKKwlzdHJ1Y3QgbWlwaV9kYmlfZGV2ICpk
YmlkZXYgPSBkcm1fdG9fbWlwaV9kYmlfZGV2KHBpcGUtPmNydGMuZGV2KTsKKwlzdHJ1Y3QgZHJt
X3BhbmVsICpwYW5lbCA9IGRiaWRldi0+cGFuZWw7CisJaW50IHJldCwgaWR4OworCisJaWYgKCFk
cm1fZGV2X2VudGVyKHBpcGUtPmNydGMuZGV2LCAmaWR4KSkKKwkJcmV0dXJuOworCisJRFJNX0RF
QlVHX0tNUygiXG4iKTsKKworCXJldCA9IGRybV9wYW5lbF9wcmVwYXJlKHBhbmVsKTsKKwlpZiAo
cmV0KQorCQlnb3RvIG91dF9leGl0OworCisJbWlwaV9kYmlfZW5hYmxlX2ZsdXNoKGRiaWRldiwg
Y3J0Y19zdGF0ZSwgcGxhbmVfc3RhdGUpOworCisJZHJtX3BhbmVsX2VuYWJsZShwYW5lbCk7Citv
dXRfZXhpdDoKKwlkcm1fZGV2X2V4aXQoaWR4KTsKK30KKworc3RhdGljIHZvaWQgZHJtX21pcGlf
ZGJpX3BhbmVsX3BpcGVfZGlzYWJsZShzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBp
cGUpCit7CisJc3RydWN0IG1pcGlfZGJpX2RldiAqZGJpZGV2ID0gZHJtX3RvX21pcGlfZGJpX2Rl
dihwaXBlLT5jcnRjLmRldik7CisJc3RydWN0IGRybV9wYW5lbCAqcGFuZWwgPSBkYmlkZXYtPnBh
bmVsOworCisJaWYgKCFkYmlkZXYtPmVuYWJsZWQpCisJCXJldHVybjsKKworCURSTV9ERUJVR19L
TVMoIlxuIik7CisKKwlkYmlkZXYtPmVuYWJsZWQgPSBmYWxzZTsKKwlkcm1fcGFuZWxfZGlzYWJs
ZShwYW5lbCk7CisJZHJtX3BhbmVsX3VucHJlcGFyZShwYW5lbCk7Cit9CisKK3N0YXRpYyBjb25z
dCBzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGVfZnVuY3MgZHJtX21pcGlfZGJpX3BpcGVf
ZnVuY3MgPSB7CisJLmVuYWJsZSA9IGRybV9taXBpX2RiaV9wYW5lbF9waXBlX2VuYWJsZSwKKwku
ZGlzYWJsZSA9IGRybV9taXBpX2RiaV9wYW5lbF9waXBlX2Rpc2FibGUsCisJLnVwZGF0ZSA9IG1p
cGlfZGJpX3BpcGVfdXBkYXRlLAorCS5wcmVwYXJlX2ZiID0gZHJtX2dlbV9mYl9zaW1wbGVfZGlz
cGxheV9waXBlX3ByZXBhcmVfZmIsCit9OworCitERUZJTkVfRFJNX0dFTV9DTUFfRk9QUyhkcm1f
bWlwaV9kYmlfZm9wcyk7CisKK3N0YXRpYyBzdHJ1Y3QgZHJtX2RyaXZlciBkcm1fbWlwaV9kYmlf
ZHJpdmVyID0geworCS5kcml2ZXJfZmVhdHVyZXMJPSBEUklWRVJfR0VNIHwgRFJJVkVSX01PREVT
RVQgfCBEUklWRVJfQVRPTUlDLAorCS5mb3BzCQkJPSAmZHJtX21pcGlfZGJpX2ZvcHMsCisJLnJl
bGVhc2UJCT0gbWlwaV9kYmlfcmVsZWFzZSwKKwlEUk1fR0VNX0NNQV9WTUFQX0RSSVZFUl9PUFMs
CisJLmRlYnVnZnNfaW5pdAkJPSBtaXBpX2RiaV9kZWJ1Z2ZzX2luaXQsCisJLm5hbWUJCQk9ICJk
cm1fbWlwaV9kYmkiLAorCS5kZXNjCQkJPSAiRFJNIE1JUEkgREJJIiwKKwkuZGF0ZQkJCT0gIjIw
MTkwNzI5IiwKKwkubWFqb3IJCQk9IDEsCisJLm1pbm9yCQkJPSAwLAorfTsKKworLyoqCisgKiBk
cm1fbWlwaV9kYmlfcGFuZWxfcmVnaXN0ZXIgLSBSZWdpc3RlciBhIE1JUEkgREJJIERSTSBkcml2
ZXIKKyAqIEBwYW5lbDogRFJNIFBhbmVsCisgKiBAZGJpZGV2OiBNSVBJIERCSSBkZXZpY2Ugc3Ry
dWN0dXJlIHRvIGluaXRpYWxpemUKKyAqIEBtb2RlOiBEaXNwbGF5IG1vZGUKKyAqCisgKiBUaGlz
IGZ1bmN0aW9uIHJlZ2lzdGVyZXMgYSBEUk0gZHJpdmVyIHdpdGggQHBhbmVsIGF0dGFjaGVkLgor
ICoKKyAqIFJldHVybnM6CisgKiBaZXJvIG9uIHN1Y2Nlc3MsIG5lZ2F0aXZlIGVycm9yIGNvZGUg
b24gZmFpbHVyZS4KKyAqLworaW50IGRybV9taXBpX2RiaV9wYW5lbF9yZWdpc3RlcihzdHJ1Y3Qg
ZHJtX3BhbmVsICpwYW5lbCwgc3RydWN0IG1pcGlfZGJpX2RldiAqZGJpZGV2LAorCQkJCWNvbnN0
IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlKQoreworCXN0cnVjdCBkZXZpY2UgKmRldiA9
IHBhbmVsLT5kZXY7CisJc3RydWN0IGRybV9kZXZpY2UgKmRybTsKKwl1MzIgcm90YXRpb24gPSAw
OworCWludCByZXQ7CisKKwlkYmlkZXYtPnBhbmVsID0gcGFuZWw7CisKKwlkcm0gPSAmZGJpZGV2
LT5kcm07CisJcmV0ID0gZGV2bV9kcm1fZGV2X2luaXQoZGV2LCBkcm0sICZkcm1fbWlwaV9kYmlf
ZHJpdmVyKTsKKwlpZiAocmV0KSB7CisJCWtmcmVlKGRiaWRldik7CisJCXJldHVybiByZXQ7CisJ
fQorCisJZHJtX21vZGVfY29uZmlnX2luaXQoZHJtKTsKKworCWRldmljZV9wcm9wZXJ0eV9yZWFk
X3UzMihkZXYsICJyb3RhdGlvbiIsICZyb3RhdGlvbik7CisKKwlyZXQgPSBtaXBpX2RiaV9kZXZf
aW5pdChkYmlkZXYsICZkcm1fbWlwaV9kYmlfcGlwZV9mdW5jcywgbW9kZSwgcm90YXRpb24pOwor
CisJZHJtX21vZGVfY29uZmlnX3Jlc2V0KGRybSk7CisKKwlyZXQgPSBkcm1fZGV2X3JlZ2lzdGVy
KGRybSwgMCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCWRybV9mYmRldl9nZW5lcmlj
X3NldHVwKGRybSwgMTYpOworCisJcmV0dXJuIDA7Cit9CitFWFBPUlRfU1lNQk9MKGRybV9taXBp
X2RiaV9wYW5lbF9yZWdpc3Rlcik7CisKIC8qKgogICogbWlwaV9kYmlfaHdfcmVzZXQgLSBIYXJk
d2FyZSByZXNldCBvZiBjb250cm9sbGVyCiAgKiBAZGJpOiBNSVBJIERCSSBzdHJ1Y3R1cmUKZGlm
ZiAtLWdpdCBhL2luY2x1ZGUvZHJtL2RybV9taXBpX2RiaS5oIGIvaW5jbHVkZS9kcm0vZHJtX21p
cGlfZGJpLmgKaW5kZXggNjdjNjZmNWVlNTkxLi5lNTA0NzIwOGZmYjggMTAwNjQ0Ci0tLSBhL2lu
Y2x1ZGUvZHJtL2RybV9taXBpX2RiaS5oCisrKyBiL2luY2x1ZGUvZHJtL2RybV9taXBpX2RiaS5o
CkBAIC0xMiw2ICsxMiw3IEBACiAjaW5jbHVkZSA8ZHJtL2RybV9kZXZpY2UuaD4KICNpbmNsdWRl
IDxkcm0vZHJtX3NpbXBsZV9rbXNfaGVscGVyLmg+CiAKK3N0cnVjdCBkcm1fcGFuZWw7CiBzdHJ1
Y3QgZHJtX3JlY3Q7CiBzdHJ1Y3Qgc3BpX2RldmljZTsKIHN0cnVjdCBncGlvX2Rlc2M7CkBAIC0x
MjMsNiArMTI0LDExIEBAIHN0cnVjdCBtaXBpX2RiaV9kZXYgewogCSAqIEBkYmk6IE1JUEkgREJJ
IGludGVyZmFjZQogCSAqLwogCXN0cnVjdCBtaXBpX2RiaSBkYmk7CisKKwkvKioKKwkgKiBAcGFu
ZWw6IEF0dGFjaGVkIERSTSBwYW5lbC4gU2VlIGRybV9taXBpX2RiaV9wYW5lbF9yZWdpc3Rlcigp
LgorCSAqLworCXN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsOwogfTsKIAogc3RhdGljIGlubGluZSBz
dHJ1Y3QgbWlwaV9kYmlfZGV2ICpkcm1fdG9fbWlwaV9kYmlfZGV2KHN0cnVjdCBkcm1fZGV2aWNl
ICpkcm0pCkBAIC0xNDAsNiArMTQ2LDggQEAgaW50IG1pcGlfZGJpX2Rldl9pbml0X3dpdGhfZm9y
bWF0cyhzdHJ1Y3QgbWlwaV9kYmlfZGV2ICpkYmlkZXYsCiBpbnQgbWlwaV9kYmlfZGV2X2luaXQo
c3RydWN0IG1pcGlfZGJpX2RldiAqZGJpZGV2LAogCQkgICAgICBjb25zdCBzdHJ1Y3QgZHJtX3Np
bXBsZV9kaXNwbGF5X3BpcGVfZnVuY3MgKmZ1bmNzLAogCQkgICAgICBjb25zdCBzdHJ1Y3QgZHJt
X2Rpc3BsYXlfbW9kZSAqbW9kZSwgdW5zaWduZWQgaW50IHJvdGF0aW9uKTsKK2ludCBkcm1fbWlw
aV9kYmlfcGFuZWxfcmVnaXN0ZXIoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwsIHN0cnVjdCBtaXBp
X2RiaV9kZXYgKmRiaWRldiwKKwkJCQljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9k
ZSk7CiB2b2lkIG1pcGlfZGJpX3JlbGVhc2Uoc3RydWN0IGRybV9kZXZpY2UgKmRybSk7CiB2b2lk
IG1pcGlfZGJpX3BpcGVfdXBkYXRlKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlwZSAqcGlw
ZSwKIAkJCSAgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqb2xkX3N0YXRlKTsKLS0gCjIuMjAuMQoK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVs
IG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlz
dHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
