Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 31B5049BDA
	for <lists+dri-devel@lfdr.de>; Tue, 18 Jun 2019 10:17:03 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 21C646E11A;
	Tue, 18 Jun 2019 08:17:00 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from bhuna.collabora.co.uk (bhuna.collabora.co.uk [46.235.227.227])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A89186E11A
 for <dri-devel@lists.freedesktop.org>; Tue, 18 Jun 2019 08:16:54 +0000 (UTC)
Received: from localhost.localdomain (unknown
 [IPv6:2a01:e0a:2c:6930:5cf4:84a1:2763:fe0d])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested) (Authenticated sender: bbrezillon)
 by bhuna.collabora.co.uk (Postfix) with ESMTPSA id 2A78A285678;
 Tue, 18 Jun 2019 09:16:53 +0100 (BST)
From: Boris Brezillon <boris.brezillon@collabora.com>
To: Rob Herring <robh+dt@kernel.org>,
	Tomeu Vizoso <tomeu@tomeuvizoso.net>
Subject: [PATCH v4 4/4] drm/panfrost: Expose performance counters through
 unstable ioctls
Date: Tue, 18 Jun 2019 10:16:48 +0200
Message-Id: <20190618081648.17297-5-boris.brezillon@collabora.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190618081648.17297-1-boris.brezillon@collabora.com>
References: <20190618081648.17297-1-boris.brezillon@collabora.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: dri-devel@lists.freedesktop.org, Steven Price <steven.price@arm.com>,
 Boris Brezillon <boris.brezillon@collabora.com>,
 Alyssa Rosenzweig <alyssa.rosenzweig@collabora.com>, kernel@collabora.com,
 Alyssa Rosenzweig <alyssa@rosenzweig.io>,
 Emil Velikov <emil.velikov@collabora.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RXhwb3NlIHBlcmZvcm1hbmNlIGNvdW50ZXJzIHRocm91Z2ggMiBkcml2ZXIgc3BlY2lmaWMgaW9j
dGxzOiBvbmUgdG8KZW5hYmxlL2Rpc2FibGUgdGhlIHBlcmZjbnQgYmxvY2ssIGFuZCBvbmUgdG8g
ZHVtcCB0aGUgY291bnRlciB2YWx1ZXMuCgpUaGVyZSBhcmUgZGlzY3Vzc2lvbnMgdG8gZXhwb3Nl
IGdsb2JhbCBwZXJmb3JtYW5jZSBtb25pdG9ycyAodGhvc2UKY291bnRlcnMgdGhhdCBjYW4ndCBi
ZSByZXRyaWV2ZWQgb24gYSBwZXItam9iIGJhc2lzKSBpbiBhIGNvbnNpc3RlbnQKd2F5LCBidXQg
dGhpcyBpcyBsaWtlbHkgdG8gdGFrZSB0aW1lIHRvIHNldHRsZSBvbiBzb21ldGhpbmcgdGhhdCB3
b3Jrcwpmb3IgdmFyaW91cyBIVy91c2Vycy4KVGhlIGlvY3RscyBhcmUgbWFya2VkIHVuc3RhYmxl
IHNvIHdlIGNhbiBnZXQgcmlkIG9mIHRoZW0gd2hlbiB0aGUgdGltZQpjb21lcy4gV2UgaW5pdGFs
bHkgd2VudCBmb3IgYSBkZWJ1Z2ZzLWJhc2VkIGludGVyZmFjZSwgYnV0IHRoaXMgd2FzCm1ha2lu
ZyB0aGUgdHJhbnNpdGlvbiB0byBwZXItRkQgYWRkcmVzcyBzcGFjZSBtb3JlIGNvbXBsaWNhdGVk
ICh3ZSBuZWVkCnRvIHNwZWNpZnkgdGhlIG5hbWVzcGFjZSB0aGUgR1BVIGhhcyB0byB1c2Ugd2hl
biBkdW1waW5nIHRoZSBwZXJmCmNvdW50ZXJzKSwgaGVuY2UgdGhlIGRlY2lzaW9uIHRvIHN3aXRj
aCBiYWNrIHRvIGRyaXZlciBzcGVjaWZpYyBpb2N0bHMKd2hpY2ggYXJlIHBhc3NlZCB0aGUgRkQg
dGhleSBvcGVyYXRlIG9uIGFuZCB0aHVzIHdpbGwgaGF2ZSBhIGRlZGljYXRlZAphZGRyZXNzIHNw
YWNlIGF0dGFjaGVkIHRvIHRoZW0uCgpPdGhlciB0aGFuIHRoYXQsIHRoZSBpbXBsZW1lbnRhdGlv
biBpcyBwcmV0dHkgc2ltcGxlOiBpdCBiYXNpY2FsbHkgZHVtcHMKYWxsIGNvdW50ZXJzIGFuZCBj
b3B5IHRoZSB2YWx1ZXMgdG8gYSB1c2Vyc3BhY2UgYnVmZmVyLiBUaGUgcGFyc2luZyBpcwpsZWZ0
IHRvIHVzZXJzcGFjZSB3aGljaCBoYXMgdG8ga25vdyB0aGUgc3BlY2lmaWMgbGF5b3V0IHRoYXQn
cyB1c2VkCmJ5IHRoZSBHUFUgKGxheW91dCBkaWZmZXJzIG9uIGEgcGVyLXJldmlzaW9uIGJhc2lz
KS4KClNpZ25lZC1vZmYtYnk6IEJvcmlzIEJyZXppbGxvbiA8Ym9yaXMuYnJlemlsbG9uQGNvbGxh
Ym9yYS5jb20+CkFja2VkLWJ5OiBBbHlzc2EgUm9zZW56d2VpZyA8YWx5c3NhQHJvc2VuendlaWcu
aW8+Ci0tLQpDaGFuZ2VzIGluIHY0OgoqIEZpeCBhICJjYXN0IHRvIHBvaW50ZXIgZnJvbSBpbnRl
Z2VyIG9mIGRpZmZlcmVudCBzaXplIiB3YXJuaW5nCiAgKHJlcG9ydGVkIGJ5IGtidWlsZCBib3Rz
KQoqIEFkZCBBbHlzc2EncyBSLWIKKiBVc2UgZHJtX2dlbV9zaG1lbV92W3VuXW1hcCgpIGluc3Rl
YWQgb2YgZHJtX2dlbV92W3VuXW1hcCgpCgpDaGFuZ2VzIGluIHYzOgoqIEV4cG9zZSB0aGluZ3Mg
dGhyb3VnaCBpb2N0bHMgaW5zdGVhZCBvZiBkZWJ1Z3MgKHN1Z2dlc3RlZCBieSBSb2IpCiogRml4
IHRoZSBCTyBzaXplIGNhbGN1bGF0aW9uIChyZXBvcnRlZCBieSBTdGV2ZW4pCiogRHJvcCBwZXJm
Y250IHN1c3BlbmQvcmVzdW1lIGxvZ2ljIChydW50aW1lIHN1c3BlbmQgaXMgcHJldmVudGVkIHdo
ZW4KICBwZXJmY250IGlzIGVuYWJsZWQpCiogRGlzYWJsZSB0aGUgcGVyZmNudCBibG9jayBpbiB0
aGUgX2ZpbmkoKSBwYXRoIChzdWdnZXN0ZWQgYnkgUm9iKQoqIERvIG5vdCBtZXNzIHdpdGggdGhl
IElOVCByZWcgaW4gX2luaXQoKSAoc3VnZ2VzdGVkIGJ5IFJvYikKKiBQcm92aWRlIGEgd2F5IHRv
IHNlbGVjdCBib3RoIHNldCBvZiBjb3VudGVycyBvbiBCaWZyb3N0IEdQVXMKICAoc3VnZ2VzdGVk
IGJ5IFN0ZXZlbikKCkNoYW5nZXMgaW4gdjI6CiogQ29tcGxldGUgcmV3cml0ZSB0byBleHBvc2Ug
dGhpbmdzIHRocm91Z2ggZGVidWdmcyBpbiBhIHNpbXBsZSB3YXkKICAobm8gY291bnRlciBsYXlv
dXQgYWJzdHJhY3Rpb24gYW5kIG5vIHBlci1qb2IgY291bnRlciB0cmFja2luZyB0bwogICBhdm9p
ZCB0aGUgcGVyZiBwZW5hbHR5IGluY3VycmVkIGJ5IHRoZSBleHRyYSBzZXJpYWxpemF0aW9uIGZl
bmNlKQotLS0KIGRyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9NYWtlZmlsZSAgICAgICAgICAgfCAg
IDMgKy0KIGRyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9kZXZpY2UuYyAgfCAgIDgg
KwogZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2RldmljZS5oICB8ICAgMyArCiBk
cml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZHJ2LmMgICAgIHwgICA0ICsKIGRyaXZl
cnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9ncHUuYyAgICAgfCAgIDcgKwogZHJpdmVycy9n
cHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X3BlcmZjbnQuYyB8IDMyOSArKysrKysrKysrKysrKysr
KysrKwogZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X3BlcmZjbnQuaCB8ICAxOCAr
KwogZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X3JlZ3MuaCAgICB8ICAxOSArKwog
aW5jbHVkZS91YXBpL2RybS9wYW5mcm9zdF9kcm0uaCAgICAgICAgICAgICB8ICAyNCArKwogOSBm
aWxlcyBjaGFuZ2VkLCA0MTQgaW5zZXJ0aW9ucygrKSwgMSBkZWxldGlvbigtKQogY3JlYXRlIG1v
ZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9wZXJmY250LmMKIGNy
ZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfcGVyZmNu
dC5oCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L01ha2VmaWxlIGIvZHJp
dmVycy9ncHUvZHJtL3BhbmZyb3N0L01ha2VmaWxlCmluZGV4IDZkZTcyZDEzYzU4Zi4uZWNmMDg2
NGNiNTE1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvTWFrZWZpbGUKKysr
IGIvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L01ha2VmaWxlCkBAIC03LDYgKzcsNyBAQCBwYW5m
cm9zdC15IDo9IFwKIAlwYW5mcm9zdF9nZW0ubyBcCiAJcGFuZnJvc3RfZ3B1Lm8gXAogCXBhbmZy
b3N0X2pvYi5vIFwKLQlwYW5mcm9zdF9tbXUubworCXBhbmZyb3N0X21tdS5vIFwKKwlwYW5mcm9z
dF9wZXJmY250Lm8KIAogb2JqLSQoQ09ORklHX0RSTV9QQU5GUk9TVCkgKz0gcGFuZnJvc3Qubwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2RldmljZS5jIGIv
ZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2RldmljZS5jCmluZGV4IGNjYjhlYjJh
NTE4Yy4uOGExMTFkN2MwMjAwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3Qv
cGFuZnJvc3RfZGV2aWNlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0
X2RldmljZS5jCkBAIC0xNCw2ICsxNCw3IEBACiAjaW5jbHVkZSAicGFuZnJvc3RfZ3B1LmgiCiAj
aW5jbHVkZSAicGFuZnJvc3Rfam9iLmgiCiAjaW5jbHVkZSAicGFuZnJvc3RfbW11LmgiCisjaW5j
bHVkZSAicGFuZnJvc3RfcGVyZmNudC5oIgogCiBzdGF0aWMgaW50IHBhbmZyb3N0X3Jlc2V0X2lu
aXQoc3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYpCiB7CkBAIC0xNzEsNyArMTcyLDEzIEBA
IGludCBwYW5mcm9zdF9kZXZpY2VfaW5pdChzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldikK
IAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KHBmZGV2LT5kZXYpOwogCXBtX3J1bnRpbWVfcHV0
X2F1dG9zdXNwZW5kKHBmZGV2LT5kZXYpOwogCisJZXJyID0gcGFuZnJvc3RfcGVyZmNudF9pbml0
KHBmZGV2KTsKKwlpZiAoZXJyKQorCQlnb3RvIGVycl9vdXQ1OworCiAJcmV0dXJuIDA7CitlcnJf
b3V0NToKKwlwYW5mcm9zdF9qb2JfZmluaShwZmRldik7CiBlcnJfb3V0NDoKIAlwYW5mcm9zdF9t
bXVfZmluaShwZmRldik7CiBlcnJfb3V0MzoKQEAgLTE4Nyw2ICsxOTQsNyBAQCBpbnQgcGFuZnJv
c3RfZGV2aWNlX2luaXQoc3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYpCiAKIHZvaWQgcGFu
ZnJvc3RfZGV2aWNlX2Zpbmkoc3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYpCiB7CisJcGFu
ZnJvc3RfcGVyZmNudF9maW5pKHBmZGV2KTsKIAlwYW5mcm9zdF9qb2JfZmluaShwZmRldik7CiAJ
cGFuZnJvc3RfbW11X2ZpbmkocGZkZXYpOwogCXBhbmZyb3N0X2dwdV9maW5pKHBmZGV2KTsKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9kZXZpY2UuaCBiL2Ry
aXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9kZXZpY2UuaAppbmRleCBlODY1ODFjNGFm
N2IuLjgzY2MwMWNhZmRlMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3Bh
bmZyb3N0X2RldmljZS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9k
ZXZpY2UuaApAQCAtMTQsNiArMTQsNyBAQCBzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlOwogc3RydWN0
IHBhbmZyb3N0X21tdTsKIHN0cnVjdCBwYW5mcm9zdF9qb2Jfc2xvdDsKIHN0cnVjdCBwYW5mcm9z
dF9qb2I7CitzdHJ1Y3QgcGFuZnJvc3RfcGVyZmNudDsKIAogI2RlZmluZSBOVU1fSk9CX1NMT1RT
IDMKIApAQCAtNzgsNiArNzksOCBAQCBzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlIHsKIAlzdHJ1Y3Qg
cGFuZnJvc3Rfam9iICpqb2JzW05VTV9KT0JfU0xPVFNdOwogCXN0cnVjdCBsaXN0X2hlYWQgc2No
ZWR1bGVkX2pvYnM7CiAKKwlzdHJ1Y3QgcGFuZnJvc3RfcGVyZmNudCAqcGVyZmNudDsKKwogCXN0
cnVjdCBtdXRleCBzY2hlZF9sb2NrOwogCXN0cnVjdCBtdXRleCByZXNldF9sb2NrOwogCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZHJ2LmMgYi9kcml2ZXJz
L2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZHJ2LmMKaW5kZXggNzU0ODgxZWNlOGQ3Li5lMzRl
ODZhNzM3OGEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9k
cnYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZHJ2LmMKQEAgLTE5
LDYgKzE5LDcgQEAKICNpbmNsdWRlICJwYW5mcm9zdF9tbXUuaCIKICNpbmNsdWRlICJwYW5mcm9z
dF9qb2IuaCIKICNpbmNsdWRlICJwYW5mcm9zdF9ncHUuaCIKKyNpbmNsdWRlICJwYW5mcm9zdF9w
ZXJmY250LmgiCiAKIHN0YXRpYyBib29sIHVuc3RhYmxlX2lvY3RsczsKIG1vZHVsZV9wYXJhbV91
bnNhZmUodW5zdGFibGVfaW9jdGxzLCBib29sLCAwNjAwKTsKQEAgLTMyOSw2ICszMzAsNyBAQCBw
YW5mcm9zdF9wb3N0Y2xvc2Uoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgc3RydWN0IGRybV9maWxl
ICpmaWxlKQogewogCXN0cnVjdCBwYW5mcm9zdF9maWxlX3ByaXYgKnBhbmZyb3N0X3ByaXYgPSBm
aWxlLT5kcml2ZXJfcHJpdjsKIAorCXBhbmZyb3N0X3BlcmZjbnRfY2xvc2UocGFuZnJvc3RfcHJp
dik7CiAJcGFuZnJvc3Rfam9iX2Nsb3NlKHBhbmZyb3N0X3ByaXYpOwogCiAJa2ZyZWUocGFuZnJv
c3RfcHJpdik7CkBAIC0zNDgsNiArMzUwLDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1faW9j
dGxfZGVzYyBwYW5mcm9zdF9kcm1fZHJpdmVyX2lvY3Rsc1tdID0gewogCVBBTkZST1NUX0lPQ1RM
KE1NQVBfQk8sCQltbWFwX2JvLAlEUk1fUkVOREVSX0FMTE9XKSwKIAlQQU5GUk9TVF9JT0NUTChH
RVRfUEFSQU0sCWdldF9wYXJhbSwJRFJNX1JFTkRFUl9BTExPVyksCiAJUEFORlJPU1RfSU9DVEwo
R0VUX0JPX09GRlNFVCwJZ2V0X2JvX29mZnNldCwJRFJNX1JFTkRFUl9BTExPVyksCisJUEFORlJP
U1RfSU9DVEwoUEVSRkNOVF9FTkFCTEUsCXBlcmZjbnRfZW5hYmxlLAlEUk1fUkVOREVSX0FMTE9X
KSwKKwlQQU5GUk9TVF9JT0NUTChQRVJGQ05UX0RVTVAsCXBlcmZjbnRfZHVtcCwJRFJNX1JFTkRF
Ul9BTExPVyksCiB9OwogCiBERUZJTkVfRFJNX0dFTV9TSE1FTV9GT1BTKHBhbmZyb3N0X2RybV9k
cml2ZXJfZm9wcyk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJv
c3RfZ3B1LmMgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZ3B1LmMKaW5kZXgg
NmU2OGExMDAyOTFjLi4yMGFiMzMzZmM5MjUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9w
YW5mcm9zdC9wYW5mcm9zdF9ncHUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFu
ZnJvc3RfZ3B1LmMKQEAgLTE1LDYgKzE1LDcgQEAKICNpbmNsdWRlICJwYW5mcm9zdF9mZWF0dXJl
cy5oIgogI2luY2x1ZGUgInBhbmZyb3N0X2lzc3Vlcy5oIgogI2luY2x1ZGUgInBhbmZyb3N0X2dw
dS5oIgorI2luY2x1ZGUgInBhbmZyb3N0X3BlcmZjbnQuaCIKICNpbmNsdWRlICJwYW5mcm9zdF9y
ZWdzLmgiCiAKIHN0YXRpYyBpcnFyZXR1cm5fdCBwYW5mcm9zdF9ncHVfaXJxX2hhbmRsZXIoaW50
IGlycSwgdm9pZCAqZGF0YSkKQEAgLTQwLDYgKzQxLDEyIEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBw
YW5mcm9zdF9ncHVfaXJxX2hhbmRsZXIoaW50IGlycSwgdm9pZCAqZGF0YSkKIAkJZ3B1X3dyaXRl
KHBmZGV2LCBHUFVfSU5UX01BU0ssIDApOwogCX0KIAorCWlmIChzdGF0ZSAmIEdQVV9JUlFfUEVS
RkNOVF9TQU1QTEVfQ09NUExFVEVEKQorCQlwYW5mcm9zdF9wZXJmY250X3NhbXBsZV9kb25lKHBm
ZGV2KTsKKworCWlmIChzdGF0ZSAmIEdQVV9JUlFfQ0xFQU5fQ0FDSEVTX0NPTVBMRVRFRCkKKwkJ
cGFuZnJvc3RfcGVyZmNudF9jbGVhbl9jYWNoZV9kb25lKHBmZGV2KTsKKwogCWdwdV93cml0ZShw
ZmRldiwgR1BVX0lOVF9DTEVBUiwgc3RhdGUpOwogCiAJcmV0dXJuIElSUV9IQU5ETEVEOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X3BlcmZjbnQuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9wZXJmY250LmMKbmV3IGZpbGUgbW9kZSAx
MDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi44M2M1N2QzMjVjYTgKLS0tIC9kZXYvbnVsbAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfcGVyZmNudC5jCkBAIC0wLDAgKzEs
MzI5IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAorLyogQ29weXJpZ2h0
IDIwMTkgQ29sbGFib3JhIEx0ZCAqLworCisjaW5jbHVkZSA8ZHJtL2RybV9maWxlLmg+CisjaW5j
bHVkZSA8ZHJtL2RybV9nZW1fc2htZW1faGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL3BhbmZyb3N0
X2RybS5oPgorI2luY2x1ZGUgPGxpbnV4L2NvbXBsZXRpb24uaD4KKyNpbmNsdWRlIDxsaW51eC9p
b3BvbGwuaD4KKyNpbmNsdWRlIDxsaW51eC9wbV9ydW50aW1lLmg+CisjaW5jbHVkZSA8bGludXgv
c2xhYi5oPgorI2luY2x1ZGUgPGxpbnV4L3VhY2Nlc3MuaD4KKworI2luY2x1ZGUgInBhbmZyb3N0
X2RldmljZS5oIgorI2luY2x1ZGUgInBhbmZyb3N0X2ZlYXR1cmVzLmgiCisjaW5jbHVkZSAicGFu
ZnJvc3RfZ2VtLmgiCisjaW5jbHVkZSAicGFuZnJvc3RfaXNzdWVzLmgiCisjaW5jbHVkZSAicGFu
ZnJvc3Rfam9iLmgiCisjaW5jbHVkZSAicGFuZnJvc3RfbW11LmgiCisjaW5jbHVkZSAicGFuZnJv
c3RfcmVncy5oIgorCisjZGVmaW5lIENPVU5URVJTX1BFUl9CTE9DSwkJNjQKKyNkZWZpbmUgQllU
RVNfUEVSX0NPVU5URVIJCTQKKyNkZWZpbmUgQkxPQ0tTX1BFUl9DT1JFR1JPVVAJCTgKKyNkZWZp
bmUgVjRfU0hBREVSU19QRVJfQ09SRUdST1VQCTQKKworc3RydWN0IHBhbmZyb3N0X3BlcmZjbnQg
eworCXN0cnVjdCBwYW5mcm9zdF9nZW1fb2JqZWN0ICpibzsKKwlzaXplX3QgYm9zaXplOworCXZv
aWQgKmJ1ZjsKKwlzdHJ1Y3QgcGFuZnJvc3RfZmlsZV9wcml2ICp1c2VyOworCXN0cnVjdCBtdXRl
eCBsb2NrOworCXN0cnVjdCBjb21wbGV0aW9uIGR1bXBfY29tcDsKK307CisKK3ZvaWQgcGFuZnJv
c3RfcGVyZmNudF9jbGVhbl9jYWNoZV9kb25lKHN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2
KQoreworCWNvbXBsZXRlKCZwZmRldi0+cGVyZmNudC0+ZHVtcF9jb21wKTsKK30KKwordm9pZCBw
YW5mcm9zdF9wZXJmY250X3NhbXBsZV9kb25lKHN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2
KQoreworCWdwdV93cml0ZShwZmRldiwgR1BVX0NNRCwgR1BVX0NNRF9DTEVBTl9DQUNIRVMpOwor
fQorCitzdGF0aWMgaW50IHBhbmZyb3N0X3BlcmZjbnRfZHVtcF9sb2NrZWQoc3RydWN0IHBhbmZy
b3N0X2RldmljZSAqcGZkZXYpCit7CisJdTY0IGdwdXZhOworCWludCByZXQ7CisKKwlyZWluaXRf
Y29tcGxldGlvbigmcGZkZXYtPnBlcmZjbnQtPmR1bXBfY29tcCk7CisJZ3B1dmEgPSBwZmRldi0+
cGVyZmNudC0+Ym8tPm5vZGUuc3RhcnQgPDwgUEFHRV9TSElGVDsKKwlncHVfd3JpdGUocGZkZXYs
IEdQVV9QRVJGQ05UX0JBU0VfTE8sIGdwdXZhKTsKKwlncHVfd3JpdGUocGZkZXYsIEdQVV9QRVJG
Q05UX0JBU0VfSEksIGdwdXZhID4+IDMyKTsKKwlncHVfd3JpdGUocGZkZXYsIEdQVV9JTlRfQ0xF
QVIsCisJCSAgR1BVX0lSUV9DTEVBTl9DQUNIRVNfQ09NUExFVEVEIHwKKwkJICBHUFVfSVJRX1BF
UkZDTlRfU0FNUExFX0NPTVBMRVRFRCk7CisJZ3B1X3dyaXRlKHBmZGV2LCBHUFVfQ01ELCBHUFVf
Q01EX1BFUkZDTlRfU0FNUExFKTsKKwlyZXQgPSB3YWl0X2Zvcl9jb21wbGV0aW9uX2ludGVycnVw
dGlibGVfdGltZW91dCgmcGZkZXYtPnBlcmZjbnQtPmR1bXBfY29tcCwKKwkJCQkJCQltc2Vjc190
b19qaWZmaWVzKDEwMDApKTsKKwlpZiAoIXJldCkKKwkJcmV0ID0gLUVUSU1FRE9VVDsKKwllbHNl
IGlmIChyZXQgPiAwKQorCQlyZXQgPSAwOworCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGlu
dCBwYW5mcm9zdF9wZXJmY250X2VuYWJsZV9sb2NrZWQoc3RydWN0IHBhbmZyb3N0X2RldmljZSAq
cGZkZXYsCisJCQkJCSAgc3RydWN0IHBhbmZyb3N0X2ZpbGVfcHJpdiAqdXNlciwKKwkJCQkJICB1
bnNpZ25lZCBpbnQgY291bnRlcnNldCkKK3sKKwlzdHJ1Y3QgcGFuZnJvc3RfcGVyZmNudCAqcGVy
ZmNudCA9IHBmZGV2LT5wZXJmY250OworCXN0cnVjdCBkcm1fZ2VtX3NobWVtX29iamVjdCAqYm87
CisJdTMyIGNmZzsKKwlpbnQgcmV0OworCisJaWYgKHVzZXIgPT0gcGVyZmNudC0+dXNlcikKKwkJ
cmV0dXJuIDA7CisJZWxzZSBpZiAocGVyZmNudC0+dXNlcikKKwkJcmV0dXJuIC1FQlVTWTsKKwor
CXJldCA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMocGZkZXYtPmRldik7CisJaWYgKHJldCA8IDApCisJ
CXJldHVybiByZXQ7CisKKwlibyA9IGRybV9nZW1fc2htZW1fY3JlYXRlKHBmZGV2LT5kZGV2LCBw
ZXJmY250LT5ib3NpemUpOworCWlmIChJU19FUlIoYm8pKQorCQlyZXR1cm4gUFRSX0VSUihibyk7
CisKKwlwZXJmY250LT5ibyA9IHRvX3BhbmZyb3N0X2JvKCZiby0+YmFzZSk7CisKKwkvKiBNYXAg
dGhlIHBlcmZjbnQgYnVmIGluIHRoZSBhZGRyZXNzIHNwYWNlIGF0dGFjaGVkIHRvIGZpbGVfcHJp
di4gKi8KKwlyZXQgPSBwYW5mcm9zdF9tbXVfbWFwKHBlcmZjbnQtPmJvKTsKKwlpZiAocmV0KQor
CQlnb3RvIGVycl9wdXRfYm87CisKKwlwZXJmY250LT5idWYgPSBkcm1fZ2VtX3NobWVtX3ZtYXAo
JmJvLT5iYXNlKTsKKwlpZiAoSVNfRVJSKHBlcmZjbnQtPmJ1ZikpIHsKKwkJcmV0ID0gUFRSX0VS
UihwZXJmY250LT5idWYpOworCQlnb3RvIGVycl9wdXRfYm87CisJfQorCisJLyoKKwkgKiBJbnZh
bGlkYXRlIHRoZSBjYWNoZSBhbmQgY2xlYXIgdGhlIGNvdW50ZXJzIHRvIHN0YXJ0IGZyb20gYSBm
cmVzaAorCSAqIHN0YXRlLgorCSAqLworCXJlaW5pdF9jb21wbGV0aW9uKCZwZmRldi0+cGVyZmNu
dC0+ZHVtcF9jb21wKTsKKwlncHVfd3JpdGUocGZkZXYsIEdQVV9JTlRfQ0xFQVIsCisJCSAgR1BV
X0lSUV9DTEVBTl9DQUNIRVNfQ09NUExFVEVEIHwKKwkJICBHUFVfSVJRX1BFUkZDTlRfU0FNUExF
X0NPTVBMRVRFRCk7CisJZ3B1X3dyaXRlKHBmZGV2LCBHUFVfQ01ELCBHUFVfQ01EX1BFUkZDTlRf
Q0xFQVIpOworCWdwdV93cml0ZShwZmRldiwgR1BVX0NNRCwgR1BVX0NNRF9DTEVBTl9JTlZfQ0FD
SEVTKTsKKwlyZXQgPSB3YWl0X2Zvcl9jb21wbGV0aW9uX3RpbWVvdXQoJnBmZGV2LT5wZXJmY250
LT5kdW1wX2NvbXAsCisJCQkJCSAgbXNlY3NfdG9famlmZmllcygxMDAwKSk7CisJaWYgKCFyZXQp
IHsKKwkJcmV0ID0gLUVUSU1FRE9VVDsKKwkJZ290byBlcnJfdnVubWFwOworCX0KKworCXBlcmZj
bnQtPnVzZXIgPSB1c2VyOworCisJLyoKKwkgKiBBbHdheXMgdXNlIGFkZHJlc3Mgc3BhY2UgMCBm
b3Igbm93LgorCSAqIEZJWE1FOiB0aGlzIG5lZWRzIHRvIGJlIHVwZGF0ZWQgd2hlbiB3ZSBzdGFy
dCB1c2luZyBkaWZmZXJlbnQKKwkgKiBhZGRyZXNzIHNwYWNlLgorCSAqLworCWNmZyA9IEdQVV9Q
RVJGQ05UX0NGR19BUygwKSB8CisJICAgICAgR1BVX1BFUkZDTlRfQ0ZHX01PREUoR1BVX1BFUkZD
TlRfQ0ZHX01PREVfTUFOVUFMKTsKKworCS8qCisJICogQmlmcm9zdCBHUFVzIGhhdmUgMiBzZXQg
b2YgY291bnRlcnMsIGJ1dCB3ZSdyZSBvbmx5IGludGVyZXN0ZWQgYnkKKwkgKiB0aGUgZmlyc3Qg
b25lIGZvciBub3cuCisJICovCisJaWYgKHBhbmZyb3N0X21vZGVsX2lzX2JpZnJvc3QocGZkZXYp
KQorCQljZmcgfD0gR1BVX1BFUkZDTlRfQ0ZHX1NFVFNFTChjb3VudGVyc2V0KTsKKworCWdwdV93
cml0ZShwZmRldiwgR1BVX1BSRkNOVF9KTV9FTiwgMHhmZmZmZmZmZik7CisJZ3B1X3dyaXRlKHBm
ZGV2LCBHUFVfUFJGQ05UX1NIQURFUl9FTiwgMHhmZmZmZmZmZik7CisJZ3B1X3dyaXRlKHBmZGV2
LCBHUFVfUFJGQ05UX01NVV9MMl9FTiwgMHhmZmZmZmZmZik7CisKKwkvKgorCSAqIER1ZSB0byBQ
UkxBTS04MTg2IHdlIG5lZWQgdG8gZGlzYWJsZSB0aGUgVGlsZXIgYmVmb3JlIHdlIGVuYWJsZSBI
VworCSAqIGNvdW50ZXJzLgorCSAqLworCWlmIChwYW5mcm9zdF9oYXNfaHdfaXNzdWUocGZkZXYs
IEhXX0lTU1VFXzgxODYpKQorCQlncHVfd3JpdGUocGZkZXYsIEdQVV9QUkZDTlRfVElMRVJfRU4s
IDApOworCWVsc2UKKwkJZ3B1X3dyaXRlKHBmZGV2LCBHUFVfUFJGQ05UX1RJTEVSX0VOLCAweGZm
ZmZmZmZmKTsKKworCWdwdV93cml0ZShwZmRldiwgR1BVX1BFUkZDTlRfQ0ZHLCBjZmcpOworCisJ
aWYgKHBhbmZyb3N0X2hhc19od19pc3N1ZShwZmRldiwgSFdfSVNTVUVfODE4NikpCisJCWdwdV93
cml0ZShwZmRldiwgR1BVX1BSRkNOVF9USUxFUl9FTiwgMHhmZmZmZmZmZik7CisKKwlyZXR1cm4g
MDsKKworZXJyX3Z1bm1hcDoKKwlkcm1fZ2VtX3NobWVtX3Z1bm1hcCgmcGVyZmNudC0+Ym8tPmJh
c2UuYmFzZSwgcGVyZmNudC0+YnVmKTsKK2Vycl9wdXRfYm86CisJZHJtX2dlbV9vYmplY3RfcHV0
X3VubG9ja2VkKCZiby0+YmFzZSk7CisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBwYW5m
cm9zdF9wZXJmY250X2Rpc2FibGVfbG9ja2VkKHN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2
LAorCQkJCQkgICBzdHJ1Y3QgcGFuZnJvc3RfZmlsZV9wcml2ICp1c2VyKQoreworCXN0cnVjdCBw
YW5mcm9zdF9wZXJmY250ICpwZXJmY250ID0gcGZkZXYtPnBlcmZjbnQ7CisKKwlpZiAodXNlciAh
PSBwZXJmY250LT51c2VyKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCWdwdV93cml0ZShwZmRldiwg
R1BVX1BSRkNOVF9KTV9FTiwgMHgwKTsKKwlncHVfd3JpdGUocGZkZXYsIEdQVV9QUkZDTlRfU0hB
REVSX0VOLCAweDApOworCWdwdV93cml0ZShwZmRldiwgR1BVX1BSRkNOVF9NTVVfTDJfRU4sIDB4
MCk7CisJZ3B1X3dyaXRlKHBmZGV2LCBHUFVfUFJGQ05UX1RJTEVSX0VOLCAwKTsKKwlncHVfd3Jp
dGUocGZkZXYsIEdQVV9QRVJGQ05UX0NGRywKKwkJICBHUFVfUEVSRkNOVF9DRkdfTU9ERShHUFVf
UEVSRkNOVF9DRkdfTU9ERV9PRkYpKTsKKworCXBlcmZjbnQtPnVzZXIgPSBOVUxMOworCWRybV9n
ZW1fc2htZW1fdnVubWFwKCZwZXJmY250LT5iby0+YmFzZS5iYXNlLCBwZXJmY250LT5idWYpOwor
CXBlcmZjbnQtPmJ1ZiA9IE5VTEw7CisJZHJtX2dlbV9vYmplY3RfcHV0X3VubG9ja2VkKCZwZXJm
Y250LT5iby0+YmFzZS5iYXNlKTsKKwlwZXJmY250LT5ibyA9IE5VTEw7CisJcG1fcnVudGltZV9t
YXJrX2xhc3RfYnVzeShwZmRldi0+ZGV2KTsKKwlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChw
ZmRldi0+ZGV2KTsKKworCXJldHVybiAwOworfQorCitpbnQgcGFuZnJvc3RfaW9jdGxfcGVyZmNu
dF9lbmFibGUoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKKwkJCQkgIHN0cnVj
dCBkcm1fZmlsZSAqZmlsZV9wcml2KQoreworCXN0cnVjdCBwYW5mcm9zdF9maWxlX3ByaXYgKnBm
aWxlID0gZmlsZV9wcml2LT5kcml2ZXJfcHJpdjsKKwlzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpw
ZmRldiA9IGRldi0+ZGV2X3ByaXZhdGU7CisJc3RydWN0IHBhbmZyb3N0X3BlcmZjbnQgKnBlcmZj
bnQgPSBwZmRldi0+cGVyZmNudDsKKwlzdHJ1Y3QgZHJtX3BhbmZyb3N0X3BlcmZjbnRfZW5hYmxl
ICpyZXEgPSBkYXRhOworCWludCByZXQ7CisKKwlyZXQgPSBwYW5mcm9zdF91bnN0YWJsZV9pb2N0
bF9jaGVjaygpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwkvKiBPbmx5IEJpZnJvc3Qg
R1BVcyBoYXZlIDIgc2V0IG9mIGNvdW50ZXJzLiAqLworCWlmIChyZXEtPmNvdW50ZXJzZXQgPiAo
cGFuZnJvc3RfbW9kZWxfaXNfYmlmcm9zdChwZmRldikgPyAxIDogMCkpCisJCXJldHVybiAtRUlO
VkFMOworCisJbXV0ZXhfbG9jaygmcGVyZmNudC0+bG9jayk7CisJaWYgKHJlcS0+ZW5hYmxlKQor
CQlyZXQgPSBwYW5mcm9zdF9wZXJmY250X2VuYWJsZV9sb2NrZWQocGZkZXYsIHBmaWxlLAorCQkJ
CQkJICAgICByZXEtPmNvdW50ZXJzZXQpOworCWVsc2UKKwkJcmV0ID0gcGFuZnJvc3RfcGVyZmNu
dF9kaXNhYmxlX2xvY2tlZChwZmRldiwgcGZpbGUpOworCW11dGV4X3VubG9jaygmcGVyZmNudC0+
bG9jayk7CisKKwlyZXR1cm4gcmV0OworfQorCitpbnQgcGFuZnJvc3RfaW9jdGxfcGVyZmNudF9k
dW1wKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCisJCQkJc3RydWN0IGRybV9m
aWxlICpmaWxlX3ByaXYpCit7CisJc3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYgPSBkZXYt
PmRldl9wcml2YXRlOworCXN0cnVjdCBwYW5mcm9zdF9wZXJmY250ICpwZXJmY250ID0gcGZkZXYt
PnBlcmZjbnQ7CisJc3RydWN0IGRybV9wYW5mcm9zdF9wZXJmY250X2R1bXAgKnJlcSA9IGRhdGE7
CisJdm9pZCBfX3VzZXIgKnVzZXJfcHRyID0gKHZvaWQgX191c2VyICopKHVpbnRwdHJfdClyZXEt
PmJ1Zl9wdHI7CisJaW50IHJldDsKKworCXJldCA9IHBhbmZyb3N0X3Vuc3RhYmxlX2lvY3RsX2No
ZWNrKCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCW11dGV4X2xvY2soJnBlcmZjbnQt
PmxvY2spOworCWlmIChwZXJmY250LT51c2VyICE9IGZpbGVfcHJpdi0+ZHJpdmVyX3ByaXYpIHsK
KwkJcmV0ID0gLUVJTlZBTDsKKwkJZ290byBvdXQ7CisJfQorCisJcmV0ID0gcGFuZnJvc3RfcGVy
ZmNudF9kdW1wX2xvY2tlZChwZmRldik7CisJaWYgKHJldCkKKwkJZ290byBvdXQ7CisKKwlpZiAo
Y29weV90b191c2VyKHVzZXJfcHRyLCBwZXJmY250LT5idWYsIHBlcmZjbnQtPmJvc2l6ZSkpCisJ
CXJldCA9IC1FRkFVTFQ7CisKK291dDoKKwltdXRleF91bmxvY2soJnBlcmZjbnQtPmxvY2spOwor
CisJcmV0dXJuIHJldDsKK30KKwordm9pZCBwYW5mcm9zdF9wZXJmY250X2Nsb3NlKHN0cnVjdCBw
YW5mcm9zdF9maWxlX3ByaXYgKnBmaWxlKQoreworCXN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBm
ZGV2ID0gcGZpbGUtPnBmZGV2OworCXN0cnVjdCBwYW5mcm9zdF9wZXJmY250ICpwZXJmY250ID0g
cGZkZXYtPnBlcmZjbnQ7CisKKwlwbV9ydW50aW1lX2dldF9zeW5jKHBmZGV2LT5kZXYpOworCW11
dGV4X2xvY2soJnBlcmZjbnQtPmxvY2spOworCWlmIChwZXJmY250LT51c2VyID09IHBmaWxlKQor
CQlwYW5mcm9zdF9wZXJmY250X2Rpc2FibGVfbG9ja2VkKHBmZGV2LCBwZmlsZSk7CisJbXV0ZXhf
dW5sb2NrKCZwZXJmY250LT5sb2NrKTsKKwlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KHBmZGV2
LT5kZXYpOworCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKHBmZGV2LT5kZXYpOworfQorCitp
bnQgcGFuZnJvc3RfcGVyZmNudF9pbml0KHN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2KQor
eworCXN0cnVjdCBwYW5mcm9zdF9wZXJmY250ICpwZXJmY250OworCXNpemVfdCBzaXplOworCisJ
aWYgKHBhbmZyb3N0X2hhc19od19mZWF0dXJlKHBmZGV2LCBIV19GRUFUVVJFX1Y0KSkgeworCQl1
bnNpZ25lZCBpbnQgbmNvcmVncm91cHM7CisKKwkJbmNvcmVncm91cHMgPSBod2VpZ2h0NjQocGZk
ZXYtPmZlYXR1cmVzLmwyX3ByZXNlbnQpOworCQlzaXplID0gbmNvcmVncm91cHMgKiBCTE9DS1Nf
UEVSX0NPUkVHUk9VUCAqCisJCSAgICAgICBDT1VOVEVSU19QRVJfQkxPQ0sgKiBCWVRFU19QRVJf
Q09VTlRFUjsKKwl9IGVsc2UgeworCQl1bnNpZ25lZCBpbnQgbmwyYywgbmNvcmVzOworCisJCS8q
CisJCSAqIFRPRE86IGRlZmluZSBhIG1hY3JvIHRvIGV4dHJhY3QgdGhlIG51bWJlciBvZiBsMiBj
YWNoZXMgZnJvbQorCQkgKiBtZW1fZmVhdHVyZXMuCisJCSAqLworCQlubDJjID0gKChwZmRldi0+
ZmVhdHVyZXMubWVtX2ZlYXR1cmVzID4+IDgpICYgR0VOTUFTSygzLCAwKSkgKyAxOworCisJCS8q
CisJCSAqIHNoYWRlcl9wcmVzZW50IG1pZ2h0IGJlIHNwYXJzZSwgYnV0IHRoZSBjb3VudGVycyBs
YXlvdXQKKwkJICogZm9yY2VzIHRvIGR1bXAgdW51c2VkIHJlZ2lvbnMgdG9vLCBoZW5jZSB0aGUg
ZmxzNjQoKSBjYWxsCisJCSAqIGluc3RlYWQgb2YgaHdlaWdodDY0KCkuCisJCSAqLworCQluY29y
ZXMgPSBmbHM2NChwZmRldi0+ZmVhdHVyZXMuc2hhZGVyX3ByZXNlbnQpOworCisJCS8qCisJCSAq
IFRoZXJlJ3MgYWx3YXlzIG9uZSBKTSBhbmQgb25lIFRpbGVyIGJsb2NrLCBoZW5jZSB0aGUgJysg
MicKKwkJICogaGVyZS4KKwkJICovCisJCXNpemUgPSAobmwyYyArIG5jb3JlcyArIDIpICoKKwkJ
ICAgICAgIENPVU5URVJTX1BFUl9CTE9DSyAqIEJZVEVTX1BFUl9DT1VOVEVSOworCX0KKworCXBl
cmZjbnQgPSBkZXZtX2t6YWxsb2MocGZkZXYtPmRldiwgc2l6ZW9mKCpwZXJmY250KSwgR0ZQX0tF
Uk5FTCk7CisJaWYgKCFwZXJmY250KQorCQlyZXR1cm4gLUVOT01FTTsKKworCXBlcmZjbnQtPmJv
c2l6ZSA9IHNpemU7CisKKwkvKiBTdGFydCB3aXRoIGV2ZXJ5dGhpbmcgZGlzYWJsZWQuICovCisJ
Z3B1X3dyaXRlKHBmZGV2LCBHUFVfUEVSRkNOVF9DRkcsCisJCSAgR1BVX1BFUkZDTlRfQ0ZHX01P
REUoR1BVX1BFUkZDTlRfQ0ZHX01PREVfT0ZGKSk7CisJZ3B1X3dyaXRlKHBmZGV2LCBHUFVfUFJG
Q05UX0pNX0VOLCAwKTsKKwlncHVfd3JpdGUocGZkZXYsIEdQVV9QUkZDTlRfU0hBREVSX0VOLCAw
KTsKKwlncHVfd3JpdGUocGZkZXYsIEdQVV9QUkZDTlRfTU1VX0wyX0VOLCAwKTsKKwlncHVfd3Jp
dGUocGZkZXYsIEdQVV9QUkZDTlRfVElMRVJfRU4sIDApOworCisJaW5pdF9jb21wbGV0aW9uKCZw
ZXJmY250LT5kdW1wX2NvbXApOworCW11dGV4X2luaXQoJnBlcmZjbnQtPmxvY2spOworCXBmZGV2
LT5wZXJmY250ID0gcGVyZmNudDsKKworCXJldHVybiAwOworfQorCit2b2lkIHBhbmZyb3N0X3Bl
cmZjbnRfZmluaShzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldikKK3sKKwkvKiBEaXNhYmxl
IGV2ZXJ5dGhpbmcgYmVmb3JlIGxlYXZpbmcuICovCisJZ3B1X3dyaXRlKHBmZGV2LCBHUFVfUEVS
RkNOVF9DRkcsCisJCSAgR1BVX1BFUkZDTlRfQ0ZHX01PREUoR1BVX1BFUkZDTlRfQ0ZHX01PREVf
T0ZGKSk7CisJZ3B1X3dyaXRlKHBmZGV2LCBHUFVfUFJGQ05UX0pNX0VOLCAwKTsKKwlncHVfd3Jp
dGUocGZkZXYsIEdQVV9QUkZDTlRfU0hBREVSX0VOLCAwKTsKKwlncHVfd3JpdGUocGZkZXYsIEdQ
VV9QUkZDTlRfTU1VX0wyX0VOLCAwKTsKKwlncHVfd3JpdGUocGZkZXYsIEdQVV9QUkZDTlRfVElM
RVJfRU4sIDApOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZy
b3N0X3BlcmZjbnQuaCBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9wZXJmY250
LmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4xM2I4ZmRhYTFiNDMK
LS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfcGVy
ZmNudC5oCkBAIC0wLDAgKzEsMTggQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwt
Mi4wICovCisvKiBDb3B5cmlnaHQgMjAxOSBDb2xsYWJvcmEgTHRkICovCisjaWZuZGVmIF9fUEFO
RlJPU1RfUEVSRkNOVF9IX18KKyNkZWZpbmUgX19QQU5GUk9TVF9QRVJGQ05UX0hfXworCisjaW5j
bHVkZSAicGFuZnJvc3RfZGV2aWNlLmgiCisKK3ZvaWQgcGFuZnJvc3RfcGVyZmNudF9zYW1wbGVf
ZG9uZShzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldik7Cit2b2lkIHBhbmZyb3N0X3BlcmZj
bnRfY2xlYW5fY2FjaGVfZG9uZShzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldik7CitpbnQg
cGFuZnJvc3RfcGVyZmNudF9pbml0KHN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2KTsKK3Zv
aWQgcGFuZnJvc3RfcGVyZmNudF9maW5pKHN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2KTsK
K3ZvaWQgcGFuZnJvc3RfcGVyZmNudF9jbG9zZShzdHJ1Y3QgcGFuZnJvc3RfZmlsZV9wcml2ICpw
ZmlsZSk7CitpbnQgcGFuZnJvc3RfaW9jdGxfcGVyZmNudF9lbmFibGUoc3RydWN0IGRybV9kZXZp
Y2UgKmRldiwgdm9pZCAqZGF0YSwKKwkJCQkgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wcml2KTsK
K2ludCBwYW5mcm9zdF9pb2N0bF9wZXJmY250X2R1bXAoc3RydWN0IGRybV9kZXZpY2UgKmRldiwg
dm9pZCAqZGF0YSwKKwkJCQlzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdik7CisKKyNlbmRpZgpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X3JlZ3MuaCBiL2Ry
aXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9yZWdzLmgKaW5kZXggNDJkMDg4NjBmZDc2
Li5lYTM4YWM2MDU4MWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5m
cm9zdF9yZWdzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X3JlZ3Mu
aApAQCAtNDQsMTIgKzQ0LDMxIEBACiAJIEdQVV9JUlFfTVVMVElQTEVfRkFVTFQpCiAjZGVmaW5l
IEdQVV9DTUQJCQkJMHgzMAogI2RlZmluZSAgIEdQVV9DTURfU09GVF9SRVNFVAkJMHgwMQorI2Rl
ZmluZSAgIEdQVV9DTURfUEVSRkNOVF9DTEVBUgkJMHgwMworI2RlZmluZSAgIEdQVV9DTURfUEVS
RkNOVF9TQU1QTEUJMHgwNAorI2RlZmluZSAgIEdQVV9DTURfQ0xFQU5fQ0FDSEVTCQkweDA3Cisj
ZGVmaW5lICAgR1BVX0NNRF9DTEVBTl9JTlZfQ0FDSEVTCTB4MDgKICNkZWZpbmUgR1BVX1NUQVRV
UwkJCTB4MzQKKyNkZWZpbmUgICBHUFVfU1RBVFVTX1BSRkNOVF9BQ1RJVkUJQklUKDIpCiAjZGVm
aW5lIEdQVV9MQVRFU1RfRkxVU0hfSUQJCTB4MzgKICNkZWZpbmUgR1BVX0ZBVUxUX1NUQVRVUwkJ
MHgzQwogI2RlZmluZSBHUFVfRkFVTFRfQUREUkVTU19MTwkJMHg0MAogI2RlZmluZSBHUFVfRkFV
TFRfQUREUkVTU19ISQkJMHg0NAogCisjZGVmaW5lIEdQVV9QRVJGQ05UX0JBU0VfTE8JCTB4NjAK
KyNkZWZpbmUgR1BVX1BFUkZDTlRfQkFTRV9ISQkJMHg2NAorI2RlZmluZSBHUFVfUEVSRkNOVF9D
RkcJCQkweDY4CisjZGVmaW5lICAgR1BVX1BFUkZDTlRfQ0ZHX01PREUoeCkJKHgpCisjZGVmaW5l
ICAgR1BVX1BFUkZDTlRfQ0ZHX01PREVfT0ZGCTAKKyNkZWZpbmUgICBHUFVfUEVSRkNOVF9DRkdf
TU9ERV9NQU5VQUwJMQorI2RlZmluZSAgIEdQVV9QRVJGQ05UX0NGR19NT0RFX1RJTEUJMgorI2Rl
ZmluZSAgIEdQVV9QRVJGQ05UX0NGR19BUyh4KQkJKCh4KSA8PCA0KQorI2RlZmluZSAgIEdQVV9Q
RVJGQ05UX0NGR19TRVRTRUwoeCkJKCh4KSA8PCA4KQorI2RlZmluZSBHUFVfUFJGQ05UX0pNX0VO
CQkweDZjCisjZGVmaW5lIEdQVV9QUkZDTlRfU0hBREVSX0VOCQkweDcwCisjZGVmaW5lIEdQVV9Q
UkZDTlRfVElMRVJfRU4JCTB4NzQKKyNkZWZpbmUgR1BVX1BSRkNOVF9NTVVfTDJfRU4JCTB4N2MK
KwogI2RlZmluZSBHUFVfVEhSRUFEX01BWF9USFJFQURTCQkweDBBMAkvKiAoUk8pIE1heGltdW0g
bnVtYmVyIG9mIHRocmVhZHMgcGVyIGNvcmUgKi8KICNkZWZpbmUgR1BVX1RIUkVBRF9NQVhfV09S
S0dST1VQX1NJWkUJMHgwQTQJLyogKFJPKSBNYXhpbXVtIHdvcmtncm91cCBzaXplICovCiAjZGVm
aW5lIEdQVV9USFJFQURfTUFYX0JBUlJJRVJfU0laRQkweDBBOAkvKiAoUk8pIE1heGltdW0gdGhy
ZWFkcyB3YWl0aW5nIGF0IGEgYmFycmllciAqLwpkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2Ry
bS9wYW5mcm9zdF9kcm0uaCBiL2luY2x1ZGUvdWFwaS9kcm0vcGFuZnJvc3RfZHJtLmgKaW5kZXgg
YTUyZTAyODNiOTBkLi5iNWQzNzA2Mzg4NDYgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvdWFwaS9kcm0v
cGFuZnJvc3RfZHJtLmgKKysrIGIvaW5jbHVkZS91YXBpL2RybS9wYW5mcm9zdF9kcm0uaApAQCAt
MTgsNiArMTgsOCBAQCBleHRlcm4gIkMiIHsKICNkZWZpbmUgRFJNX1BBTkZST1NUX01NQVBfQk8J
CQkweDAzCiAjZGVmaW5lIERSTV9QQU5GUk9TVF9HRVRfUEFSQU0JCQkweDA0CiAjZGVmaW5lIERS
TV9QQU5GUk9TVF9HRVRfQk9fT0ZGU0VUCQkweDA1CisjZGVmaW5lIERSTV9QQU5GUk9TVF9QRVJG
Q05UX0VOQUJMRQkJMHgwNgorI2RlZmluZSBEUk1fUEFORlJPU1RfUEVSRkNOVF9EVU1QCQkweDA3
CiAKICNkZWZpbmUgRFJNX0lPQ1RMX1BBTkZST1NUX1NVQk1JVAkJRFJNX0lPVyhEUk1fQ09NTUFO
RF9CQVNFICsgRFJNX1BBTkZST1NUX1NVQk1JVCwgc3RydWN0IGRybV9wYW5mcm9zdF9zdWJtaXQp
CiAjZGVmaW5lIERSTV9JT0NUTF9QQU5GUk9TVF9XQUlUX0JPCQlEUk1fSU9XKERSTV9DT01NQU5E
X0JBU0UgKyBEUk1fUEFORlJPU1RfV0FJVF9CTywgc3RydWN0IGRybV9wYW5mcm9zdF93YWl0X2Jv
KQpAQCAtMjYsNiArMjgsMTUgQEAgZXh0ZXJuICJDIiB7CiAjZGVmaW5lIERSTV9JT0NUTF9QQU5G
Uk9TVF9HRVRfUEFSQU0JCURSTV9JT1dSKERSTV9DT01NQU5EX0JBU0UgKyBEUk1fUEFORlJPU1Rf
R0VUX1BBUkFNLCBzdHJ1Y3QgZHJtX3BhbmZyb3N0X2dldF9wYXJhbSkKICNkZWZpbmUgRFJNX0lP
Q1RMX1BBTkZST1NUX0dFVF9CT19PRkZTRVQJRFJNX0lPV1IoRFJNX0NPTU1BTkRfQkFTRSArIERS
TV9QQU5GUk9TVF9HRVRfQk9fT0ZGU0VULCBzdHJ1Y3QgZHJtX3BhbmZyb3N0X2dldF9ib19vZmZz
ZXQpCiAKKy8qCisgKiBVbnN0YWJsZSBpb2N0bChzKTogb25seSBleHBvc2VkIHdoZW4gdGhlIHVu
c2FmZSB1bnN0YWJsZV9pb2N0bHMgbW9kdWxlCisgKiBwYXJhbSBpcyBzZXQgdG8gdHJ1ZS4KKyAq
IEFsbCB0aGVzZSBpb2N0bChzKSBhcmUgc3ViamVjdCB0byBkZXByZWNhdGlvbiwgc28gcGxlYXNl
IGRvbid0IHJlbHkgb24KKyAqIHRoZW0gZm9yIGFueXRoaW5nIGJ1dCBkZWJ1Z2dpbmcgcHVycG9z
ZS4KKyAqLworI2RlZmluZSBEUk1fSU9DVExfUEFORlJPU1RfUEVSRkNOVF9FTkFCTEUJRFJNX0lP
VyhEUk1fQ09NTUFORF9CQVNFICsgRFJNX1BBTkZST1NUX1BFUkZDTlRfRU5BQkxFLCBzdHJ1Y3Qg
ZHJtX3BhbmZyb3N0X3BlcmZjbnRfZW5hYmxlKQorI2RlZmluZSBEUk1fSU9DVExfUEFORlJPU1Rf
UEVSRkNOVF9EVU1QCQlEUk1fSU9XKERSTV9DT01NQU5EX0JBU0UgKyBEUk1fUEFORlJPU1RfUEVS
RkNOVF9EVU1QLCBzdHJ1Y3QgZHJtX3BhbmZyb3N0X3BlcmZjbnRfZHVtcCkKKwogI2RlZmluZSBQ
QU5GUk9TVF9KRF9SRVFfRlMgKDEgPDwgMCkKIC8qKgogICogc3RydWN0IGRybV9wYW5mcm9zdF9z
dWJtaXQgLSBpb2N0bCBhcmd1bWVudCBmb3Igc3VibWl0dGluZyBjb21tYW5kcyB0byB0aGUgM0QK
QEAgLTEzNSw2ICsxNDYsMTkgQEAgc3RydWN0IGRybV9wYW5mcm9zdF9nZXRfYm9fb2Zmc2V0IHsK
IAlfX3U2NCBvZmZzZXQ7CiB9OwogCitzdHJ1Y3QgZHJtX3BhbmZyb3N0X3BlcmZjbnRfZW5hYmxl
IHsKKwlfX3UzMiBlbmFibGU7CisJLyoKKwkgKiBPbiBiaWZyb3N0IHdlIGhhdmUgMiBzZXRzIG9m
IGNvdW50ZXJzLCB0aGlzIHBhcmFtZXRlciBkZWZpbmVzIHRoZQorCSAqIG9uZSB0byB0cmFjay4K
KwkgKi8KKwlfX3UzMiBjb3VudGVyc2V0OworfTsKKworc3RydWN0IGRybV9wYW5mcm9zdF9wZXJm
Y250X2R1bXAgeworCV9fdTY0IGJ1Zl9wdHI7Cit9OworCiAjaWYgZGVmaW5lZChfX2NwbHVzcGx1
cykKIH0KICNlbmRpZgotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5m
cmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0
aW5mby9kcmktZGV2ZWw=
