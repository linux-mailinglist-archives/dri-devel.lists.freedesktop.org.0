Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 623C44562D
	for <lists+dri-devel@lfdr.de>; Fri, 14 Jun 2019 09:25:42 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 58938898C8;
	Fri, 14 Jun 2019 07:23:04 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from pandora.armlinux.org.uk (pandora.armlinux.org.uk
 [IPv6:2001:4d48:ad52:3201:214:fdff:fe10:1be6])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BB57D89AEA
 for <dri-devel@lists.freedesktop.org>; Thu, 13 Jun 2019 15:02:33 +0000 (UTC)
Received: from e0022681537dd.dyn.armlinux.org.uk
 ([fd8f:7570:feb6:1:222:68ff:fe15:37dd]:35404 helo=rmk-PC.armlinux.org.uk)
 by pandora.armlinux.org.uk with esmtpsa
 (TLSv1.2:ECDHE-RSA-AES128-GCM-SHA256:128) (Exim 4.90_1)
 (envelope-from <rmk@armlinux.org.uk>)
 id 1hbRF1-0003jk-CG; Thu, 13 Jun 2019 16:02:15 +0100
Received: from rmk by rmk-PC.armlinux.org.uk with local (Exim
 4.82_1-5b7a7c0-XX) (envelope-from <rmk@armlinux.org.uk>)
 id 1hbREy-00007L-OE; Thu, 13 Jun 2019 16:02:12 +0100
In-Reply-To: <20190613150114.xqkyb7j7w4ve4yvr@shell.armlinux.org.uk>
References: <20190613150114.xqkyb7j7w4ve4yvr@shell.armlinux.org.uk>
From: Russell King <rmk+kernel@armlinux.org.uk>
To: dri-devel@lists.freedesktop.org, linux-arm-kernel@lists.infradead.org
Subject: [PATCH 06/18] drm/armada: move plane address and pitch calculation to
 atomic_check
MIME-Version: 1.0
Content-Disposition: inline
Message-Id: <E1hbREy-00007L-OE@rmk-PC.armlinux.org.uk>
Date: Thu, 13 Jun 2019 16:02:12 +0100
X-Mailman-Approved-At: Fri, 14 Jun 2019 07:21:24 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; 
 d=armlinux.org.uk; s=pandora-2019; h=Date:Sender:Message-Id:Content-Type:
 Content-Transfer-Encoding:MIME-Version:Subject:Cc:To:From:References:
 In-Reply-To:Reply-To:Content-ID:Content-Description:Resent-Date:Resent-From:
 Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:List-Id:List-Help:
 List-Unsubscribe:List-Subscribe:List-Post:List-Owner:List-Archive;
 bh=qSVsWyvK+cKWzJzuyZpZ5WpnbkdBvj5koIHFQzg5Qa4=; b=eh6MLByycBNJf6sd6jfIdXcJ5p
 Y4r3kDH6ATvLrvqg62zeddcFBhdvfzsWoCqJVEup9GwmIxKZW0bQe8KnfWM1KJHW1uylwg5FdwHk1
 SJ4nLVUybJEGnRcjsWReIPP1LircOLMjrQYCuBipiiNqO7u2RCdnLEaBjpm4vmg2shln4g5VdzNEL
 dSkMk7ZDDl3E+ebOZQrmRW6nFPA/yQJ2e532mq0gQ1E70fRCZ0zmM3HXkbBH1ikd7lJ3a7G/8goVk
 R0fLwU0dRhff6dA9P2VOiiqUVRnVsfouDaZQM/4O1OrJ5oOnyv3yqf3StI1S2miKaX17dC2ld2HtV
 x6WwnDnw==;
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: David Airlie <airlied@linux.ie>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

TW92ZSB0aGUgcGxhbmUgYWRkcmVzcyBhbmQgcGl0Y2ggY2FsY3VsYXRpb25zIHRvIGF0b21pY19j
aGVjayByYXRoZXIKdGhhbiB0aGUgdXBkYXRlIGZ1bmN0aW9uLCBzbyB3ZSBkb24ndCBoYXZlIHRv
IHByb2JlIHRoZSBpbnRlcmxhY2UKc2V0dGluZyBmb3IgdGhlIENSVEMgd2hpbGUgdXBkYXRpbmcg
dGhlIHBsYW5lLgoKU2lnbmVkLW9mZi1ieTogUnVzc2VsbCBLaW5nIDxybWsra2VybmVsQGFybWxp
bnV4Lm9yZy51az4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vYXJtYWRhL2FybWFkYV9vdmVybGF5LmMg
fCAyMyArKysrKysrKysrLS0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2FybWFkYS9hcm1h
ZGFfcGxhbmUuYyAgIHwgMzAgKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJz
L2dwdS9kcm0vYXJtYWRhL2FybWFkYV9wbGFuZS5oICAgfCAgNSArKysrKwogMyBmaWxlcyBjaGFu
Z2VkLCAyNSBpbnNlcnRpb25zKCspLCAzMyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vYXJtYWRhL2FybWFkYV9vdmVybGF5LmMgYi9kcml2ZXJzL2dwdS9kcm0vYXJt
YWRhL2FybWFkYV9vdmVybGF5LmMKaW5kZXggZDhkNmU0NjQ1YzFmLi5hNzlkNmU5NDA0MzUgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hcm1hZGEvYXJtYWRhX292ZXJsYXkuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vYXJtYWRhL2FybWFkYV9vdmVybGF5LmMKQEAgLTEwOSwyNyArMTA5LDI0
IEBAIHN0YXRpYyB2b2lkIGFybWFkYV9kcm1fb3ZlcmxheV9wbGFuZV9hdG9taWNfdXBkYXRlKHN0
cnVjdCBkcm1fcGxhbmUgKnBsYW5lLAogCSAgICBvbGRfc3RhdGUtPmZiICE9IHN0YXRlLT5mYiB8
fAogCSAgICBzdGF0ZS0+Y3J0Yy0+c3RhdGUtPm1vZGVfY2hhbmdlZCkgewogCQljb25zdCBzdHJ1
Y3QgZHJtX2Zvcm1hdF9pbmZvICpmb3JtYXQ7Ci0JCXUxNiBzcmNfeCwgcGl0Y2hlc1szXTsKLQkJ
dTMyIGFkZHJzWzJdWzNdOworCQl1MTYgc3JjX3g7CiAKLQkJYXJtYWRhX2RybV9wbGFuZV9jYWxj
KHN0YXRlLCBhZGRycywgcGl0Y2hlcywgZGNydGMtPmludGVybGFjZWQpOwotCi0JCWFybWFkYV9y
ZWdfcXVldWVfc2V0KHJlZ3MsIGlkeCwgYWRkcnNbMF1bMF0sCisJCWFybWFkYV9yZWdfcXVldWVf
c2V0KHJlZ3MsIGlkeCwgYXJtYWRhX2FkZHIoc3RhdGUsIDAsIDApLAogCQkJCSAgICAgTENEX1NQ
VV9ETUFfU1RBUlRfQUREUl9ZMCk7Ci0JCWFybWFkYV9yZWdfcXVldWVfc2V0KHJlZ3MsIGlkeCwg
YWRkcnNbMF1bMV0sCisJCWFybWFkYV9yZWdfcXVldWVfc2V0KHJlZ3MsIGlkeCwgYXJtYWRhX2Fk
ZHIoc3RhdGUsIDAsIDEpLAogCQkJCSAgICAgTENEX1NQVV9ETUFfU1RBUlRfQUREUl9VMCk7Ci0J
CWFybWFkYV9yZWdfcXVldWVfc2V0KHJlZ3MsIGlkeCwgYWRkcnNbMF1bMl0sCisJCWFybWFkYV9y
ZWdfcXVldWVfc2V0KHJlZ3MsIGlkeCwgYXJtYWRhX2FkZHIoc3RhdGUsIDAsIDIpLAogCQkJCSAg
ICAgTENEX1NQVV9ETUFfU1RBUlRfQUREUl9WMCk7Ci0JCWFybWFkYV9yZWdfcXVldWVfc2V0KHJl
Z3MsIGlkeCwgYWRkcnNbMV1bMF0sCisJCWFybWFkYV9yZWdfcXVldWVfc2V0KHJlZ3MsIGlkeCwg
YXJtYWRhX2FkZHIoc3RhdGUsIDEsIDApLAogCQkJCSAgICAgTENEX1NQVV9ETUFfU1RBUlRfQURE
Ul9ZMSk7Ci0JCWFybWFkYV9yZWdfcXVldWVfc2V0KHJlZ3MsIGlkeCwgYWRkcnNbMV1bMV0sCisJ
CWFybWFkYV9yZWdfcXVldWVfc2V0KHJlZ3MsIGlkeCwgYXJtYWRhX2FkZHIoc3RhdGUsIDEsIDEp
LAogCQkJCSAgICAgTENEX1NQVV9ETUFfU1RBUlRfQUREUl9VMSk7Ci0JCWFybWFkYV9yZWdfcXVl
dWVfc2V0KHJlZ3MsIGlkeCwgYWRkcnNbMV1bMl0sCisJCWFybWFkYV9yZWdfcXVldWVfc2V0KHJl
Z3MsIGlkeCwgYXJtYWRhX2FkZHIoc3RhdGUsIDEsIDIpLAogCQkJCSAgICAgTENEX1NQVV9ETUFf
U1RBUlRfQUREUl9WMSk7CiAKLQkJdmFsID0gcGl0Y2hlc1swXSA8PCAxNiB8IHBpdGNoZXNbMF07
CisJCXZhbCA9IGFybWFkYV9waXRjaChzdGF0ZSwgMCkgPDwgMTYgfCBhcm1hZGFfcGl0Y2goc3Rh
dGUsIDApOwogCQlhcm1hZGFfcmVnX3F1ZXVlX3NldChyZWdzLCBpZHgsIHZhbCwgTENEX1NQVV9E
TUFfUElUQ0hfWUMpOwotCQl2YWwgPSBwaXRjaGVzWzFdIDw8IDE2IHwgcGl0Y2hlc1syXTsKKwkJ
dmFsID0gYXJtYWRhX3BpdGNoKHN0YXRlLCAxKSA8PCAxNiB8IGFybWFkYV9waXRjaChzdGF0ZSwg
Mik7CiAJCWFybWFkYV9yZWdfcXVldWVfc2V0KHJlZ3MsIGlkeCwgdmFsLCBMQ0RfU1BVX0RNQV9Q
SVRDSF9VVik7CiAKIAkJY2ZnID0gQ0ZHX0RNQV9GTVQoZHJtX2ZiX3RvX2FybWFkYV9mYihzdGF0
ZS0+ZmIpLT5mbXQpIHwKQEAgLTE0Nyw3ICsxNDQsNyBAQCBzdGF0aWMgdm9pZCBhcm1hZGFfZHJt
X292ZXJsYXlfcGxhbmVfYXRvbWljX3VwZGF0ZShzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKIAkJ
c3JjX3ggPSBzdGF0ZS0+c3JjLngxID4+IDE2OwogCQlpZiAoZm9ybWF0LT5udW1fcGxhbmVzID09
IDEgJiYgc3JjX3ggJiAoZm9ybWF0LT5oc3ViIC0gMSkpCiAJCQljZmcgXj0gQ0ZHX0RNQV9NT0Qo
Q0ZHX1NXQVBVVik7Ci0JCWlmIChkY3J0Yy0+aW50ZXJsYWNlZCkKKwkJaWYgKHRvX2FybWFkYV9w
bGFuZV9zdGF0ZShzdGF0ZSktPmludGVybGFjZSkKIAkJCWNmZyB8PSBDRkdfRE1BX0ZUT0dHTEU7
CiAJCWNmZ19tYXNrID0gQ0ZHX0NCU0hfRU5BIHwgQ0ZHX0RNQUZPUk1BVCB8CiAJCQkgICBDRkdf
RE1BX01PRChDRkdfU1dBUFJCIHwgQ0ZHX1NXQVBVViB8CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vYXJtYWRhL2FybWFkYV9wbGFuZS5jIGIvZHJpdmVycy9ncHUvZHJtL2FybWFkYS9hcm1h
ZGFfcGxhbmUuYwppbmRleCAwOTIxOGMxZDhhNGIuLjQ1MDkyZmMzNTk4ZSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2FybWFkYS9hcm1hZGFfcGxhbmUuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vYXJtYWRhL2FybWFkYV9wbGFuZS5jCkBAIC03OSwyMyArNzksNiBAQCB2b2lkIGFybWFkYV9k
cm1fcGxhbmVfY2FsYyhzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpzdGF0ZSwgdTMyIGFkZHJzWzJd
WzNdLAogCX0KIH0KIAotc3RhdGljIHVuc2lnbmVkIGFybWFkYV9kcm1fY3J0Y19jYWxjX2ZiKHN0
cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnN0YXRlLAotCXN0cnVjdCBhcm1hZGFfcmVncyAqcmVncywg
Ym9vbCBpbnRlcmxhY2VkKQotewotCXUxNiBwaXRjaGVzWzNdOwotCXUzMiBhZGRyc1syXVszXTsK
LQl1bnNpZ25lZCBpID0gMDsKLQotCWFybWFkYV9kcm1fcGxhbmVfY2FsYyhzdGF0ZSwgYWRkcnMs
IHBpdGNoZXMsIGludGVybGFjZWQpOwotCi0JLyogd3JpdGUgb2Zmc2V0LCBiYXNlLCBhbmQgcGl0
Y2ggKi8KLQlhcm1hZGFfcmVnX3F1ZXVlX3NldChyZWdzLCBpLCBhZGRyc1swXVswXSwgTENEX0NG
R19HUkFfU1RBUlRfQUREUjApOwotCWFybWFkYV9yZWdfcXVldWVfc2V0KHJlZ3MsIGksIGFkZHJz
WzFdWzBdLCBMQ0RfQ0ZHX0dSQV9TVEFSVF9BRERSMSk7Ci0JYXJtYWRhX3JlZ19xdWV1ZV9tb2Qo
cmVncywgaSwgcGl0Y2hlc1swXSwgMHhmZmZmLCBMQ0RfQ0ZHX0dSQV9QSVRDSCk7Ci0KLQlyZXR1
cm4gaTsKLX0KLQogaW50IGFybWFkYV9kcm1fcGxhbmVfcHJlcGFyZV9mYihzdHJ1Y3QgZHJtX3Bs
YW5lICpwbGFuZSwKIAlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpzdGF0ZSkKIHsKQEAgLTE2Nyw2
ICsxNTAsOSBAQCBpbnQgYXJtYWRhX2RybV9wbGFuZV9hdG9taWNfY2hlY2soc3RydWN0IGRybV9w
bGFuZSAqcGxhbmUsCiAJc3QtPmRzdF9odyA8PD0gMTY7CiAJc3QtPmRzdF9odyB8PSBkcm1fcmVj
dF93aWR0aCgmc3RhdGUtPmRzdCkgJiAweDAwMDBmZmZmOwogCisJYXJtYWRhX2RybV9wbGFuZV9j
YWxjKHN0YXRlLCBzdC0+YWRkcnMsIHN0LT5waXRjaGVzLCBpbnRlcmxhY2UpOworCXN0LT5pbnRl
cmxhY2UgPSBpbnRlcmxhY2U7CisKIAlyZXR1cm4gMDsKIH0KIApAQCAtMjEzLDggKzE5OSwxMiBA
QCBzdGF0aWMgdm9pZCBhcm1hZGFfZHJtX3ByaW1hcnlfcGxhbmVfYXRvbWljX3VwZGF0ZShzdHJ1
Y3QgZHJtX3BsYW5lICpwbGFuZSwKIAkgICAgb2xkX3N0YXRlLT5zcmMueTEgIT0gc3RhdGUtPnNy
Yy55MSB8fAogCSAgICBvbGRfc3RhdGUtPmZiICE9IHN0YXRlLT5mYiB8fAogCSAgICBzdGF0ZS0+
Y3J0Yy0+c3RhdGUtPm1vZGVfY2hhbmdlZCkgewotCQlpZHggKz0gYXJtYWRhX2RybV9jcnRjX2Nh
bGNfZmIoc3RhdGUsIHJlZ3MgKyBpZHgsCi0JCQkJCSAgICAgICBkY3J0Yy0+aW50ZXJsYWNlZCk7
CisJCWFybWFkYV9yZWdfcXVldWVfc2V0KHJlZ3MsIGlkeCwgYXJtYWRhX2FkZHIoc3RhdGUsIDAs
IDApLAorCQkJCSAgICAgTENEX0NGR19HUkFfU1RBUlRfQUREUjApOworCQlhcm1hZGFfcmVnX3F1
ZXVlX3NldChyZWdzLCBpZHgsIGFybWFkYV9hZGRyKHN0YXRlLCAxLCAwKSwKKwkJCQkgICAgIExD
RF9DRkdfR1JBX1NUQVJUX0FERFIxKTsKKwkJYXJtYWRhX3JlZ19xdWV1ZV9tb2QocmVncywgaWR4
LCBhcm1hZGFfcGl0Y2goc3RhdGUsIDApLCAweGZmZmYsCisJCQkJICAgICBMQ0RfQ0ZHX0dSQV9Q
SVRDSCk7CiAJfQogCWlmIChvbGRfc3RhdGUtPmZiICE9IHN0YXRlLT5mYiB8fAogCSAgICBzdGF0
ZS0+Y3J0Yy0+c3RhdGUtPm1vZGVfY2hhbmdlZCkgewpAQCAtMjI0LDcgKzIxNCw3IEBAIHN0YXRp
YyB2b2lkIGFybWFkYV9kcm1fcHJpbWFyeV9wbGFuZV9hdG9taWNfdXBkYXRlKHN0cnVjdCBkcm1f
cGxhbmUgKnBsYW5lLAogCQkJY2ZnIHw9IENGR19QQUxFVFRFX0VOQTsKIAkJaWYgKHN0YXRlLT52
aXNpYmxlKQogCQkJY2ZnIHw9IENGR19HUkFfRU5BOwotCQlpZiAoZGNydGMtPmludGVybGFjZWQp
CisJCWlmICh0b19hcm1hZGFfcGxhbmVfc3RhdGUoc3RhdGUpLT5pbnRlcmxhY2UpCiAJCQljZmcg
fD0gQ0ZHX0dSQV9GVE9HR0xFOwogCQljZmdfbWFzayA9IENGR19HUkFGT1JNQVQgfAogCQkJICAg
Q0ZHX0dSQV9NT0QoQ0ZHX1NXQVBSQiB8IENGR19TV0FQVVYgfApkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FybWFkYS9hcm1hZGFfcGxhbmUuaCBiL2RyaXZlcnMvZ3B1L2RybS9hcm1hZGEv
YXJtYWRhX3BsYW5lLmgKaW5kZXggMzk2YzQ1YTRlYTVlLi4yNzA3ZWM3ODE5NDEgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9hcm1hZGEvYXJtYWRhX3BsYW5lLmgKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2FybWFkYS9hcm1hZGFfcGxhbmUuaApAQCAtNiw2ICs2LDkgQEAgc3RydWN0IGFybWFk
YV9wbGFuZV9zdGF0ZSB7CiAJdTMyIHNyY19odzsKIAl1MzIgZHN0X3l4OwogCXUzMiBkc3RfaHc7
CisJdTMyIGFkZHJzWzJdWzNdOworCXUxNiBwaXRjaGVzWzNdOworCWJvb2wgaW50ZXJsYWNlOwog
fTsKIAogI2RlZmluZSB0b19hcm1hZGFfcGxhbmVfc3RhdGUoc3QpIFwKQEAgLTEzLDYgKzE2LDgg
QEAgc3RydWN0IGFybWFkYV9wbGFuZV9zdGF0ZSB7CiAjZGVmaW5lIGFybWFkYV9zcmNfaHcoc3Rh
dGUpIHRvX2FybWFkYV9wbGFuZV9zdGF0ZShzdGF0ZSktPnNyY19odwogI2RlZmluZSBhcm1hZGFf
ZHN0X3l4KHN0YXRlKSB0b19hcm1hZGFfcGxhbmVfc3RhdGUoc3RhdGUpLT5kc3RfeXgKICNkZWZp
bmUgYXJtYWRhX2RzdF9odyhzdGF0ZSkgdG9fYXJtYWRhX3BsYW5lX3N0YXRlKHN0YXRlKS0+ZHN0
X2h3CisjZGVmaW5lIGFybWFkYV9hZGRyKHN0YXRlLCBmLCBwKSB0b19hcm1hZGFfcGxhbmVfc3Rh
dGUoc3RhdGUpLT5hZGRyc1tmXVtwXQorI2RlZmluZSBhcm1hZGFfcGl0Y2goc3RhdGUsIG4pIHRv
X2FybWFkYV9wbGFuZV9zdGF0ZShzdGF0ZSktPnBpdGNoZXNbbl0KIAogdm9pZCBhcm1hZGFfZHJt
X3BsYW5lX2NhbGMoc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqc3RhdGUsIHUzMiBhZGRyc1syXVsz
XSwKIAl1MTYgcGl0Y2hlc1szXSwgYm9vbCBpbnRlcmxhY2VkKTsKLS0gCjIuNy40CgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGlu
ZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
