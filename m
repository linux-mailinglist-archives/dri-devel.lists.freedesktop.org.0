Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id E5BF3991DE
	for <lists+dri-devel@lfdr.de>; Thu, 22 Aug 2019 13:15:51 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 5AB6A6EAF9;
	Thu, 22 Aug 2019 11:15:47 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mga18.intel.com (mga18.intel.com [134.134.136.126])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6304D6EAF4;
 Thu, 22 Aug 2019 11:15:40 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga003.fm.intel.com ([10.253.24.29])
 by orsmga106.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 22 Aug 2019 04:15:40 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,416,1559545200"; 
 d="scan'208,223";a="186537498"
Received: from ramaling-i9x.iind.intel.com ([10.99.66.154])
 by FMSMGA003.fm.intel.com with ESMTP; 22 Aug 2019 04:15:37 -0700
From: Ramalingam C <ramalingam.c@intel.com>
To: intel-gfx <intel-gfx@lists.freedesktop.org>,
 dri-devel <dri-devel@lists.freedesktop.org>
Subject: [PATCH v7 6/6] drm/i915/hdcp: Enable HDCP 1.4 and 2.2 on Gen12+
Date: Thu, 22 Aug 2019 16:44:45 +0530
Message-Id: <20190822111445.29350-7-ramalingam.c@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190822111445.29350-1-ramalingam.c@intel.com>
References: <20190822111445.29350-1-ramalingam.c@intel.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Jani Nikula <jani.nikula@intel.com>, tomas.winkler@intel.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbSBHZW4xMiBvbndhcmRzLCBIRENQIEhXIGJsb2NrIGlzIGltcGxlbWVudGVkIHdpdGhpbiB0
cmFuc2NvZGVycy4KVGlsbCBHZW4xMSBIRENQIEhXIGJsb2NrIHdhcyBwYXJ0IG9mIERESS4KCkhl
bmNlIHJlcXVpcmVkIGNoYW5nZXMgaW4gSFcgcHJvZ3JhbW1pbmcgaXMgaGFuZGxlZCBoZXJlLgoK
QXMgTUUgRlcgbmVlZHMgdGhlIHRyYW5zY29kZXIgZGV0YWlsIG9uIHdoaWNoIEhEQ1AgaXMgZW5h
YmxlZApvbiBHZW4xMisgcGxhdGZvcm0sIHdlIGFyZSBwb3B1bGF0aW5nIHRoZSBkZXRhaWwgaW4g
aGRjcF9wb3J0X2RhdGEuCgp2MjoKICBfTU1JT19UUkFOUyBpcyB1c2VkIFtMdWNhcyBhbmQgRGFu
aWVsXQogIHBsYXRmb3JtIGNoZWNrIGlzIG1vdmVkIGludG8gdGhlIGNhbGxlciBbTHVjYXNdCnYz
OgogIHBsYXRmb3JtIGNoZWNrIGlzIG1vdmVkIGludG8gYSBtYWNybyBbU2hhc2hhbmtdCnY0Ogog
IEZldyBvcHRpbWl6YXRpb25zIGluIHRoZSBjb2RpbmcgW1NoYXNoYW5rXQp2NToKICBGaXhlZCBh
bGlnbm1lbnQgaW4gbWFjcm8gZGVmaW5pdGlvbiBpbiBpOTE1X3JlZy5oIFtTaGFzaGFua10KICB1
bnVzZWQgdmFyaWFibGVzICJyZWciIGlzIHJlbW92ZWQuCnY2OgogIENvbmZpZ3VyaW5nIHRoZSB0
cmFuc2NvZGVyIGF0IGNvbXB1dGVfY29uZmlnLgogIHRyYW5zY29kZXIgaXMgdXNlZCBpbnN0ZWFk
IG9mIHBpcGUgaW4gbWFjcm9zLgogIFJlYmFzZWQuCnY3OgogIHRyYW5zY29kZXIgaXMgY2FjaGVk
IGF0IGludGVsX2hkY3AKICBoZGNwX3BvcnRfZGF0YSBpcyBjb25maWd1cmVkIHdpdGggdHJhbnNj
b2RlciBpbmRleCBhc3BlciBNRSBGVy4KClNpZ25lZC1vZmYtYnk6IFJhbWFsaW5nYW0gQyA8cmFt
YWxpbmdhbS5jQGludGVsLmNvbT4KUmV2aWV3ZWQtYnk6IFNoYXNoYW5rIFNoYXJtYSA8c2hhc2hh
bmsuc2hhcm1hQGludGVsLmNvbT4gW3Y1XQotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfaGRjcC5jIHwgMTI5ICsrKysrKysrKysrKystLS0tLS0tLS0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRtaS5jIHwgICA5ICstCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3JlZy5oICAgICAgICAgICB8IDEyNCArKysrKysrKysrKysrKysrKysrLS0KIDMg
ZmlsZXMgY2hhbmdlZCwgMTk5IGluc2VydGlvbnMoKyksIDYzIGRlbGV0aW9ucygtKQoKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRjcC5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9oZGNwLmMKaW5kZXggMjY0YmRhNWQ0ODRjLi44
MGRmNTgxYTBiZmQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfaGRjcC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRjcC5j
CkBAIC0xOCw2ICsxOCw3IEBACiAjaW5jbHVkZSAiaW50ZWxfZGlzcGxheV90eXBlcy5oIgogI2lu
Y2x1ZGUgImludGVsX2hkY3AuaCIKICNpbmNsdWRlICJpbnRlbF9zaWRlYmFuZC5oIgorI2luY2x1
ZGUgImludGVsX2Nvbm5lY3Rvci5oIgogCiAjZGVmaW5lIEtFWV9MT0FEX1RSSUVTCTUKICNkZWZp
bmUgRU5DUllQVF9TVEFUVVNfQ0hBTkdFX1RJTUVPVVRfTVMJNTAKQEAgLTEwNSwyNCArMTA2LDE3
IEBAIGJvb2wgaW50ZWxfaGRjcDJfY2FwYWJsZShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25u
ZWN0b3IpCiAJcmV0dXJuIGNhcGFibGU7CiB9CiAKLXN0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF9o
ZGNwX2luX3VzZShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCitzdGF0aWMgaW5s
aW5lIGJvb2wgaW50ZWxfaGRjcF9pbl91c2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAorCQkJCSAgICAgZW51bSB0cmFuc2NvZGVyIHRjLCBlbnVtIHBvcnQgcG9ydCkKIHsKLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFz
ZS5kZXYpOwotCWVudW0gcG9ydCBwb3J0ID0gY29ubmVjdG9yLT5lbmNvZGVyLT5wb3J0OwotCXUz
MiByZWc7Ci0KLQlyZWcgPSBJOTE1X1JFQUQoUE9SVF9IRENQX1NUQVRVUyhwb3J0KSk7Ci0JcmV0
dXJuIHJlZyAmIEhEQ1BfU1RBVFVTX0VOQzsKKwlyZXR1cm4gSTkxNV9SRUFEKEhEQ1BfU1RBVFVT
KGRldl9wcml2LCB0YywgcG9ydCkpICYgSERDUF9TVEFUVVNfRU5DOwogfQogCi1zdGF0aWMgaW5s
aW5lIGJvb2wgaW50ZWxfaGRjcDJfaW5fdXNlKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5l
Y3RvcikKK3N0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF9oZGNwMl9pbl91c2Uoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCSAgICAgIGVudW0gdHJhbnNjb2RlciB0YywgZW51
bSBwb3J0IHBvcnQpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKLQllbnVtIHBvcnQgcG9ydCA9IGNvbm5lY3Rvci0+
ZW5jb2Rlci0+cG9ydDsKLQl1MzIgcmVnOwotCi0JcmVnID0gSTkxNV9SRUFEKEhEQ1AyX1NUQVRV
U19EREkocG9ydCkpOwotCXJldHVybiByZWcgJiBMSU5LX0VOQ1JZUFRJT05fU1RBVFVTOworCXJl
dHVybiBJOTE1X1JFQUQoSERDUDJfU1RBVFVTKGRldl9wcml2LCB0YywgcG9ydCkpICYKKwkgICAg
ICAgTElOS19FTkNSWVBUSU9OX1NUQVRVUzsKIH0KIAogc3RhdGljIGludCBpbnRlbF9oZGNwX3Bv
bGxfa3N2X2ZpZm8oc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCkBA
IC0yNTMsOSArMjQ3LDI4IEBAIHN0YXRpYyBpbnQgaW50ZWxfd3JpdGVfc2hhX3RleHQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgc2hhX3RleHQpCiB9CiAKIHN0YXRpYwot
dTMyIGludGVsX2hkY3BfZ2V0X3JlcGVhdGVyX2N0bChzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0
ICppbnRlbF9kaWdfcG9ydCkKK3UzMiBpbnRlbF9oZGNwX2dldF9yZXBlYXRlcl9jdGwoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCWVudW0gdHJhbnNjb2RlciB0YywgZW51
bSBwb3J0IHBvcnQpCiB7Ci0JZW51bSBwb3J0IHBvcnQgPSBpbnRlbF9kaWdfcG9ydC0+YmFzZS5w
b3J0OworCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEyKSB7CisJCXN3aXRjaCAodGMpIHsK
KwkJY2FzZSBUUkFOU0NPREVSX0E6CisJCQlyZXR1cm4gSERDUF9UUkFOU0FfUkVQX1BSRVNFTlQg
fAorCQkJICAgICAgIEhEQ1BfVFJBTlNBX1NIQTFfTTA7CisJCWNhc2UgVFJBTlNDT0RFUl9COgor
CQkJcmV0dXJuIEhEQ1BfVFJBTlNCX1JFUF9QUkVTRU5UIHwKKwkJCSAgICAgICBIRENQX1RSQU5T
Ql9TSEExX00wOworCQljYXNlIFRSQU5TQ09ERVJfQzoKKwkJCXJldHVybiBIRENQX1RSQU5TQ19S
RVBfUFJFU0VOVCB8CisJCQkgICAgICAgSERDUF9UUkFOU0NfU0hBMV9NMDsKKwkJLyogRklYTUU6
IEFkZCBhIGNhc2UgZm9yIFBJUEVfRCAqLworCQlkZWZhdWx0OgorCQkJRFJNX0VSUk9SKCJVbmtu
b3duIHRyYW5zY29kZXIgJWRcbiIsIHRjKTsKKwkJCWJyZWFrOworCQl9CisJCXJldHVybiAtRUlO
VkFMOworCX0KKwogCXN3aXRjaCAocG9ydCkgewogCWNhc2UgUE9SVF9BOgogCQlyZXR1cm4gSERD
UF9ERElBX1JFUF9QUkVTRU5UIHwgSERDUF9ERElBX1NIQTFfTTA7CkBAIC0yNjgsMTggKzI4MSwy
MSBAQCB1MzIgaW50ZWxfaGRjcF9nZXRfcmVwZWF0ZXJfY3RsKHN0cnVjdCBpbnRlbF9kaWdpdGFs
X3BvcnQgKmludGVsX2RpZ19wb3J0KQogCWNhc2UgUE9SVF9FOgogCQlyZXR1cm4gSERDUF9ERElF
X1JFUF9QUkVTRU5UIHwgSERDUF9ERElFX1NIQTFfTTA7CiAJZGVmYXVsdDoKKwkJRFJNX0VSUk9S
KCJVbmtub3duIHBvcnQgJWRcbiIsIHBvcnQpOwogCQlicmVhazsKIAl9Ci0JRFJNX0VSUk9SKCJV
bmtub3duIHBvcnQgJWRcbiIsIHBvcnQpOwogCXJldHVybiAtRUlOVkFMOwogfQogCiBzdGF0aWMK
LWludCBpbnRlbF9oZGNwX3ZhbGlkYXRlX3ZfcHJpbWUoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9y
dCAqaW50ZWxfZGlnX3BvcnQsCitpbnQgaW50ZWxfaGRjcF92YWxpZGF0ZV92X3ByaW1lKHN0cnVj
dCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwKIAkJCQljb25zdCBzdHJ1Y3QgaW50ZWxfaGRj
cF9zaGltICpzaGltLAogCQkJCXU4ICprc3ZfZmlmbywgdTggbnVtX2Rvd25zdHJlYW0sIHU4ICpi
c3RhdHVzKQogeworCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0g
Y29ubl90b19kaWdfcG9ydChjb25uZWN0b3IpOwogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdjsKKwllbnVtIHRyYW5zY29kZXIgdGMgPSBjb25uZWN0b3ItPmhkY3AudHJhbnM7CisJ
ZW51bSBwb3J0IHBvcnQgPSBpbnRlbF9kaWdfcG9ydC0+YmFzZS5wb3J0OwogCXUzMiB2cHJpbWUs
IHNoYV90ZXh0LCBzaGFfbGVmdG92ZXJzLCByZXBfY3RsOwogCWludCByZXQsIGksIGosIHNoYV9p
ZHg7CiAKQEAgLTMwNiw3ICszMjIsNyBAQCBpbnQgaW50ZWxfaGRjcF92YWxpZGF0ZV92X3ByaW1l
KHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0LAogCXNoYV9pZHggPSAw
OwogCXNoYV90ZXh0ID0gMDsKIAlzaGFfbGVmdG92ZXJzID0gMDsKLQlyZXBfY3RsID0gaW50ZWxf
aGRjcF9nZXRfcmVwZWF0ZXJfY3RsKGludGVsX2RpZ19wb3J0KTsKKwlyZXBfY3RsID0gaW50ZWxf
aGRjcF9nZXRfcmVwZWF0ZXJfY3RsKGRldl9wcml2LCB0YywgcG9ydCk7CiAJSTkxNV9XUklURShI
RENQX1JFUF9DVEwsIHJlcF9jdGwgfCBIRENQX1NIQTFfVEVYVF8zMik7CiAJZm9yIChpID0gMDsg
aSA8IG51bV9kb3duc3RyZWFtOyBpKyspIHsKIAkJdW5zaWduZWQgaW50IHNoYV9lbXB0eTsKQEAg
LTU0OCw3ICs1NjQsNyBAQCBpbnQgaW50ZWxfaGRjcF9hdXRoX2Rvd25zdHJlYW0oc3RydWN0IGlu
dGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQogCSAqIFYgcHJpbWUgYXRsZWFzdCB0d2ljZS4KIAkg
Ki8KIAlmb3IgKGkgPSAwOyBpIDwgdHJpZXM7IGkrKykgewotCQlyZXQgPSBpbnRlbF9oZGNwX3Zh
bGlkYXRlX3ZfcHJpbWUoaW50ZWxfZGlnX3BvcnQsIHNoaW0sCisJCXJldCA9IGludGVsX2hkY3Bf
dmFsaWRhdGVfdl9wcmltZShjb25uZWN0b3IsIHNoaW0sCiAJCQkJCQkgIGtzdl9maWZvLCBudW1f
ZG93bnN0cmVhbSwKIAkJCQkJCSAgYnN0YXR1cyk7CiAJCWlmICghcmV0KQpAQCAtNTc2LDYgKzU5
Miw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfaGRjcF9hdXRoKHN0cnVjdCBpbnRlbF9jb25uZWN0b3Ig
KmNvbm5lY3RvcikKIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY29ubmVjdG9yLT5iYXNlLmRl
djsKIAljb25zdCBzdHJ1Y3QgaW50ZWxfaGRjcF9zaGltICpzaGltID0gaGRjcC0+c2hpbTsKIAlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXY7CisJZW51bSB0cmFuc2NvZGVyIHRjID0g
Y29ubmVjdG9yLT5oZGNwLnRyYW5zOwogCWVudW0gcG9ydCBwb3J0OwogCXVuc2lnbmVkIGxvbmcg
cjBfcHJpbWVfZ2VuX3N0YXJ0OwogCWludCByZXQsIGksIHRyaWVzID0gMjsKQEAgLTYxNSwxOCAr
NjMyLDE4IEBAIHN0YXRpYyBpbnQgaW50ZWxfaGRjcF9hdXRoKHN0cnVjdCBpbnRlbF9jb25uZWN0
b3IgKmNvbm5lY3RvcikKIAogCS8qIEluaXRpYWxpemUgQW4gd2l0aCAyIHJhbmRvbSB2YWx1ZXMg
YW5kIGFjcXVpcmUgaXQgKi8KIAlmb3IgKGkgPSAwOyBpIDwgMjsgaSsrKQotCQlJOTE1X1dSSVRF
KFBPUlRfSERDUF9BTklOSVQocG9ydCksIGdldF9yYW5kb21fdTMyKCkpOwotCUk5MTVfV1JJVEUo
UE9SVF9IRENQX0NPTkYocG9ydCksIEhEQ1BfQ09ORl9DQVBUVVJFX0FOKTsKKwkJSTkxNV9XUklU
RShIRENQX0FOSU5JVChkZXZfcHJpdiwgdGMsIHBvcnQpLCBnZXRfcmFuZG9tX3UzMigpKTsKKwlJ
OTE1X1dSSVRFKEhEQ1BfQ09ORihkZXZfcHJpdiwgdGMsIHBvcnQpLCBIRENQX0NPTkZfQ0FQVFVS
RV9BTik7CiAKIAkvKiBXYWl0IGZvciBBbiB0byBiZSBhY3F1aXJlZCAqLwotCWlmIChpbnRlbF9k
ZV93YWl0X2Zvcl9zZXQoZGV2X3ByaXYsIFBPUlRfSERDUF9TVEFUVVMocG9ydCksCisJaWYgKGlu
dGVsX2RlX3dhaXRfZm9yX3NldChkZXZfcHJpdiwgSERDUF9TVEFUVVMoZGV2X3ByaXYsIHRjLCBw
b3J0KSwKIAkJCQkgIEhEQ1BfU1RBVFVTX0FOX1JFQURZLCAxKSkgewogCQlEUk1fRVJST1IoIlRp
bWVkIG91dCB3YWl0aW5nIGZvciBBblxuIik7CiAJCXJldHVybiAtRVRJTUVET1VUOwogCX0KIAot
CWFuLnJlZ1swXSA9IEk5MTVfUkVBRChQT1JUX0hEQ1BfQU5MTyhwb3J0KSk7Ci0JYW4ucmVnWzFd
ID0gSTkxNV9SRUFEKFBPUlRfSERDUF9BTkhJKHBvcnQpKTsKKwlhbi5yZWdbMF0gPSBJOTE1X1JF
QUQoSERDUF9BTkxPKGRldl9wcml2LCB0YywgcG9ydCkpOworCWFuLnJlZ1sxXSA9IEk5MTVfUkVB
RChIRENQX0FOSEkoZGV2X3ByaXYsIHRjLCBwb3J0KSk7CiAJcmV0ID0gc2hpbS0+d3JpdGVfYW5f
YWtzdihpbnRlbF9kaWdfcG9ydCwgYW4uc2hpbSk7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsK
QEAgLTY0NCwyNCArNjYxLDI0IEBAIHN0YXRpYyBpbnQgaW50ZWxfaGRjcF9hdXRoKHN0cnVjdCBp
bnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKIAkJcmV0dXJuIC1FUEVSTTsKIAl9CiAKLQlJOTE1
X1dSSVRFKFBPUlRfSERDUF9CS1NWTE8ocG9ydCksIGJrc3YucmVnWzBdKTsKLQlJOTE1X1dSSVRF
KFBPUlRfSERDUF9CS1NWSEkocG9ydCksIGJrc3YucmVnWzFdKTsKKwlJOTE1X1dSSVRFKEhEQ1Bf
QktTVkxPKGRldl9wcml2LCB0YywgcG9ydCksIGJrc3YucmVnWzBdKTsKKwlJOTE1X1dSSVRFKEhE
Q1BfQktTVkhJKGRldl9wcml2LCB0YywgcG9ydCksIGJrc3YucmVnWzFdKTsKIAogCXJldCA9IHNo
aW0tPnJlcGVhdGVyX3ByZXNlbnQoaW50ZWxfZGlnX3BvcnQsICZyZXBlYXRlcl9wcmVzZW50KTsK
IAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCWlmIChyZXBlYXRlcl9wcmVzZW50KQogCQlJOTE1
X1dSSVRFKEhEQ1BfUkVQX0NUTCwKLQkJCSAgIGludGVsX2hkY3BfZ2V0X3JlcGVhdGVyX2N0bChp
bnRlbF9kaWdfcG9ydCkpOworCQkJICAgaW50ZWxfaGRjcF9nZXRfcmVwZWF0ZXJfY3RsKGRldl9w
cml2LCB0YywgcG9ydCkpOwogCiAJcmV0ID0gc2hpbS0+dG9nZ2xlX3NpZ25hbGxpbmcoaW50ZWxf
ZGlnX3BvcnQsIHRydWUpOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKLQlJOTE1X1dSSVRF
KFBPUlRfSERDUF9DT05GKHBvcnQpLCBIRENQX0NPTkZfQVVUSF9BTkRfRU5DKTsKKwlJOTE1X1dS
SVRFKEhEQ1BfQ09ORihkZXZfcHJpdiwgdGMsIHBvcnQpLCBIRENQX0NPTkZfQVVUSF9BTkRfRU5D
KTsKIAogCS8qIFdhaXQgZm9yIFIwIHJlYWR5ICovCi0JaWYgKHdhaXRfZm9yKEk5MTVfUkVBRChQ
T1JUX0hEQ1BfU1RBVFVTKHBvcnQpKSAmCisJaWYgKHdhaXRfZm9yKEk5MTVfUkVBRChIRENQX1NU
QVRVUyhkZXZfcHJpdiwgdGMsIHBvcnQpKSAmCiAJCSAgICAgKEhEQ1BfU1RBVFVTX1IwX1JFQURZ
IHwgSERDUF9TVEFUVVNfRU5DKSwgMSkpIHsKIAkJRFJNX0VSUk9SKCJUaW1lZCBvdXQgd2FpdGlu
ZyBmb3IgUjAgcmVhZHlcbiIpOwogCQlyZXR1cm4gLUVUSU1FRE9VVDsKQEAgLTY4OSwyMiArNzA2
LDIyIEBAIHN0YXRpYyBpbnQgaW50ZWxfaGRjcF9hdXRoKHN0cnVjdCBpbnRlbF9jb25uZWN0b3Ig
KmNvbm5lY3RvcikKIAkJcmV0ID0gc2hpbS0+cmVhZF9yaV9wcmltZShpbnRlbF9kaWdfcG9ydCwg
cmkuc2hpbSk7CiAJCWlmIChyZXQpCiAJCQlyZXR1cm4gcmV0OwotCQlJOTE1X1dSSVRFKFBPUlRf
SERDUF9SUFJJTUUocG9ydCksIHJpLnJlZyk7CisJCUk5MTVfV1JJVEUoSERDUF9SUFJJTUUoZGV2
X3ByaXYsIHRjLCBwb3J0KSwgcmkucmVnKTsKIAogCQkvKiBXYWl0IGZvciBSaSBwcmltZSBtYXRj
aCAqLwotCQlpZiAoIXdhaXRfZm9yKEk5MTVfUkVBRChQT1JUX0hEQ1BfU1RBVFVTKHBvcnQpKSAm
CisJCWlmICghd2FpdF9mb3IoSTkxNV9SRUFEKEhEQ1BfU1RBVFVTKGRldl9wcml2LCB0YywgcG9y
dCkpICYKIAkJICAgIChIRENQX1NUQVRVU19SSV9NQVRDSCB8IEhEQ1BfU1RBVFVTX0VOQyksIDEp
KQogCQkJYnJlYWs7CiAJfQogCiAJaWYgKGkgPT0gdHJpZXMpIHsKIAkJRFJNX0RFQlVHX0tNUygi
VGltZWQgb3V0IHdhaXRpbmcgZm9yIFJpIHByaW1lIG1hdGNoICgleClcbiIsCi0JCQkgICAgICBJ
OTE1X1JFQUQoUE9SVF9IRENQX1NUQVRVUyhwb3J0KSkpOworCQkJICAgICAgSTkxNV9SRUFEKEhE
Q1BfU1RBVFVTKGRldl9wcml2LCB0YywgcG9ydCkpKTsKIAkJcmV0dXJuIC1FVElNRURPVVQ7CiAJ
fQogCiAJLyogV2FpdCBmb3IgZW5jcnlwdGlvbiBjb25maXJtYXRpb24gKi8KLQlpZiAoaW50ZWxf
ZGVfd2FpdF9mb3Jfc2V0KGRldl9wcml2LCBQT1JUX0hEQ1BfU1RBVFVTKHBvcnQpLAorCWlmIChp
bnRlbF9kZV93YWl0X2Zvcl9zZXQoZGV2X3ByaXYsIEhEQ1BfU1RBVFVTKGRldl9wcml2LCB0Yywg
cG9ydCksCiAJCQkJICBIRENQX1NUQVRVU19FTkMsCiAJCQkJICBFTkNSWVBUX1NUQVRVU19DSEFO
R0VfVElNRU9VVF9NUykpIHsKIAkJRFJNX0VSUk9SKCJUaW1lZCBvdXQgd2FpdGluZyBmb3IgZW5j
cnlwdGlvblxuIik7CkBAIC03MjksMTUgKzc0NiwxNiBAQCBzdGF0aWMgaW50IF9pbnRlbF9oZGNw
X2Rpc2FibGUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQogCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGNvbm5lY3Rvci0+YmFzZS5kZXYtPmRldl9wcml2YXRl
OwogCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0gY29ubl90b19k
aWdfcG9ydChjb25uZWN0b3IpOwogCWVudW0gcG9ydCBwb3J0ID0gaW50ZWxfZGlnX3BvcnQtPmJh
c2UucG9ydDsKKwllbnVtIHRyYW5zY29kZXIgdGMgPSBoZGNwLT50cmFuczsKIAlpbnQgcmV0Owog
CiAJRFJNX0RFQlVHX0tNUygiWyVzOiVkXSBIRENQIGlzIGJlaW5nIGRpc2FibGVkLi4uXG4iLAog
CQkgICAgICBjb25uZWN0b3ItPmJhc2UubmFtZSwgY29ubmVjdG9yLT5iYXNlLmJhc2UuaWQpOwog
CiAJaGRjcC0+aGRjcF9lbmNyeXB0ZWQgPSBmYWxzZTsKLQlJOTE1X1dSSVRFKFBPUlRfSERDUF9D
T05GKHBvcnQpLCAwKTsKLQlpZiAoaW50ZWxfZGVfd2FpdF9mb3JfY2xlYXIoZGV2X3ByaXYsIFBP
UlRfSERDUF9TVEFUVVMocG9ydCksIH4wLAotCQkJCSAgICBFTkNSWVBUX1NUQVRVU19DSEFOR0Vf
VElNRU9VVF9NUykpIHsKKwlJOTE1X1dSSVRFKEhEQ1BfQ09ORihkZXZfcHJpdiwgdGMsIHBvcnQp
LCAwKTsKKwlpZiAoaW50ZWxfZGVfd2FpdF9mb3JfY2xlYXIoZGV2X3ByaXYsIEhEQ1BfU1RBVFVT
KGRldl9wcml2LCB0YywgcG9ydCksCisJCQkJICAgIH4wLCBFTkNSWVBUX1NUQVRVU19DSEFOR0Vf
VElNRU9VVF9NUykpIHsKIAkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gZGlzYWJsZSBIRENQLCB0aW1l
b3V0IGNsZWFyaW5nIHN0YXR1c1xuIik7CiAJCXJldHVybiAtRVRJTUVET1VUOwogCX0KQEAgLTgw
OCw5ICs4MjYsMTEgQEAgc3RhdGljIGludCBpbnRlbF9oZGNwX2NoZWNrX2xpbmsoc3RydWN0IGlu
dGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IGNvbm5lY3Rvci0+YmFzZS5kZXYtPmRldl9wcml2YXRlOwogCXN0cnVjdCBpbnRlbF9k
aWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0gY29ubl90b19kaWdfcG9ydChjb25uZWN0b3Ip
OwogCWVudW0gcG9ydCBwb3J0ID0gaW50ZWxfZGlnX3BvcnQtPmJhc2UucG9ydDsKKwllbnVtIHRy
YW5zY29kZXIgdGM7CiAJaW50IHJldCA9IDA7CiAKIAltdXRleF9sb2NrKCZoZGNwLT5tdXRleCk7
CisJdGMgPSBoZGNwLT50cmFuczsKIAogCS8qIENoZWNrX2xpbmsgdmFsaWQgb25seSB3aGVuIEhE
Q1AxLjQgaXMgZW5hYmxlZCAqLwogCWlmIChoZGNwLT52YWx1ZSAhPSBEUk1fTU9ERV9DT05URU5U
X1BST1RFQ1RJT05fRU5BQkxFRCB8fApAQCAtODE5LDEwICs4MzksMTAgQEAgc3RhdGljIGludCBp
bnRlbF9oZGNwX2NoZWNrX2xpbmsoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQog
CQlnb3RvIG91dDsKIAl9CiAKLQlpZiAoV0FSTl9PTighaW50ZWxfaGRjcF9pbl91c2UoY29ubmVj
dG9yKSkpIHsKKwlpZiAoV0FSTl9PTighaW50ZWxfaGRjcF9pbl91c2UoZGV2X3ByaXYsIHRjLCBw
b3J0KSkpIHsKIAkJRFJNX0VSUk9SKCIlczolZCBIRENQIGxpbmsgc3RvcHBlZCBlbmNyeXB0aW9u
LCV4XG4iLAogCQkJICBjb25uZWN0b3ItPmJhc2UubmFtZSwgY29ubmVjdG9yLT5iYXNlLmJhc2Uu
aWQsCi0JCQkgIEk5MTVfUkVBRChQT1JUX0hEQ1BfU1RBVFVTKHBvcnQpKSk7CisJCQkgIEk5MTVf
UkVBRChIRENQX1NUQVRVUyhkZXZfcHJpdiwgdGMsIHBvcnQpKSk7CiAJCXJldCA9IC1FTlhJTzsK
IAkJaGRjcC0+dmFsdWUgPSBEUk1fTU9ERV9DT05URU5UX1BST1RFQ1RJT05fREVTSVJFRDsKIAkJ
c2NoZWR1bGVfd29yaygmaGRjcC0+cHJvcF93b3JrKTsKQEAgLTE0OTMsMTAgKzE1MTMsMTEgQEAg
c3RhdGljIGludCBoZGNwMl9lbmFibGVfZW5jcnlwdGlvbihzdHJ1Y3QgaW50ZWxfY29ubmVjdG9y
ICpjb25uZWN0b3IpCiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjb25uZWN0b3ItPmJhc2UuZGV2KTsKIAlzdHJ1Y3QgaW50ZWxfaGRjcCAqaGRjcCA9ICZjb25u
ZWN0b3ItPmhkY3A7CiAJZW51bSBwb3J0IHBvcnQgPSBjb25uZWN0b3ItPmVuY29kZXItPnBvcnQ7
CisJZW51bSB0cmFuc2NvZGVyIHRjID0gaGRjcC0+dHJhbnM7CiAJaW50IHJldDsKIAotCVdBUk5f
T04oSTkxNV9SRUFEKEhEQ1AyX1NUQVRVU19EREkocG9ydCkpICYgTElOS19FTkNSWVBUSU9OX1NU
QVRVUyk7Ci0KKwlXQVJOX09OKEk5MTVfUkVBRChIRENQMl9TVEFUVVMoZGV2X3ByaXYsIHRjLCBw
b3J0KSkgJgorCQlMSU5LX0VOQ1JZUFRJT05fU1RBVFVTKTsKIAlpZiAoaGRjcC0+c2hpbS0+dG9n
Z2xlX3NpZ25hbGxpbmcpIHsKIAkJcmV0ID0gaGRjcC0+c2hpbS0+dG9nZ2xlX3NpZ25hbGxpbmco
aW50ZWxfZGlnX3BvcnQsIHRydWUpOwogCQlpZiAocmV0KSB7CkBAIC0xNTA2LDE0ICsxNTI3LDE0
IEBAIHN0YXRpYyBpbnQgaGRjcDJfZW5hYmxlX2VuY3J5cHRpb24oc3RydWN0IGludGVsX2Nvbm5l
Y3RvciAqY29ubmVjdG9yKQogCQl9CiAJfQogCi0JaWYgKEk5MTVfUkVBRChIRENQMl9TVEFUVVNf
RERJKHBvcnQpKSAmIExJTktfQVVUSF9TVEFUVVMpIHsKKwlpZiAoSTkxNV9SRUFEKEhEQ1AyX1NU
QVRVUyhkZXZfcHJpdiwgdGMsIHBvcnQpKSAmIExJTktfQVVUSF9TVEFUVVMpIHsKIAkJLyogTGlu
ayBpcyBBdXRoZW50aWNhdGVkLiBOb3cgc2V0IGZvciBFbmNyeXB0aW9uICovCi0JCUk5MTVfV1JJ
VEUoSERDUDJfQ1RMX0RESShwb3J0KSwKLQkJCSAgIEk5MTVfUkVBRChIRENQMl9DVExfRERJKHBv
cnQpKSB8CisJCUk5MTVfV1JJVEUoSERDUDJfQ1RMKGRldl9wcml2LCB0YywgcG9ydCksCisJCQkg
ICBJOTE1X1JFQUQoSERDUDJfQ1RMKGRldl9wcml2LCB0YywgcG9ydCkpIHwKIAkJCSAgIENUTF9M
SU5LX0VOQ1JZUFRJT05fUkVRKTsKIAl9CiAKLQlyZXQgPSBpbnRlbF9kZV93YWl0X2Zvcl9zZXQo
ZGV2X3ByaXYsIEhEQ1AyX1NUQVRVU19EREkocG9ydCksCisJcmV0ID0gaW50ZWxfZGVfd2FpdF9m
b3Jfc2V0KGRldl9wcml2LCBIRENQMl9TVEFUVVMoZGV2X3ByaXYsIHRjLCBwb3J0KSwKIAkJCQkg
ICAgTElOS19FTkNSWVBUSU9OX1NUQVRVUywKIAkJCQkgICAgRU5DUllQVF9TVEFUVVNfQ0hBTkdF
X1RJTUVPVVRfTVMpOwogCkBAIC0xNTI2LDE0ICsxNTQ3LDE4IEBAIHN0YXRpYyBpbnQgaGRjcDJf
ZGlzYWJsZV9lbmNyeXB0aW9uKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKIAlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFz
ZS5kZXYpOwogCXN0cnVjdCBpbnRlbF9oZGNwICpoZGNwID0gJmNvbm5lY3Rvci0+aGRjcDsKIAll
bnVtIHBvcnQgcG9ydCA9IGNvbm5lY3Rvci0+ZW5jb2Rlci0+cG9ydDsKKwllbnVtIHRyYW5zY29k
ZXIgdGMgPSBoZGNwLT50cmFuczsKIAlpbnQgcmV0OwogCi0JV0FSTl9PTighKEk5MTVfUkVBRChI
RENQMl9TVEFUVVNfRERJKHBvcnQpKSAmIExJTktfRU5DUllQVElPTl9TVEFUVVMpKTsKKwlXQVJO
X09OKCEoSTkxNV9SRUFEKEhEQ1AyX1NUQVRVUyhkZXZfcHJpdiwgdGMsIHBvcnQpKSAmCisJCQkg
ICAgTElOS19FTkNSWVBUSU9OX1NUQVRVUykpOwogCi0JSTkxNV9XUklURShIRENQMl9DVExfRERJ
KHBvcnQpLAotCQkgICBJOTE1X1JFQUQoSERDUDJfQ1RMX0RESShwb3J0KSkgJiB+Q1RMX0xJTktf
RU5DUllQVElPTl9SRVEpOworCUk5MTVfV1JJVEUoSERDUDJfQ1RMKGRldl9wcml2LCB0YywgcG9y
dCksCisJCSAgIEk5MTVfUkVBRChIRENQMl9DVEwoZGV2X3ByaXYsIHRjLCBwb3J0KSkgJgorCQkg
ICB+Q1RMX0xJTktfRU5DUllQVElPTl9SRVEpOwogCi0JcmV0ID0gaW50ZWxfZGVfd2FpdF9mb3Jf
Y2xlYXIoZGV2X3ByaXYsIEhEQ1AyX1NUQVRVU19EREkocG9ydCksCisJcmV0ID0gaW50ZWxfZGVf
d2FpdF9mb3JfY2xlYXIoZGV2X3ByaXYsCisJCQkJICAgICAgSERDUDJfU1RBVFVTKGRldl9wcml2
LCB0YywgcG9ydCksCiAJCQkJICAgICAgTElOS19FTkNSWVBUSU9OX1NUQVRVUywKIAkJCQkgICAg
ICBFTkNSWVBUX1NUQVRVU19DSEFOR0VfVElNRU9VVF9NUyk7CiAJaWYgKHJldCA9PSAtRVRJTUVE
T1VUKQpAQCAtMTYzMiw5ICsxNjU3LDExIEBAIHN0YXRpYyBpbnQgaW50ZWxfaGRjcDJfY2hlY2tf
bGluayhzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCiAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKIAlzdHJ1
Y3QgaW50ZWxfaGRjcCAqaGRjcCA9ICZjb25uZWN0b3ItPmhkY3A7CiAJZW51bSBwb3J0IHBvcnQg
PSBjb25uZWN0b3ItPmVuY29kZXItPnBvcnQ7CisJZW51bSB0cmFuc2NvZGVyIHRjOwogCWludCBy
ZXQgPSAwOwogCiAJbXV0ZXhfbG9jaygmaGRjcC0+bXV0ZXgpOworCXRjID0gaGRjcC0+dHJhbnM7
CiAKIAkvKiBoZGNwMl9jaGVja19saW5rIGlzIGV4cGVjdGVkIG9ubHkgd2hlbiBIRENQMi4yIGlz
IEVuYWJsZWQgKi8KIAlpZiAoaGRjcC0+dmFsdWUgIT0gRFJNX01PREVfQ09OVEVOVF9QUk9URUNU
SU9OX0VOQUJMRUQgfHwKQEAgLTE2NDMsOSArMTY3MCw5IEBAIHN0YXRpYyBpbnQgaW50ZWxfaGRj
cDJfY2hlY2tfbGluayhzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCiAJCWdvdG8g
b3V0OwogCX0KIAotCWlmIChXQVJOX09OKCFpbnRlbF9oZGNwMl9pbl91c2UoY29ubmVjdG9yKSkp
IHsKKwlpZiAoV0FSTl9PTighaW50ZWxfaGRjcDJfaW5fdXNlKGRldl9wcml2LCB0YywgcG9ydCkp
KSB7CiAJCURSTV9FUlJPUigiSERDUDIuMiBsaW5rIHN0b3BwZWQgdGhlIGVuY3J5cHRpb24sICV4
XG4iLAotCQkJICBJOTE1X1JFQUQoSERDUDJfU1RBVFVTX0RESShwb3J0KSkpOworCQkJICBJOTE1
X1JFQUQoSERDUDJfU1RBVFVTKGRldl9wcml2LCB0YywgcG9ydCkpKTsKIAkJcmV0ID0gLUVOWElP
OwogCQloZGNwLT52YWx1ZSA9IERSTV9NT0RFX0NPTlRFTlRfUFJPVEVDVElPTl9ERVNJUkVEOwog
CQlzY2hlZHVsZV93b3JrKCZoZGNwLT5wcm9wX3dvcmspOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9oZG1pLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2hkbWkuYwppbmRleCA2ZTliYjZiZDFlZTIuLjUwOWM2ODI2YWU2YiAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9oZG1pLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9oZG1pLmMKQEAgLTE0OTEsNyArMTQ5
MSwxMCBAQCBib29sIGludGVsX2hkbWlfaGRjcF9jaGVja19saW5rKHN0cnVjdCBpbnRlbF9kaWdp
dGFsX3BvcnQgKmludGVsX2RpZ19wb3J0KQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9CiAJCWludGVsX2RpZ19wb3J0LT5iYXNlLmJhc2UuZGV2LT5kZXZfcHJpdmF0ZTsK
KwlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IgPQorCQlpbnRlbF9kaWdfcG9ydC0+
aGRtaS5hdHRhY2hlZF9jb25uZWN0b3I7CiAJZW51bSBwb3J0IHBvcnQgPSBpbnRlbF9kaWdfcG9y
dC0+YmFzZS5wb3J0OworCWVudW0gdHJhbnNjb2RlciB0YyA9IGNvbm5lY3Rvci0+aGRjcC50cmFu
czsKIAlpbnQgcmV0OwogCXVuaW9uIHsKIAkJdTMyIHJlZzsKQEAgLTE1MDIsMTMgKzE1MDUsMTMg
QEAgYm9vbCBpbnRlbF9oZG1pX2hkY3BfY2hlY2tfbGluayhzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9w
b3J0ICppbnRlbF9kaWdfcG9ydCkKIAlpZiAocmV0KQogCQlyZXR1cm4gZmFsc2U7CiAKLQlJOTE1
X1dSSVRFKFBPUlRfSERDUF9SUFJJTUUocG9ydCksIHJpLnJlZyk7CisJSTkxNV9XUklURShIRENQ
X1JQUklNRShkZXZfcHJpdiwgdGMsIHBvcnQpLCByaS5yZWcpOwogCiAJLyogV2FpdCBmb3IgUmkg
cHJpbWUgbWF0Y2ggKi8KLQlpZiAod2FpdF9mb3IoSTkxNV9SRUFEKFBPUlRfSERDUF9TVEFUVVMo
cG9ydCkpICYKKwlpZiAod2FpdF9mb3IoSTkxNV9SRUFEKEhEQ1BfU1RBVFVTKGRldl9wcml2LCB0
YywgcG9ydCkpICYKIAkJICAgICAoSERDUF9TVEFUVVNfUklfTUFUQ0ggfCBIRENQX1NUQVRVU19F
TkMpLCAxKSkgewogCQlEUk1fRVJST1IoIlJpJyBtaXNtYXRjaCBkZXRlY3RlZCwgbGluayBjaGVj
ayBmYWlsZWQgKCV4KVxuIiwKLQkJCSAgSTkxNV9SRUFEKFBPUlRfSERDUF9TVEFUVVMocG9ydCkp
KTsKKwkJCSAgSTkxNV9SRUFEKEhEQ1BfU1RBVFVTKGRldl9wcml2LCB0YywgcG9ydCkpKTsKIAkJ
cmV0dXJuIGZhbHNlOwogCX0KIAlyZXR1cm4gdHJ1ZTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfcmVnLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlZy5oCmlu
ZGV4IDJhYmQxOTkwOTNjNS4uNTcyZTRjYmE4NDdhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3JlZy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVnLmgK
QEAgLTkyNTYsMTIgKzkyNTYsMjAgQEAgZW51bSBza2xfcG93ZXJfZ2F0ZSB7CiAKIC8qIEhEQ1Ag
UmVwZWF0ZXIgUmVnaXN0ZXJzICovCiAjZGVmaW5lIEhEQ1BfUkVQX0NUTAkJCV9NTUlPKDB4NjZk
MDApCisjZGVmaW5lICBIRENQX1RSQU5TQV9SRVBfUFJFU0VOVAlCSVQoMzEpCisjZGVmaW5lICBI
RENQX1RSQU5TQl9SRVBfUFJFU0VOVAlCSVQoMzApCisjZGVmaW5lICBIRENQX1RSQU5TQ19SRVBf
UFJFU0VOVAlCSVQoMjkpCisjZGVmaW5lICBIRENQX1RSQU5TRF9SRVBfUFJFU0VOVAlCSVQoMjgp
CiAjZGVmaW5lICBIRENQX0RESUJfUkVQX1BSRVNFTlQJCUJJVCgzMCkKICNkZWZpbmUgIEhEQ1Bf
RERJQV9SRVBfUFJFU0VOVAkJQklUKDI5KQogI2RlZmluZSAgSERDUF9ERElDX1JFUF9QUkVTRU5U
CQlCSVQoMjgpCiAjZGVmaW5lICBIRENQX0RESURfUkVQX1BSRVNFTlQJCUJJVCgyNykKICNkZWZp
bmUgIEhEQ1BfRERJRl9SRVBfUFJFU0VOVAkJQklUKDI2KQogI2RlZmluZSAgSERDUF9ERElFX1JF
UF9QUkVTRU5UCQlCSVQoMjUpCisjZGVmaW5lICBIRENQX1RSQU5TQV9TSEExX00wCQkoMSA8PCAy
MCkKKyNkZWZpbmUgIEhEQ1BfVFJBTlNCX1NIQTFfTTAJCSgyIDw8IDIwKQorI2RlZmluZSAgSERD
UF9UUkFOU0NfU0hBMV9NMAkJKDMgPDwgMjApCisjZGVmaW5lICBIRENQX1RSQU5TRF9TSEExX00w
CQkoNCA8PCAyMCkKICNkZWZpbmUgIEhEQ1BfRERJQl9TSEExX00wCQkoMSA8PCAyMCkKICNkZWZp
bmUgIEhEQ1BfRERJQV9TSEExX00wCQkoMiA8PCAyMCkKICNkZWZpbmUgIEhEQ1BfRERJQ19TSEEx
X00wCQkoMyA8PCAyMCkKQEAgLTkzMDEsMTUgKzkzMDksOTIgQEAgZW51bSBza2xfcG93ZXJfZ2F0
ZSB7CiAJCQkJCSAgX1BPUlRFX0hEQ1BfQVVUSEVOQywgXAogCQkJCQkgIF9QT1JURl9IRENQX0FV
VEhFTkMpICsgKHgpKQogI2RlZmluZSBQT1JUX0hEQ1BfQ09ORihwb3J0KQkJX1BPUlRfSERDUF9B
VVRIRU5DKHBvcnQsIDB4MCkKKyNkZWZpbmUgX1RSQU5TQV9IRENQX0NPTkYJCTB4NjY0MDAKKyNk
ZWZpbmUgX1RSQU5TQl9IRENQX0NPTkYJCTB4NjY1MDAKKyNkZWZpbmUgVFJBTlNfSERDUF9DT05G
KHRyYW5zKQkJX01NSU9fVFJBTlModHJhbnMsIF9UUkFOU0FfSERDUF9DT05GLCBcCisJCQkJCQkg
ICAgX1RSQU5TQl9IRENQX0NPTkYpCisjZGVmaW5lIEhEQ1BfQ09ORihkZXZfcHJpdiwgdHJhbnMs
IHBvcnQpIFwKKwkJCQkJKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTIgPyBcCisJCQkJCSBUUkFO
U19IRENQX0NPTkYodHJhbnMpIDogXAorCQkJCQkgUE9SVF9IRENQX0NPTkYocG9ydCkpCisKICNk
ZWZpbmUgIEhEQ1BfQ09ORl9DQVBUVVJFX0FOCQlCSVQoMCkKICNkZWZpbmUgIEhEQ1BfQ09ORl9B
VVRIX0FORF9FTkMJCShCSVQoMSkgfCBCSVQoMCkpCiAjZGVmaW5lIFBPUlRfSERDUF9BTklOSVQo
cG9ydCkJCV9QT1JUX0hEQ1BfQVVUSEVOQyhwb3J0LCAweDQpCisjZGVmaW5lIF9UUkFOU0FfSERD
UF9BTklOSVQJCTB4NjY0MDQKKyNkZWZpbmUgX1RSQU5TQl9IRENQX0FOSU5JVAkJMHg2NjUwNAor
I2RlZmluZSBUUkFOU19IRENQX0FOSU5JVCh0cmFucykJX01NSU9fVFJBTlModHJhbnMsIFwKKwkJ
CQkJCSAgICBfVFJBTlNBX0hEQ1BfQU5JTklULCBcCisJCQkJCQkgICAgX1RSQU5TQl9IRENQX0FO
SU5JVCkKKyNkZWZpbmUgSERDUF9BTklOSVQoZGV2X3ByaXYsIHRyYW5zLCBwb3J0KSBcCisJCQkJ
CShJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEyID8gXAorCQkJCQkgVFJBTlNfSERDUF9BTklOSVQo
dHJhbnMpIDogXAorCQkJCQkgUE9SVF9IRENQX0FOSU5JVChwb3J0KSkKKwogI2RlZmluZSBQT1JU
X0hEQ1BfQU5MTyhwb3J0KQkJX1BPUlRfSERDUF9BVVRIRU5DKHBvcnQsIDB4OCkKKyNkZWZpbmUg
X1RSQU5TQV9IRENQX0FOTE8JCTB4NjY0MDgKKyNkZWZpbmUgX1RSQU5TQl9IRENQX0FOTE8JCTB4
NjY1MDgKKyNkZWZpbmUgVFJBTlNfSERDUF9BTkxPKHRyYW5zKQkJX01NSU9fVFJBTlModHJhbnMs
IF9UUkFOU0FfSERDUF9BTkxPLCBcCisJCQkJCQkgICAgX1RSQU5TQl9IRENQX0FOTE8pCisjZGVm
aW5lIEhEQ1BfQU5MTyhkZXZfcHJpdiwgdHJhbnMsIHBvcnQpIFwKKwkJCQkJKElOVEVMX0dFTihk
ZXZfcHJpdikgPj0gMTIgPyBcCisJCQkJCSBUUkFOU19IRENQX0FOTE8odHJhbnMpIDogXAorCQkJ
CQkgUE9SVF9IRENQX0FOTE8ocG9ydCkpCisKICNkZWZpbmUgUE9SVF9IRENQX0FOSEkocG9ydCkJ
CV9QT1JUX0hEQ1BfQVVUSEVOQyhwb3J0LCAweEMpCisjZGVmaW5lIF9UUkFOU0FfSERDUF9BTkhJ
CQkweDY2NDBDCisjZGVmaW5lIF9UUkFOU0JfSERDUF9BTkhJCQkweDY2NTBDCisjZGVmaW5lIFRS
QU5TX0hEQ1BfQU5ISSh0cmFucykJCV9NTUlPX1RSQU5TKHRyYW5zLCBfVFJBTlNBX0hEQ1BfQU5I
SSwgXAorCQkJCQkJICAgIF9UUkFOU0JfSERDUF9BTkhJKQorI2RlZmluZSBIRENQX0FOSEkoZGV2
X3ByaXYsIHRyYW5zLCBwb3J0KSBcCisJCQkJCShJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEyID8g
XAorCQkJCQkgVFJBTlNfSERDUF9BTkhJKHRyYW5zKSA6IFwKKwkJCQkJIFBPUlRfSERDUF9BTkhJ
KHBvcnQpKQorCiAjZGVmaW5lIFBPUlRfSERDUF9CS1NWTE8ocG9ydCkJCV9QT1JUX0hEQ1BfQVVU
SEVOQyhwb3J0LCAweDEwKQorI2RlZmluZSBfVFJBTlNBX0hEQ1BfQktTVkxPCQkweDY2NDEwCisj
ZGVmaW5lIF9UUkFOU0JfSERDUF9CS1NWTE8JCTB4NjY1MTAKKyNkZWZpbmUgVFJBTlNfSERDUF9C
S1NWTE8odHJhbnMpCV9NTUlPX1RSQU5TKHRyYW5zLCBcCisJCQkJCQkgICAgX1RSQU5TQV9IRENQ
X0JLU1ZMTywgXAorCQkJCQkJICAgIF9UUkFOU0JfSERDUF9CS1NWTE8pCisjZGVmaW5lIEhEQ1Bf
QktTVkxPKGRldl9wcml2LCB0cmFucywgcG9ydCkgXAorCQkJCQkoSU5URUxfR0VOKGRldl9wcml2
KSA+PSAxMiA/IFwKKwkJCQkJIFRSQU5TX0hEQ1BfQktTVkxPKHRyYW5zKSA6IFwKKwkJCQkJIFBP
UlRfSERDUF9CS1NWTE8ocG9ydCkpCisKICNkZWZpbmUgUE9SVF9IRENQX0JLU1ZISShwb3J0KQkJ
X1BPUlRfSERDUF9BVVRIRU5DKHBvcnQsIDB4MTQpCisjZGVmaW5lIF9UUkFOU0FfSERDUF9CS1NW
SEkJCTB4NjY0MTQKKyNkZWZpbmUgX1RSQU5TQl9IRENQX0JLU1ZISQkJMHg2NjUxNAorI2RlZmlu
ZSBUUkFOU19IRENQX0JLU1ZISSh0cmFucykJX01NSU9fVFJBTlModHJhbnMsIFwKKwkJCQkJCSAg
ICBfVFJBTlNBX0hEQ1BfQktTVkhJLCBcCisJCQkJCQkgICAgX1RSQU5TQl9IRENQX0JLU1ZISSkK
KyNkZWZpbmUgSERDUF9CS1NWSEkoZGV2X3ByaXYsIHRyYW5zLCBwb3J0KSBcCisJCQkJCShJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDEyID8gXAorCQkJCQkgVFJBTlNfSERDUF9CS1NWSEkodHJhbnMp
IDogXAorCQkJCQkgUE9SVF9IRENQX0JLU1ZISShwb3J0KSkKKwogI2RlZmluZSBQT1JUX0hEQ1Bf
UlBSSU1FKHBvcnQpCQlfUE9SVF9IRENQX0FVVEhFTkMocG9ydCwgMHgxOCkKKyNkZWZpbmUgX1RS
QU5TQV9IRENQX1JQUklNRQkJMHg2NjQxOAorI2RlZmluZSBfVFJBTlNCX0hEQ1BfUlBSSU1FCQkw
eDY2NTE4CisjZGVmaW5lIFRSQU5TX0hEQ1BfUlBSSU1FKHRyYW5zKQlfTU1JT19UUkFOUyh0cmFu
cywgXAorCQkJCQkJICAgIF9UUkFOU0FfSERDUF9SUFJJTUUsIFwKKwkJCQkJCSAgICBfVFJBTlNC
X0hEQ1BfUlBSSU1FKQorI2RlZmluZSBIRENQX1JQUklNRShkZXZfcHJpdiwgdHJhbnMsIHBvcnQp
IFwKKwkJCQkJKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTIgPyBcCisJCQkJCSBUUkFOU19IRENQ
X1JQUklNRSh0cmFucykgOiBcCisJCQkJCSBQT1JUX0hEQ1BfUlBSSU1FKHBvcnQpKQorCiAjZGVm
aW5lIFBPUlRfSERDUF9TVEFUVVMocG9ydCkJCV9QT1JUX0hEQ1BfQVVUSEVOQyhwb3J0LCAweDFD
KQorI2RlZmluZSBfVFJBTlNBX0hEQ1BfU1RBVFVTCQkweDY2NDFDCisjZGVmaW5lIF9UUkFOU0Jf
SERDUF9TVEFUVVMJCTB4NjY1MUMKKyNkZWZpbmUgVFJBTlNfSERDUF9TVEFUVVModHJhbnMpCV9N
TUlPX1RSQU5TKHRyYW5zLCBcCisJCQkJCQkgICAgX1RSQU5TQV9IRENQX1NUQVRVUywgXAorCQkJ
CQkJICAgIF9UUkFOU0JfSERDUF9TVEFUVVMpCisjZGVmaW5lIEhEQ1BfU1RBVFVTKGRldl9wcml2
LCB0cmFucywgcG9ydCkgXAorCQkJCQkoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMiA/IFwKKwkJ
CQkJIFRSQU5TX0hEQ1BfU1RBVFVTKHRyYW5zKSA6IFwKKwkJCQkJIFBPUlRfSERDUF9TVEFUVVMo
cG9ydCkpCisKICNkZWZpbmUgIEhEQ1BfU1RBVFVTX1NUUkVBTV9BX0VOQwlCSVQoMzEpCiAjZGVm
aW5lICBIRENQX1NUQVRVU19TVFJFQU1fQl9FTkMJQklUKDMwKQogI2RlZmluZSAgSERDUF9TVEFU
VVNfU1RSRUFNX0NfRU5DCUJJVCgyOSkKQEAgLTkzMzYsMjMgKzk0MjEsNDQgQEAgZW51bSBza2xf
cG93ZXJfZ2F0ZSB7CiAJCQkJCSAgX1BPUlREX0hEQ1AyX0JBU0UsIFwKIAkJCQkJICBfUE9SVEVf
SERDUDJfQkFTRSwgXAogCQkJCQkgIF9QT1JURl9IRENQMl9CQVNFKSArICh4KSkKLQotI2RlZmlu
ZSBIRENQMl9BVVRIX0RESShwb3J0KQkJX1BPUlRfSERDUDJfQkFTRShwb3J0LCAweDk4KQorI2Rl
ZmluZSBQT1JUX0hEQ1AyX0FVVEgocG9ydCkJCV9QT1JUX0hEQ1AyX0JBU0UocG9ydCwgMHg5OCkK
KyNkZWZpbmUgX1RSQU5TQV9IRENQMl9BVVRICQkweDY2NDk4CisjZGVmaW5lIF9UUkFOU0JfSERD
UDJfQVVUSAkJMHg2NjU5OAorI2RlZmluZSBUUkFOU19IRENQMl9BVVRIKHRyYW5zKQkJX01NSU9f
VFJBTlModHJhbnMsIF9UUkFOU0FfSERDUDJfQVVUSCwgXAorCQkJCQkJICAgIF9UUkFOU0JfSERD
UDJfQVVUSCkKICNkZWZpbmUgICBBVVRIX0xJTktfQVVUSEVOVElDQVRFRAlCSVQoMzEpCiAjZGVm
aW5lICAgQVVUSF9MSU5LX1RZUEUJCUJJVCgzMCkKICNkZWZpbmUgICBBVVRIX0ZPUkNFX0NMUl9J
TlBVVENUUglCSVQoMTkpCiAjZGVmaW5lICAgQVVUSF9DTFJfS0VZUwkJCUJJVCgxOCkKLQotI2Rl
ZmluZSBIRENQMl9DVExfRERJKHBvcnQpCQlfUE9SVF9IRENQMl9CQVNFKHBvcnQsIDB4QjApCisj
ZGVmaW5lIEhEQ1AyX0FVVEgoZGV2X3ByaXYsIHRyYW5zLCBwb3J0KSBcCisJCQkJCShJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDEyID8gXAorCQkJCQkgVFJBTlNfSERDUDJfQVVUSCh0cmFucykgOiBc
CisJCQkJCSBQT1JUX0hEQ1AyX0FVVEgocG9ydCkpCisKKyNkZWZpbmUgUE9SVF9IRENQMl9DVEwo
cG9ydCkJCV9QT1JUX0hEQ1AyX0JBU0UocG9ydCwgMHhCMCkKKyNkZWZpbmUgX1RSQU5TQV9IRENQ
Ml9DVEwJCTB4NjY0QjAKKyNkZWZpbmUgX1RSQU5TQl9IRENQMl9DVEwJCTB4NjY1QjAKKyNkZWZp
bmUgVFJBTlNfSERDUDJfQ1RMKHRyYW5zKQkJX01NSU9fVFJBTlModHJhbnMsIF9UUkFOU0FfSERD
UDJfQ1RMLCBcCisJCQkJCQkgICAgX1RSQU5TQl9IRENQMl9DVEwpCiAjZGVmaW5lICAgQ1RMX0xJ
TktfRU5DUllQVElPTl9SRVEJQklUKDMxKQotCi0jZGVmaW5lIEhEQ1AyX1NUQVRVU19EREkocG9y
dCkJCV9QT1JUX0hEQ1AyX0JBU0UocG9ydCwgMHhCNCkKLSNkZWZpbmUgICBTVFJFQU1fRU5DUllQ
VElPTl9TVEFUVVNfQQlCSVQoMzEpCi0jZGVmaW5lICAgU1RSRUFNX0VOQ1JZUFRJT05fU1RBVFVT
X0IJQklUKDMwKQotI2RlZmluZSAgIFNUUkVBTV9FTkNSWVBUSU9OX1NUQVRVU19DCUJJVCgyOSkK
KyNkZWZpbmUgSERDUDJfQ1RMKGRldl9wcml2LCB0cmFucywgcG9ydCkgXAorCQkJCQkoSU5URUxf
R0VOKGRldl9wcml2KSA+PSAxMiA/IFwKKwkJCQkJIFRSQU5TX0hEQ1AyX0NUTCh0cmFucykgOiBc
CisJCQkJCSBQT1JUX0hEQ1AyX0NUTChwb3J0KSkKKworI2RlZmluZSBQT1JUX0hEQ1AyX1NUQVRV
Uyhwb3J0KQkJX1BPUlRfSERDUDJfQkFTRShwb3J0LCAweEI0KQorI2RlZmluZSBfVFJBTlNBX0hE
Q1AyX1NUQVRVUwkJMHg2NjRCNAorI2RlZmluZSBfVFJBTlNCX0hEQ1AyX1NUQVRVUwkJMHg2NjVC
NAorI2RlZmluZSBUUkFOU19IRENQMl9TVEFUVVModHJhbnMpCV9NTUlPX1RSQU5TKHRyYW5zLCBc
CisJCQkJCQkgICAgX1RSQU5TQV9IRENQMl9TVEFUVVMsIFwKKwkJCQkJCSAgICBfVFJBTlNCX0hE
Q1AyX1NUQVRVUykKICNkZWZpbmUgICBMSU5LX1RZUEVfU1RBVFVTCQlCSVQoMjIpCiAjZGVmaW5l
ICAgTElOS19BVVRIX1NUQVRVUwkJQklUKDIxKQogI2RlZmluZSAgIExJTktfRU5DUllQVElPTl9T
VEFUVVMJQklUKDIwKQorI2RlZmluZSBIRENQMl9TVEFUVVMoZGV2X3ByaXYsIHRyYW5zLCBwb3J0
KSBcCisJCQkJCShJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEyID8gXAorCQkJCQkgVFJBTlNfSERD
UDJfU1RBVFVTKHRyYW5zKSA6IFwKKwkJCQkJIFBPUlRfSERDUDJfU1RBVFVTKHBvcnQpKQogCiAv
KiBQZXItcGlwZSBEREkgRnVuY3Rpb24gQ29udHJvbCAqLwogI2RlZmluZSBfVFJBTlNfRERJX0ZV
TkNfQ1RMX0EJCTB4NjA0MDAKLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlz
dHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4v
bGlzdGluZm8vZHJpLWRldmVs
