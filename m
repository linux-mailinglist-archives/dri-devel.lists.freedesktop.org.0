Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id D628FDEFBD
	for <lists+dri-devel@lfdr.de>; Mon, 21 Oct 2019 16:35:27 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 203F76E132;
	Mon, 21 Oct 2019 14:35:23 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-wr1-x441.google.com (mail-wr1-x441.google.com
 [IPv6:2a00:1450:4864:20::441])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A67E96E12A
 for <dri-devel@lists.freedesktop.org>; Mon, 21 Oct 2019 14:35:18 +0000 (UTC)
Received: by mail-wr1-x441.google.com with SMTP id q13so9303308wrs.12
 for <dri-devel@lists.freedesktop.org>; Mon, 21 Oct 2019 07:35:18 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=iEgIQOiFRXnOhiFolzYE+VzbhmktK/jJYS1NZeyLjfU=;
 b=MZNsqgrCUnrxwNImXdWFBJ6yidXRtT8BqzWDNEIzxEyobd8POndpjKsBcQANFmL6+M
 CEvRZnaOkTzhhq9Q3LxabmcBiuP3L0sud8UxbkBSPK/meqxeaur54+oZFx0VtGIWc9TC
 sr00EtTfaj5XLV4xAKuemBA3gc/XwOp11mAoOKpmFJSmHnnx672GPXWwjPFXEwcbgG9Z
 l96zD3tFrY61CJFO8dcichVsV7rYZ6FExSzSfaiy07fNJX6Qj0sR/n0nYy/4bEg8sNwJ
 LupYSui1CeSNvudrSAl3tnYziCmA13vKlnWX4VHitNKi3RVFXhAc0ao9MI21Bv5vrGWl
 /4Ow==
X-Gm-Message-State: APjAAAVKW1zlO+h+xLDif37GS14LbgbvlmwMZ2VNy9rgA+k+l3PRZuZD
 mtJatcHZJId61+WYbabGRLMEzszf
X-Google-Smtp-Source: APXvYqzJMm2bnWlZgrPToMsZNsvUBrDacdnomb7x6Ud2KLzgqmADbCfaHZz/xinBF3CMSAzmkyC/8g==
X-Received: by 2002:adf:c409:: with SMTP id v9mr6372267wrf.41.1571668515999;
 Mon, 21 Oct 2019 07:35:15 -0700 (PDT)
Received: from localhost (p2E5BE2CE.dip0.t-ipconnect.de. [46.91.226.206])
 by smtp.gmail.com with ESMTPSA id q22sm13185890wmj.5.2019.10.21.07.35.14
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 21 Oct 2019 07:35:14 -0700 (PDT)
From: Thierry Reding <thierry.reding@gmail.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v3 11/13] drm/msm: edp: Avoid drm_dp_link helpers
Date: Mon, 21 Oct 2019 16:34:35 +0200
Message-Id: <20191021143437.1477719-12-thierry.reding@gmail.com>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191021143437.1477719-1-thierry.reding@gmail.com>
References: <20191021143437.1477719-1-thierry.reding@gmail.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=iEgIQOiFRXnOhiFolzYE+VzbhmktK/jJYS1NZeyLjfU=;
 b=NncW5i535yOHUqU9iyC1tqeWMjgAuE/WX0V36Uv02rRjAv57qVY8+pbDXrui7Mej3U
 +tmpMxmx3G7pqOfggOOzitlSA/bpy1grCz325za947y3IPj2cmpUJxJSXHuGSiNIvzyS
 naWHMAu6X+JADMguCz3R1w/vMsz2qsfpHtXzFygI+5SEDls140XGGzphvVq/AlpULRxy
 WktvXt5AZjIFMOYZxVATQZLo+CAnX5NmPuQ0Q6IraRB/Y8ox6Qr5AuOO9UQAcgu0107p
 dd05YgXzmFafvpouKnSi0sdMYF+JI3WiM+5mxSw1ciMonJJiNessMb59T/eNpFxHVolT
 Vojw==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogVGhpZXJyeSBSZWRpbmcgPHRyZWRpbmdAbnZpZGlhLmNvbT4KCkR1cmluZyB0aGUgZGlz
Y3Vzc2lvbiBvZiBwYXRjaGVzIHRoYXQgZW5oYW5jZSB0aGUgZHJtX2RwX2xpbmsgaGVscGVycyBp
dAp3YXMgY29uY2x1ZGVkIHRoYXQgdGhlc2UgaGVscGVycyBhcmVuJ3QgdmVyeSB1c2VmdWwgdG8g
YmVnaW4gd2l0aC4gU3RhcnQKcHVzaGluZyB0aGUgZXF1aXZhbGVudCBjb2RlIGludG8gaW5kaXZp
ZHVhbCBkcml2ZXJzIHRvIHVsdGltYXRlbHkgcmVtb3ZlCnRoZW0uCgpTaWduZWQtb2ZmLWJ5OiBU
aGllcnJ5IFJlZGluZyA8dHJlZGluZ0BudmlkaWEuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9t
c20vZWRwL2VkcF9jdHJsLmMgfCA3MCArKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0KIDEg
ZmlsZSBjaGFuZ2VkLCA0OSBpbnNlcnRpb25zKCspLCAyMSBkZWxldGlvbnMoLSkKCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vbXNtL2VkcC9lZHBfY3RybC5jIGIvZHJpdmVycy9ncHUvZHJt
L21zbS9lZHAvZWRwX2N0cmwuYwppbmRleCA3ZjNkZDNmZmUyYzkuLjBkOTY1N2NjNzBkYiAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL21zbS9lZHAvZWRwX2N0cmwuYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vbXNtL2VkcC9lZHBfY3RybC5jCkBAIC04OSw3ICs4OSw2IEBAIHN0cnVjdCBlZHBf
Y3RybCB7CiAJLyogZWRpZCByYXcgZGF0YSAqLwogCXN0cnVjdCBlZGlkICplZGlkOwogCi0Jc3Ry
dWN0IGRybV9kcF9saW5rIGRwX2xpbms7CiAJc3RydWN0IGRybV9kcF9hdXggKmRybV9hdXg7CiAK
IAkvKiBkcGNkIHJhdyBkYXRhICovCkBAIC00MDMsNyArNDAyLDcgQEAgc3RhdGljIHZvaWQgZWRw
X2ZpbGxfbGlua19jZmcoc3RydWN0IGVkcF9jdHJsICpjdHJsKQogCXUzMiBwcmF0ZTsKIAl1MzIg
bHJhdGU7CiAJdTMyIGJwcDsKLQl1OCBtYXhfbGFuZSA9IGN0cmwtPmRwX2xpbmsubnVtX2xhbmVz
OworCXU4IG1heF9sYW5lID0gZHJtX2RwX21heF9sYW5lX2NvdW50KGN0cmwtPmRwY2QpOwogCXU4
IGxhbmU7CiAKIAlwcmF0ZSA9IGN0cmwtPnBpeGVsX3JhdGU7CkBAIC00MTMsNyArNDEyLDcgQEAg
c3RhdGljIHZvaWQgZWRwX2ZpbGxfbGlua19jZmcoc3RydWN0IGVkcF9jdHJsICpjdHJsKQogCSAq
IEJ5IGRlZmF1bHQsIHVzZSB0aGUgbWF4aW11bSBsaW5rIHJhdGUgYW5kIG1pbmltdW0gbGFuZSBj
b3VudCwKIAkgKiBzbyB0aGF0IHdlIGNhbiBkbyByYXRlIGRvd24gc2hpZnQgZHVyaW5nIGxpbmsg
dHJhaW5pbmcuCiAJICovCi0JY3RybC0+bGlua19yYXRlID0gZHJtX2RwX2xpbmtfcmF0ZV90b19i
d19jb2RlKGN0cmwtPmRwX2xpbmsucmF0ZSk7CisJY3RybC0+bGlua19yYXRlID0gY3RybC0+ZHBj
ZFtEUF9NQVhfTElOS19SQVRFXTsKIAogCXByYXRlICo9IGJwcDsKIAlwcmF0ZSAvPSA4OyAvKiBp
biBrQnl0ZSAqLwpAQCAtNDM5LDcgKzQzOCw3IEBAIHN0YXRpYyB2b2lkIGVkcF9jb25maWdfY3Ry
bChzdHJ1Y3QgZWRwX2N0cmwgKmN0cmwpCiAKIAlkYXRhID0gRURQX0NPTkZJR1VSQVRJT05fQ1RS
TF9MQU5FUyhjdHJsLT5sYW5lX2NudCAtIDEpOwogCi0JaWYgKGN0cmwtPmRwX2xpbmsuY2FwYWJp
bGl0aWVzICYgRFBfTElOS19DQVBfRU5IQU5DRURfRlJBTUlORykKKwlpZiAoZHJtX2RwX2VuaGFu
Y2VkX2ZyYW1lX2NhcChjdHJsLT5kcGNkKSkKIAkJZGF0YSB8PSBFRFBfQ09ORklHVVJBVElPTl9D
VFJMX0VOSEFOQ0VEX0ZSQU1JTkc7CiAKIAlkZXB0aCA9IEVEUF82QklUOwpAQCAtNzAxLDcgKzcw
MCw3IEBAIHN0YXRpYyBpbnQgZWRwX2xpbmtfcmF0ZV9kb3duX3NoaWZ0KHN0cnVjdCBlZHBfY3Ry
bCAqY3RybCkKIAogCXJhdGUgPSBjdHJsLT5saW5rX3JhdGU7CiAJbGFuZSA9IGN0cmwtPmxhbmVf
Y250OwotCW1heF9sYW5lID0gY3RybC0+ZHBfbGluay5udW1fbGFuZXM7CisJbWF4X2xhbmUgPSBk
cm1fZHBfbWF4X2xhbmVfY291bnQoY3RybC0+ZHBjZCk7CiAKIAlicHAgPSBjdHJsLT5jb2xvcl9k
ZXB0aCAqIDM7CiAJcHJhdGUgPSBjdHJsLT5waXhlbF9yYXRlOwpAQCAtNzUxLDE4ICs3NTAsMjIg
QEAgc3RhdGljIGludCBlZHBfY2xlYXJfdHJhaW5pbmdfcGF0dGVybihzdHJ1Y3QgZWRwX2N0cmwg
KmN0cmwpCiAKIHN0YXRpYyBpbnQgZWRwX2RvX2xpbmtfdHJhaW4oc3RydWN0IGVkcF9jdHJsICpj
dHJsKQogeworCXU4IHZhbHVlc1syXTsKIAlpbnQgcmV0OwotCXN0cnVjdCBkcm1fZHBfbGluayBk
cF9saW5rOwogCiAJREJHKCIiKTsKIAkvKgogCSAqIFNldCB0aGUgY3VycmVudCBsaW5rIHJhdGUg
YW5kIGxhbmUgY250IHRvIHBhbmVsLiBUaGV5IG1heSBoYXZlIGJlZW4KIAkgKiBhZGp1c3RlZCBh
bmQgdGhlIHZhbHVlcyBhcmUgZGlmZmVyZW50IGZyb20gdGhlbSBpbiBEUENEIENBUAogCSAqLwot
CWRwX2xpbmsubnVtX2xhbmVzID0gY3RybC0+bGFuZV9jbnQ7Ci0JZHBfbGluay5yYXRlID0gZHJt
X2RwX2J3X2NvZGVfdG9fbGlua19yYXRlKGN0cmwtPmxpbmtfcmF0ZSk7Ci0JZHBfbGluay5jYXBh
YmlsaXRpZXMgPSBjdHJsLT5kcF9saW5rLmNhcGFiaWxpdGllczsKLQlpZiAoZHJtX2RwX2xpbmtf
Y29uZmlndXJlKGN0cmwtPmRybV9hdXgsICZkcF9saW5rKSA8IDApCisJdmFsdWVzWzBdID0gY3Ry
bC0+bGFuZV9jbnQ7CisJdmFsdWVzWzFdID0gY3RybC0+bGlua19yYXRlOworCisJaWYgKGRybV9k
cF9lbmhhbmNlZF9mcmFtZV9jYXAoY3RybC0+ZHBjZCkpCisJCXZhbHVlc1sxXSB8PSBEUF9MQU5F
X0NPVU5UX0VOSEFOQ0VEX0ZSQU1FX0VOOworCisJaWYgKGRybV9kcF9kcGNkX3dyaXRlKGN0cmwt
PmRybV9hdXgsIERQX0xJTktfQldfU0VULCB2YWx1ZXMsCisJCQkgICAgICBzaXplb2YodmFsdWVz
KSkgPCAwKQogCQlyZXR1cm4gRURQX1RSQUlOX0ZBSUw7CiAKIAljdHJsLT52X2xldmVsID0gMDsg
Lyogc3RhcnQgZnJvbSBkZWZhdWx0IGxldmVsICovCkBAIC05NTIsNiArOTU1LDcgQEAgc3RhdGlj
IHZvaWQgZWRwX2N0cmxfb25fd29ya2VyKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKIHsKIAlz
dHJ1Y3QgZWRwX2N0cmwgKmN0cmwgPSBjb250YWluZXJfb2YoCiAJCQkJd29yaywgc3RydWN0IGVk
cF9jdHJsLCBvbl93b3JrKTsKKwl1OCB2YWx1ZTsKIAlpbnQgcmV0OwogCiAJbXV0ZXhfbG9jaygm
Y3RybC0+ZGV2X211dGV4KTsKQEAgLTk2NSw5ICs5NjksMjcgQEAgc3RhdGljIHZvaWQgZWRwX2N0
cmxfb25fd29ya2VyKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKIAllZHBfY3RybF9saW5rX2Vu
YWJsZShjdHJsLCAxKTsKIAogCWVkcF9jdHJsX2lycV9lbmFibGUoY3RybCwgMSk7Ci0JcmV0ID0g
ZHJtX2RwX2xpbmtfcG93ZXJfdXAoY3RybC0+ZHJtX2F1eCwgJmN0cmwtPmRwX2xpbmspOwotCWlm
IChyZXQpCi0JCWdvdG8gZmFpbDsKKworCS8qIERQX1NFVF9QT1dFUiByZWdpc3RlciBpcyBvbmx5
IGF2YWlsYWJsZSBvbiBEUENEIHYxLjEgYW5kIGxhdGVyICovCisJaWYgKGN0cmwtPmRwY2RbRFBf
RFBDRF9SRVZdID49IDB4MTEpIHsKKwkJcmV0ID0gZHJtX2RwX2RwY2RfcmVhZGIoY3RybC0+ZHJt
X2F1eCwgRFBfU0VUX1BPV0VSLCAmdmFsdWUpOworCQlpZiAocmV0IDwgMCkKKwkJCWdvdG8gZmFp
bDsKKworCQl2YWx1ZSAmPSB+RFBfU0VUX1BPV0VSX01BU0s7CisJCXZhbHVlIHw9IERQX1NFVF9Q
T1dFUl9EMDsKKworCQlyZXQgPSBkcm1fZHBfZHBjZF93cml0ZWIoY3RybC0+ZHJtX2F1eCwgRFBf
U0VUX1BPV0VSLCB2YWx1ZSk7CisJCWlmIChyZXQgPCAwKQorCQkJZ290byBmYWlsOworCisJCS8q
CisJCSAqIEFjY29yZGluZyB0byB0aGUgRFAgMS4xIHNwZWNpZmljYXRpb24sIGEgIlNpbmsgRGV2
aWNlIG11c3QKKwkJICogZXhpdCB0aGUgcG93ZXIgc2F2aW5nIHN0YXRlIHdpdGhpbiAxIG1zIiAo
U2VjdGlvbiAyLjUuMy4xLAorCQkgKiBUYWJsZSA1LTUyLCAiU2luayBDb250cm9sIEZpZWxkIiAo
cmVnaXN0ZXIgMHg2MDApLgorCQkgKi8KKwkJdXNsZWVwX3JhbmdlKDEwMDAsIDIwMDApOworCX0K
IAogCWN0cmwtPnBvd2VyX29uID0gdHJ1ZTsKIApAQCAtMTAxMSw3ICsxMDMzLDE5IEBAIHN0YXRp
YyB2b2lkIGVkcF9jdHJsX29mZl93b3JrZXIoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQogCiAJ
ZWRwX3N0YXRlX2N0cmwoY3RybCwgMCk7CiAKLQlkcm1fZHBfbGlua19wb3dlcl9kb3duKGN0cmwt
PmRybV9hdXgsICZjdHJsLT5kcF9saW5rKTsKKwkvKiBEUF9TRVRfUE9XRVIgcmVnaXN0ZXIgaXMg
b25seSBhdmFpbGFibGUgb24gRFBDRCB2MS4xIGFuZCBsYXRlciAqLworCWlmIChjdHJsLT5kcGNk
W0RQX0RQQ0RfUkVWXSA+PSAweDExKSB7CisJCXU4IHZhbHVlOworCQlpbnQgcmV0OworCisJCXJl
dCA9IGRybV9kcF9kcGNkX3JlYWRiKGN0cmwtPmRybV9hdXgsIERQX1NFVF9QT1dFUiwgJnZhbHVl
KTsKKwkJaWYgKHJldCA+IDApIHsKKwkJCXZhbHVlICY9IH5EUF9TRVRfUE9XRVJfTUFTSzsKKwkJ
CXZhbHVlIHw9IERQX1NFVF9QT1dFUl9EMzsKKworCQkJZHJtX2RwX2RwY2Rfd3JpdGViKGN0cmwt
PmRybV9hdXgsIERQX1NFVF9QT1dFUiwgdmFsdWUpOworCQl9CisJfQogCiAJZWRwX2N0cmxfaXJx
X2VuYWJsZShjdHJsLCAwKTsKIApAQCAtMTIyNSwxNCArMTI1OSw4IEBAIGludCBtc21fZWRwX2N0
cmxfZ2V0X3BhbmVsX2luZm8oc3RydWN0IGVkcF9jdHJsICpjdHJsLAogCQllZHBfY3RybF9pcnFf
ZW5hYmxlKGN0cmwsIDEpOwogCX0KIAotCXJldCA9IGRybV9kcF9saW5rX3Byb2JlKGN0cmwtPmRy
bV9hdXgsICZjdHJsLT5kcF9saW5rKTsKLQlpZiAocmV0KSB7Ci0JCXByX2VycigiJXM6IHJlYWQg
ZHBjZCBjYXAgZmFpbGVkLCAlZFxuIiwgX19mdW5jX18sIHJldCk7Ci0JCWdvdG8gZGlzYWJsZV9y
ZXQ7Ci0JfQotCiAJLyogSW5pdGlhbGl6ZSBsaW5rIHJhdGUgYXMgcGFuZWwgbWF4IGxpbmsgcmF0
ZSAqLwotCWN0cmwtPmxpbmtfcmF0ZSA9IGRybV9kcF9saW5rX3JhdGVfdG9fYndfY29kZShjdHJs
LT5kcF9saW5rLnJhdGUpOworCWN0cmwtPmxpbmtfcmF0ZSA9IGN0cmwtPmRwY2RbRFBfTUFYX0xJ
TktfUkFURV07CiAKIAljdHJsLT5lZGlkID0gZHJtX2dldF9lZGlkKGNvbm5lY3RvciwgJmN0cmwt
PmRybV9hdXgtPmRkYyk7CiAJaWYgKCFjdHJsLT5lZGlkKSB7Ci0tIAoyLjIzLjAKCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5n
IGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVk
ZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
