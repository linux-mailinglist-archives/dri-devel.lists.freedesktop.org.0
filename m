Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 284984B2E1
	for <lists+dri-devel@lfdr.de>; Wed, 19 Jun 2019 09:12:30 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 981E66E2F6;
	Wed, 19 Jun 2019 07:11:44 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from onstation.org (onstation.org [52.200.56.107])
 by gabe.freedesktop.org (Postfix) with ESMTPS id CDF446E282;
 Wed, 19 Jun 2019 02:32:14 +0000 (UTC)
Received: from localhost.localdomain (c-98-239-145-235.hsd1.wv.comcast.net
 [98.239.145.235])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested) (Authenticated sender: masneyb)
 by onstation.org (Postfix) with ESMTPSA id C43423EA0C;
 Wed, 19 Jun 2019 02:32:13 +0000 (UTC)
From: Brian Masney <masneyb@onstation.org>
To: bjorn.andersson@linaro.org, agross@kernel.org, david.brown@linaro.org,
 robdclark@gmail.com, sean@poorly.run, robh+dt@kernel.org
Subject: [PATCH v2 3/6] firmware: qcom: scm: add OCMEM lock/unlock interface
Date: Tue, 18 Jun 2019 22:32:06 -0400
Message-Id: <20190619023209.10036-4-masneyb@onstation.org>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190619023209.10036-1-masneyb@onstation.org>
References: <20190619023209.10036-1-masneyb@onstation.org>
MIME-Version: 1.0
X-Mailman-Approved-At: Wed, 19 Jun 2019 07:10:14 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=onstation.org; s=default; t=1560911534;
 bh=m+FjFG/O2+MtKXdWsou3HV7U4Yd6HH276SCkzTon7/w=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=Y7NUoMc2caX/QxxoMDR4ZMBHT3uEIT20W7mDzY43a2HkV9VWzNGkJ95sNrs4dG8u+
 +AjqoRgupBpuDwQDhAI7WJHkmuW7ZQVBmK7dHKMWk4nsFkLkQsGEB8POaQy2H5xvjU
 Xf/MXphxoedf+cuOvmSU54FZLBZYfLM76EVIJidA=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: mark.rutland@arm.com, devicetree@vger.kernel.org, jonathan@marek.ca,
 airlied@linux.ie, linux-arm-msm@vger.kernel.org, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, freedreno@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogUm9iIENsYXJrIDxyb2JkY2xhcmtAZ21haWwuY29tPgoKQWRkIHN1cHBvcnQgZm9yIHRo
ZSBPQ01FTSBsb2NrL3VubG9jayBpbnRlcmZhY2UgdGhhdCBpcyBuZWVkZWQgYnkgdGhlCk9uIENo
aXAgTUVNb3J5IChPQ01FTSkgdGhhdCBpcyBwcmVzZW50IG9uIHNvbWUgU25hcGRyYWdvbiBkZXZp
Y2VzLgoKU2lnbmVkLW9mZi1ieTogUm9iIENsYXJrIDxyb2JkY2xhcmtAZ21haWwuY29tPgpbbWFz
bmV5YkBvbnN0YXRpb24ub3JnOiBwb3J0ZWQgdG8gbGF0ZXN0IGtlcm5lbDsgbWlub3IgcmVmb3Jt
YXR0aW5nLl0KU2lnbmVkLW9mZi1ieTogQnJpYW4gTWFzbmV5IDxtYXNuZXliQG9uc3RhdGlvbi5v
cmc+ClJldmlld2VkLWJ5OiBCam9ybiBBbmRlcnNzb24gPGJqb3JuLmFuZGVyc3NvbkBsaW5hcm8u
b3JnPgotLS0KUm9iJ3MgbGFzdCB2ZXJzaW9uIG9mIHRoaXMgcGF0Y2g6Cmh0dHBzOi8vcGF0Y2h3
b3JrLmtlcm5lbC5vcmcvcGF0Y2gvNzM0MDcxMS8KCkNoYW5nZXMgc2luY2UgdjE6Ci0gTm9uZQoK
IGRyaXZlcnMvZmlybXdhcmUvcWNvbV9zY20tMzIuYyB8IDM1ICsrKysrKysrKysrKysrKysrKysr
KysrKysrKysrCiBkcml2ZXJzL2Zpcm13YXJlL3Fjb21fc2NtLTY0LmMgfCAxMiArKysrKysrKysr
CiBkcml2ZXJzL2Zpcm13YXJlL3Fjb21fc2NtLmMgICAgfCA0MCArKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrCiBkcml2ZXJzL2Zpcm13YXJlL3Fjb21fc2NtLmggICAgfCAgOSArKysr
KysrKwogaW5jbHVkZS9saW51eC9xY29tX3NjbS5oICAgICAgIHwgMTUgKysrKysrKysrKysrKwog
NSBmaWxlcyBjaGFuZ2VkLCAxMTEgaW5zZXJ0aW9ucygrKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
ZmlybXdhcmUvcWNvbV9zY20tMzIuYyBiL2RyaXZlcnMvZmlybXdhcmUvcWNvbV9zY20tMzIuYwpp
bmRleCAyMTUwNjFjNTgxZTEuLjRjMjUxNGU1ZTI0OSAxMDA2NDQKLS0tIGEvZHJpdmVycy9maXJt
d2FyZS9xY29tX3NjbS0zMi5jCisrKyBiL2RyaXZlcnMvZmlybXdhcmUvcWNvbV9zY20tMzIuYwpA
QCAtNDQyLDYgKzQ0Miw0MSBAQCBpbnQgX19xY29tX3NjbV9oZGNwX3JlcShzdHJ1Y3QgZGV2aWNl
ICpkZXYsIHN0cnVjdCBxY29tX3NjbV9oZGNwX3JlcSAqcmVxLAogCQlyZXEsIHJlcV9jbnQgKiBz
aXplb2YoKnJlcSksIHJlc3AsIHNpemVvZigqcmVzcCkpOwogfQogCitpbnQgX19xY29tX3NjbV9v
Y21lbV9sb2NrKHN0cnVjdCBkZXZpY2UgKmRldiwgdTMyIGlkLCB1MzIgb2Zmc2V0LCB1MzIgc2l6
ZSwKKwkJCSAgdTMyIG1vZGUpCit7CisJc3RydWN0IG9jbWVtX3R6X2xvY2sgeworCQlfX2xlMzIg
aWQ7CisJCV9fbGUzMiBvZmZzZXQ7CisJCV9fbGUzMiBzaXplOworCQlfX2xlMzIgbW9kZTsKKwl9
IHJlcXVlc3Q7CisKKwlyZXF1ZXN0LmlkID0gY3B1X3RvX2xlMzIoaWQpOworCXJlcXVlc3Qub2Zm
c2V0ID0gY3B1X3RvX2xlMzIob2Zmc2V0KTsKKwlyZXF1ZXN0LnNpemUgPSBjcHVfdG9fbGUzMihz
aXplKTsKKwlyZXF1ZXN0Lm1vZGUgPSBjcHVfdG9fbGUzMihtb2RlKTsKKworCXJldHVybiBxY29t
X3NjbV9jYWxsKGRldiwgUUNPTV9TQ01fT0NNRU1fU1ZDLCBRQ09NX1NDTV9PQ01FTV9MT0NLX0NN
RCwKKwkJCSAgICAgJnJlcXVlc3QsIHNpemVvZihyZXF1ZXN0KSwgTlVMTCwgMCk7Cit9CisKK2lu
dCBfX3Fjb21fc2NtX29jbWVtX3VubG9jayhzdHJ1Y3QgZGV2aWNlICpkZXYsIHUzMiBpZCwgdTMy
IG9mZnNldCwgdTMyIHNpemUpCit7CisJc3RydWN0IG9jbWVtX3R6X3VubG9jayB7CisJCV9fbGUz
MiBpZDsKKwkJX19sZTMyIG9mZnNldDsKKwkJX19sZTMyIHNpemU7CisJfSByZXF1ZXN0OworCisJ
cmVxdWVzdC5pZCA9IGNwdV90b19sZTMyKGlkKTsKKwlyZXF1ZXN0Lm9mZnNldCA9IGNwdV90b19s
ZTMyKG9mZnNldCk7CisJcmVxdWVzdC5zaXplID0gY3B1X3RvX2xlMzIoc2l6ZSk7CisKKwlyZXR1
cm4gcWNvbV9zY21fY2FsbChkZXYsIFFDT01fU0NNX09DTUVNX1NWQywgUUNPTV9TQ01fT0NNRU1f
VU5MT0NLX0NNRCwKKwkJCSAgICAgJnJlcXVlc3QsIHNpemVvZihyZXF1ZXN0KSwgTlVMTCwgMCk7
Cit9CisKIHZvaWQgX19xY29tX3NjbV9pbml0KHZvaWQpCiB7CiB9CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2Zpcm13YXJlL3Fjb21fc2NtLTY0LmMgYi9kcml2ZXJzL2Zpcm13YXJlL3Fjb21fc2NtLTY0
LmMKaW5kZXggOTFkNWFkN2NmNThiLi5jM2EzZDk4NzRkZWYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
ZmlybXdhcmUvcWNvbV9zY20tNjQuYworKysgYi9kcml2ZXJzL2Zpcm13YXJlL3Fjb21fc2NtLTY0
LmMKQEAgLTI0MSw2ICsyNDEsMTggQEAgaW50IF9fcWNvbV9zY21faGRjcF9yZXEoc3RydWN0IGRl
dmljZSAqZGV2LCBzdHJ1Y3QgcWNvbV9zY21faGRjcF9yZXEgKnJlcSwKIAlyZXR1cm4gcmV0Owog
fQogCitpbnQgX19xY29tX3NjbV9vY21lbV9sb2NrKHN0cnVjdCBkZXZpY2UgKmRldiwgdWludDMy
X3QgaWQsIHVpbnQzMl90IG9mZnNldCwKKwkJCSAgdWludDMyX3Qgc2l6ZSwgdWludDMyX3QgbW9k
ZSkKK3sKKwlyZXR1cm4gLUVOT1RTVVBQOworfQorCitpbnQgX19xY29tX3NjbV9vY21lbV91bmxv
Y2soc3RydWN0IGRldmljZSAqZGV2LCB1aW50MzJfdCBpZCwgdWludDMyX3Qgb2Zmc2V0LAorCQkJ
ICAgIHVpbnQzMl90IHNpemUpCit7CisJcmV0dXJuIC1FTk9UU1VQUDsKK30KKwogdm9pZCBfX3Fj
b21fc2NtX2luaXQodm9pZCkKIHsKIAl1NjQgY21kOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9maXJt
d2FyZS9xY29tX3NjbS5jIGIvZHJpdmVycy9maXJtd2FyZS9xY29tX3NjbS5jCmluZGV4IDJkZGMx
MThkYmExYi4uMmUxMmVhNTZjMzRjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2Zpcm13YXJlL3Fjb21f
c2NtLmMKKysrIGIvZHJpdmVycy9maXJtd2FyZS9xY29tX3NjbS5jCkBAIC0xOTAsNiArMTkwLDQ2
IEBAIGJvb2wgcWNvbV9zY21fcGFzX3N1cHBvcnRlZCh1MzIgcGVyaXBoZXJhbCkKIH0KIEVYUE9S
VF9TWU1CT0wocWNvbV9zY21fcGFzX3N1cHBvcnRlZCk7CiAKKy8qKgorICogcWNvbV9zY21fb2Nt
ZW1fbG9ja19hdmFpbGFibGUoKSAtIGlzIE9DTUVNIGxvY2svdW5sb2NrIGludGVyZmFjZSBhdmFp
bGFibGUKKyAqLworYm9vbCBxY29tX3NjbV9vY21lbV9sb2NrX2F2YWlsYWJsZSh2b2lkKQorewor
CXJldHVybiBfX3Fjb21fc2NtX2lzX2NhbGxfYXZhaWxhYmxlKF9fc2NtLT5kZXYsIFFDT01fU0NN
X09DTUVNX1NWQywKKwkJCQkJICAgIFFDT01fU0NNX09DTUVNX0xPQ0tfQ01EKTsKK30KK0VYUE9S
VF9TWU1CT0wocWNvbV9zY21fb2NtZW1fbG9ja19hdmFpbGFibGUpOworCisvKioKKyAqIHFjb21f
c2NtX29jbWVtX2xvY2soKSAtIGNhbGwgT0NNRU0gbG9jayBpbnRlcmZhY2UgdG8gYXNzaWduIGFu
IE9DTUVNCisgKiByZWdpb24gdG8gdGhlIHNwZWNpZmllZCBpbml0aWF0b3IKKyAqCisgKiBAaWQ6
ICAgICB0eiBpbml0aWF0b3IgaWQKKyAqIEBvZmZzZXQ6IE9DTUVNIG9mZnNldAorICogQHNpemU6
ICAgT0NNRU0gc2l6ZQorICogQG1vZGU6ICAgYWNjZXNzIG1vZGUgKFdJREUvTkFSUk9XKQorICov
CitpbnQgcWNvbV9zY21fb2NtZW1fbG9jayhlbnVtIHFjb21fc2NtX29jbWVtX2NsaWVudCBpZCwg
dTMyIG9mZnNldCwgdTMyIHNpemUsCisJCQl1MzIgbW9kZSkKK3sKKwlyZXR1cm4gX19xY29tX3Nj
bV9vY21lbV9sb2NrKF9fc2NtLT5kZXYsIGlkLCBvZmZzZXQsIHNpemUsIG1vZGUpOworfQorRVhQ
T1JUX1NZTUJPTChxY29tX3NjbV9vY21lbV9sb2NrKTsKKworLyoqCisgKiBxY29tX3NjbV9vY21l
bV91bmxvY2soKSAtIGNhbGwgT0NNRU0gdW5sb2NrIGludGVyZmFjZSB0byByZWxlYXNlIGFuIE9D
TUVNCisgKiByZWdpb24gZnJvbSB0aGUgc3BlY2lmaWVkIGluaXRpYXRvcgorICoKKyAqIEBpZDog
ICAgIHR6IGluaXRpYXRvciBpZAorICogQG9mZnNldDogT0NNRU0gb2Zmc2V0CisgKiBAc2l6ZTog
ICBPQ01FTSBzaXplCisgKi8KK2ludCBxY29tX3NjbV9vY21lbV91bmxvY2soZW51bSBxY29tX3Nj
bV9vY21lbV9jbGllbnQgaWQsIHUzMiBvZmZzZXQsIHUzMiBzaXplKQoreworCXJldHVybiBfX3Fj
b21fc2NtX29jbWVtX3VubG9jayhfX3NjbS0+ZGV2LCBpZCwgb2Zmc2V0LCBzaXplKTsKK30KK0VY
UE9SVF9TWU1CT0wocWNvbV9zY21fb2NtZW1fdW5sb2NrKTsKKwogLyoqCiAgKiBxY29tX3NjbV9w
YXNfaW5pdF9pbWFnZSgpIC0gSW5pdGlhbGl6ZSBwZXJpcGhlcmFsIGF1dGhlbnRpY2F0aW9uIHNl
cnZpY2UKICAqCQkJICAgICAgIHN0YXRlIG1hY2hpbmUgZm9yIGEgZ2l2ZW4gcGVyaXBoZXJhbCwg
dXNpbmcgdGhlCmRpZmYgLS1naXQgYS9kcml2ZXJzL2Zpcm13YXJlL3Fjb21fc2NtLmggYi9kcml2
ZXJzL2Zpcm13YXJlL3Fjb21fc2NtLmgKaW5kZXggOTk1MDZiZDg3M2MwLi5lZjI5M2VlNjdlYzEg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZmlybXdhcmUvcWNvbV9zY20uaAorKysgYi9kcml2ZXJzL2Zp
cm13YXJlL3Fjb21fc2NtLmgKQEAgLTQyLDYgKzQyLDE1IEBAIGV4dGVybiBpbnQgX19xY29tX3Nj
bV9oZGNwX3JlcShzdHJ1Y3QgZGV2aWNlICpkZXYsCiAKIGV4dGVybiB2b2lkIF9fcWNvbV9zY21f
aW5pdCh2b2lkKTsKIAorI2RlZmluZSBRQ09NX1NDTV9PQ01FTV9TVkMJCQkweGYKKyNkZWZpbmUg
UUNPTV9TQ01fT0NNRU1fTE9DS19DTUQJCTB4MQorI2RlZmluZSBRQ09NX1NDTV9PQ01FTV9VTkxP
Q0tfQ01ECQkweDIKKworZXh0ZXJuIGludCBfX3Fjb21fc2NtX29jbWVtX2xvY2soc3RydWN0IGRl
dmljZSAqZGV2LCB1MzIgaWQsIHUzMiBvZmZzZXQsCisJCQkJIHUzMiBzaXplLCB1MzIgbW9kZSk7
CitleHRlcm4gaW50IF9fcWNvbV9zY21fb2NtZW1fdW5sb2NrKHN0cnVjdCBkZXZpY2UgKmRldiwg
dTMyIGlkLCB1MzIgb2Zmc2V0LAorCQkJCSAgIHUzMiBzaXplKTsKKwogI2RlZmluZSBRQ09NX1ND
TV9TVkNfUElMCQkweDIKICNkZWZpbmUgUUNPTV9TQ01fUEFTX0lOSVRfSU1BR0VfQ01ECTB4MQog
I2RlZmluZSBRQ09NX1NDTV9QQVNfTUVNX1NFVFVQX0NNRAkweDIKZGlmZiAtLWdpdCBhL2luY2x1
ZGUvbGludXgvcWNvbV9zY20uaCBiL2luY2x1ZGUvbGludXgvcWNvbV9zY20uaAppbmRleCAzZjEy
Y2M3N2ZiNTguLjUyMWIwODliZTFjOSAxMDA2NDQKLS0tIGEvaW5jbHVkZS9saW51eC9xY29tX3Nj
bS5oCisrKyBiL2luY2x1ZGUvbGludXgvcWNvbV9zY20uaApAQCAtMjQsNiArMjQsMTYgQEAgc3Ry
dWN0IHFjb21fc2NtX3ZtcGVybSB7CiAJaW50IHBlcm07CiB9OwogCitlbnVtIHFjb21fc2NtX29j
bWVtX2NsaWVudCB7CisJUUNPTV9TQ01fT0NNRU1fVU5VU0VEX0lEID0gMHgwLAorCVFDT01fU0NN
X09DTUVNX0dSQVBISUNTX0lELAorCVFDT01fU0NNX09DTUVNX1ZJREVPX0lELAorCVFDT01fU0NN
X09DTUVNX0xQX0FVRElPX0lELAorCVFDT01fU0NNX09DTUVNX1NFTlNPUlNfSUQsCisJUUNPTV9T
Q01fT0NNRU1fT1RIRVJfT1NfSUQsCisJUUNPTV9TQ01fT0NNRU1fREVCVUdfSUQsCit9OworCiAj
ZGVmaW5lIFFDT01fU0NNX1ZNSURfSExPUyAgICAgICAweDMKICNkZWZpbmUgUUNPTV9TQ01fVk1J
RF9NU1NfTVNBICAgIDB4RgogI2RlZmluZSBRQ09NX1NDTV9WTUlEX1dMQU4gICAgICAgMHgxOApA
QCAtNDEsNiArNTEsMTEgQEAgZXh0ZXJuIGJvb2wgcWNvbV9zY21faXNfYXZhaWxhYmxlKHZvaWQp
OwogZXh0ZXJuIGJvb2wgcWNvbV9zY21faGRjcF9hdmFpbGFibGUodm9pZCk7CiBleHRlcm4gaW50
IHFjb21fc2NtX2hkY3BfcmVxKHN0cnVjdCBxY29tX3NjbV9oZGNwX3JlcSAqcmVxLCB1MzIgcmVx
X2NudCwKIAkJCSAgICAgdTMyICpyZXNwKTsKK2V4dGVybiBib29sIHFjb21fc2NtX29jbWVtX2xv
Y2tfYXZhaWxhYmxlKHZvaWQpOworZXh0ZXJuIGludCBxY29tX3NjbV9vY21lbV9sb2NrKGVudW0g
cWNvbV9zY21fb2NtZW1fY2xpZW50IGlkLCB1MzIgb2Zmc2V0LAorCQkJICAgICAgIHUzMiBzaXpl
LCB1MzIgbW9kZSk7CitleHRlcm4gaW50IHFjb21fc2NtX29jbWVtX3VubG9jayhlbnVtIHFjb21f
c2NtX29jbWVtX2NsaWVudCBpZCwgdTMyIG9mZnNldCwKKwkJCQkgdTMyIHNpemUpOwogZXh0ZXJu
IGJvb2wgcWNvbV9zY21fcGFzX3N1cHBvcnRlZCh1MzIgcGVyaXBoZXJhbCk7CiBleHRlcm4gaW50
IHFjb21fc2NtX3Bhc19pbml0X2ltYWdlKHUzMiBwZXJpcGhlcmFsLCBjb25zdCB2b2lkICptZXRh
ZGF0YSwKIAkJCQkgICBzaXplX3Qgc2l6ZSk7Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJp
LWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9y
Zy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
