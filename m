Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id C2CE6178E98
	for <lists+dri-devel@lfdr.de>; Wed,  4 Mar 2020 11:41:17 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F0B0E6E41F;
	Wed,  4 Mar 2020 10:41:08 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-wr1-x441.google.com (mail-wr1-x441.google.com
 [IPv6:2a00:1450:4864:20::441])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8E1156E41F
 for <dri-devel@lists.freedesktop.org>; Wed,  4 Mar 2020 10:41:07 +0000 (UTC)
Received: by mail-wr1-x441.google.com with SMTP id v4so1751266wrs.8
 for <dri-devel@lists.freedesktop.org>; Wed, 04 Mar 2020 02:41:07 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=baylibre-com.20150623.gappssmtp.com; s=20150623;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=05GmesXdW073k2ThBbeiRKr/Oe1AMG//k9yDOxDZStc=;
 b=U/U/KiI5JLOZevcMUF+9Xsb2DBBUFZDM2606GLhQwATjzhcx9dTIsbnNoQ1lr9UW6E
 vB+rEBog8owFcLIprm/qqULio8u6RRJLR6T6wqiUg1gkwnQ+ibvuoXx0LGuaeKOqaiXn
 CguoreMjpdmvMwL6cdquv1EdYXyneCRuvsthQR4kArsTv4apxu84n1q0VRFUPao3GO1R
 IMnPLbD3CYbF78KrFuMZ+4t2JXbJh+JhoG9MTphCDIfU4Hk8htY8rUnSf7TNm2Y1KUgz
 phqvrbxrZK/0spwcZY4VrzioGHP2qv1XKPCDZQ6S11bJL03xdtxKe8iI3+Qcl0hluuLH
 99rg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=05GmesXdW073k2ThBbeiRKr/Oe1AMG//k9yDOxDZStc=;
 b=mvYAqM3+hLzpIGrV1t3+TTvBjvc91uBtJPw/mjXq9cHlS/d0E6lCDn3LWS6lRTIrhy
 OCwuEqkb2DUTnKUGWyNg18HL1rG1aEkkw0AOlHSTOVyAnCUzVNnhkAeaq2P29X8bDXct
 kpKrTsPxn9Zs0qJfn3icog5WDuriKqNnnYQQ6hO3d2aE/bUITKuhNoON70RxtD8BhvY9
 HF9+DOr5yjXtXBbuA61TIzFwph+2v93R1aKXinJAo/MQZfe1JqFu4j4Q3ppJ5CRc0BPw
 6O9PVkqNlh+/WsllMtJ17tWQC+PWZ5NFJA6oQ2IdqQATJ603pnMKeJ5FJdrEKH6k4YE9
 ilVw==
X-Gm-Message-State: ANhLgQ0HgpsWdw8a54od/bJ3/Ftf+ilJuuevaEV2GRSXXA0ZWcQsd2GV
 W1yj5P7eQ5C/wDqEKngcOdHYlQ==
X-Google-Smtp-Source: ADFU+vtJw0egIlXgBDOkbFEXsnhTQjbYHbr4BOS2yBiHRitOhRYMVeYYBEjHxfS0CzUiZMRFusqU5g==
X-Received: by 2002:adf:df8f:: with SMTP id z15mr3454925wrl.184.1583318466092; 
 Wed, 04 Mar 2020 02:41:06 -0800 (PST)
Received: from bender.baylibre.local
 (laubervilliers-658-1-213-31.w90-63.abo.wanadoo.fr. [90.63.244.31])
 by smtp.gmail.com with ESMTPSA id c14sm24006398wro.36.2020.03.04.02.41.05
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Wed, 04 Mar 2020 02:41:05 -0800 (PST)
From: Neil Armstrong <narmstrong@baylibre.com>
To: a.hajda@samsung.com, Laurent.pinchart@ideasonboard.com, jonas@kwiboo.se,
 jernej.skrabec@siol.net, boris.brezillon@collabora.com
Subject: [PATCH v5 07/11] drm/meson: meson_dw_hdmi: add bridge and switch to
 drm_bridge_funcs
Date: Wed,  4 Mar 2020 11:40:48 +0100
Message-Id: <20200304104052.17196-8-narmstrong@baylibre.com>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20200304104052.17196-1-narmstrong@baylibre.com>
References: <20200304104052.17196-1-narmstrong@baylibre.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: linux-amlogic@lists.infradead.org, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, Neil Armstrong <narmstrong@baylibre.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

U3dpdGNoIHRoZSBkdy1oZG1pIGRyaXZlciB0byBkcm1fYnJpZGdlX2Z1bmNzIGJ5IGltcGxlbWVu
dGluZyBhIG5ldyBsb2NhbApicmlkZ2UsIGNvbm5lY3RpbmcgaXQgdG8gdGhlIGR3LWhkbWkgYnJp
ZGdlLCB0aGVuIGltcGxlbWVudCB0aGUKYXRvbWljX2dldF9pbnB1dF9idXNfZm10cy9hdG9taWNf
Z2V0X291dHB1dF9idXNfZm10cy4KClNpZ25lZC1vZmYtYnk6IE5laWwgQXJtc3Ryb25nIDxuYXJt
c3Ryb25nQGJheWxpYnJlLmNvbT4KUmV2aWV3ZWQtYnk6IEplcm5laiDFoGtyYWJlYyA8amVybmVq
LnNrcmFiZWNAc2lvbC5uZXQ+Ci0tLQogZHJpdmVycy9ncHUvZHJtL21lc29uL21lc29uX2R3X2hk
bWkuYyB8IDg1ICsrKysrKysrKysrKysrKysrKysrLS0tLS0tLQogMSBmaWxlIGNoYW5nZWQsIDY1
IGluc2VydGlvbnMoKyksIDIwIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9tZXNvbi9tZXNvbl9kd19oZG1pLmMgYi9kcml2ZXJzL2dwdS9kcm0vbWVzb24vbWVzb25f
ZHdfaGRtaS5jCmluZGV4IDNiYjdmZmU1ZmMzOS4uOGY1MWQwMzIyNjJjIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vbWVzb24vbWVzb25fZHdfaGRtaS5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9tZXNvbi9tZXNvbl9kd19oZG1pLmMKQEAgLTE2LDYgKzE2LDcgQEAKIAogI2luY2x1ZGUgPGRy
bS9icmlkZ2UvZHdfaGRtaS5oPgogI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljX2hlbHBlci5oPgor
I2luY2x1ZGUgPGRybS9kcm1fYnJpZGdlLmg+CiAjaW5jbHVkZSA8ZHJtL2RybV9kZXZpY2UuaD4K
ICNpbmNsdWRlIDxkcm0vZHJtX2VkaWQuaD4KICNpbmNsdWRlIDxkcm0vZHJtX3Byb2JlX2hlbHBl
ci5oPgpAQCAtMTM1LDYgKzEzNiw3IEBAIHN0cnVjdCBtZXNvbl9kd19oZG1pX2RhdGEgewogCiBz
dHJ1Y3QgbWVzb25fZHdfaGRtaSB7CiAJc3RydWN0IGRybV9lbmNvZGVyIGVuY29kZXI7CisJc3Ry
dWN0IGRybV9icmlkZ2UgYnJpZGdlOwogCXN0cnVjdCBkd19oZG1pX3BsYXRfZGF0YSBkd19wbGF0
X2RhdGE7CiAJc3RydWN0IG1lc29uX2RybSAqcHJpdjsKIAlzdHJ1Y3QgZGV2aWNlICpkZXY7CkBA
IC0xNTEsNiArMTUzLDggQEAgc3RydWN0IG1lc29uX2R3X2hkbWkgewogfTsKICNkZWZpbmUgZW5j
b2Rlcl90b19tZXNvbl9kd19oZG1pKHgpIFwKIAljb250YWluZXJfb2YoeCwgc3RydWN0IG1lc29u
X2R3X2hkbWksIGVuY29kZXIpCisjZGVmaW5lIGJyaWRnZV90b19tZXNvbl9kd19oZG1pKHgpIFwK
Kwljb250YWluZXJfb2YoeCwgc3RydWN0IG1lc29uX2R3X2hkbWksIGJyaWRnZSkKIAogc3RhdGlj
IGlubGluZSBpbnQgZHdfaGRtaV9pc19jb21wYXRpYmxlKHN0cnVjdCBtZXNvbl9kd19oZG1pICpk
d19oZG1pLAogCQkJCQljb25zdCBjaGFyICpjb21wYXQpCkBAIC0zNjgsNyArMzcyLDcgQEAgc3Rh
dGljIGlubGluZSB2b2lkIG1lc29uX2R3X2hkbWlfcGh5X3Jlc2V0KHN0cnVjdCBtZXNvbl9kd19o
ZG1pICpkd19oZG1pKQogfQogCiBzdGF0aWMgdm9pZCBkd19oZG1pX3NldF92Y2xrKHN0cnVjdCBt
ZXNvbl9kd19oZG1pICpkd19oZG1pLAotCQkJICAgICBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAq
bW9kZSkKKwkJCSAgICAgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUpCiB7CiAJ
c3RydWN0IG1lc29uX2RybSAqcHJpdiA9IGR3X2hkbWktPnByaXY7CiAJaW50IHZpYyA9IGRybV9t
YXRjaF9jZWFfbW9kZShtb2RlKTsKQEAgLTY2Myw2ICs2NjcsMTAgQEAgZHdfaGRtaV9tb2RlX3Zh
bGlkKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCiAKIC8qIEVuY29kZXIgKi8KIAor
c3RhdGljIGNvbnN0IHUzMiBtZXNvbl9kd19oZG1pX291dF9idXNfZm10c1tdID0geworCU1FRElB
X0JVU19GTVRfWVVWOF8xWDI0LAorfTsKKwogc3RhdGljIHZvaWQgbWVzb25fdmVuY19oZG1pX2Vu
Y29kZXJfZGVzdHJveShzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIpCiB7CiAJZHJtX2VuY29k
ZXJfY2xlYW51cChlbmNvZGVyKTsKQEAgLTY3MiwxNiArNjgwLDQzIEBAIHN0YXRpYyBjb25zdCBz
dHJ1Y3QgZHJtX2VuY29kZXJfZnVuY3MgbWVzb25fdmVuY19oZG1pX2VuY29kZXJfZnVuY3MgPSB7
CiAJLmRlc3Ryb3kgICAgICAgID0gbWVzb25fdmVuY19oZG1pX2VuY29kZXJfZGVzdHJveSwKIH07
CiAKLXN0YXRpYyBpbnQgbWVzb25fdmVuY19oZG1pX2VuY29kZXJfYXRvbWljX2NoZWNrKHN0cnVj
dCBkcm1fZW5jb2RlciAqZW5jb2RlciwKK3N0YXRpYyB1MzIgKgorbWVzb25fdmVuY19oZG1pX2Vu
Y29kZXJfZ2V0X2lucF9idXNfZm10cyhzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAorCQkJCQlz
dHJ1Y3QgZHJtX2JyaWRnZV9zdGF0ZSAqYnJpZGdlX3N0YXRlLAorCQkJCQlzdHJ1Y3QgZHJtX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUsCisJCQkJCXN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpj
b25uX3N0YXRlLAorCQkJCQl1MzIgb3V0cHV0X2ZtdCwKKwkJCQkJdW5zaWduZWQgaW50ICpudW1f
aW5wdXRfZm10cykKK3sKKwl1MzIgKmlucHV0X2ZtdHMgPSBOVUxMOworCisJaWYgKG91dHB1dF9m
bXQgPT0gbWVzb25fZHdfaGRtaV9vdXRfYnVzX2ZtdHNbMF0pIHsKKwkJKm51bV9pbnB1dF9mbXRz
ID0gMTsKKwkJaW5wdXRfZm10cyA9IGtjYWxsb2MoKm51bV9pbnB1dF9mbXRzLAorCQkJCSAgICAg
c2l6ZW9mKCppbnB1dF9mbXRzKSwKKwkJCQkgICAgIEdGUF9LRVJORUwpOworCQlpZiAoIWlucHV0
X2ZtdHMpCisJCQlyZXR1cm4gTlVMTDsKKworCQlpbnB1dF9mbXRzWzBdID0gb3V0cHV0X2ZtdDsK
Kwl9IGVsc2UgeworCQkqbnVtX2lucHV0X2ZtdHMgPSAwOworCX0KKworCXJldHVybiBpbnB1dF9m
bXRzOworfQorCitzdGF0aWMgaW50IG1lc29uX3ZlbmNfaGRtaV9lbmNvZGVyX2F0b21pY19jaGVj
ayhzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAorCQkJCQlzdHJ1Y3QgZHJtX2JyaWRnZV9zdGF0
ZSAqYnJpZGdlX3N0YXRlLAogCQkJCQlzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
CiAJCQkJCXN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQogewogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgdm9pZCBtZXNvbl92ZW5jX2hkbWlfZW5jb2Rlcl9kaXNhYmxlKHN0
cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcikKK3N0YXRpYyB2b2lkIG1lc29uX3ZlbmNfaGRtaV9l
bmNvZGVyX2Rpc2FibGUoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSkKIHsKLQlzdHJ1Y3QgbWVz
b25fZHdfaGRtaSAqZHdfaGRtaSA9IGVuY29kZXJfdG9fbWVzb25fZHdfaGRtaShlbmNvZGVyKTsK
KwlzdHJ1Y3QgbWVzb25fZHdfaGRtaSAqZHdfaGRtaSA9IGJyaWRnZV90b19tZXNvbl9kd19oZG1p
KGJyaWRnZSk7CiAJc3RydWN0IG1lc29uX2RybSAqcHJpdiA9IGR3X2hkbWktPnByaXY7CiAKIAlE
Uk1fREVCVUdfRFJJVkVSKCJcbiIpOwpAQCAtNjkzLDkgKzcyOCw5IEBAIHN0YXRpYyB2b2lkIG1l
c29uX3ZlbmNfaGRtaV9lbmNvZGVyX2Rpc2FibGUoc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVy
KQogCXdyaXRlbF9yZWxheGVkKDAsIHByaXYtPmlvX2Jhc2UgKyBfUkVHKEVOQ1BfVklERU9fRU4p
KTsKIH0KIAotc3RhdGljIHZvaWQgbWVzb25fdmVuY19oZG1pX2VuY29kZXJfZW5hYmxlKHN0cnVj
dCBkcm1fZW5jb2RlciAqZW5jb2RlcikKK3N0YXRpYyB2b2lkIG1lc29uX3ZlbmNfaGRtaV9lbmNv
ZGVyX2VuYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQogewotCXN0cnVjdCBtZXNvbl9k
d19oZG1pICpkd19oZG1pID0gZW5jb2Rlcl90b19tZXNvbl9kd19oZG1pKGVuY29kZXIpOworCXN0
cnVjdCBtZXNvbl9kd19oZG1pICpkd19oZG1pID0gYnJpZGdlX3RvX21lc29uX2R3X2hkbWkoYnJp
ZGdlKTsKIAlzdHJ1Y3QgbWVzb25fZHJtICpwcml2ID0gZHdfaGRtaS0+cHJpdjsKIAogCURSTV9E
RUJVR19EUklWRVIoIiVzXG4iLCBwcml2LT52ZW5jLmhkbWlfdXNlX2VuY2kgPyAiVkVOQ0kiIDog
IlZFTkNQIik7CkBAIC03MDYsMTEgKzc0MSwxMSBAQCBzdGF0aWMgdm9pZCBtZXNvbl92ZW5jX2hk
bWlfZW5jb2Rlcl9lbmFibGUoc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyKQogCQl3cml0ZWxf
cmVsYXhlZCgxLCBwcml2LT5pb19iYXNlICsgX1JFRyhFTkNQX1ZJREVPX0VOKSk7CiB9CiAKLXN0
YXRpYyB2b2lkIG1lc29uX3ZlbmNfaGRtaV9lbmNvZGVyX21vZGVfc2V0KHN0cnVjdCBkcm1fZW5j
b2RlciAqZW5jb2RlciwKLQkJCQkgICBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSwKLQkJ
CQkgICBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSkKK3N0YXRpYyB2b2lk
IG1lc29uX3ZlbmNfaGRtaV9lbmNvZGVyX21vZGVfc2V0KHN0cnVjdCBkcm1fYnJpZGdlICpicmlk
Z2UsCisJCQkJICAgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUsCisJCQkJICAg
Y29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUpCiB7Ci0Jc3RydWN0
IG1lc29uX2R3X2hkbWkgKmR3X2hkbWkgPSBlbmNvZGVyX3RvX21lc29uX2R3X2hkbWkoZW5jb2Rl
cik7CisJc3RydWN0IG1lc29uX2R3X2hkbWkgKmR3X2hkbWkgPSBicmlkZ2VfdG9fbWVzb25fZHdf
aGRtaShicmlkZ2UpOwogCXN0cnVjdCBtZXNvbl9kcm0gKnByaXYgPSBkd19oZG1pLT5wcml2Owog
CWludCB2aWMgPSBkcm1fbWF0Y2hfY2VhX21vZGUobW9kZSk7CiAKQEAgLTcyNiwxMiArNzYxLDE1
IEBAIHN0YXRpYyB2b2lkIG1lc29uX3ZlbmNfaGRtaV9lbmNvZGVyX21vZGVfc2V0KHN0cnVjdCBk
cm1fZW5jb2RlciAqZW5jb2RlciwKIAl3cml0ZWxfcmVsYXhlZCgwLCBwcml2LT5pb19iYXNlICsg
X1JFRyhWUFVfSERNSV9GTVRfQ1RSTCkpOwogfQogCi1zdGF0aWMgY29uc3Qgc3RydWN0IGRybV9l
bmNvZGVyX2hlbHBlcl9mdW5jcwotCQkJCW1lc29uX3ZlbmNfaGRtaV9lbmNvZGVyX2hlbHBlcl9m
dW5jcyA9IHsKLQkuYXRvbWljX2NoZWNrCT0gbWVzb25fdmVuY19oZG1pX2VuY29kZXJfYXRvbWlj
X2NoZWNrLAotCS5kaXNhYmxlCT0gbWVzb25fdmVuY19oZG1pX2VuY29kZXJfZGlzYWJsZSwKLQku
ZW5hYmxlCQk9IG1lc29uX3ZlbmNfaGRtaV9lbmNvZGVyX2VuYWJsZSwKLQkubW9kZV9zZXQJPSBt
ZXNvbl92ZW5jX2hkbWlfZW5jb2Rlcl9tb2RlX3NldCwKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJt
X2JyaWRnZV9mdW5jcyBtZXNvbl92ZW5jX2hkbWlfZW5jb2Rlcl9icmlkZ2VfZnVuY3MgPSB7CisJ
LmF0b21pY19kdXBsaWNhdGVfc3RhdGUgPSBkcm1fYXRvbWljX2hlbHBlcl9icmlkZ2VfZHVwbGlj
YXRlX3N0YXRlLAorCS5hdG9taWNfZGVzdHJveV9zdGF0ZSA9IGRybV9hdG9taWNfaGVscGVyX2Jy
aWRnZV9kZXN0cm95X3N0YXRlLAorCS5hdG9taWNfZ2V0X2lucHV0X2J1c19mbXRzID0gbWVzb25f
dmVuY19oZG1pX2VuY29kZXJfZ2V0X2lucF9idXNfZm10cywKKwkuYXRvbWljX3Jlc2V0ID0gZHJt
X2F0b21pY19oZWxwZXJfYnJpZGdlX3Jlc2V0LAorCS5hdG9taWNfY2hlY2sgPSBtZXNvbl92ZW5j
X2hkbWlfZW5jb2Rlcl9hdG9taWNfY2hlY2ssCisJLmVuYWJsZQk9IG1lc29uX3ZlbmNfaGRtaV9l
bmNvZGVyX2VuYWJsZSwKKwkuZGlzYWJsZSA9IG1lc29uX3ZlbmNfaGRtaV9lbmNvZGVyX2Rpc2Fi
bGUsCisJLm1vZGVfc2V0ID0gbWVzb25fdmVuY19oZG1pX2VuY29kZXJfbW9kZV9zZXQsCiB9Owog
CiAvKiBEVyBIRE1JIFJlZ21hcCAqLwpAQCAtODUyLDYgKzg5MCw3IEBAIHN0YXRpYyBpbnQgbWVz
b25fZHdfaGRtaV9iaW5kKHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRldmljZSAqbWFzdGVy
LAogCXN0cnVjdCBkcm1fZGV2aWNlICpkcm0gPSBkYXRhOwogCXN0cnVjdCBtZXNvbl9kcm0gKnBy
aXYgPSBkcm0tPmRldl9wcml2YXRlOwogCXN0cnVjdCBkd19oZG1pX3BsYXRfZGF0YSAqZHdfcGxh
dF9kYXRhOworCXN0cnVjdCBkcm1fYnJpZGdlICpuZXh0X2JyaWRnZTsKIAlzdHJ1Y3QgZHJtX2Vu
Y29kZXIgKmVuY29kZXI7CiAJc3RydWN0IHJlc291cmNlICpyZXM7CiAJaW50IGlycTsKQEAgLTk1
Myw4ICs5OTIsNiBAQCBzdGF0aWMgaW50IG1lc29uX2R3X2hkbWlfYmluZChzdHJ1Y3QgZGV2aWNl
ICpkZXYsIHN0cnVjdCBkZXZpY2UgKm1hc3RlciwKIAogCS8qIEVuY29kZXIgKi8KIAotCWRybV9l
bmNvZGVyX2hlbHBlcl9hZGQoZW5jb2RlciwgJm1lc29uX3ZlbmNfaGRtaV9lbmNvZGVyX2hlbHBl
cl9mdW5jcyk7Ci0KIAlyZXQgPSBkcm1fZW5jb2Rlcl9pbml0KGRybSwgZW5jb2RlciwgJm1lc29u
X3ZlbmNfaGRtaV9lbmNvZGVyX2Z1bmNzLAogCQkJICAgICAgIERSTV9NT0RFX0VOQ09ERVJfVE1E
UywgIm1lc29uX2hkbWkiKTsKIAlpZiAocmV0KSB7CkBAIC05NjIsNiArOTk5LDkgQEAgc3RhdGlj
IGludCBtZXNvbl9kd19oZG1pX2JpbmQoc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1Y3QgZGV2aWNl
ICptYXN0ZXIsCiAJCXJldHVybiByZXQ7CiAJfQogCisJbWVzb25fZHdfaGRtaS0+YnJpZGdlLmZ1
bmNzID0gJm1lc29uX3ZlbmNfaGRtaV9lbmNvZGVyX2JyaWRnZV9mdW5jczsKKwlkcm1fYnJpZGdl
X2F0dGFjaChlbmNvZGVyLCAmbWVzb25fZHdfaGRtaS0+YnJpZGdlLCBOVUxMLCAwKTsKKwogCWVu
Y29kZXItPnBvc3NpYmxlX2NydGNzID0gQklUKDApOwogCiAJRFJNX0RFQlVHX0RSSVZFUigiZW5j
b2RlciBpbml0aWFsaXplZFxuIik7CkBAIC05ODQsMTEgKzEwMjQsMTYgQEAgc3RhdGljIGludCBt
ZXNvbl9kd19oZG1pX2JpbmQoc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1Y3QgZGV2aWNlICptYXN0
ZXIsCiAKIAlwbGF0Zm9ybV9zZXRfZHJ2ZGF0YShwZGV2LCBtZXNvbl9kd19oZG1pKTsKIAotCW1l
c29uX2R3X2hkbWktPmhkbWkgPSBkd19oZG1pX2JpbmQocGRldiwgZW5jb2RlciwKLQkJCQkJICAg
Jm1lc29uX2R3X2hkbWktPmR3X3BsYXRfZGF0YSk7CisJbWVzb25fZHdfaGRtaS0+aGRtaSA9IGR3
X2hkbWlfcHJvYmUocGRldiwKKwkJCQkJICAgICZtZXNvbl9kd19oZG1pLT5kd19wbGF0X2RhdGEp
OwogCWlmIChJU19FUlIobWVzb25fZHdfaGRtaS0+aGRtaSkpCiAJCXJldHVybiBQVFJfRVJSKG1l
c29uX2R3X2hkbWktPmhkbWkpOwogCisJbmV4dF9icmlkZ2UgPSBvZl9kcm1fZmluZF9icmlkZ2Uo
cGRldi0+ZGV2Lm9mX25vZGUpOworCWlmIChuZXh0X2JyaWRnZSkKKwkJZHJtX2JyaWRnZV9hdHRh
Y2goZW5jb2RlciwgbmV4dF9icmlkZ2UsCisJCQkJICAmbWVzb25fZHdfaGRtaS0+YnJpZGdlLCAw
KTsKKwogCURSTV9ERUJVR19EUklWRVIoIkhETUkgY29udHJvbGxlciBpbml0aWFsaXplZFxuIik7
CiAKIAlyZXR1cm4gMDsKLS0gCjIuMjIuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlz
dGluZm8vZHJpLWRldmVsCg==
