Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 1CBB62B16CF
	for <lists+dri-devel@lfdr.de>; Fri, 13 Nov 2020 08:59:29 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 63D268980C;
	Fri, 13 Nov 2020 07:59:23 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx2.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 363AB880C6;
 Fri, 13 Nov 2020 07:59:22 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.221.27])
 by mx2.suse.de (Postfix) with ESMTP id B2B29ACBF;
 Fri, 13 Nov 2020 07:59:20 +0000 (UTC)
Subject: Re: [PATCH 4/7] drm/radeon: Pin buffers while they are vmap'ed
To: =?UTF-8?Q?Christian_K=c3=b6nig?= <christian.koenig@amd.com>,
 alexander.deucher@amd.com, airlied@linux.ie, daniel@ffwll.ch,
 maarten.lankhorst@linux.intel.com, mripard@kernel.org
References: <20201112132117.27228-1-tzimmermann@suse.de>
 <20201112132117.27228-5-tzimmermann@suse.de>
 <3daf9b24-034a-9791-ce30-9f5eba66e7c1@amd.com>
From: Thomas Zimmermann <tzimmermann@suse.de>
Message-ID: <516877c4-3718-1415-9901-62bffdbf26c8@suse.de>
Date: Fri, 13 Nov 2020 08:59:20 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101
 Thunderbird/78.4.0
MIME-Version: 1.0
In-Reply-To: <3daf9b24-034a-9791-ce30-9f5eba66e7c1@amd.com>
Content-Language: en-US
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: dri-devel@lists.freedesktop.org, amd-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SGkgQ2hyaXN0aWFuCgpBbSAxMi4xMS4yMCB1bSAxODoxNiBzY2hyaWViIENocmlzdGlhbiBLw7Zu
aWc6Cj4gQW0gMTIuMTEuMjAgdW0gMTQ6MjEgc2NocmllYiBUaG9tYXMgWmltbWVybWFubjoKPj4g
SW4gb3JkZXIgdG8gYXZvaWQgZXZpY3Rpb24gb2Ygdm1hcCdlZCBidWZmZXJzLCBwaW4gdGhlbSBp
biB0aGVpciBHRU0KPj4gb2JqZWN0J3Mgdm1hcCBpbXBsZW1lbnRhdGlvbi4gVW5waW4gdGhlbSBp
biB0aGUgdnVubWFwIGltcGxlbWVudGF0aW9uLgo+PiBUaGlzIGlzIG5lZWRlZCB0byBtYWtlIGdl
bmVyaWMgZmJkZXYgc3VwcG9ydCB3b3JrIHJlbGlhYmx5LiBXaXRob3V0LAo+PiB0aGUgYnVmZmVy
IG9iamVjdCBjb3VsZCBiZSBldmljdGVkIHdoaWxlIGZiZGV2IGZsdXNoZWQgaXRzIHNoYWRvdyBi
dWZmZXIuCj4+Cj4+IEluIGRpZmZlcmVuY2UgdG8gdGhlIFBSSU1FIHBpbi91bnBpbiBmdW5jdGlv
bnMsIHRoZSB2bWFwIGNvZGUgZG9lcyBub3QKPj4gbW9kaWZ5IHRoZSBCT3MgcHJpbWVfc2hhcmVk
X2NvdW50LCBzbyBhIHZtYXAtcGlubmVkIEJPIGRvZXMgbm90IGNvdW50IGFzCj4+IHNoYXJlZC4K
Pj4KPj4gVGhlIGFjdHVhbCBwaW4gbG9jYXRpb24gaXMgbm90IGltcG9ydGFudCBhcyB0aGUgdm1h
cCBjYWxsIHJldHVybnMKPj4gaW5mb3JtYXRpb24gb24gaG93IHRvIGFjY2VzcyB0aGUgYnVmZmVy
LiBDYWxsZXJzIHRoYXQgcmVxdWlyZSBhCj4+IHNwZWNpZmljIGxvY2F0aW9uIHNob3VsZCBleHBs
aWNpdGx5IHBpbiB0aGUgQk8gYmVmb3JlIHZtYXBwaW5nIGl0Lgo+IAo+IFdlbGwgaXMgdGhlIGJ1
ZmZlciBzdXBwb3NlZCB0byBiZSBzY2FubmVkIG91dD8KCk5vLCBub3QgYnkgdGhlIGZiZGV2IGhl
bHBlci4KCj4gCj4gSWYgeWVzIHRoZW4gdGhlIHBpbiBsb2NhdGlvbiBpcyBhY3R1YWxseSByYXRo
ZXIgaW1wb3J0YW50IHNpbmNlIHRoZQo+IGhhcmR3YXJlIGNhbiBvbmx5IHNjYW4gb3V0IGZyb20g
VlJBTS4KCkZvciByZWxvY2F0YWJsZSBCT3MsIGZiZGV2IHVzZXMgYSBzaGFkb3cgYnVmZmVyIHRo
YXQgbWFrZXMgYWxsIGFueQpyZWxvY2F0aW9uIHRyYW5zcGFyZW50IHRvIHVzZXJzcGFjZS4gSXQg
Zmx1c2hlcyB0aGUgc2hhZG93IGZiIGludG8gdGhlCkJPJ3MgbWVtb3J5IGlmIHRoZXJlIGFyZSB1
cGRhdGVzLiBUaGUgY29kZSBpcyBpbgpkcm1fZmJfaGVscGVyX2RpcnR5X3dvcmsoKS4gWzFdIER1
cmluZyB0aGUgZmx1c2ggb3BlcmF0aW9uLCB0aGUgdm1hcApjYWxsIG5vdyBwaW5zIHRoZSBCTyB0
byB3aGVyZXZlciBpdCBpcy4gVGhlIGFjdHVhbCBsb2NhdGlvbiBkb2VzIG5vdAptYXR0ZXIuIEl0
J3MgdnVubWFwJ2VkIGltbWVkaWF0ZWx5IGFmdGVyd2FyZHMuCgpGb3IgZG1hLWJ1ZiBzaGFyaW5n
LCB0aGUgcmVndWxhciBwcm9jZWR1cmUgb2YgcGluICsgdm1hcCBzdGlsbCBhcHBseS4KVGhpcyBz
aG91bGQgYWx3YXlzIG1vdmUgdGhlIEJPIGludG8gR1RULW1hbmFnZWQgbWVtb3J5LgoKQmVzdCBy
ZWdhcmRzClRob21hcwoKWzFdCmh0dHBzOi8vZ2l0Lmtlcm5lbC5vcmcvcHViL3NjbS9saW51eC9r
ZXJuZWwvZ2l0L3RvcnZhbGRzL2xpbnV4LmdpdC90cmVlL2RyaXZlcnMvZ3B1L2RybS9kcm1fZmJf
aGVscGVyLmMjbjQzMgoKPiAKPiBSZWdhcmRzLAo+IENocmlzdGlhbi4KPiAKPj4KPj4gU2lnbmVk
LW9mZi1ieTogVGhvbWFzIFppbW1lcm1hbm4gPHR6aW1tZXJtYW5uQHN1c2UuZGU+Cj4+IC0tLQo+
PiDCoCBkcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9nZW0uYyB8IDUxICsrKysrKysrKysr
KysrKysrKysrKysrKysrKy0tCj4+IMKgIDEgZmlsZSBjaGFuZ2VkLCA0OSBpbnNlcnRpb25zKCsp
LCAyIGRlbGV0aW9ucygtKQo+Pgo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JhZGVv
bi9yYWRlb25fZ2VtLmMKPj4gYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9nZW0uYwo+
PiBpbmRleCBkMjg3NmNlM2JjOWUuLmVhZjdmYzlhN2IwNyAxMDA2NDQKPj4gLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fZ2VtLmMKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3Jh
ZGVvbi9yYWRlb25fZ2VtLmMKPj4gQEAgLTIyNiw2ICsyMjYsNTMgQEAgc3RhdGljIGludCByYWRl
b25fZ2VtX2hhbmRsZV9sb2NrdXAoc3RydWN0Cj4+IHJhZGVvbl9kZXZpY2UgKnJkZXYsIGludCBy
KQo+PiDCoMKgwqDCoMKgIHJldHVybiByOwo+PiDCoCB9Cj4+IMKgICtzdGF0aWMgaW50IHJhZGVv
bl9nZW1fb2JqZWN0X3ZtYXAoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmosCj4+IHN0cnVjdCBk
bWFfYnVmX21hcCAqbWFwKQo+PiArewo+PiArwqDCoMKgIHN0YXRpYyBjb25zdCB1aW50MzJfdCBh
bnlfZG9tYWluID0gUkFERU9OX0dFTV9ET01BSU5fVlJBTSB8Cj4+ICvCoMKgwqDCoMKgwqDCoMKg
wqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoCBSQURFT05fR0VNX0RPTUFJTl9HVFQgfAo+PiAr
wqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqAgUkFERU9OX0dFTV9E
T01BSU5fQ1BVOwo+PiArCj4+ICvCoMKgwqAgc3RydWN0IHJhZGVvbl9ibyAqYm8gPSBnZW1fdG9f
cmFkZW9uX2JvKG9iaik7Cj4+ICvCoMKgwqAgaW50IHJldDsKPj4gKwo+PiArwqDCoMKgIHJldCA9
IHJhZGVvbl9ib19yZXNlcnZlKGJvLCBmYWxzZSk7Cj4+ICvCoMKgwqAgaWYgKHJldCkKPj4gK8Kg
wqDCoMKgwqDCoMKgIHJldHVybiByZXQ7Cj4+ICsKPj4gK8KgwqDCoCAvKiBwaW4gYnVmZmVyIGF0
IGl0cyBjdXJyZW50IGxvY2F0aW9uICovCj4+ICvCoMKgwqAgcmV0ID0gcmFkZW9uX2JvX3Bpbihi
bywgYW55X2RvbWFpbiwgTlVMTCk7Cj4+ICvCoMKgwqAgaWYgKHJldCkKPj4gK8KgwqDCoMKgwqDC
oMKgIGdvdG8gZXJyX3JhZGVvbl9ib191bnJlc2VydmU7Cj4+ICsKPj4gK8KgwqDCoCByZXQgPSBk
cm1fZ2VtX3R0bV92bWFwKG9iaiwgbWFwKTsKPj4gK8KgwqDCoCBpZiAocmV0KQo+PiArwqDCoMKg
wqDCoMKgwqAgZ290byBlcnJfcmFkZW9uX2JvX3VucGluOwo+PiArCj4+ICvCoMKgwqAgcmFkZW9u
X2JvX3VucmVzZXJ2ZShibyk7Cj4+ICsKPj4gK8KgwqDCoCByZXR1cm4gMDsKPj4gKwo+PiArZXJy
X3JhZGVvbl9ib191bnBpbjoKPj4gK8KgwqDCoCByYWRlb25fYm9fdW5waW4oYm8pOwo+PiArZXJy
X3JhZGVvbl9ib191bnJlc2VydmU6Cj4+ICvCoMKgwqAgcmFkZW9uX2JvX3VucmVzZXJ2ZShibyk7
Cj4+ICvCoMKgwqAgcmV0dXJuIHJldDsKPj4gK30KPj4gKwo+PiArc3RhdGljIHZvaWQgcmFkZW9u
X2dlbV9vYmplY3RfdnVubWFwKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqLAo+PiBzdHJ1Y3Qg
ZG1hX2J1Zl9tYXAgKm1hcCkKPj4gK3sKPj4gK8KgwqDCoCBzdHJ1Y3QgcmFkZW9uX2JvICpibyA9
IGdlbV90b19yYWRlb25fYm8ob2JqKTsKPj4gK8KgwqDCoCBpbnQgcmV0Owo+PiArCj4+ICvCoMKg
wqAgcmV0ID0gcmFkZW9uX2JvX3Jlc2VydmUoYm8sIGZhbHNlKTsKPj4gK8KgwqDCoCBpZiAocmV0
KQo+PiArwqDCoMKgwqDCoMKgwqAgcmV0dXJuOwo+PiArCj4+ICvCoMKgwqAgZHJtX2dlbV90dG1f
dnVubWFwKG9iaiwgbWFwKTsKPj4gK8KgwqDCoCByYWRlb25fYm9fdW5waW4oYm8pOwo+PiArwqDC
oMKgIHJhZGVvbl9ib191bnJlc2VydmUoYm8pOwo+PiArfQo+PiArCj4+IMKgIHN0YXRpYyBjb25z
dCBzdHJ1Y3QgZHJtX2dlbV9vYmplY3RfZnVuY3MgcmFkZW9uX2dlbV9vYmplY3RfZnVuY3MgPSB7
Cj4+IMKgwqDCoMKgwqAgLmZyZWUgPSByYWRlb25fZ2VtX29iamVjdF9mcmVlLAo+PiDCoMKgwqDC
oMKgIC5vcGVuID0gcmFkZW9uX2dlbV9vYmplY3Rfb3BlbiwKPj4gQEAgLTIzNCw4ICsyODEsOCBA
QCBzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9nZW1fb2JqZWN0X2Z1bmNzCj4+IHJhZGVvbl9nZW1f
b2JqZWN0X2Z1bmNzID0gewo+PiDCoMKgwqDCoMKgIC5waW4gPSByYWRlb25fZ2VtX3ByaW1lX3Bp
biwKPj4gwqDCoMKgwqDCoCAudW5waW4gPSByYWRlb25fZ2VtX3ByaW1lX3VucGluLAo+PiDCoMKg
wqDCoMKgIC5nZXRfc2dfdGFibGUgPSByYWRlb25fZ2VtX3ByaW1lX2dldF9zZ190YWJsZSwKPj4g
LcKgwqDCoCAudm1hcCA9IGRybV9nZW1fdHRtX3ZtYXAsCj4+IC3CoMKgwqAgLnZ1bm1hcCA9IGRy
bV9nZW1fdHRtX3Z1bm1hcCwKPj4gK8KgwqDCoCAudm1hcCA9IHJhZGVvbl9nZW1fb2JqZWN0X3Zt
YXAsCj4+ICvCoMKgwqAgLnZ1bm1hcCA9IHJhZGVvbl9nZW1fb2JqZWN0X3Z1bm1hcCwKPj4gwqAg
fTsKPj4gwqAgwqAgLyoKPiAKPiBfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fXwo+IGRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKPiBkcmktZGV2ZWxAbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnCj4gaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0
aW5mby9kcmktZGV2ZWwKCi0tIApUaG9tYXMgWmltbWVybWFubgpHcmFwaGljcyBEcml2ZXIgRGV2
ZWxvcGVyClNVU0UgU29mdHdhcmUgU29sdXRpb25zIEdlcm1hbnkgR21iSApNYXhmZWxkc3RyLiA1
LCA5MDQwOSBOw7xybmJlcmcsIEdlcm1hbnkKKEhSQiAzNjgwOSwgQUcgTsO8cm5iZXJnKQpHZXNj
aMOkZnRzZsO8aHJlcjogRmVsaXggSW1lbmTDtnJmZmVyCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVs
QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWls
bWFuL2xpc3RpbmZvL2RyaS1kZXZlbAo=
