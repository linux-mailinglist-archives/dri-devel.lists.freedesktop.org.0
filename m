Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 2151495342
	for <lists+dri-devel@lfdr.de>; Tue, 20 Aug 2019 03:19:26 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 615CC6E577;
	Tue, 20 Aug 2019 01:19:22 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from perceval.ideasonboard.com (perceval.ideasonboard.com
 [IPv6:2001:4b98:dc2:55:216:3eff:fef7:d647])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3BF436E57A
 for <dri-devel@lists.freedesktop.org>; Tue, 20 Aug 2019 01:18:11 +0000 (UTC)
Received: from pendragon.bb.dnainternet.fi
 (dfj612yhrgyx302h3jwwy-3.rev.dnainternet.fi
 [IPv6:2001:14ba:21f5:5b00:ce28:277f:58d7:3ca4])
 by perceval.ideasonboard.com (Postfix) with ESMTPSA id 20DDC33D;
 Tue, 20 Aug 2019 03:18:04 +0200 (CEST)
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v2 44/50] drm/omap: dpi: Register a drm_bridge
Date: Tue, 20 Aug 2019 04:17:15 +0300
Message-Id: <20190820011721.30136-45-laurent.pinchart@ideasonboard.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190820011721.30136-1-laurent.pinchart@ideasonboard.com>
References: <20190820011721.30136-1-laurent.pinchart@ideasonboard.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=ideasonboard.com; s=mail; t=1566263884;
 bh=eqkdh3/ZI9b4ZfqQ2A5ovx8vRHU4+/gEehy41wCQnTs=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=cx93xtpSgAd3Q5K0ebplMJV/1dwBxG8YjtJCkxHsgLG1H0S6CLTN2URd8/B++y1eA
 5atC4BWEh9i5ZIOjg3MhPoDFqIZFzXvQRoXXnWhWxowzoFAy4B0+bprLYV1bzRJF0i
 spg5P8v3FgIEUbHoD8yb2vIjNYID2Amm8craVgws=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Maxime Ripard <maxime.ripard@bootlin.com>,
 Tomi Valkeinen <tomi.valkeinen@ti.com>, Sean Paul <sean@poorly.run>,
 Sebastian Reichel <sebastian.reichel@collabora.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW4gb3JkZXIgdG8gaW50ZWdyYXRlIHdpdGggYSBjaGFpbiBvZiBkcm1fYnJpZGdlLCB0aGUgaW50
ZXJuYWwgRFBJCm91dHB1dCBoYXMgdG8gZXhwb3NlIGl0cyBvcGVyYXRpb25zIHRocm91Z2ggdGhl
IGRybV9icmlkZ2UgQVBJLgpSZWdpc3RlciBhIGJyaWRnZSBhdCBpbml0aWFsaXNhdGlvbiB0aW1l
IHRvIGRvIHNvIGFuZCByZW1vdmUgdGhlCm9tYXBfZHNzX2RldmljZSBvcGVyYXRpb25zIHRoYXQg
YXJlIG5vdyB1bnVzZWQuCgpTaWduZWQtb2ZmLWJ5OiBMYXVyZW50IFBpbmNoYXJ0IDxsYXVyZW50
LnBpbmNoYXJ0QGlkZWFzb25ib2FyZC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL29tYXBkcm0v
ZHNzL2RwaS5jIHwgMjA1ICsrKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLQogMSBmaWxlIGNo
YW5nZWQsIDEyMiBpbnNlcnRpb25zKCspLCA4MyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3MvZHBpLmMgYi9kcml2ZXJzL2dwdS9kcm0vb21hcGRy
bS9kc3MvZHBpLmMKaW5kZXggYzE2N2JkMTExNmVjLi4zODc0ZTZiNmVjNDkgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL2Rzcy9kcGkuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
b21hcGRybS9kc3MvZHBpLmMKQEAgLTIxLDYgKzIxLDggQEAKICNpbmNsdWRlIDxsaW51eC9zdHJp
bmcuaD4KICNpbmNsdWRlIDxsaW51eC9zeXNfc29jLmg+CiAKKyNpbmNsdWRlIDxkcm0vZHJtX2Jy
aWRnZS5oPgorCiAjaW5jbHVkZSAiZHNzLmgiCiAjaW5jbHVkZSAib21hcGRzcy5oIgogCkBAIC00
MSwxMiArNDMsMTAgQEAgc3RydWN0IGRwaV9kYXRhIHsKIAlpbnQgZGF0YV9saW5lczsKIAogCXN0
cnVjdCBvbWFwX2Rzc19kZXZpY2Ugb3V0cHV0OworCXN0cnVjdCBkcm1fYnJpZGdlIGJyaWRnZTsK
IH07CiAKLXN0YXRpYyBzdHJ1Y3QgZHBpX2RhdGEgKmRwaV9nZXRfZGF0YV9mcm9tX2Rzc2Rldihz
dHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpkc3NkZXYpCi17Ci0JcmV0dXJuIGNvbnRhaW5lcl9vZihk
c3NkZXYsIHN0cnVjdCBkcGlfZGF0YSwgb3V0cHV0KTsKLX0KKyNkZWZpbmUgZHJtX2JyaWRnZV90
b19kcGkoYnJpZGdlKSBjb250YWluZXJfb2YoYnJpZGdlLCBzdHJ1Y3QgZHBpX2RhdGEsIGJyaWRn
ZSkKIAogLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAqIENsb2NrIEhhbmRsaW5nIGFuZCBQTEwK
QEAgLTM1NCw2ICszNTQsMzIgQEAgc3RhdGljIHZvaWQgZHBpX2NvbmZpZ19sY2RfbWFuYWdlcihz
dHJ1Y3QgZHBpX2RhdGEgKmRwaSkKIAlkc3NfbWdyX3NldF9sY2RfY29uZmlnKCZkcGktPm91dHB1
dCwgJmRwaS0+bWdyX2NvbmZpZyk7CiB9CiAKK3N0YXRpYyBpbnQgZHBpX2Nsb2NrX3VwZGF0ZShz
dHJ1Y3QgZHBpX2RhdGEgKmRwaSwgdW5zaWduZWQgbG9uZyAqY2xvY2spCit7CisJaW50IGxja19k
aXYsIHBja19kaXY7CisJdW5zaWduZWQgbG9uZyBmY2s7CisJc3RydWN0IGRwaV9jbGtfY2FsY19j
dHggY3R4OworCisJaWYgKGRwaS0+cGxsKSB7CisJCWlmICghZHBpX3BsbF9jbGtfY2FsYyhkcGks
ICpjbG9jaywgJmN0eCkpCisJCQlyZXR1cm4gLUVJTlZBTDsKKworCQlmY2sgPSBjdHgucGxsX2Np
bmZvLmNsa291dFtjdHguY2xrb3V0X2lkeF07CisJfSBlbHNlIHsKKwkJaWYgKCFkcGlfZHNzX2Ns
a19jYWxjKGRwaSwgKmNsb2NrLCAmY3R4KSkKKwkJCXJldHVybiAtRUlOVkFMOworCisJCWZjayA9
IGN0eC5mY2s7CisJfQorCisJbGNrX2RpdiA9IGN0eC5kaXNwY19jaW5mby5sY2tfZGl2OworCXBj
a19kaXYgPSBjdHguZGlzcGNfY2luZm8ucGNrX2RpdjsKKworCSpjbG9jayA9IGZjayAvIGxja19k
aXYgLyBwY2tfZGl2OworCisJcmV0dXJuIDA7Cit9CisKIHN0YXRpYyBpbnQgZHBpX3ZlcmlmeV9w
bGwoc3RydWN0IGRzc19wbGwgKnBsbCkKIHsKIAlpbnQgcjsKQEAgLTM5MSwyOSArNDE3LDc2IEBA
IHN0YXRpYyB2b2lkIGRwaV9pbml0X3BsbChzdHJ1Y3QgZHBpX2RhdGEgKmRwaSkKIH0KIAogLyog
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0KLSAqIG9tYXBfZHNzX2RldmljZSBPcGVyYXRpb25zCisgKiBE
Uk0gQnJpZGdlIE9wZXJhdGlvbnMKICAqLwogCi1zdGF0aWMgaW50IGRwaV9jb25uZWN0KHN0cnVj
dCBvbWFwX2Rzc19kZXZpY2UgKnNyYywKLQkJICAgICAgIHN0cnVjdCBvbWFwX2Rzc19kZXZpY2Ug
KmRzdCkKK3N0YXRpYyBpbnQgZHBpX2JyaWRnZV9hdHRhY2goc3RydWN0IGRybV9icmlkZ2UgKmJy
aWRnZSwKKwkJCSAgICAgZW51bSBkcm1fYnJpZGdlX2F0dGFjaF9mbGFncyBmbGFncykKIHsKLQlz
dHJ1Y3QgZHBpX2RhdGEgKmRwaSA9IGRwaV9nZXRfZGF0YV9mcm9tX2Rzc2Rldihkc3QpOworCXN0
cnVjdCBkcGlfZGF0YSAqZHBpID0gZHJtX2JyaWRnZV90b19kcGkoYnJpZGdlKTsKKworCWlmICgh
KGZsYWdzICYgRFJNX0JSSURHRV9BVFRBQ0hfTk9fQ09OTkVDVE9SKSkKKwkJcmV0dXJuIC1FSU5W
QUw7CiAKIAlkcGlfaW5pdF9wbGwoZHBpKTsKIAotCXJldHVybiBvbWFwZHNzX2RldmljZV9jb25u
ZWN0KGRzdC0+ZHNzLCBkc3QsIGRzdC0+bmV4dCk7CisJcmV0dXJuIGRybV9icmlkZ2VfYXR0YWNo
KGJyaWRnZS0+ZW5jb2RlciwgZHBpLT5vdXRwdXQubmV4dF9icmlkZ2UsCisJCQkJIGJyaWRnZSwg
ZmxhZ3MpOwogfQogCi1zdGF0aWMgdm9pZCBkcGlfZGlzY29ubmVjdChzdHJ1Y3Qgb21hcF9kc3Nf
ZGV2aWNlICpzcmMsCi0JCQkgICBzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpkc3QpCitzdGF0aWMg
ZW51bSBkcm1fbW9kZV9zdGF0dXMKK2RwaV9icmlkZ2VfbW9kZV92YWxpZChzdHJ1Y3QgZHJtX2Jy
aWRnZSAqYnJpZGdlLAorCQkgICAgICAgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1v
ZGUpCiB7Ci0Jb21hcGRzc19kZXZpY2VfZGlzY29ubmVjdChkc3QsIGRzdC0+bmV4dCk7CisJc3Ry
dWN0IGRwaV9kYXRhICpkcGkgPSBkcm1fYnJpZGdlX3RvX2RwaShicmlkZ2UpOworCXVuc2lnbmVk
IGxvbmcgY2xvY2sgPSBtb2RlLT5jbG9jayAqIDEwMDA7CisJaW50IHJldDsKKworCWlmIChtb2Rl
LT5oZGlzcGxheSAlIDggIT0gMCkKKwkJcmV0dXJuIE1PREVfQkFEX1dJRFRIOworCisJaWYgKG1v
ZGUtPmNsb2NrID09IDApCisJCXJldHVybiBNT0RFX05PQ0xPQ0s7CisKKwlyZXQgPSBkcGlfY2xv
Y2tfdXBkYXRlKGRwaSwgJmNsb2NrKTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0dXJuIE1PREVfQ0xP
Q0tfUkFOR0U7CisKKwlyZXR1cm4gTU9ERV9PSzsKK30KKworc3RhdGljIGJvb2wgZHBpX2JyaWRn
ZV9tb2RlX2ZpeHVwKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UsCisJCQkJICAgY29uc3Qgc3Ry
dWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUsCisJCQkJICAgc3RydWN0IGRybV9kaXNwbGF5X21v
ZGUgKmFkanVzdGVkX21vZGUpCit7CisJc3RydWN0IGRwaV9kYXRhICpkcGkgPSBkcm1fYnJpZGdl
X3RvX2RwaShicmlkZ2UpOworCXVuc2lnbmVkIGxvbmcgY2xvY2sgPSBtb2RlLT5jbG9jayAqIDEw
MDA7CisJaW50IHJldDsKKworCXJldCA9IGRwaV9jbG9ja191cGRhdGUoZHBpLCAmY2xvY2spOwor
CWlmIChyZXQgPCAwKQorCQlyZXR1cm4gZmFsc2U7CisKKwlhZGp1c3RlZF9tb2RlLT5jbG9jayA9
IGNsb2NrIC8gMTAwMDsKKworCXJldHVybiB0cnVlOworfQorCitzdGF0aWMgdm9pZCBkcGlfYnJp
ZGdlX21vZGVfc2V0KHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UsCisJCQkJIGNvbnN0IHN0cnVj
dCBkcm1fZGlzcGxheV9tb2RlICptb2RlLAorCQkJCSBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlf
bW9kZSAqYWRqdXN0ZWRfbW9kZSkKK3sKKwlzdHJ1Y3QgZHBpX2RhdGEgKmRwaSA9IGRybV9icmlk
Z2VfdG9fZHBpKGJyaWRnZSk7CisKKwltdXRleF9sb2NrKCZkcGktPmxvY2spOworCWRwaS0+cGl4
ZWxjbG9jayA9IGFkanVzdGVkX21vZGUtPmNsb2NrICogMTAwMDsKKwltdXRleF91bmxvY2soJmRw
aS0+bG9jayk7CiB9CiAKLXN0YXRpYyB2b2lkIGRwaV9kaXNwbGF5X2VuYWJsZShzdHJ1Y3Qgb21h
cF9kc3NfZGV2aWNlICpkc3NkZXYpCitzdGF0aWMgdm9pZCBkcGlfYnJpZGdlX2VuYWJsZShzdHJ1
Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAorCQkJICAgICAgIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRl
ICpzdGF0ZSkKIHsKLQlzdHJ1Y3QgZHBpX2RhdGEgKmRwaSA9IGRwaV9nZXRfZGF0YV9mcm9tX2Rz
c2Rldihkc3NkZXYpOwotCXN0cnVjdCBvbWFwX2Rzc19kZXZpY2UgKm91dCA9ICZkcGktPm91dHB1
dDsKKwlzdHJ1Y3QgZHBpX2RhdGEgKmRwaSA9IGRybV9icmlkZ2VfdG9fZHBpKGJyaWRnZSk7CiAJ
aW50IHI7CiAKIAltdXRleF9sb2NrKCZkcGktPmxvY2spOwpAQCAtNDI4LDcgKzUwMSw3IEBAIHN0
YXRpYyB2b2lkIGRwaV9kaXNwbGF5X2VuYWJsZShzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpkc3Nk
ZXYpCiAJaWYgKHIpCiAJCWdvdG8gZXJyX2dldF9kaXNwYzsKIAotCXIgPSBkc3NfZHBpX3NlbGVj
dF9zb3VyY2UoZHBpLT5kc3MsIGRwaS0+aWQsIG91dC0+ZGlzcGNfY2hhbm5lbCk7CisJciA9IGRz
c19kcGlfc2VsZWN0X3NvdXJjZShkcGktPmRzcywgZHBpLT5pZCwgZHBpLT5vdXRwdXQuZGlzcGNf
Y2hhbm5lbCk7CiAJaWYgKHIpCiAJCWdvdG8gZXJyX3NyY19zZWw7CiAKQEAgLTQ2OCw5ICs1NDEs
MTAgQEAgc3RhdGljIHZvaWQgZHBpX2Rpc3BsYXlfZW5hYmxlKHN0cnVjdCBvbWFwX2Rzc19kZXZp
Y2UgKmRzc2RldikKIAltdXRleF91bmxvY2soJmRwaS0+bG9jayk7CiB9CiAKLXN0YXRpYyB2b2lk
IGRwaV9kaXNwbGF5X2Rpc2FibGUoc3RydWN0IG9tYXBfZHNzX2RldmljZSAqZHNzZGV2KQorc3Rh
dGljIHZvaWQgZHBpX2JyaWRnZV9kaXNhYmxlKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UsCisJ
CQkJc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQogewotCXN0cnVjdCBkcGlfZGF0YSAq
ZHBpID0gZHBpX2dldF9kYXRhX2Zyb21fZHNzZGV2KGRzc2Rldik7CisJc3RydWN0IGRwaV9kYXRh
ICpkcGkgPSBkcm1fYnJpZGdlX3RvX2RwaShicmlkZ2UpOwogCiAJbXV0ZXhfbG9jaygmZHBpLT5s
b2NrKTsKIApAQCAtNDkwLDcxICs1NjQsMzMgQEAgc3RhdGljIHZvaWQgZHBpX2Rpc3BsYXlfZGlz
YWJsZShzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpkc3NkZXYpCiAJbXV0ZXhfdW5sb2NrKCZkcGkt
PmxvY2spOwogfQogCi1zdGF0aWMgaW50IGRwaV9jaGVja190aW1pbmdzKHN0cnVjdCBvbWFwX2Rz
c19kZXZpY2UgKmRzc2RldiwKLQkJCSAgICAgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUp
Ci17Ci0Jc3RydWN0IGRwaV9kYXRhICpkcGkgPSBkcGlfZ2V0X2RhdGFfZnJvbV9kc3NkZXYoZHNz
ZGV2KTsKLQlpbnQgbGNrX2RpdiwgcGNrX2RpdjsKLQl1bnNpZ25lZCBsb25nIGZjazsKLQl1bnNp
Z25lZCBsb25nIHBjazsKLQlzdHJ1Y3QgZHBpX2Nsa19jYWxjX2N0eCBjdHg7Ci0JYm9vbCBvazsK
LQotCWlmIChtb2RlLT5oZGlzcGxheSAlIDggIT0gMCkKLQkJcmV0dXJuIC1FSU5WQUw7Ci0KLQlp
ZiAobW9kZS0+Y2xvY2sgPT0gMCkKLQkJcmV0dXJuIC1FSU5WQUw7Ci0KLQlpZiAoZHBpLT5wbGwp
IHsKLQkJb2sgPSBkcGlfcGxsX2Nsa19jYWxjKGRwaSwgbW9kZS0+Y2xvY2sgKiAxMDAwLCAmY3R4
KTsKLQkJaWYgKCFvaykKLQkJCXJldHVybiAtRUlOVkFMOwotCi0JCWZjayA9IGN0eC5wbGxfY2lu
Zm8uY2xrb3V0W2N0eC5jbGtvdXRfaWR4XTsKLQl9IGVsc2UgewotCQlvayA9IGRwaV9kc3NfY2xr
X2NhbGMoZHBpLCBtb2RlLT5jbG9jayAqIDEwMDAsICZjdHgpOwotCQlpZiAoIW9rKQotCQkJcmV0
dXJuIC1FSU5WQUw7Ci0KLQkJZmNrID0gY3R4LmZjazsKLQl9Ci0KLQlsY2tfZGl2ID0gY3R4LmRp
c3BjX2NpbmZvLmxja19kaXY7Ci0JcGNrX2RpdiA9IGN0eC5kaXNwY19jaW5mby5wY2tfZGl2Owot
Ci0JcGNrID0gZmNrIC8gbGNrX2RpdiAvIHBja19kaXY7Ci0KLQltb2RlLT5jbG9jayA9IHBjayAv
IDEwMDA7Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIHZvaWQgZHBpX3NldF90aW1pbmdzKHN0
cnVjdCBvbWFwX2Rzc19kZXZpY2UgKmRzc2RldiwKLQkJCSAgICBjb25zdCBzdHJ1Y3QgZHJtX2Rp
c3BsYXlfbW9kZSAqbW9kZSkKLXsKLQlzdHJ1Y3QgZHBpX2RhdGEgKmRwaSA9IGRwaV9nZXRfZGF0
YV9mcm9tX2Rzc2Rldihkc3NkZXYpOwotCi0JRFNTREJHKCJkcGlfc2V0X3RpbWluZ3NcbiIpOwot
Ci0JbXV0ZXhfbG9jaygmZHBpLT5sb2NrKTsKLQotCWRwaS0+cGl4ZWxjbG9jayA9IG1vZGUtPmNs
b2NrICogMTAwMDsKLQotCW11dGV4X3VubG9jaygmZHBpLT5sb2NrKTsKLX0KLQotc3RhdGljIGNv
bnN0IHN0cnVjdCBvbWFwX2Rzc19kZXZpY2Vfb3BzIGRwaV9vcHMgPSB7Ci0JLmNvbm5lY3QgPSBk
cGlfY29ubmVjdCwKLQkuZGlzY29ubmVjdCA9IGRwaV9kaXNjb25uZWN0LAotCi0JLmVuYWJsZSA9
IGRwaV9kaXNwbGF5X2VuYWJsZSwKLQkuZGlzYWJsZSA9IGRwaV9kaXNwbGF5X2Rpc2FibGUsCi0K
LQkuY2hlY2tfdGltaW5ncyA9IGRwaV9jaGVja190aW1pbmdzLAotCS5zZXRfdGltaW5ncyA9IGRw
aV9zZXRfdGltaW5ncywKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2JyaWRnZV9mdW5jcyBkcGlf
YnJpZGdlX2Z1bmNzID0geworCS5hdHRhY2ggPSBkcGlfYnJpZGdlX2F0dGFjaCwKKwkubW9kZV92
YWxpZCA9IGRwaV9icmlkZ2VfbW9kZV92YWxpZCwKKwkubW9kZV9maXh1cCA9IGRwaV9icmlkZ2Vf
bW9kZV9maXh1cCwKKwkubW9kZV9zZXQgPSBkcGlfYnJpZGdlX21vZGVfc2V0LAorCS5hdG9taWNf
ZW5hYmxlID0gZHBpX2JyaWRnZV9lbmFibGUsCisJLmF0b21pY19kaXNhYmxlID0gZHBpX2JyaWRn
ZV9kaXNhYmxlLAogfTsKIAorc3RhdGljIHZvaWQgZHBpX2JyaWRnZV9pbml0KHN0cnVjdCBkcGlf
ZGF0YSAqZHBpKQoreworCWRwaS0+YnJpZGdlLmZ1bmNzID0gJmRwaV9icmlkZ2VfZnVuY3M7CisJ
ZHBpLT5icmlkZ2Uub2Zfbm9kZSA9IGRwaS0+cGRldi0+ZGV2Lm9mX25vZGU7CisJZHBpLT5icmlk
Z2UudHlwZSA9IERSTV9NT0RFX0NPTk5FQ1RPUl9EUEk7CisKKwlkcm1fYnJpZGdlX2FkZCgmZHBp
LT5icmlkZ2UpOworfQorCitzdGF0aWMgdm9pZCBkcGlfYnJpZGdlX2NsZWFudXAoc3RydWN0IGRw
aV9kYXRhICpkcGkpCit7CisJZHJtX2JyaWRnZV9yZW1vdmUoJmRwaS0+YnJpZGdlKTsKK30KKwor
LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqIEluaXRpYWxpc2F0aW9uIGFuZCBDbGVhbnVwCisg
Ki8KKwogLyoKICAqIFJldHVybiBhIGhhcmRjb2RlZCBjaGFubmVsIGZvciB0aGUgRFBJIG91dHB1
dC4gVGhpcyBzaG91bGQgd29yayBmb3IKICAqIGN1cnJlbnQgdXNlIGNhc2VzLCBidXQgdGhpcyBj
YW4gYmUgbGF0ZXIgZXhwYW5kZWQgdG8gZWl0aGVyIHJlc29sdmUKQEAgLTU5Nyw2ICs2MzMsOCBA
QCBzdGF0aWMgaW50IGRwaV9pbml0X291dHB1dF9wb3J0KHN0cnVjdCBkcGlfZGF0YSAqZHBpLCBz
dHJ1Y3QgZGV2aWNlX25vZGUgKnBvcnQpCiAJdTMyIHBvcnRfbnVtID0gMDsKIAlpbnQgcjsKIAor
CWRwaV9icmlkZ2VfaW5pdChkcGkpOworCiAJb2ZfcHJvcGVydHlfcmVhZF91MzIocG9ydCwgInJl
ZyIsICZwb3J0X251bSk7CiAJZHBpLT5pZCA9IHBvcnRfbnVtIDw9IDIgPyBwb3J0X251bSA6IDA7
CiAKQEAgLTYxOCwxMCArNjU2LDkgQEAgc3RhdGljIGludCBkcGlfaW5pdF9vdXRwdXRfcG9ydChz
dHJ1Y3QgZHBpX2RhdGEgKmRwaSwgc3RydWN0IGRldmljZV9ub2RlICpwb3J0KQogCW91dC0+dHlw
ZSA9IE9NQVBfRElTUExBWV9UWVBFX0RQSTsKIAlvdXQtPmRpc3BjX2NoYW5uZWwgPSBkcGlfZ2V0
X2NoYW5uZWwoZHBpKTsKIAlvdXQtPm9mX3BvcnQgPSBwb3J0X251bTsKLQlvdXQtPm9wcyA9ICZk
cGlfb3BzOwogCW91dC0+b3duZXIgPSBUSElTX01PRFVMRTsKIAotCXIgPSBvbWFwZHNzX2Rldmlj
ZV9pbml0X291dHB1dChvdXQsIE5VTEwpOworCXIgPSBvbWFwZHNzX2RldmljZV9pbml0X291dHB1
dChvdXQsICZkcGktPmJyaWRnZSk7CiAJaWYgKHIgPCAwKQogCQlyZXR1cm4gcjsKIApAQCAtNjM3
LDYgKzY3NCw4IEBAIHN0YXRpYyB2b2lkIGRwaV91bmluaXRfb3V0cHV0X3BvcnQoc3RydWN0IGRl
dmljZV9ub2RlICpwb3J0KQogCiAJb21hcGRzc19kZXZpY2VfdW5yZWdpc3RlcihvdXQpOwogCW9t
YXBkc3NfZGV2aWNlX2NsZWFudXBfb3V0cHV0KG91dCk7CisKKwlkcGlfYnJpZGdlX2NsZWFudXAo
ZHBpKTsKIH0KIAogLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0gClJlZ2FyZHMsCgpMYXVyZW50
IFBpbmNoYXJ0CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
XwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcK
aHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
