Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 63AB5AEE9E
	for <lists+dri-devel@lfdr.de>; Tue, 10 Sep 2019 17:36:30 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 837916E913;
	Tue, 10 Sep 2019 15:36:23 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mslow2.mail.gandi.net (mslow2.mail.gandi.net [217.70.178.242])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9BE5C6E911
 for <dri-devel@lists.freedesktop.org>; Tue, 10 Sep 2019 15:36:19 +0000 (UTC)
Received: from relay1-d.mail.gandi.net (unknown [217.70.183.193])
 by mslow2.mail.gandi.net (Postfix) with ESMTP id 5A8183AEA21
 for <dri-devel@lists.freedesktop.org>; Tue, 10 Sep 2019 15:34:49 +0000 (UTC)
X-Originating-IP: 86.250.200.211
Received: from localhost.localdomain (lfbn-1-17395-211.w86-250.abo.wanadoo.fr
 [86.250.200.211])
 (Authenticated sender: paul.kocialkowski@bootlin.com)
 by relay1-d.mail.gandi.net (Postfix) with ESMTPSA id 78BB8240010;
 Tue, 10 Sep 2019 15:34:26 +0000 (UTC)
From: Paul Kocialkowski <paul.kocialkowski@bootlin.com>
To: dri-devel@lists.freedesktop.org, devicetree@vger.kernel.org,
 linux-kernel@vger.kernel.org
Subject: [PATCH 2/2] drm: Add support for the LogiCVC display controller
Date: Tue, 10 Sep 2019 17:34:09 +0200
Message-Id: <20190910153409.111901-3-paul.kocialkowski@bootlin.com>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190910153409.111901-1-paul.kocialkowski@bootlin.com>
References: <20190910153409.111901-1-paul.kocialkowski@bootlin.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Mark Rutland <mark.rutland@arm.com>, David Airlie <airlied@linux.ie>,
 Paul Kocialkowski <paul.kocialkowski@bootlin.com>,
 Maxime Ripard <maxime.ripard@bootlin.com>, Rob Herring <robh+dt@kernel.org>,
 Sean Paul <sean@poorly.run>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW50cm9kdWNlcyBhIGRyaXZlciBmb3IgdGhlIExvZ2lDVkMgZGlzcGxheSBjb250cm9sbGVyLCBh
IHByb2dyYW1tYWJsZQpsb2dpYyBjb250cm9sbGVyIG9wdGltaXplZCBmb3IgdXNlIGluIFhpbGlu
eCBaeW5xLTcwMDAgU29DcyBhbmQgb3RoZXIKWGlsaW54IEZQR0FzLiBUaGUgY29udHJvbGxlciBp
cyBtb3N0bHkgY29uZmlndXJlZCBhdCBsb2dpYyBzeW50aGVzaXMKdGltZSBzbyBvbmx5IGEgc3Vi
c2V0IG9mIGNvbmZpZ3VyYXRpb24gaXMgbGVmdCBmb3IgdGhlIGRyaXZlciB0bwpoYW5kbGUuCgpU
aGUgZm9sbG93aW5nIGZlYXR1cmVzIGFyZSBpbXBsZW1lbnRlZCBhbmQgdGVzdGVkOgotIExWRFMg
NC1iaXQgaW50ZXJmYWNlOwotIFJHQjU2NSBwaXhlbCBmb3JtYXRzOwotIE11bHRpcGxlIGxheWVy
cyBhbmQgaGFyZHdhcmUgY29tcG9zaXRpb247Ci0gTGF5ZXItd2lkZSBhbHBoYSBtb2RlOwoKVGhl
IGZvbGxvd2luZyBmZWF0dXJlcyBhcmUgaW1wbGVtZW50ZWQgYnV0IHVudGVzdGVkOgotIE90aGVy
IFJHQiBwaXhlbCBmb3JtYXRzOwotIExheWVyIGZyYW1lYnVmZmVyIGNvbmZpZ3VyYXRpb24gZm9y
IHZlcnNpb24gNDsKLSBMb3dlc3QtbGF5ZXIgdXNlZCBhcyBiYWNrZ3JvdW5kIGNvbG9yOwotIFBl
ci1waXhlbCBhbHBoYSBtb2RlLgoKVGhlIGZvbGxvd2luZyBmZWF0dXJlcyBhcmUgbm90IGltcGxl
bWVudGVkOgotIFlVViBwaXhlbCBmb3JtYXRzOwotIERWSSwgTFZEUyAzLWJpdCwgSVRVNjU2IGFu
ZCBjYW1lcmEgbGluayBpbnRlcmZhY2VzOwotIEV4dGVybmFsIHBhcmFsbGVsIGlucHV0IGZvciBs
YXllcjsKLSBDb2xvci1rZXlpbmc7Ci0gTFVULWJhc2VkIGFscGhhIG1vZGVzLgoKQWRkaXRpb25h
bCBpbXBsZW1lbnRhdGlvbi1zcGVjaWZpYyBub3RlczoKLSBQYW5lbHMgYXJlIG9ubHkgZW5hYmxl
ZCBhZnRlciB0aGUgZmlyc3QgcGFnZSBmbGlwIHRvIGF2b2lkIGZsYXNoaW5nIGEKICB3aGl0ZSBz
Y3JlZW4uCi0gRGVwdGggdXNlZCBpbiBjb250ZXh0IG9mIHRoZSBMb2dpQ1ZDIGRyaXZlciBvbmx5
IGNvdW50cyBjb2xvciBjb21wb25lbnRzCiAgdG8gbWF0Y2ggdGhlIGRlZmluaXRpb24gb2YgdGhl
IHN5bnRoZXNpcyBwYXJhbWV0ZXJzLgoKU3VwcG9ydCBpcyBpbXBsZW1lbnRlZCBmb3IgYm90aCB2
ZXJzaW9uIDMgYW5kIDQgb2YgdGhlIGNvbnRyb2xsZXIuCgpXaXRoIHZlcnNpb24gMywgZnJhbWVi
dWZmZXJzIGFyZSBzdG9yZWQgaW4gYSBkZWRpY2F0ZWQgY29udGlndW91cwptZW1vcnkgYXJlYSwg
d2l0aCBhIGJhc2UgYWRkcmVzcyBoYXJkY29kZWQgZm9yIGVhY2ggbGF5ZXIuIFRoaXMgcmVxdWly
ZXMKdXNpbmcgYSBkZWRpY2F0ZWQgQ01BIHBvb2wgcmVnaXN0ZXJlZCBhdCB0aGUgYmFzZSBhZGRy
ZXNzIGFuZCB0d2Vha2luZyBhCmZldyBvZmZzZXQtcmVsYXRlZCByZWdpc3RlcnMgdG8gdHJ5IHRv
IHVzZSBhbnkgYnVmZmVyIGFsbG9jYXRlZCBmcm9tCnRoZSBwb29sLiBUaGlzIGlzIGRvbmUgb24g
YSBiZXN0LWVmZm9ydCBiYXNpcyB0byBoYXZlIHRoZSBoYXJkd2FyZSBjb3BlCndpdGggdGhlIERS
TSBmcmFtZWJ1ZmZlciBhbGxvY2F0aW9uIG1vZGVsIGFuZCB0aGVyZSBpcyBubyBndWFyYW50ZWUK
dGhhdCBlYWNoIGJ1ZmZlciBhbGxvY2F0ZWQgYnkgR0VNIENNQSBjYW4gYmUgdXNlZCBmb3IgYW55
IGxheWVyLgpJbiBwYXJ0aWN1bGFyLCBidWZmZXJzIGFsbG9jYXRlZCBiZWxvdyB0aGUgYmFzZSBh
ZGRyZXNzIGZvciBhIGxheWVyIGFyZQpndWFyYW50ZWVkIG5vdCB0byBiZSBjb25maWd1cmFibGUg
Zm9yIHRoYXQgbGF5ZXIuIFNlZSB0aGUgaW1wbGVtZW50YXRpb24gb2YKbG9naWN2Y19sYXllcl9i
dWZmZXJfZmluZF9zZXR1cCBmb3Igc3BlY2lmaWNzLgoKVmVyc2lvbiA0IGFsbG93cyBjb25maWd1
cmluZyBlYWNoIGJ1ZmZlciBhZGRyZXNzIGRpcmVjdGx5LCB3aGljaApndWFyYW50ZWVzIHRoYXQg
YW55IGJ1ZmZlciBjYW4gYmUgY29uZmlndXJlZC4KClNpZ25lZC1vZmYtYnk6IFBhdWwgS29jaWFs
a293c2tpIDxwYXVsLmtvY2lhbGtvd3NraUBib290bGluLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9k
cm0vS2NvbmZpZyAgICAgICAgICAgICAgICAgICAgIHwgICAyICsKIGRyaXZlcnMvZ3B1L2RybS9N
YWtlZmlsZSAgICAgICAgICAgICAgICAgICAgfCAgIDEgKwogZHJpdmVycy9ncHUvZHJtL2xvZ2lj
dmMvS2NvbmZpZyAgICAgICAgICAgICB8ICAgOCArCiBkcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9N
YWtlZmlsZSAgICAgICAgICAgIHwgICA0ICsKIGRyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2lj
dmNfY3J0Yy5jICAgICAgfCAyNzIgKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9s
b2dpY3ZjX2NydGMuaCAgICAgIHwgIDI1ICsKIGRyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2lj
dmNfZHJtLmMgICAgICAgfCA0NTcgKysrKysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vbG9n
aWN2Yy9sb2dpY3ZjX2RybS5oICAgICAgIHwgIDYwICsrCiBkcml2ZXJzL2dwdS9kcm0vbG9naWN2
Yy9sb2dpY3ZjX2ludGVyZmFjZS5jIHwgMjM1ICsrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vbG9n
aWN2Yy9sb2dpY3ZjX2ludGVyZmFjZS5oIHwgIDMyICsrCiBkcml2ZXJzL2dwdS9kcm0vbG9naWN2
Yy9sb2dpY3ZjX2xheWVyLmMgICAgIHwgNTk0ICsrKysrKysrKysrKysrKysrKysrCiBkcml2ZXJz
L2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2xheWVyLmggICAgIHwgIDY1ICsrKwogZHJpdmVycy9n
cHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19tb2RlLmMgICAgICB8IDEwMyArKysrCiBkcml2ZXJzL2dw
dS9kcm0vbG9naWN2Yy9sb2dpY3ZjX21vZGUuaCAgICAgIHwgIDE1ICsKIGRyaXZlcnMvZ3B1L2Ry
bS9sb2dpY3ZjL2xvZ2ljdmNfb2YuYyAgICAgICAgfCAyMDQgKysrKysrKwogZHJpdmVycy9ncHUv
ZHJtL2xvZ2ljdmMvbG9naWN2Y19vZi5oICAgICAgICB8ICAyOCArCiBkcml2ZXJzL2dwdS9kcm0v
bG9naWN2Yy9sb2dpY3ZjX3JlZ3MuaCAgICAgIHwgIDg4ICsrKwogMTcgZmlsZXMgY2hhbmdlZCwg
MjE5MyBpbnNlcnRpb25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xv
Z2ljdmMvS2NvbmZpZwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9sb2dpY3Zj
L01ha2VmaWxlCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9n
aWN2Y19jcnRjLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9s
b2dpY3ZjX2NydGMuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9sb2dpY3Zj
L2xvZ2ljdmNfZHJtLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9naWN2
Yy9sb2dpY3ZjX2RybS5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvZ2lj
dmMvbG9naWN2Y19pbnRlcmZhY2UuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2Ry
bS9sb2dpY3ZjL2xvZ2ljdmNfaW50ZXJmYWNlLmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJz
L2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2xheWVyLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2
ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2xheWVyLmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBk
cml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX21vZGUuYwogY3JlYXRlIG1vZGUgMTAwNjQ0
IGRyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfbW9kZS5oCiBjcmVhdGUgbW9kZSAxMDA2
NDQgZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19vZi5jCiBjcmVhdGUgbW9kZSAxMDA2
NDQgZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19vZi5oCiBjcmVhdGUgbW9kZSAxMDA2
NDQgZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19yZWdzLmgKCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vS2NvbmZpZyBiL2RyaXZlcnMvZ3B1L2RybS9LY29uZmlnCmluZGV4IGNk
MTFhM2JkZTE5Yy4uZjU1ZmM1OWViYWQ2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vS2Nv
bmZpZworKysgYi9kcml2ZXJzL2dwdS9kcm0vS2NvbmZpZwpAQCAtMzM4LDYgKzMzOCw4IEBAIHNv
dXJjZSAiZHJpdmVycy9ncHUvZHJtL2FyYy9LY29uZmlnIgogCiBzb3VyY2UgImRyaXZlcnMvZ3B1
L2RybS9oaXNpbGljb24vS2NvbmZpZyIKIAorc291cmNlICJkcml2ZXJzL2dwdS9kcm0vbG9naWN2
Yy9LY29uZmlnIgorCiBzb3VyY2UgImRyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9LY29uZmlnIgog
CiBzb3VyY2UgImRyaXZlcnMvZ3B1L2RybS96dGUvS2NvbmZpZyIKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9NYWtlZmlsZQppbmRleCA1NDVj
NjFkNjUyOGIuLjJiNWYyMWUyMGEyNiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL01ha2Vm
aWxlCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9NYWtlZmlsZQpAQCAtMTA0LDYgKzEwNCw3IEBAIG9i
ai0kKENPTkZJR19EUk1fU1RNKSArPSBzdG0vCiBvYmotJChDT05GSUdfRFJNX1NUSSkgKz0gc3Rp
Lwogb2JqLSQoQ09ORklHX0RSTV9JTVgpICs9IGlteC8KIG9iai0kKENPTkZJR19EUk1fSU5HRU5J
QykgKz0gaW5nZW5pYy8KK29iai0kKENPTkZJR19EUk1fTE9HSUNWQykgKz0gbG9naWN2Yy8KIG9i
ai0kKENPTkZJR19EUk1fTUVESUFURUspICs9IG1lZGlhdGVrLwogb2JqLSQoQ09ORklHX0RSTV9N
RVNPTikJKz0gbWVzb24vCiBvYmoteQkJCSs9IGkyYy8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9sb2dpY3ZjL0tjb25maWcgYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9LY29uZmlnCm5l
dyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMzRkYWNhYmJiNDlhCi0tLSAv
ZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvS2NvbmZpZwpAQCAtMCwwICsx
LDggQEAKK2NvbmZpZyBEUk1fTE9HSUNWQworCXRyaXN0YXRlICJMb2dpQ1ZDIERSTSIKKwlkZXBl
bmRzIG9uIERSTQorCXNlbGVjdCBEUk1fS01TX0hFTFBFUgorCXNlbGVjdCBEUk1fS01TX0NNQV9I
RUxQRVIKKwlzZWxlY3QgRFJNX0dFTV9DTUFfSEVMUEVSCisJaGVscAorCSAgRFJNIGRpc3BsYXkg
ZHJpdmVyIGZvciB0aGUgbG9naUNWQyBwcm9ncmFtbWFibGUgbG9naWMgYmxvY2sgZnJvbSBYeWxv
bgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvTWFrZWZpbGUgYi9kcml2ZXJz
L2dwdS9kcm0vbG9naWN2Yy9NYWtlZmlsZQpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAw
MDAwMDAwMDAuLmMwOTUzMWZiZDZhZAotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9sb2dpY3ZjL01ha2VmaWxlCkBAIC0wLDAgKzEsNCBAQAorbG9naWN2Yy1kcm0teSArPSBsb2dp
Y3ZjX2NydGMubyBsb2dpY3ZjX2RybS5vIGxvZ2ljdmNfaW50ZXJmYWNlLm8gXAorCQkgbG9naWN2
Y19sYXllci5vIGxvZ2ljdmNfbW9kZS5vIGxvZ2ljdmNfb2YubworCitvYmotJChDT05GSUdfRFJN
X0xPR0lDVkMpICs9IGxvZ2ljdmMtZHJtLm8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9s
b2dpY3ZjL2xvZ2ljdmNfY3J0Yy5jIGIvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19j
cnRjLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5mMTNhYjYyZDE4
ZWYKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2Ny
dGMuYwpAQCAtMCwwICsxLDI3MiBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0y
LjArCisvKgorICogQ29weXJpZ2h0IChDKSAyMDE5IEJvb3RsaW4KKyAqIEF1dGhvcjogUGF1bCBL
b2NpYWxrb3dza2kgPHBhdWwua29jaWFsa293c2tpQGJvb3RsaW4uY29tPgorICovCisKKyNpbmNs
dWRlIDxsaW51eC9vZi5oPgorI2luY2x1ZGUgPGxpbnV4L29mX2dyYXBoLmg+CisjaW5jbHVkZSA8
bGludXgvdHlwZXMuaD4KKyNpbmNsdWRlIDxsaW51eC93b3JrcXVldWUuaD4KKyNpbmNsdWRlIDxk
cm0vZHJtX2F0b21pY19oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2NydGMuaD4KKyNpbmNs
dWRlIDxkcm0vZHJtX2Rydi5oPgorI2luY2x1ZGUgPGRybS9kcm1fZ2VtX2NtYV9oZWxwZXIuaD4K
KyNpbmNsdWRlIDxkcm0vZHJtX3ByaW50Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV92YmxhbmsuaD4K
KworI2luY2x1ZGUgImxvZ2ljdmNfY3J0Yy5oIgorI2luY2x1ZGUgImxvZ2ljdmNfZHJtLmgiCisj
aW5jbHVkZSAibG9naWN2Y19pbnRlcmZhY2UuaCIKKyNpbmNsdWRlICJsb2dpY3ZjX2xheWVyLmgi
CisjaW5jbHVkZSAibG9naWN2Y19yZWdzLmgiCisKKyNkZWZpbmUgbG9naWN2Y19jcnRjKGMpIFwK
Kwljb250YWluZXJfb2YoYywgc3RydWN0IGxvZ2ljdmNfY3J0YywgZHJtX2NydGMpCisKK3N0YXRp
YyBpbnQgbG9naWN2Y19jcnRjX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX2NydGMgKmRybV9jcnRj
LAorCQkJCSAgICAgc3RydWN0IGRybV9jcnRjX3N0YXRlICpzdGF0ZSkKK3sKKwlzdHJ1Y3QgZHJt
X2Rpc3BsYXlfbW9kZSAqbW9kZSA9ICZzdGF0ZS0+YWRqdXN0ZWRfbW9kZTsKKworCWlmIChtb2Rl
LT5mbGFncyAmIERSTV9NT0RFX0ZMQUdfSU5URVJMQUNFKQorCQlyZXR1cm4gLUVJTlZBTDsKKwor
CXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBsb2dpY3ZjX2NydGNfYXRvbWljX2JlZ2luKHN0
cnVjdCBkcm1fY3J0YyAqZHJtX2NydGMsCisJCQkJICAgICAgc3RydWN0IGRybV9jcnRjX3N0YXRl
ICpvbGRfc3RhdGUpCit7CisJc3RydWN0IGxvZ2ljdmNfY3J0YyAqY3J0YyA9IGxvZ2ljdmNfY3J0
Yyhkcm1fY3J0Yyk7CisJc3RydWN0IGRybV9kZXZpY2UgKmRybSA9IGRybV9jcnRjLT5kZXY7CisJ
dW5zaWduZWQgbG9uZyBmbGFnczsKKworCS8qIFJlZ2lzdGVyIHBlbmRpbmcgZXZlbnQsIG9ubHkg
aWYgdmJsYW5rIGlzIGFscmVhZHkgb24uICovCisJaWYgKGRybV9jcnRjLT5zdGF0ZS0+ZXZlbnQg
JiYgb2xkX3N0YXRlLT5hY3RpdmUpIHsKKwkJV0FSTl9PTihkcm1fY3J0Y192YmxhbmtfZ2V0KGRy
bV9jcnRjKSAhPSAwKTsKKworCQlzcGluX2xvY2tfaXJxc2F2ZSgmZHJtLT5ldmVudF9sb2NrLCBm
bGFncyk7CisJCWNydGMtPmV2ZW50ID0gZHJtX2NydGMtPnN0YXRlLT5ldmVudDsKKwkJc3Bpbl91
bmxvY2tfaXJxcmVzdG9yZSgmZHJtLT5ldmVudF9sb2NrLCBmbGFncyk7CisKKwkJZHJtX2NydGMt
PnN0YXRlLT5ldmVudCA9IE5VTEw7CisJfQorfQorCitzdGF0aWMgdm9pZCBsb2dpY3ZjX2NydGNf
YXRvbWljX2VuYWJsZShzdHJ1Y3QgZHJtX2NydGMgKmRybV9jcnRjLAorCQkJCSAgICAgICBzdHJ1
Y3QgZHJtX2NydGNfc3RhdGUgKm9sZF9zdGF0ZSkKK3sKKwlzdHJ1Y3QgbG9naWN2Y19jcnRjICpj
cnRjID0gbG9naWN2Y19jcnRjKGRybV9jcnRjKTsKKwlzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2lj
dmMgPSBjcnRjLT5sb2dpY3ZjOworCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlID0gJmRy
bV9jcnRjLT5zdGF0ZS0+YWRqdXN0ZWRfbW9kZTsKKwlzdHJ1Y3QgZHJtX2RldmljZSAqZHJtID0g
ZHJtX2NydGMtPmRldjsKKwl1bnNpZ25lZCBpbnQgaGFjdCwgaGZwLCBoc2wsIGhicDsKKwl1bnNp
Z25lZCBpbnQgdmFjdCwgdmZwLCB2c2wsIHZicDsKKwl1bnNpZ25lZCBsb25nIGZsYWdzOworCXUz
MiBjdHJsOworCisJLyogVGltaW5ncyAqLworCisJaGFjdCA9IG1vZGUtPmhkaXNwbGF5OworCWhm
cCA9IG1vZGUtPmhzeW5jX3N0YXJ0IC0gbW9kZS0+aGRpc3BsYXk7CisJaHNsID0gbW9kZS0+aHN5
bmNfZW5kIC0gbW9kZS0+aHN5bmNfc3RhcnQ7CisJaGJwID0gbW9kZS0+aHRvdGFsIC0gbW9kZS0+
aHN5bmNfZW5kOworCisJdmFjdCA9IG1vZGUtPnZkaXNwbGF5OworCXZmcCA9IG1vZGUtPnZzeW5j
X3N0YXJ0IC0gbW9kZS0+dmRpc3BsYXk7CisJdnNsID0gbW9kZS0+dnN5bmNfZW5kIC0gbW9kZS0+
dnN5bmNfc3RhcnQ7CisJdmJwID0gbW9kZS0+dnRvdGFsIC0gbW9kZS0+dnN5bmNfZW5kOworCisJ
cmVnbWFwX3dyaXRlKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNWQ19IU1lOQ19GUk9OVF9QT1JDSF9S
RUcsIGhmcCAtIDEpOworCXJlZ21hcF93cml0ZShsb2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNfSFNZ
TkNfUkVHLCBoc2wgLSAxKTsKKwlyZWdtYXBfd3JpdGUobG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZD
X0hTWU5DX0JBQ0tfUE9SQ0hfUkVHLCBoYnAgLSAxKTsKKwlyZWdtYXBfd3JpdGUobG9naWN2Yy0+
cmVnbWFwLCBMT0dJQ1ZDX0hSRVNfUkVHLCBoYWN0IC0gMSk7CisKKwlyZWdtYXBfd3JpdGUobG9n
aWN2Yy0+cmVnbWFwLCBMT0dJQ1ZDX1ZTWU5DX0ZST05UX1BPUkNIX1JFRywgdmZwIC0gMSk7CisJ
cmVnbWFwX3dyaXRlKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNWQ19WU1lOQ19SRUcsIHZzbCAtIDEp
OworCXJlZ21hcF93cml0ZShsb2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNfVlNZTkNfQkFDS19QT1JD
SF9SRUcsIHZicCAtIDEpOworCXJlZ21hcF93cml0ZShsb2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNf
VlJFU19SRUcsIHZhY3QgLSAxKTsKKworCS8qIFNpZ25hbHMgKi8KKworCWN0cmwgPSBMT0dJQ1ZD
X0NUUkxfSFNZTkNfRU5BQkxFIHwgTE9HSUNWQ19DVFJMX1ZTWU5DX0VOQUJMRSB8CisJICAgICAg
IExPR0lDVkNfQ1RSTF9ERV9FTkFCTEU7CisKKwlpZiAobW9kZS0+ZmxhZ3MgJiBEUk1fTU9ERV9G
TEFHX05IU1lOQykKKwkJY3RybCB8PSBMT0dJQ1ZDX0NUUkxfSFNZTkNfSU5WRVJUOworCisJaWYg
KG1vZGUtPmZsYWdzICYgRFJNX01PREVfRkxBR19OVlNZTkMpCisJCWN0cmwgfD0gTE9HSUNWQ19D
VFJMX1ZTWU5DX0lOVkVSVDsKKworCWlmIChsb2dpY3ZjLT5pbnRlcmZhY2UpIHsKKwkJc3RydWN0
IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciA9CisJCQkmbG9naWN2Yy0+aW50ZXJmYWNlLT5kcm1f
Y29ubmVjdG9yOworCQlzdHJ1Y3QgZHJtX2Rpc3BsYXlfaW5mbyAqZGlzcGxheV9pbmZvID0KKwkJ
CSZjb25uZWN0b3ItPmRpc3BsYXlfaW5mbzsKKworCQlpZiAoZGlzcGxheV9pbmZvLT5idXNfZmxh
Z3MgJiBEUk1fQlVTX0ZMQUdfREVfTE9XKQorCQkJY3RybCB8PSBMT0dJQ1ZDX0NUUkxfREVfSU5W
RVJUOworCisJCWlmIChkaXNwbGF5X2luZm8tPmJ1c19mbGFncyAmIERSTV9CVVNfRkxBR19QSVhE
QVRBX05FR0VER0UpCisJCQljdHJsIHw9IExPR0lDVkNfQ1RSTF9DTE9DS19JTlZFUlQ7CisJfQor
CisJcmVnbWFwX3VwZGF0ZV9iaXRzKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNWQ19DVFJMX1JFRywK
KwkJCSAgIExPR0lDVkNfQ1RSTF9IU1lOQ19FTkFCTEUgfAorCQkJICAgTE9HSUNWQ19DVFJMX0hT
WU5DX0lOVkVSVCB8CisJCQkgICBMT0dJQ1ZDX0NUUkxfVlNZTkNfRU5BQkxFIHwKKwkJCSAgIExP
R0lDVkNfQ1RSTF9WU1lOQ19JTlZFUlQgfAorCQkJICAgTE9HSUNWQ19DVFJMX0RFX0VOQUJMRSB8
CisJCQkgICBMT0dJQ1ZDX0NUUkxfREVfSU5WRVJUIHwKKwkJCSAgIExPR0lDVkNfQ1RSTF9QSVhF
TF9JTlZFUlQgfAorCQkJICAgTE9HSUNWQ19DVFJMX0NMT0NLX0lOVkVSVCwgY3RybCk7CisKKwkv
KiBHZW5lcmF0ZSBpbnRlcm5hbCBzdGF0ZSByZXNldC4gKi8KKwlyZWdtYXBfd3JpdGUobG9naWN2
Yy0+cmVnbWFwLCBMT0dJQ1ZDX0RUWVBFX1JFRywgMCk7CisKKwlkcm1fY3J0Y192Ymxhbmtfb24o
ZHJtX2NydGMpOworCisJLyogUmVnaXN0ZXIgb3VyIGV2ZW50IGFmdGVyIHZibGFuayBpcyBlbmFi
bGVkLiAqLworCWlmIChkcm1fY3J0Yy0+c3RhdGUtPmV2ZW50ICYmICFvbGRfc3RhdGUtPmFjdGl2
ZSkgeworCQlXQVJOX09OKGRybV9jcnRjX3ZibGFua19nZXQoZHJtX2NydGMpICE9IDApOworCisJ
CXNwaW5fbG9ja19pcnFzYXZlKCZkcm0tPmV2ZW50X2xvY2ssIGZsYWdzKTsKKwkJY3J0Yy0+ZXZl
bnQgPSBkcm1fY3J0Yy0+c3RhdGUtPmV2ZW50OworCQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZk
cm0tPmV2ZW50X2xvY2ssIGZsYWdzKTsKKworCQlkcm1fY3J0Yy0+c3RhdGUtPmV2ZW50ID0gTlVM
TDsKKwl9Cit9CisKK3N0YXRpYyB2b2lkIGxvZ2ljdmNfY3J0Y19hdG9taWNfZGlzYWJsZShzdHJ1
Y3QgZHJtX2NydGMgKmRybV9jcnRjLAorCQkJCQlzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKm9sZF9z
dGF0ZSkKK3sKKwlzdHJ1Y3QgbG9naWN2Y19jcnRjICpjcnRjID0gbG9naWN2Y19jcnRjKGRybV9j
cnRjKTsKKwlzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMgPSBjcnRjLT5sb2dpY3ZjOworCisJ
ZHJtX2NydGNfdmJsYW5rX29mZihkcm1fY3J0Yyk7CisKKwkvKiBEaXNhYmxlIGFuZCBjbGVhciBD
UlRDIGJpdHMuICovCisJcmVnbWFwX3VwZGF0ZV9iaXRzKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNW
Q19DVFJMX1JFRywKKwkJCSAgIExPR0lDVkNfQ1RSTF9IU1lOQ19FTkFCTEUgfAorCQkJICAgTE9H
SUNWQ19DVFJMX0hTWU5DX0lOVkVSVCB8CisJCQkgICBMT0dJQ1ZDX0NUUkxfVlNZTkNfRU5BQkxF
IHwKKwkJCSAgIExPR0lDVkNfQ1RSTF9WU1lOQ19JTlZFUlQgfAorCQkJICAgTE9HSUNWQ19DVFJM
X0RFX0VOQUJMRSB8CisJCQkgICBMT0dJQ1ZDX0NUUkxfREVfSU5WRVJUIHwKKwkJCSAgIExPR0lD
VkNfQ1RSTF9QSVhFTF9JTlZFUlQgfAorCQkJICAgTE9HSUNWQ19DVFJMX0NMT0NLX0lOVkVSVCwg
MCk7CisKKwkvKiBHZW5lcmF0ZSBpbnRlcm5hbCBzdGF0ZSByZXNldC4gKi8KKwlyZWdtYXBfd3Jp
dGUobG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZDX0RUWVBFX1JFRywgMCk7CisKKwkvKiBDb25zdW1l
IGxlZnRvdmVyIGV2ZW50IHNpbmNlIHZibGFuayBpcyBub3cgZGlzYWJsZWQuICovCisJaWYgKGRy
bV9jcnRjLT5zdGF0ZS0+ZXZlbnQgJiYgIWRybV9jcnRjLT5zdGF0ZS0+YWN0aXZlKSB7CisJCXNw
aW5fbG9ja19pcnEoJmRybV9jcnRjLT5kZXYtPmV2ZW50X2xvY2spOworCQlkcm1fY3J0Y19zZW5k
X3ZibGFua19ldmVudChkcm1fY3J0YywgZHJtX2NydGMtPnN0YXRlLT5ldmVudCk7CisJCXNwaW5f
dW5sb2NrX2lycSgmZHJtX2NydGMtPmRldi0+ZXZlbnRfbG9jayk7CisKKwkJZHJtX2NydGMtPnN0
YXRlLT5ldmVudCA9IE5VTEw7CisJfQorfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9jcnRj
X2hlbHBlcl9mdW5jcyBsb2dpY3ZjX2NydGNfaGVscGVyX2Z1bmNzID0geworCS5hdG9taWNfY2hl
Y2sJCT0gbG9naWN2Y19jcnRjX2F0b21pY19jaGVjaywKKwkuYXRvbWljX2JlZ2luCQk9IGxvZ2lj
dmNfY3J0Y19hdG9taWNfYmVnaW4sCisJLmF0b21pY19lbmFibGUJCT0gbG9naWN2Y19jcnRjX2F0
b21pY19lbmFibGUsCisJLmF0b21pY19kaXNhYmxlCQk9IGxvZ2ljdmNfY3J0Y19hdG9taWNfZGlz
YWJsZSwKK307CisKK3N0YXRpYyBpbnQgbG9naWN2Y19jcnRjX2VuYWJsZV92Ymxhbmsoc3RydWN0
IGRybV9jcnRjICpkcm1fY3J0YykKK3sKKwlzdHJ1Y3QgbG9naWN2Y19jcnRjICpjcnRjID0gbG9n
aWN2Y19jcnRjKGRybV9jcnRjKTsKKwlzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMgPSBjcnRj
LT5sb2dpY3ZjOworCisJLyogQ2xlYXIgYW55IHBlbmRpbmcgVl9TWU5DIGludGVycnVwdC4gKi8K
KwlyZWdtYXBfd3JpdGVfYml0cyhsb2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNfSU5UX1NUQVRfUkVH
LAorCQkJICBMT0dJQ1ZDX0lOVF9TVEFUX1ZfU1lOQywgTE9HSUNWQ19JTlRfU1RBVF9WX1NZTkMp
OworCisJLyogVW5tYXNrIFZfU1lOQyBpbnRlcnJ1cHQuICovCisJcmVnbWFwX3dyaXRlX2JpdHMo
bG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZDX0lOVF9NQVNLX1JFRywKKwkJCSAgTE9HSUNWQ19JTlRf
TUFTS19WX1NZTkMsIDApOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGxvZ2ljdmNf
Y3J0Y19kaXNhYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2NydGMgKmRybV9jcnRjKQoreworCXN0cnVj
dCBsb2dpY3ZjX2NydGMgKmNydGMgPSBsb2dpY3ZjX2NydGMoZHJtX2NydGMpOworCXN0cnVjdCBs
b2dpY3ZjX2RybSAqbG9naWN2YyA9IGNydGMtPmxvZ2ljdmM7CisKKwkvKiBNYXNrIFZfU1lOQyBp
bnRlcnJ1cHQuICovCisJcmVnbWFwX3dyaXRlX2JpdHMobG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZD
X0lOVF9NQVNLX1JFRywKKwkJCSAgTE9HSUNWQ19JTlRfTUFTS19WX1NZTkMsIExPR0lDVkNfSU5U
X01BU0tfVl9TWU5DKTsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY3J0Y19mdW5jcyBs
b2dpY3ZjX2NydGNfZnVuY3MgPSB7CisJLnJlc2V0CQkJPSBkcm1fYXRvbWljX2hlbHBlcl9jcnRj
X3Jlc2V0LAorCS5kZXN0cm95CQk9IGRybV9jcnRjX2NsZWFudXAsCisJLnNldF9jb25maWcJCT0g
ZHJtX2F0b21pY19oZWxwZXJfc2V0X2NvbmZpZywKKwkucGFnZV9mbGlwCQk9IGRybV9hdG9taWNf
aGVscGVyX3BhZ2VfZmxpcCwKKwkuYXRvbWljX2R1cGxpY2F0ZV9zdGF0ZQk9IGRybV9hdG9taWNf
aGVscGVyX2NydGNfZHVwbGljYXRlX3N0YXRlLAorCS5hdG9taWNfZGVzdHJveV9zdGF0ZQk9IGRy
bV9hdG9taWNfaGVscGVyX2NydGNfZGVzdHJveV9zdGF0ZSwKKwkuZW5hYmxlX3ZibGFuawkJPSBs
b2dpY3ZjX2NydGNfZW5hYmxlX3ZibGFuaywKKwkuZGlzYWJsZV92YmxhbmsJCT0gbG9naWN2Y19j
cnRjX2Rpc2FibGVfdmJsYW5rLAorfTsKKwordm9pZCBsb2dpY3ZjX2NydGNfdmJsYW5rX2hhbmRs
ZXIoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjKQoreworCXN0cnVjdCBsb2dpY3ZjX2NydGMg
KmNydGMgPSBsb2dpY3ZjLT5jcnRjOworCXN0cnVjdCBkcm1fZGV2aWNlICpkcm0gPSBsb2dpY3Zj
LT5kcm07CisJdW5zaWduZWQgbG9uZyBmbGFnczsKKworCWlmICghY3J0YykKKwkJcmV0dXJuOwor
CisJZHJtX2NydGNfaGFuZGxlX3ZibGFuaygmY3J0Yy0+ZHJtX2NydGMpOworCisJc3Bpbl9sb2Nr
X2lycXNhdmUoJmRybS0+ZXZlbnRfbG9jaywgZmxhZ3MpOworCWlmIChjcnRjLT5ldmVudCkgewor
CQlkcm1fY3J0Y19zZW5kX3ZibGFua19ldmVudCgmY3J0Yy0+ZHJtX2NydGMsIGNydGMtPmV2ZW50
KTsKKwkJZHJtX2NydGNfdmJsYW5rX3B1dCgmY3J0Yy0+ZHJtX2NydGMpOworCQljcnRjLT5ldmVu
dCA9IE5VTEw7CisJfQorCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRybS0+ZXZlbnRfbG9jaywg
ZmxhZ3MpOworfQorCitpbnQgbG9naWN2Y19jcnRjX2luaXQoc3RydWN0IGxvZ2ljdmNfZHJtICps
b2dpY3ZjKQoreworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqb2Zfbm9kZSA9IGxvZ2ljdmMtPmRybS0+
ZGV2LT5vZl9ub2RlOworCXN0cnVjdCBsb2dpY3ZjX2NydGMgKmNydGM7CisJc3RydWN0IGxvZ2lj
dmNfbGF5ZXIgKmxheWVyX3ByaW1hcnk7CisJaW50IHJldDsKKworCWNydGMgPSBkZXZtX2t6YWxs
b2MobG9naWN2Yy0+ZHJtLT5kZXYsIHNpemVvZigqY3J0YyksIEdGUF9LRVJORUwpOworCWlmICgh
Y3J0YykKKwkJcmV0dXJuIC1FTk9NRU07CisKKwljcnRjLT5sb2dpY3ZjID0gbG9naWN2YzsKKwor
CWxheWVyX3ByaW1hcnkgPSBsb2dpY3ZjX2xheWVyX2dldF9wcmltYXJ5KGxvZ2ljdmMpOworCWlm
ICghbGF5ZXJfcHJpbWFyeSkgeworCQlEUk1fRVJST1IoIkZhaWxlZCB0byBnZXQgcHJpbWFyeSBs
YXllclxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCXJldCA9IGRybV9jcnRjX2luaXRf
d2l0aF9wbGFuZXMobG9naWN2Yy0+ZHJtLCAmY3J0Yy0+ZHJtX2NydGMsCisJCQkJCSZsYXllcl9w
cmltYXJ5LT5kcm1fcGxhbmUsIE5VTEwsCisJCQkJCSZsb2dpY3ZjX2NydGNfZnVuY3MsIE5VTEwp
OworCWlmIChyZXQpIHsKKwkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gaW5pdGFsaXplIENSVENcbiIp
OworCQlyZXR1cm4gcmV0OworCX0KKworCWRybV9jcnRjX2hlbHBlcl9hZGQoJmNydGMtPmRybV9j
cnRjLCAmbG9naWN2Y19jcnRjX2hlbHBlcl9mdW5jcyk7CisKKwljcnRjLT5kcm1fY3J0Yy5wb3J0
ID0gb2ZfZ3JhcGhfZ2V0X3BvcnRfYnlfaWQob2Zfbm9kZSwgMSk7CisKKwlsb2dpY3ZjLT5jcnRj
ID0gY3J0YzsKKworCXJldHVybiAwOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xv
Z2ljdmMvbG9naWN2Y19jcnRjLmggYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2Ny
dGMuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmRmYTU1YzM3N2Fj
MwotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfY3J0
Yy5oCkBAIC0wLDAgKzEsMjUgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4w
KyAqLworLyoKKyAqIENvcHlyaWdodCAoQykgMjAxOSBCb290bGluCisgKiBBdXRob3I6IFBhdWwg
S29jaWFsa293c2tpIDxwYXVsLmtvY2lhbGtvd3NraUBib290bGluLmNvbT4KKyAqLworCisjaWZu
ZGVmIF9MT0dJQ1ZDX0NSVENfSF8KKyNkZWZpbmUgX0xPR0lDVkNfQ1JUQ19IXworCisjaW5jbHVk
ZSA8ZHJtL2RybV9jcnRjLmg+CisjaW5jbHVkZSA8ZHJtL2RybV92YmxhbmsuaD4KKworc3RydWN0
IGxvZ2ljdmNfZHJtOworCitzdHJ1Y3QgbG9naWN2Y19jcnRjIHsKKwlzdHJ1Y3QgbG9naWN2Y19k
cm0gKmxvZ2ljdmM7CisKKwlzdHJ1Y3QgZHJtX2NydGMgZHJtX2NydGM7CisJc3RydWN0IGRybV9w
ZW5kaW5nX3ZibGFua19ldmVudCAqZXZlbnQ7Cit9OworCit2b2lkIGxvZ2ljdmNfY3J0Y192Ymxh
bmtfaGFuZGxlcihzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMpOworaW50IGxvZ2ljdmNfY3J0
Y19pbml0KHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2Yyk7CisKKyNlbmRpZgpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19kcm0uYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9sb2dpY3ZjL2xvZ2ljdmNfZHJtLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MDAwMDAwLi4wZjU4YjkzNjE5NzYKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
bG9naWN2Yy9sb2dpY3ZjX2RybS5jCkBAIC0wLDAgKzEsNDU3IEBACisvLyBTUERYLUxpY2Vuc2Ut
SWRlbnRpZmllcjogR1BMLTIuMCsKKy8qCisgKiBDb3B5cmlnaHQgKEMpIDIwMTkgQm9vdGxpbgor
ICogQXV0aG9yOiBQYXVsIEtvY2lhbGtvd3NraSA8cGF1bC5rb2NpYWxrb3dza2lAYm9vdGxpbi5j
b20+CisgKi8KKworI2luY2x1ZGUgPGxpbnV4L2Nsay5oPgorI2luY2x1ZGUgPGxpbnV4L21mZC9z
eXNjb24uaD4KKyNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KKyNpbmNsdWRlIDxsaW51eC9vZi5o
PgorI2luY2x1ZGUgPGxpbnV4L29mX2FkZHJlc3MuaD4KKyNpbmNsdWRlIDxsaW51eC9vZl9kZXZp
Y2UuaD4KKyNpbmNsdWRlIDxsaW51eC9vZl9yZXNlcnZlZF9tZW0uaD4KKyNpbmNsdWRlIDxsaW51
eC9yZWdtYXAuaD4KKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgorI2luY2x1ZGUgPGRybS9kcm1f
YXRvbWljX2hlbHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fZHJ2Lmg+CisjaW5jbHVkZSA8ZHJt
L2RybV9mYl9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2dlbV9jbWFfaGVscGVyLmg+Cisj
aW5jbHVkZSA8ZHJtL2RybV9wcmludC5oPgorCisjaW5jbHVkZSAibG9naWN2Y19jcnRjLmgiCisj
aW5jbHVkZSAibG9naWN2Y19kcm0uaCIKKyNpbmNsdWRlICJsb2dpY3ZjX2ludGVyZmFjZS5oIgor
I2luY2x1ZGUgImxvZ2ljdmNfbW9kZS5oIgorI2luY2x1ZGUgImxvZ2ljdmNfbGF5ZXIuaCIKKyNp
bmNsdWRlICJsb2dpY3ZjX29mLmgiCisjaW5jbHVkZSAibG9naWN2Y19yZWdzLmgiCisKK0RFRklO
RV9EUk1fR0VNX0NNQV9GT1BTKGxvZ2ljdmNfZHJtX2ZvcHMpOworCitzdGF0aWMgaW50IGxvZ2lj
dmNfZHJtX2dlbV9jbWFfZHVtYl9jcmVhdGUoc3RydWN0IGRybV9maWxlICpmaWxlX3ByaXYsCisJ
CQkJCSAgIHN0cnVjdCBkcm1fZGV2aWNlICpkcm0sCisJCQkJCSAgIHN0cnVjdCBkcm1fbW9kZV9j
cmVhdGVfZHVtYiAqYXJncykKK3sKKwlzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMgPSBkcm0t
PmRldl9wcml2YXRlOworCisJLyogU3RyaWRlIGlzIGFsd2F5cyBmaXhlZCB0byBpdHMgY29uZmln
dXJhdGlvbiB2YWx1ZS4gKi8KKwlhcmdzLT5waXRjaCA9IGxvZ2ljdmMtPmNvbmZpZy5yb3dfc3Ry
aWRlICogRElWX1JPVU5EX1VQKGFyZ3MtPmJwcCwgOCk7CisKKwlyZXR1cm4gZHJtX2dlbV9jbWFf
ZHVtYl9jcmVhdGVfaW50ZXJuYWwoZmlsZV9wcml2LCBkcm0sIGFyZ3MpOworfQorCitzdGF0aWMg
c3RydWN0IGRybV9kcml2ZXIgbG9naWN2Y19kcm1fZHJpdmVyID0geworCS5kcml2ZXJfZmVhdHVy
ZXMJCT0gRFJJVkVSX0dFTSB8IERSSVZFUl9NT0RFU0VUIHwKKwkJCQkJICBEUklWRVJfQVRPTUlD
LAorCisJLmZvcHMJCQkJPSAmbG9naWN2Y19kcm1fZm9wcywKKwkubmFtZQkJCQk9ICJsb2dpY3Zj
LWRybSIsCisJLmRlc2MJCQkJPSAiWHlsb24gTG9naUNWQyBEUk0gZHJpdmVyIiwKKwkuZGF0ZQkJ
CQk9ICIyMDE5MDMxOSIsCisJLm1ham9yCQkJCT0gMSwKKwkubWlub3IJCQkJPSAwLAorCisJRFJN
X0dFTV9DTUFfVk1BUF9EUklWRVJfT1BTLAorCS5kdW1iX2NyZWF0ZQkJCT0gbG9naWN2Y19kcm1f
Z2VtX2NtYV9kdW1iX2NyZWF0ZSwKK307CisKK3N0YXRpYyBzdHJ1Y3QgcmVnbWFwX2NvbmZpZyBs
b2dpY3ZjX2RybV9yZWdtYXBfY29uZmlnID0geworCS5yZWdfYml0cwk9IDMyLAorCS52YWxfYml0
cwk9IDMyLAorCS5yZWdfc3RyaWRlCT0gNCwKKwkubmFtZQkJPSAibG9naWN2Yy1kcm0iLAorfTsK
Kworc3RhdGljIGlycXJldHVybl90IGxvZ2ljdmNfZHJtX2lycV9oYW5kbGVyKGludCBpcnEsIHZv
aWQgKmRhdGEpCit7CisJc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjID0gZGF0YTsKKwlpcnFy
ZXR1cm5fdCByZXQgPSBJUlFfTk9ORTsKKwl1MzIgc3RhdCA9IDA7CisKKwkvKiBHZXQgcGVuZGlu
ZyBpbnRlcnJ1cHQgc291cmNlcy4gKi8KKwlyZWdtYXBfcmVhZChsb2dpY3ZjLT5yZWdtYXAsIExP
R0lDVkNfSU5UX1NUQVRfUkVHLCAmc3RhdCk7CisKKwkvKiBDbGVhciBhbGwgcGVuZGluZyBpbnRl
cnJ1cHQgc291cmNlcy4gKi8KKwlyZWdtYXBfd3JpdGUobG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZD
X0lOVF9TVEFUX1JFRywgc3RhdCk7CisKKwlpZiAoc3RhdCAmIExPR0lDVkNfSU5UX1NUQVRfVl9T
WU5DKSB7CisJCWxvZ2ljdmNfY3J0Y192YmxhbmtfaGFuZGxlcihsb2dpY3ZjKTsKKwkJcmV0ID0g
SVJRX0hBTkRMRUQ7CisJfQorCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBsb2dpY3Zj
X2RybV9jb25maWdfcGFyc2Uoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjKQoreworCXN0cnVj
dCBkZXZpY2Vfbm9kZSAqb2Zfbm9kZSA9IGxvZ2ljdmMtPmRybS0+ZGV2LT5vZl9ub2RlOworCXN0
cnVjdCBsb2dpY3ZjX2RybV9jb25maWcgKmNvbmZpZyA9ICZsb2dpY3ZjLT5jb25maWc7CisJaW50
IHJldDsKKworCWxvZ2ljdmNfb2ZfcHJvcGVydHlfcGFyc2VfYm9vbChvZl9ub2RlLCAieHlsb24s
ZGl0aGVyaW5nIiwKKwkJCQkgICAgICAgJmNvbmZpZy0+ZGl0aGVyaW5nKTsKKwlsb2dpY3ZjX29m
X3Byb3BlcnR5X3BhcnNlX2Jvb2wob2Zfbm9kZSwgInh5bG9uLGJhY2tncm91bmQtbGF5ZXIiLAor
CQkJCSAgICAgICAmY29uZmlnLT5iYWNrZ3JvdW5kX2xheWVyKTsKKwlsb2dpY3ZjX29mX3Byb3Bl
cnR5X3BhcnNlX2Jvb2wob2Zfbm9kZSwgInh5bG9uLGxheWVycy1jb25maWd1cmFibGUiLAorCQkJ
CSAgICAgICAmY29uZmlnLT5sYXllcnNfY29uZmlndXJhYmxlKTsKKworCXJldCA9IGxvZ2ljdmNf
b2ZfcHJvcGVydHlfcGFyc2VfdTMyKG9mX25vZGUsICJ4eWxvbixkaXNwbGF5LWludGVyZmFjZSIs
CisJCQkJCSAgICAmY29uZmlnLT5kaXNwbGF5X2ludGVyZmFjZSk7CisJaWYgKHJldCkKKwkJcmV0
dXJuIHJldDsKKworCXJldCA9IGxvZ2ljdmNfb2ZfcHJvcGVydHlfcGFyc2VfdTMyKG9mX25vZGUs
ICJ4eWxvbixkaXNwbGF5LWNvbG9yc3BhY2UiLAorCQkJCQkgICAgJmNvbmZpZy0+ZGlzcGxheV9j
b2xvcnNwYWNlKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJcmV0ID0gbG9naWN2Y19v
Zl9wcm9wZXJ0eV9wYXJzZV91MzIob2Zfbm9kZSwgInh5bG9uLGRpc3BsYXktZGVwdGgiLAorCQkJ
CQkgICAgJmNvbmZpZy0+ZGlzcGxheV9kZXB0aCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsK
KworCXJldCA9IGxvZ2ljdmNfb2ZfcHJvcGVydHlfcGFyc2VfdTMyKG9mX25vZGUsICJ4eWxvbixy
b3ctc3RyaWRlIiwKKwkJCQkJICAgICZjb25maWctPnJvd19zdHJpZGUpOworCWlmIChyZXQpCisJ
CXJldHVybiByZXQ7CisKKwlyZXQgPSBsb2dpY3ZjX29mX3Byb3BlcnR5X3BhcnNlX3UzMihvZl9u
b2RlLCAieHlsb24sbGF5ZXJzLWNvdW50IiwKKwkJCQkJICAgICZjb25maWctPmxheWVyc19jb3Vu
dCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCXJldHVybiAwOworfQorCitzdGF0aWMg
dm9pZCBsb2dpY3ZjX3ZlcnNpb25fcHJpbnQoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjKQor
eworCXUzMiB2ZXJzaW9uOworCisJcmVnbWFwX3JlYWQobG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZD
X0lQX1ZFUlNJT05fUkVHLCAmdmVyc2lvbik7CisKKwlEUk1fSU5GTygiTG9naUNWQyB2ZXJzaW9u
ICVkLiUwMmQuJWNcbiIsCisJCSAoaW50KUxPR0lDVkNfRklFTERfR0VUKExPR0lDVkNfSVBfVkVS
U0lPTl9NQUpPUiwgdmVyc2lvbiksCisJCSAoaW50KUxPR0lDVkNfRklFTERfR0VUKExPR0lDVkNf
SVBfVkVSU0lPTl9NSU5PUiwgdmVyc2lvbiksCisJCSAoY2hhcilMT0dJQ1ZDX0ZJRUxEX0dFVChM
T0dJQ1ZDX0lQX1ZFUlNJT05fTEVWRUwsIHZlcnNpb24pICsKKwkJICdhJyk7Cit9CisKK3N0YXRp
YyBpbnQgbG9naWN2Y19jbG9ja3NfcHJlcGFyZShzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMp
Cit7CisJc3RydWN0IHsKKwkJc3RydWN0IGNsayAqKmNsazsKKwkJY2hhciAqbmFtZTsKKwkJYm9v
bCBvcHRpb25hbDsKKwl9IGNsb2Nrc19tYXBbXSA9IHsKKwkJeworCQkJLmNsayA9ICZsb2dpY3Zj
LT52Y2xrLAorCQkJLm5hbWUgPSAidmNsayIsCisJCQkub3B0aW9uYWwgPSBmYWxzZSwKKwkJfSwK
KwkJeworCQkJLmNsayA9ICZsb2dpY3ZjLT52Y2xrMiwKKwkJCS5uYW1lID0gInZjbGsyIiwKKwkJ
CS5vcHRpb25hbCA9IHRydWUsCisJCX0sCisJCXsKKwkJCS5jbGsgPSAmbG9naWN2Yy0+bHZkc2Ns
aywKKwkJCS5uYW1lID0gImx2ZHNjbGsiLAorCQkJLm9wdGlvbmFsID0gdHJ1ZSwKKwkJfSwKKwkJ
eworCQkJLmNsayA9ICZsb2dpY3ZjLT5sdmRzY2xrbiwKKwkJCS5uYW1lID0gImx2ZHNjbGtuIiwK
KwkJCS5vcHRpb25hbCA9IHRydWUsCisJCX0sCisJfTsKKwl1bnNpZ25lZCBpbnQgaTsKKwlpbnQg
cmV0OworCisJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoY2xvY2tzX21hcCk7IGkrKykgewor
CQlzdHJ1Y3QgY2xrICpjbGs7CisKKwkJY2xrID0gZGV2bV9jbGtfZ2V0KGxvZ2ljdmMtPmRybS0+
ZGV2LCBjbG9ja3NfbWFwW2ldLm5hbWUpOworCQlpZiAoSVNfRVJSKGNsaykpIHsKKwkJCWlmIChQ
VFJfRVJSKGNsaykgPT0gLUVOT0VOVCAmJiBjbG9ja3NfbWFwW2ldLm9wdGlvbmFsKQorCQkJCWNv
bnRpbnVlOworCisJCQlEUk1fRVJST1IoIk1pc3Npbmcgbm9uLW9wdGlvbmFsIGNsb2NrICVzXG4i
LAorCQkJCSAgY2xvY2tzX21hcFtpXS5uYW1lKTsKKworCQkJcmV0ID0gUFRSX0VSUihjbGspOwor
CQkJZ290byBlcnJvcjsKKwkJfQorCisJCXJldCA9IGNsa19wcmVwYXJlX2VuYWJsZShjbGspOwor
CQlpZiAocmV0KSB7CisJCQlEUk1fRVJST1IoIkZhaWxlZCB0byBwcmVwYXJlIGFuZCBlbmFibGUg
Y2xvY2sgJXNcbiIsCisJCQkJICBjbG9ja3NfbWFwW2ldLm5hbWUpOworCQkJZ290byBlcnJvcjsK
KwkJfQorCisJCSpjbG9ja3NfbWFwW2ldLmNsayA9IGNsazsKKwl9CisKKwlyZXR1cm4gMDsKKwor
ZXJyb3I6CisJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoY2xvY2tzX21hcCk7IGkrKykgewor
CQlpZiAoISpjbG9ja3NfbWFwW2ldLmNsaykKKwkJCWNvbnRpbnVlOworCisJCWNsa19kaXNhYmxl
X3VucHJlcGFyZSgqY2xvY2tzX21hcFtpXS5jbGspOworCQkqY2xvY2tzX21hcFtpXS5jbGsgPSBO
VUxMOworCX0KKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgbG9naWN2Y19jbG9ja3Nf
dW5wcmVwYXJlKHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YykKK3sKKwlzdHJ1Y3QgY2xrICoq
Y2xvY2tzW10gPSB7CisJCSZsb2dpY3ZjLT52Y2xrLAorCQkmbG9naWN2Yy0+dmNsazIsCisJCSZs
b2dpY3ZjLT5sdmRzY2xrLAorCQkmbG9naWN2Yy0+bHZkc2Nsa24sCisJfTsKKwl1bnNpZ25lZCBp
bnQgaTsKKworCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGNsb2Nrcyk7IGkrKykgeworCQlp
ZiAoISpjbG9ja3NbaV0pCisJCQljb250aW51ZTsKKworCQljbGtfZGlzYWJsZV91bnByZXBhcmUo
KmNsb2Nrc1tpXSk7CisJCSpjbG9ja3NbaV0gPSBOVUxMOworCX0KKworCXJldHVybiAwOworfQor
CitzdGF0aWMgaW50IGxvZ2ljdmNfZHJtX3Byb2JlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBk
ZXYpCit7CisJc3RydWN0IGRldmljZV9ub2RlICpvZl9ub2RlID0gcGRldi0+ZGV2Lm9mX25vZGU7
CisJc3RydWN0IGRldmljZV9ub2RlICpyZXNlcnZlZF9tZW1fbm9kZTsKKwlzdHJ1Y3QgcmVzZXJ2
ZWRfbWVtICpyZXNlcnZlZF9tZW0gPSBOVUxMOworCWNvbnN0IHN0cnVjdCBsb2dpY3ZjX2RybV9j
YXBzICpjYXBzOworCXN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YzsKKwlzdHJ1Y3QgZHJtX2Rl
dmljZSAqZHJtOworCXN0cnVjdCByZWdtYXAgKnJlZ21hcDsKKwlzdHJ1Y3QgcmVzb3VyY2UgcmVz
OworCXZvaWQgX19pb21lbSAqYmFzZTsKKwlpbnQgaXJxOworCWludCByZXQ7CisKKwljYXBzID0g
b2ZfZGV2aWNlX2dldF9tYXRjaF9kYXRhKCZwZGV2LT5kZXYpOworCWlmICghY2FwcykKKwkJcmV0
dXJuIC1FSU5WQUw7CisKKwlyZXQgPSBvZl9yZXNlcnZlZF9tZW1fZGV2aWNlX2luaXQoJnBkZXYt
PmRldik7CisJaWYgKHJldCAmJiByZXQgIT0gLUVOT0RFVikgeworCQlEUk1fRVJST1IoIkZhaWxl
ZCB0byBpbml0IG1lbW9yeSByZWdpb25cbiIpOworCQlnb3RvIGVycm9yX2Vhcmx5OworCX0KKwor
CXJlc2VydmVkX21lbV9ub2RlID0gb2ZfcGFyc2VfcGhhbmRsZShvZl9ub2RlLCAibWVtb3J5LXJl
Z2lvbiIsIDApOworCWlmIChyZXNlcnZlZF9tZW1fbm9kZSkgeworCQlyZXNlcnZlZF9tZW0gPSBv
Zl9yZXNlcnZlZF9tZW1fbG9va3VwKHJlc2VydmVkX21lbV9ub2RlKTsKKwkJb2Zfbm9kZV9wdXQo
cmVzZXJ2ZWRfbWVtX25vZGUpOworCX0KKworCS8qIEdldCByZWdtYXAgZnJvbSBzeXNjb24gZmly
c3QgaWYgYXZhaWxhYmxlLiAqLworCXJlZ21hcCA9IHN5c2Nvbl9yZWdtYXBfbG9va3VwX2J5X3Bo
YW5kbGUob2Zfbm9kZSwgInh5bG9uLHN5c2NvbiIpOworCWlmIChJU19FUlIocmVnbWFwKSkKKwkJ
cmVnbWFwID0gTlVMTDsKKworCS8qIFJlZ2lzdGVyIG91ciBvd24gcmVnbWFwIG90aGVyd2lzZS4g
Ki8KKwlpZiAoIXJlZ21hcCkgeworCQlyZXQgPSBvZl9hZGRyZXNzX3RvX3Jlc291cmNlKG9mX25v
ZGUsIDAsICZyZXMpOworCQlpZiAocmV0KSB7CisJCQlEUk1fRVJST1IoIkZhaWxlZCB0byBnZXQg
cmVzb3VyY2UgZnJvbSBhZGRyZXNzXG4iKTsKKwkJCWdvdG8gZXJyb3JfcmVzZXJ2ZWRfbWVtOwor
CQl9CisKKwkJYmFzZSA9IGRldm1faW9yZW1hcF9yZXNvdXJjZSgmcGRldi0+ZGV2LCAmcmVzKTsK
KwkJaWYgKElTX0VSUihiYXNlKSkgeworCQkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gbWFwIEkvTyBi
YXNlXG4iKTsKKwkJCXJldCA9IFBUUl9FUlIoYmFzZSk7CisJCQlnb3RvIGVycm9yX3Jlc2VydmVk
X21lbTsKKwkJfQorCisJCWxvZ2ljdmNfZHJtX3JlZ21hcF9jb25maWcubWF4X3JlZ2lzdGVyID0g
cmVzb3VyY2Vfc2l6ZSgmcmVzKSAtCisJCQkJCQkJIDQ7CisKKwkJcmVnbWFwID0gZGV2bV9yZWdt
YXBfaW5pdF9tbWlvKCZwZGV2LT5kZXYsIGJhc2UsCisJCQkJCSAgICAgICAmbG9naWN2Y19kcm1f
cmVnbWFwX2NvbmZpZyk7CisJCWlmIChJU19FUlIocmVnbWFwKSkgeworCQkJRFJNX0VSUk9SKCJG
YWlsZWQgdG8gY3JlYXRlIHJlZ21hcCBmb3IgSS9PXG4iKTsKKwkJCXJldCA9IFBUUl9FUlIocmVn
bWFwKTsKKwkJCWdvdG8gZXJyb3JfcmVzZXJ2ZWRfbWVtOworCQl9CisJfQorCisJaXJxID0gcGxh
dGZvcm1fZ2V0X2lycShwZGV2LCAwKTsKKwlpZiAoaXJxIDwgMCkgeworCQlEUk1fRVJST1IoIkZh
aWxlZCB0byBnZXQgSVJRXG4iKTsKKwkJcmV0ID0gLUVOT0RFVjsKKwkJZ290byBlcnJvcl9yZXNl
cnZlZF9tZW07CisJfQorCisJZHJtID0gZHJtX2Rldl9hbGxvYygmbG9naWN2Y19kcm1fZHJpdmVy
LCAmcGRldi0+ZGV2KTsKKwlpZiAoSVNfRVJSKGRybSkpIHsKKwkJcmV0ID0gUFRSX0VSUihkcm0p
OworCQlnb3RvIGVycm9yX3Jlc2VydmVkX21lbTsKKwl9CisKKwlsb2dpY3ZjID0gZGV2bV9remFs
bG9jKCZwZGV2LT5kZXYsIHNpemVvZigqbG9naWN2YyksIEdGUF9LRVJORUwpOworCWlmICghbG9n
aWN2YykgeworCQlyZXQgPSAtRU5PTUVNOworCQlnb3RvIGVycm9yX2xvZ2ljdmM7CisJfQorCisJ
bG9naWN2Yy0+Y2FwcyA9IGNhcHM7CisJbG9naWN2Yy0+ZHJtID0gZHJtOworCWRybS0+ZGV2X3By
aXZhdGUgPSBsb2dpY3ZjOworCXBsYXRmb3JtX3NldF9kcnZkYXRhKHBkZXYsIGxvZ2ljdmMpOwor
CisJbG9naWN2Yy0+cmVnbWFwID0gcmVnbWFwOworCUlOSVRfTElTVF9IRUFEKCZsb2dpY3ZjLT5s
YXllcnNfbGlzdCk7CisKKwlpZiAocmVzZXJ2ZWRfbWVtKQorCQlsb2dpY3ZjLT5yZXNlcnZlZF9t
ZW1fYmFzZSA9IHJlc2VydmVkX21lbS0+YmFzZTsKKworCXJldCA9IGxvZ2ljdmNfY2xvY2tzX3By
ZXBhcmUobG9naWN2Yyk7CisJaWYgKHJldCkgeworCQlEUk1fRVJST1IoIkZhaWxlZCB0byBwcmVw
YXJlIGNsb2Nrc1xuIik7CisJCWdvdG8gZXJyb3JfbG9naWN2YzsKKwl9CisKKwlyZXQgPSBkZXZt
X3JlcXVlc3RfaXJxKGRybS0+ZGV2LCBpcnEsIGxvZ2ljdmNfZHJtX2lycV9oYW5kbGVyLCAwLAor
CQkJICAgICAgIGRldl9uYW1lKGRybS0+ZGV2KSwgbG9naWN2Yyk7CisJaWYgKHJldCkgeworCQlE
Uk1fRVJST1IoIkZhaWxlZCB0byByZXF1ZXN0IElSUVxuIik7CisJCWdvdG8gZXJyb3JfY2xvY2tz
OworCX0KKworCWxvZ2ljdmNfdmVyc2lvbl9wcmludChsb2dpY3ZjKTsKKworCXJldCA9IGxvZ2lj
dmNfZHJtX2NvbmZpZ19wYXJzZShsb2dpY3ZjKTsKKwlpZiAocmV0ICYmIHJldCAhPSAtRU5PREVW
KSB7CisJCURSTV9FUlJPUigiRmFpbGVkIHRvIHBhcnNlIGNvbmZpZ1xuIik7CisJCWdvdG8gZXJy
b3JfY2xvY2tzOworCX0KKworCWRybV9tb2RlX2NvbmZpZ19pbml0KGRybSk7CisKKwlyZXQgPSBs
b2dpY3ZjX2xheWVyc19pbml0KGxvZ2ljdmMpOworCWlmIChyZXQpIHsKKwkJRFJNX0VSUk9SKCJG
YWlsZWQgdG8gaW5pdGlhbGl6ZSBsYXllcnNcbiIpOworCQlnb3RvIGVycm9yX21vZGVfY29uZmln
OworCX0KKworCXJldCA9IGxvZ2ljdmNfY3J0Y19pbml0KGxvZ2ljdmMpOworCWlmIChyZXQpIHsK
KwkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gaW5pdGlhbGl6ZSBDUlRDXG4iKTsKKwkJZ290byBlcnJv
cl9tb2RlX2NvbmZpZzsKKwl9CisKKwlsb2dpY3ZjX2xheWVyc19hdHRhY2hfY3J0Yyhsb2dpY3Zj
KTsKKworCXJldCA9IGxvZ2ljdmNfaW50ZXJmYWNlX2luaXQobG9naWN2Yyk7CisJaWYgKHJldCkg
eworCQlpZiAocmV0ICE9IC1FUFJPQkVfREVGRVIpCisJCQlEUk1fRVJST1IoIkZhaWxlZCB0byBp
bml0aWFsaXplIGludGVyZmFjZVxuIik7CisKKwkJZ290byBlcnJvcl9tb2RlX2NvbmZpZzsKKwl9
CisKKwlsb2dpY3ZjX2ludGVyZmFjZV9hdHRhY2hfY3J0Yyhsb2dpY3ZjKTsKKworCXJldCA9IGxv
Z2ljdmNfbW9kZV9pbml0KGxvZ2ljdmMpOworCWlmIChyZXQpIHsKKwkJRFJNX0VSUk9SKCJGYWls
ZWQgdG8gaW5pdGlhbGl6ZSBLTVNcbiIpOworCQlnb3RvIGVycm9yX21vZGVfY29uZmlnOworCX0K
KworCXJldCA9IGRybV9kZXZfcmVnaXN0ZXIoZHJtLCAwKTsKKwlpZiAocmV0KSB7CisJCURSTV9F
UlJPUigiRmFpbGVkIHRvIHJlZ2lzdGVyIERSTSBkZXZpY2VcbiIpOworCQlnb3RvIGVycm9yX21v
ZGU7CisJfQorCisJcmV0dXJuIDA7CisKK2Vycm9yX21vZGU6CisJbG9naWN2Y19tb2RlX2Zpbmko
bG9naWN2Yyk7CisKK2Vycm9yX21vZGVfY29uZmlnOgorCWRybV9tb2RlX2NvbmZpZ19jbGVhbnVw
KGRybSk7CisKK2Vycm9yX2Nsb2NrczoKKwlsb2dpY3ZjX2Nsb2Nrc191bnByZXBhcmUobG9naWN2
Yyk7CisKK2Vycm9yX2xvZ2ljdmM6CisJZHJtX2Rldl9wdXQoZHJtKTsKKworZXJyb3JfcmVzZXJ2
ZWRfbWVtOgorCW9mX3Jlc2VydmVkX21lbV9kZXZpY2VfcmVsZWFzZSgmcGRldi0+ZGV2KTsKKwor
ZXJyb3JfZWFybHk6CisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBsb2dpY3ZjX2RybV9y
ZW1vdmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKK3sKKwlzdHJ1Y3QgbG9naWN2Y19k
cm0gKmxvZ2ljdmMgPSBwbGF0Zm9ybV9nZXRfZHJ2ZGF0YShwZGV2KTsKKworCWRybV9kZXZfdW5y
ZWdpc3Rlcihsb2dpY3ZjLT5kcm0pOworCWRybV9hdG9taWNfaGVscGVyX3NodXRkb3duKGxvZ2lj
dmMtPmRybSk7CisKKwlsb2dpY3ZjX21vZGVfZmluaShsb2dpY3ZjKTsKKworCWRybV9tb2RlX2Nv
bmZpZ19jbGVhbnVwKGxvZ2ljdmMtPmRybSk7CisKKwlsb2dpY3ZjX2Nsb2Nrc191bnByZXBhcmUo
bG9naWN2Yyk7CisKKwlkcm1fZGV2X3B1dChsb2dpY3ZjLT5kcm0pOworCisJb2ZfcmVzZXJ2ZWRf
bWVtX2RldmljZV9yZWxlYXNlKCZwZGV2LT5kZXYpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRp
YyBjb25zdCBzdHJ1Y3QgbG9naWN2Y19kcm1fY2FwcyBsb2dpY3ZjX2RybV9jYXBzXzMgPSB7CisJ
LmxheWVyX2FkZHJlc3MgPSBmYWxzZSwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgbG9naWN2
Y19kcm1fY2FwcyBsb2dpY3ZjX2RybV9jYXBzXzQgPSB7CisJLmxheWVyX2FkZHJlc3MgPSB0cnVl
LAorfTsKKworc3RhdGljIHN0cnVjdCBvZl9kZXZpY2VfaWQgbG9naWN2Y19kcm1fb2ZfdGFibGVb
XSA9IHsKKwl7CisJCS5jb21wYXRpYmxlID0gInh5bG9uLGxvZ2ljdmMtMy4wMi5hLWRpc3BsYXki
LAorCQkuZGF0YSA9ICZsb2dpY3ZjX2RybV9jYXBzXzMsCisJfSwKKwl7CisJCS5jb21wYXRpYmxl
ID0gInh5bG9uLGxvZ2ljdmMtNC4wMS5hLWRpc3BsYXkiLAorCQkuZGF0YSA9ICZsb2dpY3ZjX2Ry
bV9jYXBzXzQsCisJfSwKKwl7IH0sCit9OworTU9EVUxFX0RFVklDRV9UQUJMRShvZiwgbG9naWN2
Y19kcm1fb2ZfdGFibGUpOworCitzdGF0aWMgc3RydWN0IHBsYXRmb3JtX2RyaXZlciBsb2dpY3Zj
X2RybV9wbGF0Zm9ybV9kcml2ZXIgPSB7CisJLnByb2JlCQk9IGxvZ2ljdmNfZHJtX3Byb2JlLAor
CS5yZW1vdmUJCT0gbG9naWN2Y19kcm1fcmVtb3ZlLAorCS5kcml2ZXIJCT0geworCQkubmFtZQkJ
PSAibG9naWN2Yy1kcm0iLAorCQkub2ZfbWF0Y2hfdGFibGUJPSBsb2dpY3ZjX2RybV9vZl90YWJs
ZSwKKwl9LAorfTsKKworbW9kdWxlX3BsYXRmb3JtX2RyaXZlcihsb2dpY3ZjX2RybV9wbGF0Zm9y
bV9kcml2ZXIpOworCitNT0RVTEVfQVVUSE9SKCJQYXVsIEtvY2lhbGtvd3NraSA8cGF1bC5rb2Np
YWxrb3dza2lAYm9vdGxpbi5jb20+Iik7CitNT0RVTEVfREVTQ1JJUFRJT04oIlh5bG9uIExvZ2lD
VkMgRFJNIGRyaXZlciIpOworTU9EVUxFX0xJQ0VOU0UoIkdQTCIpOwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19kcm0uaCBiL2RyaXZlcnMvZ3B1L2RybS9sb2dp
Y3ZjL2xvZ2ljdmNfZHJtLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAw
Li5jYzcyOGQ1YTRhZWUKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2
Yy9sb2dpY3ZjX2RybS5oCkBAIC0wLDAgKzEsNjAgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlm
aWVyOiBHUEwtMi4wKyAqLworLyoKKyAqIENvcHlyaWdodCAoQykgMjAxOSBCb290bGluCisgKiBB
dXRob3I6IFBhdWwgS29jaWFsa293c2tpIDxwYXVsLmtvY2lhbGtvd3NraUBib290bGluLmNvbT4K
KyAqLworCisjaWZuZGVmIF9MT0dJQ1ZDX0RSTV9IXworI2RlZmluZSBfTE9HSUNWQ19EUk1fSF8K
KworI2luY2x1ZGUgPGxpbnV4L3JlZ21hcC5oPgorI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+Cisj
aW5jbHVkZSA8ZHJtL2RybV9kZXZpY2UuaD4KKworI2RlZmluZSBMT0dJQ1ZDX0RJU1BMQVlfSU5U
RVJGQUNFX1JHQgkJCTAKKyNkZWZpbmUgTE9HSUNWQ19ESVNQTEFZX0lOVEVSRkFDRV9JVFU2NTYJ
CTEKKyNkZWZpbmUgTE9HSUNWQ19ESVNQTEFZX0lOVEVSRkFDRV9MVkRTXzRCSVRTCQkyCisjZGVm
aW5lIExPR0lDVkNfRElTUExBWV9JTlRFUkZBQ0VfTFZEU180QklUU19DQU1FUkEJMworI2RlZmlu
ZSBMT0dJQ1ZDX0RJU1BMQVlfSU5URVJGQUNFX0xWRFNfM0JJVFMJCTQKKyNkZWZpbmUgTE9HSUNW
Q19ESVNQTEFZX0lOVEVSRkFDRV9EVkkJCQk1CisKKyNkZWZpbmUgTE9HSUNWQ19ESVNQTEFZX0NP
TE9SU1BBQ0VfUkdCCQkwCisjZGVmaW5lIExPR0lDVkNfRElTUExBWV9DT0xPUlNQQUNFX1lVVjQy
MgkxCisjZGVmaW5lIExPR0lDVkNfRElTUExBWV9DT0xPUlNQQUNFX1lVVjQ0NAkyCisKK3N0cnVj
dCBsb2dpY3ZjX2NydGM7CitzdHJ1Y3QgbG9naWN2Y19pbnRlcmZhY2U7CisKK3N0cnVjdCBsb2dp
Y3ZjX2RybV9jb25maWcgeworCXUzMiBkaXNwbGF5X2ludGVyZmFjZTsKKwl1MzIgZGlzcGxheV9j
b2xvcnNwYWNlOworCXUzMiBkaXNwbGF5X2RlcHRoOworCXUzMiByb3dfc3RyaWRlOworCWJvb2wg
ZGl0aGVyaW5nOworCWJvb2wgYmFja2dyb3VuZF9sYXllcjsKKwlib29sIGxheWVyc19jb25maWd1
cmFibGU7CisJdTMyIGxheWVyc19jb3VudDsKK307CisKK3N0cnVjdCBsb2dpY3ZjX2RybV9jYXBz
IHsKKwlib29sIGxheWVyX2FkZHJlc3M7Cit9OworCitzdHJ1Y3QgbG9naWN2Y19kcm0geworCWNv
bnN0IHN0cnVjdCBsb2dpY3ZjX2RybV9jYXBzICpjYXBzOworCXN0cnVjdCBsb2dpY3ZjX2RybV9j
b25maWcgY29uZmlnOworCXN0cnVjdCBkcm1fZGV2aWNlICpkcm07CisJcGh5c19hZGRyX3QgcmVz
ZXJ2ZWRfbWVtX2Jhc2U7CisJc3RydWN0IHJlZ21hcCAqcmVnbWFwOworCisJc3RydWN0IGNsayAq
dmNsazsKKwlzdHJ1Y3QgY2xrICp2Y2xrMjsKKwlzdHJ1Y3QgY2xrICpsdmRzY2xrOworCXN0cnVj
dCBjbGsgKmx2ZHNjbGtuOworCisJc3RydWN0IGxpc3RfaGVhZCBsYXllcnNfbGlzdDsKKwlzdHJ1
Y3QgbG9naWN2Y19jcnRjICpjcnRjOworCXN0cnVjdCBsb2dpY3ZjX2ludGVyZmFjZSAqaW50ZXJm
YWNlOworfTsKKworI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9s
b2dpY3ZjX2ludGVyZmFjZS5jIGIvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19pbnRl
cmZhY2UuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjc5MmIxZmMy
YTVmNwotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNf
aW50ZXJmYWNlLmMKQEAgLTAsMCArMSwyMzUgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVy
OiBHUEwtMi4wKworLyoKKyAqIENvcHlyaWdodCAoQykgMjAxOSBCb290bGluCisgKiBBdXRob3I6
IFBhdWwgS29jaWFsa293c2tpIDxwYXVsLmtvY2lhbGtvd3NraUBib290bGluLmNvbT4KKyAqLwor
CisjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pY19oZWxw
ZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2JyaWRnZS5oPgorI2luY2x1ZGUgPGRybS9kcm1fY29u
bmVjdG9yLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9jcnRjX2hlbHBlci5oPgorI2luY2x1ZGUgPGRy
bS9kcm1fZHJ2Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV9lbmNvZGVyLmg+CisjaW5jbHVkZSA8ZHJt
L2RybV9nZW1fY21hX2hlbHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fbW9kZXNldF9oZWxwZXJf
dnRhYmxlcy5oPgorI2luY2x1ZGUgPGRybS9kcm1fb2YuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3Bh
bmVsLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wcmludC5oPgorI2luY2x1ZGUgPGRybS9kcm1fcHJv
YmVfaGVscGVyLmg+CisKKyNpbmNsdWRlICJsb2dpY3ZjX2NydGMuaCIKKyNpbmNsdWRlICJsb2dp
Y3ZjX2RybS5oIgorI2luY2x1ZGUgImxvZ2ljdmNfaW50ZXJmYWNlLmgiCisjaW5jbHVkZSAibG9n
aWN2Y19yZWdzLmgiCisKKyNkZWZpbmUgbG9naWN2Y19pbnRlcmZhY2VfZnJvbV9kcm1fZW5jb2Rl
cihjKSBcCisJY29udGFpbmVyX29mKGMsIHN0cnVjdCBsb2dpY3ZjX2ludGVyZmFjZSwgZHJtX2Vu
Y29kZXIpCisjZGVmaW5lIGxvZ2ljdmNfaW50ZXJmYWNlX2Zyb21fZHJtX2Nvbm5lY3RvcihjKSBc
CisJY29udGFpbmVyX29mKGMsIHN0cnVjdCBsb2dpY3ZjX2ludGVyZmFjZSwgZHJtX2Nvbm5lY3Rv
cikKKworc3RhdGljIHZvaWQgbG9naWN2Y19lbmNvZGVyX2VuYWJsZShzdHJ1Y3QgZHJtX2VuY29k
ZXIgKmRybV9lbmNvZGVyKQoreworCXN0cnVjdCBsb2dpY3ZjX2ludGVyZmFjZSAqaW50ZXJmYWNl
ID0KKwkJbG9naWN2Y19pbnRlcmZhY2VfZnJvbV9kcm1fZW5jb2Rlcihkcm1fZW5jb2Rlcik7CisK
KwlyZWdtYXBfdXBkYXRlX2JpdHMoaW50ZXJmYWNlLT5sb2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNf
UE9XRVJfQ1RSTF9SRUcsCisJCQkgICBMT0dJQ1ZDX1BPV0VSX0NUUkxfVklERU9fRU5BQkxFLAor
CQkJICAgTE9HSUNWQ19QT1dFUl9DVFJMX1ZJREVPX0VOQUJMRSk7CisKKwlpZiAoaW50ZXJmYWNl
LT5kcm1fcGFuZWwpIHsKKwkJZHJtX3BhbmVsX3ByZXBhcmUoaW50ZXJmYWNlLT5kcm1fcGFuZWwp
OworCisJCS8qIEVuY29kZXIgZW5hYmxlIGlzIHRvbyBlYXJseSB0byBlbmFibGUgdGhlIHBhbmVs
IGFuZCBhIHdoaXRlCisJCSAqIHNjcmVlbiB3aWxsIGJlIHNlZW4gaWYgdGhlIHBhbmVsIGdldHMg
ZW5hYmxlZCBiZWZvcmUgdGhlCisJCSAqIGZpcnN0IHBhZ2UgZmxpcCBpcyBkb25lIChhbmQgbm8g
b3RoZXIgZnJhbWVidWZmZXIKKwkJICogY29uZmlndXJhdGlvbiByZW1haW5zIGZyb20gdGhlIGJv
b3Qgc29mdHdhcmUpLiAqLworCQlpbnRlcmZhY2UtPmRybV9wYW5lbF9lbmFibGVkID0gZmFsc2U7
CisJfQorfQorCitzdGF0aWMgdm9pZCBsb2dpY3ZjX2VuY29kZXJfZGlzYWJsZShzdHJ1Y3QgZHJt
X2VuY29kZXIgKmRybV9lbmNvZGVyKQoreworCXN0cnVjdCBsb2dpY3ZjX2ludGVyZmFjZSAqaW50
ZXJmYWNlID0KKwkJbG9naWN2Y19pbnRlcmZhY2VfZnJvbV9kcm1fZW5jb2Rlcihkcm1fZW5jb2Rl
cik7CisKKwlpZiAoaW50ZXJmYWNlLT5kcm1fcGFuZWwpIHsKKwkJZHJtX3BhbmVsX2Rpc2FibGUo
aW50ZXJmYWNlLT5kcm1fcGFuZWwpOworCQlkcm1fcGFuZWxfdW5wcmVwYXJlKGludGVyZmFjZS0+
ZHJtX3BhbmVsKTsKKwl9Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2VuY29kZXJfaGVs
cGVyX2Z1bmNzIGxvZ2ljdmNfZW5jb2Rlcl9oZWxwZXJfZnVuY3MgPSB7CisJLmVuYWJsZQkJCT0g
bG9naWN2Y19lbmNvZGVyX2VuYWJsZSwKKwkuZGlzYWJsZQkJPSBsb2dpY3ZjX2VuY29kZXJfZGlz
YWJsZSwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2VuY29kZXJfZnVuY3MgbG9naWN2
Y19lbmNvZGVyX2Z1bmNzID0geworCS5kZXN0cm95CQk9IGRybV9lbmNvZGVyX2NsZWFudXAsCit9
OworCitzdGF0aWMgaW50IGxvZ2ljdmNfY29ubmVjdG9yX2dldF9tb2RlcyhzdHJ1Y3QgZHJtX2Nv
bm5lY3RvciAqZHJtX2Nvbm5lY3RvcikKK3sKKwlzdHJ1Y3QgbG9naWN2Y19pbnRlcmZhY2UgKmlu
dGVyZmFjZSA9CisJCWxvZ2ljdmNfaW50ZXJmYWNlX2Zyb21fZHJtX2Nvbm5lY3Rvcihkcm1fY29u
bmVjdG9yKTsKKworCWlmIChpbnRlcmZhY2UtPmRybV9wYW5lbCkKKwkJcmV0dXJuIGRybV9wYW5l
bF9nZXRfbW9kZXMoaW50ZXJmYWNlLT5kcm1fcGFuZWwpOworCisJcmV0dXJuIDA7Cit9CisKK3N0
YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9oZWxwZXJfZnVuY3MgbG9naWN2Y19jb25u
ZWN0b3JfaGVscGVyX2Z1bmNzID0geworCS5nZXRfbW9kZXMJCT0gbG9naWN2Y19jb25uZWN0b3Jf
Z2V0X21vZGVzLAorfTsKKworc3RhdGljIHZvaWQgbG9naWN2Y19jb25uZWN0b3JfZGVzdHJveShz
dHJ1Y3QgZHJtX2Nvbm5lY3RvciAqZHJtX2Nvbm5lY3RvcikKK3sKKwlzdHJ1Y3QgbG9naWN2Y19p
bnRlcmZhY2UgKmludGVyZmFjZSA9CisJCWxvZ2ljdmNfaW50ZXJmYWNlX2Zyb21fZHJtX2Nvbm5l
Y3Rvcihkcm1fY29ubmVjdG9yKTsKKworCWlmIChpbnRlcmZhY2UtPmRybV9wYW5lbCkKKwkJZHJt
X3BhbmVsX2RldGFjaChpbnRlcmZhY2UtPmRybV9wYW5lbCk7CisKKwlkcm1fY29ubmVjdG9yX2Ns
ZWFudXAoZHJtX2Nvbm5lY3Rvcik7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5l
Y3Rvcl9mdW5jcyBsb2dpY3ZjX2Nvbm5lY3Rvcl9mdW5jcyA9IHsKKwkucmVzZXQJCQk9IGRybV9h
dG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9yZXNldCwKKwkuZmlsbF9tb2RlcwkJPSBkcm1faGVscGVy
X3Byb2JlX3NpbmdsZV9jb25uZWN0b3JfbW9kZXMsCisJLmRlc3Ryb3kJCT0gbG9naWN2Y19jb25u
ZWN0b3JfZGVzdHJveSwKKwkuYXRvbWljX2R1cGxpY2F0ZV9zdGF0ZQk9IGRybV9hdG9taWNfaGVs
cGVyX2Nvbm5lY3Rvcl9kdXBsaWNhdGVfc3RhdGUsCisJLmF0b21pY19kZXN0cm95X3N0YXRlCT0g
ZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2Rlc3Ryb3lfc3RhdGUsCit9OworCitzdGF0aWMg
aW50IGxvZ2ljdmNfaW50ZXJmYWNlX2VuY29kZXJfdHlwZShzdHJ1Y3QgbG9naWN2Y19kcm0gKmxv
Z2ljdmMpCit7CisJc3dpdGNoIChsb2dpY3ZjLT5jb25maWcuZGlzcGxheV9pbnRlcmZhY2UpIHsK
KwljYXNlIExPR0lDVkNfRElTUExBWV9JTlRFUkZBQ0VfTFZEU180QklUUzoKKwljYXNlIExPR0lD
VkNfRElTUExBWV9JTlRFUkZBQ0VfTFZEU180QklUU19DQU1FUkE6CisJY2FzZSBMT0dJQ1ZDX0RJ
U1BMQVlfSU5URVJGQUNFX0xWRFNfM0JJVFM6CisJCXJldHVybiBEUk1fTU9ERV9FTkNPREVSX0xW
RFM7CisJY2FzZSBMT0dJQ1ZDX0RJU1BMQVlfSU5URVJGQUNFX0RWSToKKwkJcmV0dXJuIERSTV9N
T0RFX0VOQ09ERVJfVE1EUzsKKwljYXNlIExPR0lDVkNfRElTUExBWV9JTlRFUkZBQ0VfUkdCOgor
CQlyZXR1cm4gRFJNX01PREVfRU5DT0RFUl9EUEk7CisJZGVmYXVsdDoKKwkJcmV0dXJuIERSTV9N
T0RFX0VOQ09ERVJfTk9ORTsKKwl9Cit9CisKK3N0YXRpYyBpbnQgbG9naWN2Y19pbnRlcmZhY2Vf
Y29ubmVjdG9yX3R5cGUoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjKQoreworCXN3aXRjaCAo
bG9naWN2Yy0+Y29uZmlnLmRpc3BsYXlfaW50ZXJmYWNlKSB7CisJY2FzZSBMT0dJQ1ZDX0RJU1BM
QVlfSU5URVJGQUNFX0xWRFNfNEJJVFM6CisJY2FzZSBMT0dJQ1ZDX0RJU1BMQVlfSU5URVJGQUNF
X0xWRFNfNEJJVFNfQ0FNRVJBOgorCWNhc2UgTE9HSUNWQ19ESVNQTEFZX0lOVEVSRkFDRV9MVkRT
XzNCSVRTOgorCQlyZXR1cm4gRFJNX01PREVfQ09OTkVDVE9SX0xWRFM7CisJY2FzZSBMT0dJQ1ZD
X0RJU1BMQVlfSU5URVJGQUNFX0RWSToKKwkJcmV0dXJuIERSTV9NT0RFX0NPTk5FQ1RPUl9EVklE
OworCWNhc2UgTE9HSUNWQ19ESVNQTEFZX0lOVEVSRkFDRV9SR0I6CisJCXJldHVybiBEUk1fTU9E
RV9DT05ORUNUT1JfRFBJOworCWRlZmF1bHQ6CisJCXJldHVybiBEUk1fTU9ERV9DT05ORUNUT1Jf
VW5rbm93bjsKKwl9Cit9CisKK3N0YXRpYyBib29sIGxvZ2ljdmNfaW50ZXJmYWNlX25hdGl2ZV9j
b25uZWN0b3Ioc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjKQoreworCXN3aXRjaCAobG9naWN2
Yy0+Y29uZmlnLmRpc3BsYXlfaW50ZXJmYWNlKSB7CisJY2FzZSBMT0dJQ1ZDX0RJU1BMQVlfSU5U
RVJGQUNFX0RWSToKKwkJcmV0dXJuIHRydWU7CisJZGVmYXVsdDoKKwkJcmV0dXJuIGZhbHNlOwor
CX0KK30KKwordm9pZCBsb2dpY3ZjX2ludGVyZmFjZV9hdHRhY2hfY3J0YyhzdHJ1Y3QgbG9naWN2
Y19kcm0gKmxvZ2ljdmMpCit7CisJdWludDMyX3QgcG9zc2libGVfY3J0Y3MgPSBkcm1fY3J0Y19t
YXNrKCZsb2dpY3ZjLT5jcnRjLT5kcm1fY3J0Yyk7CisKKwlsb2dpY3ZjLT5pbnRlcmZhY2UtPmRy
bV9lbmNvZGVyLnBvc3NpYmxlX2NydGNzID0gcG9zc2libGVfY3J0Y3M7Cit9CisKK2ludCBsb2dp
Y3ZjX2ludGVyZmFjZV9pbml0KHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YykKK3sKKwlzdHJ1
Y3QgbG9naWN2Y19pbnRlcmZhY2UgKmludGVyZmFjZTsKKwlzdHJ1Y3QgZGV2aWNlX25vZGUgKm9m
X25vZGUgPSBsb2dpY3ZjLT5kcm0tPmRldi0+b2Zfbm9kZTsKKwlpbnQgZW5jb2Rlcl90eXBlID0g
bG9naWN2Y19pbnRlcmZhY2VfZW5jb2Rlcl90eXBlKGxvZ2ljdmMpOworCWludCBjb25uZWN0b3Jf
dHlwZSA9IGxvZ2ljdmNfaW50ZXJmYWNlX2Nvbm5lY3Rvcl90eXBlKGxvZ2ljdmMpOworCWJvb2wg
bmF0aXZlX2Nvbm5lY3RvciA9IGxvZ2ljdmNfaW50ZXJmYWNlX25hdGl2ZV9jb25uZWN0b3IobG9n
aWN2Yyk7CisJaW50IHJldDsKKworCWludGVyZmFjZSA9IGRldm1fa3phbGxvYyhsb2dpY3ZjLT5k
cm0tPmRldiwgc2l6ZW9mKCppbnRlcmZhY2UpLAorCQkJCSBHRlBfS0VSTkVMKTsKKwlpZiAoIWlu
dGVyZmFjZSkgeworCQlyZXQgPSAtRU5PTUVNOworCQlnb3RvIGVycm9yX2Vhcmx5OworCX0KKwor
CWludGVyZmFjZS0+bG9naWN2YyA9IGxvZ2ljdmM7CisKKwlyZXQgPSBkcm1fb2ZfZmluZF9wYW5l
bF9vcl9icmlkZ2Uob2Zfbm9kZSwgMSwgMCwgJmludGVyZmFjZS0+ZHJtX3BhbmVsLAorCQkJCQkg
ICZpbnRlcmZhY2UtPmRybV9icmlkZ2UpOworCWlmIChyZXQgPT0gLUVQUk9CRV9ERUZFUikKKwkJ
Z290byBlcnJvcl9lYXJseTsKKworCXJldCA9IGRybV9lbmNvZGVyX2luaXQobG9naWN2Yy0+ZHJt
LCAmaW50ZXJmYWNlLT5kcm1fZW5jb2RlciwKKwkJCSAgICAgICAmbG9naWN2Y19lbmNvZGVyX2Z1
bmNzLCBlbmNvZGVyX3R5cGUsIE5VTEwpOworCWlmIChyZXQpIHsKKwkJRFJNX0VSUk9SKCJGYWls
ZWQgdG8gaW5pdGFsaXplIGVuY29kZXJcbiIpOworCQlnb3RvIGVycm9yX2Vhcmx5OworCX0KKwor
CWRybV9lbmNvZGVyX2hlbHBlcl9hZGQoJmludGVyZmFjZS0+ZHJtX2VuY29kZXIsCisJCQkgICAg
ICAgJmxvZ2ljdmNfZW5jb2Rlcl9oZWxwZXJfZnVuY3MpOworCisJaWYgKG5hdGl2ZV9jb25uZWN0
b3IgfHwgaW50ZXJmYWNlLT5kcm1fcGFuZWwpIHsKKwkJcmV0ID0gZHJtX2Nvbm5lY3Rvcl9pbml0
KGxvZ2ljdmMtPmRybSwKKwkJCQkJICZpbnRlcmZhY2UtPmRybV9jb25uZWN0b3IsCisJCQkJCSAm
bG9naWN2Y19jb25uZWN0b3JfZnVuY3MsCisJCQkJCSBjb25uZWN0b3JfdHlwZSk7CisJCWlmIChy
ZXQpIHsKKwkJCURSTV9FUlJPUigiRmFpbGVkIHRvIGluaXRhbGl6ZSBjb25uZWN0b3JcbiIpOwor
CQkJZ290byBlcnJvcl9lbmNvZGVyOworCQl9CisKKwkJZHJtX2Nvbm5lY3Rvcl9oZWxwZXJfYWRk
KCZpbnRlcmZhY2UtPmRybV9jb25uZWN0b3IsCisJCQkJCSAmbG9naWN2Y19jb25uZWN0b3JfaGVs
cGVyX2Z1bmNzKTsKKworCQlyZXQgPSBkcm1fY29ubmVjdG9yX2F0dGFjaF9lbmNvZGVyKCZpbnRl
cmZhY2UtPmRybV9jb25uZWN0b3IsCisJCQkJCQkgICAmaW50ZXJmYWNlLT5kcm1fZW5jb2Rlcik7
CisJCWlmIChyZXQpIHsKKwkJCURSTV9FUlJPUigiRmFpbGVkIHRvIGF0dGFjaCBjb25uZWN0b3Ig
dG8gZW5jb2RlclxuIik7CisJCQlnb3RvIGVycm9yX2VuY29kZXI7CisJCX0KKwl9CisKKwlpZiAo
aW50ZXJmYWNlLT5kcm1fcGFuZWwpIHsKKwkJcmV0ID0gZHJtX3BhbmVsX2F0dGFjaChpbnRlcmZh
Y2UtPmRybV9wYW5lbCwKKwkJCQkgICAgICAgJmludGVyZmFjZS0+ZHJtX2Nvbm5lY3Rvcik7CisJ
CWlmIChyZXQpIHsKKwkJCURSTV9FUlJPUigiRmFpbGVkIHRvIGF0dGFjaCBwYW5lbCB0byBjb25u
ZWN0b3JcbiIpOworCQkJZ290byBlcnJvcl9lbmNvZGVyOworCQl9CisJfQorCisJaWYgKGludGVy
ZmFjZS0+ZHJtX2JyaWRnZSkgeworCQlyZXQgPSBkcm1fYnJpZGdlX2F0dGFjaCgmaW50ZXJmYWNl
LT5kcm1fZW5jb2RlciwKKwkJCQkJaW50ZXJmYWNlLT5kcm1fYnJpZGdlLCBOVUxMKTsKKwkJaWYg
KHJldCkgeworCQkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gYXR0YWNoIGJyaWRnZSB0byBlbmNvZGVy
XG4iKTsKKwkJCWdvdG8gZXJyb3JfZW5jb2RlcjsKKwkJfQorCX0KKworCWxvZ2ljdmMtPmludGVy
ZmFjZSA9IGludGVyZmFjZTsKKworCXJldHVybiAwOworCitlcnJvcl9lbmNvZGVyOgorCWRybV9l
bmNvZGVyX2NsZWFudXAoJmludGVyZmFjZS0+ZHJtX2VuY29kZXIpOworCitlcnJvcl9lYXJseToK
KwlyZXR1cm4gcmV0OworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9n
aWN2Y19pbnRlcmZhY2UuaCBiL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfaW50ZXJm
YWNlLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5kMjdhYmZmZjky
OWYKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2lu
dGVyZmFjZS5oCkBAIC0wLDAgKzEsMzIgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBH
UEwtMi4wKyAqLworLyoKKyAqIENvcHlyaWdodCAoQykgMjAxOSBCb290bGluCisgKiBBdXRob3I6
IFBhdWwgS29jaWFsa293c2tpIDxwYXVsLmtvY2lhbGtvd3NraUBib290bGluLmNvbT4KKyAqLwor
CisjaWZuZGVmIF9MT0dJQ1ZDX0lOVEVSRkFDRV9IXworI2RlZmluZSBfTE9HSUNWQ19JTlRFUkZB
Q0VfSF8KKworI2luY2x1ZGUgPGRybS9kcm1fYnJpZGdlLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9j
b25uZWN0b3IuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2VuY29kZXIuaD4KKyNpbmNsdWRlIDxkcm0v
ZHJtX3BhbmVsLmg+CisKK3N0cnVjdCBsb2dpY3ZjX2RybTsKKworc3RydWN0IGxvZ2ljdmNfaW50
ZXJmYWNlIHsKKwlzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmM7CisKKwlzdHJ1Y3QgZHJtX2Vu
Y29kZXIgZHJtX2VuY29kZXI7CisJc3RydWN0IGRybV9jb25uZWN0b3IgZHJtX2Nvbm5lY3RvcjsK
KworCXN0cnVjdCBkcm1fcGFuZWwgKmRybV9wYW5lbDsKKwlzdHJ1Y3QgZHJtX2JyaWRnZSAqZHJt
X2JyaWRnZTsKKworCWJvb2wgZHJtX3BhbmVsX2VuYWJsZWQ7Cit9OworCit2b2lkIGxvZ2ljdmNf
aW50ZXJmYWNlX2F0dGFjaF9jcnRjKHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2Yyk7CitpbnQg
bG9naWN2Y19pbnRlcmZhY2VfaW5pdChzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMpOworCisj
ZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfbGF5ZXIu
YyBiL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfbGF5ZXIuYwpuZXcgZmlsZSBtb2Rl
IDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjNiYTdhMWYyYjg1ZgotLS0gL2Rldi9udWxsCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfbGF5ZXIuYwpAQCAtMCwwICsxLDU5
NCBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjArCisvKgorICogQ29weXJp
Z2h0IChDKSAyMDE5IEJvb3RsaW4KKyAqIEF1dGhvcjogUGF1bCBLb2NpYWxrb3dza2kgPHBhdWwu
a29jaWFsa293c2tpQGJvb3RsaW4uY29tPgorICovCisKKyNpbmNsdWRlIDxsaW51eC9vZi5oPgor
I2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWMuaD4KKyNp
bmNsdWRlIDxkcm0vZHJtX2F0b21pY19oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2ZiX2Nt
YV9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2ZvdXJjYy5oPgorI2luY2x1ZGUgPGRybS9k
cm1fcGxhbmUuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3BsYW5lX2hlbHBlci5oPgorI2luY2x1ZGUg
PGRybS9kcm1fcHJpbnQuaD4KKworI2luY2x1ZGUgImxvZ2ljdmNfY3J0Yy5oIgorI2luY2x1ZGUg
ImxvZ2ljdmNfZHJtLmgiCisjaW5jbHVkZSAibG9naWN2Y19sYXllci5oIgorI2luY2x1ZGUgImxv
Z2ljdmNfb2YuaCIKKyNpbmNsdWRlICJsb2dpY3ZjX3JlZ3MuaCIKKworI2RlZmluZSBsb2dpY3Zj
X2xheWVyKHApIFwKKwljb250YWluZXJfb2YocCwgc3RydWN0IGxvZ2ljdmNfbGF5ZXIsIGRybV9w
bGFuZSkKKworc3RhdGljIHVpbnQzMl90IGxvZ2ljdmNfbGF5ZXJfZm9ybWF0c19yZ2IxNltdID0g
eworCURSTV9GT1JNQVRfUkdCNTY1LAorCURSTV9GT1JNQVRfQkdSNTY1LAorCURSTV9GT1JNQVRf
SU5WQUxJRCwKK307CisKK3N0YXRpYyB1aW50MzJfdCBsb2dpY3ZjX2xheWVyX2Zvcm1hdHNfcmdi
MjRbXSA9IHsKKwlEUk1fRk9STUFUX1hSR0I4ODg4LAorCURSTV9GT1JNQVRfWEJHUjg4ODgsCisJ
RFJNX0ZPUk1BVF9JTlZBTElELAorfTsKKworLyogV2hhdCB3ZSBjYWxsIGRlcHRoIGluIHRoaXMg
ZHJpdmVyIG9ubHkgY291bnRzIGNvbG9yIGNvbXBvbmVudHMsIG5vdCBhbHBoYS4KKyAqIFRoaXMg
YWxsb3dzIHVzIHRvIHN0YXkgY29tcGF0aWJsZSB3aXRoIHRoZSBMb2dpQ1ZDIGJpc3RyZWFtIGRl
ZmluaXRpb25zLiAqLworc3RhdGljIHVpbnQzMl90IGxvZ2ljdmNfbGF5ZXJfZm9ybWF0c19yZ2Iy
NF9hbHBoYVtdID0geworCURSTV9GT1JNQVRfQVJHQjg4ODgsCisJRFJNX0ZPUk1BVF9BQkdSODg4
OCwKKwlEUk1fRk9STUFUX0lOVkFMSUQsCit9OworCitzdGF0aWMgc3RydWN0IGxvZ2ljdmNfbGF5
ZXJfZm9ybWF0cyBsb2dpY3ZjX2xheWVyX2Zvcm1hdHNbXSA9IHsKKwl7CisJCS5jb2xvcnNwYWNl
CT0gTE9HSUNWQ19MQVlFUl9DT0xPUlNQQUNFX1JHQiwKKwkJLmRlcHRoCQk9IDE2LAorCQkuZm9y
bWF0cwk9IGxvZ2ljdmNfbGF5ZXJfZm9ybWF0c19yZ2IxNiwKKwl9LAorCXsKKwkJLmNvbG9yc3Bh
Y2UJPSBMT0dJQ1ZDX0xBWUVSX0NPTE9SU1BBQ0VfUkdCLAorCQkuZGVwdGgJCT0gMjQsCisJCS5m
b3JtYXRzCT0gbG9naWN2Y19sYXllcl9mb3JtYXRzX3JnYjI0LAorCX0sCisJeworCQkuY29sb3Jz
cGFjZQk9IExPR0lDVkNfTEFZRVJfQ09MT1JTUEFDRV9SR0IsCisJCS5kZXB0aAkJPSAyNCwKKwkJ
LmFscGhhCQk9IHRydWUsCisJCS5mb3JtYXRzCT0gbG9naWN2Y19sYXllcl9mb3JtYXRzX3JnYjI0
X2FscGhhLAorCX0sCisJeyB9Cit9OworCitzdGF0aWMgYm9vbCBsb2dpY3ZjX2xheWVyX2Zvcm1h
dF9pbnZlcnRlZCh1aW50MzJfdCBmb3JtYXQpCit7CisJc3dpdGNoIChmb3JtYXQpIHsKKwljYXNl
IERSTV9GT1JNQVRfQkdSNTY1OgorCWNhc2UgRFJNX0ZPUk1BVF9CR1I4ODg6CisJY2FzZSBEUk1f
Rk9STUFUX1hCR1I4ODg4OgorCWNhc2UgRFJNX0ZPUk1BVF9BQkdSODg4ODoKKwkJcmV0dXJuIHRy
dWU7CisJZGVmYXVsdDoKKwkJcmV0dXJuIGZhbHNlOworCX0KK30KKworc3RhdGljIGludCBsb2dp
Y3ZjX3BsYW5lX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX3BsYW5lICpkcm1fcGxhbmUsCisJCQkJ
ICAgICAgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqc3RhdGUpCit7CisJc3RydWN0IGxvZ2ljdmNf
bGF5ZXIgKmxheWVyID0gbG9naWN2Y19sYXllcihkcm1fcGxhbmUpOworCXN0cnVjdCBsb2dpY3Zj
X2RybSAqbG9naWN2YyA9IGxheWVyLT5sb2dpY3ZjOworCXN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZTsKKwlpbnQgbWluX3NjYWxlLCBtYXhfc2NhbGU7CisJYm9vbCBjYW5fcG9zaXRp
b247CisJaW50IHJldDsKKworCWlmICghc3RhdGUtPmNydGMpCisJCXJldHVybiAwOworCisJY3J0
Y19zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X2V4aXN0aW5nX2NydGNfc3RhdGUoc3RhdGUtPnN0YXRl
LAorCQkJCQkJCXN0YXRlLT5jcnRjKTsKKwlpZiAoV0FSTl9PTighY3J0Y19zdGF0ZSkpCisJCXJl
dHVybiAtRUlOVkFMOworCisJaWYgKHN0YXRlLT5jcnRjX3ggPCAwIHx8IHN0YXRlLT5jcnRjX3kg
PCAwKSB7CisJCURSTV9FUlJPUigiTmVnYXRpdmUgb24tQ1JUQyBwb3NpdGlvbnMgYXJlIG5vdCBz
dXBwb3J0ZWQuXG4iKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJaWYgKCFsb2dpY3ZjLT5j
YXBzLT5sYXllcl9hZGRyZXNzKSB7CisJCXJldCA9IGxvZ2ljdmNfbGF5ZXJfYnVmZmVyX2ZpbmRf
c2V0dXAobGF5ZXIsIHN0YXRlLCBOVUxMKTsKKwkJaWYgKHJldCkgeworCQkJRFJNX0VSUk9SKCJO
byB2aWFibGUgc2V0dXAgZm9yIGJ1ZmZlciBmb3VuZC5cbiIpOworCQkJcmV0dXJuIHJldDsKKwkJ
fQorCX0KKworCW1pbl9zY2FsZSA9IERSTV9QTEFORV9IRUxQRVJfTk9fU0NBTElORzsKKwltYXhf
c2NhbGUgPSBEUk1fUExBTkVfSEVMUEVSX05PX1NDQUxJTkc7CisKKwljYW5fcG9zaXRpb24gPSAo
ZHJtX3BsYW5lLT50eXBlID09IERSTV9QTEFORV9UWVBFX09WRVJMQVkgJiYKKwkJCWxheWVyLT5p
bmRleCAhPSAobG9naWN2Yy0+Y29uZmlnLmxheWVyc19jb3VudCAtIDEpICYmCisJCQlsb2dpY3Zj
LT5jb25maWcubGF5ZXJzX2NvbmZpZ3VyYWJsZSk7CisKKwlyZXQgPSBkcm1fYXRvbWljX2hlbHBl
cl9jaGVja19wbGFuZV9zdGF0ZShzdGF0ZSwgY3J0Y19zdGF0ZSwKKwkJCQkJCSAgbWluX3NjYWxl
LCBtYXhfc2NhbGUsCisJCQkJCQkgIGNhbl9wb3NpdGlvbiwgdHJ1ZSk7CisJaWYgKHJldCkgewor
CQlEUk1fRVJST1IoIkludmFsaWQgcGxhbmUgc3RhdGVcblxuIik7CisJCXJldHVybiByZXQ7CisJ
fQorCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGxvZ2ljdmNfcGxhbmVfYXRvbWljX3Vw
ZGF0ZShzdHJ1Y3QgZHJtX3BsYW5lICpkcm1fcGxhbmUsCisJCQkJCXN0cnVjdCBkcm1fcGxhbmVf
c3RhdGUgKm9sZF9zdGF0ZSkKK3sKKwlzdHJ1Y3QgbG9naWN2Y19sYXllciAqbGF5ZXIgPSBsb2dp
Y3ZjX2xheWVyKGRybV9wbGFuZSk7CisJc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjID0gbGF5
ZXItPmxvZ2ljdmM7CisJc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqc3RhdGUgPSBkcm1fcGxhbmUt
PnN0YXRlOworCXN0cnVjdCBkcm1fY3J0YyAqZHJtX2NydGMgPSAmbG9naWN2Yy0+Y3J0Yy0+ZHJt
X2NydGM7CisJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUgPSAmZHJtX2NydGMtPnN0YXRl
LT5hZGp1c3RlZF9tb2RlOworCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gc3RhdGUtPmZi
OworCXN0cnVjdCBsb2dpY3ZjX2xheWVyX2J1ZmZlcl9zZXR1cCBzZXR1cCA9IHt9OworCXUzMiBp
bmRleCA9IGxheWVyLT5pbmRleDsKKwl1MzIgcmVnOworCisJLyogTGF5ZXIgZGltZW5zaW9ucyAq
LworCisJcmVnbWFwX3dyaXRlKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNWQ19MQVlFUl9XSURUSF9S
RUcoaW5kZXgpLAorCQkgICAgIHN0YXRlLT5jcnRjX3cgLSAxKTsKKwlyZWdtYXBfd3JpdGUobG9n
aWN2Yy0+cmVnbWFwLCBMT0dJQ1ZDX0xBWUVSX0hFSUdIVF9SRUcoaW5kZXgpLAorCQkgICAgIHN0
YXRlLT5jcnRjX2ggLSAxKTsKKworCWlmIChsb2dpY3ZjLT5jYXBzLT5sYXllcl9hZGRyZXNzKSB7
CisJCXBoeXNfYWRkcl90IGZiX2FkZHIgPSBkcm1fZmJfY21hX2dldF9nZW1fYWRkcihmYiwgc3Rh
dGUsIDApOworCisJCXJlZ21hcF93cml0ZShsb2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNfTEFZRVJf
QUREUkVTU19SRUcoaW5kZXgpLAorCQkJICAgICBmYl9hZGRyKTsKKwl9IGVsc2UgeworCQkvKiBS
ZWx5IG9uIG9mZnNldHMgdG8gY29uZmlndXJlIHRoZSBhZGRyZXNzLiAqLworCisJCWxvZ2ljdmNf
bGF5ZXJfYnVmZmVyX2ZpbmRfc2V0dXAobGF5ZXIsIHN0YXRlLCAmc2V0dXApOworCisJCS8qIExh
eWVyIG1lbW9yeSBvZmZzZXRzICovCisKKwkJcmVnbWFwX3dyaXRlKGxvZ2ljdmMtPnJlZ21hcCwg
TE9HSUNWQ19CVUZGRVJfU0VMX1JFRywKKwkJCSAgICAgTE9HSUNWQ19CVUZGRVJfU0VMX1ZBTFVF
KGluZGV4LCBzZXR1cC5idWZmZXJfc2VsKSk7CisJCXJlZ21hcF93cml0ZShsb2dpY3ZjLT5yZWdt
YXAsIExPR0lDVkNfTEFZRVJfSE9GRlNFVF9SRUcoaW5kZXgpLAorCQkJICAgICBzZXR1cC5ob2Zm
c2V0KTsKKwkJcmVnbWFwX3dyaXRlKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNWQ19MQVlFUl9WT0ZG
U0VUX1JFRyhpbmRleCksCisJCQkgICAgIHNldHVwLnZvZmZzZXQpOworCX0KKworCS8qIExheWVy
IHBvc2l0aW9uICovCisKKwlyZWdtYXBfd3JpdGUobG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZDX0xB
WUVSX0hQT1NJVElPTl9SRUcoaW5kZXgpLAorCQkgICAgIG1vZGUtPmhkaXNwbGF5IC0gMSAtIHN0
YXRlLT5jcnRjX3gpOworCisJLyogVmVydGljYWwgcG9zaXRpb24gbXVzdCBiZSBzZXQgbGFzdCB0
byBzeW5jIGxheWVyIHJlZ2lzdGVyIGNoYW5nZXMuICovCisJcmVnbWFwX3dyaXRlKGxvZ2ljdmMt
PnJlZ21hcCwgTE9HSUNWQ19MQVlFUl9WUE9TSVRJT05fUkVHKGluZGV4KSwKKwkJICAgICBtb2Rl
LT52ZGlzcGxheSAtIDEgLSBzdGF0ZS0+Y3J0Y195KTsKKworCS8qIExheWVyIGFscGhhICovCisK
KwlpZiAobGF5ZXItPmNvbmZpZy5hbHBoYV9tb2RlID09IExPR0lDVkNfTEFZRVJfQUxQSEFfTEFZ
RVIpIHsKKwkJdTMyIGFscGhhX2JpdHM7CisJCXUzMiBhbHBoYV9tYXg7CisJCXUzMiBhbHBoYTsK
KworCQlzd2l0Y2ggKGxheWVyLT5jb25maWcuZGVwdGgpIHsKKwkJY2FzZSA4OgorCQkJYWxwaGFf
Yml0cyA9IDM7CisJCQlicmVhazsKKwkJY2FzZSAxNjoKKwkJCWlmIChsYXllci0+Y29uZmlnLmNv
bG9yc3BhY2UgPT0gTE9HSUNWQ19MQVlFUl9DT0xPUlNQQUNFX1lVVikKKwkJCQlhbHBoYV9iaXRz
ID0gODsKKwkJCWVsc2UKKwkJCQlhbHBoYV9iaXRzID0gNjsKKwkJCWJyZWFrOworCQlkZWZhdWx0
OgorCQkJYWxwaGFfYml0cyA9IDg7CisJCQlicmVhazsKKwkJfQorCisJCWFscGhhX21heCA9IEJJ
VChhbHBoYV9iaXRzKSAtIDE7CisJCWFscGhhID0gc3RhdGUtPmFscGhhICogYWxwaGFfbWF4IC8g
RFJNX0JMRU5EX0FMUEhBX09QQVFVRTsKKworCQlEUk1fREVCVUdfRFJJVkVSKCJTZXR0aW5nIGxh
eWVyICVkIGFscGhhIHRvICVkLyVkXG4iLCBpbmRleCwKKwkJCQkgYWxwaGEsIGFscGhhX21heCk7
CisKKwkJcmVnbWFwX3dyaXRlKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNWQ19MQVlFUl9BTFBIQV9S
RUcoaW5kZXgpLAorCQkJICAgICBhbHBoYSk7CisJfQorCisJLyogTGF5ZXIgY29udHJvbCAqLwor
CisJcmVnID0gTE9HSUNWQ19MQVlFUl9DVFJMX0VOQUJMRTsKKworCWlmIChsb2dpY3ZjX2xheWVy
X2Zvcm1hdF9pbnZlcnRlZChmYi0+Zm9ybWF0LT5mb3JtYXQpKQorCQlyZWcgfD0gTE9HSUNWQ19M
QVlFUl9DVFJMX1BJWEVMX0ZPUk1BVF9JTlZFUlQ7CisKKwlyZWcgfD0gTE9HSUNWQ19MQVlFUl9D
VFJMX0NPTE9SX0tFWV9ESVNBQkxFOworCisJcmVnbWFwX3dyaXRlKGxvZ2ljdmMtPnJlZ21hcCwg
TE9HSUNWQ19MQVlFUl9DVFJMX1JFRyhpbmRleCksIHJlZyk7Cit9CisKK3N0YXRpYyB2b2lkIGxv
Z2ljdmNfcGxhbmVfYXRvbWljX2Rpc2FibGUoc3RydWN0IGRybV9wbGFuZSAqZHJtX3BsYW5lLAor
CQkJCQkgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqb2xkX3N0YXRlKQoreworCXN0cnVjdCBsb2dp
Y3ZjX2xheWVyICpsYXllciA9IGxvZ2ljdmNfbGF5ZXIoZHJtX3BsYW5lKTsKKwlzdHJ1Y3QgbG9n
aWN2Y19kcm0gKmxvZ2ljdmMgPSBsYXllci0+bG9naWN2YzsKKwl1MzIgaW5kZXggPSBsYXllci0+
aW5kZXg7CisKKwlyZWdtYXBfd3JpdGUobG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZDX0xBWUVSX0NU
UkxfUkVHKGluZGV4KSwgMCk7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgZHJtX3BsYW5lX2hlbHBlcl9m
dW5jcyBsb2dpY3ZjX3BsYW5lX2hlbHBlcl9mdW5jcyA9IHsKKwkuYXRvbWljX2NoZWNrCQk9IGxv
Z2ljdmNfcGxhbmVfYXRvbWljX2NoZWNrLAorCS5hdG9taWNfdXBkYXRlCQk9IGxvZ2ljdmNfcGxh
bmVfYXRvbWljX3VwZGF0ZSwKKwkuYXRvbWljX2Rpc2FibGUJCT0gbG9naWN2Y19wbGFuZV9hdG9t
aWNfZGlzYWJsZSwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX3BsYW5lX2Z1bmNzIGxv
Z2ljdmNfcGxhbmVfZnVuY3MgPSB7CisJLnVwZGF0ZV9wbGFuZQkJPSBkcm1fYXRvbWljX2hlbHBl
cl91cGRhdGVfcGxhbmUsCisJLmRpc2FibGVfcGxhbmUJCT0gZHJtX2F0b21pY19oZWxwZXJfZGlz
YWJsZV9wbGFuZSwKKwkuZGVzdHJveQkJPSBkcm1fcGxhbmVfY2xlYW51cCwKKwkucmVzZXQJCQk9
IGRybV9hdG9taWNfaGVscGVyX3BsYW5lX3Jlc2V0LAorCS5hdG9taWNfZHVwbGljYXRlX3N0YXRl
CT0gZHJtX2F0b21pY19oZWxwZXJfcGxhbmVfZHVwbGljYXRlX3N0YXRlLAorCS5hdG9taWNfZGVz
dHJveV9zdGF0ZQk9IGRybV9hdG9taWNfaGVscGVyX3BsYW5lX2Rlc3Ryb3lfc3RhdGUsCit9Owor
CitpbnQgbG9naWN2Y19sYXllcl9idWZmZXJfZmluZF9zZXR1cChzdHJ1Y3QgbG9naWN2Y19sYXll
ciAqbGF5ZXIsCisJCQkJICAgIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnN0YXRlLAorCQkJCSAg
ICBzdHJ1Y3QgbG9naWN2Y19sYXllcl9idWZmZXJfc2V0dXAgKnNldHVwKQoreworCXN0cnVjdCBs
b2dpY3ZjX2RybSAqbG9naWN2YyA9IGxheWVyLT5sb2dpY3ZjOworCXN0cnVjdCBkcm1fZnJhbWVi
dWZmZXIgKmZiID0gc3RhdGUtPmZiOworCS8qIEFsbCB0aGUgc3VwcG9ydGVkIGZvcm1hdHMgaGF2
ZSBhIHNpbmdsZSBkYXRhIHBsYW5lLiAqLworCXUzMiBsYXllcl9ieXRlc3BwID0gZmItPmZvcm1h
dC0+Y3BwWzBdOworCXUzMiBsYXllcl9zdHJpZGUgPSBsYXllcl9ieXRlc3BwICogbG9naWN2Yy0+
Y29uZmlnLnJvd19zdHJpZGU7CisJdTMyIGJhc2Vfb2Zmc2V0ID0gbGF5ZXItPmNvbmZpZy5iYXNl
X29mZnNldCAqIGxheWVyX3N0cmlkZTsKKwl1MzIgYnVmZmVyX29mZnNldCA9IGxheWVyLT5jb25m
aWcuYnVmZmVyX29mZnNldCAqIGxheWVyX3N0cmlkZTsKKwl1OCBidWZmZXJfc2VsID0gMDsKKwl1
MTYgdm9mZnNldCA9IDA7CisJdTE2IGhvZmZzZXQgPSAwOworCXBoeXNfYWRkcl90IGZiX2FkZHI7
CisJdTMyIGZiX29mZnNldDsKKwl1MzIgZ2FwOworCisJaWYgKCFsb2dpY3ZjLT5yZXNlcnZlZF9t
ZW1fYmFzZSkgeworCQlEUk1fRVJST1IoIk5vIHJlc2VydmVkIG1lbW9yeSBiYXNlIHdhcyByZWdp
c3RlcmVkIVxuIik7CisJCXJldHVybiAtRU5PTUVNOworCX0KKworCWZiX2FkZHIgPSBkcm1fZmJf
Y21hX2dldF9nZW1fYWRkcihmYiwgc3RhdGUsIDApOworCWlmIChmYl9hZGRyIDwgbG9naWN2Yy0+
cmVzZXJ2ZWRfbWVtX2Jhc2UpIHsKKwkJRFJNX0VSUk9SKCJGcmFtZWJ1ZmZlciBtZW1vcnkgYmVs
b3cgcmVzZXJ2ZWQgbWVtb3J5IGJhc2UhXG4iKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJ
ZmJfb2Zmc2V0ID0gKHUzMikgKGZiX2FkZHIgLSBsb2dpY3ZjLT5yZXNlcnZlZF9tZW1fYmFzZSk7
CisKKwlpZiAoZmJfb2Zmc2V0IDwgYmFzZV9vZmZzZXQpIHsKKwkJRFJNX0VSUk9SKCJGcmFtZWJ1
ZmZlciBvZmZzZXQgYmVsb3cgbGF5ZXIgYmFzZSBvZmZzZXQhXG4iKTsKKwkJcmV0dXJuIC1FSU5W
QUw7CisJfQorCisJZ2FwID0gZmJfb2Zmc2V0IC0gYmFzZV9vZmZzZXQ7CisKKwkvKiBVc2UgdGhl
IHBvc3NpYmxlIHZpZGVvIGJ1ZmZlcnMgc2VsZWN0aW9uLiAqLworCWlmIChnYXAgJiYgYnVmZmVy
X29mZnNldCkgeworCQlidWZmZXJfc2VsID0gZ2FwIC8gYnVmZmVyX29mZnNldDsKKwkJaWYgKGJ1
ZmZlcl9zZWwgPiBMT0dJQ1ZDX0JVRkZFUl9TRUxfTUFYKQorCQkJYnVmZmVyX3NlbCA9IExPR0lD
VkNfQlVGRkVSX1NFTF9NQVg7CisKKwkJZ2FwIC09IGJ1ZmZlcl9zZWwgKiBidWZmZXJfb2Zmc2V0
OworCX0KKworCS8qIFVzZSB0aGUgdmVydGljYWwgb2Zmc2V0LiAqLworCWlmIChnYXAgJiYgbGF5
ZXJfc3RyaWRlICYmIGxvZ2ljdmMtPmNvbmZpZy5sYXllcnNfY29uZmlndXJhYmxlKSB7CisJCXZv
ZmZzZXQgPSBnYXAgLyBsYXllcl9zdHJpZGU7CisJCWlmICh2b2Zmc2V0ID4gTE9HSUNWQ19MQVlF
Ul9WT0ZGU0VUX01BWCkKKwkJCXZvZmZzZXQgPSBMT0dJQ1ZDX0xBWUVSX1ZPRkZTRVRfTUFYOwor
CisJCWdhcCAtPSB2b2Zmc2V0ICogbGF5ZXJfc3RyaWRlOworCX0KKworCS8qIFVzZSB0aGUgaG9y
aXpvbnRhbCBvZmZzZXQuICovCisJaWYgKGdhcCAmJiBsYXllcl9ieXRlc3BwICYmIGxvZ2ljdmMt
PmNvbmZpZy5sYXllcnNfY29uZmlndXJhYmxlKSB7CisJCWhvZmZzZXQgPSBnYXAgLyBsYXllcl9i
eXRlc3BwOworCQlpZiAoaG9mZnNldCA+IExPR0lDVkNfRElNRU5TSU9OU19NQVgpCisJCQlob2Zm
c2V0ID0gTE9HSUNWQ19ESU1FTlNJT05TX01BWDsKKworCQlnYXAgLT0gaG9mZnNldCAqIGxheWVy
X2J5dGVzcHA7CisJfQorCisJaWYgKGdhcCkgeworCQlEUk1fRVJST1IoIlVuYWJsZSB0byBmaW5k
IGxheWVyICVkIGJ1ZmZlciBzZXR1cCBmb3IgMHgleCBieXRlIGdhcFxuIiwKKwkJCSAgbGF5ZXIt
PmluZGV4LCBmYl9vZmZzZXQgLSBiYXNlX29mZnNldCk7CisJCXJldHVybiAtRUlOVkFMOworCX0K
KworCURSTV9ERUJVR19EUklWRVIoIkZvdW5kIGxheWVyICVkIGJ1ZmZlciBzZXR1cCBmb3IgMHgl
eCBieXRlIGdhcDpcbiIsCisJCQkgbGF5ZXItPmluZGV4LCBmYl9vZmZzZXQgLSBiYXNlX29mZnNl
dCk7CisKKwlEUk1fREVCVUdfRFJJVkVSKCItIGJ1ZmZlcl9zZWwgPSAweCV4IGNodW5rcyBvZiAw
eCV4IGJ5dGVzXG4iLAorCQkJIGJ1ZmZlcl9zZWwsIGJ1ZmZlcl9vZmZzZXQpOworCURSTV9ERUJV
R19EUklWRVIoIi0gdm9mZnNldCA9IDB4JXggY2h1bmtzIG9mIDB4JXggYnl0ZXNcbiIsIHZvZmZz
ZXQsCisJCQkgbGF5ZXJfc3RyaWRlKTsKKwlEUk1fREVCVUdfRFJJVkVSKCItIGhvZmZzZXQgPSAw
eCV4IGNodW5rcyBvZiAweCV4IGJ5dGVzXG4iLCBob2Zmc2V0LAorCQkJIGxheWVyX2J5dGVzcHAp
OworCisJaWYgKHNldHVwKSB7CisJCXNldHVwLT5idWZmZXJfc2VsID0gYnVmZmVyX3NlbDsKKwkJ
c2V0dXAtPnZvZmZzZXQgPSB2b2Zmc2V0OworCQlzZXR1cC0+aG9mZnNldCA9IGhvZmZzZXQ7CisJ
fQorCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgbG9naWN2Y19sYXllcl9mb3JtYXRz
ICpsb2dpY3ZjX2xheWVyX2Zvcm1hdHNfbG9va3VwKHN0cnVjdCBsb2dpY3ZjX2xheWVyICpsYXll
cikKK3sKKwlib29sIGFscGhhOworCXVuc2lnbmVkIGludCBpID0gMDsKKworCWFscGhhID0gKGxh
eWVyLT5jb25maWcuYWxwaGFfbW9kZSA9PSBMT0dJQ1ZDX0xBWUVSX0FMUEhBX1BJWEVMKTsKKwor
CXdoaWxlIChsb2dpY3ZjX2xheWVyX2Zvcm1hdHNbaV0uZm9ybWF0cykgeworCQlpZiAobG9naWN2
Y19sYXllcl9mb3JtYXRzW2ldLmNvbG9yc3BhY2UgPT0gbGF5ZXItPmNvbmZpZy5jb2xvcnNwYWNl
ICYmCisJCSAgICBsb2dpY3ZjX2xheWVyX2Zvcm1hdHNbaV0uZGVwdGggPT0gbGF5ZXItPmNvbmZp
Zy5kZXB0aCAmJgorCQkgICAgbG9naWN2Y19sYXllcl9mb3JtYXRzW2ldLmFscGhhID09IGFscGhh
KQorCQkJcmV0dXJuICZsb2dpY3ZjX2xheWVyX2Zvcm1hdHNbaV07CisKKwkJaSsrOworCX0KKwor
CXJldHVybiBOVUxMOworfQorCitzdGF0aWMgdW5zaWduZWQgaW50IGxvZ2ljdmNfbGF5ZXJfZm9y
bWF0c19jb3VudChzdHJ1Y3QgbG9naWN2Y19sYXllcl9mb3JtYXRzICpmb3JtYXRzKQoreworCXVu
c2lnbmVkIGludCBjb3VudCA9IDA7CisKKwl3aGlsZSAoZm9ybWF0cy0+Zm9ybWF0c1tjb3VudF0g
IT0gRFJNX0ZPUk1BVF9JTlZBTElEKQorCQljb3VudCsrOworCisJcmV0dXJuIGNvdW50OworfQor
CitzdGF0aWMgaW50IGxvZ2ljdmNfbGF5ZXJfY29uZmlnX3BhcnNlKHN0cnVjdCBsb2dpY3ZjX2Ry
bSAqbG9naWN2YywKKwkJCQkgICAgICBzdHJ1Y3QgbG9naWN2Y19sYXllciAqbGF5ZXIpCit7CisJ
c3RydWN0IGRldmljZV9ub2RlICpvZl9ub2RlID0gbGF5ZXItPm9mX25vZGU7CisJc3RydWN0IGxv
Z2ljdmNfbGF5ZXJfY29uZmlnICpjb25maWcgPSAmbGF5ZXItPmNvbmZpZzsKKwlpbnQgcmV0Owor
CisJbG9naWN2Y19vZl9wcm9wZXJ0eV9wYXJzZV9ib29sKG9mX25vZGUsICJ4eWxvbixsYXllci1w
cmltYXJ5IiwKKwkJCQkgICAgICAgJmNvbmZpZy0+cHJpbWFyeSk7CisKKwlyZXQgPSBsb2dpY3Zj
X29mX3Byb3BlcnR5X3BhcnNlX3UzMihvZl9ub2RlLCAieHlsb24sbGF5ZXItY29sb3JzcGFjZSIs
CisJCQkJCSAgICAmY29uZmlnLT5jb2xvcnNwYWNlKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0
OworCisJcmV0ID0gbG9naWN2Y19vZl9wcm9wZXJ0eV9wYXJzZV91MzIob2Zfbm9kZSwgInh5bG9u
LGxheWVyLWRlcHRoIiwKKwkJCQkJICAgICZjb25maWctPmRlcHRoKTsKKwlpZiAocmV0KQorCQly
ZXR1cm4gcmV0OworCisJcmV0ID0gbG9naWN2Y19vZl9wcm9wZXJ0eV9wYXJzZV91MzIob2Zfbm9k
ZSwgInh5bG9uLGxheWVyLWFscGhhLW1vZGUiLAorCQkJCQkgICAgJmNvbmZpZy0+YWxwaGFfbW9k
ZSk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCS8qIE1lbW9yeSBvZmZzZXQgaXMgb25s
eSByZWxldmFudCB3aXRob3V0IGxheWVyIGFkZHJlc3MgY29uZmlndXJhdGlvbi4gKi8KKwlpZiAo
bG9naWN2Yy0+Y2Fwcy0+bGF5ZXJfYWRkcmVzcykKKwkJcmV0dXJuIDA7CisKKwlyZXQgPSBsb2dp
Y3ZjX29mX3Byb3BlcnR5X3BhcnNlX3UzMihvZl9ub2RlLCAieHlsb24sbGF5ZXItYmFzZS1vZmZz
ZXQiLAorCQkJCQkgICAgJmNvbmZpZy0+YmFzZV9vZmZzZXQpOworCWlmIChyZXQpCisJCXJldHVy
biByZXQ7CisKKwlyZXQgPSBsb2dpY3ZjX29mX3Byb3BlcnR5X3BhcnNlX3UzMihvZl9ub2RlLCAi
eHlsb24sbGF5ZXItYnVmZmVyLW9mZnNldCIsCisJCQkJCSAgICAmY29uZmlnLT5idWZmZXJfb2Zm
c2V0KTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJcmV0dXJuIDA7Cit9CisKK3N0cnVj
dCBsb2dpY3ZjX2xheWVyICpsb2dpY3ZjX2xheWVyX2dldF9mcm9tX2luZGV4KHN0cnVjdCBsb2dp
Y3ZjX2RybSAqbG9naWN2YywKKwkJCQkJCSAgIHUzMiBpbmRleCkKK3sKKwlzdHJ1Y3QgbG9naWN2
Y19sYXllciAqbGF5ZXI7CisKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KGxheWVyLCAmbG9naWN2Yy0+
bGF5ZXJzX2xpc3QsIGxpc3QpCisJCWlmIChsYXllci0+aW5kZXggPT0gaW5kZXgpCisJCQlyZXR1
cm4gbGF5ZXI7CisKKwlyZXR1cm4gTlVMTDsKK30KKworc3RydWN0IGxvZ2ljdmNfbGF5ZXIgKmxv
Z2ljdmNfbGF5ZXJfZ2V0X2Zyb21fdHlwZShzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMsCisJ
CQkJCQkgIGVudW0gZHJtX3BsYW5lX3R5cGUgdHlwZSkKK3sKKwlzdHJ1Y3QgbG9naWN2Y19sYXll
ciAqbGF5ZXI7CisKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KGxheWVyLCAmbG9naWN2Yy0+bGF5ZXJz
X2xpc3QsIGxpc3QpCisJCWlmIChsYXllci0+ZHJtX3BsYW5lLnR5cGUgPT0gdHlwZSkKKwkJCXJl
dHVybiBsYXllcjsKKworCXJldHVybiBOVUxMOworfQorCitzdHJ1Y3QgbG9naWN2Y19sYXllciAq
bG9naWN2Y19sYXllcl9nZXRfcHJpbWFyeShzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMpCit7
CisJcmV0dXJuIGxvZ2ljdmNfbGF5ZXJfZ2V0X2Zyb21fdHlwZShsb2dpY3ZjLCBEUk1fUExBTkVf
VFlQRV9QUklNQVJZKTsKK30KKworc3RhdGljIGludCBsb2dpY3ZjX2xheWVyX2luaXQoc3RydWN0
IGxvZ2ljdmNfZHJtICpsb2dpY3ZjLAorCQkJICAgICAgc3RydWN0IGRldmljZV9ub2RlICpvZl9u
b2RlLCB1MzIgaW5kZXgpCit7CisJc3RydWN0IGxvZ2ljdmNfbGF5ZXIgKmxheWVyID0gTlVMTDsK
KwlzdHJ1Y3QgbG9naWN2Y19sYXllcl9mb3JtYXRzICpmb3JtYXRzOworCXVuc2lnbmVkIGludCBm
b3JtYXRzX2NvdW50OworCWVudW0gZHJtX3BsYW5lX3R5cGUgdHlwZTsKKwl1bnNpZ25lZCBpbnQg
enBvczsKKwlpbnQgcmV0OworCisJbGF5ZXIgPSBkZXZtX2t6YWxsb2MobG9naWN2Yy0+ZHJtLT5k
ZXYsIHNpemVvZigqbGF5ZXIpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWxheWVyKSB7CisJCXJldCA9
IC1FTk9NRU07CisJCWdvdG8gZXJyb3I7CisJfQorCisJbGF5ZXItPmxvZ2ljdmMgPSBsb2dpY3Zj
OworCWxheWVyLT5vZl9ub2RlID0gb2Zfbm9kZTsKKwlsYXllci0+aW5kZXggPSBpbmRleDsKKwor
CXJldCA9IGxvZ2ljdmNfbGF5ZXJfY29uZmlnX3BhcnNlKGxvZ2ljdmMsIGxheWVyKTsKKwlpZiAo
cmV0KSB7CisJCURSTV9FUlJPUigiRmFpbGVkIHRvIHBhcnNlIGNvbmZpZyBmb3IgbGF5ZXIgIyVk
XG4iLCBpbmRleCk7CisJCWdvdG8gZXJyb3I7CisJfQorCisJZm9ybWF0cyA9IGxvZ2ljdmNfbGF5
ZXJfZm9ybWF0c19sb29rdXAobGF5ZXIpOworCWlmICghZm9ybWF0cykgeworCQlEUk1fRVJST1Io
IkZhaWxlZCB0byBsb29rdXAgZm9ybWF0cyBmb3IgbGF5ZXIgIyVkXG4iLCBpbmRleCk7CisJCWdv
dG8gZXJyb3I7CisJfQorCisJZm9ybWF0c19jb3VudCA9IGxvZ2ljdmNfbGF5ZXJfZm9ybWF0c19j
b3VudChmb3JtYXRzKTsKKworCS8qIFRoZSBmaW5hbCBsYXllciBjYW4gYmUgY29uZmlndXJlZCBh
cyBhIGJhY2tncm91bmQgbGF5ZXIuICovCisJaWYgKGxvZ2ljdmMtPmNvbmZpZy5iYWNrZ3JvdW5k
X2xheWVyICYmCisJICAgIGluZGV4ID09IChsb2dpY3ZjLT5jb25maWcubGF5ZXJzX2NvdW50IC0g
MSkpIHsKKwkJLyogQSB6ZXJvIHZhbHVlIGZvciBibGFjayBpcyBvbmx5IHZhbGlkIGZvciBSR0Is
IG5vdCBmb3IgWVVWLAorCQkgKiBzbyB0aGlzIHdpbGwgbmVlZCB0byB0YWtlIHRoZSBmb3JtYXQg
aW4gYWNjb3VudCBmb3IgWVVWLiAqLworCQl1MzIgYmFja2dyb3VuZCA9IDA7CisKKwkJRFJNX0RF
QlVHX0RSSVZFUigiVXNpbmcgbGF5ZXIgIyVkIGFzIGJhY2tncm91bmQgbGF5ZXJcbiIsCisJCQkJ
IGluZGV4KTsKKworCQlyZWdtYXBfd3JpdGUobG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZDX0JBQ0tH
Uk9VTkRfQ09MT1JfUkVHLAorCQkJICAgICBiYWNrZ3JvdW5kKTsKKworCQlkZXZtX2tmcmVlKGxv
Z2ljdmMtPmRybS0+ZGV2LCBsYXllcik7CisKKwkJcmV0dXJuIDA7CisJfQorCisJaWYgKGxheWVy
LT5jb25maWcucHJpbWFyeSkKKwkJdHlwZSA9IERSTV9QTEFORV9UWVBFX1BSSU1BUlk7CisJZWxz
ZQorCQl0eXBlID0gRFJNX1BMQU5FX1RZUEVfT1ZFUkxBWTsKKworCXJldCA9IGRybV91bml2ZXJz
YWxfcGxhbmVfaW5pdChsb2dpY3ZjLT5kcm0sICZsYXllci0+ZHJtX3BsYW5lLCAwLAorCQkJCSAg
ICAgICAmbG9naWN2Y19wbGFuZV9mdW5jcywgZm9ybWF0cy0+Zm9ybWF0cywKKwkJCQkgICAgICAg
Zm9ybWF0c19jb3VudCwgTlVMTCwgdHlwZSwgTlVMTCk7CisJaWYgKHJldCkgeworCQlEUk1fRVJS
T1IoIkZhaWxlZCB0byBpbml0aWFsaXplIGxheWVyIHBsYW5lXG4iKTsKKwkJcmV0dXJuIHJldDsK
Kwl9CisKKwlkcm1fcGxhbmVfaGVscGVyX2FkZCgmbGF5ZXItPmRybV9wbGFuZSwgJmxvZ2ljdmNf
cGxhbmVfaGVscGVyX2Z1bmNzKTsKKworCXpwb3MgPSBsb2dpY3ZjLT5jb25maWcubGF5ZXJzX2Nv
dW50IC0gaW5kZXggLSAxOworCURSTV9ERUJVR19EUklWRVIoIkdpdmluZyBsYXllciAjJWQgenBv
cyAlZFxuIiwgaW5kZXgsIHpwb3MpOworCisJaWYgKGxheWVyLT5jb25maWcuYWxwaGFfbW9kZSA9
PSBMT0dJQ1ZDX0xBWUVSX0FMUEhBX0xBWUVSKQorCQlkcm1fcGxhbmVfY3JlYXRlX2FscGhhX3By
b3BlcnR5KCZsYXllci0+ZHJtX3BsYW5lKTsKKworCWRybV9wbGFuZV9jcmVhdGVfenBvc19pbW11
dGFibGVfcHJvcGVydHkoJmxheWVyLT5kcm1fcGxhbmUsIHpwb3MpOworCisJRFJNX0RFQlVHX0RS
SVZFUigiUmVnaXN0ZXJpbmcgbGF5ZXIgIyVkXG4iLCBpbmRleCk7CisKKwlsYXllci0+Zm9ybWF0
cyA9IGZvcm1hdHM7CisKKwlsaXN0X2FkZF90YWlsKCZsYXllci0+bGlzdCwgJmxvZ2ljdmMtPmxh
eWVyc19saXN0KTsKKworCXJldHVybiAwOworCitlcnJvcjoKKwlpZiAobGF5ZXIpCisJCWRldm1f
a2ZyZWUobG9naWN2Yy0+ZHJtLT5kZXYsIGxheWVyKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0
YXRpYyB2b2lkIGxvZ2ljdmNfbGF5ZXJfZmluaShzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMs
CisJCQkgICAgICAgc3RydWN0IGxvZ2ljdmNfbGF5ZXIgKmxheWVyKQoreworCWxpc3RfZGVsKCZs
YXllci0+bGlzdCk7CisJZGV2bV9rZnJlZShsb2dpY3ZjLT5kcm0tPmRldiwgbGF5ZXIpOworfQor
Cit2b2lkIGxvZ2ljdmNfbGF5ZXJzX2F0dGFjaF9jcnRjKHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9n
aWN2YykKK3sKKwl1aW50MzJfdCBwb3NzaWJsZV9jcnRjcyA9IGRybV9jcnRjX21hc2soJmxvZ2lj
dmMtPmNydGMtPmRybV9jcnRjKTsKKwlzdHJ1Y3QgbG9naWN2Y19sYXllciAqbGF5ZXI7CisKKwls
aXN0X2Zvcl9lYWNoX2VudHJ5KGxheWVyLCAmbG9naWN2Yy0+bGF5ZXJzX2xpc3QsIGxpc3QpIHsK
KwkJaWYgKGxheWVyLT5kcm1fcGxhbmUudHlwZSAhPSBEUk1fUExBTkVfVFlQRV9PVkVSTEFZKQor
CQkJY29udGludWU7CisKKwkJbGF5ZXItPmRybV9wbGFuZS5wb3NzaWJsZV9jcnRjcyA9IHBvc3Np
YmxlX2NydGNzOworCX0KK30KKworaW50IGxvZ2ljdmNfbGF5ZXJzX2luaXQoc3RydWN0IGxvZ2lj
dmNfZHJtICpsb2dpY3ZjKQoreworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqb2Zfbm9kZSA9IGxvZ2lj
dmMtPmRybS0+ZGV2LT5vZl9ub2RlOworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqbGF5ZXJfbm9kZSA9
IE5VTEw7CisJc3RydWN0IGRldmljZV9ub2RlICpsYXllcnNfbm9kZTsKKwlzdHJ1Y3QgbG9naWN2
Y19sYXllciAqbGF5ZXI7CisJc3RydWN0IGxvZ2ljdmNfbGF5ZXIgKm5leHQ7CisJaW50IHJldDsK
KworCWxheWVyc19ub2RlID0gb2ZfZ2V0X2NoaWxkX2J5X25hbWUob2Zfbm9kZSwgImxheWVycyIp
OworCWlmICghbGF5ZXJzX25vZGUpIHsKKwkJRFJNX0VSUk9SKCJObyBsYXllcnMgbm9kZSBmb3Vu
ZCBpbiB0aGUgZGVzY3JpcHRpb25cbiIpOworCQlyZXQgPSAtRU5PREVWOworCQlnb3RvIGVycm9y
OworCX0KKworCWZvcl9lYWNoX2NoaWxkX29mX25vZGUobGF5ZXJzX25vZGUsIGxheWVyX25vZGUp
IHsKKwkJdTMyIGluZGV4ID0gMDsKKworCQlpZiAoIWxvZ2ljdmNfb2Zfbm9kZV9pc19sYXllcihs
YXllcl9ub2RlKSkKKwkJCWNvbnRpbnVlOworCisJCXJldCA9IG9mX3Byb3BlcnR5X3JlYWRfdTMy
KGxheWVyX25vZGUsICJyZWciLCAmaW5kZXgpOworCQlpZiAocmV0KQorCQkJY29udGludWU7CisK
KwkJbGF5ZXIgPSBsb2dpY3ZjX2xheWVyX2dldF9mcm9tX2luZGV4KGxvZ2ljdmMsIGluZGV4KTsK
KwkJaWYgKGxheWVyKSB7CisJCQlEUk1fRVJST1IoIkR1cGxpY2F0ZWQgZW50cnkgZm9yIGxheWVy
ICMlZFxuIiwgaW5kZXgpOworCQkJY29udGludWU7CisJCX0KKworCQlyZXQgPSBsb2dpY3ZjX2xh
eWVyX2luaXQobG9naWN2YywgbGF5ZXJfbm9kZSwgaW5kZXgpOworCQlpZiAocmV0KQorCQkJZ290
byBlcnJvcjsKKworCQlvZl9ub2RlX3B1dChsYXllcl9ub2RlKTsKKwl9CisKKwlvZl9ub2RlX3B1
dChsYXllcnNfbm9kZSk7CisKKwlyZXR1cm4gMDsKKworZXJyb3I6CisJbGlzdF9mb3JfZWFjaF9l
bnRyeV9zYWZlKGxheWVyLCBuZXh0LCAmbG9naWN2Yy0+bGF5ZXJzX2xpc3QsIGxpc3QpCisJCWxv
Z2ljdmNfbGF5ZXJfZmluaShsb2dpY3ZjLCBsYXllcik7CisKKwlyZXR1cm4gcmV0OworfQpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19sYXllci5oIGIvZHJpdmVy
cy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19sYXllci5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0Cmlu
ZGV4IDAwMDAwMDAwMDAwMC4uNzFiM2YxNzdiMDkzCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19sYXllci5oCkBAIC0wLDAgKzEsNjUgQEAKKy8qIFNQ
RFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wKyAqLworLyoKKyAqIENvcHlyaWdodCAoQykg
MjAxOSBCb290bGluCisgKiBBdXRob3I6IFBhdWwgS29jaWFsa293c2tpIDxwYXVsLmtvY2lhbGtv
d3NraUBib290bGluLmNvbT4KKyAqLworCisjaWZuZGVmIF9MT0dJQ1ZDX0xBWUVSX0hfCisjZGVm
aW5lIF9MT0dJQ1ZDX0xBWUVSX0hfCisKKyNpbmNsdWRlIDxsaW51eC9vZi5oPgorI2luY2x1ZGUg
PGxpbnV4L3R5cGVzLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wbGFuZS5oPgorCisjZGVmaW5lIExP
R0lDVkNfTEFZRVJfQ09MT1JTUEFDRV9SR0IJCTAKKyNkZWZpbmUgTE9HSUNWQ19MQVlFUl9DT0xP
UlNQQUNFX1lVVgkJMQorCisjZGVmaW5lIExPR0lDVkNfTEFZRVJfQUxQSEFfTEFZRVIJCTAKKyNk
ZWZpbmUgTE9HSUNWQ19MQVlFUl9BTFBIQV9QSVhFTAkJMQorCitzdHJ1Y3QgbG9naWN2Y19sYXll
cl9idWZmZXJfc2V0dXAgeworCXU4IGJ1ZmZlcl9zZWw7CisJdTE2IHZvZmZzZXQ7CisJdTE2IGhv
ZmZzZXQ7Cit9OworCitzdHJ1Y3QgbG9naWN2Y19sYXllcl9jb25maWcgeworCXUzMiBjb2xvcnNw
YWNlOworCXUzMiBkZXB0aDsKKwl1MzIgYWxwaGFfbW9kZTsKKwl1MzIgYmFzZV9vZmZzZXQ7CisJ
dTMyIGJ1ZmZlcl9vZmZzZXQ7CisJYm9vbCBwcmltYXJ5OworfTsKKworc3RydWN0IGxvZ2ljdmNf
bGF5ZXJfZm9ybWF0cyB7CisJdTMyIGNvbG9yc3BhY2U7CisJdTMyIGRlcHRoOworCWJvb2wgYWxw
aGE7CisJdWludDMyX3QgKmZvcm1hdHM7Cit9OworCitzdHJ1Y3QgbG9naWN2Y19sYXllciB7CisJ
c3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjOworCisJc3RydWN0IGxvZ2ljdmNfbGF5ZXJfY29u
ZmlnIGNvbmZpZzsKKwlzdHJ1Y3QgbG9naWN2Y19sYXllcl9mb3JtYXRzICpmb3JtYXRzOworCXN0
cnVjdCBkZXZpY2Vfbm9kZSAqb2Zfbm9kZTsKKworCXN0cnVjdCBkcm1fcGxhbmUgZHJtX3BsYW5l
OworCXN0cnVjdCBsaXN0X2hlYWQgbGlzdDsKKwl1MzIgaW5kZXg7Cit9OworCitpbnQgbG9naWN2
Y19sYXllcl9idWZmZXJfZmluZF9zZXR1cChzdHJ1Y3QgbG9naWN2Y19sYXllciAqbGF5ZXIsCisJ
CQkJICAgIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnN0YXRlLAorCQkJCSAgICBzdHJ1Y3QgbG9n
aWN2Y19sYXllcl9idWZmZXJfc2V0dXAgKnNldHVwKTsKK3N0cnVjdCBsb2dpY3ZjX2xheWVyICps
b2dpY3ZjX2xheWVyX2dldF9mcm9tX2luZGV4KHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YywK
KwkJCQkJCSAgIHUzMiBpbmRleCk7CitzdHJ1Y3QgbG9naWN2Y19sYXllciAqbG9naWN2Y19sYXll
cl9nZXRfZnJvbV90eXBlKHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YywKKwkJCQkJCSAgZW51
bSBkcm1fcGxhbmVfdHlwZSB0eXBlKTsKK3N0cnVjdCBsb2dpY3ZjX2xheWVyICpsb2dpY3ZjX2xh
eWVyX2dldF9wcmltYXJ5KHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2Yyk7Cit2b2lkIGxvZ2lj
dmNfbGF5ZXJzX2F0dGFjaF9jcnRjKHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2Yyk7CitpbnQg
bG9naWN2Y19sYXllcnNfaW5pdChzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMpOworCisjZW5k
aWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfbW9kZS5jIGIv
ZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19tb2RlLmMKbmV3IGZpbGUgbW9kZSAxMDA2
NDQKaW5kZXggMDAwMDAwMDAwMDAwLi42MDk1ZGE5NzVkN2MKLS0tIC9kZXYvbnVsbAorKysgYi9k
cml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX21vZGUuYwpAQCAtMCwwICsxLDEwMyBAQAor
Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjArCisvKgorICogQ29weXJpZ2h0IChD
KSAyMDE5IEJvb3RsaW4KKyAqIEF1dGhvcjogUGF1bCBLb2NpYWxrb3dza2kgPHBhdWwua29jaWFs
a293c2tpQGJvb3RsaW4uY29tPgorICovCisKKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgorI2lu
Y2x1ZGUgPGRybS9kcm1fYXRvbWljLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWNfaGVscGVy
Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV9jcnRjX2hlbHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1f
ZHJ2Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV9mYl9jbWFfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJt
L2RybV9mYl9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2dlbV9jbWFfaGVscGVyLmg+Cisj
aW5jbHVkZSA8ZHJtL2RybV9nZW1fZnJhbWVidWZmZXJfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJt
L2RybV9tb2RlX2NvbmZpZy5oPgorI2luY2x1ZGUgPGRybS9kcm1fcGFuZWwuaD4KKyNpbmNsdWRl
IDxkcm0vZHJtX3ByaW50Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wcm9iZV9oZWxwZXIuaD4KKyNp
bmNsdWRlIDxkcm0vZHJtX3ZibGFuay5oPgorCisjaW5jbHVkZSAibG9naWN2Y19kcm0uaCIKKyNp
bmNsdWRlICJsb2dpY3ZjX2ludGVyZmFjZS5oIgorI2luY2x1ZGUgImxvZ2ljdmNfbGF5ZXIuaCIK
KyNpbmNsdWRlICJsb2dpY3ZjX21vZGUuaCIKKworc3RhdGljIHZvaWQgbG9naWN2Y19tb2RlX2F0
b21pY19jb21taXRfdGFpbChzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqb2xkX3N0YXRlKQorewor
CXN0cnVjdCBkcm1fZGV2aWNlICpkcm0gPSBvbGRfc3RhdGUtPmRldjsKKwlzdHJ1Y3QgbG9naWN2
Y19kcm0gKmxvZ2ljdmMgPSBkcm0tPmRldl9wcml2YXRlOworCXN0cnVjdCBsb2dpY3ZjX2ludGVy
ZmFjZSAqaW50ZXJmYWNlID0gbG9naWN2Yy0+aW50ZXJmYWNlOworCisJZHJtX2F0b21pY19oZWxw
ZXJfY29tbWl0X3RhaWwob2xkX3N0YXRlKTsKKworCS8qIEVuYWJsZSB0aGUgcGFuZWwgYWZ0ZXIg
dGhlIGZpcnN0IGNvbW1pdCwgd2hpY2ggY29uY2VybnMgb3VyIHBhbmVsCisJICogc2luY2Ugd2Ug
b25seSBzdXBwb3J0IGEgc2luZ2xlIGludGVyZmFjZS4gKi8KKwlpZiAoaW50ZXJmYWNlLT5kcm1f
cGFuZWwgJiYgIWludGVyZmFjZS0+ZHJtX3BhbmVsX2VuYWJsZWQpIHsKKwkJZHJtX3BhbmVsX2Vu
YWJsZShpbnRlcmZhY2UtPmRybV9wYW5lbCk7CisJCWludGVyZmFjZS0+ZHJtX3BhbmVsX2VuYWJs
ZWQgPSB0cnVlOworCX0KK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fbW9kZV9jb25maWdf
aGVscGVyX2Z1bmNzIGxvZ2ljdmNfbW9kZV9jb25maWdfaGVscGVyX2Z1bmNzID0geworCS5hdG9t
aWNfY29tbWl0X3RhaWwJPSBsb2dpY3ZjX21vZGVfYXRvbWljX2NvbW1pdF90YWlsLAorfTsKKwor
c3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fbW9kZV9jb25maWdfZnVuY3MgbG9naWN2Y19tb2RlX2Nv
bmZpZ19mdW5jcyA9IHsKKwkuZmJfY3JlYXRlCQk9IGRybV9nZW1fZmJfY3JlYXRlLAorCS5vdXRw
dXRfcG9sbF9jaGFuZ2VkCT0gZHJtX2ZiX2hlbHBlcl9vdXRwdXRfcG9sbF9jaGFuZ2VkLAorCS5h
dG9taWNfY2hlY2sJCT0gZHJtX2F0b21pY19oZWxwZXJfY2hlY2ssCisJLmF0b21pY19jb21taXQJ
CT0gZHJtX2F0b21pY19oZWxwZXJfY29tbWl0LAorfTsKKworaW50IGxvZ2ljdmNfbW9kZV9pbml0
KHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YykKK3sKKwlzdHJ1Y3QgZHJtX21vZGVfY29uZmln
ICptb2RlX2NvbmZpZyA9ICZsb2dpY3ZjLT5kcm0tPm1vZGVfY29uZmlnOworCXN0cnVjdCBsb2dp
Y3ZjX2xheWVyICpsYXllcl9wcmltYXJ5OworCXVpbnQzMl90IHByZWZlcnJlZF9kZXB0aDsKKwlp
bnQgcmV0OworCisJcmV0ID0gZHJtX3ZibGFua19pbml0KGxvZ2ljdmMtPmRybSwgbG9naWN2Yy0+
ZHJtLT5tb2RlX2NvbmZpZy5udW1fY3J0Yyk7CisJaWYgKHJldCkgeworCQlEUk1fRVJST1IoIkZh
aWxlZCB0byBpbml0aWFsaXplIHZibGFua1xuIik7CisJCXJldHVybiByZXQ7CisJfQorCisJbGF5
ZXJfcHJpbWFyeSA9IGxvZ2ljdmNfbGF5ZXJfZ2V0X3ByaW1hcnkobG9naWN2Yyk7CisJaWYgKCFs
YXllcl9wcmltYXJ5KSB7CisJCURSTV9FUlJPUigiRmFpbGVkIHRvIGdldCBwcmltYXJ5IGxheWVy
XG4iKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJcHJlZmVycmVkX2RlcHRoID0gbGF5ZXJf
cHJpbWFyeS0+Zm9ybWF0cy0+ZGVwdGg7CisKKwkvKiBEUk0gY291bnRzIGFscGhhIGluIGRlcHRo
LCBvdXIgZHJpdmVyIGRvZXNuJ3QuICovCisJaWYgKGxheWVyX3ByaW1hcnktPmZvcm1hdHMtPmFs
cGhhKQorCQlwcmVmZXJyZWRfZGVwdGggKz0gODsKKworCW1vZGVfY29uZmlnLT5taW5fd2lkdGgg
PSA2NDsKKwltb2RlX2NvbmZpZy0+bWF4X3dpZHRoID0gMjA0ODsKKwltb2RlX2NvbmZpZy0+bWlu
X2hlaWdodCA9IDE7CisJbW9kZV9jb25maWctPm1heF9oZWlnaHQgPSAyMDQ4OworCW1vZGVfY29u
ZmlnLT5wcmVmZXJyZWRfZGVwdGggPSBwcmVmZXJyZWRfZGVwdGg7CisJbW9kZV9jb25maWctPmZ1
bmNzID0gJmxvZ2ljdmNfbW9kZV9jb25maWdfZnVuY3M7CisJbW9kZV9jb25maWctPmhlbHBlcl9w
cml2YXRlID0gJmxvZ2ljdmNfbW9kZV9jb25maWdfaGVscGVyX2Z1bmNzOworCisJZHJtX21vZGVf
Y29uZmlnX3Jlc2V0KGxvZ2ljdmMtPmRybSk7CisKKwlyZXQgPSBkcm1fZmJkZXZfZ2VuZXJpY19z
ZXR1cChsb2dpY3ZjLT5kcm0sIHByZWZlcnJlZF9kZXB0aCk7CisJaWYgKHJldCkgeworCQlEUk1f
RVJST1IoIkZhaWxlZCB0byBpbml0aWFsaXplIGZiZGV2XG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9
CisKKwlkcm1fa21zX2hlbHBlcl9wb2xsX2luaXQobG9naWN2Yy0+ZHJtKTsKKworCXJldHVybiAw
OworfQorCit2b2lkIGxvZ2ljdmNfbW9kZV9maW5pKHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2
YykKK3sKKwlkcm1fa21zX2hlbHBlcl9wb2xsX2ZpbmkobG9naWN2Yy0+ZHJtKTsKK30KZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfbW9kZS5oIGIvZHJpdmVycy9n
cHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19tb2RlLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXgg
MDAwMDAwMDAwMDAwLi42OTBkZWYxNjE5YTYKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dw
dS9kcm0vbG9naWN2Yy9sb2dpY3ZjX21vZGUuaApAQCAtMCwwICsxLDE1IEBACisvKiBTUERYLUxp
Y2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCsgKi8KKy8qCisgKiBDb3B5cmlnaHQgKEMpIDIwMTkg
Qm9vdGxpbgorICogQXV0aG9yOiBQYXVsIEtvY2lhbGtvd3NraSA8cGF1bC5rb2NpYWxrb3dza2lA
Ym9vdGxpbi5jb20+CisgKi8KKworI2lmbmRlZiBfTE9HSUNWQ19NT0RFX0hfCisjZGVmaW5lIF9M
T0dJQ1ZDX01PREVfSF8KKworc3RydWN0IGxvZ2ljdmNfZHJtOworCitpbnQgbG9naWN2Y19tb2Rl
X2luaXQoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjKTsKK3ZvaWQgbG9naWN2Y19tb2RlX2Zp
bmkoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjKTsKKworI2VuZGlmCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX29mLmMgYi9kcml2ZXJzL2dwdS9kcm0vbG9n
aWN2Yy9sb2dpY3ZjX29mLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAw
Li5jZTYxYWY1NWQyZDAKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2
Yy9sb2dpY3ZjX29mLmMKQEAgLTAsMCArMSwyMDQgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlm
aWVyOiBHUEwtMi4wKworLyoKKyAqIENvcHlyaWdodCAoQykgMjAxOSBCb290bGluCisgKiBBdXRo
b3I6IFBhdWwgS29jaWFsa293c2tpIDxwYXVsLmtvY2lhbGtvd3NraUBib290bGluLmNvbT4KKyAq
LworCisjaW5jbHVkZSA8ZHJtL2RybV9wcmludC5oPgorCisjaW5jbHVkZSAibG9naWN2Y19kcm0u
aCIKKyNpbmNsdWRlICJsb2dpY3ZjX2xheWVyLmgiCisjaW5jbHVkZSAibG9naWN2Y19vZi5oIgor
CitzdGF0aWMgc3RydWN0IGxvZ2ljdmNfb2ZfcHJvcGVydHlfc3YgbG9naWN2Y19vZl9kaXNwbGF5
X2ludGVyZmFjZV9zdltdID0geworCXsgImx2ZHMtNGJpdHMiLAlMT0dJQ1ZDX0RJU1BMQVlfSU5U
RVJGQUNFX0xWRFNfNEJJVFMgfSwKKwl7IH0sCit9OworCitzdGF0aWMgc3RydWN0IGxvZ2ljdmNf
b2ZfcHJvcGVydHlfc3YgbG9naWN2Y19vZl9kaXNwbGF5X2NvbG9yc3BhY2Vfc3ZbXSA9IHsKKwl7
ICJyZ2IiLAlMT0dJQ1ZDX0RJU1BMQVlfQ09MT1JTUEFDRV9SR0IgfSwKKwl7ICJ5dXY0MjIiLAlM
T0dJQ1ZDX0RJU1BMQVlfQ09MT1JTUEFDRV9ZVVY0MjIgfSwKKwl7ICJ5dXY0NDQiLAlMT0dJQ1ZD
X0RJU1BMQVlfQ09MT1JTUEFDRV9ZVVY0NDQgfSwKKwl7IH0sCit9OworCitzdGF0aWMgc3RydWN0
IGxvZ2ljdmNfb2ZfcHJvcGVydHlfc3YgbG9naWN2Y19vZl9sYXllcl9jb2xvcnNwYWNlX3N2W10g
PSB7CisJeyAicmdiIiwJTE9HSUNWQ19MQVlFUl9DT0xPUlNQQUNFX1JHQiB9LAorCXsgInl1diIs
CUxPR0lDVkNfTEFZRVJfQ09MT1JTUEFDRV9ZVVYgfSwKKwl7IH0sCit9OworCitzdGF0aWMgc3Ry
dWN0IGxvZ2ljdmNfb2ZfcHJvcGVydHlfc3YgbG9naWN2Y19vZl9sYXllcl9hbHBoYV9tb2RlX3N2
W10gPSB7CisJeyAibGF5ZXIiLAlMT0dJQ1ZDX0xBWUVSX0FMUEhBX0xBWUVSIH0sCisJeyAicGl4
ZWwiLAlMT0dJQ1ZDX0xBWUVSX0FMUEhBX1BJWEVMIH0sCisJeyB9LAorfTsKKworc3RhdGljIHN0
cnVjdCBsb2dpY3ZjX29mX3Byb3BlcnR5IGxvZ2ljdmNfb2ZfcHJvcGVydGllc1tdID0geworCXsK
KwkJLm5hbWUJCT0gInh5bG9uLGRpc3BsYXktaW50ZXJmYWNlIiwKKwkJLnN2CQk9IGxvZ2ljdmNf
b2ZfZGlzcGxheV9pbnRlcmZhY2Vfc3YsCisJCS5yYW5nZQkJPSB7CisJCQlMT0dJQ1ZDX0RJU1BM
QVlfSU5URVJGQUNFX0xWRFNfNEJJVFMsCisJCQlMT0dJQ1ZDX0RJU1BMQVlfSU5URVJGQUNFX0xW
RFNfNEJJVFMsCisJCX0sCisJfSwKKwl7CisJCS5uYW1lCQk9ICJ4eWxvbixkaXNwbGF5LWNvbG9y
c3BhY2UiLAorCQkuc3YJCT0gbG9naWN2Y19vZl9kaXNwbGF5X2NvbG9yc3BhY2Vfc3YsCisJCS5y
YW5nZQkJPSB7CisJCQlMT0dJQ1ZDX0RJU1BMQVlfQ09MT1JTUEFDRV9SR0IsCisJCQlMT0dJQ1ZD
X0RJU1BMQVlfQ09MT1JTUEFDRV9ZVVY0NDQsCisJCX0sCisJfSwKKwl7CisJCS5uYW1lCQk9ICJ4
eWxvbixkaXNwbGF5LWRlcHRoIiwKKwkJLnJhbmdlCQk9IHsgOCwgMjQgfSwKKwl9LAorCXsKKwkJ
Lm5hbWUJCT0gInh5bG9uLHJvdy1zdHJpZGUiLAorCX0sCisJeworCQkubmFtZQkJPSAieHlsb24s
ZGl0aGVyaW5nIiwKKwkJLm9wdGlvbmFsCT0gdHJ1ZSwKKwl9LAorCXsKKwkJLm5hbWUJCT0gInh5
bG9uLGJhY2tncm91bmQtbGF5ZXIiLAorCQkub3B0aW9uYWwJPSB0cnVlLAorCX0sCisJeworCQku
bmFtZQkJPSAieHlsb24sbGF5ZXJzLWNvbmZpZ3VyYWJsZSIsCisJCS5vcHRpb25hbAk9IHRydWUs
CisJfSwKKwl7CisJCS5uYW1lCQk9ICJ4eWxvbixsYXllcnMtY291bnQiLAorCX0sCisJeworCQku
bmFtZQkJPSAieHlsb24sbGF5ZXItZGVwdGgiLAorCQkucmFuZ2UJCT0geyA4LCAyNCB9LAorCX0s
CisJeworCQkubmFtZQkJPSAieHlsb24sbGF5ZXItY29sb3JzcGFjZSIsCisJCS5zdgkJPSBsb2dp
Y3ZjX29mX2xheWVyX2NvbG9yc3BhY2Vfc3YsCisJCS5yYW5nZQkJPSB7CisJCQlMT0dJQ1ZDX0xB
WUVSX0NPTE9SU1BBQ0VfUkdCLAorCQkJTE9HSUNWQ19MQVlFUl9DT0xPUlNQQUNFX1JHQiwKKwkJ
fSwKKwl9LAorCXsKKwkJLm5hbWUJCT0gInh5bG9uLGxheWVyLWFscGhhLW1vZGUiLAorCQkuc3YJ
CT0gbG9naWN2Y19vZl9sYXllcl9hbHBoYV9tb2RlX3N2LAorCQkucmFuZ2UJCT0geworCQkJTE9H
SUNWQ19MQVlFUl9BTFBIQV9MQVlFUiwKKwkJCUxPR0lDVkNfTEFZRVJfQUxQSEFfUElYRUwsCisJ
CX0sCisJfSwKKwl7CisJCS5uYW1lCQk9ICJ4eWxvbixsYXllci1iYXNlLW9mZnNldCIsCisJfSwK
Kwl7CisJCS5uYW1lCQk9ICJ4eWxvbixsYXllci1idWZmZXItb2Zmc2V0IiwKKwl9LAorCXsKKwkJ
Lm5hbWUJCT0gInh5bG9uLGxheWVyLXByaW1hcnkiLAorCQkub3B0aW9uYWwJPSB0cnVlLAorCX0s
CisJeyB9LAorfTsKKworc3RhdGljIGludCBsb2dpY3ZjX29mX3Byb3BlcnR5X3N2X3ZhbHVlKHN0
cnVjdCBsb2dpY3ZjX29mX3Byb3BlcnR5X3N2ICpzdiwKKwkJCQkJY29uc3QgY2hhciAqc3RyaW5n
LCB1MzIgKnZhbHVlKQoreworCXVuc2lnbmVkIGludCBpID0gMDsKKworCXdoaWxlIChzdltpXS5z
dHJpbmcpIHsKKwkJaWYgKCFzdHJjbXAoc3ZbaV0uc3RyaW5nLCBzdHJpbmcpKSB7CisJCQkqdmFs
dWUgPSBzdltpXS52YWx1ZTsKKwkJCXJldHVybiAwOworCQl9CisKKwkJaSsrOworCX0KKworCXJl
dHVybiAtRUlOVkFMOworfQorCitzdGF0aWMgc3RydWN0IGxvZ2ljdmNfb2ZfcHJvcGVydHkgKmxv
Z2ljdmNfb2ZfcHJvcGVydHlfbG9va3VwKGNvbnN0IGNoYXIgKm5hbWUpCit7CisJdW5zaWduZWQg
aW50IGkgPSAwOworCisJd2hpbGUgKGxvZ2ljdmNfb2ZfcHJvcGVydGllc1tpXS5uYW1lKSB7CisJ
CWlmICghc3RyY21wKGxvZ2ljdmNfb2ZfcHJvcGVydGllc1tpXS5uYW1lLCBuYW1lKSkKKwkJCXJl
dHVybiAmbG9naWN2Y19vZl9wcm9wZXJ0aWVzW2ldOworCisJCWkrKzsKKwl9CisKKwlyZXR1cm4g
TlVMTDsKK30KKworaW50IGxvZ2ljdmNfb2ZfcHJvcGVydHlfcGFyc2VfdTMyKHN0cnVjdCBkZXZp
Y2Vfbm9kZSAqb2Zfbm9kZSwKKwkJCQkgIGNvbnN0IGNoYXIgKm5hbWUsIHUzMiAqdGFyZ2V0KQor
eworCXN0cnVjdCBsb2dpY3ZjX29mX3Byb3BlcnR5ICpwcm9wZXJ0eTsKKwljb25zdCBjaGFyICpz
dHJpbmc7CisJdTMyIHZhbHVlOworCWludCByZXQ7CisKKwlwcm9wZXJ0eSA9IGxvZ2ljdmNfb2Zf
cHJvcGVydHlfbG9va3VwKG5hbWUpOworCWlmICghcHJvcGVydHkpCisJCXJldHVybiAtRUlOVkFM
OworCisJaWYgKCFwcm9wZXJ0eS0+b3B0aW9uYWwgJiYgIW9mX3Byb3BlcnR5X3JlYWRfYm9vbChv
Zl9ub2RlLCBuYW1lKSkgeworCQlEUk1fRVJST1IoIk1pc3Npbmcgbm9uLW9wdGlvbmFsIE9GIHBy
b3BlcnR5ICVzXG4iLCBuYW1lKTsKKwkJcmV0dXJuIC1FTk9ERVY7CisJfQorCisJaWYgKHByb3Bl
cnR5LT5zdikgeworCQlyZXQgPSBvZl9wcm9wZXJ0eV9yZWFkX3N0cmluZyhvZl9ub2RlLCBuYW1l
LCAmc3RyaW5nKTsKKwkJaWYgKHJldCkgeworCQkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gcmVhZCBP
RiBwcm9wZXJ0eSAlc1xuIiwgbmFtZSk7CisJCQlyZXR1cm4gcmV0OworCQl9CisKKwkJcmV0ID0g
bG9naWN2Y19vZl9wcm9wZXJ0eV9zdl92YWx1ZShwcm9wZXJ0eS0+c3YsIHN0cmluZywKKwkJCQkJ
CSAgICZ2YWx1ZSk7CisJCWlmIChyZXQpIHsKKwkJCURSTV9FUlJPUigiRmFpbGVkIHRvIG1hdGNo
IE9GIHN0cmluZyAlc1xuIiwgbmFtZSk7CisJCQlyZXR1cm4gcmV0OworCQl9CisJfSBlbHNlIHsK
KwkJcmV0ID0gb2ZfcHJvcGVydHlfcmVhZF91MzIob2Zfbm9kZSwgbmFtZSwgJnZhbHVlKTsKKwkJ
aWYgKHJldCkgeworCQkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gcmVhZCBPRiBwcm9wZXJ0eSAlc1xu
IiwgbmFtZSk7CisJCQlyZXR1cm4gcmV0OworCQl9CisJfQorCisJaWYgKHByb3BlcnR5LT5yYW5n
ZVswXSB8fCBwcm9wZXJ0eS0+cmFuZ2VbMV0pCisJCWlmICh2YWx1ZSA8IHByb3BlcnR5LT5yYW5n
ZVswXSB8fCB2YWx1ZSA+IHByb3BlcnR5LT5yYW5nZVsxXSkKKwkJCXJldHVybiAtRVJBTkdFOwor
CisJKnRhcmdldCA9IHZhbHVlOworCisJcmV0dXJuIDA7Cit9CisKK3ZvaWQgbG9naWN2Y19vZl9w
cm9wZXJ0eV9wYXJzZV9ib29sKHN0cnVjdCBkZXZpY2Vfbm9kZSAqb2Zfbm9kZSwKKwkJCQkgICAg
Y29uc3QgY2hhciAqbmFtZSwgYm9vbCAqdGFyZ2V0KQoreworCXN0cnVjdCBsb2dpY3ZjX29mX3By
b3BlcnR5ICpwcm9wZXJ0eTsKKworCXByb3BlcnR5ID0gbG9naWN2Y19vZl9wcm9wZXJ0eV9sb29r
dXAobmFtZSk7CisJaWYgKCFwcm9wZXJ0eSkgeworCQkqdGFyZ2V0ID0gZmFsc2U7CisJCXJldHVy
bjsKKwl9CisKKwkqdGFyZ2V0ID0gb2ZfcHJvcGVydHlfcmVhZF9ib29sKG9mX25vZGUsIG5hbWUp
OworfQorCitib29sIGxvZ2ljdmNfb2Zfbm9kZV9pc19sYXllcihzdHJ1Y3QgZGV2aWNlX25vZGUg
Km9mX25vZGUpCit7CisJcmV0dXJuICFvZl9ub2RlX2NtcChvZl9ub2RlLT5uYW1lLCAibGF5ZXIi
KTsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfb2YuaCBi
L2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfb2YuaApuZXcgZmlsZSBtb2RlIDEwMDY0
NAppbmRleCAwMDAwMDAwMDAwMDAuLjVjNmYzZjMzNTAzYQotLS0gL2Rldi9udWxsCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfb2YuaApAQCAtMCwwICsxLDI4IEBACisvKiBT
UERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCsgKi8KKy8qCisgKiBDb3B5cmlnaHQgKEMp
IDIwMTkgQm9vdGxpbgorICogQXV0aG9yOiBQYXVsIEtvY2lhbGtvd3NraSA8cGF1bC5rb2NpYWxr
b3dza2lAYm9vdGxpbi5jb20+CisgKi8KKworI2lmbmRlZiBfTE9HSUNWQ19PRl9IXworI2RlZmlu
ZSBfTE9HSUNWQ19PRl9IXworCitzdHJ1Y3QgbG9naWN2Y19vZl9wcm9wZXJ0eV9zdiB7CisJY29u
c3QgY2hhciAqc3RyaW5nOworCXUzMiB2YWx1ZTsKK307CisKK3N0cnVjdCBsb2dpY3ZjX29mX3By
b3BlcnR5IHsKKwljaGFyICpuYW1lOworCWJvb2wgb3B0aW9uYWw7CisJc3RydWN0IGxvZ2ljdmNf
b2ZfcHJvcGVydHlfc3YgKnN2OworCXUzMiByYW5nZVsyXTsKK307CisKK2ludCBsb2dpY3ZjX29m
X3Byb3BlcnR5X3BhcnNlX3UzMihzdHJ1Y3QgZGV2aWNlX25vZGUgKm9mX25vZGUsCisJCQkJICBj
b25zdCBjaGFyICpuYW1lLCB1MzIgKnRhcmdldCk7Cit2b2lkIGxvZ2ljdmNfb2ZfcHJvcGVydHlf
cGFyc2VfYm9vbChzdHJ1Y3QgZGV2aWNlX25vZGUgKm9mX25vZGUsCisJCQkJICAgIGNvbnN0IGNo
YXIgKm5hbWUsIGJvb2wgKnRhcmdldCk7Citib29sIGxvZ2ljdmNfb2Zfbm9kZV9pc19sYXllcihz
dHJ1Y3QgZGV2aWNlX25vZGUgKm9mX25vZGUpOworCisjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfcmVncy5oIGIvZHJpdmVycy9ncHUvZHJtL2xvZ2lj
dmMvbG9naWN2Y19yZWdzLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAw
Li5kMGJlNWZlODQ4NTYKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2
Yy9sb2dpY3ZjX3JlZ3MuaApAQCAtMCwwICsxLDg4IEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRp
ZmllcjogR1BMLTIuMCsgKi8KKy8qCisgKiBDb3B5cmlnaHQgKEMpIDIwMTkgQm9vdGxpbgorICog
QXV0aG9yOiBQYXVsIEtvY2lhbGtvd3NraSA8cGF1bC5rb2NpYWxrb3dza2lAYm9vdGxpbi5jb20+
CisgKgorICogQ29weXJpZ2h0IChDKSAyMDE0IFh5bG9uIGQuby5vLgorICogQXV0aG9yOiBEYXZv
ciBKb2phIDxkYXZvci5qb2phQGxvZ2ljYnJpY2tzLmNvbT4KKyAqLworCisjaWZuZGVmIF9MT0dJ
Q1ZDX1JFR1NfSF8KKyNkZWZpbmUgX0xPR0lDVkNfUkVHU19IXworCisjZGVmaW5lIExPR0lDVkNf
RklFTERfR0VUKGZpZWxkLCB2YWx1ZSkgXAorCSgoKHZhbHVlKSAmIGZpZWxkIyNfTUFTSykgPj4g
ZmllbGQjI19TSElGVCkKKyNkZWZpbmUgTE9HSUNWQ19GSUVMRF9TRVQoZmllbGQsIHZhbHVlKSBc
CisJKCgodmFsdWUpIDw8IGZpZWxkIyNfU0hJRlQpICYgZmllbGQjI19NQVNLKQorCisjZGVmaW5l
IExPR0lDVkNfRElNRU5TSU9OU19NQVgJCShCSVQoMTYpIC0gMSkKKworI2RlZmluZSBMT0dJQ1ZD
X0hTWU5DX0ZST05UX1BPUkNIX1JFRwkweDAwCisjZGVmaW5lIExPR0lDVkNfSFNZTkNfUkVHCQkw
eDA4CisjZGVmaW5lIExPR0lDVkNfSFNZTkNfQkFDS19QT1JDSF9SRUcJMHgxMAorI2RlZmluZSBM
T0dJQ1ZDX0hSRVNfUkVHCQkweDE4CisjZGVmaW5lIExPR0lDVkNfVlNZTkNfRlJPTlRfUE9SQ0hf
UkVHCTB4MjAKKyNkZWZpbmUgTE9HSUNWQ19WU1lOQ19SRUcJCTB4MjgKKyNkZWZpbmUgTE9HSUNW
Q19WU1lOQ19CQUNLX1BPUkNIX1JFRwkweDMwCisjZGVmaW5lIExPR0lDVkNfVlJFU19SRUcJCTB4
MzgKKworI2RlZmluZSBMT0dJQ1ZDX0NUUkxfUkVHCQkweDQwCisjZGVmaW5lIExPR0lDVkNfQ1RS
TF9DTE9DS19JTlZFUlQJQklUKDgpCisjZGVmaW5lIExPR0lDVkNfQ1RSTF9QSVhFTF9JTlZFUlQJ
QklUKDcpCisjZGVmaW5lIExPR0lDVkNfQ1RSTF9ERV9JTlZFUlQJCUJJVCg1KQorI2RlZmluZSBM
T0dJQ1ZDX0NUUkxfREVfRU5BQkxFCQlCSVQoNCkKKyNkZWZpbmUgTE9HSUNWQ19DVFJMX1ZTWU5D
X0lOVkVSVAlCSVQoMykKKyNkZWZpbmUgTE9HSUNWQ19DVFJMX1ZTWU5DX0VOQUJMRQlCSVQoMikK
KyNkZWZpbmUgTE9HSUNWQ19DVFJMX0hTWU5DX0lOVkVSVAlCSVQoMSkKKyNkZWZpbmUgTE9HSUNW
Q19DVFJMX0hTWU5DX0VOQUJMRQlCSVQoMCkKKworI2RlZmluZSBMT0dJQ1ZDX0RUWVBFX1JFRwkJ
MHg0OAorI2RlZmluZSBMT0dJQ1ZDX0JBQ0tHUk9VTkRfQ09MT1JfUkVHCTB4NTAKKworI2RlZmlu
ZSBMT0dJQ1ZDX0JVRkZFUl9TRUxfUkVHCQkweDU4CisjZGVmaW5lIExPR0lDVkNfQlVGRkVSX1NF
TF9WQUxVRShpLCB2KSBcCisJKEJJVCgxMCArIChpKSkgfCAoKHYpIDw8ICgyICogKGkpKSkpCisj
ZGVmaW5lIExPR0lDVkNfQlVGRkVSX1NFTF9NQVgJCTIKKworI2RlZmluZSBMT0dJQ1ZDX0RPVUJM
RV9DTFVUX1JFRwkJMHg2MAorCisjZGVmaW5lIExPR0lDVkNfSU5UX1NUQVRfUkVHCQkweDY4Cisj
ZGVmaW5lIExPR0lDVkNfSU5UX1NUQVRfVl9TWU5DCQlCSVQoNSkKKworI2RlZmluZSBMT0dJQ1ZD
X0lOVF9NQVNLX1JFRwkJMHg3MAorI2RlZmluZSBMT0dJQ1ZDX0lOVF9NQVNLX1ZfU1lOQwkJQklU
KDUpCisKKyNkZWZpbmUgTE9HSUNWQ19QT1dFUl9DVFJMX1JFRwkJMHg3OAorI2RlZmluZSBMT0dJ
Q1ZDX1BPV0VSX0NUUkxfQkFDS0xJR0hUX0VOQUJMRQlCSVQoMCkKKyNkZWZpbmUgTE9HSUNWQ19Q
T1dFUl9DVFJMX1ZERF9FTkFCTEUJCUJJVCgxKQorI2RlZmluZSBMT0dJQ1ZDX1BPV0VSX0NUUkxf
VkVFX0VOQUJMRQkJQklUKDIpCisjZGVmaW5lIExPR0lDVkNfUE9XRVJfQ1RSTF9WSURFT19FTkFC
TEUJCUJJVCgzKQorCisjZGVmaW5lIExPR0lDVkNfSVBfVkVSU0lPTl9SRUcJCTB4ZjgKKyNkZWZp
bmUgTE9HSUNWQ19JUF9WRVJTSU9OX01BSk9SX01BU0sJR0VOTUFTSygxNiwgMTEpCisjZGVmaW5l
IExPR0lDVkNfSVBfVkVSU0lPTl9NQUpPUl9TSElGVAkxMQorI2RlZmluZSBMT0dJQ1ZDX0lQX1ZF
UlNJT05fTUlOT1JfTUFTSwlHRU5NQVNLKDEwLCA1KQorI2RlZmluZSBMT0dJQ1ZDX0lQX1ZFUlNJ
T05fTUlOT1JfU0hJRlQJNQorI2RlZmluZSBMT0dJQ1ZDX0lQX1ZFUlNJT05fTEVWRUxfTUFTSwlH
RU5NQVNLKDQsIDApCisjZGVmaW5lIExPR0lDVkNfSVBfVkVSU0lPTl9MRVZFTF9TSElGVAkwCisK
KyNkZWZpbmUgTE9HSUNWQ19MQVlFUl9BRERSRVNTX1JFRyhpKQkoMHgxMDAgKyAoaSkgKiAweDgw
KQorI2RlZmluZSBMT0dJQ1ZDX0xBWUVSX0hPRkZTRVRfUkVHKGkpCSgweDEwMCArIChpKSAqIDB4
ODApCisKKyNkZWZpbmUgTE9HSUNWQ19MQVlFUl9WT0ZGU0VUX1JFRyhpKQkoMHgxMDggKyAoaSkg
KiAweDgwKQorI2RlZmluZSBMT0dJQ1ZDX0xBWUVSX1ZPRkZTRVRfTUFYCTQwOTUKKworI2RlZmlu
ZSBMT0dJQ1ZDX0xBWUVSX0hQT1NJVElPTl9SRUcoaSkJKDB4MTEwICsgKGkpICogMHg4MCkKKyNk
ZWZpbmUgTE9HSUNWQ19MQVlFUl9WUE9TSVRJT05fUkVHKGkpCSgweDExOCArIChpKSAqIDB4ODAp
CisjZGVmaW5lIExPR0lDVkNfTEFZRVJfV0lEVEhfUkVHKGkpCSgweDEyMCArIChpKSAqIDB4ODAp
CisjZGVmaW5lIExPR0lDVkNfTEFZRVJfSEVJR0hUX1JFRyhpKQkoMHgxMjggKyAoaSkgKiAweDgw
KQorI2RlZmluZSBMT0dJQ1ZDX0xBWUVSX0FMUEhBX1JFRyhpKQkoMHgxMzAgKyAoaSkgKiAweDgw
KQorCisjZGVmaW5lIExPR0lDVkNfTEFZRVJfQ1RSTF9SRUcoaSkJKDB4MTM4ICsgKGkpICogMHg4
MCkKKyNkZWZpbmUgTE9HSUNWQ19MQVlFUl9DVFJMX0VOQUJMRQlCSVQoMCkKKyNkZWZpbmUgTE9H
SUNWQ19MQVlFUl9DVFJMX0NPTE9SX0tFWV9ESVNBQkxFCUJJVCgxKQorI2RlZmluZSBMT0dJQ1ZD
X0xBWUVSX0NUUkxfUElYRUxfRk9STUFUX0lOVkVSVAlCSVQoNCkKKworI2RlZmluZSBMT0dJQ1ZD
X0xBWUVSX0NPTE9SX0tFWV9SRUcoaSkJKDB4MTQwICsgKGkpICogMHg4MCkKKworI2VuZGlmCi0t
IAoyLjIzLjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
CmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpo
dHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
