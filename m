Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 538FDF17C1
	for <lists+dri-devel@lfdr.de>; Wed,  6 Nov 2019 14:57:51 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 5DD526E223;
	Wed,  6 Nov 2019 13:57:47 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9559E6E21F;
 Wed,  6 Nov 2019 13:57:45 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19102657-1500050 
 for multiple; Wed, 06 Nov 2019 13:57:41 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v2 2/4] drm/i915/selftests: Replace mock_file hackery with
 drm's true fake
Date: Wed,  6 Nov 2019 13:57:37 +0000
Message-Id: <20191106135739.7583-2-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191106135739.7583-1-chris@chris-wilson.co.uk>
References: <20191106135739.7583-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QXMgZHJtIG5vdyBleHBvcnRzIGEgbWV0aG9kIHRvIGNyZWF0ZSBhbiBhbm9ueW1vdXMgc3RydWN0
IGZpbGUgYXJvdW5kIGEKZHJtX2RldmljZSBmb3IgaW50ZXJuYWwgdXNlLCBtYWtlIHVzZSBvZiBp
dCB0byBhdm9pZCBvdXIgaG9ycmlibGUgaGFja3MuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxz
b24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9L
Y29uZmlnLmRlYnVnICAgICAgICAgICAgfCAgMiArCiAuLi4vZ3B1L2RybS9pOTE1L2dlbS9zZWxm
dGVzdHMvaHVnZV9wYWdlcy5jICAgfCAgMiArLQogLi4uL2RybS9pOTE1L2dlbS9zZWxmdGVzdHMv
aTkxNV9nZW1fY29udGV4dC5jIHwgMTIgKystLS0KIC4uLi9pOTE1L2dlbS9zZWxmdGVzdHMvaTkx
NV9nZW1fb2JqZWN0X2JsdC5jICB8ICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxm
dGVzdF9jb250ZXh0LmMgICAgfCAgNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRl
c3RfaGFuZ2NoZWNrLmMgIHwgIDggKy0tCiAuLi4vZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dv
cmthcm91bmRzLmMgICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5
MTVfZ2VtLmMgICAgIHwgIDQgKy0KIC4uLi9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2Vt
X2V2aWN0LmMgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9n
ZW1fZ3R0LmMgfCAgNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfcmVx
dWVzdC5jIHwgIDIgKy0KIC4uLi9kcm0vaTkxNS9zZWxmdGVzdHMvaW50ZWxfbWVtb3J5X3JlZ2lv
bi5jICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvbW9ja19kcm0uYyAg
ICAgfCA0OSArKystLS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVz
dHMvbW9ja19kcm0uaCAgICAgfCAgOCArKy0KIDE0IGZpbGVzIGNoYW5nZWQsIDM5IGluc2VydGlv
bnMoKyksIDY2IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L0tjb25maWcuZGVidWcgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9LY29uZmlnLmRlYnVnCmluZGV4
IGVmMTIzZWIyOTE2OC4uYmNmNzEwZjY2MTY4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9LY29uZmlnLmRlYnVnCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L0tjb25maWcuZGVi
dWcKQEAgLTM4LDYgKzM4LDcgQEAgY29uZmlnIERSTV9JOTE1X0RFQlVHCiAJc2VsZWN0IERSTV9W
R0VNICMgdXNlZCBieSBpZ3QvcHJpbWVfdmdlbSAoZG1hYnVmIGludGVyb3AgY2hlY2tzKQogCXNl
bGVjdCBEUk1fREVCVUdfTU0gaWYgRFJNPXkKIAlzZWxlY3QgRFJNX0RFQlVHX1NFTEZURVNUCisJ
c2VsZWN0IERSTV9ERUJVR19TRUxGVEVTVF9NT0RVTEUKIAlzZWxlY3QgRE1BQlVGX1NFTEZURVNU
UwogCXNlbGVjdCBTV19TWU5DICMgc2lnbmFsaW5nIHZhbGlkYXRpb24gZnJhbWV3b3JrIChpZ3Qv
c3luY29iaiopCiAJc2VsZWN0IERSTV9JOTE1X1NXX0ZFTkNFX0RFQlVHX09CSkVDVFMKQEAgLTE2
MCw2ICsxNjEsNyBAQCBjb25maWcgRFJNX0k5MTVfU0VMRlRFU1QKIAlib29sICJFbmFibGUgc2Vs
ZnRlc3RzIHVwb24gZHJpdmVyIGxvYWQiCiAJZGVwZW5kcyBvbiBEUk1fSTkxNQogCWRlZmF1bHQg
bgorCXNlbGVjdCBEUk1fREVCVUdfU0VMRlRFU1RfTU9EVUxFCiAJc2VsZWN0IEZBVUxUX0lOSkVD
VElPTgogCXNlbGVjdCBQUklNRV9OVU1CRVJTCiAJaGVscApkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vc2VsZnRlc3RzL2h1Z2VfcGFnZXMuYwppbmRleCA2ODhjNDlhMjRmMzIuLjA2ZGFk
N2IwZGI4MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9o
dWdlX3BhZ2VzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdl
X3BhZ2VzLmMKQEAgLTE5NDQsNiArMTk0NCw2IEBAIGludCBpOTE1X2dlbV9odWdlX3BhZ2VfbGl2
ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJZXJyID0gaTkxNV9z
dWJ0ZXN0cyh0ZXN0cywgY3R4KTsKIAogb3V0X2ZpbGU6Ci0JbW9ja19maWxlX2ZyZWUoaTkxNSwg
ZmlsZSk7CisJbW9ja19maWxlX3B1dChmaWxlKTsKIAlyZXR1cm4gZXJyOwogfQpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYwpp
bmRleCA2MmZhYmMwMjNhODMuLjQ3ODkwYzkyNTM0YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMKQEAgLTE0OSw3ICsx
NDksNyBAQCBzdGF0aWMgaW50IGxpdmVfbm9wX3N3aXRjaCh2b2lkICphcmcpCiAJfQogCiBvdXRf
ZmlsZToKLQltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKKwltb2NrX2ZpbGVfcHV0KGZpbGUp
OwogCXJldHVybiBlcnI7CiB9CiAKQEAgLTM3Nyw3ICszNzcsNyBAQCBzdGF0aWMgaW50IGxpdmVf
cGFyYWxsZWxfc3dpdGNoKHZvaWQgKmFyZykKIAl9CiAJa2ZyZWUoZGF0YSk7CiBvdXRfZmlsZToK
LQltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKKwltb2NrX2ZpbGVfcHV0KGZpbGUpOwogCXJl
dHVybiBlcnI7CiB9CiAKQEAgLTcxNiw3ICs3MTYsNyBAQCBzdGF0aWMgaW50IGlndF9jdHhfZXhl
Yyh2b2lkICphcmcpCiAJCWlmIChpZ3RfbGl2ZV90ZXN0X2VuZCgmdCkpCiAJCQllcnIgPSAtRUlP
OwogCi0JCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUpOworCQltb2NrX2ZpbGVfcHV0KGZpbGUp
OwogCQlpZiAoZXJyKQogCQkJcmV0dXJuIGVycjsKIApAQCAtODU0LDcgKzg1NCw3IEBAIHN0YXRp
YyBpbnQgaWd0X3NoYXJlZF9jdHhfZXhlYyh2b2lkICphcmcpCiAJaWYgKGlndF9saXZlX3Rlc3Rf
ZW5kKCZ0KSkKIAkJZXJyID0gLUVJTzsKIG91dF9maWxlOgotCW1vY2tfZmlsZV9mcmVlKGk5MTUs
IGZpbGUpOworCW1vY2tfZmlsZV9wdXQoZmlsZSk7CiAJcmV0dXJuIGVycjsKIH0KIApAQCAtMTQy
Niw3ICsxNDI2LDcgQEAgc3RhdGljIGludCBpZ3RfY3R4X3JlYWRvbmx5KHZvaWQgKmFyZykKIAlp
ZiAoaWd0X2xpdmVfdGVzdF9lbmQoJnQpKQogCQllcnIgPSAtRUlPOwogCi0JbW9ja19maWxlX2Zy
ZWUoaTkxNSwgZmlsZSk7CisJbW9ja19maWxlX3B1dChmaWxlKTsKIAlyZXR1cm4gZXJyOwogfQog
CkBAIC0xNzUwLDcgKzE3NTAsNyBAQCBzdGF0aWMgaW50IGlndF92bV9pc29sYXRpb24odm9pZCAq
YXJnKQogb3V0X2ZpbGU6CiAJaWYgKGlndF9saXZlX3Rlc3RfZW5kKCZ0KSkKIAkJZXJyID0gLUVJ
TzsKLQltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKKwltb2NrX2ZpbGVfcHV0KGZpbGUpOwog
CXJldHVybiBlcnI7CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9z
ZWxmdGVzdHMvaTkxNV9nZW1fb2JqZWN0X2JsdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L3NlbGZ0ZXN0cy9pOTE1X2dlbV9vYmplY3RfYmx0LmMKaW5kZXggZTgxMzJhY2EwYmI2Li5kOWZk
ZmRkYjcwOTEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMv
aTkxNV9nZW1fb2JqZWN0X2JsdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxm
dGVzdHMvaTkxNV9nZW1fb2JqZWN0X2JsdC5jCkBAIC0zMDEsNyArMzAxLDcgQEAgc3RhdGljIGlu
dCBpZ3RfZmlsbF9ibHRfdGhyZWFkKHZvaWQgKmFyZykKIAogCWludGVsX2NvbnRleHRfcHV0KGNl
KTsKIG91dF9maWxlOgotCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUpOworCW1vY2tfZmlsZV9w
dXQoZmlsZSk7CiAJcmV0dXJuIGVycjsKIH0KIApAQCAtNDMyLDcgKzQzMiw3IEBAIHN0YXRpYyBp
bnQgaWd0X2NvcHlfYmx0X3RocmVhZCh2b2lkICphcmcpCiAKIAlpbnRlbF9jb250ZXh0X3B1dChj
ZSk7CiBvdXRfZmlsZToKLQltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKKwltb2NrX2ZpbGVf
cHV0KGZpbGUpOwogCXJldHVybiBlcnI7CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3NlbGZ0ZXN0X2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3Nl
bGZ0ZXN0X2NvbnRleHQuYwppbmRleCBiYzcyMGRlZmM2YjguLmE1Njg4ZjdkOTA3MyAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfY29udGV4dC5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2NvbnRleHQuYwpAQCAtMzEzLDcgKzMxMyw3
IEBAIHN0YXRpYyBpbnQgbGl2ZV9hY3RpdmVfY29udGV4dCh2b2lkICphcmcpCiAJfQogCiBvdXRf
ZmlsZToKLQltb2NrX2ZpbGVfZnJlZShndC0+aTkxNSwgZmlsZSk7CisJbW9ja19maWxlX3B1dChm
aWxlKTsKIAlyZXR1cm4gZXJyOwogfQogCkBAIC00MjMsNyArNDIzLDcgQEAgc3RhdGljIGludCBs
aXZlX3JlbW90ZV9jb250ZXh0KHZvaWQgKmFyZykKIAl9CiAKIG91dF9maWxlOgotCW1vY2tfZmls
ZV9mcmVlKGd0LT5pOTE1LCBmaWxlKTsKKwltb2NrX2ZpbGVfcHV0KGZpbGUpOwogCXJldHVybiBl
cnI7CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hh
bmdjaGVjay5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNrLmMK
aW5kZXggODVlOWNjZjVjMzA0Li5jZGFhZWU0NDMyYjIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jCkBAIC00MzksNyArNDM5LDcgQEAgc3RhdGljIGlu
dCBpZ3RfcmVzZXRfbm9wKHZvaWQgKmFyZykKIAogCWVyciA9IGlndF9mbHVzaF90ZXN0KGd0LT5p
OTE1KTsKIG91dDoKLQltb2NrX2ZpbGVfZnJlZShndC0+aTkxNSwgZmlsZSk7CisJbW9ja19maWxl
X3B1dChmaWxlKTsKIAlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKGd0KSkKIAkJZXJyID0gLUVJTzsK
IAlyZXR1cm4gZXJyOwpAQCAtNTM1LDcgKzUzNSw3IEBAIHN0YXRpYyBpbnQgaWd0X3Jlc2V0X25v
cF9lbmdpbmUodm9pZCAqYXJnKQogCiAJZXJyID0gaWd0X2ZsdXNoX3Rlc3QoZ3QtPmk5MTUpOwog
b3V0OgotCW1vY2tfZmlsZV9mcmVlKGd0LT5pOTE1LCBmaWxlKTsKKwltb2NrX2ZpbGVfcHV0KGZp
bGUpOwogCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoZ3QpKQogCQllcnIgPSAtRUlPOwogCXJldHVy
biBlcnI7CkBAIC03NTIsNyArNzUyLDcgQEAgc3RhdGljIGludCBhY3RpdmVfZW5naW5lKHZvaWQg
KmRhdGEpCiAJfQogCiBlcnJfZmlsZToKLQltb2NrX2ZpbGVfZnJlZShlbmdpbmUtPmk5MTUsIGZp
bGUpOworCW1vY2tfZmlsZV9wdXQoZmlsZSk7CiAJcmV0dXJuIGVycjsKIH0KIApAQCAtMTMyNSw3
ICsxMzI1LDcgQEAgc3RhdGljIGludCBpZ3RfcmVzZXRfZXZpY3RfcHBndHQodm9pZCAqYXJnKQog
CWk5MTVfdm1fcHV0KHZtKTsKIAogb3V0OgotCW1vY2tfZmlsZV9mcmVlKGd0LT5pOTE1LCBmaWxl
KTsKKwltb2NrX2ZpbGVfcHV0KGZpbGUpOwogCXJldHVybiBlcnI7CiB9CiAKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF93b3JrYXJvdW5kcy5jCmluZGV4IGFiY2U2ZTRlYzlj
MC4uNWM2OWVjNWM1ZWY5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxm
dGVzdF93b3JrYXJvdW5kcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0
X3dvcmthcm91bmRzLmMKQEAgLTczOSw3ICs3MzksNyBAQCBzdGF0aWMgaW50IGxpdmVfZGlydHlf
d2hpdGVsaXN0KHZvaWQgKmFyZykKIAl9CiAKIG91dF9maWxlOgotCW1vY2tfZmlsZV9mcmVlKGd0
LT5pOTE1LCBmaWxlKTsKKwltb2NrX2ZpbGVfcHV0KGZpbGUpOwogCXJldHVybiBlcnI7CiB9CiAK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbS5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtLmMKaW5kZXggZDgzZjZiZjZk
OWQ0Li5hYTYyODJhZGZkMDkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0
ZXN0cy9pOTE1X2dlbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1
X2dlbS5jCkBAIC0xNjMsNyArMTYzLDcgQEAgc3RhdGljIGludCBpZ3RfZ2VtX3N1c3BlbmQodm9p
ZCAqYXJnKQogCiAJZXJyID0gc3dpdGNoX3RvX2NvbnRleHQoY3R4KTsKIG91dDoKLQltb2NrX2Zp
bGVfZnJlZShpOTE1LCBmaWxlKTsKKwltb2NrX2ZpbGVfcHV0KGZpbGUpOwogCXJldHVybiBlcnI7
CiB9CiAKQEAgLTE5OCw3ICsxOTgsNyBAQCBzdGF0aWMgaW50IGlndF9nZW1faGliZXJuYXRlKHZv
aWQgKmFyZykKIAogCWVyciA9IHN3aXRjaF90b19jb250ZXh0KGN0eCk7CiBvdXQ6Ci0JbW9ja19m
aWxlX2ZyZWUoaTkxNSwgZmlsZSk7CisJbW9ja19maWxlX3B1dChmaWxlKTsKIAlyZXR1cm4gZXJy
OwogfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9n
ZW1fZXZpY3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ldmlj
dC5jCmluZGV4IDQyZTk0ODE0NGYxYi4uNDEwOTJkY2VhNWIxIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZXZpY3QuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZXZpY3QuYwpAQCAtNTE1LDcgKzUxNSw3IEBA
IHN0YXRpYyBpbnQgaWd0X2V2aWN0X2NvbnRleHRzKHZvaWQgKmFyZykKIAkJcHJfaW5mbygiU3Vi
bWl0dGVkICVsdSBjb250ZXh0cy9yZXF1ZXN0cyBvbiAlc1xuIiwKIAkJCWNvdW50LCBlbmdpbmUt
Pm5hbWUpOwogCi0JCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUpOworCQltb2NrX2ZpbGVfcHV0
KGZpbGUpOwogCQlpZiAoZXJyKQogCQkJYnJlYWs7CiAJfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jCmluZGV4IDNmN2U4MGZiM2JiZC4uYzNlMGQ2M2M0
ZDBjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1f
Z3R0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5j
CkBAIC0xMDI2LDcgKzEwMjYsNyBAQCBzdGF0aWMgaW50IGV4ZXJjaXNlX3BwZ3R0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAlpOTE1X3ZtX3B1dCgmcHBndHQtPnZtKTsKIAog
b3V0X2ZyZWU6Ci0JbW9ja19maWxlX2ZyZWUoZGV2X3ByaXYsIGZpbGUpOworCW1vY2tfZmlsZV9w
dXQoZmlsZSk7CiAJcmV0dXJuIGVycjsKIH0KIApAQCAtMjAyMiw3ICsyMDIyLDcgQEAgc3RhdGlj
IGludCBpZ3RfY3NfdGxiKHZvaWQgKmFyZykKIG91dF92bToKIAlpOTE1X3ZtX3B1dCh2bSk7CiBv
dXRfdW5sb2NrOgotCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUpOworCW1vY2tfZmlsZV9wdXQo
ZmlsZSk7CiAJcmV0dXJuIGVycjsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvc2VsZnRlc3RzL2k5MTVfcmVxdWVzdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRl
c3RzL2k5MTVfcmVxdWVzdC5jCmluZGV4IDllNmQzMTU5Y2Q4MC4uN2M1NmVlMzhjYzViIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9yZXF1ZXN0LmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfcmVxdWVzdC5jCkBAIC0xNDMw
LDcgKzE0MzAsNyBAQCBzdGF0aWMgaW50IGxpdmVfYnJlYWRjcnVtYnNfc21va2V0ZXN0KHZvaWQg
KmFyZykKIG91dF9zbW9rZToKIAlrZnJlZShzbW9rZSk7CiBvdXRfZmlsZToKLQltb2NrX2ZpbGVf
ZnJlZShpOTE1LCBmaWxlKTsKKwltb2NrX2ZpbGVfcHV0KGZpbGUpOwogb3V0X3JwbToKIAlpbnRl
bF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pbnRlbF9tZW1vcnlfcmVnaW9uLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaW50ZWxfbWVtb3J5X3JlZ2lvbi5jCmlu
ZGV4IDE5ZTFjY2E4ZjE0My4uZmEyODNjZTQ1MzJhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9zZWxmdGVzdHMvaW50ZWxfbWVtb3J5X3JlZ2lvbi5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L3NlbGZ0ZXN0cy9pbnRlbF9tZW1vcnlfcmVnaW9uLmMKQEAgLTQzOSw3ICs0Mzks
NyBAQCBzdGF0aWMgaW50IGlndF9sbWVtX3dyaXRlX2dwdSh2b2lkICphcmcpCiBvdXRfcHV0Ogog
CWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKIG91dF9maWxlOgotCW1vY2tfZmlsZV9mcmVlKGk5
MTUsIGZpbGUpOworCW1vY2tfZmlsZV9wdXQoZmlsZSk7CiAJcmV0dXJuIGVycjsKIH0KIApkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZHJtLmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvbW9ja19kcm0uYwppbmRleCAwOWM3MDQxNTM0NTYu
LmMxMDBjM2VmZTIzOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3Rz
L21vY2tfZHJtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZHJt
LmMKQEAgLTIyLDUyICsyMiwxNyBAQAogICoKICAqLwogCisjaW5jbHVkZSA8ZHJtL2RybV9maWxl
Lmg+CisKICNpbmNsdWRlICJtb2NrX2RybS5oIgogCiBzdHJ1Y3QgZHJtX2ZpbGUgKm1vY2tfZmls
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIHsKLQlzdHJ1Y3QgZmlsZSAqZmlscDsK
LQlzdHJ1Y3QgaW5vZGUgKmlub2RlOwotCXN0cnVjdCBkcm1fZmlsZSAqZmlsZTsKLQlpbnQgZXJy
OwotCi0JaW5vZGUgPSBremFsbG9jKHNpemVvZigqaW5vZGUpLCBHRlBfS0VSTkVMKTsKLQlpZiAo
IWlub2RlKSB7Ci0JCWVyciA9IC1FTk9NRU07Ci0JCWdvdG8gZXJyOwotCX0KLQotCWlub2RlLT5p
X3JkZXYgPSBpOTE1LT5kcm0ucHJpbWFyeS0+aW5kZXg7Ci0KLQlmaWxwID0ga3phbGxvYyhzaXpl
b2YoKmZpbHApLCBHRlBfS0VSTkVMKTsKLQlpZiAoIWZpbHApIHsKLQkJZXJyID0gLUVOT01FTTsK
LQkJZ290byBlcnJfaW5vZGU7Ci0JfQotCi0JZXJyID0gZHJtX29wZW4oaW5vZGUsIGZpbHApOwot
CWlmIChlcnIpCi0JCWdvdG8gZXJyX2ZpbHA7CisJc3RydWN0IGZpbGUgKmZpbGU7CiAKLQlmaWxl
ID0gZmlscC0+cHJpdmF0ZV9kYXRhOwotCW1lbXNldCgmZmlsZS0+ZmlscCwgUE9JU09OX0lOVVNF
LCBzaXplb2YoZmlsZS0+ZmlscCkpOwotCWZpbGUtPmF1dGhlbnRpY2F0ZWQgPSB0cnVlOwotCi0J
a2ZyZWUoZmlscCk7Ci0Ja2ZyZWUoaW5vZGUpOwotCXJldHVybiBmaWxlOwotCi1lcnJfZmlscDoK
LQlrZnJlZShmaWxwKTsKLWVycl9pbm9kZToKLQlrZnJlZShpbm9kZSk7Ci1lcnI6Ci0JcmV0dXJu
IEVSUl9QVFIoZXJyKTsKLX0KLQotdm9pZCBtb2NrX2ZpbGVfZnJlZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwgc3RydWN0IGRybV9maWxlICpmaWxlKQotewotCXN0cnVjdCBmaWxlIGZp
bHAgPSB7IC5wcml2YXRlX2RhdGEgPSBmaWxlIH07CisJZmlsZSA9IG1vY2tfZHJtX2dldGZpbGUo
aTkxNS0+ZHJtLnByaW1hcnksIE9fUkRXUik7CisJaWYgKElTX0VSUihmaWxlKSkKKwkJcmV0dXJu
IEVSUl9DQVNUKGZpbGUpOwogCi0JZHJtX3JlbGVhc2UoTlVMTCwgJmZpbHApOworCXJldHVybiBm
aWxlLT5wcml2YXRlX2RhdGE7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9z
ZWxmdGVzdHMvbW9ja19kcm0uaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2Nr
X2RybS5oCmluZGV4IGIzOWJlZWU5ZjhmNi4uZGM0MTkwYmQzZjVhIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvbW9ja19kcm0uaAorKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9zZWxmdGVzdHMvbW9ja19kcm0uaApAQCAtMjUsNyArMjUsMTMgQEAKICNpZm5kZWYg
X19NT0NLX0RSTV9ICiAjZGVmaW5lIF9fTU9DS19EUk1fSAogCitzdHJ1Y3QgZHJtX2ZpbGU7Citz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKKwogc3RydWN0IGRybV9maWxlICptb2NrX2ZpbGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwotdm9pZCBtb2NrX2ZpbGVfZnJlZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgc3RydWN0IGRybV9maWxlICpmaWxlKTsKK3N0YXRpYyBp
bmxpbmUgdm9pZCBtb2NrX2ZpbGVfcHV0KHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkKK3sKKwlmcHV0
KGZpbGUtPmZpbHApOworfQogCiAjZW5kaWYgLyogIV9fTU9DS19EUk1fSCAqLwotLSAKMi4yNC4w
CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2
ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9s
aXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
