Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 353024B2C6
	for <lists+dri-devel@lfdr.de>; Wed, 19 Jun 2019 09:11:37 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 71D4C6E2CF;
	Wed, 19 Jun 2019 07:11:24 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from inva020.nxp.com (inva020.nxp.com [92.121.34.13])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 121D56E17D
 for <dri-devel@lists.freedesktop.org>; Tue, 18 Jun 2019 13:30:49 +0000 (UTC)
Received: from inva020.nxp.com (localhost [127.0.0.1])
 by inva020.eu-rdc02.nxp.com (Postfix) with ESMTP id B1FE91A03B6;
 Tue, 18 Jun 2019 15:30:47 +0200 (CEST)
Received: from inva024.eu-rdc02.nxp.com (inva024.eu-rdc02.nxp.com
 [134.27.226.22])
 by inva020.eu-rdc02.nxp.com (Postfix) with ESMTP id A37301A03AB;
 Tue, 18 Jun 2019 15:30:47 +0200 (CEST)
Received: from fsr-ub1664-046.ea.freescale.net
 (fsr-ub1664-046.ea.freescale.net [10.171.96.34])
 by inva024.eu-rdc02.nxp.com (Postfix) with ESMTP id 85DDD20631;
 Tue, 18 Jun 2019 15:30:47 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
 by fsr-ub1664-046.ea.freescale.net (Postfix) with ESMTP id 5CFF54D1D;
 Tue, 18 Jun 2019 16:30:47 +0300 (EEST)
Received: from fsr-ub1664-046.ea.freescale.net ([127.0.0.1])
 by localhost (fsr-ub1664-046.ea.freescale.net [127.0.0.1]) (amavisd-new,
 port 10032)
 with ESMTP id 57jbAdtn7PdT; Tue, 18 Jun 2019 16:30:46 +0300 (EEST)
Received: from localhost (localhost [127.0.0.1])
 by fsr-ub1664-046.ea.freescale.net (Postfix) with ESMTP id A50A555B4;
 Tue, 18 Jun 2019 16:30:46 +0300 (EEST)
X-Virus-Scanned: amavisd-new at ea.freescale.net
Received: from fsr-ub1664-046.ea.freescale.net ([127.0.0.1])
 by localhost (fsr-ub1664-046.ea.freescale.net [127.0.0.1]) (amavisd-new,
 port 10026)
 with ESMTP id P8RW8U4MygpO; Tue, 18 Jun 2019 16:30:46 +0300 (EEST)
Received: from fsr-ub1664-120.ea.freescale.net
 (fsr-ub1664-120.ea.freescale.net [10.171.82.81])
 by fsr-ub1664-046.ea.freescale.net (Postfix) with ESMTP id 6F4A055B2;
 Tue, 18 Jun 2019 16:30:46 +0300 (EEST)
From: Robert Chiras <robert.chiras@nxp.com>
To: Thierry Reding <thierry.reding@gmail.com>, Sam Ravnborg <sam@ravnborg.org>,
 David Airlie <airlied@linux.ie>, Daniel Vetter <daniel@ffwll.ch>,
 Rob Herring <robh+dt@kernel.org>, Mark Rutland <mark.rutland@arm.com>
Subject: [PATCH v2 2/2] drm/panel: Add support for Raydium RM67191 panel driver
Date: Tue, 18 Jun 2019 16:30:46 +0300
Message-Id: <1560864646-1468-3-git-send-email-robert.chiras@nxp.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1560864646-1468-1-git-send-email-robert.chiras@nxp.com>
References: <1560864646-1468-1-git-send-email-robert.chiras@nxp.com>
MIME-Version: 1.0
X-Virus-Scanned: ClamAV using ClamSMTP
X-Mailman-Approved-At: Wed, 19 Jun 2019 07:10:14 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Robert Chiras <robert.chiras@nxp.com>, devicetree@vger.kernel.org,
 linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org,
 linux-imx@nxp.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBwYXRjaCBhZGRzIFJheWRpdW0gUk02NzE5MSBURlQgTENEIHBhbmVsIGRyaXZlciAoTUlQ
SS1EU0kKcHJvdG9jb2wpLgoKU2lnbmVkLW9mZi1ieTogUm9iZXJ0IENoaXJhcyA8cm9iZXJ0LmNo
aXJhc0BueHAuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9wYW5lbC9LY29uZmlnICAgICAgICAg
ICAgICAgICB8ICAgOSArCiBkcml2ZXJzL2dwdS9kcm0vcGFuZWwvTWFrZWZpbGUgICAgICAgICAg
ICAgICAgfCAgIDEgKwogZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLXJheWRpdW0tcm02NzE5
MS5jIHwgNzA5ICsrKysrKysrKysrKysrKysrKysrKysrKysrCiAzIGZpbGVzIGNoYW5nZWQsIDcx
OSBpbnNlcnRpb25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL3BhbmVs
L3BhbmVsLXJheWRpdW0tcm02NzE5MS5jCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Bh
bmVsL0tjb25maWcgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvS2NvbmZpZwppbmRleCBkOWQ5MzFh
Li44YmUxYWMxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvS2NvbmZpZworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvS2NvbmZpZwpAQCAtMTU5LDYgKzE1OSwxNSBAQCBjb25m
aWcgRFJNX1BBTkVMX1JBU1BCRVJSWVBJX1RPVUNIU0NSRUVOCiAJICBQaSA3IiBUb3VjaHNjcmVl
bi4gIFRvIGNvbXBpbGUgdGhpcyBkcml2ZXIgYXMgYSBtb2R1bGUsCiAJICBjaG9vc2UgTSBoZXJl
LgogCitjb25maWcgRFJNX1BBTkVMX1JBWURJVU1fUk02NzE5MQorCXRyaXN0YXRlICJSYXlkaXVt
IFJNNjcxOTEgRkhEIDEwODB4MTkyMCBEU0kgdmlkZW8gbW9kZSBwYW5lbCIKKwlkZXBlbmRzIG9u
IE9GCisJZGVwZW5kcyBvbiBEUk1fTUlQSV9EU0kKKwlkZXBlbmRzIG9uIEJBQ0tMSUdIVF9DTEFT
U19ERVZJQ0UKKwloZWxwCisJICBTYXkgWSBoZXJlIGlmIHlvdSB3YW50IHRvIGVuYWJsZSBzdXBw
b3J0IGZvciBSYXlkaXVtIFJNNjcxOTEgRkhECisJICAoMTA4MHgxOTIwKSBEU0kgcGFuZWwuCisK
IGNvbmZpZyBEUk1fUEFORUxfUkFZRElVTV9STTY4MjAwCiAJdHJpc3RhdGUgIlJheWRpdW0gUk02
ODIwMCA3MjB4MTI4MCBEU0kgdmlkZW8gbW9kZSBwYW5lbCIKIAlkZXBlbmRzIG9uIE9GCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0v
cGFuZWwvTWFrZWZpbGUKaW5kZXggZmIwY2IzYS4uMWZjMGY2OCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL3BhbmVsL01ha2VmaWxlCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9NYWtl
ZmlsZQpAQCAtMTQsNiArMTQsNyBAQCBvYmotJChDT05GSUdfRFJNX1BBTkVMX09SSVNFVEVDSF9P
VE04MDA5QSkgKz0gcGFuZWwtb3Jpc2V0ZWNoLW90bTgwMDlhLm8KIG9iai0kKENPTkZJR19EUk1f
UEFORUxfT1NEX09TRDEwMVQyNTg3XzUzVFMpICs9IHBhbmVsLW9zZC1vc2QxMDF0MjU4Ny01M3Rz
Lm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfUEFOQVNPTklDX1ZWWDEwRjAzNE4wMCkgKz0gcGFu
ZWwtcGFuYXNvbmljLXZ2eDEwZjAzNG4wMC5vCiBvYmotJChDT05GSUdfRFJNX1BBTkVMX1JBU1BC
RVJSWVBJX1RPVUNIU0NSRUVOKSArPSBwYW5lbC1yYXNwYmVycnlwaS10b3VjaHNjcmVlbi5vCitv
YmotJChDT05GSUdfRFJNX1BBTkVMX1JBWURJVU1fUk02NzE5MSkgKz0gcGFuZWwtcmF5ZGl1bS1y
bTY3MTkxLm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfUkFZRElVTV9STTY4MjAwKSArPSBwYW5l
bC1yYXlkaXVtLXJtNjgyMDAubwogb2JqLSQoQ09ORklHX0RSTV9QQU5FTF9ST0NLVEVDSF9KSDA1
N04wMDkwMCkgKz0gcGFuZWwtcm9ja3RlY2gtamgwNTduMDA5MDAubwogb2JqLSQoQ09ORklHX0RS
TV9QQU5FTF9ST05CT19SQjA3MEQzMCkgKz0gcGFuZWwtcm9uYm8tcmIwNzBkMzAubwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLXJheWRpdW0tcm02NzE5MS5jIGIvZHJp
dmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLXJheWRpdW0tcm02NzE5MS5jCm5ldyBmaWxlIG1vZGUg
MTAwNjQ0CmluZGV4IDAwMDAwMDAuLmMwNzgwYzkKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJz
L2dwdS9kcm0vcGFuZWwvcGFuZWwtcmF5ZGl1bS1ybTY3MTkxLmMKQEAgLTAsMCArMSw3MDkgQEAK
Ky8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisvKgorICogaS5NWCBkcm0gZHJp
dmVyIC0gUmF5ZGl1bSBNSVBJLURTSSBwYW5lbCBkcml2ZXIKKyAqCisgKiBDb3B5cmlnaHQgMjAx
OSBOWFAKKyAqLworCisjaW5jbHVkZSA8bGludXgvYmFja2xpZ2h0Lmg+CisjaW5jbHVkZSA8bGlu
dXgvZGVsYXkuaD4KKyNpbmNsdWRlIDxsaW51eC9ncGlvL2NvbnN1bWVyLmg+CisjaW5jbHVkZSA8
bGludXgvbW9kdWxlLmg+CisjaW5jbHVkZSA8bGludXgvb2YuaD4KKyNpbmNsdWRlIDxsaW51eC9y
ZWd1bGF0b3IvY29uc3VtZXIuaD4KKworI2luY2x1ZGUgPHZpZGVvL21pcGlfZGlzcGxheS5oPgor
I2luY2x1ZGUgPHZpZGVvL29mX3ZpZGVvbW9kZS5oPgorI2luY2x1ZGUgPHZpZGVvL3ZpZGVvbW9k
ZS5oPgorCisjaW5jbHVkZSA8ZHJtL2RybV9jcnRjLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9taXBp
X2RzaS5oPgorI2luY2x1ZGUgPGRybS9kcm1fcGFuZWwuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3By
aW50Lmg+CisKKy8qIFdyaXRlIE1hbnVmYWN0dXJlIENvbW1hbmQgU2V0IENvbnRyb2wgKi8KKyNk
ZWZpbmUgV1JNQVVDQ1RSIDB4RkUKKworI2RlZmluZSBDT0xfRk1UXzE2QlBQIDB4NTUKKyNkZWZp
bmUgQ09MX0ZNVF8xOEJQUCAweDY2CisjZGVmaW5lIENPTF9GTVRfMjRCUFAgMHg3NworCisvKiBN
YW51ZmFjdHVyZXIgQ29tbWFuZCBTZXQgcGFnZXMgKENNRDIpICovCitzdHJ1Y3QgY21kX3NldF9l
bnRyeSB7CisJdTggY21kOworCXU4IHBhcmFtOworfTsKKworLyoKKyAqIFRoZXJlIGlzIG5vIGRl
c2NyaXB0aW9uIGluIHRoZSBSZWZlcmVuY2UgTWFudWFsIGFib3V0IHRoZXNlIGNvbW1hbmRzLgor
ICogV2UgcmVjZWl2ZWQgdGhlbSBmcm9tIHZlbmRvciwgc28ganVzdCB1c2UgdGhlbSBhcyBpcy4K
KyAqLworc3RhdGljIGNvbnN0IHN0cnVjdCBjbWRfc2V0X2VudHJ5IG1hbnVmYWN0dXJlcl9jbWRf
c2V0W10gPSB7CisJezB4RkUsIDB4MEJ9LAorCXsweDI4LCAweDQwfSwKKwl7MHgyOSwgMHg0Rn0s
CisJezB4RkUsIDB4MEV9LAorCXsweDRCLCAweDAwfSwKKwl7MHg0QywgMHgwRn0sCisJezB4NEQs
IDB4MjB9LAorCXsweDRFLCAweDQwfSwKKwl7MHg0RiwgMHg2MH0sCisJezB4NTAsIDB4QTB9LAor
CXsweDUxLCAweEMwfSwKKwl7MHg1MiwgMHhFMH0sCisJezB4NTMsIDB4RkZ9LAorCXsweEZFLCAw
eDBEfSwKKwl7MHgxOCwgMHgwOH0sCisJezB4NDIsIDB4MDB9LAorCXsweDA4LCAweDQxfSwKKwl7
MHg0NiwgMHgwMn0sCisJezB4NzIsIDB4MDl9LAorCXsweEZFLCAweDBBfSwKKwl7MHgyNCwgMHgx
N30sCisJezB4MDQsIDB4MDd9LAorCXsweDFBLCAweDBDfSwKKwl7MHgwRiwgMHg0NH0sCisJezB4
RkUsIDB4MDR9LAorCXsweDAwLCAweDBDfSwKKwl7MHgwNSwgMHgwOH0sCisJezB4MDYsIDB4MDh9
LAorCXsweDA4LCAweDA4fSwKKwl7MHgwOSwgMHgwOH0sCisJezB4MEEsIDB4RTZ9LAorCXsweDBC
LCAweDhDfSwKKwl7MHgxQSwgMHgxMn0sCisJezB4MUUsIDB4RTB9LAorCXsweDI5LCAweDkzfSwK
Kwl7MHgyQSwgMHg5M30sCisJezB4MkYsIDB4MDJ9LAorCXsweDMxLCAweDAyfSwKKwl7MHgzMywg
MHgwNX0sCisJezB4MzcsIDB4MkR9LAorCXsweDM4LCAweDJEfSwKKwl7MHgzQSwgMHgxRX0sCisJ
ezB4M0IsIDB4MUV9LAorCXsweDNELCAweDI3fSwKKwl7MHgzRiwgMHg4MH0sCisJezB4NDAsIDB4
NDB9LAorCXsweDQxLCAweEUwfSwKKwl7MHg0RiwgMHgyRn0sCisJezB4NTAsIDB4MUV9LAorCXsw
eEZFLCAweDA2fSwKKwl7MHgwMCwgMHhDQ30sCisJezB4MDUsIDB4MDV9LAorCXsweDA3LCAweEEy
fSwKKwl7MHgwOCwgMHhDQ30sCisJezB4MEQsIDB4MDN9LAorCXsweDBGLCAweEEyfSwKKwl7MHgz
MiwgMHhDQ30sCisJezB4MzcsIDB4MDV9LAorCXsweDM5LCAweDgzfSwKKwl7MHgzQSwgMHhDQ30s
CisJezB4NDEsIDB4MDR9LAorCXsweDQzLCAweDgzfSwKKwl7MHg0NCwgMHhDQ30sCisJezB4NDks
IDB4MDV9LAorCXsweDRCLCAweEEyfSwKKwl7MHg0QywgMHhDQ30sCisJezB4NTEsIDB4MDN9LAor
CXsweDUzLCAweEEyfSwKKwl7MHg3NSwgMHhDQ30sCisJezB4N0EsIDB4MDN9LAorCXsweDdDLCAw
eDgzfSwKKwl7MHg3RCwgMHhDQ30sCisJezB4ODIsIDB4MDJ9LAorCXsweDg0LCAweDgzfSwKKwl7
MHg4NSwgMHhFQ30sCisJezB4ODYsIDB4MEZ9LAorCXsweDg3LCAweEZGfSwKKwl7MHg4OCwgMHgw
MH0sCisJezB4OEEsIDB4MDJ9LAorCXsweDhDLCAweEEyfSwKKwl7MHg4RCwgMHhFQX0sCisJezB4
OEUsIDB4MDF9LAorCXsweDhGLCAweEU4fSwKKwl7MHhGRSwgMHgwNn0sCisJezB4OTAsIDB4MEF9
LAorCXsweDkyLCAweDA2fSwKKwl7MHg5MywgMHhBMH0sCisJezB4OTQsIDB4QTh9LAorCXsweDk1
LCAweEVDfSwKKwl7MHg5NiwgMHgwRn0sCisJezB4OTcsIDB4RkZ9LAorCXsweDk4LCAweDAwfSwK
Kwl7MHg5QSwgMHgwMn0sCisJezB4OUMsIDB4QTJ9LAorCXsweEFDLCAweDA0fSwKKwl7MHhGRSwg
MHgwNn0sCisJezB4QjEsIDB4MTJ9LAorCXsweEIyLCAweDE3fSwKKwl7MHhCMywgMHgxN30sCisJ
ezB4QjQsIDB4MTd9LAorCXsweEI1LCAweDE3fSwKKwl7MHhCNiwgMHgxMX0sCisJezB4QjcsIDB4
MDh9LAorCXsweEI4LCAweDA5fSwKKwl7MHhCOSwgMHgwNn0sCisJezB4QkEsIDB4MDd9LAorCXsw
eEJCLCAweDE3fSwKKwl7MHhCQywgMHgxN30sCisJezB4QkQsIDB4MTd9LAorCXsweEJFLCAweDE3
fSwKKwl7MHhCRiwgMHgxN30sCisJezB4QzAsIDB4MTd9LAorCXsweEMxLCAweDE3fSwKKwl7MHhD
MiwgMHgxN30sCisJezB4QzMsIDB4MTd9LAorCXsweEM0LCAweDBGfSwKKwl7MHhDNSwgMHgwRX0s
CisJezB4QzYsIDB4MDB9LAorCXsweEM3LCAweDAxfSwKKwl7MHhDOCwgMHgxMH0sCisJezB4RkUs
IDB4MDZ9LAorCXsweDk1LCAweEVDfSwKKwl7MHg4RCwgMHhFRX0sCisJezB4NDQsIDB4RUN9LAor
CXsweDRDLCAweEVDfSwKKwl7MHgzMiwgMHhFQ30sCisJezB4M0EsIDB4RUN9LAorCXsweDdELCAw
eEVDfSwKKwl7MHg3NSwgMHhFQ30sCisJezB4MDAsIDB4RUN9LAorCXsweDA4LCAweEVDfSwKKwl7
MHg4NSwgMHhFQ30sCisJezB4QTYsIDB4MjF9LAorCXsweEE3LCAweDA1fSwKKwl7MHhBOSwgMHgw
Nn0sCisJezB4ODIsIDB4MDZ9LAorCXsweDQxLCAweDA2fSwKKwl7MHg3QSwgMHgwN30sCisJezB4
MzcsIDB4MDd9LAorCXsweDA1LCAweDA2fSwKKwl7MHg0OSwgMHgwNn0sCisJezB4MEQsIDB4MDR9
LAorCXsweDUxLCAweDA0fSwKK307CisKK3N0YXRpYyBjb25zdCB1MzIgcmFkX2J1c19mb3JtYXRz
W10gPSB7CisJTUVESUFfQlVTX0ZNVF9SR0I4ODhfMVgyNCwKKwlNRURJQV9CVVNfRk1UX1JHQjY2
Nl8xWDE4LAorCU1FRElBX0JVU19GTVRfUkdCNTY1XzFYMTYsCit9OworCitzdHJ1Y3QgcmFkX3Bh
bmVsIHsKKwlzdHJ1Y3QgZHJtX3BhbmVsIHBhbmVsOworCXN0cnVjdCBtaXBpX2RzaV9kZXZpY2Ug
KmRzaTsKKworCXN0cnVjdCBncGlvX2Rlc2MgKnJlc2V0OworCXN0cnVjdCBiYWNrbGlnaHRfZGV2
aWNlICpiYWNrbGlnaHQ7CisKKwlib29sIHByZXBhcmVkOworCWJvb2wgZW5hYmxlZDsKKworCXN0
cnVjdCB2aWRlb21vZGUgdm07CisJdTMyIHdpZHRoX21tOworCXUzMiBoZWlnaHRfbW07Cit9Owor
CitzdGF0aWMgaW5saW5lIHN0cnVjdCByYWRfcGFuZWwgKnRvX3JhZF9wYW5lbChzdHJ1Y3QgZHJt
X3BhbmVsICpwYW5lbCkKK3sKKwlyZXR1cm4gY29udGFpbmVyX29mKHBhbmVsLCBzdHJ1Y3QgcmFk
X3BhbmVsLCBwYW5lbCk7Cit9CisKK3N0YXRpYyBpbnQgcmFkX3BhbmVsX3B1c2hfY21kX2xpc3Qo
c3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpKQoreworCXNpemVfdCBpOworCXNpemVfdCBjb3Vu
dCA9IEFSUkFZX1NJWkUobWFudWZhY3R1cmVyX2NtZF9zZXQpOworCWludCByZXQgPSAwOworCisJ
Zm9yIChpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKKwkJY29uc3Qgc3RydWN0IGNtZF9zZXRfZW50
cnkgKmVudHJ5ID0gJm1hbnVmYWN0dXJlcl9jbWRfc2V0W2ldOworCQl1OCBidWZmZXJbMl0gPSB7
IGVudHJ5LT5jbWQsIGVudHJ5LT5wYXJhbSB9OworCisJCXJldCA9IG1pcGlfZHNpX2dlbmVyaWNf
d3JpdGUoZHNpLCAmYnVmZmVyLCBzaXplb2YoYnVmZmVyKSk7CisJCWlmIChyZXQgPCAwKQorCQkJ
cmV0dXJuIHJldDsKKwl9CisKKwlyZXR1cm4gcmV0OworfTsKKworc3RhdGljIGludCBjb2xvcl9m
b3JtYXRfZnJvbV9kc2lfZm9ybWF0KGVudW0gbWlwaV9kc2lfcGl4ZWxfZm9ybWF0IGZvcm1hdCkK
K3sKKwlzd2l0Y2ggKGZvcm1hdCkgeworCWNhc2UgTUlQSV9EU0lfRk1UX1JHQjU2NToKKwkJcmV0
dXJuIENPTF9GTVRfMTZCUFA7CisJY2FzZSBNSVBJX0RTSV9GTVRfUkdCNjY2OgorCWNhc2UgTUlQ
SV9EU0lfRk1UX1JHQjY2Nl9QQUNLRUQ6CisJCXJldHVybiBDT0xfRk1UXzE4QlBQOworCWNhc2Ug
TUlQSV9EU0lfRk1UX1JHQjg4ODoKKwkJcmV0dXJuIENPTF9GTVRfMjRCUFA7CisJZGVmYXVsdDoK
KwkJcmV0dXJuIENPTF9GTVRfMjRCUFA7IC8qIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5ICov
CisJfQorfTsKKworc3RhdGljIGludCByYWRfcGFuZWxfcHJlcGFyZShzdHJ1Y3QgZHJtX3BhbmVs
ICpwYW5lbCkKK3sKKwlzdHJ1Y3QgcmFkX3BhbmVsICpyYWQgPSB0b19yYWRfcGFuZWwocGFuZWwp
OworCisJaWYgKHJhZC0+cHJlcGFyZWQpCisJCXJldHVybiAwOworCisJaWYgKHJhZC0+cmVzZXQp
IHsKKwkJZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKHJhZC0+cmVzZXQsIDEpOworCQl1c2xlZXBf
cmFuZ2UoMzAwMCwgNTAwMCk7CisJCWdwaW9kX3NldF92YWx1ZV9jYW5zbGVlcChyYWQtPnJlc2V0
LCAwKTsKKwkJdXNsZWVwX3JhbmdlKDE4MDAwLCAyMDAwMCk7CisJfQorCisJcmFkLT5wcmVwYXJl
ZCA9IHRydWU7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCByYWRfcGFuZWxfdW5wcmVw
YXJlKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQoreworCXN0cnVjdCByYWRfcGFuZWwgKnJhZCA9
IHRvX3JhZF9wYW5lbChwYW5lbCk7CisKKwlpZiAoIXJhZC0+cHJlcGFyZWQpCisJCXJldHVybiAw
OworCisJaWYgKHJhZC0+cmVzZXQpIHsKKwkJZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKHJhZC0+
cmVzZXQsIDEpOworCQl1c2xlZXBfcmFuZ2UoMTUwMDAsIDE3MDAwKTsKKwkJZ3Bpb2Rfc2V0X3Zh
bHVlX2NhbnNsZWVwKHJhZC0+cmVzZXQsIDApOworCX0KKworCXJhZC0+cHJlcGFyZWQgPSBmYWxz
ZTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IHJhZF9wYW5lbF9lbmFibGUoc3RydWN0
IGRybV9wYW5lbCAqcGFuZWwpCit7CisJc3RydWN0IHJhZF9wYW5lbCAqcmFkID0gdG9fcmFkX3Bh
bmVsKHBhbmVsKTsKKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kgPSByYWQtPmRzaTsKKwlz
dHJ1Y3QgZGV2aWNlICpkZXYgPSAmZHNpLT5kZXY7CisJaW50IGNvbG9yX2Zvcm1hdCA9IGNvbG9y
X2Zvcm1hdF9mcm9tX2RzaV9mb3JtYXQoZHNpLT5mb3JtYXQpOworCWludCByZXQ7CisKKwlpZiAo
cmFkLT5lbmFibGVkKQorCQlyZXR1cm4gMDsKKworCWRzaS0+bW9kZV9mbGFncyB8PSBNSVBJX0RT
SV9NT0RFX0xQTTsKKworCXJldCA9IHJhZF9wYW5lbF9wdXNoX2NtZF9saXN0KGRzaSk7CisJaWYg
KHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8gc2VuZCBNQ1MgKCVk
KVxuIiwgcmV0KTsKKwkJZ290byBmYWlsOworCX0KKworCS8qIFNlbGVjdCBVc2VyIENvbW1hbmQg
U2V0IHRhYmxlIChDTUQxKSAqLworCXJldCA9IG1pcGlfZHNpX2dlbmVyaWNfd3JpdGUoZHNpLCAo
dThbXSl7IFdSTUFVQ0NUUiwgMHgwMCB9LCAyKTsKKwlpZiAocmV0IDwgMCkKKwkJZ290byBmYWls
OworCisJLyogU29mdHdhcmUgcmVzZXQgKi8KKwlyZXQgPSBtaXBpX2RzaV9kY3Nfc29mdF9yZXNl
dChkc2kpOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9ERVZfRVJST1IoZGV2LCAiRmFpbGVkIHRv
IGRvIFNvZnR3YXJlIFJlc2V0ICglZClcbiIsIHJldCk7CisJCWdvdG8gZmFpbDsKKwl9CisKKwl1
c2xlZXBfcmFuZ2UoMTUwMDAsIDE3MDAwKTsKKworCS8qIFNldCBEU0kgbW9kZSAqLworCXJldCA9
IG1pcGlfZHNpX2dlbmVyaWNfd3JpdGUoZHNpLCAodThbXSl7IDB4QzIsIDB4MEIgfSwgMik7CisJ
aWYgKHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8gc2V0IERTSSBt
b2RlICglZClcbiIsIHJldCk7CisJCWdvdG8gZmFpbDsKKwl9CisJLyogU2V0IHRlYXIgT04gKi8K
KwlyZXQgPSBtaXBpX2RzaV9kY3Nfc2V0X3RlYXJfb24oZHNpLCBNSVBJX0RTSV9EQ1NfVEVBUl9N
T0RFX1ZCTEFOSyk7CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWls
ZWQgdG8gc2V0IHRlYXIgT04gKCVkKVxuIiwgcmV0KTsKKwkJZ290byBmYWlsOworCX0KKwkvKiBT
ZXQgdGVhciBzY2FubGluZSAqLworCXJldCA9IG1pcGlfZHNpX2Rjc19zZXRfdGVhcl9zY2FubGlu
ZShkc2ksIDB4MzgwKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGRldiwgIkZh
aWxlZCB0byBzZXQgdGVhciBzY2FubGluZSAoJWQpXG4iLCByZXQpOworCQlnb3RvIGZhaWw7CisJ
fQorCS8qIFNldCBwaXhlbCBmb3JtYXQgKi8KKwlyZXQgPSBtaXBpX2RzaV9kY3Nfc2V0X3BpeGVs
X2Zvcm1hdChkc2ksIGNvbG9yX2Zvcm1hdCk7CisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAi
SW50ZXJmYWNlIGNvbG9yIGZvcm1hdCBzZXQgdG8gMHgleFxuIiwKKwkJCSAgICAgY29sb3JfZm9y
bWF0KTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGRldiwgIkZhaWxlZCB0byBz
ZXQgcGl4ZWwgZm9ybWF0ICglZClcbiIsIHJldCk7CisJCWdvdG8gZmFpbDsKKwl9CisJLyogRXhp
dCBzbGVlcCBtb2RlICovCisJcmV0ID0gbWlwaV9kc2lfZGNzX2V4aXRfc2xlZXBfbW9kZShkc2kp
OworCWlmIChyZXQgPCAwKSB7CisJCURSTV9ERVZfRVJST1IoZGV2LCAiRmFpbGVkIHRvIGV4aXQg
c2xlZXAgbW9kZSAoJWQpXG4iLCByZXQpOworCQlnb3RvIGZhaWw7CisJfQorCisJdXNsZWVwX3Jh
bmdlKDUwMDAsIDcwMDApOworCisJcmV0ID0gbWlwaV9kc2lfZGNzX3NldF9kaXNwbGF5X29uKGRz
aSk7CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8gc2V0
IGRpc3BsYXkgT04gKCVkKVxuIiwgcmV0KTsKKwkJZ290byBmYWlsOworCX0KKworCWJhY2tsaWdo
dF9lbmFibGUocmFkLT5iYWNrbGlnaHQpOworCisJcmFkLT5lbmFibGVkID0gdHJ1ZTsKKworCXJl
dHVybiAwOworCitmYWlsOgorCWlmIChyYWQtPnJlc2V0KQorCQlncGlvZF9zZXRfdmFsdWVfY2Fu
c2xlZXAocmFkLT5yZXNldCwgMSk7CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IHJh
ZF9wYW5lbF9kaXNhYmxlKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQoreworCXN0cnVjdCByYWRf
cGFuZWwgKnJhZCA9IHRvX3JhZF9wYW5lbChwYW5lbCk7CisJc3RydWN0IG1pcGlfZHNpX2Rldmlj
ZSAqZHNpID0gcmFkLT5kc2k7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmRzaS0+ZGV2OworCWlu
dCByZXQ7CisKKwlpZiAoIXJhZC0+ZW5hYmxlZCkKKwkJcmV0dXJuIDA7CisKKwlkc2ktPm1vZGVf
ZmxhZ3MgfD0gTUlQSV9EU0lfTU9ERV9MUE07CisKKwliYWNrbGlnaHRfZGlzYWJsZShyYWQtPmJh
Y2tsaWdodCk7CisKKwl1c2xlZXBfcmFuZ2UoMTAwMDAsIDEyMDAwKTsKKworCXJldCA9IG1pcGlf
ZHNpX2Rjc19zZXRfZGlzcGxheV9vZmYoZHNpKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVW
X0VSUk9SKGRldiwgIkZhaWxlZCB0byBzZXQgZGlzcGxheSBPRkYgKCVkKVxuIiwgcmV0KTsKKwkJ
cmV0dXJuIHJldDsKKwl9CisKKwl1c2xlZXBfcmFuZ2UoNTAwMCwgMTAwMDApOworCisJcmV0ID0g
bWlwaV9kc2lfZGNzX2VudGVyX3NsZWVwX21vZGUoZHNpKTsKKwlpZiAocmV0IDwgMCkgeworCQlE
Uk1fREVWX0VSUk9SKGRldiwgIkZhaWxlZCB0byBlbnRlciBzbGVlcCBtb2RlICglZClcbiIsIHJl
dCk7CisJCXJldHVybiByZXQ7CisJfQorCisJcmFkLT5lbmFibGVkID0gZmFsc2U7CisKKwlyZXR1
cm4gMDsKK30KKworc3RhdGljIGludCByYWRfcGFuZWxfZ2V0X21vZGVzKHN0cnVjdCBkcm1fcGFu
ZWwgKnBhbmVsKQoreworCXN0cnVjdCByYWRfcGFuZWwgKnJhZCA9IHRvX3JhZF9wYW5lbChwYW5l
bCk7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJnJhZC0+ZHNpLT5kZXY7CisJc3RydWN0IGRybV9j
b25uZWN0b3IgKmNvbm5lY3RvciA9IHBhbmVsLT5jb25uZWN0b3I7CisJc3RydWN0IGRybV9kaXNw
bGF5X21vZGUgKm1vZGU7CisJdTMyICpidXNfZmxhZ3MgPSAmY29ubmVjdG9yLT5kaXNwbGF5X2lu
Zm8uYnVzX2ZsYWdzOworCWludCByZXQ7CisKKwltb2RlID0gZHJtX21vZGVfY3JlYXRlKGNvbm5l
Y3Rvci0+ZGV2KTsKKwlpZiAoIW1vZGUpIHsKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQg
dG8gY3JlYXRlIGRpc3BsYXkgbW9kZSFcbiIpOworCQlyZXR1cm4gMDsKKwl9CisKKwlkcm1fZGlz
cGxheV9tb2RlX2Zyb21fdmlkZW9tb2RlKCZyYWQtPnZtLCBtb2RlKTsKKwltb2RlLT53aWR0aF9t
bSA9IHJhZC0+d2lkdGhfbW07CisJbW9kZS0+aGVpZ2h0X21tID0gcmFkLT5oZWlnaHRfbW07CisJ
Y29ubmVjdG9yLT5kaXNwbGF5X2luZm8ud2lkdGhfbW0gPSByYWQtPndpZHRoX21tOworCWNvbm5l
Y3Rvci0+ZGlzcGxheV9pbmZvLmhlaWdodF9tbSA9IHJhZC0+aGVpZ2h0X21tOworCW1vZGUtPnR5
cGUgPSBEUk1fTU9ERV9UWVBFX0RSSVZFUiB8IERSTV9NT0RFX1RZUEVfUFJFRkVSUkVEOworCisJ
aWYgKHJhZC0+dm0uZmxhZ3MgJiBESVNQTEFZX0ZMQUdTX0RFX0hJR0gpCisJCSpidXNfZmxhZ3Mg
fD0gRFJNX0JVU19GTEFHX0RFX0hJR0g7CisJaWYgKHJhZC0+dm0uZmxhZ3MgJiBESVNQTEFZX0ZM
QUdTX0RFX0xPVykKKwkJKmJ1c19mbGFncyB8PSBEUk1fQlVTX0ZMQUdfREVfTE9XOworCWlmIChy
YWQtPnZtLmZsYWdzICYgRElTUExBWV9GTEFHU19QSVhEQVRBX05FR0VER0UpCisJCSpidXNfZmxh
Z3MgfD0gRFJNX0JVU19GTEFHX1BJWERBVEFfTkVHRURHRTsKKwlpZiAocmFkLT52bS5mbGFncyAm
IERJU1BMQVlfRkxBR1NfUElYREFUQV9QT1NFREdFKQorCQkqYnVzX2ZsYWdzIHw9IERSTV9CVVNf
RkxBR19QSVhEQVRBX1BPU0VER0U7CisKKwlyZXQgPSBkcm1fZGlzcGxheV9pbmZvX3NldF9idXNf
Zm9ybWF0cygmY29ubmVjdG9yLT5kaXNwbGF5X2luZm8sCisJCQkJCSAgICAgICByYWRfYnVzX2Zv
cm1hdHMsCisJCQkJCSAgICAgICBBUlJBWV9TSVpFKHJhZF9idXNfZm9ybWF0cykpOworCWlmIChy
ZXQpCisJCXJldHVybiByZXQ7CisKKwlkcm1fbW9kZV9wcm9iZWRfYWRkKHBhbmVsLT5jb25uZWN0
b3IsIG1vZGUpOworCisJcmV0dXJuIDE7Cit9CisKK3N0YXRpYyBpbnQgcmFkX2JsX2dldF9icmln
aHRuZXNzKHN0cnVjdCBiYWNrbGlnaHRfZGV2aWNlICpibCkKK3sKKwlzdHJ1Y3QgbWlwaV9kc2lf
ZGV2aWNlICpkc2kgPSBibF9nZXRfZGF0YShibCk7CisJc3RydWN0IHJhZF9wYW5lbCAqcmFkID0g
bWlwaV9kc2lfZ2V0X2RydmRhdGEoZHNpKTsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmZHNpLT5k
ZXY7CisJdTE2IGJyaWdodG5lc3M7CisJaW50IHJldDsKKworCWlmICghcmFkLT5wcmVwYXJlZCkK
KwkJcmV0dXJuIDA7CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJcbiIpOworCisJZHNp
LT5tb2RlX2ZsYWdzICY9IH5NSVBJX0RTSV9NT0RFX0xQTTsKKworCXJldCA9IG1pcGlfZHNpX2Rj
c19nZXRfZGlzcGxheV9icmlnaHRuZXNzKGRzaSwgJmJyaWdodG5lc3MpOworCWlmIChyZXQgPCAw
KQorCQlyZXR1cm4gcmV0OworCisJYmwtPnByb3BzLmJyaWdodG5lc3MgPSBicmlnaHRuZXNzOwor
CisJcmV0dXJuIGJyaWdodG5lc3MgJiAweGZmOworfQorCitzdGF0aWMgaW50IHJhZF9ibF91cGRh
dGVfc3RhdHVzKHN0cnVjdCBiYWNrbGlnaHRfZGV2aWNlICpibCkKK3sKKwlzdHJ1Y3QgbWlwaV9k
c2lfZGV2aWNlICpkc2kgPSBibF9nZXRfZGF0YShibCk7CisJc3RydWN0IHJhZF9wYW5lbCAqcmFk
ID0gbWlwaV9kc2lfZ2V0X2RydmRhdGEoZHNpKTsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmZHNp
LT5kZXY7CisJaW50IHJldCA9IDA7CisKKwlpZiAoIXJhZC0+cHJlcGFyZWQpCisJCXJldHVybiAw
OworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiTmV3IGJyaWdodG5lc3M6ICVkXG4iLCBi
bC0+cHJvcHMuYnJpZ2h0bmVzcyk7CisKKwlkc2ktPm1vZGVfZmxhZ3MgJj0gfk1JUElfRFNJX01P
REVfTFBNOworCisJcmV0ID0gbWlwaV9kc2lfZGNzX3NldF9kaXNwbGF5X2JyaWdodG5lc3MoZHNp
LCBibC0+cHJvcHMuYnJpZ2h0bmVzcyk7CisJaWYgKHJldCA8IDApCisJCXJldHVybiByZXQ7CisK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBiYWNrbGlnaHRfb3BzIHJhZF9i
bF9vcHMgPSB7CisJLnVwZGF0ZV9zdGF0dXMgPSByYWRfYmxfdXBkYXRlX3N0YXR1cywKKwkuZ2V0
X2JyaWdodG5lc3MgPSByYWRfYmxfZ2V0X2JyaWdodG5lc3MsCit9OworCitzdGF0aWMgY29uc3Qg
c3RydWN0IGRybV9wYW5lbF9mdW5jcyByYWRfcGFuZWxfZnVuY3MgPSB7CisJLnByZXBhcmUgPSBy
YWRfcGFuZWxfcHJlcGFyZSwKKwkudW5wcmVwYXJlID0gcmFkX3BhbmVsX3VucHJlcGFyZSwKKwku
ZW5hYmxlID0gcmFkX3BhbmVsX2VuYWJsZSwKKwkuZGlzYWJsZSA9IHJhZF9wYW5lbF9kaXNhYmxl
LAorCS5nZXRfbW9kZXMgPSByYWRfcGFuZWxfZ2V0X21vZGVzLAorfTsKKworLyoKKyAqIFRoZSBj
bG9jayBtaWdodCByYW5nZSBmcm9tIDY2TUh6ICgzMEh6IHJlZnJlc2ggcmF0ZSkKKyAqIHRvIDEz
Mk1IeiAoNjBIeiByZWZyZXNoIHJhdGUpCisgKi8KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZGlzcGxh
eV90aW1pbmcgcmFkX2RlZmF1bHRfdGltaW5nID0geworCS5waXhlbGNsb2NrID0geyA2NjAwMDAw
MCwgMTMyMDAwMDAwLCAxMzIwMDAwMDAgfSwKKwkuaGFjdGl2ZSA9IHsgMTA4MCwgMTA4MCwgMTA4
MCB9LAorCS5oZnJvbnRfcG9yY2ggPSB7IDIwLCAyMCwgMjAgfSwKKwkuaHN5bmNfbGVuID0geyAy
LCAyLCAyIH0sCisJLmhiYWNrX3BvcmNoID0geyAzNCwgMzQsIDM0IH0sCisJLnZhY3RpdmUgPSB7
IDE5MjAsIDE5MjAsIDE5MjAgfSwKKwkudmZyb250X3BvcmNoID0geyAxMCwgMTAsIDEwIH0sCisJ
LnZzeW5jX2xlbiA9IHsgMiwgMiwgMiB9LAorCS52YmFja19wb3JjaCA9IHsgNCwgNCwgNCB9LAor
CS5mbGFncyA9IERJU1BMQVlfRkxBR1NfSFNZTkNfTE9XIHwKKwkJIERJU1BMQVlfRkxBR1NfVlNZ
TkNfTE9XIHwKKwkJIERJU1BMQVlfRkxBR1NfREVfTE9XIHwKKwkJIERJU1BMQVlfRkxBR1NfUElY
REFUQV9ORUdFREdFLAorfTsKKworc3RhdGljIGludCByYWRfcGFuZWxfcHJvYmUoc3RydWN0IG1p
cGlfZHNpX2RldmljZSAqZHNpKQoreworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZkc2ktPmRldjsK
KwlzdHJ1Y3QgZGV2aWNlX25vZGUgKm5wID0gZGV2LT5vZl9ub2RlOworCXN0cnVjdCBkZXZpY2Vf
bm9kZSAqdGltaW5nczsKKwlzdHJ1Y3QgcmFkX3BhbmVsICpwYW5lbDsKKwlzdHJ1Y3QgYmFja2xp
Z2h0X3Byb3BlcnRpZXMgYmxfcHJvcHM7CisJaW50IHJldDsKKwl1MzIgdmlkZW9fbW9kZTsKKwor
CXBhbmVsID0gZGV2bV9remFsbG9jKCZkc2ktPmRldiwgc2l6ZW9mKCpwYW5lbCksIEdGUF9LRVJO
RUwpOworCWlmICghcGFuZWwpCisJCXJldHVybiAtRU5PTUVNOworCisJbWlwaV9kc2lfc2V0X2Ry
dmRhdGEoZHNpLCBwYW5lbCk7CisKKwlwYW5lbC0+ZHNpID0gZHNpOworCisJZHNpLT5mb3JtYXQg
PSBNSVBJX0RTSV9GTVRfUkdCODg4OworCWRzaS0+bW9kZV9mbGFncyA9ICBNSVBJX0RTSV9NT0RF
X1ZJREVPX0hTRSB8IE1JUElfRFNJX01PREVfVklERU8gfAorCQkJICAgTUlQSV9EU0lfQ0xPQ0tf
Tk9OX0NPTlRJTlVPVVM7CisKKwlyZXQgPSBvZl9wcm9wZXJ0eV9yZWFkX3UzMihucCwgInZpZGVv
LW1vZGUiLCAmdmlkZW9fbW9kZSk7CisJaWYgKCFyZXQpIHsKKwkJc3dpdGNoICh2aWRlb19tb2Rl
KSB7CisJCWNhc2UgMDoKKwkJCS8qIGJ1cnN0IG1vZGUgKi8KKwkJCWRzaS0+bW9kZV9mbGFncyB8
PSBNSVBJX0RTSV9NT0RFX1ZJREVPX0JVUlNUOworCQkJYnJlYWs7CisJCWNhc2UgMToKKwkJCS8q
IG5vbi1idXJzdCBtb2RlIHdpdGggc3luYyBldmVudCAqLworCQkJYnJlYWs7CisJCWNhc2UgMjoK
KwkJCS8qIG5vbi1idXJzdCBtb2RlIHdpdGggc3luYyBwdWxzZSAqLworCQkJZHNpLT5tb2RlX2Zs
YWdzIHw9IE1JUElfRFNJX01PREVfVklERU9fU1lOQ19QVUxTRTsKKwkJCWJyZWFrOworCQlkZWZh
dWx0OgorCQkJZGV2X3dhcm4oZGV2LCAiaW52YWxpZCB2aWRlbyBtb2RlICVkXG4iLCB2aWRlb19t
b2RlKTsKKwkJCWJyZWFrOworCQl9CisJfQorCisJcmV0ID0gb2ZfcHJvcGVydHlfcmVhZF91MzIo
bnAsICJkc2ktbGFuZXMiLCAmZHNpLT5sYW5lcyk7CisJaWYgKHJldCA8IDApIHsKKwkJZGV2X2Vy
cihkZXYsICJGYWlsZWQgdG8gZ2V0IGRzaS1sYW5lcyBwcm9wZXJ0eSAoJWQpXG4iLCByZXQpOwor
CQlyZXR1cm4gcmV0OworCX0KKworCS8qCisJICogJ2Rpc3BsYXktdGltaW5ncycgaXMgb3B0aW9u
YWwsIHNvIHZlcmlmeSBpZiB0aGUgbm9kZSBpcyBwcmVzZW50CisJICogYmVmb3JlIGNhbGxpbmcg
b2ZfZ2V0X3ZpZGVvbW9kZSBzbyB3ZSB3b24ndCBnZXQgY29uc29sZSBlcnJvcgorCSAqIG1lc3Nh
Z2VzCisJICovCisJdGltaW5ncyA9IG9mX2dldF9jaGlsZF9ieV9uYW1lKG5wLCAiZGlzcGxheS10
aW1pbmdzIik7CisJaWYgKHRpbWluZ3MpIHsKKwkJb2Zfbm9kZV9wdXQodGltaW5ncyk7CisJCXJl
dCA9IG9mX2dldF92aWRlb21vZGUobnAsICZwYW5lbC0+dm0sIDApOworCX0gZWxzZSB7CisJCXZp
ZGVvbW9kZV9mcm9tX3RpbWluZygmcmFkX2RlZmF1bHRfdGltaW5nLCAmcGFuZWwtPnZtKTsKKwl9
CisJaWYgKHJldCA8IDApCisJCXJldHVybiByZXQ7CisKKwlvZl9wcm9wZXJ0eV9yZWFkX3UzMihu
cCwgIndpZHRoLW1tIiwgJnBhbmVsLT53aWR0aF9tbSk7CisJb2ZfcHJvcGVydHlfcmVhZF91MzIo
bnAsICJoZWlnaHQtbW0iLCAmcGFuZWwtPmhlaWdodF9tbSk7CisKKwlwYW5lbC0+cmVzZXQgPSBk
ZXZtX2dwaW9kX2dldChkZXYsICJyZXNldCIsIEdQSU9EX09VVF9MT1cpOworCisJaWYgKElTX0VS
UihwYW5lbC0+cmVzZXQpKQorCQlwYW5lbC0+cmVzZXQgPSBOVUxMOworCWVsc2UKKwkJZ3Bpb2Rf
c2V0X3ZhbHVlX2NhbnNsZWVwKHBhbmVsLT5yZXNldCwgMSk7CisKKwltZW1zZXQoJmJsX3Byb3Bz
LCAwLCBzaXplb2YoYmxfcHJvcHMpKTsKKwlibF9wcm9wcy50eXBlID0gQkFDS0xJR0hUX1JBVzsK
KwlibF9wcm9wcy5icmlnaHRuZXNzID0gMjU1OworCWJsX3Byb3BzLm1heF9icmlnaHRuZXNzID0g
MjU1OworCisJcGFuZWwtPmJhY2tsaWdodCA9IGRldm1fYmFja2xpZ2h0X2RldmljZV9yZWdpc3Rl
cihkZXYsIGRldl9uYW1lKGRldiksCisJCQkJCQkJICBkZXYsIGRzaSwKKwkJCQkJCQkgICZyYWRf
Ymxfb3BzLAorCQkJCQkJCSAgJmJsX3Byb3BzKTsKKwlpZiAoSVNfRVJSKHBhbmVsLT5iYWNrbGln
aHQpKSB7CisJCXJldCA9IFBUUl9FUlIocGFuZWwtPmJhY2tsaWdodCk7CisJCWRldl9lcnIoZGV2
LCAiRmFpbGVkIHRvIHJlZ2lzdGVyIGJhY2tsaWdodCAoJWQpXG4iLCByZXQpOworCQlyZXR1cm4g
cmV0OworCX0KKworCWRybV9wYW5lbF9pbml0KCZwYW5lbC0+cGFuZWwpOworCXBhbmVsLT5wYW5l
bC5mdW5jcyA9ICZyYWRfcGFuZWxfZnVuY3M7CisJcGFuZWwtPnBhbmVsLmRldiA9IGRldjsKKwlk
ZXZfc2V0X2RydmRhdGEoZGV2LCBwYW5lbCk7CisKKwlyZXQgPSBkcm1fcGFuZWxfYWRkKCZwYW5l
bC0+cGFuZWwpOworCisJaWYgKHJldCA8IDApCisJCXJldHVybiByZXQ7CisKKwlyZXQgPSBtaXBp
X2RzaV9hdHRhY2goZHNpKTsKKwlpZiAocmV0IDwgMCkKKwkJZHJtX3BhbmVsX3JlbW92ZSgmcGFu
ZWwtPnBhbmVsKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgcmFkX3BhbmVsX3Jl
bW92ZShzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kpCit7CisJc3RydWN0IHJhZF9wYW5lbCAq
cmFkID0gbWlwaV9kc2lfZ2V0X2RydmRhdGEoZHNpKTsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAm
ZHNpLT5kZXY7CisJaW50IHJldDsKKworCXJldCA9IG1pcGlfZHNpX2RldGFjaChkc2kpOworCWlm
IChyZXQgPCAwKQorCQlEUk1fREVWX0VSUk9SKGRldiwgIkZhaWxlZCB0byBkZXRhY2ggZnJvbSBo
b3N0ICglZClcbiIsCisJCQkgICAgICByZXQpOworCisJZHJtX3BhbmVsX3JlbW92ZSgmcmFkLT5w
YW5lbCk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgcmFkX3BhbmVsX3NodXRkb3du
KHN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSkKK3sKKwlzdHJ1Y3QgcmFkX3BhbmVsICpyYWQg
PSBtaXBpX2RzaV9nZXRfZHJ2ZGF0YShkc2kpOworCisJcmFkX3BhbmVsX2Rpc2FibGUoJnJhZC0+
cGFuZWwpOworCXJhZF9wYW5lbF91bnByZXBhcmUoJnJhZC0+cGFuZWwpOworfQorCisjaWZkZWYg
Q09ORklHX1BNCitzdGF0aWMgaW50IHJhZF9wYW5lbF9zdXNwZW5kKHN0cnVjdCBkZXZpY2UgKmRl
dikKK3sKKwlzdHJ1Y3QgcmFkX3BhbmVsICpyYWQgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKKwor
CWlmICghcmFkLT5yZXNldCkKKwkJcmV0dXJuIDA7CisKKwlkZXZtX2dwaW9kX3B1dChkZXYsIHJh
ZC0+cmVzZXQpOworCXJhZC0+cmVzZXQgPSBOVUxMOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRp
YyBpbnQgcmFkX3BhbmVsX3Jlc3VtZShzdHJ1Y3QgZGV2aWNlICpkZXYpCit7CisJc3RydWN0IHJh
ZF9wYW5lbCAqcmFkID0gZGV2X2dldF9kcnZkYXRhKGRldik7CisKKwlpZiAocmFkLT5yZXNldCkK
KwkJcmV0dXJuIDA7CisKKwlyYWQtPnJlc2V0ID0gZGV2bV9ncGlvZF9nZXQoZGV2LCAicmVzZXQi
LCBHUElPRF9PVVRfTE9XKTsKKwlpZiAoSVNfRVJSKHJhZC0+cmVzZXQpKQorCQlyYWQtPnJlc2V0
ID0gTlVMTDsKKworCXJldHVybiBQVFJfRVJSX09SX1pFUk8ocmFkLT5yZXNldCk7Cit9CisKKyNl
bmRpZgorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRldl9wbV9vcHMgcmFkX3BtX29wcyA9IHsKKwlT
RVRfUlVOVElNRV9QTV9PUFMocmFkX3BhbmVsX3N1c3BlbmQsIHJhZF9wYW5lbF9yZXN1bWUsIE5V
TEwpCisJU0VUX1NZU1RFTV9TTEVFUF9QTV9PUFMocmFkX3BhbmVsX3N1c3BlbmQsIHJhZF9wYW5l
bF9yZXN1bWUpCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IG9mX2RldmljZV9pZCByYWRfb2Zf
bWF0Y2hbXSA9IHsKKwl7IC5jb21wYXRpYmxlID0gInJheWRpdW0scm02NzE5MSIsIH0sCisJeyB9
Cit9OworTU9EVUxFX0RFVklDRV9UQUJMRShvZiwgcmFkX29mX21hdGNoKTsKKworc3RhdGljIHN0
cnVjdCBtaXBpX2RzaV9kcml2ZXIgcmFkX3BhbmVsX2RyaXZlciA9IHsKKwkuZHJpdmVyID0gewor
CQkubmFtZSA9ICJwYW5lbC1yYXlkaXVtLXJtNjcxOTEiLAorCQkub2ZfbWF0Y2hfdGFibGUgPSBy
YWRfb2ZfbWF0Y2gsCisJCS5wbQk9ICZyYWRfcG1fb3BzLAorCX0sCisJLnByb2JlID0gcmFkX3Bh
bmVsX3Byb2JlLAorCS5yZW1vdmUgPSByYWRfcGFuZWxfcmVtb3ZlLAorCS5zaHV0ZG93biA9IHJh
ZF9wYW5lbF9zaHV0ZG93biwKK307Cittb2R1bGVfbWlwaV9kc2lfZHJpdmVyKHJhZF9wYW5lbF9k
cml2ZXIpOworCitNT0RVTEVfQVVUSE9SKCJSb2JlcnQgQ2hpcmFzIDxyb2JlcnQuY2hpcmFzQG54
cC5jb20+Iik7CitNT0RVTEVfREVTQ1JJUFRJT04oIkRSTSBEcml2ZXIgZm9yIFJheWRpdW0gUk02
NzE5MSBNSVBJIERTSSBwYW5lbCIpOworTU9EVUxFX0xJQ0VOU0UoIkdQTCB2MiIpOwotLSAKMi43
LjQKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1k
ZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczov
L2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
