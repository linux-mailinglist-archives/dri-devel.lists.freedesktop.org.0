Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 8A15CD399B
	for <lists+dri-devel@lfdr.de>; Fri, 11 Oct 2019 08:49:01 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 58EEB6EBAD;
	Fri, 11 Oct 2019 06:48:24 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from NAM02-SN1-obe.outbound.protection.outlook.com
 (mail-eopbgr770107.outbound.protection.outlook.com [40.107.77.107])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0D5486EACB
 for <dri-devel@lists.freedesktop.org>; Thu, 10 Oct 2019 09:34:22 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=WHu75lUFtY2vQ4491taTxzkThSuAFK8J28zCl8vCMlaynYtLxRFrXB5WHPQoWYO+zGhREdEmycGb5Oia9nS6dJh5Aem10CFctGQI98BNAQZQzyJXyvwGNRqjJ6YSQo5qtIvYcb8MaXdHzlDFhWs74Tm4zOhnIoy1IVvQ84ycwn33J3IIZT7AZ5jf6ARTGpTndXdu4Op4EayiIRYrstI7VrHcaH6l4B00ha+zFNzwUAZ9LsG7hX61mk+AqJ+N+LR4RdagQVJ6srM3+UyfuuaaFnS0YlrRbQ47tqY+ZCn5hBhM4huaL5Rkmdgh1X91p6fsyCJeseeOY/M6nZqgNNfmog==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=zIvLcLcWymh+jkhxKif3fDJOOH1kPP6nmHtUeryZ8Fw=;
 b=FRSmRLviFwu3GnsdzJlpfql5vh3rrkeFAXhFeYmSD/sTyEpc9nQ/yq8DaxeeG+NQR6uyPxMloNFfF9aurZiUREwnen/mFi7bQSMX7ICMYv1rbAYCeIfkdSC3GgK43uP07CKMdMJHIiSWXITmIAPfR1b8IcJBvLmSMwo+Mb/hA8qgnptfrifALLftf52lcBiDk85yPLPMxi4E3QKXmPpTGzJqk8qeXXS1gNWuKtiENWEDtMuKM+LjNhb6609gT0tFaOPzF1jCfEsXaQdgdIf2BSNJZZX6LBdva4BGXKUvaBQRLr0UF7euk4XAZfCSWP5+KKW0Nk2LASWaUCuKu0UM/w==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=analogixsemi.com; dmarc=pass action=none
 header.from=analogixsemi.com; dkim=pass header.d=analogixsemi.com; arc=none
Received: from SN6PR04MB4543.namprd04.prod.outlook.com (52.135.120.29) by
 SN6PR04MB5374.namprd04.prod.outlook.com (20.178.6.216) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2347.18; Thu, 10 Oct 2019 09:34:19 +0000
Received: from SN6PR04MB4543.namprd04.prod.outlook.com
 ([fe80::c55e:6c70:adbb:cf87]) by SN6PR04MB4543.namprd04.prod.outlook.com
 ([fe80::c55e:6c70:adbb:cf87%5]) with mapi id 15.20.2347.016; Thu, 10 Oct 2019
 09:34:19 +0000
From: Xin Ji <xji@analogixsemi.com>
To: "devel@driverdev.osuosl.org" <devel@driverdev.osuosl.org>, Laurent
 Pinchart <laurent.pinchart@ideasonboard.com>, Andrzej Hajda
 <a.hajda@samsung.com>
Subject: [PATCH v2 2/2] drm/bridge: anx7625: Add anx7625 MIPI DSI/DPI to DP
 bridge driver
Thread-Topic: [PATCH v2 2/2] drm/bridge: anx7625: Add anx7625 MIPI DSI/DPI to
 DP bridge driver
Thread-Index: AQHVf03kuqnh4EHv10CXhqHwc1i8Rw==
Date: Thu, 10 Oct 2019 09:34:19 +0000
Message-ID: <43f48a7036e5a2991bd6bd8a7361107b27e48c54.1570699576.git.xji@analogixsemi.com>
References: <cover.1570699576.git.xji@analogixsemi.com>
In-Reply-To: <cover.1570699576.git.xji@analogixsemi.com>
Accept-Language: zh-CN, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: HK0PR04CA0007.apcprd04.prod.outlook.com
 (2603:1096:203:36::19) To SN6PR04MB4543.namprd04.prod.outlook.com
 (2603:10b6:805:a8::29)
x-ms-exchange-messagesentrepresentingtype: 1
x-originating-ip: [114.247.245.252]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 4363c4ab-2c42-4416-9e13-08d74d650608
x-ms-traffictypediagnostic: SN6PR04MB5374:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <SN6PR04MB5374C7F678EB285C74F431D5C7940@SN6PR04MB5374.namprd04.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:5516;
x-forefront-prvs: 018632C080
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10019020)(396003)(39850400004)(366004)(136003)(346002)(376002)(199004)(189003)(99286004)(4326008)(71200400001)(71190400001)(6506007)(5024004)(14444005)(256004)(52116002)(386003)(76176011)(316002)(305945005)(2906002)(7736002)(186003)(102836004)(478600001)(25786009)(118296001)(26005)(561924002)(14454004)(66066001)(8676002)(446003)(11346002)(86362001)(6436002)(5660300002)(8936002)(2501003)(81166006)(81156014)(30864003)(6512007)(486006)(54906003)(110136005)(7416002)(6116002)(3846002)(2616005)(6486002)(476003)(66556008)(66946007)(66476007)(107886003)(64756008)(66446008)(36756003)(569006);
 DIR:OUT; SFP:1102; SCL:1; SRVR:SN6PR04MB5374;
 H:SN6PR04MB4543.namprd04.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: analogixsemi.com does not
 designate permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: PFOBLKBrDzWZN9xvjzLxBokUGjlbgzXSWfWy21nRblz9HaTc74c6GqczArbGzagUhmJnjqsq22nKrrFccgXrmLE870THysUZdLpJtE1EG2s7yTak7tp6d/+6TvTwn058Cxa9OsFM5rAnIahDCJS5t6fEjNZ3JRH4nYuhvwoNYaKfOhmHP7/nzieW0UNXGPnbTXfWUiJIa4iZnx2afv0B/KaRWaSjbVpTRxEOmYRxW2mMxLXybZuBAaaL3QqCXYnz+sj4tK5GUkE04Hila2V6zP6c2+bzHDMfN2sSHXQ95O9R/UVkZbRswdOzTlYrbJL0ZBJBQE7FLcmtSE3DYlXVNeKkXKBixusVcbh28Adfc5wqSnIXK6DIv/eHOMhkkL4K7XNtyiDv3msz+64J7dXdi8sWR/H32IRboGLXAVLnTfw=
Content-ID: <4CCCCEA99B09C74B92732E4319F79411@namprd04.prod.outlook.com>
MIME-Version: 1.0
X-OriginatorOrg: analogixsemi.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 4363c4ab-2c42-4416-9e13-08d74d650608
X-MS-Exchange-CrossTenant-originalarrivaltime: 10 Oct 2019 09:34:19.6071 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: b099b0b4-f26c-4cf5-9a0f-d5be9acab205
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: iR5d0a/3B7fKRQTj55QkQRKQxTgA4hXSd5KYXHMUpWLEpl8XMD9lK0Bop/WfK8I+UUBqnc4jhvHVF7LOlqObww==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: SN6PR04MB5374
X-Mailman-Approved-At: Fri, 11 Oct 2019 06:48:21 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=Analogixsemi.onmicrosoft.com; s=selector2-Analogixsemi-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=zIvLcLcWymh+jkhxKif3fDJOOH1kPP6nmHtUeryZ8Fw=;
 b=OVS2EEA8DoeSuxmQKGoApYmLZ/T17jR94bWnoXdsIsXQhJsxM+y5O5bDP5R4IQMQPN1dM7cH1uKr3b+4YqesH/66CwHDHKN6+g5KIHhMuvLsG1bw0l0B0LiqZIPy97lFSEVDyqUHJ6VLePjXVsgGmvSKHxh95nwCOw05IbijQ2w=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=xji@analogixsemi.com; 
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Jernej Skrabec <jernej.skrabec@siol.net>,
 Nicolas Boichat <drinkcat@chromium.org>, Jonas Karlman <jonas@kwiboo.se>,
 David Airlie <airlied@linux.ie>, Neil Armstrong <narmstrong@baylibre.com>,
 "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
 "dri-devel@lists.freedesktop.org" <dri-devel@lists.freedesktop.org>,
 Sheng Pan <span@analogixsemi.com>, Dan Carpenter <dan.carpenter@oracle.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIEFOWDc2MjUgaXMgYW4gdWx0cmEtbG93IHBvd2VyIDRLIE1vYmlsZSBIRCBUcmFuc21pdHRl
ciBkZXNpZ25lZApmb3IgcG9ydGFibGUgZGV2aWNlLiBJdCBjb252ZXJ0cyBNSVBJIERTSS9EUEkg
dG8gRGlzcGxheVBvcnQgMS4zIDRLLgoKVGhlIEFOWDc2MjUgY2FuIHN1cHBvcnQgYm90aCBVU0Ig
VHlwZS1DIFBEIGZlYXR1cmUgYW5kIE1JUEkgRFNJL0RQSQp0byBEUCBmZWF0dXJlLiBUaGlzIGRy
aXZlciBvbmx5IGVuYWJsZWQgTUlQSSBEU0kvRFBJIHRvIERQIGZlYXR1cmUuCgpTaWduZWQtb2Zm
LWJ5OiBYaW4gSmkgPHhqaUBhbmFsb2dpeHNlbWkuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9i
cmlkZ2UvTWFrZWZpbGUgICAgICAgICAgIHwgICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2JyaWRn
ZS9hbmFsb2dpeC9LY29uZmlnICAgfCAgICA2ICsKIGRyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5h
bG9naXgvTWFrZWZpbGUgIHwgICAgMSArCiBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4
L2FueDc2MjUuYyB8IDIxNTUgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIGRyaXZlcnMv
Z3B1L2RybS9icmlkZ2UvYW5hbG9naXgvYW54NzYyNS5oIHwgIDQwNiArKysrKysKIDUgZmlsZXMg
Y2hhbmdlZCwgMjU2OSBpbnNlcnRpb25zKCspLCAxIGRlbGV0aW9uKC0pCiBjcmVhdGUgbW9kZSAx
MDA2NDQgZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9hbng3NjI1LmMKIGNyZWF0ZSBt
b2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L2FueDc2MjUuaAoKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9k
cm0vYnJpZGdlL01ha2VmaWxlCmluZGV4IDQ5MzRmY2YuLmJjZDM4OGEgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9icmlkZ2UvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRn
ZS9NYWtlZmlsZQpAQCAtMTIsOCArMTIsOCBAQCBvYmotJChDT05GSUdfRFJNX1NJSTkyMzQpICs9
IHNpaTkyMzQubwogb2JqLSQoQ09ORklHX0RSTV9USElORV9USEM2M0xWRDEwMjQpICs9IHRoYzYz
bHZkMTAyNC5vCiBvYmotJChDT05GSUdfRFJNX1RPU0hJQkFfVEMzNTg3NjQpICs9IHRjMzU4NzY0
Lm8KIG9iai0kKENPTkZJR19EUk1fVE9TSElCQV9UQzM1ODc2NykgKz0gdGMzNTg3Njcubwotb2Jq
LSQoQ09ORklHX0RSTV9BTkFMT0dJWF9EUCkgKz0gYW5hbG9naXgvCiBvYmotJChDT05GSUdfRFJN
X0kyQ19BRFY3NTExKSArPSBhZHY3NTExLwogb2JqLSQoQ09ORklHX0RSTV9USV9TTjY1RFNJODYp
ICs9IHRpLXNuNjVkc2k4Ni5vCiBvYmotJChDT05GSUdfRFJNX1RJX1RGUDQxMCkgKz0gdGktdGZw
NDEwLm8KK29iai15ICs9IGFuYWxvZ2l4Lwogb2JqLXkgKz0gc3lub3BzeXMvCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L0tjb25maWcgYi9kcml2ZXJzL2dwdS9k
cm0vYnJpZGdlL2FuYWxvZ2l4L0tjb25maWcKaW5kZXggZTkzMGZmOS4uYjJmMTI3ZSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9LY29uZmlnCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvS2NvbmZpZwpAQCAtMiwzICsyLDkgQEAKIGNvbmZp
ZyBEUk1fQU5BTE9HSVhfRFAKIAl0cmlzdGF0ZQogCWRlcGVuZHMgb24gRFJNCisKK2NvbmZpZyBB
TkFMT0dJWF9BTlg3NjI1CisJdHJpc3RhdGUgIkFuYWxvZ2l4IE1JUEkgdG8gRFAgaW50ZXJmYWNl
IHN1cHBvcnQiCisJaGVscAorCQlBTlg3NjI1IGlzIGFuIHVsdHJhLWxvdyBwb3dlciA0SyBtb2Jp
bGUgSEQgdHJhbnNtaXR0ZXIgZGVzaWduZWQKKwkJZm9yIHBvcnRhYmxlIGRldmljZXMuIEl0IGNv
bnZlcnRzIE1JUEkvRFBJIHRvIERpc3BsYXlQb3J0MS4zIDRLLgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9icmlk
Z2UvYW5hbG9naXgvTWFrZWZpbGUKaW5kZXggZmRiZjNmZC4uOGE1Mjg2NyAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2dw
dS9kcm0vYnJpZGdlL2FuYWxvZ2l4L01ha2VmaWxlCkBAIC0xLDMgKzEsNCBAQAogIyBTUERYLUxp
Y2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5CitvYmotJChDT05GSUdfQU5BTE9HSVhfQU5Y
NzYyNSkgKz0gYW54NzYyNS5vCiBhbmFsb2dpeF9kcC1vYmpzIDo9IGFuYWxvZ2l4X2RwX2NvcmUu
byBhbmFsb2dpeF9kcF9yZWcubwogb2JqLSQoQ09ORklHX0RSTV9BTkFMT0dJWF9EUCkgKz0gYW5h
bG9naXhfZHAubwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9h
bng3NjI1LmMgYi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L2FueDc2MjUuYwpuZXcg
ZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi40MzI4YzRlCi0tLSAvZGV2L251bGwKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9hbng3NjI1LmMKQEAgLTAsMCArMSwy
MTU1IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5CisvKgorICog
Q29weXJpZ2h0KGMpIDIwMTYsIEFuYWxvZ2l4IFNlbWljb25kdWN0b3IuIEFsbCByaWdodHMgcmVz
ZXJ2ZWQuCisgKgorICovCisjaW5jbHVkZSA8bGludXgvZXh0Y29uLmg+CisjaW5jbHVkZSA8bGlu
dXgvZ2NkLmg+CisjaW5jbHVkZSA8bGludXgvZ3Bpby9jb25zdW1lci5oPgorI2luY2x1ZGUgPGxp
bnV4L2kyYy5oPgorI2luY2x1ZGUgPGxpbnV4L2ludGVycnVwdC5oPgorI2luY2x1ZGUgPGxpbnV4
L2lvcG9sbC5oPgorI2luY2x1ZGUgPGxpbnV4L2tlcm5lbC5oPgorI2luY2x1ZGUgPGxpbnV4L21v
ZHVsZS5oPgorI2luY2x1ZGUgPGxpbnV4L211dGV4Lmg+CisjaW5jbHVkZSA8bGludXgvc2xhYi5o
PgorI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CisjaW5jbHVkZSA8bGludXgvd29ya3F1ZXVlLmg+
CisKKyNpbmNsdWRlIDxsaW51eC9vZl9ncGlvLmg+CisjaW5jbHVkZSA8bGludXgvb2ZfZ3JhcGgu
aD4KKyNpbmNsdWRlIDxsaW51eC9vZl9wbGF0Zm9ybS5oPgorCisjaW5jbHVkZSA8ZHJtL2RybV9h
dG9taWNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9icmlkZ2UuaD4KKyNpbmNsdWRlIDxk
cm0vZHJtX2NydGNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9kcF9oZWxwZXIuaD4KKyNp
bmNsdWRlIDxkcm0vZHJtX2VkaWQuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX21pcGlfZHNpLmg+Cisj
aW5jbHVkZSA8ZHJtL2RybV9wYW5lbC5oPgorI2luY2x1ZGUgPGRybS9kcm1fcHJpbnQuaD4KKyNp
bmNsdWRlIDxkcm0vZHJtX3Byb2JlX2hlbHBlci5oPgorCisjaW5jbHVkZSA8dmlkZW8vZGlzcGxh
eV90aW1pbmcuaD4KKworI2luY2x1ZGUgImFueDc2MjUuaCIKKworLyoKKyAqIHRoZXJlIGlzIGEg
c3luYyBpc3N1ZSB3aGlsZSBhY2Nlc3MgSTJDIHJlZ2lzdGVyIGJldHdlZW4gQVAoQ1BVKSBhbmQK
KyAqIGludGVybmFsIGZpcm13YXJlKE9DTSksIHRvIGF2b2lkIHRoZSByYWNlIGNvbmRpdGlvbiwg
QVAgc2hvdWxkIGFjY2VzcworICogdGhlIHJlc2VydmVkIHNsYXZlIGFkZHJlc3MgYmVmb3JlIHNs
YXZlIGFkZHJlc3Mgb2NjdXJzIGNoYW5nZXMuCisgKi8KK3N0YXRpYyBpbnQgaTJjX2FjY2Vzc193
b3JrYXJvdW5kKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKKwkJCQkgc3RydWN0IGkyY19jbGll
bnQgKmNsaWVudCkKK3sKKwl1OCBvZmZzZXQ7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmNsaWVu
dC0+ZGV2OworCWludCByZXQ7CisKKwlpZiAoY2xpZW50ID09IGN0eC0+bGFzdF9jbGllbnQpCisJ
CXJldHVybiAwOworCisJY3R4LT5sYXN0X2NsaWVudCA9IGNsaWVudDsKKworCWlmIChjbGllbnQg
PT0gY3R4LT5pMmMudGNwY19jbGllbnQpCisJCW9mZnNldCA9IFJTVkRfMDBfQUREUjsKKwllbHNl
IGlmIChjbGllbnQgPT0gY3R4LT5pMmMudHhfcDBfY2xpZW50KQorCQlvZmZzZXQgPSBSU1ZEX0Qx
X0FERFI7CisJZWxzZSBpZiAoY2xpZW50ID09IGN0eC0+aTJjLnR4X3AxX2NsaWVudCkKKwkJb2Zm
c2V0ID0gUlNWRF82MF9BRERSOworCWVsc2UgaWYgKGNsaWVudCA9PSBjdHgtPmkyYy5yeF9wMF9j
bGllbnQpCisJCW9mZnNldCA9IFJTVkRfMzlfQUREUjsKKwllbHNlIGlmIChjbGllbnQgPT0gY3R4
LT5pMmMucnhfcDFfY2xpZW50KQorCQlvZmZzZXQgPSBSU1ZEXzdGX0FERFI7CisJZWxzZQorCQlv
ZmZzZXQgPSBSU1ZEXzAwX0FERFI7CisKKwlyZXQgPSBpMmNfc21idXNfd3JpdGVfYnl0ZV9kYXRh
KGNsaWVudCwgb2Zmc2V0LCAweDAwKTsKKwlpZiAocmV0IDwgMCkKKwkJRFJNX0RFVl9FUlJPUihk
ZXYsCisJCQkgICAgICAiZmFpbGVkIHRvIGFjY2VzcyBpMmMgaWQ9JXhcbjoleCIsCisJCQkgICAg
ICBjbGllbnQtPmFkZHIsIG9mZnNldCk7CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50
IGFueDc2MjVfcmVnX3JlYWQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAorCQkJICAgIHN0cnVj
dCBpMmNfY2xpZW50ICpjbGllbnQsIHU4IHJlZ19hZGRyKQoreworCWludCByZXQ7CisJc3RydWN0
IGRldmljZSAqZGV2ID0gJmNsaWVudC0+ZGV2OworCisJaTJjX2FjY2Vzc193b3JrYXJvdW5kKGN0
eCwgY2xpZW50KTsKKworCXJldCA9IGkyY19zbWJ1c19yZWFkX2J5dGVfZGF0YShjbGllbnQsIHJl
Z19hZGRyKTsKKwlpZiAocmV0IDwgMCkKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJyZWFkIGkyYyBm
YWlsZWQgaWQ9JXg6JXhcbiIsCisJCQkgICAgICBjbGllbnQtPmFkZHIsIHJlZ19hZGRyKTsKKwor
CXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV9yZWdfYmxvY2tfcmVhZChzdHJ1
Y3QgYW54NzYyNV9kYXRhICpjdHgsCisJCQkJICBzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50LAor
CQkJCSAgdTggcmVnX2FkZHIsIHU4IGxlbiwgdTggKmJ1ZikKK3sKKwlpbnQgcmV0OworCXN0cnVj
dCBkZXZpY2UgKmRldiA9ICZjbGllbnQtPmRldjsKKworCWkyY19hY2Nlc3Nfd29ya2Fyb3VuZChj
dHgsIGNsaWVudCk7CisKKwlyZXQgPSBpMmNfc21idXNfcmVhZF9pMmNfYmxvY2tfZGF0YShjbGll
bnQsIHJlZ19hZGRyLCBsZW4sIGJ1Zik7CisJaWYgKHJldCA8IDApCisJCURSTV9ERVZfRVJST1Io
ZGV2LCAicmVhZCBpMmMgYmxvY2sgZmFpbGVkIGlkPSV4OiV4XG4iLAorCQkJICAgICAgY2xpZW50
LT5hZGRyLCByZWdfYWRkcik7CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IGFueDc2
MjVfcmVnX3dyaXRlKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKKwkJCSAgICAgc3RydWN0IGky
Y19jbGllbnQgKmNsaWVudCwKKwkJCSAgICAgdTggcmVnX2FkZHIsIHU4IHJlZ192YWwpCit7CisJ
aW50IHJldDsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY2xpZW50LT5kZXY7CisKKwlpMmNfYWNj
ZXNzX3dvcmthcm91bmQoY3R4LCBjbGllbnQpOworCisJcmV0ID0gaTJjX3NtYnVzX3dyaXRlX2J5
dGVfZGF0YShjbGllbnQsIHJlZ19hZGRyLCByZWdfdmFsKTsKKworCWlmIChyZXQgPCAwKQorCQlE
Uk1fREVWX0VSUk9SKGRldiwgImZhaWxlZCB0byB3cml0ZSBpMmMgaWQ9JXhcbjoleCIsCisJCQkg
ICAgICBjbGllbnQtPmFkZHIsIHJlZ19hZGRyKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRp
YyBpbnQgYW54NzYyNV93cml0ZV9vcihzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCisJCQkgICAg
c3RydWN0IGkyY19jbGllbnQgKmNsaWVudCwKKwkJCSAgICB1OCBvZmZzZXQsIHU4IG1hc2spCit7
CisJaW50IHZhbDsKKworCXZhbCA9IGFueDc2MjVfcmVnX3JlYWQoY3R4LCBjbGllbnQsIG9mZnNl
dCk7CisJaWYgKHZhbCA8IDApCisJCXJldHVybiB2YWw7CisKKwlyZXR1cm4gYW54NzYyNV9yZWdf
d3JpdGUoY3R4LCBjbGllbnQsIG9mZnNldCwgKHZhbCB8IChtYXNrKSkpOworfQorCitzdGF0aWMg
aW50IGFueDc2MjVfd3JpdGVfYW5kKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKKwkJCSAgICAg
c3RydWN0IGkyY19jbGllbnQgKmNsaWVudCwKKwkJCSAgICAgdTggb2Zmc2V0LCB1OCBtYXNrKQor
eworCWludCB2YWw7CisKKwl2YWwgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY2xpZW50LCBvZmZz
ZXQpOworCWlmICh2YWwgPCAwKQorCQlyZXR1cm4gdmFsOworCisJcmV0dXJuIGFueDc2MjVfcmVn
X3dyaXRlKGN0eCwgY2xpZW50LCBvZmZzZXQsICh2YWwgJiAobWFzaykpKTsKK30KKworc3RhdGlj
IGludCBhbng3NjI1X3dyaXRlX2FuZF9vcihzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCisJCQkJ
c3RydWN0IGkyY19jbGllbnQgKmNsaWVudCwKKwkJCQl1OCBvZmZzZXQsIHU4IGFuZF9tYXNrLCB1
OCBvcl9tYXNrKQoreworCWludCB2YWw7CisKKwl2YWwgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwg
Y2xpZW50LCBvZmZzZXQpOworCWlmICh2YWwgPCAwKQorCQlyZXR1cm4gdmFsOworCisJcmV0dXJu
IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY2xpZW50LAorCQkJCSBvZmZzZXQsICh2YWwgJiBhbmRf
bWFzaykgfCAob3JfbWFzaykpOworfQorCitzdGF0aWMgaW50IGFueDc2MjVfY29uZmlnX2JpdF9t
YXRyaXgoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCWludCBpLCByZXQ7CisKKwlyZXQg
PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnR4X3AyX2NsaWVudCwKKwkJCQlBVURJ
T19DT05UUk9MX1JFR0lTVEVSLCAweDgwKTsKKwlmb3IgKGkgPSAwOyBpIDwgMTM7IGkrKykKKwkJ
cmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMudHhfcDJfY2xpZW50LAorCQkJ
CQkgVklERU9fQklUX01BVFJJWF8xMiArIGksCisJCQkJCSAweDE4ICsgaSk7CisKKwlyZXR1cm4g
cmV0OworfQorCitzdGF0aWMgaW50IGFueDc2MjVfcmVhZF9jdHJsX3N0YXR1c19wMChzdHJ1Y3Qg
YW54NzYyNV9kYXRhICpjdHgpCit7CisJcmV0dXJuIGFueDc2MjVfcmVnX3JlYWQoY3R4LCBjdHgt
PmkyYy5yeF9wMF9jbGllbnQsIEFQX0FVWF9DVFJMX1NUQVRVUyk7Cit9CisKK3N0YXRpYyBpbnQg
d2FpdF9hdXhfb3BfZmluaXNoKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sKKwlpbnQgdmFs
OworCWludCByZXQ7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisK
KwlyZXQgPSByZWFkeF9wb2xsX3RpbWVvdXQoYW54NzYyNV9yZWFkX2N0cmxfc3RhdHVzX3AwLAor
CQkJCSBjdHgsIHZhbCwKKwkJCQkgKCEodmFsICYgQVBfQVVYX0NUUkxfT1BfRU4pIHx8ICh2YWwg
PCAwKSksCisJCQkJIDIwMDAsCisJCQkJIDIwMDAgKiAxNTApOworCWlmIChyZXQpIHsKKwkJRFJN
X0RFVl9FUlJPUihkZXYsICJhdXggb3BlcmF0aW9uIGZhaWxlZCFcbiIpOworCQlyZXR1cm4gLUVJ
TzsKKwl9CisKKwl2YWwgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xp
ZW50LAorCQkJICAgICAgIEFQX0FVWF9DVFJMX1NUQVRVUyk7CisJaWYgKHZhbCA8IDAgfHwgKHZh
bCAmIDB4MEYpKSB7CisJCURSTV9ERVZfRVJST1IoZGV2LCAiYXV4IHN0YXR1cyAlMDJ4XG4iLCB2
YWwpOworCQl2YWwgPSAtRUlPOworCX0KKworCXJldHVybiB2YWw7Cit9CisKK3N0YXRpYyBpbnQg
d3JpdGVfZHBjZF9hZGRyKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKKwkJCSAgIHU4IGFkZHJo
LCB1OCBhZGRybSwgdTggYWRkcmwpCit7CisJaW50IHJldDsKKworCXJldCA9IGFueDc2MjVfcmVn
X3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCUFQX0FVWF9BRERSXzdfMCwg
KHU4KWFkZHJsKTsKKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9w
MF9jbGllbnQsCisJCQkJIEFQX0FVWF9BRERSXzE1XzgsICh1OClhZGRybSk7CisJcmV0IHw9IGFu
eDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCSBBUF9BVVhf
QUREUl8xOV8xNiwgKHU4KWFkZHJoKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQg
c3BfdHhfYXV4X2RwY2RyZWFkX2J5dGVzKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKKwkJCQkg
ICAgdTggYWRkcmgsIHU4IGFkZHJtLAorCQkJCSAgICB1OCBhZGRybCwgdTggY291bnQsCisJCQkJ
ICAgIHU4ICpidWYpCit7CisJdTggYzsKKwlpbnQgcmV0OworCXN0cnVjdCBkZXZpY2UgKmRldiA9
ICZjdHgtPmNsaWVudC0+ZGV2OworCisJaWYgKFdBUk5fT04oY291bnQgPiBNQVhfRFBDRF9CVUZG
RVJfU0laRSkpCisJCXJldHVybiAtRTJCSUc7CisKKwkvKiBjb21tYW5kIGFuZCBsZW5ndGggKi8K
KwljID0gKChjb3VudCAtIDEpIDw8IDQpIHwgMHgwOTsKKwlyZXQgPSBhbng3NjI1X3JlZ193cml0
ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwgQVBfQVVYX0NPTU1BTkQsIGMpOworCS8qIGFk
ZHJlc3MgKi8KKwlyZXQgfD0gd3JpdGVfZHBjZF9hZGRyKGN0eCwgYWRkcmgsIGFkZHJtLCBhZGRy
bCk7CisJLyogYXV4IGVuICovCisJcmV0IHw9IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmky
Yy5yeF9wMF9jbGllbnQsIEFQX0FVWF9DVFJMX1NUQVRVUywKKwkJCQlBUF9BVVhfQ1RSTF9PUF9F
Tik7CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJhdXggZW5hYmxlIGZh
aWxlZC5cbiIpOworCQlyZXR1cm4gcmV0OworCX0KKworCXVzbGVlcF9yYW5nZSgyMDAwLCAyMTAw
KTsKKworCXJldCA9IHdhaXRfYXV4X29wX2ZpbmlzaChjdHgpOworCWlmIChyZXQgPCAwKSB7CisJ
CURSTV9ERVZfRVJST1IoZGV2LCAiYXV4IHJlYWQgZmFpbGVkXG4iKTsKKwkJcmV0dXJuIHJldDsK
Kwl9CisKKwlyZXR1cm4gYW54NzYyNV9yZWdfYmxvY2tfcmVhZChjdHgsIGN0eC0+aTJjLnJ4X3Aw
X2NsaWVudCwKKwkJCUFQX0FVWF9CVUZGX1NUQVJULCBjb3VudCwgYnVmKTsKK30KKworc3RhdGlj
IGludCBhbng3NjI1X3ZpZGVvX211dGVfY29udHJvbChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgs
CisJCQkJICAgICAgdTggc3RhdHVzKQoreworCWludCByZXQ7CisKKwlpZiAoc3RhdHVzKSB7IC8q
IG11dGUgb24gKi8KKwkJLyogc2V0IG11dGUgZmxhZyAqLworCQlyZXQgPSBhbng3NjI1X3dyaXRl
X29yKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCSAgICAgICBBUF9BVl9TVEFUVVMs
IEFQX01JUElfTVVURSk7CisJCS8qIGNsZWFyIG1pcGkgUlggZW4gKi8KKwkJcmV0IHw9IGFueDc2
MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCQkgQVBfQVZfU1RB
VFVTLCAodTgpfkFQX01JUElfUlhfRU4pOworCX0gZWxzZSB7IC8qIG11dGUgb2ZmICovCisJCS8q
IGNsZWFyIG11dGUgZmxhZyAqLworCQlyZXQgPSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+
aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkJQVBfQVZfU1RBVFVTLCAodTgpfkFQX01JUElfTVVURSk7
CisJCS8qIHNldCBNSVBJIFJYIEVOICovCisJCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwg
Y3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCQlBUF9BVl9TVEFUVVMsIEFQX01JUElfUlhfRU4p
OworCX0KKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV9jb25maWdfYXVk
aW9faW5wdXQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCWludCByZXQ7CisKKwkvKiBj
aGFubmVsIG51bSAqLworCXJldCA9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMudHhf
cDJfY2xpZW50LAorCQkJCUFVRElPX0NIQU5ORUxfU1RBVFVTXzYsIEkyU19DSF8yIDw8IDUpOwor
CS8qIGxheW91dCAqLworCS8qIGFzIEkyUyBjaGFubmVsIGlzIDIsIG5vIG5lZWQgdG8gc2V0IGxh
eW91dCAqLworCisJLyogRlMgKi8KKwlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmRfb3IoY3R4LCBj
dHgtPmkyYy50eF9wMl9jbGllbnQsCisJCQkJICAgIEFVRElPX0NIQU5ORUxfU1RBVFVTXzQsCisJ
CQkJICAgIDB4ZjAsIEFVRElPX0ZTXzQ4Syk7CisJLyogd29yZCBsZW5ndGggKi8KKwlyZXQgfD0g
YW54NzYyNV93cml0ZV9hbmRfb3IoY3R4LCBjdHgtPmkyYy50eF9wMl9jbGllbnQsCisJCQkJICAg
IEFVRElPX0NIQU5ORUxfU1RBVFVTXzUsCisJCQkJICAgIDB4ZjAsIEFVRElPX1dfTEVOXzI0XzI0
TUFYKTsKKwkvKiBJMlMgKi8KKwlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJj
LnR4X3AyX2NsaWVudCwKKwkJCQlBVURJT19DSEFOTkVMX1NUQVRVU182LCBJMlNfU0xBVkVfTU9E
RSk7CisJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMudHhfcDJfY2xpZW50
LAorCQkJCSBBVURJT19DT05UUk9MX1JFR0lTVEVSLCB+VERNX1RJTUlOR19NT0RFKTsKKwkvKiBh
dWRpbyBjaGFuZ2UgZmxhZyAqLworCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5p
MmMucnhfcDBfY2xpZW50LAorCQkJCUFQX0FWX1NUQVRVUywgQVBfQVVESU9fQ0hHKTsKKworCWlm
IChyZXQgPCAwKQorCQlEUk1fRVJST1IoImZhaWxlZCB0byBjb25maWcgYXVkaW8uXG4iKTsKKwor
CXJldHVybiByZXQ7Cit9CisKKy8qIHJlZHVjdGlvbiBvZiBmcmFjdGlvbiBhL2IgKi8KK3N0YXRp
YyB2b2lkIGFueDc2MjVfcmVkdWN0aW9uX29mX2FfZnJhY3Rpb24odW5zaWduZWQgbG9uZyAqYSwg
dW5zaWduZWQgbG9uZyAqYikKK3sKKwl1bnNpZ25lZCBsb25nIGdjZF9udW07CisJdW5zaWduZWQg
bG9uZyB0bXBfYSwgdG1wX2I7CisJdTMyIGkgPSAxOworCisJZ2NkX251bSA9IGdjZCgqYSwgKmIp
OworCSphIC89IGdjZF9udW07CisJKmIgLz0gZ2NkX251bTsKKworCXRtcF9hID0gKmE7CisJdG1w
X2IgPSAqYjsKKworCXdoaWxlICgoKmEgPiBNQVhfVU5TSUdORURfMjRCSVQpIHx8ICgqYiA+IE1B
WF9VTlNJR05FRF8yNEJJVCkpIHsKKwkJaSsrOworCQkqYSA9IHRtcF9hIC8gaTsKKwkJKmIgPSB0
bXBfYiAvIGk7CisJfQorCisJLyoKKwkgKiBpbiB0aGUgZW5kLCBtYWtlIGEsIGIgbGFyZ2VyIHRv
IGhhdmUgaGlnaGVyIE9ERkMgUExMCisJICogb3V0cHV0IGZyZXF1ZW5jeSBhY2N1cmFjeQorCSAq
LworCXdoaWxlICgoKmEgPCBNQVhfVU5TSUdORURfMjRCSVQpICYmICgqYiA8IE1BWF9VTlNJR05F
RF8yNEJJVCkpIHsKKwkJKmEgPDw9IDE7CisJCSpiIDw8PSAxOworCX0KKworCSphID4+PSAxOwor
CSpiID4+PSAxOworfQorCitzdGF0aWMgaW50IGFueDc2MjVfY2FsY3VsYXRlX21fbih1MzIgcGl4
ZWxjbG9jaywKKwkJCQkgdW5zaWduZWQgbG9uZyAqbSwKKwkJCQkgdW5zaWduZWQgbG9uZyAqbiwK
KwkJCQkgdTggKnBvc3RfZGl2aWRlcikKK3sKKwlpZiAocGl4ZWxjbG9jayA+IFBMTF9PVVRfRlJF
UV9BQlNfTUFYIC8gUE9TVF9ESVZJREVSX01JTikgeworCQkvKiBwaXhlbCBjbG9jayBmcmVxdWVu
Y3kgaXMgdG9vIGhpZ2ggKi8KKwkJRFJNX0VSUk9SKCJwaXhlbGNsb2NrIHRvbyBoaWdoLCBhY3Qo
JWQpLCBtYXhpbXVtKCVsdSlcbiIsCisJCQkgIHBpeGVsY2xvY2ssCisJCQkgIFBMTF9PVVRfRlJF
UV9BQlNfTUFYIC8gUE9TVF9ESVZJREVSX01JTik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKwor
CWlmIChwaXhlbGNsb2NrIDwgUExMX09VVF9GUkVRX0FCU19NSU4gLyBQT1NUX0RJVklERVJfTUFY
KSB7CisJCS8qIHBpeGVsIGNsb2NrIGZyZXF1ZW5jeSBpcyB0b28gbG93ICovCisJCURSTV9FUlJP
UigicGl4ZWxjbG9jayB0b28gbG93LCBhY3QoJWQpLCBtYXhpbXVtKCVsdSlcbiIsCisJCQkgIHBp
eGVsY2xvY2ssCisJCQkgIFBMTF9PVVRfRlJFUV9BQlNfTUlOIC8gUE9TVF9ESVZJREVSX01BWCk7
CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCWZvciAoKnBvc3RfZGl2aWRlciA9IDE7CisJCXBp
eGVsY2xvY2sgPCAoUExMX09VVF9GUkVRX01JTiAvICgqcG9zdF9kaXZpZGVyKSk7KQorCQkqcG9z
dF9kaXZpZGVyICs9IDE7CisKKwlpZiAoKnBvc3RfZGl2aWRlciA+IFBPU1RfRElWSURFUl9NQVgp
IHsKKwkJZm9yICgqcG9zdF9kaXZpZGVyID0gMTsKKwkJCShwaXhlbGNsb2NrIDwKKwkJCSAoUExM
X09VVF9GUkVRX0FCU19NSU4gLyAoKnBvc3RfZGl2aWRlcikpKTspCisJCQkqcG9zdF9kaXZpZGVy
ICs9IDE7CisKKwkJaWYgKCpwb3N0X2RpdmlkZXIgPiBQT1NUX0RJVklERVJfTUFYKSB7CisJCQlE
Uk1fRVJST1IoImNhbm5vdCBmaW5kIHByb3BlcnR5IHBvc3RfZGl2aWRlciglZClcbiIsCisJCQkJ
ICAqcG9zdF9kaXZpZGVyKTsKKwkJCXJldHVybiAtRURPTTsKKwkJfQorCX0KKworCS8qIHBhdGNo
IHRvIGltcHJvdmUgdGhlIGFjY3VyYWN5ICovCisJaWYgKCpwb3N0X2RpdmlkZXIgPT0gNykgewor
CQkvKiAyNywwMDAsMDAwIGlzIG5vdCBkaXZpc2libGUgYnkgNyAqLworCQkqcG9zdF9kaXZpZGVy
ID0gODsKKwl9IGVsc2UgaWYgKCpwb3N0X2RpdmlkZXIgPT0gMTEpIHsKKwkJLyogMjcsMDAwLDAw
MCBpcyBub3QgZGl2aXNpYmxlIGJ5IDExICovCisJCSpwb3N0X2RpdmlkZXIgPSAxMjsKKwl9IGVs
c2UgaWYgKCgqcG9zdF9kaXZpZGVyID09IDEzKSB8fCAoKnBvc3RfZGl2aWRlciA9PSAxNCkpIHsK
KwkJLyoyNywwMDAsMDAwIGlzIG5vdCBkaXZpc2libGUgYnkgMTMgb3IgMTQqLworCQkqcG9zdF9k
aXZpZGVyID0gMTU7CisJfQorCisJaWYgKHBpeGVsY2xvY2sgKiAoKnBvc3RfZGl2aWRlcikgPiBQ
TExfT1VUX0ZSRVFfQUJTX01BWCkgeworCQlEUk1fRVJST1IoImFjdCBjbG9jaygldSkgbGFyZ2Ug
dGhhbiBtYXhpbXVtKCVsdSlcbiIsCisJCQkgIHBpeGVsY2xvY2sgKiAoKnBvc3RfZGl2aWRlciks
CisJCQkgIFBMTF9PVVRfRlJFUV9BQlNfTUFYKTsKKwkJcmV0dXJuIC1FRE9NOworCX0KKworCSpt
ID0gcGl4ZWxjbG9jazsKKwkqbiA9IFhUQUxfRlJRIC8gKCpwb3N0X2RpdmlkZXIpOworCisJYW54
NzYyNV9yZWR1Y3Rpb25fb2ZfYV9mcmFjdGlvbihtLCBuKTsKKworCXJldHVybiAwOworfQorCitz
dGF0aWMgaW50IGFueDc2MjVfb2RmY19jb25maWcoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAor
CQkJICAgICAgIHU4IHBvc3RfZGl2aWRlcikKK3sKKwlpbnQgcmV0OworCisJLyogY29uZmlnIGlu
cHV0IHJlZmVyZW5jZSBjbG9jayBmcmVxdWVuY3kgMjdNSHovMTkuMk1IeiAqLworCXJldCA9IGFu
eDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCBNSVBJX0RJR0lUQUxf
UExMXzE2LAorCQkJCX4oUkVGX0NMS18yNzAwMEtIWiA8PCBNSVBJX0ZSRUZfRF9JTkQpKTsKKwly
ZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9E
SUdJVEFMX1BMTF8xNiwKKwkJCQkoUkVGX0NMS18yNzAwMEtIWiA8PCBNSVBJX0ZSRUZfRF9JTkQp
KTsKKwkvKiBwb3N0IGRpdmlkZXIgKi8KKwlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBj
dHgtPmkyYy5yeF9wMV9jbGllbnQsCisJCQkJIE1JUElfRElHSVRBTF9QTExfOCwgMHgwZik7CisJ
cmV0IHw9IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIE1JUElf
RElHSVRBTF9QTExfOCwKKwkJCQlwb3N0X2RpdmlkZXIgPDwgNCk7CisKKwkvKiBhZGQgcGF0Y2gg
Zm9yIE1JUzItMTI1ICg1cGNzIEFOWDc2MjUgZmFpbCBBVEUgTUJJU1QgdGVzdCkgKi8KKwlyZXQg
fD0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIE1JUElfRElH
SVRBTF9QTExfNywKKwkJCQkgfk1JUElfUExMX1ZDT19UVU5FX1JFR19WQUwpOworCisJLyogcmVz
ZXQgT0RGQyBQTEwgKi8KKwlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy5y
eF9wMV9jbGllbnQsIE1JUElfRElHSVRBTF9QTExfNywKKwkJCQkgfk1JUElfUExMX1JFU0VUX04p
OworCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCBN
SVBJX0RJR0lUQUxfUExMXzcsCisJCQkJTUlQSV9QTExfUkVTRVRfTik7CisKKwlpZiAocmV0IDwg
MCkKKwkJRFJNX0VSUk9SKCJJTyBlcnJvci5cbiIpOworCisJcmV0dXJuIHJldDsKK30KKworc3Rh
dGljIGludCBhbng3NjI1X2RzaV92aWRlb190aW1pbmdfY29uZmlnKHN0cnVjdCBhbng3NjI1X2Rh
dGEgKmN0eCkKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKwl1
bnNpZ25lZCBsb25nIG0sIG47CisJdTE2IGh0b3RhbDsKKwlpbnQgcmV0OworCXU4IHBvc3RfZGl2
aWRlciA9IDA7CisKKwlyZXQgPSBhbng3NjI1X2NhbGN1bGF0ZV9tX24oY3R4LT5kdC5waXhlbGNs
b2NrLm1pbiAqIDEwMDAsCisJCQkJICAgICZtLCAmbiwgJnBvc3RfZGl2aWRlcik7CisKKwlpZiAo
cmV0KSB7CisJCURSTV9FUlJPUigiY2Fubm90IGdldCBwcm9wZXJ0eSBtIG4gdmFsdWUuXG4iKTsK
KwkJcmV0dXJuIHJldDsKKwl9CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJjb21wdXRl
IE0oJWx1KSwgTiglbHUpLCBkaXZpZGVyKCVkKS5cbiIsCisJCQkgICAgIG0sIG4sIHBvc3RfZGl2
aWRlcik7CisKKwkvKiBjb25maWd1cmUgcGl4ZWwgY2xvY2sgKi8KKwlyZXQgPSBhbng3NjI1X3Jl
Z193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwgUElYRUxfQ0xPQ0tfTCwKKwkJCQko
Y3R4LT5kdC5waXhlbGNsb2NrLm1pbiAvIDEwMDApICYgMHhGRik7CisJcmV0IHw9IGFueDc2MjVf
cmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LCBQSVhFTF9DTE9DS19ILAorCQkJ
CSAoY3R4LT5kdC5waXhlbGNsb2NrLm1pbiAvIDEwMDApID4+IDgpOworCS8qIGxhbmUgY291bnQg
Ki8KKwlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQs
CisJCQlNSVBJX0xBTkVfQ1RSTF8wLCAweGZjKTsKKwlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihj
dHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKKwkJCQlNSVBJX0xBTkVfQ1RSTF8wLCAzKTsKKwor
CS8qIEh0b3RhbCAqLworCWh0b3RhbCA9IGN0eC0+ZHQuaGFjdGl2ZS5taW4gKyBjdHgtPmR0Lmhm
cm9udF9wb3JjaC5taW4gKworCQljdHgtPmR0LmhiYWNrX3BvcmNoLm1pbiArIGN0eC0+ZHQuaHN5
bmNfbGVuLm1pbjsKKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9w
Ml9jbGllbnQsCisJCQlIT1JJWk9OVEFMX1RPVEFMX1BJWEVMU19MLCBodG90YWwgJiAweEZGKTsK
KwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQsCisJ
CQlIT1JJWk9OVEFMX1RPVEFMX1BJWEVMU19ILCBodG90YWwgPj4gOCk7CisJLyogSGFjdGl2ZSAq
LworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwK
KwkJCUhPUklaT05UQUxfQUNUSVZFX1BJWEVMU19MLCBjdHgtPmR0LmhhY3RpdmUubWluICYgMHhG
Rik7CisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50
LAorCQkJSE9SSVpPTlRBTF9BQ1RJVkVfUElYRUxTX0gsIGN0eC0+ZHQuaGFjdGl2ZS5taW4gPj4g
OCk7CisJLyogSEZQICovCisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMu
cnhfcDJfY2xpZW50LAorCQkJSE9SSVpPTlRBTF9GUk9OVF9QT1JDSF9MLCBjdHgtPmR0Lmhmcm9u
dF9wb3JjaC5taW4pOworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4
X3AyX2NsaWVudCwKKwkJCUhPUklaT05UQUxfRlJPTlRfUE9SQ0hfSCwKKwkJCWN0eC0+ZHQuaGZy
b250X3BvcmNoLm1pbiA+PiA4KTsKKwkvKiBIV1MgKi8KKwlyZXQgfD0gYW54NzYyNV9yZWdfd3Jp
dGUoY3R4LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQsCisJCQlIT1JJWk9OVEFMX1NZTkNfV0lEVEhf
TCwgY3R4LT5kdC5oc3luY19sZW4ubWluKTsKKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4
LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQsCisJCQlIT1JJWk9OVEFMX1NZTkNfV0lEVEhfSCwgY3R4
LT5kdC5oc3luY19sZW4ubWluID4+IDgpOworCS8qIEhCUCAqLworCXJldCB8PSBhbng3NjI1X3Jl
Z193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwKKwkJCUhPUklaT05UQUxfQkFDS19Q
T1JDSF9MLCBjdHgtPmR0LmhiYWNrX3BvcmNoLm1pbik7CisJcmV0IHw9IGFueDc2MjVfcmVnX3dy
aXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAorCQkJSE9SSVpPTlRBTF9CQUNLX1BPUkNI
X0gsIGN0eC0+ZHQuaGJhY2tfcG9yY2gubWluID4+IDgpOworCS8qIFZhY3RpdmUgKi8KKwlyZXQg
fD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQsIEFDVElWRV9M
SU5FU19MLAorCQkJY3R4LT5kdC52YWN0aXZlLm1pbik7CisJcmV0IHw9IGFueDc2MjVfcmVnX3dy
aXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LCBBQ1RJVkVfTElORVNfSCwKKwkJCWN0eC0+
ZHQudmFjdGl2ZS5taW4gPj4gOCk7CisJLyogVkZQICovCisJcmV0IHw9IGFueDc2MjVfcmVnX3dy
aXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAorCQkJVkVSVElDQUxfRlJPTlRfUE9SQ0gs
IGN0eC0+ZHQudmZyb250X3BvcmNoLm1pbik7CisJLyogVldTICovCisJcmV0IHw9IGFueDc2MjVf
cmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAorCQkJVkVSVElDQUxfU1lOQ19X
SURUSCwgY3R4LT5kdC52c3luY19sZW4ubWluKTsKKwkvKiBWQlAgKi8KKwlyZXQgfD0gYW54NzYy
NV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQsCisJCQlWRVJUSUNBTF9CQUNL
X1BPUkNILCBjdHgtPmR0LnZiYWNrX3BvcmNoLm1pbik7CisJLyogTSB2YWx1ZSAqLworCXJldCB8
PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKKwkJCU1JUElf
UExMX01fTlVNXzIzXzE2LCAobSA+PiAxNikgJiAweGZmKTsKKwlyZXQgfD0gYW54NzYyNV9yZWdf
d3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCisJCQlNSVBJX1BMTF9NX05VTV8xNV84
LCAobSA+PiA4KSAmIDB4ZmYpOworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+
aTJjLnJ4X3AxX2NsaWVudCwKKwkJCU1JUElfUExMX01fTlVNXzdfMCwgKG0gJiAweGZmKSk7CisJ
LyogTiB2YWx1ZSAqLworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4
X3AxX2NsaWVudCwKKwkJCU1JUElfUExMX05fTlVNXzIzXzE2LCAobiA+PiAxNikgJiAweGZmKTsK
KwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCisJ
CQlNSVBJX1BMTF9OX05VTV8xNV84LCAobiA+PiA4KSAmIDB4ZmYpOworCXJldCB8PSBhbng3NjI1
X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9QTExfTl9OVU1fN18w
LAorCQkJKG4gJiAweGZmKSk7CisJLyogZGlmZiAqLworCXJldCB8PSBhbng3NjI1X3JlZ193cml0
ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKKwkJCU1JUElfRElHSVRBTF9BREpfMSwgMHgz
Nyk7CisKKwlyZXQgfD0gYW54NzYyNV9vZGZjX2NvbmZpZyhjdHgsIHBvc3RfZGl2aWRlciAtIDEp
OworCisJaWYgKHJldCA8IDApCisJCURSTV9FUlJPUigibWlwaSBkc2kgc2V0dXAgSU8gZXJyb3Iu
XG4iKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV9zd2FwX2RzaV9s
YW5lMyhzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJaW50IHZhbDsKKworCS8qIHN3YXAg
TUlQSS1EU0kgZGF0YSBsYW5lIDMgUCBhbmQgTiAqLworCXZhbCA9IGFueDc2MjVfcmVnX3JlYWQo
Y3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIE1JUElfU1dBUCk7CisJaWYgKHZhbCA8IDApIHsK
KwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGFjY2VzcyBNSVBJX1NXQVAuXG4iKTsKKwkJcmV0dXJu
IC1FSU87CisJfQorCisJdmFsIHw9ICgxIDw8IE1JUElfU1dBUF9DSDMpOworCXJldHVybiBhbng3
NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9TV0FQLCB2YWwp
OworfQorCitzdGF0aWMgaW50IGFueDc2MjVfYXBpX2RzaV9jb25maWcoc3RydWN0IGFueDc2MjVf
ZGF0YSAqY3R4KQorCit7CisJaW50IHZhbCwgcmV0OworCisJLyogc3dhcCBNSVBJLURTSSBkYXRh
IGxhbmUgMyBQIGFuZCBOICovCisJcmV0ID0gYW54NzYyNV9zd2FwX2RzaV9sYW5lMyhjdHgpOwor
CWlmIChyZXQgPCAwKSB7CisJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBzd2FwIGRzaSBsYW5lIDMg
ZmFpbGVkLlxuIik7CisJCXJldHVybiByZXQ7CisJfQorCisJLyogRFNJIGNsb2NrIHNldHRpbmdz
ICovCisJdmFsID0gKDAgPDwgTUlQSV9IU19QV0RfQ0xLKQkJfAorCQkoMCA8PCBNSVBJX0hTX1JU
X0NMSykJCXwKKwkJKDAgPDwgTUlQSV9QRF9DTEspCQl8CisJCSgxIDw8IE1JUElfQ0xLX1JUX01B
TlVBTF9QRF9FTikJfAorCQkoMSA8PCBNSVBJX0NMS19IU19NQU5VQUxfUERfRU4pCXwKKwkJKDAg
PDwgTUlQSV9DTEtfREVUX0RFVF9CWVBBU1MpCXwKKwkJKDAgPDwgTUlQSV9DTEtfTUlTU19DVFJM
KQl8CisJCSgwIDw8IE1JUElfUERfTFBUWF9DSF9NQU5VQUxfUERfRU4pOworCXJldCA9IGFueDc2
MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAorCQkJCU1JUElfUEhZX0NP
TlRST0xfMywgdmFsKTsKKworCS8qCisJICogRGVjcmVhc2VkIEhTIHByZXBhcmUgdGltaW5nIGRl
bGF5IGZyb20gMTYwbnMgdG8gODBucyB3b3JrIHdpdGgKKwkgKiAgICAgYSkgRHJhZ29uIGJvYXJk
IDgxMCBzZXJpZXMgKFF1YWxjb21tIEFQKQorCSAqICAgICBiKSBNb3ZpbmcgUGl4ZWwgRFNJIHNv
dXJjZSAoUEczQSBwYXR0ZXJuIGdlbmVyYXRvciArCisJICoJUDMzMiBELVBIWSBQcm9iZSkgZGVm
YXVsdCBELVBIWSB0aW1pbmcKKwkgKgk1bnMvc3RlcAorCSAqLworCXJldCB8PSBhbng3NjI1X3Jl
Z193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKKwkJCQkgTUlQSV9USU1FX0hTX1BS
UFIsIDB4MTApOworCisJLyogZW5hYmxlIERTSSBtb2RlKi8KKwlyZXQgfD0gYW54NzYyNV93cml0
ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9ESUdJVEFMX1BMTF8xOCwKKwkJ
CQlTRUxFQ1RfRFNJIDw8IE1JUElfRFBJX1NFTEVDVCk7CisKKwlyZXQgfD0gYW54NzYyNV9kc2lf
dmlkZW9fdGltaW5nX2NvbmZpZyhjdHgpOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9FUlJPUigi
ZHNpIHZpZGVvIHRpbWluZyBjb25maWcgZmFpbGVkXG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisK
KwkvKiB0b2dnbGUgbSwgbiByZWFkeSAqLworCXJldCA9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwg
Y3R4LT5pMmMucnhfcDFfY2xpZW50LCBNSVBJX0RJR0lUQUxfUExMXzYsCisJCQkJfihNSVBJX01f
TlVNX1JFQURZIHwgTUlQSV9OX05VTV9SRUFEWSkpOworCXVzbGVlcF9yYW5nZSgxMDAwLCAxMTAw
KTsKKwlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwg
TUlQSV9ESUdJVEFMX1BMTF82LAorCQkJCU1JUElfTV9OVU1fUkVBRFkgfCBNSVBJX05fTlVNX1JF
QURZKTsKKworCS8qIGNvbmZpZ3VyZSBpbnRlZ2VyIHN0YWJsZSByZWdpc3RlciAqLworCXJldCB8
PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKKwkJCQkgTUlQ
SV9WSURFT19TVEFCTEVfQ05ULCAweDAyKTsKKwkvKiBwb3dlciBvbiBNSVBJIFJYICovCisJcmV0
IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAorCQkJCSBN
SVBJX0xBTkVfQ1RSTF8xMCwgMHgwMCk7CisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwg
Y3R4LT5pMmMucnhfcDFfY2xpZW50LAorCQkJCSBNSVBJX0xBTkVfQ1RSTF8xMCwgMHg4MCk7CisK
KwlpZiAocmV0IDwgMCkKKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IG1pcGkgZHNpIGVuYWJsZSBp
bml0IGZhaWxlZC5cbiIpOworCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBhbng3NjI1
X2RzaV9jb25maWcoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCXN0cnVjdCBkZXZpY2Ug
KmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2OworCWludCByZXQ7CisKKwlEUk1fREVWX0RFQlVHX0RS
SVZFUihkZXYsICJjb25maWcgZHNpLlxuIik7CisKKwkvKiBEU0MgZGlzYWJsZSAqLworCXJldCA9
IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCVJfRFND
X0NUUkxfMCwgfkRTQ19FTik7CisKKwlyZXQgfD0gYW54NzYyNV9hcGlfZHNpX2NvbmZpZyhjdHgp
OworCisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGFwaSBkc2kgY29u
ZmlnIGVycm9yLlxuIik7CisJCXJldHVybiByZXQ7CisJfQorCisJLyogc2V0IE1JUEkgUlggRU4g
Ki8KKwlyZXQgPSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAor
CQkJICAgICAgIEFQX0FWX1NUQVRVUywgQVBfTUlQSV9SWF9FTik7CisJLyogY2xlYXIgbXV0ZSBm
bGFnICovCisJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xp
ZW50LAorCQkJCSBBUF9BVl9TVEFUVVMsICh1OCl+QVBfTUlQSV9NVVRFKTsKKwlpZiAocmV0IDwg
MCkKKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGVuYWJsZSBtaXBpIHJ4IGZhaWxlZC5cbiIpOwor
CWVsc2UKKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAic3VjY2VzcyB0byBjb25maWcgRFNJ
XG4iKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV9hcGlfZHBpX2Nv
bmZpZyhzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJdTE2IGZyZXEgPSBjdHgtPmR0LnBp
eGVsY2xvY2subWluIC8gMTAwMDsKKwlpbnQgcmV0OworCisJLyogY29uZmlndXJlIHBpeGVsIGNs
b2NrICovCisJcmV0ID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGll
bnQsCisJCQkJUElYRUxfQ0xPQ0tfTCwgZnJlcSAmIDB4RkYpOworCXJldCB8PSBhbng3NjI1X3Jl
Z193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkgUElYRUxfQ0xPQ0tfSCwg
KGZyZXEgPj4gOCkpOworCisJLyogc2V0IERQSSBtb2RlICovCisJLyogc2V0IHRvIERQSSBQTEwg
bW9kdWxlIHNlbCAqLworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4
X3AxX2NsaWVudCwKKwkJCQkgTUlQSV9ESUdJVEFMX1BMTF85LCAweDIwKTsKKwkvKiBwb3dlciBk
b3duIE1JUEkgKi8KKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9w
MV9jbGllbnQsCisJCQkJIE1JUElfTEFORV9DVFJMXzEwLCAweDA4KTsKKwkvKiBlbmFibGUgRFBJ
IG1vZGUgKi8KKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMV9j
bGllbnQsCisJCQkJIE1JUElfRElHSVRBTF9QTExfMTgsIDB4MUMpOworCS8qIHNldCBmaXJzdCBl
ZGdlICovCisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMudHhfcDJfY2xp
ZW50LAorCQkJCSBWSURFT19DT05UUk9MXzAsIDB4MDUpOworCWlmIChyZXQgPCAwKQorCQlEUk1f
RVJST1IoIklPIGVycm9yIDogZHBpIHBoeSBzZXQgZmFpbGVkLlxuIik7CisKKwlyZXR1cm4gcmV0
OworfQorCitzdGF0aWMgaW50IGFueDc2MjVfZHBpX2NvbmZpZyhzdHJ1Y3QgYW54NzYyNV9kYXRh
ICpjdHgpCit7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisJaW50
IHJldDsKKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImNvbmZpZyBkcGlcbiIpOworCisJ
LyogRFNDIGRpc2FibGUgKi8KKwlyZXQgPSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+aTJj
LnJ4X3AwX2NsaWVudCwKKwkJCQlSX0RTQ19DVFJMXzAsIH5EU0NfRU4pOworCWlmIChyZXQgPCAw
KSB7CisJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBkaXNhYmxlIGRzYyBmYWlsZWQuXG4iKTsKKwkJ
cmV0dXJuIHJldDsKKwl9CisKKwlyZXQgPSBhbng3NjI1X2NvbmZpZ19iaXRfbWF0cml4KGN0eCk7
CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0VSUk9SKCJjb25maWcgYml0IG1hdHJpeCBmYWlsZWQu
XG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXQgPSBhbng3NjI1X2FwaV9kcGlfY29uZmln
KGN0eCk7CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0VSUk9SKCJtaXBpIHBoeShkcGkpIHNldHVw
IGZhaWxlZC5cbiIpOworCQlyZXR1cm4gcmV0OworCX0KKworCS8qIHNldCBNSVBJIFJYIEVOICov
CisJcmV0ID0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJ
CSAgICAgICBBUF9BVl9TVEFUVVMsIEFQX01JUElfUlhfRU4pOworCS8qIGNsZWFyIG11dGUgZmxh
ZyAqLworCXJldCB8PSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVu
dCwKKwkJCQkgQVBfQVZfU1RBVFVTLCAodTgpfkFQX01JUElfTVVURSk7CisJaWYgKHJldCA8IDAp
CisJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBlbmFibGUgbWlwaSByeCBmYWlsZWQuXG4iKTsKKwor
CXJldHVybiByZXQ7Cit9CisKK2NvbnN0IHU4IEFOWF9PVUlbM10gPSB7IDB4MDAsIDB4MjIsIDB4
QjkgfTsKK3N0YXRpYyBpbnQgaXNfYW54X2RvbmdsZShzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgp
Cit7CisJdTggYnVmWzNdOworCisJLyogMHgwNTAwfjB4MDUwMjogQlJBTkNIX0lFRUVfT1VJICov
CisJc3BfdHhfYXV4X2RwY2RyZWFkX2J5dGVzKGN0eCwgMHgwMCwgMHgwNSwgMHgwMCwgc2l6ZW9m
KGJ1ZiksIGJ1Zik7CisJaWYgKG1lbWNtcChidWYsIEFOWF9PVUksIHNpemVvZihidWYpKSA9PSAw
KQorCQlyZXR1cm4gMDsKKworCXJldHVybiAtRU5YSU87Cit9CisKK3N0YXRpYyB2b2lkIHNwX3R4
X2dldF9yeF9idyhzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsIHU4ICpidykKK3sKKwl1OCBkYXRh
X2J1Zls0XTsKKwkvKgorCSAqIFdoZW4gQU5YIGRvbmdsZSBjb25uZWN0ZWQsIGlmIENISVBfSUQg
PSAweDc3NTAsIGJhbmR3aWR0aCBpcyA2Ljc1RywKKwkgKiBiZWNhdXNlIEFOWDc3NTAgRFBDRCAw
eDA1Mnggd2FzIG5vdCBhdmFpbGFibGUuCisJICovCisJaWYgKCFpc19hbnhfZG9uZ2xlKGN0eCkp
IHsKKwkJc3BfdHhfYXV4X2RwY2RyZWFkX2J5dGVzKGN0eCwgMHgwMCwgMHgwNSwgMHgwMywgMHgw
NCwgZGF0YV9idWYpOworCQlpZiAoZGF0YV9idWZbMF0gPT0gMHgzNyAmJiBkYXRhX2J1ZlsxXSA9
PSAweDM3ICYmCisJCSAgICBkYXRhX2J1ZlsyXSA9PSAweDM1ICYmIGRhdGFfYnVmWzNdID09IDB4
MzApIHsKKwkJCS8qIDB4MTkgOiA2Ljc1RyAqLworCQkJKmJ3ID0gMHgxOTsKKwkJfSBlbHNlIHsK
KwkJCXNwX3R4X2F1eF9kcGNkcmVhZF9ieXRlcyhjdHgsIDB4MDAsIDB4MDUsIDB4MjEsIDEsIGJ3
KTsKKwkJCS8qCisJCQkgKiBzb21lIEFOWCBkb25nbGUgcmVhZCBvdXQgdmFsdWUgMCwKKwkJCSAq
IHJldHJ5IHN0YW5kYXJkIHJlZ2lzdGVyLgorCQkJICovCisJCQlpZiAoKCgqYncpID09IDApIHx8
ICgoKmJ3KSA9PSAweGZmKSkKKwkJCQlzcF90eF9hdXhfZHBjZHJlYWRfYnl0ZXMoY3R4LCAweDAw
LCAweDAwLAorCQkJCQkJCSBEUENEX01BWF9MSU5LX1JBVEUsCisJCQkJCQkJIDEsIGJ3KTsKKwkJ
fQorCX0gZWxzZSB7CisJCXNwX3R4X2F1eF9kcGNkcmVhZF9ieXRlcyhjdHgsIDB4MDAsIDB4MDAs
CisJCQkJCSBEUENEX01BWF9MSU5LX1JBVEUsIDEsIGJ3KTsKKwl9Cit9CisKK3N0YXRpYyB2b2lk
IGFueDc2MjVfZHBfc3RhcnQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCWludCByZXQ7
CisKKwlpZiAoIWN0eC0+ZGlzcGxheV90aW1pbmdfdmFsaWQpIHsKKwkJRFJNX0VSUk9SKCJtaXBp
IGRybSBoYXZlbid0IHNldCBkaXNwbGF5IHRpbWluZyB5ZXQuXG4iKTsKKwkJcmV0dXJuOworCX0K
KworCWFueDc2MjVfY29uZmlnX2F1ZGlvX2lucHV0KGN0eCk7CisKKwlpZiAoY3R4LT5wZGF0YS5k
c2lfc3VwcG9ydGVkKQorCQlyZXQgPSBhbng3NjI1X2RzaV9jb25maWcoY3R4KTsKKwllbHNlCisJ
CXJldCA9IGFueDc2MjVfZHBpX2NvbmZpZyhjdHgpOworCisJaWYgKHJldCA8IDApCisJCURSTV9F
UlJPUigiTUlQSSBwaHkgc2V0dXAgZXJyb3IuXG4iKTsKK30KKworc3RhdGljIHZvaWQgYW54NzYy
NV9kcF9zdG9wKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sKKwlzdHJ1Y3QgZGV2aWNlICpk
ZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKwlpbnQgcmV0OworCisJRFJNX0RFVl9ERUJVR19EUklW
RVIoZGV2LCAic3RvcCBkcCBvdXRwdXRcbiIpOworCisJLyoKKwkgKiB2aWRlbyBkaXNhYmxlOiAw
eDcyOjA4IGJpdCA3ID0gMDsKKwkgKiBhdWRpbyBkaXNhYmxlOiAweDcwOjg3IGJpdCAwID0gMDsK
KwkgKi8KKwlyZXQgPSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+aTJjLnR4X3AwX2NsaWVu
dCwgMHg4NywgMHhmZSk7CisJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMu
dHhfcDJfY2xpZW50LCAweDA4LCAweDdmKTsKKworCXJldCB8PSBhbng3NjI1X3ZpZGVvX211dGVf
Y29udHJvbChjdHgsIDEpOworCWlmIChyZXQgPCAwKQorCQlEUk1fRVJST1IoIklPIGVycm9yIDog
bXV0ZSB2aWRlbyBmYWlsZWRcbiIpOworfQorCitzdGF0aWMgaW50IHNwX3R4X3JzdF9hdXgoc3Ry
dWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCWludCByZXQ7CisKKwlyZXQgPSBhbng3NjI1X3dy
aXRlX29yKGN0eCwgY3R4LT5pMmMudHhfcDJfY2xpZW50LCBSU1RfQ1RSTDIsCisJCQkgICAgICAg
QVVYX1JTVCk7CisJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMudHhfcDJf
Y2xpZW50LCBSU1RfQ1RSTDIsCisJCQkJIH5BVVhfUlNUKTsKKwlyZXR1cm4gcmV0OworfQorCitz
dGF0aWMgaW50IHNwX3R4X2F1eF93cihzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsIHU4IG9mZnNl
dCkKK3sKKwlpbnQgcmV0OworCisJcmV0ID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmky
Yy5yeF9wMF9jbGllbnQsCisJCQkJQVBfQVVYX0JVRkZfU1RBUlQsIG9mZnNldCk7CisJcmV0IHw9
IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCSBBUF9B
VVhfQ09NTUFORCwgMHgwNCk7CisJcmV0IHw9IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmky
Yy5yeF9wMF9jbGllbnQsCisJCQkJQVBfQVVYX0NUUkxfU1RBVFVTLCBBUF9BVVhfQ1RSTF9PUF9F
Tik7CisJcmV0dXJuIChyZXQgfCB3YWl0X2F1eF9vcF9maW5pc2goY3R4KSk7Cit9CisKK3N0YXRp
YyBpbnQgc3BfdHhfYXV4X3JkKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwgdTggbGVuX2NtZCkK
K3sKKwlpbnQgcmV0OworCisJcmV0ID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5y
eF9wMF9jbGllbnQsCisJCQkJQVBfQVVYX0NPTU1BTkQsIGxlbl9jbWQpOworCXJldCB8PSBhbng3
NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCUFQX0FVWF9DVFJM
X1NUQVRVUywgQVBfQVVYX0NUUkxfT1BfRU4pOworCXJldHVybiAocmV0IHwgd2FpdF9hdXhfb3Bf
ZmluaXNoKGN0eCkpOworfQorCitzdGF0aWMgaW50IHNwX3R4X2dldF9lZGlkX2Jsb2NrKHN0cnVj
dCBhbng3NjI1X2RhdGEgKmN0eCkKK3sKKwlpbnQgYyA9IDA7CisJc3RydWN0IGRldmljZSAqZGV2
ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisKKwlzcF90eF9hdXhfd3IoY3R4LCAweDdlKTsKKwlzcF90
eF9hdXhfcmQoY3R4LCAweDAxKTsKKwljID0gYW54NzYyNV9yZWdfcmVhZChjdHgsIGN0eC0+aTJj
LnJ4X3AwX2NsaWVudCwgQVBfQVVYX0JVRkZfU1RBUlQpOworCWlmIChjIDwgMCkgeworCQlEUk1f
RVJST1IoIklPIGVycm9yIDogYWNjZXNzIEFVWCBCVUZGLlxuIik7CisJCXJldHVybiAtRUlPOwor
CX0KKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIiBFRElEIEJsb2NrID0gJWRcbiIsIGMg
KyAxKTsKKworCWlmIChjID4gTUFYX0VESURfQkxPQ0spCisJCWMgPSAxOworCisJcmV0dXJuIGM7
Cit9CisKK3N0YXRpYyBpbnQgZWRpZF9yZWFkKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKKwkJ
ICAgICB1OCBvZmZzZXQsIHU4ICpwYmxvY2tfYnVmKQoreworCWludCByZXQsIGNudDsKKwlzdHJ1
Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKworCWZvciAoY250ID0gMDsgY250
IDwgRURJRF9UUllfQ05UOyBjbnQrKykgeworCQlzcF90eF9hdXhfd3IoY3R4LCBvZmZzZXQpOwor
CQkvKiBzZXQgSTJDIHJlYWQgY29tIDB4MDEgbW90ID0gMCBhbmQgcmVhZCAxNiBieXRlcyAqLwor
CQlyZXQgPSBzcF90eF9hdXhfcmQoY3R4LCAweGYxKTsKKworCQlpZiAocmV0KSB7CisJCQlzcF90
eF9yc3RfYXV4KGN0eCk7CisJCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJlZGlkIHJlYWQg
ZmFpbGVkLCByZXNldCFcbiIpOworCQkJY250Kys7CisJCX0gZWxzZSB7CisJCQlyZXQgPSBhbng3
NjI1X3JlZ19ibG9ja19yZWFkKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCQkJICAg
ICBBUF9BVVhfQlVGRl9TVEFSVCwKKwkJCQkJCSAgICAgTUFYX0RQQ0RfQlVGRkVSX1NJWkUsCisJ
CQkJCQkgICAgIHBibG9ja19idWYpOworCQkJaWYgKCFyZXQpCisJCQkJYnJlYWs7CisJCX0KKwl9
CisKKwlpZiAoY250ID09IEVESURfVFJZX0NOVCkKKwkJcmV0dXJuIC1FSU87CisKKwlyZXR1cm4g
MDsKK30KKworc3RhdGljIGludCBzZWdtZW50c19lZGlkX3JlYWQoc3RydWN0IGFueDc2MjVfZGF0
YSAqY3R4LAorCQkJICAgICAgdTggc2VnbWVudCwgdTggKmJ1ZiwgdTggb2Zmc2V0KQoreworCXU4
IGNudDsKKwlpbnQgcmV0OworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2
OworCisJLyogd3JpdGUgYWRkcmVzcyBvbmx5ICovCisJcmV0ID0gYW54NzYyNV9yZWdfd3JpdGUo
Y3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJQVBfQVVYX0FERFJfN18wLCAweDMwKTsK
KwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJ
CQkJIEFQX0FVWF9DT01NQU5ELCAweDA0KTsKKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4
LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJIEFQX0FVWF9DVFJMX1NUQVRVUywKKwkJCQkg
QVBfQVVYX0NUUkxfQUREUk9OTFkgfCBBUF9BVVhfQ1RSTF9PUF9FTik7CisKKwlyZXQgfD0gd2Fp
dF9hdXhfb3BfZmluaXNoKGN0eCk7CisJLyogd3JpdGUgc2VnbWVudCBhZGRyZXNzICovCisJcmV0
IHw9IHNwX3R4X2F1eF93cihjdHgsIHNlZ21lbnQpOworCS8qIGRhdGEgcmVhZCAqLworCXJldCB8
PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkgQVBf
QVVYX0FERFJfN18wLCAweDUwKTsKKwlpZiAocmV0KSB7CisJCURSTV9FUlJPUigiSU8gZXJyb3Ig
OiBhdXggaW5pdGlhbCBmYWlsZWQuXG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlmb3IgKGNu
dCA9IDA7IGNudCA8IEVESURfVFJZX0NOVDsgY250KyspIHsKKwkJc3BfdHhfYXV4X3dyKGN0eCwg
b2Zmc2V0KTsKKwkJLyogc2V0IEkyQyByZWFkIGNvbSAweDAxIG1vdCA9IDAgYW5kIHJlYWQgMTYg
Ynl0ZXMgKi8KKwkJcmV0ID0gc3BfdHhfYXV4X3JkKGN0eCwgMHhmMSk7CisKKwkJaWYgKHJldCkg
eworCQkJcmV0ID0gc3BfdHhfcnN0X2F1eChjdHgpOworCQkJRFJNX0RFVl9FUlJPUihkZXYsICJz
ZWdtZW50IHJlYWQgZmFpbGVkLCByZXNldCFcbiIpOworCQkJY250Kys7CisJCX0gZWxzZSB7CisJ
CQlyZXQgPSBhbng3NjI1X3JlZ19ibG9ja19yZWFkKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50
LAorCQkJCQkJICAgICBBUF9BVVhfQlVGRl9TVEFSVCwKKwkJCQkJCSAgICAgTUFYX0RQQ0RfQlVG
RkVSX1NJWkUsIGJ1Zik7CisJCQlpZiAoIXJldCkKKwkJCQlicmVhazsKKwkJfQorCX0KKworCWlm
IChjbnQgPT0gRURJRF9UUllfQ05UKQorCQlyZXR1cm4gLUVJTzsKKworCXJldHVybiAwOworfQor
CitzdGF0aWMgaW50IHNwX3R4X2VkaWRfcmVhZChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCisJ
CQkgICB1OCAqcGVkaWRfYmxvY2tzX2J1ZikKK3sKKwl1OCBvZmZzZXQsIGVkaWRfcG9zOworCWlu
dCBjb3VudCwgYmxvY2tzX251bTsKKwl1OCBwYmxvY2tfYnVmW01BWF9EUENEX0JVRkZFUl9TSVpF
XTsKKwl1OCBpLCBqOworCXU4IGdfZWRpZF9icmVhayA9IDA7CisJaW50IHJldDsKKwlzdHJ1Y3Qg
ZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKworCS8qIGFkZHJlc3MgaW5pdGlhbCAq
LworCXJldCA9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAor
CQkJCUFQX0FVWF9BRERSXzdfMCwgMHg1MCk7CisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0
eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCSBBUF9BVVhfQUREUl8xNV84LCAwKTsKKwly
ZXQgfD0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJ
IEFQX0FVWF9BRERSXzE5XzE2LCAweGYwKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fRVJST1Io
ImFjY2VzcyBhdXggY2hhbm5lbCBJTyBlcnJvci5cbiIpOworCQlyZXR1cm4gLUVJTzsKKwl9CisK
KwlibG9ja3NfbnVtID0gc3BfdHhfZ2V0X2VkaWRfYmxvY2soY3R4KTsKKwlpZiAoYmxvY2tzX251
bSA8IDApCisJCXJldHVybiBibG9ja3NfbnVtOworCisJY291bnQgPSAwOworCisJZG8geworCQlz
d2l0Y2ggKGNvdW50KSB7CisJCWNhc2UgMDoKKwkJY2FzZSAxOgorCQkJZm9yIChpID0gMDsgaSA8
IDg7IGkrKykgeworCQkJCW9mZnNldCA9IChpICsgY291bnQgKiA4KSAqIE1BWF9EUENEX0JVRkZF
Ul9TSVpFOworCQkJCWdfZWRpZF9icmVhayA9IGVkaWRfcmVhZChjdHgsIG9mZnNldCwKKwkJCQkJ
CQkgcGJsb2NrX2J1Zik7CisKKwkJCQlpZiAoZ19lZGlkX2JyZWFrKQorCQkJCQlicmVhazsKKwor
CQkJCW1lbWNweSgmcGVkaWRfYmxvY2tzX2J1ZltvZmZzZXRdLAorCQkJCSAgICAgICBwYmxvY2tf
YnVmLAorCQkJCSAgICAgICBNQVhfRFBDRF9CVUZGRVJfU0laRSk7CisJCQl9CisKKwkJCWJyZWFr
OworCQljYXNlIDI6CisJCQlvZmZzZXQgPSAweDAwOworCisJCQlmb3IgKGogPSAwOyBqIDwgODsg
aisrKSB7CisJCQkJZWRpZF9wb3MgPSAoaiArIGNvdW50ICogOCkgKgorCQkJCQlNQVhfRFBDRF9C
VUZGRVJfU0laRTsKKworCQkJCWlmIChnX2VkaWRfYnJlYWsgPT0gMSkKKwkJCQkJYnJlYWs7CisK
KwkJCQlzZWdtZW50c19lZGlkX3JlYWQoY3R4LCBjb3VudCAvIDIsCisJCQkJCQkgICBwYmxvY2tf
YnVmLCBvZmZzZXQpOworCQkJCW1lbWNweSgmcGVkaWRfYmxvY2tzX2J1ZltlZGlkX3Bvc10sCisJ
CQkJICAgICAgIHBibG9ja19idWYsCisJCQkJICAgICAgIE1BWF9EUENEX0JVRkZFUl9TSVpFKTsK
KwkJCQlvZmZzZXQgPSBvZmZzZXQgKyAweDEwOworCQkJfQorCisJCQlicmVhazsKKwkJY2FzZSAz
OgorCQkJb2Zmc2V0ID0gMHg4MDsKKworCQkJZm9yIChqID0gMDsgaiA8IDg7IGorKykgeworCQkJ
CWVkaWRfcG9zID0gKGogKyBjb3VudCAqIDgpICoKKwkJCQkJTUFYX0RQQ0RfQlVGRkVSX1NJWkU7
CisJCQkJaWYgKGdfZWRpZF9icmVhayA9PSAxKQorCQkJCQlicmVhazsKKworCQkJCXNlZ21lbnRz
X2VkaWRfcmVhZChjdHgsIGNvdW50IC8gMiwKKwkJCQkJCSAgIHBibG9ja19idWYsIG9mZnNldCk7
CisJCQkJbWVtY3B5KCZwZWRpZF9ibG9ja3NfYnVmW2VkaWRfcG9zXSwKKwkJCQkgICAgICAgcGJs
b2NrX2J1ZiwKKwkJCQkgICAgICAgTUFYX0RQQ0RfQlVGRkVSX1NJWkUpOworCQkJCW9mZnNldCA9
IG9mZnNldCArIDB4MTA7CisJCQl9CisKKwkJCWJyZWFrOworCQlkZWZhdWx0OgorCQkJYnJlYWs7
CisJCX0KKworCQljb3VudCsrOworCisJfSB3aGlsZSAoYmxvY2tzX251bSA+PSBjb3VudCk7CisK
KwkvKiBjaGVjayBlZGlkIGRhdGEgKi8KKwlpZiAoIWRybV9lZGlkX2lzX3ZhbGlkKChzdHJ1Y3Qg
ZWRpZCAqKXBlZGlkX2Jsb2Nrc19idWYpKSB7CisJCURSTV9ERVZfRVJST1IoZGV2LCAiV0FSTklO
RyEgZWRpZCBjaGVjayBmYWlsZWQhXG4iKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJLyog
cmVzZXQgYXV4IGNoYW5uZWwgKi8KKwlzcF90eF9yc3RfYXV4KGN0eCk7CisKKwlyZXR1cm4gKGJs
b2Nrc19udW0gKyAxKTsKK30KKworc3RhdGljIHZvaWQgYW54NzYyNV9wb3dlcl9vbihzdHJ1Y3Qg
YW54NzYyNV9kYXRhICpjdHgpCit7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50
LT5kZXY7CisKKwlpZiAoIWN0eC0+cGRhdGEubG93X3Bvd2VyX21vZGUpIHsKKwkJRFJNX0RFVl9E
RUJVR19EUklWRVIoZGV2LCAiQW54NzYyNSBub3QgbG93IHBvd2VyIG1vZGUhXG4iKTsKKwkJcmV0
dXJuOworCX0KKworCS8qIHBvd2VyIG9uIHBpbiBlbmFibGUgKi8KKwlncGlvZF9zZXRfdmFsdWUo
Y3R4LT5wZGF0YS5ncGlvX3Bfb24sIDEpOworCXVzbGVlcF9yYW5nZSgxMDAwMCwgMTEwMDApOwor
CS8qIHBvd2VyIHJlc2V0IHBpbiBlbmFibGUgKi8KKwlncGlvZF9zZXRfdmFsdWUoY3R4LT5wZGF0
YS5ncGlvX3Jlc2V0LCAxKTsKKwl1c2xlZXBfcmFuZ2UoMTAwMDAsIDExMDAwKTsKKworCURSTV9E
RVZfREVCVUdfRFJJVkVSKGRldiwgIkFueDc2MjUgcG93ZXIgb24gIVxuIik7Cit9CisKK3N0YXRp
YyB2b2lkIGFueDc2MjVfcG93ZXJfc3RhbmRieShzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7
CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisKKwlpZiAoIWN0eC0+
cGRhdGEubG93X3Bvd2VyX21vZGUpIHsKKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiYW54
NzYyNSBub3QgbG93IHBvd2VyIG1vZGUhXG4iKTsKKwkJcmV0dXJuOworCX0KKworCWdwaW9kX3Nl
dF92YWx1ZShjdHgtPnBkYXRhLmdwaW9fcmVzZXQsIDApOworCXVzbGVlcF9yYW5nZSgxMDAwLCAx
MTAwKTsKKwlncGlvZF9zZXRfdmFsdWUoY3R4LT5wZGF0YS5ncGlvX3Bfb24sIDApOworCXVzbGVl
cF9yYW5nZSgxMDAwLCAxMTAwKTsKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJhbng3NjI1
IHBvd2VyIGRvd25cbiIpOworfQorCisvKiBiYXNpYyBjb25maWd1cmF0aW9ucyBvZiBBTlg3NjI1
ICovCitzdGF0aWMgdm9pZCBhbng3NjI1X2NvbmZpZyhzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgp
Cit7CisJYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkg
IFhUQUxfRlJRX1NFTCwgWFRBTF9GUlFfMjdNKTsKK30KKworc3RhdGljIHZvaWQgYW54NzYyNV9k
aXNhYmxlX3BkX3Byb3RvY29sKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sKKwlzdHJ1Y3Qg
ZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKwlpbnQgcmV0OworCisJLyogcmVzZXQg
bWFpbiBvY20gKi8KKwlyZXQgPSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3Aw
X2NsaWVudCwgMHg4OCwgMHg0MCk7CisJLyogRGlzYWJsZSBQRCAqLworCXJldCB8PSBhbng3NjI1
X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkgQVBfQVZfU1RBVFVT
LCBBUF9ESVNBQkxFX1BEKTsKKwkvKiByZWxlYXNlIG1haW4gb2NtICovCisJcmV0IHw9IGFueDc2
MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LCAweDg4LCAweDAwKTsKKwor
CWlmIChyZXQgPCAwKQorCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJkaXNhYmxlIFBEIGZl
YXR1cmUgZmFpbGVkLlxuIik7CisJZWxzZQorCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJk
aXNhYmxlIFBEIGZlYXR1cmUgc3VjY2VlZGVkLlxuIik7Cit9CisKK3N0YXRpYyB2b2lkIGFueDc2
MjVfcG93ZXJfb25faW5pdChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJaW50IHJldHJ5
X2NvdW50LCBpOworCWludCByZXQ7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50
LT5kZXY7CisKKwlmb3IgKHJldHJ5X2NvdW50ID0gMDsgcmV0cnlfY291bnQgPCAzOyByZXRyeV9j
b3VudCsrKSB7CisJCWFueDc2MjVfcG93ZXJfb24oY3R4KTsKKwkJYW54NzYyNV9jb25maWcoY3R4
KTsKKworCQlmb3IgKGkgPSAwOyBpIDwgT0NNX0xPQURJTkdfVElNRTsgaSsrKSB7CisJCQkvKiBj
aGVjayBpbnRlcmZhY2Ugd29ya2FibGUgKi8KKwkJCXJldCA9IGFueDc2MjVfcmVnX3JlYWQoY3R4
LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJCSAgICAgICBGTEFTSF9MT0FEX1NUQSk7CisJ
CQlpZiAocmV0IDwgMCkgeworCQkJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBhY2Nlc3MgZmxhc2gg
bG9hZC5cbiIpOworCQkJCXJldHVybjsKKwkJCX0KKwkJCWlmICgocmV0ICYgRkxBU0hfTE9BRF9T
VEFfQ0hLKSA9PSBGTEFTSF9MT0FEX1NUQV9DSEspIHsKKwkJCQlhbng3NjI1X2Rpc2FibGVfcGRf
cHJvdG9jb2woY3R4KTsKKwkJCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsCisJCQkJCQkgICAg
ICJGaXJtd2FyZSB2ZXIgJTAyeCUwMngsIiwKKwkJCQkJYW54NzYyNV9yZWdfcmVhZChjdHgsCisJ
CQkJCQkJIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkJCQkgT0NNX0ZXX1ZFUlNJT04pLAor
CQkJCQlhbng3NjI1X3JlZ19yZWFkKGN0eCwKKwkJCQkJCQkgY3R4LT5pMmMucnhfcDBfY2xpZW50
LAorCQkJCQkJCSBPQ01fRldfUkVWRVJTSU9OKSk7CisJCQkJRFJNX0RFVl9ERUJVR19EUklWRVIo
ZGV2LCAiRHJpdmVyIHZlcnNpb24gJXNcbiIsCisJCQkJCQkgICAgIEFOWDc2MjVfRFJWX1ZFUlNJ
T04pOworCisJCQkJcmV0dXJuOworCQkJfQorCQkJdXNsZWVwX3JhbmdlKDEwMDAsIDExMDApOwor
CQl9CisJCWFueDc2MjVfcG93ZXJfc3RhbmRieShjdHgpOworCX0KK30KKworc3RhdGljIGludCBh
bng3NjI1X2V4dGNvbl9ub3RpZmllcihzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgKm5iLAorCQkJCSAg
IHVuc2lnbmVkIGxvbmcgZXZlbnQsIHZvaWQgKnB0cikKK3sKKwlzdHJ1Y3QgYW54NzYyNV9kYXRh
ICpjdHggPQorCQljb250YWluZXJfb2YobmIsIHN0cnVjdCBhbng3NjI1X2RhdGEsIGV2ZW50X25i
KTsKKworCXNjaGVkdWxlX3dvcmsoJmN0eC0+ZXh0Y29uX3dxKTsKKwlyZXR1cm4gTk9USUZZX0RP
TkU7Cit9CisKK3N0YXRpYyB2b2lkIGFueDc2MjVfY2hpcF9jb250cm9sKHN0cnVjdCBhbng3NjI1
X2RhdGEgKmN0eCwgaW50IHN0YXRlKQoreworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNs
aWVudC0+ZGV2OworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiYmVmb3JlIHNldCwgcG93
ZXJfc3RhdGUoJWQpLlxuIiwKKwkJCSAgICAgYXRvbWljX3JlYWQoJmN0eC0+cG93ZXJfc3RhdHVz
KSk7CisKKwlpZiAoIWN0eC0+cGRhdGEubG93X3Bvd2VyX21vZGUpCisJCXJldHVybjsKKworCWlm
IChzdGF0ZSkgeworCQlhdG9taWNfaW5jKCZjdHgtPnBvd2VyX3N0YXR1cyk7CisJCWlmIChhdG9t
aWNfcmVhZCgmY3R4LT5wb3dlcl9zdGF0dXMpID09IDEpCisJCQlhbng3NjI1X3Bvd2VyX29uX2lu
aXQoY3R4KTsKKwl9IGVsc2UgeworCQlpZiAoYXRvbWljX3JlYWQoJmN0eC0+cG93ZXJfc3RhdHVz
KSkgeworCQkJYXRvbWljX2RlYygmY3R4LT5wb3dlcl9zdGF0dXMpOworCisJCQlpZiAoYXRvbWlj
X3JlYWQoJmN0eC0+cG93ZXJfc3RhdHVzKSA9PSAwKQorCQkJCWFueDc2MjVfcG93ZXJfc3RhbmRi
eShjdHgpOworCQl9CisJfQorCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiYWZ0ZXIgc2V0
LCBwb3dlcl9zdGF0ZSglZCkuXG4iLAorCQkJICAgICBhdG9taWNfcmVhZCgmY3R4LT5wb3dlcl9z
dGF0dXMpKTsKK30KKworc3RhdGljIHZvaWQgYW54NzYyNV9leHRjb25fd29yayhzdHJ1Y3Qgd29y
a19zdHJ1Y3QgKndvcmspCit7CisJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0KKwkJY29udGFp
bmVyX29mKHdvcmssIHN0cnVjdCBhbng3NjI1X2RhdGEsIGV4dGNvbl93cSk7CisJaW50IHN0YXRl
ID0gZXh0Y29uX2dldF9zdGF0ZShjdHgtPmV4dGNvbiwgRVhUQ09OX0RJU1BfRFApOworCisJbXV0
ZXhfbG9jaygmY3R4LT5sb2NrKTsKKwlhbng3NjI1X2NoaXBfY29udHJvbChjdHgsIHN0YXRlKTsK
KwltdXRleF91bmxvY2soJmN0eC0+bG9jayk7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV9leHRj
b25fbm90aWZpZXJfaW5pdChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJaW50IHJldDsK
KwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKworCWN0eC0+ZXZlbnRf
bmIubm90aWZpZXJfY2FsbCA9IGFueDc2MjVfZXh0Y29uX25vdGlmaWVyOworCUlOSVRfV09SSygm
Y3R4LT5leHRjb25fd3EsIGFueDc2MjVfZXh0Y29uX3dvcmspOworCXJldCA9IGRldm1fZXh0Y29u
X3JlZ2lzdGVyX25vdGlmaWVyKCZjdHgtPmNsaWVudC0+ZGV2LCBjdHgtPmV4dGNvbiwKKwkJCQkJ
ICAgIEVYVENPTl9ESVNQX0RQLCAmY3R4LT5ldmVudF9uYik7CisJaWYgKHJldCkgeworCQlEUk1f
REVWX0VSUk9SKGRldiwgImZhaWxlZCB0byByZWdpc3RlciBub3RpZmllciBmb3IgRFAiKTsKKwkJ
cmV0dXJuIHJldDsKKwl9CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGFueDc2MjVfaW5p
dF9ncGlvKHN0cnVjdCBhbng3NjI1X2RhdGEgKnBsYXRmb3JtKQoreworCXN0cnVjdCBkZXZpY2Ug
KmRldiA9ICZwbGF0Zm9ybS0+Y2xpZW50LT5kZXY7CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihk
ZXYsICJhbng3NjI1IGluaXQgZ3Bpb1xuIik7CisKKwkvKiBncGlvIGZvciBjaGlwIHBvd2VyIGVu
YWJsZSAqLworCXBsYXRmb3JtLT5wZGF0YS5ncGlvX3Bfb24gPQorCQlkZXZtX2dwaW9kX2dldF9v
cHRpb25hbChkZXYsICJlbmFibGUiLCBHUElPRF9PVVRfTE9XKTsKKwkvKiBncGlvIGZvciBjaGlw
IHJlc2V0ICovCisJcGxhdGZvcm0tPnBkYXRhLmdwaW9fcmVzZXQgPQorCQlkZXZtX2dwaW9kX2dl
dF9vcHRpb25hbChkZXYsICJyZXNldCIsIEdQSU9EX09VVF9MT1cpOworCisJaWYgKHBsYXRmb3Jt
LT5wZGF0YS5ncGlvX3Bfb24gJiYgcGxhdGZvcm0tPnBkYXRhLmdwaW9fcmVzZXQpIHsKKwkJcGxh
dGZvcm0tPnBkYXRhLmxvd19wb3dlcl9tb2RlID0gMTsKKwkJRFJNX0RFVl9ERUJVR19EUklWRVIo
ZGV2LCAibG93IHBvd2VyIG1vZGUsIHBvbiAlZCwgcmVzZXQgJWQuXG4iLAorCQkJCSAgICAgZGVz
Y190b19ncGlvKHBsYXRmb3JtLT5wZGF0YS5ncGlvX3Bfb24pLAorCQkJCSAgICAgZGVzY190b19n
cGlvKHBsYXRmb3JtLT5wZGF0YS5ncGlvX3Jlc2V0KSk7CisJfSBlbHNlIHsKKwkJcGxhdGZvcm0t
PnBkYXRhLmxvd19wb3dlcl9tb2RlID0gMDsKKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAi
bm90IGxvdyBwb3dlciBtb2RlLlxuIik7CisJfQorfQorCitzdGF0aWMgdm9pZCBhbng3NjI1X3N0
b3BfZHBfd29yayhzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJY3R4LT5ocGRfc3RhdHVz
ID0gMDsKKwljdHgtPmhwZF9oaWdoX2NudCA9IDA7CisJY3R4LT5kaXNwbGF5X3RpbWluZ192YWxp
ZCA9IDA7CisKKwljdHgtPnNsaW1wb3J0X2VkaWRfcC5lZGlkX2Jsb2NrX251bSA9IC0xOworCisJ
aWYgKGN0eC0+cGRhdGEubG93X3Bvd2VyX21vZGUgPT0gMCkKKwkJYW54NzYyNV9kaXNhYmxlX3Bk
X3Byb3RvY29sKGN0eCk7Cit9CisKK3N0YXRpYyB2b2lkIGFueDc2MjVfc3RhcnRfZHBfd29yayhz
dHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJaW50IHJldDsKKwl1OCBidWZbTUFYX0RQQ0Rf
QlVGRkVSX1NJWkVdOworCXU4IGhkY3BfY2FwOworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgt
PmNsaWVudC0+ZGV2OworCXU4IHNwX3R4X2J3OyAvKiBsaW5rdHJhaW5pbmcgYmFud2lkdGggKi8K
Kwl1OCBzcF90eF9sYW5lX2NvdW50OyAvKiBsaW5rIHRyYWluaW5nIGxhbmUgY291bnQgKi8KKwor
CWlmIChjdHgtPmhwZF9oaWdoX2NudCA+PSAyKSB7CisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRl
diwgImFueDc2MjUgZmlsdGVyIHVzZWxlc3MgSFBEXG4iKTsKKwkJcmV0dXJuOworCX0KKworCWN0
eC0+aHBkX2hpZ2hfY250Kys7CisKKwlzcF90eF9nZXRfcnhfYncoY3R4LCAmc3BfdHhfYncpOwor
CisJc3BfdHhfYXV4X2RwY2RyZWFkX2J5dGVzKGN0eCwgMHgwMCwgMHgwMCwgRFBDRF9NQVhfTEFO
RV9DT1VOVCwKKwkJCQkgMSwgJnNwX3R4X2xhbmVfY291bnQpOworCisJc3BfdHhfbGFuZV9jb3Vu
dCA9IHNwX3R4X2xhbmVfY291bnQgJiAweDFmOworCXNwX3R4X2F1eF9kcGNkcmVhZF9ieXRlcyhj
dHgsIDB4MDYsIDB4ODAsIDB4MjgsIDEsIGJ1Zik7LyogcmVhZCBCY2FwICovCisKKwloZGNwX2Nh
cCA9IGJ1ZlswXSAmIDB4MDE7CisKKwkvKiBub3Qgc3VwcG9ydCBIRENQICovCisJcmV0ID0gYW54
NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIDB4ZWUsIDB4OWYpOwor
CisJaWYgKGhkY3BfY2FwID09IDB4MDEpCisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIkhE
Q1AxLjRcbiIpOworCisJLyogdHJ5IGF1dGggZmxhZyAqLworCXJldCB8PSBhbng3NjI1X3dyaXRl
X29yKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCAweGVjLCAweDEwKTsKKwkvKiBpbnRlcnJ1
cHQgZm9yIERSTSAqLworCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhf
cDFfY2xpZW50LCAweGZmLCAweDAxKTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0dXJuOworCURSTV9E
RVZfREVCVUdfRFJJVkVSKGRldiwgIk1BWCBCVz0lMDJ4LCBNQVggTGFuZSBjbnQ9JTAyeCwgSERD
UD0lMDJ4XG4iLAorCQkJICAgICAodTMyKXNwX3R4X2J3LAorCQkJICAgICAodTMyKXNwX3R4X2xh
bmVfY291bnQsCisJCQkgICAgICh1MzIpaGRjcF9jYXApOworCisJcmV0ID0gYW54NzYyNV9yZWdf
cmVhZChjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgMHg4Nik7CisJaWYgKHJldCA8IDApCisJ
CXJldHVybjsKKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIlNlY3VyZSBPQ00gdmVyc2lv
bj0lMDJ4XG4iLCByZXQpOworfQorCitzdGF0aWMgaW50IGFueDc2MjVfcmVhZF9ocGRfc3RhdHVz
X3AwKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sKKwlyZXR1cm4gYW54NzYyNV9yZWdfcmVh
ZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwgU1lTVEVNX1NUU1RVUyk7Cit9CisKK3N0YXRp
YyB2b2lkIGFueDc2MjVfaHBkX3BvbGxpbmcoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQorewor
CWludCByZXQsIHZhbDsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsK
KworCWlmIChhdG9taWNfcmVhZCgmY3R4LT5wb3dlcl9zdGF0dXMpICE9IDEpIHsKKwkJRFJNX0RF
Vl9ERUJVR19EUklWRVIoZGV2LCAiTm8gbmVlZCB0byBwb2xpbmcgSFBEIHN0YXR1cy5cbiIpOwor
CQlyZXR1cm47CisJfQorCisJcmV0ID0gcmVhZHhfcG9sbF90aW1lb3V0KGFueDc2MjVfcmVhZF9o
cGRfc3RhdHVzX3AwLAorCQkJCSBjdHgsIHZhbCwKKwkJCQkgKCh2YWwgJiBIUERfU1RBVFVTKSB8
fCAodmFsIDwgMCkpLAorCQkJCSA1MDAwLAorCQkJCSA1MDAwICogMTAwKTsKKwlpZiAocmV0KSB7
CisJCURSTV9ERVZfRVJST1IoZGV2LCAiSFBEIHBvbGxpbmcgdGltZW91dCFcbiIpOworCX0gZWxz
ZSB7CisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIkhQRCByYWlzZSB1cC5cbiIpOworCQlh
bng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnRjcGNfY2xpZW50LAorCQkJCSAgSU5UUl9B
TEVSVF8xLCAweEZGKTsKKwkJYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9j
bGllbnQsCisJCQkJICBJTlRFUkZBQ0VfQ0hBTkdFX0lOVCwgMCk7CisJfQorCisJYW54NzYyNV9z
dGFydF9kcF93b3JrKGN0eCk7Cit9CisKK3N0YXRpYyB2b2lkIGFueDc2MjVfZGlzY29ubmVjdF9j
aGVjayhzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJaWYgKGF0b21pY19yZWFkKCZjdHgt
PnBvd2VyX3N0YXR1cykgPT0gMCkKKwkJYW54NzYyNV9zdG9wX2RwX3dvcmsoY3R4KTsKK30KKwor
c3RhdGljIHZvaWQgYW54NzYyNV9sb3dfcG93ZXJfbW9kZV9jaGVjayhzdHJ1Y3QgYW54NzYyNV9k
YXRhICpjdHgsCisJCQkJCSBpbnQgc3RhdGUpCit7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0
eC0+Y2xpZW50LT5kZXY7CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJsb3cgcG93ZXIg
bW9kZSBjaGVjaywgc3RhdGUoJWQpLlxuIiwgc3RhdGUpOworCisJaWYgKGN0eC0+cGRhdGEubG93
X3Bvd2VyX21vZGUpIHsKKwkJYW54NzYyNV9jaGlwX2NvbnRyb2woY3R4LCBzdGF0ZSk7CisJCWlm
IChzdGF0ZSkKKwkJCWFueDc2MjVfaHBkX3BvbGxpbmcoY3R4KTsKKwkJZWxzZQorCQkJYW54NzYy
NV9kaXNjb25uZWN0X2NoZWNrKGN0eCk7CisJfQorfQorCitzdGF0aWMgdm9pZCBkcF9ocGRfY2hh
bmdlX2hhbmRsZXIoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LCBib29sIG9uKQoreworCXN0cnVj
dCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2OworCisJLyogaHBkIGNoYW5nZWQgKi8K
KwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJkcF9ocGRfY2hhbmdlX2RlZmF1bHRfZnVuYzog
JWRcbiIsCisJCQkgICAgICh1MzIpb24pOworCisJaWYgKG9uID09IDApIHsKKwkJRFJNX0RFVl9E
RUJVR19EUklWRVIoZGV2LCAiIEhQRCBsb3dcbiIpOworCQlhbng3NjI1X3N0b3BfZHBfd29yayhj
dHgpOworCX0gZWxzZSB7CisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIiBIUEQgaGlnaFxu
Iik7CisJCWFueDc2MjVfc3RhcnRfZHBfd29yayhjdHgpOworCX0KKworCWN0eC0+aHBkX3N0YXR1
cyA9IDE7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV9ocGRfY2hhbmdlX2RldGVjdChzdHJ1Y3Qg
YW54NzYyNV9kYXRhICpjdHgpCit7CisJaW50IGludHJfdmVjdG9yLCBzdGF0dXM7CisJc3RydWN0
IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisKKwlEUk1fREVWX0RFQlVHX0RSSVZF
UihkZXYsICJwb3dlcl9zdGF0dXM9JWRcbiIsCisJCQkgICAgICh1MzIpYXRvbWljX3JlYWQoJmN0
eC0+cG93ZXJfc3RhdHVzKSk7CisKKwlzdGF0dXMgPSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0
eC0+aTJjLnRjcGNfY2xpZW50LAorCQkJCSAgIElOVFJfQUxFUlRfMSwgMHhGRik7CisJaWYgKHN0
YXR1cyA8IDApIHsKKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGNsZWFyIGFsZXJ0IHJlZ2lzdGVy
LlxuIik7CisJCXJldHVybiBzdGF0dXM7CisJfQorCisJaW50cl92ZWN0b3IgPSBhbng3NjI1X3Jl
Z19yZWFkKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCSAgICAgICBJTlRFUkZBQ0Vf
Q0hBTkdFX0lOVCk7CisJaWYgKGludHJfdmVjdG9yIDwgMCkgeworCQlEUk1fRVJST1IoIklPIGVy
cm9yIDogYWNjZXNzIGludGVycnVwdCBjaGFuZ2UgcmVnaXN0ZXIuXG4iKTsKKwkJcmV0dXJuIGlu
dHJfdmVjdG9yOworCX0KKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICIweDdlOjB4NDQ9JXhc
biIsIGludHJfdmVjdG9yKTsKKwlzdGF0dXMgPSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+
aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkgICBJTlRFUkZBQ0VfQ0hBTkdFX0lOVCwKKwkJCQkgICBp
bnRyX3ZlY3RvciAmICh+aW50cl92ZWN0b3IpKTsKKwlpZiAoc3RhdHVzIDwgMCkgeworCQlEUk1f
RVJST1IoIklPIGVycm9yIDogY2xlYXIgaW50ZXJydXB0IGNoYW5nZSByZWdpc3Rlci5cbiIpOwor
CQlyZXR1cm4gc3RhdHVzOworCX0KKworCWlmICghKGludHJfdmVjdG9yICYgSFBEX1NUQVRVU19D
SEFOR0UpKQorCQlyZXR1cm4gLUVOT0VOVDsKKworCXN0YXR1cyA9IGFueDc2MjVfcmVnX3JlYWQo
Y3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJICBTWVNURU1fU1RTVFVTKTsKKwlpZiAo
c3RhdHVzIDwgMCkgeworCQlEUk1fRVJST1IoIklPIGVycm9yIDogY2xlYXIgaW50ZXJydXB0IHN0
YXR1cy5cbiIpOworCQlyZXR1cm4gc3RhdHVzOworCX0KKworCURSTV9ERVZfREVCVUdfRFJJVkVS
KGRldiwgIjB4N2U6MHg0NT0leFxuIiwgc3RhdHVzKTsKKwlkcF9ocGRfY2hhbmdlX2hhbmRsZXIo
Y3R4LCBzdGF0dXMgJiBIUERfU1RBVFVTKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9p
ZCBhbng3NjI1X3dvcmtfZnVuYyhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCit7CisJaW50IGV2
ZW50OworCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCA9IGNvbnRhaW5lcl9vZih3b3JrLAorCQkJ
CQkJc3RydWN0IGFueDc2MjVfZGF0YSwgd29yayk7CisKKwltdXRleF9sb2NrKCZjdHgtPmxvY2sp
OworCWV2ZW50ID0gYW54NzYyNV9ocGRfY2hhbmdlX2RldGVjdChjdHgpOworCW11dGV4X3VubG9j
aygmY3R4LT5sb2NrKTsKKworCWlmIChldmVudCA8IDApCisJCXJldHVybjsKKworCWlmIChjdHgt
PmJyaWRnZV9hdHRhY2hlZCkKKwkJZHJtX2hlbHBlcl9ocGRfaXJxX2V2ZW50KGN0eC0+Y29ubmVj
dG9yLmRldik7Cit9CisKK3N0YXRpYyBpcnFyZXR1cm5fdCBhbng3NjI1X2ludHJfaHBkX2lzcihp
bnQgaXJxLCB2b2lkICpkYXRhKQoreworCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCA9IChzdHJ1
Y3QgYW54NzYyNV9kYXRhICopZGF0YTsKKworCWlmIChhdG9taWNfcmVhZCgmY3R4LT5wb3dlcl9z
dGF0dXMpICE9IDEpCisJCXJldHVybiBJUlFfTk9ORTsKKworCXF1ZXVlX3dvcmsoY3R4LT53b3Jr
cXVldWUsICZjdHgtPndvcmspOworCisJcmV0dXJuIElSUV9IQU5ETEVEOworfQorCisjaWZkZWYg
Q09ORklHX09GCitzdGF0aWMgaW50IGFueDc2MjVfcGFyc2VfZHQoc3RydWN0IGRldmljZSAqZGV2
LAorCQkJICAgIHN0cnVjdCBhbng3NjI1X3BsYXRmb3JtX2RhdGEgKnBkYXRhKQoreworCXN0cnVj
dCBkZXZpY2Vfbm9kZSAqbnAgPSBkZXYtPm9mX25vZGU7CisJc3RydWN0IGRldmljZV9ub2RlICpw
YW5lbF9ub2RlLCAqb3V0X2VwOworCisJb2ZfcHJvcGVydHlfcmVhZF91MzIoZGV2LT5vZl9ub2Rl
LCAicGFuZWxfZmxhZ3MiLAorCQkJICAgICAmcGRhdGEtPmludGVybmFsX3BhbmVsKTsKKworCXBk
YXRhLT5ub2RlLm1pcGlfZHNpX2hvc3Rfbm9kZSA9IG9mX2dyYXBoX2dldF9yZW1vdGVfbm9kZShu
cCwgMCwgMCk7CisJaWYgKHBkYXRhLT5ub2RlLm1pcGlfZHNpX2hvc3Rfbm9kZSkgeworCQlvZl9u
b2RlX3B1dChwZGF0YS0+bm9kZS5taXBpX2RzaV9ob3N0X25vZGUpOworCQlwZGF0YS0+ZHNpX3N1
cHBvcnRlZCA9IDE7CisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImZvdW5kIGRzaSBob3N0
IG5vZGUuXG4iKTsKKwl9IGVsc2UgeworCQlwZGF0YS0+bm9kZS5taXBpX2RwaV9ob3N0X25vZGUg
PQorCQkJb2ZfZ3JhcGhfZ2V0X3JlbW90ZV9ub2RlKG5wLCAxLCAwKTsKKworCQlpZiAocGRhdGEt
Pm5vZGUubWlwaV9kcGlfaG9zdF9ub2RlKSB7CisJCQlvZl9ub2RlX3B1dChwZGF0YS0+bm9kZS5t
aXBpX2RwaV9ob3N0X25vZGUpOworCQkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZm91bmQg
ZHBpIGhvc3Qgbm9kZS5cbiIpOworCQl9CisJfQorCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2
LCAiZHNpX3N1cHBvcnRlZCA6ICVkXG4iLCBwZGF0YS0+ZHNpX3N1cHBvcnRlZCk7CisKKwlwZGF0
YS0+bm9kZS5leHRjb25fbm9kZSA9IG9mX2dyYXBoX2dldF9wb3J0X2J5X2lkKG5wLCAyKTsKKwlw
ZGF0YS0+bm9kZS5wYW5lbF9ub2RlID0gb2ZfZ3JhcGhfZ2V0X3BvcnRfYnlfaWQobnAsIDMpOwor
CWlmIChwZGF0YS0+bm9kZS5leHRjb25fbm9kZSkKKwkJcGRhdGEtPmV4dGNvbl9zdXBwb3J0ZWQg
PSAxOworCisJaWYgKHBkYXRhLT5ub2RlLnBhbmVsX25vZGUpIHsKKwkJb2Zfbm9kZV9wdXQocGRh
dGEtPm5vZGUucGFuZWxfbm9kZSk7CisJCW91dF9lcCA9IG9mX2dldF9jaGlsZF9ieV9uYW1lKHBk
YXRhLT5ub2RlLnBhbmVsX25vZGUsCisJCQkJCSAgICAgICJlbmRwb2ludCIpOworCQlpZiAoIW91
dF9lcCkgeworCQkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiY2Fubm90IGdldCBlbmRwb2lu
dC5cbiIpOworCQkJcmV0dXJuIC1FUFJPQkVfREVGRVI7CisJCX0KKworCQlwYW5lbF9ub2RlID0g
b2ZfZ3JhcGhfZ2V0X3JlbW90ZV9wb3J0X3BhcmVudChvdXRfZXApOworCQlvZl9ub2RlX3B1dChv
dXRfZXApOworCisJCXBkYXRhLT5wYW5lbCA9IG9mX2RybV9maW5kX3BhbmVsKHBhbmVsX25vZGUp
OworCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJnZXQgcGFuZWwgbm9kZS5cbiIpOworCQlv
Zl9ub2RlX3B1dChwYW5lbF9ub2RlKTsKKwkJaWYgKElTX0VSUl9PUl9OVUxMKHBkYXRhLT5wYW5l
bCkpCisJCQlyZXR1cm4gLUVQUk9CRV9ERUZFUjsKKwl9CisKKwlEUk1fREVWX0RFQlVHX0RSSVZF
UihkZXYsICIlcyBzdXBwb3J0IGV4dGNvbiwgJXMgaW50ZXJuYWwgcGFuZWxcbiIsCisJCQkgICAg
IHBkYXRhLT5leHRjb25fc3VwcG9ydGVkID8gIiIgOiAibm90IiwKKwkJCSAgICAgcGRhdGEtPmlu
dGVybmFsX3BhbmVsID8gImhhcyIgOiAibm8iKTsKKworCXJldHVybiAwOworfQorI2Vsc2UKK3N0
YXRpYyBpbnQgYW54NzYyNV9wYXJzZV9kdChzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkgICAgc3Ry
dWN0IGFueDc2MjVfcGxhdGZvcm1fZGF0YSAqcGRhdGEpCit7CisJcmV0dXJuIC1FTk9ERVY7Cit9
CisjZW5kaWYKKworc3RhdGljIGlubGluZSBzdHJ1Y3QgYW54NzYyNV9kYXRhICpjb25uZWN0b3Jf
dG9fYW54NzYyNShzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqYykKK3sKKwlyZXR1cm4gY29udGFpbmVy
X29mKGMsIHN0cnVjdCBhbng3NjI1X2RhdGEsIGNvbm5lY3Rvcik7Cit9CisKK3N0YXRpYyBpbmxp
bmUgc3RydWN0IGFueDc2MjVfZGF0YSAqYnJpZGdlX3RvX2FueDc2MjUoc3RydWN0IGRybV9icmlk
Z2UgKmJyaWRnZSkKK3sKKwlyZXR1cm4gY29udGFpbmVyX29mKGJyaWRnZSwgc3RydWN0IGFueDc2
MjVfZGF0YSwgYnJpZGdlKTsKK30KKworc3RhdGljIHZvaWQgYW54NzYyNV9wb3N0X2Rpc2FibGUo
c3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSkKK3sKKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgg
PSBicmlkZ2VfdG9fYW54NzYyNShicmlkZ2UpOworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgt
PmNsaWVudC0+ZGV2OworCWludCByZXQ7CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJw
b3N0IGRpc2FibGVcbiIpOworCisJaWYgKCFjdHgtPnBkYXRhLnBhbmVsKQorCQlyZXR1cm47CisK
KwlyZXQgPSBkcm1fcGFuZWxfdW5wcmVwYXJlKGN0eC0+cGRhdGEucGFuZWwpOworCWlmIChyZXQp
CisJCURSTV9FUlJPUigiZmFpbGVkIHRvIHVucHJlcGFyZSBwYW5lbDogJWRcbiIsIHJldCk7CisJ
ZWxzZQorCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJiYWNrbGlnaHQgdW5wcmVwYXJlZC5c
biIpOworCisJYXRvbWljX3NldCgmY3R4LT5wYW5lbF9wb3dlciwgMCk7Cit9CisKK3N0YXRpYyB2
b2lkIGFueDc2MjVfcHJlX2VuYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQoreworCXN0
cnVjdCBhbng3NjI1X2RhdGEgKmN0eCA9IGJyaWRnZV90b19hbng3NjI1KGJyaWRnZSk7CisJc3Ry
dWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisJaW50IHJldDsKKworCURSTV9E
RVZfREVCVUdfRFJJVkVSKGRldiwgInByZSBlbmFibGVcbiIpOworCisJaWYgKCFjdHgtPnBkYXRh
LnBhbmVsKQorCQlyZXR1cm47CisKKwlyZXQgPSBkcm1fcGFuZWxfcHJlcGFyZShjdHgtPnBkYXRh
LnBhbmVsKTsKKwlpZiAocmV0IDwgMCkKKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gcHJlcGFyZSBw
YW5lbDogJWRcbiIsIHJldCk7CisJZWxzZQorCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJi
YWNrbGlnaHQgcHJlcGFyZWQuXG4iKTsKKwlhdG9taWNfc2V0KCZjdHgtPnBhbmVsX3Bvd2VyLCAx
KTsKK30KKworc3RhdGljIGludCBhbng3NjI1X2dldF9tb2RlcyhzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
ciAqY29ubmVjdG9yKQoreworCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCA9IGNvbm5lY3Rvcl90
b19hbng3NjI1KGNvbm5lY3Rvcik7CisJaW50IGVyciwgbnVtX21vZGVzID0gMDsKKwlpbnQgdHVy
bl9vZmZfZmxhZyA9IDA7CisJc3RydWN0IHNfZWRpZF9kYXRhICpwX2VkaWQgPSAmY3R4LT5zbGlt
cG9ydF9lZGlkX3A7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisK
KwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJkcm0gZ2V0IG1vZGVzXG4iKTsKKworCWlmIChj
dHgtPnNsaW1wb3J0X2VkaWRfcC5lZGlkX2Jsb2NrX251bSA+IDApCisJCWdvdG8gb3V0OworCisJ
bXV0ZXhfbG9jaygmY3R4LT5sb2NrKTsKKworCWlmIChjdHgtPnBkYXRhLnBhbmVsICYmIGF0b21p
Y19yZWFkKCZjdHgtPnBhbmVsX3Bvd2VyKSA9PSAwKSB7CisJCXR1cm5fb2ZmX2ZsYWcgPSAxOwor
CQlhbng3NjI1X3ByZV9lbmFibGUoJmN0eC0+YnJpZGdlKTsKKwl9CisKKwlhbng3NjI1X2xvd19w
b3dlcl9tb2RlX2NoZWNrKGN0eCwgMSk7CisKKwlwX2VkaWQtPmVkaWRfYmxvY2tfbnVtID0gc3Bf
dHhfZWRpZF9yZWFkKGN0eCwgcF9lZGlkLT5lZGlkX3Jhd19kYXRhKTsKKworCWVyciA9IC1FSU87
CisJaWYgKHBfZWRpZC0+ZWRpZF9ibG9ja19udW0gPCAwKSB7CisJCURSTV9FUlJPUigiRmFpbGVk
IHRvIHJlYWQgRURJRC5cbiIpOworCQlnb3RvIGZhaWw7CisJfQorCisJZXJyID0gZHJtX2Nvbm5l
Y3Rvcl91cGRhdGVfZWRpZF9wcm9wZXJ0eShjb25uZWN0b3IsCisJCQkJCQkgKHN0cnVjdCBlZGlk
ICopCisJCQkJCQkgJnBfZWRpZC0+ZWRpZF9yYXdfZGF0YSk7CisKKwlpZiAoZXJyKQorCQlEUk1f
RVJST1IoIkZhaWxlZCB0byB1cGRhdGUgRURJRCBwcm9wZXJ0eTogJWRcbiIsIGVycik7CisKK2Zh
aWw6CisJbXV0ZXhfdW5sb2NrKCZjdHgtPmxvY2spOworCWFueDc2MjVfbG93X3Bvd2VyX21vZGVf
Y2hlY2soY3R4LCAwKTsKKwlpZiAoY3R4LT5wZGF0YS5wYW5lbCAmJiB0dXJuX29mZl9mbGFnID09
IDEpCisJCWFueDc2MjVfcG9zdF9kaXNhYmxlKCZjdHgtPmJyaWRnZSk7CisKKwlpZiAoZXJyKQor
CQlyZXR1cm4gZXJyOworCitvdXQ6CisJbnVtX21vZGVzID0gZHJtX2FkZF9lZGlkX21vZGVzKGNv
bm5lY3RvciwKKwkJCQkgICAgICAgKHN0cnVjdCBlZGlkICopJnBfZWRpZC0+ZWRpZF9yYXdfZGF0
YSk7CisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAibnVtX21vZGVzKCVkKVxuIiwgbnVtX21v
ZGVzKTsKKworCXJldHVybiBudW1fbW9kZXM7Cit9CisKK3N0YXRpYyBlbnVtIGRybV9tb2RlX3N0
YXR1cworYW54NzYyNV9jb25uZWN0b3JfbW9kZV92YWxpZChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAq
Y29ubmVjdG9yLAorCQkJICAgICBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkKK3sKKwlz
dHJ1Y3QgYW54NzYyNV9kYXRhICpjdHggPSBjb25uZWN0b3JfdG9fYW54NzYyNShjb25uZWN0b3Ip
OworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2OworCisJRFJNX0RFVl9E
RUJVR19EUklWRVIoZGV2LCAiZHJtIG1vZGVzIHZhbGlkIHZlcmlmeVxuIik7CisKKwlpZiAobW9k
ZS0+Y2xvY2sgPiBTVVBQT1JUX1BJWEVMX0NMT0NLKQorCQlyZXR1cm4gTU9ERV9DTE9DS19ISUdI
OworCisJcmV0dXJuIE1PREVfT0s7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9o
ZWxwZXJfZnVuY3MgYW54NzYyNV9jb25uZWN0b3JfaGVscGVyX2Z1bmNzID0geworCS5nZXRfbW9k
ZXMgPSBhbng3NjI1X2dldF9tb2RlcywKKwkubW9kZV92YWxpZCA9IGFueDc2MjVfY29ubmVjdG9y
X21vZGVfdmFsaWQsCit9OworCitzdGF0aWMgZW51bSBkcm1fY29ubmVjdG9yX3N0YXR1cyBhbng3
NjI1X2RldGVjdChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAorCQkJCQkJYm9vbCBm
b3JjZSkKK3sKKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHggPSBjb25uZWN0b3JfdG9fYW54NzYy
NShjb25uZWN0b3IpOworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owor
CisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZHJtIGRldGVjdFxuIik7CisKKwlpZiAoY3R4
LT5wZGF0YS5pbnRlcm5hbF9wYW5lbCkKKwkJcmV0dXJuIGNvbm5lY3Rvcl9zdGF0dXNfY29ubmVj
dGVkOworCisJaWYgKCFjdHgtPmhwZF9zdGF0dXMpCisJCXJldHVybiBjb25uZWN0b3Jfc3RhdHVz
X2Rpc2Nvbm5lY3RlZDsKKworCXJldHVybiBjb25uZWN0b3Jfc3RhdHVzX2Nvbm5lY3RlZDsKK30K
Kworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX2Z1bmNzIGFueDc2MjVfY29ubmVj
dG9yX2Z1bmNzID0geworCS5maWxsX21vZGVzID0gZHJtX2hlbHBlcl9wcm9iZV9zaW5nbGVfY29u
bmVjdG9yX21vZGVzLAorCS5kZXRlY3QgPSBhbng3NjI1X2RldGVjdCwKKwkuZGVzdHJveSA9IGRy
bV9jb25uZWN0b3JfY2xlYW51cCwKKwkucmVzZXQgPSBkcm1fYXRvbWljX2hlbHBlcl9jb25uZWN0
b3JfcmVzZXQsCisJLmF0b21pY19kdXBsaWNhdGVfc3RhdGUgPSBkcm1fYXRvbWljX2hlbHBlcl9j
b25uZWN0b3JfZHVwbGljYXRlX3N0YXRlLAorCS5hdG9taWNfZGVzdHJveV9zdGF0ZSA9IGRybV9h
dG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9kZXN0cm95X3N0YXRlLAorfTsKKworc3RhdGljIGludCBh
bng3NjI1X2F0dGFjaF9kc2koc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCXN0cnVjdCBt
aXBpX2RzaV9ob3N0ICpob3N0OworCXN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaTsKKwlzdHJ1
Y3QgZGV2aWNlX25vZGUgKm1pcGlfaG9zdF9ub2RlOworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZj
dHgtPmNsaWVudC0+ZGV2OworCWNvbnN0IHN0cnVjdCBtaXBpX2RzaV9kZXZpY2VfaW5mbyBpbmZv
ID0geworCQkudHlwZSA9ICJhbng3NjI1IiwKKwkJLmNoYW5uZWwgPSAwLAorCQkubm9kZSA9IE5V
TEwsCisJfTsKKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImF0dGFjaCBkc2lcbiIpOwor
CisJaWYgKGN0eC0+cGRhdGEuZHNpX3N1cHBvcnRlZCkKKwkJbWlwaV9ob3N0X25vZGUgPSBjdHgt
PnBkYXRhLm5vZGUubWlwaV9kc2lfaG9zdF9ub2RlOworCWVsc2UKKwkJbWlwaV9ob3N0X25vZGUg
PSBjdHgtPnBkYXRhLm5vZGUubWlwaV9kcGlfaG9zdF9ub2RlOworCisJaWYgKCFtaXBpX2hvc3Rf
bm9kZSkgeworCQlEUk1fRVJST1IoImRzaSBob3N0IGlzIG5vdCBjb25maWd1cmVkLlxuIik7CisJ
CXJldHVybiAtRUlOVkFMOworCX0KKworCWhvc3QgPSBvZl9maW5kX21pcGlfZHNpX2hvc3RfYnlf
bm9kZShtaXBpX2hvc3Rfbm9kZSk7CisJaWYgKCFob3N0KSB7CisJCURSTV9FUlJPUigiZmFpbGVk
IHRvIGZpbmQgZHNpIGhvc3QuXG4iKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJZHNpID0g
bWlwaV9kc2lfZGV2aWNlX3JlZ2lzdGVyX2Z1bGwoaG9zdCwgJmluZm8pOworCWlmIChJU19FUlIo
ZHNpKSkgeworCQlEUk1fRVJST1IoImZhaWxlZCB0byBjcmVhdGUgZHNpIGRldmljZS5cbiIpOwor
CQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlkc2ktPmxhbmVzID0gNDsKKwlkc2ktPmZvcm1hdCA9
IE1JUElfRFNJX0ZNVF9SR0I4ODg7CisJZHNpLT5tb2RlX2ZsYWdzID0gTUlQSV9EU0lfTU9ERV9W
SURFTwl8CisJCU1JUElfRFNJX01PREVfVklERU9fU1lOQ19QVUxTRQl8CisJCU1JUElfRFNJX01P
REVfRU9UX1BBQ0tFVAl8CisJCU1JUElfRFNJX01PREVfVklERU9fSFNFOworCisJaWYgKG1pcGlf
ZHNpX2F0dGFjaChkc2kpIDwgMCkgeworCQlEUk1fRVJST1IoImZhaWxlZCB0byBhdHRhY2ggZHNp
IHRvIGhvc3QuXG4iKTsKKwkJbWlwaV9kc2lfZGV2aWNlX3VucmVnaXN0ZXIoZHNpKTsKKwkJcmV0
dXJuIC1FSU5WQUw7CisJfQorCisJY3R4LT5kc2kgPSBkc2k7CisKKwlEUk1fREVWX0RFQlVHX0RS
SVZFUihkZXYsICJhdHRhY2ggZHNpIHN1Y2NlZWRlZC5cbiIpOworCisJcmV0dXJuIDA7Cit9CisK
K3N0YXRpYyB2b2lkIGFueDc2MjVfYnJpZGdlX2RldGFjaChzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJp
ZGdlKQoreworCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCA9IGJyaWRnZV90b19hbng3NjI1KGJy
aWRnZSk7CisKKwlpZiAoY3R4LT5kc2kpIHsKKwkJbWlwaV9kc2lfZGV0YWNoKGN0eC0+ZHNpKTsK
KwkJbWlwaV9kc2lfZGV2aWNlX3VucmVnaXN0ZXIoY3R4LT5kc2kpOworCX0KKworCWlmIChjdHgt
PmJyaWRnZV9hdHRhY2hlZCkKKwkJZHJtX2Nvbm5lY3Rvcl91bnJlZ2lzdGVyKCZjdHgtPmNvbm5l
Y3Rvcik7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV9icmlkZ2VfYXR0YWNoKHN0cnVjdCBkcm1f
YnJpZGdlICpicmlkZ2UpCit7CisJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0gYnJpZGdlX3Rv
X2FueDc2MjUoYnJpZGdlKTsKKwlpbnQgZXJyOworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgt
PmNsaWVudC0+ZGV2OworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZHJtIGF0dGFjaFxu
Iik7CisJaWYgKCFicmlkZ2UtPmVuY29kZXIpIHsKKwkJRFJNX0VSUk9SKCJQYXJlbnQgZW5jb2Rl
ciBvYmplY3Qgbm90IGZvdW5kIik7CisJCXJldHVybiAtRU5PREVWOworCX0KKworCWVyciA9IGRy
bV9jb25uZWN0b3JfaW5pdChicmlkZ2UtPmRldiwgJmN0eC0+Y29ubmVjdG9yLAorCQkJCSAmYW54
NzYyNV9jb25uZWN0b3JfZnVuY3MsCisJCQkJIERSTV9NT0RFX0NPTk5FQ1RPUl9EaXNwbGF5UG9y
dCk7CisJaWYgKGVycikgeworCQlEUk1fRVJST1IoIkZhaWxlZCB0byBpbml0aWFsaXplIGNvbm5l
Y3RvcjogJWRcbiIsIGVycik7CisJCXJldHVybiBlcnI7CisJfQorCisJZHJtX2Nvbm5lY3Rvcl9o
ZWxwZXJfYWRkKCZjdHgtPmNvbm5lY3RvciwKKwkJCQkgJmFueDc2MjVfY29ubmVjdG9yX2hlbHBl
cl9mdW5jcyk7CisKKwllcnIgPSBkcm1fY29ubmVjdG9yX3JlZ2lzdGVyKCZjdHgtPmNvbm5lY3Rv
cik7CisJaWYgKGVycikgeworCQlEUk1fRVJST1IoIkZhaWxlZCB0byByZWdpc3RlciBjb25uZWN0
b3I6ICVkXG4iLCBlcnIpOworCQlyZXR1cm4gZXJyOworCX0KKworCWN0eC0+Y29ubmVjdG9yLnBv
bGxlZCA9IERSTV9DT05ORUNUT1JfUE9MTF9IUEQ7CisKKwllcnIgPSBkcm1fY29ubmVjdG9yX2F0
dGFjaF9lbmNvZGVyKCZjdHgtPmNvbm5lY3RvciwgYnJpZGdlLT5lbmNvZGVyKTsKKwlpZiAoZXJy
KSB7CisJCURSTV9FUlJPUigiRmFpbGVkIHRvIGxpbmsgdXAgY29ubmVjdG9yIHRvIGVuY29kZXI6
ICVkXG4iLCBlcnIpOworCQlkcm1fY29ubmVjdG9yX3VucmVnaXN0ZXIoJmN0eC0+Y29ubmVjdG9y
KTsKKwkJcmV0dXJuIGVycjsKKwl9CisKKwllcnIgPSBhbng3NjI1X2F0dGFjaF9kc2koY3R4KTsK
KwlpZiAoZXJyKSB7CisJCURSTV9FUlJPUigiRmFpbGVkIHRvIGF0dGFjaCB0byBkc2kgOiAlZFxu
IiwgZXJyKTsKKwkJZHJtX2Nvbm5lY3Rvcl91bnJlZ2lzdGVyKCZjdHgtPmNvbm5lY3Rvcik7CisJ
CXJldHVybiBlcnI7CisJfQorCisJY3R4LT5icmlkZ2VfYXR0YWNoZWQgPSAxOworCisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyBlbnVtIGRybV9tb2RlX3N0YXR1cworYW54NzYyNV9icmlkZ2VfbW9k
ZV92YWxpZChzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAorCQkJICBjb25zdCBzdHJ1Y3QgZHJt
X2Rpc3BsYXlfbW9kZSAqbW9kZSkKK3sKKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHggPSBicmlk
Z2VfdG9fYW54NzYyNShicmlkZ2UpOworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVu
dC0+ZGV2OworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZHJtIG1vZGUgY2hlY2tpbmdc
biIpOworCisJLyogTWF4IDEyMDBwIGF0IDUuNCBHaHosIG9uZSBsYW5lLCBwaXhlbCBjbG9jayAz
MDBNICovCisJaWYgKG1vZGUtPmNsb2NrID4gU1VQUE9SVF9QSVhFTF9DTE9DSykgeworCQlEUk1f
REVWX0RFQlVHX0RSSVZFUihkZXYsCisJCQkJICAgICAiZHJtIG1vZGUgaW52YWxpZCwgcGl4ZWxj
bG9jayB0b28gaGlnaC5cbiIpOworCQlyZXR1cm4gTU9ERV9DTE9DS19ISUdIOworCX0KKworCURS
TV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRybSBtb2RlIHZhbGlkLlxuIik7CisKKwlyZXR1cm4g
TU9ERV9PSzsKK30KKworc3RhdGljIHZvaWQgYW54NzYyNV9icmlkZ2VfbW9kZV9zZXQoc3RydWN0
IGRybV9icmlkZ2UgKmJyaWRnZSwKKwkJCQkgICAgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21v
ZGUgKm9sZF9tb2RlLAorCQkJCSAgICBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9k
ZSkKK3sKKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHggPSBicmlkZ2VfdG9fYW54NzYyNShicmlk
Z2UpOworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2OworCisJRFJNX0RF
Vl9ERUJVR19EUklWRVIoZGV2LCAiZHJtIG1vZGUgc2V0XG4iKTsKKworCW11dGV4X2xvY2soJmN0
eC0+bG9jayk7CisKKwljdHgtPmR0LnBpeGVsY2xvY2subWluID0gbW9kZS0+Y2xvY2s7CisJY3R4
LT5kdC5oYWN0aXZlLm1pbiA9IG1vZGUtPmhkaXNwbGF5OworCWN0eC0+ZHQuaHN5bmNfbGVuLm1p
biA9IG1vZGUtPmhzeW5jX2VuZCAtIG1vZGUtPmhzeW5jX3N0YXJ0OworCWN0eC0+ZHQuaGZyb250
X3BvcmNoLm1pbiA9IG1vZGUtPmhzeW5jX3N0YXJ0IC0gbW9kZS0+aGRpc3BsYXk7CisJY3R4LT5k
dC5oYmFja19wb3JjaC5taW4gPSBtb2RlLT5odG90YWwgLSBtb2RlLT5oc3luY19lbmQ7CisJY3R4
LT5kdC52YWN0aXZlLm1pbiA9IG1vZGUtPnZkaXNwbGF5OworCWN0eC0+ZHQudnN5bmNfbGVuLm1p
biA9IG1vZGUtPnZzeW5jX2VuZCAtIG1vZGUtPnZzeW5jX3N0YXJ0OworCWN0eC0+ZHQudmZyb250
X3BvcmNoLm1pbiA9IG1vZGUtPnZzeW5jX3N0YXJ0IC0gbW9kZS0+dmRpc3BsYXk7CisJY3R4LT5k
dC52YmFja19wb3JjaC5taW4gPSBtb2RlLT52dG90YWwgLSBtb2RlLT52c3luY19lbmQ7CisKKwlj
dHgtPmRpc3BsYXlfdGltaW5nX3ZhbGlkID0gMTsKKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRl
diwgInBpeGVsY2xvY2soJWQpLlxuIiwgY3R4LT5kdC5waXhlbGNsb2NrLm1pbik7CisJRFJNX0RF
Vl9ERUJVR19EUklWRVIoZGV2LCAiaGFjdGl2ZSglZCksIGhzeW5jKCVkKSwgaGZwKCVkKSwgaGJw
KCVkKVxuIiwKKwkJCSAgICAgY3R4LT5kdC5oYWN0aXZlLm1pbiwKKwkJCSAgICAgY3R4LT5kdC5o
c3luY19sZW4ubWluLAorCQkJICAgICBjdHgtPmR0Lmhmcm9udF9wb3JjaC5taW4sCisJCQkgICAg
IGN0eC0+ZHQuaGJhY2tfcG9yY2gubWluKTsKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJ2
YWN0aXZlKCVkKSwgdnN5bmMoJWQpLCB2ZnAoJWQpLCB2YnAoJWQpXG4iLAorCQkJICAgICBjdHgt
PmR0LnZhY3RpdmUubWluLAorCQkJICAgICBjdHgtPmR0LnZzeW5jX2xlbi5taW4sCisJCQkgICAg
IGN0eC0+ZHQudmZyb250X3BvcmNoLm1pbiwKKwkJCSAgICAgY3R4LT5kdC52YmFja19wb3JjaC5t
aW4pOworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImhkaXNwbGF5KCVkKSxoc3luY19zdGFy
dCglZCkuXG4iLAorCQkJICAgICBtb2RlLT5oZGlzcGxheSwKKwkJCSAgICAgbW9kZS0+aHN5bmNf
c3RhcnQpOworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImhzeW5jX2VuZCglZCksaHRvdGFs
KCVkKS5cbiIsCisJCQkgICAgIG1vZGUtPmhzeW5jX2VuZCwKKwkJCSAgICAgbW9kZS0+aHRvdGFs
KTsKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJ2ZGlzcGxheSglZCksdnN5bmNfc3RhcnQo
JWQpLlxuIiwKKwkJCSAgICAgbW9kZS0+dmRpc3BsYXksCisJCQkgICAgIG1vZGUtPnZzeW5jX3N0
YXJ0KTsKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJ2c3luY19lbmQoJWQpLHZ0b3RhbCgl
ZCkuXG4iLAorCQkJICAgICBtb2RlLT52c3luY19lbmQsCisJCQkgICAgIG1vZGUtPnZ0b3RhbCk7
CisKKwltdXRleF91bmxvY2soJmN0eC0+bG9jayk7Cit9CisKK3N0YXRpYyB2b2lkIGFueDc2MjVf
YnJpZGdlX2VuYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQoreworCXN0cnVjdCBhbng3
NjI1X2RhdGEgKmN0eCA9IGJyaWRnZV90b19hbng3NjI1KGJyaWRnZSk7CisJc3RydWN0IGRldmlj
ZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisJaW50IHJldDsKKworCURSTV9ERVZfREVCVUdf
RFJJVkVSKGRldiwgImRybSBlbmFibGVcbiIpOworCisJYW54NzYyNV9sb3dfcG93ZXJfbW9kZV9j
aGVjayhjdHgsIDEpOworCisJaWYgKFdBUk5fT04oIWF0b21pY19yZWFkKCZjdHgtPnBvd2VyX3N0
YXR1cykpKQorCQlyZXR1cm47CisKKwlpZiAoY3R4LT5wZGF0YS5wYW5lbCkgeworCQlyZXQgPSBk
cm1fcGFuZWxfZW5hYmxlKGN0eC0+cGRhdGEucGFuZWwpOworCQlpZiAocmV0IDwgMCkgeworCQkJ
RFJNX0VSUk9SKCJmYWlsZWQgdG8gZW5hYmxlIHBhbmVsOiAlZC5cbiIsIHJldCk7CisJCQlyZXR1
cm47CisJCX0KKwl9CisKKwltdXRleF9sb2NrKCZjdHgtPmxvY2spOworCWFueDc2MjVfZHBfc3Rh
cnQoY3R4KTsKKwltdXRleF91bmxvY2soJmN0eC0+bG9jayk7Cit9CisKK3N0YXRpYyB2b2lkIGFu
eDc2MjVfYnJpZGdlX2Rpc2FibGUoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSkKK3sKKwlzdHJ1
Y3QgYW54NzYyNV9kYXRhICpjdHggPSBicmlkZ2VfdG9fYW54NzYyNShicmlkZ2UpOworCXN0cnVj
dCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2OworCWludCByZXQ7CisKKwlpZiAoV0FS
Tl9PTighYXRvbWljX3JlYWQoJmN0eC0+cG93ZXJfc3RhdHVzKSkpCisJCXJldHVybjsKKworCURS
TV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRybSBkaXNhYmxlXG4iKTsKKworCWlmIChjdHgtPnBk
YXRhLnBhbmVsKSB7CisJCXJldCA9IGRybV9wYW5lbF9kaXNhYmxlKGN0eC0+cGRhdGEucGFuZWwp
OworCQlpZiAocmV0IDwgMCkKKwkJCURSTV9FUlJPUigiZmFpbGVkIHRvIGRpc2FibGUgcGFuZWw6
ICVkLlxuIiwgcmV0KTsKKwl9CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJkcm0gZGlz
YWJsZVxuIik7CisJbXV0ZXhfbG9jaygmY3R4LT5sb2NrKTsKKworCWFueDc2MjVfZHBfc3RvcChj
dHgpOworCisJYW54NzYyNV9sb3dfcG93ZXJfbW9kZV9jaGVjayhjdHgsIDApOworCisJbXV0ZXhf
dW5sb2NrKCZjdHgtPmxvY2spOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9icmlkZ2Vf
ZnVuY3MgYW54NzYyNV9icmlkZ2VfZnVuY3MgPSB7CisJLmF0dGFjaCA9IGFueDc2MjVfYnJpZGdl
X2F0dGFjaCwKKwkuZGV0YWNoID0gYW54NzYyNV9icmlkZ2VfZGV0YWNoLAorCS5kaXNhYmxlID0g
YW54NzYyNV9icmlkZ2VfZGlzYWJsZSwKKwkucG9zdF9kaXNhYmxlID0gYW54NzYyNV9wb3N0X2Rp
c2FibGUsCisJLnByZV9lbmFibGUgPSBhbng3NjI1X3ByZV9lbmFibGUsCisJLm1vZGVfdmFsaWQg
PSBhbng3NjI1X2JyaWRnZV9tb2RlX3ZhbGlkLAorCS5tb2RlX3NldCA9IGFueDc2MjVfYnJpZGdl
X21vZGVfc2V0LAorCS5lbmFibGUgPSBhbng3NjI1X2JyaWRnZV9lbmFibGUsCit9OworCitzdGF0
aWMgaW50IGFueDc2MjVfcmVnaXN0ZXJfaTJjX2R1bW15X2NsaWVudHMoc3RydWN0IGFueDc2MjVf
ZGF0YSAqY3R4LAorCQkJCQkgICAgICBzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50KQoreworCWN0
eC0+aTJjLnR4X3AwX2NsaWVudCA9IGkyY19uZXdfZHVtbXkoY2xpZW50LT5hZGFwdGVyLAorCQkJ
CQkgICAgICBUWF9QMF9BRERSID4+IDEpOworCWlmICghY3R4LT5pMmMudHhfcDBfY2xpZW50KQor
CQlyZXR1cm4gLUVOT01FTTsKKworCWN0eC0+aTJjLnR4X3AxX2NsaWVudCA9IGkyY19uZXdfZHVt
bXkoY2xpZW50LT5hZGFwdGVyLAorCQkJCQkgICAgICBUWF9QMV9BRERSID4+IDEpOworCWlmICgh
Y3R4LT5pMmMudHhfcDFfY2xpZW50KQorCQlnb3RvIGZyZWVfdHhfcDA7CisKKwljdHgtPmkyYy50
eF9wMl9jbGllbnQgPSBpMmNfbmV3X2R1bW15KGNsaWVudC0+YWRhcHRlciwKKwkJCQkJICAgICAg
VFhfUDJfQUREUiA+PiAxKTsKKwlpZiAoIWN0eC0+aTJjLnR4X3AyX2NsaWVudCkKKwkJZ290byBm
cmVlX3R4X3AxOworCisJY3R4LT5pMmMucnhfcDBfY2xpZW50ID0gaTJjX25ld19kdW1teShjbGll
bnQtPmFkYXB0ZXIsCisJCQkJCSAgICAgIFJYX1AwX0FERFIgPj4gMSk7CisJaWYgKCFjdHgtPmky
Yy5yeF9wMF9jbGllbnQpCisJCWdvdG8gZnJlZV90eF9wMjsKKworCWN0eC0+aTJjLnJ4X3AxX2Ns
aWVudCA9IGkyY19uZXdfZHVtbXkoY2xpZW50LT5hZGFwdGVyLAorCQkJCQkgICAgICBSWF9QMV9B
RERSID4+IDEpOworCWlmICghY3R4LT5pMmMucnhfcDFfY2xpZW50KQorCQlnb3RvIGZyZWVfcnhf
cDA7CisKKwljdHgtPmkyYy5yeF9wMl9jbGllbnQgPSBpMmNfbmV3X2R1bW15KGNsaWVudC0+YWRh
cHRlciwKKwkJCQkJICAgICAgUlhfUDJfQUREUiA+PiAxKTsKKwlpZiAoIWN0eC0+aTJjLnJ4X3Ay
X2NsaWVudCkKKwkJZ290byBmcmVlX3J4X3AxOworCisJY3R4LT5pMmMudGNwY19jbGllbnQgPSBp
MmNfbmV3X2R1bW15KGNsaWVudC0+YWRhcHRlciwKKwkJCQkJICAgICBUQ1BDX0lOVEVSRkFDRV9B
RERSID4+IDEpOworCWlmICghY3R4LT5pMmMudGNwY19jbGllbnQpCisJCWdvdG8gZnJlZV9yeF9w
MjsKKworCXJldHVybiAwOworCitmcmVlX3J4X3AyOgorCWkyY191bnJlZ2lzdGVyX2RldmljZShj
dHgtPmkyYy5yeF9wMl9jbGllbnQpOworZnJlZV9yeF9wMToKKwlpMmNfdW5yZWdpc3Rlcl9kZXZp
Y2UoY3R4LT5pMmMucnhfcDFfY2xpZW50KTsKK2ZyZWVfcnhfcDA6CisJaTJjX3VucmVnaXN0ZXJf
ZGV2aWNlKGN0eC0+aTJjLnJ4X3AwX2NsaWVudCk7CitmcmVlX3R4X3AyOgorCWkyY191bnJlZ2lz
dGVyX2RldmljZShjdHgtPmkyYy50eF9wMl9jbGllbnQpOworZnJlZV90eF9wMToKKwlpMmNfdW5y
ZWdpc3Rlcl9kZXZpY2UoY3R4LT5pMmMudHhfcDFfY2xpZW50KTsKK2ZyZWVfdHhfcDA6CisJaTJj
X3VucmVnaXN0ZXJfZGV2aWNlKGN0eC0+aTJjLnR4X3AwX2NsaWVudCk7CisKKwlyZXR1cm4gLUVO
T01FTTsKK30KKworc3RhdGljIHZvaWQgYW54NzYyNV91bnJlZ2lzdGVyX2kyY19kdW1teV9jbGll
bnRzKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sKKwlpMmNfdW5yZWdpc3Rlcl9kZXZpY2Uo
Y3R4LT5pMmMudHhfcDBfY2xpZW50KTsKKwlpMmNfdW5yZWdpc3Rlcl9kZXZpY2UoY3R4LT5pMmMu
dHhfcDFfY2xpZW50KTsKKwlpMmNfdW5yZWdpc3Rlcl9kZXZpY2UoY3R4LT5pMmMudHhfcDJfY2xp
ZW50KTsKKwlpMmNfdW5yZWdpc3Rlcl9kZXZpY2UoY3R4LT5pMmMucnhfcDBfY2xpZW50KTsKKwlp
MmNfdW5yZWdpc3Rlcl9kZXZpY2UoY3R4LT5pMmMucnhfcDFfY2xpZW50KTsKKwlpMmNfdW5yZWdp
c3Rlcl9kZXZpY2UoY3R4LT5pMmMucnhfcDJfY2xpZW50KTsKKwlpMmNfdW5yZWdpc3Rlcl9kZXZp
Y2UoY3R4LT5pMmMudGNwY19jbGllbnQpOworfQorCitzdGF0aWMgaW50IGFueDc2MjVfaTJjX3By
b2JlKHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQsCisJCQkgICAgIGNvbnN0IHN0cnVjdCBpMmNf
ZGV2aWNlX2lkICppZCkKK3sKKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpwbGF0Zm9ybTsKKwlzdHJ1
Y3QgYW54NzYyNV9wbGF0Zm9ybV9kYXRhICpwZGF0YTsKKwlpbnQgcmV0ID0gMDsKKwlzdHJ1Y3Qg
ZGV2aWNlICpkZXYgPSAmY2xpZW50LT5kZXY7CisKKwlpZiAoIWkyY19jaGVja19mdW5jdGlvbmFs
aXR5KGNsaWVudC0+YWRhcHRlciwKKwkJCQkgICAgIEkyQ19GVU5DX1NNQlVTX0kyQ19CTE9DSykp
IHsKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJhbng3NjI1J3MgaTJjIGJ1cyBkb2Vzbid0IHN1cHBv
cnRcbiIpOworCQlyZXR1cm4gLUVOT0RFVjsKKwl9CisKKwlwbGF0Zm9ybSA9IGt6YWxsb2Moc2l6
ZW9mKCpwbGF0Zm9ybSksIEdGUF9LRVJORUwpOworCWlmICghcGxhdGZvcm0pIHsKKwkJRFJNX0RF
Vl9FUlJPUihkZXYsICJmYWlsZWQgdG8gYWxsb2NhdGUgZHJpdmVyIGRhdGFcbiIpOworCQlyZXR1
cm4gLUVOT01FTTsKKwl9CisKKwlwZGF0YSA9ICZwbGF0Zm9ybS0+cGRhdGE7CisKKwlyZXQgPSBh
bng3NjI1X3BhcnNlX2R0KGRldiwgcGRhdGEpOworCWlmIChyZXQpIHsKKwkJRFJNX0RFVl9FUlJP
UihkZXYsICJmYWlsZWQgdG8gcGFyc2UgZGV2aWNldHJlZS5cbiIpOworCQlnb3RvIGZyZWVfcGxh
dGZvcm07CisJfQorCisJYW54NzYyNV9pbml0X2dwaW8ocGxhdGZvcm0pOworCisJLyogdG8gYWNj
ZXNzIGdsb2JhbCBwbGF0Zm9ybSBkYXRhICovCisJcGxhdGZvcm0tPmNsaWVudCA9IGNsaWVudDsK
KwlpMmNfc2V0X2NsaWVudGRhdGEoY2xpZW50LCBwbGF0Zm9ybSk7CisKKwlpZiAocGxhdGZvcm0t
PnBkYXRhLmV4dGNvbl9zdXBwb3J0ZWQpIHsKKwkJLyogZ2V0IGV4dGNvbiBkZXZpY2UgZnJvbSBE
VFMgKi8KKwkJcmV0ID0gLUVJTlZBTDsKKwkJcGxhdGZvcm0tPmV4dGNvbiA9IGV4dGNvbl9nZXRf
ZWRldl9ieV9waGFuZGxlKGRldiwgMCk7CisJCWlmIChQVFJfRVJSKHBsYXRmb3JtLT5leHRjb24p
ID09IC1FUFJPQkVfREVGRVIpCisJCQlnb3RvIGZyZWVfcGxhdGZvcm07CisKKwkJaWYgKElTX0VS
UihwbGF0Zm9ybS0+ZXh0Y29uKSkgeworCQkJRFJNX0RFVl9FUlJPUihkZXYsCisJCQkJICAgICAg
ImNhbiBub3QgZ2V0IGV4dGNvbiBkZXZpY2UhIik7CisJCQlnb3RvIGZyZWVfcGxhdGZvcm07CisJ
CX0KKworCQlyZXQgPSBhbng3NjI1X2V4dGNvbl9ub3RpZmllcl9pbml0KHBsYXRmb3JtKTsKKwkJ
aWYgKHJldCkKKwkJCWdvdG8gZnJlZV9wbGF0Zm9ybTsKKwl9CisKKwlhdG9taWNfc2V0KCZwbGF0
Zm9ybS0+cG93ZXJfc3RhdHVzLCAwKTsKKworCW11dGV4X2luaXQoJnBsYXRmb3JtLT5sb2NrKTsK
KworCXBsYXRmb3JtLT5wZGF0YS5pbnRwX2lycSA9IGNsaWVudC0+aXJxOworCWlmIChwbGF0Zm9y
bS0+cGRhdGEuaW50cF9pcnEpIHsKKwkJSU5JVF9XT1JLKCZwbGF0Zm9ybS0+d29yaywgYW54NzYy
NV93b3JrX2Z1bmMpOworCQlwbGF0Zm9ybS0+d29ya3F1ZXVlID0gY3JlYXRlX3dvcmtxdWV1ZSgi
YW54NzYyNV93b3JrIik7CisJCWlmICghcGxhdGZvcm0tPndvcmtxdWV1ZSkgeworCQkJRFJNX0RF
Vl9FUlJPUihkZXYsICJmYWlsZWQgdG8gY3JlYXRlIHdvcmsgcXVldWVcbiIpOworCQkJcmV0ID0g
LUVOT01FTTsKKwkJCWdvdG8gZnJlZV9wbGF0Zm9ybTsKKwkJfQorCisJCXJldCA9IGRldm1fcmVx
dWVzdF90aHJlYWRlZF9pcnEoZGV2LCBwbGF0Zm9ybS0+cGRhdGEuaW50cF9pcnEsCisJCQkJCQlO
VUxMLCBhbng3NjI1X2ludHJfaHBkX2lzciwKKwkJCQkJCUlSUUZfVFJJR0dFUl9GQUxMSU5HIHwK
KwkJCQkJCUlSUUZfT05FU0hPVCwKKwkJCQkJCSJhbng3NjI1LWludHAiLCBwbGF0Zm9ybSk7CisJ
CWlmIChyZXQpIHsKKwkJCURSTV9ERVZfRVJST1IoZGV2LCAiZmFpbGVkIHRvIHJlcXVlc3QgaXJx
XG4iKTsKKwkJCWdvdG8gZnJlZV93cTsKKwkJfQorCX0KKworCWlmIChhbng3NjI1X3JlZ2lzdGVy
X2kyY19kdW1teV9jbGllbnRzKHBsYXRmb3JtLCBjbGllbnQpICE9IDApIHsKKwkJcmV0ID0gLUVO
T01FTTsKKwkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gcmVzZXJ2ZSBJMkMgYnVzLlxuIik7CisJCWdv
dG8gZnJlZV93cTsKKwl9CisKKwlpZiAocGxhdGZvcm0tPnBkYXRhLmxvd19wb3dlcl9tb2RlID09
IDApIHsKKwkJYW54NzYyNV9kaXNhYmxlX3BkX3Byb3RvY29sKHBsYXRmb3JtKTsKKwkJYXRvbWlj
X3NldCgmcGxhdGZvcm0tPnBvd2VyX3N0YXR1cywgMSk7CisJfQorCisJLyogYWRkIHdvcmsgZnVu
Y3Rpb24gKi8KKwlpZiAocGxhdGZvcm0tPnBkYXRhLmludHBfaXJxKQorCQlxdWV1ZV93b3JrKHBs
YXRmb3JtLT53b3JrcXVldWUsICZwbGF0Zm9ybS0+d29yayk7CisKKwlwbGF0Zm9ybS0+YnJpZGdl
LmZ1bmNzID0gJmFueDc2MjVfYnJpZGdlX2Z1bmNzOworCWlmIChJU19FTkFCTEVEKENPTkZJR19P
RikpCisJCXBsYXRmb3JtLT5icmlkZ2Uub2Zfbm9kZSA9IGNsaWVudC0+ZGV2Lm9mX25vZGU7CisJ
ZHJtX2JyaWRnZV9hZGQoJnBsYXRmb3JtLT5icmlkZ2UpOworCisJRFJNX0RFVl9ERUJVR19EUklW
RVIoZGV2LCAicHJvYmUgZG9uZVxuIik7CisKKwlyZXR1cm4gMDsKKworZnJlZV93cToKKwlpZiAo
cGxhdGZvcm0tPndvcmtxdWV1ZSkKKwkJZGVzdHJveV93b3JrcXVldWUocGxhdGZvcm0tPndvcmtx
dWV1ZSk7CisKK2ZyZWVfcGxhdGZvcm06CisJa2ZyZWUocGxhdGZvcm0pOworCisJcmV0dXJuIHJl
dDsKK30KKworc3RhdGljIGludCBhbng3NjI1X2kyY19yZW1vdmUoc3RydWN0IGkyY19jbGllbnQg
KmNsaWVudCkKK3sKKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpwbGF0Zm9ybSA9IGkyY19nZXRfY2xp
ZW50ZGF0YShjbGllbnQpOworCisJZHJtX2JyaWRnZV9yZW1vdmUoJnBsYXRmb3JtLT5icmlkZ2Up
OworCisJaWYgKHBsYXRmb3JtLT5wZGF0YS5pbnRwX2lycSkKKwkJZGVzdHJveV93b3JrcXVldWUo
cGxhdGZvcm0tPndvcmtxdWV1ZSk7CisKKwlpZiAocGxhdGZvcm0tPnBkYXRhLmV4dGNvbl9zdXBw
b3J0ZWQpIHsKKwkJZGV2bV9leHRjb25fdW5yZWdpc3Rlcl9ub3RpZmllcigmcGxhdGZvcm0tPmNs
aWVudC0+ZGV2LAorCQkJCQkJcGxhdGZvcm0tPmV4dGNvbiwKKwkJCQkJCUVYVENPTl9ESVNQX0RQ
LAorCQkJCQkJJnBsYXRmb3JtLT5ldmVudF9uYik7CisJCWZsdXNoX3dvcmsoJnBsYXRmb3JtLT5l
eHRjb25fd3EpOworCX0KKworCWFueDc2MjVfdW5yZWdpc3Rlcl9pMmNfZHVtbXlfY2xpZW50cyhw
bGF0Zm9ybSk7CisKKwlrZnJlZShwbGF0Zm9ybSk7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBj
b25zdCBzdHJ1Y3QgaTJjX2RldmljZV9pZCBhbng3NjI1X2lkW10gPSB7CisJeyJhbng3NjI1Iiwg
MH0sCisJe30KK307CisKK01PRFVMRV9ERVZJQ0VfVEFCTEUoaTJjLCBhbng3NjI1X2lkKTsKKwor
I2lmZGVmIENPTkZJR19PRgorc3RhdGljIGNvbnN0IHN0cnVjdCBvZl9kZXZpY2VfaWQgYW54X21h
dGNoX3RhYmxlW10gPSB7CisJey5jb21wYXRpYmxlID0gImFuYWxvZ2l4LGFueDc2MjUiLH0sCisJ
e30sCit9OworI2VuZGlmCisKK3N0YXRpYyBzdHJ1Y3QgaTJjX2RyaXZlciBhbng3NjI1X2RyaXZl
ciA9IHsKKwkuZHJpdmVyID0geworCQkubmFtZSA9ICJhbng3NjI1IiwKKyNpZmRlZiBDT05GSUdf
T0YKKwkJLm9mX21hdGNoX3RhYmxlID0gYW54X21hdGNoX3RhYmxlLAorI2VuZGlmCisJfSwKKwku
cHJvYmUgPSBhbng3NjI1X2kyY19wcm9iZSwKKwkucmVtb3ZlID0gYW54NzYyNV9pMmNfcmVtb3Zl
LAorCisJLmlkX3RhYmxlID0gYW54NzYyNV9pZCwKK307CisKK21vZHVsZV9pMmNfZHJpdmVyKGFu
eDc2MjVfZHJpdmVyKTsKKworTU9EVUxFX0RFU0NSSVBUSU9OKCJNSVBJMkRQIGFueDc2MjUgZHJp
dmVyIik7CitNT0RVTEVfQVVUSE9SKCJYaW4gSmkgPHhqaUBhbmFsb2dpeHNlbWkuY29tPiIpOwor
TU9EVUxFX0xJQ0VOU0UoIkdQTCB2MiIpOworTU9EVUxFX1ZFUlNJT04oQU5YNzYyNV9EUlZfVkVS
U0lPTik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L2FueDc2
MjUuaCBiL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvYW54NzYyNS5oCm5ldyBmaWxl
IG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjBmZmE4ZDAKLS0tIC9kZXYvbnVsbAorKysgYi9k
cml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L2FueDc2MjUuaApAQCAtMCwwICsxLDQwNiBA
QAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seSAqLworLyoKKyAqIENv
cHlyaWdodChjKSAyMDE2LCBBbmFsb2dpeCBTZW1pY29uZHVjdG9yLiBBbGwgcmlnaHRzIHJlc2Vy
dmVkLgorICoKKyAqLworCisjaWZuZGVmIF9fQU5YNzYyNV9IX18KKyNkZWZpbmUgX19BTlg3NjI1
X0hfXworCisjaWZuZGVmIExPR19UQUcKKyNkZWZpbmUgTE9HX1RBRyAiYW54NzYyNWRwIgorI2Vu
ZGlmCisKKyNkZWZpbmUgQU5YNzYyNV9EUlZfVkVSU0lPTiAiMC4xLjA0IgorCisvKiBMb2FkaW5n
IE9DTSByZS10cnlpbmcgdGltZXMgKi8KKyNkZWZpbmUgT0NNX0xPQURJTkdfVElNRSAxMAorCisv
KioqKioqKioqICBBTlg3NjI1IFJlZ2lzdGVyICAqKioqKioqKioqLworI2RlZmluZSBUWF9QMF9B
RERSCQkJCTB4NzAKKyNkZWZpbmUgVFhfUDFfQUREUgkJCQkweDdBCisjZGVmaW5lIFRYX1AyX0FE
RFIJCQkJMHg3MgorCisjZGVmaW5lIFJYX1AwX0FERFIJCQkJMHg3ZQorI2RlZmluZSBSWF9QMV9B
RERSCQkJCTB4ODQKKyNkZWZpbmUgUlhfUDJfQUREUgkJCQkweDU0CisKKyNkZWZpbmUgUlNWRF8w
MF9BRERSCQkJCTB4MDAKKyNkZWZpbmUgUlNWRF9EMV9BRERSCQkJCTB4RDEKKyNkZWZpbmUgUlNW
RF82MF9BRERSCQkJCTB4NjAKKyNkZWZpbmUgUlNWRF8zOV9BRERSCQkJCTB4MzkKKyNkZWZpbmUg
UlNWRF83Rl9BRERSCQkJCTB4N0YKKworI2RlZmluZSBUQ1BDX0lOVEVSRkFDRV9BRERSCQkJMHg1
OAorCisvKiBhbng3NjI1IGNsb2NrIGZyZXF1ZW5jeSBpbiBIeiAqLworI2RlZmluZSBYVEFMX0ZS
USAgICAgICAgKDI3ICogMTAwMDAwMCkKKworI2RlZmluZSAgUE9TVF9ESVZJREVSX01JTgkxCisj
ZGVmaW5lICBQT1NUX0RJVklERVJfTUFYCTE2CisjZGVmaW5lICBQTExfT1VUX0ZSRVFfTUlOCTUy
MDAwMDAwMFVMCisjZGVmaW5lICBQTExfT1VUX0ZSRVFfTUFYCTczMDAwMDAwMFVMCisjZGVmaW5l
ICBQTExfT1VUX0ZSRVFfQUJTX01JTgkzMDAwMDAwMDBVTAorI2RlZmluZSAgUExMX09VVF9GUkVR
X0FCU19NQVgJODAwMDAwMDAwVUwKKyNkZWZpbmUgIE1BWF9VTlNJR05FRF8yNEJJVAkxNjc3NzIx
NVVMCisKKy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKiovCisvKiBSZWdpc3RlciBkZWZpbml0aW9uIG9mIGRldmljZSBhZGRyZXNz
IDB4NTggKi8KKworI2RlZmluZSBQUk9EVUNUX0lEX0wgMHgwMgorI2RlZmluZSBQUk9EVUNUX0lE
X0ggMHgwMworCisjZGVmaW5lIElOVFJfQUxFUlRfMSAgMHhDQworI2RlZmluZSBJTlRSX1NPRlRX
QVJFX0lOVCBCSVQoMykKKyNkZWZpbmUgSU5UUl9SRUNFSVZFRF9NU0cgQklUKDUpCisKKyNkZWZp
bmUgU1lTVEVNX1NUU1RVUyAweDQ1CisjZGVmaW5lIElOVEVSRkFDRV9DSEFOR0VfSU5UIDB4NDQK
KyNkZWZpbmUgSFBEX1NUQVRVU19DSEFOR0UgMHg4MAorI2RlZmluZSBIUERfU1RBVFVTIDB4ODAK
KworLyoqKioqKioqIEVORCBvZiBJMkMgQWRkcmVzcyAweDU4ICoqKioqKioqLworCisvKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
LworLyogUmVnaXN0ZXIgZGVmaW5pdGlvbiBvZiBkZXZpY2UgYWRkcmVzcyAweDcwICovCisjZGVm
aW5lICBJMkNfQUREUl83MF9EUFRYICAgICAgICAgICAgICAweDcwCisKKyNkZWZpbmUgU1BfVFhf
TElOS19CV19TRVRfUkVHIDB4QTAKKyNkZWZpbmUgU1BfVFhfTEFORV9DT1VOVF9TRVRfUkVHIDB4
QTEKKworI2RlZmluZSBNX1ZJRF8wIDB4QzAKKyNkZWZpbmUgTV9WSURfMSAweEMxCisjZGVmaW5l
IE1fVklEXzIgMHhDMgorI2RlZmluZSBOX1ZJRF8wIDB4QzMKKyNkZWZpbmUgTl9WSURfMSAweEM0
CisjZGVmaW5lIE5fVklEXzIgMHhDNQorCisvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLworLyogUmVnaXN0ZXIgZGVmaW5pdGlv
biBvZiBkZXZpY2UgYWRkcmVzcyAweDcyICovCisjZGVmaW5lIEFVWF9SU1QJMHgwNAorI2RlZmlu
ZSBSU1RfQ1RSTDIgMHgwNworCisjZGVmaW5lIFNQX1RYX1RPVEFMX0xJTkVfU1RBX0wgMHgyNAor
I2RlZmluZSBTUF9UWF9UT1RBTF9MSU5FX1NUQV9IIDB4MjUKKyNkZWZpbmUgU1BfVFhfQUNUX0xJ
TkVfU1RBX0wgMHgyNgorI2RlZmluZSBTUF9UWF9BQ1RfTElORV9TVEFfSCAweDI3CisjZGVmaW5l
IFNQX1RYX1ZfRl9QT1JDSF9TVEEgMHgyOAorI2RlZmluZSBTUF9UWF9WX1NZTkNfU1RBIDB4MjkK
KyNkZWZpbmUgU1BfVFhfVl9CX1BPUkNIX1NUQSAweDJBCisjZGVmaW5lIFNQX1RYX1RPVEFMX1BJ
WEVMX1NUQV9MIDB4MkIKKyNkZWZpbmUgU1BfVFhfVE9UQUxfUElYRUxfU1RBX0ggMHgyQworI2Rl
ZmluZSBTUF9UWF9BQ1RfUElYRUxfU1RBX0wgMHgyRAorI2RlZmluZSBTUF9UWF9BQ1RfUElYRUxf
U1RBX0ggMHgyRQorI2RlZmluZSBTUF9UWF9IX0ZfUE9SQ0hfU1RBX0wgMHgyRgorI2RlZmluZSBT
UF9UWF9IX0ZfUE9SQ0hfU1RBX0ggMHgzMAorI2RlZmluZSBTUF9UWF9IX1NZTkNfU1RBX0wgMHgz
MQorI2RlZmluZSBTUF9UWF9IX1NZTkNfU1RBX0ggMHgzMgorI2RlZmluZSBTUF9UWF9IX0JfUE9S
Q0hfU1RBX0wgMHgzMworI2RlZmluZSBTUF9UWF9IX0JfUE9SQ0hfU1RBX0ggMHgzNAorCisjZGVm
aW5lIFNQX1RYX1ZJRF9DVFJMIDB4ODQKKyNkZWZpbmUgU1BfVFhfQlBDX01BU0sgMHhFMAorI2Rl
ZmluZSBTUF9UWF9CUENfNiAgICAweDAwCisjZGVmaW5lIFNQX1RYX0JQQ184ICAgIDB4MjAKKyNk
ZWZpbmUgU1BfVFhfQlBDXzEwICAgMHg0MAorI2RlZmluZSBTUF9UWF9CUENfMTIgICAweDYwCisK
KyNkZWZpbmUgVklERU9fQklUX01BVFJJWF8xMiAweDRjCisKKyNkZWZpbmUgQVVESU9fQ0hBTk5F
TF9TVEFUVVNfMSAweGQwCisjZGVmaW5lIEFVRElPX0NIQU5ORUxfU1RBVFVTXzIgMHhkMQorI2Rl
ZmluZSBBVURJT19DSEFOTkVMX1NUQVRVU18zIDB4ZDIKKyNkZWZpbmUgQVVESU9fQ0hBTk5FTF9T
VEFUVVNfNCAweGQzCisjZGVmaW5lIEFVRElPX0NIQU5ORUxfU1RBVFVTXzUgMHhkNAorI2RlZmlu
ZSBBVURJT19DSEFOTkVMX1NUQVRVU182IDB4ZDUKKyNkZWZpbmUgVERNX1NMQVZFX01PREUgMHgx
MAorI2RlZmluZSBJMlNfU0xBVkVfTU9ERSAweDA4CisKKyNkZWZpbmUgQVVESU9fQ09OVFJPTF9S
RUdJU1RFUiAweGU2CisjZGVmaW5lIFRETV9USU1JTkdfTU9ERSAweDA4CisKKyNkZWZpbmUgIEky
Q19BRERSXzcyX0RQVFggICAgICAgICAgICAgIDB4NzIKKworI2RlZmluZSAgVklERU9fQ09OVFJP
TF8wICAweDA4CisKKyNkZWZpbmUgIEFDVElWRV9MSU5FU19MICAgICAgICAgMHgxNAorI2RlZmlu
ZSAgQUNUSVZFX0xJTkVTX0ggICAgICAgICAweDE1ICAvKiBub3RlOiBiaXRbNzo2XSBhcmUgcmVz
ZXJ2ZWQgKi8KKyNkZWZpbmUgIFZFUlRJQ0FMX0ZST05UX1BPUkNIICAgMHgxNgorI2RlZmluZSAg
VkVSVElDQUxfU1lOQ19XSURUSCAgICAweDE3CisjZGVmaW5lICBWRVJUSUNBTF9CQUNLX1BPUkNI
ICAgIDB4MTgKKworI2RlZmluZSAgSE9SSVpPTlRBTF9UT1RBTF9QSVhFTFNfTCAgICAweDE5Cisj
ZGVmaW5lICBIT1JJWk9OVEFMX1RPVEFMX1BJWEVMU19IICAgIDB4MUEgIC8qIG5vdGU6IGJpdFs3
OjZdIGFyZSByZXNlcnZlZCAqLworI2RlZmluZSAgSE9SSVpPTlRBTF9BQ1RJVkVfUElYRUxTX0wg
ICAweDFCCisjZGVmaW5lICBIT1JJWk9OVEFMX0FDVElWRV9QSVhFTFNfSCAgIDB4MUMgIC8qIG5v
dGU6IGJpdFs3OjZdIGFyZSByZXNlcnZlZCAqLworI2RlZmluZSAgSE9SSVpPTlRBTF9GUk9OVF9Q
T1JDSF9MICAgICAweDFECisjZGVmaW5lICBIT1JJWk9OVEFMX0ZST05UX1BPUkNIX0ggICAgIDB4
MUUgIC8qIG5vdGU6IGJpdFs3OjRdIGFyZSByZXNlcnZlZCAqLworI2RlZmluZSAgSE9SSVpPTlRB
TF9TWU5DX1dJRFRIX0wgICAgICAweDFGCisjZGVmaW5lICBIT1JJWk9OVEFMX1NZTkNfV0lEVEhf
SCAgICAgIDB4MjAgIC8qIG5vdGU6IGJpdFs3OjRdIGFyZSByZXNlcnZlZCAqLworI2RlZmluZSAg
SE9SSVpPTlRBTF9CQUNLX1BPUkNIX0wgICAgICAweDIxCisjZGVmaW5lICBIT1JJWk9OVEFMX0JB
Q0tfUE9SQ0hfSCAgICAgIDB4MjIgIC8qIG5vdGU6IGJpdFs3OjRdIGFyZSByZXNlcnZlZCAqLwor
CisvKioqKioqKiogRU5EIG9mIEkyQyBBZGRyZXNzIDB4NzIgKioqKioqKioqLworLyoqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8K
Ky8qIFJlZ2lzdGVyIGRlZmluaXRpb24gb2YgZGV2aWNlIGFkZHJlc3MgMHg3ZSAqLworCisjZGVm
aW5lICBJMkNfQUREUl83RV9GTEFTSF9DT05UUk9MTEVSICAweDdFCisKKyNkZWZpbmUgRkxBU0hf
TE9BRF9TVEEgMHgwNQorI2RlZmluZSBGTEFTSF9MT0FEX1NUQV9DSEsJQklUKDcpCisKKyNkZWZp
bmUgIFhUQUxfRlJRX1NFTCAgICAweDNGCisvKiBiaXQgZmllbGQgcG9zaXRpb25zICovCisjZGVm
aW5lICBYVEFMX0ZSUV9TRUxfUE9TICAgIDUKKy8qIGJpdCBmaWVsZCB2YWx1ZXMgKi8KKyNkZWZp
bmUgIFhUQUxfRlJRXzE5TTIgICAoMCA8PCBYVEFMX0ZSUV9TRUxfUE9TKQorI2RlZmluZSAgWFRB
TF9GUlFfMjdNICAgICg0IDw8IFhUQUxfRlJRX1NFTF9QT1MpCisKKyNkZWZpbmUgIFJfRFNDX0NU
UkxfMCAgICAweDQwCisjZGVmaW5lICBSRUFEX1NUQVRVU19FTiAgNworI2RlZmluZSAgQ0xLXzFN
RUdfUkIgICAgIDYgIC8qIDFNSHogY2xvY2sgcmVzZXQ7IDA9cmVzZXQsIDA9cmVzZXQgcmVsZWFz
ZSAqLworI2RlZmluZSAgRFNDX0JJU1RfRE9ORSAgIDEgIC8qIGJpdFs1OjFdOiAxPURTQyBNQklT
VCBwYXNzICovCisjZGVmaW5lICBEU0NfRU4gICAgICAgICAgMHgwMSAgLyogMT1EU0MgZW5hYmxl
ZCwgMD1EU0MgZGlzYWJsZWQgKi8KKworI2RlZmluZSBPQ01fRldfVkVSU0lPTiAgIDB4MzEKKyNk
ZWZpbmUgT0NNX0ZXX1JFVkVSU0lPTiAweDMyCisKKyNkZWZpbmUgQVBfQVVYX0FERFJfN18wICAg
MHgxMQorI2RlZmluZSBBUF9BVVhfQUREUl8xNV84ICAweDEyCisjZGVmaW5lIEFQX0FVWF9BRERS
XzE5XzE2IDB4MTMKKworLyogbm90ZTogYml0WzA6M10gQVVYIHN0YXR1cywgYml0IDQgb3BfZW4s
IGJpdCA1IGFkZHJlc3Mgb25seSAqLworI2RlZmluZSBBUF9BVVhfQ1RSTF9TVEFUVVMgMHgxNAor
I2RlZmluZSBBUF9BVVhfQ1RSTF9PUF9FTiAweDEwCisjZGVmaW5lIEFQX0FVWF9DVFJMX0FERFJP
TkxZIDB4MjAKKworI2RlZmluZSBBUF9BVVhfQlVGRl9TVEFSVCAweDE1CisjZGVmaW5lIFBJWEVM
X0NMT0NLX0wgMHgyNQorI2RlZmluZSBQSVhFTF9DTE9DS19IIDB4MjYKKworI2RlZmluZSBBUF9B
VVhfQ09NTUFORCAweDI3ICAvKiBjb20rbGVuICovCisvKiBiaXQgMCYxOiAzRCB2aWRlbyBzdHJ1
Y3R1cmUgKi8KKy8qIDB4MDE6IGZyYW1lIHBhY2tpbmcsICAweDAyOkxpbmUgYWx0ZXJuYXRpdmUs
IDB4MDM6U2lkZS1ieS1zaWRlKGZ1bGwpICovCisjZGVmaW5lIEFQX0FWX1NUQVRVUyAweDI4Cisj
ZGVmaW5lIEFQX1ZJREVPX0NIRyAgQklUKDIpCisjZGVmaW5lIEFQX0FVRElPX0NIRyAgQklUKDMp
CisjZGVmaW5lIEFQX01JUElfTVVURSAgQklUKDQpIC8qIDE6TUlQSSBpbnB1dCBtdXRlLCAwOiB1
bW11dGUgKi8KKyNkZWZpbmUgQVBfTUlQSV9SWF9FTiBCSVQoNSkgLyogMTogTUlQSSBSWCBpbnB1
dCBpbiAgMDogbm8gUlggaW4gKi8KKyNkZWZpbmUgQVBfRElTQUJMRV9QRCBCSVQoNikKKyNkZWZp
bmUgQVBfRElTQUJMRV9ESVNQTEFZIEJJVCg3KQorLyoqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KKy8qIFJlZ2lzdGVyIGRlZmlu
aXRpb24gb2YgZGV2aWNlIGFkZHJlc3MgMHg4NCAqLworI2RlZmluZSAgTUlQSV9QSFlfQ09OVFJP
TF8zICAgICAgICAgICAgMHgwMworI2RlZmluZSAgTUlQSV9IU19QV0RfQ0xLICAgICAgICAgICAg
ICAgNworI2RlZmluZSAgTUlQSV9IU19SVF9DTEsgICAgICAgICAgICAgICAgNgorI2RlZmluZSAg
TUlQSV9QRF9DTEsgICAgICAgICAgICAgICAgICAgNQorI2RlZmluZSAgTUlQSV9DTEtfUlRfTUFO
VUFMX1BEX0VOICAgICAgNAorI2RlZmluZSAgTUlQSV9DTEtfSFNfTUFOVUFMX1BEX0VOICAgICAg
MworI2RlZmluZSAgTUlQSV9DTEtfREVUX0RFVF9CWVBBU1MgICAgICAgMgorI2RlZmluZSAgTUlQ
SV9DTEtfTUlTU19DVFJMICAgICAgICAgICAgMQorI2RlZmluZSAgTUlQSV9QRF9MUFRYX0NIX01B
TlVBTF9QRF9FTiAgMAorCisjZGVmaW5lICBNSVBJX0xBTkVfQ1RSTF8wCQkweDA1CisjZGVmaW5l
ICBNSVBJX1RJTUVfSFNfUFJQUgkJMHgwOAorCisvKiBBZnRlciBNSVBJIFJYIHByb3RvY29sIGxh
eWVyIHJlY2VpdmVkIHRoaXMgbWFueSB2aWRlbyBmcmFtZXMsICovCisvKiBwcm90b2NvbCBsYXll
ciBzdGFydHMgdG8gcmVjb25zdHJ1Y3QgdmlkZW8gc3RyZWFtIGZyb20gUEhZICovCisjZGVmaW5l
ICBNSVBJX1ZJREVPX1NUQUJMRV9DTlQgICAgICAgICAgIDB4MEEKKworI2RlZmluZSAgTUlQSV9M
QU5FX0NUUkxfMTAgICAgICAgICAgICAgICAweDBGCisjZGVmaW5lICBNSVBJX0RJR0lUQUxfQURK
XzEgICAweDFCCisKKyNkZWZpbmUgIE1JUElfUExMX01fTlVNXzIzXzE2ICAgMHgxRQorI2RlZmlu
ZSAgTUlQSV9QTExfTV9OVU1fMTVfOCAgICAweDFGCisjZGVmaW5lICBNSVBJX1BMTF9NX05VTV83
XzAgICAgIDB4MjAKKyNkZWZpbmUgIE1JUElfUExMX05fTlVNXzIzXzE2ICAgMHgyMQorI2RlZmlu
ZSAgTUlQSV9QTExfTl9OVU1fMTVfOCAgICAweDIyCisjZGVmaW5lICBNSVBJX1BMTF9OX05VTV83
XzAgICAgIDB4MjMKKworI2RlZmluZSAgTUlQSV9ESUdJVEFMX1BMTF82ICAgICAweDJBCisvKiBi
aXRbNzo2XTogVkNPIGJhbmQgY29udHJvbCwgb25seSBlZmZlY3RpdmUgKi8KKy8qIHdoZW4gTUlQ
SV9QTExfRk9SQ0VfQkFORF9FTiAoMHg4NDoweDJCWzZdKSBpcyAxICovCisjZGVmaW5lICBNSVBJ
X01fTlVNX1JFQURZICAgICAgICAweDEwCisjZGVmaW5lICBNSVBJX05fTlVNX1JFQURZICAgICAg
ICAweDA4CisjZGVmaW5lICBTVEFCTEVfSU5URUdFUl9DTlRfRU4gICAweDA0CisjZGVmaW5lICBN
SVBJX1BMTF9URVNUX0JJVCAgICAgICAwCisvKiBiaXRbMTowXTogdGVzdCBwb2ludCBvdXRwdXQg
c2VsZWN0IC0gKi8KKy8qIDAwOiBWQ08gcG93ZXIsIDAxOiBkdmRkX3BkdCwgMTA6IGR2ZGQsIDEx
OiB2Y294ICovCisKKyNkZWZpbmUgIE1JUElfRElHSVRBTF9QTExfNyAgICAgIDB4MkIKKyNkZWZp
bmUgIE1JUElfUExMX0ZPUkNFX05fRU4gICAgIDcKKyNkZWZpbmUgIE1JUElfUExMX0ZPUkNFX0JB
TkRfRU4gIDYKKworI2RlZmluZSAgTUlQSV9QTExfVkNPX1RVTkVfUkVHICAgNAorLyogYml0WzU6
NF06IFZDTyBtZXRhbCBjYXBhY2l0YW5jZSAtICovCisvKiAwMDogKzIwJSBmYXN0LCAwMTogKzEw
JSBmYXN0IChkZWZhdWx0KSwgMTA6IHR5cGljYWwsIDExOiAtMTAlIHNsb3cgKi8KKyNkZWZpbmUg
IE1JUElfUExMX1ZDT19UVU5FX1JFR19WQUwgICAweDMwCisKKyNkZWZpbmUgIE1JUElfUExMX1BM
TF9MRE9fQklUICAgIDIKKy8qIGJpdFszOjJdOiB2Y29fdjJpIHBvd2VyIC0gKi8KKy8qIDAwOiAx
LjQwViwgMDE6IDEuNDVWIChkZWZhdWx0KSwgMTA6IDEuNTBWLCAxMTogMS41NVYgKi8KKyNkZWZp
bmUgIE1JUElfUExMX1JFU0VUX04gICAgICAgIDB4MDIKKyNkZWZpbmUgIE1JUElfRlJRX0ZPUkNF
X05ERVQgICAgIDAKKworI2RlZmluZSAgTUlQSV9BTEVSVF9DTFJfMCAgICAgICAgMHgyRAorI2Rl
ZmluZSAgSFNfbGlua19lcnJvcl9jbGVhciAgICAgNworLyogVGhpcyBiaXQgaXRzZWxmIGlzIFMv
QywgYW5kIGl0IGNsZWFycyAweDg0OjB4MzFbN10gKi8KKworI2RlZmluZSAgTUlQSV9BTEVSVF9P
VVRfMCAgICAgICAgMHgzMQorI2RlZmluZSAgY2hlY2tfc3VtX2Vycl9oc19zeW5jICAgNworLyog
VGhpcyBiaXQgaXMgY2xlYXJlZCBieSAweDg0OjB4MkRbN10gKi8KKworI2RlZmluZSAgTUlQSV9E
SUdJVEFMX1BMTF84ICAgIDB4MzMKKyNkZWZpbmUgIE1JUElfUE9TVF9ESVZfVkFMICAgICA0Cisv
KiBuIG1lYW5zIGRpdmlkZWQgYnkgKG4rMSksIG4gPSAwfjE1ICovCisjZGVmaW5lICBNSVBJX0VO
X0xPQ0tfRlJaICAgICAgMworI2RlZmluZSAgTUlQSV9GUlFfQ09VTlRFUl9SU1QgIDIKKyNkZWZp
bmUgIE1JUElfRlJRX1NFVF9SRUdfOCAgICAxCisvKiBiaXQgMCBpcyByZXNlcnZlZCAqLworCisj
ZGVmaW5lICBNSVBJX0RJR0lUQUxfUExMXzkgICAgMHgzNAorCisjZGVmaW5lICBNSVBJX0RJR0lU
QUxfUExMXzE2ICAgMHgzQgorI2RlZmluZSAgTUlQSV9GUlFfRlJFRVpFX05ERVQgICAgICAgICAg
NworI2RlZmluZSAgTUlQSV9GUlFfUkVHX1NFVF9FTkFCTEUgICAgICAgNgorI2RlZmluZSAgTUlQ
SV9SRUdfRk9SQ0VfU0VMX0VOICAgICAgICAgNQorI2RlZmluZSAgTUlQSV9SRUdfU0VMX0RJVl9S
RUcgICAgICAgICAgNAorI2RlZmluZSAgTUlQSV9SRUdfRk9SQ0VfUFJFX0RJVl9FTiAgICAgMwor
LyogYml0IDIgaXMgcmVzZXJ2ZWQgKi8KKyNkZWZpbmUgIE1JUElfRlJFRl9EX0lORCAgICAgICAg
ICAgICAgIDEKKyNkZWZpbmUgIFJFRl9DTEtfMjcwMDBLSFogICAgMQorI2RlZmluZSAgUkVGX0NM
S18xOTIwMEtIWiAgICAwCisjZGVmaW5lICBNSVBJX1JFR19QTExfUExMX1RFU1RfRU5BQkxFICAw
CisKKyNkZWZpbmUgIE1JUElfRElHSVRBTF9QTExfMTggIDB4M0QKKyNkZWZpbmUgIEZSUV9DT1VO
VF9SQl9TRUwgICAgICAgNworI2RlZmluZSAgUkVHX0ZPUkNFX1BPU1RfRElWX0VOICA2CisjZGVm
aW5lICBNSVBJX0RQSV9TRUxFQ1QgICAgICAgIDUKKyNkZWZpbmUgIFNFTEVDVF9EU0kgIDEKKyNk
ZWZpbmUgIFNFTEVDVF9EUEkgIDAKKyNkZWZpbmUgIFJFR19CQVVEX0RJVl9SQVRJTyAgICAgMAor
CisjZGVmaW5lICBIX0JMQU5LX0wgICAgICAgICAgICAweDNFCisvKiBmb3IgRFNDIG9ubHkgKi8K
KyNkZWZpbmUgIEhfQkxBTktfSCAgICAgICAgICAgIDB4M0YKKy8qIGZvciBEU0Mgb25seTsgbm90
ZTogYml0Wzc6Nl0gYXJlIHJlc2VydmVkICovCisjZGVmaW5lICBNSVBJX1NXQVAgIDB4NEEKKyNk
ZWZpbmUgIE1JUElfU1dBUF9DSDAgICAgNworI2RlZmluZSAgTUlQSV9TV0FQX0NIMSAgICA2Cisj
ZGVmaW5lICBNSVBJX1NXQVBfQ0gyICAgIDUKKyNkZWZpbmUgIE1JUElfU1dBUF9DSDMgICAgNAor
I2RlZmluZSAgTUlQSV9TV0FQX0NMSyAgICAzCisvKiBiaXRbMjowXSBhcmUgcmVzZXJ2ZWQgKi8K
KworLyoqKioqKioqIEVORCBvZiBJMkMgQWRkcmVzcyAweDg0ICoqKioqKioqKi8KKworLyogRFBD
RCByZWdzICovCisjZGVmaW5lIERQQ0RfRFBDRF9SRVYgICAgICAgICAgICAgICAgICAweDAwCisj
ZGVmaW5lIERQQ0RfTUFYX0xJTktfUkFURSAgICAgICAgICAgICAweDAxCisjZGVmaW5lIERQQ0Rf
TUFYX0xBTkVfQ09VTlQgICAgICAgICAgICAweDAyCisKKy8qKioqKioqKiogIEFOWDc2MjUgUmVn
aXN0ZXIgRW5kICAqKioqKioqKioqLworCisvKioqKioqKioqKioqKioqKiogIERpc3BsYXkgKioq
KioqKioqKioqKioqKiovCitlbnVtIGF1ZGlvX2ZzIHsKKwlBVURJT19GU180NDFLICA9IDB4MDAs
CisJQVVESU9fRlNfNDhLICAgPSAweDAyLAorCUFVRElPX0ZTXzMySyAgID0gMHgwMywKKwlBVURJ
T19GU184ODJLICA9IDB4MDgsCisJQVVESU9fRlNfOTZLICAgPSAweDBhLAorCUFVRElPX0ZTXzE3
NjRLID0gMHgwYywKKwlBVURJT19GU18xOTJLICA9IDB4MGUKK307CisKK2VudW0gYXVkaW9fd2Rf
bGVuIHsKKwlBVURJT19XX0xFTl8xNl8yME1BWCA9IDB4MDIsCisJQVVESU9fV19MRU5fMThfMjBN
QVggPSAweDA0LAorCUFVRElPX1dfTEVOXzE3XzIwTUFYID0gMHgwYywKKwlBVURJT19XX0xFTl8x
OV8yME1BWCA9IDB4MDgsCisJQVVESU9fV19MRU5fMjBfMjBNQVggPSAweDBhLAorCUFVRElPX1df
TEVOXzIwXzI0TUFYID0gMHgwMywKKwlBVURJT19XX0xFTl8yMl8yNE1BWCA9IDB4MDUsCisJQVVE
SU9fV19MRU5fMjFfMjRNQVggPSAweDBkLAorCUFVRElPX1dfTEVOXzIzXzI0TUFYID0gMHgwOSwK
KwlBVURJT19XX0xFTl8yNF8yNE1BWCA9IDB4MGIKK307CisKKyNkZWZpbmUgSTJTX0NIXzIJMHgw
MQorI2RlZmluZSBURE1fQ0hfNAkweDAzCisjZGVmaW5lIFRETV9DSF82CTB4MDUKKyNkZWZpbmUg
VERNX0NIXzgJMHgwNworCisjZGVmaW5lIE1BWF9EUENEX0JVRkZFUl9TSVpFCTE2CisKKyNkZWZp
bmUgT05FX0JMT0NLX1NJWkUgICAgICAxMjgKKyNkZWZpbmUgRk9VUl9CTE9DS19TSVpFICAgICAo
MTI4ICogNCkKKworI2RlZmluZSBNQVhfRURJRF9CTE9DSwkzCisjZGVmaW5lIEVESURfVFJZX0NO
VAkzCisjZGVmaW5lIFNVUFBPUlRfUElYRUxfQ0xPQ0sJMzAwMDAwCisKK3N0cnVjdCBzX2VkaWRf
ZGF0YSB7CisJaW50IGVkaWRfYmxvY2tfbnVtOworCXU4IGVkaWRfcmF3X2RhdGFbRk9VUl9CTE9D
S19TSVpFXTsKK307CisKKy8qKioqKioqKioqKioqKioqKiAgRGlzcGxheSBFbmQgKioqKioqKioq
KioqKioqKiovCisKK3N0cnVjdCBhbng3NjI1X2RldmljZV9ub2RlIHsKKwlzdHJ1Y3QgZGV2aWNl
X25vZGUgKm1pcGlfZHNpX2hvc3Rfbm9kZTsKKwlzdHJ1Y3QgZGV2aWNlX25vZGUgKm1pcGlfZHBp
X2hvc3Rfbm9kZTsKKwlzdHJ1Y3QgZGV2aWNlX25vZGUgKmV4dGNvbl9ub2RlOworCXN0cnVjdCBk
ZXZpY2Vfbm9kZSAqcGFuZWxfbm9kZTsKK307CisKK3N0cnVjdCBhbng3NjI1X3BsYXRmb3JtX2Rh
dGEgeworCXN0cnVjdCBncGlvX2Rlc2MgKmdwaW9fcF9vbjsKKwlzdHJ1Y3QgZ3Bpb19kZXNjICpn
cGlvX3Jlc2V0OworCXN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsOworCWludCBpbnRwX2lycTsKKwl1
MzIgbG93X3Bvd2VyX21vZGU7CisJdTMyIGRzaV9zdXBwb3J0ZWQ7CisJdTMyIGludGVybmFsX3Bh
bmVsOworCXUzMiBleHRjb25fc3VwcG9ydGVkOworCXN0cnVjdCBhbng3NjI1X2RldmljZV9ub2Rl
IG5vZGU7Cit9OworCitzdHJ1Y3QgYW54NzYyNV9pMmNfY2xpZW50IHsKKwlzdHJ1Y3QgaTJjX2Ns
aWVudCAqdHhfcDBfY2xpZW50OworCXN0cnVjdCBpMmNfY2xpZW50ICp0eF9wMV9jbGllbnQ7CisJ
c3RydWN0IGkyY19jbGllbnQgKnR4X3AyX2NsaWVudDsKKwlzdHJ1Y3QgaTJjX2NsaWVudCAqcnhf
cDBfY2xpZW50OworCXN0cnVjdCBpMmNfY2xpZW50ICpyeF9wMV9jbGllbnQ7CisJc3RydWN0IGky
Y19jbGllbnQgKnJ4X3AyX2NsaWVudDsKKwlzdHJ1Y3QgaTJjX2NsaWVudCAqdGNwY19jbGllbnQ7
Cit9OworCitzdHJ1Y3QgYW54NzYyNV9kYXRhIHsKKwlzdHJ1Y3QgYW54NzYyNV9wbGF0Zm9ybV9k
YXRhIHBkYXRhOworCWF0b21pY190IHBvd2VyX3N0YXR1czsKKwlhdG9taWNfdCBwYW5lbF9wb3dl
cjsKKwlpbnQgaHBkX3N0YXR1czsKKwlpbnQgaHBkX2hpZ2hfY250OworCXN0cnVjdCBpMmNfY2xp
ZW50ICpjbGllbnQ7CisJc3RydWN0IGFueDc2MjVfaTJjX2NsaWVudCBpMmM7CisJc3RydWN0IGky
Y19jbGllbnQgKmxhc3RfY2xpZW50OworCXN0cnVjdCBzX2VkaWRfZGF0YSBzbGltcG9ydF9lZGlk
X3A7CisJc3RydWN0IHdvcmtfc3RydWN0IHdvcms7CisJc3RydWN0IHdvcmtxdWV1ZV9zdHJ1Y3Qg
KndvcmtxdWV1ZTsKKwkvKiBkcm0gYnJpZGdlIG11dGV4IGxvY2sgKi8KKwlzdHJ1Y3QgbXV0ZXgg
bG9jazsKKwljaGFyIGVkaWRfYmxvY2s7CisJc3RydWN0IGRpc3BsYXlfdGltaW5nIGR0OworCXU4
IGRpc3BsYXlfdGltaW5nX3ZhbGlkOworCXN0cnVjdCBkcm1fYnJpZGdlIGJyaWRnZTsKKwl1OCBi
cmlkZ2VfYXR0YWNoZWQ7CisJc3RydWN0IGRybV9jb25uZWN0b3IgY29ubmVjdG9yOworCXN0cnVj
dCBtaXBpX2RzaV9kZXZpY2UgKmRzaTsKKwlzdHJ1Y3QgZHJtX2RwX2xpbmsgbGluazsKKwlzdHJ1
Y3QgZHJtX2Rpc3BsYXlfbW9kZSB2aWRfaW5mbzsKKwlzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgZXZl
bnRfbmI7CisJc3RydWN0IGV4dGNvbl9kZXYgKmV4dGNvbjsKKwlzdHJ1Y3Qgd29ya19zdHJ1Y3Qg
ZXh0Y29uX3dxOworfTsKKworI2VuZGlmICAvKiBfX0FOWDc2MjVfSF9fICovCi0tIAoyLjcuNAoK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVs
IG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlz
dHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
