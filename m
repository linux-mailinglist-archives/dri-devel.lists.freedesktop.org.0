Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id D73B91C3EC0
	for <lists+dri-devel@lfdr.de>; Mon,  4 May 2020 17:40:57 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 5ED9E89F38;
	Mon,  4 May 2020 15:40:53 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from NAM10-BN7-obe.outbound.protection.outlook.com
 (mail-bn7nam10on2085.outbound.protection.outlook.com [40.107.92.85])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 83DB289F38
 for <dri-devel@lists.freedesktop.org>; Mon,  4 May 2020 15:40:52 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=UWeZtMp3xOF9Ak6zV383QGyjcO3NwuKhfzg9tCmp3JKFsN3cF4zmcEYTtFUAyQFFgoyOAZ8s4/ehtcXgHn3DQzxkiSmu913G89bw/R9wRVZ2k4GgsTEpvVQjGQla55Z0vScWRTSKNINvwWCpwPXTD4wa5TWVNIiP1FdKgnnah1EKZuQvvpZVHuSAZqJhZaFDWw2wpCche/x+/a4aY9KUvD1D34kTH89e9eSMmdWB1XFcji7qoL53OirT3tjdiVga36ZoSvvBU9STAKHi6AwP+PFfwgFgdh0aCvHvhBGeIZZYJtCOJJUDBMJc/jtxnp0AoCyAf0IfO5VLyfcHB1t8Yw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=EeTDzXbPyZL++WoeutcuIFsz5lW+zX3gjhOo0QaJF/U=;
 b=c0IZkT4xTq2JpPj3i5FnIW97Cs2XgLVefabuDoHiLcuBvGZpdg7367xPhEYFxOydy5kDMUn0pH6dfqQ64FFltIOwfP2/oxOqYCcl69vw5Z0tYK6d6rqodGvxZGP7oABSQOYR9gmulBPUlnyasJMdSQR4pHvg4HLJbGOqhiUHL5acKhXxL5q1Fvw2wV+4UJXwke11uwz/MWrbYJq6dIJKktgq+h1PDC0EoMRVrIZcVYu/0Ii+vunL2+Xe18GTayQgiKQBVamElefvTu9Zc1cTEc1vmStMVAF3AgdK+0Jzu6+bwD3UvCtMsVXsN27p5604RJPGDsSY9yWfFjQys2LOlg==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=EeTDzXbPyZL++WoeutcuIFsz5lW+zX3gjhOo0QaJF/U=;
 b=JMDmEZfnCN6j7bk8+9GL00lYcWoOY+Ret+avoqisVrVWyM5zm5QyJHtMelEAwFxATQzw395Uuors+5f3mTQC7NPghqzWT6P6oIMRTWCURiHJhgzhKaL3HX3dqk9XrKPO39Xu4VhamFEXHvP82Rk6Zb55z/Ekjg7JXZlYgz7jdOM=
Authentication-Results: lists.freedesktop.org; dkim=none (message not signed)
 header.d=none; lists.freedesktop.org;
 dmarc=none action=none header.from=amd.com;
Received: from MN2PR12MB3872.namprd12.prod.outlook.com (2603:10b6:208:168::17)
 by MN2PR12MB4502.namprd12.prod.outlook.com (2603:10b6:208:263::20)
 with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2958.21; Mon, 4 May
 2020 15:40:49 +0000
Received: from MN2PR12MB3872.namprd12.prod.outlook.com
 ([fe80::c578:193b:bda9:ac5c]) by MN2PR12MB3872.namprd12.prod.outlook.com
 ([fe80::c578:193b:bda9:ac5c%7]) with mapi id 15.20.2958.030; Mon, 4 May 2020
 15:40:49 +0000
From: Nirmoy Das <nirmoy.das@amd.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v4 1/1] drm/mm: optimize rb_hole_addr rbtree search
Date: Mon,  4 May 2020 17:40:35 +0200
Message-Id: <20200504154035.17795-1-nirmoy.das@amd.com>
X-Mailer: git-send-email 2.26.1
X-ClientProxiedBy: BN6PR13CA0021.namprd13.prod.outlook.com
 (2603:10b6:404:10a::31) To MN2PR12MB3872.namprd12.prod.outlook.com
 (2603:10b6:208:168::17)
MIME-Version: 1.0
X-MS-Exchange-MessageSentRepresentingType: 1
Received: from brihaspati.amd.com (2003:c5:8f23:4600:361c:5d25:fe6c:c56f) by
 BN6PR13CA0021.namprd13.prod.outlook.com (2603:10b6:404:10a::31) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2979.16 via Frontend
 Transport; Mon, 4 May 2020 15:40:48 +0000
X-Mailer: git-send-email 2.26.1
X-Originating-IP: [2003:c5:8f23:4600:361c:5d25:fe6c:c56f]
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-HT: Tenant
X-MS-Office365-Filtering-Correlation-Id: cdd4ea83-6301-400e-a759-08d7f041850a
X-MS-TrafficTypeDiagnostic: MN2PR12MB4502:|MN2PR12MB4502:
X-MS-Exchange-Transport-Forked: True
X-Microsoft-Antispam-PRVS: <MN2PR12MB4502BC0BD465FC754B1BA7CC8BA60@MN2PR12MB4502.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:8273;
X-Forefront-PRVS: 03932714EB
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: sSHKdGcGGrR6SepY7lKTL9+SWX1ULURJfK3dbuyd9wdkTOhCcpMrFkdW20bvEytbOttzOQ18S5zktKxCLMwxaSq+ZQavYiY0kXTx1yRaep3gxRVyK4mSbz3c8Huv+IjQbk7p4kfsdYCgFulG0u9Ze6ozeJp0Jf40ezKCcZp1Z+ESA6Kx0S0OVeTk35x5R1c2RsHmbH3GPUmZeQ4cEpRwLTonrD393MQrqYpW9TyLNu79s9f3RwEAzNz3HMkKtXwOM3n2kFpBYej32nH+Xp2cTlwwX1i3ah2alsxZAoj3IM3lM7mTj5S3ytA03E4jswI0Lm+KmokUd+f/871xukFeu2SxM2LywsuIAAXXMXvl+HTwqrJWmFc+0Ri9CNmWcCY6sAXeFa49s8nJjtkU3vlqsTzv5KXvIBks2LMCa30R9ZZ04zTEU7jSyd9eVCV5FZir
X-Forefront-Antispam-Report: CIP:255.255.255.255; CTRY:; LANG:en; SCL:1; SRV:;
 IPV:NLI; SFV:NSPM; H:MN2PR12MB3872.namprd12.prod.outlook.com; PTR:; CAT:NONE;
 SFTY:;
 SFS:(4636009)(366004)(136003)(39860400002)(346002)(376002)(396003)(4326008)(478600001)(54906003)(44832011)(66476007)(1076003)(6916009)(66946007)(86362001)(5660300002)(66556008)(66574012)(2616005)(186003)(6666004)(6486002)(36756003)(2906002)(16526019)(7696005)(52116002)(8676002)(316002)(8936002);
 DIR:OUT; SFP:1101; 
X-MS-Exchange-AntiSpam-MessageData: 3x+JlkPkIy0zICMFL5bOC+WVs5HEw/fjUczEFyZYYxcAQ4DCl0Su7sWZwzUKLo69jh3LGwcyhay48VRDAa0Cf7PTgCr5Q7vPCp/zmYe/Yk2cAfqN+bR8MkBqAaRrPA0Oh9TVzLtzUbo60o1wOPIR+YhX1liSJfzIBVMMHzvgSRdkLsMLpI0mMnN9ojNnQjRswyUXWKwI8SL4L6jfldBUJio2cSYfrV1cIaU4AjflYiAAWGC28eiNICtwloixbIcXc/Ylgn0KMvN9OPPpmlT/o2WqJ6K2iEGpSrNTV4BUxCR2aDNsjwGaC+910Z9e/TFDuHbrVpj/6waVAhll7MC7HV5vTX99ViEcwlNBr3989NrpSL7uNm75LGcSfe/TO+EceHnlWcvcsFiZMEuVBdBcbx8uYXwSX95B4UfZn0FUDZqC/c3lzn7G2KO/1JUr4wLqXkpnzaasKpVUttaW9D5hrY395q6SOsva+H4EFg0xr6c8vO28AVVSt4XTHpVP/n6Q1e8Xy5atnoerqsk2LcGV782DDBmzakH81u5HXJP0vXuMfaR9GS8fJyTNt58cxok3AAE3XtWLls7BfC6isS7WCew9W5/XJcS8JHSB4pqDxS3IctnNRzG1VyWUJI9ExprAt96mwhdA5mWdmJnoQf/mc7HHHwJaDSQNX6cjbYZBOmyVEvzSBO57ZNW7zu1QhOoa9jal8wYg079gKeHtvMgZ4jPwqLxGSYlKqPyWeodk4A9p+nHxq3Z8GLjl/3O+kvd48Sc7K8eRDMFGjHauBBcXyCvte11eb7thdVaVoS0uJSWOfqpikl8aHq2aW5Erc9bIL7Fsi9qYR/6EaA8xLxixSpBXykJp1wQTRi4Rn7A8ovY=
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: cdd4ea83-6301-400e-a759-08d7f041850a
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 04 May 2020 15:40:49.5340 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: DsYkNeoqBoC4lQKf31DWHxCzrHUSSeVhVXgw881VmOkdzlT3skA9MUYnTYMJsGMztBp+kyFHdGDq8DbD6GYn8Q==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: MN2PR12MB4502
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: kbuild test robot <lkp@intel.com>, nirmoy.aiemd@gmail.com,
 Nirmoy Das <nirmoy.das@amd.com>, christian.koenig@amd.com,
 chris@chris-wilson.co.uk
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VXNlcnNwYWNlIGNhbiBzZXZlcmVseSBmcmFnbWVudCByYl9ob2xlX2FkZHIgcmJ0cmVlIGJ5IG1h
bmlwdWxhdGluZwphbGlnbm1lbnQgd2hpbGUgYWxsb2NhdGluZyBidWZmZXJzLiBGcmFnbWVudGVk
IHJiX2hvbGVfYWRkciByYnRyZWUKd291bGQgcmVzdWx0IGluIGxhcmdlIGRlbGF5cyB3aGlsZSBh
bGxvY2F0aW5nIGJ1ZmZlciBvYmplY3QgZm9yIGEKdXNlcnNwYWNlIGFwcGxpY2F0aW9uLiBJdCB0
YWtlcyBsb25nIHRpbWUgdG8gZmluZCBzdWl0YWJsZSBob2xlCmJlY2F1c2UgaWYgd2UgZmFpbCB0
byBmaW5kIGEgc3VpdGFibGUgaG9sZSBpbiB0aGUgZmlyc3QgYXR0ZW1wdAp0aGVuIHdlIGxvb2sg
Zm9yIG5laWdoYm91cmluZyBub2RlcyB1c2luZyByYl9wcmV2KCkvcmJfbmV4dCgpLgpUcmF2ZXJz
aW5nIHJidHJlZSB1c2luZyByYl9wcmV2KCkvcmJfbmV4dCgpIGNhbiB0YWtlIHJlYWxseSBsb25n
CnRpbWUgaWYgdGhlIHRyZWUgaXMgZnJhZ21lbnRlZC4KClRoaXMgcGF0Y2ggaW1wcm92ZXMgc2Vh
cmNoZXMgaW4gZnJhZ21lbnRlZCByYl9ob2xlX2FkZHIgcmJ0cmVlIGJ5Cm1vZGlmeWluZyBpdCB0
byBhbiBhdWdtZW50ZWQgcmJ0cmVlIHdoaWNoIHdpbGwgc3RvcmUgYW4gZXh0cmEgZmllbGQKaW4g
ZHJtX21tX25vZGUsIHN1YnRyZWVfbWF4X2hvbGUuIEVhY2ggZHJtX21tX25vZGUgbm93IHN0b3Jl
cyBtYXhpbXVtCmhvbGUgc2l6ZSBmb3IgaXRzIHN1YnRyZWUgaW4gZHJtX21tX25vZGUtPnN1YnRy
ZWVfbWF4X2hvbGUuIFVzaW5nCmRybV9tbV9ub2RlLT5zdWJ0cmVlX21heF9ob2xlLCBpdCBpcyBw
b3NzaWJsZSB0byBlbGltaW5hdGUgYSBjb21wbGV0ZQpzdWJ0cmVlIGlmIHRoYXQgc3VidHJlZSBp
cyB1bmFibGUgdG8gc2VydmUgYSByZXF1ZXN0IGhlbmNlIHJlZHVjaW5nCm51bWJlciBvZiByYl9w
cmV2KCkvcmJfbmV4dCgpIHVzZWQuCgpXaXRoIHRoaXMgcGF0Y2ggYXBwbGllZCwgMSBtaWxsaW9u
IGJvIGFsbG9jcyBvbiBhbWRncHUgdG9vayB+OCBzZWMsCmNvbXBhcmVkIHRvIDUwayBibyBhbGxv
Y3Mgd2hpY2ggdG9vayAyOCBzZWMgd2l0aG91dCBpdC4KCnBhcnRpYWwgdGVzdCBjb2RlOgppbnQg
dGVzdF9mcmFnbWVudGF0aW9uKHZvaWQpCnsKCglpbnQgaSA9IDA7CiAgICAgICAgdWludDMyX3Qg
IG1pbm9yX3ZlcnNpb247CiAgICAgICAgdWludDMyX3QgIG1ham9yX3ZlcnNpb247CgogICAgICAg
IHN0cnVjdCBhbWRncHVfYm9fYWxsb2NfcmVxdWVzdCByZXF1ZXN0ID0ge307CiAgICAgICAgYW1k
Z3B1X2JvX2hhbmRsZSB2cmFtX2hhbmRsZVtNQVhfQUxMT0NdID0ge307CiAgICAgICAgYW1kZ3B1
X2RldmljZV9oYW5kbGUgZGV2aWNlX2hhbmRsZTsKCiAgICAgICAgcmVxdWVzdC5hbGxvY19zaXpl
ID0gNDA5NjsKICAgICAgICByZXF1ZXN0LnBoeXNfYWxpZ25tZW50ID0gODE5MjsKICAgICAgICBy
ZXF1ZXN0LnByZWZlcnJlZF9oZWFwID0gQU1ER1BVX0dFTV9ET01BSU5fVlJBTTsKCiAgICAgICAg
aW50IGZkID0gb3BlbigiL2Rldi9kcmkvY2FyZDAiLCBPX1JEV1IgfCBPX0NMT0VYRUMpOwogICAg
ICAgIGFtZGdwdV9kZXZpY2VfaW5pdGlhbGl6ZShmZCwgJm1ham9yX3ZlcnNpb24sICAmbWlub3Jf
dmVyc2lvbiwKCQkJCSAmZGV2aWNlX2hhbmRsZSk7CgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBN
QVhfQUxMT0M7IGkrKykgewogICAgICAgICAgICAgICAgYW1kZ3B1X2JvX2FsbG9jKGRldmljZV9o
YW5kbGUsICZyZXF1ZXN0LCAmdnJhbV9oYW5kbGVbaV0pOwogICAgICAgIH0KCiAgICAgICAgZm9y
IChpID0gMDsgaSA8IE1BWF9BTExPQzsgaSsrKQogICAgICAgICAgICAgICAgYW1kZ3B1X2JvX2Zy
ZWUodnJhbV9oYW5kbGVbaV0pOwoKICAgICAgICByZXR1cm4gMDsKfQoKdjI6ClVzZSBSQl9ERUNM
QVJFX0NBTExCQUNLU19NQVggdG8gbWFpbnRhaW4gc3VidHJlZV9tYXhfaG9sZQp2MzoKaW5zZXJ0
X2hvbGVfYWRkcigpIHNob3VsZCBiZSBzdGF0aWMgYSBmdW5jdGlvbgpmaXggcmV0dXJuIHZhbHVl
IG9mIG5leHRfaG9sZV9oaWdoX2FkZHIoKS9uZXh0X2hvbGVfbG93X2FkZHIoKQpSZXBvcnRlZC1i
eToga2J1aWxkIHRlc3Qgcm9ib3QgPGxrcEBpbnRlbC5jb20+CnY0OgpGaXggY29tbWl0IG1lc3Nh
Z2UuCgpTaWduZWQtb2ZmLWJ5OiBOaXJtb3kgRGFzIDxuaXJtb3kuZGFzQGFtZC5jb20+ClJldmll
d2VkLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KQWNrZWQtYnk6
IENocmlzdGlhbiBLw7ZuaWcgPGNocmlzdGlhbi5rb2VuaWdAYW1kLmNvbT4KLS0tCiBkcml2ZXJz
L2dwdS9kcm0vZHJtX21tLmMgfCAxMzMgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
LS0tLS0tCiBpbmNsdWRlL2RybS9kcm1fbW0uaCAgICAgfCAgIDEgKwogMiBmaWxlcyBjaGFuZ2Vk
LCAxMTUgaW5zZXJ0aW9ucygrKSwgMTkgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2RybV9tbS5jIGIvZHJpdmVycy9ncHUvZHJtL2RybV9tbS5jCmluZGV4IDg5ODFh
YmU4YjdjOS4uZjRjYTFmZjgwYWY5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vZHJtX21t
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2RybV9tbS5jCkBAIC0yMTIsMjAgKzIxMiw2IEBAIHN0
YXRpYyB2b2lkIGRybV9tbV9pbnRlcnZhbF90cmVlX2FkZF9ub2RlKHN0cnVjdCBkcm1fbW1fbm9k
ZSAqaG9sZV9ub2RlLAogCQkJCSAgICZkcm1fbW1faW50ZXJ2YWxfdHJlZV9hdWdtZW50KTsKIH0K
IAotI2RlZmluZSBSQl9JTlNFUlQocm9vdCwgbWVtYmVyLCBleHByKSBkbyB7IFwKLQlzdHJ1Y3Qg
cmJfbm9kZSAqKmxpbmsgPSAmcm9vdC5yYl9ub2RlLCAqcmIgPSBOVUxMOyBcCi0JdTY0IHggPSBl
eHByKG5vZGUpOyBcCi0Jd2hpbGUgKCpsaW5rKSB7IFwKLQkJcmIgPSAqbGluazsgXAotCQlpZiAo
eCA8IGV4cHIocmJfZW50cnkocmIsIHN0cnVjdCBkcm1fbW1fbm9kZSwgbWVtYmVyKSkpIFwKLQkJ
CWxpbmsgPSAmcmItPnJiX2xlZnQ7IFwKLQkJZWxzZSBcCi0JCQlsaW5rID0gJnJiLT5yYl9yaWdo
dDsgXAotCX0gXAotCXJiX2xpbmtfbm9kZSgmbm9kZS0+bWVtYmVyLCByYiwgbGluayk7IFwKLQly
Yl9pbnNlcnRfY29sb3IoJm5vZGUtPm1lbWJlciwgJnJvb3QpOyBcCi19IHdoaWxlICgwKQotCiAj
ZGVmaW5lIEhPTEVfU0laRShOT0RFKSAoKE5PREUpLT5ob2xlX3NpemUpCiAjZGVmaW5lIEhPTEVf
QUREUihOT0RFKSAoX19kcm1fbW1faG9sZV9ub2RlX3N0YXJ0KE5PREUpKQogCkBAIC0yNTUsMTYg
KzI0MSw0MiBAQCBzdGF0aWMgdm9pZCBpbnNlcnRfaG9sZV9zaXplKHN0cnVjdCByYl9yb290X2Nh
Y2hlZCAqcm9vdCwKIAlyYl9pbnNlcnRfY29sb3JfY2FjaGVkKCZub2RlLT5yYl9ob2xlX3NpemUs
IHJvb3QsIGZpcnN0KTsKIH0KIAorUkJfREVDTEFSRV9DQUxMQkFDS1NfTUFYKHN0YXRpYywgYXVn
bWVudF9jYWxsYmFja3MsCisJCQkgc3RydWN0IGRybV9tbV9ub2RlLCByYl9ob2xlX2FkZHIsCisJ
CQkgdTY0LCBzdWJ0cmVlX21heF9ob2xlLCBIT0xFX1NJWkUpCisKK3N0YXRpYyB2b2lkIGluc2Vy
dF9ob2xlX2FkZHIoc3RydWN0IHJiX3Jvb3QgKnJvb3QsIHN0cnVjdCBkcm1fbW1fbm9kZSAqbm9k
ZSkKK3sKKwlzdHJ1Y3QgcmJfbm9kZSAqKmxpbmsgPSAmcm9vdC0+cmJfbm9kZSwgKnJiX3BhcmVu
dCA9IE5VTEw7CisJdTY0IHN0YXJ0ID0gSE9MRV9BRERSKG5vZGUpLCBzdWJ0cmVlX21heF9ob2xl
ID0gbm9kZS0+c3VidHJlZV9tYXhfaG9sZTsKKwlzdHJ1Y3QgZHJtX21tX25vZGUgKnBhcmVudDsK
KworCXdoaWxlICgqbGluaykgeworCQlyYl9wYXJlbnQgPSAqbGluazsKKwkJcGFyZW50ID0gcmJf
ZW50cnkocmJfcGFyZW50LCBzdHJ1Y3QgZHJtX21tX25vZGUsIHJiX2hvbGVfYWRkcik7CisJCWlm
IChwYXJlbnQtPnN1YnRyZWVfbWF4X2hvbGUgPCBzdWJ0cmVlX21heF9ob2xlKQorCQkJcGFyZW50
LT5zdWJ0cmVlX21heF9ob2xlID0gc3VidHJlZV9tYXhfaG9sZTsKKwkJaWYgKHN0YXJ0IDwgSE9M
RV9BRERSKHBhcmVudCkpCisJCQlsaW5rID0gJnBhcmVudC0+cmJfaG9sZV9hZGRyLnJiX2xlZnQ7
CisJCWVsc2UKKwkJCWxpbmsgPSAmcGFyZW50LT5yYl9ob2xlX2FkZHIucmJfcmlnaHQ7CisJfQor
CisJcmJfbGlua19ub2RlKCZub2RlLT5yYl9ob2xlX2FkZHIsIHJiX3BhcmVudCwgbGluayk7CisJ
cmJfaW5zZXJ0X2F1Z21lbnRlZCgmbm9kZS0+cmJfaG9sZV9hZGRyLCByb290LCAmYXVnbWVudF9j
YWxsYmFja3MpOworfQorCiBzdGF0aWMgdm9pZCBhZGRfaG9sZShzdHJ1Y3QgZHJtX21tX25vZGUg
Km5vZGUpCiB7CiAJc3RydWN0IGRybV9tbSAqbW0gPSBub2RlLT5tbTsKIAogCW5vZGUtPmhvbGVf
c2l6ZSA9CiAJCV9fZHJtX21tX2hvbGVfbm9kZV9lbmQobm9kZSkgLSBfX2RybV9tbV9ob2xlX25v
ZGVfc3RhcnQobm9kZSk7CisJbm9kZS0+c3VidHJlZV9tYXhfaG9sZSA9IG5vZGUtPmhvbGVfc2l6
ZTsKIAlEUk1fTU1fQlVHX09OKCFkcm1fbW1faG9sZV9mb2xsb3dzKG5vZGUpKTsKIAogCWluc2Vy
dF9ob2xlX3NpemUoJm1tLT5ob2xlc19zaXplLCBub2RlKTsKLQlSQl9JTlNFUlQobW0tPmhvbGVz
X2FkZHIsIHJiX2hvbGVfYWRkciwgSE9MRV9BRERSKTsKKwlpbnNlcnRfaG9sZV9hZGRyKCZtbS0+
aG9sZXNfYWRkciwgbm9kZSk7CiAKIAlsaXN0X2FkZCgmbm9kZS0+aG9sZV9zdGFjaywgJm1tLT5o
b2xlX3N0YWNrKTsKIH0KQEAgLTI3NSw4ICsyODcsMTAgQEAgc3RhdGljIHZvaWQgcm1faG9sZShz
dHJ1Y3QgZHJtX21tX25vZGUgKm5vZGUpCiAKIAlsaXN0X2RlbCgmbm9kZS0+aG9sZV9zdGFjayk7
CiAJcmJfZXJhc2VfY2FjaGVkKCZub2RlLT5yYl9ob2xlX3NpemUsICZub2RlLT5tbS0+aG9sZXNf
c2l6ZSk7Ci0JcmJfZXJhc2UoJm5vZGUtPnJiX2hvbGVfYWRkciwgJm5vZGUtPm1tLT5ob2xlc19h
ZGRyKTsKKwlyYl9lcmFzZV9hdWdtZW50ZWQoJm5vZGUtPnJiX2hvbGVfYWRkciwgJm5vZGUtPm1t
LT5ob2xlc19hZGRyLAorCQkJICAgJmF1Z21lbnRfY2FsbGJhY2tzKTsKIAlub2RlLT5ob2xlX3Np
emUgPSAwOworCW5vZGUtPnN1YnRyZWVfbWF4X2hvbGUgPSAwOwogCiAJRFJNX01NX0JVR19PTihk
cm1fbW1faG9sZV9mb2xsb3dzKG5vZGUpKTsKIH0KQEAgLTM2MSw5ICszNzUsOTAgQEAgZmlyc3Rf
aG9sZShzdHJ1Y3QgZHJtX21tICptbSwKIAl9CiB9CiAKKy8qKgorICogbmV4dF9ob2xlX2hpZ2hf
YWRkciAtIHJldHVybnMgbmV4dCBob2xlIGZvciBhIERSTV9NTV9JTlNFUlRfSElHSCBtb2RlIHJl
cXVlc3QKKyAqIEBlbnRyeTogcHJldmlvdXNseSBzZWxlY3RlZCBkcm1fbW1fbm9kZQorICogQHNp
emU6IHNpemUgb2YgdGhlIGEgaG9sZSBuZWVkZWQgZm9yIHRoZSByZXF1ZXN0CisgKgorICogVGhp
cyBmdW5jdGlvbiB3aWxsIHZlcmlmeSB3aGV0aGVyIGxlZnQgc3VidHJlZSBvZiBAZW50cnkgaGFz
IGhvbGUgYmlnIGVub3VnaAorICogdG8gZml0IHRoZSByZXF1dGVzdGVkIHNpemUuIElmIHNvLCBp
dCB3aWxsIHJldHVybiBwcmV2aW91cyBub2RlIG9mIEBlbnRyeSBvcgorICogZWxzZSBpdCB3aWxs
IHJldHVybiBwYXJlbnQgbm9kZSBvZiBAZW50cnkKKyAqCisgKiBJdCB3aWxsIGFsc28gc2tpcCB0
aGUgY29tcGxldGUgbGVmdCBzdWJ0cmVlIGlmIHN1YnRyZWVfbWF4X2hvbGUgb2YgdGhhdAorICog
c3VidHJlZSBpcyBzYW1lIGFzIHRoZSBzdWJ0cmVlX21heF9ob2xlIG9mIHRoZSBAZW50cnkuCisg
KgorICogUmV0dXJuczoKKyAqIHByZXZpb3VzIG5vZGUgb2YgQGVudHJ5IGlmIGxlZnQgc3VidHJl
ZSBvZiBAZW50cnkgY2FuIHNlcnZlIHRoZSByZXF1ZXN0IG9yCisgKiBlbHNlIHJldHVybiBwYXJl
bnQgb2YgQGVudHJ5CisgKi8KK3N0YXRpYyBzdHJ1Y3QgZHJtX21tX25vZGUgKgorbmV4dF9ob2xl
X2hpZ2hfYWRkcihzdHJ1Y3QgZHJtX21tX25vZGUgKmVudHJ5LCB1NjQgc2l6ZSkKK3sKKwlzdHJ1
Y3QgcmJfbm9kZSAqcmJfbm9kZSwgKmxlZnRfcmJfbm9kZSwgKnBhcmVudF9yYl9ub2RlOworCXN0
cnVjdCBkcm1fbW1fbm9kZSAqbGVmdF9ub2RlOworCisJaWYgKCFlbnRyeSkKKwkJcmV0dXJuIE5V
TEw7CisKKwlyYl9ub2RlID0gJmVudHJ5LT5yYl9ob2xlX2FkZHI7CisJaWYgKHJiX25vZGUtPnJi
X2xlZnQpIHsKKwkJbGVmdF9yYl9ub2RlID0gcmJfbm9kZS0+cmJfbGVmdDsKKwkJcGFyZW50X3Ji
X25vZGUgPSByYl9wYXJlbnQocmJfbm9kZSk7CisJCWxlZnRfbm9kZSA9IHJiX2VudHJ5KGxlZnRf
cmJfbm9kZSwKKwkJCQkgICAgIHN0cnVjdCBkcm1fbW1fbm9kZSwgcmJfaG9sZV9hZGRyKTsKKwkJ
aWYgKChsZWZ0X25vZGUtPnN1YnRyZWVfbWF4X2hvbGUgPCBzaXplIHx8CisJCSAgICAgZW50cnkt
PnNpemUgPT0gZW50cnktPnN1YnRyZWVfbWF4X2hvbGUpICYmCisJCSAgICBwYXJlbnRfcmJfbm9k
ZSAmJiBwYXJlbnRfcmJfbm9kZS0+cmJfbGVmdCAhPSByYl9ub2RlKQorCQkJcmV0dXJuIHJiX2hv
bGVfYWRkcl90b19ub2RlKHBhcmVudF9yYl9ub2RlKTsKKwl9CisKKwlyZXR1cm4gcmJfaG9sZV9h
ZGRyX3RvX25vZGUocmJfcHJldihyYl9ub2RlKSk7Cit9CisKKy8qKgorICogbmV4dF9ob2xlX2xv
d19hZGRyIC0gcmV0dXJucyBuZXh0IGhvbGUgZm9yIGEgRFJNX01NX0lOU0VSVF9MT1cgbW9kZSBy
ZXF1ZXN0CisgKiBAZW50cnk6IHByZXZpb3VzbHkgc2VsZWN0ZWQgZHJtX21tX25vZGUKKyAqIEBz
aXplOiBzaXplIG9mIHRoZSBhIGhvbGUgbmVlZGVkIGZvciB0aGUgcmVxdWVzdAorICoKKyAqIFRo
aXMgZnVuY3Rpb24gd2lsbCB2ZXJpZnkgd2hldGhlciByaWdodCBzdWJ0cmVlIG9mIEBlbnRyeSBo
YXMgaG9sZSBiaWcgZW5vdWdoCisgKiB0byBmaXQgdGhlIHJlcXV0ZXN0ZWQgc2l6ZS4gSWYgc28s
IGl0IHdpbGwgcmV0dXJuIG5leHQgbm9kZSBvZiBAZW50cnkgb3IKKyAqIGVsc2UgaXQgd2lsbCBy
ZXR1cm4gcGFyZW50IG5vZGUgb2YgQGVudHJ5CisgKgorICogSXQgd2lsbCBhbHNvIHNraXAgdGhl
IGNvbXBsZXRlIHJpZ2h0IHN1YnRyZWUgaWYgc3VidHJlZV9tYXhfaG9sZSBvZiB0aGF0CisgKiBz
dWJ0cmVlIGlzIHNhbWUgYXMgdGhlIHN1YnRyZWVfbWF4X2hvbGUgb2YgdGhlIEBlbnRyeS4KKyAq
CisgKiBSZXR1cm5zOgorICogbmV4dCBub2RlIG9mIEBlbnRyeSBpZiByaWdodCBzdWJ0cmVlIG9m
IEBlbnRyeSBjYW4gc2VydmUgdGhlIHJlcXVlc3Qgb3IKKyAqIGVsc2UgcmV0dXJuIHBhcmVudCBv
ZiBAZW50cnkKKyAqLworc3RhdGljIHN0cnVjdCBkcm1fbW1fbm9kZSAqCituZXh0X2hvbGVfbG93
X2FkZHIoc3RydWN0IGRybV9tbV9ub2RlICplbnRyeSwgdTY0IHNpemUpCit7CisJc3RydWN0IHJi
X25vZGUgKnJiX25vZGUsICpyaWdodF9yYl9ub2RlLCAqcGFyZW50X3JiX25vZGU7CisJc3RydWN0
IGRybV9tbV9ub2RlICpyaWdodF9ub2RlOworCisJaWYgKCFlbnRyeSkKKwkJcmV0dXJuIE5VTEw7
CisKKwlyYl9ub2RlID0gJmVudHJ5LT5yYl9ob2xlX2FkZHI7CisJaWYgKHJiX25vZGUtPnJiX3Jp
Z2h0KSB7CisJCXJpZ2h0X3JiX25vZGUgPSByYl9ub2RlLT5yYl9yaWdodDsKKwkJcGFyZW50X3Ji
X25vZGUgPSByYl9wYXJlbnQocmJfbm9kZSk7CisJCXJpZ2h0X25vZGUgPSByYl9lbnRyeShyaWdo
dF9yYl9ub2RlLAorCQkJCSAgICAgIHN0cnVjdCBkcm1fbW1fbm9kZSwgcmJfaG9sZV9hZGRyKTsK
KwkJaWYgKChyaWdodF9ub2RlLT5zdWJ0cmVlX21heF9ob2xlIDwgc2l6ZSB8fAorCQkgICAgIGVu
dHJ5LT5zaXplID09IGVudHJ5LT5zdWJ0cmVlX21heF9ob2xlKSAmJgorCQkgICAgcGFyZW50X3Ji
X25vZGUgJiYgcGFyZW50X3JiX25vZGUtPnJiX3JpZ2h0ICE9IHJiX25vZGUpCisJCQlyZXR1cm4g
cmJfaG9sZV9hZGRyX3RvX25vZGUocGFyZW50X3JiX25vZGUpOworCX0KKworCXJldHVybiByYl9o
b2xlX2FkZHJfdG9fbm9kZShyYl9uZXh0KHJiX25vZGUpKTsKK30KKwogc3RhdGljIHN0cnVjdCBk
cm1fbW1fbm9kZSAqCiBuZXh0X2hvbGUoc3RydWN0IGRybV9tbSAqbW0sCiAJICBzdHJ1Y3QgZHJt
X21tX25vZGUgKm5vZGUsCisJICB1NjQgc2l6ZSwKIAkgIGVudW0gZHJtX21tX2luc2VydF9tb2Rl
IG1vZGUpCiB7CiAJc3dpdGNoIChtb2RlKSB7CkBAIC0zNzIsMTAgKzQ2NywxMCBAQCBuZXh0X2hv
bGUoc3RydWN0IGRybV9tbSAqbW0sCiAJCXJldHVybiByYl9ob2xlX3NpemVfdG9fbm9kZShyYl9w
cmV2KCZub2RlLT5yYl9ob2xlX3NpemUpKTsKIAogCWNhc2UgRFJNX01NX0lOU0VSVF9MT1c6Ci0J
CXJldHVybiByYl9ob2xlX2FkZHJfdG9fbm9kZShyYl9uZXh0KCZub2RlLT5yYl9ob2xlX2FkZHIp
KTsKKwkJcmV0dXJuIG5leHRfaG9sZV9sb3dfYWRkcihub2RlLCBzaXplKTsKIAogCWNhc2UgRFJN
X01NX0lOU0VSVF9ISUdIOgotCQlyZXR1cm4gcmJfaG9sZV9hZGRyX3RvX25vZGUocmJfcHJldigm
bm9kZS0+cmJfaG9sZV9hZGRyKSk7CisJCXJldHVybiBuZXh0X2hvbGVfaGlnaF9hZGRyKG5vZGUs
IHNpemUpOwogCiAJY2FzZSBEUk1fTU1fSU5TRVJUX0VWSUNUOgogCQlub2RlID0gbGlzdF9uZXh0
X2VudHJ5KG5vZGUsIGhvbGVfc3RhY2spOwpAQCAtNDg5LDcgKzU4NCw3IEBAIGludCBkcm1fbW1f
aW5zZXJ0X25vZGVfaW5fcmFuZ2Uoc3RydWN0IGRybV9tbSAqIGNvbnN0IG1tLAogCXJlbWFpbmRl
cl9tYXNrID0gaXNfcG93ZXJfb2ZfMihhbGlnbm1lbnQpID8gYWxpZ25tZW50IC0gMSA6IDA7CiAJ
Zm9yIChob2xlID0gZmlyc3RfaG9sZShtbSwgcmFuZ2Vfc3RhcnQsIHJhbmdlX2VuZCwgc2l6ZSwg
bW9kZSk7CiAJICAgICBob2xlOwotCSAgICAgaG9sZSA9IG9uY2UgPyBOVUxMIDogbmV4dF9ob2xl
KG1tLCBob2xlLCBtb2RlKSkgeworCSAgICAgaG9sZSA9IG9uY2UgPyBOVUxMIDogbmV4dF9ob2xl
KG1tLCBob2xlLCBzaXplLCBtb2RlKSkgewogCQl1NjQgaG9sZV9zdGFydCA9IF9fZHJtX21tX2hv
bGVfbm9kZV9zdGFydChob2xlKTsKIAkJdTY0IGhvbGVfZW5kID0gaG9sZV9zdGFydCArIGhvbGUt
PmhvbGVfc2l6ZTsKIAkJdTY0IGFkal9zdGFydCwgYWRqX2VuZDsKZGlmZiAtLWdpdCBhL2luY2x1
ZGUvZHJtL2RybV9tbS5oIGIvaW5jbHVkZS9kcm0vZHJtX21tLmgKaW5kZXggZWU4YjBlODBjYTkw
Li5hMDFiYzZmYWM4M2MgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvZHJtL2RybV9tbS5oCisrKyBiL2lu
Y2x1ZGUvZHJtL2RybV9tbS5oCkBAIC0xNjgsNiArMTY4LDcgQEAgc3RydWN0IGRybV9tbV9ub2Rl
IHsKIAlzdHJ1Y3QgcmJfbm9kZSByYl9ob2xlX2FkZHI7CiAJdTY0IF9fc3VidHJlZV9sYXN0Owog
CXU2NCBob2xlX3NpemU7CisJdTY0IHN1YnRyZWVfbWF4X2hvbGU7CiAJdW5zaWduZWQgbG9uZyBm
bGFnczsKICNkZWZpbmUgRFJNX01NX05PREVfQUxMT0NBVEVEX0JJVAkwCiAjZGVmaW5lIERSTV9N
TV9OT0RFX1NDQU5ORURfQklUCQkxCi0tIAoyLjI2LjEKCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVs
QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWls
bWFuL2xpc3RpbmZvL2RyaS1kZXZlbAo=
