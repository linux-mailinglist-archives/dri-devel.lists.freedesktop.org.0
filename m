Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 9087419DFA9
	for <lists+dri-devel@lfdr.de>; Fri,  3 Apr 2020 22:41:09 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0CD2C6EC99;
	Fri,  3 Apr 2020 20:41:07 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mga14.intel.com (mga14.intel.com [192.55.52.115])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4033D6EC99;
 Fri,  3 Apr 2020 20:41:05 +0000 (UTC)
IronPort-SDR: sQZ/L6LR3QGdqTBGQWWx2UJ010f3IgySjWxnTGAXlv++OztW2R8IOUS86asKsLkj0fdyPVnWmZ
 4X/m25i5FWFA==
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga002.fm.intel.com ([10.253.24.26])
 by fmsmga103.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 03 Apr 2020 13:41:04 -0700
IronPort-SDR: f42WzfM5qyQ9FK+DwlcpUMkhs8cTiRC3fNoEffNYgd+Gg1sBYuBVZZHryzfHd98a0g6jlt6Ft6
 0vw/Wkwb925w==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.72,341,1580803200"; d="scan'208";a="285237730"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.174])
 by fmsmga002.fm.intel.com with SMTP; 03 Apr 2020 13:41:02 -0700
Received: by stinkbox (sSMTP sendmail emulation);
 Fri, 03 Apr 2020 23:41:01 +0300
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v2 13/17] drm/i915: Stop using mode->private_flags
Date: Fri,  3 Apr 2020 23:40:04 +0300
Message-Id: <20200403204008.14864-14-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.24.1
In-Reply-To: <20200403204008.14864-1-ville.syrjala@linux.intel.com>
References: <20200403204008.14864-1-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Daniel Vetter <daniel.vetter@ffwll.ch>, intel-gfx@lists.freedesktop.org,
 Sam Ravnborg <sam@ravnborg.org>, Emil Velikov <emil.l.velikov@gmail.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KClJl
cGxhY2UgdGhlIHVzZSBvZiBtb2RlLT5wcml2YXRlX2ZsYWdzIHdpdGggYSB0cnVseSBwcml2YXRl
IGJpdG1ha3MKaW4gb3VyIG93biBjcnRjIHN0YXRlLiBXZSBhbHNvIG5lZWQgYSBjb3B5IGluIHRo
ZSBjcnRjIGl0c2VsZiBzbyB0aGUKdmJsYW5rIGNvZGUgY2FuIGdldCBhdCBpdC4gV2UgYWxyZWFk
eSBoYXZlIHNjYW5saW5lX29mZnNldCBpbiB0aGVyZQpmb3IgYSBzaW1pbGFyIHJlYXNvbiwgYXMg
d2VsbCBhcyB0aGUgdmJsYW5rLT5od21vZGUgd2hpY2ggaXMgYXNzaWduZWQKdmlhIGRybV9jYWxj
X3RpbWVzdGFtcGluZ19jb25zdGFudHMoKS4gRm9ydHVuYXRlbHkgd2Ugbm93IGhhdmUgYQpuaWNl
IHBsYWNlIGZvciBkb2luZyB0aGUgY3J0Y19zdGF0ZS0+Y3J0YyBjb3B5IGluCmludGVsX2NydGNf
dXBkYXRlX2FjdGl2ZV90aW1pbmdzKCkgd2hpY2ggZ2V0cyBjYWxsZWQgYm90aCBmb3IKbW9kZXNl
dHMgYW5kIGluaXQvcmVzdW1lIHJlYWRvdXQuCgpUaGUgb25lIHNsaWdodGx5IGlmZnkgc3BvdCBp
cyB0aGUgSU5IRVJJVEVEIGZsYWcgd2hpY2ggd2Ugd2FudCB0bwpwcmVzZXJ2ZSB1bnRpbCB1c2Vy
c3BhY2UvZmJfaGVscGVyIGRvZXMgdGhlIGZpcnN0IHByb3BlciBjb21taXQgYWZ0ZXIKYWN0dWFs
bHkgY2FsbGluZyAuZGV0ZWN0aSgpIG9uIHRoZSBjb25uZWN0b3JzLiBPdGhlcndpc2Ugd2UgZG9u
J3QgaGF2ZQp0aGUgZnVsbCBzaW5rIGNhcGFiaWxpdGllcyAoYXVkaW8saW5mb2ZyYW1lcyxldGMu
KSB3aGVuIC5jb21wdXRlX2NvbmZpZygpCmdldHMgY2FsbGVkIGFuZCB0aHVzIHdlIHdpbGwgZmFp
bCB0byBlbmFibGUgdGhvc2UgZmVhdHVyZXMgd2hlbiB0aGUKZmlyc3QgdXNlcnNwYWNlIGNvbW1p
dCBoYXBwZW5zLiBUaGUgb25seSBpbnRlcm5hbCBjb21taXQgd2UgZG8gcHJpb3IgdG8KdGhhdCBz
aG91bGQgYmUgZnJvbSBpbnRlbF9pbml0aWFsX2NvbW1pdCgpIGFuZCB0aGVyZSB3ZSBjYW4gc2lt
cGx5CnByZXNlcnZlIHRoZSBJTkhFUklURUQgZmxhZyBmcm9tIHRoZSByZWFkb3V0LgoKQ0M6IFNh
bSBSYXZuYm9yZyA8c2FtQHJhdm5ib3JnLm9yZz4KQ2M6IERhbmllbCBWZXR0ZXIgPGRhbmllbC52
ZXR0ZXJAZmZ3bGwuY2g+CkNjOiBFbWlsIFZlbGlrb3YgPGVtaWwubC52ZWxpa292QGdtYWlsLmNv
bT4KU2lnbmVkLW9mZi1ieTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4Lmlu
dGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ljbF9kc2kuYyAgICAg
ICAgfCAxMyArKysrLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0
b21pYy5jICAgfCAgMSArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3Bs
YXkuYyAgfCAyNCArKysrKysrKysrKysrLS0tLS0tCiAuLi4vZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9kaXNwbGF5X3R5cGVzLmggICAgfCAgOSArKysrKystCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX3R2LmMgICAgICAgfCAgNCArKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L3Zsdl9kc2kuYyAgICAgICAgfCAgNiArKy0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9pcnEuYyAgICAgICAgICAgICAgIHwgIDQgKystLQogNyBmaWxlcyBjaGFuZ2VkLCAzNyBp
bnNlcnRpb25zKCspLCAyNCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ljbF9kc2kuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aWNsX2RzaS5jCmluZGV4IDk5YTI1YzBiYjA4Zi4uNGQ2Nzg4ZWYyZTVlIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ljbF9kc2kuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ljbF9kc2kuYwpAQCAtMTQ2OSw4ICsxNDY5LDcgQEAgc3RhdGljIHZv
aWQgZ2VuMTFfZHNpX2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJ
cGlwZV9jb25maWctPnBpcGVfYnBwID0gYmR3X2dldF9waXBlbWlzY19icHAoY3J0Yyk7CiAKIAlp
ZiAoZ2VuMTFfZHNpX2lzX3BlcmlvZGljX2NtZF9tb2RlKGludGVsX2RzaSkpCi0JCXBpcGVfY29u
ZmlnLT5ody5hZGp1c3RlZF9tb2RlLnByaXZhdGVfZmxhZ3MgfD0KLQkJCQkJSTkxNV9NT0RFX0ZM
QUdfRFNJX1BFUklPRElDX0NNRF9NT0RFOworCQlwaXBlX2NvbmZpZy0+bW9kZV9mbGFncyB8PSBJ
OTE1X01PREVfRkxBR19EU0lfUEVSSU9ESUNfQ01EX01PREU7CiB9CiAKIHN0YXRpYyBpbnQgZ2Vu
MTFfZHNpX2RzY19jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
QEAgLTE1NTUsMTAgKzE1NTQsNiBAQCBzdGF0aWMgaW50IGdlbjExX2RzaV9jb21wdXRlX2NvbmZp
ZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAogCXBpcGVfY29uZmlnLT5wb3J0X2Ns
b2NrID0gYWZlX2NsayhlbmNvZGVyLCBwaXBlX2NvbmZpZykgLyA1OwogCi0JLyogV2Ugd291bGQg
bm90IG9wZXJhdGUgaW4gcGVyaW9kaWMgY29tbWFuZCBtb2RlICovCi0JcGlwZV9jb25maWctPmh3
LmFkanVzdGVkX21vZGUucHJpdmF0ZV9mbGFncyAmPQotCQkJCQl+STkxNV9NT0RFX0ZMQUdfRFNJ
X1BFUklPRElDX0NNRF9NT0RFOwotCiAJLyoKIAkgKiBJbiBjYXNlIG9mIFRFIEdBVEUgY21kIG1v
ZGUsIHdlCiAJICogcmVjZWl2ZSBURSBmcm9tIHRoZSBzbGF2ZSBpZgpAQCAtMTU2NiwxNCArMTU2
MSwxNCBAQCBzdGF0aWMgaW50IGdlbjExX2RzaV9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKIAkgKi8KIAlpZiAoaXNfY21kX21vZGUoaW50ZWxfZHNpKSkgewog
CQlpZiAoaW50ZWxfZHNpLT5wb3J0cyA9PSAoQklUKFBPUlRfQikgfCBCSVQoUE9SVF9BKSkpCi0J
CQlwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5wcml2YXRlX2ZsYWdzIHw9CisJCQlwaXBl
X2NvbmZpZy0+bW9kZV9mbGFncyB8PQogCQkJCQkJSTkxNV9NT0RFX0ZMQUdfRFNJX1VTRV9URTEg
fAogCQkJCQkJSTkxNV9NT0RFX0ZMQUdfRFNJX1VTRV9URTA7CiAJCWVsc2UgaWYgKGludGVsX2Rz
aS0+cG9ydHMgPT0gQklUKFBPUlRfQikpCi0JCQlwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9k
ZS5wcml2YXRlX2ZsYWdzIHw9CisJCQlwaXBlX2NvbmZpZy0+bW9kZV9mbGFncyB8PQogCQkJCQkJ
STkxNV9NT0RFX0ZMQUdfRFNJX1VTRV9URTE7CiAJCWVsc2UKLQkJCXBpcGVfY29uZmlnLT5ody5h
ZGp1c3RlZF9tb2RlLnByaXZhdGVfZmxhZ3MgfD0KKwkJCXBpcGVfY29uZmlnLT5tb2RlX2ZsYWdz
IHw9CiAJCQkJCQlJOTE1X01PREVfRkxBR19EU0lfVVNFX1RFMDsKIAl9CiAKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0b21pYy5jCmluZGV4IGQwNDMwNTdkMmZhMC4uNTg2
M2UzMzlhNDI2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2F0b21pYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWlj
LmMKQEAgLTI1Miw2ICsyNTIsNyBAQCBpbnRlbF9jcnRjX2R1cGxpY2F0ZV9zdGF0ZShzdHJ1Y3Qg
ZHJtX2NydGMgKmNydGMpCiAJY3J0Y19zdGF0ZS0+d20ubmVlZF9wb3N0dmJsX3VwZGF0ZSA9IGZh
bHNlOwogCWNydGNfc3RhdGUtPmZiX2JpdHMgPSAwOwogCWNydGNfc3RhdGUtPnVwZGF0ZV9wbGFu
ZXMgPSAwOworCWNydGNfc3RhdGUtPm1vZGVfZmxhZ3MgJj0gfkk5MTVfTU9ERV9GTEFHX0lOSEVS
SVRFRDsKIAogCXJldHVybiAmY3J0Y19zdGF0ZS0+dWFwaTsKIH0KZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKaW5kZXggYmNiNWQ3NTRmMjBkLi5kODhjYWRl
NDVjMzUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlz
cGxheS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5j
CkBAIC02NDE0LDcgKzY0MTQsNyBAQCBzdGF0aWMgYm9vbCBoc3dfcG9zdF91cGRhdGVfZW5hYmxl
X2lwcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfcwogCSAqIGZvcmNp
Ymx5IGVuYWJsZSBJUFMgb24gdGhlIGZpcnN0IGZhc3RzZXQuCiAJICovCiAJaWYgKG5ld19jcnRj
X3N0YXRlLT51cGRhdGVfcGlwZSAmJgotCSAgICBvbGRfY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRf
bW9kZS5wcml2YXRlX2ZsYWdzICYgSTkxNV9NT0RFX0ZMQUdfSU5IRVJJVEVEKQorCSAgICBvbGRf
Y3J0Y19zdGF0ZS0+bW9kZV9mbGFncyAmIEk5MTVfTU9ERV9GTEFHX0lOSEVSSVRFRCkKIAkJcmV0
dXJuIHRydWU7CiAKIAlyZXR1cm4gIW9sZF9jcnRjX3N0YXRlLT5pcHNfZW5hYmxlZDsKQEAgLTEz
NTE2LDggKzEzNTE2LDggQEAgaW50ZWxfcGlwZV9jb25maWdfY29tcGFyZShjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3VycmVudF9jb25maWcsCiAJYm9vbCByZXQgPSB0cnVlOwogCXUz
MiBicF9nYW1tYSA9IDA7CiAJYm9vbCBmaXh1cF9pbmhlcml0ZWQgPSBmYXN0c2V0ICYmCi0JCShj
dXJyZW50X2NvbmZpZy0+aHcubW9kZS5wcml2YXRlX2ZsYWdzICYgSTkxNV9NT0RFX0ZMQUdfSU5I
RVJJVEVEKSAmJgotCQkhKHBpcGVfY29uZmlnLT5ody5tb2RlLnByaXZhdGVfZmxhZ3MgJiBJOTE1
X01PREVfRkxBR19JTkhFUklURUQpOworCQkoY3VycmVudF9jb25maWctPm1vZGVfZmxhZ3MgJiBJ
OTE1X01PREVfRkxBR19JTkhFUklURUQpICYmCisJCSEocGlwZV9jb25maWctPm1vZGVfZmxhZ3Mg
JiBJOTE1X01PREVfRkxBR19JTkhFUklURUQpOwogCiAJaWYgKGZpeHVwX2luaGVyaXRlZCAmJiAh
ZmFzdGJvb3RfZW5hYmxlZChkZXZfcHJpdikpIHsKIAkJZHJtX2RiZ19rbXMoJmRldl9wcml2LT5k
cm0sCkBAIC0xNDMwNyw2ICsxNDMwNyw4IEBAIGludGVsX2NydGNfdXBkYXRlX2FjdGl2ZV90aW1p
bmdzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQogCiAJZHJtX2Nh
bGNfdGltZXN0YW1waW5nX2NvbnN0YW50cygmY3J0Yy0+YmFzZSwgYWRqdXN0ZWRfbW9kZSk7CiAK
KwljcnRjLT5tb2RlX2ZsYWdzID0gY3J0Y19zdGF0ZS0+bW9kZV9mbGFnczsKKwogCS8qCiAJICog
VGhlIHNjYW5saW5lIGNvdW50ZXIgaW5jcmVtZW50cyBhdCB0aGUgbGVhZGluZyBlZGdlIG9mIGhz
eW5jLgogCSAqCkBAIC0xNDY2OCw4ICsxNDY3MCw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfYXRvbWlj
X2NoZWNrKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJLyogQ2F0Y2ggSTkxNV9NT0RFX0ZMQUdf
SU5IRVJJVEVEICovCiAJZm9yX2VhY2hfb2xkbmV3X2ludGVsX2NydGNfaW5fc3RhdGUoc3RhdGUs
IGNydGMsIG9sZF9jcnRjX3N0YXRlLAogCQkJCQkgICAgbmV3X2NydGNfc3RhdGUsIGkpIHsKLQkJ
aWYgKG5ld19jcnRjX3N0YXRlLT51YXBpLm1vZGUucHJpdmF0ZV9mbGFncyAhPQotCQkgICAgb2xk
X2NydGNfc3RhdGUtPnVhcGkubW9kZS5wcml2YXRlX2ZsYWdzKQorCQlpZiAobmV3X2NydGNfc3Rh
dGUtPm1vZGVfZmxhZ3MgIT0gb2xkX2NydGNfc3RhdGUtPm1vZGVfZmxhZ3MpCiAJCQluZXdfY3J0
Y19zdGF0ZS0+dWFwaS5tb2RlX2NoYW5nZWQgPSB0cnVlOwogCX0KIApAQCAtMTUwMTUsNyArMTUw
MTYsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF91cGRhdGVfY3J0YyhzdHJ1Y3QgaW50ZWxfYXRvbWlj
X3N0YXRlICpzdGF0ZSwKIAkgKiBvZiBlbmFibGluZyB0aGVtIG9uIHRoZSBDUlRDJ3MgZmlyc3Qg
ZmFzdHNldC4KIAkgKi8KIAlpZiAobmV3X2NydGNfc3RhdGUtPnVwZGF0ZV9waXBlICYmICFtb2Rl
c2V0ICYmCi0JICAgIG9sZF9jcnRjX3N0YXRlLT5ody5tb2RlLnByaXZhdGVfZmxhZ3MgJiBJOTE1
X01PREVfRkxBR19JTkhFUklURUQpCisJICAgIG9sZF9jcnRjX3N0YXRlLT5tb2RlX2ZsYWdzICYg
STkxNV9NT0RFX0ZMQUdfSU5IRVJJVEVEKQogCQlpbnRlbF9jcnRjX2FybV9maWZvX3VuZGVycnVu
KGNydGMsIG5ld19jcnRjX3N0YXRlKTsKIH0KIApAQCAtMTc0ODYsNiArMTc0ODcsMTUgQEAgc3Rh
dGljIGludCBpbnRlbF9pbml0aWFsX2NvbW1pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQogCQl9
CiAKIAkJaWYgKGNydGNfc3RhdGUtPmh3LmFjdGl2ZSkgeworCQkJLyoKKwkJCSAqIFdlJ3ZlIG5v
dCB5ZXQgZGV0ZWN0ZWQgc2luayBjYXBhYmlsaXRpZXMKKwkJCSAqIChhdWRpbyxpbmZvZnJhbWVz
LGV0Yy4pIGFuZCB0aHVzIHdlIGRvbid0IHdhbnQgdG8KKwkJCSAqIGZvcmNlIGEgZnVsbCBzdGF0
ZSByZWNvbXB1dGF0aW9uIHlldC4gV2Ugd2FudCB0aGF0IHRvCisJCQkgKiBoYXBwZW4gb25seSBm
b3IgdGhlIGZpcnN0IHJlYWwgY29tbWl0IGZyb20gdXNlcnNwYWNlLgorCQkJICogU28gcHJlc2Vy
dmUgdGhlIGluaGVyaXRlZCBmbGFnIGZvciB0aGUgdGltZSBiZWluZy4KKwkJCSAqLworCQkJY3J0
Y19zdGF0ZS0+bW9kZV9mbGFncyB8PSBJOTE1X01PREVfRkxBR19JTkhFUklURUQ7CisKIAkJCXJl
dCA9IGRybV9hdG9taWNfYWRkX2FmZmVjdGVkX3BsYW5lcyhzdGF0ZSwgJmNydGMtPmJhc2UpOwog
CQkJaWYgKHJldCkKIAkJCQlnb3RvIG91dDsKQEAgLTE4MjU2LDcgKzE4MjY2LDcgQEAgc3RhdGlj
IHZvaWQgaW50ZWxfbW9kZXNldF9yZWFkb3V0X2h3X3N0YXRlKHN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYpCiAJCQkgKiBzZXQgYSBmbGFnIHRvIGluZGljYXRlIHRoYXQgYSBmdWxsIHJlY2FsY3VsYXRp
b24gaXMKIAkJCSAqIG5lZWRlZCBvbiB0aGUgbmV4dCBjb21taXQuCiAJCQkgKi8KLQkJCW1vZGUt
PnByaXZhdGVfZmxhZ3MgPSBJOTE1X01PREVfRkxBR19JTkhFUklURUQ7CisJCQljcnRjX3N0YXRl
LT5tb2RlX2ZsYWdzIHw9IEk5MTVfTU9ERV9GTEFHX0lOSEVSSVRFRDsKIAogCQkJaW50ZWxfY3J0
Y19jb21wdXRlX3BpeGVsX3JhdGUoY3J0Y19zdGF0ZSk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgKaW5kZXggMmJlZGQ2MjZjNjg2
Li4yNmRmODU2ZjhiNzIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfZGlzcGxheV90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfZGlzcGxheV90eXBlcy5oCkBAIC02NDEsNyArNjQxLDcgQEAgc3RydWN0IGludGVsX2Ny
dGNfc2NhbGVyX3N0YXRlIHsKIAlpbnQgc2NhbGVyX2lkOwogfTsKIAotLyogZHJtX21vZGUtPnBy
aXZhdGVfZmxhZ3MgKi8KKy8qIHtjcnRjLGNydGNfc3RhdGV9LT5tb2RlX2ZsYWdzICovCiAjZGVm
aW5lIEk5MTVfTU9ERV9GTEFHX0lOSEVSSVRFRCAoMTw8MCkKIC8qIEZsYWcgdG8gZ2V0IHNjYW5s
aW5lIHVzaW5nIGZyYW1lIHRpbWUgc3RhbXBzICovCiAjZGVmaW5lIEk5MTVfTU9ERV9GTEFHX0dF
VF9TQ0FOTElORV9GUk9NX1RJTUVTVEFNUCAoMTw8MSkKQEAgLTk1Miw2ICs5NTIsOSBAQCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSB7CiAJLyogVXNlZCBieSBTRFZPIChhbmQgaWYgd2UgZXZlciBm
aXggaXQsIEhETUkpLiAqLwogCXVuc2lnbmVkIHBpeGVsX211bHRpcGxpZXI7CiAKKwkvKiBJOTE1
X01PREVfRkxBR18qICovCisJdTggbW9kZV9mbGFnczsKKwogCXU4IGxhbmVfY291bnQ7CiAKIAkv
KgpAQCAtMTExNSw2ICsxMTE4LDEwIEBAIHN0cnVjdCBpbnRlbF9jcnRjIHsKIAkgKi8KIAlib29s
IGFjdGl2ZTsKIAl1OCBwbGFuZV9pZHNfbWFzazsKKworCS8qIEk5MTVfTU9ERV9GTEFHXyogKi8K
Kwl1OCBtb2RlX2ZsYWdzOworCiAJdW5zaWduZWQgbG9uZyBsb25nIGVuYWJsZWRfcG93ZXJfZG9t
YWluczsKIAlzdHJ1Y3QgaW50ZWxfb3ZlcmxheSAqb3ZlcmxheTsKIApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF90di5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF90di5jCmluZGV4IGFiYzY3MjA3ZjJmMy4uNzc3MDMyZDk2OTdiIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3R2LmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF90di5jCkBAIC0xMTU4LDcgKzExNTgs
NyBAQCBpbnRlbF90dl9nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAog
CiAJLyogcGl4ZWwgY291bnRlciBkb2Vzbid0IHdvcmsgb24gaTk2NWdtIFRWIG91dHB1dCAqLwog
CWlmIChJU19JOTY1R00oZGV2X3ByaXYpKQotCQlhZGp1c3RlZF9tb2RlLT5wcml2YXRlX2ZsYWdz
IHw9CisJCXBpcGVfY29uZmlnLT5tb2RlX2ZsYWdzIHw9CiAJCQlJOTE1X01PREVfRkxBR19VU0Vf
U0NBTkxJTkVfQ09VTlRFUjsKIH0KIApAQCAtMTMyOCw3ICsxMzI4LDcgQEAgaW50ZWxfdHZfY29t
cHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAKIAkvKiBwaXhlbCBj
b3VudGVyIGRvZXNuJ3Qgd29yayBvbiBpOTY1Z20gVFYgb3V0cHV0ICovCiAJaWYgKElTX0k5NjVH
TShkZXZfcHJpdikpCi0JCWFkanVzdGVkX21vZGUtPnByaXZhdGVfZmxhZ3MgfD0KKwkJcGlwZV9j
b25maWctPm1vZGVfZmxhZ3MgfD0KIAkJCUk5MTVfTU9ERV9GTEFHX1VTRV9TQ0FOTElORV9DT1VO
VEVSOwogCiAJcmV0dXJuIDA7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L3Zsdl9kc2kuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvdmx2X2RzaS5jCmlu
ZGV4IDRlMThkNDYyNzA2NS4uZDhiMWMxMmNiMjFjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L3Zsdl9kc2kuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L3Zsdl9kc2kuYwpAQCAtMjk5LDcgKzI5OSw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfZHNpX2Nv
bXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCiAJaWYgKElTX0dF
TjlfTFAoZGV2X3ByaXYpKSB7CiAJCS8qIEVuYWJsZSBGcmFtZSB0aW1lIHN0YW1wIGJhc2VkIHNj
YW5saW5lIHJlcG9ydGluZyAqLwotCQlhZGp1c3RlZF9tb2RlLT5wcml2YXRlX2ZsYWdzIHw9CisJ
CXBpcGVfY29uZmlnLT5tb2RlX2ZsYWdzIHw9CiAJCQlJOTE1X01PREVfRkxBR19HRVRfU0NBTkxJ
TkVfRlJPTV9USU1FU1RBTVA7CiAKIAkJLyogRHVhbCBsaW5rIGdvZXMgdG8gRFNJIHRyYW5zY29k
ZXIgQS4gKi8KQEAgLTEwOTgsOCArMTA5OCw4IEBAIHN0YXRpYyB2b2lkIGJ4dF9kc2lfZ2V0X3Bp
cGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCXBpcGVfY29uZmlnLT5w
aXBlX2JwcCA9IGJkd19nZXRfcGlwZW1pc2NfYnBwKGNydGMpOwogCiAJLyogRW5hYmxlIEZyYW1l
IHRpbWUgc3RhbW8gYmFzZWQgc2NhbmxpbmUgcmVwb3J0aW5nICovCi0JYWRqdXN0ZWRfbW9kZS0+
cHJpdmF0ZV9mbGFncyB8PQotCQkJSTkxNV9NT0RFX0ZMQUdfR0VUX1NDQU5MSU5FX0ZST01fVElN
RVNUQU1QOworCXBpcGVfY29uZmlnLT5tb2RlX2ZsYWdzIHw9CisJCUk5MTVfTU9ERV9GTEFHX0dF
VF9TQ0FOTElORV9GUk9NX1RJTUVTVEFNUDsKIAogCS8qIEluIHRlcm1zIG9mIHBpeGVscyAqLwog
CWFkanVzdGVkX21vZGUtPmNydGNfaGRpc3BsYXkgPQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9pcnEuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmMKaW5k
ZXggMTUwMmFiNDRmMWE1Li41NWVkOTUxNmJmZDMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfaXJxLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9pcnEuYwpA
QCAtNzM1LDcgKzczNSw3IEBAIHN0YXRpYyBpbnQgX19pbnRlbF9nZXRfY3J0Y19zY2FubGluZShz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKIAl2YmxhbmsgPSAmY3J0Yy0+YmFzZS5kZXYtPnZibGFu
a1tkcm1fY3J0Y19pbmRleCgmY3J0Yy0+YmFzZSldOwogCW1vZGUgPSAmdmJsYW5rLT5od21vZGU7
CiAKLQlpZiAobW9kZS0+cHJpdmF0ZV9mbGFncyAmIEk5MTVfTU9ERV9GTEFHX0dFVF9TQ0FOTElO
RV9GUk9NX1RJTUVTVEFNUCkKKwlpZiAoY3J0Yy0+bW9kZV9mbGFncyAmIEk5MTVfTU9ERV9GTEFH
X0dFVF9TQ0FOTElORV9GUk9NX1RJTUVTVEFNUCkKIAkJcmV0dXJuIF9faW50ZWxfZ2V0X2NydGNf
c2NhbmxpbmVfZnJvbV90aW1lc3RhbXAoY3J0Yyk7CiAKIAl2dG90YWwgPSBtb2RlLT5jcnRjX3Z0
b3RhbDsKQEAgLTc5NCw3ICs3OTQsNyBAQCBzdGF0aWMgYm9vbCBpOTE1X2dldF9jcnRjX3NjYW5v
dXRwb3Moc3RydWN0IGRybV9jcnRjICpfY3J0YywKIAl1bnNpZ25lZCBsb25nIGlycWZsYWdzOwog
CWJvb2wgdXNlX3NjYW5saW5lX2NvdW50ZXIgPSBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDUgfHwK
IAkJSVNfRzRYKGRldl9wcml2KSB8fCBJU19HRU4oZGV2X3ByaXYsIDIpIHx8Ci0JCW1vZGUtPnBy
aXZhdGVfZmxhZ3MgJiBJOTE1X01PREVfRkxBR19VU0VfU0NBTkxJTkVfQ09VTlRFUjsKKwkJY3J0
Yy0+bW9kZV9mbGFncyAmIEk5MTVfTU9ERV9GTEFHX1VTRV9TQ0FOTElORV9DT1VOVEVSOwogCiAJ
aWYgKGRybV9XQVJOX09OKCZkZXZfcHJpdi0+ZHJtLCAhbW9kZS0+Y3J0Y19jbG9jaykpIHsKIAkJ
ZHJtX2RiZygmZGV2X3ByaXYtPmRybSwKLS0gCjIuMjQuMQoKX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2
ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21h
aWxtYW4vbGlzdGluZm8vZHJpLWRldmVsCg==
