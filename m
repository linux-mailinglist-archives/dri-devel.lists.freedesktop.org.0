Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id B53BC3C090
	for <lists+dri-devel@lfdr.de>; Tue, 11 Jun 2019 02:29:45 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 54E338916A;
	Tue, 11 Jun 2019 00:29:17 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-qk1-x749.google.com (mail-qk1-x749.google.com
 [IPv6:2607:f8b0:4864:20::749])
 by gabe.freedesktop.org (Postfix) with ESMTPS id C1DB689109
 for <dri-devel@lists.freedesktop.org>; Mon, 10 Jun 2019 23:52:09 +0000 (UTC)
Received: by mail-qk1-x749.google.com with SMTP id u129so9470995qkd.12
 for <dri-devel@lists.freedesktop.org>; Mon, 10 Jun 2019 16:52:09 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:date:in-reply-to:message-id:mime-version
 :references:subject:from:to:cc;
 bh=mlxJDYZKh9wYq/WtDU7yH8cffd94xLXLnzUxx7frAqI=;
 b=iKbZ+gt3dsGdsojRhsqnRIuvwO9Ug56tcrTGXvzdcG9LhR3dAURk8L4Y8v7rJJq7QP
 k+EHFuO9nLkqFxoJK7WU8Ku1bsQrmTnaIExziDgBQMBS5CotVyHAOHdAlCOLCw4LS1VX
 eFk1KrNK99Q8i/H7NOuYvQs5cQEm6/ANAsBed9/+yJoDdexuUNVaT6I/kJ4ZkmMBbp93
 rcVoc9PbbtAAr+jA1l1KxCfE7DOYHIQvjoglQI1CRVw+xteTIZHa0/M1aXNfMhJkGZj+
 MuFe7jotgGRBO3lpGmn1MFCCKq7paAczNquN0aiHxUjDBB+W9XxIESPMA2ePogI32Qe+
 5cVA==
X-Gm-Message-State: APjAAAWKW5SA6Rr29Xuzub5sXnJk1W8wdk1zA4krvXq+G538uLSrluTN
 3IUvfz3GMn//kySjmAKsk6Rq3ca4ng==
X-Google-Smtp-Source: APXvYqya2j1UvRFWBx9kQIW/1TpCoTAj4gQTPHahMs8WLCgjSh12s3FCppHWR7MYPd2wk4l8FUWyAM7tgQ==
X-Received: by 2002:a0c:89a5:: with SMTP id 34mr38263565qvr.110.1560210728734; 
 Mon, 10 Jun 2019 16:52:08 -0700 (PDT)
Date: Mon, 10 Jun 2019 16:52:00 -0700
In-Reply-To: <20190610235201.145457-1-fengc@google.com>
Message-Id: <20190610235201.145457-3-fengc@google.com>
Mime-Version: 1.0
References: <20190610235201.145457-1-fengc@google.com>
X-Mailer: git-send-email 2.22.0.rc2.383.gf4fbbf30c2-goog
Subject: [RESEND PATCH v3 2/3] dma-buf: add DMA_BUF_{GET,SET}_NAME ioctls
From: Chenbo Feng <fengc@google.com>
To: linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org, 
 --validate@google.com
X-Mailman-Approved-At: Tue, 11 Jun 2019 00:29:12 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=google.com; s=20161025;
 h=date:in-reply-to:message-id:mime-version:references:subject:from:to
 :cc;
 bh=mlxJDYZKh9wYq/WtDU7yH8cffd94xLXLnzUxx7frAqI=;
 b=rQaual/DBiHZHp7DF8/Thr626kZ6P76nw2hD0Qm0ARQj1OU230xKPZK/zrQPw3iF/D
 1bFE4j3ANW8glHQXKut7i+XxXmc6m1+FnKeycgykblAfjN0pF98kCZruBZRD7v4wAyJK
 WxXT7EFz4Q24oMf+tuM1XRS4IuZTqz6toAcZyTq/IT9zFnMWkkLVnnQpvIesrPdxK8xe
 faO4x9hpF/ZOoLuwAG+riS5RAA5p/nqfzTqP4iDcxD9o2xxe31N4qKqc33s7WM/m4omS
 jJJq+N6EyyP/agi856I2pxB7aNv/WPTQYyH/tFoxVJGcgXp5R9E3MwWVjbJo9I2GSoy+
 s/lQ==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: kernel-team@android.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogR3JlZyBIYWNrbWFubiA8Z2hhY2ttYW5uQGdvb2dsZS5jb20+CgpUaGlzIHBhdGNoIGFk
ZHMgY29tcGxpbWVudGFyeSBETUFfQlVGX1NFVF9OQU1FIGFuZCBETUFfQlVGX0dFVF9OQU1FCmlv
Y3Rscywgd2hpY2ggbGV0cyB1c2Vyc3BhY2UgcHJvY2Vzc2VzIGF0dGFjaCBhIGZyZWUtZm9ybSBu
YW1lIHRvIGVhY2gKYnVmZmVyLgoKVGhpcyBpbmZvcm1hdGlvbiBjYW4gYmUgZXh0cmVtZWx5IGhl
bHBmdWwgZm9yIHRyYWNraW5nIGFuZCBhY2NvdW50aW5nCnNoYXJlZCBidWZmZXJzLiAgRm9yIGV4
YW1wbGUsIG9uIEFuZHJvaWQsIHdlIGtub3cgd2hhdCBlYWNoIGJ1ZmZlciB3aWxsCmJlIHVzZWQg
Zm9yIGF0IGFsbG9jYXRpb24gdGltZTogR0wsIG11bHRpbWVkaWEsIGNhbWVyYSwgZXRjLiAgVGhl
CnVzZXJzcGFjZSBhbGxvY2F0b3IgY2FuIHVzZSBETUFfQlVGX1NFVF9OQU1FIHRvIGFzc29jaWF0
ZSB0aGF0CmluZm9ybWF0aW9uIHdpdGggdGhlIGJ1ZmZlciwgc28gd2UgY2FuIGxhdGVyIGdpdmUg
ZGV2ZWxvcGVycyBhCmJyZWFrZG93biBvZiBob3cgbXVjaCBtZW1vcnkgdGhleSdyZSBhbGxvY2F0
aW5nIGZvciBncmFwaGljcywgY2FtZXJhLApldGMuCgpTaWduZWQtb2ZmLWJ5OiBHcmVnIEhhY2tt
YW5uIDxnaGFja21hbm5AZ29vZ2xlLmNvbT4KU2lnbmVkLW9mZi1ieTogQ2hlbmJvIEZlbmcgPGZl
bmdjQGdvb2dsZS5jb20+Ci0tLQogZHJpdmVycy9kbWEtYnVmL2RtYS1idWYuYyAgICB8IDQ5ICsr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tLQogaW5jbHVkZS9saW51eC9kbWEtYnVm
LmggICAgICB8ICA1ICsrKy0KIGluY2x1ZGUvdWFwaS9saW51eC9kbWEtYnVmLmggfCAgMyArKysK
IDMgZmlsZXMgY2hhbmdlZCwgNTMgaW5zZXJ0aW9ucygrKSwgNCBkZWxldGlvbnMoLSkKCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2RtYS1idWYvZG1hLWJ1Zi5jIGIvZHJpdmVycy9kbWEtYnVmL2RtYS1i
dWYuYwppbmRleCBmZmQ1YTJhZDdkNmYuLmMxZGE1ZjljZTQ0ZCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9kbWEtYnVmL2RtYS1idWYuYworKysgYi9kcml2ZXJzL2RtYS1idWYvZG1hLWJ1Zi5jCkBAIC00
OCw4ICs0OCwyNCBAQCBzdHJ1Y3QgZG1hX2J1Zl9saXN0IHsKIAogc3RhdGljIHN0cnVjdCBkbWFf
YnVmX2xpc3QgZGJfbGlzdDsKIAorc3RhdGljIGNoYXIgKmRtYWJ1ZmZzX2RuYW1lKHN0cnVjdCBk
ZW50cnkgKmRlbnRyeSwgY2hhciAqYnVmZmVyLCBpbnQgYnVmbGVuKQoreworCXN0cnVjdCBkbWFf
YnVmICpkbWFidWY7CisJY2hhciBuYW1lW0RNQV9CVUZfTkFNRV9MRU5dOworCXNpemVfdCByZXQg
PSAwOworCisJZG1hYnVmID0gZGVudHJ5LT5kX2ZzZGF0YTsKKwltdXRleF9sb2NrKCZkbWFidWYt
PmxvY2spOworCWlmIChkbWFidWYtPm5hbWUpCisJCXJldCA9IHN0cmxjcHkobmFtZSwgZG1hYnVm
LT5uYW1lLCBETUFfQlVGX05BTUVfTEVOKTsKKwltdXRleF91bmxvY2soJmRtYWJ1Zi0+bG9jayk7
CisKKwlyZXR1cm4gZHluYW1pY19kbmFtZShkZW50cnksIGJ1ZmZlciwgYnVmbGVuLCAiLyVzOiVz
IiwKKwkJCSAgICAgZGVudHJ5LT5kX25hbWUubmFtZSwgcmV0ID4gMCA/IG5hbWUgOiAiIik7Cit9
CisKIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZGVudHJ5X29wZXJhdGlvbnMgZG1hX2J1Zl9kZW50cnlf
b3BzID0gewotCS5kX2RuYW1lID0gc2ltcGxlX2RuYW1lLAorCS5kX2RuYW1lID0gZG1hYnVmZnNf
ZG5hbWUsCiB9OwogCiBzdGF0aWMgc3RydWN0IHZmc21vdW50ICpkbWFfYnVmX21udDsKQEAgLTI5
Nyw2ICszMTMsMjcgQEAgc3RhdGljIF9fcG9sbF90IGRtYV9idWZfcG9sbChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgcG9sbF90YWJsZSAqcG9sbCkKIAlyZXR1cm4gZXZlbnRzOwogfQogCitzdGF0aWMgbG9u
ZyBkbWFfYnVmX3NldF9uYW1lKHN0cnVjdCBkbWFfYnVmICpkbWFidWYsIGNvbnN0IGNoYXIgX191
c2VyICpidWYpCit7CisJY2hhciAqbmFtZSA9IHN0cm5kdXBfdXNlcihidWYsIERNQV9CVUZfTkFN
RV9MRU4pOworCWxvbmcgcmV0ID0gMDsKKworCWlmIChJU19FUlIobmFtZSkpCisJCXJldHVybiBQ
VFJfRVJSKG5hbWUpOworCisJbXV0ZXhfbG9jaygmZG1hYnVmLT5sb2NrKTsKKwlpZiAoIWxpc3Rf
ZW1wdHkoJmRtYWJ1Zi0+YXR0YWNobWVudHMpKSB7CisJCXJldCA9IC1FQlVTWTsKKwkJZ290byBv
dXRfdW5sb2NrOworCX0KKwlrZnJlZShkbWFidWYtPm5hbWUpOworCWRtYWJ1Zi0+bmFtZSA9IG5h
bWU7CisKK291dF91bmxvY2s6CisJbXV0ZXhfdW5sb2NrKCZkbWFidWYtPmxvY2spOworCXJldHVy
biByZXQ7Cit9CisKIHN0YXRpYyBsb25nIGRtYV9idWZfaW9jdGwoc3RydWN0IGZpbGUgKmZpbGUs
CiAJCQkgIHVuc2lnbmVkIGludCBjbWQsIHVuc2lnbmVkIGxvbmcgYXJnKQogewpAQCAtMzM1LDYg
KzM3MiwxMCBAQCBzdGF0aWMgbG9uZyBkbWFfYnVmX2lvY3RsKHN0cnVjdCBmaWxlICpmaWxlLAog
CQkJcmV0ID0gZG1hX2J1Zl9iZWdpbl9jcHVfYWNjZXNzKGRtYWJ1ZiwgZGlyZWN0aW9uKTsKIAog
CQlyZXR1cm4gcmV0OworCisJY2FzZSBETUFfQlVGX1NFVF9OQU1FOgorCQlyZXR1cm4gZG1hX2J1
Zl9zZXRfbmFtZShkbWFidWYsIChjb25zdCBjaGFyIF9fdXNlciAqKWFyZyk7CisKIAlkZWZhdWx0
OgogCQlyZXR1cm4gLUVOT1RUWTsKIAl9CkBAIC0zNzYsNiArNDE3LDcgQEAgc3RhdGljIHN0cnVj
dCBmaWxlICpkbWFfYnVmX2dldGZpbGUoc3RydWN0IGRtYV9idWYgKmRtYWJ1ZiwgaW50IGZsYWdz
KQogCQlnb3RvIGVycl9hbGxvY19maWxlOwogCWZpbGUtPmZfZmxhZ3MgPSBmbGFncyAmIChPX0FD
Q01PREUgfCBPX05PTkJMT0NLKTsKIAlmaWxlLT5wcml2YXRlX2RhdGEgPSBkbWFidWY7CisJZmls
ZS0+Zl9wYXRoLmRlbnRyeS0+ZF9mc2RhdGEgPSBkbWFidWY7CiAKIAlyZXR1cm4gZmlsZTsKIApA
QCAtMTA4MiwxMiArMTEyNCwxMyBAQCBzdGF0aWMgaW50IGRtYV9idWZfZGVidWdfc2hvdyhzdHJ1
Y3Qgc2VxX2ZpbGUgKnMsIHZvaWQgKnVudXNlZCkKIAkJCWNvbnRpbnVlOwogCQl9CiAKLQkJc2Vx
X3ByaW50ZihzLCAiJTA4enVcdCUwOHhcdCUwOHhcdCUwOGxkXHQlc1x0JTA4bHVcbiIsCisJCXNl
cV9wcmludGYocywgIiUwOHp1XHQlMDh4XHQlMDh4XHQlMDhsZFx0JXNcdCUwOGx1XHQlc1xuIiwK
IAkJCQlidWZfb2JqLT5zaXplLAogCQkJCWJ1Zl9vYmotPmZpbGUtPmZfZmxhZ3MsIGJ1Zl9vYmot
PmZpbGUtPmZfbW9kZSwKIAkJCQlmaWxlX2NvdW50KGJ1Zl9vYmotPmZpbGUpLAogCQkJCWJ1Zl9v
YmotPmV4cF9uYW1lLAotCQkJCWZpbGVfaW5vZGUoYnVmX29iai0+ZmlsZSktPmlfaW5vKTsKKwkJ
CQlmaWxlX2lub2RlKGJ1Zl9vYmotPmZpbGUpLT5pX2lubywKKwkJCQlidWZfb2JqLT5uYW1lID86
ICIiKTsKIAogCQlyb2JqID0gYnVmX29iai0+cmVzdjsKIAkJd2hpbGUgKHRydWUpIHsKZGlmZiAt
LWdpdCBhL2luY2x1ZGUvbGludXgvZG1hLWJ1Zi5oIGIvaW5jbHVkZS9saW51eC9kbWEtYnVmLmgK
aW5kZXggNTg3MjVmODkwYjViLi41ODI5OThlMTlkZjYgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvbGlu
dXgvZG1hLWJ1Zi5oCisrKyBiL2luY2x1ZGUvbGludXgvZG1hLWJ1Zi5oCkBAIC0yNTUsMTAgKzI1
NSwxMiBAQCBzdHJ1Y3QgZG1hX2J1Zl9vcHMgewogICogQGZpbGU6IGZpbGUgcG9pbnRlciB1c2Vk
IGZvciBzaGFyaW5nIGJ1ZmZlcnMgYWNyb3NzLCBhbmQgZm9yIHJlZmNvdW50aW5nLgogICogQGF0
dGFjaG1lbnRzOiBsaXN0IG9mIGRtYV9idWZfYXR0YWNobWVudCB0aGF0IGRlbm90ZXMgYWxsIGRl
dmljZXMgYXR0YWNoZWQuCiAgKiBAb3BzOiBkbWFfYnVmX29wcyBhc3NvY2lhdGVkIHdpdGggdGhp
cyBidWZmZXIgb2JqZWN0LgotICogQGxvY2s6IHVzZWQgaW50ZXJuYWxseSB0byBzZXJpYWxpemUg
bGlzdCBtYW5pcHVsYXRpb24sIGF0dGFjaC9kZXRhY2ggYW5kIHZtYXAvdW5tYXAKKyAqIEBsb2Nr
OiB1c2VkIGludGVybmFsbHkgdG8gc2VyaWFsaXplIGxpc3QgbWFuaXB1bGF0aW9uLCBhdHRhY2gv
ZGV0YWNoIGFuZAorICogICAgICAgIHZtYXAvdW5tYXAsIGFuZCBhY2Nlc3NlcyB0byBuYW1lCiAg
KiBAdm1hcHBpbmdfY291bnRlcjogdXNlZCBpbnRlcm5hbGx5IHRvIHJlZmNudCB0aGUgdm1hcHMK
ICAqIEB2bWFwX3B0cjogdGhlIGN1cnJlbnQgdm1hcCBwdHIgaWYgdm1hcHBpbmdfY291bnRlciA+
IDAKICAqIEBleHBfbmFtZTogbmFtZSBvZiB0aGUgZXhwb3J0ZXI7IHVzZWZ1bCBmb3IgZGVidWdn
aW5nLgorICogQG5hbWU6IHVzZXJzcGFjZS1wcm92aWRlZCBuYW1lOyB1c2VmdWwgZm9yIGFjY291
bnRpbmcgYW5kIGRlYnVnZ2luZy4KICAqIEBvd25lcjogcG9pbnRlciB0byBleHBvcnRlciBtb2R1
bGU7IHVzZWQgZm9yIHJlZmNvdW50aW5nIHdoZW4gZXhwb3J0ZXIgaXMgYQogICogICAgICAgICBr
ZXJuZWwgbW9kdWxlLgogICogQGxpc3Rfbm9kZTogbm9kZSBmb3IgZG1hX2J1ZiBhY2NvdW50aW5n
IGFuZCBkZWJ1Z2dpbmcuCkBAIC0yODYsNiArMjg4LDcgQEAgc3RydWN0IGRtYV9idWYgewogCXVu
c2lnbmVkIHZtYXBwaW5nX2NvdW50ZXI7CiAJdm9pZCAqdm1hcF9wdHI7CiAJY29uc3QgY2hhciAq
ZXhwX25hbWU7CisJY29uc3QgY2hhciAqbmFtZTsKIAlzdHJ1Y3QgbW9kdWxlICpvd25lcjsKIAlz
dHJ1Y3QgbGlzdF9oZWFkIGxpc3Rfbm9kZTsKIAl2b2lkICpwcml2OwpkaWZmIC0tZ2l0IGEvaW5j
bHVkZS91YXBpL2xpbnV4L2RtYS1idWYuaCBiL2luY2x1ZGUvdWFwaS9saW51eC9kbWEtYnVmLmgK
aW5kZXggZDc1ZGY1MjEwYTRhLi5kYmM3MDkyZTA0YjUgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvdWFw
aS9saW51eC9kbWEtYnVmLmgKKysrIGIvaW5jbHVkZS91YXBpL2xpbnV4L2RtYS1idWYuaApAQCAt
MzUsNyArMzUsMTAgQEAgc3RydWN0IGRtYV9idWZfc3luYyB7CiAjZGVmaW5lIERNQV9CVUZfU1lO
Q19WQUxJRF9GTEFHU19NQVNLIFwKIAkoRE1BX0JVRl9TWU5DX1JXIHwgRE1BX0JVRl9TWU5DX0VO
RCkKIAorI2RlZmluZSBETUFfQlVGX05BTUVfTEVOCTMyCisKICNkZWZpbmUgRE1BX0JVRl9CQVNF
CQknYicKICNkZWZpbmUgRE1BX0JVRl9JT0NUTF9TWU5DCV9JT1coRE1BX0JVRl9CQVNFLCAwLCBz
dHJ1Y3QgZG1hX2J1Zl9zeW5jKQorI2RlZmluZSBETUFfQlVGX1NFVF9OQU1FCV9JT1coRE1BX0JV
Rl9CQVNFLCAxLCBjb25zdCBjaGFyICopCiAKICNlbmRpZgotLSAKMi4yMi4wLnJjMi4zODMuZ2Y0
ZmJiZjMwYzItZ29vZwoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Au
b3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRl
dmVs
