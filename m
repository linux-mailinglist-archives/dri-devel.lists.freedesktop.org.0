Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 08A3BBB510
	for <lists+dri-devel@lfdr.de>; Mon, 23 Sep 2019 15:17:29 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 05C5389E86;
	Mon, 23 Sep 2019 13:17:22 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from NAM03-BY2-obe.outbound.protection.outlook.com
 (mail-eopbgr780133.outbound.protection.outlook.com [40.107.78.133])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E40A86E2F0
 for <dri-devel@lists.freedesktop.org>; Mon, 23 Sep 2019 09:08:18 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=Gwwzm9mQ8JoyTN629C6fXm8vflht1g37JiBLXCKZ9pHRRPNvfvLqRAJrcAtzONGXwI8xibY5OtEta0JDfgh0vJd3ZiWGbkvNpmebz60WgW/UwLV5/Z1zd05XV4a7y4B2DlRAz/9Hddce0A7s5cgKXvIxmrTMfRHrUV3R8gQEa/i9dE2kfdqTMvDJVGxo9a7o2SSwNuzQ8FtkBBAAJG6Gl+YVLZU42nIG4GjDPFZGYO5SltW87LB8azl5do/T5TFHBeU+DWdGJrLXMFXPnbeaT2fIyHWOrF79IgtBHlVtz7QMZSXjxlkGXaWpeqCwcxQdXOrRmBld6S3w849ewTSO8A==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=GSzVHUjfoZlfbfXnh6WdxMns8FDwlha231iF0M4ZFgQ=;
 b=CINjfj5I08piLrTSPOtmgwnIyTbh0ktDl6cl+LevoejI/DaO5SWIspUDQN37uwsRow3ZQVidgCWNvFsAdO4gTiAetLt0u0Z+UHzvN0vDoa0erKHWWGlxBdPz6tMtuBdQHS9RQDvenrAaD2eIxgo/a4o7oPVYsTq3dNX3W+IoC1/B+DNUYbUITzwbwoGpTZLkhPzu8u/YMy6/9Pt88bkNH44+ncQ0s9TbViTpHBuj7mNciKzPoxQreph1m20IoFKmB7LtqUbC2dWZaFDvvWWPz3xhnUPyzY2seTwV1nZYstnuxKPA+M1cX71y1zdSXaJ2Cdh6BISnHiIHt5FVfCgybg==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=analogixsemi.com; dmarc=pass action=none
 header.from=analogixsemi.com; dkim=pass header.d=analogixsemi.com; arc=none
Received: from MN2PR04MB5886.namprd04.prod.outlook.com (20.179.22.213) by
 MN2PR04MB6079.namprd04.prod.outlook.com (20.178.247.161) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2284.26; Mon, 23 Sep 2019 09:08:16 +0000
Received: from MN2PR04MB5886.namprd04.prod.outlook.com
 ([fe80::8520:f80f:ae9:63cd]) by MN2PR04MB5886.namprd04.prod.outlook.com
 ([fe80::8520:f80f:ae9:63cd%6]) with mapi id 15.20.2284.023; Mon, 23 Sep 2019
 09:08:16 +0000
From: Xin Ji <xji@analogixsemi.com>
To: "devel@driverdev.osuosl.org" <devel@driverdev.osuosl.org>, Laurent
 Pinchart <laurent.pinchart@ideasonboard.com>, Andrzej Hajda
 <a.hajda@samsung.com>
Subject: [PATCH v1 2/2] drm/bridge: anx7625: Add anx7625 MIPI DSI/DPI to DP
 bridge driver
Thread-Topic: [PATCH v1 2/2] drm/bridge: anx7625: Add anx7625 MIPI DSI/DPI to
 DP bridge driver
Thread-Index: AQHVce5vNFGtzAHjG0uDLtXCxIe+Ww==
Date: Mon, 23 Sep 2019 09:08:16 +0000
Message-ID: <e4a4d1f20b4e76781ec39f198d74fb7f6c05d786.1569229197.git.xji@analogixsemi.com>
References: <cover.1569229197.git.xji@analogixsemi.com>
In-Reply-To: <cover.1569229197.git.xji@analogixsemi.com>
Accept-Language: zh-CN, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: HK2PR04CA0061.apcprd04.prod.outlook.com
 (2603:1096:202:14::29) To MN2PR04MB5886.namprd04.prod.outlook.com
 (2603:10b6:208:a3::21)
x-ms-exchange-messagesentrepresentingtype: 1
x-originating-ip: [114.247.245.252]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: c6e27121-d9aa-4cdd-c5ef-08d7400591ad
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600167)(711020)(4605104)(1401327)(2017052603328)(7193020);
 SRVR:MN2PR04MB6079; 
x-ms-traffictypediagnostic: MN2PR04MB6079:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <MN2PR04MB607903555F02A74455E95A48C7850@MN2PR04MB6079.namprd04.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:5516;
x-forefront-prvs: 0169092318
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10019020)(376002)(396003)(136003)(39840400004)(366004)(346002)(199004)(189003)(66556008)(64756008)(66446008)(11346002)(3846002)(446003)(76176011)(8676002)(54906003)(305945005)(7736002)(66476007)(6486002)(4326008)(81156014)(110136005)(25786009)(81166006)(561924002)(66946007)(6512007)(8936002)(36756003)(6506007)(476003)(386003)(486006)(26005)(102836004)(2906002)(2616005)(71200400001)(186003)(71190400001)(478600001)(118296001)(52116002)(66066001)(14454004)(99286004)(5660300002)(107886003)(30864003)(6436002)(7416002)(6116002)(86362001)(5024004)(14444005)(256004)(2501003)(316002)(569006);
 DIR:OUT; SFP:1102; SCL:1; SRVR:MN2PR04MB6079;
 H:MN2PR04MB5886.namprd04.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: analogixsemi.com does not
 designate permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: xRnEFabKNQ7M/J8sSnXtw+/KiH3F0Pq3Sw+t/B9/eQMnJJSRgxNkkzbEGD5RihgftThU6gshABvRD/9y7q5aW+gMazYW5eW2hLFh4qwl6EY6osmlWHDlcMTeinK4JuNu/9BbZNGdEhHDGWtDs5FjVuGgcR4S21h+0Sh8m4TYsOrqC8tTWrDEL1CdHEEka6ZmbUgHQNnjmlM7bEAuIJehX0TqRmVA2Bf+2S8gCPQui9APQdyMBRhiNgp3LcOWIFZxHElxPgR/Przx5llWuXeTWV9rl56FpCYVxLyAhnWXQLJeCCjxXAPeXpCTtd0uBkMPfEgw1oBZBLcF9Rs1NglzajzWUSW5T/r7jdMMqKtu0XfWZ8uCQmfduP62ELMzTc4l09RewKNCyLwvwtQr5ZbLDVGg3wigffuJNcGf+VSny3Q=
Content-ID: <276068AE18D5174EA316298064E2AB34@namprd04.prod.outlook.com>
MIME-Version: 1.0
X-OriginatorOrg: analogixsemi.com
X-MS-Exchange-CrossTenant-Network-Message-Id: c6e27121-d9aa-4cdd-c5ef-08d7400591ad
X-MS-Exchange-CrossTenant-originalarrivaltime: 23 Sep 2019 09:08:16.6039 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: b099b0b4-f26c-4cf5-9a0f-d5be9acab205
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: i7JEg/IUE3/jKlW+0slALtHqzxt5tZh5sKhDHwQ4tU+rmHKcx6QS9xxapxAaFQcYXiFF79fltDd1n0DeCSMoKQ==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: MN2PR04MB6079
X-Mailman-Approved-At: Mon, 23 Sep 2019 13:17:21 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=Analogixsemi.onmicrosoft.com; s=selector2-Analogixsemi-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=GSzVHUjfoZlfbfXnh6WdxMns8FDwlha231iF0M4ZFgQ=;
 b=UUUsLELsp6bvSv8A9rMoOh32iycB17R1xIMD/78Gd3RCsShdsD15yN/jnCKcLwDYK1OC0WR4PwcA5MLqAvsG2Wql/Ob8oGRAar4pJURkspxvw6F+yLYZORXv6QgIKJa/j8UcpL5GH02bU8xW0i5j59tatjUqSLmDDuqMGaF1+ig=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=xji@analogixsemi.com; 
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Jernej Skrabec <jernej.skrabec@siol.net>, Jonas Karlman <jonas@kwiboo.se>,
 David Airlie <airlied@linux.ie>, Neil Armstrong <narmstrong@baylibre.com>,
 "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
 "dri-devel@lists.freedesktop.org" <dri-devel@lists.freedesktop.org>,
 Sheng Pan <span@analogixsemi.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIEFOWDc2MjUgaXMgYW4gdWx0cmEtbG93IHBvd2VyIDRLIE1vYmlsZSBIRCBUcmFuc21pdHRl
ciBkZXNpZ25lZApmb3IgcG9ydGFibGUgZGV2aWNlLiBJdCBjb252ZXJ0cyBNSVBJIERTSS9EUEkg
dG8gRGlzcGxheVBvcnQgMS4zIDRLLgoKVGhlIEFOWDc2MjUgY2FuIHN1cHBvcnQgYm90aCBVU0Ig
VHlwZS1DIFBEIGZlYXR1cmUgYW5kIE1JUEkgRFNJL0RQSQp0byBEUCBmZWF0dXJlLiBUaGlzIGRy
aXZlciBvbmx5IGVuYWJsZWQgTUlQSSBEU0kvRFBJIHRvIERQIGZlYXR1cmUuCgpTaWduZWQtb2Zm
LWJ5OiBYaW4gSmkgPHhqaUBhbmFsb2dpeHNlbWkuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9i
cmlkZ2UvTWFrZWZpbGUgICAgICAgICAgIHwgICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2JyaWRn
ZS9hbmFsb2dpeC9LY29uZmlnICAgfCAgICA2ICsKIGRyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5h
bG9naXgvTWFrZWZpbGUgIHwgICAgMSArCiBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4
L2FueDc2MjUuYyB8IDIxMTAgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIGRyaXZlcnMv
Z3B1L2RybS9icmlkZ2UvYW5hbG9naXgvYW54NzYyNS5oIHwgIDQwNSArKysrKysKIDUgZmlsZXMg
Y2hhbmdlZCwgMjUyMyBpbnNlcnRpb25zKCspLCAxIGRlbGV0aW9uKC0pCiBjcmVhdGUgbW9kZSAx
MDA2NDQgZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9hbng3NjI1LmMKIGNyZWF0ZSBt
b2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L2FueDc2MjUuaAoKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9k
cm0vYnJpZGdlL01ha2VmaWxlCmluZGV4IDQ5MzRmY2YuLmJjZDM4OGEgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9icmlkZ2UvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRn
ZS9NYWtlZmlsZQpAQCAtMTIsOCArMTIsOCBAQCBvYmotJChDT05GSUdfRFJNX1NJSTkyMzQpICs9
IHNpaTkyMzQubwogb2JqLSQoQ09ORklHX0RSTV9USElORV9USEM2M0xWRDEwMjQpICs9IHRoYzYz
bHZkMTAyNC5vCiBvYmotJChDT05GSUdfRFJNX1RPU0hJQkFfVEMzNTg3NjQpICs9IHRjMzU4NzY0
Lm8KIG9iai0kKENPTkZJR19EUk1fVE9TSElCQV9UQzM1ODc2NykgKz0gdGMzNTg3Njcubwotb2Jq
LSQoQ09ORklHX0RSTV9BTkFMT0dJWF9EUCkgKz0gYW5hbG9naXgvCiBvYmotJChDT05GSUdfRFJN
X0kyQ19BRFY3NTExKSArPSBhZHY3NTExLwogb2JqLSQoQ09ORklHX0RSTV9USV9TTjY1RFNJODYp
ICs9IHRpLXNuNjVkc2k4Ni5vCiBvYmotJChDT05GSUdfRFJNX1RJX1RGUDQxMCkgKz0gdGktdGZw
NDEwLm8KK29iai15ICs9IGFuYWxvZ2l4Lwogb2JqLXkgKz0gc3lub3BzeXMvCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L0tjb25maWcgYi9kcml2ZXJzL2dwdS9k
cm0vYnJpZGdlL2FuYWxvZ2l4L0tjb25maWcKaW5kZXggZTkzMGZmOS4uYjJmMTI3ZSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9LY29uZmlnCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvS2NvbmZpZwpAQCAtMiwzICsyLDkgQEAKIGNvbmZp
ZyBEUk1fQU5BTE9HSVhfRFAKIAl0cmlzdGF0ZQogCWRlcGVuZHMgb24gRFJNCisKK2NvbmZpZyBB
TkFMT0dJWF9BTlg3NjI1CisJdHJpc3RhdGUgIkFuYWxvZ2l4IE1JUEkgdG8gRFAgaW50ZXJmYWNl
IHN1cHBvcnQiCisJaGVscAorCQlBTlg3NjI1IGlzIGFuIHVsdHJhLWxvdyBwb3dlciA0SyBtb2Jp
bGUgSEQgdHJhbnNtaXR0ZXIgZGVzaWduZWQKKwkJZm9yIHBvcnRhYmxlIGRldmljZXMuIEl0IGNv
bnZlcnRzIE1JUEkvRFBJIHRvIERpc3BsYXlQb3J0MS4zIDRLLgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9icmlk
Z2UvYW5hbG9naXgvTWFrZWZpbGUKaW5kZXggZmRiZjNmZC4uOGE1Mjg2NyAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2dw
dS9kcm0vYnJpZGdlL2FuYWxvZ2l4L01ha2VmaWxlCkBAIC0xLDMgKzEsNCBAQAogIyBTUERYLUxp
Y2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5CitvYmotJChDT05GSUdfQU5BTE9HSVhfQU5Y
NzYyNSkgKz0gYW54NzYyNS5vCiBhbmFsb2dpeF9kcC1vYmpzIDo9IGFuYWxvZ2l4X2RwX2NvcmUu
byBhbmFsb2dpeF9kcF9yZWcubwogb2JqLSQoQ09ORklHX0RSTV9BTkFMT0dJWF9EUCkgKz0gYW5h
bG9naXhfZHAubwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9h
bng3NjI1LmMgYi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L2FueDc2MjUuYwpuZXcg
ZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi4yYTk0Yjg1Ci0tLSAvZGV2L251bGwKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9hbng3NjI1LmMKQEAgLTAsMCArMSwy
MTEwIEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5CisvKgorICog
Q29weXJpZ2h0KGMpIDIwMTYsIEFuYWxvZ2l4IFNlbWljb25kdWN0b3IuIEFsbCByaWdodHMgcmVz
ZXJ2ZWQuCisgKgorICovCisjaW5jbHVkZSA8bGludXgvZXh0Y29uLmg+CisjaW5jbHVkZSA8bGlu
dXgvZ2NkLmg+CisjaW5jbHVkZSA8bGludXgvZ3Bpby9jb25zdW1lci5oPgorI2luY2x1ZGUgPGxp
bnV4L2kyYy5oPgorI2luY2x1ZGUgPGxpbnV4L2ludGVycnVwdC5oPgorI2luY2x1ZGUgPGxpbnV4
L2lvcG9sbC5oPgorI2luY2x1ZGUgPGxpbnV4L2tlcm5lbC5oPgorI2luY2x1ZGUgPGxpbnV4L21v
ZHVsZS5oPgorI2luY2x1ZGUgPGxpbnV4L211dGV4Lmg+CisjaW5jbHVkZSA8bGludXgvc2xhYi5o
PgorI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CisjaW5jbHVkZSA8bGludXgvd29ya3F1ZXVlLmg+
CisKKyNpbmNsdWRlIDxsaW51eC9vZl9ncGlvLmg+CisjaW5jbHVkZSA8bGludXgvb2ZfZ3JhcGgu
aD4KKyNpbmNsdWRlIDxsaW51eC9vZl9wbGF0Zm9ybS5oPgorCisjaW5jbHVkZSA8ZHJtL2RybV9h
dG9taWNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9icmlkZ2UuaD4KKyNpbmNsdWRlIDxk
cm0vZHJtX2NydGNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9kcF9oZWxwZXIuaD4KKyNp
bmNsdWRlIDxkcm0vZHJtX2VkaWQuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX21pcGlfZHNpLmg+Cisj
aW5jbHVkZSA8ZHJtL2RybV9wcmludC5oPgorI2luY2x1ZGUgPGRybS9kcm1fcHJvYmVfaGVscGVy
Lmg+CisKKyNpbmNsdWRlIDx2aWRlby9kaXNwbGF5X3RpbWluZy5oPgorCisjaW5jbHVkZSAiYW54
NzYyNS5oIgorCisvKgorICogdGhlcmUgaXMgYSBzeW5jIGlzc3VlIHdoaWxlIGFjY2VzcyBJMkMg
cmVnaXN0ZXIgYmV0d2VlbiBBUChDUFUpIGFuZAorICogaW50ZXJuYWwgZmlybXdhcmUoT0NNKSwg
dG8gYXZvaWQgdGhlIHJhY2UgY29uZGl0aW9uLCBBUCBzaG91bGQgYWNjZXNzCisgKiB0aGUgcmVz
ZXJ2ZWQgc2xhdmUgYWRkcmVzcyBiZWZvcmUgc2xhdmUgYWRkcmVzcyBvY2N1cnMgY2hhbmdlcy4K
KyAqLworc3RhdGljIGludCBpMmNfYWNjZXNzX3dvcmthcm91bmQoc3RydWN0IGFueDc2MjVfZGF0
YSAqY3R4LAorCQkJCSBzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50KQoreworCXU4IG9mZnNldDsK
KwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY2xpZW50LT5kZXY7CisJc3RydWN0IGkyY19jbGllbnQg
Kmxhc3RfY2xpZW50ID0gY3R4LT5sYXN0X2NsaWVudDsKKwlpbnQgcmV0ID0gMDsKKworCWlmIChj
bGllbnQgIT0gbGFzdF9jbGllbnQpIHsKKwkJY3R4LT5sYXN0X2NsaWVudCA9IGNsaWVudDsKKwor
CQlpZiAoY2xpZW50ID09IGN0eC0+aTJjLnRjcGNfY2xpZW50KQorCQkJb2Zmc2V0ID0gUlNWRF8w
MF9BRERSOworCQllbHNlIGlmIChjbGllbnQgPT0gY3R4LT5pMmMudHhfcDBfY2xpZW50KQorCQkJ
b2Zmc2V0ID0gUlNWRF9EMV9BRERSOworCQllbHNlIGlmIChjbGllbnQgPT0gY3R4LT5pMmMudHhf
cDFfY2xpZW50KQorCQkJb2Zmc2V0ID0gUlNWRF82MF9BRERSOworCQllbHNlIGlmIChjbGllbnQg
PT0gY3R4LT5pMmMucnhfcDBfY2xpZW50KQorCQkJb2Zmc2V0ID0gUlNWRF8zOV9BRERSOworCQll
bHNlIGlmIChjbGllbnQgPT0gY3R4LT5pMmMucnhfcDFfY2xpZW50KQorCQkJb2Zmc2V0ID0gUlNW
RF83Rl9BRERSOworCQllbHNlCisJCQlvZmZzZXQgPSBSU1ZEXzAwX0FERFI7CisKKwkJcmV0ID0g
aTJjX3NtYnVzX3dyaXRlX2J5dGVfZGF0YShjbGllbnQsIG9mZnNldCwgMHgwMCk7CisJCWlmIChy
ZXQgPCAwKQorCQkJRFJNX0RFVl9FUlJPUihkZXYsCisJCQkJICAgICAgImZhaWxlZCB0byBhY2Nl
c3MgaTJjIGlkPSV4XG46JXgiLAorCQkJCSAgICAgIGNsaWVudC0+YWRkciwgb2Zmc2V0KTsKKwl9
CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IGFueDc2MjVfcmVnX3JlYWQoc3RydWN0
IGFueDc2MjVfZGF0YSAqY3R4LAorCQkJICAgIHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQsIHU4
IHJlZ19hZGRyKQoreworCWludCByZXQ7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmNsaWVudC0+
ZGV2OworCisJaTJjX2FjY2Vzc193b3JrYXJvdW5kKGN0eCwgY2xpZW50KTsKKworCXJldCA9IGky
Y19zbWJ1c19yZWFkX2J5dGVfZGF0YShjbGllbnQsIHJlZ19hZGRyKTsKKwlpZiAocmV0IDwgMCkK
KwkJRFJNX0RFVl9FUlJPUihkZXYsICJyZWFkIGkyYyBmYWlsZWQgaWQ9JXg6JXhcbiIsCisJCQkg
ICAgICBjbGllbnQtPmFkZHIsIHJlZ19hZGRyKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRp
YyBpbnQgYW54NzYyNV9yZWdfYmxvY2tfcmVhZChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCisJ
CQkJICBzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50LAorCQkJCSAgdTggcmVnX2FkZHIsIHU4IGxl
biwgdTggKmJ1ZikKK3sKKwlpbnQgcmV0OworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjbGllbnQt
PmRldjsKKworCWkyY19hY2Nlc3Nfd29ya2Fyb3VuZChjdHgsIGNsaWVudCk7CisKKwlyZXQgPSBp
MmNfc21idXNfcmVhZF9pMmNfYmxvY2tfZGF0YShjbGllbnQsIHJlZ19hZGRyLCBsZW4sIGJ1Zik7
CisJaWYgKHJldCA8IDApCisJCURSTV9ERVZfRVJST1IoZGV2LCAicmVhZCBpMmMgYmxvY2sgZmFp
bGVkIGlkPSV4OiV4XG4iLAorCQkJICAgICAgY2xpZW50LT5hZGRyLCByZWdfYWRkcik7CisKKwly
ZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IGFueDc2MjVfcmVnX3dyaXRlKHN0cnVjdCBhbng3
NjI1X2RhdGEgKmN0eCwKKwkJCSAgICAgc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCwKKwkJCSAg
ICAgdTggcmVnX2FkZHIsIHU4IHJlZ192YWwpCit7CisJaW50IHJldDsKKwlzdHJ1Y3QgZGV2aWNl
ICpkZXYgPSAmY2xpZW50LT5kZXY7CisKKwlpMmNfYWNjZXNzX3dvcmthcm91bmQoY3R4LCBjbGll
bnQpOworCisJcmV0ID0gaTJjX3NtYnVzX3dyaXRlX2J5dGVfZGF0YShjbGllbnQsIHJlZ19hZGRy
LCByZWdfdmFsKTsKKworCWlmIChyZXQgPCAwKQorCQlEUk1fREVWX0VSUk9SKGRldiwgImZhaWxl
ZCB0byB3cml0ZSBpMmMgaWQ9JXhcbjoleCIsCisJCQkgICAgICBjbGllbnQtPmFkZHIsIHJlZ19h
ZGRyKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV93cml0ZV9vcihz
dHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCisJCQkgICAgc3RydWN0IGkyY19jbGllbnQgKmNsaWVu
dCwKKwkJCSAgICB1OCBvZmZzZXQsIHU4IG1hc2spCit7CisJaW50IHZhbCA9IGFueDc2MjVfcmVn
X3JlYWQoY3R4LCBjbGllbnQsIG9mZnNldCk7CisKKwlyZXR1cm4gKHZhbCA8IDApID8gdmFsIDoK
KwkJYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjbGllbnQsIG9mZnNldCwgKHZhbCB8IChtYXNrKSkp
OworfQorCitzdGF0aWMgaW50IGFueDc2MjVfd3JpdGVfYW5kKHN0cnVjdCBhbng3NjI1X2RhdGEg
KmN0eCwKKwkJCSAgICAgc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCwKKwkJCSAgICAgdTggb2Zm
c2V0LCB1OCBtYXNrKQoreworCWludCB2YWwgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY2xpZW50
LCBvZmZzZXQpOworCisJcmV0dXJuICh2YWwgPCAwKSA/IHZhbCA6CisJCWFueDc2MjVfcmVnX3dy
aXRlKGN0eCwgY2xpZW50LCBvZmZzZXQsICh2YWwgJiAobWFzaykpKTsKK30KKworc3RhdGljIGlu
dCBhbng3NjI1X3dyaXRlX2FuZF9vcihzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCisJCQkJc3Ry
dWN0IGkyY19jbGllbnQgKmNsaWVudCwKKwkJCQl1OCBvZmZzZXQsIHU4IGFuZF9tYXNrLCB1OCBv
cl9tYXNrKQoreworCWludCB2YWwgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY2xpZW50LCBvZmZz
ZXQpOworCisJcmV0dXJuICh2YWwgPCAwKSA/IHZhbCA6CisJCWFueDc2MjVfcmVnX3dyaXRlKGN0
eCwgY2xpZW50LCBvZmZzZXQsCisJCQkJICAodmFsICYgYW5kX21hc2spIHwgKG9yX21hc2spKTsK
K30KKworc3RhdGljIGludCBhbng3NjI1X2NvbmZpZ19iaXRfbWF0cml4KHN0cnVjdCBhbng3NjI1
X2RhdGEgKmN0eCkKK3sKKwlpbnQgaSwgcmV0OworCisJcmV0ID0gYW54NzYyNV9yZWdfd3JpdGUo
Y3R4LCBjdHgtPmkyYy50eF9wMl9jbGllbnQsCisJCQkJQVVESU9fQ09OVFJPTF9SRUdJU1RFUiwg
MHg4MCk7CisJZm9yIChpID0gMDsgaSA8IDEzOyBpKyspCisJCXJldCB8PSBhbng3NjI1X3JlZ193
cml0ZShjdHgsIGN0eC0+aTJjLnR4X3AyX2NsaWVudCwKKwkJCQkJIFZJREVPX0JJVF9NQVRSSVhf
MTIgKyBpLAorCQkJCQkgMHgxOCArIGkpOworCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGlu
dCBhbng3NjI1X3JlYWRfY3RybF9zdGF0dXNfcDAoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQor
eworCXJldHVybiBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LCBB
UF9BVVhfQ1RSTF9TVEFUVVMpOworfQorCitzdGF0aWMgaW50IHdhaXRfYXV4X29wX2ZpbmlzaChz
dHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJaW50IHZhbDsKKwlpbnQgcmV0OworCXN0cnVj
dCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2OworCisJcmV0ID0gcmVhZHhfcG9sbF90
aW1lb3V0KGFueDc2MjVfcmVhZF9jdHJsX3N0YXR1c19wMCwKKwkJCQkgY3R4LCB2YWwsCisJCQkJ
ICghKHZhbCAmIEFQX0FVWF9DVFJMX09QX0VOKSB8fCAodmFsIDwgMCkpLAorCQkJCSAyMDAwLAor
CQkJCSAyMDAwICogMTUwKTsKKwlpZiAocmV0KSB7CisJCURSTV9ERVZfRVJST1IoZGV2LCAiYXV4
IG9wZXJhdGlvbiBmYWlsZWQhXG4iKTsKKwkJdmFsID0gLUVJTzsKKwl9IGVsc2UgeworCQl2YWwg
PSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCSAgICAg
ICBBUF9BVVhfQ1RSTF9TVEFUVVMpOworCQlpZiAodmFsIDwgMCB8fCAodmFsICYgMHgwRikpIHsK
KwkJCURSTV9ERVZfRVJST1IoZGV2LCAiYXV4IHN0YXR1cyAlMDJ4XG4iLCB2YWwpOworCQkJdmFs
ID0gLUVJTzsKKwkJfQorCX0KKworCXJldHVybiB2YWw7Cit9CisKK3N0YXRpYyBpbnQgd3JpdGVf
ZHBjZF9hZGRyKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKKwkJCSAgIHU4IGFkZHJoLCB1OCBh
ZGRybSwgdTggYWRkcmwpCit7CisJaW50IHJldDsKKworCXJldCA9IGFueDc2MjVfcmVnX3dyaXRl
KGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCUFQX0FVWF9BRERSXzdfMCwgKHU4KWFk
ZHJsKTsKKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGll
bnQsCisJCQkJIEFQX0FVWF9BRERSXzE1XzgsICh1OClhZGRybSk7CisJcmV0IHw9IGFueDc2MjVf
cmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCSBBUF9BVVhfQUREUl8x
OV8xNiwgKHU4KWFkZHJoKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgc3BfdHhf
YXV4X2RwY2RyZWFkX2J5dGVzKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKKwkJCQkgICAgdTgg
YWRkcmgsIHU4IGFkZHJtLAorCQkJCSAgICB1OCBhZGRybCwgdTggY291bnQsCisJCQkJICAgIHU4
ICpidWYpCit7CisJdTggYzsKKwlpbnQgcmV0OworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgt
PmNsaWVudC0+ZGV2OworCisJaWYgKFdBUk5fT04oY291bnQgPiAoc2l6ZV90KU1BWF9EUENEX0JV
RkZFUl9TSVpFKSkKKwkJcmV0dXJuIC1FMkJJRzsKKworCS8qIGNvbW1hbmQgYW5kIGxlbmd0aCAq
LworCWMgPSAoKGNvdW50IC0gMSkgPDwgNCkgfCAweDA5OworCXJldCA9IGFueDc2MjVfcmVnX3dy
aXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LCBBUF9BVVhfQ09NTUFORCwgYyk7CisJLyog
YWRkcmVzcyAqLworCXJldCB8PSB3cml0ZV9kcGNkX2FkZHIoY3R4LCBhZGRyaCwgYWRkcm0sIGFk
ZHJsKTsKKwkvKiBhdXggZW4gKi8KKwlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+
aTJjLnJ4X3AwX2NsaWVudCwgQVBfQVVYX0NUUkxfU1RBVFVTLAorCQkJCUFQX0FVWF9DVFJMX09Q
X0VOKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGRldiwgImF1eCBlbmFibGUg
ZmFpbGVkLlxuIik7CisJCXJldHVybiByZXQ7CisJfQorCisJdXNsZWVwX3JhbmdlKDIwMDAsIDIx
MDApOworCisJcmV0ID0gd2FpdF9hdXhfb3BfZmluaXNoKGN0eCk7CisJaWYgKHJldCA8IDApIHsK
KwkJRFJNX0RFVl9FUlJPUihkZXYsICJhdXggcmVhZCBmYWlsZWRcbiIpOworCQlyZXR1cm4gcmV0
OworCX0KKworCXJldHVybiBhbng3NjI1X3JlZ19ibG9ja19yZWFkKGN0eCwgY3R4LT5pMmMucnhf
cDBfY2xpZW50LAorCQkJQVBfQVVYX0JVRkZfU1RBUlQsIGNvdW50LCBidWYpOworfQorCitzdGF0
aWMgaW50IGFueDc2MjVfdmlkZW9fbXV0ZV9jb250cm9sKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0
eCwKKwkJCQkgICAgICB1OCBzdGF0dXMpCit7CisJaW50IHJldDsKKworCWlmIChzdGF0dXMpIHsg
LyogbXV0ZSBvbiAqLworCQkvKiBzZXQgbXV0ZSBmbGFnICovCisJCXJldCA9IGFueDc2MjVfd3Jp
dGVfb3IoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJICAgICAgIEFQX0FWX1NUQVRV
UywgQVBfTUlQSV9NVVRFKTsKKwkJLyogY2xlYXIgbWlwaSBSWCBlbiAqLworCQlyZXQgfD0gYW54
NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJCSBBUF9BVl9T
VEFUVVMsICh1OCl+QVBfTUlQSV9SWF9FTik7CisJfSBlbHNlIHsgLyogbXV0ZSBvZmYgKi8KKwkJ
LyogY2xlYXIgbXV0ZSBmbGFnICovCisJCXJldCA9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4
LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCQlBUF9BVl9TVEFUVVMsICh1OCl+QVBfTUlQSV9NVVRF
KTsKKwkJLyogc2V0IE1JUEkgUlggRU4gKi8KKwkJcmV0IHw9IGFueDc2MjVfd3JpdGVfb3IoY3R4
LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJCUFQX0FWX1NUQVRVUywgQVBfTUlQSV9SWF9F
Tik7CisJfQorCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBhbng3NjI1X2NvbmZpZ19h
dWRpb19pbnB1dChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJaW50IHJldDsKKworCS8q
IGNoYW5uZWwgbnVtICovCisJcmV0ID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy50
eF9wMl9jbGllbnQsCisJCQkJQVVESU9fQ0hBTk5FTF9TVEFUVVNfNiwgSTJTX0NIXzIgPDwgNSk7
CisJLyogbGF5b3V0ICovCisJLyogYXMgSTJTIGNoYW5uZWwgaXMgMiwgbm8gbmVlZCB0byBzZXQg
bGF5b3V0ICovCisKKwkvKiBGUyAqLworCXJldCB8PSBhbng3NjI1X3dyaXRlX2FuZF9vcihjdHgs
IGN0eC0+aTJjLnR4X3AyX2NsaWVudCwKKwkJCQkgICAgQVVESU9fQ0hBTk5FTF9TVEFUVVNfNCwK
KwkJCQkgICAgMHhmMCwgQVVESU9fRlNfNDhLKTsKKwkvKiB3b3JkIGxlbmd0aCAqLworCXJldCB8
PSBhbng3NjI1X3dyaXRlX2FuZF9vcihjdHgsIGN0eC0+aTJjLnR4X3AyX2NsaWVudCwKKwkJCQkg
ICAgQVVESU9fQ0hBTk5FTF9TVEFUVVNfNSwKKwkJCQkgICAgMHhmMCwgQVVESU9fV19MRU5fMjRf
MjRNQVgpOworCS8qIEkyUyAqLworCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5p
MmMudHhfcDJfY2xpZW50LAorCQkJCUFVRElPX0NIQU5ORUxfU1RBVFVTXzYsIEkyU19TTEFWRV9N
T0RFKTsKKwlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy50eF9wMl9jbGll
bnQsCisJCQkJIEFVRElPX0NPTlRST0xfUkVHSVNURVIsIH5URE1fVElNSU5HX01PREUpOworCS8q
IGF1ZGlvIGNoYW5nZSBmbGFnICovCisJcmV0IHw9IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgt
PmkyYy5yeF9wMF9jbGllbnQsCisJCQkJQVBfQVZfU1RBVFVTLCBBUF9BVURJT19DSEcpOworCisJ
aWYgKHJldCA8IDApCisJCURSTV9FUlJPUigiZmFpbGVkIHRvIGNvbmZpZyBhdWRpby5cbiIpOwor
CisJcmV0dXJuIHJldDsKK30KKworLyogcmVkdWN0aW9uIG9mIGZyYWN0aW9uIGEvYiAqLworc3Rh
dGljIHZvaWQgYW54NzYyNV9yZWR1Y3Rpb25fb2ZfYV9mcmFjdGlvbih1bnNpZ25lZCBsb25nICph
LCB1bnNpZ25lZCBsb25nICpiKQoreworCXVuc2lnbmVkIGxvbmcgZ2NkX251bTsKKwl1bnNpZ25l
ZCBsb25nIHRtcF9hLCB0bXBfYjsKKwl1MzIgaSA9IDE7CisKKwlnY2RfbnVtID0gZ2NkKCphLCAq
Yik7CisJKmEgLz0gZ2NkX251bTsKKwkqYiAvPSBnY2RfbnVtOworCisJdG1wX2EgPSAqYTsKKwl0
bXBfYiA9ICpiOworCisJd2hpbGUgKCgqYSA+IE1BWF9VTlNJR05FRF8yNEJJVCkgfHwgKCpiID4g
TUFYX1VOU0lHTkVEXzI0QklUKSkgeworCQlpKys7CisJCSphID0gdG1wX2EgLyBpOworCQkqYiA9
IHRtcF9iIC8gaTsKKwl9CisKKwkvKgorCSAqIGluIHRoZSBlbmQsIG1ha2UgYSwgYiBsYXJnZXIg
dG8gaGF2ZSBoaWdoZXIgT0RGQyBQTEwKKwkgKiBvdXRwdXQgZnJlcXVlbmN5IGFjY3VyYWN5CisJ
ICovCisJd2hpbGUgKCgqYSA8IE1BWF9VTlNJR05FRF8yNEJJVCkgJiYgKCpiIDwgTUFYX1VOU0lH
TkVEXzI0QklUKSkgeworCQkqYSA8PD0gMTsKKwkJKmIgPDw9IDE7CisJfQorCisJKmEgPj49IDE7
CisJKmIgPj49IDE7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV9jYWxjdWxhdGVfbV9uKHUzMiBw
aXhlbGNsb2NrLAorCQkJCSB1bnNpZ25lZCBsb25nICptLAorCQkJCSB1bnNpZ25lZCBsb25nICpu
LAorCQkJCSB1OCAqcG9zdF9kaXZpZGVyKQoreworCWlmIChwaXhlbGNsb2NrID4gUExMX09VVF9G
UkVRX0FCU19NQVggLyBQT1NUX0RJVklERVJfTUlOKSB7CisJCS8qIHBpeGVsIGNsb2NrIGZyZXF1
ZW5jeSBpcyB0b28gaGlnaCAqLworCQlEUk1fRVJST1IoInBpeGVsY2xvY2sgdG9vIGhpZ2gsIGFj
dCglZCksIG1heGltdW0oJWx1KVxuIiwKKwkJCSAgcGl4ZWxjbG9jaywKKwkJCSAgUExMX09VVF9G
UkVRX0FCU19NQVggLyBQT1NUX0RJVklERVJfTUlOKTsKKwkJcmV0dXJuIDE7CisJfQorCisJaWYg
KHBpeGVsY2xvY2sgPCBQTExfT1VUX0ZSRVFfQUJTX01JTiAvIFBPU1RfRElWSURFUl9NQVgpIHsK
KwkJLyogcGl4ZWwgY2xvY2sgZnJlcXVlbmN5IGlzIHRvbyBsb3cgKi8KKwkJRFJNX0VSUk9SKCJw
aXhlbGNsb2NrIHRvbyBsb3csIGFjdCglZCksIG1heGltdW0oJWx1KVxuIiwKKwkJCSAgcGl4ZWxj
bG9jaywKKwkJCSAgUExMX09VVF9GUkVRX0FCU19NSU4gLyBQT1NUX0RJVklERVJfTUFYKTsKKwkJ
cmV0dXJuIDE7CisJfQorCisJKnBvc3RfZGl2aWRlciA9IDE7CisKKwlmb3IgKCpwb3N0X2Rpdmlk
ZXIgPSAxOworCQlwaXhlbGNsb2NrIDwgKFBMTF9PVVRfRlJFUV9NSU4gLyAoKnBvc3RfZGl2aWRl
cikpOykKKwkJKnBvc3RfZGl2aWRlciArPSAxOworCisJaWYgKCpwb3N0X2RpdmlkZXIgPiBQT1NU
X0RJVklERVJfTUFYKSB7CisJCWZvciAoKnBvc3RfZGl2aWRlciA9IDE7CisJCQkocGl4ZWxjbG9j
ayA8CisJCQkgKFBMTF9PVVRfRlJFUV9BQlNfTUlOIC8gKCpwb3N0X2RpdmlkZXIpKSk7KQorCQkJ
KnBvc3RfZGl2aWRlciArPSAxOworCisJCWlmICgqcG9zdF9kaXZpZGVyID4gUE9TVF9ESVZJREVS
X01BWCkgeworCQkJRFJNX0VSUk9SKCJjYW5ub3QgZmluZCBwcm9wZXJ0eSBwb3N0X2RpdmlkZXIo
JWQpXG4iLAorCQkJCSAgKnBvc3RfZGl2aWRlcik7CisJCQlyZXR1cm4gMTsKKwkJfQorCX0KKwor
CS8qIHBhdGNoIHRvIGltcHJvdmUgdGhlIGFjY3VyYWN5ICovCisJaWYgKCpwb3N0X2RpdmlkZXIg
PT0gNykgeworCQkvKiAyNywwMDAsMDAwIGlzIG5vdCBkaXZpc2libGUgYnkgNyAqLworCQkqcG9z
dF9kaXZpZGVyID0gODsKKwl9IGVsc2UgaWYgKCpwb3N0X2RpdmlkZXIgPT0gMTEpIHsKKwkJLyog
MjcsMDAwLDAwMCBpcyBub3QgZGl2aXNpYmxlIGJ5IDExICovCisJCSpwb3N0X2RpdmlkZXIgPSAx
MjsKKwl9IGVsc2UgaWYgKCgqcG9zdF9kaXZpZGVyID09IDEzKSB8fCAoKnBvc3RfZGl2aWRlciA9
PSAxNCkpIHsKKwkJLyoyNywwMDAsMDAwIGlzIG5vdCBkaXZpc2libGUgYnkgMTMgb3IgMTQqLwor
CQkqcG9zdF9kaXZpZGVyID0gMTU7CisJfQorCisJaWYgKHBpeGVsY2xvY2sgKiAoKnBvc3RfZGl2
aWRlcikgPiBQTExfT1VUX0ZSRVFfQUJTX01BWCkgeworCQlEUk1fRVJST1IoImFjdCBjbG9jaygl
dSkgbGFyZ2UgdGhhbiBtYXhpbXVtKCVsdSlcbiIsCisJCQkgIHBpeGVsY2xvY2sgKiAoKnBvc3Rf
ZGl2aWRlciksCisJCQkgIFBMTF9PVVRfRlJFUV9BQlNfTUFYKTsKKwkJcmV0dXJuIDE7CisJfQor
CisJKm0gPSBwaXhlbGNsb2NrOworCSpuID0gWFRBTF9GUlEgLyAoKnBvc3RfZGl2aWRlcik7CisK
Kwlhbng3NjI1X3JlZHVjdGlvbl9vZl9hX2ZyYWN0aW9uKG0sIG4pOworCisJcmV0dXJuIDA7Cit9
CisKK3N0YXRpYyBpbnQgYW54NzYyNV9vZGZjX2NvbmZpZyhzdHJ1Y3QgYW54NzYyNV9kYXRhICpj
dHgsCisJCQkgICAgICAgdTggcG9zdF9kaXZpZGVyKQoreworCWludCByZXQ7CisKKwkvKiBjb25m
aWcgaW5wdXQgcmVmZXJlbmNlIGNsb2NrIGZyZXF1ZW5jeSAyN01Iei8xOS4yTUh6ICovCisJcmV0
ID0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIE1JUElfRElH
SVRBTF9QTExfMTYsCisJCQkJfihSRUZfQ0xLXzI3MDAwS0haIDw8IE1JUElfRlJFRl9EX0lORCkp
OworCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCBN
SVBJX0RJR0lUQUxfUExMXzE2LAorCQkJCShSRUZfQ0xLXzI3MDAwS0haIDw8IE1JUElfRlJFRl9E
X0lORCkpOworCS8qIHBvc3QgZGl2aWRlciAqLworCXJldCB8PSBhbng3NjI1X3dyaXRlX2FuZChj
dHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKKwkJCQkgTUlQSV9ESUdJVEFMX1BMTF84LCAweDBm
KTsKKwlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwg
TUlQSV9ESUdJVEFMX1BMTF84LAorCQkJCXBvc3RfZGl2aWRlciA8PCA0KTsKKworCS8qIGFkZCBw
YXRjaCBmb3IgTUlTMi0xMjUgKDVwY3MgQU5YNzYyNSBmYWlsIEFURSBNQklTVCB0ZXN0KSAqLwor
CXJldCB8PSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQ
SV9ESUdJVEFMX1BMTF83LAorCQkJCSB+TUlQSV9QTExfVkNPX1RVTkVfUkVHX1ZBTCk7CisKKwkv
KiByZXNldCBPREZDIFBMTCAqLworCXJldCB8PSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+
aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9ESUdJVEFMX1BMTF83LAorCQkJCSB+TUlQSV9QTExfUkVT
RVRfTik7CisJcmV0IHw9IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGll
bnQsIE1JUElfRElHSVRBTF9QTExfNywKKwkJCQlNSVBJX1BMTF9SRVNFVF9OKTsKKworCWlmIChy
ZXQgPCAwKQorCQlEUk1fRVJST1IoIklPIGVycm9yLlxuIik7CisKKwlyZXR1cm4gcmV0OworfQor
CitzdGF0aWMgaW50IGFueDc2MjVfZHNpX3ZpZGVvX3RpbWluZ19jb25maWcoc3RydWN0IGFueDc2
MjVfZGF0YSAqY3R4KQoreworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2
OworCXVuc2lnbmVkIGxvbmcgbSwgbjsKKwl1MTYgaHRvdGFsOworCWludCByZXQ7CisJdTggcG9z
dF9kaXZpZGVyID0gMDsKKworCXJldCA9IGFueDc2MjVfY2FsY3VsYXRlX21fbihjdHgtPmR0LnBp
eGVsY2xvY2subWluICogMTAwMCwKKwkJCQkgICAgJm0sICZuLCAmcG9zdF9kaXZpZGVyKTsKKwor
CWlmIChyZXQgIT0gMCkgeworCQlEUk1fRVJST1IoImNhbm5vdCBnZXQgcHJvcGVydHkgbSBuIHZh
bHVlLlxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCURSTV9ERVZfREVCVUdfRFJJVkVS
KGRldiwgImNvbXB1dGUgTSglbHUpLCBOKCVsdSksIGRpdmlkZXIoJWQpLlxuIiwKKwkJCSAgICAg
bSwgbiwgcG9zdF9kaXZpZGVyKTsKKworCS8qIGNvbmZpZ3VyZSBwaXhlbCBjbG9jayAqLworCXJl
dCA9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LCBQSVhFTF9D
TE9DS19MLAorCQkJCShjdHgtPmR0LnBpeGVsY2xvY2subWluIC8gMTAwMCkgJiAweEZGKTsKKwly
ZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsIFBJWEVM
X0NMT0NLX0gsCisJCQkJIChjdHgtPmR0LnBpeGVsY2xvY2subWluIC8gMTAwMCkgPj4gOCk7CisJ
LyogbGFuZSBjb3VudCAqLworCXJldCB8PSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+aTJj
LnJ4X3AxX2NsaWVudCwKKwkJCU1JUElfTEFORV9DVFJMXzAsIDB4ZmMpOworCWlmIChjdHgtPnBk
YXRhLmRzaV9sYW5lcykKKwkJcmV0IHw9IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy5y
eF9wMV9jbGllbnQsCisJCQkJCU1JUElfTEFORV9DVFJMXzAsCisJCQkJCShjdHgtPnBkYXRhLmRz
aV9sYW5lcyAtIDEpKTsKKwllbHNlCisJCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4
LT5pMmMucnhfcDFfY2xpZW50LAorCQkJCQlNSVBJX0xBTkVfQ1RSTF8wLCAzKTsKKworCS8qIEh0
b3RhbCAqLworCWh0b3RhbCA9IGN0eC0+ZHQuaGFjdGl2ZS5taW4gKyBjdHgtPmR0Lmhmcm9udF9w
b3JjaC5taW4gKworCQljdHgtPmR0LmhiYWNrX3BvcmNoLm1pbiArIGN0eC0+ZHQuaHN5bmNfbGVu
Lm1pbjsKKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMl9jbGll
bnQsCisJCQlIT1JJWk9OVEFMX1RPVEFMX1BJWEVMU19MLCBodG90YWwgJiAweEZGKTsKKwlyZXQg
fD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQsCisJCQlIT1JJ
Wk9OVEFMX1RPVEFMX1BJWEVMU19ILCBodG90YWwgPj4gOCk7CisJLyogSGFjdGl2ZSAqLworCXJl
dCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwKKwkJCUhP
UklaT05UQUxfQUNUSVZFX1BJWEVMU19MLCBjdHgtPmR0LmhhY3RpdmUubWluICYgMHhGRik7CisJ
cmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAorCQkJ
SE9SSVpPTlRBTF9BQ1RJVkVfUElYRUxTX0gsIGN0eC0+ZHQuaGFjdGl2ZS5taW4gPj4gOCk7CisJ
LyogSEZQICovCisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDJf
Y2xpZW50LAorCQkJSE9SSVpPTlRBTF9GUk9OVF9QT1JDSF9MLCBjdHgtPmR0Lmhmcm9udF9wb3Jj
aC5taW4pOworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2Ns
aWVudCwKKwkJCUhPUklaT05UQUxfRlJPTlRfUE9SQ0hfSCwKKwkJCWN0eC0+ZHQuaGZyb250X3Bv
cmNoLm1pbiA+PiA4KTsKKwkvKiBIV1MgKi8KKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4
LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQsCisJCQlIT1JJWk9OVEFMX1NZTkNfV0lEVEhfTCwgY3R4
LT5kdC5oc3luY19sZW4ubWluKTsKKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgt
PmkyYy5yeF9wMl9jbGllbnQsCisJCQlIT1JJWk9OVEFMX1NZTkNfV0lEVEhfSCwgY3R4LT5kdC5o
c3luY19sZW4ubWluID4+IDgpOworCS8qIEhCUCAqLworCXJldCB8PSBhbng3NjI1X3JlZ193cml0
ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwKKwkJCUhPUklaT05UQUxfQkFDS19QT1JDSF9M
LCBjdHgtPmR0LmhiYWNrX3BvcmNoLm1pbik7CisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0
eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAorCQkJSE9SSVpPTlRBTF9CQUNLX1BPUkNIX0gsIGN0
eC0+ZHQuaGJhY2tfcG9yY2gubWluID4+IDgpOworCS8qIFZhY3RpdmUgKi8KKwlyZXQgfD0gYW54
NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQsIEFDVElWRV9MSU5FU19M
LAorCQkJY3R4LT5kdC52YWN0aXZlLm1pbik7CisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0
eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LCBBQ1RJVkVfTElORVNfSCwKKwkJCWN0eC0+ZHQudmFj
dGl2ZS5taW4gPj4gOCk7CisJLyogVkZQICovCisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0
eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAorCQkJVkVSVElDQUxfRlJPTlRfUE9SQ0gsIGN0eC0+
ZHQudmZyb250X3BvcmNoLm1pbik7CisJLyogVldTICovCisJcmV0IHw9IGFueDc2MjVfcmVnX3dy
aXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAorCQkJVkVSVElDQUxfU1lOQ19XSURUSCwg
Y3R4LT5kdC52c3luY19sZW4ubWluKTsKKwkvKiBWQlAgKi8KKwlyZXQgfD0gYW54NzYyNV9yZWdf
d3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQsCisJCQlWRVJUSUNBTF9CQUNLX1BPUkNI
LCBjdHgtPmR0LnZiYWNrX3BvcmNoLm1pbik7CisJLyogTSB2YWx1ZSAqLworCXJldCB8PSBhbng3
NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKKwkJCU1JUElfUExMX01f
TlVNXzIzXzE2LCAobSA+PiAxNikgJiAweGZmKTsKKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUo
Y3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCisJCQlNSVBJX1BMTF9NX05VTV8xNV84LCAobSA+
PiA4KSAmIDB4ZmYpOworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4
X3AxX2NsaWVudCwKKwkJCU1JUElfUExMX01fTlVNXzdfMCwgKG0gJiAweGZmKSk7CisJLyogTiB2
YWx1ZSAqLworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2Ns
aWVudCwKKwkJCU1JUElfUExMX05fTlVNXzIzXzE2LCAobiA+PiAxNikgJiAweGZmKTsKKwlyZXQg
fD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCisJCQlNSVBJ
X1BMTF9OX05VTV8xNV84LCAobiA+PiA4KSAmIDB4ZmYpOworCXJldCB8PSBhbng3NjI1X3JlZ193
cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9QTExfTl9OVU1fN18wLAorCQkJ
KG4gJiAweGZmKSk7CisJLyogZGlmZiAqLworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgs
IGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKKwkJCU1JUElfRElHSVRBTF9BREpfMSwgMHgzNyk7CisK
KwlyZXQgfD0gYW54NzYyNV9vZGZjX2NvbmZpZyhjdHgsIHBvc3RfZGl2aWRlciAtIDEpOworCisJ
aWYgKHJldCA8IDApCisJCURSTV9FUlJPUigibWlwaSBkc2kgc2V0dXAgSU8gZXJyb3IuXG4iKTsK
KworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV9zd2FwX2RzaV9sYW5lMyhz
dHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJaW50IHZhbDsKKworCS8qIHN3YXAgTUlQSS1E
U0kgZGF0YSBsYW5lIDMgUCBhbmQgTiAqLworCXZhbCA9IGFueDc2MjVfcmVnX3JlYWQoY3R4LCBj
dHgtPmkyYy5yeF9wMV9jbGllbnQsIE1JUElfU1dBUCk7CisJaWYgKHZhbCA8IDApIHsKKwkJRFJN
X0VSUk9SKCJJTyBlcnJvciA6IGFjY2VzcyBNSVBJX1NXQVAuXG4iKTsKKwkJcmV0dXJuIC1FSU87
CisJfQorCisJdmFsIHw9ICgxIDw8IE1JUElfU1dBUF9DSDMpOworCXJldHVybiBhbng3NjI1X3Jl
Z193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9TV0FQLCB2YWwpOworfQor
CitzdGF0aWMgaW50IGFueDc2MjVfYXBpX2RzaV9jb25maWcoc3RydWN0IGFueDc2MjVfZGF0YSAq
Y3R4KQorCit7CisJaW50IHZhbCwgcmV0OworCisJLyogc3dhcCBNSVBJLURTSSBkYXRhIGxhbmUg
MyBQIGFuZCBOICovCisJcmV0ID0gYW54NzYyNV9zd2FwX2RzaV9sYW5lMyhjdHgpOworCWlmIChy
ZXQgPCAwKSB7CisJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBzd2FwIGRzaSBsYW5lIDMgZmFpbGVk
LlxuIik7CisJCXJldHVybiByZXQ7CisJfQorCisJLyogRFNJIGNsb2NrIHNldHRpbmdzICovCisJ
dmFsID0gKDAgPDwgTUlQSV9IU19QV0RfQ0xLKQkJfAorCQkoMCA8PCBNSVBJX0hTX1JUX0NMSykJ
CXwKKwkJKDAgPDwgTUlQSV9QRF9DTEspCQl8CisJCSgxIDw8IE1JUElfQ0xLX1JUX01BTlVBTF9Q
RF9FTikJfAorCQkoMSA8PCBNSVBJX0NMS19IU19NQU5VQUxfUERfRU4pCXwKKwkJKDAgPDwgTUlQ
SV9DTEtfREVUX0RFVF9CWVBBU1MpCXwKKwkJKDAgPDwgTUlQSV9DTEtfTUlTU19DVFJMKQl8CisJ
CSgwIDw8IE1JUElfUERfTFBUWF9DSF9NQU5VQUxfUERfRU4pOworCXJldCA9IGFueDc2MjVfcmVn
X3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAorCQkJCU1JUElfUEhZX0NPTlRST0xf
MywgdmFsKTsKKworCS8qCisJICogRGVjcmVhc2VkIEhTIHByZXBhcmUgdGltaW5nIGRlbGF5IGZy
b20gMTYwbnMgdG8gODBucyB3b3JrIHdpdGgKKwkgKiAgICAgYSkgRHJhZ29uIGJvYXJkIDgxMCBz
ZXJpZXMgKFF1YWxjb21tIEFQKQorCSAqICAgICBiKSBNb3ZpbmcgUGl4ZWwgRFNJIHNvdXJjZSAo
UEczQSBwYXR0ZXJuIGdlbmVyYXRvciArCisJICoJUDMzMiBELVBIWSBQcm9iZSkgZGVmYXVsdCBE
LVBIWSB0aW1pbmcKKwkgKgk1bnMvc3RlcAorCSAqLworCXJldCB8PSBhbng3NjI1X3JlZ193cml0
ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKKwkJCQkgTUlQSV9USU1FX0hTX1BSUFIsIDB4
MTApOworCisJLyogZW5hYmxlIERTSSBtb2RlKi8KKwlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihj
dHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9ESUdJVEFMX1BMTF8xOCwKKwkJCQlTRUxF
Q1RfRFNJIDw8IE1JUElfRFBJX1NFTEVDVCk7CisKKwlyZXQgfD0gYW54NzYyNV9kc2lfdmlkZW9f
dGltaW5nX2NvbmZpZyhjdHgpOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9FUlJPUigiZHNpIHZp
ZGVvIHRpbWluZyBjb25maWcgZmFpbGVkXG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwkvKiB0
b2dnbGUgbSwgbiByZWFkeSAqLworCXJldCA9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5p
MmMucnhfcDFfY2xpZW50LCBNSVBJX0RJR0lUQUxfUExMXzYsCisJCQkJfihNSVBJX01fTlVNX1JF
QURZIHwgTUlQSV9OX05VTV9SRUFEWSkpOworCXVzbGVlcF9yYW5nZSgxMDAwLCAxMTAwKTsKKwly
ZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9E
SUdJVEFMX1BMTF82LAorCQkJCU1JUElfTV9OVU1fUkVBRFkgfCBNSVBJX05fTlVNX1JFQURZKTsK
KworCS8qIGNvbmZpZ3VyZSBpbnRlZ2VyIHN0YWJsZSByZWdpc3RlciAqLworCXJldCB8PSBhbng3
NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKKwkJCQkgTUlQSV9WSURF
T19TVEFCTEVfQ05ULCAweDAyKTsKKwkvKiBwb3dlciBvbiBNSVBJIFJYICovCisJcmV0IHw9IGFu
eDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAorCQkJCSBNSVBJX0xB
TkVfQ1RSTF8xMCwgMHgwMCk7CisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5p
MmMucnhfcDFfY2xpZW50LAorCQkJCSBNSVBJX0xBTkVfQ1RSTF8xMCwgMHg4MCk7CisKKwlpZiAo
cmV0IDwgMCkKKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IG1pcGkgZHNpIGVuYWJsZSBpbml0IGZh
aWxlZC5cbiIpOworCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBhbng3NjI1X2RzaV9j
b25maWcoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCXN0cnVjdCBkZXZpY2UgKmRldiA9
ICZjdHgtPmNsaWVudC0+ZGV2OworCWludCByZXQ7CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihk
ZXYsICJjb25maWcgZHNpLlxuIik7CisKKwkvKiBEU0MgZGlzYWJsZSAqLworCXJldCA9IGFueDc2
MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCVJfRFNDX0NUUkxf
MCwgfkRTQ19FTik7CisKKwlyZXQgfD0gYW54NzYyNV9hcGlfZHNpX2NvbmZpZyhjdHgpOworCisJ
aWYgKHJldCA8IDApIHsKKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGFwaSBkc2kgY29uZmlnIGVy
cm9yLlxuIik7CisJfSBlbHNlIHsKKwkJLyogc2V0IE1JUEkgUlggRU4gKi8KKwkJcmV0ID0gYW54
NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkgICAgICAgQVBf
QVZfU1RBVFVTLCBBUF9NSVBJX1JYX0VOKTsKKwkJLyogY2xlYXIgbXV0ZSBmbGFnICovCisJCXJl
dCB8PSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkJ
IEFQX0FWX1NUQVRVUywgKHU4KX5BUF9NSVBJX01VVEUpOworCQlpZiAocmV0IDwgMCkKKwkJCURS
TV9FUlJPUigiSU8gZXJyb3IgOiBlbmFibGUgbWlwaSByeCBmYWlsZWQuXG4iKTsKKwkJZWxzZQor
CQkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAic3VjY2VzcyB0byBjb25maWcgRFNJXG4iKTsK
Kwl9CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IGFueDc2MjVfYXBpX2RwaV9jb25m
aWcoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCXUxNiBmcmVxID0gY3R4LT5kdC5waXhl
bGNsb2NrLm1pbiAvIDEwMDA7CisJaW50IHJldDsKKworCS8qIGNvbmZpZ3VyZSBwaXhlbCBjbG9j
ayAqLworCXJldCA9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50
LAorCQkJCVBJWEVMX0NMT0NLX0wsIGZyZXEgJiAweEZGKTsKKwlyZXQgfD0gYW54NzYyNV9yZWdf
d3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJIFBJWEVMX0NMT0NLX0gsIChm
cmVxID4+IDgpKTsKKworCS8qIHNldCBEUEkgbW9kZSAqLworCS8qIHNldCB0byBEUEkgUExMIG1v
ZHVsZSBzZWwgKi8KKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9w
MV9jbGllbnQsCisJCQkJIE1JUElfRElHSVRBTF9QTExfOSwgMHgyMCk7CisJLyogcG93ZXIgZG93
biBNSVBJICovCisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDFf
Y2xpZW50LAorCQkJCSBNSVBJX0xBTkVfQ1RSTF8xMCwgMHgwOCk7CisJLyogZW5hYmxlIERQSSBt
b2RlICovCisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xp
ZW50LAorCQkJCSBNSVBJX0RJR0lUQUxfUExMXzE4LCAweDFDKTsKKwkvKiBzZXQgZmlyc3QgZWRn
ZSAqLworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnR4X3AyX2NsaWVu
dCwKKwkJCQkgVklERU9fQ09OVFJPTF8wLCAweDA1KTsKKwlpZiAocmV0IDwgMCkKKwkJRFJNX0VS
Uk9SKCJJTyBlcnJvciA6IGRwaSBwaHkgc2V0IGZhaWxlZC5cbiIpOworCisJcmV0dXJuIHJldDsK
K30KKworc3RhdGljIGludCBhbng3NjI1X2RwaV9jb25maWcoc3RydWN0IGFueDc2MjVfZGF0YSAq
Y3R4KQoreworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2OworCWludCBy
ZXQ7CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJjb25maWcgZHBpXG4iKTsKKworCS8q
IERTQyBkaXNhYmxlICovCisJcmV0ID0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy5y
eF9wMF9jbGllbnQsCisJCQkJUl9EU0NfQ1RSTF8wLCB+RFNDX0VOKTsKKwlpZiAocmV0IDwgMCkg
eworCQlEUk1fRVJST1IoIklPIGVycm9yIDogZGlzYWJsZSBkc2MgZmFpbGVkLlxuIik7CisJCXJl
dHVybiByZXQ7CisJfQorCisJcmV0ID0gYW54NzYyNV9jb25maWdfYml0X21hdHJpeChjdHgpOwor
CWlmIChyZXQgPCAwKSB7CisJCURSTV9FUlJPUigiY29uZmlnIGJpdCBtYXRyaXggZmFpbGVkLlxu
Iik7CisJCXJldHVybiByZXQ7CisJfQorCisJcmV0ID0gYW54NzYyNV9hcGlfZHBpX2NvbmZpZyhj
dHgpOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9FUlJPUigibWlwaSBwaHkoZHBpKSBzZXR1cCBm
YWlsZWQuXG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwkvKiBzZXQgTUlQSSBSWCBFTiAqLwor
CXJldCA9IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkg
ICAgICAgQVBfQVZfU1RBVFVTLCBBUF9NSVBJX1JYX0VOKTsKKwkvKiBjbGVhciBtdXRlIGZsYWcg
Ki8KKwlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQs
CisJCQkJIEFQX0FWX1NUQVRVUywgKHU4KX5BUF9NSVBJX01VVEUpOworCWlmIChyZXQgPCAwKQor
CQlEUk1fRVJST1IoIklPIGVycm9yIDogZW5hYmxlIG1pcGkgcnggZmFpbGVkLlxuIik7CisKKwly
ZXR1cm4gcmV0OworfQorCitjb25zdCB1OCBBTlhfT1VJWzNdID0geyAweDAwLCAweDIyLCAweEI5
IH07CitzdGF0aWMgaW50IGlzX2FueF9kb25nbGUoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQor
eworCXU4IGJ1ZlszXTsKKworCS8qIDB4MDUwMH4weDA1MDI6IEJSQU5DSF9JRUVFX09VSSAqLwor
CXNwX3R4X2F1eF9kcGNkcmVhZF9ieXRlcyhjdHgsIDB4MDAsIDB4MDUsIDB4MDAsIHNpemVvZihi
dWYpLCBidWYpOworCWlmIChtZW1jbXAoYnVmLCBBTlhfT1VJLCBzaXplb2YoYnVmKSkgPT0gMCkK
KwkJcmV0dXJuIDE7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgc3BfdHhfZ2V0X3J4
X2J3KHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwgdTggKmJ3KQoreworCXU4IGRhdGFfYnVmWzRd
OworCS8qCisJICogV2hlbiBBTlggZG9uZ2xlIGNvbm5lY3RlZCwgaWYgQ0hJUF9JRCA9IDB4Nzc1
MCwgYmFuZHdpZHRoIGlzIDYuNzVHLAorCSAqIGJlY2F1c2UgQU5YNzc1MCBEUENEIDB4MDUyeCB3
YXMgbm90IGF2YWlsYWJsZS4KKwkgKi8KKwlpZiAoaXNfYW54X2RvbmdsZShjdHgpKSB7CisJCXNw
X3R4X2F1eF9kcGNkcmVhZF9ieXRlcyhjdHgsIDB4MDAsIDB4MDUsIDB4MDMsIDB4MDQsIGRhdGFf
YnVmKTsKKwkJaWYgKGRhdGFfYnVmWzBdID09IDB4MzcgJiYgZGF0YV9idWZbMV0gPT0gMHgzNyAm
JgorCQkgICAgZGF0YV9idWZbMl0gPT0gMHgzNSAmJiBkYXRhX2J1ZlszXSA9PSAweDMwKSB7CisJ
CQkvKiAweDE5IDogNi43NUcgKi8KKwkJCSpidyA9IDB4MTk7CisJCX0gZWxzZSB7CisJCQlzcF90
eF9hdXhfZHBjZHJlYWRfYnl0ZXMoY3R4LCAweDAwLCAweDA1LCAweDIxLCAxLCBidyk7CisJCQkv
KgorCQkJICogc29tZSBBTlggZG9uZ2xlIHJlYWQgb3V0IHZhbHVlIDAsCisJCQkgKiByZXRyeSBz
dGFuZGFyZCByZWdpc3Rlci4KKwkJCSAqLworCQkJaWYgKCgoKmJ3KSA9PSAwKSB8fCAoKCpidykg
PT0gMHhmZikpCisJCQkJc3BfdHhfYXV4X2RwY2RyZWFkX2J5dGVzKGN0eCwgMHgwMCwgMHgwMCwK
KwkJCQkJCQkgRFBDRF9NQVhfTElOS19SQVRFLAorCQkJCQkJCSAxLCBidyk7CisJCX0KKwl9IGVs
c2UgeworCQlzcF90eF9hdXhfZHBjZHJlYWRfYnl0ZXMoY3R4LCAweDAwLCAweDAwLAorCQkJCQkg
RFBDRF9NQVhfTElOS19SQVRFLCAxLCBidyk7CisJfQorfQorCitzdGF0aWMgdm9pZCBhbng3NjI1
X2RwX3N0YXJ0KHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sKKwlpbnQgcmV0OworCisJaWYg
KCFjdHgtPmRpc3BsYXlfdGltaW5nX3ZhbGlkKSB7CisJCURSTV9FUlJPUigibWlwaSBkcm0gaGF2
ZW4ndCBzZXQgZGlzcGxheSB0aW1pbmcgeWV0LlxuIik7CisJCXJldHVybjsKKwl9CisKKwlyZXQg
PSBhbng3NjI1X2NvbmZpZ19hdWRpb19pbnB1dChjdHgpOworCWlmIChyZXQgPCAwKQorCQlEUk1f
RVJST1IoImNvbmZpZyBhdWRpbyBpbnB1dCBmYWlsZWQuXG4iKTsKKworCWlmIChjdHgtPnBkYXRh
LmRzaV9zdXBwb3J0ZWQpCisJCXJldCA9IGFueDc2MjVfZHNpX2NvbmZpZyhjdHgpOworCWVsc2UK
KwkJcmV0ID0gYW54NzYyNV9kcGlfY29uZmlnKGN0eCk7CisKKwlpZiAocmV0IDwgMCkKKwkJRFJN
X0VSUk9SKCJNSVBJIHBoeSBzZXR1cCBlcnJvci5cbiIpOworfQorCitzdGF0aWMgdm9pZCBhbng3
NjI1X2RwX3N0b3Aoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCXN0cnVjdCBkZXZpY2Ug
KmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2OworCWludCByZXQ7CisKKwlEUk1fREVWX0RFQlVHX0RS
SVZFUihkZXYsICJzdG9wIGRwIG91dHB1dFxuIik7CisKKwkvKgorCSAqIHZpZGVvIGRpc2FibGU6
IDB4NzI6MDggYml0IDcgPSAwOworCSAqIGF1ZGlvIGRpc2FibGU6IDB4NzA6ODcgYml0IDAgPSAw
OworCSAqLworCXJldCA9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMudHhfcDBfY2xp
ZW50LCAweDg3LCAweGZlKTsKKwlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmky
Yy50eF9wMl9jbGllbnQsIDB4MDgsIDB4N2YpOworCisJcmV0IHw9IGFueDc2MjVfdmlkZW9fbXV0
ZV9jb250cm9sKGN0eCwgMSk7CisJaWYgKHJldCA8IDApCisJCURSTV9FUlJPUigiSU8gZXJyb3Ig
OiBtdXRlIHZpZGVvIGZhaWxlZFxuIik7Cit9CisKK3N0YXRpYyBpbnQgc3BfdHhfcnN0X2F1eChz
dHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJaW50IHJldDsKKworCXJldCA9IGFueDc2MjVf
d3JpdGVfb3IoY3R4LCBjdHgtPmkyYy50eF9wMl9jbGllbnQsIFJTVF9DVFJMMiwKKwkJCSAgICAg
ICBBVVhfUlNUKTsKKwlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy50eF9w
Ml9jbGllbnQsIFJTVF9DVFJMMiwKKwkJCQkgfkFVWF9SU1QpOworCXJldHVybiByZXQ7Cit9CisK
K3N0YXRpYyBpbnQgc3BfdHhfYXV4X3dyKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwgdTggb2Zm
c2V0KQoreworCWludCByZXQ7CisKKwlyZXQgPSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+
aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQlBUF9BVVhfQlVGRl9TVEFSVCwgb2Zmc2V0KTsKKwlyZXQg
fD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJIEFQ
X0FVWF9DT01NQU5ELCAweDA0KTsKKwlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+
aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQlBUF9BVVhfQ1RSTF9TVEFUVVMsIEFQX0FVWF9DVFJMX09Q
X0VOKTsKKwlyZXR1cm4gKHJldCB8IHdhaXRfYXV4X29wX2ZpbmlzaChjdHgpKTsKK30KKworc3Rh
dGljIGludCBzcF90eF9hdXhfcmQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LCB1OCBsZW5fY21k
KQoreworCWludCByZXQ7CisKKwlyZXQgPSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJj
LnJ4X3AwX2NsaWVudCwKKwkJCQlBUF9BVVhfQ09NTUFORCwgbGVuX2NtZCk7CisJcmV0IHw9IGFu
eDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJQVBfQVVYX0NU
UkxfU1RBVFVTLCBBUF9BVVhfQ1RSTF9PUF9FTik7CisJcmV0dXJuIChyZXQgfCB3YWl0X2F1eF9v
cF9maW5pc2goY3R4KSk7Cit9CisKK3N0YXRpYyBpbnQgc3BfdHhfZ2V0X2VkaWRfYmxvY2soc3Ry
dWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCWludCBjID0gMDsKKwlzdHJ1Y3QgZGV2aWNlICpk
ZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKworCXNwX3R4X2F1eF93cihjdHgsIDB4N2UpOworCXNw
X3R4X2F1eF9yZChjdHgsIDB4MDEpOworCWMgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY3R4LT5p
MmMucnhfcDBfY2xpZW50LCBBUF9BVVhfQlVGRl9TVEFSVCk7CisJaWYgKGMgPCAwKSB7CisJCURS
TV9FUlJPUigiSU8gZXJyb3IgOiBhY2Nlc3MgQVVYIEJVRkYuXG4iKTsKKwkJcmV0dXJuIC1FSU87
CisJfQorCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiIEVESUQgQmxvY2sgPSAlZFxuIiwg
YyArIDEpOworCisJaWYgKGMgPiAzKQorCQljID0gMTsKKworCXJldHVybiBjOworfQorCitzdGF0
aWMgaW50IGVkaWRfcmVhZChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCisJCSAgICAgdTggb2Zm
c2V0LCB1OCAqcGJsb2NrX2J1ZikKK3sKKwl1OCBjLCBjbnQgPSAwOworCXN0cnVjdCBkZXZpY2Ug
KmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2OworCisJYyA9IDA7CisJZm9yIChjbnQgPSAwOyBjbnQg
PCAzOyBjbnQrKykgeworCQlzcF90eF9hdXhfd3IoY3R4LCBvZmZzZXQpOworCQkvKiBzZXQgSTJD
IHJlYWQgY29tIDB4MDEgbW90ID0gMCBhbmQgcmVhZCAxNiBieXRlcyAqLworCQljID0gc3BfdHhf
YXV4X3JkKGN0eCwgMHhmMSk7CisKKwkJaWYgKGMgPT0gMSkgeworCQkJc3BfdHhfcnN0X2F1eChj
dHgpOworCQkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZWRpZCByZWFkIGZhaWxlZCwgcmVz
ZXQhXG4iKTsKKwkJCWNudCsrOworCQl9IGVsc2UgeworCQkJYW54NzYyNV9yZWdfYmxvY2tfcmVh
ZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkJICAgICAgIEFQX0FVWF9CVUZGX1NU
QVJULAorCQkJCQkgICAgICAgTUFYX0RQQ0RfQlVGRkVSX1NJWkUsCisJCQkJCSAgICAgICBwYmxv
Y2tfYnVmKTsKKwkJCXJldHVybiAwOworCQl9CisJfQorCisJcmV0dXJuIDE7Cit9CisKK3N0YXRp
YyBpbnQgc2VnbWVudHNfZWRpZF9yZWFkKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKKwkJCSAg
ICAgIHU4IHNlZ21lbnQsIHU4ICpidWYsIHU4IG9mZnNldCkKK3sKKwl1OCBjLCBjbnQgPSAwOwor
CWludCByZXQ7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisKKwkv
KiB3cml0ZSBhZGRyZXNzIG9ubHkgKi8KKwlyZXQgPSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0
eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQlBUF9BVVhfQUREUl83XzAsIDB4MzApOworCXJldCB8
PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkgQVBf
QVVYX0NPTU1BTkQsIDB4MDQpOworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+
aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkgQVBfQVVYX0NUUkxfU1RBVFVTLAorCQkJCSBBUF9BVVhf
Q1RSTF9BRERST05MWSB8IEFQX0FVWF9DVFJMX09QX0VOKTsKKworCXJldCB8PSB3YWl0X2F1eF9v
cF9maW5pc2goY3R4KTsKKwkvKiB3cml0ZSBzZWdtZW50IGFkZHJlc3MgKi8KKwlyZXQgfD0gc3Bf
dHhfYXV4X3dyKGN0eCwgc2VnbWVudCk7CisJLyogZGF0YSByZWFkICovCisJcmV0IHw9IGFueDc2
MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCSBBUF9BVVhfQURE
Ul83XzAsIDB4NTApOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBh
dXggaW5pdGlhbCBmYWlsZWQuXG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlmb3IgKGNudCA9
IDA7IGNudCA8IDM7IGNudCsrKSB7CisJCXNwX3R4X2F1eF93cihjdHgsIG9mZnNldCk7CisJCS8q
IHNldCBJMkMgcmVhZCBjb20gMHgwMSBtb3QgPSAwIGFuZCByZWFkIDE2IGJ5dGVzICovCisJCWMg
PSBzcF90eF9hdXhfcmQoY3R4LCAweGYxKTsKKworCQlpZiAoYyA9PSAxKSB7CisJCQlyZXQgPSBz
cF90eF9yc3RfYXV4KGN0eCk7CisJCQlEUk1fREVWX0VSUk9SKGRldiwgInNlZ21lbnQgcmVhZCBm
YWlsZWQsIHJlc2V0IVxuIik7CisJCQljbnQrKzsKKwkJfSBlbHNlIHsKKwkJCXJldCA9IGFueDc2
MjVfcmVnX2Jsb2NrX3JlYWQoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJCQkgICAg
IEFQX0FVWF9CVUZGX1NUQVJULAorCQkJCQkJICAgICBNQVhfRFBDRF9CVUZGRVJfU0laRSwgYnVm
KTsKKwkJCXJldHVybiByZXQ7CisJCX0KKwl9CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMg
aW50IHNwX3R4X2VkaWRfcmVhZChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCisJCQkgICB1OCAq
cGVkaWRfYmxvY2tzX2J1ZikKK3sKKwl1OCBvZmZzZXQsIGVkaWRfcG9zOworCWludCBjb3VudCwg
YmxvY2tzX251bTsKKwl1OCBwYmxvY2tfYnVmW01BWF9EUENEX0JVRkZFUl9TSVpFXTsKKwl1OCBp
LCBqOworCXU4IGdfZWRpZF9icmVhayA9IDA7CisJaW50IHJldDsKKwlzdHJ1Y3QgZGV2aWNlICpk
ZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKworCS8qIGFkZHJlc3MgaW5pdGlhbCAqLworCXJldCA9
IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCUFQX0FV
WF9BRERSXzdfMCwgMHg1MCk7CisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5p
MmMucnhfcDBfY2xpZW50LAorCQkJCSBBUF9BVVhfQUREUl8xNV84LCAwKTsKKwlyZXQgfD0gYW54
NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJIEFQX0FVWF9B
RERSXzE5XzE2LCAweGYwKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fRVJST1IoImFjY2VzcyBh
dXggY2hhbm5lbCBJTyBlcnJvci5cbiIpOworCQlyZXR1cm4gLUVJTzsKKwl9CisKKwlibG9ja3Nf
bnVtID0gc3BfdHhfZ2V0X2VkaWRfYmxvY2soY3R4KTsKKwlpZiAoYmxvY2tzX251bSA8IDApCisJ
CXJldHVybiBibG9ja3NfbnVtOworCisJY291bnQgPSAwOworCisJZG8geworCQlzd2l0Y2ggKGNv
dW50KSB7CisJCWNhc2UgMDoKKwkJY2FzZSAxOgorCQkJZm9yIChpID0gMDsgaSA8IDg7IGkrKykg
eworCQkJCW9mZnNldCA9IChpICsgY291bnQgKiA4KSAqIE1BWF9EUENEX0JVRkZFUl9TSVpFOwor
CQkJCWdfZWRpZF9icmVhayA9IGVkaWRfcmVhZChjdHgsIG9mZnNldCwKKwkJCQkJCQkgcGJsb2Nr
X2J1Zik7CisKKwkJCQlpZiAoZ19lZGlkX2JyZWFrID09IDEpCisJCQkJCWJyZWFrOworCisJCQkJ
bWVtY3B5KCZwZWRpZF9ibG9ja3NfYnVmW29mZnNldF0sCisJCQkJICAgICAgIHBibG9ja19idWYs
CisJCQkJICAgICAgIE1BWF9EUENEX0JVRkZFUl9TSVpFKTsKKwkJCX0KKworCQkJYnJlYWs7CisJ
CWNhc2UgMjoKKwkJCW9mZnNldCA9IDB4MDA7CisKKwkJCWZvciAoaiA9IDA7IGogPCA4OyBqKysp
IHsKKwkJCQllZGlkX3BvcyA9IChqICsgY291bnQgKiA4KSAqCisJCQkJCU1BWF9EUENEX0JVRkZF
Ul9TSVpFOworCisJCQkJaWYgKGdfZWRpZF9icmVhayA9PSAxKQorCQkJCQlicmVhazsKKworCQkJ
CXNlZ21lbnRzX2VkaWRfcmVhZChjdHgsIGNvdW50IC8gMiwKKwkJCQkJCSAgIHBibG9ja19idWYs
IG9mZnNldCk7CisJCQkJbWVtY3B5KCZwZWRpZF9ibG9ja3NfYnVmW2VkaWRfcG9zXSwKKwkJCQkg
ICAgICAgcGJsb2NrX2J1ZiwKKwkJCQkgICAgICAgTUFYX0RQQ0RfQlVGRkVSX1NJWkUpOworCQkJ
CW9mZnNldCA9IG9mZnNldCArIDB4MTA7CisJCQl9CisKKwkJCWJyZWFrOworCQljYXNlIDM6CisJ
CQlvZmZzZXQgPSAweDgwOworCisJCQlmb3IgKGogPSAwOyBqIDwgODsgaisrKSB7CisJCQkJZWRp
ZF9wb3MgPSAoaiArIGNvdW50ICogOCkgKgorCQkJCQlNQVhfRFBDRF9CVUZGRVJfU0laRTsKKwkJ
CQlpZiAoZ19lZGlkX2JyZWFrID09IDEpCisJCQkJCWJyZWFrOworCisJCQkJc2VnbWVudHNfZWRp
ZF9yZWFkKGN0eCwgY291bnQgLyAyLAorCQkJCQkJICAgcGJsb2NrX2J1Ziwgb2Zmc2V0KTsKKwkJ
CQltZW1jcHkoJnBlZGlkX2Jsb2Nrc19idWZbZWRpZF9wb3NdLAorCQkJCSAgICAgICBwYmxvY2tf
YnVmLAorCQkJCSAgICAgICBNQVhfRFBDRF9CVUZGRVJfU0laRSk7CisJCQkJb2Zmc2V0ID0gb2Zm
c2V0ICsgMHgxMDsKKwkJCX0KKworCQkJYnJlYWs7CisJCWRlZmF1bHQ6CisJCQlicmVhazsKKwkJ
fQorCisJCWNvdW50Kys7CisKKwl9IHdoaWxlIChibG9ja3NfbnVtID49IGNvdW50KTsKKworCS8q
IGNoZWNrIGVkaWQgZGF0YSAqLworCWlmIChkcm1fZWRpZF9pc192YWxpZCgoc3RydWN0IGVkaWQg
KilwZWRpZF9ibG9ja3NfYnVmKSA9PSBmYWxzZSkKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJXQVJO
SU5HISBlZGlkIGNoZWNrIGZhaWxlZCFcbiIpOworCisJLyogcmVzZXQgYXV4IGNoYW5uZWwgKi8K
KwlzcF90eF9yc3RfYXV4KGN0eCk7CisKKwlyZXR1cm4gYmxvY2tzX251bTsKK30KKworc3RhdGlj
IHZvaWQgYW54NzYyNV9wb3dlcl9vbihzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJc3Ry
dWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisKKwlpZiAoY3R4LT5wZGF0YS5s
b3dfcG93ZXJfbW9kZSkgeworCQkvKiBwb3dlciBvbiBwaW4gZW5hYmxlICovCisJCWdwaW9fc2V0
X3ZhbHVlKGN0eC0+cGRhdGEuZ3Bpb19wX29uLCAxKTsKKwkJdXNsZWVwX3JhbmdlKDEwMDAwLCAx
MTAwMCk7CisJCS8qIHBvd2VyIHJlc2V0IHBpbiBlbmFibGUgKi8KKwkJZ3Bpb19zZXRfdmFsdWUo
Y3R4LT5wZGF0YS5ncGlvX3Jlc2V0LCAxKTsKKwkJdXNsZWVwX3JhbmdlKDEwMDAwLCAxMTAwMCk7
CisKKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiQW54NzYyNSBwb3dlciBvbiAhXG4iKTsK
Kwl9IGVsc2UgeworCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJBbng3NjI1IG5vdCBsb3cg
cG93ZXIgbW9kZSFcbiIpOworCX0KK30KKworc3RhdGljIHZvaWQgYW54NzYyNV9wb3dlcl9zdGFu
ZGJ5KHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAm
Y3R4LT5jbGllbnQtPmRldjsKKworCWlmIChjdHgtPnBkYXRhLmxvd19wb3dlcl9tb2RlKSB7CisJ
CWdwaW9fc2V0X3ZhbHVlKGN0eC0+cGRhdGEuZ3Bpb19yZXNldCwgMCk7CisJCXVzbGVlcF9yYW5n
ZSgxMDAwLCAxMTAwKTsKKwkJZ3Bpb19zZXRfdmFsdWUoY3R4LT5wZGF0YS5ncGlvX3Bfb24sIDAp
OworCQl1c2xlZXBfcmFuZ2UoMTAwMCwgMTEwMCk7CisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRl
diwgImFueDc2MjUgcG93ZXIgZG93blxuIik7CisJfSBlbHNlIHsKKwkJRFJNX0RFVl9ERUJVR19E
UklWRVIoZGV2LCAiYW54NzYyNSBub3QgbG93IHBvd2VyIG1vZGUhXG4iKTsKKwl9Cit9CisKKy8q
IGJhc2ljIGNvbmZpZ3VyYXRpb25zIG9mIEFOWDc2MjUgKi8KK3N0YXRpYyB2b2lkIGFueDc2MjVf
Y29uZmlnKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sKKwlhbng3NjI1X3JlZ193cml0ZShj
dHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCSAgWFRBTF9GUlFfU0VMLCBYVEFMX0ZSUV8y
N00pOworfQorCitzdGF0aWMgdm9pZCBhbng3NjI1X2Rpc2FibGVfcGRfcHJvdG9jb2woc3RydWN0
IGFueDc2MjVfZGF0YSAqY3R4KQoreworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVu
dC0+ZGV2OworCWludCByZXQ7CisKKwkvKiByZXNldCBtYWluIG9jbSAqLworCXJldCA9IGFueDc2
MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LCAweDg4LCAweDQwKTsKKwkv
KiBEaXNhYmxlIFBEICovCisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMu
cnhfcDBfY2xpZW50LAorCQkJCSBBUF9BVl9TVEFUVVMsIEFQX0RJU0FCTEVfUEQpOworCS8qIHJl
bGVhc2UgbWFpbiBvY20gKi8KKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmky
Yy5yeF9wMF9jbGllbnQsIDB4ODgsIDB4MDApOworCisJaWYgKHJldCA8IDApCisJCURSTV9ERVZf
REVCVUdfRFJJVkVSKGRldiwgImRpc2FibGUgUEQgZmVhdHVyZSBmYWlsZWQuXG4iKTsKKwllbHNl
CisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRpc2FibGUgUEQgZmVhdHVyZSBzdWNjZWVk
ZWQuXG4iKTsKK30KKworc3RhdGljIHZvaWQgYW54NzYyNV9wb3dlcl9vbl9pbml0KHN0cnVjdCBh
bng3NjI1X2RhdGEgKmN0eCkKK3sKKwlpbnQgcmV0cnlfY291bnQsIGk7CisJaW50IHJldCA9IDA7
CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisKKwlmb3IgKHJldHJ5
X2NvdW50ID0gMDsgcmV0cnlfY291bnQgPCAzOyByZXRyeV9jb3VudCsrKSB7CisJCWFueDc2MjVf
cG93ZXJfb24oY3R4KTsKKwkJYW54NzYyNV9jb25maWcoY3R4KTsKKworCQlmb3IgKGkgPSAwOyBp
IDwgT0NNX0xPQURJTkdfVElNRTsgaSsrKSB7CisJCQkvKiBjaGVjayBpbnRlcmZhY2Ugd29ya2Fi
bGUgKi8KKwkJCXJldCA9IGFueDc2MjVfcmVnX3JlYWQoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGll
bnQsCisJCQkJCSAgICAgICBGTEFTSF9MT0FEX1NUQSk7CisJCQlpZiAocmV0IDwgMCkgeworCQkJ
CURSTV9FUlJPUigiSU8gZXJyb3IgOiBhY2Nlc3MgZmxhc2ggbG9hZC5cbiIpOworCQkJCXJldHVy
bjsKKwkJCX0KKwkJCWlmICgocmV0ICYgRkxBU0hfTE9BRF9TVEFfQ0hLKSA9PSBGTEFTSF9MT0FE
X1NUQV9DSEspIHsKKwkJCQlhbng3NjI1X2Rpc2FibGVfcGRfcHJvdG9jb2woY3R4KTsKKwkJCQlE
Uk1fREVWX0RFQlVHX0RSSVZFUihkZXYsCisJCQkJCQkgICAgICJGaXJtd2FyZSB2ZXIgJTAyeCUw
MngsIiwKKwkJCQkJYW54NzYyNV9yZWdfcmVhZChjdHgsCisJCQkJCQkJIGN0eC0+aTJjLnJ4X3Aw
X2NsaWVudCwKKwkJCQkJCQkgT0NNX0ZXX1ZFUlNJT04pLAorCQkJCQlhbng3NjI1X3JlZ19yZWFk
KGN0eCwKKwkJCQkJCQkgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCQkJCSBPQ01fRldfUkVW
RVJTSU9OKSk7CisJCQkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiRHJpdmVyIHZlcnNpb24g
JXNcbiIsCisJCQkJCQkgICAgIEFOWDc2MjVfRFJWX1ZFUlNJT04pOworCisJCQkJcmV0dXJuOwor
CQkJfQorCQkJdXNsZWVwX3JhbmdlKDEwMDAsIDExMDApOworCQl9CisJCWFueDc2MjVfcG93ZXJf
c3RhbmRieShjdHgpOworCX0KK30KKworc3RhdGljIGludCBhbng3NjI1X2V4dGNvbl9ub3RpZmll
cihzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgKm5iLAorCQkJCSAgIHVuc2lnbmVkIGxvbmcgZXZlbnQs
IHZvaWQgKnB0cikKK3sKKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHggPQorCQljb250YWluZXJf
b2YobmIsIHN0cnVjdCBhbng3NjI1X2RhdGEsIGV2ZW50X25iKTsKKworCXNjaGVkdWxlX3dvcmso
JmN0eC0+ZXh0Y29uX3dxKTsKKwlyZXR1cm4gTk9USUZZX0RPTkU7Cit9CisKK3N0YXRpYyB2b2lk
IGFueDc2MjVfY2hpcF9jb250cm9sKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sKKwlpbnQg
c3RhdGUgPSBleHRjb25fZ2V0X3N0YXRlKGN0eC0+ZXh0Y29uLCBFWFRDT05fRElTUF9EUCk7CisK
KwlpZiAoY3R4LT5wZGF0YS5sb3dfcG93ZXJfbW9kZSkgeworCQlpZiAoc3RhdGUgPiAwKSB7CisJ
CQlpZiAoYXRvbWljX3JlYWQoJmN0eC0+cG93ZXJfc3RhdHVzKSA9PSAwKSB7CisJCQkJYW54NzYy
NV9wb3dlcl9vbl9pbml0KGN0eCk7CisJCQkJYXRvbWljX3NldCgmY3R4LT5wb3dlcl9zdGF0dXMs
IDEpOworCQkJfQorCQl9IGVsc2UgeworCQkJaWYgKGF0b21pY19yZWFkKCZjdHgtPnBvd2VyX3N0
YXR1cykgPT0gMSkgeworCQkJCWFueDc2MjVfcG93ZXJfc3RhbmRieShjdHgpOworCQkJCWF0b21p
Y19zZXQoJmN0eC0+cG93ZXJfc3RhdHVzLCAwKTsKKwkJCX0KKwkJfQorCX0KK30KKworc3RhdGlj
IHZvaWQgYW54NzYyNV9leHRjb25fd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCit7CisJ
c3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0KKwkJY29udGFpbmVyX29mKHdvcmssIHN0cnVjdCBh
bng3NjI1X2RhdGEsIGV4dGNvbl93cSk7CisKKwltdXRleF9sb2NrKCZjdHgtPmxvY2spOworCWFu
eDc2MjVfY2hpcF9jb250cm9sKGN0eCk7CisJbXV0ZXhfdW5sb2NrKCZjdHgtPmxvY2spOworfQor
CitzdGF0aWMgaW50IGFueDc2MjVfZXh0Y29uX25vdGlmaWVyX2luaXQoc3RydWN0IGFueDc2MjVf
ZGF0YSAqY3R4KQoreworCWludCByZXQ7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xp
ZW50LT5kZXY7CisKKwljdHgtPmV2ZW50X25iLm5vdGlmaWVyX2NhbGwgPSBhbng3NjI1X2V4dGNv
bl9ub3RpZmllcjsKKwlJTklUX1dPUksoJmN0eC0+ZXh0Y29uX3dxLCBhbng3NjI1X2V4dGNvbl93
b3JrKTsKKwlyZXQgPSBkZXZtX2V4dGNvbl9yZWdpc3Rlcl9ub3RpZmllcigmY3R4LT5jbGllbnQt
PmRldiwgY3R4LT5leHRjb24sCisJCQkJCSAgICBFWFRDT05fRElTUF9EUCwgJmN0eC0+ZXZlbnRf
bmIpOworCWlmIChyZXQpIHsKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJmYWlsZWQgdG8gcmVnaXN0
ZXIgbm90aWZpZXIgZm9yIERQIik7CisJCXJldHVybiByZXQ7CisJfQorCXJldHVybiAwOworfQor
CitzdGF0aWMgdm9pZCBhbng3NjI1X2ZyZWVfZ3BpbyhzdHJ1Y3QgYW54NzYyNV9kYXRhICpwbGF0
Zm9ybSkKK3sKKwlpZiAocGxhdGZvcm0tPnBkYXRhLmdwaW9faW50cl9ocGQpCisJCWdwaW9fZnJl
ZShwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19pbnRyX2hwZCk7CisKKwlpZiAocGxhdGZvcm0tPnBkYXRh
Lmxvd19wb3dlcl9tb2RlKSB7CisJCWdwaW9fZnJlZShwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19yZXNl
dCk7CisJCWdwaW9fZnJlZShwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19wX29uKTsKKwl9Cit9CisKK3N0
YXRpYyBpbnQgYW54NzYyNV9pbml0X2dwaW8oc3RydWN0IGFueDc2MjVfZGF0YSAqcGxhdGZvcm0p
Cit7CisJaW50IHJldCA9IDA7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJnBsYXRmb3JtLT5jbGll
bnQtPmRldjsKKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImFueDc2MjUgaW5pdCBncGlv
XG4iKTsKKworCWlmIChwbGF0Zm9ybS0+cGRhdGEubG93X3Bvd2VyX21vZGUpIHsKKwkJLyogZ3Bp
byBmb3IgY2hpcCBwb3dlciBkb3duICovCisJCXJldCA9IGdwaW9fcmVxdWVzdChwbGF0Zm9ybS0+
cGRhdGEuZ3Bpb19wX29uLAorCQkJCSAgICJhbng3NjI1X3Bfb25fY3RsIik7CisJCWlmIChyZXQp
IHsKKwkJCURSTV9ERVZfRVJST1IoZGV2LCAiZmFpbGVkIHRvIHJlcXVlc3QgZ3BpbyAlZFxuIiwK
KwkJCQkgICAgICBwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19wX29uKTsKKwkJCWdvdG8gZXJyMDsKKwkJ
fQorCQkvKiBncGlvIGZvciBjaGlwIHJlc2V0ICovCisJCXJldCA9IGdwaW9fcmVxdWVzdChwbGF0
Zm9ybS0+cGRhdGEuZ3Bpb19yZXNldCwKKwkJCQkgICAiYW54NzYyNV9yZXNldF9uIik7CisJCWlm
IChyZXQpIHsKKwkJCURSTV9ERVZfRVJST1IoZGV2LCAiZmFpbGVkIHRvIHJlcXVlc3QgZ3BpbyAl
ZFxuIiwKKwkJCQkgICAgICBwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19yZXNldCk7CisJCQlnb3RvIGVy
cjE7CisJCX0KKwl9CisKKwlpZiAocGxhdGZvcm0tPnBkYXRhLmdwaW9faW50cl9ocGQpIHsKKwkJ
LyogZ3BpbyBmb3IgY2hpcCBpbnRlcmZhY2UgY29tbXVuYWN0aW9uICovCisJCXJldCA9IGdwaW9f
cmVxdWVzdChwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19pbnRyX2hwZCwKKwkJCQkgICAiYW54NzYyNV9o
cGQiKTsKKwkJaWYgKHJldCkgeworCQkJRFJNX0RFVl9FUlJPUihkZXYsICJmYWlsZWQgdG8gcmVx
dWVzdCBncGlvICVkXG4iLAorCQkJCSAgICAgIHBsYXRmb3JtLT5wZGF0YS5ncGlvX2ludHJfaHBk
KTsKKwkJCWdvdG8gZXJyMjsKKwkJfQorCX0KKworCWdvdG8gb3V0OworCitlcnIyOgorCWlmIChw
bGF0Zm9ybS0+cGRhdGEuZ3Bpb19pbnRyX2hwZCkKKwkJZ3Bpb19mcmVlKHBsYXRmb3JtLT5wZGF0
YS5ncGlvX2ludHJfaHBkKTsKK2VycjE6CisJaWYgKHBsYXRmb3JtLT5wZGF0YS5sb3dfcG93ZXJf
bW9kZSkKKwkJZ3Bpb19mcmVlKHBsYXRmb3JtLT5wZGF0YS5ncGlvX3Jlc2V0KTsKK2VycjA6CisJ
aWYgKHBsYXRmb3JtLT5wZGF0YS5sb3dfcG93ZXJfbW9kZSkKKwkJZ3Bpb19mcmVlKHBsYXRmb3Jt
LT5wZGF0YS5ncGlvX3Bfb24pOworCisJcmV0dXJuIDE7CitvdXQ6CisKKwlyZXR1cm4gMDsKK30K
Kworc3RhdGljIHZvaWQgYW54NzYyNV9zdG9wX2RwX3dvcmsoc3RydWN0IGFueDc2MjVfZGF0YSAq
Y3R4KQoreworCWN0eC0+aHBkX3N0YXR1cyA9IDA7CisJY3R4LT5ocGRfaGlnaF9jbnQgPSAwOwor
CWN0eC0+ZGlzcGxheV90aW1pbmdfdmFsaWQgPSAwOworCisJa2ZyZWUoY3R4LT5zbGltcG9ydF9l
ZGlkX3ApOworCWN0eC0+c2xpbXBvcnRfZWRpZF9wID0gTlVMTDsKKworCWlmIChjdHgtPnBkYXRh
Lmxvd19wb3dlcl9tb2RlID09IDApCisJCWFueDc2MjVfZGlzYWJsZV9wZF9wcm90b2NvbChjdHgp
OworfQorCitzdGF0aWMgdm9pZCBhbng3NjI1X3N0YXJ0X2RwX3dvcmsoc3RydWN0IGFueDc2MjVf
ZGF0YSAqY3R4KQoreworCWludCByZXQ7CisJdTggYnVmW01BWF9EUENEX0JVRkZFUl9TSVpFXTsK
Kwl1OCBoZGNwX2NhcDsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsK
KworCXU4IHNwX3R4X2J3OyAvKiBsaW5rdHJhaW5pbmcgYmFud2lkdGggKi8KKwl1OCBzcF90eF9s
YW5lX2NvdW50OyAvKiBsaW5rIHRyYWluaW5nIGxhbmUgY291bnQgKi8KKworCWlmIChjdHgtPmhw
ZF9oaWdoX2NudCA+PSAyKSB7CisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImFueDc2MjUg
ZmlsdGVyIHVzZWxlc3MgSFBEXG4iKTsKKwkJcmV0dXJuOworCX0KKworCWN0eC0+aHBkX2hpZ2hf
Y250Kys7CisKKwlzcF90eF9nZXRfcnhfYncoY3R4LCAmc3BfdHhfYncpOworCisJc3BfdHhfYXV4
X2RwY2RyZWFkX2J5dGVzKGN0eCwgMHgwMCwgMHgwMCwgRFBDRF9NQVhfTEFORV9DT1VOVCwKKwkJ
CQkgMSwgJnNwX3R4X2xhbmVfY291bnQpOworCisJc3BfdHhfbGFuZV9jb3VudCA9IHNwX3R4X2xh
bmVfY291bnQgJiAweDFmOworCXNwX3R4X2F1eF9kcGNkcmVhZF9ieXRlcyhjdHgsIDB4MDYsIDB4
ODAsIDB4MjgsIDEsIGJ1Zik7LyogcmVhZCBCY2FwICovCisKKwloZGNwX2NhcCA9IGJ1ZlswXSAm
IDB4MDE7CisKKwkvKiBub3Qgc3VwcG9ydCBIRENQICovCisJcmV0ID0gYW54NzYyNV93cml0ZV9h
bmQoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIDB4ZWUsIDB4OWYpOworCisJaWYgKGhkY3Bf
Y2FwID09IDB4MDEpCisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIkhEQ1AxLjRcbiIpOwor
CisJLyogdHJ5IGF1dGggZmxhZyAqLworCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4
LT5pMmMucnhfcDFfY2xpZW50LCAweGVjLCAweDEwKTsKKwkvKiBpbnRlcnJ1cHQgZm9yIERSTSAq
LworCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCAw
eGZmLCAweDAxKTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0dXJuOworCURSTV9ERVZfREVCVUdfRFJJ
VkVSKGRldiwgIk1BWCBCVz0lMDJ4LCBNQVggTGFuZSBjbnQ9JTAyeCwgSERDUD0lMDJ4XG4iLAor
CQkJICAgICAodTMyKXNwX3R4X2J3LAorCQkJICAgICAodTMyKXNwX3R4X2xhbmVfY291bnQsCisJ
CQkgICAgICh1MzIpaGRjcF9jYXApOworCisJcmV0ID0gYW54NzYyNV9yZWdfcmVhZChjdHgsIGN0
eC0+aTJjLnJ4X3AxX2NsaWVudCwgMHg4Nik7CisJaWYgKHJldCA8IDApCisJCXJldHVybjsKKwor
CURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIlNlY3VyZSBPQ00gdmVyc2lvbj0lMDJ4XG4iLCBy
ZXQpOworfQorCitzdGF0aWMgdm9pZCBkcF9ocGRfY2hhbmdlX2hhbmRsZXIoc3RydWN0IGFueDc2
MjVfZGF0YSAqY3R4LCBib29sIG9uKQoreworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNs
aWVudC0+ZGV2OworCisJLyogaHBkIGNoYW5nZWQgKi8KKwlEUk1fREVWX0RFQlVHX0RSSVZFUihk
ZXYsICJkcF9ocGRfY2hhbmdlX2RlZmF1bHRfZnVuYzogJWRcbiIsCisJCQkgICAgICh1MzIpb24p
OworCisJaWYgKG9uID09IDApIHsKKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiIEhQRCBs
b3dcbiIpOworCQlhbng3NjI1X3N0b3BfZHBfd29yayhjdHgpOworCX0gZWxzZSB7CisJCURSTV9E
RVZfREVCVUdfRFJJVkVSKGRldiwgIiBIUEQgaGlnaFxuIik7CisJCWFueDc2MjVfc3RhcnRfZHBf
d29yayhjdHgpOworCX0KKworCWN0eC0+aHBkX3N0YXR1cyA9IG9uOworfQorCitzdGF0aWMgaW50
IGFueDc2MjVfaHBkX2NoYW5nZV9kZXRlY3Qoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQorewor
CWludCBpbnRyX3ZlY3Rvciwgc3RhdHVzOworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNs
aWVudC0+ZGV2OworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAicG93ZXJfc3RhdHVzPSVk
XG4iLAorCQkJICAgICAodTMyKWF0b21pY19yZWFkKCZjdHgtPnBvd2VyX3N0YXR1cykpOworCisJ
c3RhdHVzID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy50Y3BjX2NsaWVudCwKKwkJ
CQkgICBJTlRSX0FMRVJUXzEsIDB4RkYpOworCWlmIChzdGF0dXMgPCAwKSB7CisJCURSTV9FUlJP
UigiSU8gZXJyb3IgOiBjbGVhciBhbGVydCByZWdpc3Rlci5cbiIpOworCQlyZXR1cm4gc3RhdHVz
OworCX0KKworCWludHJfdmVjdG9yID0gYW54NzYyNV9yZWdfcmVhZChjdHgsIGN0eC0+aTJjLnJ4
X3AwX2NsaWVudCwKKwkJCQkgICAgICAgSU5URVJGQUNFX0NIQU5HRV9JTlQpOworCWlmIChpbnRy
X3ZlY3RvciA8IDApIHsKKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGFjY2VzcyBpbnRlcnJ1cHQg
Y2hhbmdlIHJlZ2lzdGVyLlxuIik7CisJCXJldHVybiBpbnRyX3ZlY3RvcjsKKwl9CisJRFJNX0RF
Vl9ERUJVR19EUklWRVIoZGV2LCAiMHg3ZToweDQ0PSV4XG4iLCBpbnRyX3ZlY3Rvcik7CisJc3Rh
dHVzID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJ
ICAgSU5URVJGQUNFX0NIQU5HRV9JTlQsCisJCQkJICAgaW50cl92ZWN0b3IgJiAofmludHJfdmVj
dG9yKSk7CisJaWYgKHN0YXR1cyA8IDApIHsKKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGNsZWFy
IGludGVycnVwdCBjaGFuZ2UgcmVnaXN0ZXIuXG4iKTsKKwkJcmV0dXJuIHN0YXR1czsKKwl9CisK
KwlpZiAoaW50cl92ZWN0b3IgJiBIUERfU1RBVFVTX0NIQU5HRSkgeworCQlzdGF0dXMgPSBhbng3
NjI1X3JlZ19yZWFkKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCQkgIFNZU1RFTV9T
VFNUVVMpOworCQlpZiAoc3RhdHVzIDwgMCkgeworCQkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGNs
ZWFyIGludGVycnVwdCBzdGF0dXMuXG4iKTsKKwkJCXJldHVybiBzdGF0dXM7CisJCX0KKworCQlE
Uk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICIweDdlOjB4NDU9JXhcbiIsIHN0YXR1cyk7CisJCWRw
X2hwZF9jaGFuZ2VfaGFuZGxlcihjdHgsIHN0YXR1cyAmIEhQRF9TVEFUVVMpOworCQlyZXR1cm4g
MTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgYW54NzYyNV93b3JrX2Z1bmMo
c3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQoreworCWludCBldmVudDsKKwlzdHJ1Y3QgYW54NzYy
NV9kYXRhICpjdHggPSBjb250YWluZXJfb2Yod29yaywKKwkJCQkJCXN0cnVjdCBhbng3NjI1X2Rh
dGEsIHdvcmspOworCisJbXV0ZXhfbG9jaygmY3R4LT5sb2NrKTsKKwlldmVudCA9IGFueDc2MjVf
aHBkX2NoYW5nZV9kZXRlY3QoY3R4KTsKKwltdXRleF91bmxvY2soJmN0eC0+bG9jayk7CisKKwlp
ZiAoZXZlbnQgPCAwKQorCQlyZXR1cm47CisKKwlpZiAoZXZlbnQgJiYgY3R4LT5icmlkZ2VfYXR0
YWNoZWQpCisJCWRybV9oZWxwZXJfaHBkX2lycV9ldmVudChjdHgtPmNvbm5lY3Rvci5kZXYpOwor
fQorCitzdGF0aWMgaXJxcmV0dXJuX3QgYW54NzYyNV9pbnRyX2hwZF9pc3IoaW50IGlycSwgdm9p
ZCAqZGF0YSkKK3sKKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHggPSAoc3RydWN0IGFueDc2MjVf
ZGF0YSAqKWRhdGE7CisKKwlpZiAoYXRvbWljX3JlYWQoJmN0eC0+cG93ZXJfc3RhdHVzKSAhPSAx
KQorCQlyZXR1cm4gSVJRX05PTkU7CisKKwlxdWV1ZV93b3JrKGN0eC0+d29ya3F1ZXVlLCAmY3R4
LT53b3JrKTsKKworCXJldHVybiBJUlFfSEFORExFRDsKK30KKworI2lmZGVmIENPTkZJR19PRgor
c3RhdGljIGludCBhbng3NjI1X3BhcnNlX2R0KHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCSAgICBz
dHJ1Y3QgYW54NzYyNV9wbGF0Zm9ybV9kYXRhICpwZGF0YSkKK3sKKwlpbnQgcmV0OworCXUzMiBs
ZW47CisJc3RydWN0IGRldmljZV9ub2RlICpucCA9IGRldi0+b2Zfbm9kZTsKKwlzdHJ1Y3QgZGV2
aWNlX25vZGUgKm1pcGlfaG9zdF9ub2RlOworCXN0cnVjdCBwcm9wZXJ0eSAqcHJvcDsKKworCXJl
dCA9IG9mX3Byb3BlcnR5X3JlYWRfdTMyKGRldi0+b2Zfbm9kZSwgImxvdy1wb3dlci1tb2RlIiwK
KwkJCQkgICAmcGRhdGEtPmxvd19wb3dlcl9tb2RlKTsKKwlpZiAocmV0KQorCQlwZGF0YS0+bG93
X3Bvd2VyX21vZGUgPSAxOyAvKiBkZWZhdWx0IGxvdyBwb3dlciBtb2RlICovCisKKwlwZGF0YS0+
bm9kZS5taXBpX2RzaV9ob3N0X25vZGUgPSBvZl9ncmFwaF9nZXRfcmVtb3RlX25vZGUobnAsIDAs
IDApOworCWlmIChwZGF0YS0+bm9kZS5taXBpX2RzaV9ob3N0X25vZGUpIHsKKwkJb2Zfbm9kZV9w
dXQocGRhdGEtPm5vZGUubWlwaV9kc2lfaG9zdF9ub2RlKTsKKwkJcGRhdGEtPmRzaV9zdXBwb3J0
ZWQgPSAxOworCQltaXBpX2hvc3Rfbm9kZSA9IHBkYXRhLT5ub2RlLm1pcGlfZHNpX2hvc3Rfbm9k
ZTsKKwl9IGVsc2UgeworCQlwZGF0YS0+bm9kZS5taXBpX2RwaV9ob3N0X25vZGUgPQorCQkJb2Zf
Z3JhcGhfZ2V0X3JlbW90ZV9ub2RlKG5wLCAxLCAwKTsKKwkJaWYgKCFwZGF0YS0+bm9kZS5taXBp
X2RwaV9ob3N0X25vZGUpCisJCQlEUk1fRVJST1IoImNhbm5vdCByZXNvbHZlIGFueSBNSVBJIGhv
c3Qgbm9kZS5cbiIpOworCQllbHNlCisJCQlvZl9ub2RlX3B1dChwZGF0YS0+bm9kZS5taXBpX2Rw
aV9ob3N0X25vZGUpOworCisJCW1pcGlfaG9zdF9ub2RlID0gcGRhdGEtPm5vZGUubWlwaV9kcGlf
aG9zdF9ub2RlOworCX0KKworCWlmICghbWlwaV9ob3N0X25vZGUpIHsKKwkJcHJvcCA9IG9mX2Zp
bmRfcHJvcGVydHkobWlwaV9ob3N0X25vZGUsICJkYXRhLWxhbmVzIiwgJmxlbik7CisJCWlmICgh
cHJvcCkKKwkJCURSTV9FUlJPUigiY2Fubm90IHJlc29sdmUgTUlQSSBob3N0IG5vZGUgcHJvcGVy
dHkuXG4iKTsKKwkJZWxzZQorCQkJcGRhdGEtPmRzaV9sYW5lcyA9IGxlbiAvIHNpemVvZih1MzIp
OworCisJCW9mX3Byb3BlcnR5X3JlYWRfdTMyKG1pcGlfaG9zdF9ub2RlLCAicmVnIiwKKwkJCQkg
ICAgICZwZGF0YS0+ZHNpX2NoYW5uZWwpOworCX0KKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRl
diwgImxvd19wb3dlcl9tb2RlIDogJWQsIGRzaV9zdXBwb3J0ZWQgOiAlZFxuIiwKKwkJCSAgICAg
cGRhdGEtPmxvd19wb3dlcl9tb2RlLCBwZGF0YS0+ZHNpX3N1cHBvcnRlZCk7CisJRFJNX0RFVl9E
RUJVR19EUklWRVIoZGV2LCAiZHNpX2NoYW5uZWwgOiAlZCwgZHNpX2xhbmVzIDogJWQsICVzIG5v
ZGVcbiIsCisJCQkgICAgIHBkYXRhLT5kc2lfY2hhbm5lbCwgcGRhdGEtPmRzaV9sYW5lcywKKwkJ
CSAgICAgKCFtaXBpX2hvc3Rfbm9kZSkgPyAibm90IiA6ICJoYXMiKTsKKworCXBkYXRhLT5ub2Rl
LmV4dGNvbl9ub2RlID0gb2ZfZ3JhcGhfZ2V0X3JlbW90ZV9ub2RlKG5wLCAyLCAwKTsKKwlwZGF0
YS0+bm9kZS5pbnRlcm5hbF9wYW5lbF9ub2RlID0gb2ZfZ3JhcGhfZ2V0X3JlbW90ZV9ub2RlKG5w
LCAzLCAwKTsKKwlwZGF0YS0+bm9kZS5lZHBfbm9kZSA9IG9mX2dyYXBoX2dldF9yZW1vdGVfbm9k
ZShucCwgNCwgMCk7CisJaWYgKHBkYXRhLT5ub2RlLmV4dGNvbl9ub2RlKQorCQlwZGF0YS0+ZXh0
Y29uX3N1cHBvcnRlZCA9IDE7CisKKwlpZiAocGRhdGEtPm5vZGUuaW50ZXJuYWxfcGFuZWxfbm9k
ZSkKKwkJcGRhdGEtPmludGVybmFsX3BhbmVsID0gMTsKKworCWlmIChwZGF0YS0+bG93X3Bvd2Vy
X21vZGUpIHsKKwkJcGRhdGEtPmdwaW9fcF9vbiA9CisJCQlvZl9nZXRfbmFtZWRfZ3Bpb19mbGFn
cyhucCwgImVuYWJsZS1ncGlvcyIsCisJCQkJCQkwLCBOVUxMKTsKKworCQlwZGF0YS0+Z3Bpb19y
ZXNldCA9CisJCQlvZl9nZXRfbmFtZWRfZ3Bpb19mbGFncyhucCwgInJlc2V0LWdwaW9zIiwKKwkJ
CQkJCTAsIE5VTEwpOworCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJncGlvIHBfb24gOiAl
ZCwgcmVzZXQgOiAlZFxuIiwKKwkJCQkgICAgIHBkYXRhLT5ncGlvX3Bfb24sIHBkYXRhLT5ncGlv
X3Jlc2V0KTsKKwl9CisKKwlwZGF0YS0+Z3Bpb19pbnRyX2hwZCA9CisJCW9mX2dldF9uYW1lZF9n
cGlvX2ZsYWdzKG5wLCAiaHBkLWdwaW9zIiwgMCwgTlVMTCk7CisKKwlEUk1fREVWX0RFQlVHX0RS
SVZFUihkZXYsICJncGlvIGhwZCA6ICVkXG4iLCBwZGF0YS0+Z3Bpb19pbnRyX2hwZCk7CisKKwly
ZXR1cm4gMDsKK30KKyNlbHNlCitzdGF0aWMgaW50IGFueDc2MjVfcGFyc2VfZHQoc3RydWN0IGRl
dmljZSAqZGV2LAorCQkJICAgIHN0cnVjdCBhbng3NjI1X3BsYXRmb3JtX2RhdGEgKnBkYXRhKQor
eworCXJldHVybiAtRU5PREVWOworfQorI2VuZGlmCisKK3N0YXRpYyBpbmxpbmUgc3RydWN0IGFu
eDc2MjVfZGF0YSAqY29ubmVjdG9yX3RvX2FueDc2MjUoc3RydWN0IGRybV9jb25uZWN0b3IgKmMp
Cit7CisJcmV0dXJuIGNvbnRhaW5lcl9vZihjLCBzdHJ1Y3QgYW54NzYyNV9kYXRhLCBjb25uZWN0
b3IpOworfQorCitzdGF0aWMgaW5saW5lIHN0cnVjdCBhbng3NjI1X2RhdGEgKmJyaWRnZV90b19h
bng3NjI1KHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UpCit7CisJcmV0dXJuIGNvbnRhaW5lcl9v
ZihicmlkZ2UsIHN0cnVjdCBhbng3NjI1X2RhdGEsIGJyaWRnZSk7Cit9CisKK3N0YXRpYyBpbnQg
YW54NzYyNV9yZWFkX2hwZF9zdGF0dXNfcDAoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQorewor
CXJldHVybiBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LCBTWVNU
RU1fU1RTVFVTKTsKK30KKworc3RhdGljIGludCBhbng3NjI1X2dldF9tb2RlcyhzdHJ1Y3QgZHJt
X2Nvbm5lY3RvciAqY29ubmVjdG9yKQoreworCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCA9IGNv
bm5lY3Rvcl90b19hbng3NjI1KGNvbm5lY3Rvcik7CisJaW50IGVyciwgbnVtX21vZGVzID0gMDsK
KwlpbnQgdmFsLCByZXQ7CisJc3RydWN0IHNfZWRpZF9kYXRhICpwX2VkaWQgPSAoc3RydWN0IHNf
ZWRpZF9kYXRhICopY3R4LT5zbGltcG9ydF9lZGlkX3A7CisJc3RydWN0IGRldmljZSAqZGV2ID0g
JmN0eC0+Y2xpZW50LT5kZXY7CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJkcm0gZ2V0
IG1vZGVzXG4iKTsKKworCWlmIChjdHgtPnBkYXRhLmludGVybmFsX3BhbmVsICYmCisJICAgIGN0
eC0+cGRhdGEubG93X3Bvd2VyX21vZGUgJiYKKwkgICAgKCFhdG9taWNfcmVhZCgmY3R4LT5wb3dl
cl9zdGF0dXMpKSkgeworCQlhbng3NjI1X3Bvd2VyX29uX2luaXQoY3R4KTsKKwkJYXRvbWljX3Nl
dCgmY3R4LT5wb3dlcl9zdGF0dXMsIDEpOworCisJCXJldCA9IHJlYWR4X3BvbGxfdGltZW91dChh
bng3NjI1X3JlYWRfaHBkX3N0YXR1c19wMCwKKwkJCQkJIGN0eCwgdmFsLAorCQkJCQkgKCh2YWwg
JiBIUERfU1RBVFVTKSB8fCAodmFsIDwgMCkpLAorCQkJCQkgNTAwMCwKKwkJCQkJIDUwMDAgKiAx
MDApOworCQlpZiAocmV0KSB7CisJCQlEUk1fREVWX0VSUk9SKGRldiwgIkhQRCBzdGF0dXMgcG9s
bGluZyB0aW1lb3V0IVxuIik7CisJCX0gZWxzZSB7CisJCQlEUk1fREVWX0RFQlVHX0RSSVZFUihk
ZXYsICJIUEQgcmFpc2UgdXAuXG4iKTsKKwkJCWFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5p
MmMudGNwY19jbGllbnQsCisJCQkJCSAgSU5UUl9BTEVSVF8xLCAweEZGKTsKKwkJCWFueDc2MjVf
cmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCQkgIElOVEVSRkFDRV9D
SEFOR0VfSU5ULCAwKTsKKwkJfQorCisJCWFueDc2MjVfc3RhcnRfZHBfd29yayhjdHgpOworCX0K
KworCWlmIChXQVJOX09OKCFhdG9taWNfcmVhZCgmY3R4LT5wb3dlcl9zdGF0dXMpKSkKKwkJcmV0
dXJuIDA7CisKKwlpZiAoY3R4LT5zbGltcG9ydF9lZGlkX3AgJiYgY3R4LT5zbGltcG9ydF9lZGlk
X3AtPmVkaWRfYmxvY2tfbnVtID49IDApCisJCXJldHVybiBkcm1fYWRkX2VkaWRfbW9kZXMoY29u
bmVjdG9yLAorCQkJCQkgIChzdHJ1Y3QgZWRpZCAqKQorCQkJCQkgICZwX2VkaWQtPmVkaWRfcmF3
X2RhdGEpOworCisJbXV0ZXhfbG9jaygmY3R4LT5sb2NrKTsKKworCWlmICghY3R4LT5zbGltcG9y
dF9lZGlkX3ApCisJCWN0eC0+c2xpbXBvcnRfZWRpZF9wID0ga3phbGxvYyhzaXplb2YoKmN0eC0+
c2xpbXBvcnRfZWRpZF9wKSwKKwkJCQkJICAgICAgIEdGUF9LRVJORUwpOworCXBfZWRpZCA9IGN0
eC0+c2xpbXBvcnRfZWRpZF9wOworCXBfZWRpZC0+ZWRpZF9ibG9ja19udW0gPSBzcF90eF9lZGlk
X3JlYWQoY3R4LCBwX2VkaWQtPmVkaWRfcmF3X2RhdGEpOworCWlmIChwX2VkaWQtPmVkaWRfYmxv
Y2tfbnVtIDwgMCkgeworCQlEUk1fRVJST1IoIkZhaWxlZCB0byByZWFkIEVESUQuXG4iKTsKKwkJ
Z290byB1bmxvY2s7CisJfQorCisJZXJyID0gZHJtX2Nvbm5lY3Rvcl91cGRhdGVfZWRpZF9wcm9w
ZXJ0eShjb25uZWN0b3IsCisJCQkJCQkgKHN0cnVjdCBlZGlkICopCisJCQkJCQkgJnBfZWRpZC0+
ZWRpZF9yYXdfZGF0YSk7CisKKwlpZiAoZXJyKSB7CisJCURSTV9FUlJPUigiRmFpbGVkIHRvIHVw
ZGF0ZSBFRElEIHByb3BlcnR5OiAlZFxuIiwgZXJyKTsKKwkJZ290byB1bmxvY2s7CisJfQorCisJ
bnVtX21vZGVzID0gZHJtX2FkZF9lZGlkX21vZGVzKGNvbm5lY3RvciwKKwkJCQkgICAgICAgKHN0
cnVjdCBlZGlkICopJnBfZWRpZC0+ZWRpZF9yYXdfZGF0YSk7CisKK3VubG9jazoKKwltdXRleF91
bmxvY2soJmN0eC0+bG9jayk7CisKKwlyZXR1cm4gbnVtX21vZGVzOworfQorCitzdGF0aWMgZW51
bSBkcm1fbW9kZV9zdGF0dXMKK2FueDc2MjVfY29ubmVjdG9yX21vZGVfdmFsaWQoc3RydWN0IGRy
bV9jb25uZWN0b3IgKmNvbm5lY3RvciwKKwkJCSAgICAgc3RydWN0IGRybV9kaXNwbGF5X21vZGUg
Km1vZGUpCit7CisJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0gY29ubmVjdG9yX3RvX2FueDc2
MjUoY29ubmVjdG9yKTsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsK
KworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRybSBtb2RlcyB2YWxpZCB2ZXJpZnlcbiIp
OworCisJaWYgKG1vZGUtPmNsb2NrID4gMzAwMDAwKQorCQlyZXR1cm4gTU9ERV9DTE9DS19ISUdI
OworCisJcmV0dXJuIE1PREVfT0s7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9o
ZWxwZXJfZnVuY3MgYW54NzYyNV9jb25uZWN0b3JfaGVscGVyX2Z1bmNzID0geworCS5nZXRfbW9k
ZXMgPSBhbng3NjI1X2dldF9tb2RlcywKKwkubW9kZV92YWxpZCA9IGFueDc2MjVfY29ubmVjdG9y
X21vZGVfdmFsaWQsCit9OworCitzdGF0aWMgZW51bSBkcm1fY29ubmVjdG9yX3N0YXR1cyBhbng3
NjI1X2RldGVjdChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAorCQkJCQkJYm9vbCBm
b3JjZSkKK3sKKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHggPSBjb25uZWN0b3JfdG9fYW54NzYy
NShjb25uZWN0b3IpOworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owor
CisJaWYgKCEoY3R4LT5ocGRfc3RhdHVzKSkKKwkJcmV0dXJuIGNvbm5lY3Rvcl9zdGF0dXNfZGlz
Y29ubmVjdGVkOworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZHJtIGRldGVjdFxuIik7
CisKKwlyZXR1cm4gY29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQ7Cit9CisKK3N0YXRpYyBjb25z
dCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9mdW5jcyBhbng3NjI1X2Nvbm5lY3Rvcl9mdW5jcyA9IHsK
KwkuZmlsbF9tb2RlcyA9IGRybV9oZWxwZXJfcHJvYmVfc2luZ2xlX2Nvbm5lY3Rvcl9tb2RlcywK
KwkuZGV0ZWN0ID0gYW54NzYyNV9kZXRlY3QsCisJLmRlc3Ryb3kgPSBkcm1fY29ubmVjdG9yX2Ns
ZWFudXAsCisJLnJlc2V0ID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX3Jlc2V0LAorCS5h
dG9taWNfZHVwbGljYXRlX3N0YXRlID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2R1cGxp
Y2F0ZV9zdGF0ZSwKKwkuYXRvbWljX2Rlc3Ryb3lfc3RhdGUgPSBkcm1fYXRvbWljX2hlbHBlcl9j
b25uZWN0b3JfZGVzdHJveV9zdGF0ZSwKK307CisKK3N0YXRpYyB2b2lkIGFueDc2MjVfYXR0YWNo
X2RzaShzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJc3RydWN0IG1pcGlfZHNpX2hvc3Qg
Kmhvc3Q7CisJc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpOworCXN0cnVjdCBkZXZpY2Vfbm9k
ZSAqbWlwaV9ob3N0X25vZGU7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5k
ZXY7CisJY29uc3Qgc3RydWN0IG1pcGlfZHNpX2RldmljZV9pbmZvIGluZm8gPSB7CisJCS50eXBl
ID0gImFueDc2MjUiLAorCQkuY2hhbm5lbCA9IGN0eC0+cGRhdGEuZHNpX2NoYW5uZWwsCisJCS5u
b2RlID0gTlVMTCwKKwl9OworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiYXR0YWNoIGRz
aVxuIik7CisKKwlpZiAoY3R4LT5wZGF0YS5kc2lfc3VwcG9ydGVkKQorCQltaXBpX2hvc3Rfbm9k
ZSA9IGN0eC0+cGRhdGEubm9kZS5taXBpX2RzaV9ob3N0X25vZGU7CisJZWxzZQorCQltaXBpX2hv
c3Rfbm9kZSA9IGN0eC0+cGRhdGEubm9kZS5taXBpX2RwaV9ob3N0X25vZGU7CisKKwlpZiAoIW1p
cGlfaG9zdF9ub2RlKSB7CisJCURSTV9FUlJPUigiZHNpIGhvc3QgaXMgbm90IGNvbmZpZ3VyZWQu
XG4iKTsKKwkJcmV0dXJuOworCX0KKworCWhvc3QgPSBvZl9maW5kX21pcGlfZHNpX2hvc3RfYnlf
bm9kZShtaXBpX2hvc3Rfbm9kZSk7CisJaWYgKCFob3N0KSB7CisJCURSTV9FUlJPUigiZmFpbGVk
IHRvIGZpbmQgZHNpIGhvc3QuXG4iKTsKKwkJcmV0dXJuOworCX0KKworCWRzaSA9IG1pcGlfZHNp
X2RldmljZV9yZWdpc3Rlcl9mdWxsKGhvc3QsICZpbmZvKTsKKwlpZiAoSVNfRVJSKGRzaSkpIHsK
KwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gY3JlYXRlIGRzaSBkZXZpY2UuXG4iKTsKKwkJcmV0dXJu
OworCX0KKworCWRzaS0+bGFuZXMgPSBjdHgtPnBkYXRhLmRzaV9sYW5lczsKKwlkc2ktPmZvcm1h
dCA9IE1JUElfRFNJX0ZNVF9SR0I4ODg7CisJZHNpLT5tb2RlX2ZsYWdzID0gTUlQSV9EU0lfTU9E
RV9WSURFTwl8CisJCU1JUElfRFNJX01PREVfVklERU9fU1lOQ19QVUxTRQl8CisJCU1JUElfRFNJ
X01PREVfRU9UX1BBQ0tFVAl8CisJCU1JUElfRFNJX01PREVfVklERU9fSFNFOworCisJaWYgKG1p
cGlfZHNpX2F0dGFjaChkc2kpIDwgMCkgeworCQlEUk1fRVJST1IoImZhaWxlZCB0byBhdHRhY2gg
ZHNpIHRvIGhvc3QuXG4iKTsKKwkJbWlwaV9kc2lfZGV2aWNlX3VucmVnaXN0ZXIoZHNpKTsKKwkJ
cmV0dXJuOworCX0KKworCWN0eC0+ZHNpID0gZHNpOworCisJRFJNX0RFVl9ERUJVR19EUklWRVIo
ZGV2LCAiYXR0YWNoIGRzaSBzdWNjZWVkZWQuXG4iKTsKK30KKworc3RhdGljIHZvaWQgYW54NzYy
NV9kZXRhY2hfZHNpKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sKKwlpZiAoY3R4LT5kc2kp
IHsKKwkJbWlwaV9kc2lfZGV0YWNoKGN0eC0+ZHNpKTsKKwkJbWlwaV9kc2lfZGV2aWNlX3VucmVn
aXN0ZXIoY3R4LT5kc2kpOworCX0KK30KKworc3RhdGljIGludCBhbng3NjI1X2JyaWRnZV9hdHRh
Y2goc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSkKK3sKKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpj
dHggPSBicmlkZ2VfdG9fYW54NzYyNShicmlkZ2UpOworCWludCBlcnI7CisJc3RydWN0IGRldmlj
ZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYs
ICJkcm0gYXR0YWNoXG4iKTsKKwlpZiAoIWJyaWRnZS0+ZW5jb2RlcikgeworCQlEUk1fRVJST1Io
IlBhcmVudCBlbmNvZGVyIG9iamVjdCBub3QgZm91bmQiKTsKKwkJcmV0dXJuIC1FTk9ERVY7CisJ
fQorCisJZXJyID0gZHJtX2Nvbm5lY3Rvcl9pbml0KGJyaWRnZS0+ZGV2LCAmY3R4LT5jb25uZWN0
b3IsCisJCQkJICZhbng3NjI1X2Nvbm5lY3Rvcl9mdW5jcywKKwkJCQkgRFJNX01PREVfQ09OTkVD
VE9SX0Rpc3BsYXlQb3J0KTsKKwlpZiAoZXJyKSB7CisJCURSTV9FUlJPUigiRmFpbGVkIHRvIGlu
aXRpYWxpemUgY29ubmVjdG9yOiAlZFxuIiwgZXJyKTsKKwkJcmV0dXJuIGVycjsKKwl9CisKKwlk
cm1fY29ubmVjdG9yX2hlbHBlcl9hZGQoJmN0eC0+Y29ubmVjdG9yLAorCQkJCSAmYW54NzYyNV9j
b25uZWN0b3JfaGVscGVyX2Z1bmNzKTsKKworCWVyciA9IGRybV9jb25uZWN0b3JfcmVnaXN0ZXIo
JmN0eC0+Y29ubmVjdG9yKTsKKwlpZiAoZXJyKSB7CisJCURSTV9FUlJPUigiRmFpbGVkIHRvIHJl
Z2lzdGVyIGNvbm5lY3RvcjogJWRcbiIsIGVycik7CisJCXJldHVybiBlcnI7CisJfQorCisJY3R4
LT5jb25uZWN0b3IucG9sbGVkID0gRFJNX0NPTk5FQ1RPUl9QT0xMX0hQRDsKKworCWVyciA9IGRy
bV9jb25uZWN0b3JfYXR0YWNoX2VuY29kZXIoJmN0eC0+Y29ubmVjdG9yLCBicmlkZ2UtPmVuY29k
ZXIpOworCWlmIChlcnIpIHsKKwkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gbGluayB1cCBjb25uZWN0
b3IgdG8gZW5jb2RlcjogJWRcbiIsIGVycik7CisJCWRybV9jb25uZWN0b3JfdW5yZWdpc3Rlcigm
Y3R4LT5jb25uZWN0b3IpOworCQlyZXR1cm4gZXJyOworCX0KKworCWFueDc2MjVfYXR0YWNoX2Rz
aShjdHgpOworCisJY3R4LT5icmlkZ2VfYXR0YWNoZWQgPSAxOworCisJcmV0dXJuIDA7Cit9CisK
K3N0YXRpYyBlbnVtIGRybV9tb2RlX3N0YXR1cworYW54NzYyNV9icmlkZ2VfbW9kZV92YWxpZChz
dHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAorCQkJICBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlf
bW9kZSAqbW9kZSkKK3sKKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHggPSBicmlkZ2VfdG9fYW54
NzYyNShicmlkZ2UpOworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owor
CisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZHJtIG1vZGUgY2hlY2tpbmdcbiIpOworCisJ
LyogTWF4IDEyMDBwIGF0IDUuNCBHaHosIG9uZSBsYW5lLCBwaXhlbCBjbG9jayAzMDBNICovCisJ
aWYgKG1vZGUtPmNsb2NrID4gMzAwMDAwKSB7CisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwK
KwkJCQkgICAgICJkcm0gbW9kZSBpbnZhbGlkLCBwaXhlbGNsb2NrIHRvbyBoaWdoLlxuIik7CisJ
CXJldHVybiBNT0RFX0NMT0NLX0hJR0g7CisJfQorCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2
LCAiZHJtIG1vZGUgdmFsaWQuXG4iKTsKKwlyZXR1cm4gTU9ERV9PSzsKK30KKworc3RhdGljIHZv
aWQgYW54NzYyNV9icmlkZ2VfbW9kZV9zZXQoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSwKKwkJ
CQkgICAgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm9sZF9tb2RlLAorCQkJCSAgICBj
b25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkKK3sKKwlzdHJ1Y3QgYW54NzYyNV9k
YXRhICpjdHggPSBicmlkZ2VfdG9fYW54NzYyNShicmlkZ2UpOworCXN0cnVjdCBkZXZpY2UgKmRl
diA9ICZjdHgtPmNsaWVudC0+ZGV2OworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZHJt
IG1vZGUgc2V0XG4iKTsKKworCWlmIChXQVJOX09OKCFhdG9taWNfcmVhZCgmY3R4LT5wb3dlcl9z
dGF0dXMpKSkKKwkJcmV0dXJuOworCisJbXV0ZXhfbG9jaygmY3R4LT5sb2NrKTsKKworCWN0eC0+
ZHQucGl4ZWxjbG9jay5taW4gPSBtb2RlLT5jbG9jazsKKwljdHgtPmR0LmhhY3RpdmUubWluID0g
bW9kZS0+aGRpc3BsYXk7CisJY3R4LT5kdC5oc3luY19sZW4ubWluID0gbW9kZS0+aHN5bmNfZW5k
IC0gbW9kZS0+aHN5bmNfc3RhcnQ7CisJY3R4LT5kdC5oZnJvbnRfcG9yY2gubWluID0gbW9kZS0+
aHN5bmNfc3RhcnQgLSBtb2RlLT5oZGlzcGxheTsKKwljdHgtPmR0LmhiYWNrX3BvcmNoLm1pbiA9
IG1vZGUtPmh0b3RhbCAtIG1vZGUtPmhzeW5jX2VuZDsKKwljdHgtPmR0LnZhY3RpdmUubWluID0g
bW9kZS0+dmRpc3BsYXk7CisJY3R4LT5kdC52c3luY19sZW4ubWluID0gbW9kZS0+dnN5bmNfZW5k
IC0gbW9kZS0+dnN5bmNfc3RhcnQ7CisJY3R4LT5kdC52ZnJvbnRfcG9yY2gubWluID0gbW9kZS0+
dnN5bmNfc3RhcnQgLSBtb2RlLT52ZGlzcGxheTsKKwljdHgtPmR0LnZiYWNrX3BvcmNoLm1pbiA9
IG1vZGUtPnZ0b3RhbCAtIG1vZGUtPnZzeW5jX2VuZDsKKworCWN0eC0+ZGlzcGxheV90aW1pbmdf
dmFsaWQgPSAxOworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAicGl4ZWxjbG9jayglZCku
XG4iLCBjdHgtPmR0LnBpeGVsY2xvY2subWluKTsKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYs
ICJoYWN0aXZlKCVkKSwgaHN5bmMoJWQpLCBoZnAoJWQpLCBoYnAoJWQpXG4iLAorCQkJICAgICBj
dHgtPmR0LmhhY3RpdmUubWluLAorCQkJICAgICBjdHgtPmR0LmhzeW5jX2xlbi5taW4sCisJCQkg
ICAgIGN0eC0+ZHQuaGZyb250X3BvcmNoLm1pbiwKKwkJCSAgICAgY3R4LT5kdC5oYmFja19wb3Jj
aC5taW4pOworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgInZhY3RpdmUoJWQpLCB2c3luYygl
ZCksIHZmcCglZCksIHZicCglZClcbiIsCisJCQkgICAgIGN0eC0+ZHQudmFjdGl2ZS5taW4sCisJ
CQkgICAgIGN0eC0+ZHQudnN5bmNfbGVuLm1pbiwKKwkJCSAgICAgY3R4LT5kdC52ZnJvbnRfcG9y
Y2gubWluLAorCQkJICAgICBjdHgtPmR0LnZiYWNrX3BvcmNoLm1pbik7CisJRFJNX0RFVl9ERUJV
R19EUklWRVIoZGV2LCAiaGRpc3BsYXkoJWQpLGhzeW5jX3N0YXJ0KCVkKS5cbiIsCisJCQkgICAg
IG1vZGUtPmhkaXNwbGF5LAorCQkJICAgICBtb2RlLT5oc3luY19zdGFydCk7CisJRFJNX0RFVl9E
RUJVR19EUklWRVIoZGV2LCAiaHN5bmNfZW5kKCVkKSxodG90YWwoJWQpLlxuIiwKKwkJCSAgICAg
bW9kZS0+aHN5bmNfZW5kLAorCQkJICAgICBtb2RlLT5odG90YWwpOworCURSTV9ERVZfREVCVUdf
RFJJVkVSKGRldiwgInZkaXNwbGF5KCVkKSx2c3luY19zdGFydCglZCkuXG4iLAorCQkJICAgICBt
b2RlLT52ZGlzcGxheSwKKwkJCSAgICAgbW9kZS0+dnN5bmNfc3RhcnQpOworCURSTV9ERVZfREVC
VUdfRFJJVkVSKGRldiwgInZzeW5jX2VuZCglZCksdnRvdGFsKCVkKS5cbiIsCisJCQkgICAgIG1v
ZGUtPnZzeW5jX2VuZCwKKwkJCSAgICAgbW9kZS0+dnRvdGFsKTsKKworCW11dGV4X3VubG9jaygm
Y3R4LT5sb2NrKTsKK30KKworc3RhdGljIHZvaWQgYW54NzYyNV9icmlkZ2VfZW5hYmxlKHN0cnVj
dCBkcm1fYnJpZGdlICpicmlkZ2UpCit7CisJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0gYnJp
ZGdlX3RvX2FueDc2MjUoYnJpZGdlKTsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGll
bnQtPmRldjsKKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRybSBlbmFibGVcbiIpOwor
CisJaWYgKFdBUk5fT04oIWF0b21pY19yZWFkKCZjdHgtPnBvd2VyX3N0YXR1cykpKQorCQlyZXR1
cm47CisKKwltdXRleF9sb2NrKCZjdHgtPmxvY2spOworCisJYW54NzYyNV9kcF9zdGFydChjdHgp
OworCisJbXV0ZXhfdW5sb2NrKCZjdHgtPmxvY2spOworfQorCitzdGF0aWMgdm9pZCBhbng3NjI1
X2JyaWRnZV9kaXNhYmxlKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UpCit7CisJc3RydWN0IGFu
eDc2MjVfZGF0YSAqY3R4ID0gYnJpZGdlX3RvX2FueDc2MjUoYnJpZGdlKTsKKwlzdHJ1Y3QgZGV2
aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKworCWlmIChXQVJOX09OKCFhdG9taWNfcmVh
ZCgmY3R4LT5wb3dlcl9zdGF0dXMpKSkKKwkJcmV0dXJuOworCisJRFJNX0RFVl9ERUJVR19EUklW
RVIoZGV2LCAiZHJtIGRpc2FibGVcbiIpOworCW11dGV4X2xvY2soJmN0eC0+bG9jayk7CisKKwlh
bng3NjI1X2RwX3N0b3AoY3R4KTsKKworCWlmIChjdHgtPnBkYXRhLmludGVybmFsX3BhbmVsICYm
CisJICAgIGN0eC0+cGRhdGEubG93X3Bvd2VyX21vZGUgJiYKKwkgICAgKGF0b21pY19yZWFkKCZj
dHgtPnBvd2VyX3N0YXR1cykpKSB7CisJCWFueDc2MjVfc3RvcF9kcF93b3JrKGN0eCk7CisJCWFu
eDc2MjVfcG93ZXJfc3RhbmRieShjdHgpOworCQlhdG9taWNfc2V0KCZjdHgtPnBvd2VyX3N0YXR1
cywgMCk7CisJfQorCisJbXV0ZXhfdW5sb2NrKCZjdHgtPmxvY2spOworfQorCitzdGF0aWMgY29u
c3Qgc3RydWN0IGRybV9icmlkZ2VfZnVuY3MgYW54NzYyNV9icmlkZ2VfZnVuY3MgPSB7CisJLmF0
dGFjaCA9IGFueDc2MjVfYnJpZGdlX2F0dGFjaCwKKwkuZGlzYWJsZSA9IGFueDc2MjVfYnJpZGdl
X2Rpc2FibGUsCisJLm1vZGVfdmFsaWQgPSBhbng3NjI1X2JyaWRnZV9tb2RlX3ZhbGlkLAorCS5t
b2RlX3NldCA9IGFueDc2MjVfYnJpZGdlX21vZGVfc2V0LAorCS5lbmFibGUgPSBhbng3NjI1X2Jy
aWRnZV9lbmFibGUsCit9OworCitzdGF0aWMgaW50IGFueDc2MjVfcmVnaXN0ZXJfaTJjX2R1bW15
X2NsaWVudHMoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAorCQkJCQkgICAgICBzdHJ1Y3QgaTJj
X2NsaWVudCAqY2xpZW50KQoreworCWN0eC0+aTJjLnR4X3AwX2NsaWVudCA9IGkyY19uZXdfZHVt
bXkoY2xpZW50LT5hZGFwdGVyLAorCQkJCQkgICAgICBUWF9QMF9BRERSID4+IDEpOworCWN0eC0+
aTJjLnR4X3AxX2NsaWVudCA9IGkyY19uZXdfZHVtbXkoY2xpZW50LT5hZGFwdGVyLAorCQkJCQkg
ICAgICBUWF9QMV9BRERSID4+IDEpOworCWN0eC0+aTJjLnR4X3AyX2NsaWVudCA9IGkyY19uZXdf
ZHVtbXkoY2xpZW50LT5hZGFwdGVyLAorCQkJCQkgICAgICBUWF9QMl9BRERSID4+IDEpOworCisJ
Y3R4LT5pMmMucnhfcDBfY2xpZW50ID0gaTJjX25ld19kdW1teShjbGllbnQtPmFkYXB0ZXIsCisJ
CQkJCSAgICAgIFJYX1AwX0FERFIgPj4gMSk7CisJY3R4LT5pMmMucnhfcDFfY2xpZW50ID0gaTJj
X25ld19kdW1teShjbGllbnQtPmFkYXB0ZXIsCisJCQkJCSAgICAgIFJYX1AxX0FERFIgPj4gMSk7
CisJY3R4LT5pMmMucnhfcDJfY2xpZW50ID0gaTJjX25ld19kdW1teShjbGllbnQtPmFkYXB0ZXIs
CisJCQkJCSAgICAgIFJYX1AyX0FERFIgPj4gMSk7CisKKwljdHgtPmkyYy50Y3BjX2NsaWVudCA9
IGkyY19uZXdfZHVtbXkoY2xpZW50LT5hZGFwdGVyLAorCQkJCQkgICAgIFRDUENfSU5URVJGQUNF
X0FERFIgPj4gMSk7CisKKwlpZiAoKCFjdHgtPmkyYy50eF9wMF9jbGllbnQgfAorCSAgICAgIWN0
eC0+aTJjLnR4X3AxX2NsaWVudCB8CisJICAgICAhY3R4LT5pMmMudHhfcDJfY2xpZW50IHwKKwkg
ICAgICFjdHgtPmkyYy5yeF9wMF9jbGllbnQgfAorCSAgICAgIWN0eC0+aTJjLnJ4X3AxX2NsaWVu
dCB8CisJICAgICAhY3R4LT5pMmMucnhfcDJfY2xpZW50IHwKKwkgICAgICFjdHgtPmkyYy50Y3Bj
X2NsaWVudCkgIT0gMCkKKwkJcmV0dXJuIDE7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZv
aWQgYW54NzYyNV91bnJlZ2lzdGVyX2kyY19kdW1teV9jbGllbnRzKHN0cnVjdCBhbng3NjI1X2Rh
dGEgKmN0eCkKK3sKKwlpMmNfdW5yZWdpc3Rlcl9kZXZpY2UoY3R4LT5pMmMudHhfcDBfY2xpZW50
KTsKKwlpMmNfdW5yZWdpc3Rlcl9kZXZpY2UoY3R4LT5pMmMudHhfcDFfY2xpZW50KTsKKwlpMmNf
dW5yZWdpc3Rlcl9kZXZpY2UoY3R4LT5pMmMudHhfcDJfY2xpZW50KTsKKwlpMmNfdW5yZWdpc3Rl
cl9kZXZpY2UoY3R4LT5pMmMucnhfcDFfY2xpZW50KTsKKwlpMmNfdW5yZWdpc3Rlcl9kZXZpY2Uo
Y3R4LT5pMmMucnhfcDJfY2xpZW50KTsKKwlpMmNfdW5yZWdpc3Rlcl9kZXZpY2UoY3R4LT5pMmMu
cnhfcDNfY2xpZW50KTsKKwlpMmNfdW5yZWdpc3Rlcl9kZXZpY2UoY3R4LT5pMmMudGNwY19jbGll
bnQpOworfQorCitzdGF0aWMgaW50IGFueDc2MjVfaTJjX3Byb2JlKHN0cnVjdCBpMmNfY2xpZW50
ICpjbGllbnQsCisJCQkgICAgIGNvbnN0IHN0cnVjdCBpMmNfZGV2aWNlX2lkICppZCkKK3sKKwlz
dHJ1Y3QgYW54NzYyNV9kYXRhICpwbGF0Zm9ybTsKKwlzdHJ1Y3QgYW54NzYyNV9wbGF0Zm9ybV9k
YXRhICpwZGF0YTsKKwlpbnQgcmV0ID0gMDsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY2xpZW50
LT5kZXY7CisKKwlpZiAoIWkyY19jaGVja19mdW5jdGlvbmFsaXR5KGNsaWVudC0+YWRhcHRlciwK
KwkJCQkgICAgIEkyQ19GVU5DX1NNQlVTX0kyQ19CTE9DSykpIHsKKwkJRFJNX0RFVl9FUlJPUihk
ZXYsICJhbng3NjI1J3MgaTJjIGJ1cyBkb2Vzbid0IHN1cHBvcnRcbiIpOworCQlyZXQgPSAtRU5P
REVWOworCQlnb3RvIGV4aXQ7CisJfQorCisJcGxhdGZvcm0gPSBremFsbG9jKHNpemVvZigqcGxh
dGZvcm0pLCBHRlBfS0VSTkVMKTsKKwlpZiAoIXBsYXRmb3JtKSB7CisJCURSTV9ERVZfRVJST1Io
ZGV2LCAiZmFpbGVkIHRvIGFsbG9jYXRlIGRyaXZlciBkYXRhXG4iKTsKKwkJcmV0ID0gLUVOT01F
TTsKKwkJZ290byBleGl0OworCX0KKworCXBkYXRhID0gJnBsYXRmb3JtLT5wZGF0YTsKKworCS8q
IGRldmljZSB0cmVlIHBhcnNpbmcgZnVuY3Rpb24gY2FsbCAqLworCXJldCA9IGFueDc2MjVfcGFy
c2VfZHQoJmNsaWVudC0+ZGV2LCBwZGF0YSk7CisJaWYgKHJldCAhPSAwKQkvKiBpZiBvY2N1cnMg
ZXJyb3IgKi8KKwkJZ290byBlcnIwOworCisJLyogdG8gYWNjZXNzIGdsb2JhbCBwbGF0Zm9ybSBk
YXRhICovCisJcGxhdGZvcm0tPmNsaWVudCA9IGNsaWVudDsKKwlpMmNfc2V0X2NsaWVudGRhdGEo
Y2xpZW50LCBwbGF0Zm9ybSk7CisKKwlpZiAocGxhdGZvcm0tPnBkYXRhLmV4dGNvbl9zdXBwb3J0
ZWQpIHsKKwkJLyogZ2V0IGV4dGNvbiBkZXZpY2UgZnJvbSBEVFMgKi8KKwkJcGxhdGZvcm0tPmV4
dGNvbiA9IGV4dGNvbl9nZXRfZWRldl9ieV9waGFuZGxlKCZjbGllbnQtPmRldiwgMCk7CisJCWlm
IChQVFJfRVJSKHBsYXRmb3JtLT5leHRjb24pID09IC1FUFJPQkVfREVGRVIpCisJCQlnb3RvIGVy
cjA7CisJCWlmIChJU19FUlIocGxhdGZvcm0tPmV4dGNvbikpIHsKKwkJCURSTV9ERVZfRVJST1Io
JmNsaWVudC0+ZGV2LAorCQkJCSAgICAgICJjYW4gbm90IGdldCBleHRjb24gZGV2aWNlISIpOwor
CQkJZ290byBlcnIwOworCQl9CisKKwkJcmV0ID0gYW54NzYyNV9leHRjb25fbm90aWZpZXJfaW5p
dChwbGF0Zm9ybSk7CisJCWlmIChyZXQgPCAwKQorCQkJZ290byBlcnIwOworCX0KKworCWF0b21p
Y19zZXQoJnBsYXRmb3JtLT5wb3dlcl9zdGF0dXMsIDApOworCisJbXV0ZXhfaW5pdCgmcGxhdGZv
cm0tPmxvY2spOworCisJcmV0ID0gYW54NzYyNV9pbml0X2dwaW8ocGxhdGZvcm0pOworCWlmIChy
ZXQpIHsKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJmYWlsZWQgdG8gaW5pdGlhbGl6ZSBncGlvXG4i
KTsKKwkJZ290byBlcnIwOworCX0KKworCUlOSVRfV09SSygmcGxhdGZvcm0tPndvcmssIGFueDc2
MjVfd29ya19mdW5jKTsKKworCXBsYXRmb3JtLT53b3JrcXVldWUgPSBjcmVhdGVfd29ya3F1ZXVl
KCJhbng3NjI1X3dvcmsiKTsKKwlpZiAoIXBsYXRmb3JtLT53b3JrcXVldWUpIHsKKwkJRFJNX0RF
Vl9FUlJPUihkZXYsICJmYWlsZWQgdG8gY3JlYXRlIHdvcmsgcXVldWVcbiIpOworCQlyZXQgPSAt
RU5PTUVNOworCQlnb3RvIGVycjE7CisJfQorCisJaWYgKHBsYXRmb3JtLT5wZGF0YS5ncGlvX2lu
dHJfaHBkKSB7CisJCXBsYXRmb3JtLT5wZGF0YS5ocGRfaXJxID0KKwkJCWdwaW9fdG9faXJxKHBs
YXRmb3JtLT5wZGF0YS5ncGlvX2ludHJfaHBkKTsKKwkJaWYgKHBsYXRmb3JtLT5wZGF0YS5ocGRf
aXJxIDwgMCkgeworCQkJRFJNX0RFVl9FUlJPUihkZXYsICJmYWlsZWQgdG8gZ2V0IGdwaW8gaXJx
XG4iKTsKKwkJCWdvdG8gZXJyMTsKKwkJfQorCisJCXJldCA9IHJlcXVlc3RfdGhyZWFkZWRfaXJx
KHBsYXRmb3JtLT5wZGF0YS5ocGRfaXJxLAorCQkJCQkgICBOVUxMLCBhbng3NjI1X2ludHJfaHBk
X2lzciwKKwkJCQkJICAgSVJRRl9UUklHR0VSX0ZBTExJTkcgfAorCQkJCQkgICBJUlFGX1RSSUdH
RVJfUklTSU5HIHwKKwkJCQkJICAgSVJRRl9PTkVTSE9ULAorCQkJCQkgICAiYW54NzYyNS1ocGQi
LCBwbGF0Zm9ybSk7CisJCWlmIChyZXQgPCAwKSB7CisJCQlEUk1fREVWX0VSUk9SKGRldiwgImZh
aWxlZCB0byByZXF1ZXN0IGlycVxuIik7CisJCQlnb3RvIGVycjI7CisJCX0KKworCQlyZXQgPSBp
cnFfc2V0X2lycV93YWtlKHBsYXRmb3JtLT5wZGF0YS5ocGRfaXJxLCAxKTsKKwkJaWYgKHJldCA8
IDApIHsKKwkJCURSTV9ERVZfRVJST1IoZGV2LCAiUmVxdWVzdCBpcnEgZm9yIGhwZCIpOworCQkJ
RFJNX0RFVl9FUlJPUihkZXYsICJpbnRlcnJ1cHQgd2FrZSBzZXQgZmFpbFxuIik7CisJCQlnb3Rv
IGVycjI7CisJCX0KKworCQlyZXQgPSBlbmFibGVfaXJxX3dha2UocGxhdGZvcm0tPnBkYXRhLmhw
ZF9pcnEpOworCQlpZiAocmV0IDwgMCkgeworCQkJRFJNX0RFVl9FUlJPUihkZXYsICJFbmFibGUg
aXJxIGZvciBIUEQiKTsKKwkJCURSTV9ERVZfRVJST1IoZGV2LCAiaW50ZXJydXB0IHdha2UgZW5h
YmxlIGZhaWxcbiIpOworCQkJZ290byBlcnIyOworCQl9CisJfQorCisJaWYgKGFueDc2MjVfcmVn
aXN0ZXJfaTJjX2R1bW15X2NsaWVudHMocGxhdGZvcm0sIGNsaWVudCkgIT0gMCkgeworCQlyZXQg
PSAtRU5PTUVNOworCQlEUk1fRVJST1IoIkZhaWxlZCB0byByZXNlcnZlIEkyQyBidXMuXG4iKTsK
KwkJZ290byBlcnIzOworCX0KKworCWlmIChwbGF0Zm9ybS0+cGRhdGEubG93X3Bvd2VyX21vZGUg
PT0gMCkgeworCQlhbng3NjI1X2Rpc2FibGVfcGRfcHJvdG9jb2wocGxhdGZvcm0pOworCQlhdG9t
aWNfc2V0KCZwbGF0Zm9ybS0+cG93ZXJfc3RhdHVzLCAxKTsKKwl9CisKKwkvKiBhZGQgd29yayBm
dW5jdGlvbiAqLworCXF1ZXVlX3dvcmsocGxhdGZvcm0tPndvcmtxdWV1ZSwgJnBsYXRmb3JtLT53
b3JrKTsKKworCXBsYXRmb3JtLT5icmlkZ2UuZnVuY3MgPSAmYW54NzYyNV9icmlkZ2VfZnVuY3M7
CisjaWYgSVNfRU5BQkxFRChDT05GSUdfT0YpCisJcGxhdGZvcm0tPmJyaWRnZS5vZl9ub2RlID0g
Y2xpZW50LT5kZXYub2Zfbm9kZTsKKyNlbmRpZgorCWRybV9icmlkZ2VfYWRkKCZwbGF0Zm9ybS0+
YnJpZGdlKTsKKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgInByb2JlIGRvbmVcbiIpOwor
CWdvdG8gZXhpdDsKKworZXJyMzoKKwlhbng3NjI1X3VucmVnaXN0ZXJfaTJjX2R1bW15X2NsaWVu
dHMocGxhdGZvcm0pOworZXJyMjoKKwlpZiAocGxhdGZvcm0tPnBkYXRhLmdwaW9faW50cl9ocGQp
CisJCWZyZWVfaXJxKHBsYXRmb3JtLT5wZGF0YS5ocGRfaXJxLCBwbGF0Zm9ybSk7CitlcnIxOgor
CWFueDc2MjVfZnJlZV9ncGlvKHBsYXRmb3JtKTsKKwlkZXN0cm95X3dvcmtxdWV1ZShwbGF0Zm9y
bS0+d29ya3F1ZXVlKTsKK2VycjA6CisJa2ZyZWUocGxhdGZvcm0pOworZXhpdDoKKwlyZXR1cm4g
cmV0OworfQorCitzdGF0aWMgaW50IGFueDc2MjVfaTJjX3JlbW92ZShzdHJ1Y3QgaTJjX2NsaWVu
dCAqY2xpZW50KQoreworCXN0cnVjdCBhbng3NjI1X2RhdGEgKnBsYXRmb3JtID0gaTJjX2dldF9j
bGllbnRkYXRhKGNsaWVudCk7CisKKwlkcm1fYnJpZGdlX3JlbW92ZSgmcGxhdGZvcm0tPmJyaWRn
ZSk7CisKKwlpZiAocGxhdGZvcm0tPnBkYXRhLmdwaW9faW50cl9ocGQpCisJCWZyZWVfaXJxKHBs
YXRmb3JtLT5wZGF0YS5ocGRfaXJxLCBwbGF0Zm9ybSk7CisKKwlkZXN0cm95X3dvcmtxdWV1ZShw
bGF0Zm9ybS0+d29ya3F1ZXVlKTsKKworCWlmIChwbGF0Zm9ybS0+cGRhdGEuZXh0Y29uX3N1cHBv
cnRlZCkgeworCQlkZXZtX2V4dGNvbl91bnJlZ2lzdGVyX25vdGlmaWVyKCZwbGF0Zm9ybS0+Y2xp
ZW50LT5kZXYsCisJCQkJCQlwbGF0Zm9ybS0+ZXh0Y29uLAorCQkJCQkJRVhUQ09OX0RJU1BfRFAs
CisJCQkJCQkmcGxhdGZvcm0tPmV2ZW50X25iKTsKKwkJZmx1c2hfd29yaygmcGxhdGZvcm0tPmV4
dGNvbl93cSk7CisJfQorCisJYW54NzYyNV9kZXRhY2hfZHNpKHBsYXRmb3JtKTsKKworCWlmIChw
bGF0Zm9ybS0+YnJpZGdlX2F0dGFjaGVkKQorCQlkcm1fY29ubmVjdG9yX3VucmVnaXN0ZXIoJnBs
YXRmb3JtLT5jb25uZWN0b3IpOworCisJYW54NzYyNV91bnJlZ2lzdGVyX2kyY19kdW1teV9jbGll
bnRzKHBsYXRmb3JtKTsKKworCWFueDc2MjVfZnJlZV9ncGlvKHBsYXRmb3JtKTsKKworCWtmcmVl
KHBsYXRmb3JtKTsKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBpMmNfZGV2
aWNlX2lkIGFueDc2MjVfaWRbXSA9IHsKKwl7ImFueDc2MjUiLCAwfSwKKwl7fQorfTsKKworTU9E
VUxFX0RFVklDRV9UQUJMRShpMmMsIGFueDc2MjVfaWQpOworCisjaWZkZWYgQ09ORklHX09GCitz
dGF0aWMgY29uc3Qgc3RydWN0IG9mX2RldmljZV9pZCBhbnhfbWF0Y2hfdGFibGVbXSA9IHsKKwl7
LmNvbXBhdGlibGUgPSAiYW5hbG9naXgsYW54NzYyNSIsfSwKKwl7fSwKK307CisjZW5kaWYKKwor
c3RhdGljIHN0cnVjdCBpMmNfZHJpdmVyIGFueDc2MjVfZHJpdmVyID0geworCS5kcml2ZXIgPSB7
CisJCS5uYW1lID0gImFueDc2MjUiLAorI2lmZGVmIENPTkZJR19PRgorCQkub2ZfbWF0Y2hfdGFi
bGUgPSBhbnhfbWF0Y2hfdGFibGUsCisjZW5kaWYKKwl9LAorCS5wcm9iZSA9IGFueDc2MjVfaTJj
X3Byb2JlLAorCS5yZW1vdmUgPSBhbng3NjI1X2kyY19yZW1vdmUsCisKKwkuaWRfdGFibGUgPSBh
bng3NjI1X2lkLAorfTsKKworbW9kdWxlX2kyY19kcml2ZXIoYW54NzYyNV9kcml2ZXIpOworCitN
T0RVTEVfREVTQ1JJUFRJT04oIk1JUEkyRFAgYW54NzYyNSBkcml2ZXIiKTsKK01PRFVMRV9BVVRI
T1IoIlhpbiBKaSA8eGppQGFuYWxvZ2l4c2VtaS5jb20+Iik7CitNT0RVTEVfTElDRU5TRSgiR1BM
IHYyIik7CitNT0RVTEVfVkVSU0lPTihBTlg3NjI1X0RSVl9WRVJTSU9OKTsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvYW54NzYyNS5oIGIvZHJpdmVycy9ncHUv
ZHJtL2JyaWRnZS9hbmFsb2dpeC9hbng3NjI1LmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXgg
MDAwMDAwMC4uZWUyYzg4MwotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9icmlk
Z2UvYW5hbG9naXgvYW54NzYyNS5oCkBAIC0wLDAgKzEsNDA1IEBACisvKiBTUERYLUxpY2Vuc2Ut
SWRlbnRpZmllcjogR1BMLTIuMC1vbmx5ICovCisvKgorICogQ29weXJpZ2h0KGMpIDIwMTYsIEFu
YWxvZ2l4IFNlbWljb25kdWN0b3IuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCisgKgorICovCisKKyNp
Zm5kZWYgX19BTlg3NjI1X0hfXworI2RlZmluZSBfX0FOWDc2MjVfSF9fCisKKyNpZm5kZWYgTE9H
X1RBRworI2RlZmluZSBMT0dfVEFHICJhbng3NjI1ZHAiCisjZW5kaWYKKworI2RlZmluZSBBTlg3
NjI1X0RSVl9WRVJTSU9OICIwLjEuMDQiCisKKy8qIExvYWRpbmcgT0NNIHJlLXRyeWluZyB0aW1l
cyAqLworI2RlZmluZSBPQ01fTE9BRElOR19USU1FIDEwCisKKy8qKioqKioqKiogIEFOWDc2MjUg
UmVnaXN0ZXIgICoqKioqKioqKiovCisjZGVmaW5lIFRYX1AwX0FERFIJCQkJMHg3MAorI2RlZmlu
ZSBUWF9QMV9BRERSCQkJCTB4N0EKKyNkZWZpbmUgVFhfUDJfQUREUgkJCQkweDcyCisKKyNkZWZp
bmUgUlhfUDBfQUREUgkJCQkweDdlCisjZGVmaW5lIFJYX1AxX0FERFIJCQkJMHg4NAorI2RlZmlu
ZSBSWF9QMl9BRERSCQkJCTB4NTQKKworI2RlZmluZSBSU1ZEXzAwX0FERFIJCQkJMHgwMAorI2Rl
ZmluZSBSU1ZEX0QxX0FERFIJCQkJMHhEMQorI2RlZmluZSBSU1ZEXzYwX0FERFIJCQkJMHg2MAor
I2RlZmluZSBSU1ZEXzM5X0FERFIJCQkJMHgzOQorI2RlZmluZSBSU1ZEXzdGX0FERFIJCQkJMHg3
RgorCisjZGVmaW5lIFRDUENfSU5URVJGQUNFX0FERFIJCQkweDU4CisKKy8qIGFueDc2MjUgY2xv
Y2sgZnJlcXVlbmN5IGluIEh6ICovCisjZGVmaW5lIFhUQUxfRlJRICAgICAgICAoMjcgKiAxMDAw
MDAwKQorCisjZGVmaW5lICBQT1NUX0RJVklERVJfTUlOCTEKKyNkZWZpbmUgIFBPU1RfRElWSURF
Ul9NQVgJMTYKKyNkZWZpbmUgIFBMTF9PVVRfRlJFUV9NSU4JNTIwMDAwMDAwVUwKKyNkZWZpbmUg
IFBMTF9PVVRfRlJFUV9NQVgJNzMwMDAwMDAwVUwKKyNkZWZpbmUgIFBMTF9PVVRfRlJFUV9BQlNf
TUlOCTMwMDAwMDAwMFVMCisjZGVmaW5lICBQTExfT1VUX0ZSRVFfQUJTX01BWAk4MDAwMDAwMDBV
TAorI2RlZmluZSAgTUFYX1VOU0lHTkVEXzI0QklUCTE2Nzc3MjE1VUwKKworLyoqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KKy8q
IFJlZ2lzdGVyIGRlZmluaXRpb24gb2YgZGV2aWNlIGFkZHJlc3MgMHg1OCAqLworCisjZGVmaW5l
IFBST0RVQ1RfSURfTCAweDAyCisjZGVmaW5lIFBST0RVQ1RfSURfSCAweDAzCisKKyNkZWZpbmUg
SU5UUl9BTEVSVF8xICAweENDCisjZGVmaW5lIElOVFJfU09GVFdBUkVfSU5UIEJJVCgzKQorI2Rl
ZmluZSBJTlRSX1JFQ0VJVkVEX01TRyBCSVQoNSkKKworI2RlZmluZSBTWVNURU1fU1RTVFVTIDB4
NDUKKyNkZWZpbmUgSU5URVJGQUNFX0NIQU5HRV9JTlQgMHg0NAorI2RlZmluZSBIUERfU1RBVFVT
X0NIQU5HRSAweDgwCisjZGVmaW5lIEhQRF9TVEFUVVMgMHg4MAorCisvKioqKioqKiogRU5EIG9m
IEkyQyBBZGRyZXNzIDB4NTggKioqKioqKiovCisKKy8qKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCisvKiBSZWdpc3RlciBkZWZp
bml0aW9uIG9mIGRldmljZSBhZGRyZXNzIDB4NzAgKi8KKyNkZWZpbmUgIEkyQ19BRERSXzcwX0RQ
VFggICAgICAgICAgICAgIDB4NzAKKworI2RlZmluZSBTUF9UWF9MSU5LX0JXX1NFVF9SRUcgMHhB
MAorI2RlZmluZSBTUF9UWF9MQU5FX0NPVU5UX1NFVF9SRUcgMHhBMQorCisjZGVmaW5lIE1fVklE
XzAgMHhDMAorI2RlZmluZSBNX1ZJRF8xIDB4QzEKKyNkZWZpbmUgTV9WSURfMiAweEMyCisjZGVm
aW5lIE5fVklEXzAgMHhDMworI2RlZmluZSBOX1ZJRF8xIDB4QzQKKyNkZWZpbmUgTl9WSURfMiAw
eEM1CisKKy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKiovCisvKiBSZWdpc3RlciBkZWZpbml0aW9uIG9mIGRldmljZSBhZGRyZXNz
IDB4NzIgKi8KKyNkZWZpbmUgQVVYX1JTVAkweDA0CisjZGVmaW5lIFJTVF9DVFJMMiAweDA3CisK
KyNkZWZpbmUgU1BfVFhfVE9UQUxfTElORV9TVEFfTCAweDI0CisjZGVmaW5lIFNQX1RYX1RPVEFM
X0xJTkVfU1RBX0ggMHgyNQorI2RlZmluZSBTUF9UWF9BQ1RfTElORV9TVEFfTCAweDI2CisjZGVm
aW5lIFNQX1RYX0FDVF9MSU5FX1NUQV9IIDB4MjcKKyNkZWZpbmUgU1BfVFhfVl9GX1BPUkNIX1NU
QSAweDI4CisjZGVmaW5lIFNQX1RYX1ZfU1lOQ19TVEEgMHgyOQorI2RlZmluZSBTUF9UWF9WX0Jf
UE9SQ0hfU1RBIDB4MkEKKyNkZWZpbmUgU1BfVFhfVE9UQUxfUElYRUxfU1RBX0wgMHgyQgorI2Rl
ZmluZSBTUF9UWF9UT1RBTF9QSVhFTF9TVEFfSCAweDJDCisjZGVmaW5lIFNQX1RYX0FDVF9QSVhF
TF9TVEFfTCAweDJECisjZGVmaW5lIFNQX1RYX0FDVF9QSVhFTF9TVEFfSCAweDJFCisjZGVmaW5l
IFNQX1RYX0hfRl9QT1JDSF9TVEFfTCAweDJGCisjZGVmaW5lIFNQX1RYX0hfRl9QT1JDSF9TVEFf
SCAweDMwCisjZGVmaW5lIFNQX1RYX0hfU1lOQ19TVEFfTCAweDMxCisjZGVmaW5lIFNQX1RYX0hf
U1lOQ19TVEFfSCAweDMyCisjZGVmaW5lIFNQX1RYX0hfQl9QT1JDSF9TVEFfTCAweDMzCisjZGVm
aW5lIFNQX1RYX0hfQl9QT1JDSF9TVEFfSCAweDM0CisKKyNkZWZpbmUgU1BfVFhfVklEX0NUUkwg
MHg4NAorI2RlZmluZSBTUF9UWF9CUENfTUFTSyAweEUwCisjZGVmaW5lIFNQX1RYX0JQQ182ICAg
IDB4MDAKKyNkZWZpbmUgU1BfVFhfQlBDXzggICAgMHgyMAorI2RlZmluZSBTUF9UWF9CUENfMTAg
ICAweDQwCisjZGVmaW5lIFNQX1RYX0JQQ18xMiAgIDB4NjAKKworI2RlZmluZSBWSURFT19CSVRf
TUFUUklYXzEyIDB4NGMKKworI2RlZmluZSBBVURJT19DSEFOTkVMX1NUQVRVU18xIDB4ZDAKKyNk
ZWZpbmUgQVVESU9fQ0hBTk5FTF9TVEFUVVNfMiAweGQxCisjZGVmaW5lIEFVRElPX0NIQU5ORUxf
U1RBVFVTXzMgMHhkMgorI2RlZmluZSBBVURJT19DSEFOTkVMX1NUQVRVU180IDB4ZDMKKyNkZWZp
bmUgQVVESU9fQ0hBTk5FTF9TVEFUVVNfNSAweGQ0CisjZGVmaW5lIEFVRElPX0NIQU5ORUxfU1RB
VFVTXzYgMHhkNQorI2RlZmluZSBURE1fU0xBVkVfTU9ERSAweDEwCisjZGVmaW5lIEkyU19TTEFW
RV9NT0RFIDB4MDgKKworI2RlZmluZSBBVURJT19DT05UUk9MX1JFR0lTVEVSIDB4ZTYKKyNkZWZp
bmUgVERNX1RJTUlOR19NT0RFIDB4MDgKKworI2RlZmluZSAgSTJDX0FERFJfNzJfRFBUWCAgICAg
ICAgICAgICAgMHg3MgorCisjZGVmaW5lICBWSURFT19DT05UUk9MXzAgIDB4MDgKKworI2RlZmlu
ZSAgQUNUSVZFX0xJTkVTX0wgICAgICAgICAweDE0CisjZGVmaW5lICBBQ1RJVkVfTElORVNfSCAg
ICAgICAgIDB4MTUgIC8qIG5vdGU6IGJpdFs3OjZdIGFyZSByZXNlcnZlZCAqLworI2RlZmluZSAg
VkVSVElDQUxfRlJPTlRfUE9SQ0ggICAweDE2CisjZGVmaW5lICBWRVJUSUNBTF9TWU5DX1dJRFRI
ICAgIDB4MTcKKyNkZWZpbmUgIFZFUlRJQ0FMX0JBQ0tfUE9SQ0ggICAgMHgxOAorCisjZGVmaW5l
ICBIT1JJWk9OVEFMX1RPVEFMX1BJWEVMU19MICAgIDB4MTkKKyNkZWZpbmUgIEhPUklaT05UQUxf
VE9UQUxfUElYRUxTX0ggICAgMHgxQSAgLyogbm90ZTogYml0Wzc6Nl0gYXJlIHJlc2VydmVkICov
CisjZGVmaW5lICBIT1JJWk9OVEFMX0FDVElWRV9QSVhFTFNfTCAgIDB4MUIKKyNkZWZpbmUgIEhP
UklaT05UQUxfQUNUSVZFX1BJWEVMU19IICAgMHgxQyAgLyogbm90ZTogYml0Wzc6Nl0gYXJlIHJl
c2VydmVkICovCisjZGVmaW5lICBIT1JJWk9OVEFMX0ZST05UX1BPUkNIX0wgICAgIDB4MUQKKyNk
ZWZpbmUgIEhPUklaT05UQUxfRlJPTlRfUE9SQ0hfSCAgICAgMHgxRSAgLyogbm90ZTogYml0Wzc6
NF0gYXJlIHJlc2VydmVkICovCisjZGVmaW5lICBIT1JJWk9OVEFMX1NZTkNfV0lEVEhfTCAgICAg
IDB4MUYKKyNkZWZpbmUgIEhPUklaT05UQUxfU1lOQ19XSURUSF9IICAgICAgMHgyMCAgLyogbm90
ZTogYml0Wzc6NF0gYXJlIHJlc2VydmVkICovCisjZGVmaW5lICBIT1JJWk9OVEFMX0JBQ0tfUE9S
Q0hfTCAgICAgIDB4MjEKKyNkZWZpbmUgIEhPUklaT05UQUxfQkFDS19QT1JDSF9IICAgICAgMHgy
MiAgLyogbm90ZTogYml0Wzc6NF0gYXJlIHJlc2VydmVkICovCisKKy8qKioqKioqKiBFTkQgb2Yg
STJDIEFkZHJlc3MgMHg3MiAqKioqKioqKiovCisvKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLworLyogUmVnaXN0ZXIgZGVmaW5p
dGlvbiBvZiBkZXZpY2UgYWRkcmVzcyAweDdlICovCisKKyNkZWZpbmUgIEkyQ19BRERSXzdFX0ZM
QVNIX0NPTlRST0xMRVIgIDB4N0UKKworI2RlZmluZSBGTEFTSF9MT0FEX1NUQSAweDA1CisjZGVm
aW5lIEZMQVNIX0xPQURfU1RBX0NISwlCSVQoNykKKworI2RlZmluZSAgWFRBTF9GUlFfU0VMICAg
IDB4M0YKKy8qIGJpdCBmaWVsZCBwb3NpdGlvbnMgKi8KKyNkZWZpbmUgIFhUQUxfRlJRX1NFTF9Q
T1MgICAgNQorLyogYml0IGZpZWxkIHZhbHVlcyAqLworI2RlZmluZSAgWFRBTF9GUlFfMTlNMiAg
ICgwIDw8IFhUQUxfRlJRX1NFTF9QT1MpCisjZGVmaW5lICBYVEFMX0ZSUV8yN00gICAgKDQgPDwg
WFRBTF9GUlFfU0VMX1BPUykKKworI2RlZmluZSAgUl9EU0NfQ1RSTF8wICAgIDB4NDAKKyNkZWZp
bmUgIFJFQURfU1RBVFVTX0VOICA3CisjZGVmaW5lICBDTEtfMU1FR19SQiAgICAgNiAgLyogMU1I
eiBjbG9jayByZXNldDsgMD1yZXNldCwgMD1yZXNldCByZWxlYXNlICovCisjZGVmaW5lICBEU0Nf
QklTVF9ET05FICAgMSAgLyogYml0WzU6MV06IDE9RFNDIE1CSVNUIHBhc3MgKi8KKyNkZWZpbmUg
IERTQ19FTiAgICAgICAgICAweDAxICAvKiAxPURTQyBlbmFibGVkLCAwPURTQyBkaXNhYmxlZCAq
LworCisjZGVmaW5lIE9DTV9GV19WRVJTSU9OICAgMHgzMQorI2RlZmluZSBPQ01fRldfUkVWRVJT
SU9OIDB4MzIKKworI2RlZmluZSBBUF9BVVhfQUREUl83XzAgICAweDExCisjZGVmaW5lIEFQX0FV
WF9BRERSXzE1XzggIDB4MTIKKyNkZWZpbmUgQVBfQVVYX0FERFJfMTlfMTYgMHgxMworCisvKiBu
b3RlOiBiaXRbMDozXSBBVVggc3RhdHVzLCBiaXQgNCBvcF9lbiwgYml0IDUgYWRkcmVzcyBvbmx5
ICovCisjZGVmaW5lIEFQX0FVWF9DVFJMX1NUQVRVUyAweDE0CisjZGVmaW5lIEFQX0FVWF9DVFJM
X09QX0VOIDB4MTAKKyNkZWZpbmUgQVBfQVVYX0NUUkxfQUREUk9OTFkgMHgyMAorCisjZGVmaW5l
IEFQX0FVWF9CVUZGX1NUQVJUIDB4MTUKKyNkZWZpbmUgUElYRUxfQ0xPQ0tfTCAweDI1CisjZGVm
aW5lIFBJWEVMX0NMT0NLX0ggMHgyNgorCisjZGVmaW5lIEFQX0FVWF9DT01NQU5EIDB4MjcgIC8q
IGNvbStsZW4gKi8KKy8qIGJpdCAwJjE6IDNEIHZpZGVvIHN0cnVjdHVyZSAqLworLyogMHgwMTog
ZnJhbWUgcGFja2luZywgIDB4MDI6TGluZSBhbHRlcm5hdGl2ZSwgMHgwMzpTaWRlLWJ5LXNpZGUo
ZnVsbCkgKi8KKyNkZWZpbmUgQVBfQVZfU1RBVFVTIDB4MjgKKyNkZWZpbmUgQVBfVklERU9fQ0hH
ICBCSVQoMikKKyNkZWZpbmUgQVBfQVVESU9fQ0hHICBCSVQoMykKKyNkZWZpbmUgQVBfTUlQSV9N
VVRFICBCSVQoNCkgLyogMTpNSVBJIGlucHV0IG11dGUsIDA6IHVtbXV0ZSAqLworI2RlZmluZSBB
UF9NSVBJX1JYX0VOIEJJVCg1KSAvKiAxOiBNSVBJIFJYIGlucHV0IGluICAwOiBubyBSWCBpbiAq
LworI2RlZmluZSBBUF9ESVNBQkxFX1BEIEJJVCg2KQorI2RlZmluZSBBUF9ESVNBQkxFX0RJU1BM
QVkgQklUKDcpCisvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqLworLyogUmVnaXN0ZXIgZGVmaW5pdGlvbiBvZiBkZXZpY2UgYWRk
cmVzcyAweDg0ICovCisjZGVmaW5lICBNSVBJX1BIWV9DT05UUk9MXzMgICAgICAgICAgICAweDAz
CisjZGVmaW5lICBNSVBJX0hTX1BXRF9DTEsgICAgICAgICAgICAgICA3CisjZGVmaW5lICBNSVBJ
X0hTX1JUX0NMSyAgICAgICAgICAgICAgICA2CisjZGVmaW5lICBNSVBJX1BEX0NMSyAgICAgICAg
ICAgICAgICAgICA1CisjZGVmaW5lICBNSVBJX0NMS19SVF9NQU5VQUxfUERfRU4gICAgICA0Cisj
ZGVmaW5lICBNSVBJX0NMS19IU19NQU5VQUxfUERfRU4gICAgICAzCisjZGVmaW5lICBNSVBJX0NM
S19ERVRfREVUX0JZUEFTUyAgICAgICAyCisjZGVmaW5lICBNSVBJX0NMS19NSVNTX0NUUkwgICAg
ICAgICAgICAxCisjZGVmaW5lICBNSVBJX1BEX0xQVFhfQ0hfTUFOVUFMX1BEX0VOICAwCisKKyNk
ZWZpbmUgIE1JUElfTEFORV9DVFJMXzAJCTB4MDUKKyNkZWZpbmUgIE1JUElfVElNRV9IU19QUlBS
CQkweDA4CisKKy8qIEFmdGVyIE1JUEkgUlggcHJvdG9jb2wgbGF5ZXIgcmVjZWl2ZWQgdGhpcyBt
YW55IHZpZGVvIGZyYW1lcywgKi8KKy8qIHByb3RvY29sIGxheWVyIHN0YXJ0cyB0byByZWNvbnN0
cnVjdCB2aWRlbyBzdHJlYW0gZnJvbSBQSFkgKi8KKyNkZWZpbmUgIE1JUElfVklERU9fU1RBQkxF
X0NOVCAgICAgICAgICAgMHgwQQorCisjZGVmaW5lICBNSVBJX0xBTkVfQ1RSTF8xMCAgICAgICAg
ICAgICAgIDB4MEYKKyNkZWZpbmUgIE1JUElfRElHSVRBTF9BREpfMSAgIDB4MUIKKworI2RlZmlu
ZSAgTUlQSV9QTExfTV9OVU1fMjNfMTYgICAweDFFCisjZGVmaW5lICBNSVBJX1BMTF9NX05VTV8x
NV84ICAgIDB4MUYKKyNkZWZpbmUgIE1JUElfUExMX01fTlVNXzdfMCAgICAgMHgyMAorI2RlZmlu
ZSAgTUlQSV9QTExfTl9OVU1fMjNfMTYgICAweDIxCisjZGVmaW5lICBNSVBJX1BMTF9OX05VTV8x
NV84ICAgIDB4MjIKKyNkZWZpbmUgIE1JUElfUExMX05fTlVNXzdfMCAgICAgMHgyMworCisjZGVm
aW5lICBNSVBJX0RJR0lUQUxfUExMXzYgICAgIDB4MkEKKy8qIGJpdFs3OjZdOiBWQ08gYmFuZCBj
b250cm9sLCBvbmx5IGVmZmVjdGl2ZSAqLworLyogd2hlbiBNSVBJX1BMTF9GT1JDRV9CQU5EX0VO
ICgweDg0OjB4MkJbNl0pIGlzIDEgKi8KKyNkZWZpbmUgIE1JUElfTV9OVU1fUkVBRFkgICAgICAg
IDB4MTAKKyNkZWZpbmUgIE1JUElfTl9OVU1fUkVBRFkgICAgICAgIDB4MDgKKyNkZWZpbmUgIFNU
QUJMRV9JTlRFR0VSX0NOVF9FTiAgIDB4MDQKKyNkZWZpbmUgIE1JUElfUExMX1RFU1RfQklUICAg
ICAgIDAKKy8qIGJpdFsxOjBdOiB0ZXN0IHBvaW50IG91dHB1dCBzZWxlY3QgLSAqLworLyogMDA6
IFZDTyBwb3dlciwgMDE6IGR2ZGRfcGR0LCAxMDogZHZkZCwgMTE6IHZjb3ggKi8KKworI2RlZmlu
ZSAgTUlQSV9ESUdJVEFMX1BMTF83ICAgICAgMHgyQgorI2RlZmluZSAgTUlQSV9QTExfRk9SQ0Vf
Tl9FTiAgICAgNworI2RlZmluZSAgTUlQSV9QTExfRk9SQ0VfQkFORF9FTiAgNgorCisjZGVmaW5l
ICBNSVBJX1BMTF9WQ09fVFVORV9SRUcgICA0CisvKiBiaXRbNTo0XTogVkNPIG1ldGFsIGNhcGFj
aXRhbmNlIC0gKi8KKy8qIDAwOiArMjAlIGZhc3QsIDAxOiArMTAlIGZhc3QgKGRlZmF1bHQpLCAx
MDogdHlwaWNhbCwgMTE6IC0xMCUgc2xvdyAqLworI2RlZmluZSAgTUlQSV9QTExfVkNPX1RVTkVf
UkVHX1ZBTCAgIDB4MzAKKworI2RlZmluZSAgTUlQSV9QTExfUExMX0xET19CSVQgICAgMgorLyog
Yml0WzM6Ml06IHZjb192MmkgcG93ZXIgLSAqLworLyogMDA6IDEuNDBWLCAwMTogMS40NVYgKGRl
ZmF1bHQpLCAxMDogMS41MFYsIDExOiAxLjU1ViAqLworI2RlZmluZSAgTUlQSV9QTExfUkVTRVRf
TiAgICAgICAgMHgwMgorI2RlZmluZSAgTUlQSV9GUlFfRk9SQ0VfTkRFVCAgICAgMAorCisjZGVm
aW5lICBNSVBJX0FMRVJUX0NMUl8wICAgICAgICAweDJECisjZGVmaW5lICBIU19saW5rX2Vycm9y
X2NsZWFyICAgICA3CisvKiBUaGlzIGJpdCBpdHNlbGYgaXMgUy9DLCBhbmQgaXQgY2xlYXJzIDB4
ODQ6MHgzMVs3XSAqLworCisjZGVmaW5lICBNSVBJX0FMRVJUX09VVF8wICAgICAgICAweDMxCisj
ZGVmaW5lICBjaGVja19zdW1fZXJyX2hzX3N5bmMgICA3CisvKiBUaGlzIGJpdCBpcyBjbGVhcmVk
IGJ5IDB4ODQ6MHgyRFs3XSAqLworCisjZGVmaW5lICBNSVBJX0RJR0lUQUxfUExMXzggICAgMHgz
MworI2RlZmluZSAgTUlQSV9QT1NUX0RJVl9WQUwgICAgIDQKKy8qIG4gbWVhbnMgZGl2aWRlZCBi
eSAobisxKSwgbiA9IDB+MTUgKi8KKyNkZWZpbmUgIE1JUElfRU5fTE9DS19GUlogICAgICAzCisj
ZGVmaW5lICBNSVBJX0ZSUV9DT1VOVEVSX1JTVCAgMgorI2RlZmluZSAgTUlQSV9GUlFfU0VUX1JF
R184ICAgIDEKKy8qIGJpdCAwIGlzIHJlc2VydmVkICovCisKKyNkZWZpbmUgIE1JUElfRElHSVRB
TF9QTExfOSAgICAweDM0CisKKyNkZWZpbmUgIE1JUElfRElHSVRBTF9QTExfMTYgICAweDNCCisj
ZGVmaW5lICBNSVBJX0ZSUV9GUkVFWkVfTkRFVCAgICAgICAgICA3CisjZGVmaW5lICBNSVBJX0ZS
UV9SRUdfU0VUX0VOQUJMRSAgICAgICA2CisjZGVmaW5lICBNSVBJX1JFR19GT1JDRV9TRUxfRU4g
ICAgICAgICA1CisjZGVmaW5lICBNSVBJX1JFR19TRUxfRElWX1JFRyAgICAgICAgICA0CisjZGVm
aW5lICBNSVBJX1JFR19GT1JDRV9QUkVfRElWX0VOICAgICAzCisvKiBiaXQgMiBpcyByZXNlcnZl
ZCAqLworI2RlZmluZSAgTUlQSV9GUkVGX0RfSU5EICAgICAgICAgICAgICAgMQorI2RlZmluZSAg
UkVGX0NMS18yNzAwMEtIWiAgICAxCisjZGVmaW5lICBSRUZfQ0xLXzE5MjAwS0haICAgIDAKKyNk
ZWZpbmUgIE1JUElfUkVHX1BMTF9QTExfVEVTVF9FTkFCTEUgIDAKKworI2RlZmluZSAgTUlQSV9E
SUdJVEFMX1BMTF8xOCAgMHgzRAorI2RlZmluZSAgRlJRX0NPVU5UX1JCX1NFTCAgICAgICA3Cisj
ZGVmaW5lICBSRUdfRk9SQ0VfUE9TVF9ESVZfRU4gIDYKKyNkZWZpbmUgIE1JUElfRFBJX1NFTEVD
VCAgICAgICAgNQorI2RlZmluZSAgU0VMRUNUX0RTSSAgMQorI2RlZmluZSAgU0VMRUNUX0RQSSAg
MAorI2RlZmluZSAgUkVHX0JBVURfRElWX1JBVElPICAgICAwCisKKyNkZWZpbmUgIEhfQkxBTktf
TCAgICAgICAgICAgIDB4M0UKKy8qIGZvciBEU0Mgb25seSAqLworI2RlZmluZSAgSF9CTEFOS19I
ICAgICAgICAgICAgMHgzRgorLyogZm9yIERTQyBvbmx5OyBub3RlOiBiaXRbNzo2XSBhcmUgcmVz
ZXJ2ZWQgKi8KKyNkZWZpbmUgIE1JUElfU1dBUCAgMHg0QQorI2RlZmluZSAgTUlQSV9TV0FQX0NI
MCAgICA3CisjZGVmaW5lICBNSVBJX1NXQVBfQ0gxICAgIDYKKyNkZWZpbmUgIE1JUElfU1dBUF9D
SDIgICAgNQorI2RlZmluZSAgTUlQSV9TV0FQX0NIMyAgICA0CisjZGVmaW5lICBNSVBJX1NXQVBf
Q0xLICAgIDMKKy8qIGJpdFsyOjBdIGFyZSByZXNlcnZlZCAqLworCisvKioqKioqKiogRU5EIG9m
IEkyQyBBZGRyZXNzIDB4ODQgKioqKioqKioqLworCisvKiBEUENEIHJlZ3MgKi8KKyNkZWZpbmUg
RFBDRF9EUENEX1JFViAgICAgICAgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgRFBDRF9NQVhfTElO
S19SQVRFICAgICAgICAgICAgIDB4MDEKKyNkZWZpbmUgRFBDRF9NQVhfTEFORV9DT1VOVCAgICAg
ICAgICAgIDB4MDIKKworLyoqKioqKioqKiAgQU5YNzYyNSBSZWdpc3RlciBFbmQgICoqKioqKioq
KiovCisKKy8qKioqKioqKioqKioqKioqKiAgRGlzcGxheSAqKioqKioqKioqKioqKioqKi8KK2Vu
dW0gYXVkaW9fZnMgeworCUFVRElPX0ZTXzQ0MUsgID0gMHgwMCwKKwlBVURJT19GU180OEsgICA9
IDB4MDIsCisJQVVESU9fRlNfMzJLICAgPSAweDAzLAorCUFVRElPX0ZTXzg4MksgID0gMHgwOCwK
KwlBVURJT19GU185NksgICA9IDB4MGEsCisJQVVESU9fRlNfMTc2NEsgPSAweDBjLAorCUFVRElP
X0ZTXzE5MksgID0gMHgwZQorfTsKKworZW51bSBhdWRpb193ZF9sZW4geworCUFVRElPX1dfTEVO
XzE2XzIwTUFYID0gMHgwMiwKKwlBVURJT19XX0xFTl8xOF8yME1BWCA9IDB4MDQsCisJQVVESU9f
V19MRU5fMTdfMjBNQVggPSAweDBjLAorCUFVRElPX1dfTEVOXzE5XzIwTUFYID0gMHgwOCwKKwlB
VURJT19XX0xFTl8yMF8yME1BWCA9IDB4MGEsCisJQVVESU9fV19MRU5fMjBfMjRNQVggPSAweDAz
LAorCUFVRElPX1dfTEVOXzIyXzI0TUFYID0gMHgwNSwKKwlBVURJT19XX0xFTl8yMV8yNE1BWCA9
IDB4MGQsCisJQVVESU9fV19MRU5fMjNfMjRNQVggPSAweDA5LAorCUFVRElPX1dfTEVOXzI0XzI0
TUFYID0gMHgwYgorfTsKKworI2RlZmluZSBJMlNfQ0hfMgkweDAxCisjZGVmaW5lIFRETV9DSF80
CTB4MDMKKyNkZWZpbmUgVERNX0NIXzYJMHgwNQorI2RlZmluZSBURE1fQ0hfOAkweDA3CisKKyNk
ZWZpbmUgTUFYX0RQQ0RfQlVGRkVSX1NJWkUJMTYKKworI2RlZmluZSBPTkVfQkxPQ0tfU0laRSAg
ICAgIDEyOAorI2RlZmluZSBGT1VSX0JMT0NLX1NJWkUgICAgICgxMjggKiA0KQorCitzdHJ1Y3Qg
c19lZGlkX2RhdGEgeworCWludCBlZGlkX2Jsb2NrX251bTsKKwl1OCBlZGlkX3Jhd19kYXRhW0ZP
VVJfQkxPQ0tfU0laRV07Cit9OworCisvKioqKioqKioqKioqKioqKiogIERpc3BsYXkgRW5kICoq
KioqKioqKioqKioqKioqLworCitzdHJ1Y3QgYW54NzYyNV9kZXZpY2Vfbm9kZSB7CisJc3RydWN0
IGRldmljZV9ub2RlICptaXBpX2RzaV9ob3N0X25vZGU7CisJc3RydWN0IGRldmljZV9ub2RlICpt
aXBpX2RwaV9ob3N0X25vZGU7CisJc3RydWN0IGRldmljZV9ub2RlICpleHRjb25fbm9kZTsKKwlz
dHJ1Y3QgZGV2aWNlX25vZGUgKmludGVybmFsX3BhbmVsX25vZGU7CisJc3RydWN0IGRldmljZV9u
b2RlICplZHBfbm9kZTsKK307CisKK3N0cnVjdCBhbng3NjI1X3BsYXRmb3JtX2RhdGEgeworCWlu
dCBncGlvX3Bfb247CisJaW50IGdwaW9fcmVzZXQ7CisJaW50IGdwaW9faW50cl9ocGQ7CisJaW50
IGhwZF9pcnE7CisJdTMyIGxvd19wb3dlcl9tb2RlOworCXUzMiBkc2lfc3VwcG9ydGVkOworCXUz
MiBpbnRlcm5hbF9wYW5lbDsKKwl1MzIgZHNpX2NoYW5uZWw7CisJdTMyIGRzaV9sYW5lczsKKwl1
MzIgZXh0Y29uX3N1cHBvcnRlZDsKKwlzdHJ1Y3QgYW54NzYyNV9kZXZpY2Vfbm9kZSBub2RlOwor
fTsKKworc3RydWN0IGFueDc2MjVfaTJjX2NsaWVudCB7CisJc3RydWN0IGkyY19jbGllbnQgKnR4
X3AwX2NsaWVudDsKKwlzdHJ1Y3QgaTJjX2NsaWVudCAqdHhfcDFfY2xpZW50OworCXN0cnVjdCBp
MmNfY2xpZW50ICp0eF9wMl9jbGllbnQ7CisJc3RydWN0IGkyY19jbGllbnQgKnJ4X3AwX2NsaWVu
dDsKKwlzdHJ1Y3QgaTJjX2NsaWVudCAqcnhfcDFfY2xpZW50OworCXN0cnVjdCBpMmNfY2xpZW50
ICpyeF9wMl9jbGllbnQ7CisJc3RydWN0IGkyY19jbGllbnQgKnJ4X3AzX2NsaWVudDsKKwlzdHJ1
Y3QgaTJjX2NsaWVudCAqdGNwY19jbGllbnQ7Cit9OworCitzdHJ1Y3QgYW54NzYyNV9kYXRhIHsK
KwlzdHJ1Y3QgYW54NzYyNV9wbGF0Zm9ybV9kYXRhIHBkYXRhOworCWF0b21pY190IHBvd2VyX3N0
YXR1czsKKwlib29sIGhwZF9zdGF0dXM7CisJaW50IGhwZF9oaWdoX2NudDsKKwlzdHJ1Y3QgaTJj
X2NsaWVudCAqY2xpZW50OworCXN0cnVjdCBhbng3NjI1X2kyY19jbGllbnQgaTJjOworCXN0cnVj
dCBpMmNfY2xpZW50ICpsYXN0X2NsaWVudDsKKwlzdHJ1Y3Qgc19lZGlkX2RhdGEgKnNsaW1wb3J0
X2VkaWRfcDsKKwlzdHJ1Y3Qgd29ya19zdHJ1Y3Qgd29yazsKKwlzdHJ1Y3Qgd29ya3F1ZXVlX3N0
cnVjdCAqd29ya3F1ZXVlOworCS8qIGRybSBicmlkZ2UgbXV0ZXggbG9jayAqLworCXN0cnVjdCBt
dXRleCBsb2NrOworCWNoYXIgZWRpZF9ibG9jazsKKwlzdHJ1Y3QgZGlzcGxheV90aW1pbmcgZHQ7
CisJdTggZGlzcGxheV90aW1pbmdfdmFsaWQ7CisJc3RydWN0IGRybV9icmlkZ2UgYnJpZGdlOwor
CXU4IGJyaWRnZV9hdHRhY2hlZDsKKwlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciBjb25uZWN0b3I7CisJ
c3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpOworCXN0cnVjdCBkcm1fZHBfbGluayBsaW5rOwor
CXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlIHZpZF9pbmZvOworCXN0cnVjdCBub3RpZmllcl9ibG9j
ayBldmVudF9uYjsKKwlzdHJ1Y3QgZXh0Y29uX2RldiAqZXh0Y29uOworCXN0cnVjdCB3b3JrX3N0
cnVjdCBleHRjb25fd3E7Cit9OworCisjZW5kaWYgIC8qIF9fQU5YNzYyNV9IX18gKi8KLS0gCjIu
Ny40CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmkt
ZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6
Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
