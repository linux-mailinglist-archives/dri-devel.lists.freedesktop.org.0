Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id DC230C9F51
	for <lists+dri-devel@lfdr.de>; Thu,  3 Oct 2019 15:22:59 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 43CAD6E9CD;
	Thu,  3 Oct 2019 13:22:56 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5BF936E9CC;
 Thu,  3 Oct 2019 13:22:54 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 18707575-1500050 for multiple; Thu, 03 Oct 2019 14:22:52 +0100
MIME-Version: 1.0
To: intel-gfx@lists.freedesktop.org
From: Chris Wilson <chris@chris-wilson.co.uk>
In-Reply-To: <20191003131946.32407-1-chris@chris-wilson.co.uk>
References: <20191003093639.10186-2-chris@chris-wilson.co.uk>
 <20191003131946.32407-1-chris@chris-wilson.co.uk>
Message-ID: <157010896960.2173.10301107422986856016@skylake-alporthouse-com>
User-Agent: alot/0.6
Subject: Re: [PATCH v2] dma-fence: Serialise signal enabling
 (dma_fence_enable_sw_signaling)
Date: Thu, 03 Oct 2019 14:22:49 +0100
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

UXVvdGluZyBDaHJpcyBXaWxzb24gKDIwMTktMTAtMDMgMTQ6MTk6NDYpCj4gTWFrZSBkbWFfZmVu
Y2VfZW5hYmxlX3N3X3NpZ25hbGluZygpIGJlaGF2ZSBsaWtlIGl0cwo+IGRtYV9mZW5jZV9hZGRf
Y2FsbGJhY2soKSBhbmQgZG1hX2ZlbmNlX2RlZmF1bHRfd2FpdCgpIGNvdW50ZXJwYXJ0cyBhbmQK
PiBwZXJmb3JtIHRoZSB0ZXN0IHRvIGVuYWJsZSBzaWduYWxpbmcgdW5kZXIgdGhlIGZlbmNlLT5s
b2NrLCBhbG9uZyB3aXRoCj4gdGhlIGFjdGlvbiB0byBkbyBzby4gVGhpcyBlbnN1cmUgdGhhdCBz
aG91bGQgYW4gaW1wbGVtZW50YXRpb24gYmUgdHJ5aW5nCj4gdG8gZmx1c2ggdGhlIGNiX2xpc3Qg
KGJ5IHNpZ25hbGluZykgb24gcmV0aXJlbWVudCBiZWZvcmUgZnJlZWluZyB0aGUKPiBmZW5jZSwg
aXQgY2FuIGRvIHNvIGluIGEgcmFjZS1mcmVlIG1hbm5lci4KPiAKPiBTZWUgYWxzbyAwZmM4OWI2
ODAyYmEgKCJkbWEtZmVuY2U6IFNpbXBseSB3cmFwIGRtYV9mZW5jZV9zaWduYWxfbG9ja2VkCj4g
d2l0aCBkbWFfZmVuY2Vfc2lnbmFsIikuCj4gCj4gdjI6IFJlZmFjdG9yIGFsbCAzIGVuYWJsZV9z
aWduYWxpbmcgcGF0aHMgdG8gdXNlIGEgY29tbW9uIGZ1bmN0aW9uLgo+IAo+IFNpZ25lZC1vZmYt
Ynk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgo+IC0tLQo+ICBkcml2
ZXJzL2RtYS1idWYvZG1hLWZlbmNlLmMgfCA3OCArKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0t
LS0tLS0tLS0tCj4gIDEgZmlsZSBjaGFuZ2VkLCAzNSBpbnNlcnRpb25zKCspLCA0MyBkZWxldGlv
bnMoLSkKPiAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9kbWEtYnVmL2RtYS1mZW5jZS5jIGIvZHJp
dmVycy9kbWEtYnVmL2RtYS1mZW5jZS5jCj4gaW5kZXggMmMxMzZhZWUzZTc5Li40YTE0NDJhOTNm
MDQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9kbWEtYnVmL2RtYS1mZW5jZS5jCj4gKysrIGIvZHJp
dmVycy9kbWEtYnVmL2RtYS1mZW5jZS5jCj4gQEAgLTI3Myw2ICsyNzMsMzAgQEAgdm9pZCBkbWFf
ZmVuY2VfZnJlZShzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSkKPiAgfQo+ICBFWFBPUlRfU1lNQk9M
KGRtYV9mZW5jZV9mcmVlKTsKPiAgCj4gK3N0YXRpYyBib29sIF9fZG1hX2ZlbmNlX2VuYWJsZV9z
aWduYWxpbmcoc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpCj4gK3sKPiArICAgICAgIGJvb2wgd2Fz
X3NldDsKPiArCj4gKyAgICAgICBsb2NrZGVwX2Fzc2VydF9oZWxkKGZlbmNlLT5sb2NrKTsKPiAr
Cj4gKyAgICAgICB3YXNfc2V0ID0gdGVzdF9hbmRfc2V0X2JpdChETUFfRkVOQ0VfRkxBR19FTkFC
TEVfU0lHTkFMX0JJVCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZmZW5j
ZS0+ZmxhZ3MpOwo+ICsKPiArICAgICAgIGlmICh0ZXN0X2JpdChETUFfRkVOQ0VfRkxBR19TSUdO
QUxFRF9CSVQsICZmZW5jZS0+ZmxhZ3MpKQo+ICsgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsK
ClBlcmhhcHMgdGhpcyBzaG91bGQgYmUgZmFsc2UgZm9yICJjb3VsZCBub3QgX2VuYWJsZV8gc2ln
bmFsaW5nIGFzIGl0IHdhcwphbHJlYWR5IHNpZ25hbGVkIiwgd2hpY2ggaXMgY2xvc2VyIHRvIHRo
ZSBvcmlnaW5hbC4KCj4gKwo+ICsgICAgICAgaWYgKCF3YXNfc2V0ICYmIGZlbmNlLT5vcHMtPmVu
YWJsZV9zaWduYWxpbmcpIHsKPiArICAgICAgICAgICAgICAgaWYgKCFmZW5jZS0+b3BzLT5lbmFi
bGVfc2lnbmFsaW5nKGZlbmNlKSkgewo+ICsgICAgICAgICAgICAgICAgICAgICAgIGRtYV9mZW5j
ZV9zaWduYWxfbG9ja2VkKGZlbmNlKTsKPiArICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4g
dHJ1ZTsKPiArICAgICAgICAgICAgICAgfQo+ICsKPiArICAgICAgICAgICAgICAgdHJhY2VfZG1h
X2ZlbmNlX2VuYWJsZV9zaWduYWwoZmVuY2UpOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIHJl
dHVybiBmYWxzZTsKPiArfQo+ICsKPiAgLyoqCj4gICAqIGRtYV9mZW5jZV9lbmFibGVfc3dfc2ln
bmFsaW5nIC0gZW5hYmxlIHNpZ25hbGluZyBvbiBmZW5jZQo+ICAgKiBAZmVuY2U6IHRoZSBmZW5j
ZSB0byBlbmFibGUKPiBAQCAtMjg1LDE5ICszMDksMTIgQEAgdm9pZCBkbWFfZmVuY2VfZW5hYmxl
X3N3X3NpZ25hbGluZyhzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSkKPiAgewo+ICAgICAgICAgdW5z
aWduZWQgbG9uZyBmbGFnczsKPiAgCj4gLSAgICAgICBpZiAoIXRlc3RfYW5kX3NldF9iaXQoRE1B
X0ZFTkNFX0ZMQUdfRU5BQkxFX1NJR05BTF9CSVQsCj4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgJmZlbmNlLT5mbGFncykgJiYKPiAtICAgICAgICAgICAhdGVzdF9iaXQoRE1BX0ZFTkNF
X0ZMQUdfU0lHTkFMRURfQklULCAmZmVuY2UtPmZsYWdzKSAmJgo+IC0gICAgICAgICAgIGZlbmNl
LT5vcHMtPmVuYWJsZV9zaWduYWxpbmcpIHsKPiAtICAgICAgICAgICAgICAgdHJhY2VfZG1hX2Zl
bmNlX2VuYWJsZV9zaWduYWwoZmVuY2UpOwo+IC0KPiAtICAgICAgICAgICAgICAgc3Bpbl9sb2Nr
X2lycXNhdmUoZmVuY2UtPmxvY2ssIGZsYWdzKTsKPiAtCj4gLSAgICAgICAgICAgICAgIGlmICgh
ZmVuY2UtPm9wcy0+ZW5hYmxlX3NpZ25hbGluZyhmZW5jZSkpCj4gLSAgICAgICAgICAgICAgICAg
ICAgICAgZG1hX2ZlbmNlX3NpZ25hbF9sb2NrZWQoZmVuY2UpOwo+ICsgICAgICAgaWYgKHRlc3Rf
Yml0KERNQV9GRU5DRV9GTEFHX1NJR05BTEVEX0JJVCwgJmZlbmNlLT5mbGFncykpCj4gKyAgICAg
ICAgICAgICAgIHJldHVybjsKPiAgCj4gLSAgICAgICAgICAgICAgIHNwaW5fdW5sb2NrX2lycXJl
c3RvcmUoZmVuY2UtPmxvY2ssIGZsYWdzKTsKPiAtICAgICAgIH0KPiArICAgICAgIHNwaW5fbG9j
a19pcnFzYXZlKGZlbmNlLT5sb2NrLCBmbGFncyk7Cj4gKyAgICAgICBfX2RtYV9mZW5jZV9lbmFi
bGVfc2lnbmFsaW5nKGZlbmNlKTsKPiArICAgICAgIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUoZmVu
Y2UtPmxvY2ssIGZsYWdzKTsKPiAgfQo+ICBFWFBPUlRfU1lNQk9MKGRtYV9mZW5jZV9lbmFibGVf
c3dfc2lnbmFsaW5nKTsKPiAgCj4gQEAgLTMzMSw3ICszNDgsNiBAQCBpbnQgZG1hX2ZlbmNlX2Fk
ZF9jYWxsYmFjayhzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSwgc3RydWN0IGRtYV9mZW5jZV9jYiAq
Y2IsCj4gIHsKPiAgICAgICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gICAgICAgICBpbnQgcmV0
ID0gMDsKPiAtICAgICAgIGJvb2wgd2FzX3NldDsKPiAgCj4gICAgICAgICBpZiAoV0FSTl9PTigh
ZmVuY2UgfHwgIWZ1bmMpKQo+ICAgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKPiBAQCAt
MzQzLDI1ICszNTksMTQgQEAgaW50IGRtYV9mZW5jZV9hZGRfY2FsbGJhY2soc3RydWN0IGRtYV9m
ZW5jZSAqZmVuY2UsIHN0cnVjdCBkbWFfZmVuY2VfY2IgKmNiLAo+ICAKPiAgICAgICAgIHNwaW5f
bG9ja19pcnFzYXZlKGZlbmNlLT5sb2NrLCBmbGFncyk7Cj4gIAo+IC0gICAgICAgd2FzX3NldCA9
IHRlc3RfYW5kX3NldF9iaXQoRE1BX0ZFTkNFX0ZMQUdfRU5BQkxFX1NJR05BTF9CSVQsCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmZmVuY2UtPmZsYWdzKTsKPiAtCj4gLSAg
ICAgICBpZiAodGVzdF9iaXQoRE1BX0ZFTkNFX0ZMQUdfU0lHTkFMRURfQklULCAmZmVuY2UtPmZs
YWdzKSkKPiArICAgICAgIGlmIChfX2RtYV9mZW5jZV9lbmFibGVfc2lnbmFsaW5nKGZlbmNlKSkg
ewo+ICsgICAgICAgICAgICAgICBJTklUX0xJU1RfSEVBRCgmY2ItPm5vZGUpOwo+ICAgICAgICAg
ICAgICAgICByZXQgPSAtRU5PRU5UOwo+IC0gICAgICAgZWxzZSBpZiAoIXdhc19zZXQgJiYgZmVu
Y2UtPm9wcy0+ZW5hYmxlX3NpZ25hbGluZykgewo+IC0gICAgICAgICAgICAgICB0cmFjZV9kbWFf
ZmVuY2VfZW5hYmxlX3NpZ25hbChmZW5jZSk7Cj4gLQo+IC0gICAgICAgICAgICAgICBpZiAoIWZl
bmNlLT5vcHMtPmVuYWJsZV9zaWduYWxpbmcoZmVuY2UpKSB7Cj4gLSAgICAgICAgICAgICAgICAg
ICAgICAgZG1hX2ZlbmNlX3NpZ25hbF9sb2NrZWQoZmVuY2UpOwo+IC0gICAgICAgICAgICAgICAg
ICAgICAgIHJldCA9IC1FTk9FTlQ7Cj4gLSAgICAgICAgICAgICAgIH0KPiAtICAgICAgIH0KPiAt
Cj4gLSAgICAgICBpZiAoIXJldCkgewo+ICsgICAgICAgfSBlbHNlIHsKPiAgICAgICAgICAgICAg
ICAgY2ItPmZ1bmMgPSBmdW5jOwo+ICAgICAgICAgICAgICAgICBsaXN0X2FkZF90YWlsKCZjYi0+
bm9kZSwgJmZlbmNlLT5jYl9saXN0KTsKPiAtICAgICAgIH0gZWxzZQo+IC0gICAgICAgICAgICAg
ICBJTklUX0xJU1RfSEVBRCgmY2ItPm5vZGUpOwo+ICsgICAgICAgfQo+ICsKPiAgICAgICAgIHNw
aW5fdW5sb2NrX2lycXJlc3RvcmUoZmVuY2UtPmxvY2ssIGZsYWdzKTsKPiAgCj4gICAgICAgICBy
ZXR1cm4gcmV0Owo+IEBAIC00NjEsNyArNDY2LDYgQEAgZG1hX2ZlbmNlX2RlZmF1bHRfd2FpdChz
dHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSwgYm9vbCBpbnRyLCBzaWduZWQgbG9uZyB0aW1lb3V0KQo+
ICAgICAgICAgc3RydWN0IGRlZmF1bHRfd2FpdF9jYiBjYjsKPiAgICAgICAgIHVuc2lnbmVkIGxv
bmcgZmxhZ3M7Cj4gICAgICAgICBzaWduZWQgbG9uZyByZXQgPSB0aW1lb3V0ID8gdGltZW91dCA6
IDE7Cj4gLSAgICAgICBib29sIHdhc19zZXQ7Cj4gIAo+ICAgICAgICAgaWYgKHRlc3RfYml0KERN
QV9GRU5DRV9GTEFHX1NJR05BTEVEX0JJVCwgJmZlbmNlLT5mbGFncykpCj4gICAgICAgICAgICAg
ICAgIHJldHVybiByZXQ7Cj4gQEAgLTQ3MywyMSArNDc3LDkgQEAgZG1hX2ZlbmNlX2RlZmF1bHRf
d2FpdChzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSwgYm9vbCBpbnRyLCBzaWduZWQgbG9uZyB0aW1l
b3V0KQo+ICAgICAgICAgICAgICAgICBnb3RvIG91dDsKPiAgICAgICAgIH0KPiAgCj4gLSAgICAg
ICB3YXNfc2V0ID0gdGVzdF9hbmRfc2V0X2JpdChETUFfRkVOQ0VfRkxBR19FTkFCTEVfU0lHTkFM
X0JJVCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZmZW5jZS0+ZmxhZ3Mp
Owo+IC0KPiAtICAgICAgIGlmICh0ZXN0X2JpdChETUFfRkVOQ0VfRkxBR19TSUdOQUxFRF9CSVQs
ICZmZW5jZS0+ZmxhZ3MpKQo+ICsgICAgICAgaWYgKF9fZG1hX2ZlbmNlX2VuYWJsZV9zaWduYWxp
bmcoZmVuY2UpKQo+ICAgICAgICAgICAgICAgICBnb3RvIG91dDsKPiAgCj4gLSAgICAgICBpZiAo
IXdhc19zZXQgJiYgZmVuY2UtPm9wcy0+ZW5hYmxlX3NpZ25hbGluZykgewo+IC0gICAgICAgICAg
ICAgICB0cmFjZV9kbWFfZmVuY2VfZW5hYmxlX3NpZ25hbChmZW5jZSk7Cj4gLQo+IC0gICAgICAg
ICAgICAgICBpZiAoIWZlbmNlLT5vcHMtPmVuYWJsZV9zaWduYWxpbmcoZmVuY2UpKSB7Cj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgZG1hX2ZlbmNlX3NpZ25hbF9sb2NrZWQoZmVuY2UpOwo+IC0g
ICAgICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0Owo+IC0gICAgICAgICAgICAgICB9Cj4gLSAg
ICAgICB9Cj4gLQo+ICAgICAgICAgaWYgKCF0aW1lb3V0KSB7Cj4gICAgICAgICAgICAgICAgIHJl
dCA9IDA7Cj4gICAgICAgICAgICAgICAgIGdvdG8gb3V0Owo+IC0tIAo+IDIuMjMuMAo+IApfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFp
bGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5m
cmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
