Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 590E2AD1DC
	for <lists+dri-devel@lfdr.de>; Mon,  9 Sep 2019 04:26:00 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A66868970E;
	Mon,  9 Sep 2019 02:25:57 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from honk.sigxcpu.org (honk.sigxcpu.org [24.134.29.49])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2626789709
 for <dri-devel@lists.freedesktop.org>; Mon,  9 Sep 2019 02:25:55 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by honk.sigxcpu.org (Postfix) with ESMTP id C1476FB02;
 Mon,  9 Sep 2019 04:25:53 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at honk.sigxcpu.org
Received: from honk.sigxcpu.org ([127.0.0.1])
 by localhost (honk.sigxcpu.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 8VlWfMKMAeYA; Mon,  9 Sep 2019 04:25:47 +0200 (CEST)
Received: by bogon.sigxcpu.org (Postfix, from userid 1000)
 id 885DD42244; Sun,  8 Sep 2019 19:25:42 -0700 (PDT)
From: =?UTF-8?q?Guido=20G=C3=BCnther?= <agx@sigxcpu.org>
To: David Airlie <airlied@linux.ie>, Daniel Vetter <daniel@ffwll.ch>,
 Rob Herring <robh+dt@kernel.org>, Mark Rutland <mark.rutland@arm.com>,
 Shawn Guo <shawnguo@kernel.org>, Sascha Hauer <s.hauer@pengutronix.de>,
 Pengutronix Kernel Team <kernel@pengutronix.de>,
 Fabio Estevam <festevam@gmail.com>, NXP Linux Team <linux-imx@nxp.com>,
 Andrzej Hajda <a.hajda@samsung.com>,
 Neil Armstrong <narmstrong@baylibre.com>,
 Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
 Jonas Karlman <jonas@kwiboo.se>, Jernej Skrabec <jernej.skrabec@siol.net>,
 Lee Jones <lee.jones@linaro.org>,
 =?UTF-8?q?Guido=20G=C3=BCnther?= <agx@sigxcpu.org>,
 dri-devel@lists.freedesktop.org, devicetree@vger.kernel.org,
 linux-arm-kernel@lists.infradead.org, linux-kernel@vger.kernel.org,
 Robert Chiras <robert.chiras@nxp.com>, Sam Ravnborg <sam@ravnborg.org>,
 Arnd Bergmann <arnd@arndb.de>
Subject: [PATCH v5 2/2] drm/bridge: Add NWL MIPI DSI host controller support
Date: Sun,  8 Sep 2019 19:25:42 -0700
Message-Id: <3ce1891ea41249bf4a9985e2cee8640fb36de42e.1567995854.git.agx@sigxcpu.org>
X-Mailer: git-send-email 2.23.0.rc1
In-Reply-To: <cover.1567995854.git.agx@sigxcpu.org>
References: <cover.1567995854.git.agx@sigxcpu.org>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBhZGRzIGluaXRpYWwgc3VwcG9ydCBmb3IgdGhlIE5XTCBNSVBJIERTSSBIb3N0IGNvbnRy
b2xsZXIgZm91bmQgb24KaS5NWDggU29Dcy4KCkl0IGFkZHMgc3VwcG9ydCBmb3IgdGhlIGkuTVg4
TVEgYnV0IHRoZSBzYW1lIElQIGNhbiBiZSBmb3VuZCBvbgplLmcuIHRoZSBpLk1YOFFYUC4KCkl0
IGhhcyBiZWVuIHRlc3RlZCBvbiB0aGUgTGlicmVtIDUgZGV2a2l0IHVzaW5nIG14c2ZiLgoKU2ln
bmVkLW9mZi1ieTogR3VpZG8gR8O8bnRoZXIgPGFneEBzaWd4Y3B1Lm9yZz4KQ28tZGV2ZWxvcGVk
LWJ5OiBSb2JlcnQgQ2hpcmFzIDxyb2JlcnQuY2hpcmFzQG54cC5jb20+ClNpZ25lZC1vZmYtYnk6
IFJvYmVydCBDaGlyYXMgPHJvYmVydC5jaGlyYXNAbnhwLmNvbT4KVGVzdGVkLWJ5OiBSb2JlcnQg
Q2hpcmFzIDxyb2JlcnQuY2hpcmFzQG54cC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2JyaWRn
ZS9LY29uZmlnICAgICAgICAgICB8ICAgMiArCiBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL01ha2Vm
aWxlICAgICAgICAgIHwgICAxICsKIGRyaXZlcnMvZ3B1L2RybS9icmlkZ2UvbndsLWRzaS9LY29u
ZmlnICAgfCAgMTYgKwogZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9ud2wtZHNpL01ha2VmaWxlICB8
ICAgNCArCiBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL253bC1kc2kvbndsLWRydi5jIHwgNDk5ICsr
KysrKysrKysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9icmlkZ2UvbndsLWRzaS9ud2wtZHJ2Lmgg
fCAgNjUgKysrCiBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL253bC1kc2kvbndsLWRzaS5jIHwgNjk2
ICsrKysrKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL253bC1kc2kv
bndsLWRzaS5oIHwgMTEyICsrKysKIDggZmlsZXMgY2hhbmdlZCwgMTM5NSBpbnNlcnRpb25zKCsp
CiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9ud2wtZHNpL0tjb25m
aWcKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL253bC1kc2kvTWFr
ZWZpbGUKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL253bC1kc2kv
bndsLWRydi5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9ud2wt
ZHNpL253bC1kcnYuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9icmlkZ2Uv
bndsLWRzaS9ud2wtZHNpLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vYnJp
ZGdlL253bC1kc2kvbndsLWRzaS5oCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2JyaWRn
ZS9LY29uZmlnIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9LY29uZmlnCmluZGV4IDFjYzlmNTAy
YzFmMi4uNzk4MGI1YzIxNTZmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL0tj
b25maWcKKysrIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9LY29uZmlnCkBAIC0xNTQsNiArMTU0
LDggQEAgc291cmNlICJkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L0tjb25maWciCiAK
IHNvdXJjZSAiZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hZHY3NTExL0tjb25maWciCiAKK3NvdXJj
ZSAiZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9ud2wtZHNpL0tjb25maWciCisKIHNvdXJjZSAiZHJp
dmVycy9ncHUvZHJtL2JyaWRnZS9zeW5vcHN5cy9LY29uZmlnIgogCiBlbmRtZW51CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL2Jy
aWRnZS9NYWtlZmlsZQppbmRleCA0OTM0ZmNmNWE2ZjguLmQ5ZjZjMGY3NzU5MiAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2dwdS9kcm0v
YnJpZGdlL01ha2VmaWxlCkBAIC0xNiw0ICsxNiw1IEBAIG9iai0kKENPTkZJR19EUk1fQU5BTE9H
SVhfRFApICs9IGFuYWxvZ2l4Lwogb2JqLSQoQ09ORklHX0RSTV9JMkNfQURWNzUxMSkgKz0gYWR2
NzUxMS8KIG9iai0kKENPTkZJR19EUk1fVElfU042NURTSTg2KSArPSB0aS1zbjY1ZHNpODYubwog
b2JqLSQoQ09ORklHX0RSTV9USV9URlA0MTApICs9IHRpLXRmcDQxMC5vCitvYmotJChDT05GSUdf
RFJNX05XTF9NSVBJX0RTSSkgKz0gbndsLWRzaS8KIG9iai15ICs9IHN5bm9wc3lzLwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9ud2wtZHNpL0tjb25maWcgYi9kcml2ZXJzL2dw
dS9kcm0vYnJpZGdlL253bC1kc2kvS2NvbmZpZwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAw
MDAwMDAwMDAwMDAuLjdmYTY3OGUzYjVlMgotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9icmlkZ2UvbndsLWRzaS9LY29uZmlnCkBAIC0wLDAgKzEsMTYgQEAKK2NvbmZpZyBEUk1f
TldMX01JUElfRFNJCisJdHJpc3RhdGUgIk5vcnRod2VzdCBMb2dpYyBNSVBJIERTSSBIb3N0IGNv
bnRyb2xsZXIiCisJZGVwZW5kcyBvbiBEUk0KKwlkZXBlbmRzIG9uIENPTU1PTl9DTEsKKwlkZXBl
bmRzIG9uIE9GICYmIEhBU19JT01FTQorCXNlbGVjdCBEUk1fS01TX0hFTFBFUgorCXNlbGVjdCBE
Uk1fTUlQSV9EU0kKKwlzZWxlY3QgRFJNX1BBTkVMX0JSSURHRQorCXNlbGVjdCBHRU5FUklDX1BI
WV9NSVBJX0RQSFkKKwlzZWxlY3QgTUZEX1NZU0NPTgorCXNlbGVjdCBNVUxUSVBMRVhFUgorCXNl
bGVjdCBSRUdNQVBfTU1JTworCWhlbHAKKwkgIFRoaXMgZW5hYmxlcyB0aGUgTm9ydGh3ZXN0IExv
Z2ljIE1JUEkgRFNJIEhvc3QgY29udHJvbGxlciBhcworCSAgZm9yIGV4YW1wbGUgZm91bmQgb24g
TlhQJ3MgaS5NWDggUHJvY2Vzc29ycy4KKwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2Jy
aWRnZS9ud2wtZHNpL01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9ud2wtZHNpL01h
a2VmaWxlCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uODA0YmFmMmYx
OTE2Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9ud2wtZHNpL01h
a2VmaWxlCkBAIC0wLDAgKzEsNCBAQAorIyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIu
MAorbndsLW1pcGktZHNpLXkgOj0gbndsLWRydi5vIG53bC1kc2kubworb2JqLSQoQ09ORklHX0RS
TV9OV0xfTUlQSV9EU0kpICs9IG53bC1taXBpLWRzaS5vCitoZWFkZXItdGVzdC15ICs9IG53bC1k
cnYuaCBud2wtZHNpLmgKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvbndsLWRz
aS9ud2wtZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL253bC1kc2kvbndsLWRydi5jCm5l
dyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uOWZmNDNkMmRlMTI3Ci0tLSAv
ZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9ud2wtZHNpL253bC1kcnYuYwpA
QCAtMCwwICsxLDQ5OSBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjArCisv
KgorICogaS5NWDggTldMIE1JUEkgRFNJIGhvc3QgZHJpdmVyCisgKgorICogQ29weXJpZ2h0IChD
KSAyMDE3IE5YUAorICogQ29weXJpZ2h0IChDKSAyMDE5IFB1cmlzbSBTUEMKKyAqLworCisjaW5j
bHVkZSA8bGludXgvY2xrLmg+CisjaW5jbHVkZSA8bGludXgvaXJxLmg+CisjaW5jbHVkZSA8bGlu
dXgvbWZkL3N5c2Nvbi5oPgorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgorI2luY2x1ZGUgPGxp
bnV4L211eC9jb25zdW1lci5oPgorI2luY2x1ZGUgPGxpbnV4L29mLmg+CisjaW5jbHVkZSA8bGlu
dXgvb2ZfcGxhdGZvcm0uaD4KKyNpbmNsdWRlIDxsaW51eC9waHkvcGh5Lmg+CisjaW5jbHVkZSA8
bGludXgvcmVzZXQuaD4KKyNpbmNsdWRlIDxsaW51eC9yZWdtYXAuaD4KKyNpbmNsdWRlIDxsaW51
eC9zeXNfc29jLmg+CisKKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pY19oZWxwZXIuaD4KKyNpbmNs
dWRlIDxkcm0vZHJtX29mLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wcmludC5oPgorI2luY2x1ZGUg
PGRybS9kcm1fcHJvYmVfaGVscGVyLmg+CisKKyNpbmNsdWRlICJud2wtZHJ2LmgiCisjaW5jbHVk
ZSAibndsLWRzaS5oIgorCisjZGVmaW5lIERSVl9OQU1FICJud2wtZHNpIgorCisvKiBQb3NzaWJs
ZSBwbGF0Zm9ybSBzcGVjaWZpYyBjbG9ja3MgKi8KKyNkZWZpbmUgTldMX0RTSV9DTEtfQ09SRQki
Y29yZSIKKworc3RhdGljIGNvbnN0IHN0cnVjdCByZWdtYXBfY29uZmlnIG53bF9kc2lfcmVnbWFw
X2NvbmZpZyA9IHsKKwkucmVnX2JpdHMgPSAxNiwKKwkudmFsX2JpdHMgPSAzMiwKKwkucmVnX3N0
cmlkZSA9IDQsCisJLm1heF9yZWdpc3RlciA9IE5XTF9EU0lfSVJRX01BU0syLAorCS5uYW1lID0g
RFJWX05BTUUsCit9OworCitzdHJ1Y3QgbndsX2RzaV9wbGF0Zm9ybV9kYXRhIHsKKwlpbnQgKCpw
b3dlcm9uKShzdHJ1Y3QgbndsX2RzaSAqZHNpKTsKKwlpbnQgKCpwb3dlcm9mZikoc3RydWN0IG53
bF9kc2kgKmRzaSk7CisJaW50ICgqc2VsZWN0X2lucHV0KShzdHJ1Y3QgbndsX2RzaSAqZHNpKTsK
KwlpbnQgKCpkZXNlbGVjdF9pbnB1dCkoc3RydWN0IG53bF9kc2kgKmRzaSk7CisJc3RydWN0IG53
bF9kc2lfcGxhdF9jbGtfY29uZmlnIGNsa19jb25maWdbTldMX0RTSV9NQVhfUExBVEZPUk1fQ0xP
Q0tTXTsKK307CisKK3N0YXRpYyBpbmxpbmUgc3RydWN0IG53bF9kc2kgKmJyaWRnZV90b19kc2ko
c3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSkKK3sKKwlyZXR1cm4gY29udGFpbmVyX29mKGJyaWRn
ZSwgc3RydWN0IG53bF9kc2ksIGJyaWRnZSk7Cit9CisKK3N0YXRpYyBpbnQgbndsX2RzaV9zZXRf
cGxhdGZvcm1fY2xvY2tzKHN0cnVjdCBud2xfZHNpICpkc2ksIGJvb2wgZW5hYmxlKQoreworCXN0
cnVjdCBkZXZpY2UgKmRldiA9IGRzaS0+ZGV2OworCWNvbnN0IGNoYXIgKmlkOworCXN0cnVjdCBj
bGsgKmNsazsKKwlzaXplX3QgaTsKKwl1bnNpZ25lZCBsb25nIHJhdGU7CisJaW50IHJldCwgcmVz
dWx0ID0gMDsKKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIiVzIHBsYXRmb3JtIGNsb2Nr
c1xuIiwKKwkJCSAgICAgZW5hYmxlID8gImVuYWJsaW5nIiA6ICJkaXNhYmxpbmciKTsKKwlmb3Ig
KGkgPSAwOyBpIDwgQVJSQVlfU0laRShkc2ktPnBkYXRhLT5jbGtfY29uZmlnKTsgaSsrKSB7CisJ
CWlmICghZHNpLT5jbGtfY29uZmlnW2ldLnByZXNlbnQpCisJCQljb250aW51ZTsKKwkJaWQgPSBk
c2ktPmNsa19jb25maWdbaV0uaWQ7CisJCWNsayA9IGRzaS0+Y2xrX2NvbmZpZ1tpXS5jbGs7CisK
KwkJaWYgKGVuYWJsZSkgeworCQkJcmV0ID0gY2xrX3ByZXBhcmVfZW5hYmxlKGNsayk7CisJCQlp
ZiAocmV0IDwgMCkgeworCQkJCURSTV9ERVZfRVJST1IoZGV2LAorCQkJCQkgICAgICAiRmFpbGVk
IHRvIGVuYWJsZSAlcyBjbGs6ICVkXG4iLAorCQkJCQkgICAgICBpZCwgcmV0KTsKKwkJCQlyZXN1
bHQgPSByZXN1bHQgPzogcmV0OworCQkJfQorCQkJcmF0ZSA9IGNsa19nZXRfcmF0ZShjbGspOwor
CQkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiRW5hYmxlZCAlcyBjbGsgQCVsdSBIelxuIiwK
KwkJCQkJICAgICBpZCwgcmF0ZSk7CisJCX0gZWxzZSB7CisJCQljbGtfZGlzYWJsZV91bnByZXBh
cmUoY2xrKTsKKwkJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIkRpc2FibGVkICVzIGNsa1xu
IiwgaWQpOworCQl9CisJfQorCisJcmV0dXJuIHJlc3VsdDsKK30KKworc3RhdGljIGludCBud2xf
ZHNpX3BsYXRfZW5hYmxlKHN0cnVjdCBud2xfZHNpICpkc2kpCit7CisJc3RydWN0IGRldmljZSAq
ZGV2ID0gZHNpLT5kZXY7CisJaW50IHJldDsKKworCWlmIChkc2ktPnBkYXRhLT5zZWxlY3RfaW5w
dXQpCisJCWRzaS0+cGRhdGEtPnNlbGVjdF9pbnB1dChkc2kpOworCisJcmV0ID0gbndsX2RzaV9z
ZXRfcGxhdGZvcm1fY2xvY2tzKGRzaSwgdHJ1ZSk7CisJaWYgKHJldCA8IDApCisJCXJldHVybiBy
ZXQ7CisKKwlyZXQgPSBkc2ktPnBkYXRhLT5wb3dlcm9uKGRzaSk7CisJaWYgKHJldCA8IDApCisJ
CURSTV9ERVZfRVJST1IoZGV2LCAiRmFpbGVkIHRvIHBvd2VyIG9uIERTSTogJWRcbiIsIHJldCk7
CisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIHZvaWQgbndsX2RzaV9wbGF0X2Rpc2FibGUoc3Ry
dWN0IG53bF9kc2kgKmRzaSkKK3sKKwlkc2ktPnBkYXRhLT5wb3dlcm9mZihkc2kpOworCW53bF9k
c2lfc2V0X3BsYXRmb3JtX2Nsb2Nrcyhkc2ksIGZhbHNlKTsKKwlpZiAoZHNpLT5wZGF0YS0+ZGVz
ZWxlY3RfaW5wdXQpCisJCWRzaS0+cGRhdGEtPmRlc2VsZWN0X2lucHV0KGRzaSk7Cit9CisKK3N0
YXRpYyB2b2lkIG53bF9kc2lfYnJpZGdlX2Rpc2FibGUoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRn
ZSkKK3sKKwlzdHJ1Y3QgbndsX2RzaSAqZHNpID0gYnJpZGdlX3RvX2RzaShicmlkZ2UpOworCisJ
bndsX2RzaV9kaXNhYmxlKGRzaSk7CisJbndsX2RzaV9wbGF0X2Rpc2FibGUoZHNpKTsKKwlwbV9y
dW50aW1lX3B1dChkc2ktPmRldik7Cit9CisKK3N0YXRpYyBpbnQgbndsX2RzaV9nZXRfZHBoeV9w
YXJhbXMoc3RydWN0IG53bF9kc2kgKmRzaSwKKwkJCQkgICBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3Bs
YXlfbW9kZSAqbW9kZSwKKwkJCQkgICB1bmlvbiBwaHlfY29uZmlndXJlX29wdHMgKnBoeV9vcHRz
KQoreworCXVuc2lnbmVkIGxvbmcgcmF0ZTsKKwlpbnQgcmV0OworCisJaWYgKGRzaS0+bGFuZXMg
PCAxIHx8IGRzaS0+bGFuZXMgPiA0KQorCQlyZXR1cm4gLUVJTlZBTDsKKworCS8qCisJICogU28g
ZmFyIHRoZSBEUEhZIHNwZWMgbWluaW1hbCB0aW1pbmdzIHdvcmsgZm9yIGJvdGggbWl4ZWwKKwkg
KiBkcGh5IGFuZCBud2wgZHNpIGhvc3QKKwkgKi8KKwlyZXQgPSBwaHlfbWlwaV9kcGh5X2dldF9k
ZWZhdWx0X2NvbmZpZygKKwkJbW9kZS0+Y3J0Y19jbG9jayAqIDEwMDAsCisJCW1pcGlfZHNpX3Bp
eGVsX2Zvcm1hdF90b19icHAoZHNpLT5mb3JtYXQpLCBkc2ktPmxhbmVzLAorCQkmcGh5X29wdHMt
Pm1pcGlfZHBoeSk7CisJaWYgKHJldCA8IDApCisJCXJldHVybiByZXQ7CisKKwlyYXRlID0gY2xr
X2dldF9yYXRlKGRzaS0+dHhfZXNjX2Nsayk7CisJRFJNX0RFVl9ERUJVR19EUklWRVIoZHNpLT5k
ZXYsICJMUCBjbGsgaXMgQCVsdSBIelxuIiwgcmF0ZSk7CisJcGh5X29wdHMtPm1pcGlfZHBoeS5s
cF9jbGtfcmF0ZSA9IHJhdGU7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGJvb2wgbndsX2Rz
aV9icmlkZ2VfbW9kZV9maXh1cChzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAorCQkJCSAgICAg
IGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlLAorCQkJCSAgICAgIHN0cnVjdCBk
cm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlKQoreworCS8qIEF0IGxlYXN0IExDRElGICsg
TldMIG5lZWRzIGFjdGl2ZSBoaWdoIHN5bmMgKi8KKwlhZGp1c3RlZF9tb2RlLT5mbGFncyB8PSAo
RFJNX01PREVfRkxBR19QSFNZTkMgfCBEUk1fTU9ERV9GTEFHX1BWU1lOQyk7CisJYWRqdXN0ZWRf
bW9kZS0+ZmxhZ3MgJj0gfihEUk1fTU9ERV9GTEFHX05IU1lOQyB8IERSTV9NT0RFX0ZMQUdfTlZT
WU5DKTsKKworCXJldHVybiB0cnVlOworfQorCitzdGF0aWMgZW51bSBkcm1fbW9kZV9zdGF0dXMK
K253bF9kc2lfYnJpZGdlX21vZGVfdmFsaWQoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSwKKwkJ
CSAgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUpCit7CisJc3RydWN0IG53bF9k
c2kgKmRzaSA9IGJyaWRnZV90b19kc2koYnJpZGdlKTsKKwlpbnQgYnBwID0gbWlwaV9kc2lfcGl4
ZWxfZm9ybWF0X3RvX2JwcChkc2ktPmZvcm1hdCk7CisKKwlpZiAobW9kZS0+Y2xvY2sgKiBicHAg
PiAxNTAwMDAwMCAqIGRzaS0+bGFuZXMpCisJCXJldHVybiBNT0RFX0NMT0NLX0hJR0g7CisKKwlp
ZiAobW9kZS0+Y2xvY2sgKiBicHAgPCA4MDAwMCAqIGRzaS0+bGFuZXMpCisJCXJldHVybiBNT0RF
X0NMT0NLX0xPVzsKKworCXJldHVybiBNT0RFX09LOworfQorCitzdGF0aWMgdm9pZAorbndsX2Rz
aV9icmlkZ2VfbW9kZV9zZXQoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSwKKwkJCWNvbnN0IHN0
cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlLAorCQkJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5
X21vZGUgKmFkanVzdGVkX21vZGUpCit7CisJc3RydWN0IG53bF9kc2kgKmRzaSA9IGJyaWRnZV90
b19kc2koYnJpZGdlKTsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSBkc2ktPmRldjsKKwl1bmlvbiBw
aHlfY29uZmlndXJlX29wdHMgbmV3X2NmZzsKKwl1bnNpZ25lZCBsb25nIHBoeV9yZWZfcmF0ZTsK
KwlpbnQgcmV0OworCisJcmV0ID0gbndsX2RzaV9nZXRfZHBoeV9wYXJhbXMoZHNpLCBhZGp1c3Rl
ZF9tb2RlLCAmbmV3X2NmZyk7CisJaWYgKHJldCA8IDApCisJCXJldHVybjsKKworCS8qCisJICog
SWYgaHMgY2xvY2sgaXMgdW5jaGFuZ2VkLCB3ZSdyZSBhbGwgZ29vZCAtIGFsbCBwYXJhbWV0ZXJz
IGFyZQorCSAqIGRlcml2ZWQgZnJvbSBpdCBhdG0uCisJICovCisJaWYgKG5ld19jZmcubWlwaV9k
cGh5LmhzX2Nsa19yYXRlID09IGRzaS0+cGh5X2NmZy5taXBpX2RwaHkuaHNfY2xrX3JhdGUpCisJ
CXJldHVybjsKKworCXBoeV9yZWZfcmF0ZSA9IGNsa19nZXRfcmF0ZShkc2ktPnBoeV9yZWZfY2xr
KTsKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJQSFkgYXQgcmVmIHJhdGU6ICVsdVxuIiwg
cGh5X3JlZl9yYXRlKTsKKwkvKiBTYXZlIHRoZSBuZXcgZGVzaXJlZCBwaHkgY29uZmlnICovCisJ
bWVtY3B5KCZkc2ktPnBoeV9jZmcsICZuZXdfY2ZnLCBzaXplb2YobmV3X2NmZykpOworCisJbWVt
Y3B5KCZkc2ktPm1vZGUsIGFkanVzdGVkX21vZGUsIHNpemVvZihkc2ktPm1vZGUpKTsKKwlkcm1f
bW9kZV9kZWJ1Z19wcmludG1vZGVsaW5lKGFkanVzdGVkX21vZGUpOworfQorCitzdGF0aWMgdm9p
ZCBud2xfZHNpX2JyaWRnZV9wcmVfZW5hYmxlKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UpCit7
CisJc3RydWN0IG53bF9kc2kgKmRzaSA9IGJyaWRnZV90b19kc2koYnJpZGdlKTsKKworCXBtX3J1
bnRpbWVfZ2V0X3N5bmMoZHNpLT5kZXYpOworCW53bF9kc2lfcGxhdF9lbmFibGUoZHNpKTsKKwlu
d2xfZHNpX2VuYWJsZShkc2kpOworfQorCitzdGF0aWMgaW50IG53bF9kc2lfYnJpZGdlX2F0dGFj
aChzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQoreworCXN0cnVjdCBud2xfZHNpICpkc2kgPSBi
cmlkZ2UtPmRyaXZlcl9wcml2YXRlOworCisJcmV0dXJuIGRybV9icmlkZ2VfYXR0YWNoKGJyaWRn
ZS0+ZW5jb2RlciwgZHNpLT5wYW5lbF9icmlkZ2UsIGJyaWRnZSk7Cit9CisKK3N0YXRpYyBjb25z
dCBzdHJ1Y3QgZHJtX2JyaWRnZV9mdW5jcyBud2xfZHNpX2JyaWRnZV9mdW5jcyA9IHsKKwkucHJl
X2VuYWJsZSA9IG53bF9kc2lfYnJpZGdlX3ByZV9lbmFibGUsCisJLmRpc2FibGUgICAgPSBud2xf
ZHNpX2JyaWRnZV9kaXNhYmxlLAorCS5tb2RlX2ZpeHVwID0gbndsX2RzaV9icmlkZ2VfbW9kZV9m
aXh1cCwKKwkubW9kZV9zZXQgICA9IG53bF9kc2lfYnJpZGdlX21vZGVfc2V0LAorCS5tb2RlX3Zh
bGlkID0gbndsX2RzaV9icmlkZ2VfbW9kZV92YWxpZCwKKwkuYXR0YWNoCSAgICA9IG53bF9kc2lf
YnJpZGdlX2F0dGFjaCwKK307CisKK3N0YXRpYyBpbnQgbndsX2RzaV9wYXJzZV9kdChzdHJ1Y3Qg
bndsX2RzaSAqZHNpKQoreworCXN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYgPSB0b19wbGF0
Zm9ybV9kZXZpY2UoZHNpLT5kZXYpOworCXN0cnVjdCBjbGsgKmNsazsKKwljb25zdCBjaGFyICpj
bGtfaWQ7CisJdm9pZCBfX2lvbWVtICpiYXNlOworCWludCBpLCByZXQ7CisKKwlkc2ktPnBoeSA9
IGRldm1fcGh5X2dldChkc2ktPmRldiwgImRwaHkiKTsKKwlpZiAoSVNfRVJSKGRzaS0+cGh5KSkg
eworCQlyZXQgPSBQVFJfRVJSKGRzaS0+cGh5KTsKKwkJaWYgKHJldCAhPSAtRVBST0JFX0RFRkVS
KQorCQkJRFJNX0RFVl9FUlJPUihkc2ktPmRldiwgIkNvdWxkIG5vdCBnZXQgUEhZOiAlZFxuIiwg
cmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwkvKiBQbGF0Zm9ybSBkZXBlbmRlbnQgY2xvY2tz
ICovCisJbWVtY3B5KGRzaS0+Y2xrX2NvbmZpZywgZHNpLT5wZGF0YS0+Y2xrX2NvbmZpZywKKwkg
ICAgICAgc2l6ZW9mKGRzaS0+cGRhdGEtPmNsa19jb25maWcpKTsKKworCWZvciAoaSA9IDA7IGkg
PCBBUlJBWV9TSVpFKGRzaS0+cGRhdGEtPmNsa19jb25maWcpOyBpKyspIHsKKwkJaWYgKCFkc2kt
PmNsa19jb25maWdbaV0ucHJlc2VudCkKKwkJCWNvbnRpbnVlOworCisJCWNsa19pZCA9IGRzaS0+
Y2xrX2NvbmZpZ1tpXS5pZDsKKwkJY2xrID0gZGV2bV9jbGtfZ2V0KGRzaS0+ZGV2LCBjbGtfaWQp
OworCQlpZiAoSVNfRVJSKGNsaykpIHsKKwkJCXJldCA9IFBUUl9FUlIoY2xrKTsKKwkJCURSTV9E
RVZfRVJST1IoZHNpLT5kZXYsICJGYWlsZWQgdG8gZ2V0ICVzIGNsb2NrOiAlZFxuIiwKKwkJCQkg
ICAgICBjbGtfaWQsIHJldCk7CisJCQlyZXR1cm4gcmV0OworCQl9CisJCURSTV9ERVZfREVCVUdf
RFJJVkVSKGRzaS0+ZGV2LCAiU2V0dXAgY2xrICVzIChyYXRlOiAlbHUpXG4iLAorCQkJCSAgICAg
Y2xrX2lkLCBjbGtfZ2V0X3JhdGUoY2xrKSk7CisJCWRzaS0+Y2xrX2NvbmZpZ1tpXS5jbGsgPSBj
bGs7CisJfQorCisJLyogRFNJIGNsb2NrcyAqLworCWNsayA9IGRldm1fY2xrX2dldChkc2ktPmRl
diwgInBoeV9yZWYiKTsKKwlpZiAoSVNfRVJSKGNsaykpIHsKKwkJcmV0ID0gUFRSX0VSUihjbGsp
OworCQlEUk1fREVWX0VSUk9SKGRzaS0+ZGV2LCAiRmFpbGVkIHRvIGdldCBwaHlfcmVmIGNsb2Nr
OiAlZFxuIiwKKwkJCSAgICAgIHJldCk7CisJCXJldHVybiByZXQ7CisJfQorCWRzaS0+cGh5X3Jl
Zl9jbGsgPSBjbGs7CisKKwljbGsgPSBkZXZtX2Nsa19nZXQoZHNpLT5kZXYsICJyeF9lc2MiKTsK
KwlpZiAoSVNfRVJSKGNsaykpIHsKKwkJcmV0ID0gUFRSX0VSUihjbGspOworCQlEUk1fREVWX0VS
Uk9SKGRzaS0+ZGV2LCAiRmFpbGVkIHRvIGdldCByeF9lc2MgY2xvY2s6ICVkXG4iLAorCQkJICAg
ICAgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisJZHNpLT5yeF9lc2NfY2xrID0gY2xrOworCisJ
Y2xrID0gZGV2bV9jbGtfZ2V0KGRzaS0+ZGV2LCAidHhfZXNjIik7CisJaWYgKElTX0VSUihjbGsp
KSB7CisJCXJldCA9IFBUUl9FUlIoY2xrKTsKKwkJRFJNX0RFVl9FUlJPUihkc2ktPmRldiwgIkZh
aWxlZCB0byBnZXQgdHhfZXNjIGNsb2NrOiAlZFxuIiwKKwkJCSAgICAgIHJldCk7CisJCXJldHVy
biByZXQ7CisJfQorCWRzaS0+dHhfZXNjX2NsayA9IGNsazsKKworCWRzaS0+bXV4ID0gZGV2bV9t
dXhfY29udHJvbF9nZXQoZHNpLT5kZXYsIE5VTEwpOworCWlmIChJU19FUlIoZHNpLT5tdXgpKSB7
CisJCXJldCA9IFBUUl9FUlIoZHNpLT5tdXgpOworCQlpZiAocmV0ICE9IC1FUFJPQkVfREVGRVIp
CisJCQlEUk1fREVWX0VSUk9SKGRzaS0+ZGV2LCAiRmFpbGVkIHRvIGdldCBtdXg6ICVkXG4iLCBy
ZXQpOworCQlyZXR1cm4gcmV0OworCX0KKworCWJhc2UgPSBkZXZtX3BsYXRmb3JtX2lvcmVtYXBf
cmVzb3VyY2UocGRldiwgMCk7CisJaWYgKElTX0VSUihiYXNlKSkKKwkJcmV0dXJuIFBUUl9FUlIo
YmFzZSk7CisKKwlkc2ktPnJlZ21hcCA9CisJCWRldm1fcmVnbWFwX2luaXRfbW1pbyhkc2ktPmRl
diwgYmFzZSwgJm53bF9kc2lfcmVnbWFwX2NvbmZpZyk7CisJaWYgKElTX0VSUihkc2ktPnJlZ21h
cCkpIHsKKwkJcmV0ID0gUFRSX0VSUihkc2ktPnJlZ21hcCk7CisJCURSTV9ERVZfRVJST1IoZHNp
LT5kZXYsICJGYWlsZWQgdG8gY3JlYXRlIE5XTCBEU0kgcmVnbWFwOiAlZFxuIiwKKwkJCSAgICAg
IHJldCk7CisJCXJldHVybiByZXQ7CisJfQorCisJZHNpLT5pcnEgPSBwbGF0Zm9ybV9nZXRfaXJx
KHBkZXYsIDApOworCWlmIChkc2ktPmlycSA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihkc2ktPmRl
diwgIkZhaWxlZCB0byBnZXQgZGV2aWNlIElSUTogJWRcbiIsCisJCQkgICAgICBkc2ktPmlycSk7
CisJCXJldHVybiBkc2ktPmlycTsKKwl9CisKKwlkc2ktPnJzdGMgPSBkZXZtX3Jlc2V0X2NvbnRy
b2xfYXJyYXlfZ2V0KGRzaS0+ZGV2LCBmYWxzZSwgdHJ1ZSk7CisJaWYgKElTX0VSUihkc2ktPnJz
dGMpKSB7CisJCURSTV9ERVZfRVJST1IoZHNpLT5kZXYsICJGYWlsZWQgdG8gZ2V0IHJlc2V0czog
JWxkXG4iLAorCQkJICAgICAgUFRSX0VSUihkc2ktPnJzdGMpKTsKKwkJcmV0dXJuIFBUUl9FUlIo
ZHNpLT5yc3RjKTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBpbXg4bXFfZHNp
X3NlbGVjdF9pbnB1dChzdHJ1Y3QgbndsX2RzaSAqZHNpKQoreworCXN0cnVjdCBkZXZpY2Vfbm9k
ZSAqcmVtb3RlOworCXUzMiB1c2VfZGNzcyA9IDE7CisJaW50IHJldDsKKworCXJlbW90ZSA9IG9m
X2dyYXBoX2dldF9yZW1vdGVfbm9kZShkc2ktPmRldi0+b2Zfbm9kZSwgMCwgMCk7CisJaWYgKHN0
cmNtcChyZW1vdGUtPm5hbWUsICJsY2RpZiIpID09IDApCisJCXVzZV9kY3NzID0gMDsKKworCURS
TV9ERVZfSU5GTyhkc2ktPmRldiwgIlVzaW5nICVzIGFzIGlucHV0IHNvdXJjZVxuIiwKKwkJICAg
ICAodXNlX2Rjc3MpID8gIkRDU1MiIDogIkxDRElGIik7CisKKwlyZXQgPSBtdXhfY29udHJvbF90
cnlfc2VsZWN0KGRzaS0+bXV4LCB1c2VfZGNzcyk7CisJaWYgKHJldCA8IDApCisJCURSTV9ERVZf
RVJST1IoZHNpLT5kZXYsICJGYWlsZWQgdG8gc2VsZWN0IGlucHV0OiAlZFxuIiwgcmV0KTsKKwor
CW9mX25vZGVfcHV0KHJlbW90ZSk7CisJcmV0dXJuIHJldDsKK30KKworCitzdGF0aWMgaW50IGlt
eDhtcV9kc2lfZGVzZWxlY3RfaW5wdXQoc3RydWN0IG53bF9kc2kgKmRzaSkKK3sKKwlpbnQgcmV0
OworCisJcmV0ID0gbXV4X2NvbnRyb2xfZGVzZWxlY3QoZHNpLT5tdXgpOworCWlmIChyZXQgPCAw
KQorCQlEUk1fREVWX0VSUk9SKGRzaS0+ZGV2LCAiRmFpbGVkIHRvIGRlc2VsZWN0IGlucHV0OiAl
ZFxuIiwgcmV0KTsKKworCXJldHVybiByZXQ7Cit9CisKKworc3RhdGljIGludCBpbXg4bXFfZHNp
X3Bvd2Vyb24oc3RydWN0IG53bF9kc2kgKmRzaSkKK3sKKwlpbnQgcmV0ID0gMDsKKworCS8qIG90
aGVyd2lzZSB0aGUgZGlzcGxheSBzdGF5cyBibGFuayAqLworCXVzbGVlcF9yYW5nZSgyMDAsIDMw
MCk7CisKKwlpZiAoZHNpLT5yc3RjKQorCQlyZXQgPSByZXNldF9jb250cm9sX2RlYXNzZXJ0KGRz
aS0+cnN0Yyk7CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IGlteDhtcV9kc2lfcG93
ZXJvZmYoc3RydWN0IG53bF9kc2kgKmRzaSkKK3sKKwlpbnQgcmV0ID0gMDsKKworCWlmIChkc2kt
PnF1aXJrcyAmIFNSQ19SRVNFVF9RVUlSSykKKwkJcmV0dXJuIDA7CisKKwlpZiAoZHNpLT5yc3Rj
KQorCQlyZXQgPSByZXNldF9jb250cm9sX2Fzc2VydChkc2ktPnJzdGMpOworCXJldHVybiByZXQ7
Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2JyaWRnZV90aW1pbmdzIG53bF9kc2lfdGlt
aW5ncyA9IHsKKwkuaW5wdXRfYnVzX2ZsYWdzID0gRFJNX0JVU19GTEFHX0RFX0xPVywKK307CisK
K3N0YXRpYyBjb25zdCBzdHJ1Y3QgbndsX2RzaV9wbGF0Zm9ybV9kYXRhIGlteDhtcV9kZXYgPSB7
CisJLnBvd2Vyb24gPSAmaW14OG1xX2RzaV9wb3dlcm9uLAorCS5wb3dlcm9mZiA9ICZpbXg4bXFf
ZHNpX3Bvd2Vyb2ZmLAorCS5zZWxlY3RfaW5wdXQgPSAmaW14OG1xX2RzaV9zZWxlY3RfaW5wdXQs
CisJLmRlc2VsZWN0X2lucHV0ID0gJmlteDhtcV9kc2lfZGVzZWxlY3RfaW5wdXQsCisJLmNsa19j
b25maWcgPSB7CisJCXsgLmlkID0gTldMX0RTSV9DTEtfQ09SRSwgLnByZXNlbnQgPSB0cnVlIH0s
CisJfSwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3Qgb2ZfZGV2aWNlX2lkIG53bF9kc2lfZHRf
aWRzW10gPSB7CisJeyAuY29tcGF0aWJsZSA9ICJmc2wsaW14OG1xLW53bC1kc2kiLCAuZGF0YSA9
ICZpbXg4bXFfZGV2LCB9LAorCXsgLyogc2VudGluZWwgKi8gfQorfTsKK01PRFVMRV9ERVZJQ0Vf
VEFCTEUob2YsIG53bF9kc2lfZHRfaWRzKTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBzb2NfZGV2
aWNlX2F0dHJpYnV0ZSBud2xfZHNpX3F1aXJrc19tYXRjaFtdID0geworCXsgLnNvY19pZCA9ICJp
Lk1YOE1RIiwgLnJldmlzaW9uID0gIjIuMCIsCisJICAuZGF0YSA9ICh2b2lkICopKEUxMTQxOF9I
U19NT0RFX1FVSVJLIHwgU1JDX1JFU0VUX1FVSVJLKSB9LAorCXsgLyogc2VudGluZWwuICovIH0s
Cit9OworCitzdGF0aWMgaW50IG53bF9kc2lfcHJvYmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAq
cGRldikKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmcGRldi0+ZGV2OworCWNvbnN0IHN0cnVj
dCBvZl9kZXZpY2VfaWQgKm9mX2lkID0gb2ZfbWF0Y2hfZGV2aWNlKG53bF9kc2lfZHRfaWRzLCBk
ZXYpOworCWNvbnN0IHN0cnVjdCBud2xfZHNpX3BsYXRmb3JtX2RhdGEgKnBkYXRhID0gb2ZfaWQt
PmRhdGE7CisJY29uc3Qgc3RydWN0IHNvY19kZXZpY2VfYXR0cmlidXRlICphdHRyOworCXN0cnVj
dCBud2xfZHNpICpkc2k7CisJaW50IHJldDsKKworCWRzaSA9IGRldm1fa3phbGxvYyhkZXYsIHNp
emVvZigqZHNpKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFkc2kpCisJCXJldHVybiAtRU5PTUVNOwor
CisJZHNpLT5kZXYgPSBkZXY7CisJZHNpLT5wZGF0YSA9IHBkYXRhOworCisJcmV0ID0gbndsX2Rz
aV9wYXJzZV9kdChkc2kpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwlyZXQgPSBkZXZt
X3JlcXVlc3RfaXJxKGRldiwgZHNpLT5pcnEsIG53bF9kc2lfaXJxX2hhbmRsZXIsIDAsCisJCQkg
ICAgICAgZGV2X25hbWUoZGV2KSwgZHNpKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VS
Uk9SKGRldiwgIkZhaWxlZCB0byByZXF1ZXN0IElSUSAlZDogJWRcbiIsIGRzaS0+aXJxLAorCQkJ
ICAgICAgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlkc2ktPmRzaV9ob3N0Lm9wcyA9ICZu
d2xfZHNpX2hvc3Rfb3BzOworCWRzaS0+ZHNpX2hvc3QuZGV2ID0gZGV2OworCXJldCA9IG1pcGlf
ZHNpX2hvc3RfcmVnaXN0ZXIoJmRzaS0+ZHNpX2hvc3QpOworCWlmIChyZXQpIHsKKwkJRFJNX0RF
Vl9FUlJPUihkZXYsICJGYWlsZWQgdG8gcmVnaXN0ZXIgTUlQSSBob3N0OiAlZFxuIiwgcmV0KTsK
KwkJcmV0dXJuIHJldDsKKwl9CisKKwlhdHRyID0gc29jX2RldmljZV9tYXRjaChud2xfZHNpX3F1
aXJrc19tYXRjaCk7CisJaWYgKGF0dHIpCisJCWRzaS0+cXVpcmtzID0gKHVpbnRwdHJfdClhdHRy
LT5kYXRhOworCisJZHNpLT5icmlkZ2UuZHJpdmVyX3ByaXZhdGUgPSBkc2k7CisJZHNpLT5icmlk
Z2UuZnVuY3MgPSAmbndsX2RzaV9icmlkZ2VfZnVuY3M7CisJZHNpLT5icmlkZ2Uub2Zfbm9kZSA9
IGRldi0+b2Zfbm9kZTsKKwlkc2ktPmJyaWRnZS50aW1pbmdzID0gJm53bF9kc2lfdGltaW5nczsK
KworCWRldl9zZXRfZHJ2ZGF0YShkZXYsIGRzaSk7CisJcG1fcnVudGltZV9lbmFibGUoZGV2KTsK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBud2xfZHNpX3JlbW92ZShzdHJ1Y3QgcGxhdGZv
cm1fZGV2aWNlICpwZGV2KQoreworCXN0cnVjdCBud2xfZHNpICpkc2kgPSBwbGF0Zm9ybV9nZXRf
ZHJ2ZGF0YShwZGV2KTsKKworCW1pcGlfZHNpX2hvc3RfdW5yZWdpc3RlcigmZHNpLT5kc2lfaG9z
dCk7CisJcG1fcnVudGltZV9kaXNhYmxlKCZwZGV2LT5kZXYpOworCXJldHVybiAwOworfQorCitz
dGF0aWMgc3RydWN0IHBsYXRmb3JtX2RyaXZlciBud2xfZHNpX2RyaXZlciA9IHsKKwkucHJvYmUJ
CT0gbndsX2RzaV9wcm9iZSwKKwkucmVtb3ZlCQk9IG53bF9kc2lfcmVtb3ZlLAorCS5kcml2ZXIJ
CT0geworCQkub2ZfbWF0Y2hfdGFibGUgPSBud2xfZHNpX2R0X2lkcywKKwkJLm5hbWUJPSBEUlZf
TkFNRSwKKwl9LAorfTsKKworbW9kdWxlX3BsYXRmb3JtX2RyaXZlcihud2xfZHNpX2RyaXZlcik7
CisKK01PRFVMRV9BVVRIT1IoIk5YUCBTZW1pY29uZHVjdG9yIik7CitNT0RVTEVfQVVUSE9SKCJQ
dXJpc20gU1BDIik7CitNT0RVTEVfREVTQ1JJUFRJT04oIk5vcnRod2VzdCBMb2dpYyBNSVBJLURT
SSBkcml2ZXIiKTsKK01PRFVMRV9MSUNFTlNFKCJHUEwiKTsgLyogR1BMdjIgb3IgbGF0ZXIgKi8K
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvbndsLWRzaS9ud2wtZHJ2LmggYi9k
cml2ZXJzL2dwdS9kcm0vYnJpZGdlL253bC1kc2kvbndsLWRydi5oCm5ldyBmaWxlIG1vZGUgMTAw
NjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMWU3MmE5MjIxNDAxCi0tLSAvZGV2L251bGwKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9ud2wtZHNpL253bC1kcnYuaApAQCAtMCwwICsxLDY1IEBA
CisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCsgKi8KKy8qCisgKiBOV0wgTUlQ
SSBEU0kgaG9zdCBkcml2ZXIKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMTcgTlhQCisgKiBDb3B5
cmlnaHQgKEMpIDIwMTkgUHVyaXNtIFNQQworICovCisKKyNpZm5kZWYgX19OV0xfRFJWX0hfXwor
I2RlZmluZSBfX05XTF9EUlZfSF9fCisKKyNpbmNsdWRlIDxsaW51eC9tdXgvY29uc3VtZXIuaD4K
KyNpbmNsdWRlIDxsaW51eC9waHkvcGh5Lmg+CisKKyNpbmNsdWRlIDxkcm0vZHJtX2JyaWRnZS5o
PgorI2luY2x1ZGUgPGRybS9kcm1fbWlwaV9kc2kuaD4KKworc3RydWN0IG53bF9kc2lfcGxhdGZv
cm1fZGF0YTsKKworLyogaS5NWDggTldMIHF1aXJrcyAqLworLyogaS5NWDhNUSBlcnJhdGEgRTEx
NDE4ICovCisjZGVmaW5lIEUxMTQxOF9IU19NT0RFX1FVSVJLCSAgICBCSVQoMCkKKy8qIFNraXAg
RFNJIGJpdHMgaW4gU1JDIG9uIGRpc2FibGUgdG8gYXZvaWQgYmxhbmsgZGlzcGxheSBvbiBlbmFi
bGUgKi8KKyNkZWZpbmUgU1JDX1JFU0VUX1FVSVJLCQkgICAgQklUKDEpCisKKyNkZWZpbmUgTldM
X0RTSV9NQVhfUExBVEZPUk1fQ0xPQ0tTIDEKK3N0cnVjdCBud2xfZHNpX3BsYXRfY2xrX2NvbmZp
ZyB7CisJY29uc3QgY2hhciAqaWQ7CisJc3RydWN0IGNsayAqY2xrOworCWJvb2wgcHJlc2VudDsK
K307CisKK3N0cnVjdCBud2xfZHNpIHsKKwlzdHJ1Y3QgZHJtX2JyaWRnZSBicmlkZ2U7CisJc3Ry
dWN0IG1pcGlfZHNpX2hvc3QgZHNpX2hvc3Q7CisJc3RydWN0IGRybV9icmlkZ2UgKnBhbmVsX2Jy
aWRnZTsKKwlzdHJ1Y3QgZGV2aWNlICpkZXY7CisJc3RydWN0IHBoeSAqcGh5OworCXVuaW9uIHBo
eV9jb25maWd1cmVfb3B0cyBwaHlfY2ZnOworCXVuc2lnbmVkIGludCBxdWlya3M7CisKKwlzdHJ1
Y3QgcmVnbWFwICpyZWdtYXA7CisJaW50IGlycTsKKwlzdHJ1Y3QgcmVzZXRfY29udHJvbCAqcnN0
YzsKKwlzdHJ1Y3QgbXV4X2NvbnRyb2wgKm11eDsKKworCS8qIERTSSBjbG9ja3MgKi8KKwlzdHJ1
Y3QgY2xrICpwaHlfcmVmX2NsazsKKwlzdHJ1Y3QgY2xrICpyeF9lc2NfY2xrOworCXN0cnVjdCBj
bGsgKnR4X2VzY19jbGs7CisJLyogUGxhdGZvcm0gZGVwZW5kZW50IGNsb2NrcyAqLworCXN0cnVj
dCBud2xfZHNpX3BsYXRfY2xrX2NvbmZpZyBjbGtfY29uZmlnW05XTF9EU0lfTUFYX1BMQVRGT1JN
X0NMT0NLU107CisKKwkvKiBkc2kgbGFuZXMgKi8KKwl1MzIgbGFuZXM7CisJZW51bSBtaXBpX2Rz
aV9waXhlbF9mb3JtYXQgZm9ybWF0OworCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlIG1vZGU7CisJ
dW5zaWduZWQgbG9uZyBkc2lfbW9kZV9mbGFnczsKKworCXN0cnVjdCBud2xfZHNpX3RyYW5zZmVy
ICp4ZmVyOworCisJY29uc3Qgc3RydWN0IG53bF9kc2lfcGxhdGZvcm1fZGF0YSAqcGRhdGE7Cit9
OworCisjZW5kaWYgLyogX19OV0xfRFJWX0hfXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2JyaWRnZS9ud2wtZHNpL253bC1kc2kuYyBiL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2Uvbnds
LWRzaS9ud2wtZHNpLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5l
NjAzOGNiNGU4NDkKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL253
bC1kc2kvbndsLWRzaS5jCkBAIC0wLDAgKzEsNjk2IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRp
ZmllcjogR1BMLTIuMCsKKy8qCisgKiBOV0wgTUlQSSBEU0kgaG9zdCBkcml2ZXIKKyAqCisgKiBD
b3B5cmlnaHQgKEMpIDIwMTcgTlhQCisgKiBDb3B5cmlnaHQgKEMpIDIwMTkgUHVyaXNtIFNQQwor
ICovCisKKyNpbmNsdWRlIDxsaW51eC9iaXRmaWVsZC5oPgorI2luY2x1ZGUgPGxpbnV4L2Nsay5o
PgorI2luY2x1ZGUgPGxpbnV4L2lycS5oPgorI2luY2x1ZGUgPGxpbnV4L21hdGg2NC5oPgorI2lu
Y2x1ZGUgPGxpbnV4L3JlZ21hcC5oPgorI2luY2x1ZGUgPGxpbnV4L3RpbWU2NC5oPgorCisjaW5j
bHVkZSA8dmlkZW8vbWlwaV9kaXNwbGF5Lmg+CisjaW5jbHVkZSA8dmlkZW8vdmlkZW9tb2RlLmg+
CisKKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pY19oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJt
X2NydGNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9vZi5oPgorI2luY2x1ZGUgPGRybS9k
cm1fcGFuZWwuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3ByaW50Lmg+CisKKyNpbmNsdWRlICJud2wt
ZHJ2LmgiCisjaW5jbHVkZSAibndsLWRzaS5oIgorCisjZGVmaW5lIE5XTF9EU0lfTUlQSV9GSUZP
X1RJTUVPVVQgbXNlY3NfdG9famlmZmllcyg1MDApCisKKy8qCisgKiBQS1RfQ09OVFJPTCBmb3Jt
YXQ6CisgKiBbMTU6IDBdIC0gd29yZCBjb3VudAorICogWzE3OjE2XSAtIHZpcnR1YWwgY2hhbm5l
bAorICogWzIzOjE4XSAtIGRhdGEgdHlwZQorICogWzI0XQkgICAtIExQIG9yIEhTIHNlbGVjdCAo
MCAtIExQLCAxIC0gSFMpCisgKiBbMjVdCSAgIC0gcGVyZm9ybSBCVEEgYWZ0ZXIgcGFja2V0IGlz
IHNlbnQKKyAqIFsyNl0JICAgLSBwZXJmb3JtIEJUQSBvbmx5LCBubyBwYWNrZXQgdHgKKyAqLwor
I2RlZmluZSBOV0xfRFNJX1dDKHgpCQlGSUVMRF9QUkVQKEdFTk1BU0soMTUsIDApLCAoeCkpCisj
ZGVmaW5lIE5XTF9EU0lfVFhfVkMoeCkJRklFTERfUFJFUChHRU5NQVNLKDE3LCAxNiksICh4KSkK
KyNkZWZpbmUgTldMX0RTSV9UWF9EVCh4KQlGSUVMRF9QUkVQKEdFTk1BU0soMjMsIDE4KSwgKHgp
KQorI2RlZmluZSBOV0xfRFNJX0hTX1NFTCh4KQlGSUVMRF9QUkVQKEdFTk1BU0soMjQsIDI0KSwg
KHgpKQorI2RlZmluZSBOV0xfRFNJX0JUQV9UWCh4KQlGSUVMRF9QUkVQKEdFTk1BU0soMjUsIDI1
KSwgKHgpKQorI2RlZmluZSBOV0xfRFNJX0JUQV9OT19UWCh4KQlGSUVMRF9QUkVQKEdFTk1BU0so
MjYsIDI2KSwgKHgpKQorCisvKgorICogUlhfUEtUX0hFQURFUiBmb3JtYXQ6CisgKiBbMTU6IDBd
IC0gd29yZCBjb3VudAorICogWzIxOjE2XSAtIGRhdGEgdHlwZQorICogWzIzOjIyXSAtIHZpcnR1
YWwgY2hhbm5lbAorICovCisjZGVmaW5lIE5XTF9EU0lfUlhfRFQoeCkJRklFTERfR0VUKEdFTk1B
U0soMjEsIDE2KSwgKHgpKQorI2RlZmluZSBOV0xfRFNJX1JYX1ZDKHgpCUZJRUxEX0dFVChHRU5N
QVNLKDIzLCAyMiksICh4KSkKKworLyogRFNJIFZpZGVvIG1vZGUgKi8KKyNkZWZpbmUgTldMX0RT
SV9WTV9CVVJTVF9NT0RFX1dJVEhfU1lOQ19QVUxTRVMJCTAKKyNkZWZpbmUgTldMX0RTSV9WTV9O
T05fQlVSU1RfTU9ERV9XSVRIX1NZTkNfRVZFTlRTCUJJVCgwKQorI2RlZmluZSBOV0xfRFNJX1ZN
X0JVUlNUX01PREUJCQkJQklUKDEpCisKKy8qICogRFBJIGNvbG9yIGNvZGluZyAqLworI2RlZmlu
ZSBOV0xfRFNJX0RQSV8xNl9CSVRfNTY1X1BBQ0tFRAkwCisjZGVmaW5lIE5XTF9EU0lfRFBJXzE2
X0JJVF81NjVfQUxJR05FRAkxCisjZGVmaW5lIE5XTF9EU0lfRFBJXzE2X0JJVF81NjVfU0hJRlRF
RAkyCisjZGVmaW5lIE5XTF9EU0lfRFBJXzE4X0JJVF9QQUNLRUQJMworI2RlZmluZSBOV0xfRFNJ
X0RQSV8xOF9CSVRfQUxJR05FRAk0CisjZGVmaW5lIE5XTF9EU0lfRFBJXzI0X0JJVAkJNQorCisv
KiAqIERQSSBQaXhlbCBmb3JtYXQgKi8KKyNkZWZpbmUgTldMX0RTSV9QSVhFTF9GT1JNQVRfMTYg
IDAKKyNkZWZpbmUgTldMX0RTSV9QSVhFTF9GT1JNQVRfMTggIEJJVCgwKQorI2RlZmluZSBOV0xf
RFNJX1BJWEVMX0ZPUk1BVF8xOEwgQklUKDEpCisjZGVmaW5lIE5XTF9EU0lfUElYRUxfRk9STUFU
XzI0ICAoQklUKDApIHwgQklUKDEpKQorCitlbnVtIHRyYW5zZmVyX2RpcmVjdGlvbiB7CisJRFNJ
X1BBQ0tFVF9TRU5ELAorCURTSV9QQUNLRVRfUkVDRUlWRSwKK307CisKK3N0cnVjdCBud2xfZHNp
X3RyYW5zZmVyIHsKKwljb25zdCBzdHJ1Y3QgbWlwaV9kc2lfbXNnICptc2c7CisJc3RydWN0IG1p
cGlfZHNpX3BhY2tldCBwYWNrZXQ7CisJc3RydWN0IGNvbXBsZXRpb24gY29tcGxldGVkOworCisJ
aW50IHN0YXR1czsgLyogc3RhdHVzIG9mIHRyYW5zbWlzc2lvbiAqLworCWVudW0gdHJhbnNmZXJf
ZGlyZWN0aW9uIGRpcmVjdGlvbjsKKwlib29sIG5lZWRfYnRhOworCXU4IGNtZDsKKwl1MTYgcnhf
d29yZF9jb3VudDsKKwlzaXplX3QgdHhfbGVuOyAvKiBpbiBieXRlcyAqLworCXNpemVfdCByeF9s
ZW47IC8qIGluIGJ5dGVzICovCit9OworCitzdGF0aWMgaW50IG53bF9kc2lfd3JpdGUoc3RydWN0
IG53bF9kc2kgKmRzaSwgdW5zaWduZWQgaW50IHJlZywgdTMyIHZhbCkKK3sKKwlpbnQgcmV0Owor
CisJcmV0ID0gcmVnbWFwX3dyaXRlKGRzaS0+cmVnbWFwLCByZWcsIHZhbCk7CisJaWYgKHJldCA8
IDApCisJCURSTV9ERVZfRVJST1IoZHNpLT5kZXYsCisJCQkgICAgICAiRmFpbGVkIHRvIHdyaXRl
IE5XTCBEU0kgcmVnIDB4JXg6ICVkXG4iLCByZWcsCisJCQkgICAgICByZXQpOworCXJldHVybiBy
ZXQ7Cit9CisKK3N0YXRpYyB1MzIgbndsX2RzaV9yZWFkKHN0cnVjdCBud2xfZHNpICpkc2ksIHUz
MiByZWcpCit7CisJdW5zaWduZWQgaW50IHZhbDsKKwlpbnQgcmV0OworCisJcmV0ID0gcmVnbWFw
X3JlYWQoZHNpLT5yZWdtYXAsIHJlZywgJnZhbCk7CisJaWYgKHJldCA8IDApCisJCURSTV9ERVZf
RVJST1IoZHNpLT5kZXYsICJGYWlsZWQgdG8gcmVhZCBOV0wgRFNJIHJlZyAweCV4OiAlZFxuIiwK
KwkJCSAgICAgIHJlZywgcmV0KTsKKworCXJldHVybiB2YWw7Cit9CisKK3N0YXRpYyB1MzIgbnds
X2RzaV9nZXRfZHBpX3BpeGVsX2Zvcm1hdChlbnVtIG1pcGlfZHNpX3BpeGVsX2Zvcm1hdCBmb3Jt
YXQpCit7CisJc3dpdGNoIChmb3JtYXQpIHsKKwljYXNlIE1JUElfRFNJX0ZNVF9SR0I1NjU6CisJ
CXJldHVybiBOV0xfRFNJX1BJWEVMX0ZPUk1BVF8xNjsKKwljYXNlIE1JUElfRFNJX0ZNVF9SR0I2
NjY6CisJCXJldHVybiBOV0xfRFNJX1BJWEVMX0ZPUk1BVF8xOEw7CisJY2FzZSBNSVBJX0RTSV9G
TVRfUkdCNjY2X1BBQ0tFRDoKKwkJcmV0dXJuIE5XTF9EU0lfUElYRUxfRk9STUFUXzE4OworCWNh
c2UgTUlQSV9EU0lfRk1UX1JHQjg4ODoKKwkJcmV0dXJuIE5XTF9EU0lfUElYRUxfRk9STUFUXzI0
OworCWRlZmF1bHQ6CisJCXJldHVybiAtRUlOVkFMOworCX0KK30KKworLyoKKyAqIHBzMmJjIC0g
UGljb3NlY29uZHMgdG8gYnl0ZSBjbG9jayBjeWNsZXMKKyAqLworc3RhdGljIHUzMiBwczJiYyhz
dHJ1Y3QgbndsX2RzaSAqZHNpLCB1bnNpZ25lZCBsb25nIGxvbmcgcHMpCit7CisJdTMyIGJwcCA9
IG1pcGlfZHNpX3BpeGVsX2Zvcm1hdF90b19icHAoZHNpLT5mb3JtYXQpOworCisJcmV0dXJuIERJ
VjY0X1U2NF9ST1VORF9VUChwcyAqIGRzaS0+bW9kZS5jbG9jayAqIGJwcCwKKwkJCQkgIGRzaS0+
bGFuZXMgKiA4ICogTlNFQ19QRVJfU0VDKTsKK30KKworLyoKKyAqIHVpMmJjIC0gVUkgdGltZSBw
ZXJpb2RzIHRvIGJ5dGUgY2xvY2sgY3ljbGVzCisgKi8KK3N0YXRpYyB1MzIgdWkyYmMoc3RydWN0
IG53bF9kc2kgKmRzaSwgdW5zaWduZWQgbG9uZyBsb25nIHVpKQoreworCXUzMiBicHAgPSBtaXBp
X2RzaV9waXhlbF9mb3JtYXRfdG9fYnBwKGRzaS0+Zm9ybWF0KTsKKworCXJldHVybiBESVY2NF9V
NjRfUk9VTkRfVVAodWkgKiBkc2ktPmxhbmVzLAorCQkJCSAgZHNpLT5tb2RlLmNsb2NrICogMTAw
MCAqIGJwcCk7Cit9CisKKy8qCisgKiB1czJiYyAtIG1pY3JvIHNlY29uZHMgdG8gbHAgY2xvY2sg
Y3ljbGVzCisgKi8KK3N0YXRpYyB1MzIgdXMybHAodTMyIGxwX2Nsa19yYXRlLCB1bnNpZ25lZCBs
b25nIHVzKQoreworCXJldHVybiBESVZfUk9VTkRfVVAodXMgKiBscF9jbGtfcmF0ZSwgVVNFQ19Q
RVJfU0VDKTsKK30KKworc3RhdGljIGludCBud2xfZHNpX2NvbmZpZ19ob3N0KHN0cnVjdCBud2xf
ZHNpICpkc2kpCit7CisJdTMyIGN5Y2xlczsKKwlzdHJ1Y3QgcGh5X2NvbmZpZ3VyZV9vcHRzX21p
cGlfZHBoeSAqY2ZnID0gJmRzaS0+cGh5X2NmZy5taXBpX2RwaHk7CisKKwlpZiAoZHNpLT5sYW5l
cyA8IDEgfHwgZHNpLT5sYW5lcyA+IDQpCisJCXJldHVybiAtRUlOVkFMOworCisJRFJNX0RFVl9E
RUJVR19EUklWRVIoZHNpLT5kZXYsICJEU0kgTGFuZXMgJWRcbiIsIGRzaS0+bGFuZXMpOworCW53
bF9kc2lfd3JpdGUoZHNpLCBOV0xfRFNJX0NGR19OVU1fTEFORVMsIGRzaS0+bGFuZXMgLSAxKTsK
KworCWlmIChkc2ktPmRzaV9tb2RlX2ZsYWdzICYgTUlQSV9EU0lfQ0xPQ0tfTk9OX0NPTlRJTlVP
VVMpIHsKKwkJbndsX2RzaV93cml0ZShkc2ksIE5XTF9EU0lfQ0ZHX05PTkNPTlRJTlVPVVNfQ0xL
LCAweDAxKTsKKwkJbndsX2RzaV93cml0ZShkc2ksIE5XTF9EU0lfQ0ZHX0FVVE9JTlNFUlRfRU9U
UCwgMHgwMSk7CisJfSBlbHNlIHsKKwkJbndsX2RzaV93cml0ZShkc2ksIE5XTF9EU0lfQ0ZHX05P
TkNPTlRJTlVPVVNfQ0xLLCAweDAwKTsKKwkJbndsX2RzaV93cml0ZShkc2ksIE5XTF9EU0lfQ0ZH
X0FVVE9JTlNFUlRfRU9UUCwgMHgwMCk7CisJfQorCisJLyogdmFsdWVzIGluIGJ5dGUgY2xvY2sg
Y3ljbGVzICovCisJY3ljbGVzID0gdWkyYmMoZHNpLCBjZmctPmNsa19wcmUpOworCURSTV9ERVZf
REVCVUdfRFJJVkVSKGRzaS0+ZGV2LCAiY2ZnX3RfcHJlOiAweCV4XG4iLCBjeWNsZXMpOworCW53
bF9kc2lfd3JpdGUoZHNpLCBOV0xfRFNJX0NGR19UX1BSRSwgY3ljbGVzKTsKKwljeWNsZXMgPSBw
czJiYyhkc2ksIGNmZy0+bHB4ICsgY2ZnLT5jbGtfcHJlcGFyZSArIGNmZy0+Y2xrX3plcm8pOwor
CURSTV9ERVZfREVCVUdfRFJJVkVSKGRzaS0+ZGV2LCAiY2ZnX3R4X2dhcCAocHJlKTogMHgleFxu
IiwgY3ljbGVzKTsKKwljeWNsZXMgKz0gdWkyYmMoZHNpLCBjZmctPmNsa19wcmUpOworCURSTV9E
RVZfREVCVUdfRFJJVkVSKGRzaS0+ZGV2LCAiY2ZnX3RfcG9zdDogMHgleFxuIiwgY3ljbGVzKTsK
Kwlud2xfZHNpX3dyaXRlKGRzaSwgTldMX0RTSV9DRkdfVF9QT1NULCBjeWNsZXMpOworCWN5Y2xl
cyA9IHBzMmJjKGRzaSwgY2ZnLT5oc19leGl0KTsKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkc2kt
PmRldiwgImNmZ190eF9nYXA6IDB4JXhcbiIsIGN5Y2xlcyk7CisJbndsX2RzaV93cml0ZShkc2ks
IE5XTF9EU0lfQ0ZHX1RYX0dBUCwgY3ljbGVzKTsKKworCW53bF9kc2lfd3JpdGUoZHNpLCBOV0xf
RFNJX0NGR19FWFRSQV9DTURTX0FGVEVSX0VPVFAsIDB4MDEpOworCW53bF9kc2lfd3JpdGUoZHNp
LCBOV0xfRFNJX0NGR19IVFhfVE9fQ09VTlQsIDB4MDApOworCW53bF9kc2lfd3JpdGUoZHNpLCBO
V0xfRFNJX0NGR19MUlhfSF9UT19DT1VOVCwgMHgwMCk7CisJbndsX2RzaV93cml0ZShkc2ksIE5X
TF9EU0lfQ0ZHX0JUQV9IX1RPX0NPVU5ULCAweDAwKTsKKwkvKiBJbiBMUCBjbG9jayBjeWNsZXMg
Ki8KKwljeWNsZXMgPSB1czJscChjZmctPmxwX2Nsa19yYXRlLCBjZmctPndha2V1cCk7CisJRFJN
X0RFVl9ERUJVR19EUklWRVIoZHNpLT5kZXYsICJjZmdfdHdha2V1cDogMHgleFxuIiwgY3ljbGVz
KTsKKwlud2xfZHNpX3dyaXRlKGRzaSwgTldMX0RTSV9DRkdfVFdBS0VVUCwgY3ljbGVzKTsKKwor
CXJldHVybiAwOworfQorCitzdGF0aWMgaW50IG53bF9kc2lfY29uZmlnX2RwaShzdHJ1Y3Qgbnds
X2RzaSAqZHNpKQoreworCXUzMiBjb2xvcl9mb3JtYXQsIG1vZGU7CisJYm9vbCBidXJzdF9tb2Rl
OworCWludCBoZnJvbnRfcG9yY2gsIGhiYWNrX3BvcmNoLCB2ZnJvbnRfcG9yY2gsIHZiYWNrX3Bv
cmNoOworCWludCBoc3luY19sZW4sIHZzeW5jX2xlbjsKKworCWhmcm9udF9wb3JjaCA9IGRzaS0+
bW9kZS5oc3luY19zdGFydCAtIGRzaS0+bW9kZS5oZGlzcGxheTsKKwloc3luY19sZW4gPSBkc2kt
Pm1vZGUuaHN5bmNfZW5kIC0gZHNpLT5tb2RlLmhzeW5jX3N0YXJ0OworCWhiYWNrX3BvcmNoID0g
ZHNpLT5tb2RlLmh0b3RhbCAtIGRzaS0+bW9kZS5oc3luY19lbmQ7CisKKwl2ZnJvbnRfcG9yY2gg
PSBkc2ktPm1vZGUudnN5bmNfc3RhcnQgLSBkc2ktPm1vZGUudmRpc3BsYXk7CisJdnN5bmNfbGVu
ID0gZHNpLT5tb2RlLnZzeW5jX2VuZCAtIGRzaS0+bW9kZS52c3luY19zdGFydDsKKwl2YmFja19w
b3JjaCA9IGRzaS0+bW9kZS52dG90YWwgLSBkc2ktPm1vZGUudnN5bmNfZW5kOworCisJRFJNX0RF
Vl9ERUJVR19EUklWRVIoZHNpLT5kZXYsICJoZnJvbnRfcG9yY2ggPSAlZFxuIiwgaGZyb250X3Bv
cmNoKTsKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkc2ktPmRldiwgImhiYWNrX3BvcmNoID0gJWRc
biIsIGhiYWNrX3BvcmNoKTsKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkc2ktPmRldiwgImhzeW5j
X2xlbiA9ICVkXG4iLCBoc3luY19sZW4pOworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRzaS0+ZGV2
LCAiaGRpc3BsYXkgPSAlZFxuIiwgZHNpLT5tb2RlLmhkaXNwbGF5KTsKKwlEUk1fREVWX0RFQlVH
X0RSSVZFUihkc2ktPmRldiwgInZmcm9udF9wb3JjaCA9ICVkXG4iLCB2ZnJvbnRfcG9yY2gpOwor
CURSTV9ERVZfREVCVUdfRFJJVkVSKGRzaS0+ZGV2LCAidmJhY2tfcG9yY2ggPSAlZFxuIiwgdmJh
Y2tfcG9yY2gpOworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRzaS0+ZGV2LCAidnN5bmNfbGVuID0g
JWRcbiIsIHZzeW5jX2xlbik7CisJRFJNX0RFVl9ERUJVR19EUklWRVIoZHNpLT5kZXYsICJ2YWN0
aXZlID0gJWRcbiIsIGRzaS0+bW9kZS52ZGlzcGxheSk7CisJRFJNX0RFVl9ERUJVR19EUklWRVIo
ZHNpLT5kZXYsICJjbG9jayA9ICVkIGtIelxuIiwgZHNpLT5tb2RlLmNsb2NrKTsKKworCWNvbG9y
X2Zvcm1hdCA9IG53bF9kc2lfZ2V0X2RwaV9waXhlbF9mb3JtYXQoZHNpLT5mb3JtYXQpOworCWlm
IChjb2xvcl9mb3JtYXQgPCAwKSB7CisJCURSTV9ERVZfRVJST1IoZHNpLT5kZXYsICJJbnZhbGlk
IGNvbG9yIGZvcm1hdCAweCV4XG4iLAorCQkJICAgICAgZHNpLT5mb3JtYXQpOworCQlyZXR1cm4g
Y29sb3JfZm9ybWF0OworCX0KKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkc2ktPmRldiwgInBpeGVs
IGZtdCA9ICVkXG4iLCBkc2ktPmZvcm1hdCk7CisKKwlud2xfZHNpX3dyaXRlKGRzaSwgTldMX0RT
SV9JTlRFUkZBQ0VfQ09MT1JfQ09ESU5HLCBOV0xfRFNJX0RQSV8yNF9CSVQpOworCW53bF9kc2lf
d3JpdGUoZHNpLCBOV0xfRFNJX1BJWEVMX0ZPUk1BVCwgY29sb3JfZm9ybWF0KTsKKwkvKgorCSAq
IEFkanVzdGluZyBpbnB1dCBwb2xhcml0eSBiYXNlZCBvbiB0aGUgdmlkZW8gbW9kZSByZXN1bHRz
IGluCisJICogYSBibGFjayBzY3JlZW4gc28gYWx3YXlzIHBpY2sgYWN0aXZlIGxvdzoKKwkgKi8K
Kwlud2xfZHNpX3dyaXRlKGRzaSwgTldMX0RTSV9WU1lOQ19QT0xBUklUWSwKKwkJICAgICAgTldM
X0RTSV9WU1lOQ19QT0xBUklUWV9BQ1RJVkVfTE9XKTsKKwlud2xfZHNpX3dyaXRlKGRzaSwgTldM
X0RTSV9IU1lOQ19QT0xBUklUWSwKKwkJICAgICAgTldMX0RTSV9IU1lOQ19QT0xBUklUWV9BQ1RJ
VkVfTE9XKTsKKworCWJ1cnN0X21vZGUgPSAoZHNpLT5kc2lfbW9kZV9mbGFncyAmIE1JUElfRFNJ
X01PREVfVklERU9fQlVSU1QpICYmCisJCSAgICAgIShkc2ktPmRzaV9tb2RlX2ZsYWdzICYgTUlQ
SV9EU0lfTU9ERV9WSURFT19TWU5DX1BVTFNFKTsKKworCWlmIChidXJzdF9tb2RlKSB7CisJCW53
bF9kc2lfd3JpdGUoZHNpLCBOV0xfRFNJX1ZJREVPX01PREUsIE5XTF9EU0lfVk1fQlVSU1RfTU9E
RSk7CisJCW53bF9kc2lfd3JpdGUoZHNpLCBOV0xfRFNJX1BJWEVMX0ZJRk9fU0VORF9MRVZFTCwg
MjU2KTsKKwl9IGVsc2UgeworCQltb2RlID0gKChkc2ktPmRzaV9tb2RlX2ZsYWdzICYgTUlQSV9E
U0lfTU9ERV9WSURFT19TWU5DX1BVTFNFKSA/CisJCQkJTldMX0RTSV9WTV9CVVJTVF9NT0RFX1dJ
VEhfU1lOQ19QVUxTRVMgOgorCQkJCU5XTF9EU0lfVk1fTk9OX0JVUlNUX01PREVfV0lUSF9TWU5D
X0VWRU5UUyk7CisJCW53bF9kc2lfd3JpdGUoZHNpLCBOV0xfRFNJX1ZJREVPX01PREUsIG1vZGUp
OworCQlud2xfZHNpX3dyaXRlKGRzaSwgTldMX0RTSV9QSVhFTF9GSUZPX1NFTkRfTEVWRUwsCisJ
CQkgICAgICBkc2ktPm1vZGUuaGRpc3BsYXkpOworCX0KKworCW53bF9kc2lfd3JpdGUoZHNpLCBO
V0xfRFNJX0hGUCwgaGZyb250X3BvcmNoKTsKKwlud2xfZHNpX3dyaXRlKGRzaSwgTldMX0RTSV9I
QlAsIGhiYWNrX3BvcmNoKTsKKwlud2xfZHNpX3dyaXRlKGRzaSwgTldMX0RTSV9IU0EsIGhzeW5j
X2xlbik7CisKKwlud2xfZHNpX3dyaXRlKGRzaSwgTldMX0RTSV9FTkFCTEVfTVVMVF9QS1RTLCAw
eDApOworCW53bF9kc2lfd3JpdGUoZHNpLCBOV0xfRFNJX0JMTFBfTU9ERSwgMHgxKTsKKwlud2xf
ZHNpX3dyaXRlKGRzaSwgTldMX0RTSV9VU0VfTlVMTF9QS1RfQkxMUCwgMHgwKTsKKwlud2xfZHNp
X3dyaXRlKGRzaSwgTldMX0RTSV9WQywgMHgwKTsKKworCW53bF9kc2lfd3JpdGUoZHNpLCBOV0xf
RFNJX1BJWEVMX1BBWUxPQURfU0laRSwgZHNpLT5tb2RlLmhkaXNwbGF5KTsKKwlud2xfZHNpX3dy
aXRlKGRzaSwgTldMX0RTSV9WQUNUSVZFLCBkc2ktPm1vZGUudmRpc3BsYXkgLSAxKTsKKwlud2xf
ZHNpX3dyaXRlKGRzaSwgTldMX0RTSV9WQlAsIHZiYWNrX3BvcmNoKTsKKwlud2xfZHNpX3dyaXRl
KGRzaSwgTldMX0RTSV9WRlAsIHZmcm9udF9wb3JjaCk7CisKKwlyZXR1cm4gMDsKK30KKworc3Rh
dGljIHZvaWQgbndsX2RzaV9pbml0X2ludGVycnVwdHMoc3RydWN0IG53bF9kc2kgKmRzaSkKK3sK
Kwl1MzIgaXJxX2VuYWJsZTsKKworCW53bF9kc2lfd3JpdGUoZHNpLCBOV0xfRFNJX0lSUV9NQVNL
LCAweGZmZmZmZmZmKTsKKwlud2xfZHNpX3dyaXRlKGRzaSwgTldMX0RTSV9JUlFfTUFTSzIsIDB4
Nyk7CisKKwlpcnFfZW5hYmxlID0gfih1MzIpKE5XTF9EU0lfVFhfUEtUX0RPTkVfTUFTSyB8CisJ
CQkgICAgTldMX0RTSV9SWF9QS1RfSERSX1JDVkRfTUFTSyB8CisJCQkgICAgTldMX0RTSV9UWF9G
SUZPX09WRkxXX01BU0sgfAorCQkJICAgIE5XTF9EU0lfSFNfVFhfVElNRU9VVF9NQVNLKTsKKwor
CW53bF9kc2lfd3JpdGUoZHNpLCBOV0xfRFNJX0lSUV9NQVNLLCBpcnFfZW5hYmxlKTsKK30KKwor
c3RhdGljIGludCBud2xfZHNpX2hvc3RfYXR0YWNoKHN0cnVjdCBtaXBpX2RzaV9ob3N0ICpkc2lf
aG9zdCwKKwkJCSAgICAgICBzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkZXZpY2UpCit7CisJc3Ry
dWN0IG53bF9kc2kgKmRzaSA9IGNvbnRhaW5lcl9vZihkc2lfaG9zdCwgc3RydWN0IG53bF9kc2ks
IGRzaV9ob3N0KTsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSBkc2ktPmRldjsKKwlzdHJ1Y3QgZHJt
X2JyaWRnZSAqYnJpZGdlOworCXN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsOworCWludCByZXQ7CisK
KwlEUk1fREVWX0lORk8oZGV2LCAibGFuZXM9JXUsIGZvcm1hdD0weCV4IGZsYWdzPTB4JWx4XG4i
LCBkZXZpY2UtPmxhbmVzLAorCQkgICAgIGRldmljZS0+Zm9ybWF0LCBkZXZpY2UtPm1vZGVfZmxh
Z3MpOworCisJaWYgKGRldmljZS0+bGFuZXMgPCAxIHx8IGRldmljZS0+bGFuZXMgPiA0KQorCQly
ZXR1cm4gLUVJTlZBTDsKKworCWRzaS0+bGFuZXMgPSBkZXZpY2UtPmxhbmVzOworCWRzaS0+Zm9y
bWF0ID0gZGV2aWNlLT5mb3JtYXQ7CisJZHNpLT5kc2lfbW9kZV9mbGFncyA9IGRldmljZS0+bW9k
ZV9mbGFnczsKKworCXJldCA9IGRybV9vZl9maW5kX3BhbmVsX29yX2JyaWRnZShkc2ktPmRldi0+
b2Zfbm9kZSwgMSwgMCwgJnBhbmVsLAorCQkJCQkgICZicmlkZ2UpOworCWlmIChyZXQpCisJCXJl
dHVybiByZXQ7CisKKwlpZiAocGFuZWwpIHsKKwkJYnJpZGdlID0gZHJtX3BhbmVsX2JyaWRnZV9h
ZGQocGFuZWwsIERSTV9NT0RFX0NPTk5FQ1RPUl9EU0kpOworCQlpZiAoSVNfRVJSKGJyaWRnZSkp
CisJCQlyZXR1cm4gUFRSX0VSUihicmlkZ2UpOworCX0KKworCWRzaS0+cGFuZWxfYnJpZGdlID0g
YnJpZGdlOworCWRybV9icmlkZ2VfYWRkKCZkc2ktPmJyaWRnZSk7CisKKwlyZXR1cm4gMDsKK30K
Kworc3RhdGljIGludCBud2xfZHNpX2hvc3RfZGV0YWNoKHN0cnVjdCBtaXBpX2RzaV9ob3N0ICpk
c2lfaG9zdCwKKwkJCSAgICAgICBzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkZXZpY2UpCit7CisJ
c3RydWN0IG53bF9kc2kgKmRzaSA9IGNvbnRhaW5lcl9vZihkc2lfaG9zdCwgc3RydWN0IG53bF9k
c2ksIGRzaV9ob3N0KTsKKworCWRybV9vZl9wYW5lbF9icmlkZ2VfcmVtb3ZlKGRzaS0+ZGV2LT5v
Zl9ub2RlLCAxLCAwKTsKKwlkcm1fYnJpZGdlX3JlbW92ZSgmZHNpLT5icmlkZ2UpOworCisJcmV0
dXJuIDA7Cit9CisKK3N0YXRpYyBib29sIG53bF9kc2lfcmVhZF9wYWNrZXQoc3RydWN0IG53bF9k
c2kgKmRzaSwgdTMyIHN0YXR1cykKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSBkc2ktPmRldjsK
KwlzdHJ1Y3QgbndsX2RzaV90cmFuc2ZlciAqeGZlciA9IGRzaS0+eGZlcjsKKwl1OCAqcGF5bG9h
ZCA9IHhmZXItPm1zZy0+cnhfYnVmOworCXUzMiB2YWw7CisJdTE2IHdvcmRfY291bnQ7CisJdTgg
Y2hhbm5lbDsKKwl1OCBkYXRhX3R5cGU7CisKKwl4ZmVyLT5zdGF0dXMgPSAwOworCisJaWYgKHhm
ZXItPnJ4X3dvcmRfY291bnQgPT0gMCkgeworCQlpZiAoIShzdGF0dXMgJiBOV0xfRFNJX1JYX1BL
VF9IRFJfUkNWRCkpCisJCQlyZXR1cm4gZmFsc2U7CisJCS8qIEdldCB0aGUgUlggaGVhZGVyIGFu
ZCBwYXJzZSBpdCAqLworCQl2YWwgPSBud2xfZHNpX3JlYWQoZHNpLCBOV0xfRFNJX1JYX1BLVF9I
RUFERVIpOworCQl3b3JkX2NvdW50ID0gTldMX0RTSV9XQyh2YWwpOworCQljaGFubmVsID0gTldM
X0RTSV9SWF9WQyh2YWwpOworCQlkYXRhX3R5cGUgPSBOV0xfRFNJX1JYX0RUKHZhbCk7CisKKwkJ
aWYgKGNoYW5uZWwgIT0geGZlci0+bXNnLT5jaGFubmVsKSB7CisJCQlEUk1fREVWX0VSUk9SKGRl
diwKKwkJCQkgICAgICAiWyUwMlhdIENoYW5uZWwgbWlzbWF0Y2ggKCV1ICE9ICV1KVxuIiwKKwkJ
CQkgICAgICB4ZmVyLT5jbWQsIGNoYW5uZWwsIHhmZXItPm1zZy0+Y2hhbm5lbCk7CisJCQlyZXR1
cm4gdHJ1ZTsKKwkJfQorCisJCXN3aXRjaCAoZGF0YV90eXBlKSB7CisJCWNhc2UgTUlQSV9EU0lf
UlhfR0VORVJJQ19TSE9SVF9SRUFEX1JFU1BPTlNFXzJCWVRFOgorCQkJLyogRmFsbCB0aHJvdWdo
ICovCisJCWNhc2UgTUlQSV9EU0lfUlhfRENTX1NIT1JUX1JFQURfUkVTUE9OU0VfMkJZVEU6CisJ
CQlpZiAoeGZlci0+bXNnLT5yeF9sZW4gPiAxKSB7CisJCQkJLyogcmVhZCBzZWNvbmQgYnl0ZSAq
LworCQkJCXBheWxvYWRbMV0gPSB3b3JkX2NvdW50ID4+IDg7CisJCQkJKyt4ZmVyLT5yeF9sZW47
CisJCQl9CisJCQkvKiBGYWxsIHRocm91Z2ggKi8KKwkJY2FzZSBNSVBJX0RTSV9SWF9HRU5FUklD
X1NIT1JUX1JFQURfUkVTUE9OU0VfMUJZVEU6CisJCQkvKiBGYWxsIHRocm91Z2ggKi8KKwkJY2Fz
ZSBNSVBJX0RTSV9SWF9EQ1NfU0hPUlRfUkVBRF9SRVNQT05TRV8xQllURToKKwkJCWlmICh4ZmVy
LT5tc2ctPnJ4X2xlbiA+IDApIHsKKwkJCQkvKiByZWFkIGZpcnN0IGJ5dGUgKi8KKwkJCQlwYXls
b2FkWzBdID0gd29yZF9jb3VudCAmIDB4ZmY7CisJCQkJKyt4ZmVyLT5yeF9sZW47CisJCQl9CisJ
CQl4ZmVyLT5zdGF0dXMgPSB4ZmVyLT5yeF9sZW47CisJCQlyZXR1cm4gdHJ1ZTsKKwkJY2FzZSBN
SVBJX0RTSV9SWF9BQ0tOT1dMRURHRV9BTkRfRVJST1JfUkVQT1JUOgorCQkJd29yZF9jb3VudCAm
PSAweGZmOworCQkJRFJNX0RFVl9FUlJPUihkZXYsICJbJTAyWF0gRFNJIGVycm9yIHJlcG9ydDog
MHglMDJ4XG4iLAorCQkJCSAgICAgIHhmZXItPmNtZCwgd29yZF9jb3VudCk7CisJCQl4ZmVyLT5z
dGF0dXMgPSAtRVBST1RPOworCQkJcmV0dXJuIHRydWU7CisJCX0KKworCQlpZiAod29yZF9jb3Vu
dCA+IHhmZXItPm1zZy0+cnhfbGVuKSB7CisJCQlEUk1fREVWX0VSUk9SKAorCQkJCWRldiwKKwkJ
CQkiWyUwMlhdIFJlY2VpdmUgYnVmZmVyIHRvbyBzbWFsbDogJXp1ICg8ICV1KVxuIiwKKwkJCQl4
ZmVyLT5jbWQsIHhmZXItPm1zZy0+cnhfbGVuLCB3b3JkX2NvdW50KTsKKwkJCXJldHVybiB0cnVl
OworCQl9CisKKwkJeGZlci0+cnhfd29yZF9jb3VudCA9IHdvcmRfY291bnQ7CisJfSBlbHNlIHsK
KwkJLyogU2V0IHdvcmRfY291bnQgZnJvbSBwcmV2aW91cyBoZWFkZXIgcmVhZCAqLworCQl3b3Jk
X2NvdW50ID0geGZlci0+cnhfd29yZF9jb3VudDsKKwl9CisKKwkvKiBJZiBSWCBwYXlsb2FkIGlz
IG5vdCB5ZXQgcmVjZWl2ZWQsIHdhaXQgZm9yIGl0ICovCisJaWYgKCEoc3RhdHVzICYgTldMX0RT
SV9SWF9QS1RfUEFZTE9BRF9EQVRBX1JDVkQpKQorCQlyZXR1cm4gZmFsc2U7CisKKwkvKiBSZWFk
IHRoZSBSWCBwYXlsb2FkICovCisJd2hpbGUgKHdvcmRfY291bnQgPj0gNCkgeworCQl2YWwgPSBu
d2xfZHNpX3JlYWQoZHNpLCBOV0xfRFNJX1JYX1BBWUxPQUQpOworCQlwYXlsb2FkWzBdID0gKHZh
bCA+PiAwKSAmIDB4ZmY7CisJCXBheWxvYWRbMV0gPSAodmFsID4+IDgpICYgMHhmZjsKKwkJcGF5
bG9hZFsyXSA9ICh2YWwgPj4gMTYpICYgMHhmZjsKKwkJcGF5bG9hZFszXSA9ICh2YWwgPj4gMjQp
ICYgMHhmZjsKKwkJcGF5bG9hZCArPSA0OworCQl4ZmVyLT5yeF9sZW4gKz0gNDsKKwkJd29yZF9j
b3VudCAtPSA0OworCX0KKworCWlmICh3b3JkX2NvdW50ID4gMCkgeworCQl2YWwgPSBud2xfZHNp
X3JlYWQoZHNpLCBOV0xfRFNJX1JYX1BBWUxPQUQpOworCQlzd2l0Y2ggKHdvcmRfY291bnQpIHsK
KwkJY2FzZSAzOgorCQkJcGF5bG9hZFsyXSA9ICh2YWwgPj4gMTYpICYgMHhmZjsKKwkJCSsreGZl
ci0+cnhfbGVuOworCQkJLyogRmFsbCB0aHJvdWdoICovCisJCWNhc2UgMjoKKwkJCXBheWxvYWRb
MV0gPSAodmFsID4+IDgpICYgMHhmZjsKKwkJCSsreGZlci0+cnhfbGVuOworCQkJLyogRmFsbCB0
aHJvdWdoICovCisJCWNhc2UgMToKKwkJCXBheWxvYWRbMF0gPSAodmFsID4+IDApICYgMHhmZjsK
KwkJCSsreGZlci0+cnhfbGVuOworCQkJYnJlYWs7CisJCX0KKwl9CisKKwl4ZmVyLT5zdGF0dXMg
PSB4ZmVyLT5yeF9sZW47CisKKwlyZXR1cm4gdHJ1ZTsKK30KKworc3RhdGljIHZvaWQgbndsX2Rz
aV9maW5pc2hfdHJhbnNtaXNzaW9uKHN0cnVjdCBud2xfZHNpICpkc2ksIHUzMiBzdGF0dXMpCit7
CisJc3RydWN0IG53bF9kc2lfdHJhbnNmZXIgKnhmZXIgPSBkc2ktPnhmZXI7CisJYm9vbCBlbmRf
cGFja2V0ID0gZmFsc2U7CisKKwlpZiAoIXhmZXIpCisJCXJldHVybjsKKworCWlmICh4ZmVyLT5k
aXJlY3Rpb24gPT0gRFNJX1BBQ0tFVF9TRU5EICYmCisJICAgIHN0YXR1cyAmIE5XTF9EU0lfVFhf
UEtUX0RPTkUpIHsKKwkJeGZlci0+c3RhdHVzID0geGZlci0+dHhfbGVuOworCQllbmRfcGFja2V0
ID0gdHJ1ZTsKKwl9IGVsc2UgaWYgKHN0YXR1cyAmIE5XTF9EU0lfRFBIWV9ESVJFQ1RJT04gJiYK
KwkJICAgKChzdGF0dXMgJiAoTldMX0RTSV9SWF9QS1RfSERSX1JDVkQgfAorCQkJICAgICAgIE5X
TF9EU0lfUlhfUEtUX1BBWUxPQURfREFUQV9SQ1ZEKSkpKSB7CisJCWVuZF9wYWNrZXQgPSBud2xf
ZHNpX3JlYWRfcGFja2V0KGRzaSwgc3RhdHVzKTsKKwl9CisKKwlpZiAoZW5kX3BhY2tldCkKKwkJ
Y29tcGxldGUoJnhmZXItPmNvbXBsZXRlZCk7Cit9CisKK3N0YXRpYyB2b2lkIG53bF9kc2lfYmVn
aW5fdHJhbnNtaXNzaW9uKHN0cnVjdCBud2xfZHNpICpkc2kpCit7CisJc3RydWN0IG53bF9kc2lf
dHJhbnNmZXIgKnhmZXIgPSBkc2ktPnhmZXI7CisJc3RydWN0IG1pcGlfZHNpX3BhY2tldCAqcGt0
ID0gJnhmZXItPnBhY2tldDsKKwljb25zdCB1OCAqcGF5bG9hZDsKKwlzaXplX3QgbGVuZ3RoOwor
CXUxNiB3b3JkX2NvdW50OworCXU4IGhzX21vZGU7CisJdTMyIHZhbDsKKwl1MzIgaHNfd29ya2Fy
b3VuZCA9IDA7CisKKwkvKiBTZW5kIHRoZSBwYXlsb2FkLCBpZiBhbnkgKi8KKwlsZW5ndGggPSBw
a3QtPnBheWxvYWRfbGVuZ3RoOworCXBheWxvYWQgPSBwa3QtPnBheWxvYWQ7CisKKwl3aGlsZSAo
bGVuZ3RoID49IDQpIHsKKwkJdmFsID0gKih1MzIgKilwYXlsb2FkOworCQloc193b3JrYXJvdW5k
IHw9ICEodmFsICYgMHhGRkZGMDApOworCQlud2xfZHNpX3dyaXRlKGRzaSwgTldMX0RTSV9UWF9Q
QVlMT0FELCB2YWwpOworCQlwYXlsb2FkICs9IDQ7CisJCWxlbmd0aCAtPSA0OworCX0KKwkvKiBT
ZW5kIHRoZSByZXN0IG9mIHRoZSBwYXlsb2FkICovCisJdmFsID0gMDsKKwlzd2l0Y2ggKGxlbmd0
aCkgeworCWNhc2UgMzoKKwkJdmFsIHw9IHBheWxvYWRbMl0gPDwgMTY7CisJCS8qIEZhbGwgdGhy
b3VnaCAqLworCWNhc2UgMjoKKwkJdmFsIHw9IHBheWxvYWRbMV0gPDwgODsKKwkJaHNfd29ya2Fy
b3VuZCB8PSAhKHZhbCAmIDB4RkZGRjAwKTsKKwkJLyogRmFsbCB0aHJvdWdoICovCisJY2FzZSAx
OgorCQl2YWwgfD0gcGF5bG9hZFswXTsKKwkJbndsX2RzaV93cml0ZShkc2ksIE5XTF9EU0lfVFhf
UEFZTE9BRCwgdmFsKTsKKwkJYnJlYWs7CisJfQorCXhmZXItPnR4X2xlbiA9IHBrdC0+cGF5bG9h
ZF9sZW5ndGg7CisKKwkvKgorCSAqIFNlbmQgdGhlIGhlYWRlcgorCSAqIGhlYWRlclswXSA9IFZp
cnR1YWwgQ2hhbm5lbCArIERhdGEgVHlwZQorCSAqIGhlYWRlclsxXSA9IFdvcmQgQ291bnQgTFNC
IChMUCkgb3IgZmlyc3QgcGFyYW0gKFNQKQorCSAqIGhlYWRlclsyXSA9IFdvcmQgQ291bnQgTVNC
IChMUCkgb3Igc2Vjb25kIHBhcmFtIChTUCkKKwkgKi8KKwl3b3JkX2NvdW50ID0gcGt0LT5oZWFk
ZXJbMV0gfCAocGt0LT5oZWFkZXJbMl0gPDwgOCk7CisJaWYgKGhzX3dvcmthcm91bmQgJiYgKGRz
aS0+cXVpcmtzICYgRTExNDE4X0hTX01PREVfUVVJUkspKSB7CisJCURSTV9ERVZfREVCVUdfRFJJ
VkVSKGRzaS0+ZGV2LAorCQkJCSAgICAgIlVzaW5nIGhzIG1vZGUgd29ya2Fyb3VuZCBmb3IgY21k
IDB4JXhcbiIsCisJCQkJICAgICB4ZmVyLT5jbWQpOworCQloc19tb2RlID0gMTsKKwl9IGVsc2Ug
eworCQloc19tb2RlID0gKHhmZXItPm1zZy0+ZmxhZ3MgJiBNSVBJX0RTSV9NU0dfVVNFX0xQTSkg
PyAwIDogMTsKKwl9CisJdmFsID0gTldMX0RTSV9XQyh3b3JkX2NvdW50KSB8IE5XTF9EU0lfVFhf
VkMoeGZlci0+bXNnLT5jaGFubmVsKSB8CisJICAgICAgTldMX0RTSV9UWF9EVCh4ZmVyLT5tc2ct
PnR5cGUpIHwgTldMX0RTSV9IU19TRUwoaHNfbW9kZSkgfAorCSAgICAgIE5XTF9EU0lfQlRBX1RY
KHhmZXItPm5lZWRfYnRhKTsKKwlud2xfZHNpX3dyaXRlKGRzaSwgTldMX0RTSV9QS1RfQ09OVFJP
TCwgdmFsKTsKKworCS8qIFNlbmQgcGFja2V0IGNvbW1hbmQgKi8KKwlud2xfZHNpX3dyaXRlKGRz
aSwgTldMX0RTSV9TRU5EX1BBQ0tFVCwgMHgxKTsKK30KKworc3RhdGljIHNzaXplX3QgbndsX2Rz
aV9ob3N0X3RyYW5zZmVyKHN0cnVjdCBtaXBpX2RzaV9ob3N0ICpkc2lfaG9zdCwKKwkJCQkgICAg
IGNvbnN0IHN0cnVjdCBtaXBpX2RzaV9tc2cgKm1zZykKK3sKKwlzdHJ1Y3QgbndsX2RzaSAqZHNp
ID0gY29udGFpbmVyX29mKGRzaV9ob3N0LCBzdHJ1Y3QgbndsX2RzaSwgZHNpX2hvc3QpOworCXN0
cnVjdCBud2xfZHNpX3RyYW5zZmVyIHhmZXI7CisJc3NpemVfdCByZXQgPSAwOworCisJLyogQ3Jl
YXRlIHBhY2tldCB0byBiZSBzZW50ICovCisJZHNpLT54ZmVyID0gJnhmZXI7CisJcmV0ID0gbWlw
aV9kc2lfY3JlYXRlX3BhY2tldCgmeGZlci5wYWNrZXQsIG1zZyk7CisJaWYgKHJldCA8IDApIHsK
KwkJZHNpLT54ZmVyID0gTlVMTDsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlpZiAoKG1zZy0+dHlw
ZSAmIE1JUElfRFNJX0dFTkVSSUNfUkVBRF9SRVFVRVNUXzBfUEFSQU0gfHwKKwkgICAgIG1zZy0+
dHlwZSAmIE1JUElfRFNJX0dFTkVSSUNfUkVBRF9SRVFVRVNUXzFfUEFSQU0gfHwKKwkgICAgIG1z
Zy0+dHlwZSAmIE1JUElfRFNJX0dFTkVSSUNfUkVBRF9SRVFVRVNUXzJfUEFSQU0gfHwKKwkgICAg
IG1zZy0+dHlwZSAmIE1JUElfRFNJX0RDU19SRUFEKSAmJgorCSAgICBtc2ctPnJ4X2xlbiA+IDAg
JiYgbXNnLT5yeF9idWYgIT0gTlVMTCkKKwkJeGZlci5kaXJlY3Rpb24gPSBEU0lfUEFDS0VUX1JF
Q0VJVkU7CisJZWxzZQorCQl4ZmVyLmRpcmVjdGlvbiA9IERTSV9QQUNLRVRfU0VORDsKKworCXhm
ZXIubmVlZF9idGEgPSAoeGZlci5kaXJlY3Rpb24gPT0gRFNJX1BBQ0tFVF9SRUNFSVZFKTsKKwl4
ZmVyLm5lZWRfYnRhIHw9IChtc2ctPmZsYWdzICYgTUlQSV9EU0lfTVNHX1JFUV9BQ0spID8gMSA6
IDA7CisJeGZlci5tc2cgPSBtc2c7CisJeGZlci5zdGF0dXMgPSAtRVRJTUVET1VUOworCXhmZXIu
cnhfd29yZF9jb3VudCA9IDA7CisJeGZlci5yeF9sZW4gPSAwOworCXhmZXIuY21kID0gMHgwMDsK
KwlpZiAobXNnLT50eF9sZW4gPiAwKQorCQl4ZmVyLmNtZCA9ICgodTggKikobXNnLT50eF9idWYp
KVswXTsKKwlpbml0X2NvbXBsZXRpb24oJnhmZXIuY29tcGxldGVkKTsKKworCXJldCA9IGNsa19w
cmVwYXJlX2VuYWJsZShkc2ktPnJ4X2VzY19jbGspOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9E
RVZfRVJST1IoZHNpLT5kZXYsICJGYWlsZWQgdG8gZW5hYmxlIHJ4X2VzYyBjbGs6ICV6ZFxuIiwK
KwkJCSAgICAgIHJldCk7CisJCXJldHVybiByZXQ7CisJfQorCURSTV9ERVZfREVCVUdfRFJJVkVS
KGRzaS0+ZGV2LCAiRW5hYmxlZCByeF9lc2MgY2xrIEAlbHUgSHpcbiIsCisJCQkgICAgIGNsa19n
ZXRfcmF0ZShkc2ktPnJ4X2VzY19jbGspKTsKKworCS8qIEluaXRpYXRlIHRoZSBEU0kgcGFja2V0
IHRyYW5zbWlzaW9uICovCisJbndsX2RzaV9iZWdpbl90cmFuc21pc3Npb24oZHNpKTsKKworCWlm
ICghd2FpdF9mb3JfY29tcGxldGlvbl90aW1lb3V0KCZ4ZmVyLmNvbXBsZXRlZCwKKwkJCQkJIE5X
TF9EU0lfTUlQSV9GSUZPX1RJTUVPVVQpKSB7CisJCURSTV9ERVZfRVJST1IoZHNpX2hvc3QtPmRl
diwgIlslMDJYXSBEU0kgdHJhbnNmZXIgdGltZWQgb3V0XG4iLAorCQkJICAgICAgeGZlci5jbWQp
OworCQlyZXQgPSAtRVRJTUVET1VUOworCX0gZWxzZSB7CisJCXJldCA9IHhmZXIuc3RhdHVzOwor
CX0KKworCWNsa19kaXNhYmxlX3VucHJlcGFyZShkc2ktPnJ4X2VzY19jbGspOworCisJcmV0dXJu
IHJldDsKK30KKworY29uc3Qgc3RydWN0IG1pcGlfZHNpX2hvc3Rfb3BzIG53bF9kc2lfaG9zdF9v
cHMgPSB7CisJLmF0dGFjaCA9IG53bF9kc2lfaG9zdF9hdHRhY2gsCisJLmRldGFjaCA9IG53bF9k
c2lfaG9zdF9kZXRhY2gsCisJLnRyYW5zZmVyID0gbndsX2RzaV9ob3N0X3RyYW5zZmVyLAorfTsK
KworaXJxcmV0dXJuX3QgbndsX2RzaV9pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICpkYXRhKQor
eworCXUzMiBpcnFfc3RhdHVzOworCXN0cnVjdCBud2xfZHNpICpkc2kgPSBkYXRhOworCisJaXJx
X3N0YXR1cyA9IG53bF9kc2lfcmVhZChkc2ksIE5XTF9EU0lfSVJRX1NUQVRVUyk7CisKKwlpZiAo
aXJxX3N0YXR1cyAmIE5XTF9EU0lfVFhfRklGT19PVkZMVykKKwkJRFJNX0RFVl9FUlJPUl9SQVRF
TElNSVRFRChkc2ktPmRldiwgInR4IGZpZm8gb3ZlcmZsb3dcbiIpOworCisJaWYgKGlycV9zdGF0
dXMgJiBOV0xfRFNJX0hTX1RYX1RJTUVPVVQpCisJCURSTV9ERVZfRVJST1JfUkFURUxJTUlURUQo
ZHNpLT5kZXYsICJIUyB0eCB0aW1lb3V0XG4iKTsKKworCWlmIChpcnFfc3RhdHVzICYgTldMX0RT
SV9UWF9QS1RfRE9ORSB8fAorCSAgICBpcnFfc3RhdHVzICYgTldMX0RTSV9SWF9QS1RfSERSX1JD
VkQgfHwKKwkgICAgaXJxX3N0YXR1cyAmIE5XTF9EU0lfUlhfUEtUX1BBWUxPQURfREFUQV9SQ1ZE
KQorCQlud2xfZHNpX2ZpbmlzaF90cmFuc21pc3Npb24oZHNpLCBpcnFfc3RhdHVzKTsKKworCXJl
dHVybiBJUlFfSEFORExFRDsKK30KKworaW50IG53bF9kc2lfZW5hYmxlKHN0cnVjdCBud2xfZHNp
ICpkc2kpCit7CisJc3RydWN0IGRldmljZSAqZGV2ID0gZHNpLT5kZXY7CisJdW5pb24gcGh5X2Nv
bmZpZ3VyZV9vcHRzICpwaHlfY2ZnID0gJmRzaS0+cGh5X2NmZzsKKwlpbnQgcmV0OworCisJaWYg
KCFkc2ktPmxhbmVzKSB7CisJCURSTV9ERVZfRVJST1IoZGV2LCAiTmVlZCBEU0kgbGFuZXM6ICVk
XG4iLCBkc2ktPmxhbmVzKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJcmV0ID0gcGh5X2lu
aXQoZHNpLT5waHkpOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9ERVZfRVJST1IoZGV2LCAiRmFp
bGVkIHRvIGluaXQgRFNJIHBoeTogJWRcbiIsIHJldCk7CisJCXJldHVybiByZXQ7CisJfQorCisJ
cmV0ID0gcGh5X2NvbmZpZ3VyZShkc2ktPnBoeSwgcGh5X2NmZyk7CisJaWYgKHJldCA8IDApIHsK
KwkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8gY29uZmlndXJlIERTSSBwaHk6ICVkXG4i
LCByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKworCXJldCA9IGNsa19wcmVwYXJlX2VuYWJsZShk
c2ktPnR4X2VzY19jbGspOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9ERVZfRVJST1IoZHNpLT5k
ZXYsICJGYWlsZWQgdG8gZW5hYmxlIHR4X2VzYyBjbGs6ICVkXG4iLAorCQkJICAgICAgcmV0KTsK
KwkJcmV0dXJuIHJldDsKKwl9CisJRFJNX0RFVl9ERUJVR19EUklWRVIoZHNpLT5kZXYsICJFbmFi
bGVkIHR4X2VzYyBjbGsgQCVsdSBIelxuIiwKKwkJCSAgICAgY2xrX2dldF9yYXRlKGRzaS0+dHhf
ZXNjX2NsaykpOworCisJcmV0ID0gbndsX2RzaV9jb25maWdfaG9zdChkc2kpOworCWlmIChyZXQg
PCAwKSB7CisJCURSTV9ERVZfRVJST1IoZGV2LCAiRmFpbGVkIHRvIHNldCB1cCBEU0k6ICVkIiwg
cmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXQgPSBud2xfZHNpX2NvbmZpZ19kcGkoZHNp
KTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGRldiwgIkZhaWxlZCB0byBzZXQg
dXAgRFBJOiAlZCIsIHJldCk7CisJCXJldHVybiByZXQ7CisJfQorCisJcmV0ID0gcGh5X3Bvd2Vy
X29uKGRzaS0+cGh5KTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGRldiwgIkZh
aWxlZCB0byBwb3dlciBvbiBEUEhZICglZClcbiIsIHJldCk7CisJCXJldHVybiByZXQ7CisJfQor
CisJbndsX2RzaV9pbml0X2ludGVycnVwdHMoZHNpKTsKKworCXJldHVybiAwOworfQorCitpbnQg
bndsX2RzaV9kaXNhYmxlKHN0cnVjdCBud2xfZHNpICpkc2kpCit7CisJc3RydWN0IGRldmljZSAq
ZGV2ID0gZHNpLT5kZXY7CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJEaXNhYmxpbmcg
Y2xvY2tzIGFuZCBwaHlcbiIpOworCisJcGh5X3Bvd2VyX29mZihkc2ktPnBoeSk7CisJcGh5X2V4
aXQoZHNpLT5waHkpOworCisJLyogRGlzYWJsaW5nIHRoZSBjbG9jayBiZWZvcmUgdGhlIHBoeSBi
cmVha3MgZW5hYmxpbmcgZHNpIGFnYWluICovCisJY2xrX2Rpc2FibGVfdW5wcmVwYXJlKGRzaS0+
dHhfZXNjX2Nsayk7CisKKwlyZXR1cm4gMDsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9icmlkZ2UvbndsLWRzaS9ud2wtZHNpLmggYi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL253bC1k
c2kvbndsLWRzaS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uNTc5
YjM2NmRlNjUyCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9ud2wt
ZHNpL253bC1kc2kuaApAQCAtMCwwICsxLDExMiBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IEdQTC0yLjArICovCisvKgorICogTldMIE1JUEkgRFNJIGhvc3QgZHJpdmVyCisgKgorICog
Q29weXJpZ2h0IChDKSAyMDE3IE5YUAorICogQ29weXJpZ2h0IChDKSAyMDE5IFB1cmlzbSBTUEMK
KyAqLworI2lmbmRlZiBfX05XTF9EU0lfSF9fCisjZGVmaW5lIF9fTldMX0RTSV9IX18KKworI2lu
Y2x1ZGUgPGxpbnV4L2lycXJldHVybi5oPgorCisjaW5jbHVkZSA8ZHJtL2RybV9taXBpX2RzaS5o
PgorCisjaW5jbHVkZSAibndsLWRydi5oIgorCisvKiBEU0kgSE9TVCByZWdpc3RlcnMgKi8KKyNk
ZWZpbmUgTldMX0RTSV9DRkdfTlVNX0xBTkVTCQkJMHgwCisjZGVmaW5lIE5XTF9EU0lfQ0ZHX05P
TkNPTlRJTlVPVVNfQ0xLCQkweDQKKyNkZWZpbmUgTldMX0RTSV9DRkdfVF9QUkUJCQkweDgKKyNk
ZWZpbmUgTldMX0RTSV9DRkdfVF9QT1NUCQkJMHhjCisjZGVmaW5lIE5XTF9EU0lfQ0ZHX1RYX0dB
UAkJCTB4MTAKKyNkZWZpbmUgTldMX0RTSV9DRkdfQVVUT0lOU0VSVF9FT1RQCQkweDE0CisjZGVm
aW5lIE5XTF9EU0lfQ0ZHX0VYVFJBX0NNRFNfQUZURVJfRU9UUAkweDE4CisjZGVmaW5lIE5XTF9E
U0lfQ0ZHX0hUWF9UT19DT1VOVAkJMHgxYworI2RlZmluZSBOV0xfRFNJX0NGR19MUlhfSF9UT19D
T1VOVAkJMHgyMAorI2RlZmluZSBOV0xfRFNJX0NGR19CVEFfSF9UT19DT1VOVAkJMHgyNAorI2Rl
ZmluZSBOV0xfRFNJX0NGR19UV0FLRVVQCQkJMHgyOAorI2RlZmluZSBOV0xfRFNJX0NGR19TVEFU
VVNfT1VUCQkJMHgyYworI2RlZmluZSBOV0xfRFNJX1JYX0VSUk9SX1NUQVRVUwkJCTB4MzAKKwor
LyogRFNJIERQSSByZWdpc3RlcnMgKi8KKyNkZWZpbmUgTldMX0RTSV9QSVhFTF9QQVlMT0FEX1NJ
WkUJCTB4MjAwCisjZGVmaW5lIE5XTF9EU0lfUElYRUxfRklGT19TRU5EX0xFVkVMCQkweDIwNAor
I2RlZmluZSBOV0xfRFNJX0lOVEVSRkFDRV9DT0xPUl9DT0RJTkcJCTB4MjA4CisjZGVmaW5lIE5X
TF9EU0lfUElYRUxfRk9STUFUCQkJMHgyMGMKKyNkZWZpbmUgTldMX0RTSV9WU1lOQ19QT0xBUklU
WQkJCTB4MjEwCisjZGVmaW5lIE5XTF9EU0lfVlNZTkNfUE9MQVJJVFlfQUNUSVZFX0xPVwkwCisj
ZGVmaW5lIE5XTF9EU0lfVlNZTkNfUE9MQVJJVFlfQUNUSVZFX0hJR0gJQklUKDEpCisKKyNkZWZp
bmUgTldMX0RTSV9IU1lOQ19QT0xBUklUWQkJCTB4MjE0CisjZGVmaW5lIE5XTF9EU0lfSFNZTkNf
UE9MQVJJVFlfQUNUSVZFX0xPVwkwCisjZGVmaW5lIE5XTF9EU0lfSFNZTkNfUE9MQVJJVFlfQUNU
SVZFX0hJR0gJQklUKDEpCisKKyNkZWZpbmUgTldMX0RTSV9WSURFT19NT0RFCQkJMHgyMTgKKyNk
ZWZpbmUgTldMX0RTSV9IRlAJCQkJMHgyMWMKKyNkZWZpbmUgTldMX0RTSV9IQlAJCQkJMHgyMjAK
KyNkZWZpbmUgTldMX0RTSV9IU0EJCQkJMHgyMjQKKyNkZWZpbmUgTldMX0RTSV9FTkFCTEVfTVVM
VF9QS1RTCQkweDIyOAorI2RlZmluZSBOV0xfRFNJX1ZCUAkJCQkweDIyYworI2RlZmluZSBOV0xf
RFNJX1ZGUAkJCQkweDIzMAorI2RlZmluZSBOV0xfRFNJX0JMTFBfTU9ERQkJCTB4MjM0CisjZGVm
aW5lIE5XTF9EU0lfVVNFX05VTExfUEtUX0JMTFAJCTB4MjM4CisjZGVmaW5lIE5XTF9EU0lfVkFD
VElWRQkJCQkweDIzYworI2RlZmluZSBOV0xfRFNJX1ZDCQkJCTB4MjQwCisKKy8qIERTSSBBUEIg
UEtUIGNvbnRyb2wgKi8KKyNkZWZpbmUgTldMX0RTSV9UWF9QQVlMT0FECQkJMHgyODAKKyNkZWZp
bmUgTldMX0RTSV9QS1RfQ09OVFJPTAkJCTB4Mjg0CisjZGVmaW5lIE5XTF9EU0lfU0VORF9QQUNL
RVQJCQkweDI4OAorI2RlZmluZSBOV0xfRFNJX1BLVF9TVEFUVVMJCQkweDI4YworI2RlZmluZSBO
V0xfRFNJX1BLVF9GSUZPX1dSX0xFVkVMCQkweDI5MAorI2RlZmluZSBOV0xfRFNJX1BLVF9GSUZP
X1JEX0xFVkVMCQkweDI5NAorI2RlZmluZSBOV0xfRFNJX1JYX1BBWUxPQUQJCQkweDI5OAorI2Rl
ZmluZSBOV0xfRFNJX1JYX1BLVF9IRUFERVIJCQkweDI5YworCisvKiBEU0kgSVJRIGhhbmRsaW5n
ICovCisjZGVmaW5lIE5XTF9EU0lfSVJRX1NUQVRVUwkJCTB4MmEwCisjZGVmaW5lIE5XTF9EU0lf
U01fTk9UX0lETEUJCQlCSVQoMCkKKyNkZWZpbmUgTldMX0RTSV9UWF9QS1RfRE9ORQkJCUJJVCgx
KQorI2RlZmluZSBOV0xfRFNJX0RQSFlfRElSRUNUSU9OCQkJQklUKDIpCisjZGVmaW5lIE5XTF9E
U0lfVFhfRklGT19PVkZMVwkJCUJJVCgzKQorI2RlZmluZSBOV0xfRFNJX1RYX0ZJRk9fVURGTFcJ
CQlCSVQoNCkKKyNkZWZpbmUgTldMX0RTSV9SWF9GSUZPX09WRkxXCQkJQklUKDUpCisjZGVmaW5l
IE5XTF9EU0lfUlhfRklGT19VREZMVwkJCUJJVCg2KQorI2RlZmluZSBOV0xfRFNJX1JYX1BLVF9I
RFJfUkNWRAkJCUJJVCg3KQorI2RlZmluZSBOV0xfRFNJX1JYX1BLVF9QQVlMT0FEX0RBVEFfUkNW
RAlCSVQoOCkKKyNkZWZpbmUgTldMX0RTSV9CVEFfVElNRU9VVAkJCUJJVCgyOSkKKyNkZWZpbmUg
TldMX0RTSV9MUF9SWF9USU1FT1VUCQkJQklUKDMwKQorI2RlZmluZSBOV0xfRFNJX0hTX1RYX1RJ
TUVPVVQJCQlCSVQoMzEpCisKKyNkZWZpbmUgTldMX0RTSV9JUlFfU1RBVFVTMgkJCTB4MmE0Cisj
ZGVmaW5lIE5XTF9EU0lfU0lOR0xFX0JJVF9FQ0NfRVJSCQlCSVQoMCkKKyNkZWZpbmUgTldMX0RT
SV9NVUxUSV9CSVRfRUNDX0VSUgkJQklUKDEpCisjZGVmaW5lIE5XTF9EU0lfQ1JDX0VSUgkJCQlC
SVQoMikKKworI2RlZmluZSBOV0xfRFNJX0lSUV9NQVNLCQkJMHgyYTgKKyNkZWZpbmUgTldMX0RT
SV9TTV9OT1RfSURMRV9NQVNLCQlCSVQoMCkKKyNkZWZpbmUgTldMX0RTSV9UWF9QS1RfRE9ORV9N
QVNLCQlCSVQoMSkKKyNkZWZpbmUgTldMX0RTSV9EUEhZX0RJUkVDVElPTl9NQVNLCQlCSVQoMikK
KyNkZWZpbmUgTldMX0RTSV9UWF9GSUZPX09WRkxXX01BU0sJCUJJVCgzKQorI2RlZmluZSBOV0xf
RFNJX1RYX0ZJRk9fVURGTFdfTUFTSwkJQklUKDQpCisjZGVmaW5lIE5XTF9EU0lfUlhfRklGT19P
VkZMV19NQVNLCQlCSVQoNSkKKyNkZWZpbmUgTldMX0RTSV9SWF9GSUZPX1VERkxXX01BU0sJCUJJ
VCg2KQorI2RlZmluZSBOV0xfRFNJX1JYX1BLVF9IRFJfUkNWRF9NQVNLCQlCSVQoNykKKyNkZWZp
bmUgTldMX0RTSV9SWF9QS1RfUEFZTE9BRF9EQVRBX1JDVkRfTUFTSwlCSVQoOCkKKyNkZWZpbmUg
TldMX0RTSV9CVEFfVElNRU9VVF9NQVNLCQlCSVQoMjkpCisjZGVmaW5lIE5XTF9EU0lfTFBfUlhf
VElNRU9VVF9NQVNLCQlCSVQoMzApCisjZGVmaW5lIE5XTF9EU0lfSFNfVFhfVElNRU9VVF9NQVNL
CQlCSVQoMzEpCisKKyNkZWZpbmUgTldMX0RTSV9JUlFfTUFTSzIJCQkweDJhYworI2RlZmluZSBO
V0xfRFNJX1NJTkdMRV9CSVRfRUNDX0VSUl9NQVNLCQlCSVQoMCkKKyNkZWZpbmUgTldMX0RTSV9N
VUxUSV9CSVRfRUNDX0VSUl9NQVNLCQlCSVQoMSkKKyNkZWZpbmUgTldMX0RTSV9DUkNfRVJSX01B
U0sJCQlCSVQoMikKKworZXh0ZXJuIGNvbnN0IHN0cnVjdCBtaXBpX2RzaV9ob3N0X29wcyBud2xf
ZHNpX2hvc3Rfb3BzOworCitpcnFyZXR1cm5fdCBud2xfZHNpX2lycV9oYW5kbGVyKGludCBpcnEs
IHZvaWQgKmRhdGEpOworaW50IG53bF9kc2lfZW5hYmxlKHN0cnVjdCBud2xfZHNpICpkc2kpOwor
aW50IG53bF9kc2lfZGlzYWJsZShzdHJ1Y3QgbndsX2RzaSAqZHNpKTsKKworI2VuZGlmIC8qIF9f
TldMX0RTSV9IX18gKi8KLS0gCjIuMjMuMC5yYzEKCgpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBs
aXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1h
bi9saXN0aW5mby9kcmktZGV2ZWw=
