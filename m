Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 7F21E95330
	for <lists+dri-devel@lfdr.de>; Tue, 20 Aug 2019 03:18:46 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3692C6E589;
	Tue, 20 Aug 2019 01:18:18 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from perceval.ideasonboard.com (perceval.ideasonboard.com
 [IPv6:2001:4b98:dc2:55:216:3eff:fef7:d647])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7FF0B6E520
 for <dri-devel@lists.freedesktop.org>; Tue, 20 Aug 2019 01:17:53 +0000 (UTC)
Received: from pendragon.bb.dnainternet.fi
 (dfj612yhrgyx302h3jwwy-3.rev.dnainternet.fi
 [IPv6:2001:14ba:21f5:5b00:ce28:277f:58d7:3ca4])
 by perceval.ideasonboard.com (Postfix) with ESMTPSA id B9B7CD87;
 Tue, 20 Aug 2019 03:17:47 +0200 (CEST)
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v2 23/50] drm/omap: dss: Make omap_dss_device_ops optional
Date: Tue, 20 Aug 2019 04:16:54 +0300
Message-Id: <20190820011721.30136-24-laurent.pinchart@ideasonboard.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190820011721.30136-1-laurent.pinchart@ideasonboard.com>
References: <20190820011721.30136-1-laurent.pinchart@ideasonboard.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=ideasonboard.com; s=mail; t=1566263868;
 bh=WEhvOSEDTgaUY2y0WDFA+/Ili3WPMBbz6C3YS0sQqq8=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=auHjvzZN/ROzE90GymngABepuxFuCSrbMfdsdDrhGsvm8fDlQfyRCID5MmZyhVtiv
 3l8nKlO+jXCUT2CXfWdPSq+kqgUkvAk5cmEcychU0/mcJv0IlYfTzxZ2QlzV+Dfbta
 RgRjfJsLEorXvvgqGkg2Eo3Krzf7fUxnf/yhnB54=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Maxime Ripard <maxime.ripard@bootlin.com>,
 Tomi Valkeinen <tomi.valkeinen@ti.com>, Sean Paul <sean@poorly.run>,
 Sebastian Reichel <sebastian.reichel@collabora.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QXMgcGFydCBvZiB0aGUgbW92ZSB0byBkcm1fYnJpZGdlIG9wcywgdGhlIGRzc2RldiBvcHMgd2ls
bCBiZWNvbWUgZW1wdHkKZm9yIHNvbWUgb2YgdGhlIGludGVybmFsIGVuY29kZXJzLiBNYWtlIHRo
ZW0gb3B0aW9uYWwgaW4gdGhlIGRyaXZlciB0bwphbGxvdyB0aGVtIHRvIGJlIHJlbW92ZWQgY29t
cGxldGVseSwgZWFzaW5nIHRoZSB0cmFuc2l0aW9uLgoKU2lnbmVkLW9mZi1ieTogTGF1cmVudCBQ
aW5jaGFydCA8bGF1cmVudC5waW5jaGFydEBpZGVhc29uYm9hcmQuY29tPgpSZXZpZXdlZC1ieTog
VG9taSBWYWxrZWluZW4gPHRvbWkudmFsa2VpbmVuQHRpLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9k
cm0vb21hcGRybS9kc3MvYmFzZS5jICAgICAgIHwgMjEgKysrKysrKysrKysrLS0tLS0tLS0tCiBk
cml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3MvZHNzLmMgICAgICAgIHwgIDMgKystCiBkcml2ZXJz
L2dwdS9kcm0vb21hcGRybS9vbWFwX2Nvbm5lY3Rvci5jIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9vbWFwZHJtL29tYXBfZW5jb2Rlci5jICAgfCAxMiArKysrKysrLS0tLS0KIDQgZmlsZXMgY2hh
bmdlZCwgMjIgaW5zZXJ0aW9ucygrKSwgMTYgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL29tYXBkcm0vZHNzL2Jhc2UuYyBiL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJt
L2Rzcy9iYXNlLmMKaW5kZXggODBkNDg5MzZkMTc3Li4yZGIzYmQyZjE5ZGIgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL2Rzcy9iYXNlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L29tYXBkcm0vZHNzL2Jhc2UuYwpAQCAtMTk1LDEwICsxOTUsMTIgQEAgaW50IG9tYXBkc3NfZGV2
aWNlX2Nvbm5lY3Qoc3RydWN0IGRzc19kZXZpY2UgKmRzcywKIAogCWRzdC0+ZHNzID0gZHNzOwog
Ci0JcmV0ID0gZHN0LT5vcHMtPmNvbm5lY3Qoc3JjLCBkc3QpOwotCWlmIChyZXQgPCAwKSB7Ci0J
CWRzdC0+ZHNzID0gTlVMTDsKLQkJcmV0dXJuIHJldDsKKwlpZiAoZHN0LT5vcHMgJiYgZHN0LT5v
cHMtPmNvbm5lY3QpIHsKKwkJcmV0ID0gZHN0LT5vcHMtPmNvbm5lY3Qoc3JjLCBkc3QpOworCQlp
ZiAocmV0IDwgMCkgeworCQkJZHN0LT5kc3MgPSBOVUxMOworCQkJcmV0dXJuIHJldDsKKwkJfQog
CX0KIAogCXJldHVybiAwOwpAQCAtMjI2LDcgKzIyOCw4IEBAIHZvaWQgb21hcGRzc19kZXZpY2Vf
ZGlzY29ubmVjdChzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpzcmMsCiAKIAlXQVJOX09OKGRzdC0+
c3RhdGUgIT0gT01BUF9EU1NfRElTUExBWV9ESVNBQkxFRCk7CiAKLQlkc3QtPm9wcy0+ZGlzY29u
bmVjdChzcmMsIGRzdCk7CisJaWYgKGRzdC0+b3BzICYmIGRzdC0+b3BzLT5kaXNjb25uZWN0KQor
CQlkc3QtPm9wcy0+ZGlzY29ubmVjdChzcmMsIGRzdCk7CiAJZHN0LT5kc3MgPSBOVUxMOwogfQog
RVhQT1JUX1NZTUJPTF9HUEwob21hcGRzc19kZXZpY2VfZGlzY29ubmVjdCk7CkBAIC0yMzgsNyAr
MjQxLDcgQEAgdm9pZCBvbWFwZHNzX2RldmljZV9wcmVfZW5hYmxlKHN0cnVjdCBvbWFwX2Rzc19k
ZXZpY2UgKmRzc2RldikKIAogCW9tYXBkc3NfZGV2aWNlX3ByZV9lbmFibGUoZHNzZGV2LT5uZXh0
KTsKIAotCWlmIChkc3NkZXYtPm9wcy0+cHJlX2VuYWJsZSkKKwlpZiAoZHNzZGV2LT5vcHMgJiYg
ZHNzZGV2LT5vcHMtPnByZV9lbmFibGUpCiAJCWRzc2Rldi0+b3BzLT5wcmVfZW5hYmxlKGRzc2Rl
dik7CiB9CiBFWFBPUlRfU1lNQk9MX0dQTChvbWFwZHNzX2RldmljZV9wcmVfZW5hYmxlKTsKQEAg
LTI0OCw3ICsyNTEsNyBAQCB2b2lkIG9tYXBkc3NfZGV2aWNlX2VuYWJsZShzdHJ1Y3Qgb21hcF9k
c3NfZGV2aWNlICpkc3NkZXYpCiAJaWYgKCFkc3NkZXYpCiAJCXJldHVybjsKIAotCWlmIChkc3Nk
ZXYtPm9wcy0+ZW5hYmxlKQorCWlmIChkc3NkZXYtPm9wcyAmJiBkc3NkZXYtPm9wcy0+ZW5hYmxl
KQogCQlkc3NkZXYtPm9wcy0+ZW5hYmxlKGRzc2Rldik7CiAKIAlvbWFwZHNzX2RldmljZV9lbmFi
bGUoZHNzZGV2LT5uZXh0KTsKQEAgLTI2NCw3ICsyNjcsNyBAQCB2b2lkIG9tYXBkc3NfZGV2aWNl
X2Rpc2FibGUoc3RydWN0IG9tYXBfZHNzX2RldmljZSAqZHNzZGV2KQogCiAJb21hcGRzc19kZXZp
Y2VfZGlzYWJsZShkc3NkZXYtPm5leHQpOwogCi0JaWYgKGRzc2Rldi0+b3BzLT5kaXNhYmxlKQor
CWlmIChkc3NkZXYtPm9wcyAmJiBkc3NkZXYtPm9wcy0+ZGlzYWJsZSkKIAkJZHNzZGV2LT5vcHMt
PmRpc2FibGUoZHNzZGV2KTsKIH0KIEVYUE9SVF9TWU1CT0xfR1BMKG9tYXBkc3NfZGV2aWNlX2Rp
c2FibGUpOwpAQCAtMjc0LDcgKzI3Nyw3IEBAIHZvaWQgb21hcGRzc19kZXZpY2VfcG9zdF9kaXNh
YmxlKHN0cnVjdCBvbWFwX2Rzc19kZXZpY2UgKmRzc2RldikKIAlpZiAoIWRzc2RldikKIAkJcmV0
dXJuOwogCi0JaWYgKGRzc2Rldi0+b3BzLT5wb3N0X2Rpc2FibGUpCisJaWYgKGRzc2Rldi0+b3Bz
ICYmIGRzc2Rldi0+b3BzLT5wb3N0X2Rpc2FibGUpCiAJCWRzc2Rldi0+b3BzLT5wb3N0X2Rpc2Fi
bGUoZHNzZGV2KTsKIAogCW9tYXBkc3NfZGV2aWNlX3Bvc3RfZGlzYWJsZShkc3NkZXYtPm5leHQp
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vZHNzL2Rzcy5jIGIvZHJpdmVy
cy9ncHUvZHJtL29tYXBkcm0vZHNzL2Rzcy5jCmluZGV4IDU3MTFiN2E3MjBlNi4uOTAwMWUxYmQz
MDU1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3MvZHNzLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vZHNzL2Rzcy5jCkBAIC0xNTUwLDcgKzE1NTAsOCBAQCBz
dGF0aWMgdm9pZCBkc3Nfc2h1dGRvd24oc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKIAlE
U1NEQkcoInNodXRkb3duXG4iKTsKIAogCWZvcl9lYWNoX2Rzc19vdXRwdXQoZHNzZGV2KSB7Ci0J
CWlmIChkc3NkZXYtPnN0YXRlID09IE9NQVBfRFNTX0RJU1BMQVlfQUNUSVZFKQorCQlpZiAoZHNz
ZGV2LT5zdGF0ZSA9PSBPTUFQX0RTU19ESVNQTEFZX0FDVElWRSAmJgorCQkgICAgZHNzZGV2LT5v
cHMgJiYgZHNzZGV2LT5vcHMtPmRpc2FibGUpCiAJCQlkc3NkZXYtPm9wcy0+ZGlzYWJsZShkc3Nk
ZXYpOwogCX0KIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL29tYXBfY29u
bmVjdG9yLmMgYi9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9vbWFwX2Nvbm5lY3Rvci5jCmluZGV4
IGIwY2IyZWNiMzBhYi4uYTI0Y2VjNGIwYmI5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
b21hcGRybS9vbWFwX2Nvbm5lY3Rvci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL29t
YXBfY29ubmVjdG9yLmMKQEAgLTIyOCw3ICsyMjgsNyBAQCBlbnVtIGRybV9tb2RlX3N0YXR1cyBv
bWFwX2Nvbm5lY3Rvcl9tb2RlX2ZpeHVwKHN0cnVjdCBvbWFwX2Rzc19kZXZpY2UgKmRzc2RldiwK
IAlkcm1fbW9kZV9jb3B5KGFkanVzdGVkX21vZGUsIG1vZGUpOwogCiAJZm9yICg7IGRzc2Rldjsg
ZHNzZGV2ID0gZHNzZGV2LT5uZXh0KSB7Ci0JCWlmICghZHNzZGV2LT5vcHMtPmNoZWNrX3RpbWlu
Z3MpCisJCWlmICghZHNzZGV2LT5vcHMgfHwgIWRzc2Rldi0+b3BzLT5jaGVja190aW1pbmdzKQog
CQkJY29udGludWU7CiAKIAkJcmV0ID0gZHNzZGV2LT5vcHMtPmNoZWNrX3RpbWluZ3MoZHNzZGV2
LCBhZGp1c3RlZF9tb2RlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL29t
YXBfZW5jb2Rlci5jIGIvZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vb21hcF9lbmNvZGVyLmMKaW5k
ZXggN2YzZjU4NDRjNjJhLi5iZDg3YzI4ZjkwNDYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9vbWFwZHJtL29tYXBfZW5jb2Rlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL29t
YXBfZW5jb2Rlci5jCkBAIC03NiwxMCArNzYsMTAgQEAgc3RhdGljIHZvaWQgb21hcF9lbmNvZGVy
X2hkbWlfbW9kZV9zZXQoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKIAlzdHJ1Y3Qg
b21hcF9kc3NfZGV2aWNlICpkc3NkZXYgPSBvbWFwX2VuY29kZXItPm91dHB1dDsKIAlib29sIGhk
bWlfbW9kZSA9IGNvbm5lY3Rvci0+ZGlzcGxheV9pbmZvLmlzX2hkbWk7CiAKLQlpZiAoZHNzZGV2
LT5vcHMtPmhkbWkuc2V0X2hkbWlfbW9kZSkKKwlpZiAoZHNzZGV2LT5vcHMgJiYgZHNzZGV2LT5v
cHMtPmhkbWkuc2V0X2hkbWlfbW9kZSkKIAkJZHNzZGV2LT5vcHMtPmhkbWkuc2V0X2hkbWlfbW9k
ZShkc3NkZXYsIGhkbWlfbW9kZSk7CiAKLQlpZiAoaGRtaV9tb2RlICYmIGRzc2Rldi0+b3BzLT5o
ZG1pLnNldF9pbmZvZnJhbWUpIHsKKwlpZiAoaGRtaV9tb2RlICYmIGRzc2Rldi0+b3BzICYmIGRz
c2Rldi0+b3BzLT5oZG1pLnNldF9pbmZvZnJhbWUpIHsKIAkJc3RydWN0IGhkbWlfYXZpX2luZm9m
cmFtZSBhdmk7CiAJCWludCByOwogCkBAIC0xMzcsNyArMTM3LDcgQEAgc3RhdGljIHZvaWQgb21h
cF9lbmNvZGVyX21vZGVfc2V0KHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlciwKIAlkc3NfbWdy
X3NldF90aW1pbmdzKG91dHB1dCwgJnZtKTsKIAogCWZvciAoZHNzZGV2ID0gb3V0cHV0OyBkc3Nk
ZXY7IGRzc2RldiA9IGRzc2Rldi0+bmV4dCkgewotCQlpZiAoZHNzZGV2LT5vcHMtPnNldF90aW1p
bmdzKQorCQlpZiAoZHNzZGV2LT5vcHMgJiYgZHNzZGV2LT5vcHMtPnNldF90aW1pbmdzKQogCQkJ
ZHNzZGV2LT5vcHMtPnNldF90aW1pbmdzKGRzc2RldiwgYWRqdXN0ZWRfbW9kZSk7CiAJfQogCkBA
IC0xNjYsNyArMTY2LDggQEAgc3RhdGljIHZvaWQgb21hcF9lbmNvZGVyX2Rpc2FibGUoc3RydWN0
IGRybV9lbmNvZGVyICplbmNvZGVyKQogCSAqIGZsb3cgd2hlcmUgdGhlIHBpcGVsaW5lIG91dHB1
dCBjb250cm9scyB0aGUgZW5jb2Rlci4KIAkgKi8KIAlpZiAoZHNzZGV2LT50eXBlICE9IE9NQVBf
RElTUExBWV9UWVBFX0RTSSkgewotCQlkc3NkZXYtPm9wcy0+ZGlzYWJsZShkc3NkZXYpOworCQlp
ZiAoZHNzZGV2LT5vcHMgJiYgZHNzZGV2LT5vcHMtPmRpc2FibGUpCisJCQlkc3NkZXYtPm9wcy0+
ZGlzYWJsZShkc3NkZXYpOwogCQlkc3NkZXYtPnN0YXRlID0gT01BUF9EU1NfRElTUExBWV9ESVNB
QkxFRDsKIAl9CiAKQEAgLTE5NCw3ICsxOTUsOCBAQCBzdGF0aWMgdm9pZCBvbWFwX2VuY29kZXJf
ZW5hYmxlKHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcikKIAkgKiBmbG93IHdoZXJlIHRoZSBw
aXBlbGluZSBvdXRwdXQgY29udHJvbHMgdGhlIGVuY29kZXIuCiAJICovCiAJaWYgKGRzc2Rldi0+
dHlwZSAhPSBPTUFQX0RJU1BMQVlfVFlQRV9EU0kpIHsKLQkJZHNzZGV2LT5vcHMtPmVuYWJsZShk
c3NkZXYpOworCQlpZiAoZHNzZGV2LT5vcHMgJiYgZHNzZGV2LT5vcHMtPmVuYWJsZSkKKwkJCWRz
c2Rldi0+b3BzLT5lbmFibGUoZHNzZGV2KTsKIAkJZHNzZGV2LT5zdGF0ZSA9IE9NQVBfRFNTX0RJ
U1BMQVlfQUNUSVZFOwogCX0KIAotLSAKUmVnYXJkcywKCkxhdXJlbnQgUGluY2hhcnQKCl9fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWls
aW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZy
ZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
