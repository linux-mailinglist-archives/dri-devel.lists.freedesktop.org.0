Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 0990024D9C
	for <lists+dri-devel@lfdr.de>; Tue, 21 May 2019 13:08:47 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3E447892FE;
	Tue, 21 May 2019 11:08:39 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9C1DD892FA
 for <dri-devel@lists.freedesktop.org>; Tue, 21 May 2019 11:08:37 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 3A3E2AF3E;
 Tue, 21 May 2019 11:08:36 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: daniel@ffwll.ch, airlied@linux.ie, kraxel@redhat.com,
 christian.koenig@amd.com, ray.huang@amd.com, sam@ravnborg.org
Subject: [PATCH 2/3] drm: Rename reserve/unreserve to lock/unlock in GEM VRAM
 helpers
Date: Tue, 21 May 2019 13:08:30 +0200
Message-Id: <20190521110831.20200-3-tzimmermann@suse.de>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190521110831.20200-1-tzimmermann@suse.de>
References: <20190521110831.20200-1-tzimmermann@suse.de>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Zimmermann <tzimmermann@suse.de>, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VG8gYWxpZ24gd2l0aCB0aGUgcmVzdCBvZiBEUk0gdGVybWlub2xvZ3ksIHRoZSBHRU0gVlJBTSBo
ZWxwZXJzIG5vdyB1c2UKbG9jayBhbmQgdW5sb2NrIGluIHBsYWNlcyB3aGVyZSByZXNlcnZlIGFu
ZCB1bnJlc2VydmUgd2hlcmUgdXNlZCBiZWZvcmUuCkFsbCBjYWxsZXJzIGhhdmUgYmVlbiBhZGFw
dGVkLgoKU2lnbmVkLW9mZi1ieTogVGhvbWFzIFppbW1lcm1hbm4gPHR6aW1tZXJtYW5uQHN1c2Uu
ZGU+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2FzdC9hc3RfZmIuYyAgICAgICAgICAgICB8IDExICsr
Ky0tLS0KIGRyaXZlcnMvZ3B1L2RybS9hc3QvYXN0X21vZGUuYyAgICAgICAgICAgfCAxMiArKyst
LS0tCiBkcml2ZXJzL2dwdS9kcm0vZHJtX2dlbV92cmFtX2hlbHBlci5jICAgIHwgMzIgKysrKysr
KysrLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL21nYWcyMDAvbWdhZzIwMF9jdXJzb3IuYyB8
IDQwICsrKysrKysrKysrKy0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL21nYWcyMDAvbWdh
ZzIwMF9mYi5jICAgICB8IDExICsrKy0tLS0KIGluY2x1ZGUvZHJtL2RybV9nZW1fdnJhbV9oZWxw
ZXIuaCAgICAgICAgfCAgOCArKy0tLQogNiBmaWxlcyBjaGFuZ2VkLCA1NiBpbnNlcnRpb25zKCsp
LCA1OCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYXN0L2FzdF9m
Yi5jIGIvZHJpdmVycy9ncHUvZHJtL2FzdC9hc3RfZmIuYwppbmRleCA1MDVlNjAyODU1YzAuLjA1
ZjQ1MjIyYjcwMiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FzdC9hc3RfZmIuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vYXN0L2FzdF9mYi5jCkBAIC02MiwxMyArNjIsMTIgQEAgc3RhdGlj
IHZvaWQgYXN0X2RpcnR5X3VwZGF0ZShzdHJ1Y3QgYXN0X2ZiZGV2ICphZmJkZXYsCiAJb2JqID0g
YWZiZGV2LT5hZmIub2JqOwogCWdibyA9IGRybV9nZW1fdnJhbV9vZl9nZW0ob2JqKTsKIAotCS8q
Ci0JICogdHJ5IGFuZCByZXNlcnZlIHRoZSBCTywgaWYgd2UgZmFpbCB3aXRoIGJ1c3kKLQkgKiB0
aGVuIHRoZSBCTyBpcyBiZWluZyBtb3ZlZCBhbmQgd2Ugc2hvdWxkCi0JICogc3RvcmUgdXAgdGhl
IGRhbWFnZSB1bnRpbCBsYXRlci4KKwkvKiBUcnkgdG8gbG9jayB0aGUgQk8uIElmIHdlIGZhaWwg
d2l0aCAtRUJVU1kgdGhlbgorCSAqIHRoZSBCTyBpcyBiZWluZyBtb3ZlZCBhbmQgd2Ugc2hvdWxk
IHN0b3JlIHVwIHRoZQorCSAqIGRhbWFnZSB1bnRpbCBsYXRlci4KIAkgKi8KIAlpZiAoZHJtX2Nh
bl9zbGVlcCgpKQotCQlyZXQgPSBkcm1fZ2VtX3ZyYW1fcmVzZXJ2ZShnYm8sIHRydWUpOworCQly
ZXQgPSBkcm1fZ2VtX3ZyYW1fbG9jayhnYm8sIHRydWUpOwogCWlmIChyZXQpIHsKIAkJaWYgKHJl
dCAhPSAtRUJVU1kpCiAJCQlyZXR1cm47CkBAIC0xMjcsNyArMTI2LDcgQEAgc3RhdGljIHZvaWQg
YXN0X2RpcnR5X3VwZGF0ZShzdHJ1Y3QgYXN0X2ZiZGV2ICphZmJkZXYsCiAJCWRybV9nZW1fdnJh
bV9rdW5tYXAoZ2JvKTsKIAogb3V0OgotCWRybV9nZW1fdnJhbV91bnJlc2VydmUoZ2JvKTsKKwlk
cm1fZ2VtX3ZyYW1fdW5sb2NrKGdibyk7CiB9CiAKIHN0YXRpYyB2b2lkIGFzdF9maWxscmVjdChz
dHJ1Y3QgZmJfaW5mbyAqaW5mbywKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hc3QvYXN0
X21vZGUuYyBiL2RyaXZlcnMvZ3B1L2RybS9hc3QvYXN0X21vZGUuYwppbmRleCBmYmFmZTM5OTQ2
NTQuLmZiNzAwZDYyMGI2NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FzdC9hc3RfbW9k
ZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hc3QvYXN0X21vZGUuYwpAQCAtMTIwMSw3ICsxMjAx
LDcgQEAgc3RhdGljIGludCBhc3RfY3Vyc29yX3NldChzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCiAJ
fQogCWdibyA9IGRybV9nZW1fdnJhbV9vZl9nZW0ob2JqKTsKIAotCXJldCA9IGRybV9nZW1fdnJh
bV9yZXNlcnZlKGdibywgZmFsc2UpOworCXJldCA9IGRybV9nZW1fdnJhbV9sb2NrKGdibywgZmFs
c2UpOwogCWlmIChyZXQpCiAJCWdvdG8gZmFpbDsKIApAQCAtMTIwOSw3ICsxMjA5LDcgQEAgc3Rh
dGljIGludCBhc3RfY3Vyc29yX3NldChzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCiAJc3JjID0gZHJt
X2dlbV92cmFtX2ttYXBfYXQoZ2JvLCB0cnVlLCAmc3JjX2lzaW9tZW0sICZ1b2JqX21hcCk7CiAJ
aWYgKElTX0VSUihzcmMpKSB7CiAJCXJldCA9IFBUUl9FUlIoc3JjKTsKLQkJZ290byBmYWlsX3Vu
cmVzZXJ2ZTsKKwkJZ290byBmYWlsX3VubG9jazsKIAl9CiAJaWYgKHNyY19pc2lvbWVtID09IHRy
dWUpCiAJCURSTV9FUlJPUigic3JjIGN1cnNvciBibyBzaG91bGQgYmUgaW4gbWFpbiBtZW1vcnlc
biIpOwpAQCAtMTIxOCw3ICsxMjE4LDcgQEAgc3RhdGljIGludCBhc3RfY3Vyc29yX3NldChzdHJ1
Y3QgZHJtX2NydGMgKmNydGMsCiAJCQkJICAgZmFsc2UsICZkc3RfaXNpb21lbSwgJmFzdC0+Y2Fj
aGVfa21hcCk7CiAJaWYgKElTX0VSUihkc3QpKSB7CiAJCXJldCA9IFBUUl9FUlIoZHN0KTsKLQkJ
Z290byBmYWlsX3VucmVzZXJ2ZTsKKwkJZ290byBmYWlsX3VubG9jazsKIAl9CiAJaWYgKGRzdF9p
c2lvbWVtID09IGZhbHNlKQogCQlEUk1fRVJST1IoImRzdCBibyBzaG91bGQgYmUgaW4gVlJBTVxu
Iik7CkBAIC0xMjI5LDcgKzEyMjksNyBAQCBzdGF0aWMgaW50IGFzdF9jdXJzb3Jfc2V0KHN0cnVj
dCBkcm1fY3J0YyAqY3J0YywKIAljc3VtID0gY29weV9jdXJzb3JfaW1hZ2Uoc3JjLCBkc3QsIHdp
ZHRoLCBoZWlnaHQpOwogCiAJZHJtX2dlbV92cmFtX2t1bm1hcF9hdChnYm8sICZ1b2JqX21hcCk7
Ci0JZHJtX2dlbV92cmFtX3VucmVzZXJ2ZShnYm8pOworCWRybV9nZW1fdnJhbV91bmxvY2soZ2Jv
KTsKIAogCS8qIHdyaXRlIGNoZWNrc3VtICsgc2lnbmF0dXJlICovCiAJewpAQCAtMTI2Miw4ICsx
MjYyLDggQEAgc3RhdGljIGludCBhc3RfY3Vyc29yX3NldChzdHJ1Y3QgZHJtX2NydGMgKmNydGMs
CiAJZHJtX2dlbV9vYmplY3RfcHV0X3VubG9ja2VkKG9iaik7CiAJcmV0dXJuIDA7CiAKLWZhaWxf
dW5yZXNlcnZlOgotCWRybV9nZW1fdnJhbV91bnJlc2VydmUoZ2JvKTsKK2ZhaWxfdW5sb2NrOgor
CWRybV9nZW1fdnJhbV91bmxvY2soZ2JvKTsKIGZhaWw6CiAJZHJtX2dlbV9vYmplY3RfcHV0X3Vu
bG9ja2VkKG9iaik7CiAJcmV0dXJuIHJldDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9k
cm1fZ2VtX3ZyYW1faGVscGVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX2dlbV92cmFtX2hlbHBl
ci5jCmluZGV4IGIzNDFiNzA4MzJiZS4uYWVmYjBjMzYxNDg2IDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vZHJtX2dlbV92cmFtX2hlbHBlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1f
Z2VtX3ZyYW1faGVscGVyLmMKQEAgLTE1Miw3ICsxNTIsNyBAQCB2b2lkIGRybV9nZW1fdnJhbV9w
dXQoc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKmdibykKIEVYUE9SVF9TWU1CT0woZHJtX2dl
bV92cmFtX3B1dCk7CiAKIC8qKgotICogZHJtX2dlbV92cmFtX3Jlc2VydmUoKSAtIFJlc2VydmVz
IGEgVlJBTS1iYWNrZWQgR0VNIG9iamVjdAorICogZHJtX2dlbV92cmFtX2xvY2soKSAtIExvY2tz
IGEgVlJBTS1iYWNrZWQgR0VNIG9iamVjdAogICogQGdibzoJdGhlIEdFTSBWUkFNIG9iamVjdAog
ICogQG5vX3dhaXQ6CWRvbid0IHdhaXQgZm9yIGJ1ZmZlciBvYmplY3QgdG8gYmVjb21lIGF2YWls
YWJsZQogICoKQEAgLTE2MiwyNCArMTYyLDI0IEBAIEVYUE9SVF9TWU1CT0woZHJtX2dlbV92cmFt
X3B1dCk7CiAgKiAwIG9uIHN1Y2Nlc3MsIG9yCiAgKiBhIG5lZ2F0aXZlIGVycm9yIGNvZGUgb3Ro
ZXJ3aXNlCiAgKi8KLWludCBkcm1fZ2VtX3ZyYW1fcmVzZXJ2ZShzdHJ1Y3QgZHJtX2dlbV92cmFt
X29iamVjdCAqZ2JvLCBib29sIG5vX3dhaXQpCitpbnQgZHJtX2dlbV92cmFtX2xvY2soc3RydWN0
IGRybV9nZW1fdnJhbV9vYmplY3QgKmdibywgYm9vbCBub193YWl0KQogewogCXJldHVybiB0dG1f
Ym9fcmVzZXJ2ZSgmZ2JvLT5ibywgdHJ1ZSwgbm9fd2FpdCwgTlVMTCk7CiB9Ci1FWFBPUlRfU1lN
Qk9MKGRybV9nZW1fdnJhbV9yZXNlcnZlKTsKK0VYUE9SVF9TWU1CT0woZHJtX2dlbV92cmFtX2xv
Y2spOwogCiAvKioKLSAqIGRybV9nZW1fdnJhbV91bnJlc2VydmUoKSAtIFwKLQlSZWxlYXNlIGEg
cmVzZXJ2YXRpb24gYWNxdWlyZWQgYnkgZHJtX2dlbV92cmFtX3Jlc2VydmUoKQorICogZHJtX2dl
bV92cmFtX3VubG9jaygpIC0gXAorCVJlbGVhc2UgYSByZXNlcnZhdGlvbiBhY3F1aXJlZCBieSBk
cm1fZ2VtX3ZyYW1fbG9jaygpCiAgKiBAZ2JvOgl0aGUgR0VNIFZSQU0gb2JqZWN0CiAgKgogICog
U2VlIHR0bV9ib191bnJlc2VydmUoKSBmb3IgbW9yZSBpbmZvcm1hdGlvbi4KICAqLwotdm9pZCBk
cm1fZ2VtX3ZyYW1fdW5yZXNlcnZlKHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8pCit2
b2lkIGRybV9nZW1fdnJhbV91bmxvY2soc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKmdibykK
IHsKIAl0dG1fYm9fdW5yZXNlcnZlKCZnYm8tPmJvKTsKIH0KLUVYUE9SVF9TWU1CT0woZHJtX2dl
bV92cmFtX3VucmVzZXJ2ZSk7CitFWFBPUlRfU1lNQk9MKGRybV9nZW1fdnJhbV91bmxvY2spOwog
CiAvKioKICAqIGRybV9nZW1fdnJhbV9tbWFwX29mZnNldCgpIC0gUmV0dXJucyBhIEdFTSBWUkFN
IG9iamVjdCdzIG1tYXAgb2Zmc2V0CkBAIC0yNjMsNyArMjYzLDcgQEAgaW50IGRybV9nZW1fdnJh
bV9waW4oc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKmdibywgdW5zaWduZWQgbG9uZyBwbF9m
bGFnKQogRVhQT1JUX1NZTUJPTChkcm1fZ2VtX3ZyYW1fcGluKTsKIAogLyoqCi0gKiBkcm1fZ2Vt
X3ZyYW1fcGluX3Jlc2VydmVkKCkgLSBQaW5zIGEgR0VNIFZSQU0gb2JqZWN0IGluIGEgcmVnaW9u
LgorICogZHJtX2dlbV92cmFtX3Bpbl9sb2NrZWQoKSAtIFBpbnMgYSBHRU0gVlJBTSBvYmplY3Qg
aW4gYSByZWdpb24uCiAgKiBAZ2JvOgl0aGUgR0VNIFZSQU0gb2JqZWN0CiAgKiBAcGxfZmxhZzoJ
YSBiaXRtYXNrIG9mIHBvc3NpYmxlIG1lbW9yeSByZWdpb25zCiAgKgpAQCAtMjcyLDE0ICsyNzIs
MTQgQEAgRVhQT1JUX1NZTUJPTChkcm1fZ2VtX3ZyYW1fcGluKTsKICAqIGl0IGNhbiBiZSBwaW5u
ZWQgdG8gYW5vdGhlciByZWdpb24uCiAgKgogICogVGhpcyBmdW5jdGlvbiBwaW5zIGEgR0VNIFZS
QU0gb2JqZWN0IHRoYXQgaGFzIGFscmVhZHkgYmVlbgotICogcmVzZXJ2ZWQuIFVzZSBkcm1fZ2Vt
X3ZyYW1fcGluKCkgaWYgcG9zc2libGUuCisgKiBsb2NrZWQuIFVzZSBkcm1fZ2VtX3ZyYW1fcGlu
KCkgaWYgcG9zc2libGUuCiAgKgogICogUmV0dXJuczoKICAqIDAgb24gc3VjY2Vzcywgb3IKICAq
IGEgbmVnYXRpdmUgZXJyb3IgY29kZSBvdGhlcndpc2UuCiAgKi8KLWludCBkcm1fZ2VtX3ZyYW1f
cGluX3Jlc2VydmVkKHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8sCi0JCQkgICAgICB1
bnNpZ25lZCBsb25nIHBsX2ZsYWcpCitpbnQgZHJtX2dlbV92cmFtX3Bpbl9sb2NrZWQoc3RydWN0
IGRybV9nZW1fdnJhbV9vYmplY3QgKmdibywKKwkJCSAgICB1bnNpZ25lZCBsb25nIHBsX2ZsYWcp
CiB7CiAJaW50IGksIHJldDsKIAlzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHggY3R4ID0geyBmYWxz
ZSwgZmFsc2UgfTsKQEAgLTMwMSw3ICszMDEsNyBAQCBpbnQgZHJtX2dlbV92cmFtX3Bpbl9yZXNl
cnZlZChzdHJ1Y3QgZHJtX2dlbV92cmFtX29iamVjdCAqZ2JvLAogCiAJcmV0dXJuIDA7CiB9Ci1F
WFBPUlRfU1lNQk9MKGRybV9nZW1fdnJhbV9waW5fcmVzZXJ2ZWQpOworRVhQT1JUX1NZTUJPTChk
cm1fZ2VtX3ZyYW1fcGluX2xvY2tlZCk7CiAKIC8qKgogICogZHJtX2dlbV92cmFtX3VucGluKCkg
LSBVbnBpbnMgYSBHRU0gVlJBTSBvYmplY3QKQEAgLTM0NiwxNyArMzQ2LDE3IEBAIGludCBkcm1f
Z2VtX3ZyYW1fdW5waW4oc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKmdibykKIEVYUE9SVF9T
WU1CT0woZHJtX2dlbV92cmFtX3VucGluKTsKIAogLyoqCi0gKiBkcm1fZ2VtX3ZyYW1fdW5waW5f
cmVzZXJ2ZWQoKSAtIFVucGlucyBhIEdFTSBWUkFNIG9iamVjdAorICogZHJtX2dlbV92cmFtX3Vu
cGluX2xvY2tlZCgpIC0gVW5waW5zIGEgR0VNIFZSQU0gb2JqZWN0CiAgKiBAZ2JvOgl0aGUgR0VN
IFZSQU0gb2JqZWN0CiAgKgogICogVGhpcyBmdW5jdGlvbiB1bnBpbnMgYSBHRU0gVlJBTSBvYmpl
Y3QgdGhhdCBoYXMgYWxyZWFkeSBiZWVuCi0gKiByZXNlcnZlZC4gVXNlIGRybV9nZW1fdnJhbV91
bnBpbigpIGlmIHBvc3NpYmxlLgorICogbG9ja2VkLiBVc2UgZHJtX2dlbV92cmFtX3VucGluKCkg
aWYgcG9zc2libGUuCiAgKgogICogUmV0dXJuczoKICAqIDAgb24gc3VjY2Vzcywgb3IKICAqIGEg
bmVnYXRpdmUgZXJyb3IgY29kZSBvdGhlcndpc2UuCiAgKi8KLWludCBkcm1fZ2VtX3ZyYW1fdW5w
aW5fcmVzZXJ2ZWQoc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKmdibykKK2ludCBkcm1fZ2Vt
X3ZyYW1fdW5waW5fbG9ja2VkKHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8pCiB7CiAJ
aW50IGksIHJldDsKIAlzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHggY3R4ID0geyBmYWxzZSwgZmFs
c2UgfTsKQEAgLTM3Nyw3ICszNzcsNyBAQCBpbnQgZHJtX2dlbV92cmFtX3VucGluX3Jlc2VydmVk
KHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8pCiAKIAlyZXR1cm4gMDsKIH0KLUVYUE9S
VF9TWU1CT0woZHJtX2dlbV92cmFtX3VucGluX3Jlc2VydmVkKTsKK0VYUE9SVF9TWU1CT0woZHJt
X2dlbV92cmFtX3VucGluX2xvY2tlZCk7CiAKIC8qKgogICogZHJtX2dlbV92cmFtX2ttYXBfYXQo
KSAtIE1hcHMgYSBHRU0gVlJBTSBvYmplY3QgaW50byBrZXJuZWwgYWRkcmVzcyBzcGFjZQpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21nYWcyMDAvbWdhZzIwMF9jdXJzb3IuYyBiL2RyaXZl
cnMvZ3B1L2RybS9tZ2FnMjAwL21nYWcyMDBfY3Vyc29yLmMKaW5kZXggMWM0ZmM4NTMxNWEwLi4w
NmE4YzA3NmNiMzMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9tZ2FnMjAwL21nYWcyMDBf
Y3Vyc29yLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL21nYWcyMDAvbWdhZzIwMF9jdXJzb3IuYwpA
QCAtMjMsOSArMjMsOSBAQCBzdGF0aWMgdm9pZCBtZ2FfaGlkZV9jdXJzb3Ioc3RydWN0IG1nYV9k
ZXZpY2UgKm1kZXYpCiAJV1JFRzgoTUdBX0NVUlBPU1hMLCAwKTsKIAlXUkVHOChNR0FfQ1VSUE9T
WEgsIDApOwogCWlmIChtZGV2LT5jdXJzb3IucGl4ZWxzXzEtPnBpbl9jb3VudCkKLQkJZHJtX2dl
bV92cmFtX3VucGluX3Jlc2VydmVkKG1kZXYtPmN1cnNvci5waXhlbHNfMSk7CisJCWRybV9nZW1f
dnJhbV91bnBpbl9sb2NrZWQobWRldi0+Y3Vyc29yLnBpeGVsc18xKTsKIAlpZiAobWRldi0+Y3Vy
c29yLnBpeGVsc18yLT5waW5fY291bnQpCi0JCWRybV9nZW1fdnJhbV91bnBpbl9yZXNlcnZlZCht
ZGV2LT5jdXJzb3IucGl4ZWxzXzIpOworCQlkcm1fZ2VtX3ZyYW1fdW5waW5fbG9ja2VkKG1kZXYt
PmN1cnNvci5waXhlbHNfMik7CiB9CiAKIGludCBtZ2FfY3J0Y19jdXJzb3Jfc2V0KHN0cnVjdCBk
cm1fY3J0YyAqY3J0YywKQEAgLTgwLDUzICs4MCw1MyBAQCBpbnQgbWdhX2NydGNfY3Vyc29yX3Nl
dChzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCiAJaWYgKCFvYmopCiAJCXJldHVybiAtRU5PRU5UOwog
Ci0JcmV0ID0gZHJtX2dlbV92cmFtX3Jlc2VydmUocGl4ZWxzXzEsIHRydWUpOworCXJldCA9IGRy
bV9nZW1fdnJhbV9sb2NrKHBpeGVsc18xLCB0cnVlKTsKIAlpZiAocmV0KSB7CiAJCVdSRUc4KE1H
QV9DVVJQT1NYTCwgMCk7CiAJCVdSRUc4KE1HQV9DVVJQT1NYSCwgMCk7CiAJCWdvdG8gb3V0X3Vu
cmVmOwogCX0KLQlyZXQgPSBkcm1fZ2VtX3ZyYW1fcmVzZXJ2ZShwaXhlbHNfMiwgdHJ1ZSk7CisJ
cmV0ID0gZHJtX2dlbV92cmFtX2xvY2socGl4ZWxzXzIsIHRydWUpOwogCWlmIChyZXQpIHsKIAkJ
V1JFRzgoTUdBX0NVUlBPU1hMLCAwKTsKIAkJV1JFRzgoTUdBX0NVUlBPU1hILCAwKTsKLQkJZHJt
X2dlbV92cmFtX3VucmVzZXJ2ZShwaXhlbHNfMSk7Ci0JCWdvdG8gb3V0X3VucmVzZXJ2ZTE7CisJ
CWRybV9nZW1fdnJhbV91bmxvY2socGl4ZWxzXzEpOworCQlnb3RvIG91dF91bmxvY2sxOwogCX0K
IAogCS8qIE1vdmUgY3Vyc29yIGJ1ZmZlcnMgaW50byBWUkFNIGlmIHRoZXkgYXJlbid0IGFscmVh
ZHkgKi8KIAlpZiAoIXBpeGVsc18xLT5waW5fY291bnQpIHsKLQkJcmV0ID0gZHJtX2dlbV92cmFt
X3Bpbl9yZXNlcnZlZChwaXhlbHNfMSwKLQkJCQkJCURSTV9HRU1fVlJBTV9QTF9GTEFHX1ZSQU0p
OworCQlyZXQgPSBkcm1fZ2VtX3ZyYW1fcGluX2xvY2tlZChwaXhlbHNfMSwKKwkJCQkJICAgICAg
RFJNX0dFTV9WUkFNX1BMX0ZMQUdfVlJBTSk7CiAJCWlmIChyZXQpCiAJCQlnb3RvIG91dDE7CiAJ
CWdwdV9hZGRyID0gZHJtX2dlbV92cmFtX29mZnNldChwaXhlbHNfMSk7CiAJCWlmIChncHVfYWRk
ciA8IDApIHsKLQkJCWRybV9nZW1fdnJhbV91bnBpbl9yZXNlcnZlZChwaXhlbHNfMSk7CisJCQlk
cm1fZ2VtX3ZyYW1fdW5waW5fbG9ja2VkKHBpeGVsc18xKTsKIAkJCWdvdG8gb3V0MTsKIAkJfQog
CQltZGV2LT5jdXJzb3IucGl4ZWxzXzFfZ3B1X2FkZHIgPSBncHVfYWRkcjsKIAl9CiAJaWYgKCFw
aXhlbHNfMi0+cGluX2NvdW50KSB7Ci0JCXJldCA9IGRybV9nZW1fdnJhbV9waW5fcmVzZXJ2ZWQo
cGl4ZWxzXzIsCi0JCQkJCQlEUk1fR0VNX1ZSQU1fUExfRkxBR19WUkFNKTsKKwkJcmV0ID0gZHJt
X2dlbV92cmFtX3Bpbl9sb2NrZWQocGl4ZWxzXzIsCisJCQkJCSAgICAgIERSTV9HRU1fVlJBTV9Q
TF9GTEFHX1ZSQU0pOwogCQlpZiAocmV0KSB7Ci0JCQlkcm1fZ2VtX3ZyYW1fdW5waW5fcmVzZXJ2
ZWQocGl4ZWxzXzEpOworCQkJZHJtX2dlbV92cmFtX3VucGluX2xvY2tlZChwaXhlbHNfMSk7CiAJ
CQlnb3RvIG91dDE7CiAJCX0KIAkJZ3B1X2FkZHIgPSBkcm1fZ2VtX3ZyYW1fb2Zmc2V0KHBpeGVs
c18yKTsKIAkJaWYgKGdwdV9hZGRyIDwgMCkgewotCQkJZHJtX2dlbV92cmFtX3VucGluX3Jlc2Vy
dmVkKHBpeGVsc18xKTsKLQkJCWRybV9nZW1fdnJhbV91bnBpbl9yZXNlcnZlZChwaXhlbHNfMik7
CisJCQlkcm1fZ2VtX3ZyYW1fdW5waW5fbG9ja2VkKHBpeGVsc18xKTsKKwkJCWRybV9nZW1fdnJh
bV91bnBpbl9sb2NrZWQocGl4ZWxzXzIpOwogCQkJZ290byBvdXQxOwogCQl9CiAJCW1kZXYtPmN1
cnNvci5waXhlbHNfMl9ncHVfYWRkciA9IGdwdV9hZGRyOwogCX0KIAogCWdibyA9IGRybV9nZW1f
dnJhbV9vZl9nZW0ob2JqKTsKLQlyZXQgPSBkcm1fZ2VtX3ZyYW1fcmVzZXJ2ZShnYm8sIHRydWUp
OworCXJldCA9IGRybV9nZW1fdnJhbV9sb2NrKGdibywgdHJ1ZSk7CiAJaWYgKHJldCkgewotCQlk
ZXZfZXJyKCZkZXYtPnBkZXYtPmRldiwgImZhaWxlZCB0byByZXNlcnZlIHVzZXIgYm9cbiIpOwor
CQlkZXZfZXJyKCZkZXYtPnBkZXYtPmRldiwgImZhaWxlZCB0byBsb2NrIHVzZXIgYm9cbiIpOwog
CQlnb3RvIG91dDE7CiAJfQogCXNyYyA9IGRybV9nZW1fdnJhbV9rbWFwKGdibywgdHJ1ZSwgTlVM
TCk7CkBAIC0yNTAsMTMgKzI1MCwxMyBAQCBpbnQgbWdhX2NydGNfY3Vyc29yX3NldChzdHJ1Y3Qg
ZHJtX2NydGMgKmNydGMsCiAgb3V0MzoKIAlkcm1fZ2VtX3ZyYW1fa3VubWFwKGdibyk7CiAgb3V0
MjoKLQlkcm1fZ2VtX3ZyYW1fdW5yZXNlcnZlKGdibyk7CisJZHJtX2dlbV92cmFtX3VubG9jayhn
Ym8pOwogIG91dDE6CiAJaWYgKHJldCkKIAkJbWdhX2hpZGVfY3Vyc29yKG1kZXYpOwotCWRybV9n
ZW1fdnJhbV91bnJlc2VydmUocGl4ZWxzXzEpOwotb3V0X3VucmVzZXJ2ZTE6Ci0JZHJtX2dlbV92
cmFtX3VucmVzZXJ2ZShwaXhlbHNfMik7CisJZHJtX2dlbV92cmFtX3VubG9jayhwaXhlbHNfMSk7
CitvdXRfdW5sb2NrMToKKwlkcm1fZ2VtX3ZyYW1fdW5sb2NrKHBpeGVsc18yKTsKIG91dF91bnJl
ZjoKIAlkcm1fZ2VtX29iamVjdF9wdXRfdW5sb2NrZWQob2JqKTsKIApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL21nYWcyMDAvbWdhZzIwMF9mYi5jIGIvZHJpdmVycy9ncHUvZHJtL21nYWcy
MDAvbWdhZzIwMF9mYi5jCmluZGV4IDg3MjE3YmRjZTlmOC4uOTdjNTc1YTlhODZmIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vbWdhZzIwMC9tZ2FnMjAwX2ZiLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL21nYWcyMDAvbWdhZzIwMF9mYi5jCkBAIC0zNiwxMyArMzYsMTIgQEAgc3RhdGljIHZv
aWQgbWdhX2RpcnR5X3VwZGF0ZShzdHJ1Y3QgbWdhX2ZiZGV2ICptZmJkZXYsCiAJb2JqID0gbWZi
ZGV2LT5tZmIub2JqOwogCWdibyA9IGRybV9nZW1fdnJhbV9vZl9nZW0ob2JqKTsKIAotCS8qCi0J
ICogdHJ5IGFuZCByZXNlcnZlIHRoZSBCTywgaWYgd2UgZmFpbCB3aXRoIGJ1c3kKLQkgKiB0aGVu
IHRoZSBCTyBpcyBiZWluZyBtb3ZlZCBhbmQgd2Ugc2hvdWxkCi0JICogc3RvcmUgdXAgdGhlIGRh
bWFnZSB1bnRpbCBsYXRlci4KKwkvKiBUcnkgdG8gbG9jayB0aGUgQk8uIElmIHdlIGZhaWwgd2l0
aCAtRUJVU1kgdGhlbgorCSAqIHRoZSBCTyBpcyBiZWluZyBtb3ZlZCBhbmQgd2Ugc2hvdWxkIHN0
b3JlIHVwIHRoZQorCSAqIGRhbWFnZSB1bnRpbCBsYXRlci4KIAkgKi8KIAlpZiAoZHJtX2Nhbl9z
bGVlcCgpKQotCQlyZXQgPSBkcm1fZ2VtX3ZyYW1fcmVzZXJ2ZShnYm8sIHRydWUpOworCQlyZXQg
PSBkcm1fZ2VtX3ZyYW1fbG9jayhnYm8sIHRydWUpOwogCWlmIChyZXQpIHsKIAkJaWYgKHJldCAh
PSAtRUJVU1kpCiAJCQlyZXR1cm47CkBAIC0xMDEsNyArMTAwLDcgQEAgc3RhdGljIHZvaWQgbWdh
X2RpcnR5X3VwZGF0ZShzdHJ1Y3QgbWdhX2ZiZGV2ICptZmJkZXYsCiAJCWRybV9nZW1fdnJhbV9r
dW5tYXAoZ2JvKTsKIAogb3V0OgotCWRybV9nZW1fdnJhbV91bnJlc2VydmUoZ2JvKTsKKwlkcm1f
Z2VtX3ZyYW1fdW5sb2NrKGdibyk7CiB9CiAKIHN0YXRpYyB2b2lkIG1nYV9maWxscmVjdChzdHJ1
Y3QgZmJfaW5mbyAqaW5mbywKZGlmZiAtLWdpdCBhL2luY2x1ZGUvZHJtL2RybV9nZW1fdnJhbV9o
ZWxwZXIuaCBiL2luY2x1ZGUvZHJtL2RybV9nZW1fdnJhbV9oZWxwZXIuaAppbmRleCAyMmU1MmQ3
ZGZiYjcuLjRkMWQyYzFiZjMyYiAxMDA2NDQKLS0tIGEvaW5jbHVkZS9kcm0vZHJtX2dlbV92cmFt
X2hlbHBlci5oCisrKyBiL2luY2x1ZGUvZHJtL2RybV9nZW1fdnJhbV9oZWxwZXIuaApAQCAtNzcs
MTUgKzc3LDE1IEBAIHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpkcm1fZ2VtX3ZyYW1fY3Jl
YXRlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJCQkJCQl1bnNpZ25lZCBsb25nIHBnX2FsaWdu
LAogCQkJCQkJYm9vbCBpbnRlcnJ1cHRpYmxlKTsKIHZvaWQgZHJtX2dlbV92cmFtX3B1dChzdHJ1
Y3QgZHJtX2dlbV92cmFtX29iamVjdCAqZ2JvKTsKLWludCBkcm1fZ2VtX3ZyYW1fcmVzZXJ2ZShz
dHJ1Y3QgZHJtX2dlbV92cmFtX29iamVjdCAqZ2JvLCBib29sIG5vX3dhaXQpOwotdm9pZCBkcm1f
Z2VtX3ZyYW1fdW5yZXNlcnZlKHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8pOworaW50
IGRybV9nZW1fdnJhbV9sb2NrKHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8sIGJvb2wg
bm9fd2FpdCk7Cit2b2lkIGRybV9nZW1fdnJhbV91bmxvY2soc3RydWN0IGRybV9nZW1fdnJhbV9v
YmplY3QgKmdibyk7CiB1NjQgZHJtX2dlbV92cmFtX21tYXBfb2Zmc2V0KHN0cnVjdCBkcm1fZ2Vt
X3ZyYW1fb2JqZWN0ICpnYm8pOwogczY0IGRybV9nZW1fdnJhbV9vZmZzZXQoc3RydWN0IGRybV9n
ZW1fdnJhbV9vYmplY3QgKmdibyk7CiBpbnQgZHJtX2dlbV92cmFtX3BpbihzdHJ1Y3QgZHJtX2dl
bV92cmFtX29iamVjdCAqZ2JvLCB1bnNpZ25lZCBsb25nIHBsX2ZsYWcpOwotaW50IGRybV9nZW1f
dnJhbV9waW5fcmVzZXJ2ZWQoc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKmdibywKK2ludCBk
cm1fZ2VtX3ZyYW1fcGluX2xvY2tlZChzdHJ1Y3QgZHJtX2dlbV92cmFtX29iamVjdCAqZ2JvLAog
CQkJICAgICAgdW5zaWduZWQgbG9uZyBwbF9mbGFnKTsKIGludCBkcm1fZ2VtX3ZyYW1fdW5waW4o
c3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKmdibyk7Ci1pbnQgZHJtX2dlbV92cmFtX3VucGlu
X3Jlc2VydmVkKHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8pOworaW50IGRybV9nZW1f
dnJhbV91bnBpbl9sb2NrZWQoc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKmdibyk7CiB2b2lk
ICpkcm1fZ2VtX3ZyYW1fa21hcF9hdChzdHJ1Y3QgZHJtX2dlbV92cmFtX29iamVjdCAqZ2JvLCBi
b29sIG1hcCwKIAkJCSAgIGJvb2wgKmlzX2lvbWVtLCBzdHJ1Y3QgdHRtX2JvX2ttYXBfb2JqICpr
bWFwKTsKIHZvaWQgKmRybV9nZW1fdnJhbV9rbWFwKHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0
ICpnYm8sIGJvb2wgbWFwLAotLSAKMi4yMS4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0
cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9s
aXN0aW5mby9kcmktZGV2ZWw=
