Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 35FFB890C8
	for <lists+dri-devel@lfdr.de>; Sun, 11 Aug 2019 10:56:12 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 167576E2ED;
	Sun, 11 Aug 2019 08:56:10 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-wm1-x343.google.com (mail-wm1-x343.google.com
 [IPv6:2a00:1450:4864:20::343])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3C00B6E2ED;
 Sun, 11 Aug 2019 08:56:08 +0000 (UTC)
Received: by mail-wm1-x343.google.com with SMTP id p77so8931723wme.0;
 Sun, 11 Aug 2019 01:56:08 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=rpK6pRIvJBgoUVj/Kl8/Ed+o3uYQTeHvdSuprt8hFiY=;
 b=VMs657ksaOEPDXoFR+exQuoVv4eiutPDSLlUUFNDXIVjKrJUjj4/ULTm0bIwHezAtf
 vgXIdQLtdl5qunZXt8uDFCCNIpaq/M5Xf65+Qlk5cJ1T4qLmKhqt00TZ9tDZIn3ZpZtD
 k4wV8u3kpPRwGR/wD5ewpOzh6Zr7IRJ44UVtKqbi8zJmvK0kgCYBNWLarlDP0QLL1dHE
 SMGrmi7xnAfglohNz774WVcFD7B0eTlNLPZcCeaWji0btew3YqMHHmRRCzTg9EEenFAO
 50LJRA4g2yRVlaSAwltl++iIPL8BtVuXaGvS8BkL9mf4xZ3LJjGiMDuok+pjy3PRQ2Ay
 QYxQ==
X-Gm-Message-State: APjAAAU0ZDush2jh+OIRwRH0yO6TgEY7ztsW46mKwg5ix84VnflMRROG
 u65kE0sBgUbzbIPyyzDZjJya7esL
X-Google-Smtp-Source: APXvYqygQNWYsH5k98axIN+kdD47UINV73wjq75hAjVmGvViauSJ2HVa9yaFlYpkcnSArw24HCYnBQ==
X-Received: by 2002:a1c:751a:: with SMTP id o26mr21046915wmc.13.1565513764722; 
 Sun, 11 Aug 2019 01:56:04 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:b98e:f2af:19be:910c])
 by smtp.gmail.com with ESMTPSA id o20sm256566882wrh.8.2019.08.11.01.56.02
 (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
 Sun, 11 Aug 2019 01:56:03 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH] dma-buf: rename reservation_object to dma_resv
Date: Sun, 11 Aug 2019 10:56:01 +0200
Message-Id: <20190811085601.110919-1-christian.koenig@amd.com>
X-Mailer: git-send-email 2.17.1
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=rpK6pRIvJBgoUVj/Kl8/Ed+o3uYQTeHvdSuprt8hFiY=;
 b=swdiDsavTIGU2VhRwBQwOrnPDzZ0Wux4DcyHynSP1cdCM4wkmdtz065fLD0e8+v/SX
 2xieYh+lZkAoWAhz3KsxJ/rQjSWfBkusdtzBqtSEERRx0DR/VVGgpmVTaItOj9Q/IJPk
 aWxQuQCXN02Yidn1bLYrvLoXlWlyyl4WRxMkTyX6RHisloJEyqJguESaZlG9HIIolSIf
 TXYQJ0sdLEOTZTXNOpUmx6l7sTsGH268SP8huGa6UqZ+4EeTmBaPmlIk3g9MyDEt5X+f
 qGd8QnhAMegQVQx6EvSkFtijIVTaA0eFNvu44jtn+zAQwZzjof4p0NCRaE5YWbejymoc
 bPDw==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: gustavo@padovan.org, intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QmUgbW9yZSBjb25zaXN0ZW50IHdpdGggdGhlIG5hbWluZyBvZiB0aGUgb3RoZXIgRE1BLWJ1ZiBv
YmplY3RzLgoKU2lnbmVkLW9mZi1ieTogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0aWFuLmtvZW5p
Z0BhbWQuY29tPgotLS0KIGRyaXZlcnMvZG1hLWJ1Zi9NYWtlZmlsZSAgICAgICAgICAgICAgICAg
ICAgICB8ICAgMiArLQogZHJpdmVycy9kbWEtYnVmL2RtYS1idWYuYyAgICAgICAgICAgICAgICAg
ICAgIHwgIDMyICsrLS0KIGRyaXZlcnMvZG1hLWJ1Zi9kbWEtZmVuY2UuYyAgICAgICAgICAgICAg
ICAgICB8ICAgMiArLQogZHJpdmVycy9kbWEtYnVmL3tyZXNlcnZhdGlvbi5jID0+IGRtYS1yZXN2
LmN9IHwgMTY1ICsrKysrKysrKy0tLS0tLS0tLQogLi4uL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfYW1ka2ZkX2dwdXZtLmMgIHwgIDE0ICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9h
bWRncHVfY3MuYyAgICAgICAgfCAgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV9kaXNwbGF5LmMgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X2RtYV9idWYuYyAgIHwgIDIwICstLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X2dlbS5jICAgICAgIHwgICA2ICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfZ2VtLmggICAgICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9pZHMuYyAgICAgICB8ICAgNiArLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X2lkcy5oICAgICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
bW4uYyAgICAgICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9v
YmplY3QuYyAgICB8ICAxOCArLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X29i
amVjdC5oICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfc3lu
Yy5jICAgICAgfCAgMTAgKy0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9zeW5j
LmggICAgICB8ICAgNCArLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5j
ICAgICAgIHwgIDE0ICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmgg
ICAgICAgfCAgIDYgKy0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV91dmQuYyAg
ICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZtLmMgICAg
ICAgIHwgIDIwICstLQogLi4uL2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9k
bS5jIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vZHJtX2F0b21pY191YXBpLmMgICAgICAgICAg
ICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtLmMgICAgICAgICAgICAgICAgICAg
ICB8ICAyNiArLS0KIGRyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX2ZyYW1lYnVmZmVyX2hlbHBlci5j
ICB8ICAgNCArLQogZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9nZW0uYyAgICAgICAg
IHwgICA4ICstCiBkcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2dlbS5oICAgICAgICAg
fCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZ2VtX3N1Ym1pdC5jICB8
ICAxNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMgIHwg
ICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fYnVzeS5jICAgICAgfCAg
IDYgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jbGZsdXNoLmMgICB8ICAg
MiArLQogLi4uL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xpZW50X2JsdC5jICAgIHwgICAy
ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZG1hYnVmLmMgICAgfCAgIDIg
Ky0KIC4uLi9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyAgICB8ICAgNiAr
LQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2ZlbmNlLmMgICAgIHwgICAyICst
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmggICAgfCAgMTAgKy0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV93YWl0LmMgICAgICB8ICAxOCArLQog
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaCAgICAgICAgICAgICAgIHwgICAyICstCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jICAgICAgICAgICAgICAgfCAgIDIgKy0KIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2JhdGNoX3Bvb2wuYyAgICB8ICAxMiArLQogZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMgICAgICAgICAgIHwgICA0ICstCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N3X2ZlbmNlLmMgICAgICAgICAgfCAgIDggKy0KIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfc3dfZmVuY2UuaCAgICAgICAgICB8ICAgNCArLQogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYyAgICAgICAgICAgICAgIHwgIDE2ICstCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5oICAgICAgICAgICAgICAgfCAgIDggKy0KIGRyaXZlcnMv
Z3B1L2RybS9saW1hL2xpbWFfZ2VtLmMgICAgICAgICAgICAgICB8ICAgOCArLQogZHJpdmVycy9n
cHUvZHJtL21lZGlhdGVrL210a19kcm1fZmIuYyAgICAgICAgIHwgICAyICstCiBkcml2ZXJzL2dw
dS9kcm0vbXNtL21zbV9nZW0uYyAgICAgICAgICAgICAgICAgfCAgMTggKy0KIGRyaXZlcnMvZ3B1
L2RybS9tc20vbXNtX2dlbS5oICAgICAgICAgICAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUv
ZHJtL21zbS9tc21fZ2VtX3N1Ym1pdC5jICAgICAgICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9k
cm0vbXhzZmIvbXhzZmJfZHJ2LmMgICAgICAgICAgICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9ub3V2ZWF1L2Rpc3BudjUwL3duZHcuYyAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJt
L25vdXZlYXUvbm91dmVhdV9iby5jICAgICAgICAgIHwgIDEwICstCiBkcml2ZXJzL2dwdS9kcm0v
bm91dmVhdS9ub3V2ZWF1X2JvLmggICAgICAgICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9u
b3V2ZWF1L25vdXZlYXVfZmVuY2UuYyAgICAgICB8ICAxMiArLQogZHJpdmVycy9ncHUvZHJtL25v
dXZlYXUvbm91dmVhdV9nZW0uYyAgICAgICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vbm91
dmVhdS9ub3V2ZWF1X3ByaW1lLmMgICAgICAgfCAgIDYgKy0KIGRyaXZlcnMvZ3B1L2RybS9wYW5m
cm9zdC9wYW5mcm9zdF9kcnYuYyAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL3BhbmZy
b3N0L3BhbmZyb3N0X2pvYi5jICAgICAgIHwgICA2ICstCiBkcml2ZXJzL2dwdS9kcm0vcXhsL3F4
bF9kZWJ1Z2ZzLmMgICAgICAgICAgICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9xeGwvcXhs
X3JlbGVhc2UuYyAgICAgICAgICAgICB8ICAgNiArLQogZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9j
aWsuYyAgICAgICAgICAgICAgICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vcmFkZW9uL2Np
a19zZG1hLmMgICAgICAgICAgICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9yYWRlb24vZXZl
cmdyZWVuX2RtYS5jICAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yMTAw
LmMgICAgICAgICAgICAgICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3IyMDAu
YyAgICAgICAgICAgICAgICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9yYWRlb24vcjYwMC5j
ICAgICAgICAgICAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yNjAwX2Rt
YS5jICAgICAgICAgICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbi5o
ICAgICAgICAgICAgICAgfCAgIDggKy0KIGRyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX2Fz
aWMuaCAgICAgICAgICB8ICAxOCArLQogZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fYmVu
Y2htYXJrLmMgICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9jcy5j
ICAgICAgICAgICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX2Rpc3Bs
YXkuYyAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fZ2VtLmMg
ICAgICAgICAgIHwgICA2ICstCiBkcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9tbi5jICAg
ICAgICAgICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX29iamVjdC5j
ICAgICAgICB8ICAxNCArLQogZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fb2JqZWN0Lmgg
ICAgICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9wcmltZS5jICAg
ICAgICAgfCAgIDYgKy0KIGRyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX3N5bmMuYyAgICAg
ICAgICB8ICAxMCArLQogZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fdXZkLmMgICAgICAg
ICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl92bS5jICAgICAgICAg
ICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9yYWRlb24vcnY3NzBfZG1hLmMgICAgICAgICAg
ICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9zaV9kbWEuYyAgICAgICAgICAgICAg
IHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5jICAgICAgICAgICAgICAgICAg
fCAxMTggKysrKysrLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm9fdXRpbC5jICAg
ICAgICAgICAgIHwgIDE2ICstCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib192bS5jICAgICAg
ICAgICAgICAgfCAgIDYgKy0KIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2V4ZWNidWZfdXRpbC5j
ICAgICAgICB8ICAyMCArLS0KIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3R0LmMgICAgICAgICAg
ICAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL3YzZC92M2RfZ2VtLmMgICAgICAgICAg
ICAgICAgIHwgICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vdmM0L3ZjNF9nZW0uYyAgICAgICAgICAg
ICAgICAgfCAgIDYgKy0KIGRyaXZlcnMvZ3B1L2RybS92Z2VtL3ZnZW1fZmVuY2UuYyAgICAgICAg
ICAgICB8ICAxNiArLQogZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X2lvY3RsLmMgICAg
ICAgIHwgICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfcGxhbmUuYyAgICAg
ICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2JsaXQuYyAgICAgICAg
ICB8ICAgNCArLQogZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfYm8uYyAgICAgICAgICAg
IHwgICA4ICstCiBkcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9jb3RhYmxlLmMgICAgICAg
fCAgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3Jlc291cmNlLmMgICAgICB8
ICAgNiArLQogaW5jbHVkZS9kcm0vZHJtUC5oICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwg
ICAyICstCiBpbmNsdWRlL2RybS9kcm1fZ2VtLmggICAgICAgICAgICAgICAgICAgICAgICAgfCAg
IDggKy0KIGluY2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmggICAgICAgICAgICAgICAgICB8ICAx
MiArLQogaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19kcml2ZXIuaCAgICAgICAgICAgICAgIHwgIDE0
ICstCiBpbmNsdWRlL2xpbnV4L2RtYS1idWYuaCAgICAgICAgICAgICAgICAgICAgICAgfCAgIDQg
Ky0KIGluY2x1ZGUvbGludXgvZG1hLWZlbmNlLmggICAgICAgICAgICAgICAgICAgICB8ICAgNCAr
LQogaW5jbHVkZS9saW51eC97cmVzZXJ2YXRpb24uaCA9PiBkbWEtcmVzdi5ofSAgIHwgMTM0ICsr
KysrKy0tLS0tLS0tCiAxMDQgZmlsZXMgY2hhbmdlZCwgNTIzIGluc2VydGlvbnMoKyksIDU1MCBk
ZWxldGlvbnMoLSkKIHJlbmFtZSBkcml2ZXJzL2RtYS1idWYve3Jlc2VydmF0aW9uLmMgPT4gZG1h
LXJlc3YuY30gKDcyJSkKIHJlbmFtZSBpbmNsdWRlL2xpbnV4L3tyZXNlcnZhdGlvbi5oID0+IGRt
YS1yZXN2Lmh9ICg2NCUpCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9kbWEtYnVmL01ha2VmaWxlIGIv
ZHJpdmVycy9kbWEtYnVmL01ha2VmaWxlCmluZGV4IGU4YzczMTBjYjgwMC4uZGNmYjAxZTdjNmY0
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2RtYS1idWYvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9kbWEt
YnVmL01ha2VmaWxlCkBAIC0xLDYgKzEsNiBAQAogIyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjog
R1BMLTIuMC1vbmx5CiBvYmoteSA6PSBkbWEtYnVmLm8gZG1hLWZlbmNlLm8gZG1hLWZlbmNlLWFy
cmF5Lm8gZG1hLWZlbmNlLWNoYWluLm8gXAotCSByZXNlcnZhdGlvbi5vIHNlcW5vLWZlbmNlLm8K
KwkgZG1hLXJlc3YubyBzZXFuby1mZW5jZS5vCiBvYmotJChDT05GSUdfU1lOQ19GSUxFKQkJKz0g
c3luY19maWxlLm8KIG9iai0kKENPTkZJR19TV19TWU5DKQkJKz0gc3dfc3luYy5vIHN5bmNfZGVi
dWcubwogb2JqLSQoQ09ORklHX1VETUFCVUYpCQkrPSB1ZG1hYnVmLm8KZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZG1hLWJ1Zi9kbWEtYnVmLmMgYi9kcml2ZXJzL2RtYS1idWYvZG1hLWJ1Zi5jCmluZGV4
IDY3NTEwZjJiZThiYy4uYjM0MDBkNjUyNGFiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2RtYS1idWYv
ZG1hLWJ1Zi5jCisrKyBiL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtYnVmLmMKQEAgLTIxLDcgKzIxLDcg
QEAKICNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KICNpbmNsdWRlIDxsaW51eC9zZXFfZmlsZS5o
PgogI2luY2x1ZGUgPGxpbnV4L3BvbGwuaD4KLSNpbmNsdWRlIDxsaW51eC9yZXNlcnZhdGlvbi5o
PgorI2luY2x1ZGUgPGxpbnV4L2RtYS1yZXN2Lmg+CiAjaW5jbHVkZSA8bGludXgvbW0uaD4KICNp
bmNsdWRlIDxsaW51eC9tb3VudC5oPgogI2luY2x1ZGUgPGxpbnV4L3BzZXVkb19mcy5oPgpAQCAt
MTA0LDggKzEwNCw4IEBAIHN0YXRpYyBpbnQgZG1hX2J1Zl9yZWxlYXNlKHN0cnVjdCBpbm9kZSAq
aW5vZGUsIHN0cnVjdCBmaWxlICpmaWxlKQogCWxpc3RfZGVsKCZkbWFidWYtPmxpc3Rfbm9kZSk7
CiAJbXV0ZXhfdW5sb2NrKCZkYl9saXN0LmxvY2spOwogCi0JaWYgKGRtYWJ1Zi0+cmVzdiA9PSAo
c3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqKSZkbWFidWZbMV0pCi0JCXJlc2VydmF0aW9uX29i
amVjdF9maW5pKGRtYWJ1Zi0+cmVzdik7CisJaWYgKGRtYWJ1Zi0+cmVzdiA9PSAoc3RydWN0IGRt
YV9yZXN2ICopJmRtYWJ1ZlsxXSkKKwkJZG1hX3Jlc3ZfZmluaShkbWFidWYtPnJlc3YpOwogCiAJ
bW9kdWxlX3B1dChkbWFidWYtPm93bmVyKTsKIAlrZnJlZShkbWFidWYpOwpAQCAtMTY1LDcgKzE2
NSw3IEBAIHN0YXRpYyBsb2ZmX3QgZG1hX2J1Zl9sbHNlZWsoc3RydWN0IGZpbGUgKmZpbGUsIGxv
ZmZfdCBvZmZzZXQsIGludCB3aGVuY2UpCiAgKiBUbyBzdXBwb3J0IGNyb3NzLWRldmljZSBhbmQg
Y3Jvc3MtZHJpdmVyIHN5bmNocm9uaXphdGlvbiBvZiBidWZmZXIgYWNjZXNzCiAgKiBpbXBsaWNp
dCBmZW5jZXMgKHJlcHJlc2VudGVkIGludGVybmFsbHkgaW4gdGhlIGtlcm5lbCB3aXRoICZzdHJ1
Y3QgZmVuY2UpIGNhbgogICogYmUgYXR0YWNoZWQgdG8gYSAmZG1hX2J1Zi4gVGhlIGdsdWUgZm9y
IHRoYXQgYW5kIGEgZmV3IHJlbGF0ZWQgdGhpbmdzIGFyZQotICogcHJvdmlkZWQgaW4gdGhlICZy
ZXNlcnZhdGlvbl9vYmplY3Qgc3RydWN0dXJlLgorICogcHJvdmlkZWQgaW4gdGhlICZkbWFfcmVz
diBzdHJ1Y3R1cmUuCiAgKgogICogVXNlcnNwYWNlIGNhbiBxdWVyeSB0aGUgc3RhdGUgb2YgdGhl
c2UgaW1wbGljaXRseSB0cmFja2VkIGZlbmNlcyB1c2luZyBwb2xsKCkKICAqIGFuZCByZWxhdGVk
IHN5c3RlbSBjYWxsczoKQEAgLTE5NSw4ICsxOTUsOCBAQCBzdGF0aWMgdm9pZCBkbWFfYnVmX3Bv
bGxfY2Ioc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UsIHN0cnVjdCBkbWFfZmVuY2VfY2IgKmNiKQog
c3RhdGljIF9fcG9sbF90IGRtYV9idWZfcG9sbChzdHJ1Y3QgZmlsZSAqZmlsZSwgcG9sbF90YWJs
ZSAqcG9sbCkKIHsKIAlzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmOwotCXN0cnVjdCByZXNlcnZhdGlv
bl9vYmplY3QgKnJlc3Y7Ci0Jc3RydWN0IHJlc2VydmF0aW9uX29iamVjdF9saXN0ICpmb2JqOwor
CXN0cnVjdCBkbWFfcmVzdiAqcmVzdjsKKwlzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCAqZm9iajsKIAlz
dHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZV9leGNsOwogCV9fcG9sbF90IGV2ZW50czsKIAl1bnNpZ25l
ZCBzaGFyZWRfY291bnQ7CkBAIC0yMTQsNyArMjE0LDcgQEAgc3RhdGljIF9fcG9sbF90IGRtYV9i
dWZfcG9sbChzdHJ1Y3QgZmlsZSAqZmlsZSwgcG9sbF90YWJsZSAqcG9sbCkKIAkJcmV0dXJuIDA7
CiAKIAlyY3VfcmVhZF9sb2NrKCk7Ci0JcmVzZXJ2YXRpb25fb2JqZWN0X2ZlbmNlcyhyZXN2LCAm
ZmVuY2VfZXhjbCwgJmZvYmosICZzaGFyZWRfY291bnQpOworCWRtYV9yZXN2X2ZlbmNlcyhyZXN2
LCAmZmVuY2VfZXhjbCwgJmZvYmosICZzaGFyZWRfY291bnQpOwogCWlmIChmZW5jZV9leGNsICYm
ICghKGV2ZW50cyAmIEVQT0xMT1VUKSB8fCBzaGFyZWRfY291bnQgPT0gMCkpIHsKIAkJc3RydWN0
IGRtYV9idWZfcG9sbF9jYl90ICpkY2IgPSAmZG1hYnVmLT5jYl9leGNsOwogCQlfX3BvbGxfdCBw
ZXZlbnRzID0gRVBPTExJTjsKQEAgLTQ5MywxMyArNDkzLDEzIEBAIHN0YXRpYyBzdHJ1Y3QgZmls
ZSAqZG1hX2J1Zl9nZXRmaWxlKHN0cnVjdCBkbWFfYnVmICpkbWFidWYsIGludCBmbGFncykKIHN0
cnVjdCBkbWFfYnVmICpkbWFfYnVmX2V4cG9ydChjb25zdCBzdHJ1Y3QgZG1hX2J1Zl9leHBvcnRf
aW5mbyAqZXhwX2luZm8pCiB7CiAJc3RydWN0IGRtYV9idWYgKmRtYWJ1ZjsKLQlzdHJ1Y3QgcmVz
ZXJ2YXRpb25fb2JqZWN0ICpyZXN2ID0gZXhwX2luZm8tPnJlc3Y7CisJc3RydWN0IGRtYV9yZXN2
ICpyZXN2ID0gZXhwX2luZm8tPnJlc3Y7CiAJc3RydWN0IGZpbGUgKmZpbGU7CiAJc2l6ZV90IGFs
bG9jX3NpemUgPSBzaXplb2Yoc3RydWN0IGRtYV9idWYpOwogCWludCByZXQ7CiAKIAlpZiAoIWV4
cF9pbmZvLT5yZXN2KQotCQlhbGxvY19zaXplICs9IHNpemVvZihzdHJ1Y3QgcmVzZXJ2YXRpb25f
b2JqZWN0KTsKKwkJYWxsb2Nfc2l6ZSArPSBzaXplb2Yoc3RydWN0IGRtYV9yZXN2KTsKIAllbHNl
CiAJCS8qIHByZXZlbnQgJmRtYV9idWZbMV0gPT0gZG1hX2J1Zi0+cmVzdiAqLwogCQlhbGxvY19z
aXplICs9IDE7CkBAIC01MzEsOCArNTMxLDggQEAgc3RydWN0IGRtYV9idWYgKmRtYV9idWZfZXhw
b3J0KGNvbnN0IHN0cnVjdCBkbWFfYnVmX2V4cG9ydF9pbmZvICpleHBfaW5mbykKIAlkbWFidWYt
PmNiX2V4Y2wuYWN0aXZlID0gZG1hYnVmLT5jYl9zaGFyZWQuYWN0aXZlID0gMDsKIAogCWlmICgh
cmVzdikgewotCQlyZXN2ID0gKHN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKikmZG1hYnVmWzFd
OwotCQlyZXNlcnZhdGlvbl9vYmplY3RfaW5pdChyZXN2KTsKKwkJcmVzdiA9IChzdHJ1Y3QgZG1h
X3Jlc3YgKikmZG1hYnVmWzFdOworCQlkbWFfcmVzdl9pbml0KHJlc3YpOwogCX0KIAlkbWFidWYt
PnJlc3YgPSByZXN2OwogCkBAIC04OTYsMTEgKzg5NiwxMSBAQCBzdGF0aWMgaW50IF9fZG1hX2J1
Zl9iZWdpbl9jcHVfYWNjZXNzKHN0cnVjdCBkbWFfYnVmICpkbWFidWYsCiB7CiAJYm9vbCB3cml0
ZSA9IChkaXJlY3Rpb24gPT0gRE1BX0JJRElSRUNUSU9OQUwgfHwKIAkJICAgICAgZGlyZWN0aW9u
ID09IERNQV9UT19ERVZJQ0UpOwotCXN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKnJlc3YgPSBk
bWFidWYtPnJlc3Y7CisJc3RydWN0IGRtYV9yZXN2ICpyZXN2ID0gZG1hYnVmLT5yZXN2OwogCWxv
bmcgcmV0OwogCiAJLyogV2FpdCBvbiBhbnkgaW1wbGljaXQgcmVuZGVyaW5nIGZlbmNlcyAqLwot
CXJldCA9IHJlc2VydmF0aW9uX29iamVjdF93YWl0X3RpbWVvdXRfcmN1KHJlc3YsIHdyaXRlLCB0
cnVlLAorCXJldCA9IGRtYV9yZXN2X3dhaXRfdGltZW91dF9yY3UocmVzdiwgd3JpdGUsIHRydWUs
CiAJCQkJCQkgIE1BWF9TQ0hFRFVMRV9USU1FT1VUKTsKIAlpZiAocmV0IDwgMCkKIAkJcmV0dXJu
IHJldDsKQEAgLTExNDEsOCArMTE0MSw4IEBAIHN0YXRpYyBpbnQgZG1hX2J1Zl9kZWJ1Z19zaG93
KHN0cnVjdCBzZXFfZmlsZSAqcywgdm9pZCAqdW51c2VkKQogCWludCByZXQ7CiAJc3RydWN0IGRt
YV9idWYgKmJ1Zl9vYmo7CiAJc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCAqYXR0YWNoX29iajsK
LQlzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyb2JqOwotCXN0cnVjdCByZXNlcnZhdGlvbl9v
YmplY3RfbGlzdCAqZm9iajsKKwlzdHJ1Y3QgZG1hX3Jlc3YgKnJvYmo7CisJc3RydWN0IGRtYV9y
ZXN2X2xpc3QgKmZvYmo7CiAJc3RydWN0IGRtYV9mZW5jZSAqZmVuY2U7CiAJaW50IGNvdW50ID0g
MCwgYXR0YWNoX2NvdW50LCBzaGFyZWRfY291bnQsIGk7CiAJc2l6ZV90IHNpemUgPSAwOwpAQCAt
MTE3NSw3ICsxMTc1LDcgQEAgc3RhdGljIGludCBkbWFfYnVmX2RlYnVnX3Nob3coc3RydWN0IHNl
cV9maWxlICpzLCB2b2lkICp1bnVzZWQpCiAKIAkJcm9iaiA9IGJ1Zl9vYmotPnJlc3Y7CiAJCXJj
dV9yZWFkX2xvY2soKTsKLQkJcmVzZXJ2YXRpb25fb2JqZWN0X2ZlbmNlcyhyb2JqLCAmZmVuY2Us
ICZmb2JqLCAmc2hhcmVkX2NvdW50KTsKKwkJZG1hX3Jlc3ZfZmVuY2VzKHJvYmosICZmZW5jZSwg
JmZvYmosICZzaGFyZWRfY291bnQpOwogCQlyY3VfcmVhZF91bmxvY2soKTsKIAogCQlpZiAoZmVu
Y2UpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2RtYS1idWYvZG1hLWZlbmNlLmMgYi9kcml2ZXJzL2Rt
YS1idWYvZG1hLWZlbmNlLmMKaW5kZXggNTlhYzk2ZWM3YmE4Li44MDI1YTg5MWQzZTkgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtZmVuY2UuYworKysgYi9kcml2ZXJzL2RtYS1idWYv
ZG1hLWZlbmNlLmMKQEAgLTYwLDcgKzYwLDcgQEAgc3RhdGljIGF0b21pYzY0X3QgZG1hX2ZlbmNl
X2NvbnRleHRfY291bnRlciA9IEFUT01JQzY0X0lOSVQoMSk7CiAgKgogICogLSBUaGVuIHRoZXJl
J3MgYWxzbyBpbXBsaWNpdCBmZW5jaW5nLCB3aGVyZSB0aGUgc3luY2hyb25pemF0aW9uIHBvaW50
cyBhcmUKICAqICAgaW1wbGljaXRseSBwYXNzZWQgYXJvdW5kIGFzIHBhcnQgb2Ygc2hhcmVkICZk
bWFfYnVmIGluc3RhbmNlcy4gU3VjaAotICogICBpbXBsaWNpdCBmZW5jZXMgYXJlIHN0b3JlZCBp
biAmc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCB0aHJvdWdoIHRoZQorICogICBpbXBsaWNpdCBm
ZW5jZXMgYXJlIHN0b3JlZCBpbiAmc3RydWN0IGRtYV9yZXN2IHRocm91Z2ggdGhlCiAgKiAgICZk
bWFfYnVmLnJlc3YgcG9pbnRlci4KICAqLwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2RtYS1idWYv
cmVzZXJ2YXRpb24uYyBiL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtcmVzdi5jCnNpbWlsYXJpdHkgaW5k
ZXggNzIlCnJlbmFtZSBmcm9tIGRyaXZlcnMvZG1hLWJ1Zi9yZXNlcnZhdGlvbi5jCnJlbmFtZSB0
byBkcml2ZXJzL2RtYS1idWYvZG1hLXJlc3YuYwppbmRleCBmN2Y0YTA4NThjMmEuLmY1MTQyNjgz
Yzg1MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9kbWEtYnVmL3Jlc2VydmF0aW9uLmMKKysrIGIvZHJp
dmVycy9kbWEtYnVmL2RtYS1yZXN2LmMKQEAgLTMyLDcgKzMyLDcgQEAKICAqIEF1dGhvcnM6IFRo
b21hcyBIZWxsc3Ryb20gPHRoZWxsc3Ryb20tYXQtdm13YXJlLWRvdC1jb20+CiAgKi8KIAotI2lu
Y2x1ZGUgPGxpbnV4L3Jlc2VydmF0aW9uLmg+CisjaW5jbHVkZSA8bGludXgvZG1hLXJlc3YuaD4K
ICNpbmNsdWRlIDxsaW51eC9leHBvcnQuaD4KIAogLyoqCkBAIC01MCwxNiArNTAsMTUgQEAgREVG
SU5FX1dEX0NMQVNTKHJlc2VydmF0aW9uX3d3X2NsYXNzKTsKIEVYUE9SVF9TWU1CT0wocmVzZXJ2
YXRpb25fd3dfY2xhc3MpOwogCiAvKioKLSAqIHJlc2VydmF0aW9uX29iamVjdF9saXN0X2FsbG9j
IC0gYWxsb2NhdGUgZmVuY2UgbGlzdAorICogZG1hX3Jlc3ZfbGlzdF9hbGxvYyAtIGFsbG9jYXRl
IGZlbmNlIGxpc3QKICAqIEBzaGFyZWRfbWF4OiBudW1iZXIgb2YgZmVuY2VzIHdlIG5lZWQgc3Bh
Y2UgZm9yCiAgKgotICogQWxsb2NhdGUgYSBuZXcgcmVzZXJ2YXRpb25fb2JqZWN0X2xpc3QgYW5k
IG1ha2Ugc3VyZSB0byBjb3JyZWN0bHkgaW5pdGlhbGl6ZQorICogQWxsb2NhdGUgYSBuZXcgZG1h
X3Jlc3ZfbGlzdCBhbmQgbWFrZSBzdXJlIHRvIGNvcnJlY3RseSBpbml0aWFsaXplCiAgKiBzaGFy
ZWRfbWF4LgogICovCi1zdGF0aWMgc3RydWN0IHJlc2VydmF0aW9uX29iamVjdF9saXN0ICoKLXJl
c2VydmF0aW9uX29iamVjdF9saXN0X2FsbG9jKHVuc2lnbmVkIGludCBzaGFyZWRfbWF4KQorc3Rh
dGljIHN0cnVjdCBkbWFfcmVzdl9saXN0ICpkbWFfcmVzdl9saXN0X2FsbG9jKHVuc2lnbmVkIGlu
dCBzaGFyZWRfbWF4KQogewotCXN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3RfbGlzdCAqbGlzdDsK
KwlzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCAqbGlzdDsKIAogCWxpc3QgPSBrbWFsbG9jKG9mZnNldG9m
KHR5cGVvZigqbGlzdCksIHNoYXJlZFtzaGFyZWRfbWF4XSksIEdGUF9LRVJORUwpOwogCWlmICgh
bGlzdCkKQEAgLTcyLDEyICs3MSwxMiBAQCByZXNlcnZhdGlvbl9vYmplY3RfbGlzdF9hbGxvYyh1
bnNpZ25lZCBpbnQgc2hhcmVkX21heCkKIH0KIAogLyoqCi0gKiByZXNlcnZhdGlvbl9vYmplY3Rf
bGlzdF9mcmVlIC0gZnJlZSBmZW5jZSBsaXN0CisgKiBkbWFfcmVzdl9saXN0X2ZyZWUgLSBmcmVl
IGZlbmNlIGxpc3QKICAqIEBsaXN0OiBsaXN0IHRvIGZyZWUKICAqCi0gKiBGcmVlIGEgcmVzZXJ2
YXRpb25fb2JqZWN0X2xpc3QgYW5kIG1ha2Ugc3VyZSB0byBkcm9wIGFsbCByZWZlcmVuY2VzLgor
ICogRnJlZSBhIGRtYV9yZXN2X2xpc3QgYW5kIG1ha2Ugc3VyZSB0byBkcm9wIGFsbCByZWZlcmVu
Y2VzLgogICovCi1zdGF0aWMgdm9pZCByZXNlcnZhdGlvbl9vYmplY3RfbGlzdF9mcmVlKHN0cnVj
dCByZXNlcnZhdGlvbl9vYmplY3RfbGlzdCAqbGlzdCkKK3N0YXRpYyB2b2lkIGRtYV9yZXN2X2xp
c3RfZnJlZShzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCAqbGlzdCkKIHsKIAl1bnNpZ25lZCBpbnQgaTsK
IApAQCAtOTEsMjQgKzkwLDI0IEBAIHN0YXRpYyB2b2lkIHJlc2VydmF0aW9uX29iamVjdF9saXN0
X2ZyZWUoc3RydWN0IHJlc2VydmF0aW9uX29iamVjdF9saXN0ICpsaXN0KQogfQogCiAvKioKLSAq
IHJlc2VydmF0aW9uX29iamVjdF9pbml0IC0gaW5pdGlhbGl6ZSBhIHJlc2VydmF0aW9uIG9iamVj
dAorICogZG1hX3Jlc3ZfaW5pdCAtIGluaXRpYWxpemUgYSByZXNlcnZhdGlvbiBvYmplY3QKICAq
IEBvYmo6IHRoZSByZXNlcnZhdGlvbiBvYmplY3QKICAqLwotdm9pZCByZXNlcnZhdGlvbl9vYmpl
Y3RfaW5pdChzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpvYmopCit2b2lkIGRtYV9yZXN2X2lu
aXQoc3RydWN0IGRtYV9yZXN2ICpvYmopCiB7CiAJd3dfbXV0ZXhfaW5pdCgmb2JqLT5sb2NrLCAm
cmVzZXJ2YXRpb25fd3dfY2xhc3MpOwogCVJDVV9JTklUX1BPSU5URVIob2JqLT5mZW5jZSwgTlVM
TCk7CiAJUkNVX0lOSVRfUE9JTlRFUihvYmotPmZlbmNlX2V4Y2wsIE5VTEwpOwogfQotRVhQT1JU
X1NZTUJPTChyZXNlcnZhdGlvbl9vYmplY3RfaW5pdCk7CitFWFBPUlRfU1lNQk9MKGRtYV9yZXN2
X2luaXQpOwogCiAvKioKLSAqIHJlc2VydmF0aW9uX29iamVjdF9maW5pIC0gZGVzdHJveXMgYSBy
ZXNlcnZhdGlvbiBvYmplY3QKKyAqIGRtYV9yZXN2X2ZpbmkgLSBkZXN0cm95cyBhIHJlc2VydmF0
aW9uIG9iamVjdAogICogQG9iajogdGhlIHJlc2VydmF0aW9uIG9iamVjdAogICovCi12b2lkIHJl
c2VydmF0aW9uX29iamVjdF9maW5pKHN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKm9iaikKK3Zv
aWQgZG1hX3Jlc3ZfZmluaShzdHJ1Y3QgZG1hX3Jlc3YgKm9iaikKIHsKLQlzdHJ1Y3QgcmVzZXJ2
YXRpb25fb2JqZWN0X2xpc3QgKmZvYmo7CisJc3RydWN0IGRtYV9yZXN2X2xpc3QgKmZvYmo7CiAJ
c3RydWN0IGRtYV9mZW5jZSAqZXhjbDsKIAogCS8qCkBAIC0xMjAsMzIgKzExOSwzMSBAQCB2b2lk
IHJlc2VydmF0aW9uX29iamVjdF9maW5pKHN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKm9iaikK
IAkJZG1hX2ZlbmNlX3B1dChleGNsKTsKIAogCWZvYmogPSByY3VfZGVyZWZlcmVuY2VfcHJvdGVj
dGVkKG9iai0+ZmVuY2UsIDEpOwotCXJlc2VydmF0aW9uX29iamVjdF9saXN0X2ZyZWUoZm9iaik7
CisJZG1hX3Jlc3ZfbGlzdF9mcmVlKGZvYmopOwogCXd3X211dGV4X2Rlc3Ryb3koJm9iai0+bG9j
ayk7CiB9Ci1FWFBPUlRfU1lNQk9MKHJlc2VydmF0aW9uX29iamVjdF9maW5pKTsKK0VYUE9SVF9T
WU1CT0woZG1hX3Jlc3ZfZmluaSk7CiAKIC8qKgotICogcmVzZXJ2YXRpb25fb2JqZWN0X3Jlc2Vy
dmVfc2hhcmVkIC0gUmVzZXJ2ZSBzcGFjZSB0byBhZGQgc2hhcmVkIGZlbmNlcyB0bwotICogYSBy
ZXNlcnZhdGlvbl9vYmplY3QuCisgKiBkbWFfcmVzdl9yZXNlcnZlX3NoYXJlZCAtIFJlc2VydmUg
c3BhY2UgdG8gYWRkIHNoYXJlZCBmZW5jZXMgdG8KKyAqIGEgZG1hX3Jlc3YuCiAgKiBAb2JqOiBy
ZXNlcnZhdGlvbiBvYmplY3QKICAqIEBudW1fZmVuY2VzOiBudW1iZXIgb2YgZmVuY2VzIHdlIHdh
bnQgdG8gYWRkCiAgKgotICogU2hvdWxkIGJlIGNhbGxlZCBiZWZvcmUgcmVzZXJ2YXRpb25fb2Jq
ZWN0X2FkZF9zaGFyZWRfZmVuY2UoKS4gIE11c3QKKyAqIFNob3VsZCBiZSBjYWxsZWQgYmVmb3Jl
IGRtYV9yZXN2X2FkZF9zaGFyZWRfZmVuY2UoKS4gIE11c3QKICAqIGJlIGNhbGxlZCB3aXRoIG9i
ai0+bG9jayBoZWxkLgogICoKICAqIFJFVFVSTlMKICAqIFplcm8gZm9yIHN1Y2Nlc3MsIG9yIC1l
cnJubwogICovCi1pbnQgcmVzZXJ2YXRpb25fb2JqZWN0X3Jlc2VydmVfc2hhcmVkKHN0cnVjdCBy
ZXNlcnZhdGlvbl9vYmplY3QgKm9iaiwKLQkJCQkgICAgICB1bnNpZ25lZCBpbnQgbnVtX2ZlbmNl
cykKK2ludCBkbWFfcmVzdl9yZXNlcnZlX3NoYXJlZChzdHJ1Y3QgZG1hX3Jlc3YgKm9iaiwgdW5z
aWduZWQgaW50IG51bV9mZW5jZXMpCiB7Ci0Jc3RydWN0IHJlc2VydmF0aW9uX29iamVjdF9saXN0
ICpvbGQsICpuZXc7CisJc3RydWN0IGRtYV9yZXN2X2xpc3QgKm9sZCwgKm5ldzsKIAl1bnNpZ25l
ZCBpbnQgaSwgaiwgaywgbWF4OwogCi0JcmVzZXJ2YXRpb25fb2JqZWN0X2Fzc2VydF9oZWxkKG9i
aik7CisJZG1hX3Jlc3ZfYXNzZXJ0X2hlbGQob2JqKTsKIAotCW9sZCA9IHJlc2VydmF0aW9uX29i
amVjdF9nZXRfbGlzdChvYmopOworCW9sZCA9IGRtYV9yZXN2X2dldF9saXN0KG9iaik7CiAKIAlp
ZiAob2xkICYmIG9sZC0+c2hhcmVkX21heCkgewogCQlpZiAoKG9sZC0+c2hhcmVkX2NvdW50ICsg
bnVtX2ZlbmNlcykgPD0gb2xkLT5zaGFyZWRfbWF4KQpAQCAtMTU3LDcgKzE1NSw3IEBAIGludCBy
ZXNlcnZhdGlvbl9vYmplY3RfcmVzZXJ2ZV9zaGFyZWQoc3RydWN0IHJlc2VydmF0aW9uX29iamVj
dCAqb2JqLAogCQltYXggPSA0OwogCX0KIAotCW5ldyA9IHJlc2VydmF0aW9uX29iamVjdF9saXN0
X2FsbG9jKG1heCk7CisJbmV3ID0gZG1hX3Jlc3ZfbGlzdF9hbGxvYyhtYXgpOwogCWlmICghbmV3
KQogCQlyZXR1cm4gLUVOT01FTTsKIApAQCAtMTcxLDcgKzE2OSw3IEBAIGludCByZXNlcnZhdGlv
bl9vYmplY3RfcmVzZXJ2ZV9zaGFyZWQoc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqb2JqLAog
CQlzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZTsKIAogCQlmZW5jZSA9IHJjdV9kZXJlZmVyZW5jZV9w
cm90ZWN0ZWQob2xkLT5zaGFyZWRbaV0sCi0JCQkJCQkgIHJlc2VydmF0aW9uX29iamVjdF9oZWxk
KG9iaikpOworCQkJCQkJICBkbWFfcmVzdl9oZWxkKG9iaikpOwogCQlpZiAoZG1hX2ZlbmNlX2lz
X3NpZ25hbGVkKGZlbmNlKSkKIAkJCVJDVV9JTklUX1BPSU5URVIobmV3LT5zaGFyZWRbLS1rXSwg
ZmVuY2UpOwogCQllbHNlCkBAIC0xOTcsNDEgKzE5NSw0MCBAQCBpbnQgcmVzZXJ2YXRpb25fb2Jq
ZWN0X3Jlc2VydmVfc2hhcmVkKHN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKm9iaiwKIAkJc3Ry
dWN0IGRtYV9mZW5jZSAqZmVuY2U7CiAKIAkJZmVuY2UgPSByY3VfZGVyZWZlcmVuY2VfcHJvdGVj
dGVkKG5ldy0+c2hhcmVkW2ldLAotCQkJCQkJICByZXNlcnZhdGlvbl9vYmplY3RfaGVsZChvYmop
KTsKKwkJCQkJCSAgZG1hX3Jlc3ZfaGVsZChvYmopKTsKIAkJZG1hX2ZlbmNlX3B1dChmZW5jZSk7
CiAJfQogCWtmcmVlX3JjdShvbGQsIHJjdSk7CiAKIAlyZXR1cm4gMDsKIH0KLUVYUE9SVF9TWU1C
T0wocmVzZXJ2YXRpb25fb2JqZWN0X3Jlc2VydmVfc2hhcmVkKTsKK0VYUE9SVF9TWU1CT0woZG1h
X3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQpOwogCiAvKioKLSAqIHJlc2VydmF0aW9uX29iamVjdF9hZGRf
c2hhcmVkX2ZlbmNlIC0gQWRkIGEgZmVuY2UgdG8gYSBzaGFyZWQgc2xvdAorICogZG1hX3Jlc3Zf
YWRkX3NoYXJlZF9mZW5jZSAtIEFkZCBhIGZlbmNlIHRvIGEgc2hhcmVkIHNsb3QKICAqIEBvYmo6
IHRoZSByZXNlcnZhdGlvbiBvYmplY3QKICAqIEBmZW5jZTogdGhlIHNoYXJlZCBmZW5jZSB0byBh
ZGQKICAqCiAgKiBBZGQgYSBmZW5jZSB0byBhIHNoYXJlZCBzbG90LCBvYmotPmxvY2sgbXVzdCBi
ZSBoZWxkLCBhbmQKLSAqIHJlc2VydmF0aW9uX29iamVjdF9yZXNlcnZlX3NoYXJlZCgpIGhhcyBi
ZWVuIGNhbGxlZC4KKyAqIGRtYV9yZXN2X3Jlc2VydmVfc2hhcmVkKCkgaGFzIGJlZW4gY2FsbGVk
LgogICovCi12b2lkIHJlc2VydmF0aW9uX29iamVjdF9hZGRfc2hhcmVkX2ZlbmNlKHN0cnVjdCBy
ZXNlcnZhdGlvbl9vYmplY3QgKm9iaiwKLQkJCQkJIHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlKQor
dm9pZCBkbWFfcmVzdl9hZGRfc2hhcmVkX2ZlbmNlKHN0cnVjdCBkbWFfcmVzdiAqb2JqLCBzdHJ1
Y3QgZG1hX2ZlbmNlICpmZW5jZSkKIHsKLQlzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0X2xpc3Qg
KmZvYmo7CisJc3RydWN0IGRtYV9yZXN2X2xpc3QgKmZvYmo7CiAJc3RydWN0IGRtYV9mZW5jZSAq
b2xkOwogCXVuc2lnbmVkIGludCBpLCBjb3VudDsKIAogCWRtYV9mZW5jZV9nZXQoZmVuY2UpOwog
Ci0JcmVzZXJ2YXRpb25fb2JqZWN0X2Fzc2VydF9oZWxkKG9iaik7CisJZG1hX3Jlc3ZfYXNzZXJ0
X2hlbGQob2JqKTsKIAotCWZvYmogPSByZXNlcnZhdGlvbl9vYmplY3RfZ2V0X2xpc3Qob2JqKTsK
Kwlmb2JqID0gZG1hX3Jlc3ZfZ2V0X2xpc3Qob2JqKTsKIAljb3VudCA9IGZvYmotPnNoYXJlZF9j
b3VudDsKIAogCWZvciAoaSA9IDA7IGkgPCBjb3VudDsgKytpKSB7CiAKIAkJb2xkID0gcmN1X2Rl
cmVmZXJlbmNlX3Byb3RlY3RlZChmb2JqLT5zaGFyZWRbaV0sCi0JCQkJCQlyZXNlcnZhdGlvbl9v
YmplY3RfaGVsZChvYmopKTsKKwkJCQkJCWRtYV9yZXN2X2hlbGQob2JqKSk7CiAJCWlmIChvbGQt
PmNvbnRleHQgPT0gZmVuY2UtPmNvbnRleHQgfHwKIAkJICAgIGRtYV9mZW5jZV9pc19zaWduYWxl
ZChvbGQpKQogCQkJZ290byByZXBsYWNlOwpAQCAtMjQ3LDI1ICsyNDQsMjQgQEAgdm9pZCByZXNl
cnZhdGlvbl9vYmplY3RfYWRkX3NoYXJlZF9mZW5jZShzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0
ICpvYmosCiAJc21wX3N0b3JlX21iKGZvYmotPnNoYXJlZF9jb3VudCwgY291bnQpOwogCWRtYV9m
ZW5jZV9wdXQob2xkKTsKIH0KLUVYUE9SVF9TWU1CT0wocmVzZXJ2YXRpb25fb2JqZWN0X2FkZF9z
aGFyZWRfZmVuY2UpOworRVhQT1JUX1NZTUJPTChkbWFfcmVzdl9hZGRfc2hhcmVkX2ZlbmNlKTsK
IAogLyoqCi0gKiByZXNlcnZhdGlvbl9vYmplY3RfYWRkX2V4Y2xfZmVuY2UgLSBBZGQgYW4gZXhj
bHVzaXZlIGZlbmNlLgorICogZG1hX3Jlc3ZfYWRkX2V4Y2xfZmVuY2UgLSBBZGQgYW4gZXhjbHVz
aXZlIGZlbmNlLgogICogQG9iajogdGhlIHJlc2VydmF0aW9uIG9iamVjdAogICogQGZlbmNlOiB0
aGUgc2hhcmVkIGZlbmNlIHRvIGFkZAogICoKICAqIEFkZCBhIGZlbmNlIHRvIHRoZSBleGNsdXNp
dmUgc2xvdC4gIFRoZSBvYmotPmxvY2sgbXVzdCBiZSBoZWxkLgogICovCi12b2lkIHJlc2VydmF0
aW9uX29iamVjdF9hZGRfZXhjbF9mZW5jZShzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpvYmos
Ci0JCQkJICAgICAgIHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlKQordm9pZCBkbWFfcmVzdl9hZGRf
ZXhjbF9mZW5jZShzdHJ1Y3QgZG1hX3Jlc3YgKm9iaiwgc3RydWN0IGRtYV9mZW5jZSAqZmVuY2Up
CiB7Ci0Jc3RydWN0IGRtYV9mZW5jZSAqb2xkX2ZlbmNlID0gcmVzZXJ2YXRpb25fb2JqZWN0X2dl
dF9leGNsKG9iaik7Ci0Jc3RydWN0IHJlc2VydmF0aW9uX29iamVjdF9saXN0ICpvbGQ7CisJc3Ry
dWN0IGRtYV9mZW5jZSAqb2xkX2ZlbmNlID0gZG1hX3Jlc3ZfZ2V0X2V4Y2wob2JqKTsKKwlzdHJ1
Y3QgZG1hX3Jlc3ZfbGlzdCAqb2xkOwogCXUzMiBpID0gMDsKIAotCXJlc2VydmF0aW9uX29iamVj
dF9hc3NlcnRfaGVsZChvYmopOworCWRtYV9yZXN2X2Fzc2VydF9oZWxkKG9iaik7CiAKLQlvbGQg
PSByZXNlcnZhdGlvbl9vYmplY3RfZ2V0X2xpc3Qob2JqKTsKKwlvbGQgPSBkbWFfcmVzdl9nZXRf
bGlzdChvYmopOwogCWlmIChvbGQpCiAJCWkgPSBvbGQtPnNoYXJlZF9jb3VudDsKIApAQCAtMjgy
LDQxICsyNzgsNDAgQEAgdm9pZCByZXNlcnZhdGlvbl9vYmplY3RfYWRkX2V4Y2xfZmVuY2Uoc3Ry
dWN0IHJlc2VydmF0aW9uX29iamVjdCAqb2JqLAogCS8qIGlucGxhY2UgdXBkYXRlLCBubyBzaGFy
ZWQgZmVuY2VzICovCiAJd2hpbGUgKGktLSkKIAkJZG1hX2ZlbmNlX3B1dChyY3VfZGVyZWZlcmVu
Y2VfcHJvdGVjdGVkKG9sZC0+c2hhcmVkW2ldLAotCQkJCQkJcmVzZXJ2YXRpb25fb2JqZWN0X2hl
bGQob2JqKSkpOworCQkJCQkJZG1hX3Jlc3ZfaGVsZChvYmopKSk7CiAKIAlkbWFfZmVuY2VfcHV0
KG9sZF9mZW5jZSk7CiB9Ci1FWFBPUlRfU1lNQk9MKHJlc2VydmF0aW9uX29iamVjdF9hZGRfZXhj
bF9mZW5jZSk7CitFWFBPUlRfU1lNQk9MKGRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlKTsKIAogLyoq
Ci0qIHJlc2VydmF0aW9uX29iamVjdF9jb3B5X2ZlbmNlcyAtIENvcHkgYWxsIGZlbmNlcyBmcm9t
IHNyYyB0byBkc3QuCisqIGRtYV9yZXN2X2NvcHlfZmVuY2VzIC0gQ29weSBhbGwgZmVuY2VzIGZy
b20gc3JjIHRvIGRzdC4KICogQGRzdDogdGhlIGRlc3RpbmF0aW9uIHJlc2VydmF0aW9uIG9iamVj
dAogKiBAc3JjOiB0aGUgc291cmNlIHJlc2VydmF0aW9uIG9iamVjdAogKgogKiBDb3B5IGFsbCBm
ZW5jZXMgZnJvbSBzcmMgdG8gZHN0LiBkc3QtbG9jayBtdXN0IGJlIGhlbGQuCiAqLwotaW50IHJl
c2VydmF0aW9uX29iamVjdF9jb3B5X2ZlbmNlcyhzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpk
c3QsCi0JCQkJICAgc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqc3JjKQoraW50IGRtYV9yZXN2
X2NvcHlfZmVuY2VzKHN0cnVjdCBkbWFfcmVzdiAqZHN0LCBzdHJ1Y3QgZG1hX3Jlc3YgKnNyYykK
IHsKLQlzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0X2xpc3QgKnNyY19saXN0LCAqZHN0X2xpc3Q7
CisJc3RydWN0IGRtYV9yZXN2X2xpc3QgKnNyY19saXN0LCAqZHN0X2xpc3Q7CiAJc3RydWN0IGRt
YV9mZW5jZSAqb2xkLCAqbmV3OwogCXVuc2lnbmVkIGludCBpLCBzaGFyZWRfY291bnQ7CiAKLQly
ZXNlcnZhdGlvbl9vYmplY3RfYXNzZXJ0X2hlbGQoZHN0KTsKKwlkbWFfcmVzdl9hc3NlcnRfaGVs
ZChkc3QpOwogCiAJcmN1X3JlYWRfbG9jaygpOwogCiByZXRyeToKLQlyZXNlcnZhdGlvbl9vYmpl
Y3RfZmVuY2VzKHNyYywgJm5ldywgJnNyY19saXN0LCAmc2hhcmVkX2NvdW50KTsKKwlkbWFfcmVz
dl9mZW5jZXMoc3JjLCAmbmV3LCAmc3JjX2xpc3QsICZzaGFyZWRfY291bnQpOwogCWlmIChzaGFy
ZWRfY291bnQpIHsKIAkJcmN1X3JlYWRfdW5sb2NrKCk7CiAKLQkJZHN0X2xpc3QgPSByZXNlcnZh
dGlvbl9vYmplY3RfbGlzdF9hbGxvYyhzaGFyZWRfY291bnQpOworCQlkc3RfbGlzdCA9IGRtYV9y
ZXN2X2xpc3RfYWxsb2Moc2hhcmVkX2NvdW50KTsKIAkJaWYgKCFkc3RfbGlzdCkKIAkJCXJldHVy
biAtRU5PTUVNOwogCiAJCXJjdV9yZWFkX2xvY2soKTsKLQkJcmVzZXJ2YXRpb25fb2JqZWN0X2Zl
bmNlcyhzcmMsICZuZXcsICZzcmNfbGlzdCwgJnNoYXJlZF9jb3VudCk7CisJCWRtYV9yZXN2X2Zl
bmNlcyhzcmMsICZuZXcsICZzcmNfbGlzdCwgJnNoYXJlZF9jb3VudCk7CiAJCWlmICghc3JjX2xp
c3QgfHwgc2hhcmVkX2NvdW50ID4gZHN0X2xpc3QtPnNoYXJlZF9tYXgpIHsKIAkJCWtmcmVlKGRz
dF9saXN0KTsKIAkJCWdvdG8gcmV0cnk7CkBAIC0zMzIsNyArMzI3LDcgQEAgaW50IHJlc2VydmF0
aW9uX29iamVjdF9jb3B5X2ZlbmNlcyhzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpkc3QsCiAJ
CQkJY29udGludWU7CiAKIAkJCWlmICghZG1hX2ZlbmNlX2dldF9yY3UoZmVuY2UpKSB7Ci0JCQkJ
cmVzZXJ2YXRpb25fb2JqZWN0X2xpc3RfZnJlZShkc3RfbGlzdCk7CisJCQkJZG1hX3Jlc3ZfbGlz
dF9mcmVlKGRzdF9saXN0KTsKIAkJCQlnb3RvIHJldHJ5OwogCQkJfQogCkBAIC0zNDgsMjggKzM0
MywyOCBAQCBpbnQgcmVzZXJ2YXRpb25fb2JqZWN0X2NvcHlfZmVuY2VzKHN0cnVjdCByZXNlcnZh
dGlvbl9vYmplY3QgKmRzdCwKIAl9CiAKIAlpZiAobmV3ICYmICFkbWFfZmVuY2VfZ2V0X3JjdShu
ZXcpKSB7Ci0JCXJlc2VydmF0aW9uX29iamVjdF9saXN0X2ZyZWUoZHN0X2xpc3QpOworCQlkbWFf
cmVzdl9saXN0X2ZyZWUoZHN0X2xpc3QpOwogCQlnb3RvIHJldHJ5OwogCX0KIAlyY3VfcmVhZF91
bmxvY2soKTsKIAotCXNyY19saXN0ID0gcmVzZXJ2YXRpb25fb2JqZWN0X2dldF9saXN0KGRzdCk7
Ci0Jb2xkID0gcmVzZXJ2YXRpb25fb2JqZWN0X2dldF9leGNsKGRzdCk7CisJc3JjX2xpc3QgPSBk
bWFfcmVzdl9nZXRfbGlzdChkc3QpOworCW9sZCA9IGRtYV9yZXN2X2dldF9leGNsKGRzdCk7CiAK
IAlwcmVlbXB0X2Rpc2FibGUoKTsKIAlyY3VfYXNzaWduX3BvaW50ZXIoZHN0LT5mZW5jZV9leGNs
LCBuZXcpOwogCXJjdV9hc3NpZ25fcG9pbnRlcihkc3QtPmZlbmNlLCBkc3RfbGlzdCk7CiAJcHJl
ZW1wdF9lbmFibGUoKTsKIAotCXJlc2VydmF0aW9uX29iamVjdF9saXN0X2ZyZWUoc3JjX2xpc3Qp
OworCWRtYV9yZXN2X2xpc3RfZnJlZShzcmNfbGlzdCk7CiAJZG1hX2ZlbmNlX3B1dChvbGQpOwog
CiAJcmV0dXJuIDA7CiB9Ci1FWFBPUlRfU1lNQk9MKHJlc2VydmF0aW9uX29iamVjdF9jb3B5X2Zl
bmNlcyk7CitFWFBPUlRfU1lNQk9MKGRtYV9yZXN2X2NvcHlfZmVuY2VzKTsKIAogLyoqCi0gKiBy
ZXNlcnZhdGlvbl9vYmplY3RfZ2V0X2ZlbmNlc19yY3UgLSBHZXQgYW4gb2JqZWN0J3Mgc2hhcmVk
IGFuZCBleGNsdXNpdmUKKyAqIGRtYV9yZXN2X2dldF9mZW5jZXNfcmN1IC0gR2V0IGFuIG9iamVj
dCdzIHNoYXJlZCBhbmQgZXhjbHVzaXZlCiAgKiBmZW5jZXMgd2l0aG91dCB1cGRhdGUgc2lkZSBs
b2NrIGhlbGQKICAqIEBvYmo6IHRoZSByZXNlcnZhdGlvbiBvYmplY3QKICAqIEBwZmVuY2VfZXhj
bDogdGhlIHJldHVybmVkIGV4Y2x1c2l2ZSBmZW5jZSAob3IgTlVMTCkKQEAgLTM4MSwxMCArMzc2
LDEwIEBAIEVYUE9SVF9TWU1CT0wocmVzZXJ2YXRpb25fb2JqZWN0X2NvcHlfZmVuY2VzKTsKICAq
IGV4Y2x1c2l2ZSBmZW5jZSBpcyBub3Qgc3BlY2lmaWVkIHRoZSBmZW5jZSBpcyBwdXQgaW50byB0
aGUgYXJyYXkgb2YgdGhlCiAgKiBzaGFyZWQgZmVuY2VzIGFzIHdlbGwuIFJldHVybnMgZWl0aGVy
IHplcm8gb3IgLUVOT01FTS4KICAqLwotaW50IHJlc2VydmF0aW9uX29iamVjdF9nZXRfZmVuY2Vz
X3JjdShzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpvYmosCi0JCQkJICAgICAgc3RydWN0IGRt
YV9mZW5jZSAqKnBmZW5jZV9leGNsLAotCQkJCSAgICAgIHVuc2lnbmVkICpwc2hhcmVkX2NvdW50
LAotCQkJCSAgICAgIHN0cnVjdCBkbWFfZmVuY2UgKioqcHNoYXJlZCkKK2ludCBkbWFfcmVzdl9n
ZXRfZmVuY2VzX3JjdShzdHJ1Y3QgZG1hX3Jlc3YgKm9iaiwKKwkJCSAgICBzdHJ1Y3QgZG1hX2Zl
bmNlICoqcGZlbmNlX2V4Y2wsCisJCQkgICAgdW5zaWduZWQgKnBzaGFyZWRfY291bnQsCisJCQkg
ICAgc3RydWN0IGRtYV9mZW5jZSAqKipwc2hhcmVkKQogewogCXN0cnVjdCBkbWFfZmVuY2UgKipz
aGFyZWQgPSBOVUxMOwogCXN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlX2V4Y2w7CkBAIC0zOTIsMTQg
KzM4NywxNCBAQCBpbnQgcmVzZXJ2YXRpb25fb2JqZWN0X2dldF9mZW5jZXNfcmN1KHN0cnVjdCBy
ZXNlcnZhdGlvbl9vYmplY3QgKm9iaiwKIAlpbnQgcmV0ID0gMTsKIAogCWRvIHsKLQkJc3RydWN0
IHJlc2VydmF0aW9uX29iamVjdF9saXN0ICpmb2JqOworCQlzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCAq
Zm9iajsKIAkJdW5zaWduZWQgaW50IGk7CiAJCXNpemVfdCBzeiA9IDA7CiAKIAkJaSA9IDA7CiAK
IAkJcmN1X3JlYWRfbG9jaygpOwotCQlyZXNlcnZhdGlvbl9vYmplY3RfZmVuY2VzKG9iaiwgJmZl
bmNlX2V4Y2wsICZmb2JqLAorCQlkbWFfcmVzdl9mZW5jZXMob2JqLCAmZmVuY2VfZXhjbCwgJmZv
YmosCiAJCQkJCSAgJnNoYXJlZF9jb3VudCk7CiAKIAkJaWYgKGZlbmNlX2V4Y2wgJiYgIWRtYV9m
ZW5jZV9nZXRfcmN1KGZlbmNlX2V4Y2wpKQpAQCAtNDY1LDEwICs0NjAsMTAgQEAgaW50IHJlc2Vy
dmF0aW9uX29iamVjdF9nZXRfZmVuY2VzX3JjdShzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpv
YmosCiAJKnBzaGFyZWQgPSBzaGFyZWQ7CiAJcmV0dXJuIHJldDsKIH0KLUVYUE9SVF9TWU1CT0xf
R1BMKHJlc2VydmF0aW9uX29iamVjdF9nZXRfZmVuY2VzX3JjdSk7CitFWFBPUlRfU1lNQk9MX0dQ
TChkbWFfcmVzdl9nZXRfZmVuY2VzX3JjdSk7CiAKIC8qKgotICogcmVzZXJ2YXRpb25fb2JqZWN0
X3dhaXRfdGltZW91dF9yY3UgLSBXYWl0IG9uIHJlc2VydmF0aW9uJ3Mgb2JqZWN0cworICogZG1h
X3Jlc3Zfd2FpdF90aW1lb3V0X3JjdSAtIFdhaXQgb24gcmVzZXJ2YXRpb24ncyBvYmplY3RzCiAg
KiBzaGFyZWQgYW5kL29yIGV4Y2x1c2l2ZSBmZW5jZXMuCiAgKiBAb2JqOiB0aGUgcmVzZXJ2YXRp
b24gb2JqZWN0CiAgKiBAd2FpdF9hbGw6IGlmIHRydWUsIHdhaXQgb24gYWxsIGZlbmNlcywgZWxz
ZSB3YWl0IG9uIGp1c3QgZXhjbHVzaXZlIGZlbmNlCkBAIC00NzksMTEgKzQ3NCwxMSBAQCBFWFBP
UlRfU1lNQk9MX0dQTChyZXNlcnZhdGlvbl9vYmplY3RfZ2V0X2ZlbmNlc19yY3UpOwogICogUmV0
dXJucyAtRVJFU1RBUlRTWVMgaWYgaW50ZXJydXB0ZWQsIDAgaWYgdGhlIHdhaXQgdGltZWQgb3V0
LCBvcgogICogZ3JlYXRlciB0aGFuIHplciBvbiBzdWNjZXNzLgogICovCi1sb25nIHJlc2VydmF0
aW9uX29iamVjdF93YWl0X3RpbWVvdXRfcmN1KHN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKm9i
aiwKLQkJCQkJIGJvb2wgd2FpdF9hbGwsIGJvb2wgaW50ciwKLQkJCQkJIHVuc2lnbmVkIGxvbmcg
dGltZW91dCkKK2xvbmcgZG1hX3Jlc3Zfd2FpdF90aW1lb3V0X3JjdShzdHJ1Y3QgZG1hX3Jlc3Yg
Km9iaiwKKwkJCSAgICAgICBib29sIHdhaXRfYWxsLCBib29sIGludHIsCisJCQkgICAgICAgdW5z
aWduZWQgbG9uZyB0aW1lb3V0KQogewotCXN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3RfbGlzdCAq
Zm9iajsKKwlzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCAqZm9iajsKIAlzdHJ1Y3QgZG1hX2ZlbmNlICpm
ZW5jZTsKIAl1bnNpZ25lZCBzaGFyZWRfY291bnQ7CiAJbG9uZyByZXQgPSB0aW1lb3V0ID8gdGlt
ZW91dCA6IDE7CkBAIC00OTMsNyArNDg4LDcgQEAgbG9uZyByZXNlcnZhdGlvbl9vYmplY3Rfd2Fp
dF90aW1lb3V0X3JjdShzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpvYmosCiAJcmN1X3JlYWRf
bG9jaygpOwogCWkgPSAtMTsKIAotCXJlc2VydmF0aW9uX29iamVjdF9mZW5jZXMob2JqLCAmZmVu
Y2UsICZmb2JqLCAmc2hhcmVkX2NvdW50KTsKKwlkbWFfcmVzdl9mZW5jZXMob2JqLCAmZmVuY2Us
ICZmb2JqLCAmc2hhcmVkX2NvdW50KTsKIAlpZiAoZmVuY2UgJiYgIXRlc3RfYml0KERNQV9GRU5D
RV9GTEFHX1NJR05BTEVEX0JJVCwgJmZlbmNlLT5mbGFncykpIHsKIAkJaWYgKCFkbWFfZmVuY2Vf
Z2V0X3JjdShmZW5jZSkpCiAJCQlnb3RvIHVubG9ja19yZXRyeTsKQEAgLTU0MSwxMSArNTM2LDEw
IEBAIGxvbmcgcmVzZXJ2YXRpb25fb2JqZWN0X3dhaXRfdGltZW91dF9yY3Uoc3RydWN0IHJlc2Vy
dmF0aW9uX29iamVjdCAqb2JqLAogCXJjdV9yZWFkX3VubG9jaygpOwogCWdvdG8gcmV0cnk7CiB9
Ci1FWFBPUlRfU1lNQk9MX0dQTChyZXNlcnZhdGlvbl9vYmplY3Rfd2FpdF90aW1lb3V0X3JjdSk7
CitFWFBPUlRfU1lNQk9MX0dQTChkbWFfcmVzdl93YWl0X3RpbWVvdXRfcmN1KTsKIAogCi1zdGF0
aWMgaW5saW5lIGludAotcmVzZXJ2YXRpb25fb2JqZWN0X3Rlc3Rfc2lnbmFsZWRfc2luZ2xlKHN0
cnVjdCBkbWFfZmVuY2UgKnBhc3NlZF9mZW5jZSkKK3N0YXRpYyBpbmxpbmUgaW50IGRtYV9yZXN2
X3Rlc3Rfc2lnbmFsZWRfc2luZ2xlKHN0cnVjdCBkbWFfZmVuY2UgKnBhc3NlZF9mZW5jZSkKIHsK
IAlzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSwgKmxmZW5jZSA9IHBhc3NlZF9mZW5jZTsKIAlpbnQg
cmV0ID0gMTsKQEAgLTU2Miw3ICs1NTYsNyBAQCByZXNlcnZhdGlvbl9vYmplY3RfdGVzdF9zaWdu
YWxlZF9zaW5nbGUoc3RydWN0IGRtYV9mZW5jZSAqcGFzc2VkX2ZlbmNlKQogfQogCiAvKioKLSAq
IHJlc2VydmF0aW9uX29iamVjdF90ZXN0X3NpZ25hbGVkX3JjdSAtIFRlc3QgaWYgYSByZXNlcnZh
dGlvbiBvYmplY3QncworICogZG1hX3Jlc3ZfdGVzdF9zaWduYWxlZF9yY3UgLSBUZXN0IGlmIGEg
cmVzZXJ2YXRpb24gb2JqZWN0J3MKICAqIGZlbmNlcyBoYXZlIGJlZW4gc2lnbmFsZWQuCiAgKiBA
b2JqOiB0aGUgcmVzZXJ2YXRpb24gb2JqZWN0CiAgKiBAdGVzdF9hbGw6IGlmIHRydWUsIHRlc3Qg
YWxsIGZlbmNlcywgb3RoZXJ3aXNlIG9ubHkgdGVzdCB0aGUgZXhjbHVzaXZlCkBAIC01NzEsMTAg
KzU2NSw5IEBAIHJlc2VydmF0aW9uX29iamVjdF90ZXN0X3NpZ25hbGVkX3NpbmdsZShzdHJ1Y3Qg
ZG1hX2ZlbmNlICpwYXNzZWRfZmVuY2UpCiAgKiBSRVRVUk5TCiAgKiB0cnVlIGlmIGFsbCBmZW5j
ZXMgc2lnbmFsZWQsIGVsc2UgZmFsc2UKICAqLwotYm9vbCByZXNlcnZhdGlvbl9vYmplY3RfdGVz
dF9zaWduYWxlZF9yY3Uoc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqb2JqLAotCQkJCQkgIGJv
b2wgdGVzdF9hbGwpCitib29sIGRtYV9yZXN2X3Rlc3Rfc2lnbmFsZWRfcmN1KHN0cnVjdCBkbWFf
cmVzdiAqb2JqLCBib29sIHRlc3RfYWxsKQogewotCXN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3Rf
bGlzdCAqZm9iajsKKwlzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCAqZm9iajsKIAlzdHJ1Y3QgZG1hX2Zl
bmNlICpmZW5jZV9leGNsOwogCXVuc2lnbmVkIHNoYXJlZF9jb3VudDsKIAlpbnQgcmV0OwpAQCAt
NTgzLDE0ICs1NzYsMTQgQEAgYm9vbCByZXNlcnZhdGlvbl9vYmplY3RfdGVzdF9zaWduYWxlZF9y
Y3Uoc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqb2JqLAogcmV0cnk6CiAJcmV0ID0gdHJ1ZTsK
IAotCXJlc2VydmF0aW9uX29iamVjdF9mZW5jZXMob2JqLCAmZmVuY2VfZXhjbCwgJmZvYmosICZz
aGFyZWRfY291bnQpOworCWRtYV9yZXN2X2ZlbmNlcyhvYmosICZmZW5jZV9leGNsLCAmZm9iaiwg
JnNoYXJlZF9jb3VudCk7CiAJaWYgKHRlc3RfYWxsKSB7CiAJCXVuc2lnbmVkIGk7CiAKIAkJZm9y
IChpID0gMDsgaSA8IHNoYXJlZF9jb3VudDsgKytpKSB7CiAJCQlzdHJ1Y3QgZG1hX2ZlbmNlICpm
ZW5jZSA9IHJjdV9kZXJlZmVyZW5jZShmb2JqLT5zaGFyZWRbaV0pOwogCi0JCQlyZXQgPSByZXNl
cnZhdGlvbl9vYmplY3RfdGVzdF9zaWduYWxlZF9zaW5nbGUoZmVuY2UpOworCQkJcmV0ID0gZG1h
X3Jlc3ZfdGVzdF9zaWduYWxlZF9zaW5nbGUoZmVuY2UpOwogCQkJaWYgKHJldCA8IDApCiAJCQkJ
Z290byByZXRyeTsKIAkJCWVsc2UgaWYgKCFyZXQpCkBAIC01OTksNyArNTkyLDcgQEAgYm9vbCBy
ZXNlcnZhdGlvbl9vYmplY3RfdGVzdF9zaWduYWxlZF9yY3Uoc3RydWN0IHJlc2VydmF0aW9uX29i
amVjdCAqb2JqLAogCX0KIAogCWlmICghc2hhcmVkX2NvdW50ICYmIGZlbmNlX2V4Y2wpIHsKLQkJ
cmV0ID0gcmVzZXJ2YXRpb25fb2JqZWN0X3Rlc3Rfc2lnbmFsZWRfc2luZ2xlKGZlbmNlX2V4Y2wp
OworCQlyZXQgPSBkbWFfcmVzdl90ZXN0X3NpZ25hbGVkX3NpbmdsZShmZW5jZV9leGNsKTsKIAkJ
aWYgKHJldCA8IDApCiAJCQlnb3RvIHJldHJ5OwogCX0KQEAgLTYwNyw0ICs2MDAsNCBAQCBib29s
IHJlc2VydmF0aW9uX29iamVjdF90ZXN0X3NpZ25hbGVkX3JjdShzdHJ1Y3QgcmVzZXJ2YXRpb25f
b2JqZWN0ICpvYmosCiAJcmN1X3JlYWRfdW5sb2NrKCk7CiAJcmV0dXJuIHJldDsKIH0KLUVYUE9S
VF9TWU1CT0xfR1BMKHJlc2VydmF0aW9uX29iamVjdF90ZXN0X3NpZ25hbGVkX3JjdSk7CitFWFBP
UlRfU1lNQk9MX0dQTChkbWFfcmVzdl90ZXN0X3NpZ25hbGVkX3JjdSk7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dwdXZtLmMgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dwdXZtLmMKaW5kZXggYTQ2NDBkZGMy
NGQxLi5iYzRlYzZiMjBhODcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdV9hbWRrZmRfZ3B1dm0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9h
bWRncHVfYW1ka2ZkX2dwdXZtLmMKQEAgLTIxOCwxNCArMjE4LDE0IEBAIHZvaWQgYW1kZ3B1X2Ft
ZGtmZF91bnJlc2VydmVfbWVtb3J5X2xpbWl0KHN0cnVjdCBhbWRncHVfYm8gKmJvKQogc3RhdGlj
IGludCBhbWRncHVfYW1ka2ZkX3JlbW92ZV9ldmljdGlvbl9mZW5jZShzdHJ1Y3QgYW1kZ3B1X2Jv
ICpibywKIAkJCQkJc3RydWN0IGFtZGdwdV9hbWRrZmRfZmVuY2UgKmVmKQogewotCXN0cnVjdCBy
ZXNlcnZhdGlvbl9vYmplY3QgKnJlc3YgPSBiby0+dGJvLmJhc2UucmVzdjsKLQlzdHJ1Y3QgcmVz
ZXJ2YXRpb25fb2JqZWN0X2xpc3QgKm9sZCwgKm5ldzsKKwlzdHJ1Y3QgZG1hX3Jlc3YgKnJlc3Yg
PSBiby0+dGJvLmJhc2UucmVzdjsKKwlzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCAqb2xkLCAqbmV3Owog
CXVuc2lnbmVkIGludCBpLCBqLCBrOwogCiAJaWYgKCFlZikKIAkJcmV0dXJuIC1FSU5WQUw7CiAK
LQlvbGQgPSByZXNlcnZhdGlvbl9vYmplY3RfZ2V0X2xpc3QocmVzdik7CisJb2xkID0gZG1hX3Jl
c3ZfZ2V0X2xpc3QocmVzdik7CiAJaWYgKCFvbGQpCiAJCXJldHVybiAwOwogCkBAIC0yNDEsNyAr
MjQxLDcgQEAgc3RhdGljIGludCBhbWRncHVfYW1ka2ZkX3JlbW92ZV9ldmljdGlvbl9mZW5jZShz
dHJ1Y3QgYW1kZ3B1X2JvICpibywKIAkJc3RydWN0IGRtYV9mZW5jZSAqZjsKIAogCQlmID0gcmN1
X2RlcmVmZXJlbmNlX3Byb3RlY3RlZChvbGQtPnNoYXJlZFtpXSwKLQkJCQkJICAgICAgcmVzZXJ2
YXRpb25fb2JqZWN0X2hlbGQocmVzdikpOworCQkJCQkgICAgICBkbWFfcmVzdl9oZWxkKHJlc3Yp
KTsKIAogCQlpZiAoZi0+Y29udGV4dCA9PSBlZi0+YmFzZS5jb250ZXh0KQogCQkJUkNVX0lOSVRf
UE9JTlRFUihuZXctPnNoYXJlZFstLWpdLCBmKTsKQEAgLTI1OCw3ICsyNTgsNyBAQCBzdGF0aWMg
aW50IGFtZGdwdV9hbWRrZmRfcmVtb3ZlX2V2aWN0aW9uX2ZlbmNlKHN0cnVjdCBhbWRncHVfYm8g
KmJvLAogCQlzdHJ1Y3QgZG1hX2ZlbmNlICpmOwogCiAJCWYgPSByY3VfZGVyZWZlcmVuY2VfcHJv
dGVjdGVkKG5ldy0+c2hhcmVkW2ldLAotCQkJCQkgICAgICByZXNlcnZhdGlvbl9vYmplY3RfaGVs
ZChyZXN2KSk7CisJCQkJCSAgICAgIGRtYV9yZXN2X2hlbGQocmVzdikpOwogCQlkbWFfZmVuY2Vf
cHV0KGYpOwogCX0KIAlrZnJlZV9yY3Uob2xkLCByY3UpOwpAQCAtODgyLDcgKzg4Miw3IEBAIHN0
YXRpYyBpbnQgaW5pdF9rZmRfdm0oc3RydWN0IGFtZGdwdV92bSAqdm0sIHZvaWQgKipwcm9jZXNz
X2luZm8sCiAJCQkJICBBTURHUFVfRkVOQ0VfT1dORVJfS0ZELCBmYWxzZSk7CiAJaWYgKHJldCkK
IAkJZ290byB3YWl0X3BkX2ZhaWw7Ci0JcmV0ID0gcmVzZXJ2YXRpb25fb2JqZWN0X3Jlc2VydmVf
c2hhcmVkKHZtLT5yb290LmJhc2UuYm8tPnRiby5iYXNlLnJlc3YsIDEpOworCXJldCA9IGRtYV9y
ZXN2X3Jlc2VydmVfc2hhcmVkKHZtLT5yb290LmJhc2UuYm8tPnRiby5iYXNlLnJlc3YsIDEpOwog
CWlmIChyZXQpCiAJCWdvdG8gcmVzZXJ2ZV9zaGFyZWRfZmFpbDsKIAlhbWRncHVfYm9fZmVuY2Uo
dm0tPnJvb3QuYmFzZS5ibywKQEAgLTIxMjcsNyArMjEyNyw3IEBAIGludCBhbWRncHVfYW1ka2Zk
X2FkZF9nd3NfdG9fcHJvY2Vzcyh2b2lkICppbmZvLCB2b2lkICpnd3MsIHN0cnVjdCBrZ2RfbWVt
ICoqbWVtCiAJICogQWRkIHByb2Nlc3MgZXZpY3Rpb24gZmVuY2UgdG8gYm8gc28gdGhleSBjYW4K
IAkgKiBldmljdCBlYWNoIG90aGVyLgogCSAqLwotCXJldCA9IHJlc2VydmF0aW9uX29iamVjdF9y
ZXNlcnZlX3NoYXJlZChnd3NfYm8tPnRiby5iYXNlLnJlc3YsIDEpOworCXJldCA9IGRtYV9yZXN2
X3Jlc2VydmVfc2hhcmVkKGd3c19iby0+dGJvLmJhc2UucmVzdiwgMSk7CiAJaWYgKHJldCkKIAkJ
Z290byByZXNlcnZlX3NoYXJlZF9mYWlsOwogCWFtZGdwdV9ib19mZW5jZShnd3NfYm8sICZwcm9j
ZXNzX2luZm8tPmV2aWN0aW9uX2ZlbmNlLT5iYXNlLCB0cnVlKTsKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9jcy5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X2NzLmMKaW5kZXggZTc0OGNkMjg0NzgwLi4yMjIzNmQzNjdlMjYgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9jcy5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9jcy5jCkBAIC03MzAsNyArNzMwLDcgQEAgc3Rh
dGljIGludCBhbWRncHVfY3Nfc3luY19yaW5ncyhzdHJ1Y3QgYW1kZ3B1X2NzX3BhcnNlciAqcCkK
IAogCWxpc3RfZm9yX2VhY2hfZW50cnkoZSwgJnAtPnZhbGlkYXRlZCwgdHYuaGVhZCkgewogCQlz
dHJ1Y3QgYW1kZ3B1X2JvICpibyA9IHR0bV90b19hbWRncHVfYm8oZS0+dHYuYm8pOwotCQlzdHJ1
Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyZXN2ID0gYm8tPnRiby5iYXNlLnJlc3Y7CisJCXN0cnVj
dCBkbWFfcmVzdiAqcmVzdiA9IGJvLT50Ym8uYmFzZS5yZXN2OwogCiAJCXIgPSBhbWRncHVfc3lu
Y19yZXN2KHAtPmFkZXYsICZwLT5qb2ItPnN5bmMsIHJlc3YsIHAtPmZpbHAsCiAJCQkJICAgICBh
bWRncHVfYm9fZXhwbGljaXRfc3luYyhibykpOwpAQCAtMTcyOSw3ICsxNzI5LDcgQEAgaW50IGFt
ZGdwdV9jc19maW5kX21hcHBpbmcoc3RydWN0IGFtZGdwdV9jc19wYXJzZXIgKnBhcnNlciwKIAkq
bWFwID0gbWFwcGluZzsKIAogCS8qIERvdWJsZSBjaGVjayB0aGF0IHRoZSBCTyBpcyByZXNlcnZl
ZCBieSB0aGlzIENTICovCi0JaWYgKHJlc2VydmF0aW9uX29iamVjdF9sb2NraW5nX2N0eCgoKmJv
KS0+dGJvLmJhc2UucmVzdikgIT0gJnBhcnNlci0+dGlja2V0KQorCWlmIChkbWFfcmVzdl9sb2Nr
aW5nX2N0eCgoKmJvKS0+dGJvLmJhc2UucmVzdikgIT0gJnBhcnNlci0+dGlja2V0KQogCQlyZXR1
cm4gLUVJTlZBTDsKIAogCWlmICghKCgqYm8pLT5mbGFncyAmIEFNREdQVV9HRU1fQ1JFQVRFX1ZS
QU1fQ09OVElHVU9VUykpIHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdV9kaXNwbGF5LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZGlz
cGxheS5jCmluZGV4IGI1ZDAyMGUxNWMzNS4uOGE0OGNiNWI1ODc1IDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZGlzcGxheS5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kaXNwbGF5LmMKQEAgLTIwNCw3ICsyMDQsNyBAQCBpbnQg
YW1kZ3B1X2Rpc3BsYXlfY3J0Y19wYWdlX2ZsaXBfdGFyZ2V0KHN0cnVjdCBkcm1fY3J0YyAqY3J0
YywKIAkJZ290byB1bnBpbjsKIAl9CiAKLQlyID0gcmVzZXJ2YXRpb25fb2JqZWN0X2dldF9mZW5j
ZXNfcmN1KG5ld19hYm8tPnRiby5iYXNlLnJlc3YsICZ3b3JrLT5leGNsLAorCXIgPSBkbWFfcmVz
dl9nZXRfZmVuY2VzX3JjdShuZXdfYWJvLT50Ym8uYmFzZS5yZXN2LCAmd29yay0+ZXhjbCwKIAkJ
CQkJICAgICAgJndvcmstPnNoYXJlZF9jb3VudCwKIAkJCQkJICAgICAgJndvcmstPnNoYXJlZCk7
CiAJaWYgKHVubGlrZWx5KHIgIT0gMCkpIHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2FtZGdwdV9kbWFfYnVmLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9h
bWRncHVfZG1hX2J1Zi5jCmluZGV4IGI4OGUyN2RhN2MyOC4uYmYwZjAwNTA4OTg3IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZG1hX2J1Zi5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kbWFfYnVmLmMKQEAgLTEzNywyMyArMTM3
LDIzIEBAIGludCBhbWRncHVfZ2VtX3ByaW1lX21tYXAoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpv
YmosCiB9CiAKIHN0YXRpYyBpbnQKLV9fcmVzZXJ2YXRpb25fb2JqZWN0X21ha2VfZXhjbHVzaXZl
KHN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKm9iaikKK19fZG1hX3Jlc3ZfbWFrZV9leGNsdXNp
dmUoc3RydWN0IGRtYV9yZXN2ICpvYmopCiB7CiAJc3RydWN0IGRtYV9mZW5jZSAqKmZlbmNlczsK
IAl1bnNpZ25lZCBpbnQgY291bnQ7CiAJaW50IHI7CiAKLQlpZiAoIXJlc2VydmF0aW9uX29iamVj
dF9nZXRfbGlzdChvYmopKSAvKiBubyBzaGFyZWQgZmVuY2VzIHRvIGNvbnZlcnQgKi8KKwlpZiAo
IWRtYV9yZXN2X2dldF9saXN0KG9iaikpIC8qIG5vIHNoYXJlZCBmZW5jZXMgdG8gY29udmVydCAq
LwogCQlyZXR1cm4gMDsKIAotCXIgPSByZXNlcnZhdGlvbl9vYmplY3RfZ2V0X2ZlbmNlc19yY3Uo
b2JqLCBOVUxMLCAmY291bnQsICZmZW5jZXMpOworCXIgPSBkbWFfcmVzdl9nZXRfZmVuY2VzX3Jj
dShvYmosIE5VTEwsICZjb3VudCwgJmZlbmNlcyk7CiAJaWYgKHIpCiAJCXJldHVybiByOwogCiAJ
aWYgKGNvdW50ID09IDApIHsKIAkJLyogTm93IHRoYXQgd2FzIHVuZXhwZWN0ZWQuICovCiAJfSBl
bHNlIGlmIChjb3VudCA9PSAxKSB7Ci0JCXJlc2VydmF0aW9uX29iamVjdF9hZGRfZXhjbF9mZW5j
ZShvYmosIGZlbmNlc1swXSk7CisJCWRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlKG9iaiwgZmVuY2Vz
WzBdKTsKIAkJZG1hX2ZlbmNlX3B1dChmZW5jZXNbMF0pOwogCQlrZnJlZShmZW5jZXMpOwogCX0g
ZWxzZSB7CkBAIC0xNjUsNyArMTY1LDcgQEAgX19yZXNlcnZhdGlvbl9vYmplY3RfbWFrZV9leGNs
dXNpdmUoc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqb2JqKQogCQlpZiAoIWFycmF5KQogCQkJ
Z290byBlcnJfZmVuY2VzX3B1dDsKIAotCQlyZXNlcnZhdGlvbl9vYmplY3RfYWRkX2V4Y2xfZmVu
Y2Uob2JqLCAmYXJyYXktPmJhc2UpOworCQlkbWFfcmVzdl9hZGRfZXhjbF9mZW5jZShvYmosICZh
cnJheS0+YmFzZSk7CiAJCWRtYV9mZW5jZV9wdXQoJmFycmF5LT5iYXNlKTsKIAl9CiAKQEAgLTIx
Niw3ICsyMTYsNyBAQCBzdGF0aWMgaW50IGFtZGdwdV9kbWFfYnVmX21hcF9hdHRhY2goc3RydWN0
IGRtYV9idWYgKmRtYV9idWYsCiAJCSAqIGZlbmNlcyBvbiB0aGUgcmVzZXJ2YXRpb24gb2JqZWN0
IGludG8gYSBzaW5nbGUgZXhjbHVzaXZlCiAJCSAqIGZlbmNlLgogCQkgKi8KLQkJciA9IF9fcmVz
ZXJ2YXRpb25fb2JqZWN0X21ha2VfZXhjbHVzaXZlKGJvLT50Ym8uYmFzZS5yZXN2KTsKKwkJciA9
IF9fZG1hX3Jlc3ZfbWFrZV9leGNsdXNpdmUoYm8tPnRiby5iYXNlLnJlc3YpOwogCQlpZiAocikK
IAkJCWdvdG8gZXJyb3JfdW5yZXNlcnZlOwogCX0KQEAgLTM2Nyw3ICszNjcsNyBAQCBhbWRncHVf
Z2VtX3ByaW1lX2ltcG9ydF9zZ190YWJsZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogCQkJCSBz
dHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICphdHRhY2gsCiAJCQkJIHN0cnVjdCBzZ190YWJsZSAq
c2cpCiB7Ci0Jc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdiA9IGF0dGFjaC0+ZG1hYnVm
LT5yZXN2OworCXN0cnVjdCBkbWFfcmVzdiAqcmVzdiA9IGF0dGFjaC0+ZG1hYnVmLT5yZXN2Owog
CXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gZGV2LT5kZXZfcHJpdmF0ZTsKIAlzdHJ1Y3Qg
YW1kZ3B1X2JvICpibzsKIAlzdHJ1Y3QgYW1kZ3B1X2JvX3BhcmFtIGJwOwpAQCAtMzgwLDcgKzM4
MCw3IEBAIGFtZGdwdV9nZW1fcHJpbWVfaW1wb3J0X3NnX3RhYmxlKHN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYsCiAJYnAuZmxhZ3MgPSAwOwogCWJwLnR5cGUgPSB0dG1fYm9fdHlwZV9zZzsKIAlicC5y
ZXN2ID0gcmVzdjsKLQlyZXNlcnZhdGlvbl9vYmplY3RfbG9jayhyZXN2LCBOVUxMKTsKKwlkbWFf
cmVzdl9sb2NrKHJlc3YsIE5VTEwpOwogCXJldCA9IGFtZGdwdV9ib19jcmVhdGUoYWRldiwgJmJw
LCAmYm8pOwogCWlmIChyZXQpCiAJCWdvdG8gZXJyb3I7CkBAIC0zOTIsMTEgKzM5MiwxMSBAQCBh
bWRncHVfZ2VtX3ByaW1lX2ltcG9ydF9zZ190YWJsZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAog
CWlmIChhdHRhY2gtPmRtYWJ1Zi0+b3BzICE9ICZhbWRncHVfZG1hYnVmX29wcykKIAkJYm8tPnBy
aW1lX3NoYXJlZF9jb3VudCA9IDE7CiAKLQlyZXNlcnZhdGlvbl9vYmplY3RfdW5sb2NrKHJlc3Yp
OworCWRtYV9yZXN2X3VubG9jayhyZXN2KTsKIAlyZXR1cm4gJmJvLT50Ym8uYmFzZTsKIAogZXJy
b3I6Ci0JcmVzZXJ2YXRpb25fb2JqZWN0X3VubG9jayhyZXN2KTsKKwlkbWFfcmVzdl91bmxvY2so
cmVzdik7CiAJcmV0dXJuIEVSUl9QVFIocmV0KTsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2dlbS5jCmluZGV4IGJmZjkxNzNhMWE5NC4uNDBmNjczY2ZiYmZlIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZ2VtLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dlbS5jCkBAIC01MCw3ICs1MCw3IEBAIHZvaWQg
YW1kZ3B1X2dlbV9vYmplY3RfZnJlZShzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdvYmopCiBpbnQg
YW1kZ3B1X2dlbV9vYmplY3RfY3JlYXRlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCB1bnNp
Z25lZCBsb25nIHNpemUsCiAJCQkgICAgIGludCBhbGlnbm1lbnQsIHUzMiBpbml0aWFsX2RvbWFp
biwKIAkJCSAgICAgdTY0IGZsYWdzLCBlbnVtIHR0bV9ib190eXBlIHR5cGUsCi0JCQkgICAgIHN0
cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKnJlc3YsCisJCQkgICAgIHN0cnVjdCBkbWFfcmVzdiAq
cmVzdiwKIAkJCSAgICAgc3RydWN0IGRybV9nZW1fb2JqZWN0ICoqb2JqKQogewogCXN0cnVjdCBh
bWRncHVfYm8gKmJvOwpAQCAtMjE1LDcgKzIxNSw3IEBAIGludCBhbWRncHVfZ2VtX2NyZWF0ZV9p
b2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCXVuaW9uIGRybV9hbWRn
cHVfZ2VtX2NyZWF0ZSAqYXJncyA9IGRhdGE7CiAJdWludDY0X3QgZmxhZ3MgPSBhcmdzLT5pbi5k
b21haW5fZmxhZ3M7CiAJdWludDY0X3Qgc2l6ZSA9IGFyZ3MtPmluLmJvX3NpemU7Ci0Jc3RydWN0
IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdiA9IE5VTEw7CisJc3RydWN0IGRtYV9yZXN2ICpyZXN2
ID0gTlVMTDsKIAlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdvYmo7CiAJdWludDMyX3QgaGFuZGxl
OwogCWludCByOwpAQCAtNDMzLDcgKzQzMyw3IEBAIGludCBhbWRncHVfZ2VtX3dhaXRfaWRsZV9p
b2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCQlyZXR1cm4gLUVOT0VO
VDsKIAl9CiAJcm9iaiA9IGdlbV90b19hbWRncHVfYm8oZ29iaik7Ci0JcmV0ID0gcmVzZXJ2YXRp
b25fb2JqZWN0X3dhaXRfdGltZW91dF9yY3Uocm9iai0+dGJvLmJhc2UucmVzdiwgdHJ1ZSwgdHJ1
ZSwKKwlyZXQgPSBkbWFfcmVzdl93YWl0X3RpbWVvdXRfcmN1KHJvYmotPnRiby5iYXNlLnJlc3Ys
IHRydWUsIHRydWUsCiAJCQkJCQkgIHRpbWVvdXQpOwogCiAJLyogcmV0ID09IDAgbWVhbnMgbm90
IHNpZ25hbGVkLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X2dlbS5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dlbS5oCmluZGV4IDJm
MTcxNTBlMjZlMS4uMGI2NmQyZTZiNWQ1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfZ2VtLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X2dlbS5oCkBAIC00Nyw3ICs0Nyw3IEBAIHZvaWQgYW1kZ3B1X2dlbV9mb3JjZV9yZWxlYXNl
KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KTsKIGludCBhbWRncHVfZ2VtX29iamVjdF9jcmVh
dGUoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIHVuc2lnbmVkIGxvbmcgc2l6ZSwKIAkJCSAg
ICAgaW50IGFsaWdubWVudCwgdTMyIGluaXRpYWxfZG9tYWluLAogCQkJICAgICB1NjQgZmxhZ3Ms
IGVudW0gdHRtX2JvX3R5cGUgdHlwZSwKLQkJCSAgICAgc3RydWN0IHJlc2VydmF0aW9uX29iamVj
dCAqcmVzdiwKKwkJCSAgICAgc3RydWN0IGRtYV9yZXN2ICpyZXN2LAogCQkJICAgICBzdHJ1Y3Qg
ZHJtX2dlbV9vYmplY3QgKipvYmopOwogCiBpbnQgYW1kZ3B1X21vZGVfZHVtYl9jcmVhdGUoc3Ry
dWN0IGRybV9maWxlICpmaWxlX3ByaXYsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfaWRzLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
aWRzLmMKaW5kZXggNTdiM2Q4YTliZWYzLi5iMzgyM2Y2NTdiZGYgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9pZHMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfaWRzLmMKQEAgLTEwNCw3ICsxMDQsNyBAQCBzdGF0aWMgdm9pZCBh
bWRncHVfcGFzaWRfZnJlZV9jYihzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSwKICAqCiAgKiBGcmVl
IHRoZSBwYXNpZCBvbmx5IGFmdGVyIGFsbCB0aGUgZmVuY2VzIGluIHJlc3YgYXJlIHNpZ25hbGVk
LgogICovCi12b2lkIGFtZGdwdV9wYXNpZF9mcmVlX2RlbGF5ZWQoc3RydWN0IHJlc2VydmF0aW9u
X29iamVjdCAqcmVzdiwKK3ZvaWQgYW1kZ3B1X3Bhc2lkX2ZyZWVfZGVsYXllZChzdHJ1Y3QgZG1h
X3Jlc3YgKnJlc3YsCiAJCQkgICAgICAgdW5zaWduZWQgaW50IHBhc2lkKQogewogCXN0cnVjdCBk
bWFfZmVuY2UgKmZlbmNlLCAqKmZlbmNlczsKQEAgLTExMiw3ICsxMTIsNyBAQCB2b2lkIGFtZGdw
dV9wYXNpZF9mcmVlX2RlbGF5ZWQoc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdiwKIAl1
bnNpZ25lZCBjb3VudDsKIAlpbnQgcjsKIAotCXIgPSByZXNlcnZhdGlvbl9vYmplY3RfZ2V0X2Zl
bmNlc19yY3UocmVzdiwgTlVMTCwgJmNvdW50LCAmZmVuY2VzKTsKKwlyID0gZG1hX3Jlc3ZfZ2V0
X2ZlbmNlc19yY3UocmVzdiwgTlVMTCwgJmNvdW50LCAmZmVuY2VzKTsKIAlpZiAocikKIAkJZ290
byBmYWxsYmFjazsKIApAQCAtMTU2LDcgKzE1Niw3IEBAIHZvaWQgYW1kZ3B1X3Bhc2lkX2ZyZWVf
ZGVsYXllZChzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyZXN2LAogCS8qIE5vdCBlbm91Z2gg
bWVtb3J5IGZvciB0aGUgZGVsYXllZCBkZWxldGUsIGFzIGxhc3QgcmVzb3J0CiAJICogYmxvY2sg
Zm9yIGFsbCB0aGUgZmVuY2VzIHRvIGNvbXBsZXRlLgogCSAqLwotCXJlc2VydmF0aW9uX29iamVj
dF93YWl0X3RpbWVvdXRfcmN1KHJlc3YsIHRydWUsIGZhbHNlLAorCWRtYV9yZXN2X3dhaXRfdGlt
ZW91dF9yY3UocmVzdiwgdHJ1ZSwgZmFsc2UsCiAJCQkJCSAgICBNQVhfU0NIRURVTEVfVElNRU9V
VCk7CiAJYW1kZ3B1X3Bhc2lkX2ZyZWUocGFzaWQpOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2lkcy5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2lkcy5oCmluZGV4IDc2MjU0MTlmMGZjMi4uOGU1ODMyNWJiY2EyIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfaWRzLmgKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2lkcy5oCkBAIC03Miw3ICs3Miw3IEBAIHN0cnVj
dCBhbWRncHVfdm1pZF9tZ3IgewogCiBpbnQgYW1kZ3B1X3Bhc2lkX2FsbG9jKHVuc2lnbmVkIGlu
dCBiaXRzKTsKIHZvaWQgYW1kZ3B1X3Bhc2lkX2ZyZWUodW5zaWduZWQgaW50IHBhc2lkKTsKLXZv
aWQgYW1kZ3B1X3Bhc2lkX2ZyZWVfZGVsYXllZChzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpy
ZXN2LAordm9pZCBhbWRncHVfcGFzaWRfZnJlZV9kZWxheWVkKHN0cnVjdCBkbWFfcmVzdiAqcmVz
diwKIAkJCSAgICAgICB1bnNpZ25lZCBpbnQgcGFzaWQpOwogCiBib29sIGFtZGdwdV92bWlkX2hh
ZF9ncHVfcmVzZXQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfbW4uYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV9tbi5jCmluZGV4IDUwMDIyYWNjOGE4MS4uZjFmOGNkZDY5NWQzIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfbW4uYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfbW4uYwpAQCAtMTc5LDcgKzE3OSw3IEBAIHN0
YXRpYyB2b2lkIGFtZGdwdV9tbl9pbnZhbGlkYXRlX25vZGUoc3RydWN0IGFtZGdwdV9tbl9ub2Rl
ICpub2RlLAogCQlpZiAoIWFtZGdwdV90dG1fdHRfYWZmZWN0X3VzZXJwdHIoYm8tPnRiby50dG0s
IHN0YXJ0LCBlbmQpKQogCQkJY29udGludWU7CiAKLQkJciA9IHJlc2VydmF0aW9uX29iamVjdF93
YWl0X3RpbWVvdXRfcmN1KGJvLT50Ym8uYmFzZS5yZXN2LAorCQlyID0gZG1hX3Jlc3Zfd2FpdF90
aW1lb3V0X3JjdShiby0+dGJvLmJhc2UucmVzdiwKIAkJCXRydWUsIGZhbHNlLCBNQVhfU0NIRURV
TEVfVElNRU9VVCk7CiAJCWlmIChyIDw9IDApCiAJCQlEUk1fRVJST1IoIiglbGQpIGZhaWxlZCB0
byB3YWl0IGZvciB1c2VyIGJvXG4iLCByKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2FtZGdwdV9vYmplY3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV9vYmplY3QuYwppbmRleCA4YWU0NGQzODNhMTMuLjJmMTFlYmQ5NTUyOCAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X29iamVjdC5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9vYmplY3QuYwpAQCAtNTQ0LDcgKzU0NCw3IEBA
IHN0YXRpYyBpbnQgYW1kZ3B1X2JvX2RvX2NyZWF0ZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
diwKIAogZmFpbF91bnJlc2VydmU6CiAJaWYgKCFicC0+cmVzdikKLQkJcmVzZXJ2YXRpb25fb2Jq
ZWN0X3VubG9jayhiby0+dGJvLmJhc2UucmVzdik7CisJCWRtYV9yZXN2X3VubG9jayhiby0+dGJv
LmJhc2UucmVzdik7CiAJYW1kZ3B1X2JvX3VucmVmKCZibyk7CiAJcmV0dXJuIHI7CiB9CkBAIC02
MDYsMTMgKzYwNiwxMyBAQCBpbnQgYW1kZ3B1X2JvX2NyZWF0ZShzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqYWRldiwKIAogCWlmICgoZmxhZ3MgJiBBTURHUFVfR0VNX0NSRUFURV9TSEFET1cpICYmICEo
YWRldi0+ZmxhZ3MgJiBBTURfSVNfQVBVKSkgewogCQlpZiAoIWJwLT5yZXN2KQotCQkJV0FSTl9P
TihyZXNlcnZhdGlvbl9vYmplY3RfbG9jaygoKmJvX3B0ciktPnRiby5iYXNlLnJlc3YsCisJCQlX
QVJOX09OKGRtYV9yZXN2X2xvY2soKCpib19wdHIpLT50Ym8uYmFzZS5yZXN2LAogCQkJCQkJCU5V
TEwpKTsKIAogCQlyID0gYW1kZ3B1X2JvX2NyZWF0ZV9zaGFkb3coYWRldiwgYnAtPnNpemUsICpi
b19wdHIpOwogCiAJCWlmICghYnAtPnJlc3YpCi0JCQlyZXNlcnZhdGlvbl9vYmplY3RfdW5sb2Nr
KCgqYm9fcHRyKS0+dGJvLmJhc2UucmVzdik7CisJCQlkbWFfcmVzdl91bmxvY2soKCpib19wdHIp
LT50Ym8uYmFzZS5yZXN2KTsKIAogCQlpZiAocikKIAkJCWFtZGdwdV9ib191bnJlZihib19wdHIp
OwpAQCAtNzA5LDcgKzcwOSw3IEBAIGludCBhbWRncHVfYm9fa21hcChzdHJ1Y3QgYW1kZ3B1X2Jv
ICpibywgdm9pZCAqKnB0cikKIAkJcmV0dXJuIDA7CiAJfQogCi0JciA9IHJlc2VydmF0aW9uX29i
amVjdF93YWl0X3RpbWVvdXRfcmN1KGJvLT50Ym8uYmFzZS5yZXN2LCBmYWxzZSwgZmFsc2UsCisJ
ciA9IGRtYV9yZXN2X3dhaXRfdGltZW91dF9yY3UoYm8tPnRiby5iYXNlLnJlc3YsIGZhbHNlLCBm
YWxzZSwKIAkJCQkJCU1BWF9TQ0hFRFVMRV9USU1FT1VUKTsKIAlpZiAociA8IDApCiAJCXJldHVy
biByOwpAQCAtMTA4Nyw3ICsxMDg3LDcgQEAgaW50IGFtZGdwdV9ib19zZXRfdGlsaW5nX2ZsYWdz
KHN0cnVjdCBhbWRncHVfYm8gKmJvLCB1NjQgdGlsaW5nX2ZsYWdzKQogICovCiB2b2lkIGFtZGdw
dV9ib19nZXRfdGlsaW5nX2ZsYWdzKHN0cnVjdCBhbWRncHVfYm8gKmJvLCB1NjQgKnRpbGluZ19m
bGFncykKIHsKLQlyZXNlcnZhdGlvbl9vYmplY3RfYXNzZXJ0X2hlbGQoYm8tPnRiby5iYXNlLnJl
c3YpOworCWRtYV9yZXN2X2Fzc2VydF9oZWxkKGJvLT50Ym8uYmFzZS5yZXN2KTsKIAogCWlmICh0
aWxpbmdfZmxhZ3MpCiAJCSp0aWxpbmdfZmxhZ3MgPSBiby0+dGlsaW5nX2ZsYWdzOwpAQCAtMTI4
MywxMiArMTI4MywxMiBAQCBpbnQgYW1kZ3B1X2JvX2ZhdWx0X3Jlc2VydmVfbm90aWZ5KHN0cnVj
dCB0dG1fYnVmZmVyX29iamVjdCAqYm8pCiB2b2lkIGFtZGdwdV9ib19mZW5jZShzdHJ1Y3QgYW1k
Z3B1X2JvICpibywgc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UsCiAJCSAgICAgYm9vbCBzaGFyZWQp
CiB7Ci0Jc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdiA9IGJvLT50Ym8uYmFzZS5yZXN2
OworCXN0cnVjdCBkbWFfcmVzdiAqcmVzdiA9IGJvLT50Ym8uYmFzZS5yZXN2OwogCiAJaWYgKHNo
YXJlZCkKLQkJcmVzZXJ2YXRpb25fb2JqZWN0X2FkZF9zaGFyZWRfZmVuY2UocmVzdiwgZmVuY2Up
OworCQlkbWFfcmVzdl9hZGRfc2hhcmVkX2ZlbmNlKHJlc3YsIGZlbmNlKTsKIAllbHNlCi0JCXJl
c2VydmF0aW9uX29iamVjdF9hZGRfZXhjbF9mZW5jZShyZXN2LCBmZW5jZSk7CisJCWRtYV9yZXN2
X2FkZF9leGNsX2ZlbmNlKHJlc3YsIGZlbmNlKTsKIH0KIAogLyoqCkBAIC0xMzI4LDcgKzEzMjgs
NyBAQCBpbnQgYW1kZ3B1X2JvX3N5bmNfd2FpdChzdHJ1Y3QgYW1kZ3B1X2JvICpibywgdm9pZCAq
b3duZXIsIGJvb2wgaW50cikKIHU2NCBhbWRncHVfYm9fZ3B1X29mZnNldChzdHJ1Y3QgYW1kZ3B1
X2JvICpibykKIHsKIAlXQVJOX09OX09OQ0UoYm8tPnRiby5tZW0ubWVtX3R5cGUgPT0gVFRNX1BM
X1NZU1RFTSk7Ci0JV0FSTl9PTl9PTkNFKCFyZXNlcnZhdGlvbl9vYmplY3RfaXNfbG9ja2VkKGJv
LT50Ym8uYmFzZS5yZXN2KSAmJgorCVdBUk5fT05fT05DRSghZG1hX3Jlc3ZfaXNfbG9ja2VkKGJv
LT50Ym8uYmFzZS5yZXN2KSAmJgogCQkgICAgICFiby0+cGluX2NvdW50ICYmIGJvLT50Ym8udHlw
ZSAhPSB0dG1fYm9fdHlwZV9rZXJuZWwpOwogCVdBUk5fT05fT05DRShiby0+dGJvLm1lbS5zdGFy
dCA9PSBBTURHUFVfQk9fSU5WQUxJRF9PRkZTRVQpOwogCVdBUk5fT05fT05DRShiby0+dGJvLm1l
bS5tZW1fdHlwZSA9PSBUVE1fUExfVlJBTSAmJgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X29iamVjdC5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X29iamVjdC5oCmluZGV4IDExM2ZiMmZlYjQzNy4uMWE1NTViMGZkM2I3IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfb2JqZWN0LmgKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X29iamVjdC5oCkBAIC00MSw3ICs0MSw3IEBA
IHN0cnVjdCBhbWRncHVfYm9fcGFyYW0gewogCXUzMgkJCQlwcmVmZXJyZWRfZG9tYWluOwogCXU2
NAkJCQlmbGFnczsKIAllbnVtIHR0bV9ib190eXBlCQl0eXBlOwotCXN0cnVjdCByZXNlcnZhdGlv
bl9vYmplY3QJKnJlc3Y7CisJc3RydWN0IGRtYV9yZXN2CSpyZXN2OwogfTsKIAogLyogYm8gdmly
dHVhbCBhZGRyZXNzZXMgaW4gYSB2bSAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1X3N5bmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9zeW5jLmMKaW5kZXggOTgyOGYzYzdjNjU1Li45NWU1ZTkzZWRkMTggMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9zeW5jLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3N5bmMuYwpAQCAtMTkwLDEwICsxOTAsMTAgQEAgaW50IGFt
ZGdwdV9zeW5jX2ZlbmNlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBzdHJ1Y3QgYW1kZ3B1
X3N5bmMgKnN5bmMsCiAgKi8KIGludCBhbWRncHVfc3luY19yZXN2KHN0cnVjdCBhbWRncHVfZGV2
aWNlICphZGV2LAogCQkgICAgIHN0cnVjdCBhbWRncHVfc3luYyAqc3luYywKLQkJICAgICBzdHJ1
Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyZXN2LAorCQkgICAgIHN0cnVjdCBkbWFfcmVzdiAqcmVz
diwKIAkJICAgICB2b2lkICpvd25lciwgYm9vbCBleHBsaWNpdF9zeW5jKQogewotCXN0cnVjdCBy
ZXNlcnZhdGlvbl9vYmplY3RfbGlzdCAqZmxpc3Q7CisJc3RydWN0IGRtYV9yZXN2X2xpc3QgKmZs
aXN0OwogCXN0cnVjdCBkbWFfZmVuY2UgKmY7CiAJdm9pZCAqZmVuY2Vfb3duZXI7CiAJdW5zaWdu
ZWQgaTsKQEAgLTIwMywxNiArMjAzLDE2IEBAIGludCBhbWRncHVfc3luY19yZXN2KHN0cnVjdCBh
bWRncHVfZGV2aWNlICphZGV2LAogCQlyZXR1cm4gLUVJTlZBTDsKIAogCS8qIGFsd2F5cyBzeW5j
IHRvIHRoZSBleGNsdXNpdmUgZmVuY2UgKi8KLQlmID0gcmVzZXJ2YXRpb25fb2JqZWN0X2dldF9l
eGNsKHJlc3YpOworCWYgPSBkbWFfcmVzdl9nZXRfZXhjbChyZXN2KTsKIAlyID0gYW1kZ3B1X3N5
bmNfZmVuY2UoYWRldiwgc3luYywgZiwgZmFsc2UpOwogCi0JZmxpc3QgPSByZXNlcnZhdGlvbl9v
YmplY3RfZ2V0X2xpc3QocmVzdik7CisJZmxpc3QgPSBkbWFfcmVzdl9nZXRfbGlzdChyZXN2KTsK
IAlpZiAoIWZsaXN0IHx8IHIpCiAJCXJldHVybiByOwogCiAJZm9yIChpID0gMDsgaSA8IGZsaXN0
LT5zaGFyZWRfY291bnQ7ICsraSkgewogCQlmID0gcmN1X2RlcmVmZXJlbmNlX3Byb3RlY3RlZChm
bGlzdC0+c2hhcmVkW2ldLAotCQkJCQkgICAgICByZXNlcnZhdGlvbl9vYmplY3RfaGVsZChyZXN2
KSk7CisJCQkJCSAgICAgIGRtYV9yZXN2X2hlbGQocmVzdikpOwogCQkvKiBXZSBvbmx5IHdhbnQg
dG8gdHJpZ2dlciBLRkQgZXZpY3Rpb24gZmVuY2VzIG9uCiAJCSAqIGV2aWN0IG9yIG1vdmUgam9i
cy4gU2tpcCBLRkQgZmVuY2VzIG90aGVyd2lzZS4KIAkJICovCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfc3luYy5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X3N5bmMuaAppbmRleCAxMGNmMjNhNTdmMTcuLmI1ZjE3NzhhMjMxOSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3N5bmMuaAorKysgYi9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfc3luYy5oCkBAIC0yNyw3ICsyNyw3IEBA
CiAjaW5jbHVkZSA8bGludXgvaGFzaHRhYmxlLmg+CiAKIHN0cnVjdCBkbWFfZmVuY2U7Ci1zdHJ1
Y3QgcmVzZXJ2YXRpb25fb2JqZWN0Oworc3RydWN0IGRtYV9yZXN2Owogc3RydWN0IGFtZGdwdV9k
ZXZpY2U7CiBzdHJ1Y3QgYW1kZ3B1X3Jpbmc7CiAKQEAgLTQ0LDcgKzQ0LDcgQEAgaW50IGFtZGdw
dV9zeW5jX2ZlbmNlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBzdHJ1Y3QgYW1kZ3B1X3N5
bmMgKnN5bmMsCiAJCSAgICAgIHN0cnVjdCBkbWFfZmVuY2UgKmYsIGJvb2wgZXhwbGljaXQpOwog
aW50IGFtZGdwdV9zeW5jX3Jlc3Yoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCiAJCSAgICAg
c3RydWN0IGFtZGdwdV9zeW5jICpzeW5jLAotCQkgICAgIHN0cnVjdCByZXNlcnZhdGlvbl9vYmpl
Y3QgKnJlc3YsCisJCSAgICAgc3RydWN0IGRtYV9yZXN2ICpyZXN2LAogCQkgICAgIHZvaWQgKm93
bmVyLAogCQkgICAgIGJvb2wgZXhwbGljaXRfc3luYyk7CiBzdHJ1Y3QgZG1hX2ZlbmNlICphbWRn
cHVfc3luY19wZWVrX2ZlbmNlKHN0cnVjdCBhbWRncHVfc3luYyAqc3luYywKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYwppbmRleCA2M2U3ZDFlMDFiNzYuLmZiMDkzMTRiY2Zk
NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYwpAQCAtMzAzLDcgKzMw
Myw3IEBAIGludCBhbWRncHVfdHRtX2NvcHlfbWVtX3RvX21lbShzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqYWRldiwKIAkJCSAgICAgICBzdHJ1Y3QgYW1kZ3B1X2NvcHlfbWVtICpzcmMsCiAJCQkgICAg
ICAgc3RydWN0IGFtZGdwdV9jb3B5X21lbSAqZHN0LAogCQkJICAgICAgIHVpbnQ2NF90IHNpemUs
Ci0JCQkgICAgICAgc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdiwKKwkJCSAgICAgICBz
dHJ1Y3QgZG1hX3Jlc3YgKnJlc3YsCiAJCQkgICAgICAgc3RydWN0IGRtYV9mZW5jZSAqKmYpCiB7
CiAJc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nID0gYWRldi0+bW1hbi5idWZmZXJfZnVuY3Nfcmlu
ZzsKQEAgLTE0NzAsNyArMTQ3MCw3IEBAIHN0YXRpYyBib29sIGFtZGdwdV90dG1fYm9fZXZpY3Rp
b25fdmFsdWFibGUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIHsKIAl1bnNpZ25lZCBs
b25nIG51bV9wYWdlcyA9IGJvLT5tZW0ubnVtX3BhZ2VzOwogCXN0cnVjdCBkcm1fbW1fbm9kZSAq
bm9kZSA9IGJvLT5tZW0ubW1fbm9kZTsKLQlzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0X2xpc3Qg
KmZsaXN0OworCXN0cnVjdCBkbWFfcmVzdl9saXN0ICpmbGlzdDsKIAlzdHJ1Y3QgZG1hX2ZlbmNl
ICpmOwogCWludCBpOwogCkBAIC0xNDc4LDE4ICsxNDc4LDE4IEBAIHN0YXRpYyBib29sIGFtZGdw
dV90dG1fYm9fZXZpY3Rpb25fdmFsdWFibGUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywK
IAkgKiBjbGVhbmx5IGhhbmRsZSBwYWdlIGZhdWx0cy4KIAkgKi8KIAlpZiAoYm8tPnR5cGUgPT0g
dHRtX2JvX3R5cGVfa2VybmVsICYmCi0JICAgICFyZXNlcnZhdGlvbl9vYmplY3RfdGVzdF9zaWdu
YWxlZF9yY3UoYm8tPmJhc2UucmVzdiwgdHJ1ZSkpCisJICAgICFkbWFfcmVzdl90ZXN0X3NpZ25h
bGVkX3JjdShiby0+YmFzZS5yZXN2LCB0cnVlKSkKIAkJcmV0dXJuIGZhbHNlOwogCiAJLyogSWYg
Ym8gaXMgYSBLRkQgQk8sIGNoZWNrIGlmIHRoZSBibyBiZWxvbmdzIHRvIHRoZSBjdXJyZW50IHBy
b2Nlc3MuCiAJICogSWYgdHJ1ZSwgdGhlbiByZXR1cm4gZmFsc2UgYXMgYW55IEtGRCBwcm9jZXNz
IG5lZWRzIGFsbCBpdHMgQk9zIHRvCiAJICogYmUgcmVzaWRlbnQgdG8gcnVuIHN1Y2Nlc3NmdWxs
eQogCSAqLwotCWZsaXN0ID0gcmVzZXJ2YXRpb25fb2JqZWN0X2dldF9saXN0KGJvLT5iYXNlLnJl
c3YpOworCWZsaXN0ID0gZG1hX3Jlc3ZfZ2V0X2xpc3QoYm8tPmJhc2UucmVzdik7CiAJaWYgKGZs
aXN0KSB7CiAJCWZvciAoaSA9IDA7IGkgPCBmbGlzdC0+c2hhcmVkX2NvdW50OyArK2kpIHsKIAkJ
CWYgPSByY3VfZGVyZWZlcmVuY2VfcHJvdGVjdGVkKGZsaXN0LT5zaGFyZWRbaV0sCi0JCQkJcmVz
ZXJ2YXRpb25fb2JqZWN0X2hlbGQoYm8tPmJhc2UucmVzdikpOworCQkJCWRtYV9yZXN2X2hlbGQo
Ym8tPmJhc2UucmVzdikpOwogCQkJaWYgKGFtZGtmZF9mZW5jZV9jaGVja19tbShmLCBjdXJyZW50
LT5tbSkpCiAJCQkJcmV0dXJuIGZhbHNlOwogCQl9CkBAIC0xOTkyLDcgKzE5OTIsNyBAQCBzdGF0
aWMgaW50IGFtZGdwdV9tYXBfYnVmZmVyKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAK
IGludCBhbWRncHVfY29weV9idWZmZXIoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nLCB1aW50NjRf
dCBzcmNfb2Zmc2V0LAogCQkgICAgICAgdWludDY0X3QgZHN0X29mZnNldCwgdWludDMyX3QgYnl0
ZV9jb3VudCwKLQkJICAgICAgIHN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKnJlc3YsCisJCSAg
ICAgICBzdHJ1Y3QgZG1hX3Jlc3YgKnJlc3YsCiAJCSAgICAgICBzdHJ1Y3QgZG1hX2ZlbmNlICoq
ZmVuY2UsIGJvb2wgZGlyZWN0X3N1Ym1pdCwKIAkJICAgICAgIGJvb2wgdm1fbmVlZHNfZmx1c2gp
CiB7CkBAIC0yMDY2LDcgKzIwNjYsNyBAQCBpbnQgYW1kZ3B1X2NvcHlfYnVmZmVyKHN0cnVjdCBh
bWRncHVfcmluZyAqcmluZywgdWludDY0X3Qgc3JjX29mZnNldCwKIAogaW50IGFtZGdwdV9maWxs
X2J1ZmZlcihzdHJ1Y3QgYW1kZ3B1X2JvICpibywKIAkJICAgICAgIHVpbnQzMl90IHNyY19kYXRh
LAotCQkgICAgICAgc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdiwKKwkJICAgICAgIHN0
cnVjdCBkbWFfcmVzdiAqcmVzdiwKIAkJICAgICAgIHN0cnVjdCBkbWFfZmVuY2UgKipmZW5jZSkK
IHsKIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGFtZGdwdV90dG1fYWRldihiby0+dGJv
LmJkZXYpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0
bS5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5oCmluZGV4IGNhYTc2
YzY5MzcwMC4uODA4OTZiZDZiOTcyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9hbWRncHVfdHRtLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X3R0bS5oCkBAIC04MywxOCArODMsMTggQEAgdm9pZCBhbWRncHVfdHRtX3NldF9idWZmZXJfZnVu
Y3Nfc3RhdHVzKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAogCiBpbnQgYW1kZ3B1X2NvcHlf
YnVmZmVyKHN0cnVjdCBhbWRncHVfcmluZyAqcmluZywgdWludDY0X3Qgc3JjX29mZnNldCwKIAkJ
ICAgICAgIHVpbnQ2NF90IGRzdF9vZmZzZXQsIHVpbnQzMl90IGJ5dGVfY291bnQsCi0JCSAgICAg
ICBzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyZXN2LAorCQkgICAgICAgc3RydWN0IGRtYV9y
ZXN2ICpyZXN2LAogCQkgICAgICAgc3RydWN0IGRtYV9mZW5jZSAqKmZlbmNlLCBib29sIGRpcmVj
dF9zdWJtaXQsCiAJCSAgICAgICBib29sIHZtX25lZWRzX2ZsdXNoKTsKIGludCBhbWRncHVfdHRt
X2NvcHlfbWVtX3RvX21lbShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIAkJCSAgICAgICBz
dHJ1Y3QgYW1kZ3B1X2NvcHlfbWVtICpzcmMsCiAJCQkgICAgICAgc3RydWN0IGFtZGdwdV9jb3B5
X21lbSAqZHN0LAogCQkJICAgICAgIHVpbnQ2NF90IHNpemUsCi0JCQkgICAgICAgc3RydWN0IHJl
c2VydmF0aW9uX29iamVjdCAqcmVzdiwKKwkJCSAgICAgICBzdHJ1Y3QgZG1hX3Jlc3YgKnJlc3Ys
CiAJCQkgICAgICAgc3RydWN0IGRtYV9mZW5jZSAqKmYpOwogaW50IGFtZGdwdV9maWxsX2J1ZmZl
cihzdHJ1Y3QgYW1kZ3B1X2JvICpibywKIAkJCXVpbnQzMl90IHNyY19kYXRhLAotCQkJc3RydWN0
IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdiwKKwkJCXN0cnVjdCBkbWFfcmVzdiAqcmVzdiwKIAkJ
CXN0cnVjdCBkbWFfZmVuY2UgKipmZW5jZSk7CiAKIGludCBhbWRncHVfbW1hcChzdHJ1Y3QgZmls
ZSAqZmlscCwgc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEpOwpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3V2ZC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X3V2ZC5jCmluZGV4IGY4NTg2MDdiMTdhNS4uYjJjMzY0Yjg2OTVmIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdXZkLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3V2ZC5jCkBAIC0xMDczLDcgKzEwNzMsNyBA
QCBzdGF0aWMgaW50IGFtZGdwdV91dmRfc2VuZF9tc2coc3RydWN0IGFtZGdwdV9yaW5nICpyaW5n
LCBzdHJ1Y3QgYW1kZ3B1X2JvICpibywKIAlpYi0+bGVuZ3RoX2R3ID0gMTY7CiAKIAlpZiAoZGly
ZWN0KSB7Ci0JCXIgPSByZXNlcnZhdGlvbl9vYmplY3Rfd2FpdF90aW1lb3V0X3JjdShiby0+dGJv
LmJhc2UucmVzdiwKKwkJciA9IGRtYV9yZXN2X3dhaXRfdGltZW91dF9yY3UoYm8tPnRiby5iYXNl
LnJlc3YsCiAJCQkJCQkJdHJ1ZSwgZmFsc2UsCiAJCQkJCQkJbXNlY3NfdG9famlmZmllcygxMCkp
OwogCQlpZiAociA9PSAwKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X3ZtLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uYwppbmRl
eCA5NWVlZjBhYzI4MjkuLjA3ZGNhZDdlY2IyNiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X3ZtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X3ZtLmMKQEAgLTE3MDIsNyArMTcwMiw3IEBAIGludCBhbWRncHVfdm1fYm9fdXBkYXRl
KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAogCQkJdHRtID0gY29udGFpbmVyX29mKGJvLT50
Ym8udHRtLCBzdHJ1Y3QgdHRtX2RtYV90dCwgdHRtKTsKIAkJCXBhZ2VzX2FkZHIgPSB0dG0tPmRt
YV9hZGRyZXNzOwogCQl9Ci0JCWV4Y2x1c2l2ZSA9IHJlc2VydmF0aW9uX29iamVjdF9nZXRfZXhj
bChiby0+dGJvLmJhc2UucmVzdik7CisJCWV4Y2x1c2l2ZSA9IGRtYV9yZXN2X2dldF9leGNsKGJv
LT50Ym8uYmFzZS5yZXN2KTsKIAl9CiAKIAlpZiAoYm8pIHsKQEAgLTE4NzksMTggKzE4NzksMTgg
QEAgc3RhdGljIHZvaWQgYW1kZ3B1X3ZtX2ZyZWVfbWFwcGluZyhzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqYWRldiwKICAqLwogc3RhdGljIHZvaWQgYW1kZ3B1X3ZtX3BydF9maW5pKHN0cnVjdCBhbWRn
cHVfZGV2aWNlICphZGV2LCBzdHJ1Y3QgYW1kZ3B1X3ZtICp2bSkKIHsKLQlzdHJ1Y3QgcmVzZXJ2
YXRpb25fb2JqZWN0ICpyZXN2ID0gdm0tPnJvb3QuYmFzZS5iby0+dGJvLmJhc2UucmVzdjsKKwlz
dHJ1Y3QgZG1hX3Jlc3YgKnJlc3YgPSB2bS0+cm9vdC5iYXNlLmJvLT50Ym8uYmFzZS5yZXN2Owog
CXN0cnVjdCBkbWFfZmVuY2UgKmV4Y2wsICoqc2hhcmVkOwogCXVuc2lnbmVkIGksIHNoYXJlZF9j
b3VudDsKIAlpbnQgcjsKIAotCXIgPSByZXNlcnZhdGlvbl9vYmplY3RfZ2V0X2ZlbmNlc19yY3Uo
cmVzdiwgJmV4Y2wsCisJciA9IGRtYV9yZXN2X2dldF9mZW5jZXNfcmN1KHJlc3YsICZleGNsLAog
CQkJCQkgICAgICAmc2hhcmVkX2NvdW50LCAmc2hhcmVkKTsKIAlpZiAocikgewogCQkvKiBOb3Qg
ZW5vdWdoIG1lbW9yeSB0byBncmFiIHRoZSBmZW5jZSBsaXN0LCBhcyBsYXN0IHJlc29ydAogCQkg
KiBibG9jayBmb3IgYWxsIHRoZSBmZW5jZXMgdG8gY29tcGxldGUuCiAJCSAqLwotCQlyZXNlcnZh
dGlvbl9vYmplY3Rfd2FpdF90aW1lb3V0X3JjdShyZXN2LCB0cnVlLCBmYWxzZSwKKwkJZG1hX3Jl
c3Zfd2FpdF90aW1lb3V0X3JjdShyZXN2LCB0cnVlLCBmYWxzZSwKIAkJCQkJCSAgICBNQVhfU0NI
RURVTEVfVElNRU9VVCk7CiAJCXJldHVybjsKIAl9CkBAIC0xOTc4LDcgKzE5NzgsNyBAQCBpbnQg
YW1kZ3B1X3ZtX2hhbmRsZV9tb3ZlZChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIAkJCSAg
IHN0cnVjdCBhbWRncHVfdm0gKnZtKQogewogCXN0cnVjdCBhbWRncHVfYm9fdmEgKmJvX3ZhLCAq
dG1wOwotCXN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKnJlc3Y7CisJc3RydWN0IGRtYV9yZXN2
ICpyZXN2OwogCWJvb2wgY2xlYXI7CiAJaW50IHI7CiAKQEAgLTE5OTcsNyArMTk5Nyw3IEBAIGlu
dCBhbWRncHVfdm1faGFuZGxlX21vdmVkKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAogCQlz
cGluX3VubG9jaygmdm0tPmludmFsaWRhdGVkX2xvY2spOwogCiAJCS8qIFRyeSB0byByZXNlcnZl
IHRoZSBCTyB0byBhdm9pZCBjbGVhcmluZyBpdHMgcHRlcyAqLwotCQlpZiAoIWFtZGdwdV92bV9k
ZWJ1ZyAmJiByZXNlcnZhdGlvbl9vYmplY3RfdHJ5bG9jayhyZXN2KSkKKwkJaWYgKCFhbWRncHVf
dm1fZGVidWcgJiYgZG1hX3Jlc3ZfdHJ5bG9jayhyZXN2KSkKIAkJCWNsZWFyID0gZmFsc2U7CiAJ
CS8qIFNvbWVib2R5IGVsc2UgaXMgdXNpbmcgdGhlIEJPIHJpZ2h0IG5vdyAqLwogCQllbHNlCkBA
IC0yMDA4LDcgKzIwMDgsNyBAQCBpbnQgYW1kZ3B1X3ZtX2hhbmRsZV9tb3ZlZChzdHJ1Y3QgYW1k
Z3B1X2RldmljZSAqYWRldiwKIAkJCXJldHVybiByOwogCiAJCWlmICghY2xlYXIpCi0JCQlyZXNl
cnZhdGlvbl9vYmplY3RfdW5sb2NrKHJlc3YpOworCQkJZG1hX3Jlc3ZfdW5sb2NrKHJlc3YpOwog
CQlzcGluX2xvY2soJnZtLT5pbnZhbGlkYXRlZF9sb2NrKTsKIAl9CiAJc3Bpbl91bmxvY2soJnZt
LT5pbnZhbGlkYXRlZF9sb2NrKTsKQEAgLTI0MTYsNyArMjQxNiw3IEBAIHZvaWQgYW1kZ3B1X3Zt
X2JvX3RyYWNlX2NzKHN0cnVjdCBhbWRncHVfdm0gKnZtLCBzdHJ1Y3Qgd3dfYWNxdWlyZV9jdHgg
KnRpY2tldCkKIAkJCXN0cnVjdCBhbWRncHVfYm8gKmJvOwogCiAJCQlibyA9IG1hcHBpbmctPmJv
X3ZhLT5iYXNlLmJvOwotCQkJaWYgKHJlc2VydmF0aW9uX29iamVjdF9sb2NraW5nX2N0eChiby0+
dGJvLmJhc2UucmVzdikgIT0KKwkJCWlmIChkbWFfcmVzdl9sb2NraW5nX2N0eChiby0+dGJvLmJh
c2UucmVzdikgIT0KIAkJCSAgICB0aWNrZXQpCiAJCQkJY29udGludWU7CiAJCX0KQEAgLTI2NDks
NyArMjY0OSw3IEBAIHZvaWQgYW1kZ3B1X3ZtX2FkanVzdF9zaXplKHN0cnVjdCBhbWRncHVfZGV2
aWNlICphZGV2LCB1aW50MzJfdCBtaW5fdm1fc2l6ZSwKICAqLwogbG9uZyBhbWRncHVfdm1fd2Fp
dF9pZGxlKHN0cnVjdCBhbWRncHVfdm0gKnZtLCBsb25nIHRpbWVvdXQpCiB7Ci0JcmV0dXJuIHJl
c2VydmF0aW9uX29iamVjdF93YWl0X3RpbWVvdXRfcmN1KHZtLT5yb290LmJhc2UuYm8tPnRiby5i
YXNlLnJlc3YsCisJcmV0dXJuIGRtYV9yZXN2X3dhaXRfdGltZW91dF9yY3Uodm0tPnJvb3QuYmFz
ZS5iby0+dGJvLmJhc2UucmVzdiwKIAkJCQkJCSAgIHRydWUsIHRydWUsIHRpbWVvdXQpOwogfQog
CkBAIC0yNzI0LDcgKzI3MjQsNyBAQCBpbnQgYW1kZ3B1X3ZtX2luaXQoc3RydWN0IGFtZGdwdV9k
ZXZpY2UgKmFkZXYsIHN0cnVjdCBhbWRncHVfdm0gKnZtLAogCWlmIChyKQogCQlnb3RvIGVycm9y
X2ZyZWVfcm9vdDsKIAotCXIgPSByZXNlcnZhdGlvbl9vYmplY3RfcmVzZXJ2ZV9zaGFyZWQocm9v
dC0+dGJvLmJhc2UucmVzdiwgMSk7CisJciA9IGRtYV9yZXN2X3Jlc2VydmVfc2hhcmVkKHJvb3Qt
PnRiby5iYXNlLnJlc3YsIDEpOwogCWlmIChyKQogCQlnb3RvIGVycm9yX3VucmVzZXJ2ZTsKIApk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVf
ZG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtLmMK
aW5kZXggMzgxYTUzNDVmMTk1Li5jYjdjZmE5YjM0ZjIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvZGlzcGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG0uYwpAQCAtNTY5Myw3ICs1NjkzLDcg
QEAgc3RhdGljIHZvaWQgYW1kZ3B1X2RtX2NvbW1pdF9wbGFuZXMoc3RydWN0IGRybV9hdG9taWNf
c3RhdGUgKnN0YXRlLAogCQkgKiBkZWFkbG9jayBkdXJpbmcgR1BVIHJlc2V0IHdoZW4gdGhpcyBm
ZW5jZSB3aWxsIG5vdCBzaWduYWwKIAkJICogYnV0IHdlIGhvbGQgcmVzZXJ2YXRpb24gbG9jayBm
b3IgdGhlIEJPLgogCQkgKi8KLQkJciA9IHJlc2VydmF0aW9uX29iamVjdF93YWl0X3RpbWVvdXRf
cmN1KGFiby0+dGJvLmJhc2UucmVzdiwgdHJ1ZSwKKwkJciA9IGRtYV9yZXN2X3dhaXRfdGltZW91
dF9yY3UoYWJvLT50Ym8uYmFzZS5yZXN2LCB0cnVlLAogCQkJCQkJCWZhbHNlLAogCQkJCQkJCW1z
ZWNzX3RvX2ppZmZpZXMoNTAwMCkpOwogCQlpZiAodW5saWtlbHkociA8PSAwKSkKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9kcm1fYXRvbWljX3VhcGkuYyBiL2RyaXZlcnMvZ3B1L2RybS9k
cm1fYXRvbWljX3VhcGkuYwppbmRleCAxOWFlMTE5ZjFhNWQuLjVhNWI0MmRiNmYyYSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2RybV9hdG9taWNfdWFwaS5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9kcm1fYXRvbWljX3VhcGkuYwpAQCAtMTAzNyw3ICsxMDM3LDcgQEAgaW50IGRybV9hdG9t
aWNfc2V0X3Byb3BlcnR5KHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSwKICAqIEFzIGEg
Y29udHJhc3QsIHdpdGggaW1wbGljaXQgZmVuY2luZyB0aGUga2VybmVsIGtlZXBzIHRyYWNrIG9m
IGFueQogICogb25nb2luZyByZW5kZXJpbmcsIGFuZCBhdXRvbWF0aWNhbGx5IGVuc3VyZXMgdGhh
dCB0aGUgYXRvbWljIHVwZGF0ZSB3YWl0cwogICogZm9yIGFueSBwZW5kaW5nIHJlbmRlcmluZyB0
byBjb21wbGV0ZS4gRm9yIHNoYXJlZCBidWZmZXJzIHJlcHJlc2VudGVkIHdpdGgKLSAqIGEgJnN0
cnVjdCBkbWFfYnVmIHRoaXMgaXMgdHJhY2tlZCBpbiAmc3RydWN0IHJlc2VydmF0aW9uX29iamVj
dC4KKyAqIGEgJnN0cnVjdCBkbWFfYnVmIHRoaXMgaXMgdHJhY2tlZCBpbiAmc3RydWN0IGRtYV9y
ZXN2LgogICogSW1wbGljaXQgc3luY2luZyBpcyBob3cgTGludXggdHJhZGl0aW9uYWxseSB3b3Jr
ZWQgKGUuZy4gRFJJMi8zIG9uIFgub3JnKSwKICAqIHdoZXJlYXMgZXhwbGljaXQgZmVuY2luZyBp
cyB3aGF0IEFuZHJvaWQgd2FudHMuCiAgKgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2Ry
bV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtLmMKaW5kZXggYWZjMzhjZWNlM2Y1Li43
YTJkMGNiMGVlYWEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2RybV9nZW0uYwpAQCAtMTU5LDcgKzE1OSw3IEBAIHZvaWQgZHJtX2dl
bV9wcml2YXRlX29iamVjdF9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJa3JlZl9pbml0
KCZvYmotPnJlZmNvdW50KTsKIAlvYmotPmhhbmRsZV9jb3VudCA9IDA7CiAJb2JqLT5zaXplID0g
c2l6ZTsKLQlyZXNlcnZhdGlvbl9vYmplY3RfaW5pdCgmb2JqLT5fcmVzdik7CisJZG1hX3Jlc3Zf
aW5pdCgmb2JqLT5fcmVzdik7CiAJaWYgKCFvYmotPnJlc3YpCiAJCW9iai0+cmVzdiA9ICZvYmot
Pl9yZXN2OwogCkBAIC03NTIsNyArNzUyLDcgQEAgZHJtX2dlbV9vYmplY3RfbG9va3VwKHN0cnVj
dCBkcm1fZmlsZSAqZmlscCwgdTMyIGhhbmRsZSkKIEVYUE9SVF9TWU1CT0woZHJtX2dlbV9vYmpl
Y3RfbG9va3VwKTsKIAogLyoqCi0gKiBkcm1fZ2VtX3Jlc2VydmF0aW9uX29iamVjdF93YWl0IC0g
V2FpdCBvbiBHRU0gb2JqZWN0J3MgcmVzZXJ2YXRpb24ncyBvYmplY3RzCisgKiBkcm1fZ2VtX2Rt
YV9yZXN2X3dhaXQgLSBXYWl0IG9uIEdFTSBvYmplY3QncyByZXNlcnZhdGlvbidzIG9iamVjdHMK
ICAqIHNoYXJlZCBhbmQvb3IgZXhjbHVzaXZlIGZlbmNlcy4KICAqIEBmaWxlcDogRFJNIGZpbGUg
cHJpdmF0ZSBkYXRlCiAgKiBAaGFuZGxlOiB1c2Vyc3BhY2UgaGFuZGxlCkBAIC03NjQsNyArNzY0
LDcgQEAgRVhQT1JUX1NZTUJPTChkcm1fZ2VtX29iamVjdF9sb29rdXApOwogICogUmV0dXJucyAt
RVJFU1RBUlRTWVMgaWYgaW50ZXJydXB0ZWQsIDAgaWYgdGhlIHdhaXQgdGltZWQgb3V0LCBvcgog
ICogZ3JlYXRlciB0aGFuIDAgb24gc3VjY2Vzcy4KICAqLwotbG9uZyBkcm1fZ2VtX3Jlc2VydmF0
aW9uX29iamVjdF93YWl0KHN0cnVjdCBkcm1fZmlsZSAqZmlsZXAsIHUzMiBoYW5kbGUsCitsb25n
IGRybV9nZW1fZG1hX3Jlc3Zfd2FpdChzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVwLCB1MzIgaGFuZGxl
LAogCQkJCSAgICBib29sIHdhaXRfYWxsLCB1bnNpZ25lZCBsb25nIHRpbWVvdXQpCiB7CiAJbG9u
ZyByZXQ7CkBAIC03NzYsNyArNzc2LDcgQEAgbG9uZyBkcm1fZ2VtX3Jlc2VydmF0aW9uX29iamVj
dF93YWl0KHN0cnVjdCBkcm1fZmlsZSAqZmlsZXAsIHUzMiBoYW5kbGUsCiAJCXJldHVybiAtRUlO
VkFMOwogCX0KIAotCXJldCA9IHJlc2VydmF0aW9uX29iamVjdF93YWl0X3RpbWVvdXRfcmN1KG9i
ai0+cmVzdiwgd2FpdF9hbGwsCisJcmV0ID0gZG1hX3Jlc3Zfd2FpdF90aW1lb3V0X3JjdShvYmot
PnJlc3YsIHdhaXRfYWxsLAogCQkJCQkJICB0cnVlLCB0aW1lb3V0KTsKIAlpZiAocmV0ID09IDAp
CiAJCXJldCA9IC1FVElNRTsKQEAgLTc4Nyw3ICs3ODcsNyBAQCBsb25nIGRybV9nZW1fcmVzZXJ2
YXRpb25fb2JqZWN0X3dhaXQoc3RydWN0IGRybV9maWxlICpmaWxlcCwgdTMyIGhhbmRsZSwKIAog
CXJldHVybiByZXQ7CiB9Ci1FWFBPUlRfU1lNQk9MKGRybV9nZW1fcmVzZXJ2YXRpb25fb2JqZWN0
X3dhaXQpOworRVhQT1JUX1NZTUJPTChkcm1fZ2VtX2RtYV9yZXN2X3dhaXQpOwogCiAvKioKICAq
IGRybV9nZW1fY2xvc2VfaW9jdGwgLSBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgR0VNX0NMT1NFIGlv
Y3RsCkBAIC05NTMsNyArOTUzLDcgQEAgZHJtX2dlbV9vYmplY3RfcmVsZWFzZShzdHJ1Y3QgZHJt
X2dlbV9vYmplY3QgKm9iaikKIAlpZiAob2JqLT5maWxwKQogCQlmcHV0KG9iai0+ZmlscCk7CiAK
LQlyZXNlcnZhdGlvbl9vYmplY3RfZmluaSgmb2JqLT5fcmVzdik7CisJZG1hX3Jlc3ZfZmluaSgm
b2JqLT5fcmVzdik7CiAJZHJtX2dlbV9mcmVlX21tYXBfb2Zmc2V0KG9iaik7CiB9CiBFWFBPUlRf
U1lNQk9MKGRybV9nZW1fb2JqZWN0X3JlbGVhc2UpOwpAQCAtMTI4OCw3ICsxMjg4LDcgQEAgZHJt
X2dlbV9sb2NrX3Jlc2VydmF0aW9ucyhzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKipvYmpzLCBpbnQg
Y291bnQsCiAJaWYgKGNvbnRlbmRlZCAhPSAtMSkgewogCQlzdHJ1Y3QgZHJtX2dlbV9vYmplY3Qg
Km9iaiA9IG9ianNbY29udGVuZGVkXTsKIAotCQlyZXQgPSByZXNlcnZhdGlvbl9vYmplY3RfbG9j
a19zbG93X2ludGVycnVwdGlibGUob2JqLT5yZXN2LAorCQlyZXQgPSBkbWFfcmVzdl9sb2NrX3Ns
b3dfaW50ZXJydXB0aWJsZShvYmotPnJlc3YsCiAJCQkJCQkJCSBhY3F1aXJlX2N0eCk7CiAJCWlm
IChyZXQpIHsKIAkJCXd3X2FjcXVpcmVfZG9uZShhY3F1aXJlX2N0eCk7CkBAIC0xMzAwLDE2ICsx
MzAwLDE2IEBAIGRybV9nZW1fbG9ja19yZXNlcnZhdGlvbnMoc3RydWN0IGRybV9nZW1fb2JqZWN0
ICoqb2JqcywgaW50IGNvdW50LAogCQlpZiAoaSA9PSBjb250ZW5kZWQpCiAJCQljb250aW51ZTsK
IAotCQlyZXQgPSByZXNlcnZhdGlvbl9vYmplY3RfbG9ja19pbnRlcnJ1cHRpYmxlKG9ianNbaV0t
PnJlc3YsCisJCXJldCA9IGRtYV9yZXN2X2xvY2tfaW50ZXJydXB0aWJsZShvYmpzW2ldLT5yZXN2
LAogCQkJCQkJCSAgICBhY3F1aXJlX2N0eCk7CiAJCWlmIChyZXQpIHsKIAkJCWludCBqOwogCiAJ
CQlmb3IgKGogPSAwOyBqIDwgaTsgaisrKQotCQkJCXJlc2VydmF0aW9uX29iamVjdF91bmxvY2so
b2Jqc1tqXS0+cmVzdik7CisJCQkJZG1hX3Jlc3ZfdW5sb2NrKG9ianNbal0tPnJlc3YpOwogCiAJ
CQlpZiAoY29udGVuZGVkICE9IC0xICYmIGNvbnRlbmRlZCA+PSBpKQotCQkJCXJlc2VydmF0aW9u
X29iamVjdF91bmxvY2sob2Jqc1tjb250ZW5kZWRdLT5yZXN2KTsKKwkJCQlkbWFfcmVzdl91bmxv
Y2sob2Jqc1tjb250ZW5kZWRdLT5yZXN2KTsKIAogCQkJaWYgKHJldCA9PSAtRURFQURMSykgewog
CQkJCWNvbnRlbmRlZCA9IGk7CkBAIC0xMzM0LDcgKzEzMzQsNyBAQCBkcm1fZ2VtX3VubG9ja19y
ZXNlcnZhdGlvbnMoc3RydWN0IGRybV9nZW1fb2JqZWN0ICoqb2JqcywgaW50IGNvdW50LAogCWlu
dCBpOwogCiAJZm9yIChpID0gMDsgaSA8IGNvdW50OyBpKyspCi0JCXJlc2VydmF0aW9uX29iamVj
dF91bmxvY2sob2Jqc1tpXS0+cmVzdik7CisJCWRtYV9yZXN2X3VubG9jayhvYmpzW2ldLT5yZXN2
KTsKIAogCXd3X2FjcXVpcmVfZmluaShhY3F1aXJlX2N0eCk7CiB9CkBAIC0xNDEwLDEyICsxNDEw
LDEyIEBAIGludCBkcm1fZ2VtX2ZlbmNlX2FycmF5X2FkZF9pbXBsaWNpdChzdHJ1Y3QgeGFycmF5
ICpmZW5jZV9hcnJheSwKIAogCWlmICghd3JpdGUpIHsKIAkJc3RydWN0IGRtYV9mZW5jZSAqZmVu
Y2UgPQotCQkJcmVzZXJ2YXRpb25fb2JqZWN0X2dldF9leGNsX3JjdShvYmotPnJlc3YpOworCQkJ
ZG1hX3Jlc3ZfZ2V0X2V4Y2xfcmN1KG9iai0+cmVzdik7CiAKIAkJcmV0dXJuIGRybV9nZW1fZmVu
Y2VfYXJyYXlfYWRkKGZlbmNlX2FycmF5LCBmZW5jZSk7CiAJfQogCi0JcmV0ID0gcmVzZXJ2YXRp
b25fb2JqZWN0X2dldF9mZW5jZXNfcmN1KG9iai0+cmVzdiwgTlVMTCwKKwlyZXQgPSBkbWFfcmVz
dl9nZXRfZmVuY2VzX3JjdShvYmotPnJlc3YsIE5VTEwsCiAJCQkJCQkmZmVuY2VfY291bnQsICZm
ZW5jZXMpOwogCWlmIChyZXQgfHwgIWZlbmNlX2NvdW50KQogCQlyZXR1cm4gcmV0OwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2RybV9nZW1fZnJhbWVidWZmZXJfaGVscGVyLmMgYi9kcml2
ZXJzL2dwdS9kcm0vZHJtX2dlbV9mcmFtZWJ1ZmZlcl9oZWxwZXIuYwppbmRleCBmNjEzMDQwNTQ3
ODYuLmI5YmNkMzEwY2EyZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2RybV9nZW1fZnJh
bWVidWZmZXJfaGVscGVyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2RybV9nZW1fZnJhbWVidWZm
ZXJfaGVscGVyLmMKQEAgLTcsNyArNyw3IEBACiAKICNpbmNsdWRlIDxsaW51eC9kbWEtYnVmLmg+
CiAjaW5jbHVkZSA8bGludXgvZG1hLWZlbmNlLmg+Ci0jaW5jbHVkZSA8bGludXgvcmVzZXJ2YXRp
b24uaD4KKyNpbmNsdWRlIDxsaW51eC9kbWEtcmVzdi5oPgogI2luY2x1ZGUgPGxpbnV4L3NsYWIu
aD4KIAogI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljLmg+CkBAIC0yOTQsNyArMjk0LDcgQEAgaW50
IGRybV9nZW1fZmJfcHJlcGFyZV9mYihzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKIAkJcmV0dXJu
IDA7CiAKIAlvYmogPSBkcm1fZ2VtX2ZiX2dldF9vYmooc3RhdGUtPmZiLCAwKTsKLQlmZW5jZSA9
IHJlc2VydmF0aW9uX29iamVjdF9nZXRfZXhjbF9yY3Uob2JqLT5yZXN2KTsKKwlmZW5jZSA9IGRt
YV9yZXN2X2dldF9leGNsX3JjdShvYmotPnJlc3YpOwogCWRybV9hdG9taWNfc2V0X2ZlbmNlX2Zv
cl9wbGFuZShzdGF0ZSwgZmVuY2UpOwogCiAJcmV0dXJuIDA7CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYv
ZXRuYXZpdl9nZW0uYwppbmRleCAxN2NhNjAyZGI2MGEuLjdkODNlMDRlYzM2ZSAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9nZW0uYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vZXRuYXZpdi9ldG5hdml2X2dlbS5jCkBAIC0zOTcsMTMgKzM5NywxMyBAQCBpbnQgZXRu
YXZpdl9nZW1fY3B1X3ByZXAoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmosIHUzMiBvcCwKIAl9
CiAKIAlpZiAob3AgJiBFVE5BX1BSRVBfTk9TWU5DKSB7Ci0JCWlmICghcmVzZXJ2YXRpb25fb2Jq
ZWN0X3Rlc3Rfc2lnbmFsZWRfcmN1KG9iai0+cmVzdiwKKwkJaWYgKCFkbWFfcmVzdl90ZXN0X3Np
Z25hbGVkX3JjdShvYmotPnJlc3YsCiAJCQkJCQkJICB3cml0ZSkpCiAJCQlyZXR1cm4gLUVCVVNZ
OwogCX0gZWxzZSB7CiAJCXVuc2lnbmVkIGxvbmcgcmVtYWluID0gZXRuYXZpdl90aW1lb3V0X3Rv
X2ppZmZpZXModGltZW91dCk7CiAKLQkJcmV0ID0gcmVzZXJ2YXRpb25fb2JqZWN0X3dhaXRfdGlt
ZW91dF9yY3Uob2JqLT5yZXN2LAorCQlyZXQgPSBkbWFfcmVzdl93YWl0X3RpbWVvdXRfcmN1KG9i
ai0+cmVzdiwKIAkJCQkJCQkgIHdyaXRlLCB0cnVlLCByZW1haW4pOwogCQlpZiAocmV0IDw9IDAp
CiAJCQlyZXR1cm4gcmV0ID09IDAgPyAtRVRJTUVET1VUIDogcmV0OwpAQCAtNDU5LDggKzQ1OSw4
IEBAIHN0YXRpYyB2b2lkIGV0bmF2aXZfZ2VtX2Rlc2NyaWJlX2ZlbmNlKHN0cnVjdCBkbWFfZmVu
Y2UgKmZlbmNlLAogc3RhdGljIHZvaWQgZXRuYXZpdl9nZW1fZGVzY3JpYmUoc3RydWN0IGRybV9n
ZW1fb2JqZWN0ICpvYmosIHN0cnVjdCBzZXFfZmlsZSAqbSkKIHsKIAlzdHJ1Y3QgZXRuYXZpdl9n
ZW1fb2JqZWN0ICpldG5hdml2X29iaiA9IHRvX2V0bmF2aXZfYm8ob2JqKTsKLQlzdHJ1Y3QgcmVz
ZXJ2YXRpb25fb2JqZWN0ICpyb2JqID0gb2JqLT5yZXN2OwotCXN0cnVjdCByZXNlcnZhdGlvbl9v
YmplY3RfbGlzdCAqZm9iajsKKwlzdHJ1Y3QgZG1hX3Jlc3YgKnJvYmogPSBvYmotPnJlc3Y7CisJ
c3RydWN0IGRtYV9yZXN2X2xpc3QgKmZvYmo7CiAJc3RydWN0IGRtYV9mZW5jZSAqZmVuY2U7CiAJ
dW5zaWduZWQgbG9uZyBvZmYgPSBkcm1fdm1hX25vZGVfc3RhcnQoJm9iai0+dm1hX25vZGUpOwog
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2dlbS5oIGIvZHJp
dmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9nZW0uaAppbmRleCBmY2Q1ZDcxYjUwMmYuLjI4
Mzc5ZTRkZjI1MyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9n
ZW0uaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2dlbS5oCkBAIC02LDcg
KzYsNyBAQAogI2lmbmRlZiBfX0VUTkFWSVZfR0VNX0hfXwogI2RlZmluZSBfX0VUTkFWSVZfR0VN
X0hfXwogCi0jaW5jbHVkZSA8bGludXgvcmVzZXJ2YXRpb24uaD4KKyNpbmNsdWRlIDxsaW51eC9k
bWEtcmVzdi5oPgogI2luY2x1ZGUgImV0bmF2aXZfY21kYnVmLmgiCiAjaW5jbHVkZSAiZXRuYXZp
dl9kcnYuaCIKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9n
ZW1fc3VibWl0LmMgYi9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2dlbV9zdWJtaXQu
YwppbmRleCAxYTYzNjQ2OWVlZGEuLjk5OGM5NmI0MGQ4YSAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9nZW1fc3VibWl0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2V0bmF2aXYvZXRuYXZpdl9nZW1fc3VibWl0LmMKQEAgLTQsNyArNCw3IEBACiAgKi8KIAogI2lu
Y2x1ZGUgPGxpbnV4L2RtYS1mZW5jZS1hcnJheS5oPgotI2luY2x1ZGUgPGxpbnV4L3Jlc2VydmF0
aW9uLmg+CisjaW5jbHVkZSA8bGludXgvZG1hLXJlc3YuaD4KICNpbmNsdWRlIDxsaW51eC9zeW5j
X2ZpbGUuaD4KICNpbmNsdWRlICJldG5hdml2X2NtZGJ1Zi5oIgogI2luY2x1ZGUgImV0bmF2aXZf
ZHJ2LmgiCkBAIC0xNjUsMTAgKzE2NSwxMCBAQCBzdGF0aWMgaW50IHN1Ym1pdF9mZW5jZV9zeW5j
KHN0cnVjdCBldG5hdml2X2dlbV9zdWJtaXQgKnN1Ym1pdCkKIAogCWZvciAoaSA9IDA7IGkgPCBz
dWJtaXQtPm5yX2JvczsgaSsrKSB7CiAJCXN0cnVjdCBldG5hdml2X2dlbV9zdWJtaXRfYm8gKmJv
ID0gJnN1Ym1pdC0+Ym9zW2ldOwotCQlzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyb2JqID0g
Ym8tPm9iai0+YmFzZS5yZXN2OworCQlzdHJ1Y3QgZG1hX3Jlc3YgKnJvYmogPSBiby0+b2JqLT5i
YXNlLnJlc3Y7CiAKIAkJaWYgKCEoYm8tPmZsYWdzICYgRVROQV9TVUJNSVRfQk9fV1JJVEUpKSB7
Ci0JCQlyZXQgPSByZXNlcnZhdGlvbl9vYmplY3RfcmVzZXJ2ZV9zaGFyZWQocm9iaiwgMSk7CisJ
CQlyZXQgPSBkbWFfcmVzdl9yZXNlcnZlX3NoYXJlZChyb2JqLCAxKTsKIAkJCWlmIChyZXQpCiAJ
CQkJcmV0dXJuIHJldDsKIAkJfQpAQCAtMTc3LDEzICsxNzcsMTMgQEAgc3RhdGljIGludCBzdWJt
aXRfZmVuY2Vfc3luYyhzdHJ1Y3QgZXRuYXZpdl9nZW1fc3VibWl0ICpzdWJtaXQpCiAJCQljb250
aW51ZTsKIAogCQlpZiAoYm8tPmZsYWdzICYgRVROQV9TVUJNSVRfQk9fV1JJVEUpIHsKLQkJCXJl
dCA9IHJlc2VydmF0aW9uX29iamVjdF9nZXRfZmVuY2VzX3JjdShyb2JqLCAmYm8tPmV4Y2wsCisJ
CQlyZXQgPSBkbWFfcmVzdl9nZXRfZmVuY2VzX3JjdShyb2JqLCAmYm8tPmV4Y2wsCiAJCQkJCQkJ
CSZiby0+bnJfc2hhcmVkLAogCQkJCQkJCQkmYm8tPnNoYXJlZCk7CiAJCQlpZiAocmV0KQogCQkJ
CXJldHVybiByZXQ7CiAJCX0gZWxzZSB7Ci0JCQliby0+ZXhjbCA9IHJlc2VydmF0aW9uX29iamVj
dF9nZXRfZXhjbF9yY3Uocm9iaik7CisJCQliby0+ZXhjbCA9IGRtYV9yZXN2X2dldF9leGNsX3Jj
dShyb2JqKTsKIAkJfQogCiAJfQpAQCAtMTk5LDEwICsxOTksMTAgQEAgc3RhdGljIHZvaWQgc3Vi
bWl0X2F0dGFjaF9vYmplY3RfZmVuY2VzKHN0cnVjdCBldG5hdml2X2dlbV9zdWJtaXQgKnN1Ym1p
dCkKIAkJc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmogPSAmc3VibWl0LT5ib3NbaV0ub2JqLT5i
YXNlOwogCiAJCWlmIChzdWJtaXQtPmJvc1tpXS5mbGFncyAmIEVUTkFfU1VCTUlUX0JPX1dSSVRF
KQotCQkJcmVzZXJ2YXRpb25fb2JqZWN0X2FkZF9leGNsX2ZlbmNlKG9iai0+cmVzdiwKKwkJCWRt
YV9yZXN2X2FkZF9leGNsX2ZlbmNlKG9iai0+cmVzdiwKIAkJCQkJCQkgIHN1Ym1pdC0+b3V0X2Zl
bmNlKTsKIAkJZWxzZQotCQkJcmVzZXJ2YXRpb25fb2JqZWN0X2FkZF9zaGFyZWRfZmVuY2Uob2Jq
LT5yZXN2LAorCQkJZG1hX3Jlc3ZfYWRkX3NoYXJlZF9mZW5jZShvYmotPnJlc3YsCiAJCQkJCQkJ
ICAgIHN1Ym1pdC0+b3V0X2ZlbmNlKTsKIAogCQlzdWJtaXRfdW5sb2NrX29iamVjdChzdWJtaXQs
IGkpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNw
bGF5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwppbmRl
eCA4NTkyYTdkNDIyZGUuLjIxYzcxZmRjZWVjMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKQEAgLTI5LDcgKzI5LDcgQEAKICNpbmNsdWRlIDxsaW51
eC9pbnRlbC1pb21tdS5oPgogI2luY2x1ZGUgPGxpbnV4L2tlcm5lbC5oPgogI2luY2x1ZGUgPGxp
bnV4L21vZHVsZS5oPgotI2luY2x1ZGUgPGxpbnV4L3Jlc2VydmF0aW9uLmg+CisjaW5jbHVkZSA8
bGludXgvZG1hLXJlc3YuaD4KICNpbmNsdWRlIDxsaW51eC9zbGFiLmg+CiAjaW5jbHVkZSA8bGlu
dXgvdmdhYXJiLmg+CiAKQEAgLTE0MzE3LDcgKzE0MzE3LDcgQEAgaW50ZWxfcHJlcGFyZV9wbGFu
ZV9mYihzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKIAkJaWYgKHJldCA8IDApCiAJCQlyZXR1cm4g
cmV0OwogCi0JCWZlbmNlID0gcmVzZXJ2YXRpb25fb2JqZWN0X2dldF9leGNsX3JjdShvYmotPmJh
c2UucmVzdik7CisJCWZlbmNlID0gZG1hX3Jlc3ZfZ2V0X2V4Y2xfcmN1KG9iai0+YmFzZS5yZXN2
KTsKIAkJaWYgKGZlbmNlKSB7CiAJCQlhZGRfcnBzX2Jvb3N0X2FmdGVyX3ZibGFuayhuZXdfc3Rh
dGUtPmNydGMsIGZlbmNlKTsKIAkJCWRtYV9mZW5jZV9wdXQoZmVuY2UpOwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2J1c3kuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9idXN5LmMKaW5kZXggODQ3MzI5MjA5NmNiLi5hMmFmZjFkODI5
MGUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9idXN5LmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2J1c3kuYwpAQCAtODIsNyAr
ODIsNyBAQCBpOTE1X2dlbV9idXN5X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQg
KmRhdGEsCiB7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9idXN5ICphcmdzID0gZGF0YTsKIAlzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwotCXN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3Rf
bGlzdCAqbGlzdDsKKwlzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCAqbGlzdDsKIAl1bnNpZ25lZCBpbnQg
aSwgc2hhcmVkX2NvdW50OwogCXN0cnVjdCBkbWFfZmVuY2UgKmV4Y2w7CiAJaW50IGVycjsKQEAg
LTEwNiwxMSArMTA2LDExIEBAIGk5MTVfZ2VtX2J1c3lfaW9jdGwoc3RydWN0IGRybV9kZXZpY2Ug
KmRldiwgdm9pZCAqZGF0YSwKIAkgKiBBbHRlcm5hdGl2ZWx5LCB3ZSBjYW4gdHJhZGUgdGhhdCBl
eHRyYSBpbmZvcm1hdGlvbiBvbiByZWFkL3dyaXRlCiAJICogYWN0aXZpdHkgd2l0aAogCSAqCWFy
Z3MtPmJ1c3kgPQotCSAqCQkhcmVzZXJ2YXRpb25fb2JqZWN0X3Rlc3Rfc2lnbmFsZWRfcmN1KG9i
ai0+cmVzdiwgdHJ1ZSk7CisJICoJCSFkbWFfcmVzdl90ZXN0X3NpZ25hbGVkX3JjdShvYmotPnJl
c3YsIHRydWUpOwogCSAqIHRvIHJlcG9ydCB0aGUgb3ZlcmFsbCBidXN5bmVzcy4gVGhpcyBpcyB3
aGF0IHRoZSB3YWl0LWlvY3RsIGRvZXMuCiAJICoKIAkgKi8KLQlyZXNlcnZhdGlvbl9vYmplY3Rf
ZmVuY2VzKG9iai0+YmFzZS5yZXN2LCAmZXhjbCwgJmxpc3QsICZzaGFyZWRfY291bnQpOworCWRt
YV9yZXN2X2ZlbmNlcyhvYmotPmJhc2UucmVzdiwgJmV4Y2wsICZsaXN0LCAmc2hhcmVkX2NvdW50
KTsKIAogCS8qIFRyYW5zbGF0ZSB0aGUgZXhjbHVzaXZlIGZlbmNlIHRvIHRoZSBSRUFEICphbmQq
IFdSSVRFIGVuZ2luZSAqLwogCWFyZ3MtPmJ1c3kgPSBidXN5X2NoZWNrX3dyaXRlcihleGNsKTsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jbGZsdXNoLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xmbHVzaC5jCmluZGV4IDUyOTUy
ODVkNTg0My4uODhlZThjYTc5NjdmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fY2xmbHVzaC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV9jbGZsdXNoLmMKQEAgLTE0Nyw3ICsxNDcsNyBAQCBib29sIGk5MTVfZ2VtX2NsZmx1c2hf
b2JqZWN0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJCQkJCQl0cnVlLCBJOTE1
X0ZFTkNFX1RJTUVPVVQsCiAJCQkJCQlJOTE1X0ZFTkNFX0dGUCk7CiAKLQkJcmVzZXJ2YXRpb25f
b2JqZWN0X2FkZF9leGNsX2ZlbmNlKG9iai0+YmFzZS5yZXN2LAorCQlkbWFfcmVzdl9hZGRfZXhj
bF9mZW5jZShvYmotPmJhc2UucmVzdiwKIAkJCQkJCSAgJmNsZmx1c2gtPmRtYSk7CiAKIAkJaTkx
NV9zd19mZW5jZV9jb21taXQoJmNsZmx1c2gtPndhaXQpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NsaWVudF9ibHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9jbGllbnRfYmx0LmMKaW5kZXggMWZkYWIwNzY3YTQ3Li42OTNmY2Zj
ZTVkNjkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jbGll
bnRfYmx0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NsaWVudF9i
bHQuYwpAQCAtMjg4LDcgKzI4OCw3IEBAIGludCBpOTE1X2dlbV9zY2hlZHVsZV9maWxsX3BhZ2Vz
X2JsdChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCWlmIChlcnIgPCAwKSB7CiAJ
CWRtYV9mZW5jZV9zZXRfZXJyb3IoJndvcmstPmRtYSwgZXJyKTsKIAl9IGVsc2UgewotCQlyZXNl
cnZhdGlvbl9vYmplY3RfYWRkX2V4Y2xfZmVuY2Uob2JqLT5iYXNlLnJlc3YsICZ3b3JrLT5kbWEp
OworCQlkbWFfcmVzdl9hZGRfZXhjbF9mZW5jZShvYmotPmJhc2UucmVzdiwgJndvcmstPmRtYSk7
CiAJCWVyciA9IDA7CiAJfQogCWk5MTVfZ2VtX29iamVjdF91bmxvY2sob2JqKTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9kbWFidWYuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9kbWFidWYuYwppbmRleCA1NzBiMjBhZDllNTguLjk2
Y2U5NWM4YWM1YSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X2RtYWJ1Zi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9kbWFidWYu
YwpAQCAtNiw3ICs2LDcgQEAKIAogI2luY2x1ZGUgPGxpbnV4L2RtYS1idWYuaD4KICNpbmNsdWRl
IDxsaW51eC9oaWdobWVtLmg+Ci0jaW5jbHVkZSA8bGludXgvcmVzZXJ2YXRpb24uaD4KKyNpbmNs
dWRlIDxsaW51eC9kbWEtcmVzdi5oPgogCiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKICNpbmNsdWRl
ICJpOTE1X2dlbV9vYmplY3QuaCIKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9leGVjYnVmZmVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fZXhlY2J1ZmZlci5jCmluZGV4IDVmYWUwZTUwYWFkMC4uMmQ3MTY1M2VkZTAwIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKQEAgLTUsNyAr
NSw3IEBACiAgKi8KIAogI2luY2x1ZGUgPGxpbnV4L2ludGVsLWlvbW11Lmg+Ci0jaW5jbHVkZSA8
bGludXgvcmVzZXJ2YXRpb24uaD4KKyNpbmNsdWRlIDxsaW51eC9kbWEtcmVzdi5oPgogI2luY2x1
ZGUgPGxpbnV4L3N5bmNfZmlsZS5oPgogI2luY2x1ZGUgPGxpbnV4L3VhY2Nlc3MuaD4KIApAQCAt
MTI0Niw3ICsxMjQ2LDcgQEAgc3RhdGljIGludCBfX3JlbG9jX2dwdV9hbGxvYyhzdHJ1Y3QgaTkx
NV9leGVjYnVmZmVyICplYiwKIAkJZ290byBza2lwX3JlcXVlc3Q7CiAKIAlpOTE1X3ZtYV9sb2Nr
KGJhdGNoKTsKLQlHRU1fQlVHX09OKCFyZXNlcnZhdGlvbl9vYmplY3RfdGVzdF9zaWduYWxlZF9y
Y3UoYmF0Y2gtPnJlc3YsIHRydWUpKTsKKwlHRU1fQlVHX09OKCFkbWFfcmVzdl90ZXN0X3NpZ25h
bGVkX3JjdShiYXRjaC0+cmVzdiwgdHJ1ZSkpOwogCWVyciA9IGk5MTVfdm1hX21vdmVfdG9fYWN0
aXZlKGJhdGNoLCBycSwgMCk7CiAJaTkxNV92bWFfdW5sb2NrKGJhdGNoKTsKIAlpZiAoZXJyKQpA
QCAtMTMxNyw3ICsxMzE3LDcgQEAgcmVsb2NhdGVfZW50cnkoc3RydWN0IGk5MTVfdm1hICp2bWEs
CiAKIAlpZiAoIWViLT5yZWxvY19jYWNoZS52YWRkciAmJgogCSAgICAoREJHX0ZPUkNFX1JFTE9D
ID09IEZPUkNFX0dQVV9SRUxPQyB8fAotCSAgICAgIXJlc2VydmF0aW9uX29iamVjdF90ZXN0X3Np
Z25hbGVkX3JjdSh2bWEtPnJlc3YsIHRydWUpKSkgeworCSAgICAgIWRtYV9yZXN2X3Rlc3Rfc2ln
bmFsZWRfcmN1KHZtYS0+cmVzdiwgdHJ1ZSkpKSB7CiAJCWNvbnN0IHVuc2lnbmVkIGludCBnZW4g
PSBlYi0+cmVsb2NfY2FjaGUuZ2VuOwogCQl1bnNpZ25lZCBpbnQgbGVuOwogCQl1MzIgKmJhdGNo
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2ZlbmNlLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZmVuY2UuYwppbmRleCBjZjA0Mzll
NmJlODMuLjU0OTZmMzNhOTA2NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX2ZlbmNlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X2ZlbmNlLmMKQEAgLTc4LDcgKzc4LDcgQEAgaTkxNV9nZW1fb2JqZWN0X2xvY2tfZmVuY2Uoc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIAkJCQkJICAgIEk5MTVfRkVOQ0VfR0ZQKSA8
IDApCiAJCWdvdG8gZXJyOwogCi0JcmVzZXJ2YXRpb25fb2JqZWN0X2FkZF9leGNsX2ZlbmNlKG9i
ai0+YmFzZS5yZXN2LCAmc3R1Yi0+ZG1hKTsKKwlkbWFfcmVzdl9hZGRfZXhjbF9mZW5jZShvYmot
PmJhc2UucmVzdiwgJnN0dWItPmRtYSk7CiAKIAlyZXR1cm4gJnN0dWItPmRtYTsKIApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oCmluZGV4IGRmZWJkNTcwNmYxNi4u
ZDVmOGZkYzk1ZmQ5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fb2JqZWN0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVj
dC5oCkBAIC05OSwyMiArOTksMjIgQEAgaTkxNV9nZW1fb2JqZWN0X3B1dChzdHJ1Y3QgZHJtX2k5
MTVfZ2VtX29iamVjdCAqb2JqKQogCV9fZHJtX2dlbV9vYmplY3RfcHV0KCZvYmotPmJhc2UpOwog
fQogCi0jZGVmaW5lIGFzc2VydF9vYmplY3RfaGVsZChvYmopIHJlc2VydmF0aW9uX29iamVjdF9h
c3NlcnRfaGVsZCgob2JqKS0+YmFzZS5yZXN2KQorI2RlZmluZSBhc3NlcnRfb2JqZWN0X2hlbGQo
b2JqKSBkbWFfcmVzdl9hc3NlcnRfaGVsZCgob2JqKS0+YmFzZS5yZXN2KQogCiBzdGF0aWMgaW5s
aW5lIHZvaWQgaTkxNV9nZW1fb2JqZWN0X2xvY2soc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iaikKIHsKLQlyZXNlcnZhdGlvbl9vYmplY3RfbG9jayhvYmotPmJhc2UucmVzdiwgTlVMTCk7
CisJZG1hX3Jlc3ZfbG9jayhvYmotPmJhc2UucmVzdiwgTlVMTCk7CiB9CiAKIHN0YXRpYyBpbmxp
bmUgaW50CiBpOTE1X2dlbV9vYmplY3RfbG9ja19pbnRlcnJ1cHRpYmxlKHN0cnVjdCBkcm1faTkx
NV9nZW1fb2JqZWN0ICpvYmopCiB7Ci0JcmV0dXJuIHJlc2VydmF0aW9uX29iamVjdF9sb2NrX2lu
dGVycnVwdGlibGUob2JqLT5iYXNlLnJlc3YsIE5VTEwpOworCXJldHVybiBkbWFfcmVzdl9sb2Nr
X2ludGVycnVwdGlibGUob2JqLT5iYXNlLnJlc3YsIE5VTEwpOwogfQogCiBzdGF0aWMgaW5saW5l
IHZvaWQgaTkxNV9nZW1fb2JqZWN0X3VubG9jayhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAq
b2JqKQogewotCXJlc2VydmF0aW9uX29iamVjdF91bmxvY2sob2JqLT5iYXNlLnJlc3YpOworCWRt
YV9yZXN2X3VubG9jayhvYmotPmJhc2UucmVzdik7CiB9CiAKIHN0cnVjdCBkbWFfZmVuY2UgKgpA
QCAtMzczLDcgKzM3Myw3IEBAIGk5MTVfZ2VtX29iamVjdF9sYXN0X3dyaXRlX2VuZ2luZShzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogCXN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlOwog
CiAJcmN1X3JlYWRfbG9jaygpOwotCWZlbmNlID0gcmVzZXJ2YXRpb25fb2JqZWN0X2dldF9leGNs
X3JjdShvYmotPmJhc2UucmVzdik7CisJZmVuY2UgPSBkbWFfcmVzdl9nZXRfZXhjbF9yY3Uob2Jq
LT5iYXNlLnJlc3YpOwogCXJjdV9yZWFkX3VubG9jaygpOwogCiAJaWYgKGZlbmNlICYmIGRtYV9m
ZW5jZV9pc19pOTE1KGZlbmNlKSAmJiAhZG1hX2ZlbmNlX2lzX3NpZ25hbGVkKGZlbmNlKSkKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV93YWl0LmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fd2FpdC5jCmluZGV4IGZhNDZhNTRiY2JlNy4u
OGFmNTVjZDNlNjkwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fd2FpdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV93YWl0LmMK
QEAgLTMxLDcgKzMxLDcgQEAgaTkxNV9nZW1fb2JqZWN0X3dhaXRfZmVuY2Uoc3RydWN0IGRtYV9m
ZW5jZSAqZmVuY2UsCiB9CiAKIHN0YXRpYyBsb25nCi1pOTE1X2dlbV9vYmplY3Rfd2FpdF9yZXNl
cnZhdGlvbihzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyZXN2LAoraTkxNV9nZW1fb2JqZWN0
X3dhaXRfcmVzZXJ2YXRpb24oc3RydWN0IGRtYV9yZXN2ICpyZXN2LAogCQkJCSB1bnNpZ25lZCBp
bnQgZmxhZ3MsCiAJCQkJIGxvbmcgdGltZW91dCkKIHsKQEAgLTQzLDcgKzQzLDcgQEAgaTkxNV9n
ZW1fb2JqZWN0X3dhaXRfcmVzZXJ2YXRpb24oc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVz
diwKIAkJdW5zaWduZWQgaW50IGNvdW50LCBpOwogCQlpbnQgcmV0OwogCi0JCXJldCA9IHJlc2Vy
dmF0aW9uX29iamVjdF9nZXRfZmVuY2VzX3JjdShyZXN2LAorCQlyZXQgPSBkbWFfcmVzdl9nZXRf
ZmVuY2VzX3JjdShyZXN2LAogCQkJCQkJCSZleGNsLCAmY291bnQsICZzaGFyZWQpOwogCQlpZiAo
cmV0KQogCQkJcmV0dXJuIHJldDsKQEAgLTcyLDcgKzcyLDcgQEAgaTkxNV9nZW1fb2JqZWN0X3dh
aXRfcmVzZXJ2YXRpb24oc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdiwKIAkJICovCiAJ
CXBydW5lX2ZlbmNlcyA9IGNvdW50ICYmIHRpbWVvdXQgPj0gMDsKIAl9IGVsc2UgewotCQlleGNs
ID0gcmVzZXJ2YXRpb25fb2JqZWN0X2dldF9leGNsX3JjdShyZXN2KTsKKwkJZXhjbCA9IGRtYV9y
ZXN2X2dldF9leGNsX3JjdShyZXN2KTsKIAl9CiAKIAlpZiAoZXhjbCAmJiB0aW1lb3V0ID49IDAp
CkBAIC04NCwxMCArODQsMTAgQEAgaTkxNV9nZW1fb2JqZWN0X3dhaXRfcmVzZXJ2YXRpb24oc3Ry
dWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdiwKIAkgKiBPcHBvcnR1bmlzdGljYWxseSBwcnVu
ZSB0aGUgZmVuY2VzIGlmZiB3ZSBrbm93IHRoZXkgaGF2ZSAqYWxsKiBiZWVuCiAJICogc2lnbmFs
ZWQuCiAJICovCi0JaWYgKHBydW5lX2ZlbmNlcyAmJiByZXNlcnZhdGlvbl9vYmplY3RfdHJ5bG9j
ayhyZXN2KSkgewotCQlpZiAocmVzZXJ2YXRpb25fb2JqZWN0X3Rlc3Rfc2lnbmFsZWRfcmN1KHJl
c3YsIHRydWUpKQotCQkJcmVzZXJ2YXRpb25fb2JqZWN0X2FkZF9leGNsX2ZlbmNlKHJlc3YsIE5V
TEwpOwotCQlyZXNlcnZhdGlvbl9vYmplY3RfdW5sb2NrKHJlc3YpOworCWlmIChwcnVuZV9mZW5j
ZXMgJiYgZG1hX3Jlc3ZfdHJ5bG9jayhyZXN2KSkgeworCQlpZiAoZG1hX3Jlc3ZfdGVzdF9zaWdu
YWxlZF9yY3UocmVzdiwgdHJ1ZSkpCisJCQlkbWFfcmVzdl9hZGRfZXhjbF9mZW5jZShyZXN2LCBO
VUxMKTsKKwkJZG1hX3Jlc3ZfdW5sb2NrKHJlc3YpOwogCX0KIAogCXJldHVybiB0aW1lb3V0OwpA
QCAtMTQwLDcgKzE0MCw3IEBAIGk5MTVfZ2VtX29iamVjdF93YWl0X3ByaW9yaXR5KHN0cnVjdCBk
cm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJCXVuc2lnbmVkIGludCBjb3VudCwgaTsKIAkJaW50
IHJldDsKIAotCQlyZXQgPSByZXNlcnZhdGlvbl9vYmplY3RfZ2V0X2ZlbmNlc19yY3Uob2JqLT5i
YXNlLnJlc3YsCisJCXJldCA9IGRtYV9yZXN2X2dldF9mZW5jZXNfcmN1KG9iai0+YmFzZS5yZXN2
LAogCQkJCQkJCSZleGNsLCAmY291bnQsICZzaGFyZWQpOwogCQlpZiAocmV0KQogCQkJcmV0dXJu
IHJldDsKQEAgLTE1Miw3ICsxNTIsNyBAQCBpOTE1X2dlbV9vYmplY3Rfd2FpdF9wcmlvcml0eShz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCiAJCWtmcmVlKHNoYXJlZCk7CiAJfSBl
bHNlIHsKLQkJZXhjbCA9IHJlc2VydmF0aW9uX29iamVjdF9nZXRfZXhjbF9yY3Uob2JqLT5iYXNl
LnJlc3YpOworCQlleGNsID0gZG1hX3Jlc3ZfZ2V0X2V4Y2xfcmN1KG9iai0+YmFzZS5yZXN2KTsK
IAl9CiAKIAlpZiAoZXhjbCkgewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKaW5kZXggYmRkNTk2NjA0
ZTkzLi5iNjJkYjIyYjM3YTEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
ZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaApAQCAtNDMsNyArNDMs
NyBAQAogI2luY2x1ZGUgPGxpbnV4L21tX3R5cGVzLmg+CiAjaW5jbHVkZSA8bGludXgvcGVyZl9l
dmVudC5oPgogI2luY2x1ZGUgPGxpbnV4L3BtX3Fvcy5oPgotI2luY2x1ZGUgPGxpbnV4L3Jlc2Vy
dmF0aW9uLmg+CisjaW5jbHVkZSA8bGludXgvZG1hLXJlc3YuaD4KICNpbmNsdWRlIDxsaW51eC9z
aG1lbV9mcy5oPgogI2luY2x1ZGUgPGxpbnV4L3N0YWNrZGVwb3QuaD4KIApkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfZ2VtLmMKaW5kZXggMTkwYWQ1NGZiMDcyLi5hNWE0MzljYjhjMDYgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9nZW0uYwpAQCAtMjksNyArMjksNyBAQAogI2luY2x1ZGUgPGRybS9pOTE1X2RybS5oPgog
I2luY2x1ZGUgPGxpbnV4L2RtYS1mZW5jZS1hcnJheS5oPgogI2luY2x1ZGUgPGxpbnV4L2t0aHJl
YWQuaD4KLSNpbmNsdWRlIDxsaW51eC9yZXNlcnZhdGlvbi5oPgorI2luY2x1ZGUgPGxpbnV4L2Rt
YS1yZXN2Lmg+CiAjaW5jbHVkZSA8bGludXgvc2htZW1fZnMuaD4KICNpbmNsdWRlIDxsaW51eC9z
bGFiLmg+CiAjaW5jbHVkZSA8bGludXgvc3RvcF9tYWNoaW5lLmg+CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9iYXRjaF9wb29sLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2dlbV9iYXRjaF9wb29sLmMKaW5kZXggMjVhM2U0ZDA5YTJmLi41ZjgyYTc2M2U2
NGMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2JhdGNoX3Bvb2wu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9iYXRjaF9wb29sLmMKQEAgLTk2
LDkgKzk2LDkgQEAgaTkxNV9nZW1fYmF0Y2hfcG9vbF9nZXQoc3RydWN0IGk5MTVfZ2VtX2JhdGNo
X3Bvb2wgKnBvb2wsCiAJbGlzdF9mb3JfZWFjaF9lbnRyeShvYmosIGxpc3QsIGJhdGNoX3Bvb2xf
bGluaykgewogCQkvKiBUaGUgYmF0Y2hlcyBhcmUgc3RyaWN0bHkgTFJVIG9yZGVyZWQgKi8KIAkJ
aWYgKGk5MTVfZ2VtX29iamVjdF9pc19hY3RpdmUob2JqKSkgewotCQkJc3RydWN0IHJlc2VydmF0
aW9uX29iamVjdCAqcmVzdiA9IG9iai0+YmFzZS5yZXN2OworCQkJc3RydWN0IGRtYV9yZXN2ICpy
ZXN2ID0gb2JqLT5iYXNlLnJlc3Y7CiAKLQkJCWlmICghcmVzZXJ2YXRpb25fb2JqZWN0X3Rlc3Rf
c2lnbmFsZWRfcmN1KHJlc3YsIHRydWUpKQorCQkJaWYgKCFkbWFfcmVzdl90ZXN0X3NpZ25hbGVk
X3JjdShyZXN2LCB0cnVlKSkKIAkJCQlicmVhazsKIAogCQkJaTkxNV9yZXRpcmVfcmVxdWVzdHMo
cG9vbC0+ZW5naW5lLT5pOTE1KTsKQEAgLTExMywxMyArMTEzLDEzIEBAIGk5MTVfZ2VtX2JhdGNo
X3Bvb2xfZ2V0KHN0cnVjdCBpOTE1X2dlbV9iYXRjaF9wb29sICpwb29sLAogCQkJICogdGhhbiBy
ZXBsYWNlIHRoZSBleGlzdGluZyBmZW5jZS4KIAkJCSAqLwogCQkJaWYgKHJjdV9hY2Nlc3NfcG9p
bnRlcihyZXN2LT5mZW5jZSkpIHsKLQkJCQlyZXNlcnZhdGlvbl9vYmplY3RfbG9jayhyZXN2LCBO
VUxMKTsKLQkJCQlyZXNlcnZhdGlvbl9vYmplY3RfYWRkX2V4Y2xfZmVuY2UocmVzdiwgTlVMTCk7
Ci0JCQkJcmVzZXJ2YXRpb25fb2JqZWN0X3VubG9jayhyZXN2KTsKKwkJCQlkbWFfcmVzdl9sb2Nr
KHJlc3YsIE5VTEwpOworCQkJCWRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlKHJlc3YsIE5VTEwpOwor
CQkJCWRtYV9yZXN2X3VubG9jayhyZXN2KTsKIAkJCX0KIAkJfQogCi0JCUdFTV9CVUdfT04oIXJl
c2VydmF0aW9uX29iamVjdF90ZXN0X3NpZ25hbGVkX3JjdShvYmotPmJhc2UucmVzdiwKKwkJR0VN
X0JVR19PTighZG1hX3Jlc3ZfdGVzdF9zaWduYWxlZF9yY3Uob2JqLT5iYXNlLnJlc3YsCiAJCQkJ
CQkJCSB0cnVlKSk7CiAKIAkJaWYgKG9iai0+YmFzZS5zaXplID49IHNpemUpCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfcmVxdWVzdC5jCmluZGV4IGExOTVhOTJkMDEwNS4uMGQxYmQzZjU2YzIxIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYwpAQCAtMTAyNyw3ICsxMDI3LDcgQEAgaTkxNV9y
ZXF1ZXN0X2F3YWl0X29iamVjdChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICp0bywKIAkJc3RydWN0IGRt
YV9mZW5jZSAqKnNoYXJlZDsKIAkJdW5zaWduZWQgaW50IGNvdW50LCBpOwogCi0JCXJldCA9IHJl
c2VydmF0aW9uX29iamVjdF9nZXRfZmVuY2VzX3JjdShvYmotPmJhc2UucmVzdiwKKwkJcmV0ID0g
ZG1hX3Jlc3ZfZ2V0X2ZlbmNlc19yY3Uob2JqLT5iYXNlLnJlc3YsCiAJCQkJCQkJJmV4Y2wsICZj
b3VudCwgJnNoYXJlZCk7CiAJCWlmIChyZXQpCiAJCQlyZXR1cm4gcmV0OwpAQCAtMTA0NCw3ICsx
MDQ0LDcgQEAgaTkxNV9yZXF1ZXN0X2F3YWl0X29iamVjdChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICp0
bywKIAkJCWRtYV9mZW5jZV9wdXQoc2hhcmVkW2ldKTsKIAkJa2ZyZWUoc2hhcmVkKTsKIAl9IGVs
c2UgewotCQlleGNsID0gcmVzZXJ2YXRpb25fb2JqZWN0X2dldF9leGNsX3JjdShvYmotPmJhc2Uu
cmVzdik7CisJCWV4Y2wgPSBkbWFfcmVzdl9nZXRfZXhjbF9yY3Uob2JqLT5iYXNlLnJlc3YpOwog
CX0KIAogCWlmIChleGNsKSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3N3X2ZlbmNlLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N3X2ZlbmNlLmMKaW5kZXgg
NTM4N2FhZmQzNDI0Li4zNjJlNGUwMGI0YzYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfc3dfZmVuY2UuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N3X2Zl
bmNlLmMKQEAgLTcsNyArNyw3IEBACiAjaW5jbHVkZSA8bGludXgvc2xhYi5oPgogI2luY2x1ZGUg
PGxpbnV4L2RtYS1mZW5jZS5oPgogI2luY2x1ZGUgPGxpbnV4L2lycV93b3JrLmg+Ci0jaW5jbHVk
ZSA8bGludXgvcmVzZXJ2YXRpb24uaD4KKyNpbmNsdWRlIDxsaW51eC9kbWEtcmVzdi5oPgogCiAj
aW5jbHVkZSAiaTkxNV9zd19mZW5jZS5oIgogI2luY2x1ZGUgImk5MTVfc2VsZnRlc3QuaCIKQEAg
LTUxMCw3ICs1MTAsNyBAQCBpbnQgX19pOTE1X3N3X2ZlbmNlX2F3YWl0X2RtYV9mZW5jZShzdHJ1
Y3QgaTkxNV9zd19mZW5jZSAqZmVuY2UsCiB9CiAKIGludCBpOTE1X3N3X2ZlbmNlX2F3YWl0X3Jl
c2VydmF0aW9uKHN0cnVjdCBpOTE1X3N3X2ZlbmNlICpmZW5jZSwKLQkJCQkgICAgc3RydWN0IHJl
c2VydmF0aW9uX29iamVjdCAqcmVzdiwKKwkJCQkgICAgc3RydWN0IGRtYV9yZXN2ICpyZXN2LAog
CQkJCSAgICBjb25zdCBzdHJ1Y3QgZG1hX2ZlbmNlX29wcyAqZXhjbHVkZSwKIAkJCQkgICAgYm9v
bCB3cml0ZSwKIAkJCQkgICAgdW5zaWduZWQgbG9uZyB0aW1lb3V0LApAQCAtNTI2LDcgKzUyNiw3
IEBAIGludCBpOTE1X3N3X2ZlbmNlX2F3YWl0X3Jlc2VydmF0aW9uKHN0cnVjdCBpOTE1X3N3X2Zl
bmNlICpmZW5jZSwKIAkJc3RydWN0IGRtYV9mZW5jZSAqKnNoYXJlZDsKIAkJdW5zaWduZWQgaW50
IGNvdW50LCBpOwogCi0JCXJldCA9IHJlc2VydmF0aW9uX29iamVjdF9nZXRfZmVuY2VzX3JjdShy
ZXN2LAorCQlyZXQgPSBkbWFfcmVzdl9nZXRfZmVuY2VzX3JjdShyZXN2LAogCQkJCQkJCSZleGNs
LCAmY291bnQsICZzaGFyZWQpOwogCQlpZiAocmV0KQogCQkJcmV0dXJuIHJldDsKQEAgLTU1MSw3
ICs1NTEsNyBAQCBpbnQgaTkxNV9zd19mZW5jZV9hd2FpdF9yZXNlcnZhdGlvbihzdHJ1Y3QgaTkx
NV9zd19mZW5jZSAqZmVuY2UsCiAJCQlkbWFfZmVuY2VfcHV0KHNoYXJlZFtpXSk7CiAJCWtmcmVl
KHNoYXJlZCk7CiAJfSBlbHNlIHsKLQkJZXhjbCA9IHJlc2VydmF0aW9uX29iamVjdF9nZXRfZXhj
bF9yY3UocmVzdik7CisJCWV4Y2wgPSBkbWFfcmVzdl9nZXRfZXhjbF9yY3UocmVzdik7CiAJfQog
CiAJaWYgKHJldCA+PSAwICYmIGV4Y2wgJiYgZXhjbC0+b3BzICE9IGV4Y2x1ZGUpIHsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc3dfZmVuY2UuaCBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfc3dfZmVuY2UuaAppbmRleCA5Y2I1YzNiMzA3YTYuLjhjZjM1M2U4YzNl
MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zd19mZW5jZS5oCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc3dfZmVuY2UuaApAQCAtMTYsNyArMTYsNyBAQAog
I2luY2x1ZGUgPGxpbnV4L3dhaXQuaD4KIAogc3RydWN0IGNvbXBsZXRpb247Ci1zdHJ1Y3QgcmVz
ZXJ2YXRpb25fb2JqZWN0Oworc3RydWN0IGRtYV9yZXN2OwogCiBzdHJ1Y3QgaTkxNV9zd19mZW5j
ZSB7CiAJd2FpdF9xdWV1ZV9oZWFkX3Qgd2FpdDsKQEAgLTgyLDcgKzgyLDcgQEAgaW50IGk5MTVf
c3dfZmVuY2VfYXdhaXRfZG1hX2ZlbmNlKHN0cnVjdCBpOTE1X3N3X2ZlbmNlICpmZW5jZSwKIAkJ
CQkgIGdmcF90IGdmcCk7CiAKIGludCBpOTE1X3N3X2ZlbmNlX2F3YWl0X3Jlc2VydmF0aW9uKHN0
cnVjdCBpOTE1X3N3X2ZlbmNlICpmZW5jZSwKLQkJCQkgICAgc3RydWN0IHJlc2VydmF0aW9uX29i
amVjdCAqcmVzdiwKKwkJCQkgICAgc3RydWN0IGRtYV9yZXN2ICpyZXN2LAogCQkJCSAgICBjb25z
dCBzdHJ1Y3QgZG1hX2ZlbmNlX29wcyAqZXhjbHVkZSwKIAkJCQkgICAgYm9vbCB3cml0ZSwKIAkJ
CQkgICAgdW5zaWduZWQgbG9uZyB0aW1lb3V0LApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV92bWEuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMKaW5kZXgg
YTU3NzI5YmU4MzEyLi5lYmZkMDNkMTE3Y2QgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfdm1hLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYwpAQCAt
OTksMTAgKzk5LDEwIEBAIHN0YXRpYyB2b2lkIF9faTkxNV92bWFfcmV0aXJlKHN0cnVjdCBpOTE1
X2FjdGl2ZSAqcmVmKQogCQlyZXR1cm47CiAKIAkvKiBQcnVuZSB0aGUgc2hhcmVkIGZlbmNlIGFy
cmF5cyBpZmYgY29tcGxldGVseSBpZGxlIChpbmMuIGV4dGVybmFsKSAqLwotCWlmIChyZXNlcnZh
dGlvbl9vYmplY3RfdHJ5bG9jayhvYmotPmJhc2UucmVzdikpIHsKLQkJaWYgKHJlc2VydmF0aW9u
X29iamVjdF90ZXN0X3NpZ25hbGVkX3JjdShvYmotPmJhc2UucmVzdiwgdHJ1ZSkpCi0JCQlyZXNl
cnZhdGlvbl9vYmplY3RfYWRkX2V4Y2xfZmVuY2Uob2JqLT5iYXNlLnJlc3YsIE5VTEwpOwotCQly
ZXNlcnZhdGlvbl9vYmplY3RfdW5sb2NrKG9iai0+YmFzZS5yZXN2KTsKKwlpZiAoZG1hX3Jlc3Zf
dHJ5bG9jayhvYmotPmJhc2UucmVzdikpIHsKKwkJaWYgKGRtYV9yZXN2X3Rlc3Rfc2lnbmFsZWRf
cmN1KG9iai0+YmFzZS5yZXN2LCB0cnVlKSkKKwkJCWRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlKG9i
ai0+YmFzZS5yZXN2LCBOVUxMKTsKKwkJZG1hX3Jlc3ZfdW5sb2NrKG9iai0+YmFzZS5yZXN2KTsK
IAl9CiAKIAkvKgpAQCAtOTAzLDcgKzkwMyw3IEBAIHN0YXRpYyB2b2lkIGV4cG9ydF9mZW5jZShz
dHJ1Y3QgaTkxNV92bWEgKnZtYSwKIAkJCSBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKIAkJCSB1
bnNpZ25lZCBpbnQgZmxhZ3MpCiB7Ci0Jc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdiA9
IHZtYS0+cmVzdjsKKwlzdHJ1Y3QgZG1hX3Jlc3YgKnJlc3YgPSB2bWEtPnJlc3Y7CiAKIAkvKgog
CSAqIElnbm9yZSBlcnJvcnMgZnJvbSBmYWlsaW5nIHRvIGFsbG9jYXRlIHRoZSBuZXcgZmVuY2Us
IHdlIGNhbid0CkBAIC05MTEsOSArOTExLDkgQEAgc3RhdGljIHZvaWQgZXhwb3J0X2ZlbmNlKHN0
cnVjdCBpOTE1X3ZtYSAqdm1hLAogCSAqIHN5bmNocm9uaXNhdGlvbiBsZWFkaW5nIHRvIHJlbmRl
cmluZyBjb3JydXB0aW9uLgogCSAqLwogCWlmIChmbGFncyAmIEVYRUNfT0JKRUNUX1dSSVRFKQot
CQlyZXNlcnZhdGlvbl9vYmplY3RfYWRkX2V4Y2xfZmVuY2UocmVzdiwgJnJxLT5mZW5jZSk7Ci0J
ZWxzZSBpZiAocmVzZXJ2YXRpb25fb2JqZWN0X3Jlc2VydmVfc2hhcmVkKHJlc3YsIDEpID09IDAp
Ci0JCXJlc2VydmF0aW9uX29iamVjdF9hZGRfc2hhcmVkX2ZlbmNlKHJlc3YsICZycS0+ZmVuY2Up
OworCQlkbWFfcmVzdl9hZGRfZXhjbF9mZW5jZShyZXN2LCAmcnEtPmZlbmNlKTsKKwllbHNlIGlm
IChkbWFfcmVzdl9yZXNlcnZlX3NoYXJlZChyZXN2LCAxKSA9PSAwKQorCQlkbWFfcmVzdl9hZGRf
c2hhcmVkX2ZlbmNlKHJlc3YsICZycS0+ZmVuY2UpOwogfQogCiBpbnQgaTkxNV92bWFfbW92ZV90
b19hY3RpdmUoc3RydWN0IGk5MTVfdm1hICp2bWEsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3ZtYS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuaAppbmRl
eCA0Yjc2OWRiNjQ5YmYuLjU5YTQ5NzU2MWZjNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV92bWEuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5oCkBA
IC01NSw3ICs1NSw3IEBAIHN0cnVjdCBpOTE1X3ZtYSB7CiAJc3RydWN0IGk5MTVfYWRkcmVzc19z
cGFjZSAqdm07CiAJY29uc3Qgc3RydWN0IGk5MTVfdm1hX29wcyAqb3BzOwogCXN0cnVjdCBpOTE1
X2ZlbmNlX3JlZyAqZmVuY2U7Ci0Jc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdjsgLyoq
IEFsaWFzIG9mIG9iai0+cmVzdiAqLworCXN0cnVjdCBkbWFfcmVzdiAqcmVzdjsgLyoqIEFsaWFz
IG9mIG9iai0+cmVzdiAqLwogCXN0cnVjdCBzZ190YWJsZSAqcGFnZXM7CiAJdm9pZCBfX2lvbWVt
ICppb21hcDsKIAl2b2lkICpwcml2YXRlOyAvKiBvd25lZCBieSBjcmVhdG9yICovCkBAIC0yOTks
MTYgKzI5OSwxNiBAQCB2b2lkIGk5MTVfdm1hX2Nsb3NlKHN0cnVjdCBpOTE1X3ZtYSAqdm1hKTsK
IHZvaWQgaTkxNV92bWFfcmVvcGVuKHN0cnVjdCBpOTE1X3ZtYSAqdm1hKTsKIHZvaWQgaTkxNV92
bWFfZGVzdHJveShzdHJ1Y3QgaTkxNV92bWEgKnZtYSk7CiAKLSNkZWZpbmUgYXNzZXJ0X3ZtYV9o
ZWxkKHZtYSkgcmVzZXJ2YXRpb25fb2JqZWN0X2Fzc2VydF9oZWxkKCh2bWEpLT5yZXN2KQorI2Rl
ZmluZSBhc3NlcnRfdm1hX2hlbGQodm1hKSBkbWFfcmVzdl9hc3NlcnRfaGVsZCgodm1hKS0+cmVz
dikKIAogc3RhdGljIGlubGluZSB2b2lkIGk5MTVfdm1hX2xvY2soc3RydWN0IGk5MTVfdm1hICp2
bWEpCiB7Ci0JcmVzZXJ2YXRpb25fb2JqZWN0X2xvY2sodm1hLT5yZXN2LCBOVUxMKTsKKwlkbWFf
cmVzdl9sb2NrKHZtYS0+cmVzdiwgTlVMTCk7CiB9CiAKIHN0YXRpYyBpbmxpbmUgdm9pZCBpOTE1
X3ZtYV91bmxvY2soc3RydWN0IGk5MTVfdm1hICp2bWEpCiB7Ci0JcmVzZXJ2YXRpb25fb2JqZWN0
X3VubG9jayh2bWEtPnJlc3YpOworCWRtYV9yZXN2X3VubG9jayh2bWEtPnJlc3YpOwogfQogCiBp
bnQgX19pOTE1X3ZtYV9kb19waW4oc3RydWN0IGk5MTVfdm1hICp2bWEsCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vbGltYS9saW1hX2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL2xpbWEvbGlt
YV9nZW0uYwppbmRleCBmZDFhMDI0NzAzZDIuLmZmM2Q5YWNjMjRmYyAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2xpbWEvbGltYV9nZW0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbGltYS9s
aW1hX2dlbS5jCkBAIC0xMzYsNyArMTM2LDcgQEAgc3RhdGljIGludCBsaW1hX2dlbV9zeW5jX2Jv
KHN0cnVjdCBsaW1hX3NjaGVkX3Rhc2sgKnRhc2ssIHN0cnVjdCBsaW1hX2JvICpibywKIAlpbnQg
ZXJyID0gMDsKIAogCWlmICghd3JpdGUpIHsKLQkJZXJyID0gcmVzZXJ2YXRpb25fb2JqZWN0X3Jl
c2VydmVfc2hhcmVkKGJvLT5nZW0ucmVzdiwgMSk7CisJCWVyciA9IGRtYV9yZXN2X3Jlc2VydmVf
c2hhcmVkKGJvLT5nZW0ucmVzdiwgMSk7CiAJCWlmIChlcnIpCiAJCQlyZXR1cm4gZXJyOwogCX0K
QEAgLTI5Niw5ICsyOTYsOSBAQCBpbnQgbGltYV9nZW1fc3VibWl0KHN0cnVjdCBkcm1fZmlsZSAq
ZmlsZSwgc3RydWN0IGxpbWFfc3VibWl0ICpzdWJtaXQpCiAKIAlmb3IgKGkgPSAwOyBpIDwgc3Vi
bWl0LT5ucl9ib3M7IGkrKykgewogCQlpZiAoc3VibWl0LT5ib3NbaV0uZmxhZ3MgJiBMSU1BX1NV
Qk1JVF9CT19XUklURSkKLQkJCXJlc2VydmF0aW9uX29iamVjdF9hZGRfZXhjbF9mZW5jZShib3Nb
aV0tPmdlbS5yZXN2LCBmZW5jZSk7CisJCQlkbWFfcmVzdl9hZGRfZXhjbF9mZW5jZShib3NbaV0t
PmdlbS5yZXN2LCBmZW5jZSk7CiAJCWVsc2UKLQkJCXJlc2VydmF0aW9uX29iamVjdF9hZGRfc2hh
cmVkX2ZlbmNlKGJvc1tpXS0+Z2VtLnJlc3YsIGZlbmNlKTsKKwkJCWRtYV9yZXN2X2FkZF9zaGFy
ZWRfZmVuY2UoYm9zW2ldLT5nZW0ucmVzdiwgZmVuY2UpOwogCX0KIAogCWxpbWFfZ2VtX3VubG9j
a19ib3MoYm9zLCBzdWJtaXQtPm5yX2JvcywgJmN0eCk7CkBAIC0zNDEsNyArMzQxLDcgQEAgaW50
IGxpbWFfZ2VtX3dhaXQoc3RydWN0IGRybV9maWxlICpmaWxlLCB1MzIgaGFuZGxlLCB1MzIgb3As
IHM2NCB0aW1lb3V0X25zKQogCiAJdGltZW91dCA9IGRybV90aW1lb3V0X2Fic190b19qaWZmaWVz
KHRpbWVvdXRfbnMpOwogCi0JcmV0ID0gZHJtX2dlbV9yZXNlcnZhdGlvbl9vYmplY3Rfd2FpdChm
aWxlLCBoYW5kbGUsIHdyaXRlLCB0aW1lb3V0KTsKKwlyZXQgPSBkcm1fZ2VtX2RtYV9yZXN2X3dh
aXQoZmlsZSwgaGFuZGxlLCB3cml0ZSwgdGltZW91dCk7CiAJaWYgKHJldCA9PSAwKQogCQlyZXQg
PSB0aW1lb3V0ID8gLUVUSU1FRE9VVCA6IC1FQlVTWTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL21lZGlhdGVrL210a19kcm1fZmIuYyBiL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9t
dGtfZHJtX2ZiLmMKaW5kZXggYWU0MGIwODBhZTQ3Li4zZjIzMGEyOGEyZGMgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2ZiLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL21lZGlhdGVrL210a19kcm1fZmIuYwpAQCAtNCw3ICs0LDcgQEAKICAqLwogCiAjaW5jbHVk
ZSA8bGludXgvZG1hLWJ1Zi5oPgotI2luY2x1ZGUgPGxpbnV4L3Jlc2VydmF0aW9uLmg+CisjaW5j
bHVkZSA8bGludXgvZG1hLXJlc3YuaD4KIAogI2luY2x1ZGUgPGRybS9kcm1fbW9kZXNldF9oZWxw
ZXIuaD4KICNpbmNsdWRlIDxkcm0vZHJtX2ZiX2hlbHBlci5oPgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL21zbS9tc21fZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL21zbV9nZW0uYwpp
bmRleCAxOGRhOGQ2ZmZjNTEuLjM0OGE3YWQyYzA0NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL21zbS9tc21fZ2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL21zbS9tc21fZ2VtLmMKQEAg
LTY2MywxMyArNjYzLDEzIEBAIHZvaWQgbXNtX2dlbV92dW5tYXAoc3RydWN0IGRybV9nZW1fb2Jq
ZWN0ICpvYmosIGVudW0gbXNtX2dlbV9sb2NrIHN1YmNsYXNzKQogaW50IG1zbV9nZW1fc3luY19v
YmplY3Qoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmosCiAJCXN0cnVjdCBtc21fZmVuY2VfY29u
dGV4dCAqZmN0eCwgYm9vbCBleGNsdXNpdmUpCiB7Ci0Jc3RydWN0IHJlc2VydmF0aW9uX29iamVj
dF9saXN0ICpmb2JqOworCXN0cnVjdCBkbWFfcmVzdl9saXN0ICpmb2JqOwogCXN0cnVjdCBkbWFf
ZmVuY2UgKmZlbmNlOwogCWludCBpLCByZXQ7CiAKLQlmb2JqID0gcmVzZXJ2YXRpb25fb2JqZWN0
X2dldF9saXN0KG9iai0+cmVzdik7CisJZm9iaiA9IGRtYV9yZXN2X2dldF9saXN0KG9iai0+cmVz
dik7CiAJaWYgKCFmb2JqIHx8IChmb2JqLT5zaGFyZWRfY291bnQgPT0gMCkpIHsKLQkJZmVuY2Ug
PSByZXNlcnZhdGlvbl9vYmplY3RfZ2V0X2V4Y2wob2JqLT5yZXN2KTsKKwkJZmVuY2UgPSBkbWFf
cmVzdl9nZXRfZXhjbChvYmotPnJlc3YpOwogCQkvKiBkb24ndCBuZWVkIHRvIHdhaXQgb24gb3Vy
IG93biBmZW5jZXMsIHNpbmNlIHJpbmcgaXMgZmlmbyAqLwogCQlpZiAoZmVuY2UgJiYgKGZlbmNl
LT5jb250ZXh0ICE9IGZjdHgtPmNvbnRleHQpKSB7CiAJCQlyZXQgPSBkbWFfZmVuY2Vfd2FpdChm
ZW5jZSwgdHJ1ZSk7CkBAIC02ODMsNyArNjgzLDcgQEAgaW50IG1zbV9nZW1fc3luY19vYmplY3Qo
c3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmosCiAKIAlmb3IgKGkgPSAwOyBpIDwgZm9iai0+c2hh
cmVkX2NvdW50OyBpKyspIHsKIAkJZmVuY2UgPSByY3VfZGVyZWZlcmVuY2VfcHJvdGVjdGVkKGZv
YmotPnNoYXJlZFtpXSwKLQkJCQkJCXJlc2VydmF0aW9uX29iamVjdF9oZWxkKG9iai0+cmVzdikp
OworCQkJCQkJZG1hX3Jlc3ZfaGVsZChvYmotPnJlc3YpKTsKIAkJaWYgKGZlbmNlLT5jb250ZXh0
ICE9IGZjdHgtPmNvbnRleHQpIHsKIAkJCXJldCA9IGRtYV9mZW5jZV93YWl0KGZlbmNlLCB0cnVl
KTsKIAkJCWlmIChyZXQpCkBAIC03MDEsOSArNzAxLDkgQEAgdm9pZCBtc21fZ2VtX21vdmVfdG9f
YWN0aXZlKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqLAogCVdBUk5fT04obXNtX29iai0+bWFk
diAhPSBNU01fTUFEVl9XSUxMTkVFRCk7CiAJbXNtX29iai0+Z3B1ID0gZ3B1OwogCWlmIChleGNs
dXNpdmUpCi0JCXJlc2VydmF0aW9uX29iamVjdF9hZGRfZXhjbF9mZW5jZShvYmotPnJlc3YsIGZl
bmNlKTsKKwkJZG1hX3Jlc3ZfYWRkX2V4Y2xfZmVuY2Uob2JqLT5yZXN2LCBmZW5jZSk7CiAJZWxz
ZQotCQlyZXNlcnZhdGlvbl9vYmplY3RfYWRkX3NoYXJlZF9mZW5jZShvYmotPnJlc3YsIGZlbmNl
KTsKKwkJZG1hX3Jlc3ZfYWRkX3NoYXJlZF9mZW5jZShvYmotPnJlc3YsIGZlbmNlKTsKIAlsaXN0
X2RlbF9pbml0KCZtc21fb2JqLT5tbV9saXN0KTsKIAlsaXN0X2FkZF90YWlsKCZtc21fb2JqLT5t
bV9saXN0LCAmZ3B1LT5hY3RpdmVfbGlzdCk7CiB9CkBAIC03MjgsNyArNzI4LDcgQEAgaW50IG1z
bV9nZW1fY3B1X3ByZXAoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmosIHVpbnQzMl90IG9wLCBr
dGltZV90ICp0aW1lb3V0KQogCQlvcCAmIE1TTV9QUkVQX05PU1lOQyA/IDAgOiB0aW1lb3V0X3Rv
X2ppZmZpZXModGltZW91dCk7CiAJbG9uZyByZXQ7CiAKLQlyZXQgPSByZXNlcnZhdGlvbl9vYmpl
Y3Rfd2FpdF90aW1lb3V0X3JjdShvYmotPnJlc3YsIHdyaXRlLAorCXJldCA9IGRtYV9yZXN2X3dh
aXRfdGltZW91dF9yY3Uob2JqLT5yZXN2LCB3cml0ZSwKIAkJCQkJCSAgdHJ1ZSwgIHJlbWFpbik7
CiAJaWYgKHJldCA9PSAwKQogCQlyZXR1cm4gcmVtYWluID09IDAgPyAtRUJVU1kgOiAtRVRJTUVE
T1VUOwpAQCAtNzYwLDggKzc2MCw4IEBAIHN0YXRpYyB2b2lkIGRlc2NyaWJlX2ZlbmNlKHN0cnVj
dCBkbWFfZmVuY2UgKmZlbmNlLCBjb25zdCBjaGFyICp0eXBlLAogdm9pZCBtc21fZ2VtX2Rlc2Ny
aWJlKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqLCBzdHJ1Y3Qgc2VxX2ZpbGUgKm0pCiB7CiAJ
c3RydWN0IG1zbV9nZW1fb2JqZWN0ICptc21fb2JqID0gdG9fbXNtX2JvKG9iaik7Ci0Jc3RydWN0
IHJlc2VydmF0aW9uX29iamVjdCAqcm9iaiA9IG9iai0+cmVzdjsKLQlzdHJ1Y3QgcmVzZXJ2YXRp
b25fb2JqZWN0X2xpc3QgKmZvYmo7CisJc3RydWN0IGRtYV9yZXN2ICpyb2JqID0gb2JqLT5yZXN2
OworCXN0cnVjdCBkbWFfcmVzdl9saXN0ICpmb2JqOwogCXN0cnVjdCBkbWFfZmVuY2UgKmZlbmNl
OwogCXN0cnVjdCBtc21fZ2VtX3ZtYSAqdm1hOwogCXVpbnQ2NF90IG9mZiA9IGRybV92bWFfbm9k
ZV9zdGFydCgmb2JqLT52bWFfbm9kZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbXNt
L21zbV9nZW0uaCBiL2RyaXZlcnMvZ3B1L2RybS9tc20vbXNtX2dlbS5oCmluZGV4IDhjZmNmOGYw
OWUzZS4uOWUwOTUzYzJiN2NlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbXNtL21zbV9n
ZW0uaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL21zbV9nZW0uaApAQCAtOCw3ICs4LDcgQEAK
ICNkZWZpbmUgX19NU01fR0VNX0hfXwogCiAjaW5jbHVkZSA8bGludXgva3JlZi5oPgotI2luY2x1
ZGUgPGxpbnV4L3Jlc2VydmF0aW9uLmg+CisjaW5jbHVkZSA8bGludXgvZG1hLXJlc3YuaD4KICNp
bmNsdWRlICJtc21fZHJ2LmgiCiAKIC8qIEFkZGl0aW9uYWwgaW50ZXJuYWwtdXNlIG9ubHkgQk8g
ZmxhZ3M6ICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbXNtL21zbV9nZW1fc3VibWl0
LmMgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL21zbV9nZW1fc3VibWl0LmMKaW5kZXggMzQ4ZjhjMmJl
ODA2Li4yZTE1NTZiN2FmMjYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9tc20vbXNtX2dl
bV9zdWJtaXQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL21zbV9nZW1fc3VibWl0LmMKQEAg
LTIyNSw3ICsyMjUsNyBAQCBzdGF0aWMgaW50IHN1Ym1pdF9mZW5jZV9zeW5jKHN0cnVjdCBtc21f
Z2VtX3N1Ym1pdCAqc3VibWl0LCBib29sIG5vX2ltcGxpY2l0KQogCQkJICogc3RyYW5nZSBwbGFj
ZSB0byBjYWxsIGl0LiAgT1RPSCB0aGlzIGlzIGEKIAkJCSAqIGNvbnZlbmllbnQgY2FuLWZhaWwg
cG9pbnQgdG8gaG9vayBpdCBpbi4KIAkJCSAqLwotCQkJcmV0ID0gcmVzZXJ2YXRpb25fb2JqZWN0
X3Jlc2VydmVfc2hhcmVkKG1zbV9vYmotPmJhc2UucmVzdiwKKwkJCXJldCA9IGRtYV9yZXN2X3Jl
c2VydmVfc2hhcmVkKG1zbV9vYmotPmJhc2UucmVzdiwKIAkJCQkJCQkJMSk7CiAJCQlpZiAocmV0
KQogCQkJCXJldHVybiByZXQ7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbXhzZmIvbXhz
ZmJfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vbXhzZmIvbXhzZmJfZHJ2LmMKaW5kZXggODc4ZWY2
ODIyODEyLi5lODUwNjMzNWNkMTUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9teHNmYi9t
eHNmYl9kcnYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbXhzZmIvbXhzZmJfZHJ2LmMKQEAgLTE3
LDcgKzE3LDcgQEAKICNpbmNsdWRlIDxsaW51eC9vZl9ncmFwaC5oPgogI2luY2x1ZGUgPGxpbnV4
L29mX3Jlc2VydmVkX21lbS5oPgogI2luY2x1ZGUgPGxpbnV4L3BtX3J1bnRpbWUuaD4KLSNpbmNs
dWRlIDxsaW51eC9yZXNlcnZhdGlvbi5oPgorI2luY2x1ZGUgPGxpbnV4L2RtYS1yZXN2Lmg+CiAj
aW5jbHVkZSA8bGludXgvc3BpbmxvY2suaD4KIAogI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljLmg+
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9kaXNwbnY1MC93bmR3LmMgYi9k
cml2ZXJzL2dwdS9kcm0vbm91dmVhdS9kaXNwbnY1MC93bmR3LmMKaW5kZXggODlmOGU3NmEyZDdk
Li4wMjdhMDFiOTdkMWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L2Rpc3Bu
djUwL3duZHcuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9kaXNwbnY1MC93bmR3LmMK
QEAgLTQ1Nyw3ICs0NTcsNyBAQCBudjUwX3duZHdfcHJlcGFyZV9mYihzdHJ1Y3QgZHJtX3BsYW5l
ICpwbGFuZSwgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqc3RhdGUpCiAJCWFzeXctPmltYWdlLmhh
bmRsZVswXSA9IGN0eGRtYS0+b2JqZWN0LmhhbmRsZTsKIAl9CiAKLQlhc3l3LT5zdGF0ZS5mZW5j
ZSA9IHJlc2VydmF0aW9uX29iamVjdF9nZXRfZXhjbF9yY3UoZmItPm52Ym8tPmJvLmJhc2UucmVz
dik7CisJYXN5dy0+c3RhdGUuZmVuY2UgPSBkbWFfcmVzdl9nZXRfZXhjbF9yY3UoZmItPm52Ym8t
PmJvLmJhc2UucmVzdik7CiAJYXN5dy0+aW1hZ2Uub2Zmc2V0WzBdID0gZmItPm52Ym8tPmJvLm9m
ZnNldDsKIAogCWlmICh3bmR3LT5mdW5jLT5wcmVwYXJlKSB7CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2JvLmMgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9u
b3V2ZWF1X2JvLmMKaW5kZXggOTllMzkxYmU5MzcwLi5lMGIxYmJlZTkzNmYgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfYm8uYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vbm91dmVhdS9ub3V2ZWF1X2JvLmMKQEAgLTE4OCw3ICsxODgsNyBAQCBub3V2ZWF1X2JvX2Zp
eHVwX2FsaWduKHN0cnVjdCBub3V2ZWF1X2JvICpudmJvLCB1MzIgZmxhZ3MsCiBpbnQKIG5vdXZl
YXVfYm9fbmV3KHN0cnVjdCBub3V2ZWF1X2NsaSAqY2xpLCB1NjQgc2l6ZSwgaW50IGFsaWduLAog
CSAgICAgICB1aW50MzJfdCBmbGFncywgdWludDMyX3QgdGlsZV9tb2RlLCB1aW50MzJfdCB0aWxl
X2ZsYWdzLAotCSAgICAgICBzdHJ1Y3Qgc2dfdGFibGUgKnNnLCBzdHJ1Y3QgcmVzZXJ2YXRpb25f
b2JqZWN0ICpyb2JqLAorCSAgICAgICBzdHJ1Y3Qgc2dfdGFibGUgKnNnLCBzdHJ1Y3QgZG1hX3Jl
c3YgKnJvYmosCiAJICAgICAgIHN0cnVjdCBub3V2ZWF1X2JvICoqcG52Ym8pCiB7CiAJc3RydWN0
IG5vdXZlYXVfZHJtICpkcm0gPSBjbGktPmRybTsKQEAgLTEzMjQsNyArMTMyNCw3IEBAIG5vdXZl
YXVfYm9fdm1fY2xlYW51cChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogewogCXN0cnVj
dCBub3V2ZWF1X2RybSAqZHJtID0gbm91dmVhdV9iZGV2KGJvLT5iZGV2KTsKIAlzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2ID0gZHJtLT5kZXY7Ci0Jc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UgPSByZXNl
cnZhdGlvbl9vYmplY3RfZ2V0X2V4Y2woYm8tPmJhc2UucmVzdik7CisJc3RydWN0IGRtYV9mZW5j
ZSAqZmVuY2UgPSBkbWFfcmVzdl9nZXRfZXhjbChiby0+YmFzZS5yZXN2KTsKIAogCW52MTBfYm9f
cHV0X3RpbGVfcmVnaW9uKGRldiwgKm9sZF90aWxlLCBmZW5jZSk7CiAJKm9sZF90aWxlID0gbmV3
X3RpbGU7CkBAIC0xNjU1LDEyICsxNjU1LDEyIEBAIG5vdXZlYXVfdHRtX3R0X3VucG9wdWxhdGUo
c3RydWN0IHR0bV90dCAqdHRtKQogdm9pZAogbm91dmVhdV9ib19mZW5jZShzdHJ1Y3Qgbm91dmVh
dV9ibyAqbnZibywgc3RydWN0IG5vdXZlYXVfZmVuY2UgKmZlbmNlLCBib29sIGV4Y2x1c2l2ZSkK
IHsKLQlzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyZXN2ID0gbnZiby0+Ym8uYmFzZS5yZXN2
OworCXN0cnVjdCBkbWFfcmVzdiAqcmVzdiA9IG52Ym8tPmJvLmJhc2UucmVzdjsKIAogCWlmIChl
eGNsdXNpdmUpCi0JCXJlc2VydmF0aW9uX29iamVjdF9hZGRfZXhjbF9mZW5jZShyZXN2LCAmZmVu
Y2UtPmJhc2UpOworCQlkbWFfcmVzdl9hZGRfZXhjbF9mZW5jZShyZXN2LCAmZmVuY2UtPmJhc2Up
OwogCWVsc2UgaWYgKGZlbmNlKQotCQlyZXNlcnZhdGlvbl9vYmplY3RfYWRkX3NoYXJlZF9mZW5j
ZShyZXN2LCAmZmVuY2UtPmJhc2UpOworCQlkbWFfcmVzdl9hZGRfc2hhcmVkX2ZlbmNlKHJlc3Ys
ICZmZW5jZS0+YmFzZSk7CiB9CiAKIHN0cnVjdCB0dG1fYm9fZHJpdmVyIG5vdXZlYXVfYm9fZHJp
dmVyID0gewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9iby5o
IGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9iby5oCmluZGV4IGQ2NzVlZmU4ZTdm
OS4uM2FlODQ4MzRiZDVjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2
ZWF1X2JvLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9iby5oCkBAIC03
Myw3ICs3Myw3IEBAIGV4dGVybiBzdHJ1Y3QgdHRtX2JvX2RyaXZlciBub3V2ZWF1X2JvX2RyaXZl
cjsKIHZvaWQgbm91dmVhdV9ib19tb3ZlX2luaXQoc3RydWN0IG5vdXZlYXVfZHJtICopOwogaW50
ICBub3V2ZWF1X2JvX25ldyhzdHJ1Y3Qgbm91dmVhdV9jbGkgKiwgdTY0IHNpemUsIGludCBhbGln
biwgdTMyIGZsYWdzLAogCQkgICAgdTMyIHRpbGVfbW9kZSwgdTMyIHRpbGVfZmxhZ3MsIHN0cnVj
dCBzZ190YWJsZSAqc2csCi0JCSAgICBzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyb2JqLAor
CQkgICAgc3RydWN0IGRtYV9yZXN2ICpyb2JqLAogCQkgICAgc3RydWN0IG5vdXZlYXVfYm8gKiop
OwogaW50ICBub3V2ZWF1X2JvX3BpbihzdHJ1Y3Qgbm91dmVhdV9ibyAqLCB1MzIgZmxhZ3MsIGJv
b2wgY29udGlnKTsKIGludCAgbm91dmVhdV9ib191bnBpbihzdHJ1Y3Qgbm91dmVhdV9ibyAqKTsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfZmVuY2UuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfZmVuY2UuYwppbmRleCBlNWYyNDlhYjIxNmEu
LjhkZjM5MDA3OGM4NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVh
dV9mZW5jZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfZmVuY2UuYwpA
QCAtMzM1LDIwICszMzUsMjAgQEAgbm91dmVhdV9mZW5jZV9zeW5jKHN0cnVjdCBub3V2ZWF1X2Jv
ICpudmJvLCBzdHJ1Y3Qgbm91dmVhdV9jaGFubmVsICpjaGFuLCBib29sIGUKIHsKIAlzdHJ1Y3Qg
bm91dmVhdV9mZW5jZV9jaGFuICpmY3R4ID0gY2hhbi0+ZmVuY2U7CiAJc3RydWN0IGRtYV9mZW5j
ZSAqZmVuY2U7Ci0Jc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdiA9IG52Ym8tPmJvLmJh
c2UucmVzdjsKLQlzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0X2xpc3QgKmZvYmo7CisJc3RydWN0
IGRtYV9yZXN2ICpyZXN2ID0gbnZiby0+Ym8uYmFzZS5yZXN2OworCXN0cnVjdCBkbWFfcmVzdl9s
aXN0ICpmb2JqOwogCXN0cnVjdCBub3V2ZWF1X2ZlbmNlICpmOwogCWludCByZXQgPSAwLCBpOwog
CiAJaWYgKCFleGNsdXNpdmUpIHsKLQkJcmV0ID0gcmVzZXJ2YXRpb25fb2JqZWN0X3Jlc2VydmVf
c2hhcmVkKHJlc3YsIDEpOworCQlyZXQgPSBkbWFfcmVzdl9yZXNlcnZlX3NoYXJlZChyZXN2LCAx
KTsKIAogCQlpZiAocmV0KQogCQkJcmV0dXJuIHJldDsKIAl9CiAKLQlmb2JqID0gcmVzZXJ2YXRp
b25fb2JqZWN0X2dldF9saXN0KHJlc3YpOwotCWZlbmNlID0gcmVzZXJ2YXRpb25fb2JqZWN0X2dl
dF9leGNsKHJlc3YpOworCWZvYmogPSBkbWFfcmVzdl9nZXRfbGlzdChyZXN2KTsKKwlmZW5jZSA9
IGRtYV9yZXN2X2dldF9leGNsKHJlc3YpOwogCiAJaWYgKGZlbmNlICYmICghZXhjbHVzaXZlIHx8
ICFmb2JqIHx8ICFmb2JqLT5zaGFyZWRfY291bnQpKSB7CiAJCXN0cnVjdCBub3V2ZWF1X2NoYW5u
ZWwgKnByZXYgPSBOVUxMOwpAQCAtMzc3LDcgKzM3Nyw3IEBAIG5vdXZlYXVfZmVuY2Vfc3luYyhz
dHJ1Y3Qgbm91dmVhdV9ibyAqbnZibywgc3RydWN0IG5vdXZlYXVfY2hhbm5lbCAqY2hhbiwgYm9v
bCBlCiAJCWJvb2wgbXVzdF93YWl0ID0gdHJ1ZTsKIAogCQlmZW5jZSA9IHJjdV9kZXJlZmVyZW5j
ZV9wcm90ZWN0ZWQoZm9iai0+c2hhcmVkW2ldLAotCQkJCQkJcmVzZXJ2YXRpb25fb2JqZWN0X2hl
bGQocmVzdikpOworCQkJCQkJZG1hX3Jlc3ZfaGVsZChyZXN2KSk7CiAKIAkJZiA9IG5vdXZlYXVf
bG9jYWxfZmVuY2UoZmVuY2UsIGNoYW4tPmRybSk7CiAJCWlmIChmKSB7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL25v
dXZlYXUvbm91dmVhdV9nZW0uYwppbmRleCBjNzM2OGFhMGJkZWMuLmM3NzMwMmY5NjllOCAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9nZW0uYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2dlbS5jCkBAIC04ODcsNyArODg3LDcgQEAgbm91
dmVhdV9nZW1faW9jdGxfY3B1X3ByZXAoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0
YSwKIAkJcmV0dXJuIC1FTk9FTlQ7CiAJbnZibyA9IG5vdXZlYXVfZ2VtX29iamVjdChnZW0pOwog
Ci0JbHJldCA9IHJlc2VydmF0aW9uX29iamVjdF93YWl0X3RpbWVvdXRfcmN1KG52Ym8tPmJvLmJh
c2UucmVzdiwgd3JpdGUsIHRydWUsCisJbHJldCA9IGRtYV9yZXN2X3dhaXRfdGltZW91dF9yY3Uo
bnZiby0+Ym8uYmFzZS5yZXN2LCB3cml0ZSwgdHJ1ZSwKIAkJCQkJCSAgIG5vX3dhaXQgPyAwIDog
MzAgKiBIWik7CiAJaWYgKCFscmV0KQogCQlyZXQgPSAtRUJVU1k7CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X3ByaW1lLmMgYi9kcml2ZXJzL2dwdS9kcm0vbm91
dmVhdS9ub3V2ZWF1X3ByaW1lLmMKaW5kZXggZTg2YWQ3YWU2MjJiLi43MjYyY2VkOTY4OGEgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfcHJpbWUuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X3ByaW1lLmMKQEAgLTYyLDE2ICs2MiwxNiBA
QCBzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm5vdXZlYXVfZ2VtX3ByaW1lX2ltcG9ydF9zZ190YWJs
ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogewogCXN0cnVjdCBub3V2ZWF1X2RybSAqZHJtID0g
bm91dmVhdV9kcm0oZGV2KTsKIAlzdHJ1Y3Qgbm91dmVhdV9ibyAqbnZibzsKLQlzdHJ1Y3QgcmVz
ZXJ2YXRpb25fb2JqZWN0ICpyb2JqID0gYXR0YWNoLT5kbWFidWYtPnJlc3Y7CisJc3RydWN0IGRt
YV9yZXN2ICpyb2JqID0gYXR0YWNoLT5kbWFidWYtPnJlc3Y7CiAJdTMyIGZsYWdzID0gMDsKIAlp
bnQgcmV0OwogCiAJZmxhZ3MgPSBUVE1fUExfRkxBR19UVDsKIAotCXJlc2VydmF0aW9uX29iamVj
dF9sb2NrKHJvYmosIE5VTEwpOworCWRtYV9yZXN2X2xvY2socm9iaiwgTlVMTCk7CiAJcmV0ID0g
bm91dmVhdV9ib19uZXcoJmRybS0+Y2xpZW50LCBhdHRhY2gtPmRtYWJ1Zi0+c2l6ZSwgMCwgZmxh
Z3MsIDAsIDAsCiAJCQkgICAgIHNnLCByb2JqLCAmbnZibyk7Ci0JcmVzZXJ2YXRpb25fb2JqZWN0
X3VubG9jayhyb2JqKTsKKwlkbWFfcmVzdl91bmxvY2socm9iaik7CiAJaWYgKHJldCkKIAkJcmV0
dXJuIEVSUl9QVFIocmV0KTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0
L3BhbmZyb3N0X2Rydi5jIGIvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2Rydi5j
CmluZGV4IDkyNmQwMjFlZTIwMi4uNGNlZGY2ZTcyMzM3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZHJ2LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmZy
b3N0L3BhbmZyb3N0X2Rydi5jCkBAIC0yNzcsNyArMjc3LDcgQEAgcGFuZnJvc3RfaW9jdGxfd2Fp
dF9ibyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCWlmICghZ2VtX29iaikK
IAkJcmV0dXJuIC1FTk9FTlQ7CiAKLQlyZXQgPSByZXNlcnZhdGlvbl9vYmplY3Rfd2FpdF90aW1l
b3V0X3JjdShnZW1fb2JqLT5yZXN2LCB0cnVlLAorCXJldCA9IGRtYV9yZXN2X3dhaXRfdGltZW91
dF9yY3UoZ2VtX29iai0+cmVzdiwgdHJ1ZSwKIAkJCQkJCSAgdHJ1ZSwgdGltZW91dCk7CiAJaWYg
KCFyZXQpCiAJCXJldCA9IHRpbWVvdXQgPyAtRVRJTUVET1VUIDogLUVCVVNZOwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2pvYi5jIGIvZHJpdmVycy9ncHUv
ZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2pvYi5jCmluZGV4IDliYjkyNjBkOTE4MS4uODQyNDNhOTlk
MjFkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3Rfam9iLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2pvYi5jCkBAIC02LDcgKzYs
NyBAQAogI2luY2x1ZGUgPGxpbnV4L2lvLmg+CiAjaW5jbHVkZSA8bGludXgvcGxhdGZvcm1fZGV2
aWNlLmg+CiAjaW5jbHVkZSA8bGludXgvcG1fcnVudGltZS5oPgotI2luY2x1ZGUgPGxpbnV4L3Jl
c2VydmF0aW9uLmg+CisjaW5jbHVkZSA8bGludXgvZG1hLXJlc3YuaD4KICNpbmNsdWRlIDxkcm0v
Z3B1X3NjaGVkdWxlci5oPgogI2luY2x1ZGUgPGRybS9wYW5mcm9zdF9kcm0uaD4KIApAQCAtMTk5
LDcgKzE5OSw3IEBAIHN0YXRpYyB2b2lkIHBhbmZyb3N0X2FjcXVpcmVfb2JqZWN0X2ZlbmNlcyhz
dHJ1Y3QgZHJtX2dlbV9vYmplY3QgKipib3MsCiAJaW50IGk7CiAKIAlmb3IgKGkgPSAwOyBpIDwg
Ym9fY291bnQ7IGkrKykKLQkJaW1wbGljaXRfZmVuY2VzW2ldID0gcmVzZXJ2YXRpb25fb2JqZWN0
X2dldF9leGNsX3JjdShib3NbaV0tPnJlc3YpOworCQlpbXBsaWNpdF9mZW5jZXNbaV0gPSBkbWFf
cmVzdl9nZXRfZXhjbF9yY3UoYm9zW2ldLT5yZXN2KTsKIH0KIAogc3RhdGljIHZvaWQgcGFuZnJv
c3RfYXR0YWNoX29iamVjdF9mZW5jZXMoc3RydWN0IGRybV9nZW1fb2JqZWN0ICoqYm9zLApAQCAt
MjA5LDcgKzIwOSw3IEBAIHN0YXRpYyB2b2lkIHBhbmZyb3N0X2F0dGFjaF9vYmplY3RfZmVuY2Vz
KHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqKmJvcywKIAlpbnQgaTsKIAogCWZvciAoaSA9IDA7IGkg
PCBib19jb3VudDsgaSsrKQotCQlyZXNlcnZhdGlvbl9vYmplY3RfYWRkX2V4Y2xfZmVuY2UoYm9z
W2ldLT5yZXN2LCBmZW5jZSk7CisJCWRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlKGJvc1tpXS0+cmVz
diwgZmVuY2UpOwogfQogCiBpbnQgcGFuZnJvc3Rfam9iX3B1c2goc3RydWN0IHBhbmZyb3N0X2pv
YiAqam9iKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3F4bC9xeGxfZGVidWdmcy5jIGIv
ZHJpdmVycy9ncHUvZHJtL3F4bC9xeGxfZGVidWdmcy5jCmluZGV4IDk0NDM5MjEyYTVjNS4uYTRm
NDE3NWJiZGJlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF9kZWJ1Z2ZzLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL3F4bC9xeGxfZGVidWdmcy5jCkBAIC01Nyw3ICs1Nyw3IEBA
IHF4bF9kZWJ1Z2ZzX2J1ZmZlcnNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEp
CiAJc3RydWN0IHF4bF9ibyAqYm87CiAKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5KGJvLCAmcWRldi0+
Z2VtLm9iamVjdHMsIGxpc3QpIHsKLQkJc3RydWN0IHJlc2VydmF0aW9uX29iamVjdF9saXN0ICpm
b2JqOworCQlzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCAqZm9iajsKIAkJaW50IHJlbDsKIAogCQlyY3Vf
cmVhZF9sb2NrKCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF9yZWxlYXNl
LmMgYi9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF9yZWxlYXNlLmMKaW5kZXggZGY1NWI4M2UwYTU1
Li4zMTIyMTZjYWVlYTIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9xeGwvcXhsX3JlbGVh
c2UuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF9yZWxlYXNlLmMKQEAgLTIzOCw3ICsy
MzgsNyBAQCBzdGF0aWMgaW50IHF4bF9yZWxlYXNlX3ZhbGlkYXRlX2JvKHN0cnVjdCBxeGxfYm8g
KmJvKQogCQkJcmV0dXJuIHJldDsKIAl9CiAKLQlyZXQgPSByZXNlcnZhdGlvbl9vYmplY3RfcmVz
ZXJ2ZV9zaGFyZWQoYm8tPnRiby5iYXNlLnJlc3YsIDEpOworCXJldCA9IGRtYV9yZXN2X3Jlc2Vy
dmVfc2hhcmVkKGJvLT50Ym8uYmFzZS5yZXN2LCAxKTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0
OwogCkBAIC00NTgsOSArNDU4LDkgQEAgdm9pZCBxeGxfcmVsZWFzZV9mZW5jZV9idWZmZXJfb2Jq
ZWN0cyhzdHJ1Y3QgcXhsX3JlbGVhc2UgKnJlbGVhc2UpCiAJbGlzdF9mb3JfZWFjaF9lbnRyeShl
bnRyeSwgJnJlbGVhc2UtPmJvcywgaGVhZCkgewogCQlibyA9IGVudHJ5LT5ibzsKIAotCQlyZXNl
cnZhdGlvbl9vYmplY3RfYWRkX3NoYXJlZF9mZW5jZShiby0+YmFzZS5yZXN2LCAmcmVsZWFzZS0+
YmFzZSk7CisJCWRtYV9yZXN2X2FkZF9zaGFyZWRfZmVuY2UoYm8tPmJhc2UucmVzdiwgJnJlbGVh
c2UtPmJhc2UpOwogCQl0dG1fYm9fYWRkX3RvX2xydShibyk7Ci0JCXJlc2VydmF0aW9uX29iamVj
dF91bmxvY2soYm8tPmJhc2UucmVzdik7CisJCWRtYV9yZXN2X3VubG9jayhiby0+YmFzZS5yZXN2
KTsKIAl9CiAJc3Bpbl91bmxvY2soJmdsb2ItPmxydV9sb2NrKTsKIAl3d19hY3F1aXJlX2Zpbmko
JnJlbGVhc2UtPnRpY2tldCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL2Np
ay5jIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9jaWsuYwppbmRleCA0MGY0ZDI5ZWRmZTIuLjYy
ZWFiODJhNjRmOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9jaWsuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL2Npay5jCkBAIC0zNjU5LDcgKzM2NTksNyBAQCBib29s
IGNpa19zZW1hcGhvcmVfcmluZ19lbWl0KHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2LAogc3Ry
dWN0IHJhZGVvbl9mZW5jZSAqY2lrX2NvcHlfY3BkbWEoc3RydWN0IHJhZGVvbl9kZXZpY2UgKnJk
ZXYsCiAJCQkJICAgIHVpbnQ2NF90IHNyY19vZmZzZXQsIHVpbnQ2NF90IGRzdF9vZmZzZXQsCiAJ
CQkJICAgIHVuc2lnbmVkIG51bV9ncHVfcGFnZXMsCi0JCQkJICAgIHN0cnVjdCByZXNlcnZhdGlv
bl9vYmplY3QgKnJlc3YpCisJCQkJICAgIHN0cnVjdCBkbWFfcmVzdiAqcmVzdikKIHsKIAlzdHJ1
Y3QgcmFkZW9uX2ZlbmNlICpmZW5jZTsKIAlzdHJ1Y3QgcmFkZW9uX3N5bmMgc3luYzsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vY2lrX3NkbWEuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9yYWRlb24vY2lrX3NkbWEuYwppbmRleCA1ODkyMTdhN2U0MzUuLjM1YjlkYzZjZTQ2YSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9jaWtfc2RtYS5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9yYWRlb24vY2lrX3NkbWEuYwpAQCAtNTc5LDcgKzU3OSw3IEBAIHZvaWQgY2lrX3Nk
bWFfZmluaShzdHJ1Y3QgcmFkZW9uX2RldmljZSAqcmRldikKIHN0cnVjdCByYWRlb25fZmVuY2Ug
KmNpa19jb3B5X2RtYShzdHJ1Y3QgcmFkZW9uX2RldmljZSAqcmRldiwKIAkJCQkgIHVpbnQ2NF90
IHNyY19vZmZzZXQsIHVpbnQ2NF90IGRzdF9vZmZzZXQsCiAJCQkJICB1bnNpZ25lZCBudW1fZ3B1
X3BhZ2VzLAotCQkJCSAgc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdikKKwkJCQkgIHN0
cnVjdCBkbWFfcmVzdiAqcmVzdikKIHsKIAlzdHJ1Y3QgcmFkZW9uX2ZlbmNlICpmZW5jZTsKIAlz
dHJ1Y3QgcmFkZW9uX3N5bmMgc3luYzsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yYWRl
b24vZXZlcmdyZWVuX2RtYS5jIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9ldmVyZ3JlZW5fZG1h
LmMKaW5kZXggNTUwNWEwNGNhNDAyLi5hNDZlZTZjMjA5OWQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9yYWRlb24vZXZlcmdyZWVuX2RtYS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRl
b24vZXZlcmdyZWVuX2RtYS5jCkBAIC0xMDgsNyArMTA4LDcgQEAgc3RydWN0IHJhZGVvbl9mZW5j
ZSAqZXZlcmdyZWVuX2NvcHlfZG1hKHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2LAogCQkJCQl1
aW50NjRfdCBzcmNfb2Zmc2V0LAogCQkJCQl1aW50NjRfdCBkc3Rfb2Zmc2V0LAogCQkJCQl1bnNp
Z25lZCBudW1fZ3B1X3BhZ2VzLAotCQkJCQlzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyZXN2
KQorCQkJCQlzdHJ1Y3QgZG1hX3Jlc3YgKnJlc3YpCiB7CiAJc3RydWN0IHJhZGVvbl9mZW5jZSAq
ZmVuY2U7CiAJc3RydWN0IHJhZGVvbl9zeW5jIHN5bmM7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vcmFkZW9uL3IxMDAuYyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcjEwMC5jCmluZGV4
IDVjMDUxOTNkYTUyMC4uNzA4OWRmYzhjMmE5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
cmFkZW9uL3IxMDAuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3IxMDAuYwpAQCAtODkx
LDcgKzg5MSw3IEBAIHN0cnVjdCByYWRlb25fZmVuY2UgKnIxMDBfY29weV9ibGl0KHN0cnVjdCBy
YWRlb25fZGV2aWNlICpyZGV2LAogCQkJCSAgICB1aW50NjRfdCBzcmNfb2Zmc2V0LAogCQkJCSAg
ICB1aW50NjRfdCBkc3Rfb2Zmc2V0LAogCQkJCSAgICB1bnNpZ25lZCBudW1fZ3B1X3BhZ2VzLAot
CQkJCSAgICBzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyZXN2KQorCQkJCSAgICBzdHJ1Y3Qg
ZG1hX3Jlc3YgKnJlc3YpCiB7CiAJc3RydWN0IHJhZGVvbl9yaW5nICpyaW5nID0gJnJkZXYtPnJp
bmdbUkFERU9OX1JJTkdfVFlQRV9HRlhfSU5ERVhdOwogCXN0cnVjdCByYWRlb25fZmVuY2UgKmZl
bmNlOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yMjAwLmMgYi9kcml2ZXJz
L2dwdS9kcm0vcmFkZW9uL3IyMDAuYwppbmRleCA5Y2U2ZGQ4M2QyODQuLjg0MDQwMTQxM2M1OCAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yMjAwLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL3JhZGVvbi9yMjAwLmMKQEAgLTg0LDcgKzg0LDcgQEAgc3RydWN0IHJhZGVvbl9mZW5j
ZSAqcjIwMF9jb3B5X2RtYShzdHJ1Y3QgcmFkZW9uX2RldmljZSAqcmRldiwKIAkJCQkgICB1aW50
NjRfdCBzcmNfb2Zmc2V0LAogCQkJCSAgIHVpbnQ2NF90IGRzdF9vZmZzZXQsCiAJCQkJICAgdW5z
aWduZWQgbnVtX2dwdV9wYWdlcywKLQkJCQkgICBzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpy
ZXN2KQorCQkJCSAgIHN0cnVjdCBkbWFfcmVzdiAqcmVzdikKIHsKIAlzdHJ1Y3QgcmFkZW9uX3Jp
bmcgKnJpbmcgPSAmcmRldi0+cmluZ1tSQURFT05fUklOR19UWVBFX0dGWF9JTkRFWF07CiAJc3Ry
dWN0IHJhZGVvbl9mZW5jZSAqZmVuY2U7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcmFk
ZW9uL3I2MDAuYyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcjYwMC5jCmluZGV4IDdkMTc1YTll
ODMzMC4uZTkzN2NjMDE5MTBkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3I2
MDAuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3I2MDAuYwpAQCAtMjk2Myw3ICsyOTYz
LDcgQEAgYm9vbCByNjAwX3NlbWFwaG9yZV9yaW5nX2VtaXQoc3RydWN0IHJhZGVvbl9kZXZpY2Ug
KnJkZXYsCiBzdHJ1Y3QgcmFkZW9uX2ZlbmNlICpyNjAwX2NvcHlfY3BkbWEoc3RydWN0IHJhZGVv
bl9kZXZpY2UgKnJkZXYsCiAJCQkJICAgICB1aW50NjRfdCBzcmNfb2Zmc2V0LCB1aW50NjRfdCBk
c3Rfb2Zmc2V0LAogCQkJCSAgICAgdW5zaWduZWQgbnVtX2dwdV9wYWdlcywKLQkJCQkgICAgIHN0
cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKnJlc3YpCisJCQkJICAgICBzdHJ1Y3QgZG1hX3Jlc3Yg
KnJlc3YpCiB7CiAJc3RydWN0IHJhZGVvbl9mZW5jZSAqZmVuY2U7CiAJc3RydWN0IHJhZGVvbl9z
eW5jIHN5bmM7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3I2MDBfZG1hLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3I2MDBfZG1hLmMKaW5kZXggMzVkOTJlZjhhMGQ0Li5h
ZjZjMGRhNDVmMjggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcjYwMF9kbWEu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3I2MDBfZG1hLmMKQEAgLTQ0NCw3ICs0NDQs
NyBAQCB2b2lkIHI2MDBfZG1hX3JpbmdfaWJfZXhlY3V0ZShzdHJ1Y3QgcmFkZW9uX2RldmljZSAq
cmRldiwgc3RydWN0IHJhZGVvbl9pYiAqaWIpCiBzdHJ1Y3QgcmFkZW9uX2ZlbmNlICpyNjAwX2Nv
cHlfZG1hKHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2LAogCQkJCSAgIHVpbnQ2NF90IHNyY19v
ZmZzZXQsIHVpbnQ2NF90IGRzdF9vZmZzZXQsCiAJCQkJICAgdW5zaWduZWQgbnVtX2dwdV9wYWdl
cywKLQkJCQkgICBzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyZXN2KQorCQkJCSAgIHN0cnVj
dCBkbWFfcmVzdiAqcmVzdikKIHsKIAlzdHJ1Y3QgcmFkZW9uX2ZlbmNlICpmZW5jZTsKIAlzdHJ1
Y3QgcmFkZW9uX3N5bmMgc3luYzsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24v
cmFkZW9uLmggYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbi5oCmluZGV4IDNmNzcwMTMy
MWQyMS4uZGUxZDA5MGRmMDM0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3Jh
ZGVvbi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uLmgKQEAgLTYxOSw3ICs2
MTksNyBAQCB2b2lkIHJhZGVvbl9zeW5jX2ZlbmNlKHN0cnVjdCByYWRlb25fc3luYyAqc3luYywK
IAkJICAgICAgIHN0cnVjdCByYWRlb25fZmVuY2UgKmZlbmNlKTsKIGludCByYWRlb25fc3luY19y
ZXN2KHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2LAogCQkgICAgIHN0cnVjdCByYWRlb25fc3lu
YyAqc3luYywKLQkJICAgICBzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyZXN2LAorCQkgICAg
IHN0cnVjdCBkbWFfcmVzdiAqcmVzdiwKIAkJICAgICBib29sIHNoYXJlZCk7CiBpbnQgcmFkZW9u
X3N5bmNfcmluZ3Moc3RydWN0IHJhZGVvbl9kZXZpY2UgKnJkZXYsCiAJCSAgICAgIHN0cnVjdCBy
YWRlb25fc3luYyAqc3luYywKQEAgLTE5MTIsMjAgKzE5MTIsMjAgQEAgc3RydWN0IHJhZGVvbl9h
c2ljIHsKIAkJCQkJICAgICB1aW50NjRfdCBzcmNfb2Zmc2V0LAogCQkJCQkgICAgIHVpbnQ2NF90
IGRzdF9vZmZzZXQsCiAJCQkJCSAgICAgdW5zaWduZWQgbnVtX2dwdV9wYWdlcywKLQkJCQkJICAg
ICBzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyZXN2KTsKKwkJCQkJICAgICBzdHJ1Y3QgZG1h
X3Jlc3YgKnJlc3YpOwogCQl1MzIgYmxpdF9yaW5nX2luZGV4OwogCQlzdHJ1Y3QgcmFkZW9uX2Zl
bmNlICooKmRtYSkoc3RydWN0IHJhZGVvbl9kZXZpY2UgKnJkZXYsCiAJCQkJCSAgICB1aW50NjRf
dCBzcmNfb2Zmc2V0LAogCQkJCQkgICAgdWludDY0X3QgZHN0X29mZnNldCwKIAkJCQkJICAgIHVu
c2lnbmVkIG51bV9ncHVfcGFnZXMsCi0JCQkJCSAgICBzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0
ICpyZXN2KTsKKwkJCQkJICAgIHN0cnVjdCBkbWFfcmVzdiAqcmVzdik7CiAJCXUzMiBkbWFfcmlu
Z19pbmRleDsKIAkJLyogbWV0aG9kIHVzZWQgZm9yIGJvIGNvcHkgKi8KIAkJc3RydWN0IHJhZGVv
bl9mZW5jZSAqKCpjb3B5KShzdHJ1Y3QgcmFkZW9uX2RldmljZSAqcmRldiwKIAkJCQkJICAgICB1
aW50NjRfdCBzcmNfb2Zmc2V0LAogCQkJCQkgICAgIHVpbnQ2NF90IGRzdF9vZmZzZXQsCiAJCQkJ
CSAgICAgdW5zaWduZWQgbnVtX2dwdV9wYWdlcywKLQkJCQkJICAgICBzdHJ1Y3QgcmVzZXJ2YXRp
b25fb2JqZWN0ICpyZXN2KTsKKwkJCQkJICAgICBzdHJ1Y3QgZG1hX3Jlc3YgKnJlc3YpOwogCQkv
KiByaW5nIHVzZWQgZm9yIGJvIGNvcGllcyAqLwogCQl1MzIgY29weV9yaW5nX2luZGV4OwogCX0g
Y29weTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX2FzaWMuaCBi
L2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX2FzaWMuaAppbmRleCBlM2YwMzZjMjBkNjQu
LmE3NGZhMThjZDI3YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25f
YXNpYy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX2FzaWMuaApAQCAtODYs
NyArODYsNyBAQCBzdHJ1Y3QgcmFkZW9uX2ZlbmNlICpyMTAwX2NvcHlfYmxpdChzdHJ1Y3QgcmFk
ZW9uX2RldmljZSAqcmRldiwKIAkJCQkgICAgdWludDY0X3Qgc3JjX29mZnNldCwKIAkJCQkgICAg
dWludDY0X3QgZHN0X29mZnNldCwKIAkJCQkgICAgdW5zaWduZWQgbnVtX2dwdV9wYWdlcywKLQkJ
CQkgICAgc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdik7CisJCQkJICAgIHN0cnVjdCBk
bWFfcmVzdiAqcmVzdik7CiBpbnQgcjEwMF9zZXRfc3VyZmFjZV9yZWcoc3RydWN0IHJhZGVvbl9k
ZXZpY2UgKnJkZXYsIGludCByZWcsCiAJCQkgdWludDMyX3QgdGlsaW5nX2ZsYWdzLCB1aW50MzJf
dCBwaXRjaCwKIAkJCSB1aW50MzJfdCBvZmZzZXQsIHVpbnQzMl90IG9ial9zaXplKTsKQEAgLTE1
Nyw3ICsxNTcsNyBAQCBzdHJ1Y3QgcmFkZW9uX2ZlbmNlICpyMjAwX2NvcHlfZG1hKHN0cnVjdCBy
YWRlb25fZGV2aWNlICpyZGV2LAogCQkJCSAgIHVpbnQ2NF90IHNyY19vZmZzZXQsCiAJCQkJICAg
dWludDY0X3QgZHN0X29mZnNldCwKIAkJCQkgICB1bnNpZ25lZCBudW1fZ3B1X3BhZ2VzLAotCQkJ
CSAgIHN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKnJlc3YpOworCQkJCSAgIHN0cnVjdCBkbWFf
cmVzdiAqcmVzdik7CiB2b2lkIHIyMDBfc2V0X3NhZmVfcmVnaXN0ZXJzKHN0cnVjdCByYWRlb25f
ZGV2aWNlICpyZGV2KTsKIAogLyoKQEAgLTM0NywxMSArMzQ3LDExIEBAIGludCByNjAwX2RtYV9y
aW5nX3Rlc3Qoc3RydWN0IHJhZGVvbl9kZXZpY2UgKnJkZXYsIHN0cnVjdCByYWRlb25fcmluZyAq
Y3ApOwogc3RydWN0IHJhZGVvbl9mZW5jZSAqcjYwMF9jb3B5X2NwZG1hKHN0cnVjdCByYWRlb25f
ZGV2aWNlICpyZGV2LAogCQkJCSAgICAgdWludDY0X3Qgc3JjX29mZnNldCwgdWludDY0X3QgZHN0
X29mZnNldCwKIAkJCQkgICAgIHVuc2lnbmVkIG51bV9ncHVfcGFnZXMsCi0JCQkJICAgICBzdHJ1
Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyZXN2KTsKKwkJCQkgICAgIHN0cnVjdCBkbWFfcmVzdiAq
cmVzdik7CiBzdHJ1Y3QgcmFkZW9uX2ZlbmNlICpyNjAwX2NvcHlfZG1hKHN0cnVjdCByYWRlb25f
ZGV2aWNlICpyZGV2LAogCQkJCSAgIHVpbnQ2NF90IHNyY19vZmZzZXQsIHVpbnQ2NF90IGRzdF9v
ZmZzZXQsCiAJCQkJICAgdW5zaWduZWQgbnVtX2dwdV9wYWdlcywKLQkJCQkgICBzdHJ1Y3QgcmVz
ZXJ2YXRpb25fb2JqZWN0ICpyZXN2KTsKKwkJCQkgICBzdHJ1Y3QgZG1hX3Jlc3YgKnJlc3YpOwog
dm9pZCByNjAwX2hwZF9pbml0KHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2KTsKIHZvaWQgcjYw
MF9ocGRfZmluaShzdHJ1Y3QgcmFkZW9uX2RldmljZSAqcmRldik7CiBib29sIHI2MDBfaHBkX3Nl
bnNlKHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2LCBlbnVtIHJhZGVvbl9ocGRfaWQgaHBkKTsK
QEAgLTQ3Myw3ICs0NzMsNyBAQCB2b2lkIHI3MDBfY3BfZmluaShzdHJ1Y3QgcmFkZW9uX2Rldmlj
ZSAqcmRldik7CiBzdHJ1Y3QgcmFkZW9uX2ZlbmNlICpydjc3MF9jb3B5X2RtYShzdHJ1Y3QgcmFk
ZW9uX2RldmljZSAqcmRldiwKIAkJCQkgICAgdWludDY0X3Qgc3JjX29mZnNldCwgdWludDY0X3Qg
ZHN0X29mZnNldCwKIAkJCQkgICAgdW5zaWduZWQgbnVtX2dwdV9wYWdlcywKLQkJCQkgICAgc3Ry
dWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdik7CisJCQkJICAgIHN0cnVjdCBkbWFfcmVzdiAq
cmVzdik7CiB1MzIgcnY3NzBfZ2V0X3hjbGsoc3RydWN0IHJhZGVvbl9kZXZpY2UgKnJkZXYpOwog
aW50IHJ2NzcwX3NldF91dmRfY2xvY2tzKHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2LCB1MzIg
dmNsaywgdTMyIGRjbGspOwogaW50IHJ2NzcwX2dldF90ZW1wKHN0cnVjdCByYWRlb25fZGV2aWNl
ICpyZGV2KTsKQEAgLTU0Nyw3ICs1NDcsNyBAQCB2b2lkIGV2ZXJncmVlbl9kbWFfcmluZ19pYl9l
eGVjdXRlKHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2LAogc3RydWN0IHJhZGVvbl9mZW5jZSAq
ZXZlcmdyZWVuX2NvcHlfZG1hKHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2LAogCQkJCQl1aW50
NjRfdCBzcmNfb2Zmc2V0LCB1aW50NjRfdCBkc3Rfb2Zmc2V0LAogCQkJCQl1bnNpZ25lZCBudW1f
Z3B1X3BhZ2VzLAotCQkJCQlzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyZXN2KTsKKwkJCQkJ
c3RydWN0IGRtYV9yZXN2ICpyZXN2KTsKIGludCBldmVyZ3JlZW5fZ2V0X3RlbXAoc3RydWN0IHJh
ZGVvbl9kZXZpY2UgKnJkZXYpOwogaW50IGV2ZXJncmVlbl9nZXRfYWxsb3dlZF9pbmZvX3JlZ2lz
dGVyKHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2LAogCQkJCQl1MzIgcmVnLCB1MzIgKnZhbCk7
CkBAIC03MjUsNyArNzI1LDcgQEAgaW50IHNpX2liX3BhcnNlKHN0cnVjdCByYWRlb25fZGV2aWNl
ICpyZGV2LCBzdHJ1Y3QgcmFkZW9uX2liICppYik7CiBzdHJ1Y3QgcmFkZW9uX2ZlbmNlICpzaV9j
b3B5X2RtYShzdHJ1Y3QgcmFkZW9uX2RldmljZSAqcmRldiwKIAkJCQkgdWludDY0X3Qgc3JjX29m
ZnNldCwgdWludDY0X3QgZHN0X29mZnNldCwKIAkJCQkgdW5zaWduZWQgbnVtX2dwdV9wYWdlcywK
LQkJCQkgc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdik7CisJCQkJIHN0cnVjdCBkbWFf
cmVzdiAqcmVzdik7CiAKIHZvaWQgc2lfZG1hX3ZtX2NvcHlfcGFnZXMoc3RydWN0IHJhZGVvbl9k
ZXZpY2UgKnJkZXYsCiAJCQkgIHN0cnVjdCByYWRlb25faWIgKmliLApAQCAtNzk2LDExICs3OTYs
MTEgQEAgdm9pZCBjaWtfc2RtYV9yaW5nX2liX2V4ZWN1dGUoc3RydWN0IHJhZGVvbl9kZXZpY2Ug
KnJkZXYsIHN0cnVjdCByYWRlb25faWIgKmliKTsKIHN0cnVjdCByYWRlb25fZmVuY2UgKmNpa19j
b3B5X2RtYShzdHJ1Y3QgcmFkZW9uX2RldmljZSAqcmRldiwKIAkJCQkgIHVpbnQ2NF90IHNyY19v
ZmZzZXQsIHVpbnQ2NF90IGRzdF9vZmZzZXQsCiAJCQkJICB1bnNpZ25lZCBudW1fZ3B1X3BhZ2Vz
LAotCQkJCSAgc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdik7CisJCQkJICBzdHJ1Y3Qg
ZG1hX3Jlc3YgKnJlc3YpOwogc3RydWN0IHJhZGVvbl9mZW5jZSAqY2lrX2NvcHlfY3BkbWEoc3Ry
dWN0IHJhZGVvbl9kZXZpY2UgKnJkZXYsCiAJCQkJICAgIHVpbnQ2NF90IHNyY19vZmZzZXQsIHVp
bnQ2NF90IGRzdF9vZmZzZXQsCiAJCQkJICAgIHVuc2lnbmVkIG51bV9ncHVfcGFnZXMsCi0JCQkJ
ICAgIHN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKnJlc3YpOworCQkJCSAgICBzdHJ1Y3QgZG1h
X3Jlc3YgKnJlc3YpOwogaW50IGNpa19zZG1hX3JpbmdfdGVzdChzdHJ1Y3QgcmFkZW9uX2Rldmlj
ZSAqcmRldiwgc3RydWN0IHJhZGVvbl9yaW5nICpyaW5nKTsKIGludCBjaWtfc2RtYV9pYl90ZXN0
KHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2LCBzdHJ1Y3QgcmFkZW9uX3JpbmcgKnJpbmcpOwog
Ym9vbCBjaWtfc2RtYV9pc19sb2NrdXAoc3RydWN0IHJhZGVvbl9kZXZpY2UgKnJkZXYsIHN0cnVj
dCByYWRlb25fcmluZyAqcmluZyk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9u
L3JhZGVvbl9iZW5jaG1hcmsuYyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX2JlbmNo
bWFyay5jCmluZGV4IDFlYTUwY2UxNjMxMi4uYWM5YTVlYzQ4MWMzIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9iZW5jaG1hcmsuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vcmFkZW9uL3JhZGVvbl9iZW5jaG1hcmsuYwpAQCAtMzUsNyArMzUsNyBAQAogc3RhdGljIGlu
dCByYWRlb25fYmVuY2htYXJrX2RvX21vdmUoc3RydWN0IHJhZGVvbl9kZXZpY2UgKnJkZXYsIHVu
c2lnbmVkIHNpemUsCiAJCQkJICAgIHVpbnQ2NF90IHNhZGRyLCB1aW50NjRfdCBkYWRkciwKIAkJ
CQkgICAgaW50IGZsYWcsIGludCBuLAotCQkJCSAgICBzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0
ICpyZXN2KQorCQkJCSAgICBzdHJ1Y3QgZG1hX3Jlc3YgKnJlc3YpCiB7CiAJdW5zaWduZWQgbG9u
ZyBzdGFydF9qaWZmaWVzOwogCXVuc2lnbmVkIGxvbmcgZW5kX2ppZmZpZXM7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9jcy5jIGIvZHJpdmVycy9ncHUvZHJtL3Jh
ZGVvbi9yYWRlb25fY3MuYwppbmRleCA3ZTUyNTRhMzRlODQuLjdiNTQ2MDY3ODM4MiAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fY3MuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vcmFkZW9uL3JhZGVvbl9jcy5jCkBAIC0yNTUsNyArMjU1LDcgQEAgc3RhdGljIGludCBy
YWRlb25fY3Nfc3luY19yaW5ncyhzdHJ1Y3QgcmFkZW9uX2NzX3BhcnNlciAqcCkKIAlpbnQgcjsK
IAogCWxpc3RfZm9yX2VhY2hfZW50cnkocmVsb2MsICZwLT52YWxpZGF0ZWQsIHR2LmhlYWQpIHsK
LQkJc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdjsKKwkJc3RydWN0IGRtYV9yZXN2ICpy
ZXN2OwogCiAJCXJlc3YgPSByZWxvYy0+cm9iai0+dGJvLmJhc2UucmVzdjsKIAkJciA9IHJhZGVv
bl9zeW5jX3Jlc3YocC0+cmRldiwgJnAtPmliLnN5bmMsIHJlc3YsCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9kaXNwbGF5LmMgYi9kcml2ZXJzL2dwdS9kcm0vcmFk
ZW9uL3JhZGVvbl9kaXNwbGF5LmMKaW5kZXggN2JmNzMyMzBhYzBiLi5lODFiMDFmOGRiOTAgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX2Rpc3BsYXkuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9kaXNwbGF5LmMKQEAgLTUzMyw3ICs1MzMsNyBA
QCBzdGF0aWMgaW50IHJhZGVvbl9jcnRjX3BhZ2VfZmxpcF90YXJnZXQoc3RydWN0IGRybV9jcnRj
ICpjcnRjLAogCQlEUk1fRVJST1IoImZhaWxlZCB0byBwaW4gbmV3IHJibyBidWZmZXIgYmVmb3Jl
IGZsaXBcbiIpOwogCQlnb3RvIGNsZWFudXA7CiAJfQotCXdvcmstPmZlbmNlID0gZG1hX2ZlbmNl
X2dldChyZXNlcnZhdGlvbl9vYmplY3RfZ2V0X2V4Y2wobmV3X3Jiby0+dGJvLmJhc2UucmVzdikp
OworCXdvcmstPmZlbmNlID0gZG1hX2ZlbmNlX2dldChkbWFfcmVzdl9nZXRfZXhjbChuZXdfcmJv
LT50Ym8uYmFzZS5yZXN2KSk7CiAJcmFkZW9uX2JvX2dldF90aWxpbmdfZmxhZ3MobmV3X3Jibywg
JnRpbGluZ19mbGFncywgTlVMTCk7CiAJcmFkZW9uX2JvX3VucmVzZXJ2ZShuZXdfcmJvKTsKIApk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fZ2VtLmMgYi9kcml2ZXJz
L2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9nZW0uYwppbmRleCAwMzg3M2YyMWE3MzQuLjRjZjU4ZGJi
ZTQzOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fZ2VtLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fZ2VtLmMKQEAgLTExNCw3ICsxMTQsNyBA
QCBzdGF0aWMgaW50IHJhZGVvbl9nZW1fc2V0X2RvbWFpbihzdHJ1Y3QgZHJtX2dlbV9vYmplY3Qg
KmdvYmosCiAJfQogCWlmIChkb21haW4gPT0gUkFERU9OX0dFTV9ET01BSU5fQ1BVKSB7CiAJCS8q
IEFza2luZyBmb3IgY3B1IGFjY2VzcyB3YWl0IGZvciBvYmplY3QgaWRsZSAqLwotCQlyID0gcmVz
ZXJ2YXRpb25fb2JqZWN0X3dhaXRfdGltZW91dF9yY3Uocm9iai0+dGJvLmJhc2UucmVzdiwgdHJ1
ZSwgdHJ1ZSwgMzAgKiBIWik7CisJCXIgPSBkbWFfcmVzdl93YWl0X3RpbWVvdXRfcmN1KHJvYmot
PnRiby5iYXNlLnJlc3YsIHRydWUsIHRydWUsIDMwICogSFopOwogCQlpZiAoIXIpCiAJCQlyID0g
LUVCVVNZOwogCkBAIC00NDksNyArNDQ5LDcgQEAgaW50IHJhZGVvbl9nZW1fYnVzeV9pb2N0bChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCX0KIAlyb2JqID0gZ2VtX3RvX3Jh
ZGVvbl9ibyhnb2JqKTsKIAotCXIgPSByZXNlcnZhdGlvbl9vYmplY3RfdGVzdF9zaWduYWxlZF9y
Y3Uocm9iai0+dGJvLmJhc2UucmVzdiwgdHJ1ZSk7CisJciA9IGRtYV9yZXN2X3Rlc3Rfc2lnbmFs
ZWRfcmN1KHJvYmotPnRiby5iYXNlLnJlc3YsIHRydWUpOwogCWlmIChyID09IDApCiAJCXIgPSAt
RUJVU1k7CiAJZWxzZQpAQCAtNDc4LDcgKzQ3OCw3IEBAIGludCByYWRlb25fZ2VtX3dhaXRfaWRs
ZV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCX0KIAlyb2JqID0g
Z2VtX3RvX3JhZGVvbl9ibyhnb2JqKTsKIAotCXJldCA9IHJlc2VydmF0aW9uX29iamVjdF93YWl0
X3RpbWVvdXRfcmN1KHJvYmotPnRiby5iYXNlLnJlc3YsIHRydWUsIHRydWUsIDMwICogSFopOwor
CXJldCA9IGRtYV9yZXN2X3dhaXRfdGltZW91dF9yY3Uocm9iai0+dGJvLmJhc2UucmVzdiwgdHJ1
ZSwgdHJ1ZSwgMzAgKiBIWik7CiAJaWYgKHJldCA9PSAwKQogCQlyID0gLUVCVVNZOwogCWVsc2Ug
aWYgKHJldCA8IDApCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9t
bi5jIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fbW4uYwppbmRleCAwZDY0YWNlMGU2
YzEuLjY5MDJmOTk4ZWRlOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRl
b25fbW4uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9tbi5jCkBAIC0xNjMs
NyArMTYzLDcgQEAgc3RhdGljIGludCByYWRlb25fbW5faW52YWxpZGF0ZV9yYW5nZV9zdGFydChz
dHJ1Y3QgbW11X25vdGlmaWVyICptbiwKIAkJCQljb250aW51ZTsKIAkJCX0KIAotCQkJciA9IHJl
c2VydmF0aW9uX29iamVjdF93YWl0X3RpbWVvdXRfcmN1KGJvLT50Ym8uYmFzZS5yZXN2LAorCQkJ
ciA9IGRtYV9yZXN2X3dhaXRfdGltZW91dF9yY3UoYm8tPnRiby5iYXNlLnJlc3YsCiAJCQkJdHJ1
ZSwgZmFsc2UsIE1BWF9TQ0hFRFVMRV9USU1FT1VUKTsKIAkJCWlmIChyIDw9IDApCiAJCQkJRFJN
X0VSUk9SKCIoJWxkKSBmYWlsZWQgdG8gd2FpdCBmb3IgdXNlciBib1xuIiwgcik7CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9vYmplY3QuYyBiL2RyaXZlcnMvZ3B1
L2RybS9yYWRlb24vcmFkZW9uX29iamVjdC5jCmluZGV4IDlkYjhiYTI5ZWY2OC4uMmFiZTFlYWI0
NzFmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9vYmplY3QuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9vYmplY3QuYwpAQCAtMTgzLDcgKzE4
Myw3IEBAIHZvaWQgcmFkZW9uX3R0bV9wbGFjZW1lbnRfZnJvbV9kb21haW4oc3RydWN0IHJhZGVv
bl9ibyAqcmJvLCB1MzIgZG9tYWluKQogaW50IHJhZGVvbl9ib19jcmVhdGUoc3RydWN0IHJhZGVv
bl9kZXZpY2UgKnJkZXYsCiAJCSAgICAgdW5zaWduZWQgbG9uZyBzaXplLCBpbnQgYnl0ZV9hbGln
biwgYm9vbCBrZXJuZWwsCiAJCSAgICAgdTMyIGRvbWFpbiwgdTMyIGZsYWdzLCBzdHJ1Y3Qgc2df
dGFibGUgKnNnLAotCQkgICAgIHN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKnJlc3YsCisJCSAg
ICAgc3RydWN0IGRtYV9yZXN2ICpyZXN2LAogCQkgICAgIHN0cnVjdCByYWRlb25fYm8gKipib19w
dHIpCiB7CiAJc3RydWN0IHJhZGVvbl9ibyAqYm87CkBAIC02MTAsNyArNjEwLDcgQEAgaW50IHJh
ZGVvbl9ib19nZXRfc3VyZmFjZV9yZWcoc3RydWN0IHJhZGVvbl9ibyAqYm8pCiAJaW50IHN0ZWFs
OwogCWludCBpOwogCi0JcmVzZXJ2YXRpb25fb2JqZWN0X2Fzc2VydF9oZWxkKGJvLT50Ym8uYmFz
ZS5yZXN2KTsKKwlkbWFfcmVzdl9hc3NlcnRfaGVsZChiby0+dGJvLmJhc2UucmVzdik7CiAKIAlp
ZiAoIWJvLT50aWxpbmdfZmxhZ3MpCiAJCXJldHVybiAwOwpAQCAtNzM2LDcgKzczNiw3IEBAIHZv
aWQgcmFkZW9uX2JvX2dldF90aWxpbmdfZmxhZ3Moc3RydWN0IHJhZGVvbl9ibyAqYm8sCiAJCQkJ
dWludDMyX3QgKnRpbGluZ19mbGFncywKIAkJCQl1aW50MzJfdCAqcGl0Y2gpCiB7Ci0JcmVzZXJ2
YXRpb25fb2JqZWN0X2Fzc2VydF9oZWxkKGJvLT50Ym8uYmFzZS5yZXN2KTsKKwlkbWFfcmVzdl9h
c3NlcnRfaGVsZChiby0+dGJvLmJhc2UucmVzdik7CiAKIAlpZiAodGlsaW5nX2ZsYWdzKQogCQkq
dGlsaW5nX2ZsYWdzID0gYm8tPnRpbGluZ19mbGFnczsKQEAgLTc0OCw3ICs3NDgsNyBAQCBpbnQg
cmFkZW9uX2JvX2NoZWNrX3RpbGluZyhzdHJ1Y3QgcmFkZW9uX2JvICpibywgYm9vbCBoYXNfbW92
ZWQsCiAJCQkJYm9vbCBmb3JjZV9kcm9wKQogewogCWlmICghZm9yY2VfZHJvcCkKLQkJcmVzZXJ2
YXRpb25fb2JqZWN0X2Fzc2VydF9oZWxkKGJvLT50Ym8uYmFzZS5yZXN2KTsKKwkJZG1hX3Jlc3Zf
YXNzZXJ0X2hlbGQoYm8tPnRiby5iYXNlLnJlc3YpOwogCiAJaWYgKCEoYm8tPnRpbGluZ19mbGFn
cyAmIFJBREVPTl9USUxJTkdfU1VSRkFDRSkpCiAJCXJldHVybiAwOwpAQCAtODcwLDEwICs4NzAs
MTAgQEAgaW50IHJhZGVvbl9ib193YWl0KHN0cnVjdCByYWRlb25fYm8gKmJvLCB1MzIgKm1lbV90
eXBlLCBib29sIG5vX3dhaXQpCiB2b2lkIHJhZGVvbl9ib19mZW5jZShzdHJ1Y3QgcmFkZW9uX2Jv
ICpibywgc3RydWN0IHJhZGVvbl9mZW5jZSAqZmVuY2UsCiAJCSAgICAgYm9vbCBzaGFyZWQpCiB7
Ci0Jc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdiA9IGJvLT50Ym8uYmFzZS5yZXN2Owor
CXN0cnVjdCBkbWFfcmVzdiAqcmVzdiA9IGJvLT50Ym8uYmFzZS5yZXN2OwogCiAJaWYgKHNoYXJl
ZCkKLQkJcmVzZXJ2YXRpb25fb2JqZWN0X2FkZF9zaGFyZWRfZmVuY2UocmVzdiwgJmZlbmNlLT5i
YXNlKTsKKwkJZG1hX3Jlc3ZfYWRkX3NoYXJlZF9mZW5jZShyZXN2LCAmZmVuY2UtPmJhc2UpOwog
CWVsc2UKLQkJcmVzZXJ2YXRpb25fb2JqZWN0X2FkZF9leGNsX2ZlbmNlKHJlc3YsICZmZW5jZS0+
YmFzZSk7CisJCWRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlKHJlc3YsICZmZW5jZS0+YmFzZSk7CiB9
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9vYmplY3QuaCBiL2Ry
aXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX29iamVjdC5oCmluZGV4IGU1NTU0YmY5MTQwZS4u
ZDIzZjJlZDQxMjZlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9v
YmplY3QuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9vYmplY3QuaApAQCAt
MTI2LDcgKzEyNiw3IEBAIGV4dGVybiBpbnQgcmFkZW9uX2JvX2NyZWF0ZShzdHJ1Y3QgcmFkZW9u
X2RldmljZSAqcmRldiwKIAkJCSAgICB1bnNpZ25lZCBsb25nIHNpemUsIGludCBieXRlX2FsaWdu
LAogCQkJICAgIGJvb2wga2VybmVsLCB1MzIgZG9tYWluLCB1MzIgZmxhZ3MsCiAJCQkgICAgc3Ry
dWN0IHNnX3RhYmxlICpzZywKLQkJCSAgICBzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyZXN2
LAorCQkJICAgIHN0cnVjdCBkbWFfcmVzdiAqcmVzdiwKIAkJCSAgICBzdHJ1Y3QgcmFkZW9uX2Jv
ICoqYm9fcHRyKTsKIGV4dGVybiBpbnQgcmFkZW9uX2JvX2ttYXAoc3RydWN0IHJhZGVvbl9ibyAq
Ym8sIHZvaWQgKipwdHIpOwogZXh0ZXJuIHZvaWQgcmFkZW9uX2JvX2t1bm1hcChzdHJ1Y3QgcmFk
ZW9uX2JvICpibyk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9w
cmltZS5jIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fcHJpbWUuYwppbmRleCA1MmIw
ZDBjZDhjYmUuLmI5MDZlOGZiZDVmMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JhZGVv
bi9yYWRlb25fcHJpbWUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9wcmlt
ZS5jCkBAIC02MywxNSArNjMsMTUgQEAgc3RydWN0IGRybV9nZW1fb2JqZWN0ICpyYWRlb25fZ2Vt
X3ByaW1lX2ltcG9ydF9zZ190YWJsZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogCQkJCQkJCXN0
cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFjaCwKIAkJCQkJCQlzdHJ1Y3Qgc2dfdGFibGUg
KnNnKQogewotCXN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKnJlc3YgPSBhdHRhY2gtPmRtYWJ1
Zi0+cmVzdjsKKwlzdHJ1Y3QgZG1hX3Jlc3YgKnJlc3YgPSBhdHRhY2gtPmRtYWJ1Zi0+cmVzdjsK
IAlzdHJ1Y3QgcmFkZW9uX2RldmljZSAqcmRldiA9IGRldi0+ZGV2X3ByaXZhdGU7CiAJc3RydWN0
IHJhZGVvbl9ibyAqYm87CiAJaW50IHJldDsKIAotCXJlc2VydmF0aW9uX29iamVjdF9sb2NrKHJl
c3YsIE5VTEwpOworCWRtYV9yZXN2X2xvY2socmVzdiwgTlVMTCk7CiAJcmV0ID0gcmFkZW9uX2Jv
X2NyZWF0ZShyZGV2LCBhdHRhY2gtPmRtYWJ1Zi0+c2l6ZSwgUEFHRV9TSVpFLCBmYWxzZSwKIAkJ
CSAgICAgICBSQURFT05fR0VNX0RPTUFJTl9HVFQsIDAsIHNnLCByZXN2LCAmYm8pOwotCXJlc2Vy
dmF0aW9uX29iamVjdF91bmxvY2socmVzdik7CisJZG1hX3Jlc3ZfdW5sb2NrKHJlc3YpOwogCWlm
IChyZXQpCiAJCXJldHVybiBFUlJfUFRSKHJldCk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9yYWRlb24vcmFkZW9uX3N5bmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9u
X3N5bmMuYwppbmRleCA4Yzk3ODBiNWE4ODQuLjU1Y2M3N2E3M2M3YiAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fc3luYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9y
YWRlb24vcmFkZW9uX3N5bmMuYwpAQCAtODcsMzAgKzg3LDMwIEBAIHZvaWQgcmFkZW9uX3N5bmNf
ZmVuY2Uoc3RydWN0IHJhZGVvbl9zeW5jICpzeW5jLAogICovCiBpbnQgcmFkZW9uX3N5bmNfcmVz
dihzdHJ1Y3QgcmFkZW9uX2RldmljZSAqcmRldiwKIAkJICAgICBzdHJ1Y3QgcmFkZW9uX3N5bmMg
KnN5bmMsCi0JCSAgICAgc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdiwKKwkJICAgICBz
dHJ1Y3QgZG1hX3Jlc3YgKnJlc3YsCiAJCSAgICAgYm9vbCBzaGFyZWQpCiB7Ci0Jc3RydWN0IHJl
c2VydmF0aW9uX29iamVjdF9saXN0ICpmbGlzdDsKKwlzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCAqZmxp
c3Q7CiAJc3RydWN0IGRtYV9mZW5jZSAqZjsKIAlzdHJ1Y3QgcmFkZW9uX2ZlbmNlICpmZW5jZTsK
IAl1bnNpZ25lZCBpOwogCWludCByID0gMDsKIAogCS8qIGFsd2F5cyBzeW5jIHRvIHRoZSBleGNs
dXNpdmUgZmVuY2UgKi8KLQlmID0gcmVzZXJ2YXRpb25fb2JqZWN0X2dldF9leGNsKHJlc3YpOwor
CWYgPSBkbWFfcmVzdl9nZXRfZXhjbChyZXN2KTsKIAlmZW5jZSA9IGYgPyB0b19yYWRlb25fZmVu
Y2UoZikgOiBOVUxMOwogCWlmIChmZW5jZSAmJiBmZW5jZS0+cmRldiA9PSByZGV2KQogCQlyYWRl
b25fc3luY19mZW5jZShzeW5jLCBmZW5jZSk7CiAJZWxzZSBpZiAoZikKIAkJciA9IGRtYV9mZW5j
ZV93YWl0KGYsIHRydWUpOwogCi0JZmxpc3QgPSByZXNlcnZhdGlvbl9vYmplY3RfZ2V0X2xpc3Qo
cmVzdik7CisJZmxpc3QgPSBkbWFfcmVzdl9nZXRfbGlzdChyZXN2KTsKIAlpZiAoc2hhcmVkIHx8
ICFmbGlzdCB8fCByKQogCQlyZXR1cm4gcjsKIAogCWZvciAoaSA9IDA7IGkgPCBmbGlzdC0+c2hh
cmVkX2NvdW50OyArK2kpIHsKIAkJZiA9IHJjdV9kZXJlZmVyZW5jZV9wcm90ZWN0ZWQoZmxpc3Qt
PnNoYXJlZFtpXSwKLQkJCQkJICAgICAgcmVzZXJ2YXRpb25fb2JqZWN0X2hlbGQocmVzdikpOwor
CQkJCQkgICAgICBkbWFfcmVzdl9oZWxkKHJlc3YpKTsKIAkJZmVuY2UgPSB0b19yYWRlb25fZmVu
Y2UoZik7CiAJCWlmIChmZW5jZSAmJiBmZW5jZS0+cmRldiA9PSByZGV2KQogCQkJcmFkZW9uX3N5
bmNfZmVuY2Uoc3luYywgZmVuY2UpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JhZGVv
bi9yYWRlb25fdXZkLmMgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl91dmQuYwppbmRl
eCAzMTFlNjljMmVkN2YuLjFhZDVjM2I4NmI2NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L3JhZGVvbi9yYWRlb25fdXZkLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25f
dXZkLmMKQEAgLTQ3Nyw3ICs0NzcsNyBAQCBzdGF0aWMgaW50IHJhZGVvbl91dmRfY3NfbXNnKHN0
cnVjdCByYWRlb25fY3NfcGFyc2VyICpwLCBzdHJ1Y3QgcmFkZW9uX2JvICpibywKIAkJcmV0dXJu
IC1FSU5WQUw7CiAJfQogCi0JZiA9IHJlc2VydmF0aW9uX29iamVjdF9nZXRfZXhjbChiby0+dGJv
LmJhc2UucmVzdik7CisJZiA9IGRtYV9yZXN2X2dldF9leGNsKGJvLT50Ym8uYmFzZS5yZXN2KTsK
IAlpZiAoZikgewogCQlyID0gcmFkZW9uX2ZlbmNlX3dhaXQoKHN0cnVjdCByYWRlb25fZmVuY2Ug
KilmLCBmYWxzZSk7CiAJCWlmIChyKSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcmFk
ZW9uL3JhZGVvbl92bS5jIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fdm0uYwppbmRl
eCBlNDhhMDU1MzMxMjYuLmUwYWQ1NDc3ODZlOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L3JhZGVvbi9yYWRlb25fdm0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl92
bS5jCkBAIC04MzEsNyArODMxLDcgQEAgc3RhdGljIGludCByYWRlb25fdm1fdXBkYXRlX3B0ZXMo
c3RydWN0IHJhZGVvbl9kZXZpY2UgKnJkZXYsCiAJCWludCByOwogCiAJCXJhZGVvbl9zeW5jX3Jl
c3YocmRldiwgJmliLT5zeW5jLCBwdC0+dGJvLmJhc2UucmVzdiwgdHJ1ZSk7Ci0JCXIgPSByZXNl
cnZhdGlvbl9vYmplY3RfcmVzZXJ2ZV9zaGFyZWQocHQtPnRiby5iYXNlLnJlc3YsIDEpOworCQly
ID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQocHQtPnRiby5iYXNlLnJlc3YsIDEpOwogCQlpZiAo
cikKIAkJCXJldHVybiByOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3J2
NzcwX2RtYS5jIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9ydjc3MF9kbWEuYwppbmRleCAwODY2
YjM4ZWYyNjQuLjRjOTE2MTRiNWU3MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JhZGVv
bi9ydjc3MF9kbWEuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3J2NzcwX2RtYS5jCkBA
IC00Miw3ICs0Miw3IEBACiBzdHJ1Y3QgcmFkZW9uX2ZlbmNlICpydjc3MF9jb3B5X2RtYShzdHJ1
Y3QgcmFkZW9uX2RldmljZSAqcmRldiwKIAkJCQkgICAgdWludDY0X3Qgc3JjX29mZnNldCwgdWlu
dDY0X3QgZHN0X29mZnNldCwKIAkJCQkgICAgdW5zaWduZWQgbnVtX2dwdV9wYWdlcywKLQkJCQkg
ICAgc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdikKKwkJCQkgICAgc3RydWN0IGRtYV9y
ZXN2ICpyZXN2KQogewogCXN0cnVjdCByYWRlb25fZmVuY2UgKmZlbmNlOwogCXN0cnVjdCByYWRl
b25fc3luYyBzeW5jOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9zaV9kbWEu
YyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vc2lfZG1hLmMKaW5kZXggNDc3M2JiN2Q5NDdlLi5k
MmZhMzAyYTViZTkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vc2lfZG1hLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9zaV9kbWEuYwpAQCAtMjMxLDcgKzIzMSw3IEBA
IHZvaWQgc2lfZG1hX3ZtX2ZsdXNoKHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2LCBzdHJ1Y3Qg
cmFkZW9uX3JpbmcgKnJpbmcsCiBzdHJ1Y3QgcmFkZW9uX2ZlbmNlICpzaV9jb3B5X2RtYShzdHJ1
Y3QgcmFkZW9uX2RldmljZSAqcmRldiwKIAkJCQkgdWludDY0X3Qgc3JjX29mZnNldCwgdWludDY0
X3QgZHN0X29mZnNldCwKIAkJCQkgdW5zaWduZWQgbnVtX2dwdV9wYWdlcywKLQkJCQkgc3RydWN0
IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdikKKwkJCQkgc3RydWN0IGRtYV9yZXN2ICpyZXN2KQog
ewogCXN0cnVjdCByYWRlb25fZmVuY2UgKmZlbmNlOwogCXN0cnVjdCByYWRlb25fc3luYyBzeW5j
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm8uYyBiL2RyaXZlcnMvZ3B1
L2RybS90dG0vdHRtX2JvLmMKaW5kZXggMTBhODYxYTE2OTBjLi41OGQxZjJiMjgxMzIgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L3R0bS90dG1fYm8uYwpAQCAtNDEsNyArNDEsNyBAQAogI2luY2x1ZGUgPGxpbnV4L2ZpbGUuaD4K
ICNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KICNpbmNsdWRlIDxsaW51eC9hdG9taWMuaD4KLSNp
bmNsdWRlIDxsaW51eC9yZXNlcnZhdGlvbi5oPgorI2luY2x1ZGUgPGxpbnV4L2RtYS1yZXN2Lmg+
CiAKIHN0YXRpYyB2b2lkIHR0bV9ib19nbG9iYWxfa29ial9yZWxlYXNlKHN0cnVjdCBrb2JqZWN0
ICprb2JqKTsKIApAQCAtMTYxLDcgKzE2MSw3IEBAIHN0YXRpYyB2b2lkIHR0bV9ib19yZWxlYXNl
X2xpc3Qoc3RydWN0IGtyZWYgKmxpc3Rfa3JlZikKIAlhdG9taWNfZGVjKCZiby0+YmRldi0+Z2xv
Yi0+Ym9fY291bnQpOwogCWRtYV9mZW5jZV9wdXQoYm8tPm1vdmluZyk7CiAJaWYgKCF0dG1fYm9f
dXNlc19lbWJlZGRlZF9nZW1fb2JqZWN0KGJvKSkKLQkJcmVzZXJ2YXRpb25fb2JqZWN0X2Zpbmko
JmJvLT5iYXNlLl9yZXN2KTsKKwkJZG1hX3Jlc3ZfZmluaSgmYm8tPmJhc2UuX3Jlc3YpOwogCW11
dGV4X2Rlc3Ryb3koJmJvLT53dV9tdXRleCk7CiAJYm8tPmRlc3Ryb3koYm8pOwogCXR0bV9tZW1f
Z2xvYmFsX2ZyZWUoYmRldi0+Z2xvYi0+bWVtX2dsb2IsIGFjY19zaXplKTsKQEAgLTE3Myw3ICsx
NzMsNyBAQCBzdGF0aWMgdm9pZCB0dG1fYm9fYWRkX21lbV90b19scnUoc3RydWN0IHR0bV9idWZm
ZXJfb2JqZWN0ICpibywKIAlzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiA9IGJvLT5iZGV2Owog
CXN0cnVjdCB0dG1fbWVtX3R5cGVfbWFuYWdlciAqbWFuOwogCi0JcmVzZXJ2YXRpb25fb2JqZWN0
X2Fzc2VydF9oZWxkKGJvLT5iYXNlLnJlc3YpOworCWRtYV9yZXN2X2Fzc2VydF9oZWxkKGJvLT5i
YXNlLnJlc3YpOwogCiAJaWYgKCFsaXN0X2VtcHR5KCZiby0+bHJ1KSkKIAkJcmV0dXJuOwpAQCAt
MjQ0LDcgKzI0NCw3IEBAIHN0YXRpYyB2b2lkIHR0bV9ib19idWxrX21vdmVfc2V0X3BvcyhzdHJ1
Y3QgdHRtX2xydV9idWxrX21vdmVfcG9zICpwb3MsCiB2b2lkIHR0bV9ib19tb3ZlX3RvX2xydV90
YWlsKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJCQkgICAgIHN0cnVjdCB0dG1fbHJ1
X2J1bGtfbW92ZSAqYnVsaykKIHsKLQlyZXNlcnZhdGlvbl9vYmplY3RfYXNzZXJ0X2hlbGQoYm8t
PmJhc2UucmVzdik7CisJZG1hX3Jlc3ZfYXNzZXJ0X2hlbGQoYm8tPmJhc2UucmVzdik7CiAKIAl0
dG1fYm9fZGVsX2Zyb21fbHJ1KGJvKTsKIAl0dG1fYm9fYWRkX3RvX2xydShibyk7CkBAIC0yNzcs
OCArMjc3LDggQEAgdm9pZCB0dG1fYm9fYnVsa19tb3ZlX2xydV90YWlsKHN0cnVjdCB0dG1fbHJ1
X2J1bGtfbW92ZSAqYnVsaykKIAkJaWYgKCFwb3MtPmZpcnN0KQogCQkJY29udGludWU7CiAKLQkJ
cmVzZXJ2YXRpb25fb2JqZWN0X2Fzc2VydF9oZWxkKHBvcy0+Zmlyc3QtPmJhc2UucmVzdik7Ci0J
CXJlc2VydmF0aW9uX29iamVjdF9hc3NlcnRfaGVsZChwb3MtPmxhc3QtPmJhc2UucmVzdik7CisJ
CWRtYV9yZXN2X2Fzc2VydF9oZWxkKHBvcy0+Zmlyc3QtPmJhc2UucmVzdik7CisJCWRtYV9yZXN2
X2Fzc2VydF9oZWxkKHBvcy0+bGFzdC0+YmFzZS5yZXN2KTsKIAogCQltYW4gPSAmcG9zLT5maXJz
dC0+YmRldi0+bWFuW1RUTV9QTF9UVF07CiAJCWxpc3RfYnVsa19tb3ZlX3RhaWwoJm1hbi0+bHJ1
W2ldLCAmcG9zLT5maXJzdC0+bHJ1LApAQCAtMjkyLDggKzI5Miw4IEBAIHZvaWQgdHRtX2JvX2J1
bGtfbW92ZV9scnVfdGFpbChzdHJ1Y3QgdHRtX2xydV9idWxrX21vdmUgKmJ1bGspCiAJCWlmICgh
cG9zLT5maXJzdCkKIAkJCWNvbnRpbnVlOwogCi0JCXJlc2VydmF0aW9uX29iamVjdF9hc3NlcnRf
aGVsZChwb3MtPmZpcnN0LT5iYXNlLnJlc3YpOwotCQlyZXNlcnZhdGlvbl9vYmplY3RfYXNzZXJ0
X2hlbGQocG9zLT5sYXN0LT5iYXNlLnJlc3YpOworCQlkbWFfcmVzdl9hc3NlcnRfaGVsZChwb3Mt
PmZpcnN0LT5iYXNlLnJlc3YpOworCQlkbWFfcmVzdl9hc3NlcnRfaGVsZChwb3MtPmxhc3QtPmJh
c2UucmVzdik7CiAKIAkJbWFuID0gJnBvcy0+Zmlyc3QtPmJkZXYtPm1hbltUVE1fUExfVlJBTV07
CiAJCWxpc3RfYnVsa19tb3ZlX3RhaWwoJm1hbi0+bHJ1W2ldLCAmcG9zLT5maXJzdC0+bHJ1LApA
QCAtMzA3LDggKzMwNyw4IEBAIHZvaWQgdHRtX2JvX2J1bGtfbW92ZV9scnVfdGFpbChzdHJ1Y3Qg
dHRtX2xydV9idWxrX21vdmUgKmJ1bGspCiAJCWlmICghcG9zLT5maXJzdCkKIAkJCWNvbnRpbnVl
OwogCi0JCXJlc2VydmF0aW9uX29iamVjdF9hc3NlcnRfaGVsZChwb3MtPmZpcnN0LT5iYXNlLnJl
c3YpOwotCQlyZXNlcnZhdGlvbl9vYmplY3RfYXNzZXJ0X2hlbGQocG9zLT5sYXN0LT5iYXNlLnJl
c3YpOworCQlkbWFfcmVzdl9hc3NlcnRfaGVsZChwb3MtPmZpcnN0LT5iYXNlLnJlc3YpOworCQlk
bWFfcmVzdl9hc3NlcnRfaGVsZChwb3MtPmxhc3QtPmJhc2UucmVzdik7CiAKIAkJbHJ1ID0gJnBv
cy0+Zmlyc3QtPmJkZXYtPmdsb2ItPnN3YXBfbHJ1W2ldOwogCQlsaXN0X2J1bGtfbW92ZV90YWls
KGxydSwgJnBvcy0+Zmlyc3QtPnN3YXAsICZwb3MtPmxhc3QtPnN3YXApOwpAQCAtNDQyLDI5ICs0
NDIsMjkgQEAgc3RhdGljIGludCB0dG1fYm9faW5kaXZpZHVhbGl6ZV9yZXN2KHN0cnVjdCB0dG1f
YnVmZmVyX29iamVjdCAqYm8pCiAJaWYgKGJvLT5iYXNlLnJlc3YgPT0gJmJvLT5iYXNlLl9yZXN2
KQogCQlyZXR1cm4gMDsKIAotCUJVR19PTighcmVzZXJ2YXRpb25fb2JqZWN0X3RyeWxvY2soJmJv
LT5iYXNlLl9yZXN2KSk7CisJQlVHX09OKCFkbWFfcmVzdl90cnlsb2NrKCZiby0+YmFzZS5fcmVz
dikpOwogCi0JciA9IHJlc2VydmF0aW9uX29iamVjdF9jb3B5X2ZlbmNlcygmYm8tPmJhc2UuX3Jl
c3YsIGJvLT5iYXNlLnJlc3YpOworCXIgPSBkbWFfcmVzdl9jb3B5X2ZlbmNlcygmYm8tPmJhc2Uu
X3Jlc3YsIGJvLT5iYXNlLnJlc3YpOwogCWlmIChyKQotCQlyZXNlcnZhdGlvbl9vYmplY3RfdW5s
b2NrKCZiby0+YmFzZS5fcmVzdik7CisJCWRtYV9yZXN2X3VubG9jaygmYm8tPmJhc2UuX3Jlc3Yp
OwogCiAJcmV0dXJuIHI7CiB9CiAKIHN0YXRpYyB2b2lkIHR0bV9ib19mbHVzaF9hbGxfZmVuY2Vz
KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8pCiB7Ci0Jc3RydWN0IHJlc2VydmF0aW9uX29i
amVjdF9saXN0ICpmb2JqOworCXN0cnVjdCBkbWFfcmVzdl9saXN0ICpmb2JqOwogCXN0cnVjdCBk
bWFfZmVuY2UgKmZlbmNlOwogCWludCBpOwogCi0JZm9iaiA9IHJlc2VydmF0aW9uX29iamVjdF9n
ZXRfbGlzdCgmYm8tPmJhc2UuX3Jlc3YpOwotCWZlbmNlID0gcmVzZXJ2YXRpb25fb2JqZWN0X2dl
dF9leGNsKCZiby0+YmFzZS5fcmVzdik7CisJZm9iaiA9IGRtYV9yZXN2X2dldF9saXN0KCZiby0+
YmFzZS5fcmVzdik7CisJZmVuY2UgPSBkbWFfcmVzdl9nZXRfZXhjbCgmYm8tPmJhc2UuX3Jlc3Yp
OwogCWlmIChmZW5jZSAmJiAhZmVuY2UtPm9wcy0+c2lnbmFsZWQpCiAJCWRtYV9mZW5jZV9lbmFi
bGVfc3dfc2lnbmFsaW5nKGZlbmNlKTsKIAogCWZvciAoaSA9IDA7IGZvYmogJiYgaSA8IGZvYmot
PnNoYXJlZF9jb3VudDsgKytpKSB7CiAJCWZlbmNlID0gcmN1X2RlcmVmZXJlbmNlX3Byb3RlY3Rl
ZChmb2JqLT5zaGFyZWRbaV0sCi0JCQkJCXJlc2VydmF0aW9uX29iamVjdF9oZWxkKGJvLT5iYXNl
LnJlc3YpKTsKKwkJCQkJZG1hX3Jlc3ZfaGVsZChiby0+YmFzZS5yZXN2KSk7CiAKIAkJaWYgKCFm
ZW5jZS0+b3BzLT5zaWduYWxlZCkKIAkJCWRtYV9mZW5jZV9lbmFibGVfc3dfc2lnbmFsaW5nKGZl
bmNlKTsKQEAgLTQ4MiwyMyArNDgyLDIzIEBAIHN0YXRpYyB2b2lkIHR0bV9ib19jbGVhbnVwX3Jl
ZnNfb3JfcXVldWUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibykKIAkJLyogTGFzdCByZXNv
cnQsIGlmIHdlIGZhaWwgdG8gYWxsb2NhdGUgbWVtb3J5IGZvciB0aGUKIAkJICogZmVuY2VzIGJs
b2NrIGZvciB0aGUgQk8gdG8gYmVjb21lIGlkbGUKIAkJICovCi0JCXJlc2VydmF0aW9uX29iamVj
dF93YWl0X3RpbWVvdXRfcmN1KGJvLT5iYXNlLnJlc3YsIHRydWUsIGZhbHNlLAorCQlkbWFfcmVz
dl93YWl0X3RpbWVvdXRfcmN1KGJvLT5iYXNlLnJlc3YsIHRydWUsIGZhbHNlLAogCQkJCQkJICAg
IDMwICogSFopOwogCQlzcGluX2xvY2soJmdsb2ItPmxydV9sb2NrKTsKIAkJZ290byBlcnJvcjsK
IAl9CiAKIAlzcGluX2xvY2soJmdsb2ItPmxydV9sb2NrKTsKLQlyZXQgPSByZXNlcnZhdGlvbl9v
YmplY3RfdHJ5bG9jayhiby0+YmFzZS5yZXN2KSA/IDAgOiAtRUJVU1k7CisJcmV0ID0gZG1hX3Jl
c3ZfdHJ5bG9jayhiby0+YmFzZS5yZXN2KSA/IDAgOiAtRUJVU1k7CiAJaWYgKCFyZXQpIHsKLQkJ
aWYgKHJlc2VydmF0aW9uX29iamVjdF90ZXN0X3NpZ25hbGVkX3JjdSgmYm8tPmJhc2UuX3Jlc3Ys
IHRydWUpKSB7CisJCWlmIChkbWFfcmVzdl90ZXN0X3NpZ25hbGVkX3JjdSgmYm8tPmJhc2UuX3Jl
c3YsIHRydWUpKSB7CiAJCQl0dG1fYm9fZGVsX2Zyb21fbHJ1KGJvKTsKIAkJCXNwaW5fdW5sb2Nr
KCZnbG9iLT5scnVfbG9jayk7CiAJCQlpZiAoYm8tPmJhc2UucmVzdiAhPSAmYm8tPmJhc2UuX3Jl
c3YpCi0JCQkJcmVzZXJ2YXRpb25fb2JqZWN0X3VubG9jaygmYm8tPmJhc2UuX3Jlc3YpOworCQkJ
CWRtYV9yZXN2X3VubG9jaygmYm8tPmJhc2UuX3Jlc3YpOwogCiAJCQl0dG1fYm9fY2xlYW51cF9t
ZW10eXBlX3VzZShibyk7Ci0JCQlyZXNlcnZhdGlvbl9vYmplY3RfdW5sb2NrKGJvLT5iYXNlLnJl
c3YpOworCQkJZG1hX3Jlc3ZfdW5sb2NrKGJvLT5iYXNlLnJlc3YpOwogCQkJcmV0dXJuOwogCQl9
CiAKQEAgLTUxNCwxMCArNTE0LDEwIEBAIHN0YXRpYyB2b2lkIHR0bV9ib19jbGVhbnVwX3JlZnNf
b3JfcXVldWUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibykKIAkJCXR0bV9ib19hZGRfdG9f
bHJ1KGJvKTsKIAkJfQogCi0JCXJlc2VydmF0aW9uX29iamVjdF91bmxvY2soYm8tPmJhc2UucmVz
dik7CisJCWRtYV9yZXN2X3VubG9jayhiby0+YmFzZS5yZXN2KTsKIAl9CiAJaWYgKGJvLT5iYXNl
LnJlc3YgIT0gJmJvLT5iYXNlLl9yZXN2KQotCQlyZXNlcnZhdGlvbl9vYmplY3RfdW5sb2NrKCZi
by0+YmFzZS5fcmVzdik7CisJCWRtYV9yZXN2X3VubG9jaygmYm8tPmJhc2UuX3Jlc3YpOwogCiBl
cnJvcjoKIAlrcmVmX2dldCgmYm8tPmxpc3Rfa3JlZik7CkBAIC01NDYsNyArNTQ2LDcgQEAgc3Rh
dGljIGludCB0dG1fYm9fY2xlYW51cF9yZWZzKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8s
CiAJCQkgICAgICAgYm9vbCB1bmxvY2tfcmVzdikKIHsKIAlzdHJ1Y3QgdHRtX2JvX2dsb2JhbCAq
Z2xvYiA9IGJvLT5iZGV2LT5nbG9iOwotCXN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKnJlc3Y7
CisJc3RydWN0IGRtYV9yZXN2ICpyZXN2OwogCWludCByZXQ7CiAKIAlpZiAodW5saWtlbHkobGlz
dF9lbXB0eSgmYm8tPmRkZXN0cm95KSkpCkBAIC01NTQsNyArNTU0LDcgQEAgc3RhdGljIGludCB0
dG1fYm9fY2xlYW51cF9yZWZzKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJZWxzZQog
CQlyZXN2ID0gJmJvLT5iYXNlLl9yZXN2OwogCi0JaWYgKHJlc2VydmF0aW9uX29iamVjdF90ZXN0
X3NpZ25hbGVkX3JjdShyZXN2LCB0cnVlKSkKKwlpZiAoZG1hX3Jlc3ZfdGVzdF9zaWduYWxlZF9y
Y3UocmVzdiwgdHJ1ZSkpCiAJCXJldCA9IDA7CiAJZWxzZQogCQlyZXQgPSAtRUJVU1k7CkBAIC01
NjMsMTAgKzU2MywxMCBAQCBzdGF0aWMgaW50IHR0bV9ib19jbGVhbnVwX3JlZnMoc3RydWN0IHR0
bV9idWZmZXJfb2JqZWN0ICpibywKIAkJbG9uZyBscmV0OwogCiAJCWlmICh1bmxvY2tfcmVzdikK
LQkJCXJlc2VydmF0aW9uX29iamVjdF91bmxvY2soYm8tPmJhc2UucmVzdik7CisJCQlkbWFfcmVz
dl91bmxvY2soYm8tPmJhc2UucmVzdik7CiAJCXNwaW5fdW5sb2NrKCZnbG9iLT5scnVfbG9jayk7
CiAKLQkJbHJldCA9IHJlc2VydmF0aW9uX29iamVjdF93YWl0X3RpbWVvdXRfcmN1KHJlc3YsIHRy
dWUsCisJCWxyZXQgPSBkbWFfcmVzdl93YWl0X3RpbWVvdXRfcmN1KHJlc3YsIHRydWUsCiAJCQkJ
CQkJICAgaW50ZXJydXB0aWJsZSwKIAkJCQkJCQkgICAzMCAqIEhaKTsKIApAQCAtNTc2LDcgKzU3
Niw3IEBAIHN0YXRpYyBpbnQgdHRtX2JvX2NsZWFudXBfcmVmcyhzdHJ1Y3QgdHRtX2J1ZmZlcl9v
YmplY3QgKmJvLAogCQkJcmV0dXJuIC1FQlVTWTsKIAogCQlzcGluX2xvY2soJmdsb2ItPmxydV9s
b2NrKTsKLQkJaWYgKHVubG9ja19yZXN2ICYmICFyZXNlcnZhdGlvbl9vYmplY3RfdHJ5bG9jayhi
by0+YmFzZS5yZXN2KSkgeworCQlpZiAodW5sb2NrX3Jlc3YgJiYgIWRtYV9yZXN2X3RyeWxvY2so
Ym8tPmJhc2UucmVzdikpIHsKIAkJCS8qCiAJCQkgKiBXZSByYWNlZCwgYW5kIGxvc3QsIHNvbWVv
bmUgZWxzZSBob2xkcyB0aGUgcmVzZXJ2YXRpb24gbm93LAogCQkJICogYW5kIGlzIHByb2JhYmx5
IGJ1c3kgaW4gdHRtX2JvX2NsZWFudXBfbWVtdHlwZV91c2UuCkBAIC01OTMsNyArNTkzLDcgQEAg
c3RhdGljIGludCB0dG1fYm9fY2xlYW51cF9yZWZzKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAq
Ym8sCiAKIAlpZiAocmV0IHx8IHVubGlrZWx5KGxpc3RfZW1wdHkoJmJvLT5kZGVzdHJveSkpKSB7
CiAJCWlmICh1bmxvY2tfcmVzdikKLQkJCXJlc2VydmF0aW9uX29iamVjdF91bmxvY2soYm8tPmJh
c2UucmVzdik7CisJCQlkbWFfcmVzdl91bmxvY2soYm8tPmJhc2UucmVzdik7CiAJCXNwaW5fdW5s
b2NrKCZnbG9iLT5scnVfbG9jayk7CiAJCXJldHVybiByZXQ7CiAJfQpAQCAtNjA2LDcgKzYwNiw3
IEBAIHN0YXRpYyBpbnQgdHRtX2JvX2NsZWFudXBfcmVmcyhzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmpl
Y3QgKmJvLAogCXR0bV9ib19jbGVhbnVwX21lbXR5cGVfdXNlKGJvKTsKIAogCWlmICh1bmxvY2tf
cmVzdikKLQkJcmVzZXJ2YXRpb25fb2JqZWN0X3VubG9jayhiby0+YmFzZS5yZXN2KTsKKwkJZG1h
X3Jlc3ZfdW5sb2NrKGJvLT5iYXNlLnJlc3YpOwogCiAJcmV0dXJuIDA7CiB9CkBAIC02MzQsMTIg
KzYzNCwxMiBAQCBzdGF0aWMgYm9vbCB0dG1fYm9fZGVsYXllZF9kZWxldGUoc3RydWN0IHR0bV9i
b19kZXZpY2UgKmJkZXYsIGJvb2wgcmVtb3ZlX2FsbCkKIAogCQlpZiAocmVtb3ZlX2FsbCB8fCBi
by0+YmFzZS5yZXN2ICE9ICZiby0+YmFzZS5fcmVzdikgewogCQkJc3Bpbl91bmxvY2soJmdsb2It
PmxydV9sb2NrKTsKLQkJCXJlc2VydmF0aW9uX29iamVjdF9sb2NrKGJvLT5iYXNlLnJlc3YsIE5V
TEwpOworCQkJZG1hX3Jlc3ZfbG9jayhiby0+YmFzZS5yZXN2LCBOVUxMKTsKIAogCQkJc3Bpbl9s
b2NrKCZnbG9iLT5scnVfbG9jayk7CiAJCQl0dG1fYm9fY2xlYW51cF9yZWZzKGJvLCBmYWxzZSwg
IXJlbW92ZV9hbGwsIHRydWUpOwogCi0JCX0gZWxzZSBpZiAocmVzZXJ2YXRpb25fb2JqZWN0X3Ry
eWxvY2soYm8tPmJhc2UucmVzdikpIHsKKwkJfSBlbHNlIGlmIChkbWFfcmVzdl90cnlsb2NrKGJv
LT5iYXNlLnJlc3YpKSB7CiAJCQl0dG1fYm9fY2xlYW51cF9yZWZzKGJvLCBmYWxzZSwgIXJlbW92
ZV9hbGwsIHRydWUpOwogCQl9IGVsc2UgewogCQkJc3Bpbl91bmxvY2soJmdsb2ItPmxydV9sb2Nr
KTsKQEAgLTcwOCw3ICs3MDgsNyBAQCBzdGF0aWMgaW50IHR0bV9ib19ldmljdChzdHJ1Y3QgdHRt
X2J1ZmZlcl9vYmplY3QgKmJvLAogCXN0cnVjdCB0dG1fcGxhY2VtZW50IHBsYWNlbWVudDsKIAlp
bnQgcmV0ID0gMDsKIAotCXJlc2VydmF0aW9uX29iamVjdF9hc3NlcnRfaGVsZChiby0+YmFzZS5y
ZXN2KTsKKwlkbWFfcmVzdl9hc3NlcnRfaGVsZChiby0+YmFzZS5yZXN2KTsKIAogCXBsYWNlbWVu
dC5udW1fcGxhY2VtZW50ID0gMDsKIAlwbGFjZW1lbnQubnVtX2J1c3lfcGxhY2VtZW50ID0gMDsK
QEAgLTc3OSw3ICs3NzksNyBAQCBzdGF0aWMgYm9vbCB0dG1fYm9fZXZpY3Rfc3dhcG91dF9hbGxv
d2FibGUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAlib29sIHJldCA9IGZhbHNlOwog
CiAJaWYgKGJvLT5iYXNlLnJlc3YgPT0gY3R4LT5yZXN2KSB7Ci0JCXJlc2VydmF0aW9uX29iamVj
dF9hc3NlcnRfaGVsZChiby0+YmFzZS5yZXN2KTsKKwkJZG1hX3Jlc3ZfYXNzZXJ0X2hlbGQoYm8t
PmJhc2UucmVzdik7CiAJCWlmIChjdHgtPmZsYWdzICYgVFRNX09QVF9GTEFHX0FMTE9XX1JFU19F
VklDVAogCQkgICAgfHwgIWxpc3RfZW1wdHkoJmJvLT5kZGVzdHJveSkpCiAJCQlyZXQgPSB0cnVl
OwpAQCAtNzg3LDcgKzc4Nyw3IEBAIHN0YXRpYyBib29sIHR0bV9ib19ldmljdF9zd2Fwb3V0X2Fs
bG93YWJsZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQlpZiAoYnVzeSkKIAkJCSpi
dXN5ID0gZmFsc2U7CiAJfSBlbHNlIHsKLQkJcmV0ID0gcmVzZXJ2YXRpb25fb2JqZWN0X3RyeWxv
Y2soYm8tPmJhc2UucmVzdik7CisJCXJldCA9IGRtYV9yZXN2X3RyeWxvY2soYm8tPmJhc2UucmVz
dik7CiAJCSpsb2NrZWQgPSByZXQ7CiAJCWlmIChidXN5KQogCQkJKmJ1c3kgPSAhcmV0OwpAQCAt
ODE1LDEwICs4MTUsMTAgQEAgc3RhdGljIGludCB0dG1fbWVtX2V2aWN0X3dhaXRfYnVzeShzdHJ1
Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJ1c3lfYm8sCiAJCXJldHVybiAtRUJVU1k7CiAKIAlpZiAo
Y3R4LT5pbnRlcnJ1cHRpYmxlKQotCQlyID0gcmVzZXJ2YXRpb25fb2JqZWN0X2xvY2tfaW50ZXJy
dXB0aWJsZShidXN5X2JvLT5iYXNlLnJlc3YsCisJCXIgPSBkbWFfcmVzdl9sb2NrX2ludGVycnVw
dGlibGUoYnVzeV9iby0+YmFzZS5yZXN2LAogCQkJCQkJCSAgdGlja2V0KTsKIAllbHNlCi0JCXIg
PSByZXNlcnZhdGlvbl9vYmplY3RfbG9jayhidXN5X2JvLT5iYXNlLnJlc3YsIHRpY2tldCk7CisJ
CXIgPSBkbWFfcmVzdl9sb2NrKGJ1c3lfYm8tPmJhc2UucmVzdiwgdGlja2V0KTsKIAogCS8qCiAJ
ICogVE9ETzogSXQgd291bGQgYmUgYmV0dGVyIHRvIGtlZXAgdGhlIEJPIGxvY2tlZCB1bnRpbCBh
bGxvY2F0aW9uIGlzIGF0CkBAIC04MjYsNyArODI2LDcgQEAgc3RhdGljIGludCB0dG1fbWVtX2V2
aWN0X3dhaXRfYnVzeShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJ1c3lfYm8sCiAJICogb2Yg
VFRNLgogCSAqLwogCWlmICghcikKLQkJcmVzZXJ2YXRpb25fb2JqZWN0X3VubG9jayhidXN5X2Jv
LT5iYXNlLnJlc3YpOworCQlkbWFfcmVzdl91bmxvY2soYnVzeV9iby0+YmFzZS5yZXN2KTsKIAog
CXJldHVybiByID09IC1FREVBRExLID8gLUVCVVNZIDogcjsKIH0KQEAgLTg1Miw3ICs4NTIsNyBA
QCBzdGF0aWMgaW50IHR0bV9tZW1fZXZpY3RfZmlyc3Qoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJk
ZXYsCiAJCQlpZiAoIXR0bV9ib19ldmljdF9zd2Fwb3V0X2FsbG93YWJsZShibywgY3R4LCAmbG9j
a2VkLAogCQkJCQkJCSAgICAmYnVzeSkpIHsKIAkJCQlpZiAoYnVzeSAmJiAhYnVzeV9ibyAmJiB0
aWNrZXQgIT0KLQkJCQkgICAgcmVzZXJ2YXRpb25fb2JqZWN0X2xvY2tpbmdfY3R4KGJvLT5iYXNl
LnJlc3YpKQorCQkJCSAgICBkbWFfcmVzdl9sb2NraW5nX2N0eChiby0+YmFzZS5yZXN2KSkKIAkJ
CQkJYnVzeV9ibyA9IGJvOwogCQkJCWNvbnRpbnVlOwogCQkJfQpAQCAtODYwLDcgKzg2MCw3IEBA
IHN0YXRpYyBpbnQgdHRtX21lbV9ldmljdF9maXJzdChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRl
diwKIAkJCWlmIChwbGFjZSAmJiAhYmRldi0+ZHJpdmVyLT5ldmljdGlvbl92YWx1YWJsZShibywK
IAkJCQkJCQkJICAgICAgcGxhY2UpKSB7CiAJCQkJaWYgKGxvY2tlZCkKLQkJCQkJcmVzZXJ2YXRp
b25fb2JqZWN0X3VubG9jayhiby0+YmFzZS5yZXN2KTsKKwkJCQkJZG1hX3Jlc3ZfdW5sb2NrKGJv
LT5iYXNlLnJlc3YpOwogCQkJCWNvbnRpbnVlOwogCQkJfQogCQkJYnJlYWs7CkBAIC05MzIsOSAr
OTMyLDkgQEAgc3RhdGljIGludCB0dG1fYm9fYWRkX21vdmVfZmVuY2Uoc3RydWN0IHR0bV9idWZm
ZXJfb2JqZWN0ICpibywKIAlzcGluX3VubG9jaygmbWFuLT5tb3ZlX2xvY2spOwogCiAJaWYgKGZl
bmNlKSB7Ci0JCXJlc2VydmF0aW9uX29iamVjdF9hZGRfc2hhcmVkX2ZlbmNlKGJvLT5iYXNlLnJl
c3YsIGZlbmNlKTsKKwkJZG1hX3Jlc3ZfYWRkX3NoYXJlZF9mZW5jZShiby0+YmFzZS5yZXN2LCBm
ZW5jZSk7CiAKLQkJcmV0ID0gcmVzZXJ2YXRpb25fb2JqZWN0X3Jlc2VydmVfc2hhcmVkKGJvLT5i
YXNlLnJlc3YsIDEpOworCQlyZXQgPSBkbWFfcmVzdl9yZXNlcnZlX3NoYXJlZChiby0+YmFzZS5y
ZXN2LCAxKTsKIAkJaWYgKHVubGlrZWx5KHJldCkpIHsKIAkJCWRtYV9mZW5jZV9wdXQoZmVuY2Up
OwogCQkJcmV0dXJuIHJldDsKQEAgLTk2MSw3ICs5NjEsNyBAQCBzdGF0aWMgaW50IHR0bV9ib19t
ZW1fZm9yY2Vfc3BhY2Uoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAlzdHJ1Y3Qgd3df
YWNxdWlyZV9jdHggKnRpY2tldDsKIAlpbnQgcmV0OwogCi0JdGlja2V0ID0gcmVzZXJ2YXRpb25f
b2JqZWN0X2xvY2tpbmdfY3R4KGJvLT5iYXNlLnJlc3YpOworCXRpY2tldCA9IGRtYV9yZXN2X2xv
Y2tpbmdfY3R4KGJvLT5iYXNlLnJlc3YpOwogCWRvIHsKIAkJcmV0ID0gKCptYW4tPmZ1bmMtPmdl
dF9ub2RlKShtYW4sIGJvLCBwbGFjZSwgbWVtKTsKIAkJaWYgKHVubGlrZWx5KHJldCAhPSAwKSkK
QEAgLTEwOTEsNyArMTA5MSw3IEBAIGludCB0dG1fYm9fbWVtX3NwYWNlKHN0cnVjdCB0dG1fYnVm
ZmVyX29iamVjdCAqYm8sCiAJYm9vbCB0eXBlX2ZvdW5kID0gZmFsc2U7CiAJaW50IGksIHJldDsK
IAotCXJldCA9IHJlc2VydmF0aW9uX29iamVjdF9yZXNlcnZlX3NoYXJlZChiby0+YmFzZS5yZXN2
LCAxKTsKKwlyZXQgPSBkbWFfcmVzdl9yZXNlcnZlX3NoYXJlZChiby0+YmFzZS5yZXN2LCAxKTsK
IAlpZiAodW5saWtlbHkocmV0KSkKIAkJcmV0dXJuIHJldDsKIApAQCAtMTE3Miw3ICsxMTcyLDcg
QEAgc3RhdGljIGludCB0dG1fYm9fbW92ZV9idWZmZXIoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0
ICpibywKIAlpbnQgcmV0ID0gMDsKIAlzdHJ1Y3QgdHRtX21lbV9yZWcgbWVtOwogCi0JcmVzZXJ2
YXRpb25fb2JqZWN0X2Fzc2VydF9oZWxkKGJvLT5iYXNlLnJlc3YpOworCWRtYV9yZXN2X2Fzc2Vy
dF9oZWxkKGJvLT5iYXNlLnJlc3YpOwogCiAJbWVtLm51bV9wYWdlcyA9IGJvLT5udW1fcGFnZXM7
CiAJbWVtLnNpemUgPSBtZW0ubnVtX3BhZ2VzIDw8IFBBR0VfU0hJRlQ7CkBAIC0xMjQyLDcgKzEy
NDIsNyBAQCBpbnQgdHRtX2JvX3ZhbGlkYXRlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8s
CiAJaW50IHJldDsKIAl1aW50MzJfdCBuZXdfZmxhZ3M7CiAKLQlyZXNlcnZhdGlvbl9vYmplY3Rf
YXNzZXJ0X2hlbGQoYm8tPmJhc2UucmVzdik7CisJZG1hX3Jlc3ZfYXNzZXJ0X2hlbGQoYm8tPmJh
c2UucmVzdik7CiAJLyoKIAkgKiBDaGVjayB3aGV0aGVyIHdlIG5lZWQgdG8gbW92ZSBidWZmZXIu
CiAJICovCkBAIC0xMjc5LDcgKzEyNzksNyBAQCBpbnQgdHRtX2JvX2luaXRfcmVzZXJ2ZWQoc3Ry
dWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCiAJCQkgc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4ICpj
dHgsCiAJCQkgc2l6ZV90IGFjY19zaXplLAogCQkJIHN0cnVjdCBzZ190YWJsZSAqc2csCi0JCQkg
c3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdiwKKwkJCSBzdHJ1Y3QgZG1hX3Jlc3YgKnJl
c3YsCiAJCQkgdm9pZCAoKmRlc3Ryb3kpIChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKikpCiB7
CiAJaW50IHJldCA9IDA7CkBAIC0xMzMzLDcgKzEzMzMsNyBAQCBpbnQgdHRtX2JvX2luaXRfcmVz
ZXJ2ZWQoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCiAJYm8tPnNnID0gc2c7CiAJaWYgKHJl
c3YpIHsKIAkJYm8tPmJhc2UucmVzdiA9IHJlc3Y7Ci0JCXJlc2VydmF0aW9uX29iamVjdF9hc3Nl
cnRfaGVsZChiby0+YmFzZS5yZXN2KTsKKwkJZG1hX3Jlc3ZfYXNzZXJ0X2hlbGQoYm8tPmJhc2Uu
cmVzdik7CiAJfSBlbHNlIHsKIAkJYm8tPmJhc2UucmVzdiA9ICZiby0+YmFzZS5fcmVzdjsKIAl9
CkBAIC0xMzQyLDcgKzEzNDIsNyBAQCBpbnQgdHRtX2JvX2luaXRfcmVzZXJ2ZWQoc3RydWN0IHR0
bV9ib19kZXZpY2UgKmJkZXYsCiAJCSAqIGJvLmdlbSBpcyBub3QgaW5pdGlhbGl6ZWQsIHNvIHdl
IGhhdmUgdG8gc2V0dXAgdGhlCiAJCSAqIHN0cnVjdCBlbGVtZW50cyB3ZSB3YW50IHVzZSByZWdh
cmRsZXNzLgogCQkgKi8KLQkJcmVzZXJ2YXRpb25fb2JqZWN0X2luaXQoJmJvLT5iYXNlLl9yZXN2
KTsKKwkJZG1hX3Jlc3ZfaW5pdCgmYm8tPmJhc2UuX3Jlc3YpOwogCQlkcm1fdm1hX25vZGVfcmVz
ZXQoJmJvLT5iYXNlLnZtYV9ub2RlKTsKIAl9CiAJYXRvbWljX2luYygmYm8tPmJkZXYtPmdsb2It
PmJvX2NvdW50KTsKQEAgLTEzNjAsNyArMTM2MCw3IEBAIGludCB0dG1fYm9faW5pdF9yZXNlcnZl
ZChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKIAkgKiBzaW5jZSBvdGhlcndpc2UgbG9ja2Rl
cCB3aWxsIGJlIGFuZ2VyZWQgaW4gcmFkZW9uLgogCSAqLwogCWlmICghcmVzdikgewotCQlsb2Nr
ZWQgPSByZXNlcnZhdGlvbl9vYmplY3RfdHJ5bG9jayhiby0+YmFzZS5yZXN2KTsKKwkJbG9ja2Vk
ID0gZG1hX3Jlc3ZfdHJ5bG9jayhiby0+YmFzZS5yZXN2KTsKIAkJV0FSTl9PTighbG9ja2VkKTsK
IAl9CiAKQEAgLTEzOTQsNyArMTM5NCw3IEBAIGludCB0dG1fYm9faW5pdChzdHJ1Y3QgdHRtX2Jv
X2RldmljZSAqYmRldiwKIAkJYm9vbCBpbnRlcnJ1cHRpYmxlLAogCQlzaXplX3QgYWNjX3NpemUs
CiAJCXN0cnVjdCBzZ190YWJsZSAqc2csCi0JCXN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKnJl
c3YsCisJCXN0cnVjdCBkbWFfcmVzdiAqcmVzdiwKIAkJdm9pZCAoKmRlc3Ryb3kpIChzdHJ1Y3Qg
dHRtX2J1ZmZlcl9vYmplY3QgKikpCiB7CiAJc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4IGN0eCA9
IHsgaW50ZXJydXB0aWJsZSwgZmFsc2UgfTsKQEAgLTE4MDQsMTMgKzE4MDQsMTMgQEAgaW50IHR0
bV9ib193YWl0KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJbG9uZyB0aW1lb3V0ID0g
MTUgKiBIWjsKIAogCWlmIChub193YWl0KSB7Ci0JCWlmIChyZXNlcnZhdGlvbl9vYmplY3RfdGVz
dF9zaWduYWxlZF9yY3UoYm8tPmJhc2UucmVzdiwgdHJ1ZSkpCisJCWlmIChkbWFfcmVzdl90ZXN0
X3NpZ25hbGVkX3JjdShiby0+YmFzZS5yZXN2LCB0cnVlKSkKIAkJCXJldHVybiAwOwogCQllbHNl
CiAJCQlyZXR1cm4gLUVCVVNZOwogCX0KIAotCXRpbWVvdXQgPSByZXNlcnZhdGlvbl9vYmplY3Rf
d2FpdF90aW1lb3V0X3JjdShiby0+YmFzZS5yZXN2LCB0cnVlLAorCXRpbWVvdXQgPSBkbWFfcmVz
dl93YWl0X3RpbWVvdXRfcmN1KGJvLT5iYXNlLnJlc3YsIHRydWUsCiAJCQkJCQkgICAgICBpbnRl
cnJ1cHRpYmxlLCB0aW1lb3V0KTsKIAlpZiAodGltZW91dCA8IDApCiAJCXJldHVybiB0aW1lb3V0
OwpAQCAtMTgxOCw3ICsxODE4LDcgQEAgaW50IHR0bV9ib193YWl0KHN0cnVjdCB0dG1fYnVmZmVy
X29iamVjdCAqYm8sCiAJaWYgKHRpbWVvdXQgPT0gMCkKIAkJcmV0dXJuIC1FQlVTWTsKIAotCXJl
c2VydmF0aW9uX29iamVjdF9hZGRfZXhjbF9mZW5jZShiby0+YmFzZS5yZXN2LCBOVUxMKTsKKwlk
bWFfcmVzdl9hZGRfZXhjbF9mZW5jZShiby0+YmFzZS5yZXN2LCBOVUxMKTsKIAlyZXR1cm4gMDsK
IH0KIEVYUE9SVF9TWU1CT0wodHRtX2JvX3dhaXQpOwpAQCAtMTkzNCw3ICsxOTM0LDcgQEAgaW50
IHR0bV9ib19zd2Fwb3V0KHN0cnVjdCB0dG1fYm9fZ2xvYmFsICpnbG9iLCBzdHJ1Y3QgdHRtX29w
ZXJhdGlvbl9jdHggKmN0eCkKIAkgKiBhbHJlYWR5IHN3YXBwZWQgYnVmZmVyLgogCSAqLwogCWlm
IChsb2NrZWQpCi0JCXJlc2VydmF0aW9uX29iamVjdF91bmxvY2soYm8tPmJhc2UucmVzdik7CisJ
CWRtYV9yZXN2X3VubG9jayhiby0+YmFzZS5yZXN2KTsKIAlrcmVmX3B1dCgmYm8tPmxpc3Rfa3Jl
ZiwgdHRtX2JvX3JlbGVhc2VfbGlzdCk7CiAJcmV0dXJuIHJldDsKIH0KQEAgLTE5NzIsMTQgKzE5
NzIsMTQgQEAgaW50IHR0bV9ib193YWl0X3VucmVzZXJ2ZWQoc3RydWN0IHR0bV9idWZmZXJfb2Jq
ZWN0ICpibykKIAlyZXQgPSBtdXRleF9sb2NrX2ludGVycnVwdGlibGUoJmJvLT53dV9tdXRleCk7
CiAJaWYgKHVubGlrZWx5KHJldCAhPSAwKSkKIAkJcmV0dXJuIC1FUkVTVEFSVFNZUzsKLQlpZiAo
IXJlc2VydmF0aW9uX29iamVjdF9pc19sb2NrZWQoYm8tPmJhc2UucmVzdikpCisJaWYgKCFkbWFf
cmVzdl9pc19sb2NrZWQoYm8tPmJhc2UucmVzdikpCiAJCWdvdG8gb3V0X3VubG9jazsKLQlyZXQg
PSByZXNlcnZhdGlvbl9vYmplY3RfbG9ja19pbnRlcnJ1cHRpYmxlKGJvLT5iYXNlLnJlc3YsIE5V
TEwpOworCXJldCA9IGRtYV9yZXN2X2xvY2tfaW50ZXJydXB0aWJsZShiby0+YmFzZS5yZXN2LCBO
VUxMKTsKIAlpZiAocmV0ID09IC1FSU5UUikKIAkJcmV0ID0gLUVSRVNUQVJUU1lTOwogCWlmICh1
bmxpa2VseShyZXQgIT0gMCkpCiAJCWdvdG8gb3V0X3VubG9jazsKLQlyZXNlcnZhdGlvbl9vYmpl
Y3RfdW5sb2NrKGJvLT5iYXNlLnJlc3YpOworCWRtYV9yZXN2X3VubG9jayhiby0+YmFzZS5yZXN2
KTsKIAogb3V0X3VubG9jazoKIAltdXRleF91bmxvY2soJmJvLT53dV9tdXRleCk7CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGlsLmMgYi9kcml2ZXJzL2dwdS9kcm0v
dHRtL3R0bV9ib191dGlsLmMKaW5kZXggNDI1YTZkNjI3YjMwLi5mZTgxYzU2NWU3ZWYgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3V0aWwuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vdHRtL3R0bV9ib191dGlsLmMKQEAgLTM4LDcgKzM4LDcgQEAKICNpbmNsdWRlIDxsaW51
eC9zbGFiLmg+CiAjaW5jbHVkZSA8bGludXgvdm1hbGxvYy5oPgogI2luY2x1ZGUgPGxpbnV4L21v
ZHVsZS5oPgotI2luY2x1ZGUgPGxpbnV4L3Jlc2VydmF0aW9uLmg+CisjaW5jbHVkZSA8bGludXgv
ZG1hLXJlc3YuaD4KIAogc3RydWN0IHR0bV90cmFuc2Zlcl9vYmogewogCXN0cnVjdCB0dG1fYnVm
ZmVyX29iamVjdCBiYXNlOwpAQCAtNTE4LDggKzUxOCw4IEBAIHN0YXRpYyBpbnQgdHRtX2J1ZmZl
cl9vYmplY3RfdHJhbnNmZXIoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAlmYm8tPmJh
c2UuZGVzdHJveSA9ICZ0dG1fdHJhbnNmZXJlZF9kZXN0cm95OwogCWZiby0+YmFzZS5hY2Nfc2l6
ZSA9IDA7CiAJZmJvLT5iYXNlLmJhc2UucmVzdiA9ICZmYm8tPmJhc2UuYmFzZS5fcmVzdjsKLQly
ZXNlcnZhdGlvbl9vYmplY3RfaW5pdChmYm8tPmJhc2UuYmFzZS5yZXN2KTsKLQlyZXQgPSByZXNl
cnZhdGlvbl9vYmplY3RfdHJ5bG9jayhmYm8tPmJhc2UuYmFzZS5yZXN2KTsKKwlkbWFfcmVzdl9p
bml0KGZiby0+YmFzZS5iYXNlLnJlc3YpOworCXJldCA9IGRtYV9yZXN2X3RyeWxvY2soZmJvLT5i
YXNlLmJhc2UucmVzdik7CiAJV0FSTl9PTighcmV0KTsKIAogCSpuZXdfb2JqID0gJmZiby0+YmFz
ZTsKQEAgLTY4OSw3ICs2ODksNyBAQCBpbnQgdHRtX2JvX21vdmVfYWNjZWxfY2xlYW51cChzdHJ1
Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCWludCByZXQ7CiAJc3RydWN0IHR0bV9idWZmZXJf
b2JqZWN0ICpnaG9zdF9vYmo7CiAKLQlyZXNlcnZhdGlvbl9vYmplY3RfYWRkX2V4Y2xfZmVuY2Uo
Ym8tPmJhc2UucmVzdiwgZmVuY2UpOworCWRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlKGJvLT5iYXNl
LnJlc3YsIGZlbmNlKTsKIAlpZiAoZXZpY3QpIHsKIAkJcmV0ID0gdHRtX2JvX3dhaXQoYm8sIGZh
bHNlLCBmYWxzZSk7CiAJCWlmIChyZXQpCkBAIC03MTYsNyArNzE2LDcgQEAgaW50IHR0bV9ib19t
b3ZlX2FjY2VsX2NsZWFudXAoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAkJaWYgKHJl
dCkKIAkJCXJldHVybiByZXQ7CiAKLQkJcmVzZXJ2YXRpb25fb2JqZWN0X2FkZF9leGNsX2ZlbmNl
KGdob3N0X29iai0+YmFzZS5yZXN2LCBmZW5jZSk7CisJCWRtYV9yZXN2X2FkZF9leGNsX2ZlbmNl
KGdob3N0X29iai0+YmFzZS5yZXN2LCBmZW5jZSk7CiAKIAkJLyoqCiAJCSAqIElmIHdlJ3JlIG5v
dCBtb3ZpbmcgdG8gZml4ZWQgbWVtb3J5LCB0aGUgVFRNIG9iamVjdApAQCAtNzUyLDcgKzc1Miw3
IEBAIGludCB0dG1fYm9fcGlwZWxpbmVfbW92ZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJv
LAogCiAJaW50IHJldDsKIAotCXJlc2VydmF0aW9uX29iamVjdF9hZGRfZXhjbF9mZW5jZShiby0+
YmFzZS5yZXN2LCBmZW5jZSk7CisJZG1hX3Jlc3ZfYWRkX2V4Y2xfZmVuY2UoYm8tPmJhc2UucmVz
diwgZmVuY2UpOwogCiAJaWYgKCFldmljdCkgewogCQlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3Qg
Kmdob3N0X29iajsKQEAgLTc3Miw3ICs3NzIsNyBAQCBpbnQgdHRtX2JvX3BpcGVsaW5lX21vdmUo
c3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAkJaWYgKHJldCkKIAkJCXJldHVybiByZXQ7
CiAKLQkJcmVzZXJ2YXRpb25fb2JqZWN0X2FkZF9leGNsX2ZlbmNlKGdob3N0X29iai0+YmFzZS5y
ZXN2LCBmZW5jZSk7CisJCWRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlKGdob3N0X29iai0+YmFzZS5y
ZXN2LCBmZW5jZSk7CiAKIAkJLyoqCiAJCSAqIElmIHdlJ3JlIG5vdCBtb3ZpbmcgdG8gZml4ZWQg
bWVtb3J5LCB0aGUgVFRNIG9iamVjdApAQCAtODQxLDcgKzg0MSw3IEBAIGludCB0dG1fYm9fcGlw
ZWxpbmVfZ3V0dGluZyhzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvKQogCWlmIChyZXQpCiAJ
CXJldHVybiByZXQ7CiAKLQlyZXQgPSByZXNlcnZhdGlvbl9vYmplY3RfY29weV9mZW5jZXMoZ2hv
c3QtPmJhc2UucmVzdiwgYm8tPmJhc2UucmVzdik7CisJcmV0ID0gZG1hX3Jlc3ZfY29weV9mZW5j
ZXMoZ2hvc3QtPmJhc2UucmVzdiwgYm8tPmJhc2UucmVzdik7CiAJLyogTGFzdCByZXNvcnQsIHdh
aXQgZm9yIHRoZSBCTyB0byBiZSBpZGxlIHdoZW4gd2UgYXJlIE9PTSAqLwogCWlmIChyZXQpCiAJ
CXR0bV9ib193YWl0KGJvLCBmYWxzZSwgZmFsc2UpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL3R0bS90dG1fYm9fdm0uYyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3ZtLmMKaW5k
ZXggODVmNWJjYmUwYzc2Li43NmVlZGI5NjM2OTMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS90dG0vdHRtX2JvX3ZtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm9fdm0uYwpA
QCAtNzEsNyArNzEsNyBAQCBzdGF0aWMgdm1fZmF1bHRfdCB0dG1fYm9fdm1fZmF1bHRfaWRsZShz
dHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQl0dG1fYm9fZ2V0KGJvKTsKIAkJdXBfcmVh
ZCgmdm1mLT52bWEtPnZtX21tLT5tbWFwX3NlbSk7CiAJCSh2b2lkKSBkbWFfZmVuY2Vfd2FpdChi
by0+bW92aW5nLCB0cnVlKTsKLQkJcmVzZXJ2YXRpb25fb2JqZWN0X3VubG9jayhiby0+YmFzZS5y
ZXN2KTsKKwkJZG1hX3Jlc3ZfdW5sb2NrKGJvLT5iYXNlLnJlc3YpOwogCQl0dG1fYm9fcHV0KGJv
KTsKIAkJZ290byBvdXRfdW5sb2NrOwogCX0KQEAgLTEzMSw3ICsxMzEsNyBAQCBzdGF0aWMgdm1f
ZmF1bHRfdCB0dG1fYm9fdm1fZmF1bHQoc3RydWN0IHZtX2ZhdWx0ICp2bWYpCiAJICogZm9yIHJl
c2VydmUsIGFuZCBpZiBpdCBmYWlscywgcmV0cnkgdGhlIGZhdWx0IGFmdGVyIHdhaXRpbmcKIAkg
KiBmb3IgdGhlIGJ1ZmZlciB0byBiZWNvbWUgdW5yZXNlcnZlZC4KIAkgKi8KLQlpZiAodW5saWtl
bHkoIXJlc2VydmF0aW9uX29iamVjdF90cnlsb2NrKGJvLT5iYXNlLnJlc3YpKSkgeworCWlmICh1
bmxpa2VseSghZG1hX3Jlc3ZfdHJ5bG9jayhiby0+YmFzZS5yZXN2KSkpIHsKIAkJaWYgKHZtZi0+
ZmxhZ3MgJiBGQVVMVF9GTEFHX0FMTE9XX1JFVFJZKSB7CiAJCQlpZiAoISh2bWYtPmZsYWdzICYg
RkFVTFRfRkxBR19SRVRSWV9OT1dBSVQpKSB7CiAJCQkJdHRtX2JvX2dldChibyk7CkBAIC0yOTYs
NyArMjk2LDcgQEAgc3RhdGljIHZtX2ZhdWx0X3QgdHRtX2JvX3ZtX2ZhdWx0KHN0cnVjdCB2bV9m
YXVsdCAqdm1mKQogb3V0X2lvX3VubG9jazoKIAl0dG1fbWVtX2lvX3VubG9jayhtYW4pOwogb3V0
X3VubG9jazoKLQlyZXNlcnZhdGlvbl9vYmplY3RfdW5sb2NrKGJvLT5iYXNlLnJlc3YpOworCWRt
YV9yZXN2X3VubG9jayhiby0+YmFzZS5yZXN2KTsKIAlyZXR1cm4gcmV0OwogfQogCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9leGVjYnVmX3V0aWwuYyBiL2RyaXZlcnMvZ3B1
L2RybS90dG0vdHRtX2V4ZWNidWZfdXRpbC5jCmluZGV4IDNhZWZlNzJmYjVjYi4uMTMxZGFlOGY0
MTcwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9leGVjYnVmX3V0aWwuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9leGVjYnVmX3V0aWwuYwpAQCAtMzksNyArMzks
NyBAQCBzdGF0aWMgdm9pZCB0dG1fZXVfYmFja29mZl9yZXNlcnZhdGlvbl9yZXZlcnNlKHN0cnVj
dCBsaXN0X2hlYWQgKmxpc3QsCiAJbGlzdF9mb3JfZWFjaF9lbnRyeV9jb250aW51ZV9yZXZlcnNl
KGVudHJ5LCBsaXN0LCBoZWFkKSB7CiAJCXN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8gPSBl
bnRyeS0+Ym87CiAKLQkJcmVzZXJ2YXRpb25fb2JqZWN0X3VubG9jayhiby0+YmFzZS5yZXN2KTsK
KwkJZG1hX3Jlc3ZfdW5sb2NrKGJvLT5iYXNlLnJlc3YpOwogCX0KIH0KIApAQCAtNzEsNyArNzEs
NyBAQCB2b2lkIHR0bV9ldV9iYWNrb2ZmX3Jlc2VydmF0aW9uKHN0cnVjdCB3d19hY3F1aXJlX2N0
eCAqdGlja2V0LAogCiAJCWlmIChsaXN0X2VtcHR5KCZiby0+bHJ1KSkKIAkJCXR0bV9ib19hZGRf
dG9fbHJ1KGJvKTsKLQkJcmVzZXJ2YXRpb25fb2JqZWN0X3VubG9jayhiby0+YmFzZS5yZXN2KTsK
KwkJZG1hX3Jlc3ZfdW5sb2NrKGJvLT5iYXNlLnJlc3YpOwogCX0KIAlzcGluX3VubG9jaygmZ2xv
Yi0+bHJ1X2xvY2spOwogCkBAIC0xMTQsNyArMTE0LDcgQEAgaW50IHR0bV9ldV9yZXNlcnZlX2J1
ZmZlcnMoc3RydWN0IHd3X2FjcXVpcmVfY3R4ICp0aWNrZXQsCiAKIAkJcmV0ID0gX190dG1fYm9f
cmVzZXJ2ZShibywgaW50ciwgKHRpY2tldCA9PSBOVUxMKSwgdGlja2V0KTsKIAkJaWYgKCFyZXQg
JiYgdW5saWtlbHkoYXRvbWljX3JlYWQoJmJvLT5jcHVfd3JpdGVycykgPiAwKSkgewotCQkJcmVz
ZXJ2YXRpb25fb2JqZWN0X3VubG9jayhiby0+YmFzZS5yZXN2KTsKKwkJCWRtYV9yZXN2X3VubG9j
ayhiby0+YmFzZS5yZXN2KTsKIAogCQkJcmV0ID0gLUVCVVNZOwogCkBAIC0xMzAsNyArMTMwLDcg
QEAgaW50IHR0bV9ldV9yZXNlcnZlX2J1ZmZlcnMoc3RydWN0IHd3X2FjcXVpcmVfY3R4ICp0aWNr
ZXQsCiAJCQlpZiAoIWVudHJ5LT5udW1fc2hhcmVkKQogCQkJCWNvbnRpbnVlOwogCi0JCQlyZXQg
PSByZXNlcnZhdGlvbl9vYmplY3RfcmVzZXJ2ZV9zaGFyZWQoYm8tPmJhc2UucmVzdiwKKwkJCXJl
dCA9IGRtYV9yZXN2X3Jlc2VydmVfc2hhcmVkKGJvLT5iYXNlLnJlc3YsCiAJCQkJCQkJCWVudHJ5
LT5udW1fc2hhcmVkKTsKIAkJCWlmICghcmV0KQogCQkJCWNvbnRpbnVlOwpAQCAtMTQ0LDE2ICsx
NDQsMTYgQEAgaW50IHR0bV9ldV9yZXNlcnZlX2J1ZmZlcnMoc3RydWN0IHd3X2FjcXVpcmVfY3R4
ICp0aWNrZXQsCiAKIAkJaWYgKHJldCA9PSAtRURFQURMSykgewogCQkJaWYgKGludHIpIHsKLQkJ
CQlyZXQgPSByZXNlcnZhdGlvbl9vYmplY3RfbG9ja19zbG93X2ludGVycnVwdGlibGUoYm8tPmJh
c2UucmVzdiwKKwkJCQlyZXQgPSBkbWFfcmVzdl9sb2NrX3Nsb3dfaW50ZXJydXB0aWJsZShiby0+
YmFzZS5yZXN2LAogCQkJCQkJCQkJCSB0aWNrZXQpOwogCQkJfSBlbHNlIHsKLQkJCQlyZXNlcnZh
dGlvbl9vYmplY3RfbG9ja19zbG93KGJvLT5iYXNlLnJlc3YsIHRpY2tldCk7CisJCQkJZG1hX3Jl
c3ZfbG9ja19zbG93KGJvLT5iYXNlLnJlc3YsIHRpY2tldCk7CiAJCQkJcmV0ID0gMDsKIAkJCX0K
IAkJfQogCiAJCWlmICghcmV0ICYmIGVudHJ5LT5udW1fc2hhcmVkKQotCQkJcmV0ID0gcmVzZXJ2
YXRpb25fb2JqZWN0X3Jlc2VydmVfc2hhcmVkKGJvLT5iYXNlLnJlc3YsCisJCQlyZXQgPSBkbWFf
cmVzdl9yZXNlcnZlX3NoYXJlZChiby0+YmFzZS5yZXN2LAogCQkJCQkJCQllbnRyeS0+bnVtX3No
YXJlZCk7CiAKIAkJaWYgKHVubGlrZWx5KHJldCAhPSAwKSkgewpAQCAtMjAxLDE0ICsyMDEsMTQg
QEAgdm9pZCB0dG1fZXVfZmVuY2VfYnVmZmVyX29iamVjdHMoc3RydWN0IHd3X2FjcXVpcmVfY3R4
ICp0aWNrZXQsCiAJbGlzdF9mb3JfZWFjaF9lbnRyeShlbnRyeSwgbGlzdCwgaGVhZCkgewogCQli
byA9IGVudHJ5LT5ibzsKIAkJaWYgKGVudHJ5LT5udW1fc2hhcmVkKQotCQkJcmVzZXJ2YXRpb25f
b2JqZWN0X2FkZF9zaGFyZWRfZmVuY2UoYm8tPmJhc2UucmVzdiwgZmVuY2UpOworCQkJZG1hX3Jl
c3ZfYWRkX3NoYXJlZF9mZW5jZShiby0+YmFzZS5yZXN2LCBmZW5jZSk7CiAJCWVsc2UKLQkJCXJl
c2VydmF0aW9uX29iamVjdF9hZGRfZXhjbF9mZW5jZShiby0+YmFzZS5yZXN2LCBmZW5jZSk7CisJ
CQlkbWFfcmVzdl9hZGRfZXhjbF9mZW5jZShiby0+YmFzZS5yZXN2LCBmZW5jZSk7CiAJCWlmIChs
aXN0X2VtcHR5KCZiby0+bHJ1KSkKIAkJCXR0bV9ib19hZGRfdG9fbHJ1KGJvKTsKIAkJZWxzZQog
CQkJdHRtX2JvX21vdmVfdG9fbHJ1X3RhaWwoYm8sIE5VTEwpOwotCQlyZXNlcnZhdGlvbl9vYmpl
Y3RfdW5sb2NrKGJvLT5iYXNlLnJlc3YpOworCQlkbWFfcmVzdl91bmxvY2soYm8tPmJhc2UucmVz
dik7CiAJfQogCXNwaW5fdW5sb2NrKCZnbG9iLT5scnVfbG9jayk7CiAJaWYgKHRpY2tldCkKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3R0LmMgYi9kcml2ZXJzL2dwdS9kcm0v
dHRtL3R0bV90dC5jCmluZGV4IDAwYjRhMzMzNzg0MC4uZTBlOWI0ZjY5ZGI2IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV90dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0v
dHRtX3R0LmMKQEAgLTQ4LDcgKzQ4LDcgQEAgaW50IHR0bV90dF9jcmVhdGUoc3RydWN0IHR0bV9i
dWZmZXJfb2JqZWN0ICpibywgYm9vbCB6ZXJvX2FsbG9jKQogCXN0cnVjdCB0dG1fYm9fZGV2aWNl
ICpiZGV2ID0gYm8tPmJkZXY7CiAJdWludDMyX3QgcGFnZV9mbGFncyA9IDA7CiAKLQlyZXNlcnZh
dGlvbl9vYmplY3RfYXNzZXJ0X2hlbGQoYm8tPmJhc2UucmVzdik7CisJZG1hX3Jlc3ZfYXNzZXJ0
X2hlbGQoYm8tPmJhc2UucmVzdik7CiAKIAlpZiAoYmRldi0+bmVlZF9kbWEzMikKIAkJcGFnZV9m
bGFncyB8PSBUVE1fUEFHRV9GTEFHX0RNQTMyOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L3YzZC92M2RfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vdjNkL3YzZF9nZW0uYwppbmRleCA3OTc0
NDEzN2Q4OWYuLjVkODA1MDdiNTM5YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3YzZC92
M2RfZ2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3YzZC92M2RfZ2VtLmMKQEAgLTQwOSw3ICs0
MDksNyBAQCB2M2Rfd2FpdF9ib19pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpk
YXRhLAogCWlmIChhcmdzLT5wYWQgIT0gMCkKIAkJcmV0dXJuIC1FSU5WQUw7CiAKLQlyZXQgPSBk
cm1fZ2VtX3Jlc2VydmF0aW9uX29iamVjdF93YWl0KGZpbGVfcHJpdiwgYXJncy0+aGFuZGxlLAor
CXJldCA9IGRybV9nZW1fZG1hX3Jlc3Zfd2FpdChmaWxlX3ByaXYsIGFyZ3MtPmhhbmRsZSwKIAkJ
CQkJICAgICAgdHJ1ZSwgdGltZW91dF9qaWZmaWVzKTsKIAogCS8qIERlY3JlbWVudCB0aGUgdXNl
cidzIHRpbWVvdXQsIGluIGNhc2Ugd2UgZ290IGludGVycnVwdGVkCkBAIC00OTUsNyArNDk1LDcg
QEAgdjNkX2F0dGFjaF9mZW5jZXNfYW5kX3VubG9ja19yZXNlcnZhdGlvbihzdHJ1Y3QgZHJtX2Zp
bGUgKmZpbGVfcHJpdiwKIAogCWZvciAoaSA9IDA7IGkgPCBqb2ItPmJvX2NvdW50OyBpKyspIHsK
IAkJLyogWFhYOiBVc2Ugc2hhcmVkIGZlbmNlcyBmb3IgcmVhZC1vbmx5IG9iamVjdHMuICovCi0J
CXJlc2VydmF0aW9uX29iamVjdF9hZGRfZXhjbF9mZW5jZShqb2ItPmJvW2ldLT5yZXN2LAorCQlk
bWFfcmVzdl9hZGRfZXhjbF9mZW5jZShqb2ItPmJvW2ldLT5yZXN2LAogCQkJCQkJICBqb2ItPmRv
bmVfZmVuY2UpOwogCX0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZjNC92YzRfZ2Vt
LmMgYi9kcml2ZXJzL2dwdS9kcm0vdmM0L3ZjNF9nZW0uYwppbmRleCBiNzJiNzYwZTMwMTguLjdh
MDZjYjZlMzFjNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3ZjNC92YzRfZ2VtLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL3ZjNC92YzRfZ2VtLmMKQEAgLTU0Myw3ICs1NDMsNyBAQCB2YzRf
dXBkYXRlX2JvX3NlcW5vcyhzdHJ1Y3QgdmM0X2V4ZWNfaW5mbyAqZXhlYywgdWludDY0X3Qgc2Vx
bm8pCiAJCWJvID0gdG9fdmM0X2JvKCZleGVjLT5ib1tpXS0+YmFzZSk7CiAJCWJvLT5zZXFubyA9
IHNlcW5vOwogCi0JCXJlc2VydmF0aW9uX29iamVjdF9hZGRfc2hhcmVkX2ZlbmNlKGJvLT5iYXNl
LmJhc2UucmVzdiwgZXhlYy0+ZmVuY2UpOworCQlkbWFfcmVzdl9hZGRfc2hhcmVkX2ZlbmNlKGJv
LT5iYXNlLmJhc2UucmVzdiwgZXhlYy0+ZmVuY2UpOwogCX0KIAogCWxpc3RfZm9yX2VhY2hfZW50
cnkoYm8sICZleGVjLT51bnJlZl9saXN0LCB1bnJlZl9oZWFkKSB7CkBAIC01NTQsNyArNTU0LDcg
QEAgdmM0X3VwZGF0ZV9ib19zZXFub3Moc3RydWN0IHZjNF9leGVjX2luZm8gKmV4ZWMsIHVpbnQ2
NF90IHNlcW5vKQogCQlibyA9IHRvX3ZjNF9ibygmZXhlYy0+cmNsX3dyaXRlX2JvW2ldLT5iYXNl
KTsKIAkJYm8tPndyaXRlX3NlcW5vID0gc2Vxbm87CiAKLQkJcmVzZXJ2YXRpb25fb2JqZWN0X2Fk
ZF9leGNsX2ZlbmNlKGJvLT5iYXNlLmJhc2UucmVzdiwgZXhlYy0+ZmVuY2UpOworCQlkbWFfcmVz
dl9hZGRfZXhjbF9mZW5jZShiby0+YmFzZS5iYXNlLnJlc3YsIGV4ZWMtPmZlbmNlKTsKIAl9CiB9
CiAKQEAgLTY0Miw3ICs2NDIsNyBAQCB2YzRfbG9ja19ib19yZXNlcnZhdGlvbnMoc3RydWN0IGRy
bV9kZXZpY2UgKmRldiwKIAlmb3IgKGkgPSAwOyBpIDwgZXhlYy0+Ym9fY291bnQ7IGkrKykgewog
CQlibyA9ICZleGVjLT5ib1tpXS0+YmFzZTsKIAotCQlyZXQgPSByZXNlcnZhdGlvbl9vYmplY3Rf
cmVzZXJ2ZV9zaGFyZWQoYm8tPnJlc3YsIDEpOworCQlyZXQgPSBkbWFfcmVzdl9yZXNlcnZlX3No
YXJlZChiby0+cmVzdiwgMSk7CiAJCWlmIChyZXQpIHsKIAkJCXZjNF91bmxvY2tfYm9fcmVzZXJ2
YXRpb25zKGRldiwgZXhlYywgYWNxdWlyZV9jdHgpOwogCQkJcmV0dXJuIHJldDsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS92Z2VtL3ZnZW1fZmVuY2UuYyBiL2RyaXZlcnMvZ3B1L2RybS92
Z2VtL3ZnZW1fZmVuY2UuYwppbmRleCBkODYzMDQ2NzU0OWMuLjkyNjhmNmZjM2Y2NiAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL3ZnZW0vdmdlbV9mZW5jZS5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS92Z2VtL3ZnZW1fZmVuY2UuYwpAQCAtMjEsNyArMjEsNyBAQAogICovCiAKICNpbmNsdWRl
IDxsaW51eC9kbWEtYnVmLmg+Ci0jaW5jbHVkZSA8bGludXgvcmVzZXJ2YXRpb24uaD4KKyNpbmNs
dWRlIDxsaW51eC9kbWEtcmVzdi5oPgogCiAjaW5jbHVkZSA8ZHJtL2RybV9maWxlLmg+CiAKQEAg
LTEyOCw3ICsxMjgsNyBAQCBpbnQgdmdlbV9mZW5jZV9hdHRhY2hfaW9jdGwoc3RydWN0IGRybV9k
ZXZpY2UgKmRldiwKIHsKIAlzdHJ1Y3QgZHJtX3ZnZW1fZmVuY2VfYXR0YWNoICphcmcgPSBkYXRh
OwogCXN0cnVjdCB2Z2VtX2ZpbGUgKnZmaWxlID0gZmlsZS0+ZHJpdmVyX3ByaXY7Ci0Jc3RydWN0
IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdjsKKwlzdHJ1Y3QgZG1hX3Jlc3YgKnJlc3Y7CiAJc3Ry
dWN0IGRybV9nZW1fb2JqZWN0ICpvYmo7CiAJc3RydWN0IGRtYV9mZW5jZSAqZmVuY2U7CiAJaW50
IHJldDsKQEAgLTE1MSw3ICsxNTEsNyBAQCBpbnQgdmdlbV9mZW5jZV9hdHRhY2hfaW9jdGwoc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiwKIAogCS8qIENoZWNrIGZvciBhIGNvbmZsaWN0aW5nIGZlbmNl
ICovCiAJcmVzdiA9IG9iai0+cmVzdjsKLQlpZiAoIXJlc2VydmF0aW9uX29iamVjdF90ZXN0X3Np
Z25hbGVkX3JjdShyZXN2LAorCWlmICghZG1hX3Jlc3ZfdGVzdF9zaWduYWxlZF9yY3UocmVzdiwK
IAkJCQkJCSAgYXJnLT5mbGFncyAmIFZHRU1fRkVOQ0VfV1JJVEUpKSB7CiAJCXJldCA9IC1FQlVT
WTsKIAkJZ290byBlcnJfZmVuY2U7CkBAIC0xNTksMTIgKzE1OSwxMiBAQCBpbnQgdmdlbV9mZW5j
ZV9hdHRhY2hfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKIAogCS8qIEV4cG9zZSB0aGUg
ZmVuY2UgdmlhIHRoZSBkbWEtYnVmICovCiAJcmV0ID0gMDsKLQlyZXNlcnZhdGlvbl9vYmplY3Rf
bG9jayhyZXN2LCBOVUxMKTsKKwlkbWFfcmVzdl9sb2NrKHJlc3YsIE5VTEwpOwogCWlmIChhcmct
PmZsYWdzICYgVkdFTV9GRU5DRV9XUklURSkKLQkJcmVzZXJ2YXRpb25fb2JqZWN0X2FkZF9leGNs
X2ZlbmNlKHJlc3YsIGZlbmNlKTsKLQllbHNlIGlmICgocmV0ID0gcmVzZXJ2YXRpb25fb2JqZWN0
X3Jlc2VydmVfc2hhcmVkKHJlc3YsIDEpKSA9PSAwKQotCQlyZXNlcnZhdGlvbl9vYmplY3RfYWRk
X3NoYXJlZF9mZW5jZShyZXN2LCBmZW5jZSk7Ci0JcmVzZXJ2YXRpb25fb2JqZWN0X3VubG9jayhy
ZXN2KTsKKwkJZG1hX3Jlc3ZfYWRkX2V4Y2xfZmVuY2UocmVzdiwgZmVuY2UpOworCWVsc2UgaWYg
KChyZXQgPSBkbWFfcmVzdl9yZXNlcnZlX3NoYXJlZChyZXN2LCAxKSkgPT0gMCkKKwkJZG1hX3Jl
c3ZfYWRkX3NoYXJlZF9mZW5jZShyZXN2LCBmZW5jZSk7CisJZG1hX3Jlc3ZfdW5sb2NrKHJlc3Yp
OwogCiAJLyogUmVjb3JkIHRoZSBmZW5jZSBpbiBvdXIgaWRyIGZvciBsYXRlciBzaWduYWxpbmcg
Ki8KIAlpZiAocmV0ID09IDApIHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8v
dmlydGdwdV9pb2N0bC5jIGIvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X2lvY3RsLmMK
aW5kZXggM2M0MzBkZDY1ZjY3Li4wYTg4ZWYxMWI5ZDMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS92aXJ0aW8vdmlydGdwdV9pb2N0bC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8v
dmlydGdwdV9pb2N0bC5jCkBAIC0zOTYsNyArMzk2LDcgQEAgc3RhdGljIGludCB2aXJ0aW9fZ3B1
X3RyYW5zZmVyX2Zyb21faG9zdF9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogCQkodmdk
ZXYsIHFvYmotPmh3X3Jlc19oYW5kbGUsCiAJCSB2ZnByaXYtPmN0eF9pZCwgb2Zmc2V0LCBhcmdz
LT5sZXZlbCwKIAkJICZib3gsIGZlbmNlKTsKLQlyZXNlcnZhdGlvbl9vYmplY3RfYWRkX2V4Y2xf
ZmVuY2UocW9iai0+dGJvLmJhc2UucmVzdiwKKwlkbWFfcmVzdl9hZGRfZXhjbF9mZW5jZShxb2Jq
LT50Ym8uYmFzZS5yZXN2LAogCQkJCQkgICZmZW5jZS0+Zik7CiAKIAlkbWFfZmVuY2VfcHV0KCZm
ZW5jZS0+Zik7CkBAIC00NTAsNyArNDUwLDcgQEAgc3RhdGljIGludCB2aXJ0aW9fZ3B1X3RyYW5z
ZmVyX3RvX2hvc3RfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIAkJ
CSh2Z2RldiwgcW9iaiwKIAkJCSB2ZnByaXYgPyB2ZnByaXYtPmN0eF9pZCA6IDAsIG9mZnNldCwK
IAkJCSBhcmdzLT5sZXZlbCwgJmJveCwgZmVuY2UpOwotCQlyZXNlcnZhdGlvbl9vYmplY3RfYWRk
X2V4Y2xfZmVuY2UocW9iai0+dGJvLmJhc2UucmVzdiwKKwkJZG1hX3Jlc3ZfYWRkX2V4Y2xfZmVu
Y2UocW9iai0+dGJvLmJhc2UucmVzdiwKIAkJCQkJCSAgJmZlbmNlLT5mKTsKIAkJZG1hX2ZlbmNl
X3B1dCgmZmVuY2UtPmYpOwogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8v
dmlydGdwdV9wbGFuZS5jIGIvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X3BsYW5lLmMK
aW5kZXggM2RjMDhmOTkxYThkLi5hNDkyYWMzZjRhN2UgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS92aXJ0aW8vdmlydGdwdV9wbGFuZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8v
dmlydGdwdV9wbGFuZS5jCkBAIC0yMTIsNyArMjEyLDcgQEAgc3RhdGljIHZvaWQgdmlydGlvX2dw
dV9jdXJzb3JfcGxhbmVfdXBkYXRlKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLAogCQkJIDAsIDAs
IHZnZmItPmZlbmNlKTsKIAkJcmV0ID0gdmlydGlvX2dwdV9vYmplY3RfcmVzZXJ2ZShibywgZmFs
c2UpOwogCQlpZiAoIXJldCkgewotCQkJcmVzZXJ2YXRpb25fb2JqZWN0X2FkZF9leGNsX2ZlbmNl
KGJvLT50Ym8uYmFzZS5yZXN2LAorCQkJZG1hX3Jlc3ZfYWRkX2V4Y2xfZmVuY2UoYm8tPnRiby5i
YXNlLnJlc3YsCiAJCQkJCQkJICAmdmdmYi0+ZmVuY2UtPmYpOwogCQkJZG1hX2ZlbmNlX3B1dCgm
dmdmYi0+ZmVuY2UtPmYpOwogCQkJdmdmYi0+ZmVuY2UgPSBOVUxMOwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfYmxpdC5jIGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dm
eC92bXdnZnhfYmxpdC5jCmluZGV4IDZjMDFhZDI3ODVkZC4uYmI0NmNhMGM0NThmIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9ibGl0LmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL3Ztd2dmeC92bXdnZnhfYmxpdC5jCkBAIC00NTksOSArNDU5LDkgQEAgaW50IHZtd19i
b19jcHVfYmxpdChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmRzdCwKIAogCS8qIEJ1ZmZlciBv
YmplY3RzIG5lZWQgdG8gYmUgZWl0aGVyIHBpbm5lZCBvciByZXNlcnZlZDogKi8KIAlpZiAoIShk
c3QtPm1lbS5wbGFjZW1lbnQgJiBUVE1fUExfRkxBR19OT19FVklDVCkpCi0JCXJlc2VydmF0aW9u
X29iamVjdF9hc3NlcnRfaGVsZChkc3QtPmJhc2UucmVzdik7CisJCWRtYV9yZXN2X2Fzc2VydF9o
ZWxkKGRzdC0+YmFzZS5yZXN2KTsKIAlpZiAoIShzcmMtPm1lbS5wbGFjZW1lbnQgJiBUVE1fUExf
RkxBR19OT19FVklDVCkpCi0JCXJlc2VydmF0aW9uX29iamVjdF9hc3NlcnRfaGVsZChzcmMtPmJh
c2UucmVzdik7CisJCWRtYV9yZXN2X2Fzc2VydF9oZWxkKHNyYy0+YmFzZS5yZXN2KTsKIAogCWlm
IChkc3QtPnR0bS0+c3RhdGUgPT0gdHRfdW5wb3B1bGF0ZWQpIHsKIAkJcmV0ID0gZHN0LT50dG0t
PmJkZXYtPmRyaXZlci0+dHRtX3R0X3BvcHVsYXRlKGRzdC0+dHRtLCAmY3R4KTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2JvLmMgYi9kcml2ZXJzL2dwdS9kcm0v
dm13Z2Z4L3Ztd2dmeF9iby5jCmluZGV4IDM2OTAzNGMwZGUzMS4uYTA1ZWY5ZDBhMmU3IDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9iby5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS92bXdnZngvdm13Z2Z4X2JvLmMKQEAgLTM0Miw3ICszNDIsNyBAQCB2b2lkIHZtd19i
b19waW5fcmVzZXJ2ZWQoc3RydWN0IHZtd19idWZmZXJfb2JqZWN0ICp2Ym8sIGJvb2wgcGluKQog
CXVpbnQzMl90IG9sZF9tZW1fdHlwZSA9IGJvLT5tZW0ubWVtX3R5cGU7CiAJaW50IHJldDsKIAot
CXJlc2VydmF0aW9uX29iamVjdF9hc3NlcnRfaGVsZChiby0+YmFzZS5yZXN2KTsKKwlkbWFfcmVz
dl9hc3NlcnRfaGVsZChiby0+YmFzZS5yZXN2KTsKIAogCWlmIChwaW4pIHsKIAkJaWYgKHZiby0+
cGluX2NvdW50KysgPiAwKQpAQCAtNjg5LDcgKzY4OSw3IEBAIHN0YXRpYyBpbnQgdm13X3VzZXJf
Ym9fc3luY2NwdV9ncmFiKHN0cnVjdCB2bXdfdXNlcl9idWZmZXJfb2JqZWN0ICp1c2VyX2JvLAog
CQlib29sIG5vbmJsb2NrID0gISEoZmxhZ3MgJiBkcm1fdm13X3N5bmNjcHVfZG9udGJsb2NrKTsK
IAkJbG9uZyBscmV0OwogCi0JCWxyZXQgPSByZXNlcnZhdGlvbl9vYmplY3Rfd2FpdF90aW1lb3V0
X3JjdQorCQlscmV0ID0gZG1hX3Jlc3Zfd2FpdF90aW1lb3V0X3JjdQogCQkJKGJvLT5iYXNlLnJl
c3YsIHRydWUsIHRydWUsCiAJCQkgbm9uYmxvY2sgPyAwIDogTUFYX1NDSEVEVUxFX1RJTUVPVVQp
OwogCQlpZiAoIWxyZXQpCkBAIC0xMDA3LDEwICsxMDA3LDEwIEBAIHZvaWQgdm13X2JvX2ZlbmNl
X3NpbmdsZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCiAJaWYgKGZlbmNlID09IE5V
TEwpIHsKIAkJdm13X2V4ZWNidWZfZmVuY2VfY29tbWFuZHMoTlVMTCwgZGV2X3ByaXYsICZmZW5j
ZSwgTlVMTCk7Ci0JCXJlc2VydmF0aW9uX29iamVjdF9hZGRfZXhjbF9mZW5jZShiby0+YmFzZS5y
ZXN2LCAmZmVuY2UtPmJhc2UpOworCQlkbWFfcmVzdl9hZGRfZXhjbF9mZW5jZShiby0+YmFzZS5y
ZXN2LCAmZmVuY2UtPmJhc2UpOwogCQlkbWFfZmVuY2VfcHV0KCZmZW5jZS0+YmFzZSk7CiAJfSBl
bHNlCi0JCXJlc2VydmF0aW9uX29iamVjdF9hZGRfZXhjbF9mZW5jZShiby0+YmFzZS5yZXN2LCAm
ZmVuY2UtPmJhc2UpOworCQlkbWFfcmVzdl9hZGRfZXhjbF9mZW5jZShiby0+YmFzZS5yZXN2LCAm
ZmVuY2UtPmJhc2UpOwogfQogCiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngv
dm13Z2Z4X2NvdGFibGUuYyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2NvdGFibGUu
YwppbmRleCA3OTg0ZjE3MmVjNGEuLjFlM2JkNThiYzJkNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL3Ztd2dmeC92bXdnZnhfY290YWJsZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92bXdn
Zngvdm13Z2Z4X2NvdGFibGUuYwpAQCAtMTY5LDcgKzE2OSw3IEBAIHN0YXRpYyBpbnQgdm13X2Nv
dGFibGVfdW5zY3J1YihzdHJ1Y3Qgdm13X3Jlc291cmNlICpyZXMpCiAJfSAqY21kOwogCiAJV0FS
Tl9PTl9PTkNFKGJvLT5tZW0ubWVtX3R5cGUgIT0gVk1XX1BMX01PQik7Ci0JcmVzZXJ2YXRpb25f
b2JqZWN0X2Fzc2VydF9oZWxkKGJvLT5iYXNlLnJlc3YpOworCWRtYV9yZXN2X2Fzc2VydF9oZWxk
KGJvLT5iYXNlLnJlc3YpOwogCiAJY21kID0gVk1XX0ZJRk9fUkVTRVJWRShkZXZfcHJpdiwgc2l6
ZW9mKCpjbWQpKTsKIAlpZiAoIWNtZCkKQEAgLTMxMSw3ICszMTEsNyBAQCBzdGF0aWMgaW50IHZt
d19jb3RhYmxlX3VuYmluZChzdHJ1Y3Qgdm13X3Jlc291cmNlICpyZXMsCiAJCXJldHVybiAwOwog
CiAJV0FSTl9PTl9PTkNFKGJvLT5tZW0ubWVtX3R5cGUgIT0gVk1XX1BMX01PQik7Ci0JcmVzZXJ2
YXRpb25fb2JqZWN0X2Fzc2VydF9oZWxkKGJvLT5iYXNlLnJlc3YpOworCWRtYV9yZXN2X2Fzc2Vy
dF9oZWxkKGJvLT5iYXNlLnJlc3YpOwogCiAJbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmJpbmRpbmdf
bXV0ZXgpOwogCWlmICghdmNvdGJsLT5zY3J1YmJlZCkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS92bXdnZngvdm13Z2Z4X3Jlc291cmNlLmMgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Zt
d2dmeF9yZXNvdXJjZS5jCmluZGV4IDcwMTY0M2I3YjBjNC4uMGI1NDcyNDUwNjMzIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9yZXNvdXJjZS5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3Jlc291cmNlLmMKQEAgLTQwMiwxNCArNDAyLDE0IEBA
IHZvaWQgdm13X3Jlc291cmNlX3VucmVzZXJ2ZShzdHJ1Y3Qgdm13X3Jlc291cmNlICpyZXMsCiAK
IAlpZiAoc3dpdGNoX2JhY2t1cCAmJiBuZXdfYmFja3VwICE9IHJlcy0+YmFja3VwKSB7CiAJCWlm
IChyZXMtPmJhY2t1cCkgewotCQkJcmVzZXJ2YXRpb25fb2JqZWN0X2Fzc2VydF9oZWxkKHJlcy0+
YmFja3VwLT5iYXNlLmJhc2UucmVzdik7CisJCQlkbWFfcmVzdl9hc3NlcnRfaGVsZChyZXMtPmJh
Y2t1cC0+YmFzZS5iYXNlLnJlc3YpOwogCQkJbGlzdF9kZWxfaW5pdCgmcmVzLT5tb2JfaGVhZCk7
CiAJCQl2bXdfYm9fdW5yZWZlcmVuY2UoJnJlcy0+YmFja3VwKTsKIAkJfQogCiAJCWlmIChuZXdf
YmFja3VwKSB7CiAJCQlyZXMtPmJhY2t1cCA9IHZtd19ib19yZWZlcmVuY2UobmV3X2JhY2t1cCk7
Ci0JCQlyZXNlcnZhdGlvbl9vYmplY3RfYXNzZXJ0X2hlbGQobmV3X2JhY2t1cC0+YmFzZS5iYXNl
LnJlc3YpOworCQkJZG1hX3Jlc3ZfYXNzZXJ0X2hlbGQobmV3X2JhY2t1cC0+YmFzZS5iYXNlLnJl
c3YpOwogCQkJbGlzdF9hZGRfdGFpbCgmcmVzLT5tb2JfaGVhZCwgJm5ld19iYWNrdXAtPnJlc19s
aXN0KTsKIAkJfSBlbHNlIHsKIAkJCXJlcy0+YmFja3VwID0gTlVMTDsKQEAgLTY5MSw3ICs2OTEs
NyBAQCB2b2lkIHZtd19yZXNvdXJjZV91bmJpbmRfbGlzdChzdHJ1Y3Qgdm13X2J1ZmZlcl9vYmpl
Y3QgKnZibykKIAkJLm51bV9zaGFyZWQgPSAwCiAJfTsKIAotCXJlc2VydmF0aW9uX29iamVjdF9h
c3NlcnRfaGVsZCh2Ym8tPmJhc2UuYmFzZS5yZXN2KTsKKwlkbWFfcmVzdl9hc3NlcnRfaGVsZCh2
Ym8tPmJhc2UuYmFzZS5yZXN2KTsKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUocmVzLCBuZXh0
LCAmdmJvLT5yZXNfbGlzdCwgbW9iX2hlYWQpIHsKIAkJaWYgKCFyZXMtPmZ1bmMtPnVuYmluZCkK
IAkJCWNvbnRpbnVlOwpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0vZHJtUC5oIGIvaW5jbHVkZS9k
cm0vZHJtUC5oCmluZGV4IDk0YWFlODdiMTEzOC4uMDM3YjFmN2E4N2E1IDEwMDY0NAotLS0gYS9p
bmNsdWRlL2RybS9kcm1QLmgKKysrIGIvaW5jbHVkZS9kcm0vZHJtUC5oCkBAIC04Nyw3ICs4Nyw3
IEBAIHN0cnVjdCBtb2R1bGU7CiAKIHN0cnVjdCBkZXZpY2Vfbm9kZTsKIHN0cnVjdCB2aWRlb21v
ZGU7Ci1zdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0Oworc3RydWN0IGRtYV9yZXN2Owogc3RydWN0
IGRtYV9idWZfYXR0YWNobWVudDsKIAogc3RydWN0IHBjaV9kZXY7CmRpZmYgLS1naXQgYS9pbmNs
dWRlL2RybS9kcm1fZ2VtLmggYi9pbmNsdWRlL2RybS9kcm1fZ2VtLmgKaW5kZXggYWU2OTNjMDY2
NmNkLi42YWFiYTE0ZjU5NzIgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvZHJtL2RybV9nZW0uaAorKysg
Yi9pbmNsdWRlL2RybS9kcm1fZ2VtLmgKQEAgLTM1LDcgKzM1LDcgQEAKICAqLwogCiAjaW5jbHVk
ZSA8bGludXgva3JlZi5oPgotI2luY2x1ZGUgPGxpbnV4L3Jlc2VydmF0aW9uLmg+CisjaW5jbHVk
ZSA8bGludXgvZG1hLXJlc3YuaD4KIAogI2luY2x1ZGUgPGRybS9kcm1fdm1hX21hbmFnZXIuaD4K
IApAQCAtMjc2LDcgKzI3Niw3IEBAIHN0cnVjdCBkcm1fZ2VtX29iamVjdCB7CiAJICoKIAkgKiBO
b3JtYWxseSAoQHJlc3YgPT0gJkBfcmVzdikgZXhjZXB0IGZvciBpbXBvcnRlZCBHRU0gb2JqZWN0
cy4KIAkgKi8KLQlzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyZXN2OworCXN0cnVjdCBkbWFf
cmVzdiAqcmVzdjsKIAogCS8qKgogCSAqIEBfcmVzdjoKQEAgLTI4NSw3ICsyODUsNyBAQCBzdHJ1
Y3QgZHJtX2dlbV9vYmplY3QgewogCSAqCiAJICogVGhpcyBpcyB1bnVzZWQgZm9yIGltcG9ydGVk
IEdFTSBvYmplY3RzLgogCSAqLwotCXN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgX3Jlc3Y7CisJ
c3RydWN0IGRtYV9yZXN2IF9yZXN2OwogCiAJLyoqCiAJICogQGZ1bmNzOgpAQCAtMzkwLDcgKzM5
MCw3IEBAIHZvaWQgZHJtX2dlbV9wdXRfcGFnZXMoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmos
IHN0cnVjdCBwYWdlICoqcGFnZXMsCiBpbnQgZHJtX2dlbV9vYmplY3RzX2xvb2t1cChzdHJ1Y3Qg
ZHJtX2ZpbGUgKmZpbHAsIHZvaWQgX191c2VyICpib19oYW5kbGVzLAogCQkJICAgaW50IGNvdW50
LCBzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKioqb2Jqc19vdXQpOwogc3RydWN0IGRybV9nZW1fb2Jq
ZWN0ICpkcm1fZ2VtX29iamVjdF9sb29rdXAoc3RydWN0IGRybV9maWxlICpmaWxwLCB1MzIgaGFu
ZGxlKTsKLWxvbmcgZHJtX2dlbV9yZXNlcnZhdGlvbl9vYmplY3Rfd2FpdChzdHJ1Y3QgZHJtX2Zp
bGUgKmZpbGVwLCB1MzIgaGFuZGxlLAorbG9uZyBkcm1fZ2VtX2RtYV9yZXN2X3dhaXQoc3RydWN0
IGRybV9maWxlICpmaWxlcCwgdTMyIGhhbmRsZSwKIAkJCQkgICAgYm9vbCB3YWl0X2FsbCwgdW5z
aWduZWQgbG9uZyB0aW1lb3V0KTsKIGludCBkcm1fZ2VtX2xvY2tfcmVzZXJ2YXRpb25zKHN0cnVj
dCBkcm1fZ2VtX29iamVjdCAqKm9ianMsIGludCBjb3VudCwKIAkJCSAgICAgIHN0cnVjdCB3d19h
Y3F1aXJlX2N0eCAqYWNxdWlyZV9jdHgpOwpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0vdHRtL3R0
bV9ib19hcGkuaCBiL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmgKaW5kZXggNjVlZjUzNzZk
ZTU5Li40M2M0OTI5YTIxNzEgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBp
LmgKKysrIGIvaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19hcGkuaApAQCAtNDAsNyArNDAsNyBAQAog
I2luY2x1ZGUgPGxpbnV4L211dGV4Lmg+CiAjaW5jbHVkZSA8bGludXgvbW0uaD4KICNpbmNsdWRl
IDxsaW51eC9iaXRtYXAuaD4KLSNpbmNsdWRlIDxsaW51eC9yZXNlcnZhdGlvbi5oPgorI2luY2x1
ZGUgPGxpbnV4L2RtYS1yZXN2Lmg+CiAKIHN0cnVjdCB0dG1fYm9fZ2xvYmFsOwogCkBAIC0yNzMs
NyArMjczLDcgQEAgc3RydWN0IHR0bV9ib19rbWFwX29iaiB7CiBzdHJ1Y3QgdHRtX29wZXJhdGlv
bl9jdHggewogCWJvb2wgaW50ZXJydXB0aWJsZTsKIAlib29sIG5vX3dhaXRfZ3B1OwotCXN0cnVj
dCByZXNlcnZhdGlvbl9vYmplY3QgKnJlc3Y7CisJc3RydWN0IGRtYV9yZXN2ICpyZXN2OwogCXVp
bnQ2NF90IGJ5dGVzX21vdmVkOwogCXVpbnQzMl90IGZsYWdzOwogfTsKQEAgLTQ5Myw3ICs0OTMs
NyBAQCBzaXplX3QgdHRtX2JvX2RtYV9hY2Nfc2l6ZShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRl
diwKICAqIEBwYWdlX2FsaWdubWVudDogRGF0YSBhbGlnbm1lbnQgaW4gcGFnZXMuCiAgKiBAY3R4
OiBUVE0gb3BlcmF0aW9uIGNvbnRleHQgZm9yIG1lbW9yeSBhbGxvY2F0aW9uLgogICogQGFjY19z
aXplOiBBY2NvdW50ZWQgc2l6ZSBmb3IgdGhpcyBvYmplY3QuCi0gKiBAcmVzdjogUG9pbnRlciB0
byBhIHJlc2VydmF0aW9uX29iamVjdCwgb3IgTlVMTCB0byBsZXQgdHRtIGFsbG9jYXRlIG9uZS4K
KyAqIEByZXN2OiBQb2ludGVyIHRvIGEgZG1hX3Jlc3YsIG9yIE5VTEwgdG8gbGV0IHR0bSBhbGxv
Y2F0ZSBvbmUuCiAgKiBAZGVzdHJveTogRGVzdHJveSBmdW5jdGlvbi4gVXNlIE5VTEwgZm9yIGtm
cmVlKCkuCiAgKgogICogVGhpcyBmdW5jdGlvbiBpbml0aWFsaXplcyBhIHByZS1hbGxvY2F0ZWQg
c3RydWN0IHR0bV9idWZmZXJfb2JqZWN0LgpAQCAtNTI2LDcgKzUyNiw3IEBAIGludCB0dG1fYm9f
aW5pdF9yZXNlcnZlZChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKIAkJCSBzdHJ1Y3QgdHRt
X29wZXJhdGlvbl9jdHggKmN0eCwKIAkJCSBzaXplX3QgYWNjX3NpemUsCiAJCQkgc3RydWN0IHNn
X3RhYmxlICpzZywKLQkJCSBzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyZXN2LAorCQkJIHN0
cnVjdCBkbWFfcmVzdiAqcmVzdiwKIAkJCSB2b2lkICgqZGVzdHJveSkgKHN0cnVjdCB0dG1fYnVm
ZmVyX29iamVjdCAqKSk7CiAKIC8qKgpAQCAtNTQ1LDcgKzU0NSw3IEBAIGludCB0dG1fYm9faW5p
dF9yZXNlcnZlZChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKICAqIHBvaW50IHRvIHRoZSBz
aG1lbSBvYmplY3QgYmFja2luZyBhIEdFTSBvYmplY3QgaWYgVFRNIGlzIHVzZWQgdG8gYmFjayBh
CiAgKiBHRU0gdXNlciBpbnRlcmZhY2UuCiAgKiBAYWNjX3NpemU6IEFjY291bnRlZCBzaXplIGZv
ciB0aGlzIG9iamVjdC4KLSAqIEByZXN2OiBQb2ludGVyIHRvIGEgcmVzZXJ2YXRpb25fb2JqZWN0
LCBvciBOVUxMIHRvIGxldCB0dG0gYWxsb2NhdGUgb25lLgorICogQHJlc3Y6IFBvaW50ZXIgdG8g
YSBkbWFfcmVzdiwgb3IgTlVMTCB0byBsZXQgdHRtIGFsbG9jYXRlIG9uZS4KICAqIEBkZXN0cm95
OiBEZXN0cm95IGZ1bmN0aW9uLiBVc2UgTlVMTCBmb3Iga2ZyZWUoKS4KICAqCiAgKiBUaGlzIGZ1
bmN0aW9uIGluaXRpYWxpemVzIGEgcHJlLWFsbG9jYXRlZCBzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmpl
Y3QuCkBAIC01NzAsNyArNTcwLDcgQEAgaW50IHR0bV9ib19pbml0KHN0cnVjdCB0dG1fYm9fZGV2
aWNlICpiZGV2LCBzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQl1bnNpZ25lZCBsb25n
IHNpemUsIGVudW0gdHRtX2JvX3R5cGUgdHlwZSwKIAkJc3RydWN0IHR0bV9wbGFjZW1lbnQgKnBs
YWNlbWVudCwKIAkJdWludDMyX3QgcGFnZV9hbGlnbm1lbnQsIGJvb2wgaW50ZXJydWJ0aWJsZSwg
c2l6ZV90IGFjY19zaXplLAotCQlzdHJ1Y3Qgc2dfdGFibGUgKnNnLCBzdHJ1Y3QgcmVzZXJ2YXRp
b25fb2JqZWN0ICpyZXN2LAorCQlzdHJ1Y3Qgc2dfdGFibGUgKnNnLCBzdHJ1Y3QgZG1hX3Jlc3Yg
KnJlc3YsCiAJCXZvaWQgKCpkZXN0cm95KSAoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICopKTsK
IAogLyoqCmRpZmYgLS1naXQgYS9pbmNsdWRlL2RybS90dG0vdHRtX2JvX2RyaXZlci5oIGIvaW5j
bHVkZS9kcm0vdHRtL3R0bV9ib19kcml2ZXIuaAppbmRleCAzZjE5MzVjMTlhNjYuLmU4OGUwMGM2
Y2JmMiAxMDA2NDQKLS0tIGEvaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19kcml2ZXIuaAorKysgYi9p
bmNsdWRlL2RybS90dG0vdHRtX2JvX2RyaXZlci5oCkBAIC0zNSw3ICszNSw3IEBACiAjaW5jbHVk
ZSA8bGludXgvd29ya3F1ZXVlLmg+CiAjaW5jbHVkZSA8bGludXgvZnMuaD4KICNpbmNsdWRlIDxs
aW51eC9zcGlubG9jay5oPgotI2luY2x1ZGUgPGxpbnV4L3Jlc2VydmF0aW9uLmg+CisjaW5jbHVk
ZSA8bGludXgvZG1hLXJlc3YuaD4KIAogI2luY2x1ZGUgInR0bV9ib19hcGkuaCIKICNpbmNsdWRl
ICJ0dG1fbWVtb3J5LmgiCkBAIC02NTQsMTQgKzY1NCwxNCBAQCBzdGF0aWMgaW5saW5lIGludCBf
X3R0bV9ib19yZXNlcnZlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJCWlmIChXQVJO
X09OKHRpY2tldCkpCiAJCQlyZXR1cm4gLUVCVVNZOwogCi0JCXN1Y2Nlc3MgPSByZXNlcnZhdGlv
bl9vYmplY3RfdHJ5bG9jayhiby0+YmFzZS5yZXN2KTsKKwkJc3VjY2VzcyA9IGRtYV9yZXN2X3Ry
eWxvY2soYm8tPmJhc2UucmVzdik7CiAJCXJldHVybiBzdWNjZXNzID8gMCA6IC1FQlVTWTsKIAl9
CiAKIAlpZiAoaW50ZXJydXB0aWJsZSkKLQkJcmV0ID0gcmVzZXJ2YXRpb25fb2JqZWN0X2xvY2tf
aW50ZXJydXB0aWJsZShiby0+YmFzZS5yZXN2LCB0aWNrZXQpOworCQlyZXQgPSBkbWFfcmVzdl9s
b2NrX2ludGVycnVwdGlibGUoYm8tPmJhc2UucmVzdiwgdGlja2V0KTsKIAllbHNlCi0JCXJldCA9
IHJlc2VydmF0aW9uX29iamVjdF9sb2NrKGJvLT5iYXNlLnJlc3YsIHRpY2tldCk7CisJCXJldCA9
IGRtYV9yZXN2X2xvY2soYm8tPmJhc2UucmVzdiwgdGlja2V0KTsKIAlpZiAocmV0ID09IC1FSU5U
UikKIAkJcmV0dXJuIC1FUkVTVEFSVFNZUzsKIAlyZXR1cm4gcmV0OwpAQCAtNzQ1LDEwICs3NDUs
MTAgQEAgc3RhdGljIGlubGluZSBpbnQgdHRtX2JvX3Jlc2VydmVfc2xvd3BhdGgoc3RydWN0IHR0
bV9idWZmZXJfb2JqZWN0ICpibywKIAlXQVJOX09OKCFrcmVmX3JlYWQoJmJvLT5rcmVmKSk7CiAK
IAlpZiAoaW50ZXJydXB0aWJsZSkKLQkJcmV0ID0gcmVzZXJ2YXRpb25fb2JqZWN0X2xvY2tfc2xv
d19pbnRlcnJ1cHRpYmxlKGJvLT5iYXNlLnJlc3YsCisJCXJldCA9IGRtYV9yZXN2X2xvY2tfc2xv
d19pbnRlcnJ1cHRpYmxlKGJvLT5iYXNlLnJlc3YsCiAJCQkJCQkJCSB0aWNrZXQpOwogCWVsc2UK
LQkJcmVzZXJ2YXRpb25fb2JqZWN0X2xvY2tfc2xvdyhiby0+YmFzZS5yZXN2LCB0aWNrZXQpOwor
CQlkbWFfcmVzdl9sb2NrX3Nsb3coYm8tPmJhc2UucmVzdiwgdGlja2V0KTsKIAogCWlmIChsaWtl
bHkocmV0ID09IDApKQogCQl0dG1fYm9fZGVsX3N1Yl9mcm9tX2xydShibyk7CkBAIC03NzMsNyAr
NzczLDcgQEAgc3RhdGljIGlubGluZSB2b2lkIHR0bV9ib191bnJlc2VydmUoc3RydWN0IHR0bV9i
dWZmZXJfb2JqZWN0ICpibykKIAllbHNlCiAJCXR0bV9ib19tb3ZlX3RvX2xydV90YWlsKGJvLCBO
VUxMKTsKIAlzcGluX3VubG9jaygmYm8tPmJkZXYtPmdsb2ItPmxydV9sb2NrKTsKLQlyZXNlcnZh
dGlvbl9vYmplY3RfdW5sb2NrKGJvLT5iYXNlLnJlc3YpOworCWRtYV9yZXN2X3VubG9jayhiby0+
YmFzZS5yZXN2KTsKIH0KIAogLyoKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvZG1hLWJ1Zi5o
IGIvaW5jbHVkZS9saW51eC9kbWEtYnVmLmgKaW5kZXggYmFlMDYwZmFlODYyLi5lYzIxMmNiMjdm
ZGMgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvbGludXgvZG1hLWJ1Zi5oCisrKyBiL2luY2x1ZGUvbGlu
dXgvZG1hLWJ1Zi5oCkBAIC0zMDYsNyArMzA2LDcgQEAgc3RydWN0IGRtYV9idWYgewogCXN0cnVj
dCBtb2R1bGUgKm93bmVyOwogCXN0cnVjdCBsaXN0X2hlYWQgbGlzdF9ub2RlOwogCXZvaWQgKnBy
aXY7Ci0Jc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdjsKKwlzdHJ1Y3QgZG1hX3Jlc3Yg
KnJlc3Y7CiAKIAkvKiBwb2xsIHN1cHBvcnQgKi8KIAl3YWl0X3F1ZXVlX2hlYWRfdCBwb2xsOwpA
QCAtMzY1LDcgKzM2NSw3IEBAIHN0cnVjdCBkbWFfYnVmX2V4cG9ydF9pbmZvIHsKIAljb25zdCBz
dHJ1Y3QgZG1hX2J1Zl9vcHMgKm9wczsKIAlzaXplX3Qgc2l6ZTsKIAlpbnQgZmxhZ3M7Ci0Jc3Ry
dWN0IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdjsKKwlzdHJ1Y3QgZG1hX3Jlc3YgKnJlc3Y7CiAJ
dm9pZCAqcHJpdjsKIH07CiAKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvZG1hLWZlbmNlLmgg
Yi9pbmNsdWRlL2xpbnV4L2RtYS1mZW5jZS5oCmluZGV4IGJlYTFkMDVjZjUxZS4uNDA0YWE3NDhl
ZGE2IDEwMDY0NAotLS0gYS9pbmNsdWRlL2xpbnV4L2RtYS1mZW5jZS5oCisrKyBiL2luY2x1ZGUv
bGludXgvZG1hLWZlbmNlLmgKQEAgLTI3OSw3ICsyNzksNyBAQCBzdGF0aWMgaW5saW5lIHN0cnVj
dCBkbWFfZmVuY2UgKmRtYV9mZW5jZV9nZXQoc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpCiB9CiAK
IC8qKgotICogZG1hX2ZlbmNlX2dldF9yY3UgLSBnZXQgYSBmZW5jZSBmcm9tIGEgcmVzZXJ2YXRp
b25fb2JqZWN0X2xpc3Qgd2l0aAorICogZG1hX2ZlbmNlX2dldF9yY3UgLSBnZXQgYSBmZW5jZSBm
cm9tIGEgZG1hX3Jlc3ZfbGlzdCB3aXRoCiAgKiAgICAgICAgICAgICAgICAgICAgIHJjdSByZWFk
IGxvY2sKICAqIEBmZW5jZTogZmVuY2UgdG8gaW5jcmVhc2UgcmVmY291bnQgb2YKICAqCkBAIC0z
MDMsNyArMzAzLDcgQEAgc3RhdGljIGlubGluZSBzdHJ1Y3QgZG1hX2ZlbmNlICpkbWFfZmVuY2Vf
Z2V0X3JjdShzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSkKICAqIHNvIGxvbmcgYXMgdGhlIGNhbGxl
ciBpcyB1c2luZyBSQ1Ugb24gdGhlIHBvaW50ZXIgdG8gdGhlIGZlbmNlLgogICoKICAqIEFuIGFs
dGVybmF0aXZlIG1lY2hhbmlzbSBpcyB0byBlbXBsb3kgYSBzZXFsb2NrIHRvIHByb3RlY3QgYSBi
dW5jaCBvZgotICogZmVuY2VzLCBzdWNoIGFzIHVzZWQgYnkgc3RydWN0IHJlc2VydmF0aW9uX29i
amVjdC4gV2hlbiB1c2luZyBhIHNlcWxvY2ssCisgKiBmZW5jZXMsIHN1Y2ggYXMgdXNlZCBieSBz
dHJ1Y3QgZG1hX3Jlc3YuIFdoZW4gdXNpbmcgYSBzZXFsb2NrLAogICogdGhlIHNlcWxvY2sgbXVz
dCBiZSB0YWtlbiBiZWZvcmUgYW5kIGNoZWNrZWQgYWZ0ZXIgYSByZWZlcmVuY2UgdG8gdGhlCiAg
KiBmZW5jZSBpcyBhY3F1aXJlZCAoYXMgc2hvd24gaGVyZSkuCiAgKgpkaWZmIC0tZ2l0IGEvaW5j
bHVkZS9saW51eC9yZXNlcnZhdGlvbi5oIGIvaW5jbHVkZS9saW51eC9kbWEtcmVzdi5oCnNpbWls
YXJpdHkgaW5kZXggNjQlCnJlbmFtZSBmcm9tIGluY2x1ZGUvbGludXgvcmVzZXJ2YXRpb24uaApy
ZW5hbWUgdG8gaW5jbHVkZS9saW51eC9kbWEtcmVzdi5oCmluZGV4IGFjZGRlZmVhNjk0Zi4uMzhm
MjgwMmFmYWJiIDEwMDY0NAotLS0gYS9pbmNsdWRlL2xpbnV4L3Jlc2VydmF0aW9uLmgKKysrIGIv
aW5jbHVkZS9saW51eC9kbWEtcmVzdi5oCkBAIC00OCwzOCArNDgsMzcgQEAKIGV4dGVybiBzdHJ1
Y3Qgd3dfY2xhc3MgcmVzZXJ2YXRpb25fd3dfY2xhc3M7CiAKIC8qKgotICogc3RydWN0IHJlc2Vy
dmF0aW9uX29iamVjdF9saXN0IC0gYSBsaXN0IG9mIHNoYXJlZCBmZW5jZXMKKyAqIHN0cnVjdCBk
bWFfcmVzdl9saXN0IC0gYSBsaXN0IG9mIHNoYXJlZCBmZW5jZXMKICAqIEByY3U6IGZvciBpbnRl
cm5hbCB1c2UKICAqIEBzaGFyZWRfY291bnQ6IHRhYmxlIG9mIHNoYXJlZCBmZW5jZXMKICAqIEBz
aGFyZWRfbWF4OiBmb3IgZ3Jvd2luZyBzaGFyZWQgZmVuY2UgdGFibGUKICAqIEBzaGFyZWQ6IHNo
YXJlZCBmZW5jZSB0YWJsZQogICovCi1zdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0X2xpc3Qgewor
c3RydWN0IGRtYV9yZXN2X2xpc3QgewogCXN0cnVjdCByY3VfaGVhZCByY3U7CiAJdTMyIHNoYXJl
ZF9jb3VudCwgc2hhcmVkX21heDsKIAlzdHJ1Y3QgZG1hX2ZlbmNlIF9fcmN1ICpzaGFyZWRbXTsK
IH07CiAKIC8qKgotICogc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAtIGEgcmVzZXJ2YXRpb24g
b2JqZWN0IG1hbmFnZXMgZmVuY2VzIGZvciBhIGJ1ZmZlcgorICogc3RydWN0IGRtYV9yZXN2IC0g
YSByZXNlcnZhdGlvbiBvYmplY3QgbWFuYWdlcyBmZW5jZXMgZm9yIGEgYnVmZmVyCiAgKiBAbG9j
azogdXBkYXRlIHNpZGUgbG9jawogICogQHNlcTogc2VxdWVuY2UgY291bnQgZm9yIG1hbmFnaW5n
IFJDVSByZWFkLXNpZGUgc3luY2hyb25pemF0aW9uCiAgKiBAZmVuY2VfZXhjbDogdGhlIGV4Y2x1
c2l2ZSBmZW5jZSwgaWYgdGhlcmUgaXMgb25lIGN1cnJlbnRseQogICogQGZlbmNlOiBsaXN0IG9m
IGN1cnJlbnQgc2hhcmVkIGZlbmNlcwogICovCi1zdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0IHsK
K3N0cnVjdCBkbWFfcmVzdiB7CiAJc3RydWN0IHd3X211dGV4IGxvY2s7CiAKIAlzdHJ1Y3QgZG1h
X2ZlbmNlIF9fcmN1ICpmZW5jZV9leGNsOwotCXN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3RfbGlz
dCBfX3JjdSAqZmVuY2U7CisJc3RydWN0IGRtYV9yZXN2X2xpc3QgX19yY3UgKmZlbmNlOwogfTsK
IAotI2RlZmluZSByZXNlcnZhdGlvbl9vYmplY3RfaGVsZChvYmopIGxvY2tkZXBfaXNfaGVsZCgm
KG9iaiktPmxvY2suYmFzZSkKLSNkZWZpbmUgcmVzZXJ2YXRpb25fb2JqZWN0X2Fzc2VydF9oZWxk
KG9iaikgXAotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJihvYmopLT5sb2NrLmJhc2UpCisjZGVmaW5l
IGRtYV9yZXN2X2hlbGQob2JqKSBsb2NrZGVwX2lzX2hlbGQoJihvYmopLT5sb2NrLmJhc2UpCisj
ZGVmaW5lIGRtYV9yZXN2X2Fzc2VydF9oZWxkKG9iaikgbG9ja2RlcF9hc3NlcnRfaGVsZCgmKG9i
aiktPmxvY2suYmFzZSkKIAogLyoqCi0gKiByZXNlcnZhdGlvbl9vYmplY3RfZ2V0X2V4Y2wgLSBn
ZXQgdGhlIHJlc2VydmF0aW9uIG9iamVjdCdzCisgKiBkbWFfcmVzdl9nZXRfZXhjbCAtIGdldCB0
aGUgcmVzZXJ2YXRpb24gb2JqZWN0J3MKICAqIGV4Y2x1c2l2ZSBmZW5jZSwgd2l0aCB1cGRhdGUt
c2lkZSBsb2NrIGhlbGQKICAqIEBvYmo6IHRoZSByZXNlcnZhdGlvbiBvYmplY3QKICAqCkBAIC05
MCwzMCArODksMjggQEAgc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCB7CiAgKiBSRVRVUk5TCiAg
KiBUaGUgZXhjbHVzaXZlIGZlbmNlIG9yIE5VTEwKICAqLwotc3RhdGljIGlubGluZSBzdHJ1Y3Qg
ZG1hX2ZlbmNlICoKLXJlc2VydmF0aW9uX29iamVjdF9nZXRfZXhjbChzdHJ1Y3QgcmVzZXJ2YXRp
b25fb2JqZWN0ICpvYmopCitzdGF0aWMgaW5saW5lIHN0cnVjdCBkbWFfZmVuY2UgKmRtYV9yZXN2
X2dldF9leGNsKHN0cnVjdCBkbWFfcmVzdiAqb2JqKQogewogCXJldHVybiByY3VfZGVyZWZlcmVu
Y2VfcHJvdGVjdGVkKG9iai0+ZmVuY2VfZXhjbCwKLQkJCQkJIHJlc2VydmF0aW9uX29iamVjdF9o
ZWxkKG9iaikpOworCQkJCQkgZG1hX3Jlc3ZfaGVsZChvYmopKTsKIH0KIAogLyoqCi0gKiByZXNl
cnZhdGlvbl9vYmplY3RfZ2V0X2xpc3QgLSBnZXQgdGhlIHJlc2VydmF0aW9uIG9iamVjdCdzCisg
KiBkbWFfcmVzdl9nZXRfbGlzdCAtIGdldCB0aGUgcmVzZXJ2YXRpb24gb2JqZWN0J3MKICAqIHNo
YXJlZCBmZW5jZSBsaXN0LCB3aXRoIHVwZGF0ZS1zaWRlIGxvY2sgaGVsZAogICogQG9iajogdGhl
IHJlc2VydmF0aW9uIG9iamVjdAogICoKICAqIFJldHVybnMgdGhlIHNoYXJlZCBmZW5jZSBsaXN0
LiAgRG9lcyBOT1QgdGFrZSByZWZlcmVuY2VzIHRvCiAgKiB0aGUgZmVuY2UuICBUaGUgb2JqLT5s
b2NrIG11c3QgYmUgaGVsZC4KICAqLwotc3RhdGljIGlubGluZSBzdHJ1Y3QgcmVzZXJ2YXRpb25f
b2JqZWN0X2xpc3QgKgotcmVzZXJ2YXRpb25fb2JqZWN0X2dldF9saXN0KHN0cnVjdCByZXNlcnZh
dGlvbl9vYmplY3QgKm9iaikKK3N0YXRpYyBpbmxpbmUgc3RydWN0IGRtYV9yZXN2X2xpc3QgKmRt
YV9yZXN2X2dldF9saXN0KHN0cnVjdCBkbWFfcmVzdiAqb2JqKQogewogCXJldHVybiByY3VfZGVy
ZWZlcmVuY2VfcHJvdGVjdGVkKG9iai0+ZmVuY2UsCi0JCQkJCSByZXNlcnZhdGlvbl9vYmplY3Rf
aGVsZChvYmopKTsKKwkJCQkJIGRtYV9yZXN2X2hlbGQob2JqKSk7CiB9CiAKIC8qKgotICogcmVz
ZXJ2YXRpb25fb2JqZWN0X2ZlbmNlcyAtIHJlYWQgY29uc2lzdGVudCBmZW5jZSBwb2ludGVycwor
ICogZG1hX3Jlc3ZfZmVuY2VzIC0gcmVhZCBjb25zaXN0ZW50IGZlbmNlIHBvaW50ZXJzCiAgKiBA
b2JqOiByZXNlcnZhdGlvbiBvYmplY3Qgd2hlcmUgd2UgZ2V0IHRoZSBmZW5jZXMgZnJvbQogICog
QGV4Y2w6IHBvaW50ZXIgZm9yIHRoZSBleGNsdXNpdmUgZmVuY2UKICAqIEBsaXN0OiBwb2ludGVy
IGZvciB0aGUgc2hhcmVkIGZlbmNlIGxpc3QKQEAgLTEyMSwyMiArMTE4LDIxIEBAIHJlc2VydmF0
aW9uX29iamVjdF9nZXRfbGlzdChzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpvYmopCiAgKiBN
YWtlIHN1cmUgd2UgaGF2ZSBhIGNvbnNpc3RlbiBleGNsdXNpdmUgZmVuY2UgYW5kIHNoYXJlZCBm
ZW5jZSBsaXN0LgogICogTXVzdCBiZSBjYWxsZWQgd2l0aCByY3UgcmVhZCBzaWRlIGxvY2sgaGVs
ZC4KICAqLwotc3RhdGljIGlubGluZSB2b2lkCi1yZXNlcnZhdGlvbl9vYmplY3RfZmVuY2VzKHN0
cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKm9iaiwKLQkJCSAgc3RydWN0IGRtYV9mZW5jZSAqKmV4
Y2wsCi0JCQkgIHN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3RfbGlzdCAqKmxpc3QsCi0JCQkgIHUz
MiAqc2hhcmVkX2NvdW50KQorc3RhdGljIGlubGluZSB2b2lkIGRtYV9yZXN2X2ZlbmNlcyhzdHJ1
Y3QgZG1hX3Jlc3YgKm9iaiwKKwkJCQkgICBzdHJ1Y3QgZG1hX2ZlbmNlICoqZXhjbCwKKwkJCQkg
ICBzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCAqKmxpc3QsCisJCQkJICAgdTMyICpzaGFyZWRfY291bnQp
CiB7CiAJZG8gewogCQkqZXhjbCA9IHJjdV9kZXJlZmVyZW5jZShvYmotPmZlbmNlX2V4Y2wpOwog
CQkqbGlzdCA9IHJjdV9kZXJlZmVyZW5jZShvYmotPmZlbmNlKTsKIAkJKnNoYXJlZF9jb3VudCA9
ICpsaXN0ID8gKCpsaXN0KS0+c2hhcmVkX2NvdW50IDogMDsKLQkJc21wX3JtYigpOyAvKiBTZWUg
cmVzZXJ2YXRpb25fb2JqZWN0X2FkZF9leGNsX2ZlbmNlICovCisJCXNtcF9ybWIoKTsgLyogU2Vl
IGRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlICovCiAJfSB3aGlsZSAocmN1X2FjY2Vzc19wb2ludGVy
KG9iai0+ZmVuY2VfZXhjbCkgIT0gKmV4Y2wpOwogfQogCiAvKioKLSAqIHJlc2VydmF0aW9uX29i
amVjdF9nZXRfZXhjbF9yY3UgLSBnZXQgdGhlIHJlc2VydmF0aW9uIG9iamVjdCdzCisgKiBkbWFf
cmVzdl9nZXRfZXhjbF9yY3UgLSBnZXQgdGhlIHJlc2VydmF0aW9uIG9iamVjdCdzCiAgKiBleGNs
dXNpdmUgZmVuY2UsIHdpdGhvdXQgbG9jayBoZWxkLgogICogQG9iajogdGhlIHJlc2VydmF0aW9u
IG9iamVjdAogICoKQEAgLTE0Niw4ICsxNDIsNyBAQCByZXNlcnZhdGlvbl9vYmplY3RfZmVuY2Vz
KHN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKm9iaiwKICAqIFJFVFVSTlMKICAqIFRoZSBleGNs
dXNpdmUgZmVuY2Ugb3IgTlVMTCBpZiBub25lCiAgKi8KLXN0YXRpYyBpbmxpbmUgc3RydWN0IGRt
YV9mZW5jZSAqCi1yZXNlcnZhdGlvbl9vYmplY3RfZ2V0X2V4Y2xfcmN1KHN0cnVjdCByZXNlcnZh
dGlvbl9vYmplY3QgKm9iaikKK3N0YXRpYyBpbmxpbmUgc3RydWN0IGRtYV9mZW5jZSAqZG1hX3Jl
c3ZfZ2V0X2V4Y2xfcmN1KHN0cnVjdCBkbWFfcmVzdiAqb2JqKQogewogCXN0cnVjdCBkbWFfZmVu
Y2UgKmZlbmNlOwogCkBAIC0xNjIsNyArMTU3LDcgQEAgcmVzZXJ2YXRpb25fb2JqZWN0X2dldF9l
eGNsX3JjdShzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpvYmopCiB9CiAKIC8qKgotICogcmVz
ZXJ2YXRpb25fb2JqZWN0X2xvY2sgLSBsb2NrIHRoZSByZXNlcnZhdGlvbiBvYmplY3QKKyAqIGRt
YV9yZXN2X2xvY2sgLSBsb2NrIHRoZSByZXNlcnZhdGlvbiBvYmplY3QKICAqIEBvYmo6IHRoZSBy
ZXNlcnZhdGlvbiBvYmplY3QKICAqIEBjdHg6IHRoZSBsb2NraW5nIGNvbnRleHQKICAqCkBAIC0x
NzYsMTUgKzE3MSwxNCBAQCByZXNlcnZhdGlvbl9vYmplY3RfZ2V0X2V4Y2xfcmN1KHN0cnVjdCBy
ZXNlcnZhdGlvbl9vYmplY3QgKm9iaikKICAqIGlzIGRldGVjdGVkLiBTZWUgd3dfbXV0ZXhfbG9j
aygpIGFuZCB3d19hY3F1aXJlX2luaXQoKS4gQSByZXNlcnZhdGlvbgogICogb2JqZWN0IG1heSBi
ZSBsb2NrZWQgYnkgaXRzZWxmIGJ5IHBhc3NpbmcgTlVMTCBhcyBAY3R4LgogICovCi1zdGF0aWMg
aW5saW5lIGludAotcmVzZXJ2YXRpb25fb2JqZWN0X2xvY2soc3RydWN0IHJlc2VydmF0aW9uX29i
amVjdCAqb2JqLAotCQkJc3RydWN0IHd3X2FjcXVpcmVfY3R4ICpjdHgpCitzdGF0aWMgaW5saW5l
IGludCBkbWFfcmVzdl9sb2NrKHN0cnVjdCBkbWFfcmVzdiAqb2JqLAorCQkJCXN0cnVjdCB3d19h
Y3F1aXJlX2N0eCAqY3R4KQogewogCXJldHVybiB3d19tdXRleF9sb2NrKCZvYmotPmxvY2ssIGN0
eCk7CiB9CiAKIC8qKgotICogcmVzZXJ2YXRpb25fb2JqZWN0X2xvY2tfaW50ZXJydXB0aWJsZSAt
IGxvY2sgdGhlIHJlc2VydmF0aW9uIG9iamVjdAorICogZG1hX3Jlc3ZfbG9ja19pbnRlcnJ1cHRp
YmxlIC0gbG9jayB0aGUgcmVzZXJ2YXRpb24gb2JqZWN0CiAgKiBAb2JqOiB0aGUgcmVzZXJ2YXRp
b24gb2JqZWN0CiAgKiBAY3R4OiB0aGUgbG9ja2luZyBjb250ZXh0CiAgKgpAQCAtMTk4LDQ4ICsx
OTIsNDUgQEAgcmVzZXJ2YXRpb25fb2JqZWN0X2xvY2soc3RydWN0IHJlc2VydmF0aW9uX29iamVj
dCAqb2JqLAogICogaXMgZGV0ZWN0ZWQuIFNlZSB3d19tdXRleF9sb2NrKCkgYW5kIHd3X2FjcXVp
cmVfaW5pdCgpLiBBIHJlc2VydmF0aW9uCiAgKiBvYmplY3QgbWF5IGJlIGxvY2tlZCBieSBpdHNl
bGYgYnkgcGFzc2luZyBOVUxMIGFzIEBjdHguCiAgKi8KLXN0YXRpYyBpbmxpbmUgaW50Ci1yZXNl
cnZhdGlvbl9vYmplY3RfbG9ja19pbnRlcnJ1cHRpYmxlKHN0cnVjdCByZXNlcnZhdGlvbl9vYmpl
Y3QgKm9iaiwKLQkJCQkgICAgICBzdHJ1Y3Qgd3dfYWNxdWlyZV9jdHggKmN0eCkKK3N0YXRpYyBp
bmxpbmUgaW50IGRtYV9yZXN2X2xvY2tfaW50ZXJydXB0aWJsZShzdHJ1Y3QgZG1hX3Jlc3YgKm9i
aiwKKwkJCQkJICAgICAgc3RydWN0IHd3X2FjcXVpcmVfY3R4ICpjdHgpCiB7CiAJcmV0dXJuIHd3
X211dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmb2JqLT5sb2NrLCBjdHgpOwogfQogCiAvKioKLSAq
IHJlc2VydmF0aW9uX29iamVjdF9sb2NrX3Nsb3cgLSBzbG93cGF0aCBsb2NrIHRoZSByZXNlcnZh
dGlvbiBvYmplY3QKKyAqIGRtYV9yZXN2X2xvY2tfc2xvdyAtIHNsb3dwYXRoIGxvY2sgdGhlIHJl
c2VydmF0aW9uIG9iamVjdAogICogQG9iajogdGhlIHJlc2VydmF0aW9uIG9iamVjdAogICogQGN0
eDogdGhlIGxvY2tpbmcgY29udGV4dAogICoKICAqIEFjcXVpcmVzIHRoZSByZXNlcnZhdGlvbiBv
YmplY3QgYWZ0ZXIgYSBkaWUgY2FzZS4gVGhpcyBmdW5jdGlvbgotICogd2lsbCBzbGVlcCB1bnRp
bCB0aGUgbG9jayBiZWNvbWVzIGF2YWlsYWJsZS4gU2VlIHJlc2VydmF0aW9uX29iamVjdF9sb2Nr
KCkgYXMKKyAqIHdpbGwgc2xlZXAgdW50aWwgdGhlIGxvY2sgYmVjb21lcyBhdmFpbGFibGUuIFNl
ZSBkbWFfcmVzdl9sb2NrKCkgYXMKICAqIHdlbGwuCiAgKi8KLXN0YXRpYyBpbmxpbmUgdm9pZAot
cmVzZXJ2YXRpb25fb2JqZWN0X2xvY2tfc2xvdyhzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpv
YmosCi0JCQkgICAgIHN0cnVjdCB3d19hY3F1aXJlX2N0eCAqY3R4KQorc3RhdGljIGlubGluZSB2
b2lkIGRtYV9yZXN2X2xvY2tfc2xvdyhzdHJ1Y3QgZG1hX3Jlc3YgKm9iaiwKKwkJCQkgICAgICBz
dHJ1Y3Qgd3dfYWNxdWlyZV9jdHggKmN0eCkKIHsKIAl3d19tdXRleF9sb2NrX3Nsb3coJm9iai0+
bG9jaywgY3R4KTsKIH0KIAogLyoqCi0gKiByZXNlcnZhdGlvbl9vYmplY3RfbG9ja19zbG93X2lu
dGVycnVwdGlibGUgLSBzbG93cGF0aCBsb2NrIHRoZSByZXNlcnZhdGlvbgorICogZG1hX3Jlc3Zf
bG9ja19zbG93X2ludGVycnVwdGlibGUgLSBzbG93cGF0aCBsb2NrIHRoZSByZXNlcnZhdGlvbgog
ICogb2JqZWN0LCBpbnRlcnJ1cHRpYmxlCiAgKiBAb2JqOiB0aGUgcmVzZXJ2YXRpb24gb2JqZWN0
CiAgKiBAY3R4OiB0aGUgbG9ja2luZyBjb250ZXh0CiAgKgogICogQWNxdWlyZXMgdGhlIHJlc2Vy
dmF0aW9uIG9iamVjdCBpbnRlcnJ1cHRpYmxlIGFmdGVyIGEgZGllIGNhc2UuIFRoaXMgZnVuY3Rp
b24KICAqIHdpbGwgc2xlZXAgdW50aWwgdGhlIGxvY2sgYmVjb21lcyBhdmFpbGFibGUuIFNlZQot
ICogcmVzZXJ2YXRpb25fb2JqZWN0X2xvY2tfaW50ZXJydXB0aWJsZSgpIGFzIHdlbGwuCisgKiBk
bWFfcmVzdl9sb2NrX2ludGVycnVwdGlibGUoKSBhcyB3ZWxsLgogICovCi1zdGF0aWMgaW5saW5l
IGludAotcmVzZXJ2YXRpb25fb2JqZWN0X2xvY2tfc2xvd19pbnRlcnJ1cHRpYmxlKHN0cnVjdCBy
ZXNlcnZhdGlvbl9vYmplY3QgKm9iaiwKLQkJCQkJICAgc3RydWN0IHd3X2FjcXVpcmVfY3R4ICpj
dHgpCitzdGF0aWMgaW5saW5lIGludCBkbWFfcmVzdl9sb2NrX3Nsb3dfaW50ZXJydXB0aWJsZShz
dHJ1Y3QgZG1hX3Jlc3YgKm9iaiwKKwkJCQkJCSAgIHN0cnVjdCB3d19hY3F1aXJlX2N0eCAqY3R4
KQogewogCXJldHVybiB3d19tdXRleF9sb2NrX3Nsb3dfaW50ZXJydXB0aWJsZSgmb2JqLT5sb2Nr
LCBjdHgpOwogfQogCiAvKioKLSAqIHJlc2VydmF0aW9uX29iamVjdF90cnlsb2NrIC0gdHJ5bG9j
ayB0aGUgcmVzZXJ2YXRpb24gb2JqZWN0CisgKiBkbWFfcmVzdl90cnlsb2NrIC0gdHJ5bG9jayB0
aGUgcmVzZXJ2YXRpb24gb2JqZWN0CiAgKiBAb2JqOiB0aGUgcmVzZXJ2YXRpb24gb2JqZWN0CiAg
KgogICogVHJpZXMgdG8gbG9jayB0aGUgcmVzZXJ2YXRpb24gb2JqZWN0IGZvciBleGNsdXNpdmUg
YWNjZXNzIGFuZCBtb2RpZmljYXRpb24uCkBAIC0yNTIsNTEgKzI0Myw0NiBAQCByZXNlcnZhdGlv
bl9vYmplY3RfbG9ja19zbG93X2ludGVycnVwdGlibGUoc3RydWN0IHJlc2VydmF0aW9uX29iamVj
dCAqb2JqLAogICoKICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgbG9jayB3YXMgYWNxdWlyZWQsIGZh
bHNlIG90aGVyd2lzZS4KICAqLwotc3RhdGljIGlubGluZSBib29sIF9fbXVzdF9jaGVjawotcmVz
ZXJ2YXRpb25fb2JqZWN0X3RyeWxvY2soc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqb2JqKQor
c3RhdGljIGlubGluZSBib29sIF9fbXVzdF9jaGVjayBkbWFfcmVzdl90cnlsb2NrKHN0cnVjdCBk
bWFfcmVzdiAqb2JqKQogewogCXJldHVybiB3d19tdXRleF90cnlsb2NrKCZvYmotPmxvY2spOwog
fQogCiAvKioKLSAqIHJlc2VydmF0aW9uX29iamVjdF9pc19sb2NrZWQgLSBpcyB0aGUgcmVzZXJ2
YXRpb24gb2JqZWN0IGxvY2tlZAorICogZG1hX3Jlc3ZfaXNfbG9ja2VkIC0gaXMgdGhlIHJlc2Vy
dmF0aW9uIG9iamVjdCBsb2NrZWQKICAqIEBvYmo6IHRoZSByZXNlcnZhdGlvbiBvYmplY3QKICAq
CiAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIG11dGV4IGlzIGxvY2tlZCwgZmFsc2UgaWYgdW5sb2Nr
ZWQuCiAgKi8KLXN0YXRpYyBpbmxpbmUgYm9vbAotcmVzZXJ2YXRpb25fb2JqZWN0X2lzX2xvY2tl
ZChzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpvYmopCitzdGF0aWMgaW5saW5lIGJvb2wgZG1h
X3Jlc3ZfaXNfbG9ja2VkKHN0cnVjdCBkbWFfcmVzdiAqb2JqKQogewogCXJldHVybiB3d19tdXRl
eF9pc19sb2NrZWQoJm9iai0+bG9jayk7CiB9CiAKIC8qKgotICogcmVzZXJ2YXRpb25fb2JqZWN0
X2xvY2tpbmdfY3R4IC0gcmV0dXJucyB0aGUgY29udGV4dCB1c2VkIHRvIGxvY2sgdGhlIG9iamVj
dAorICogZG1hX3Jlc3ZfbG9ja2luZ19jdHggLSByZXR1cm5zIHRoZSBjb250ZXh0IHVzZWQgdG8g
bG9jayB0aGUgb2JqZWN0CiAgKiBAb2JqOiB0aGUgcmVzZXJ2YXRpb24gb2JqZWN0CiAgKgogICog
UmV0dXJucyB0aGUgY29udGV4dCB1c2VkIHRvIGxvY2sgYSByZXNlcnZhdGlvbiBvYmplY3Qgb3Ig
TlVMTCBpZiBubyBjb250ZXh0CiAgKiB3YXMgdXNlZCBvciB0aGUgb2JqZWN0IGlzIG5vdCBsb2Nr
ZWQgYXQgYWxsLgogICovCi1zdGF0aWMgaW5saW5lIHN0cnVjdCB3d19hY3F1aXJlX2N0eCAqCi1y
ZXNlcnZhdGlvbl9vYmplY3RfbG9ja2luZ19jdHgoc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAq
b2JqKQorc3RhdGljIGlubGluZSBzdHJ1Y3Qgd3dfYWNxdWlyZV9jdHggKmRtYV9yZXN2X2xvY2tp
bmdfY3R4KHN0cnVjdCBkbWFfcmVzdiAqb2JqKQogewogCXJldHVybiBSRUFEX09OQ0Uob2JqLT5s
b2NrLmN0eCk7CiB9CiAKIC8qKgotICogcmVzZXJ2YXRpb25fb2JqZWN0X3VubG9jayAtIHVubG9j
ayB0aGUgcmVzZXJ2YXRpb24gb2JqZWN0CisgKiBkbWFfcmVzdl91bmxvY2sgLSB1bmxvY2sgdGhl
IHJlc2VydmF0aW9uIG9iamVjdAogICogQG9iajogdGhlIHJlc2VydmF0aW9uIG9iamVjdAogICoK
ICAqIFVubG9ja3MgdGhlIHJlc2VydmF0aW9uIG9iamVjdCBmb2xsb3dpbmcgZXhjbHVzaXZlIGFj
Y2Vzcy4KICAqLwotc3RhdGljIGlubGluZSB2b2lkCi1yZXNlcnZhdGlvbl9vYmplY3RfdW5sb2Nr
KHN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKm9iaikKK3N0YXRpYyBpbmxpbmUgdm9pZCBkbWFf
cmVzdl91bmxvY2soc3RydWN0IGRtYV9yZXN2ICpvYmopCiB7CiAjaWZkZWYgQ09ORklHX0RFQlVH
X01VVEVYRVMKIAkvKiBUZXN0IHNoYXJlZCBmZW5jZSBzbG90IHJlc2VydmF0aW9uICovCiAJaWYg
KHJjdV9hY2Nlc3NfcG9pbnRlcihvYmotPmZlbmNlKSkgewotCQlzdHJ1Y3QgcmVzZXJ2YXRpb25f
b2JqZWN0X2xpc3QgKmZlbmNlID0KLQkJCXJlc2VydmF0aW9uX29iamVjdF9nZXRfbGlzdChvYmop
OworCQlzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCAqZmVuY2UgPSBkbWFfcmVzdl9nZXRfbGlzdChvYmop
OwogCiAJCWZlbmNlLT5zaGFyZWRfbWF4ID0gZmVuY2UtPnNoYXJlZF9jb3VudDsKIAl9CkBAIC0z
MDQsMjkgKzI5MCwyMyBAQCByZXNlcnZhdGlvbl9vYmplY3RfdW5sb2NrKHN0cnVjdCByZXNlcnZh
dGlvbl9vYmplY3QgKm9iaikKIAl3d19tdXRleF91bmxvY2soJm9iai0+bG9jayk7CiB9CiAKLXZv
aWQgcmVzZXJ2YXRpb25fb2JqZWN0X2luaXQoc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqb2Jq
KTsKLXZvaWQgcmVzZXJ2YXRpb25fb2JqZWN0X2Zpbmkoc3RydWN0IHJlc2VydmF0aW9uX29iamVj
dCAqb2JqKTsKLWludCByZXNlcnZhdGlvbl9vYmplY3RfcmVzZXJ2ZV9zaGFyZWQoc3RydWN0IHJl
c2VydmF0aW9uX29iamVjdCAqb2JqLAotCQkJCSAgICAgIHVuc2lnbmVkIGludCBudW1fZmVuY2Vz
KTsKLXZvaWQgcmVzZXJ2YXRpb25fb2JqZWN0X2FkZF9zaGFyZWRfZmVuY2Uoc3RydWN0IHJlc2Vy
dmF0aW9uX29iamVjdCAqb2JqLAotCQkJCQkgc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpOwordm9p
ZCBkbWFfcmVzdl9pbml0KHN0cnVjdCBkbWFfcmVzdiAqb2JqKTsKK3ZvaWQgZG1hX3Jlc3ZfZmlu
aShzdHJ1Y3QgZG1hX3Jlc3YgKm9iaik7CitpbnQgZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQoc3Ry
dWN0IGRtYV9yZXN2ICpvYmosIHVuc2lnbmVkIGludCBudW1fZmVuY2VzKTsKK3ZvaWQgZG1hX3Jl
c3ZfYWRkX3NoYXJlZF9mZW5jZShzdHJ1Y3QgZG1hX3Jlc3YgKm9iaiwgc3RydWN0IGRtYV9mZW5j
ZSAqZmVuY2UpOwogCi12b2lkIHJlc2VydmF0aW9uX29iamVjdF9hZGRfZXhjbF9mZW5jZShzdHJ1
Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpvYmosCi0JCQkJICAgICAgIHN0cnVjdCBkbWFfZmVuY2Ug
KmZlbmNlKTsKK3ZvaWQgZG1hX3Jlc3ZfYWRkX2V4Y2xfZmVuY2Uoc3RydWN0IGRtYV9yZXN2ICpv
YmosIHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlKTsKIAotaW50IHJlc2VydmF0aW9uX29iamVjdF9n
ZXRfZmVuY2VzX3JjdShzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpvYmosCi0JCQkJICAgICAg
c3RydWN0IGRtYV9mZW5jZSAqKnBmZW5jZV9leGNsLAotCQkJCSAgICAgIHVuc2lnbmVkICpwc2hh
cmVkX2NvdW50LAotCQkJCSAgICAgIHN0cnVjdCBkbWFfZmVuY2UgKioqcHNoYXJlZCk7CitpbnQg
ZG1hX3Jlc3ZfZ2V0X2ZlbmNlc19yY3Uoc3RydWN0IGRtYV9yZXN2ICpvYmosCisJCQkgICAgc3Ry
dWN0IGRtYV9mZW5jZSAqKnBmZW5jZV9leGNsLAorCQkJICAgIHVuc2lnbmVkICpwc2hhcmVkX2Nv
dW50LAorCQkJICAgIHN0cnVjdCBkbWFfZmVuY2UgKioqcHNoYXJlZCk7CiAKLWludCByZXNlcnZh
dGlvbl9vYmplY3RfY29weV9mZW5jZXMoc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqZHN0LAot
CQkJCSAgIHN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKnNyYyk7CitpbnQgZG1hX3Jlc3ZfY29w
eV9mZW5jZXMoc3RydWN0IGRtYV9yZXN2ICpkc3QsIHN0cnVjdCBkbWFfcmVzdiAqc3JjKTsKIAot
bG9uZyByZXNlcnZhdGlvbl9vYmplY3Rfd2FpdF90aW1lb3V0X3JjdShzdHJ1Y3QgcmVzZXJ2YXRp
b25fb2JqZWN0ICpvYmosCi0JCQkJCSBib29sIHdhaXRfYWxsLCBib29sIGludHIsCi0JCQkJCSB1
bnNpZ25lZCBsb25nIHRpbWVvdXQpOworbG9uZyBkbWFfcmVzdl93YWl0X3RpbWVvdXRfcmN1KHN0
cnVjdCBkbWFfcmVzdiAqb2JqLCBib29sIHdhaXRfYWxsLCBib29sIGludHIsCisJCQkgICAgICAg
dW5zaWduZWQgbG9uZyB0aW1lb3V0KTsKIAotYm9vbCByZXNlcnZhdGlvbl9vYmplY3RfdGVzdF9z
aWduYWxlZF9yY3Uoc3RydWN0IHJlc2VydmF0aW9uX29iamVjdCAqb2JqLAotCQkJCQkgIGJvb2wg
dGVzdF9hbGwpOworYm9vbCBkbWFfcmVzdl90ZXN0X3NpZ25hbGVkX3JjdShzdHJ1Y3QgZG1hX3Jl
c3YgKm9iaiwgYm9vbCB0ZXN0X2FsbCk7CiAKICNlbmRpZiAvKiBfTElOVVhfUkVTRVJWQVRJT05f
SCAqLwotLSAKMi4xNy4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3Rv
cC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmkt
ZGV2ZWw=
