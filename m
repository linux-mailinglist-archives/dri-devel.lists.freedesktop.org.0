Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 5684CFF90A
	for <lists+dri-devel@lfdr.de>; Sun, 17 Nov 2019 12:45:20 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9587F6E2EA;
	Sun, 17 Nov 2019 11:44:40 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from bhuna.collabora.co.uk (bhuna.collabora.co.uk
 [IPv6:2a00:1098:0:82:1000:25:2eeb:e3e3])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BF5786E283
 for <dri-devel@lists.freedesktop.org>; Sun, 17 Nov 2019 07:11:03 +0000 (UTC)
Received: from [127.0.0.1] (localhost [127.0.0.1]) (Authenticated sender: sre)
 with ESMTPSA id 5BE1D28FCB0
Received: by earth.universe (Postfix, from userid 1000)
 id 09AAD3C0CA2; Sun, 17 Nov 2019 03:41:40 +0100 (CET)
From: Sebastian Reichel <sebastian.reichel@collabora.com>
To: Sebastian Reichel <sre@kernel.org>,
 Laurent Pinchart <laurent.pinchart@ideasonboard.com>,
 Tomi Valkeinen <tomi.valkeinen@ti.com>
Subject: [RFCv1 22/42] drm/omap: panel-dsi-cm: use bulk regulator API
Date: Sun, 17 Nov 2019 03:40:08 +0100
Message-Id: <20191117024028.2233-23-sebastian.reichel@collabora.com>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191117024028.2233-1-sebastian.reichel@collabora.com>
References: <20191117024028.2233-1-sebastian.reichel@collabora.com>
MIME-Version: 1.0
X-Mailman-Approved-At: Sun, 17 Nov 2019 11:44:18 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: kernel@collabora.com, Tony Lindgren <tony@atomide.com>,
 "H. Nikolaus Schaller" <hns@goldelico.com>, Merlijn Wajer <merlijn@wizzup.org>,
 Sebastian Reichel <sebastian.reichel@collabora.com>,
 dri-devel@lists.freedesktop.org, linux-omap@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VXNlIGJ1bGsgcmVndWxhdG9yIEFQSSB0byBzaW1wbGlmeSB0aGUgY29kZS4gVGhpcyBhbHNvIHN3
aXRjaGVzCmZyb20gX29wdGlvbmFsIHZhcmlhbnQgdG8gbm9ybWFsIHZhcmlhbnQsIHdoaWNoIHdp
bGwgcHJvdmlkZSBhCmR1bW15IHJlZ3VsYXRvciAoaS5lLiBpZiBzb21lIGFsd2F5cy1lbmFibGVk
IHJlZ3VsYXRvciBpcyBub3QKZGVzY3JpYmVkIGluIERUKS4KClNpZ25lZC1vZmYtYnk6IFNlYmFz
dGlhbiBSZWljaGVsIDxzZWJhc3RpYW4ucmVpY2hlbEBjb2xsYWJvcmEuY29tPgotLS0KIC4uLi9n
cHUvZHJtL29tYXBkcm0vZGlzcGxheXMvcGFuZWwtZHNpLWNtLmMgICB8IDY1ICsrKysrKy0tLS0t
LS0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCAyMSBpbnNlcnRpb25zKCspLCA0NCBkZWxldGlvbnMo
LSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kaXNwbGF5cy9wYW5lbC1k
c2ktY20uYyBiL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL2Rpc3BsYXlzL3BhbmVsLWRzaS1jbS5j
CmluZGV4IGU0MTIwZDQ4NGY0Yy4uMTcwY2JjNzhmYmVmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vb21hcGRybS9kaXNwbGF5cy9wYW5lbC1kc2ktY20uYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vb21hcGRybS9kaXNwbGF5cy9wYW5lbC1kc2ktY20uYwpAQCAtMzIsNiArMzIsOCBAQAogI2Rl
ZmluZSBEQ1NfR0VUX0lEMgkJMHhkYgogI2RlZmluZSBEQ1NfR0VUX0lEMwkJMHhkYwogCisjZGVm
aW5lIERDU19SRUdVTEFUT1JfU1VQUExZX05VTSAyCisKIHN0cnVjdCBwYW5lbF9kcnZfZGF0YSB7
CiAJc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpOwogCkBAIC01NCw4ICs1Niw3IEBAIHN0cnVj
dCBwYW5lbF9kcnZfZGF0YSB7CiAJc3RydWN0IGdwaW9fZGVzYyAqcmVzZXRfZ3BpbzsKIAlzdHJ1
Y3QgZ3Bpb19kZXNjICpleHRfdGVfZ3BpbzsKIAotCXN0cnVjdCByZWd1bGF0b3IgKnZwbmw7Ci0J
c3RydWN0IHJlZ3VsYXRvciAqdmRkaTsKKwlzdHJ1Y3QgcmVndWxhdG9yX2J1bGtfZGF0YSBzdXBw
bGllc1tEQ1NfUkVHVUxBVE9SX1NVUFBMWV9OVU1dOwogCiAJYm9vbCB1c2VfZHNpX2JhY2tsaWdo
dDsKIApAQCAtNTU3LDI4ICs1NTgsMTYgQEAgc3RhdGljIGludCBkc2ljbV9wb3dlcl9vbihzdHJ1
Y3QgcGFuZWxfZHJ2X2RhdGEgKmRkYXRhKQogCQkubHBfY2xrX21heCA9IDEwMDAwMDAwLAogCX07
CiAKLQlpZiAoZGRhdGEtPnZwbmwpIHsKLQkJciA9IHJlZ3VsYXRvcl9lbmFibGUoZGRhdGEtPnZw
bmwpOwotCQlpZiAocikgewotCQkJZGV2X2VycigmZGRhdGEtPmRzaS0+ZGV2LAotCQkJCSJmYWls
ZWQgdG8gZW5hYmxlIFZQTkw6ICVkXG4iLCByKTsKLQkJCXJldHVybiByOwotCQl9Ci0JfQotCi0J
aWYgKGRkYXRhLT52ZGRpKSB7Ci0JCXIgPSByZWd1bGF0b3JfZW5hYmxlKGRkYXRhLT52ZGRpKTsK
LQkJaWYgKHIpIHsKLQkJCWRldl9lcnIoJmRkYXRhLT5kc2ktPmRldiwKLQkJCQkiZmFpbGVkIHRv
IGVuYWJsZSBWRERJOiAlZFxuIiwgcik7Ci0JCQlnb3RvIGVycl92cG5sOwotCQl9CisJciA9IHJl
Z3VsYXRvcl9idWxrX2VuYWJsZShEQ1NfUkVHVUxBVE9SX1NVUFBMWV9OVU0sIGRkYXRhLT5zdXBw
bGllcyk7CisJaWYgKHIpIHsKKwkJZGV2X2VycigmZGRhdGEtPmRzaS0+ZGV2LCAiZmFpbGVkIHRv
IGVuYWJsZSBzdXBwbGllczogJWRcbiIsIHIpOworCQlyZXR1cm4gcjsKIAl9CiAKIAlyID0gc3Jj
LT5vcHMtPmRzaS5zZXRfY29uZmlnKHNyYywgJmRzaV9jb25maWcpOwogCWlmIChyKSB7CiAJCWRl
dl9lcnIoJmRkYXRhLT5kc2ktPmRldiwgImZhaWxlZCB0byBjb25maWd1cmUgRFNJXG4iKTsKLQkJ
Z290byBlcnJfdmRkaTsKKwkJZ290byBlcnJfcmVndWxhdG9yczsKIAl9CiAKIAlzcmMtPm9wcy0+
ZW5hYmxlKHNyYyk7CkBAIC02MzcsMTIgKzYyNiwxMCBAQCBzdGF0aWMgaW50IGRzaWNtX3Bvd2Vy
X29uKHN0cnVjdCBwYW5lbF9kcnZfZGF0YSAqZGRhdGEpCiAJZHNpY21faHdfcmVzZXQoZGRhdGEp
OwogCiAJc3JjLT5vcHMtPmRzaS5kaXNhYmxlKHNyYywgdHJ1ZSwgZmFsc2UpOwotZXJyX3ZkZGk6
Ci0JaWYgKGRkYXRhLT52ZGRpKQotCQlyZWd1bGF0b3JfZGlzYWJsZShkZGF0YS0+dmRkaSk7Ci1l
cnJfdnBubDoKLQlpZiAoZGRhdGEtPnZwbmwpCi0JCXJlZ3VsYXRvcl9kaXNhYmxlKGRkYXRhLT52
cG5sKTsKK2Vycl9yZWd1bGF0b3JzOgorCXIgPSByZWd1bGF0b3JfYnVsa19kaXNhYmxlKERDU19S
RUdVTEFUT1JfU1VQUExZX05VTSwgZGRhdGEtPnN1cHBsaWVzKTsKKwlpZiAocikKKwkJZGV2X2Vy
cigmZGRhdGEtPmRzaS0+ZGV2LCAiZmFpbGVkIHRvIGRpc2FibGUgc3VwcGxpZXM6ICVkXG4iLCBy
KTsKIAogCXJldHVybiByOwogfQpAQCAtNjY2LDEwICs2NTMsOSBAQCBzdGF0aWMgdm9pZCBkc2lj
bV9wb3dlcl9vZmYoc3RydWN0IHBhbmVsX2Rydl9kYXRhICpkZGF0YSkKIAogCXNyYy0+b3BzLT5k
c2kuZGlzYWJsZShzcmMsIHRydWUsIGZhbHNlKTsKIAotCWlmIChkZGF0YS0+dmRkaSkKLQkJcmVn
dWxhdG9yX2Rpc2FibGUoZGRhdGEtPnZkZGkpOwotCWlmIChkZGF0YS0+dnBubCkKLQkJcmVndWxh
dG9yX2Rpc2FibGUoZGRhdGEtPnZwbmwpOworCXIgPSByZWd1bGF0b3JfYnVsa19kaXNhYmxlKERD
U19SRUdVTEFUT1JfU1VQUExZX05VTSwgZGRhdGEtPnN1cHBsaWVzKTsKKwlpZiAocikKKwkJZGV2
X2VycigmZGRhdGEtPmRzaS0+ZGV2LCAiZmFpbGVkIHRvIGRpc2FibGUgc3VwcGxpZXM6ICVkXG4i
LCByKTsKIAogCWRkYXRhLT5lbmFibGVkID0gMDsKIH0KQEAgLTk3MywyMSArOTU5LDEyIEBAIHN0
YXRpYyBpbnQgZHNpY21fcHJvYmVfb2Yoc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpKQogCWRk
YXRhLT5oZWlnaHRfbW0gPSAwOwogCW9mX3Byb3BlcnR5X3JlYWRfdTMyKG5vZGUsICJoZWlnaHQt
bW0iLCAmZGRhdGEtPmhlaWdodF9tbSk7CiAKLQlkZGF0YS0+dnBubCA9IGRldm1fcmVndWxhdG9y
X2dldF9vcHRpb25hbCgmZHNpLT5kZXYsICJ2cG5sIik7Ci0JaWYgKElTX0VSUihkZGF0YS0+dnBu
bCkpIHsKLQkJZXJyID0gUFRSX0VSUihkZGF0YS0+dnBubCk7Ci0JCWlmIChlcnIgPT0gLUVQUk9C
RV9ERUZFUikKLQkJCXJldHVybiBlcnI7Ci0JCWRkYXRhLT52cG5sID0gTlVMTDsKLQl9Ci0KLQlk
ZGF0YS0+dmRkaSA9IGRldm1fcmVndWxhdG9yX2dldF9vcHRpb25hbCgmZHNpLT5kZXYsICJ2ZGRp
Iik7Ci0JaWYgKElTX0VSUihkZGF0YS0+dmRkaSkpIHsKLQkJZXJyID0gUFRSX0VSUihkZGF0YS0+
dmRkaSk7Ci0JCWlmIChlcnIgPT0gLUVQUk9CRV9ERUZFUikKLQkJCXJldHVybiBlcnI7Ci0JCWRk
YXRhLT52ZGRpID0gTlVMTDsKLQl9CisJZGRhdGEtPnN1cHBsaWVzWzBdLnN1cHBseSA9ICJ2cG5s
IjsKKwlkZGF0YS0+c3VwcGxpZXNbMV0uc3VwcGx5ID0gInZkZGkiOworCWVyciA9IGRldm1fcmVn
dWxhdG9yX2J1bGtfZ2V0KCZkc2ktPmRldiwgRENTX1JFR1VMQVRPUl9TVVBQTFlfTlVNLAorCQkJ
CSAgICAgIGRkYXRhLT5zdXBwbGllcyk7CisJaWYgKGVycikKKwkJcmV0dXJuIGVycjsKIAogCWJh
Y2tsaWdodCA9IG9mX3BhcnNlX3BoYW5kbGUobm9kZSwgImJhY2tsaWdodCIsIDApOwogCWlmIChi
YWNrbGlnaHQpIHsKLS0gCjIuMjQuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGlu
Zm8vZHJpLWRldmVs
