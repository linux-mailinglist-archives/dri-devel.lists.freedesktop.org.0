Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 5C549105D3
	for <lists+dri-devel@lfdr.de>; Wed,  1 May 2019 09:19:32 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B581D893B8;
	Wed,  1 May 2019 07:19:13 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from bhuna.collabora.co.uk (bhuna.collabora.co.uk
 [IPv6:2a00:1098:0:82:1000:25:2eeb:e3e3])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 42B7C89177
 for <dri-devel@lists.freedesktop.org>; Tue, 30 Apr 2019 18:05:47 +0000 (UTC)
Received: from [127.0.0.1] (localhost [127.0.0.1])
 (Authenticated sender: gportay) with ESMTPSA id A31AB28336F
From: =?UTF-8?q?Ga=C3=ABl=20PORTAY?= <gael.portay@collabora.com>
To: Rob Herring <robh+dt@kernel.org>, Mark Rutland <mark.rutland@arm.com>,
 Heiko Stuebner <heiko@sntech.de>,
 Michael Turquette <mturquette@baylibre.com>,
 Stephen Boyd <sboyd@kernel.org>, MyungJoo Ham <myungjoo.ham@samsung.com>,
 Kyungmin Park <kyungmin.park@samsung.com>,
 Chanwoo Choi <cw00.choi@samsung.com>, Sandy Huang <hjc@rock-chips.com>,
 David Airlie <airlied@linux.ie>, Daniel Vetter <daniel@ffwll.ch>,
 =?UTF-8?q?Ga=C3=ABl=20PORTAY?= <gael.portay@collabora.com>,
 devicetree@vger.kernel.org, linux-arm-kernel@lists.infradead.org,
 linux-rockchip@lists.infradead.org, linux-kernel@vger.kernel.org,
 linux-clk@vger.kernel.org, linux-pm@vger.kernel.org,
 dri-devel@lists.freedesktop.org
Subject: [RFC 3/4] clk: rockchip: merge clk-ddr in dmc devfreq driver
Date: Tue, 30 Apr 2019 14:05:23 -0400
Message-Id: <20190430180524.22710-4-gael.portay@collabora.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190430180524.22710-1-gael.portay@collabora.com>
References: <20190430180524.22710-1-gael.portay@collabora.com>
MIME-Version: 1.0
X-Mailman-Approved-At: Wed, 01 May 2019 07:18:43 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Lin Huang <hl@rock-chips.com>, Derek Basehore <dbasehore@chromium.org>,
 Douglas Anderson <dianders@chromium.org>, Matthias Kaehlcke <mka@chromium.org>,
 Boris Brezillon <boris.brezillon@collabora.com>,
 Enric Balletbo i Serra <enric.balletbo@collabora.com>, kernel@collabora.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIFJvY2tjaGlwIERNQyBkZXZmcmVxIGRyaXZlciBpcyB0aGUgb25seSB1c2VyIG9mIHRoZSBS
b2NrY2hpcCBERFIKY2xvY2suCgpCb3RoIGRyaXZlcnMgcGVyZm9ybSBTTUMgY2FsbHMgdG8gdGhl
IFRydXN0ZWQtRmlybXdhcmUgQSB0byBydW4gU2lQCnNlcnZpY2VzIHJlbGF0ZWQgdG8gdGhlIERE
UiBtZW1vcnkuCgpUaGlzIGNvbW1pdCBjZW50cmFsaXplcyB0aGUgU2lQIHNlcnZpY2VzIGluIHRo
ZSBETUMgZGV2ZnJlcSBkcml2ZXIgYW5kCnJlbW92ZXMgdGhlIEREUiBjbG9jayB3aGljaCBiZWNv
bWVzIHVzZWxlc3MuCgpTaWduZWQtb2ZmLWJ5OiBHYcOrbCBQT1JUQVkgPGdhZWwucG9ydGF5QGNv
bGxhYm9yYS5jb20+Ci0tLQogZHJpdmVycy9jbGsvcm9ja2NoaXAvTWFrZWZpbGUgICAgIHwgICAx
IC0KIGRyaXZlcnMvY2xrL3JvY2tjaGlwL2Nsay1kZHIuYyAgICB8IDE0NyAtLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvY2xrL3JvY2tjaGlwL2Nsay1yazMzOTkuYyB8ICAg
MiAtCiBkcml2ZXJzL2Nsay9yb2NrY2hpcC9jbGsuYyAgICAgICAgfCAgIDkgLS0KIGRyaXZlcnMv
Y2xrL3JvY2tjaGlwL2Nsay5oICAgICAgICB8ICAzMyAtLS0tLS0tCiBkcml2ZXJzL2RldmZyZXEv
cmszMzk5X2RtYy5jICAgICAgfCAgNDIgKysrKysrLS0tCiA2IGZpbGVzIGNoYW5nZWQsIDI4IGlu
c2VydGlvbnMoKyksIDIwNiBkZWxldGlvbnMoLSkKIGRlbGV0ZSBtb2RlIDEwMDY0NCBkcml2ZXJz
L2Nsay9yb2NrY2hpcC9jbGstZGRyLmMKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2Nsay9yb2NrY2hp
cC9NYWtlZmlsZSBiL2RyaXZlcnMvY2xrL3JvY2tjaGlwL01ha2VmaWxlCmluZGV4IGZmMzVhYjQ2
M2E2Zi4uMjUwMTQyMTZjNmQ3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2Nsay9yb2NrY2hpcC9NYWtl
ZmlsZQorKysgYi9kcml2ZXJzL2Nsay9yb2NrY2hpcC9NYWtlZmlsZQpAQCAtMTAsNyArMTAsNiBA
QCBvYmoteQkrPSBjbGstaGFsZi1kaXZpZGVyLm8KIG9iai15CSs9IGNsay1pbnZlcnRlci5vCiBv
YmoteQkrPSBjbGstbW1jLXBoYXNlLm8KIG9iai15CSs9IGNsay1tdXhncmYubwotb2JqLXkJKz0g
Y2xrLWRkci5vCiBvYmotJChDT05GSUdfUkVTRVRfQ09OVFJPTExFUikJKz0gc29mdHJzdC5vCiAK
IG9iai15CSs9IGNsay1weDMwLm8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvY2xrL3JvY2tjaGlwL2Ns
ay1kZHIuYyBiL2RyaXZlcnMvY2xrL3JvY2tjaGlwL2Nsay1kZHIuYwpkZWxldGVkIGZpbGUgbW9k
ZSAxMDA2NDQKaW5kZXggZWJjZTUyNjAwNjhiLi4wMDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVycy9j
bGsvcm9ja2NoaXAvY2xrLWRkci5jCisrKyAvZGV2L251bGwKQEAgLTEsMTQ3ICswLDAgQEAKLS8q
Ci0gKiBDb3B5cmlnaHQgKGMpIDIwMTYgUm9ja2NoaXAgRWxlY3Ryb25pY3MgQ28uIEx0ZC4KLSAq
IEF1dGhvcjogTGluIEh1YW5nIDxobEByb2NrLWNoaXBzLmNvbT4KLSAqCi0gKiBUaGlzIHByb2dy
YW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlm
eQotICogaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5z
ZSBhcyBwdWJsaXNoZWQgYnkKLSAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhl
ciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCi0gKiAoYXQgeW91ciBvcHRpb24pIGFueSBs
YXRlciB2ZXJzaW9uLgotICoKLSAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUg
aG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAotICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZ
OyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKLSAqIE1FUkNIQU5UQUJJTElU
WSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKLSAqIEdOVSBH
ZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCi0gKi8KLQotI2luY2x1ZGUg
PGxpbnV4L2FybS1zbWNjYy5oPgotI2luY2x1ZGUgPGxpbnV4L2Nsay5oPgotI2luY2x1ZGUgPGxp
bnV4L2Nsay1wcm92aWRlci5oPgotI2luY2x1ZGUgPGxpbnV4L2lvLmg+Ci0jaW5jbHVkZSA8bGlu
dXgvc2xhYi5oPgotI2luY2x1ZGUgPHNvYy9yb2NrY2hpcC9yb2NrY2hpcF9zaXAuaD4KLSNpbmNs
dWRlICJjbGsuaCIKLQotc3RydWN0IHJvY2tjaGlwX2RkcmNsayB7Ci0Jc3RydWN0IGNsa19odwlo
dzsKLQl2b2lkIF9faW9tZW0JKnJlZ19iYXNlOwotCWludAkJbXV4X29mZnNldDsKLQlpbnQJCW11
eF9zaGlmdDsKLQlpbnQJCW11eF93aWR0aDsKLQlpbnQJCWRpdl9zaGlmdDsKLQlpbnQJCWRpdl93
aWR0aDsKLQlpbnQJCWRkcl9mbGFnOwotCXNwaW5sb2NrX3QJKmxvY2s7Ci19OwotCi0jZGVmaW5l
IHRvX3JvY2tjaGlwX2RkcmNsa19odyhodykgY29udGFpbmVyX29mKGh3LCBzdHJ1Y3Qgcm9ja2No
aXBfZGRyY2xrLCBodykKLQotc3RhdGljIGludCByb2NrY2hpcF9kZHJjbGtfc2lwX3NldF9yYXRl
KHN0cnVjdCBjbGtfaHcgKmh3LCB1bnNpZ25lZCBsb25nIGRyYXRlLAotCQkJCQl1bnNpZ25lZCBs
b25nIHByYXRlKQotewotCXN0cnVjdCByb2NrY2hpcF9kZHJjbGsgKmRkcmNsayA9IHRvX3JvY2tj
aGlwX2RkcmNsa19odyhodyk7Ci0JdW5zaWduZWQgbG9uZyBmbGFnczsKLQlzdHJ1Y3QgYXJtX3Nt
Y2NjX3JlcyByZXM7Ci0KLQlzcGluX2xvY2tfaXJxc2F2ZShkZHJjbGstPmxvY2ssIGZsYWdzKTsK
LQlhcm1fc21jY2Nfc21jKFJPQ0tDSElQX1NJUF9EUkFNX0ZSRVEsIGRyYXRlLCAwLAotCQkgICAg
ICBST0NLQ0hJUF9TSVBfQ09ORklHX0RSQU1fU0VUX1JBVEUsCi0JCSAgICAgIDAsIDAsIDAsIDAs
ICZyZXMpOwotCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoZGRyY2xrLT5sb2NrLCBmbGFncyk7Ci0K
LQlyZXR1cm4gcmVzLmEwOwotfQotCi1zdGF0aWMgdW5zaWduZWQgbG9uZwotcm9ja2NoaXBfZGRy
Y2xrX3NpcF9yZWNhbGNfcmF0ZShzdHJ1Y3QgY2xrX2h3ICpodywKLQkJCQl1bnNpZ25lZCBsb25n
IHBhcmVudF9yYXRlKQotewotCXN0cnVjdCBhcm1fc21jY2NfcmVzIHJlczsKLQotCWFybV9zbWNj
Y19zbWMoUk9DS0NISVBfU0lQX0RSQU1fRlJFUSwgMCwgMCwKLQkJICAgICAgUk9DS0NISVBfU0lQ
X0NPTkZJR19EUkFNX0dFVF9SQVRFLAotCQkgICAgICAwLCAwLCAwLCAwLCAmcmVzKTsKLQotCXJl
dHVybiByZXMuYTA7Ci19Ci0KLXN0YXRpYyBsb25nIHJvY2tjaGlwX2RkcmNsa19zaXBfcm91bmRf
cmF0ZShzdHJ1Y3QgY2xrX2h3ICpodywKLQkJCQkJICAgdW5zaWduZWQgbG9uZyByYXRlLAotCQkJ
CQkgICB1bnNpZ25lZCBsb25nICpwcmF0ZSkKLXsKLQlzdHJ1Y3QgYXJtX3NtY2NjX3JlcyByZXM7
Ci0KLQlhcm1fc21jY2Nfc21jKFJPQ0tDSElQX1NJUF9EUkFNX0ZSRVEsIHJhdGUsIDAsCi0JCSAg
ICAgIFJPQ0tDSElQX1NJUF9DT05GSUdfRFJBTV9ST1VORF9SQVRFLAotCQkgICAgICAwLCAwLCAw
LCAwLCAmcmVzKTsKLQotCXJldHVybiByZXMuYTA7Ci19Ci0KLXN0YXRpYyB1OCByb2NrY2hpcF9k
ZHJjbGtfZ2V0X3BhcmVudChzdHJ1Y3QgY2xrX2h3ICpodykKLXsKLQlzdHJ1Y3Qgcm9ja2NoaXBf
ZGRyY2xrICpkZHJjbGsgPSB0b19yb2NrY2hpcF9kZHJjbGtfaHcoaHcpOwotCXUzMiB2YWw7Ci0K
LQl2YWwgPSBjbGtfcmVhZGwoZGRyY2xrLT5yZWdfYmFzZSArCi0JCQlkZHJjbGstPm11eF9vZmZz
ZXQpID4+IGRkcmNsay0+bXV4X3NoaWZ0OwotCXZhbCAmPSBHRU5NQVNLKGRkcmNsay0+bXV4X3dp
ZHRoIC0gMSwgMCk7Ci0KLQlyZXR1cm4gdmFsOwotfQotCi1zdGF0aWMgY29uc3Qgc3RydWN0IGNs
a19vcHMgcm9ja2NoaXBfZGRyY2xrX3NpcF9vcHMgPSB7Ci0JLnJlY2FsY19yYXRlID0gcm9ja2No
aXBfZGRyY2xrX3NpcF9yZWNhbGNfcmF0ZSwKLQkuc2V0X3JhdGUgPSByb2NrY2hpcF9kZHJjbGtf
c2lwX3NldF9yYXRlLAotCS5yb3VuZF9yYXRlID0gcm9ja2NoaXBfZGRyY2xrX3NpcF9yb3VuZF9y
YXRlLAotCS5nZXRfcGFyZW50ID0gcm9ja2NoaXBfZGRyY2xrX2dldF9wYXJlbnQsCi19OwotCi1z
dHJ1Y3QgY2xrICpyb2NrY2hpcF9jbGtfcmVnaXN0ZXJfZGRyY2xrKGNvbnN0IGNoYXIgKm5hbWUs
IGludCBmbGFncywKLQkJCQkJIGNvbnN0IGNoYXIgKmNvbnN0ICpwYXJlbnRfbmFtZXMsCi0JCQkJ
CSB1OCBudW1fcGFyZW50cywgaW50IG11eF9vZmZzZXQsCi0JCQkJCSBpbnQgbXV4X3NoaWZ0LCBp
bnQgbXV4X3dpZHRoLAotCQkJCQkgaW50IGRpdl9zaGlmdCwgaW50IGRpdl93aWR0aCwKLQkJCQkJ
IGludCBkZHJfZmxhZywgdm9pZCBfX2lvbWVtICpyZWdfYmFzZSwKLQkJCQkJIHNwaW5sb2NrX3Qg
KmxvY2spCi17Ci0Jc3RydWN0IHJvY2tjaGlwX2RkcmNsayAqZGRyY2xrOwotCXN0cnVjdCBjbGtf
aW5pdF9kYXRhIGluaXQ7Ci0Jc3RydWN0IGNsayAqY2xrOwotCi0JZGRyY2xrID0ga3phbGxvYyhz
aXplb2YoKmRkcmNsayksIEdGUF9LRVJORUwpOwotCWlmICghZGRyY2xrKQotCQlyZXR1cm4gRVJS
X1BUUigtRU5PTUVNKTsKLQotCWluaXQubmFtZSA9IG5hbWU7Ci0JaW5pdC5wYXJlbnRfbmFtZXMg
PSBwYXJlbnRfbmFtZXM7Ci0JaW5pdC5udW1fcGFyZW50cyA9IG51bV9wYXJlbnRzOwotCi0JaW5p
dC5mbGFncyA9IGZsYWdzOwotCWluaXQuZmxhZ3MgfD0gQ0xLX1NFVF9SQVRFX05PX1JFUEFSRU5U
OwotCi0Jc3dpdGNoIChkZHJfZmxhZykgewotCWNhc2UgUk9DS0NISVBfRERSQ0xLX1NJUDoKLQkJ
aW5pdC5vcHMgPSAmcm9ja2NoaXBfZGRyY2xrX3NpcF9vcHM7Ci0JCWJyZWFrOwotCWRlZmF1bHQ6
Ci0JCXByX2VycigiJXM6IHVuc3VwcG9ydGVkIGRkcmNsayB0eXBlICVkXG4iLCBfX2Z1bmNfXywg
ZGRyX2ZsYWcpOwotCQlrZnJlZShkZHJjbGspOwotCQlyZXR1cm4gRVJSX1BUUigtRUlOVkFMKTsK
LQl9Ci0KLQlkZHJjbGstPnJlZ19iYXNlID0gcmVnX2Jhc2U7Ci0JZGRyY2xrLT5sb2NrID0gbG9j
azsKLQlkZHJjbGstPmh3LmluaXQgPSAmaW5pdDsKLQlkZHJjbGstPm11eF9vZmZzZXQgPSBtdXhf
b2Zmc2V0OwotCWRkcmNsay0+bXV4X3NoaWZ0ID0gbXV4X3NoaWZ0OwotCWRkcmNsay0+bXV4X3dp
ZHRoID0gbXV4X3dpZHRoOwotCWRkcmNsay0+ZGl2X3NoaWZ0ID0gZGl2X3NoaWZ0OwotCWRkcmNs
ay0+ZGl2X3dpZHRoID0gZGl2X3dpZHRoOwotCWRkcmNsay0+ZGRyX2ZsYWcgPSBkZHJfZmxhZzsK
LQotCWNsayA9IGNsa19yZWdpc3RlcihOVUxMLCAmZGRyY2xrLT5odyk7Ci0JaWYgKElTX0VSUihj
bGspKQotCQlrZnJlZShkZHJjbGspOwotCi0JcmV0dXJuIGNsazsKLX0KZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvY2xrL3JvY2tjaGlwL2Nsay1yazMzOTkuYyBiL2RyaXZlcnMvY2xrL3JvY2tjaGlwL2Ns
ay1yazMzOTkuYwppbmRleCA1YTYyODE0OGYzZjAuLjlmMDE0NjNhZDYyZSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9jbGsvcm9ja2NoaXAvY2xrLXJrMzM5OS5jCisrKyBiL2RyaXZlcnMvY2xrL3JvY2tj
aGlwL2Nsay1yazMzOTkuYwpAQCAtMTM5Niw4ICsxMzk2LDYgQEAgc3RhdGljIHN0cnVjdCByb2Nr
Y2hpcF9jbGtfYnJhbmNoIHJrMzM5OV9jbGtfYnJhbmNoZXNbXSBfX2luaXRkYXRhID0gewogCSAg
ICAgMiwgR0ZMQUdTKSwKIAlHQVRFKDAsICJjbGtfZGRyY19ncGxsX3NyYyIsICJncGxsIiwgMCwg
UkszMzk5X0NMS0dBVEVfQ09OKDMpLAogCSAgICAgMywgR0ZMQUdTKSwKLQlDT01QT1NJVEVfRERS
Q0xLKFNDTEtfRERSQywgInNjbGtfZGRyYyIsIG11eF9kZHJjbGtfcCwgMCwKLQkJICAgICAgIFJL
MzM5OV9DTEtTRUxfQ09OKDYpLCA0LCAyLCAwLCAwLCBST0NLQ0hJUF9ERFJDTEtfU0lQKSwKIH07
CiAKIHN0YXRpYyBzdHJ1Y3Qgcm9ja2NoaXBfY2xrX2JyYW5jaCByazMzOTlfY2xrX3BtdV9icmFu
Y2hlc1tdIF9faW5pdGRhdGEgPSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2Nsay9yb2NrY2hpcC9j
bGsuYyBiL2RyaXZlcnMvY2xrL3JvY2tjaGlwL2Nsay5jCmluZGV4IGMzYWQ5Mjk2NTgyMy4uOTcx
ZmRkYTY5M2Y3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2Nsay9yb2NrY2hpcC9jbGsuYworKysgYi9k
cml2ZXJzL2Nsay9yb2NrY2hpcC9jbGsuYwpAQCAtNTQ0LDE1ICs1NDQsNiBAQCB2b2lkIF9faW5p
dCByb2NrY2hpcF9jbGtfcmVnaXN0ZXJfYnJhbmNoZXMoCiAJCQkJbGlzdC0+Z2F0ZV9vZmZzZXQs
IGxpc3QtPmdhdGVfc2hpZnQsCiAJCQkJbGlzdC0+Z2F0ZV9mbGFncywgZmxhZ3MsICZjdHgtPmxv
Y2spOwogCQkJYnJlYWs7Ci0JCWNhc2UgYnJhbmNoX2RkcmNsazoKLQkJCWNsayA9IHJvY2tjaGlw
X2Nsa19yZWdpc3Rlcl9kZHJjbGsoCi0JCQkJbGlzdC0+bmFtZSwgbGlzdC0+ZmxhZ3MsCi0JCQkJ
bGlzdC0+cGFyZW50X25hbWVzLCBsaXN0LT5udW1fcGFyZW50cywKLQkJCQlsaXN0LT5tdXhkaXZf
b2Zmc2V0LCBsaXN0LT5tdXhfc2hpZnQsCi0JCQkJbGlzdC0+bXV4X3dpZHRoLCBsaXN0LT5kaXZf
c2hpZnQsCi0JCQkJbGlzdC0+ZGl2X3dpZHRoLCBsaXN0LT5kaXZfZmxhZ3MsCi0JCQkJY3R4LT5y
ZWdfYmFzZSwgJmN0eC0+bG9jayk7Ci0JCQlicmVhazsKIAkJfQogCiAJCS8qIG5vbmUgb2YgdGhl
IGNhc2VzIGFib3ZlIG1hdGNoZWQgKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvY2xrL3JvY2tjaGlw
L2Nsay5oIGIvZHJpdmVycy9jbGsvcm9ja2NoaXAvY2xrLmgKaW5kZXggNmI1M2ZmZjRjYzk2Li4w
YTQ4NmZkZmZhNmEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvY2xrL3JvY2tjaGlwL2Nsay5oCisrKyBi
L2RyaXZlcnMvY2xrL3JvY2tjaGlwL2Nsay5oCkBAIC0zNTQsMjAgKzM1NCw2IEBAIHN0cnVjdCBj
bGsgKnJvY2tjaGlwX2Nsa19yZWdpc3Rlcl9tbWMoY29uc3QgY2hhciAqbmFtZSwKIAkJCQljb25z
dCBjaGFyICpjb25zdCAqcGFyZW50X25hbWVzLCB1OCBudW1fcGFyZW50cywKIAkJCQl2b2lkIF9f
aW9tZW0gKnJlZywgaW50IHNoaWZ0KTsKIAotLyoKLSAqIEREUkNMSyBmbGFncywgaW5jbHVkaW5n
IG1ldGhvZCBvZiBzZXR0aW5nIHRoZSByYXRlCi0gKiBST0NLQ0hJUF9ERFJDTEtfU0lQOiB1c2Ug
U0lQIGNhbGwgdG8gYmwzMSB0byBjaGFuZ2UgZGRyY2xrIHJhdGUuCi0gKi8KLSNkZWZpbmUgUk9D
S0NISVBfRERSQ0xLX1NJUAkJQklUKDApCi0KLXN0cnVjdCBjbGsgKnJvY2tjaGlwX2Nsa19yZWdp
c3Rlcl9kZHJjbGsoY29uc3QgY2hhciAqbmFtZSwgaW50IGZsYWdzLAotCQkJCQkgY29uc3QgY2hh
ciAqY29uc3QgKnBhcmVudF9uYW1lcywKLQkJCQkJIHU4IG51bV9wYXJlbnRzLCBpbnQgbXV4X29m
ZnNldCwKLQkJCQkJIGludCBtdXhfc2hpZnQsIGludCBtdXhfd2lkdGgsCi0JCQkJCSBpbnQgZGl2
X3NoaWZ0LCBpbnQgZGl2X3dpZHRoLAotCQkJCQkgaW50IGRkcl9mbGFncywgdm9pZCBfX2lvbWVt
ICpyZWdfYmFzZSwKLQkJCQkJIHNwaW5sb2NrX3QgKmxvY2spOwotCiAjZGVmaW5lIFJPQ0tDSElQ
X0lOVkVSVEVSX0hJV09SRF9NQVNLCUJJVCgwKQogCiBzdHJ1Y3QgY2xrICpyb2NrY2hpcF9jbGtf
cmVnaXN0ZXJfaW52ZXJ0ZXIoY29uc3QgY2hhciAqbmFtZSwKQEAgLTM5Miw3ICszNzgsNiBAQCBl
bnVtIHJvY2tjaGlwX2Nsa19icmFuY2hfdHlwZSB7CiAJYnJhbmNoX21tYywKIAlicmFuY2hfaW52
ZXJ0ZXIsCiAJYnJhbmNoX2ZhY3RvciwKLQlicmFuY2hfZGRyY2xrLAogCWJyYW5jaF9oYWxmX2Rp
dmlkZXIsCiB9OwogCkBAIC01ODMsMjQgKzU2OCw2IEBAIHN0cnVjdCByb2NrY2hpcF9jbGtfYnJh
bmNoIHsKIAkJLmNoaWxkCQk9IGNoLAkJCQlcCiAJfQogCi0jZGVmaW5lIENPTVBPU0lURV9ERFJD
TEsoX2lkLCBjbmFtZSwgcG5hbWVzLCBmLCBtbywgbXMsIG13LAlcCi0JCQkgZHMsIGR3LCBkZikJ
CQkJXAotCXsJCQkJCQkJXAotCQkuaWQJCT0gX2lkLAkJCQlcCi0JCS5icmFuY2hfdHlwZQk9IGJy
YW5jaF9kZHJjbGssCQlcCi0JCS5uYW1lCQk9IGNuYW1lLAkJCVwKLQkJLnBhcmVudF9uYW1lcwk9
IHBuYW1lcywJCQlcCi0JCS5udW1fcGFyZW50cwk9IEFSUkFZX1NJWkUocG5hbWVzKSwJCVwKLQkJ
LmZsYWdzCQk9IGYsCQkJCVwKLQkJLm11eGRpdl9vZmZzZXQgID0gbW8sICAgICAgICAgICAgICAg
ICAgICAgICAgICAgXAotCQkubXV4X3NoaWZ0ICAgICAgPSBtcywgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCi0JCS5tdXhfd2lkdGggICAgICA9IG13LCAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFwKLQkJLmRpdl9zaGlmdCAgICAgID0gZHMsICAgICAgICAgICAgICAgICAgICAgICAgICAg
XAotCQkuZGl2X3dpZHRoICAgICAgPSBkdywgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0J
CS5kaXZfZmxhZ3MJPSBkZiwJCQkJXAotCQkuZ2F0ZV9vZmZzZXQgICAgPSAtMSwgICAgICAgICAg
ICAgICAgICAgICAgICAgICBcCi0JfQotCiAjZGVmaW5lIE1VWChfaWQsIGNuYW1lLCBwbmFtZXMs
IGYsIG8sIHMsIHcsIG1mKQkJCVwKIAl7CQkJCQkJCVwKIAkJLmlkCQk9IF9pZCwJCQkJXApkaWZm
IC0tZ2l0IGEvZHJpdmVycy9kZXZmcmVxL3JrMzM5OV9kbWMuYyBiL2RyaXZlcnMvZGV2ZnJlcS9y
azMzOTlfZG1jLmMKaW5kZXggZGFmMTllMTIxYzk5Li43ZjljOGMwY2Y0NWQgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZGV2ZnJlcS9yazMzOTlfZG1jLmMKKysrIGIvZHJpdmVycy9kZXZmcmVxL3JrMzM5
OV9kbWMuYwpAQCAtMTMsNyArMTMsNiBAQAogICovCiAKICNpbmNsdWRlIDxsaW51eC9hcm0tc21j
Y2MuaD4KLSNpbmNsdWRlIDxsaW51eC9jbGsuaD4KICNpbmNsdWRlIDxsaW51eC9kZWxheS5oPgog
I2luY2x1ZGUgPGxpbnV4L2RldmZyZXEuaD4KICNpbmNsdWRlIDxsaW51eC9kZXZmcmVxLWV2ZW50
Lmg+CkBAIC02Nyw3ICs2Niw2IEBAIHN0cnVjdCByazMzOTlfZG1jZnJlcSB7CiAJc3RydWN0IGRl
dmljZSAqZGV2OwogCXN0cnVjdCBkZXZmcmVxICpkZXZmcmVxOwogCXN0cnVjdCBkZXZmcmVxX3Np
bXBsZV9vbmRlbWFuZF9kYXRhIG9uZGVtYW5kX2RhdGE7Ci0Jc3RydWN0IGNsayAqZG1jX2NsazsK
IAlzdHJ1Y3QgZGV2ZnJlcV9ldmVudF9kZXYgKmVkZXY7CiAJc3RydWN0IG11dGV4IGxvY2s7CiAJ
c3RydWN0IGRyYW1fdGltaW5nIHRpbWluZzsKQEAgLTc5LDYgKzc3LDMxIEBAIHN0cnVjdCByazMz
OTlfZG1jZnJlcSB7CiAJaW50IG9kdF9wZF9hcmcwLCBvZHRfcGRfYXJnMTsKIH07CiAKK3N0YXRp
YyBpbnQgcmszMzk5X2RkcmNsa19zZXRfcmF0ZSh1bnNpZ25lZCBsb25nIHJhdGUpCit7CisJc3Ry
dWN0IGFybV9zbWNjY19yZXMgcmVzOworCisJYXJtX3NtY2NjX3NtYyhST0NLQ0hJUF9TSVBfRFJB
TV9GUkVRLCByYXRlLCAwLAorCQkgICAgICBST0NLQ0hJUF9TSVBfQ09ORklHX0RSQU1fU0VUX1JB
VEUsCisJCSAgICAgIDAsIDAsIDAsIDAsICZyZXMpOworCisJaWYgKHJhdGUgIT0gcmVzLmEwICog
MTAwMDAwMEwpCisJCXJldHVybiAtMTsgLyogVE9ETyB3aGljaCBlcnJubz8qLworCisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyB1bnNpZ25lZCBsb25nIHJrMzM5OV9kZHJjbGtfZ2V0X3JhdGUodm9p
ZCkKK3sKKwlzdHJ1Y3QgYXJtX3NtY2NjX3JlcyByZXM7CisKKwlhcm1fc21jY2Nfc21jKFJPQ0tD
SElQX1NJUF9EUkFNX0ZSRVEsIDAsIDAsCisJCSAgICAgIFJPQ0tDSElQX1NJUF9DT05GSUdfRFJB
TV9HRVRfUkFURSwKKwkJICAgICAgMCwgMCwgMCwgMCwgJnJlcyk7CisKKwlyZXR1cm4gcmVzLmEw
OworfQorCiBzdGF0aWMgaW50IHJrMzM5OV9kbWNmcmVxX3RhcmdldChzdHJ1Y3QgZGV2aWNlICpk
ZXYsIHVuc2lnbmVkIGxvbmcgKmZyZXEsCiAJCQkJIHUzMiBmbGFncykKIHsKQEAgLTEzMCw3ICsx
NTMsNyBAQCBzdGF0aWMgaW50IHJrMzM5OV9kbWNmcmVxX3RhcmdldChzdHJ1Y3QgZGV2aWNlICpk
ZXYsIHVuc2lnbmVkIGxvbmcgKmZyZXEsCiAJCX0KIAl9CiAKLQllcnIgPSBjbGtfc2V0X3JhdGUo
ZG1jZnJlcS0+ZG1jX2NsaywgdGFyZ2V0X3JhdGUpOworCWVyciA9IHJrMzM5OV9kZHJjbGtfc2V0
X3JhdGUodGFyZ2V0X3JhdGUpOwogCWlmIChlcnIpIHsKIAkJZGV2X2VycihkZXYsICJDYW5ub3Qg
c2V0IGZyZXF1ZW5jeSAlbHUgKCVkKVxuIiwgdGFyZ2V0X3JhdGUsCiAJCQllcnIpOwpAQCAtMTQ1
LDcgKzE2OCw3IEBAIHN0YXRpYyBpbnQgcmszMzk5X2RtY2ZyZXFfdGFyZ2V0KHN0cnVjdCBkZXZp
Y2UgKmRldiwgdW5zaWduZWQgbG9uZyAqZnJlcSwKIAkgKiAxLiBEZHIgZnJlcXVlbmN5IHNjYWxp
bmcgZmFpbCwgd2Ugc3RpbGwgZ2V0IHRoZSBvbGQgcmF0ZS4KIAkgKiAyLiBEZHIgZnJlcXVlbmN5
IHNjYWxpbmcgc3VjZXNzZnVsLCB3ZSBnZXQgdGhlIHJhdGUgd2Ugc2V0LgogCSAqLwotCWRtY2Zy
ZXEtPnJhdGUgPSBjbGtfZ2V0X3JhdGUoZG1jZnJlcS0+ZG1jX2Nsayk7CisJZG1jZnJlcS0+cmF0
ZSA9IHJrMzM5OV9kZHJjbGtfZ2V0X3JhdGUoKTsKIAogCS8qIElmIGdldCB0aGUgaW5jb3JyZWN0
IHJhdGUsIHNldCB2b2x0YWdlIHRvIG9sZCB2YWx1ZS4gKi8KIAlpZiAoZG1jZnJlcS0+cmF0ZSAh
PSB0YXJnZXRfcmF0ZSkgewpAQCAtMzM4LDE1ICszNjEsNiBAQCBzdGF0aWMgaW50IHJrMzM5OV9k
bWNmcmVxX3Byb2JlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpCiAJCXJldHVybiBQVFJf
RVJSKGRhdGEtPnZkZF9jZW50ZXIpOwogCX0KIAotCWRhdGEtPmRtY19jbGsgPSBkZXZtX2Nsa19n
ZXQoZGV2LCAiZG1jX2NsayIpOwotCWlmIChJU19FUlIoZGF0YS0+ZG1jX2NsaykpIHsKLQkJaWYg
KFBUUl9FUlIoZGF0YS0+ZG1jX2NsaykgPT0gLUVQUk9CRV9ERUZFUikKLQkJCXJldHVybiAtRVBS
T0JFX0RFRkVSOwotCi0JCWRldl9lcnIoZGV2LCAiQ2Fubm90IGdldCB0aGUgY2xrIGRtY19jbGtc
biIpOwotCQlyZXR1cm4gUFRSX0VSUihkYXRhLT5kbWNfY2xrKTsKLQl9OwotCiAJZGF0YS0+ZWRl
diA9IGRldmZyZXFfZXZlbnRfZ2V0X2VkZXZfYnlfcGhhbmRsZShkZXYsIDApOwogCWlmIChJU19F
UlIoZGF0YS0+ZWRldikpCiAJCXJldHVybiAtRVBST0JFX0RFRkVSOwpAQCAtNDQxLDcgKzQ1NSw3
IEBAIHN0YXRpYyBpbnQgcmszMzk5X2RtY2ZyZXFfcHJvYmUoc3RydWN0IHBsYXRmb3JtX2Rldmlj
ZSAqcGRldikKIAlvZl9wcm9wZXJ0eV9yZWFkX3UzMihucCwgImRvd25kaWZmZXJlbnRpYWwiLAog
CQkJICAgICAmZGF0YS0+b25kZW1hbmRfZGF0YS5kb3duZGlmZmVyZW50aWFsKTsKIAotCWRhdGEt
PnJhdGUgPSBjbGtfZ2V0X3JhdGUoZGF0YS0+ZG1jX2Nsayk7CisJZGF0YS0+cmF0ZSA9IHJrMzM5
OV9kZHJjbGtfZ2V0X3JhdGUoKTsKIAogCW9wcCA9IGRldmZyZXFfcmVjb21tZW5kZWRfb3BwKGRl
diwgJmRhdGEtPnJhdGUsIDApOwogCWlmIChJU19FUlIob3BwKSkgewotLSAKMi4yMS4wCgpfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFp
bGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5m
cmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
