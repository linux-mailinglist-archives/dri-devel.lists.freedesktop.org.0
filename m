Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 3FF868C1E0
	for <lists+dri-devel@lfdr.de>; Tue, 13 Aug 2019 22:11:31 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CB9726E10C;
	Tue, 13 Aug 2019 20:11:21 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from perceval.ideasonboard.com (perceval.ideasonboard.com
 [IPv6:2001:4b98:dc2:55:216:3eff:fef7:d647])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5457B6E10C
 for <dri-devel@lists.freedesktop.org>; Tue, 13 Aug 2019 20:11:18 +0000 (UTC)
Received: from pendragon.bb.dnainternet.fi
 (dfj612yhrgyx302h3jwwy-3.rev.dnainternet.fi
 [IPv6:2001:14ba:21f5:5b00:ce28:277f:58d7:3ca4])
 by perceval.ideasonboard.com (Postfix) with ESMTPSA id B2EC3FA0;
 Tue, 13 Aug 2019 22:11:12 +0200 (CEST)
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v4 8/9] drm/panel: Add driver for the Toppoly TD028TTEC1 panel
Date: Tue, 13 Aug 2019 23:11:00 +0300
Message-Id: <20190813201101.30980-9-laurent.pinchart@ideasonboard.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190813201101.30980-1-laurent.pinchart@ideasonboard.com>
References: <20190813201101.30980-1-laurent.pinchart@ideasonboard.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=ideasonboard.com; s=mail; t=1565727073;
 bh=WJwZpCJP32yYSwXPSsXdq7bgd8behaYcM9X3KOxjLok=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=FUWVSV+ig5oCfZ216YOeu5u++xJJOMNXEYwYn9Aha3/uR5NLLkcW3tBKReswCMVcR
 QJnzeR9rfXjBSoVVx9yN/FdbJzCJUVX8kyBebWqbD0AkaZ95RzCylwjs+ITGwvVbIP
 NhsJXSvNi/fCr4mJWzju4L6goeqjXvnbCj79rfqA=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thierry Reding <thierry.reding@gmail.com>, Sam Ravnborg <sam@ravnborg.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBwYW5lbCBpcyB1c2VkIG9uIHRoZSBPcGVuTW9rbyBOZW8gRnJlZVJ1bm5lciBhbmQgTmVv
IDE5NzMuCgpUaGUgY29kZSBpcyBiYXNlZCBvbiB0aGUgb21hcGRybS1zcGVjaWZpYyBwYW5lbC10
cG8tdGQwMjh0dGVjMSBkcml2ZXIuCgpTaWduZWQtb2ZmLWJ5OiBMYXVyZW50IFBpbmNoYXJ0IDxs
YXVyZW50LnBpbmNoYXJ0QGlkZWFzb25ib2FyZC5jb20+ClJldmlld2VkLWJ5OiBTYW0gUmF2bmJv
cmcgPHNhbUByYXZuYm9yZy5vcmc+Ci0tLQpDaGFuZ2VzIHNpbmNlIHYzOgoKLSBTcGxpdCBlbmFi
bGUvZGlzYWJsZSBpbiBwcmVwYXJlL2VuYWJsZS9kaXNhYmxlL3VucHJlcGFyZQoKQ2hhbmdlcyBz
aW5jZSB2MjoKCi0gQ2FsbCBkcm1fcGFuZWxfdW5wcmVwYXJlKCkgaW4gLnJlbW92ZSgpIGhhbmRs
ZXIKCkNoYW5nZXMgc2luY2UgdjE6CgotIE1lbnRpb24gYm9hcmRzIHVzaW5nIHRoZSBwYW5lbCBp
biBLY29uZmlnCi0gUmVuYW1lZCB0ZDAyOHR0ZWMxX2RldmljZSB0byB0ZDAyOHR0ZWMxX3BhbmVs
Ci0gQ29tbWVudHMgdXBkYXRlcwotIFJlbW92ZWQgdW5uZWVkZWQgcmV0IGNoZWNrCi0gU3RvcmUg
d2lkdGhfbW0gYW5kIGhlaWdodF9tbSBpbiBkcm1fZGlzcGxheV9tb2RlCi0gVXNlIGRybV9wYW5l
bF9kaXNhYmxlKCkgaW4gLnJlbW92ZSgpIGhhbmRsZXIKLS0tCiBkcml2ZXJzL2dwdS9kcm0vcGFu
ZWwvS2NvbmZpZyAgICAgICAgICAgICAgICB8ICAgOCArCiBkcml2ZXJzL2dwdS9kcm0vcGFuZWwv
TWFrZWZpbGUgICAgICAgICAgICAgICB8ICAgMSArCiBkcml2ZXJzL2dwdS9kcm0vcGFuZWwvcGFu
ZWwtdHBvLXRkMDI4dHRlYzEuYyB8IDM5OSArKysrKysrKysrKysrKysrKysrCiAzIGZpbGVzIGNo
YW5nZWQsIDQwOCBpbnNlcnRpb25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUv
ZHJtL3BhbmVsL3BhbmVsLXRwby10ZDAyOHR0ZWMxLmMKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vcGFuZWwvS2NvbmZpZyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9LY29uZmlnCmluZGV4
IGIwNTY0OWIzMTE4YS4uYzI2ODk0MjBkMmRkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
cGFuZWwvS2NvbmZpZworKysgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvS2NvbmZpZwpAQCAtMzI0
LDYgKzMyNCwxNCBAQCBjb25maWcgRFJNX1BBTkVMX1NPTllfQUNYNTY1QUtNCiAJICBTYXkgWSBo
ZXJlIGlmIHlvdSB3YW50IHRvIGVuYWJsZSBzdXBwb3J0IGZvciB0aGUgU29ueSBBQ1g1NjVBS00K
IAkgIDgwMHg2MDAgMy41IiBwYW5lbCAoZm91bmQgb24gdGhlIE5va2lhIE45MDApLgogCitjb25m
aWcgRFJNX1BBTkVMX1RQT19URDAyOFRURUMxCisJdHJpc3RhdGUgIlRvcHBvbHkgKFRQTykgVEQw
MjhUVEVDMSBwYW5lbCBkcml2ZXIiCisJZGVwZW5kcyBvbiBPRiAmJiBTUEkKKwlkZXBlbmRzIG9u
IEJBQ0tMSUdIVF9DTEFTU19ERVZJQ0UKKwloZWxwCisJICBTYXkgWSBoZXJlIGlmIHlvdSB3YW50
IHRvIGVuYWJsZSBzdXBwb3J0IGZvciBUUE8gVEQwMjhUVEVDMSA0ODB4NjQwCisJICAyLjgiIHBh
bmVsIChmb3VuZCBvbiB0aGUgT3Blbk1va28gTmVvIEZyZWVSdW5uZXIgYW5kIE5lbyAxOTczKS4K
KwogY29uZmlnIERSTV9QQU5FTF9UUE9fVFBHMTEwCiAJdHJpc3RhdGUgIlRQTyBUUEcgODAweDQw
MCBwYW5lbCIKIAlkZXBlbmRzIG9uIE9GICYmIFNQSSAmJiBHUElPTElCCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vcGFuZWwvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvTWFr
ZWZpbGUKaW5kZXggMjhjZjIzMzJmZDA2Li4yN2I3NzY3MzdhZDMgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9wYW5lbC9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvTWFr
ZWZpbGUKQEAgLTM0LDUgKzM0LDYgQEAgb2JqLSQoQ09ORklHX0RSTV9QQU5FTF9TSEFSUF9MUzA0
M1QxTEUwMSkgKz0gcGFuZWwtc2hhcnAtbHMwNDN0MWxlMDEubwogb2JqLSQoQ09ORklHX0RSTV9Q
QU5FTF9TSVRST05JWF9TVDc3MDEpICs9IHBhbmVsLXNpdHJvbml4LXN0NzcwMS5vCiBvYmotJChD
T05GSUdfRFJNX1BBTkVMX1NJVFJPTklYX1NUNzc4OVYpICs9IHBhbmVsLXNpdHJvbml4LXN0Nzc4
OXYubwogb2JqLSQoQ09ORklHX0RSTV9QQU5FTF9TT05ZX0FDWDU2NUFLTSkgKz0gcGFuZWwtc29u
eS1hY3g1NjVha20ubworb2JqLSQoQ09ORklHX0RSTV9QQU5FTF9UUE9fVEQwMjhUVEVDMSkgKz0g
cGFuZWwtdHBvLXRkMDI4dHRlYzEubwogb2JqLSQoQ09ORklHX0RSTV9QQU5FTF9UUE9fVFBHMTEw
KSArPSBwYW5lbC10cG8tdHBnMTEwLm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfVFJVTFlfTlQz
NTU5N19XUVhHQSkgKz0gcGFuZWwtdHJ1bHktbnQzNTU5Ny5vCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vcGFuZWwvcGFuZWwtdHBvLXRkMDI4dHRlYzEuYyBiL2RyaXZlcnMvZ3B1L2RybS9w
YW5lbC9wYW5lbC10cG8tdGQwMjh0dGVjMS5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAw
MDAwMDAwMDAwMC4uYTQwMGM4MzQ4NmI0Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL3BhbmVsL3BhbmVsLXRwby10ZDAyOHR0ZWMxLmMKQEAgLTAsMCArMSwzOTkgQEAKKy8vIFNQ
RFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisvKgorICogVG9wcG9seSBURDAyOFRURUMx
IFBhbmVsIERyaXZlcgorICoKKyAqIENvcHlyaWdodCAoQykgMjAxOSBUZXhhcyBJbnN0cnVtZW50
cyBJbmNvcnBvcmF0ZWQKKyAqCisgKiBCYXNlZCBvbiB0aGUgb21hcGRybS1zcGVjaWZpYyBwYW5l
bC10cG8tdGQwMjh0dGVjMSBkcml2ZXIKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMDggTm9raWEg
Q29ycG9yYXRpb24KKyAqIEF1dGhvcjogVG9taSBWYWxrZWluZW4gPHRvbWkudmFsa2VpbmVuQHRp
LmNvbT4KKyAqCisgKiBOZW8gMTk3MyBjb2RlIChqYnQ2azc0LmMpOgorICogQ29weXJpZ2h0IChD
KSAyMDA2LTIwMDcgT3Blbk1va28sIEluYy4KKyAqIEF1dGhvcjogSGFyYWxkIFdlbHRlIDxsYWZv
cmdlQG9wZW5tb2tvLm9yZz4KKyAqCisgKiBQb3J0ZWQgYW5kIGFkYXB0ZWQgZnJvbSBOZW8gMTk3
MyBVLUJvb3QgYnk6CisgKiBILiBOaWtvbGF1cyBTY2hhbGxlciA8aG5zQGdvbGRlbGljby5jb20+
CisgKi8KKworI2luY2x1ZGUgPGxpbnV4L2JhY2tsaWdodC5oPgorI2luY2x1ZGUgPGxpbnV4L2Rl
bGF5Lmg+CisjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+CisjaW5jbHVkZSA8bGludXgvc3BpL3Nw
aS5oPgorCisjaW5jbHVkZSA8ZHJtL2RybV9jb25uZWN0b3IuaD4KKyNpbmNsdWRlIDxkcm0vZHJt
X21vZGVzLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wYW5lbC5oPgorCisjZGVmaW5lIEpCVF9DT01N
QU5ECQkJMHgwMDAKKyNkZWZpbmUgSkJUX0RBVEEJCQkweDEwMAorCisjZGVmaW5lIEpCVF9SRUdf
U0xFRVBfSU4JCTB4MTAKKyNkZWZpbmUgSkJUX1JFR19TTEVFUF9PVVQJCTB4MTEKKworI2RlZmlu
ZSBKQlRfUkVHX0RJU1BMQVlfT0ZGCQkweDI4CisjZGVmaW5lIEpCVF9SRUdfRElTUExBWV9PTgkJ
MHgyOQorCisjZGVmaW5lIEpCVF9SRUdfUkdCX0ZPUk1BVAkJMHgzYQorI2RlZmluZSBKQlRfUkVH
X1FVQURfUkFURQkJMHgzYgorCisjZGVmaW5lIEpCVF9SRUdfUE9XRVJfT05fT0ZGCQkweGIwCisj
ZGVmaW5lIEpCVF9SRUdfQk9PU1RFUl9PUAkJMHhiMQorI2RlZmluZSBKQlRfUkVHX0JPT1NURVJf
TU9ERQkJMHhiMgorI2RlZmluZSBKQlRfUkVHX0JPT1NURVJfRlJFUQkJMHhiMworI2RlZmluZSBK
QlRfUkVHX09QQU1QX1NZU0NMSwkJMHhiNAorI2RlZmluZSBKQlRfUkVHX1ZTQ19WT0xUQUdFCQkw
eGI1CisjZGVmaW5lIEpCVF9SRUdfVkNPTV9WT0xUQUdFCQkweGI2CisjZGVmaW5lIEpCVF9SRUdf
RVhUX0RJU1BMCQkweGI3CisjZGVmaW5lIEpCVF9SRUdfT1VUUFVUX0NPTlRST0wJCTB4YjgKKyNk
ZWZpbmUgSkJUX1JFR19EQ0NMS19EQ0VWCQkweGI5CisjZGVmaW5lIEpCVF9SRUdfRElTUExBWV9N
T0RFMQkJMHhiYQorI2RlZmluZSBKQlRfUkVHX0RJU1BMQVlfTU9ERTIJCTB4YmIKKyNkZWZpbmUg
SkJUX1JFR19ESVNQTEFZX01PREUJCTB4YmMKKyNkZWZpbmUgSkJUX1JFR19BU1dfU0xFVwkJMHhi
ZAorI2RlZmluZSBKQlRfUkVHX0RVTU1ZX0RJU1BMQVkJCTB4YmUKKyNkZWZpbmUgSkJUX1JFR19E
UklWRV9TWVNURU0JCTB4YmYKKworI2RlZmluZSBKQlRfUkVHX1NMRUVQX09VVF9GUl9BCQkweGMw
CisjZGVmaW5lIEpCVF9SRUdfU0xFRVBfT1VUX0ZSX0IJCTB4YzEKKyNkZWZpbmUgSkJUX1JFR19T
TEVFUF9PVVRfRlJfQwkJMHhjMgorI2RlZmluZSBKQlRfUkVHX1NMRUVQX0lOX0xDQ05UX0QJMHhj
MworI2RlZmluZSBKQlRfUkVHX1NMRUVQX0lOX0xDQ05UX0UJMHhjNAorI2RlZmluZSBKQlRfUkVH
X1NMRUVQX0lOX0xDQ05UX0YJMHhjNQorI2RlZmluZSBKQlRfUkVHX1NMRUVQX0lOX0xDQ05UX0cJ
MHhjNgorCisjZGVmaW5lIEpCVF9SRUdfR0FNTUExX0ZJTkVfMQkJMHhjNworI2RlZmluZSBKQlRf
UkVHX0dBTU1BMV9GSU5FXzIJCTB4YzgKKyNkZWZpbmUgSkJUX1JFR19HQU1NQTFfSU5DTElOQVRJ
T04JMHhjOQorI2RlZmluZSBKQlRfUkVHX0dBTU1BMV9CTFVFX09GRlNFVAkweGNhCisKKyNkZWZp
bmUgSkJUX1JFR19CTEFOS19DT05UUk9MCQkweGNmCisjZGVmaW5lIEpCVF9SRUdfQkxBTktfVEhf
VFYJCTB4ZDAKKyNkZWZpbmUgSkJUX1JFR19DS1ZfT05fT0ZGCQkweGQxCisjZGVmaW5lIEpCVF9S
RUdfQ0tWXzFfMgkJCTB4ZDIKKyNkZWZpbmUgSkJUX1JFR19PRVZfVElNSU5HCQkweGQzCisjZGVm
aW5lIEpCVF9SRUdfQVNXX1RJTUlOR18xCQkweGQ0CisjZGVmaW5lIEpCVF9SRUdfQVNXX1RJTUlO
R18yCQkweGQ1CisKKyNkZWZpbmUgSkJUX1JFR19IQ0xPQ0tfVkdBCQkweGVjCisjZGVmaW5lIEpC
VF9SRUdfSENMT0NLX1FWR0EJCTB4ZWQKKworc3RydWN0IHRkMDI4dHRlYzFfcGFuZWwgeworCXN0
cnVjdCBkcm1fcGFuZWwgcGFuZWw7CisKKwlzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpOworCXN0cnVj
dCBiYWNrbGlnaHRfZGV2aWNlICpiYWNrbGlnaHQ7Cit9OworCisjZGVmaW5lIHRvX3RkMDI4dHRl
YzFfZGV2aWNlKHApIGNvbnRhaW5lcl9vZihwLCBzdHJ1Y3QgdGQwMjh0dGVjMV9wYW5lbCwgcGFu
ZWwpCisKK3N0YXRpYyBpbnQgamJ0X3JldF93cml0ZV8wKHN0cnVjdCB0ZDAyOHR0ZWMxX3BhbmVs
ICpsY2QsIHU4IHJlZywgaW50ICplcnIpCit7CisJc3RydWN0IHNwaV9kZXZpY2UgKnNwaSA9IGxj
ZC0+c3BpOworCXUxNiB0eF9idWYgPSBKQlRfQ09NTUFORCB8IHJlZzsKKwlpbnQgcmV0OworCisJ
aWYgKGVyciAmJiAqZXJyKQorCQlyZXR1cm4gKmVycjsKKworCXJldCA9IHNwaV93cml0ZShzcGks
ICh1OCAqKSZ0eF9idWYsIHNpemVvZih0eF9idWYpKTsKKwlpZiAocmV0IDwgMCkgeworCQlkZXZf
ZXJyKCZzcGktPmRldiwgIiVzOiBTUEkgd3JpdGUgZmFpbGVkOiAlZFxuIiwgX19mdW5jX18sIHJl
dCk7CisJCWlmIChlcnIpCisJCQkqZXJyID0gcmV0OworCX0KKworCXJldHVybiByZXQ7Cit9CisK
K3N0YXRpYyBpbnQgamJ0X3JlZ193cml0ZV8xKHN0cnVjdCB0ZDAyOHR0ZWMxX3BhbmVsICpsY2Qs
CisJCQkgICB1OCByZWcsIHU4IGRhdGEsIGludCAqZXJyKQoreworCXN0cnVjdCBzcGlfZGV2aWNl
ICpzcGkgPSBsY2QtPnNwaTsKKwl1MTYgdHhfYnVmWzJdOworCWludCByZXQ7CisKKwlpZiAoZXJy
ICYmICplcnIpCisJCXJldHVybiAqZXJyOworCisJdHhfYnVmWzBdID0gSkJUX0NPTU1BTkQgfCBy
ZWc7CisJdHhfYnVmWzFdID0gSkJUX0RBVEEgfCBkYXRhOworCisJcmV0ID0gc3BpX3dyaXRlKHNw
aSwgKHU4ICopdHhfYnVmLCBzaXplb2YodHhfYnVmKSk7CisJaWYgKHJldCA8IDApIHsKKwkJZGV2
X2Vycigmc3BpLT5kZXYsICIlczogU1BJIHdyaXRlIGZhaWxlZDogJWRcbiIsIF9fZnVuY19fLCBy
ZXQpOworCQlpZiAoZXJyKQorCQkJKmVyciA9IHJldDsKKwl9CisKKwlyZXR1cm4gcmV0OworfQor
CitzdGF0aWMgaW50IGpidF9yZWdfd3JpdGVfMihzdHJ1Y3QgdGQwMjh0dGVjMV9wYW5lbCAqbGNk
LAorCQkJICAgdTggcmVnLCB1MTYgZGF0YSwgaW50ICplcnIpCit7CisJc3RydWN0IHNwaV9kZXZp
Y2UgKnNwaSA9IGxjZC0+c3BpOworCXUxNiB0eF9idWZbM107CisJaW50IHJldDsKKworCWlmIChl
cnIgJiYgKmVycikKKwkJcmV0dXJuICplcnI7CisKKwl0eF9idWZbMF0gPSBKQlRfQ09NTUFORCB8
IHJlZzsKKwl0eF9idWZbMV0gPSBKQlRfREFUQSB8IChkYXRhID4+IDgpOworCXR4X2J1ZlsyXSA9
IEpCVF9EQVRBIHwgKGRhdGEgJiAweGZmKTsKKworCXJldCA9IHNwaV93cml0ZShzcGksICh1OCAq
KXR4X2J1Ziwgc2l6ZW9mKHR4X2J1ZikpOworCWlmIChyZXQgPCAwKSB7CisJCWRldl9lcnIoJnNw
aS0+ZGV2LCAiJXM6IFNQSSB3cml0ZSBmYWlsZWQ6ICVkXG4iLCBfX2Z1bmNfXywgcmV0KTsKKwkJ
aWYgKGVycikKKwkJCSplcnIgPSByZXQ7CisJfQorCisJcmV0dXJuIHJldDsKK30KKworc3RhdGlj
IGludCB0ZDAyOHR0ZWMxX3ByZXBhcmUoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwpCit7CisJc3Ry
dWN0IHRkMDI4dHRlYzFfcGFuZWwgKmxjZCA9IHRvX3RkMDI4dHRlYzFfZGV2aWNlKHBhbmVsKTsK
Kwl1bnNpZ25lZCBpbnQgaTsKKwlpbnQgcmV0ID0gMDsKKworCS8qIFRocmVlIHRpbWVzIGNvbW1h
bmQgemVybyAqLworCWZvciAoaSA9IDA7IGkgPCAzOyArK2kpIHsKKwkJamJ0X3JldF93cml0ZV8w
KGxjZCwgMHgwMCwgJnJldCk7CisJCXVzbGVlcF9yYW5nZSgxMDAwLCAyMDAwKTsKKwl9CisKKwkv
KiBkZWVwIHN0YW5kYnkgb3V0ICovCisJamJ0X3JlZ193cml0ZV8xKGxjZCwgSkJUX1JFR19QT1dF
Ul9PTl9PRkYsIDB4MTcsICZyZXQpOworCisJLyogUkdCIEkvRiBvbiwgUkFNIHdyaXRlIG9mZiwg
UVZHQSB0aHJvdWdoLCBTSUdDT04gZW5hYmxlICovCisJamJ0X3JlZ193cml0ZV8xKGxjZCwgSkJU
X1JFR19ESVNQTEFZX01PREUsIDB4ODAsICZyZXQpOworCisJLyogUXVhZCBtb2RlIG9mZiAqLwor
CWpidF9yZWdfd3JpdGVfMShsY2QsIEpCVF9SRUdfUVVBRF9SQVRFLCAweDAwLCAmcmV0KTsKKwor
CS8qIEFWREQgb24sIFhWREQgb24gKi8KKwlqYnRfcmVnX3dyaXRlXzEobGNkLCBKQlRfUkVHX1BP
V0VSX09OX09GRiwgMHgxNiwgJnJldCk7CisKKwkvKiBPdXRwdXQgY29udHJvbCAqLworCWpidF9y
ZWdfd3JpdGVfMihsY2QsIEpCVF9SRUdfT1VUUFVUX0NPTlRST0wsIDB4ZmZmOSwgJnJldCk7CisK
KwkvKiBTbGVlcCBtb2RlIG9mZiAqLworCWpidF9yZXRfd3JpdGVfMChsY2QsIEpCVF9SRUdfU0xF
RVBfT1VULCAmcmV0KTsKKworCS8qIGF0IHRoaXMgcG9pbnQgd2UgaGF2ZSBsaWtlIDUwJSBncmV5
ICovCisKKwkvKiBpbml0aWFsaXplIHJlZ2lzdGVyIHNldCAqLworCWpidF9yZWdfd3JpdGVfMShs
Y2QsIEpCVF9SRUdfRElTUExBWV9NT0RFMSwgMHgwMSwgJnJldCk7CisJamJ0X3JlZ193cml0ZV8x
KGxjZCwgSkJUX1JFR19ESVNQTEFZX01PREUyLCAweDAwLCAmcmV0KTsKKwlqYnRfcmVnX3dyaXRl
XzEobGNkLCBKQlRfUkVHX1JHQl9GT1JNQVQsIDB4NjAsICZyZXQpOworCWpidF9yZWdfd3JpdGVf
MShsY2QsIEpCVF9SRUdfRFJJVkVfU1lTVEVNLCAweDEwLCAmcmV0KTsKKwlqYnRfcmVnX3dyaXRl
XzEobGNkLCBKQlRfUkVHX0JPT1NURVJfT1AsIDB4NTYsICZyZXQpOworCWpidF9yZWdfd3JpdGVf
MShsY2QsIEpCVF9SRUdfQk9PU1RFUl9NT0RFLCAweDMzLCAmcmV0KTsKKwlqYnRfcmVnX3dyaXRl
XzEobGNkLCBKQlRfUkVHX0JPT1NURVJfRlJFUSwgMHgxMSwgJnJldCk7CisJamJ0X3JlZ193cml0
ZV8xKGxjZCwgSkJUX1JFR19CT09TVEVSX0ZSRVEsIDB4MTEsICZyZXQpOworCWpidF9yZWdfd3Jp
dGVfMShsY2QsIEpCVF9SRUdfT1BBTVBfU1lTQ0xLLCAweDAyLCAmcmV0KTsKKwlqYnRfcmVnX3dy
aXRlXzEobGNkLCBKQlRfUkVHX1ZTQ19WT0xUQUdFLCAweDJiLCAmcmV0KTsKKwlqYnRfcmVnX3dy
aXRlXzEobGNkLCBKQlRfUkVHX1ZDT01fVk9MVEFHRSwgMHg0MCwgJnJldCk7CisJamJ0X3JlZ193
cml0ZV8xKGxjZCwgSkJUX1JFR19FWFRfRElTUEwsIDB4MDMsICZyZXQpOworCWpidF9yZWdfd3Jp
dGVfMShsY2QsIEpCVF9SRUdfRENDTEtfRENFViwgMHgwNCwgJnJldCk7CisJLyoKKwkgKiBkZWZh
dWx0IG9mIDB4MDIgaW4gSkJUX1JFR19BU1dfU0xFVyByZXNwb25zaWJsZSBmb3IgNzJIeiByZXF1
aXJlbWVudAorCSAqIHRvIGF2b2lkIHJlZCAvIGJsdWUgZmxpY2tlcgorCSAqLworCWpidF9yZWdf
d3JpdGVfMShsY2QsIEpCVF9SRUdfQVNXX1NMRVcsIDB4MDQsICZyZXQpOworCWpidF9yZWdfd3Jp
dGVfMShsY2QsIEpCVF9SRUdfRFVNTVlfRElTUExBWSwgMHgwMCwgJnJldCk7CisKKwlqYnRfcmVn
X3dyaXRlXzEobGNkLCBKQlRfUkVHX1NMRUVQX09VVF9GUl9BLCAweDExLCAmcmV0KTsKKwlqYnRf
cmVnX3dyaXRlXzEobGNkLCBKQlRfUkVHX1NMRUVQX09VVF9GUl9CLCAweDExLCAmcmV0KTsKKwlq
YnRfcmVnX3dyaXRlXzEobGNkLCBKQlRfUkVHX1NMRUVQX09VVF9GUl9DLCAweDExLCAmcmV0KTsK
KwlqYnRfcmVnX3dyaXRlXzIobGNkLCBKQlRfUkVHX1NMRUVQX0lOX0xDQ05UX0QsIDB4MjA0MCwg
JnJldCk7CisJamJ0X3JlZ193cml0ZV8yKGxjZCwgSkJUX1JFR19TTEVFUF9JTl9MQ0NOVF9FLCAw
eDYwYzAsICZyZXQpOworCWpidF9yZWdfd3JpdGVfMihsY2QsIEpCVF9SRUdfU0xFRVBfSU5fTEND
TlRfRiwgMHgxMDIwLCAmcmV0KTsKKwlqYnRfcmVnX3dyaXRlXzIobGNkLCBKQlRfUkVHX1NMRUVQ
X0lOX0xDQ05UX0csIDB4NjBjMCwgJnJldCk7CisKKwlqYnRfcmVnX3dyaXRlXzIobGNkLCBKQlRf
UkVHX0dBTU1BMV9GSU5FXzEsIDB4NTUzMywgJnJldCk7CisJamJ0X3JlZ193cml0ZV8xKGxjZCwg
SkJUX1JFR19HQU1NQTFfRklORV8yLCAweDAwLCAmcmV0KTsKKwlqYnRfcmVnX3dyaXRlXzEobGNk
LCBKQlRfUkVHX0dBTU1BMV9JTkNMSU5BVElPTiwgMHgwMCwgJnJldCk7CisJamJ0X3JlZ193cml0
ZV8xKGxjZCwgSkJUX1JFR19HQU1NQTFfQkxVRV9PRkZTRVQsIDB4MDAsICZyZXQpOworCisJamJ0
X3JlZ193cml0ZV8yKGxjZCwgSkJUX1JFR19IQ0xPQ0tfVkdBLCAweDFmMCwgJnJldCk7CisJamJ0
X3JlZ193cml0ZV8xKGxjZCwgSkJUX1JFR19CTEFOS19DT05UUk9MLCAweDAyLCAmcmV0KTsKKwlq
YnRfcmVnX3dyaXRlXzIobGNkLCBKQlRfUkVHX0JMQU5LX1RIX1RWLCAweDA4MDQsICZyZXQpOwor
CisJamJ0X3JlZ193cml0ZV8xKGxjZCwgSkJUX1JFR19DS1ZfT05fT0ZGLCAweDAxLCAmcmV0KTsK
KwlqYnRfcmVnX3dyaXRlXzIobGNkLCBKQlRfUkVHX0NLVl8xXzIsIDB4MDAwMCwgJnJldCk7CisK
KwlqYnRfcmVnX3dyaXRlXzIobGNkLCBKQlRfUkVHX09FVl9USU1JTkcsIDB4MGQwZSwgJnJldCk7
CisJamJ0X3JlZ193cml0ZV8yKGxjZCwgSkJUX1JFR19BU1dfVElNSU5HXzEsIDB4MTFhNCwgJnJl
dCk7CisJamJ0X3JlZ193cml0ZV8xKGxjZCwgSkJUX1JFR19BU1dfVElNSU5HXzIsIDB4MGUsICZy
ZXQpOworCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCB0ZDAyOHR0ZWMxX2VuYWJsZShz
dHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKK3sKKwlzdHJ1Y3QgdGQwMjh0dGVjMV9wYW5lbCAqbGNk
ID0gdG9fdGQwMjh0dGVjMV9kZXZpY2UocGFuZWwpOworCWludCByZXQ7CisKKwlyZXQgPSBqYnRf
cmV0X3dyaXRlXzAobGNkLCBKQlRfUkVHX0RJU1BMQVlfT04sIE5VTEwpOworCWlmIChyZXQpCisJ
CXJldHVybiByZXQ7CisKKwliYWNrbGlnaHRfZW5hYmxlKGxjZC0+YmFja2xpZ2h0KTsKKworCXJl
dHVybiAwOworfQorCitzdGF0aWMgaW50IHRkMDI4dHRlYzFfZGlzYWJsZShzdHJ1Y3QgZHJtX3Bh
bmVsICpwYW5lbCkKK3sKKwlzdHJ1Y3QgdGQwMjh0dGVjMV9wYW5lbCAqbGNkID0gdG9fdGQwMjh0
dGVjMV9kZXZpY2UocGFuZWwpOworCisJYmFja2xpZ2h0X2Rpc2FibGUobGNkLT5iYWNrbGlnaHQp
OworCisJamJ0X3JldF93cml0ZV8wKGxjZCwgSkJUX1JFR19ESVNQTEFZX09GRiwgTlVMTCk7CisK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCB0ZDAyOHR0ZWMxX3VucHJlcGFyZShzdHJ1Y3Qg
ZHJtX3BhbmVsICpwYW5lbCkKK3sKKwlzdHJ1Y3QgdGQwMjh0dGVjMV9wYW5lbCAqbGNkID0gdG9f
dGQwMjh0dGVjMV9kZXZpY2UocGFuZWwpOworCisJamJ0X3JlZ193cml0ZV8yKGxjZCwgSkJUX1JF
R19PVVRQVVRfQ09OVFJPTCwgMHg4MDAyLCBOVUxMKTsKKwlqYnRfcmV0X3dyaXRlXzAobGNkLCBK
QlRfUkVHX1NMRUVQX0lOLCBOVUxMKTsKKwlqYnRfcmVnX3dyaXRlXzEobGNkLCBKQlRfUkVHX1BP
V0VSX09OX09GRiwgMHgwMCwgTlVMTCk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0
IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlIHRkMDI4dHRlYzFfbW9kZSA9IHsKKwkuY2xvY2sgPSAy
MjE1MywKKwkuaGRpc3BsYXkgPSA0ODAsCisJLmhzeW5jX3N0YXJ0ID0gNDgwICsgMjQsCisJLmhz
eW5jX2VuZCA9IDQ4MCArIDI0ICsgOCwKKwkuaHRvdGFsID0gNDgwICsgMjQgKyA4ICsgOCwKKwku
dmRpc3BsYXkgPSA2NDAsCisJLnZzeW5jX3N0YXJ0ID0gNjQwICsgNCwKKwkudnN5bmNfZW5kID0g
NjQwICsgNCArIDIsCisJLnZ0b3RhbCA9IDY0MCArIDQgKyAyICsgMiwKKwkudnJlZnJlc2ggPSA2
NiwKKwkudHlwZSA9IERSTV9NT0RFX1RZUEVfRFJJVkVSIHwgRFJNX01PREVfVFlQRV9QUkVGRVJS
RUQsCisJLmZsYWdzID0gRFJNX01PREVfRkxBR19OSFNZTkMgfCBEUk1fTU9ERV9GTEFHX05WU1lO
QywKKwkud2lkdGhfbW0gPSA0MywKKwkuaGVpZ2h0X21tID0gNTgsCit9OworCitzdGF0aWMgaW50
IHRkMDI4dHRlYzFfZ2V0X21vZGVzKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQoreworCXN0cnVj
dCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IgPSBwYW5lbC0+Y29ubmVjdG9yOworCXN0cnVjdCBk
cm1fZGlzcGxheV9tb2RlICptb2RlOworCisJbW9kZSA9IGRybV9tb2RlX2R1cGxpY2F0ZShwYW5l
bC0+ZHJtLCAmdGQwMjh0dGVjMV9tb2RlKTsKKwlpZiAoIW1vZGUpCisJCXJldHVybiAtRU5PTUVN
OworCisJZHJtX21vZGVfc2V0X25hbWUobW9kZSk7CisJZHJtX21vZGVfcHJvYmVkX2FkZChjb25u
ZWN0b3IsIG1vZGUpOworCisJY29ubmVjdG9yLT5kaXNwbGF5X2luZm8ud2lkdGhfbW0gPSB0ZDAy
OHR0ZWMxX21vZGUud2lkdGhfbW07CisJY29ubmVjdG9yLT5kaXNwbGF5X2luZm8uaGVpZ2h0X21t
ID0gdGQwMjh0dGVjMV9tb2RlLmhlaWdodF9tbTsKKwkvKgorCSAqIEZJWE1FOiBBY2NvcmRpbmcg
dG8gdGhlIGRhdGFzaGVldCBzeW5jIHNpZ25hbHMgYXJlIHNhbXBsZWQgb24gdGhlCisJICogcmlz
aW5nIGVkZ2Ugb2YgdGhlIGNsb2NrLCBidXQgdGhlIGNvZGUgcnVubmluZyBvbiB0aGUgT3Blbk1v
a28gTmVvCisJICogRnJlZVJ1bm5lciBhbmQgTmVvIDE5NzMgaW5kaWNhdGVzIHNhbXBsaW5nIG9u
IHRoZSBmYWxsaW5nIGVkZ2UuIFRoaXMKKwkgKiBzaG91bGQgYmUgdGVzdGVkIG9uIGEgcmVhbCBk
ZXZpY2UuCisJICovCisJY29ubmVjdG9yLT5kaXNwbGF5X2luZm8uYnVzX2ZsYWdzID0gRFJNX0JV
U19GTEFHX0RFX0hJR0gKKwkJCQkJICB8IERSTV9CVVNfRkxBR19TWU5DX1NBTVBMRV9ORUdFREdF
CisJCQkJCSAgfCBEUk1fQlVTX0ZMQUdfUElYREFUQV9TQU1QTEVfUE9TRURHRTsKKworCXJldHVy
biAxOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9wYW5lbF9mdW5jcyB0ZDAyOHR0ZWMx
X2Z1bmNzID0geworCS5wcmVwYXJlID0gdGQwMjh0dGVjMV9wcmVwYXJlLAorCS5lbmFibGUgPSB0
ZDAyOHR0ZWMxX2VuYWJsZSwKKwkuZGlzYWJsZSA9IHRkMDI4dHRlYzFfZGlzYWJsZSwKKwkudW5w
cmVwYXJlID0gdGQwMjh0dGVjMV91bnByZXBhcmUsCisJLmdldF9tb2RlcyA9IHRkMDI4dHRlYzFf
Z2V0X21vZGVzLAorfTsKKworc3RhdGljIGludCB0ZDAyOHR0ZWMxX3Byb2JlKHN0cnVjdCBzcGlf
ZGV2aWNlICpzcGkpCit7CisJc3RydWN0IHRkMDI4dHRlYzFfcGFuZWwgKmxjZDsKKwlpbnQgcmV0
OworCisJbGNkID0gZGV2bV9remFsbG9jKCZzcGktPmRldiwgc2l6ZW9mKCpsY2QpLCBHRlBfS0VS
TkVMKTsKKwlpZiAobGNkID09IE5VTEwpCisJCXJldHVybiAtRU5PTUVNOworCisJc3BpX3NldF9k
cnZkYXRhKHNwaSwgbGNkKTsKKwlsY2QtPnNwaSA9IHNwaTsKKworCWxjZC0+YmFja2xpZ2h0ID0g
ZGV2bV9vZl9maW5kX2JhY2tsaWdodCgmc3BpLT5kZXYpOworCWlmIChJU19FUlIobGNkLT5iYWNr
bGlnaHQpKQorCQlyZXR1cm4gUFRSX0VSUihsY2QtPmJhY2tsaWdodCk7CisKKwlzcGktPm1vZGUg
PSBTUElfTU9ERV8zOworCXNwaS0+Yml0c19wZXJfd29yZCA9IDk7CisKKwlyZXQgPSBzcGlfc2V0
dXAoc3BpKTsKKwlpZiAocmV0IDwgMCkgeworCQlkZXZfZXJyKCZzcGktPmRldiwgImZhaWxlZCB0
byBzZXR1cCBTUEk6ICVkXG4iLCByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKworCWRybV9wYW5l
bF9pbml0KCZsY2QtPnBhbmVsKTsKKwlsY2QtPnBhbmVsLmRldiA9ICZsY2QtPnNwaS0+ZGV2Owor
CWxjZC0+cGFuZWwuZnVuY3MgPSAmdGQwMjh0dGVjMV9mdW5jczsKKworCXJldHVybiBkcm1fcGFu
ZWxfYWRkKCZsY2QtPnBhbmVsKTsKK30KKworc3RhdGljIGludCB0ZDAyOHR0ZWMxX3JlbW92ZShz
dHJ1Y3Qgc3BpX2RldmljZSAqc3BpKQoreworCXN0cnVjdCB0ZDAyOHR0ZWMxX3BhbmVsICpsY2Qg
PSBzcGlfZ2V0X2RydmRhdGEoc3BpKTsKKworCWRybV9wYW5lbF9yZW1vdmUoJmxjZC0+cGFuZWwp
OworCWRybV9wYW5lbF9kaXNhYmxlKCZsY2QtPnBhbmVsKTsKKwlkcm1fcGFuZWxfdW5wcmVwYXJl
KCZsY2QtPnBhbmVsKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IG9m
X2RldmljZV9pZCB0ZDAyOHR0ZWMxX29mX21hdGNoW10gPSB7CisJeyAuY29tcGF0aWJsZSA9ICJ0
cG8sdGQwMjh0dGVjMSIsIH0sCisJLyogRFQgYmFja3dhcmQgY29tcGF0aWJpbGl0eS4gKi8KKwl7
IC5jb21wYXRpYmxlID0gInRvcHBvbHksdGQwMjh0dGVjMSIsIH0sCisJeyAvKiBzZW50aW5lbCAq
LyB9LAorfTsKKworTU9EVUxFX0RFVklDRV9UQUJMRShvZiwgdGQwMjh0dGVjMV9vZl9tYXRjaCk7
CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3Qgc3BpX2RldmljZV9pZCB0ZDAyOHR0ZWMxX2lkc1tdID0g
eworCXsgInRwbyx0ZDAyOHR0ZWMxIiwgMH0sCisJeyAidG9wcG9seSx0ZDAyOHR0ZWMxIiwgMCB9
LAorCXsgLyogc2VudGluZWwgKi8gfQorfTsKKworTU9EVUxFX0RFVklDRV9UQUJMRShzcGksIHRk
MDI4dHRlYzFfaWRzKTsKKworc3RhdGljIHN0cnVjdCBzcGlfZHJpdmVyIHRkMDI4dHRlYzFfZHJp
dmVyID0geworCS5wcm9iZQkJPSB0ZDAyOHR0ZWMxX3Byb2JlLAorCS5yZW1vdmUJCT0gdGQwMjh0
dGVjMV9yZW1vdmUsCisJLmlkX3RhYmxlCT0gdGQwMjh0dGVjMV9pZHMsCisJLmRyaXZlcgkJPSB7
CisJCS5uYW1lICAgPSAicGFuZWwtdHBvLXRkMDI4dHRlYzEiLAorCQkub2ZfbWF0Y2hfdGFibGUg
PSB0ZDAyOHR0ZWMxX29mX21hdGNoLAorCX0sCit9OworCittb2R1bGVfc3BpX2RyaXZlcih0ZDAy
OHR0ZWMxX2RyaXZlcik7CisKK01PRFVMRV9BVVRIT1IoIkguIE5pa29sYXVzIFNjaGFsbGVyIDxo
bnNAZ29sZGVsaWNvLmNvbT4iKTsKK01PRFVMRV9ERVNDUklQVElPTigiVG9wcG9seSBURDAyOFRU
RUMxIHBhbmVsIGRyaXZlciIpOworTU9EVUxFX0xJQ0VOU0UoIkdQTCIpOwotLSAKUmVnYXJkcywK
CkxhdXJlbnQgUGluY2hhcnQKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNr
dG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2Ry
aS1kZXZlbA==
