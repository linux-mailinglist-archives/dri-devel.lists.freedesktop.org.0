Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 427F411A03
	for <lists+dri-devel@lfdr.de>; Thu,  2 May 2019 15:21:12 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0885A89565;
	Thu,  2 May 2019 13:21:04 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mga07.intel.com (mga07.intel.com [134.134.136.100])
 by gabe.freedesktop.org (Postfix) with ESMTPS id D4F4A894DE;
 Thu,  2 May 2019 13:21:01 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga002.fm.intel.com ([10.253.24.26])
 by orsmga105.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 02 May 2019 06:21:01 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.60,421,1549958400"; d="scan'208";a="166894888"
Received: from nuc.iind.intel.com ([10.99.66.149])
 by fmsmga002.fm.intel.com with ESMTP; 02 May 2019 06:20:59 -0700
From: Ramalingam C <ramalingam.c@intel.com>
To: intel-gfx@lists.freedesktop.org, dri-devel@lists.freedesktop.org,
 daniel.vetter@intel.com, gwan-gyeong.mun@intel.com
Subject: [PATCH v6 04/10] drm/i915: SRM revocation check for HDCP1.4 and 2.2
Date: Thu,  2 May 2019 18:52:57 +0530
Message-Id: <20190502132303.27696-5-ramalingam.c@intel.com>
X-Mailer: git-send-email 2.19.1
In-Reply-To: <20190502132303.27696-1-ramalingam.c@intel.com>
References: <20190502132303.27696-1-ramalingam.c@intel.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RFJNIEhEQ1AgU1JNIHJldm9jYXRpb24gY2hlY2sgc2VydmljZXMgYXJlIHVzZWQgZnJvbSBJOTE1
IGZvciBIRENQMS40CmFuZCAyLjIgcmV2b2NhdGlvbiBjaGVjayBkdXJpbmcgdGhlIHJlc3BlY3Rp
dmUgYXV0aGVudGljYXRpb24gZmxvdy4KCnYyOgogIFJlYmFzZWQuCnYzOgogICVzLypfa3N2c19y
ZXZvY2F0ZWQvKl9jaGVja19rc3ZzX3Jldm9rZWQgW0RhbmllbF0KICB1bndhbnRlZCBub2lzZSBp
cyByZW1vdmVkLgoKU2lnbmVkLW9mZi1ieTogUmFtYWxpbmdhbSBDIDxyYW1hbGluZ2FtLmNAaW50
ZWwuY29tPgpSZXZpZXdlZC1ieTogRGFuaWVsIFZldHRlciA8ZGFuaWVsLnZldHRlckBmZndsbC5j
aD4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9oZGNwLmMgfCA0NSArKysrKysrKysr
KysrKysrKysrKysrKysrKy0tLS0tCiAxIGZpbGUgY2hhbmdlZCwgMzggaW5zZXJ0aW9ucygrKSwg
NyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9o
ZGNwLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9oZGNwLmMKaW5kZXggYjhjOGQ2ZDFh
MzNkLi44ZWIzYmJiM2ZhN2YgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X2hkY3AuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9oZGNwLmMKQEAgLTQ5MSw5
ICs0OTEsMTEgQEAgaW50IGludGVsX2hkY3BfdmFsaWRhdGVfdl9wcmltZShzdHJ1Y3QgaW50ZWxf
ZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCwKIAogLyogSW1wbGVtZW50cyBQYXJ0IDIgb2Yg
dGhlIEhEQ1AgYXV0aG9yaXphdGlvbiBwcm9jZWR1cmUgKi8KIHN0YXRpYwotaW50IGludGVsX2hk
Y3BfYXV0aF9kb3duc3RyZWFtKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19w
b3J0LAotCQkJICAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9oZGNwX3NoaW0gKnNoaW0pCitpbnQg
aW50ZWxfaGRjcF9hdXRoX2Rvd25zdHJlYW0oc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVj
dG9yKQogeworCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0gY29u
bl90b19kaWdfcG9ydChjb25uZWN0b3IpOworCWNvbnN0IHN0cnVjdCBpbnRlbF9oZGNwX3NoaW0g
KnNoaW0gPSBjb25uZWN0b3ItPmhkY3Auc2hpbTsKKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0g
Y29ubmVjdG9yLT5iYXNlLmRldjsKIAl1OCBic3RhdHVzWzJdLCBudW1fZG93bnN0cmVhbSwgKmtz
dl9maWZvOwogCWludCByZXQsIGksIHRyaWVzID0gMzsKIApAQCAtNTMyLDYgKzUzNCwxMSBAQCBp
bnQgaW50ZWxfaGRjcF9hdXRoX2Rvd25zdHJlYW0oc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAq
aW50ZWxfZGlnX3BvcnQsCiAJaWYgKHJldCkKIAkJZ290byBlcnI7CiAKKwlpZiAoZHJtX2hkY3Bf
Y2hlY2tfa3N2c19yZXZva2VkKGRldiwga3N2X2ZpZm8sIG51bV9kb3duc3RyZWFtKSkgeworCQlE
Uk1fRVJST1IoIlJldm9rZWQgS3N2KHMpIGluIGtzdl9maWZvXG4iKTsKKwkJcmV0dXJuIC1FUEVS
TTsKKwl9CisKIAkvKgogCSAqIFdoZW4gViBwcmltZSBtaXNtYXRjaGVzLCBEUCBTcGVjIG1hbmRh
dGVzIHJlLXJlYWQgb2YKIAkgKiBWIHByaW1lIGF0bGVhc3QgdHdpY2UuCkBAIC01NTgsOSArNTY1
LDEyIEBAIGludCBpbnRlbF9oZGNwX2F1dGhfZG93bnN0cmVhbShzdHJ1Y3QgaW50ZWxfZGlnaXRh
bF9wb3J0ICppbnRlbF9kaWdfcG9ydCwKIH0KIAogLyogSW1wbGVtZW50cyBQYXJ0IDEgb2YgdGhl
IEhEQ1AgYXV0aG9yaXphdGlvbiBwcm9jZWR1cmUgKi8KLXN0YXRpYyBpbnQgaW50ZWxfaGRjcF9h
dXRoKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0LAotCQkJICAgY29u
c3Qgc3RydWN0IGludGVsX2hkY3Bfc2hpbSAqc2hpbSkKK3N0YXRpYyBpbnQgaW50ZWxfaGRjcF9h
dXRoKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKIHsKKwlzdHJ1Y3QgaW50ZWxf
ZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCA9IGNvbm5fdG9fZGlnX3BvcnQoY29ubmVjdG9y
KTsKKwlzdHJ1Y3QgaW50ZWxfaGRjcCAqaGRjcCA9ICZjb25uZWN0b3ItPmhkY3A7CisJc3RydWN0
IGRybV9kZXZpY2UgKmRldiA9IGNvbm5lY3Rvci0+YmFzZS5kZXY7CisJY29uc3Qgc3RydWN0IGlu
dGVsX2hkY3Bfc2hpbSAqc2hpbSA9IGhkY3AtPnNoaW07CiAJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2OwogCWVudW0gcG9ydCBwb3J0OwogCXVuc2lnbmVkIGxvbmcgcjBfcHJpbWVf
Z2VuX3N0YXJ0OwpAQCAtNjI2LDYgKzYzNiwxMSBAQCBzdGF0aWMgaW50IGludGVsX2hkY3BfYXV0
aChzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCwKIAlpZiAocmV0IDwg
MCkKIAkJcmV0dXJuIHJldDsKIAorCWlmIChkcm1faGRjcF9jaGVja19rc3ZzX3Jldm9rZWQoZGV2
LCBia3N2LnNoaW0sIDEpKSB7CisJCURSTV9FUlJPUigiQktTViBpcyByZXZva2VkXG4iKTsKKwkJ
cmV0dXJuIC1FUEVSTTsKKwl9CisKIAlJOTE1X1dSSVRFKFBPUlRfSERDUF9CS1NWTE8ocG9ydCks
IGJrc3YucmVnWzBdKTsKIAlJOTE1X1dSSVRFKFBPUlRfSERDUF9CS1NWSEkocG9ydCksIGJrc3Yu
cmVnWzFdKTsKIApAQCAtNjk5LDcgKzcxNCw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfaGRjcF9hdXRo
KHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0LAogCSAqLwogCiAJaWYg
KHJlcGVhdGVyX3ByZXNlbnQpCi0JCXJldHVybiBpbnRlbF9oZGNwX2F1dGhfZG93bnN0cmVhbShp
bnRlbF9kaWdfcG9ydCwgc2hpbSk7CisJCXJldHVybiBpbnRlbF9oZGNwX2F1dGhfZG93bnN0cmVh
bShjb25uZWN0b3IpOwogCiAJRFJNX0RFQlVHX0tNUygiSERDUCBpcyBlbmFibGVkIChubyByZXBl
YXRlciBwcmVzZW50KVxuIik7CiAJcmV0dXJuIDA7CkBAIC03NjIsNyArNzc3LDcgQEAgc3RhdGlj
IGludCBfaW50ZWxfaGRjcF9lbmFibGUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9y
KQogCiAJLyogSW5jYXNlIG9mIGF1dGhlbnRpY2F0aW9uIGZhaWx1cmVzLCBIRENQIHNwZWMgZXhw
ZWN0cyByZWF1dGguICovCiAJZm9yIChpID0gMDsgaSA8IHRyaWVzOyBpKyspIHsKLQkJcmV0ID0g
aW50ZWxfaGRjcF9hdXRoKGNvbm5fdG9fZGlnX3BvcnQoY29ubmVjdG9yKSwgaGRjcC0+c2hpbSk7
CisJCXJldCA9IGludGVsX2hkY3BfYXV0aChjb25uZWN0b3IpOwogCQlpZiAoIXJldCkgewogCQkJ
aGRjcC0+aGRjcF9lbmNyeXB0ZWQgPSB0cnVlOwogCQkJcmV0dXJuIDA7CkBAIC0xMTYxLDYgKzEx
NzYsNyBAQCBzdGF0aWMgaW50IGhkY3AyX2F1dGhlbnRpY2F0aW9uX2tleV9leGNoYW5nZShzdHJ1
Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCiB7CiAJc3RydWN0IGludGVsX2RpZ2l0YWxf
cG9ydCAqaW50ZWxfZGlnX3BvcnQgPSBjb25uX3RvX2RpZ19wb3J0KGNvbm5lY3Rvcik7CiAJc3Ry
dWN0IGludGVsX2hkY3AgKmhkY3AgPSAmY29ubmVjdG9yLT5oZGNwOworCXN0cnVjdCBkcm1fZGV2
aWNlICpkZXYgPSBjb25uZWN0b3ItPmJhc2UuZGV2OwogCXVuaW9uIHsKIAkJc3RydWN0IGhkY3Ay
X2FrZV9pbml0IGFrZV9pbml0OwogCQlzdHJ1Y3QgaGRjcDJfYWtlX3NlbmRfY2VydCBzZW5kX2Nl
cnQ7CkBAIC0xMTk1LDYgKzEyMTEsMTIgQEAgc3RhdGljIGludCBoZGNwMl9hdXRoZW50aWNhdGlv
bl9rZXlfZXhjaGFuZ2Uoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQogCiAJaGRj
cC0+aXNfcmVwZWF0ZXIgPSBIRENQXzJfMl9SWF9SRVBFQVRFUihtc2dzLnNlbmRfY2VydC5yeF9j
YXBzWzJdKTsKIAorCWlmIChkcm1faGRjcF9jaGVja19rc3ZzX3Jldm9rZWQoZGV2LCBtc2dzLnNl
bmRfY2VydC5jZXJ0X3J4LnJlY2VpdmVyX2lkLAorCQkJCQkxKSkgeworCQlEUk1fRVJST1IoIlJl
Y2VpdmVyIElEIGlzIHJldm9rZWRcbiIpOworCQlyZXR1cm4gLUVQRVJNOworCX0KKwogCS8qCiAJ
ICogSGVyZSBtc2dzLm5vX3N0b3JlZF9rbSB3aWxsIGhvbGQgbXNncyBjb3JyZXNwb25kaW5nIHRv
IHRoZSBrbQogCSAqIHN0b3JlZCBhbHNvLgpAQCAtMTM0NywxMyArMTM2OSwxNCBAQCBpbnQgaGRj
cDJfYXV0aGVudGljYXRlX3JlcGVhdGVyX3RvcG9sb2d5KHN0cnVjdCBpbnRlbF9jb25uZWN0b3Ig
KmNvbm5lY3RvcikKIHsKIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9y
dCA9IGNvbm5fdG9fZGlnX3BvcnQoY29ubmVjdG9yKTsKIAlzdHJ1Y3QgaW50ZWxfaGRjcCAqaGRj
cCA9ICZjb25uZWN0b3ItPmhkY3A7CisJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNvbm5lY3Rv
ci0+YmFzZS5kZXY7CiAJdW5pb24gewogCQlzdHJ1Y3QgaGRjcDJfcmVwX3NlbmRfcmVjZWl2ZXJp
ZF9saXN0IHJlY3ZpZF9saXN0OwogCQlzdHJ1Y3QgaGRjcDJfcmVwX3NlbmRfYWNrIHJlcF9hY2s7
CiAJfSBtc2dzOwogCWNvbnN0IHN0cnVjdCBpbnRlbF9oZGNwX3NoaW0gKnNoaW0gPSBoZGNwLT5z
aGltOworCXUzMiBzZXFfbnVtX3YsIGRldmljZV9jbnQ7CiAJdTggKnJ4X2luZm87Ci0JdTMyIHNl
cV9udW1fdjsKIAlpbnQgcmV0OwogCiAJcmV0ID0gc2hpbS0+cmVhZF8yXzJfbXNnKGludGVsX2Rp
Z19wb3J0LCBIRENQXzJfMl9SRVBfU0VORF9SRUNWSURfTElTVCwKQEAgLTEzNzgsNiArMTQwMSwx
NCBAQCBpbnQgaGRjcDJfYXV0aGVudGljYXRlX3JlcGVhdGVyX3RvcG9sb2d5KHN0cnVjdCBpbnRl
bF9jb25uZWN0b3IgKmNvbm5lY3RvcikKIAkJcmV0dXJuIC1FSU5WQUw7CiAJfQogCisJZGV2aWNl
X2NudCA9IEhEQ1BfMl8yX0RFVl9DT1VOVF9ISShyeF9pbmZvWzBdKSA8PCA0IHx8CisJCQlIRENQ
XzJfMl9ERVZfQ09VTlRfTE8ocnhfaW5mb1sxXSk7CisJaWYgKGRybV9oZGNwX2NoZWNrX2tzdnNf
cmV2b2tlZChkZXYsIG1zZ3MucmVjdmlkX2xpc3QucmVjZWl2ZXJfaWRzLAorCQkJCQlkZXZpY2Vf
Y250KSkgeworCQlEUk1fRVJST1IoIlJldm9rZWQgcmVjZWl2ZXIgSUQocykgaXMgaW4gbGlzdFxu
Iik7CisJCXJldHVybiAtRVBFUk07CisJfQorCiAJcmV0ID0gaGRjcDJfdmVyaWZ5X3JlcF90b3Bv
bG9neV9wcmVwYXJlX2Fjayhjb25uZWN0b3IsCiAJCQkJCQkgICAgJm1zZ3MucmVjdmlkX2xpc3Qs
CiAJCQkJCQkgICAgJm1zZ3MucmVwX2Fjayk7Ci0tIAoyLjE5LjEKCl9fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJp
LWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9y
Zy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
