Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id CC00118F774
	for <lists+dri-devel@lfdr.de>; Mon, 23 Mar 2020 15:51:19 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 81D286E1F5;
	Mon, 23 Mar 2020 14:50:36 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-wr1-x443.google.com (mail-wr1-x443.google.com
 [IPv6:2a00:1450:4864:20::443])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 773816E1E6
 for <dri-devel@lists.freedesktop.org>; Mon, 23 Mar 2020 14:50:34 +0000 (UTC)
Received: by mail-wr1-x443.google.com with SMTP id b2so17405363wrj.10
 for <dri-devel@lists.freedesktop.org>; Mon, 23 Mar 2020 07:50:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=ffwll.ch; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=Kn2P+rpRYj819SqcLRPDMCUGVdgl7HKffkRVR6VqHqM=;
 b=gWiEbbT/HmJqrzw3+0bBuuHaIFgtTKlieFWwYUBEsCBGx269JSiRC6C+bUr+C2xtZe
 ARlvzAHPauwsapsAehQwkTno+FyxEbnilalfnKieqIBDREC/4b5khAQaDYtJ9n1TezpQ
 tWr8tkO9aZuIdPQzaKVWFPCnMVpVzePM8QgGM=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=Kn2P+rpRYj819SqcLRPDMCUGVdgl7HKffkRVR6VqHqM=;
 b=VcBjkA5LIvvvaEB6Y8RjdhDrAVysN3kpW/u0XCjqrusNLOgE7oA4DTyiuWorHhika8
 hRZLMfou+O9lrMvawVjJ5v39Nl16H5JAR5oyh5+j0qRQJrilVjUExloYjE/aT3vTe4Z4
 jcr9ajJAVtXL1JeOms7VTpvdEOGjEu+ZbQwT06yTkphOztmPqDghRTa1EOEu/pXJDkt/
 P11VndgZGOyBzF9eHF54Ff9nNTK9C2CPXhqzGIE540AX2NtosvKNDd8WCltmlFKe4Rrp
 ZIOK3Mo7+7nES586DYGnkbqMR/H4YyNfq/TKo1cjOIJvaq3i1AWczZLAXPhkEiFfIO2E
 6wSw==
X-Gm-Message-State: ANhLgQ1lkrjauCxIoxc9bWpISnRuA2X/p0B0lOuUnfehxWUzdW2s95xx
 lsLBU9BOpaVLTR7o72Re9qHWzsfy8QPQIw==
X-Google-Smtp-Source: ADFU+vvAsJZ9kaNZ+AkFD1Uz/n7HLKt58s1qo4jRuTMQqHcd0z5O3SNdc9LQXbxFlGKZm9hGHNieWw==
X-Received: by 2002:a5d:4091:: with SMTP id o17mr15453764wrp.254.1584975032188; 
 Mon, 23 Mar 2020 07:50:32 -0700 (PDT)
Received: from phenom.ffwll.local ([2a02:168:57f4:0:efd0:b9e5:5ae6:c2fa])
 by smtp.gmail.com with ESMTPSA id s22sm20376522wmc.16.2020.03.23.07.50.31
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 23 Mar 2020 07:50:31 -0700 (PDT)
From: Daniel Vetter <daniel.vetter@ffwll.ch>
To: DRI Development <dri-devel@lists.freedesktop.org>
Subject: [PATCH 26/51] drm: Manage drm_mode_config_init with drmm_
Date: Mon, 23 Mar 2020 15:49:25 +0100
Message-Id: <20200323144950.3018436-27-daniel.vetter@ffwll.ch>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20200323144950.3018436-1-daniel.vetter@ffwll.ch>
References: <20200323144950.3018436-1-daniel.vetter@ffwll.ch>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Daniel Vetter <daniel.vetter@ffwll.ch>,
 Intel Graphics Development <intel-gfx@lists.freedesktop.org>,
 Laurent Pinchart <laurent.pinchart@ideasonboard.com>,
 Thomas Zimmermann <tzimmermann@suse.de>,
 Daniel Vetter <daniel.vetter@intel.com>, Sam Ravnborg <sam@ravnborg.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

ZHJtX21vZGVfY29uZmlnX2NsZWFudXAgaXMgaWRlbXBvdGVudCwgc28gbm8gaGFybSBpbiBjYWxs
aW5nIHRoaXMKdHdpY2UuIFRoaXMgYWxsb3dzIHVzIHRvIGdyYWR1YWxseSBzd2l0Y2ggZHJpdmVy
cyBvdmVyIGJ5IHJlbW92aW5nCmV4cGxpY2l0IGRybV9tb2RlX2NvbmZpZ19jbGVhbnVwIGNhbGxz
LgoKV2l0aCB0aGlzIHN0ZXAgaXQncyBub3cgYWxzbyBwb3NzaWJsZSB0aGF0IChhdCBsZWFzdCBm
b3Igc2ltcGxlCmRyaXZlcnMpIGF1dG9tYXRpYyByZXNvdXJjZSBjbGVhbnVwIGNhbiBiZSBkb25l
IGNvcnJlY3RseSB3aXRob3V0IGEKZHJtX2RyaXZlci0+cmVsZWFzZSBob29rLiBUaGVyZWZvcmUg
YWxsb3cgdGhpcyBub3cgaW4KZGV2bV9kcm1fZGV2X2luaXQoKS4KCkFsc28gd2l0aCBkcm1tXyBl
eHBsaWNpdCBkcm1fZHJpdmVyLT5yZWxlYXNlIGhvb2tzIGFyZSBraW5kYSBub3QgdGhlCmJlc3Qg
b3B0aW9uOiBEcml2ZXJzIGNhbiBhbHdheXMganVzdCByZWdpc3RlciB0aGVpciBjdXJyZW50IHJl
bGVhc2UKaG9vayB3aXRoIGRybW1fYWRkX2FjdGlvbiwgYnV0IGV2ZW4gYmV0dGVyIHRoZXkgY291
bGQgc3BsaXQgdGhlbSB1cCB0bwpzaW1wbGlmeSB0aGUgdW53aW5kaW5nIGZvciB0aGUgZHJpdmVy
IGxvYWQgZmFpbHVyZSBjYXNlLiBTbyBkZXByZWNhdGUKdGhhdCBob29rIHRvIGRpc2NvdXJhZ2Ug
ZnV0dXJlIHVzZXJzLgoKdjI6IEZpeHVwIHRoZSBleGFtcGxlIGluIHRoZSBrZXJuZWxkb2MgdG9v
LgoKdjM6Ci0gRm9yIHBhcmFub2lhLCBkb3VibGUgY2hlY2sgdGhhdCBtaW5vci0+ZGV2ID09IGRl
diBpbiB0aGUgcmVsZWFzZQogIGhvb2ssIGJlY2F1c2UgSSBib3RjaGVkIHRoZSBwb2ludGVyIG1h
dGggaW4gdGhlIGRybW0gbGlicmFyeS4KLSBDYWxsIGRybV9tb2RlX2NvbmZpZ19jbGVhbnVwIHdo
ZW4gZHJtbV9hZGRfYWN0aW9uIGZhaWxzLCB3ZSdkIGJlCiAgbWlzc2luZyBzb21lIG11dGV4X2Rl
c3Ryb3kgYW5kIGlkYV9jbGVhbnVwIG90aGVyd2lzZSAoTGF1cmVudCkKCnY0OiBBZGQgYSBkcm1t
X2FkZF9hY3Rpb25fb3JfcmVzZXQgKGxpa2UgZGV2bV8gaGFzKSB0byBlbmNhcHN1bGF0ZSB0aGlz
CnBhdHRlcm4gKE5vcmFsZikuCgp2NTogRml4IG92ZXJzaWdodCBpbiB0aGUgbmV3IGRybW1fYWRk
X2FjdGlvbl9vcl9yZXNldCBtYWNybyAoTm9yYWxmKQoKdjQ6IFJldmlldyBmcm9tIFNhbToKLSBk
cm1tX21vZGVfY29uZmlnX2luaXQgd3JhcHBlciAoYWxzbyBzdWdnZXN0ZWQgYnkgVGhvbWFzKQot
IGltcHJvdmUgY29tbWl0IG1lc3NhZ2UsIGV4cGxhaW4gYmV0dGVyIHdoeSAtPnJlbGFzZSBpcyBk
ZXByZWNhdGVkCgp2NToKLSBNYWtlIGRybW1fIHRoZSBtYWluIGZ1bmN0aW9uLCB3aXRoIHRoZSBv
bGQgb25lIGFzIGNvbXBhdCB3cmFwcGVyCiAgKFNhbSkKLSBBZGQgRklYTUUgY29tbWVudHMgdG8g
ZHJtX21vZGVfY29uZmlnX2NsZWFudXAvaW5pdCgpIHRoYXQgZHJpdmVycwogIHNob3VsZG4ndCB1
c2UgdGhlc2UgYW55bW9yZS4KLSBNb3ZlIGRybW1fYWRkX2FjdGlvbl9vcl9yZXNldCBoZWxwZXIg
dG8gYW4gZWFybGllciBwYXRjaC4KClJldmlld2VkLWJ5OiBTYW0gUmF2bmJvcmcgPHNhbUByYXZu
Ym9yZy5vcmc+CkNjOiBMYXVyZW50IFBpbmNoYXJ0IDxsYXVyZW50LnBpbmNoYXJ0QGlkZWFzb25i
b2FyZC5jb20+CkNjOiAiTm9yYWxmIFRyw7hubmVzIiA8bm9yYWxmQHRyb25uZXMub3JnPgpDYzog
U2FtIFJhdm5ib3JnIDxzYW1AcmF2bmJvcmcub3JnPgpDYzogVGhvbWFzIFppbW1lcm1hbm4gPHR6
aW1tZXJtYW5uQHN1c2UuZGU+CkFja2VkLWJ5OiBOb3JhbGYgVHLDuG5uZXMgPG5vcmFsZkB0cm9u
bmVzLm9yZz4KU2lnbmVkLW9mZi1ieTogRGFuaWVsIFZldHRlciA8ZGFuaWVsLnZldHRlckBpbnRl
bC5jb20+Ci0tLQogRG9jdW1lbnRhdGlvbi9ncHUvZHJtLWttcy5yc3QgICAgIHwgIDIgKy0KIGRy
aXZlcnMvZ3B1L2RybS9kcm1fZHJ2LmMgICAgICAgICB8IDIzICsrKysrKystLS0tLS0tLS0tLS0t
LS0tCiBkcml2ZXJzL2dwdS9kcm0vZHJtX21vZGVfY29uZmlnLmMgfCAyMyArKysrKysrKysrKysr
KysrKysrKy0tLQogaW5jbHVkZS9kcm0vZHJtX21vZGVfY29uZmlnLmggICAgIHwgMTggKysrKysr
KysrKysrKysrKystCiA0IGZpbGVzIGNoYW5nZWQsIDQ1IGluc2VydGlvbnMoKyksIDIxIGRlbGV0
aW9ucygtKQoKZGlmZiAtLWdpdCBhL0RvY3VtZW50YXRpb24vZ3B1L2RybS1rbXMucnN0IGIvRG9j
dW1lbnRhdGlvbi9ncHUvZHJtLWttcy5yc3QKaW5kZXggOTA2NzcxZTAzMTAzLi5lMWY2ODUwMTU4
MDcgMTAwNjQ0Ci0tLSBhL0RvY3VtZW50YXRpb24vZ3B1L2RybS1rbXMucnN0CisrKyBiL0RvY3Vt
ZW50YXRpb24vZ3B1L2RybS1rbXMucnN0CkBAIC0zLDcgKzMsNyBAQCBLZXJuZWwgTW9kZSBTZXR0
aW5nIChLTVMpCiA9PT09PT09PT09PT09PT09PT09PT09PT09CiAKIERyaXZlcnMgbXVzdCBpbml0
aWFsaXplIHRoZSBtb2RlIHNldHRpbmcgY29yZSBieSBjYWxsaW5nCi1kcm1fbW9kZV9jb25maWdf
aW5pdCgpIG9uIHRoZSBEUk0gZGV2aWNlLiBUaGUgZnVuY3Rpb24KK2RybW1fbW9kZV9jb25maWdf
aW5pdCgpIG9uIHRoZSBEUk0gZGV2aWNlLiBUaGUgZnVuY3Rpb24KIGluaXRpYWxpemVzIHRoZSA6
Yzp0eXBlOmBzdHJ1Y3QgZHJtX2RldmljZSA8ZHJtX2RldmljZT5gCiBtb2RlX2NvbmZpZyBmaWVs
ZCBhbmQgbmV2ZXIgZmFpbHMuIE9uY2UgZG9uZSwgbW9kZSBjb25maWd1cmF0aW9uIG11c3QKIGJl
IHNldHVwIGJ5IGluaXRpYWxpemluZyB0aGUgZm9sbG93aW5nIGZpZWxkcy4KZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9kcm1fZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX2Rydi5jCmlu
ZGV4IDAzZjVjYjgyOTk1Ny4uZWE2ODdjNWVhZDE1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vZHJtX2Rydi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fZHJ2LmMKQEAgLTk4LDYgKzk4
LDggQEAgc3RhdGljIHZvaWQgZHJtX21pbm9yX2FsbG9jX3JlbGVhc2Uoc3RydWN0IGRybV9kZXZp
Y2UgKmRldiwgdm9pZCAqZGF0YSkKIAlzdHJ1Y3QgZHJtX21pbm9yICptaW5vciA9IGRhdGE7CiAJ
dW5zaWduZWQgbG9uZyBmbGFnczsKIAorCVdBUk5fT04oZGV2ICE9IG1pbm9yLT5kZXYpOworCiAJ
cHV0X2RldmljZShtaW5vci0+a2Rldik7CiAKIAlzcGluX2xvY2tfaXJxc2F2ZSgmZHJtX21pbm9y
X2xvY2ssIGZsYWdzKTsKQEAgLTI2NSw4ICsyNjcsNyBAQCB2b2lkIGRybV9taW5vcl9yZWxlYXNl
KHN0cnVjdCBkcm1fbWlub3IgKm1pbm9yKQogICoKICAqIFRoZSBmb2xsb3dpbmcgZXhhbXBsZSBz
aG93cyBhIHR5cGljYWwgc3RydWN0dXJlIG9mIGEgRFJNIGRpc3BsYXkgZHJpdmVyLgogICogVGhl
IGV4YW1wbGUgZm9jdXMgb24gdGhlIHByb2JlKCkgZnVuY3Rpb24gYW5kIHRoZSBvdGhlciBmdW5j
dGlvbnMgdGhhdCBpcwotICogYWxtb3N0IGFsd2F5cyBwcmVzZW50IGFuZCBzZXJ2ZXMgYXMgYSBk
ZW1vbnN0cmF0aW9uIG9mIGRldm1fZHJtX2Rldl9pbml0KCkKLSAqIHVzYWdlIHdpdGggaXRzIGFj
Y29tcGFueWluZyBkcm1fZHJpdmVyLT5yZWxlYXNlIGNhbGxiYWNrLgorICogYWxtb3N0IGFsd2F5
cyBwcmVzZW50IGFuZCBzZXJ2ZXMgYXMgYSBkZW1vbnN0cmF0aW9uIG9mIGRldm1fZHJtX2Rldl9p
bml0KCkuCiAgKgogICogLi4gY29kZS1ibG9jazo6IGMKICAqCkBAIC0yNzYsMTYgKzI3Nyw4IEBA
IHZvaWQgZHJtX21pbm9yX3JlbGVhc2Uoc3RydWN0IGRybV9taW5vciAqbWlub3IpCiAgKgkJc3Ry
dWN0IGNsayAqcGNsazsKICAqCX07CiAgKgotICoJc3RhdGljIHZvaWQgZHJpdmVyX2RybV9yZWxl
YXNlKHN0cnVjdCBkcm1fZGV2aWNlICpkcm0pCi0gKgl7Ci0gKgkJc3RydWN0IGRyaXZlcl9kZXZp
Y2UgKnByaXYgPSBjb250YWluZXJfb2YoLi4uKTsKLSAqCi0gKgkJZHJtX21vZGVfY29uZmlnX2Ns
ZWFudXAoZHJtKTsKLSAqCX0KLSAqCiAgKglzdGF0aWMgc3RydWN0IGRybV9kcml2ZXIgZHJpdmVy
X2RybV9kcml2ZXIgPSB7CiAgKgkJWy4uLl0KLSAqCQkucmVsZWFzZSA9IGRyaXZlcl9kcm1fcmVs
ZWFzZSwKICAqCX07CiAgKgogICoJc3RhdGljIGludCBkcml2ZXJfcHJvYmUoc3RydWN0IHBsYXRm
b3JtX2RldmljZSAqcGRldikKQEAgLTMxMCw3ICszMDMsOSBAQCB2b2lkIGRybV9taW5vcl9yZWxl
YXNlKHN0cnVjdCBkcm1fbWlub3IgKm1pbm9yKQogICoJCX0KICAqCQlkcm1tX2FkZF9maW5hbF9r
ZnJlZShkcm0sIHByaXYpOwogICoKLSAqCQlkcm1fbW9kZV9jb25maWdfaW5pdChkcm0pOworICoJ
CXJldCA9IGRybW1fbW9kZV9jb25maWdfaW5pdChkcm0pOworICoJCWlmIChyZXQpCisgKgkJCXJl
dHVybiByZXQ7CiAgKgogICoJCXByaXYtPnVzZXJzcGFjZV9mYWNpbmcgPSBkcm1tX2t6YWxsb2Mo
Li4uLCBHRlBfS0VSTkVMKTsKICAqCQlpZiAoIXByaXYtPnVzZXJzcGFjZV9mYWNpbmcpCkBAIC03
MDgsOCArNzAzLDcgQEAgc3RhdGljIHZvaWQgZGV2bV9kcm1fZGV2X2luaXRfcmVsZWFzZSh2b2lk
ICpkYXRhKQogICogQGRyaXZlcjogRFJNIGRyaXZlcgogICoKICAqIE1hbmFnZWQgZHJtX2Rldl9p
bml0KCkuIFRoZSBEUk0gZGV2aWNlIGluaXRpYWxpemVkIHdpdGggdGhpcyBmdW5jdGlvbiBpcwot
ICogYXV0b21hdGljYWxseSBwdXQgb24gZHJpdmVyIGRldGFjaCB1c2luZyBkcm1fZGV2X3B1dCgp
LiBZb3UgbXVzdCBzdXBwbHkgYQotICogJmRybV9kcml2ZXIucmVsZWFzZSBjYWxsYmFjayB0byBj
b250cm9sIHRoZSBmaW5hbGl6YXRpb24gZXhwbGljaXRseS4KKyAqIGF1dG9tYXRpY2FsbHkgcHV0
IG9uIGRyaXZlciBkZXRhY2ggdXNpbmcgZHJtX2Rldl9wdXQoKS4KICAqCiAgKiBSRVRVUk5TOgog
ICogMCBvbiBzdWNjZXNzLCBvciBlcnJvciBjb2RlIG9uIGZhaWx1cmUuCkBAIC03MjAsOSArNzE0
LDYgQEAgaW50IGRldm1fZHJtX2Rldl9pbml0KHN0cnVjdCBkZXZpY2UgKnBhcmVudCwKIHsKIAlp
bnQgcmV0OwogCi0JaWYgKFdBUk5fT04oIWRyaXZlci0+cmVsZWFzZSkpCi0JCXJldHVybiAtRUlO
VkFMOwotCiAJcmV0ID0gZHJtX2Rldl9pbml0KGRldiwgZHJpdmVyLCBwYXJlbnQpOwogCWlmIChy
ZXQpCiAJCXJldHVybiByZXQ7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vZHJtX21vZGVf
Y29uZmlnLmMgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX21vZGVfY29uZmlnLmMKaW5kZXggZTFlYzFi
YjcwNjhkLi41NzYxZjgzOGEwNTcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9kcm1fbW9k
ZV9jb25maWcuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX21vZGVfY29uZmlnLmMKQEAgLTI1
LDYgKzI1LDcgQEAKICNpbmNsdWRlIDxkcm0vZHJtX2Rydi5oPgogI2luY2x1ZGUgPGRybS9kcm1f
ZW5jb2Rlci5oPgogI2luY2x1ZGUgPGRybS9kcm1fZmlsZS5oPgorI2luY2x1ZGUgPGRybS9kcm1f
bWFuYWdlZC5oPgogI2luY2x1ZGUgPGRybS9kcm1fbW9kZV9jb25maWcuaD4KICNpbmNsdWRlIDxk
cm0vZHJtX3ByaW50Lmg+CiAjaW5jbHVkZSA8bGludXgvZG1hLXJlc3YuaD4KQEAgLTM3Myw4ICsz
NzQsMTQgQEAgc3RhdGljIGludCBkcm1fbW9kZV9jcmVhdGVfc3RhbmRhcmRfcHJvcGVydGllcyhz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2KQogCXJldHVybiAwOwogfQogCitzdGF0aWMgdm9pZCBkcm1f
bW9kZV9jb25maWdfaW5pdF9yZWxlYXNlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKnB0
cikKK3sKKwlkcm1fbW9kZV9jb25maWdfY2xlYW51cChkZXYpOworfQorCiAvKioKLSAqIGRybV9t
b2RlX2NvbmZpZ19pbml0IC0gaW5pdGlhbGl6ZSBEUk0gbW9kZV9jb25maWd1cmF0aW9uIHN0cnVj
dHVyZQorICogZHJtbV9tb2RlX2NvbmZpZ19pbml0IC0gbWFuYWdlZCBEUk0gbW9kZV9jb25maWd1
cmF0aW9uIHN0cnVjdHVyZQorICogCWluaXRpYWxpemF0aW9uCiAgKiBAZGV2OiBEUk0gZGV2aWNl
CiAgKgogICogSW5pdGlhbGl6ZSBAZGV2J3MgbW9kZV9jb25maWcgc3RydWN0dXJlLCB1c2VkIGZv
ciB0cmFja2luZyB0aGUgZ3JhcGhpY3MKQEAgLTM4NCw4ICszOTEsMTIgQEAgc3RhdGljIGludCBk
cm1fbW9kZV9jcmVhdGVfc3RhbmRhcmRfcHJvcGVydGllcyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
KQogICogcHJvYmxlbSwgc2luY2UgdGhpcyBzaG91bGQgaGFwcGVuIHNpbmdsZSB0aHJlYWRlZCBh
dCBpbml0IHRpbWUuIEl0IGlzIHRoZQogICogZHJpdmVyJ3MgcHJvYmxlbSB0byBlbnN1cmUgdGhp
cyBndWFyYW50ZWUuCiAgKgorICogQ2xlYW51cCBpcyBhdXRvbWF0aWNhbGx5IGhhbmRsZWQgdGhy
b3VnaCByZWdpc3RlcmluZyBkcm1fbW9kZV9jb25maWdfY2xlYW51cAorICogd2l0aCBkcm1tX2Fk
ZF9hY3Rpb24oKS4KKyAqCisgKiBSZXR1cm5zOiAwIG9uIHN1Y2Nlc3MsIG5lZ2F0aXZlIGVycm9y
IHZhbHVlIG9uIGZhaWx1cmUuCiAgKi8KLXZvaWQgZHJtX21vZGVfY29uZmlnX2luaXQoc3RydWN0
IGRybV9kZXZpY2UgKmRldikKK2ludCBkcm1tX21vZGVfY29uZmlnX2luaXQoc3RydWN0IGRybV9k
ZXZpY2UgKmRldikKIHsKIAltdXRleF9pbml0KCZkZXYtPm1vZGVfY29uZmlnLm11dGV4KTsKIAlk
cm1fbW9kZXNldF9sb2NrX2luaXQoJmRldi0+bW9kZV9jb25maWcuY29ubmVjdGlvbl9tdXRleCk7
CkBAIC00NDMsOCArNDU0LDExIEBAIHZvaWQgZHJtX21vZGVfY29uZmlnX2luaXQoc3RydWN0IGRy
bV9kZXZpY2UgKmRldikKIAkJZHJtX21vZGVzZXRfYWNxdWlyZV9maW5pKCZtb2Rlc2V0X2N0eCk7
CiAJCWRtYV9yZXN2X2ZpbmkoJnJlc3YpOwogCX0KKworCXJldHVybiBkcm1tX2FkZF9hY3Rpb25f
b3JfcmVzZXQoZGV2LCBkcm1fbW9kZV9jb25maWdfaW5pdF9yZWxlYXNlLAorCQkJCQlOVUxMKTsK
IH0KLUVYUE9SVF9TWU1CT0woZHJtX21vZGVfY29uZmlnX2luaXQpOworRVhQT1JUX1NZTUJPTChk
cm1tX21vZGVfY29uZmlnX2luaXQpOwogCiAvKioKICAqIGRybV9tb2RlX2NvbmZpZ19jbGVhbnVw
IC0gZnJlZSB1cCBEUk0gbW9kZV9jb25maWcgaW5mbwpAQCAtNDU2LDYgKzQ3MCw5IEBAIEVYUE9S
VF9TWU1CT0woZHJtX21vZGVfY29uZmlnX2luaXQpOwogICogTm90ZSB0aGF0IHNpbmNlIHRoaXMg
L3Nob3VsZC8gaGFwcGVuIHNpbmdsZS10aHJlYWRlZCBhdCBkcml2ZXIvZGV2aWNlCiAgKiB0ZWFy
ZG93biB0aW1lLCBubyBsb2NraW5nIGlzIHJlcXVpcmVkLiBJdCdzIHRoZSBkcml2ZXIncyBqb2Ig
dG8gZW5zdXJlIHRoYXQKICAqIHRoaXMgZ3VhcmFudGVlIGFjdHVhbGx5IGhvbGRzIHRydWUuCisg
KgorICogRklYTUU6IFdpdGggdGhlIG1hbmFnZWQgZHJtbV9tb2RlX2NvbmZpZ19pbml0KCkgaXQg
aXMgbm8gbG9uZ2VyIG5lY2Vzc2FyeSBmb3IKKyAqIGRyaXZlcnMgdG8gZXhwbGljaXRseSBjYWxs
IHRoaXMgZnVuY3Rpb24uCiAgKi8KIHZvaWQgZHJtX21vZGVfY29uZmlnX2NsZWFudXAoc3RydWN0
IGRybV9kZXZpY2UgKmRldikKIHsKZGlmZiAtLWdpdCBhL2luY2x1ZGUvZHJtL2RybV9tb2RlX2Nv
bmZpZy5oIGIvaW5jbHVkZS9kcm0vZHJtX21vZGVfY29uZmlnLmgKaW5kZXggM2JjYmUzMDMzOWYw
Li42YzNlZjQ5YjQ2YjMgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvZHJtL2RybV9tb2RlX2NvbmZpZy5o
CisrKyBiL2luY2x1ZGUvZHJtL2RybV9tb2RlX2NvbmZpZy5oCkBAIC05MjksNyArOTI5LDIzIEBA
IHN0cnVjdCBkcm1fbW9kZV9jb25maWcgewogCWNvbnN0IHN0cnVjdCBkcm1fbW9kZV9jb25maWdf
aGVscGVyX2Z1bmNzICpoZWxwZXJfcHJpdmF0ZTsKIH07CiAKLXZvaWQgZHJtX21vZGVfY29uZmln
X2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldik7CitpbnQgX19tdXN0X2NoZWNrIGRybW1fbW9k
ZV9jb25maWdfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KTsKKworLyoqCisgKiBkcm1fbW9k
ZV9jb25maWdfaW5pdCAtIERSTSBtb2RlX2NvbmZpZ3VyYXRpb24gc3RydWN0dXJlIGluaXRpYWxp
emF0aW9uCisgKiBAZGV2OiBEUk0gZGV2aWNlCisgKgorICogVGhpcyBpcyB0aGUgdW5tYW5hZ2Vk
IHZlcnNpb24gb2YgZHJtbV9tb2RlX2NvbmZpZ19pbml0KCkgZm9yIGRyaXZlcnMgd2hpY2gKKyAq
IHN0aWxsIGV4cGxpY2l0bHkgY2FsbCBkcm1fbW9kZV9jb25maWdfY2xlYW51cCgpLgorICoKKyAq
IEZJWE1FOiBUaGlzIGZ1bmN0aW9uIGlzIGRlcHJlY2F0ZWQgYW5kIGRyaXZlcnMgc2hvdWxkIGJl
IGNvbnZlcnRlZCBvdmVyIHRvCisgKiBkcm1tX21vZGVfY29uZmlnX2luaXQoKS4KKyAqLworc3Rh
dGljIGlubGluZSBpbnQgZHJtX21vZGVfY29uZmlnX2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRl
dikKK3sKKwlyZXR1cm4gZHJtbV9tb2RlX2NvbmZpZ19pbml0KGRldik7Cit9CisKIHZvaWQgZHJt
X21vZGVfY29uZmlnX3Jlc2V0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpOwogdm9pZCBkcm1fbW9k
ZV9jb25maWdfY2xlYW51cChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KTsKIAotLSAKMi4yNS4xCgpf
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwg
bWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0
cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWwK
