Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id C2DDD12B74
	for <lists+dri-devel@lfdr.de>; Fri,  3 May 2019 12:29:40 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 639728941E;
	Fri,  3 May 2019 10:29:37 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from honk.sigxcpu.org (honk.sigxcpu.org [24.134.29.49])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B00708941E;
 Fri,  3 May 2019 10:29:35 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by honk.sigxcpu.org (Postfix) with ESMTP id 10384FB03;
 Fri,  3 May 2019 12:29:34 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at honk.sigxcpu.org
Received: from honk.sigxcpu.org ([127.0.0.1])
 by localhost (honk.sigxcpu.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id qfS2LwLNadgI; Fri,  3 May 2019 12:29:26 +0200 (CEST)
Received: by bogon.sigxcpu.org (Postfix, from userid 1000)
 id BFDAC47CC6; Fri,  3 May 2019 12:29:25 +0200 (CEST)
Date: Fri, 3 May 2019 12:29:25 +0200
From: Guido =?iso-8859-1?Q?G=FCnther?= <agx@sigxcpu.org>
To: Lucas Stach <l.stach@pengutronix.de>
Subject: Re: [PATCH v2 4/8] drm/etnaviv: rework MMU handling
Message-ID: <20190503102925.GA22521@bogon.m.sigxcpu.org>
References: <20190417135023.26977-1-l.stach@pengutronix.de>
 <20190417135023.26977-5-l.stach@pengutronix.de>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <20190417135023.26977-5-l.stach@pengutronix.de>
User-Agent: Mutt/1.10.1 (2018-07-13)
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: etnaviv@lists.freedesktop.org, dri-devel@lists.freedesktop.org,
 patchwork-lst@pengutronix.de, kernel@pengutronix.de,
 Russell King <linux+etnaviv@armlinux.org.uk>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SGksCk9uIFdlZCwgQXByIDE3LCAyMDE5IGF0IDAzOjUwOjE5UE0gKzAyMDAsIEx1Y2FzIFN0YWNo
IHdyb3RlOgo+IFRoaXMgcmV3b3JrcyB0aGUgTU1VIGhhbmRsaW5nIHRvIG1ha2UgaXQgcG9zc2li
bGUgdG8gaGF2ZSBtdWx0aXBsZQo+IE1NVSBjb250ZXh0cywgbm90IG9uZSBwZXIgR1BVLiBUaGlz
IGNvbW1pdCBkb2Vzbid0IGFjdHVhbGx5IGRvIGFueXRoaW5nCj4gd2l0aCB0aG9zZSBjb250ZXh0
cywgYXNpZGUgZnJvbSBnaXZpbmcgb25lIG9mIHRoZW0gdG8gZWFjaCBHUFUuCj4gCj4gVGhlIGNv
ZGUgY2hhbmdlcyBhcmUgcHJldHR5IGludmFzaXZlLCBidXQgdGhlcmUgaXMgbm8gc2FuZSB3YXkg
dG8gc3BsaXQKPiB0aGlzIGludG8gc21hbGxlciBjaGFuZ2VzLgoKVGhpcyBvbmUgdHJpcHMgdXAg
Y2hlY2twYXRjaCBhIGJpdCBtaXhlZCB0YWJzL3NwYWNlcyBhbmQgc29tZSBvdGhlciBtaW5vcgp0
aGluZ3MuCkNoZWVycywKIC0tIEd1aWRvCgo+IAo+IFNpZ25lZC1vZmYtYnk6IEx1Y2FzIFN0YWNo
IDxsLnN0YWNoQHBlbmd1dHJvbml4LmRlPgo+IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vZXRuYXZp
di9ldG5hdml2X2J1ZmZlci5jICAgfCAgIDggKy0KPiAgZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYv
ZXRuYXZpdl9jbWRidWYuYyAgIHwgICA4ICstCj4gIGRyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0
bmF2aXZfY21kYnVmLmggICB8ICAgNiArLQo+ICBkcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5h
dml2X2Rydi5jICAgICAgfCAgIDEgKwo+ICBkcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2
X2Rydi5oICAgICAgfCAgIDQgKy0KPiAgZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9n
ZW0uYyAgICAgIHwgIDE0ICstCj4gIGRyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZ2Vt
LmggICAgICB8ICAgMiArLQo+ICBkcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2dwdS5j
ICAgICAgfCAgMjQgKy0KPiAgZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9ncHUuaCAg
ICAgIHwgICAzICstCj4gIGRyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfaW9tbXUuYyAg
ICB8IDE1MCArKysrKystLS0tLS0KPiAgZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9p
b21tdS5oICAgIHwgIDIwIC0tCj4gIGRyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfaW9t
bXVfdjIuYyB8IDI2NCArKysrKysrKystLS0tLS0tLS0tLS0KPiAgZHJpdmVycy9ncHUvZHJtL2V0
bmF2aXYvZXRuYXZpdl9tbXUuYyAgICAgIHwgMjMxICsrKysrKysrKystLS0tLS0tLQo+ICBkcml2
ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X21tdS5oICAgICAgfCAgODggKysrKystLQo+ICAx
NCBmaWxlcyBjaGFuZ2VkLCA0MTYgaW5zZXJ0aW9ucygrKSwgNDA3IGRlbGV0aW9ucygtKQo+ICBk
ZWxldGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9pb21tdS5o
Cj4gCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfYnVmZmVy
LmMgYi9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2J1ZmZlci5jCj4gaW5kZXggZDUy
YzAxYzE5NWJkLi5lMTM0NzYzMGZhMTEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2V0
bmF2aXYvZXRuYXZpdl9idWZmZXIuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0
bmF2aXZfYnVmZmVyLmMKPiBAQCAtMjA1LDcgKzIwNSw3IEBAIHUxNiBldG5hdml2X2J1ZmZlcl9j
b25maWdfbW11djIoc3RydWN0IGV0bmF2aXZfZ3B1ICpncHUsIHUzMiBtdGxiX2FkZHIsIHUzMiBz
YWZlCj4gIAlyZXR1cm4gYnVmZmVyLT51c2VyX3NpemUgLyA4Owo+ICB9Cj4gIAo+IC11MTYgZXRu
YXZpdl9idWZmZXJfY29uZmlnX3B0YShzdHJ1Y3QgZXRuYXZpdl9ncHUgKmdwdSkKPiArdTE2IGV0
bmF2aXZfYnVmZmVyX2NvbmZpZ19wdGEoc3RydWN0IGV0bmF2aXZfZ3B1ICpncHUsIHVuc2lnbmVk
IHNob3J0IGlkKQo+ICB7Cj4gIAlzdHJ1Y3QgZXRuYXZpdl9jbWRidWYgKmJ1ZmZlciA9ICZncHUt
PmJ1ZmZlcjsKPiAgCj4gQEAgLTIxNCw3ICsyMTQsNyBAQCB1MTYgZXRuYXZpdl9idWZmZXJfY29u
ZmlnX3B0YShzdHJ1Y3QgZXRuYXZpdl9ncHUgKmdwdSkKPiAgCWJ1ZmZlci0+dXNlcl9zaXplID0g
MDsKPiAgCj4gIAlDTURfTE9BRF9TVEFURShidWZmZXIsIFZJVlNfTU1VdjJfUFRBX0NPTkZJRywK
PiAtCQkgICAgICAgVklWU19NTVV2Ml9QVEFfQ09ORklHX0lOREVYKDApKTsKPiArCQkgICAgICAg
VklWU19NTVV2Ml9QVEFfQ09ORklHX0lOREVYKGlkKSk7Cj4gIAo+ICAJQ01EX0VORChidWZmZXIp
Owo+ICAKPiBAQCAtMzM2LDcgKzMzNiw3IEBAIHZvaWQgZXRuYXZpdl9idWZmZXJfcXVldWUoc3Ry
dWN0IGV0bmF2aXZfZ3B1ICpncHUsIHUzMiBleGVjX3N0YXRlLAo+ICAKPiAgCQkvKiBmbHVzaCBj
b21tYW5kICovCj4gIAkJaWYgKG5lZWRfZmx1c2gpIHsKPiAtCQkJaWYgKGdwdS0+bW11LT52ZXJz
aW9uID09IEVUTkFWSVZfSU9NTVVfVjEpCj4gKwkJCWlmIChncHUtPm1tdS0+Z2xvYmFsLT52ZXJz
aW9uID09IEVUTkFWSVZfSU9NTVVfVjEpCj4gIAkJCQlleHRyYV9kd29yZHMgKz0gMTsKPiAgCQkJ
ZWxzZQo+ICAJCQkJZXh0cmFfZHdvcmRzICs9IDM7Cj4gQEAgLTM1MCw3ICszNTAsNyBAQCB2b2lk
IGV0bmF2aXZfYnVmZmVyX3F1ZXVlKHN0cnVjdCBldG5hdml2X2dwdSAqZ3B1LCB1MzIgZXhlY19z
dGF0ZSwKPiAgCj4gIAkJaWYgKG5lZWRfZmx1c2gpIHsKPiAgCQkJLyogQWRkIHRoZSBNTVUgZmx1
c2ggKi8KPiAtCQkJaWYgKGdwdS0+bW11LT52ZXJzaW9uID09IEVUTkFWSVZfSU9NTVVfVjEpIHsK
PiArCQkJaWYgKGdwdS0+bW11LT5nbG9iYWwtPnZlcnNpb24gPT0gRVROQVZJVl9JT01NVV9WMSkg
ewo+ICAJCQkJQ01EX0xPQURfU1RBVEUoYnVmZmVyLCBWSVZTX0dMX0ZMVVNIX01NVSwKPiAgCQkJ
CQkgICAgICAgVklWU19HTF9GTFVTSF9NTVVfRkxVU0hfRkVNTVUgfAo+ICAJCQkJCSAgICAgICBW
SVZTX0dMX0ZMVVNIX01NVV9GTFVTSF9VTksxIHwKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2V0bmF2aXYvZXRuYXZpdl9jbWRidWYuYyBiL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0
bmF2aXZfY21kYnVmLmMKPiBpbmRleCBhMDFhZTMyZGNkODguLjRkN2EyMzQxZTExYyAxMDA2NDQK
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2NtZGJ1Zi5jCj4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9jbWRidWYuYwo+IEBAIC01NywxOCArNTcs
MTggQEAgZXRuYXZpdl9jbWRidWZfc3ViYWxsb2NfbmV3KHN0cnVjdCBkZXZpY2UgKmRldikKPiAg
fQo+ICAKPiAgaW50IGV0bmF2aXZfY21kYnVmX3N1YmFsbG9jX21hcChzdHJ1Y3QgZXRuYXZpdl9j
bWRidWZfc3ViYWxsb2MgKnN1YmFsbG9jLAo+IC0JCQkJc3RydWN0IGV0bmF2aXZfaW9tbXUgKm1t
dSwKPiArCQkJCXN0cnVjdCBldG5hdml2X2lvbW11X2NvbnRleHQgKmNvbnRleHQsCj4gIAkJCQlz
dHJ1Y3QgZXRuYXZpdl92cmFtX21hcHBpbmcgKm1hcHBpbmcsCj4gIAkJCQl1MzIgbWVtb3J5X2Jh
c2UpCj4gIHsKPiAtCXJldHVybiBldG5hdml2X2lvbW11X2dldF9zdWJhbGxvY192YShtbXUsIG1h
cHBpbmcsIG1lbW9yeV9iYXNlLAo+ICsJcmV0dXJuIGV0bmF2aXZfaW9tbXVfZ2V0X3N1YmFsbG9j
X3ZhKGNvbnRleHQsIG1hcHBpbmcsIG1lbW9yeV9iYXNlLAo+ICAJCQkJCSAgICAgc3ViYWxsb2Mt
PnBhZGRyLCBTVUJBTExPQ19TSVpFKTsKPiAgfQo+ICAKPiAtdm9pZCBldG5hdml2X2NtZGJ1Zl9z
dWJhbGxvY191bm1hcChzdHJ1Y3QgZXRuYXZpdl9pb21tdSAqbW11LAo+ICt2b2lkIGV0bmF2aXZf
Y21kYnVmX3N1YmFsbG9jX3VubWFwKHN0cnVjdCBldG5hdml2X2lvbW11X2NvbnRleHQgKmNvbnRl
eHQsCj4gIAkJCQkgICBzdHJ1Y3QgZXRuYXZpdl92cmFtX21hcHBpbmcgKm1hcHBpbmcpCj4gIHsK
PiAtCWV0bmF2aXZfaW9tbXVfcHV0X3N1YmFsbG9jX3ZhKG1tdSwgbWFwcGluZyk7Cj4gKwlldG5h
dml2X2lvbW11X3B1dF9zdWJhbGxvY192YShjb250ZXh0LCBtYXBwaW5nKTsKPiAgfQo+ICAKPiAg
dm9pZCBldG5hdml2X2NtZGJ1Zl9zdWJhbGxvY19kZXN0cm95KHN0cnVjdCBldG5hdml2X2NtZGJ1
Zl9zdWJhbGxvYyAqc3ViYWxsb2MpCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9ldG5h
dml2L2V0bmF2aXZfY21kYnVmLmggYi9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2Nt
ZGJ1Zi5oCj4gaW5kZXggN2ZkYzJlM2ZlYTVmLi5iNTlkZmZiOGQ5NDAgMTAwNjQ0Cj4gLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9jbWRidWYuaAo+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9ldG5hdml2L2V0bmF2aXZfY21kYnVmLmgKPiBAQCAtOSw3ICs5LDcgQEAKPiAgI2lu
Y2x1ZGUgPGxpbnV4L3R5cGVzLmg+Cj4gIAo+ICBzdHJ1Y3QgZGV2aWNlOwo+IC1zdHJ1Y3QgZXRu
YXZpdl9pb21tdTsKPiArc3RydWN0IGV0bmF2aXZfaW9tbXVfY29udGV4dDsKPiAgc3RydWN0IGV0
bmF2aXZfdnJhbV9tYXBwaW5nOwo+ICBzdHJ1Y3QgZXRuYXZpdl9jbWRidWZfc3ViYWxsb2M7Cj4g
IAo+IEBAIC0yNywxMCArMjcsMTAgQEAgc3RydWN0IGV0bmF2aXZfY21kYnVmX3N1YmFsbG9jICoK
PiAgZXRuYXZpdl9jbWRidWZfc3ViYWxsb2NfbmV3KHN0cnVjdCBkZXZpY2UgKmRldik7Cj4gIHZv
aWQgZXRuYXZpdl9jbWRidWZfc3ViYWxsb2NfZGVzdHJveShzdHJ1Y3QgZXRuYXZpdl9jbWRidWZf
c3ViYWxsb2MgKnN1YmFsbG9jKTsKPiAgaW50IGV0bmF2aXZfY21kYnVmX3N1YmFsbG9jX21hcChz
dHJ1Y3QgZXRuYXZpdl9jbWRidWZfc3ViYWxsb2MgKnN1YmFsbG9jLAo+IC0JCQkJc3RydWN0IGV0
bmF2aXZfaW9tbXUgKm1tdSwKPiArCQkJCXN0cnVjdCBldG5hdml2X2lvbW11X2NvbnRleHQgKmNv
bnRleHQsCj4gIAkJCQlzdHJ1Y3QgZXRuYXZpdl92cmFtX21hcHBpbmcgKm1hcHBpbmcsCj4gIAkJ
CQl1MzIgbWVtb3J5X2Jhc2UpOwo+IC12b2lkIGV0bmF2aXZfY21kYnVmX3N1YmFsbG9jX3VubWFw
KHN0cnVjdCBldG5hdml2X2lvbW11ICptbXUsCj4gK3ZvaWQgZXRuYXZpdl9jbWRidWZfc3ViYWxs
b2NfdW5tYXAoc3RydWN0IGV0bmF2aXZfaW9tbXVfY29udGV4dCAqY29udGV4dCwKPiAgCQkJCSAg
IHN0cnVjdCBldG5hdml2X3ZyYW1fbWFwcGluZyAqbWFwcGluZyk7Cj4gIAo+ICAKPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9kcnYuYyBiL2RyaXZlcnMvZ3B1
L2RybS9ldG5hdml2L2V0bmF2aXZfZHJ2LmMKPiBpbmRleCAxMzgwMjViYzUzNzYuLmY4MDQzY2Iy
ZjBiYiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2Rydi5j
Cj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9kcnYuYwo+IEBAIC01NjIs
NiArNTYyLDcgQEAgc3RhdGljIHZvaWQgZXRuYXZpdl91bmJpbmQoc3RydWN0IGRldmljZSAqZGV2
KQo+ICAKPiAgCWNvbXBvbmVudF91bmJpbmRfYWxsKGRldiwgZHJtKTsKPiAgCj4gKwlldG5hdml2
X2lvbW11X2dsb2JhbF9maW5pKHByaXYtPm1tdV9nbG9iYWwpOwo+ICAJZXRuYXZpdl9jbWRidWZf
c3ViYWxsb2NfZGVzdHJveShwcml2LT5jbWRidWZfc3ViYWxsb2MpOwo+ICAKPiAgCWRldi0+ZG1h
X3Bhcm1zID0gTlVMTDsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRu
YXZpdl9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZHJ2LmgKPiBpbmRl
eCAwMjkxNzcxZTcyZmEuLjQ0OWEyMzZiYjAwZiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vZXRuYXZpdi9ldG5hdml2X2Rydi5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYv
ZXRuYXZpdl9kcnYuaAo+IEBAIC0zMSw2ICszMSw3IEBAIHN0cnVjdCBldG5hdml2X2dwdTsKPiAg
c3RydWN0IGV0bmF2aXZfbW11Owo+ICBzdHJ1Y3QgZXRuYXZpdl9nZW1fb2JqZWN0Owo+ICBzdHJ1
Y3QgZXRuYXZpdl9nZW1fc3VibWl0Owo+ICtzdHJ1Y3QgZXRuYXZpdl9pb21tdV9nbG9iYWw7Cj4g
IAo+ICBzdHJ1Y3QgZXRuYXZpdl9maWxlX3ByaXZhdGUgewo+ICAJLyoKPiBAQCAtNDYsNiArNDcs
NyBAQCBzdHJ1Y3QgZXRuYXZpdl9kcm1fcHJpdmF0ZSB7Cj4gIAlzdHJ1Y3QgZXRuYXZpdl9ncHUg
KmdwdVtFVE5BX01BWF9QSVBFU107Cj4gIAo+ICAJc3RydWN0IGV0bmF2aXZfY21kYnVmX3N1YmFs
bG9jICpjbWRidWZfc3ViYWxsb2M7Cj4gKwlzdHJ1Y3QgZXRuYXZpdl9pb21tdV9nbG9iYWwgKm1t
dV9nbG9iYWw7Cj4gIAo+ICAJLyogbGlzdCBvZiBHRU0gb2JqZWN0czogKi8KPiAgCXN0cnVjdCBt
dXRleCBnZW1fbG9jazsKPiBAQCAtNzksNyArODEsNyBAQCBpbnQgZXRuYXZpdl9nZW1fbmV3X3Vz
ZXJwdHIoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgc3RydWN0IGRybV9maWxlICpmaWxlLAo+ICAJ
dWludHB0cl90IHB0ciwgdTMyIHNpemUsIHUzMiBmbGFncywgdTMyICpoYW5kbGUpOwo+ICB1MTYg
ZXRuYXZpdl9idWZmZXJfaW5pdChzdHJ1Y3QgZXRuYXZpdl9ncHUgKmdwdSk7Cj4gIHUxNiBldG5h
dml2X2J1ZmZlcl9jb25maWdfbW11djIoc3RydWN0IGV0bmF2aXZfZ3B1ICpncHUsIHUzMiBtdGxi
X2FkZHIsIHUzMiBzYWZlX2FkZHIpOwo+IC11MTYgZXRuYXZpdl9idWZmZXJfY29uZmlnX3B0YShz
dHJ1Y3QgZXRuYXZpdl9ncHUgKmdwdSk7Cj4gK3UxNiBldG5hdml2X2J1ZmZlcl9jb25maWdfcHRh
KHN0cnVjdCBldG5hdml2X2dwdSAqZ3B1LCB1bnNpZ25lZCBzaG9ydCBpZCk7Cj4gIHZvaWQgZXRu
YXZpdl9idWZmZXJfZW5kKHN0cnVjdCBldG5hdml2X2dwdSAqZ3B1KTsKPiAgdm9pZCBldG5hdml2
X3N5bmNfcG9pbnRfcXVldWUoc3RydWN0IGV0bmF2aXZfZ3B1ICpncHUsIHVuc2lnbmVkIGludCBl
dmVudCk7Cj4gIHZvaWQgZXRuYXZpdl9idWZmZXJfcXVldWUoc3RydWN0IGV0bmF2aXZfZ3B1ICpn
cHUsIHUzMiBleGVjX3N0YXRlLAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vZXRuYXZp
di9ldG5hdml2X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9nZW0uYwo+
IGluZGV4IDVjNDg5MTVmNDkyZC4uNzZjMjZkOGY4ZDYzIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZ2VtLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vZXRu
YXZpdi9ldG5hdml2X2dlbS5jCj4gQEAgLTIyMiwxMiArMjIyLDEyIEBAIGludCBldG5hdml2X2dl
bV9tbWFwX29mZnNldChzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iaiwgdTY0ICpvZmZzZXQpCj4g
IAo+ICBzdGF0aWMgc3RydWN0IGV0bmF2aXZfdnJhbV9tYXBwaW5nICoKPiAgZXRuYXZpdl9nZW1f
Z2V0X3ZyYW1fbWFwcGluZyhzdHJ1Y3QgZXRuYXZpdl9nZW1fb2JqZWN0ICpvYmosCj4gLQkJCSAg
ICAgc3RydWN0IGV0bmF2aXZfaW9tbXUgKm1tdSkKPiArCQkJICAgICBzdHJ1Y3QgZXRuYXZpdl9p
b21tdV9jb250ZXh0ICpjb250ZXh0KQo+ICB7Cj4gIAlzdHJ1Y3QgZXRuYXZpdl92cmFtX21hcHBp
bmcgKm1hcHBpbmc7Cj4gIAo+ICAJbGlzdF9mb3JfZWFjaF9lbnRyeShtYXBwaW5nLCAmb2JqLT52
cmFtX2xpc3QsIG9ial9ub2RlKSB7Cj4gLQkJaWYgKG1hcHBpbmctPm1tdSA9PSBtbXUpCj4gKwkJ
aWYgKG1hcHBpbmctPmNvbnRleHQgPT0gY29udGV4dCkKPiAgCQkJcmV0dXJuIG1hcHBpbmc7Cj4g
IAl9Cj4gIAo+IEBAIC0yNzcsNyArMjc3LDcgQEAgc3RydWN0IGV0bmF2aXZfdnJhbV9tYXBwaW5n
ICpldG5hdml2X2dlbV9tYXBwaW5nX2dldCgKPiAgCQkgKi8KPiAgCQlpZiAobWFwcGluZy0+dXNl
ID09IDApIHsKPiAgCQkJbXV0ZXhfbG9jaygmZ3B1LT5tbXUtPmxvY2spOwo+IC0JCQlpZiAobWFw
cGluZy0+bW11ID09IGdwdS0+bW11KQo+ICsJCQlpZiAobWFwcGluZy0+Y29udGV4dCA9PSBncHUt
Pm1tdSkKPiAgCQkJCW1hcHBpbmctPnVzZSArPSAxOwo+ICAJCQllbHNlCj4gIAkJCQltYXBwaW5n
ID0gTlVMTDsKPiBAQCAtMzE0LDcgKzMxNCw3IEBAIHN0cnVjdCBldG5hdml2X3ZyYW1fbWFwcGlu
ZyAqZXRuYXZpdl9nZW1fbWFwcGluZ19nZXQoCj4gIAkJbGlzdF9kZWwoJm1hcHBpbmctPm9ial9u
b2RlKTsKPiAgCX0KPiAgCj4gLQltYXBwaW5nLT5tbXUgPSBncHUtPm1tdTsKPiArCW1hcHBpbmct
PmNvbnRleHQgPSBncHUtPm1tdTsKPiAgCW1hcHBpbmctPnVzZSA9IDE7Cj4gIAo+ICAJcmV0ID0g
ZXRuYXZpdl9pb21tdV9tYXBfZ2VtKGdwdS0+bW11LCBldG5hdml2X29iaiwgZ3B1LT5tZW1vcnlf
YmFzZSwKPiBAQCAtNTM2LDEyICs1MzYsMTIgQEAgdm9pZCBldG5hdml2X2dlbV9mcmVlX29iamVj
dChzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iaikKPiAgCj4gIAlsaXN0X2Zvcl9lYWNoX2VudHJ5
X3NhZmUobWFwcGluZywgdG1wLCAmZXRuYXZpdl9vYmotPnZyYW1fbGlzdCwKPiAgCQkJCSBvYmpf
bm9kZSkgewo+IC0JCXN0cnVjdCBldG5hdml2X2lvbW11ICptbXUgPSBtYXBwaW5nLT5tbXU7Cj4g
KwkJc3RydWN0IGV0bmF2aXZfaW9tbXVfY29udGV4dCAqY29udGV4dCA9IG1hcHBpbmctPmNvbnRl
eHQ7Cj4gIAo+ICAJCVdBUk5fT04obWFwcGluZy0+dXNlKTsKPiAgCj4gLQkJaWYgKG1tdSkKPiAt
CQkJZXRuYXZpdl9pb21tdV91bm1hcF9nZW0obW11LCBtYXBwaW5nKTsKPiArCQlpZiAoY29udGV4
dCkKPiArCQkJZXRuYXZpdl9pb21tdV91bm1hcF9nZW0oY29udGV4dCwgbWFwcGluZyk7Cj4gIAo+
ICAJCWxpc3RfZGVsKCZtYXBwaW5nLT5vYmpfbm9kZSk7Cj4gIAkJa2ZyZWUobWFwcGluZyk7Cj4g
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZ2VtLmggYi9kcml2
ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2dlbS5oCj4gaW5kZXggZjBhYmI3NDRlZjk1Li5j
Zjk0ZjBiMjQ1ODQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZp
dl9nZW0uaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZ2VtLmgKPiBA
QCAtMjUsNyArMjUsNyBAQCBzdHJ1Y3QgZXRuYXZpdl92cmFtX21hcHBpbmcgewo+ICAJc3RydWN0
IGxpc3RfaGVhZCBzY2FuX25vZGU7Cj4gIAlzdHJ1Y3QgbGlzdF9oZWFkIG1tdV9ub2RlOwo+ICAJ
c3RydWN0IGV0bmF2aXZfZ2VtX29iamVjdCAqb2JqZWN0Owo+IC0Jc3RydWN0IGV0bmF2aXZfaW9t
bXUgKm1tdTsKPiArCXN0cnVjdCBldG5hdml2X2lvbW11X2NvbnRleHQgKmNvbnRleHQ7Cj4gIAlz
dHJ1Y3QgZHJtX21tX25vZGUgdnJhbV9ub2RlOwo+ICAJdW5zaWduZWQgaW50IHVzZTsKPiAgCXUz
MiBpb3ZhOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2dw
dS5jIGIvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9ncHUuYwo+IGluZGV4IGE1ZWVk
MTRjZWM4ZC4uZGNmOWYxNzdjMTAzIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ldG5h
dml2L2V0bmF2aXZfZ3B1LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2
X2dwdS5jCj4gQEAgLTY3Nyw3ICs2NzcsNyBAQCBzdGF0aWMgdm9pZCBldG5hdml2X2dwdV9od19p
bml0KHN0cnVjdCBldG5hdml2X2dwdSAqZ3B1KQo+ICAJZXRuYXZpdl9ncHVfc2V0dXBfcHVsc2Vf
ZWF0ZXIoZ3B1KTsKPiAgCj4gIAkvKiBzZXR1cCB0aGUgTU1VICovCj4gLQlldG5hdml2X2lvbW11
X3Jlc3RvcmUoZ3B1KTsKPiArCWV0bmF2aXZfaW9tbXVfcmVzdG9yZShncHUsIGdwdS0+bW11KTsK
PiAgCj4gIAkvKiBTdGFydCBjb21tYW5kIHByb2Nlc3NvciAqLwo+ICAJcHJlZmV0Y2ggPSBldG5h
dml2X2J1ZmZlcl9pbml0KGdwdSk7Cj4gQEAgLTY4OSw2ICs2ODksNyBAQCBzdGF0aWMgdm9pZCBl
dG5hdml2X2dwdV9od19pbml0KHN0cnVjdCBldG5hdml2X2dwdSAqZ3B1KQo+ICAKPiAgaW50IGV0
bmF2aXZfZ3B1X2luaXQoc3RydWN0IGV0bmF2aXZfZHJtX3ByaXZhdGUgKnByaXYsIHN0cnVjdCBl
dG5hdml2X2dwdSAqZ3B1KQo+ICB7Cj4gKwllbnVtIGV0bmF2aXZfaW9tbXVfdmVyc2lvbiBtbXVf
dmVyc2lvbiA9IEVUTkFWSVZfSU9NTVVfVjE7Cj4gIAlpbnQgcmV0LCBpOwo+ICAKPiAgCXJldCA9
IHBtX3J1bnRpbWVfZ2V0X3N5bmMoZ3B1LT5kZXYpOwo+IEBAIC03NDksNyArNzUwLDIwIEBAIGlu
dCBldG5hdml2X2dwdV9pbml0KHN0cnVjdCBldG5hdml2X2RybV9wcml2YXRlICpwcml2LCBzdHJ1
Y3QgZXRuYXZpdl9ncHUgKmdwdSkKPiAgCQlnb3RvIGZhaWw7Cj4gIAl9Cj4gIAo+IC0JZ3B1LT5t
bXUgPSBldG5hdml2X2lvbW11X25ldyhncHUpOwo+ICsJaWYgKGdwdS0+aWRlbnRpdHkubWlub3Jf
ZmVhdHVyZXMxICYgY2hpcE1pbm9yRmVhdHVyZXMxX01NVV9WRVJTSU9OKQo+ICsJCW1tdV92ZXJz
aW9uID0gRVROQVZJVl9JT01NVV9WMjsKPiArCj4gKwlpZiAoIXByaXYtPm1tdV9nbG9iYWwpCj4g
KwkJcHJpdi0+bW11X2dsb2JhbCA9IGV0bmF2aXZfaW9tbXVfZ2xvYmFsX2luaXQoZ3B1LT5kcm0t
PmRldiwKPiArCQkJCQkJCSAgICAgbW11X3ZlcnNpb24pOwo+ICsKPiArCWlmICghcHJpdi0+bW11
X2dsb2JhbCB8fCBwcml2LT5tbXVfZ2xvYmFsLT52ZXJzaW9uICE9IG1tdV92ZXJzaW9uKSB7Cj4g
KwkJcmV0ID0gLUVOWElPOwo+ICsJCWRldl9lcnIoZ3B1LT5kZXYsICJmYWlsZWQgdG8gaW5pdCBJ
T01NVSBnbG9iYWwgc3RhdGVcbiIpOwo+ICsJCWdvdG8gZmFpbDsKPiArCX0KPiArCj4gKwlncHUt
Pm1tdSA9IGV0bmF2aXZfaW9tbXVfY29udGV4dF9pbml0KHByaXYtPm1tdV9nbG9iYWwpOwo+ICAJ
aWYgKElTX0VSUihncHUtPm1tdSkpIHsKPiAgCQlkZXZfZXJyKGdwdS0+ZGV2LCAiRmFpbGVkIHRv
IGluc3RhbnRpYXRlIEdQVSBJT01NVVxuIik7Cj4gIAkJcmV0ID0gUFRSX0VSUihncHUtPm1tdSk7
Cj4gQEAgLTc3Miw3ICs3ODYsNyBAQCBpbnQgZXRuYXZpdl9ncHVfaW5pdChzdHJ1Y3QgZXRuYXZp
dl9kcm1fcHJpdmF0ZSAqcHJpdiwgc3RydWN0IGV0bmF2aXZfZ3B1ICpncHUpCj4gIAkJZ290byB1
bm1hcF9zdWJhbGxvYzsKPiAgCX0KPiAgCj4gLQlpZiAoZ3B1LT5tbXUtPnZlcnNpb24gPT0gRVRO
QVZJVl9JT01NVV9WMSAmJgo+ICsJaWYgKG1tdV92ZXJzaW9uID09IEVUTkFWSVZfSU9NTVVfVjEg
JiYKPiAgCSAgICBldG5hdml2X2NtZGJ1Zl9nZXRfdmEoJmdwdS0+YnVmZmVyLCAmZ3B1LT5jbWRi
dWZfbWFwcGluZykgPiAweDgwMDAwMDAwKSB7Cj4gIAkJcmV0ID0gLUVJTlZBTDsKPiAgCQlkZXZf
ZXJyKGdwdS0+ZGV2LAo+IEBAIC04MDQsNyArODE4LDcgQEAgaW50IGV0bmF2aXZfZ3B1X2luaXQo
c3RydWN0IGV0bmF2aXZfZHJtX3ByaXZhdGUgKnByaXYsIHN0cnVjdCBldG5hdml2X2dwdSAqZ3B1
KQo+ICB1bm1hcF9zdWJhbGxvYzoKPiAgCWV0bmF2aXZfY21kYnVmX3N1YmFsbG9jX3VubWFwKGdw
dS0+bW11LCAmZ3B1LT5jbWRidWZfbWFwcGluZyk7Cj4gIGRlc3Ryb3lfaW9tbXU6Cj4gLQlldG5h
dml2X2lvbW11X2Rlc3Ryb3koZ3B1LT5tbXUpOwo+ICsJZXRuYXZpdl9pb21tdV9jb250ZXh0X3B1
dChncHUtPm1tdSk7Cj4gIAlncHUtPm1tdSA9IE5VTEw7Cj4gIGZhaWw6Cj4gIAlwbV9ydW50aW1l
X21hcmtfbGFzdF9idXN5KGdwdS0+ZGV2KTsKPiBAQCAtMTY4Myw3ICsxNjk3LDcgQEAgc3RhdGlj
IHZvaWQgZXRuYXZpdl9ncHVfdW5iaW5kKHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRldmlj
ZSAqbWFzdGVyLAo+ICAJCWV0bmF2aXZfY21kYnVmX3N1YmFsbG9jX3VubWFwKGdwdS0+bW11LCAm
Z3B1LT5jbWRidWZfbWFwcGluZyk7Cj4gIAo+ICAJaWYgKGdwdS0+bW11KSB7Cj4gLQkJZXRuYXZp
dl9pb21tdV9kZXN0cm95KGdwdS0+bW11KTsKPiArCQlldG5hdml2X2lvbW11X2NvbnRleHRfcHV0
KGdwdS0+bW11KTsKPiAgCQlncHUtPm1tdSA9IE5VTEw7Cj4gIAl9Cj4gIAo+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2dwdS5oIGIvZHJpdmVycy9ncHUvZHJt
L2V0bmF2aXYvZXRuYXZpdl9ncHUuaAo+IGluZGV4IDlhYjBiNDU0OGU1NS4uNTBmMDNlZTU1NTAw
IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZ3B1LmgKPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2dwdS5oCj4gQEAgLTgsNiArOCw3
IEBACj4gIAo+ICAjaW5jbHVkZSAiZXRuYXZpdl9jbWRidWYuaCIKPiAgI2luY2x1ZGUgImV0bmF2
aXZfZ2VtLmgiCj4gKyNpbmNsdWRlICJldG5hdml2X21tdS5oIgo+ICAjaW5jbHVkZSAiZXRuYXZp
dl9kcnYuaCIKPiAgCj4gIHN0cnVjdCBldG5hdml2X2dlbV9zdWJtaXQ7Cj4gQEAgLTEzNSw3ICsx
MzYsNyBAQCBzdHJ1Y3QgZXRuYXZpdl9ncHUgewo+ICAJdm9pZCBfX2lvbWVtICptbWlvOwo+ICAJ
aW50IGlycTsKPiAgCj4gLQlzdHJ1Y3QgZXRuYXZpdl9pb21tdSAqbW11Owo+ICsJc3RydWN0IGV0
bmF2aXZfaW9tbXVfY29udGV4dCAqbW11Owo+ICAJdW5zaWduZWQgaW50IGZsdXNoX3NlcTsKPiAg
Cj4gIAkvKiBQb3dlciBDb250cm9sOiAqLwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
ZXRuYXZpdi9ldG5hdml2X2lvbW11LmMgYi9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2
X2lvbW11LmMKPiBpbmRleCBiMTYzYmRiY2I4ODAuLmM5M2FhMGIxYWQ5ZSAxMDA2NDQKPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2lvbW11LmMKPiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2lvbW11LmMKPiBAQCAtMTEsNyArMTEsNiBAQAo+ICAK
PiAgI2luY2x1ZGUgImV0bmF2aXZfZ3B1LmgiCj4gICNpbmNsdWRlICJldG5hdml2X21tdS5oIgo+
IC0jaW5jbHVkZSAiZXRuYXZpdl9pb21tdS5oIgo+ICAjaW5jbHVkZSAic3RhdGVfaGkueG1sLmgi
Cj4gIAo+ICAjZGVmaW5lIFBUX1NJWkUJCVNaXzJNCj4gQEAgLTE5LDExMyArMTgsNzggQEAKPiAg
Cj4gICNkZWZpbmUgR1BVX01FTV9TVEFSVAkweDgwMDAwMDAwCj4gIAo+IC1zdHJ1Y3QgZXRuYXZp
dl9pb21tdXYxX2RvbWFpbiB7Cj4gLQlzdHJ1Y3QgZXRuYXZpdl9pb21tdV9kb21haW4gYmFzZTsK
PiArc3RydWN0IGV0bmF2aXZfaW9tbXV2MV9jb250ZXh0IHsKPiArCXN0cnVjdCBldG5hdml2X2lv
bW11X2NvbnRleHQgYmFzZTsKPiAgCXUzMiAqcGd0YWJsZV9jcHU7Cj4gIAlkbWFfYWRkcl90IHBn
dGFibGVfZG1hOwo+ICB9Owo+ICAKPiAtc3RhdGljIHN0cnVjdCBldG5hdml2X2lvbW11djFfZG9t
YWluICoKPiAtdG9fZXRuYXZpdl9kb21haW4oc3RydWN0IGV0bmF2aXZfaW9tbXVfZG9tYWluICpk
b21haW4pCj4gK3N0YXRpYyBzdHJ1Y3QgZXRuYXZpdl9pb21tdXYxX2NvbnRleHQgKgo+ICt0b192
MV9jb250ZXh0KHN0cnVjdCBldG5hdml2X2lvbW11X2NvbnRleHQgKmNvbnRleHQpCj4gIHsKPiAt
CXJldHVybiBjb250YWluZXJfb2YoZG9tYWluLCBzdHJ1Y3QgZXRuYXZpdl9pb21tdXYxX2RvbWFp
biwgYmFzZSk7Cj4gKwlyZXR1cm4gY29udGFpbmVyX29mKGNvbnRleHQsIHN0cnVjdCBldG5hdml2
X2lvbW11djFfY29udGV4dCwgYmFzZSk7Cj4gIH0KPiAgCj4gLXN0YXRpYyBpbnQgX19ldG5hdml2
X2lvbW11X2luaXQoc3RydWN0IGV0bmF2aXZfaW9tbXV2MV9kb21haW4gKmV0bmF2aXZfZG9tYWlu
KQo+ICtzdGF0aWMgdm9pZCBldG5hdml2X2lvbW11djFfZnJlZShzdHJ1Y3QgZXRuYXZpdl9pb21t
dV9jb250ZXh0ICpjb250ZXh0KQo+ICB7Cj4gLQl1MzIgKnA7Cj4gLQlpbnQgaTsKPiAtCj4gLQll
dG5hdml2X2RvbWFpbi0+YmFzZS5iYWRfcGFnZV9jcHUgPQo+IC0JCQlkbWFfYWxsb2Nfd2MoZXRu
YXZpdl9kb21haW4tPmJhc2UuZGV2LCBTWl80SywKPiAtCQkJCSAgICAgJmV0bmF2aXZfZG9tYWlu
LT5iYXNlLmJhZF9wYWdlX2RtYSwKPiAtCQkJCSAgICAgR0ZQX0tFUk5FTCk7Cj4gLQlpZiAoIWV0
bmF2aXZfZG9tYWluLT5iYXNlLmJhZF9wYWdlX2NwdSkKPiAtCQlyZXR1cm4gLUVOT01FTTsKPiAt
Cj4gLQlwID0gZXRuYXZpdl9kb21haW4tPmJhc2UuYmFkX3BhZ2VfY3B1Owo+IC0JZm9yIChpID0g
MDsgaSA8IFNaXzRLIC8gNDsgaSsrKQo+IC0JCSpwKysgPSAweGRlYWQ1NWFhOwo+IC0KPiAtCWV0
bmF2aXZfZG9tYWluLT5wZ3RhYmxlX2NwdSA9IGRtYV9hbGxvY193YyhldG5hdml2X2RvbWFpbi0+
YmFzZS5kZXYsCj4gLQkJCQkJCSAgIFBUX1NJWkUsCj4gLQkJCQkJCSAgICZldG5hdml2X2RvbWFp
bi0+cGd0YWJsZV9kbWEsCj4gLQkJCQkJCSAgIEdGUF9LRVJORUwpOwo+IC0JaWYgKCFldG5hdml2
X2RvbWFpbi0+cGd0YWJsZV9jcHUpIHsKPiAtCQlkbWFfZnJlZV93YyhldG5hdml2X2RvbWFpbi0+
YmFzZS5kZXYsIFNaXzRLLAo+IC0JCQkgICAgZXRuYXZpdl9kb21haW4tPmJhc2UuYmFkX3BhZ2Vf
Y3B1LAo+IC0JCQkgICAgZXRuYXZpdl9kb21haW4tPmJhc2UuYmFkX3BhZ2VfZG1hKTsKPiAtCQly
ZXR1cm4gLUVOT01FTTsKPiAtCX0KPiAtCj4gLQltZW1zZXQzMihldG5hdml2X2RvbWFpbi0+cGd0
YWJsZV9jcHUsIGV0bmF2aXZfZG9tYWluLT5iYXNlLmJhZF9wYWdlX2RtYSwKPiAtCQkgUFRfRU5U
UklFUyk7Cj4gLQo+IC0JcmV0dXJuIDA7Cj4gLX0KPiArCXN0cnVjdCBldG5hdml2X2lvbW11djFf
Y29udGV4dCAqdjFfY29udGV4dCA9IHRvX3YxX2NvbnRleHQoY29udGV4dCk7Cj4gIAo+IC1zdGF0
aWMgdm9pZCBldG5hdml2X2lvbW11djFfZG9tYWluX2ZyZWUoc3RydWN0IGV0bmF2aXZfaW9tbXVf
ZG9tYWluICpkb21haW4pCj4gLXsKPiAtCXN0cnVjdCBldG5hdml2X2lvbW11djFfZG9tYWluICpl
dG5hdml2X2RvbWFpbiA9Cj4gLQkJCXRvX2V0bmF2aXZfZG9tYWluKGRvbWFpbik7Cj4gKwlkcm1f
bW1fdGFrZWRvd24oJmNvbnRleHQtPm1tKTsKPiAgCj4gLQlkbWFfZnJlZV93YyhldG5hdml2X2Rv
bWFpbi0+YmFzZS5kZXYsIFBUX1NJWkUsCj4gLQkJICAgIGV0bmF2aXZfZG9tYWluLT5wZ3RhYmxl
X2NwdSwgZXRuYXZpdl9kb21haW4tPnBndGFibGVfZG1hKTsKPiArCWRtYV9mcmVlX3djKGNvbnRl
eHQtPmdsb2JhbC0+ZGV2LCBQVF9TSVpFLCB2MV9jb250ZXh0LT5wZ3RhYmxlX2NwdSwKPiArCQkg
ICAgdjFfY29udGV4dC0+cGd0YWJsZV9kbWEpOwo+ICAKPiAtCWRtYV9mcmVlX3djKGV0bmF2aXZf
ZG9tYWluLT5iYXNlLmRldiwgU1pfNEssCj4gLQkJICAgIGV0bmF2aXZfZG9tYWluLT5iYXNlLmJh
ZF9wYWdlX2NwdSwKPiAtCQkgICAgZXRuYXZpdl9kb21haW4tPmJhc2UuYmFkX3BhZ2VfZG1hKTsK
PiArCWNvbnRleHQtPmdsb2JhbC0+djEuc2hhcmVkX2NvbnRleHQgPSBOVUxMOwo+ICAKPiAtCWtm
cmVlKGV0bmF2aXZfZG9tYWluKTsKPiArCWtmcmVlKHYxX2NvbnRleHQpOwo+ICB9Cj4gIAo+IC1z
dGF0aWMgaW50IGV0bmF2aXZfaW9tbXV2MV9tYXAoc3RydWN0IGV0bmF2aXZfaW9tbXVfZG9tYWlu
ICpkb21haW4sCj4gK3N0YXRpYyBpbnQgZXRuYXZpdl9pb21tdXYxX21hcChzdHJ1Y3QgZXRuYXZp
dl9pb21tdV9jb250ZXh0ICpjb250ZXh0LAo+ICAJCQkgICAgICAgdW5zaWduZWQgbG9uZyBpb3Zh
LCBwaHlzX2FkZHJfdCBwYWRkciwKPiAgCQkJICAgICAgIHNpemVfdCBzaXplLCBpbnQgcHJvdCkK
PiAgewo+IC0Jc3RydWN0IGV0bmF2aXZfaW9tbXV2MV9kb21haW4gKmV0bmF2aXZfZG9tYWluID0g
dG9fZXRuYXZpdl9kb21haW4oZG9tYWluKTsKPiArCXN0cnVjdCBldG5hdml2X2lvbW11djFfY29u
dGV4dCAqdjFfY29udGV4dCA9IHRvX3YxX2NvbnRleHQoY29udGV4dCk7Cj4gIAl1bnNpZ25lZCBp
bnQgaW5kZXggPSAoaW92YSAtIEdQVV9NRU1fU1RBUlQpIC8gU1pfNEs7Cj4gIAo+ICAJaWYgKHNp
emUgIT0gU1pfNEspCj4gIAkJcmV0dXJuIC1FSU5WQUw7Cj4gIAo+IC0JZXRuYXZpdl9kb21haW4t
PnBndGFibGVfY3B1W2luZGV4XSA9IHBhZGRyOwo+ICsJdjFfY29udGV4dC0+cGd0YWJsZV9jcHVb
aW5kZXhdID0gcGFkZHI7Cj4gIAo+ICAJcmV0dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBzaXpl
X3QgZXRuYXZpdl9pb21tdXYxX3VubWFwKHN0cnVjdCBldG5hdml2X2lvbW11X2RvbWFpbiAqZG9t
YWluLAo+ICtzdGF0aWMgc2l6ZV90IGV0bmF2aXZfaW9tbXV2MV91bm1hcChzdHJ1Y3QgZXRuYXZp
dl9pb21tdV9jb250ZXh0ICpjb250ZXh0LAo+ICAJdW5zaWduZWQgbG9uZyBpb3ZhLCBzaXplX3Qg
c2l6ZSkKPiAgewo+IC0Jc3RydWN0IGV0bmF2aXZfaW9tbXV2MV9kb21haW4gKmV0bmF2aXZfZG9t
YWluID0KPiAtCQkJdG9fZXRuYXZpdl9kb21haW4oZG9tYWluKTsKPiArCXN0cnVjdCBldG5hdml2
X2lvbW11djFfY29udGV4dCAqdjFfY29udGV4dCA9IHRvX3YxX2NvbnRleHQoY29udGV4dCk7Cj4g
IAl1bnNpZ25lZCBpbnQgaW5kZXggPSAoaW92YSAtIEdQVV9NRU1fU1RBUlQpIC8gU1pfNEs7Cj4g
IAo+ICAJaWYgKHNpemUgIT0gU1pfNEspCj4gIAkJcmV0dXJuIC1FSU5WQUw7Cj4gIAo+IC0JZXRu
YXZpdl9kb21haW4tPnBndGFibGVfY3B1W2luZGV4XSA9IGV0bmF2aXZfZG9tYWluLT5iYXNlLmJh
ZF9wYWdlX2RtYTsKPiArCXYxX2NvbnRleHQtPnBndGFibGVfY3B1W2luZGV4XSA9IGNvbnRleHQt
Pmdsb2JhbC0+YmFkX3BhZ2VfZG1hOwo+ICAKPiAgCXJldHVybiBTWl80SzsKPiAgfQo+ICAKPiAt
c3RhdGljIHNpemVfdCBldG5hdml2X2lvbW11djFfZHVtcF9zaXplKHN0cnVjdCBldG5hdml2X2lv
bW11X2RvbWFpbiAqZG9tYWluKQo+ICtzdGF0aWMgc2l6ZV90IGV0bmF2aXZfaW9tbXV2MV9kdW1w
X3NpemUoc3RydWN0IGV0bmF2aXZfaW9tbXVfY29udGV4dCAqY29udGV4dCkKPiAgewo+ICAJcmV0
dXJuIFBUX1NJWkU7Cj4gIH0KPiAgCj4gLXN0YXRpYyB2b2lkIGV0bmF2aXZfaW9tbXV2MV9kdW1w
KHN0cnVjdCBldG5hdml2X2lvbW11X2RvbWFpbiAqZG9tYWluLCB2b2lkICpidWYpCj4gK3N0YXRp
YyB2b2lkIGV0bmF2aXZfaW9tbXV2MV9kdW1wKHN0cnVjdCBldG5hdml2X2lvbW11X2NvbnRleHQg
KmNvbnRleHQsCj4gKwkJCQkgdm9pZCAqYnVmKQo+ICB7Cj4gLQlzdHJ1Y3QgZXRuYXZpdl9pb21t
dXYxX2RvbWFpbiAqZXRuYXZpdl9kb21haW4gPQo+IC0JCQl0b19ldG5hdml2X2RvbWFpbihkb21h
aW4pOwo+ICsJc3RydWN0IGV0bmF2aXZfaW9tbXV2MV9jb250ZXh0ICp2MV9jb250ZXh0ID0gdG9f
djFfY29udGV4dChjb250ZXh0KTsKPiAgCj4gLQltZW1jcHkoYnVmLCBldG5hdml2X2RvbWFpbi0+
cGd0YWJsZV9jcHUsIFBUX1NJWkUpOwo+ICsJbWVtY3B5KGJ1ZiwgdjFfY29udGV4dC0+cGd0YWJs
ZV9jcHUsIFBUX1NJWkUpOwo+ICB9Cj4gIAo+IC12b2lkIGV0bmF2aXZfaW9tbXV2MV9yZXN0b3Jl
KHN0cnVjdCBldG5hdml2X2dwdSAqZ3B1KQo+ICtzdGF0aWMgdm9pZCBldG5hdml2X2lvbW11djFf
cmVzdG9yZShzdHJ1Y3QgZXRuYXZpdl9ncHUgKmdwdSwKPiArCQkJICAgICBzdHJ1Y3QgZXRuYXZp
dl9pb21tdV9jb250ZXh0ICpjb250ZXh0KQo+ICB7Cj4gLQlzdHJ1Y3QgZXRuYXZpdl9pb21tdXYx
X2RvbWFpbiAqZXRuYXZpdl9kb21haW4gPQo+IC0JCQl0b19ldG5hdml2X2RvbWFpbihncHUtPm1t
dS0+ZG9tYWluKTsKPiArCXN0cnVjdCBldG5hdml2X2lvbW11djFfY29udGV4dCAqdjFfY29udGV4
dCA9IHRvX3YxX2NvbnRleHQoY29udGV4dCk7Cj4gIAl1MzIgcGd0YWJsZTsKPiAgCj4gIAkvKiBz
ZXQgYmFzZSBhZGRyZXNzZXMgKi8KPiBAQCAtMTM2LDcgKzEwMCw3IEBAIHZvaWQgZXRuYXZpdl9p
b21tdXYxX3Jlc3RvcmUoc3RydWN0IGV0bmF2aXZfZ3B1ICpncHUpCj4gIAlncHVfd3JpdGUoZ3B1
LCBWSVZTX01DX01FTU9SWV9CQVNFX0FERFJfUEUsIGdwdS0+bWVtb3J5X2Jhc2UpOwo+ICAKPiAg
CS8qIHNldCBwYWdlIHRhYmxlIGFkZHJlc3MgaW4gTUMgKi8KPiAtCXBndGFibGUgPSAodTMyKWV0
bmF2aXZfZG9tYWluLT5wZ3RhYmxlX2RtYTsKPiArCXBndGFibGUgPSAodTMyKXYxX2NvbnRleHQt
PnBndGFibGVfZG1hOwo+ICAKPiAgCWdwdV93cml0ZShncHUsIFZJVlNfTUNfTU1VX0ZFX1BBR0Vf
VEFCTEUsIHBndGFibGUpOwo+ICAJZ3B1X3dyaXRlKGdwdSwgVklWU19NQ19NTVVfVFhfUEFHRV9U
QUJMRSwgcGd0YWJsZSk7Cj4gQEAgLTE0NSwzOSArMTA5LDYxIEBAIHZvaWQgZXRuYXZpdl9pb21t
dXYxX3Jlc3RvcmUoc3RydWN0IGV0bmF2aXZfZ3B1ICpncHUpCj4gIAlncHVfd3JpdGUoZ3B1LCBW
SVZTX01DX01NVV9SQV9QQUdFX1RBQkxFLCBwZ3RhYmxlKTsKPiAgfQo+ICAKPiAtc3RhdGljIGNv
bnN0IHN0cnVjdCBldG5hdml2X2lvbW11X2RvbWFpbl9vcHMgZXRuYXZpdl9pb21tdXYxX29wcyA9
IHsKPiAtCS5mcmVlID0gZXRuYXZpdl9pb21tdXYxX2RvbWFpbl9mcmVlLAo+ICsKPiArY29uc3Qg
c3RydWN0IGV0bmF2aXZfaW9tbXVfb3BzIGV0bmF2aXZfaW9tbXV2MV9vcHMgPSB7Cj4gKwkuZnJl
ZSA9IGV0bmF2aXZfaW9tbXV2MV9mcmVlLAo+ICAJLm1hcCA9IGV0bmF2aXZfaW9tbXV2MV9tYXAs
Cj4gIAkudW5tYXAgPSBldG5hdml2X2lvbW11djFfdW5tYXAsCj4gIAkuZHVtcF9zaXplID0gZXRu
YXZpdl9pb21tdXYxX2R1bXBfc2l6ZSwKPiAgCS5kdW1wID0gZXRuYXZpdl9pb21tdXYxX2R1bXAs
Cj4gKwkucmVzdG9yZSA9IGV0bmF2aXZfaW9tbXV2MV9yZXN0b3JlLAo+ICB9Owo+ICAKPiAtc3Ry
dWN0IGV0bmF2aXZfaW9tbXVfZG9tYWluICoKPiAtZXRuYXZpdl9pb21tdXYxX2RvbWFpbl9hbGxv
YyhzdHJ1Y3QgZXRuYXZpdl9ncHUgKmdwdSkKPiArc3RydWN0IGV0bmF2aXZfaW9tbXVfY29udGV4
dCAqCj4gK2V0bmF2aXZfaW9tbXV2MV9jb250ZXh0X2FsbG9jKHN0cnVjdCBldG5hdml2X2lvbW11
X2dsb2JhbCAqZ2xvYmFsKQo+ICB7Cj4gLQlzdHJ1Y3QgZXRuYXZpdl9pb21tdXYxX2RvbWFpbiAq
ZXRuYXZpdl9kb21haW47Cj4gLQlzdHJ1Y3QgZXRuYXZpdl9pb21tdV9kb21haW4gKmRvbWFpbjsK
PiAtCWludCByZXQ7Cj4gKwlzdHJ1Y3QgZXRuYXZpdl9pb21tdXYxX2NvbnRleHQgKnYxX2NvbnRl
eHQ7Cj4gKwlzdHJ1Y3QgZXRuYXZpdl9pb21tdV9jb250ZXh0ICpjb250ZXh0Owo+ICsKPiArCW11
dGV4X2xvY2soJmdsb2JhbC0+bG9jayk7Cj4gKwo+ICsJLyogTU1VdjEgZG9lcyBub3Qgc3VwcG9y
dCBzd2l0Y2hpbmcgYmV0d2VlbiBkaWZmZXJlbnQgY29udGV4dHMgd2l0aG91dAo+ICsJICogYSBz
dG9wIHRoZSB3b3JsZCBvcGVyYXRpb24sIHNvIHdlIG9ubHkgc3VwcG9ydCBhIHNpbmdsZSBzaGFy
ZWQKPiArCSAqIGNvbnRleHQgd2l0aCB0aGlzIHZlcnNpb24uCj4gKwkgKi8KPiArCWlmIChnbG9i
YWwtPnYxLnNoYXJlZF9jb250ZXh0KSB7Cj4gKwkJY29udGV4dCA9IGdsb2JhbC0+djEuc2hhcmVk
X2NvbnRleHQ7Cj4gKwkJZXRuYXZpdl9pb21tdV9jb250ZXh0X2dldChjb250ZXh0KTsKPiArCQlt
dXRleF91bmxvY2soJmdsb2JhbC0+bG9jayk7Cj4gKwkJcmV0dXJuIGNvbnRleHQ7Cj4gKwl9Cj4g
IAo+IC0JZXRuYXZpdl9kb21haW4gPSBremFsbG9jKHNpemVvZigqZXRuYXZpdl9kb21haW4pLCBH
RlBfS0VSTkVMKTsKPiAtCWlmICghZXRuYXZpdl9kb21haW4pCj4gKwl2MV9jb250ZXh0ID0ga3ph
bGxvYyhzaXplb2YoKnYxX2NvbnRleHQpLCBHRlBfS0VSTkVMKTsKPiArCWlmICghdjFfY29udGV4
dCkKPiAgCQlyZXR1cm4gTlVMTDsKPiAgCj4gLQlkb21haW4gPSAmZXRuYXZpdl9kb21haW4tPmJh
c2U7Cj4gKwl2MV9jb250ZXh0LT5wZ3RhYmxlX2NwdSA9IGRtYV9hbGxvY193YyhnbG9iYWwtPmRl
diwgUFRfU0laRSwKPiArCQkJCQkgICAgICAgJnYxX2NvbnRleHQtPnBndGFibGVfZG1hLAo+ICsJ
CQkJCSAgICAgICBHRlBfS0VSTkVMKTsKPiArCWlmICghdjFfY29udGV4dC0+cGd0YWJsZV9jcHUp
Cj4gKwkJZ290byBvdXRfZnJlZTsKPiAgCj4gLQlkb21haW4tPmRldiA9IGdwdS0+ZGV2Owo+IC0J
ZG9tYWluLT5iYXNlID0gR1BVX01FTV9TVEFSVDsKPiAtCWRvbWFpbi0+c2l6ZSA9IFBUX0VOVFJJ
RVMgKiBTWl80SzsKPiAtCWRvbWFpbi0+b3BzID0gJmV0bmF2aXZfaW9tbXV2MV9vcHM7Cj4gKwlt
ZW1zZXQzMih2MV9jb250ZXh0LT5wZ3RhYmxlX2NwdSwgZ2xvYmFsLT5iYWRfcGFnZV9kbWEsIFBU
X0VOVFJJRVMpOwo+ICAKPiAtCXJldCA9IF9fZXRuYXZpdl9pb21tdV9pbml0KGV0bmF2aXZfZG9t
YWluKTsKPiAtCWlmIChyZXQpCj4gLQkJZ290byBvdXRfZnJlZTsKPiArCWNvbnRleHQgPSAmdjFf
Y29udGV4dC0+YmFzZTsKPiArCWNvbnRleHQtPmdsb2JhbCA9IGdsb2JhbDsKPiArCWtyZWZfaW5p
dCgmY29udGV4dC0+cmVmY291bnQpOwo+ICsJbXV0ZXhfaW5pdCgmY29udGV4dC0+bG9jayk7Cj4g
KwlJTklUX0xJU1RfSEVBRCgmY29udGV4dC0+bWFwcGluZ3MpOwo+ICsJZHJtX21tX2luaXQoJmNv
bnRleHQtPm1tLCBHUFVfTUVNX1NUQVJULCBQVF9FTlRSSUVTICogU1pfNEspOwo+ICsJY29udGV4
dC0+Z2xvYmFsLT52MS5zaGFyZWRfY29udGV4dCA9IGNvbnRleHQ7Cj4gKwo+ICsJbXV0ZXhfdW5s
b2NrKCZnbG9iYWwtPmxvY2spOwo+ICAKPiAtCXJldHVybiAmZXRuYXZpdl9kb21haW4tPmJhc2U7
Cj4gKwlyZXR1cm4gY29udGV4dDsKPiAgCj4gIG91dF9mcmVlOgo+IC0Ja2ZyZWUoZXRuYXZpdl9k
b21haW4pOwo+ICsJbXV0ZXhfdW5sb2NrKCZnbG9iYWwtPmxvY2spOwo+ICsJa2ZyZWUodjFfY29u
dGV4dCk7Cj4gIAlyZXR1cm4gTlVMTDsKPiAgfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vZXRuYXZpdi9ldG5hdml2X2lvbW11LmggYi9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5h
dml2X2lvbW11LmgKPiBkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRleCBiMjc5NDA0Y2U5
MWEuLjAwMDAwMDAwMDAwMAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZf
aW9tbXUuaAo+ICsrKyAvZGV2L251bGwKPiBAQCAtMSwyMCArMCwwIEBACj4gLS8qIFNQRFgtTGlj
ZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovCj4gLS8qCj4gLSAqIENvcHlyaWdodCAoQykgMjAx
NC0yMDE4IEV0bmF2aXYgUHJvamVjdAo+IC0gKi8KPiAtCj4gLSNpZm5kZWYgX19FVE5BVklWX0lP
TU1VX0hfXwo+IC0jZGVmaW5lIF9fRVROQVZJVl9JT01NVV9IX18KPiAtCj4gLXN0cnVjdCBldG5h
dml2X2dwdTsKPiAtc3RydWN0IGV0bmF2aXZfaW9tbXVfZG9tYWluOwo+IC0KPiAtc3RydWN0IGV0
bmF2aXZfaW9tbXVfZG9tYWluICoKPiAtZXRuYXZpdl9pb21tdXYxX2RvbWFpbl9hbGxvYyhzdHJ1
Y3QgZXRuYXZpdl9ncHUgKmdwdSk7Cj4gLXZvaWQgZXRuYXZpdl9pb21tdXYxX3Jlc3RvcmUoc3Ry
dWN0IGV0bmF2aXZfZ3B1ICpncHUpOwo+IC0KPiAtc3RydWN0IGV0bmF2aXZfaW9tbXVfZG9tYWlu
ICoKPiAtZXRuYXZpdl9pb21tdXYyX2RvbWFpbl9hbGxvYyhzdHJ1Y3QgZXRuYXZpdl9ncHUgKmdw
dSk7Cj4gLXZvaWQgZXRuYXZpdl9pb21tdXYyX3Jlc3RvcmUoc3RydWN0IGV0bmF2aXZfZ3B1ICpn
cHUpOwo+IC0KPiAtI2VuZGlmIC8qIF9fRVROQVZJVl9JT01NVV9IX18gKi8KPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9pb21tdV92Mi5jIGIvZHJpdmVycy9n
cHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9pb21tdV92Mi5jCj4gaW5kZXggZjc5NGUwNGJlOWU2Li44
YjZiMTAzNTQyMjggMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZp
dl9pb21tdV92Mi5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9pb21t
dV92Mi5jCj4gQEAgLTEyLDcgKzEyLDYgQEAKPiAgI2luY2x1ZGUgImV0bmF2aXZfY21kYnVmLmgi
Cj4gICNpbmNsdWRlICJldG5hdml2X2dwdS5oIgo+ICAjaW5jbHVkZSAiZXRuYXZpdl9tbXUuaCIK
PiAtI2luY2x1ZGUgImV0bmF2aXZfaW9tbXUuaCIKPiAgI2luY2x1ZGUgInN0YXRlLnhtbC5oIgo+
ICAjaW5jbHVkZSAic3RhdGVfaGkueG1sLmgiCj4gIAo+IEBAIC0yNywxMSArMjYsOSBAQAo+ICAK
PiAgI2RlZmluZSBNTVV2Ml9NQVhfU1RMQl9FTlRSSUVTCQkxMDI0Cj4gIAo+IC1zdHJ1Y3QgZXRu
YXZpdl9pb21tdXYyX2RvbWFpbiB7Cj4gLQlzdHJ1Y3QgZXRuYXZpdl9pb21tdV9kb21haW4gYmFz
ZTsKPiAtCS8qIFAoYWdlKSBUKGFibGUpIEEocnJheSkgKi8KPiAtCXU2NCAqcHRhX2NwdTsKPiAt
CWRtYV9hZGRyX3QgcHRhX2RtYTsKPiArc3RydWN0IGV0bmF2aXZfaW9tbXV2Ml9jb250ZXh0IHsK
PiArCXN0cnVjdCBldG5hdml2X2lvbW11X2NvbnRleHQgYmFzZTsKPiArCXVuc2lnbmVkIHNob3J0
IGlkOwo+ICAJLyogTShhc3RlcikgVExCIGFrYSBmaXJzdCBsZXZlbCBwYWdldGFibGUgKi8KPiAg
CXUzMiAqbXRsYl9jcHU7Cj4gIAlkbWFfYWRkcl90IG10bGJfZG1hOwo+IEBAIC00MCw0MSArMzcs
NjIgQEAgc3RydWN0IGV0bmF2aXZfaW9tbXV2Ml9kb21haW4gewo+ICAJZG1hX2FkZHJfdCBzdGxi
X2RtYVtNTVV2Ml9NQVhfU1RMQl9FTlRSSUVTXTsKPiAgfTsKPiAgCj4gLXN0YXRpYyBzdHJ1Y3Qg
ZXRuYXZpdl9pb21tdXYyX2RvbWFpbiAqCj4gLXRvX2V0bmF2aXZfZG9tYWluKHN0cnVjdCBldG5h
dml2X2lvbW11X2RvbWFpbiAqZG9tYWluKQo+ICtzdGF0aWMgc3RydWN0IGV0bmF2aXZfaW9tbXV2
Ml9jb250ZXh0ICoKPiArdG9fdjJfY29udGV4dChzdHJ1Y3QgZXRuYXZpdl9pb21tdV9jb250ZXh0
ICpjb250ZXh0KQo+ICB7Cj4gLQlyZXR1cm4gY29udGFpbmVyX29mKGRvbWFpbiwgc3RydWN0IGV0
bmF2aXZfaW9tbXV2Ml9kb21haW4sIGJhc2UpOwo+ICsJcmV0dXJuIGNvbnRhaW5lcl9vZihjb250
ZXh0LCBzdHJ1Y3QgZXRuYXZpdl9pb21tdXYyX2NvbnRleHQsIGJhc2UpOwo+ICB9Cj4gIAo+ICtz
dGF0aWMgdm9pZCBldG5hdml2X2lvbW11djJfZnJlZShzdHJ1Y3QgZXRuYXZpdl9pb21tdV9jb250
ZXh0ICpjb250ZXh0KQo+ICt7Cj4gKwlzdHJ1Y3QgZXRuYXZpdl9pb21tdXYyX2NvbnRleHQgKnYy
X2NvbnRleHQgPSB0b192Ml9jb250ZXh0KGNvbnRleHQpOwo+ICsJaW50IGk7Cj4gKwo+ICsJZHJt
X21tX3Rha2Vkb3duKCZjb250ZXh0LT5tbSk7Cj4gKwo+ICsJZm9yIChpID0gMDsgaSA8IE1NVXYy
X01BWF9TVExCX0VOVFJJRVM7IGkrKykgewo+ICsJCWlmICh2Ml9jb250ZXh0LT5zdGxiX2NwdVtp
XSkKPiArCQkJZG1hX2ZyZWVfd2MoY29udGV4dC0+Z2xvYmFsLT5kZXYsIFNaXzRLLAo+ICsJCQkJ
ICAgIHYyX2NvbnRleHQtPnN0bGJfY3B1W2ldLAo+ICsJCQkJICAgIHYyX2NvbnRleHQtPnN0bGJf
ZG1hW2ldKTsKPiArCX0KPiArCj4gKwlkbWFfZnJlZV93Yyhjb250ZXh0LT5nbG9iYWwtPmRldiwg
U1pfNEssIHYyX2NvbnRleHQtPm10bGJfY3B1LAo+ICsJCSAgICB2Ml9jb250ZXh0LT5tdGxiX2Rt
YSk7Cj4gKwo+ICsJY2xlYXJfYml0KHYyX2NvbnRleHQtPmlkLCBjb250ZXh0LT5nbG9iYWwtPnYy
LnB0YV9hbGxvYyk7Cj4gKwo+ICsJdmZyZWUodjJfY29udGV4dCk7Cj4gK30KPiAgc3RhdGljIGlu
dAo+IC1ldG5hdml2X2lvbW11djJfZW5zdXJlX3N0bGIoc3RydWN0IGV0bmF2aXZfaW9tbXV2Ml9k
b21haW4gKmV0bmF2aXZfZG9tYWluLAo+ICtldG5hdml2X2lvbW11djJfZW5zdXJlX3N0bGIoc3Ry
dWN0IGV0bmF2aXZfaW9tbXV2Ml9jb250ZXh0ICp2Ml9jb250ZXh0LAo+ICAJCQkgICAgaW50IHN0
bGIpCj4gIHsKPiAtCWlmIChldG5hdml2X2RvbWFpbi0+c3RsYl9jcHVbc3RsYl0pCj4gKwlpZiAo
djJfY29udGV4dC0+c3RsYl9jcHVbc3RsYl0pCj4gIAkJcmV0dXJuIDA7Cj4gIAo+IC0JZXRuYXZp
dl9kb21haW4tPnN0bGJfY3B1W3N0bGJdID0KPiAtCQkJZG1hX2FsbG9jX3djKGV0bmF2aXZfZG9t
YWluLT5iYXNlLmRldiwgU1pfNEssCj4gLQkJCQkgICAgICZldG5hdml2X2RvbWFpbi0+c3RsYl9k
bWFbc3RsYl0sCj4gKwl2Ml9jb250ZXh0LT5zdGxiX2NwdVtzdGxiXSA9Cj4gKwkJCWRtYV9hbGxv
Y193Yyh2Ml9jb250ZXh0LT5iYXNlLmdsb2JhbC0+ZGV2LCBTWl80SywKPiArCQkJCSAgICAgJnYy
X2NvbnRleHQtPnN0bGJfZG1hW3N0bGJdLAo+ICAJCQkJICAgICBHRlBfS0VSTkVMKTsKPiAgCj4g
LQlpZiAoIWV0bmF2aXZfZG9tYWluLT5zdGxiX2NwdVtzdGxiXSkKPiArCWlmICghdjJfY29udGV4
dC0+c3RsYl9jcHVbc3RsYl0pCj4gIAkJcmV0dXJuIC1FTk9NRU07Cj4gIAo+IC0JbWVtc2V0MzIo
ZXRuYXZpdl9kb21haW4tPnN0bGJfY3B1W3N0bGJdLCBNTVV2Ml9QVEVfRVhDRVBUSU9OLAo+ICsJ
bWVtc2V0MzIodjJfY29udGV4dC0+c3RsYl9jcHVbc3RsYl0sIE1NVXYyX1BURV9FWENFUFRJT04s
Cj4gIAkJIFNaXzRLIC8gc2l6ZW9mKHUzMikpOwo+ICAKPiAtCWV0bmF2aXZfZG9tYWluLT5tdGxi
X2NwdVtzdGxiXSA9IGV0bmF2aXZfZG9tYWluLT5zdGxiX2RtYVtzdGxiXSB8Cj4gLQkJCQkJCSAg
ICAgIE1NVXYyX1BURV9QUkVTRU5UOwo+ICsJdjJfY29udGV4dC0+bXRsYl9jcHVbc3RsYl0gPQo+
ICsJCQl2Ml9jb250ZXh0LT5zdGxiX2RtYVtzdGxiXSB8IE1NVXYyX1BURV9QUkVTRU5UOwo+ICsK
PiAgCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMgaW50IGV0bmF2aXZfaW9tbXV2Ml9tYXAo
c3RydWN0IGV0bmF2aXZfaW9tbXVfZG9tYWluICpkb21haW4sCj4gK3N0YXRpYyBpbnQgZXRuYXZp
dl9pb21tdXYyX21hcChzdHJ1Y3QgZXRuYXZpdl9pb21tdV9jb250ZXh0ICpjb250ZXh0LAo+ICAJ
CQkgICAgICAgdW5zaWduZWQgbG9uZyBpb3ZhLCBwaHlzX2FkZHJfdCBwYWRkciwKPiAgCQkJICAg
ICAgIHNpemVfdCBzaXplLCBpbnQgcHJvdCkKPiAgewo+IC0Jc3RydWN0IGV0bmF2aXZfaW9tbXV2
Ml9kb21haW4gKmV0bmF2aXZfZG9tYWluID0KPiAtCQkJdG9fZXRuYXZpdl9kb21haW4oZG9tYWlu
KTsKPiArCXN0cnVjdCBldG5hdml2X2lvbW11djJfY29udGV4dCAqdjJfY29udGV4dCA9IHRvX3Yy
X2NvbnRleHQoY29udGV4dCk7Cj4gIAlpbnQgbXRsYl9lbnRyeSwgc3RsYl9lbnRyeSwgcmV0Owo+
ICAJdTMyIGVudHJ5ID0gbG93ZXJfMzJfYml0cyhwYWRkcikgfCBNTVV2Ml9QVEVfUFJFU0VOVDsK
PiAgCj4gQEAgLTkwLDIwICsxMDgsMTkgQEAgc3RhdGljIGludCBldG5hdml2X2lvbW11djJfbWFw
KHN0cnVjdCBldG5hdml2X2lvbW11X2RvbWFpbiAqZG9tYWluLAo+ICAJbXRsYl9lbnRyeSA9IChp
b3ZhICYgTU1VdjJfTVRMQl9NQVNLKSA+PiBNTVV2Ml9NVExCX1NISUZUOwo+ICAJc3RsYl9lbnRy
eSA9IChpb3ZhICYgTU1VdjJfU1RMQl9NQVNLKSA+PiBNTVV2Ml9TVExCX1NISUZUOwo+ICAKPiAt
CXJldCA9IGV0bmF2aXZfaW9tbXV2Ml9lbnN1cmVfc3RsYihldG5hdml2X2RvbWFpbiwgbXRsYl9l
bnRyeSk7Cj4gKwlyZXQgPSBldG5hdml2X2lvbW11djJfZW5zdXJlX3N0bGIodjJfY29udGV4dCwg
bXRsYl9lbnRyeSk7Cj4gIAlpZiAocmV0KQo+ICAJCXJldHVybiByZXQ7Cj4gIAo+IC0JZXRuYXZp
dl9kb21haW4tPnN0bGJfY3B1W210bGJfZW50cnldW3N0bGJfZW50cnldID0gZW50cnk7Cj4gKwl2
Ml9jb250ZXh0LT5zdGxiX2NwdVttdGxiX2VudHJ5XVtzdGxiX2VudHJ5XSA9IGVudHJ5Owo+ICAK
PiAgCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMgc2l6ZV90IGV0bmF2aXZfaW9tbXV2Ml91
bm1hcChzdHJ1Y3QgZXRuYXZpdl9pb21tdV9kb21haW4gKmRvbWFpbiwKPiArc3RhdGljIHNpemVf
dCBldG5hdml2X2lvbW11djJfdW5tYXAoc3RydWN0IGV0bmF2aXZfaW9tbXVfY29udGV4dCAqY29u
dGV4dCwKPiAgCQkJCSAgICB1bnNpZ25lZCBsb25nIGlvdmEsIHNpemVfdCBzaXplKQo+ICB7Cj4g
LQlzdHJ1Y3QgZXRuYXZpdl9pb21tdXYyX2RvbWFpbiAqZXRuYXZpdl9kb21haW4gPQo+IC0JCQl0
b19ldG5hdml2X2RvbWFpbihkb21haW4pOwo+ICsJc3RydWN0IGV0bmF2aXZfaW9tbXV2Ml9jb250
ZXh0ICpldG5hdml2X2RvbWFpbiA9IHRvX3YyX2NvbnRleHQoY29udGV4dCk7Cj4gIAlpbnQgbXRs
Yl9lbnRyeSwgc3RsYl9lbnRyeTsKPiAgCj4gIAlpZiAoc2l6ZSAhPSBTWl80SykKPiBAQCAtMTE3
LDExOCArMTM0LDM1IEBAIHN0YXRpYyBzaXplX3QgZXRuYXZpdl9pb21tdXYyX3VubWFwKHN0cnVj
dCBldG5hdml2X2lvbW11X2RvbWFpbiAqZG9tYWluLAo+ICAJcmV0dXJuIFNaXzRLOwo+ICB9Cj4g
IAo+IC1zdGF0aWMgaW50IGV0bmF2aXZfaW9tbXV2Ml9pbml0KHN0cnVjdCBldG5hdml2X2lvbW11
djJfZG9tYWluICpldG5hdml2X2RvbWFpbikKPiAtewo+IC0JaW50IHJldDsKPiAtCj4gLQkvKiBh
bGxvY2F0ZSBzY3JhdGNoIHBhZ2UgKi8KPiAtCWV0bmF2aXZfZG9tYWluLT5iYXNlLmJhZF9wYWdl
X2NwdSA9Cj4gLQkJCWRtYV9hbGxvY193YyhldG5hdml2X2RvbWFpbi0+YmFzZS5kZXYsIFNaXzRL
LAo+IC0JCQkJICAgICAmZXRuYXZpdl9kb21haW4tPmJhc2UuYmFkX3BhZ2VfZG1hLAo+IC0JCQkJ
ICAgICBHRlBfS0VSTkVMKTsKPiAtCWlmICghZXRuYXZpdl9kb21haW4tPmJhc2UuYmFkX3BhZ2Vf
Y3B1KSB7Cj4gLQkJcmV0ID0gLUVOT01FTTsKPiAtCQlnb3RvIGZhaWxfbWVtOwo+IC0JfQo+IC0K
PiAtCW1lbXNldDMyKGV0bmF2aXZfZG9tYWluLT5iYXNlLmJhZF9wYWdlX2NwdSwgMHhkZWFkNTVh
YSwKPiAtCQkgU1pfNEsgLyBzaXplb2YodTMyKSk7Cj4gLQo+IC0JZXRuYXZpdl9kb21haW4tPnB0
YV9jcHUgPSBkbWFfYWxsb2Nfd2MoZXRuYXZpdl9kb21haW4tPmJhc2UuZGV2LAo+IC0JCQkJCSAg
ICAgICBTWl80SywgJmV0bmF2aXZfZG9tYWluLT5wdGFfZG1hLAo+IC0JCQkJCSAgICAgICBHRlBf
S0VSTkVMKTsKPiAtCWlmICghZXRuYXZpdl9kb21haW4tPnB0YV9jcHUpIHsKPiAtCQlyZXQgPSAt
RU5PTUVNOwo+IC0JCWdvdG8gZmFpbF9tZW07Cj4gLQl9Cj4gLQo+IC0JZXRuYXZpdl9kb21haW4t
Pm10bGJfY3B1ID0gZG1hX2FsbG9jX3djKGV0bmF2aXZfZG9tYWluLT5iYXNlLmRldiwKPiAtCQkJ
CQkJU1pfNEssICZldG5hdml2X2RvbWFpbi0+bXRsYl9kbWEsCj4gLQkJCQkJCUdGUF9LRVJORUwp
Owo+IC0JaWYgKCFldG5hdml2X2RvbWFpbi0+bXRsYl9jcHUpIHsKPiAtCQlyZXQgPSAtRU5PTUVN
Owo+IC0JCWdvdG8gZmFpbF9tZW07Cj4gLQl9Cj4gLQo+IC0JbWVtc2V0MzIoZXRuYXZpdl9kb21h
aW4tPm10bGJfY3B1LCBNTVV2Ml9QVEVfRVhDRVBUSU9OLAo+IC0JCSBNTVV2Ml9NQVhfU1RMQl9F
TlRSSUVTKTsKPiAtCj4gLQlyZXR1cm4gMDsKPiAtCj4gLWZhaWxfbWVtOgo+IC0JaWYgKGV0bmF2
aXZfZG9tYWluLT5iYXNlLmJhZF9wYWdlX2NwdSkKPiAtCQlkbWFfZnJlZV93YyhldG5hdml2X2Rv
bWFpbi0+YmFzZS5kZXYsIFNaXzRLLAo+IC0JCQkgICAgZXRuYXZpdl9kb21haW4tPmJhc2UuYmFk
X3BhZ2VfY3B1LAo+IC0JCQkgICAgZXRuYXZpdl9kb21haW4tPmJhc2UuYmFkX3BhZ2VfZG1hKTsK
PiAtCj4gLQlpZiAoZXRuYXZpdl9kb21haW4tPnB0YV9jcHUpCj4gLQkJZG1hX2ZyZWVfd2MoZXRu
YXZpdl9kb21haW4tPmJhc2UuZGV2LCBTWl80SywKPiAtCQkJICAgIGV0bmF2aXZfZG9tYWluLT5w
dGFfY3B1LCBldG5hdml2X2RvbWFpbi0+cHRhX2RtYSk7Cj4gLQo+IC0JaWYgKGV0bmF2aXZfZG9t
YWluLT5tdGxiX2NwdSkKPiAtCQlkbWFfZnJlZV93YyhldG5hdml2X2RvbWFpbi0+YmFzZS5kZXYs
IFNaXzRLLAo+IC0JCQkgICAgZXRuYXZpdl9kb21haW4tPm10bGJfY3B1LCBldG5hdml2X2RvbWFp
bi0+bXRsYl9kbWEpOwo+IC0KPiAtCXJldHVybiByZXQ7Cj4gLX0KPiAtCj4gLXN0YXRpYyB2b2lk
IGV0bmF2aXZfaW9tbXV2Ml9kb21haW5fZnJlZShzdHJ1Y3QgZXRuYXZpdl9pb21tdV9kb21haW4g
KmRvbWFpbikKPiAtewo+IC0Jc3RydWN0IGV0bmF2aXZfaW9tbXV2Ml9kb21haW4gKmV0bmF2aXZf
ZG9tYWluID0KPiAtCQkJdG9fZXRuYXZpdl9kb21haW4oZG9tYWluKTsKPiAtCWludCBpOwo+IC0K
PiAtCWRtYV9mcmVlX3djKGV0bmF2aXZfZG9tYWluLT5iYXNlLmRldiwgU1pfNEssCj4gLQkJICAg
IGV0bmF2aXZfZG9tYWluLT5iYXNlLmJhZF9wYWdlX2NwdSwKPiAtCQkgICAgZXRuYXZpdl9kb21h
aW4tPmJhc2UuYmFkX3BhZ2VfZG1hKTsKPiAtCj4gLQlkbWFfZnJlZV93YyhldG5hdml2X2RvbWFp
bi0+YmFzZS5kZXYsIFNaXzRLLAo+IC0JCSAgICBldG5hdml2X2RvbWFpbi0+cHRhX2NwdSwgZXRu
YXZpdl9kb21haW4tPnB0YV9kbWEpOwo+IC0KPiAtCWRtYV9mcmVlX3djKGV0bmF2aXZfZG9tYWlu
LT5iYXNlLmRldiwgU1pfNEssCj4gLQkJICAgIGV0bmF2aXZfZG9tYWluLT5tdGxiX2NwdSwgZXRu
YXZpdl9kb21haW4tPm10bGJfZG1hKTsKPiAtCj4gLQlmb3IgKGkgPSAwOyBpIDwgTU1VdjJfTUFY
X1NUTEJfRU5UUklFUzsgaSsrKSB7Cj4gLQkJaWYgKGV0bmF2aXZfZG9tYWluLT5zdGxiX2NwdVtp
XSkKPiAtCQkJZG1hX2ZyZWVfd2MoZXRuYXZpdl9kb21haW4tPmJhc2UuZGV2LCBTWl80SywKPiAt
CQkJCSAgICBldG5hdml2X2RvbWFpbi0+c3RsYl9jcHVbaV0sCj4gLQkJCQkgICAgZXRuYXZpdl9k
b21haW4tPnN0bGJfZG1hW2ldKTsKPiAtCX0KPiAtCj4gLQl2ZnJlZShldG5hdml2X2RvbWFpbik7
Cj4gLX0KPiAtCj4gLXN0YXRpYyBzaXplX3QgZXRuYXZpdl9pb21tdXYyX2R1bXBfc2l6ZShzdHJ1
Y3QgZXRuYXZpdl9pb21tdV9kb21haW4gKmRvbWFpbikKPiArc3RhdGljIHNpemVfdCBldG5hdml2
X2lvbW11djJfZHVtcF9zaXplKHN0cnVjdCBldG5hdml2X2lvbW11X2NvbnRleHQgKmNvbnRleHQp
Cj4gIHsKPiAtCXN0cnVjdCBldG5hdml2X2lvbW11djJfZG9tYWluICpldG5hdml2X2RvbWFpbiA9
Cj4gLQkJCXRvX2V0bmF2aXZfZG9tYWluKGRvbWFpbik7Cj4gKwlzdHJ1Y3QgZXRuYXZpdl9pb21t
dXYyX2NvbnRleHQgKnYyX2NvbnRleHQgPSB0b192Ml9jb250ZXh0KGNvbnRleHQpOwo+ICAJc2l6
ZV90IGR1bXBfc2l6ZSA9IFNaXzRLOwo+ICAJaW50IGk7Cj4gIAo+ICAJZm9yIChpID0gMDsgaSA8
IE1NVXYyX01BWF9TVExCX0VOVFJJRVM7IGkrKykKPiAtCQlpZiAoZXRuYXZpdl9kb21haW4tPm10
bGJfY3B1W2ldICYgTU1VdjJfUFRFX1BSRVNFTlQpCj4gKwkJaWYgKHYyX2NvbnRleHQtPm10bGJf
Y3B1W2ldICYgTU1VdjJfUFRFX1BSRVNFTlQpCj4gIAkJCWR1bXBfc2l6ZSArPSBTWl80SzsKPiAg
Cj4gIAlyZXR1cm4gZHVtcF9zaXplOwo+ICB9Cj4gIAo+IC1zdGF0aWMgdm9pZCBldG5hdml2X2lv
bW11djJfZHVtcChzdHJ1Y3QgZXRuYXZpdl9pb21tdV9kb21haW4gKmRvbWFpbiwgdm9pZCAqYnVm
KQo+ICtzdGF0aWMgdm9pZCBldG5hdml2X2lvbW11djJfZHVtcChzdHJ1Y3QgZXRuYXZpdl9pb21t
dV9jb250ZXh0ICpjb250ZXh0LCB2b2lkICpidWYpCj4gIHsKPiAtCXN0cnVjdCBldG5hdml2X2lv
bW11djJfZG9tYWluICpldG5hdml2X2RvbWFpbiA9Cj4gLQkJCXRvX2V0bmF2aXZfZG9tYWluKGRv
bWFpbik7Cj4gKwlzdHJ1Y3QgZXRuYXZpdl9pb21tdXYyX2NvbnRleHQgKnYyX2NvbnRleHQgPSB0
b192Ml9jb250ZXh0KGNvbnRleHQpOwo+ICAJaW50IGk7Cj4gIAo+IC0JbWVtY3B5KGJ1ZiwgZXRu
YXZpdl9kb21haW4tPm10bGJfY3B1LCBTWl80Syk7Cj4gKwltZW1jcHkoYnVmLCB2Ml9jb250ZXh0
LT5tdGxiX2NwdSwgU1pfNEspOwo+ICAJYnVmICs9IFNaXzRLOwo+ICAJZm9yIChpID0gMDsgaSA8
IE1NVXYyX01BWF9TVExCX0VOVFJJRVM7IGkrKywgYnVmICs9IFNaXzRLKQo+IC0JCWlmIChldG5h
dml2X2RvbWFpbi0+bXRsYl9jcHVbaV0gJiBNTVV2Ml9QVEVfUFJFU0VOVCkKPiAtCQkJbWVtY3B5
KGJ1ZiwgZXRuYXZpdl9kb21haW4tPnN0bGJfY3B1W2ldLCBTWl80Syk7Cj4gKwkJaWYgKHYyX2Nv
bnRleHQtPm10bGJfY3B1W2ldICYgTU1VdjJfUFRFX1BSRVNFTlQpCj4gKwkJCW1lbWNweShidWYs
IHYyX2NvbnRleHQtPnN0bGJfY3B1W2ldLCBTWl80Syk7Cj4gIH0KPiAgCj4gLXN0YXRpYyB2b2lk
IGV0bmF2aXZfaW9tbXV2Ml9yZXN0b3JlX25vbnNlYyhzdHJ1Y3QgZXRuYXZpdl9ncHUgKmdwdSkK
PiArc3RhdGljIHZvaWQgZXRuYXZpdl9pb21tdXYyX3Jlc3RvcmVfbm9uc2VjKHN0cnVjdCBldG5h
dml2X2dwdSAqZ3B1LAo+ICsJc3RydWN0IGV0bmF2aXZfaW9tbXVfY29udGV4dCAqY29udGV4dCkK
PiAgewo+IC0Jc3RydWN0IGV0bmF2aXZfaW9tbXV2Ml9kb21haW4gKmV0bmF2aXZfZG9tYWluID0K
PiAtCQkJdG9fZXRuYXZpdl9kb21haW4oZ3B1LT5tbXUtPmRvbWFpbik7Cj4gKwlzdHJ1Y3QgZXRu
YXZpdl9pb21tdXYyX2NvbnRleHQgKnYyX2NvbnRleHQgPSB0b192Ml9jb250ZXh0KGNvbnRleHQp
Owo+ICAJdTE2IHByZWZldGNoOwo+ICAKPiAgCS8qIElmIHRoZSBNTVUgaXMgYWxyZWFkeSBlbmFi
bGVkIHRoZSBzdGF0ZSBpcyBzdGlsbCB0aGVyZS4gKi8KPiBAQCAtMjM2LDggKzE3MCw4IEBAIHN0
YXRpYyB2b2lkIGV0bmF2aXZfaW9tbXV2Ml9yZXN0b3JlX25vbnNlYyhzdHJ1Y3QgZXRuYXZpdl9n
cHUgKmdwdSkKPiAgCQlyZXR1cm47Cj4gIAo+ICAJcHJlZmV0Y2ggPSBldG5hdml2X2J1ZmZlcl9j
b25maWdfbW11djIoZ3B1LAo+IC0JCQkJKHUzMilldG5hdml2X2RvbWFpbi0+bXRsYl9kbWEsCj4g
LQkJCQkodTMyKWV0bmF2aXZfZG9tYWluLT5iYXNlLmJhZF9wYWdlX2RtYSk7Cj4gKwkJCQkodTMy
KXYyX2NvbnRleHQtPm10bGJfZG1hLAo+ICsJCQkJKHUzMiljb250ZXh0LT5nbG9iYWwtPmJhZF9w
YWdlX2RtYSk7Cj4gIAlldG5hdml2X2dwdV9zdGFydF9mZShncHUsICh1MzIpZXRuYXZpdl9jbWRi
dWZfZ2V0X3BhKCZncHUtPmJ1ZmZlciksCj4gIAkJCSAgICAgcHJlZmV0Y2gpOwo+ICAJZXRuYXZp
dl9ncHVfd2FpdF9pZGxlKGdwdSwgMTAwKTsKPiBAQCAtMjQ1LDEwICsxNzksMTAgQEAgc3RhdGlj
IHZvaWQgZXRuYXZpdl9pb21tdXYyX3Jlc3RvcmVfbm9uc2VjKHN0cnVjdCBldG5hdml2X2dwdSAq
Z3B1KQo+ICAJZ3B1X3dyaXRlKGdwdSwgVklWU19NTVV2Ml9DT05UUk9MLCBWSVZTX01NVXYyX0NP
TlRST0xfRU5BQkxFKTsKPiAgfQo+ICAKPiAtc3RhdGljIHZvaWQgZXRuYXZpdl9pb21tdXYyX3Jl
c3RvcmVfc2VjKHN0cnVjdCBldG5hdml2X2dwdSAqZ3B1KQo+ICtzdGF0aWMgdm9pZCBldG5hdml2
X2lvbW11djJfcmVzdG9yZV9zZWMoc3RydWN0IGV0bmF2aXZfZ3B1ICpncHUsCj4gKwlzdHJ1Y3Qg
ZXRuYXZpdl9pb21tdV9jb250ZXh0ICpjb250ZXh0KQo+ICB7Cj4gLQlzdHJ1Y3QgZXRuYXZpdl9p
b21tdXYyX2RvbWFpbiAqZXRuYXZpdl9kb21haW4gPQo+IC0JCQkJdG9fZXRuYXZpdl9kb21haW4o
Z3B1LT5tbXUtPmRvbWFpbik7Cj4gKwlzdHJ1Y3QgZXRuYXZpdl9pb21tdXYyX2NvbnRleHQgKnYy
X2NvbnRleHQgPSB0b192Ml9jb250ZXh0KGNvbnRleHQpOwo+ICAJdTE2IHByZWZldGNoOwo+ICAK
PiAgCS8qIElmIHRoZSBNTVUgaXMgYWxyZWFkeSBlbmFibGVkIHRoZSBzdGF0ZSBpcyBzdGlsbCB0
aGVyZS4gKi8KPiBAQCAtMjU2LDI2ICsxOTAsMjYgQEAgc3RhdGljIHZvaWQgZXRuYXZpdl9pb21t
dXYyX3Jlc3RvcmVfc2VjKHN0cnVjdCBldG5hdml2X2dwdSAqZ3B1KQo+ICAJCXJldHVybjsKPiAg
Cj4gIAlncHVfd3JpdGUoZ3B1LCBWSVZTX01NVXYyX1BUQV9BRERSRVNTX0xPVywKPiAtCQkgIGxv
d2VyXzMyX2JpdHMoZXRuYXZpdl9kb21haW4tPnB0YV9kbWEpKTsKPiArCQkgIGxvd2VyXzMyX2Jp
dHMoY29udGV4dC0+Z2xvYmFsLT52Mi5wdGFfZG1hKSk7Cj4gIAlncHVfd3JpdGUoZ3B1LCBWSVZT
X01NVXYyX1BUQV9BRERSRVNTX0hJR0gsCj4gLQkJICB1cHBlcl8zMl9iaXRzKGV0bmF2aXZfZG9t
YWluLT5wdGFfZG1hKSk7Cj4gKwkJICB1cHBlcl8zMl9iaXRzKGNvbnRleHQtPmdsb2JhbC0+djIu
cHRhX2RtYSkpOwo+ICAJZ3B1X3dyaXRlKGdwdSwgVklWU19NTVV2Ml9QVEFfQ09OVFJPTCwgVklW
U19NTVV2Ml9QVEFfQ09OVFJPTF9FTkFCTEUpOwo+ICAKPiAgCWdwdV93cml0ZShncHUsIFZJVlNf
TU1VdjJfTk9OU0VDX1NBRkVfQUREUl9MT1csCj4gLQkJICBsb3dlcl8zMl9iaXRzKGV0bmF2aXZf
ZG9tYWluLT5iYXNlLmJhZF9wYWdlX2RtYSkpOwo+ICsJCSAgbG93ZXJfMzJfYml0cyhjb250ZXh0
LT5nbG9iYWwtPmJhZF9wYWdlX2RtYSkpOwo+ICAJZ3B1X3dyaXRlKGdwdSwgVklWU19NTVV2Ml9T
RUNfU0FGRV9BRERSX0xPVywKPiAtCQkgIGxvd2VyXzMyX2JpdHMoZXRuYXZpdl9kb21haW4tPmJh
c2UuYmFkX3BhZ2VfZG1hKSk7Cj4gKwkJICBsb3dlcl8zMl9iaXRzKGNvbnRleHQtPmdsb2JhbC0+
YmFkX3BhZ2VfZG1hKSk7Cj4gIAlncHVfd3JpdGUoZ3B1LCBWSVZTX01NVXYyX1NBRkVfQUREUkVT
U19DT05GSUcsCj4gIAkJICBWSVZTX01NVXYyX1NBRkVfQUREUkVTU19DT05GSUdfTk9OX1NFQ19T
QUZFX0FERFJfSElHSCgKPiAtCQkgIHVwcGVyXzMyX2JpdHMoZXRuYXZpdl9kb21haW4tPmJhc2Uu
YmFkX3BhZ2VfZG1hKSkgfAo+ICsJCSAgdXBwZXJfMzJfYml0cyhjb250ZXh0LT5nbG9iYWwtPmJh
ZF9wYWdlX2RtYSkpIHwKPiAgCQkgIFZJVlNfTU1VdjJfU0FGRV9BRERSRVNTX0NPTkZJR19TRUNf
U0FGRV9BRERSX0hJR0goCj4gLQkJICB1cHBlcl8zMl9iaXRzKGV0bmF2aXZfZG9tYWluLT5iYXNl
LmJhZF9wYWdlX2RtYSkpKTsKPiArCQkgIHVwcGVyXzMyX2JpdHMoY29udGV4dC0+Z2xvYmFsLT5i
YWRfcGFnZV9kbWEpKSk7Cj4gIAo+IC0JZXRuYXZpdl9kb21haW4tPnB0YV9jcHVbMF0gPSBldG5h
dml2X2RvbWFpbi0+bXRsYl9kbWEgfAo+IC0JCQkJICAgICBWSVZTX01NVXYyX0NPTkZJR1VSQVRJ
T05fTU9ERV9NT0RFNF9LOwo+ICsJY29udGV4dC0+Z2xvYmFsLT52Mi5wdGFfY3B1WzBdID0gdjJf
Y29udGV4dC0+bXRsYl9kbWEgfAo+ICsJCQkJIAkgVklWU19NTVV2Ml9DT05GSUdVUkFUSU9OX01P
REVfTU9ERTRfSzsKPiAgCj4gIAkvKiB0cmlnZ2VyIGEgUFRBIGxvYWQgdGhyb3VnaCB0aGUgRkUg
Ki8KPiAtCXByZWZldGNoID0gZXRuYXZpdl9idWZmZXJfY29uZmlnX3B0YShncHUpOwo+ICsJcHJl
ZmV0Y2ggPSBldG5hdml2X2J1ZmZlcl9jb25maWdfcHRhKGdwdSwgdjJfY29udGV4dC0+aWQpOwo+
ICAJZXRuYXZpdl9ncHVfc3RhcnRfZmUoZ3B1LCAodTMyKWV0bmF2aXZfY21kYnVmX2dldF9wYSgm
Z3B1LT5idWZmZXIpLAo+ICAJCQkgICAgIHByZWZldGNoKTsKPiAgCWV0bmF2aXZfZ3B1X3dhaXRf
aWRsZShncHUsIDEwMCk7Cj4gQEAgLTI4MywxNCArMjE3LDE1IEBAIHN0YXRpYyB2b2lkIGV0bmF2
aXZfaW9tbXV2Ml9yZXN0b3JlX3NlYyhzdHJ1Y3QgZXRuYXZpdl9ncHUgKmdwdSkKPiAgCWdwdV93
cml0ZShncHUsIFZJVlNfTU1VdjJfU0VDX0NPTlRST0wsIFZJVlNfTU1VdjJfU0VDX0NPTlRST0xf
RU5BQkxFKTsKPiAgfQo+ICAKPiAtdm9pZCBldG5hdml2X2lvbW11djJfcmVzdG9yZShzdHJ1Y3Qg
ZXRuYXZpdl9ncHUgKmdwdSkKPiArc3RhdGljIHZvaWQgZXRuYXZpdl9pb21tdXYyX3Jlc3RvcmUo
c3RydWN0IGV0bmF2aXZfZ3B1ICpncHUsCj4gKwkJCQkgICAgc3RydWN0IGV0bmF2aXZfaW9tbXVf
Y29udGV4dCAqY29udGV4dCkKPiAgewo+ICAJc3dpdGNoIChncHUtPnNlY19tb2RlKSB7Cj4gIAlj
YXNlIEVUTkFfU0VDX05PTkU6Cj4gLQkJZXRuYXZpdl9pb21tdXYyX3Jlc3RvcmVfbm9uc2VjKGdw
dSk7Cj4gKwkJZXRuYXZpdl9pb21tdXYyX3Jlc3RvcmVfbm9uc2VjKGdwdSwgY29udGV4dCk7Cj4g
IAkJYnJlYWs7Cj4gIAljYXNlIEVUTkFfU0VDX0tFUk5FTDoKPiAtCQlldG5hdml2X2lvbW11djJf
cmVzdG9yZV9zZWMoZ3B1KTsKPiArCQlldG5hdml2X2lvbW11djJfcmVzdG9yZV9zZWMoZ3B1LCBj
b250ZXh0KTsKPiAgCQlicmVhazsKPiAgCWRlZmF1bHQ6Cj4gIAkJV0FSTigxLCAidW5oYW5kbGVk
IEdQVSBzZWN1cml0eSBtb2RlXG4iKTsKPiBAQCAtMjk4LDM5ICsyMzMsNTYgQEAgdm9pZCBldG5h
dml2X2lvbW11djJfcmVzdG9yZShzdHJ1Y3QgZXRuYXZpdl9ncHUgKmdwdSkKPiAgCX0KPiAgfQo+
ICAKPiAtc3RhdGljIGNvbnN0IHN0cnVjdCBldG5hdml2X2lvbW11X2RvbWFpbl9vcHMgZXRuYXZp
dl9pb21tdXYyX29wcyA9IHsKPiAtCS5mcmVlID0gZXRuYXZpdl9pb21tdXYyX2RvbWFpbl9mcmVl
LAo+ICtjb25zdCBzdHJ1Y3QgZXRuYXZpdl9pb21tdV9vcHMgZXRuYXZpdl9pb21tdXYyX29wcyA9
IHsKPiArCS5mcmVlID0gZXRuYXZpdl9pb21tdXYyX2ZyZWUsCj4gIAkubWFwID0gZXRuYXZpdl9p
b21tdXYyX21hcCwKPiAgCS51bm1hcCA9IGV0bmF2aXZfaW9tbXV2Ml91bm1hcCwKPiAgCS5kdW1w
X3NpemUgPSBldG5hdml2X2lvbW11djJfZHVtcF9zaXplLAo+ICAJLmR1bXAgPSBldG5hdml2X2lv
bW11djJfZHVtcCwKPiArCS5yZXN0b3JlID0gZXRuYXZpdl9pb21tdXYyX3Jlc3RvcmUsCj4gIH07
Cj4gIAo+IC1zdHJ1Y3QgZXRuYXZpdl9pb21tdV9kb21haW4gKgo+IC1ldG5hdml2X2lvbW11djJf
ZG9tYWluX2FsbG9jKHN0cnVjdCBldG5hdml2X2dwdSAqZ3B1KQo+ICtzdHJ1Y3QgZXRuYXZpdl9p
b21tdV9jb250ZXh0ICoKPiArZXRuYXZpdl9pb21tdXYyX2NvbnRleHRfYWxsb2Moc3RydWN0IGV0
bmF2aXZfaW9tbXVfZ2xvYmFsICpnbG9iYWwpCj4gIHsKPiAtCXN0cnVjdCBldG5hdml2X2lvbW11
djJfZG9tYWluICpldG5hdml2X2RvbWFpbjsKPiAtCXN0cnVjdCBldG5hdml2X2lvbW11X2RvbWFp
biAqZG9tYWluOwo+IC0JaW50IHJldDsKPiArCXN0cnVjdCBldG5hdml2X2lvbW11djJfY29udGV4
dCAqdjJfY29udGV4dDsKPiArCXN0cnVjdCBldG5hdml2X2lvbW11X2NvbnRleHQgKmNvbnRleHQ7
Cj4gIAo+IC0JZXRuYXZpdl9kb21haW4gPSB2emFsbG9jKHNpemVvZigqZXRuYXZpdl9kb21haW4p
KTsKPiAtCWlmICghZXRuYXZpdl9kb21haW4pCj4gKwl2Ml9jb250ZXh0ID0gdnphbGxvYyhzaXpl
b2YoKnYyX2NvbnRleHQpKTsKPiArCWlmICghdjJfY29udGV4dCkKPiAgCQlyZXR1cm4gTlVMTDsK
PiAgCj4gLQlkb21haW4gPSAmZXRuYXZpdl9kb21haW4tPmJhc2U7Cj4gKwltdXRleF9sb2NrKCZn
bG9iYWwtPmxvY2spOwo+ICsJdjJfY29udGV4dC0+aWQgPSBmaW5kX2ZpcnN0X3plcm9fYml0KGds
b2JhbC0+djIucHRhX2FsbG9jLAo+ICsJCQkJCSAgICAgRVROQVZJVl9QVEFfRU5UUklFUyk7Cj4g
KwlpZiAodjJfY29udGV4dC0+aWQgPCBFVE5BVklWX1BUQV9FTlRSSUVTKSB7Cj4gKwkJc2V0X2Jp
dCh2Ml9jb250ZXh0LT5pZCwgZ2xvYmFsLT52Mi5wdGFfYWxsb2MpOwo+ICsJfSBlbHNlIHsKPiAr
CQltdXRleF91bmxvY2soJmdsb2JhbC0+bG9jayk7Cj4gKwkJZ290byBvdXRfZnJlZTsKPiArCX0K
PiArCW11dGV4X3VubG9jaygmZ2xvYmFsLT5sb2NrKTsKPiAgCj4gLQlkb21haW4tPmRldiA9IGdw
dS0+ZGV2Owo+IC0JZG9tYWluLT5iYXNlID0gU1pfNEs7Cj4gLQlkb21haW4tPnNpemUgPSAodTY0
KVNaXzFHICogNCAtIFNaXzRLOwo+IC0JZG9tYWluLT5vcHMgPSAmZXRuYXZpdl9pb21tdXYyX29w
czsKPiArCXYyX2NvbnRleHQtPm10bGJfY3B1ID0gZG1hX2FsbG9jX3djKGdsb2JhbC0+ZGV2LCBT
Wl80SywKPiArCQkJCQkgICAgJnYyX2NvbnRleHQtPm10bGJfZG1hLCBHRlBfS0VSTkVMKTsKPiAr
CWlmICghdjJfY29udGV4dC0+bXRsYl9jcHUpCj4gKwkJZ290byBvdXRfZnJlZV9pZDsKPiAgCj4g
LQlyZXQgPSBldG5hdml2X2lvbW11djJfaW5pdChldG5hdml2X2RvbWFpbik7Cj4gLQlpZiAocmV0
KQo+IC0JCWdvdG8gb3V0X2ZyZWU7Cj4gKwltZW1zZXQzMih2Ml9jb250ZXh0LT5tdGxiX2NwdSwg
TU1VdjJfUFRFX0VYQ0VQVElPTiwKPiArCQkgTU1VdjJfTUFYX1NUTEJfRU5UUklFUyk7Cj4gKwo+
ICsJY29udGV4dCA9ICZ2Ml9jb250ZXh0LT5iYXNlOwo+ICsJY29udGV4dC0+Z2xvYmFsID0gZ2xv
YmFsOwo+ICsJa3JlZl9pbml0KCZjb250ZXh0LT5yZWZjb3VudCk7Cj4gKwltdXRleF9pbml0KCZj
b250ZXh0LT5sb2NrKTsKPiArCUlOSVRfTElTVF9IRUFEKCZjb250ZXh0LT5tYXBwaW5ncyk7Cj4g
Kwlkcm1fbW1faW5pdCgmY29udGV4dC0+bW0sIFNaXzRLLCAodTY0KVNaXzFHICogNCAtIFNaXzRL
KTsKPiAgCj4gLQlyZXR1cm4gJmV0bmF2aXZfZG9tYWluLT5iYXNlOwo+ICsJcmV0dXJuIGNvbnRl
eHQ7Cj4gIAo+ICtvdXRfZnJlZV9pZDoKPiArCWNsZWFyX2JpdCh2Ml9jb250ZXh0LT5pZCwgZ2xv
YmFsLT52Mi5wdGFfYWxsb2MpOwo+ICBvdXRfZnJlZToKPiAtCXZmcmVlKGV0bmF2aXZfZG9tYWlu
KTsKPiArCXZmcmVlKHYyX2NvbnRleHQpOwo+ICAJcmV0dXJuIE5VTEw7Cj4gIH0KPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9tbXUuYyBiL2RyaXZlcnMvZ3B1
L2RybS9ldG5hdml2L2V0bmF2aXZfbW11LmMKPiBpbmRleCBjNDA5MmM4ZGVmNGYuLmExNTU3NTU0
MjRmOCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X21tdS5j
Cj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9tbXUuYwo+IEBAIC04LDEw
ICs4LDkgQEAKPiAgI2luY2x1ZGUgImV0bmF2aXZfZHJ2LmgiCj4gICNpbmNsdWRlICJldG5hdml2
X2dlbS5oIgo+ICAjaW5jbHVkZSAiZXRuYXZpdl9ncHUuaCIKPiAtI2luY2x1ZGUgImV0bmF2aXZf
aW9tbXUuaCIKPiAgI2luY2x1ZGUgImV0bmF2aXZfbW11LmgiCj4gIAo+IC1zdGF0aWMgdm9pZCBl
dG5hdml2X2RvbWFpbl91bm1hcChzdHJ1Y3QgZXRuYXZpdl9pb21tdV9kb21haW4gKmRvbWFpbiwK
PiArc3RhdGljIHZvaWQgZXRuYXZpdl9jb250ZXh0X3VubWFwKHN0cnVjdCBldG5hdml2X2lvbW11
X2NvbnRleHQgKmNvbnRleHQsCj4gIAkJCQkgdW5zaWduZWQgbG9uZyBpb3ZhLCBzaXplX3Qgc2l6
ZSkKPiAgewo+ICAJc2l6ZV90IHVubWFwcGVkX3BhZ2UsIHVubWFwcGVkID0gMDsKPiBAQCAtMjQs
NyArMjMsOCBAQCBzdGF0aWMgdm9pZCBldG5hdml2X2RvbWFpbl91bm1hcChzdHJ1Y3QgZXRuYXZp
dl9pb21tdV9kb21haW4gKmRvbWFpbiwKPiAgCX0KPiAgCj4gIAl3aGlsZSAodW5tYXBwZWQgPCBz
aXplKSB7Cj4gLQkJdW5tYXBwZWRfcGFnZSA9IGRvbWFpbi0+b3BzLT51bm1hcChkb21haW4sIGlv
dmEsIHBnc2l6ZSk7Cj4gKwkJdW5tYXBwZWRfcGFnZSA9IGNvbnRleHQtPmdsb2JhbC0+b3BzLT51
bm1hcChjb250ZXh0LCBpb3ZhLAo+ICsJCQkJCQkJICAgIHBnc2l6ZSk7Cj4gIAkJaWYgKCF1bm1h
cHBlZF9wYWdlKQo+ICAJCQlicmVhazsKPiAgCj4gQEAgLTMzLDcgKzMzLDcgQEAgc3RhdGljIHZv
aWQgZXRuYXZpdl9kb21haW5fdW5tYXAoc3RydWN0IGV0bmF2aXZfaW9tbXVfZG9tYWluICpkb21h
aW4sCj4gIAl9Cj4gIH0KPiAgCj4gLXN0YXRpYyBpbnQgZXRuYXZpdl9kb21haW5fbWFwKHN0cnVj
dCBldG5hdml2X2lvbW11X2RvbWFpbiAqZG9tYWluLAo+ICtzdGF0aWMgaW50IGV0bmF2aXZfY29u
dGV4dF9tYXAoc3RydWN0IGV0bmF2aXZfaW9tbXVfY29udGV4dCAqY29udGV4dCwKPiAgCQkJICAg
ICAgdW5zaWduZWQgbG9uZyBpb3ZhLCBwaHlzX2FkZHJfdCBwYWRkciwKPiAgCQkJICAgICAgc2l6
ZV90IHNpemUsIGludCBwcm90KQo+ICB7Cj4gQEAgLTQ5LDcgKzQ5LDggQEAgc3RhdGljIGludCBl
dG5hdml2X2RvbWFpbl9tYXAoc3RydWN0IGV0bmF2aXZfaW9tbXVfZG9tYWluICpkb21haW4sCj4g
IAl9Cj4gIAo+ICAJd2hpbGUgKHNpemUpIHsKPiAtCQlyZXQgPSBkb21haW4tPm9wcy0+bWFwKGRv
bWFpbiwgaW92YSwgcGFkZHIsIHBnc2l6ZSwgcHJvdCk7Cj4gKwkJcmV0ID0gY29udGV4dC0+Z2xv
YmFsLT5vcHMtPm1hcChjb250ZXh0LCBpb3ZhLCBwYWRkciwgcGdzaXplLAo+ICsJCQkJCQlwcm90
KTsKPiAgCQlpZiAocmV0KQo+ICAJCQlicmVhazsKPiAgCj4gQEAgLTYwLDIxICs2MSwxOSBAQCBz
dGF0aWMgaW50IGV0bmF2aXZfZG9tYWluX21hcChzdHJ1Y3QgZXRuYXZpdl9pb21tdV9kb21haW4g
KmRvbWFpbiwKPiAgCj4gIAkvKiB1bnJvbGwgbWFwcGluZyBpbiBjYXNlIHNvbWV0aGluZyB3ZW50
IHdyb25nICovCj4gIAlpZiAocmV0KQo+IC0JCWV0bmF2aXZfZG9tYWluX3VubWFwKGRvbWFpbiwg
b3JpZ19pb3ZhLCBvcmlnX3NpemUgLSBzaXplKTsKPiArCQlldG5hdml2X2NvbnRleHRfdW5tYXAo
Y29udGV4dCwgb3JpZ19pb3ZhLCBvcmlnX3NpemUgLSBzaXplKTsKPiAgCj4gIAlyZXR1cm4gcmV0
Owo+ICB9Cj4gIAo+IC1zdGF0aWMgaW50IGV0bmF2aXZfaW9tbXVfbWFwKHN0cnVjdCBldG5hdml2
X2lvbW11ICppb21tdSwgdTMyIGlvdmEsCj4gK3N0YXRpYyBpbnQgZXRuYXZpdl9pb21tdV9tYXAo
c3RydWN0IGV0bmF2aXZfaW9tbXVfY29udGV4dCAqY29udGV4dCwgdTMyIGlvdmEsCj4gIAkJCSAg
ICAgc3RydWN0IHNnX3RhYmxlICpzZ3QsIHVuc2lnbmVkIGxlbiwgaW50IHByb3QpCj4gLXsKPiAt
CXN0cnVjdCBldG5hdml2X2lvbW11X2RvbWFpbiAqZG9tYWluID0gaW9tbXUtPmRvbWFpbjsKPiAt
CXN0cnVjdCBzY2F0dGVybGlzdCAqc2c7Cj4gK3sJc3RydWN0IHNjYXR0ZXJsaXN0ICpzZzsKPiAg
CXVuc2lnbmVkIGludCBkYSA9IGlvdmE7Cj4gIAl1bnNpZ25lZCBpbnQgaSwgajsKPiAgCWludCBy
ZXQ7Cj4gIAo+IC0JaWYgKCFkb21haW4gfHwgIXNndCkKPiArCWlmICghY29udGV4dCB8fCAhc2d0
KQo+ICAJCXJldHVybiAtRUlOVkFMOwo+ICAKPiAgCWZvcl9lYWNoX3NnKHNndC0+c2dsLCBzZywg
c2d0LT5uZW50cywgaSkgewo+IEBAIC04Myw3ICs4Miw3IEBAIHN0YXRpYyBpbnQgZXRuYXZpdl9p
b21tdV9tYXAoc3RydWN0IGV0bmF2aXZfaW9tbXUgKmlvbW11LCB1MzIgaW92YSwKPiAgCj4gIAkJ
VkVSQigibWFwWyVkXTogJTA4eCAlMDh4KCV6eCkiLCBpLCBpb3ZhLCBwYSwgYnl0ZXMpOwo+ICAK
PiAtCQlyZXQgPSBldG5hdml2X2RvbWFpbl9tYXAoZG9tYWluLCBkYSwgcGEsIGJ5dGVzLCBwcm90
KTsKPiArCQlyZXQgPSBldG5hdml2X2NvbnRleHRfbWFwKGNvbnRleHQsIGRhLCBwYSwgYnl0ZXMs
IHByb3QpOwo+ICAJCWlmIChyZXQpCj4gIAkJCWdvdG8gZmFpbDsKPiAgCj4gQEAgLTk4LDE2ICs5
NywxNSBAQCBzdGF0aWMgaW50IGV0bmF2aXZfaW9tbXVfbWFwKHN0cnVjdCBldG5hdml2X2lvbW11
ICppb21tdSwgdTMyIGlvdmEsCj4gIAlmb3JfZWFjaF9zZyhzZ3QtPnNnbCwgc2csIGksIGopIHsK
PiAgCQlzaXplX3QgYnl0ZXMgPSBzZ19kbWFfbGVuKHNnKSArIHNnLT5vZmZzZXQ7Cj4gIAo+IC0J
CWV0bmF2aXZfZG9tYWluX3VubWFwKGRvbWFpbiwgZGEsIGJ5dGVzKTsKPiArCQlldG5hdml2X2Nv
bnRleHRfdW5tYXAoY29udGV4dCwgZGEsIGJ5dGVzKTsKPiAgCQlkYSArPSBieXRlczsKPiAgCX0K
PiAgCXJldHVybiByZXQ7Cj4gIH0KPiAgCj4gLXN0YXRpYyB2b2lkIGV0bmF2aXZfaW9tbXVfdW5t
YXAoc3RydWN0IGV0bmF2aXZfaW9tbXUgKmlvbW11LCB1MzIgaW92YSwKPiArc3RhdGljIHZvaWQg
ZXRuYXZpdl9pb21tdV91bm1hcChzdHJ1Y3QgZXRuYXZpdl9pb21tdV9jb250ZXh0ICpjb250ZXh0
LCB1MzIgaW92YSwKPiAgCQkJCXN0cnVjdCBzZ190YWJsZSAqc2d0LCB1bnNpZ25lZCBsZW4pCj4g
IHsKPiAtCXN0cnVjdCBldG5hdml2X2lvbW11X2RvbWFpbiAqZG9tYWluID0gaW9tbXUtPmRvbWFp
bjsKPiAgCXN0cnVjdCBzY2F0dGVybGlzdCAqc2c7Cj4gIAl1bnNpZ25lZCBpbnQgZGEgPSBpb3Zh
Owo+ICAJaW50IGk7Cj4gQEAgLTExNSw3ICsxMTMsNyBAQCBzdGF0aWMgdm9pZCBldG5hdml2X2lv
bW11X3VubWFwKHN0cnVjdCBldG5hdml2X2lvbW11ICppb21tdSwgdTMyIGlvdmEsCj4gIAlmb3Jf
ZWFjaF9zZyhzZ3QtPnNnbCwgc2csIHNndC0+bmVudHMsIGkpIHsKPiAgCQlzaXplX3QgYnl0ZXMg
PSBzZ19kbWFfbGVuKHNnKSArIHNnLT5vZmZzZXQ7Cj4gIAo+IC0JCWV0bmF2aXZfZG9tYWluX3Vu
bWFwKGRvbWFpbiwgZGEsIGJ5dGVzKTsKPiArCQlldG5hdml2X2NvbnRleHRfdW5tYXAoY29udGV4
dCwgZGEsIGJ5dGVzKTsKPiAgCj4gIAkJVkVSQigidW5tYXBbJWRdOiAlMDh4KCV6eCkiLCBpLCBp
b3ZhLCBieXRlcyk7Cj4gIAo+IEBAIC0xMjUsMjQgKzEyMywyNCBAQCBzdGF0aWMgdm9pZCBldG5h
dml2X2lvbW11X3VubWFwKHN0cnVjdCBldG5hdml2X2lvbW11ICppb21tdSwgdTMyIGlvdmEsCj4g
IAl9Cj4gIH0KPiAgCj4gLXN0YXRpYyB2b2lkIGV0bmF2aXZfaW9tbXVfcmVtb3ZlX21hcHBpbmco
c3RydWN0IGV0bmF2aXZfaW9tbXUgKm1tdSwKPiArc3RhdGljIHZvaWQgZXRuYXZpdl9pb21tdV9y
ZW1vdmVfbWFwcGluZyhzdHJ1Y3QgZXRuYXZpdl9pb21tdV9jb250ZXh0ICpjb250ZXh0LAo+ICAJ
c3RydWN0IGV0bmF2aXZfdnJhbV9tYXBwaW5nICptYXBwaW5nKQo+ICB7Cj4gIAlzdHJ1Y3QgZXRu
YXZpdl9nZW1fb2JqZWN0ICpldG5hdml2X29iaiA9IG1hcHBpbmctPm9iamVjdDsKPiAgCj4gLQll
dG5hdml2X2lvbW11X3VubWFwKG1tdSwgbWFwcGluZy0+dnJhbV9ub2RlLnN0YXJ0LAo+ICsJZXRu
YXZpdl9pb21tdV91bm1hcChjb250ZXh0LCBtYXBwaW5nLT52cmFtX25vZGUuc3RhcnQsCj4gIAkJ
CSAgICBldG5hdml2X29iai0+c2d0LCBldG5hdml2X29iai0+YmFzZS5zaXplKTsKPiAgCWRybV9t
bV9yZW1vdmVfbm9kZSgmbWFwcGluZy0+dnJhbV9ub2RlKTsKPiAgfQo+ICAKPiAtc3RhdGljIGlu
dCBldG5hdml2X2lvbW11X2ZpbmRfaW92YShzdHJ1Y3QgZXRuYXZpdl9pb21tdSAqbW11LAo+ICtz
dGF0aWMgaW50IGV0bmF2aXZfaW9tbXVfZmluZF9pb3ZhKHN0cnVjdCBldG5hdml2X2lvbW11X2Nv
bnRleHQgKmNvbnRleHQsCj4gIAkJCQkgICBzdHJ1Y3QgZHJtX21tX25vZGUgKm5vZGUsIHNpemVf
dCBzaXplKQo+ICB7Cj4gIAlzdHJ1Y3QgZXRuYXZpdl92cmFtX21hcHBpbmcgKmZyZWUgPSBOVUxM
Owo+ICAJZW51bSBkcm1fbW1faW5zZXJ0X21vZGUgbW9kZSA9IERSTV9NTV9JTlNFUlRfTE9XOwo+
ICAJaW50IHJldDsKPiAgCj4gLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZtbXUtPmxvY2spOwo+ICsJ
bG9ja2RlcF9hc3NlcnRfaGVsZCgmY29udGV4dC0+bG9jayk7Cj4gIAo+ICAJd2hpbGUgKDEpIHsK
PiAgCQlzdHJ1Y3QgZXRuYXZpdl92cmFtX21hcHBpbmcgKm0sICpuOwo+IEBAIC0xNTAsMTcgKzE0
OCwxNyBAQCBzdGF0aWMgaW50IGV0bmF2aXZfaW9tbXVfZmluZF9pb3ZhKHN0cnVjdCBldG5hdml2
X2lvbW11ICptbXUsCj4gIAkJc3RydWN0IGxpc3RfaGVhZCBsaXN0Owo+ICAJCWJvb2wgZm91bmQ7
Cj4gIAo+IC0JCXJldCA9IGRybV9tbV9pbnNlcnRfbm9kZV9pbl9yYW5nZSgmbW11LT5tbSwgbm9k
ZSwKPiArCQlyZXQgPSBkcm1fbW1faW5zZXJ0X25vZGVfaW5fcmFuZ2UoJmNvbnRleHQtPm1tLCBu
b2RlLAo+ICAJCQkJCQkgIHNpemUsIDAsIDAsIDAsIFU2NF9NQVgsIG1vZGUpOwo+ICAJCWlmIChy
ZXQgIT0gLUVOT1NQQykKPiAgCQkJYnJlYWs7Cj4gIAo+ICAJCS8qIFRyeSB0byByZXRpcmUgc29t
ZSBlbnRyaWVzICovCj4gLQkJZHJtX21tX3NjYW5faW5pdCgmc2NhbiwgJm1tdS0+bW0sIHNpemUs
IDAsIDAsIG1vZGUpOwo+ICsJCWRybV9tbV9zY2FuX2luaXQoJnNjYW4sICZjb250ZXh0LT5tbSwg
c2l6ZSwgMCwgMCwgbW9kZSk7Cj4gIAo+ICAJCWZvdW5kID0gMDsKPiAgCQlJTklUX0xJU1RfSEVB
RCgmbGlzdCk7Cj4gLQkJbGlzdF9mb3JfZWFjaF9lbnRyeShmcmVlLCAmbW11LT5tYXBwaW5ncywg
bW11X25vZGUpIHsKPiArCQlsaXN0X2Zvcl9lYWNoX2VudHJ5KGZyZWUsICZjb250ZXh0LT5tYXBw
aW5ncywgbW11X25vZGUpIHsKPiAgCQkJLyogSWYgdGhpcyB2cmFtIG5vZGUgaGFzIG5vdCBiZWVu
IHVzZWQsIHNraXAgdGhpcy4gKi8KPiAgCQkJaWYgKCFmcmVlLT52cmFtX25vZGUubW0pCj4gIAkJ
CQljb250aW51ZTsKPiBAQCAtMjAyLDggKzIwMCw4IEBAIHN0YXRpYyBpbnQgZXRuYXZpdl9pb21t
dV9maW5kX2lvdmEoc3RydWN0IGV0bmF2aXZfaW9tbXUgKm1tdSwKPiAgCQkgKiB0aGlzIG1hcHBp
bmcuCj4gIAkJICovCj4gIAkJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKG0sIG4sICZsaXN0LCBz
Y2FuX25vZGUpIHsKPiAtCQkJZXRuYXZpdl9pb21tdV9yZW1vdmVfbWFwcGluZyhtbXUsIG0pOwo+
IC0JCQltLT5tbXUgPSBOVUxMOwo+ICsJCQlldG5hdml2X2lvbW11X3JlbW92ZV9tYXBwaW5nKGNv
bnRleHQsIG0pOwo+ICsJCQltLT5jb250ZXh0ID0gTlVMTDsKPiAgCQkJbGlzdF9kZWxfaW5pdCgm
bS0+bW11X25vZGUpOwo+ICAJCQlsaXN0X2RlbF9pbml0KCZtLT5zY2FuX25vZGUpOwo+ICAJCX0K
PiBAQCAtMjE5LDcgKzIxNyw3IEBAIHN0YXRpYyBpbnQgZXRuYXZpdl9pb21tdV9maW5kX2lvdmEo
c3RydWN0IGV0bmF2aXZfaW9tbXUgKm1tdSwKPiAgCXJldHVybiByZXQ7Cj4gIH0KPiAgCj4gLWlu
dCBldG5hdml2X2lvbW11X21hcF9nZW0oc3RydWN0IGV0bmF2aXZfaW9tbXUgKm1tdSwKPiAraW50
IGV0bmF2aXZfaW9tbXVfbWFwX2dlbShzdHJ1Y3QgZXRuYXZpdl9pb21tdV9jb250ZXh0ICpjb250
ZXh0LAo+ICAJc3RydWN0IGV0bmF2aXZfZ2VtX29iamVjdCAqZXRuYXZpdl9vYmosIHUzMiBtZW1v
cnlfYmFzZSwKPiAgCXN0cnVjdCBldG5hdml2X3ZyYW1fbWFwcGluZyAqbWFwcGluZykKPiAgewo+
IEBAIC0yMjksMTcgKzIyNywxNyBAQCBpbnQgZXRuYXZpdl9pb21tdV9tYXBfZ2VtKHN0cnVjdCBl
dG5hdml2X2lvbW11ICptbXUsCj4gIAo+ICAJbG9ja2RlcF9hc3NlcnRfaGVsZCgmZXRuYXZpdl9v
YmotPmxvY2spOwo+ICAKPiAtCW11dGV4X2xvY2soJm1tdS0+bG9jayk7Cj4gKwltdXRleF9sb2Nr
KCZjb250ZXh0LT5sb2NrKTsKPiAgCj4gIAkvKiB2MSBNTVUgY2FuIG9wdGltaXplIHNpbmdsZSBl
bnRyeSAoY29udGlndW91cykgc2NhdHRlcmxpc3RzICovCj4gLQlpZiAobW11LT52ZXJzaW9uID09
IEVUTkFWSVZfSU9NTVVfVjEgJiYKPiArCWlmIChjb250ZXh0LT5nbG9iYWwtPnZlcnNpb24gPT0g
RVROQVZJVl9JT01NVV9WMSAmJgo+ICAJICAgIHNndC0+bmVudHMgPT0gMSAmJiAhKGV0bmF2aXZf
b2JqLT5mbGFncyAmIEVUTkFfQk9fRk9SQ0VfTU1VKSkgewo+ICAJCXUzMiBpb3ZhOwo+ICAKPiAg
CQlpb3ZhID0gc2dfZG1hX2FkZHJlc3Moc2d0LT5zZ2wpIC0gbWVtb3J5X2Jhc2U7Cj4gIAkJaWYg
KGlvdmEgPCAweDgwMDAwMDAwIC0gc2dfZG1hX2xlbihzZ3QtPnNnbCkpIHsKPiAgCQkJbWFwcGlu
Zy0+aW92YSA9IGlvdmE7Cj4gLQkJCWxpc3RfYWRkX3RhaWwoJm1hcHBpbmctPm1tdV9ub2RlLCAm
bW11LT5tYXBwaW5ncyk7Cj4gKwkJCWxpc3RfYWRkX3RhaWwoJm1hcHBpbmctPm1tdV9ub2RlLCAm
Y29udGV4dC0+bWFwcGluZ3MpOwo+ICAJCQlyZXQgPSAwOwo+ICAJCQlnb3RvIHVubG9jazsKPiAg
CQl9Cj4gQEAgLTI0NywxMiArMjQ1LDEyIEBAIGludCBldG5hdml2X2lvbW11X21hcF9nZW0oc3Ry
dWN0IGV0bmF2aXZfaW9tbXUgKm1tdSwKPiAgCj4gIAlub2RlID0gJm1hcHBpbmctPnZyYW1fbm9k
ZTsKPiAgCj4gLQlyZXQgPSBldG5hdml2X2lvbW11X2ZpbmRfaW92YShtbXUsIG5vZGUsIGV0bmF2
aXZfb2JqLT5iYXNlLnNpemUpOwo+ICsJcmV0ID0gZXRuYXZpdl9pb21tdV9maW5kX2lvdmEoY29u
dGV4dCwgbm9kZSwgZXRuYXZpdl9vYmotPmJhc2Uuc2l6ZSk7Cj4gIAlpZiAocmV0IDwgMCkKPiAg
CQlnb3RvIHVubG9jazsKPiAgCj4gIAltYXBwaW5nLT5pb3ZhID0gbm9kZS0+c3RhcnQ7Cj4gLQly
ZXQgPSBldG5hdml2X2lvbW11X21hcChtbXUsIG5vZGUtPnN0YXJ0LCBzZ3QsIGV0bmF2aXZfb2Jq
LT5iYXNlLnNpemUsCj4gKwlyZXQgPSBldG5hdml2X2lvbW11X21hcChjb250ZXh0LCBub2RlLT5z
dGFydCwgc2d0LCBldG5hdml2X29iai0+YmFzZS5zaXplLAo+ICAJCQkJRVROQVZJVl9QUk9UX1JF
QUQgfCBFVE5BVklWX1BST1RfV1JJVEUpOwo+ICAKPiAgCWlmIChyZXQgPCAwKSB7Cj4gQEAgLTI2
MCw3OSArMjU4LDU4IEBAIGludCBldG5hdml2X2lvbW11X21hcF9nZW0oc3RydWN0IGV0bmF2aXZf
aW9tbXUgKm1tdSwKPiAgCQlnb3RvIHVubG9jazsKPiAgCX0KPiAgCj4gLQlsaXN0X2FkZF90YWls
KCZtYXBwaW5nLT5tbXVfbm9kZSwgJm1tdS0+bWFwcGluZ3MpOwo+IC0JbW11LT5mbHVzaF9zZXEr
KzsKPiArCWxpc3RfYWRkX3RhaWwoJm1hcHBpbmctPm1tdV9ub2RlLCAmY29udGV4dC0+bWFwcGlu
Z3MpOwo+ICsJY29udGV4dC0+Zmx1c2hfc2VxKys7Cj4gIHVubG9jazoKPiAtCW11dGV4X3VubG9j
aygmbW11LT5sb2NrKTsKPiArCW11dGV4X3VubG9jaygmY29udGV4dC0+bG9jayk7Cj4gIAo+ICAJ
cmV0dXJuIHJldDsKPiAgfQo+ICAKPiAtdm9pZCBldG5hdml2X2lvbW11X3VubWFwX2dlbShzdHJ1
Y3QgZXRuYXZpdl9pb21tdSAqbW11LAo+ICt2b2lkIGV0bmF2aXZfaW9tbXVfdW5tYXBfZ2VtKHN0
cnVjdCBldG5hdml2X2lvbW11X2NvbnRleHQgKmNvbnRleHQsCj4gIAlzdHJ1Y3QgZXRuYXZpdl92
cmFtX21hcHBpbmcgKm1hcHBpbmcpCj4gIHsKPiAgCVdBUk5fT04obWFwcGluZy0+dXNlKTsKPiAg
Cj4gLQltdXRleF9sb2NrKCZtbXUtPmxvY2spOwo+ICsJbXV0ZXhfbG9jaygmY29udGV4dC0+bG9j
ayk7Cj4gIAo+ICAJLyogSWYgdGhlIHZyYW0gbm9kZSBpcyBvbiB0aGUgbW0sIHVubWFwIGFuZCBy
ZW1vdmUgdGhlIG5vZGUgKi8KPiAtCWlmIChtYXBwaW5nLT52cmFtX25vZGUubW0gPT0gJm1tdS0+
bW0pCj4gLQkJZXRuYXZpdl9pb21tdV9yZW1vdmVfbWFwcGluZyhtbXUsIG1hcHBpbmcpOwo+ICsJ
aWYgKG1hcHBpbmctPnZyYW1fbm9kZS5tbSA9PSAmY29udGV4dC0+bW0pCj4gKwkJZXRuYXZpdl9p
b21tdV9yZW1vdmVfbWFwcGluZyhjb250ZXh0LCBtYXBwaW5nKTsKPiAgCj4gIAlsaXN0X2RlbCgm
bWFwcGluZy0+bW11X25vZGUpOwo+IC0JbW11LT5mbHVzaF9zZXErKzsKPiAtCW11dGV4X3VubG9j
aygmbW11LT5sb2NrKTsKPiArCWNvbnRleHQtPmZsdXNoX3NlcSsrOwo+ICsJbXV0ZXhfdW5sb2Nr
KCZjb250ZXh0LT5sb2NrKTsKPiAgfQo+ICAKPiAtdm9pZCBldG5hdml2X2lvbW11X2Rlc3Ryb3ko
c3RydWN0IGV0bmF2aXZfaW9tbXUgKm1tdSkKPiArc3RhdGljIHZvaWQgZXRuYXZpdl9pb21tdV9j
b250ZXh0X2ZyZWUoc3RydWN0IGtyZWYgKmtyZWYpCj4gIHsKPiAtCWRybV9tbV90YWtlZG93bigm
bW11LT5tbSk7Cj4gLQltbXUtPmRvbWFpbi0+b3BzLT5mcmVlKG1tdS0+ZG9tYWluKTsKPiAtCWtm
cmVlKG1tdSk7Cj4gLX0KPiArCXN0cnVjdCBldG5hdml2X2lvbW11X2NvbnRleHQgKmNvbnRleHQg
PQo+ICsJCWNvbnRhaW5lcl9vZihrcmVmLCBzdHJ1Y3QgZXRuYXZpdl9pb21tdV9jb250ZXh0LCBy
ZWZjb3VudCk7Cj4gIAo+IC1zdHJ1Y3QgZXRuYXZpdl9pb21tdSAqZXRuYXZpdl9pb21tdV9uZXco
c3RydWN0IGV0bmF2aXZfZ3B1ICpncHUpCj4gKwljb250ZXh0LT5nbG9iYWwtPm9wcy0+ZnJlZShj
b250ZXh0KTsKPiArfQo+ICt2b2lkIGV0bmF2aXZfaW9tbXVfY29udGV4dF9wdXQoc3RydWN0IGV0
bmF2aXZfaW9tbXVfY29udGV4dCAqY29udGV4dCkKPiAgewo+IC0JZW51bSBldG5hdml2X2lvbW11
X3ZlcnNpb24gdmVyc2lvbjsKPiAtCXN0cnVjdCBldG5hdml2X2lvbW11ICptbXU7Cj4gLQo+IC0J
bW11ID0ga3phbGxvYyhzaXplb2YoKm1tdSksIEdGUF9LRVJORUwpOwo+IC0JaWYgKCFtbXUpCj4g
LQkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7Cj4gLQo+IC0JaWYgKCEoZ3B1LT5pZGVudGl0eS5t
aW5vcl9mZWF0dXJlczEgJiBjaGlwTWlub3JGZWF0dXJlczFfTU1VX1ZFUlNJT04pKSB7Cj4gLQkJ
bW11LT5kb21haW4gPSBldG5hdml2X2lvbW11djFfZG9tYWluX2FsbG9jKGdwdSk7Cj4gLQkJdmVy
c2lvbiA9IEVUTkFWSVZfSU9NTVVfVjE7Cj4gLQl9IGVsc2Ugewo+IC0JCW1tdS0+ZG9tYWluID0g
ZXRuYXZpdl9pb21tdXYyX2RvbWFpbl9hbGxvYyhncHUpOwo+IC0JCXZlcnNpb24gPSBFVE5BVklW
X0lPTU1VX1YyOwo+IC0JfQo+IC0KPiAtCWlmICghbW11LT5kb21haW4pIHsKPiAtCQlkZXZfZXJy
KGdwdS0+ZGV2LCAiRmFpbGVkIHRvIGFsbG9jYXRlIEdQVSBJT01NVSBkb21haW5cbiIpOwo+IC0J
CWtmcmVlKG1tdSk7Cj4gLQkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7Cj4gLQl9Cj4gLQo+IC0J
bW11LT5ncHUgPSBncHU7Cj4gLQltbXUtPnZlcnNpb24gPSB2ZXJzaW9uOwo+IC0JbXV0ZXhfaW5p
dCgmbW11LT5sb2NrKTsKPiAtCUlOSVRfTElTVF9IRUFEKCZtbXUtPm1hcHBpbmdzKTsKPiAtCj4g
LQlkcm1fbW1faW5pdCgmbW11LT5tbSwgbW11LT5kb21haW4tPmJhc2UsIG1tdS0+ZG9tYWluLT5z
aXplKTsKPiAtCj4gLQlyZXR1cm4gbW11Owo+ICsJa3JlZl9wdXQoJmNvbnRleHQtPnJlZmNvdW50
LCBldG5hdml2X2lvbW11X2NvbnRleHRfZnJlZSk7Cj4gIH0KPiAgCj4gLXZvaWQgZXRuYXZpdl9p
b21tdV9yZXN0b3JlKHN0cnVjdCBldG5hdml2X2dwdSAqZ3B1KQo+ICtzdHJ1Y3QgZXRuYXZpdl9p
b21tdV9jb250ZXh0ICoKPiArZXRuYXZpdl9pb21tdV9jb250ZXh0X2luaXQoc3RydWN0IGV0bmF2
aXZfaW9tbXVfZ2xvYmFsICpnbG9iYWwpCj4gIHsKPiAtCWlmIChncHUtPm1tdS0+dmVyc2lvbiA9
PSBFVE5BVklWX0lPTU1VX1YxKQo+IC0JCWV0bmF2aXZfaW9tbXV2MV9yZXN0b3JlKGdwdSk7Cj4g
KwlpZiAoZ2xvYmFsLT52ZXJzaW9uID09IEVUTkFWSVZfSU9NTVVfVjEpCj4gKwkJcmV0dXJuIGV0
bmF2aXZfaW9tbXV2MV9jb250ZXh0X2FsbG9jKGdsb2JhbCk7Cj4gIAllbHNlCj4gLQkJZXRuYXZp
dl9pb21tdXYyX3Jlc3RvcmUoZ3B1KTsKPiArCQlyZXR1cm4gZXRuYXZpdl9pb21tdXYyX2NvbnRl
eHRfYWxsb2MoZ2xvYmFsKTsKPiArfQo+ICsKPiArdm9pZCBldG5hdml2X2lvbW11X3Jlc3RvcmUo
c3RydWN0IGV0bmF2aXZfZ3B1ICpncHUsCj4gKwkJCSAgIHN0cnVjdCBldG5hdml2X2lvbW11X2Nv
bnRleHQgKmNvbnRleHQpCj4gK3sKPiArCWNvbnRleHQtPmdsb2JhbC0+b3BzLT5yZXN0b3JlKGdw
dSwgY29udGV4dCk7Cj4gIH0KPiAgCj4gLWludCBldG5hdml2X2lvbW11X2dldF9zdWJhbGxvY192
YShzdHJ1Y3QgZXRuYXZpdl9pb21tdSAqbW11LAo+ICtpbnQgZXRuYXZpdl9pb21tdV9nZXRfc3Vi
YWxsb2NfdmEoc3RydWN0IGV0bmF2aXZfaW9tbXVfY29udGV4dCAqY29udGV4dCwKPiAgCQkJCSAg
c3RydWN0IGV0bmF2aXZfdnJhbV9tYXBwaW5nICptYXBwaW5nLAo+ICAJCQkJICB1MzIgbWVtb3J5
X2Jhc2UsIGRtYV9hZGRyX3QgcGFkZHIsCj4gIAkJCQkgIHNpemVfdCBzaXplKQo+IEBAIC0zNDAs
MjMgKzMxNywyMyBAQCBpbnQgZXRuYXZpdl9pb21tdV9nZXRfc3ViYWxsb2NfdmEoc3RydWN0IGV0
bmF2aXZfaW9tbXUgKm1tdSwKPiAgCXN0cnVjdCBkcm1fbW1fbm9kZSAqbm9kZTsKPiAgCWludCBy
ZXQ7Cj4gIAo+IC0JaWYgKG1tdS0+dmVyc2lvbiA9PSBFVE5BVklWX0lPTU1VX1YxKSB7Cj4gKwlp
ZiAoY29udGV4dC0+Z2xvYmFsLT52ZXJzaW9uID09IEVUTkFWSVZfSU9NTVVfVjEpIHsKPiAgCQlt
YXBwaW5nLT5pb3ZhID0gcGFkZHIgLSBtZW1vcnlfYmFzZTsKPiAgCQltYXBwaW5nLT51c2UgPSAx
Owo+IC0JCWxpc3RfYWRkX3RhaWwoJm1hcHBpbmctPm1tdV9ub2RlLCAmbW11LT5tYXBwaW5ncyk7
Cj4gKwkJbGlzdF9hZGRfdGFpbCgmbWFwcGluZy0+bW11X25vZGUsICZjb250ZXh0LT5tYXBwaW5n
cyk7Cj4gIAkJcmV0dXJuIDA7Cj4gIAl9Cj4gIAo+ICAJbm9kZSA9ICZtYXBwaW5nLT52cmFtX25v
ZGU7Cj4gIAo+IC0JbXV0ZXhfbG9jaygmbW11LT5sb2NrKTsKPiArCW11dGV4X2xvY2soJmNvbnRl
eHQtPmxvY2spOwo+ICAKPiAtCXJldCA9IGV0bmF2aXZfaW9tbXVfZmluZF9pb3ZhKG1tdSwgbm9k
ZSwgc2l6ZSk7Cj4gKwlyZXQgPSBldG5hdml2X2lvbW11X2ZpbmRfaW92YShjb250ZXh0LCBub2Rl
LCBzaXplKTsKPiAgCWlmIChyZXQgPCAwKQo+ICAJCWdvdG8gdW5sb2NrOwo+ICAKPiAgCW1hcHBp
bmctPmlvdmEgPSBub2RlLT5zdGFydDsKPiAtCXJldCA9IGV0bmF2aXZfZG9tYWluX21hcChtbXUt
PmRvbWFpbiwgbm9kZS0+c3RhcnQsIHBhZGRyLCBzaXplLAo+ICsJcmV0ID0gZXRuYXZpdl9jb250
ZXh0X21hcChjb250ZXh0LCBub2RlLT5zdGFydCwgcGFkZHIsIHNpemUsCj4gIAkJCQkgRVROQVZJ
Vl9QUk9UX1JFQUQpOwo+ICAKPiAgCWlmIChyZXQgPCAwKSB7Cj4gQEAgLTM2NCwzNiArMzQxLDk2
IEBAIGludCBldG5hdml2X2lvbW11X2dldF9zdWJhbGxvY192YShzdHJ1Y3QgZXRuYXZpdl9pb21t
dSAqbW11LAo+ICAJCWdvdG8gdW5sb2NrOwo+ICAJfQo+ICAKPiAtCWxpc3RfYWRkX3RhaWwoJm1h
cHBpbmctPm1tdV9ub2RlLCAmbW11LT5tYXBwaW5ncyk7Cj4gLQltbXUtPmZsdXNoX3NlcSsrOwo+
ICsJbGlzdF9hZGRfdGFpbCgmbWFwcGluZy0+bW11X25vZGUsICZjb250ZXh0LT5tYXBwaW5ncyk7
Cj4gKwljb250ZXh0LT5mbHVzaF9zZXErKzsKPiAgdW5sb2NrOgo+IC0JbXV0ZXhfdW5sb2NrKCZt
bXUtPmxvY2spOwo+ICsJbXV0ZXhfdW5sb2NrKCZjb250ZXh0LT5sb2NrKTsKPiAgCj4gIAlyZXR1
cm4gcmV0Owo+ICB9Cj4gIAo+IC12b2lkIGV0bmF2aXZfaW9tbXVfcHV0X3N1YmFsbG9jX3ZhKHN0
cnVjdCBldG5hdml2X2lvbW11ICptbXUsCj4gK3ZvaWQgZXRuYXZpdl9pb21tdV9wdXRfc3ViYWxs
b2NfdmEoc3RydWN0IGV0bmF2aXZfaW9tbXVfY29udGV4dCAqY29udGV4dCwKPiAgCQkgIHN0cnVj
dCBldG5hdml2X3ZyYW1fbWFwcGluZyAqbWFwcGluZykKPiAgewo+ICAJc3RydWN0IGRybV9tbV9u
b2RlICpub2RlID0gJm1hcHBpbmctPnZyYW1fbm9kZTsKPiAgCj4gIAltYXBwaW5nLT51c2UgPSAw
Owo+ICAKPiAtCWlmIChtbXUtPnZlcnNpb24gPT0gRVROQVZJVl9JT01NVV9WMSkKPiArCWlmIChj
b250ZXh0LT5nbG9iYWwtPnZlcnNpb24gPT0gRVROQVZJVl9JT01NVV9WMSkKPiAgCQlyZXR1cm47
Cj4gIAo+IC0JbXV0ZXhfbG9jaygmbW11LT5sb2NrKTsKPiAtCWV0bmF2aXZfZG9tYWluX3VubWFw
KG1tdS0+ZG9tYWluLCBub2RlLT5zdGFydCwgbm9kZS0+c2l6ZSk7Cj4gKwltdXRleF9sb2NrKCZj
b250ZXh0LT5sb2NrKTsKPiArCWV0bmF2aXZfY29udGV4dF91bm1hcChjb250ZXh0LCBub2RlLT5z
dGFydCwgbm9kZS0+c2l6ZSk7Cj4gIAlkcm1fbW1fcmVtb3ZlX25vZGUobm9kZSk7Cj4gLQltdXRl
eF91bmxvY2soJm1tdS0+bG9jayk7Cj4gKwltdXRleF91bmxvY2soJmNvbnRleHQtPmxvY2spOwo+
ICB9Cj4gIAo+IC1zaXplX3QgZXRuYXZpdl9pb21tdV9kdW1wX3NpemUoc3RydWN0IGV0bmF2aXZf
aW9tbXUgKmlvbW11KQo+ICtzaXplX3QgZXRuYXZpdl9pb21tdV9kdW1wX3NpemUoc3RydWN0IGV0
bmF2aXZfaW9tbXVfY29udGV4dCAqY29udGV4dCkKPiAgewo+IC0JcmV0dXJuIGlvbW11LT5kb21h
aW4tPm9wcy0+ZHVtcF9zaXplKGlvbW11LT5kb21haW4pOwo+ICsJcmV0dXJuIGNvbnRleHQtPmds
b2JhbC0+b3BzLT5kdW1wX3NpemUoY29udGV4dCk7Cj4gIH0KPiAgCj4gLXZvaWQgZXRuYXZpdl9p
b21tdV9kdW1wKHN0cnVjdCBldG5hdml2X2lvbW11ICppb21tdSwgdm9pZCAqYnVmKQo+ICt2b2lk
IGV0bmF2aXZfaW9tbXVfZHVtcChzdHJ1Y3QgZXRuYXZpdl9pb21tdV9jb250ZXh0ICpjb250ZXh0
LCB2b2lkICpidWYpCj4gK3sKPiArCWNvbnRleHQtPmdsb2JhbC0+b3BzLT5kdW1wKGNvbnRleHQs
IGJ1Zik7Cj4gK30KPiArCj4gK2V4dGVybiBjb25zdCBzdHJ1Y3QgZXRuYXZpdl9pb21tdV9vcHMg
ZXRuYXZpdl9pb21tdXYxX29wczsKPiArZXh0ZXJuIGNvbnN0IHN0cnVjdCBldG5hdml2X2lvbW11
X29wcyBldG5hdml2X2lvbW11djJfb3BzOwo+ICsKPiArc3RydWN0IGV0bmF2aXZfaW9tbXVfZ2xv
YmFsICoKPiArZXRuYXZpdl9pb21tdV9nbG9iYWxfaW5pdChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4g
KwkJCSAgZW51bSBldG5hdml2X2lvbW11X3ZlcnNpb24gdmVyc2lvbikKPiAgewo+IC0JaW9tbXUt
PmRvbWFpbi0+b3BzLT5kdW1wKGlvbW11LT5kb21haW4sIGJ1Zik7Cj4gKwlzdHJ1Y3QgZXRuYXZp
dl9pb21tdV9nbG9iYWwgKmdsb2JhbDsKPiArCj4gKwlnbG9iYWwgPSBremFsbG9jKHNpemVvZigq
Z2xvYmFsKSwgR0ZQX0tFUk5FTCk7Cj4gKwlpZiAoIWdsb2JhbCkKPiArCQlyZXR1cm4gTlVMTDsK
PiArCj4gKwlnbG9iYWwtPmJhZF9wYWdlX2NwdSA9IGRtYV9hbGxvY193YyhkZXYsIFNaXzRLLCAm
Z2xvYmFsLT5iYWRfcGFnZV9kbWEsCj4gKwkJCQkJICAgIEdGUF9LRVJORUwpOwo+ICsJaWYgKCFn
bG9iYWwtPmJhZF9wYWdlX2NwdSkKPiArCQlnb3RvIGZyZWVfZ2xvYmFsOwo+ICsKPiArCW1lbXNl
dDMyKGdsb2JhbC0+YmFkX3BhZ2VfY3B1LCAweGRlYWQ1NWFhLCBTWl80SyAvIHNpemVvZih1MzIp
KTsKPiArCj4gKwlpZiAodmVyc2lvbiA9PSBFVE5BVklWX0lPTU1VX1YyKSB7Cj4gKwkJZ2xvYmFs
LT52Mi5wdGFfY3B1ID0gZG1hX2FsbG9jX3djKGRldiwgRVROQVZJVl9QVEFfU0laRSwKPiArCQkJ
CQkgICAgICAgJmdsb2JhbC0+djIucHRhX2RtYSwgR0ZQX0tFUk5FTCk7Cj4gKwkJaWYgKCFnbG9i
YWwtPnYyLnB0YV9jcHUpCj4gKwkJCWdvdG8gZnJlZV9iYWRfcGFnZTsKPiArCX0KPiArCj4gKwln
bG9iYWwtPmRldiA9IGRldjsKPiArCWdsb2JhbC0+dmVyc2lvbiA9IHZlcnNpb247Cj4gKwltdXRl
eF9pbml0KCZnbG9iYWwtPmxvY2spOwo+ICsKPiArCWlmICh2ZXJzaW9uID09IEVUTkFWSVZfSU9N
TVVfVjEpCj4gKwkJZ2xvYmFsLT5vcHMgPSAmZXRuYXZpdl9pb21tdXYxX29wczsKPiArCWVsc2UK
PiArCQlnbG9iYWwtPm9wcyA9ICZldG5hdml2X2lvbW11djJfb3BzOwo+ICsKPiArCXJldHVybiBn
bG9iYWw7Cj4gKwo+ICtmcmVlX2JhZF9wYWdlOgo+ICsJZG1hX2ZyZWVfd2MoZGV2LCBTWl80Sywg
Z2xvYmFsLT5iYWRfcGFnZV9jcHUsIGdsb2JhbC0+YmFkX3BhZ2VfZG1hKTsKPiArZnJlZV9nbG9i
YWw6Cj4gKwlrZnJlZShnbG9iYWwpOwo+ICsKPiArCXJldHVybiBOVUxMOwo+ICt9Cj4gKwo+ICt2
b2lkIGV0bmF2aXZfaW9tbXVfZ2xvYmFsX2Zpbmkoc3RydWN0IGV0bmF2aXZfaW9tbXVfZ2xvYmFs
ICpnbG9iYWwpCj4gK3sKPiArCWlmIChnbG9iYWwtPnYyLnB0YV9jcHUpCj4gKwkJZG1hX2ZyZWVf
d2MoZ2xvYmFsLT5kZXYsIEVUTkFWSVZfUFRBX1NJWkUsCj4gKwkJCSAgICBnbG9iYWwtPnYyLnB0
YV9jcHUsIGdsb2JhbC0+djIucHRhX2RtYSk7Cj4gKwo+ICsJaWYgKGdsb2JhbC0+YmFkX3BhZ2Vf
Y3B1KQo+ICsJCWRtYV9mcmVlX3djKGdsb2JhbC0+ZGV2LCBTWl80SywKPiArCQkJICAgIGdsb2Jh
bC0+YmFkX3BhZ2VfY3B1LCBnbG9iYWwtPmJhZF9wYWdlX2RtYSk7Cj4gKwo+ICsJbXV0ZXhfZGVz
dHJveSgmZ2xvYmFsLT5sb2NrKTsKPiArCWtmcmVlKGdsb2JhbCk7Cj4gIH0KPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9tbXUuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9ldG5hdml2L2V0bmF2aXZfbW11LmgKPiBpbmRleCAzNGFmZTI1ZGY5Y2EuLmZiY2VmY2U4NzNj
YSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X21tdS5oCj4g
KysrIGIvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9tbXUuaAo+IEBAIC0xNiwzMyAr
MTYsNTQgQEAgZW51bSBldG5hdml2X2lvbW11X3ZlcnNpb24gewo+ICAKPiAgc3RydWN0IGV0bmF2
aXZfZ3B1Owo+ICBzdHJ1Y3QgZXRuYXZpdl92cmFtX21hcHBpbmc7Cj4gLXN0cnVjdCBldG5hdml2
X2lvbW11X2RvbWFpbjsKPiArc3RydWN0IGV0bmF2aXZfaW9tbXVfZ2xvYmFsOwo+ICtzdHJ1Y3Qg
ZXRuYXZpdl9pb21tdV9jb250ZXh0Owo+ICAKPiAtc3RydWN0IGV0bmF2aXZfaW9tbXVfZG9tYWlu
X29wcyB7Cj4gLQl2b2lkICgqZnJlZSkoc3RydWN0IGV0bmF2aXZfaW9tbXVfZG9tYWluICopOwo+
IC0JaW50ICgqbWFwKShzdHJ1Y3QgZXRuYXZpdl9pb21tdV9kb21haW4gKmRvbWFpbiwgdW5zaWdu
ZWQgbG9uZyBpb3ZhLAo+ICtzdHJ1Y3QgZXRuYXZpdl9pb21tdV9vcHMgewo+ICsJc3RydWN0IGV0
bmF2aXZfaW9tbXVfY29udGV4dCAqKCppbml0KShzdHJ1Y3QgZXRuYXZpdl9pb21tdV9nbG9iYWwg
Kik7Cj4gKwl2b2lkICgqZnJlZSkoc3RydWN0IGV0bmF2aXZfaW9tbXVfY29udGV4dCAqKTsKPiAr
CWludCAoKm1hcCkoc3RydWN0IGV0bmF2aXZfaW9tbXVfY29udGV4dCAqY29udGV4dCwgdW5zaWdu
ZWQgbG9uZyBpb3ZhLAo+ICAJCSAgIHBoeXNfYWRkcl90IHBhZGRyLCBzaXplX3Qgc2l6ZSwgaW50
IHByb3QpOwo+IC0Jc2l6ZV90ICgqdW5tYXApKHN0cnVjdCBldG5hdml2X2lvbW11X2RvbWFpbiAq
ZG9tYWluLCB1bnNpZ25lZCBsb25nIGlvdmEsCj4gKwlzaXplX3QgKCp1bm1hcCkoc3RydWN0IGV0
bmF2aXZfaW9tbXVfY29udGV4dCAqY29udGV4dCwgdW5zaWduZWQgbG9uZyBpb3ZhLAo+ICAJCQlz
aXplX3Qgc2l6ZSk7Cj4gLQlzaXplX3QgKCpkdW1wX3NpemUpKHN0cnVjdCBldG5hdml2X2lvbW11
X2RvbWFpbiAqKTsKPiAtCXZvaWQgKCpkdW1wKShzdHJ1Y3QgZXRuYXZpdl9pb21tdV9kb21haW4g
Kiwgdm9pZCAqKTsKPiArCXNpemVfdCAoKmR1bXBfc2l6ZSkoc3RydWN0IGV0bmF2aXZfaW9tbXVf
Y29udGV4dCAqKTsKPiArCXZvaWQgKCpkdW1wKShzdHJ1Y3QgZXRuYXZpdl9pb21tdV9jb250ZXh0
ICosIHZvaWQgKik7Cj4gKwl2b2lkICgqcmVzdG9yZSkoc3RydWN0IGV0bmF2aXZfZ3B1ICosIHN0
cnVjdCBldG5hdml2X2lvbW11X2NvbnRleHQgKik7Cj4gIH07Cj4gIAo+IC1zdHJ1Y3QgZXRuYXZp
dl9pb21tdV9kb21haW4gewo+ICsjZGVmaW5lIEVUTkFWSVZfUFRBX1NJWkUJU1pfNEsKPiArI2Rl
ZmluZSBFVE5BVklWX1BUQV9FTlRSSUVTCShFVE5BVklWX1BUQV9TSVpFIC8gc2l6ZW9mKHU2NCkp
Cj4gKwo+ICtzdHJ1Y3QgZXRuYXZpdl9pb21tdV9nbG9iYWwgewo+ICAJc3RydWN0IGRldmljZSAq
ZGV2Owo+ICsJZW51bSBldG5hdml2X2lvbW11X3ZlcnNpb24gdmVyc2lvbjsKPiArCWNvbnN0IHN0
cnVjdCBldG5hdml2X2lvbW11X29wcyAqb3BzOwo+ICsJc3RydWN0IG11dGV4IGxvY2s7Cj4gKwo+
ICAJdm9pZCAqYmFkX3BhZ2VfY3B1Owo+ICAJZG1hX2FkZHJfdCBiYWRfcGFnZV9kbWE7Cj4gLQl1
NjQgYmFzZTsKPiAtCXU2NCBzaXplOwo+ICAKPiAtCWNvbnN0IHN0cnVjdCBldG5hdml2X2lvbW11
X2RvbWFpbl9vcHMgKm9wczsKPiArCS8qCj4gKwkgKiBUaGlzIHVuaW9uIGhvbGRzIG1lbWJlcnMg
bmVlZGVkIGJ5IGVpdGhlciBNTVV2MSBvciBNTVV2Miwgd2hpY2gKPiArCSAqIGNhbiBub3QgZXhp
c3QgYXQgdGhlIHNhbWUgdGltZS4KPiArCSAqLwo+ICsJdW5pb24gewo+ICsJCXN0cnVjdCB7Cj4g
KwkJCXN0cnVjdCBldG5hdml2X2lvbW11X2NvbnRleHQgKnNoYXJlZF9jb250ZXh0Owo+ICsJCX0g
djE7Cj4gKwkJc3RydWN0IHsKPiArCQkJLyogUChhZ2UpIFQoYWJsZSkgQShycmF5KSAqLwo+ICsJ
CQl1NjQgKnB0YV9jcHU7Cj4gKwkJCWRtYV9hZGRyX3QgcHRhX2RtYTsKPiArCQkJc3RydWN0IHNw
aW5sb2NrIHB0YV9sb2NrOwo+ICsJCQlERUNMQVJFX0JJVE1BUChwdGFfYWxsb2MsIEVUTkFWSVZf
UFRBX0VOVFJJRVMpOwo+ICsJCX0gdjI7Cj4gKwl9Owo+ICB9Owo+ICAKPiAtc3RydWN0IGV0bmF2
aXZfaW9tbXUgewo+IC0Jc3RydWN0IGV0bmF2aXZfZ3B1ICpncHU7Cj4gLQlzdHJ1Y3QgZXRuYXZp
dl9pb21tdV9kb21haW4gKmRvbWFpbjsKPiAtCj4gLQllbnVtIGV0bmF2aXZfaW9tbXVfdmVyc2lv
biB2ZXJzaW9uOwo+ICtzdHJ1Y3QgZXRuYXZpdl9pb21tdV9jb250ZXh0IHsKPiArCXN0cnVjdCBr
cmVmIHJlZmNvdW50Owo+ICsJc3RydWN0IGV0bmF2aXZfaW9tbXVfZ2xvYmFsICpnbG9iYWw7Cj4g
IAo+ICAJLyogbWVtb3J5IG1hbmFnZXIgZm9yIEdQVSBhZGRyZXNzIGFyZWEgKi8KPiAgCXN0cnVj
dCBtdXRleCBsb2NrOwo+IEBAIC01MSwyNiArNzIsNDEgQEAgc3RydWN0IGV0bmF2aXZfaW9tbXUg
ewo+ICAJdW5zaWduZWQgaW50IGZsdXNoX3NlcTsKPiAgfTsKPiAgCj4gK3N0cnVjdCBldG5hdml2
X2lvbW11X2dsb2JhbCAqZXRuYXZpdl9pb21tdV9nbG9iYWxfaW5pdChzdHJ1Y3QgZGV2aWNlICpk
ZXYsCj4gKwkJZW51bSBldG5hdml2X2lvbW11X3ZlcnNpb24gdmVyc2lvbik7Cj4gK3ZvaWQgZXRu
YXZpdl9pb21tdV9nbG9iYWxfZmluaShzdHJ1Y3QgZXRuYXZpdl9pb21tdV9nbG9iYWwgKmdsb2Jh
bCk7Cj4gKwo+ICBzdHJ1Y3QgZXRuYXZpdl9nZW1fb2JqZWN0Owo+ICAKPiAtaW50IGV0bmF2aXZf
aW9tbXVfbWFwX2dlbShzdHJ1Y3QgZXRuYXZpdl9pb21tdSAqbW11LAo+ICtpbnQgZXRuYXZpdl9p
b21tdV9tYXBfZ2VtKHN0cnVjdCBldG5hdml2X2lvbW11X2NvbnRleHQgKmNvbnRleHQsCj4gIAlz
dHJ1Y3QgZXRuYXZpdl9nZW1fb2JqZWN0ICpldG5hdml2X29iaiwgdTMyIG1lbW9yeV9iYXNlLAo+
ICAJc3RydWN0IGV0bmF2aXZfdnJhbV9tYXBwaW5nICptYXBwaW5nKTsKPiAtdm9pZCBldG5hdml2
X2lvbW11X3VubWFwX2dlbShzdHJ1Y3QgZXRuYXZpdl9pb21tdSAqbW11LAo+ICt2b2lkIGV0bmF2
aXZfaW9tbXVfdW5tYXBfZ2VtKHN0cnVjdCBldG5hdml2X2lvbW11X2NvbnRleHQgKmNvbnRleHQs
Cj4gIAlzdHJ1Y3QgZXRuYXZpdl92cmFtX21hcHBpbmcgKm1hcHBpbmcpOwo+ICAKPiAtaW50IGV0
bmF2aXZfaW9tbXVfZ2V0X3N1YmFsbG9jX3ZhKHN0cnVjdCBldG5hdml2X2lvbW11ICptbXUsCj4g
K2ludCBldG5hdml2X2lvbW11X2dldF9zdWJhbGxvY192YShzdHJ1Y3QgZXRuYXZpdl9pb21tdV9j
b250ZXh0ICpjdHgsCj4gIAkJCQkgIHN0cnVjdCBldG5hdml2X3ZyYW1fbWFwcGluZyAqbWFwcGlu
ZywKPiAgCQkJCSAgdTMyIG1lbW9yeV9iYXNlLCBkbWFfYWRkcl90IHBhZGRyLAo+ICAJCQkJICBz
aXplX3Qgc2l6ZSk7Cj4gLXZvaWQgZXRuYXZpdl9pb21tdV9wdXRfc3ViYWxsb2NfdmEoc3RydWN0
IGV0bmF2aXZfaW9tbXUgKm1tdSwKPiArdm9pZCBldG5hdml2X2lvbW11X3B1dF9zdWJhbGxvY192
YShzdHJ1Y3QgZXRuYXZpdl9pb21tdV9jb250ZXh0ICpjdHgsCj4gIAkJCQkgICBzdHJ1Y3QgZXRu
YXZpdl92cmFtX21hcHBpbmcgKm1hcHBpbmcpOwo+ICAKPiAtc2l6ZV90IGV0bmF2aXZfaW9tbXVf
ZHVtcF9zaXplKHN0cnVjdCBldG5hdml2X2lvbW11ICppb21tdSk7Cj4gLXZvaWQgZXRuYXZpdl9p
b21tdV9kdW1wKHN0cnVjdCBldG5hdml2X2lvbW11ICppb21tdSwgdm9pZCAqYnVmKTsKPiAtCj4g
LXN0cnVjdCBldG5hdml2X2lvbW11ICpldG5hdml2X2lvbW11X25ldyhzdHJ1Y3QgZXRuYXZpdl9n
cHUgKmdwdSk7Cj4gLXZvaWQgZXRuYXZpdl9pb21tdV9kZXN0cm95KHN0cnVjdCBldG5hdml2X2lv
bW11ICppb21tdSk7Cj4gLXZvaWQgZXRuYXZpdl9pb21tdV9yZXN0b3JlKHN0cnVjdCBldG5hdml2
X2dwdSAqZ3B1KTsKPiArc2l6ZV90IGV0bmF2aXZfaW9tbXVfZHVtcF9zaXplKHN0cnVjdCBldG5h
dml2X2lvbW11X2NvbnRleHQgKmN0eCk7Cj4gK3ZvaWQgZXRuYXZpdl9pb21tdV9kdW1wKHN0cnVj
dCBldG5hdml2X2lvbW11X2NvbnRleHQgKmN0eCwgdm9pZCAqYnVmKTsKPiArCj4gK3N0cnVjdCBl
dG5hdml2X2lvbW11X2NvbnRleHQgKgo+ICtldG5hdml2X2lvbW11X2NvbnRleHRfaW5pdChzdHJ1
Y3QgZXRuYXZpdl9pb21tdV9nbG9iYWwgKmdsb2JhbCk7Cj4gK3N0YXRpYyBpbmxpbmUgdm9pZCBl
dG5hdml2X2lvbW11X2NvbnRleHRfZ2V0KHN0cnVjdCBldG5hdml2X2lvbW11X2NvbnRleHQgKmN0
eCkKPiArewo+ICsJa3JlZl9nZXQoJmN0eC0+cmVmY291bnQpOwo+ICt9Cj4gK3ZvaWQgZXRuYXZp
dl9pb21tdV9jb250ZXh0X3B1dChzdHJ1Y3QgZXRuYXZpdl9pb21tdV9jb250ZXh0ICpjdHgpOwo+
ICt2b2lkIGV0bmF2aXZfaW9tbXVfcmVzdG9yZShzdHJ1Y3QgZXRuYXZpdl9ncHUgKmdwdSwKPiAr
CQkJICAgc3RydWN0IGV0bmF2aXZfaW9tbXVfY29udGV4dCAqY3R4KTsKPiArCj4gK3N0cnVjdCBl
dG5hdml2X2lvbW11X2NvbnRleHQgKgo+ICtldG5hdml2X2lvbW11djFfY29udGV4dF9hbGxvYyhz
dHJ1Y3QgZXRuYXZpdl9pb21tdV9nbG9iYWwgKmdsb2JhbCk7Cj4gK3N0cnVjdCBldG5hdml2X2lv
bW11X2NvbnRleHQgKgo+ICtldG5hdml2X2lvbW11djJfY29udGV4dF9hbGxvYyhzdHJ1Y3QgZXRu
YXZpdl9pb21tdV9nbG9iYWwgKmdsb2JhbCk7Cj4gIAo+ICAjZW5kaWYgLyogX19FVE5BVklWX01N
VV9IX18gKi8KPiAtLSAKPiAyLjIwLjEKPiAKPiBfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwo+IGV0bmF2aXYgbWFpbGluZyBsaXN0Cj4gZXRuYXZpdkBsaXN0
cy5mcmVlZGVza3RvcC5vcmcKPiBodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFu
L2xpc3RpbmZvL2V0bmF2aXYKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0
b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJp
LWRldmVs
