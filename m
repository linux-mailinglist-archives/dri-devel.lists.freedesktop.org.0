Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 297C615098C
	for <lists+dri-devel@lfdr.de>; Mon,  3 Feb 2020 16:15:09 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 036836EC52;
	Mon,  3 Feb 2020 15:15:06 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mga03.intel.com (mga03.intel.com [134.134.136.65])
 by gabe.freedesktop.org (Postfix) with ESMTPS id C18336EC39;
 Mon,  3 Feb 2020 15:15:03 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga003.fm.intel.com ([10.253.24.29])
 by orsmga103.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 03 Feb 2020 07:15:02 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.70,398,1574150400"; d="scan'208";a="278765805"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.174])
 by FMSMGA003.fm.intel.com with SMTP; 03 Feb 2020 07:15:00 -0800
Received: by stinkbox (sSMTP sendmail emulation);
 Mon, 03 Feb 2020 17:15:00 +0200
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 25/26] drm/i915: Try to probe DP++ dongles on DP++ downstream
 facing ports
Date: Mon,  3 Feb 2020 17:13:42 +0200
Message-Id: <20200203151343.14378-26-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.24.1
In-Reply-To: <20200203151343.14378-1-ville.syrjala@linux.intel.com>
References: <20200203151343.14378-1-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KCklu
IG9yZGVyIHRvIGdldCBhY2N1cmF0ZSBUTURTIGNsb2NrcyBsaW1pdHMgZm9yIHRoZSBEUCsrIHBv
cnRzIHdlCmNhbiB0cnkgdG8gcHJvYmUgdGhlIERQIGR1YWwgbW9kZSBhZGFwdGVyIHJlZ2lzdGVy
cy4gVW5mb3J0dW5hdGVseQpJJ3ZlIG5vdCB5ZXQgc2VlbiBhIERQLT5EUCsrIGJyYW5jaCBkZXZp
Y2UgdGhhdCB3b3VsZCBhY3R1YWxseQpmb3J3YXJkIHRoZXNlIGkyYyBhY2Nlc3NlcyB0byB0aGUg
ZHVhbCBtb2RlIGRvbmdsZSBkb3duc3RyZWFtLgpCdXQgd2UgZG9uJ3QgbG9zZSBtdWNoIGJ5IHRy
eWluZyBhbmQgbWF5YmUgaXQnbGwgd29yayBvbiBzb21lCmJyYW5jaCBkZXZpY2VzLCBpZiBub3Qg
bm93IHRoZW4gbWF5YmUgaW4gdGhlIGZ1dHVyZS4KClNpZ25lZC1vZmYtYnk6IFZpbGxlIFN5cmrD
pGzDpCA8dmlsbGUuc3lyamFsYUBsaW51eC5pbnRlbC5jb20+Ci0tLQogLi4uL2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oICAgIHwgIDEgKwogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9kcC5jICAgICAgIHwgNDEgKysrKysrKysrKysrKysrKysrKwogMiBm
aWxlcyBjaGFuZ2VkLCA0MiBpbnNlcnRpb25zKCspCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaAppbmRleCAwZDEzNTg1OWU5ZDQuLjVj
ZDA1MmY1NTY2MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9kaXNwbGF5X3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9kaXNwbGF5X3R5cGVzLmgKQEAgLTEzMTYsNiArMTMxNiw3IEBAIHN0cnVjdCBpbnRlbF9kcCB7
CiAJCXU4IG1heF9icGM7CiAJCWJvb2wgeWNiY3JfNDQ0X3RvXzQyMDsKIAl9IGRmcDsKKwlzdHJ1
Y3QgaW50ZWxfZHBfZHVhbF9tb2RlIGRwX2R1YWxfbW9kZTsKIH07CiAKIGVudW0gbHNwY29uX3Zl
bmRvciB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rw
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwLmMKaW5kZXggM2JmMTlk
NjkxZmQ1Li41MTQzYzFiMGZkOTIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfZHAuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2RwLmMKQEAgLTYwOCw2ICs2MDgsMTAgQEAgaW50ZWxfZHBfbW9kZV92YWxpZF9kb3duc3RyZWFt
KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwKIAkgICAgdG1kc19jbG9jayA+IGlu
dGVsX2RwLT5kZnAubWF4X3RtZHNfY2xvY2spCiAJCXJldHVybiBNT0RFX0NMT0NLX0hJR0g7CiAK
KwlpZiAoaW50ZWxfZHAtPmRwX2R1YWxfbW9kZS5tYXhfdG1kc19jbG9jayAmJgorCSAgICB0bWRz
X2Nsb2NrID4gaW50ZWxfZHAtPmRwX2R1YWxfbW9kZS5tYXhfdG1kc19jbG9jaykKKwkJcmV0dXJu
IE1PREVfQ0xPQ0tfSElHSDsKKwogCXJldHVybiBNT0RFX09LOwogfQogCkBAIC0xNzYyLDYgKzE3
NjYsOCBAQCBpbnRlbF9kcF9hdXhfaW5pdChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQogCQkJ
CSAgICAgICBhdXhfY2hfbmFtZShkaWdfcG9ydC0+YXV4X2NoKSwKIAkJCQkgICAgICAgcG9ydF9u
YW1lKGVuY29kZXItPnBvcnQpKTsKIAlpbnRlbF9kcC0+YXV4LnRyYW5zZmVyID0gaW50ZWxfZHBf
YXV4X3RyYW5zZmVyOworCisJaW50ZWxfZHAtPmRwX2R1YWxfbW9kZS5hZGFwdGVyID0gJmludGVs
X2RwLT5hdXguZGRjOwogfQogCiBib29sIGludGVsX2RwX3NvdXJjZV9zdXBwb3J0c19oYnIyKHN0
cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCkBAIC0xOTUwLDYgKzE5NTYsMTAgQEAgc3RhdGljIGJv
b2wgaW50ZWxfZHBfaGRtaV90bWRzX2Nsb2NrX3ZhbGlkKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxf
ZHAsCiAJICAgIHRtZHNfY2xvY2sgPiBpbnRlbF9kcC0+ZGZwLm1heF90bWRzX2Nsb2NrKQogCQly
ZXR1cm4gZmFsc2U7CiAKKwlpZiAoaW50ZWxfZHAtPmRwX2R1YWxfbW9kZS5tYXhfdG1kc19jbG9j
ayAmJgorCSAgICB0bWRzX2Nsb2NrID4gaW50ZWxfZHAtPmRwX2R1YWxfbW9kZS5tYXhfdG1kc19j
bG9jaykKKwkJcmV0dXJuIGZhbHNlOworCiAJcmV0dXJuIHRydWU7CiB9CiAKQEAgLTU4NTAsNiAr
NTg2MCwzNSBAQCBpbnRlbF9kcF9zZXRfZWRpZChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQog
CWludGVsX2RwX3VwZGF0ZV9kZnAoaW50ZWxfZHAsIGVkaWQpOwogCWludGVsX2RwX3VwZGF0ZV80
MjAoaW50ZWxfZHApOwogCisJaWYgKGRybV9kcF9kb3duc3RyZWFtX2lzX3RtZHMoaW50ZWxfZHAt
PmRwY2QsCisJCQkJICAgICAgaW50ZWxfZHAtPmRvd25zdHJlYW1fcG9ydHMsCisJCQkJICAgICAg
ZWRpZCkpIHsKKwkJLyoKKwkJICogTW9zdCBicmFuY2ggZGV2aWNlcyBkb24ndCBzZWVtIHRvIGZv
cndhcmQgdGhlCisJCSAqIERQIGR1YWwgbW9kZSBpMmMgYWNjZXNzZXMgdG8gdGhlIGRvbmdsZSwg
c28gZXZlbgorCQkgKiB3aGVuIHlvdSBoYXZlIGEgdHlwZTIgSERNSSBkb25nbGUgd2l0aCBhIGhp
Z2ggVE1EUworCQkgKiBjbG9jayBsaW1pdCB3ZSBtYXkgbm90IGJlIGFibGUgdG8gZGV0ZWN0IGl0
IDooCisJCSAqIFRvIGF2b2lkIHVzZXJzIGNvbXBsYWluaW5nIGFib3V0IGxvc2luZyBoaWdoCisJ
CSAqIHJlc29sdXRpb24gbW9kZXMgbGV0J3Mgbm90IGFzc3VtZSB0eXBlMSBEVkkKKwkJICogZG9u
Z2xlIHByZXNlbmNlIHdoZW4gdGhlIGFjY2VzcyBmYWlscy4gVGhlcmUKKwkJICogZG9lc24ndCBz
ZWVtIHRvIGJlIGFueSB3YXkgdG8gcmVhZCB0aGUgQ09ORklHMQorCQkgKiBwaW4gc3RhdGUgZnJv
bSB0aGUgYnJhbmNoIGRldmljZS4KKwkJICovCisJCWludGVsX2RwX2R1YWxfbW9kZV9kZXRlY3Qo
Y29ubmVjdG9yLCAmaW50ZWxfZHAtPmRwX2R1YWxfbW9kZSwgZmFsc2UpOworCisJCS8qCisJCSAq
IFdlIGRyaXZlIExTUENPTiBEUCBkdWFsIG1vZGUgYWRhcHRvcnMgaW4gUENPTiBtb2RlCisJCSAq
IHNvIHdlIHNob3VsZCBqdXN0IGlnbm9yZSB0aGUgSERNSSBzaWRlIG9mIGl0LgorCQkgKi8KKwkJ
aWYgKGludGVsX2RwLT5kcF9kdWFsX21vZGUudHlwZSA9PSBEUk1fRFBfRFVBTF9NT0RFX0xTUENP
TikgeworCQkJRFJNX0RFQlVHX0tNUygiW0NPTk5FQ1RPUjolZDolc10gSWdub3JpbmcgTFNQQ09O
IERQIGR1YWwgbW9kZSBhZGFwdG9yIHByZXNlbmNlXG4iLAorCQkJCSAgICAgIGNvbm5lY3Rvci0+
YmFzZS5iYXNlLmlkLAorCQkJCSAgICAgIGNvbm5lY3Rvci0+YmFzZS5uYW1lKTsKKworCQkJaW50
ZWxfZHBfZHVhbF9tb2RlX3Jlc2V0KCZpbnRlbF9kcC0+ZHBfZHVhbF9tb2RlKTsKKwkJfQorCX0K
KwogCWlmIChlZGlkICYmIGVkaWQtPmlucHV0ICYgRFJNX0VESURfSU5QVVRfRElHSVRBTCkgewog
CQlpbnRlbF9kcC0+aGFzX2hkbWlfc2luayA9IGRybV9kZXRlY3RfaGRtaV9tb25pdG9yKGVkaWQp
OwogCQlpbnRlbF9kcC0+aGFzX2F1ZGlvID0gZHJtX2RldGVjdF9tb25pdG9yX2F1ZGlvKGVkaWQp
OwpAQCAtNTg3Nyw2ICs1OTE2LDggQEAgaW50ZWxfZHBfdW5zZXRfZWRpZChzdHJ1Y3QgaW50ZWxf
ZHAgKmludGVsX2RwKQogCiAJaW50ZWxfZHAtPmRmcC55Y2Jjcl80NDRfdG9fNDIwID0gZmFsc2U7
CiAJY29ubmVjdG9yLT5iYXNlLnljYmNyXzQyMF9hbGxvd2VkID0gZmFsc2U7CisKKwlpbnRlbF9k
cF9kdWFsX21vZGVfcmVzZXQoJmludGVsX2RwLT5kcF9kdWFsX21vZGUpOwogfQogCiBzdGF0aWMg
aW50Ci0tIAoyLjI0LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9w
Lm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1k
ZXZlbAo=
