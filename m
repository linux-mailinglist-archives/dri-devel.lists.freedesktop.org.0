Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id CEBD161EDF
	for <lists+dri-devel@lfdr.de>; Mon,  8 Jul 2019 14:53:45 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 451BE89D3E;
	Mon,  8 Jul 2019 12:53:42 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mga01.intel.com (mga01.intel.com [192.55.52.88])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2804189D39;
 Mon,  8 Jul 2019 12:53:40 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga003.fm.intel.com ([10.253.24.29])
 by fmsmga101.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 08 Jul 2019 05:53:40 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,466,1557212400"; d="scan'208";a="173254583"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.174])
 by FMSMGA003.fm.intel.com with SMTP; 08 Jul 2019 05:53:38 -0700
Received: by stinkbox (sSMTP sendmail emulation);
 Mon, 08 Jul 2019 15:53:37 +0300
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Subject: [PATCH 04/19] drm/i915: Replace is_planar_yuv_format() with
 drm_format_info_is_yuv_semiplanar()
Date: Mon,  8 Jul 2019 15:53:10 +0300
Message-Id: <20190708125325.16576-5-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190708125325.16576-1-ville.syrjala@linux.intel.com>
References: <20190708125325.16576-1-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KClRo
ZXJlJ3MgYSBoZWxwZXIgaW4gZHJtX2ZvdXJjYy5oIHRoZXNlIGRheXMgdG8gY2hlY2sgb2Ygd2Un
cmUgZGVhbGluZwp3aXRoIGEgdHdvIHBsYW5lIFlVViBmb3JtYXQuIE1ha2UgdXNlIGlmIGl0LgoK
QWxzbyBzL3BsYW5lL2NvbG9yX3BsYW5lLyBpbiBza2xfcGxhbmVfcmVsYXRpdmVfZGF0YV9yYXRl
KCkgdG8gcmVkdWNlCnRoZSBjb25mdXNpb24uCgpTaWduZWQtb2ZmLWJ5OiBWaWxsZSBTeXJqw6Rs
w6QgPHZpbGxlLnN5cmphbGFAbGludXguaW50ZWwuY29tPgotLS0KIC4uLi9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9hdG9taWNfcGxhbmUuYyB8ICA1ICsrLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jICB8IDEwICsrKy0tLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmMgICB8IDIwICsrKy0tLS0tLS0tLS0tCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nwcml0ZS5oICAgfCAgMSAtCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9kcnYuaCAgICAgICAgICAgICAgfCAgMiArLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfcG0uYyAgICAgICAgICAgICAgIHwgMjcgKysrKysrKysrLS0tLS0t
LS0tLQogNiBmaWxlcyBjaGFuZ2VkLCAyNiBpbnNlcnRpb25zKCspLCAzOSBkZWxldGlvbnMoLSkK
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0b21pY19w
bGFuZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9taWNfcGxhbmUu
YwppbmRleCBhYjQxMWQ1ZTA5M2MuLjdmZjE5YjUyNGY5ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9taWNfcGxhbmUuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0b21pY19wbGFuZS5jCkBAIC0xNDMsNiArMTQzLDcg
QEAgaW50IGludGVsX3BsYW5lX2F0b21pY19jaGVja193aXRoX3N0YXRlKGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y18KIAkJCQkJc3RydWN0IGludGVsX3BsYW5lX3N0YXRl
ICpuZXdfcGxhbmVfc3RhdGUpCiB7CiAJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSA9IHRvX2lu
dGVsX3BsYW5lKG5ld19wbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZSk7CisJY29uc3Qgc3RydWN0IGRy
bV9mcmFtZWJ1ZmZlciAqZmIgPSBuZXdfcGxhbmVfc3RhdGUtPmJhc2UuZmI7CiAJaW50IHJldDsK
IAogCW5ld19jcnRjX3N0YXRlLT5hY3RpdmVfcGxhbmVzICY9IH5CSVQocGxhbmUtPmlkKTsKQEAg
LTE2MywxMSArMTY0LDExIEBAIGludCBpbnRlbF9wbGFuZV9hdG9taWNfY2hlY2tfd2l0aF9zdGF0
ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfCiAJCW5ld19jcnRjX3N0
YXRlLT5hY3RpdmVfcGxhbmVzIHw9IEJJVChwbGFuZS0+aWQpOwogCiAJaWYgKG5ld19wbGFuZV9z
dGF0ZS0+YmFzZS52aXNpYmxlICYmCi0JICAgIGlzX3BsYW5hcl95dXZfZm9ybWF0KG5ld19wbGFu
ZV9zdGF0ZS0+YmFzZS5mYi0+Zm9ybWF0LT5mb3JtYXQpKQorCSAgICBkcm1fZm9ybWF0X2luZm9f
aXNfeXV2X3NlbWlwbGFuYXIoZmItPmZvcm1hdCkpCiAJCW5ld19jcnRjX3N0YXRlLT5udjEyX3Bs
YW5lcyB8PSBCSVQocGxhbmUtPmlkKTsKIAogCWlmIChuZXdfcGxhbmVfc3RhdGUtPmJhc2Uudmlz
aWJsZSAmJgotCSAgICBuZXdfcGxhbmVfc3RhdGUtPmJhc2UuZmItPmZvcm1hdC0+Zm9ybWF0ID09
IERSTV9GT1JNQVRfQzgpCisJICAgIGZiLT5mb3JtYXQtPmZvcm1hdCA9PSBEUk1fRk9STUFUX0M4
KQogCQluZXdfY3J0Y19zdGF0ZS0+YzhfcGxhbmVzIHw9IEJJVChwbGFuZS0+aWQpOwogCiAJaWYg
KG5ld19wbGFuZV9zdGF0ZS0+YmFzZS52aXNpYmxlIHx8IG9sZF9wbGFuZV9zdGF0ZS0+YmFzZS52
aXNpYmxlKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9k
aXNwbGF5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwpp
bmRleCBmMDllZGE3NTcxMWEuLmVlOTM1NzdiZGY5NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKQEAgLTM1NDAsNyArMzU0MCw3IEBAIGludCBza2xf
Y2hlY2tfcGxhbmVfc3VyZmFjZShzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRl
KQogCSAqIEhhbmRsZSB0aGUgQVVYIHN1cmZhY2UgZmlyc3Qgc2luY2UKIAkgKiB0aGUgbWFpbiBz
dXJmYWNlIHNldHVwIGRlcGVuZHMgb24gaXQuCiAJICovCi0JaWYgKGlzX3BsYW5hcl95dXZfZm9y
bWF0KGZiLT5mb3JtYXQtPmZvcm1hdCkpIHsKKwlpZiAoZHJtX2Zvcm1hdF9pbmZvX2lzX3l1dl9z
ZW1pcGxhbmFyKGZiLT5mb3JtYXQpKSB7CiAJCXJldCA9IHNrbF9jaGVja19udjEyX2F1eF9zdXJm
YWNlKHBsYW5lX3N0YXRlKTsKIAkJaWYgKHJldCkKIAkJCXJldHVybiByZXQ7CkBAIC01NDU3LDcg
KzU0NTcsNyBAQCBza2xfdXBkYXRlX3NjYWxlcihzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSwgYm9vbCBmb3JjZV9kZXRhY2gsCiAJCXJldHVybiAwOwogCX0KIAotCWlmIChmb3Jt
YXQgJiYgaXNfcGxhbmFyX3l1dl9mb3JtYXQoZm9ybWF0LT5mb3JtYXQpICYmCisJaWYgKGZvcm1h
dCAmJiBkcm1fZm9ybWF0X2luZm9faXNfeXV2X3NlbWlwbGFuYXIoZm9ybWF0KSAmJgogCSAgICAo
c3JjX2ggPCBTS0xfTUlOX1lVVl80MjBfU1JDX0ggfHwgc3JjX3cgPCBTS0xfTUlOX1lVVl80MjBf
U1JDX1cpKSB7CiAJCURSTV9ERUJVR19LTVMoIlBsYW5hciBZVVY6IHNyYyBkaW1lbnNpb25zIG5v
dCBtZXRcbiIpOwogCQlyZXR1cm4gLUVJTlZBTDsKQEAgLTU1MzQsNyArNTUzNCw3IEBAIHN0YXRp
YyBpbnQgc2tsX3VwZGF0ZV9zY2FsZXJfcGxhbmUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUsCiAKIAkvKiBQcmUtZ2VuMTEgYW5kIFNEUiBwbGFuZXMgYWx3YXlzIG5lZWQgYSBz
Y2FsZXIgZm9yIHBsYW5hciBmb3JtYXRzLiAqLwogCWlmICghaWNsX2lzX2hkcl9wbGFuZShkZXZf
cHJpdiwgaW50ZWxfcGxhbmUtPmlkKSAmJgotCSAgICBmYiAmJiBpc19wbGFuYXJfeXV2X2Zvcm1h
dChmYi0+Zm9ybWF0LT5mb3JtYXQpKQorCSAgICBmYiAmJiBkcm1fZm9ybWF0X2luZm9faXNfeXV2
X3NlbWlwbGFuYXIoZmItPmZvcm1hdCkpCiAJCW5lZWRfc2NhbGVyID0gdHJ1ZTsKIAogCXJldCA9
IHNrbF91cGRhdGVfc2NhbGVyKGNydGNfc3RhdGUsIGZvcmNlX2RldGFjaCwKQEAgLTE0NDY4LDcg
KzE0NDY4LDcgQEAgaW50ZWxfY2xlYW51cF9wbGFuZV9mYihzdHJ1Y3QgZHJtX3BsYW5lICpwbGFu
ZSwKIAogaW50CiBza2xfbWF4X3NjYWxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAotCSAgICAgIHUzMiBwaXhlbF9mb3JtYXQpCisJICAgICAgY29uc3Qgc3RydWN0
IGRybV9mb3JtYXRfaW5mbyAqZm9ybWF0KQogewogCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0g
dG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwogCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwpAQCAtMTQ0OTMsNyAr
MTQ0OTMsNyBAQCBza2xfbWF4X3NjYWxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAogCSAqICAgICAgICAgICAgb3IKIAkgKiAgICBjZGNsay9jcnRjX2Nsb2NrCiAJ
ICovCi0JbXVsdCA9IGlzX3BsYW5hcl95dXZfZm9ybWF0KHBpeGVsX2Zvcm1hdCkgPyAyIDogMzsK
KwltdWx0ID0gZHJtX2Zvcm1hdF9pbmZvX2lzX3l1dl9zZW1pcGxhbmFyKGZvcm1hdCkgPyAyIDog
MzsKIAl0bXBjbGsxID0gKDEgPDwgMTYpICogbXVsdCAtIDE7CiAJdG1wY2xrMiA9ICgxIDw8IDgp
ICogKChtYXhfZG90Y2xrIDw8IDgpIC8gY3J0Y19jbG9jayk7CiAJbWF4X3NjYWxlID0gbWluKHRt
cGNsazEsIHRtcGNsazIpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9zcHJpdGUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3By
aXRlLmMKaW5kZXggMzQ1ODZmMjliZTYwLi5lODlmM2Y3ZmFlMDUgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUuYwpAQCAtNDcsMTkgKzQ3LDYgQEAKICNpbmNs
dWRlICJpbnRlbF9wc3IuaCIKICNpbmNsdWRlICJpbnRlbF9zcHJpdGUuaCIKIAotYm9vbCBpc19w
bGFuYXJfeXV2X2Zvcm1hdCh1MzIgcGl4ZWxmb3JtYXQpCi17Ci0Jc3dpdGNoIChwaXhlbGZvcm1h
dCkgewotCWNhc2UgRFJNX0ZPUk1BVF9OVjEyOgotCWNhc2UgRFJNX0ZPUk1BVF9QMDEwOgotCWNh
c2UgRFJNX0ZPUk1BVF9QMDEyOgotCWNhc2UgRFJNX0ZPUk1BVF9QMDE2OgotCQlyZXR1cm4gdHJ1
ZTsKLQlkZWZhdWx0OgotCQlyZXR1cm4gZmFsc2U7Ci0JfQotfQotCiBpbnQgaW50ZWxfdXNlY3Nf
dG9fc2NhbmxpbmVzKGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2Rl
LAogCQkJICAgICBpbnQgdXNlY3MpCiB7CkBAIC0zNTQsNiArMzQxLDcgQEAgc2tsX3Byb2dyYW1f
c2NhbGVyKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCiAJCSAgIGNvbnN0IHN0cnVjdCBpbnRl
bF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOworCWNvbnN0IHN0cnVjdCBkcm1f
ZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmJhc2UuZmI7CiAJZW51bSBwaXBlIHBpcGUg
PSBwbGFuZS0+cGlwZTsKIAlpbnQgc2NhbGVyX2lkID0gcGxhbmVfc3RhdGUtPnNjYWxlcl9pZDsK
IAljb25zdCBzdHJ1Y3QgaW50ZWxfc2NhbGVyICpzY2FsZXIgPQpAQCAtMzc0LDcgKzM2Miw3IEBA
IHNrbF9wcm9ncmFtX3NjYWxlcihzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAogCQkJCSAgICAg
IDAsIElOVF9NQVgpOwogCiAJLyogVE9ETzogaGFuZGxlIHN1Yi1waXhlbCBjb29yZGluYXRlcyAq
LwotCWlmIChpc19wbGFuYXJfeXV2X2Zvcm1hdChwbGFuZV9zdGF0ZS0+YmFzZS5mYi0+Zm9ybWF0
LT5mb3JtYXQpICYmCisJaWYgKGRybV9mb3JtYXRfaW5mb19pc195dXZfc2VtaXBsYW5hcihmYi0+
Zm9ybWF0KSAmJgogCSAgICAhaWNsX2lzX2hkcl9wbGFuZShkZXZfcHJpdiwgcGxhbmUtPmlkKSkg
ewogCQl5X2hwaGFzZSA9IHNrbF9zY2FsZXJfY2FsY19waGFzZSgxLCBoc2NhbGUsIGZhbHNlKTsK
IAkJeV92cGhhc2UgPSBza2xfc2NhbGVyX2NhbGNfcGhhc2UoMSwgdnNjYWxlLCBmYWxzZSk7CkBA
IC0xNzU3LDcgKzE3NDUsNyBAQCBzdGF0aWMgaW50IHNrbF9wbGFuZV9jaGVja19udjEyX3JvdGF0
aW9uKGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfcwogCWludCBzcmNfdyA9
IGRybV9yZWN0X3dpZHRoKCZwbGFuZV9zdGF0ZS0+YmFzZS5zcmMpID4+IDE2OwogCiAJLyogRGlz
cGxheSBXQSAjMTEwNiAqLwotCWlmIChpc19wbGFuYXJfeXV2X2Zvcm1hdChmYi0+Zm9ybWF0LT5m
b3JtYXQpICYmIHNyY193ICYgMyAmJgorCWlmIChkcm1fZm9ybWF0X2luZm9faXNfeXV2X3NlbWlw
bGFuYXIoZmItPmZvcm1hdCkgJiYgc3JjX3cgJiAzICYmCiAJICAgIChyb3RhdGlvbiA9PSBEUk1f
TU9ERV9ST1RBVEVfMjcwIHx8CiAJICAgICByb3RhdGlvbiA9PSAoRFJNX01PREVfUkVGTEVDVF9Y
IHwgRFJNX01PREVfUk9UQVRFXzkwKSkpIHsKIAkJRFJNX0RFQlVHX0tNUygic3JjIHdpZHRoIG11
c3QgYmUgbXVsdGlwbGUgb2YgNCBmb3Igcm90YXRlZCBwbGFuYXIgWVVWXG4iKTsKQEAgLTE3ODQs
NyArMTc3Miw3IEBAIHN0YXRpYyBpbnQgc2tsX3BsYW5lX2NoZWNrKHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlLAogCS8qIHVzZSBzY2FsZXIgd2hlbiBjb2xvcmtleSBpcyBub3Qg
cmVxdWlyZWQgKi8KIAlpZiAoIXBsYW5lX3N0YXRlLT5ja2V5LmZsYWdzICYmIGludGVsX2ZiX3Nj
YWxhYmxlKGZiKSkgewogCQltaW5fc2NhbGUgPSAxOwotCQltYXhfc2NhbGUgPSBza2xfbWF4X3Nj
YWxlKGNydGNfc3RhdGUsIGZiLT5mb3JtYXQtPmZvcm1hdCk7CisJCW1heF9zY2FsZSA9IHNrbF9t
YXhfc2NhbGUoY3J0Y19zdGF0ZSwgZmItPmZvcm1hdCk7CiAJfQogCiAJcmV0ID0gZHJtX2F0b21p
Y19oZWxwZXJfY2hlY2tfcGxhbmVfc3RhdGUoJnBsYW5lX3N0YXRlLT5iYXNlLApkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUuaCBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmgKaW5kZXggNTAwZjZiZmZiMTM5Li43
ZGFiYzMxNzEwYWUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfc3ByaXRlLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zcHJp
dGUuaApAQCAtMTgsNyArMTgsNiBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKIHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlOwogc3RydWN0IGludGVsX3BsYW5lX3N0YXRlOwogCi1ib29sIGlzX3Bs
YW5hcl95dXZfZm9ybWF0KHUzMiBwaXhlbGZvcm1hdCk7CiBpbnQgaW50ZWxfdXNlY3NfdG9fc2Nh
bmxpbmVzKGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlLAogCQkJ
ICAgICBpbnQgdXNlY3MpOwogc3RydWN0IGludGVsX3BsYW5lICppbnRlbF9zcHJpdGVfcGxhbmVf
Y3JlYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfZHJ2LmgKaW5kZXggMjRjNjNlZDQ1YzZmLi4wNGVlZTVkODgwZjUgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2Rydi5oCkBAIC0xNjA5LDcgKzE2MDksNyBAQCB2b2lkIGludGVsX2NydGNfYXJtX2Zp
Zm9fdW5kZXJydW4oc3RydWN0IGludGVsX2NydGMgKmNydGMsCiB1MTYgc2tsX3NjYWxlcl9jYWxj
X3BoYXNlKGludCBzdWIsIGludCBzY2FsZSwgYm9vbCBjaHJvbWFfY2VudGVyKTsKIGludCBza2xf
dXBkYXRlX3NjYWxlcl9jcnRjKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKTsK
IGludCBza2xfbWF4X3NjYWxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlLAotCQkgIHUzMiBwaXhlbF9mb3JtYXQpOworCQkgIGNvbnN0IHN0cnVjdCBkcm1fZm9ybWF0
X2luZm8gKmZvcm1hdCk7CiAKIHN0YXRpYyBpbmxpbmUgdTMyIGludGVsX3BsYW5lX2dndHRfb2Zm
c2V0KGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqc3RhdGUpCiB7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfcG0uYwppbmRleCA4NzI0NGQ4MjE1YTcuLmYyNWE2MDVhYWNmOSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9wbS5jCkBAIC00MDA0LDcgKzQwMDQsOCBAQCBza2xfZGRiX2dldF9od19wbGFuZV9z
dGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJCXZhbCA9IEk5MTVfUkVB
RChQTEFORV9CVUZfQ0ZHKHBpcGUsIHBsYW5lX2lkKSk7CiAJCXZhbDIgPSBJOTE1X1JFQUQoUExB
TkVfTlYxMl9CVUZfQ0ZHKHBpcGUsIHBsYW5lX2lkKSk7CiAKLQkJaWYgKGlzX3BsYW5hcl95dXZf
Zm9ybWF0KGZvdXJjYykpCisJCWlmIChmb3VyY2MgJiYKKwkJICAgIGRybV9mb3JtYXRfaW5mb19p
c195dXZfc2VtaXBsYW5hcihkcm1fZm9ybWF0X2luZm8oZm91cmNjKSkpCiAJCQlzd2FwKHZhbCwg
dmFsMik7CiAKIAkJc2tsX2RkYl9lbnRyeV9pbml0X2Zyb21faHcoZGV2X3ByaXYsIGRkYl95LCB2
YWwpOwpAQCAtNDE5MiwyNSArNDE5MywyMyBAQCBpbnQgc2tsX2NoZWNrX3BpcGVfbWF4X3BpeGVs
X3JhdGUoc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMsCiBzdGF0aWMgdTY0CiBza2xfcGxh
bmVfcmVsYXRpdmVfZGF0YV9yYXRlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlLAogCQkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0
YXRlLAotCQkJICAgICBjb25zdCBpbnQgcGxhbmUpCisJCQkgICAgIGludCBjb2xvcl9wbGFuZSkK
IHsKLQlzdHJ1Y3QgaW50ZWxfcGxhbmUgKmludGVsX3BsYW5lID0gdG9faW50ZWxfcGxhbmUocGxh
bmVfc3RhdGUtPmJhc2UucGxhbmUpOworCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUgPSB0b19p
bnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZSk7CisJY29uc3Qgc3RydWN0IGRybV9m
cmFtZWJ1ZmZlciAqZmIgPSBwbGFuZV9zdGF0ZS0+YmFzZS5mYjsKIAl1MzIgZGF0YV9yYXRlOwog
CXUzMiB3aWR0aCA9IDAsIGhlaWdodCA9IDA7Ci0Jc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmI7
Ci0JdTMyIGZvcm1hdDsKIAl1aW50X2ZpeGVkXzE2XzE2X3QgZG93bl9zY2FsZV9hbW91bnQ7CiAJ
dTY0IHJhdGU7CiAKIAlpZiAoIXBsYW5lX3N0YXRlLT5iYXNlLnZpc2libGUpCiAJCXJldHVybiAw
OwogCi0JZmIgPSBwbGFuZV9zdGF0ZS0+YmFzZS5mYjsKLQlmb3JtYXQgPSBmYi0+Zm9ybWF0LT5m
b3JtYXQ7Ci0KLQlpZiAoaW50ZWxfcGxhbmUtPmlkID09IFBMQU5FX0NVUlNPUikKKwlpZiAocGxh
bmUtPmlkID09IFBMQU5FX0NVUlNPUikKIAkJcmV0dXJuIDA7Ci0JaWYgKHBsYW5lID09IDEgJiYg
IWlzX3BsYW5hcl95dXZfZm9ybWF0KGZvcm1hdCkpCisKKwlpZiAoY29sb3JfcGxhbmUgPT0gMSAm
JgorCSAgICAhZHJtX2Zvcm1hdF9pbmZvX2lzX3l1dl9zZW1pcGxhbmFyKGZiLT5mb3JtYXQpKQog
CQlyZXR1cm4gMDsKIAogCS8qCkBAIC00MjIyLDcgKzQyMjEsNyBAQCBza2xfcGxhbmVfcmVsYXRp
dmVfZGF0YV9yYXRlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAog
CWhlaWdodCA9IGRybV9yZWN0X2hlaWdodCgmcGxhbmVfc3RhdGUtPmJhc2Uuc3JjKSA+PiAxNjsK
IAogCS8qIFVWIHBsYW5lIGRvZXMgMS8yIHBpeGVsIHN1Yi1zYW1wbGluZyAqLwotCWlmIChwbGFu
ZSA9PSAxICYmIGlzX3BsYW5hcl95dXZfZm9ybWF0KGZvcm1hdCkpIHsKKwlpZiAoY29sb3JfcGxh
bmUgPT0gMSkgewogCQl3aWR0aCAvPSAyOwogCQloZWlnaHQgLz0gMjsKIAl9CkBAIC00MjMzLDcg
KzQyMzIsNyBAQCBza2xfcGxhbmVfcmVsYXRpdmVfZGF0YV9yYXRlKGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCiAJcmF0ZSA9IG11bF9yb3VuZF91cF91MzJfZml4
ZWQxNihkYXRhX3JhdGUsIGRvd25fc2NhbGVfYW1vdW50KTsKIAotCXJhdGUgKj0gZmItPmZvcm1h
dC0+Y3BwW3BsYW5lXTsKKwlyYXRlICo9IGZiLT5mb3JtYXQtPmNwcFtjb2xvcl9wbGFuZV07CiAJ
cmV0dXJuIHJhdGU7CiB9CiAKQEAgLTQ2MzgsNyArNDYzNyw3IEBAIHNrbF9jb21wdXRlX3dtX3Bh
cmFtcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAl1MzIgaW50
ZXJtX3BicGw7CiAKIAkvKiBvbmx5IHBsYW5hciBmb3JtYXQgaGFzIHR3byBwbGFuZXMgKi8KLQlp
ZiAoY29sb3JfcGxhbmUgPT0gMSAmJiAhaXNfcGxhbmFyX3l1dl9mb3JtYXQoZm9ybWF0LT5mb3Jt
YXQpKSB7CisJaWYgKGNvbG9yX3BsYW5lID09IDEgJiYgIWRybV9mb3JtYXRfaW5mb19pc195dXZf
c2VtaXBsYW5hcihmb3JtYXQpKSB7CiAJCURSTV9ERUJVR19LTVMoIk5vbiBwbGFuYXIgZm9ybWF0
IGhhdmUgc2luZ2xlIHBsYW5lXG4iKTsKIAkJcmV0dXJuIC1FSU5WQUw7CiAJfQpAQCAtNDY1MCw3
ICs0NjQ5LDcgQEAgc2tsX2NvbXB1dGVfd21fcGFyYW1zKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlLAogCXdwLT54X3RpbGVkID0gbW9kaWZpZXIgPT0gSTkxNV9GT1JN
QVRfTU9EX1hfVElMRUQ7CiAJd3AtPnJjX3N1cmZhY2UgPSBtb2RpZmllciA9PSBJOTE1X0ZPUk1B
VF9NT0RfWV9USUxFRF9DQ1MgfHwKIAkJCSBtb2RpZmllciA9PSBJOTE1X0ZPUk1BVF9NT0RfWWZf
VElMRURfQ0NTOwotCXdwLT5pc19wbGFuYXIgPSBpc19wbGFuYXJfeXV2X2Zvcm1hdChmb3JtYXQt
PmZvcm1hdCk7CisJd3AtPmlzX3BsYW5hciA9IGRybV9mb3JtYXRfaW5mb19pc195dXZfc2VtaXBs
YW5hcihmb3JtYXQpOwogCiAJd3AtPndpZHRoID0gd2lkdGg7CiAJaWYgKGNvbG9yX3BsYW5lID09
IDEgJiYgd3AtPmlzX3BsYW5hcikKLS0gCjIuMjEuMAoKX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxA
bGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxt
YW4vbGlzdGluZm8vZHJpLWRldmVs
