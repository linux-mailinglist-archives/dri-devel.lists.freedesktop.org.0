Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 4165237F49
	for <lists+dri-devel@lfdr.de>; Thu,  6 Jun 2019 23:13:18 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D64C98928B;
	Thu,  6 Jun 2019 21:13:14 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-oi1-x242.google.com (mail-oi1-x242.google.com
 [IPv6:2607:f8b0:4864:20::242])
 by gabe.freedesktop.org (Postfix) with ESMTPS id AA2288928B
 for <dri-devel@lists.freedesktop.org>; Thu,  6 Jun 2019 21:13:12 +0000 (UTC)
Received: by mail-oi1-x242.google.com with SMTP id b21so2626157oic.8
 for <dri-devel@lists.freedesktop.org>; Thu, 06 Jun 2019 14:13:12 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc:content-transfer-encoding;
 bh=kU9iIv07sGy0o/4e2jGfDlmeT1B9w4zMv8nvDWUESzg=;
 b=PXfekZNxXH314i0hfrov9SbAqts7h0GHaAL+VEJjwOnBvZaSourGqPyN3UucD/1ucG
 sHNQDfuuuJ3ldHbbatKeo2tElSTIPYtPmdVjOHSFVuhv3Hbkmz17F00M5F348cLESjAw
 CYi9SpWUsDw6Q+kBJm+WsfpjkilhNVvqEFmRXY+IiQJRC9APlACEIcyV1J6TwV9JUaq3
 8R+9+38Nhfm6oNGckPdUYIsZUSz16eT+q91+c9fpA/Jl+pfhns5cypn71Ni/XDC+VKkY
 I5as0hZCniwi5qtWp9wKaEAUwCHkd6QFDu9jdTGFKo9ONd5TRUn1cYSOB9x6pXP0uLyS
 Chgw==
X-Gm-Message-State: APjAAAX2vpSNasios6LrqFepMurkZUkjLU40EZlTJyYI0fCPkx56SRlx
 lNnsbXEkla11e2w9zmtZFwmgvxnREnGhrGlWcCFFdg==
X-Google-Smtp-Source: APXvYqzxPvw2b9RqKE5yxlwG9oY4AIv+B0E1vzji/fFsUL0XXbPZ3xqw9rf+SA8QpZ82yjEBjtwpaRLhpvd7ILUPVJY=
X-Received: by 2002:aca:6208:: with SMTP id w8mr1565169oib.128.1559855591701; 
 Thu, 06 Jun 2019 14:13:11 -0700 (PDT)
MIME-Version: 1.0
References: <20190606202032.29748-1-james.hilliard1@gmail.com>
In-Reply-To: <20190606202032.29748-1-james.hilliard1@gmail.com>
From: Daniel Vetter <daniel@ffwll.ch>
Date: Thu, 6 Jun 2019 23:13:00 +0200
Message-ID: <CAKMK7uF1bdgMW0XgPSonaoym51AaJJmRUHabZzJwKN-0Dce_Xg@mail.gmail.com>
Subject: Re: [RFC PATCH 1/1] drm/gma500: add atomic support
To: James Hilliard <james.hilliard1@gmail.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ffwll.ch; s=google;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc:content-transfer-encoding;
 bh=kU9iIv07sGy0o/4e2jGfDlmeT1B9w4zMv8nvDWUESzg=;
 b=OeubLztbPGugkBDjsxBj5Lg69LChIELV7yaxld1McEW5LJZH8vli/a4aKzpWBWQDaw
 ytKGjf8GKf7fZYAK94Gdi3feNr97EbH2xil0rX6MRDo9sNWaXDI91OBj/TbiQSG3NpE3
 437rveIBTGgqRl7wfIQFb0AcVxw8xop27TqxY=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: dri-devel <dri-devel@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gVGh1LCBKdW4gNiwgMjAxOSBhdCAxMDoyMCBQTSBKYW1lcyBIaWxsaWFyZAo8amFtZXMuaGls
bGlhcmQxQGdtYWlsLmNvbT4gd3JvdGU6Cj4KPiBJbXBvcnRlZCBmcm9tIGh0dHBzOi8vZ2l0LnRp
emVuLm9yZy9jZ2l0L2tlcm5lbC9rZXJuZWwtbWZsZC1ibGFja2JheS8KPgo+IFRoaXMgaXMgY3Vy
cmVudGx5IG5vdCBmdW5jdGlvbmFsIGFuZCBiYXNlZCBvZmYgb2YgYW4gb2xkZXIgdmVyc2lvbiBv
Zgo+IHRoZSBnbWE1MDAgZHJpdmVyLiBGcm9tIHRoZSBjb21taXQgbG9nIHRoaXMgd2FzIHdyaXR0
ZW4gYnkgSW50ZWwsIGlzCj4gYW55b25lIGF3YXJlIG9mIGEgbW9yZSB1cCB0byBkYXRlIHZlcnNp
b24/Cj4KPiBJJ20gbG9va2luZyB0byBzZWUgaWYgdGhpcyB3b3VsZCBiZSBhIGRlY2VudCBzdGFy
dGluZyBwb2ludCBmb3IgYWRkaW5nCj4gZ21hNTAwIGF0b21pYyBzdXBwb3J0IHRvIG1haW5saW5l
IGFuZCBob3cgYmVzdCB0byBhcHByb2FjaCB0aGF0Lgo+Cj4gU2lnbmVkLW9mZi1ieTogSmFtZXMg
SGlsbGlhcmQgPGphbWVzLmhpbGxpYXJkMUBnbWFpbC5jb20+CgpUaGlzIHVzZXMgc29tZSBkcm1f
ZmxpcF9kcml2ZXIgaW5mcmFzdHJ1Y3R1cmUsIHdoaWNoIG1pZ2h0IGhhdmUKZmxvYXRlZCBhcm91
bmQgaW4gc29tZSBhdG9taWMgcGF0Y2hlcyBvbmNlLCBidXQgZGVmaW5pdGVseSBuZXZlciBtYWRl
Cml0IHRvIHVwc3RyZWFtLiBObyBpZGVhIHdoZXRoZXIgdGhhdCB3aWxsIGhlbHAgeW91IG9yIG5v
dCwgc2luY2UgdGhlCnVwc3RyZWFtIGluZnJhc3RydWN0dXJlIGZvciBhbGwgdGhpcyBsb29rcyBx
dWl0ZSBhIGJpdCBkaWZmZXJlbnQuCi1EYW5pZWwKCj4gLS0tCj4gIGRyaXZlcnMvZ3B1L2RybS9n
bWE1MDAvTWFrZWZpbGUgICAgICAgIHwgICAxICsKPiAgZHJpdmVycy9ncHUvZHJtL2dtYTUwMC9w
c2JfcGFnZV9mbGlwLmMgfCA2MDAgKysrKysrKysrKysrKysrKysrKysrKysrKwo+ICBkcml2ZXJz
L2dwdS9kcm0vZ21hNTAwL3BzYl9wYWdlX2ZsaXAuaCB8ICAzOCArKwo+ICAzIGZpbGVzIGNoYW5n
ZWQsIDYzOSBpbnNlcnRpb25zKCspCj4gIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9k
cm0vZ21hNTAwL3BzYl9wYWdlX2ZsaXAuYwo+ICBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9n
cHUvZHJtL2dtYTUwMC9wc2JfcGFnZV9mbGlwLmgKPgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vZ21hNTAwL01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL2dtYTUwMC9NYWtlZmlsZQo+
IGluZGV4IGM4ZjJjODliZTk5ZC4uM2RiNTM1ZWY1MWNiIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9nbWE1MDAvTWFrZWZpbGUKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vZ21hNTAwL01h
a2VmaWxlCj4gQEAgLTI0LDYgKzI0LDcgQEAgZ21hNTAwX2dmeC15ICs9IFwKPiAgICAgICAgICAg
cHNiX2ludGVsX3Nkdm8ubyBcCj4gICAgICAgICAgIHBzYl9saWQubyBcCj4gICAgICAgICAgIHBz
Yl9pcnEubyBcCj4gKyAgICAgICAgIHBzYl9wYWdlX2ZsaXAubyBcCj4gICAgICAgICAgIHBzYl9k
ZXZpY2UubyBcCj4gICAgICAgICAgIG1pZF9iaW9zLm8KPgo+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vZ21hNTAwL3BzYl9wYWdlX2ZsaXAuYyBiL2RyaXZlcnMvZ3B1L2RybS9nbWE1MDAv
cHNiX3BhZ2VfZmxpcC5jCj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRleCAwMDAwMDAwMDAw
MDAuLjZhOTM3MjdjZjFjMQo+IC0tLSAvZGV2L251bGwKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0v
Z21hNTAwL3BzYl9wYWdlX2ZsaXAuYwo+IEBAIC0wLDAgKzEsNjAwIEBACj4gKy8qCj4gKyAqIENv
cHlyaWdodCAoYykgMjAxMS0yMDEyLCBJbnRlbCBDb3Jwb3JhdGlvbi4KPiArICoKPiArICogVGhp
cyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9v
ciBtb2RpZnkgaXQKPiArICogdW5kZXIgdGhlIHRlcm1zIGFuZCBjb25kaXRpb25zIG9mIHRoZSBH
TlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSwKPiArICogdmVyc2lvbiAyLCBhcyBwdWJsaXNoZWQg
YnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbi4KPiArICoKPiArICogVGhpcyBwcm9ncmFt
IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIGl0IHdpbGwgYmUgdXNlZnVsLCBidXQgV0lUSE9V
VAo+ICsgKiBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBv
ZiBNRVJDSEFOVEFCSUxJVFkgb3IKPiArICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBP
U0UuICBTZWUgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvcgo+ICsgKiBtb3JlIGRl
dGFpbHMuCj4gKyAqCj4gKyAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhl
IEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFsb25nIHdpdGgKPiArICogdGhpcyBwcm9ncmFt
OyBpZiBub3QsIHdyaXRlIHRvIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIEluYy4swrcK
PiArICogNTEgRnJhbmtsaW4gU3QgLSBGaWZ0aCBGbG9vciwgQm9zdG9uLCBNQSAwMjExMC0xMzAx
IFVTQS4KPiArICoKPiArICogQXV0aG9yczoKPiArICogQW5kZXIgQ29uc2VsdmFuIGRlIE9saXZl
aXJhIDxhbmRlci5jb25zZWx2YW4uZGUub2xpdmVpcmFAaW50ZWwuY29tPgo+ICsgKiBQYXVsaSBO
aWVtaW5lbiA8cGF1bGkubmllbWluZW5AaW50ZWwuY29tPgo+ICsgKiBWaWxsZSBTeXJqw6Rsw6Qg
PHZpbGxlLnN5cmphbGFAbGludXguaW50ZWwuY29tPgo+ICsgKi8KPiArCj4gKyNpbmNsdWRlIDxs
aW51eC9zcGlubG9jay5oPgo+ICsjaW5jbHVkZSA8bGludXgvbGlzdC5oPgo+ICsKPiArI2luY2x1
ZGUgPGRybS9kcm1QLmg+Cj4gKyNpbmNsdWRlICJwc2JfZHJ2LmgiCj4gKyNpbmNsdWRlICJmcmFt
ZWJ1ZmZlci5oIgo+ICsjaW5jbHVkZSAicHNiX2ludGVsX3JlZy5oIgo+ICsjaW5jbHVkZSAicHNi
X3BhZ2VfZmxpcC5oIgo+ICsKPiArI2luY2x1ZGUgIm1kZmxkX291dHB1dC5oIgo+ICsjaW5jbHVk
ZSAibWRmbGRfZHNpX291dHB1dC5oIgo+ICsKPiArI2lmIGRlZmluZWQoQ09ORklHX01ERkxEX0RV
QUxfRFNJX0RQVSkKPiArI2luY2x1ZGUgIm1kZmxkX2RzaV9kYmlfZHB1LmgiCj4gKyNlbGlmIGRl
ZmluZWQoQ09ORklHX01ERkxEX0RTSV9EU1IpCj4gKyNpbmNsdWRlICJtZGZsZF9kc2lfZGJpLmgi
Cj4gKyNlbmRpZgo+ICsKPiArc3RydWN0IHBlbmRpbmdfZmxpcCB7Cj4gKyAgICAgICBzdHJ1Y3Qg
ZHJtX2NydGMgKmNydGM7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX3BlbmRpbmdfdmJsYW5rX2V2ZW50
ICpldmVudDsKPiArICAgICAgIFBWUlNSVl9LRVJORUxfTUVNX0lORk8gKm1lbV9pbmZvOwo+ICsg
ICAgICAgUFZSU1JWX0tFUk5FTF9NRU1fSU5GTyAqb2xkX21lbV9pbmZvOwo+ICsgICAgICAgdWlu
dDMyX3Qgb2Zmc2V0Owo+ICsgICAgICAgc3RydWN0IGxpc3RfaGVhZCB1bmNvbXBsZXRlZDsKPiAr
ICAgICAgIHN0cnVjdCBwdnJfcGVuZGluZ19zeW5jIHBlbmRpbmdfc3luYzsKPiArICAgICAgIHN0
cnVjdCBkcm1fZmxpcCBiYXNlOwo+ICsgICAgICAgdTMyIHZibF9jb3VudDsKPiArICAgICAgIHN0
cnVjdCBsaXN0X2hlYWQgY29tcGFuaW9uczsKPiArICAgICAgIHUzMiB0Z2lkOwo+ICsgICAgICAg
Ym9vbCB2YmxhbmtfcmVmOwo+ICsgICAgICAgYXRvbWljX3QgcmVmY250Owo+ICsgICAgICAgc3Ry
dWN0IHBzYl9wZW5kaW5nX3ZhbHVlcyBwZW5kaW5nX3ZhbHVlczsKPiArfTsKPiArCj4gK2VudW0g
ewo+ICsgICAgICAgLyogc29td2VoYXQgYXJiaXRyYXJ5IHZhbHVlICovCj4gKyAgICAgICBQU0Jf
VkJMX0NOVF9USU1FT1VUID0gNSwKPiArfTsKPiArCj4gK3N0YXRpYyB1MzIgZ2V0X3ZibF9jb3Vu
dChzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCj4gK3sKPiArICAgICAgIHN0cnVjdCBwc2JfaW50ZWxf
Y3J0YyAqcHNiX2ludGVsX2NydGMgPSB0b19wc2JfaW50ZWxfY3J0YyhjcnRjKTsKPiArICAgICAg
IHN0cnVjdCBkcm1fcHNiX3ByaXZhdGUgKmRldl9wcml2ID0gY3J0Yy0+ZGV2LT5kZXZfcHJpdmF0
ZTsKPiArICAgICAgIGludCBwaXBlID0gcHNiX2ludGVsX2NydGMtPnBpcGU7Cj4gKyAgICAgICB1
MzIgaGlnaCwgbG93MSwgbG93MiwgZHNsOwo+ICsgICAgICAgdW5zaWduZWQgaW50IHRpbWVvdXQg
PSAwOwo+ICsKPiArICAgICAgIC8qIEFsbCByZWFkcyBtdXN0IGJlIHNhdGlzZmllZCBkdXJpbmcg
dGhlIHNhbWUgZnJhbWUgKi8KPiArICAgICAgIGRvIHsKPiArICAgICAgICAgICAgICAgdm9pZCBf
X2lvbWVtICpyZWdfcGl4ZWw7Cj4gKyAgICAgICAgICAgICAgIHZvaWQgX19pb21lbSAqcmVnX2hp
Z2g7Cj4gKwo+ICsgICAgICAgICAgICAgICByZWdfcGl4ZWwgPSBkZXZfcHJpdi0+dmRjX3JlZyAr
IFBTQl9QSVBFRlJBTUVQSVhFTChwaXBlKTsKPiArICAgICAgICAgICAgICAgcmVnX2hpZ2ggPSBk
ZXZfcHJpdi0+dmRjX3JlZyArIFBTQl9QSVBFRlJBTUVISUdIKHBpcGUpOwo+ICsgICAgICAgICAg
ICAgICBsb3cxID0gaW9yZWFkMzIocmVnX3BpeGVsKSA+PiBQSVBFX0ZSQU1FX0xPV19TSElGVDsK
PiArICAgICAgICAgICAgICAgaGlnaCA9IGlvcmVhZDMyKHJlZ19oaWdoKSA8PCA4Owo+ICsgICAg
ICAgICAgICAgICBkc2wgPSBpb3JlYWQzMihkZXZfcHJpdi0+dmRjX3JlZyArIFBTQl9QSVBFX0RT
TChwaXBlKSk7Cj4gKyAgICAgICAgICAgICAgIGxvdzIgPSBpb3JlYWQzMihyZWdfcGl4ZWwpID4+
IFBJUEVfRlJBTUVfTE9XX1NISUZUOwo+ICsgICAgICAgfSB3aGlsZSAobG93MSAhPSBsb3cyICYm
IHRpbWVvdXQrKyA8IFBTQl9WQkxfQ05UX1RJTUVPVVQpOwo+ICsKPiArICAgICAgIGlmICh0aW1l
b3V0ID49IFBTQl9WQkxfQ05UX1RJTUVPVVQpCj4gKyAgICAgICAgICAgICAgIGRldl93YXJuKGNy
dGMtPmRldi0+ZGV2LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAiVGltZWQgb3V0IHdoaWxl
IGRldGVybWluaW5nIFZCTCBjb3VudCBmb3IgcGlwZSAlZFxuIiwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgcHNiX2ludGVsX2NydGMtPnBpcGUpOwo+ICsKPiArICAgICAgIC8qCj4gKyAgICAg
ICAgKiBUaGUgZnJhbWUgY291bnRlciBzZWVtcyB0byBpbmNyZW1lbnQgYXQgdGhlIGJlZ2lubmlu
ZyBvZiB0aGUKPiArICAgICAgICAqIGxhc3Qgc2NhbmxpbmUuIFRoZSBoYXJkd2FyZSBwZXJmb3Jt
cyB0aGUgZmxpcCBhdCB0aGUgc3RhcnQKPiArICAgICAgICAqIG9mIHRoZSB2YmxhbmssIHNvIHdl
IHdhbnQgdG8gY291bnQgdGhvc2UgZXZlbnRzIGluc3RlYWQuCj4gKyAgICAgICAgKiBDb29rIHVw
IGEgdmJsYW5rIGNvdW50ZXIgZnJvbSB0aGUgZnJhbWUgY291bnRlciBhbmQgc2NhbmxpbmUKPiAr
ICAgICAgICAqIGNvdW50ZXIuCj4gKyAgICAgICAgKi8KPiArICAgICAgIHJldHVybiAoKGhpZ2gg
fCBsb3cyKSArCj4gKyAgICAgICAgICAgICAgICgoZHNsID49IGNydGMtPmh3bW9kZS5jcnRjX3Zk
aXNwbGF5KSAmJgo+ICsgICAgICAgICAgICAgICAgKGRzbCA8IGNydGMtPmh3bW9kZS5jcnRjX3Z0
b3RhbCAtIDEpKSkgJiAweGZmZmZmZjsKPiArfQo+ICsKPiArc3RhdGljIHVuc2lnbmVkIGludCB1
c2Vjc190b19zY2FubGluZXMoc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCB1c2VjcykKPiArewo+ICsgICAg
ICAgLyogcGFyYW5vaWEgKi8KPiArICAgICAgIGlmICghY3J0Yy0+aHdtb2RlLmNydGNfaHRvdGFs
KQo+ICsgICAgICAgICAgICAgICByZXR1cm4gMTsKPiArCj4gKyAgICAgICByZXR1cm4gRElWX1JP
VU5EX1VQKHVzZWNzICogY3J0Yy0+aHdtb2RlLmNsb2NrLAo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAxMDAwICogY3J0Yy0+aHdtb2RlLmNydGNfaHRvdGFsKTsKPiArfQo+ICsKPiArLyog
Q2FsbGVkIHdpdGggaW50ZXJydXB0cyBvZmYuICovCj4gK3N0YXRpYyB2b2lkIGF2b2lkX2Rhbmdl
cl96b25lKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykKPiArewo+ICsgICAgICAgc3RydWN0IGRybV9k
ZXZpY2UgKmRldiA9IGNydGMtPmRldjsKPiArICAgICAgIHN0cnVjdCBkcm1fcHNiX3ByaXZhdGUg
KmRldl9wcml2ID0gZGV2LT5kZXZfcHJpdmF0ZTsKPiArICAgICAgIHN0cnVjdCBwc2JfaW50ZWxf
Y3J0YyAqcHNiX2ludGVsX2NydGMgPSB0b19wc2JfaW50ZWxfY3J0YyhjcnRjKTsKPiArICAgICAg
IGludCBwaXBlID0gcHNiX2ludGVsX2NydGMtPnBpcGU7Cj4gKyAgICAgICAvKgo+ICsgICAgICAg
ICogV2l0aCBDUlRDIGFuZCBvbmUgb3ZlcmxheSB3ZSdyZSB1c3VhbGx5IHNwZW5kaW5nIDMwLTQw
IHVzZWNzCj4gKyAgICAgICAgKiBiZXR3ZWVuIGF2b2lkX2Rhbmdlcl96b25lKCkgYW5kIHBzYl9m
bGlwX2RyaXZlcl9mbHVzaCgpLiBMZWF2ZQo+ICsgICAgICAgICogYSBzbWFsbCBzYWZldHkgbWFy
Z2luIGFuZCBhdm9pZCBmbGlwcGluZyB3aGlsZSB1bmRlciA2MCB1c2VjCj4gKyAgICAgICAgKiBm
cm9tIHRoZSB2Ymxhbmsgc3RhcnQuCj4gKyAgICAgICAgKi8KPiArICAgICAgIHUzMiBtaW4gPSBj
cnRjLT5od21vZGUuY3J0Y192ZGlzcGxheSAtIHVzZWNzX3RvX3NjYW5saW5lcyhjcnRjLCA2MCk7
Cj4gKyAgICAgICB1MzIgbWF4ID0gY3J0Yy0+aHdtb2RlLmNydGNfdmRpc3BsYXkgLSAxOwo+ICsg
ICAgICAgbG9uZyB0aW1lb3V0ID0gbXNlY3NfdG9famlmZmllcygxKTsKPiArICAgICAgIHUzMiB2
YWw7Cj4gKwo+ICsgICAgICAgZHJtX3ZibGFua19nZXQoZGV2LCBwaXBlKTsKPiArCj4gKyAgICAg
ICBwc2JfaW50ZWxfY3J0Yy0+dmJsX3JlY2VpdmVkID0gZmFsc2U7Cj4gKyAgICAgICB2YWwgPSBp
b3JlYWQzMihkZXZfcHJpdi0+dmRjX3JlZyArIFBTQl9QSVBFX0RTTChwaXBlKSk7Cj4gKwo+ICsg
ICAgICAgd2hpbGUgKHZhbCA+PSBtaW4gJiYgdmFsIDw9IG1heCAmJiB0aW1lb3V0ID4gMCkgewo+
ICsgICAgICAgICAgICAgICBsb2NhbF9pcnFfZW5hYmxlKCk7Cj4gKwo+ICsgICAgICAgICAgICAg
ICB0aW1lb3V0ID0gd2FpdF9ldmVudF90aW1lb3V0KHBzYl9pbnRlbF9jcnRjLT52Ymxfd2FpdCwK
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwc2JfaW50ZWxf
Y3J0Yy0+dmJsX3JlY2VpdmVkLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHRpbWVvdXQpOwo+ICsKPiArICAgICAgICAgICAgICAgbG9jYWxfaXJxX2Rpc2Fi
bGUoKTsKPiArCj4gKyAgICAgICAgICAgICAgIHBzYl9pbnRlbF9jcnRjLT52YmxfcmVjZWl2ZWQg
PSBmYWxzZTsKPiArICAgICAgICAgICAgICAgdmFsID0gaW9yZWFkMzIoZGV2X3ByaXYtPnZkY19y
ZWcgKyBQU0JfUElQRV9EU0wocGlwZSkpOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGRybV92
YmxhbmtfcHV0KGRldiwgcGlwZSk7Cj4gKwo+ICsgICAgICAgaWYgKHZhbCA+PSBtaW4gJiYgdmFs
IDw9IG1heCkKPiArICAgICAgICAgICAgICAgZGV2X3dhcm4oZGV2LT5kZXYsCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICJQYWdlIGZsaXBwaW5nIGNsb3NlIHRvIHZibGFuayBzdGFydCAoRFNM
PSV1LCBWQkw9JXUpXG4iLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICB2YWwsIGNydGMtPmh3
bW9kZS5jcnRjX3ZkaXNwbGF5KTsKPiArfQo+ICsKPiArdm9pZAo+ICtwc2JfY2xlYW51cF9wZW5k
aW5nX2V2ZW50cyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBzdHJ1Y3QgcHNiX2Zwcml2ICpwcml2
KQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX3BlbmRpbmdfdmJsYW5rX2V2ZW50ICplOwo+ICsg
ICAgICAgc3RydWN0IHBlbmRpbmdfZmxpcCAqcGVuZGluZ19mbGlwLCAqdGVtcDsKPiArICAgICAg
IHVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gKwo+ICsgICAgICAgc3Bpbl9sb2NrX2lycXNhdmUoJmRl
di0+ZXZlbnRfbG9jaywgZmxhZ3MpOwo+ICsgICAgICAgbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZl
KHBlbmRpbmdfZmxpcCwgdGVtcCwgJnByaXYtPnBlbmRpbmdfZmxpcHMsCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgdW5jb21wbGV0ZWQpIHsKPiArICAgICAgICAgICAgICAgZSA9IHBlbmRpbmdf
ZmxpcC0+ZXZlbnQ7Cj4gKyAgICAgICAgICAgICAgIHBlbmRpbmdfZmxpcC0+ZXZlbnQgPSBOVUxM
Owo+ICsgICAgICAgICAgICAgICBlLT5iYXNlLmRlc3Ryb3koJmUtPmJhc2UpOwo+ICsgICAgICAg
ICAgICAgICBsaXN0X2RlbF9pbml0KCZwZW5kaW5nX2ZsaXAtPnVuY29tcGxldGVkKTsKPiArICAg
ICAgIH0KPiArICAgICAgIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRldi0+ZXZlbnRfbG9jaywg
ZmxhZ3MpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZAo+ICtzZW5kX3BhZ2VfZmxpcF9ldmVudChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBpbnQgcGlwZSwKPiArICAgICAgICAgICAgICAgICAgICBz
dHJ1Y3QgcGVuZGluZ19mbGlwICpwZW5kaW5nX2ZsaXApCj4gK3sKPiArICAgICAgIHN0cnVjdCBk
cm1fcGVuZGluZ192YmxhbmtfZXZlbnQgKmU7Cj4gKyAgICAgICBzdHJ1Y3QgdGltZXZhbCBub3c7
Cj4gKyAgICAgICB1bnNpZ25lZCBsb25nIGZsYWdzOwo+ICsKPiArICAgICAgIHNwaW5fbG9ja19p
cnFzYXZlKCZkZXYtPmV2ZW50X2xvY2ssIGZsYWdzKTsKPiArCj4gKyAgICAgICBpZiAoIXBlbmRp
bmdfZmxpcC0+ZXZlbnQpCj4gKyAgICAgICAgICAgICAgIGdvdG8gdW5sb2NrOwo+ICsKPiArICAg
ICAgIGxpc3RfZGVsKCZwZW5kaW5nX2ZsaXAtPnVuY29tcGxldGVkKTsKPiArICAgICAgIGUgPSBw
ZW5kaW5nX2ZsaXAtPmV2ZW50Owo+ICsgICAgICAgZG9fZ2V0dGltZW9mZGF5KCZub3cpOwo+ICsg
ICAgICAgZS0+ZXZlbnQuc2VxdWVuY2UgPSBkcm1fdmJsYW5rX2NvdW50KGRldiwgcGlwZSk7Cj4g
KyAgICAgICBlLT5ldmVudC50dl9zZWMgPSBub3cudHZfc2VjOwo+ICsgICAgICAgZS0+ZXZlbnQu
dHZfdXNlYyA9IG5vdy50dl91c2VjOwo+ICsgICAgICAgbGlzdF9hZGRfdGFpbCgmZS0+YmFzZS5s
aW5rLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICZlLT5iYXNlLmZpbGVfcHJpdi0+ZXZlbnRf
bGlzdCk7Cj4gKyAgICAgICB3YWtlX3VwX2ludGVycnVwdGlibGUoJmUtPmJhc2UuZmlsZV9wcml2
LT5ldmVudF93YWl0KTsKPiArCj4gK3VubG9jazoKPiArICAgICAgIHNwaW5fdW5sb2NrX2lycXJl
c3RvcmUoJmRldi0+ZXZlbnRfbG9jaywgZmxhZ3MpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBm
cmVlX2ZsaXAoc3RydWN0IHBlbmRpbmdfZmxpcCAqY3J0Y19mbGlwKQo+ICt7Cj4gKyAgICAgICBp
ZiAoYXRvbWljX2RlY19hbmRfdGVzdCgmY3J0Y19mbGlwLT5yZWZjbnQpKSB7Cj4gKyAgICAgICAg
ICAgICAgIHBzYl9mYl91bnJlZihjcnRjX2ZsaXAtPm9sZF9tZW1faW5mbywgY3J0Y19mbGlwLT50
Z2lkKTsKPiArICAgICAgICAgICAgICAga2ZyZWUoY3J0Y19mbGlwKTsKPiArICAgICAgIH0KPiAr
fQo+ICsKPiArc3RhdGljIHZvaWQgY3J0Y19mbGlwX2NsZWFudXAoc3RydWN0IGRybV9mbGlwICpm
bGlwKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgcGVuZGluZ19mbGlwICpjcnRjX2ZsaXAgPQo+ICsg
ICAgICAgICAgICAgICBjb250YWluZXJfb2YoZmxpcCwgc3RydWN0IHBlbmRpbmdfZmxpcCwgYmFz
ZSk7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Y19mbGlwLT5jcnRjLT5k
ZXY7Cj4gKwo+ICsgICAgICAgbXV0ZXhfbG9jaygmZGV2LT5tb2RlX2NvbmZpZy5tdXRleCk7Cj4g
KyAgICAgICBwc2JfZmJfZ3R0X3VucmVmKGRldiwgY3J0Y19mbGlwLT5tZW1faW5mbywgY3J0Y19m
bGlwLT50Z2lkKTsKPiArICAgICAgIG11dGV4X3VubG9jaygmZGV2LT5tb2RlX2NvbmZpZy5tdXRl
eCk7Cj4gKwo+ICsgICAgICAgZnJlZV9mbGlwKGNydGNfZmxpcCk7Cj4gK30KPiArCj4gK3N0YXRp
YyB2b2lkIGNydGNfZmxpcF9maW5pc2goc3RydWN0IGRybV9mbGlwICpmbGlwKQo+ICt7Cj4gK30K
PiArCj4gK3N0YXRpYyB2b2lkIHBzYl9mbGlwX2RyaXZlcl9mbHVzaChzdHJ1Y3QgZHJtX2ZsaXBf
ZHJpdmVyICpkcml2ZXIpCj4gK3sKPiArICAgICAgIHN0cnVjdCBkcm1fcHNiX3ByaXZhdGUgKmRl
dl9wcml2ID0KPiArICAgICAgICAgICAgICAgY29udGFpbmVyX29mKGRyaXZlciwgc3RydWN0IGRy
bV9wc2JfcHJpdmF0ZSwgZmxpcF9kcml2ZXIpOwo+ICsKPiArICAgICAgIC8qIEZsdXNoIHBvc3Rl
ZCB3cml0ZXMgKi8KPiArICAgICAgICh2b2lkKWlvcmVhZDMyKGRldl9wcml2LT52ZGNfcmVnICsg
UFNCX1BJUEVTVEFUKFBTQl9QSVBFX0EpKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgcHNiX2Zs
aXBfY29tcGxldGVfc3luY19jYWxsYmFjayhzdHJ1Y3QgcHZyX3BlbmRpbmdfc3luYyAqc3luYywK
PiArICAgICAgICAgICAgICAgYm9vbCBjYWxsX2Zyb21fd29yaykKPiArewo+ICsgICAgICAgc3Ry
dWN0IHBlbmRpbmdfZmxpcCAqY3J0Y19mbGlwID0KPiArICAgICAgICAgICAgICAgY29udGFpbmVy
X29mKHN5bmMsIHN0cnVjdCBwZW5kaW5nX2ZsaXAsIHBlbmRpbmdfc3luYyk7Cj4gKwo+ICsgICAg
ICAgaWYgKHBzYl9mYl9pbmNyZWFzZV9yZWFkX29wc19jb21wbGV0ZWQoY3J0Y19mbGlwLT5vbGRf
bWVtX2luZm8sCj4gKyAgICAgICAgICAgICAgICAgICAgICAgJmNydGNfZmxpcC0+cGVuZGluZ192
YWx1ZXMsIHN5bmMpKSB7Cj4gKyAgICAgICAgICAgICAgIFdBUk4odHJ1ZSwgIlN5bmMgY2FsbGJh
Y2sgY2FsbGVkIHdpdGhvdXQgY29tcGxldGluZyBvcGVyYXRpb24iKTsKPiArICAgICAgICAgICAg
ICAgcmV0dXJuOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGZyZWVfZmxpcChjcnRjX2ZsaXAp
Owo+ICsKPiArICAgICAgIGlmIChjYWxsX2Zyb21fd29yaykKPiArICAgICAgICAgICAgICAgbXV0
ZXhfbG9jaygmZ1BWUlNSVkxvY2spOwo+ICsKPiArICAgICAgIFBWUlNSVlNjaGVkdWxlRGV2aWNl
Q2FsbGJhY2tzKCk7Cj4gKwo+ICsgICAgICAgaWYgKGNhbGxfZnJvbV93b3JrKQo+ICsgICAgICAg
ICAgICAgICBtdXRleF91bmxvY2soJmdQVlJTUlZMb2NrKTsKPiArfQo+ICsKPiArc3RhdGljIHZv
aWQgY3J0Y19mbGlwX2NvbXBsZXRlKHN0cnVjdCBkcm1fZmxpcCAqZmxpcCkKPiArewo+ICsgICAg
ICAgc3RydWN0IHBlbmRpbmdfZmxpcCAqY3J0Y19mbGlwID0KPiArICAgICAgICAgICAgICAgY29u
dGFpbmVyX29mKGZsaXAsIHN0cnVjdCBwZW5kaW5nX2ZsaXAsIGJhc2UpOwo+ICsgICAgICAgc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGNfZmxpcC0+Y3J0Yy0+ZGV2Owo+ICsgICAgICAgaW50
IHBpcGUgPSB0b19wc2JfaW50ZWxfY3J0YyhjcnRjX2ZsaXAtPmNydGMpLT5waXBlOwo+ICsKPiAr
ICAgICAgIHNlbmRfcGFnZV9mbGlwX2V2ZW50KGRldiwgcGlwZSwgY3J0Y19mbGlwKTsKPiArCj4g
KyAgICAgICBpZiAoY3J0Y19mbGlwLT52YmxhbmtfcmVmKQo+ICsgICAgICAgICAgICAgICBkcm1f
dmJsYW5rX3B1dChkZXYsIHBpcGUpOwo+ICsKPiArICAgICAgIGF0b21pY19pbmMoJmNydGNfZmxp
cC0+cmVmY250KTsKPiArICAgICAgIGNydGNfZmxpcC0+cGVuZGluZ19zeW5jLmNhbGxiYWNrID0g
cHNiX2ZsaXBfY29tcGxldGVfc3luY19jYWxsYmFjazsKPiArICAgICAgIGlmIChwc2JfZmJfaW5j
cmVhc2VfcmVhZF9vcHNfY29tcGxldGVkKGNydGNfZmxpcC0+b2xkX21lbV9pbmZvLAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgJmNydGNfZmxpcC0+cGVuZGluZ192YWx1ZXMsCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmY3J0Y19mbGlwLT5wZW5kaW5nX3N5bmMp
KQo+ICsgICAgICAgICAgICAgICByZXR1cm47Cj4gKwo+ICsgICAgICAgZnJlZV9mbGlwKGNydGNf
ZmxpcCk7Cj4gKyAgICAgICBQVlJTUlZTY2hlZHVsZURldmljZUNhbGxiYWNrcygpOwo+ICt9Cj4g
Kwo+ICtzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9mbGlwX2RyaXZlcl9mdW5jcyBwc2JfZmxpcF9k
cml2ZXJfZnVuY3MgPSB7Cj4gKyAgICAgICAuZmx1c2ggPSBwc2JfZmxpcF9kcml2ZXJfZmx1c2gs
Cj4gK307Cj4gKwo+ICt2b2lkIHBzYl9wYWdlX2ZsaXBfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2KQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX3BzYl9wcml2YXRlICpkZXZfcHJpdiA9IGRl
di0+ZGV2X3ByaXZhdGU7Cj4gKwo+ICsgICAgICAgZHJtX2ZsaXBfZHJpdmVyX2luaXQoJmRldl9w
cml2LT5mbGlwX2RyaXZlciwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICZwc2JfZmxp
cF9kcml2ZXJfZnVuY3MpOwo+ICt9Cj4gKwo+ICt2b2lkIHBzYl9wYWdlX2ZsaXBfZmluaShzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2KQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX3BzYl9wcml2YXRl
ICpkZXZfcHJpdiA9IGRldi0+ZGV2X3ByaXZhdGU7Cj4gKwo+ICsgICAgICAgZHJtX2ZsaXBfZHJp
dmVyX2ZpbmkoJmRldl9wcml2LT5mbGlwX2RyaXZlcik7Cj4gK30KPiArCj4gK3N0YXRpYyBib29s
IHZibF9jb3VudF9hZnRlcl9lcSh1MzIgYSwgdTMyIGIpCj4gK3sKPiArICAgICAgIHJldHVybiAh
KChhIC0gYikgJiAweDgwMDAwMCk7Cj4gK30KPiArCj4gK3N0YXRpYyBib29sIGNydGNfY2hlY2so
c3RydWN0IGRybV9mbGlwICpwZW5kaW5nX2ZsaXAsCj4gKyAgICAgICAgICAgICAgICAgICAgICB1
MzIgdmJsX2NvdW50KQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgcGVuZGluZ19mbGlwICpjcnRjX2Zs
aXAgPQo+ICsgICAgICAgICAgICAgICBjb250YWluZXJfb2YocGVuZGluZ19mbGlwLCBzdHJ1Y3Qg
cGVuZGluZ19mbGlwLCBiYXNlKTsKPiArCj4gKyAgICAgICByZXR1cm4gdmJsX2NvdW50X2FmdGVy
X2VxKHZibF9jb3VudCwgY3J0Y19mbGlwLT52YmxfY291bnQpOwo+ICt9Cj4gKwo+ICtzdGF0aWMg
Ym9vbCBjcnRjX2ZsaXAoc3RydWN0IGRybV9mbGlwICpmbGlwLAo+ICsgICAgICAgICAgICAgICAg
ICAgICBzdHJ1Y3QgZHJtX2ZsaXAgKnBlbmRpbmdfZmxpcCkKPiArewo+ICsgICAgICAgc3RydWN0
IHBlbmRpbmdfZmxpcCAqY3J0Y19mbGlwID0gY29udGFpbmVyX29mKGZsaXAsIHN0cnVjdCBwZW5k
aW5nX2ZsaXAsIGJhc2UpOwo+ICsgICAgICAgc3RydWN0IGRybV9jcnRjICpjcnRjID0gY3J0Y19m
bGlwLT5jcnRjOwo+ICsgICAgICAgc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmRldjsK
PiArICAgICAgIHN0cnVjdCBkcm1fcHNiX3ByaXZhdGUgKmRldl9wcml2ID0gZGV2LT5kZXZfcHJp
dmF0ZTsKPiArICAgICAgIGludCBwaXBlID0gdG9fcHNiX2ludGVsX2NydGMoY3J0YyktPnBpcGU7
Cj4gKyAgICAgICB1MzIgdmJsX2NvdW50Owo+ICsKPiArICAgICAgIGNydGNfZmxpcC0+dmJsYW5r
X3JlZiA9IGRybV92YmxhbmtfZ2V0KGRldiwgcGlwZSkgPT0gMDsKPiArCj4gKyAgICAgICB2Ymxf
Y291bnQgPSBnZXRfdmJsX2NvdW50KGNydGMpOwo+ICsKPiArICAgICAgIGlvd3JpdGUzMihjcnRj
X2ZsaXAtPm9mZnNldCwgZGV2X3ByaXYtPnZkY19yZWcgKyBQU0JfRFNQU1VSRihwaXBlKSk7Cj4g
Kwo+ICsgICAgICAgLyogVGhpcyBmbGlwIHdpbGwgaGFwcGVuIG9uIHRoZSBuZXh0IHZibGFuayAq
Lwo+ICsgICAgICAgY3J0Y19mbGlwLT52YmxfY291bnQgPSAodmJsX2NvdW50ICsgMSkgJiAweGZm
ZmZmZjsKPiArCj4gKyAgICAgICBpZiAocGVuZGluZ19mbGlwKSB7Cj4gKyAgICAgICAgICAgICAg
IHN0cnVjdCBwZW5kaW5nX2ZsaXAgKm9sZF9jcnRjX2ZsaXAgPQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgIGNvbnRhaW5lcl9vZihwZW5kaW5nX2ZsaXAsIHN0cnVjdCBwZW5kaW5nX2ZsaXAsIGJh
c2UpOwo+ICsgICAgICAgICAgICAgICBib29sIGZsaXBwZWQgPSBjcnRjX2NoZWNrKHBlbmRpbmdf
ZmxpcCwgdmJsX2NvdW50KTsKPiArCj4gKyAgICAgICAgICAgICAgIGlmICghZmxpcHBlZCkgewo+
ICsgICAgICAgICAgICAgICAgICAgICAgIHN3YXAoY3J0Y19mbGlwLT5vbGRfbWVtX2luZm8sIG9s
ZF9jcnRjX2ZsaXAtPm9sZF9tZW1faW5mbyk7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgc3dh
cChjcnRjX2ZsaXAtPnBlbmRpbmdfdmFsdWVzLCBvbGRfY3J0Y19mbGlwLT5wZW5kaW5nX3ZhbHVl
cyk7Cj4gKyAgICAgICAgICAgICAgIH0KPiArCj4gKyAgICAgICAgICAgICAgIHJldHVybiBmbGlw
cGVkOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIHJldHVybiBmYWxzZTsKPiArfQo+ICsKPiAr
c3RhdGljIGJvb2wgY3J0Y192Ymxhbmsoc3RydWN0IGRybV9mbGlwICpwZW5kaW5nX2ZsaXApCj4g
K3sKPiArICAgICAgIHN0cnVjdCBwZW5kaW5nX2ZsaXAgKmNydGNfZmxpcCA9Cj4gKyAgICAgICAg
ICAgICAgIGNvbnRhaW5lcl9vZihwZW5kaW5nX2ZsaXAsIHN0cnVjdCBwZW5kaW5nX2ZsaXAsIGJh
c2UpOwo+ICsgICAgICAgdTMyIHZibF9jb3VudCA9IGdldF92YmxfY291bnQoY3J0Y19mbGlwLT5j
cnRjKTsKPiArCj4gKyAgICAgICByZXR1cm4gY3J0Y19jaGVjayhwZW5kaW5nX2ZsaXAsIHZibF9j
b3VudCk7Cj4gK30KPiArCj4gK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2ZsaXBfaGVscGVyX2Z1
bmNzIGNydGNfZmxpcF9mdW5jcyA9IHsKPiArICAgICAgIC5mbGlwID0gY3J0Y19mbGlwLAo+ICsg
ICAgICAgLnZibGFuayA9IGNydGNfdmJsYW5rLAo+ICsgICAgICAgLmNvbXBsZXRlID0gY3J0Y19m
bGlwX2NvbXBsZXRlLAo+ICsgICAgICAgLmZpbmlzaCA9IGNydGNfZmxpcF9maW5pc2gsCj4gKyAg
ICAgICAuY2xlYW51cCA9IGNydGNfZmxpcF9jbGVhbnVwLAo+ICt9Owo+ICsKPiArdm9pZCBwc2Jf
cGFnZV9mbGlwX2NydGNfaW5pdChzdHJ1Y3QgcHNiX2ludGVsX2NydGMgKnBzYl9pbnRlbF9jcnRj
KQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gcHNiX2ludGVsX2NydGMt
PmJhc2UuZGV2Owo+ICsgICAgICAgc3RydWN0IGRybV9wc2JfcHJpdmF0ZSAqZGV2X3ByaXYgPSBk
ZXYtPmRldl9wcml2YXRlOwo+ICsKPiArICAgICAgIGRybV9mbGlwX2hlbHBlcl9pbml0KCZwc2Jf
aW50ZWxfY3J0Yy0+ZmxpcF9oZWxwZXIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAm
ZGV2X3ByaXYtPmZsaXBfZHJpdmVyLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmNy
dGNfZmxpcF9mdW5jcyk7Cj4gK30KPiArCj4gK3ZvaWQgcHNiX3BhZ2VfZmxpcF9jcnRjX2Zpbmko
c3RydWN0IHBzYl9pbnRlbF9jcnRjICpwc2JfaW50ZWxfY3J0YykKPiArewo+ICsgICAgICAgZHJt
X2ZsaXBfaGVscGVyX2ZpbmkoJnBzYl9pbnRlbF9jcnRjLT5mbGlwX2hlbHBlcik7Cj4gK30KPiAr
Cj4gK3N0YXRpYyB2b2lkCj4gK3BzYl9pbnRlbF9jcnRjX3Byb2Nlc3NfdmJsYW5rX3JlYWwoc3Ry
dWN0IGRybV9jcnRjICpjcnRjKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX3BzYl9wcml2YXRl
ICpkZXZfcHJpdiA9IGNydGMtPmRldi0+ZGV2X3ByaXZhdGU7Cj4gKyAgICAgICBzdHJ1Y3QgcHNi
X2ludGVsX2NydGMgKnBzYl9pbnRlbF9jcnRjID0gdG9fcHNiX2ludGVsX2NydGMoY3J0Yyk7Cj4g
KyAgICAgICBpbnQgcGlwZSA9IHBzYl9pbnRlbF9jcnRjLT5waXBlOwo+ICsgICAgICAgaW50IGk7
Cj4gKwo+ICsgICAgICAgcHNiX2ludGVsX2NydGMtPnZibF9yZWNlaXZlZCA9IHRydWU7Cj4gKyAg
ICAgICB3YWtlX3VwKCZwc2JfaW50ZWxfY3J0Yy0+dmJsX3dhaXQpOwo+ICsKPiArICAgICAgIGZv
ciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGRldl9wcml2LT5vdmVybGF5cyk7IGkrKykgewo+ICsg
ICAgICAgICAgICAgICBpZiAoIWRldl9wcml2LT5vdmVybGF5c1tpXSkKPiArICAgICAgICAgICAg
ICAgICAgICAgICBjb250aW51ZTsKPiArCj4gKyAgICAgICAgICAgICAgIG1kZmxkX292ZXJsYXlf
cHJvY2Vzc192YmxhbmsoZGV2X3ByaXYtPm92ZXJsYXlzW2ldLCBwaXBlKTsKPiArICAgICAgIH0K
PiArCj4gKyAgICAgICBkcm1fZmxpcF9oZWxwZXJfdmJsYW5rKCZwc2JfaW50ZWxfY3J0Yy0+Zmxp
cF9oZWxwZXIpOwo+ICt9Cj4gKwo+ICt2b2lkCj4gK3BzYl9pbnRlbF9jcnRjX3Byb2Nlc3NfdmJs
YW5rKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykKPiArewo+ICsgICAgICAgc3RydWN0IGRybV9wc2Jf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBjcnRjLT5kZXYtPmRldl9wcml2YXRlOwo+ICsgICAgICAgc3Ry
dWN0IHBzYl9pbnRlbF9jcnRjICpwc2JfaW50ZWxfY3J0YyA9IHRvX3BzYl9pbnRlbF9jcnRjKGNy
dGMpOwo+ICsgICAgICAgaW50IHBpcGUgPSBwc2JfaW50ZWxfY3J0Yy0+cGlwZTsKPiArICAgICAg
IHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3I7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX2Ny
dGMgKmhkbWljcnRjID0gTlVMTDsKPiArCj4gKyAgICAgICBwc2JfaW50ZWxfY3J0Y19wcm9jZXNz
X3ZibGFua19yZWFsKGNydGMpOwo+ICsKPiArICAgICAgIC8qIFRoaXMgZm9sbG93aW5nIGlzIHRv
IGhhbmRsZSBIRE1JIHBlbmRpbmcgZmxpcHMgaWYgdW5wbHVnIHRoZSBjYWJsZQo+ICsgICAgICAg
ICogQWZ0ZXIgSERNSSBpcyB1bnBsdWdlZCwgdGhlcmUgaXMgbm8gdmJsYW5rIGludGVycnVwdCBh
bnltb3JlLgo+ICsgICAgICAgICogQnV0IHRoZXJlIG1heSBiZSBzb21lIHBlbmRpbmcgZmxpcHMg
ZXhpc3RzIGluIHBzYl9pbnRlbF9jcnRjLgo+ICsgICAgICAgICogV2UgbmVlZCBjb21wbGV0IHRo
ZSBwZW5kaW5nIGZsaXBzLgo+ICsgICAgICAgICogVGhpcyBjYW4gYmUgUkVWRVJURUQsIGlmIHRo
ZSBwZW5kaW5nIGZsaXAgaXNzdWUgZml4ZWQuCj4gKyAgICAgICAgKi8KPiArICAgICAgIGlmIChw
aXBlICE9IDApCj4gKyAgICAgICAgICAgICAgIHJldHVybjsKPiArCj4gKyAgICAgICBoZG1pY3J0
YyA9IGRldl9wcml2LT5waXBlX3RvX2NydGNfbWFwcGluZ1sxXTsKPiArICAgICAgIGlmICghaGRt
aWNydGMpCj4gKyAgICAgICAgICAgICAgIHJldHVybjsKPiArCj4gKyAgICAgICBsaXN0X2Zvcl9l
YWNoX2VudHJ5KGNvbm5lY3RvciwKPiArICAgICAgICAgICAgICAgICAgICAgICAmY3J0Yy0+ZGV2
LT5tb2RlX2NvbmZpZy5jb25uZWN0b3JfbGlzdCwgaGVhZCkgewo+ICsgICAgICAgICAgICAgICBp
ZiAoY29ubmVjdG9yLT5jb25uZWN0b3JfdHlwZSA9PSBEUk1fTU9ERV9DT05ORUNUT1JfRFZJRCAm
Jgo+ICsgICAgICAgICAgICAgICAgICAgICAgIGNvbm5lY3Rvci0+c3RhdHVzID09IGNvbm5lY3Rv
cl9zdGF0dXNfZGlzY29ubmVjdGVkKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgcHNiX2lu
dGVsX2NydGNfcHJvY2Vzc192YmxhbmtfcmVhbChoZG1pY3J0Yyk7Cj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgYnJlYWs7Cj4gKyAgICAgICAgICAgICAgIH0KPiArICAgICAgIH0KPiArfQo+ICsK
PiArc3RhdGljIHZvaWQKPiArc3luY19jYWxsYmFjayhzdHJ1Y3QgcHZyX3BlbmRpbmdfc3luYyAq
cGVuZGluZ19zeW5jLCBib29sIGZyb21fbWlzcikKPiArewo+ICsgICAgICAgc3RydWN0IHBlbmRp
bmdfZmxpcCAqcGVuZGluZ19mbGlwID0KPiArICAgICAgICAgICAgICAgY29udGFpbmVyX29mKHBl
bmRpbmdfc3luYywgc3RydWN0IHBlbmRpbmdfZmxpcCwgcGVuZGluZ19zeW5jKTsKPiArICAgICAg
IHN0cnVjdCBkcm1fY3J0YyogY3J0YyA9IHBlbmRpbmdfZmxpcC0+Y3J0YzsKPiArICAgICAgIHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5kZXY7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX3Bz
Yl9wcml2YXRlICpkZXZfcHJpdiA9IGRldi0+ZGV2X3ByaXZhdGU7Cj4gKyAgICAgICBzdHJ1Y3Qg
ZHJtX2ZsaXAgKmZsaXAsICpuZXh0Owo+ICsgICAgICAgTElTVF9IRUFEKGZsaXBzKTsKPiArICAg
ICAgIGJvb2wgcGlwZV9lbmFibGVkID0gZmFsc2U7Cj4gKwo+ICsgICAgICAgbGlzdF9hZGRfdGFp
bCgmcGVuZGluZ19mbGlwLT5iYXNlLmxpc3QsICZmbGlwcyk7Cj4gKwo+ICsgICAgICAgbGlzdF9m
b3JfZWFjaF9lbnRyeV9zYWZlKGZsaXAsIG5leHQsICZwZW5kaW5nX2ZsaXAtPmNvbXBhbmlvbnMs
IGxpc3QpCj4gKyAgICAgICAgICAgICAgIGxpc3RfbW92ZV90YWlsKCZmbGlwLT5saXN0LCAmZmxp
cHMpOwo+ICsKPiArICAgICAgIFdBUk5fT04oIWxpc3RfZW1wdHkoJnBlbmRpbmdfZmxpcC0+Y29t
cGFuaW9ucykpOwo+ICsKPiArICAgICAgIC8qIHByZXZlbnQgRFBNUyBhbmQgd2hhdG5vdCBmcm9t
IHNob290aW5nIHVzIGluIHRoZSBmb290ICovCj4gKyAgICAgICBpZiAoZnJvbV9taXNyKQo+ICsg
ICAgICAgICAgICAgICBtdXRleF9sb2NrKCZkZXYtPm1vZGVfY29uZmlnLm11dGV4KTsKPiArCj4g
KyAgICAgICBpZiAob3NwbV9wb3dlcl91c2luZ19od19iZWdpbihPU1BNX0RJU1BMQVlfSVNMQU5E
LCBmYWxzZSkpIHsKPiArICAgICAgICAgICAgICAgaW50IHBpcGUgPSB0b19wc2JfaW50ZWxfY3J0
YyhjcnRjKS0+cGlwZTsKPiArICAgICAgICAgICAgICAgdTMyIHZhbDsKPiArCj4gKyAgICAgICAg
ICAgICAgIHZhbCA9IGlvcmVhZDMyKGRldl9wcml2LT52ZGNfcmVnICsgUFNCX1BJUEVDT05GKHBp
cGUpKTsKPiArCj4gKyAgICAgICAgICAgICAgIHBpcGVfZW5hYmxlZCA9IHZhbCAmIFBJUEVBQ09O
Rl9FTkFCTEU7Cj4gKwo+ICsgICAgICAgICAgICAgICBpZiAoIXBpcGVfZW5hYmxlZCkKPiArICAg
ICAgICAgICAgICAgICAgICAgICBvc3BtX3Bvd2VyX3VzaW5nX2h3X2VuZChPU1BNX0RJU1BMQVlf
SVNMQU5EKTsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICBpZiAocGlwZV9lbmFibGVkKSB7Cj4g
KyAgICAgICAgICAgICAgIGRybV9mbGlwX2RyaXZlcl9wcmVwYXJlX2ZsaXBzKCZkZXZfcHJpdi0+
ZmxpcF9kcml2ZXIsICZmbGlwcyk7Cj4gKwo+ICsgICAgICAgICAgICAgICAvKiBNYWtlIHN1cmUg
d2UncmUgbm90IGludGVycnVwdGVkIGR1cmluZyB0aGUgY3JpdGljYWwgcGhhc2UgKi8KPiArICAg
ICAgICAgICAgICAgbG9jYWxfaXJxX2Rpc2FibGUoKTsKPiArCj4gKyAgICAgICAgICAgICAgIC8q
Cj4gKyAgICAgICAgICAgICAgICAqIElmIHdlIGNyb3NzIGludG8gdmJsYW5rIHdoaWxlIHByb2dy
YW1taW5nIHRoZSBmbGlwcywgd2UKPiArICAgICAgICAgICAgICAgICogY2FuJ3QgZGV0ZXJtaW5l
IHdoaWNoIGZsaXBzIGhhdmUgY29tcGxldGVkLiBBbHNvIHdoZW4KPiArICAgICAgICAgICAgICAg
ICogdHJ5aW5nIHRvIHN5bmNocm9uaXplIG11bHRpcGxlIGZsaXBzLCB3ZSBjYW4ndCBiZSBzdXJl
Cj4gKyAgICAgICAgICAgICAgICAqIHRoYXQgYWxsIGZsaXBzIHdpbGwgaGFwcGVuIG9uIHRoZSBz
YW1lIHZibGFuay4gU28sIGlmCj4gKyAgICAgICAgICAgICAgICAqIHdlJ3JlIGNsb3NlIHRvIHRo
ZSBzdGFydCBvZiB2YmxhbmssIHdhaXQgdW50aWwgd2UncmUKPiArICAgICAgICAgICAgICAgICog
c2FmZWx5IHBhc3QgaXQgYmVmb3JlIHByb2NlZWRpbmcgYW55IGZ1cnRoZXIuCj4gKyAgICAgICAg
ICAgICAgICAqLwo+ICsgICAgICAgICAgICAgICBhdm9pZF9kYW5nZXJfem9uZShjcnRjKTsKPiAr
Cj4gKyAgICAgICAgICAgICAgIGRybV9mbGlwX2RyaXZlcl9zY2hlZHVsZV9mbGlwcygmZGV2X3By
aXYtPmZsaXBfZHJpdmVyLCAmZmxpcHMpOwo+ICsKPiArICAgICAgICAgICAgICAgbG9jYWxfaXJx
X2VuYWJsZSgpOwo+ICsKPiArICAgICAgICAgICAgICAgb3NwbV9wb3dlcl91c2luZ19od19lbmQo
T1NQTV9ESVNQTEFZX0lTTEFORCk7Cj4gKyAgICAgICB9IGVsc2UKPiArICAgICAgICAgICAgICAg
LyogcG93ZXJlZCBvZmYsIGp1c3QgY29tcGxldGUgYWxsIHBlbmRpbmcgYW5kIG5ldyBmbGlwcyAq
Lwo+ICsgICAgICAgICAgICAgICBkcm1fZmxpcF9kcml2ZXJfY29tcGxldGVfZmxpcHMoJmRldl9w
cml2LT5mbGlwX2RyaXZlciwgJmZsaXBzKTsKPiArCj4gKyAgICAgICBpZiAoZnJvbV9taXNyKQo+
ICsgICAgICAgICAgICAgICBtdXRleF91bmxvY2soJmRldi0+bW9kZV9jb25maWcubXV0ZXgpOwo+
ICt9Cj4gKwo+ICtpbnQKPiArcHNiX2ludGVsX2NydGNfcGFnZV9mbGlwKHN0cnVjdCBkcm1fY3J0
YyAqY3J0YywKPiArICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBkcm1fZnJhbWVidWZm
ZXIgKmZiLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGRybV9wZW5kaW5nX3Zi
bGFua19ldmVudCAqZXZlbnQpCj4gK3sKPiArICAgICAgIHN0cnVjdCBkcm1fZGV2aWNlICpkZXYg
PSBjcnRjLT5kZXY7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX3BzYl9wcml2YXRlICpkZXZfcHJpdiA9
IGRldi0+ZGV2X3ByaXZhdGU7Cj4gKyAgICAgICBzdHJ1Y3QgcHNiX2ZyYW1lYnVmZmVyICpwc2Jm
YiA9IHRvX3BzYl9mYihmYik7Cj4gKyAgICAgICBQVlJTUlZfS0VSTkVMX01FTV9JTkZPICpjdXJy
ZW50X2ZiX21lbV9pbmZvOwo+ICsgICAgICAgc3RydWN0IHBlbmRpbmdfZmxpcCAqbmV3X3BlbmRp
bmdfZmxpcDsKPiArICAgICAgIHN0cnVjdCBwc2JfZnByaXYgKnByaXY7Cj4gKyAgICAgICBzdHJ1
Y3QgcHNiX2ZiZGV2ICpmYmRldiA9IE5VTEw7Cj4gKyAgICAgICB1bnNpZ25lZCBsb25nIGZsYWdz
Owo+ICsgICAgICAgdTMyIHRnaWQgPSBwc2JfZ2V0X3RnaWQoKTsKPiArICAgICAgIGludCByZXQ7
Cj4gKyAgICAgICBpbnQgcGlwZSA9IHRvX3BzYl9pbnRlbF9jcnRjKGNydGMpLT5waXBlOwo+ICsg
ICAgICAgaW50IGk7Cj4gKwo+ICsgICAgICAgaWYgKCFwc2JmYi0+cHZyQk8pCj4gKyAgICAgICAg
ICAgICAgIHJldHVybiAtRUlOVkFMOwo+ICsKPiArICAgICAgIG5ld19wZW5kaW5nX2ZsaXAgPSBr
emFsbG9jKHNpemVvZiAqbmV3X3BlbmRpbmdfZmxpcCwgR0ZQX0tFUk5FTCk7Cj4gKyAgICAgICBp
ZiAoIW5ld19wZW5kaW5nX2ZsaXApCj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwo+
ICsKPiArICAgICAgIC8qIGtlZXAgYSByZWZlcmVuY2UgdG8gdGhlIG5ldyBmYiwgdW50aWwgaXQn
cyBubyBsb25nZXIgc2Nhbm5lZCBvdXQuICovCj4gKyAgICAgICByZXQgPSBwc2JfZmJfZ3R0X3Jl
ZihkZXYsIHBzYmZiLT5wdnJCTyk7Cj4gKyAgICAgICBpZiAocmV0KSB7Cj4gKyAgICAgICAgICAg
ICAgIGtmcmVlKG5ld19wZW5kaW5nX2ZsaXApOwo+ICsgICAgICAgICAgICAgICByZXR1cm4gcmV0
Owo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGN1cnJlbnRfZmJfbWVtX2luZm8gPSB0b19wc2Jf
ZmIoY3J0Yy0+ZmIpLT5wdnJCTzsKPiArCj4gKyAgICAgICAvKiBrZWVwIGEgcmVmZXJlbmNlIHRv
IHRoZSBvbGQgZmIsIGZvciByZWFkIG9wcyBtYW5pcHVsYXRpb25zICovCj4gKyAgICAgICByZXQg
PSBwc2JfZmJfcmVmKGN1cnJlbnRfZmJfbWVtX2luZm8pOwo+ICsgICAgICAgaWYgKHJldCkgewo+
ICsgICAgICAgICAgICAgICBwc2JfZmJfZ3R0X3VucmVmKGRldiwgcHNiZmItPnB2ckJPLCB0Z2lk
KTsKPiArICAgICAgICAgICAgICAga2ZyZWUobmV3X3BlbmRpbmdfZmxpcCk7Cj4gKyAgICAgICAg
ICAgICAgIHJldHVybiByZXQ7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgZHJtX2ZsaXBfaW5p
dCgmbmV3X3BlbmRpbmdfZmxpcC0+YmFzZSwgJnRvX3BzYl9pbnRlbF9jcnRjKGNydGMpLT5mbGlw
X2hlbHBlcik7Cj4gKwo+ICsgICAgICAgYXRvbWljX3NldCgmbmV3X3BlbmRpbmdfZmxpcC0+cmVm
Y250LCAxKTsKPiArICAgICAgIG5ld19wZW5kaW5nX2ZsaXAtPmNydGMgPSBjcnRjOwo+ICsgICAg
ICAgbmV3X3BlbmRpbmdfZmxpcC0+ZXZlbnQgPSBldmVudDsKPiArICAgICAgIG5ld19wZW5kaW5n
X2ZsaXAtPm9mZnNldCA9IHBzYmZiLT5vZmZzZXQ7Cj4gKwo+ICsgICAgICAgaWYgKGV2ZW50KSB7
Cj4gKyAgICAgICAgICAgICAgIHNwaW5fbG9ja19pcnFzYXZlKCZjcnRjLT5kZXYtPmV2ZW50X2xv
Y2ssIGZsYWdzKTsKPiArICAgICAgICAgICAgICAgcHJpdiA9IHBzYl9mcHJpdihldmVudC0+YmFz
ZS5maWxlX3ByaXYpOwo+ICsgICAgICAgICAgICAgICBsaXN0X2FkZCgmbmV3X3BlbmRpbmdfZmxp
cC0+dW5jb21wbGV0ZWQsICZwcml2LT5wZW5kaW5nX2ZsaXBzKTsKPiArICAgICAgICAgICAgICAg
c3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmY3J0Yy0+ZGV2LT5ldmVudF9sb2NrLCBmbGFncyk7Cj4g
KyAgICAgICB9IGVsc2Ugewo+ICsgICAgICAgICAgICAgICBJTklUX0xJU1RfSEVBRCgmbmV3X3Bl
bmRpbmdfZmxpcC0+dW5jb21wbGV0ZWQpOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIC8qIElu
IHBhZ2UgZmxpcCwgY2hhbmdlIHRoZSBwc2JfZmJfaGVscGVyLmZiCj4gKyAgICAgICAgKiBhbmQg
ZmJkZXYgdG8gdGhlIHN3YXBwZWQgZmIuCj4gKyAgICAgICAgKi8KPiArICAgICAgIGlmIChkZXYt
PmRldl9wcml2YXRlKQo+ICsgICAgICAgICAgICAgICBmYmRldiA9ICgoc3RydWN0IGRybV9wc2Jf
cHJpdmF0ZSAqKWRldi0+ZGV2X3ByaXZhdGUpLT5mYmRldjsKPiArICAgICAgIGlmIChmYmRldikg
ewo+ICsgICAgICAgICAgICAgICBmYmRldi0+cHNiX2ZiX2hlbHBlci5mYiA9IGZiOwo+ICsgICAg
ICAgICAgICAgICBmYmRldi0+cHNiX2ZiX2hlbHBlci5mYmRldiA9IHBzYmZiLT5mYmRldjsKPiAr
ICAgICAgIH0gZWxzZQo+ICsgICAgICAgICAgICAgICBwcmludGsoS0VSTl9BTEVSVCAiJXMgY2Fu
bm90IGZpbmQgdGhlIGZiXG4iLCBfX2Z1bmNfXyk7Cj4gKwo+ICsgICAgICAgY3J0Yy0+ZmIgPSBm
YjsKPiArCj4gKyAgICAgICBuZXdfcGVuZGluZ19mbGlwLT5tZW1faW5mbyA9IHBzYmZiLT5wdnJC
TzsKPiArICAgICAgIG5ld19wZW5kaW5nX2ZsaXAtPm9sZF9tZW1faW5mbyA9IGN1cnJlbnRfZmJf
bWVtX2luZm87Cj4gKwo+ICsgICAgICAgcHNiX2ZiX2luY3JlYXNlX3JlYWRfb3BzX3BlbmRpbmco
Y3VycmVudF9mYl9tZW1faW5mbywKPiArICAgICAgICAgICAgICAgICAgICAgICAmbmV3X3BlbmRp
bmdfZmxpcC0+cGVuZGluZ192YWx1ZXMpOwo+ICsgICAgICAgcHNiX2ZiX2ZsaXBfdHJhY2UoY3Vy
cmVudF9mYl9tZW1faW5mbywgcHNiZmItPnB2ckJPKTsKPiArCj4gKyAgICAgICBuZXdfcGVuZGlu
Z19mbGlwLT50Z2lkID0gdGdpZDsKPiArCj4gKyAgICAgICBJTklUX0xJU1RfSEVBRCgmbmV3X3Bl
bmRpbmdfZmxpcC0+Y29tcGFuaW9ucyk7Cj4gKwo+ICsgICAgICAgZm9yIChpID0gMDsgaSA8IEFS
UkFZX1NJWkUoZGV2X3ByaXYtPm92ZXJsYXlzKTsgaSsrKSB7Cj4gKyAgICAgICAgICAgICAgIHN0
cnVjdCBkcm1fZmxpcCAqZmxpcDsKPiArCj4gKyAgICAgICAgICAgICAgIGlmICghZGV2X3ByaXYt
Pm92ZXJsYXlzW2ldKQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwo+ICsKPiAr
ICAgICAgICAgICAgICAgZmxpcCA9IG1kZmxkX292ZXJsYXlfYXRvbWljX2ZsaXAoZGV2X3ByaXYt
Pm92ZXJsYXlzW2ldLCBwaXBlKTsKPiArICAgICAgICAgICAgICAgaWYgKCFmbGlwKQo+ICsgICAg
ICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwo+ICsKPiArICAgICAgICAgICAgICAgbGlzdF9h
ZGRfdGFpbCgmZmxpcC0+bGlzdCwgJm5ld19wZW5kaW5nX2ZsaXAtPmNvbXBhbmlvbnMpOwo+ICsg
ICAgICAgfQo+ICsKPiArICAgICAgIFBWUlNSVkNhbGxiYWNrT25TeW5jKHBzYmZiLT5wdnJCTy0+
cHNLZXJuZWxTeW5jSW5mbywKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBWUlNSVl9T
WU5DX1dSSVRFLCBzeW5jX2NhbGxiYWNrLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Jm5ld19wZW5kaW5nX2ZsaXAtPnBlbmRpbmdfc3luYyk7Cj4gKwo+ICsgICAgICAgcmV0dXJuIDA7
Cj4gK30KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2dtYTUwMC9wc2JfcGFnZV9mbGlw
LmggYi9kcml2ZXJzL2dwdS9kcm0vZ21hNTAwL3BzYl9wYWdlX2ZsaXAuaAo+IG5ldyBmaWxlIG1v
ZGUgMTAwNjQ0Cj4gaW5kZXggMDAwMDAwMDAwMDAwLi42MDY3MTIwMWQyYzgKPiAtLS0gL2Rldi9u
dWxsCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2dtYTUwMC9wc2JfcGFnZV9mbGlwLmgKPiBAQCAt
MCwwICsxLDM4IEBACj4gKy8qCj4gKyAqIENvcHlyaWdodCAoYykgMjAxMSwgSW50ZWwgQ29ycG9y
YXRpb24uCj4gKyAqCj4gKyAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2Fu
IHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5IGl0Cj4gKyAqIHVuZGVyIHRoZSB0ZXJtcyBh
bmQgY29uZGl0aW9ucyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UsCj4gKyAqIHZl
cnNpb24gMiwgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24uCj4g
KyAqCj4gKyAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSBpdCB3aWxs
IGJlIHVzZWZ1bCwgYnV0IFdJVEhPVVQKPiArICogQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4g
dGhlIGltcGxpZWQgd2FycmFudHkgb2YgTUVSQ0hBTlRBQklMSVRZIG9yCj4gKyAqIEZJVE5FU1Mg
Rk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGlj
ZW5zZSBmb3IKPiArICogbW9yZSBkZXRhaWxzLgo+ICsgKgo+ICsgKiBZb3Ugc2hvdWxkIGhhdmUg
cmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhbG9uZyB3
aXRoCj4gKyAqIHRoaXMgcHJvZ3JhbTsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2Fy
ZSBGb3VuZGF0aW9uLCBJbmMuLMK3Cj4gKyAqIDUxIEZyYW5rbGluIFN0IC0gRmlmdGggRmxvb3Is
IEJvc3RvbiwgTUEgMDIxMTAtMTMwMSBVU0EuCj4gKyAqCj4gKyAqIEF1dGhvcnM6Cj4gKyAqIEFu
ZGVyIENvbnNlbHZhbiBkZSBPbGl2ZWlyYSA8YW5kZXIuY29uc2VsdmFuLmRlLm9saXZlaXJhQGlu
dGVsLmNvbT4KPiArICoKPiArICovCj4gKwo+ICsjaWZuZGVmIF9QU0JfUEFHRV9GTElQX0hfCj4g
KyNkZWZpbmUgX1BTQl9QQUdFX0ZMSVBfSF8KPiArCj4gK3ZvaWQgcHNiX3BhZ2VfZmxpcF9pbml0
KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpOwo+ICt2b2lkIHBzYl9wYWdlX2ZsaXBfZmluaShzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2KTsKPiArCj4gK3ZvaWQgcHNiX3BhZ2VfZmxpcF9jcnRjX2luaXQo
c3RydWN0IHBzYl9pbnRlbF9jcnRjICpwc2JfaW50ZWxfY3J0Yyk7Cj4gK3ZvaWQgcHNiX3BhZ2Vf
ZmxpcF9jcnRjX2Zpbmkoc3RydWN0IHBzYl9pbnRlbF9jcnRjICpwc2JfaW50ZWxfY3J0Yyk7Cj4g
Kwo+ICt2b2lkIHBzYl9pbnRlbF9jcnRjX3Byb2Nlc3NfdmJsYW5rKHN0cnVjdCBkcm1fY3J0YyAq
Y3J0Yyk7Cj4gK2ludCBwc2JfaW50ZWxfY3J0Y19wYWdlX2ZsaXAoc3RydWN0IGRybV9jcnRjICpj
cnRjLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBkcm1fZnJhbWVidWZm
ZXIgKmZiLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBkcm1fcGVuZGlu
Z192YmxhbmtfZXZlbnQgKmV2ZW50KTsKPiArdm9pZCBwc2JfY2xlYW51cF9wZW5kaW5nX2V2ZW50
cyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgc3RydWN0IHBzYl9mcHJpdiAqcHJpdik7Cj4gKwo+ICsjZW5kaWYgLyogX1BTQl9QQUdFX0ZM
SVBfSF8gKi8KPiAtLQo+IDIuMjAuMQo+Cj4gX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KPiBkcmktZGV2ZWwgbWFpbGluZyBsaXN0Cj4gZHJpLWRldmVsQGxp
c3RzLmZyZWVkZXNrdG9wLm9yZwo+IGh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxt
YW4vbGlzdGluZm8vZHJpLWRldmVsCgoKCi0tIApEYW5pZWwgVmV0dGVyClNvZnR3YXJlIEVuZ2lu
ZWVyLCBJbnRlbCBDb3Jwb3JhdGlvbgorNDEgKDApIDc5IDM2NSA1NyA0OCAtIGh0dHA6Ly9ibG9n
LmZmd2xsLmNoCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
CmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpo
dHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
