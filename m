Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 7118F474F7
	for <lists+dri-devel@lfdr.de>; Sun, 16 Jun 2019 16:02:30 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D9AA2891E7;
	Sun, 16 Jun 2019 14:01:50 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
X-Greylist: delayed 411 seconds by postgrey-1.36 at gabe;
 Fri, 14 Jun 2019 11:57:57 UTC
Received: from inva021.nxp.com (inva021.nxp.com [92.121.34.21])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8568989369
 for <dri-devel@lists.freedesktop.org>; Fri, 14 Jun 2019 11:57:57 +0000 (UTC)
Received: from inva021.nxp.com (localhost [127.0.0.1])
 by inva021.eu-rdc02.nxp.com (Postfix) with ESMTP id C84C3200EA8;
 Fri, 14 Jun 2019 13:51:05 +0200 (CEST)
Received: from inva024.eu-rdc02.nxp.com (inva024.eu-rdc02.nxp.com
 [134.27.226.22])
 by inva021.eu-rdc02.nxp.com (Postfix) with ESMTP id B85F3200E99;
 Fri, 14 Jun 2019 13:51:05 +0200 (CEST)
Received: from fsr-ub1664-046.ea.freescale.net
 (fsr-ub1664-046.ea.freescale.net [10.171.96.34])
 by inva024.eu-rdc02.nxp.com (Postfix) with ESMTP id 9AEB72061D;
 Fri, 14 Jun 2019 13:51:05 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
 by fsr-ub1664-046.ea.freescale.net (Postfix) with ESMTP id 7042455AD;
 Fri, 14 Jun 2019 14:51:05 +0300 (EEST)
Received: from fsr-ub1664-046.ea.freescale.net ([127.0.0.1])
 by localhost (fsr-ub1664-046.ea.freescale.net [127.0.0.1]) (amavisd-new,
 port 10032)
 with ESMTP id 6j9DZ9qOwVzP; Fri, 14 Jun 2019 14:51:04 +0300 (EEST)
Received: from localhost (localhost [127.0.0.1])
 by fsr-ub1664-046.ea.freescale.net (Postfix) with ESMTP id 280BE4D1D;
 Fri, 14 Jun 2019 14:51:04 +0300 (EEST)
X-Virus-Scanned: amavisd-new at ea.freescale.net
Received: from fsr-ub1664-046.ea.freescale.net ([127.0.0.1])
 by localhost (fsr-ub1664-046.ea.freescale.net [127.0.0.1]) (amavisd-new,
 port 10026)
 with ESMTP id RQQ4fzmO4fqf; Fri, 14 Jun 2019 14:51:04 +0300 (EEST)
Received: from fsr-ub1664-120.ea.freescale.net
 (fsr-ub1664-120.ea.freescale.net [10.171.82.81])
 by fsr-ub1664-046.ea.freescale.net (Postfix) with ESMTP id F14A655AE;
 Fri, 14 Jun 2019 14:51:03 +0300 (EEST)
From: Robert Chiras <robert.chiras@nxp.com>
To: Thierry Reding <thierry.reding@gmail.com>, Sam Ravnborg <sam@ravnborg.org>,
 David Airlie <airlied@linux.ie>, Daniel Vetter <daniel@ffwll.ch>,
 Rob Herring <robh+dt@kernel.org>, Mark Rutland <mark.rutland@arm.com>
Subject: [PATCH 2/2] drm/panel: Add support for Raydium RM67191 panel driver
Date: Fri, 14 Jun 2019 14:51:03 +0300
Message-Id: <1560513063-24995-3-git-send-email-robert.chiras@nxp.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1560513063-24995-1-git-send-email-robert.chiras@nxp.com>
References: <1560513063-24995-1-git-send-email-robert.chiras@nxp.com>
MIME-Version: 1.0
X-Virus-Scanned: ClamAV using ClamSMTP
X-Mailman-Approved-At: Sun, 16 Jun 2019 14:01:48 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Robert Chiras <robert.chiras@nxp.com>, devicetree@vger.kernel.org,
 linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org,
 linux-imx@nxp.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBwYXRjaCBhZGRzIFJheWRpdW0gUk02NzE5MSBURlQgTENEIHBhbmVsIGRyaXZlciAoTUlQ
SS1EU0kKcHJvdG9jb2wpLgoKU2lnbmVkLW9mZi1ieTogUm9iZXJ0IENoaXJhcyA8cm9iZXJ0LmNo
aXJhc0BueHAuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9wYW5lbC9LY29uZmlnICAgICAgICAg
ICAgICAgICB8ICAgOSArCiBkcml2ZXJzL2dwdS9kcm0vcGFuZWwvTWFrZWZpbGUgICAgICAgICAg
ICAgICAgfCAgIDEgKwogZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLXJheWRpdW0tcm02NzE5
MS5jIHwgNzMwICsrKysrKysrKysrKysrKysrKysrKysrKysrCiAzIGZpbGVzIGNoYW5nZWQsIDc0
MCBpbnNlcnRpb25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL3BhbmVs
L3BhbmVsLXJheWRpdW0tcm02NzE5MS5jCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Bh
bmVsL0tjb25maWcgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvS2NvbmZpZwppbmRleCBkOWQ5MzFh
Li44YmUxYWMxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvS2NvbmZpZworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvS2NvbmZpZwpAQCAtMTU5LDYgKzE1OSwxNSBAQCBjb25m
aWcgRFJNX1BBTkVMX1JBU1BCRVJSWVBJX1RPVUNIU0NSRUVOCiAJICBQaSA3IiBUb3VjaHNjcmVl
bi4gIFRvIGNvbXBpbGUgdGhpcyBkcml2ZXIgYXMgYSBtb2R1bGUsCiAJICBjaG9vc2UgTSBoZXJl
LgogCitjb25maWcgRFJNX1BBTkVMX1JBWURJVU1fUk02NzE5MQorCXRyaXN0YXRlICJSYXlkaXVt
IFJNNjcxOTEgRkhEIDEwODB4MTkyMCBEU0kgdmlkZW8gbW9kZSBwYW5lbCIKKwlkZXBlbmRzIG9u
IE9GCisJZGVwZW5kcyBvbiBEUk1fTUlQSV9EU0kKKwlkZXBlbmRzIG9uIEJBQ0tMSUdIVF9DTEFT
U19ERVZJQ0UKKwloZWxwCisJICBTYXkgWSBoZXJlIGlmIHlvdSB3YW50IHRvIGVuYWJsZSBzdXBw
b3J0IGZvciBSYXlkaXVtIFJNNjcxOTEgRkhECisJICAoMTA4MHgxOTIwKSBEU0kgcGFuZWwuCisK
IGNvbmZpZyBEUk1fUEFORUxfUkFZRElVTV9STTY4MjAwCiAJdHJpc3RhdGUgIlJheWRpdW0gUk02
ODIwMCA3MjB4MTI4MCBEU0kgdmlkZW8gbW9kZSBwYW5lbCIKIAlkZXBlbmRzIG9uIE9GCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0v
cGFuZWwvTWFrZWZpbGUKaW5kZXggZmIwY2IzYS4uMWZjMGY2OCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL3BhbmVsL01ha2VmaWxlCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9NYWtl
ZmlsZQpAQCAtMTQsNiArMTQsNyBAQCBvYmotJChDT05GSUdfRFJNX1BBTkVMX09SSVNFVEVDSF9P
VE04MDA5QSkgKz0gcGFuZWwtb3Jpc2V0ZWNoLW90bTgwMDlhLm8KIG9iai0kKENPTkZJR19EUk1f
UEFORUxfT1NEX09TRDEwMVQyNTg3XzUzVFMpICs9IHBhbmVsLW9zZC1vc2QxMDF0MjU4Ny01M3Rz
Lm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfUEFOQVNPTklDX1ZWWDEwRjAzNE4wMCkgKz0gcGFu
ZWwtcGFuYXNvbmljLXZ2eDEwZjAzNG4wMC5vCiBvYmotJChDT05GSUdfRFJNX1BBTkVMX1JBU1BC
RVJSWVBJX1RPVUNIU0NSRUVOKSArPSBwYW5lbC1yYXNwYmVycnlwaS10b3VjaHNjcmVlbi5vCitv
YmotJChDT05GSUdfRFJNX1BBTkVMX1JBWURJVU1fUk02NzE5MSkgKz0gcGFuZWwtcmF5ZGl1bS1y
bTY3MTkxLm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfUkFZRElVTV9STTY4MjAwKSArPSBwYW5l
bC1yYXlkaXVtLXJtNjgyMDAubwogb2JqLSQoQ09ORklHX0RSTV9QQU5FTF9ST0NLVEVDSF9KSDA1
N04wMDkwMCkgKz0gcGFuZWwtcm9ja3RlY2gtamgwNTduMDA5MDAubwogb2JqLSQoQ09ORklHX0RS
TV9QQU5FTF9ST05CT19SQjA3MEQzMCkgKz0gcGFuZWwtcm9uYm8tcmIwNzBkMzAubwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLXJheWRpdW0tcm02NzE5MS5jIGIvZHJp
dmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLXJheWRpdW0tcm02NzE5MS5jCm5ldyBmaWxlIG1vZGUg
MTAwNjQ0CmluZGV4IDAwMDAwMDAuLjc1YmZiMDMKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJz
L2dwdS9kcm0vcGFuZWwvcGFuZWwtcmF5ZGl1bS1ybTY3MTkxLmMKQEAgLTAsMCArMSw3MzAgQEAK
Ky8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisvKgorICogaS5NWCBkcm0gZHJp
dmVyIC0gUmF5ZGl1bSBNSVBJLURTSSBwYW5lbCBkcml2ZXIKKyAqCisgKiBDb3B5cmlnaHQgKEMp
IDIwMTcgTlhQCisgKgorICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4g
cmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICogbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0
aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKKyAqIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJl
ZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyCisgKiBvZiB0aGUgTGljZW5z
ZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KKyAqIFRoaXMgcHJvZ3Jh
bSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICog
YnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFu
dHkgb2YKKyAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVS
UE9TRS4gIFNlZSB0aGUKKyAqIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRl
dGFpbHMuCisgKi8KKworI2luY2x1ZGUgPGRybS9kcm1QLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9j
cnRjLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9taXBpX2RzaS5oPgorI2luY2x1ZGUgPGRybS9kcm1f
cGFuZWwuaD4KKyNpbmNsdWRlIDxsaW51eC9ncGlvL2NvbnN1bWVyLmg+CisjaW5jbHVkZSA8bGlu
dXgvbW9kdWxlLmg+CisjaW5jbHVkZSA8bGludXgvb2YuaD4KKyNpbmNsdWRlIDxsaW51eC9yZWd1
bGF0b3IvY29uc3VtZXIuaD4KKyNpbmNsdWRlIDx2aWRlby9taXBpX2Rpc3BsYXkuaD4KKyNpbmNs
dWRlIDx2aWRlby9vZl92aWRlb21vZGUuaD4KKyNpbmNsdWRlIDx2aWRlby92aWRlb21vZGUuaD4K
KworLyogV3JpdGUgTWFudWZhY3R1cmUgQ29tbWFuZCBTZXQgQ29udHJvbCAqLworI2RlZmluZSBX
Uk1BVUNDVFIgMHhGRQorCisvKiBNYW51ZmFjdHVyZXIgQ29tbWFuZCBTZXQgcGFnZXMgKENNRDIp
ICovCitzdHJ1Y3QgY21kX3NldF9lbnRyeSB7CisJdTggY21kOworCXU4IHBhcmFtOworfTsKKwor
LyoKKyAqIFRoZXJlIGlzIG5vIGRlc2NyaXB0aW9uIGluIHRoZSBSZWZlcmVuY2UgTWFudWFsIGFi
b3V0IHRoZXNlIGNvbW1hbmRzLgorICogV2UgcmVjZWl2ZWQgdGhlbSBmcm9tIHZlbmRvciwgc28g
anVzdCB1c2UgdGhlbSBhcyBpcy4KKyAqLworc3RhdGljIGNvbnN0IHN0cnVjdCBjbWRfc2V0X2Vu
dHJ5IG1hbnVmYWN0dXJlcl9jbWRfc2V0W10gPSB7CisJezB4RkUsIDB4MEJ9LAorCXsweDI4LCAw
eDQwfSwKKwl7MHgyOSwgMHg0Rn0sCisJezB4RkUsIDB4MEV9LAorCXsweDRCLCAweDAwfSwKKwl7
MHg0QywgMHgwRn0sCisJezB4NEQsIDB4MjB9LAorCXsweDRFLCAweDQwfSwKKwl7MHg0RiwgMHg2
MH0sCisJezB4NTAsIDB4QTB9LAorCXsweDUxLCAweEMwfSwKKwl7MHg1MiwgMHhFMH0sCisJezB4
NTMsIDB4RkZ9LAorCXsweEZFLCAweDBEfSwKKwl7MHgxOCwgMHgwOH0sCisJezB4NDIsIDB4MDB9
LAorCXsweDA4LCAweDQxfSwKKwl7MHg0NiwgMHgwMn0sCisJezB4NzIsIDB4MDl9LAorCXsweEZF
LCAweDBBfSwKKwl7MHgyNCwgMHgxN30sCisJezB4MDQsIDB4MDd9LAorCXsweDFBLCAweDBDfSwK
Kwl7MHgwRiwgMHg0NH0sCisJezB4RkUsIDB4MDR9LAorCXsweDAwLCAweDBDfSwKKwl7MHgwNSwg
MHgwOH0sCisJezB4MDYsIDB4MDh9LAorCXsweDA4LCAweDA4fSwKKwl7MHgwOSwgMHgwOH0sCisJ
ezB4MEEsIDB4RTZ9LAorCXsweDBCLCAweDhDfSwKKwl7MHgxQSwgMHgxMn0sCisJezB4MUUsIDB4
RTB9LAorCXsweDI5LCAweDkzfSwKKwl7MHgyQSwgMHg5M30sCisJezB4MkYsIDB4MDJ9LAorCXsw
eDMxLCAweDAyfSwKKwl7MHgzMywgMHgwNX0sCisJezB4MzcsIDB4MkR9LAorCXsweDM4LCAweDJE
fSwKKwl7MHgzQSwgMHgxRX0sCisJezB4M0IsIDB4MUV9LAorCXsweDNELCAweDI3fSwKKwl7MHgz
RiwgMHg4MH0sCisJezB4NDAsIDB4NDB9LAorCXsweDQxLCAweEUwfSwKKwl7MHg0RiwgMHgyRn0s
CisJezB4NTAsIDB4MUV9LAorCXsweEZFLCAweDA2fSwKKwl7MHgwMCwgMHhDQ30sCisJezB4MDUs
IDB4MDV9LAorCXsweDA3LCAweEEyfSwKKwl7MHgwOCwgMHhDQ30sCisJezB4MEQsIDB4MDN9LAor
CXsweDBGLCAweEEyfSwKKwl7MHgzMiwgMHhDQ30sCisJezB4MzcsIDB4MDV9LAorCXsweDM5LCAw
eDgzfSwKKwl7MHgzQSwgMHhDQ30sCisJezB4NDEsIDB4MDR9LAorCXsweDQzLCAweDgzfSwKKwl7
MHg0NCwgMHhDQ30sCisJezB4NDksIDB4MDV9LAorCXsweDRCLCAweEEyfSwKKwl7MHg0QywgMHhD
Q30sCisJezB4NTEsIDB4MDN9LAorCXsweDUzLCAweEEyfSwKKwl7MHg3NSwgMHhDQ30sCisJezB4
N0EsIDB4MDN9LAorCXsweDdDLCAweDgzfSwKKwl7MHg3RCwgMHhDQ30sCisJezB4ODIsIDB4MDJ9
LAorCXsweDg0LCAweDgzfSwKKwl7MHg4NSwgMHhFQ30sCisJezB4ODYsIDB4MEZ9LAorCXsweDg3
LCAweEZGfSwKKwl7MHg4OCwgMHgwMH0sCisJezB4OEEsIDB4MDJ9LAorCXsweDhDLCAweEEyfSwK
Kwl7MHg4RCwgMHhFQX0sCisJezB4OEUsIDB4MDF9LAorCXsweDhGLCAweEU4fSwKKwl7MHhGRSwg
MHgwNn0sCisJezB4OTAsIDB4MEF9LAorCXsweDkyLCAweDA2fSwKKwl7MHg5MywgMHhBMH0sCisJ
ezB4OTQsIDB4QTh9LAorCXsweDk1LCAweEVDfSwKKwl7MHg5NiwgMHgwRn0sCisJezB4OTcsIDB4
RkZ9LAorCXsweDk4LCAweDAwfSwKKwl7MHg5QSwgMHgwMn0sCisJezB4OUMsIDB4QTJ9LAorCXsw
eEFDLCAweDA0fSwKKwl7MHhGRSwgMHgwNn0sCisJezB4QjEsIDB4MTJ9LAorCXsweEIyLCAweDE3
fSwKKwl7MHhCMywgMHgxN30sCisJezB4QjQsIDB4MTd9LAorCXsweEI1LCAweDE3fSwKKwl7MHhC
NiwgMHgxMX0sCisJezB4QjcsIDB4MDh9LAorCXsweEI4LCAweDA5fSwKKwl7MHhCOSwgMHgwNn0s
CisJezB4QkEsIDB4MDd9LAorCXsweEJCLCAweDE3fSwKKwl7MHhCQywgMHgxN30sCisJezB4QkQs
IDB4MTd9LAorCXsweEJFLCAweDE3fSwKKwl7MHhCRiwgMHgxN30sCisJezB4QzAsIDB4MTd9LAor
CXsweEMxLCAweDE3fSwKKwl7MHhDMiwgMHgxN30sCisJezB4QzMsIDB4MTd9LAorCXsweEM0LCAw
eDBGfSwKKwl7MHhDNSwgMHgwRX0sCisJezB4QzYsIDB4MDB9LAorCXsweEM3LCAweDAxfSwKKwl7
MHhDOCwgMHgxMH0sCisJezB4RkUsIDB4MDZ9LAorCXsweDk1LCAweEVDfSwKKwl7MHg4RCwgMHhF
RX0sCisJezB4NDQsIDB4RUN9LAorCXsweDRDLCAweEVDfSwKKwl7MHgzMiwgMHhFQ30sCisJezB4
M0EsIDB4RUN9LAorCXsweDdELCAweEVDfSwKKwl7MHg3NSwgMHhFQ30sCisJezB4MDAsIDB4RUN9
LAorCXsweDA4LCAweEVDfSwKKwl7MHg4NSwgMHhFQ30sCisJezB4QTYsIDB4MjF9LAorCXsweEE3
LCAweDA1fSwKKwl7MHhBOSwgMHgwNn0sCisJezB4ODIsIDB4MDZ9LAorCXsweDQxLCAweDA2fSwK
Kwl7MHg3QSwgMHgwN30sCisJezB4MzcsIDB4MDd9LAorCXsweDA1LCAweDA2fSwKKwl7MHg0OSwg
MHgwNn0sCisJezB4MEQsIDB4MDR9LAorCXsweDUxLCAweDA0fSwKK307CisKK3N0YXRpYyBjb25z
dCB1MzIgcmFkX2J1c19mb3JtYXRzW10gPSB7CisJTUVESUFfQlVTX0ZNVF9SR0I4ODhfMVgyNCwK
KwlNRURJQV9CVVNfRk1UX1JHQjY2Nl8xWDE4LAorCU1FRElBX0JVU19GTVRfUkdCNTY1XzFYMTYs
Cit9OworCitzdHJ1Y3QgcmFkX3BhbmVsIHsKKwlzdHJ1Y3QgZHJtX3BhbmVsIGJhc2U7CisJc3Ry
dWN0IG1pcGlfZHNpX2RldmljZSAqZHNpOworCisJc3RydWN0IGdwaW9fZGVzYyAqcmVzZXQ7CisJ
c3RydWN0IGJhY2tsaWdodF9kZXZpY2UgKmJhY2tsaWdodDsKKworCWJvb2wgcHJlcGFyZWQ7CisJ
Ym9vbCBlbmFibGVkOworCisJc3RydWN0IHZpZGVvbW9kZSB2bTsKKwl1MzIgd2lkdGhfbW07CisJ
dTMyIGhlaWdodF9tbTsKK307CisKK3N0YXRpYyBpbmxpbmUgc3RydWN0IHJhZF9wYW5lbCAqdG9f
cmFkX3BhbmVsKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQoreworCXJldHVybiBjb250YWluZXJf
b2YocGFuZWwsIHN0cnVjdCByYWRfcGFuZWwsIGJhc2UpOworfQorCitzdGF0aWMgaW50IHJhZF9w
YW5lbF9wdXNoX2NtZF9saXN0KHN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSkKK3sKKwlzaXpl
X3QgaTsKKwlzaXplX3QgY291bnQgPSBBUlJBWV9TSVpFKG1hbnVmYWN0dXJlcl9jbWRfc2V0KTsK
KwlpbnQgcmV0ID0gMDsKKworCWZvciAoaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CisJCWNvbnN0
IHN0cnVjdCBjbWRfc2V0X2VudHJ5ICplbnRyeSA9ICZtYW51ZmFjdHVyZXJfY21kX3NldFtpXTsK
KwkJdTggYnVmZmVyWzJdID0geyBlbnRyeS0+Y21kLCBlbnRyeS0+cGFyYW0gfTsKKworCQlyZXQg
PSBtaXBpX2RzaV9nZW5lcmljX3dyaXRlKGRzaSwgJmJ1ZmZlciwgc2l6ZW9mKGJ1ZmZlcikpOwor
CQlpZiAocmV0IDwgMCkKKwkJCXJldHVybiByZXQ7CisJfQorCisJcmV0dXJuIHJldDsKK307CisK
K3N0YXRpYyBpbnQgY29sb3JfZm9ybWF0X2Zyb21fZHNpX2Zvcm1hdChlbnVtIG1pcGlfZHNpX3Bp
eGVsX2Zvcm1hdCBmb3JtYXQpCit7CisJc3dpdGNoIChmb3JtYXQpIHsKKwljYXNlIE1JUElfRFNJ
X0ZNVF9SR0I1NjU6CisJCXJldHVybiAweDU1OworCWNhc2UgTUlQSV9EU0lfRk1UX1JHQjY2NjoK
KwljYXNlIE1JUElfRFNJX0ZNVF9SR0I2NjZfUEFDS0VEOgorCQlyZXR1cm4gMHg2NjsKKwljYXNl
IE1JUElfRFNJX0ZNVF9SR0I4ODg6CisJCXJldHVybiAweDc3OworCWRlZmF1bHQ6CisJCXJldHVy
biAweDc3OyAvKiBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSAqLworCX0KK307CisKK3N0YXRp
YyBpbnQgcmFkX3BhbmVsX3ByZXBhcmUoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwpCit7CisJc3Ry
dWN0IHJhZF9wYW5lbCAqcmFkID0gdG9fcmFkX3BhbmVsKHBhbmVsKTsKKworCWlmIChyYWQtPnBy
ZXBhcmVkKQorCQlyZXR1cm4gMDsKKworCWlmIChyYWQtPnJlc2V0KSB7CisJCWdwaW9kX3NldF92
YWx1ZShyYWQtPnJlc2V0LCAwKTsKKwkJdXNsZWVwX3JhbmdlKDUwMDAsIDEwMDAwKTsKKwkJZ3Bp
b2Rfc2V0X3ZhbHVlKHJhZC0+cmVzZXQsIDEpOworCQl1c2xlZXBfcmFuZ2UoMjAwMDAsIDI1MDAw
KTsKKwl9CisKKwlyYWQtPnByZXBhcmVkID0gdHJ1ZTsKKworCXJldHVybiAwOworfQorCitzdGF0
aWMgaW50IHJhZF9wYW5lbF91bnByZXBhcmUoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwpCit7CisJ
c3RydWN0IHJhZF9wYW5lbCAqcmFkID0gdG9fcmFkX3BhbmVsKHBhbmVsKTsKKwlzdHJ1Y3QgZGV2
aWNlICpkZXYgPSAmcmFkLT5kc2ktPmRldjsKKworCWlmICghcmFkLT5wcmVwYXJlZCkKKwkJcmV0
dXJuIDA7CisKKwlpZiAocmFkLT5lbmFibGVkKSB7CisJCURSTV9ERVZfRVJST1IoZGV2LCAiUGFu
ZWwgc3RpbGwgZW5hYmxlZCFcbiIpOworCQlyZXR1cm4gLUVQRVJNOworCX0KKworCWlmIChyYWQt
PnJlc2V0KSB7CisJCWdwaW9kX3NldF92YWx1ZShyYWQtPnJlc2V0LCAwKTsKKwkJdXNsZWVwX3Jh
bmdlKDE1MDAwLCAxNzAwMCk7CisJCWdwaW9kX3NldF92YWx1ZShyYWQtPnJlc2V0LCAxKTsKKwl9
CisKKwlyYWQtPnByZXBhcmVkID0gZmFsc2U7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGlu
dCByYWRfcGFuZWxfZW5hYmxlKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQoreworCXN0cnVjdCBy
YWRfcGFuZWwgKnJhZCA9IHRvX3JhZF9wYW5lbChwYW5lbCk7CisJc3RydWN0IG1pcGlfZHNpX2Rl
dmljZSAqZHNpID0gcmFkLT5kc2k7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmRzaS0+ZGV2Owor
CWludCBjb2xvcl9mb3JtYXQgPSBjb2xvcl9mb3JtYXRfZnJvbV9kc2lfZm9ybWF0KGRzaS0+Zm9y
bWF0KTsKKwl1MTYgYnJpZ2h0bmVzczsKKwlpbnQgcmV0OworCisJaWYgKHJhZC0+ZW5hYmxlZCkK
KwkJcmV0dXJuIDA7CisKKwlpZiAoIXJhZC0+cHJlcGFyZWQpIHsKKwkJRFJNX0RFVl9FUlJPUihk
ZXYsICJQYW5lbCBub3QgcHJlcGFyZWQhXG4iKTsKKwkJcmV0dXJuIC1FUEVSTTsKKwl9CisKKwlk
c2ktPm1vZGVfZmxhZ3MgfD0gTUlQSV9EU0lfTU9ERV9MUE07CisKKwlyZXQgPSByYWRfcGFuZWxf
cHVzaF9jbWRfbGlzdChkc2kpOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9ERVZfRVJST1IoZGV2
LCAiRmFpbGVkIHRvIHNlbmQgTUNTICglZClcbiIsIHJldCk7CisJCWdvdG8gZmFpbDsKKwl9CisK
KwkvKiBTZWxlY3QgVXNlciBDb21tYW5kIFNldCB0YWJsZSAoQ01EMSkgKi8KKwlyZXQgPSBtaXBp
X2RzaV9nZW5lcmljX3dyaXRlKGRzaSwgKHU4W10peyBXUk1BVUNDVFIsIDB4MDAgfSwgMik7CisJ
aWYgKHJldCA8IDApCisJCWdvdG8gZmFpbDsKKworCS8qIFNvZnR3YXJlIHJlc2V0ICovCisJcmV0
ID0gbWlwaV9kc2lfZGNzX3NvZnRfcmVzZXQoZHNpKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1f
REVWX0VSUk9SKGRldiwgIkZhaWxlZCB0byBkbyBTb2Z0d2FyZSBSZXNldCAoJWQpXG4iLCByZXQp
OworCQlnb3RvIGZhaWw7CisJfQorCisJdXNsZWVwX3JhbmdlKDE1MDAwLCAxNzAwMCk7CisKKwkv
KiBTZXQgRFNJIG1vZGUgKi8KKwlyZXQgPSBtaXBpX2RzaV9nZW5lcmljX3dyaXRlKGRzaSwgKHU4
W10peyAweEMyLCAweDBCIH0sIDIpOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9ERVZfRVJST1Io
ZGV2LCAiRmFpbGVkIHRvIHNldCBEU0kgbW9kZSAoJWQpXG4iLCByZXQpOworCQlnb3RvIGZhaWw7
CisJfQorCS8qIFNldCB0ZWFyIE9OICovCisJcmV0ID0gbWlwaV9kc2lfZGNzX3NldF90ZWFyX29u
KGRzaSwgTUlQSV9EU0lfRENTX1RFQVJfTU9ERV9WQkxBTkspOworCWlmIChyZXQgPCAwKSB7CisJ
CURSTV9ERVZfRVJST1IoZGV2LCAiRmFpbGVkIHRvIHNldCB0ZWFyIE9OICglZClcbiIsIHJldCk7
CisJCWdvdG8gZmFpbDsKKwl9CisJLyogU2V0IHRlYXIgc2NhbmxpbmUgKi8KKwlyZXQgPSBtaXBp
X2RzaV9kY3Nfc2V0X3RlYXJfc2NhbmxpbmUoZHNpLCAweDM4MCk7CisJaWYgKHJldCA8IDApIHsK
KwkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8gc2V0IHRlYXIgc2NhbmxpbmUgKCVkKVxu
IiwgcmV0KTsKKwkJZ290byBmYWlsOworCX0KKwkvKiBTZXQgcGl4ZWwgZm9ybWF0ICovCisJcmV0
ID0gbWlwaV9kc2lfZGNzX3NldF9waXhlbF9mb3JtYXQoZHNpLCBjb2xvcl9mb3JtYXQpOworCURS
TV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIkludGVyZmFjZSBjb2xvciBmb3JtYXQgc2V0IHRvIDB4
JXhcbiIsCisJCQkgICAgIGNvbG9yX2Zvcm1hdCk7CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0RF
Vl9FUlJPUihkZXYsICJGYWlsZWQgdG8gc2V0IHBpeGVsIGZvcm1hdCAoJWQpXG4iLCByZXQpOwor
CQlnb3RvIGZhaWw7CisJfQorCS8qIFNldCBkaXNwbGF5IGJyaWdodG5lc3MgKi8KKwlicmlnaHRu
ZXNzID0gcmFkLT5iYWNrbGlnaHQtPnByb3BzLmJyaWdodG5lc3M7CisJcmV0ID0gbWlwaV9kc2lf
ZGNzX3NldF9kaXNwbGF5X2JyaWdodG5lc3MoZHNpLCBicmlnaHRuZXNzKTsKKwlpZiAocmV0IDwg
MCkgeworCQlEUk1fREVWX0VSUk9SKGRldiwgIkZhaWxlZCB0byBzZXQgZGlzcGxheSBicmlnaHRu
ZXNzICglZClcbiIsCisJCQkgICAgICByZXQpOworCQlnb3RvIGZhaWw7CisJfQorCS8qIEV4aXQg
c2xlZXAgbW9kZSAqLworCXJldCA9IG1pcGlfZHNpX2Rjc19leGl0X3NsZWVwX21vZGUoZHNpKTsK
KwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGRldiwgIkZhaWxlZCB0byBleGl0IHNs
ZWVwIG1vZGUgKCVkKVxuIiwgcmV0KTsKKwkJZ290byBmYWlsOworCX0KKworCXVzbGVlcF9yYW5n
ZSg1MDAwLCAxMDAwMCk7CisKKwlyZXQgPSBtaXBpX2RzaV9kY3Nfc2V0X2Rpc3BsYXlfb24oZHNp
KTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGRldiwgIkZhaWxlZCB0byBzZXQg
ZGlzcGxheSBPTiAoJWQpXG4iLCByZXQpOworCQlnb3RvIGZhaWw7CisJfQorCisJYmFja2xpZ2h0
X2VuYWJsZShyYWQtPmJhY2tsaWdodCk7CisKKwlyYWQtPmVuYWJsZWQgPSB0cnVlOworCisJcmV0
dXJuIDA7CisKK2ZhaWw6CisJaWYgKHJhZC0+cmVzZXQpCisJCWdwaW9kX3NldF92YWx1ZShyYWQt
PnJlc2V0LCAwKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgcmFkX3BhbmVsX2Rp
c2FibGUoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwpCit7CisJc3RydWN0IHJhZF9wYW5lbCAqcmFk
ID0gdG9fcmFkX3BhbmVsKHBhbmVsKTsKKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kgPSBy
YWQtPmRzaTsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmZHNpLT5kZXY7CisJaW50IHJldDsKKwor
CWlmICghcmFkLT5lbmFibGVkKQorCQlyZXR1cm4gMDsKKworCWRzaS0+bW9kZV9mbGFncyB8PSBN
SVBJX0RTSV9NT0RFX0xQTTsKKworCWJhY2tsaWdodF9kaXNhYmxlKHJhZC0+YmFja2xpZ2h0KTsK
KworCXVzbGVlcF9yYW5nZSgxMDAwMCwgMTUwMDApOworCisJcmV0ID0gbWlwaV9kc2lfZGNzX3Nl
dF9kaXNwbGF5X29mZihkc2kpOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9ERVZfRVJST1IoZGV2
LCAiRmFpbGVkIHRvIHNldCBkaXNwbGF5IE9GRiAoJWQpXG4iLCByZXQpOworCQlyZXR1cm4gcmV0
OworCX0KKworCXVzbGVlcF9yYW5nZSg1MDAwLCAxMDAwMCk7CisKKwlyZXQgPSBtaXBpX2RzaV9k
Y3NfZW50ZXJfc2xlZXBfbW9kZShkc2kpOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9ERVZfRVJS
T1IoZGV2LCAiRmFpbGVkIHRvIGVudGVyIHNsZWVwIG1vZGUgKCVkKVxuIiwgcmV0KTsKKwkJcmV0
dXJuIHJldDsKKwl9CisKKwlyYWQtPmVuYWJsZWQgPSBmYWxzZTsKKworCXJldHVybiAwOworfQor
CitzdGF0aWMgaW50IHJhZF9wYW5lbF9nZXRfbW9kZXMoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwp
Cit7CisJc3RydWN0IHJhZF9wYW5lbCAqcmFkID0gdG9fcmFkX3BhbmVsKHBhbmVsKTsKKwlzdHJ1
Y3QgZGV2aWNlICpkZXYgPSAmcmFkLT5kc2ktPmRldjsKKwlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAq
Y29ubmVjdG9yID0gcGFuZWwtPmNvbm5lY3RvcjsKKwlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAq
bW9kZTsKKwl1MzIgKmJ1c19mbGFncyA9ICZjb25uZWN0b3ItPmRpc3BsYXlfaW5mby5idXNfZmxh
Z3M7CisJaW50IHJldDsKKworCW1vZGUgPSBkcm1fbW9kZV9jcmVhdGUoY29ubmVjdG9yLT5kZXYp
OworCWlmICghbW9kZSkgeworCQlEUk1fREVWX0VSUk9SKGRldiwgIkZhaWxlZCB0byBjcmVhdGUg
ZGlzcGxheSBtb2RlIVxuIik7CisJCXJldHVybiAwOworCX0KKworCWRybV9kaXNwbGF5X21vZGVf
ZnJvbV92aWRlb21vZGUoJnJhZC0+dm0sIG1vZGUpOworCW1vZGUtPndpZHRoX21tID0gcmFkLT53
aWR0aF9tbTsKKwltb2RlLT5oZWlnaHRfbW0gPSByYWQtPmhlaWdodF9tbTsKKwljb25uZWN0b3It
PmRpc3BsYXlfaW5mby53aWR0aF9tbSA9IHJhZC0+d2lkdGhfbW07CisJY29ubmVjdG9yLT5kaXNw
bGF5X2luZm8uaGVpZ2h0X21tID0gcmFkLT5oZWlnaHRfbW07CisJbW9kZS0+dHlwZSA9IERSTV9N
T0RFX1RZUEVfRFJJVkVSIHwgRFJNX01PREVfVFlQRV9QUkVGRVJSRUQ7CisKKwlpZiAocmFkLT52
bS5mbGFncyAmIERJU1BMQVlfRkxBR1NfREVfSElHSCkKKwkJKmJ1c19mbGFncyB8PSBEUk1fQlVT
X0ZMQUdfREVfSElHSDsKKwlpZiAocmFkLT52bS5mbGFncyAmIERJU1BMQVlfRkxBR1NfREVfTE9X
KQorCQkqYnVzX2ZsYWdzIHw9IERSTV9CVVNfRkxBR19ERV9MT1c7CisJaWYgKHJhZC0+dm0uZmxh
Z3MgJiBESVNQTEFZX0ZMQUdTX1BJWERBVEFfTkVHRURHRSkKKwkJKmJ1c19mbGFncyB8PSBEUk1f
QlVTX0ZMQUdfUElYREFUQV9ORUdFREdFOworCWlmIChyYWQtPnZtLmZsYWdzICYgRElTUExBWV9G
TEFHU19QSVhEQVRBX1BPU0VER0UpCisJCSpidXNfZmxhZ3MgfD0gRFJNX0JVU19GTEFHX1BJWERB
VEFfUE9TRURHRTsKKworCXJldCA9IGRybV9kaXNwbGF5X2luZm9fc2V0X2J1c19mb3JtYXRzKCZj
b25uZWN0b3ItPmRpc3BsYXlfaW5mbywKKwkJCQkJICAgICAgIHJhZF9idXNfZm9ybWF0cywKKwkJ
CQkJICAgICAgIEFSUkFZX1NJWkUocmFkX2J1c19mb3JtYXRzKSk7CisJaWYgKHJldCkKKwkJcmV0
dXJuIHJldDsKKworCWRybV9tb2RlX3Byb2JlZF9hZGQocGFuZWwtPmNvbm5lY3RvciwgbW9kZSk7
CisKKwlyZXR1cm4gMTsKK30KKworc3RhdGljIGludCByYWRfYmxfZ2V0X2JyaWdodG5lc3Moc3Ry
dWN0IGJhY2tsaWdodF9kZXZpY2UgKmJsKQoreworCXN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRz
aSA9IGJsX2dldF9kYXRhKGJsKTsKKwlzdHJ1Y3QgcmFkX3BhbmVsICpyYWQgPSBtaXBpX2RzaV9n
ZXRfZHJ2ZGF0YShkc2kpOworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZkc2ktPmRldjsKKwl1MTYg
YnJpZ2h0bmVzczsKKwlpbnQgcmV0OworCisJaWYgKCFyYWQtPnByZXBhcmVkKQorCQlyZXR1cm4g
MDsKKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIlxuIik7CisKKwlkc2ktPm1vZGVfZmxh
Z3MgJj0gfk1JUElfRFNJX01PREVfTFBNOworCisJcmV0ID0gbWlwaV9kc2lfZGNzX2dldF9kaXNw
bGF5X2JyaWdodG5lc3MoZHNpLCAmYnJpZ2h0bmVzcyk7CisJaWYgKHJldCA8IDApCisJCXJldHVy
biByZXQ7CisKKwlibC0+cHJvcHMuYnJpZ2h0bmVzcyA9IGJyaWdodG5lc3M7CisKKwlyZXR1cm4g
YnJpZ2h0bmVzcyAmIDB4ZmY7Cit9CisKK3N0YXRpYyBpbnQgcmFkX2JsX3VwZGF0ZV9zdGF0dXMo
c3RydWN0IGJhY2tsaWdodF9kZXZpY2UgKmJsKQoreworCXN0cnVjdCBtaXBpX2RzaV9kZXZpY2Ug
KmRzaSA9IGJsX2dldF9kYXRhKGJsKTsKKwlzdHJ1Y3QgcmFkX3BhbmVsICpyYWQgPSBtaXBpX2Rz
aV9nZXRfZHJ2ZGF0YShkc2kpOworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZkc2ktPmRldjsKKwlp
bnQgcmV0ID0gMDsKKworCWlmICghcmFkLT5wcmVwYXJlZCkKKwkJcmV0dXJuIDA7CisKKwlEUk1f
REVWX0RFQlVHX0RSSVZFUihkZXYsICJOZXcgYnJpZ2h0bmVzczogJWRcbiIsIGJsLT5wcm9wcy5i
cmlnaHRuZXNzKTsKKworCWRzaS0+bW9kZV9mbGFncyAmPSB+TUlQSV9EU0lfTU9ERV9MUE07CisK
KwlyZXQgPSBtaXBpX2RzaV9kY3Nfc2V0X2Rpc3BsYXlfYnJpZ2h0bmVzcyhkc2ksIGJsLT5wcm9w
cy5icmlnaHRuZXNzKTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0dXJuIHJldDsKKworCXJldHVybiAw
OworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGJhY2tsaWdodF9vcHMgcmFkX2JsX29wcyA9IHsK
KwkudXBkYXRlX3N0YXR1cyA9IHJhZF9ibF91cGRhdGVfc3RhdHVzLAorCS5nZXRfYnJpZ2h0bmVz
cyA9IHJhZF9ibF9nZXRfYnJpZ2h0bmVzcywKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJt
X3BhbmVsX2Z1bmNzIHJhZF9wYW5lbF9mdW5jcyA9IHsKKwkucHJlcGFyZSA9IHJhZF9wYW5lbF9w
cmVwYXJlLAorCS51bnByZXBhcmUgPSByYWRfcGFuZWxfdW5wcmVwYXJlLAorCS5lbmFibGUgPSBy
YWRfcGFuZWxfZW5hYmxlLAorCS5kaXNhYmxlID0gcmFkX3BhbmVsX2Rpc2FibGUsCisJLmdldF9t
b2RlcyA9IHJhZF9wYW5lbF9nZXRfbW9kZXMsCit9OworCisvKgorICogVGhlIGNsb2NrIG1pZ2h0
IHJhbmdlIGZyb20gNjZNSHogKDMwSHogcmVmcmVzaCByYXRlKQorICogdG8gMTMyTUh6ICg2MEh6
IHJlZnJlc2ggcmF0ZSkKKyAqLworc3RhdGljIGNvbnN0IHN0cnVjdCBkaXNwbGF5X3RpbWluZyBy
YWRfZGVmYXVsdF90aW1pbmcgPSB7CisJLnBpeGVsY2xvY2sgPSB7IDY2MDAwMDAwLCAxMzIwMDAw
MDAsIDEzMjAwMDAwMCB9LAorCS5oYWN0aXZlID0geyAxMDgwLCAxMDgwLCAxMDgwIH0sCisJLmhm
cm9udF9wb3JjaCA9IHsgMjAsIDIwLCAyMCB9LAorCS5oc3luY19sZW4gPSB7IDIsIDIsIDIgfSwK
KwkuaGJhY2tfcG9yY2ggPSB7IDM0LCAzNCwgMzQgfSwKKwkudmFjdGl2ZSA9IHsgMTkyMCwgMTky
MCwgMTkyMCB9LAorCS52ZnJvbnRfcG9yY2ggPSB7IDEwLCAxMCwgMTAgfSwKKwkudnN5bmNfbGVu
ID0geyAyLCAyLCAyIH0sCisJLnZiYWNrX3BvcmNoID0geyA0LCA0LCA0IH0sCisJLmZsYWdzID0g
RElTUExBWV9GTEFHU19IU1lOQ19MT1cgfAorCQkgRElTUExBWV9GTEFHU19WU1lOQ19MT1cgfAor
CQkgRElTUExBWV9GTEFHU19ERV9MT1cgfAorCQkgRElTUExBWV9GTEFHU19QSVhEQVRBX05FR0VE
R0UsCit9OworCitzdGF0aWMgaW50IHJhZF9wYW5lbF9wcm9iZShzdHJ1Y3QgbWlwaV9kc2lfZGV2
aWNlICpkc2kpCit7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmRzaS0+ZGV2OworCXN0cnVjdCBk
ZXZpY2Vfbm9kZSAqbnAgPSBkZXYtPm9mX25vZGU7CisJc3RydWN0IGRldmljZV9ub2RlICp0aW1p
bmdzOworCXN0cnVjdCByYWRfcGFuZWwgKnBhbmVsOworCXN0cnVjdCBiYWNrbGlnaHRfcHJvcGVy
dGllcyBibF9wcm9wczsKKwlpbnQgcmV0OworCXUzMiB2aWRlb19tb2RlOworCisJcGFuZWwgPSBk
ZXZtX2t6YWxsb2MoJmRzaS0+ZGV2LCBzaXplb2YoKnBhbmVsKSwgR0ZQX0tFUk5FTCk7CisJaWYg
KCFwYW5lbCkKKwkJcmV0dXJuIC1FTk9NRU07CisKKwltaXBpX2RzaV9zZXRfZHJ2ZGF0YShkc2ks
IHBhbmVsKTsKKworCXBhbmVsLT5kc2kgPSBkc2k7CisKKwlkc2ktPmZvcm1hdCA9IE1JUElfRFNJ
X0ZNVF9SR0I4ODg7CisJZHNpLT5tb2RlX2ZsYWdzID0gIE1JUElfRFNJX01PREVfVklERU9fSFNF
IHwgTUlQSV9EU0lfTU9ERV9WSURFTyB8CisJCQkgICBNSVBJX0RTSV9DTE9DS19OT05fQ09OVElO
VU9VUzsKKworCXJldCA9IG9mX3Byb3BlcnR5X3JlYWRfdTMyKG5wLCAidmlkZW8tbW9kZSIsICZ2
aWRlb19tb2RlKTsKKwlpZiAoIXJldCkgeworCQlzd2l0Y2ggKHZpZGVvX21vZGUpIHsKKwkJY2Fz
ZSAwOgorCQkJLyogYnVyc3QgbW9kZSAqLworCQkJZHNpLT5tb2RlX2ZsYWdzIHw9IE1JUElfRFNJ
X01PREVfVklERU9fQlVSU1Q7CisJCQlicmVhazsKKwkJY2FzZSAxOgorCQkJLyogbm9uLWJ1cnN0
IG1vZGUgd2l0aCBzeW5jIGV2ZW50ICovCisJCQlicmVhazsKKwkJY2FzZSAyOgorCQkJLyogbm9u
LWJ1cnN0IG1vZGUgd2l0aCBzeW5jIHB1bHNlICovCisJCQlkc2ktPm1vZGVfZmxhZ3MgfD0gTUlQ
SV9EU0lfTU9ERV9WSURFT19TWU5DX1BVTFNFOworCQkJYnJlYWs7CisJCWRlZmF1bHQ6CisJCQlk
ZXZfd2FybihkZXYsICJpbnZhbGlkIHZpZGVvIG1vZGUgJWRcbiIsIHZpZGVvX21vZGUpOworCQkJ
YnJlYWs7CisJCX0KKwl9CisKKwlyZXQgPSBvZl9wcm9wZXJ0eV9yZWFkX3UzMihucCwgImRzaS1s
YW5lcyIsICZkc2ktPmxhbmVzKTsKKwlpZiAocmV0IDwgMCkgeworCQlkZXZfZXJyKGRldiwgIkZh
aWxlZCB0byBnZXQgZHNpLWxhbmVzIHByb3BlcnR5ICglZClcbiIsIHJldCk7CisJCXJldHVybiBy
ZXQ7CisJfQorCisJLyoKKwkgKiAnZGlzcGxheS10aW1pbmdzJyBpcyBvcHRpb25hbCwgc28gdmVy
aWZ5IGlmIHRoZSBub2RlIGlzIHByZXNlbnQKKwkgKiBiZWZvcmUgY2FsbGluZyBvZl9nZXRfdmlk
ZW9tb2RlIHNvIHdlIHdvbid0IGdldCBjb25zb2xlIGVycm9yCisJICogbWVzc2FnZXMKKwkgKi8K
Kwl0aW1pbmdzID0gb2ZfZ2V0X2NoaWxkX2J5X25hbWUobnAsICJkaXNwbGF5LXRpbWluZ3MiKTsK
KwlpZiAodGltaW5ncykgeworCQlvZl9ub2RlX3B1dCh0aW1pbmdzKTsKKwkJcmV0ID0gb2ZfZ2V0
X3ZpZGVvbW9kZShucCwgJnBhbmVsLT52bSwgMCk7CisJfSBlbHNlIHsKKwkJdmlkZW9tb2RlX2Zy
b21fdGltaW5nKCZyYWRfZGVmYXVsdF90aW1pbmcsICZwYW5lbC0+dm0pOworCX0KKwlpZiAocmV0
IDwgMCkKKwkJcmV0dXJuIHJldDsKKworCW9mX3Byb3BlcnR5X3JlYWRfdTMyKG5wLCAid2lkdGgt
bW0iLCAmcGFuZWwtPndpZHRoX21tKTsKKwlvZl9wcm9wZXJ0eV9yZWFkX3UzMihucCwgImhlaWdo
dC1tbSIsICZwYW5lbC0+aGVpZ2h0X21tKTsKKworCXBhbmVsLT5yZXNldCA9IGRldm1fZ3Bpb2Rf
Z2V0KGRldiwgInJlc2V0IiwgR1BJT0RfT1VUX0hJR0gpOworCisJaWYgKElTX0VSUihwYW5lbC0+
cmVzZXQpKQorCQlwYW5lbC0+cmVzZXQgPSBOVUxMOworCWVsc2UKKwkJZ3Bpb2Rfc2V0X3ZhbHVl
KHBhbmVsLT5yZXNldCwgMCk7CisKKwltZW1zZXQoJmJsX3Byb3BzLCAwLCBzaXplb2YoYmxfcHJv
cHMpKTsKKwlibF9wcm9wcy50eXBlID0gQkFDS0xJR0hUX1JBVzsKKwlibF9wcm9wcy5icmlnaHRu
ZXNzID0gMjU1OworCWJsX3Byb3BzLm1heF9icmlnaHRuZXNzID0gMjU1OworCisJcGFuZWwtPmJh
Y2tsaWdodCA9IGRldm1fYmFja2xpZ2h0X2RldmljZV9yZWdpc3RlcihkZXYsIGRldl9uYW1lKGRl
diksCisJCQkJCQkJICBkZXYsIGRzaSwKKwkJCQkJCQkgICZyYWRfYmxfb3BzLAorCQkJCQkJCSAg
JmJsX3Byb3BzKTsKKwlpZiAoSVNfRVJSKHBhbmVsLT5iYWNrbGlnaHQpKSB7CisJCXJldCA9IFBU
Ul9FUlIocGFuZWwtPmJhY2tsaWdodCk7CisJCWRldl9lcnIoZGV2LCAiRmFpbGVkIHRvIHJlZ2lz
dGVyIGJhY2tsaWdodCAoJWQpXG4iLCByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKworCWRybV9w
YW5lbF9pbml0KCZwYW5lbC0+YmFzZSk7CisJcGFuZWwtPmJhc2UuZnVuY3MgPSAmcmFkX3BhbmVs
X2Z1bmNzOworCXBhbmVsLT5iYXNlLmRldiA9IGRldjsKKwlkZXZfc2V0X2RydmRhdGEoZGV2LCBw
YW5lbCk7CisKKwlyZXQgPSBkcm1fcGFuZWxfYWRkKCZwYW5lbC0+YmFzZSk7CisKKwlpZiAocmV0
IDwgMCkKKwkJcmV0dXJuIHJldDsKKworCXJldCA9IG1pcGlfZHNpX2F0dGFjaChkc2kpOworCWlm
IChyZXQgPCAwKQorCQlkcm1fcGFuZWxfcmVtb3ZlKCZwYW5lbC0+YmFzZSk7CisKKwlyZXR1cm4g
cmV0OworfQorCitzdGF0aWMgaW50IHJhZF9wYW5lbF9yZW1vdmUoc3RydWN0IG1pcGlfZHNpX2Rl
dmljZSAqZHNpKQoreworCXN0cnVjdCByYWRfcGFuZWwgKnJhZCA9IG1pcGlfZHNpX2dldF9kcnZk
YXRhKGRzaSk7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmRzaS0+ZGV2OworCWludCByZXQ7CisK
KwlyZXQgPSBtaXBpX2RzaV9kZXRhY2goZHNpKTsKKwlpZiAocmV0IDwgMCkKKwkJRFJNX0RFVl9F
UlJPUihkZXYsICJGYWlsZWQgdG8gZGV0YWNoIGZyb20gaG9zdCAoJWQpXG4iLAorCQkJICAgICAg
cmV0KTsKKworCWRybV9wYW5lbF9yZW1vdmUoJnJhZC0+YmFzZSk7CisKKwlyZXR1cm4gMDsKK30K
Kworc3RhdGljIHZvaWQgcmFkX3BhbmVsX3NodXRkb3duKHN0cnVjdCBtaXBpX2RzaV9kZXZpY2Ug
KmRzaSkKK3sKKwlzdHJ1Y3QgcmFkX3BhbmVsICpyYWQgPSBtaXBpX2RzaV9nZXRfZHJ2ZGF0YShk
c2kpOworCisJcmFkX3BhbmVsX2Rpc2FibGUoJnJhZC0+YmFzZSk7CisJcmFkX3BhbmVsX3VucHJl
cGFyZSgmcmFkLT5iYXNlKTsKK30KKworI2lmZGVmIENPTkZJR19QTQorc3RhdGljIGludCByYWRf
cGFuZWxfc3VzcGVuZChzdHJ1Y3QgZGV2aWNlICpkZXYpCit7CisJc3RydWN0IHJhZF9wYW5lbCAq
cmFkID0gZGV2X2dldF9kcnZkYXRhKGRldik7CisKKwlpZiAoIXJhZC0+cmVzZXQpCisJCXJldHVy
biAwOworCisJZGV2bV9ncGlvZF9wdXQoZGV2LCByYWQtPnJlc2V0KTsKKwlyYWQtPnJlc2V0ID0g
TlVMTDsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IHJhZF9wYW5lbF9yZXN1bWUoc3Ry
dWN0IGRldmljZSAqZGV2KQoreworCXN0cnVjdCByYWRfcGFuZWwgKnJhZCA9IGRldl9nZXRfZHJ2
ZGF0YShkZXYpOworCisJaWYgKHJhZC0+cmVzZXQpCisJCXJldHVybiAwOworCisJcmFkLT5yZXNl
dCA9IGRldm1fZ3Bpb2RfZ2V0KGRldiwgInJlc2V0IiwgR1BJT0RfT1VUX0hJR0gpOworCWlmIChJ
U19FUlIocmFkLT5yZXNldCkpCisJCXJhZC0+cmVzZXQgPSBOVUxMOworCisJcmV0dXJuIFBUUl9F
UlJfT1JfWkVSTyhyYWQtPnJlc2V0KTsKK30KKworI2VuZGlmCisKK3N0YXRpYyBjb25zdCBzdHJ1
Y3QgZGV2X3BtX29wcyByYWRfcG1fb3BzID0geworCVNFVF9SVU5USU1FX1BNX09QUyhyYWRfcGFu
ZWxfc3VzcGVuZCwgcmFkX3BhbmVsX3Jlc3VtZSwgTlVMTCkKKwlTRVRfU1lTVEVNX1NMRUVQX1BN
X09QUyhyYWRfcGFuZWxfc3VzcGVuZCwgcmFkX3BhbmVsX3Jlc3VtZSkKK307CisKK3N0YXRpYyBj
b25zdCBzdHJ1Y3Qgb2ZfZGV2aWNlX2lkIHJhZF9vZl9tYXRjaFtdID0geworCXsgLmNvbXBhdGli
bGUgPSAicmF5ZGl1bSxybTY3MTkxIiwgfSwKKwl7IH0KK307CitNT0RVTEVfREVWSUNFX1RBQkxF
KG9mLCByYWRfb2ZfbWF0Y2gpOworCitzdGF0aWMgc3RydWN0IG1pcGlfZHNpX2RyaXZlciByYWRf
cGFuZWxfZHJpdmVyID0geworCS5kcml2ZXIgPSB7CisJCS5uYW1lID0gInBhbmVsLXJheWRpdW0t
cm02NzE5MSIsCisJCS5vZl9tYXRjaF90YWJsZSA9IHJhZF9vZl9tYXRjaCwKKwkJLnBtCT0gJnJh
ZF9wbV9vcHMsCisJfSwKKwkucHJvYmUgPSByYWRfcGFuZWxfcHJvYmUsCisJLnJlbW92ZSA9IHJh
ZF9wYW5lbF9yZW1vdmUsCisJLnNodXRkb3duID0gcmFkX3BhbmVsX3NodXRkb3duLAorfTsKK21v
ZHVsZV9taXBpX2RzaV9kcml2ZXIocmFkX3BhbmVsX2RyaXZlcik7CisKK01PRFVMRV9BVVRIT1Io
IlJvYmVydCBDaGlyYXMgPHJvYmVydC5jaGlyYXNAbnhwLmNvbT4iKTsKK01PRFVMRV9ERVNDUklQ
VElPTigiRFJNIERyaXZlciBmb3IgUmF5ZGl1bSBSTTY3MTkxIE1JUEkgRFNJIHBhbmVsIik7CitN
T0RVTEVfTElDRU5TRSgiR1BMIHYyIik7Ci0tIAoyLjcuNAoKX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2
ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21h
aWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
