Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 84D8E10F063
	for <lists+dri-devel@lfdr.de>; Mon,  2 Dec 2019 20:33:52 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 821D86E2F9;
	Mon,  2 Dec 2019 19:33:47 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from bhuna.collabora.co.uk (bhuna.collabora.co.uk
 [IPv6:2a00:1098:0:82:1000:25:2eeb:e3e3])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A1C546E2D7
 for <dri-devel@lists.freedesktop.org>; Mon,  2 Dec 2019 19:33:45 +0000 (UTC)
Received: from [127.0.0.1] (localhost [127.0.0.1])
 (Authenticated sender: aratiu) with ESMTPSA id A5996290484
From: Adrian Ratiu <adrian.ratiu@collabora.com>
To: devicetree@vger.kernel.org, linux-arm-kernel@lists.infradead.org,
 linux-stm32@st-md-mailman.stormreply.com,
 linux-rockchip@lists.infradead.org
Subject: [PATCH v4 3/4] drm: imx: Add i.MX 6 MIPI DSI host driver
Date: Mon,  2 Dec 2019 21:33:58 +0200
Message-Id: <20191202193359.703709-4-adrian.ratiu@collabora.com>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191202193359.703709-1-adrian.ratiu@collabora.com>
References: <20191202193359.703709-1-adrian.ratiu@collabora.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Martyn Welch <martyn.welch@collabora.com>,
 Sjoerd Simons <sjoerd.simons@collabora.com>, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, linux-imx@nxp.com, kernel@collabora.com,
 Emil Velikov <emil.velikov@collabora.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBhZGRzIHN1cHBvcnQgZm9yIHRoZSBTeW5vcHNpcyBEZXNpZ25XYXJlIE1JUEkgRFNJIHYx
LjAxIGhvc3QKY29udHJvbGxlciB3aGljaCBpcyBlbWJlZGRlZCBpbiBpLk1YIDYgU29Dcy4KCkJh
c2VkIG9uIGZvbGxvd2luZyBwYXRjaGVzLCBidXQgdXBkYXRlZC9leHRlbmRlZCB0byB3b3JrIHdp
dGggZXhpc3RpbmcKc3VwcG9ydCBmb3VuZCBpbiB0aGUga2VybmVsOgoKLSBkcm06IGlteDogU3Vw
cG9ydCBTeW5vcHN5cyBEZXNpZ25XYXJlIE1JUEkgRFNJIGhvc3QgY29udHJvbGxlcgogIFNpZ25l
ZC1vZmYtYnk6IExpdSBZaW5nIDxZaW5nLkxpdUBmcmVlc2NhbGUuY29tPgoKLSBBUk06IGR0c2k6
IGlteDZxZGw6IEFkZCBzdXBwb3J0IGZvciBNSVBJIERTSSBob3N0IGNvbnRyb2xsZXIKICBTaWdu
ZWQtb2ZmLWJ5OiBMaXUgWWluZyA8WWluZy5MaXVAZnJlZXNjYWxlLmNvbT4KCkNjOiBGYWJpbyBF
c3RldmFtIDxmZXN0ZXZhbUBnbWFpbC5jb20+ClJldmlld2VkLWJ5OiBFbWlsIFZlbGlrb3YgPGVt
aWwudmVsaWtvdkBjb2xsYWJvcmEuY29tPgpTaWduZWQtb2ZmLWJ5OiBTam9lcmQgU2ltb25zIDxz
am9lcmQuc2ltb25zQGNvbGxhYm9yYS5jb20+ClNpZ25lZC1vZmYtYnk6IE1hcnR5biBXZWxjaCA8
bWFydHluLndlbGNoQGNvbGxhYm9yYS5jb20+ClNpZ25lZC1vZmYtYnk6IEFkcmlhbiBSYXRpdSA8
YWRyaWFuLnJhdGl1QGNvbGxhYm9yYS5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9z
eW5vcHN5cy9kdy1taXBpLWRzaS5jIHwgMTQ2ICsrKysrKy0KIGRyaXZlcnMvZ3B1L2RybS9pbXgv
S2NvbmZpZyAgICAgICAgICAgICAgICAgICB8ICAgNyArCiBkcml2ZXJzL2dwdS9kcm0vaW14L01h
a2VmaWxlICAgICAgICAgICAgICAgICAgfCAgIDEgKwogZHJpdmVycy9ncHUvZHJtL2lteC9kd19t
aXBpX2RzaS1pbXg2LmMgICAgICAgIHwgMzc4ICsrKysrKysrKysrKysrKysrKwogNCBmaWxlcyBj
aGFuZ2VkLCA1MjMgaW5zZXJ0aW9ucygrKSwgOSBkZWxldGlvbnMoLSkKIGNyZWF0ZSBtb2RlIDEw
MDY0NCBkcml2ZXJzL2dwdS9kcm0vaW14L2R3X21pcGlfZHNpLWlteDYuYwoKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9icmlkZ2Uvc3lub3BzeXMvZHctbWlwaS1kc2kuYyBiL2RyaXZlcnMv
Z3B1L2RybS9icmlkZ2Uvc3lub3BzeXMvZHctbWlwaS1kc2kuYwppbmRleCBhNDFhNjMwMzAyYjYu
LjVmMmZhNDY3NzM0YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9zeW5vcHN5
cy9kdy1taXBpLWRzaS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2Uvc3lub3BzeXMvZHct
bWlwaS1kc2kuYwpAQCAtMzEsNiArMzEsOCBAQAogI2luY2x1ZGUgPGRybS9kcm1fcHJvYmVfaGVs
cGVyLmg+CiAKICNkZWZpbmUgSFdWRVJfMTMxCQkJMHgzMTMzMzEwMAkvKiBJUCB2ZXJzaW9uIDEu
MzEgKi8KKyNkZWZpbmUgSFdWRVJfMTMwCQkJMHgzMTMzMzAwMAkvKiBJUCB2ZXJzaW9uIDEuMzAg
Ki8KKyNkZWZpbmUgSFdWRVJfMTAxCQkJMHgzMTMwMzAwMAkvKiBJUCB2ZXJzaW9uIDEuMDEgKi8K
IAogI2RlZmluZSBEU0lfVkVSU0lPTgkJCTB4MDAKICNkZWZpbmUgVkVSU0lPTgkJCQlHRU5NQVNL
KDMxLCA4KQpAQCAtOTksNiArMTAxLDI1IEBACiAjZGVmaW5lIERTSV9FRFBJX0NNRF9TSVpFCQkw
eDY0CiAKICNkZWZpbmUgRFNJX0NNRF9NT0RFX0NGRwkJMHg2OAorCisjZGVmaW5lIERTSV9EUElf
Q0ZHCQkJMHgwYworI2RlZmluZSBEU0lfVE1SX0xJTkVfQ0ZHCQkweDI4CisjZGVmaW5lIERTSV9W
VElNSU5HX0NGRwkJCTB4MmMKKyNkZWZpbmUgRFNJX1BIWV9UTVJfQ0ZHX1YxMDEJCTB4MzAKKyNk
ZWZpbmUgRFNJX1BIWV9JRl9DRkdfVjEwMQkJMHg1OAorI2RlZmluZSBEU0lfUEhZX0lGX0NUUkwJ
CQkweDVjCisjZGVmaW5lIERTSV9QSFlfUlNUWl9WMTAxCQkweDU0CisjZGVmaW5lIERTSV9QSFlf
U1RBVFVTX1YxMDEJCTB4NjAKKyNkZWZpbmUgRFNJX1BIWV9UU1RfQ1RSTDBfVjEwMQkJMHg2NAor
I2RlZmluZSBEU0lfR0VOX0hEUl9WMTAxCQkweDM0CisjZGVmaW5lIERTSV9HRU5fUExEX0RBVEFf
VjEwMQkJMHgzOAorI2RlZmluZSBEU0lfQ01EX01PREVfQ0ZHX1YxMDEJCTB4MjQKKyNkZWZpbmUg
RFNJX0NNRF9QS1RfU1RBVFVTX1YxMDEJCTB4M2MKKyNkZWZpbmUgRFNJX1ZJRF9QS1RfQ0ZHCQkJ
MHgyMAorI2RlZmluZSBEU0lfVklEX01PREVfQ0ZHX1YxMDEJCTB4MWMKKyNkZWZpbmUgRFNJX1RP
X0NOVF9DRkdfVjEwMQkJMHg0MAorI2RlZmluZSBEU0lfUENLSERMX0NGR19WMTAxCQkweDE4CisK
ICNkZWZpbmUgTUFYX1JEX1BLVF9TSVpFX0xQCQlCSVQoMjQpCiAjZGVmaW5lIERDU19MV19UWF9M
UAkJCUJJVCgxOSkKICNkZWZpbmUgRENTX1NSXzBQX1RYX0xQCQkJQklUKDE4KQpAQCAtMTI2LDYg
KzE0NywzMyBAQAogCQkJCQkgR0VOX1NXXzFQX1RYX0xQIHwgXAogCQkJCQkgR0VOX1NXXzBQX1RY
X0xQKQogCisjZGVmaW5lIEVOX1RFQVJfRlhfVjEwMQkJCUJJVCgxNCkKKyNkZWZpbmUgRENTX0xX
X1RYX0xQX1YxMDEJCUJJVCgxMikKKyNkZWZpbmUgR0VOX0xXX1RYX0xQX1YxMDEJCUJJVCgxMSkK
KyNkZWZpbmUgTUFYX1JEX1BLVF9TSVpFX0xQX1YxMDEJCUJJVCgxMCkKKyNkZWZpbmUgRENTX1NX
XzJQX1RYX0xQX1YxMDEJCUJJVCg5KQorI2RlZmluZSBEQ1NfU1dfMVBfVFhfTFBfVjEwMQkJQklU
KDgpCisjZGVmaW5lIERDU19TV18wUF9UWF9MUF9WMTAxCQlCSVQoNykKKyNkZWZpbmUgR0VOX1NS
XzJQX1RYX0xQX1YxMDEJCUJJVCg2KQorI2RlZmluZSBHRU5fU1JfMVBfVFhfTFBfVjEwMQkJQklU
KDUpCisjZGVmaW5lIEdFTl9TUl8wUF9UWF9MUF9WMTAxCQlCSVQoNCkKKyNkZWZpbmUgR0VOX1NX
XzJQX1RYX0xQX1YxMDEJCUJJVCgzKQorI2RlZmluZSBHRU5fU1dfMVBfVFhfTFBfVjEwMQkJQklU
KDIpCisjZGVmaW5lIEdFTl9TV18wUF9UWF9MUF9WMTAxCQlCSVQoMSkKKworI2RlZmluZSBDTURf
TU9ERV9BTExfTFBfVjEwMQkJKERDU19MV19UWF9MUF9WMTAxIHwgXAorCQkJCQkgR0VOX0xXX1RY
X0xQX1YxMDEgfCBcCisJCQkJCSBNQVhfUkRfUEtUX1NJWkVfTFBfVjEwMSB8IFwKKwkJCQkJIERD
U19TV18yUF9UWF9MUF9WMTAxIHwgXAorCQkJCQkgRENTX1NXXzFQX1RYX0xQX1YxMDEgfCBcCisJ
CQkJCSBEQ1NfU1dfMFBfVFhfTFBfVjEwMSB8IFwKKwkJCQkJIEdFTl9TUl8yUF9UWF9MUF9WMTAx
IHwgXAorCQkJCQkgR0VOX1NSXzFQX1RYX0xQX1YxMDEgfCBcCisJCQkJCSBHRU5fU1JfMFBfVFhf
TFBfVjEwMSB8IFwKKwkJCQkJIEdFTl9TV18yUF9UWF9MUF9WMTAxIHwgXAorCQkJCQkgR0VOX1NX
XzFQX1RYX0xQX1YxMDEgfCBcCisJCQkJCSBHRU5fU1dfMFBfVFhfTFBfVjEwMSkKKwogI2RlZmlu
ZSBEU0lfR0VOX0hEUgkJCTB4NmMKICNkZWZpbmUgRFNJX0dFTl9QTERfREFUQQkJMHg3MAogCkBA
IC0xNjQsNiArMjEyLDExIEBACiAjZGVmaW5lIERTSV9JTlRfTVNLMAkJCTB4YzQKICNkZWZpbmUg
RFNJX0lOVF9NU0sxCQkJMHhjOAogCisjZGVmaW5lIERTSV9FUlJPUl9TVDBfVjEwMQkJMHg0NAor
I2RlZmluZSBEU0lfRVJST1JfU1QxX1YxMDEJCTB4NDgKKyNkZWZpbmUgRFNJX0VSUk9SX01TSzBf
VjEwMQkJMHg0YworI2RlZmluZSBEU0lfRVJST1JfTVNLMV9WMTAxCQkweDUwCisKICNkZWZpbmUg
RFNJX1BIWV9UTVJfUkRfQ0ZHCQkweGY0CiAKICNkZWZpbmUgUEhZX1NUQVRVU19USU1FT1VUX1VT
CQkxMDAwMApAQCAtMzU3LDYgKzQxMCw0OSBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGR3X21pcGlf
ZHNpX3ZhcmlhbnQgZHdfbWlwaV9kc2lfdjEzMF92MTMxX2xheW91dCA9IHsKIAkuY2ZnX2dlbl9w
YXlsb2FkID0JCVJFR19GSUVMRChEU0lfR0VOX1BMRF9EQVRBLCAwLCAzMSksCiB9OwogCitzdGF0
aWMgY29uc3Qgc3RydWN0IGR3X21pcGlfZHNpX3ZhcmlhbnQgZHdfbWlwaV9kc2lfdjEwMV9sYXlv
dXQgPSB7CisJLmNmZ19kcGlfdmlkID0JCQlSRUdfRklFTEQoRFNJX0RQSV9DRkcsIDAsIDEpLAor
CS5jZmdfZHBpX2NvbG9yX2NvZGluZyA9CQlSRUdfRklFTEQoRFNJX0RQSV9DRkcsIDIsIDQpLAor
CS5jZmdfZHBpXzE4bG9vc2VseV9lbiA9CQlSRUdfRklFTEQoRFNJX0RQSV9DRkcsIDEwLCAxMCks
CisJLmNmZ19kcGlfdnN5bmNfYWN0aXZlX2xvdyA9CVJFR19GSUVMRChEU0lfRFBJX0NGRywgNiwg
NiksCisJLmNmZ19kcGlfaHN5bmNfYWN0aXZlX2xvdyA9CVJFR19GSUVMRChEU0lfRFBJX0NGRywg
NywgNyksCisJLmNmZ19jbWRfbW9kZV9lbiA9CQlSRUdfRklFTEQoRFNJX0NNRF9NT0RFX0NGR19W
MTAxLCAwLCAwKSwKKwkuY2ZnX2NtZF9tb2RlX2FsbF9scF9lbiA9CVJFR19GSUVMRChEU0lfQ01E
X01PREVfQ0ZHX1YxMDEsIDEsIDEyKSwKKwkuY2ZnX2NtZF9tb2RlX2Fja19ycXN0X2VuID0JUkVH
X0ZJRUxEKERTSV9DTURfTU9ERV9DRkdfVjEwMSwgMTMsIDEzKSwKKwkuY2ZnX2NtZF9wa3Rfc3Rh
dHVzID0JCVJFR19GSUVMRChEU0lfQ01EX1BLVF9TVEFUVVNfVjEwMSwgMCwgMTQpLAorCS5jZmdf
dmlkX21vZGVfZW4gPQkJUkVHX0ZJRUxEKERTSV9WSURfTU9ERV9DRkdfVjEwMSwgMCwgMCksCisJ
LmNmZ192aWRfbW9kZV90eXBlID0JCVJFR19GSUVMRChEU0lfVklEX01PREVfQ0ZHX1YxMDEsIDEs
IDIpLAorCS5jZmdfdmlkX21vZGVfbG93X3Bvd2VyID0JUkVHX0ZJRUxEKERTSV9WSURfTU9ERV9D
RkdfVjEwMSwgMywgOCksCisJLmNmZ192aWRfcGt0X3NpemUgPQkJUkVHX0ZJRUxEKERTSV9WSURf
UEtUX0NGRywgMCwgMTApLAorCS5jZmdfdmlkX2hzYV90aW1lID0JCVJFR19GSUVMRChEU0lfVE1S
X0xJTkVfQ0ZHLCAwLCA4KSwKKwkuY2ZnX3ZpZF9oYnBfdGltZSA9CQlSRUdfRklFTEQoRFNJX1RN
Ul9MSU5FX0NGRywgOSwgMTcpLAorCS5jZmdfdmlkX2hsaW5lX3RpbWUgPQkJUkVHX0ZJRUxEKERT
SV9UTVJfTElORV9DRkcsIDE4LCAzMSksCisJLmNmZ192aWRfdnNhX3RpbWUgPQkJUkVHX0ZJRUxE
KERTSV9WVElNSU5HX0NGRywgMCwgMyksCisJLmNmZ192aWRfdmJwX3RpbWUgPQkJUkVHX0ZJRUxE
KERTSV9WVElNSU5HX0NGRywgNCwgOSksCisJLmNmZ192aWRfdmZwX3RpbWUgPQkJUkVHX0ZJRUxE
KERTSV9WVElNSU5HX0NGRywgMTAsIDE1KSwKKwkuY2ZnX3ZpZF92YWN0aXZlX3RpbWUgPQkJUkVH
X0ZJRUxEKERTSV9WVElNSU5HX0NGRywgMTYsIDI2KSwKKwkuY2ZnX3BoeV90eHJlcXVlc3RjbGto
cyA9CVJFR19GSUVMRChEU0lfUEhZX0lGX0NUUkwsIDAsIDApLAorCS5jZmdfcGh5X2J0YV90aW1l
ID0JCVJFR19GSUVMRChEU0lfUEhZX1RNUl9DRkdfVjEwMSwgMCwgMTEpLAorCS5jZmdfcGh5X2xw
MmhzX3RpbWUgPQkJUkVHX0ZJRUxEKERTSV9QSFlfVE1SX0NGR19WMTAxLCAxMiwgMTkpLAorCS5j
ZmdfcGh5X2hzMmxwX3RpbWUgPQkJUkVHX0ZJRUxEKERTSV9QSFlfVE1SX0NGR19WMTAxLCAyMCwg
MjcpLAorCS5jZmdfcGh5X3Rlc3RjbHIgPQkJUkVHX0ZJRUxEKERTSV9QSFlfVFNUX0NUUkwwX1Yx
MDEsIDAsIDApLAorCS5jZmdfcGh5X3Vuc2h1dGRvd256ID0JCVJFR19GSUVMRChEU0lfUEhZX1JT
VFpfVjEwMSwgMCwgMCksCisJLmNmZ19waHlfdW5yc3R6ID0JCVJFR19GSUVMRChEU0lfUEhZX1JT
VFpfVjEwMSwgMSwgMSksCisJLmNmZ19waHlfZW5hYmxlY2xrID0JCVJFR19GSUVMRChEU0lfUEhZ
X1JTVFpfVjEwMSwgMiwgMiksCisJLmNmZ19waHlfbmxhbmVzID0JCVJFR19GSUVMRChEU0lfUEhZ
X0lGX0NGR19WMTAxLCAwLCAxKSwKKwkuY2ZnX3BoeV9zdG9wX3dhaXRfdGltZSA9CVJFR19GSUVM
RChEU0lfUEhZX0lGX0NGR19WMTAxLCAyLCA5KSwKKwkuY2ZnX3BoeV9zdGF0dXMgPQkJUkVHX0ZJ
RUxEKERTSV9QSFlfU1RBVFVTX1YxMDEsIDAsIDApLAorCS5jZmdfcGNraGRsX2NmZyA9CQlSRUdf
RklFTEQoRFNJX1BDS0hETF9DRkdfVjEwMSwgMCwgNCksCisJLmNmZ19oc3R4X3RpbWVvdXRfY291
bnRlciA9CVJFR19GSUVMRChEU0lfVE9fQ05UX0NGR19WMTAxLCAwLCAxNSksCisJLmNmZ19scHJ4
X3RpbWVvdXRfY291bnRlciA9CVJFR19GSUVMRChEU0lfVE9fQ05UX0NGR19WMTAxLCAxNiwgMzEp
LAorCS5jZmdfaW50X3N0YXQwID0JCVJFR19GSUVMRChEU0lfRVJST1JfU1QwX1YxMDEsIDAsIDIw
KSwKKwkuY2ZnX2ludF9zdGF0MSA9CQlSRUdfRklFTEQoRFNJX0VSUk9SX1NUMV9WMTAxLCAwLCAx
NyksCisJLmNmZ19pbnRfbWFzazAgPQkJUkVHX0ZJRUxEKERTSV9FUlJPUl9NU0swX1YxMDEsIDAs
IDIwKSwKKwkuY2ZnX2ludF9tYXNrMSA9CQlSRUdfRklFTEQoRFNJX0VSUk9SX01TSzFfVjEwMSwg
MCwgMTcpLAorCS5jZmdfZ2VuX2hkciA9CQkJUkVHX0ZJRUxEKERTSV9HRU5fSERSX1YxMDEsIDAs
IDMxKSwKKwkuY2ZnX2dlbl9wYXlsb2FkID0JCVJFR19GSUVMRChEU0lfR0VOX1BMRF9EQVRBX1Yx
MDEsIDAsIDMxKSwKK307CisKIC8qCiAgKiBDaGVjayBpZiBlaXRoZXIgYSBsaW5rIHRvIGEgbWFz
dGVyIG9yIHNsYXZlIGlzIHByZXNlbnQKICAqLwpAQCAtNDU5LDEyICs1NTUsMjEgQEAgc3RhdGlj
IHZvaWQgZHdfbWlwaV9tZXNzYWdlX2NvbmZpZyhzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSwKIAli
b29sIGxwbSA9IG1zZy0+ZmxhZ3MgJiBNSVBJX0RTSV9NU0dfVVNFX0xQTTsKIAl1MzIgY21kX21v
ZGVfbHAgPSAwOwogCisJc3dpdGNoIChkc2ktPmh3X3ZlcnNpb24pIHsKKwljYXNlIEhXVkVSXzEz
MDoKKwljYXNlIEhXVkVSXzEzMToKKwkJY21kX21vZGVfbHAgPSBDTURfTU9ERV9BTExfTFA7CisJ
CWJyZWFrOworCWNhc2UgSFdWRVJfMTAxOgorCQljbWRfbW9kZV9scCA9IENNRF9NT0RFX0FMTF9M
UF9WMTAxOworCQlicmVhazsKKwl9CisKIAlpZiAobXNnLT5mbGFncyAmIE1JUElfRFNJX01TR19S
RVFfQUNLKQogCQlyZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9jbWRfbW9kZV9hY2tfcnFz
dF9lbiwgMSk7CiAKIAlpZiAobHBtKQotCQlyZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9j
bWRfbW9kZV9hbGxfbHBfZW4sCi0JCQkJICAgQ01EX01PREVfQUxMX0xQKTsKKwkJcmVnbWFwX2Zp
ZWxkX3dyaXRlKGRzaS0+ZmllbGRfY21kX21vZGVfYWxsX2xwX2VuLCBjbWRfbW9kZV9scCk7CiAK
IAlyZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfdHhyZXF1ZXN0Y2xraHMsIGxwbSA/
IDAgOiAxKTsKIH0KQEAgLTYzNiw3ICs3NDEsNyBAQCBzdGF0aWMgdm9pZCBkd19taXBpX2RzaV92
aWRlb19tb2RlX2NvbmZpZyhzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSkKIAkJCQkgICBWSURfTU9E
RV9UWVBFX05PTl9CVVJTVF9TWU5DX0VWRU5UUyk7CiAKICNpZmRlZiBDT05GSUdfREVCVUdfRlMK
LQlpZiAoZHNpLT52cGcpIHsKKwlpZiAoZHNpLT5od192ZXJzaW9uID4gSFdWRVJfMTAxICYmIGRz
aS0+dnBnKSB7CiAJCXJlZ21hcF9maWVsZF93cml0ZShkc2ktPnJlZ3MsIGRzaS0+ZmllbGRfdmlk
X21vZGVfdnBnX2VuLCAxKTsKIAkJcmVnbWFwX2ZpZWxkX3dyaXRlKGRzaS0+cmVncywgZHNpLT5m
aWVsZF92aWRfbW9kZV92cGdfaG9yaXosCiAJCQkJICAgZHNpLT52cGdfaG9yaXpvbnRhbCA/IDEg
OiAwKTsKQEAgLTY1NCw5ICs3NTksMTUgQEAgc3RhdGljIHZvaWQgZHdfbWlwaV9kc2lfc2V0X21v
ZGUoc3RydWN0IGR3X21pcGlfZHNpICpkc2ksCiAKIAkJZHdfbWlwaV9kc2lfdmlkZW9fbW9kZV9j
b25maWcoZHNpKTsKIAorCQlpZiAoZHNpLT5od192ZXJzaW9uID09IEhXVkVSXzEwMSkKKwkJCXJl
Z21hcF9maWVsZF93cml0ZShkc2ktPmZpZWxkX3ZpZF9tb2RlX2VuLCAxKTsKKwogCQlyZWdtYXBf
ZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfdHhyZXF1ZXN0Y2xraHMsIDEpOwogCX0gZWxzZSB7
CiAJCXJlZ21hcF9maWVsZF93cml0ZShkc2ktPmZpZWxkX2NtZF9tb2RlX2VuLCAxKTsKKworCQlp
ZiAoZHNpLT5od192ZXJzaW9uID09IEhXVkVSXzEwMSkKKwkJCXJlZ21hcF9maWVsZF93cml0ZShk
c2ktPmZpZWxkX3ZpZF9tb2RlX2VuLCAwKTsKIAl9CiAKIAlyZWdtYXBfd3JpdGUoZHNpLT5yZWdz
LCBEU0lfUFdSX1VQLCBQT1dFUlVQKTsKQEAgLTg0MCw5ICs5NTEsMTEgQEAgc3RhdGljIHZvaWQg
ZHdfbWlwaV9kc2lfZHBoeV90aW1pbmdfY29uZmlnKHN0cnVjdCBkd19taXBpX2RzaSAqZHNpKQog
CXJlZ21hcF9maWVsZF93cml0ZShkc2ktPmZpZWxkX3BoeV9scDJoc190aW1lLCAweDQwKTsKIAly
ZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfaHMybHBfdGltZSwgMHg0MCk7CiAKLQly
ZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfbWF4X3JkX3RpbWUsIDEwMDAwKTsKLQly
ZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfY2xrbHAyaHNfdGltZSwgMHg0MCk7Ci0J
cmVnbWFwX2ZpZWxkX3dyaXRlKGRzaS0+ZmllbGRfcGh5X2Nsa2hzMmxwX3RpbWUsIDB4NDApOwor
CWlmIChkc2ktPmh3X3ZlcnNpb24gPiBIV1ZFUl8xMDEpIHsKKwkJcmVnbWFwX2ZpZWxkX3dyaXRl
KGRzaS0+ZmllbGRfcGh5X21heF9yZF90aW1lLCAxMDAwMCk7CisJCXJlZ21hcF9maWVsZF93cml0
ZShkc2ktPmZpZWxkX3BoeV9jbGtscDJoc190aW1lLCAweDQwKTsKKwkJcmVnbWFwX2ZpZWxkX3dy
aXRlKGRzaS0+ZmllbGRfcGh5X2Nsa2hzMmxwX3RpbWUsIDB4NDApOworCX0KIH0KIAogc3RhdGlj
IHZvaWQgZHdfbWlwaV9kc2lfZHBoeV9pbnRlcmZhY2VfY29uZmlnKHN0cnVjdCBkd19taXBpX2Rz
aSAqZHNpKQpAQCAtODYzLDcgKzk3Niw4IEBAIHN0YXRpYyB2b2lkIGR3X21pcGlfZHNpX2RwaHlf
aW5pdChzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSkKIAlyZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5m
aWVsZF9waHlfdW5yc3R6LCAwKTsKIAlyZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlf
dW5zaHV0ZG93bnosIDApOwogCi0JcmVnbWFwX2ZpZWxkX3dyaXRlKGRzaS0+ZmllbGRfcGh5X2Zv
cmNlcGxsLCAwKTsKKwlpZiAoZHNpLT5od192ZXJzaW9uID4gSFdWRVJfMTAxKQorCQlyZWdtYXBf
ZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfZm9yY2VwbGwsIDApOwogCiAJcmVnbWFwX2ZpZWxk
X3dyaXRlKGRzaS0+ZmllbGRfcGh5X3Rlc3RjbHIsIDApOwogCXJlZ21hcF9maWVsZF93cml0ZShk
c2ktPmZpZWxkX3BoeV90ZXN0Y2xyLCAxKTsKQEAgLTg3OSw3ICs5OTMsOCBAQCBzdGF0aWMgdm9p
ZCBkd19taXBpX2RzaV9kcGh5X2VuYWJsZShzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSkKIAlyZWdt
YXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfdW5yc3R6LCAxKTsKIAlyZWdtYXBfZmllbGRf
d3JpdGUoZHNpLT5maWVsZF9waHlfdW5zaHV0ZG93bnosIDEpOwogCi0JcmVnbWFwX2ZpZWxkX3dy
aXRlKGRzaS0+ZmllbGRfcGh5X2ZvcmNlcGxsLCAxKTsKKwlpZiAoZHNpLT5od192ZXJzaW9uID4g
SFdWRVJfMTAxKQorCQlyZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfZm9yY2VwbGws
IDEpOwogCiAJcmV0ID0gcmVnbWFwX2ZpZWxkX3JlYWRfcG9sbF90aW1lb3V0KGRzaS0+ZmllbGRf
cGh5X3N0YXR1cywKIAkJCQkJICAgICB2YWwsIHZhbCAmIFBIWV9MT0NLLApAQCAtMTEwNSw3ICsx
MjIwLDIwIEBAIHN0YXRpYyB2b2lkIGR3X21pcGlfZHNpX2dldF9od192ZXJzaW9uKHN0cnVjdCBk
d19taXBpX2RzaSAqZHNpKQogCiBzdGF0aWMgaW50IGR3X21pcGlfZHNpX3JlZ21hcF9maWVsZHNf
aW5pdChzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSkKIHsKLQljb25zdCBzdHJ1Y3QgZHdfbWlwaV9k
c2lfdmFyaWFudCAqdmFyaWFudCA9ICZkd19taXBpX2RzaV92MTMwX3YxMzFfbGF5b3V0OworCWNv
bnN0IHN0cnVjdCBkd19taXBpX2RzaV92YXJpYW50ICp2YXJpYW50OworCisJc3dpdGNoIChkc2kt
Pmh3X3ZlcnNpb24pIHsKKwljYXNlIEhXVkVSXzEzMDoKKwljYXNlIEhXVkVSXzEzMToKKwkJdmFy
aWFudCA9ICZkd19taXBpX2RzaV92MTMwX3YxMzFfbGF5b3V0OworCQlicmVhazsKKwljYXNlIEhX
VkVSXzEwMToKKwkJdmFyaWFudCA9ICZkd19taXBpX2RzaV92MTAxX2xheW91dDsKKwkJYnJlYWs7
CisJZGVmYXVsdDoKKwkJRFJNX0VSUk9SKCJVbnJlY29nbml6ZWQgRFNJIGhvc3QgY29udHJvbGxl
ciBIVyByZXZpc2lvblxuIik7CisJCXJldHVybiAtRU5PREVWOworCX0KIAogCUlOSVRfRklFTEQo
ZHBpXzE4bG9vc2VseV9lbik7CiAJSU5JVF9GSUVMRChkcGlfdmlkKTsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pbXgvS2NvbmZpZyBiL2RyaXZlcnMvZ3B1L2RybS9pbXgvS2NvbmZpZwpp
bmRleCAyMDdiZjc0MDlkZmIuLmI0OWU3MGU3ZjBmZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2lteC9LY29uZmlnCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pbXgvS2NvbmZpZwpAQCAtMzks
MyArMzksMTAgQEAgY29uZmlnIERSTV9JTVhfSERNSQogCWRlcGVuZHMgb24gRFJNX0lNWAogCWhl
bHAKIAkgIENob29zZSB0aGlzIGlmIHlvdSB3YW50IHRvIHVzZSBIRE1JIG9uIGkuTVg2LgorCitj
b25maWcgRFJNX0lNWDZfTUlQSV9EU0kKKwl0cmlzdGF0ZSAiRnJlZXNjYWxlIGkuTVg2IERSTSBN
SVBJIERTSSIKKwlzZWxlY3QgRFJNX0RXX01JUElfRFNJCisJZGVwZW5kcyBvbiBEUk1fSU1YCisJ
aGVscAorCSAgQ2hvb3NlIHRoaXMgaWYgeW91IHdhbnQgdG8gdXNlIE1JUEkgRFNJIG9uIGkuTVg2
LgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2lteC9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1
L2RybS9pbXgvTWFrZWZpbGUKaW5kZXggMjFjZGNjMmZhYWJjLi45YTc4NDNjNTkzNDcgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pbXgvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2lteC9NYWtlZmlsZQpAQCAtOSwzICs5LDQgQEAgb2JqLSQoQ09ORklHX0RSTV9JTVhfVFZFKSAr
PSBpbXgtdHZlLm8KIG9iai0kKENPTkZJR19EUk1fSU1YX0xEQikgKz0gaW14LWxkYi5vCiAKIG9i
ai0kKENPTkZJR19EUk1fSU1YX0hETUkpICs9IGR3X2hkbWktaW14Lm8KK29iai0kKENPTkZJR19E
Uk1fSU1YNl9NSVBJX0RTSSkgKz0gZHdfbWlwaV9kc2ktaW14Ni5vCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaW14L2R3X21pcGlfZHNpLWlteDYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pbXgv
ZHdfbWlwaV9kc2ktaW14Ni5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAw
MC4uMjEyNTYyYWFjZjMxCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2lteC9k
d19taXBpX2RzaS1pbXg2LmMKQEAgLTAsMCArMSwzNzggQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVu
dGlmaWVyOiBHUEwtMi4wKworLyoKKyAqIGkuTVg2IGRybSBkcml2ZXIgLSBNSVBJIERTSSBIb3N0
IENvbnRyb2xsZXIKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMTEtMjAxNSBGcmVlc2NhbGUgU2Vt
aWNvbmR1Y3RvciwgSW5jLgorICovCisKKyNpbmNsdWRlIDxsaW51eC9jbGsuaD4KKyNpbmNsdWRl
IDxsaW51eC9jb21wb25lbnQuaD4KKyNpbmNsdWRlIDxsaW51eC9tZmQvc3lzY29uLmg+CisjaW5j
bHVkZSA8bGludXgvbWZkL3N5c2Nvbi9pbXg2cS1pb211eGMtZ3ByLmg+CisjaW5jbHVkZSA8bGlu
dXgvbW9kdWxlLmg+CisjaW5jbHVkZSA8bGludXgvb2ZfZGV2aWNlLmg+CisjaW5jbHVkZSA8bGlu
dXgvcmVnbWFwLmg+CisjaW5jbHVkZSA8bGludXgvdmlkZW9kZXYyLmg+CisjaW5jbHVkZSA8ZHJt
L2JyaWRnZS9kd19taXBpX2RzaS5oPgorI2luY2x1ZGUgPGRybS9kcm1fY3J0Y19oZWxwZXIuaD4K
KyNpbmNsdWRlIDxkcm0vZHJtX21pcGlfZHNpLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9vZi5oPgor
I2luY2x1ZGUgPGRybS9kcm1fcHJpbnQuaD4KKworI2luY2x1ZGUgImlteC1kcm0uaCIKKworI2Rl
ZmluZSBEUklWRVJfTkFNRQkiaW14LW1pcGktZHNpIgorCisjZGVmaW5lIERTSV9QV1JfVVAJCQkw
eDA0CisjZGVmaW5lIFJFU0VUCQkJCTAKKyNkZWZpbmUgUE9XRVJVUAkJCQlCSVQoMCkKKworI2Rl
ZmluZSBEU0lfUEhZX0lGX0NUUkwJCQkweDVjCisjZGVmaW5lIFBIWV9JRl9DVFJMX1JFU0VUCQkw
eDAKKworI2RlZmluZSBEU0lfUEhZX1RTVF9DVFJMMAkJMHg2NAorI2RlZmluZSBQSFlfVEVTVENM
SwkJCUJJVCgxKQorI2RlZmluZSBQSFlfVU5URVNUQ0xLCQkJMAorI2RlZmluZSBQSFlfVEVTVENM
UgkJCUJJVCgwKQorI2RlZmluZSBQSFlfVU5URVNUQ0xSCQkJMAorCisjZGVmaW5lIERTSV9QSFlf
VFNUX0NUUkwxCQkweDY4CisjZGVmaW5lIFBIWV9URVNURU4JCQlCSVQoMTYpCisjZGVmaW5lIFBI
WV9VTlRFU1RFTgkJCTAKKyNkZWZpbmUgUEhZX1RFU1RET1VUKG4pCQkJKCgobikgJiAweGZmKSA8
PCA4KQorI2RlZmluZSBQSFlfVEVTVERJTihuKQkJCSgoKG4pICYgMHhmZikgPDwgMCkKKworc3Ry
dWN0IGlteF9taXBpX2RzaSB7CisJc3RydWN0IGRybV9lbmNvZGVyIGVuY29kZXI7CisJc3RydWN0
IGRldmljZSAqZGV2OworCXN0cnVjdCByZWdtYXAgKm11eF9zZWw7CisJc3RydWN0IGR3X21pcGlf
ZHNpICptaXBpX2RzaTsKKwlzdHJ1Y3QgY2xrICpwbGxyZWZfY2xrOworCisJc3RydWN0IHJlZ21h
cCAqcmVnczsKKwl1bnNpZ25lZCBpbnQgbGFuZV9tYnBzOworfTsKKworc3RydWN0IGRwaHlfcGxs
X3Rlc3RkaW5fbWFwIHsKKwl1bnNpZ25lZCBpbnQgbWF4X21icHM7CisJdTggdGVzdGRpbjsKK307
CisKKy8qIFRoZSB0YWJsZSBpcyBiYXNlZCBvbiAyN01IeiBEUEhZIHBsbCByZWZlcmVuY2UgY2xv
Y2suICovCitzdGF0aWMgY29uc3Qgc3RydWN0IGRwaHlfcGxsX3Rlc3RkaW5fbWFwIGRwdGRpbl9t
YXBbXSA9IHsKKwl7MTYwLCAweDA0fSwgezE4MCwgMHgyNH0sIHsyMDAsIDB4NDR9LCB7MjEwLCAw
eDA2fSwKKwl7MjQwLCAweDI2fSwgezI1MCwgMHg0Nn0sIHsyNzAsIDB4MDh9LCB7MzAwLCAweDI4
fSwKKwl7MzMwLCAweDQ4fSwgezM2MCwgMHgyYX0sIHs0MDAsIDB4NGF9LCB7NDUwLCAweDBjfSwK
Kwl7NTAwLCAweDJjfSwgezU1MCwgMHgwZX0sIHs2MDAsIDB4MmV9LCB7NjUwLCAweDEwfSwKKwl7
NzAwLCAweDMwfSwgezc1MCwgMHgxMn0sIHs4MDAsIDB4MzJ9LCB7ODUwLCAweDE0fSwKKwl7OTAw
LCAweDM0fSwgezk1MCwgMHg1NH0sIHsxMDAwLCAweDc0fQorfTsKKworc3RhdGljIGlubGluZSBz
dHJ1Y3QgaW14X21pcGlfZHNpICplbmNfdG9fZHNpKHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jKQor
eworCXJldHVybiBjb250YWluZXJfb2YoZW5jLCBzdHJ1Y3QgaW14X21pcGlfZHNpLCBlbmNvZGVy
KTsKK30KKworc3RhdGljIHZvaWQgaW14X21pcGlfZHNpX3NldF9pcHVfZGlfbXV4KHN0cnVjdCBp
bXhfbWlwaV9kc2kgKmRzaSwgaW50IGlwdV9kaSkKK3sKKwlyZWdtYXBfdXBkYXRlX2JpdHMoZHNp
LT5tdXhfc2VsLCBJT01VWENfR1BSMywKKwkJCSAgIElNWDZRX0dQUjNfTUlQSV9NVVhfQ1RMX01B
U0ssCisJCQkgICBpcHVfZGkgPDwgSU1YNlFfR1BSM19NSVBJX01VWF9DVExfU0hJRlQpOworfQor
CitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9lbmNvZGVyX2Z1bmNzIGlteF9taXBpX2RzaV9lbmNv
ZGVyX2Z1bmNzID0geworCS5kZXN0cm95ID0gaW14X2RybV9lbmNvZGVyX2Rlc3Ryb3ksCit9Owor
CitzdGF0aWMgYm9vbCBpbXhfbWlwaV9kc2lfZW5jb2Rlcl9tb2RlX2ZpeHVwKHN0cnVjdCBkcm1f
ZW5jb2RlciAqZW5jb2RlciwKKwkJCQkJICAgIGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2Rl
ICptb2RlLAorCQkJCQkgICAgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkal9tb2RlKQorewor
CXJldHVybiB0cnVlOworfQorCitzdGF0aWMgaW50IGlteF9taXBpX2RzaV9lbmNvZGVyX2F0b21p
Y19jaGVjayhzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIsCisJCQkJCSAgICAgc3RydWN0IGRy
bV9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAorCQkJCQkgICAgIHN0cnVjdCBkcm1fY29ubmVjdG9y
X3N0YXRlICpjb25uKQoreworCXN0cnVjdCBpbXhfY3J0Y19zdGF0ZSAqaW14X2NydGNfc3RhdGUg
PSB0b19pbXhfY3J0Y19zdGF0ZShjcnRjX3N0YXRlKTsKKworCS8qIFRoZSBmb2xsb3dpbmcgdmFs
dWVzIGFyZSB0YWtlbiBmcm9tIGR3X2hkbWlfaW14X2F0b21pY19jaGVjayAqLworCWlteF9jcnRj
X3N0YXRlLT5idXNfZm9ybWF0ID0gTUVESUFfQlVTX0ZNVF9SR0I4ODhfMVgyNDsKKwlpbXhfY3J0
Y19zdGF0ZS0+ZGlfaHN5bmNfcGluID0gMjsKKwlpbXhfY3J0Y19zdGF0ZS0+ZGlfdnN5bmNfcGlu
ID0gMzsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBpbXhfbWlwaV9kc2lfZW5jb2Rl
cl9jb21taXQoc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyKQoreworCXN0cnVjdCBpbXhfbWlw
aV9kc2kgKmRzaSA9IGVuY190b19kc2koZW5jb2Rlcik7CisJaW50IG11eCA9IGRybV9vZl9lbmNv
ZGVyX2FjdGl2ZV9wb3J0X2lkKGRzaS0+ZGV2LT5vZl9ub2RlLCBlbmNvZGVyKTsKKworCWlteF9t
aXBpX2RzaV9zZXRfaXB1X2RpX211eChkc2ksIG11eCk7Cit9CisKK3N0YXRpYyB2b2lkIGlteF9t
aXBpX2RzaV9lbmNvZGVyX2Rpc2FibGUoc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyKQorewor
fQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9lbmNvZGVyX2hlbHBlcl9mdW5jcyBpbXhfbWlw
aV9kc2lfZW5jb2Rlcl9oZWxwZXJzID0geworCS5tb2RlX2ZpeHVwID0gaW14X21pcGlfZHNpX2Vu
Y29kZXJfbW9kZV9maXh1cCwKKwkuY29tbWl0ID0gaW14X21pcGlfZHNpX2VuY29kZXJfY29tbWl0
LAorCS5kaXNhYmxlID0gaW14X21pcGlfZHNpX2VuY29kZXJfZGlzYWJsZSwKKwkuYXRvbWljX2No
ZWNrID0gaW14X21pcGlfZHNpX2VuY29kZXJfYXRvbWljX2NoZWNrLAorfTsKKworc3RhdGljIGlu
dCBpbXhfbWlwaV9kc2lfcmVnaXN0ZXIoc3RydWN0IGRybV9kZXZpY2UgKmRybSwKKwkJCQkgc3Ry
dWN0IGlteF9taXBpX2RzaSAqZHNpKQoreworCWludCByZXQ7CisKKwlyZXQgPSBpbXhfZHJtX2Vu
Y29kZXJfcGFyc2Vfb2YoZHJtLCAmZHNpLT5lbmNvZGVyLCBkc2ktPmRldi0+b2Zfbm9kZSk7CisJ
aWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCWRybV9lbmNvZGVyX2hlbHBlcl9hZGQoJmRzaS0+
ZW5jb2RlciwKKwkJCSAgICAgICAmaW14X21pcGlfZHNpX2VuY29kZXJfaGVscGVycyk7CisJZHJt
X2VuY29kZXJfaW5pdChkcm0sICZkc2ktPmVuY29kZXIsICZpbXhfbWlwaV9kc2lfZW5jb2Rlcl9m
dW5jcywKKwkJCSBEUk1fTU9ERV9FTkNPREVSX0RTSSwgTlVMTCk7CisJcmV0dXJuIDA7Cit9CisK
K3N0YXRpYyBlbnVtIGRybV9tb2RlX3N0YXR1cyBpbXhfbWlwaV9kc2lfbW9kZV92YWxpZCh2b2lk
ICpwcml2X2RhdGEsCisJCQkJCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlKQor
eworCS8qCisJICogVGhlIFZJRF9QS1RfU0laRSBmaWVsZCBpbiB0aGUgRFNJX1ZJRF9QS1RfQ0ZH
CisJICogcmVnaXN0ZXIgaXMgMTEtYml0LgorCSAqLworCWlmIChtb2RlLT5oZGlzcGxheSA+IDB4
N2ZmKQorCQlyZXR1cm4gTU9ERV9CQURfSFZBTFVFOworCisJLyoKKwkgKiBUaGUgVl9BQ1RJVkVf
TElORVMgZmllbGQgaW4gdGhlIERTSV9WVElNSU5HX0NGRworCSAqIHJlZ2lzdGVyIGlzIDExLWJp
dC4KKwkgKi8KKwlpZiAobW9kZS0+dmRpc3BsYXkgPiAweDdmZikKKwkJcmV0dXJuIE1PREVfQkFE
X1ZWQUxVRTsKKworCXJldHVybiBNT0RFX09LOworfQorCisKK3N0YXRpYyB1bnNpZ25lZCBpbnQg
bWF4X21icHNfdG9fdGVzdGRpbih1bnNpZ25lZCBpbnQgbWF4X21icHMpCit7CisJdW5zaWduZWQg
aW50IGk7CisKKwlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShkcHRkaW5fbWFwKTsgaSsrKQor
CQlpZiAoZHB0ZGluX21hcFtpXS5tYXhfbWJwcyA9PSBtYXhfbWJwcykKKwkJCXJldHVybiBkcHRk
aW5fbWFwW2ldLnRlc3RkaW47CisKKwlyZXR1cm4gLUVJTlZBTDsKK30KKworc3RhdGljIGludCBp
bXhfbWlwaV9kc2lfcGh5X2luaXQodm9pZCAqcHJpdl9kYXRhKQoreworCXN0cnVjdCBpbXhfbWlw
aV9kc2kgKmRzaSA9IHByaXZfZGF0YTsKKwlzdHJ1Y3QgcmVnbWFwICpyZWdzID0gZHNpLT5yZWdz
OworCWludCB0ZXN0ZGluOworCisJdGVzdGRpbiA9IG1heF9tYnBzX3RvX3Rlc3RkaW4oZHNpLT5s
YW5lX21icHMpOworCWlmICh0ZXN0ZGluIDwgMCkgeworCQlkZXZfZXJyKGRzaS0+ZGV2LAorCQkJ
ImZhaWxlZCB0byBnZXQgdGVzdGRpbiBmb3IgJWRtYnBzIGxhbmUgY2xvY2tcbiIsCisJCQlkc2kt
PmxhbmVfbWJwcyk7CisJCXJldHVybiB0ZXN0ZGluOworCX0KKworCXJlZ21hcF93cml0ZShyZWdz
LCBEU0lfUEhZX0lGX0NUUkwsIFBIWV9JRl9DVFJMX1JFU0VUKTsKKwlyZWdtYXBfd3JpdGUocmVn
cywgRFNJX1BXUl9VUCwgUE9XRVJVUCk7CisKKwlyZWdtYXBfd3JpdGUocmVncywgRFNJX1BIWV9U
U1RfQ1RSTDAsIFBIWV9VTlRFU1RDTEsgfCBQSFlfVU5URVNUQ0xSKTsKKwlyZWdtYXBfd3JpdGUo
cmVncywgRFNJX1BIWV9UU1RfQ1RSTDEsIFBIWV9URVNURU4gfCBQSFlfVEVTVERPVVQoMCkgfAor
CQkgICAgIFBIWV9URVNURElOKDB4NDQpKTsKKwlyZWdtYXBfd3JpdGUocmVncywgRFNJX1BIWV9U
U1RfQ1RSTDAsIFBIWV9URVNUQ0xLIHwgUEhZX1VOVEVTVENMUik7CisJcmVnbWFwX3dyaXRlKHJl
Z3MsIERTSV9QSFlfVFNUX0NUUkwwLCBQSFlfVU5URVNUQ0xLIHwgUEhZX1VOVEVTVENMUik7CisJ
cmVnbWFwX3dyaXRlKHJlZ3MsIERTSV9QSFlfVFNUX0NUUkwxLCBQSFlfVU5URVNURU4gfCBQSFlf
VEVTVERPVVQoMCkgfAorCQkgICAgIFBIWV9URVNURElOKHRlc3RkaW4pKTsKKwlyZWdtYXBfd3Jp
dGUocmVncywgRFNJX1BIWV9UU1RfQ1RSTDAsIFBIWV9URVNUQ0xLIHwgUEhZX1VOVEVTVENMUik7
CisJcmVnbWFwX3dyaXRlKHJlZ3MsIERTSV9QSFlfVFNUX0NUUkwwLCBQSFlfVU5URVNUQ0xLIHwg
UEhZX1VOVEVTVENMUik7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBpbXhfbWlwaV9k
c2lfZ2V0X2xhbmVfbWJwcyh2b2lkICpwcml2X2RhdGEsCisJCQkJICAgICAgY29uc3Qgc3RydWN0
IGRybV9kaXNwbGF5X21vZGUgKm1vZGUsCisJCQkJICAgICAgdW5zaWduZWQgbG9uZyBtb2RlX2Zs
YWdzLCB1MzIgbGFuZXMsCisJCQkJICAgICAgdTMyIGZvcm1hdCwgdW5zaWduZWQgaW50ICpsYW5l
X21icHMpCit7CisJc3RydWN0IGlteF9taXBpX2RzaSAqZHNpID0gcHJpdl9kYXRhOworCWludCBi
cHA7CisJdW5zaWduZWQgaW50IGksIHRhcmdldF9tYnBzLCBtcGNsazsKKwl1bnNpZ25lZCBsb25n
IHBsbHJlZjsKKworCWJwcCA9IG1pcGlfZHNpX3BpeGVsX2Zvcm1hdF90b19icHAoZm9ybWF0KTsK
KwlpZiAoYnBwIDwgMCkgeworCQlkZXZfZXJyKGRzaS0+ZGV2LCAiZmFpbGVkIHRvIGdldCBicHAg
Zm9yIHBpeGVsIGZvcm1hdCAlZFxuIiwKKwkJCWZvcm1hdCk7CisJCXJldHVybiBicHA7CisJfQor
CisJcGxscmVmID0gY2xrX2dldF9yYXRlKGRzaS0+cGxscmVmX2Nsayk7CisJaWYgKHBsbHJlZiAh
PSAyNzAwMDAwMCkKKwkJZGV2X3dhcm4oZHNpLT5kZXYsICJleHBlY3QgMjdNSHogRFBIWSBwbGwg
cmVmZXJlbmNlIGNsb2NrXG4iKTsKKworCW1wY2xrID0gRElWX1JPVU5EX1VQKG1vZGUtPmNsb2Nr
LCBNU0VDX1BFUl9TRUMpOworCWlmIChtcGNsaykgeworCQkvKiB0YWtlIDEvMC43IGJsYW5raW5n
IG92ZXJoZWFkIGludG8gY29uc2lkZXJhdGlvbiAqLworCQl0YXJnZXRfbWJwcyA9IChtcGNsayAq
IChicHAgLyBsYW5lcykgKiAxMCkgLyA3OworCX0gZWxzZSB7CisJCWRldl9kYmcoZHNpLT5kZXYs
ICJ1c2UgZGVmYXVsdCAxR2JwcyBEUEhZIHBsbCBjbG9ja1xuIik7CisJCXRhcmdldF9tYnBzID0g
MTAwMDsKKwl9CisKKwlkZXZfZGJnKGRzaS0+ZGV2LCAidGFyZ2V0IERQSFkgcGxsIGNsb2NrIGZy
ZXF1ZW5jeSBpcyAldU1icHNcbiIsCisJCXRhcmdldF9tYnBzKTsKKworCWZvciAoaSA9IDA7IGkg
PCBBUlJBWV9TSVpFKGRwdGRpbl9tYXApOyBpKyspIHsKKwkJaWYgKHRhcmdldF9tYnBzIDwgZHB0
ZGluX21hcFtpXS5tYXhfbWJwcykgeworCQkJKmxhbmVfbWJwcyA9IGRwdGRpbl9tYXBbaV0ubWF4
X21icHM7CisJCQlkc2ktPmxhbmVfbWJwcyA9ICpsYW5lX21icHM7CisJCQlkZXZfZGJnKGRzaS0+
ZGV2LAorCQkJCSJyZWFsIERQSFkgcGxsIGNsb2NrIGZyZXF1ZW5jeSBpcyAldU1icHNcbiIsCisJ
CQkJKmxhbmVfbWJwcyk7CisJCQlyZXR1cm4gMDsKKwkJfQorCX0KKworCWRldl9lcnIoZHNpLT5k
ZXYsICJEUEhZIGNsb2NrIGZyZXF1ZW5jeSAldU1icHMgaXMgb3V0IG9mIHJhbmdlXG4iLAorCQl0
YXJnZXRfbWJwcyk7CisKKwlyZXR1cm4gLUVJTlZBTDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVj
dCBkd19taXBpX2RzaV9waHlfb3BzIGR3X21pcGlfZHNpX3N0bV9waHlfb3BzID0geworCS5pbml0
ID0gaW14X21pcGlfZHNpX3BoeV9pbml0LAorCS5nZXRfbGFuZV9tYnBzID0gaW14X21pcGlfZHNp
X2dldF9sYW5lX21icHMsCit9OworCitzdGF0aWMgc3RydWN0IGR3X21pcGlfZHNpX3BsYXRfZGF0
YSBpbXg2cV9taXBpX2RzaV9kcnZfZGF0YSA9IHsKKwkubWF4X2RhdGFfbGFuZXMgPSAyLAorCS5t
b2RlX3ZhbGlkID0gaW14X21pcGlfZHNpX21vZGVfdmFsaWQsCisJLnBoeV9vcHMgPSAmZHdfbWlw
aV9kc2lfc3RtX3BoeV9vcHMsCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IG9mX2RldmljZV9p
ZCBpbXhfZHNpX2R0X2lkc1tdID0geworCXsKKwkJLmNvbXBhdGlibGUgPSAiZnNsLGlteDZxLW1p
cGktZHNpIiwKKwkJLmRhdGEgPSAmaW14NnFfbWlwaV9kc2lfZHJ2X2RhdGEsCisJfSwKKwl7IC8q
IHNlbnRpbmVsICovIH0KK307CitNT0RVTEVfREVWSUNFX1RBQkxFKG9mLCBpbXhfZHNpX2R0X2lk
cyk7CisKK3N0YXRpYyBpbnQgaW14X21pcGlfZHNpX2JpbmQoc3RydWN0IGRldmljZSAqZGV2LCBz
dHJ1Y3QgZGV2aWNlICptYXN0ZXIsCisJCQkgICAgIHZvaWQgKmRhdGEpCit7CisJc3RydWN0IGlt
eF9taXBpX2RzaSAqZHNpID0gZGV2X2dldF9kcnZkYXRhKGRldik7CisJc3RydWN0IGRybV9kZXZp
Y2UgKmRybSA9IGRhdGE7CisJaW50IHJldDsKKworCXJldCA9IGlteF9taXBpX2RzaV9yZWdpc3Rl
cihkcm0sIGRzaSk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCXJldCA9IGR3X21pcGlf
ZHNpX2JpbmQoZHNpLT5taXBpX2RzaSwgJmRzaS0+ZW5jb2Rlcik7CisJaWYgKHJldCkKKwkJcmV0
dXJuIHJldDsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBpbXhfbWlwaV9kc2lfdW5i
aW5kKHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRldmljZSAqbWFzdGVyLAorCQkJCXZvaWQg
KmRhdGEpCit7CisJc3RydWN0IGlteF9taXBpX2RzaSAqZHNpID0gZGV2X2dldF9kcnZkYXRhKGRl
dik7CisKKwlyZXR1cm4gZHdfbWlwaV9kc2lfdW5iaW5kKGRzaS0+bWlwaV9kc2kpOworfQorCitz
dGF0aWMgY29uc3Qgc3RydWN0IGNvbXBvbmVudF9vcHMgaW14X21pcGlfZHNpX29wcyA9IHsKKwku
YmluZAk9IGlteF9taXBpX2RzaV9iaW5kLAorCS51bmJpbmQJPSBpbXhfbWlwaV9kc2lfdW5iaW5k
LAorfTsKKworc3RhdGljIGludCBpbXhfbWlwaV9kc2lfcHJvYmUoc3RydWN0IHBsYXRmb3JtX2Rl
dmljZSAqcGRldikKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmcGRldi0+ZGV2OworCWNvbnN0
IHN0cnVjdCBvZl9kZXZpY2VfaWQgKm9mX2lkID0gb2ZfbWF0Y2hfZGV2aWNlKGlteF9kc2lfZHRf
aWRzLCBkZXYpOworCWNvbnN0IHN0cnVjdCBkd19taXBpX2RzaV9wbGF0X2RhdGEgKnBkYXRhID0g
b2ZfaWQtPmRhdGE7CisJc3RydWN0IGlteF9taXBpX2RzaSAqZHNpOworCWludCByZXQ7CisKKwlk
c2kgPSBkZXZtX2t6YWxsb2MoZGV2LCBzaXplb2YoKmRzaSksIEdGUF9LRVJORUwpOworCWlmICgh
ZHNpKQorCQlyZXR1cm4gLUVOT01FTTsKKworCWRzaS0+ZGV2ID0gZGV2OworCisJZHNpLT5wbGxy
ZWZfY2xrID0gZGV2bV9jbGtfZ2V0KGRldiwgInJlZiIpOworCWlmIChJU19FUlIoZHNpLT5wbGxy
ZWZfY2xrKSkgeworCQlyZXQgPSBQVFJfRVJSKGRzaS0+cGxscmVmX2Nsayk7CisJCWRldl9kYmco
ZGV2LCAiJXM6IFVuYWJsZSB0byBnZXQgcGxsIHJlZmVyZW5jZSBjbG9jazogJWRcbiIsCisJCQlf
X2Z1bmNfXywgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXQgPSBjbGtfcHJlcGFyZV9l
bmFibGUoZHNpLT5wbGxyZWZfY2xrKTsKKwlpZiAocmV0KSB7CisJCWRldl9lcnIoZGV2LCAiJXM6
IEZhaWxlZCB0byBlbmFibGUgcGxscmVmX2Nsa1xuIiwgX19mdW5jX18pOworCQlyZXR1cm4gcmV0
OworCX0KKworCWRzaS0+bXV4X3NlbCA9IHN5c2Nvbl9yZWdtYXBfbG9va3VwX2J5X3BoYW5kbGUo
ZGV2LT5vZl9ub2RlLCAiZnNsLGdwciIpOworCWlmIChJU19FUlIoZHNpLT5tdXhfc2VsKSkgewor
CQlyZXQgPSBQVFJfRVJSKGRzaS0+bXV4X3NlbCk7CisJCWRldl9lcnIoZGV2LCAiJXM6IEZhaWxl
ZCB0byBnZXQgR1BSIHJlZ21hcDogJWRcbiIsCisJCQlfX2Z1bmNfXywgcmV0KTsKKwkJcmV0dXJu
IHJldDsKKwl9CisKKwlkZXZfc2V0X2RydmRhdGEoZGV2LCBkc2kpOworCisJaW14NnFfbWlwaV9k
c2lfZHJ2X2RhdGEucHJpdl9kYXRhID0gZHNpOworCisJZHNpLT5taXBpX2RzaSA9IGR3X21pcGlf
ZHNpX3Byb2JlKHBkZXYsIHBkYXRhKTsKKwlpZiAoSVNfRVJSKGRzaS0+bWlwaV9kc2kpKSB7CisJ
CXJldCA9IFBUUl9FUlIoZHNpLT5taXBpX2RzaSk7CisJCWRldl9kYmcoZGV2LCAiJXM6IFVuYWJs
ZSB0byBwcm9iZSBEVyBEU0kgaG9zdCBkZXZpY2U6ICVkXG4iLAorCQkJX19mdW5jX18sIHJldCk7
CisJCXJldHVybiAtRU5PREVWOworCX0KKworCWRzaS0+cmVncyA9IHBkYXRhLT5yZWdzOworCisJ
cmV0dXJuIGNvbXBvbmVudF9hZGQoJnBkZXYtPmRldiwgJmlteF9taXBpX2RzaV9vcHMpOworfQor
CitzdGF0aWMgaW50IGlteF9taXBpX2RzaV9yZW1vdmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAq
cGRldikKK3sKKwljb21wb25lbnRfZGVsKCZwZGV2LT5kZXYsICZpbXhfbWlwaV9kc2lfb3BzKTsK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIHN0cnVjdCBwbGF0Zm9ybV9kcml2ZXIgaW14X21pcGlf
ZHNpX2RyaXZlciA9IHsKKwkucHJvYmUJCT0gaW14X21pcGlfZHNpX3Byb2JlLAorCS5yZW1vdmUJ
CT0gaW14X21pcGlfZHNpX3JlbW92ZSwKKwkuZHJpdmVyCQk9IHsKKwkJLm9mX21hdGNoX3RhYmxl
ID0gaW14X2RzaV9kdF9pZHMsCisJCS5uYW1lCT0gRFJJVkVSX05BTUUsCisJfSwKK307Cittb2R1
bGVfcGxhdGZvcm1fZHJpdmVyKGlteF9taXBpX2RzaV9kcml2ZXIpOworCitNT0RVTEVfREVTQ1JJ
UFRJT04oImkuTVg2IE1JUEkgRFNJIGhvc3QgY29udHJvbGxlciBkcml2ZXIiKTsKK01PRFVMRV9B
VVRIT1IoIkxpdSBZaW5nIDxZaW5nLkxpdUBmcmVlc2NhbGUuY29tPiIpOworTU9EVUxFX0xJQ0VO
U0UoIkdQTCIpOworTU9EVUxFX0FMSUFTKCJwbGF0Zm9ybToiIERSSVZFUl9OQU1FKTsKLS0gCjIu
MjQuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJp
LWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
