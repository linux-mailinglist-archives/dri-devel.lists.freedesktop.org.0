Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 4B617ECA65
	for <lists+dri-devel@lfdr.de>; Fri,  1 Nov 2019 22:42:51 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 523816E332;
	Fri,  1 Nov 2019 21:42:46 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-pf1-x441.google.com (mail-pf1-x441.google.com
 [IPv6:2607:f8b0:4864:20::441])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B4B086E332
 for <dri-devel@lists.freedesktop.org>; Fri,  1 Nov 2019 21:42:44 +0000 (UTC)
Received: by mail-pf1-x441.google.com with SMTP id x28so4690527pfo.6
 for <dri-devel@lists.freedesktop.org>; Fri, 01 Nov 2019 14:42:44 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references;
 bh=VaOa2Fn0ho13YlyIy7smXJFz2z6cMZASkkIYfeoVnfA=;
 b=WGHb4s8cYRXNcUKQOsnE+ZIzlH4yk/GEdf7P997yRHiiDWXfQRrdeGC4jThmwiizhS
 Eq6S/0mnwfZUbTD5TKWCEDuc0vosjE69/De5V+zbV9dIMlNch5Mj98uKudqljEi8rhCQ
 BMseKTF27iHIUpPbvq6R1JjnyGfwkzF9KB1nKPV9gkwrpVuMAXFn2q2WE4aDb/wuBPQq
 1d1nzDhsDPkHJSyrGiKeq2CWqUqSQm7glfXsBqqUCyTXuOQukx2KE47Bgl0uiO1k3Nfl
 0Mrh/IjUrhYuTeZNxaY2eMjsxyAv1iysuJucggt6HjW7zdxKeIST2Ni8WJ6IcRI2rD0N
 XW1Q==
X-Gm-Message-State: APjAAAXwAcr3jorue9UVGo2FigybDqbCMAqwjAtMQYP006VZmHgwVmjV
 Da3dnxWp9OptZPLpHvrjU/CjYQ==
X-Google-Smtp-Source: APXvYqwe0LFyeV0Xfd2wdiGE6faYFfArVDBUZ7RRh/qAiHKiuF+VN33xCCs6uyOBH+DTi5OCLF8fbg==
X-Received: by 2002:a63:3082:: with SMTP id
 w124mr13896155pgw.135.1572644564063; 
 Fri, 01 Nov 2019 14:42:44 -0700 (PDT)
Received: from localhost.localdomain ([2601:1c2:680:1319:692:26ff:feda:3a81])
 by smtp.gmail.com with ESMTPSA id
 u36sm8299058pgn.29.2019.11.01.14.42.42
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 01 Nov 2019 14:42:43 -0700 (PDT)
From: John Stultz <john.stultz@linaro.org>
To: lkml <linux-kernel@vger.kernel.org>
Subject: [PATCH v14 2/5] dma-buf: heaps: Add heap helpers
Date: Fri,  1 Nov 2019 21:42:35 +0000
Message-Id: <20191101214238.78015-3-john.stultz@linaro.org>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20191101214238.78015-1-john.stultz@linaro.org>
References: <20191101214238.78015-1-john.stultz@linaro.org>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=linaro.org; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references;
 bh=VaOa2Fn0ho13YlyIy7smXJFz2z6cMZASkkIYfeoVnfA=;
 b=Ljf5PqPuDN/gMIctDymMHc3S9fiu76Wsf0RiP3jbqd/usehwx7/kfOjSrd9FENWtdk
 lckI2mUPraFmq+dwCsda2f7NOJ3mCGQwUcOAplVbtc68F+SeHrSGBZedesBozUO5F0e8
 bX6oKQE97AuC6wCLVdPgNvp9raglL3bvW/mN5f/Gi+edDW8CiSQy3noYUuUu/o9klGvU
 FAAg8Zr//ki9IaWmS6lDlo5NUFZwhfhhCbOINuP6RsZbqnVeLLibCSnKwEEzmDgPWatw
 oeMDD6jHRYI3FM4G+HU9Ht2w5jg8b9yEJetOH4GLAXe+ITJsFhIBnmIPt51XmTLNJ0q1
 1hbw==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Hillf Danton <hdanton@sina.com>, Sudipto Paul <Sudipto.Paul@arm.com>,
 Sandeep Patil <sspatil@google.com>,
 Vincent Donnefort <Vincent.Donnefort@arm.com>, Chenbo Feng <fengc@google.com>,
 Alistair Strachan <astrachan@google.com>, Liam Mark <lmark@codeaurora.org>,
 Christoph Hellwig <hch@infradead.org>, dri-devel@lists.freedesktop.org,
 "Andrew F . Davis" <afd@ti.com>, Hridya Valsaraju <hridya@google.com>,
 Pratik Patel <pratikp@codeaurora.org>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIGdlbmVyaWMgaGVscGVyIGRtYWJ1ZiBvcHMgZm9yIGRtYSBoZWFwcywgc28gd2UgY2FuIHJl
ZHVjZQp0aGUgYW1vdW50IG9mIGR1cGxpY2F0aXZlIGNvZGUgZm9yIHRoZSBleHBvcnRlZCBkbWFi
dWZzLgoKVGhpcyBjb2RlIGlzIGFuIGV2b2x1dGlvbiBvZiB0aGUgQW5kcm9pZCBJT04gaW1wbGVt
ZW50YXRpb24sIHNvCnRoYW5rcyB0byBpdHMgb3JpZ2luYWwgYXV0aG9ycyBhbmQgbWFpbnRhaW50
ZXJzOgogIFJlYmVjY2EgU2NodWx0eiBaYXZpbiwgQ29saW4gQ3Jvc3MsIExhdXJhIEFiYm90dCwg
YW5kIG90aGVycyEKCkNjOiBMYXVyYSBBYmJvdHQgPGxhYmJvdHRAcmVkaGF0LmNvbT4KQ2M6IEJl
bmphbWluIEdhaWduYXJkIDxiZW5qYW1pbi5nYWlnbmFyZEBsaW5hcm8ub3JnPgpDYzogU3VtaXQg
U2Vtd2FsIDxzdW1pdC5zZW13YWxAbGluYXJvLm9yZz4KQ2M6IExpYW0gTWFyayA8bG1hcmtAY29k
ZWF1cm9yYS5vcmc+CkNjOiBQcmF0aWsgUGF0ZWwgPHByYXRpa3BAY29kZWF1cm9yYS5vcmc+CkNj
OiBCcmlhbiBTdGFya2V5IDxCcmlhbi5TdGFya2V5QGFybS5jb20+CkNjOiBWaW5jZW50IERvbm5l
Zm9ydCA8VmluY2VudC5Eb25uZWZvcnRAYXJtLmNvbT4KQ2M6IFN1ZGlwdG8gUGF1bCA8U3VkaXB0
by5QYXVsQGFybS5jb20+CkNjOiBBbmRyZXcgRi4gRGF2aXMgPGFmZEB0aS5jb20+CkNjOiBDaHJp
c3RvcGggSGVsbHdpZyA8aGNoQGluZnJhZGVhZC5vcmc+CkNjOiBDaGVuYm8gRmVuZyA8ZmVuZ2NA
Z29vZ2xlLmNvbT4KQ2M6IEFsaXN0YWlyIFN0cmFjaGFuIDxhc3RyYWNoYW5AZ29vZ2xlLmNvbT4K
Q2M6IEhyaWR5YSBWYWxzYXJhanUgPGhyaWR5YUBnb29nbGUuY29tPgpDYzogU2FuZGVlcCBQYXRp
bCA8c3NwYXRpbEBnb29nbGUuY29tPgpDYzogSGlsbGYgRGFudG9uIDxoZGFudG9uQHNpbmEuY29t
PgpDYzogRGF2ZSBBaXJsaWUgPGFpcmxpZWRAZ21haWwuY29tPgpDYzogZHJpLWRldmVsQGxpc3Rz
LmZyZWVkZXNrdG9wLm9yZwpSZXZpZXdlZC1ieTogQmVuamFtaW4gR2FpZ25hcmQgPGJlbmphbWlu
LmdhaWduYXJkQGxpbmFyby5vcmc+ClJldmlld2VkLWJ5OiBCcmlhbiBTdGFya2V5IDxicmlhbi5z
dGFya2V5QGFybS5jb20+CkFja2VkLWJ5OiBMYXVyYSBBYmJvdHQgPGxhYmJvdHRAcmVkaGF0LmNv
bT4KVGVzdGVkLWJ5OiBBeWFuIEt1bWFyIEhhbGRlciA8YXlhbi5oYWxkZXJAYXJtLmNvbT4KU2ln
bmVkLW9mZi1ieTogSm9obiBTdHVsdHogPGpvaG4uc3R1bHR6QGxpbmFyby5vcmc+Ci0tLQp2MjoK
KiBSZW1vdmVkIGNhY2hlIG1hbmFnZW1lbnQgcGVyZm9ybWFuY2UgaGFjayB0aGF0IEkgaGFkCiAg
YWNjaWRlbnRhbGx5IGZvbGRlZCBpbi4KKiBSZW1vdmVkIHN0YXRzIGNvZGUgdGhhdCB3YXMgaW4g
aGVscGVycwoqIExvdHMgb2YgY2hlY2twYXRjaCBjbGVhbnVwcwp2MzoKKiBVbmlubGluZSBJTklU
X0hFQVBfSEVMUEVSX0JVRkZFUiAoc3VnZ2VzdGVkIGJ5IENocmlzdG9waCkKKiBTd2l0Y2ggdG8g
V0FSTiBvbiBidWZmZXIgZGVzdHJveSBmYWlsdXJlIChzdWdnZXN0ZWQgYnkgQnJpYW4pCiogYnVm
ZmVyLT5rbWFwX2NudCBkZWNyZW1lbnRpbmcgY2xlYW51cCAoc3VnZ2VzdGVkIGJ5IENocmlzdG9w
aCkKKiBFeHRyYSBidWZmZXItPnZhZGRyIGNoZWNraW5nIGluIGRtYV9oZWFwX2RtYV9idWZfa21h
cAogIChzdWdnZXN0ZWQgYnkgQnJpYW4pCiogU3dpdGNoIHRvX2hlbHBlcl9idWZmZXIgZnJvbSBt
YWNybyB0byBpbmxpbmUgZnVuY3Rpb24KICAoc3VnZ2VzdGVkIGJ5IEJlbmphbWluKQoqIFJlbmFt
ZSBrbWFwLT52bWFwIChmb2xkZWQgaW4gZnJvbSBBbmRyZXcpCiogVXNlIHZtYXAgZm9yIHZtYXBw
aW5nIC0gbm90IGJlZ2luX2NwdV9hY2Nlc3MgKGZvbGRlZCBpbiBmcm9tCiAgQW5kcmV3KQoqIERy
b3Aga21hcCBmb3Igbm93LCBhcyBpdHMgb3B0aW9uYWwgKGZvbGRlZCBpbiBmcm9tIEFuZHJldykK
KiBGb2xkIGRtYV9oZWFwX21hcF91c2VyIGludG8gdGhlIHNpbmdsZSBjYWxsZXIgKGZvbGVkIGlu
IGZyb20KICBBbmRyZXcpCiogRm9sZGVkIGluIHBhdGNoIGZyb20gQW5kcmV3IHRvIHRyYWNrIHBh
Z2UgbGlzdCBwZXIgaGVhcCBub3QKICBzZ2xpc3QsIHdoaWNoIHNpbXBsaWZpZXMgdGhlIHRyYWNr
aW5nIGxvZ2ljCnY0OgoqIE1vdmVkIGRtYS1oZWFwLmggY2hhbmdlIG91dCB0byBwcmV2aW91cyBw
YXRjaAp2NjoKKiBNaW5vciBjbGVhbnVwcyBhbmQgdHlwbyBmaXhlcyBzdWdnZXN0ZWQgYnkgQnJp
YW4Kdjc6CiogUmVtb3ZlZCBzdHJheSA7CiogTWFrZSBpbml0X2hlYXBfaGVscGVyX2J1ZmZlciBs
b3dlcmNhc2UsIGFzIHN1Z2dlc3RlZCBieSBDaHJpc3RvcGgKKiBBZGQgZG1hYnVmIGV4cG9ydCBo
ZWxwZXIgdG8gcmVkdWNlIGJvaWxlcnBsYXRlIGNvZGUKdjg6CiogUmVtb3ZlIHVudXNlZCBwcml2
YXRlX2ZsYWdzIHZhbHVlCiogQ29uZGVuc2UgZG1hX2hlYXBfYnVmZmVyIGFuZCBoZWFwX2hlbHBl
cl9idWZmZXIgKHN1Z2dlc3RlZCBieQogIENocmlzdG9waCkKKiBGaXggaW5kZW50YXRpb24gYnkg
dXNpbmcgc2hvcnRlciBhcmd1bWVudCBuYW1lcyAoc3VnZ2VzdGVkIGJ5CiAgQ2hyaXN0b3BoKQoq
IEFkZCBmbHVzaF9rZXJuZWxfdm1hcF9yYW5nZS9pbnZhbGlkYXRlX2tlcm5lbF92bWFwX3Jhbmdl
IGNhbGxzCiAgKHN1Z2dlc3RlZCBieSBDaHJpc3RvcGgpCiogQ2hlY2twYXRjaCB3aGl0ZXNwYWNl
IGZpeHVwcwp2OToKKiBNaW5vciBjbGVhbnVwcyBzdWdnZXN0ZWQgYnkgQnJpYW4gU3RhcmtleQp2
MTA6CiogRml4IG1pc3Npbmcgdm1hbGxvYy5oIGluY2x1c2lvbiBpbiBoZWFwIGhlbHBlcnMgKGZv
dW5kIGJ5CiAga2J1aWxkIHRlc3Qgcm9ib3QgPGxrcEBpbnRlbC5jb20+KQp2MTI6CiogQWRkIHN5
bWJvbCBleHBvcnRzIGZvciBoZWFwcyBhcyBtb2R1bGVzCnYxMzoKKiBSZS1yZW1vdmUgc3ltYm9s
IGV4cG9ydHMsIHBlciBkaXNjdXNzaW9uIHdpdGggQnJpYW4sIGFzIEknbGwKICByZXN1Ym1pdCB0
aGUgY2hhbmdlIGZvciByZXZpZXcgaW5kZXBlbmRlbnRseS4KdjE0OgoqIEZpeCBtaXNzaW5nIGFy
Z21lbnQgdG8gV0FSTigpIGluIGRtYV9oZWFwX2J1ZmZlcl9kZXN0cm95KCkKICBmb3VuZCBhbmQg
Zml4ZWQgYnkgRGFuIENhcnBlbnRlciA8ZGFuLmNhcnBlbnRlckBvcmFjbGUuY29tPgoqIEFkZCBj
aGVjayBpbiBmYXVsdCBoYW5sZGVyIHRoYXQgcGdvZmYgaXNuJ3QgbGFyZ2VyIHRoZW4KICBwYWdl
Y291bnQsIHJlcG9ydGVkIGJ5IERhbiBDYXJwZW50ZXIKCi0tLQogZHJpdmVycy9kbWEtYnVmL01h
a2VmaWxlICAgICAgICAgICAgIHwgICAxICsKIGRyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9NYWtlZmls
ZSAgICAgICB8ICAgMiArCiBkcml2ZXJzL2RtYS1idWYvaGVhcHMvaGVhcC1oZWxwZXJzLmMgfCAy
NzEgKysrKysrKysrKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL2RtYS1idWYvaGVhcHMvaGVh
cC1oZWxwZXJzLmggfCAgNTUgKysrKysrCiA0IGZpbGVzIGNoYW5nZWQsIDMyOSBpbnNlcnRpb25z
KCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9kbWEtYnVmL2hlYXBzL01ha2VmaWxlCiBj
cmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9kbWEtYnVmL2hlYXBzL2hlYXAtaGVscGVycy5jCiBj
cmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9kbWEtYnVmL2hlYXBzL2hlYXAtaGVscGVycy5oCgpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9kbWEtYnVmL01ha2VmaWxlIGIvZHJpdmVycy9kbWEtYnVmL01h
a2VmaWxlCmluZGV4IGNhZWU1ZWIzZDM1MS4uOWMxOTAwMjZiZmFiIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2RtYS1idWYvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9kbWEtYnVmL01ha2VmaWxlCkBAIC0y
LDYgKzIsNyBAQAogb2JqLXkgOj0gZG1hLWJ1Zi5vIGRtYS1mZW5jZS5vIGRtYS1mZW5jZS1hcnJh
eS5vIGRtYS1mZW5jZS1jaGFpbi5vIFwKIAkgZG1hLXJlc3YubyBzZXFuby1mZW5jZS5vCiBvYmot
JChDT05GSUdfRE1BQlVGX0hFQVBTKQkrPSBkbWEtaGVhcC5vCitvYmotJChDT05GSUdfRE1BQlVG
X0hFQVBTKQkrPSBoZWFwcy8KIG9iai0kKENPTkZJR19TWU5DX0ZJTEUpCQkrPSBzeW5jX2ZpbGUu
bwogb2JqLSQoQ09ORklHX1NXX1NZTkMpCQkrPSBzd19zeW5jLm8gc3luY19kZWJ1Zy5vCiBvYmot
JChDT05GSUdfVURNQUJVRikJCSs9IHVkbWFidWYubwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9kbWEt
YnVmL2hlYXBzL01ha2VmaWxlIGIvZHJpdmVycy9kbWEtYnVmL2hlYXBzL01ha2VmaWxlCm5ldyBm
aWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uZGU0OTg5ODExMmRiCi0tLSAvZGV2
L251bGwKKysrIGIvZHJpdmVycy9kbWEtYnVmL2hlYXBzL01ha2VmaWxlCkBAIC0wLDAgKzEsMiBA
QAorIyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAorb2JqLXkJCQkJCSs9IGhlYXAt
aGVscGVycy5vCmRpZmYgLS1naXQgYS9kcml2ZXJzL2RtYS1idWYvaGVhcHMvaGVhcC1oZWxwZXJz
LmMgYi9kcml2ZXJzL2RtYS1idWYvaGVhcHMvaGVhcC1oZWxwZXJzLmMKbmV3IGZpbGUgbW9kZSAx
MDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi45Zjk2NGNhM2Y1OWMKLS0tIC9kZXYvbnVsbAorKysg
Yi9kcml2ZXJzL2RtYS1idWYvaGVhcHMvaGVhcC1oZWxwZXJzLmMKQEAgLTAsMCArMSwyNzEgQEAK
Ky8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisjaW5jbHVkZSA8bGludXgvZGV2
aWNlLmg+CisjaW5jbHVkZSA8bGludXgvZG1hLWJ1Zi5oPgorI2luY2x1ZGUgPGxpbnV4L2Vyci5o
PgorI2luY2x1ZGUgPGxpbnV4L2hpZ2htZW0uaD4KKyNpbmNsdWRlIDxsaW51eC9pZHIuaD4KKyNp
bmNsdWRlIDxsaW51eC9saXN0Lmg+CisjaW5jbHVkZSA8bGludXgvc2xhYi5oPgorI2luY2x1ZGUg
PGxpbnV4L3VhY2Nlc3MuaD4KKyNpbmNsdWRlIDxsaW51eC92bWFsbG9jLmg+CisjaW5jbHVkZSA8
dWFwaS9saW51eC9kbWEtaGVhcC5oPgorCisjaW5jbHVkZSAiaGVhcC1oZWxwZXJzLmgiCisKK3Zv
aWQgaW5pdF9oZWFwX2hlbHBlcl9idWZmZXIoc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVm
ZmVyLAorCQkJICAgICB2b2lkICgqZnJlZSkoc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqKSkK
K3sKKwlidWZmZXItPnByaXZfdmlydCA9IE5VTEw7CisJbXV0ZXhfaW5pdCgmYnVmZmVyLT5sb2Nr
KTsKKwlidWZmZXItPnZtYXBfY250ID0gMDsKKwlidWZmZXItPnZhZGRyID0gTlVMTDsKKwlidWZm
ZXItPnBhZ2Vjb3VudCA9IDA7CisJYnVmZmVyLT5wYWdlcyA9IE5VTEw7CisJSU5JVF9MSVNUX0hF
QUQoJmJ1ZmZlci0+YXR0YWNobWVudHMpOworCWJ1ZmZlci0+ZnJlZSA9IGZyZWU7Cit9CisKK3N0
cnVjdCBkbWFfYnVmICpoZWFwX2hlbHBlcl9leHBvcnRfZG1hYnVmKHN0cnVjdCBoZWFwX2hlbHBl
cl9idWZmZXIgKmJ1ZmZlciwKKwkJCQkJICBpbnQgZmRfZmxhZ3MpCit7CisJREVGSU5FX0RNQV9C
VUZfRVhQT1JUX0lORk8oZXhwX2luZm8pOworCisJZXhwX2luZm8ub3BzID0gJmhlYXBfaGVscGVy
X29wczsKKwlleHBfaW5mby5zaXplID0gYnVmZmVyLT5zaXplOworCWV4cF9pbmZvLmZsYWdzID0g
ZmRfZmxhZ3M7CisJZXhwX2luZm8ucHJpdiA9IGJ1ZmZlcjsKKworCXJldHVybiBkbWFfYnVmX2V4
cG9ydCgmZXhwX2luZm8pOworfQorCitzdGF0aWMgdm9pZCAqZG1hX2hlYXBfbWFwX2tlcm5lbChz
dHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICpidWZmZXIpCit7CisJdm9pZCAqdmFkZHI7CisKKwl2
YWRkciA9IHZtYXAoYnVmZmVyLT5wYWdlcywgYnVmZmVyLT5wYWdlY291bnQsIFZNX01BUCwgUEFH
RV9LRVJORUwpOworCWlmICghdmFkZHIpCisJCXJldHVybiBFUlJfUFRSKC1FTk9NRU0pOworCisJ
cmV0dXJuIHZhZGRyOworfQorCitzdGF0aWMgdm9pZCBkbWFfaGVhcF9idWZmZXJfZGVzdHJveShz
dHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICpidWZmZXIpCit7CisJaWYgKGJ1ZmZlci0+dm1hcF9j
bnQgPiAwKSB7CisJCVdBUk4oMSwgIiVzOiBidWZmZXIgc3RpbGwgbWFwcGVkIGluIHRoZSBrZXJu
ZWxcbiIsIF9fZnVuY19fKTsKKwkJdnVubWFwKGJ1ZmZlci0+dmFkZHIpOworCX0KKworCWJ1ZmZl
ci0+ZnJlZShidWZmZXIpOworfQorCitzdGF0aWMgdm9pZCAqZG1hX2hlYXBfYnVmZmVyX3ZtYXBf
Z2V0KHN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKmJ1ZmZlcikKK3sKKwl2b2lkICp2YWRkcjsK
KworCWlmIChidWZmZXItPnZtYXBfY250KSB7CisJCWJ1ZmZlci0+dm1hcF9jbnQrKzsKKwkJcmV0
dXJuIGJ1ZmZlci0+dmFkZHI7CisJfQorCXZhZGRyID0gZG1hX2hlYXBfbWFwX2tlcm5lbChidWZm
ZXIpOworCWlmIChJU19FUlIodmFkZHIpKQorCQlyZXR1cm4gdmFkZHI7CisJYnVmZmVyLT52YWRk
ciA9IHZhZGRyOworCWJ1ZmZlci0+dm1hcF9jbnQrKzsKKwlyZXR1cm4gdmFkZHI7Cit9CisKK3N0
YXRpYyB2b2lkIGRtYV9oZWFwX2J1ZmZlcl92bWFwX3B1dChzdHJ1Y3QgaGVhcF9oZWxwZXJfYnVm
ZmVyICpidWZmZXIpCit7CisJaWYgKCEtLWJ1ZmZlci0+dm1hcF9jbnQpIHsKKwkJdnVubWFwKGJ1
ZmZlci0+dmFkZHIpOworCQlidWZmZXItPnZhZGRyID0gTlVMTDsKKwl9Cit9CisKK3N0cnVjdCBk
bWFfaGVhcHNfYXR0YWNobWVudCB7CisJc3RydWN0IGRldmljZSAqZGV2OworCXN0cnVjdCBzZ190
YWJsZSB0YWJsZTsKKwlzdHJ1Y3QgbGlzdF9oZWFkIGxpc3Q7Cit9OworCitzdGF0aWMgaW50IGRt
YV9oZWFwX2F0dGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmLAorCQkJICAgc3RydWN0IGRtYV9i
dWZfYXR0YWNobWVudCAqYXR0YWNobWVudCkKK3sKKwlzdHJ1Y3QgZG1hX2hlYXBzX2F0dGFjaG1l
bnQgKmE7CisJc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyID0gZG1hYnVmLT5wcml2
OworCWludCByZXQ7CisKKwlhID0ga3phbGxvYyhzaXplb2YoKmEpLCBHRlBfS0VSTkVMKTsKKwlp
ZiAoIWEpCisJCXJldHVybiAtRU5PTUVNOworCisJcmV0ID0gc2dfYWxsb2NfdGFibGVfZnJvbV9w
YWdlcygmYS0+dGFibGUsIGJ1ZmZlci0+cGFnZXMsCisJCQkJCWJ1ZmZlci0+cGFnZWNvdW50LCAw
LAorCQkJCQlidWZmZXItPnBhZ2Vjb3VudCA8PCBQQUdFX1NISUZULAorCQkJCQlHRlBfS0VSTkVM
KTsKKwlpZiAocmV0KSB7CisJCWtmcmVlKGEpOworCQlyZXR1cm4gcmV0OworCX0KKworCWEtPmRl
diA9IGF0dGFjaG1lbnQtPmRldjsKKwlJTklUX0xJU1RfSEVBRCgmYS0+bGlzdCk7CisKKwlhdHRh
Y2htZW50LT5wcml2ID0gYTsKKworCW11dGV4X2xvY2soJmJ1ZmZlci0+bG9jayk7CisJbGlzdF9h
ZGQoJmEtPmxpc3QsICZidWZmZXItPmF0dGFjaG1lbnRzKTsKKwltdXRleF91bmxvY2soJmJ1ZmZl
ci0+bG9jayk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgZG1hX2hlYXBfZGV0YWNo
KHN0cnVjdCBkbWFfYnVmICpkbWFidWYsCisJCQkgICAgc3RydWN0IGRtYV9idWZfYXR0YWNobWVu
dCAqYXR0YWNobWVudCkKK3sKKwlzdHJ1Y3QgZG1hX2hlYXBzX2F0dGFjaG1lbnQgKmEgPSBhdHRh
Y2htZW50LT5wcml2OworCXN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKmJ1ZmZlciA9IGRtYWJ1
Zi0+cHJpdjsKKworCW11dGV4X2xvY2soJmJ1ZmZlci0+bG9jayk7CisJbGlzdF9kZWwoJmEtPmxp
c3QpOworCW11dGV4X3VubG9jaygmYnVmZmVyLT5sb2NrKTsKKworCXNnX2ZyZWVfdGFibGUoJmEt
PnRhYmxlKTsKKwlrZnJlZShhKTsKK30KKworc3RhdGljCitzdHJ1Y3Qgc2dfdGFibGUgKmRtYV9o
ZWFwX21hcF9kbWFfYnVmKHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFjaG1lbnQsCisJ
CQkJICAgICAgZW51bSBkbWFfZGF0YV9kaXJlY3Rpb24gZGlyZWN0aW9uKQoreworCXN0cnVjdCBk
bWFfaGVhcHNfYXR0YWNobWVudCAqYSA9IGF0dGFjaG1lbnQtPnByaXY7CisJc3RydWN0IHNnX3Rh
YmxlICp0YWJsZTsKKworCXRhYmxlID0gJmEtPnRhYmxlOworCisJaWYgKCFkbWFfbWFwX3NnKGF0
dGFjaG1lbnQtPmRldiwgdGFibGUtPnNnbCwgdGFibGUtPm5lbnRzLAorCQkJZGlyZWN0aW9uKSkK
KwkJdGFibGUgPSBFUlJfUFRSKC1FTk9NRU0pOworCXJldHVybiB0YWJsZTsKK30KKworc3RhdGlj
IHZvaWQgZG1hX2hlYXBfdW5tYXBfZG1hX2J1ZihzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICph
dHRhY2htZW50LAorCQkJCSAgIHN0cnVjdCBzZ190YWJsZSAqdGFibGUsCisJCQkJICAgZW51bSBk
bWFfZGF0YV9kaXJlY3Rpb24gZGlyZWN0aW9uKQoreworCWRtYV91bm1hcF9zZyhhdHRhY2htZW50
LT5kZXYsIHRhYmxlLT5zZ2wsIHRhYmxlLT5uZW50cywgZGlyZWN0aW9uKTsKK30KKworc3RhdGlj
IHZtX2ZhdWx0X3QgZG1hX2hlYXBfdm1fZmF1bHQoc3RydWN0IHZtX2ZhdWx0ICp2bWYpCit7CisJ
c3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEgPSB2bWYtPnZtYTsKKwlzdHJ1Y3QgaGVhcF9oZWxw
ZXJfYnVmZmVyICpidWZmZXIgPSB2bWEtPnZtX3ByaXZhdGVfZGF0YTsKKworCWlmICh2bWYtPnBn
b2ZmID4gYnVmZmVyLT5wYWdlY291bnQpCisJCXJldHVybiBWTV9GQVVMVF9TSUdCVVM7CisKKwl2
bWYtPnBhZ2UgPSBidWZmZXItPnBhZ2VzW3ZtZi0+cGdvZmZdOworCWdldF9wYWdlKHZtZi0+cGFn
ZSk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCB2bV9vcGVyYXRpb25z
X3N0cnVjdCBkbWFfaGVhcF92bV9vcHMgPSB7CisJLmZhdWx0ID0gZG1hX2hlYXBfdm1fZmF1bHQs
Cit9OworCitzdGF0aWMgaW50IGRtYV9oZWFwX21tYXAoc3RydWN0IGRtYV9idWYgKmRtYWJ1Ziwg
c3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEpCit7CisJc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZl
ciAqYnVmZmVyID0gZG1hYnVmLT5wcml2OworCisJaWYgKCh2bWEtPnZtX2ZsYWdzICYgKFZNX1NI
QVJFRCB8IFZNX01BWVNIQVJFKSkgPT0gMCkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwl2bWEtPnZt
X29wcyA9ICZkbWFfaGVhcF92bV9vcHM7CisJdm1hLT52bV9wcml2YXRlX2RhdGEgPSBidWZmZXI7
CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgZG1hX2hlYXBfZG1hX2J1Zl9yZWxlYXNl
KHN0cnVjdCBkbWFfYnVmICpkbWFidWYpCit7CisJc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAq
YnVmZmVyID0gZG1hYnVmLT5wcml2OworCisJZG1hX2hlYXBfYnVmZmVyX2Rlc3Ryb3koYnVmZmVy
KTsKK30KKworc3RhdGljIGludCBkbWFfaGVhcF9kbWFfYnVmX2JlZ2luX2NwdV9hY2Nlc3Moc3Ry
dWN0IGRtYV9idWYgKmRtYWJ1ZiwKKwkJCQkJICAgICBlbnVtIGRtYV9kYXRhX2RpcmVjdGlvbiBk
aXJlY3Rpb24pCit7CisJc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyID0gZG1hYnVm
LT5wcml2OworCXN0cnVjdCBkbWFfaGVhcHNfYXR0YWNobWVudCAqYTsKKwlpbnQgcmV0ID0gMDsK
KworCW11dGV4X2xvY2soJmJ1ZmZlci0+bG9jayk7CisKKwlpZiAoYnVmZmVyLT52bWFwX2NudCkK
KwkJaW52YWxpZGF0ZV9rZXJuZWxfdm1hcF9yYW5nZShidWZmZXItPnZhZGRyLCBidWZmZXItPnNp
emUpOworCisJbGlzdF9mb3JfZWFjaF9lbnRyeShhLCAmYnVmZmVyLT5hdHRhY2htZW50cywgbGlz
dCkgeworCQlkbWFfc3luY19zZ19mb3JfY3B1KGEtPmRldiwgYS0+dGFibGUuc2dsLCBhLT50YWJs
ZS5uZW50cywKKwkJCQkgICAgZGlyZWN0aW9uKTsKKwl9CisJbXV0ZXhfdW5sb2NrKCZidWZmZXIt
PmxvY2spOworCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBkbWFfaGVhcF9kbWFfYnVm
X2VuZF9jcHVfYWNjZXNzKHN0cnVjdCBkbWFfYnVmICpkbWFidWYsCisJCQkJCSAgIGVudW0gZG1h
X2RhdGFfZGlyZWN0aW9uIGRpcmVjdGlvbikKK3sKKwlzdHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVy
ICpidWZmZXIgPSBkbWFidWYtPnByaXY7CisJc3RydWN0IGRtYV9oZWFwc19hdHRhY2htZW50ICph
OworCisJbXV0ZXhfbG9jaygmYnVmZmVyLT5sb2NrKTsKKworCWlmIChidWZmZXItPnZtYXBfY250
KQorCQlmbHVzaF9rZXJuZWxfdm1hcF9yYW5nZShidWZmZXItPnZhZGRyLCBidWZmZXItPnNpemUp
OworCisJbGlzdF9mb3JfZWFjaF9lbnRyeShhLCAmYnVmZmVyLT5hdHRhY2htZW50cywgbGlzdCkg
eworCQlkbWFfc3luY19zZ19mb3JfZGV2aWNlKGEtPmRldiwgYS0+dGFibGUuc2dsLCBhLT50YWJs
ZS5uZW50cywKKwkJCQkgICAgICAgZGlyZWN0aW9uKTsKKwl9CisJbXV0ZXhfdW5sb2NrKCZidWZm
ZXItPmxvY2spOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkICpkbWFfaGVhcF9kbWFf
YnVmX3ZtYXAoc3RydWN0IGRtYV9idWYgKmRtYWJ1ZikKK3sKKwlzdHJ1Y3QgaGVhcF9oZWxwZXJf
YnVmZmVyICpidWZmZXIgPSBkbWFidWYtPnByaXY7CisJdm9pZCAqdmFkZHI7CisKKwltdXRleF9s
b2NrKCZidWZmZXItPmxvY2spOworCXZhZGRyID0gZG1hX2hlYXBfYnVmZmVyX3ZtYXBfZ2V0KGJ1
ZmZlcik7CisJbXV0ZXhfdW5sb2NrKCZidWZmZXItPmxvY2spOworCisJcmV0dXJuIHZhZGRyOwor
fQorCitzdGF0aWMgdm9pZCBkbWFfaGVhcF9kbWFfYnVmX3Z1bm1hcChzdHJ1Y3QgZG1hX2J1ZiAq
ZG1hYnVmLCB2b2lkICp2YWRkcikKK3sKKwlzdHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICpidWZm
ZXIgPSBkbWFidWYtPnByaXY7CisKKwltdXRleF9sb2NrKCZidWZmZXItPmxvY2spOworCWRtYV9o
ZWFwX2J1ZmZlcl92bWFwX3B1dChidWZmZXIpOworCW11dGV4X3VubG9jaygmYnVmZmVyLT5sb2Nr
KTsKK30KKworY29uc3Qgc3RydWN0IGRtYV9idWZfb3BzIGhlYXBfaGVscGVyX29wcyA9IHsKKwku
bWFwX2RtYV9idWYgPSBkbWFfaGVhcF9tYXBfZG1hX2J1ZiwKKwkudW5tYXBfZG1hX2J1ZiA9IGRt
YV9oZWFwX3VubWFwX2RtYV9idWYsCisJLm1tYXAgPSBkbWFfaGVhcF9tbWFwLAorCS5yZWxlYXNl
ID0gZG1hX2hlYXBfZG1hX2J1Zl9yZWxlYXNlLAorCS5hdHRhY2ggPSBkbWFfaGVhcF9hdHRhY2gs
CisJLmRldGFjaCA9IGRtYV9oZWFwX2RldGFjaCwKKwkuYmVnaW5fY3B1X2FjY2VzcyA9IGRtYV9o
ZWFwX2RtYV9idWZfYmVnaW5fY3B1X2FjY2VzcywKKwkuZW5kX2NwdV9hY2Nlc3MgPSBkbWFfaGVh
cF9kbWFfYnVmX2VuZF9jcHVfYWNjZXNzLAorCS52bWFwID0gZG1hX2hlYXBfZG1hX2J1Zl92bWFw
LAorCS52dW5tYXAgPSBkbWFfaGVhcF9kbWFfYnVmX3Z1bm1hcCwKK307CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2RtYS1idWYvaGVhcHMvaGVhcC1oZWxwZXJzLmggYi9kcml2ZXJzL2RtYS1idWYvaGVh
cHMvaGVhcC1oZWxwZXJzLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAw
Li45MTFjOTMxZjdmMDYKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2RtYS1idWYvaGVhcHMv
aGVhcC1oZWxwZXJzLmgKQEAgLTAsMCArMSw1NSBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IEdQTC0yLjAgKi8KKy8qCisgKiBETUFCVUYgSGVhcHMgaGVscGVyIGNvZGUKKyAqCisgKiBD
b3B5cmlnaHQgKEMpIDIwMTEgR29vZ2xlLCBJbmMuCisgKiBDb3B5cmlnaHQgKEMpIDIwMTkgTGlu
YXJvIEx0ZC4KKyAqLworCisjaWZuZGVmIF9IRUFQX0hFTFBFUlNfSAorI2RlZmluZSBfSEVBUF9I
RUxQRVJTX0gKKworI2luY2x1ZGUgPGxpbnV4L2RtYS1oZWFwLmg+CisjaW5jbHVkZSA8bGludXgv
bGlzdC5oPgorCisvKioKKyAqIHN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgLSBoZWxwZXIgYnVm
ZmVyIG1ldGFkYXRhCisgKiBAaGVhcDoJCWJhY2sgcG9pbnRlciB0byB0aGUgaGVhcCB0aGUgYnVm
ZmVyIGNhbWUgZnJvbQorICogQGRtYWJ1ZjoJCWJhY2tpbmcgZG1hLWJ1ZiBmb3IgdGhpcyBidWZm
ZXIKKyAqIEBzaXplOgkJc2l6ZSBvZiB0aGUgYnVmZmVyCisgKiBAZmxhZ3M6CQlidWZmZXIgc3Bl
Y2lmaWMgZmxhZ3MKKyAqIEBwcml2X3ZpcnQJCXBvaW50ZXIgdG8gaGVhcCBzcGVjaWZpYyBwcml2
YXRlIHZhbHVlCisgKiBAbG9jawkJbXV0ZXh0IHRvIHByb3RlY3QgdGhlIGRhdGEgaW4gdGhpcyBz
dHJ1Y3R1cmUKKyAqIEB2bWFwX2NudAkJY291bnQgb2Ygdm1hcCByZWZlcmVuY2VzIG9uIHRoZSBi
dWZmZXIKKyAqIEB2YWRkcgkJdm1hcCdlZCB2aXJ0dWFsIGFkZHJlc3MKKyAqIEBwYWdlY291bnQJ
CW51bWJlciBvZiBwYWdlcyBpbiB0aGUgYnVmZmVyCisgKiBAcGFnZXMJCWxpc3Qgb2YgcGFnZSBw
b2ludGVycworICogQGF0dGFjaG1lbnRzCQlsaXN0IG9mIGRldmljZSBhdHRhY2htZW50cworICoK
KyAqIEBmcmVlCQloZWFwIGNhbGxiYWNrIHRvIGZyZWUgdGhlIGJ1ZmZlcgorICovCitzdHJ1Y3Qg
aGVhcF9oZWxwZXJfYnVmZmVyIHsKKwlzdHJ1Y3QgZG1hX2hlYXAgKmhlYXA7CisJc3RydWN0IGRt
YV9idWYgKmRtYWJ1ZjsKKwlzaXplX3Qgc2l6ZTsKKwl1bnNpZ25lZCBsb25nIGZsYWdzOworCisJ
dm9pZCAqcHJpdl92aXJ0OworCXN0cnVjdCBtdXRleCBsb2NrOworCWludCB2bWFwX2NudDsKKwl2
b2lkICp2YWRkcjsKKwlwZ29mZl90IHBhZ2Vjb3VudDsKKwlzdHJ1Y3QgcGFnZSAqKnBhZ2VzOwor
CXN0cnVjdCBsaXN0X2hlYWQgYXR0YWNobWVudHM7CisKKwl2b2lkICgqZnJlZSkoc3RydWN0IGhl
YXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyKTsKK307CisKK3ZvaWQgaW5pdF9oZWFwX2hlbHBlcl9i
dWZmZXIoc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyLAorCQkJICAgICB2b2lkICgq
ZnJlZSkoc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqKSk7CisKK3N0cnVjdCBkbWFfYnVmICpo
ZWFwX2hlbHBlcl9leHBvcnRfZG1hYnVmKHN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKmJ1ZmZl
ciwKKwkJCQkJICBpbnQgZmRfZmxhZ3MpOworCitleHRlcm4gY29uc3Qgc3RydWN0IGRtYV9idWZf
b3BzIGhlYXBfaGVscGVyX29wczsKKyNlbmRpZiAvKiBfSEVBUF9IRUxQRVJTX0ggKi8KLS0gCjIu
MTcuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJp
LWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
