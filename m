Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id DBBBA615DB
	for <lists+dri-devel@lfdr.de>; Sun,  7 Jul 2019 20:22:46 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B6FF589AC3;
	Sun,  7 Jul 2019 18:22:44 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from perceval.ideasonboard.com (perceval.ideasonboard.com
 [IPv6:2001:4b98:dc2:55:216:3eff:fef7:d647])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8834589AC3
 for <dri-devel@lists.freedesktop.org>; Sun,  7 Jul 2019 18:22:42 +0000 (UTC)
Received: from pendragon.nordic-sky.finnair.com (unknown [38.98.37.142])
 by perceval.ideasonboard.com (Postfix) with ESMTPSA id 5D587334;
 Sun,  7 Jul 2019 20:22:19 +0200 (CEST)
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 09/60] drm/bridge: Add connector-related bridge operations and
 data
Date: Sun,  7 Jul 2019 21:18:46 +0300
Message-Id: <20190707181937.6250-6-laurent.pinchart@ideasonboard.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190707181937.6250-1-laurent.pinchart@ideasonboard.com>
References: <20190707180852.5512-1-laurent.pinchart@ideasonboard.com>
 <20190707181937.6250-1-laurent.pinchart@ideasonboard.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=ideasonboard.com; s=mail; t=1562523761;
 bh=5nTQp0c5AMOda9HkXbXnezL/95UYKWVoGtr3VZWFeEc=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=iYg940iLuz40wkCFAyuCRM4I4xOh9SXHnY9NJ9/p5W1UL9teiYOHa/2M+525l7OBh
 u25SBu2Xateik3LETdkw7NqBg0RPlLFqbjEvMiqb1jCxK4SSWZQWoYtPhrmB6Lroas
 Z+9tay/fzKVOsnv3EMfpLKILpn4BaqnWmErd/LOE=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Maxime Ripard <maxime.ripard@bootlin.com>,
 Sebastian Reichel <sebastian.reichel@collabora.com>,
 Tomi Valkeinen <tomi.valkeinen@ti.com>, Sean Paul <sean@poorly.run>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VG8gc3VwcG9ydCBpbXBsZW1lbnRhdGlvbiBvZiBEUk0gY29ubmVjdG9ycyBvbiB0b3Agb2YgRFJN
IGJyaWRnZXMKaW5zdGVhZCBvZiBieSBicmlkZ2VzLCB0aGUgZHJtX2JyaWRnZSBuZWVkcyB0byBl
eHBvc2UgbmV3IG9wZXJhdGlvbnMgYW5kCmRhdGE6CgotIE91dHB1dCBkZXRlY3Rpb24sIGhvdC1w
bHVnIG5vdGlmaWNhdGlvbiwgbW9kZSByZXRyaWV2YWwgYW5kIEVESUQKICByZXRyaWV2YWwgb3Bl
cmF0aW9ucwotIEJpdG1hc2sgb2Ygc3VwcG9ydGVkIG9wZXJhdGlvbnMKLSBCcmlkZ2Ugb3V0cHV0
IHR5cGUKCkFkZCBhbmQgZG9jdW1lbnQgdGhlc2UuCgpUaHJlZSBuZXcgYnJpZGdlIGhlbHBlciBm
dW5jdGlvbnMgYXJlIGFsc28gYWRkZWQgdG8gaGFuZGxlIGhvdCBwbHVnCm5vdGlmaWNhdGlvbiBp
biBhIHdheSB0aGF0IGlzIGFzIHRyYW5zcGFyZW50IGFzIHBvc3NpYmxlIGZvciB0aGUKYnJpZGdl
cy4KClNpZ25lZC1vZmYtYnk6IExhdXJlbnQgUGluY2hhcnQgPGxhdXJlbnQucGluY2hhcnRAaWRl
YXNvbmJvYXJkLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vZHJtX2JyaWRnZS5jIHwgIDkyICsr
KysrKysrKysrKysrKysrKysKIGluY2x1ZGUvZHJtL2RybV9icmlkZ2UuaCAgICAgfCAxNzAgKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0KIDIgZmlsZXMgY2hhbmdlZCwgMjYxIGlu
c2VydGlvbnMoKyksIDEgZGVsZXRpb24oLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
ZHJtX2JyaWRnZS5jIGIvZHJpdmVycy9ncHUvZHJtL2RybV9icmlkZ2UuYwppbmRleCA1MTk1Nzdm
MzYzZTMuLjNjMmEyNTVkZjdhZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2RybV9icmlk
Z2UuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX2JyaWRnZS5jCkBAIC03MCw2ICs3MCw4IEBA
IHN0YXRpYyBMSVNUX0hFQUQoYnJpZGdlX2xpc3QpOwogICovCiB2b2lkIGRybV9icmlkZ2VfYWRk
KHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UpCiB7CisJbXV0ZXhfaW5pdCgmYnJpZGdlLT5ocGRf
bXV0ZXgpOworCiAJbXV0ZXhfbG9jaygmYnJpZGdlX2xvY2spOwogCWxpc3RfYWRkX3RhaWwoJmJy
aWRnZS0+bGlzdCwgJmJyaWRnZV9saXN0KTsKIAltdXRleF91bmxvY2soJmJyaWRnZV9sb2NrKTsK
QEAgLTg2LDYgKzg4LDggQEAgdm9pZCBkcm1fYnJpZGdlX3JlbW92ZShzdHJ1Y3QgZHJtX2JyaWRn
ZSAqYnJpZGdlKQogCW11dGV4X2xvY2soJmJyaWRnZV9sb2NrKTsKIAlsaXN0X2RlbF9pbml0KCZi
cmlkZ2UtPmxpc3QpOwogCW11dGV4X3VubG9jaygmYnJpZGdlX2xvY2spOworCisJbXV0ZXhfZGVz
dHJveSgmYnJpZGdlLT5ocGRfbXV0ZXgpOwogfQogRVhQT1JUX1NZTUJPTChkcm1fYnJpZGdlX3Jl
bW92ZSk7CiAKQEAgLTQ2Myw2ICs0NjcsOTQgQEAgdm9pZCBkcm1fYXRvbWljX2JyaWRnZV9lbmFi
bGUoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSwKIH0KIEVYUE9SVF9TWU1CT0woZHJtX2F0b21p
Y19icmlkZ2VfZW5hYmxlKTsKIAorLyoqCisgKiBkcm1fYnJpZGdlX2hwZF9lbmFibGUgLSBlbmFi
bGUgaG90IHBsdWcgZGV0ZWN0aW9uIGZvciB0aGUgYnJpZGdlCisgKiBAYnJpZGdlOiBicmlkZ2Ug
Y29udHJvbCBzdHJ1Y3R1cmUKKyAqIEBjYjogaG90LXBsdWcgZGV0ZWN0aW9uIGNhbGxiYWNrCisg
KiBAZGF0YTogZGF0YSB0byBiZSBwYXNzZWQgdG8gdGhlIGhvdC1wbHVnIGRldGVjdGlvbiBjYWxs
YmFjaworICoKKyAqIENhbGwgJmRybV9icmlkZ2VfZnVuY3MuaHBkX2VuYWJsZSBhbmQgcmVnaXN0
ZXIgdGhlIGdpdmVuIEBjYiBhbmQgQGRhdGEgYXMKKyAqIGhvdCBwbHVnIG5vdGlmaWNhdGlvbiBj
YWxsYmFjay4gRnJvbSBub3cgb24gdGhlIEBjYiB3aWxsIGJlIGNhbGxlZCB3aXRoCisgKiBAZGF0
YSB3aGVuIGFuIG91dHB1dCBzdGF0dXMgY2hhbmdlIGlzIGRldGVjdGVkIGJ5IHRoZSBicmlkZ2Us
IHVudGlsIGhvdCBwbHVnCisgKiBub3RpZmljYXRpb24gZ2V0cyBkaXNhYmxlZCB3aXRoIGRybV9i
cmlkZ2VfaHBkX2Rpc2FibGUoKS4KKyAqCisgKiBIb3QgcGx1ZyBkZXRlY3Rpb24gaXMgc3VwcG9y
dGVkIG9ubHkgaWYgdGhlIERSTV9CUklER0VfT1BfSFBEIGZsYWcgaXMgc2V0IGluCisgKiBicmlk
Z2UtPm9wcy4gVGhpcyBmdW5jdGlvbiBzaGFsbCBub3QgYmUgY2FsbGVkIHdoZW4gdGhlIGZsYWcg
aXMgbm90IHNldC4KKyAqCisgKiBPbmx5IG9uZSBob3QgcGx1ZyBkZXRlY3Rpb24gY2FsbGJhY2sg
Y2FuIGJlIHJlZ2lzdGVyZWQgYXQgYSB0aW1lLCBpdCBpcyBhbgorICogZXJyb3IgdG8gY2FsbCB0
aGlzIGZ1bmN0aW9uIHdoZW4gaG90IHBsdWcgZGV0ZWN0aW9uIGlzIGFscmVhZHkgZW5hYmxlZCBm
b3IKKyAqIHRoZSBicmlkZ2UuCisgKi8KK3ZvaWQgZHJtX2JyaWRnZV9ocGRfZW5hYmxlKHN0cnVj
dCBkcm1fYnJpZGdlICpicmlkZ2UsCisJCQkgICB2b2lkICgqY2IpKHZvaWQgKmRhdGEsCisJCQkJ
ICAgICAgZW51bSBkcm1fY29ubmVjdG9yX3N0YXR1cyBzdGF0dXMpLAorCQkJICAgdm9pZCAqZGF0
YSkKK3sKKwlpZiAoIWJyaWRnZSB8fCAhYnJpZGdlLT5mdW5jcy0+aHBkX2VuYWJsZSkKKwkJcmV0
dXJuOworCisJbXV0ZXhfbG9jaygmYnJpZGdlLT5ocGRfbXV0ZXgpOworCisJaWYgKFdBUk4oYnJp
ZGdlLT5ocGRfY2IsICJIb3QgcGx1ZyBkZXRlY3Rpb24gYWxyZWFkeSBlbmFibGVkXG4iKSkKKwkJ
Z290byB1bmxvY2s7CisKKwlicmlkZ2UtPmhwZF9jYiA9IGNiOworCWJyaWRnZS0+aHBkX2RhdGEg
PSBkYXRhOworCisJYnJpZGdlLT5mdW5jcy0+aHBkX2VuYWJsZShicmlkZ2UpOworCit1bmxvY2s6
CisJbXV0ZXhfdW5sb2NrKCZicmlkZ2UtPmhwZF9tdXRleCk7Cit9CitFWFBPUlRfU1lNQk9MX0dQ
TChkcm1fYnJpZGdlX2hwZF9lbmFibGUpOworCisvKioKKyAqIGRybV9icmlkZ2VfaHBkX2Rpc2Fi
bGUgLSBkaXNhYmxlIGhvdCBwbHVnIGRldGVjdGlvbiBmb3IgdGhlIGJyaWRnZQorICogQGJyaWRn
ZTogYnJpZGdlIGNvbnRyb2wgc3RydWN0dXJlCisgKgorICogQ2FsbCAmZHJtX2JyaWRnZV9mdW5j
cy5ocGRfZGlzYWJsZSBhbmQgdW5yZWdpc3RlciB0aGUgaG90IHBsdWcgZGV0ZWN0aW9uCisgKiBj
YWxsYmFjayBwcmV2aW91c2x5IHJlZ2lzdGVyZWQgd2l0aCBkcm1fYnJpZGdlX2hwZF9lbmFibGUo
KS4gT25jZSB0aGlzCisgKiBmdW5jdGlvbiByZXR1cm5zIHRoZSBjYWxsYmFjayB3aWxsIG5vdCBi
ZSBjYWxsZWQgYnkgdGhlIGJyaWRnZSB3aGVuIGFuCisgKiBvdXRwdXQgc3RhdHVzIGNoYW5nZSBv
Y2N1cnMuCisgKgorICogSG90IHBsdWcgZGV0ZWN0aW9uIGlzIHN1cHBvcnRlZCBvbmx5IGlmIHRo
ZSBEUk1fQlJJREdFX09QX0hQRCBmbGFnIGlzIHNldCBpbgorICogYnJpZGdlLT5vcHMuIFRoaXMg
ZnVuY3Rpb24gc2hhbGwgbm90IGJlIGNhbGxlZCB3aGVuIHRoZSBmbGFnIGlzIG5vdCBzZXQuCisg
Ki8KK3ZvaWQgZHJtX2JyaWRnZV9ocGRfZGlzYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdl
KQoreworCWlmICghYnJpZGdlIHx8ICFicmlkZ2UtPmZ1bmNzLT5ocGRfZGlzYWJsZSkKKwkJcmV0
dXJuOworCisJbXV0ZXhfbG9jaygmYnJpZGdlLT5ocGRfbXV0ZXgpOworCWJyaWRnZS0+ZnVuY3Mt
PmhwZF9kaXNhYmxlKGJyaWRnZSk7CisKKwlicmlkZ2UtPmhwZF9jYiA9IE5VTEw7CisJYnJpZGdl
LT5ocGRfZGF0YSA9IE5VTEw7CisJbXV0ZXhfdW5sb2NrKCZicmlkZ2UtPmhwZF9tdXRleCk7Cit9
CitFWFBPUlRfU1lNQk9MX0dQTChkcm1fYnJpZGdlX2hwZF9kaXNhYmxlKTsKKworLyoqCisgKiBk
cm1fYnJpZGdlX2hwZF9ub3RpZnkgLSBub3RpZnkgaG90IHBsdWcgZGV0ZWN0aW9uIGV2ZW50cwor
ICogQGJyaWRnZTogYnJpZGdlIGNvbnRyb2wgc3RydWN0dXJlCisgKiBAc3RhdHVzOiBvdXRwdXQg
Y29ubmVjdGlvbiBzdGF0dXMKKyAqCisgKiBCcmlkZ2UgZHJpdmVycyBzaGFsbCBjYWxsIHRoaXMg
ZnVuY3Rpb24gdG8gcmVwb3J0IGhvdCBwbHVnIGV2ZW50cyB3aGVuIHRoZXkKKyAqIGRldGVjdCBh
IGNoYW5nZSBpbiB0aGUgb3V0cHV0IHN0YXR1cywgd2hlbiBob3QgcGx1ZyBkZXRlY3Rpb24gaGFz
IGJlZW4KKyAqIGVuYWJsZWQgYnkgdGhlICZkcm1fYnJpZGdlX2Z1bmNzLmhwZF9lbmFibGUgY2Fs
bGJhY2suCisgKgorICogVGhpcyBmdW5jdGlvbiBzaGFsbCBiZSBjYWxsZWQgaW4gYSBjb250ZXh0
IHRoYXQgY2FuIHNsZWVwLgorICovCit2b2lkIGRybV9icmlkZ2VfaHBkX25vdGlmeShzdHJ1Y3Qg
ZHJtX2JyaWRnZSAqYnJpZGdlLAorCQkJICAgZW51bSBkcm1fY29ubmVjdG9yX3N0YXR1cyBzdGF0
dXMpCit7CisJbXV0ZXhfbG9jaygmYnJpZGdlLT5ocGRfbXV0ZXgpOworCWlmIChicmlkZ2UtPmhw
ZF9jYikKKwkJYnJpZGdlLT5ocGRfY2IoYnJpZGdlLT5ocGRfZGF0YSwgc3RhdHVzKTsKKwltdXRl
eF91bmxvY2soJmJyaWRnZS0+aHBkX211dGV4KTsKK30KK0VYUE9SVF9TWU1CT0xfR1BMKGRybV9i
cmlkZ2VfaHBkX25vdGlmeSk7CisKICNpZmRlZiBDT05GSUdfT0YKIC8qKgogICogb2ZfZHJtX2Zp
bmRfYnJpZGdlIC0gZmluZCB0aGUgYnJpZGdlIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGRldmljZSBu
b2RlIGluCmRpZmYgLS1naXQgYS9pbmNsdWRlL2RybS9kcm1fYnJpZGdlLmggYi9pbmNsdWRlL2Ry
bS9kcm1fYnJpZGdlLmgKaW5kZXggMDhkYzE1ZjkzZGVkLi5iOTQ0NWFhNWIxZWYgMTAwNjQ0Ci0t
LSBhL2luY2x1ZGUvZHJtL2RybV9icmlkZ2UuaAorKysgYi9pbmNsdWRlL2RybS9kcm1fYnJpZGdl
LmgKQEAgLTIzLDggKzIzLDkgQEAKICNpZm5kZWYgX19EUk1fQlJJREdFX0hfXwogI2RlZmluZSBf
X0RSTV9CUklER0VfSF9fCiAKLSNpbmNsdWRlIDxsaW51eC9saXN0Lmg+CiAjaW5jbHVkZSA8bGlu
dXgvY3R5cGUuaD4KKyNpbmNsdWRlIDxsaW51eC9saXN0Lmg+CisjaW5jbHVkZSA8bGludXgvbXV0
ZXguaD4KICNpbmNsdWRlIDxkcm0vZHJtX21vZGVfb2JqZWN0Lmg+CiAjaW5jbHVkZSA8ZHJtL2Ry
bV9tb2Rlcy5oPgogCkBAIC0zMzQsNiArMzM1LDExMCBAQCBzdHJ1Y3QgZHJtX2JyaWRnZV9mdW5j
cyB7CiAJICovCiAJdm9pZCAoKmF0b21pY19wb3N0X2Rpc2FibGUpKHN0cnVjdCBkcm1fYnJpZGdl
ICpicmlkZ2UsCiAJCQkJICAgIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSk7CisKKwkv
KioKKwkgKiBAZGV0ZWN0OgorCSAqCisJICogQ2hlY2sgaWYgYW55dGhpbmcgaXMgYXR0YWNoZWQg
dG8gdGhlIGJyaWRnZSBvdXRwdXQuCisJICoKKwkgKiBUaGlzIGNhbGxiYWNrIGlzIG9wdGlvbmFs
LCBpZiBub3QgaW1wbGVtZW50ZWQgdGhlIGJyaWRnZSB3aWxsIGJlCisJICogY29uc2lkZXJlZCBh
cyBhbHdheXMgaGF2aW5nIGEgY29tcG9uZW50IGF0dGFjaGVkIHRvIGl0cyBvdXRwdXQuCisJICog
QnJpZGdlcyB0aGF0IGltcGxlbWVudCB0aGlzIGNhbGxiYWNrIHNoYWxsIHNldCB0aGUKKwkgKiBE
Uk1fQlJJREdFX09QX0RFVEVDVCBmbGFnIGluIHRoZWlyICZkcm1fYnJpZGdlLT5vcHMuCisJICoK
KwkgKiBSRVRVUk5TOgorCSAqCisJICogZHJtX2Nvbm5lY3Rvcl9zdGF0dXMgaW5kaWNhdGluZyB0
aGUgYnJpZGdlIG91dHB1dCBzdGF0dXMuCisJICovCisJZW51bSBkcm1fY29ubmVjdG9yX3N0YXR1
cyAoKmRldGVjdCkoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSk7CisKKwkvKioKKwkgKiBAZ2V0
X21vZGVzOgorCSAqCisJICogRmlsbCBhbGwgbW9kZXMgY3VycmVudGx5IHZhbGlkIGZvciB0aGUg
c2luayBpbnRvIHRoZSAmZHJtX2Nvbm5lY3RvcgorCSAqIHdpdGggZHJtX21vZGVfcHJvYmVkX2Fk
ZCgpLgorCSAqCisJICogVGhlIEBnZXRfbW9kZXMgY2FsbGJhY2sgaXMgbW9zdGx5IGludGVuZGVk
IHRvIHN1cHBvcnQgbm9uLXByb2JhYmxlCisJICogZGlzcGxheXMgc3VjaCBhcyBtYW55IGZpeGVk
IHBhbmVscy4gQnJpZGdlcyB0aGF0IHN1cHBvcnQgcmVhZGluZworCSAqIEVESUQgc2hhbGwgbGVh
dmUgQGdldF9tb2RlcyB1bmltcGxlbWVudGVkIGFuZCBpbXBsZW1lbnQgdGhlCisJICogJmRybV9i
cmlkZ2VfZnVuY3MtPmdldF9lZGlkIGNhbGxiYWNrIGluc3RlYWQuCisJICoKKwkgKiBUaGlzIGNh
bGxiYWNrIGlzIG9wdGlvbmFsLiBCcmlkZ2VzIHRoYXQgaW1wbGVtZW50IGl0IHNoYWxsIHNldCB0
aGUKKwkgKiBEUk1fQlJJREdFX09QX01PREVTIGZsYWcgaW4gdGhlaXIgJmRybV9icmlkZ2UtPm9w
cy4KKwkgKgorCSAqIFJFVFVSTlM6CisJICoKKwkgKiBUaGUgbnVtYmVyIG9mIG1vZGVzIGFkZGVk
IGJ5IGNhbGxpbmcgZHJtX21vZGVfcHJvYmVkX2FkZCgpLgorCSAqLworCWludCAoKmdldF9tb2Rl
cykoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSwKKwkJCSBzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAq
Y29ubmVjdG9yKTsKKworCS8qKgorCSAqIEBnZXRfZWRpZDoKKwkgKgorCSAqIFJlYWQgYW5kIHBh
cnNlIHRoZSBFRElEIGRhdGEgb2YgdGhlIGNvbm5lY3RlZCBkaXNwbGF5LgorCSAqCisJICogVGhl
IEBnZXRfZWRpZCBjYWxsYmFjayBpcyB0aGUgcHJlZmVycmVkIHdheSBvZiByZXBvcnRpbmcgbW9k
ZQorCSAqIGluZm9ybWF0aW9uIGZvciBhIGRpc3BsYXkgY29ubmVjdGVkIHRvIHRoZSBicmlkZ2Ug
b3V0cHV0LiBCcmlkZ2VzCisJICogdGhhdCBzdXBwb3J0IHJlYWRpbmQgRURJRCBzaGFsbCBpbXBs
ZW1lbnQgdGhpcyBjYWxsYmFjayBhbmQgbGVhdmUKKwkgKiB0aGUgQGdldF9tb2RlcyBjYWxsYmFj
ayB1bmltcGxlbWVudGVkLgorCSAqCisJICogVGhlIGNhbGxlciBvZiB0aGlzIG9wZXJhdGlvbiBz
aGFsbCBmaXJzdCB2ZXJpZnkgdGhlIG91dHB1dAorCSAqIGNvbm5lY3Rpb24gc3RhdHVzIGFuZCBy
ZWZyYWluIGZyb20gcmVhZGluZyBFRElEIGZyb20gYSBkaXNjb25uZWN0ZWQKKwkgKiBvdXRwdXQu
CisJICoKKwkgKiBUaGlzIGNhbGxiYWNrIGlzIG9wdGlvbmFsLiBCcmlkZ2VzIHRoYXQgaW1wbGVt
ZW50IGl0IHNoYWxsIHNldCB0aGUKKwkgKiBEUk1fQlJJREdFX09QX0VESUQgZmxhZyBpbiB0aGVp
ciAmZHJtX2JyaWRnZS0+b3BzLgorCSAqCisJICogUkVUVVJOUzoKKwkgKgorCSAqIEFuIGVkaWQg
c3RydWN0dXJlIG5ld2x5IGFsbG9jYXRlZCB3aXRoIGttYWxsb2MoKSAob3Igc2ltaWxhcikgb24K
KwkgKiBzdWNjZXNzLCBvciBOVUxMIG90aGVyd2lzZS4gVGhlIGNhbGxlciBpcyByZXNwb25zaWJs
ZSBmb3IgZnJlZWluZworCSAqIHRoZSByZXR1cm5lZCBlZGlkIHN0cnVjdHVyZSB3aXRoIGtmcmVl
KCkuCisJICovCisJc3RydWN0IGVkaWQgKigqZ2V0X2VkaWQpKHN0cnVjdCBkcm1fYnJpZGdlICpi
cmlkZ2UsCisJCQkJIHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpOworCisJLyoqCisJ
ICogQGxvc3RfaG90cGx1ZzoKKwkgKgorCSAqIE5vdGlmeSB0aGUgYnJpZGdlIG9mIGRpc3BsYXkg
ZGlzY29ubmVjdGlvbi4KKwkgKgorCSAqIFRoaXMgY2FsbGJhY2sgaXMgb3B0aW9uYWwsIGl0IG1h
eSBiZSBpbXBsZW1lbnRlZCBieSBicmlkZ2VzIHRoYXQKKwkgKiBuZWVkIHRvIGJlIG5vdGlmaWVk
IG9mIGRpc3BsYXkgZGlzY29ubmVjdGlvbiBmb3IgaW50ZXJuYWwgcmVhc29ucy4KKwkgKiBPbmUg
dXNlIGNhc2UgaXMgdG8gcmVzZXQgdGhlIGludGVybmFsIHN0YXRlIG9mIENFQyBjb250cm9sbGVy
cyBmb3IKKwkgKiBIRE1JIGJyaWRnZXMuCisJICovCisJdm9pZCAoKmxvc3RfaG90cGx1Zykoc3Ry
dWN0IGRybV9icmlkZ2UgKmJyaWRnZSk7CisKKwkvKioKKwkgKiBAaHBkX2VuYWJsZToKKwkgKgor
CSAqIEVuYWJsZSBob3QgcGx1ZyBkZXRlY3Rpb24uIEZyb20gbm93IG9uIHRoZSBicmlkZ2Ugc2hh
bGwgY2FsbAorCSAqIGRybV9icmlkZ2VfaHBkX25vdGlmeSgpIGVhY2ggdGltZSBhIGNoYW5nZSBp
cyBkZXRlY3RlZCBpbiB0aGUgb3V0cHV0CisJICogY29ubmVjdGlvbiBzdGF0dXMsIHVudGlsIGhv
dCBwbHVnIGRldGVjdGlvbiBnZXRzIGRpc2FibGVkIHdpdGgKKwkgKiBAaHBkX2Rpc2FibGUuCisJ
ICoKKwkgKiBUaGlzIGNhbGxiYWNrIGlzIG9wdGlvbmFsIGFuZCBzaGFsbCBvbmx5IGJlIGltcGxl
bWVudGVkIGJ5IGJyaWRnZXMKKwkgKiB0aGF0IHN1cHBvcnQgaG90LXBsdWcgbm90aWZpY2F0aW9u
IHdpdGhvdXQgcG9sbGluZy4gQnJpZGdlcyB0aGF0CisJICogaW1wbGVtZW50IGl0IHNoYWxsIGFs
c28gaW1wbGVtZW50IHRoZSBAaHBkX2Rpc2FibGUgY2FsbGJhY2sgYW5kIHNldAorCSAqIHRoZSBE
Uk1fQlJJREdFX09QX0hQRCBmbGFnIGluIHRoZWlyICZkcm1fYnJpZGdlLT5vcHMuCisJICovCisJ
dm9pZCAoKmhwZF9lbmFibGUpKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UpOworCisJLyoqCisJ
ICogQGhwZF9kaXNhYmxlOgorCSAqCisJICogRGlzYWJsZSBob3QgcGx1ZyBkZXRlY3Rpb24uIE9u
Y2UgdGhpcyBmdW5jdGlvbiByZXR1cm5zIHRoZSBicmlkZ2UKKwkgKiBzaGFsbCBub3QgY2FsbCBk
cm1fYnJpZGdlX2hwZF9ub3RpZnkoKSB3aGVuIGEgY2hhbmdlIGluIHRoZSBvdXRwdXQKKwkgKiBj
b25uZWN0aW9uIHN0YXR1cyBvY2N1cnMuCisJICoKKwkgKiBUaGlzIGNhbGxiYWNrIGlzIG9wdGlv
bmFsIGFuZCBzaGFsbCBvbmx5IGJlIGltcGxlbWVudGVkIGJ5IGJyaWRnZXMKKwkgKiB0aGF0IHN1
cHBvcnQgaG90LXBsdWcgbm90aWZpY2F0aW9uIHdpdGhvdXQgcG9sbGluZy4gQnJpZGdlcyB0aGF0
CisJICogaW1wbGVtZW50IGl0IHNoYWxsIGFsc28gaW1wbGVtZW50IHRoZSBAaHBkX2VuYWJsZSBj
YWxsYmFjayBhbmQgc2V0CisJICogdGhlIERSTV9CUklER0VfT1BfSFBEIGZsYWcgaW4gdGhlaXIg
JmRybV9icmlkZ2UtPm9wcy4KKwkgKi8KKwl2b2lkICgqaHBkX2Rpc2FibGUpKHN0cnVjdCBkcm1f
YnJpZGdlICpicmlkZ2UpOwogfTsKIAogLyoqCkBAIC0zNzIsNiArNDc3LDM4IEBAIHN0cnVjdCBk
cm1fYnJpZGdlX3RpbWluZ3MgewogCWJvb2wgZHVhbF9saW5rOwogfTsKIAorLyoqCisgKiBlbnVt
IGRybV9icmlkZ2Vfb3BzIC0gQml0bWFzayBvZiBvcGVyYXRpb25zIHN1cHBvcnRlZCBieSB0aGUg
YnJpZGdlCisgKi8KK2VudW0gZHJtX2JyaWRnZV9vcHMgeworCS8qKgorCSAqIEBEUk1fQlJJREdF
X09QX0RFVEVDVDogVGhlIGJyaWRnZSBjYW4gZGV0ZWN0IGRpc3BsYXlzIGNvbm5lY3RlZCB0bwor
CSAqIGl0cyBvdXRwdXQuIEJyaWRnZXMgdGhhdCBzZXQgdGhpcyBmbGFnIHNoYWxsIGltcGxlbWVu
dCB0aGUKKwkgKiAmZHJtX2JyaWRnZV9mdW5jcy0+ZGV0ZWN0IGNhbGxiYWNrLgorCSAqLworCURS
TV9CUklER0VfT1BfREVURUNUID0gQklUKDApLAorCS8qKgorCSAqIEBEUk1fQlJJREdFX09QX0VE
SUQ6IFRoZSBicmlkZ2UgY2FuIHJldHJpZXZlIHRoZSBFRElEIG9mIHRoZSBkaXNwbGF5CisJICog
Y29ubmVjdGVkIHRvIGl0cyBvdXRwdXQuIEJyaWRnZXMgdGhhdCBzZXQgdGhpcyBmbGFnIHNoYWxs
IGltcGxlbWVudAorCSAqIHRoZSAmZHJtX2JyaWRnZV9mdW5jcy0+Z2V0X2VkaWQgY2FsbGJhY2su
CisJICovCisJRFJNX0JSSURHRV9PUF9FRElEID0gQklUKDEpLAorCS8qKgorCSAqIEBEUk1fQlJJ
REdFX09QX0hQRDogVGhlIGJyaWRnZSBjYW4gZGV0ZWN0IGhvdC1wbHVnIGFuZCBob3QtdW5wbHVn
CisJICogd2l0aG91dCByZXF1aXJpbmcgcG9sbGluZy4gQnJpZGdlcyB0aGF0IHNldCB0aGlzIGZs
YWcgc2hhbGwKKwkgKiBpbXBsZW1lbnQgdGhlICZkcm1fYnJpZGdlX2Z1bmNzLT5ocGRfZW5hYmxl
IGFuZAorCSAqICZkcm1fYnJpZGdlX2Z1bmNzLT5kaXNhYmxlX2hwZF9jYiBjYWxsYmFja3MuCisJ
ICovCisJRFJNX0JSSURHRV9PUF9IUEQgPSBCSVQoMiksCisJLyoqCisJICogQERSTV9CUklER0Vf
T1BfTU9ERVM6IFRoZSBicmlkZ2UgY2FuIHJldHJpZXZpbmcgdGhlIG1vZGVzIHN1cHBvcnRlZAor
CSAqIGJ5IHRoZSBkaXNwbGF5IGF0IGl0cyBvdXRwdXQuIFRoaXMgZG9lcyBub3QgaW5jbHVkZSBy
ZWFkaW5kIEVESUQKKwkgKiB3aGljaCBpcyBzZXBhcmF0ZWx5IGNvdmVyZWQgYnkgQERSTV9CUklE
R0VfT1BfRURJRC4gQnJpZGdlcyB0aGF0IHNldAorCSAqIHRoaXMgZmxhZyBzaGFsbCBpbXBsZW1l
bnQgdGhlICZkcm1fYnJpZGdlX2Z1bmNzLT5nZXRfbW9kZXMgY2FsbGJhY2suCisJICovCisJRFJN
X0JSSURHRV9PUF9NT0RFUyA9IEJJVCgzKSwKK307CisKIC8qKgogICogc3RydWN0IGRybV9icmlk
Z2UgLSBjZW50cmFsIERSTSBicmlkZ2UgY29udHJvbCBzdHJ1Y3R1cmUKICAqLwpAQCAtMzk4LDYg
KzUzNSwyOSBAQCBzdHJ1Y3QgZHJtX2JyaWRnZSB7CiAJY29uc3Qgc3RydWN0IGRybV9icmlkZ2Vf
ZnVuY3MgKmZ1bmNzOwogCS8qKiBAZHJpdmVyX3ByaXZhdGU6IHBvaW50ZXIgdG8gdGhlIGJyaWRn
ZSBkcml2ZXIncyBpbnRlcm5hbCBjb250ZXh0ICovCiAJdm9pZCAqZHJpdmVyX3ByaXZhdGU7CisJ
LyoqIEBvcHM6IGJpdG1hc2sgb2Ygb3BlcmF0aW9ucyBzdXBwb3J0ZWQgYnkgdGhlIGJyaWRnZSAq
LworCWVudW0gZHJtX2JyaWRnZV9vcHMgb3BzOworCS8qKgorCSAqIEB0eXBlOiBUeXBlIG9mIHRo
ZSBjb25uZWN0aW9uIGF0IHRoZSBicmlkZ2Ugb3V0cHV0CisJICogKERSTV9NT0RFX0NPTk5FQ1RP
Ul8qKS4gRm9yIGJyaWRnZXMgYXQgdGhlIGVuZCBvZiB0aGlzIGNoYWluIHRoaXMKKwkgKiBpZGVu
dGlmaWVzIHRoZSB0eXBlIG9mIGNvbm5lY3RlZCBkaXNwbGF5LgorCSAqLworCWludCB0eXBlOwor
CS8qKiBwcml2YXRlOiAqLworCS8qKgorCSAqIEBocGRfbXV0ZXg6IFByb3RlY3RzIHRoZSBAaHBk
X2NiIGFuZCBAaHBkX2RhdGEgZmllbGRzLgorCSAqLworCXN0cnVjdCBtdXRleCBocGRfbXV0ZXg7
CisJLyoqCisJICogQGhwZF9jYjogSG90IHBsdWcgZGV0ZWN0aW9uIGNhbGxiYWNrLCByZWdpc3Rl
cmVkIHdpdGgKKwkgKiBkcm1fYnJpZGdlX2hwZF9lbmFibGUoKS4KKwkgKi8KKwl2b2lkICgqaHBk
X2NiKSh2b2lkICpkYXRhLCBlbnVtIGRybV9jb25uZWN0b3Jfc3RhdHVzIHN0YXR1cyk7CisJLyoq
CisJICogQGhwZF9kYXRhOiBQcml2YXRlIGRhdGEgcGFzc2VkIHRvIHRoZSBIb3QgcGx1ZyBkZXRl
Y3Rpb24gY2FsbGJhY2sKKwkgKiBAaHBkX2NiLgorCSAqLworCXZvaWQgKmhwZF9kYXRhOwogfTsK
IAogdm9pZCBkcm1fYnJpZGdlX2FkZChzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKTsKQEAgLTQy
OCw2ICs1ODgsMTQgQEAgdm9pZCBkcm1fYXRvbWljX2JyaWRnZV9wcmVfZW5hYmxlKHN0cnVjdCBk
cm1fYnJpZGdlICpicmlkZ2UsCiB2b2lkIGRybV9hdG9taWNfYnJpZGdlX2VuYWJsZShzdHJ1Y3Qg
ZHJtX2JyaWRnZSAqYnJpZGdlLAogCQkJICAgICAgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0
YXRlKTsKIAordm9pZCBkcm1fYnJpZGdlX2hwZF9lbmFibGUoc3RydWN0IGRybV9icmlkZ2UgKmJy
aWRnZSwKKwkJCSAgIHZvaWQgKCpjYikodm9pZCAqZGF0YSwKKwkJCQkgICAgICBlbnVtIGRybV9j
b25uZWN0b3Jfc3RhdHVzIHN0YXR1cyksCisJCQkgICB2b2lkICpkYXRhKTsKK3ZvaWQgZHJtX2Jy
aWRnZV9ocGRfZGlzYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKTsKK3ZvaWQgZHJtX2Jy
aWRnZV9ocGRfbm90aWZ5KHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UsCisJCQkgICBlbnVtIGRy
bV9jb25uZWN0b3Jfc3RhdHVzIHN0YXR1cyk7CisKICNpZmRlZiBDT05GSUdfRFJNX1BBTkVMX0JS
SURHRQogc3RydWN0IGRybV9icmlkZ2UgKmRybV9wYW5lbF9icmlkZ2VfYWRkKHN0cnVjdCBkcm1f
cGFuZWwgKnBhbmVsLAogCQkJCQl1MzIgY29ubmVjdG9yX3R5cGUpOwotLSAKUmVnYXJkcywKCkxh
dXJlbnQgUGluY2hhcnQKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9w
Lm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1k
ZXZlbA==
