Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id ABE62E0203
	for <lists+dri-devel@lfdr.de>; Tue, 22 Oct 2019 12:25:41 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D34EC6E5AE;
	Tue, 22 Oct 2019 10:25:37 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 27AF96E59B
 for <dri-devel@lists.freedesktop.org>; Tue, 22 Oct 2019 10:25:30 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id C1AC5AC6E;
 Tue, 22 Oct 2019 10:25:27 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: kraxel@redhat.com, noralf@tronnes.org, sam@ravnborg.org, daniel@ffwll.ch,
 airlied@linux.ie, joel@jms.id.au, andrew@aj.id.au,
 z.liuxinliang@hisilicon.com, zourongrong@gmail.com,
 kong.kongxinwei@hisilicon.com, puck.chen@hisilicon.com,
 linus.walleij@linaro.org, marex@denx.de, stefan@agner.ch,
 shawnguo@kernel.org, s.hauer@pengutronix.de, kernel@pengutronix.de,
 festevam@gmail.com, linux-imx@nxp.com, eric@anholt.net,
 david@lechnology.com, hdegoede@redhat.com,
 oleksandr_andrushchenko@epam.com, liviu.dudau@arm.com, ck.hu@mediatek.com
Subject: [PATCH 5/5] drm/vboxvideo: Replace prepare_fb()/cleanup_fb() with GEM
 VRAM helpers
Date: Tue, 22 Oct 2019 12:25:20 +0200
Message-Id: <20191022102520.13181-6-tzimmermann@suse.de>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191022102520.13181-1-tzimmermann@suse.de>
References: <20191022102520.13181-1-tzimmermann@suse.de>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Zimmermann <tzimmermann@suse.de>, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

R0VNIFZSQU0gcHJvdmlkZXMgYW4gaW1wbGVtZW50YXRpb24gZm9yIHByZXBhcmVfZmIoKSBhbmQg
Y2xlYW51cF9mYigpCm9mIHN0cnVjdCBkcm1fcGxhbmVfaGVscGVyX2Z1bmNzLiBTd2l0Y2ggb3Zl
ciB2Ym94dmlkZW8uCgpTaWduZWQtb2ZmLWJ5OiBUaG9tYXMgWmltbWVybWFubiA8dHppbW1lcm1h
bm5Ac3VzZS5kZT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vdmJveHZpZGVvL3Zib3hfbW9kZS5jIHwg
NjEgKystLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAxIGZpbGUgY2hhbmdlZCwgNCBpbnNlcnRp
b25zKCspLCA1NyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdmJv
eHZpZGVvL3Zib3hfbW9kZS5jIGIvZHJpdmVycy9ncHUvZHJtL3Zib3h2aWRlby92Ym94X21vZGUu
YwppbmRleCBiNTYwNGQzMjEyMmUuLmI5MzAwMWNmYTBlNiAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL3Zib3h2aWRlby92Ym94X21vZGUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdmJveHZp
ZGVvL3Zib3hfbW9kZS5jCkBAIC0zMzQsMzUgKzMzNCw2IEBAIHN0YXRpYyB2b2lkIHZib3hfcHJp
bWFyeV9hdG9taWNfZGlzYWJsZShzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKIAkJCQkgICAgb2xk
X3N0YXRlLT5zcmNfeSA+PiAxNik7CiB9CiAKLXN0YXRpYyBpbnQgdmJveF9wcmltYXJ5X3ByZXBh
cmVfZmIoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsCi0JCQkJICAgc3RydWN0IGRybV9wbGFuZV9z
dGF0ZSAqbmV3X3N0YXRlKQotewotCXN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm87Ci0J
aW50IHJldDsKLQotCWlmICghbmV3X3N0YXRlLT5mYikKLQkJcmV0dXJuIDA7Ci0KLQlnYm8gPSBk
cm1fZ2VtX3ZyYW1fb2ZfZ2VtKG5ld19zdGF0ZS0+ZmItPm9ialswXSk7Ci0JcmV0ID0gZHJtX2dl
bV92cmFtX3BpbihnYm8sIERSTV9HRU1fVlJBTV9QTF9GTEFHX1ZSQU0pOwotCWlmIChyZXQpCi0J
CURSTV9XQVJOKCJFcnJvciAlZCBwaW5uaW5nIG5ldyBmYiwgb3V0IG9mIHZpZGVvIG1lbT9cbiIs
IHJldCk7Ci0KLQlyZXR1cm4gcmV0OwotfQotCi1zdGF0aWMgdm9pZCB2Ym94X3ByaW1hcnlfY2xl
YW51cF9mYihzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKLQkJCQkgICAgc3RydWN0IGRybV9wbGFu
ZV9zdGF0ZSAqb2xkX3N0YXRlKQotewotCXN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm87
Ci0KLQlpZiAoIW9sZF9zdGF0ZS0+ZmIpCi0JCXJldHVybjsKLQotCWdibyA9IGRybV9nZW1fdnJh
bV9vZl9nZW0ob2xkX3N0YXRlLT5mYi0+b2JqWzBdKTsKLQlkcm1fZ2VtX3ZyYW1fdW5waW4oZ2Jv
KTsKLX0KLQogc3RhdGljIGludCB2Ym94X2N1cnNvcl9hdG9taWNfY2hlY2soc3RydWN0IGRybV9w
bGFuZSAqcGxhbmUsCiAJCQkJICAgIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm5ld19zdGF0ZSkK
IHsKQEAgLTQ5MiwzMCArNDYzLDYgQEAgc3RhdGljIHZvaWQgdmJveF9jdXJzb3JfYXRvbWljX2Rp
c2FibGUoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsCiAJbXV0ZXhfdW5sb2NrKCZ2Ym94LT5od19t
dXRleCk7CiB9CiAKLXN0YXRpYyBpbnQgdmJveF9jdXJzb3JfcHJlcGFyZV9mYihzdHJ1Y3QgZHJt
X3BsYW5lICpwbGFuZSwKLQkJCQkgIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm5ld19zdGF0ZSkK
LXsKLQlzdHJ1Y3QgZHJtX2dlbV92cmFtX29iamVjdCAqZ2JvOwotCi0JaWYgKCFuZXdfc3RhdGUt
PmZiKQotCQlyZXR1cm4gMDsKLQotCWdibyA9IGRybV9nZW1fdnJhbV9vZl9nZW0obmV3X3N0YXRl
LT5mYi0+b2JqWzBdKTsKLQlyZXR1cm4gZHJtX2dlbV92cmFtX3BpbihnYm8sIERSTV9HRU1fVlJB
TV9QTF9GTEFHX1NZU1RFTSk7Ci19Ci0KLXN0YXRpYyB2b2lkIHZib3hfY3Vyc29yX2NsZWFudXBf
ZmIoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsCi0JCQkJICAgc3RydWN0IGRybV9wbGFuZV9zdGF0
ZSAqb2xkX3N0YXRlKQotewotCXN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm87Ci0KLQlp
ZiAoIXBsYW5lLT5zdGF0ZS0+ZmIpCi0JCXJldHVybjsKLQotCWdibyA9IGRybV9nZW1fdnJhbV9v
Zl9nZW0ocGxhbmUtPnN0YXRlLT5mYi0+b2JqWzBdKTsKLQlkcm1fZ2VtX3ZyYW1fdW5waW4oZ2Jv
KTsKLX0KLQogc3RhdGljIGNvbnN0IHUzMiB2Ym94X2N1cnNvcl9wbGFuZV9mb3JtYXRzW10gPSB7
CiAJRFJNX0ZPUk1BVF9BUkdCODg4OCwKIH07CkBAIC01MjQsOCArNDcxLDggQEAgc3RhdGljIGNv
bnN0IHN0cnVjdCBkcm1fcGxhbmVfaGVscGVyX2Z1bmNzIHZib3hfY3Vyc29yX2hlbHBlcl9mdW5j
cyA9IHsKIAkuYXRvbWljX2NoZWNrCT0gdmJveF9jdXJzb3JfYXRvbWljX2NoZWNrLAogCS5hdG9t
aWNfdXBkYXRlCT0gdmJveF9jdXJzb3JfYXRvbWljX3VwZGF0ZSwKIAkuYXRvbWljX2Rpc2FibGUJ
PSB2Ym94X2N1cnNvcl9hdG9taWNfZGlzYWJsZSwKLQkucHJlcGFyZV9mYgk9IHZib3hfY3Vyc29y
X3ByZXBhcmVfZmIsCi0JLmNsZWFudXBfZmIJPSB2Ym94X2N1cnNvcl9jbGVhbnVwX2ZiLAorCS5w
cmVwYXJlX2ZiCT0gZHJtX2dlbV92cmFtX3BsYW5lX2hlbHBlcl9mdW5jc19wcmVwYXJlX2ZiLAor
CS5jbGVhbnVwX2ZiCT0gZHJtX2dlbV92cmFtX3BsYW5lX2hlbHBlcl9mdW5jc19jbGVhbnVwX2Zi
LAogfTsKIAogc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfZnVuY3MgdmJveF9jdXJzb3Jf
cGxhbmVfZnVuY3MgPSB7CkBAIC01NDYsOCArNDkzLDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBk
cm1fcGxhbmVfaGVscGVyX2Z1bmNzIHZib3hfcHJpbWFyeV9oZWxwZXJfZnVuY3MgPSB7CiAJLmF0
b21pY19jaGVjayA9IHZib3hfcHJpbWFyeV9hdG9taWNfY2hlY2ssCiAJLmF0b21pY191cGRhdGUg
PSB2Ym94X3ByaW1hcnlfYXRvbWljX3VwZGF0ZSwKIAkuYXRvbWljX2Rpc2FibGUgPSB2Ym94X3By
aW1hcnlfYXRvbWljX2Rpc2FibGUsCi0JLnByZXBhcmVfZmIgPSB2Ym94X3ByaW1hcnlfcHJlcGFy
ZV9mYiwKLQkuY2xlYW51cF9mYiA9IHZib3hfcHJpbWFyeV9jbGVhbnVwX2ZiLAorCS5wcmVwYXJl
X2ZiCT0gZHJtX2dlbV92cmFtX3BsYW5lX2hlbHBlcl9mdW5jc19wcmVwYXJlX2ZiLAorCS5jbGVh
bnVwX2ZiCT0gZHJtX2dlbV92cmFtX3BsYW5lX2hlbHBlcl9mdW5jc19jbGVhbnVwX2ZiLAogfTsK
IAogc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfZnVuY3MgdmJveF9wcmltYXJ5X3BsYW5l
X2Z1bmNzID0gewotLSAKMi4yMy4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVl
ZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5m
by9kcmktZGV2ZWw=
