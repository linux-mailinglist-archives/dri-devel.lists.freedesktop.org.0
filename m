Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 98BB99D74D
	for <lists+dri-devel@lfdr.de>; Mon, 26 Aug 2019 22:14:42 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E3FE588E7E;
	Mon, 26 Aug 2019 20:14:38 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x541.google.com (mail-ed1-x541.google.com
 [IPv6:2a00:1450:4864:20::541])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5852888E45
 for <dri-devel@lists.freedesktop.org>; Mon, 26 Aug 2019 20:14:37 +0000 (UTC)
Received: by mail-ed1-x541.google.com with SMTP id s15so28186588edx.0
 for <dri-devel@lists.freedesktop.org>; Mon, 26 Aug 2019 13:14:37 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=Hvc+94UsrSo0dvtxcfDnaVeEmPfhp0JVZ15+D+5kcxs=;
 b=c4n6CzMR0cz7hGhv/l8D2ZsyTwwwy0c7EYBZPAkJfV7HnW7cSbbKlDBmMUv9XhWJ2n
 jMegWyTy1wlSSWHiaV/lta1dLTqhVIyYWEhO66Hpy0Xef+4RqqAbw8X0mAmdO4Zm/3Vs
 1YlaYKxualX0zPPKoOAFfAzxv2FgeN1IcowN4vhI+AkeyJnFLp73R5BAIz7QU+52tbxh
 AdNWYtjZp814KvYbwTBc7WCrjkMRdQK99UOgEuxxoJFMBqWiIxkJZEKS7BN4w+OtUpnb
 0bRkETHxT6X4k3cnvzc9dNA1chK8cZilIbw7dysIPbT/xPy/FiM25x9SLG+c8ukPWCPk
 fVVw==
X-Gm-Message-State: APjAAAUce2Bkb1D5SLqma2qMiXmgS/JJqllCJYLchuHVogTIY0hvE3Zy
 EM6/N/ppYgDR5Qq402MmPEUORg==
X-Google-Smtp-Source: APXvYqwb474jg9zO2UYtdgTPRZkQGqmNA6F5tuCOyD7Luea082jyI2817UPjUHI4jh54moplcdAmZw==
X-Received: by 2002:a17:906:3b09:: with SMTP id
 g9mr18654098ejf.297.1566850475866; 
 Mon, 26 Aug 2019 13:14:35 -0700 (PDT)
Received: from phenom.ffwll.local (212-51-149-96.fiber7.init7.net.
 [212.51.149.96])
 by smtp.gmail.com with ESMTPSA id j25sm3000780ejb.49.2019.08.26.13.14.34
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 26 Aug 2019 13:14:35 -0700 (PDT)
From: Daniel Vetter <daniel.vetter@ffwll.ch>
To: LKML <linux-kernel@vger.kernel.org>
Subject: [PATCH 3/5] kernel.h: Add non_block_start/end()
Date: Mon, 26 Aug 2019 22:14:23 +0200
Message-Id: <20190826201425.17547-4-daniel.vetter@ffwll.ch>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190826201425.17547-1-daniel.vetter@ffwll.ch>
References: <20190826201425.17547-1-daniel.vetter@ffwll.ch>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ffwll.ch; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=Hvc+94UsrSo0dvtxcfDnaVeEmPfhp0JVZ15+D+5kcxs=;
 b=VFNW6E8Sf5IO/vio8FpctFWFmv5uJj0ggZOq4v0zfOgDSSsylE0MV0cDqxpUJ0O3+J
 jJbfISI7yr3sm+aoIHAjZ4ksh6Ts3a0rodKmpkYQuExF0IXSOGXHenwQjq/PFnh2xjem
 JCdCkwAuhHfBH1F/2PAMX7b12BePRCojTK8VM=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Feng Tang <feng.tang@intel.com>, Michal Hocko <mhocko@suse.com>,
 Kees Cook <keescook@chromium.org>, Linux MM <linux-mm@kvack.org>,
 Peter Zijlstra <peterz@infradead.org>, Daniel Vetter <daniel.vetter@ffwll.ch>,
 Jann Horn <jannh@google.com>,
 DRI Development <dri-devel@lists.freedesktop.org>,
 Jason Gunthorpe <jgg@ziepe.ca>,
 =?UTF-8?q?J=C3=A9r=C3=B4me=20Glisse?= <jglisse@redhat.com>,
 Ingo Molnar <mingo@redhat.com>, Thomas Gleixner <tglx@linutronix.de>,
 Randy Dunlap <rdunlap@infradead.org>, David Rientjes <rientjes@google.com>,
 Wei Wang <wvw@google.com>, Daniel Vetter <daniel.vetter@intel.com>,
 Andrew Morton <akpm@linux-foundation.org>,
 Andy Shevchenko <andriy.shevchenko@linux.intel.com>,
 =?UTF-8?q?Christian=20K=C3=B6nig?= <christian.koenig@amd.com>,
 Masahiro Yamada <yamada.masahiro@socionext.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW4gc29tZSBzcGVjaWFsIGNhc2VzIHdlIG11c3Qgbm90IGJsb2NrLCBidXQgdGhlcmUncyBub3Qg
YQpzcGlubG9jaywgcHJlZW1wdC1vZmYsIGlycXMtb2ZmIG9yIHNpbWlsYXIgY3JpdGljYWwgc2Vj
dGlvbiBhbHJlYWR5CnRoYXQgYXJtcyB0aGUgbWlnaHRfc2xlZXAoKSBkZWJ1ZyBjaGVja3MuIEFk
ZCBhIG5vbl9ibG9ja19zdGFydC9lbmQoKQpwYWlyIHRvIGFubm90YXRlIHRoZXNlLgoKVGhpcyB3
aWxsIGJlIHVzZWQgaW4gdGhlIG9vbSBwYXRocyBvZiBtbXUtbm90aWZpZXJzLCB3aGVyZSBibG9j
a2luZyBpcwpub3QgYWxsb3dlZCB0byBtYWtlIHN1cmUgdGhlcmUncyBmb3J3YXJkIHByb2dyZXNz
LiBRdW90aW5nIE1pY2hhbDoKCiJUaGUgbm90aWZpZXIgaXMgY2FsbGVkIGZyb20gcXVpdGUgYSBy
ZXN0cmljdGVkIGNvbnRleHQgLSBvb21fcmVhcGVyIC0Kd2hpY2ggc2hvdWxkbid0IGRlcGVuZCBv
biBhbnkgbG9ja3Mgb3Igc2xlZXBhYmxlIGNvbmRpdGlvbmFscy4gVGhlIGNvZGUKc2hvdWxkIGJl
IHN3aWZ0IGFzIHdlbGwgYnV0IHdlIG1vc3RseSBkbyBjYXJlIGFib3V0IGl0IHRvIG1ha2UgYSBm
b3J3YXJkCnByb2dyZXNzLiBDaGVja2luZyBmb3Igc2xlZXBhYmxlIGNvbnRleHQgaXMgdGhlIGJl
c3QgdGhpbmcgd2UgY291bGQgY29tZQp1cCB3aXRoIHRoYXQgd291bGQgZGVzY3JpYmUgdGhlc2Ug
ZGVtYW5kcyBhdCBsZWFzdCBwYXJ0aWFsbHkuIgoKUGV0ZXIgYWxzbyBhc2tlZCB3aGV0aGVyIHdl
IHdhbnQgdG8gY2F0Y2ggc3BpbmxvY2tzIG9uIHRvcCwgYnV0IE1pY2hhbApzYWlkIHRob3NlIGFy
ZSBsZXNzIG9mIGEgcHJvYmxlbSBiZWNhdXNlIHNwaW5sb2NrcyBjYW4ndCBoYXZlIGFuCmluZGly
ZWN0IGRlcGVuZGVuY3kgdXBvbiB0aGUgcGFnZSBhbGxvY2F0b3IgYW5kIGhlbmNlIGNsb3NlIHRo
ZSBsb29wCndpdGggdGhlIG9vbSByZWFwZXIuCgpTdWdnZXN0ZWQgYnkgTWljaGFsIEhvY2tvLgoK
djI6Ci0gSW1wcm92ZSBjb21taXQgbWVzc2FnZSAoTWljaGFsKQotIEFsc28gY2hlY2sgaW4gc2No
ZWR1bGUsIG5vdCBqdXN0IG1pZ2h0X3NsZWVwIChQZXRlcikKCnYzOiBJdCB3b3JrcyBiZXR0ZXIg
d2hlbiBJIGFjdHVhbGx5IHNxdWFzaCBpbiB0aGUgZml4dXAgSSBoYWQgbHlpbmcKYXJvdW5kIDot
LwoKdjQ6IFBpY2sgdGhlIHN1Z2dlc3Rpb24gZnJvbSBBbmRyZXcgTW9ydG9uIHRvIGdpdmUgbm9u
X2Jsb2NrX3N0YXJ0L2VuZApzb21lIGdvb2Qga2VybmVsZG9jIGNvbW1lbnRzLiBJIGFkZGVkIHRo
YXQgb3RoZXIgYmxvY2tpbmcgY2FsbHMgbGlrZQp3YWl0X2V2ZW50IHBvc2Ugc2ltaWxhciBpc3N1
ZXMsIHNpbmNlIHRoYXQncyB0aGUgb3RoZXIgZXhhbXBsZSB3ZQpkaXNjdXNzZWQuCgpDYzogSmFz
b24gR3VudGhvcnBlIDxqZ2dAemllcGUuY2E+CkNjOiBQZXRlciBaaWpsc3RyYSA8cGV0ZXJ6QGlu
ZnJhZGVhZC5vcmc+CkNjOiBJbmdvIE1vbG5hciA8bWluZ29AcmVkaGF0LmNvbT4KQ2M6IEFuZHJl
dyBNb3J0b24gPGFrcG1AbGludXgtZm91bmRhdGlvbi5vcmc+CkNjOiBNaWNoYWwgSG9ja28gPG1o
b2Nrb0BzdXNlLmNvbT4KQ2M6IERhdmlkIFJpZW50amVzIDxyaWVudGplc0Bnb29nbGUuY29tPgpD
YzogIkNocmlzdGlhbiBLw7ZuaWciIDxjaHJpc3RpYW4ua29lbmlnQGFtZC5jb20+CkNjOiBEYW5p
ZWwgVmV0dGVyIDxkYW5pZWwudmV0dGVyQGZmd2xsLmNoPgpDYzogIkrDqXLDtG1lIEdsaXNzZSIg
PGpnbGlzc2VAcmVkaGF0LmNvbT4KQ2M6IGxpbnV4LW1tQGt2YWNrLm9yZwpDYzogTWFzYWhpcm8g
WWFtYWRhIDx5YW1hZGEubWFzYWhpcm9Ac29jaW9uZXh0LmNvbT4KQ2M6IFdlaSBXYW5nIDx3dndA
Z29vZ2xlLmNvbT4KQ2M6IEFuZHkgU2hldmNoZW5rbyA8YW5kcml5LnNoZXZjaGVua29AbGludXgu
aW50ZWwuY29tPgpDYzogVGhvbWFzIEdsZWl4bmVyIDx0Z2x4QGxpbnV0cm9uaXguZGU+CkNjOiBK
YW5uIEhvcm4gPGphbm5oQGdvb2dsZS5jb20+CkNjOiBGZW5nIFRhbmcgPGZlbmcudGFuZ0BpbnRl
bC5jb20+CkNjOiBLZWVzIENvb2sgPGtlZXNjb29rQGNocm9taXVtLm9yZz4KQ2M6IFJhbmR5IER1
bmxhcCA8cmR1bmxhcEBpbmZyYWRlYWQub3JnPgpDYzogbGludXgta2VybmVsQHZnZXIua2VybmVs
Lm9yZwpBY2tlZC1ieTogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0aWFuLmtvZW5pZ0BhbWQuY29t
PiAodjEpCkFja2VkLWJ5OiBQZXRlciBaaWpsc3RyYSAoSW50ZWwpIDxwZXRlcnpAaW5mcmFkZWFk
Lm9yZz4KU2lnbmVkLW9mZi1ieTogRGFuaWVsIFZldHRlciA8ZGFuaWVsLnZldHRlckBpbnRlbC5j
b20+Ci0tLQogaW5jbHVkZS9saW51eC9rZXJuZWwuaCB8IDI1ICsrKysrKysrKysrKysrKysrKysr
KysrKy0KIGluY2x1ZGUvbGludXgvc2NoZWQuaCAgfCAgNCArKysrCiBrZXJuZWwvc2NoZWQvY29y
ZS5jICAgIHwgMTkgKysrKysrKysrKysrKystLS0tLQogMyBmaWxlcyBjaGFuZ2VkLCA0MiBpbnNl
cnRpb25zKCspLCA2IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgva2Vy
bmVsLmggYi9pbmNsdWRlL2xpbnV4L2tlcm5lbC5oCmluZGV4IDRmYTM2MGExM2MxZS4uODJmODRj
ZmUzNzJmIDEwMDY0NAotLS0gYS9pbmNsdWRlL2xpbnV4L2tlcm5lbC5oCisrKyBiL2luY2x1ZGUv
bGludXgva2VybmVsLmgKQEAgLTIxNyw3ICsyMTcsOSBAQCBleHRlcm4gdm9pZCBfX2NhbnRfc2xl
ZXAoY29uc3QgY2hhciAqZmlsZSwgaW50IGxpbmUsIGludCBwcmVlbXB0X29mZnNldCk7CiAgKiBt
aWdodF9zbGVlcCAtIGFubm90YXRpb24gZm9yIGZ1bmN0aW9ucyB0aGF0IGNhbiBzbGVlcAogICoK
ICAqIHRoaXMgbWFjcm8gd2lsbCBwcmludCBhIHN0YWNrIHRyYWNlIGlmIGl0IGlzIGV4ZWN1dGVk
IGluIGFuIGF0b21pYwotICogY29udGV4dCAoc3BpbmxvY2ssIGlycS1oYW5kbGVyLCAuLi4pLgor
ICogY29udGV4dCAoc3BpbmxvY2ssIGlycS1oYW5kbGVyLCAuLi4pLiBBZGRpdGlvbmFsIHNlY3Rp
b25zIHdoZXJlIGJsb2NraW5nIGlzCisgKiBub3QgYWxsb3dlZCBjYW4gYmUgYW5ub3RhdGVkIHdp
dGggbm9uX2Jsb2NrX3N0YXJ0KCkgYW5kIG5vbl9ibG9ja19lbmQoKQorICogcGFpcnMuCiAgKgog
ICogVGhpcyBpcyBhIHVzZWZ1bCBkZWJ1Z2dpbmcgaGVscCB0byBiZSBhYmxlIHRvIGNhdGNoIHBy
b2JsZW1zIGVhcmx5IGFuZCBub3QKICAqIGJlIGJpdHRlbiBsYXRlciB3aGVuIHRoZSBjYWxsaW5n
IGZ1bmN0aW9uIGhhcHBlbnMgdG8gc2xlZXAgd2hlbiBpdCBpcyBub3QKQEAgLTIzMyw2ICsyMzUs
MjUgQEAgZXh0ZXJuIHZvaWQgX19jYW50X3NsZWVwKGNvbnN0IGNoYXIgKmZpbGUsIGludCBsaW5l
LCBpbnQgcHJlZW1wdF9vZmZzZXQpOwogIyBkZWZpbmUgY2FudF9zbGVlcCgpIFwKIAlkbyB7IF9f
Y2FudF9zbGVlcChfX0ZJTEVfXywgX19MSU5FX18sIDApOyB9IHdoaWxlICgwKQogIyBkZWZpbmUg
c2NoZWRfYW5ub3RhdGVfc2xlZXAoKQkoY3VycmVudC0+dGFza19zdGF0ZV9jaGFuZ2UgPSAwKQor
LyoqCisgKiBub25fYmxvY2tfc3RhcnQgLSBhbm5vdGF0ZSB0aGUgc3RhcnQgb2Ygc2VjdGlvbiB3
aGVyZSBzbGVlcGluZyBpcyBwcm9oaWJpdGVkCisgKgorICogVGhpcyBpcyBvbiBiZWhhbGYgb2Yg
dGhlIG9vbSByZWFwZXIsIHNwZWNpZmljYWxseSB3aGVuIGl0IGlzIGNhbGxpbmcgdGhlIG1tdQor
ICogbm90aWZpZXJzLiBUaGUgcHJvYmxlbSBpcyB0aGF0IGlmIHRoZSBub3RpZmllciB3ZXJlIHRv
IGJsb2NrIG9uLCBmb3IgZXhhbXBsZSwKKyAqIG11dGV4X2xvY2soKSBhbmQgaWYgdGhlIHByb2Nl
c3Mgd2hpY2ggaG9sZHMgdGhhdCBtdXRleCB3ZXJlIHRvIHBlcmZvcm0gYQorICogc2xlZXBpbmcg
bWVtb3J5IGFsbG9jYXRpb24sIHRoZSBvb20gcmVhcGVyIGlzIG5vdyBibG9ja2VkIG9uIGNvbXBs
ZXRpb24gb2YKKyAqIHRoYXQgbWVtb3J5IGFsbG9jYXRpb24uIE90aGVyIGJsb2NraW5nIGNhbGxz
IGxpa2Ugd2FpdF9ldmVudCgpIHBvc2Ugc2ltaWxhcgorICogaXNzdWVzLgorICovCisjIGRlZmlu
ZSBub25fYmxvY2tfc3RhcnQoKSBcCisJZG8geyBjdXJyZW50LT5ub25fYmxvY2tfY291bnQrKzsg
fSB3aGlsZSAoMCkKKy8qKgorICogbm9uX2Jsb2NrX2VuZCAtIGFubm90YXRlIHRoZSBlbmQgb2Yg
c2VjdGlvbiB3aGVyZSBzbGVlcGluZyBpcyBwcm9oaWJpdGVkCisgKgorICogQ2xvc2VzIGEgc2Vj
dGlvbiBvcGVuZWQgYnkgbm9uX2Jsb2NrX3N0YXJ0KCkuCisgKi8KKyMgZGVmaW5lIG5vbl9ibG9j
a19lbmQoKSBcCisJZG8geyBXQVJOX09OKGN1cnJlbnQtPm5vbl9ibG9ja19jb3VudC0tID09IDAp
OyB9IHdoaWxlICgwKQogI2Vsc2UKICAgc3RhdGljIGlubGluZSB2b2lkIF9fX21pZ2h0X3NsZWVw
KGNvbnN0IGNoYXIgKmZpbGUsIGludCBsaW5lLAogCQkJCSAgIGludCBwcmVlbXB0X29mZnNldCkg
eyB9CkBAIC0yNDEsNiArMjYyLDggQEAgZXh0ZXJuIHZvaWQgX19jYW50X3NsZWVwKGNvbnN0IGNo
YXIgKmZpbGUsIGludCBsaW5lLCBpbnQgcHJlZW1wdF9vZmZzZXQpOwogIyBkZWZpbmUgbWlnaHRf
c2xlZXAoKSBkbyB7IG1pZ2h0X3Jlc2NoZWQoKTsgfSB3aGlsZSAoMCkKICMgZGVmaW5lIGNhbnRf
c2xlZXAoKSBkbyB7IH0gd2hpbGUgKDApCiAjIGRlZmluZSBzY2hlZF9hbm5vdGF0ZV9zbGVlcCgp
IGRvIHsgfSB3aGlsZSAoMCkKKyMgZGVmaW5lIG5vbl9ibG9ja19zdGFydCgpIGRvIHsgfSB3aGls
ZSAoMCkKKyMgZGVmaW5lIG5vbl9ibG9ja19lbmQoKSBkbyB7IH0gd2hpbGUgKDApCiAjZW5kaWYK
IAogI2RlZmluZSBtaWdodF9zbGVlcF9pZihjb25kKSBkbyB7IGlmIChjb25kKSBtaWdodF9zbGVl
cCgpOyB9IHdoaWxlICgwKQpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC9zY2hlZC5oIGIvaW5j
bHVkZS9saW51eC9zY2hlZC5oCmluZGV4IGI2ZWMxMzBkZmY5Yi4uZThiYjk2NWY1MDE5IDEwMDY0
NAotLS0gYS9pbmNsdWRlL2xpbnV4L3NjaGVkLmgKKysrIGIvaW5jbHVkZS9saW51eC9zY2hlZC5o
CkBAIC05ODAsNiArOTgwLDEwIEBAIHN0cnVjdCB0YXNrX3N0cnVjdCB7CiAJc3RydWN0IG11dGV4
X3dhaXRlcgkJKmJsb2NrZWRfb247CiAjZW5kaWYKIAorI2lmZGVmIENPTkZJR19ERUJVR19BVE9N
SUNfU0xFRVAKKwlpbnQJCQkJbm9uX2Jsb2NrX2NvdW50OworI2VuZGlmCisKICNpZmRlZiBDT05G
SUdfVFJBQ0VfSVJRRkxBR1MKIAl1bnNpZ25lZCBpbnQJCQlpcnFfZXZlbnRzOwogCXVuc2lnbmVk
IGxvbmcJCQloYXJkaXJxX2VuYWJsZV9pcDsKZGlmZiAtLWdpdCBhL2tlcm5lbC9zY2hlZC9jb3Jl
LmMgYi9rZXJuZWwvc2NoZWQvY29yZS5jCmluZGV4IDQ1ZGNlZWMyMDlmNC4uMGQwMWM3OTk0YTlh
IDEwMDY0NAotLS0gYS9rZXJuZWwvc2NoZWQvY29yZS5jCisrKyBiL2tlcm5lbC9zY2hlZC9jb3Jl
LmMKQEAgLTM3NTIsMTMgKzM3NTIsMjIgQEAgc3RhdGljIG5vaW5saW5lIHZvaWQgX19zY2hlZHVs
ZV9idWcoc3RydWN0IHRhc2tfc3RydWN0ICpwcmV2KQogLyoKICAqIFZhcmlvdXMgc2NoZWR1bGUo
KS10aW1lIGRlYnVnZ2luZyBjaGVja3MgYW5kIHN0YXRpc3RpY3M6CiAgKi8KLXN0YXRpYyBpbmxp
bmUgdm9pZCBzY2hlZHVsZV9kZWJ1ZyhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnByZXYpCitzdGF0aWMg
aW5saW5lIHZvaWQgc2NoZWR1bGVfZGVidWcoc3RydWN0IHRhc2tfc3RydWN0ICpwcmV2LCBib29s
IHByZWVtcHQpCiB7CiAjaWZkZWYgQ09ORklHX1NDSEVEX1NUQUNLX0VORF9DSEVDSwogCWlmICh0
YXNrX3N0YWNrX2VuZF9jb3JydXB0ZWQocHJldikpCiAJCXBhbmljKCJjb3JydXB0ZWQgc3RhY2sg
ZW5kIGRldGVjdGVkIGluc2lkZSBzY2hlZHVsZXJcbiIpOwogI2VuZGlmCiAKKyNpZmRlZiBDT05G
SUdfREVCVUdfQVRPTUlDX1NMRUVQCisJaWYgKCFwcmVlbXB0ICYmIHByZXYtPnN0YXRlICYmIHBy
ZXYtPm5vbl9ibG9ja19jb3VudCkgeworCQlwcmludGsoS0VSTl9FUlIgIkJVRzogc2NoZWR1bGlu
ZyBpbiBhIG5vbi1ibG9ja2luZyBzZWN0aW9uOiAlcy8lZC8laVxuIiwKKwkJCXByZXYtPmNvbW0s
IHByZXYtPnBpZCwgcHJldi0+bm9uX2Jsb2NrX2NvdW50KTsKKwkJZHVtcF9zdGFjaygpOworCQlh
ZGRfdGFpbnQoVEFJTlRfV0FSTiwgTE9DS0RFUF9TVElMTF9PSyk7CisJfQorI2VuZGlmCisKIAlp
ZiAodW5saWtlbHkoaW5fYXRvbWljX3ByZWVtcHRfb2ZmKCkpKSB7CiAJCV9fc2NoZWR1bGVfYnVn
KHByZXYpOwogCQlwcmVlbXB0X2NvdW50X3NldChQUkVFTVBUX0RJU0FCTEVEKTsKQEAgLTM4NzAs
NyArMzg3OSw3IEBAIHN0YXRpYyB2b2lkIF9fc2NoZWQgbm90cmFjZSBfX3NjaGVkdWxlKGJvb2wg
cHJlZW1wdCkKIAlycSA9IGNwdV9ycShjcHUpOwogCXByZXYgPSBycS0+Y3VycjsKIAotCXNjaGVk
dWxlX2RlYnVnKHByZXYpOworCXNjaGVkdWxlX2RlYnVnKHByZXYsIHByZWVtcHQpOwogCiAJaWYg
KHNjaGVkX2ZlYXQoSFJUSUNLKSkKIAkJaHJ0aWNrX2NsZWFyKHJxKTsKQEAgLTY2NDEsNyArNjY1
MCw3IEBAIHZvaWQgX19fbWlnaHRfc2xlZXAoY29uc3QgY2hhciAqZmlsZSwgaW50IGxpbmUsIGlu
dCBwcmVlbXB0X29mZnNldCkKIAlyY3Vfc2xlZXBfY2hlY2soKTsKIAogCWlmICgocHJlZW1wdF9j
b3VudF9lcXVhbHMocHJlZW1wdF9vZmZzZXQpICYmICFpcnFzX2Rpc2FibGVkKCkgJiYKLQkgICAg
ICFpc19pZGxlX3Rhc2soY3VycmVudCkpIHx8CisJICAgICAhaXNfaWRsZV90YXNrKGN1cnJlbnQp
ICYmICFjdXJyZW50LT5ub25fYmxvY2tfY291bnQpIHx8CiAJICAgIHN5c3RlbV9zdGF0ZSA9PSBT
WVNURU1fQk9PVElORyB8fCBzeXN0ZW1fc3RhdGUgPiBTWVNURU1fUlVOTklORyB8fAogCSAgICBv
b3BzX2luX3Byb2dyZXNzKQogCQlyZXR1cm47CkBAIC02NjU3LDggKzY2NjYsOCBAQCB2b2lkIF9f
X21pZ2h0X3NsZWVwKGNvbnN0IGNoYXIgKmZpbGUsIGludCBsaW5lLCBpbnQgcHJlZW1wdF9vZmZz
ZXQpCiAJCSJCVUc6IHNsZWVwaW5nIGZ1bmN0aW9uIGNhbGxlZCBmcm9tIGludmFsaWQgY29udGV4
dCBhdCAlczolZFxuIiwKIAkJCWZpbGUsIGxpbmUpOwogCXByaW50ayhLRVJOX0VSUgotCQkiaW5f
YXRvbWljKCk6ICVkLCBpcnFzX2Rpc2FibGVkKCk6ICVkLCBwaWQ6ICVkLCBuYW1lOiAlc1xuIiwK
LQkJCWluX2F0b21pYygpLCBpcnFzX2Rpc2FibGVkKCksCisJCSJpbl9hdG9taWMoKTogJWQsIGly
cXNfZGlzYWJsZWQoKTogJWQsIG5vbl9ibG9jazogJWQsIHBpZDogJWQsIG5hbWU6ICVzXG4iLAor
CQkJaW5fYXRvbWljKCksIGlycXNfZGlzYWJsZWQoKSwgY3VycmVudC0+bm9uX2Jsb2NrX2NvdW50
LAogCQkJY3VycmVudC0+cGlkLCBjdXJyZW50LT5jb21tKTsKIAogCWlmICh0YXNrX3N0YWNrX2Vu
ZF9jb3JydXB0ZWQoY3VycmVudCkpCi0tIAoyLjIzLjAKCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVs
QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWls
bWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
