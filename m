Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 88CA8DCE3D
	for <lists+dri-devel@lfdr.de>; Fri, 18 Oct 2019 20:38:52 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 119F16EBB1;
	Fri, 18 Oct 2019 18:37:52 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from relay8-d.mail.gandi.net (relay8-d.mail.gandi.net
 [217.70.183.201])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4B3916EAA1
 for <dri-devel@lists.freedesktop.org>; Thu, 17 Oct 2019 13:42:32 +0000 (UTC)
X-Originating-IP: 2.224.242.101
Received: from uno.lan (2-224-242-101.ip172.fastwebnet.it [2.224.242.101])
 (Authenticated sender: jacopo@jmondi.org)
 by relay8-d.mail.gandi.net (Postfix) with ESMTPSA id 0EAFE1BF207;
 Thu, 17 Oct 2019 13:42:25 +0000 (UTC)
From: Jacopo Mondi <jacopo+renesas@jmondi.org>
To: laurent.pinchart@ideasonboard.com, kieran.bingham+renesas@ideasonboard.com,
 geert@linux-m68k.org, horms@verge.net.au, uli+renesas@fpond.eu
Subject: [PATCH v6.1 5/8] drm: rcar-du: crtc: Control CMM operations
Date: Thu, 17 Oct 2019 15:44:09 +0200
Message-Id: <20191017134409.535740-1-jacopo+renesas@jmondi.org>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191016085548.105703-6-jacopo+renesas@jmondi.org>
References: <20191016085548.105703-6-jacopo+renesas@jmondi.org>
MIME-Version: 1.0
X-Mailman-Approved-At: Fri, 18 Oct 2019 18:37:46 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: airlied@linux.ie, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, linux-renesas-soc@vger.kernel.org,
 Jacopo Mondi <jacopo+renesas@jmondi.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW1wbGVtZW50IENNTSBoYW5kbGluZyBpbiB0aGUgY3J0YyBiZWdpbiBhbmQgZW5hYmxlIGF0b21p
YyBjYWxsYmFja3MsCmFuZCBlbmFibGUgQ01NIHVuaXQgdGhyb3VnaCB0aGUgRGlzcGxheSBFeHRl
bnNpb25hbCBGdW5jdGlvbnMKcmVnaXN0ZXIgYXQgZ3JvdXAgc2V0dXAgdGltZS4KClJldmlld2Vk
LWJ5OiBMYXVyZW50IFBpbmNoYXJ0IDxsYXVyZW50LnBpbmNoYXJ0QGlkZWFzb25ib2FyZC5jb20+
ClJldmlld2VkLWJ5OiBLaWVyYW4gQmluZ2hhbSA8a2llcmFuLmJpbmdoYW0rcmVuZXNhc0BpZGVh
c29uYm9hcmQuY29tPgpTaWduZWQtb2ZmLWJ5OiBKYWNvcG8gTW9uZGkgPGphY29wbytyZW5lc2Fz
QGptb25kaS5vcmc+CgotLS0KdjYgLT4gdjYuMQotIERyb3AgY2hlY2sgZm9yIENNTSBpbiByY2Fy
X2R1X2NtbV9jaGVjayBhcyBpZiB0aGUgZ2FtbWFfdGFibGUgcHJvcGVydHkgaXMKICBhdmFpbGFi
bGUsIGEgQ01NIHVuaXQgZm9yIHRoaXMgQ1JUQyB3YXMgcmVnaXN0ZXJlZAotIEFkZCBUT0RPIG5v
dGUgdG8gaW52ZXN0aWdhdGUgaG93IHRoZSBhY3RpdmF0aW9uIG9yZGVyIG9mIENNTSBhbmQgQ1JU
QwogIGltcGFjdCBvbiB0aGUgZmlyc3QgZGlzcGxheWVkIGZyYW0KLS0tCgogZHJpdmVycy9ncHUv
ZHJtL3JjYXItZHUvcmNhcl9kdV9jcnRjLmMgIHwgNjEgKysrKysrKysrKysrKysrKysrKysrKysr
KwogZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9ncm91cC5jIHwgMTAgKysrKwogZHJp
dmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9yZWdzLmggIHwgIDUgKysKIDMgZmlsZXMgY2hh
bmdlZCwgNzYgaW5zZXJ0aW9ucygrKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yY2Fy
LWR1L3JjYXJfZHVfY3J0Yy5jIGIvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9jcnRj
LmMKaW5kZXggMjNmMWQ2Y2MxNzE5Li4zZjBmMTY5NDZmNDIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfY3J0Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yY2Fy
LWR1L3JjYXJfZHVfY3J0Yy5jCkBAIC0yMSw2ICsyMSw3IEBACiAjaW5jbHVkZSA8ZHJtL2RybV9w
bGFuZV9oZWxwZXIuaD4KICNpbmNsdWRlIDxkcm0vZHJtX3ZibGFuay5oPgoKKyNpbmNsdWRlICJy
Y2FyX2NtbS5oIgogI2luY2x1ZGUgInJjYXJfZHVfY3J0Yy5oIgogI2luY2x1ZGUgInJjYXJfZHVf
ZHJ2LmgiCiAjaW5jbHVkZSAicmNhcl9kdV9lbmNvZGVyLmgiCkBAIC00NzQsNiArNDc1LDQ1IEBA
IHN0YXRpYyB2b2lkIHJjYXJfZHVfY3J0Y193YWl0X3BhZ2VfZmxpcChzdHJ1Y3QgcmNhcl9kdV9j
cnRjICpyY3J0YykKIAlyY2FyX2R1X2NydGNfZmluaXNoX3BhZ2VfZmxpcChyY3J0Yyk7CiB9Cgor
LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqIENvbG9yIE1hbmFnZW1lbnQgTW9kdWxlIChDTU0p
CisgKi8KKworc3RhdGljIGludCByY2FyX2R1X2NtbV9jaGVjayhzdHJ1Y3QgZHJtX2NydGMgKmNy
dGMsCisJCQkgICAgIHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqc3RhdGUpCit7CisJc3RydWN0IGRy
bV9wcm9wZXJ0eV9ibG9iICpkcm1fbHV0ID0gc3RhdGUtPmdhbW1hX2x1dDsKKwlzdHJ1Y3QgcmNh
cl9kdV9jcnRjICpyY3J0YyA9IHRvX3JjYXJfY3J0YyhjcnRjKTsKKwlzdHJ1Y3QgZGV2aWNlICpk
ZXYgPSByY3J0Yy0+ZGV2LT5kZXY7CisKKwlpZiAoIWRybV9sdXQpCisJCXJldHVybiAwOworCisJ
LyogV2Ugb25seSBhY2NlcHQgZnVsbHkgcG9wdWxhdGVkIExVVCB0YWJsZXMuICovCisJaWYgKGRy
bV9jb2xvcl9sdXRfc2l6ZShkcm1fbHV0KSAhPSBDTTJfTFVUX1NJWkUpIHsKKwkJZGV2X2Vycihk
ZXYsICJpbnZhbGlkIGdhbW1hIGx1dCBzaXplOiAlbHUgYnl0ZXNcbiIsCisJCQlkcm1fbHV0LT5s
ZW5ndGgpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGlj
IHZvaWQgcmNhcl9kdV9jbW1fc2V0dXAoc3RydWN0IGRybV9jcnRjICpjcnRjKQoreworCXN0cnVj
dCBkcm1fcHJvcGVydHlfYmxvYiAqZHJtX2x1dCA9IGNydGMtPnN0YXRlLT5nYW1tYV9sdXQ7CisJ
c3RydWN0IHJjYXJfZHVfY3J0YyAqcmNydGMgPSB0b19yY2FyX2NydGMoY3J0Yyk7CisJc3RydWN0
IHJjYXJfY21tX2NvbmZpZyBjbW1fY29uZmlnID0ge307CisKKwlpZiAoIXJjcnRjLT5jbW0pCisJ
CXJldHVybjsKKworCWlmIChkcm1fbHV0KQorCQljbW1fY29uZmlnLmx1dC50YWJsZSA9IChzdHJ1
Y3QgZHJtX2NvbG9yX2x1dCAqKWRybV9sdXQtPmRhdGE7CisKKwlyY2FyX2NtbV9zZXR1cChyY3J0
Yy0+Y21tLCAmY21tX2NvbmZpZyk7Cit9CisKIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgKiBT
dGFydC9TdG9wIGFuZCBTdXNwZW5kL1Jlc3VtZQogICovCkBAIC02MTksNiArNjU5LDkgQEAgc3Rh
dGljIHZvaWQgcmNhcl9kdV9jcnRjX3N0b3Aoc3RydWN0IHJjYXJfZHVfY3J0YyAqcmNydGMpCiAJ
aWYgKHJjYXJfZHVfaGFzKHJjcnRjLT5kZXYsIFJDQVJfRFVfRkVBVFVSRV9WU1AxX1NPVVJDRSkp
CiAJCXJjYXJfZHVfdnNwX2Rpc2FibGUocmNydGMpOwoKKwlpZiAocmNydGMtPmNtbSkKKwkJcmNh
cl9jbW1fZGlzYWJsZShyY3J0Yy0+Y21tKTsKKwogCS8qCiAJICogU2VsZWN0IHN3aXRjaCBzeW5j
IG1vZGUuIFRoaXMgc3RvcHMgZGlzcGxheSBvcGVyYXRpb24gYW5kIGNvbmZpZ3VyZXMKIAkgKiB0
aGUgSFNZTkMgYW5kIFZTWU5DIHNpZ25hbHMgYXMgaW5wdXRzLgpAQCAtNjQyLDYgKzY4NSwxMSBA
QCBzdGF0aWMgaW50IHJjYXJfZHVfY3J0Y19hdG9taWNfY2hlY2soc3RydWN0IGRybV9jcnRjICpj
cnRjLAogewogCXN0cnVjdCByY2FyX2R1X2NydGNfc3RhdGUgKnJzdGF0ZSA9IHRvX3JjYXJfY3J0
Y19zdGF0ZShzdGF0ZSk7CiAJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyOworCWludCByZXQ7
CisKKwlyZXQgPSByY2FyX2R1X2NtbV9jaGVjayhjcnRjLCBzdGF0ZSk7CisJaWYgKHJldCkKKwkJ
cmV0dXJuIHJldDsKCiAJLyogU3RvcmUgdGhlIHJvdXRlcyBmcm9tIHRoZSBDUlRDIG91dHB1dCB0
byB0aGUgRFUgb3V0cHV0cy4gKi8KIAlyc3RhdGUtPm91dHB1dHMgPSAwOwpAQCAtNjY3LDYgKzcx
NSw4IEBAIHN0YXRpYyB2b2lkIHJjYXJfZHVfY3J0Y19hdG9taWNfZW5hYmxlKHN0cnVjdCBkcm1f
Y3J0YyAqY3J0YywKIAlzdHJ1Y3QgcmNhcl9kdV9jcnRjX3N0YXRlICpyc3RhdGUgPSB0b19yY2Fy
X2NydGNfc3RhdGUoY3J0Yy0+c3RhdGUpOwogCXN0cnVjdCByY2FyX2R1X2RldmljZSAqcmNkdSA9
IHJjcnRjLT5kZXY7CgorCWlmIChyY3J0Yy0+Y21tKQorCQlyY2FyX2NtbV9lbmFibGUocmNydGMt
PmNtbSk7CiAJcmNhcl9kdV9jcnRjX2dldChyY3J0Yyk7CgogCS8qCkBAIC02ODYsNiArNzM2LDEz
IEBAIHN0YXRpYyB2b2lkIHJjYXJfZHVfY3J0Y19hdG9taWNfZW5hYmxlKHN0cnVjdCBkcm1fY3J0
YyAqY3J0YywKIAl9CgogCXJjYXJfZHVfY3J0Y19zdGFydChyY3J0Yyk7CisKKwkvKgorCSAqIFRP
RE86IFRoZSBjaGlwIG1hbnVhbCBpbmRpY2F0ZXMgdGhhdCBDTU0gdGFibGVzIHNob3VsZCBiZSB3
cml0dGVuCisJICogYWZ0ZXIgdGhlIERVIGNoYW5uZWwgaGFzIGJlZW4gYWN0aXZhdGVkLiBJbnZl
c3RpZ2F0ZSB0aGUgaW1wYWN0CisJICogb2YgdGhpcyByZXN0cmljdGlvbiBvbiB0aGUgZmlyc3Qg
ZGlzcGxheWVkIGZyYW1lLgorCSAqLworCXJjYXJfZHVfY21tX3NldHVwKGNydGMpOwogfQoKIHN0
YXRpYyB2b2lkIHJjYXJfZHVfY3J0Y19hdG9taWNfZGlzYWJsZShzdHJ1Y3QgZHJtX2NydGMgKmNy
dGMsCkBAIC03MzksNiArNzk2LDEwIEBAIHN0YXRpYyB2b2lkIHJjYXJfZHVfY3J0Y19hdG9taWNf
YmVnaW4oc3RydWN0IGRybV9jcnRjICpjcnRjLAogCSAqLwogCXJjYXJfZHVfY3J0Y19nZXQocmNy
dGMpOwoKKwkvKiBJZiB0aGUgYWN0aXZlIHN0YXRlIGNoYW5nZWQsIHdlIGxldCAuYXRvbWljX2Vu
YWJsZSBoYW5kbGUgQ01NLiAqLworCWlmIChjcnRjLT5zdGF0ZS0+Y29sb3JfbWdtdF9jaGFuZ2Vk
ICYmICFjcnRjLT5zdGF0ZS0+YWN0aXZlX2NoYW5nZWQpCisJCXJjYXJfZHVfY21tX3NldHVwKGNy
dGMpOworCiAJaWYgKHJjYXJfZHVfaGFzKHJjcnRjLT5kZXYsIFJDQVJfRFVfRkVBVFVSRV9WU1Ax
X1NPVVJDRSkpCiAJCXJjYXJfZHVfdnNwX2F0b21pY19iZWdpbihyY3J0Yyk7CiB9CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X2dyb3VwLmMgYi9kcml2ZXJzL2dw
dS9kcm0vcmNhci1kdS9yY2FyX2R1X2dyb3VwLmMKaW5kZXggOWVlZTQ3OTY5ZTc3Li44OGE3ODNj
ZWIzZTkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfZ3JvdXAu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X2dyb3VwLmMKQEAgLTEzNSw2
ICsxMzUsNyBAQCBzdGF0aWMgdm9pZCByY2FyX2R1X2dyb3VwX3NldHVwX2RpZHNyKHN0cnVjdCBy
Y2FyX2R1X2dyb3VwICpyZ3JwKQogc3RhdGljIHZvaWQgcmNhcl9kdV9ncm91cF9zZXR1cChzdHJ1
Y3QgcmNhcl9kdV9ncm91cCAqcmdycCkKIHsKIAlzdHJ1Y3QgcmNhcl9kdV9kZXZpY2UgKnJjZHUg
PSByZ3JwLT5kZXY7CisJdTMyIGRlZnI3ID0gREVGUjdfQ09ERTsKCiAJLyogRW5hYmxlIGV4dGVu
ZGVkIGZlYXR1cmVzICovCiAJcmNhcl9kdV9ncm91cF93cml0ZShyZ3JwLCBERUZSLCBERUZSX0NP
REUgfCBERUZSX0RFRkUpOwpAQCAtMTQ3LDYgKzE0OCwxNSBAQCBzdGF0aWMgdm9pZCByY2FyX2R1
X2dyb3VwX3NldHVwKHN0cnVjdCByY2FyX2R1X2dyb3VwICpyZ3JwKQoKIAlyY2FyX2R1X2dyb3Vw
X3NldHVwX3BpbnMocmdycCk7CgorCS8qCisJICogVE9ETzogSGFuZGxlIHJvdXRpbmcgb2YgdGhl
IERVIG91dHB1dCB0byBDTU0gZHluYW1pY2FsbHksIGFzIHdlCisJICogc2hvdWxkIGJ5cGFzcyBD
TU0gY29tcGxldGVseSB3aGVuIG5vIGNvbG9yIG1hbmFnZW1lbnQgZmVhdHVyZSBpcworCSAqIHVz
ZWQuCisJICovCisJZGVmcjcgfD0gKHJncnAtPmNtbXNfbWFzayAmIEJJVCgxKSA/IERFRlI3X0NN
TUUxIDogMCkgfAorCQkgKHJncnAtPmNtbXNfbWFzayAmIEJJVCgwKSA/IERFRlI3X0NNTUUwIDog
MCk7CisJcmNhcl9kdV9ncm91cF93cml0ZShyZ3JwLCBERUZSNywgZGVmcjcpOworCiAJaWYgKHJj
ZHUtPmluZm8tPmdlbiA+PSAyKSB7CiAJCXJjYXJfZHVfZ3JvdXBfc2V0dXBfZGVmcjgocmdycCk7
CiAJCXJjYXJfZHVfZ3JvdXBfc2V0dXBfZGlkc3IocmdycCk7CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X3JlZ3MuaCBiL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1
L3JjYXJfZHVfcmVncy5oCmluZGV4IGJjODdmMDgwYjE3MC4uZmI5OTY0OTQ5MzY4IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X3JlZ3MuaAorKysgYi9kcml2ZXJz
L2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X3JlZ3MuaApAQCAtMTk3LDYgKzE5NywxMSBAQAogI2Rl
ZmluZSBERUZSNl9NTE9TMQkJKDEgPDwgMikKICNkZWZpbmUgREVGUjZfREVGQVVMVAkJKERFRlI2
X0NPREUgfCBERUZSNl9UQ05FMSkKCisjZGVmaW5lIERFRlI3CQkJMHgwMDBlYworI2RlZmluZSBE
RUZSN19DT0RFCQkoMHg3Nzc5IDw8IDE2KQorI2RlZmluZSBERUZSN19DTU1FMQkJQklUKDYpCisj
ZGVmaW5lIERFRlI3X0NNTUUwCQlCSVQoNCkKKwogLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAq
IFI4QTc3OTAtb25seSBDb250cm9sIFJlZ2lzdGVycwogICovCi0tCjIuMjMuMAoKX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcg
bGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRl
c2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
