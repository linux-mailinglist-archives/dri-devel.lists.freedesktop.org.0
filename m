Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id C7AA5FF90F
	for <lists+dri-devel@lfdr.de>; Sun, 17 Nov 2019 12:45:36 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E554C6E303;
	Sun, 17 Nov 2019 11:44:40 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from bhuna.collabora.co.uk (bhuna.collabora.co.uk [46.235.227.227])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A823C6E20C
 for <dri-devel@lists.freedesktop.org>; Sun, 17 Nov 2019 02:41:51 +0000 (UTC)
Received: from [127.0.0.1] (localhost [127.0.0.1]) (Authenticated sender: sre)
 with ESMTPSA id 60EE428F838
Received: by earth.universe (Postfix, from userid 1000)
 id 255833C0CA7; Sun, 17 Nov 2019 03:41:40 +0100 (CET)
From: Sebastian Reichel <sebastian.reichel@collabora.com>
To: Sebastian Reichel <sre@kernel.org>,
 Laurent Pinchart <laurent.pinchart@ideasonboard.com>,
 Tomi Valkeinen <tomi.valkeinen@ti.com>
Subject: [RFCv1 27/42] drm/omap: dsi: untangle ulps ops from enable/disable
Date: Sun, 17 Nov 2019 03:40:13 +0100
Message-Id: <20191117024028.2233-28-sebastian.reichel@collabora.com>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191117024028.2233-1-sebastian.reichel@collabora.com>
References: <20191117024028.2233-1-sebastian.reichel@collabora.com>
MIME-Version: 1.0
X-Mailman-Approved-At: Sun, 17 Nov 2019 11:44:18 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: kernel@collabora.com, Tony Lindgren <tony@atomide.com>,
 "H. Nikolaus Schaller" <hns@goldelico.com>, Merlijn Wajer <merlijn@wizzup.org>,
 Sebastian Reichel <sebastian.reichel@collabora.com>,
 dri-devel@lists.freedesktop.org, linux-omap@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

Q3JlYXRlIGEgY3VzdG9tIGZ1bmN0aW9uIHBvaW50ZXIgZm9yIFVMUFMgYW5kIHVzZSBpdCBpbnN0
ZWFkIG9mCnJldXNpbmcgZGlzYWJsZS9lbmFibGUgZnVuY3Rpb25zIGZvciBVTFBTIG1vZGUgc3dp
dGNoLiBUaGlzIGFsbG93cwp1cyB0byB1c2UgdGhlIGNvbW1vbiBkaXNhYmxlL2VuYWJsZSBmdW5j
dGlvbnMgcG9pbnRlcnMgZm9yIERTSS4KClNpZ25lZC1vZmYtYnk6IFNlYmFzdGlhbiBSZWljaGVs
IDxzZWJhc3RpYW4ucmVpY2hlbEBjb2xsYWJvcmEuY29tPgotLS0KIC4uLi9ncHUvZHJtL29tYXBk
cm0vZGlzcGxheXMvcGFuZWwtZHNpLWNtLmMgICB8ICA4ICsrLS0KIGRyaXZlcnMvZ3B1L2RybS9v
bWFwZHJtL2Rzcy9kc2kuYyAgICAgICAgICAgICB8IDM4ICsrKysrKysrKysrKysrLS0tLS0KIGRy
aXZlcnMvZ3B1L2RybS9vbWFwZHJtL2Rzcy9vbWFwZHNzLmggICAgICAgICB8ICA1ICstLQogMyBm
aWxlcyBjaGFuZ2VkLCAzNCBpbnNlcnRpb25zKCspLCAxNyBkZWxldGlvbnMoLSkKCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kaXNwbGF5cy9wYW5lbC1kc2ktY20uYyBiL2Ry
aXZlcnMvZ3B1L2RybS9vbWFwZHJtL2Rpc3BsYXlzL3BhbmVsLWRzaS1jbS5jCmluZGV4IDM2MTAx
ZDliYTg0ZC4uZjczYjhmNDg5ZjgyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vb21hcGRy
bS9kaXNwbGF5cy9wYW5lbC1kc2ktY20uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9k
aXNwbGF5cy9wYW5lbC1kc2ktY20uYwpAQCAtMjMzLDcgKzIzMyw3IEBAIHN0YXRpYyBpbnQgZHNp
Y21fZW50ZXJfdWxwcyhzdHJ1Y3QgcGFuZWxfZHJ2X2RhdGEgKmRkYXRhKQogCWlmIChyKQogCQln
b3RvIGVycjsKIAotCXNyYy0+b3BzLT5kc2kuZGlzYWJsZShzcmMsIGZhbHNlLCB0cnVlKTsKKwlz
cmMtPm9wcy0+ZHNpLnVscHMoc3JjLCB0cnVlKTsKIAogCWRkYXRhLT51bHBzX2VuYWJsZWQgPSB0
cnVlOwogCkBAIC0yNTgsNyArMjU4LDcgQEAgc3RhdGljIGludCBkc2ljbV9leGl0X3VscHMoc3Ry
dWN0IHBhbmVsX2Rydl9kYXRhICpkZGF0YSkKIAlpZiAoIWRkYXRhLT51bHBzX2VuYWJsZWQpCiAJ
CXJldHVybiAwOwogCi0Jc3JjLT5vcHMtPmVuYWJsZShzcmMpOworCXNyYy0+b3BzLT5kc2kudWxw
cyhzcmMsIGZhbHNlKTsKIAlkZGF0YS0+ZHNpLT5tb2RlX2ZsYWdzICY9IH5NSVBJX0RTSV9NT0RF
X0xQTTsKIAogCXIgPSBfZHNpY21fZW5hYmxlX3RlKGRkYXRhLCBkZGF0YS0+dGVfZW5hYmxlZCk7
CkBAIC01ODYsNyArNTg2LDcgQEAgc3RhdGljIGludCBkc2ljbV9wb3dlcl9vbihzdHJ1Y3QgcGFu
ZWxfZHJ2X2RhdGEgKmRkYXRhKQogCiAJZHNpY21faHdfcmVzZXQoZGRhdGEpOwogCi0Jc3JjLT5v
cHMtPmRzaS5kaXNhYmxlKHNyYywgdHJ1ZSwgZmFsc2UpOworCXNyYy0+b3BzLT5kaXNhYmxlKHNy
Yyk7CiBlcnJfcmVndWxhdG9yczoKIAlyID0gcmVndWxhdG9yX2J1bGtfZGlzYWJsZShEQ1NfUkVH
VUxBVE9SX1NVUFBMWV9OVU0sIGRkYXRhLT5zdXBwbGllcyk7CiAJaWYgKHIpCkBAIC02MTIsNyAr
NjEyLDcgQEAgc3RhdGljIHZvaWQgZHNpY21fcG93ZXJfb2ZmKHN0cnVjdCBwYW5lbF9kcnZfZGF0
YSAqZGRhdGEpCiAJCWRzaWNtX2h3X3Jlc2V0KGRkYXRhKTsKIAl9CiAKLQlzcmMtPm9wcy0+ZHNp
LmRpc2FibGUoc3JjLCB0cnVlLCBmYWxzZSk7CisJc3JjLT5vcHMtPmRpc2FibGUoc3JjKTsKIAog
CXIgPSByZWd1bGF0b3JfYnVsa19kaXNhYmxlKERDU19SRUdVTEFUT1JfU1VQUExZX05VTSwgZGRh
dGEtPnN1cHBsaWVzKTsKIAlpZiAocikKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9vbWFw
ZHJtL2Rzcy9kc2kuYyBiL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL2Rzcy9kc2kuYwppbmRleCA4
Mzg3YWJlYTIxYTUuLmQyMDBiN2E2ZjkzYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL29t
YXBkcm0vZHNzL2RzaS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL2Rzcy9kc2kuYwpA
QCAtNDA2MiwxMyArNDA2MiwxMCBAQCBzdGF0aWMgdm9pZCBkc2lfZGlzcGxheV91bmluaXRfZHNp
KHN0cnVjdCBkc2lfZGF0YSAqZHNpLCBib29sIGRpc2Nvbm5lY3RfbGFuZXMsCiAJfQogfQogCi1z
dGF0aWMgdm9pZCBkc2lfZGlzcGxheV9lbmFibGUoc3RydWN0IG9tYXBfZHNzX2RldmljZSAqZHNz
ZGV2KQorc3RhdGljIHZvaWQgZHNpX2Rpc3BsYXlfdWxwc19lbmFibGUoc3RydWN0IGRzaV9kYXRh
ICpkc2kpCiB7Ci0Jc3RydWN0IGRzaV9kYXRhICpkc2kgPSB0b19kc2lfZGF0YShkc3NkZXYpOwog
CWludCByOwogCi0JRFNTREJHKCJkc2lfZGlzcGxheV9lbmFibGVcbiIpOwotCiAJV0FSTl9PTigh
ZHNpX2J1c19pc19sb2NrZWQoZHNpKSk7CiAKIAltdXRleF9sb2NrKCZkc2ktPmxvY2spOwpAQCAt
NDA5MSwxNiArNDA4OCwxOSBAQCBzdGF0aWMgdm9pZCBkc2lfZGlzcGxheV9lbmFibGUoc3RydWN0
IG9tYXBfZHNzX2RldmljZSAqZHNzZGV2KQogCWRzaV9ydW50aW1lX3B1dChkc2kpOwogZXJyX2dl
dF9kc2k6CiAJbXV0ZXhfdW5sb2NrKCZkc2ktPmxvY2spOwotCURTU0RCRygiZHNpX2Rpc3BsYXlf
ZW5hYmxlIEZBSUxFRFxuIik7CisJRFNTREJHKCJkc2lfZGlzcGxheV91bHBzX2VuYWJsZSBGQUlM
RURcbiIpOwogfQogCi1zdGF0aWMgdm9pZCBkc2lfZGlzcGxheV9kaXNhYmxlKHN0cnVjdCBvbWFw
X2Rzc19kZXZpY2UgKmRzc2RldiwKLQkJYm9vbCBkaXNjb25uZWN0X2xhbmVzLCBib29sIGVudGVy
X3VscHMpCitzdGF0aWMgdm9pZCBkc2lfZGlzcGxheV9lbmFibGUoc3RydWN0IG9tYXBfZHNzX2Rl
dmljZSAqZHNzZGV2KQogewogCXN0cnVjdCBkc2lfZGF0YSAqZHNpID0gdG9fZHNpX2RhdGEoZHNz
ZGV2KTsKKwlEU1NEQkcoImRzaV9kaXNwbGF5X2VuYWJsZVxuIik7CisJZHNpX2Rpc3BsYXlfdWxw
c19lbmFibGUoZHNpKTsKK30KIAotCURTU0RCRygiZHNpX2Rpc3BsYXlfZGlzYWJsZVxuIik7Ci0K
K3N0YXRpYyB2b2lkIGRzaV9kaXNwbGF5X3VscHNfZGlzYWJsZShzdHJ1Y3QgZHNpX2RhdGEgKmRz
aSwKKwkJYm9vbCBkaXNjb25uZWN0X2xhbmVzLCBib29sIGVudGVyX3VscHMpCit7CiAJV0FSTl9P
TighZHNpX2J1c19pc19sb2NrZWQoZHNpKSk7CiAKIAltdXRleF9sb2NrKCZkc2ktPmxvY2spOwpA
QCAtNDExNyw2ICs0MTE3LDIzIEBAIHN0YXRpYyB2b2lkIGRzaV9kaXNwbGF5X2Rpc2FibGUoc3Ry
dWN0IG9tYXBfZHNzX2RldmljZSAqZHNzZGV2LAogCW11dGV4X3VubG9jaygmZHNpLT5sb2NrKTsK
IH0KIAorc3RhdGljIHZvaWQgZHNpX2Rpc3BsYXlfZGlzYWJsZShzdHJ1Y3Qgb21hcF9kc3NfZGV2
aWNlICpkc3NkZXYpCit7CisJc3RydWN0IGRzaV9kYXRhICpkc2kgPSB0b19kc2lfZGF0YShkc3Nk
ZXYpOworCURTU0RCRygiZHNpX2Rpc3BsYXlfZGlzYWJsZVxuIik7CisJZHNpX2Rpc3BsYXlfdWxw
c19kaXNhYmxlKGRzaSwgdHJ1ZSwgZmFsc2UpOworfQorCitzdGF0aWMgdm9pZCBkc2lfdWxwcyhz
dHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpkc3NkZXYsIGJvb2wgZW5hYmxlKQoreworCXN0cnVjdCBk
c2lfZGF0YSAqZHNpID0gdG9fZHNpX2RhdGEoZHNzZGV2KTsKKwlEU1NEQkcoImRzaV91bHBzXG4i
KTsKKwlpZiAoZW5hYmxlKQorCQlkc2lfZGlzcGxheV91bHBzX2Rpc2FibGUoZHNpLCBmYWxzZSwg
dHJ1ZSk7CisJZWxzZQorCQlkc2lfZGlzcGxheV91bHBzX2VuYWJsZShkc2kpOworfQorCiBzdGF0
aWMgaW50IGRzaV9lbmFibGVfdGUoc3RydWN0IGRzaV9kYXRhICpkc2ksIGJvb2wgZW5hYmxlKQog
ewogCWRzaS0+dGVfZW5hYmxlZCA9IGVuYWJsZTsKQEAgLTQ4MTgsOSArNDgzNSwxMCBAQCBzdGF0
aWMgY29uc3Qgc3RydWN0IG9tYXBfZHNzX2RldmljZV9vcHMgZHNpX29wcyA9IHsKIAkuY29ubmVj
dCA9IGRzaV9jb25uZWN0LAogCS5kaXNjb25uZWN0ID0gZHNpX2Rpc2Nvbm5lY3QsCiAJLmVuYWJs
ZSA9IGRzaV9kaXNwbGF5X2VuYWJsZSwKKwkuZGlzYWJsZSA9IGRzaV9kaXNwbGF5X2Rpc2FibGUs
CiAKIAkuZHNpID0gewotCQkuZGlzYWJsZSA9IGRzaV9kaXNwbGF5X2Rpc2FibGUsCisJCS51bHBz
ID0gZHNpX3VscHMsCiAKIAkJLnNldF9jb25maWcgPSBkc2lfc2V0X2NvbmZpZywKIApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vZHNzL29tYXBkc3MuaCBiL2RyaXZlcnMvZ3B1
L2RybS9vbWFwZHJtL2Rzcy9vbWFwZHNzLmgKaW5kZXggMmQ2YWI5NDhhNmRkLi5hZDUyNWNmODBh
ZDggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL2Rzcy9vbWFwZHNzLmgKKysr
IGIvZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vZHNzL29tYXBkc3MuaApAQCAtMjg3LDEwICsyODcs
OSBAQCBzdHJ1Y3Qgb21hcGRzc19oZG1pX29wcyB7CiB9OwogCiBzdHJ1Y3Qgb21hcGRzc19kc2lf
b3BzIHsKLQl2b2lkICgqZGlzYWJsZSkoc3RydWN0IG9tYXBfZHNzX2RldmljZSAqZHNzZGV2LCBi
b29sIGRpc2Nvbm5lY3RfbGFuZXMsCi0JCQlib29sIGVudGVyX3VscHMpOwotCiAJLyogYnVzIGNv
bmZpZ3VyYXRpb24gKi8KKwl2b2lkICgqdWxwcykoc3RydWN0IG9tYXBfZHNzX2RldmljZSAqZHNz
ZGV2LCBib29sIGVuYWJsZSk7CisKIAlpbnQgKCpzZXRfY29uZmlnKShzdHJ1Y3Qgb21hcF9kc3Nf
ZGV2aWNlICpkc3NkZXYsCiAJCQljb25zdCBzdHJ1Y3Qgb21hcF9kc3NfZHNpX2NvbmZpZyAqY2Zn
KTsKIAotLSAKMi4yNC4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3Rv
cC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmkt
ZGV2ZWw=
