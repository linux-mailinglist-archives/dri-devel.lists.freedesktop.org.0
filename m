Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 875FF1E8DB
	for <lists+dri-devel@lfdr.de>; Wed, 15 May 2019 09:22:09 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 5418F89548;
	Wed, 15 May 2019 07:21:54 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
X-Greylist: delayed 961 seconds by postgrey-1.36 at gabe;
 Tue, 14 May 2019 10:56:12 UTC
Received: from huawei.com (szxga07-in.huawei.com [45.249.212.35])
 by gabe.freedesktop.org (Postfix) with ESMTPS id C44468926F
 for <dri-devel@lists.freedesktop.org>; Tue, 14 May 2019 10:56:12 +0000 (UTC)
Received: from DGGEMS402-HUB.china.huawei.com (unknown [172.30.72.58])
 by Forcepoint Email with ESMTP id A749EA890B1BACCFAA64;
 Tue, 14 May 2019 18:40:08 +0800 (CST)
Received: from [127.0.0.1] (10.151.21.212) by DGGEMS402-HUB.china.huawei.com
 (10.3.19.202) with Microsoft SMTP Server id 14.3.439.0; Tue, 14 May 2019
 18:39:58 +0800
Subject: Re: [RFC][PATCH 4/5 v4] dma-buf: heaps: Add CMA heap to dmabuf heaps
To: John Stultz <john.stultz@linaro.org>, lkml <linux-kernel@vger.kernel.org>
References: <20190513183727.15755-1-john.stultz@linaro.org>
 <20190513183727.15755-5-john.stultz@linaro.org>
From: "Xiaqing (A)" <saberlily.xia@hisilicon.com>
Message-ID: <0333e2b3-0e3d-360e-c8ac-62f3235d24be@hisilicon.com>
Date: Tue, 14 May 2019 18:39:36 +0800
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:52.0) Gecko/20100101
 Thunderbird/52.3.0
MIME-Version: 1.0
In-Reply-To: <20190513183727.15755-5-john.stultz@linaro.org>
Content-Language: en-US
X-Originating-IP: [10.151.21.212]
X-CFilter-Loop: Reflected
X-Mailman-Approved-At: Wed, 15 May 2019 07:21:53 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Yudongbin <yudongbin@hisilicon.com>, Sudipto Paul <Sudipto.Paul@arm.com>,
 Xu YiPing <xuyiping@hisilicon.com>,
 Vincent Donnefort <Vincent.Donnefort@arm.com>,
 "Chenfeng \(puck\)" <puck.chen@hisilicon.com>, Kongfei <kongfei@hisilicon.com>,
 Chenbo Feng <fengc@google.com>, Alistair Strachan <astrachan@google.com>,
 Liam Mark <lmark@codeaurora.org>, Christoph Hellwig <hch@infradead.org>,
 dri-devel@lists.freedesktop.org, "Andrew F
 . Davis" <afd@ti.com>, "Liuyi \(Daniel\)" <daniel.liuyi@hisilicon.com>,
 Pratik Patel <pratikp@codeaurora.org>, butao <butao@hisilicon.com>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

CgpPbiAyMDE5LzUvMTQgMjozNywgSm9obiBTdHVsdHogd3JvdGU6Cj4gVGhpcyBhZGRzIGEgQ01B
IGhlYXAsIHdoaWNoIGFsbG93cyB1c2Vyc3BhY2UgdG8gYWxsb2NhdGUKPiBhIGRtYS1idWYgb2Yg
Y29udGlndW91cyBtZW1vcnkgb3V0IG9mIGEgQ01BIHJlZ2lvbi4KPiAKPiBUaGlzIGNvZGUgaXMg
YW4gZXZvbHV0aW9uIG9mIHRoZSBBbmRyb2lkIElPTiBpbXBsZW1lbnRhdGlvbiwgc28KPiB0aGFu
a3MgdG8gaXRzIG9yaWdpbmFsIGF1dGhvciBhbmQgbWFpbnRhaW50ZXJzOgo+ICAgIEJlbmphbWlu
IEdhaWduYXJkLCBMYXVyYSBBYmJvdHQsIGFuZCBvdGhlcnMhCj4gCj4gQ2M6IExhdXJhIEFiYm90
dCA8bGFiYm90dEByZWRoYXQuY29tPgo+IENjOiBCZW5qYW1pbiBHYWlnbmFyZCA8YmVuamFtaW4u
Z2FpZ25hcmRAbGluYXJvLm9yZz4KPiBDYzogU3VtaXQgU2Vtd2FsIDxzdW1pdC5zZW13YWxAbGlu
YXJvLm9yZz4KPiBDYzogTGlhbSBNYXJrIDxsbWFya0Bjb2RlYXVyb3JhLm9yZz4KPiBDYzogUHJh
dGlrIFBhdGVsIDxwcmF0aWtwQGNvZGVhdXJvcmEub3JnPgo+IENjOiBCcmlhbiBTdGFya2V5IDxC
cmlhbi5TdGFya2V5QGFybS5jb20+Cj4gQ2M6IFZpbmNlbnQgRG9ubmVmb3J0IDxWaW5jZW50LkRv
bm5lZm9ydEBhcm0uY29tPgo+IENjOiBTdWRpcHRvIFBhdWwgPFN1ZGlwdG8uUGF1bEBhcm0uY29t
Pgo+IENjOiBBbmRyZXcgRi4gRGF2aXMgPGFmZEB0aS5jb20+Cj4gQ2M6IFh1IFlpUGluZyA8eHV5
aXBpbmdAaGlzaWxpY29uLmNvbT4KPiBDYzogIkNoZW5mZW5nIChwdWNrKSIgPHB1Y2suY2hlbkBo
aXNpbGljb24uY29tPgo+IENjOiBidXRhbyA8YnV0YW9AaGlzaWxpY29uLmNvbT4KPiBDYzogIlhp
YXFpbmcgKEEpIiA8c2FiZXJsaWx5LnhpYUBoaXNpbGljb24uY29tPgo+IENjOiBZdWRvbmdiaW4g
PHl1ZG9uZ2JpbkBoaXNpbGljb24uY29tPgo+IENjOiBDaHJpc3RvcGggSGVsbHdpZyA8aGNoQGlu
ZnJhZGVhZC5vcmc+Cj4gQ2M6IENoZW5ibyBGZW5nIDxmZW5nY0Bnb29nbGUuY29tPgo+IENjOiBB
bGlzdGFpciBTdHJhY2hhbiA8YXN0cmFjaGFuQGdvb2dsZS5jb20+Cj4gQ2M6IGRyaS1kZXZlbEBs
aXN0cy5mcmVlZGVza3RvcC5vcmcKPiBTaWduZWQtb2ZmLWJ5OiBKb2huIFN0dWx0eiA8am9obi5z
dHVsdHpAbGluYXJvLm9yZz4KPiAtLS0KPiB2MjoKPiAqIFN3aXRjaCBhbGxvY2F0ZSB0byByZXR1
cm4gZG1hYnVmIGZkCj4gKiBTaW1wbGlmeSBpbml0IGNvZGUKPiAqIENoZWNrcGF0Y2ggZml4dXBz
Cj4gdjM6Cj4gKiBTd2l0Y2ggdG8gaW5saW5lIGZ1bmN0aW9uIGZvciB0b19jbWFfaGVhcCgpCj4g
KiBNaW5vciBjbGVhbnVwcyBzdWdnZXN0ZWQgYnkgQnJpYW4KPiAqIEZvbGQgaW4gbmV3IHJlZ2lz
dHJhdGlvbiBzdHlsZSBmcm9tIEFuZHJldwo+ICogRm9sZGVkIGluIGNoYW5nZXMgZnJvbSBBbmRy
ZXcgdG8gdXNlIHNpbXBsaWZpZWQgcGFnZSBsaXN0Cj4gICAgZnJvbSB0aGUgaGVhcCBoZWxwZXJz
Cj4gKiBVc2UgdGhlIGZkX2ZsYWdzIHdoZW4gY3JlYXRpbmcgZG1hYnVmIGZkIChTdWdnZXN0ZWQg
YnkKPiAgICBCZW5qYW1pbikKPiAqIFVzZSBwcmVjYWxjdWxhdGVkIHBhZ2Vjb3VudCAoU3VnZ2Vz
dGVkIGJ5IEFuZHJldykKPiAtLS0KPiAgIGRyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9LY29uZmlnICAg
IHwgICA4ICsrCj4gICBkcml2ZXJzL2RtYS1idWYvaGVhcHMvTWFrZWZpbGUgICB8ICAgMSArCj4g
ICBkcml2ZXJzL2RtYS1idWYvaGVhcHMvY21hX2hlYXAuYyB8IDE2OSArKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrCj4gICAzIGZpbGVzIGNoYW5nZWQsIDE3OCBpbnNlcnRpb25zKCspCj4g
ICBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9kbWEtYnVmL2hlYXBzL2NtYV9oZWFwLmMKPiAK
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9kbWEtYnVmL2hlYXBzL0tjb25maWcgYi9kcml2ZXJzL2Rt
YS1idWYvaGVhcHMvS2NvbmZpZwo+IGluZGV4IDIwNTA1Mjc0NDE2OS4uYTVlZWYwNmM0MjI2IDEw
MDY0NAo+IC0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9LY29uZmlnCj4gKysrIGIvZHJpdmVy
cy9kbWEtYnVmL2hlYXBzL0tjb25maWcKPiBAQCAtNCwzICs0LDExIEBAIGNvbmZpZyBETUFCVUZf
SEVBUFNfU1lTVEVNCj4gICAJaGVscAo+ICAgCSAgQ2hvb3NlIHRoaXMgb3B0aW9uIHRvIGVuYWJs
ZSB0aGUgc3lzdGVtIGRtYWJ1ZiBoZWFwLiBUaGUgc3lzdGVtIGhlYXAKPiAgIAkgIGlzIGJhY2tl
ZCBieSBwYWdlcyBmcm9tIHRoZSBidWRkeSBhbGxvY2F0b3IuIElmIGluIGRvdWJ0LCBzYXkgWS4K
PiArCj4gK2NvbmZpZyBETUFCVUZfSEVBUFNfQ01BCj4gKwlib29sICJETUEtQlVGIENNQSBIZWFw
Igo+ICsJZGVwZW5kcyBvbiBETUFCVUZfSEVBUFMgJiYgRE1BX0NNQQo+ICsJaGVscAo+ICsJICBD
aG9vc2UgdGhpcyBvcHRpb24gdG8gZW5hYmxlIGRtYS1idWYgQ01BIGhlYXAuIFRoaXMgaGVhcCBp
cyBiYWNrZWQKPiArCSAgYnkgdGhlIENvbnRpZ3VvdXMgTWVtb3J5IEFsbG9jYXRvciAoQ01BKS4g
SWYgeW91ciBzeXN0ZW0gaGFzIHRoZXNlCj4gKwkgIHJlZ2lvbnMsIHlvdSBzaG91bGQgc2F5IFkg
aGVyZS4KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9kbWEtYnVmL2hlYXBzL01ha2VmaWxlIGIvZHJp
dmVycy9kbWEtYnVmL2hlYXBzL01ha2VmaWxlCj4gaW5kZXggZDE4MDhlY2EyNTgxLi42ZTU0Y2Rl
YzNkYTAgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9kbWEtYnVmL2hlYXBzL01ha2VmaWxlCj4gKysr
IGIvZHJpdmVycy9kbWEtYnVmL2hlYXBzL01ha2VmaWxlCj4gQEAgLTEsMyArMSw0IEBACj4gICAj
IFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCj4gICBvYmoteQkJCQkJKz0gaGVhcC1o
ZWxwZXJzLm8KPiAgIG9iai0kKENPTkZJR19ETUFCVUZfSEVBUFNfU1lTVEVNKQkrPSBzeXN0ZW1f
aGVhcC5vCj4gK29iai0kKENPTkZJR19ETUFCVUZfSEVBUFNfQ01BKQkJKz0gY21hX2hlYXAubwo+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2RtYS1idWYvaGVhcHMvY21hX2hlYXAuYyBiL2RyaXZlcnMv
ZG1hLWJ1Zi9oZWFwcy9jbWFfaGVhcC5jCj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRleCAw
MDAwMDAwMDAwMDAuLjNkMGZmYmJkMGEzNAo+IC0tLSAvZGV2L251bGwKPiArKysgYi9kcml2ZXJz
L2RtYS1idWYvaGVhcHMvY21hX2hlYXAuYwo+IEBAIC0wLDAgKzEsMTY5IEBACj4gKy8vIFNQRFgt
TGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCj4gKy8qCj4gKyAqIERNQUJVRiBDTUEgaGVhcCBl
eHBvcnRlcgo+ICsgKgo+ICsgKiBDb3B5cmlnaHQgKEMpIDIwMTIsIDIwMTkgTGluYXJvIEx0ZC4K
PiArICogQXV0aG9yOiA8YmVuamFtaW4uZ2FpZ25hcmRAbGluYXJvLm9yZz4gZm9yIFNULUVyaWNz
c29uLgo+ICsgKi8KPiArCj4gKyNpbmNsdWRlIDxsaW51eC9kZXZpY2UuaD4KPiArI2luY2x1ZGUg
PGxpbnV4L2RtYS1idWYuaD4KPiArI2luY2x1ZGUgPGxpbnV4L2RtYS1oZWFwLmg+Cj4gKyNpbmNs
dWRlIDxsaW51eC9zbGFiLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9lcnJuby5oPgo+ICsjaW5jbHVk
ZSA8bGludXgvZXJyLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9jbWEuaD4KPiArI2luY2x1ZGUgPGxp
bnV4L3NjYXR0ZXJsaXN0Lmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9oaWdobWVtLmg+Cj4gKwo+ICsj
aW5jbHVkZSAiaGVhcC1oZWxwZXJzLmgiCj4gKwo+ICtzdHJ1Y3QgY21hX2hlYXAgewo+ICsJc3Ry
dWN0IGRtYV9oZWFwICpoZWFwOwo+ICsJc3RydWN0IGNtYSAqY21hOwo+ICt9Owo+ICsKPiArc3Rh
dGljIHZvaWQgY21hX2hlYXBfZnJlZShzdHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICpidWZmZXIp
Cj4gK3sKPiArCXN0cnVjdCBjbWFfaGVhcCAqY21hX2hlYXAgPSBkbWFfaGVhcF9nZXRfZGF0YShi
dWZmZXItPmhlYXBfYnVmZmVyLmhlYXApOwo+ICsJdW5zaWduZWQgbG9uZyBucl9wYWdlcyA9IGJ1
ZmZlci0+cGFnZWNvdW50Owo+ICsJc3RydWN0IHBhZ2UgKnBhZ2VzID0gYnVmZmVyLT5wcml2X3Zp
cnQ7Cj4gKwo+ICsJLyogZnJlZSBwYWdlIGxpc3QgKi8KPiArCWtmcmVlKGJ1ZmZlci0+cGFnZXMp
Owo+ICsJLyogcmVsZWFzZSBtZW1vcnkgKi8KPiArCWNtYV9yZWxlYXNlKGNtYV9oZWFwLT5jbWEs
IHBhZ2VzLCBucl9wYWdlcyk7Cj4gKwlrZnJlZShidWZmZXIpOwo+ICt9Cj4gKwo+ICsvKiBkbWFi
dWYgaGVhcCBDTUEgb3BlcmF0aW9ucyBmdW5jdGlvbnMgKi8KPiArc3RhdGljIGludCBjbWFfaGVh
cF9hbGxvY2F0ZShzdHJ1Y3QgZG1hX2hlYXAgKmhlYXAsCj4gKwkJCQl1bnNpZ25lZCBsb25nIGxl
biwKPiArCQkJCXVuc2lnbmVkIGxvbmcgZmRfZmxhZ3MsCj4gKwkJCQl1bnNpZ25lZCBsb25nIGhl
YXBfZmxhZ3MpCj4gK3sKPiArCXN0cnVjdCBjbWFfaGVhcCAqY21hX2hlYXAgPSBkbWFfaGVhcF9n
ZXRfZGF0YShoZWFwKTsKPiArCXN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKmhlbHBlcl9idWZm
ZXI7Cj4gKwlzdHJ1Y3QgcGFnZSAqcGFnZXM7Cj4gKwlzaXplX3Qgc2l6ZSA9IFBBR0VfQUxJR04o
bGVuKTsKPiArCXVuc2lnbmVkIGxvbmcgbnJfcGFnZXMgPSBzaXplID4+IFBBR0VfU0hJRlQ7Cj4g
Kwl1bnNpZ25lZCBsb25nIGFsaWduID0gZ2V0X29yZGVyKHNpemUpOwo+ICsJREVGSU5FX0RNQV9C
VUZfRVhQT1JUX0lORk8oZXhwX2luZm8pOwo+ICsJc3RydWN0IGRtYV9idWYgKmRtYWJ1ZjsKPiAr
CWludCByZXQgPSAtRU5PTUVNOwo+ICsJcGdvZmZfdCBwZzsKPiArCj4gKwlpZiAoYWxpZ24gPiBD
T05GSUdfQ01BX0FMSUdOTUVOVCkKPiArCQlhbGlnbiA9IENPTkZJR19DTUFfQUxJR05NRU5UOwo+
ICsKPiArCWhlbHBlcl9idWZmZXIgPSBremFsbG9jKHNpemVvZigqaGVscGVyX2J1ZmZlciksIEdG
UF9LRVJORUwpOwo+ICsJaWYgKCFoZWxwZXJfYnVmZmVyKQo+ICsJCXJldHVybiAtRU5PTUVNOwo+
ICsKPiArCUlOSVRfSEVBUF9IRUxQRVJfQlVGRkVSKGhlbHBlcl9idWZmZXIsIGNtYV9oZWFwX2Zy
ZWUpOwo+ICsJaGVscGVyX2J1ZmZlci0+aGVhcF9idWZmZXIuZmxhZ3MgPSBoZWFwX2ZsYWdzOwo+
ICsJaGVscGVyX2J1ZmZlci0+aGVhcF9idWZmZXIuaGVhcCA9IGhlYXA7Cj4gKwloZWxwZXJfYnVm
ZmVyLT5oZWFwX2J1ZmZlci5zaXplID0gbGVuOwo+ICsKPiArCXBhZ2VzID0gY21hX2FsbG9jKGNt
YV9oZWFwLT5jbWEsIG5yX3BhZ2VzLCBhbGlnbiwgZmFsc2UpOwo+ICsJaWYgKCFwYWdlcykKPiAr
CQlnb3RvIGZyZWVfYnVmOwo+ICsKPiArCWlmIChQYWdlSGlnaE1lbShwYWdlcykpIHsKPiArCQl1
bnNpZ25lZCBsb25nIG5yX2NsZWFyX3BhZ2VzID0gbnJfcGFnZXM7Cj4gKwkJc3RydWN0IHBhZ2Ug
KnBhZ2UgPSBwYWdlczsKPiArCj4gKwkJd2hpbGUgKG5yX2NsZWFyX3BhZ2VzID4gMCkgewo+ICsJ
CQl2b2lkICp2YWRkciA9IGttYXBfYXRvbWljKHBhZ2UpOwo+ICsKPiArCQkJbWVtc2V0KHZhZGRy
LCAwLCBQQUdFX1NJWkUpOwo+ICsJCQlrdW5tYXBfYXRvbWljKHZhZGRyKTsKPiArCQkJcGFnZSsr
Owo+ICsJCQlucl9jbGVhcl9wYWdlcy0tOwo+ICsJCX0KPiArCX0gZWxzZSB7Cj4gKwkJbWVtc2V0
KHBhZ2VfYWRkcmVzcyhwYWdlcyksIDAsIHNpemUpOwo+ICsJfQo+ICsKPiArCWhlbHBlcl9idWZm
ZXItPnBhZ2Vjb3VudCA9IG5yX3BhZ2VzOwo+ICsJaGVscGVyX2J1ZmZlci0+cGFnZXMgPSBrbWFs
bG9jX2FycmF5KGhlbHBlcl9idWZmZXItPnBhZ2Vjb3VudCwKPiArCQkJCQkgICAgIHNpemVvZigq
aGVscGVyX2J1ZmZlci0+cGFnZXMpLAo+ICsJCQkJCSAgICAgR0ZQX0tFUk5FTCk7Cj4gKwlpZiAo
IWhlbHBlcl9idWZmZXItPnBhZ2VzKSB7Cj4gKwkJcmV0ID0gLUVOT01FTTsKPiArCQlnb3RvIGZy
ZWVfY21hOwo+ICsJfQo+ICsKPiArCWZvciAocGcgPSAwOyBwZyA8IGhlbHBlcl9idWZmZXItPnBh
Z2Vjb3VudDsgcGcrKykgewo+ICsJCWhlbHBlcl9idWZmZXItPnBhZ2VzW3BnXSA9ICZwYWdlc1tw
Z107Cj4gKwkJaWYgKCFoZWxwZXJfYnVmZmVyLT5wYWdlc1twZ10pCj4gKwkJCWdvdG8gZnJlZV9w
YWdlczsKPiArCX0KPiArCj4gKwkvKiBjcmVhdGUgdGhlIGRtYWJ1ZiAqLwo+ICsJZXhwX2luZm8u
b3BzID0gJmhlYXBfaGVscGVyX29wczsKPiArCWV4cF9pbmZvLnNpemUgPSBsZW47Cj4gKwlleHBf
aW5mby5mbGFncyA9IGZkX2ZsYWdzOwo+ICsJZXhwX2luZm8ucHJpdiA9ICZoZWxwZXJfYnVmZmVy
LT5oZWFwX2J1ZmZlcjsKPiArCWRtYWJ1ZiA9IGRtYV9idWZfZXhwb3J0KCZleHBfaW5mbyk7Cj4g
KwlpZiAoSVNfRVJSKGRtYWJ1ZikpIHsKPiArCQlyZXQgPSBQVFJfRVJSKGRtYWJ1Zik7Cj4gKwkJ
Z290byBmcmVlX3BhZ2VzOwo+ICsJfQpDYW4gdGhlIGRtYWJ1ZiBiZSBjcmVhdGVkIGluIHRoZSBm
cmFtZXdvcmsgbGF5ZXI/CmVhY2ggaGVhcCBuZWVkcyB0byBhZGQgdGhlIHNhbWUgY29kZSBoZXJl
LCB3aGljaCBpcyBub3QgdmVyeSBnb29kLgoKPiArCj4gKwloZWxwZXJfYnVmZmVyLT5oZWFwX2J1
ZmZlci5kbWFidWYgPSBkbWFidWY7Cj4gKwloZWxwZXJfYnVmZmVyLT5wcml2X3ZpcnQgPSBwYWdl
czsKPiArCj4gKwlyZXQgPSBkbWFfYnVmX2ZkKGRtYWJ1ZiwgZmRfZmxhZ3MpOwo+ICsJaWYgKHJl
dCA8IDApIHsKPiArCQlkbWFfYnVmX3B1dChkbWFidWYpOwo+ICsJCS8qIGp1c3QgcmV0dXJuLCBh
cyBwdXQgd2lsbCBjYWxsIHJlbGVhc2UgYW5kIHRoYXQgd2lsbCBmcmVlICovCj4gKwkJcmV0dXJu
IHJldDsKPiArCX0KPiArCj4gKwlyZXR1cm4gcmV0Owo+ICsKPiArZnJlZV9wYWdlczoKPiArCWtm
cmVlKGhlbHBlcl9idWZmZXItPnBhZ2VzKTsKPiArZnJlZV9jbWE6Cj4gKwljbWFfcmVsZWFzZShj
bWFfaGVhcC0+Y21hLCBwYWdlcywgbnJfcGFnZXMpOwo+ICtmcmVlX2J1ZjoKPiArCWtmcmVlKGhl
bHBlcl9idWZmZXIpOwo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKPiArc3RhdGljIHN0cnVjdCBk
bWFfaGVhcF9vcHMgY21hX2hlYXBfb3BzID0gewo+ICsJLmFsbG9jYXRlID0gY21hX2hlYXBfYWxs
b2NhdGUsCj4gK307Cj4gKwo+ICtzdGF0aWMgaW50IF9fYWRkX2NtYV9oZWFwKHN0cnVjdCBjbWEg
KmNtYSwgdm9pZCAqZGF0YSkKPiArewo+ICsJc3RydWN0IGNtYV9oZWFwICpjbWFfaGVhcDsKPiAr
CXN0cnVjdCBkbWFfaGVhcF9leHBvcnRfaW5mbyBleHBfaW5mbzsKPiArCj4gKwljbWFfaGVhcCA9
IGt6YWxsb2Moc2l6ZW9mKCpjbWFfaGVhcCksIEdGUF9LRVJORUwpOwo+ICsJaWYgKCFjbWFfaGVh
cCkKPiArCQlyZXR1cm4gLUVOT01FTTsKPiArCWNtYV9oZWFwLT5jbWEgPSBjbWE7Cj4gKwo+ICsJ
ZXhwX2luZm8ubmFtZSA9IGNtYV9nZXRfbmFtZShjbWEpOwo+ICsJZXhwX2luZm8ub3BzID0gJmNt
YV9oZWFwX29wczsKPiArCWV4cF9pbmZvLnByaXYgPSBjbWFfaGVhcDsKPiArCj4gKwljbWFfaGVh
cC0+aGVhcCA9IGRtYV9oZWFwX2FkZCgmZXhwX2luZm8pOwo+ICsJaWYgKElTX0VSUihjbWFfaGVh
cC0+aGVhcCkpIHsKPiArCQlpbnQgcmV0ID0gUFRSX0VSUihjbWFfaGVhcC0+aGVhcCk7Cj4gKwo+
ICsJCWtmcmVlKGNtYV9oZWFwKTsKPiArCQlyZXR1cm4gcmV0Owo+ICsJfQo+ICsKPiArCXJldHVy
biAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGFkZF9jbWFfaGVhcHModm9pZCkKPiArewo+ICsJ
Y21hX2Zvcl9lYWNoX2FyZWEoX19hZGRfY21hX2hlYXAsIE5VTEwpOwo+ICsJcmV0dXJuIDA7Cj4g
K30KPiArZGV2aWNlX2luaXRjYWxsKGFkZF9jbWFfaGVhcHMpOwo+IAoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApk
cmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Au
b3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
