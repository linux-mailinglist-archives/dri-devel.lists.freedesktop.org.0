Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 49A1CFF91D
	for <lists+dri-devel@lfdr.de>; Sun, 17 Nov 2019 12:46:12 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 80C7B6E34E;
	Sun, 17 Nov 2019 11:45:00 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from bhuna.collabora.co.uk (bhuna.collabora.co.uk [46.235.227.227])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 187CA6E1D8
 for <dri-devel@lists.freedesktop.org>; Sun, 17 Nov 2019 02:41:50 +0000 (UTC)
Received: from [127.0.0.1] (localhost [127.0.0.1]) (Authenticated sender: sre)
 with ESMTPSA id A078228F765
Received: by earth.universe (Postfix, from userid 1000)
 id A965A3C0C7F; Sun, 17 Nov 2019 03:41:39 +0100 (CET)
From: Sebastian Reichel <sebastian.reichel@collabora.com>
To: Sebastian Reichel <sre@kernel.org>,
 Laurent Pinchart <laurent.pinchart@ideasonboard.com>,
 Tomi Valkeinen <tomi.valkeinen@ti.com>
Subject: [RFCv1 07/42] drm/omap: dsi: drop virtual channel logic
Date: Sun, 17 Nov 2019 03:39:53 +0100
Message-Id: <20191117024028.2233-8-sebastian.reichel@collabora.com>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191117024028.2233-1-sebastian.reichel@collabora.com>
References: <20191117024028.2233-1-sebastian.reichel@collabora.com>
MIME-Version: 1.0
X-Mailman-Approved-At: Sun, 17 Nov 2019 11:44:18 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: kernel@collabora.com, Tony Lindgren <tony@atomide.com>,
 "H. Nikolaus Schaller" <hns@goldelico.com>, Merlijn Wajer <merlijn@wizzup.org>,
 Sebastian Reichel <sebastian.reichel@collabora.com>,
 dri-devel@lists.freedesktop.org, linux-omap@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBkcm9wcyB0aGUgdmlydHVhbCBjaGFubmVsIGxvZ2ljLiBBZnRlcndhcmRzIERTSSBjbGll
bnRzCnJlcXVlc3QgdGhlaXIgY2hhbm5lbCBudW1iZXIgYW5kIGdldCB0aGUgdmlydHVhbCBjaGFu
bmVsIHdpdGgKdGhlIHNhbWUgbnVtYmVyIG9yIC1FQlVTWSBpZiBhbHJlYWR5IGluIHVzZS4KClNp
Z25lZC1vZmYtYnk6IFNlYmFzdGlhbiBSZWljaGVsIDxzZWJhc3RpYW4ucmVpY2hlbEBjb2xsYWJv
cmEuY29tPgotLS0KIC4uLi9ncHUvZHJtL29tYXBkcm0vZGlzcGxheXMvcGFuZWwtZHNpLWNtLmMg
ICB8IDExICsrLS0tCiBkcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3MvZHNpLmMgICAgICAgICAg
ICAgfCA0NiArKysrLS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3Mv
b21hcGRzcy5oICAgICAgICAgfCAgNCArLQogMyBmaWxlcyBjaGFuZ2VkLCAxMiBpbnNlcnRpb25z
KCspLCA0OSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vb21hcGRy
bS9kaXNwbGF5cy9wYW5lbC1kc2ktY20uYyBiL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL2Rpc3Bs
YXlzL3BhbmVsLWRzaS1jbS5jCmluZGV4IDA1OTc0MDU5ZjIzMS4uYjUwNWJmZDIyMWZjIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kaXNwbGF5cy9wYW5lbC1kc2ktY20uYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kaXNwbGF5cy9wYW5lbC1kc2ktY20uYwpAQCAt
NzY5LDE5ICs3NjksMTIgQEAgc3RhdGljIGludCBkc2ljbV9jb25uZWN0KHN0cnVjdCBvbWFwX2Rz
c19kZXZpY2UgKnNyYywKIAlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmZGRhdGEtPnBkZXYtPmRldjsK
IAlpbnQgcjsKIAotCXIgPSBzcmMtPm9wcy0+ZHNpLnJlcXVlc3RfdmMoc3JjLCAmZGRhdGEtPmNo
YW5uZWwpOworCXIgPSBzcmMtPm9wcy0+ZHNpLnJlcXVlc3RfdmMoc3JjLCBkZGF0YS0+Y2hhbm5l
bCk7CiAJaWYgKHIpIHsKIAkJZGV2X2VycihkZXYsICJmYWlsZWQgdG8gZ2V0IHZpcnR1YWwgY2hh
bm5lbFxuIik7CiAJCXJldHVybiByOwogCX0KIAotCXIgPSBzcmMtPm9wcy0+ZHNpLnNldF92Y19p
ZChzcmMsIGRkYXRhLT5jaGFubmVsLCBUQ0gpOwotCWlmIChyKSB7Ci0JCWRldl9lcnIoZGV2LCAi
ZmFpbGVkIHRvIHNldCBWQ19JRFxuIik7Ci0JCXNyYy0+b3BzLT5kc2kucmVsZWFzZV92YyhzcmMs
IGRkYXRhLT5jaGFubmVsKTsKLQkJcmV0dXJuIHI7Ci0JfQotCiAJZGRhdGEtPnNyYyA9IHNyYzsK
IAlyZXR1cm4gMDsKIH0KQEAgLTEyMTYsNiArMTIwOSw4IEBAIHN0YXRpYyBpbnQgZHNpY21fcHJv
YmVfb2Yoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKIAlzdHJ1Y3QgZGlzcGxheV90aW1p
bmcgdGltaW5nOwogCWludCBlcnI7CiAKKwlkZGF0YS0+Y2hhbm5lbCA9IFRDSDsKKwogCWRkYXRh
LT5yZXNldF9ncGlvID0gZGV2bV9ncGlvZF9nZXQoJnBkZXYtPmRldiwgInJlc2V0IiwgR1BJT0Rf
T1VUX0xPVyk7CiAJaWYgKElTX0VSUihkZGF0YS0+cmVzZXRfZ3BpbykpIHsKIAkJZXJyID0gUFRS
X0VSUihkZGF0YS0+cmVzZXRfZ3Bpbyk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vb21h
cGRybS9kc3MvZHNpLmMgYi9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3MvZHNpLmMKaW5kZXgg
ZGU0ZWM2MDU1NDkwLi40ZDU1ZTdjOWNkNjUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9v
bWFwZHJtL2Rzcy9kc2kuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3MvZHNpLmMK
QEAgLTM1MCw3ICszNTAsNiBAQCBzdHJ1Y3QgZHNpX2RhdGEgewogCQlzdHJ1Y3Qgb21hcF9kc3Nf
ZGV2aWNlICpkc3NkZXY7CiAJCWVudW0gZmlmb19zaXplIHR4X2ZpZm9fc2l6ZTsKIAkJZW51bSBm
aWZvX3NpemUgcnhfZmlmb19zaXplOwotCQlpbnQgdmNfaWQ7CiAJfSB2Y1s0XTsKIAogCXN0cnVj
dCBtdXRleCBsb2NrOwpAQCAtMjU3OSw3ICsyNTc4LDcgQEAgc3RhdGljIGlubGluZSB2b2lkIGRz
aV92Y193cml0ZV9sb25nX2hlYWRlcihzdHJ1Y3QgZHNpX2RhdGEgKmRzaSwgaW50IGNoYW5uZWws
CiAKIAlXQVJOX09OKCFkc2lfYnVzX2lzX2xvY2tlZChkc2kpKTsKIAotCWRhdGFfaWQgPSBkYXRh
X3R5cGUgfCBkc2ktPnZjW2NoYW5uZWxdLnZjX2lkIDw8IDY7CisJZGF0YV9pZCA9IGRhdGFfdHlw
ZSB8IGNoYW5uZWwgPDwgNjsKIAogCXZhbCA9IEZMRF9WQUwoZGF0YV9pZCwgNywgMCkgfCBGTERf
VkFMKGxlbiwgMjMsIDgpIHwKIAkJRkxEX1ZBTChlY2MsIDMxLCAyNCk7CkBAIC0yNjgzLDcgKzI2
ODIsNyBAQCBzdGF0aWMgaW50IGRzaV92Y19zZW5kX3Nob3J0KHN0cnVjdCBkc2lfZGF0YSAqZHNp
LCBpbnQgY2hhbm5lbCwgdTggZGF0YV90eXBlLAogCQlyZXR1cm4gLUVJTlZBTDsKIAl9CiAKLQlk
YXRhX2lkID0gZGF0YV90eXBlIHwgZHNpLT52Y1tjaGFubmVsXS52Y19pZCA8PCA2OworCWRhdGFf
aWQgPSBkYXRhX3R5cGUgfCBjaGFubmVsIDw8IDY7CiAKIAlyID0gKGRhdGFfaWQgPDwgMCkgfCAo
ZGF0YSA8PCA4KSB8IChlY2MgPDwgMjQpOwogCkBAIC00NzgzLDQ1ICs0NzgyLDE5IEBAIHN0YXRp
YyBlbnVtIG9tYXBfY2hhbm5lbCBkc2lfZ2V0X2NoYW5uZWwoc3RydWN0IGRzaV9kYXRhICpkc2kp
CiAJfQogfQogCi1zdGF0aWMgaW50IGRzaV9yZXF1ZXN0X3ZjKHN0cnVjdCBvbWFwX2Rzc19kZXZp
Y2UgKmRzc2RldiwgaW50ICpjaGFubmVsKQorc3RhdGljIGludCBkc2lfcmVxdWVzdF92YyhzdHJ1
Y3Qgb21hcF9kc3NfZGV2aWNlICpkc3NkZXYsIGludCBjaGFubmVsKQogewogCXN0cnVjdCBkc2lf
ZGF0YSAqZHNpID0gdG9fZHNpX2RhdGEoZHNzZGV2KTsKLQlpbnQgaTsKLQotCWZvciAoaSA9IDA7
IGkgPCBBUlJBWV9TSVpFKGRzaS0+dmMpOyBpKyspIHsKLQkJaWYgKCFkc2ktPnZjW2ldLmRzc2Rl
dikgewotCQkJZHNpLT52Y1tpXS5kc3NkZXYgPSBkc3NkZXY7Ci0JCQkqY2hhbm5lbCA9IGk7Ci0J
CQlyZXR1cm4gMDsKLQkJfQotCX0KIAotCURTU0VSUigiY2Fubm90IGdldCBWQyBmb3IgZGlzcGxh
eSAlcyIsIGRzc2Rldi0+bmFtZSk7Ci0JcmV0dXJuIC1FTk9TUEM7Ci19Ci0KLXN0YXRpYyBpbnQg
ZHNpX3NldF92Y19pZChzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpkc3NkZXYsIGludCBjaGFubmVs
LCBpbnQgdmNfaWQpCi17Ci0Jc3RydWN0IGRzaV9kYXRhICpkc2kgPSB0b19kc2lfZGF0YShkc3Nk
ZXYpOwotCi0JaWYgKHZjX2lkIDwgMCB8fCB2Y19pZCA+IDMpIHsKLQkJRFNTRVJSKCJWQyBJRCBv
dXQgb2YgcmFuZ2VcbiIpOwotCQlyZXR1cm4gLUVJTlZBTDsKLQl9Ci0KLQlpZiAoY2hhbm5lbCA8
IDAgfHwgY2hhbm5lbCA+IDMpIHsKLQkJRFNTRVJSKCJWaXJ0dWFsIENoYW5uZWwgb3V0IG9mIHJh
bmdlXG4iKTsKKwlpZiAoY2hhbm5lbCA8IDAgfHwgY2hhbm5lbCA+IDMpCiAJCXJldHVybiAtRUlO
VkFMOwotCX0KIAotCWlmIChkc2ktPnZjW2NoYW5uZWxdLmRzc2RldiAhPSBkc3NkZXYpIHsKLQkJ
RFNTRVJSKCJWaXJ0dWFsIENoYW5uZWwgbm90IGFsbG9jYXRlZCB0byBkaXNwbGF5ICVzXG4iLAot
CQkJZHNzZGV2LT5uYW1lKTsKLQkJcmV0dXJuIC1FSU5WQUw7CisJaWYgKGRzaS0+dmNbY2hhbm5l
bF0uZHNzZGV2KSB7CisJCURTU0VSUigiY2Fubm90IGdldCBWQyBmb3IgZGlzcGxheSAlcyIsIGRz
c2Rldi0+bmFtZSk7CisJCXJldHVybiAtRUJVU1k7CiAJfQogCi0JZHNpLT52Y1tjaGFubmVsXS52
Y19pZCA9IHZjX2lkOwotCisJZHNpLT52Y1tjaGFubmVsXS5kc3NkZXYgPSBkc3NkZXY7CiAJcmV0
dXJuIDA7CiB9CiAKQEAgLTQ4MzIsNyArNDgwNSw2IEBAIHN0YXRpYyB2b2lkIGRzaV9yZWxlYXNl
X3ZjKHN0cnVjdCBvbWFwX2Rzc19kZXZpY2UgKmRzc2RldiwgaW50IGNoYW5uZWwpCiAJaWYgKChj
aGFubmVsID49IDAgJiYgY2hhbm5lbCA8PSAzKSAmJgogCQlkc2ktPnZjW2NoYW5uZWxdLmRzc2Rl
diA9PSBkc3NkZXYpIHsKIAkJZHNpLT52Y1tjaGFubmVsXS5kc3NkZXYgPSBOVUxMOwotCQlkc2kt
PnZjW2NoYW5uZWxdLnZjX2lkID0gMDsKIAl9CiB9CiAKQEAgLTQ5MzcsNyArNDkwOSw2IEBAIHN0
YXRpYyBjb25zdCBzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlX29wcyBkc2lfb3BzID0gewogCQkuZW5h
YmxlX3RlID0gZHNpX2VuYWJsZV90ZSwKIAogCQkucmVxdWVzdF92YyA9IGRzaV9yZXF1ZXN0X3Zj
LAotCQkuc2V0X3ZjX2lkID0gZHNpX3NldF92Y19pZCwKIAkJLnJlbGVhc2VfdmMgPSBkc2lfcmVs
ZWFzZV92YywKIAogCQkudHJhbnNmZXIgPSBvbWFwX2RzaV90cmFuc2ZlciwKQEAgLTUzOTMsNyAr
NTM2NCw2IEBAIHN0YXRpYyBpbnQgZHNpX3Byb2JlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBk
ZXYpCiAJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoZHNpLT52Yyk7IGkrKykgewogCQlkc2kt
PnZjW2ldLnNvdXJjZSA9IERTSV9WQ19TT1VSQ0VfTDQ7CiAJCWRzaS0+dmNbaV0uZHNzZGV2ID0g
TlVMTDsKLQkJZHNpLT52Y1tpXS52Y19pZCA9IDA7CiAJfQogCiAJciA9IGRzaV9nZXRfY2xvY2tz
KGRzaSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3Mvb21hcGRzcy5o
IGIvZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vZHNzL29tYXBkc3MuaAppbmRleCA3OWFlNDA3M2Mz
NWYuLjE0M2ZmMzQ2YzMxMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vZHNz
L29tYXBkc3MuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3Mvb21hcGRzcy5oCkBA
IC0zMDgsOSArMzA4LDcgQEAgc3RydWN0IG9tYXBkc3NfZHNpX29wcyB7CiAJdm9pZCAoKmRpc2Fi
bGVfdmlkZW9fb3V0cHV0KShzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpkc3NkZXYsCiAJCQlpbnQg
Y2hhbm5lbCk7CiAKLQlpbnQgKCpyZXF1ZXN0X3ZjKShzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpk
c3NkZXYsIGludCAqY2hhbm5lbCk7Ci0JaW50ICgqc2V0X3ZjX2lkKShzdHJ1Y3Qgb21hcF9kc3Nf
ZGV2aWNlICpkc3NkZXYsIGludCBjaGFubmVsLAotCQkJaW50IHZjX2lkKTsKKwlpbnQgKCpyZXF1
ZXN0X3ZjKShzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpkc3NkZXYsIGludCBjaGFubmVsKTsKIAl2
b2lkICgqcmVsZWFzZV92Yykoc3RydWN0IG9tYXBfZHNzX2RldmljZSAqZHNzZGV2LCBpbnQgY2hh
bm5lbCk7CiAKIAkvKiBkYXRhIHRyYW5zZmVyICovCi0tIAoyLjI0LjAKCl9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QK
ZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9w
Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
