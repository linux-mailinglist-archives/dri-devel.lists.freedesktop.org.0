Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 733B3D7BF6
	for <lists+dri-devel@lfdr.de>; Tue, 15 Oct 2019 18:39:03 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EA7B56E85E;
	Tue, 15 Oct 2019 16:38:30 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from NAM02-BL2-obe.outbound.protection.outlook.com
 (mail-eopbgr750095.outbound.protection.outlook.com [40.107.75.95])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5D5C96E61D
 for <dri-devel@lists.freedesktop.org>; Tue, 15 Oct 2019 07:35:19 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=DROJmSs7MEEz5sRK6EEOk4C0zJ4QwnvHIRWcZ57K0sH76/9fZ11rvYj4iwTgm19TSVF+puxg2Gd8qFB+KsN5B1Jsk1NksvzmzTVVB/ODsJOLSJ7y+lA7z/+kQ9evfJbqhvUHlnmqleRDPcO+yk0ju3ChYvwYiRbVGe9FRQIMZAzYFUhfwS1TMDGw+PlE9VGRLzJ+iQDpzqQ7HHfuDx4Ot1hY/Zr/OkhNsyf/lG0sNylQT26cC9c2zJqpb161oGS6bPVfPtsrwPFa3+WwOVhGf9+L7APDsRbxqz4wZw2Lv3cHSp931w1CDLNf4yaiXttndc8F77/ngDrU7x3zB4AcIA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=3UoPq8SWhWfUpB7d7KdB1GuwdKvGMPVJacXzluwjtJs=;
 b=WR2bdU0e21AUtC/bF6Mhq7O3uDWMEyCXYnTktvwcLggrGVvmy45nHaI0psxCjPvP03fieZjFg//9blS8YaM4RtrBikUmbWIQU/UqIu3h5u9wLq6oT7lR4tgGZvOznuMqegkiTnFJ8p2nHi5DkaLgt9iBF32Z0YEjunlnZfLU96T61Ovc1qMqLzn48P0moB/tbrJKW7gKvW5gfK09kn5Pt7+qOslTBUklOMAt4OPhqvRwr2CcShcGUCEq0X+kIshxhMSQdLHAst2zw0iEYEAapqJXLdRzSkSjXFZSbtPM4II7R1OPEgkU+WD/hhUJvdg+UOdWwg3gw8wGMTqYLHtiGQ==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=analogixsemi.com; dmarc=pass action=none
 header.from=analogixsemi.com; dkim=pass header.d=analogixsemi.com; arc=none
Received: from SN6PR04MB4543.namprd04.prod.outlook.com (52.135.120.29) by
 SN6PR04MB4254.namprd04.prod.outlook.com (52.135.71.157) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2347.16; Tue, 15 Oct 2019 07:35:16 +0000
Received: from SN6PR04MB4543.namprd04.prod.outlook.com
 ([fe80::c55e:6c70:adbb:cf87]) by SN6PR04MB4543.namprd04.prod.outlook.com
 ([fe80::c55e:6c70:adbb:cf87%5]) with mapi id 15.20.2347.023; Tue, 15 Oct 2019
 07:35:16 +0000
From: Xin Ji <xji@analogixsemi.com>
To: "devel@driverdev.osuosl.org" <devel@driverdev.osuosl.org>, Laurent
 Pinchart <laurent.pinchart@ideasonboard.com>, Andrzej Hajda
 <a.hajda@samsung.com>
Subject: [PATCH v3 2/2] drm/bridge: anx7625: Add anx7625 MIPI DSI/DPI to DP
 bridge driver
Thread-Topic: [PATCH v3 2/2] drm/bridge: anx7625: Add anx7625 MIPI DSI/DPI to
 DP bridge driver
Thread-Index: AQHVgysWa3izoa2pAEuUov9xHSM/iA==
Date: Tue, 15 Oct 2019 07:35:16 +0000
Message-ID: <c7d5871d25d627d4c3ed6d736b512d1c5cc91bc5.1571124579.git.xji@analogixsemi.com>
References: <cover.1571124579.git.xji@analogixsemi.com>
In-Reply-To: <cover.1571124579.git.xji@analogixsemi.com>
Accept-Language: zh-CN, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: AM0PR01CA0120.eurprd01.prod.exchangelabs.com
 (2603:10a6:208:168::25) To SN6PR04MB4543.namprd04.prod.outlook.com
 (2603:10b6:805:a8::29)
x-ms-exchange-messagesentrepresentingtype: 1
x-originating-ip: [114.247.245.252]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 4322f3a9-bfb0-45dc-50bd-08d751423869
x-ms-traffictypediagnostic: SN6PR04MB4254:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <SN6PR04MB42545C4A7EC7F935821BA8D6C7930@SN6PR04MB4254.namprd04.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:5516;
x-forefront-prvs: 01917B1794
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10019020)(366004)(39840400004)(136003)(346002)(396003)(376002)(189003)(199004)(102836004)(2501003)(4326008)(2906002)(6436002)(6116002)(3846002)(66066001)(30864003)(5660300002)(476003)(446003)(25786009)(2616005)(6512007)(11346002)(486006)(26005)(6486002)(478600001)(107886003)(186003)(71200400001)(71190400001)(36756003)(316002)(256004)(305945005)(14444005)(5024004)(561924002)(14454004)(66446008)(64756008)(66946007)(66476007)(66556008)(7736002)(118296001)(52116002)(8936002)(8676002)(81156014)(81166006)(110136005)(99286004)(7416002)(86362001)(386003)(76176011)(6506007)(54906003)(559001)(569006);
 DIR:OUT; SFP:1102; SCL:1; SRVR:SN6PR04MB4254;
 H:SN6PR04MB4543.namprd04.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; MX:1; A:1; 
received-spf: None (protection.outlook.com: analogixsemi.com does not
 designate permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: V6QiDk2C638M1A8NTxqpsvhW6LB53qL4F2Pys3NCJIkN2pF1qllhjRho78T6w/J2fJNFY/p+prZKGJmMZrpCszhIpnPsKsGe1V66/dxfrqXjnXgzcREs4hqTph1xJyqp37M/65pZuFf5x7TiSoWwZ7c6Bk7a7hQvf90gNDlgASKakvT4EtNbTT6hrgJKD5wp/jlvMBf3Tq14LtLZtvvc7GxSAcgCugHL4SCuDAaX+1dGZSC44Xo4Du2IzbQzPnmWske1Z34frZHMlvoqN/CP6BFl1qSaduSK73NA/Div8WwU8NwLOVLZcLhJh9mvlM1PBpO1PhVMx5c5v4cz83uLU8yjUuKGQBmtQsjvks/W1xQwdNAnqvRnv9MUyidmh+GTt0br1Rg9hkfvuDcmx/oJ1h9dE2ecaqdVSA7BpdcQl/Y=
Content-ID: <6A4838F4FE7C1548B672FD0C2FB519E3@namprd04.prod.outlook.com>
MIME-Version: 1.0
X-OriginatorOrg: analogixsemi.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 4322f3a9-bfb0-45dc-50bd-08d751423869
X-MS-Exchange-CrossTenant-originalarrivaltime: 15 Oct 2019 07:35:16.2236 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: b099b0b4-f26c-4cf5-9a0f-d5be9acab205
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: Y0O+Z2IgNBH9Q7zQBFOUhM70bbJvp6SNfTC/SxEjn95LNMv8z2pn8NOLzf/2NBcQmuzp1PFsxDQMgavZRqJkGQ==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: SN6PR04MB4254
X-Mailman-Approved-At: Tue, 15 Oct 2019 16:38:12 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=Analogixsemi.onmicrosoft.com; s=selector2-Analogixsemi-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=3UoPq8SWhWfUpB7d7KdB1GuwdKvGMPVJacXzluwjtJs=;
 b=Mcu8C0cye3z19k4IERoMzYJ9uAhpmgNCQs57Eep6NMujx3/lzfw23OYgaxi4Ts9+zOP9nj00rcj/g5kNCxaV0IrOjEyObxAPGyrXvyrs7bwe/MBT7/kORKupD3El588MtRT2lDau4CBtJe3ijMXGZpqXXKH6qFvZVeFRc6DWKVE=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=xji@analogixsemi.com; 
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Jernej Skrabec <jernej.skrabec@siol.net>,
 Nicolas Boichat <drinkcat@chromium.org>, Jonas Karlman <jonas@kwiboo.se>,
 David Airlie <airlied@linux.ie>, Neil Armstrong <narmstrong@baylibre.com>,
 "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
 "dri-devel@lists.freedesktop.org" <dri-devel@lists.freedesktop.org>,
 Sheng Pan <span@analogixsemi.com>, Dan Carpenter <dan.carpenter@oracle.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIEFOWDc2MjUgaXMgYW4gdWx0cmEtbG93IHBvd2VyIDRLIE1vYmlsZSBIRCBUcmFuc21pdHRl
ciBkZXNpZ25lZApmb3IgcG9ydGFibGUgZGV2aWNlLiBJdCBjb252ZXJ0cyBNSVBJIERTSS9EUEkg
dG8gRGlzcGxheVBvcnQgMS4zIDRLLgoKVGhlIEFOWDc2MjUgY2FuIHN1cHBvcnQgYm90aCBVU0Ig
VHlwZS1DIFBEIGZlYXR1cmUgYW5kIE1JUEkgRFNJL0RQSQp0byBEUCBmZWF0dXJlLiBUaGlzIGRy
aXZlciBvbmx5IGVuYWJsZWQgTUlQSSBEU0kvRFBJIHRvIERQIGZlYXR1cmUuCgpTaWduZWQtb2Zm
LWJ5OiBYaW4gSmkgPHhqaUBhbmFsb2dpeHNlbWkuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9i
cmlkZ2UvTWFrZWZpbGUgICAgICAgICAgIHwgICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2JyaWRn
ZS9hbmFsb2dpeC9LY29uZmlnICAgfCAgICA2ICsKIGRyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5h
bG9naXgvTWFrZWZpbGUgIHwgICAgMSArCiBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4
L2FueDc2MjUuYyB8IDIxNTkgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIGRyaXZlcnMv
Z3B1L2RybS9icmlkZ2UvYW5hbG9naXgvYW54NzYyNS5oIHwgIDQwNiArKysrKysKIDUgZmlsZXMg
Y2hhbmdlZCwgMjU3MyBpbnNlcnRpb25zKCspLCAxIGRlbGV0aW9uKC0pCiBjcmVhdGUgbW9kZSAx
MDA2NDQgZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9hbng3NjI1LmMKIGNyZWF0ZSBt
b2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L2FueDc2MjUuaAoKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9k
cm0vYnJpZGdlL01ha2VmaWxlCmluZGV4IDQ5MzRmY2YuLmJjZDM4OGEgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9icmlkZ2UvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRn
ZS9NYWtlZmlsZQpAQCAtMTIsOCArMTIsOCBAQCBvYmotJChDT05GSUdfRFJNX1NJSTkyMzQpICs9
IHNpaTkyMzQubwogb2JqLSQoQ09ORklHX0RSTV9USElORV9USEM2M0xWRDEwMjQpICs9IHRoYzYz
bHZkMTAyNC5vCiBvYmotJChDT05GSUdfRFJNX1RPU0hJQkFfVEMzNTg3NjQpICs9IHRjMzU4NzY0
Lm8KIG9iai0kKENPTkZJR19EUk1fVE9TSElCQV9UQzM1ODc2NykgKz0gdGMzNTg3Njcubwotb2Jq
LSQoQ09ORklHX0RSTV9BTkFMT0dJWF9EUCkgKz0gYW5hbG9naXgvCiBvYmotJChDT05GSUdfRFJN
X0kyQ19BRFY3NTExKSArPSBhZHY3NTExLwogb2JqLSQoQ09ORklHX0RSTV9USV9TTjY1RFNJODYp
ICs9IHRpLXNuNjVkc2k4Ni5vCiBvYmotJChDT05GSUdfRFJNX1RJX1RGUDQxMCkgKz0gdGktdGZw
NDEwLm8KK29iai15ICs9IGFuYWxvZ2l4Lwogb2JqLXkgKz0gc3lub3BzeXMvCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L0tjb25maWcgYi9kcml2ZXJzL2dwdS9k
cm0vYnJpZGdlL2FuYWxvZ2l4L0tjb25maWcKaW5kZXggZTkzMGZmOS4uYjJmMTI3ZSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9LY29uZmlnCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvS2NvbmZpZwpAQCAtMiwzICsyLDkgQEAKIGNvbmZp
ZyBEUk1fQU5BTE9HSVhfRFAKIAl0cmlzdGF0ZQogCWRlcGVuZHMgb24gRFJNCisKK2NvbmZpZyBB
TkFMT0dJWF9BTlg3NjI1CisJdHJpc3RhdGUgIkFuYWxvZ2l4IE1JUEkgdG8gRFAgaW50ZXJmYWNl
IHN1cHBvcnQiCisJaGVscAorCQlBTlg3NjI1IGlzIGFuIHVsdHJhLWxvdyBwb3dlciA0SyBtb2Jp
bGUgSEQgdHJhbnNtaXR0ZXIgZGVzaWduZWQKKwkJZm9yIHBvcnRhYmxlIGRldmljZXMuIEl0IGNv
bnZlcnRzIE1JUEkvRFBJIHRvIERpc3BsYXlQb3J0MS4zIDRLLgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9icmlk
Z2UvYW5hbG9naXgvTWFrZWZpbGUKaW5kZXggZmRiZjNmZC4uOGE1Mjg2NyAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2dw
dS9kcm0vYnJpZGdlL2FuYWxvZ2l4L01ha2VmaWxlCkBAIC0xLDMgKzEsNCBAQAogIyBTUERYLUxp
Y2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5CitvYmotJChDT05GSUdfQU5BTE9HSVhfQU5Y
NzYyNSkgKz0gYW54NzYyNS5vCiBhbmFsb2dpeF9kcC1vYmpzIDo9IGFuYWxvZ2l4X2RwX2NvcmUu
byBhbmFsb2dpeF9kcF9yZWcubwogb2JqLSQoQ09ORklHX0RSTV9BTkFMT0dJWF9EUCkgKz0gYW5h
bG9naXhfZHAubwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9h
bng3NjI1LmMgYi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L2FueDc2MjUuYwpuZXcg
ZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi43YWRiNzlmCi0tLSAvZGV2L251bGwKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9hbng3NjI1LmMKQEAgLTAsMCArMSwy
MTU5IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5CisvKgorICog
Q29weXJpZ2h0KGMpIDIwMTYsIEFuYWxvZ2l4IFNlbWljb25kdWN0b3IuIEFsbCByaWdodHMgcmVz
ZXJ2ZWQuCisgKgorICovCisjaW5jbHVkZSA8bGludXgvZXh0Y29uLmg+CisjaW5jbHVkZSA8bGlu
dXgvZ2NkLmg+CisjaW5jbHVkZSA8bGludXgvZ3Bpby9jb25zdW1lci5oPgorI2luY2x1ZGUgPGxp
bnV4L2kyYy5oPgorI2luY2x1ZGUgPGxpbnV4L2ludGVycnVwdC5oPgorI2luY2x1ZGUgPGxpbnV4
L2lvcG9sbC5oPgorI2luY2x1ZGUgPGxpbnV4L2tlcm5lbC5oPgorI2luY2x1ZGUgPGxpbnV4L21v
ZHVsZS5oPgorI2luY2x1ZGUgPGxpbnV4L211dGV4Lmg+CisjaW5jbHVkZSA8bGludXgvc2xhYi5o
PgorI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CisjaW5jbHVkZSA8bGludXgvd29ya3F1ZXVlLmg+
CisKKyNpbmNsdWRlIDxsaW51eC9vZl9ncGlvLmg+CisjaW5jbHVkZSA8bGludXgvb2ZfZ3JhcGgu
aD4KKyNpbmNsdWRlIDxsaW51eC9vZl9wbGF0Zm9ybS5oPgorCisjaW5jbHVkZSA8ZHJtL2RybV9h
dG9taWNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9icmlkZ2UuaD4KKyNpbmNsdWRlIDxk
cm0vZHJtX2NydGNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9kcF9oZWxwZXIuaD4KKyNp
bmNsdWRlIDxkcm0vZHJtX2VkaWQuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX21pcGlfZHNpLmg+Cisj
aW5jbHVkZSA8ZHJtL2RybV9wYW5lbC5oPgorI2luY2x1ZGUgPGRybS9kcm1fcHJpbnQuaD4KKyNp
bmNsdWRlIDxkcm0vZHJtX3Byb2JlX2hlbHBlci5oPgorCisjaW5jbHVkZSA8dmlkZW8vZGlzcGxh
eV90aW1pbmcuaD4KKworI2luY2x1ZGUgImFueDc2MjUuaCIKKworLyoKKyAqIHRoZXJlIGlzIGEg
c3luYyBpc3N1ZSB3aGlsZSBhY2Nlc3MgSTJDIHJlZ2lzdGVyIGJldHdlZW4gQVAoQ1BVKSBhbmQK
KyAqIGludGVybmFsIGZpcm13YXJlKE9DTSksIHRvIGF2b2lkIHRoZSByYWNlIGNvbmRpdGlvbiwg
QVAgc2hvdWxkIGFjY2VzcworICogdGhlIHJlc2VydmVkIHNsYXZlIGFkZHJlc3MgYmVmb3JlIHNs
YXZlIGFkZHJlc3Mgb2NjdXJzIGNoYW5nZXMuCisgKi8KK3N0YXRpYyBpbnQgaTJjX2FjY2Vzc193
b3JrYXJvdW5kKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKKwkJCQkgc3RydWN0IGkyY19jbGll
bnQgKmNsaWVudCkKK3sKKwl1OCBvZmZzZXQ7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmNsaWVu
dC0+ZGV2OworCWludCByZXQ7CisKKwlpZiAoY2xpZW50ID09IGN0eC0+bGFzdF9jbGllbnQpCisJ
CXJldHVybiAwOworCisJY3R4LT5sYXN0X2NsaWVudCA9IGNsaWVudDsKKworCWlmIChjbGllbnQg
PT0gY3R4LT5pMmMudGNwY19jbGllbnQpCisJCW9mZnNldCA9IFJTVkRfMDBfQUREUjsKKwllbHNl
IGlmIChjbGllbnQgPT0gY3R4LT5pMmMudHhfcDBfY2xpZW50KQorCQlvZmZzZXQgPSBSU1ZEX0Qx
X0FERFI7CisJZWxzZSBpZiAoY2xpZW50ID09IGN0eC0+aTJjLnR4X3AxX2NsaWVudCkKKwkJb2Zm
c2V0ID0gUlNWRF82MF9BRERSOworCWVsc2UgaWYgKGNsaWVudCA9PSBjdHgtPmkyYy5yeF9wMF9j
bGllbnQpCisJCW9mZnNldCA9IFJTVkRfMzlfQUREUjsKKwllbHNlIGlmIChjbGllbnQgPT0gY3R4
LT5pMmMucnhfcDFfY2xpZW50KQorCQlvZmZzZXQgPSBSU1ZEXzdGX0FERFI7CisJZWxzZQorCQlv
ZmZzZXQgPSBSU1ZEXzAwX0FERFI7CisKKwlyZXQgPSBpMmNfc21idXNfd3JpdGVfYnl0ZV9kYXRh
KGNsaWVudCwgb2Zmc2V0LCAweDAwKTsKKwlpZiAocmV0IDwgMCkKKwkJRFJNX0RFVl9FUlJPUihk
ZXYsCisJCQkgICAgICAiZmFpbGVkIHRvIGFjY2VzcyBpMmMgaWQ9JXhcbjoleCIsCisJCQkgICAg
ICBjbGllbnQtPmFkZHIsIG9mZnNldCk7CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50
IGFueDc2MjVfcmVnX3JlYWQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAorCQkJICAgIHN0cnVj
dCBpMmNfY2xpZW50ICpjbGllbnQsIHU4IHJlZ19hZGRyKQoreworCWludCByZXQ7CisJc3RydWN0
IGRldmljZSAqZGV2ID0gJmNsaWVudC0+ZGV2OworCisJaTJjX2FjY2Vzc193b3JrYXJvdW5kKGN0
eCwgY2xpZW50KTsKKworCXJldCA9IGkyY19zbWJ1c19yZWFkX2J5dGVfZGF0YShjbGllbnQsIHJl
Z19hZGRyKTsKKwlpZiAocmV0IDwgMCkKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJyZWFkIGkyYyBm
YWlsZWQgaWQ9JXg6JXhcbiIsCisJCQkgICAgICBjbGllbnQtPmFkZHIsIHJlZ19hZGRyKTsKKwor
CXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV9yZWdfYmxvY2tfcmVhZChzdHJ1
Y3QgYW54NzYyNV9kYXRhICpjdHgsCisJCQkJICBzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50LAor
CQkJCSAgdTggcmVnX2FkZHIsIHU4IGxlbiwgdTggKmJ1ZikKK3sKKwlpbnQgcmV0OworCXN0cnVj
dCBkZXZpY2UgKmRldiA9ICZjbGllbnQtPmRldjsKKworCWkyY19hY2Nlc3Nfd29ya2Fyb3VuZChj
dHgsIGNsaWVudCk7CisKKwlyZXQgPSBpMmNfc21idXNfcmVhZF9pMmNfYmxvY2tfZGF0YShjbGll
bnQsIHJlZ19hZGRyLCBsZW4sIGJ1Zik7CisJaWYgKHJldCA8IDApCisJCURSTV9ERVZfRVJST1Io
ZGV2LCAicmVhZCBpMmMgYmxvY2sgZmFpbGVkIGlkPSV4OiV4XG4iLAorCQkJICAgICAgY2xpZW50
LT5hZGRyLCByZWdfYWRkcik7CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IGFueDc2
MjVfcmVnX3dyaXRlKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKKwkJCSAgICAgc3RydWN0IGky
Y19jbGllbnQgKmNsaWVudCwKKwkJCSAgICAgdTggcmVnX2FkZHIsIHU4IHJlZ192YWwpCit7CisJ
aW50IHJldDsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY2xpZW50LT5kZXY7CisKKwlpMmNfYWNj
ZXNzX3dvcmthcm91bmQoY3R4LCBjbGllbnQpOworCisJcmV0ID0gaTJjX3NtYnVzX3dyaXRlX2J5
dGVfZGF0YShjbGllbnQsIHJlZ19hZGRyLCByZWdfdmFsKTsKKworCWlmIChyZXQgPCAwKQorCQlE
Uk1fREVWX0VSUk9SKGRldiwgImZhaWxlZCB0byB3cml0ZSBpMmMgaWQ9JXhcbjoleCIsCisJCQkg
ICAgICBjbGllbnQtPmFkZHIsIHJlZ19hZGRyKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRp
YyBpbnQgYW54NzYyNV93cml0ZV9vcihzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCisJCQkgICAg
c3RydWN0IGkyY19jbGllbnQgKmNsaWVudCwKKwkJCSAgICB1OCBvZmZzZXQsIHU4IG1hc2spCit7
CisJaW50IHZhbDsKKworCXZhbCA9IGFueDc2MjVfcmVnX3JlYWQoY3R4LCBjbGllbnQsIG9mZnNl
dCk7CisJaWYgKHZhbCA8IDApCisJCXJldHVybiB2YWw7CisKKwlyZXR1cm4gYW54NzYyNV9yZWdf
d3JpdGUoY3R4LCBjbGllbnQsIG9mZnNldCwgKHZhbCB8IChtYXNrKSkpOworfQorCitzdGF0aWMg
aW50IGFueDc2MjVfd3JpdGVfYW5kKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKKwkJCSAgICAg
c3RydWN0IGkyY19jbGllbnQgKmNsaWVudCwKKwkJCSAgICAgdTggb2Zmc2V0LCB1OCBtYXNrKQor
eworCWludCB2YWw7CisKKwl2YWwgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY2xpZW50LCBvZmZz
ZXQpOworCWlmICh2YWwgPCAwKQorCQlyZXR1cm4gdmFsOworCisJcmV0dXJuIGFueDc2MjVfcmVn
X3dyaXRlKGN0eCwgY2xpZW50LCBvZmZzZXQsICh2YWwgJiAobWFzaykpKTsKK30KKworc3RhdGlj
IGludCBhbng3NjI1X3dyaXRlX2FuZF9vcihzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCisJCQkJ
c3RydWN0IGkyY19jbGllbnQgKmNsaWVudCwKKwkJCQl1OCBvZmZzZXQsIHU4IGFuZF9tYXNrLCB1
OCBvcl9tYXNrKQoreworCWludCB2YWw7CisKKwl2YWwgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwg
Y2xpZW50LCBvZmZzZXQpOworCWlmICh2YWwgPCAwKQorCQlyZXR1cm4gdmFsOworCisJcmV0dXJu
IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY2xpZW50LAorCQkJCSBvZmZzZXQsICh2YWwgJiBhbmRf
bWFzaykgfCAob3JfbWFzaykpOworfQorCitzdGF0aWMgaW50IGFueDc2MjVfY29uZmlnX2JpdF9t
YXRyaXgoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCWludCBpLCByZXQ7CisKKwlyZXQg
PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnR4X3AyX2NsaWVudCwKKwkJCQlBVURJ
T19DT05UUk9MX1JFR0lTVEVSLCAweDgwKTsKKwlmb3IgKGkgPSAwOyBpIDwgMTM7IGkrKykKKwkJ
cmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMudHhfcDJfY2xpZW50LAorCQkJ
CQkgVklERU9fQklUX01BVFJJWF8xMiArIGksCisJCQkJCSAweDE4ICsgaSk7CisKKwlyZXR1cm4g
cmV0OworfQorCitzdGF0aWMgaW50IGFueDc2MjVfcmVhZF9jdHJsX3N0YXR1c19wMChzdHJ1Y3Qg
YW54NzYyNV9kYXRhICpjdHgpCit7CisJcmV0dXJuIGFueDc2MjVfcmVnX3JlYWQoY3R4LCBjdHgt
PmkyYy5yeF9wMF9jbGllbnQsIEFQX0FVWF9DVFJMX1NUQVRVUyk7Cit9CisKK3N0YXRpYyBpbnQg
d2FpdF9hdXhfb3BfZmluaXNoKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sKKwlpbnQgdmFs
OworCWludCByZXQ7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisK
KwlyZXQgPSByZWFkeF9wb2xsX3RpbWVvdXQoYW54NzYyNV9yZWFkX2N0cmxfc3RhdHVzX3AwLAor
CQkJCSBjdHgsIHZhbCwKKwkJCQkgKCEodmFsICYgQVBfQVVYX0NUUkxfT1BfRU4pIHx8ICh2YWwg
PCAwKSksCisJCQkJIDIwMDAsCisJCQkJIDIwMDAgKiAxNTApOworCWlmIChyZXQpIHsKKwkJRFJN
X0RFVl9FUlJPUihkZXYsICJhdXggb3BlcmF0aW9uIGZhaWxlZCFcbiIpOworCQlyZXR1cm4gLUVJ
TzsKKwl9CisKKwl2YWwgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xp
ZW50LAorCQkJICAgICAgIEFQX0FVWF9DVFJMX1NUQVRVUyk7CisJaWYgKHZhbCA8IDAgfHwgKHZh
bCAmIDB4MEYpKSB7CisJCURSTV9ERVZfRVJST1IoZGV2LCAiYXV4IHN0YXR1cyAlMDJ4XG4iLCB2
YWwpOworCQl2YWwgPSAtRUlPOworCX0KKworCXJldHVybiB2YWw7Cit9CisKK3N0YXRpYyBpbnQg
d3JpdGVfZHBjZF9hZGRyKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKKwkJCSAgIHU4IGFkZHJo
LCB1OCBhZGRybSwgdTggYWRkcmwpCit7CisJaW50IHJldDsKKworCXJldCA9IGFueDc2MjVfcmVn
X3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCUFQX0FVWF9BRERSXzdfMCwg
KHU4KWFkZHJsKTsKKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9w
MF9jbGllbnQsCisJCQkJIEFQX0FVWF9BRERSXzE1XzgsICh1OClhZGRybSk7CisJcmV0IHw9IGFu
eDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCSBBUF9BVVhf
QUREUl8xOV8xNiwgKHU4KWFkZHJoKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQg
c3BfdHhfYXV4X2RwY2RyZWFkX2J5dGVzKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKKwkJCQkg
ICAgdTggYWRkcmgsIHU4IGFkZHJtLAorCQkJCSAgICB1OCBhZGRybCwgdTggY291bnQsCisJCQkJ
ICAgIHU4ICpidWYpCit7CisJdTggYzsKKwlpbnQgcmV0OworCXN0cnVjdCBkZXZpY2UgKmRldiA9
ICZjdHgtPmNsaWVudC0+ZGV2OworCisJaWYgKFdBUk5fT04oY291bnQgPiBNQVhfRFBDRF9CVUZG
RVJfU0laRSkpCisJCXJldHVybiAtRTJCSUc7CisKKwkvKiBjb21tYW5kIGFuZCBsZW5ndGggKi8K
KwljID0gKChjb3VudCAtIDEpIDw8IDQpIHwgMHgwOTsKKwlyZXQgPSBhbng3NjI1X3JlZ193cml0
ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwgQVBfQVVYX0NPTU1BTkQsIGMpOworCS8qIGFk
ZHJlc3MgKi8KKwlyZXQgfD0gd3JpdGVfZHBjZF9hZGRyKGN0eCwgYWRkcmgsIGFkZHJtLCBhZGRy
bCk7CisJLyogYXV4IGVuICovCisJcmV0IHw9IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmky
Yy5yeF9wMF9jbGllbnQsIEFQX0FVWF9DVFJMX1NUQVRVUywKKwkJCQlBUF9BVVhfQ1RSTF9PUF9F
Tik7CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJhdXggZW5hYmxlIGZh
aWxlZC5cbiIpOworCQlyZXR1cm4gcmV0OworCX0KKworCXVzbGVlcF9yYW5nZSgyMDAwLCAyMTAw
KTsKKworCXJldCA9IHdhaXRfYXV4X29wX2ZpbmlzaChjdHgpOworCWlmIChyZXQgPCAwKSB7CisJ
CURSTV9ERVZfRVJST1IoZGV2LCAiYXV4IHJlYWQgZmFpbGVkXG4iKTsKKwkJcmV0dXJuIHJldDsK
Kwl9CisKKwlyZXR1cm4gYW54NzYyNV9yZWdfYmxvY2tfcmVhZChjdHgsIGN0eC0+aTJjLnJ4X3Aw
X2NsaWVudCwKKwkJCUFQX0FVWF9CVUZGX1NUQVJULCBjb3VudCwgYnVmKTsKK30KKworc3RhdGlj
IGludCBhbng3NjI1X3ZpZGVvX211dGVfY29udHJvbChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgs
CisJCQkJICAgICAgdTggc3RhdHVzKQoreworCWludCByZXQ7CisKKwlpZiAoc3RhdHVzKSB7IC8q
IG11dGUgb24gKi8KKwkJLyogc2V0IG11dGUgZmxhZyAqLworCQlyZXQgPSBhbng3NjI1X3dyaXRl
X29yKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCSAgICAgICBBUF9BVl9TVEFUVVMs
IEFQX01JUElfTVVURSk7CisJCS8qIGNsZWFyIG1pcGkgUlggZW4gKi8KKwkJcmV0IHw9IGFueDc2
MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCQkgQVBfQVZfU1RB
VFVTLCAodTgpfkFQX01JUElfUlhfRU4pOworCX0gZWxzZSB7IC8qIG11dGUgb2ZmICovCisJCS8q
IGNsZWFyIG11dGUgZmxhZyAqLworCQlyZXQgPSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+
aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkJQVBfQVZfU1RBVFVTLCAodTgpfkFQX01JUElfTVVURSk7
CisJCS8qIHNldCBNSVBJIFJYIEVOICovCisJCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwg
Y3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCQlBUF9BVl9TVEFUVVMsIEFQX01JUElfUlhfRU4p
OworCX0KKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV9jb25maWdfYXVk
aW9faW5wdXQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCWludCByZXQ7CisKKwkvKiBj
aGFubmVsIG51bSAqLworCXJldCA9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMudHhf
cDJfY2xpZW50LAorCQkJCUFVRElPX0NIQU5ORUxfU1RBVFVTXzYsIEkyU19DSF8yIDw8IDUpOwor
CS8qIGxheW91dCAqLworCS8qIGFzIEkyUyBjaGFubmVsIGlzIDIsIG5vIG5lZWQgdG8gc2V0IGxh
eW91dCAqLworCisJLyogRlMgKi8KKwlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmRfb3IoY3R4LCBj
dHgtPmkyYy50eF9wMl9jbGllbnQsCisJCQkJICAgIEFVRElPX0NIQU5ORUxfU1RBVFVTXzQsCisJ
CQkJICAgIDB4ZjAsIEFVRElPX0ZTXzQ4Syk7CisJLyogd29yZCBsZW5ndGggKi8KKwlyZXQgfD0g
YW54NzYyNV93cml0ZV9hbmRfb3IoY3R4LCBjdHgtPmkyYy50eF9wMl9jbGllbnQsCisJCQkJICAg
IEFVRElPX0NIQU5ORUxfU1RBVFVTXzUsCisJCQkJICAgIDB4ZjAsIEFVRElPX1dfTEVOXzI0XzI0
TUFYKTsKKwkvKiBJMlMgKi8KKwlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJj
LnR4X3AyX2NsaWVudCwKKwkJCQlBVURJT19DSEFOTkVMX1NUQVRVU182LCBJMlNfU0xBVkVfTU9E
RSk7CisJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMudHhfcDJfY2xpZW50
LAorCQkJCSBBVURJT19DT05UUk9MX1JFR0lTVEVSLCB+VERNX1RJTUlOR19NT0RFKTsKKwkvKiBh
dWRpbyBjaGFuZ2UgZmxhZyAqLworCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5p
MmMucnhfcDBfY2xpZW50LAorCQkJCUFQX0FWX1NUQVRVUywgQVBfQVVESU9fQ0hHKTsKKworCWlm
IChyZXQgPCAwKQorCQlEUk1fRVJST1IoImZhaWxlZCB0byBjb25maWcgYXVkaW8uXG4iKTsKKwor
CXJldHVybiByZXQ7Cit9CisKKy8qIHJlZHVjdGlvbiBvZiBmcmFjdGlvbiBhL2IgKi8KK3N0YXRp
YyB2b2lkIGFueDc2MjVfcmVkdWN0aW9uX29mX2FfZnJhY3Rpb24odW5zaWduZWQgbG9uZyAqYSwg
dW5zaWduZWQgbG9uZyAqYikKK3sKKwl1bnNpZ25lZCBsb25nIGdjZF9udW07CisJdW5zaWduZWQg
bG9uZyB0bXBfYSwgdG1wX2I7CisJdTMyIGkgPSAxOworCisJZ2NkX251bSA9IGdjZCgqYSwgKmIp
OworCSphIC89IGdjZF9udW07CisJKmIgLz0gZ2NkX251bTsKKworCXRtcF9hID0gKmE7CisJdG1w
X2IgPSAqYjsKKworCXdoaWxlICgoKmEgPiBNQVhfVU5TSUdORURfMjRCSVQpIHx8ICgqYiA+IE1B
WF9VTlNJR05FRF8yNEJJVCkpIHsKKwkJaSsrOworCQkqYSA9IHRtcF9hIC8gaTsKKwkJKmIgPSB0
bXBfYiAvIGk7CisJfQorCisJLyoKKwkgKiBpbiB0aGUgZW5kLCBtYWtlIGEsIGIgbGFyZ2VyIHRv
IGhhdmUgaGlnaGVyIE9ERkMgUExMCisJICogb3V0cHV0IGZyZXF1ZW5jeSBhY2N1cmFjeQorCSAq
LworCXdoaWxlICgoKmEgPCBNQVhfVU5TSUdORURfMjRCSVQpICYmICgqYiA8IE1BWF9VTlNJR05F
RF8yNEJJVCkpIHsKKwkJKmEgPDw9IDE7CisJCSpiIDw8PSAxOworCX0KKworCSphID4+PSAxOwor
CSpiID4+PSAxOworfQorCitzdGF0aWMgaW50IGFueDc2MjVfY2FsY3VsYXRlX21fbih1MzIgcGl4
ZWxjbG9jaywKKwkJCQkgdW5zaWduZWQgbG9uZyAqbSwKKwkJCQkgdW5zaWduZWQgbG9uZyAqbiwK
KwkJCQkgdTggKnBvc3RfZGl2aWRlcikKK3sKKwlpZiAocGl4ZWxjbG9jayA+IFBMTF9PVVRfRlJF
UV9BQlNfTUFYIC8gUE9TVF9ESVZJREVSX01JTikgeworCQkvKiBwaXhlbCBjbG9jayBmcmVxdWVu
Y3kgaXMgdG9vIGhpZ2ggKi8KKwkJRFJNX0VSUk9SKCJwaXhlbGNsb2NrIHRvbyBoaWdoLCBhY3Qo
JWQpLCBtYXhpbXVtKCVsdSlcbiIsCisJCQkgIHBpeGVsY2xvY2ssCisJCQkgIFBMTF9PVVRfRlJF
UV9BQlNfTUFYIC8gUE9TVF9ESVZJREVSX01JTik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKwor
CWlmIChwaXhlbGNsb2NrIDwgUExMX09VVF9GUkVRX0FCU19NSU4gLyBQT1NUX0RJVklERVJfTUFY
KSB7CisJCS8qIHBpeGVsIGNsb2NrIGZyZXF1ZW5jeSBpcyB0b28gbG93ICovCisJCURSTV9FUlJP
UigicGl4ZWxjbG9jayB0b28gbG93LCBhY3QoJWQpLCBtYXhpbXVtKCVsdSlcbiIsCisJCQkgIHBp
eGVsY2xvY2ssCisJCQkgIFBMTF9PVVRfRlJFUV9BQlNfTUlOIC8gUE9TVF9ESVZJREVSX01BWCk7
CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCWZvciAoKnBvc3RfZGl2aWRlciA9IDE7CisJCXBp
eGVsY2xvY2sgPCAoUExMX09VVF9GUkVRX01JTiAvICgqcG9zdF9kaXZpZGVyKSk7KQorCQkqcG9z
dF9kaXZpZGVyICs9IDE7CisKKwlpZiAoKnBvc3RfZGl2aWRlciA+IFBPU1RfRElWSURFUl9NQVgp
IHsKKwkJZm9yICgqcG9zdF9kaXZpZGVyID0gMTsKKwkJCShwaXhlbGNsb2NrIDwKKwkJCSAoUExM
X09VVF9GUkVRX0FCU19NSU4gLyAoKnBvc3RfZGl2aWRlcikpKTspCisJCQkqcG9zdF9kaXZpZGVy
ICs9IDE7CisKKwkJaWYgKCpwb3N0X2RpdmlkZXIgPiBQT1NUX0RJVklERVJfTUFYKSB7CisJCQlE
Uk1fRVJST1IoImNhbm5vdCBmaW5kIHByb3BlcnR5IHBvc3RfZGl2aWRlciglZClcbiIsCisJCQkJ
ICAqcG9zdF9kaXZpZGVyKTsKKwkJCXJldHVybiAtRURPTTsKKwkJfQorCX0KKworCS8qIHBhdGNo
IHRvIGltcHJvdmUgdGhlIGFjY3VyYWN5ICovCisJaWYgKCpwb3N0X2RpdmlkZXIgPT0gNykgewor
CQkvKiAyNywwMDAsMDAwIGlzIG5vdCBkaXZpc2libGUgYnkgNyAqLworCQkqcG9zdF9kaXZpZGVy
ID0gODsKKwl9IGVsc2UgaWYgKCpwb3N0X2RpdmlkZXIgPT0gMTEpIHsKKwkJLyogMjcsMDAwLDAw
MCBpcyBub3QgZGl2aXNpYmxlIGJ5IDExICovCisJCSpwb3N0X2RpdmlkZXIgPSAxMjsKKwl9IGVs
c2UgaWYgKCgqcG9zdF9kaXZpZGVyID09IDEzKSB8fCAoKnBvc3RfZGl2aWRlciA9PSAxNCkpIHsK
KwkJLyoyNywwMDAsMDAwIGlzIG5vdCBkaXZpc2libGUgYnkgMTMgb3IgMTQqLworCQkqcG9zdF9k
aXZpZGVyID0gMTU7CisJfQorCisJaWYgKHBpeGVsY2xvY2sgKiAoKnBvc3RfZGl2aWRlcikgPiBQ
TExfT1VUX0ZSRVFfQUJTX01BWCkgeworCQlEUk1fRVJST1IoImFjdCBjbG9jaygldSkgbGFyZ2Ug
dGhhbiBtYXhpbXVtKCVsdSlcbiIsCisJCQkgIHBpeGVsY2xvY2sgKiAoKnBvc3RfZGl2aWRlciks
CisJCQkgIFBMTF9PVVRfRlJFUV9BQlNfTUFYKTsKKwkJcmV0dXJuIC1FRE9NOworCX0KKworCSpt
ID0gcGl4ZWxjbG9jazsKKwkqbiA9IFhUQUxfRlJRIC8gKCpwb3N0X2RpdmlkZXIpOworCisJYW54
NzYyNV9yZWR1Y3Rpb25fb2ZfYV9mcmFjdGlvbihtLCBuKTsKKworCXJldHVybiAwOworfQorCitz
dGF0aWMgaW50IGFueDc2MjVfb2RmY19jb25maWcoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAor
CQkJICAgICAgIHU4IHBvc3RfZGl2aWRlcikKK3sKKwlpbnQgcmV0OworCisJLyogY29uZmlnIGlu
cHV0IHJlZmVyZW5jZSBjbG9jayBmcmVxdWVuY3kgMjdNSHovMTkuMk1IeiAqLworCXJldCA9IGFu
eDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCBNSVBJX0RJR0lUQUxf
UExMXzE2LAorCQkJCX4oUkVGX0NMS18yNzAwMEtIWiA8PCBNSVBJX0ZSRUZfRF9JTkQpKTsKKwly
ZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9E
SUdJVEFMX1BMTF8xNiwKKwkJCQkoUkVGX0NMS18yNzAwMEtIWiA8PCBNSVBJX0ZSRUZfRF9JTkQp
KTsKKwkvKiBwb3N0IGRpdmlkZXIgKi8KKwlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBj
dHgtPmkyYy5yeF9wMV9jbGllbnQsCisJCQkJIE1JUElfRElHSVRBTF9QTExfOCwgMHgwZik7CisJ
cmV0IHw9IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIE1JUElf
RElHSVRBTF9QTExfOCwKKwkJCQlwb3N0X2RpdmlkZXIgPDwgNCk7CisKKwkvKiBhZGQgcGF0Y2gg
Zm9yIE1JUzItMTI1ICg1cGNzIEFOWDc2MjUgZmFpbCBBVEUgTUJJU1QgdGVzdCkgKi8KKwlyZXQg
fD0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIE1JUElfRElH
SVRBTF9QTExfNywKKwkJCQkgfk1JUElfUExMX1ZDT19UVU5FX1JFR19WQUwpOworCisJLyogcmVz
ZXQgT0RGQyBQTEwgKi8KKwlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy5y
eF9wMV9jbGllbnQsIE1JUElfRElHSVRBTF9QTExfNywKKwkJCQkgfk1JUElfUExMX1JFU0VUX04p
OworCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCBN
SVBJX0RJR0lUQUxfUExMXzcsCisJCQkJTUlQSV9QTExfUkVTRVRfTik7CisKKwlpZiAocmV0IDwg
MCkKKwkJRFJNX0VSUk9SKCJJTyBlcnJvci5cbiIpOworCisJcmV0dXJuIHJldDsKK30KKworc3Rh
dGljIGludCBhbng3NjI1X2RzaV92aWRlb190aW1pbmdfY29uZmlnKHN0cnVjdCBhbng3NjI1X2Rh
dGEgKmN0eCkKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKwl1
bnNpZ25lZCBsb25nIG0sIG47CisJdTE2IGh0b3RhbDsKKwlpbnQgcmV0OworCXU4IHBvc3RfZGl2
aWRlciA9IDA7CisKKwlyZXQgPSBhbng3NjI1X2NhbGN1bGF0ZV9tX24oY3R4LT5kdC5waXhlbGNs
b2NrLm1pbiAqIDEwMDAsCisJCQkJICAgICZtLCAmbiwgJnBvc3RfZGl2aWRlcik7CisKKwlpZiAo
cmV0KSB7CisJCURSTV9FUlJPUigiY2Fubm90IGdldCBwcm9wZXJ0eSBtIG4gdmFsdWUuXG4iKTsK
KwkJcmV0dXJuIHJldDsKKwl9CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJjb21wdXRl
IE0oJWx1KSwgTiglbHUpLCBkaXZpZGVyKCVkKS5cbiIsCisJCQkgICAgIG0sIG4sIHBvc3RfZGl2
aWRlcik7CisKKwkvKiBjb25maWd1cmUgcGl4ZWwgY2xvY2sgKi8KKwlyZXQgPSBhbng3NjI1X3Jl
Z193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwgUElYRUxfQ0xPQ0tfTCwKKwkJCQko
Y3R4LT5kdC5waXhlbGNsb2NrLm1pbiAvIDEwMDApICYgMHhGRik7CisJcmV0IHw9IGFueDc2MjVf
cmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LCBQSVhFTF9DTE9DS19ILAorCQkJ
CSAoY3R4LT5kdC5waXhlbGNsb2NrLm1pbiAvIDEwMDApID4+IDgpOworCS8qIGxhbmUgY291bnQg
Ki8KKwlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQs
CisJCQlNSVBJX0xBTkVfQ1RSTF8wLCAweGZjKTsKKwlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihj
dHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKKwkJCQlNSVBJX0xBTkVfQ1RSTF8wLCAzKTsKKwor
CS8qIEh0b3RhbCAqLworCWh0b3RhbCA9IGN0eC0+ZHQuaGFjdGl2ZS5taW4gKyBjdHgtPmR0Lmhm
cm9udF9wb3JjaC5taW4gKworCQljdHgtPmR0LmhiYWNrX3BvcmNoLm1pbiArIGN0eC0+ZHQuaHN5
bmNfbGVuLm1pbjsKKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9w
Ml9jbGllbnQsCisJCQlIT1JJWk9OVEFMX1RPVEFMX1BJWEVMU19MLCBodG90YWwgJiAweEZGKTsK
KwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQsCisJ
CQlIT1JJWk9OVEFMX1RPVEFMX1BJWEVMU19ILCBodG90YWwgPj4gOCk7CisJLyogSGFjdGl2ZSAq
LworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwK
KwkJCUhPUklaT05UQUxfQUNUSVZFX1BJWEVMU19MLCBjdHgtPmR0LmhhY3RpdmUubWluICYgMHhG
Rik7CisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50
LAorCQkJSE9SSVpPTlRBTF9BQ1RJVkVfUElYRUxTX0gsIGN0eC0+ZHQuaGFjdGl2ZS5taW4gPj4g
OCk7CisJLyogSEZQICovCisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMu
cnhfcDJfY2xpZW50LAorCQkJSE9SSVpPTlRBTF9GUk9OVF9QT1JDSF9MLCBjdHgtPmR0Lmhmcm9u
dF9wb3JjaC5taW4pOworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4
X3AyX2NsaWVudCwKKwkJCUhPUklaT05UQUxfRlJPTlRfUE9SQ0hfSCwKKwkJCWN0eC0+ZHQuaGZy
b250X3BvcmNoLm1pbiA+PiA4KTsKKwkvKiBIV1MgKi8KKwlyZXQgfD0gYW54NzYyNV9yZWdfd3Jp
dGUoY3R4LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQsCisJCQlIT1JJWk9OVEFMX1NZTkNfV0lEVEhf
TCwgY3R4LT5kdC5oc3luY19sZW4ubWluKTsKKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4
LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQsCisJCQlIT1JJWk9OVEFMX1NZTkNfV0lEVEhfSCwgY3R4
LT5kdC5oc3luY19sZW4ubWluID4+IDgpOworCS8qIEhCUCAqLworCXJldCB8PSBhbng3NjI1X3Jl
Z193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwKKwkJCUhPUklaT05UQUxfQkFDS19Q
T1JDSF9MLCBjdHgtPmR0LmhiYWNrX3BvcmNoLm1pbik7CisJcmV0IHw9IGFueDc2MjVfcmVnX3dy
aXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAorCQkJSE9SSVpPTlRBTF9CQUNLX1BPUkNI
X0gsIGN0eC0+ZHQuaGJhY2tfcG9yY2gubWluID4+IDgpOworCS8qIFZhY3RpdmUgKi8KKwlyZXQg
fD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQsIEFDVElWRV9M
SU5FU19MLAorCQkJY3R4LT5kdC52YWN0aXZlLm1pbik7CisJcmV0IHw9IGFueDc2MjVfcmVnX3dy
aXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LCBBQ1RJVkVfTElORVNfSCwKKwkJCWN0eC0+
ZHQudmFjdGl2ZS5taW4gPj4gOCk7CisJLyogVkZQICovCisJcmV0IHw9IGFueDc2MjVfcmVnX3dy
aXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAorCQkJVkVSVElDQUxfRlJPTlRfUE9SQ0gs
IGN0eC0+ZHQudmZyb250X3BvcmNoLm1pbik7CisJLyogVldTICovCisJcmV0IHw9IGFueDc2MjVf
cmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAorCQkJVkVSVElDQUxfU1lOQ19X
SURUSCwgY3R4LT5kdC52c3luY19sZW4ubWluKTsKKwkvKiBWQlAgKi8KKwlyZXQgfD0gYW54NzYy
NV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQsCisJCQlWRVJUSUNBTF9CQUNL
X1BPUkNILCBjdHgtPmR0LnZiYWNrX3BvcmNoLm1pbik7CisJLyogTSB2YWx1ZSAqLworCXJldCB8
PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKKwkJCU1JUElf
UExMX01fTlVNXzIzXzE2LCAobSA+PiAxNikgJiAweGZmKTsKKwlyZXQgfD0gYW54NzYyNV9yZWdf
d3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCisJCQlNSVBJX1BMTF9NX05VTV8xNV84
LCAobSA+PiA4KSAmIDB4ZmYpOworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+
aTJjLnJ4X3AxX2NsaWVudCwKKwkJCU1JUElfUExMX01fTlVNXzdfMCwgKG0gJiAweGZmKSk7CisJ
LyogTiB2YWx1ZSAqLworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4
X3AxX2NsaWVudCwKKwkJCU1JUElfUExMX05fTlVNXzIzXzE2LCAobiA+PiAxNikgJiAweGZmKTsK
KwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCisJ
CQlNSVBJX1BMTF9OX05VTV8xNV84LCAobiA+PiA4KSAmIDB4ZmYpOworCXJldCB8PSBhbng3NjI1
X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9QTExfTl9OVU1fN18w
LAorCQkJKG4gJiAweGZmKSk7CisJLyogZGlmZiAqLworCXJldCB8PSBhbng3NjI1X3JlZ193cml0
ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKKwkJCU1JUElfRElHSVRBTF9BREpfMSwgMHgz
Nyk7CisKKwlyZXQgfD0gYW54NzYyNV9vZGZjX2NvbmZpZyhjdHgsIHBvc3RfZGl2aWRlciAtIDEp
OworCisJaWYgKHJldCA8IDApCisJCURSTV9FUlJPUigibWlwaSBkc2kgc2V0dXAgSU8gZXJyb3Iu
XG4iKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV9zd2FwX2RzaV9s
YW5lMyhzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJaW50IHZhbDsKKworCS8qIHN3YXAg
TUlQSS1EU0kgZGF0YSBsYW5lIDMgUCBhbmQgTiAqLworCXZhbCA9IGFueDc2MjVfcmVnX3JlYWQo
Y3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIE1JUElfU1dBUCk7CisJaWYgKHZhbCA8IDApIHsK
KwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGFjY2VzcyBNSVBJX1NXQVAuXG4iKTsKKwkJcmV0dXJu
IC1FSU87CisJfQorCisJdmFsIHw9ICgxIDw8IE1JUElfU1dBUF9DSDMpOworCXJldHVybiBhbng3
NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9TV0FQLCB2YWwp
OworfQorCitzdGF0aWMgaW50IGFueDc2MjVfYXBpX2RzaV9jb25maWcoc3RydWN0IGFueDc2MjVf
ZGF0YSAqY3R4KQorCit7CisJaW50IHZhbCwgcmV0OworCisJLyogc3dhcCBNSVBJLURTSSBkYXRh
IGxhbmUgMyBQIGFuZCBOICovCisJcmV0ID0gYW54NzYyNV9zd2FwX2RzaV9sYW5lMyhjdHgpOwor
CWlmIChyZXQgPCAwKSB7CisJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBzd2FwIGRzaSBsYW5lIDMg
ZmFpbGVkLlxuIik7CisJCXJldHVybiByZXQ7CisJfQorCisJLyogRFNJIGNsb2NrIHNldHRpbmdz
ICovCisJdmFsID0gKDAgPDwgTUlQSV9IU19QV0RfQ0xLKQkJfAorCQkoMCA8PCBNSVBJX0hTX1JU
X0NMSykJCXwKKwkJKDAgPDwgTUlQSV9QRF9DTEspCQl8CisJCSgxIDw8IE1JUElfQ0xLX1JUX01B
TlVBTF9QRF9FTikJfAorCQkoMSA8PCBNSVBJX0NMS19IU19NQU5VQUxfUERfRU4pCXwKKwkJKDAg
PDwgTUlQSV9DTEtfREVUX0RFVF9CWVBBU1MpCXwKKwkJKDAgPDwgTUlQSV9DTEtfTUlTU19DVFJM
KQl8CisJCSgwIDw8IE1JUElfUERfTFBUWF9DSF9NQU5VQUxfUERfRU4pOworCXJldCA9IGFueDc2
MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAorCQkJCU1JUElfUEhZX0NP
TlRST0xfMywgdmFsKTsKKworCS8qCisJICogRGVjcmVhc2VkIEhTIHByZXBhcmUgdGltaW5nIGRl
bGF5IGZyb20gMTYwbnMgdG8gODBucyB3b3JrIHdpdGgKKwkgKiAgICAgYSkgRHJhZ29uIGJvYXJk
IDgxMCBzZXJpZXMgKFF1YWxjb21tIEFQKQorCSAqICAgICBiKSBNb3ZpbmcgUGl4ZWwgRFNJIHNv
dXJjZSAoUEczQSBwYXR0ZXJuIGdlbmVyYXRvciArCisJICoJUDMzMiBELVBIWSBQcm9iZSkgZGVm
YXVsdCBELVBIWSB0aW1pbmcKKwkgKgk1bnMvc3RlcAorCSAqLworCXJldCB8PSBhbng3NjI1X3Jl
Z193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKKwkJCQkgTUlQSV9USU1FX0hTX1BS
UFIsIDB4MTApOworCisJLyogZW5hYmxlIERTSSBtb2RlKi8KKwlyZXQgfD0gYW54NzYyNV93cml0
ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9ESUdJVEFMX1BMTF8xOCwKKwkJ
CQlTRUxFQ1RfRFNJIDw8IE1JUElfRFBJX1NFTEVDVCk7CisKKwlyZXQgfD0gYW54NzYyNV9kc2lf
dmlkZW9fdGltaW5nX2NvbmZpZyhjdHgpOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9FUlJPUigi
ZHNpIHZpZGVvIHRpbWluZyBjb25maWcgZmFpbGVkXG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisK
KwkvKiB0b2dnbGUgbSwgbiByZWFkeSAqLworCXJldCA9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwg
Y3R4LT5pMmMucnhfcDFfY2xpZW50LCBNSVBJX0RJR0lUQUxfUExMXzYsCisJCQkJfihNSVBJX01f
TlVNX1JFQURZIHwgTUlQSV9OX05VTV9SRUFEWSkpOworCXVzbGVlcF9yYW5nZSgxMDAwLCAxMTAw
KTsKKwlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwg
TUlQSV9ESUdJVEFMX1BMTF82LAorCQkJCU1JUElfTV9OVU1fUkVBRFkgfCBNSVBJX05fTlVNX1JF
QURZKTsKKworCS8qIGNvbmZpZ3VyZSBpbnRlZ2VyIHN0YWJsZSByZWdpc3RlciAqLworCXJldCB8
PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKKwkJCQkgTUlQ
SV9WSURFT19TVEFCTEVfQ05ULCAweDAyKTsKKwkvKiBwb3dlciBvbiBNSVBJIFJYICovCisJcmV0
IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAorCQkJCSBN
SVBJX0xBTkVfQ1RSTF8xMCwgMHgwMCk7CisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwg
Y3R4LT5pMmMucnhfcDFfY2xpZW50LAorCQkJCSBNSVBJX0xBTkVfQ1RSTF8xMCwgMHg4MCk7CisK
KwlpZiAocmV0IDwgMCkKKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IG1pcGkgZHNpIGVuYWJsZSBp
bml0IGZhaWxlZC5cbiIpOworCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBhbng3NjI1
X2RzaV9jb25maWcoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCXN0cnVjdCBkZXZpY2Ug
KmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2OworCWludCByZXQ7CisKKwlEUk1fREVWX0RFQlVHX0RS
SVZFUihkZXYsICJjb25maWcgZHNpLlxuIik7CisKKwkvKiBEU0MgZGlzYWJsZSAqLworCXJldCA9
IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCVJfRFND
X0NUUkxfMCwgfkRTQ19FTik7CisKKwlyZXQgfD0gYW54NzYyNV9hcGlfZHNpX2NvbmZpZyhjdHgp
OworCisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGFwaSBkc2kgY29u
ZmlnIGVycm9yLlxuIik7CisJCXJldHVybiByZXQ7CisJfQorCisJLyogc2V0IE1JUEkgUlggRU4g
Ki8KKwlyZXQgPSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAor
CQkJICAgICAgIEFQX0FWX1NUQVRVUywgQVBfTUlQSV9SWF9FTik7CisJLyogY2xlYXIgbXV0ZSBm
bGFnICovCisJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xp
ZW50LAorCQkJCSBBUF9BVl9TVEFUVVMsICh1OCl+QVBfTUlQSV9NVVRFKTsKKwlpZiAocmV0IDwg
MCkKKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGVuYWJsZSBtaXBpIHJ4IGZhaWxlZC5cbiIpOwor
CWVsc2UKKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAic3VjY2VzcyB0byBjb25maWcgRFNJ
XG4iKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV9hcGlfZHBpX2Nv
bmZpZyhzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJdTE2IGZyZXEgPSBjdHgtPmR0LnBp
eGVsY2xvY2subWluIC8gMTAwMDsKKwlpbnQgcmV0OworCisJLyogY29uZmlndXJlIHBpeGVsIGNs
b2NrICovCisJcmV0ID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGll
bnQsCisJCQkJUElYRUxfQ0xPQ0tfTCwgZnJlcSAmIDB4RkYpOworCXJldCB8PSBhbng3NjI1X3Jl
Z193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkgUElYRUxfQ0xPQ0tfSCwg
KGZyZXEgPj4gOCkpOworCisJLyogc2V0IERQSSBtb2RlICovCisJLyogc2V0IHRvIERQSSBQTEwg
bW9kdWxlIHNlbCAqLworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4
X3AxX2NsaWVudCwKKwkJCQkgTUlQSV9ESUdJVEFMX1BMTF85LCAweDIwKTsKKwkvKiBwb3dlciBk
b3duIE1JUEkgKi8KKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9w
MV9jbGllbnQsCisJCQkJIE1JUElfTEFORV9DVFJMXzEwLCAweDA4KTsKKwkvKiBlbmFibGUgRFBJ
IG1vZGUgKi8KKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMV9j
bGllbnQsCisJCQkJIE1JUElfRElHSVRBTF9QTExfMTgsIDB4MUMpOworCS8qIHNldCBmaXJzdCBl
ZGdlICovCisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMudHhfcDJfY2xp
ZW50LAorCQkJCSBWSURFT19DT05UUk9MXzAsIDB4MDUpOworCWlmIChyZXQgPCAwKQorCQlEUk1f
RVJST1IoIklPIGVycm9yIDogZHBpIHBoeSBzZXQgZmFpbGVkLlxuIik7CisKKwlyZXR1cm4gcmV0
OworfQorCitzdGF0aWMgaW50IGFueDc2MjVfZHBpX2NvbmZpZyhzdHJ1Y3QgYW54NzYyNV9kYXRh
ICpjdHgpCit7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisJaW50
IHJldDsKKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImNvbmZpZyBkcGlcbiIpOworCisJ
LyogRFNDIGRpc2FibGUgKi8KKwlyZXQgPSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+aTJj
LnJ4X3AwX2NsaWVudCwKKwkJCQlSX0RTQ19DVFJMXzAsIH5EU0NfRU4pOworCWlmIChyZXQgPCAw
KSB7CisJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBkaXNhYmxlIGRzYyBmYWlsZWQuXG4iKTsKKwkJ
cmV0dXJuIHJldDsKKwl9CisKKwlyZXQgPSBhbng3NjI1X2NvbmZpZ19iaXRfbWF0cml4KGN0eCk7
CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0VSUk9SKCJjb25maWcgYml0IG1hdHJpeCBmYWlsZWQu
XG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXQgPSBhbng3NjI1X2FwaV9kcGlfY29uZmln
KGN0eCk7CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0VSUk9SKCJtaXBpIHBoeShkcGkpIHNldHVw
IGZhaWxlZC5cbiIpOworCQlyZXR1cm4gcmV0OworCX0KKworCS8qIHNldCBNSVBJIFJYIEVOICov
CisJcmV0ID0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJ
CSAgICAgICBBUF9BVl9TVEFUVVMsIEFQX01JUElfUlhfRU4pOworCS8qIGNsZWFyIG11dGUgZmxh
ZyAqLworCXJldCB8PSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVu
dCwKKwkJCQkgQVBfQVZfU1RBVFVTLCAodTgpfkFQX01JUElfTVVURSk7CisJaWYgKHJldCA8IDAp
CisJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBlbmFibGUgbWlwaSByeCBmYWlsZWQuXG4iKTsKKwor
CXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBjb25zdCB1OCBBTlhfT1VJWzNdID0gezB4MDAsIDB4
MjIsIDB4Qjl9Oworc3RhdGljIGludCBpc19hbnhfZG9uZ2xlKHN0cnVjdCBhbng3NjI1X2RhdGEg
KmN0eCkKK3sKKwl1OCBidWZbM107CisKKwkvKiAweDA1MDB+MHgwNTAyOiBCUkFOQ0hfSUVFRV9P
VUkgKi8KKwlzcF90eF9hdXhfZHBjZHJlYWRfYnl0ZXMoY3R4LCAweDAwLCAweDA1LCAweDAwLCBz
aXplb2YoYnVmKSwgYnVmKTsKKwlpZiAobWVtY21wKGJ1ZiwgQU5YX09VSSwgc2l6ZW9mKGJ1Zikp
ID09IDApCisJCXJldHVybiAwOworCisJcmV0dXJuIC1FTlhJTzsKK30KKworc3RhdGljIHZvaWQg
c3BfdHhfZ2V0X3J4X2J3KHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwgdTggKmJ3KQoreworCXU4
IGRhdGFfYnVmWzRdOworCS8qCisJICogV2hlbiBBTlggZG9uZ2xlIGNvbm5lY3RlZCwgaWYgQ0hJ
UF9JRCA9IDB4Nzc1MCwgYmFuZHdpZHRoIGlzIDYuNzVHLAorCSAqIGJlY2F1c2UgQU5YNzc1MCBE
UENEIDB4MDUyeCB3YXMgbm90IGF2YWlsYWJsZS4KKwkgKi8KKwlpZiAoIWlzX2FueF9kb25nbGUo
Y3R4KSkgeworCQlzcF90eF9hdXhfZHBjZHJlYWRfYnl0ZXMoY3R4LCAweDAwLCAweDA1LCAweDAz
LCAweDA0LCBkYXRhX2J1Zik7CisJCWlmIChkYXRhX2J1ZlswXSA9PSAweDM3ICYmIGRhdGFfYnVm
WzFdID09IDB4MzcgJiYKKwkJICAgIGRhdGFfYnVmWzJdID09IDB4MzUgJiYgZGF0YV9idWZbM10g
PT0gMHgzMCkgeworCQkJLyogMHgxOSA6IDYuNzVHICovCisJCQkqYncgPSAweDE5OworCQl9IGVs
c2UgeworCQkJc3BfdHhfYXV4X2RwY2RyZWFkX2J5dGVzKGN0eCwgMHgwMCwgMHgwNSwgMHgyMSwg
MSwgYncpOworCQkJLyoKKwkJCSAqIHNvbWUgQU5YIGRvbmdsZSByZWFkIG91dCB2YWx1ZSAwLAor
CQkJICogcmV0cnkgc3RhbmRhcmQgcmVnaXN0ZXIuCisJCQkgKi8KKwkJCWlmICgoKCpidykgPT0g
MCkgfHwgKCgqYncpID09IDB4ZmYpKQorCQkJCXNwX3R4X2F1eF9kcGNkcmVhZF9ieXRlcyhjdHgs
IDB4MDAsIDB4MDAsCisJCQkJCQkJIERQQ0RfTUFYX0xJTktfUkFURSwKKwkJCQkJCQkgMSwgYncp
OworCQl9CisJfSBlbHNlIHsKKwkJc3BfdHhfYXV4X2RwY2RyZWFkX2J5dGVzKGN0eCwgMHgwMCwg
MHgwMCwKKwkJCQkJIERQQ0RfTUFYX0xJTktfUkFURSwgMSwgYncpOworCX0KK30KKworc3RhdGlj
IHZvaWQgYW54NzYyNV9kcF9zdGFydChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJaW50
IHJldDsKKworCWlmICghY3R4LT5kaXNwbGF5X3RpbWluZ192YWxpZCkgeworCQlEUk1fRVJST1Io
Im1pcGkgZHJtIGhhdmVuJ3Qgc2V0IGRpc3BsYXkgdGltaW5nIHlldC5cbiIpOworCQlyZXR1cm47
CisJfQorCisJYW54NzYyNV9jb25maWdfYXVkaW9faW5wdXQoY3R4KTsKKworCWlmIChjdHgtPnBk
YXRhLmRzaV9zdXBwb3J0ZWQpCisJCXJldCA9IGFueDc2MjVfZHNpX2NvbmZpZyhjdHgpOworCWVs
c2UKKwkJcmV0ID0gYW54NzYyNV9kcGlfY29uZmlnKGN0eCk7CisKKwlpZiAocmV0IDwgMCkKKwkJ
RFJNX0VSUk9SKCJNSVBJIHBoeSBzZXR1cCBlcnJvci5cbiIpOworfQorCitzdGF0aWMgdm9pZCBh
bng3NjI1X2RwX3N0b3Aoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCXN0cnVjdCBkZXZp
Y2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2OworCWludCByZXQ7CisKKwlEUk1fREVWX0RFQlVH
X0RSSVZFUihkZXYsICJzdG9wIGRwIG91dHB1dFxuIik7CisKKwkvKgorCSAqIHZpZGVvIGRpc2Fi
bGU6IDB4NzI6MDggYml0IDcgPSAwOworCSAqIGF1ZGlvIGRpc2FibGU6IDB4NzA6ODcgYml0IDAg
PSAwOworCSAqLworCXJldCA9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMudHhfcDBf
Y2xpZW50LCAweDg3LCAweGZlKTsKKwlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgt
PmkyYy50eF9wMl9jbGllbnQsIDB4MDgsIDB4N2YpOworCisJcmV0IHw9IGFueDc2MjVfdmlkZW9f
bXV0ZV9jb250cm9sKGN0eCwgMSk7CisJaWYgKHJldCA8IDApCisJCURSTV9FUlJPUigiSU8gZXJy
b3IgOiBtdXRlIHZpZGVvIGZhaWxlZFxuIik7Cit9CisKK3N0YXRpYyBpbnQgc3BfdHhfcnN0X2F1
eChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJaW50IHJldDsKKworCXJldCA9IGFueDc2
MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy50eF9wMl9jbGllbnQsIFJTVF9DVFJMMiwKKwkJCSAg
ICAgICBBVVhfUlNUKTsKKwlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy50
eF9wMl9jbGllbnQsIFJTVF9DVFJMMiwKKwkJCQkgfkFVWF9SU1QpOworCXJldHVybiByZXQ7Cit9
CisKK3N0YXRpYyBpbnQgc3BfdHhfYXV4X3dyKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwgdTgg
b2Zmc2V0KQoreworCWludCByZXQ7CisKKwlyZXQgPSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0
eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQlBUF9BVVhfQlVGRl9TVEFSVCwgb2Zmc2V0KTsKKwly
ZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJ
IEFQX0FVWF9DT01NQU5ELCAweDA0KTsKKwlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0
eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQlBUF9BVVhfQ1RSTF9TVEFUVVMsIEFQX0FVWF9DVFJM
X09QX0VOKTsKKwlyZXR1cm4gKHJldCB8IHdhaXRfYXV4X29wX2ZpbmlzaChjdHgpKTsKK30KKwor
c3RhdGljIGludCBzcF90eF9hdXhfcmQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LCB1OCBsZW5f
Y21kKQoreworCWludCByZXQ7CisKKwlyZXQgPSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+
aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQlBUF9BVVhfQ09NTUFORCwgbGVuX2NtZCk7CisJcmV0IHw9
IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJQVBfQVVY
X0NUUkxfU1RBVFVTLCBBUF9BVVhfQ1RSTF9PUF9FTik7CisJcmV0dXJuIChyZXQgfCB3YWl0X2F1
eF9vcF9maW5pc2goY3R4KSk7Cit9CisKK3N0YXRpYyBpbnQgc3BfdHhfZ2V0X2VkaWRfYmxvY2so
c3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCWludCBjID0gMDsKKwlzdHJ1Y3QgZGV2aWNl
ICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKworCXNwX3R4X2F1eF93cihjdHgsIDB4N2UpOwor
CXNwX3R4X2F1eF9yZChjdHgsIDB4MDEpOworCWMgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY3R4
LT5pMmMucnhfcDBfY2xpZW50LCBBUF9BVVhfQlVGRl9TVEFSVCk7CisJaWYgKGMgPCAwKSB7CisJ
CURSTV9FUlJPUigiSU8gZXJyb3IgOiBhY2Nlc3MgQVVYIEJVRkYuXG4iKTsKKwkJcmV0dXJuIC1F
SU87CisJfQorCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiIEVESUQgQmxvY2sgPSAlZFxu
IiwgYyArIDEpOworCisJaWYgKGMgPiBNQVhfRURJRF9CTE9DSykKKwkJYyA9IDE7CisKKwlyZXR1
cm4gYzsKK30KKworc3RhdGljIGludCBlZGlkX3JlYWQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4
LAorCQkgICAgIHU4IG9mZnNldCwgdTggKnBibG9ja19idWYpCit7CisJaW50IHJldCwgY250Owor
CXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2OworCisJZm9yIChjbnQgPSAw
OyBjbnQgPD0gRURJRF9UUllfQ05UOyBjbnQrKykgeworCQlzcF90eF9hdXhfd3IoY3R4LCBvZmZz
ZXQpOworCQkvKiBzZXQgSTJDIHJlYWQgY29tIDB4MDEgbW90ID0gMCBhbmQgcmVhZCAxNiBieXRl
cyAqLworCQlyZXQgPSBzcF90eF9hdXhfcmQoY3R4LCAweGYxKTsKKworCQlpZiAocmV0KSB7CisJ
CQlzcF90eF9yc3RfYXV4KGN0eCk7CisJCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJlZGlk
IHJlYWQgZmFpbGVkLCByZXNldCFcbiIpOworCQl9IGVsc2UgeworCQkJcmV0ID0gYW54NzYyNV9y
ZWdfYmxvY2tfcmVhZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkJCSAgICAgQVBf
QVVYX0JVRkZfU1RBUlQsCisJCQkJCQkgICAgIE1BWF9EUENEX0JVRkZFUl9TSVpFLAorCQkJCQkJ
ICAgICBwYmxvY2tfYnVmKTsKKwkJCWlmICghcmV0KQorCQkJCWJyZWFrOworCQl9CisJfQorCisJ
aWYgKGNudCA+IEVESURfVFJZX0NOVCkKKwkJcmV0dXJuIC1FSU87CisKKwlyZXR1cm4gMDsKK30K
Kworc3RhdGljIGludCBzZWdtZW50c19lZGlkX3JlYWQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4
LAorCQkJICAgICAgdTggc2VnbWVudCwgdTggKmJ1ZiwgdTggb2Zmc2V0KQoreworCXU4IGNudDsK
KwlpbnQgcmV0OworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2OworCisJ
Lyogd3JpdGUgYWRkcmVzcyBvbmx5ICovCisJcmV0ID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBj
dHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJQVBfQVVYX0FERFJfN18wLCAweDMwKTsKKwlyZXQg
fD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJIEFQ
X0FVWF9DT01NQU5ELCAweDA0KTsKKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgt
PmkyYy5yeF9wMF9jbGllbnQsCisJCQkJIEFQX0FVWF9DVFJMX1NUQVRVUywKKwkJCQkgQVBfQVVY
X0NUUkxfQUREUk9OTFkgfCBBUF9BVVhfQ1RSTF9PUF9FTik7CisKKwlyZXQgfD0gd2FpdF9hdXhf
b3BfZmluaXNoKGN0eCk7CisJLyogd3JpdGUgc2VnbWVudCBhZGRyZXNzICovCisJcmV0IHw9IHNw
X3R4X2F1eF93cihjdHgsIHNlZ21lbnQpOworCS8qIGRhdGEgcmVhZCAqLworCXJldCB8PSBhbng3
NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkgQVBfQVVYX0FE
RFJfN18wLCAweDUwKTsKKwlpZiAocmV0KSB7CisJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBhdXgg
aW5pdGlhbCBmYWlsZWQuXG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlmb3IgKGNudCA9IDA7
IGNudCA8PSBFRElEX1RSWV9DTlQ7IGNudCsrKSB7CisJCXNwX3R4X2F1eF93cihjdHgsIG9mZnNl
dCk7CisJCS8qIHNldCBJMkMgcmVhZCBjb20gMHgwMSBtb3QgPSAwIGFuZCByZWFkIDE2IGJ5dGVz
ICovCisJCXJldCA9IHNwX3R4X2F1eF9yZChjdHgsIDB4ZjEpOworCisJCWlmIChyZXQpIHsKKwkJ
CXJldCA9IHNwX3R4X3JzdF9hdXgoY3R4KTsKKwkJCURSTV9ERVZfRVJST1IoZGV2LCAic2VnbWVu
dCByZWFkIGZhaWxlZCwgcmVzZXQhXG4iKTsKKwkJfSBlbHNlIHsKKwkJCXJldCA9IGFueDc2MjVf
cmVnX2Jsb2NrX3JlYWQoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJCQkgICAgIEFQ
X0FVWF9CVUZGX1NUQVJULAorCQkJCQkJICAgICBNQVhfRFBDRF9CVUZGRVJfU0laRSwgYnVmKTsK
KwkJCWlmICghcmV0KQorCQkJCWJyZWFrOworCQl9CisJfQorCisJaWYgKGNudCA+IEVESURfVFJZ
X0NOVCkKKwkJcmV0dXJuIC1FSU87CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBzcF90
eF9lZGlkX3JlYWQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAorCQkJICAgdTggKnBlZGlkX2Js
b2Nrc19idWYpCit7CisJdTggb2Zmc2V0LCBlZGlkX3BvczsKKwlpbnQgY291bnQsIGJsb2Nrc19u
dW07CisJdTggcGJsb2NrX2J1ZltNQVhfRFBDRF9CVUZGRVJfU0laRV07CisJdTggaSwgajsKKwl1
OCBnX2VkaWRfYnJlYWsgPSAwOworCWludCByZXQ7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0
eC0+Y2xpZW50LT5kZXY7CisKKwkvKiBhZGRyZXNzIGluaXRpYWwgKi8KKwlyZXQgPSBhbng3NjI1
X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQlBUF9BVVhfQUREUl83
XzAsIDB4NTApOworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3Aw
X2NsaWVudCwKKwkJCQkgQVBfQVVYX0FERFJfMTVfOCwgMCk7CisJcmV0IHw9IGFueDc2MjVfd3Jp
dGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCSBBUF9BVVhfQUREUl8xOV8x
NiwgMHhmMCk7CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0VSUk9SKCJhY2Nlc3MgYXV4IGNoYW5u
ZWwgSU8gZXJyb3IuXG4iKTsKKwkJcmV0dXJuIC1FSU87CisJfQorCisJYmxvY2tzX251bSA9IHNw
X3R4X2dldF9lZGlkX2Jsb2NrKGN0eCk7CisJaWYgKGJsb2Nrc19udW0gPCAwKQorCQlyZXR1cm4g
YmxvY2tzX251bTsKKworCWNvdW50ID0gMDsKKworCWRvIHsKKwkJc3dpdGNoIChjb3VudCkgewor
CQljYXNlIDA6CisJCWNhc2UgMToKKwkJCWZvciAoaSA9IDA7IGkgPCA4OyBpKyspIHsKKwkJCQlv
ZmZzZXQgPSAoaSArIGNvdW50ICogOCkgKiBNQVhfRFBDRF9CVUZGRVJfU0laRTsKKwkJCQlnX2Vk
aWRfYnJlYWsgPSBlZGlkX3JlYWQoY3R4LCBvZmZzZXQsCisJCQkJCQkJIHBibG9ja19idWYpOwor
CisJCQkJaWYgKGdfZWRpZF9icmVhaykKKwkJCQkJYnJlYWs7CisKKwkJCQltZW1jcHkoJnBlZGlk
X2Jsb2Nrc19idWZbb2Zmc2V0XSwKKwkJCQkgICAgICAgcGJsb2NrX2J1ZiwKKwkJCQkgICAgICAg
TUFYX0RQQ0RfQlVGRkVSX1NJWkUpOworCQkJfQorCisJCQlicmVhazsKKwkJY2FzZSAyOgorCQkJ
b2Zmc2V0ID0gMHgwMDsKKworCQkJZm9yIChqID0gMDsgaiA8IDg7IGorKykgeworCQkJCWVkaWRf
cG9zID0gKGogKyBjb3VudCAqIDgpICoKKwkJCQkJTUFYX0RQQ0RfQlVGRkVSX1NJWkU7CisKKwkJ
CQlpZiAoZ19lZGlkX2JyZWFrID09IDEpCisJCQkJCWJyZWFrOworCisJCQkJc2VnbWVudHNfZWRp
ZF9yZWFkKGN0eCwgY291bnQgLyAyLAorCQkJCQkJICAgcGJsb2NrX2J1Ziwgb2Zmc2V0KTsKKwkJ
CQltZW1jcHkoJnBlZGlkX2Jsb2Nrc19idWZbZWRpZF9wb3NdLAorCQkJCSAgICAgICBwYmxvY2tf
YnVmLAorCQkJCSAgICAgICBNQVhfRFBDRF9CVUZGRVJfU0laRSk7CisJCQkJb2Zmc2V0ID0gb2Zm
c2V0ICsgMHgxMDsKKwkJCX0KKworCQkJYnJlYWs7CisJCWNhc2UgMzoKKwkJCW9mZnNldCA9IDB4
ODA7CisKKwkJCWZvciAoaiA9IDA7IGogPCA4OyBqKyspIHsKKwkJCQllZGlkX3BvcyA9IChqICsg
Y291bnQgKiA4KSAqCisJCQkJCU1BWF9EUENEX0JVRkZFUl9TSVpFOworCQkJCWlmIChnX2VkaWRf
YnJlYWsgPT0gMSkKKwkJCQkJYnJlYWs7CisKKwkJCQlzZWdtZW50c19lZGlkX3JlYWQoY3R4LCBj
b3VudCAvIDIsCisJCQkJCQkgICBwYmxvY2tfYnVmLCBvZmZzZXQpOworCQkJCW1lbWNweSgmcGVk
aWRfYmxvY2tzX2J1ZltlZGlkX3Bvc10sCisJCQkJICAgICAgIHBibG9ja19idWYsCisJCQkJICAg
ICAgIE1BWF9EUENEX0JVRkZFUl9TSVpFKTsKKwkJCQlvZmZzZXQgPSBvZmZzZXQgKyAweDEwOwor
CQkJfQorCisJCQlicmVhazsKKwkJZGVmYXVsdDoKKwkJCWJyZWFrOworCQl9CisKKwkJY291bnQr
KzsKKworCX0gd2hpbGUgKGJsb2Nrc19udW0gPj0gY291bnQpOworCisJLyogY2hlY2sgZWRpZCBk
YXRhICovCisJaWYgKCFkcm1fZWRpZF9pc192YWxpZCgoc3RydWN0IGVkaWQgKilwZWRpZF9ibG9j
a3NfYnVmKSkgeworCQlEUk1fREVWX0VSUk9SKGRldiwgIldBUk5JTkchIGVkaWQgY2hlY2sgZmFp
bGVkIVxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCS8qIHJlc2V0IGF1eCBjaGFubmVs
ICovCisJc3BfdHhfcnN0X2F1eChjdHgpOworCisJcmV0dXJuIChibG9ja3NfbnVtICsgMSk7Cit9
CisKK3N0YXRpYyB2b2lkIGFueDc2MjVfcG93ZXJfb24oc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4
KQoreworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2OworCisJaWYgKCFj
dHgtPnBkYXRhLmxvd19wb3dlcl9tb2RlKSB7CisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwg
IkFueDc2MjUgbm90IGxvdyBwb3dlciBtb2RlIVxuIik7CisJCXJldHVybjsKKwl9CisKKwkvKiBw
b3dlciBvbiBwaW4gZW5hYmxlICovCisJZ3Bpb2Rfc2V0X3ZhbHVlKGN0eC0+cGRhdGEuZ3Bpb19w
X29uLCAxKTsKKwl1c2xlZXBfcmFuZ2UoMTAwMDAsIDExMDAwKTsKKwkvKiBwb3dlciByZXNldCBw
aW4gZW5hYmxlICovCisJZ3Bpb2Rfc2V0X3ZhbHVlKGN0eC0+cGRhdGEuZ3Bpb19yZXNldCwgMSk7
CisJdXNsZWVwX3JhbmdlKDEwMDAwLCAxMTAwMCk7CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihk
ZXYsICJBbng3NjI1IHBvd2VyIG9uICFcbiIpOworfQorCitzdGF0aWMgdm9pZCBhbng3NjI1X3Bv
d2VyX3N0YW5kYnkoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCXN0cnVjdCBkZXZpY2Ug
KmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2OworCisJaWYgKCFjdHgtPnBkYXRhLmxvd19wb3dlcl9t
b2RlKSB7CisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImFueDc2MjUgbm90IGxvdyBwb3dl
ciBtb2RlIVxuIik7CisJCXJldHVybjsKKwl9CisKKwlncGlvZF9zZXRfdmFsdWUoY3R4LT5wZGF0
YS5ncGlvX3Jlc2V0LCAwKTsKKwl1c2xlZXBfcmFuZ2UoMTAwMCwgMTEwMCk7CisJZ3Bpb2Rfc2V0
X3ZhbHVlKGN0eC0+cGRhdGEuZ3Bpb19wX29uLCAwKTsKKwl1c2xlZXBfcmFuZ2UoMTAwMCwgMTEw
MCk7CisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiYW54NzYyNSBwb3dlciBkb3duXG4iKTsK
K30KKworLyogYmFzaWMgY29uZmlndXJhdGlvbnMgb2YgQU5YNzYyNSAqLworc3RhdGljIHZvaWQg
YW54NzYyNV9jb25maWcoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCWFueDc2MjVfcmVn
X3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJICBYVEFMX0ZSUV9TRUwsIFhU
QUxfRlJRXzI3TSk7Cit9CisKK3N0YXRpYyB2b2lkIGFueDc2MjVfZGlzYWJsZV9wZF9wcm90b2Nv
bChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0
eC0+Y2xpZW50LT5kZXY7CisJaW50IHJldDsKKworCS8qIHJlc2V0IG1haW4gb2NtICovCisJcmV0
ID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsIDB4ODgsIDB4
NDApOworCS8qIERpc2FibGUgUEQgKi8KKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBj
dHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJIEFQX0FWX1NUQVRVUywgQVBfRElTQUJMRV9QRCk7
CisJLyogcmVsZWFzZSBtYWluIG9jbSAqLworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgs
IGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwgMHg4OCwgMHgwMCk7CisKKwlpZiAocmV0IDwgMCkKKwkJ
RFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZGlzYWJsZSBQRCBmZWF0dXJlIGZhaWxlZC5cbiIp
OworCWVsc2UKKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZGlzYWJsZSBQRCBmZWF0dXJl
IHN1Y2NlZWRlZC5cbiIpOworfQorCitzdGF0aWMgdm9pZCBhbng3NjI1X3Bvd2VyX29uX2luaXQo
c3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCWludCByZXRyeV9jb3VudCwgaTsKKwlpbnQg
cmV0OworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2OworCisJZm9yIChy
ZXRyeV9jb3VudCA9IDA7IHJldHJ5X2NvdW50IDwgMzsgcmV0cnlfY291bnQrKykgeworCQlhbng3
NjI1X3Bvd2VyX29uKGN0eCk7CisJCWFueDc2MjVfY29uZmlnKGN0eCk7CisKKwkJZm9yIChpID0g
MDsgaSA8IE9DTV9MT0FESU5HX1RJTUU7IGkrKykgeworCQkJLyogY2hlY2sgaW50ZXJmYWNlIHdv
cmthYmxlICovCisJCQlyZXQgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY3R4LT5pMmMucnhfcDBf
Y2xpZW50LAorCQkJCQkgICAgICAgRkxBU0hfTE9BRF9TVEEpOworCQkJaWYgKHJldCA8IDApIHsK
KwkJCQlEUk1fRVJST1IoIklPIGVycm9yIDogYWNjZXNzIGZsYXNoIGxvYWQuXG4iKTsKKwkJCQly
ZXR1cm47CisJCQl9CisJCQlpZiAoKHJldCAmIEZMQVNIX0xPQURfU1RBX0NISykgPT0gRkxBU0hf
TE9BRF9TVEFfQ0hLKSB7CisJCQkJYW54NzYyNV9kaXNhYmxlX3BkX3Byb3RvY29sKGN0eCk7CisJ
CQkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LAorCQkJCQkJICAgICAiRmlybXdhcmUgdmVyICUw
MnglMDJ4LCIsCisJCQkJCWFueDc2MjVfcmVnX3JlYWQoY3R4LAorCQkJCQkJCSBjdHgtPmkyYy5y
eF9wMF9jbGllbnQsCisJCQkJCQkJIE9DTV9GV19WRVJTSU9OKSwKKwkJCQkJYW54NzYyNV9yZWdf
cmVhZChjdHgsCisJCQkJCQkJIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkJCQkgT0NNX0ZX
X1JFVkVSU0lPTikpOworCQkJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIkRyaXZlciB2ZXJz
aW9uICVzXG4iLAorCQkJCQkJICAgICBBTlg3NjI1X0RSVl9WRVJTSU9OKTsKKworCQkJCXJldHVy
bjsKKwkJCX0KKwkJCXVzbGVlcF9yYW5nZSgxMDAwLCAxMTAwKTsKKwkJfQorCQlhbng3NjI1X3Bv
d2VyX3N0YW5kYnkoY3R4KTsKKwl9Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV9leHRjb25fbm90
aWZpZXIoc3RydWN0IG5vdGlmaWVyX2Jsb2NrICpuYiwKKwkJCQkgICB1bnNpZ25lZCBsb25nIGV2
ZW50LCB2b2lkICpwdHIpCit7CisJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0KKwkJY29udGFp
bmVyX29mKG5iLCBzdHJ1Y3QgYW54NzYyNV9kYXRhLCBldmVudF9uYik7CisKKwlzY2hlZHVsZV93
b3JrKCZjdHgtPmV4dGNvbl93cSk7CisJcmV0dXJuIE5PVElGWV9ET05FOworfQorCitzdGF0aWMg
dm9pZCBhbng3NjI1X2NoaXBfY29udHJvbChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsIGludCBz
dGF0ZSkKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKworCURS
TV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImJlZm9yZSBzZXQsIHBvd2VyX3N0YXRlKCVkKS5cbiIs
CisJCQkgICAgIGF0b21pY19yZWFkKCZjdHgtPnBvd2VyX3N0YXR1cykpOworCisJaWYgKCFjdHgt
PnBkYXRhLmxvd19wb3dlcl9tb2RlKQorCQlyZXR1cm47CisKKwlpZiAoc3RhdGUpIHsKKwkJYXRv
bWljX2luYygmY3R4LT5wb3dlcl9zdGF0dXMpOworCQlpZiAoYXRvbWljX3JlYWQoJmN0eC0+cG93
ZXJfc3RhdHVzKSA9PSAxKQorCQkJYW54NzYyNV9wb3dlcl9vbl9pbml0KGN0eCk7CisJfSBlbHNl
IHsKKwkJaWYgKGF0b21pY19yZWFkKCZjdHgtPnBvd2VyX3N0YXR1cykpIHsKKwkJCWF0b21pY19k
ZWMoJmN0eC0+cG93ZXJfc3RhdHVzKTsKKworCQkJaWYgKGF0b21pY19yZWFkKCZjdHgtPnBvd2Vy
X3N0YXR1cykgPT0gMCkKKwkJCQlhbng3NjI1X3Bvd2VyX3N0YW5kYnkoY3R4KTsKKwkJfQorCX0K
KworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImFmdGVyIHNldCwgcG93ZXJfc3RhdGUoJWQp
LlxuIiwKKwkJCSAgICAgYXRvbWljX3JlYWQoJmN0eC0+cG93ZXJfc3RhdHVzKSk7Cit9CisKK3N0
YXRpYyB2b2lkIGFueDc2MjVfZXh0Y29uX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQor
eworCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCA9CisJCWNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1
Y3QgYW54NzYyNV9kYXRhLCBleHRjb25fd3EpOworCWludCBzdGF0ZSA9IGV4dGNvbl9nZXRfc3Rh
dGUoY3R4LT5leHRjb24sIEVYVENPTl9ESVNQX0RQKTsKKworCW11dGV4X2xvY2soJmN0eC0+bG9j
ayk7CisJYW54NzYyNV9jaGlwX2NvbnRyb2woY3R4LCBzdGF0ZSk7CisJbXV0ZXhfdW5sb2NrKCZj
dHgtPmxvY2spOworfQorCitzdGF0aWMgaW50IGFueDc2MjVfZXh0Y29uX25vdGlmaWVyX2luaXQo
c3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCWludCByZXQ7CisJc3RydWN0IGRldmljZSAq
ZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisKKwljdHgtPmV2ZW50X25iLm5vdGlmaWVyX2NhbGwg
PSBhbng3NjI1X2V4dGNvbl9ub3RpZmllcjsKKwlJTklUX1dPUksoJmN0eC0+ZXh0Y29uX3dxLCBh
bng3NjI1X2V4dGNvbl93b3JrKTsKKwlyZXQgPSBkZXZtX2V4dGNvbl9yZWdpc3Rlcl9ub3RpZmll
cigmY3R4LT5jbGllbnQtPmRldiwgY3R4LT5leHRjb24sCisJCQkJCSAgICBFWFRDT05fRElTUF9E
UCwgJmN0eC0+ZXZlbnRfbmIpOworCWlmIChyZXQpIHsKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJm
YWlsZWQgdG8gcmVnaXN0ZXIgbm90aWZpZXIgZm9yIERQIik7CisJCXJldHVybiByZXQ7CisJfQor
CXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBhbng3NjI1X2luaXRfZ3BpbyhzdHJ1Y3QgYW54
NzYyNV9kYXRhICpwbGF0Zm9ybSkKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmcGxhdGZvcm0t
PmNsaWVudC0+ZGV2OworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiYW54NzYyNSBpbml0
IGdwaW9cbiIpOworCisJLyogZ3BpbyBmb3IgY2hpcCBwb3dlciBlbmFibGUgKi8KKwlwbGF0Zm9y
bS0+cGRhdGEuZ3Bpb19wX29uID0KKwkJZGV2bV9ncGlvZF9nZXRfb3B0aW9uYWwoZGV2LCAiZW5h
YmxlIiwgR1BJT0RfT1VUX0xPVyk7CisJLyogZ3BpbyBmb3IgY2hpcCByZXNldCAqLworCXBsYXRm
b3JtLT5wZGF0YS5ncGlvX3Jlc2V0ID0KKwkJZGV2bV9ncGlvZF9nZXRfb3B0aW9uYWwoZGV2LCAi
cmVzZXQiLCBHUElPRF9PVVRfTE9XKTsKKworCWlmIChwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19wX29u
ICYmIHBsYXRmb3JtLT5wZGF0YS5ncGlvX3Jlc2V0KSB7CisJCXBsYXRmb3JtLT5wZGF0YS5sb3df
cG93ZXJfbW9kZSA9IDE7CisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImxvdyBwb3dlciBt
b2RlLCBwb24gJWQsIHJlc2V0ICVkLlxuIiwKKwkJCQkgICAgIGRlc2NfdG9fZ3BpbyhwbGF0Zm9y
bS0+cGRhdGEuZ3Bpb19wX29uKSwKKwkJCQkgICAgIGRlc2NfdG9fZ3BpbyhwbGF0Zm9ybS0+cGRh
dGEuZ3Bpb19yZXNldCkpOworCX0gZWxzZSB7CisJCXBsYXRmb3JtLT5wZGF0YS5sb3dfcG93ZXJf
bW9kZSA9IDA7CisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIm5vdCBsb3cgcG93ZXIgbW9k
ZS5cbiIpOworCX0KK30KKworc3RhdGljIHZvaWQgYW54NzYyNV9zdG9wX2RwX3dvcmsoc3RydWN0
IGFueDc2MjVfZGF0YSAqY3R4KQoreworCWN0eC0+aHBkX3N0YXR1cyA9IDA7CisJY3R4LT5ocGRf
aGlnaF9jbnQgPSAwOworCWN0eC0+ZGlzcGxheV90aW1pbmdfdmFsaWQgPSAwOworCisJY3R4LT5z
bGltcG9ydF9lZGlkX3AuZWRpZF9ibG9ja19udW0gPSAtMTsKKworCWlmIChjdHgtPnBkYXRhLmxv
d19wb3dlcl9tb2RlID09IDApCisJCWFueDc2MjVfZGlzYWJsZV9wZF9wcm90b2NvbChjdHgpOwor
fQorCitzdGF0aWMgdm9pZCBhbng3NjI1X3N0YXJ0X2RwX3dvcmsoc3RydWN0IGFueDc2MjVfZGF0
YSAqY3R4KQoreworCWludCByZXQ7CisJdTggYnVmW01BWF9EUENEX0JVRkZFUl9TSVpFXTsKKwl1
OCBoZGNwX2NhcDsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKwl1
OCBzcF90eF9idzsgLyogbGlua3RyYWluaW5nIGJhbndpZHRoICovCisJdTggc3BfdHhfbGFuZV9j
b3VudDsgLyogbGluayB0cmFpbmluZyBsYW5lIGNvdW50ICovCisKKwlpZiAoY3R4LT5ocGRfaGln
aF9jbnQgPj0gMikgeworCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJhbng3NjI1IGZpbHRl
ciB1c2VsZXNzIEhQRFxuIik7CisJCXJldHVybjsKKwl9CisKKwljdHgtPmhwZF9oaWdoX2NudCsr
OworCisJc3BfdHhfZ2V0X3J4X2J3KGN0eCwgJnNwX3R4X2J3KTsKKworCXNwX3R4X2F1eF9kcGNk
cmVhZF9ieXRlcyhjdHgsIDB4MDAsIDB4MDAsIERQQ0RfTUFYX0xBTkVfQ09VTlQsCisJCQkJIDEs
ICZzcF90eF9sYW5lX2NvdW50KTsKKworCXNwX3R4X2xhbmVfY291bnQgPSBzcF90eF9sYW5lX2Nv
dW50ICYgMHgxZjsKKwlzcF90eF9hdXhfZHBjZHJlYWRfYnl0ZXMoY3R4LCAweDA2LCAweDgwLCAw
eDI4LCAxLCBidWYpOy8qIHJlYWQgQmNhcCAqLworCisJaGRjcF9jYXAgPSBidWZbMF0gJiAweDAx
OworCisJLyogbm90IHN1cHBvcnQgSERDUCAqLworCXJldCA9IGFueDc2MjVfd3JpdGVfYW5kKGN0
eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCAweGVlLCAweDlmKTsKKworCWlmIChoZGNwX2NhcCA9
PSAweDAxKQorCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJIRENQMS40XG4iKTsKKworCS8q
IHRyeSBhdXRoIGZsYWcgKi8KKwlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJj
LnJ4X3AxX2NsaWVudCwgMHhlYywgMHgxMCk7CisJLyogaW50ZXJydXB0IGZvciBEUk0gKi8KKwly
ZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgMHhmZiwg
MHgwMSk7CisJaWYgKHJldCA8IDApCisJCXJldHVybjsKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihk
ZXYsICJNQVggQlc9JTAyeCwgTUFYIExhbmUgY250PSUwMngsIEhEQ1A9JTAyeFxuIiwKKwkJCSAg
ICAgKHUzMilzcF90eF9idywKKwkJCSAgICAgKHUzMilzcF90eF9sYW5lX2NvdW50LAorCQkJICAg
ICAodTMyKWhkY3BfY2FwKTsKKworCXJldCA9IGFueDc2MjVfcmVnX3JlYWQoY3R4LCBjdHgtPmky
Yy5yeF9wMV9jbGllbnQsIDB4ODYpOworCWlmIChyZXQgPCAwKQorCQlyZXR1cm47CisKKwlEUk1f
REVWX0RFQlVHX0RSSVZFUihkZXYsICJTZWN1cmUgT0NNIHZlcnNpb249JTAyeFxuIiwgcmV0KTsK
K30KKworc3RhdGljIGludCBhbng3NjI1X3JlYWRfaHBkX3N0YXR1c19wMChzdHJ1Y3QgYW54NzYy
NV9kYXRhICpjdHgpCit7CisJcmV0dXJuIGFueDc2MjVfcmVnX3JlYWQoY3R4LCBjdHgtPmkyYy5y
eF9wMF9jbGllbnQsIFNZU1RFTV9TVFNUVVMpOworfQorCitzdGF0aWMgdm9pZCBhbng3NjI1X2hw
ZF9wb2xsaW5nKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sKKwlpbnQgcmV0LCB2YWw7CisJ
c3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisKKwlpZiAoYXRvbWljX3Jl
YWQoJmN0eC0+cG93ZXJfc3RhdHVzKSAhPSAxKSB7CisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRl
diwgIk5vIG5lZWQgdG8gcG9saW5nIEhQRCBzdGF0dXMuXG4iKTsKKwkJcmV0dXJuOworCX0KKwor
CXJldCA9IHJlYWR4X3BvbGxfdGltZW91dChhbng3NjI1X3JlYWRfaHBkX3N0YXR1c19wMCwKKwkJ
CQkgY3R4LCB2YWwsCisJCQkJICgodmFsICYgSFBEX1NUQVRVUykgfHwgKHZhbCA8IDApKSwKKwkJ
CQkgNTAwMCwKKwkJCQkgNTAwMCAqIDEwMCk7CisJaWYgKHJldCkgeworCQlEUk1fREVWX0VSUk9S
KGRldiwgIkhQRCBwb2xsaW5nIHRpbWVvdXQhXG4iKTsKKwl9IGVsc2UgeworCQlEUk1fREVWX0RF
QlVHX0RSSVZFUihkZXYsICJIUEQgcmFpc2UgdXAuXG4iKTsKKwkJYW54NzYyNV9yZWdfd3JpdGUo
Y3R4LCBjdHgtPmkyYy50Y3BjX2NsaWVudCwKKwkJCQkgIElOVFJfQUxFUlRfMSwgMHhGRik7CisJ
CWFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCSAgSU5U
RVJGQUNFX0NIQU5HRV9JTlQsIDApOworCX0KKworCWFueDc2MjVfc3RhcnRfZHBfd29yayhjdHgp
OworfQorCitzdGF0aWMgdm9pZCBhbng3NjI1X2Rpc2Nvbm5lY3RfY2hlY2soc3RydWN0IGFueDc2
MjVfZGF0YSAqY3R4KQoreworCWlmIChhdG9taWNfcmVhZCgmY3R4LT5wb3dlcl9zdGF0dXMpID09
IDApCisJCWFueDc2MjVfc3RvcF9kcF93b3JrKGN0eCk7Cit9CisKK3N0YXRpYyB2b2lkIGFueDc2
MjVfbG93X3Bvd2VyX21vZGVfY2hlY2soc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAorCQkJCQkg
aW50IHN0YXRlKQoreworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owor
CisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAibG93IHBvd2VyIG1vZGUgY2hlY2ssIHN0YXRl
KCVkKS5cbiIsIHN0YXRlKTsKKworCWlmIChjdHgtPnBkYXRhLmxvd19wb3dlcl9tb2RlKSB7CisJ
CWFueDc2MjVfY2hpcF9jb250cm9sKGN0eCwgc3RhdGUpOworCQlpZiAoc3RhdGUpCisJCQlhbng3
NjI1X2hwZF9wb2xsaW5nKGN0eCk7CisJCWVsc2UKKwkJCWFueDc2MjVfZGlzY29ubmVjdF9jaGVj
ayhjdHgpOworCX0KK30KKworc3RhdGljIHZvaWQgZHBfaHBkX2NoYW5nZV9oYW5kbGVyKHN0cnVj
dCBhbng3NjI1X2RhdGEgKmN0eCwgYm9vbCBvbikKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAm
Y3R4LT5jbGllbnQtPmRldjsKKworCS8qIGhwZCBjaGFuZ2VkICovCisJRFJNX0RFVl9ERUJVR19E
UklWRVIoZGV2LCAiZHBfaHBkX2NoYW5nZV9kZWZhdWx0X2Z1bmM6ICVkXG4iLAorCQkJICAgICAo
dTMyKW9uKTsKKworCWlmIChvbiA9PSAwKSB7CisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwg
IiBIUEQgbG93XG4iKTsKKwkJYW54NzYyNV9zdG9wX2RwX3dvcmsoY3R4KTsKKwl9IGVsc2Ugewor
CQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICIgSFBEIGhpZ2hcbiIpOworCQlhbng3NjI1X3N0
YXJ0X2RwX3dvcmsoY3R4KTsKKwl9CisKKwljdHgtPmhwZF9zdGF0dXMgPSAxOworfQorCitzdGF0
aWMgaW50IGFueDc2MjVfaHBkX2NoYW5nZV9kZXRlY3Qoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4
KQoreworCWludCBpbnRyX3ZlY3Rvciwgc3RhdHVzOworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZj
dHgtPmNsaWVudC0+ZGV2OworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAicG93ZXJfc3Rh
dHVzPSVkXG4iLAorCQkJICAgICAodTMyKWF0b21pY19yZWFkKCZjdHgtPnBvd2VyX3N0YXR1cykp
OworCisJc3RhdHVzID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy50Y3BjX2NsaWVu
dCwKKwkJCQkgICBJTlRSX0FMRVJUXzEsIDB4RkYpOworCWlmIChzdGF0dXMgPCAwKSB7CisJCURS
TV9FUlJPUigiSU8gZXJyb3IgOiBjbGVhciBhbGVydCByZWdpc3Rlci5cbiIpOworCQlyZXR1cm4g
c3RhdHVzOworCX0KKworCWludHJfdmVjdG9yID0gYW54NzYyNV9yZWdfcmVhZChjdHgsIGN0eC0+
aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkgICAgICAgSU5URVJGQUNFX0NIQU5HRV9JTlQpOworCWlm
IChpbnRyX3ZlY3RvciA8IDApIHsKKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGFjY2VzcyBpbnRl
cnJ1cHQgY2hhbmdlIHJlZ2lzdGVyLlxuIik7CisJCXJldHVybiBpbnRyX3ZlY3RvcjsKKwl9CisJ
RFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiMHg3ZToweDQ0PSV4XG4iLCBpbnRyX3ZlY3Rvcik7
CisJc3RhdHVzID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQs
CisJCQkJICAgSU5URVJGQUNFX0NIQU5HRV9JTlQsCisJCQkJICAgaW50cl92ZWN0b3IgJiAofmlu
dHJfdmVjdG9yKSk7CisJaWYgKHN0YXR1cyA8IDApIHsKKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6
IGNsZWFyIGludGVycnVwdCBjaGFuZ2UgcmVnaXN0ZXIuXG4iKTsKKwkJcmV0dXJuIHN0YXR1czsK
Kwl9CisKKwlpZiAoIShpbnRyX3ZlY3RvciAmIEhQRF9TVEFUVVNfQ0hBTkdFKSkKKwkJcmV0dXJu
IC1FTk9FTlQ7CisKKwlzdGF0dXMgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY3R4LT5pMmMucnhf
cDBfY2xpZW50LAorCQkJCSAgU1lTVEVNX1NUU1RVUyk7CisJaWYgKHN0YXR1cyA8IDApIHsKKwkJ
RFJNX0VSUk9SKCJJTyBlcnJvciA6IGNsZWFyIGludGVycnVwdCBzdGF0dXMuXG4iKTsKKwkJcmV0
dXJuIHN0YXR1czsKKwl9CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICIweDdlOjB4NDU9
JXhcbiIsIHN0YXR1cyk7CisJZHBfaHBkX2NoYW5nZV9oYW5kbGVyKGN0eCwgc3RhdHVzICYgSFBE
X1NUQVRVUyk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgYW54NzYyNV93b3JrX2Z1
bmMoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQoreworCWludCBldmVudDsKKwlzdHJ1Y3QgYW54
NzYyNV9kYXRhICpjdHggPSBjb250YWluZXJfb2Yod29yaywKKwkJCQkJCXN0cnVjdCBhbng3NjI1
X2RhdGEsIHdvcmspOworCisJbXV0ZXhfbG9jaygmY3R4LT5sb2NrKTsKKwlldmVudCA9IGFueDc2
MjVfaHBkX2NoYW5nZV9kZXRlY3QoY3R4KTsKKwltdXRleF91bmxvY2soJmN0eC0+bG9jayk7CisK
KwlpZiAoZXZlbnQgPCAwKQorCQlyZXR1cm47CisKKwlpZiAoY3R4LT5icmlkZ2VfYXR0YWNoZWQp
CisJCWRybV9oZWxwZXJfaHBkX2lycV9ldmVudChjdHgtPmNvbm5lY3Rvci5kZXYpOworfQorCitz
dGF0aWMgaXJxcmV0dXJuX3QgYW54NzYyNV9pbnRyX2hwZF9pc3IoaW50IGlycSwgdm9pZCAqZGF0
YSkKK3sKKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHggPSAoc3RydWN0IGFueDc2MjVfZGF0YSAq
KWRhdGE7CisKKwlpZiAoYXRvbWljX3JlYWQoJmN0eC0+cG93ZXJfc3RhdHVzKSAhPSAxKQorCQly
ZXR1cm4gSVJRX05PTkU7CisKKwlxdWV1ZV93b3JrKGN0eC0+d29ya3F1ZXVlLCAmY3R4LT53b3Jr
KTsKKworCXJldHVybiBJUlFfSEFORExFRDsKK30KKworI2lmZGVmIENPTkZJR19PRgorc3RhdGlj
IGludCBhbng3NjI1X3BhcnNlX2R0KHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCSAgICBzdHJ1Y3Qg
YW54NzYyNV9wbGF0Zm9ybV9kYXRhICpwZGF0YSkKK3sKKwlzdHJ1Y3QgZGV2aWNlX25vZGUgKm5w
ID0gZGV2LT5vZl9ub2RlOworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqcGFuZWxfbm9kZSwgKm91dF9l
cDsKKworCW9mX3Byb3BlcnR5X3JlYWRfdTMyKGRldi0+b2Zfbm9kZSwgInBhbmVsX2ZsYWdzIiwK
KwkJCSAgICAgJnBkYXRhLT5wYW5lbF9mbGFncyk7CisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2
LCAicGFuZWxfZmxhZ3MgOiAlZFxuIiwgcGRhdGEtPnBhbmVsX2ZsYWdzKTsKKworCWlmIChwZGF0
YS0+cGFuZWxfZmxhZ3MgPT0gMSkKKwkJcGRhdGEtPmludGVybmFsX3BhbmVsID0gMTsKKwllbHNl
IGlmIChwZGF0YS0+cGFuZWxfZmxhZ3MgPT0gMikKKwkJcGRhdGEtPmV4dGNvbl9zdXBwb3J0ZWQg
PSAxOworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIiVzIHN1cHBvcnQgZXh0Y29uLCAlcyBp
bnRlcm5hbCBwYW5lbFxuIiwKKwkJCSAgICAgcGRhdGEtPmV4dGNvbl9zdXBwb3J0ZWQgPyAiIiA6
ICJub3QiLAorCQkJICAgICBwZGF0YS0+aW50ZXJuYWxfcGFuZWwgPyAiaGFzIiA6ICJubyIpOwor
CisJcGRhdGEtPm5vZGUubWlwaV9kc2lfaG9zdF9ub2RlID0gb2ZfZ3JhcGhfZ2V0X3JlbW90ZV9u
b2RlKG5wLCAwLCAwKTsKKwlpZiAocGRhdGEtPm5vZGUubWlwaV9kc2lfaG9zdF9ub2RlKSB7CisJ
CW9mX25vZGVfcHV0KHBkYXRhLT5ub2RlLm1pcGlfZHNpX2hvc3Rfbm9kZSk7CisJCXBkYXRhLT5k
c2lfc3VwcG9ydGVkID0gMTsKKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZm91bmQgZHNp
IGhvc3Qgbm9kZS5cbiIpOworCX0gZWxzZSB7CisJCXBkYXRhLT5ub2RlLm1pcGlfZHBpX2hvc3Rf
bm9kZSA9CisJCQlvZl9ncmFwaF9nZXRfcmVtb3RlX25vZGUobnAsIDEsIDApOworCisJCWlmIChw
ZGF0YS0+bm9kZS5taXBpX2RwaV9ob3N0X25vZGUpIHsKKwkJCW9mX25vZGVfcHV0KHBkYXRhLT5u
b2RlLm1pcGlfZHBpX2hvc3Rfbm9kZSk7CisJCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJm
b3VuZCBkcGkgaG9zdCBub2RlLlxuIik7CisJCX0KKwl9CisKKwlEUk1fREVWX0RFQlVHX0RSSVZF
UihkZXYsICJkc2lfc3VwcG9ydGVkIDogJWRcbiIsIHBkYXRhLT5kc2lfc3VwcG9ydGVkKTsKKwor
CXBkYXRhLT5ub2RlLnBhbmVsX25vZGUgPSBvZl9ncmFwaF9nZXRfcG9ydF9ieV9pZChucCwgMik7
CisJaWYgKHBkYXRhLT5ub2RlLnBhbmVsX25vZGUpIHsKKwkJb2Zfbm9kZV9wdXQocGRhdGEtPm5v
ZGUucGFuZWxfbm9kZSk7CisJCW91dF9lcCA9IG9mX2dldF9jaGlsZF9ieV9uYW1lKHBkYXRhLT5u
b2RlLnBhbmVsX25vZGUsCisJCQkJCSAgICAgICJlbmRwb2ludCIpOworCQlpZiAoIW91dF9lcCkg
eworCQkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiY2Fubm90IGdldCBlbmRwb2ludC5cbiIp
OworCQkJcmV0dXJuIC1FUFJPQkVfREVGRVI7CisJCX0KKworCQlwYW5lbF9ub2RlID0gb2ZfZ3Jh
cGhfZ2V0X3JlbW90ZV9wb3J0X3BhcmVudChvdXRfZXApOworCQlvZl9ub2RlX3B1dChvdXRfZXAp
OworCisJCXBkYXRhLT5wYW5lbCA9IG9mX2RybV9maW5kX3BhbmVsKHBhbmVsX25vZGUpOworCQlE
Uk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJnZXQgcGFuZWwgbm9kZS5cbiIpOworCQlvZl9ub2Rl
X3B1dChwYW5lbF9ub2RlKTsKKwkJaWYgKElTX0VSUl9PUl9OVUxMKHBkYXRhLT5wYW5lbCkpCisJ
CQlyZXR1cm4gLUVQUk9CRV9ERUZFUjsKKwl9IGVsc2UgeworCQlpZiAocGRhdGEtPmludGVybmFs
X3BhbmVsKSB7CisJCQlEUk1fRVJST1IoImZhaWxlZCB0byBnZXQgaW50ZXJuYWwgcGFuZWwuXG4i
KTsKKwkJCXJldHVybiAtRVBST0JFX0RFRkVSOworCQl9CisJfQorCisJcmV0dXJuIDA7Cit9Cisj
ZWxzZQorc3RhdGljIGludCBhbng3NjI1X3BhcnNlX2R0KHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJ
CSAgICBzdHJ1Y3QgYW54NzYyNV9wbGF0Zm9ybV9kYXRhICpwZGF0YSkKK3sKKwlyZXR1cm4gLUVO
T0RFVjsKK30KKyNlbmRpZgorCitzdGF0aWMgaW5saW5lIHN0cnVjdCBhbng3NjI1X2RhdGEgKmNv
bm5lY3Rvcl90b19hbng3NjI1KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjKQoreworCXJldHVybiBj
b250YWluZXJfb2YoYywgc3RydWN0IGFueDc2MjVfZGF0YSwgY29ubmVjdG9yKTsKK30KKworc3Rh
dGljIGlubGluZSBzdHJ1Y3QgYW54NzYyNV9kYXRhICpicmlkZ2VfdG9fYW54NzYyNShzdHJ1Y3Qg
ZHJtX2JyaWRnZSAqYnJpZGdlKQoreworCXJldHVybiBjb250YWluZXJfb2YoYnJpZGdlLCBzdHJ1
Y3QgYW54NzYyNV9kYXRhLCBicmlkZ2UpOworfQorCitzdGF0aWMgdm9pZCBhbng3NjI1X3Bvc3Rf
ZGlzYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQoreworCXN0cnVjdCBhbng3NjI1X2Rh
dGEgKmN0eCA9IGJyaWRnZV90b19hbng3NjI1KGJyaWRnZSk7CisJc3RydWN0IGRldmljZSAqZGV2
ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisJaW50IHJldDsKKworCURSTV9ERVZfREVCVUdfRFJJVkVS
KGRldiwgInBvc3QgZGlzYWJsZVxuIik7CisKKwlpZiAoIWN0eC0+cGRhdGEucGFuZWwpCisJCXJl
dHVybjsKKworCXJldCA9IGRybV9wYW5lbF91bnByZXBhcmUoY3R4LT5wZGF0YS5wYW5lbCk7CisJ
aWYgKHJldCkKKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gdW5wcmVwYXJlIHBhbmVsOiAlZFxuIiwg
cmV0KTsKKwllbHNlCisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImJhY2tsaWdodCB1bnBy
ZXBhcmVkLlxuIik7CisKKwlhdG9taWNfc2V0KCZjdHgtPnBhbmVsX3Bvd2VyLCAwKTsKK30KKwor
c3RhdGljIHZvaWQgYW54NzYyNV9wcmVfZW5hYmxlKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2Up
Cit7CisJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0gYnJpZGdlX3RvX2FueDc2MjUoYnJpZGdl
KTsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKwlpbnQgcmV0Owor
CisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAicHJlIGVuYWJsZVxuIik7CisKKwlpZiAoIWN0
eC0+cGRhdGEucGFuZWwpCisJCXJldHVybjsKKworCXJldCA9IGRybV9wYW5lbF9wcmVwYXJlKGN0
eC0+cGRhdGEucGFuZWwpOworCWlmIChyZXQgPCAwKQorCQlEUk1fRVJST1IoImZhaWxlZCB0byBw
cmVwYXJlIHBhbmVsOiAlZFxuIiwgcmV0KTsKKwllbHNlCisJCURSTV9ERVZfREVCVUdfRFJJVkVS
KGRldiwgImJhY2tsaWdodCBwcmVwYXJlZC5cbiIpOworCWF0b21pY19zZXQoJmN0eC0+cGFuZWxf
cG93ZXIsIDEpOworfQorCitzdGF0aWMgaW50IGFueDc2MjVfZ2V0X21vZGVzKHN0cnVjdCBkcm1f
Y29ubmVjdG9yICpjb25uZWN0b3IpCit7CisJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0gY29u
bmVjdG9yX3RvX2FueDc2MjUoY29ubmVjdG9yKTsKKwlpbnQgZXJyLCBudW1fbW9kZXMgPSAwOwor
CWludCB0dXJuX29mZl9mbGFnID0gMDsKKwlzdHJ1Y3Qgc19lZGlkX2RhdGEgKnBfZWRpZCA9ICZj
dHgtPnNsaW1wb3J0X2VkaWRfcDsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQt
PmRldjsKKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRybSBnZXQgbW9kZXNcbiIpOwor
CisJaWYgKGN0eC0+c2xpbXBvcnRfZWRpZF9wLmVkaWRfYmxvY2tfbnVtID4gMCkKKwkJZ290byBv
dXQ7CisKKwltdXRleF9sb2NrKCZjdHgtPmxvY2spOworCisJaWYgKGN0eC0+cGRhdGEucGFuZWwg
JiYgYXRvbWljX3JlYWQoJmN0eC0+cGFuZWxfcG93ZXIpID09IDApIHsKKwkJdHVybl9vZmZfZmxh
ZyA9IDE7CisJCWFueDc2MjVfcHJlX2VuYWJsZSgmY3R4LT5icmlkZ2UpOworCX0KKworCWFueDc2
MjVfbG93X3Bvd2VyX21vZGVfY2hlY2soY3R4LCAxKTsKKworCXBfZWRpZC0+ZWRpZF9ibG9ja19u
dW0gPSBzcF90eF9lZGlkX3JlYWQoY3R4LCBwX2VkaWQtPmVkaWRfcmF3X2RhdGEpOworCisJZXJy
ID0gLUVJTzsKKwlpZiAocF9lZGlkLT5lZGlkX2Jsb2NrX251bSA8IDApIHsKKwkJRFJNX0VSUk9S
KCJGYWlsZWQgdG8gcmVhZCBFRElELlxuIik7CisJCWdvdG8gZmFpbDsKKwl9CisKKwllcnIgPSBk
cm1fY29ubmVjdG9yX3VwZGF0ZV9lZGlkX3Byb3BlcnR5KGNvbm5lY3RvciwKKwkJCQkJCSAoc3Ry
dWN0IGVkaWQgKikKKwkJCQkJCSAmcF9lZGlkLT5lZGlkX3Jhd19kYXRhKTsKKworCWlmIChlcnIp
CisJCURSTV9FUlJPUigiRmFpbGVkIHRvIHVwZGF0ZSBFRElEIHByb3BlcnR5OiAlZFxuIiwgZXJy
KTsKKworZmFpbDoKKwltdXRleF91bmxvY2soJmN0eC0+bG9jayk7CisJYW54NzYyNV9sb3dfcG93
ZXJfbW9kZV9jaGVjayhjdHgsIDApOworCWlmIChjdHgtPnBkYXRhLnBhbmVsICYmIHR1cm5fb2Zm
X2ZsYWcgPT0gMSkKKwkJYW54NzYyNV9wb3N0X2Rpc2FibGUoJmN0eC0+YnJpZGdlKTsKKworCWlm
IChlcnIpCisJCXJldHVybiBlcnI7CisKK291dDoKKwludW1fbW9kZXMgPSBkcm1fYWRkX2VkaWRf
bW9kZXMoY29ubmVjdG9yLAorCQkJCSAgICAgICAoc3RydWN0IGVkaWQgKikmcF9lZGlkLT5lZGlk
X3Jhd19kYXRhKTsKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJudW1fbW9kZXMoJWQpXG4i
LCBudW1fbW9kZXMpOworCisJcmV0dXJuIG51bV9tb2RlczsKK30KKworc3RhdGljIGVudW0gZHJt
X21vZGVfc3RhdHVzCithbng3NjI1X2Nvbm5lY3Rvcl9tb2RlX3ZhbGlkKHN0cnVjdCBkcm1fY29u
bmVjdG9yICpjb25uZWN0b3IsCisJCQkgICAgIHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2Rl
KQoreworCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCA9IGNvbm5lY3Rvcl90b19hbng3NjI1KGNv
bm5lY3Rvcik7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisKKwlE
Uk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJkcm0gbW9kZXMgdmFsaWQgdmVyaWZ5XG4iKTsKKwor
CWlmIChtb2RlLT5jbG9jayA+IFNVUFBPUlRfUElYRUxfQ0xPQ0spCisJCXJldHVybiBNT0RFX0NM
T0NLX0hJR0g7CisKKwlyZXR1cm4gTU9ERV9PSzsKK30KKworc3RhdGljIHN0cnVjdCBkcm1fY29u
bmVjdG9yX2hlbHBlcl9mdW5jcyBhbng3NjI1X2Nvbm5lY3Rvcl9oZWxwZXJfZnVuY3MgPSB7CisJ
LmdldF9tb2RlcyA9IGFueDc2MjVfZ2V0X21vZGVzLAorCS5tb2RlX3ZhbGlkID0gYW54NzYyNV9j
b25uZWN0b3JfbW9kZV92YWxpZCwKK307CisKK3N0YXRpYyBlbnVtIGRybV9jb25uZWN0b3Jfc3Rh
dHVzIGFueDc2MjVfZGV0ZWN0KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCisJCQkJ
CQlib29sIGZvcmNlKQoreworCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCA9IGNvbm5lY3Rvcl90
b19hbng3NjI1KGNvbm5lY3Rvcik7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50
LT5kZXY7CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJkcm0gZGV0ZWN0XG4iKTsKKwor
CWlmIChjdHgtPnBkYXRhLmludGVybmFsX3BhbmVsKQorCQlyZXR1cm4gY29ubmVjdG9yX3N0YXR1
c19jb25uZWN0ZWQ7CisKKwlpZiAoIWN0eC0+aHBkX3N0YXR1cykKKwkJcmV0dXJuIGNvbm5lY3Rv
cl9zdGF0dXNfZGlzY29ubmVjdGVkOworCisJcmV0dXJuIGNvbm5lY3Rvcl9zdGF0dXNfY29ubmVj
dGVkOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3JfZnVuY3MgYW54NzYy
NV9jb25uZWN0b3JfZnVuY3MgPSB7CisJLmZpbGxfbW9kZXMgPSBkcm1faGVscGVyX3Byb2JlX3Np
bmdsZV9jb25uZWN0b3JfbW9kZXMsCisJLmRldGVjdCA9IGFueDc2MjVfZGV0ZWN0LAorCS5kZXN0
cm95ID0gZHJtX2Nvbm5lY3Rvcl9jbGVhbnVwLAorCS5yZXNldCA9IGRybV9hdG9taWNfaGVscGVy
X2Nvbm5lY3Rvcl9yZXNldCwKKwkuYXRvbWljX2R1cGxpY2F0ZV9zdGF0ZSA9IGRybV9hdG9taWNf
aGVscGVyX2Nvbm5lY3Rvcl9kdXBsaWNhdGVfc3RhdGUsCisJLmF0b21pY19kZXN0cm95X3N0YXRl
ID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2Rlc3Ryb3lfc3RhdGUsCit9OworCitzdGF0
aWMgaW50IGFueDc2MjVfYXR0YWNoX2RzaShzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJ
c3RydWN0IG1pcGlfZHNpX2hvc3QgKmhvc3Q7CisJc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNp
OworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqbWlwaV9ob3N0X25vZGU7CisJc3RydWN0IGRldmljZSAq
ZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisJY29uc3Qgc3RydWN0IG1pcGlfZHNpX2RldmljZV9p
bmZvIGluZm8gPSB7CisJCS50eXBlID0gImFueDc2MjUiLAorCQkuY2hhbm5lbCA9IDAsCisJCS5u
b2RlID0gTlVMTCwKKwl9OworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiYXR0YWNoIGRz
aVxuIik7CisKKwlpZiAoY3R4LT5wZGF0YS5kc2lfc3VwcG9ydGVkKQorCQltaXBpX2hvc3Rfbm9k
ZSA9IGN0eC0+cGRhdGEubm9kZS5taXBpX2RzaV9ob3N0X25vZGU7CisJZWxzZQorCQltaXBpX2hv
c3Rfbm9kZSA9IGN0eC0+cGRhdGEubm9kZS5taXBpX2RwaV9ob3N0X25vZGU7CisKKwlpZiAoIW1p
cGlfaG9zdF9ub2RlKSB7CisJCURSTV9FUlJPUigiZHNpIGhvc3QgaXMgbm90IGNvbmZpZ3VyZWQu
XG4iKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJaG9zdCA9IG9mX2ZpbmRfbWlwaV9kc2lf
aG9zdF9ieV9ub2RlKG1pcGlfaG9zdF9ub2RlKTsKKwlpZiAoIWhvc3QpIHsKKwkJRFJNX0VSUk9S
KCJmYWlsZWQgdG8gZmluZCBkc2kgaG9zdC5cbiIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisK
Kwlkc2kgPSBtaXBpX2RzaV9kZXZpY2VfcmVnaXN0ZXJfZnVsbChob3N0LCAmaW5mbyk7CisJaWYg
KElTX0VSUihkc2kpKSB7CisJCURSTV9FUlJPUigiZmFpbGVkIHRvIGNyZWF0ZSBkc2kgZGV2aWNl
LlxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCWRzaS0+bGFuZXMgPSA0OworCWRzaS0+
Zm9ybWF0ID0gTUlQSV9EU0lfRk1UX1JHQjg4ODsKKwlkc2ktPm1vZGVfZmxhZ3MgPSBNSVBJX0RT
SV9NT0RFX1ZJREVPCXwKKwkJTUlQSV9EU0lfTU9ERV9WSURFT19TWU5DX1BVTFNFCXwKKwkJTUlQ
SV9EU0lfTU9ERV9FT1RfUEFDS0VUCXwKKwkJTUlQSV9EU0lfTU9ERV9WSURFT19IU0U7CisKKwlp
ZiAobWlwaV9kc2lfYXR0YWNoKGRzaSkgPCAwKSB7CisJCURSTV9FUlJPUigiZmFpbGVkIHRvIGF0
dGFjaCBkc2kgdG8gaG9zdC5cbiIpOworCQltaXBpX2RzaV9kZXZpY2VfdW5yZWdpc3Rlcihkc2kp
OworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwljdHgtPmRzaSA9IGRzaTsKKworCURSTV9ERVZf
REVCVUdfRFJJVkVSKGRldiwgImF0dGFjaCBkc2kgc3VjY2VlZGVkLlxuIik7CisKKwlyZXR1cm4g
MDsKK30KKworc3RhdGljIHZvaWQgYW54NzYyNV9icmlkZ2VfZGV0YWNoKHN0cnVjdCBkcm1fYnJp
ZGdlICpicmlkZ2UpCit7CisJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0gYnJpZGdlX3RvX2Fu
eDc2MjUoYnJpZGdlKTsKKworCWlmIChjdHgtPmRzaSkgeworCQltaXBpX2RzaV9kZXRhY2goY3R4
LT5kc2kpOworCQltaXBpX2RzaV9kZXZpY2VfdW5yZWdpc3RlcihjdHgtPmRzaSk7CisJfQorCisJ
aWYgKGN0eC0+YnJpZGdlX2F0dGFjaGVkKQorCQlkcm1fY29ubmVjdG9yX3VucmVnaXN0ZXIoJmN0
eC0+Y29ubmVjdG9yKTsKK30KKworc3RhdGljIGludCBhbng3NjI1X2JyaWRnZV9hdHRhY2goc3Ry
dWN0IGRybV9icmlkZ2UgKmJyaWRnZSkKK3sKKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHggPSBi
cmlkZ2VfdG9fYW54NzYyNShicmlkZ2UpOworCWludCBlcnI7CisJc3RydWN0IGRldmljZSAqZGV2
ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJkcm0g
YXR0YWNoXG4iKTsKKwlpZiAoIWJyaWRnZS0+ZW5jb2RlcikgeworCQlEUk1fRVJST1IoIlBhcmVu
dCBlbmNvZGVyIG9iamVjdCBub3QgZm91bmQiKTsKKwkJcmV0dXJuIC1FTk9ERVY7CisJfQorCisJ
ZXJyID0gZHJtX2Nvbm5lY3Rvcl9pbml0KGJyaWRnZS0+ZGV2LCAmY3R4LT5jb25uZWN0b3IsCisJ
CQkJICZhbng3NjI1X2Nvbm5lY3Rvcl9mdW5jcywKKwkJCQkgRFJNX01PREVfQ09OTkVDVE9SX0Rp
c3BsYXlQb3J0KTsKKwlpZiAoZXJyKSB7CisJCURSTV9FUlJPUigiRmFpbGVkIHRvIGluaXRpYWxp
emUgY29ubmVjdG9yOiAlZFxuIiwgZXJyKTsKKwkJcmV0dXJuIGVycjsKKwl9CisKKwlkcm1fY29u
bmVjdG9yX2hlbHBlcl9hZGQoJmN0eC0+Y29ubmVjdG9yLAorCQkJCSAmYW54NzYyNV9jb25uZWN0
b3JfaGVscGVyX2Z1bmNzKTsKKworCWVyciA9IGRybV9jb25uZWN0b3JfcmVnaXN0ZXIoJmN0eC0+
Y29ubmVjdG9yKTsKKwlpZiAoZXJyKSB7CisJCURSTV9FUlJPUigiRmFpbGVkIHRvIHJlZ2lzdGVy
IGNvbm5lY3RvcjogJWRcbiIsIGVycik7CisJCXJldHVybiBlcnI7CisJfQorCisJY3R4LT5jb25u
ZWN0b3IucG9sbGVkID0gRFJNX0NPTk5FQ1RPUl9QT0xMX0hQRDsKKworCWVyciA9IGRybV9jb25u
ZWN0b3JfYXR0YWNoX2VuY29kZXIoJmN0eC0+Y29ubmVjdG9yLCBicmlkZ2UtPmVuY29kZXIpOwor
CWlmIChlcnIpIHsKKwkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gbGluayB1cCBjb25uZWN0b3IgdG8g
ZW5jb2RlcjogJWRcbiIsIGVycik7CisJCWRybV9jb25uZWN0b3JfdW5yZWdpc3RlcigmY3R4LT5j
b25uZWN0b3IpOworCQlyZXR1cm4gZXJyOworCX0KKworCWVyciA9IGFueDc2MjVfYXR0YWNoX2Rz
aShjdHgpOworCWlmIChlcnIpIHsKKwkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gYXR0YWNoIHRvIGRz
aSA6ICVkXG4iLCBlcnIpOworCQlkcm1fY29ubmVjdG9yX3VucmVnaXN0ZXIoJmN0eC0+Y29ubmVj
dG9yKTsKKwkJcmV0dXJuIGVycjsKKwl9CisKKwljdHgtPmJyaWRnZV9hdHRhY2hlZCA9IDE7CisK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIGVudW0gZHJtX21vZGVfc3RhdHVzCithbng3NjI1X2Jy
aWRnZV9tb2RlX3ZhbGlkKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UsCisJCQkgIGNvbnN0IHN0
cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlKQoreworCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0
eCA9IGJyaWRnZV90b19hbng3NjI1KGJyaWRnZSk7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0
eC0+Y2xpZW50LT5kZXY7CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJkcm0gbW9kZSBj
aGVja2luZ1xuIik7CisKKwkvKiBNYXggMTIwMHAgYXQgNS40IEdoeiwgb25lIGxhbmUsIHBpeGVs
IGNsb2NrIDMwME0gKi8KKwlpZiAobW9kZS0+Y2xvY2sgPiBTVVBQT1JUX1BJWEVMX0NMT0NLKSB7
CisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwKKwkJCQkgICAgICJkcm0gbW9kZSBpbnZhbGlk
LCBwaXhlbGNsb2NrIHRvbyBoaWdoLlxuIik7CisJCXJldHVybiBNT0RFX0NMT0NLX0hJR0g7CisJ
fQorCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZHJtIG1vZGUgdmFsaWQuXG4iKTsKKwor
CXJldHVybiBNT0RFX09LOworfQorCitzdGF0aWMgdm9pZCBhbng3NjI1X2JyaWRnZV9tb2RlX3Nl
dChzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAorCQkJCSAgICBjb25zdCBzdHJ1Y3QgZHJtX2Rp
c3BsYXlfbW9kZSAqb2xkX21vZGUsCisJCQkJICAgIGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9t
b2RlICptb2RlKQoreworCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCA9IGJyaWRnZV90b19hbng3
NjI1KGJyaWRnZSk7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisK
KwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJkcm0gbW9kZSBzZXRcbiIpOworCisJbXV0ZXhf
bG9jaygmY3R4LT5sb2NrKTsKKworCWN0eC0+ZHQucGl4ZWxjbG9jay5taW4gPSBtb2RlLT5jbG9j
azsKKwljdHgtPmR0LmhhY3RpdmUubWluID0gbW9kZS0+aGRpc3BsYXk7CisJY3R4LT5kdC5oc3lu
Y19sZW4ubWluID0gbW9kZS0+aHN5bmNfZW5kIC0gbW9kZS0+aHN5bmNfc3RhcnQ7CisJY3R4LT5k
dC5oZnJvbnRfcG9yY2gubWluID0gbW9kZS0+aHN5bmNfc3RhcnQgLSBtb2RlLT5oZGlzcGxheTsK
KwljdHgtPmR0LmhiYWNrX3BvcmNoLm1pbiA9IG1vZGUtPmh0b3RhbCAtIG1vZGUtPmhzeW5jX2Vu
ZDsKKwljdHgtPmR0LnZhY3RpdmUubWluID0gbW9kZS0+dmRpc3BsYXk7CisJY3R4LT5kdC52c3lu
Y19sZW4ubWluID0gbW9kZS0+dnN5bmNfZW5kIC0gbW9kZS0+dnN5bmNfc3RhcnQ7CisJY3R4LT5k
dC52ZnJvbnRfcG9yY2gubWluID0gbW9kZS0+dnN5bmNfc3RhcnQgLSBtb2RlLT52ZGlzcGxheTsK
KwljdHgtPmR0LnZiYWNrX3BvcmNoLm1pbiA9IG1vZGUtPnZ0b3RhbCAtIG1vZGUtPnZzeW5jX2Vu
ZDsKKworCWN0eC0+ZGlzcGxheV90aW1pbmdfdmFsaWQgPSAxOworCisJRFJNX0RFVl9ERUJVR19E
UklWRVIoZGV2LCAicGl4ZWxjbG9jayglZCkuXG4iLCBjdHgtPmR0LnBpeGVsY2xvY2subWluKTsK
KwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJoYWN0aXZlKCVkKSwgaHN5bmMoJWQpLCBoZnAo
JWQpLCBoYnAoJWQpXG4iLAorCQkJICAgICBjdHgtPmR0LmhhY3RpdmUubWluLAorCQkJICAgICBj
dHgtPmR0LmhzeW5jX2xlbi5taW4sCisJCQkgICAgIGN0eC0+ZHQuaGZyb250X3BvcmNoLm1pbiwK
KwkJCSAgICAgY3R4LT5kdC5oYmFja19wb3JjaC5taW4pOworCURSTV9ERVZfREVCVUdfRFJJVkVS
KGRldiwgInZhY3RpdmUoJWQpLCB2c3luYyglZCksIHZmcCglZCksIHZicCglZClcbiIsCisJCQkg
ICAgIGN0eC0+ZHQudmFjdGl2ZS5taW4sCisJCQkgICAgIGN0eC0+ZHQudnN5bmNfbGVuLm1pbiwK
KwkJCSAgICAgY3R4LT5kdC52ZnJvbnRfcG9yY2gubWluLAorCQkJICAgICBjdHgtPmR0LnZiYWNr
X3BvcmNoLm1pbik7CisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiaGRpc3BsYXkoJWQpLGhz
eW5jX3N0YXJ0KCVkKS5cbiIsCisJCQkgICAgIG1vZGUtPmhkaXNwbGF5LAorCQkJICAgICBtb2Rl
LT5oc3luY19zdGFydCk7CisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiaHN5bmNfZW5kKCVk
KSxodG90YWwoJWQpLlxuIiwKKwkJCSAgICAgbW9kZS0+aHN5bmNfZW5kLAorCQkJICAgICBtb2Rl
LT5odG90YWwpOworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgInZkaXNwbGF5KCVkKSx2c3lu
Y19zdGFydCglZCkuXG4iLAorCQkJICAgICBtb2RlLT52ZGlzcGxheSwKKwkJCSAgICAgbW9kZS0+
dnN5bmNfc3RhcnQpOworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgInZzeW5jX2VuZCglZCks
dnRvdGFsKCVkKS5cbiIsCisJCQkgICAgIG1vZGUtPnZzeW5jX2VuZCwKKwkJCSAgICAgbW9kZS0+
dnRvdGFsKTsKKworCW11dGV4X3VubG9jaygmY3R4LT5sb2NrKTsKK30KKworc3RhdGljIHZvaWQg
YW54NzYyNV9icmlkZ2VfZW5hYmxlKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UpCit7CisJc3Ry
dWN0IGFueDc2MjVfZGF0YSAqY3R4ID0gYnJpZGdlX3RvX2FueDc2MjUoYnJpZGdlKTsKKwlzdHJ1
Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKwlpbnQgcmV0OworCisJRFJNX0RF
Vl9ERUJVR19EUklWRVIoZGV2LCAiZHJtIGVuYWJsZVxuIik7CisKKwlhbng3NjI1X2xvd19wb3dl
cl9tb2RlX2NoZWNrKGN0eCwgMSk7CisKKwlpZiAoV0FSTl9PTighYXRvbWljX3JlYWQoJmN0eC0+
cG93ZXJfc3RhdHVzKSkpCisJCXJldHVybjsKKworCWlmIChjdHgtPnBkYXRhLnBhbmVsKSB7CisJ
CXJldCA9IGRybV9wYW5lbF9lbmFibGUoY3R4LT5wZGF0YS5wYW5lbCk7CisJCWlmIChyZXQgPCAw
KSB7CisJCQlEUk1fRVJST1IoImZhaWxlZCB0byBlbmFibGUgcGFuZWw6ICVkLlxuIiwgcmV0KTsK
KwkJCXJldHVybjsKKwkJfQorCX0KKworCW11dGV4X2xvY2soJmN0eC0+bG9jayk7CisJYW54NzYy
NV9kcF9zdGFydChjdHgpOworCW11dGV4X3VubG9jaygmY3R4LT5sb2NrKTsKK30KKworc3RhdGlj
IHZvaWQgYW54NzYyNV9icmlkZ2VfZGlzYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQor
eworCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCA9IGJyaWRnZV90b19hbng3NjI1KGJyaWRnZSk7
CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisJaW50IHJldDsKKwor
CWlmIChXQVJOX09OKCFhdG9taWNfcmVhZCgmY3R4LT5wb3dlcl9zdGF0dXMpKSkKKwkJcmV0dXJu
OworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZHJtIGRpc2FibGVcbiIpOworCisJaWYg
KGN0eC0+cGRhdGEucGFuZWwpIHsKKwkJcmV0ID0gZHJtX3BhbmVsX2Rpc2FibGUoY3R4LT5wZGF0
YS5wYW5lbCk7CisJCWlmIChyZXQgPCAwKQorCQkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gZGlzYWJs
ZSBwYW5lbDogJWQuXG4iLCByZXQpOworCX0KKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwg
ImRybSBkaXNhYmxlXG4iKTsKKwltdXRleF9sb2NrKCZjdHgtPmxvY2spOworCisJYW54NzYyNV9k
cF9zdG9wKGN0eCk7CisKKwlhbng3NjI1X2xvd19wb3dlcl9tb2RlX2NoZWNrKGN0eCwgMCk7CisK
KwltdXRleF91bmxvY2soJmN0eC0+bG9jayk7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJt
X2JyaWRnZV9mdW5jcyBhbng3NjI1X2JyaWRnZV9mdW5jcyA9IHsKKwkuYXR0YWNoID0gYW54NzYy
NV9icmlkZ2VfYXR0YWNoLAorCS5kZXRhY2ggPSBhbng3NjI1X2JyaWRnZV9kZXRhY2gsCisJLmRp
c2FibGUgPSBhbng3NjI1X2JyaWRnZV9kaXNhYmxlLAorCS5wb3N0X2Rpc2FibGUgPSBhbng3NjI1
X3Bvc3RfZGlzYWJsZSwKKwkucHJlX2VuYWJsZSA9IGFueDc2MjVfcHJlX2VuYWJsZSwKKwkubW9k
ZV92YWxpZCA9IGFueDc2MjVfYnJpZGdlX21vZGVfdmFsaWQsCisJLm1vZGVfc2V0ID0gYW54NzYy
NV9icmlkZ2VfbW9kZV9zZXQsCisJLmVuYWJsZSA9IGFueDc2MjVfYnJpZGdlX2VuYWJsZSwKK307
CisKK3N0YXRpYyBpbnQgYW54NzYyNV9yZWdpc3Rlcl9pMmNfZHVtbXlfY2xpZW50cyhzdHJ1Y3Qg
YW54NzYyNV9kYXRhICpjdHgsCisJCQkJCSAgICAgIHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQp
Cit7CisJY3R4LT5pMmMudHhfcDBfY2xpZW50ID0gaTJjX25ld19kdW1teShjbGllbnQtPmFkYXB0
ZXIsCisJCQkJCSAgICAgIFRYX1AwX0FERFIgPj4gMSk7CisJaWYgKCFjdHgtPmkyYy50eF9wMF9j
bGllbnQpCisJCXJldHVybiAtRU5PTUVNOworCisJY3R4LT5pMmMudHhfcDFfY2xpZW50ID0gaTJj
X25ld19kdW1teShjbGllbnQtPmFkYXB0ZXIsCisJCQkJCSAgICAgIFRYX1AxX0FERFIgPj4gMSk7
CisJaWYgKCFjdHgtPmkyYy50eF9wMV9jbGllbnQpCisJCWdvdG8gZnJlZV90eF9wMDsKKworCWN0
eC0+aTJjLnR4X3AyX2NsaWVudCA9IGkyY19uZXdfZHVtbXkoY2xpZW50LT5hZGFwdGVyLAorCQkJ
CQkgICAgICBUWF9QMl9BRERSID4+IDEpOworCWlmICghY3R4LT5pMmMudHhfcDJfY2xpZW50KQor
CQlnb3RvIGZyZWVfdHhfcDE7CisKKwljdHgtPmkyYy5yeF9wMF9jbGllbnQgPSBpMmNfbmV3X2R1
bW15KGNsaWVudC0+YWRhcHRlciwKKwkJCQkJICAgICAgUlhfUDBfQUREUiA+PiAxKTsKKwlpZiAo
IWN0eC0+aTJjLnJ4X3AwX2NsaWVudCkKKwkJZ290byBmcmVlX3R4X3AyOworCisJY3R4LT5pMmMu
cnhfcDFfY2xpZW50ID0gaTJjX25ld19kdW1teShjbGllbnQtPmFkYXB0ZXIsCisJCQkJCSAgICAg
IFJYX1AxX0FERFIgPj4gMSk7CisJaWYgKCFjdHgtPmkyYy5yeF9wMV9jbGllbnQpCisJCWdvdG8g
ZnJlZV9yeF9wMDsKKworCWN0eC0+aTJjLnJ4X3AyX2NsaWVudCA9IGkyY19uZXdfZHVtbXkoY2xp
ZW50LT5hZGFwdGVyLAorCQkJCQkgICAgICBSWF9QMl9BRERSID4+IDEpOworCWlmICghY3R4LT5p
MmMucnhfcDJfY2xpZW50KQorCQlnb3RvIGZyZWVfcnhfcDE7CisKKwljdHgtPmkyYy50Y3BjX2Ns
aWVudCA9IGkyY19uZXdfZHVtbXkoY2xpZW50LT5hZGFwdGVyLAorCQkJCQkgICAgIFRDUENfSU5U
RVJGQUNFX0FERFIgPj4gMSk7CisJaWYgKCFjdHgtPmkyYy50Y3BjX2NsaWVudCkKKwkJZ290byBm
cmVlX3J4X3AyOworCisJcmV0dXJuIDA7CisKK2ZyZWVfcnhfcDI6CisJaTJjX3VucmVnaXN0ZXJf
ZGV2aWNlKGN0eC0+aTJjLnJ4X3AyX2NsaWVudCk7CitmcmVlX3J4X3AxOgorCWkyY191bnJlZ2lz
dGVyX2RldmljZShjdHgtPmkyYy5yeF9wMV9jbGllbnQpOworZnJlZV9yeF9wMDoKKwlpMmNfdW5y
ZWdpc3Rlcl9kZXZpY2UoY3R4LT5pMmMucnhfcDBfY2xpZW50KTsKK2ZyZWVfdHhfcDI6CisJaTJj
X3VucmVnaXN0ZXJfZGV2aWNlKGN0eC0+aTJjLnR4X3AyX2NsaWVudCk7CitmcmVlX3R4X3AxOgor
CWkyY191bnJlZ2lzdGVyX2RldmljZShjdHgtPmkyYy50eF9wMV9jbGllbnQpOworZnJlZV90eF9w
MDoKKwlpMmNfdW5yZWdpc3Rlcl9kZXZpY2UoY3R4LT5pMmMudHhfcDBfY2xpZW50KTsKKworCXJl
dHVybiAtRU5PTUVNOworfQorCitzdGF0aWMgdm9pZCBhbng3NjI1X3VucmVnaXN0ZXJfaTJjX2R1
bW15X2NsaWVudHMoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCWkyY191bnJlZ2lzdGVy
X2RldmljZShjdHgtPmkyYy50eF9wMF9jbGllbnQpOworCWkyY191bnJlZ2lzdGVyX2RldmljZShj
dHgtPmkyYy50eF9wMV9jbGllbnQpOworCWkyY191bnJlZ2lzdGVyX2RldmljZShjdHgtPmkyYy50
eF9wMl9jbGllbnQpOworCWkyY191bnJlZ2lzdGVyX2RldmljZShjdHgtPmkyYy5yeF9wMF9jbGll
bnQpOworCWkyY191bnJlZ2lzdGVyX2RldmljZShjdHgtPmkyYy5yeF9wMV9jbGllbnQpOworCWky
Y191bnJlZ2lzdGVyX2RldmljZShjdHgtPmkyYy5yeF9wMl9jbGllbnQpOworCWkyY191bnJlZ2lz
dGVyX2RldmljZShjdHgtPmkyYy50Y3BjX2NsaWVudCk7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYy
NV9pMmNfcHJvYmUoc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCwKKwkJCSAgICAgY29uc3Qgc3Ry
dWN0IGkyY19kZXZpY2VfaWQgKmlkKQoreworCXN0cnVjdCBhbng3NjI1X2RhdGEgKnBsYXRmb3Jt
OworCXN0cnVjdCBhbng3NjI1X3BsYXRmb3JtX2RhdGEgKnBkYXRhOworCWludCByZXQgPSAwOwor
CXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjbGllbnQtPmRldjsKKworCWlmICghaTJjX2NoZWNrX2Z1
bmN0aW9uYWxpdHkoY2xpZW50LT5hZGFwdGVyLAorCQkJCSAgICAgSTJDX0ZVTkNfU01CVVNfSTJD
X0JMT0NLKSkgeworCQlEUk1fREVWX0VSUk9SKGRldiwgImFueDc2MjUncyBpMmMgYnVzIGRvZXNu
J3Qgc3VwcG9ydFxuIik7CisJCXJldHVybiAtRU5PREVWOworCX0KKworCXBsYXRmb3JtID0ga3ph
bGxvYyhzaXplb2YoKnBsYXRmb3JtKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFwbGF0Zm9ybSkgewor
CQlEUk1fREVWX0VSUk9SKGRldiwgImZhaWxlZCB0byBhbGxvY2F0ZSBkcml2ZXIgZGF0YVxuIik7
CisJCXJldHVybiAtRU5PTUVNOworCX0KKworCXBkYXRhID0gJnBsYXRmb3JtLT5wZGF0YTsKKwor
CXJldCA9IGFueDc2MjVfcGFyc2VfZHQoZGV2LCBwZGF0YSk7CisJaWYgKHJldCkgeworCQlEUk1f
REVWX0VSUk9SKGRldiwgImZhaWxlZCB0byBwYXJzZSBkZXZpY2V0cmVlLlxuIik7CisJCWdvdG8g
ZnJlZV9wbGF0Zm9ybTsKKwl9CisKKwlhbng3NjI1X2luaXRfZ3BpbyhwbGF0Zm9ybSk7CisKKwkv
KiB0byBhY2Nlc3MgZ2xvYmFsIHBsYXRmb3JtIGRhdGEgKi8KKwlwbGF0Zm9ybS0+Y2xpZW50ID0g
Y2xpZW50OworCWkyY19zZXRfY2xpZW50ZGF0YShjbGllbnQsIHBsYXRmb3JtKTsKKworCWlmIChw
bGF0Zm9ybS0+cGRhdGEuZXh0Y29uX3N1cHBvcnRlZCkgeworCQkvKiBnZXQgZXh0Y29uIGRldmlj
ZSBmcm9tIERUUyAqLworCQlyZXQgPSAtRUlOVkFMOworCQlwbGF0Zm9ybS0+ZXh0Y29uID0gZXh0
Y29uX2dldF9lZGV2X2J5X3BoYW5kbGUoZGV2LCAwKTsKKwkJaWYgKFBUUl9FUlIocGxhdGZvcm0t
PmV4dGNvbikgPT0gLUVQUk9CRV9ERUZFUikKKwkJCWdvdG8gZnJlZV9wbGF0Zm9ybTsKKworCQlp
ZiAoSVNfRVJSKHBsYXRmb3JtLT5leHRjb24pKSB7CisJCQlEUk1fREVWX0VSUk9SKGRldiwKKwkJ
CQkgICAgICAiY2FuIG5vdCBnZXQgZXh0Y29uIGRldmljZSEiKTsKKwkJCWdvdG8gZnJlZV9wbGF0
Zm9ybTsKKwkJfQorCisJCXJldCA9IGFueDc2MjVfZXh0Y29uX25vdGlmaWVyX2luaXQocGxhdGZv
cm0pOworCQlpZiAocmV0KQorCQkJZ290byBmcmVlX3BsYXRmb3JtOworCX0KKworCWF0b21pY19z
ZXQoJnBsYXRmb3JtLT5wb3dlcl9zdGF0dXMsIDApOworCisJbXV0ZXhfaW5pdCgmcGxhdGZvcm0t
PmxvY2spOworCisJcGxhdGZvcm0tPnBkYXRhLmludHBfaXJxID0gY2xpZW50LT5pcnE7CisJaWYg
KHBsYXRmb3JtLT5wZGF0YS5pbnRwX2lycSkgeworCQlJTklUX1dPUksoJnBsYXRmb3JtLT53b3Jr
LCBhbng3NjI1X3dvcmtfZnVuYyk7CisJCXBsYXRmb3JtLT53b3JrcXVldWUgPSBjcmVhdGVfd29y
a3F1ZXVlKCJhbng3NjI1X3dvcmsiKTsKKwkJaWYgKCFwbGF0Zm9ybS0+d29ya3F1ZXVlKSB7CisJ
CQlEUk1fREVWX0VSUk9SKGRldiwgImZhaWxlZCB0byBjcmVhdGUgd29yayBxdWV1ZVxuIik7CisJ
CQlyZXQgPSAtRU5PTUVNOworCQkJZ290byBmcmVlX3BsYXRmb3JtOworCQl9CisKKwkJcmV0ID0g
ZGV2bV9yZXF1ZXN0X3RocmVhZGVkX2lycShkZXYsIHBsYXRmb3JtLT5wZGF0YS5pbnRwX2lycSwK
KwkJCQkJCU5VTEwsIGFueDc2MjVfaW50cl9ocGRfaXNyLAorCQkJCQkJSVJRRl9UUklHR0VSX0ZB
TExJTkcgfAorCQkJCQkJSVJRRl9PTkVTSE9ULAorCQkJCQkJImFueDc2MjUtaW50cCIsIHBsYXRm
b3JtKTsKKwkJaWYgKHJldCkgeworCQkJRFJNX0RFVl9FUlJPUihkZXYsICJmYWlsZWQgdG8gcmVx
dWVzdCBpcnFcbiIpOworCQkJZ290byBmcmVlX3dxOworCQl9CisJfQorCisJaWYgKGFueDc2MjVf
cmVnaXN0ZXJfaTJjX2R1bW15X2NsaWVudHMocGxhdGZvcm0sIGNsaWVudCkgIT0gMCkgeworCQly
ZXQgPSAtRU5PTUVNOworCQlEUk1fRVJST1IoIkZhaWxlZCB0byByZXNlcnZlIEkyQyBidXMuXG4i
KTsKKwkJZ290byBmcmVlX3dxOworCX0KKworCWlmIChwbGF0Zm9ybS0+cGRhdGEubG93X3Bvd2Vy
X21vZGUgPT0gMCkgeworCQlhbng3NjI1X2Rpc2FibGVfcGRfcHJvdG9jb2wocGxhdGZvcm0pOwor
CQlhdG9taWNfc2V0KCZwbGF0Zm9ybS0+cG93ZXJfc3RhdHVzLCAxKTsKKwl9CisKKwkvKiBhZGQg
d29yayBmdW5jdGlvbiAqLworCWlmIChwbGF0Zm9ybS0+cGRhdGEuaW50cF9pcnEpCisJCXF1ZXVl
X3dvcmsocGxhdGZvcm0tPndvcmtxdWV1ZSwgJnBsYXRmb3JtLT53b3JrKTsKKworCXBsYXRmb3Jt
LT5icmlkZ2UuZnVuY3MgPSAmYW54NzYyNV9icmlkZ2VfZnVuY3M7CisJaWYgKElTX0VOQUJMRUQo
Q09ORklHX09GKSkKKwkJcGxhdGZvcm0tPmJyaWRnZS5vZl9ub2RlID0gY2xpZW50LT5kZXYub2Zf
bm9kZTsKKwlkcm1fYnJpZGdlX2FkZCgmcGxhdGZvcm0tPmJyaWRnZSk7CisKKwlEUk1fREVWX0RF
QlVHX0RSSVZFUihkZXYsICJwcm9iZSBkb25lXG4iKTsKKworCXJldHVybiAwOworCitmcmVlX3dx
OgorCWlmIChwbGF0Zm9ybS0+d29ya3F1ZXVlKQorCQlkZXN0cm95X3dvcmtxdWV1ZShwbGF0Zm9y
bS0+d29ya3F1ZXVlKTsKKworZnJlZV9wbGF0Zm9ybToKKwlrZnJlZShwbGF0Zm9ybSk7CisKKwly
ZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IGFueDc2MjVfaTJjX3JlbW92ZShzdHJ1Y3QgaTJj
X2NsaWVudCAqY2xpZW50KQoreworCXN0cnVjdCBhbng3NjI1X2RhdGEgKnBsYXRmb3JtID0gaTJj
X2dldF9jbGllbnRkYXRhKGNsaWVudCk7CisKKwlkcm1fYnJpZGdlX3JlbW92ZSgmcGxhdGZvcm0t
PmJyaWRnZSk7CisKKwlpZiAocGxhdGZvcm0tPnBkYXRhLmludHBfaXJxKQorCQlkZXN0cm95X3dv
cmtxdWV1ZShwbGF0Zm9ybS0+d29ya3F1ZXVlKTsKKworCWlmIChwbGF0Zm9ybS0+cGRhdGEuZXh0
Y29uX3N1cHBvcnRlZCkgeworCQlkZXZtX2V4dGNvbl91bnJlZ2lzdGVyX25vdGlmaWVyKCZwbGF0
Zm9ybS0+Y2xpZW50LT5kZXYsCisJCQkJCQlwbGF0Zm9ybS0+ZXh0Y29uLAorCQkJCQkJRVhUQ09O
X0RJU1BfRFAsCisJCQkJCQkmcGxhdGZvcm0tPmV2ZW50X25iKTsKKwkJZmx1c2hfd29yaygmcGxh
dGZvcm0tPmV4dGNvbl93cSk7CisJfQorCisJYW54NzYyNV91bnJlZ2lzdGVyX2kyY19kdW1teV9j
bGllbnRzKHBsYXRmb3JtKTsKKworCWtmcmVlKHBsYXRmb3JtKTsKKwlyZXR1cm4gMDsKK30KKwor
c3RhdGljIGNvbnN0IHN0cnVjdCBpMmNfZGV2aWNlX2lkIGFueDc2MjVfaWRbXSA9IHsKKwl7ImFu
eDc2MjUiLCAwfSwKKwl7fQorfTsKKworTU9EVUxFX0RFVklDRV9UQUJMRShpMmMsIGFueDc2MjVf
aWQpOworCisjaWZkZWYgQ09ORklHX09GCitzdGF0aWMgY29uc3Qgc3RydWN0IG9mX2RldmljZV9p
ZCBhbnhfbWF0Y2hfdGFibGVbXSA9IHsKKwl7LmNvbXBhdGlibGUgPSAiYW5hbG9naXgsYW54NzYy
NSIsfSwKKwl7fSwKK307CisjZW5kaWYKKworc3RhdGljIHN0cnVjdCBpMmNfZHJpdmVyIGFueDc2
MjVfZHJpdmVyID0geworCS5kcml2ZXIgPSB7CisJCS5uYW1lID0gImFueDc2MjUiLAorI2lmZGVm
IENPTkZJR19PRgorCQkub2ZfbWF0Y2hfdGFibGUgPSBhbnhfbWF0Y2hfdGFibGUsCisjZW5kaWYK
Kwl9LAorCS5wcm9iZSA9IGFueDc2MjVfaTJjX3Byb2JlLAorCS5yZW1vdmUgPSBhbng3NjI1X2ky
Y19yZW1vdmUsCisKKwkuaWRfdGFibGUgPSBhbng3NjI1X2lkLAorfTsKKworbW9kdWxlX2kyY19k
cml2ZXIoYW54NzYyNV9kcml2ZXIpOworCitNT0RVTEVfREVTQ1JJUFRJT04oIk1JUEkyRFAgYW54
NzYyNSBkcml2ZXIiKTsKK01PRFVMRV9BVVRIT1IoIlhpbiBKaSA8eGppQGFuYWxvZ2l4c2VtaS5j
b20+Iik7CitNT0RVTEVfTElDRU5TRSgiR1BMIHYyIik7CitNT0RVTEVfVkVSU0lPTihBTlg3NjI1
X0RSVl9WRVJTSU9OKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9n
aXgvYW54NzYyNS5oIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9hbng3NjI1LmgK
bmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uYzg3MWE2YwotLS0gL2Rldi9udWxs
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvYW54NzYyNS5oCkBAIC0wLDAg
KzEsNDA2IEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5ICovCisv
KgorICogQ29weXJpZ2h0KGMpIDIwMTYsIEFuYWxvZ2l4IFNlbWljb25kdWN0b3IuIEFsbCByaWdo
dHMgcmVzZXJ2ZWQuCisgKgorICovCisKKyNpZm5kZWYgX19BTlg3NjI1X0hfXworI2RlZmluZSBf
X0FOWDc2MjVfSF9fCisKKyNpZm5kZWYgTE9HX1RBRworI2RlZmluZSBMT0dfVEFHICJhbng3NjI1
ZHAiCisjZW5kaWYKKworI2RlZmluZSBBTlg3NjI1X0RSVl9WRVJTSU9OICIwLjEuMDQiCisKKy8q
IExvYWRpbmcgT0NNIHJlLXRyeWluZyB0aW1lcyAqLworI2RlZmluZSBPQ01fTE9BRElOR19USU1F
IDEwCisKKy8qKioqKioqKiogIEFOWDc2MjUgUmVnaXN0ZXIgICoqKioqKioqKiovCisjZGVmaW5l
IFRYX1AwX0FERFIJCQkJMHg3MAorI2RlZmluZSBUWF9QMV9BRERSCQkJCTB4N0EKKyNkZWZpbmUg
VFhfUDJfQUREUgkJCQkweDcyCisKKyNkZWZpbmUgUlhfUDBfQUREUgkJCQkweDdlCisjZGVmaW5l
IFJYX1AxX0FERFIJCQkJMHg4NAorI2RlZmluZSBSWF9QMl9BRERSCQkJCTB4NTQKKworI2RlZmlu
ZSBSU1ZEXzAwX0FERFIJCQkJMHgwMAorI2RlZmluZSBSU1ZEX0QxX0FERFIJCQkJMHhEMQorI2Rl
ZmluZSBSU1ZEXzYwX0FERFIJCQkJMHg2MAorI2RlZmluZSBSU1ZEXzM5X0FERFIJCQkJMHgzOQor
I2RlZmluZSBSU1ZEXzdGX0FERFIJCQkJMHg3RgorCisjZGVmaW5lIFRDUENfSU5URVJGQUNFX0FE
RFIJCQkweDU4CisKKy8qIGFueDc2MjUgY2xvY2sgZnJlcXVlbmN5IGluIEh6ICovCisjZGVmaW5l
IFhUQUxfRlJRICAgICAgICAoMjcgKiAxMDAwMDAwKQorCisjZGVmaW5lICBQT1NUX0RJVklERVJf
TUlOCTEKKyNkZWZpbmUgIFBPU1RfRElWSURFUl9NQVgJMTYKKyNkZWZpbmUgIFBMTF9PVVRfRlJF
UV9NSU4JNTIwMDAwMDAwVUwKKyNkZWZpbmUgIFBMTF9PVVRfRlJFUV9NQVgJNzMwMDAwMDAwVUwK
KyNkZWZpbmUgIFBMTF9PVVRfRlJFUV9BQlNfTUlOCTMwMDAwMDAwMFVMCisjZGVmaW5lICBQTExf
T1VUX0ZSRVFfQUJTX01BWAk4MDAwMDAwMDBVTAorI2RlZmluZSAgTUFYX1VOU0lHTkVEXzI0QklU
CTE2Nzc3MjE1VUwKKworLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKi8KKy8qIFJlZ2lzdGVyIGRlZmluaXRpb24gb2YgZGV2aWNl
IGFkZHJlc3MgMHg1OCAqLworCisjZGVmaW5lIFBST0RVQ1RfSURfTCAweDAyCisjZGVmaW5lIFBS
T0RVQ1RfSURfSCAweDAzCisKKyNkZWZpbmUgSU5UUl9BTEVSVF8xICAweENDCisjZGVmaW5lIElO
VFJfU09GVFdBUkVfSU5UIEJJVCgzKQorI2RlZmluZSBJTlRSX1JFQ0VJVkVEX01TRyBCSVQoNSkK
KworI2RlZmluZSBTWVNURU1fU1RTVFVTIDB4NDUKKyNkZWZpbmUgSU5URVJGQUNFX0NIQU5HRV9J
TlQgMHg0NAorI2RlZmluZSBIUERfU1RBVFVTX0NIQU5HRSAweDgwCisjZGVmaW5lIEhQRF9TVEFU
VVMgMHg4MAorCisvKioqKioqKiogRU5EIG9mIEkyQyBBZGRyZXNzIDB4NTggKioqKioqKiovCisK
Ky8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKiovCisvKiBSZWdpc3RlciBkZWZpbml0aW9uIG9mIGRldmljZSBhZGRyZXNzIDB4NzAg
Ki8KKyNkZWZpbmUgIEkyQ19BRERSXzcwX0RQVFggICAgICAgICAgICAgIDB4NzAKKworI2RlZmlu
ZSBTUF9UWF9MSU5LX0JXX1NFVF9SRUcgMHhBMAorI2RlZmluZSBTUF9UWF9MQU5FX0NPVU5UX1NF
VF9SRUcgMHhBMQorCisjZGVmaW5lIE1fVklEXzAgMHhDMAorI2RlZmluZSBNX1ZJRF8xIDB4QzEK
KyNkZWZpbmUgTV9WSURfMiAweEMyCisjZGVmaW5lIE5fVklEXzAgMHhDMworI2RlZmluZSBOX1ZJ
RF8xIDB4QzQKKyNkZWZpbmUgTl9WSURfMiAweEM1CisKKy8qKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCisvKiBSZWdpc3RlciBk
ZWZpbml0aW9uIG9mIGRldmljZSBhZGRyZXNzIDB4NzIgKi8KKyNkZWZpbmUgQVVYX1JTVAkweDA0
CisjZGVmaW5lIFJTVF9DVFJMMiAweDA3CisKKyNkZWZpbmUgU1BfVFhfVE9UQUxfTElORV9TVEFf
TCAweDI0CisjZGVmaW5lIFNQX1RYX1RPVEFMX0xJTkVfU1RBX0ggMHgyNQorI2RlZmluZSBTUF9U
WF9BQ1RfTElORV9TVEFfTCAweDI2CisjZGVmaW5lIFNQX1RYX0FDVF9MSU5FX1NUQV9IIDB4MjcK
KyNkZWZpbmUgU1BfVFhfVl9GX1BPUkNIX1NUQSAweDI4CisjZGVmaW5lIFNQX1RYX1ZfU1lOQ19T
VEEgMHgyOQorI2RlZmluZSBTUF9UWF9WX0JfUE9SQ0hfU1RBIDB4MkEKKyNkZWZpbmUgU1BfVFhf
VE9UQUxfUElYRUxfU1RBX0wgMHgyQgorI2RlZmluZSBTUF9UWF9UT1RBTF9QSVhFTF9TVEFfSCAw
eDJDCisjZGVmaW5lIFNQX1RYX0FDVF9QSVhFTF9TVEFfTCAweDJECisjZGVmaW5lIFNQX1RYX0FD
VF9QSVhFTF9TVEFfSCAweDJFCisjZGVmaW5lIFNQX1RYX0hfRl9QT1JDSF9TVEFfTCAweDJGCisj
ZGVmaW5lIFNQX1RYX0hfRl9QT1JDSF9TVEFfSCAweDMwCisjZGVmaW5lIFNQX1RYX0hfU1lOQ19T
VEFfTCAweDMxCisjZGVmaW5lIFNQX1RYX0hfU1lOQ19TVEFfSCAweDMyCisjZGVmaW5lIFNQX1RY
X0hfQl9QT1JDSF9TVEFfTCAweDMzCisjZGVmaW5lIFNQX1RYX0hfQl9QT1JDSF9TVEFfSCAweDM0
CisKKyNkZWZpbmUgU1BfVFhfVklEX0NUUkwgMHg4NAorI2RlZmluZSBTUF9UWF9CUENfTUFTSyAw
eEUwCisjZGVmaW5lIFNQX1RYX0JQQ182ICAgIDB4MDAKKyNkZWZpbmUgU1BfVFhfQlBDXzggICAg
MHgyMAorI2RlZmluZSBTUF9UWF9CUENfMTAgICAweDQwCisjZGVmaW5lIFNQX1RYX0JQQ18xMiAg
IDB4NjAKKworI2RlZmluZSBWSURFT19CSVRfTUFUUklYXzEyIDB4NGMKKworI2RlZmluZSBBVURJ
T19DSEFOTkVMX1NUQVRVU18xIDB4ZDAKKyNkZWZpbmUgQVVESU9fQ0hBTk5FTF9TVEFUVVNfMiAw
eGQxCisjZGVmaW5lIEFVRElPX0NIQU5ORUxfU1RBVFVTXzMgMHhkMgorI2RlZmluZSBBVURJT19D
SEFOTkVMX1NUQVRVU180IDB4ZDMKKyNkZWZpbmUgQVVESU9fQ0hBTk5FTF9TVEFUVVNfNSAweGQ0
CisjZGVmaW5lIEFVRElPX0NIQU5ORUxfU1RBVFVTXzYgMHhkNQorI2RlZmluZSBURE1fU0xBVkVf
TU9ERSAweDEwCisjZGVmaW5lIEkyU19TTEFWRV9NT0RFIDB4MDgKKworI2RlZmluZSBBVURJT19D
T05UUk9MX1JFR0lTVEVSIDB4ZTYKKyNkZWZpbmUgVERNX1RJTUlOR19NT0RFIDB4MDgKKworI2Rl
ZmluZSAgSTJDX0FERFJfNzJfRFBUWCAgICAgICAgICAgICAgMHg3MgorCisjZGVmaW5lICBWSURF
T19DT05UUk9MXzAgIDB4MDgKKworI2RlZmluZSAgQUNUSVZFX0xJTkVTX0wgICAgICAgICAweDE0
CisjZGVmaW5lICBBQ1RJVkVfTElORVNfSCAgICAgICAgIDB4MTUgIC8qIG5vdGU6IGJpdFs3OjZd
IGFyZSByZXNlcnZlZCAqLworI2RlZmluZSAgVkVSVElDQUxfRlJPTlRfUE9SQ0ggICAweDE2Cisj
ZGVmaW5lICBWRVJUSUNBTF9TWU5DX1dJRFRIICAgIDB4MTcKKyNkZWZpbmUgIFZFUlRJQ0FMX0JB
Q0tfUE9SQ0ggICAgMHgxOAorCisjZGVmaW5lICBIT1JJWk9OVEFMX1RPVEFMX1BJWEVMU19MICAg
IDB4MTkKKyNkZWZpbmUgIEhPUklaT05UQUxfVE9UQUxfUElYRUxTX0ggICAgMHgxQSAgLyogbm90
ZTogYml0Wzc6Nl0gYXJlIHJlc2VydmVkICovCisjZGVmaW5lICBIT1JJWk9OVEFMX0FDVElWRV9Q
SVhFTFNfTCAgIDB4MUIKKyNkZWZpbmUgIEhPUklaT05UQUxfQUNUSVZFX1BJWEVMU19IICAgMHgx
QyAgLyogbm90ZTogYml0Wzc6Nl0gYXJlIHJlc2VydmVkICovCisjZGVmaW5lICBIT1JJWk9OVEFM
X0ZST05UX1BPUkNIX0wgICAgIDB4MUQKKyNkZWZpbmUgIEhPUklaT05UQUxfRlJPTlRfUE9SQ0hf
SCAgICAgMHgxRSAgLyogbm90ZTogYml0Wzc6NF0gYXJlIHJlc2VydmVkICovCisjZGVmaW5lICBI
T1JJWk9OVEFMX1NZTkNfV0lEVEhfTCAgICAgIDB4MUYKKyNkZWZpbmUgIEhPUklaT05UQUxfU1lO
Q19XSURUSF9IICAgICAgMHgyMCAgLyogbm90ZTogYml0Wzc6NF0gYXJlIHJlc2VydmVkICovCisj
ZGVmaW5lICBIT1JJWk9OVEFMX0JBQ0tfUE9SQ0hfTCAgICAgIDB4MjEKKyNkZWZpbmUgIEhPUkla
T05UQUxfQkFDS19QT1JDSF9IICAgICAgMHgyMiAgLyogbm90ZTogYml0Wzc6NF0gYXJlIHJlc2Vy
dmVkICovCisKKy8qKioqKioqKiBFTkQgb2YgSTJDIEFkZHJlc3MgMHg3MiAqKioqKioqKiovCisv
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqLworLyogUmVnaXN0ZXIgZGVmaW5pdGlvbiBvZiBkZXZpY2UgYWRkcmVzcyAweDdlICov
CisKKyNkZWZpbmUgIEkyQ19BRERSXzdFX0ZMQVNIX0NPTlRST0xMRVIgIDB4N0UKKworI2RlZmlu
ZSBGTEFTSF9MT0FEX1NUQSAweDA1CisjZGVmaW5lIEZMQVNIX0xPQURfU1RBX0NISwlCSVQoNykK
KworI2RlZmluZSAgWFRBTF9GUlFfU0VMICAgIDB4M0YKKy8qIGJpdCBmaWVsZCBwb3NpdGlvbnMg
Ki8KKyNkZWZpbmUgIFhUQUxfRlJRX1NFTF9QT1MgICAgNQorLyogYml0IGZpZWxkIHZhbHVlcyAq
LworI2RlZmluZSAgWFRBTF9GUlFfMTlNMiAgICgwIDw8IFhUQUxfRlJRX1NFTF9QT1MpCisjZGVm
aW5lICBYVEFMX0ZSUV8yN00gICAgKDQgPDwgWFRBTF9GUlFfU0VMX1BPUykKKworI2RlZmluZSAg
Ul9EU0NfQ1RSTF8wICAgIDB4NDAKKyNkZWZpbmUgIFJFQURfU1RBVFVTX0VOICA3CisjZGVmaW5l
ICBDTEtfMU1FR19SQiAgICAgNiAgLyogMU1IeiBjbG9jayByZXNldDsgMD1yZXNldCwgMD1yZXNl
dCByZWxlYXNlICovCisjZGVmaW5lICBEU0NfQklTVF9ET05FICAgMSAgLyogYml0WzU6MV06IDE9
RFNDIE1CSVNUIHBhc3MgKi8KKyNkZWZpbmUgIERTQ19FTiAgICAgICAgICAweDAxICAvKiAxPURT
QyBlbmFibGVkLCAwPURTQyBkaXNhYmxlZCAqLworCisjZGVmaW5lIE9DTV9GV19WRVJTSU9OICAg
MHgzMQorI2RlZmluZSBPQ01fRldfUkVWRVJTSU9OIDB4MzIKKworI2RlZmluZSBBUF9BVVhfQURE
Ul83XzAgICAweDExCisjZGVmaW5lIEFQX0FVWF9BRERSXzE1XzggIDB4MTIKKyNkZWZpbmUgQVBf
QVVYX0FERFJfMTlfMTYgMHgxMworCisvKiBub3RlOiBiaXRbMDozXSBBVVggc3RhdHVzLCBiaXQg
NCBvcF9lbiwgYml0IDUgYWRkcmVzcyBvbmx5ICovCisjZGVmaW5lIEFQX0FVWF9DVFJMX1NUQVRV
UyAweDE0CisjZGVmaW5lIEFQX0FVWF9DVFJMX09QX0VOIDB4MTAKKyNkZWZpbmUgQVBfQVVYX0NU
UkxfQUREUk9OTFkgMHgyMAorCisjZGVmaW5lIEFQX0FVWF9CVUZGX1NUQVJUIDB4MTUKKyNkZWZp
bmUgUElYRUxfQ0xPQ0tfTCAweDI1CisjZGVmaW5lIFBJWEVMX0NMT0NLX0ggMHgyNgorCisjZGVm
aW5lIEFQX0FVWF9DT01NQU5EIDB4MjcgIC8qIGNvbStsZW4gKi8KKy8qIGJpdCAwJjE6IDNEIHZp
ZGVvIHN0cnVjdHVyZSAqLworLyogMHgwMTogZnJhbWUgcGFja2luZywgIDB4MDI6TGluZSBhbHRl
cm5hdGl2ZSwgMHgwMzpTaWRlLWJ5LXNpZGUoZnVsbCkgKi8KKyNkZWZpbmUgQVBfQVZfU1RBVFVT
IDB4MjgKKyNkZWZpbmUgQVBfVklERU9fQ0hHICBCSVQoMikKKyNkZWZpbmUgQVBfQVVESU9fQ0hH
ICBCSVQoMykKKyNkZWZpbmUgQVBfTUlQSV9NVVRFICBCSVQoNCkgLyogMTpNSVBJIGlucHV0IG11
dGUsIDA6IHVtbXV0ZSAqLworI2RlZmluZSBBUF9NSVBJX1JYX0VOIEJJVCg1KSAvKiAxOiBNSVBJ
IFJYIGlucHV0IGluICAwOiBubyBSWCBpbiAqLworI2RlZmluZSBBUF9ESVNBQkxFX1BEIEJJVCg2
KQorI2RlZmluZSBBUF9ESVNBQkxFX0RJU1BMQVkgQklUKDcpCisvKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLworLyogUmVnaXN0
ZXIgZGVmaW5pdGlvbiBvZiBkZXZpY2UgYWRkcmVzcyAweDg0ICovCisjZGVmaW5lICBNSVBJX1BI
WV9DT05UUk9MXzMgICAgICAgICAgICAweDAzCisjZGVmaW5lICBNSVBJX0hTX1BXRF9DTEsgICAg
ICAgICAgICAgICA3CisjZGVmaW5lICBNSVBJX0hTX1JUX0NMSyAgICAgICAgICAgICAgICA2Cisj
ZGVmaW5lICBNSVBJX1BEX0NMSyAgICAgICAgICAgICAgICAgICA1CisjZGVmaW5lICBNSVBJX0NM
S19SVF9NQU5VQUxfUERfRU4gICAgICA0CisjZGVmaW5lICBNSVBJX0NMS19IU19NQU5VQUxfUERf
RU4gICAgICAzCisjZGVmaW5lICBNSVBJX0NMS19ERVRfREVUX0JZUEFTUyAgICAgICAyCisjZGVm
aW5lICBNSVBJX0NMS19NSVNTX0NUUkwgICAgICAgICAgICAxCisjZGVmaW5lICBNSVBJX1BEX0xQ
VFhfQ0hfTUFOVUFMX1BEX0VOICAwCisKKyNkZWZpbmUgIE1JUElfTEFORV9DVFJMXzAJCTB4MDUK
KyNkZWZpbmUgIE1JUElfVElNRV9IU19QUlBSCQkweDA4CisKKy8qIEFmdGVyIE1JUEkgUlggcHJv
dG9jb2wgbGF5ZXIgcmVjZWl2ZWQgdGhpcyBtYW55IHZpZGVvIGZyYW1lcywgKi8KKy8qIHByb3Rv
Y29sIGxheWVyIHN0YXJ0cyB0byByZWNvbnN0cnVjdCB2aWRlbyBzdHJlYW0gZnJvbSBQSFkgKi8K
KyNkZWZpbmUgIE1JUElfVklERU9fU1RBQkxFX0NOVCAgICAgICAgICAgMHgwQQorCisjZGVmaW5l
ICBNSVBJX0xBTkVfQ1RSTF8xMCAgICAgICAgICAgICAgIDB4MEYKKyNkZWZpbmUgIE1JUElfRElH
SVRBTF9BREpfMSAgIDB4MUIKKworI2RlZmluZSAgTUlQSV9QTExfTV9OVU1fMjNfMTYgICAweDFF
CisjZGVmaW5lICBNSVBJX1BMTF9NX05VTV8xNV84ICAgIDB4MUYKKyNkZWZpbmUgIE1JUElfUExM
X01fTlVNXzdfMCAgICAgMHgyMAorI2RlZmluZSAgTUlQSV9QTExfTl9OVU1fMjNfMTYgICAweDIx
CisjZGVmaW5lICBNSVBJX1BMTF9OX05VTV8xNV84ICAgIDB4MjIKKyNkZWZpbmUgIE1JUElfUExM
X05fTlVNXzdfMCAgICAgMHgyMworCisjZGVmaW5lICBNSVBJX0RJR0lUQUxfUExMXzYgICAgIDB4
MkEKKy8qIGJpdFs3OjZdOiBWQ08gYmFuZCBjb250cm9sLCBvbmx5IGVmZmVjdGl2ZSAqLworLyog
d2hlbiBNSVBJX1BMTF9GT1JDRV9CQU5EX0VOICgweDg0OjB4MkJbNl0pIGlzIDEgKi8KKyNkZWZp
bmUgIE1JUElfTV9OVU1fUkVBRFkgICAgICAgIDB4MTAKKyNkZWZpbmUgIE1JUElfTl9OVU1fUkVB
RFkgICAgICAgIDB4MDgKKyNkZWZpbmUgIFNUQUJMRV9JTlRFR0VSX0NOVF9FTiAgIDB4MDQKKyNk
ZWZpbmUgIE1JUElfUExMX1RFU1RfQklUICAgICAgIDAKKy8qIGJpdFsxOjBdOiB0ZXN0IHBvaW50
IG91dHB1dCBzZWxlY3QgLSAqLworLyogMDA6IFZDTyBwb3dlciwgMDE6IGR2ZGRfcGR0LCAxMDog
ZHZkZCwgMTE6IHZjb3ggKi8KKworI2RlZmluZSAgTUlQSV9ESUdJVEFMX1BMTF83ICAgICAgMHgy
QgorI2RlZmluZSAgTUlQSV9QTExfRk9SQ0VfTl9FTiAgICAgNworI2RlZmluZSAgTUlQSV9QTExf
Rk9SQ0VfQkFORF9FTiAgNgorCisjZGVmaW5lICBNSVBJX1BMTF9WQ09fVFVORV9SRUcgICA0Cisv
KiBiaXRbNTo0XTogVkNPIG1ldGFsIGNhcGFjaXRhbmNlIC0gKi8KKy8qIDAwOiArMjAlIGZhc3Qs
IDAxOiArMTAlIGZhc3QgKGRlZmF1bHQpLCAxMDogdHlwaWNhbCwgMTE6IC0xMCUgc2xvdyAqLwor
I2RlZmluZSAgTUlQSV9QTExfVkNPX1RVTkVfUkVHX1ZBTCAgIDB4MzAKKworI2RlZmluZSAgTUlQ
SV9QTExfUExMX0xET19CSVQgICAgMgorLyogYml0WzM6Ml06IHZjb192MmkgcG93ZXIgLSAqLwor
LyogMDA6IDEuNDBWLCAwMTogMS40NVYgKGRlZmF1bHQpLCAxMDogMS41MFYsIDExOiAxLjU1ViAq
LworI2RlZmluZSAgTUlQSV9QTExfUkVTRVRfTiAgICAgICAgMHgwMgorI2RlZmluZSAgTUlQSV9G
UlFfRk9SQ0VfTkRFVCAgICAgMAorCisjZGVmaW5lICBNSVBJX0FMRVJUX0NMUl8wICAgICAgICAw
eDJECisjZGVmaW5lICBIU19saW5rX2Vycm9yX2NsZWFyICAgICA3CisvKiBUaGlzIGJpdCBpdHNl
bGYgaXMgUy9DLCBhbmQgaXQgY2xlYXJzIDB4ODQ6MHgzMVs3XSAqLworCisjZGVmaW5lICBNSVBJ
X0FMRVJUX09VVF8wICAgICAgICAweDMxCisjZGVmaW5lICBjaGVja19zdW1fZXJyX2hzX3N5bmMg
ICA3CisvKiBUaGlzIGJpdCBpcyBjbGVhcmVkIGJ5IDB4ODQ6MHgyRFs3XSAqLworCisjZGVmaW5l
ICBNSVBJX0RJR0lUQUxfUExMXzggICAgMHgzMworI2RlZmluZSAgTUlQSV9QT1NUX0RJVl9WQUwg
ICAgIDQKKy8qIG4gbWVhbnMgZGl2aWRlZCBieSAobisxKSwgbiA9IDB+MTUgKi8KKyNkZWZpbmUg
IE1JUElfRU5fTE9DS19GUlogICAgICAzCisjZGVmaW5lICBNSVBJX0ZSUV9DT1VOVEVSX1JTVCAg
MgorI2RlZmluZSAgTUlQSV9GUlFfU0VUX1JFR184ICAgIDEKKy8qIGJpdCAwIGlzIHJlc2VydmVk
ICovCisKKyNkZWZpbmUgIE1JUElfRElHSVRBTF9QTExfOSAgICAweDM0CisKKyNkZWZpbmUgIE1J
UElfRElHSVRBTF9QTExfMTYgICAweDNCCisjZGVmaW5lICBNSVBJX0ZSUV9GUkVFWkVfTkRFVCAg
ICAgICAgICA3CisjZGVmaW5lICBNSVBJX0ZSUV9SRUdfU0VUX0VOQUJMRSAgICAgICA2CisjZGVm
aW5lICBNSVBJX1JFR19GT1JDRV9TRUxfRU4gICAgICAgICA1CisjZGVmaW5lICBNSVBJX1JFR19T
RUxfRElWX1JFRyAgICAgICAgICA0CisjZGVmaW5lICBNSVBJX1JFR19GT1JDRV9QUkVfRElWX0VO
ICAgICAzCisvKiBiaXQgMiBpcyByZXNlcnZlZCAqLworI2RlZmluZSAgTUlQSV9GUkVGX0RfSU5E
ICAgICAgICAgICAgICAgMQorI2RlZmluZSAgUkVGX0NMS18yNzAwMEtIWiAgICAxCisjZGVmaW5l
ICBSRUZfQ0xLXzE5MjAwS0haICAgIDAKKyNkZWZpbmUgIE1JUElfUkVHX1BMTF9QTExfVEVTVF9F
TkFCTEUgIDAKKworI2RlZmluZSAgTUlQSV9ESUdJVEFMX1BMTF8xOCAgMHgzRAorI2RlZmluZSAg
RlJRX0NPVU5UX1JCX1NFTCAgICAgICA3CisjZGVmaW5lICBSRUdfRk9SQ0VfUE9TVF9ESVZfRU4g
IDYKKyNkZWZpbmUgIE1JUElfRFBJX1NFTEVDVCAgICAgICAgNQorI2RlZmluZSAgU0VMRUNUX0RT
SSAgMQorI2RlZmluZSAgU0VMRUNUX0RQSSAgMAorI2RlZmluZSAgUkVHX0JBVURfRElWX1JBVElP
ICAgICAwCisKKyNkZWZpbmUgIEhfQkxBTktfTCAgICAgICAgICAgIDB4M0UKKy8qIGZvciBEU0Mg
b25seSAqLworI2RlZmluZSAgSF9CTEFOS19IICAgICAgICAgICAgMHgzRgorLyogZm9yIERTQyBv
bmx5OyBub3RlOiBiaXRbNzo2XSBhcmUgcmVzZXJ2ZWQgKi8KKyNkZWZpbmUgIE1JUElfU1dBUCAg
MHg0QQorI2RlZmluZSAgTUlQSV9TV0FQX0NIMCAgICA3CisjZGVmaW5lICBNSVBJX1NXQVBfQ0gx
ICAgIDYKKyNkZWZpbmUgIE1JUElfU1dBUF9DSDIgICAgNQorI2RlZmluZSAgTUlQSV9TV0FQX0NI
MyAgICA0CisjZGVmaW5lICBNSVBJX1NXQVBfQ0xLICAgIDMKKy8qIGJpdFsyOjBdIGFyZSByZXNl
cnZlZCAqLworCisvKioqKioqKiogRU5EIG9mIEkyQyBBZGRyZXNzIDB4ODQgKioqKioqKioqLwor
CisvKiBEUENEIHJlZ3MgKi8KKyNkZWZpbmUgRFBDRF9EUENEX1JFViAgICAgICAgICAgICAgICAg
IDB4MDAKKyNkZWZpbmUgRFBDRF9NQVhfTElOS19SQVRFICAgICAgICAgICAgIDB4MDEKKyNkZWZp
bmUgRFBDRF9NQVhfTEFORV9DT1VOVCAgICAgICAgICAgIDB4MDIKKworLyoqKioqKioqKiAgQU5Y
NzYyNSBSZWdpc3RlciBFbmQgICoqKioqKioqKiovCisKKy8qKioqKioqKioqKioqKioqKiAgRGlz
cGxheSAqKioqKioqKioqKioqKioqKi8KK2VudW0gYXVkaW9fZnMgeworCUFVRElPX0ZTXzQ0MUsg
ID0gMHgwMCwKKwlBVURJT19GU180OEsgICA9IDB4MDIsCisJQVVESU9fRlNfMzJLICAgPSAweDAz
LAorCUFVRElPX0ZTXzg4MksgID0gMHgwOCwKKwlBVURJT19GU185NksgICA9IDB4MGEsCisJQVVE
SU9fRlNfMTc2NEsgPSAweDBjLAorCUFVRElPX0ZTXzE5MksgID0gMHgwZQorfTsKKworZW51bSBh
dWRpb193ZF9sZW4geworCUFVRElPX1dfTEVOXzE2XzIwTUFYID0gMHgwMiwKKwlBVURJT19XX0xF
Tl8xOF8yME1BWCA9IDB4MDQsCisJQVVESU9fV19MRU5fMTdfMjBNQVggPSAweDBjLAorCUFVRElP
X1dfTEVOXzE5XzIwTUFYID0gMHgwOCwKKwlBVURJT19XX0xFTl8yMF8yME1BWCA9IDB4MGEsCisJ
QVVESU9fV19MRU5fMjBfMjRNQVggPSAweDAzLAorCUFVRElPX1dfTEVOXzIyXzI0TUFYID0gMHgw
NSwKKwlBVURJT19XX0xFTl8yMV8yNE1BWCA9IDB4MGQsCisJQVVESU9fV19MRU5fMjNfMjRNQVgg
PSAweDA5LAorCUFVRElPX1dfTEVOXzI0XzI0TUFYID0gMHgwYgorfTsKKworI2RlZmluZSBJMlNf
Q0hfMgkweDAxCisjZGVmaW5lIFRETV9DSF80CTB4MDMKKyNkZWZpbmUgVERNX0NIXzYJMHgwNQor
I2RlZmluZSBURE1fQ0hfOAkweDA3CisKKyNkZWZpbmUgTUFYX0RQQ0RfQlVGRkVSX1NJWkUJMTYK
KworI2RlZmluZSBPTkVfQkxPQ0tfU0laRSAgICAgIDEyOAorI2RlZmluZSBGT1VSX0JMT0NLX1NJ
WkUgICAgICgxMjggKiA0KQorCisjZGVmaW5lIE1BWF9FRElEX0JMT0NLCTMKKyNkZWZpbmUgRURJ
RF9UUllfQ05UCTMKKyNkZWZpbmUgU1VQUE9SVF9QSVhFTF9DTE9DSwkzMDAwMDAKKworc3RydWN0
IHNfZWRpZF9kYXRhIHsKKwlpbnQgZWRpZF9ibG9ja19udW07CisJdTggZWRpZF9yYXdfZGF0YVtG
T1VSX0JMT0NLX1NJWkVdOworfTsKKworLyoqKioqKioqKioqKioqKioqICBEaXNwbGF5IEVuZCAq
KioqKioqKioqKioqKioqKi8KKworc3RydWN0IGFueDc2MjVfZGV2aWNlX25vZGUgeworCXN0cnVj
dCBkZXZpY2Vfbm9kZSAqbWlwaV9kc2lfaG9zdF9ub2RlOworCXN0cnVjdCBkZXZpY2Vfbm9kZSAq
bWlwaV9kcGlfaG9zdF9ub2RlOworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqcGFuZWxfbm9kZTsKK307
CisKK3N0cnVjdCBhbng3NjI1X3BsYXRmb3JtX2RhdGEgeworCXN0cnVjdCBncGlvX2Rlc2MgKmdw
aW9fcF9vbjsKKwlzdHJ1Y3QgZ3Bpb19kZXNjICpncGlvX3Jlc2V0OworCXN0cnVjdCBkcm1fcGFu
ZWwgKnBhbmVsOworCWludCBpbnRwX2lycTsKKwl1MzIgcGFuZWxfZmxhZ3M7CisJdTMyIGxvd19w
b3dlcl9tb2RlOworCXUzMiBkc2lfc3VwcG9ydGVkOworCXUzMiBpbnRlcm5hbF9wYW5lbDsKKwl1
MzIgZXh0Y29uX3N1cHBvcnRlZDsKKwlzdHJ1Y3QgYW54NzYyNV9kZXZpY2Vfbm9kZSBub2RlOwor
fTsKKworc3RydWN0IGFueDc2MjVfaTJjX2NsaWVudCB7CisJc3RydWN0IGkyY19jbGllbnQgKnR4
X3AwX2NsaWVudDsKKwlzdHJ1Y3QgaTJjX2NsaWVudCAqdHhfcDFfY2xpZW50OworCXN0cnVjdCBp
MmNfY2xpZW50ICp0eF9wMl9jbGllbnQ7CisJc3RydWN0IGkyY19jbGllbnQgKnJ4X3AwX2NsaWVu
dDsKKwlzdHJ1Y3QgaTJjX2NsaWVudCAqcnhfcDFfY2xpZW50OworCXN0cnVjdCBpMmNfY2xpZW50
ICpyeF9wMl9jbGllbnQ7CisJc3RydWN0IGkyY19jbGllbnQgKnRjcGNfY2xpZW50OworfTsKKwor
c3RydWN0IGFueDc2MjVfZGF0YSB7CisJc3RydWN0IGFueDc2MjVfcGxhdGZvcm1fZGF0YSBwZGF0
YTsKKwlhdG9taWNfdCBwb3dlcl9zdGF0dXM7CisJYXRvbWljX3QgcGFuZWxfcG93ZXI7CisJaW50
IGhwZF9zdGF0dXM7CisJaW50IGhwZF9oaWdoX2NudDsKKwlzdHJ1Y3QgaTJjX2NsaWVudCAqY2xp
ZW50OworCXN0cnVjdCBhbng3NjI1X2kyY19jbGllbnQgaTJjOworCXN0cnVjdCBpMmNfY2xpZW50
ICpsYXN0X2NsaWVudDsKKwlzdHJ1Y3Qgc19lZGlkX2RhdGEgc2xpbXBvcnRfZWRpZF9wOworCXN0
cnVjdCB3b3JrX3N0cnVjdCB3b3JrOworCXN0cnVjdCB3b3JrcXVldWVfc3RydWN0ICp3b3JrcXVl
dWU7CisJLyogZHJtIGJyaWRnZSBtdXRleCBsb2NrICovCisJc3RydWN0IG11dGV4IGxvY2s7CisJ
Y2hhciBlZGlkX2Jsb2NrOworCXN0cnVjdCBkaXNwbGF5X3RpbWluZyBkdDsKKwl1OCBkaXNwbGF5
X3RpbWluZ192YWxpZDsKKwlzdHJ1Y3QgZHJtX2JyaWRnZSBicmlkZ2U7CisJdTggYnJpZGdlX2F0
dGFjaGVkOworCXN0cnVjdCBkcm1fY29ubmVjdG9yIGNvbm5lY3RvcjsKKwlzdHJ1Y3QgbWlwaV9k
c2lfZGV2aWNlICpkc2k7CisJc3RydWN0IGRybV9kcF9saW5rIGxpbms7CisJc3RydWN0IGRybV9k
aXNwbGF5X21vZGUgdmlkX2luZm87CisJc3RydWN0IG5vdGlmaWVyX2Jsb2NrIGV2ZW50X25iOwor
CXN0cnVjdCBleHRjb25fZGV2ICpleHRjb247CisJc3RydWN0IHdvcmtfc3RydWN0IGV4dGNvbl93
cTsKK307CisKKyNlbmRpZiAgLyogX19BTlg3NjI1X0hfXyAqLwotLSAKMi43LjQKCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5n
IGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVk
ZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
