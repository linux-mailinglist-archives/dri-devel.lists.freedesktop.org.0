Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 465C4EA4C7
	for <lists+dri-devel@lfdr.de>; Wed, 30 Oct 2019 21:30:49 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 170986EB7F;
	Wed, 30 Oct 2019 20:30:45 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-yw1-xc41.google.com (mail-yw1-xc41.google.com
 [IPv6:2607:f8b0:4864:20::c41])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2743F6EB6C
 for <dri-devel@lists.freedesktop.org>; Wed, 30 Oct 2019 20:30:41 +0000 (UTC)
Received: by mail-yw1-xc41.google.com with SMTP id v5so1340446ywd.0
 for <dri-devel@lists.freedesktop.org>; Wed, 30 Oct 2019 13:30:41 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=0iBo/bpNtAVrnbwT8ORdTsmBQ3tCsfrYh7X/5nVkhVU=;
 b=Tq/Zt+tdBDaWLzSJ+9Ia9+Ddyk1thwwAB65hF18FeZ3cfRTL4Vmcu87xmTT1mmVJRT
 HHuO/OhpNuliB6gWF9Dx+v10Jsm4wTtwvQHMOgD1+fsm+mWJy2qtVg7PY4MDtx/9T+6l
 rUWP01UBbZfxDE2SHmdkK8RC7gVy7AW6nGqXM+cEU/dnhQAhpg18tk2yGTR2GGMJkedE
 Fk68WRQ+0zIxZVrrsfYoPJYrQDGy1cQbO5pTzYgpPezTtVEA5vSm86O9uXxUIq20JCep
 yfh6VtPNm0gjPKWOpUlsWyOeqr+aWTMMloPtq9xu6R9auFSTno7+UN2KlgwEjJUfDv/r
 RLyA==
X-Gm-Message-State: APjAAAUJFV4yP1B1NfBx3XyGz7cxrQnPNoZZePcDmfhnfaw6M1JTt0Aq
 3dVkOTjN8Mm4Uv9YOXNkmZbKd6w0Qow=
X-Google-Smtp-Source: APXvYqy7rZgsd+H15gO6kjJK6vT/+nsedm0Tz3xNmECn4AxRjr5B5buY0zEMWSyAeegESWU3bEsKpA==
X-Received: by 2002:a81:7145:: with SMTP id m66mr1156673ywc.464.1572467439849; 
 Wed, 30 Oct 2019 13:30:39 -0700 (PDT)
Received: from rosewood.cam.corp.google.com
 ([2620:0:1013:11:89c6:2139:5435:371d])
 by smtp.gmail.com with ESMTPSA id h35sm416432ywk.63.2019.10.30.13.30.38
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Wed, 30 Oct 2019 13:30:39 -0700 (PDT)
From: Sean Paul <sean@poorly.run>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 4/5] Revert "dma-buf: heaps: Add heap helpers"
Date: Wed, 30 Oct 2019 16:29:53 -0400
Message-Id: <20191030203003.101156-5-sean@poorly.run>
X-Mailer: git-send-email 2.24.0.rc0.303.g954a862665-goog
In-Reply-To: <20191030203003.101156-1-sean@poorly.run>
References: <20191030203003.101156-1-sean@poorly.run>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=poorly.run; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=0iBo/bpNtAVrnbwT8ORdTsmBQ3tCsfrYh7X/5nVkhVU=;
 b=daa0DwFs97qSaEVrqvIAVBntB/wqc3brv/BDyNmxKTkpHIGCpVMdqAHr2asWx3NyPJ
 cZdq6cnN//jB6T3we9XQlpKYaYswqDl3UbbIwZmPnk7NlFwyjVHJcj9MpbBDlsE3zAxC
 Ol6KtaXo7iH5iRv8yrShGd19KmwzsW4gb9ljexWdoeUqAv4bB+Wvlru0lSqW6IMRselG
 YRKAE8vka/eblp2XQ0514amxyygBdMkIR+StWBxHSxcxTA0ECuDoIfjlHDOBu8BOETvN
 0yhyHSAY8Kx0A4F50uf2L89nGedfK7EB+7fQSQLg7mJOBZWhfA+h9km9Do7uLz71NIGG
 qdkw==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: linaro-mm-sig@lists.linaro.org, Hillf Danton <hdanton@sina.com>,
 Sudipto Paul <Sudipto.Paul@arm.com>,
 Vincent Donnefort <Vincent.Donnefort@arm.com>, Sean Paul <sean@poorly.run>,
 Chenbo Feng <fengc@google.com>, Alistair Strachan <astrachan@google.com>,
 Liam Mark <lmark@codeaurora.org>, Christoph Hellwig <hch@infradead.org>,
 Sean Paul <seanpaul@chromium.org>, "Andrew F . Davis" <afd@ti.com>,
 Hridya Valsaraju <hridya@google.com>, Pratik Patel <pratikp@codeaurora.org>,
 linux-media@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogU2VhbiBQYXVsIDxzZWFucGF1bEBjaHJvbWl1bS5vcmc+CgpUaGlzIHJldmVydHMgY29t
bWl0IDdiODdlYTcwNGZkOTYwNmVhYWZhOTE1MDExNjUzNmQ3MmY1YzRiMWYuCgpUaGlzIHBhdGNo
c2V0IGRvZXNuJ3QgbWVldCB0aGUgVUFQSSByZXF1aXJlbWVudHMgc2V0IG91dCBpbiBbMV0gZm9y
IHRoZSBEUk0Kc3Vic3lzdGVtLiBPbmNlIHRoZSB1c2Vyc3BhY2UgY29tcG9uZW50IGlzIHJldmll
d2VkIGFuZCByZWFkeSBmb3IgbWVyZ2UKd2UgY2FuIHRyeSBhZ2Fpbi4KClsxXS0gaHR0cHM6Ly8w
MS5vcmcvbGludXhncmFwaGljcy9nZngtZG9jcy9kcm0vZ3B1L2RybS11YXBpLmh0bWwjb3Blbi1z
b3VyY2UtdXNlcnNwYWNlLXJlcXVpcmVtZW50cwoKRml4ZXM6IDdiODdlYTcwNGZkOSAoImRtYS1i
dWY6IGhlYXBzOiBBZGQgaGVhcCBoZWxwZXJzIikKQ2M6IExhdXJhIEFiYm90dCA8bGFiYm90dEBy
ZWRoYXQuY29tPgpDYzogQmVuamFtaW4gR2FpZ25hcmQgPGJlbmphbWluLmdhaWduYXJkQGxpbmFy
by5vcmc+CkNjOiBTdW1pdCBTZW13YWwgPHN1bWl0LnNlbXdhbEBsaW5hcm8ub3JnPgpDYzogTGlh
bSBNYXJrIDxsbWFya0Bjb2RlYXVyb3JhLm9yZz4KQ2M6IFByYXRpayBQYXRlbCA8cHJhdGlrcEBj
b2RlYXVyb3JhLm9yZz4KQ2M6IEJyaWFuIFN0YXJrZXkgPEJyaWFuLlN0YXJrZXlAYXJtLmNvbT4K
Q2M6IFZpbmNlbnQgRG9ubmVmb3J0IDxWaW5jZW50LkRvbm5lZm9ydEBhcm0uY29tPgpDYzogU3Vk
aXB0byBQYXVsIDxTdWRpcHRvLlBhdWxAYXJtLmNvbT4KQ2M6IEFuZHJldyBGLiBEYXZpcyA8YWZk
QHRpLmNvbT4KQ2M6IENocmlzdG9waCBIZWxsd2lnIDxoY2hAaW5mcmFkZWFkLm9yZz4KQ2M6IENo
ZW5ibyBGZW5nIDxmZW5nY0Bnb29nbGUuY29tPgpDYzogQWxpc3RhaXIgU3RyYWNoYW4gPGFzdHJh
Y2hhbkBnb29nbGUuY29tPgpDYzogSHJpZHlhIFZhbHNhcmFqdSA8aHJpZHlhQGdvb2dsZS5jb20+
CkNjOiBIaWxsZiBEYW50b24gPGhkYW50b25Ac2luYS5jb20+CkNjOiBkcmktZGV2ZWxAbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnCkNjOiBCcmlhbiBTdGFya2V5IDxicmlhbi5zdGFya2V5QGFybS5jb20+
CkNjOiBKb2huIFN0dWx0eiA8am9obi5zdHVsdHpAbGluYXJvLm9yZz4KQ2M6ICJBbmRyZXcgRi4g
RGF2aXMiIDxhZmRAdGkuY29tPgpDYzogbGludXgtbWVkaWFAdmdlci5rZXJuZWwub3JnCkNjOiBs
aW5hcm8tbW0tc2lnQGxpc3RzLmxpbmFyby5vcmcKU2lnbmVkLW9mZi1ieTogU2VhbiBQYXVsIDxz
ZWFuQHBvb3JseS5ydW4+Ci0tLQogZHJpdmVycy9kbWEtYnVmL01ha2VmaWxlICAgICAgICAgICAg
IHwgICAxIC0KIGRyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9NYWtlZmlsZSAgICAgICB8ICAgMiAtCiBk
cml2ZXJzL2RtYS1idWYvaGVhcHMvaGVhcC1oZWxwZXJzLmMgfCAyNjggLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tCiBkcml2ZXJzL2RtYS1idWYvaGVhcHMvaGVhcC1oZWxwZXJzLmggfCAgNTUg
LS0tLS0tCiA0IGZpbGVzIGNoYW5nZWQsIDMyNiBkZWxldGlvbnMoLSkKIGRlbGV0ZSBtb2RlIDEw
MDY0NCBkcml2ZXJzL2RtYS1idWYvaGVhcHMvTWFrZWZpbGUKIGRlbGV0ZSBtb2RlIDEwMDY0NCBk
cml2ZXJzL2RtYS1idWYvaGVhcHMvaGVhcC1oZWxwZXJzLmMKIGRlbGV0ZSBtb2RlIDEwMDY0NCBk
cml2ZXJzL2RtYS1idWYvaGVhcHMvaGVhcC1oZWxwZXJzLmgKCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2RtYS1idWYvTWFrZWZpbGUgYi9kcml2ZXJzL2RtYS1idWYvTWFrZWZpbGUKaW5kZXggOWMxOTAw
MjZiZmFiLi5jYWVlNWViM2QzNTEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9NYWtlZmls
ZQorKysgYi9kcml2ZXJzL2RtYS1idWYvTWFrZWZpbGUKQEAgLTIsNyArMiw2IEBACiBvYmoteSA6
PSBkbWEtYnVmLm8gZG1hLWZlbmNlLm8gZG1hLWZlbmNlLWFycmF5Lm8gZG1hLWZlbmNlLWNoYWlu
Lm8gXAogCSBkbWEtcmVzdi5vIHNlcW5vLWZlbmNlLm8KIG9iai0kKENPTkZJR19ETUFCVUZfSEVB
UFMpCSs9IGRtYS1oZWFwLm8KLW9iai0kKENPTkZJR19ETUFCVUZfSEVBUFMpCSs9IGhlYXBzLwog
b2JqLSQoQ09ORklHX1NZTkNfRklMRSkJCSs9IHN5bmNfZmlsZS5vCiBvYmotJChDT05GSUdfU1df
U1lOQykJCSs9IHN3X3N5bmMubyBzeW5jX2RlYnVnLm8KIG9iai0kKENPTkZJR19VRE1BQlVGKQkJ
Kz0gdWRtYWJ1Zi5vCmRpZmYgLS1naXQgYS9kcml2ZXJzL2RtYS1idWYvaGVhcHMvTWFrZWZpbGUg
Yi9kcml2ZXJzL2RtYS1idWYvaGVhcHMvTWFrZWZpbGUKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0
CmluZGV4IGRlNDk4OTgxMTJkYi4uMDAwMDAwMDAwMDAwCi0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9o
ZWFwcy9NYWtlZmlsZQorKysgL2Rldi9udWxsCkBAIC0xLDIgKzAsMCBAQAotIyBTUERYLUxpY2Vu
c2UtSWRlbnRpZmllcjogR1BMLTIuMAotb2JqLXkJCQkJCSs9IGhlYXAtaGVscGVycy5vCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2RtYS1idWYvaGVhcHMvaGVhcC1oZWxwZXJzLmMgYi9kcml2ZXJzL2Rt
YS1idWYvaGVhcHMvaGVhcC1oZWxwZXJzLmMKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4
IDc1MGJlZjRlOTAyZC4uMDAwMDAwMDAwMDAwCi0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9o
ZWFwLWhlbHBlcnMuYworKysgL2Rldi9udWxsCkBAIC0xLDI2OCArMCwwIEBACi0vLyBTUERYLUxp
Y2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAotI2luY2x1ZGUgPGxpbnV4L2RldmljZS5oPgotI2lu
Y2x1ZGUgPGxpbnV4L2RtYS1idWYuaD4KLSNpbmNsdWRlIDxsaW51eC9lcnIuaD4KLSNpbmNsdWRl
IDxsaW51eC9oaWdobWVtLmg+Ci0jaW5jbHVkZSA8bGludXgvaWRyLmg+Ci0jaW5jbHVkZSA8bGlu
dXgvbGlzdC5oPgotI2luY2x1ZGUgPGxpbnV4L3NsYWIuaD4KLSNpbmNsdWRlIDxsaW51eC91YWNj
ZXNzLmg+Ci0jaW5jbHVkZSA8bGludXgvdm1hbGxvYy5oPgotI2luY2x1ZGUgPHVhcGkvbGludXgv
ZG1hLWhlYXAuaD4KLQotI2luY2x1ZGUgImhlYXAtaGVscGVycy5oIgotCi12b2lkIGluaXRfaGVh
cF9oZWxwZXJfYnVmZmVyKHN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKmJ1ZmZlciwKLQkJCSAg
ICAgdm9pZCAoKmZyZWUpKHN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKikpCi17Ci0JYnVmZmVy
LT5wcml2X3ZpcnQgPSBOVUxMOwotCW11dGV4X2luaXQoJmJ1ZmZlci0+bG9jayk7Ci0JYnVmZmVy
LT52bWFwX2NudCA9IDA7Ci0JYnVmZmVyLT52YWRkciA9IE5VTEw7Ci0JYnVmZmVyLT5wYWdlY291
bnQgPSAwOwotCWJ1ZmZlci0+cGFnZXMgPSBOVUxMOwotCUlOSVRfTElTVF9IRUFEKCZidWZmZXIt
PmF0dGFjaG1lbnRzKTsKLQlidWZmZXItPmZyZWUgPSBmcmVlOwotfQotCi1zdHJ1Y3QgZG1hX2J1
ZiAqaGVhcF9oZWxwZXJfZXhwb3J0X2RtYWJ1ZihzdHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICpi
dWZmZXIsCi0JCQkJCSAgaW50IGZkX2ZsYWdzKQotewotCURFRklORV9ETUFfQlVGX0VYUE9SVF9J
TkZPKGV4cF9pbmZvKTsKLQotCWV4cF9pbmZvLm9wcyA9ICZoZWFwX2hlbHBlcl9vcHM7Ci0JZXhw
X2luZm8uc2l6ZSA9IGJ1ZmZlci0+c2l6ZTsKLQlleHBfaW5mby5mbGFncyA9IGZkX2ZsYWdzOwot
CWV4cF9pbmZvLnByaXYgPSBidWZmZXI7Ci0KLQlyZXR1cm4gZG1hX2J1Zl9leHBvcnQoJmV4cF9p
bmZvKTsKLX0KLQotc3RhdGljIHZvaWQgKmRtYV9oZWFwX21hcF9rZXJuZWwoc3RydWN0IGhlYXBf
aGVscGVyX2J1ZmZlciAqYnVmZmVyKQotewotCXZvaWQgKnZhZGRyOwotCi0JdmFkZHIgPSB2bWFw
KGJ1ZmZlci0+cGFnZXMsIGJ1ZmZlci0+cGFnZWNvdW50LCBWTV9NQVAsIFBBR0VfS0VSTkVMKTsK
LQlpZiAoIXZhZGRyKQotCQlyZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKLQotCXJldHVybiB2YWRk
cjsKLX0KLQotc3RhdGljIHZvaWQgZG1hX2hlYXBfYnVmZmVyX2Rlc3Ryb3koc3RydWN0IGhlYXBf
aGVscGVyX2J1ZmZlciAqYnVmZmVyKQotewotCWlmIChidWZmZXItPnZtYXBfY250ID4gMCkgewot
CQlXQVJOKCIlczogYnVmZmVyIHN0aWxsIG1hcHBlZCBpbiB0aGUga2VybmVsXG4iLCBfX2Z1bmNf
Xyk7Ci0JCXZ1bm1hcChidWZmZXItPnZhZGRyKTsKLQl9Ci0KLQlidWZmZXItPmZyZWUoYnVmZmVy
KTsKLX0KLQotc3RhdGljIHZvaWQgKmRtYV9oZWFwX2J1ZmZlcl92bWFwX2dldChzdHJ1Y3QgaGVh
cF9oZWxwZXJfYnVmZmVyICpidWZmZXIpCi17Ci0Jdm9pZCAqdmFkZHI7Ci0KLQlpZiAoYnVmZmVy
LT52bWFwX2NudCkgewotCQlidWZmZXItPnZtYXBfY250Kys7Ci0JCXJldHVybiBidWZmZXItPnZh
ZGRyOwotCX0KLQl2YWRkciA9IGRtYV9oZWFwX21hcF9rZXJuZWwoYnVmZmVyKTsKLQlpZiAoSVNf
RVJSKHZhZGRyKSkKLQkJcmV0dXJuIHZhZGRyOwotCWJ1ZmZlci0+dmFkZHIgPSB2YWRkcjsKLQli
dWZmZXItPnZtYXBfY250Kys7Ci0JcmV0dXJuIHZhZGRyOwotfQotCi1zdGF0aWMgdm9pZCBkbWFf
aGVhcF9idWZmZXJfdm1hcF9wdXQoc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyKQot
ewotCWlmICghLS1idWZmZXItPnZtYXBfY250KSB7Ci0JCXZ1bm1hcChidWZmZXItPnZhZGRyKTsK
LQkJYnVmZmVyLT52YWRkciA9IE5VTEw7Ci0JfQotfQotCi1zdHJ1Y3QgZG1hX2hlYXBzX2F0dGFj
aG1lbnQgewotCXN0cnVjdCBkZXZpY2UgKmRldjsKLQlzdHJ1Y3Qgc2dfdGFibGUgdGFibGU7Ci0J
c3RydWN0IGxpc3RfaGVhZCBsaXN0OwotfTsKLQotc3RhdGljIGludCBkbWFfaGVhcF9hdHRhY2go
c3RydWN0IGRtYV9idWYgKmRtYWJ1ZiwKLQkJCSAgIHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQg
KmF0dGFjaG1lbnQpCi17Ci0Jc3RydWN0IGRtYV9oZWFwc19hdHRhY2htZW50ICphOwotCXN0cnVj
dCBoZWFwX2hlbHBlcl9idWZmZXIgKmJ1ZmZlciA9IGRtYWJ1Zi0+cHJpdjsKLQlpbnQgcmV0Owot
Ci0JYSA9IGt6YWxsb2Moc2l6ZW9mKCphKSwgR0ZQX0tFUk5FTCk7Ci0JaWYgKCFhKQotCQlyZXR1
cm4gLUVOT01FTTsKLQotCXJldCA9IHNnX2FsbG9jX3RhYmxlX2Zyb21fcGFnZXMoJmEtPnRhYmxl
LCBidWZmZXItPnBhZ2VzLAotCQkJCQlidWZmZXItPnBhZ2Vjb3VudCwgMCwKLQkJCQkJYnVmZmVy
LT5wYWdlY291bnQgPDwgUEFHRV9TSElGVCwKLQkJCQkJR0ZQX0tFUk5FTCk7Ci0JaWYgKHJldCkg
ewotCQlrZnJlZShhKTsKLQkJcmV0dXJuIHJldDsKLQl9Ci0KLQlhLT5kZXYgPSBhdHRhY2htZW50
LT5kZXY7Ci0JSU5JVF9MSVNUX0hFQUQoJmEtPmxpc3QpOwotCi0JYXR0YWNobWVudC0+cHJpdiA9
IGE7Ci0KLQltdXRleF9sb2NrKCZidWZmZXItPmxvY2spOwotCWxpc3RfYWRkKCZhLT5saXN0LCAm
YnVmZmVyLT5hdHRhY2htZW50cyk7Ci0JbXV0ZXhfdW5sb2NrKCZidWZmZXItPmxvY2spOwotCi0J
cmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyB2b2lkIGRtYV9oZWFwX2RldGFjaChzdHJ1Y3QgZG1hX2J1
ZiAqZG1hYnVmLAotCQkJICAgIHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFjaG1lbnQp
Ci17Ci0Jc3RydWN0IGRtYV9oZWFwc19hdHRhY2htZW50ICphID0gYXR0YWNobWVudC0+cHJpdjsK
LQlzdHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICpidWZmZXIgPSBkbWFidWYtPnByaXY7Ci0KLQlt
dXRleF9sb2NrKCZidWZmZXItPmxvY2spOwotCWxpc3RfZGVsKCZhLT5saXN0KTsKLQltdXRleF91
bmxvY2soJmJ1ZmZlci0+bG9jayk7Ci0KLQlzZ19mcmVlX3RhYmxlKCZhLT50YWJsZSk7Ci0Ja2Zy
ZWUoYSk7Ci19Ci0KLXN0YXRpYwotc3RydWN0IHNnX3RhYmxlICpkbWFfaGVhcF9tYXBfZG1hX2J1
ZihzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICphdHRhY2htZW50LAotCQkJCSAgICAgIGVudW0g
ZG1hX2RhdGFfZGlyZWN0aW9uIGRpcmVjdGlvbikKLXsKLQlzdHJ1Y3QgZG1hX2hlYXBzX2F0dGFj
aG1lbnQgKmEgPSBhdHRhY2htZW50LT5wcml2OwotCXN0cnVjdCBzZ190YWJsZSAqdGFibGU7Ci0K
LQl0YWJsZSA9ICZhLT50YWJsZTsKLQotCWlmICghZG1hX21hcF9zZyhhdHRhY2htZW50LT5kZXYs
IHRhYmxlLT5zZ2wsIHRhYmxlLT5uZW50cywKLQkJCWRpcmVjdGlvbikpCi0JCXRhYmxlID0gRVJS
X1BUUigtRU5PTUVNKTsKLQlyZXR1cm4gdGFibGU7Ci19Ci0KLXN0YXRpYyB2b2lkIGRtYV9oZWFw
X3VubWFwX2RtYV9idWYoc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCAqYXR0YWNobWVudCwKLQkJ
CQkgICBzdHJ1Y3Qgc2dfdGFibGUgKnRhYmxlLAotCQkJCSAgIGVudW0gZG1hX2RhdGFfZGlyZWN0
aW9uIGRpcmVjdGlvbikKLXsKLQlkbWFfdW5tYXBfc2coYXR0YWNobWVudC0+ZGV2LCB0YWJsZS0+
c2dsLCB0YWJsZS0+bmVudHMsIGRpcmVjdGlvbik7Ci19Ci0KLXN0YXRpYyB2bV9mYXVsdF90IGRt
YV9oZWFwX3ZtX2ZhdWx0KHN0cnVjdCB2bV9mYXVsdCAqdm1mKQotewotCXN0cnVjdCB2bV9hcmVh
X3N0cnVjdCAqdm1hID0gdm1mLT52bWE7Ci0Jc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVm
ZmVyID0gdm1hLT52bV9wcml2YXRlX2RhdGE7Ci0KLQl2bWYtPnBhZ2UgPSBidWZmZXItPnBhZ2Vz
W3ZtZi0+cGdvZmZdOwotCWdldF9wYWdlKHZtZi0+cGFnZSk7Ci0KLQlyZXR1cm4gMDsKLX0KLQot
c3RhdGljIGNvbnN0IHN0cnVjdCB2bV9vcGVyYXRpb25zX3N0cnVjdCBkbWFfaGVhcF92bV9vcHMg
PSB7Ci0JLmZhdWx0ID0gZG1hX2hlYXBfdm1fZmF1bHQsCi19OwotCi1zdGF0aWMgaW50IGRtYV9o
ZWFwX21tYXAoc3RydWN0IGRtYV9idWYgKmRtYWJ1Ziwgc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2
bWEpCi17Ci0Jc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyID0gZG1hYnVmLT5wcml2
OwotCi0JaWYgKCh2bWEtPnZtX2ZsYWdzICYgKFZNX1NIQVJFRCB8IFZNX01BWVNIQVJFKSkgPT0g
MCkKLQkJcmV0dXJuIC1FSU5WQUw7Ci0KLQl2bWEtPnZtX29wcyA9ICZkbWFfaGVhcF92bV9vcHM7
Ci0Jdm1hLT52bV9wcml2YXRlX2RhdGEgPSBidWZmZXI7Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3Rh
dGljIHZvaWQgZG1hX2hlYXBfZG1hX2J1Zl9yZWxlYXNlKHN0cnVjdCBkbWFfYnVmICpkbWFidWYp
Ci17Ci0Jc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyID0gZG1hYnVmLT5wcml2Owot
Ci0JZG1hX2hlYXBfYnVmZmVyX2Rlc3Ryb3koYnVmZmVyKTsKLX0KLQotc3RhdGljIGludCBkbWFf
aGVhcF9kbWFfYnVmX2JlZ2luX2NwdV9hY2Nlc3Moc3RydWN0IGRtYV9idWYgKmRtYWJ1ZiwKLQkJ
CQkJICAgICBlbnVtIGRtYV9kYXRhX2RpcmVjdGlvbiBkaXJlY3Rpb24pCi17Ci0Jc3RydWN0IGhl
YXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyID0gZG1hYnVmLT5wcml2OwotCXN0cnVjdCBkbWFfaGVh
cHNfYXR0YWNobWVudCAqYTsKLQlpbnQgcmV0ID0gMDsKLQotCW11dGV4X2xvY2soJmJ1ZmZlci0+
bG9jayk7Ci0KLQlpZiAoYnVmZmVyLT52bWFwX2NudCkKLQkJaW52YWxpZGF0ZV9rZXJuZWxfdm1h
cF9yYW5nZShidWZmZXItPnZhZGRyLCBidWZmZXItPnNpemUpOwotCi0JbGlzdF9mb3JfZWFjaF9l
bnRyeShhLCAmYnVmZmVyLT5hdHRhY2htZW50cywgbGlzdCkgewotCQlkbWFfc3luY19zZ19mb3Jf
Y3B1KGEtPmRldiwgYS0+dGFibGUuc2dsLCBhLT50YWJsZS5uZW50cywKLQkJCQkgICAgZGlyZWN0
aW9uKTsKLQl9Ci0JbXV0ZXhfdW5sb2NrKCZidWZmZXItPmxvY2spOwotCi0JcmV0dXJuIHJldDsK
LX0KLQotc3RhdGljIGludCBkbWFfaGVhcF9kbWFfYnVmX2VuZF9jcHVfYWNjZXNzKHN0cnVjdCBk
bWFfYnVmICpkbWFidWYsCi0JCQkJCSAgIGVudW0gZG1hX2RhdGFfZGlyZWN0aW9uIGRpcmVjdGlv
bikKLXsKLQlzdHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICpidWZmZXIgPSBkbWFidWYtPnByaXY7
Ci0Jc3RydWN0IGRtYV9oZWFwc19hdHRhY2htZW50ICphOwotCi0JbXV0ZXhfbG9jaygmYnVmZmVy
LT5sb2NrKTsKLQotCWlmIChidWZmZXItPnZtYXBfY250KQotCQlmbHVzaF9rZXJuZWxfdm1hcF9y
YW5nZShidWZmZXItPnZhZGRyLCBidWZmZXItPnNpemUpOwotCi0JbGlzdF9mb3JfZWFjaF9lbnRy
eShhLCAmYnVmZmVyLT5hdHRhY2htZW50cywgbGlzdCkgewotCQlkbWFfc3luY19zZ19mb3JfZGV2
aWNlKGEtPmRldiwgYS0+dGFibGUuc2dsLCBhLT50YWJsZS5uZW50cywKLQkJCQkgICAgICAgZGly
ZWN0aW9uKTsKLQl9Ci0JbXV0ZXhfdW5sb2NrKCZidWZmZXItPmxvY2spOwotCi0JcmV0dXJuIDA7
Ci19Ci0KLXN0YXRpYyB2b2lkICpkbWFfaGVhcF9kbWFfYnVmX3ZtYXAoc3RydWN0IGRtYV9idWYg
KmRtYWJ1ZikKLXsKLQlzdHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICpidWZmZXIgPSBkbWFidWYt
PnByaXY7Ci0Jdm9pZCAqdmFkZHI7Ci0KLQltdXRleF9sb2NrKCZidWZmZXItPmxvY2spOwotCXZh
ZGRyID0gZG1hX2hlYXBfYnVmZmVyX3ZtYXBfZ2V0KGJ1ZmZlcik7Ci0JbXV0ZXhfdW5sb2NrKCZi
dWZmZXItPmxvY2spOwotCi0JcmV0dXJuIHZhZGRyOwotfQotCi1zdGF0aWMgdm9pZCBkbWFfaGVh
cF9kbWFfYnVmX3Z1bm1hcChzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmLCB2b2lkICp2YWRkcikKLXsK
LQlzdHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICpidWZmZXIgPSBkbWFidWYtPnByaXY7Ci0KLQlt
dXRleF9sb2NrKCZidWZmZXItPmxvY2spOwotCWRtYV9oZWFwX2J1ZmZlcl92bWFwX3B1dChidWZm
ZXIpOwotCW11dGV4X3VubG9jaygmYnVmZmVyLT5sb2NrKTsKLX0KLQotY29uc3Qgc3RydWN0IGRt
YV9idWZfb3BzIGhlYXBfaGVscGVyX29wcyA9IHsKLQkubWFwX2RtYV9idWYgPSBkbWFfaGVhcF9t
YXBfZG1hX2J1ZiwKLQkudW5tYXBfZG1hX2J1ZiA9IGRtYV9oZWFwX3VubWFwX2RtYV9idWYsCi0J
Lm1tYXAgPSBkbWFfaGVhcF9tbWFwLAotCS5yZWxlYXNlID0gZG1hX2hlYXBfZG1hX2J1Zl9yZWxl
YXNlLAotCS5hdHRhY2ggPSBkbWFfaGVhcF9hdHRhY2gsCi0JLmRldGFjaCA9IGRtYV9oZWFwX2Rl
dGFjaCwKLQkuYmVnaW5fY3B1X2FjY2VzcyA9IGRtYV9oZWFwX2RtYV9idWZfYmVnaW5fY3B1X2Fj
Y2VzcywKLQkuZW5kX2NwdV9hY2Nlc3MgPSBkbWFfaGVhcF9kbWFfYnVmX2VuZF9jcHVfYWNjZXNz
LAotCS52bWFwID0gZG1hX2hlYXBfZG1hX2J1Zl92bWFwLAotCS52dW5tYXAgPSBkbWFfaGVhcF9k
bWFfYnVmX3Z1bm1hcCwKLX07CmRpZmYgLS1naXQgYS9kcml2ZXJzL2RtYS1idWYvaGVhcHMvaGVh
cC1oZWxwZXJzLmggYi9kcml2ZXJzL2RtYS1idWYvaGVhcHMvaGVhcC1oZWxwZXJzLmgKZGVsZXRl
ZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDkxMWM5MzFmN2YwNi4uMDAwMDAwMDAwMDAwCi0tLSBh
L2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9oZWFwLWhlbHBlcnMuaAorKysgL2Rldi9udWxsCkBAIC0x
LDU1ICswLDAgQEAKLS8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovCi0vKgot
ICogRE1BQlVGIEhlYXBzIGhlbHBlciBjb2RlCi0gKgotICogQ29weXJpZ2h0IChDKSAyMDExIEdv
b2dsZSwgSW5jLgotICogQ29weXJpZ2h0IChDKSAyMDE5IExpbmFybyBMdGQuCi0gKi8KLQotI2lm
bmRlZiBfSEVBUF9IRUxQRVJTX0gKLSNkZWZpbmUgX0hFQVBfSEVMUEVSU19ICi0KLSNpbmNsdWRl
IDxsaW51eC9kbWEtaGVhcC5oPgotI2luY2x1ZGUgPGxpbnV4L2xpc3QuaD4KLQotLyoqCi0gKiBz
dHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVyIC0gaGVscGVyIGJ1ZmZlciBtZXRhZGF0YQotICogQGhl
YXA6CQliYWNrIHBvaW50ZXIgdG8gdGhlIGhlYXAgdGhlIGJ1ZmZlciBjYW1lIGZyb20KLSAqIEBk
bWFidWY6CQliYWNraW5nIGRtYS1idWYgZm9yIHRoaXMgYnVmZmVyCi0gKiBAc2l6ZToJCXNpemUg
b2YgdGhlIGJ1ZmZlcgotICogQGZsYWdzOgkJYnVmZmVyIHNwZWNpZmljIGZsYWdzCi0gKiBAcHJp
dl92aXJ0CQlwb2ludGVyIHRvIGhlYXAgc3BlY2lmaWMgcHJpdmF0ZSB2YWx1ZQotICogQGxvY2sJ
CW11dGV4dCB0byBwcm90ZWN0IHRoZSBkYXRhIGluIHRoaXMgc3RydWN0dXJlCi0gKiBAdm1hcF9j
bnQJCWNvdW50IG9mIHZtYXAgcmVmZXJlbmNlcyBvbiB0aGUgYnVmZmVyCi0gKiBAdmFkZHIJCXZt
YXAnZWQgdmlydHVhbCBhZGRyZXNzCi0gKiBAcGFnZWNvdW50CQludW1iZXIgb2YgcGFnZXMgaW4g
dGhlIGJ1ZmZlcgotICogQHBhZ2VzCQlsaXN0IG9mIHBhZ2UgcG9pbnRlcnMKLSAqIEBhdHRhY2ht
ZW50cwkJbGlzdCBvZiBkZXZpY2UgYXR0YWNobWVudHMKLSAqCi0gKiBAZnJlZQkJaGVhcCBjYWxs
YmFjayB0byBmcmVlIHRoZSBidWZmZXIKLSAqLwotc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciB7
Ci0Jc3RydWN0IGRtYV9oZWFwICpoZWFwOwotCXN0cnVjdCBkbWFfYnVmICpkbWFidWY7Ci0Jc2l6
ZV90IHNpemU7Ci0JdW5zaWduZWQgbG9uZyBmbGFnczsKLQotCXZvaWQgKnByaXZfdmlydDsKLQlz
dHJ1Y3QgbXV0ZXggbG9jazsKLQlpbnQgdm1hcF9jbnQ7Ci0Jdm9pZCAqdmFkZHI7Ci0JcGdvZmZf
dCBwYWdlY291bnQ7Ci0Jc3RydWN0IHBhZ2UgKipwYWdlczsKLQlzdHJ1Y3QgbGlzdF9oZWFkIGF0
dGFjaG1lbnRzOwotCi0Jdm9pZCAoKmZyZWUpKHN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKmJ1
ZmZlcik7Ci19OwotCi12b2lkIGluaXRfaGVhcF9oZWxwZXJfYnVmZmVyKHN0cnVjdCBoZWFwX2hl
bHBlcl9idWZmZXIgKmJ1ZmZlciwKLQkJCSAgICAgdm9pZCAoKmZyZWUpKHN0cnVjdCBoZWFwX2hl
bHBlcl9idWZmZXIgKikpOwotCi1zdHJ1Y3QgZG1hX2J1ZiAqaGVhcF9oZWxwZXJfZXhwb3J0X2Rt
YWJ1ZihzdHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICpidWZmZXIsCi0JCQkJCSAgaW50IGZkX2Zs
YWdzKTsKLQotZXh0ZXJuIGNvbnN0IHN0cnVjdCBkbWFfYnVmX29wcyBoZWFwX2hlbHBlcl9vcHM7
Ci0jZW5kaWYgLyogX0hFQVBfSEVMUEVSU19IICovCi0tIApTZWFuIFBhdWwsIFNvZnR3YXJlIEVu
Z2luZWVyLCBHb29nbGUgLyBDaHJvbWl1bSBPUwoKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlz
dHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4v
bGlzdGluZm8vZHJpLWRldmVs
