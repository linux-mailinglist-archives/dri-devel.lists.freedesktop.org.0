Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id EFED636F7D7
	for <lists+dri-devel@lfdr.de>; Fri, 30 Apr 2021 11:25:30 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E5E9E6F513;
	Fri, 30 Apr 2021 09:25:25 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x52e.google.com (mail-ed1-x52e.google.com
 [IPv6:2a00:1450:4864:20::52e])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2E3056F504
 for <dri-devel@lists.freedesktop.org>; Fri, 30 Apr 2021 09:25:15 +0000 (UTC)
Received: by mail-ed1-x52e.google.com with SMTP id g14so22132086edy.6
 for <dri-devel@lists.freedesktop.org>; Fri, 30 Apr 2021 02:25:15 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=pO/oHYAylfSenGFoFYRqhNwrEpPLz2jPJPUjNMWx5hc=;
 b=kcD79eFMOR5a53RZmAm9K+QRZ5sOW6HRazuB+hkJRroFGT1vsOE5XIVqbWE4pUyvFE
 VMcOe9UbcofF0hi7gVJa6JLahjHJshw4179nlz0QTTCnIM916Sx/A0fJ4iaXwEBO5qlk
 H15iBKMxFSbldezm4mtpPjknoaTTrmIjFmknXmzVnItSWbaK7ctZP8lnS8LHcYfCdpB0
 HrgM58H4jqC19gpA18YRDHIpP7Jgce7sLcaNBsPg7WhxYf3dGcRi7SCFT/N4H/uolc0D
 1zs2QkFaney6dA1TkSwgJwwcxJHi6qxRyCYPMRmfhS7szQNSml/9kkZnlhrmcTEi9tDQ
 5Vwg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=pO/oHYAylfSenGFoFYRqhNwrEpPLz2jPJPUjNMWx5hc=;
 b=om2CJnitweMqGLjYdGLYxeIjk85LMilU74F8ucFQk7T6oS0yzwemHT5devz4T3kB0V
 ChPhp55BR4lJEtgMdwuQ0UjZqDfS4uAPaaJnCq4Gx2v0jfRSYVrGal2hteJGw6n+hPmH
 zVR/V8kMtPHNMw8uH70K2A9gsjUYok6tTjDuST5LbhU4TuDKTeDjfG/rgelHe/cfLn6D
 MvLpTtSnhkl3lqs2mcGBFGluLUAefgJS9UfXkN9fEEdscLPnHI9/jF7LXF4N4JGdsykn
 AR8tr4fxBEg6XP366YQn3X8nFvaq960/gMYK3cYxxzEfGmE+3mDO6ZTt74Jw+wXkfKIh
 DiOw==
X-Gm-Message-State: AOAM5313gUSvUNkMSu4wHAj1UOlgUxubAzTyTXJZIWr+LhzAs6AMnQjP
 ehi9spyh2iJiV+ruwkrSQ6EfQZSD7oQ=
X-Google-Smtp-Source: ABdhPJys37rq+PqGPqwocRYTTJWgtDhSWH1ga2cK28dXcCL8vdVoGpq77cnWzSLr5BbTALDfUOC6gg==
X-Received: by 2002:a50:8fe6:: with SMTP id y93mr4625154edy.224.1619774713815; 
 Fri, 30 Apr 2021 02:25:13 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:d08c:9633:b7a2:37e2])
 by smtp.gmail.com with ESMTPSA id h23sm1550959ejx.90.2021.04.30.02.25.13
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 30 Apr 2021 02:25:13 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 06/13] drm/ttm: flip over the range manager to self allocated
 nodes
Date: Fri, 30 Apr 2021 11:25:01 +0200
Message-Id: <20210430092508.60710-6-christian.koenig@amd.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20210430092508.60710-1-christian.koenig@amd.com>
References: <20210430092508.60710-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: daniel.vetter@ffwll.ch, matthew.william.auld@gmail.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

U3RhcnQgd2l0aCB0aGUgcmFuZ2UgbWFuYWdlciB0byBtYWtlIHRoZSByZXNvdXJjZSBvYmplY3Qg
dGhlIGJhc2UKY2xhc3MgZm9yIHRoZSBhbGxvY2F0ZWQgbm9kZXMuCgpXaGlsZSBhdCBpdCBjbGVh
bnVwIGEgbG90IG9mIHRoZSBjb2RlIGFyb3VuZCB0aGF0LgoKU2lnbmVkLW9mZi1ieTogQ2hyaXN0
aWFuIEvDtm5pZyA8Y2hyaXN0aWFuLmtvZW5pZ0BhbWQuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYyB8ICAxICsKIGRyaXZlcnMvZ3B1L2RybS9kcm1fZ2Vt
X3ZyYW1faGVscGVyLmMgICB8ICAyICsKIGRyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVf
dHRtLmMgICB8ICAxICsKIGRyaXZlcnMvZ3B1L2RybS9xeGwvcXhsX3R0bS5jICAgICAgICAgICB8
ICAxICsKIGRyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX3R0bS5jICAgICB8ICAxICsKIGRy
aXZlcnMvZ3B1L2RybS90dG0vdHRtX3JhbmdlX21hbmFnZXIuYyB8IDU2ICsrKysrKysrKysrKysr
KysrKy0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3Jlc291cmNlLmMgICAgICB8IDI2
ICsrKysrKysrLS0tLQogaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19kcml2ZXIuaCAgICAgICAgIHwg
MjYgLS0tLS0tLS0tLS0tCiBpbmNsdWRlL2RybS90dG0vdHRtX3JhbmdlX21hbmFnZXIuaCAgICAg
fCA0MyArKysrKysrKysrKysrKysrKysrCiBpbmNsdWRlL2RybS90dG0vdHRtX3Jlc291cmNlLmgg
ICAgICAgICAgfCAgMyArKwogMTAgZmlsZXMgY2hhbmdlZCwgMTEwIGluc2VydGlvbnMoKyksIDUw
IGRlbGV0aW9ucygtKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGluY2x1ZGUvZHJtL3R0bS90dG1fcmFu
Z2VfbWFuYWdlci5oCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X3R0bS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jCmluZGV4
IDNmZTI0ODJhNDBiNC4uM2Q1ODYzMjYyMzM3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfdHRtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X3R0bS5jCkBAIC00Niw2ICs0Niw3IEBACiAjaW5jbHVkZSA8ZHJtL3R0bS90dG1fYm9f
YXBpLmg+CiAjaW5jbHVkZSA8ZHJtL3R0bS90dG1fYm9fZHJpdmVyLmg+CiAjaW5jbHVkZSA8ZHJt
L3R0bS90dG1fcGxhY2VtZW50Lmg+CisjaW5jbHVkZSA8ZHJtL3R0bS90dG1fcmFuZ2VfbWFuYWdl
ci5oPgogCiAjaW5jbHVkZSA8ZHJtL2FtZGdwdV9kcm0uaD4KIApkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2RybV9nZW1fdnJhbV9oZWxwZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2Vt
X3ZyYW1faGVscGVyLmMKaW5kZXggODNlNzI1OGM3ZjkwLi4xN2E0YzVkNDdiNmEgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2RybV9nZW1fdnJhbV9oZWxwZXIuYwpAQCAtMTcsNiArMTcsOCBAQAogI2luY2x1ZGUg
PGRybS9kcm1fcHJpbWUuaD4KICNpbmNsdWRlIDxkcm0vZHJtX3NpbXBsZV9rbXNfaGVscGVyLmg+
CiAKKyNpbmNsdWRlIDxkcm0vdHRtL3R0bV9yYW5nZV9tYW5hZ2VyLmg+CisKIHN0YXRpYyBjb25z
dCBzdHJ1Y3QgZHJtX2dlbV9vYmplY3RfZnVuY3MgZHJtX2dlbV92cmFtX29iamVjdF9mdW5jczsK
IAogLyoqCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X3R0bS5j
IGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV90dG0uYwppbmRleCBiODFhZTkwYjg0
NDkuLjE1Yzc2MjdmOGY1OCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91
dmVhdV90dG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X3R0bS5jCkBA
IC0zMiw2ICszMiw3IEBACiAjaW5jbHVkZSAibm91dmVhdV90dG0uaCIKIAogI2luY2x1ZGUgPGRy
bS9kcm1fbGVnYWN5Lmg+CisjaW5jbHVkZSA8ZHJtL3R0bS90dG1fcmFuZ2VfbWFuYWdlci5oPgog
CiAjaW5jbHVkZSA8Y29yZS90ZWdyYS5oPgogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
cXhsL3F4bF90dG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9xeGwvcXhsX3R0bS5jCmluZGV4IDhhYTg3
YjhlZGI5Yy4uMTlmZDM5ZDlhMDBjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4
bF90dG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF90dG0uYwpAQCAtMzIsNiArMzIs
NyBAQAogI2luY2x1ZGUgPGRybS90dG0vdHRtX2JvX2FwaS5oPgogI2luY2x1ZGUgPGRybS90dG0v
dHRtX2JvX2RyaXZlci5oPgogI2luY2x1ZGUgPGRybS90dG0vdHRtX3BsYWNlbWVudC5oPgorI2lu
Y2x1ZGUgPGRybS90dG0vdHRtX3JhbmdlX21hbmFnZXIuaD4KIAogI2luY2x1ZGUgInF4bF9kcnYu
aCIKICNpbmNsdWRlICJxeGxfb2JqZWN0LmgiCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
cmFkZW9uL3JhZGVvbl90dG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX3R0bS5j
CmluZGV4IDUxOTFlOTk0YmZmNy4uYzNkMmYxZmNlNzFhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vcmFkZW9uL3JhZGVvbl90dG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3Jh
ZGVvbl90dG0uYwpAQCAtNDYsNiArNDYsNyBAQAogI2luY2x1ZGUgPGRybS90dG0vdHRtX2JvX2Fw
aS5oPgogI2luY2x1ZGUgPGRybS90dG0vdHRtX2JvX2RyaXZlci5oPgogI2luY2x1ZGUgPGRybS90
dG0vdHRtX3BsYWNlbWVudC5oPgorI2luY2x1ZGUgPGRybS90dG0vdHRtX3JhbmdlX21hbmFnZXIu
aD4KIAogI2luY2x1ZGUgInJhZGVvbl9yZWcuaCIKICNpbmNsdWRlICJyYWRlb24uaCIKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3JhbmdlX21hbmFnZXIuYyBiL2RyaXZlcnMv
Z3B1L2RybS90dG0vdHRtX3JhbmdlX21hbmFnZXIuYwppbmRleCBiOWQ1ZGE2ZTZhODEuLmNlNWQw
N2NhMzg0YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fcmFuZ2VfbWFuYWdl
ci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3JhbmdlX21hbmFnZXIuYwpAQCAtMjks
MTIgKzI5LDEzIEBACiAgKiBBdXRob3JzOiBUaG9tYXMgSGVsbHN0cm9tIDx0aGVsbHN0cm9tLWF0
LXZtd2FyZS1kb3QtY29tPgogICovCiAKLSNpbmNsdWRlIDxkcm0vdHRtL3R0bV9ib19kcml2ZXIu
aD4KKyNpbmNsdWRlIDxkcm0vdHRtL3R0bV9kZXZpY2UuaD4KICNpbmNsdWRlIDxkcm0vdHRtL3R0
bV9wbGFjZW1lbnQuaD4KKyNpbmNsdWRlIDxkcm0vdHRtL3R0bV9yYW5nZV9tYW5hZ2VyLmg+Cisj
aW5jbHVkZSA8ZHJtL3R0bS90dG1fYm9fYXBpLmg+CiAjaW5jbHVkZSA8ZHJtL2RybV9tbS5oPgog
I2luY2x1ZGUgPGxpbnV4L3NsYWIuaD4KICNpbmNsdWRlIDxsaW51eC9zcGlubG9jay5oPgotI2lu
Y2x1ZGUgPGxpbnV4L21vZHVsZS5oPgogCiAvKgogICogQ3VycmVudGx5IHdlIHVzZSBhIHNwaW5s
b2NrIGZvciB0aGUgbG9jaywgYnV0IGEgbXV0ZXggKm1heSogYmUKQEAgLTYwLDggKzYxLDggQEAg
c3RhdGljIGludCB0dG1fcmFuZ2VfbWFuX2FsbG9jKHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdl
ciAqbWFuLAogCQkJICAgICAgIHN0cnVjdCB0dG1fcmVzb3VyY2UgKm1lbSkKIHsKIAlzdHJ1Y3Qg
dHRtX3JhbmdlX21hbmFnZXIgKnJtYW4gPSB0b19yYW5nZV9tYW5hZ2VyKG1hbik7CisJc3RydWN0
IHR0bV9yYW5nZV9tZ3Jfbm9kZSAqbm9kZTsKIAlzdHJ1Y3QgZHJtX21tICptbSA9ICZybWFuLT5t
bTsKLQlzdHJ1Y3QgZHJtX21tX25vZGUgKm5vZGU7CiAJZW51bSBkcm1fbW1faW5zZXJ0X21vZGUg
bW9kZTsKIAl1bnNpZ25lZCBsb25nIGxwZm47CiAJaW50IHJldDsKQEAgLTcwLDcgKzcxLDcgQEAg
c3RhdGljIGludCB0dG1fcmFuZ2VfbWFuX2FsbG9jKHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdl
ciAqbWFuLAogCWlmICghbHBmbikKIAkJbHBmbiA9IG1hbi0+c2l6ZTsKIAotCW5vZGUgPSBremFs
bG9jKHNpemVvZigqbm9kZSksIEdGUF9LRVJORUwpOworCW5vZGUgPSBremFsbG9jKHN0cnVjdF9z
aXplKG5vZGUsIG1tX25vZGVzLCAxKSwgR0ZQX0tFUk5FTCk7CiAJaWYgKCFub2RlKQogCQlyZXR1
cm4gLUVOT01FTTsKIApAQCAtNzgsMTcgKzc5LDE5IEBAIHN0YXRpYyBpbnQgdHRtX3JhbmdlX21h
bl9hbGxvYyhzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiwKIAlpZiAocGxhY2UtPmZs
YWdzICYgVFRNX1BMX0ZMQUdfVE9QRE9XTikKIAkJbW9kZSA9IERSTV9NTV9JTlNFUlRfSElHSDsK
IAorCXR0bV9yZXNvdXJjZV9pbml0KGJvLCBwbGFjZSwgJm5vZGUtPmJhc2UpOworCiAJc3Bpbl9s
b2NrKCZybWFuLT5sb2NrKTsKLQlyZXQgPSBkcm1fbW1faW5zZXJ0X25vZGVfaW5fcmFuZ2UobW0s
IG5vZGUsIG1lbS0+bnVtX3BhZ2VzLAotCQkJCQkgIGJvLT5wYWdlX2FsaWdubWVudCwgMCwKKwly
ZXQgPSBkcm1fbW1faW5zZXJ0X25vZGVfaW5fcmFuZ2UobW0sICZub2RlLT5tbV9ub2Rlc1swXSwK
KwkJCQkJICBtZW0tPm51bV9wYWdlcywgYm8tPnBhZ2VfYWxpZ25tZW50LCAwLAogCQkJCQkgIHBs
YWNlLT5mcGZuLCBscGZuLCBtb2RlKTsKIAlzcGluX3VubG9jaygmcm1hbi0+bG9jayk7CiAKIAlp
ZiAodW5saWtlbHkocmV0KSkgewogCQlrZnJlZShub2RlKTsKIAl9IGVsc2UgewotCQltZW0tPm1t
X25vZGUgPSBub2RlOwotCQltZW0tPnN0YXJ0ID0gbm9kZS0+c3RhcnQ7CisJCW1lbS0+bW1fbm9k
ZSA9ICZub2RlLT5tbV9ub2Rlc1swXTsKKwkJbWVtLT5zdGFydCA9IG5vZGUtPm1tX25vZGVzWzBd
LnN0YXJ0OwogCX0KIAogCXJldHVybiByZXQ7CkBAIC05OCwxNSArMTAxLDE5IEBAIHN0YXRpYyB2
b2lkIHR0bV9yYW5nZV9tYW5fZnJlZShzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiwK
IAkJCSAgICAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0pCiB7CiAJc3RydWN0IHR0bV9yYW5n
ZV9tYW5hZ2VyICpybWFuID0gdG9fcmFuZ2VfbWFuYWdlcihtYW4pOworCXN0cnVjdCB0dG1fcmFu
Z2VfbWdyX25vZGUgKm5vZGU7CiAKLQlpZiAobWVtLT5tbV9ub2RlKSB7Ci0JCXNwaW5fbG9jaygm
cm1hbi0+bG9jayk7Ci0JCWRybV9tbV9yZW1vdmVfbm9kZShtZW0tPm1tX25vZGUpOwotCQlzcGlu
X3VubG9jaygmcm1hbi0+bG9jayk7CisJaWYgKCFtZW0tPm1tX25vZGUpCisJCXJldHVybjsKIAot
CQlrZnJlZShtZW0tPm1tX25vZGUpOwotCQltZW0tPm1tX25vZGUgPSBOVUxMOwotCX0KKwlub2Rl
ID0gdG9fdHRtX3JhbmdlX21ncl9ub2RlKG1lbSk7CisKKwlzcGluX2xvY2soJnJtYW4tPmxvY2sp
OworCWRybV9tbV9yZW1vdmVfbm9kZSgmbm9kZS0+bW1fbm9kZXNbMF0pOworCXNwaW5fdW5sb2Nr
KCZybWFuLT5sb2NrKTsKKworCWtmcmVlKG5vZGUpOworCW1lbS0+bW1fbm9kZSA9IE5VTEw7CiB9
CiAKIHN0YXRpYyB2b2lkIHR0bV9yYW5nZV9tYW5fZGVidWcoc3RydWN0IHR0bV9yZXNvdXJjZV9t
YW5hZ2VyICptYW4sCkBAIC0xMjUsNiArMTMyLDE3IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdHRt
X3Jlc291cmNlX21hbmFnZXJfZnVuYyB0dG1fcmFuZ2VfbWFuYWdlcl9mdW5jID0gewogCS5kZWJ1
ZyA9IHR0bV9yYW5nZV9tYW5fZGVidWcKIH07CiAKKy8qKgorICogdHRtX3JhbmdlX21hbl9pbml0
CisgKgorICogQGJkZXY6IHR0bSBkZXZpY2UKKyAqIEB0eXBlOiBtZW1vcnkgbWFuYWdlciB0eXBl
CisgKiBAdXNlX3R0OiBpZiB0aGUgbWVtb3J5IG1hbmFnZXIgdXNlcyB0dAorICogQHBfc2l6ZTog
c2l6ZSBvZiBhcmVhIHRvIGJlIG1hbmFnZWQgaW4gcGFnZXMuCisgKgorICogSW5pdGlhbGlzZSBh
IGdlbmVyaWMgcmFuZ2UgbWFuYWdlciBmb3IgdGhlIHNlbGVjdGVkIG1lbW9yeSB0eXBlLgorICog
VGhlIHJhbmdlIG1hbmFnZXIgaXMgaW5zdGFsbGVkIGZvciB0aGlzIGRldmljZSBpbiB0aGUgdHlw
ZSBzbG90LgorICovCiBpbnQgdHRtX3JhbmdlX21hbl9pbml0KHN0cnVjdCB0dG1fZGV2aWNlICpi
ZGV2LAogCQkgICAgICAgdW5zaWduZWQgdHlwZSwgYm9vbCB1c2VfdHQsCiAJCSAgICAgICB1bnNp
Z25lZCBsb25nIHBfc2l6ZSkKQEAgLTE1Miw2ICsxNzAsMTQgQEAgaW50IHR0bV9yYW5nZV9tYW5f
aW5pdChzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwKIH0KIEVYUE9SVF9TWU1CT0wodHRtX3Jhbmdl
X21hbl9pbml0KTsKIAorLyoqCisgKiB0dG1fcmFuZ2VfbWFuX2ZpbmkKKyAqCisgKiBAYmRldjog
dHRtIGRldmljZQorICogQHR5cGU6IG1lbW9yeSBtYW5hZ2VyIHR5cGUKKyAqCisgKiBSZW1vdmUg
dGhlIGdlbmVyaWMgcmFuZ2UgbWFuYWdlciBmcm9tIGEgc2xvdCBhbmQgdGVhciBpdCBkb3duLgor
ICovCiBpbnQgdHRtX3JhbmdlX21hbl9maW5pKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LAogCQkg
ICAgICAgdW5zaWduZWQgdHlwZSkKIHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90dG0v
dHRtX3Jlc291cmNlLmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9yZXNvdXJjZS5jCmluZGV4
IDdlYmNjM2U2ODE4Yy4uYjQxMmFlNTE1ZTk4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
dHRtL3R0bV9yZXNvdXJjZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3Jlc291cmNl
LmMKQEAgLTI1LDE2ICsyNSwxMCBAQAogI2luY2x1ZGUgPGRybS90dG0vdHRtX3Jlc291cmNlLmg+
CiAjaW5jbHVkZSA8ZHJtL3R0bS90dG1fYm9fZHJpdmVyLmg+CiAKLWludCB0dG1fcmVzb3VyY2Vf
YWxsb2Moc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKLQkJICAgICAgIGNvbnN0IHN0cnVj
dCB0dG1fcGxhY2UgKnBsYWNlLAotCQkgICAgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqKnJlc19w
dHIpCit2b2lkIHR0bV9yZXNvdXJjZV9pbml0KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8s
CisgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCB0dG1fcGxhY2UgKnBsYWNlLAor
ICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlICpyZXMpCiB7Ci0Jc3Ry
dWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYW4gPQotCQl0dG1fbWFuYWdlcl90eXBlKGJvLT5i
ZGV2LCBwbGFjZS0+bWVtX3R5cGUpOwotCXN0cnVjdCB0dG1fcmVzb3VyY2UgKnJlczsKLQlpbnQg
cjsKLQotCXJlcyA9IGttYWxsb2Moc2l6ZW9mKCpyZXMpLCBHRlBfS0VSTkVMKTsKIAlyZXMtPm1t
X25vZGUgPSBOVUxMOwogCXJlcy0+c3RhcnQgPSAwOwogCXJlcy0+bnVtX3BhZ2VzID0gUEZOX1VQ
KGJvLT5iYXNlLnNpemUpOwpAQCAtNDQsNiArMzgsMjAgQEAgaW50IHR0bV9yZXNvdXJjZV9hbGxv
YyhzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCXJlcy0+YnVzLm9mZnNldCA9IDA7CiAJ
cmVzLT5idXMuaXNfaW9tZW0gPSBmYWxzZTsKIAlyZXMtPmJ1cy5jYWNoaW5nID0gdHRtX2NhY2hl
ZDsKK30KK0VYUE9SVF9TWU1CT0wodHRtX3Jlc291cmNlX2luaXQpOworCitpbnQgdHRtX3Jlc291
cmNlX2FsbG9jKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCisJCSAgICAgICBjb25zdCBz
dHJ1Y3QgdHRtX3BsYWNlICpwbGFjZSwKKwkJICAgICAgIHN0cnVjdCB0dG1fcmVzb3VyY2UgKipy
ZXNfcHRyKQoreworCXN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuID0KKwkJdHRtX21h
bmFnZXJfdHlwZShiby0+YmRldiwgcGxhY2UtPm1lbV90eXBlKTsKKwlzdHJ1Y3QgdHRtX3Jlc291
cmNlICpyZXM7CisJaW50IHI7CisKKwlyZXMgPSBrbWFsbG9jKHNpemVvZigqcmVzKSwgR0ZQX0tF
Uk5FTCk7CisJdHRtX3Jlc291cmNlX2luaXQoYm8sIHBsYWNlLCByZXMpOwogCXIgPSBtYW4tPmZ1
bmMtPmFsbG9jKG1hbiwgYm8sIHBsYWNlLCByZXMpOwogCWlmIChyKSB7CiAJCWtmcmVlKHJlcyk7
CmRpZmYgLS1naXQgYS9pbmNsdWRlL2RybS90dG0vdHRtX2JvX2RyaXZlci5oIGIvaW5jbHVkZS9k
cm0vdHRtL3R0bV9ib19kcml2ZXIuaAppbmRleCBlYWQwZWY3MTM2YzguLmIyNjY5NzFjMTk3NCAx
MDA2NDQKLS0tIGEvaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19kcml2ZXIuaAorKysgYi9pbmNsdWRl
L2RybS90dG0vdHRtX2JvX2RyaXZlci5oCkBAIC0zMDQsMzAgKzMwNCw0IEBAIGludCB0dG1fYm9f
dHRfYmluZChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLCBzdHJ1Y3QgdHRtX3Jlc291cmNl
ICptZW0pOwogICovCiB2b2lkIHR0bV9ib190dF9kZXN0cm95KHN0cnVjdCB0dG1fYnVmZmVyX29i
amVjdCAqYm8pOwogCi0vKioKLSAqIHR0bV9yYW5nZV9tYW5faW5pdAotICoKLSAqIEBiZGV2OiB0
dG0gZGV2aWNlCi0gKiBAdHlwZTogbWVtb3J5IG1hbmFnZXIgdHlwZQotICogQHVzZV90dDogaWYg
dGhlIG1lbW9yeSBtYW5hZ2VyIHVzZXMgdHQKLSAqIEBwX3NpemU6IHNpemUgb2YgYXJlYSB0byBi
ZSBtYW5hZ2VkIGluIHBhZ2VzLgotICoKLSAqIEluaXRpYWxpc2UgYSBnZW5lcmljIHJhbmdlIG1h
bmFnZXIgZm9yIHRoZSBzZWxlY3RlZCBtZW1vcnkgdHlwZS4KLSAqIFRoZSByYW5nZSBtYW5hZ2Vy
IGlzIGluc3RhbGxlZCBmb3IgdGhpcyBkZXZpY2UgaW4gdGhlIHR5cGUgc2xvdC4KLSAqLwotaW50
IHR0bV9yYW5nZV9tYW5faW5pdChzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwKLQkJICAgICAgIHVu
c2lnbmVkIHR5cGUsIGJvb2wgdXNlX3R0LAotCQkgICAgICAgdW5zaWduZWQgbG9uZyBwX3NpemUp
OwotCi0vKioKLSAqIHR0bV9yYW5nZV9tYW5fZmluaQotICoKLSAqIEBiZGV2OiB0dG0gZGV2aWNl
Ci0gKiBAdHlwZTogbWVtb3J5IG1hbmFnZXIgdHlwZQotICoKLSAqIFJlbW92ZSB0aGUgZ2VuZXJp
YyByYW5nZSBtYW5hZ2VyIGZyb20gYSBzbG90IGFuZCB0ZWFyIGl0IGRvd24uCi0gKi8KLWludCB0
dG1fcmFuZ2VfbWFuX2Zpbmkoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsCi0JCSAgICAgICB1bnNp
Z25lZCB0eXBlKTsKLQogI2VuZGlmCmRpZmYgLS1naXQgYS9pbmNsdWRlL2RybS90dG0vdHRtX3Jh
bmdlX21hbmFnZXIuaCBiL2luY2x1ZGUvZHJtL3R0bS90dG1fcmFuZ2VfbWFuYWdlci5oCm5ldyBm
aWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uZTAyYjZjOGQzNTVlCi0tLSAvZGV2
L251bGwKKysrIGIvaW5jbHVkZS9kcm0vdHRtL3R0bV9yYW5nZV9tYW5hZ2VyLmgKQEAgLTAsMCAr
MSw0MyBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAgT1IgTUlUICovCisK
KyNpZm5kZWYgX1RUTV9SQU5HRV9NQU5BR0VSX0hfCisjZGVmaW5lIF9UVE1fUkFOR0VfTUFOQUdF
Ul9IXworCisjaW5jbHVkZSA8ZHJtL3R0bS90dG1fcmVzb3VyY2UuaD4KKyNpbmNsdWRlIDxkcm0v
ZHJtX21tLmg+CisKKy8qKgorICogc3RydWN0IHR0bV9yYW5nZV9tZ3Jfbm9kZQorICoKKyAqIEBi
YXNlOiBiYXNlIGNsYXNlIHdlIGV4dGVuZAorICogQG1tX25vZGVzOiBNTSBub2RlcywgdXN1YWxs
eSAxCisgKgorICogRXh0ZW5kaW5nIHRoZSB0dG1fcmVzb3VyY2Ugb2JqZWN0IHRvIG1hbmFnZSBh
biBhZGRyZXNzIHNwYWNlIGFsbG9jYXRpb24gd2l0aAorICogb25lIG9yIG1vcmUgZHJtX21tX25v
ZGVzLgorICovCitzdHJ1Y3QgdHRtX3JhbmdlX21ncl9ub2RlIHsKKwlzdHJ1Y3QgdHRtX3Jlc291
cmNlIGJhc2U7CisJc3RydWN0IGRybV9tbV9ub2RlIG1tX25vZGVzW107Cit9OworCisvKioKKyAq
IHRvX3R0bV9yYW5nZV9tZ3Jfbm9kZQorICoKKyAqIEByZXM6IHRoZSByZXNvdXJjZSB0byB1cGNh
c3QKKyAqCisgKiBVcGNhc3QgdGhlIHR0bV9yZXNvdXJjZSBvYmplY3QgaW50byBhIHR0bV9yYW5n
ZV9tZ3Jfbm9kZSBvYmplY3QuCisgKi8KK3N0YXRpYyBpbmxpbmUgc3RydWN0IHR0bV9yYW5nZV9t
Z3Jfbm9kZSAqCit0b190dG1fcmFuZ2VfbWdyX25vZGUoc3RydWN0IHR0bV9yZXNvdXJjZSAqcmVz
KQoreworCXJldHVybiBjb250YWluZXJfb2YocmVzLT5tbV9ub2RlLCBzdHJ1Y3QgdHRtX3Jhbmdl
X21ncl9ub2RlLAorCQkJICAgIG1tX25vZGVzWzFdKTsKK30KKworaW50IHR0bV9yYW5nZV9tYW5f
aW5pdChzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwKKwkJICAgICAgIHVuc2lnbmVkIHR5cGUsIGJv
b2wgdXNlX3R0LAorCQkgICAgICAgdW5zaWduZWQgbG9uZyBwX3NpemUpOworaW50IHR0bV9yYW5n
ZV9tYW5fZmluaShzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwKKwkJICAgICAgIHVuc2lnbmVkIHR5
cGUpOworCisjZW5kaWYKZGlmZiAtLWdpdCBhL2luY2x1ZGUvZHJtL3R0bS90dG1fcmVzb3VyY2Uu
aCBiL2luY2x1ZGUvZHJtL3R0bS90dG1fcmVzb3VyY2UuaAppbmRleCBjMTdjMWE1MjA3MGQuLjgw
M2U0ODc1ZDc3OSAxMDA2NDQKLS0tIGEvaW5jbHVkZS9kcm0vdHRtL3R0bV9yZXNvdXJjZS5oCisr
KyBiL2luY2x1ZGUvZHJtL3R0bS90dG1fcmVzb3VyY2UuaApAQCAtMjIzLDYgKzIyMyw5IEBAIHR0
bV9yZXNvdXJjZV9tYW5hZ2VyX2NsZWFudXAoc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICpt
YW4pCiAJbWFuLT5tb3ZlID0gTlVMTDsKIH0KIAordm9pZCB0dG1fcmVzb3VyY2VfaW5pdChzdHJ1
Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAorICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBz
dHJ1Y3QgdHRtX3BsYWNlICpwbGFjZSwKKyAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHR0
bV9yZXNvdXJjZSAqcmVzKTsKIGludCB0dG1fcmVzb3VyY2VfYWxsb2Moc3RydWN0IHR0bV9idWZm
ZXJfb2JqZWN0ICpibywKIAkJICAgICAgIGNvbnN0IHN0cnVjdCB0dG1fcGxhY2UgKnBsYWNlLAog
CQkgICAgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqKnJlcyk7Ci0tIAoyLjI1LjEKCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5n
IGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVk
ZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbAo=
