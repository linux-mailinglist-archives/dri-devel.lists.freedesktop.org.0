Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 838A46EF86
	for <lists+dri-devel@lfdr.de>; Sat, 20 Jul 2019 15:47:30 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6D07F6E8B6;
	Sat, 20 Jul 2019 13:47:27 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from smtp.domeneshop.no (smtp.domeneshop.no
 [IPv6:2a01:5b40:0:3005::1])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 61F516E8B5
 for <dri-devel@lists.freedesktop.org>; Sat, 20 Jul 2019 13:47:19 +0000 (UTC)
Received: from 211.81-166-168.customer.lyse.net ([81.166.168.211]:56672
 helo=localhost.localdomain)
 by smtp.domeneshop.no with esmtpsa (TLS1.2:ECDHE_RSA_AES_128_CBC_SHA1:128)
 (Exim 4.84_2) (envelope-from <noralf@tronnes.org>)
 id 1hophl-0003FR-87; Sat, 20 Jul 2019 15:47:17 +0200
From: =?UTF-8?q?Noralf=20Tr=C3=B8nnes?= <noralf@tronnes.org>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 2/6] drm/tinydrm: Rename variable mipi -> dbi
Date: Sat, 20 Jul 2019 15:47:05 +0200
Message-Id: <20190720134709.15186-3-noralf@tronnes.org>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190720134709.15186-1-noralf@tronnes.org>
References: <20190720134709.15186-1-noralf@tronnes.org>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; d=tronnes.org; s=ds201810; 
 h=Content-Transfer-Encoding:Content-Type:MIME-Version:References:In-Reply-To:Message-Id:Date:Subject:Cc:To:From;
 bh=hLwuZcgdfWiF9MGMhYp8XwsuEtdTXqHfDbXRCH8nsOU=; 
 b=QaAktGtWQ9uyMU6v4yHuIJPZhGLiciYwc5+1+iXCazVrdl7LNDFSPOyEHoZcg7Giefjo5afcRTnA7Cya6SRhNj+G6ySBRXesWKnLw3JLFkNjEy2sTX8MW1qt70ufqIRLU8bbdipD9ewZWEgCRHSRnuLpfymZn09+BVDZbLcEdaQj58m6nGfZiI8PIssoqJXWyZ3pPYdWxmn0NLN918raI+1i+rEoq23RxsXZR6XfZ/sg+NEwtyIHU6HgrBNReQrHv/psAT8yYXG/J7zWEp2RkoryWLEwR8cLqUXCkxmIsNs3xEr0bGdp/tw3L9mFSIyScT1SfhlOiFKRJYOuR1uOLQ==;
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: david@lechnology.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

c3RydWN0IG1pcGlfZGJpIGlzIGdvaW5nIHRvIGJlIHNwbGl0IGludG8gYW4gaW50ZXJmYWNlIHBh
cnQgYW5kIGEgZGlzcGxheQpwaXBlbGluZSBwYXJ0LiBUaGUgaW50ZXJmYWNlIHBhcnQgY2FuIGJl
IHVzZWQgYnkgZHJpdmVycyB0aGF0IG5lZWQgdG8KaW5pdGlhbGl6ZSB0aGUgY29udHJvbGxlciwg
YnV0IHRoYXQgd29uJ3QgdXBsb2FkIHRoZSBmcmFtZWJ1ZmZlciBvdmVyCnRoaXMgaW50ZXJmYWNl
LgoKdGlueWRybSB1c2VzIHRoZSB2YXJpYWJsZSBuYW1lICdtaXBpJyBidXQgdGhpcyBpcyBub3Qg
YSBnb29kIG5hbWUgc2luY2UKTUlQSSByZWZlcnMgdG8gYSBsb3Qgb2Ygc3RhbmRhcmRzLiBUaGlz
IHBhdGNoIGNoYW5nZXMgdGhlIHZhcmlhYmxlIG5hbWUKdG8gJ2RiaScgd2hlcmUgaXQgcmVmZXJz
IHRvIHRoZSBpbnRlcmZhY2UgcGFydCBvZiBzdHJ1Y3QgbWlwaV9kYmkuCgpGdW5jdGlvbnMgdGhh
dCB1c2UgYm90aCBmdXR1cmUgcGFydHMgd2lsbCBoYXZlIGJvdGggdmFyaWFibGVzIHRlbXBvcmFy
aWx5CnBvaW50aW5nIHRvIHRoZSBzYW1lIHN0cnVjdHVyZS4KCkNjOiBFcmljIEFuaG9sdCA8ZXJp
Y0BhbmhvbHQubmV0PgpDYzogRGF2aWQgTGVjaG5lciA8ZGF2aWRAbGVjaG5vbG9neS5jb20+ClNp
Z25lZC1vZmYtYnk6IE5vcmFsZiBUcsO4bm5lcyA8bm9yYWxmQHRyb25uZXMub3JnPgotLS0KIGRy
aXZlcnMvZ3B1L2RybS90aW55ZHJtL2h4ODM1N2QuYyAgfCAgMzEgKysrLS0tCiBkcml2ZXJzL2dw
dS9kcm0vdGlueWRybS9pbGk5MjI1LmMgIHwgMTM1ICsrKysrKysrKysrKystLS0tLS0tLS0tLS0K
IGRyaXZlcnMvZ3B1L2RybS90aW55ZHJtL2lsaTkzNDEuYyAgfCAgNTUgKysrKysrLS0tLS0KIGRy
aXZlcnMvZ3B1L2RybS90aW55ZHJtL21pMDI4M3F0LmMgfCAgNTUgKysrKysrLS0tLS0KIGRyaXZl
cnMvZ3B1L2RybS90aW55ZHJtL21pcGktZGJpLmMgfCAxNTMgKysrKysrKysrKysrKysrLS0tLS0t
LS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS90aW55ZHJtL3N0NzU4Ni5jICAgfCAgNjIgKysrKysr
LS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vdGlueWRybS9zdDc3MzVyLmMgIHwgIDQ5ICsrKystLS0t
LQogaW5jbHVkZS9kcm0vdGlueWRybS9taXBpLWRiaS5oICAgICB8ICAyMCArKy0tCiA4IGZpbGVz
IGNoYW5nZWQsIDI5MSBpbnNlcnRpb25zKCspLCAyNjkgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL3Rpbnlkcm0vaHg4MzU3ZC5jIGIvZHJpdmVycy9ncHUvZHJtL3Rp
bnlkcm0vaHg4MzU3ZC5jCmluZGV4IDdkMmRmYTkyYjY2MS4uZjUwM2QxNGFhMzZiIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vdGlueWRybS9oeDgzNTdkLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL3Rpbnlkcm0vaHg4MzU3ZC5jCkBAIC00OCw2ICs0OCw3IEBAIHN0YXRpYyB2b2lkIHl4MjQw
cXYyOV9lbmFibGUoc3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBlLAogCQkJICAg
ICBzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKIHsKIAlzdHJ1Y3QgbWlwaV9k
YmkgKm1pcGkgPSBkcm1fdG9fbWlwaV9kYmkocGlwZS0+Y3J0Yy5kZXYpOworCXN0cnVjdCBtaXBp
X2RiaSAqZGJpID0gbWlwaTsKIAl1OCBhZGRyX21vZGU7CiAJaW50IHJldCwgaWR4OwogCkBAIC02
MywyMiArNjQsMjIgQEAgc3RhdGljIHZvaWQgeXgyNDBxdjI5X2VuYWJsZShzdHJ1Y3QgZHJtX3Np
bXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCiAJCWdvdG8gb3V0X2VuYWJsZTsKIAogCS8qIHNldGV4
dGMgKi8KLQltaXBpX2RiaV9jb21tYW5kKG1pcGksIEhYODM1N0RfU0VURVhUQywgMHhGRiwgMHg4
MywgMHg1Nyk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIEhYODM1N0RfU0VURVhUQywgMHhGRiwg
MHg4MywgMHg1Nyk7CiAJbXNsZWVwKDE1MCk7CiAKIAkvKiBzZXRSR0Igd2hpY2ggYWxzbyBlbmFi
bGVzIFNETyAqLwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgSFg4MzU3RF9TRVRSR0IsIDB4MDAs
IDB4MDAsIDB4MDYsIDB4MDYpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBIWDgzNTdEX1NFVFJH
QiwgMHgwMCwgMHgwMCwgMHgwNiwgMHgwNik7CiAKIAkvKiAtMS41MlYgKi8KLQltaXBpX2RiaV9j
b21tYW5kKG1pcGksIEhYODM1N0RfU0VUQ09NLCAweDI1KTsKKwltaXBpX2RiaV9jb21tYW5kKGRi
aSwgSFg4MzU3RF9TRVRDT00sIDB4MjUpOwogCiAJLyogTm9ybWFsIG1vZGUgNzBIeiwgSWRsZSBt
b2RlIDU1IEh6ICovCi0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBIWDgzNTdEX1NFVE9TQywgMHg2
OCk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIEhYODM1N0RfU0VUT1NDLCAweDY4KTsKIAogCS8q
IFNldCBQYW5lbCAtIEJHUiwgR2F0ZSBkaXJlY3Rpb24gc3dhcHBlZCAqLwotCW1pcGlfZGJpX2Nv
bW1hbmQobWlwaSwgSFg4MzU3RF9TRVRQQU5FTCwgMHgwNSk7CisJbWlwaV9kYmlfY29tbWFuZChk
YmksIEhYODM1N0RfU0VUUEFORUwsIDB4MDUpOwogCi0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBI
WDgzNTdEX1NFVFBPV0VSLAorCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBIWDgzNTdEX1NFVFBPV0VS
LAogCQkJIDB4MDAsICAvKiBOb3QgZGVlcCBzdGFuZGJ5ICovCiAJCQkgMHgxNSwgIC8qIEJUICov
CiAJCQkgMHgxQywgIC8qIFZTUFIgKi8KQEAgLTg2LDcgKzg3LDcgQEAgc3RhdGljIHZvaWQgeXgy
NDBxdjI5X2VuYWJsZShzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCiAJCQkg
MHg4MywgIC8qIEFQICovCiAJCQkgMHhBQSk7ICAvKiBGUyAqLwogCi0JbWlwaV9kYmlfY29tbWFu
ZChtaXBpLCBIWDgzNTdEX1NFVFNUQkEsCisJbWlwaV9kYmlfY29tbWFuZChkYmksIEhYODM1N0Rf
U0VUU1RCQSwKIAkJCSAweDUwLCAgLyogT1BPTiBub3JtYWwgKi8KIAkJCSAweDUwLCAgLyogT1BP
TiBpZGxlICovCiAJCQkgMHgwMSwgIC8qIFNUQkEgKi8KQEAgLTk0LDcgKzk1LDcgQEAgc3RhdGlj
IHZvaWQgeXgyNDBxdjI5X2VuYWJsZShzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBp
cGUsCiAJCQkgMHgxRSwgIC8qIFNUQkEgKi8KIAkJCSAweDA4KTsgIC8qIEdFTiAqLwogCi0JbWlw
aV9kYmlfY29tbWFuZChtaXBpLCBIWDgzNTdEX1NFVENZQywKKwltaXBpX2RiaV9jb21tYW5kKGRi
aSwgSFg4MzU3RF9TRVRDWUMsCiAJCQkgMHgwMiwgIC8qIE5XIDB4MDIgKi8KIAkJCSAweDQwLCAg
LyogUlROICovCiAJCQkgMHgwMCwgIC8qIERJViAqLwpAQCAtMTAzLDcgKzEwNCw3IEBAIHN0YXRp
YyB2b2lkIHl4MjQwcXYyOV9lbmFibGUoc3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpw
aXBlLAogCQkJIDB4MEQsICAvKiBHRE9OICovCiAJCQkgMHg3OCk7ICAvKiBHRE9GRiAqLwogCi0J
bWlwaV9kYmlfY29tbWFuZChtaXBpLCBIWDgzNTdEX1NFVEdBTU1BLAorCW1pcGlfZGJpX2NvbW1h
bmQoZGJpLCBIWDgzNTdEX1NFVEdBTU1BLAogCQkJIDB4MDIsCiAJCQkgMHgwQSwKIAkJCSAweDEx
LApAQCAtMTQwLDIxICsxNDEsMjEgQEAgc3RhdGljIHZvaWQgeXgyNDBxdjI5X2VuYWJsZShzdHJ1
Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCiAJCQkgMHgwMSk7CiAKIAkvKiAxNiBi
aXQgKi8KLQltaXBpX2RiaV9jb21tYW5kKG1pcGksIE1JUElfRENTX1NFVF9QSVhFTF9GT1JNQVQs
CisJbWlwaV9kYmlfY29tbWFuZChkYmksIE1JUElfRENTX1NFVF9QSVhFTF9GT1JNQVQsCiAJCQkg
TUlQSV9EQ1NfUElYRUxfRk1UXzE2QklUKTsKIAogCS8qIFRFIG9mZiAqLwotCW1pcGlfZGJpX2Nv
bW1hbmQobWlwaSwgTUlQSV9EQ1NfU0VUX1RFQVJfT04sIDB4MDApOworCW1pcGlfZGJpX2NvbW1h
bmQoZGJpLCBNSVBJX0RDU19TRVRfVEVBUl9PTiwgMHgwMCk7CiAKIAkvKiB0ZWFyIGxpbmUgKi8K
LQltaXBpX2RiaV9jb21tYW5kKG1pcGksIE1JUElfRENTX1NFVF9URUFSX1NDQU5MSU5FLCAweDAw
LCAweDAyKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgTUlQSV9EQ1NfU0VUX1RFQVJfU0NBTkxJ
TkUsIDB4MDAsIDB4MDIpOwogCiAJLyogRXhpdCBTbGVlcCAqLwotCW1pcGlfZGJpX2NvbW1hbmQo
bWlwaSwgTUlQSV9EQ1NfRVhJVF9TTEVFUF9NT0RFKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwg
TUlQSV9EQ1NfRVhJVF9TTEVFUF9NT0RFKTsKIAltc2xlZXAoMTUwKTsKIAogCS8qIGRpc3BsYXkg
b24gKi8KLQltaXBpX2RiaV9jb21tYW5kKG1pcGksIE1JUElfRENTX1NFVF9ESVNQTEFZX09OKTsK
KwltaXBpX2RiaV9jb21tYW5kKGRiaSwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlfT04pOwogCXVzbGVl
cF9yYW5nZSg1MDAwLCA3MDAwKTsKIAogb3V0X2VuYWJsZToKQEAgLTE3Miw3ICsxNzMsNyBAQCBz
dGF0aWMgdm9pZCB5eDI0MHF2MjlfZW5hYmxlKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlw
ZSAqcGlwZSwKIAkJYWRkcl9tb2RlID0gSFg4MzU3RF9NQURDVExfTVYgfCBIWDgzNTdEX01BRENU
TF9NWDsKIAkJYnJlYWs7CiAJfQotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgTUlQSV9EQ1NfU0VU
X0FERFJFU1NfTU9ERSwgYWRkcl9tb2RlKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgTUlQSV9E
Q1NfU0VUX0FERFJFU1NfTU9ERSwgYWRkcl9tb2RlKTsKIAltaXBpX2RiaV9lbmFibGVfZmx1c2go
bWlwaSwgY3J0Y19zdGF0ZSwgcGxhbmVfc3RhdGUpOwogb3V0X2V4aXQ6CiAJZHJtX2Rldl9leGl0
KGlkeCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdGlueWRybS9pbGk5MjI1LmMgYi9k
cml2ZXJzL2dwdS9kcm0vdGlueWRybS9pbGk5MjI1LmMKaW5kZXggNjJmMjliMmZhZjc0Li5jODM3
ZDE0MjMzNjIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS90aW55ZHJtL2lsaTkyMjUuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vdGlueWRybS9pbGk5MjI1LmMKQEAgLTY4LDExICs2OCwxMSBA
QAogI2RlZmluZSBJTEk5MjI1X0dBTU1BX0NPTlRST0xfOQkJMHg1OAogI2RlZmluZSBJTEk5MjI1
X0dBTU1BX0NPTlRST0xfMTAJMHg1OQogCi1zdGF0aWMgaW5saW5lIGludCBpbGk5MjI1X2NvbW1h
bmQoc3RydWN0IG1pcGlfZGJpICptaXBpLCB1OCBjbWQsIHUxNiBkYXRhKQorc3RhdGljIGlubGlu
ZSBpbnQgaWxpOTIyNV9jb21tYW5kKHN0cnVjdCBtaXBpX2RiaSAqZGJpLCB1OCBjbWQsIHUxNiBk
YXRhKQogewogCXU4IHBhclsyXSA9IHsgZGF0YSA+PiA4LCBkYXRhICYgMHhmZiB9OwogCi0JcmV0
dXJuIG1pcGlfZGJpX2NvbW1hbmRfYnVmKG1pcGksIGNtZCwgcGFyLCAyKTsKKwlyZXR1cm4gbWlw
aV9kYmlfY29tbWFuZF9idWYoZGJpLCBjbWQsIHBhciwgMik7CiB9CiAKIHN0YXRpYyB2b2lkIGls
aTkyMjVfZmJfZGlydHkoc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIsIHN0cnVjdCBkcm1fcmVj
dCAqcmVjdCkKQEAgLTgxLDcgKzgxLDggQEAgc3RhdGljIHZvaWQgaWxpOTIyNV9mYl9kaXJ0eShz
dHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwgc3RydWN0IGRybV9yZWN0ICpyZWN0KQogCXN0cnVj
dCBtaXBpX2RiaSAqbWlwaSA9IGRybV90b19taXBpX2RiaShmYi0+ZGV2KTsKIAl1bnNpZ25lZCBp
bnQgaGVpZ2h0ID0gcmVjdC0+eTIgLSByZWN0LT55MTsKIAl1bnNpZ25lZCBpbnQgd2lkdGggPSBy
ZWN0LT54MiAtIHJlY3QtPngxOwotCWJvb2wgc3dhcCA9IG1pcGktPnN3YXBfYnl0ZXM7CisJc3Ry
dWN0IG1pcGlfZGJpICpkYmkgPSBtaXBpOworCWJvb2wgc3dhcCA9IGRiaS0+c3dhcF9ieXRlczsK
IAl1MTYgeF9zdGFydCwgeV9zdGFydDsKIAl1MTYgeDEsIHgyLCB5MSwgeTI7CiAJaW50IGlkeCwg
cmV0ID0gMDsKQEAgLTk4LDcgKzk5LDcgQEAgc3RhdGljIHZvaWQgaWxpOTIyNV9mYl9kaXJ0eShz
dHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwgc3RydWN0IGRybV9yZWN0ICpyZWN0KQogCiAJRFJN
X0RFQlVHX0tNUygiRmx1c2hpbmcgW0ZCOiVkXSAiIERSTV9SRUNUX0ZNVCAiXG4iLCBmYi0+YmFz
ZS5pZCwgRFJNX1JFQ1RfQVJHKHJlY3QpKTsKIAotCWlmICghbWlwaS0+ZGMgfHwgIWZ1bGwgfHwg
c3dhcCB8fAorCWlmICghZGJpLT5kYyB8fCAhZnVsbCB8fCBzd2FwIHx8CiAJICAgIGZiLT5mb3Jt
YXQtPmZvcm1hdCA9PSBEUk1fRk9STUFUX1hSR0I4ODg4KSB7CiAJCXRyID0gbWlwaS0+dHhfYnVm
OwogCQlyZXQgPSBtaXBpX2RiaV9idWZfY29weShtaXBpLT50eF9idWYsIGZiLCByZWN0LCBzd2Fw
KTsKQEAgLTE0MywxNSArMTQ0LDE1IEBAIHN0YXRpYyB2b2lkIGlsaTkyMjVfZmJfZGlydHkoc3Ry
dWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIsIHN0cnVjdCBkcm1fcmVjdCAqcmVjdCkKIAkJYnJlYWs7
CiAJfQogCi0JaWxpOTIyNV9jb21tYW5kKG1pcGksIElMSTkyMjVfSE9SSVpfV0lORE9XX0FERFJf
MSwgeDIpOwotCWlsaTkyMjVfY29tbWFuZChtaXBpLCBJTEk5MjI1X0hPUklaX1dJTkRPV19BRERS
XzIsIHgxKTsKLQlpbGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9WRVJUX1dJTkRPV19BRERS
XzEsIHkyKTsKLQlpbGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9WRVJUX1dJTkRPV19BRERS
XzIsIHkxKTsKKwlpbGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X0hPUklaX1dJTkRPV19BRERS
XzEsIHgyKTsKKwlpbGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X0hPUklaX1dJTkRPV19BRERS
XzIsIHgxKTsKKwlpbGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X1ZFUlRfV0lORE9XX0FERFJf
MSwgeTIpOworCWlsaTkyMjVfY29tbWFuZChkYmksIElMSTkyMjVfVkVSVF9XSU5ET1dfQUREUl8y
LCB5MSk7CiAKLQlpbGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9SQU1fQUREUkVTU19TRVRf
MSwgeF9zdGFydCk7Ci0JaWxpOTIyNV9jb21tYW5kKG1pcGksIElMSTkyMjVfUkFNX0FERFJFU1Nf
U0VUXzIsIHlfc3RhcnQpOworCWlsaTkyMjVfY29tbWFuZChkYmksIElMSTkyMjVfUkFNX0FERFJF
U1NfU0VUXzEsIHhfc3RhcnQpOworCWlsaTkyMjVfY29tbWFuZChkYmksIElMSTkyMjVfUkFNX0FE
RFJFU1NfU0VUXzIsIHlfc3RhcnQpOwogCi0JcmV0ID0gbWlwaV9kYmlfY29tbWFuZF9idWYobWlw
aSwgSUxJOTIyNV9XUklURV9EQVRBX1RPX0dSQU0sIHRyLAorCXJldCA9IG1pcGlfZGJpX2NvbW1h
bmRfYnVmKGRiaSwgSUxJOTIyNV9XUklURV9EQVRBX1RPX0dSQU0sIHRyLAogCQkJCSAgIHdpZHRo
ICogaGVpZ2h0ICogMik7CiBlcnJfbXNnOgogCWlmIChyZXQpCkBAIC0xODUsNiArMTg2LDcgQEAg
c3RhdGljIHZvaWQgaWxpOTIyNV9waXBlX2VuYWJsZShzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5
X3BpcGUgKnBpcGUsCiAJc3RydWN0IG1pcGlfZGJpICptaXBpID0gZHJtX3RvX21pcGlfZGJpKHBp
cGUtPmNydGMuZGV2KTsKIAlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHBsYW5lX3N0YXRl
LT5mYjsKIAlzdHJ1Y3QgZGV2aWNlICpkZXYgPSBwaXBlLT5jcnRjLmRldi0+ZGV2OworCXN0cnVj
dCBtaXBpX2RiaSAqZGJpID0gbWlwaTsKIAlzdHJ1Y3QgZHJtX3JlY3QgcmVjdCA9IHsKIAkJLngx
ID0gMCwKIAkJLngyID0gZmItPndpZHRoLApAQCAtMTk5LDcgKzIwMSw3IEBAIHN0YXRpYyB2b2lk
IGlsaTkyMjVfcGlwZV9lbmFibGUoc3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBl
LAogCiAJRFJNX0RFQlVHX0tNUygiXG4iKTsKIAotCW1pcGlfZGJpX2h3X3Jlc2V0KG1pcGkpOwor
CW1pcGlfZGJpX2h3X3Jlc2V0KGRiaSk7CiAKIAkvKgogCSAqIFRoZXJlIGRvbid0IHNlZW0gdG8g
YmUgdHdvIGV4YW1wbGUgaW5pdCBzZXF1ZW5jZXMgdGhhdCBtYXRjaCwgc28KQEAgLTIwNywyNyAr
MjA5LDI3IEBAIHN0YXRpYyB2b2lkIGlsaTkyMjVfcGlwZV9lbmFibGUoc3RydWN0IGRybV9zaW1w
bGVfZGlzcGxheV9waXBlICpwaXBlLAogCSAqIGh0dHBzOi8vZ2l0aHViLmNvbS9Oa2F3dS9URlRf
MjJfSUxJOTIyNS9ibG9iL21hc3Rlci9zcmMvVEZUXzIyX0lMSTkyMjUuY3BwCiAJICovCiAKLQly
ZXQgPSBpbGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9QT1dFUl9DT05UUk9MXzEsIDB4MDAw
MCk7CisJcmV0ID0gaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9QT1dFUl9DT05UUk9MXzEs
IDB4MDAwMCk7CiAJaWYgKHJldCkgewogCQlEUk1fREVWX0VSUk9SKGRldiwgIkVycm9yIHNlbmRp
bmcgY29tbWFuZCAlZFxuIiwgcmV0KTsKIAkJZ290byBvdXRfZXhpdDsKIAl9Ci0JaWxpOTIyNV9j
b21tYW5kKG1pcGksIElMSTkyMjVfUE9XRVJfQ09OVFJPTF8yLCAweDAwMDApOwotCWlsaTkyMjVf
Y29tbWFuZChtaXBpLCBJTEk5MjI1X1BPV0VSX0NPTlRST0xfMywgMHgwMDAwKTsKLQlpbGk5MjI1
X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9QT1dFUl9DT05UUk9MXzQsIDB4MDAwMCk7Ci0JaWxpOTIy
NV9jb21tYW5kKG1pcGksIElMSTkyMjVfUE9XRVJfQ09OVFJPTF81LCAweDAwMDApOworCWlsaTky
MjVfY29tbWFuZChkYmksIElMSTkyMjVfUE9XRVJfQ09OVFJPTF8yLCAweDAwMDApOworCWlsaTky
MjVfY29tbWFuZChkYmksIElMSTkyMjVfUE9XRVJfQ09OVFJPTF8zLCAweDAwMDApOworCWlsaTky
MjVfY29tbWFuZChkYmksIElMSTkyMjVfUE9XRVJfQ09OVFJPTF80LCAweDAwMDApOworCWlsaTky
MjVfY29tbWFuZChkYmksIElMSTkyMjVfUE9XRVJfQ09OVFJPTF81LCAweDAwMDApOwogCiAJbXNs
ZWVwKDQwKTsKIAotCWlsaTkyMjVfY29tbWFuZChtaXBpLCBJTEk5MjI1X1BPV0VSX0NPTlRST0xf
MiwgMHgwMDE4KTsKLQlpbGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9QT1dFUl9DT05UUk9M
XzMsIDB4NjEyMSk7Ci0JaWxpOTIyNV9jb21tYW5kKG1pcGksIElMSTkyMjVfUE9XRVJfQ09OVFJP
TF80LCAweDAwNmYpOwotCWlsaTkyMjVfY29tbWFuZChtaXBpLCBJTEk5MjI1X1BPV0VSX0NPTlRS
T0xfNSwgMHg0OTVmKTsKLQlpbGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9QT1dFUl9DT05U
Uk9MXzEsIDB4MDgwMCk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9QT1dFUl9DT05U
Uk9MXzIsIDB4MDAxOCk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9QT1dFUl9DT05U
Uk9MXzMsIDB4NjEyMSk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9QT1dFUl9DT05U
Uk9MXzQsIDB4MDA2Zik7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9QT1dFUl9DT05U
Uk9MXzUsIDB4NDk1Zik7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9QT1dFUl9DT05U
Uk9MXzEsIDB4MDgwMCk7CiAKIAltc2xlZXAoMTApOwogCi0JaWxpOTIyNV9jb21tYW5kKG1pcGks
IElMSTkyMjVfUE9XRVJfQ09OVFJPTF8yLCAweDEwM2IpOworCWlsaTkyMjVfY29tbWFuZChkYmks
IElMSTkyMjVfUE9XRVJfQ09OVFJPTF8yLCAweDEwM2IpOwogCiAJbXNsZWVwKDUwKTsKIApAQCAt
MjQ1LDQxICsyNDcsNDEgQEAgc3RhdGljIHZvaWQgaWxpOTIyNV9waXBlX2VuYWJsZShzdHJ1Y3Qg
ZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCiAJCWFtX2lkID0gMHgyODsKIAkJYnJlYWs7
CiAJfQotCWlsaTkyMjVfY29tbWFuZChtaXBpLCBJTEk5MjI1X0RSSVZFUl9PVVRQVVRfQ09OVFJP
TCwgMHgwMTFjKTsKLQlpbGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9MQ0RfQUNfRFJJVklO
R19DT05UUk9MLCAweDAxMDApOwotCWlsaTkyMjVfY29tbWFuZChtaXBpLCBJTEk5MjI1X0VOVFJZ
X01PREUsIDB4MTAwMCB8IGFtX2lkKTsKLQlpbGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9E
SVNQTEFZX0NPTlRST0xfMSwgMHgwMDAwKTsKLQlpbGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIy
NV9CTEFOS19QRVJJT0RfQ09OVFJPTF8xLCAweDA4MDgpOwotCWlsaTkyMjVfY29tbWFuZChtaXBp
LCBJTEk5MjI1X0ZSQU1FX0NZQ0xFX0NPTlRST0wsIDB4MTEwMCk7Ci0JaWxpOTIyNV9jb21tYW5k
KG1pcGksIElMSTkyMjVfSU5URVJGQUNFX0NPTlRST0wsIDB4MDAwMCk7Ci0JaWxpOTIyNV9jb21t
YW5kKG1pcGksIElMSTkyMjVfT1NDSUxMQVRJT05fQ09OVFJPTCwgMHgwZDAxKTsKLQlpbGk5MjI1
X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9WQ0lfUkVDWUNMSU5HLCAweDAwMjApOwotCWlsaTkyMjVf
Y29tbWFuZChtaXBpLCBJTEk5MjI1X1JBTV9BRERSRVNTX1NFVF8xLCAweDAwMDApOwotCWlsaTky
MjVfY29tbWFuZChtaXBpLCBJTEk5MjI1X1JBTV9BRERSRVNTX1NFVF8yLCAweDAwMDApOworCWls
aTkyMjVfY29tbWFuZChkYmksIElMSTkyMjVfRFJJVkVSX09VVFBVVF9DT05UUk9MLCAweDAxMWMp
OworCWlsaTkyMjVfY29tbWFuZChkYmksIElMSTkyMjVfTENEX0FDX0RSSVZJTkdfQ09OVFJPTCwg
MHgwMTAwKTsKKwlpbGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X0VOVFJZX01PREUsIDB4MTAw
MCB8IGFtX2lkKTsKKwlpbGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X0RJU1BMQVlfQ09OVFJP
TF8xLCAweDAwMDApOworCWlsaTkyMjVfY29tbWFuZChkYmksIElMSTkyMjVfQkxBTktfUEVSSU9E
X0NPTlRST0xfMSwgMHgwODA4KTsKKwlpbGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X0ZSQU1F
X0NZQ0xFX0NPTlRST0wsIDB4MTEwMCk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9J
TlRFUkZBQ0VfQ09OVFJPTCwgMHgwMDAwKTsKKwlpbGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1
X09TQ0lMTEFUSU9OX0NPTlRST0wsIDB4MGQwMSk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJ
OTIyNV9WQ0lfUkVDWUNMSU5HLCAweDAwMjApOworCWlsaTkyMjVfY29tbWFuZChkYmksIElMSTky
MjVfUkFNX0FERFJFU1NfU0VUXzEsIDB4MDAwMCk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJ
OTIyNV9SQU1fQUREUkVTU19TRVRfMiwgMHgwMDAwKTsKIAotCWlsaTkyMjVfY29tbWFuZChtaXBp
LCBJTEk5MjI1X0dBVEVfU0NBTl9DT05UUk9MLCAweDAwMDApOwotCWlsaTkyMjVfY29tbWFuZCht
aXBpLCBJTEk5MjI1X1ZFUlRJQ0FMX1NDUk9MTF8xLCAweDAwZGIpOwotCWlsaTkyMjVfY29tbWFu
ZChtaXBpLCBJTEk5MjI1X1ZFUlRJQ0FMX1NDUk9MTF8yLCAweDAwMDApOwotCWlsaTkyMjVfY29t
bWFuZChtaXBpLCBJTEk5MjI1X1ZFUlRJQ0FMX1NDUk9MTF8zLCAweDAwMDApOwotCWlsaTkyMjVf
Y29tbWFuZChtaXBpLCBJTEk5MjI1X1BBUlRJQUxfRFJJVklOR19QT1NfMSwgMHgwMGRiKTsKLQlp
bGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9QQVJUSUFMX0RSSVZJTkdfUE9TXzIsIDB4MDAw
MCk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9HQVRFX1NDQU5fQ09OVFJPTCwgMHgw
MDAwKTsKKwlpbGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X1ZFUlRJQ0FMX1NDUk9MTF8xLCAw
eDAwZGIpOworCWlsaTkyMjVfY29tbWFuZChkYmksIElMSTkyMjVfVkVSVElDQUxfU0NST0xMXzIs
IDB4MDAwMCk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9WRVJUSUNBTF9TQ1JPTExf
MywgMHgwMDAwKTsKKwlpbGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X1BBUlRJQUxfRFJJVklO
R19QT1NfMSwgMHgwMGRiKTsKKwlpbGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X1BBUlRJQUxf
RFJJVklOR19QT1NfMiwgMHgwMDAwKTsKIAotCWlsaTkyMjVfY29tbWFuZChtaXBpLCBJTEk5MjI1
X0dBTU1BX0NPTlRST0xfMSwgMHgwMDAwKTsKLQlpbGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIy
NV9HQU1NQV9DT05UUk9MXzIsIDB4MDgwOCk7Ci0JaWxpOTIyNV9jb21tYW5kKG1pcGksIElMSTky
MjVfR0FNTUFfQ09OVFJPTF8zLCAweDA4MGEpOwotCWlsaTkyMjVfY29tbWFuZChtaXBpLCBJTEk5
MjI1X0dBTU1BX0NPTlRST0xfNCwgMHgwMDBhKTsKLQlpbGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJ
OTIyNV9HQU1NQV9DT05UUk9MXzUsIDB4MGEwOCk7Ci0JaWxpOTIyNV9jb21tYW5kKG1pcGksIElM
STkyMjVfR0FNTUFfQ09OVFJPTF82LCAweDA4MDgpOwotCWlsaTkyMjVfY29tbWFuZChtaXBpLCBJ
TEk5MjI1X0dBTU1BX0NPTlRST0xfNywgMHgwMDAwKTsKLQlpbGk5MjI1X2NvbW1hbmQobWlwaSwg
SUxJOTIyNV9HQU1NQV9DT05UUk9MXzgsIDB4MGEwMCk7Ci0JaWxpOTIyNV9jb21tYW5kKG1pcGks
IElMSTkyMjVfR0FNTUFfQ09OVFJPTF85LCAweDA3MTApOwotCWlsaTkyMjVfY29tbWFuZChtaXBp
LCBJTEk5MjI1X0dBTU1BX0NPTlRST0xfMTAsIDB4MDcxMCk7CisJaWxpOTIyNV9jb21tYW5kKGRi
aSwgSUxJOTIyNV9HQU1NQV9DT05UUk9MXzEsIDB4MDAwMCk7CisJaWxpOTIyNV9jb21tYW5kKGRi
aSwgSUxJOTIyNV9HQU1NQV9DT05UUk9MXzIsIDB4MDgwOCk7CisJaWxpOTIyNV9jb21tYW5kKGRi
aSwgSUxJOTIyNV9HQU1NQV9DT05UUk9MXzMsIDB4MDgwYSk7CisJaWxpOTIyNV9jb21tYW5kKGRi
aSwgSUxJOTIyNV9HQU1NQV9DT05UUk9MXzQsIDB4MDAwYSk7CisJaWxpOTIyNV9jb21tYW5kKGRi
aSwgSUxJOTIyNV9HQU1NQV9DT05UUk9MXzUsIDB4MGEwOCk7CisJaWxpOTIyNV9jb21tYW5kKGRi
aSwgSUxJOTIyNV9HQU1NQV9DT05UUk9MXzYsIDB4MDgwOCk7CisJaWxpOTIyNV9jb21tYW5kKGRi
aSwgSUxJOTIyNV9HQU1NQV9DT05UUk9MXzcsIDB4MDAwMCk7CisJaWxpOTIyNV9jb21tYW5kKGRi
aSwgSUxJOTIyNV9HQU1NQV9DT05UUk9MXzgsIDB4MGEwMCk7CisJaWxpOTIyNV9jb21tYW5kKGRi
aSwgSUxJOTIyNV9HQU1NQV9DT05UUk9MXzksIDB4MDcxMCk7CisJaWxpOTIyNV9jb21tYW5kKGRi
aSwgSUxJOTIyNV9HQU1NQV9DT05UUk9MXzEwLCAweDA3MTApOwogCi0JaWxpOTIyNV9jb21tYW5k
KG1pcGksIElMSTkyMjVfRElTUExBWV9DT05UUk9MXzEsIDB4MDAxMik7CisJaWxpOTIyNV9jb21t
YW5kKGRiaSwgSUxJOTIyNV9ESVNQTEFZX0NPTlRST0xfMSwgMHgwMDEyKTsKIAogCW1zbGVlcCg1
MCk7CiAKLQlpbGk5MjI1X2NvbW1hbmQobWlwaSwgSUxJOTIyNV9ESVNQTEFZX0NPTlRST0xfMSwg
MHgxMDE3KTsKKwlpbGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X0RJU1BMQVlfQ09OVFJPTF8x
LCAweDEwMTcpOwogCiAJbWlwaS0+ZW5hYmxlZCA9IHRydWU7CiAJaWxpOTIyNV9mYl9kaXJ0eShm
YiwgJnJlY3QpOwpAQCAtMjkwLDYgKzI5Miw3IEBAIHN0YXRpYyB2b2lkIGlsaTkyMjVfcGlwZV9l
bmFibGUoc3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBlLAogc3RhdGljIHZvaWQg
aWxpOTIyNV9waXBlX2Rpc2FibGUoc3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBl
KQogewogCXN0cnVjdCBtaXBpX2RiaSAqbWlwaSA9IGRybV90b19taXBpX2RiaShwaXBlLT5jcnRj
LmRldik7CisJc3RydWN0IG1pcGlfZGJpICpkYmkgPSBtaXBpOwogCiAJRFJNX0RFQlVHX0tNUygi
XG4iKTsKIApAQCAtMzAzLDMzICszMDYsMzMgQEAgc3RhdGljIHZvaWQgaWxpOTIyNV9waXBlX2Rp
c2FibGUoc3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBlKQogCWlmICghbWlwaS0+
ZW5hYmxlZCkKIAkJcmV0dXJuOwogCi0JaWxpOTIyNV9jb21tYW5kKG1pcGksIElMSTkyMjVfRElT
UExBWV9DT05UUk9MXzEsIDB4MDAwMCk7CisJaWxpOTIyNV9jb21tYW5kKGRiaSwgSUxJOTIyNV9E
SVNQTEFZX0NPTlRST0xfMSwgMHgwMDAwKTsKIAltc2xlZXAoNTApOwotCWlsaTkyMjVfY29tbWFu
ZChtaXBpLCBJTEk5MjI1X1BPV0VSX0NPTlRST0xfMiwgMHgwMDA3KTsKKwlpbGk5MjI1X2NvbW1h
bmQoZGJpLCBJTEk5MjI1X1BPV0VSX0NPTlRST0xfMiwgMHgwMDA3KTsKIAltc2xlZXAoNTApOwot
CWlsaTkyMjVfY29tbWFuZChtaXBpLCBJTEk5MjI1X1BPV0VSX0NPTlRST0xfMSwgMHgwYTAyKTsK
KwlpbGk5MjI1X2NvbW1hbmQoZGJpLCBJTEk5MjI1X1BPV0VSX0NPTlRST0xfMSwgMHgwYTAyKTsK
IAogCW1pcGktPmVuYWJsZWQgPSBmYWxzZTsKIH0KIAotc3RhdGljIGludCBpbGk5MjI1X2RiaV9j
b21tYW5kKHN0cnVjdCBtaXBpX2RiaSAqbWlwaSwgdTggKmNtZCwgdTggKnBhciwKK3N0YXRpYyBp
bnQgaWxpOTIyNV9kYmlfY29tbWFuZChzdHJ1Y3QgbWlwaV9kYmkgKmRiaSwgdTggKmNtZCwgdTgg
KnBhciwKIAkJCSAgICAgICBzaXplX3QgbnVtKQogewotCXN0cnVjdCBzcGlfZGV2aWNlICpzcGkg
PSBtaXBpLT5zcGk7CisJc3RydWN0IHNwaV9kZXZpY2UgKnNwaSA9IGRiaS0+c3BpOwogCXVuc2ln
bmVkIGludCBicHcgPSA4OwogCXUzMiBzcGVlZF9oejsKIAlpbnQgcmV0OwogCi0JZ3Bpb2Rfc2V0
X3ZhbHVlX2NhbnNsZWVwKG1pcGktPmRjLCAwKTsKKwlncGlvZF9zZXRfdmFsdWVfY2Fuc2xlZXAo
ZGJpLT5kYywgMCk7CiAJc3BlZWRfaHogPSBtaXBpX2RiaV9zcGlfY21kX21heF9zcGVlZChzcGks
IDEpOwogCXJldCA9IG1pcGlfZGJpX3NwaV90cmFuc2ZlcihzcGksIHNwZWVkX2h6LCA4LCBjbWQs
IDEpOwogCWlmIChyZXQgfHwgIW51bSkKIAkJcmV0dXJuIHJldDsKIAotCWlmICgqY21kID09IElM
STkyMjVfV1JJVEVfREFUQV9UT19HUkFNICYmICFtaXBpLT5zd2FwX2J5dGVzKQorCWlmICgqY21k
ID09IElMSTkyMjVfV1JJVEVfREFUQV9UT19HUkFNICYmICFkYmktPnN3YXBfYnl0ZXMpCiAJCWJw
dyA9IDE2OwogCi0JZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKG1pcGktPmRjLCAxKTsKKwlncGlv
ZF9zZXRfdmFsdWVfY2Fuc2xlZXAoZGJpLT5kYywgMSk7CiAJc3BlZWRfaHogPSBtaXBpX2RiaV9z
cGlfY21kX21heF9zcGVlZChzcGksIG51bSk7CiAKIAlyZXR1cm4gbWlwaV9kYmlfc3BpX3RyYW5z
ZmVyKHNwaSwgc3BlZWRfaHosIGJwdywgcGFyLCBudW0pOwpAQCAtMzc3LDYgKzM4MCw3IEBAIHN0
YXRpYyBpbnQgaWxpOTIyNV9wcm9iZShzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpKQogCXN0cnVjdCBk
ZXZpY2UgKmRldiA9ICZzcGktPmRldjsKIAlzdHJ1Y3QgZHJtX2RldmljZSAqZHJtOwogCXN0cnVj
dCBtaXBpX2RiaSAqbWlwaTsKKwlzdHJ1Y3QgbWlwaV9kYmkgKmRiaTsKIAlzdHJ1Y3QgZ3Bpb19k
ZXNjICpyczsKIAl1MzIgcm90YXRpb24gPSAwOwogCWludCByZXQ7CkBAIC0zODUsNiArMzg5LDcg
QEAgc3RhdGljIGludCBpbGk5MjI1X3Byb2JlKHN0cnVjdCBzcGlfZGV2aWNlICpzcGkpCiAJaWYg
KCFtaXBpKQogCQlyZXR1cm4gLUVOT01FTTsKIAorCWRiaSA9IG1pcGk7CiAJZHJtID0gJm1pcGkt
PmRybTsKIAlyZXQgPSBkZXZtX2RybV9kZXZfaW5pdChkZXYsIGRybSwgJmlsaTkyMjVfZHJpdmVy
KTsKIAlpZiAocmV0KSB7CkBAIC0zOTQsMTAgKzM5OSwxMCBAQCBzdGF0aWMgaW50IGlsaTkyMjVf
cHJvYmUoc3RydWN0IHNwaV9kZXZpY2UgKnNwaSkKIAogCWRybV9tb2RlX2NvbmZpZ19pbml0KGRy
bSk7CiAKLQltaXBpLT5yZXNldCA9IGRldm1fZ3Bpb2RfZ2V0KGRldiwgInJlc2V0IiwgR1BJT0Rf
T1VUX0hJR0gpOwotCWlmIChJU19FUlIobWlwaS0+cmVzZXQpKSB7CisJZGJpLT5yZXNldCA9IGRl
dm1fZ3Bpb2RfZ2V0KGRldiwgInJlc2V0IiwgR1BJT0RfT1VUX0hJR0gpOworCWlmIChJU19FUlIo
ZGJpLT5yZXNldCkpIHsKIAkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8gZ2V0IGdwaW8g
J3Jlc2V0J1xuIik7Ci0JCXJldHVybiBQVFJfRVJSKG1pcGktPnJlc2V0KTsKKwkJcmV0dXJuIFBU
Ul9FUlIoZGJpLT5yZXNldCk7CiAJfQogCiAJcnMgPSBkZXZtX2dwaW9kX2dldChkZXYsICJycyIs
IEdQSU9EX09VVF9MT1cpOwpAQCAtNDA4LDEyICs0MTMsMTIgQEAgc3RhdGljIGludCBpbGk5MjI1
X3Byb2JlKHN0cnVjdCBzcGlfZGV2aWNlICpzcGkpCiAKIAlkZXZpY2VfcHJvcGVydHlfcmVhZF91
MzIoZGV2LCAicm90YXRpb24iLCAmcm90YXRpb24pOwogCi0JcmV0ID0gbWlwaV9kYmlfc3BpX2lu
aXQoc3BpLCBtaXBpLCBycyk7CisJcmV0ID0gbWlwaV9kYmlfc3BpX2luaXQoc3BpLCBkYmksIHJz
KTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCiAJLyogb3ZlcnJpZGUgdGhlIGNvbW1hbmQg
ZnVuY3Rpb24gc2V0IGluICBtaXBpX2RiaV9zcGlfaW5pdCgpICovCi0JbWlwaS0+Y29tbWFuZCA9
IGlsaTkyMjVfZGJpX2NvbW1hbmQ7CisJZGJpLT5jb21tYW5kID0gaWxpOTIyNV9kYmlfY29tbWFu
ZDsKIAogCXJldCA9IG1pcGlfZGJpX2luaXQobWlwaSwgJmlsaTkyMjVfcGlwZV9mdW5jcywgJmls
aTkyMjVfbW9kZSwgcm90YXRpb24pOwogCWlmIChyZXQpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vdGlueWRybS9pbGk5MzQxLmMgYi9kcml2ZXJzL2dwdS9kcm0vdGlueWRybS9pbGk5MzQx
LmMKaW5kZXggY2IwYTBkZGJjMDkwLi4wNWJhNWFiMTdlYzYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS90aW55ZHJtL2lsaTkzNDEuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdGlueWRybS9p
bGk5MzQxLmMKQEAgLTU0LDYgKzU0LDcgQEAgc3RhdGljIHZvaWQgeXgyNDBxdjI5X2VuYWJsZShz
dHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCiAJCQkgICAgIHN0cnVjdCBkcm1f
cGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQogewogCXN0cnVjdCBtaXBpX2RiaSAqbWlwaSA9IGRy
bV90b19taXBpX2RiaShwaXBlLT5jcnRjLmRldik7CisJc3RydWN0IG1pcGlfZGJpICpkYmkgPSBt
aXBpOwogCXU4IGFkZHJfbW9kZTsKIAlpbnQgcmV0LCBpZHg7CiAKQEAgLTY4LDQ3ICs2OSw0NyBA
QCBzdGF0aWMgdm9pZCB5eDI0MHF2MjlfZW5hYmxlKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlf
cGlwZSAqcGlwZSwKIAlpZiAocmV0ID09IDEpCiAJCWdvdG8gb3V0X2VuYWJsZTsKIAotCW1pcGlf
ZGJpX2NvbW1hbmQobWlwaSwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlfT0ZGKTsKKwltaXBpX2RiaV9j
b21tYW5kKGRiaSwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlfT0ZGKTsKIAotCW1pcGlfZGJpX2NvbW1h
bmQobWlwaSwgSUxJOTM0MV9QV0NUUkxCLCAweDAwLCAweGMxLCAweDMwKTsKLQltaXBpX2RiaV9j
b21tYW5kKG1pcGksIElMSTkzNDFfUFdSU0VRLCAweDY0LCAweDAzLCAweDEyLCAweDgxKTsKLQlt
aXBpX2RiaV9jb21tYW5kKG1pcGksIElMSTkzNDFfRFRDVFJMQSwgMHg4NSwgMHgwMCwgMHg3OCk7
Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBJTEk5MzQxX1BXQ1RSTEEsIDB4MzksIDB4MmMsIDB4
MDAsIDB4MzQsIDB4MDIpOwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgSUxJOTM0MV9QVU1QQ1RS
TCwgMHgyMCk7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBJTEk5MzQxX0RUQ1RSTEIsIDB4MDAs
IDB4MDApOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5MzQxX1BXQ1RSTEIsIDB4MDAsIDB4
YzEsIDB4MzApOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5MzQxX1BXUlNFUSwgMHg2NCwg
MHgwMywgMHgxMiwgMHg4MSk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIElMSTkzNDFfRFRDVFJM
QSwgMHg4NSwgMHgwMCwgMHg3OCk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIElMSTkzNDFfUFdD
VFJMQSwgMHgzOSwgMHgyYywgMHgwMCwgMHgzNCwgMHgwMik7CisJbWlwaV9kYmlfY29tbWFuZChk
YmksIElMSTkzNDFfUFVNUENUUkwsIDB4MjApOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5
MzQxX0RUQ1RSTEIsIDB4MDAsIDB4MDApOwogCiAJLyogUG93ZXIgQ29udHJvbCAqLwotCW1pcGlf
ZGJpX2NvbW1hbmQobWlwaSwgSUxJOTM0MV9QV0NUUkwxLCAweDIzKTsKLQltaXBpX2RiaV9jb21t
YW5kKG1pcGksIElMSTkzNDFfUFdDVFJMMiwgMHgxMCk7CisJbWlwaV9kYmlfY29tbWFuZChkYmks
IElMSTkzNDFfUFdDVFJMMSwgMHgyMyk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIElMSTkzNDFf
UFdDVFJMMiwgMHgxMCk7CiAJLyogVkNPTSAqLwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgSUxJ
OTM0MV9WTUNUUkwxLCAweDNlLCAweDI4KTsKLQltaXBpX2RiaV9jb21tYW5kKG1pcGksIElMSTkz
NDFfVk1DVFJMMiwgMHg4Nik7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIElMSTkzNDFfVk1DVFJM
MSwgMHgzZSwgMHgyOCk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIElMSTkzNDFfVk1DVFJMMiwg
MHg4Nik7CiAKIAkvKiBNZW1vcnkgQWNjZXNzIENvbnRyb2wgKi8KLQltaXBpX2RiaV9jb21tYW5k
KG1pcGksIE1JUElfRENTX1NFVF9QSVhFTF9GT1JNQVQsIE1JUElfRENTX1BJWEVMX0ZNVF8xNkJJ
VCk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIE1JUElfRENTX1NFVF9QSVhFTF9GT1JNQVQsIE1J
UElfRENTX1BJWEVMX0ZNVF8xNkJJVCk7CiAKIAkvKiBGcmFtZSBSYXRlICovCi0JbWlwaV9kYmlf
Y29tbWFuZChtaXBpLCBJTEk5MzQxX0ZSTUNUUjEsIDB4MDAsIDB4MWIpOworCW1pcGlfZGJpX2Nv
bW1hbmQoZGJpLCBJTEk5MzQxX0ZSTUNUUjEsIDB4MDAsIDB4MWIpOwogCiAJLyogR2FtbWEgKi8K
LQltaXBpX2RiaV9jb21tYW5kKG1pcGksIElMSTkzNDFfRU4zR0FNLCAweDAwKTsKLQltaXBpX2Ri
aV9jb21tYW5kKG1pcGksIE1JUElfRENTX1NFVF9HQU1NQV9DVVJWRSwgMHgwMSk7Ci0JbWlwaV9k
YmlfY29tbWFuZChtaXBpLCBJTEk5MzQxX1BHQU1DVFJMLAorCW1pcGlfZGJpX2NvbW1hbmQoZGJp
LCBJTEk5MzQxX0VOM0dBTSwgMHgwMCk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIE1JUElfRENT
X1NFVF9HQU1NQV9DVVJWRSwgMHgwMSk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIElMSTkzNDFf
UEdBTUNUUkwsCiAJCQkgMHgwZiwgMHgzMSwgMHgyYiwgMHgwYywgMHgwZSwgMHgwOCwgMHg0ZSwg
MHhmMSwKIAkJCSAweDM3LCAweDA3LCAweDEwLCAweDAzLCAweDBlLCAweDA5LCAweDAwKTsKLQlt
aXBpX2RiaV9jb21tYW5kKG1pcGksIElMSTkzNDFfTkdBTUNUUkwsCisJbWlwaV9kYmlfY29tbWFu
ZChkYmksIElMSTkzNDFfTkdBTUNUUkwsCiAJCQkgMHgwMCwgMHgwZSwgMHgxNCwgMHgwMywgMHgx
MSwgMHgwNywgMHgzMSwgMHhjMSwKIAkJCSAweDQ4LCAweDA4LCAweDBmLCAweDBjLCAweDMxLCAw
eDM2LCAweDBmKTsKIAogCS8qIEREUkFNICovCi0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBJTEk5
MzQxX0VUTU9ELCAweDA3KTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgSUxJOTM0MV9FVE1PRCwg
MHgwNyk7CiAKIAkvKiBEaXNwbGF5ICovCi0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBJTEk5MzQx
X0RJU0NUUkwsIDB4MDgsIDB4ODIsIDB4MjcsIDB4MDApOwotCW1pcGlfZGJpX2NvbW1hbmQobWlw
aSwgTUlQSV9EQ1NfRVhJVF9TTEVFUF9NT0RFKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgSUxJ
OTM0MV9ESVNDVFJMLCAweDA4LCAweDgyLCAweDI3LCAweDAwKTsKKwltaXBpX2RiaV9jb21tYW5k
KGRiaSwgTUlQSV9EQ1NfRVhJVF9TTEVFUF9NT0RFKTsKIAltc2xlZXAoMTAwKTsKIAotCW1pcGlf
ZGJpX2NvbW1hbmQobWlwaSwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlfT04pOworCW1pcGlfZGJpX2Nv
bW1hbmQoZGJpLCBNSVBJX0RDU19TRVRfRElTUExBWV9PTik7CiAJbXNsZWVwKDEwMCk7CiAKIG91
dF9lbmFibGU6CkBAIC0xMjgsNyArMTI5LDcgQEAgc3RhdGljIHZvaWQgeXgyNDBxdjI5X2VuYWJs
ZShzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCiAJCWJyZWFrOwogCX0KIAlh
ZGRyX21vZGUgfD0gSUxJOTM0MV9NQURDVExfQkdSOwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwg
TUlQSV9EQ1NfU0VUX0FERFJFU1NfTU9ERSwgYWRkcl9tb2RlKTsKKwltaXBpX2RiaV9jb21tYW5k
KGRiaSwgTUlQSV9EQ1NfU0VUX0FERFJFU1NfTU9ERSwgYWRkcl9tb2RlKTsKIAltaXBpX2RiaV9l
bmFibGVfZmx1c2gobWlwaSwgY3J0Y19zdGF0ZSwgcGxhbmVfc3RhdGUpOwogb3V0X2V4aXQ6CiAJ
ZHJtX2Rldl9leGl0KGlkeCk7CkBAIC0xNzcsNiArMTc4LDcgQEAgc3RhdGljIGludCBpbGk5MzQx
X3Byb2JlKHN0cnVjdCBzcGlfZGV2aWNlICpzcGkpCiAJc3RydWN0IGRldmljZSAqZGV2ID0gJnNw
aS0+ZGV2OwogCXN0cnVjdCBkcm1fZGV2aWNlICpkcm07CiAJc3RydWN0IG1pcGlfZGJpICptaXBp
OworCXN0cnVjdCBtaXBpX2RiaSAqZGJpOwogCXN0cnVjdCBncGlvX2Rlc2MgKmRjOwogCXUzMiBy
b3RhdGlvbiA9IDA7CiAJaW50IHJldDsKQEAgLTE4NSw2ICsxODcsNyBAQCBzdGF0aWMgaW50IGls
aTkzNDFfcHJvYmUoc3RydWN0IHNwaV9kZXZpY2UgKnNwaSkKIAlpZiAoIW1pcGkpCiAJCXJldHVy
biAtRU5PTUVNOwogCisJZGJpID0gbWlwaTsKIAlkcm0gPSAmbWlwaS0+ZHJtOwogCXJldCA9IGRl
dm1fZHJtX2Rldl9pbml0KGRldiwgZHJtLCAmaWxpOTM0MV9kcml2ZXIpOwogCWlmIChyZXQpIHsK
QEAgLTE5NCwxMCArMTk3LDEwIEBAIHN0YXRpYyBpbnQgaWxpOTM0MV9wcm9iZShzdHJ1Y3Qgc3Bp
X2RldmljZSAqc3BpKQogCiAJZHJtX21vZGVfY29uZmlnX2luaXQoZHJtKTsKIAotCW1pcGktPnJl
c2V0ID0gZGV2bV9ncGlvZF9nZXRfb3B0aW9uYWwoZGV2LCAicmVzZXQiLCBHUElPRF9PVVRfSElH
SCk7Ci0JaWYgKElTX0VSUihtaXBpLT5yZXNldCkpIHsKKwlkYmktPnJlc2V0ID0gZGV2bV9ncGlv
ZF9nZXRfb3B0aW9uYWwoZGV2LCAicmVzZXQiLCBHUElPRF9PVVRfSElHSCk7CisJaWYgKElTX0VS
UihkYmktPnJlc2V0KSkgewogCQlEUk1fREVWX0VSUk9SKGRldiwgIkZhaWxlZCB0byBnZXQgZ3Bp
byAncmVzZXQnXG4iKTsKLQkJcmV0dXJuIFBUUl9FUlIobWlwaS0+cmVzZXQpOworCQlyZXR1cm4g
UFRSX0VSUihkYmktPnJlc2V0KTsKIAl9CiAKIAlkYyA9IGRldm1fZ3Bpb2RfZ2V0X29wdGlvbmFs
KGRldiwgImRjIiwgR1BJT0RfT1VUX0xPVyk7CkBAIC0yMTIsNyArMjE1LDcgQEAgc3RhdGljIGlu
dCBpbGk5MzQxX3Byb2JlKHN0cnVjdCBzcGlfZGV2aWNlICpzcGkpCiAKIAlkZXZpY2VfcHJvcGVy
dHlfcmVhZF91MzIoZGV2LCAicm90YXRpb24iLCAmcm90YXRpb24pOwogCi0JcmV0ID0gbWlwaV9k
Ymlfc3BpX2luaXQoc3BpLCBtaXBpLCBkYyk7CisJcmV0ID0gbWlwaV9kYmlfc3BpX2luaXQoc3Bp
LCBkYmksIGRjKTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vdGlueWRybS9taTAyODNxdC5jIGIvZHJpdmVycy9ncHUvZHJtL3Rpbnlkcm0v
bWkwMjgzcXQuYwppbmRleCBmMjFkNThkY2FhNWEuLmFkYzhjNDg3MmQzZiAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL3Rpbnlkcm0vbWkwMjgzcXQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
dGlueWRybS9taTAyODNxdC5jCkBAIC01Miw2ICs1Miw3IEBAIHN0YXRpYyB2b2lkIG1pMDI4M3F0
X2VuYWJsZShzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCiAJCQkgICAgc3Ry
dWN0IGRybV9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCiB7CiAJc3RydWN0IG1pcGlfZGJpICpt
aXBpID0gZHJtX3RvX21pcGlfZGJpKHBpcGUtPmNydGMuZGV2KTsKKwlzdHJ1Y3QgbWlwaV9kYmkg
KmRiaSA9IG1pcGk7CiAJdTggYWRkcl9tb2RlOwogCWludCByZXQsIGlkeDsKIApAQCAtNjYsNDcg
KzY3LDQ3IEBAIHN0YXRpYyB2b2lkIG1pMDI4M3F0X2VuYWJsZShzdHJ1Y3QgZHJtX3NpbXBsZV9k
aXNwbGF5X3BpcGUgKnBpcGUsCiAJaWYgKHJldCA9PSAxKQogCQlnb3RvIG91dF9lbmFibGU7CiAK
LQltaXBpX2RiaV9jb21tYW5kKG1pcGksIE1JUElfRENTX1NFVF9ESVNQTEFZX09GRik7CisJbWlw
aV9kYmlfY29tbWFuZChkYmksIE1JUElfRENTX1NFVF9ESVNQTEFZX09GRik7CiAKLQltaXBpX2Ri
aV9jb21tYW5kKG1pcGksIElMSTkzNDFfUFdDVFJMQiwgMHgwMCwgMHg4MywgMHgzMCk7Ci0JbWlw
aV9kYmlfY29tbWFuZChtaXBpLCBJTEk5MzQxX1BXUlNFUSwgMHg2NCwgMHgwMywgMHgxMiwgMHg4
MSk7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBJTEk5MzQxX0RUQ1RSTEEsIDB4ODUsIDB4MDEs
IDB4NzkpOwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgSUxJOTM0MV9QV0NUUkxBLCAweDM5LCAw
eDJjLCAweDAwLCAweDM0LCAweDAyKTsKLQltaXBpX2RiaV9jb21tYW5kKG1pcGksIElMSTkzNDFf
UFVNUENUUkwsIDB4MjApOwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgSUxJOTM0MV9EVENUUkxC
LCAweDAwLCAweDAwKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgSUxJOTM0MV9QV0NUUkxCLCAw
eDAwLCAweDgzLCAweDMwKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgSUxJOTM0MV9QV1JTRVEs
IDB4NjQsIDB4MDMsIDB4MTIsIDB4ODEpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5MzQx
X0RUQ1RSTEEsIDB4ODUsIDB4MDEsIDB4NzkpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5
MzQxX1BXQ1RSTEEsIDB4MzksIDB4MmMsIDB4MDAsIDB4MzQsIDB4MDIpOworCW1pcGlfZGJpX2Nv
bW1hbmQoZGJpLCBJTEk5MzQxX1BVTVBDVFJMLCAweDIwKTsKKwltaXBpX2RiaV9jb21tYW5kKGRi
aSwgSUxJOTM0MV9EVENUUkxCLCAweDAwLCAweDAwKTsKIAogCS8qIFBvd2VyIENvbnRyb2wgKi8K
LQltaXBpX2RiaV9jb21tYW5kKG1pcGksIElMSTkzNDFfUFdDVFJMMSwgMHgyNik7Ci0JbWlwaV9k
YmlfY29tbWFuZChtaXBpLCBJTEk5MzQxX1BXQ1RSTDIsIDB4MTEpOworCW1pcGlfZGJpX2NvbW1h
bmQoZGJpLCBJTEk5MzQxX1BXQ1RSTDEsIDB4MjYpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJ
TEk5MzQxX1BXQ1RSTDIsIDB4MTEpOwogCS8qIFZDT00gKi8KLQltaXBpX2RiaV9jb21tYW5kKG1p
cGksIElMSTkzNDFfVk1DVFJMMSwgMHgzNSwgMHgzZSk7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBp
LCBJTEk5MzQxX1ZNQ1RSTDIsIDB4YmUpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5MzQx
X1ZNQ1RSTDEsIDB4MzUsIDB4M2UpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJTEk5MzQxX1ZN
Q1RSTDIsIDB4YmUpOwogCiAJLyogTWVtb3J5IEFjY2VzcyBDb250cm9sICovCi0JbWlwaV9kYmlf
Y29tbWFuZChtaXBpLCBNSVBJX0RDU19TRVRfUElYRUxfRk9STUFULCBNSVBJX0RDU19QSVhFTF9G
TVRfMTZCSVQpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBNSVBJX0RDU19TRVRfUElYRUxfRk9S
TUFULCBNSVBJX0RDU19QSVhFTF9GTVRfMTZCSVQpOwogCiAJLyogRnJhbWUgUmF0ZSAqLwotCW1p
cGlfZGJpX2NvbW1hbmQobWlwaSwgSUxJOTM0MV9GUk1DVFIxLCAweDAwLCAweDFiKTsKKwltaXBp
X2RiaV9jb21tYW5kKGRiaSwgSUxJOTM0MV9GUk1DVFIxLCAweDAwLCAweDFiKTsKIAogCS8qIEdh
bW1hICovCi0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBJTEk5MzQxX0VOM0dBTSwgMHgwOCk7Ci0J
bWlwaV9kYmlfY29tbWFuZChtaXBpLCBNSVBJX0RDU19TRVRfR0FNTUFfQ1VSVkUsIDB4MDEpOwot
CW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgSUxJOTM0MV9QR0FNQ1RSTCwKKwltaXBpX2RiaV9jb21t
YW5kKGRiaSwgSUxJOTM0MV9FTjNHQU0sIDB4MDgpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBN
SVBJX0RDU19TRVRfR0FNTUFfQ1VSVkUsIDB4MDEpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBJ
TEk5MzQxX1BHQU1DVFJMLAogCQkgICAgICAgMHgxZiwgMHgxYSwgMHgxOCwgMHgwYSwgMHgwZiwg
MHgwNiwgMHg0NSwgMHg4NywKIAkJICAgICAgIDB4MzIsIDB4MGEsIDB4MDcsIDB4MDIsIDB4MDcs
IDB4MDUsIDB4MDApOwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgSUxJOTM0MV9OR0FNQ1RSTCwK
KwltaXBpX2RiaV9jb21tYW5kKGRiaSwgSUxJOTM0MV9OR0FNQ1RSTCwKIAkJICAgICAgIDB4MDAs
IDB4MjUsIDB4MjcsIDB4MDUsIDB4MTAsIDB4MDksIDB4M2EsIDB4NzgsCiAJCSAgICAgICAweDRk
LCAweDA1LCAweDE4LCAweDBkLCAweDM4LCAweDNhLCAweDFmKTsKIAogCS8qIEREUkFNICovCi0J
bWlwaV9kYmlfY29tbWFuZChtaXBpLCBJTEk5MzQxX0VUTU9ELCAweDA3KTsKKwltaXBpX2RiaV9j
b21tYW5kKGRiaSwgSUxJOTM0MV9FVE1PRCwgMHgwNyk7CiAKIAkvKiBEaXNwbGF5ICovCi0JbWlw
aV9kYmlfY29tbWFuZChtaXBpLCBJTEk5MzQxX0RJU0NUUkwsIDB4MGEsIDB4ODIsIDB4MjcsIDB4
MDApOwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgTUlQSV9EQ1NfRVhJVF9TTEVFUF9NT0RFKTsK
KwltaXBpX2RiaV9jb21tYW5kKGRiaSwgSUxJOTM0MV9ESVNDVFJMLCAweDBhLCAweDgyLCAweDI3
LCAweDAwKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgTUlQSV9EQ1NfRVhJVF9TTEVFUF9NT0RF
KTsKIAltc2xlZXAoMTAwKTsKIAotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgTUlQSV9EQ1NfU0VU
X0RJU1BMQVlfT04pOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBNSVBJX0RDU19TRVRfRElTUExB
WV9PTik7CiAJbXNsZWVwKDEwMCk7CiAKIG91dF9lbmFibGU6CkBAIC0xMzIsNyArMTMzLDcgQEAg
c3RhdGljIHZvaWQgbWkwMjgzcXRfZW5hYmxlKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlw
ZSAqcGlwZSwKIAkJYnJlYWs7CiAJfQogCWFkZHJfbW9kZSB8PSBJTEk5MzQxX01BRENUTF9CR1I7
Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBNSVBJX0RDU19TRVRfQUREUkVTU19NT0RFLCBhZGRy
X21vZGUpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBNSVBJX0RDU19TRVRfQUREUkVTU19NT0RF
LCBhZGRyX21vZGUpOwogCW1pcGlfZGJpX2VuYWJsZV9mbHVzaChtaXBpLCBjcnRjX3N0YXRlLCBw
bGFuZV9zdGF0ZSk7CiBvdXRfZXhpdDoKIAlkcm1fZGV2X2V4aXQoaWR4KTsKQEAgLTE4MSw2ICsx
ODIsNyBAQCBzdGF0aWMgaW50IG1pMDI4M3F0X3Byb2JlKHN0cnVjdCBzcGlfZGV2aWNlICpzcGkp
CiAJc3RydWN0IGRldmljZSAqZGV2ID0gJnNwaS0+ZGV2OwogCXN0cnVjdCBkcm1fZGV2aWNlICpk
cm07CiAJc3RydWN0IG1pcGlfZGJpICptaXBpOworCXN0cnVjdCBtaXBpX2RiaSAqZGJpOwogCXN0
cnVjdCBncGlvX2Rlc2MgKmRjOwogCXUzMiByb3RhdGlvbiA9IDA7CiAJaW50IHJldDsKQEAgLTE4
OSw2ICsxOTEsNyBAQCBzdGF0aWMgaW50IG1pMDI4M3F0X3Byb2JlKHN0cnVjdCBzcGlfZGV2aWNl
ICpzcGkpCiAJaWYgKCFtaXBpKQogCQlyZXR1cm4gLUVOT01FTTsKIAorCWRiaSA9IG1pcGk7CiAJ
ZHJtID0gJm1pcGktPmRybTsKIAlyZXQgPSBkZXZtX2RybV9kZXZfaW5pdChkZXYsIGRybSwgJm1p
MDI4M3F0X2RyaXZlcik7CiAJaWYgKHJldCkgewpAQCAtMTk4LDEwICsyMDEsMTAgQEAgc3RhdGlj
IGludCBtaTAyODNxdF9wcm9iZShzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpKQogCiAJZHJtX21vZGVf
Y29uZmlnX2luaXQoZHJtKTsKIAotCW1pcGktPnJlc2V0ID0gZGV2bV9ncGlvZF9nZXRfb3B0aW9u
YWwoZGV2LCAicmVzZXQiLCBHUElPRF9PVVRfSElHSCk7Ci0JaWYgKElTX0VSUihtaXBpLT5yZXNl
dCkpIHsKKwlkYmktPnJlc2V0ID0gZGV2bV9ncGlvZF9nZXRfb3B0aW9uYWwoZGV2LCAicmVzZXQi
LCBHUElPRF9PVVRfSElHSCk7CisJaWYgKElTX0VSUihkYmktPnJlc2V0KSkgewogCQlEUk1fREVW
X0VSUk9SKGRldiwgIkZhaWxlZCB0byBnZXQgZ3BpbyAncmVzZXQnXG4iKTsKLQkJcmV0dXJuIFBU
Ul9FUlIobWlwaS0+cmVzZXQpOworCQlyZXR1cm4gUFRSX0VSUihkYmktPnJlc2V0KTsKIAl9CiAK
IAlkYyA9IGRldm1fZ3Bpb2RfZ2V0X29wdGlvbmFsKGRldiwgImRjIiwgR1BJT0RfT1VUX0xPVyk7
CkBAIC0yMjAsNyArMjIzLDcgQEAgc3RhdGljIGludCBtaTAyODNxdF9wcm9iZShzdHJ1Y3Qgc3Bp
X2RldmljZSAqc3BpKQogCiAJZGV2aWNlX3Byb3BlcnR5X3JlYWRfdTMyKGRldiwgInJvdGF0aW9u
IiwgJnJvdGF0aW9uKTsKIAotCXJldCA9IG1pcGlfZGJpX3NwaV9pbml0KHNwaSwgbWlwaSwgZGMp
OworCXJldCA9IG1pcGlfZGJpX3NwaV9pbml0KHNwaSwgZGJpLCBkYyk7CiAJaWYgKHJldCkKIAkJ
cmV0dXJuIHJldDsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Rpbnlkcm0vbWlwaS1k
YmkuYyBiL2RyaXZlcnMvZ3B1L2RybS90aW55ZHJtL21pcGktZGJpLmMKaW5kZXggMzdhNzNiNGMw
Zjg1Li45M2I5YjNhYzU1NjggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS90aW55ZHJtL21p
cGktZGJpLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3Rpbnlkcm0vbWlwaS1kYmkuYwpAQCAtMTAw
LDE3ICsxMDAsMTcgQEAgc3RhdGljIGNvbnN0IHU4IG1pcGlfZGJpX2Rjc19yZWFkX2NvbW1hbmRz
W10gPSB7CiAJMCwgLyogc2VudGluZWwgKi8KIH07CiAKLXN0YXRpYyBib29sIG1pcGlfZGJpX2Nv
bW1hbmRfaXNfcmVhZChzdHJ1Y3QgbWlwaV9kYmkgKm1pcGksIHU4IGNtZCkKK3N0YXRpYyBib29s
IG1pcGlfZGJpX2NvbW1hbmRfaXNfcmVhZChzdHJ1Y3QgbWlwaV9kYmkgKmRiaSwgdTggY21kKQog
ewogCXVuc2lnbmVkIGludCBpOwogCi0JaWYgKCFtaXBpLT5yZWFkX2NvbW1hbmRzKQorCWlmICgh
ZGJpLT5yZWFkX2NvbW1hbmRzKQogCQlyZXR1cm4gZmFsc2U7CiAKIAlmb3IgKGkgPSAwOyBpIDwg
MHhmZjsgaSsrKSB7Ci0JCWlmICghbWlwaS0+cmVhZF9jb21tYW5kc1tpXSkKKwkJaWYgKCFkYmkt
PnJlYWRfY29tbWFuZHNbaV0pCiAJCQlyZXR1cm4gZmFsc2U7Ci0JCWlmIChjbWQgPT0gbWlwaS0+
cmVhZF9jb21tYW5kc1tpXSkKKwkJaWYgKGNtZCA9PSBkYmktPnJlYWRfY29tbWFuZHNbaV0pCiAJ
CQlyZXR1cm4gdHJ1ZTsKIAl9CiAKQEAgLTExOSw3ICsxMTksNyBAQCBzdGF0aWMgYm9vbCBtaXBp
X2RiaV9jb21tYW5kX2lzX3JlYWQoc3RydWN0IG1pcGlfZGJpICptaXBpLCB1OCBjbWQpCiAKIC8q
KgogICogbWlwaV9kYmlfY29tbWFuZF9yZWFkIC0gTUlQSSBEQ1MgcmVhZCBjb21tYW5kCi0gKiBA
bWlwaTogTUlQSSBzdHJ1Y3R1cmUKKyAqIEBkYmk6IE1JUEkgREJJIHN0cnVjdHVyZQogICogQGNt
ZDogQ29tbWFuZAogICogQHZhbDogVmFsdWUgcmVhZAogICoKQEAgLTEyOCwyMSArMTI4LDIxIEBA
IHN0YXRpYyBib29sIG1pcGlfZGJpX2NvbW1hbmRfaXNfcmVhZChzdHJ1Y3QgbWlwaV9kYmkgKm1p
cGksIHU4IGNtZCkKICAqIFJldHVybnM6CiAgKiBaZXJvIG9uIHN1Y2Nlc3MsIG5lZ2F0aXZlIGVy
cm9yIGNvZGUgb24gZmFpbHVyZS4KICAqLwotaW50IG1pcGlfZGJpX2NvbW1hbmRfcmVhZChzdHJ1
Y3QgbWlwaV9kYmkgKm1pcGksIHU4IGNtZCwgdTggKnZhbCkKK2ludCBtaXBpX2RiaV9jb21tYW5k
X3JlYWQoc3RydWN0IG1pcGlfZGJpICpkYmksIHU4IGNtZCwgdTggKnZhbCkKIHsKLQlpZiAoIW1p
cGktPnJlYWRfY29tbWFuZHMpCisJaWYgKCFkYmktPnJlYWRfY29tbWFuZHMpCiAJCXJldHVybiAt
RUFDQ0VTOwogCi0JaWYgKCFtaXBpX2RiaV9jb21tYW5kX2lzX3JlYWQobWlwaSwgY21kKSkKKwlp
ZiAoIW1pcGlfZGJpX2NvbW1hbmRfaXNfcmVhZChkYmksIGNtZCkpCiAJCXJldHVybiAtRUlOVkFM
OwogCi0JcmV0dXJuIG1pcGlfZGJpX2NvbW1hbmRfYnVmKG1pcGksIGNtZCwgdmFsLCAxKTsKKwly
ZXR1cm4gbWlwaV9kYmlfY29tbWFuZF9idWYoZGJpLCBjbWQsIHZhbCwgMSk7CiB9CiBFWFBPUlRf
U1lNQk9MKG1pcGlfZGJpX2NvbW1hbmRfcmVhZCk7CiAKIC8qKgogICogbWlwaV9kYmlfY29tbWFu
ZF9idWYgLSBNSVBJIERDUyBjb21tYW5kIHdpdGggcGFyYW1ldGVyKHMpIGluIGFuIGFycmF5Ci0g
KiBAbWlwaTogTUlQSSBzdHJ1Y3R1cmUKKyAqIEBkYmk6IE1JUEkgREJJIHN0cnVjdHVyZQogICog
QGNtZDogQ29tbWFuZAogICogQGRhdGE6IFBhcmFtZXRlciBidWZmZXIKICAqIEBsZW46IEJ1ZmZl
ciBsZW5ndGgKQEAgLTE1MCw3ICsxNTAsNyBAQCBFWFBPUlRfU1lNQk9MKG1pcGlfZGJpX2NvbW1h
bmRfcmVhZCk7CiAgKiBSZXR1cm5zOgogICogWmVybyBvbiBzdWNjZXNzLCBuZWdhdGl2ZSBlcnJv
ciBjb2RlIG9uIGZhaWx1cmUuCiAgKi8KLWludCBtaXBpX2RiaV9jb21tYW5kX2J1ZihzdHJ1Y3Qg
bWlwaV9kYmkgKm1pcGksIHU4IGNtZCwgdTggKmRhdGEsIHNpemVfdCBsZW4pCitpbnQgbWlwaV9k
YmlfY29tbWFuZF9idWYoc3RydWN0IG1pcGlfZGJpICpkYmksIHU4IGNtZCwgdTggKmRhdGEsIHNp
emVfdCBsZW4pCiB7CiAJdTggKmNtZGJ1ZjsKIAlpbnQgcmV0OwpAQCAtMTYwLDkgKzE2MCw5IEBA
IGludCBtaXBpX2RiaV9jb21tYW5kX2J1ZihzdHJ1Y3QgbWlwaV9kYmkgKm1pcGksIHU4IGNtZCwg
dTggKmRhdGEsIHNpemVfdCBsZW4pCiAJaWYgKCFjbWRidWYpCiAJCXJldHVybiAtRU5PTUVNOwog
Ci0JbXV0ZXhfbG9jaygmbWlwaS0+Y21kbG9jayk7Ci0JcmV0ID0gbWlwaS0+Y29tbWFuZChtaXBp
LCBjbWRidWYsIGRhdGEsIGxlbik7Ci0JbXV0ZXhfdW5sb2NrKCZtaXBpLT5jbWRsb2NrKTsKKwlt
dXRleF9sb2NrKCZkYmktPmNtZGxvY2spOworCXJldCA9IGRiaS0+Y29tbWFuZChkYmksIGNtZGJ1
ZiwgZGF0YSwgbGVuKTsKKwltdXRleF91bmxvY2soJmRiaS0+Y21kbG9jayk7CiAKIAlrZnJlZShj
bWRidWYpOwogCkBAIC0xNzEsNyArMTcxLDcgQEAgaW50IG1pcGlfZGJpX2NvbW1hbmRfYnVmKHN0
cnVjdCBtaXBpX2RiaSAqbWlwaSwgdTggY21kLCB1OCAqZGF0YSwgc2l6ZV90IGxlbikKIEVYUE9S
VF9TWU1CT0wobWlwaV9kYmlfY29tbWFuZF9idWYpOwogCiAvKiBUaGlzIHNob3VsZCBvbmx5IGJl
IHVzZWQgYnkgbWlwaV9kYmlfY29tbWFuZCgpICovCi1pbnQgbWlwaV9kYmlfY29tbWFuZF9zdGFj
a2J1ZihzdHJ1Y3QgbWlwaV9kYmkgKm1pcGksIHU4IGNtZCwgdTggKmRhdGEsIHNpemVfdCBsZW4p
CitpbnQgbWlwaV9kYmlfY29tbWFuZF9zdGFja2J1ZihzdHJ1Y3QgbWlwaV9kYmkgKmRiaSwgdTgg
Y21kLCB1OCAqZGF0YSwgc2l6ZV90IGxlbikKIHsKIAl1OCAqYnVmOwogCWludCByZXQ7CkBAIC0x
ODAsNyArMTgwLDcgQEAgaW50IG1pcGlfZGJpX2NvbW1hbmRfc3RhY2tidWYoc3RydWN0IG1pcGlf
ZGJpICptaXBpLCB1OCBjbWQsIHU4ICpkYXRhLCBzaXplX3QgbGUKIAlpZiAoIWJ1ZikKIAkJcmV0
dXJuIC1FTk9NRU07CiAKLQlyZXQgPSBtaXBpX2RiaV9jb21tYW5kX2J1ZihtaXBpLCBjbWQsIGJ1
ZiwgbGVuKTsKKwlyZXQgPSBtaXBpX2RiaV9jb21tYW5kX2J1ZihkYmksIGNtZCwgYnVmLCBsZW4p
OwogCiAJa2ZyZWUoYnVmKTsKIApAQCAtMjQ0LDcgKzI0NCw4IEBAIHN0YXRpYyB2b2lkIG1pcGlf
ZGJpX2ZiX2RpcnR5KHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLCBzdHJ1Y3QgZHJtX3JlY3Qg
KnJlY3QpCiAJc3RydWN0IG1pcGlfZGJpICptaXBpID0gZHJtX3RvX21pcGlfZGJpKGZiLT5kZXYp
OwogCXVuc2lnbmVkIGludCBoZWlnaHQgPSByZWN0LT55MiAtIHJlY3QtPnkxOwogCXVuc2lnbmVk
IGludCB3aWR0aCA9IHJlY3QtPngyIC0gcmVjdC0+eDE7Ci0JYm9vbCBzd2FwID0gbWlwaS0+c3dh
cF9ieXRlczsKKwlzdHJ1Y3QgbWlwaV9kYmkgKmRiaSA9IG1pcGk7CisJYm9vbCBzd2FwID0gZGJp
LT5zd2FwX2J5dGVzOwogCWludCBpZHgsIHJldCA9IDA7CiAJYm9vbCBmdWxsOwogCXZvaWQgKnRy
OwpAQCAtMjU5LDcgKzI2MCw3IEBAIHN0YXRpYyB2b2lkIG1pcGlfZGJpX2ZiX2RpcnR5KHN0cnVj
dCBkcm1fZnJhbWVidWZmZXIgKmZiLCBzdHJ1Y3QgZHJtX3JlY3QgKnJlY3QpCiAKIAlEUk1fREVC
VUdfS01TKCJGbHVzaGluZyBbRkI6JWRdICIgRFJNX1JFQ1RfRk1UICJcbiIsIGZiLT5iYXNlLmlk
LCBEUk1fUkVDVF9BUkcocmVjdCkpOwogCi0JaWYgKCFtaXBpLT5kYyB8fCAhZnVsbCB8fCBzd2Fw
IHx8CisJaWYgKCFkYmktPmRjIHx8ICFmdWxsIHx8IHN3YXAgfHwKIAkgICAgZmItPmZvcm1hdC0+
Zm9ybWF0ID09IERSTV9GT1JNQVRfWFJHQjg4ODgpIHsKIAkJdHIgPSBtaXBpLT50eF9idWY7CiAJ
CXJldCA9IG1pcGlfZGJpX2J1Zl9jb3B5KG1pcGktPnR4X2J1ZiwgZmIsIHJlY3QsIHN3YXApOwpA
QCAtMjY5LDE0ICsyNzAsMTQgQEAgc3RhdGljIHZvaWQgbWlwaV9kYmlfZmJfZGlydHkoc3RydWN0
IGRybV9mcmFtZWJ1ZmZlciAqZmIsIHN0cnVjdCBkcm1fcmVjdCAqcmVjdCkKIAkJdHIgPSBjbWFf
b2JqLT52YWRkcjsKIAl9CiAKLQltaXBpX2RiaV9jb21tYW5kKG1pcGksIE1JUElfRENTX1NFVF9D
T0xVTU5fQUREUkVTUywKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgTUlQSV9EQ1NfU0VUX0NPTFVN
Tl9BRERSRVNTLAogCQkJIChyZWN0LT54MSA+PiA4KSAmIDB4ZmYsIHJlY3QtPngxICYgMHhmZiwK
IAkJCSAoKHJlY3QtPngyIC0gMSkgPj4gOCkgJiAweGZmLCAocmVjdC0+eDIgLSAxKSAmIDB4ZmYp
OwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgTUlQSV9EQ1NfU0VUX1BBR0VfQUREUkVTUywKKwlt
aXBpX2RiaV9jb21tYW5kKGRiaSwgTUlQSV9EQ1NfU0VUX1BBR0VfQUREUkVTUywKIAkJCSAocmVj
dC0+eTEgPj4gOCkgJiAweGZmLCByZWN0LT55MSAmIDB4ZmYsCiAJCQkgKChyZWN0LT55MiAtIDEp
ID4+IDgpICYgMHhmZiwgKHJlY3QtPnkyIC0gMSkgJiAweGZmKTsKIAotCXJldCA9IG1pcGlfZGJp
X2NvbW1hbmRfYnVmKG1pcGksIE1JUElfRENTX1dSSVRFX01FTU9SWV9TVEFSVCwgdHIsCisJcmV0
ID0gbWlwaV9kYmlfY29tbWFuZF9idWYoZGJpLCBNSVBJX0RDU19XUklURV9NRU1PUllfU1RBUlQs
IHRyLAogCQkJCSAgIHdpZHRoICogaGVpZ2h0ICogMik7CiBlcnJfbXNnOgogCWlmIChyZXQpCkBA
IC0zNTYsNiArMzU3LDcgQEAgc3RhdGljIHZvaWQgbWlwaV9kYmlfYmxhbmsoc3RydWN0IG1pcGlf
ZGJpICptaXBpKQogCXUxNiBoZWlnaHQgPSBkcm0tPm1vZGVfY29uZmlnLm1pbl9oZWlnaHQ7CiAJ
dTE2IHdpZHRoID0gZHJtLT5tb2RlX2NvbmZpZy5taW5fd2lkdGg7CiAJc2l6ZV90IGxlbiA9IHdp
ZHRoICogaGVpZ2h0ICogMjsKKwlzdHJ1Y3QgbWlwaV9kYmkgKmRiaSA9IG1pcGk7CiAJaW50IGlk
eDsKIAogCWlmICghZHJtX2Rldl9lbnRlcihkcm0sICZpZHgpKQpAQCAtMzYzLDExICszNjUsMTEg
QEAgc3RhdGljIHZvaWQgbWlwaV9kYmlfYmxhbmsoc3RydWN0IG1pcGlfZGJpICptaXBpKQogCiAJ
bWVtc2V0KG1pcGktPnR4X2J1ZiwgMCwgbGVuKTsKIAotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwg
TUlQSV9EQ1NfU0VUX0NPTFVNTl9BRERSRVNTLCAwLCAwLAorCW1pcGlfZGJpX2NvbW1hbmQoZGJp
LCBNSVBJX0RDU19TRVRfQ09MVU1OX0FERFJFU1MsIDAsIDAsCiAJCQkgKHdpZHRoID4+IDgpICYg
MHhGRiwgKHdpZHRoIC0gMSkgJiAweEZGKTsKLQltaXBpX2RiaV9jb21tYW5kKG1pcGksIE1JUElf
RENTX1NFVF9QQUdFX0FERFJFU1MsIDAsIDAsCisJbWlwaV9kYmlfY29tbWFuZChkYmksIE1JUElf
RENTX1NFVF9QQUdFX0FERFJFU1MsIDAsIDAsCiAJCQkgKGhlaWdodCA+PiA4KSAmIDB4RkYsICho
ZWlnaHQgLSAxKSAmIDB4RkYpOwotCW1pcGlfZGJpX2NvbW1hbmRfYnVmKG1pcGksIE1JUElfRENT
X1dSSVRFX01FTU9SWV9TVEFSVCwKKwltaXBpX2RiaV9jb21tYW5kX2J1ZihkYmksIE1JUElfRENT
X1dSSVRFX01FTU9SWV9TVEFSVCwKIAkJCSAgICAgKHU4ICopbWlwaS0+dHhfYnVmLCBsZW4pOwog
CiAJZHJtX2Rldl9leGl0KGlkeCk7CkBAIC01OTYsMjUgKzU5OCwyNSBAQCBFWFBPUlRfU1lNQk9M
KG1pcGlfZGJpX3JlbGVhc2UpOwogCiAvKioKICAqIG1pcGlfZGJpX2h3X3Jlc2V0IC0gSGFyZHdh
cmUgcmVzZXQgb2YgY29udHJvbGxlcgotICogQG1pcGk6IE1JUEkgREJJIHN0cnVjdHVyZQorICog
QGRiaTogTUlQSSBEQkkgc3RydWN0dXJlCiAgKgogICogUmVzZXQgY29udHJvbGxlciBpZiB0aGUg
Jm1pcGlfZGJpLT5yZXNldCBncGlvIGlzIHNldC4KICAqLwotdm9pZCBtaXBpX2RiaV9od19yZXNl
dChzdHJ1Y3QgbWlwaV9kYmkgKm1pcGkpCit2b2lkIG1pcGlfZGJpX2h3X3Jlc2V0KHN0cnVjdCBt
aXBpX2RiaSAqZGJpKQogewotCWlmICghbWlwaS0+cmVzZXQpCisJaWYgKCFkYmktPnJlc2V0KQog
CQlyZXR1cm47CiAKLQlncGlvZF9zZXRfdmFsdWVfY2Fuc2xlZXAobWlwaS0+cmVzZXQsIDApOwor
CWdwaW9kX3NldF92YWx1ZV9jYW5zbGVlcChkYmktPnJlc2V0LCAwKTsKIAl1c2xlZXBfcmFuZ2Uo
MjAsIDEwMDApOwotCWdwaW9kX3NldF92YWx1ZV9jYW5zbGVlcChtaXBpLT5yZXNldCwgMSk7CisJ
Z3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKGRiaS0+cmVzZXQsIDEpOwogCW1zbGVlcCgxMjApOwog
fQogRVhQT1JUX1NZTUJPTChtaXBpX2RiaV9od19yZXNldCk7CiAKIC8qKgogICogbWlwaV9kYmlf
ZGlzcGxheV9pc19vbiAtIENoZWNrIGlmIGRpc3BsYXkgaXMgb24KLSAqIEBtaXBpOiBNSVBJIERC
SSBzdHJ1Y3R1cmUKKyAqIEBkYmk6IE1JUEkgREJJIHN0cnVjdHVyZQogICoKICAqIFRoaXMgZnVu
Y3Rpb24gY2hlY2tzIHRoZSBQb3dlciBNb2RlIHJlZ2lzdGVyIChpZiByZWFkYWJsZSkgdG8gc2Vl
IGlmCiAgKiBkaXNwbGF5IG91dHB1dCBpcyB0dXJuZWQgb24uIFRoaXMgY2FuIGJlIHVzZWQgdG8g
c2VlIGlmIHRoZSBib290bG9hZGVyCkBAIC02MjQsMTEgKzYyNiwxMSBAQCBFWFBPUlRfU1lNQk9M
KG1pcGlfZGJpX2h3X3Jlc2V0KTsKICAqIFJldHVybnM6CiAgKiB0cnVlIGlmIHRoZSBkaXNwbGF5
IGNhbiBiZSB2ZXJpZmllZCB0byBiZSBvbiwgZmFsc2Ugb3RoZXJ3aXNlLgogICovCi1ib29sIG1p
cGlfZGJpX2Rpc3BsYXlfaXNfb24oc3RydWN0IG1pcGlfZGJpICptaXBpKQorYm9vbCBtaXBpX2Ri
aV9kaXNwbGF5X2lzX29uKHN0cnVjdCBtaXBpX2RiaSAqZGJpKQogewogCXU4IHZhbDsKIAotCWlm
IChtaXBpX2RiaV9jb21tYW5kX3JlYWQobWlwaSwgTUlQSV9EQ1NfR0VUX1BPV0VSX01PREUsICZ2
YWwpKQorCWlmIChtaXBpX2RiaV9jb21tYW5kX3JlYWQoZGJpLCBNSVBJX0RDU19HRVRfUE9XRVJf
TU9ERSwgJnZhbCkpCiAJCXJldHVybiBmYWxzZTsKIAogCXZhbCAmPSB+RENTX1BPV0VSX01PREVf
UkVTRVJWRURfTUFTSzsKQEAgLTY0Nyw2ICs2NDksNyBAQCBFWFBPUlRfU1lNQk9MKG1pcGlfZGJp
X2Rpc3BsYXlfaXNfb24pOwogc3RhdGljIGludCBtaXBpX2RiaV9wb3dlcm9uX3Jlc2V0X2NvbmRp
dGlvbmFsKHN0cnVjdCBtaXBpX2RiaSAqbWlwaSwgYm9vbCBjb25kKQogewogCXN0cnVjdCBkZXZp
Y2UgKmRldiA9IG1pcGktPmRybS5kZXY7CisJc3RydWN0IG1pcGlfZGJpICpkYmkgPSBtaXBpOwog
CWludCByZXQ7CiAKIAlpZiAobWlwaS0+cmVndWxhdG9yKSB7CkBAIC02NTcsMTEgKzY2MCwxMSBA
QCBzdGF0aWMgaW50IG1pcGlfZGJpX3Bvd2Vyb25fcmVzZXRfY29uZGl0aW9uYWwoc3RydWN0IG1p
cGlfZGJpICptaXBpLCBib29sIGNvbmQpCiAJCX0KIAl9CiAKLQlpZiAoY29uZCAmJiBtaXBpX2Ri
aV9kaXNwbGF5X2lzX29uKG1pcGkpKQorCWlmIChjb25kICYmIG1pcGlfZGJpX2Rpc3BsYXlfaXNf
b24oZGJpKSkKIAkJcmV0dXJuIDE7CiAKLQltaXBpX2RiaV9od19yZXNldChtaXBpKTsKLQlyZXQg
PSBtaXBpX2RiaV9jb21tYW5kKG1pcGksIE1JUElfRENTX1NPRlRfUkVTRVQpOworCW1pcGlfZGJp
X2h3X3Jlc2V0KGRiaSk7CisJcmV0ID0gbWlwaV9kYmlfY29tbWFuZChkYmksIE1JUElfRENTX1NP
RlRfUkVTRVQpOwogCWlmIChyZXQpIHsKIAkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8g
c2VuZCByZXNldCBjb21tYW5kICglZClcbiIsIHJldCk7CiAJCWlmIChtaXBpLT5yZWd1bGF0b3Ip
CkBAIC02NzQsNyArNjc3LDcgQEAgc3RhdGljIGludCBtaXBpX2RiaV9wb3dlcm9uX3Jlc2V0X2Nv
bmRpdGlvbmFsKHN0cnVjdCBtaXBpX2RiaSAqbWlwaSwgYm9vbCBjb25kKQogCSAqIHBlciBNSVBJ
IERTQyBzcGVjIHNob3VsZCB3YWl0IDVtcyBhZnRlciBzb2Z0IHJlc2V0LiBJZiB3ZSBkaWRuJ3Qs
CiAJICogd2UgYXNzdW1lIHdvcnN0IGNhc2UgYW5kIHdhaXQgMTIwbXMuCiAJICovCi0JaWYgKG1p
cGktPnJlc2V0KQorCWlmIChkYmktPnJlc2V0KQogCQl1c2xlZXBfcmFuZ2UoNTAwMCwgMjAwMDAp
OwogCWVsc2UKIAkJbXNsZWVwKDEyMCk7CkBAIC03NjMsMTUgKzc2NiwxNSBAQCBzdGF0aWMgYm9v
bCBtaXBpX2RiaV9tYWNoaW5lX2xpdHRsZV9lbmRpYW4odm9pZCkKICAqICAgICA3NjU0MzIxMAog
ICovCiAKLXN0YXRpYyBpbnQgbWlwaV9kYmlfc3BpMWVfdHJhbnNmZXIoc3RydWN0IG1pcGlfZGJp
ICptaXBpLCBpbnQgZGMsCitzdGF0aWMgaW50IG1pcGlfZGJpX3NwaTFlX3RyYW5zZmVyKHN0cnVj
dCBtaXBpX2RiaSAqZGJpLCBpbnQgZGMsCiAJCQkJICAgY29uc3Qgdm9pZCAqYnVmLCBzaXplX3Qg
bGVuLAogCQkJCSAgIHVuc2lnbmVkIGludCBicHcpCiB7CiAJYm9vbCBzd2FwX2J5dGVzID0gKGJw
dyA9PSAxNiAmJiBtaXBpX2RiaV9tYWNoaW5lX2xpdHRsZV9lbmRpYW4oKSk7Ci0Jc2l6ZV90IGNo
dW5rLCBtYXhfY2h1bmsgPSBtaXBpLT50eF9idWY5X2xlbjsKLQlzdHJ1Y3Qgc3BpX2RldmljZSAq
c3BpID0gbWlwaS0+c3BpOworCXNpemVfdCBjaHVuaywgbWF4X2NodW5rID0gZGJpLT50eF9idWY5
X2xlbjsKKwlzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpID0gZGJpLT5zcGk7CiAJc3RydWN0IHNwaV90
cmFuc2ZlciB0ciA9IHsKLQkJLnR4X2J1ZiA9IG1pcGktPnR4X2J1ZjksCisJCS50eF9idWYgPSBk
YmktPnR4X2J1ZjksCiAJCS5iaXRzX3Blcl93b3JkID0gOCwKIAl9OwogCXN0cnVjdCBzcGlfbWVz
c2FnZSBtOwpAQCAtNzkxLDcgKzc5NCw3IEBAIHN0YXRpYyBpbnQgbWlwaV9kYmlfc3BpMWVfdHJh
bnNmZXIoc3RydWN0IG1pcGlfZGJpICptaXBpLCBpbnQgZGMsCiAJCQlyZXR1cm4gLUVJTlZBTDsK
IAogCQkvKiBDb21tYW5kOiBwYWQgbm8tb3AncyAoemVyb2VzKSBhdCBiZWdpbm5pbmcgb2YgYmxv
Y2sgKi8KLQkJZHN0ID0gbWlwaS0+dHhfYnVmOTsKKwkJZHN0ID0gZGJpLT50eF9idWY5OwogCQlt
ZW1zZXQoZHN0LCAwLCA5KTsKIAkJZHN0WzhdID0gKnNyYzsKIAkJdHIubGVuID0gOTsKQEAgLTgx
MSw3ICs4MTQsNyBAQCBzdGF0aWMgaW50IG1pcGlfZGJpX3NwaTFlX3RyYW5zZmVyKHN0cnVjdCBt
aXBpX2RiaSAqbWlwaSwgaW50IGRjLAogCiAJCWNodW5rID0gbWluKGxlbiwgbWF4X2NodW5rKTsK
IAkJbGVuIC09IGNodW5rOwotCQlkc3QgPSBtaXBpLT50eF9idWY5OworCQlkc3QgPSBkYmktPnR4
X2J1Zjk7CiAKIAkJaWYgKGNodW5rIDwgOCkgewogCQkJdTggdmFsLCBjYXJyeSA9IDA7CkBAIC04
ODEsMTEgKzg4NCwxMSBAQCBzdGF0aWMgaW50IG1pcGlfZGJpX3NwaTFlX3RyYW5zZmVyKHN0cnVj
dCBtaXBpX2RiaSAqbWlwaSwgaW50IGRjLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IG1p
cGlfZGJpX3NwaTFfdHJhbnNmZXIoc3RydWN0IG1pcGlfZGJpICptaXBpLCBpbnQgZGMsCitzdGF0
aWMgaW50IG1pcGlfZGJpX3NwaTFfdHJhbnNmZXIoc3RydWN0IG1pcGlfZGJpICpkYmksIGludCBk
YywKIAkJCQkgIGNvbnN0IHZvaWQgKmJ1Ziwgc2l6ZV90IGxlbiwKIAkJCQkgIHVuc2lnbmVkIGlu
dCBicHcpCiB7Ci0Jc3RydWN0IHNwaV9kZXZpY2UgKnNwaSA9IG1pcGktPnNwaTsKKwlzdHJ1Y3Qg
c3BpX2RldmljZSAqc3BpID0gZGJpLT5zcGk7CiAJc3RydWN0IHNwaV90cmFuc2ZlciB0ciA9IHsK
IAkJLmJpdHNfcGVyX3dvcmQgPSA5LAogCX07CkBAIC04OTcsMTEgKzkwMCwxMSBAQCBzdGF0aWMg
aW50IG1pcGlfZGJpX3NwaTFfdHJhbnNmZXIoc3RydWN0IG1pcGlfZGJpICptaXBpLCBpbnQgZGMs
CiAJaW50IHJldDsKIAogCWlmICghc3BpX2lzX2Jwd19zdXBwb3J0ZWQoc3BpLCA5KSkKLQkJcmV0
dXJuIG1pcGlfZGJpX3NwaTFlX3RyYW5zZmVyKG1pcGksIGRjLCBidWYsIGxlbiwgYnB3KTsKKwkJ
cmV0dXJuIG1pcGlfZGJpX3NwaTFlX3RyYW5zZmVyKGRiaSwgZGMsIGJ1ZiwgbGVuLCBicHcpOwog
CiAJdHIuc3BlZWRfaHogPSBtaXBpX2RiaV9zcGlfY21kX21heF9zcGVlZChzcGksIGxlbik7Ci0J
bWF4X2NodW5rID0gbWlwaS0+dHhfYnVmOV9sZW47Ci0JZHN0MTYgPSBtaXBpLT50eF9idWY5Owor
CW1heF9jaHVuayA9IGRiaS0+dHhfYnVmOV9sZW47CisJZHN0MTYgPSBkYmktPnR4X2J1Zjk7CiAK
IAlpZiAoZHJtX2RlYnVnICYgRFJNX1VUX0RSSVZFUikKIAkJcHJfZGVidWcoIltkcm06JXNdIGRj
PSVkLCBtYXhfY2h1bms9JXp1LCB0cmFuc2ZlcnM6XG4iLApAQCAtOTQ0LDMwICs5NDcsMzAgQEAg
c3RhdGljIGludCBtaXBpX2RiaV9zcGkxX3RyYW5zZmVyKHN0cnVjdCBtaXBpX2RiaSAqbWlwaSwg
aW50IGRjLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IG1pcGlfZGJpX3R5cGVjMV9jb21t
YW5kKHN0cnVjdCBtaXBpX2RiaSAqbWlwaSwgdTggKmNtZCwKK3N0YXRpYyBpbnQgbWlwaV9kYmlf
dHlwZWMxX2NvbW1hbmQoc3RydWN0IG1pcGlfZGJpICpkYmksIHU4ICpjbWQsCiAJCQkJICAgdTgg
KnBhcmFtZXRlcnMsIHNpemVfdCBudW0pCiB7CiAJdW5zaWduZWQgaW50IGJwdyA9ICgqY21kID09
IE1JUElfRENTX1dSSVRFX01FTU9SWV9TVEFSVCkgPyAxNiA6IDg7CiAJaW50IHJldDsKIAotCWlm
IChtaXBpX2RiaV9jb21tYW5kX2lzX3JlYWQobWlwaSwgKmNtZCkpCisJaWYgKG1pcGlfZGJpX2Nv
bW1hbmRfaXNfcmVhZChkYmksICpjbWQpKQogCQlyZXR1cm4gLUVOT1RTVVBQOwogCiAJTUlQSV9E
QklfREVCVUdfQ09NTUFORCgqY21kLCBwYXJhbWV0ZXJzLCBudW0pOwogCi0JcmV0ID0gbWlwaV9k
Ymlfc3BpMV90cmFuc2ZlcihtaXBpLCAwLCBjbWQsIDEsIDgpOworCXJldCA9IG1pcGlfZGJpX3Nw
aTFfdHJhbnNmZXIoZGJpLCAwLCBjbWQsIDEsIDgpOwogCWlmIChyZXQgfHwgIW51bSkKIAkJcmV0
dXJuIHJldDsKIAotCXJldHVybiBtaXBpX2RiaV9zcGkxX3RyYW5zZmVyKG1pcGksIDEsIHBhcmFt
ZXRlcnMsIG51bSwgYnB3KTsKKwlyZXR1cm4gbWlwaV9kYmlfc3BpMV90cmFuc2ZlcihkYmksIDEs
IHBhcmFtZXRlcnMsIG51bSwgYnB3KTsKIH0KIAogLyogTUlQSSBEQkkgVHlwZSBDIE9wdGlvbiAz
ICovCiAKLXN0YXRpYyBpbnQgbWlwaV9kYmlfdHlwZWMzX2NvbW1hbmRfcmVhZChzdHJ1Y3QgbWlw
aV9kYmkgKm1pcGksIHU4ICpjbWQsCitzdGF0aWMgaW50IG1pcGlfZGJpX3R5cGVjM19jb21tYW5k
X3JlYWQoc3RydWN0IG1pcGlfZGJpICpkYmksIHU4ICpjbWQsCiAJCQkJCXU4ICpkYXRhLCBzaXpl
X3QgbGVuKQogewotCXN0cnVjdCBzcGlfZGV2aWNlICpzcGkgPSBtaXBpLT5zcGk7CisJc3RydWN0
IHNwaV9kZXZpY2UgKnNwaSA9IGRiaS0+c3BpOwogCXUzMiBzcGVlZF9oeiA9IG1pbl90KHUzMiwg
TUlQSV9EQklfTUFYX1NQSV9SRUFEX1NQRUVELAogCQkJICAgICBzcGktPm1heF9zcGVlZF9oeiAv
IDIpOwogCXN0cnVjdCBzcGlfdHJhbnNmZXIgdHJbMl0gPSB7CkBAIC0xMDA0LDcgKzEwMDcsNyBA
QCBzdGF0aWMgaW50IG1pcGlfZGJpX3R5cGVjM19jb21tYW5kX3JlYWQoc3RydWN0IG1pcGlfZGJp
ICptaXBpLCB1OCAqY21kLAogCQlyZXR1cm4gLUVOT01FTTsKIAogCXRyWzFdLnJ4X2J1ZiA9IGJ1
ZjsKLQlncGlvZF9zZXRfdmFsdWVfY2Fuc2xlZXAobWlwaS0+ZGMsIDApOworCWdwaW9kX3NldF92
YWx1ZV9jYW5zbGVlcChkYmktPmRjLCAwKTsKIAogCXNwaV9tZXNzYWdlX2luaXRfd2l0aF90cmFu
c2ZlcnMoJm0sIHRyLCBBUlJBWV9TSVpFKHRyKSk7CiAJcmV0ID0gc3BpX3N5bmMoc3BpLCAmbSk7
CkBAIC0xMDI4LDQxICsxMDMxLDQxIEBAIHN0YXRpYyBpbnQgbWlwaV9kYmlfdHlwZWMzX2NvbW1h
bmRfcmVhZChzdHJ1Y3QgbWlwaV9kYmkgKm1pcGksIHU4ICpjbWQsCiAJcmV0dXJuIHJldDsKIH0K
IAotc3RhdGljIGludCBtaXBpX2RiaV90eXBlYzNfY29tbWFuZChzdHJ1Y3QgbWlwaV9kYmkgKm1p
cGksIHU4ICpjbWQsCitzdGF0aWMgaW50IG1pcGlfZGJpX3R5cGVjM19jb21tYW5kKHN0cnVjdCBt
aXBpX2RiaSAqZGJpLCB1OCAqY21kLAogCQkJCSAgIHU4ICpwYXIsIHNpemVfdCBudW0pCiB7Ci0J
c3RydWN0IHNwaV9kZXZpY2UgKnNwaSA9IG1pcGktPnNwaTsKKwlzdHJ1Y3Qgc3BpX2RldmljZSAq
c3BpID0gZGJpLT5zcGk7CiAJdW5zaWduZWQgaW50IGJwdyA9IDg7CiAJdTMyIHNwZWVkX2h6Owog
CWludCByZXQ7CiAKLQlpZiAobWlwaV9kYmlfY29tbWFuZF9pc19yZWFkKG1pcGksICpjbWQpKQot
CQlyZXR1cm4gbWlwaV9kYmlfdHlwZWMzX2NvbW1hbmRfcmVhZChtaXBpLCBjbWQsIHBhciwgbnVt
KTsKKwlpZiAobWlwaV9kYmlfY29tbWFuZF9pc19yZWFkKGRiaSwgKmNtZCkpCisJCXJldHVybiBt
aXBpX2RiaV90eXBlYzNfY29tbWFuZF9yZWFkKGRiaSwgY21kLCBwYXIsIG51bSk7CiAKIAlNSVBJ
X0RCSV9ERUJVR19DT01NQU5EKCpjbWQsIHBhciwgbnVtKTsKIAotCWdwaW9kX3NldF92YWx1ZV9j
YW5zbGVlcChtaXBpLT5kYywgMCk7CisJZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKGRiaS0+ZGMs
IDApOwogCXNwZWVkX2h6ID0gbWlwaV9kYmlfc3BpX2NtZF9tYXhfc3BlZWQoc3BpLCAxKTsKIAly
ZXQgPSBtaXBpX2RiaV9zcGlfdHJhbnNmZXIoc3BpLCBzcGVlZF9oeiwgOCwgY21kLCAxKTsKIAlp
ZiAocmV0IHx8ICFudW0pCiAJCXJldHVybiByZXQ7CiAKLQlpZiAoKmNtZCA9PSBNSVBJX0RDU19X
UklURV9NRU1PUllfU1RBUlQgJiYgIW1pcGktPnN3YXBfYnl0ZXMpCisJaWYgKCpjbWQgPT0gTUlQ
SV9EQ1NfV1JJVEVfTUVNT1JZX1NUQVJUICYmICFkYmktPnN3YXBfYnl0ZXMpCiAJCWJwdyA9IDE2
OwogCi0JZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKG1pcGktPmRjLCAxKTsKKwlncGlvZF9zZXRf
dmFsdWVfY2Fuc2xlZXAoZGJpLT5kYywgMSk7CiAJc3BlZWRfaHogPSBtaXBpX2RiaV9zcGlfY21k
X21heF9zcGVlZChzcGksIG51bSk7CiAKIAlyZXR1cm4gbWlwaV9kYmlfc3BpX3RyYW5zZmVyKHNw
aSwgc3BlZWRfaHosIGJwdywgcGFyLCBudW0pOwogfQogCiAvKioKLSAqIG1pcGlfZGJpX3NwaV9p
bml0IC0gSW5pdGlhbGl6ZSBNSVBJIERCSSBTUEkgaW50ZXJmYWNlZCBjb250cm9sbGVyCisgKiBt
aXBpX2RiaV9zcGlfaW5pdCAtIEluaXRpYWxpemUgTUlQSSBEQkkgU1BJIGludGVyZmFjZQogICog
QHNwaTogU1BJIGRldmljZQotICogQG1pcGk6ICZtaXBpX2RiaSBzdHJ1Y3R1cmUgdG8gaW5pdGlh
bGl6ZQorICogQGRiaTogTUlQSSBEQkkgc3RydWN0dXJlIHRvIGluaXRpYWxpemUKICAqIEBkYzog
RC9DIGdwaW8gKG9wdGlvbmFsKQogICoKLSAqIFRoaXMgZnVuY3Rpb24gc2V0cyAmbWlwaV9kYmkt
PmNvbW1hbmQsIGVuYWJsZXMgJm1pcGktPnJlYWRfY29tbWFuZHMgZm9yIHRoZQorICogVGhpcyBm
dW5jdGlvbiBzZXRzICZtaXBpX2RiaS0+Y29tbWFuZCwgZW5hYmxlcyAmbWlwaV9kYmktPnJlYWRf
Y29tbWFuZHMgZm9yIHRoZQogICogdXN1YWwgcmVhZCBjb21tYW5kcy4gSXQgc2hvdWxkIGJlIGZv
bGxvd2VkIGJ5IGEgY2FsbCB0byBtaXBpX2RiaV9pbml0KCkgb3IKICAqIGEgZHJpdmVyLXNwZWNp
ZmljIGluaXQuCiAgKgpAQCAtMTA3OCw3ICsxMDgxLDcgQEAgc3RhdGljIGludCBtaXBpX2RiaV90
eXBlYzNfY29tbWFuZChzdHJ1Y3QgbWlwaV9kYmkgKm1pcGksIHU4ICpjbWQsCiAgKiBSZXR1cm5z
OgogICogWmVybyBvbiBzdWNjZXNzLCBuZWdhdGl2ZSBlcnJvciBjb2RlIG9uIGZhaWx1cmUuCiAg
Ki8KLWludCBtaXBpX2RiaV9zcGlfaW5pdChzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpLCBzdHJ1Y3Qg
bWlwaV9kYmkgKm1pcGksCitpbnQgbWlwaV9kYmlfc3BpX2luaXQoc3RydWN0IHNwaV9kZXZpY2Ug
KnNwaSwgc3RydWN0IG1pcGlfZGJpICpkYmksCiAJCSAgICAgIHN0cnVjdCBncGlvX2Rlc2MgKmRj
KQogewogCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZzcGktPmRldjsKQEAgLTExMDIsMjMgKzExMDUs
MjMgQEAgaW50IG1pcGlfZGJpX3NwaV9pbml0KHN0cnVjdCBzcGlfZGV2aWNlICpzcGksIHN0cnVj
dCBtaXBpX2RiaSAqbWlwaSwKIAkJfQogCX0KIAotCW1pcGktPnNwaSA9IHNwaTsKLQltaXBpLT5y
ZWFkX2NvbW1hbmRzID0gbWlwaV9kYmlfZGNzX3JlYWRfY29tbWFuZHM7CisJZGJpLT5zcGkgPSBz
cGk7CisJZGJpLT5yZWFkX2NvbW1hbmRzID0gbWlwaV9kYmlfZGNzX3JlYWRfY29tbWFuZHM7CiAK
IAlpZiAoZGMpIHsKLQkJbWlwaS0+Y29tbWFuZCA9IG1pcGlfZGJpX3R5cGVjM19jb21tYW5kOwot
CQltaXBpLT5kYyA9IGRjOworCQlkYmktPmNvbW1hbmQgPSBtaXBpX2RiaV90eXBlYzNfY29tbWFu
ZDsKKwkJZGJpLT5kYyA9IGRjOwogCQlpZiAobWlwaV9kYmlfbWFjaGluZV9saXR0bGVfZW5kaWFu
KCkgJiYgIXNwaV9pc19icHdfc3VwcG9ydGVkKHNwaSwgMTYpKQotCQkJbWlwaS0+c3dhcF9ieXRl
cyA9IHRydWU7CisJCQlkYmktPnN3YXBfYnl0ZXMgPSB0cnVlOwogCX0gZWxzZSB7Ci0JCW1pcGkt
PmNvbW1hbmQgPSBtaXBpX2RiaV90eXBlYzFfY29tbWFuZDsKLQkJbWlwaS0+dHhfYnVmOV9sZW4g
PSBTWl8xNks7Ci0JCW1pcGktPnR4X2J1ZjkgPSBkZXZtX2ttYWxsb2MoZGV2LCBtaXBpLT50eF9i
dWY5X2xlbiwgR0ZQX0tFUk5FTCk7Ci0JCWlmICghbWlwaS0+dHhfYnVmOSkKKwkJZGJpLT5jb21t
YW5kID0gbWlwaV9kYmlfdHlwZWMxX2NvbW1hbmQ7CisJCWRiaS0+dHhfYnVmOV9sZW4gPSBTWl8x
Nks7CisJCWRiaS0+dHhfYnVmOSA9IGRldm1fa21hbGxvYyhkZXYsIGRiaS0+dHhfYnVmOV9sZW4s
IEdGUF9LRVJORUwpOworCQlpZiAoIWRiaS0+dHhfYnVmOSkKIAkJCXJldHVybiAtRU5PTUVNOwog
CX0KIAotCW11dGV4X2luaXQoJm1pcGktPmNtZGxvY2spOworCW11dGV4X2luaXQoJmRiaS0+Y21k
bG9jayk7CiAKIAlEUk1fREVCVUdfRFJJVkVSKCJTUEkgc3BlZWQ6ICV1TUh6XG4iLCBzcGktPm1h
eF9zcGVlZF9oeiAvIDEwMDAwMDApOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdGlu
eWRybS9zdDc1ODYuYyBiL2RyaXZlcnMvZ3B1L2RybS90aW55ZHJtL3N0NzU4Ni5jCmluZGV4IDQw
NDZiMGZjM2Y3YS4uODMzOWU3ZGM1ZDkyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdGlu
eWRybS9zdDc1ODYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdGlueWRybS9zdDc1ODYuYwpAQCAt
MTE1LDYgKzExNSw3IEBAIHN0YXRpYyBpbnQgc3Q3NTg2X2J1Zl9jb3B5KHZvaWQgKmRzdCwgc3Ry
dWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIsCiBzdGF0aWMgdm9pZCBzdDc1ODZfZmJfZGlydHkoc3Ry
dWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIsIHN0cnVjdCBkcm1fcmVjdCAqcmVjdCkKIHsKIAlzdHJ1
Y3QgbWlwaV9kYmkgKm1pcGkgPSBkcm1fdG9fbWlwaV9kYmkoZmItPmRldik7CisJc3RydWN0IG1p
cGlfZGJpICpkYmkgPSBtaXBpOwogCWludCBzdGFydCwgZW5kLCBpZHgsIHJldCA9IDA7CiAKIAlp
ZiAoIW1pcGktPmVuYWJsZWQpCkBAIC0xMzcsMTQgKzEzOCwxNCBAQCBzdGF0aWMgdm9pZCBzdDc1
ODZfZmJfZGlydHkoc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIsIHN0cnVjdCBkcm1fcmVjdCAq
cmVjdCkKIAlzdGFydCA9IHJlY3QtPngxIC8gMzsKIAllbmQgPSByZWN0LT54MiAvIDM7CiAKLQlt
aXBpX2RiaV9jb21tYW5kKG1pcGksIE1JUElfRENTX1NFVF9DT0xVTU5fQUREUkVTUywKKwltaXBp
X2RiaV9jb21tYW5kKGRiaSwgTUlQSV9EQ1NfU0VUX0NPTFVNTl9BRERSRVNTLAogCQkJIChzdGFy
dCA+PiA4KSAmIDB4RkYsIHN0YXJ0ICYgMHhGRiwKIAkJCSAoZW5kID4+IDgpICYgMHhGRiwgKGVu
ZCAtIDEpICYgMHhGRik7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBNSVBJX0RDU19TRVRfUEFH
RV9BRERSRVNTLAorCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBNSVBJX0RDU19TRVRfUEFHRV9BRERS
RVNTLAogCQkJIChyZWN0LT55MSA+PiA4KSAmIDB4RkYsIHJlY3QtPnkxICYgMHhGRiwKIAkJCSAo
cmVjdC0+eTIgPj4gOCkgJiAweEZGLCAocmVjdC0+eTIgLSAxKSAmIDB4RkYpOwogCi0JcmV0ID0g
bWlwaV9kYmlfY29tbWFuZF9idWYobWlwaSwgTUlQSV9EQ1NfV1JJVEVfTUVNT1JZX1NUQVJULAor
CXJldCA9IG1pcGlfZGJpX2NvbW1hbmRfYnVmKGRiaSwgTUlQSV9EQ1NfV1JJVEVfTUVNT1JZX1NU
QVJULAogCQkJCSAgICh1OCAqKW1pcGktPnR4X2J1ZiwKIAkJCQkgICAoZW5kIC0gc3RhcnQpICog
KHJlY3QtPnkyIC0gcmVjdC0+eTEpKTsKIGVycl9tc2c6CkBAIC0xNzgsNiArMTc5LDcgQEAgc3Rh
dGljIHZvaWQgc3Q3NTg2X3BpcGVfZW5hYmxlKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlw
ZSAqcGlwZSwKIHsKIAlzdHJ1Y3QgbWlwaV9kYmkgKm1pcGkgPSBkcm1fdG9fbWlwaV9kYmkocGlw
ZS0+Y3J0Yy5kZXYpOwogCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUt
PmZiOworCXN0cnVjdCBtaXBpX2RiaSAqZGJpID0gbWlwaTsKIAlzdHJ1Y3QgZHJtX3JlY3QgcmVj
dCA9IHsKIAkJLngxID0gMCwKIAkJLngyID0gZmItPndpZHRoLApAQCAtMTk2LDI5ICsxOTgsMjkg
QEAgc3RhdGljIHZvaWQgc3Q3NTg2X3BpcGVfZW5hYmxlKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3Bs
YXlfcGlwZSAqcGlwZSwKIAlpZiAocmV0KQogCQlnb3RvIG91dF9leGl0OwogCi0JbWlwaV9kYmlf
Y29tbWFuZChtaXBpLCBTVDc1ODZfQVVUT19SRUFEX0NUUkwsIDB4OWYpOwotCW1pcGlfZGJpX2Nv
bW1hbmQobWlwaSwgU1Q3NTg2X09UUF9SV19DVFJMLCAweDAwKTsKKwltaXBpX2RiaV9jb21tYW5k
KGRiaSwgU1Q3NTg2X0FVVE9fUkVBRF9DVFJMLCAweDlmKTsKKwltaXBpX2RiaV9jb21tYW5kKGRi
aSwgU1Q3NTg2X09UUF9SV19DVFJMLCAweDAwKTsKIAogCW1zbGVlcCgxMCk7CiAKLQltaXBpX2Ri
aV9jb21tYW5kKG1pcGksIFNUNzU4Nl9PVFBfUkVBRCk7CisJbWlwaV9kYmlfY29tbWFuZChkYmks
IFNUNzU4Nl9PVFBfUkVBRCk7CiAKIAltc2xlZXAoMjApOwogCi0JbWlwaV9kYmlfY29tbWFuZCht
aXBpLCBTVDc1ODZfT1RQX0NUUkxfT1VUKTsKLQltaXBpX2RiaV9jb21tYW5kKG1pcGksIE1JUElf
RENTX0VYSVRfU0xFRVBfTU9ERSk7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBNSVBJX0RDU19T
RVRfRElTUExBWV9PRkYpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBTVDc1ODZfT1RQX0NUUkxf
T1VUKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgTUlQSV9EQ1NfRVhJVF9TTEVFUF9NT0RFKTsK
KwltaXBpX2RiaV9jb21tYW5kKGRiaSwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlfT0ZGKTsKIAogCW1z
bGVlcCg1MCk7CiAKLQltaXBpX2RiaV9jb21tYW5kKG1pcGksIFNUNzU4Nl9TRVRfVk9QX09GRlNF
VCwgMHgwMCk7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBTVDc1ODZfU0VUX1ZPUCwgMHhlMywg
MHgwMCk7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBTVDc1ODZfU0VUX0JJQVNfU1lTVEVNLCAw
eDAyKTsKLQltaXBpX2RiaV9jb21tYW5kKG1pcGksIFNUNzU4Nl9TRVRfQk9PU1RfTEVWRUwsIDB4
MDQpOwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgU1Q3NTg2X0VOQUJMRV9BTkFMT0csIDB4MWQp
OwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgU1Q3NTg2X1NFVF9OTElORV9JTlYsIDB4MDApOwot
CW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgU1Q3NTg2X0RJU1BfTU9ERV9HUkFZKTsKLQltaXBpX2Ri
aV9jb21tYW5kKG1pcGksIFNUNzU4Nl9FTkFCTEVfRERSQU0sIDB4MDIpOworCW1pcGlfZGJpX2Nv
bW1hbmQoZGJpLCBTVDc1ODZfU0VUX1ZPUF9PRkZTRVQsIDB4MDApOworCW1pcGlfZGJpX2NvbW1h
bmQoZGJpLCBTVDc1ODZfU0VUX1ZPUCwgMHhlMywgMHgwMCk7CisJbWlwaV9kYmlfY29tbWFuZChk
YmksIFNUNzU4Nl9TRVRfQklBU19TWVNURU0sIDB4MDIpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJp
LCBTVDc1ODZfU0VUX0JPT1NUX0xFVkVMLCAweDA0KTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwg
U1Q3NTg2X0VOQUJMRV9BTkFMT0csIDB4MWQpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBTVDc1
ODZfU0VUX05MSU5FX0lOViwgMHgwMCk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIFNUNzU4Nl9E
SVNQX01PREVfR1JBWSk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIFNUNzU4Nl9FTkFCTEVfRERS
QU0sIDB4MDIpOwogCiAJc3dpdGNoIChtaXBpLT5yb3RhdGlvbikgewogCWRlZmF1bHQ6CkBAIC0y
MzQsMTkgKzIzNiwxOSBAQCBzdGF0aWMgdm9pZCBzdDc1ODZfcGlwZV9lbmFibGUoc3RydWN0IGRy
bV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBlLAogCQlhZGRyX21vZGUgPSBTVDc1ODZfRElTUF9D
VFJMX01YOwogCQlicmVhazsKIAl9Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBNSVBJX0RDU19T
RVRfQUREUkVTU19NT0RFLCBhZGRyX21vZGUpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBNSVBJ
X0RDU19TRVRfQUREUkVTU19NT0RFLCBhZGRyX21vZGUpOwogCi0JbWlwaV9kYmlfY29tbWFuZCht
aXBpLCBTVDc1ODZfU0VUX0RJU1BfRFVUWSwgMHg3Zik7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBp
LCBTVDc1ODZfU0VUX1BBUlRfRElTUCwgMHhhMCk7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBN
SVBJX0RDU19TRVRfUEFSVElBTF9BUkVBLCAweDAwLCAweDAwLCAweDAwLCAweDc3KTsKLQltaXBp
X2RiaV9jb21tYW5kKG1pcGksIE1JUElfRENTX0VYSVRfSU5WRVJUX01PREUpOworCW1pcGlfZGJp
X2NvbW1hbmQoZGJpLCBTVDc1ODZfU0VUX0RJU1BfRFVUWSwgMHg3Zik7CisJbWlwaV9kYmlfY29t
bWFuZChkYmksIFNUNzU4Nl9TRVRfUEFSVF9ESVNQLCAweGEwKTsKKwltaXBpX2RiaV9jb21tYW5k
KGRiaSwgTUlQSV9EQ1NfU0VUX1BBUlRJQUxfQVJFQSwgMHgwMCwgMHgwMCwgMHgwMCwgMHg3Nyk7
CisJbWlwaV9kYmlfY29tbWFuZChkYmksIE1JUElfRENTX0VYSVRfSU5WRVJUX01PREUpOwogCiAJ
bXNsZWVwKDEwMCk7CiAKIAltaXBpLT5lbmFibGVkID0gdHJ1ZTsKIAlzdDc1ODZfZmJfZGlydHko
ZmIsICZyZWN0KTsKIAotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgTUlQSV9EQ1NfU0VUX0RJU1BM
QVlfT04pOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBNSVBJX0RDU19TRVRfRElTUExBWV9PTik7
CiBvdXRfZXhpdDoKIAlkcm1fZGV2X2V4aXQoaWR4KTsKIH0KQEAgLTMxOCw2ICszMjAsNyBAQCBz
dGF0aWMgaW50IHN0NzU4Nl9wcm9iZShzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpKQogCXN0cnVjdCBk
ZXZpY2UgKmRldiA9ICZzcGktPmRldjsKIAlzdHJ1Y3QgZHJtX2RldmljZSAqZHJtOwogCXN0cnVj
dCBtaXBpX2RiaSAqbWlwaTsKKwlzdHJ1Y3QgbWlwaV9kYmkgKmRiaTsKIAlzdHJ1Y3QgZ3Bpb19k
ZXNjICphMDsKIAl1MzIgcm90YXRpb24gPSAwOwogCXNpemVfdCBidWZzaXplOwpAQCAtMzI3LDYg
KzMzMCw3IEBAIHN0YXRpYyBpbnQgc3Q3NTg2X3Byb2JlKHN0cnVjdCBzcGlfZGV2aWNlICpzcGkp
CiAJaWYgKCFtaXBpKQogCQlyZXR1cm4gLUVOT01FTTsKIAorCWRiaSA9IG1pcGk7CiAJZHJtID0g
Jm1pcGktPmRybTsKIAlyZXQgPSBkZXZtX2RybV9kZXZfaW5pdChkZXYsIGRybSwgJnN0NzU4Nl9k
cml2ZXIpOwogCWlmIChyZXQpIHsKQEAgLTMzOCwxMCArMzQyLDEwIEBAIHN0YXRpYyBpbnQgc3Q3
NTg2X3Byb2JlKHN0cnVjdCBzcGlfZGV2aWNlICpzcGkpCiAKIAlidWZzaXplID0gKHN0NzU4Nl9t
b2RlLnZkaXNwbGF5ICsgMikgLyAzICogc3Q3NTg2X21vZGUuaGRpc3BsYXk7CiAKLQltaXBpLT5y
ZXNldCA9IGRldm1fZ3Bpb2RfZ2V0KGRldiwgInJlc2V0IiwgR1BJT0RfT1VUX0hJR0gpOwotCWlm
IChJU19FUlIobWlwaS0+cmVzZXQpKSB7CisJZGJpLT5yZXNldCA9IGRldm1fZ3Bpb2RfZ2V0KGRl
diwgInJlc2V0IiwgR1BJT0RfT1VUX0hJR0gpOworCWlmIChJU19FUlIoZGJpLT5yZXNldCkpIHsK
IAkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8gZ2V0IGdwaW8gJ3Jlc2V0J1xuIik7Ci0J
CXJldHVybiBQVFJfRVJSKG1pcGktPnJlc2V0KTsKKwkJcmV0dXJuIFBUUl9FUlIoZGJpLT5yZXNl
dCk7CiAJfQogCiAJYTAgPSBkZXZtX2dwaW9kX2dldChkZXYsICJhMCIsIEdQSU9EX09VVF9MT1cp
OwpAQCAtMzUyLDEyICszNTYsMTIgQEAgc3RhdGljIGludCBzdDc1ODZfcHJvYmUoc3RydWN0IHNw
aV9kZXZpY2UgKnNwaSkKIAogCWRldmljZV9wcm9wZXJ0eV9yZWFkX3UzMihkZXYsICJyb3RhdGlv
biIsICZyb3RhdGlvbik7CiAKLQlyZXQgPSBtaXBpX2RiaV9zcGlfaW5pdChzcGksIG1pcGksIGEw
KTsKKwlyZXQgPSBtaXBpX2RiaV9zcGlfaW5pdChzcGksIGRiaSwgYTApOwogCWlmIChyZXQpCiAJ
CXJldHVybiByZXQ7CiAKIAkvKiBDYW5ub3QgcmVhZCBmcm9tIHRoaXMgY29udHJvbGxlciB2aWEg
U1BJICovCi0JbWlwaS0+cmVhZF9jb21tYW5kcyA9IE5VTEw7CisJZGJpLT5yZWFkX2NvbW1hbmRz
ID0gTlVMTDsKIAogCXJldCA9IG1pcGlfZGJpX2luaXRfd2l0aF9mb3JtYXRzKG1pcGksICZzdDc1
ODZfcGlwZV9mdW5jcywKIAkJCQkJIHN0NzU4Nl9mb3JtYXRzLCBBUlJBWV9TSVpFKHN0NzU4Nl9m
b3JtYXRzKSwKQEAgLTM3Miw3ICszNzYsNyBAQCBzdGF0aWMgaW50IHN0NzU4Nl9wcm9iZShzdHJ1
Y3Qgc3BpX2RldmljZSAqc3BpKQogCSAqIGJ5dGVzIG9uIGxpdHRsZS1lbmRpYW4gc3lzdGVtcyBh
bmQgY2F1c2VzIG91dCBvZiBvcmRlciBkYXRhIHRvIGJlCiAJICogc2VudCB0byB0aGUgZGlzcGxh
eSkuCiAJICovCi0JbWlwaS0+c3dhcF9ieXRlcyA9IHRydWU7CisJZGJpLT5zd2FwX2J5dGVzID0g
dHJ1ZTsKIAogCWRybV9tb2RlX2NvbmZpZ19yZXNldChkcm0pOwogCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vdGlueWRybS9zdDc3MzVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vdGlueWRybS9z
dDc3MzVyLmMKaW5kZXggMTUxNzQ5MDM1YTE5Li40MzA5YWUyOTk3NjYgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS90aW55ZHJtL3N0NzczNXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdGlu
eWRybS9zdDc3MzVyLmMKQEAgLTQzLDYgKzQzLDcgQEAgc3RhdGljIHZvaWQgamRfdDE4MDAzX3Qw
MV9waXBlX2VuYWJsZShzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCiAJCQkJ
ICAgICAgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCiB7CiAJc3RydWN0IG1p
cGlfZGJpICptaXBpID0gZHJtX3RvX21pcGlfZGJpKHBpcGUtPmNydGMuZGV2KTsKKwlzdHJ1Y3Qg
bWlwaV9kYmkgKmRiaSA9IG1pcGk7CiAJaW50IHJldCwgaWR4OwogCXU4IGFkZHJfbW9kZTsKIApA
QCAtNTcsMjEgKzU4LDIxIEBAIHN0YXRpYyB2b2lkIGpkX3QxODAwM190MDFfcGlwZV9lbmFibGUo
c3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBlLAogCiAJbXNsZWVwKDE1MCk7CiAK
LQltaXBpX2RiaV9jb21tYW5kKG1pcGksIE1JUElfRENTX0VYSVRfU0xFRVBfTU9ERSk7CisJbWlw
aV9kYmlfY29tbWFuZChkYmksIE1JUElfRENTX0VYSVRfU0xFRVBfTU9ERSk7CiAJbXNsZWVwKDUw
MCk7CiAKLQltaXBpX2RiaV9jb21tYW5kKG1pcGksIFNUNzczNVJfRlJNQ1RSMSwgMHgwMSwgMHgy
YywgMHgyZCk7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBTVDc3MzVSX0ZSTUNUUjIsIDB4MDEs
IDB4MmMsIDB4MmQpOwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgU1Q3NzM1Ul9GUk1DVFIzLCAw
eDAxLCAweDJjLCAweDJkLCAweDAxLCAweDJjLAorCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBTVDc3
MzVSX0ZSTUNUUjEsIDB4MDEsIDB4MmMsIDB4MmQpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBT
VDc3MzVSX0ZSTUNUUjIsIDB4MDEsIDB4MmMsIDB4MmQpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJp
LCBTVDc3MzVSX0ZSTUNUUjMsIDB4MDEsIDB4MmMsIDB4MmQsIDB4MDEsIDB4MmMsCiAJCQkgMHgy
ZCk7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBTVDc3MzVSX0lOVkNUUiwgMHgwNyk7Ci0JbWlw
aV9kYmlfY29tbWFuZChtaXBpLCBTVDc3MzVSX1BXQ1RSMSwgMHhhMiwgMHgwMiwgMHg4NCk7Ci0J
bWlwaV9kYmlfY29tbWFuZChtaXBpLCBTVDc3MzVSX1BXQ1RSMiwgMHhjNSk7Ci0JbWlwaV9kYmlf
Y29tbWFuZChtaXBpLCBTVDc3MzVSX1BXQ1RSMywgMHgwYSwgMHgwMCk7Ci0JbWlwaV9kYmlfY29t
bWFuZChtaXBpLCBTVDc3MzVSX1BXQ1RSNCwgMHg4YSwgMHgyYSk7Ci0JbWlwaV9kYmlfY29tbWFu
ZChtaXBpLCBTVDc3MzVSX1BXQ1RSNSwgMHg4YSwgMHhlZSk7Ci0JbWlwaV9kYmlfY29tbWFuZCht
aXBpLCBTVDc3MzVSX1ZNQ1RSMSwgMHgwZSk7Ci0JbWlwaV9kYmlfY29tbWFuZChtaXBpLCBNSVBJ
X0RDU19FWElUX0lOVkVSVF9NT0RFKTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgU1Q3NzM1Ul9J
TlZDVFIsIDB4MDcpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBTVDc3MzVSX1BXQ1RSMSwgMHhh
MiwgMHgwMiwgMHg4NCk7CisJbWlwaV9kYmlfY29tbWFuZChkYmksIFNUNzczNVJfUFdDVFIyLCAw
eGM1KTsKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgU1Q3NzM1Ul9QV0NUUjMsIDB4MGEsIDB4MDAp
OworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBTVDc3MzVSX1BXQ1RSNCwgMHg4YSwgMHgyYSk7CisJ
bWlwaV9kYmlfY29tbWFuZChkYmksIFNUNzczNVJfUFdDVFI1LCAweDhhLCAweGVlKTsKKwltaXBp
X2RiaV9jb21tYW5kKGRiaSwgU1Q3NzM1Ul9WTUNUUjEsIDB4MGUpOworCW1pcGlfZGJpX2NvbW1h
bmQoZGJpLCBNSVBJX0RDU19FWElUX0lOVkVSVF9NT0RFKTsKIAlzd2l0Y2ggKG1pcGktPnJvdGF0
aW9uKSB7CiAJZGVmYXVsdDoKIAkJYWRkcl9tb2RlID0gU1Q3NzM1Ul9NWCB8IFNUNzczNVJfTVk7
CkBAIC04NiwyMCArODcsMjAgQEAgc3RhdGljIHZvaWQgamRfdDE4MDAzX3QwMV9waXBlX2VuYWJs
ZShzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCiAJCWFkZHJfbW9kZSA9IFNU
NzczNVJfTVkgfCBTVDc3MzVSX01WOwogCQlicmVhazsKIAl9Ci0JbWlwaV9kYmlfY29tbWFuZCht
aXBpLCBNSVBJX0RDU19TRVRfQUREUkVTU19NT0RFLCBhZGRyX21vZGUpOwotCW1pcGlfZGJpX2Nv
bW1hbmQobWlwaSwgTUlQSV9EQ1NfU0VUX1BJWEVMX0ZPUk1BVCwKKwltaXBpX2RiaV9jb21tYW5k
KGRiaSwgTUlQSV9EQ1NfU0VUX0FERFJFU1NfTU9ERSwgYWRkcl9tb2RlKTsKKwltaXBpX2RiaV9j
b21tYW5kKGRiaSwgTUlQSV9EQ1NfU0VUX1BJWEVMX0ZPUk1BVCwKIAkJCSBNSVBJX0RDU19QSVhF
TF9GTVRfMTZCSVQpOwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgU1Q3NzM1Ul9HQU1DVFJQMSwg
MHgwMiwgMHgxYywgMHgwNywgMHgxMiwgMHgzNywKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgU1Q3
NzM1Ul9HQU1DVFJQMSwgMHgwMiwgMHgxYywgMHgwNywgMHgxMiwgMHgzNywKIAkJCSAweDMyLCAw
eDI5LCAweDJkLCAweDI5LCAweDI1LCAweDJiLCAweDM5LCAweDAwLCAweDAxLAogCQkJIDB4MDMs
IDB4MTApOwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgU1Q3NzM1Ul9HQU1DVFJOMSwgMHgwMywg
MHgxZCwgMHgwNywgMHgwNiwgMHgyZSwKKwltaXBpX2RiaV9jb21tYW5kKGRiaSwgU1Q3NzM1Ul9H
QU1DVFJOMSwgMHgwMywgMHgxZCwgMHgwNywgMHgwNiwgMHgyZSwKIAkJCSAweDJjLCAweDI5LCAw
eDJkLCAweDJlLCAweDJlLCAweDM3LCAweDNmLCAweDAwLCAweDAwLAogCQkJIDB4MDIsIDB4MTAp
OwotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlfT04pOworCW1p
cGlfZGJpX2NvbW1hbmQoZGJpLCBNSVBJX0RDU19TRVRfRElTUExBWV9PTik7CiAKIAltc2xlZXAo
MTAwKTsKIAotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgTUlQSV9EQ1NfRU5URVJfTk9STUFMX01P
REUpOworCW1pcGlfZGJpX2NvbW1hbmQoZGJpLCBNSVBJX0RDU19FTlRFUl9OT1JNQUxfTU9ERSk7
CiAKIAltc2xlZXAoMjApOwogCkBAIC0xNTEsNiArMTUyLDcgQEAgc3RhdGljIGludCBzdDc3MzVy
X3Byb2JlKHN0cnVjdCBzcGlfZGV2aWNlICpzcGkpCiAJc3RydWN0IGRldmljZSAqZGV2ID0gJnNw
aS0+ZGV2OwogCXN0cnVjdCBkcm1fZGV2aWNlICpkcm07CiAJc3RydWN0IG1pcGlfZGJpICptaXBp
OworCXN0cnVjdCBtaXBpX2RiaSAqZGJpOwogCXN0cnVjdCBncGlvX2Rlc2MgKmRjOwogCXUzMiBy
b3RhdGlvbiA9IDA7CiAJaW50IHJldDsKQEAgLTE1OSw2ICsxNjEsNyBAQCBzdGF0aWMgaW50IHN0
NzczNXJfcHJvYmUoc3RydWN0IHNwaV9kZXZpY2UgKnNwaSkKIAlpZiAoIW1pcGkpCiAJCXJldHVy
biAtRU5PTUVNOwogCisJZGJpID0gbWlwaTsKIAlkcm0gPSAmbWlwaS0+ZHJtOwogCXJldCA9IGRl
dm1fZHJtX2Rldl9pbml0KGRldiwgZHJtLCAmc3Q3NzM1cl9kcml2ZXIpOwogCWlmIChyZXQpIHsK
QEAgLTE2OCwxMCArMTcxLDEwIEBAIHN0YXRpYyBpbnQgc3Q3NzM1cl9wcm9iZShzdHJ1Y3Qgc3Bp
X2RldmljZSAqc3BpKQogCiAJZHJtX21vZGVfY29uZmlnX2luaXQoZHJtKTsKIAotCW1pcGktPnJl
c2V0ID0gZGV2bV9ncGlvZF9nZXQoZGV2LCAicmVzZXQiLCBHUElPRF9PVVRfSElHSCk7Ci0JaWYg
KElTX0VSUihtaXBpLT5yZXNldCkpIHsKKwlkYmktPnJlc2V0ID0gZGV2bV9ncGlvZF9nZXQoZGV2
LCAicmVzZXQiLCBHUElPRF9PVVRfSElHSCk7CisJaWYgKElTX0VSUihkYmktPnJlc2V0KSkgewog
CQlEUk1fREVWX0VSUk9SKGRldiwgIkZhaWxlZCB0byBnZXQgZ3BpbyAncmVzZXQnXG4iKTsKLQkJ
cmV0dXJuIFBUUl9FUlIobWlwaS0+cmVzZXQpOworCQlyZXR1cm4gUFRSX0VSUihkYmktPnJlc2V0
KTsKIAl9CiAKIAlkYyA9IGRldm1fZ3Bpb2RfZ2V0KGRldiwgImRjIiwgR1BJT0RfT1VUX0xPVyk7
CkBAIC0xODYsMTIgKzE4OSwxMiBAQCBzdGF0aWMgaW50IHN0NzczNXJfcHJvYmUoc3RydWN0IHNw
aV9kZXZpY2UgKnNwaSkKIAogCWRldmljZV9wcm9wZXJ0eV9yZWFkX3UzMihkZXYsICJyb3RhdGlv
biIsICZyb3RhdGlvbik7CiAKLQlyZXQgPSBtaXBpX2RiaV9zcGlfaW5pdChzcGksIG1pcGksIGRj
KTsKKwlyZXQgPSBtaXBpX2RiaV9zcGlfaW5pdChzcGksIGRiaSwgZGMpOwogCWlmIChyZXQpCiAJ
CXJldHVybiByZXQ7CiAKIAkvKiBDYW5ub3QgcmVhZCBmcm9tIEFkYWZydWl0IDEuOCIgZGlzcGxh
eSB2aWEgU1BJICovCi0JbWlwaS0+cmVhZF9jb21tYW5kcyA9IE5VTEw7CisJZGJpLT5yZWFkX2Nv
bW1hbmRzID0gTlVMTDsKIAogCXJldCA9IG1pcGlfZGJpX2luaXQobWlwaSwgJmpkX3QxODAwM190
MDFfcGlwZV9mdW5jcywgJmpkX3QxODAwM190MDFfbW9kZSwgcm90YXRpb24pOwogCWlmIChyZXQp
CmRpZmYgLS1naXQgYS9pbmNsdWRlL2RybS90aW55ZHJtL21pcGktZGJpLmggYi9pbmNsdWRlL2Ry
bS90aW55ZHJtL21pcGktZGJpLmgKaW5kZXggMzkzMzIzZjg3ZTEyLi4wNGI1NGVjNjFiYzIgMTAw
NjQ0Ci0tLSBhL2luY2x1ZGUvZHJtL3Rpbnlkcm0vbWlwaS1kYmkuaAorKysgYi9pbmNsdWRlL2Ry
bS90aW55ZHJtL21pcGktZGJpLmgKQEAgLTU5LDcgKzU5LDcgQEAgc3RydWN0IG1pcGlfZGJpIHsK
IAlzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpOwogCWJvb2wgZW5hYmxlZDsKIAlzdHJ1Y3QgbXV0ZXgg
Y21kbG9jazsKLQlpbnQgKCpjb21tYW5kKShzdHJ1Y3QgbWlwaV9kYmkgKm1pcGksIHU4ICpjbWQs
IHU4ICpwYXJhbSwgc2l6ZV90IG51bSk7CisJaW50ICgqY29tbWFuZCkoc3RydWN0IG1pcGlfZGJp
ICpkYmksIHU4ICpjbWQsIHU4ICpwYXJhbSwgc2l6ZV90IG51bSk7CiAJY29uc3QgdTggKnJlYWRf
Y29tbWFuZHM7CiAJc3RydWN0IGdwaW9fZGVzYyAqZGM7CiAJdTE2ICp0eF9idWY7CkBAIC03Nyw3
ICs3Nyw3IEBAIHN0YXRpYyBpbmxpbmUgc3RydWN0IG1pcGlfZGJpICpkcm1fdG9fbWlwaV9kYmko
c3RydWN0IGRybV9kZXZpY2UgKmRybSkKIAlyZXR1cm4gY29udGFpbmVyX29mKGRybSwgc3RydWN0
IG1pcGlfZGJpLCBkcm0pOwogfQogCi1pbnQgbWlwaV9kYmlfc3BpX2luaXQoc3RydWN0IHNwaV9k
ZXZpY2UgKnNwaSwgc3RydWN0IG1pcGlfZGJpICptaXBpLAoraW50IG1pcGlfZGJpX3NwaV9pbml0
KHN0cnVjdCBzcGlfZGV2aWNlICpzcGksIHN0cnVjdCBtaXBpX2RiaSAqZGJpLAogCQkgICAgICBz
dHJ1Y3QgZ3Bpb19kZXNjICpkYyk7CiBpbnQgbWlwaV9kYmlfaW5pdF93aXRoX2Zvcm1hdHMoc3Ry
dWN0IG1pcGlfZGJpICptaXBpLAogCQkJICAgICAgIGNvbnN0IHN0cnVjdCBkcm1fc2ltcGxlX2Rp
c3BsYXlfcGlwZV9mdW5jcyAqZnVuY3MsCkBAIC05NCw4ICs5NCw4IEBAIHZvaWQgbWlwaV9kYmlf
ZW5hYmxlX2ZsdXNoKHN0cnVjdCBtaXBpX2RiaSAqbWlwaSwKIAkJCSAgIHN0cnVjdCBkcm1fY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCSAgIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnBsYW5f
c3RhdGUpOwogdm9pZCBtaXBpX2RiaV9waXBlX2Rpc2FibGUoc3RydWN0IGRybV9zaW1wbGVfZGlz
cGxheV9waXBlICpwaXBlKTsKLXZvaWQgbWlwaV9kYmlfaHdfcmVzZXQoc3RydWN0IG1pcGlfZGJp
ICptaXBpKTsKLWJvb2wgbWlwaV9kYmlfZGlzcGxheV9pc19vbihzdHJ1Y3QgbWlwaV9kYmkgKm1p
cGkpOwordm9pZCBtaXBpX2RiaV9od19yZXNldChzdHJ1Y3QgbWlwaV9kYmkgKmRiaSk7Citib29s
IG1pcGlfZGJpX2Rpc3BsYXlfaXNfb24oc3RydWN0IG1pcGlfZGJpICpkYmkpOwogaW50IG1pcGlf
ZGJpX3Bvd2Vyb25fcmVzZXQoc3RydWN0IG1pcGlfZGJpICptaXBpKTsKIGludCBtaXBpX2RiaV9w
b3dlcm9uX2NvbmRpdGlvbmFsX3Jlc2V0KHN0cnVjdCBtaXBpX2RiaSAqbWlwaSk7CiAKQEAgLTEw
MywxNCArMTAzLDE0IEBAIHUzMiBtaXBpX2RiaV9zcGlfY21kX21heF9zcGVlZChzdHJ1Y3Qgc3Bp
X2RldmljZSAqc3BpLCBzaXplX3QgbGVuKTsKIGludCBtaXBpX2RiaV9zcGlfdHJhbnNmZXIoc3Ry
dWN0IHNwaV9kZXZpY2UgKnNwaSwgdTMyIHNwZWVkX2h6LAogCQkJICB1OCBicHcsIGNvbnN0IHZv
aWQgKmJ1Ziwgc2l6ZV90IGxlbik7CiAKLWludCBtaXBpX2RiaV9jb21tYW5kX3JlYWQoc3RydWN0
IG1pcGlfZGJpICptaXBpLCB1OCBjbWQsIHU4ICp2YWwpOwotaW50IG1pcGlfZGJpX2NvbW1hbmRf
YnVmKHN0cnVjdCBtaXBpX2RiaSAqbWlwaSwgdTggY21kLCB1OCAqZGF0YSwgc2l6ZV90IGxlbik7
Ci1pbnQgbWlwaV9kYmlfY29tbWFuZF9zdGFja2J1ZihzdHJ1Y3QgbWlwaV9kYmkgKm1pcGksIHU4
IGNtZCwgdTggKmRhdGEsIHNpemVfdCBsZW4pOworaW50IG1pcGlfZGJpX2NvbW1hbmRfcmVhZChz
dHJ1Y3QgbWlwaV9kYmkgKmRiaSwgdTggY21kLCB1OCAqdmFsKTsKK2ludCBtaXBpX2RiaV9jb21t
YW5kX2J1ZihzdHJ1Y3QgbWlwaV9kYmkgKmRiaSwgdTggY21kLCB1OCAqZGF0YSwgc2l6ZV90IGxl
bik7CitpbnQgbWlwaV9kYmlfY29tbWFuZF9zdGFja2J1ZihzdHJ1Y3QgbWlwaV9kYmkgKmRiaSwg
dTggY21kLCB1OCAqZGF0YSwgc2l6ZV90IGxlbik7CiBpbnQgbWlwaV9kYmlfYnVmX2NvcHkodm9p
ZCAqZHN0LCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwKIAkJICAgICAgc3RydWN0IGRybV9y
ZWN0ICpjbGlwLCBib29sIHN3YXApOwogLyoqCiAgKiBtaXBpX2RiaV9jb21tYW5kIC0gTUlQSSBE
Q1MgY29tbWFuZCB3aXRoIG9wdGlvbmFsIHBhcmFtZXRlcihzKQotICogQG1pcGk6IE1JUEkgc3Ry
dWN0dXJlCisgKiBAZGJpOiBNSVBJIERCSSBzdHJ1Y3R1cmUKICAqIEBjbWQ6IENvbW1hbmQKICAq
IEBzZXEuLi46IE9wdGlvbmFsIHBhcmFtZXRlcihzKQogICoKQEAgLTEyMCwxMCArMTIwLDEwIEBA
IGludCBtaXBpX2RiaV9idWZfY29weSh2b2lkICpkc3QsIHN0cnVjdCBkcm1fZnJhbWVidWZmZXIg
KmZiLAogICogUmV0dXJuczoKICAqIFplcm8gb24gc3VjY2VzcywgbmVnYXRpdmUgZXJyb3IgY29k
ZSBvbiBmYWlsdXJlLgogICovCi0jZGVmaW5lIG1pcGlfZGJpX2NvbW1hbmQobWlwaSwgY21kLCBz
ZXEuLi4pIFwKKyNkZWZpbmUgbWlwaV9kYmlfY29tbWFuZChkYmksIGNtZCwgc2VxLi4uKSBcCiAo
eyBcCiAJdTggZFtdID0geyBzZXEgfTsgXAotCW1pcGlfZGJpX2NvbW1hbmRfc3RhY2tidWYobWlw
aSwgY21kLCBkLCBBUlJBWV9TSVpFKGQpKTsgXAorCW1pcGlfZGJpX2NvbW1hbmRfc3RhY2tidWYo
ZGJpLCBjbWQsIGQsIEFSUkFZX1NJWkUoZCkpOyBcCiB9KQogCiAjaWZkZWYgQ09ORklHX0RFQlVH
X0ZTCi0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9w
Lm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1k
ZXZlbA==
