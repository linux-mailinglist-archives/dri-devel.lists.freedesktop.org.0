Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1474A195D1
	for <lists+dri-devel@lfdr.de>; Fri, 10 May 2019 01:52:40 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4C86B89CD7;
	Thu,  9 May 2019 23:52:29 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 07E358967B;
 Thu,  9 May 2019 14:56:23 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 60010AC9C;
 Thu,  9 May 2019 14:56:21 +0000 (UTC)
Date: Thu, 9 May 2019 16:56:20 +0200
From: Petr Mladek <pmladek@suse.com>
To: Daniel Vetter <daniel.vetter@ffwll.ch>
Subject: Re: [PATCH] RFC: console: hack up console_lock more v3
Message-ID: <20190509145620.2pjqko7copbxuzth@pathway.suse.cz>
References: <20190509120903.28939-1-daniel.vetter@ffwll.ch>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <20190509120903.28939-1-daniel.vetter@ffwll.ch>
User-Agent: NeoMutt/20170912 (1.9.0)
X-Mailman-Approved-At: Thu, 09 May 2019 23:52:27 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: John Ogness <john.ogness@linutronix.de>,
 Peter Zijlstra <peterz@infradead.org>,
 Intel Graphics Development <intel-gfx@lists.freedesktop.org>,
 Will Deacon <will.deacon@arm.com>, linux-kernel@vger.kernel.org,
 DRI Development <dri-devel@lists.freedesktop.org>,
 Sergey Senozhatsky <sergey.senozhatsky@gmail.com>,
 Ingo Molnar <mingo@redhat.com>, Steven Rostedt <rostedt@goodmis.org>,
 Daniel Vetter <daniel.vetter@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gVGh1IDIwMTktMDUtMDkgMTQ6MDk6MDMsIERhbmllbCBWZXR0ZXIgd3JvdGU6Cj4gY29uc29s
ZV90cnlsb2NrLCBjYWxsZWQgZnJvbSB3aXRoaW4gcHJpbnRrLCBjYW4gYmUgY2FsbGVkIGZyb20g
cHJldHR5Cj4gbXVjaCBhbnl3aGVyZS4gSW5jbHVkaW5nIHRyeV90b193YWtlX3VwLiBOb3RlIHRo
YXQgdGhpcyBpc24ndCBjb21tb24sCj4gdXN1YWxseSB0aGUgYm94IGlzIGluIHByZXR0eSBiYWQg
c2hhcGUgYXQgdGhhdCBwb2ludCBhbHJlYWR5LiBCdXQgaXQKPiByZWFsbHkgZG9lc24ndCBoZWxw
IHdoZW4gdGhlbiBsb2NrZGVwIGp1bXBzIGluIGFuZCBzcGFtcyB0aGUgbG9ncywKPiBwb3RlbnRp
YWxseSBvYnNjdXJpbmcgdGhlIHJlYWwgYmFja3RyYWNlIHdlJ3JlIHJlYWxseSBpbnRlcmVzdGVk
IGluLgo+IE9uZSBjYXNlIEkndmUgc2VlbiAoc2xpZ2h0bHkgc2ltcGxpZmllZCBiYWNrdHJhY2Up
Ogo+IAo+ICBDYWxsIFRyYWNlOgo+ICAgPElSUT4KPiAgIGNvbnNvbGVfdHJ5bG9jaysweGUvMHg2
MAo+ICAgdnByaW50a19lbWl0KzB4ZjEvMHgzMjAKPiAgIHByaW50aysweDRkLzB4NjkKPiAgIF9f
d2Fybl9wcmludGsrMHg0Ni8weDkwCj4gICBuYXRpdmVfc21wX3NlbmRfcmVzY2hlZHVsZSsweDJm
LzB4NDAKPiAgIGNoZWNrX3ByZWVtcHRfY3VycisweDgxLzB4YTAKPiAgIHR0d3VfZG9fd2FrZXVw
KzB4MTQvMHgyMjAKPiAgIHRyeV90b193YWtlX3VwKzB4MjE4LzB4NWYwCj4gICBwb2xsd2FrZSsw
eDZmLzB4OTAKPiAgIGNyZWRpdF9lbnRyb3B5X2JpdHMrMHgyMDQvMHgzMTAKPiAgIGFkZF9pbnRl
cnJ1cHRfcmFuZG9tbmVzcysweDE4Zi8weDIxMAo+ICAgaGFuZGxlX2lycSsweDY3LzB4MTYwCj4g
ICBkb19JUlErMHg1ZS8weDEzMAo+ICAgY29tbW9uX2ludGVycnVwdCsweGYvMHhmCj4gICA8L0lS
UT4KPiAKPiBUaGlzIGFsb25lIGlzbid0IGEgcHJvYmxlbSwgYnV0IHRoZSBzcGlubG9jayBpbiB0
aGUgc2VtYXBob3JlIGlzIGFsc28KPiBzdGlsbCBoZWxkIHdoaWxlIHdha2luZyB1cCB3YWl0ZXJz
ICh1cCgpIC0+IF9fdXAoKSAtPiB0cnlfdG9fd2FrZV91cCgpCj4gY2FsbGNoYWluKSwgd2hpY2gg
dGhlbiBjbG9zZXMgdGhlIHJ1bnF1ZXVlIHZzLiBzZW1hcGhvcmUubG9jayBsb29wLAo+IGFuZCB1
cHNldHMgbG9ja2RlcCwgd2hpY2ggaXNzdWVzIGEgY2lyY3VsYXIgbG9ja2luZyBzcGxhdCB0byBk
bWVzZy4KPiBXb3JzZSBpdCB1cHNldHMgZGV2ZWxvcGVycywgc2luY2Ugd2UgZG9uJ3Qgd2FudCB0
byBzcGFtIGRtZXNnIHdpdGgKPiBjbHV0dGVyIHdoZW4gdGhlIG1hY2hpbmUgaXMgZHlpbmcgYWxy
ZWFkeS4KPiAKPiBGaXggdGhpcyBieSBjcmVhdGluZyBhIHByaW5rdF9zYWZlX3VwKCkgd2hpY2gg
Y2FsbHMgd2FrZV91cF9wcm9jZXNzCj4gb3V0c2lkZSBvZiB0aGUgc3BpbmxvY2suIFRoaXMgaXNu
J3QgY29ycmVjdCBpbiBmdWxsIGdlbmVyYWxpdHksIGJ1dAo+IGdvb2QgZW5vdWdoIGZvciBjb25z
b2xlX2xvY2s6Cj4gCj4gLSBjb25zb2xlX2xvY2sgZG9lc24ndCB1c2UgaW50ZXJydXB0aWJsZSBv
ciBraWxsYWJsZSBvciB0aW1lb3V0IGRvd24oKQo+ICAgY2FsbHMsIGhlbmNlIGFuIHVwKCkgaXMg
dGhlIG9ubHkgdGhpbmcgdGhhdCBjYW4gd2FrZSB1cCBhIHByb2Nlc3MuCj4gICBIZW5jZSB0aGUg
cHJvY2VzcyBjYW4ndCBnZXQgd29rZW4gYW5kIGtpbGxlZCBhbmQgcmVhcGVkIHdoaWxlIHdlIHRy
eQo+ICAgdG8gd2FrZSBpdCB1cCB0b28uCj4gCj4gLSBzZW1hcGhvcmUuYyBhbHdheXMgdXBkYXRl
cyB0aGUgd2FpdGVyIGxpc3Qgd2hpbGUgdW5kZXIgdGhlIHNwaW5sb2NrLAo+ICAgc28gdGhlcmUn
cyBubyBvdGhlciByYWNlcy4gU3BlY2lmaWNhbGx5IGFub3RoZXIgcHJvY2VzcyB0aGF0IHJhY2Vz
Cj4gICB3aXRoIGEgcXVpY2sgY29uc29sZV9sb2NrL3VubG9jayB3aGlsZSB3ZSd2ZSBkcm9wcGVk
IHRoZSBzcGlubG9jawo+ICAgYWxyZWFkeSB3b24ndCBzZWUgb3VyIG93biB3YWl0ZXIuCj4gCj4g
Tm90ZSB0aGF0IHdlIG9ubHkgaGF2ZSB0byBicmVhayB0aGUgcmVjdXJzaW9uIGZvciB0aGUgc2Vt
YXBob3JlLmxvY2sKPiBzcGlubG9jayBvZiB0aGUgY29uc29sZV9sb2NrLiBSZWN1cnNpb24gd2l0
aGluIHZhcmlvdXMgc2NoZWR1bGVyCj4gcmVsYXRlZCBsb2NrcyBpcyBhbHJlYWR5IHByZXZlbnRl
ZCBieSB0aGUgcHJpbnRrX3NhZmVfZW50ZXIvZXhpdCBwYWlyCj4gaW4gX191cF9jb25zb2xlX3Nl
bSgpLgoKVGhpcyBpcyBub3QgZnVsbHkgdHJ1ZS4gcHJpbnRrX3NhZmUoKSBoZWxwcyBvbmx5IHdo
ZW4KdGhlIGZpcnN0IHRyeV90b193YWtlX3VwKCkgaXMgY2FsbGVkIGZyb20gcHJpbnRrX3NhZmUo
KSBjb250ZXh0LgoKPiAtLS0gYS9rZXJuZWwvbG9ja2luZy9zZW1hcGhvcmUuYwo+ICsrKyBiL2tl
cm5lbC9sb2NraW5nL3NlbWFwaG9yZS5jCj4gQEAgLTE5Nyw2ICsxOTcsMzcgQEAgc3RydWN0IHNl
bWFwaG9yZV93YWl0ZXIgewo+ICAJYm9vbCB1cDsKPiAgfTsKPiAgCj4gKy8qKgo+ICsgKiBwcmlu
dGtfc2FmZV91cCAtIHJlbGVhc2UgdGhlIHNlbWFwaG9yZSBpbiBjb25zb2xlX3VubG9jawo+ICsg
KiBAc2VtOiB0aGUgc2VtYXBob3JlIHRvIHJlbGVhc2UKPiArICoKPiArICogUmVsZWFzZSB0aGUg
c2VtYXBob3JlLiAgVW5saWtlIG11dGV4ZXMsIHVwKCkgbWF5IGJlIGNhbGxlZCBmcm9tIGFueQo+
ICsgKiBjb250ZXh0IGFuZCBldmVuIGJ5IHRhc2tzIHdoaWNoIGhhdmUgbmV2ZXIgY2FsbGVkIGRv
d24oKS4KPiArICoKPiArICogTk9URTogVGhpcyBpcyBhIHNwZWNpYWwgdmVyc2lvbiBvZiB1cCgp
IGZvciBjb25zb2xlX3VubG9jayBvbmx5LiBJdCBpcyBvbmx5Cj4gKyAqIHNhZmUgaWYgdGhlcmUg
YXJlIG5vIGtpbGxhYmxlLCBpbnRlcnJ1cHRpYmxlIG9yIHRpbWluZyBvdXQgZG93bigpIGNhbGxz
Lgo+ICsgKi8KPiArdm9pZCBwcmludGtfc2FmZV91cChzdHJ1Y3Qgc2VtYXBob3JlICpzZW0pCj4g
K3sKPiArCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gKwlzdHJ1Y3Qgc2VtYXBob3JlX3dhaXRlciAq
d2FpdGVyID0gTlVMTDsKPiArCj4gKwlyYXdfc3Bpbl9sb2NrX2lycXNhdmUoJnNlbS0+bG9jaywg
ZmxhZ3MpOwo+ICsJaWYgKGxpa2VseShsaXN0X2VtcHR5KCZzZW0tPndhaXRfbGlzdCkpKSB7Cj4g
KwkJc2VtLT5jb3VudCsrOwo+ICsJfSBlbHNlIHsKPiArCQl3YWl0ZXIgPSBsaXN0X2ZpcnN0X2Vu
dHJ5KCZzZW0tPndhaXRfbGlzdCwKPiArCQkJCQkgIHN0cnVjdCBzZW1hcGhvcmVfd2FpdGVyLCBs
aXN0KTsKPiArCQlsaXN0X2RlbCgmd2FpdGVyLT5saXN0KTsKPiArCQl3YWl0ZXItPnVwID0gdHJ1
ZTsKPiArCX0KPiArCXJhd19zcGluX3VubG9ja19pcnFyZXN0b3JlKCZzZW0tPmxvY2ssIGZsYWdz
KTsKPiArCj4gKwlpZiAod2FpdGVyKSAvKiBwcm90ZWN0ZWQgYnkgYmVpbmcgc29sZSB3YWtlIHNv
dXJjZSAqLwo+ICsJCXdha2VfdXBfcHJvY2Vzcyh3YWl0ZXItPnRhc2spOwoKSSBzdGlsbCBkbyBu
b3Qgc2VlIGhvdyB0aGlzIGNvdWxkIGhlbHAuIExldCdzIHRha2UgdGhlIGFib3ZlCmJhY2t0cmFj
ZSBhcyBleGFtcGxlOgoKICAgPElSUT4KICAgY29uc29sZV90cnlsb2NrKzB4ZS8weDYwCiAgIHZw
cmludGtfZW1pdCsweGYxLzB4MzIwCiAgIHByaW50aysweDRkLzB4NjkKICAgX193YXJuX3ByaW50
aysweDQ2LzB4OTAKICAgbmF0aXZlX3NtcF9zZW5kX3Jlc2NoZWR1bGUgKzB4MmYvMHg0MAogICBj
aGVja19wcmVlbXB0X2N1cnIrMHg4MS8weGEwCiAgIHR0d3VfZG9fd2FrZXVwKzB4MTQvMHgyMjAK
ICAgdHJ5X3RvX3dha2VfdXArMHgyMTgvMHg1ZjAKICAgcG9sbHdha2UrMHg2Zi8weDkwCiAgIGNy
ZWRpdF9lbnRyb3B5X2JpdHMrMHgyMDQvMHgzMTAKICAgYWRkX2ludGVycnVwdF9yYW5kb21uZXNz
KzB4MThmLzB4MjEwCiAgIGhhbmRsZV9pcnErMHg2Ny8weDE2MAogICBkb19JUlErMHg1ZS8weDEz
MAogICBjb21tb25faW50ZXJydXB0KzB4Zi8weGYKICAgPC9JUlE+CgpXZSBoYXZlIHRoZSBmb2xs
b3dpbmcgY2hhaW4gb2YgY2FsbHM6CgogICsgZG9fSVJRKCkKICAgIC4uLgogICAgICArIHRyeV90
b193YWtlX3VwKCkgICAgIyB0YWtlcyBwLT5waV9sb2NrCiAgICAgICAgKyB0dHd1X3JlbW90ZSgp
ICAgICAjIHRha2VzIHJxIGxvY2sKICAgICAgICAgICsgdHR3dV9kb193YWtldXAoKQoJICAgICsg
Y2hlY2tfcHJlZW1wdF9jdXJyKCkKCSAgICAgICsgbmF0aXZlX3NtcF9zZW5kX3Jlc2NoZWR1bGUo
KQoJICAgICAgICArIF9fd2Fybl9wcmludGsoKQoJCSAgKyBwcmludGsoKQoJCSAgICArIHZwcmlu
dGtfZW1pdCgpCgkJICAgICAgKyBjb25zb2xlX3RyeWxvY2soKSAjIHN1Y2Nlc3MKCQkgICAgICAr
IGNvbnNvbGVfdW5sb2NrKCkKCQkgICAgICAgICsgdXBfY29uc29sZV9zZW0oKQoJCQkgICsgdXAo
KSAjIHdhaXQgbGlzdCBpbiBub3QgZW1wdHkKCQkJICAgICsgX191cCgpCgkJCSAgICAgICsgd2Fr
ZV91cF9wcm9jZXNzKCkKCQkJICAgICAgICArIHRyeV90b193YWtlX3VwKCkKCiFCQU5HISBEZWFk
bG9jayBvbiBwLT5waV9sb2NrLgoKSXQgZG9lcyBub3QgbWF0dGVyIGlmIHRoZSBuZXN0ZWQgdHJ5
X3RvX3dha2VfdXAoKSB3YXMgY2FsbGVkCnVuZGVyIHNlbS0+bG9jayBvciBvdXRzaWRlLgoKQnkg
b3RoZXIgd29yZHMuIFRoZSBwYXRjaCByZW1vdmVkIG9uZSBsb2NrZGVwIHdhcm5pbmcuIEJ1dCBp
dCBqdXN0Cmp1c3QgZGVsYXllZCB0aGUgZGVhZGxvY2suIEl0IHdpbGwgbm90IGhhcHBlbiBvbiBz
ZW0tPmxvY2sgYnV0CmxhdGVyIG9uIHAtPnBpX2xvY2suCgpJIGFtIHJlcGVhdGluZyBteXNlbGYu
IEJ1dCBJTUhPLCB0aGUgb25seSBzb2x1dGlvbiBpcyB0byBpbnRyb2R1Y2UKcHJpbnRrIGRlZmVy
cmVkIGNvbnRleHQgYW5kIHVzZSBpdCBpbiBXQVJOX0RFRkVSUkVEKCkuCgpCZXN0IFJlZ2FyZHMs
ClBldHIKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJp
LWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
