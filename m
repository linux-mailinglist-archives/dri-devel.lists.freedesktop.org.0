Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id CD7EC10F496
	for <lists+dri-devel@lfdr.de>; Tue,  3 Dec 2019 02:38:42 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 22AD86E362;
	Tue,  3 Dec 2019 01:38:40 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mailgw01.mediatek.com (unknown [210.61.82.183])
 by gabe.freedesktop.org (Postfix) with ESMTP id 6B2D66E33C
 for <dri-devel@lists.freedesktop.org>; Tue,  3 Dec 2019 01:38:38 +0000 (UTC)
X-UUID: b0881f0326c3448da76daf101593d0f0-20191203
X-UUID: b0881f0326c3448da76daf101593d0f0-20191203
Received: from mtkcas08.mediatek.inc [(172.21.101.126)] by
 mailgw01.mediatek.com (envelope-from <ck.hu@mediatek.com>)
 (Cellopoint E-mail Firewall v4.1.10 Build 0809 with TLS)
 with ESMTP id 1907750908; Tue, 03 Dec 2019 09:38:35 +0800
Received: from mtkcas07.mediatek.inc (172.21.101.84) by
 mtkmbs05n2.mediatek.inc (172.21.101.140) with Microsoft SMTP Server (TLS) id
 15.0.1395.4; Tue, 3 Dec 2019 09:38:19 +0800
Received: from [172.21.77.4] (172.21.77.4) by mtkcas07.mediatek.inc
 (172.21.101.73) with Microsoft SMTP Server id 15.0.1395.4 via Frontend
 Transport; Tue, 3 Dec 2019 09:38:14 +0800
Message-ID: <1575337114.1155.4.camel@mtksdaap41>
Subject: Re: [PATCH v1 6/6] drm/mediatek: apply CMDQ control flow
From: CK Hu <ck.hu@mediatek.com>
To: Bibby Hsieh <bibby.hsieh@mediatek.com>
Date: Tue, 3 Dec 2019 09:38:34 +0800
In-Reply-To: <20191128024238.9399-7-bibby.hsieh@mediatek.com>
References: <20191128024238.9399-1-bibby.hsieh@mediatek.com>
 <20191128024238.9399-7-bibby.hsieh@mediatek.com>
X-Mailer: Evolution 3.10.4-0ubuntu2 
MIME-Version: 1.0
X-MTK: N
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; d=mediatek.com; s=dk; 
 h=Content-Transfer-Encoding:MIME-Version:Content-Type:References:In-Reply-To:Date:CC:To:From:Subject:Message-ID;
 bh=sRwMLRyS13CHATbRSBNDwYj8Xi6G067HZgFuCYy6r9Q=; 
 b=j51GpkASqoKybtF0UEFO5GYzvYBVHTZAb0ja5+kX1aCTTMcI8k3yfEYB6avjzwA7Fnp7fMi9JgRoJ0HY1S0n3xJBZa9CksS1dbRyIoi9WY8Mvkkp6EJWqZ7VNqCYD1UHjvDxS16fa5ZjdZhfHY6Gu7d64/Q7Eq/hs3nTC3X2XVw=;
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: drinkcat@chromium.org, Yongqiang Niu <yongqiang.niu@mediatek.com>,
 srv_heupstream@mediatek.com, David Airlie <airlied@linux.ie>,
 Daniel Vetter <daniel.vetter@ffwll.ch>, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, tfiga@chromium.org,
 Thierry Reding <thierry.reding@gmail.com>, linux-mediatek@lists.infradead.org,
 Matthias Brugger <matthias.bgg@gmail.com>,
 linux-arm-kernel@lists.infradead.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SGksIEJpYmJ5Og0KDQpPbiBUaHUsIDIwMTktMTEtMjggYXQgMTA6NDIgKzA4MDAsIEJpYmJ5IEhz
aWVoIHdyb3RlOg0KPiBVbmxpa2Ugb3RoZXIgU29DcywgTVQ4MTgzIGRvZXMgbm90IGhhdmUgInNo
YWRvdyINCj4gcmVnaXN0ZXJzIGZvciBwZXJmb3JtYWluZyBhbiBhdG9taWMgdmlkZW8gbW9kZQ0K
PiBzZXQgb3IgcGFnZSBmbGlwIGF0IHZibGFuay92c3luYy4NCj4gDQo+IFRoZSBDTURRIChDb21t
ZW5kIFF1ZXVlKSBpbiBNVDgxODMgaXMgdXNlZCB0byBoZWxwDQo+IHVwZGF0ZSBhbGwgcmVsZXZh
bnQgZGlzcGxheSBjb250cm9sbGVyIHJlZ2lzdGVycw0KPiB3aXRoIGNyaXRpY2FsIHRpbWUgbGlt
YXRpb24uDQo+IA0KPiBTaWduZWQtb2ZmLWJ5OiBZVCBTaGVuIDx5dC5zaGVuQG1lZGlhdGVrLmNv
bT4NCj4gU2lnbmVkLW9mZi1ieTogQ0sgSHUgPGNrLmh1QG1lZGlhdGVrLmNvbT4NCj4gU2lnbmVk
LW9mZi1ieTogUGhpbGlwcCBaYWJlbCA8cC56YWJlbEBwZW5ndXRyb25peC5kZT4NCj4gU2lnbmVk
LW9mZi1ieTogQmliYnkgSHNpZWggPGJpYmJ5LmhzaWVoQG1lZGlhdGVrLmNvbT4NCj4gU2lnbmVk
LW9mZi1ieTogWW9uZ3FpYW5nIE5pdSA8eW9uZ3FpYW5nLm5pdUBtZWRpYXRlay5jb20+DQo+IC0t
LQ0KPiAgZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fY3J0Yy5jICAgICB8IDg2ICsr
KysrKysrKysrKysrKysrKysrLQ0KPiAgZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1f
ZGRwX2NvbXAuYyB8IDMxICsrKysrKysrDQo+ICAyIGZpbGVzIGNoYW5nZWQsIDExMyBpbnNlcnRp
b25zKCspLCA0IGRlbGV0aW9ucygtKQ0KPiANCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9tZWRpYXRlay9tdGtfZHJtX2NydGMuYyBiL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtf
ZHJtX2NydGMuYw0KPiBpbmRleCBmY2Y0ZTc1NWUwYmQuLjFiNGU1MzdhYzNjMSAxMDA2NDQNCj4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fY3J0Yy5jDQo+ICsrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2NydGMuYw0KPiBAQCAtMTIsNiArMTIsOCBA
QA0KPiAgI2luY2x1ZGUgPGRybS9kcm1fcGxhbmVfaGVscGVyLmg+DQo+ICAjaW5jbHVkZSA8ZHJt
L2RybV9wcm9iZV9oZWxwZXIuaD4NCj4gICNpbmNsdWRlIDxkcm0vZHJtX3ZibGFuay5oPg0KPiAr
I2luY2x1ZGUgPGxpbnV4L29mX2FkZHJlc3MuaD4NCj4gKyNpbmNsdWRlIDxsaW51eC9zb2MvbWVk
aWF0ZWsvbXRrLWNtZHEuaD4NCj4gIA0KPiAgI2luY2x1ZGUgIm10a19kcm1fZHJ2LmgiDQo+ICAj
aW5jbHVkZSAibXRrX2RybV9jcnRjLmgiDQo+IEBAIC00Miw2ICs0NCw5IEBAIHN0cnVjdCBtdGtf
ZHJtX2NydGMgew0KPiAgCXVuc2lnbmVkIGludAkJCWxheWVyX25yOw0KPiAgCWJvb2wJCQkJcGVu
ZGluZ19wbGFuZXM7DQo+ICANCj4gKwlzdHJ1Y3QgY21kcV9jbGllbnQJCSpjbWRxX2NsaWVudDsN
Cj4gKwl1MzIJCQkJY21kcV9ldmVudDsNCj4gKw0KPiAgCXZvaWQgX19pb21lbQkJCSpjb25maWdf
cmVnczsNCj4gIAljb25zdCBzdHJ1Y3QgbXRrX21tc3lzX3JlZ19kYXRhICptbXN5c19yZWdfZGF0
YTsNCj4gIAlzdHJ1Y3QgbXRrX2Rpc3BfbXV0ZXgJCSptdXRleDsNCj4gQEAgLTU2LDYgKzYxLDEx
IEBAIHN0cnVjdCBtdGtfY3J0Y19zdGF0ZSB7DQo+ICAJdW5zaWduZWQgaW50CQkJcGVuZGluZ193
aWR0aDsNCj4gIAl1bnNpZ25lZCBpbnQJCQlwZW5kaW5nX2hlaWdodDsNCj4gIAl1bnNpZ25lZCBp
bnQJCQlwZW5kaW5nX3ZyZWZyZXNoOw0KPiArCXN0cnVjdCBjbWRxX3BrdAkJCSpjbWRxX2hhbmRs
ZTsNCj4gK307DQo+ICsNCj4gK3N0cnVjdCBtdGtfY21kcV9jYl9kYXRhIHsNCj4gKwlzdHJ1Y3Qg
Y21kcV9wa3QJCQkqY21kcV9oYW5kbGU7DQo+ICB9Ow0KPiAgDQo+ICBzdGF0aWMgaW5saW5lIHN0
cnVjdCBtdGtfZHJtX2NydGMgKnRvX210a19jcnRjKHN0cnVjdCBkcm1fY3J0YyAqYykNCj4gQEAg
LTIyOSw2ICsyMzksNDYgQEAgc3RydWN0IG10a19kZHBfY29tcCAqbXRrX2RybV9kZHBfY29tcF9m
b3JfcGxhbmUoc3RydWN0IGRybV9jcnRjICpjcnRjLA0KPiAgCXJldHVybiBOVUxMOw0KPiAgfQ0K
PiAgDQo+ICsjaWZkZWYgQ09ORklHX01US19DTURRDQo+ICtzdGF0aWMgdm9pZCBkZHBfY21kcV9j
YihzdHJ1Y3QgY21kcV9jYl9kYXRhIGRhdGEpDQo+ICt7DQo+ICsJc3RydWN0IG10a19jbWRxX2Ni
X2RhdGEgKmNiX2RhdGEgPSBkYXRhLmRhdGE7DQo+ICsNCj4gKwljbWRxX3BrdF9kZXN0cm95KGNi
X2RhdGEtPmNtZHFfaGFuZGxlKTsNCj4gKwlrZnJlZShjYl9kYXRhKTsNCj4gK30NCj4gKw0KPiAr
c3RhdGljIHZvaWQgbXRrX2NtZHFfYWNxdWlyZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMpDQo+ICt7
DQo+ICsJc3RydWN0IG10a19jcnRjX3N0YXRlICptdGtfY3J0Y19zdGF0ZSA9DQo+ICsJCQl0b19t
dGtfY3J0Y19zdGF0ZShjcnRjLT5zdGF0ZSk7DQo+ICsJc3RydWN0IG10a19kcm1fY3J0YyAqbXRr
X2NydGMgPSB0b19tdGtfY3J0YyhjcnRjKTsNCj4gKw0KPiArCW10a19jcnRjX3N0YXRlLT5jbWRx
X2hhbmRsZSA9DQo+ICsJCQljbWRxX3BrdF9jcmVhdGUobXRrX2NydGMtPmNtZHFfY2xpZW50LA0K
PiArCQkJCQlQQUdFX1NJWkUpOw0KDQpJIHdvdWxkIGxpa2UgdG8gcmVtb3ZlIGF0b21pYyBmZWF0
dXJlIGluIGNtZHEgZHJpdmVyIGFuZCBkcm0gZHJpdmVyDQpjb3VsZCByZXVzZSB0aGUgcGt0LiBQ
bGVhc2UgcmVmZXIgdG8gWzFdIGZvciBkZXRhaWwuDQoNClsxXQ0KaHR0cDovL2xpc3RzLmluZnJh
ZGVhZC5vcmcvcGlwZXJtYWlsL2xpbnV4LW1lZGlhdGVrLzIwMTktSmFudWFyeS8wMTY4NjYuaHRt
bA0KDQo+ICsJY21kcV9wa3RfY2xlYXJfZXZlbnQobXRrX2NydGNfc3RhdGUtPmNtZHFfaGFuZGxl
LA0KPiArCQkJICAgICBtdGtfY3J0Yy0+Y21kcV9ldmVudCk7DQo+ICsJY21kcV9wa3Rfd2ZlKG10
a19jcnRjX3N0YXRlLT5jbWRxX2hhbmRsZSwgbXRrX2NydGMtPmNtZHFfZXZlbnQpOw0KPiArfQ0K
PiArDQo+ICtzdGF0aWMgdm9pZCBtdGtfY21kcV9yZWxlYXNlKHN0cnVjdCBkcm1fY3J0YyAqY3J0
YykNCj4gK3sNCj4gKwlzdHJ1Y3QgbXRrX2NydGNfc3RhdGUgKm10a19jcnRjX3N0YXRlID0NCj4g
KwkJCXRvX210a19jcnRjX3N0YXRlKGNydGMtPnN0YXRlKTsNCj4gKwlzdHJ1Y3QgbXRrX2NtZHFf
Y2JfZGF0YSAqY2JfZGF0YTsNCj4gKw0KPiArCWNiX2RhdGEgPSBrbWFsbG9jKHNpemVvZigqY2Jf
ZGF0YSksIEdGUF9LRVJORUwpOw0KPiArCWlmICghY2JfZGF0YSkgew0KPiArCQlEUk1fREVWX0VS
Uk9SKGNydGMtPmRldi0+ZGV2LCAiRmFpbGVkIHRvIGFsbG9jIGNiX2RhdGFcbiIpOw0KPiArCQly
ZXR1cm47DQo+ICsJfQ0KPiArDQo+ICsJY2JfZGF0YS0+Y21kcV9oYW5kbGUgPSBtdGtfY3J0Y19z
dGF0ZS0+Y21kcV9oYW5kbGU7DQo+ICsJY21kcV9wa3RfZmx1c2hfYXN5bmMobXRrX2NydGNfc3Rh
dGUtPmNtZHFfaGFuZGxlLA0KPiArCQkJICAgICBkZHBfY21kcV9jYiwgY2JfZGF0YSk7DQo+ICt9
DQo+ICsjZW5kaWYNCj4gIHN0YXRpYyBpbnQgbXRrX2NydGNfZGRwX2h3X2luaXQoc3RydWN0IG10
a19kcm1fY3J0YyAqbXRrX2NydGMpDQo+ICB7DQo+ICAJc3RydWN0IGRybV9jcnRjICpjcnRjID0g
Jm10a19jcnRjLT5iYXNlOw0KPiBAQCAtMzgzLDcgKzQzMyw4IEBAIHN0YXRpYyB2b2lkIG10a19j
cnRjX2RkcF9jb25maWcoc3RydWN0IGRybV9jcnRjICpjcnRjKQ0KPiAgCWlmIChzdGF0ZS0+cGVu
ZGluZ19jb25maWcpIHsNCj4gIAkJbXRrX2RkcF9jb21wX2NvbmZpZyhjb21wLCBzdGF0ZS0+cGVu
ZGluZ193aWR0aCwNCj4gIAkJCQkgICAgc3RhdGUtPnBlbmRpbmdfaGVpZ2h0LA0KPiAtCQkJCSAg
ICBzdGF0ZS0+cGVuZGluZ192cmVmcmVzaCwgMCwgTlVMTCk7DQo+ICsJCQkJICAgIHN0YXRlLT5w
ZW5kaW5nX3ZyZWZyZXNoLCAwLA0KPiArCQkJCSAgICBzdGF0ZS0+Y21kcV9oYW5kbGUpOw0KPiAg
DQo+ICAJCXN0YXRlLT5wZW5kaW5nX2NvbmZpZyA9IGZhbHNlOw0KPiAgCX0NCj4gQEAgLTQwMyw3
ICs0NTQsOCBAQCBzdGF0aWMgdm9pZCBtdGtfY3J0Y19kZHBfY29uZmlnKHN0cnVjdCBkcm1fY3J0
YyAqY3J0YykNCj4gIA0KPiAgCQkJaWYgKGNvbXApDQo+ICAJCQkJbXRrX2RkcF9jb21wX2xheWVy
X2NvbmZpZyhjb21wLCBsb2NhbF9sYXllciwNCj4gLQkJCQkJCQkgIHBsYW5lX3N0YXRlLCBOVUxM
KTsNCj4gKwkJCQkJCQkgIHBsYW5lX3N0YXRlLA0KPiArCQkJCQkJCSAgc3RhdGUtPmNtZHFfaGFu
ZGxlKTsNCj4gIAkJCXBsYW5lX3N0YXRlLT5wZW5kaW5nLmNvbmZpZyA9IGZhbHNlOw0KPiAgCQl9
DQo+ICAJCW10a19jcnRjLT5wZW5kaW5nX3BsYW5lcyA9IGZhbHNlOw0KPiBAQCAtNDU0LDYgKzUw
NiwxMyBAQCB2b2lkIG10a19kcm1fY3J0Y19jdXJzb3JfdXBkYXRlKHN0cnVjdCBkcm1fY3J0YyAq
Y3J0Yywgc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQo+ICAJCW10a19jcnRjX2RkcF9jb25maWco
Y3J0Yyk7DQo+ICAJCW10a19kaXNwX211dGV4X3JlbGVhc2UobXRrX2NydGMtPm11dGV4KTsNCj4g
IAl9DQo+ICsjaWZkZWYgQ09ORklHX01US19DTURRDQo+ICsJaWYgKG10a19jcnRjLT5jbWRxX2Ns
aWVudCkgew0KPiArCQltdGtfY21kcV9hY3F1aXJlKGNydGMpOw0KPiArCQltdGtfY3J0Y19kZHBf
Y29uZmlnKGNydGMpOw0KPiArCQltdGtfY21kcV9yZWxlYXNlKGNydGMpOw0KPiArCX0NCj4gKyNl
bmRpZg0KPiAgCW11dGV4X3VubG9jaygmcHJpdi0+aHdfbG9jayk7DQo+ICB9DQo+ICANCj4gQEAg
LTU3MCw2ICs2MjksMTMgQEAgc3RhdGljIHZvaWQgbXRrX2RybV9jcnRjX2F0b21pY19mbHVzaChz
dHJ1Y3QgZHJtX2NydGMgKmNydGMsDQo+ICAJCW10a19jcnRjX2RkcF9jb25maWcoY3J0Yyk7DQo+
ICAJCW10a19kaXNwX211dGV4X3JlbGVhc2UobXRrX2NydGMtPm11dGV4KTsNCj4gIAl9DQo+ICsj
aWZkZWYgQ09ORklHX01US19DTURRDQo+ICsJaWYgKG10a19jcnRjLT5jbWRxX2NsaWVudCkgew0K
PiArCQltdGtfY21kcV9hY3F1aXJlKGNydGMpOw0KPiArCQltdGtfY3J0Y19kZHBfY29uZmlnKGNy
dGMpOw0KPiArCQltdGtfY21kcV9yZWxlYXNlKGNydGMpOw0KPiArCX0NCj4gKyNlbmRpZg0KDQpU
aGlzIHBhcnQgaXMgYWxtb3N0IHRoZSBzYW1lIGFzIHRoZSBvbmUgaW4gbXRrX2RybV9jcnRjX2N1
cnNvcl91cGRhdGUoKSwNCnRyeSB0byBtZXJnZSB0aGVtLg0KDQo+ICB9DQo+ICANCj4gIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgZHJtX2NydGNfZnVuY3MgbXRrX2NydGNfZnVuY3MgPSB7DQo+IEBAIC02
MTksNyArNjg1LDcgQEAgdm9pZCBtdGtfY3J0Y19kZHBfaXJxKHN0cnVjdCBkcm1fY3J0YyAqY3J0
Yywgc3RydWN0IG10a19kZHBfY29tcCAqY29tcCkNCj4gIAlzdHJ1Y3QgbXRrX2RybV9jcnRjICpt
dGtfY3J0YyA9IHRvX210a19jcnRjKGNydGMpOw0KPiAgCXN0cnVjdCBtdGtfZHJtX3ByaXZhdGUg
KnByaXYgPSBjcnRjLT5kZXYtPmRldl9wcml2YXRlOw0KPiAgDQo+IC0JaWYgKCFwcml2LT5kYXRh
LT5zaGFkb3dfcmVnaXN0ZXIpDQo+ICsJaWYgKCFwcml2LT5kYXRhLT5zaGFkb3dfcmVnaXN0ZXIg
JiYgIW10a19jcnRjLT5jbWRxX2NsaWVudCkNCj4gIAkJbXRrX2NydGNfZGRwX2NvbmZpZyhjcnRj
KTsNCj4gIA0KPiAgCW10a19kcm1fZmluaXNoX3BhZ2VfZmxpcChtdGtfY3J0Yyk7DQo+IEBAIC03
NjEsNiArODI3LDE4IEBAIGludCBtdGtfZHJtX2NydGNfY3JlYXRlKHN0cnVjdCBkcm1fZGV2aWNl
ICpkcm1fZGV2LA0KPiAgCWRybV9tb2RlX2NydGNfc2V0X2dhbW1hX3NpemUoJm10a19jcnRjLT5i
YXNlLCBNVEtfTFVUX1NJWkUpOw0KPiAgCWRybV9jcnRjX2VuYWJsZV9jb2xvcl9tZ210KCZtdGtf
Y3J0Yy0+YmFzZSwgMCwgZmFsc2UsIE1US19MVVRfU0laRSk7DQo+ICAJcHJpdi0+bnVtX3BpcGVz
Kys7DQo+IC0NCj4gKyNpZmRlZiBDT05GSUdfTVRLX0NNRFENCj4gKwltdGtfY3J0Yy0+Y21kcV9j
bGllbnQgPQ0KPiArCQkJY21kcV9tYm94X2NyZWF0ZShkZXYsIGRybV9jcnRjX2luZGV4KCZtdGtf
Y3J0Yy0+YmFzZSksDQo+ICsJCQkJCSAyMDAwKTsNCj4gKwlvZl9wcm9wZXJ0eV9yZWFkX3UzMl9p
bmRleChkZXYtPm9mX25vZGUsICJtZWRpYXRlayxnY2UtZXZlbnRzIiwNCj4gKwkJCQkgICBkcm1f
Y3J0Y19pbmRleCgmbXRrX2NydGMtPmJhc2UpLA0KPiArCQkJCSAgICZtdGtfY3J0Yy0+Y21kcV9l
dmVudCk7DQo+ICsJaWYgKElTX0VSUihtdGtfY3J0Yy0+Y21kcV9jbGllbnQpKSB7DQo+ICsJCWRl
dl9kYmcoZGV2LCAibXRrX2NydGMgJWQgZmFpbGVkIHRvIGNyZWF0ZSBtYWlsYm94IGNsaWVudCwg
d3JpdGluZyByZWdpc3RlciBieSBDUFUgbm93XG4iLA0KPiArCQkJZHJtX2NydGNfaW5kZXgoJm10
a19jcnRjLT5iYXNlKSk7DQo+ICsJCW10a19jcnRjLT5jbWRxX2NsaWVudCA9IE5VTEw7DQo+ICsJ
fQ0KPiArI2VuZGlmDQo+ICAJcmV0dXJuIDA7DQo+ICB9DQo+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9kZHBfY29tcC5jIGIvZHJpdmVycy9ncHUvZHJtL21l
ZGlhdGVrL210a19kcm1fZGRwX2NvbXAuYw0KPiBpbmRleCA2ZDBmMzQ5ZGRmODIuLjljYzEyYWYy
YmMwNiAxMDA2NDQNCj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fZGRw
X2NvbXAuYw0KPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9kZHBfY29t
cC5jDQo+IEBAIC0zNzAsNiArMzcwLDkgQEAgaW50IG10a19kZHBfY29tcF9pbml0KHN0cnVjdCBk
ZXZpY2UgKmRldiwgc3RydWN0IGRldmljZV9ub2RlICpub2RlLA0KPiAgCQkgICAgICBjb25zdCBz
dHJ1Y3QgbXRrX2RkcF9jb21wX2Z1bmNzICpmdW5jcykNCj4gIHsNCj4gIAlzdHJ1Y3QgcGxhdGZv
cm1fZGV2aWNlICpjb21wX3BkZXY7DQo+ICsJc3RydWN0IHJlc291cmNlIHJlczsNCj4gKwlzdHJ1
Y3QgY21kcV9jbGllbnRfcmVnICpjbWRxX3JlZzsNCj4gKwlpbnQgcmV0ID0gMDsNCj4gIA0KPiAg
CWlmIChjb21wX2lkIDwgMCB8fCBjb21wX2lkID49IEREUF9DT01QT05FTlRfSURfTUFYKQ0KPiAg
CQlyZXR1cm4gLUVJTlZBTDsNCj4gQEAgLTQwNCw2ICs0MDcsMzQgQEAgaW50IG10a19kZHBfY29t
cF9pbml0KHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRldmljZV9ub2RlICpub2RlLA0KPiAg
CX0NCj4gIAljb21wLT5kZXYgPSAmY29tcF9wZGV2LT5kZXY7DQo+ICANCj4gKyNpZmRlZiBDT05G
SUdfTVRLX0NNRFENCj4gKwlpZiAob2ZfYWRkcmVzc190b19yZXNvdXJjZShub2RlLCAwLCAmcmVz
KSAhPSAwKSB7DQo+ICsJCWRldl9lcnIoZGV2LCAiTWlzc2luZyByZWcgaW4gJXMgbm9kZVxuIiwN
Cj4gKwkJCW5vZGUtPmZ1bGxfbmFtZSk7DQo+ICsJCXJldHVybiAtRUlOVkFMOw0KPiArCX0NCj4g
Kwljb21wLT5yZWdzX3BhID0gcmVzLnN0YXJ0Ow0KPiArDQo+ICsJY29tcF9wZGV2ID0gb2ZfZmlu
ZF9kZXZpY2VfYnlfbm9kZShub2RlKTsNCj4gKwlpZiAoIWNvbXBfcGRldikgew0KPiArCQlkZXZf
d2FybihkZXYsICJXYWl0aW5nIGZvciBjb21wb25lbnQgZGV2aWNlICVzXG4iLA0KPiArCQkJIG5v
ZGUtPmZ1bGxfbmFtZSk7DQo+ICsJCXJldHVybiAtRVBST0JFX0RFRkVSOw0KPiArCX0NCj4gKw0K
PiArCWNtZHFfcmVnID0ga3phbGxvYyhzaXplb2YoKmNtZHFfcmVnKSwgR0ZQX0tFUk5FTCk7DQo+
ICsJaWYgKCFjbWRxX3JlZykNCj4gKwkJcmV0dXJuIC1FSU5WQUw7DQo+ICsNCj4gKwlyZXQgPSBj
bWRxX2Rldl9nZXRfY2xpZW50X3JlZygmY29tcF9wZGV2LT5kZXYsIGNtZHFfcmVnLCAwKTsNCj4g
KwlpZiAocmV0ICE9IDApDQo+ICsJCWRldl9kYmcoJmNvbXBfcGRldi0+ZGV2LA0KPiArCQkJImdl
dCBtZWRpYXRlayxnY2UtY2xpZW50LXJlZyBmYWlsIVxuIik7DQo+ICsJZWxzZQ0KPiArCQljb21w
LT5zdWJzeXMgPSBjbWRxX3JlZy0+c3Vic3lzOw0KPiArDQo+ICsJa2ZyZWUoY21kcV9yZWcpOw0K
PiArI2VuZGlmDQoNCkkgd291bGQgbGlrZSB0byBtb3ZlIHRoaXMgcGFydCB0byB0aGUgcGF0Y2gg
ImRybS9tZWRpYXRlazogc3VwcG9ydCBDTURRDQppbnRlcmZhY2UgaW4gZGRwIGNvbXBvbmVudCIu
DQoNClJlZ2FyZHMsDQpDSw0KDQo+ICAJcmV0dXJuIDA7DQo+ICB9DQo+ICANCg0KX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcg
bGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRl
c2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
