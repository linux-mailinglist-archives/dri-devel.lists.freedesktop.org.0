Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 329E134D163
	for <lists+dri-devel@lfdr.de>; Mon, 29 Mar 2021 15:37:52 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8B4576E40C;
	Mon, 29 Mar 2021 13:37:49 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mga03.intel.com (mga03.intel.com [134.134.136.65])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 125686E40C;
 Mon, 29 Mar 2021 13:37:48 +0000 (UTC)
IronPort-SDR: IjFT8OcAtq33MHv6V2pc7fQrbgmdX+D73c+vYpctWnQYLCiBHUphERoAY6GA+HL53r+VrS76MV
 Msp0Mnh6cy1w==
X-IronPort-AV: E=McAfee;i="6000,8403,9938"; a="191578929"
X-IronPort-AV: E=Sophos;i="5.81,287,1610438400"; d="scan'208";a="191578929"
Received: from fmsmga001.fm.intel.com ([10.253.24.23])
 by orsmga103.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 29 Mar 2021 06:37:47 -0700
IronPort-SDR: MxLL1Z5nl/JWIA8KQtWDxVocpAZEOI0xQwcVRqewzwBc6riNJ+QOOCaKsJSp88OJJp3BcFNoPf
 BnEeztMzHzUQ==
X-IronPort-AV: E=Sophos;i="5.81,287,1610438400"; d="scan'208";a="516019793"
Received: from auchter-mobl.ger.corp.intel.com (HELO localhost)
 ([10.252.56.199])
 by fmsmga001-auth.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 29 Mar 2021 06:37:44 -0700
From: Jani Nikula <jani.nikula@intel.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v2 3/8] drm/displayid: add new displayid section/block
 iterators
Date: Mon, 29 Mar 2021 16:37:17 +0300
Message-Id: <da3dead1752ab16c061f7bd248ac1a4268f7fefb.1617024940.git.jani.nikula@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <cover.1617024940.git.jani.nikula@intel.com>
References: <cover.1617024940.git.jani.nikula@intel.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Jani Nikula <jani.nikula@intel.com>, intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SXRlcmF0aW5nIERpc3BsYXlJRCBibG9ja3MgYWNyb3NzIHNlY3Rpb25zIChpbiBFRElEIGV4dGVu
c2lvbnMpIGlzCnVubmVjZXNzYXJpbHkgY29tcGxpY2F0ZWQgZm9yIHRoZSBjYWxsZXIuIEltcGxl
bWVudCBEaXNwbGF5SUQgaXRlcmF0b3JzCnRvIGdvIHRocm91Z2ggYWxsIGJsb2NrcyBpbiBhbGwg
c2VjdGlvbnMuCgpVc2FnZSBleGFtcGxlOgoKCWNvbnN0IHN0cnVjdCBkaXNwbGF5aWRfYmxvY2sg
KmJsb2NrOwoJc3RydWN0IGRpc3BsYXlpZF9pdGVyIGl0ZXI7CgoJZGlzcGxheWlkX2l0ZXJfZWRp
ZF9iZWdpbihlZGlkLCAmaXRlcik7CglkaXNwbGF5aWRfaXRlcl9mb3JfZWFjaChibG9jaywgJml0
ZXIpIHsKCQkvKiBvcGVyYXRlIG9uIGJsb2NrICovCgl9CglkaXNwbGF5aWRfaXRlcl9lbmQoJml0
ZXIpOwoKV2hlbiBEaXNwbGF5SUQgaXMgc3RvcmVkIGluIEVESUQgZXh0ZW5zaW9ucywgdGhlIERp
c3BsYXlJRCBzZWN0aW9ucyBtYXAKdG8gZXh0ZW5zaW9ucyBhcyBkZXNjcmliZWQgaW4gVkVTQSBE
aXNwbGF5SUQgdjEuMyBBcHBlbmRpeCBCOiBEaXNwbGF5SUQKYXMgYW4gRURJRCBFeHRlbnNpb24u
IFRoaXMgaXMgaW1wbGVtZW50ZWQgaGVyZS4KCldoZW4gRGlzcGxheUlEIGlzIHN0b3JlZCBpbiBp
dHMgZGVkaWNhdGVkIEREQyBkZXZpY2UgMHhBNCwgYWNjb3JkaW5nIHRvClZFU0EgRS1EREMgdjEu
MywgZGlmZmVyZW50IHJ1bGVzIGFwcGx5IGZvciB0aGUgc3RydWN0dXJlLiBUaGlzIGlzIG5vdApp
bXBsZW1lbnRlZCBoZXJlLCBhcyB3ZSBkb24ndCBjdXJyZW50bHkgdXNlIGl0LCBidXQgdGhlIGlk
ZWEgaXMgeW91J2QKaGF2ZSBhIGRpZmZlcmVudCBjYWxsIGZvciBiZWdpbm5pbmcgdGhlIGl0ZXJh
dGlvbiwgZm9yIGV4YW1wbGUgc2ltcGx5OgoKCWRpc3BsYXlpZF9pdGVyX2JlZ2luKGRpc3BsYXlp
ZCwgJml0ZXIpOwoKaW5zdGVhZCBvZiBkaXNwbGF5aWRfaXRlcl9lZGlkX2JlZ2luKCksIGFuZCBl
dmVyeXRoaW5nIGVsc2Ugd291bGQgYmUKaGlkZGVuIGF3YXkgaW4gdGhlIGl0ZXJhdG9yIGZ1bmN0
aW9ucy4KCnYyOgotIHNpemVvZihzdHJ1Y3QgZGlzcGxheWlkX2Jsb2NrKSAtPiBzaXplb2YoKmJs
b2NrKSAoVmlsbGUpCi0gcmVtb3ZlIF9fIHByZWZpeCBmcm9tIGRpc3BsYXlpZF9pdGVyX2Jsb2Nr
CgpSZXZpZXdlZC1ieTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVs
LmNvbT4KU2lnbmVkLW9mZi1ieTogSmFuaSBOaWt1bGEgPGphbmkubmlrdWxhQGludGVsLmNvbT4K
LS0tCiBkcml2ZXJzL2dwdS9kcm0vZHJtX2Rpc3BsYXlpZC5jIHwgNzQgKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrCiBpbmNsdWRlL2RybS9kcm1fZGlzcGxheWlkLmggICAgIHwgMTgg
KysrKysrKysKIDIgZmlsZXMgY2hhbmdlZCwgOTIgaW5zZXJ0aW9ucygrKQoKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9kcm1fZGlzcGxheWlkLmMgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX2Rp
c3BsYXlpZC5jCmluZGV4IDkwOGJiZTZmZWI2MS4uNWI4MDliYjlmZWNjIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vZHJtX2Rpc3BsYXlpZC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1f
ZGlzcGxheWlkLmMKQEAgLTU3LDMgKzU3LDc3IEBAIGNvbnN0IHU4ICpkcm1fZmluZF9kaXNwbGF5
aWRfZXh0ZW5zaW9uKGNvbnN0IHN0cnVjdCBlZGlkICplZGlkLAogCiAJcmV0dXJuIGRpc3BsYXlp
ZDsKIH0KKwordm9pZCBkaXNwbGF5aWRfaXRlcl9lZGlkX2JlZ2luKGNvbnN0IHN0cnVjdCBlZGlk
ICplZGlkLAorCQkJICAgICAgIHN0cnVjdCBkaXNwbGF5aWRfaXRlciAqaXRlcikKK3sKKwltZW1z
ZXQoaXRlciwgMCwgc2l6ZW9mKCppdGVyKSk7CisKKwlpdGVyLT5lZGlkID0gZWRpZDsKK30KKwor
c3RhdGljIGNvbnN0IHN0cnVjdCBkaXNwbGF5aWRfYmxvY2sgKgorZGlzcGxheWlkX2l0ZXJfYmxv
Y2soY29uc3Qgc3RydWN0IGRpc3BsYXlpZF9pdGVyICppdGVyKQoreworCWNvbnN0IHN0cnVjdCBk
aXNwbGF5aWRfYmxvY2sgKmJsb2NrOworCisJaWYgKCFpdGVyLT5zZWN0aW9uKQorCQlyZXR1cm4g
TlVMTDsKKworCWJsb2NrID0gKGNvbnN0IHN0cnVjdCBkaXNwbGF5aWRfYmxvY2sgKikmaXRlci0+
c2VjdGlvbltpdGVyLT5pZHhdOworCisJaWYgKGl0ZXItPmlkeCArIHNpemVvZigqYmxvY2spIDw9
IGl0ZXItPmxlbmd0aCAmJgorCSAgICBpdGVyLT5pZHggKyBzaXplb2YoKmJsb2NrKSArIGJsb2Nr
LT5udW1fYnl0ZXMgPD0gaXRlci0+bGVuZ3RoICYmCisJICAgIGJsb2NrLT5udW1fYnl0ZXMgPiAw
KQorCQlyZXR1cm4gYmxvY2s7CisKKwlyZXR1cm4gTlVMTDsKK30KKworY29uc3Qgc3RydWN0IGRp
c3BsYXlpZF9ibG9jayAqCitfX2Rpc3BsYXlpZF9pdGVyX25leHQoc3RydWN0IGRpc3BsYXlpZF9p
dGVyICppdGVyKQoreworCWNvbnN0IHN0cnVjdCBkaXNwbGF5aWRfYmxvY2sgKmJsb2NrOworCisJ
aWYgKCFpdGVyLT5lZGlkKQorCQlyZXR1cm4gTlVMTDsKKworCWlmIChpdGVyLT5zZWN0aW9uKSB7
CisJCS8qIGN1cnJlbnQgYmxvY2sgc2hvdWxkIGFsd2F5cyBiZSB2YWxpZCAqLworCQlibG9jayA9
IGRpc3BsYXlpZF9pdGVyX2Jsb2NrKGl0ZXIpOworCQlpZiAoV0FSTl9PTighYmxvY2spKSB7CisJ
CQlpdGVyLT5zZWN0aW9uID0gTlVMTDsKKwkJCWl0ZXItPmVkaWQgPSBOVUxMOworCQkJcmV0dXJu
IE5VTEw7CisJCX0KKworCQkvKiBuZXh0IGJsb2NrIGluIHNlY3Rpb24gKi8KKwkJaXRlci0+aWR4
ICs9IHNpemVvZigqYmxvY2spICsgYmxvY2stPm51bV9ieXRlczsKKworCQlibG9jayA9IGRpc3Bs
YXlpZF9pdGVyX2Jsb2NrKGl0ZXIpOworCQlpZiAoYmxvY2spCisJCQlyZXR1cm4gYmxvY2s7CisJ
fQorCisJZm9yICg7OykgeworCQlpdGVyLT5zZWN0aW9uID0gZHJtX2ZpbmRfZGlzcGxheWlkX2V4
dGVuc2lvbihpdGVyLT5lZGlkLAorCQkJCQkJCSAgICAgJml0ZXItPmxlbmd0aCwKKwkJCQkJCQkg
ICAgICZpdGVyLT5pZHgsCisJCQkJCQkJICAgICAmaXRlci0+ZXh0X2luZGV4KTsKKwkJaWYgKCFp
dGVyLT5zZWN0aW9uKSB7CisJCQlpdGVyLT5lZGlkID0gTlVMTDsKKwkJCXJldHVybiBOVUxMOwor
CQl9CisKKwkJaXRlci0+aWR4ICs9IHNpemVvZihzdHJ1Y3QgZGlzcGxheWlkX2hkcik7CisKKwkJ
YmxvY2sgPSBkaXNwbGF5aWRfaXRlcl9ibG9jayhpdGVyKTsKKwkJaWYgKGJsb2NrKQorCQkJcmV0
dXJuIGJsb2NrOworCX0KK30KKwordm9pZCBkaXNwbGF5aWRfaXRlcl9lbmQoc3RydWN0IGRpc3Bs
YXlpZF9pdGVyICppdGVyKQoreworCW1lbXNldChpdGVyLCAwLCBzaXplb2YoKml0ZXIpKTsKK30K
ZGlmZiAtLWdpdCBhL2luY2x1ZGUvZHJtL2RybV9kaXNwbGF5aWQuaCBiL2luY2x1ZGUvZHJtL2Ry
bV9kaXNwbGF5aWQuaAppbmRleCAzYzZkYjIyYTUxOGEuLjI3ZTA2Yzk4ZGIxNyAxMDA2NDQKLS0t
IGEvaW5jbHVkZS9kcm0vZHJtX2Rpc3BsYXlpZC5oCisrKyBiL2luY2x1ZGUvZHJtL2RybV9kaXNw
bGF5aWQuaApAQCAtMTA4LDQgKzEwOCwyMiBAQCBjb25zdCB1OCAqZHJtX2ZpbmRfZGlzcGxheWlk
X2V4dGVuc2lvbihjb25zdCBzdHJ1Y3QgZWRpZCAqZWRpZCwKIAkJCQkgICAgICAgaW50ICpsZW5n
dGgsIGludCAqaWR4LAogCQkJCSAgICAgICBpbnQgKmV4dF9pbmRleCk7CiAKKy8qIERpc3BsYXlJ
RCBpdGVyYXRpb24gKi8KK3N0cnVjdCBkaXNwbGF5aWRfaXRlciB7CisJY29uc3Qgc3RydWN0IGVk
aWQgKmVkaWQ7CisKKwljb25zdCB1OCAqc2VjdGlvbjsKKwlpbnQgbGVuZ3RoOworCWludCBpZHg7
CisJaW50IGV4dF9pbmRleDsKK307CisKK3ZvaWQgZGlzcGxheWlkX2l0ZXJfZWRpZF9iZWdpbihj
b25zdCBzdHJ1Y3QgZWRpZCAqZWRpZCwKKwkJCSAgICAgICBzdHJ1Y3QgZGlzcGxheWlkX2l0ZXIg
Kml0ZXIpOworY29uc3Qgc3RydWN0IGRpc3BsYXlpZF9ibG9jayAqCitfX2Rpc3BsYXlpZF9pdGVy
X25leHQoc3RydWN0IGRpc3BsYXlpZF9pdGVyICppdGVyKTsKKyNkZWZpbmUgZGlzcGxheWlkX2l0
ZXJfZm9yX2VhY2goX19ibG9jaywgX19pdGVyKSBcCisJd2hpbGUgKCgoX19ibG9jaykgPSBfX2Rp
c3BsYXlpZF9pdGVyX25leHQoX19pdGVyKSkpCit2b2lkIGRpc3BsYXlpZF9pdGVyX2VuZChzdHJ1
Y3QgZGlzcGxheWlkX2l0ZXIgKml0ZXIpOworCiAjZW5kaWYKLS0gCjIuMjAuMQoKX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcg
bGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRl
c2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVsCg==
