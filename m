Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 85A064C72E
	for <lists+dri-devel@lfdr.de>; Thu, 20 Jun 2019 08:08:05 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2F3C56E4D0;
	Thu, 20 Jun 2019 06:07:52 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0E9C56E4C1
 for <dri-devel@lists.freedesktop.org>; Thu, 20 Jun 2019 06:07:36 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx06.intmail.prod.int.phx2.redhat.com
 [10.5.11.16])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id A15C8C05A1D8;
 Thu, 20 Jun 2019 06:07:35 +0000 (UTC)
Received: from sirius.home.kraxel.org (ovpn-116-212.ams2.redhat.com
 [10.36.116.212])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 27B925C221;
 Thu, 20 Jun 2019 06:07:33 +0000 (UTC)
Received: by sirius.home.kraxel.org (Postfix, from userid 1000)
 id F1C2F1753E; Thu, 20 Jun 2019 08:07:27 +0200 (CEST)
From: Gerd Hoffmann <kraxel@redhat.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v4 11/12] drm/virtio: switch from ttm to gem shmem helpers
Date: Thu, 20 Jun 2019 08:07:25 +0200
Message-Id: <20190620060726.926-12-kraxel@redhat.com>
In-Reply-To: <20190620060726.926-1-kraxel@redhat.com>
References: <20190620060726.926-1-kraxel@redhat.com>
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.16
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.31]); Thu, 20 Jun 2019 06:07:35 +0000 (UTC)
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: David Airlie <airlied@linux.ie>,
 "open list:VIRTIO GPU DRIVER" <virtualization@lists.linux-foundation.org>,
 Gerd Hoffmann <kraxel@redhat.com>, open list <linux-kernel@vger.kernel.org>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

dmlydGlvLWdwdSBiYXNpY2FsbHkgbmVlZHMgYSBzZ190YWJsZSBmb3IgdGhlIGJvLCB0byB0ZWxs
IHRoZSBob3N0IHdoZXJlCnRoZSBiYWNraW5nIHBhZ2VzIGZvciB0aGUgb2JqZWN0IGFyZS4gIFNv
IHRoZSBnZW0gc2htZW0gaGVscGVycyBhcmUgYQpwZXJmZWN0IGZpdC4gIFNvbWUgZHJtX2dlbV9v
YmplY3RfZnVuY3MgbmVlZCB0aGluIHdyYXBwZXJzIHRvIHVwZGF0ZSB0aGUKaG9zdCBzdGF0ZSwg
YnV0IG90aGVyd2lzZSB0aGUgaGVscGVycyBoYW5kbGUgZXZlcnl0aGluZyBqdXN0IGZpbmUuCgpP
bmNlIHRoZSBmZW5jaW5nIHdhcyBzb3J0ZWQgdGhlIHN3aXRjaCB3YXMgc3VycHJpc2luZ2x5IGVh
c3kgYW5kIGZvciB0aGUKbW9zdCBwYXJ0IGp1c3QgcmVtb3ZpbmcgdGhlIHR0bSBjb2RlLgoKdjQ6
IGZpeCBkcm1fZ2VtX29iamVjdF9mdW5jcyBuYW1lLgoKU2lnbmVkLW9mZi1ieTogR2VyZCBIb2Zm
bWFubiA8a3JheGVsQHJlZGhhdC5jb20+CkFja2VkLWJ5OiBEYW5pZWwgVmV0dGVyIDxkYW5pZWwu
dmV0dGVyQGZmd2xsLmNoPgotLS0KIGRyaXZlcnMvZ3B1L2RybS92aXJ0aW8vdmlydGdwdV9kcnYu
aCAgICB8ICA1MiArLS0tCiBkcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfZHJ2LmMgICAg
fCAgMjAgKy0KIGRyaXZlcnMvZ3B1L2RybS92aXJ0aW8vdmlydGdwdV9nZW0uYyAgICB8ICAxNiAr
LQogZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X2lvY3RsLmMgIHwgIDE5ICstCiBkcml2
ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfa21zLmMgICAgfCAgIDkgLQogZHJpdmVycy9ncHUv
ZHJtL3ZpcnRpby92aXJ0Z3B1X29iamVjdC5jIHwgMTQ4ICsrKystLS0tLS0tLQogZHJpdmVycy9n
cHUvZHJtL3ZpcnRpby92aXJ0Z3B1X3ByaW1lLmMgIHwgIDM3IC0tLQogZHJpdmVycy9ncHUvZHJt
L3ZpcnRpby92aXJ0Z3B1X3R0bS5jICAgIHwgMzA0IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQog
ZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X3ZxLmMgICAgIHwgIDI0ICstCiBkcml2ZXJz
L2dwdS9kcm0vdmlydGlvL0tjb25maWcgICAgICAgICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2Ry
bS92aXJ0aW8vTWFrZWZpbGUgICAgICAgICB8ICAgMiArLQogMTEgZmlsZXMgY2hhbmdlZCwgODIg
aW5zZXJ0aW9ucygrKSwgNTUxIGRlbGV0aW9ucygtKQogZGVsZXRlIG1vZGUgMTAwNjQ0IGRyaXZl
cnMvZ3B1L2RybS92aXJ0aW8vdmlydGdwdV90dG0uYwoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS92aXJ0aW8vdmlydGdwdV9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8vdmlydGdw
dV9kcnYuaAppbmRleCBjMjNmNDAxNmRmMzkuLjFkNTg5ZGUzNDQ0OSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92
aXJ0aW8vdmlydGdwdV9kcnYuaApAQCAtMzMsMTQgKzMzLDExIEBACiAKICNpbmNsdWRlIDxkcm0v
ZHJtUC5oPgogI2luY2x1ZGUgPGRybS9kcm1fZ2VtLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9nZW1f
c2htZW1faGVscGVyLmg+CiAjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWMuaD4KICNpbmNsdWRlIDxk
cm0vZHJtX2VuY29kZXIuaD4KICNpbmNsdWRlIDxkcm0vZHJtX2ZiX2hlbHBlci5oPgogI2luY2x1
ZGUgPGRybS9kcm1fcHJvYmVfaGVscGVyLmg+Ci0jaW5jbHVkZSA8ZHJtL3R0bS90dG1fYm9fYXBp
Lmg+Ci0jaW5jbHVkZSA8ZHJtL3R0bS90dG1fYm9fZHJpdmVyLmg+Ci0jaW5jbHVkZSA8ZHJtL3R0
bS90dG1fcGxhY2VtZW50Lmg+Ci0jaW5jbHVkZSA8ZHJtL3R0bS90dG1fbW9kdWxlLmg+CiAKICNk
ZWZpbmUgRFJJVkVSX05BTUUgInZpcnRpb19ncHUiCiAjZGVmaW5lIERSSVZFUl9ERVNDICJ2aXJ0
aW8gR1BVIgpAQCAtNjgsMjEgKzY1LDE2IEBAIHN0cnVjdCB2aXJ0aW9fZ3B1X29iamVjdF9wYXJh
bXMgewogfTsKIAogc3RydWN0IHZpcnRpb19ncHVfb2JqZWN0IHsKLQlzdHJ1Y3QgZHJtX2dlbV9v
YmplY3QgZ2VtX2Jhc2U7CisJc3RydWN0IGRybV9nZW1fc2htZW1fb2JqZWN0IGJhc2U7CiAJdWlu
dDMyX3QgaHdfcmVzX2hhbmRsZTsKIAogCXN0cnVjdCBzZ190YWJsZSAqcGFnZXM7CiAJdWludDMy
X3QgbWFwcGVkOwotCXZvaWQgKnZtYXA7CiAJYm9vbCBkdW1iOwotCXN0cnVjdCB0dG1fcGxhY2Ug
ICAgICAgICAgICAgICAgcGxhY2VtZW50X2NvZGU7Ci0Jc3RydWN0IHR0bV9wbGFjZW1lbnQJCXBs
YWNlbWVudDsKLQlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QJdGJvOwotCXN0cnVjdCB0dG1fYm9f
a21hcF9vYmoJCWttYXA7CiAJYm9vbCBjcmVhdGVkOwogfTsKICNkZWZpbmUgZ2VtX3RvX3ZpcnRp
b19ncHVfb2JqKGdvYmopIFwKLQljb250YWluZXJfb2YoKGdvYmopLCBzdHJ1Y3QgdmlydGlvX2dw
dV9vYmplY3QsIGdlbV9iYXNlKQorCWNvbnRhaW5lcl9vZigoZ29iaiksIHN0cnVjdCB2aXJ0aW9f
Z3B1X29iamVjdCwgYmFzZS5iYXNlKQogCiBzdHJ1Y3QgdmlydGlvX2dwdV9vYmplY3RfYXJyYXkg
ewogCXUzMiBuZW50czsKQEAgLTE1MiwxMCArMTQ0LDYgQEAgc3RydWN0IHZpcnRpb19ncHVfZnJh
bWVidWZmZXIgewogI2RlZmluZSB0b192aXJ0aW9fZ3B1X2ZyYW1lYnVmZmVyKHgpIFwKIAljb250
YWluZXJfb2YoeCwgc3RydWN0IHZpcnRpb19ncHVfZnJhbWVidWZmZXIsIGJhc2UpCiAKLXN0cnVj
dCB2aXJ0aW9fZ3B1X21tYW4gewotCXN0cnVjdCB0dG1fYm9fZGV2aWNlCQliZGV2OwotfTsKLQog
c3RydWN0IHZpcnRpb19ncHVfcXVldWUgewogCXN0cnVjdCB2aXJ0cXVldWUgKnZxOwogCXNwaW5s
b2NrX3QgcWxvY2s7CkBAIC0xODQsOCArMTcyLDYgQEAgc3RydWN0IHZpcnRpb19ncHVfZGV2aWNl
IHsKIAogCXN0cnVjdCB2aXJ0aW9fZGV2aWNlICp2ZGV2OwogCi0Jc3RydWN0IHZpcnRpb19ncHVf
bW1hbiBtbWFuOwotCiAJc3RydWN0IHZpcnRpb19ncHVfb3V0cHV0IG91dHB1dHNbVklSVElPX0dQ
VV9NQVhfU0NBTk9VVFNdOwogCXVpbnQzMl90IG51bV9zY2Fub3V0czsKIApAQCAtMzQ5LDExICsz
MzUsNiBAQCBzdHJ1Y3QgZHJtX3BsYW5lICp2aXJ0aW9fZ3B1X3BsYW5lX2luaXQoc3RydWN0IHZp
cnRpb19ncHVfZGV2aWNlICp2Z2RldiwKIAkJCQkJZW51bSBkcm1fcGxhbmVfdHlwZSB0eXBlLAog
CQkJCQlpbnQgaW5kZXgpOwogCi0vKiB2aXJ0aW9fZ3B1X3R0bS5jICovCi1pbnQgdmlydGlvX2dw
dV90dG1faW5pdChzdHJ1Y3QgdmlydGlvX2dwdV9kZXZpY2UgKnZnZGV2KTsKLXZvaWQgdmlydGlv
X2dwdV90dG1fZmluaShzdHJ1Y3QgdmlydGlvX2dwdV9kZXZpY2UgKnZnZGV2KTsKLWludCB2aXJ0
aW9fZ3B1X21tYXAoc3RydWN0IGZpbGUgKmZpbHAsIHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1h
KTsKLQogLyogdmlydGlvX2dwdV9mZW5jZS5jICovCiBib29sIHZpcnRpb19mZW5jZV9zaWduYWxl
ZChzdHJ1Y3QgZG1hX2ZlbmNlICpmKTsKIHN0cnVjdCB2aXJ0aW9fZ3B1X2ZlbmNlICp2aXJ0aW9f
Z3B1X2ZlbmNlX2FsbG9jKApAQCAtMzY1LDU4ICszNDYsNDcgQEAgdm9pZCB2aXJ0aW9fZ3B1X2Zl
bmNlX2V2ZW50X3Byb2Nlc3Moc3RydWN0IHZpcnRpb19ncHVfZGV2aWNlICp2ZGV2LAogCQkJCSAg
ICB1NjQgbGFzdF9zZXEpOwogCiAvKiB2aXJ0aW9fZ3B1X29iamVjdCAqLworc3RydWN0IGRybV9n
ZW1fb2JqZWN0ICp2aXJ0aW9fZ3B1X2NyZWF0ZV9vYmplY3Qoc3RydWN0IGRybV9kZXZpY2UgKmRl
diwKKwkJCQkJCXNpemVfdCBzaXplKTsKIGludCB2aXJ0aW9fZ3B1X29iamVjdF9jcmVhdGUoc3Ry
dWN0IHZpcnRpb19ncHVfZGV2aWNlICp2Z2RldiwKIAkJCSAgICAgc3RydWN0IHZpcnRpb19ncHVf
b2JqZWN0X3BhcmFtcyAqcGFyYW1zLAogCQkJICAgICBzdHJ1Y3QgdmlydGlvX2dwdV9vYmplY3Qg
Kipib19wdHIsCiAJCQkgICAgIHN0cnVjdCB2aXJ0aW9fZ3B1X2ZlbmNlICpmZW5jZSk7Ci12b2lk
IHZpcnRpb19ncHVfb2JqZWN0X2t1bm1hcChzdHJ1Y3QgdmlydGlvX2dwdV9vYmplY3QgKmJvKTsK
LWludCB2aXJ0aW9fZ3B1X29iamVjdF9rbWFwKHN0cnVjdCB2aXJ0aW9fZ3B1X29iamVjdCAqYm8p
OwotaW50IHZpcnRpb19ncHVfb2JqZWN0X2dldF9zZ190YWJsZShzdHJ1Y3QgdmlydGlvX2dwdV9k
ZXZpY2UgKnFkZXYsCi0JCQkJICAgc3RydWN0IHZpcnRpb19ncHVfb2JqZWN0ICpibyk7Ci12b2lk
IHZpcnRpb19ncHVfb2JqZWN0X2ZyZWVfc2dfdGFibGUoc3RydWN0IHZpcnRpb19ncHVfb2JqZWN0
ICpibyk7CiAKIC8qIHZpcnRncHVfcHJpbWUuYyAqLwotc3RydWN0IHNnX3RhYmxlICp2aXJ0Z3B1
X2dlbV9wcmltZV9nZXRfc2dfdGFibGUoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmopOwogc3Ry
dWN0IGRybV9nZW1fb2JqZWN0ICp2aXJ0Z3B1X2dlbV9wcmltZV9pbXBvcnRfc2dfdGFibGUoCiAJ
c3RydWN0IGRybV9kZXZpY2UgKmRldiwgc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCAqYXR0YWNo
LAogCXN0cnVjdCBzZ190YWJsZSAqc2d0KTsKLXZvaWQgKnZpcnRncHVfZ2VtX3ByaW1lX3ZtYXAo
c3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmopOwotdm9pZCB2aXJ0Z3B1X2dlbV9wcmltZV92dW5t
YXAoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmosIHZvaWQgKnZhZGRyKTsKLWludCB2aXJ0Z3B1
X2dlbV9wcmltZV9tbWFwKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqLAotCQkJICAgc3RydWN0
IHZtX2FyZWFfc3RydWN0ICp2bWEpOwogCiBzdGF0aWMgaW5saW5lIHN0cnVjdCB2aXJ0aW9fZ3B1
X29iamVjdCoKIHZpcnRpb19ncHVfb2JqZWN0X3JlZihzdHJ1Y3QgdmlydGlvX2dwdV9vYmplY3Qg
KmJvKQogewotCXR0bV9ib19nZXQoJmJvLT50Ym8pOworCWRybV9nZW1fb2JqZWN0X2dldCgmYm8t
PmJhc2UuYmFzZSk7CiAJcmV0dXJuIGJvOwogfQogCiBzdGF0aWMgaW5saW5lIHZvaWQgdmlydGlv
X2dwdV9vYmplY3RfdW5yZWYoc3RydWN0IHZpcnRpb19ncHVfb2JqZWN0ICoqYm8pCiB7Ci0Jc3Ry
dWN0IHR0bV9idWZmZXJfb2JqZWN0ICp0Ym87Ci0KIAlpZiAoKCpibykgPT0gTlVMTCkKIAkJcmV0
dXJuOwotCXRibyA9ICYoKCpibyktPnRibyk7Ci0JdHRtX2JvX3B1dCh0Ym8pOworCWRybV9nZW1f
b2JqZWN0X3B1dCgmKCpibyktPmJhc2UuYmFzZSk7CiAJKmJvID0gTlVMTDsKIH0KIAogc3RhdGlj
IGlubGluZSB1NjQgdmlydGlvX2dwdV9vYmplY3RfbW1hcF9vZmZzZXQoc3RydWN0IHZpcnRpb19n
cHVfb2JqZWN0ICpibykKIHsKLQlyZXR1cm4gZHJtX3ZtYV9ub2RlX29mZnNldF9hZGRyKCZiby0+
dGJvLnZtYV9ub2RlKTsKKwlyZXR1cm4gZHJtX3ZtYV9ub2RlX29mZnNldF9hZGRyKCZiby0+YmFz
ZS5iYXNlLnZtYV9ub2RlKTsKIH0KIAogc3RhdGljIGlubGluZSBpbnQgdmlydGlvX2dwdV9vYmpl
Y3RfcmVzZXJ2ZShzdHJ1Y3QgdmlydGlvX2dwdV9vYmplY3QgKmJvKQogewogCWludCByOwogCi0J
ciA9IHJlc2VydmF0aW9uX29iamVjdF9sb2NrX2ludGVycnVwdGlibGUoYm8tPmdlbV9iYXNlLnJl
c3YsIE5VTEwpOworCXIgPSByZXNlcnZhdGlvbl9vYmplY3RfbG9ja19pbnRlcnJ1cHRpYmxlKGJv
LT5iYXNlLmJhc2UucmVzdiwgTlVMTCk7CiAJaWYgKHVubGlrZWx5KHIgIT0gMCkpIHsKIAkJaWYg
KHIgIT0gLUVJTlRSKSB7CiAJCQlzdHJ1Y3QgdmlydGlvX2dwdV9kZXZpY2UgKnFkZXYgPQotCQkJ
CWJvLT5nZW1fYmFzZS5kZXYtPmRldl9wcml2YXRlOworCQkJCWJvLT5iYXNlLmJhc2UuZGV2LT5k
ZXZfcHJpdmF0ZTsKIAkJCWRldl9lcnIocWRldi0+ZGV2LCAiJXAgcmVzZXJ2ZSBmYWlsZWRcbiIs
IGJvKTsKIAkJfQogCQlyZXR1cm4gcjsKQEAgLTQyNiw3ICszOTYsNyBAQCBzdGF0aWMgaW5saW5l
IGludCB2aXJ0aW9fZ3B1X29iamVjdF9yZXNlcnZlKHN0cnVjdCB2aXJ0aW9fZ3B1X29iamVjdCAq
Ym8pCiAKIHN0YXRpYyBpbmxpbmUgdm9pZCB2aXJ0aW9fZ3B1X29iamVjdF91bnJlc2VydmUoc3Ry
dWN0IHZpcnRpb19ncHVfb2JqZWN0ICpibykKIHsKLQlyZXNlcnZhdGlvbl9vYmplY3RfdW5sb2Nr
KGJvLT5nZW1fYmFzZS5yZXN2KTsKKwlyZXNlcnZhdGlvbl9vYmplY3RfdW5sb2NrKGJvLT5iYXNl
LmJhc2UucmVzdik7CiB9CiAKIC8qIHZpcmdsIGRlYnVmcyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X2Rydi5jIGIvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92
aXJ0Z3B1X2Rydi5jCmluZGV4IGM1MDg2ODc1MzEzMi4uNmQ3MDkyMjUxZDIwIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfZHJ2LmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL3ZpcnRpby92aXJ0Z3B1X2Rydi5jCkBAIC0xODIsMTcgKzE4Miw3IEBAIE1PRFVMRV9BVVRI
T1IoIkRhdmUgQWlybGllIDxhaXJsaWVkQHJlZGhhdC5jb20+Iik7CiBNT0RVTEVfQVVUSE9SKCJH
ZXJkIEhvZmZtYW5uIDxrcmF4ZWxAcmVkaGF0LmNvbT4iKTsKIE1PRFVMRV9BVVRIT1IoIkFsb24g
TGV2eSIpOwogCi1zdGF0aWMgY29uc3Qgc3RydWN0IGZpbGVfb3BlcmF0aW9ucyB2aXJ0aW9fZ3B1
X2RyaXZlcl9mb3BzID0gewotCS5vd25lciA9IFRISVNfTU9EVUxFLAotCS5vcGVuID0gZHJtX29w
ZW4sCi0JLm1tYXAgPSB2aXJ0aW9fZ3B1X21tYXAsCi0JLnBvbGwgPSBkcm1fcG9sbCwKLQkucmVh
ZCA9IGRybV9yZWFkLAotCS51bmxvY2tlZF9pb2N0bAk9IGRybV9pb2N0bCwKLQkucmVsZWFzZSA9
IGRybV9yZWxlYXNlLAotCS5jb21wYXRfaW9jdGwgPSBkcm1fY29tcGF0X2lvY3RsLAotCS5sbHNl
ZWsgPSBub29wX2xsc2VlaywKLX07CitERUZJTkVfRFJNX0dFTV9TSE1FTV9GT1BTKHZpcnRpb19n
cHVfZHJpdmVyX2ZvcHMpOwogCiBzdGF0aWMgc3RydWN0IGRybV9kcml2ZXIgZHJpdmVyID0gewog
CS5kcml2ZXJfZmVhdHVyZXMgPSBEUklWRVJfTU9ERVNFVCB8IERSSVZFUl9HRU0gfCBEUklWRVJf
UFJJTUUgfCBEUklWRVJfUkVOREVSIHwgRFJJVkVSX0FUT01JQywKQEAgLTIwOSwxNSArMTk5LDkg
QEAgc3RhdGljIHN0cnVjdCBkcm1fZHJpdmVyIGRyaXZlciA9IHsKIAkucHJpbWVfZmRfdG9faGFu
ZGxlID0gZHJtX2dlbV9wcmltZV9mZF90b19oYW5kbGUsCiAJLmdlbV9wcmltZV9leHBvcnQgPSBk
cm1fZ2VtX3ByaW1lX2V4cG9ydCwKIAkuZ2VtX3ByaW1lX2ltcG9ydCA9IGRybV9nZW1fcHJpbWVf
aW1wb3J0LAotCS5nZW1fcHJpbWVfZ2V0X3NnX3RhYmxlID0gdmlydGdwdV9nZW1fcHJpbWVfZ2V0
X3NnX3RhYmxlLAogCS5nZW1fcHJpbWVfaW1wb3J0X3NnX3RhYmxlID0gdmlydGdwdV9nZW1fcHJp
bWVfaW1wb3J0X3NnX3RhYmxlLAotCS5nZW1fcHJpbWVfdm1hcCA9IHZpcnRncHVfZ2VtX3ByaW1l
X3ZtYXAsCi0JLmdlbV9wcmltZV92dW5tYXAgPSB2aXJ0Z3B1X2dlbV9wcmltZV92dW5tYXAsCi0J
LmdlbV9wcmltZV9tbWFwID0gdmlydGdwdV9nZW1fcHJpbWVfbW1hcCwKIAotCS5nZW1fZnJlZV9v
YmplY3RfdW5sb2NrZWQgPSB2aXJ0aW9fZ3B1X2dlbV9mcmVlX29iamVjdCwKLQkuZ2VtX29wZW5f
b2JqZWN0ID0gdmlydGlvX2dwdV9nZW1fb2JqZWN0X29wZW4sCi0JLmdlbV9jbG9zZV9vYmplY3Qg
PSB2aXJ0aW9fZ3B1X2dlbV9vYmplY3RfY2xvc2UsCisJLmdlbV9jcmVhdGVfb2JqZWN0ID0gdmly
dGlvX2dwdV9jcmVhdGVfb2JqZWN0LAogCS5mb3BzID0gJnZpcnRpb19ncHVfZHJpdmVyX2ZvcHMs
CiAKIAkuaW9jdGxzID0gdmlydGlvX2dwdV9pb2N0bHMsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vdmlydGlvL3ZpcnRncHVfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRn
cHVfZ2VtLmMKaW5kZXggNDU2Y2MzODJjZTY4Li5jNTAyOGIwNGNkOTIgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS92aXJ0aW8vdmlydGdwdV9nZW0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
dmlydGlvL3ZpcnRncHVfZ2VtLmMKQEAgLTI2LDE0ICsyNiw2IEBACiAjaW5jbHVkZSA8ZHJtL2Ry
bVAuaD4KICNpbmNsdWRlICJ2aXJ0Z3B1X2Rydi5oIgogCi12b2lkIHZpcnRpb19ncHVfZ2VtX2Zy
ZWVfb2JqZWN0KHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqZ2VtX29iaikKLXsKLQlzdHJ1Y3Qgdmly
dGlvX2dwdV9vYmplY3QgKm9iaiA9IGdlbV90b192aXJ0aW9fZ3B1X29iaihnZW1fb2JqKTsKLQot
CWlmIChvYmopCi0JCXZpcnRpb19ncHVfb2JqZWN0X3VucmVmKCZvYmopOwotfQotCiBzdHJ1Y3Qg
dmlydGlvX2dwdV9vYmplY3QqCiB2aXJ0aW9fZ3B1X2FsbG9jX29iamVjdChzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LAogCQkJc3RydWN0IHZpcnRpb19ncHVfb2JqZWN0X3BhcmFtcyAqcGFyYW1zLApA
QCAtNjQsMTYgKzU2LDE2IEBAIGludCB2aXJ0aW9fZ3B1X2dlbV9jcmVhdGUoc3RydWN0IGRybV9m
aWxlICpmaWxlLAogCWlmIChJU19FUlIob2JqKSkKIAkJcmV0dXJuIFBUUl9FUlIob2JqKTsKIAot
CXJldCA9IGRybV9nZW1faGFuZGxlX2NyZWF0ZShmaWxlLCAmb2JqLT5nZW1fYmFzZSwgJmhhbmRs
ZSk7CisJcmV0ID0gZHJtX2dlbV9oYW5kbGVfY3JlYXRlKGZpbGUsICZvYmotPmJhc2UuYmFzZSwg
JmhhbmRsZSk7CiAJaWYgKHJldCkgewotCQlkcm1fZ2VtX29iamVjdF9yZWxlYXNlKCZvYmotPmdl
bV9iYXNlKTsKKwkJZHJtX2dlbV9vYmplY3RfcmVsZWFzZSgmb2JqLT5iYXNlLmJhc2UpOwogCQly
ZXR1cm4gcmV0OwogCX0KIAotCSpvYmpfcCA9ICZvYmotPmdlbV9iYXNlOworCSpvYmpfcCA9ICZv
YmotPmJhc2UuYmFzZTsKIAogCS8qIGRyb3AgcmVmZXJlbmNlIGZyb20gYWxsb2NhdGUgLSBoYW5k
bGUgaG9sZHMgaXQgbm93ICovCi0JZHJtX2dlbV9vYmplY3RfcHV0X3VubG9ja2VkKCZvYmotPmdl
bV9iYXNlKTsKKwlkcm1fZ2VtX29iamVjdF9wdXRfdW5sb2NrZWQoJm9iai0+YmFzZS5iYXNlKTsK
IAogCSpoYW5kbGVfcCA9IGhhbmRsZTsKIAlyZXR1cm4gMDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS92aXJ0aW8vdmlydGdwdV9pb2N0bC5jIGIvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92
aXJ0Z3B1X2lvY3RsLmMKaW5kZXggNTRlMWNmODQwOTdhLi5kNTc0Y2EzOGViYWEgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8vdmlydGdwdV9pb2N0bC5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS92aXJ0aW8vdmlydGdwdV9pb2N0bC5jCkBAIC0yNyw3ICsyNyw2IEBACiAKICNpbmNs
dWRlIDxkcm0vZHJtUC5oPgogI2luY2x1ZGUgPGRybS92aXJ0Z3B1X2RybS5oPgotI2luY2x1ZGUg
PGRybS90dG0vdHRtX2V4ZWNidWZfdXRpbC5oPgogI2luY2x1ZGUgPGxpbnV4L3N5bmNfZmlsZS5o
PgogCiAjaW5jbHVkZSAidmlydGdwdV9kcnYuaCIKQEAgLTI2OSw3ICsyNjgsNyBAQCBzdGF0aWMg
aW50IHZpcnRpb19ncHVfcmVzb3VyY2VfY3JlYXRlX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYsIHZvaWQgKmRhdGEsCiAJZG1hX2ZlbmNlX3B1dCgmZmVuY2UtPmYpOwogCWlmIChJU19FUlIo
cW9iaikpCiAJCXJldHVybiBQVFJfRVJSKHFvYmopOwotCW9iaiA9ICZxb2JqLT5nZW1fYmFzZTsK
KwlvYmogPSAmcW9iai0+YmFzZS5iYXNlOwogCiAJcmV0ID0gZHJtX2dlbV9oYW5kbGVfY3JlYXRl
KGZpbGVfcHJpdiwgb2JqLCAmaGFuZGxlKTsKIAlpZiAocmV0KSB7CkBAIC0yOTYsNyArMjk1LDcg
QEAgc3RhdGljIGludCB2aXJ0aW9fZ3B1X3Jlc291cmNlX2luZm9faW9jdGwoc3RydWN0IGRybV9k
ZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIAogCXFvYmogPSBnZW1fdG9fdmlydGlvX2dwdV9vYmoo
Z29iaik7CiAKLQlyaS0+c2l6ZSA9IHFvYmotPmdlbV9iYXNlLnNpemU7CisJcmktPnNpemUgPSBx
b2JqLT5iYXNlLmJhc2Uuc2l6ZTsKIAlyaS0+cmVzX2hhbmRsZSA9IHFvYmotPmh3X3Jlc19oYW5k
bGU7CiAJZHJtX2dlbV9vYmplY3RfcHV0X3VubG9ja2VkKGdvYmopOwogCXJldHVybiAwOwpAQCAt
MzA5LDcgKzMwOCw2IEBAIHN0YXRpYyBpbnQgdmlydGlvX2dwdV90cmFuc2Zlcl9mcm9tX2hvc3Rf
aW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKIAlzdHJ1Y3QgdmlydGlvX2dwdV9kZXZpY2Ug
KnZnZGV2ID0gZGV2LT5kZXZfcHJpdmF0ZTsKIAlzdHJ1Y3QgdmlydGlvX2dwdV9mcHJpdiAqdmZw
cml2ID0gZmlsZS0+ZHJpdmVyX3ByaXY7CiAJc3RydWN0IGRybV92aXJ0Z3B1XzNkX3RyYW5zZmVy
X2Zyb21faG9zdCAqYXJncyA9IGRhdGE7Ci0Jc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4IGN0eCA9
IHsgdHJ1ZSwgZmFsc2UgfTsKIAlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdvYmogPSBOVUxMOwog
CXN0cnVjdCB2aXJ0aW9fZ3B1X29iamVjdCAqcW9iaiA9IE5VTEw7CiAJc3RydWN0IHZpcnRpb19n
cHVfZmVuY2UgKmZlbmNlOwpAQCAtMzMwLDEwICszMjgsNiBAQCBzdGF0aWMgaW50IHZpcnRpb19n
cHVfdHJhbnNmZXJfZnJvbV9ob3N0X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJaWYg
KHJldCkKIAkJZ290byBvdXQ7CiAKLQlyZXQgPSB0dG1fYm9fdmFsaWRhdGUoJnFvYmotPnRibywg
JnFvYmotPnBsYWNlbWVudCwgJmN0eCk7Ci0JaWYgKHVubGlrZWx5KHJldCkpCi0JCWdvdG8gb3V0
X3VucmVzOwotCiAJY29udmVydF90b19od19ib3goJmJveCwgJmFyZ3MtPmJveCk7CiAKIAlmZW5j
ZSA9IHZpcnRpb19ncHVfZmVuY2VfYWxsb2ModmdkZXYpOwpAQCAtMzQ1LDcgKzMzOSw3IEBAIHN0
YXRpYyBpbnQgdmlydGlvX2dwdV90cmFuc2Zlcl9mcm9tX2hvc3RfaW9jdGwoc3RydWN0IGRybV9k
ZXZpY2UgKmRldiwKIAkJKHZnZGV2LCBxb2JqLT5od19yZXNfaGFuZGxlLAogCQkgdmZwcml2LT5j
dHhfaWQsIG9mZnNldCwgYXJncy0+bGV2ZWwsCiAJCSAmYm94LCBmZW5jZSk7Ci0JcmVzZXJ2YXRp
b25fb2JqZWN0X2FkZF9leGNsX2ZlbmNlKHFvYmotPnRiby5yZXN2LAorCXJlc2VydmF0aW9uX29i
amVjdF9hZGRfZXhjbF9mZW5jZShxb2JqLT5iYXNlLmJhc2UucmVzdiwKIAkJCQkJICAmZmVuY2Ut
PmYpOwogCiAJZG1hX2ZlbmNlX3B1dCgmZmVuY2UtPmYpOwpAQCAtMzYyLDcgKzM1Niw2IEBAIHN0
YXRpYyBpbnQgdmlydGlvX2dwdV90cmFuc2Zlcl90b19ob3N0X2lvY3RsKHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAJc3RydWN0IHZpcnRpb19ncHVfZGV2aWNlICp2Z2RldiA9
IGRldi0+ZGV2X3ByaXZhdGU7CiAJc3RydWN0IHZpcnRpb19ncHVfZnByaXYgKnZmcHJpdiA9IGZp
bGUtPmRyaXZlcl9wcml2OwogCXN0cnVjdCBkcm1fdmlydGdwdV8zZF90cmFuc2Zlcl90b19ob3N0
ICphcmdzID0gZGF0YTsKLQlzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHggY3R4ID0geyB0cnVlLCBm
YWxzZSB9OwogCXN0cnVjdCBkcm1fZ2VtX29iamVjdCAqZ29iaiA9IE5VTEw7CiAJc3RydWN0IHZp
cnRpb19ncHVfb2JqZWN0ICpxb2JqID0gTlVMTDsKIAlzdHJ1Y3QgdmlydGlvX2dwdV9mZW5jZSAq
ZmVuY2U7CkBAIC0zODAsMTAgKzM3Myw2IEBAIHN0YXRpYyBpbnQgdmlydGlvX2dwdV90cmFuc2Zl
cl90b19ob3N0X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAJaWYg
KHJldCkKIAkJZ290byBvdXQ7CiAKLQlyZXQgPSB0dG1fYm9fdmFsaWRhdGUoJnFvYmotPnRibywg
JnFvYmotPnBsYWNlbWVudCwgJmN0eCk7Ci0JaWYgKHVubGlrZWx5KHJldCkpCi0JCWdvdG8gb3V0
X3VucmVzOwotCiAJY29udmVydF90b19od19ib3goJmJveCwgJmFyZ3MtPmJveCk7CiAJaWYgKCF2
Z2Rldi0+aGFzX3ZpcmdsXzNkKSB7CiAJCXZpcnRpb19ncHVfY21kX3RyYW5zZmVyX3RvX2hvc3Rf
MmQKQEAgLTM5OSw3ICszODgsNyBAQCBzdGF0aWMgaW50IHZpcnRpb19ncHVfdHJhbnNmZXJfdG9f
aG9zdF9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCQkJKHZnZGV2
LCBxb2JqLAogCQkJIHZmcHJpdiA/IHZmcHJpdi0+Y3R4X2lkIDogMCwgb2Zmc2V0LAogCQkJIGFy
Z3MtPmxldmVsLCAmYm94LCBmZW5jZSk7Ci0JCXJlc2VydmF0aW9uX29iamVjdF9hZGRfZXhjbF9m
ZW5jZShxb2JqLT50Ym8ucmVzdiwKKwkJcmVzZXJ2YXRpb25fb2JqZWN0X2FkZF9leGNsX2ZlbmNl
KHFvYmotPmJhc2UuYmFzZS5yZXN2LAogCQkJCQkJICAmZmVuY2UtPmYpOwogCQlkbWFfZmVuY2Vf
cHV0KCZmZW5jZS0+Zik7CiAJfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92
aXJ0Z3B1X2ttcy5jIGIvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X2ttcy5jCmluZGV4
IDg0YjZhNmJmMDBjNi4uMGJjNmFiYWVhZmNhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
dmlydGlvL3ZpcnRncHVfa21zLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1
X2ttcy5jCkBAIC0xNzEsMTIgKzE3MSw2IEBAIGludCB2aXJ0aW9fZ3B1X2luaXQoc3RydWN0IGRy
bV9kZXZpY2UgKmRldikKIAkJZ290byBlcnJfdmJ1ZnM7CiAJfQogCi0JcmV0ID0gdmlydGlvX2dw
dV90dG1faW5pdCh2Z2Rldik7Ci0JaWYgKHJldCkgewotCQlEUk1fRVJST1IoImZhaWxlZCB0byBp
bml0IHR0bSAlZFxuIiwgcmV0KTsKLQkJZ290byBlcnJfdHRtOwotCX0KLQogCS8qIGdldCBkaXNw
bGF5IGluZm8gKi8KIAl2aXJ0aW9fY3JlYWQodmdkZXYtPnZkZXYsIHN0cnVjdCB2aXJ0aW9fZ3B1
X2NvbmZpZywKIAkJICAgICBudW1fc2Nhbm91dHMsICZudW1fc2Nhbm91dHMpOwpAQCAtMjA4LDgg
KzIwMiw2IEBAIGludCB2aXJ0aW9fZ3B1X2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKIAly
ZXR1cm4gMDsKIAogZXJyX3NjYW5vdXRzOgotCXZpcnRpb19ncHVfdHRtX2ZpbmkodmdkZXYpOwot
ZXJyX3R0bToKIAl2aXJ0aW9fZ3B1X2ZyZWVfdmJ1ZnModmdkZXYpOwogZXJyX3ZidWZzOgogCXZn
ZGV2LT52ZGV2LT5jb25maWctPmRlbF92cXModmdkZXYtPnZkZXYpOwpAQCAtMjQwLDcgKzIzMiw2
IEBAIHZvaWQgdmlydGlvX2dwdV9kZWluaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKIAl2Z2Rl
di0+dmRldi0+Y29uZmlnLT5kZWxfdnFzKHZnZGV2LT52ZGV2KTsKIAogCXZpcnRpb19ncHVfbW9k
ZXNldF9maW5pKHZnZGV2KTsKLQl2aXJ0aW9fZ3B1X3R0bV9maW5pKHZnZGV2KTsKIAl2aXJ0aW9f
Z3B1X2ZyZWVfdmJ1ZnModmdkZXYpOwogCXZpcnRpb19ncHVfY2xlYW51cF9jYXBfY2FjaGUodmdk
ZXYpOwogCWtmcmVlKHZnZGV2LT5jYXBzZXRzKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS92aXJ0aW8vdmlydGdwdV9vYmplY3QuYyBiL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8vdmlydGdw
dV9vYmplY3QuYwppbmRleCA5MDY0MjkwN2FhNWMuLmRjOWQwYjcxNzFhNCAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X29iamVjdC5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS92aXJ0aW8vdmlydGdwdV9vYmplY3QuYwpAQCAtMjMsOCArMjMsNiBAQAogICogV0lUSCBU
SEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUu
CiAgKi8KIAotI2luY2x1ZGUgPGRybS90dG0vdHRtX2V4ZWNidWZfdXRpbC5oPgotCiAjaW5jbHVk
ZSAidmlydGdwdV9kcnYuaCIKIAogc3RhdGljIGludCB2aXJ0aW9fZ3B1X3Jlc291cmNlX2lkX2dl
dChzdHJ1Y3QgdmlydGlvX2dwdV9kZXZpY2UgKnZnZGV2LApAQCAtNTcsMzkgKzU1LDQ0IEBAIHN0
YXRpYyB2b2lkIHZpcnRpb19ncHVfcmVzb3VyY2VfaWRfcHV0KHN0cnVjdCB2aXJ0aW9fZ3B1X2Rl
dmljZSAqdmdkZXYsIHVpbnQzMl90CiAjZW5kaWYKIH0KIAotc3RhdGljIHZvaWQgdmlydGlvX2dw
dV90dG1fYm9fZGVzdHJveShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKnRibykKK3N0YXRpYyB2
b2lkIHZpcnRpb19ncHVfZnJlZV9vYmplY3Qoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmopCiB7
Ci0Jc3RydWN0IHZpcnRpb19ncHVfb2JqZWN0ICpibzsKLQlzdHJ1Y3QgdmlydGlvX2dwdV9kZXZp
Y2UgKnZnZGV2OwotCi0JYm8gPSBjb250YWluZXJfb2YodGJvLCBzdHJ1Y3QgdmlydGlvX2dwdV9v
YmplY3QsIHRibyk7Ci0JdmdkZXYgPSAoc3RydWN0IHZpcnRpb19ncHVfZGV2aWNlICopYm8tPmdl
bV9iYXNlLmRldi0+ZGV2X3ByaXZhdGU7CisJc3RydWN0IHZpcnRpb19ncHVfb2JqZWN0ICpibyA9
IGdlbV90b192aXJ0aW9fZ3B1X29iaihvYmopOworCXN0cnVjdCB2aXJ0aW9fZ3B1X2RldmljZSAq
dmdkZXYgPSBiby0+YmFzZS5iYXNlLmRldi0+ZGV2X3ByaXZhdGU7CiAKKwlpZiAoYm8tPnBhZ2Vz
KQorCQl2aXJ0aW9fZ3B1X29iamVjdF9kZXRhY2godmdkZXYsIGJvKTsKIAlpZiAoYm8tPmNyZWF0
ZWQpCiAJCXZpcnRpb19ncHVfY21kX3VucmVmX3Jlc291cmNlKHZnZGV2LCBiby0+aHdfcmVzX2hh
bmRsZSk7Ci0JaWYgKGJvLT5wYWdlcykKLQkJdmlydGlvX2dwdV9vYmplY3RfZnJlZV9zZ190YWJs
ZShibyk7Ci0JaWYgKGJvLT52bWFwKQotCQl2aXJ0aW9fZ3B1X29iamVjdF9rdW5tYXAoYm8pOwot
CWRybV9nZW1fb2JqZWN0X3JlbGVhc2UoJmJvLT5nZW1fYmFzZSk7CiAJdmlydGlvX2dwdV9yZXNv
dXJjZV9pZF9wdXQodmdkZXYsIGJvLT5od19yZXNfaGFuZGxlKTsKLQlrZnJlZShibyk7CisKKwlk
cm1fZ2VtX3NobWVtX2ZyZWVfb2JqZWN0KG9iaik7CiB9CiAKLXN0YXRpYyB2b2lkIHZpcnRpb19n
cHVfaW5pdF90dG1fcGxhY2VtZW50KHN0cnVjdCB2aXJ0aW9fZ3B1X29iamVjdCAqdmdibykKK3N0
YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2dlbV9vYmplY3RfZnVuY3MgdmlydGlvX2dwdV9nZW1fZnVu
Y3MgPSB7CisJLmZyZWUgPSB2aXJ0aW9fZ3B1X2ZyZWVfb2JqZWN0LAorCS5vcGVuID0gdmlydGlv
X2dwdV9nZW1fb2JqZWN0X29wZW4sCisJLmNsb3NlID0gdmlydGlvX2dwdV9nZW1fb2JqZWN0X2Ns
b3NlLAorCisJLnByaW50X2luZm8gPSBkcm1fZ2VtX3NobWVtX3ByaW50X2luZm8sCisJLnBpbiA9
IGRybV9nZW1fc2htZW1fcGluLAorCS51bnBpbiA9IGRybV9nZW1fc2htZW1fdW5waW4sCisJLmdl
dF9zZ190YWJsZSA9IGRybV9nZW1fc2htZW1fZ2V0X3NnX3RhYmxlLAorCS52bWFwID0gZHJtX2dl
bV9zaG1lbV92bWFwLAorCS52dW5tYXAgPSBkcm1fZ2VtX3NobWVtX3Z1bm1hcCwKKwkudm1fb3Bz
ID0gJmRybV9nZW1fc2htZW1fdm1fb3BzLAorfTsKKworc3RydWN0IGRybV9nZW1fb2JqZWN0ICp2
aXJ0aW9fZ3B1X2NyZWF0ZV9vYmplY3Qoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKKwkJCQkJCXNp
emVfdCBzaXplKQogewotCXUzMiBjID0gMTsKKwlzdHJ1Y3QgdmlydGlvX2dwdV9vYmplY3QgKmJv
OwogCi0Jdmdiby0+cGxhY2VtZW50LnBsYWNlbWVudCA9ICZ2Z2JvLT5wbGFjZW1lbnRfY29kZTsK
LQl2Z2JvLT5wbGFjZW1lbnQuYnVzeV9wbGFjZW1lbnQgPSAmdmdiby0+cGxhY2VtZW50X2NvZGU7
Ci0Jdmdiby0+cGxhY2VtZW50X2NvZGUuZnBmbiA9IDA7Ci0Jdmdiby0+cGxhY2VtZW50X2NvZGUu
bHBmbiA9IDA7Ci0Jdmdiby0+cGxhY2VtZW50X2NvZGUuZmxhZ3MgPQotCQlUVE1fUExfTUFTS19D
QUNISU5HIHwgVFRNX1BMX0ZMQUdfVFQgfAotCQlUVE1fUExfRkxBR19OT19FVklDVDsKLQl2Z2Jv
LT5wbGFjZW1lbnQubnVtX3BsYWNlbWVudCA9IGM7Ci0Jdmdiby0+cGxhY2VtZW50Lm51bV9idXN5
X3BsYWNlbWVudCA9IGM7CisJYm8gPSBremFsbG9jKHNpemVvZigqYm8pLCBHRlBfS0VSTkVMKTsK
KwlpZiAoIWJvKQorCQlyZXR1cm4gTlVMTDsKIAorCXJldHVybiAmYm8tPmJhc2UuYmFzZTsKIH0K
IAogaW50IHZpcnRpb19ncHVfb2JqZWN0X2NyZWF0ZShzdHJ1Y3QgdmlydGlvX2dwdV9kZXZpY2Ug
KnZnZGV2LApAQCAtOTgsMjggKzEwMSwyMiBAQCBpbnQgdmlydGlvX2dwdV9vYmplY3RfY3JlYXRl
KHN0cnVjdCB2aXJ0aW9fZ3B1X2RldmljZSAqdmdkZXYsCiAJCQkgICAgIHN0cnVjdCB2aXJ0aW9f
Z3B1X2ZlbmNlICpmZW5jZSkKIHsKIAlzdHJ1Y3QgdmlydGlvX2dwdV9vYmplY3RfYXJyYXkgKm9i
anMgPSBOVUxMOworCXN0cnVjdCBkcm1fZ2VtX3NobWVtX29iamVjdCAqc2htZW1fb2JqOwogCXN0
cnVjdCB2aXJ0aW9fZ3B1X29iamVjdCAqYm87Ci0Jc2l6ZV90IGFjY19zaXplOwogCWludCByZXQ7
CiAKIAkqYm9fcHRyID0gTlVMTDsKIAotCWFjY19zaXplID0gdHRtX2JvX2RtYV9hY2Nfc2l6ZSgm
dmdkZXYtPm1tYW4uYmRldiwgcGFyYW1zLT5zaXplLAotCQkJCSAgICAgICBzaXplb2Yoc3RydWN0
IHZpcnRpb19ncHVfb2JqZWN0KSk7CisJcGFyYW1zLT5zaXplID0gcm91bmR1cChwYXJhbXMtPnNp
emUsIFBBR0VfU0laRSk7CisJc2htZW1fb2JqID0gZHJtX2dlbV9zaG1lbV9jcmVhdGUodmdkZXYt
PmRkZXYsIHBhcmFtcy0+c2l6ZSk7CisJaWYgKElTX0VSUihzaG1lbV9vYmopKQorCQlyZXR1cm4g
UFRSX0VSUihzaG1lbV9vYmopOworCWJvID0gZ2VtX3RvX3ZpcnRpb19ncHVfb2JqKCZzaG1lbV9v
YmotPmJhc2UpOworCWJvLT5iYXNlLmJhc2UuZnVuY3MgPSAmdmlydGlvX2dwdV9nZW1fZnVuY3M7
CiAKLQlibyA9IGt6YWxsb2Moc2l6ZW9mKHN0cnVjdCB2aXJ0aW9fZ3B1X29iamVjdCksIEdGUF9L
RVJORUwpOwotCWlmIChibyA9PSBOVUxMKQotCQlyZXR1cm4gLUVOT01FTTsKIAlyZXQgPSB2aXJ0
aW9fZ3B1X3Jlc291cmNlX2lkX2dldCh2Z2RldiwgJmJvLT5od19yZXNfaGFuZGxlKTsKIAlpZiAo
cmV0IDwgMCkgewotCQlrZnJlZShibyk7Ci0JCXJldHVybiByZXQ7Ci0JfQotCXBhcmFtcy0+c2l6
ZSA9IHJvdW5kdXAocGFyYW1zLT5zaXplLCBQQUdFX1NJWkUpOwotCXJldCA9IGRybV9nZW1fb2Jq
ZWN0X2luaXQodmdkZXYtPmRkZXYsICZiby0+Z2VtX2Jhc2UsIHBhcmFtcy0+c2l6ZSk7Ci0JaWYg
KHJldCAhPSAwKSB7Ci0JCXZpcnRpb19ncHVfcmVzb3VyY2VfaWRfcHV0KHZnZGV2LCBiby0+aHdf
cmVzX2hhbmRsZSk7Ci0JCWtmcmVlKGJvKTsKKwkJZHJtX2dlbV9zaG1lbV9mcmVlX29iamVjdCgm
c2htZW1fb2JqLT5iYXNlKTsKIAkJcmV0dXJuIHJldDsKIAl9CiAJYm8tPmR1bWIgPSBwYXJhbXMt
PmR1bWI7CkBAIC0xMjgsNyArMTI1LDcgQEAgaW50IHZpcnRpb19ncHVfb2JqZWN0X2NyZWF0ZShz
dHJ1Y3QgdmlydGlvX2dwdV9kZXZpY2UgKnZnZGV2LAogCQlzdHJ1Y3Qgd3dfYWNxdWlyZV9jdHgg
dGlja2V0OwogCiAJCW9ianMgPSB2aXJ0aW9fZ3B1X2FycmF5X2FsbG9jKDEpOwotCQlvYmpzLT5v
YmpzWzBdID0gJmJvLT5nZW1fYmFzZTsKKwkJb2Jqcy0+b2Jqc1swXSA9ICZiby0+YmFzZS5iYXNl
OwogCQlkcm1fZ2VtX29iamVjdF9nZXQob2Jqcy0+b2Jqc1swXSk7CiAKIAkJcmV0ID0gZHJtX2dl
bV9sb2NrX3Jlc2VydmF0aW9ucyhvYmpzLT5vYmpzLCBvYmpzLT5uZW50cywKQEAgLTE0Nyw3NSAr
MTQ0LDEyIEBAIGludCB2aXJ0aW9fZ3B1X29iamVjdF9jcmVhdGUoc3RydWN0IHZpcnRpb19ncHVf
ZGV2aWNlICp2Z2RldiwKIAkJCQkJICAgICAgIGZlbmNlLCBvYmpzKTsKIAl9CiAKLQl2aXJ0aW9f
Z3B1X2luaXRfdHRtX3BsYWNlbWVudChibyk7Ci0JcmV0ID0gdHRtX2JvX2luaXQoJnZnZGV2LT5t
bWFuLmJkZXYsICZiby0+dGJvLCBwYXJhbXMtPnNpemUsCi0JCQkgIHR0bV9ib190eXBlX2Rldmlj
ZSwgJmJvLT5wbGFjZW1lbnQsIDAsCi0JCQkgIHRydWUsIGFjY19zaXplLCBOVUxMLAotCQkJICBi
by0+Z2VtX2Jhc2UucmVzdiwKLQkJCSAgJnZpcnRpb19ncHVfdHRtX2JvX2Rlc3Ryb3kpOwotCS8q
IHR0bV9ib19pbml0IGZhaWx1cmUgd2lsbCBjYWxsIHRoZSBkZXN0cm95ICovCi0JaWYgKHJldCAh
PSAwKQorCXJldCA9IHZpcnRpb19ncHVfb2JqZWN0X2F0dGFjaCh2Z2RldiwgYm8sIE5VTEwpOwor
CWlmIChyZXQgIT0gMCkgeworCQl2aXJ0aW9fZ3B1X2ZyZWVfb2JqZWN0KCZzaG1lbV9vYmotPmJh
c2UpOwogCQlyZXR1cm4gcmV0OworCX0KIAogCSpib19wdHIgPSBibzsKIAlyZXR1cm4gMDsKIH0K
LQotdm9pZCB2aXJ0aW9fZ3B1X29iamVjdF9rdW5tYXAoc3RydWN0IHZpcnRpb19ncHVfb2JqZWN0
ICpibykKLXsKLQliby0+dm1hcCA9IE5VTEw7Ci0JdHRtX2JvX2t1bm1hcCgmYm8tPmttYXApOwot
fQotCi1pbnQgdmlydGlvX2dwdV9vYmplY3Rfa21hcChzdHJ1Y3QgdmlydGlvX2dwdV9vYmplY3Qg
KmJvKQotewotCWJvb2wgaXNfaW9tZW07Ci0JaW50IHI7Ci0KLQlXQVJOX09OKGJvLT52bWFwKTsK
LQotCXIgPSB0dG1fYm9fa21hcCgmYm8tPnRibywgMCwgYm8tPnRiby5udW1fcGFnZXMsICZiby0+
a21hcCk7Ci0JaWYgKHIpCi0JCXJldHVybiByOwotCWJvLT52bWFwID0gdHRtX2ttYXBfb2JqX3Zp
cnR1YWwoJmJvLT5rbWFwLCAmaXNfaW9tZW0pOwotCXJldHVybiAwOwotfQotCi1pbnQgdmlydGlv
X2dwdV9vYmplY3RfZ2V0X3NnX3RhYmxlKHN0cnVjdCB2aXJ0aW9fZ3B1X2RldmljZSAqcWRldiwK
LQkJCQkgICBzdHJ1Y3QgdmlydGlvX2dwdV9vYmplY3QgKmJvKQotewotCWludCByZXQ7Ci0Jc3Ry
dWN0IHBhZ2UgKipwYWdlcyA9IGJvLT50Ym8udHRtLT5wYWdlczsKLQlpbnQgbnJfcGFnZXMgPSBi
by0+dGJvLm51bV9wYWdlczsKLQlzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHggY3R4ID0gewotCQku
aW50ZXJydXB0aWJsZSA9IGZhbHNlLAotCQkubm9fd2FpdF9ncHUgPSBmYWxzZQotCX07Ci0KLQkv
KiB3dGYgc3dhcHBpbmcgKi8KLQlpZiAoYm8tPnBhZ2VzKQotCQlyZXR1cm4gMDsKLQotCWlmIChi
by0+dGJvLnR0bS0+c3RhdGUgPT0gdHRfdW5wb3B1bGF0ZWQpCi0JCWJvLT50Ym8udHRtLT5iZGV2
LT5kcml2ZXItPnR0bV90dF9wb3B1bGF0ZShiby0+dGJvLnR0bSwgJmN0eCk7Ci0JYm8tPnBhZ2Vz
ID0ga21hbGxvYyhzaXplb2Yoc3RydWN0IHNnX3RhYmxlKSwgR0ZQX0tFUk5FTCk7Ci0JaWYgKCFi
by0+cGFnZXMpCi0JCWdvdG8gb3V0OwotCi0JcmV0ID0gc2dfYWxsb2NfdGFibGVfZnJvbV9wYWdl
cyhiby0+cGFnZXMsIHBhZ2VzLCBucl9wYWdlcywgMCwKLQkJCQkJbnJfcGFnZXMgPDwgUEFHRV9T
SElGVCwgR0ZQX0tFUk5FTCk7Ci0JaWYgKHJldCkKLQkJZ290byBvdXQ7Ci0JcmV0dXJuIDA7Ci1v
dXQ6Ci0Ja2ZyZWUoYm8tPnBhZ2VzKTsKLQliby0+cGFnZXMgPSBOVUxMOwotCXJldHVybiAtRU5P
TUVNOwotfQotCi12b2lkIHZpcnRpb19ncHVfb2JqZWN0X2ZyZWVfc2dfdGFibGUoc3RydWN0IHZp
cnRpb19ncHVfb2JqZWN0ICpibykKLXsKLQlzZ19mcmVlX3RhYmxlKGJvLT5wYWdlcyk7Ci0Ja2Zy
ZWUoYm8tPnBhZ2VzKTsKLQliby0+cGFnZXMgPSBOVUxMOwotfQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X3ByaW1lLmMgYi9kcml2ZXJzL2dwdS9kcm0vdmlydGlv
L3ZpcnRncHVfcHJpbWUuYwppbmRleCA4ZmJmNzFiZDBjNWUuLjE4YTE1NWNkMDhkNSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X3ByaW1lLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X3ByaW1lLmMKQEAgLTI4LDQ2ICsyOCw5IEBACiAgKiBk
ZXZpY2UgdGhhdCBtaWdodCBzaGFyZSBidWZmZXJzIHdpdGggdmlydGdwdQogICovCiAKLXN0cnVj
dCBzZ190YWJsZSAqdmlydGdwdV9nZW1fcHJpbWVfZ2V0X3NnX3RhYmxlKHN0cnVjdCBkcm1fZ2Vt
X29iamVjdCAqb2JqKQotewotCXN0cnVjdCB2aXJ0aW9fZ3B1X29iamVjdCAqYm8gPSBnZW1fdG9f
dmlydGlvX2dwdV9vYmoob2JqKTsKLQotCWlmICghYm8tPnRiby50dG0tPnBhZ2VzIHx8ICFiby0+
dGJvLnR0bS0+bnVtX3BhZ2VzKQotCQkvKiBzaG91bGQgbm90IGhhcHBlbiAqLwotCQlyZXR1cm4g
RVJSX1BUUigtRUlOVkFMKTsKLQotCXJldHVybiBkcm1fcHJpbWVfcGFnZXNfdG9fc2coYm8tPnRi
by50dG0tPnBhZ2VzLAotCQkJCSAgICAgYm8tPnRiby50dG0tPm51bV9wYWdlcyk7Ci19Ci0KIHN0
cnVjdCBkcm1fZ2VtX29iamVjdCAqdmlydGdwdV9nZW1fcHJpbWVfaW1wb3J0X3NnX3RhYmxlKAog
CXN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFj
aCwKIAlzdHJ1Y3Qgc2dfdGFibGUgKnRhYmxlKQogewogCXJldHVybiBFUlJfUFRSKC1FTk9ERVYp
OwogfQotCi12b2lkICp2aXJ0Z3B1X2dlbV9wcmltZV92bWFwKHN0cnVjdCBkcm1fZ2VtX29iamVj
dCAqb2JqKQotewotCXN0cnVjdCB2aXJ0aW9fZ3B1X29iamVjdCAqYm8gPSBnZW1fdG9fdmlydGlv
X2dwdV9vYmoob2JqKTsKLQlpbnQgcmV0OwotCi0JcmV0ID0gdmlydGlvX2dwdV9vYmplY3Rfa21h
cChibyk7Ci0JaWYgKHJldCkKLQkJcmV0dXJuIE5VTEw7Ci0JcmV0dXJuIGJvLT52bWFwOwotfQot
Ci12b2lkIHZpcnRncHVfZ2VtX3ByaW1lX3Z1bm1hcChzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9i
aiwgdm9pZCAqdmFkZHIpCi17Ci0JdmlydGlvX2dwdV9vYmplY3Rfa3VubWFwKGdlbV90b192aXJ0
aW9fZ3B1X29iaihvYmopKTsKLX0KLQotaW50IHZpcnRncHVfZ2VtX3ByaW1lX21tYXAoc3RydWN0
IGRybV9nZW1fb2JqZWN0ICpvYmosCi0JCQkgICBzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSkK
LXsKLQlzdHJ1Y3QgdmlydGlvX2dwdV9vYmplY3QgKmJvID0gZ2VtX3RvX3ZpcnRpb19ncHVfb2Jq
KG9iaik7Ci0KLQliby0+Z2VtX2Jhc2Uudm1hX25vZGUudm1fbm9kZS5zdGFydCA9IGJvLT50Ym8u
dm1hX25vZGUudm1fbm9kZS5zdGFydDsKLQlyZXR1cm4gZHJtX2dlbV9wcmltZV9tbWFwKG9iaiwg
dm1hKTsKLX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8vdmlydGdwdV90dG0u
YyBiL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8vdmlydGdwdV90dG0uYwpkZWxldGVkIGZpbGUgbW9k
ZSAxMDA2NDQKaW5kZXggMzAwZWYzYTgzNTM4Li4wMDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL3ZpcnRpby92aXJ0Z3B1X3R0bS5jCisrKyAvZGV2L251bGwKQEAgLTEsMzA0ICswLDAg
QEAKLS8qCi0gKiBDb3B5cmlnaHQgKEMpIDIwMTUgUmVkIEhhdCwgSW5jLgotICogQWxsIFJpZ2h0
cyBSZXNlcnZlZC4KLSAqCi0gKiBBdXRob3JzOgotICogICAgRGF2ZSBBaXJsaWUKLSAqICAgIEFs
b24gTGV2eQotICoKLSAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hh
cmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCi0gKiBjb3B5IG9mIHRoaXMgc29mdHdhcmUg
YW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLAotICog
dG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdp
dGhvdXQgbGltaXRhdGlvbgotICogdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVy
Z2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsCi0gKiBhbmQvb3Igc2VsbCBjb3Bp
ZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUKLSAq
IFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5n
IGNvbmRpdGlvbnM6Ci0gKgotICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMg
cGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4KLSAqIGFsbCBjb3BpZXMgb3Ig
c3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgotICoKLSAqIFRIRSBTT0ZUV0FS
RSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBS
RVNTIE9SCi0gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJS
QU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKLSAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQ
VVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTAotICogVEhFIENP
UFlSSUdIVCBIT0xERVIoUykgT1IgQVVUSE9SKFMpIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBE
QU1BR0VTIE9SCi0gKiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENP
TlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwKLSAqIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElO
IENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUgotICogT1RIRVIgREVB
TElOR1MgSU4gVEhFIFNPRlRXQVJFLgotICovCi0KLSNpbmNsdWRlIDxkcm0vdHRtL3R0bV9ib19h
cGkuaD4KLSNpbmNsdWRlIDxkcm0vdHRtL3R0bV9ib19kcml2ZXIuaD4KLSNpbmNsdWRlIDxkcm0v
dHRtL3R0bV9wbGFjZW1lbnQuaD4KLSNpbmNsdWRlIDxkcm0vdHRtL3R0bV9wYWdlX2FsbG9jLmg+
Ci0jaW5jbHVkZSA8ZHJtL3R0bS90dG1fbW9kdWxlLmg+Ci0jaW5jbHVkZSA8ZHJtL2RybVAuaD4K
LSNpbmNsdWRlIDxkcm0vZHJtLmg+Ci0jaW5jbHVkZSA8ZHJtL3ZpcnRncHVfZHJtLmg+Ci0jaW5j
bHVkZSAidmlydGdwdV9kcnYuaCIKLQotI2luY2x1ZGUgPGxpbnV4L2RlbGF5Lmg+Ci0KLXN0YXRp
YyBzdHJ1Y3QKLXZpcnRpb19ncHVfZGV2aWNlICp2aXJ0aW9fZ3B1X2dldF92Z2RldihzdHJ1Y3Qg
dHRtX2JvX2RldmljZSAqYmRldikKLXsKLQlzdHJ1Y3QgdmlydGlvX2dwdV9tbWFuICptbWFuOwot
CXN0cnVjdCB2aXJ0aW9fZ3B1X2RldmljZSAqdmdkZXY7Ci0KLQltbWFuID0gY29udGFpbmVyX29m
KGJkZXYsIHN0cnVjdCB2aXJ0aW9fZ3B1X21tYW4sIGJkZXYpOwotCXZnZGV2ID0gY29udGFpbmVy
X29mKG1tYW4sIHN0cnVjdCB2aXJ0aW9fZ3B1X2RldmljZSwgbW1hbik7Ci0JcmV0dXJuIHZnZGV2
OwotfQotCi1pbnQgdmlydGlvX2dwdV9tbWFwKHN0cnVjdCBmaWxlICpmaWxwLCBzdHJ1Y3Qgdm1f
YXJlYV9zdHJ1Y3QgKnZtYSkKLXsKLQlzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdjsKLQlzdHJ1
Y3QgdmlydGlvX2dwdV9kZXZpY2UgKnZnZGV2OwotCWludCByOwotCi0JZmlsZV9wcml2ID0gZmls
cC0+cHJpdmF0ZV9kYXRhOwotCXZnZGV2ID0gZmlsZV9wcml2LT5taW5vci0+ZGV2LT5kZXZfcHJp
dmF0ZTsKLQlpZiAodmdkZXYgPT0gTlVMTCkgewotCQlEUk1fRVJST1IoCi0JCSAiZmlscC0+cHJp
dmF0ZV9kYXRhLT5taW5vci0+ZGV2LT5kZXZfcHJpdmF0ZSA9PSBOVUxMXG4iKTsKLQkJcmV0dXJu
IC1FSU5WQUw7Ci0JfQotCXIgPSB0dG1fYm9fbW1hcChmaWxwLCB2bWEsICZ2Z2Rldi0+bW1hbi5i
ZGV2KTsKLQotCXJldHVybiByOwotfQotCi1zdGF0aWMgaW50IHZpcnRpb19ncHVfaW52YWxpZGF0
ZV9jYWNoZXMoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCi0JCQkJCXVpbnQzMl90IGZsYWdz
KQotewotCXJldHVybiAwOwotfQotCi1zdGF0aWMgaW50IHR0bV9ib19tYW5fZ2V0X25vZGUoc3Ry
dWN0IHR0bV9tZW1fdHlwZV9tYW5hZ2VyICptYW4sCi0JCQkgICAgICAgc3RydWN0IHR0bV9idWZm
ZXJfb2JqZWN0ICpibywKLQkJCSAgICAgICBjb25zdCBzdHJ1Y3QgdHRtX3BsYWNlICpwbGFjZSwK
LQkJCSAgICAgICBzdHJ1Y3QgdHRtX21lbV9yZWcgKm1lbSkKLXsKLQltZW0tPm1tX25vZGUgPSAo
dm9pZCAqKTE7Ci0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyB2b2lkIHR0bV9ib19tYW5fcHV0X25v
ZGUoc3RydWN0IHR0bV9tZW1fdHlwZV9tYW5hZ2VyICptYW4sCi0JCQkJc3RydWN0IHR0bV9tZW1f
cmVnICptZW0pCi17Ci0JbWVtLT5tbV9ub2RlID0gKHZvaWQgKilOVUxMOwotfQotCi1zdGF0aWMg
aW50IHR0bV9ib19tYW5faW5pdChzdHJ1Y3QgdHRtX21lbV90eXBlX21hbmFnZXIgKm1hbiwKLQkJ
CSAgIHVuc2lnbmVkIGxvbmcgcF9zaXplKQotewotCXJldHVybiAwOwotfQotCi1zdGF0aWMgaW50
IHR0bV9ib19tYW5fdGFrZWRvd24oc3RydWN0IHR0bV9tZW1fdHlwZV9tYW5hZ2VyICptYW4pCi17
Ci0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyB2b2lkIHR0bV9ib19tYW5fZGVidWcoc3RydWN0IHR0
bV9tZW1fdHlwZV9tYW5hZ2VyICptYW4sCi0JCQkgICAgIHN0cnVjdCBkcm1fcHJpbnRlciAqcHJp
bnRlcikKLXsKLX0KLQotc3RhdGljIGNvbnN0IHN0cnVjdCB0dG1fbWVtX3R5cGVfbWFuYWdlcl9m
dW5jIHZpcnRpb19ncHVfYm9fbWFuYWdlcl9mdW5jID0gewotCS5pbml0ID0gdHRtX2JvX21hbl9p
bml0LAotCS50YWtlZG93biA9IHR0bV9ib19tYW5fdGFrZWRvd24sCi0JLmdldF9ub2RlID0gdHRt
X2JvX21hbl9nZXRfbm9kZSwKLQkucHV0X25vZGUgPSB0dG1fYm9fbWFuX3B1dF9ub2RlLAotCS5k
ZWJ1ZyA9IHR0bV9ib19tYW5fZGVidWcKLX07Ci0KLXN0YXRpYyBpbnQgdmlydGlvX2dwdV9pbml0
X21lbV90eXBlKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LCB1aW50MzJfdCB0eXBlLAotCQkJ
CSAgICBzdHJ1Y3QgdHRtX21lbV90eXBlX21hbmFnZXIgKm1hbikKLXsKLQlzd2l0Y2ggKHR5cGUp
IHsKLQljYXNlIFRUTV9QTF9TWVNURU06Ci0JCS8qIFN5c3RlbSBtZW1vcnkgKi8KLQkJbWFuLT5m
bGFncyA9IFRUTV9NRU1UWVBFX0ZMQUdfTUFQUEFCTEU7Ci0JCW1hbi0+YXZhaWxhYmxlX2NhY2hp
bmcgPSBUVE1fUExfTUFTS19DQUNISU5HOwotCQltYW4tPmRlZmF1bHRfY2FjaGluZyA9IFRUTV9Q
TF9GTEFHX0NBQ0hFRDsKLQkJYnJlYWs7Ci0JY2FzZSBUVE1fUExfVFQ6Ci0JCW1hbi0+ZnVuYyA9
ICZ2aXJ0aW9fZ3B1X2JvX21hbmFnZXJfZnVuYzsKLQkJbWFuLT5mbGFncyA9IFRUTV9NRU1UWVBF
X0ZMQUdfTUFQUEFCTEU7Ci0JCW1hbi0+YXZhaWxhYmxlX2NhY2hpbmcgPSBUVE1fUExfTUFTS19D
QUNISU5HOwotCQltYW4tPmRlZmF1bHRfY2FjaGluZyA9IFRUTV9QTF9GTEFHX0NBQ0hFRDsKLQkJ
YnJlYWs7Ci0JZGVmYXVsdDoKLQkJRFJNX0VSUk9SKCJVbnN1cHBvcnRlZCBtZW1vcnkgdHlwZSAl
dVxuIiwgKHVuc2lnbmVkIGludCl0eXBlKTsKLQkJcmV0dXJuIC1FSU5WQUw7Ci0JfQotCXJldHVy
biAwOwotfQotCi1zdGF0aWMgdm9pZCB2aXJ0aW9fZ3B1X2V2aWN0X2ZsYWdzKHN0cnVjdCB0dG1f
YnVmZmVyX29iamVjdCAqYm8sCi0JCQkJc3RydWN0IHR0bV9wbGFjZW1lbnQgKnBsYWNlbWVudCkK
LXsKLQlzdGF0aWMgY29uc3Qgc3RydWN0IHR0bV9wbGFjZSBwbGFjZW1lbnRzID0gewotCQkuZnBm
biAgPSAwLAotCQkubHBmbiAgPSAwLAotCQkuZmxhZ3MgPSBUVE1fUExfTUFTS19DQUNISU5HIHwg
VFRNX1BMX0ZMQUdfU1lTVEVNLAotCX07Ci0KLQlwbGFjZW1lbnQtPnBsYWNlbWVudCA9ICZwbGFj
ZW1lbnRzOwotCXBsYWNlbWVudC0+YnVzeV9wbGFjZW1lbnQgPSAmcGxhY2VtZW50czsKLQlwbGFj
ZW1lbnQtPm51bV9wbGFjZW1lbnQgPSAxOwotCXBsYWNlbWVudC0+bnVtX2J1c3lfcGxhY2VtZW50
ID0gMTsKLX0KLQotc3RhdGljIGludCB2aXJ0aW9fZ3B1X3ZlcmlmeV9hY2Nlc3Moc3RydWN0IHR0
bV9idWZmZXJfb2JqZWN0ICpibywKLQkJCQkgICAgc3RydWN0IGZpbGUgKmZpbHApCi17Ci0JcmV0
dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgdmlydGlvX2dwdV90dG1faW9fbWVtX3Jlc2VydmUoc3Ry
dWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCi0JCQkJCSBzdHJ1Y3QgdHRtX21lbV9yZWcgKm1lbSkK
LXsKLQlzdHJ1Y3QgdHRtX21lbV90eXBlX21hbmFnZXIgKm1hbiA9ICZiZGV2LT5tYW5bbWVtLT5t
ZW1fdHlwZV07Ci0KLQltZW0tPmJ1cy5hZGRyID0gTlVMTDsKLQltZW0tPmJ1cy5vZmZzZXQgPSAw
OwotCW1lbS0+YnVzLnNpemUgPSBtZW0tPm51bV9wYWdlcyA8PCBQQUdFX1NISUZUOwotCW1lbS0+
YnVzLmJhc2UgPSAwOwotCW1lbS0+YnVzLmlzX2lvbWVtID0gZmFsc2U7Ci0JaWYgKCEobWFuLT5m
bGFncyAmIFRUTV9NRU1UWVBFX0ZMQUdfTUFQUEFCTEUpKQotCQlyZXR1cm4gLUVJTlZBTDsKLQlz
d2l0Y2ggKG1lbS0+bWVtX3R5cGUpIHsKLQljYXNlIFRUTV9QTF9TWVNURU06Ci0JY2FzZSBUVE1f
UExfVFQ6Ci0JCS8qIHN5c3RlbSBtZW1vcnkgKi8KLQkJcmV0dXJuIDA7Ci0JZGVmYXVsdDoKLQkJ
cmV0dXJuIC1FSU5WQUw7Ci0JfQotCXJldHVybiAwOwotfQotCi1zdGF0aWMgdm9pZCB2aXJ0aW9f
Z3B1X3R0bV9pb19tZW1fZnJlZShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKLQkJCQkgICAg
ICAgc3RydWN0IHR0bV9tZW1fcmVnICptZW0pCi17Ci19Ci0KLS8qCi0gKiBUVE0gYmFja2VuZCBm
dW5jdGlvbnMuCi0gKi8KLXN0cnVjdCB2aXJ0aW9fZ3B1X3R0bV90dCB7Ci0Jc3RydWN0IHR0bV9k
bWFfdHQJCXR0bTsKLQlzdHJ1Y3QgdmlydGlvX2dwdV9vYmplY3QgICAgICAgICpvYmo7Ci19Owot
Ci1zdGF0aWMgaW50IHZpcnRpb19ncHVfdHRtX3R0X2JpbmQoc3RydWN0IHR0bV90dCAqdHRtLAot
CQkJCSAgc3RydWN0IHR0bV9tZW1fcmVnICpib19tZW0pCi17Ci0Jc3RydWN0IHZpcnRpb19ncHVf
dHRtX3R0ICpndHQgPQotCQljb250YWluZXJfb2YodHRtLCBzdHJ1Y3QgdmlydGlvX2dwdV90dG1f
dHQsIHR0bS50dG0pOwotCXN0cnVjdCB2aXJ0aW9fZ3B1X2RldmljZSAqdmdkZXYgPQotCQl2aXJ0
aW9fZ3B1X2dldF92Z2RldihndHQtPm9iai0+dGJvLmJkZXYpOwotCi0JdmlydGlvX2dwdV9vYmpl
Y3RfYXR0YWNoKHZnZGV2LCBndHQtPm9iaiwgTlVMTCk7Ci0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRp
YyBpbnQgdmlydGlvX2dwdV90dG1fdHRfdW5iaW5kKHN0cnVjdCB0dG1fdHQgKnR0bSkKLXsKLQlz
dHJ1Y3QgdmlydGlvX2dwdV90dG1fdHQgKmd0dCA9Ci0JCWNvbnRhaW5lcl9vZih0dG0sIHN0cnVj
dCB2aXJ0aW9fZ3B1X3R0bV90dCwgdHRtLnR0bSk7Ci0Jc3RydWN0IHZpcnRpb19ncHVfZGV2aWNl
ICp2Z2RldiA9Ci0JCXZpcnRpb19ncHVfZ2V0X3ZnZGV2KGd0dC0+b2JqLT50Ym8uYmRldik7Ci0K
LQl2aXJ0aW9fZ3B1X29iamVjdF9kZXRhY2godmdkZXYsIGd0dC0+b2JqKTsKLQlyZXR1cm4gMDsK
LX0KLQotc3RhdGljIHZvaWQgdmlydGlvX2dwdV90dG1fdHRfZGVzdHJveShzdHJ1Y3QgdHRtX3R0
ICp0dG0pCi17Ci0Jc3RydWN0IHZpcnRpb19ncHVfdHRtX3R0ICpndHQgPQotCQljb250YWluZXJf
b2YodHRtLCBzdHJ1Y3QgdmlydGlvX2dwdV90dG1fdHQsIHR0bS50dG0pOwotCi0JdHRtX2RtYV90
dF9maW5pKCZndHQtPnR0bSk7Ci0Ja2ZyZWUoZ3R0KTsKLX0KLQotc3RhdGljIHN0cnVjdCB0dG1f
YmFja2VuZF9mdW5jIHZpcnRpb19ncHVfdHRfZnVuYyA9IHsKLQkuYmluZCA9ICZ2aXJ0aW9fZ3B1
X3R0bV90dF9iaW5kLAotCS51bmJpbmQgPSAmdmlydGlvX2dwdV90dG1fdHRfdW5iaW5kLAotCS5k
ZXN0cm95ID0gJnZpcnRpb19ncHVfdHRtX3R0X2Rlc3Ryb3ksCi19OwotCi1zdGF0aWMgc3RydWN0
IHR0bV90dCAqdmlydGlvX2dwdV90dG1fdHRfY3JlYXRlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVj
dCAqYm8sCi0JCQkJCSAgICAgICB1aW50MzJfdCBwYWdlX2ZsYWdzKQotewotCXN0cnVjdCB2aXJ0
aW9fZ3B1X2RldmljZSAqdmdkZXY7Ci0Jc3RydWN0IHZpcnRpb19ncHVfdHRtX3R0ICpndHQ7Ci0K
LQl2Z2RldiA9IHZpcnRpb19ncHVfZ2V0X3ZnZGV2KGJvLT5iZGV2KTsKLQlndHQgPSBremFsbG9j
KHNpemVvZihzdHJ1Y3QgdmlydGlvX2dwdV90dG1fdHQpLCBHRlBfS0VSTkVMKTsKLQlpZiAoZ3R0
ID09IE5VTEwpCi0JCXJldHVybiBOVUxMOwotCWd0dC0+dHRtLnR0bS5mdW5jID0gJnZpcnRpb19n
cHVfdHRfZnVuYzsKLQlndHQtPm9iaiA9IGNvbnRhaW5lcl9vZihibywgc3RydWN0IHZpcnRpb19n
cHVfb2JqZWN0LCB0Ym8pOwotCWlmICh0dG1fZG1hX3R0X2luaXQoJmd0dC0+dHRtLCBibywgcGFn
ZV9mbGFncykpIHsKLQkJa2ZyZWUoZ3R0KTsKLQkJcmV0dXJuIE5VTEw7Ci0JfQotCXJldHVybiAm
Z3R0LT50dG0udHRtOwotfQotCi1zdGF0aWMgdm9pZCB2aXJ0aW9fZ3B1X2JvX3N3YXBfbm90aWZ5
KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqdGJvKQotewotCXN0cnVjdCB2aXJ0aW9fZ3B1X29i
amVjdCAqYm87Ci0KLQlibyA9IGNvbnRhaW5lcl9vZih0Ym8sIHN0cnVjdCB2aXJ0aW9fZ3B1X29i
amVjdCwgdGJvKTsKLQotCWlmIChiby0+cGFnZXMpCi0JCXZpcnRpb19ncHVfb2JqZWN0X2ZyZWVf
c2dfdGFibGUoYm8pOwotfQotCi1zdGF0aWMgc3RydWN0IHR0bV9ib19kcml2ZXIgdmlydGlvX2dw
dV9ib19kcml2ZXIgPSB7Ci0JLnR0bV90dF9jcmVhdGUgPSAmdmlydGlvX2dwdV90dG1fdHRfY3Jl
YXRlLAotCS5pbnZhbGlkYXRlX2NhY2hlcyA9ICZ2aXJ0aW9fZ3B1X2ludmFsaWRhdGVfY2FjaGVz
LAotCS5pbml0X21lbV90eXBlID0gJnZpcnRpb19ncHVfaW5pdF9tZW1fdHlwZSwKLQkuZXZpY3Rp
b25fdmFsdWFibGUgPSB0dG1fYm9fZXZpY3Rpb25fdmFsdWFibGUsCi0JLmV2aWN0X2ZsYWdzID0g
JnZpcnRpb19ncHVfZXZpY3RfZmxhZ3MsCi0JLnZlcmlmeV9hY2Nlc3MgPSAmdmlydGlvX2dwdV92
ZXJpZnlfYWNjZXNzLAotCS5pb19tZW1fcmVzZXJ2ZSA9ICZ2aXJ0aW9fZ3B1X3R0bV9pb19tZW1f
cmVzZXJ2ZSwKLQkuaW9fbWVtX2ZyZWUgPSAmdmlydGlvX2dwdV90dG1faW9fbWVtX2ZyZWUsCi0J
LnN3YXBfbm90aWZ5ID0gJnZpcnRpb19ncHVfYm9fc3dhcF9ub3RpZnksCi19OwotCi1pbnQgdmly
dGlvX2dwdV90dG1faW5pdChzdHJ1Y3QgdmlydGlvX2dwdV9kZXZpY2UgKnZnZGV2KQotewotCWlu
dCByOwotCi0JLyogTm8gb3RoZXJzIHVzZXIgb2YgYWRkcmVzcyBzcGFjZSBzbyBzZXQgaXQgdG8g
MCAqLwotCXIgPSB0dG1fYm9fZGV2aWNlX2luaXQoJnZnZGV2LT5tbWFuLmJkZXYsCi0JCQkgICAg
ICAgJnZpcnRpb19ncHVfYm9fZHJpdmVyLAotCQkJICAgICAgIHZnZGV2LT5kZGV2LT5hbm9uX2lu
b2RlLT5pX21hcHBpbmcsCi0JCQkgICAgICAgZmFsc2UpOwotCWlmIChyKSB7Ci0JCURSTV9FUlJP
UigiZmFpbGVkIGluaXRpYWxpemluZyBidWZmZXIgb2JqZWN0IGRyaXZlciglZCkuXG4iLCByKTsK
LQkJZ290byBlcnJfZGV2X2luaXQ7Ci0JfQotCi0JciA9IHR0bV9ib19pbml0X21tKCZ2Z2Rldi0+
bW1hbi5iZGV2LCBUVE1fUExfVFQsIDApOwotCWlmIChyKSB7Ci0JCURSTV9FUlJPUigiRmFpbGVk
IGluaXRpYWxpemluZyBHVFQgaGVhcC5cbiIpOwotCQlnb3RvIGVycl9tbV9pbml0OwotCX0KLQly
ZXR1cm4gMDsKLQotZXJyX21tX2luaXQ6Ci0JdHRtX2JvX2RldmljZV9yZWxlYXNlKCZ2Z2Rldi0+
bW1hbi5iZGV2KTsKLWVycl9kZXZfaW5pdDoKLQlyZXR1cm4gcjsKLX0KLQotdm9pZCB2aXJ0aW9f
Z3B1X3R0bV9maW5pKHN0cnVjdCB2aXJ0aW9fZ3B1X2RldmljZSAqdmdkZXYpCi17Ci0JdHRtX2Jv
X2RldmljZV9yZWxlYXNlKCZ2Z2Rldi0+bW1hbi5iZGV2KTsKLQlEUk1fSU5GTygidmlydGlvX2dw
dTogdHRtIGZpbmFsaXplZFxuIik7Ci19CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdmly
dGlvL3ZpcnRncHVfdnEuYyBiL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8vdmlydGdwdV92cS5jCmlu
ZGV4IDZlMmIyODdhN2U0Yi4uMzUyZmQwNjg5NDA2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vdmlydGlvL3ZpcnRncHVfdnEuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRn
cHVfdnEuYwpAQCAtOTc0LDE3ICs5NzQsMjEgQEAgaW50IHZpcnRpb19ncHVfb2JqZWN0X2F0dGFj
aChzdHJ1Y3QgdmlydGlvX2dwdV9kZXZpY2UgKnZnZGV2LAogCWJvb2wgdXNlX2RtYV9hcGkgPSAh
dmlydGlvX2hhc19pb21tdV9xdWlyayh2Z2Rldi0+dmRldik7CiAJc3RydWN0IHZpcnRpb19ncHVf
bWVtX2VudHJ5ICplbnRzOwogCXN0cnVjdCBzY2F0dGVybGlzdCAqc2c7Ci0JaW50IHNpLCBuZW50
czsKKwlpbnQgc2ksIG5lbnRzLCByZXQ7CiAKIAlpZiAoV0FSTl9PTl9PTkNFKCFvYmotPmNyZWF0
ZWQpKQogCQlyZXR1cm4gLUVJTlZBTDsKKwlpZiAoV0FSTl9PTl9PTkNFKG9iai0+cGFnZXMpKQor
CQlyZXR1cm4gLUVJTlZBTDsKIAotCWlmICghb2JqLT5wYWdlcykgewotCQlpbnQgcmV0OworCXJl
dCA9IGRybV9nZW1fc2htZW1fcGluKCZvYmotPmJhc2UuYmFzZSk7CisJaWYgKHJldCA8IDApCisJ
CXJldHVybiAtRUlOVkFMOwogCi0JCXJldCA9IHZpcnRpb19ncHVfb2JqZWN0X2dldF9zZ190YWJs
ZSh2Z2Rldiwgb2JqKTsKLQkJaWYgKHJldCkKLQkJCXJldHVybiByZXQ7CisJb2JqLT5wYWdlcyA9
IGRybV9nZW1fc2htZW1fZ2V0X3NnX3RhYmxlKCZvYmotPmJhc2UuYmFzZSk7CisJaWYgKG9iai0+
cGFnZXMgPT0gTlVMTCkgeworCQlkcm1fZ2VtX3NobWVtX3VucGluKCZvYmotPmJhc2UuYmFzZSk7
CisJCXJldHVybiAtRUlOVkFMOwogCX0KIAogCWlmICh1c2VfZG1hX2FwaSkgewpAQCAtMTAyMyw2
ICsxMDI3LDkgQEAgdm9pZCB2aXJ0aW9fZ3B1X29iamVjdF9kZXRhY2goc3RydWN0IHZpcnRpb19n
cHVfZGV2aWNlICp2Z2RldiwKIHsKIAlib29sIHVzZV9kbWFfYXBpID0gIXZpcnRpb19oYXNfaW9t
bXVfcXVpcmsodmdkZXYtPnZkZXYpOwogCisJaWYgKFdBUk5fT05fT05DRSghb2JqLT5wYWdlcykp
CisJCXJldHVybjsKKwogCWlmICh1c2VfZG1hX2FwaSAmJiBvYmotPm1hcHBlZCkgewogCQlzdHJ1
Y3QgdmlydGlvX2dwdV9mZW5jZSAqZmVuY2UgPSB2aXJ0aW9fZ3B1X2ZlbmNlX2FsbG9jKHZnZGV2
KTsKIAkJLyogZGV0YWNoIGJhY2tpbmcgYW5kIHdhaXQgZm9yIHRoZSBob3N0IHByb2Nlc3MgaXQg
Li4uICovCkBAIC0xMDM4LDYgKzEwNDUsMTEgQEAgdm9pZCB2aXJ0aW9fZ3B1X29iamVjdF9kZXRh
Y2goc3RydWN0IHZpcnRpb19ncHVfZGV2aWNlICp2Z2RldiwKIAl9IGVsc2UgewogCQl2aXJ0aW9f
Z3B1X2NtZF9yZXNvdXJjZV9pbnZhbF9iYWNraW5nKHZnZGV2LCBvYmotPmh3X3Jlc19oYW5kbGUs
IE5VTEwpOwogCX0KKworCXNnX2ZyZWVfdGFibGUob2JqLT5wYWdlcyk7CisJb2JqLT5wYWdlcyA9
IE5VTEw7CisKKwlkcm1fZ2VtX3NobWVtX3VucGluKCZvYmotPmJhc2UuYmFzZSk7CiB9CiAKIHZv
aWQgdmlydGlvX2dwdV9jdXJzb3JfcGluZyhzdHJ1Y3QgdmlydGlvX2dwdV9kZXZpY2UgKnZnZGV2
LApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby9LY29uZmlnIGIvZHJpdmVycy9n
cHUvZHJtL3ZpcnRpby9LY29uZmlnCmluZGV4IGJhMzZlOTMzYmI0OS4uZWZmMzA0NzA1MmQ0IDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL0tjb25maWcKKysrIGIvZHJpdmVycy9n
cHUvZHJtL3ZpcnRpby9LY29uZmlnCkBAIC0zLDcgKzMsNyBAQCBjb25maWcgRFJNX1ZJUlRJT19H
UFUKIAl0cmlzdGF0ZSAiVmlydGlvIEdQVSBkcml2ZXIiCiAJZGVwZW5kcyBvbiBEUk0gJiYgVklS
VElPICYmIE1NVQogCXNlbGVjdCBEUk1fS01TX0hFTFBFUgotCXNlbGVjdCBEUk1fVFRNCisJc2Vs
ZWN0IERSTV9HRU1fU0hNRU1fSEVMUEVSCiAJaGVscAogCSAgIFRoaXMgaXMgdGhlIHZpcnR1YWwg
R1BVIGRyaXZlciBmb3IgdmlydGlvLiAgSXQgY2FuIGJlIHVzZWQgd2l0aAogCSAgIFFFTVUgYmFz
ZWQgVk1NcyAobGlrZSBLVk0gb3IgWGVuKS4KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92
aXJ0aW8vTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL01ha2VmaWxlCmluZGV4IDQ1
OGU2MDZhOTM2Zi4uOTJhYTJiM2QzNDlkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdmly
dGlvL01ha2VmaWxlCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8vTWFrZWZpbGUKQEAgLTQs
NyArNCw3IEBACiAjIERpcmVjdCBSZW5kZXJpbmcgSW5mcmFzdHJ1Y3R1cmUgKERSSSkgaW4gWEZy
ZWU4NiA0LjEuMCBhbmQgaGlnaGVyLgogCiB2aXJ0aW8tZ3B1LXkgOj0gdmlydGdwdV9kcnYubyB2
aXJ0Z3B1X2ttcy5vIHZpcnRncHVfZ2VtLm8gXAotCXZpcnRncHVfZGlzcGxheS5vIHZpcnRncHVf
dnEubyB2aXJ0Z3B1X3R0bS5vIFwKKwl2aXJ0Z3B1X2Rpc3BsYXkubyB2aXJ0Z3B1X3ZxLm8gXAog
CXZpcnRncHVfZmVuY2UubyB2aXJ0Z3B1X29iamVjdC5vIHZpcnRncHVfZGVidWdmcy5vIHZpcnRn
cHVfcGxhbmUubyBcCiAJdmlydGdwdV9pb2N0bC5vIHZpcnRncHVfcHJpbWUubyB2aXJ0Z3B1X3Ry
YWNlX3BvaW50cy5vCiAKLS0gCjIuMTguMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlz
dGluZm8vZHJpLWRldmVs
