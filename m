Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 5FB21426B8
	for <lists+dri-devel@lfdr.de>; Wed, 12 Jun 2019 14:55:14 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A3BDA894E7;
	Wed, 12 Jun 2019 12:55:11 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-it1-x141.google.com (mail-it1-x141.google.com
 [IPv6:2607:f8b0:4864:20::141])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 02D87894E7
 for <dri-devel@lists.freedesktop.org>; Wed, 12 Jun 2019 12:55:10 +0000 (UTC)
Received: by mail-it1-x141.google.com with SMTP id n189so10356515itd.0
 for <dri-devel@lists.freedesktop.org>; Wed, 12 Jun 2019 05:55:10 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=sLySJ9mdTc+O9A27hZWYKx33SuWurK52W5zQYBeiVqI=;
 b=C9Xdkn8ne8tceYVifw3YZI1xtC73cnTITZTiXzIpczRsYHcxIE5SUh8jhn1uySo9pg
 fLCDAxb0EVC5nIJQRgVBVex9zUsIuYa5fZhY9zgcWKQ3Al50cZUXtzqL7gxvlYwodSus
 Xd4CjqDVyxPm4DuOvoGMWdPrgR9fGIgdv3UTMLbTtBzurmh+RPe7zUlp33jeptUVnEOz
 /LT16xQiP/TpZv//8rk5UjBXCFmyyUQ/xtzNQ4xFEqQX4u5Ni6+tLKzfix/ed6j2Nbf4
 vGDvPfjkhwyFHP7q7UtGEN+86rwzlzfu+DD7sg6v1EM65hu/l9YaKA1jJRoJfI95EwHj
 dCEg==
X-Gm-Message-State: APjAAAW2IJgjWslchh2elhYDe3xKMTDlAq8O8a1GrmLPZ5k7jx9Nyh04
 6sygFCyVgvBGBnEKVvT8Fuzf7MxLFjU=
X-Google-Smtp-Source: APXvYqzd+FbY35Svy5y6c6ja7inzHhgy4DzkqtppWcw2jiDLDcRN2mv8kX2Ed2m1OUrTeK711E35OQ==
X-Received: by 2002:a02:b10b:: with SMTP id r11mr50547956jah.140.1560344110111; 
 Wed, 12 Jun 2019 05:55:10 -0700 (PDT)
Received: from mail-io1-f44.google.com (mail-io1-f44.google.com.
 [209.85.166.44])
 by smtp.gmail.com with ESMTPSA id b188sm1188965itc.19.2019.06.12.05.55.09
 for <dri-devel@lists.freedesktop.org>
 (version=TLS1_3 cipher=AEAD-AES128-GCM-SHA256 bits=128/128);
 Wed, 12 Jun 2019 05:55:09 -0700 (PDT)
Received: by mail-io1-f44.google.com with SMTP id u13so12857110iop.0
 for <dri-devel@lists.freedesktop.org>; Wed, 12 Jun 2019 05:55:09 -0700 (PDT)
X-Received: by 2002:a6b:6b0d:: with SMTP id g13mr3195065ioc.55.1560344108753; 
 Wed, 12 Jun 2019 05:55:08 -0700 (PDT)
MIME-Version: 1.0
References: <20190610170440.28525-1-robh@kernel.org>
In-Reply-To: <20190610170440.28525-1-robh@kernel.org>
From: Tomeu Vizoso <tomeu@tomeuvizoso.net>
Date: Wed, 12 Jun 2019 14:54:56 +0200
X-Gmail-Original-Message-ID: <CAAObsKAvmtHSja+-XW5aWHiBNiKdanjN1OHKZTpx1O9v__E_Dw@mail.gmail.com>
Message-ID: <CAAObsKAvmtHSja+-XW5aWHiBNiKdanjN1OHKZTpx1O9v__E_Dw@mail.gmail.com>
Subject: Re: [RFC PATCH] drm/panfrost: Add support for mapping BOs on GPU page
 faults
To: Rob Herring <robh@kernel.org>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=tomeuvizoso-net.20150623.gappssmtp.com; s=20150623;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=sLySJ9mdTc+O9A27hZWYKx33SuWurK52W5zQYBeiVqI=;
 b=eJoBAHYv8TMyCnGtj/p0xGJPDAlVRoSOOci+RQ+J6RyQ6onyd3v90YY8AgHaRZ4Uq4
 jhbMSKwpIa1pHM7cWDLfY2H8pS3vQIT9WhQ2kB9IWpoWH9xUmeBfzkg9ppt7Qme5XdaH
 H6SClmZo1xdgD57rrO8lag1U+g7fWH9fWf5Do1SS5E+/5REmxZ5jqEY8UUk6pY+0IeiD
 01Iopj4HB4/+34IP+xeSwMfuci/EGE2MhXuq2YzU5XJfDV+8+oRS2Kk4hP7L+q2X1BEh
 ikgTE24zl+nnRXnFNIjXqJbTOdYgqnEYf2zYcCvrFbdX2YK234+dsDMoa2v0WZhEsUdy
 h/3w==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Boris Brezillon <boris.brezillon@collabora.com>,
 Robin Murphy <robin.murphy@arm.com>, Alyssa Rosenzweig <alyssa@rosenzweig.io>,
 dri-devel <dri-devel@lists.freedesktop.org>,
 Steven Price <steven.price@arm.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gTW9uLCAxMCBKdW4gMjAxOSBhdCAxOTowNiwgUm9iIEhlcnJpbmcgPHJvYmhAa2VybmVsLm9y
Zz4gd3JvdGU6Cj4KPiBUaGUgbWlkZ2FyZC9iaWZyb3N0IEdQVXMgbmVlZCB0byBhbGxvY2F0ZSBH
UFUgbWVtb3J5IHdoaWNoIGlzIGFsbG9jYXRlZAo+IG9uIEdQVSBwYWdlIGZhdWx0cyBhbmQgbm90
IHBpbm5lZCBpbiBtZW1vcnkuIFRoZSB2ZW5kb3IgZHJpdmVyIGNhbGxzCj4gdGhpcyBmdW5jdGlv
bmFsaXR5IEdST1dfT05fR1BGLgo+Cj4gVGhpcyBpbXBsZW1lbnRhdGlvbiBhc3N1bWVzIHRoYXQg
Qk9zIGFsbG9jYXRlZCB3aXRoIHRoZQo+IFBBTkZST1NUX0JPX05PTUFQIGZsYWcgYXJlIG5ldmVy
IG1tYXBwZWQgb3IgZXhwb3J0ZWQuIEJvdGggb2YgdGhvc2UgbWF5Cj4gYWN0dWFsbHkgd29yaywg
YnV0IEknbSB1bnN1cmUgaWYgdGhlcmUncyBzb21lIGludGVyYWN0aW9uIHRoZXJlLiBJdAo+IHdv
dWxkIGNhdXNlIHRoZSB3aG9sZSBvYmplY3QgdG8gYmUgcGlubmVkIGluIG1lbW9yeSB3aGljaCB3
b3VsZCBkZWZlYXQKPiB0aGUgcG9pbnQgb2YgdGhpcy4KPgo+IElzc3Vlcy9xdWVzdGlvbnMvdGhv
dWdodHM6Cj4KPiBXaGF0J3MgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiBpX21hcHBpbmcgYW5kIGZf
bWFwcGluZz8KPgo+IFdoYXQga2luZCBvZiBjbGVhbi11cCBvbiBjbG9zZSBpcyBuZWVkZWQ/IEJh
c2VkIG9uIHZnZW0gZmF1bHRzLCB0aGVyZQo+IGRvZXNuJ3Qgc2VlbSB0byBiZSBhbnkgcmVmY291
bnRpbmcuIEFzc3VtZSB1c2Vyc3BhY2UgaXMgcmVzcG9uc2libGUgZm9yCj4gbm90IGZyZWVpbmcg
dGhlIEJPIHdoaWxlIGEgcGFnZSBmYXVsdCBjYW4gb2NjdXI/CgpBcmVuJ3Qgd2UgdGFraW5nIGEg
cmVmZXJlbmNlIG9uIGFsbCBCT3MgdGhhdCBhIGpvYiByZWxhdGVzIHRvIGFuZAp1bnJlZmVyZW5j
aW5nIHRoZW0gb25jZSB0aGUgam9iIGlzIGRvbmU/IEkgd291bGQgdGhpbmsgdGhhdCB0aGF0J3MK
ZW5vdWdoLCBvciBhbSBJIG1pc3Npbmcgc29tZXRoaW5nPwoKPiBXaGF0IGFib3V0IGV2aWN0aW9u
cz8gTmVlZCB0byBjYWxsIG1hcHBpbmdfc2V0X3VuZXZpY3RhYmxlKCk/IE1heWJlIHdlCj4gd2Fu
dCB0aGVzZSBwYWdlcyB0byBiZSBzd2FwcGFibGUsIGJ1dCB0aGVuIHdlIG5lZWQgc29tZSBub3Rp
ZmljYXRpb24gdG8KPiB1bm1hcCB0aGVtLgoKSSdtIG5vdCBzdXJlIHRoZXJlJ3MgbXVjaCBwb2lu
dCBpbiBzd2FwcGluZyBvdXQgcGFnZXMgd2l0aCBsaWZldGltZXMKb2YgYSBmZXcgbWlsbGlzZWNv
bmRzLgoKPiBObyBuZWVkIGZvciBydW50aW1lIFBNLCBiZWNhdXNlIGZhdWx0cyBzaG91bGQgb25s
eSBvY2N1ciBkdXJpbmcgam9iCj4gc3VibWl0PwoKTWFrZXMgc2Vuc2UgdG8gbWUuCgo+IE5lZWQg
dG8gZmF1bHQgaW4gMk1CIHNlY3Rpb25zIHdoZW4gcG9zc2libGUuIEl0IHNlZW1zIHRoaXMgaGFz
IHRvIGJlCj4gZG9uZSBieSBnZXR0aW5nIGFuIGFycmF5IG9mIHN0cnVjdCBwYWdlcyBhbmQgdGhl
biBjb252ZXJ0aW5nIHRvIGEKPiBzY2F0dGVybGlzdC4gTm90IHN1cmUgaWYgdGhlcmUgaXMgYSBi
ZXR0ZXIgd2F5IHRvIGRvIHRoYXQuIFRoZXJlJ3MgYWxzbwo+IHNvbWUgZXJyYXRhIG9uIFQ2MDQg
bmVlZGluZyB0byBmYXVsdCBpbiBhdCBsZWFzdCA4IHBhZ2VzIGF0IGEgdGltZSB3aGljaAo+IGlz
bid0IGhhbmRsZWQuCgpUaGUgb2xkIEdQVXMgd2lsbCBiZSB0aGUgbW9zdCBpbnRlcmVzdGluZyB0
byBzdXBwb3J0Li4uCgpXaWxsIGdpdmUgdGhpcyBwYXRjaCBzb21lIHRlc3RpbmcgdG9tb3Jyb3cu
CgpUaGFua3MsCgpUb21ldQoKPiBDYzogUm9iaW4gTXVycGh5IDxyb2Jpbi5tdXJwaHlAYXJtLmNv
bT4KPiBDYzogU3RldmVuIFByaWNlIDxzdGV2ZW4ucHJpY2VAYXJtLmNvbT4KPiBDYzogQWx5c3Nh
IFJvc2VuendlaWcgPGFseXNzYUByb3Nlbnp3ZWlnLmlvPgo+IENjOiBUb21ldSBWaXpvc28gPHRv
bWV1QHRvbWV1dml6b3NvLm5ldD4KPiBTaWduZWQtb2ZmLWJ5OiBSb2IgSGVycmluZyA8cm9iaEBr
ZXJuZWwub3JnPgo+IC0tLQo+Cj4gIGRyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9UT0RPICAgICAg
ICAgICB8ICAyIC0KPiAgZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2Rydi5jIHwg
MjIgKysrKystLQo+ICBkcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZ2VtLmMgfCAg
MyArLQo+ICBkcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZ2VtLmggfCAgOCArKysK
PiAgZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X21tdS5jIHwgNzYgKysrKysrKysr
KysrKysrKysrKysrKystLQo+ICBpbmNsdWRlL3VhcGkvZHJtL3BhbmZyb3N0X2RybS5oICAgICAg
ICAgfCAgMiArCj4gIDYgZmlsZXMgY2hhbmdlZCwgMTAwIGluc2VydGlvbnMoKyksIDEzIGRlbGV0
aW9ucygtKQo+Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9UT0RPIGIv
ZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L1RPRE8KPiBpbmRleCBjMmU0NGFkZDM3ZDguLjY0MTI5
YmY3MzkzMyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvVE9ETwo+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9UT0RPCj4gQEAgLTE0LDggKzE0LDYgQEAKPiAg
ICBUaGUgaGFyZCBwYXJ0IGlzIGhhbmRsaW5nIHdoZW4gbW9yZSBhZGRyZXNzIHNwYWNlcyBhcmUg
bmVlZGVkIHRoYW4gd2hhdAo+ICAgIHRoZSBoL3cgcHJvdmlkZXMuCj4KPiAtLSBTdXBwb3J0IHBp
bm5pbmcgcGFnZXMgb24gZGVtYW5kIChHUFUgcGFnZSBmYXVsdHMpLgo+IC0KPiAgLSBTdXBwb3J0
IHVzZXJzcGFjZSBjb250cm9sbGVkIEdQVSB2aXJ0dWFsIGFkZHJlc3Nlcy4gTmVlZGVkIGZvciBW
dWxrYW4uIChUb21ldSkKPgo+ICAtIFN1cHBvcnQgZm9yIG1hZHZpc2UgYW5kIGEgc2hyaW5rZXIu
Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9kcnYuYyBi
L2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9kcnYuYwo+IGluZGV4IGQxMWUyMjgx
ZGRlNi4uZjA4ZDQxZDUxODZhIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9z
dC9wYW5mcm9zdF9kcnYuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9z
dF9kcnYuYwo+IEBAIC00NCw5ICs0NCwxMSBAQCBzdGF0aWMgaW50IHBhbmZyb3N0X2lvY3RsX2Ny
ZWF0ZV9ibyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ICB7Cj4gICAgICAg
ICBpbnQgcmV0Owo+ICAgICAgICAgc3RydWN0IGRybV9nZW1fc2htZW1fb2JqZWN0ICpzaG1lbTsK
PiArICAgICAgIHN0cnVjdCBwYW5mcm9zdF9nZW1fb2JqZWN0ICpibzsKPiAgICAgICAgIHN0cnVj
dCBkcm1fcGFuZnJvc3RfY3JlYXRlX2JvICphcmdzID0gZGF0YTsKPgo+IC0gICAgICAgaWYgKCFh
cmdzLT5zaXplIHx8IGFyZ3MtPmZsYWdzIHx8IGFyZ3MtPnBhZCkKPiArICAgICAgIGlmICghYXJn
cy0+c2l6ZSB8fCBhcmdzLT5wYWQgfHwKPiArICAgICAgICAgICAoYXJncy0+ZmxhZ3MgJiB+UEFO
RlJPU1RfQk9fTk9NQVApKQo+ICAgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKPgo+ICAg
ICAgICAgc2htZW0gPSBkcm1fZ2VtX3NobWVtX2NyZWF0ZV93aXRoX2hhbmRsZShmaWxlLCBkZXYs
IGFyZ3MtPnNpemUsCj4gQEAgLTU0LDExICs1NiwxNiBAQCBzdGF0aWMgaW50IHBhbmZyb3N0X2lv
Y3RsX2NyZWF0ZV9ibyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ICAgICAg
ICAgaWYgKElTX0VSUihzaG1lbSkpCj4gICAgICAgICAgICAgICAgIHJldHVybiBQVFJfRVJSKHNo
bWVtKTsKPgo+IC0gICAgICAgcmV0ID0gcGFuZnJvc3RfbW11X21hcCh0b19wYW5mcm9zdF9ibygm
c2htZW0tPmJhc2UpKTsKPiAtICAgICAgIGlmIChyZXQpCj4gLSAgICAgICAgICAgICAgIGdvdG8g
ZXJyX2ZyZWU7Cj4gKyAgICAgICBibyA9IHRvX3BhbmZyb3N0X2JvKCZzaG1lbS0+YmFzZSk7Cj4K
PiAtICAgICAgIGFyZ3MtPm9mZnNldCA9IHRvX3BhbmZyb3N0X2JvKCZzaG1lbS0+YmFzZSktPm5v
ZGUuc3RhcnQgPDwgUEFHRV9TSElGVDsKPiArICAgICAgIGlmICghKGFyZ3MtPmZsYWdzICYgUEFO
RlJPU1RfQk9fTk9NQVApKSB7Cj4gKyAgICAgICAgICAgICAgIHJldCA9IHBhbmZyb3N0X21tdV9t
YXAoYm8pOwo+ICsgICAgICAgICAgICAgICBpZiAocmV0KQo+ICsgICAgICAgICAgICAgICAgICAg
ICAgIGdvdG8gZXJyX2ZyZWU7Cj4gKyAgICAgICB9IGVsc2UKPiArICAgICAgICAgICAgICAgYm8t
Pm5vX21hcCA9IDE7Cj4gKwo+ICsgICAgICAgYXJncy0+b2Zmc2V0ID0gYm8tPm5vZGUuc3RhcnQg
PDwgUEFHRV9TSElGVDsKPgo+ICAgICAgICAgcmV0dXJuIDA7Cj4KPiBAQCAtMjY5LDYgKzI3Niwx
MSBAQCBzdGF0aWMgaW50IHBhbmZyb3N0X2lvY3RsX21tYXBfYm8oc3RydWN0IGRybV9kZXZpY2Ug
KmRldiwgdm9pZCAqZGF0YSwKPiAgICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9FTlQ7Cj4gICAg
ICAgICB9Cj4KPiArICAgICAgIGlmICh0b19wYW5mcm9zdF9ibyhnZW1fb2JqKS0+bm9fbWFwKSB7
Cj4gKyAgICAgICAgICAgICAgIERSTV9ERUJVRygiQ2FuJ3QgbW1hcCAnbm9fbWFwJyBHRU0gQk8g
JWRcbiIsIGFyZ3MtPmhhbmRsZSk7Cj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwo+
ICsgICAgICAgfQo+ICsKPiAgICAgICAgIHJldCA9IGRybV9nZW1fY3JlYXRlX21tYXBfb2Zmc2V0
KGdlbV9vYmopOwo+ICAgICAgICAgaWYgKHJldCA9PSAwKQo+ICAgICAgICAgICAgICAgICBhcmdz
LT5vZmZzZXQgPSBkcm1fdm1hX25vZGVfb2Zmc2V0X2FkZHIoJmdlbV9vYmotPnZtYV9ub2RlKTsK
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2dlbS5jIGIv
ZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2dlbS5jCj4gaW5kZXggODg2ODc1YWUz
MWQzLi5lZDBiNGY3OTYxMGEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0
L3BhbmZyb3N0X2dlbS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0
X2dlbS5jCj4gQEAgLTE5LDcgKzE5LDggQEAgc3RhdGljIHZvaWQgcGFuZnJvc3RfZ2VtX2ZyZWVf
b2JqZWN0KHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqKQo+ICAgICAgICAgc3RydWN0IHBhbmZy
b3N0X2dlbV9vYmplY3QgKmJvID0gdG9fcGFuZnJvc3RfYm8ob2JqKTsKPiAgICAgICAgIHN0cnVj
dCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2ID0gb2JqLT5kZXYtPmRldl9wcml2YXRlOwo+Cj4gLSAg
ICAgICBwYW5mcm9zdF9tbXVfdW5tYXAoYm8pOwo+ICsgICAgICAgaWYgKCFiby0+bm9fbWFwKQo+
ICsgICAgICAgICAgICAgICBwYW5mcm9zdF9tbXVfdW5tYXAoYm8pOwo+Cj4gICAgICAgICBzcGlu
X2xvY2soJnBmZGV2LT5tbV9sb2NrKTsKPiAgICAgICAgIGRybV9tbV9yZW1vdmVfbm9kZSgmYm8t
Pm5vZGUpOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3Rf
Z2VtLmggYi9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZ2VtLmgKPiBpbmRleCAw
NDUwMDBlYjVmY2YuLmFhMjEwZDdjYmYzZiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0v
cGFuZnJvc3QvcGFuZnJvc3RfZ2VtLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3Qv
cGFuZnJvc3RfZ2VtLmgKPiBAQCAtMTEsNiArMTEsNyBAQCBzdHJ1Y3QgcGFuZnJvc3RfZ2VtX29i
amVjdCB7Cj4gICAgICAgICBzdHJ1Y3QgZHJtX2dlbV9zaG1lbV9vYmplY3QgYmFzZTsKPgo+ICAg
ICAgICAgc3RydWN0IGRybV9tbV9ub2RlIG5vZGU7Cj4gKyAgICAgICB1bnNpZ25lZCBub19tYXA6
IDE7Cj4gIH07Cj4KPiAgc3RhdGljIGlubGluZQo+IEBAIC0xOSw2ICsyMCwxMyBAQCBzdHJ1Y3Qg
IHBhbmZyb3N0X2dlbV9vYmplY3QgKnRvX3BhbmZyb3N0X2JvKHN0cnVjdCBkcm1fZ2VtX29iamVj
dCAqb2JqKQo+ICAgICAgICAgcmV0dXJuIGNvbnRhaW5lcl9vZih0b19kcm1fZ2VtX3NobWVtX29i
aihvYmopLCBzdHJ1Y3QgcGFuZnJvc3RfZ2VtX29iamVjdCwgYmFzZSk7Cj4gIH0KPgo+ICtzdGF0
aWMgaW5saW5lCj4gK3N0cnVjdCAgcGFuZnJvc3RfZ2VtX29iamVjdCAqZHJtX21tX25vZGVfdG9f
cGFuZnJvc3RfYm8oc3RydWN0IGRybV9tbV9ub2RlICpub2RlKQo+ICt7Cj4gKyAgICAgICByZXR1
cm4gY29udGFpbmVyX29mKG5vZGUsIHN0cnVjdCBwYW5mcm9zdF9nZW1fb2JqZWN0LCBub2RlKTsK
PiArfQo+ICsKPiArCj4gIHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqcGFuZnJvc3RfZ2VtX2NyZWF0
ZV9vYmplY3Qoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgc2l6ZV90IHNpemUpOwo+Cj4gIHN0cnVj
dCBkcm1fZ2VtX29iamVjdCAqCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9z
dC9wYW5mcm9zdF9tbXUuYyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9tbXUu
Ywo+IGluZGV4IDQxZDE4NGZhYjA3Zi4uNWEzNjQ5NWEzOGYzIDEwMDY0NAo+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9tbXUuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9wYW5mcm9zdC9wYW5mcm9zdF9tbXUuYwo+IEBAIC0zLDYgKzMsNyBAQAo+ICAvKiBDb3B5cmln
aHQgKEMpIDIwMTkgQXJtIEx0ZC4gKi8KPiAgI2luY2x1ZGUgPGxpbnV4L2JpdGZpZWxkLmg+Cj4g
ICNpbmNsdWRlIDxsaW51eC9kZWxheS5oPgo+ICsjaW5jbHVkZSA8bGludXgvZG1hLW1hcHBpbmcu
aD4KPiAgI2luY2x1ZGUgPGxpbnV4L2ludGVycnVwdC5oPgo+ICAjaW5jbHVkZSA8bGludXgvaW8u
aD4KPiAgI2luY2x1ZGUgPGxpbnV4L2lvcG9sbC5oPgo+IEBAIC0xMCw2ICsxMSw3IEBACj4gICNp
bmNsdWRlIDxsaW51eC9pb21tdS5oPgo+ICAjaW5jbHVkZSA8bGludXgvcGxhdGZvcm1fZGV2aWNl
Lmg+Cj4gICNpbmNsdWRlIDxsaW51eC9wbV9ydW50aW1lLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9z
aG1lbV9mcy5oPgo+ICAjaW5jbHVkZSA8bGludXgvc2l6ZXMuaD4KPgo+ICAjaW5jbHVkZSAicGFu
ZnJvc3RfZGV2aWNlLmgiCj4gQEAgLTI3Nyw2ICsyNzksNjAgQEAgc3RhdGljIGNvbnN0IHN0cnVj
dCBpb21tdV9nYXRoZXJfb3BzIG1tdV90bGJfb3BzID0gewo+ICAgICAgICAgLnRsYl9zeW5jICAg
ICAgID0gbW11X3RsYl9zeW5jX2NvbnRleHQsCj4gIH07Cj4KPiArc3RhdGljIHN0cnVjdCBkcm1f
bW1fbm9kZSAqYWRkcl90b19kcm1fbW1fbm9kZShzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRl
diwgaW50IGFzLCB1NjQgYWRkcikKPiArewo+ICsgICAgICAgc3RydWN0IGRybV9tbV9ub2RlICpu
b2RlOwo+ICsgICAgICAgdTY0IG9mZnNldCA9IGFkZHIgPj4gUEFHRV9TSElGVDsKPiArCj4gKyAg
ICAgICBkcm1fbW1fZm9yX2VhY2hfbm9kZShub2RlLCAmcGZkZXYtPm1tKSB7Cj4gKyAgICAgICAg
ICAgICAgIGlmIChvZmZzZXQgPj0gbm9kZS0+c3RhcnQgJiYgb2Zmc2V0IDwgKG5vZGUtPnN0YXJ0
ICsgbm9kZS0+c2l6ZSkpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGU7Cj4g
KyAgICAgICB9Cj4gKyAgICAgICByZXR1cm4gTlVMTDsKPiArfQo+ICsKPiAraW50IHBhbmZyb3N0
X21tdV9tYXBfZmF1bHRfYWRkcihzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldiwgaW50IGFz
LCB1NjQgYWRkcikKPiArewo+ICsgICAgICAgc3RydWN0IHBhZ2UgKnBhZ2U7Cj4gKyAgICAgICBk
bWFfYWRkcl90IGRtYV9hZGRyOwo+ICsgICAgICAgc3RydWN0IGRybV9tbV9ub2RlICpub2RlOwo+
ICsgICAgICAgc3RydWN0IHBhbmZyb3N0X2dlbV9vYmplY3QgKmJvOwo+ICsgICAgICAgc3RydWN0
IGlvX3BndGFibGVfb3BzICpvcHMgPSBwZmRldi0+bW11LT5wZ3RibF9vcHM7Cj4gKyAgICAgICBw
Z29mZl90IHBhZ2Vfb2Zmc2V0ID0gYWRkciA+PiBQQUdFX1NISUZUOwo+ICsKPiArICAgICAgIGFk
ZHIgJj0gUEFHRV9NQVNLOwo+ICsKPiArICAgICAgIG5vZGUgPSBhZGRyX3RvX2RybV9tbV9ub2Rl
KHBmZGV2LCBhcywgYWRkcik7Cj4gKyAgICAgICBpZiAoIW5vZGUpCj4gKyAgICAgICAgICAgICAg
IHJldHVybiAtRU5PRU5UOwo+ICsKPiArICAgICAgIHBhZ2Vfb2Zmc2V0IC09IG5vZGUtPnN0YXJ0
Owo+ICsgICAgICAgYm8gPSBkcm1fbW1fbm9kZV90b19wYW5mcm9zdF9ibyhub2RlKTsKPiArICAg
ICAgIGlmIChXQVJOX09OKCFiby0+bm9fbWFwKSkKPiArICAgICAgICAgICAgICAgcmV0dXJuIC1F
SU5WQUw7Cj4gKwo+ICsgICAgICAgZGV2X2luZm8ocGZkZXYtPmRldiwgIm1hcHBpbmcgcGFnZSBm
YXVsdCBAICVsbHgiLCBhZGRyKTsKPiArCj4gKyAgICAgICBwYWdlID0gc2htZW1fcmVhZF9tYXBw
aW5nX3BhZ2UoYm8tPmJhc2UuYmFzZS5maWxwLT5mX21hcHBpbmcsCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgcGFnZV9vZmZzZXQpOwo+ICsgICAgICAgaWYgKElTX0VS
UihwYWdlKSkKPiArICAgICAgICAgICAgICAgcmV0dXJuIFBUUl9FUlIocGFnZSk7Cj4gKwo+ICsg
ICAgICAgZG1hX2FkZHIgPSBkbWFfbWFwX3BhZ2UocGZkZXYtPmRldiwgcGFnZSwgMCwgUEFHRV9T
SVpFLCBETUFfQklESVJFQ1RJT05BTCk7Cj4gKwo+ICsgICAgICAgbXV0ZXhfbG9jaygmcGZkZXYt
Pm1tdS0+bG9jayk7Cj4gKwo+ICsgICAgICAgb3BzLT5tYXAob3BzLCBhZGRyLCBkbWFfYWRkciwg
UEFHRV9TSVpFLCBJT01NVV9XUklURSB8IElPTU1VX1JFQUQpOwo+ICsKPiArICAgICAgIG1tdV93
cml0ZShwZmRldiwgTU1VX0lOVF9DTEVBUiwgQklUKGFzKSk7Cj4gKwo+ICsgICAgICAgbW11X2h3
X2RvX29wZXJhdGlvbihwZmRldiwgYXMsIGFkZHIsIFBBR0VfU0laRSwgQVNfQ09NTUFORF9GTFVT
SF9QVCk7Cj4gKwo+ICsgICAgICAgbXV0ZXhfdW5sb2NrKCZwZmRldi0+bW11LT5sb2NrKTsKPiAr
Cj4gKyAgICAgICByZXR1cm4gMDsKPiArfQo+ICsKPiAgc3RhdGljIGNvbnN0IGNoYXIgKmFjY2Vz
c190eXBlX25hbWUoc3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYsCj4gICAgICAgICAgICAg
ICAgIHUzMiBmYXVsdF9zdGF0dXMpCj4gIHsKPiBAQCAtMzAyLDEzICszNTgsMTEgQEAgc3RhdGlj
IGlycXJldHVybl90IHBhbmZyb3N0X21tdV9pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICpkYXRh
KQo+ICB7Cj4gICAgICAgICBzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldiA9IGRhdGE7Cj4g
ICAgICAgICB1MzIgc3RhdHVzID0gbW11X3JlYWQocGZkZXYsIE1NVV9JTlRfU1RBVCk7Cj4gLSAg
ICAgICBpbnQgaTsKPiArICAgICAgIGludCBpLCByZXQ7Cj4KPiAgICAgICAgIGlmICghc3RhdHVz
KQo+ICAgICAgICAgICAgICAgICByZXR1cm4gSVJRX05PTkU7Cj4KPiAtICAgICAgIGRldl9lcnIo
cGZkZXYtPmRldiwgIm1tdSBpcnEgc3RhdHVzPSV4XG4iLCBzdGF0dXMpOwo+IC0KPiAgICAgICAg
IGZvciAoaSA9IDA7IHN0YXR1czsgaSsrKSB7Cj4gICAgICAgICAgICAgICAgIHUzMiBtYXNrID0g
QklUKGkpIHwgQklUKGkgKyAxNik7Cj4gICAgICAgICAgICAgICAgIHU2NCBhZGRyOwo+IEBAIC0z
MjksNiArMzgzLDE3IEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBwYW5mcm9zdF9tbXVfaXJxX2hhbmRs
ZXIoaW50IGlycSwgdm9pZCAqZGF0YSkKPiAgICAgICAgICAgICAgICAgYWNjZXNzX3R5cGUgPSAo
ZmF1bHRfc3RhdHVzID4+IDgpICYgMHgzOwo+ICAgICAgICAgICAgICAgICBzb3VyY2VfaWQgPSAo
ZmF1bHRfc3RhdHVzID4+IDE2KTsKPgo+ICsgICAgICAgICAgICAgICAvKiBQYWdlIGZhdWx0IG9u
bHkgKi8KPiArICAgICAgICAgICAgICAgaWYgKChzdGF0dXMgJiBtYXNrKSA9PSBCSVQoaSkpIHsK
PiArICAgICAgICAgICAgICAgICAgICAgICBXQVJOX09OKGV4Y2VwdGlvbl90eXBlIDwgMHhDMSB8
fCBleGNlcHRpb25fdHlwZSA+IDB4QzQpOwo+ICsKPiArICAgICAgICAgICAgICAgICAgICAgICBy
ZXQgPSBwYW5mcm9zdF9tbXVfbWFwX2ZhdWx0X2FkZHIocGZkZXYsIGksIGFkZHIpOwo+ICsgICAg
ICAgICAgICAgICAgICAgICAgIGlmICghcmV0KSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdGF0dXMgJj0gfm1hc2s7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBjb250aW51ZTsKPiArICAgICAgICAgICAgICAgICAgICAgICB9Cj4gKyAgICAgICAgICAgICAg
IH0KPiArCj4gICAgICAgICAgICAgICAgIC8qIHRlcm1pbmFsIGZhdWx0LCBwcmludCBpbmZvIGFi
b3V0IHRoZSBmYXVsdCAqLwo+ICAgICAgICAgICAgICAgICBkZXZfZXJyKHBmZGV2LT5kZXYsCj4g
ICAgICAgICAgICAgICAgICAgICAgICAgIlVuaGFuZGxlZCBQYWdlIGZhdWx0IGluIEFTJWQgYXQg
VkEgMHglMDE2bGxYXG4iCj4gQEAgLTM3MCw4ICs0MzUsOSBAQCBpbnQgcGFuZnJvc3RfbW11X2lu
aXQoc3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYpCj4gICAgICAgICBpZiAoaXJxIDw9IDAp
Cj4gICAgICAgICAgICAgICAgIHJldHVybiAtRU5PREVWOwo+Cj4gLSAgICAgICBlcnIgPSBkZXZt
X3JlcXVlc3RfaXJxKHBmZGV2LT5kZXYsIGlycSwgcGFuZnJvc3RfbW11X2lycV9oYW5kbGVyLAo+
IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJUlFGX1NIQVJFRCwgIm1tdSIsIHBmZGV2
KTsKPiArICAgICAgIGVyciA9IGRldm1fcmVxdWVzdF90aHJlYWRlZF9pcnEocGZkZXYtPmRldiwg
aXJxLCBOVUxMLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYW5m
cm9zdF9tbXVfaXJxX2hhbmRsZXIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIElSUUZfT05FU0hPVCwgIm1tdSIsIHBmZGV2KTsKPgo+ICAgICAgICAgaWYgKGVycikg
ewo+ICAgICAgICAgICAgICAgICBkZXZfZXJyKHBmZGV2LT5kZXYsICJmYWlsZWQgdG8gcmVxdWVz
dCBtbXUgaXJxIik7Cj4gZGlmZiAtLWdpdCBhL2luY2x1ZGUvdWFwaS9kcm0vcGFuZnJvc3RfZHJt
LmggYi9pbmNsdWRlL3VhcGkvZHJtL3BhbmZyb3N0X2RybS5oCj4gaW5kZXggYTUyZTAyODNiOTBk
Li42ZDgzYmFhMGU0YzEgMTAwNjQ0Cj4gLS0tIGEvaW5jbHVkZS91YXBpL2RybS9wYW5mcm9zdF9k
cm0uaAo+ICsrKyBiL2luY2x1ZGUvdWFwaS9kcm0vcGFuZnJvc3RfZHJtLmgKPiBAQCAtNzEsNiAr
NzEsOCBAQCBzdHJ1Y3QgZHJtX3BhbmZyb3N0X3dhaXRfYm8gewo+ICAgICAgICAgX19zNjQgdGlt
ZW91dF9uczsgICAgICAgLyogYWJzb2x1dGUgKi8KPiAgfTsKPgo+ICsjZGVmaW5lIFBBTkZST1NU
X0JPX05PTUFQICAgICAgMQo+ICsKPiAgLyoqCj4gICAqIHN0cnVjdCBkcm1fcGFuZnJvc3RfY3Jl
YXRlX2JvIC0gaW9jdGwgYXJndW1lbnQgZm9yIGNyZWF0aW5nIFBhbmZyb3N0IEJPcy4KPiAgICoK
PiAtLQo+IDIuMjAuMQo+Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9w
Lm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1k
ZXZlbA==
