Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 3371F1100D1
	for <lists+dri-devel@lfdr.de>; Tue,  3 Dec 2019 16:06:21 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9C7D26E9BC;
	Tue,  3 Dec 2019 15:06:17 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from relay8-d.mail.gandi.net (relay8-d.mail.gandi.net
 [217.70.183.201])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6B0376E9B7
 for <dri-devel@lists.freedesktop.org>; Tue,  3 Dec 2019 15:06:14 +0000 (UTC)
X-Originating-IP: 90.76.211.102
Received: from localhost.localdomain (lfbn-1-2154-102.w90-76.abo.wanadoo.fr
 [90.76.211.102])
 (Authenticated sender: paul.kocialkowski@bootlin.com)
 by relay8-d.mail.gandi.net (Postfix) with ESMTPSA id C39C11BF212;
 Tue,  3 Dec 2019 15:06:11 +0000 (UTC)
From: Paul Kocialkowski <paul.kocialkowski@bootlin.com>
To: dri-devel@lists.freedesktop.org, devicetree@vger.kernel.org,
 linux-kernel@vger.kernel.org
Subject: [PATCH v4 2/3] drm: Add support for the LogiCVC display controller
Date: Tue,  3 Dec 2019 16:06:05 +0100
Message-Id: <20191203150606.317062-3-paul.kocialkowski@bootlin.com>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191203150606.317062-1-paul.kocialkowski@bootlin.com>
References: <20191203150606.317062-1-paul.kocialkowski@bootlin.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Mark Rutland <mark.rutland@arm.com>,
 Thomas Petazzoni <thomas.petazzoni@bootlin.com>,
 David Airlie <airlied@linux.ie>,
 Paul Kocialkowski <paul.kocialkowski@bootlin.com>,
 Rob Herring <robh+dt@kernel.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW50cm9kdWNlcyBhIGRyaXZlciBmb3IgdGhlIExvZ2lDVkMgZGlzcGxheSBjb250cm9sbGVyLCBh
IHByb2dyYW1tYWJsZQpsb2dpYyBjb250cm9sbGVyIG9wdGltaXplZCBmb3IgdXNlIGluIFhpbGlu
eCBaeW5xLTcwMDAgU29DcyBhbmQgb3RoZXIKWGlsaW54IEZQR0FzLiBUaGUgY29udHJvbGxlciBp
cyBtb3N0bHkgY29uZmlndXJlZCBhdCBsb2dpYyBzeW50aGVzaXMKdGltZSBzbyBvbmx5IGEgc3Vi
c2V0IG9mIGNvbmZpZ3VyYXRpb24gaXMgbGVmdCBmb3IgdGhlIGRyaXZlciB0bwpoYW5kbGUuCgpU
aGUgZm9sbG93aW5nIGZlYXR1cmVzIGFyZSBpbXBsZW1lbnRlZCBhbmQgdGVzdGVkOgotIExWRFMg
NC1iaXQgaW50ZXJmYWNlOwotIFJHQjU2NSBwaXhlbCBmb3JtYXRzOwotIE11bHRpcGxlIGxheWVy
cyBhbmQgaGFyZHdhcmUgY29tcG9zaXRpb247Ci0gTGF5ZXItd2lkZSBhbHBoYSBtb2RlOwoKVGhl
IGZvbGxvd2luZyBmZWF0dXJlcyBhcmUgaW1wbGVtZW50ZWQgYnV0IHVudGVzdGVkOgotIE90aGVy
IFJHQiBwaXhlbCBmb3JtYXRzOwotIExheWVyIGZyYW1lYnVmZmVyIGNvbmZpZ3VyYXRpb24gZm9y
IHZlcnNpb24gNDsKLSBMb3dlc3QtbGF5ZXIgdXNlZCBhcyBiYWNrZ3JvdW5kIGNvbG9yOwotIFBl
ci1waXhlbCBhbHBoYSBtb2RlLgoKVGhlIGZvbGxvd2luZyBmZWF0dXJlcyBhcmUgbm90IGltcGxl
bWVudGVkOgotIFlVViBwaXhlbCBmb3JtYXRzOwotIERWSSwgTFZEUyAzLWJpdCwgSVRVNjU2IGFu
ZCBjYW1lcmEgbGluayBpbnRlcmZhY2VzOwotIEV4dGVybmFsIHBhcmFsbGVsIGlucHV0IGZvciBs
YXllcjsKLSBDb2xvci1rZXlpbmc7Ci0gTFVULWJhc2VkIGFscGhhIG1vZGVzLgoKQWRkaXRpb25h
bCBpbXBsZW1lbnRhdGlvbi1zcGVjaWZpYyBub3RlczoKLSBQYW5lbHMgYXJlIG9ubHkgZW5hYmxl
ZCBhZnRlciB0aGUgZmlyc3QgcGFnZSBmbGlwIHRvIGF2b2lkIGZsYXNoaW5nIGEKICB3aGl0ZSBz
Y3JlZW4uCi0gRGVwdGggdXNlZCBpbiBjb250ZXh0IG9mIHRoZSBMb2dpQ1ZDIGRyaXZlciBvbmx5
IGNvdW50cyBjb2xvciBjb21wb25lbnRzCiAgdG8gbWF0Y2ggdGhlIGRlZmluaXRpb24gb2YgdGhl
IHN5bnRoZXNpcyBwYXJhbWV0ZXJzLgoKU3VwcG9ydCBpcyBpbXBsZW1lbnRlZCBmb3IgYm90aCB2
ZXJzaW9uIDMgYW5kIDQgb2YgdGhlIGNvbnRyb2xsZXIuCgpXaXRoIHZlcnNpb24gMywgZnJhbWVi
dWZmZXJzIGFyZSBzdG9yZWQgaW4gYSBkZWRpY2F0ZWQgY29udGlndW91cwptZW1vcnkgYXJlYSwg
d2l0aCBhIGJhc2UgYWRkcmVzcyBoYXJkY29kZWQgZm9yIGVhY2ggbGF5ZXIuIFRoaXMgcmVxdWly
ZXMKdXNpbmcgYSBkZWRpY2F0ZWQgQ01BIHBvb2wgcmVnaXN0ZXJlZCBhdCB0aGUgYmFzZSBhZGRy
ZXNzIGFuZCB0d2Vha2luZyBhCmZldyBvZmZzZXQtcmVsYXRlZCByZWdpc3RlcnMgdG8gdHJ5IHRv
IHVzZSBhbnkgYnVmZmVyIGFsbG9jYXRlZCBmcm9tCnRoZSBwb29sLiBUaGlzIGlzIGRvbmUgb24g
YSBiZXN0LWVmZm9ydCBiYXNpcyB0byBoYXZlIHRoZSBoYXJkd2FyZSBjb3BlCndpdGggdGhlIERS
TSBmcmFtZWJ1ZmZlciBhbGxvY2F0aW9uIG1vZGVsIGFuZCB0aGVyZSBpcyBubyBndWFyYW50ZWUK
dGhhdCBlYWNoIGJ1ZmZlciBhbGxvY2F0ZWQgYnkgR0VNIENNQSBjYW4gYmUgdXNlZCBmb3IgYW55
IGxheWVyLgpJbiBwYXJ0aWN1bGFyLCBidWZmZXJzIGFsbG9jYXRlZCBiZWxvdyB0aGUgYmFzZSBh
ZGRyZXNzIGZvciBhIGxheWVyIGFyZQpndWFyYW50ZWVkIG5vdCB0byBiZSBjb25maWd1cmFibGUg
Zm9yIHRoYXQgbGF5ZXIuIFNlZSB0aGUgaW1wbGVtZW50YXRpb24gb2YKbG9naWN2Y19sYXllcl9i
dWZmZXJfZmluZF9zZXR1cCBmb3Igc3BlY2lmaWNzLgoKVmVyc2lvbiA0IGFsbG93cyBjb25maWd1
cmluZyBlYWNoIGJ1ZmZlciBhZGRyZXNzIGRpcmVjdGx5LCB3aGljaApndWFyYW50ZWVzIHRoYXQg
YW55IGJ1ZmZlciBjYW4gYmUgY29uZmlndXJlZC4KClNpZ25lZC1vZmYtYnk6IFBhdWwgS29jaWFs
a293c2tpIDxwYXVsLmtvY2lhbGtvd3NraUBib290bGluLmNvbT4KUmV2aWV3ZWQtYnk6IE1heGlt
ZSBSaXBhcmQgPG1yaXBhcmRAa2VybmVsLm9yZz4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vS2NvbmZp
ZyAgICAgICAgICAgICAgICAgICAgIHwgICAyICsKIGRyaXZlcnMvZ3B1L2RybS9NYWtlZmlsZSAg
ICAgICAgICAgICAgICAgICAgfCAgIDEgKwogZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvS2NvbmZp
ZyAgICAgICAgICAgICB8ICAgOCArCiBkcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9NYWtlZmlsZSAg
ICAgICAgICAgIHwgICA0ICsKIGRyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfY3J0Yy5j
ICAgICAgfCAyNzEgKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2Ny
dGMuaCAgICAgIHwgIDI1ICsKIGRyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfZHJtLmMg
ICAgICAgfCA0NjcgKysrKysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dp
Y3ZjX2RybS5oICAgICAgIHwgIDYwICsrCiBkcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3Zj
X2ludGVyZmFjZS5jIHwgMjM1ICsrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dp
Y3ZjX2ludGVyZmFjZS5oIHwgIDMyICsrCiBkcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3Zj
X2xheWVyLmMgICAgIHwgNTk0ICsrKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0v
bG9naWN2Yy9sb2dpY3ZjX2xheWVyLmggICAgIHwgIDY1ICsrKwogZHJpdmVycy9ncHUvZHJtL2xv
Z2ljdmMvbG9naWN2Y19tb2RlLmMgICAgICB8IDEwMyArKysrCiBkcml2ZXJzL2dwdS9kcm0vbG9n
aWN2Yy9sb2dpY3ZjX21vZGUuaCAgICAgIHwgIDE1ICsKIGRyaXZlcnMvZ3B1L2RybS9sb2dpY3Zj
L2xvZ2ljdmNfb2YuYyAgICAgICAgfCAyMDUgKysrKysrKwogZHJpdmVycy9ncHUvZHJtL2xvZ2lj
dmMvbG9naWN2Y19vZi5oICAgICAgICB8ICAyOCArCiBkcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9s
b2dpY3ZjX3JlZ3MuaCAgICAgIHwgIDg4ICsrKwogMTcgZmlsZXMgY2hhbmdlZCwgMjIwMyBpbnNl
cnRpb25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvS2Nv
bmZpZwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL01ha2VmaWxl
CiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19jcnRj
LmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2Ny
dGMuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNf
ZHJtLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3Zj
X2RybS5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2
Y19pbnRlcmZhY2UuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9sb2dpY3Zj
L2xvZ2ljdmNfaW50ZXJmYWNlLmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0v
bG9naWN2Yy9sb2dpY3ZjX2xheWVyLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9k
cm0vbG9naWN2Yy9sb2dpY3ZjX2xheWVyLmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dw
dS9kcm0vbG9naWN2Yy9sb2dpY3ZjX21vZGUuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMv
Z3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfbW9kZS5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVy
cy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19vZi5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVy
cy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19vZi5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVy
cy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19yZWdzLmgKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vS2NvbmZpZyBiL2RyaXZlcnMvZ3B1L2RybS9LY29uZmlnCmluZGV4IDdlMDg5YzQ3YTU4
ZS4uZjEyMjQ5OWM5YzBlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vS2NvbmZpZworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vS2NvbmZpZwpAQCAtMzM2LDYgKzMzNiw4IEBAIHNvdXJjZSAiZHJp
dmVycy9ncHUvZHJtL2FyYy9LY29uZmlnIgogCiBzb3VyY2UgImRyaXZlcnMvZ3B1L2RybS9oaXNp
bGljb24vS2NvbmZpZyIKIAorc291cmNlICJkcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9LY29uZmln
IgorCiBzb3VyY2UgImRyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9LY29uZmlnIgogCiBzb3VyY2Ug
ImRyaXZlcnMvZ3B1L2RybS96dGUvS2NvbmZpZyIKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9NYWtlZmlsZQppbmRleCBkOWJjYzlmMmEwYTQu
LmY3ZGJlZGM0NzdkNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL01ha2VmaWxlCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9NYWtlZmlsZQpAQCAtMTAxLDYgKzEwMSw3IEBAIG9iai0kKENPTkZJ
R19EUk1fU1RNKSArPSBzdG0vCiBvYmotJChDT05GSUdfRFJNX1NUSSkgKz0gc3RpLwogb2JqLSQo
Q09ORklHX0RSTV9JTVgpICs9IGlteC8KIG9iai0kKENPTkZJR19EUk1fSU5HRU5JQykgKz0gaW5n
ZW5pYy8KK29iai0kKENPTkZJR19EUk1fTE9HSUNWQykgKz0gbG9naWN2Yy8KIG9iai0kKENPTkZJ
R19EUk1fTUVESUFURUspICs9IG1lZGlhdGVrLwogb2JqLSQoQ09ORklHX0RSTV9NRVNPTikJKz0g
bWVzb24vCiBvYmoteQkJCSs9IGkyYy8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb2dp
Y3ZjL0tjb25maWcgYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9LY29uZmlnCm5ldyBmaWxlIG1v
ZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMzRkYWNhYmJiNDlhCi0tLSAvZGV2L251bGwK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvS2NvbmZpZwpAQCAtMCwwICsxLDggQEAKK2Nv
bmZpZyBEUk1fTE9HSUNWQworCXRyaXN0YXRlICJMb2dpQ1ZDIERSTSIKKwlkZXBlbmRzIG9uIERS
TQorCXNlbGVjdCBEUk1fS01TX0hFTFBFUgorCXNlbGVjdCBEUk1fS01TX0NNQV9IRUxQRVIKKwlz
ZWxlY3QgRFJNX0dFTV9DTUFfSEVMUEVSCisJaGVscAorCSAgRFJNIGRpc3BsYXkgZHJpdmVyIGZv
ciB0aGUgbG9naUNWQyBwcm9ncmFtbWFibGUgbG9naWMgYmxvY2sgZnJvbSBYeWxvbgpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0v
bG9naWN2Yy9NYWtlZmlsZQpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAu
LmMwOTUzMWZiZDZhZAotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3Zj
L01ha2VmaWxlCkBAIC0wLDAgKzEsNCBAQAorbG9naWN2Yy1kcm0teSArPSBsb2dpY3ZjX2NydGMu
byBsb2dpY3ZjX2RybS5vIGxvZ2ljdmNfaW50ZXJmYWNlLm8gXAorCQkgbG9naWN2Y19sYXllci5v
IGxvZ2ljdmNfbW9kZS5vIGxvZ2ljdmNfb2YubworCitvYmotJChDT05GSUdfRFJNX0xPR0lDVkMp
ICs9IGxvZ2ljdmMtZHJtLm8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xv
Z2ljdmNfY3J0Yy5jIGIvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19jcnRjLmMKbmV3
IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4yYzA3ZjQ1OTRjMzIKLS0tIC9k
ZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2NydGMuYwpAQCAt
MCwwICsxLDI3MSBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjArCisvKgor
ICogQ29weXJpZ2h0IChDKSAyMDE5IEJvb3RsaW4KKyAqIEF1dGhvcjogUGF1bCBLb2NpYWxrb3dz
a2kgPHBhdWwua29jaWFsa293c2tpQGJvb3RsaW4uY29tPgorICovCisKKyNpbmNsdWRlIDxsaW51
eC9vZi5oPgorI2luY2x1ZGUgPGxpbnV4L29mX2dyYXBoLmg+CisjaW5jbHVkZSA8bGludXgvdHlw
ZXMuaD4KKyNpbmNsdWRlIDxsaW51eC93b3JrcXVldWUuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2F0
b21pY19oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2NydGMuaD4KKyNpbmNsdWRlIDxkcm0v
ZHJtX2Rydi5oPgorI2luY2x1ZGUgPGRybS9kcm1fZ2VtX2NtYV9oZWxwZXIuaD4KKyNpbmNsdWRl
IDxkcm0vZHJtX3ByaW50Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV92YmxhbmsuaD4KKworI2luY2x1
ZGUgImxvZ2ljdmNfY3J0Yy5oIgorI2luY2x1ZGUgImxvZ2ljdmNfZHJtLmgiCisjaW5jbHVkZSAi
bG9naWN2Y19pbnRlcmZhY2UuaCIKKyNpbmNsdWRlICJsb2dpY3ZjX2xheWVyLmgiCisjaW5jbHVk
ZSAibG9naWN2Y19yZWdzLmgiCisKKyNkZWZpbmUgbG9naWN2Y19jcnRjKGMpIFwKKwljb250YWlu
ZXJfb2YoYywgc3RydWN0IGxvZ2ljdmNfY3J0YywgZHJtX2NydGMpCisKK3N0YXRpYyBpbnQgbG9n
aWN2Y19jcnRjX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX2NydGMgKmRybV9jcnRjLAorCQkJCSAg
ICAgc3RydWN0IGRybV9jcnRjX3N0YXRlICpzdGF0ZSkKK3sKKwlzdHJ1Y3QgZHJtX2Rpc3BsYXlf
bW9kZSAqbW9kZSA9ICZzdGF0ZS0+YWRqdXN0ZWRfbW9kZTsKKworCWlmIChtb2RlLT5mbGFncyAm
IERSTV9NT0RFX0ZMQUdfSU5URVJMQUNFKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCXJldHVybiAw
OworfQorCitzdGF0aWMgdm9pZCBsb2dpY3ZjX2NydGNfYXRvbWljX2JlZ2luKHN0cnVjdCBkcm1f
Y3J0YyAqZHJtX2NydGMsCisJCQkJICAgICAgc3RydWN0IGRybV9jcnRjX3N0YXRlICpvbGRfc3Rh
dGUpCit7CisJc3RydWN0IGxvZ2ljdmNfY3J0YyAqY3J0YyA9IGxvZ2ljdmNfY3J0Yyhkcm1fY3J0
Yyk7CisJc3RydWN0IGRybV9kZXZpY2UgKmRybSA9IGRybV9jcnRjLT5kZXY7CisJdW5zaWduZWQg
bG9uZyBmbGFnczsKKworCS8qIFJlZ2lzdGVyIHBlbmRpbmcgZXZlbnQsIG9ubHkgaWYgdmJsYW5r
IGlzIGFscmVhZHkgb24uICovCisJaWYgKGRybV9jcnRjLT5zdGF0ZS0+ZXZlbnQgJiYgb2xkX3N0
YXRlLT5hY3RpdmUpIHsKKwkJc3Bpbl9sb2NrX2lycXNhdmUoJmRybS0+ZXZlbnRfbG9jaywgZmxh
Z3MpOworCQlXQVJOX09OKGRybV9jcnRjX3ZibGFua19nZXQoZHJtX2NydGMpICE9IDApOworCisJ
CWNydGMtPmV2ZW50ID0gZHJtX2NydGMtPnN0YXRlLT5ldmVudDsKKwkJZHJtX2NydGMtPnN0YXRl
LT5ldmVudCA9IE5VTEw7CisKKwkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZHJtLT5ldmVudF9s
b2NrLCBmbGFncyk7CisJfQorfQorCitzdGF0aWMgdm9pZCBsb2dpY3ZjX2NydGNfYXRvbWljX2Vu
YWJsZShzdHJ1Y3QgZHJtX2NydGMgKmRybV9jcnRjLAorCQkJCSAgICAgICBzdHJ1Y3QgZHJtX2Ny
dGNfc3RhdGUgKm9sZF9zdGF0ZSkKK3sKKwlzdHJ1Y3QgbG9naWN2Y19jcnRjICpjcnRjID0gbG9n
aWN2Y19jcnRjKGRybV9jcnRjKTsKKwlzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMgPSBjcnRj
LT5sb2dpY3ZjOworCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlID0gJmRybV9jcnRjLT5z
dGF0ZS0+YWRqdXN0ZWRfbW9kZTsKKwlzdHJ1Y3QgZHJtX2RldmljZSAqZHJtID0gZHJtX2NydGMt
PmRldjsKKwl1bnNpZ25lZCBpbnQgaGFjdCwgaGZwLCBoc2wsIGhicDsKKwl1bnNpZ25lZCBpbnQg
dmFjdCwgdmZwLCB2c2wsIHZicDsKKwl1bnNpZ25lZCBsb25nIGZsYWdzOworCXUzMiBjdHJsOwor
CisJLyogVGltaW5ncyAqLworCisJaGFjdCA9IG1vZGUtPmhkaXNwbGF5OworCWhmcCA9IG1vZGUt
PmhzeW5jX3N0YXJ0IC0gbW9kZS0+aGRpc3BsYXk7CisJaHNsID0gbW9kZS0+aHN5bmNfZW5kIC0g
bW9kZS0+aHN5bmNfc3RhcnQ7CisJaGJwID0gbW9kZS0+aHRvdGFsIC0gbW9kZS0+aHN5bmNfZW5k
OworCisJdmFjdCA9IG1vZGUtPnZkaXNwbGF5OworCXZmcCA9IG1vZGUtPnZzeW5jX3N0YXJ0IC0g
bW9kZS0+dmRpc3BsYXk7CisJdnNsID0gbW9kZS0+dnN5bmNfZW5kIC0gbW9kZS0+dnN5bmNfc3Rh
cnQ7CisJdmJwID0gbW9kZS0+dnRvdGFsIC0gbW9kZS0+dnN5bmNfZW5kOworCisJcmVnbWFwX3dy
aXRlKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNWQ19IU1lOQ19GUk9OVF9QT1JDSF9SRUcsIGhmcCAt
IDEpOworCXJlZ21hcF93cml0ZShsb2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNfSFNZTkNfUkVHLCBo
c2wgLSAxKTsKKwlyZWdtYXBfd3JpdGUobG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZDX0hTWU5DX0JB
Q0tfUE9SQ0hfUkVHLCBoYnAgLSAxKTsKKwlyZWdtYXBfd3JpdGUobG9naWN2Yy0+cmVnbWFwLCBM
T0dJQ1ZDX0hSRVNfUkVHLCBoYWN0IC0gMSk7CisKKwlyZWdtYXBfd3JpdGUobG9naWN2Yy0+cmVn
bWFwLCBMT0dJQ1ZDX1ZTWU5DX0ZST05UX1BPUkNIX1JFRywgdmZwIC0gMSk7CisJcmVnbWFwX3dy
aXRlKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNWQ19WU1lOQ19SRUcsIHZzbCAtIDEpOworCXJlZ21h
cF93cml0ZShsb2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNfVlNZTkNfQkFDS19QT1JDSF9SRUcsIHZi
cCAtIDEpOworCXJlZ21hcF93cml0ZShsb2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNfVlJFU19SRUcs
IHZhY3QgLSAxKTsKKworCS8qIFNpZ25hbHMgKi8KKworCWN0cmwgPSBMT0dJQ1ZDX0NUUkxfSFNZ
TkNfRU5BQkxFIHwgTE9HSUNWQ19DVFJMX1ZTWU5DX0VOQUJMRSB8CisJICAgICAgIExPR0lDVkNf
Q1RSTF9ERV9FTkFCTEU7CisKKwlpZiAobW9kZS0+ZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX05IU1lO
QykKKwkJY3RybCB8PSBMT0dJQ1ZDX0NUUkxfSFNZTkNfSU5WRVJUOworCisJaWYgKG1vZGUtPmZs
YWdzICYgRFJNX01PREVfRkxBR19OVlNZTkMpCisJCWN0cmwgfD0gTE9HSUNWQ19DVFJMX1ZTWU5D
X0lOVkVSVDsKKworCWlmIChsb2dpY3ZjLT5pbnRlcmZhY2UpIHsKKwkJc3RydWN0IGRybV9jb25u
ZWN0b3IgKmNvbm5lY3RvciA9CisJCQkmbG9naWN2Yy0+aW50ZXJmYWNlLT5kcm1fY29ubmVjdG9y
OworCQlzdHJ1Y3QgZHJtX2Rpc3BsYXlfaW5mbyAqZGlzcGxheV9pbmZvID0KKwkJCSZjb25uZWN0
b3ItPmRpc3BsYXlfaW5mbzsKKworCQlpZiAoZGlzcGxheV9pbmZvLT5idXNfZmxhZ3MgJiBEUk1f
QlVTX0ZMQUdfREVfTE9XKQorCQkJY3RybCB8PSBMT0dJQ1ZDX0NUUkxfREVfSU5WRVJUOworCisJ
CWlmIChkaXNwbGF5X2luZm8tPmJ1c19mbGFncyAmIERSTV9CVVNfRkxBR19QSVhEQVRBX05FR0VE
R0UpCisJCQljdHJsIHw9IExPR0lDVkNfQ1RSTF9DTE9DS19JTlZFUlQ7CisJfQorCisJcmVnbWFw
X3VwZGF0ZV9iaXRzKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNWQ19DVFJMX1JFRywKKwkJCSAgIExP
R0lDVkNfQ1RSTF9IU1lOQ19FTkFCTEUgfAorCQkJICAgTE9HSUNWQ19DVFJMX0hTWU5DX0lOVkVS
VCB8CisJCQkgICBMT0dJQ1ZDX0NUUkxfVlNZTkNfRU5BQkxFIHwKKwkJCSAgIExPR0lDVkNfQ1RS
TF9WU1lOQ19JTlZFUlQgfAorCQkJICAgTE9HSUNWQ19DVFJMX0RFX0VOQUJMRSB8CisJCQkgICBM
T0dJQ1ZDX0NUUkxfREVfSU5WRVJUIHwKKwkJCSAgIExPR0lDVkNfQ1RSTF9QSVhFTF9JTlZFUlQg
fAorCQkJICAgTE9HSUNWQ19DVFJMX0NMT0NLX0lOVkVSVCwgY3RybCk7CisKKwkvKiBHZW5lcmF0
ZSBpbnRlcm5hbCBzdGF0ZSByZXNldC4gKi8KKwlyZWdtYXBfd3JpdGUobG9naWN2Yy0+cmVnbWFw
LCBMT0dJQ1ZDX0RUWVBFX1JFRywgMCk7CisKKwlkcm1fY3J0Y192Ymxhbmtfb24oZHJtX2NydGMp
OworCisJLyogUmVnaXN0ZXIgb3VyIGV2ZW50IGFmdGVyIHZibGFuayBpcyBlbmFibGVkLiAqLwor
CWlmIChkcm1fY3J0Yy0+c3RhdGUtPmV2ZW50ICYmICFvbGRfc3RhdGUtPmFjdGl2ZSkgeworCQlz
cGluX2xvY2tfaXJxc2F2ZSgmZHJtLT5ldmVudF9sb2NrLCBmbGFncyk7CisJCVdBUk5fT04oZHJt
X2NydGNfdmJsYW5rX2dldChkcm1fY3J0YykgIT0gMCk7CisKKwkJY3J0Yy0+ZXZlbnQgPSBkcm1f
Y3J0Yy0+c3RhdGUtPmV2ZW50OworCQlkcm1fY3J0Yy0+c3RhdGUtPmV2ZW50ID0gTlVMTDsKKwkJ
c3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZHJtLT5ldmVudF9sb2NrLCBmbGFncyk7CisJfQorfQor
CitzdGF0aWMgdm9pZCBsb2dpY3ZjX2NydGNfYXRvbWljX2Rpc2FibGUoc3RydWN0IGRybV9jcnRj
ICpkcm1fY3J0YywKKwkJCQkJc3RydWN0IGRybV9jcnRjX3N0YXRlICpvbGRfc3RhdGUpCit7CisJ
c3RydWN0IGxvZ2ljdmNfY3J0YyAqY3J0YyA9IGxvZ2ljdmNfY3J0Yyhkcm1fY3J0Yyk7CisJc3Ry
dWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjID0gY3J0Yy0+bG9naWN2YzsKKworCWRybV9jcnRjX3Zi
bGFua19vZmYoZHJtX2NydGMpOworCisJLyogRGlzYWJsZSBhbmQgY2xlYXIgQ1JUQyBiaXRzLiAq
LworCXJlZ21hcF91cGRhdGVfYml0cyhsb2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNfQ1RSTF9SRUcs
CisJCQkgICBMT0dJQ1ZDX0NUUkxfSFNZTkNfRU5BQkxFIHwKKwkJCSAgIExPR0lDVkNfQ1RSTF9I
U1lOQ19JTlZFUlQgfAorCQkJICAgTE9HSUNWQ19DVFJMX1ZTWU5DX0VOQUJMRSB8CisJCQkgICBM
T0dJQ1ZDX0NUUkxfVlNZTkNfSU5WRVJUIHwKKwkJCSAgIExPR0lDVkNfQ1RSTF9ERV9FTkFCTEUg
fAorCQkJICAgTE9HSUNWQ19DVFJMX0RFX0lOVkVSVCB8CisJCQkgICBMT0dJQ1ZDX0NUUkxfUElY
RUxfSU5WRVJUIHwKKwkJCSAgIExPR0lDVkNfQ1RSTF9DTE9DS19JTlZFUlQsIDApOworCisJLyog
R2VuZXJhdGUgaW50ZXJuYWwgc3RhdGUgcmVzZXQuICovCisJcmVnbWFwX3dyaXRlKGxvZ2ljdmMt
PnJlZ21hcCwgTE9HSUNWQ19EVFlQRV9SRUcsIDApOworCisJLyogQ29uc3VtZSBsZWZ0b3ZlciBl
dmVudCBzaW5jZSB2YmxhbmsgaXMgbm93IGRpc2FibGVkLiAqLworCWlmIChkcm1fY3J0Yy0+c3Rh
dGUtPmV2ZW50ICYmICFkcm1fY3J0Yy0+c3RhdGUtPmFjdGl2ZSkgeworCQlzcGluX2xvY2tfaXJx
KCZkcm1fY3J0Yy0+ZGV2LT5ldmVudF9sb2NrKTsKKworCQlkcm1fY3J0Y19zZW5kX3ZibGFua19l
dmVudChkcm1fY3J0YywgZHJtX2NydGMtPnN0YXRlLT5ldmVudCk7CisJCWRybV9jcnRjLT5zdGF0
ZS0+ZXZlbnQgPSBOVUxMOworCQlzcGluX3VubG9ja19pcnEoJmRybV9jcnRjLT5kZXYtPmV2ZW50
X2xvY2spOworCX0KK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY3J0Y19oZWxwZXJfZnVu
Y3MgbG9naWN2Y19jcnRjX2hlbHBlcl9mdW5jcyA9IHsKKwkuYXRvbWljX2NoZWNrCQk9IGxvZ2lj
dmNfY3J0Y19hdG9taWNfY2hlY2ssCisJLmF0b21pY19iZWdpbgkJPSBsb2dpY3ZjX2NydGNfYXRv
bWljX2JlZ2luLAorCS5hdG9taWNfZW5hYmxlCQk9IGxvZ2ljdmNfY3J0Y19hdG9taWNfZW5hYmxl
LAorCS5hdG9taWNfZGlzYWJsZQkJPSBsb2dpY3ZjX2NydGNfYXRvbWljX2Rpc2FibGUsCit9Owor
CitzdGF0aWMgaW50IGxvZ2ljdmNfY3J0Y19lbmFibGVfdmJsYW5rKHN0cnVjdCBkcm1fY3J0YyAq
ZHJtX2NydGMpCit7CisJc3RydWN0IGxvZ2ljdmNfY3J0YyAqY3J0YyA9IGxvZ2ljdmNfY3J0Yyhk
cm1fY3J0Yyk7CisJc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjID0gY3J0Yy0+bG9naWN2YzsK
KworCS8qIENsZWFyIGFueSBwZW5kaW5nIFZfU1lOQyBpbnRlcnJ1cHQuICovCisJcmVnbWFwX3dy
aXRlX2JpdHMobG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZDX0lOVF9TVEFUX1JFRywKKwkJCSAgTE9H
SUNWQ19JTlRfU1RBVF9WX1NZTkMsIExPR0lDVkNfSU5UX1NUQVRfVl9TWU5DKTsKKworCS8qIFVu
bWFzayBWX1NZTkMgaW50ZXJydXB0LiAqLworCXJlZ21hcF93cml0ZV9iaXRzKGxvZ2ljdmMtPnJl
Z21hcCwgTE9HSUNWQ19JTlRfTUFTS19SRUcsCisJCQkgIExPR0lDVkNfSU5UX01BU0tfVl9TWU5D
LCAwKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBsb2dpY3ZjX2NydGNfZGlzYWJs
ZV92Ymxhbmsoc3RydWN0IGRybV9jcnRjICpkcm1fY3J0YykKK3sKKwlzdHJ1Y3QgbG9naWN2Y19j
cnRjICpjcnRjID0gbG9naWN2Y19jcnRjKGRybV9jcnRjKTsKKwlzdHJ1Y3QgbG9naWN2Y19kcm0g
KmxvZ2ljdmMgPSBjcnRjLT5sb2dpY3ZjOworCisJLyogTWFzayBWX1NZTkMgaW50ZXJydXB0LiAq
LworCXJlZ21hcF93cml0ZV9iaXRzKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNWQ19JTlRfTUFTS19S
RUcsCisJCQkgIExPR0lDVkNfSU5UX01BU0tfVl9TWU5DLCBMT0dJQ1ZDX0lOVF9NQVNLX1ZfU1lO
Qyk7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2NydGNfZnVuY3MgbG9naWN2Y19jcnRj
X2Z1bmNzID0geworCS5yZXNldAkJCT0gZHJtX2F0b21pY19oZWxwZXJfY3J0Y19yZXNldCwKKwku
ZGVzdHJveQkJPSBkcm1fY3J0Y19jbGVhbnVwLAorCS5zZXRfY29uZmlnCQk9IGRybV9hdG9taWNf
aGVscGVyX3NldF9jb25maWcsCisJLnBhZ2VfZmxpcAkJPSBkcm1fYXRvbWljX2hlbHBlcl9wYWdl
X2ZsaXAsCisJLmF0b21pY19kdXBsaWNhdGVfc3RhdGUJPSBkcm1fYXRvbWljX2hlbHBlcl9jcnRj
X2R1cGxpY2F0ZV9zdGF0ZSwKKwkuYXRvbWljX2Rlc3Ryb3lfc3RhdGUJPSBkcm1fYXRvbWljX2hl
bHBlcl9jcnRjX2Rlc3Ryb3lfc3RhdGUsCisJLmVuYWJsZV92YmxhbmsJCT0gbG9naWN2Y19jcnRj
X2VuYWJsZV92YmxhbmssCisJLmRpc2FibGVfdmJsYW5rCQk9IGxvZ2ljdmNfY3J0Y19kaXNhYmxl
X3ZibGFuaywKK307CisKK3ZvaWQgbG9naWN2Y19jcnRjX3ZibGFua19oYW5kbGVyKHN0cnVjdCBs
b2dpY3ZjX2RybSAqbG9naWN2YykKK3sKKwlzdHJ1Y3QgbG9naWN2Y19jcnRjICpjcnRjID0gbG9n
aWN2Yy0+Y3J0YzsKKwlzdHJ1Y3QgZHJtX2RldmljZSAqZHJtID0gbG9naWN2Yy0+ZHJtOworCXVu
c2lnbmVkIGxvbmcgZmxhZ3M7CisKKwlpZiAoIWNydGMpCisJCXJldHVybjsKKworCWRybV9jcnRj
X2hhbmRsZV92YmxhbmsoJmNydGMtPmRybV9jcnRjKTsKKworCXNwaW5fbG9ja19pcnFzYXZlKCZk
cm0tPmV2ZW50X2xvY2ssIGZsYWdzKTsKKwlpZiAoY3J0Yy0+ZXZlbnQpIHsKKwkJZHJtX2NydGNf
c2VuZF92YmxhbmtfZXZlbnQoJmNydGMtPmRybV9jcnRjLCBjcnRjLT5ldmVudCk7CisJCWRybV9j
cnRjX3ZibGFua19wdXQoJmNydGMtPmRybV9jcnRjKTsKKwkJY3J0Yy0+ZXZlbnQgPSBOVUxMOwor
CX0KKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZkcm0tPmV2ZW50X2xvY2ssIGZsYWdzKTsKK30K
KworaW50IGxvZ2ljdmNfY3J0Y19pbml0KHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YykKK3sK
KwlzdHJ1Y3QgZGV2aWNlX25vZGUgKm9mX25vZGUgPSBsb2dpY3ZjLT5kcm0tPmRldi0+b2Zfbm9k
ZTsKKwlzdHJ1Y3QgbG9naWN2Y19jcnRjICpjcnRjOworCXN0cnVjdCBsb2dpY3ZjX2xheWVyICps
YXllcl9wcmltYXJ5OworCWludCByZXQ7CisKKwljcnRjID0gZGV2bV9remFsbG9jKGxvZ2ljdmMt
PmRybS0+ZGV2LCBzaXplb2YoKmNydGMpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWNydGMpCisJCXJl
dHVybiAtRU5PTUVNOworCisJY3J0Yy0+bG9naWN2YyA9IGxvZ2ljdmM7CisKKwlsYXllcl9wcmlt
YXJ5ID0gbG9naWN2Y19sYXllcl9nZXRfcHJpbWFyeShsb2dpY3ZjKTsKKwlpZiAoIWxheWVyX3By
aW1hcnkpIHsKKwkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gZ2V0IHByaW1hcnkgbGF5ZXJcbiIpOwor
CQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlyZXQgPSBkcm1fY3J0Y19pbml0X3dpdGhfcGxhbmVz
KGxvZ2ljdmMtPmRybSwgJmNydGMtPmRybV9jcnRjLAorCQkJCQkmbGF5ZXJfcHJpbWFyeS0+ZHJt
X3BsYW5lLCBOVUxMLAorCQkJCQkmbG9naWN2Y19jcnRjX2Z1bmNzLCBOVUxMKTsKKwlpZiAocmV0
KSB7CisJCURSTV9FUlJPUigiRmFpbGVkIHRvIGluaXRhbGl6ZSBDUlRDXG4iKTsKKwkJcmV0dXJu
IHJldDsKKwl9CisKKwlkcm1fY3J0Y19oZWxwZXJfYWRkKCZjcnRjLT5kcm1fY3J0YywgJmxvZ2lj
dmNfY3J0Y19oZWxwZXJfZnVuY3MpOworCisJY3J0Yy0+ZHJtX2NydGMucG9ydCA9IG9mX2dyYXBo
X2dldF9wb3J0X2J5X2lkKG9mX25vZGUsIDEpOworCisJbG9naWN2Yy0+Y3J0YyA9IGNydGM7CisK
KwlyZXR1cm4gMDsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2lj
dmNfY3J0Yy5oIGIvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19jcnRjLmgKbmV3IGZp
bGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5kZmE1NWMzNzdhYzMKLS0tIC9kZXYv
bnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2NydGMuaApAQCAtMCww
ICsxLDI1IEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCsgKi8KKy8qCisg
KiBDb3B5cmlnaHQgKEMpIDIwMTkgQm9vdGxpbgorICogQXV0aG9yOiBQYXVsIEtvY2lhbGtvd3Nr
aSA8cGF1bC5rb2NpYWxrb3dza2lAYm9vdGxpbi5jb20+CisgKi8KKworI2lmbmRlZiBfTE9HSUNW
Q19DUlRDX0hfCisjZGVmaW5lIF9MT0dJQ1ZDX0NSVENfSF8KKworI2luY2x1ZGUgPGRybS9kcm1f
Y3J0Yy5oPgorI2luY2x1ZGUgPGRybS9kcm1fdmJsYW5rLmg+CisKK3N0cnVjdCBsb2dpY3ZjX2Ry
bTsKKworc3RydWN0IGxvZ2ljdmNfY3J0YyB7CisJc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3Zj
OworCisJc3RydWN0IGRybV9jcnRjIGRybV9jcnRjOworCXN0cnVjdCBkcm1fcGVuZGluZ192Ymxh
bmtfZXZlbnQgKmV2ZW50OworfTsKKwordm9pZCBsb2dpY3ZjX2NydGNfdmJsYW5rX2hhbmRsZXIo
c3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjKTsKK2ludCBsb2dpY3ZjX2NydGNfaW5pdChzdHJ1
Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMpOworCisjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfZHJtLmMgYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9s
b2dpY3ZjX2RybS5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uYzlh
MWE2YjM4NjkyCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9n
aWN2Y19kcm0uYwpAQCAtMCwwICsxLDQ2NyBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6
IEdQTC0yLjArCisvKgorICogQ29weXJpZ2h0IChDKSAyMDE5IEJvb3RsaW4KKyAqIEF1dGhvcjog
UGF1bCBLb2NpYWxrb3dza2kgPHBhdWwua29jaWFsa293c2tpQGJvb3RsaW4uY29tPgorICovCisK
KyNpbmNsdWRlIDxsaW51eC9jbGsuaD4KKyNpbmNsdWRlIDxsaW51eC9tZmQvc3lzY29uLmg+Cisj
aW5jbHVkZSA8bGludXgvbW9kdWxlLmg+CisjaW5jbHVkZSA8bGludXgvb2YuaD4KKyNpbmNsdWRl
IDxsaW51eC9vZl9hZGRyZXNzLmg+CisjaW5jbHVkZSA8bGludXgvb2ZfZGV2aWNlLmg+CisjaW5j
bHVkZSA8bGludXgvb2ZfcmVzZXJ2ZWRfbWVtLmg+CisjaW5jbHVkZSA8bGludXgvcmVnbWFwLmg+
CisjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pY19oZWxw
ZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2Rydi5oPgorI2luY2x1ZGUgPGRybS9kcm1fZmJfaGVs
cGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9nZW1fY21hX2hlbHBlci5oPgorI2luY2x1ZGUgPGRy
bS9kcm1fcHJpbnQuaD4KKworI2luY2x1ZGUgImxvZ2ljdmNfY3J0Yy5oIgorI2luY2x1ZGUgImxv
Z2ljdmNfZHJtLmgiCisjaW5jbHVkZSAibG9naWN2Y19pbnRlcmZhY2UuaCIKKyNpbmNsdWRlICJs
b2dpY3ZjX21vZGUuaCIKKyNpbmNsdWRlICJsb2dpY3ZjX2xheWVyLmgiCisjaW5jbHVkZSAibG9n
aWN2Y19vZi5oIgorI2luY2x1ZGUgImxvZ2ljdmNfcmVncy5oIgorCitERUZJTkVfRFJNX0dFTV9D
TUFfRk9QUyhsb2dpY3ZjX2RybV9mb3BzKTsKKworc3RhdGljIGludCBsb2dpY3ZjX2RybV9nZW1f
Y21hX2R1bWJfY3JlYXRlKHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wcml2LAorCQkJCQkgICBzdHJ1
Y3QgZHJtX2RldmljZSAqZHJtLAorCQkJCQkgICBzdHJ1Y3QgZHJtX21vZGVfY3JlYXRlX2R1bWIg
KmFyZ3MpCit7CisJc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjID0gZHJtLT5kZXZfcHJpdmF0
ZTsKKworCS8qIFN0cmlkZSBpcyBhbHdheXMgZml4ZWQgdG8gaXRzIGNvbmZpZ3VyYXRpb24gdmFs
dWUuICovCisJYXJncy0+cGl0Y2ggPSBsb2dpY3ZjLT5jb25maWcucm93X3N0cmlkZSAqIERJVl9S
T1VORF9VUChhcmdzLT5icHAsIDgpOworCisJcmV0dXJuIGRybV9nZW1fY21hX2R1bWJfY3JlYXRl
X2ludGVybmFsKGZpbGVfcHJpdiwgZHJtLCBhcmdzKTsKK30KKworc3RhdGljIHN0cnVjdCBkcm1f
ZHJpdmVyIGxvZ2ljdmNfZHJtX2RyaXZlciA9IHsKKwkuZHJpdmVyX2ZlYXR1cmVzCQk9IERSSVZF
Ul9HRU0gfCBEUklWRVJfTU9ERVNFVCB8CisJCQkJCSAgRFJJVkVSX0FUT01JQywKKworCS5mb3Bz
CQkJCT0gJmxvZ2ljdmNfZHJtX2ZvcHMsCisJLm5hbWUJCQkJPSAibG9naWN2Yy1kcm0iLAorCS5k
ZXNjCQkJCT0gIlh5bG9uIExvZ2lDVkMgRFJNIGRyaXZlciIsCisJLmRhdGUJCQkJPSAiMjAxOTAz
MTkiLAorCS5tYWpvcgkJCQk9IDEsCisJLm1pbm9yCQkJCT0gMCwKKworCURSTV9HRU1fQ01BX1ZN
QVBfRFJJVkVSX09QUywKKwkuZHVtYl9jcmVhdGUJCQk9IGxvZ2ljdmNfZHJtX2dlbV9jbWFfZHVt
Yl9jcmVhdGUsCit9OworCitzdGF0aWMgc3RydWN0IHJlZ21hcF9jb25maWcgbG9naWN2Y19kcm1f
cmVnbWFwX2NvbmZpZyA9IHsKKwkucmVnX2JpdHMJPSAzMiwKKwkudmFsX2JpdHMJPSAzMiwKKwku
cmVnX3N0cmlkZQk9IDQsCisJLm5hbWUJCT0gImxvZ2ljdmMtZHJtIiwKK307CisKK3N0YXRpYyBp
cnFyZXR1cm5fdCBsb2dpY3ZjX2RybV9pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICpkYXRhKQor
eworCXN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YyA9IGRhdGE7CisJaXJxcmV0dXJuX3QgcmV0
ID0gSVJRX05PTkU7CisJdTMyIHN0YXQgPSAwOworCisJLyogR2V0IHBlbmRpbmcgaW50ZXJydXB0
IHNvdXJjZXMuICovCisJcmVnbWFwX3JlYWQobG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZDX0lOVF9T
VEFUX1JFRywgJnN0YXQpOworCisJLyogQ2xlYXIgYWxsIHBlbmRpbmcgaW50ZXJydXB0IHNvdXJj
ZXMuICovCisJcmVnbWFwX3dyaXRlKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNWQ19JTlRfU1RBVF9S
RUcsIHN0YXQpOworCisJaWYgKHN0YXQgJiBMT0dJQ1ZDX0lOVF9TVEFUX1ZfU1lOQykgeworCQls
b2dpY3ZjX2NydGNfdmJsYW5rX2hhbmRsZXIobG9naWN2Yyk7CisJCXJldCA9IElSUV9IQU5ETEVE
OworCX0KKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgbG9naWN2Y19kcm1fY29uZmln
X3BhcnNlKHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YykKK3sKKwlzdHJ1Y3QgZGV2aWNlX25v
ZGUgKm9mX25vZGUgPSBsb2dpY3ZjLT5kcm0tPmRldi0+b2Zfbm9kZTsKKwlzdHJ1Y3QgbG9naWN2
Y19kcm1fY29uZmlnICpjb25maWcgPSAmbG9naWN2Yy0+Y29uZmlnOworCXN0cnVjdCBkZXZpY2Vf
bm9kZSAqbGF5ZXJzX25vZGU7CisJaW50IHJldDsKKworCWxvZ2ljdmNfb2ZfcHJvcGVydHlfcGFy
c2VfYm9vbChvZl9ub2RlLCAieHlsb24sZGl0aGVyaW5nIiwKKwkJCQkgICAgICAgJmNvbmZpZy0+
ZGl0aGVyaW5nKTsKKwlsb2dpY3ZjX29mX3Byb3BlcnR5X3BhcnNlX2Jvb2wob2Zfbm9kZSwgInh5
bG9uLGJhY2tncm91bmQtbGF5ZXIiLAorCQkJCSAgICAgICAmY29uZmlnLT5iYWNrZ3JvdW5kX2xh
eWVyKTsKKwlsb2dpY3ZjX29mX3Byb3BlcnR5X3BhcnNlX2Jvb2wob2Zfbm9kZSwgInh5bG9uLGxh
eWVycy1jb25maWd1cmFibGUiLAorCQkJCSAgICAgICAmY29uZmlnLT5sYXllcnNfY29uZmlndXJh
YmxlKTsKKworCXJldCA9IGxvZ2ljdmNfb2ZfcHJvcGVydHlfcGFyc2VfdTMyKG9mX25vZGUsICJ4
eWxvbixkaXNwbGF5LWludGVyZmFjZSIsCisJCQkJCSAgICAmY29uZmlnLT5kaXNwbGF5X2ludGVy
ZmFjZSk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCXJldCA9IGxvZ2ljdmNfb2ZfcHJv
cGVydHlfcGFyc2VfdTMyKG9mX25vZGUsICJ4eWxvbixkaXNwbGF5LWNvbG9yc3BhY2UiLAorCQkJ
CQkgICAgJmNvbmZpZy0+ZGlzcGxheV9jb2xvcnNwYWNlKTsKKwlpZiAocmV0KQorCQlyZXR1cm4g
cmV0OworCisJcmV0ID0gbG9naWN2Y19vZl9wcm9wZXJ0eV9wYXJzZV91MzIob2Zfbm9kZSwgInh5
bG9uLGRpc3BsYXktZGVwdGgiLAorCQkJCQkgICAgJmNvbmZpZy0+ZGlzcGxheV9kZXB0aCk7CisJ
aWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCXJldCA9IGxvZ2ljdmNfb2ZfcHJvcGVydHlfcGFy
c2VfdTMyKG9mX25vZGUsICJ4eWxvbixyb3ctc3RyaWRlIiwKKwkJCQkJICAgICZjb25maWctPnJv
d19zdHJpZGUpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwlsYXllcnNfbm9kZSA9IG9m
X2dldF9jaGlsZF9ieV9uYW1lKG9mX25vZGUsICJsYXllcnMiKTsKKwlpZiAoIWxheWVyc19ub2Rl
KSB7CisJCURSTV9FUlJPUigiTWlzc2luZyBub24tb3B0aW9uYWwgbGF5ZXJzIG5vZGVcbiIpOwor
CQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwljb25maWctPmxheWVyc19jb3VudCA9IG9mX2dldF9j
aGlsZF9jb3VudChsYXllcnNfbm9kZSk7CisJaWYgKCFjb25maWctPmxheWVyc19jb3VudCkgewor
CQlEUk1fRVJST1IoIk1pc3NpbmcgYSBub24tb3B0aW9uYWwgbGF5ZXJzIGNoaWxkcmVuIG5vZGVc
biIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZv
aWQgbG9naWN2Y192ZXJzaW9uX3ByaW50KHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YykKK3sK
Kwl1MzIgdmVyc2lvbjsKKworCXJlZ21hcF9yZWFkKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNWQ19J
UF9WRVJTSU9OX1JFRywgJnZlcnNpb24pOworCisJRFJNX0lORk8oIkxvZ2lDVkMgdmVyc2lvbiAl
ZC4lMDJkLiVjXG4iLAorCQkgKGludClMT0dJQ1ZDX0ZJRUxEX0dFVChMT0dJQ1ZDX0lQX1ZFUlNJ
T05fTUFKT1IsIHZlcnNpb24pLAorCQkgKGludClMT0dJQ1ZDX0ZJRUxEX0dFVChMT0dJQ1ZDX0lQ
X1ZFUlNJT05fTUlOT1IsIHZlcnNpb24pLAorCQkgKGNoYXIpTE9HSUNWQ19GSUVMRF9HRVQoTE9H
SUNWQ19JUF9WRVJTSU9OX0xFVkVMLCB2ZXJzaW9uKSArCisJCSAnYScpOworfQorCitzdGF0aWMg
aW50IGxvZ2ljdmNfY2xvY2tzX3ByZXBhcmUoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjKQor
eworCXN0cnVjdCB7CisJCXN0cnVjdCBjbGsgKipjbGs7CisJCWNoYXIgKm5hbWU7CisJCWJvb2wg
b3B0aW9uYWw7CisJfSBjbG9ja3NfbWFwW10gPSB7CisJCXsKKwkJCS5jbGsgPSAmbG9naWN2Yy0+
dmNsaywKKwkJCS5uYW1lID0gInZjbGsiLAorCQkJLm9wdGlvbmFsID0gZmFsc2UsCisJCX0sCisJ
CXsKKwkJCS5jbGsgPSAmbG9naWN2Yy0+dmNsazIsCisJCQkubmFtZSA9ICJ2Y2xrMiIsCisJCQku
b3B0aW9uYWwgPSB0cnVlLAorCQl9LAorCQl7CisJCQkuY2xrID0gJmxvZ2ljdmMtPmx2ZHNjbGss
CisJCQkubmFtZSA9ICJsdmRzY2xrIiwKKwkJCS5vcHRpb25hbCA9IHRydWUsCisJCX0sCisJCXsK
KwkJCS5jbGsgPSAmbG9naWN2Yy0+bHZkc2Nsa24sCisJCQkubmFtZSA9ICJsdmRzY2xrbiIsCisJ
CQkub3B0aW9uYWwgPSB0cnVlLAorCQl9LAorCX07CisJdW5zaWduZWQgaW50IGk7CisJaW50IHJl
dDsKKworCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGNsb2Nrc19tYXApOyBpKyspIHsKKwkJ
c3RydWN0IGNsayAqY2xrOworCisJCWNsayA9IGRldm1fY2xrX2dldChsb2dpY3ZjLT5kcm0tPmRl
diwgY2xvY2tzX21hcFtpXS5uYW1lKTsKKwkJaWYgKElTX0VSUihjbGspKSB7CisJCQlpZiAoUFRS
X0VSUihjbGspID09IC1FTk9FTlQgJiYgY2xvY2tzX21hcFtpXS5vcHRpb25hbCkKKwkJCQljb250
aW51ZTsKKworCQkJRFJNX0VSUk9SKCJNaXNzaW5nIG5vbi1vcHRpb25hbCBjbG9jayAlc1xuIiwK
KwkJCQkgIGNsb2Nrc19tYXBbaV0ubmFtZSk7CisKKwkJCXJldCA9IFBUUl9FUlIoY2xrKTsKKwkJ
CWdvdG8gZXJyb3I7CisJCX0KKworCQlyZXQgPSBjbGtfcHJlcGFyZV9lbmFibGUoY2xrKTsKKwkJ
aWYgKHJldCkgeworCQkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gcHJlcGFyZSBhbmQgZW5hYmxlIGNs
b2NrICVzXG4iLAorCQkJCSAgY2xvY2tzX21hcFtpXS5uYW1lKTsKKwkJCWdvdG8gZXJyb3I7CisJ
CX0KKworCQkqY2xvY2tzX21hcFtpXS5jbGsgPSBjbGs7CisJfQorCisJcmV0dXJuIDA7CisKK2Vy
cm9yOgorCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGNsb2Nrc19tYXApOyBpKyspIHsKKwkJ
aWYgKCEqY2xvY2tzX21hcFtpXS5jbGspCisJCQljb250aW51ZTsKKworCQljbGtfZGlzYWJsZV91
bnByZXBhcmUoKmNsb2Nrc19tYXBbaV0uY2xrKTsKKwkJKmNsb2Nrc19tYXBbaV0uY2xrID0gTlVM
TDsKKwl9CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IGxvZ2ljdmNfY2xvY2tzX3Vu
cHJlcGFyZShzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMpCit7CisJc3RydWN0IGNsayAqKmNs
b2Nrc1tdID0geworCQkmbG9naWN2Yy0+dmNsaywKKwkJJmxvZ2ljdmMtPnZjbGsyLAorCQkmbG9n
aWN2Yy0+bHZkc2NsaywKKwkJJmxvZ2ljdmMtPmx2ZHNjbGtuLAorCX07CisJdW5zaWduZWQgaW50
IGk7CisKKwlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShjbG9ja3MpOyBpKyspIHsKKwkJaWYg
KCEqY2xvY2tzW2ldKQorCQkJY29udGludWU7CisKKwkJY2xrX2Rpc2FibGVfdW5wcmVwYXJlKCpj
bG9ja3NbaV0pOworCQkqY2xvY2tzW2ldID0gTlVMTDsKKwl9CisKKwlyZXR1cm4gMDsKK30KKwor
c3RhdGljIGludCBsb2dpY3ZjX2RybV9wcm9iZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2
KQoreworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqb2Zfbm9kZSA9IHBkZXYtPmRldi5vZl9ub2RlOwor
CXN0cnVjdCBkZXZpY2Vfbm9kZSAqcmVzZXJ2ZWRfbWVtX25vZGU7CisJc3RydWN0IHJlc2VydmVk
X21lbSAqcmVzZXJ2ZWRfbWVtID0gTlVMTDsKKwljb25zdCBzdHJ1Y3QgbG9naWN2Y19kcm1fY2Fw
cyAqY2FwczsKKwlzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmM7CisJc3RydWN0IGRybV9kZXZp
Y2UgKmRybTsKKwlzdHJ1Y3QgcmVnbWFwICpyZWdtYXA7CisJc3RydWN0IHJlc291cmNlIHJlczsK
Kwl2b2lkIF9faW9tZW0gKmJhc2U7CisJaW50IGlycTsKKwlpbnQgcmV0OworCisJY2FwcyA9IG9m
X2RldmljZV9nZXRfbWF0Y2hfZGF0YSgmcGRldi0+ZGV2KTsKKwlpZiAoIWNhcHMpCisJCXJldHVy
biAtRUlOVkFMOworCisJcmV0ID0gb2ZfcmVzZXJ2ZWRfbWVtX2RldmljZV9pbml0KCZwZGV2LT5k
ZXYpOworCWlmIChyZXQgJiYgcmV0ICE9IC1FTk9ERVYpIHsKKwkJRFJNX0VSUk9SKCJGYWlsZWQg
dG8gaW5pdCBtZW1vcnkgcmVnaW9uXG4iKTsKKwkJZ290byBlcnJvcl9lYXJseTsKKwl9CisKKwly
ZXNlcnZlZF9tZW1fbm9kZSA9IG9mX3BhcnNlX3BoYW5kbGUob2Zfbm9kZSwgIm1lbW9yeS1yZWdp
b24iLCAwKTsKKwlpZiAocmVzZXJ2ZWRfbWVtX25vZGUpIHsKKwkJcmVzZXJ2ZWRfbWVtID0gb2Zf
cmVzZXJ2ZWRfbWVtX2xvb2t1cChyZXNlcnZlZF9tZW1fbm9kZSk7CisJCW9mX25vZGVfcHV0KHJl
c2VydmVkX21lbV9ub2RlKTsKKwl9CisKKwkvKiBHZXQgcmVnbWFwIGZyb20gc3lzY29uIGZpcnN0
IGlmIGF2YWlsYWJsZS4gKi8KKwlyZWdtYXAgPSBzeXNjb25fcmVnbWFwX2xvb2t1cF9ieV9waGFu
ZGxlKG9mX25vZGUsICJ4eWxvbixzeXNjb24iKTsKKworCS8qIFRoZW4gZ2V0IHJlZ21hcCBmcm9t
IHBhcmVudCBpZiBhdmFpbGFibGUuICovCisJaWYgKElTX0VSUihyZWdtYXApICYmIG9mX25vZGUt
PnBhcmVudCkKKwkJcmVnbWFwID0gc3lzY29uX25vZGVfdG9fcmVnbWFwKG9mX25vZGUtPnBhcmVu
dCk7CisKKwkvKiBSZWdpc3RlciBvdXIgb3duIHJlZ21hcCBvdGhlcndpc2UuICovCisJaWYgKElT
X0VSUihyZWdtYXApKSB7CisJCXJldCA9IG9mX2FkZHJlc3NfdG9fcmVzb3VyY2Uob2Zfbm9kZSwg
MCwgJnJlcyk7CisJCWlmIChyZXQpIHsKKwkJCURSTV9FUlJPUigiRmFpbGVkIHRvIGdldCByZXNv
dXJjZSBmcm9tIGFkZHJlc3NcbiIpOworCQkJZ290byBlcnJvcl9yZXNlcnZlZF9tZW07CisJCX0K
KworCQliYXNlID0gZGV2bV9pb3JlbWFwX3Jlc291cmNlKCZwZGV2LT5kZXYsICZyZXMpOworCQlp
ZiAoSVNfRVJSKGJhc2UpKSB7CisJCQlEUk1fRVJST1IoIkZhaWxlZCB0byBtYXAgSS9PIGJhc2Vc
biIpOworCQkJcmV0ID0gUFRSX0VSUihiYXNlKTsKKwkJCWdvdG8gZXJyb3JfcmVzZXJ2ZWRfbWVt
OworCQl9CisKKwkJbG9naWN2Y19kcm1fcmVnbWFwX2NvbmZpZy5tYXhfcmVnaXN0ZXIgPSByZXNv
dXJjZV9zaXplKCZyZXMpIC0KKwkJCQkJCQkgNDsKKworCQlyZWdtYXAgPSBkZXZtX3JlZ21hcF9p
bml0X21taW8oJnBkZXYtPmRldiwgYmFzZSwKKwkJCQkJICAgICAgICZsb2dpY3ZjX2RybV9yZWdt
YXBfY29uZmlnKTsKKwkJaWYgKElTX0VSUihyZWdtYXApKSB7CisJCQlEUk1fRVJST1IoIkZhaWxl
ZCB0byBjcmVhdGUgcmVnbWFwIGZvciBJL09cbiIpOworCQkJcmV0ID0gUFRSX0VSUihyZWdtYXAp
OworCQkJZ290byBlcnJvcl9yZXNlcnZlZF9tZW07CisJCX0KKwl9CisKKwlpcnEgPSBwbGF0Zm9y
bV9nZXRfaXJxKHBkZXYsIDApOworCWlmIChpcnEgPCAwKSB7CisJCURSTV9FUlJPUigiRmFpbGVk
IHRvIGdldCBJUlFcbiIpOworCQlyZXQgPSAtRU5PREVWOworCQlnb3RvIGVycm9yX3Jlc2VydmVk
X21lbTsKKwl9CisKKwlkcm0gPSBkcm1fZGV2X2FsbG9jKCZsb2dpY3ZjX2RybV9kcml2ZXIsICZw
ZGV2LT5kZXYpOworCWlmIChJU19FUlIoZHJtKSkgeworCQlyZXQgPSBQVFJfRVJSKGRybSk7CisJ
CWdvdG8gZXJyb3JfcmVzZXJ2ZWRfbWVtOworCX0KKworCWxvZ2ljdmMgPSBkZXZtX2t6YWxsb2Mo
JnBkZXYtPmRldiwgc2l6ZW9mKCpsb2dpY3ZjKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFsb2dpY3Zj
KSB7CisJCXJldCA9IC1FTk9NRU07CisJCWdvdG8gZXJyb3JfbG9naWN2YzsKKwl9CisKKwlsb2dp
Y3ZjLT5jYXBzID0gY2FwczsKKwlsb2dpY3ZjLT5kcm0gPSBkcm07CisJZHJtLT5kZXZfcHJpdmF0
ZSA9IGxvZ2ljdmM7CisJcGxhdGZvcm1fc2V0X2RydmRhdGEocGRldiwgbG9naWN2Yyk7CisKKwls
b2dpY3ZjLT5yZWdtYXAgPSByZWdtYXA7CisJSU5JVF9MSVNUX0hFQUQoJmxvZ2ljdmMtPmxheWVy
c19saXN0KTsKKworCWlmIChyZXNlcnZlZF9tZW0pCisJCWxvZ2ljdmMtPnJlc2VydmVkX21lbV9i
YXNlID0gcmVzZXJ2ZWRfbWVtLT5iYXNlOworCisJcmV0ID0gbG9naWN2Y19jbG9ja3NfcHJlcGFy
ZShsb2dpY3ZjKTsKKwlpZiAocmV0KSB7CisJCURSTV9FUlJPUigiRmFpbGVkIHRvIHByZXBhcmUg
Y2xvY2tzXG4iKTsKKwkJZ290byBlcnJvcl9sb2dpY3ZjOworCX0KKworCXJldCA9IGRldm1fcmVx
dWVzdF9pcnEoZHJtLT5kZXYsIGlycSwgbG9naWN2Y19kcm1faXJxX2hhbmRsZXIsIDAsCisJCQkg
ICAgICAgZGV2X25hbWUoZHJtLT5kZXYpLCBsb2dpY3ZjKTsKKwlpZiAocmV0KSB7CisJCURSTV9F
UlJPUigiRmFpbGVkIHRvIHJlcXVlc3QgSVJRXG4iKTsKKwkJZ290byBlcnJvcl9jbG9ja3M7CisJ
fQorCisJbG9naWN2Y192ZXJzaW9uX3ByaW50KGxvZ2ljdmMpOworCisJcmV0ID0gbG9naWN2Y19k
cm1fY29uZmlnX3BhcnNlKGxvZ2ljdmMpOworCWlmIChyZXQgJiYgcmV0ICE9IC1FTk9ERVYpIHsK
KwkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gcGFyc2UgY29uZmlnXG4iKTsKKwkJZ290byBlcnJvcl9j
bG9ja3M7CisJfQorCisJZHJtX21vZGVfY29uZmlnX2luaXQoZHJtKTsKKworCXJldCA9IGxvZ2lj
dmNfbGF5ZXJzX2luaXQobG9naWN2Yyk7CisJaWYgKHJldCkgeworCQlEUk1fRVJST1IoIkZhaWxl
ZCB0byBpbml0aWFsaXplIGxheWVyc1xuIik7CisJCWdvdG8gZXJyb3JfbW9kZV9jb25maWc7CisJ
fQorCisJcmV0ID0gbG9naWN2Y19jcnRjX2luaXQobG9naWN2Yyk7CisJaWYgKHJldCkgeworCQlE
Uk1fRVJST1IoIkZhaWxlZCB0byBpbml0aWFsaXplIENSVENcbiIpOworCQlnb3RvIGVycm9yX21v
ZGVfY29uZmlnOworCX0KKworCWxvZ2ljdmNfbGF5ZXJzX2F0dGFjaF9jcnRjKGxvZ2ljdmMpOwor
CisJcmV0ID0gbG9naWN2Y19pbnRlcmZhY2VfaW5pdChsb2dpY3ZjKTsKKwlpZiAocmV0KSB7CisJ
CWlmIChyZXQgIT0gLUVQUk9CRV9ERUZFUikKKwkJCURSTV9FUlJPUigiRmFpbGVkIHRvIGluaXRp
YWxpemUgaW50ZXJmYWNlXG4iKTsKKworCQlnb3RvIGVycm9yX21vZGVfY29uZmlnOworCX0KKwor
CWxvZ2ljdmNfaW50ZXJmYWNlX2F0dGFjaF9jcnRjKGxvZ2ljdmMpOworCisJcmV0ID0gbG9naWN2
Y19tb2RlX2luaXQobG9naWN2Yyk7CisJaWYgKHJldCkgeworCQlEUk1fRVJST1IoIkZhaWxlZCB0
byBpbml0aWFsaXplIEtNU1xuIik7CisJCWdvdG8gZXJyb3JfbW9kZV9jb25maWc7CisJfQorCisJ
cmV0ID0gZHJtX2Rldl9yZWdpc3Rlcihkcm0sIDApOworCWlmIChyZXQpIHsKKwkJRFJNX0VSUk9S
KCJGYWlsZWQgdG8gcmVnaXN0ZXIgRFJNIGRldmljZVxuIik7CisJCWdvdG8gZXJyb3JfbW9kZTsK
Kwl9CisKKwlyZXR1cm4gMDsKKworZXJyb3JfbW9kZToKKwlsb2dpY3ZjX21vZGVfZmluaShsb2dp
Y3ZjKTsKKworZXJyb3JfbW9kZV9jb25maWc6CisJZHJtX21vZGVfY29uZmlnX2NsZWFudXAoZHJt
KTsKKworZXJyb3JfY2xvY2tzOgorCWxvZ2ljdmNfY2xvY2tzX3VucHJlcGFyZShsb2dpY3ZjKTsK
KworZXJyb3JfbG9naWN2YzoKKwlkcm1fZGV2X3B1dChkcm0pOworCitlcnJvcl9yZXNlcnZlZF9t
ZW06CisJb2ZfcmVzZXJ2ZWRfbWVtX2RldmljZV9yZWxlYXNlKCZwZGV2LT5kZXYpOworCitlcnJv
cl9lYXJseToKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IGxvZ2ljdmNfZHJtX3JlbW92
ZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQoreworCXN0cnVjdCBsb2dpY3ZjX2RybSAq
bG9naWN2YyA9IHBsYXRmb3JtX2dldF9kcnZkYXRhKHBkZXYpOworCisJZHJtX2Rldl91bnJlZ2lz
dGVyKGxvZ2ljdmMtPmRybSk7CisJZHJtX2F0b21pY19oZWxwZXJfc2h1dGRvd24obG9naWN2Yy0+
ZHJtKTsKKworCWxvZ2ljdmNfbW9kZV9maW5pKGxvZ2ljdmMpOworCisJZHJtX21vZGVfY29uZmln
X2NsZWFudXAobG9naWN2Yy0+ZHJtKTsKKworCWxvZ2ljdmNfY2xvY2tzX3VucHJlcGFyZShsb2dp
Y3ZjKTsKKworCWRybV9kZXZfcHV0KGxvZ2ljdmMtPmRybSk7CisKKwlvZl9yZXNlcnZlZF9tZW1f
ZGV2aWNlX3JlbGVhc2UoJnBkZXYtPmRldik7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNv
bnN0IHN0cnVjdCBsb2dpY3ZjX2RybV9jYXBzIGxvZ2ljdmNfZHJtX2NhcHNfMyA9IHsKKwkubGF5
ZXJfYWRkcmVzcyA9IGZhbHNlLAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBsb2dpY3ZjX2Ry
bV9jYXBzIGxvZ2ljdmNfZHJtX2NhcHNfNCA9IHsKKwkubGF5ZXJfYWRkcmVzcyA9IHRydWUsCit9
OworCitzdGF0aWMgc3RydWN0IG9mX2RldmljZV9pZCBsb2dpY3ZjX2RybV9vZl90YWJsZVtdID0g
eworCXsKKwkJLmNvbXBhdGlibGUgPSAieHlsb24sbG9naWN2Yy0zLjAyLmEtZGlzcGxheSIsCisJ
CS5kYXRhID0gJmxvZ2ljdmNfZHJtX2NhcHNfMywKKwl9LAorCXsKKwkJLmNvbXBhdGlibGUgPSAi
eHlsb24sbG9naWN2Yy00LjAxLmEtZGlzcGxheSIsCisJCS5kYXRhID0gJmxvZ2ljdmNfZHJtX2Nh
cHNfNCwKKwl9LAorCXsgfSwKK307CitNT0RVTEVfREVWSUNFX1RBQkxFKG9mLCBsb2dpY3ZjX2Ry
bV9vZl90YWJsZSk7CisKK3N0YXRpYyBzdHJ1Y3QgcGxhdGZvcm1fZHJpdmVyIGxvZ2ljdmNfZHJt
X3BsYXRmb3JtX2RyaXZlciA9IHsKKwkucHJvYmUJCT0gbG9naWN2Y19kcm1fcHJvYmUsCisJLnJl
bW92ZQkJPSBsb2dpY3ZjX2RybV9yZW1vdmUsCisJLmRyaXZlcgkJPSB7CisJCS5uYW1lCQk9ICJs
b2dpY3ZjLWRybSIsCisJCS5vZl9tYXRjaF90YWJsZQk9IGxvZ2ljdmNfZHJtX29mX3RhYmxlLAor
CX0sCit9OworCittb2R1bGVfcGxhdGZvcm1fZHJpdmVyKGxvZ2ljdmNfZHJtX3BsYXRmb3JtX2Ry
aXZlcik7CisKK01PRFVMRV9BVVRIT1IoIlBhdWwgS29jaWFsa293c2tpIDxwYXVsLmtvY2lhbGtv
d3NraUBib290bGluLmNvbT4iKTsKK01PRFVMRV9ERVNDUklQVElPTigiWHlsb24gTG9naUNWQyBE
Uk0gZHJpdmVyIik7CitNT0RVTEVfTElDRU5TRSgiR1BMIik7CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2RybS5oIGIvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMv
bG9naWN2Y19kcm0uaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmNj
NzI4ZDVhNGFlZQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xv
Z2ljdmNfZHJtLmgKQEAgLTAsMCArMSw2MCBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6
IEdQTC0yLjArICovCisvKgorICogQ29weXJpZ2h0IChDKSAyMDE5IEJvb3RsaW4KKyAqIEF1dGhv
cjogUGF1bCBLb2NpYWxrb3dza2kgPHBhdWwua29jaWFsa293c2tpQGJvb3RsaW4uY29tPgorICov
CisKKyNpZm5kZWYgX0xPR0lDVkNfRFJNX0hfCisjZGVmaW5lIF9MT0dJQ1ZDX0RSTV9IXworCisj
aW5jbHVkZSA8bGludXgvcmVnbWFwLmg+CisjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KKyNpbmNs
dWRlIDxkcm0vZHJtX2RldmljZS5oPgorCisjZGVmaW5lIExPR0lDVkNfRElTUExBWV9JTlRFUkZB
Q0VfUkdCCQkJMAorI2RlZmluZSBMT0dJQ1ZDX0RJU1BMQVlfSU5URVJGQUNFX0lUVTY1NgkJMQor
I2RlZmluZSBMT0dJQ1ZDX0RJU1BMQVlfSU5URVJGQUNFX0xWRFNfNEJJVFMJCTIKKyNkZWZpbmUg
TE9HSUNWQ19ESVNQTEFZX0lOVEVSRkFDRV9MVkRTXzRCSVRTX0NBTUVSQQkzCisjZGVmaW5lIExP
R0lDVkNfRElTUExBWV9JTlRFUkZBQ0VfTFZEU18zQklUUwkJNAorI2RlZmluZSBMT0dJQ1ZDX0RJ
U1BMQVlfSU5URVJGQUNFX0RWSQkJCTUKKworI2RlZmluZSBMT0dJQ1ZDX0RJU1BMQVlfQ09MT1JT
UEFDRV9SR0IJCTAKKyNkZWZpbmUgTE9HSUNWQ19ESVNQTEFZX0NPTE9SU1BBQ0VfWVVWNDIyCTEK
KyNkZWZpbmUgTE9HSUNWQ19ESVNQTEFZX0NPTE9SU1BBQ0VfWVVWNDQ0CTIKKworc3RydWN0IGxv
Z2ljdmNfY3J0YzsKK3N0cnVjdCBsb2dpY3ZjX2ludGVyZmFjZTsKKworc3RydWN0IGxvZ2ljdmNf
ZHJtX2NvbmZpZyB7CisJdTMyIGRpc3BsYXlfaW50ZXJmYWNlOworCXUzMiBkaXNwbGF5X2NvbG9y
c3BhY2U7CisJdTMyIGRpc3BsYXlfZGVwdGg7CisJdTMyIHJvd19zdHJpZGU7CisJYm9vbCBkaXRo
ZXJpbmc7CisJYm9vbCBiYWNrZ3JvdW5kX2xheWVyOworCWJvb2wgbGF5ZXJzX2NvbmZpZ3VyYWJs
ZTsKKwl1MzIgbGF5ZXJzX2NvdW50OworfTsKKworc3RydWN0IGxvZ2ljdmNfZHJtX2NhcHMgewor
CWJvb2wgbGF5ZXJfYWRkcmVzczsKK307CisKK3N0cnVjdCBsb2dpY3ZjX2RybSB7CisJY29uc3Qg
c3RydWN0IGxvZ2ljdmNfZHJtX2NhcHMgKmNhcHM7CisJc3RydWN0IGxvZ2ljdmNfZHJtX2NvbmZp
ZyBjb25maWc7CisJc3RydWN0IGRybV9kZXZpY2UgKmRybTsKKwlwaHlzX2FkZHJfdCByZXNlcnZl
ZF9tZW1fYmFzZTsKKwlzdHJ1Y3QgcmVnbWFwICpyZWdtYXA7CisKKwlzdHJ1Y3QgY2xrICp2Y2xr
OworCXN0cnVjdCBjbGsgKnZjbGsyOworCXN0cnVjdCBjbGsgKmx2ZHNjbGs7CisJc3RydWN0IGNs
ayAqbHZkc2Nsa247CisKKwlzdHJ1Y3QgbGlzdF9oZWFkIGxheWVyc19saXN0OworCXN0cnVjdCBs
b2dpY3ZjX2NydGMgKmNydGM7CisJc3RydWN0IGxvZ2ljdmNfaW50ZXJmYWNlICppbnRlcmZhY2U7
Cit9OworCisjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2lj
dmNfaW50ZXJmYWNlLmMgYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX2ludGVyZmFj
ZS5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uNzkyYjFmYzJhNWY3
Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19pbnRl
cmZhY2UuYwpAQCAtMCwwICsxLDIzNSBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQ
TC0yLjArCisvKgorICogQ29weXJpZ2h0IChDKSAyMDE5IEJvb3RsaW4KKyAqIEF1dGhvcjogUGF1
bCBLb2NpYWxrb3dza2kgPHBhdWwua29jaWFsa293c2tpQGJvb3RsaW4uY29tPgorICovCisKKyNp
bmNsdWRlIDxsaW51eC90eXBlcy5oPgorI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljX2hlbHBlci5o
PgorI2luY2x1ZGUgPGRybS9kcm1fYnJpZGdlLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9jb25uZWN0
b3IuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2NydGNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2Ry
bV9kcnYuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2VuY29kZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJt
X2dlbV9jbWFfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9tb2Rlc2V0X2hlbHBlcl92dGFi
bGVzLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9vZi5oPgorI2luY2x1ZGUgPGRybS9kcm1fcGFuZWwu
aD4KKyNpbmNsdWRlIDxkcm0vZHJtX3ByaW50Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wcm9iZV9o
ZWxwZXIuaD4KKworI2luY2x1ZGUgImxvZ2ljdmNfY3J0Yy5oIgorI2luY2x1ZGUgImxvZ2ljdmNf
ZHJtLmgiCisjaW5jbHVkZSAibG9naWN2Y19pbnRlcmZhY2UuaCIKKyNpbmNsdWRlICJsb2dpY3Zj
X3JlZ3MuaCIKKworI2RlZmluZSBsb2dpY3ZjX2ludGVyZmFjZV9mcm9tX2RybV9lbmNvZGVyKGMp
IFwKKwljb250YWluZXJfb2YoYywgc3RydWN0IGxvZ2ljdmNfaW50ZXJmYWNlLCBkcm1fZW5jb2Rl
cikKKyNkZWZpbmUgbG9naWN2Y19pbnRlcmZhY2VfZnJvbV9kcm1fY29ubmVjdG9yKGMpIFwKKwlj
b250YWluZXJfb2YoYywgc3RydWN0IGxvZ2ljdmNfaW50ZXJmYWNlLCBkcm1fY29ubmVjdG9yKQor
CitzdGF0aWMgdm9pZCBsb2dpY3ZjX2VuY29kZXJfZW5hYmxlKHN0cnVjdCBkcm1fZW5jb2RlciAq
ZHJtX2VuY29kZXIpCit7CisJc3RydWN0IGxvZ2ljdmNfaW50ZXJmYWNlICppbnRlcmZhY2UgPQor
CQlsb2dpY3ZjX2ludGVyZmFjZV9mcm9tX2RybV9lbmNvZGVyKGRybV9lbmNvZGVyKTsKKworCXJl
Z21hcF91cGRhdGVfYml0cyhpbnRlcmZhY2UtPmxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNWQ19QT1dF
Ul9DVFJMX1JFRywKKwkJCSAgIExPR0lDVkNfUE9XRVJfQ1RSTF9WSURFT19FTkFCTEUsCisJCQkg
ICBMT0dJQ1ZDX1BPV0VSX0NUUkxfVklERU9fRU5BQkxFKTsKKworCWlmIChpbnRlcmZhY2UtPmRy
bV9wYW5lbCkgeworCQlkcm1fcGFuZWxfcHJlcGFyZShpbnRlcmZhY2UtPmRybV9wYW5lbCk7CisK
KwkJLyogRW5jb2RlciBlbmFibGUgaXMgdG9vIGVhcmx5IHRvIGVuYWJsZSB0aGUgcGFuZWwgYW5k
IGEgd2hpdGUKKwkJICogc2NyZWVuIHdpbGwgYmUgc2VlbiBpZiB0aGUgcGFuZWwgZ2V0cyBlbmFi
bGVkIGJlZm9yZSB0aGUKKwkJICogZmlyc3QgcGFnZSBmbGlwIGlzIGRvbmUgKGFuZCBubyBvdGhl
ciBmcmFtZWJ1ZmZlcgorCQkgKiBjb25maWd1cmF0aW9uIHJlbWFpbnMgZnJvbSB0aGUgYm9vdCBz
b2Z0d2FyZSkuICovCisJCWludGVyZmFjZS0+ZHJtX3BhbmVsX2VuYWJsZWQgPSBmYWxzZTsKKwl9
Cit9CisKK3N0YXRpYyB2b2lkIGxvZ2ljdmNfZW5jb2Rlcl9kaXNhYmxlKHN0cnVjdCBkcm1fZW5j
b2RlciAqZHJtX2VuY29kZXIpCit7CisJc3RydWN0IGxvZ2ljdmNfaW50ZXJmYWNlICppbnRlcmZh
Y2UgPQorCQlsb2dpY3ZjX2ludGVyZmFjZV9mcm9tX2RybV9lbmNvZGVyKGRybV9lbmNvZGVyKTsK
KworCWlmIChpbnRlcmZhY2UtPmRybV9wYW5lbCkgeworCQlkcm1fcGFuZWxfZGlzYWJsZShpbnRl
cmZhY2UtPmRybV9wYW5lbCk7CisJCWRybV9wYW5lbF91bnByZXBhcmUoaW50ZXJmYWNlLT5kcm1f
cGFuZWwpOworCX0KK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZW5jb2Rlcl9oZWxwZXJf
ZnVuY3MgbG9naWN2Y19lbmNvZGVyX2hlbHBlcl9mdW5jcyA9IHsKKwkuZW5hYmxlCQkJPSBsb2dp
Y3ZjX2VuY29kZXJfZW5hYmxlLAorCS5kaXNhYmxlCQk9IGxvZ2ljdmNfZW5jb2Rlcl9kaXNhYmxl
LAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZW5jb2Rlcl9mdW5jcyBsb2dpY3ZjX2Vu
Y29kZXJfZnVuY3MgPSB7CisJLmRlc3Ryb3kJCT0gZHJtX2VuY29kZXJfY2xlYW51cCwKK307CisK
K3N0YXRpYyBpbnQgbG9naWN2Y19jb25uZWN0b3JfZ2V0X21vZGVzKHN0cnVjdCBkcm1fY29ubmVj
dG9yICpkcm1fY29ubmVjdG9yKQoreworCXN0cnVjdCBsb2dpY3ZjX2ludGVyZmFjZSAqaW50ZXJm
YWNlID0KKwkJbG9naWN2Y19pbnRlcmZhY2VfZnJvbV9kcm1fY29ubmVjdG9yKGRybV9jb25uZWN0
b3IpOworCisJaWYgKGludGVyZmFjZS0+ZHJtX3BhbmVsKQorCQlyZXR1cm4gZHJtX3BhbmVsX2dl
dF9tb2RlcyhpbnRlcmZhY2UtPmRybV9wYW5lbCk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGlj
IGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX2hlbHBlcl9mdW5jcyBsb2dpY3ZjX2Nvbm5lY3Rv
cl9oZWxwZXJfZnVuY3MgPSB7CisJLmdldF9tb2RlcwkJPSBsb2dpY3ZjX2Nvbm5lY3Rvcl9nZXRf
bW9kZXMsCit9OworCitzdGF0aWMgdm9pZCBsb2dpY3ZjX2Nvbm5lY3Rvcl9kZXN0cm95KHN0cnVj
dCBkcm1fY29ubmVjdG9yICpkcm1fY29ubmVjdG9yKQoreworCXN0cnVjdCBsb2dpY3ZjX2ludGVy
ZmFjZSAqaW50ZXJmYWNlID0KKwkJbG9naWN2Y19pbnRlcmZhY2VfZnJvbV9kcm1fY29ubmVjdG9y
KGRybV9jb25uZWN0b3IpOworCisJaWYgKGludGVyZmFjZS0+ZHJtX3BhbmVsKQorCQlkcm1fcGFu
ZWxfZGV0YWNoKGludGVyZmFjZS0+ZHJtX3BhbmVsKTsKKworCWRybV9jb25uZWN0b3JfY2xlYW51
cChkcm1fY29ubmVjdG9yKTsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9y
X2Z1bmNzIGxvZ2ljdmNfY29ubmVjdG9yX2Z1bmNzID0geworCS5yZXNldAkJCT0gZHJtX2F0b21p
Y19oZWxwZXJfY29ubmVjdG9yX3Jlc2V0LAorCS5maWxsX21vZGVzCQk9IGRybV9oZWxwZXJfcHJv
YmVfc2luZ2xlX2Nvbm5lY3Rvcl9tb2RlcywKKwkuZGVzdHJveQkJPSBsb2dpY3ZjX2Nvbm5lY3Rv
cl9kZXN0cm95LAorCS5hdG9taWNfZHVwbGljYXRlX3N0YXRlCT0gZHJtX2F0b21pY19oZWxwZXJf
Y29ubmVjdG9yX2R1cGxpY2F0ZV9zdGF0ZSwKKwkuYXRvbWljX2Rlc3Ryb3lfc3RhdGUJPSBkcm1f
YXRvbWljX2hlbHBlcl9jb25uZWN0b3JfZGVzdHJveV9zdGF0ZSwKK307CisKK3N0YXRpYyBpbnQg
bG9naWN2Y19pbnRlcmZhY2VfZW5jb2Rlcl90eXBlKHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2
YykKK3sKKwlzd2l0Y2ggKGxvZ2ljdmMtPmNvbmZpZy5kaXNwbGF5X2ludGVyZmFjZSkgeworCWNh
c2UgTE9HSUNWQ19ESVNQTEFZX0lOVEVSRkFDRV9MVkRTXzRCSVRTOgorCWNhc2UgTE9HSUNWQ19E
SVNQTEFZX0lOVEVSRkFDRV9MVkRTXzRCSVRTX0NBTUVSQToKKwljYXNlIExPR0lDVkNfRElTUExB
WV9JTlRFUkZBQ0VfTFZEU18zQklUUzoKKwkJcmV0dXJuIERSTV9NT0RFX0VOQ09ERVJfTFZEUzsK
KwljYXNlIExPR0lDVkNfRElTUExBWV9JTlRFUkZBQ0VfRFZJOgorCQlyZXR1cm4gRFJNX01PREVf
RU5DT0RFUl9UTURTOworCWNhc2UgTE9HSUNWQ19ESVNQTEFZX0lOVEVSRkFDRV9SR0I6CisJCXJl
dHVybiBEUk1fTU9ERV9FTkNPREVSX0RQSTsKKwlkZWZhdWx0OgorCQlyZXR1cm4gRFJNX01PREVf
RU5DT0RFUl9OT05FOworCX0KK30KKworc3RhdGljIGludCBsb2dpY3ZjX2ludGVyZmFjZV9jb25u
ZWN0b3JfdHlwZShzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMpCit7CisJc3dpdGNoIChsb2dp
Y3ZjLT5jb25maWcuZGlzcGxheV9pbnRlcmZhY2UpIHsKKwljYXNlIExPR0lDVkNfRElTUExBWV9J
TlRFUkZBQ0VfTFZEU180QklUUzoKKwljYXNlIExPR0lDVkNfRElTUExBWV9JTlRFUkZBQ0VfTFZE
U180QklUU19DQU1FUkE6CisJY2FzZSBMT0dJQ1ZDX0RJU1BMQVlfSU5URVJGQUNFX0xWRFNfM0JJ
VFM6CisJCXJldHVybiBEUk1fTU9ERV9DT05ORUNUT1JfTFZEUzsKKwljYXNlIExPR0lDVkNfRElT
UExBWV9JTlRFUkZBQ0VfRFZJOgorCQlyZXR1cm4gRFJNX01PREVfQ09OTkVDVE9SX0RWSUQ7CisJ
Y2FzZSBMT0dJQ1ZDX0RJU1BMQVlfSU5URVJGQUNFX1JHQjoKKwkJcmV0dXJuIERSTV9NT0RFX0NP
Tk5FQ1RPUl9EUEk7CisJZGVmYXVsdDoKKwkJcmV0dXJuIERSTV9NT0RFX0NPTk5FQ1RPUl9Vbmtu
b3duOworCX0KK30KKworc3RhdGljIGJvb2wgbG9naWN2Y19pbnRlcmZhY2VfbmF0aXZlX2Nvbm5l
Y3RvcihzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMpCit7CisJc3dpdGNoIChsb2dpY3ZjLT5j
b25maWcuZGlzcGxheV9pbnRlcmZhY2UpIHsKKwljYXNlIExPR0lDVkNfRElTUExBWV9JTlRFUkZB
Q0VfRFZJOgorCQlyZXR1cm4gdHJ1ZTsKKwlkZWZhdWx0OgorCQlyZXR1cm4gZmFsc2U7CisJfQor
fQorCit2b2lkIGxvZ2ljdmNfaW50ZXJmYWNlX2F0dGFjaF9jcnRjKHN0cnVjdCBsb2dpY3ZjX2Ry
bSAqbG9naWN2YykKK3sKKwl1aW50MzJfdCBwb3NzaWJsZV9jcnRjcyA9IGRybV9jcnRjX21hc2so
JmxvZ2ljdmMtPmNydGMtPmRybV9jcnRjKTsKKworCWxvZ2ljdmMtPmludGVyZmFjZS0+ZHJtX2Vu
Y29kZXIucG9zc2libGVfY3J0Y3MgPSBwb3NzaWJsZV9jcnRjczsKK30KKworaW50IGxvZ2ljdmNf
aW50ZXJmYWNlX2luaXQoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjKQoreworCXN0cnVjdCBs
b2dpY3ZjX2ludGVyZmFjZSAqaW50ZXJmYWNlOworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqb2Zfbm9k
ZSA9IGxvZ2ljdmMtPmRybS0+ZGV2LT5vZl9ub2RlOworCWludCBlbmNvZGVyX3R5cGUgPSBsb2dp
Y3ZjX2ludGVyZmFjZV9lbmNvZGVyX3R5cGUobG9naWN2Yyk7CisJaW50IGNvbm5lY3Rvcl90eXBl
ID0gbG9naWN2Y19pbnRlcmZhY2VfY29ubmVjdG9yX3R5cGUobG9naWN2Yyk7CisJYm9vbCBuYXRp
dmVfY29ubmVjdG9yID0gbG9naWN2Y19pbnRlcmZhY2VfbmF0aXZlX2Nvbm5lY3Rvcihsb2dpY3Zj
KTsKKwlpbnQgcmV0OworCisJaW50ZXJmYWNlID0gZGV2bV9remFsbG9jKGxvZ2ljdmMtPmRybS0+
ZGV2LCBzaXplb2YoKmludGVyZmFjZSksCisJCQkJIEdGUF9LRVJORUwpOworCWlmICghaW50ZXJm
YWNlKSB7CisJCXJldCA9IC1FTk9NRU07CisJCWdvdG8gZXJyb3JfZWFybHk7CisJfQorCisJaW50
ZXJmYWNlLT5sb2dpY3ZjID0gbG9naWN2YzsKKworCXJldCA9IGRybV9vZl9maW5kX3BhbmVsX29y
X2JyaWRnZShvZl9ub2RlLCAxLCAwLCAmaW50ZXJmYWNlLT5kcm1fcGFuZWwsCisJCQkJCSAgJmlu
dGVyZmFjZS0+ZHJtX2JyaWRnZSk7CisJaWYgKHJldCA9PSAtRVBST0JFX0RFRkVSKQorCQlnb3Rv
IGVycm9yX2Vhcmx5OworCisJcmV0ID0gZHJtX2VuY29kZXJfaW5pdChsb2dpY3ZjLT5kcm0sICZp
bnRlcmZhY2UtPmRybV9lbmNvZGVyLAorCQkJICAgICAgICZsb2dpY3ZjX2VuY29kZXJfZnVuY3Ms
IGVuY29kZXJfdHlwZSwgTlVMTCk7CisJaWYgKHJldCkgeworCQlEUk1fRVJST1IoIkZhaWxlZCB0
byBpbml0YWxpemUgZW5jb2RlclxuIik7CisJCWdvdG8gZXJyb3JfZWFybHk7CisJfQorCisJZHJt
X2VuY29kZXJfaGVscGVyX2FkZCgmaW50ZXJmYWNlLT5kcm1fZW5jb2RlciwKKwkJCSAgICAgICAm
bG9naWN2Y19lbmNvZGVyX2hlbHBlcl9mdW5jcyk7CisKKwlpZiAobmF0aXZlX2Nvbm5lY3RvciB8
fCBpbnRlcmZhY2UtPmRybV9wYW5lbCkgeworCQlyZXQgPSBkcm1fY29ubmVjdG9yX2luaXQobG9n
aWN2Yy0+ZHJtLAorCQkJCQkgJmludGVyZmFjZS0+ZHJtX2Nvbm5lY3RvciwKKwkJCQkJICZsb2dp
Y3ZjX2Nvbm5lY3Rvcl9mdW5jcywKKwkJCQkJIGNvbm5lY3Rvcl90eXBlKTsKKwkJaWYgKHJldCkg
eworCQkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gaW5pdGFsaXplIGNvbm5lY3RvclxuIik7CisJCQln
b3RvIGVycm9yX2VuY29kZXI7CisJCX0KKworCQlkcm1fY29ubmVjdG9yX2hlbHBlcl9hZGQoJmlu
dGVyZmFjZS0+ZHJtX2Nvbm5lY3RvciwKKwkJCQkJICZsb2dpY3ZjX2Nvbm5lY3Rvcl9oZWxwZXJf
ZnVuY3MpOworCisJCXJldCA9IGRybV9jb25uZWN0b3JfYXR0YWNoX2VuY29kZXIoJmludGVyZmFj
ZS0+ZHJtX2Nvbm5lY3RvciwKKwkJCQkJCSAgICZpbnRlcmZhY2UtPmRybV9lbmNvZGVyKTsKKwkJ
aWYgKHJldCkgeworCQkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gYXR0YWNoIGNvbm5lY3RvciB0byBl
bmNvZGVyXG4iKTsKKwkJCWdvdG8gZXJyb3JfZW5jb2RlcjsKKwkJfQorCX0KKworCWlmIChpbnRl
cmZhY2UtPmRybV9wYW5lbCkgeworCQlyZXQgPSBkcm1fcGFuZWxfYXR0YWNoKGludGVyZmFjZS0+
ZHJtX3BhbmVsLAorCQkJCSAgICAgICAmaW50ZXJmYWNlLT5kcm1fY29ubmVjdG9yKTsKKwkJaWYg
KHJldCkgeworCQkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gYXR0YWNoIHBhbmVsIHRvIGNvbm5lY3Rv
clxuIik7CisJCQlnb3RvIGVycm9yX2VuY29kZXI7CisJCX0KKwl9CisKKwlpZiAoaW50ZXJmYWNl
LT5kcm1fYnJpZGdlKSB7CisJCXJldCA9IGRybV9icmlkZ2VfYXR0YWNoKCZpbnRlcmZhY2UtPmRy
bV9lbmNvZGVyLAorCQkJCQlpbnRlcmZhY2UtPmRybV9icmlkZ2UsIE5VTEwpOworCQlpZiAocmV0
KSB7CisJCQlEUk1fRVJST1IoIkZhaWxlZCB0byBhdHRhY2ggYnJpZGdlIHRvIGVuY29kZXJcbiIp
OworCQkJZ290byBlcnJvcl9lbmNvZGVyOworCQl9CisJfQorCisJbG9naWN2Yy0+aW50ZXJmYWNl
ID0gaW50ZXJmYWNlOworCisJcmV0dXJuIDA7CisKK2Vycm9yX2VuY29kZXI6CisJZHJtX2VuY29k
ZXJfY2xlYW51cCgmaW50ZXJmYWNlLT5kcm1fZW5jb2Rlcik7CisKK2Vycm9yX2Vhcmx5OgorCXJl
dHVybiByZXQ7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3Zj
X2ludGVyZmFjZS5oIGIvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19pbnRlcmZhY2Uu
aApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmQyN2FiZmZmOTI5Zgot
LS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfaW50ZXJm
YWNlLmgKQEAgLTAsMCArMSwzMiBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0y
LjArICovCisvKgorICogQ29weXJpZ2h0IChDKSAyMDE5IEJvb3RsaW4KKyAqIEF1dGhvcjogUGF1
bCBLb2NpYWxrb3dza2kgPHBhdWwua29jaWFsa293c2tpQGJvb3RsaW4uY29tPgorICovCisKKyNp
Zm5kZWYgX0xPR0lDVkNfSU5URVJGQUNFX0hfCisjZGVmaW5lIF9MT0dJQ1ZDX0lOVEVSRkFDRV9I
XworCisjaW5jbHVkZSA8ZHJtL2RybV9icmlkZ2UuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2Nvbm5l
Y3Rvci5oPgorI2luY2x1ZGUgPGRybS9kcm1fZW5jb2Rlci5oPgorI2luY2x1ZGUgPGRybS9kcm1f
cGFuZWwuaD4KKworc3RydWN0IGxvZ2ljdmNfZHJtOworCitzdHJ1Y3QgbG9naWN2Y19pbnRlcmZh
Y2UgeworCXN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YzsKKworCXN0cnVjdCBkcm1fZW5jb2Rl
ciBkcm1fZW5jb2RlcjsKKwlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciBkcm1fY29ubmVjdG9yOworCisJ
c3RydWN0IGRybV9wYW5lbCAqZHJtX3BhbmVsOworCXN0cnVjdCBkcm1fYnJpZGdlICpkcm1fYnJp
ZGdlOworCisJYm9vbCBkcm1fcGFuZWxfZW5hYmxlZDsKK307CisKK3ZvaWQgbG9naWN2Y19pbnRl
cmZhY2VfYXR0YWNoX2NydGMoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjKTsKK2ludCBsb2dp
Y3ZjX2ludGVyZmFjZV9pbml0KHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2Yyk7CisKKyNlbmRp
ZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19sYXllci5jIGIv
ZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19sYXllci5jCm5ldyBmaWxlIG1vZGUgMTAw
NjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uYzdiMDkyZDU5MmFkCi0tLSAvZGV2L251bGwKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19sYXllci5jCkBAIC0wLDAgKzEsNTk0IEBA
CisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCsKKy8qCisgKiBDb3B5cmlnaHQg
KEMpIDIwMTkgQm9vdGxpbgorICogQXV0aG9yOiBQYXVsIEtvY2lhbGtvd3NraSA8cGF1bC5rb2Np
YWxrb3dza2lAYm9vdGxpbi5jb20+CisgKi8KKworI2luY2x1ZGUgPGxpbnV4L29mLmg+CisjaW5j
bHVkZSA8bGludXgvdHlwZXMuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pYy5oPgorI2luY2x1
ZGUgPGRybS9kcm1fYXRvbWljX2hlbHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fZmJfY21hX2hl
bHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fZm91cmNjLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9w
bGFuZS5oPgorI2luY2x1ZGUgPGRybS9kcm1fcGxhbmVfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJt
L2RybV9wcmludC5oPgorCisjaW5jbHVkZSAibG9naWN2Y19jcnRjLmgiCisjaW5jbHVkZSAibG9n
aWN2Y19kcm0uaCIKKyNpbmNsdWRlICJsb2dpY3ZjX2xheWVyLmgiCisjaW5jbHVkZSAibG9naWN2
Y19vZi5oIgorI2luY2x1ZGUgImxvZ2ljdmNfcmVncy5oIgorCisjZGVmaW5lIGxvZ2ljdmNfbGF5
ZXIocCkgXAorCWNvbnRhaW5lcl9vZihwLCBzdHJ1Y3QgbG9naWN2Y19sYXllciwgZHJtX3BsYW5l
KQorCitzdGF0aWMgdWludDMyX3QgbG9naWN2Y19sYXllcl9mb3JtYXRzX3JnYjE2W10gPSB7CisJ
RFJNX0ZPUk1BVF9SR0I1NjUsCisJRFJNX0ZPUk1BVF9CR1I1NjUsCisJRFJNX0ZPUk1BVF9JTlZB
TElELAorfTsKKworc3RhdGljIHVpbnQzMl90IGxvZ2ljdmNfbGF5ZXJfZm9ybWF0c19yZ2IyNFtd
ID0geworCURSTV9GT1JNQVRfWFJHQjg4ODgsCisJRFJNX0ZPUk1BVF9YQkdSODg4OCwKKwlEUk1f
Rk9STUFUX0lOVkFMSUQsCit9OworCisvKiBXaGF0IHdlIGNhbGwgZGVwdGggaW4gdGhpcyBkcml2
ZXIgb25seSBjb3VudHMgY29sb3IgY29tcG9uZW50cywgbm90IGFscGhhLgorICogVGhpcyBhbGxv
d3MgdXMgdG8gc3RheSBjb21wYXRpYmxlIHdpdGggdGhlIExvZ2lDVkMgYmlzdHJlYW0gZGVmaW5p
dGlvbnMuICovCitzdGF0aWMgdWludDMyX3QgbG9naWN2Y19sYXllcl9mb3JtYXRzX3JnYjI0X2Fs
cGhhW10gPSB7CisJRFJNX0ZPUk1BVF9BUkdCODg4OCwKKwlEUk1fRk9STUFUX0FCR1I4ODg4LAor
CURSTV9GT1JNQVRfSU5WQUxJRCwKK307CisKK3N0YXRpYyBzdHJ1Y3QgbG9naWN2Y19sYXllcl9m
b3JtYXRzIGxvZ2ljdmNfbGF5ZXJfZm9ybWF0c1tdID0geworCXsKKwkJLmNvbG9yc3BhY2UJPSBM
T0dJQ1ZDX0xBWUVSX0NPTE9SU1BBQ0VfUkdCLAorCQkuZGVwdGgJCT0gMTYsCisJCS5mb3JtYXRz
CT0gbG9naWN2Y19sYXllcl9mb3JtYXRzX3JnYjE2LAorCX0sCisJeworCQkuY29sb3JzcGFjZQk9
IExPR0lDVkNfTEFZRVJfQ09MT1JTUEFDRV9SR0IsCisJCS5kZXB0aAkJPSAyNCwKKwkJLmZvcm1h
dHMJPSBsb2dpY3ZjX2xheWVyX2Zvcm1hdHNfcmdiMjQsCisJfSwKKwl7CisJCS5jb2xvcnNwYWNl
CT0gTE9HSUNWQ19MQVlFUl9DT0xPUlNQQUNFX1JHQiwKKwkJLmRlcHRoCQk9IDI0LAorCQkuYWxw
aGEJCT0gdHJ1ZSwKKwkJLmZvcm1hdHMJPSBsb2dpY3ZjX2xheWVyX2Zvcm1hdHNfcmdiMjRfYWxw
aGEsCisJfSwKKwl7IH0KK307CisKK3N0YXRpYyBib29sIGxvZ2ljdmNfbGF5ZXJfZm9ybWF0X2lu
dmVydGVkKHVpbnQzMl90IGZvcm1hdCkKK3sKKwlzd2l0Y2ggKGZvcm1hdCkgeworCWNhc2UgRFJN
X0ZPUk1BVF9CR1I1NjU6CisJY2FzZSBEUk1fRk9STUFUX0JHUjg4ODoKKwljYXNlIERSTV9GT1JN
QVRfWEJHUjg4ODg6CisJY2FzZSBEUk1fRk9STUFUX0FCR1I4ODg4OgorCQlyZXR1cm4gdHJ1ZTsK
KwlkZWZhdWx0OgorCQlyZXR1cm4gZmFsc2U7CisJfQorfQorCitzdGF0aWMgaW50IGxvZ2ljdmNf
cGxhbmVfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fcGxhbmUgKmRybV9wbGFuZSwKKwkJCQkgICAg
ICBzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpzdGF0ZSkKK3sKKwlzdHJ1Y3QgbG9naWN2Y19sYXll
ciAqbGF5ZXIgPSBsb2dpY3ZjX2xheWVyKGRybV9wbGFuZSk7CisJc3RydWN0IGxvZ2ljdmNfZHJt
ICpsb2dpY3ZjID0gbGF5ZXItPmxvZ2ljdmM7CisJc3RydWN0IGRybV9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlOworCWludCBtaW5fc2NhbGUsIG1heF9zY2FsZTsKKwlib29sIGNhbl9wb3NpdGlvbjsK
KwlpbnQgcmV0OworCisJaWYgKCFzdGF0ZS0+Y3J0YykKKwkJcmV0dXJuIDA7CisKKwljcnRjX3N0
YXRlID0gZHJtX2F0b21pY19nZXRfZXhpc3RpbmdfY3J0Y19zdGF0ZShzdGF0ZS0+c3RhdGUsCisJ
CQkJCQkJc3RhdGUtPmNydGMpOworCWlmIChXQVJOX09OKCFjcnRjX3N0YXRlKSkKKwkJcmV0dXJu
IC1FSU5WQUw7CisKKwlpZiAoc3RhdGUtPmNydGNfeCA8IDAgfHwgc3RhdGUtPmNydGNfeSA8IDAp
IHsKKwkJRFJNX0VSUk9SKCJOZWdhdGl2ZSBvbi1DUlRDIHBvc2l0aW9ucyBhcmUgbm90IHN1cHBv
cnRlZC5cbiIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlpZiAoIWxvZ2ljdmMtPmNhcHMt
PmxheWVyX2FkZHJlc3MpIHsKKwkJcmV0ID0gbG9naWN2Y19sYXllcl9idWZmZXJfZmluZF9zZXR1
cChsYXllciwgc3RhdGUsIE5VTEwpOworCQlpZiAocmV0KSB7CisJCQlEUk1fRVJST1IoIk5vIHZp
YWJsZSBzZXR1cCBmb3IgYnVmZmVyIGZvdW5kLlxuIik7CisJCQlyZXR1cm4gcmV0OworCQl9CisJ
fQorCisJbWluX3NjYWxlID0gRFJNX1BMQU5FX0hFTFBFUl9OT19TQ0FMSU5HOworCW1heF9zY2Fs
ZSA9IERSTV9QTEFORV9IRUxQRVJfTk9fU0NBTElORzsKKworCWNhbl9wb3NpdGlvbiA9IChkcm1f
cGxhbmUtPnR5cGUgPT0gRFJNX1BMQU5FX1RZUEVfT1ZFUkxBWSAmJgorCQkJbGF5ZXItPmluZGV4
ICE9IChsb2dpY3ZjLT5jb25maWcubGF5ZXJzX2NvdW50IC0gMSkgJiYKKwkJCWxvZ2ljdmMtPmNv
bmZpZy5sYXllcnNfY29uZmlndXJhYmxlKTsKKworCXJldCA9IGRybV9hdG9taWNfaGVscGVyX2No
ZWNrX3BsYW5lX3N0YXRlKHN0YXRlLCBjcnRjX3N0YXRlLAorCQkJCQkJICBtaW5fc2NhbGUsIG1h
eF9zY2FsZSwKKwkJCQkJCSAgY2FuX3Bvc2l0aW9uLCB0cnVlKTsKKwlpZiAocmV0KSB7CisJCURS
TV9FUlJPUigiSW52YWxpZCBwbGFuZSBzdGF0ZVxuXG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgbG9naWN2Y19wbGFuZV9hdG9taWNfdXBkYXRl
KHN0cnVjdCBkcm1fcGxhbmUgKmRybV9wbGFuZSwKKwkJCQkJc3RydWN0IGRybV9wbGFuZV9zdGF0
ZSAqb2xkX3N0YXRlKQoreworCXN0cnVjdCBsb2dpY3ZjX2xheWVyICpsYXllciA9IGxvZ2ljdmNf
bGF5ZXIoZHJtX3BsYW5lKTsKKwlzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMgPSBsYXllci0+
bG9naWN2YzsKKwlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpzdGF0ZSA9IGRybV9wbGFuZS0+c3Rh
dGU7CisJc3RydWN0IGRybV9jcnRjICpkcm1fY3J0YyA9ICZsb2dpY3ZjLT5jcnRjLT5kcm1fY3J0
YzsKKwlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSA9ICZkcm1fY3J0Yy0+c3RhdGUtPmFk
anVzdGVkX21vZGU7CisJc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBzdGF0ZS0+ZmI7CisJ
c3RydWN0IGxvZ2ljdmNfbGF5ZXJfYnVmZmVyX3NldHVwIHNldHVwID0ge307CisJdTMyIGluZGV4
ID0gbGF5ZXItPmluZGV4OworCXUzMiByZWc7CisKKwkvKiBMYXllciBkaW1lbnNpb25zICovCisK
KwlyZWdtYXBfd3JpdGUobG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZDX0xBWUVSX1dJRFRIX1JFRyhp
bmRleCksCisJCSAgICAgc3RhdGUtPmNydGNfdyAtIDEpOworCXJlZ21hcF93cml0ZShsb2dpY3Zj
LT5yZWdtYXAsIExPR0lDVkNfTEFZRVJfSEVJR0hUX1JFRyhpbmRleCksCisJCSAgICAgc3RhdGUt
PmNydGNfaCAtIDEpOworCisJaWYgKGxvZ2ljdmMtPmNhcHMtPmxheWVyX2FkZHJlc3MpIHsKKwkJ
cGh5c19hZGRyX3QgZmJfYWRkciA9IGRybV9mYl9jbWFfZ2V0X2dlbV9hZGRyKGZiLCBzdGF0ZSwg
MCk7CisKKwkJcmVnbWFwX3dyaXRlKGxvZ2ljdmMtPnJlZ21hcCwgTE9HSUNWQ19MQVlFUl9BRERS
RVNTX1JFRyhpbmRleCksCisJCQkgICAgIGZiX2FkZHIpOworCX0gZWxzZSB7CisJCS8qIFJlbHkg
b24gb2Zmc2V0cyB0byBjb25maWd1cmUgdGhlIGFkZHJlc3MuICovCisKKwkJbG9naWN2Y19sYXll
cl9idWZmZXJfZmluZF9zZXR1cChsYXllciwgc3RhdGUsICZzZXR1cCk7CisKKwkJLyogTGF5ZXIg
bWVtb3J5IG9mZnNldHMgKi8KKworCQlyZWdtYXBfd3JpdGUobG9naWN2Yy0+cmVnbWFwLCBMT0dJ
Q1ZDX0JVRkZFUl9TRUxfUkVHLAorCQkJICAgICBMT0dJQ1ZDX0JVRkZFUl9TRUxfVkFMVUUoaW5k
ZXgsIHNldHVwLmJ1ZmZlcl9zZWwpKTsKKwkJcmVnbWFwX3dyaXRlKGxvZ2ljdmMtPnJlZ21hcCwg
TE9HSUNWQ19MQVlFUl9IT0ZGU0VUX1JFRyhpbmRleCksCisJCQkgICAgIHNldHVwLmhvZmZzZXQp
OworCQlyZWdtYXBfd3JpdGUobG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZDX0xBWUVSX1ZPRkZTRVRf
UkVHKGluZGV4KSwKKwkJCSAgICAgc2V0dXAudm9mZnNldCk7CisJfQorCisJLyogTGF5ZXIgcG9z
aXRpb24gKi8KKworCXJlZ21hcF93cml0ZShsb2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNfTEFZRVJf
SFBPU0lUSU9OX1JFRyhpbmRleCksCisJCSAgICAgbW9kZS0+aGRpc3BsYXkgLSAxIC0gc3RhdGUt
PmNydGNfeCk7CisKKwkvKiBWZXJ0aWNhbCBwb3NpdGlvbiBtdXN0IGJlIHNldCBsYXN0IHRvIHN5
bmMgbGF5ZXIgcmVnaXN0ZXIgY2hhbmdlcy4gKi8KKwlyZWdtYXBfd3JpdGUobG9naWN2Yy0+cmVn
bWFwLCBMT0dJQ1ZDX0xBWUVSX1ZQT1NJVElPTl9SRUcoaW5kZXgpLAorCQkgICAgIG1vZGUtPnZk
aXNwbGF5IC0gMSAtIHN0YXRlLT5jcnRjX3kpOworCisJLyogTGF5ZXIgYWxwaGEgKi8KKworCWlm
IChsYXllci0+Y29uZmlnLmFscGhhX21vZGUgPT0gTE9HSUNWQ19MQVlFUl9BTFBIQV9MQVlFUikg
eworCQl1MzIgYWxwaGFfYml0czsKKwkJdTMyIGFscGhhX21heDsKKwkJdTMyIGFscGhhOworCisJ
CXN3aXRjaCAobGF5ZXItPmNvbmZpZy5kZXB0aCkgeworCQljYXNlIDg6CisJCQlhbHBoYV9iaXRz
ID0gMzsKKwkJCWJyZWFrOworCQljYXNlIDE2OgorCQkJaWYgKGxheWVyLT5jb25maWcuY29sb3Jz
cGFjZSA9PSBMT0dJQ1ZDX0xBWUVSX0NPTE9SU1BBQ0VfWVVWKQorCQkJCWFscGhhX2JpdHMgPSA4
OworCQkJZWxzZQorCQkJCWFscGhhX2JpdHMgPSA2OworCQkJYnJlYWs7CisJCWRlZmF1bHQ6CisJ
CQlhbHBoYV9iaXRzID0gODsKKwkJCWJyZWFrOworCQl9CisKKwkJYWxwaGFfbWF4ID0gQklUKGFs
cGhhX2JpdHMpIC0gMTsKKwkJYWxwaGEgPSBzdGF0ZS0+YWxwaGEgKiBhbHBoYV9tYXggLyBEUk1f
QkxFTkRfQUxQSEFfT1BBUVVFOworCisJCURSTV9ERUJVR19EUklWRVIoIlNldHRpbmcgbGF5ZXIg
JWQgYWxwaGEgdG8gJWQvJWRcbiIsIGluZGV4LAorCQkJCSBhbHBoYSwgYWxwaGFfbWF4KTsKKwor
CQlyZWdtYXBfd3JpdGUobG9naWN2Yy0+cmVnbWFwLCBMT0dJQ1ZDX0xBWUVSX0FMUEhBX1JFRyhp
bmRleCksCisJCQkgICAgIGFscGhhKTsKKwl9CisKKwkvKiBMYXllciBjb250cm9sICovCisKKwly
ZWcgPSBMT0dJQ1ZDX0xBWUVSX0NUUkxfRU5BQkxFOworCisJaWYgKGxvZ2ljdmNfbGF5ZXJfZm9y
bWF0X2ludmVydGVkKGZiLT5mb3JtYXQtPmZvcm1hdCkpCisJCXJlZyB8PSBMT0dJQ1ZDX0xBWUVS
X0NUUkxfUElYRUxfRk9STUFUX0lOVkVSVDsKKworCXJlZyB8PSBMT0dJQ1ZDX0xBWUVSX0NUUkxf
Q09MT1JfS0VZX0RJU0FCTEU7CisKKwlyZWdtYXBfd3JpdGUobG9naWN2Yy0+cmVnbWFwLCBMT0dJ
Q1ZDX0xBWUVSX0NUUkxfUkVHKGluZGV4KSwgcmVnKTsKK30KKworc3RhdGljIHZvaWQgbG9naWN2
Y19wbGFuZV9hdG9taWNfZGlzYWJsZShzdHJ1Y3QgZHJtX3BsYW5lICpkcm1fcGxhbmUsCisJCQkJ
CSBzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpvbGRfc3RhdGUpCit7CisJc3RydWN0IGxvZ2ljdmNf
bGF5ZXIgKmxheWVyID0gbG9naWN2Y19sYXllcihkcm1fcGxhbmUpOworCXN0cnVjdCBsb2dpY3Zj
X2RybSAqbG9naWN2YyA9IGxheWVyLT5sb2dpY3ZjOworCXUzMiBpbmRleCA9IGxheWVyLT5pbmRl
eDsKKworCXJlZ21hcF93cml0ZShsb2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNfTEFZRVJfQ1RSTF9S
RUcoaW5kZXgpLCAwKTsKK30KKworc3RhdGljIHN0cnVjdCBkcm1fcGxhbmVfaGVscGVyX2Z1bmNz
IGxvZ2ljdmNfcGxhbmVfaGVscGVyX2Z1bmNzID0geworCS5hdG9taWNfY2hlY2sJCT0gbG9naWN2
Y19wbGFuZV9hdG9taWNfY2hlY2ssCisJLmF0b21pY191cGRhdGUJCT0gbG9naWN2Y19wbGFuZV9h
dG9taWNfdXBkYXRlLAorCS5hdG9taWNfZGlzYWJsZQkJPSBsb2dpY3ZjX3BsYW5lX2F0b21pY19k
aXNhYmxlLAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfZnVuY3MgbG9naWN2
Y19wbGFuZV9mdW5jcyA9IHsKKwkudXBkYXRlX3BsYW5lCQk9IGRybV9hdG9taWNfaGVscGVyX3Vw
ZGF0ZV9wbGFuZSwKKwkuZGlzYWJsZV9wbGFuZQkJPSBkcm1fYXRvbWljX2hlbHBlcl9kaXNhYmxl
X3BsYW5lLAorCS5kZXN0cm95CQk9IGRybV9wbGFuZV9jbGVhbnVwLAorCS5yZXNldAkJCT0gZHJt
X2F0b21pY19oZWxwZXJfcGxhbmVfcmVzZXQsCisJLmF0b21pY19kdXBsaWNhdGVfc3RhdGUJPSBk
cm1fYXRvbWljX2hlbHBlcl9wbGFuZV9kdXBsaWNhdGVfc3RhdGUsCisJLmF0b21pY19kZXN0cm95
X3N0YXRlCT0gZHJtX2F0b21pY19oZWxwZXJfcGxhbmVfZGVzdHJveV9zdGF0ZSwKK307CisKK2lu
dCBsb2dpY3ZjX2xheWVyX2J1ZmZlcl9maW5kX3NldHVwKHN0cnVjdCBsb2dpY3ZjX2xheWVyICps
YXllciwKKwkJCQkgICAgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqc3RhdGUsCisJCQkJICAgIHN0
cnVjdCBsb2dpY3ZjX2xheWVyX2J1ZmZlcl9zZXR1cCAqc2V0dXApCit7CisJc3RydWN0IGxvZ2lj
dmNfZHJtICpsb2dpY3ZjID0gbGF5ZXItPmxvZ2ljdmM7CisJc3RydWN0IGRybV9mcmFtZWJ1ZmZl
ciAqZmIgPSBzdGF0ZS0+ZmI7CisJLyogQWxsIHRoZSBzdXBwb3J0ZWQgZm9ybWF0cyBoYXZlIGEg
c2luZ2xlIGRhdGEgcGxhbmUuICovCisJdTMyIGxheWVyX2J5dGVzcHAgPSBmYi0+Zm9ybWF0LT5j
cHBbMF07CisJdTMyIGxheWVyX3N0cmlkZSA9IGxheWVyX2J5dGVzcHAgKiBsb2dpY3ZjLT5jb25m
aWcucm93X3N0cmlkZTsKKwl1MzIgYmFzZV9vZmZzZXQgPSBsYXllci0+Y29uZmlnLmJhc2Vfb2Zm
c2V0ICogbGF5ZXJfc3RyaWRlOworCXUzMiBidWZmZXJfb2Zmc2V0ID0gbGF5ZXItPmNvbmZpZy5i
dWZmZXJfb2Zmc2V0ICogbGF5ZXJfc3RyaWRlOworCXU4IGJ1ZmZlcl9zZWwgPSAwOworCXUxNiB2
b2Zmc2V0ID0gMDsKKwl1MTYgaG9mZnNldCA9IDA7CisJcGh5c19hZGRyX3QgZmJfYWRkcjsKKwl1
MzIgZmJfb2Zmc2V0OworCXUzMiBnYXA7CisKKwlpZiAoIWxvZ2ljdmMtPnJlc2VydmVkX21lbV9i
YXNlKSB7CisJCURSTV9FUlJPUigiTm8gcmVzZXJ2ZWQgbWVtb3J5IGJhc2Ugd2FzIHJlZ2lzdGVy
ZWQhXG4iKTsKKwkJcmV0dXJuIC1FTk9NRU07CisJfQorCisJZmJfYWRkciA9IGRybV9mYl9jbWFf
Z2V0X2dlbV9hZGRyKGZiLCBzdGF0ZSwgMCk7CisJaWYgKGZiX2FkZHIgPCBsb2dpY3ZjLT5yZXNl
cnZlZF9tZW1fYmFzZSkgeworCQlEUk1fRVJST1IoIkZyYW1lYnVmZmVyIG1lbW9yeSBiZWxvdyBy
ZXNlcnZlZCBtZW1vcnkgYmFzZSFcbiIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlmYl9v
ZmZzZXQgPSAodTMyKSAoZmJfYWRkciAtIGxvZ2ljdmMtPnJlc2VydmVkX21lbV9iYXNlKTsKKwor
CWlmIChmYl9vZmZzZXQgPCBiYXNlX29mZnNldCkgeworCQlEUk1fRVJST1IoIkZyYW1lYnVmZmVy
IG9mZnNldCBiZWxvdyBsYXllciBiYXNlIG9mZnNldCFcbiIpOworCQlyZXR1cm4gLUVJTlZBTDsK
Kwl9CisKKwlnYXAgPSBmYl9vZmZzZXQgLSBiYXNlX29mZnNldDsKKworCS8qIFVzZSB0aGUgcG9z
c2libGUgdmlkZW8gYnVmZmVycyBzZWxlY3Rpb24uICovCisJaWYgKGdhcCAmJiBidWZmZXJfb2Zm
c2V0KSB7CisJCWJ1ZmZlcl9zZWwgPSBnYXAgLyBidWZmZXJfb2Zmc2V0OworCQlpZiAoYnVmZmVy
X3NlbCA+IExPR0lDVkNfQlVGRkVSX1NFTF9NQVgpCisJCQlidWZmZXJfc2VsID0gTE9HSUNWQ19C
VUZGRVJfU0VMX01BWDsKKworCQlnYXAgLT0gYnVmZmVyX3NlbCAqIGJ1ZmZlcl9vZmZzZXQ7CisJ
fQorCisJLyogVXNlIHRoZSB2ZXJ0aWNhbCBvZmZzZXQuICovCisJaWYgKGdhcCAmJiBsYXllcl9z
dHJpZGUgJiYgbG9naWN2Yy0+Y29uZmlnLmxheWVyc19jb25maWd1cmFibGUpIHsKKwkJdm9mZnNl
dCA9IGdhcCAvIGxheWVyX3N0cmlkZTsKKwkJaWYgKHZvZmZzZXQgPiBMT0dJQ1ZDX0xBWUVSX1ZP
RkZTRVRfTUFYKQorCQkJdm9mZnNldCA9IExPR0lDVkNfTEFZRVJfVk9GRlNFVF9NQVg7CisKKwkJ
Z2FwIC09IHZvZmZzZXQgKiBsYXllcl9zdHJpZGU7CisJfQorCisJLyogVXNlIHRoZSBob3Jpem9u
dGFsIG9mZnNldC4gKi8KKwlpZiAoZ2FwICYmIGxheWVyX2J5dGVzcHAgJiYgbG9naWN2Yy0+Y29u
ZmlnLmxheWVyc19jb25maWd1cmFibGUpIHsKKwkJaG9mZnNldCA9IGdhcCAvIGxheWVyX2J5dGVz
cHA7CisJCWlmIChob2Zmc2V0ID4gTE9HSUNWQ19ESU1FTlNJT05TX01BWCkKKwkJCWhvZmZzZXQg
PSBMT0dJQ1ZDX0RJTUVOU0lPTlNfTUFYOworCisJCWdhcCAtPSBob2Zmc2V0ICogbGF5ZXJfYnl0
ZXNwcDsKKwl9CisKKwlpZiAoZ2FwKSB7CisJCURSTV9FUlJPUigiVW5hYmxlIHRvIGZpbmQgbGF5
ZXIgJWQgYnVmZmVyIHNldHVwIGZvciAweCV4IGJ5dGUgZ2FwXG4iLAorCQkJICBsYXllci0+aW5k
ZXgsIGZiX29mZnNldCAtIGJhc2Vfb2Zmc2V0KTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJ
RFJNX0RFQlVHX0RSSVZFUigiRm91bmQgbGF5ZXIgJWQgYnVmZmVyIHNldHVwIGZvciAweCV4IGJ5
dGUgZ2FwOlxuIiwKKwkJCSBsYXllci0+aW5kZXgsIGZiX29mZnNldCAtIGJhc2Vfb2Zmc2V0KTsK
KworCURSTV9ERUJVR19EUklWRVIoIi0gYnVmZmVyX3NlbCA9IDB4JXggY2h1bmtzIG9mIDB4JXgg
Ynl0ZXNcbiIsCisJCQkgYnVmZmVyX3NlbCwgYnVmZmVyX29mZnNldCk7CisJRFJNX0RFQlVHX0RS
SVZFUigiLSB2b2Zmc2V0ID0gMHgleCBjaHVua3Mgb2YgMHgleCBieXRlc1xuIiwgdm9mZnNldCwK
KwkJCSBsYXllcl9zdHJpZGUpOworCURSTV9ERUJVR19EUklWRVIoIi0gaG9mZnNldCA9IDB4JXgg
Y2h1bmtzIG9mIDB4JXggYnl0ZXNcbiIsIGhvZmZzZXQsCisJCQkgbGF5ZXJfYnl0ZXNwcCk7CisK
KwlpZiAoc2V0dXApIHsKKwkJc2V0dXAtPmJ1ZmZlcl9zZWwgPSBidWZmZXJfc2VsOworCQlzZXR1
cC0+dm9mZnNldCA9IHZvZmZzZXQ7CisJCXNldHVwLT5ob2Zmc2V0ID0gaG9mZnNldDsKKwl9CisK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIHN0cnVjdCBsb2dpY3ZjX2xheWVyX2Zvcm1hdHMgKmxv
Z2ljdmNfbGF5ZXJfZm9ybWF0c19sb29rdXAoc3RydWN0IGxvZ2ljdmNfbGF5ZXIgKmxheWVyKQor
eworCWJvb2wgYWxwaGE7CisJdW5zaWduZWQgaW50IGkgPSAwOworCisJYWxwaGEgPSAobGF5ZXIt
PmNvbmZpZy5hbHBoYV9tb2RlID09IExPR0lDVkNfTEFZRVJfQUxQSEFfUElYRUwpOworCisJd2hp
bGUgKGxvZ2ljdmNfbGF5ZXJfZm9ybWF0c1tpXS5mb3JtYXRzKSB7CisJCWlmIChsb2dpY3ZjX2xh
eWVyX2Zvcm1hdHNbaV0uY29sb3JzcGFjZSA9PSBsYXllci0+Y29uZmlnLmNvbG9yc3BhY2UgJiYK
KwkJICAgIGxvZ2ljdmNfbGF5ZXJfZm9ybWF0c1tpXS5kZXB0aCA9PSBsYXllci0+Y29uZmlnLmRl
cHRoICYmCisJCSAgICBsb2dpY3ZjX2xheWVyX2Zvcm1hdHNbaV0uYWxwaGEgPT0gYWxwaGEpCisJ
CQlyZXR1cm4gJmxvZ2ljdmNfbGF5ZXJfZm9ybWF0c1tpXTsKKworCQlpKys7CisJfQorCisJcmV0
dXJuIE5VTEw7Cit9CisKK3N0YXRpYyB1bnNpZ25lZCBpbnQgbG9naWN2Y19sYXllcl9mb3JtYXRz
X2NvdW50KHN0cnVjdCBsb2dpY3ZjX2xheWVyX2Zvcm1hdHMgKmZvcm1hdHMpCit7CisJdW5zaWdu
ZWQgaW50IGNvdW50ID0gMDsKKworCXdoaWxlIChmb3JtYXRzLT5mb3JtYXRzW2NvdW50XSAhPSBE
Uk1fRk9STUFUX0lOVkFMSUQpCisJCWNvdW50Kys7CisKKwlyZXR1cm4gY291bnQ7Cit9CisKK3N0
YXRpYyBpbnQgbG9naWN2Y19sYXllcl9jb25maWdfcGFyc2Uoc3RydWN0IGxvZ2ljdmNfZHJtICps
b2dpY3ZjLAorCQkJCSAgICAgIHN0cnVjdCBsb2dpY3ZjX2xheWVyICpsYXllcikKK3sKKwlzdHJ1
Y3QgZGV2aWNlX25vZGUgKm9mX25vZGUgPSBsYXllci0+b2Zfbm9kZTsKKwlzdHJ1Y3QgbG9naWN2
Y19sYXllcl9jb25maWcgKmNvbmZpZyA9ICZsYXllci0+Y29uZmlnOworCWludCByZXQ7CisKKwls
b2dpY3ZjX29mX3Byb3BlcnR5X3BhcnNlX2Jvb2wob2Zfbm9kZSwgInh5bG9uLGxheWVyLXByaW1h
cnkiLAorCQkJCSAgICAgICAmY29uZmlnLT5wcmltYXJ5KTsKKworCXJldCA9IGxvZ2ljdmNfb2Zf
cHJvcGVydHlfcGFyc2VfdTMyKG9mX25vZGUsICJ4eWxvbixsYXllci1jb2xvcnNwYWNlIiwKKwkJ
CQkJICAgICZjb25maWctPmNvbG9yc3BhY2UpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisK
KwlyZXQgPSBsb2dpY3ZjX29mX3Byb3BlcnR5X3BhcnNlX3UzMihvZl9ub2RlLCAieHlsb24sbGF5
ZXItZGVwdGgiLAorCQkJCQkgICAgJmNvbmZpZy0+ZGVwdGgpOworCWlmIChyZXQpCisJCXJldHVy
biByZXQ7CisKKwlyZXQgPSBsb2dpY3ZjX29mX3Byb3BlcnR5X3BhcnNlX3UzMihvZl9ub2RlLCAi
eHlsb24sbGF5ZXItYWxwaGEtbW9kZSIsCisJCQkJCSAgICAmY29uZmlnLT5hbHBoYV9tb2RlKTsK
KwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJLyogTWVtb3J5IG9mZnNldCBpcyBvbmx5IHJl
bGV2YW50IHdpdGhvdXQgbGF5ZXIgYWRkcmVzcyBjb25maWd1cmF0aW9uLiAqLworCWlmIChsb2dp
Y3ZjLT5jYXBzLT5sYXllcl9hZGRyZXNzKQorCQlyZXR1cm4gMDsKKworCXJldCA9IGxvZ2ljdmNf
b2ZfcHJvcGVydHlfcGFyc2VfdTMyKG9mX25vZGUsICJ4eWxvbixsYXllci1iYXNlLW9mZnNldCIs
CisJCQkJCSAgICAmY29uZmlnLT5iYXNlX29mZnNldCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJl
dDsKKworCXJldCA9IGxvZ2ljdmNfb2ZfcHJvcGVydHlfcGFyc2VfdTMyKG9mX25vZGUsICJ4eWxv
bixsYXllci1idWZmZXItb2Zmc2V0IiwKKwkJCQkJICAgICZjb25maWctPmJ1ZmZlcl9vZmZzZXQp
OworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwlyZXR1cm4gMDsKK30KKworc3RydWN0IGxv
Z2ljdmNfbGF5ZXIgKmxvZ2ljdmNfbGF5ZXJfZ2V0X2Zyb21faW5kZXgoc3RydWN0IGxvZ2ljdmNf
ZHJtICpsb2dpY3ZjLAorCQkJCQkJICAgdTMyIGluZGV4KQoreworCXN0cnVjdCBsb2dpY3ZjX2xh
eWVyICpsYXllcjsKKworCWxpc3RfZm9yX2VhY2hfZW50cnkobGF5ZXIsICZsb2dpY3ZjLT5sYXll
cnNfbGlzdCwgbGlzdCkKKwkJaWYgKGxheWVyLT5pbmRleCA9PSBpbmRleCkKKwkJCXJldHVybiBs
YXllcjsKKworCXJldHVybiBOVUxMOworfQorCitzdHJ1Y3QgbG9naWN2Y19sYXllciAqbG9naWN2
Y19sYXllcl9nZXRfZnJvbV90eXBlKHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YywKKwkJCQkJ
CSAgZW51bSBkcm1fcGxhbmVfdHlwZSB0eXBlKQoreworCXN0cnVjdCBsb2dpY3ZjX2xheWVyICps
YXllcjsKKworCWxpc3RfZm9yX2VhY2hfZW50cnkobGF5ZXIsICZsb2dpY3ZjLT5sYXllcnNfbGlz
dCwgbGlzdCkKKwkJaWYgKGxheWVyLT5kcm1fcGxhbmUudHlwZSA9PSB0eXBlKQorCQkJcmV0dXJu
IGxheWVyOworCisJcmV0dXJuIE5VTEw7Cit9CisKK3N0cnVjdCBsb2dpY3ZjX2xheWVyICpsb2dp
Y3ZjX2xheWVyX2dldF9wcmltYXJ5KHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YykKK3sKKwly
ZXR1cm4gbG9naWN2Y19sYXllcl9nZXRfZnJvbV90eXBlKGxvZ2ljdmMsIERSTV9QTEFORV9UWVBF
X1BSSU1BUlkpOworfQorCitzdGF0aWMgaW50IGxvZ2ljdmNfbGF5ZXJfaW5pdChzdHJ1Y3QgbG9n
aWN2Y19kcm0gKmxvZ2ljdmMsCisJCQkgICAgICBzdHJ1Y3QgZGV2aWNlX25vZGUgKm9mX25vZGUs
IHUzMiBpbmRleCkKK3sKKwlzdHJ1Y3QgbG9naWN2Y19sYXllciAqbGF5ZXIgPSBOVUxMOworCXN0
cnVjdCBsb2dpY3ZjX2xheWVyX2Zvcm1hdHMgKmZvcm1hdHM7CisJdW5zaWduZWQgaW50IGZvcm1h
dHNfY291bnQ7CisJZW51bSBkcm1fcGxhbmVfdHlwZSB0eXBlOworCXVuc2lnbmVkIGludCB6cG9z
OworCWludCByZXQ7CisKKwlsYXllciA9IGRldm1fa3phbGxvYyhsb2dpY3ZjLT5kcm0tPmRldiwg
c2l6ZW9mKCpsYXllciksIEdGUF9LRVJORUwpOworCWlmICghbGF5ZXIpIHsKKwkJcmV0ID0gLUVO
T01FTTsKKwkJZ290byBlcnJvcjsKKwl9CisKKwlsYXllci0+bG9naWN2YyA9IGxvZ2ljdmM7CisJ
bGF5ZXItPm9mX25vZGUgPSBvZl9ub2RlOworCWxheWVyLT5pbmRleCA9IGluZGV4OworCisJcmV0
ID0gbG9naWN2Y19sYXllcl9jb25maWdfcGFyc2UobG9naWN2YywgbGF5ZXIpOworCWlmIChyZXQp
IHsKKwkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gcGFyc2UgY29uZmlnIGZvciBsYXllciAjJWRcbiIs
IGluZGV4KTsKKwkJZ290byBlcnJvcjsKKwl9CisKKwlmb3JtYXRzID0gbG9naWN2Y19sYXllcl9m
b3JtYXRzX2xvb2t1cChsYXllcik7CisJaWYgKCFmb3JtYXRzKSB7CisJCURSTV9FUlJPUigiRmFp
bGVkIHRvIGxvb2t1cCBmb3JtYXRzIGZvciBsYXllciAjJWRcbiIsIGluZGV4KTsKKwkJZ290byBl
cnJvcjsKKwl9CisKKwlmb3JtYXRzX2NvdW50ID0gbG9naWN2Y19sYXllcl9mb3JtYXRzX2NvdW50
KGZvcm1hdHMpOworCisJLyogVGhlIGZpbmFsIGxheWVyIGNhbiBiZSBjb25maWd1cmVkIGFzIGEg
YmFja2dyb3VuZCBsYXllci4gKi8KKwlpZiAobG9naWN2Yy0+Y29uZmlnLmJhY2tncm91bmRfbGF5
ZXIgJiYKKwkgICAgaW5kZXggPT0gKGxvZ2ljdmMtPmNvbmZpZy5sYXllcnNfY291bnQgLSAxKSkg
eworCQkvKiBBIHplcm8gdmFsdWUgZm9yIGJsYWNrIGlzIG9ubHkgdmFsaWQgZm9yIFJHQiwgbm90
IGZvciBZVVYsCisJCSAqIHNvIHRoaXMgd2lsbCBuZWVkIHRvIHRha2UgdGhlIGZvcm1hdCBpbiBh
Y2NvdW50IGZvciBZVVYuICovCisJCXUzMiBiYWNrZ3JvdW5kID0gMDsKKworCQlEUk1fREVCVUdf
RFJJVkVSKCJVc2luZyBsYXllciAjJWQgYXMgYmFja2dyb3VuZCBsYXllclxuIiwKKwkJCQkgaW5k
ZXgpOworCisJCXJlZ21hcF93cml0ZShsb2dpY3ZjLT5yZWdtYXAsIExPR0lDVkNfQkFDS0dST1VO
RF9DT0xPUl9SRUcsCisJCQkgICAgIGJhY2tncm91bmQpOworCisJCWRldm1fa2ZyZWUobG9naWN2
Yy0+ZHJtLT5kZXYsIGxheWVyKTsKKworCQlyZXR1cm4gMDsKKwl9CisKKwlpZiAobGF5ZXItPmNv
bmZpZy5wcmltYXJ5KQorCQl0eXBlID0gRFJNX1BMQU5FX1RZUEVfUFJJTUFSWTsKKwllbHNlCisJ
CXR5cGUgPSBEUk1fUExBTkVfVFlQRV9PVkVSTEFZOworCisJcmV0ID0gZHJtX3VuaXZlcnNhbF9w
bGFuZV9pbml0KGxvZ2ljdmMtPmRybSwgJmxheWVyLT5kcm1fcGxhbmUsIDAsCisJCQkJICAgICAg
ICZsb2dpY3ZjX3BsYW5lX2Z1bmNzLCBmb3JtYXRzLT5mb3JtYXRzLAorCQkJCSAgICAgICBmb3Jt
YXRzX2NvdW50LCBOVUxMLCB0eXBlLCBOVUxMKTsKKwlpZiAocmV0KSB7CisJCURSTV9FUlJPUigi
RmFpbGVkIHRvIGluaXRpYWxpemUgbGF5ZXIgcGxhbmVcbiIpOworCQlyZXR1cm4gcmV0OworCX0K
KworCWRybV9wbGFuZV9oZWxwZXJfYWRkKCZsYXllci0+ZHJtX3BsYW5lLCAmbG9naWN2Y19wbGFu
ZV9oZWxwZXJfZnVuY3MpOworCisJenBvcyA9IGxvZ2ljdmMtPmNvbmZpZy5sYXllcnNfY291bnQg
LSBpbmRleCAtIDE7CisJRFJNX0RFQlVHX0RSSVZFUigiR2l2aW5nIGxheWVyICMlZCB6cG9zICVk
XG4iLCBpbmRleCwgenBvcyk7CisKKwlpZiAobGF5ZXItPmNvbmZpZy5hbHBoYV9tb2RlID09IExP
R0lDVkNfTEFZRVJfQUxQSEFfTEFZRVIpCisJCWRybV9wbGFuZV9jcmVhdGVfYWxwaGFfcHJvcGVy
dHkoJmxheWVyLT5kcm1fcGxhbmUpOworCisJZHJtX3BsYW5lX2NyZWF0ZV96cG9zX2ltbXV0YWJs
ZV9wcm9wZXJ0eSgmbGF5ZXItPmRybV9wbGFuZSwgenBvcyk7CisKKwlEUk1fREVCVUdfRFJJVkVS
KCJSZWdpc3RlcmluZyBsYXllciAjJWRcbiIsIGluZGV4KTsKKworCWxheWVyLT5mb3JtYXRzID0g
Zm9ybWF0czsKKworCWxpc3RfYWRkX3RhaWwoJmxheWVyLT5saXN0LCAmbG9naWN2Yy0+bGF5ZXJz
X2xpc3QpOworCisJcmV0dXJuIDA7CisKK2Vycm9yOgorCWlmIChsYXllcikKKwkJZGV2bV9rZnJl
ZShsb2dpY3ZjLT5kcm0tPmRldiwgbGF5ZXIpOworCisJcmV0dXJuIHJldDsKK30KKworc3RhdGlj
IHZvaWQgbG9naWN2Y19sYXllcl9maW5pKHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YywKKwkJ
CSAgICAgICBzdHJ1Y3QgbG9naWN2Y19sYXllciAqbGF5ZXIpCit7CisJbGlzdF9kZWwoJmxheWVy
LT5saXN0KTsKKwlkZXZtX2tmcmVlKGxvZ2ljdmMtPmRybS0+ZGV2LCBsYXllcik7Cit9CisKK3Zv
aWQgbG9naWN2Y19sYXllcnNfYXR0YWNoX2NydGMoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3Zj
KQoreworCXVpbnQzMl90IHBvc3NpYmxlX2NydGNzID0gZHJtX2NydGNfbWFzaygmbG9naWN2Yy0+
Y3J0Yy0+ZHJtX2NydGMpOworCXN0cnVjdCBsb2dpY3ZjX2xheWVyICpsYXllcjsKKworCWxpc3Rf
Zm9yX2VhY2hfZW50cnkobGF5ZXIsICZsb2dpY3ZjLT5sYXllcnNfbGlzdCwgbGlzdCkgeworCQlp
ZiAobGF5ZXItPmRybV9wbGFuZS50eXBlICE9IERSTV9QTEFORV9UWVBFX09WRVJMQVkpCisJCQlj
b250aW51ZTsKKworCQlsYXllci0+ZHJtX3BsYW5lLnBvc3NpYmxlX2NydGNzID0gcG9zc2libGVf
Y3J0Y3M7CisJfQorfQorCitpbnQgbG9naWN2Y19sYXllcnNfaW5pdChzdHJ1Y3QgbG9naWN2Y19k
cm0gKmxvZ2ljdmMpCit7CisJc3RydWN0IGRldmljZV9ub2RlICpvZl9ub2RlID0gbG9naWN2Yy0+
ZHJtLT5kZXYtPm9mX25vZGU7CisJc3RydWN0IGRldmljZV9ub2RlICpsYXllcl9ub2RlID0gTlVM
TDsKKwlzdHJ1Y3QgZGV2aWNlX25vZGUgKmxheWVyc19ub2RlOworCXN0cnVjdCBsb2dpY3ZjX2xh
eWVyICpsYXllcjsKKwlzdHJ1Y3QgbG9naWN2Y19sYXllciAqbmV4dDsKKwlpbnQgcmV0ID0gMDsK
KworCWxheWVyc19ub2RlID0gb2ZfZ2V0X2NoaWxkX2J5X25hbWUob2Zfbm9kZSwgImxheWVycyIp
OworCWlmICghbGF5ZXJzX25vZGUpIHsKKwkJRFJNX0VSUk9SKCJObyBsYXllcnMgbm9kZSBmb3Vu
ZCBpbiB0aGUgZGVzY3JpcHRpb25cbiIpOworCQlyZXQgPSAtRU5PREVWOworCQlnb3RvIGVycm9y
OworCX0KKworCWZvcl9lYWNoX2NoaWxkX29mX25vZGUobGF5ZXJzX25vZGUsIGxheWVyX25vZGUp
IHsKKwkJdTMyIGluZGV4ID0gMDsKKworCQlpZiAoIWxvZ2ljdmNfb2Zfbm9kZV9pc19sYXllcihs
YXllcl9ub2RlKSkKKwkJCWNvbnRpbnVlOworCisJCXJldCA9IG9mX3Byb3BlcnR5X3JlYWRfdTMy
KGxheWVyX25vZGUsICJyZWciLCAmaW5kZXgpOworCQlpZiAocmV0KQorCQkJY29udGludWU7CisK
KwkJbGF5ZXIgPSBsb2dpY3ZjX2xheWVyX2dldF9mcm9tX2luZGV4KGxvZ2ljdmMsIGluZGV4KTsK
KwkJaWYgKGxheWVyKSB7CisJCQlEUk1fRVJST1IoIkR1cGxpY2F0ZWQgZW50cnkgZm9yIGxheWVy
ICMlZFxuIiwgaW5kZXgpOworCQkJY29udGludWU7CisJCX0KKworCQlyZXQgPSBsb2dpY3ZjX2xh
eWVyX2luaXQobG9naWN2YywgbGF5ZXJfbm9kZSwgaW5kZXgpOworCQlpZiAocmV0KQorCQkJZ290
byBlcnJvcjsKKworCQlvZl9ub2RlX3B1dChsYXllcl9ub2RlKTsKKwl9CisKKwlvZl9ub2RlX3B1
dChsYXllcnNfbm9kZSk7CisKKwlyZXR1cm4gMDsKKworZXJyb3I6CisJbGlzdF9mb3JfZWFjaF9l
bnRyeV9zYWZlKGxheWVyLCBuZXh0LCAmbG9naWN2Yy0+bGF5ZXJzX2xpc3QsIGxpc3QpCisJCWxv
Z2ljdmNfbGF5ZXJfZmluaShsb2dpY3ZjLCBsYXllcik7CisKKwlyZXR1cm4gcmV0OworfQpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19sYXllci5oIGIvZHJpdmVy
cy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19sYXllci5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0Cmlu
ZGV4IDAwMDAwMDAwMDAwMC4uNzFiM2YxNzdiMDkzCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19sYXllci5oCkBAIC0wLDAgKzEsNjUgQEAKKy8qIFNQ
RFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wKyAqLworLyoKKyAqIENvcHlyaWdodCAoQykg
MjAxOSBCb290bGluCisgKiBBdXRob3I6IFBhdWwgS29jaWFsa293c2tpIDxwYXVsLmtvY2lhbGtv
d3NraUBib290bGluLmNvbT4KKyAqLworCisjaWZuZGVmIF9MT0dJQ1ZDX0xBWUVSX0hfCisjZGVm
aW5lIF9MT0dJQ1ZDX0xBWUVSX0hfCisKKyNpbmNsdWRlIDxsaW51eC9vZi5oPgorI2luY2x1ZGUg
PGxpbnV4L3R5cGVzLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wbGFuZS5oPgorCisjZGVmaW5lIExP
R0lDVkNfTEFZRVJfQ09MT1JTUEFDRV9SR0IJCTAKKyNkZWZpbmUgTE9HSUNWQ19MQVlFUl9DT0xP
UlNQQUNFX1lVVgkJMQorCisjZGVmaW5lIExPR0lDVkNfTEFZRVJfQUxQSEFfTEFZRVIJCTAKKyNk
ZWZpbmUgTE9HSUNWQ19MQVlFUl9BTFBIQV9QSVhFTAkJMQorCitzdHJ1Y3QgbG9naWN2Y19sYXll
cl9idWZmZXJfc2V0dXAgeworCXU4IGJ1ZmZlcl9zZWw7CisJdTE2IHZvZmZzZXQ7CisJdTE2IGhv
ZmZzZXQ7Cit9OworCitzdHJ1Y3QgbG9naWN2Y19sYXllcl9jb25maWcgeworCXUzMiBjb2xvcnNw
YWNlOworCXUzMiBkZXB0aDsKKwl1MzIgYWxwaGFfbW9kZTsKKwl1MzIgYmFzZV9vZmZzZXQ7CisJ
dTMyIGJ1ZmZlcl9vZmZzZXQ7CisJYm9vbCBwcmltYXJ5OworfTsKKworc3RydWN0IGxvZ2ljdmNf
bGF5ZXJfZm9ybWF0cyB7CisJdTMyIGNvbG9yc3BhY2U7CisJdTMyIGRlcHRoOworCWJvb2wgYWxw
aGE7CisJdWludDMyX3QgKmZvcm1hdHM7Cit9OworCitzdHJ1Y3QgbG9naWN2Y19sYXllciB7CisJ
c3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjOworCisJc3RydWN0IGxvZ2ljdmNfbGF5ZXJfY29u
ZmlnIGNvbmZpZzsKKwlzdHJ1Y3QgbG9naWN2Y19sYXllcl9mb3JtYXRzICpmb3JtYXRzOworCXN0
cnVjdCBkZXZpY2Vfbm9kZSAqb2Zfbm9kZTsKKworCXN0cnVjdCBkcm1fcGxhbmUgZHJtX3BsYW5l
OworCXN0cnVjdCBsaXN0X2hlYWQgbGlzdDsKKwl1MzIgaW5kZXg7Cit9OworCitpbnQgbG9naWN2
Y19sYXllcl9idWZmZXJfZmluZF9zZXR1cChzdHJ1Y3QgbG9naWN2Y19sYXllciAqbGF5ZXIsCisJ
CQkJICAgIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnN0YXRlLAorCQkJCSAgICBzdHJ1Y3QgbG9n
aWN2Y19sYXllcl9idWZmZXJfc2V0dXAgKnNldHVwKTsKK3N0cnVjdCBsb2dpY3ZjX2xheWVyICps
b2dpY3ZjX2xheWVyX2dldF9mcm9tX2luZGV4KHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YywK
KwkJCQkJCSAgIHUzMiBpbmRleCk7CitzdHJ1Y3QgbG9naWN2Y19sYXllciAqbG9naWN2Y19sYXll
cl9nZXRfZnJvbV90eXBlKHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YywKKwkJCQkJCSAgZW51
bSBkcm1fcGxhbmVfdHlwZSB0eXBlKTsKK3N0cnVjdCBsb2dpY3ZjX2xheWVyICpsb2dpY3ZjX2xh
eWVyX2dldF9wcmltYXJ5KHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2Yyk7Cit2b2lkIGxvZ2lj
dmNfbGF5ZXJzX2F0dGFjaF9jcnRjKHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2Yyk7CitpbnQg
bG9naWN2Y19sYXllcnNfaW5pdChzdHJ1Y3QgbG9naWN2Y19kcm0gKmxvZ2ljdmMpOworCisjZW5k
aWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfbW9kZS5jIGIv
ZHJpdmVycy9ncHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19tb2RlLmMKbmV3IGZpbGUgbW9kZSAxMDA2
NDQKaW5kZXggMDAwMDAwMDAwMDAwLi42MDk1ZGE5NzVkN2MKLS0tIC9kZXYvbnVsbAorKysgYi9k
cml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX21vZGUuYwpAQCAtMCwwICsxLDEwMyBAQAor
Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjArCisvKgorICogQ29weXJpZ2h0IChD
KSAyMDE5IEJvb3RsaW4KKyAqIEF1dGhvcjogUGF1bCBLb2NpYWxrb3dza2kgPHBhdWwua29jaWFs
a293c2tpQGJvb3RsaW4uY29tPgorICovCisKKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgorI2lu
Y2x1ZGUgPGRybS9kcm1fYXRvbWljLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWNfaGVscGVy
Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV9jcnRjX2hlbHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1f
ZHJ2Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV9mYl9jbWFfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJt
L2RybV9mYl9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2dlbV9jbWFfaGVscGVyLmg+Cisj
aW5jbHVkZSA8ZHJtL2RybV9nZW1fZnJhbWVidWZmZXJfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJt
L2RybV9tb2RlX2NvbmZpZy5oPgorI2luY2x1ZGUgPGRybS9kcm1fcGFuZWwuaD4KKyNpbmNsdWRl
IDxkcm0vZHJtX3ByaW50Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wcm9iZV9oZWxwZXIuaD4KKyNp
bmNsdWRlIDxkcm0vZHJtX3ZibGFuay5oPgorCisjaW5jbHVkZSAibG9naWN2Y19kcm0uaCIKKyNp
bmNsdWRlICJsb2dpY3ZjX2ludGVyZmFjZS5oIgorI2luY2x1ZGUgImxvZ2ljdmNfbGF5ZXIuaCIK
KyNpbmNsdWRlICJsb2dpY3ZjX21vZGUuaCIKKworc3RhdGljIHZvaWQgbG9naWN2Y19tb2RlX2F0
b21pY19jb21taXRfdGFpbChzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqb2xkX3N0YXRlKQorewor
CXN0cnVjdCBkcm1fZGV2aWNlICpkcm0gPSBvbGRfc3RhdGUtPmRldjsKKwlzdHJ1Y3QgbG9naWN2
Y19kcm0gKmxvZ2ljdmMgPSBkcm0tPmRldl9wcml2YXRlOworCXN0cnVjdCBsb2dpY3ZjX2ludGVy
ZmFjZSAqaW50ZXJmYWNlID0gbG9naWN2Yy0+aW50ZXJmYWNlOworCisJZHJtX2F0b21pY19oZWxw
ZXJfY29tbWl0X3RhaWwob2xkX3N0YXRlKTsKKworCS8qIEVuYWJsZSB0aGUgcGFuZWwgYWZ0ZXIg
dGhlIGZpcnN0IGNvbW1pdCwgd2hpY2ggY29uY2VybnMgb3VyIHBhbmVsCisJICogc2luY2Ugd2Ug
b25seSBzdXBwb3J0IGEgc2luZ2xlIGludGVyZmFjZS4gKi8KKwlpZiAoaW50ZXJmYWNlLT5kcm1f
cGFuZWwgJiYgIWludGVyZmFjZS0+ZHJtX3BhbmVsX2VuYWJsZWQpIHsKKwkJZHJtX3BhbmVsX2Vu
YWJsZShpbnRlcmZhY2UtPmRybV9wYW5lbCk7CisJCWludGVyZmFjZS0+ZHJtX3BhbmVsX2VuYWJs
ZWQgPSB0cnVlOworCX0KK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fbW9kZV9jb25maWdf
aGVscGVyX2Z1bmNzIGxvZ2ljdmNfbW9kZV9jb25maWdfaGVscGVyX2Z1bmNzID0geworCS5hdG9t
aWNfY29tbWl0X3RhaWwJPSBsb2dpY3ZjX21vZGVfYXRvbWljX2NvbW1pdF90YWlsLAorfTsKKwor
c3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fbW9kZV9jb25maWdfZnVuY3MgbG9naWN2Y19tb2RlX2Nv
bmZpZ19mdW5jcyA9IHsKKwkuZmJfY3JlYXRlCQk9IGRybV9nZW1fZmJfY3JlYXRlLAorCS5vdXRw
dXRfcG9sbF9jaGFuZ2VkCT0gZHJtX2ZiX2hlbHBlcl9vdXRwdXRfcG9sbF9jaGFuZ2VkLAorCS5h
dG9taWNfY2hlY2sJCT0gZHJtX2F0b21pY19oZWxwZXJfY2hlY2ssCisJLmF0b21pY19jb21taXQJ
CT0gZHJtX2F0b21pY19oZWxwZXJfY29tbWl0LAorfTsKKworaW50IGxvZ2ljdmNfbW9kZV9pbml0
KHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2YykKK3sKKwlzdHJ1Y3QgZHJtX21vZGVfY29uZmln
ICptb2RlX2NvbmZpZyA9ICZsb2dpY3ZjLT5kcm0tPm1vZGVfY29uZmlnOworCXN0cnVjdCBsb2dp
Y3ZjX2xheWVyICpsYXllcl9wcmltYXJ5OworCXVpbnQzMl90IHByZWZlcnJlZF9kZXB0aDsKKwlp
bnQgcmV0OworCisJcmV0ID0gZHJtX3ZibGFua19pbml0KGxvZ2ljdmMtPmRybSwgbG9naWN2Yy0+
ZHJtLT5tb2RlX2NvbmZpZy5udW1fY3J0Yyk7CisJaWYgKHJldCkgeworCQlEUk1fRVJST1IoIkZh
aWxlZCB0byBpbml0aWFsaXplIHZibGFua1xuIik7CisJCXJldHVybiByZXQ7CisJfQorCisJbGF5
ZXJfcHJpbWFyeSA9IGxvZ2ljdmNfbGF5ZXJfZ2V0X3ByaW1hcnkobG9naWN2Yyk7CisJaWYgKCFs
YXllcl9wcmltYXJ5KSB7CisJCURSTV9FUlJPUigiRmFpbGVkIHRvIGdldCBwcmltYXJ5IGxheWVy
XG4iKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJcHJlZmVycmVkX2RlcHRoID0gbGF5ZXJf
cHJpbWFyeS0+Zm9ybWF0cy0+ZGVwdGg7CisKKwkvKiBEUk0gY291bnRzIGFscGhhIGluIGRlcHRo
LCBvdXIgZHJpdmVyIGRvZXNuJ3QuICovCisJaWYgKGxheWVyX3ByaW1hcnktPmZvcm1hdHMtPmFs
cGhhKQorCQlwcmVmZXJyZWRfZGVwdGggKz0gODsKKworCW1vZGVfY29uZmlnLT5taW5fd2lkdGgg
PSA2NDsKKwltb2RlX2NvbmZpZy0+bWF4X3dpZHRoID0gMjA0ODsKKwltb2RlX2NvbmZpZy0+bWlu
X2hlaWdodCA9IDE7CisJbW9kZV9jb25maWctPm1heF9oZWlnaHQgPSAyMDQ4OworCW1vZGVfY29u
ZmlnLT5wcmVmZXJyZWRfZGVwdGggPSBwcmVmZXJyZWRfZGVwdGg7CisJbW9kZV9jb25maWctPmZ1
bmNzID0gJmxvZ2ljdmNfbW9kZV9jb25maWdfZnVuY3M7CisJbW9kZV9jb25maWctPmhlbHBlcl9w
cml2YXRlID0gJmxvZ2ljdmNfbW9kZV9jb25maWdfaGVscGVyX2Z1bmNzOworCisJZHJtX21vZGVf
Y29uZmlnX3Jlc2V0KGxvZ2ljdmMtPmRybSk7CisKKwlyZXQgPSBkcm1fZmJkZXZfZ2VuZXJpY19z
ZXR1cChsb2dpY3ZjLT5kcm0sIHByZWZlcnJlZF9kZXB0aCk7CisJaWYgKHJldCkgeworCQlEUk1f
RVJST1IoIkZhaWxlZCB0byBpbml0aWFsaXplIGZiZGV2XG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9
CisKKwlkcm1fa21zX2hlbHBlcl9wb2xsX2luaXQobG9naWN2Yy0+ZHJtKTsKKworCXJldHVybiAw
OworfQorCit2b2lkIGxvZ2ljdmNfbW9kZV9maW5pKHN0cnVjdCBsb2dpY3ZjX2RybSAqbG9naWN2
YykKK3sKKwlkcm1fa21zX2hlbHBlcl9wb2xsX2ZpbmkobG9naWN2Yy0+ZHJtKTsKK30KZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb2dpY3ZjL2xvZ2ljdmNfbW9kZS5oIGIvZHJpdmVycy9n
cHUvZHJtL2xvZ2ljdmMvbG9naWN2Y19tb2RlLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXgg
MDAwMDAwMDAwMDAwLi42OTBkZWYxNjE5YTYKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dw
dS9kcm0vbG9naWN2Yy9sb2dpY3ZjX21vZGUuaApAQCAtMCwwICsxLDE1IEBACisvKiBTUERYLUxp
Y2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCsgKi8KKy8qCisgKiBDb3B5cmlnaHQgKEMpIDIwMTkg
Qm9vdGxpbgorICogQXV0aG9yOiBQYXVsIEtvY2lhbGtvd3NraSA8cGF1bC5rb2NpYWxrb3dza2lA
Ym9vdGxpbi5jb20+CisgKi8KKworI2lmbmRlZiBfTE9HSUNWQ19NT0RFX0hfCisjZGVmaW5lIF9M
T0dJQ1ZDX01PREVfSF8KKworc3RydWN0IGxvZ2ljdmNfZHJtOworCitpbnQgbG9naWN2Y19tb2Rl
X2luaXQoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjKTsKK3ZvaWQgbG9naWN2Y19tb2RlX2Zp
bmkoc3RydWN0IGxvZ2ljdmNfZHJtICpsb2dpY3ZjKTsKKworI2VuZGlmCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX29mLmMgYi9kcml2ZXJzL2dwdS9kcm0vbG9n
aWN2Yy9sb2dpY3ZjX29mLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAw
Li4xOWI3YmM1ZWE1NzIKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2
Yy9sb2dpY3ZjX29mLmMKQEAgLTAsMCArMSwyMDUgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlm
aWVyOiBHUEwtMi4wKworLyoKKyAqIENvcHlyaWdodCAoQykgMjAxOSBCb290bGluCisgKiBBdXRo
b3I6IFBhdWwgS29jaWFsa293c2tpIDxwYXVsLmtvY2lhbGtvd3NraUBib290bGluLmNvbT4KKyAq
LworCisjaW5jbHVkZSA8ZHJtL2RybV9wcmludC5oPgorCisjaW5jbHVkZSAibG9naWN2Y19kcm0u
aCIKKyNpbmNsdWRlICJsb2dpY3ZjX2xheWVyLmgiCisjaW5jbHVkZSAibG9naWN2Y19vZi5oIgor
CitzdGF0aWMgc3RydWN0IGxvZ2ljdmNfb2ZfcHJvcGVydHlfc3YgbG9naWN2Y19vZl9kaXNwbGF5
X2ludGVyZmFjZV9zdltdID0geworCXsgImx2ZHMtNGJpdHMiLAlMT0dJQ1ZDX0RJU1BMQVlfSU5U
RVJGQUNFX0xWRFNfNEJJVFMgfSwKKwl7ICJsdmRzLTNiaXRzIiwJTE9HSUNWQ19ESVNQTEFZX0lO
VEVSRkFDRV9MVkRTXzNCSVRTIH0sCisJeyB9LAorfTsKKworc3RhdGljIHN0cnVjdCBsb2dpY3Zj
X29mX3Byb3BlcnR5X3N2IGxvZ2ljdmNfb2ZfZGlzcGxheV9jb2xvcnNwYWNlX3N2W10gPSB7CisJ
eyAicmdiIiwJTE9HSUNWQ19ESVNQTEFZX0NPTE9SU1BBQ0VfUkdCIH0sCisJeyAieXV2NDIyIiwJ
TE9HSUNWQ19ESVNQTEFZX0NPTE9SU1BBQ0VfWVVWNDIyIH0sCisJeyAieXV2NDQ0IiwJTE9HSUNW
Q19ESVNQTEFZX0NPTE9SU1BBQ0VfWVVWNDQ0IH0sCisJeyB9LAorfTsKKworc3RhdGljIHN0cnVj
dCBsb2dpY3ZjX29mX3Byb3BlcnR5X3N2IGxvZ2ljdmNfb2ZfbGF5ZXJfY29sb3JzcGFjZV9zdltd
ID0geworCXsgInJnYiIsCUxPR0lDVkNfTEFZRVJfQ09MT1JTUEFDRV9SR0IgfSwKKwl7ICJ5dXYi
LAlMT0dJQ1ZDX0xBWUVSX0NPTE9SU1BBQ0VfWVVWIH0sCisJeyB9LAorfTsKKworc3RhdGljIHN0
cnVjdCBsb2dpY3ZjX29mX3Byb3BlcnR5X3N2IGxvZ2ljdmNfb2ZfbGF5ZXJfYWxwaGFfbW9kZV9z
dltdID0geworCXsgImxheWVyIiwJTE9HSUNWQ19MQVlFUl9BTFBIQV9MQVlFUiB9LAorCXsgInBp
eGVsIiwJTE9HSUNWQ19MQVlFUl9BTFBIQV9QSVhFTCB9LAorCXsgfSwKK307CisKK3N0YXRpYyBz
dHJ1Y3QgbG9naWN2Y19vZl9wcm9wZXJ0eSBsb2dpY3ZjX29mX3Byb3BlcnRpZXNbXSA9IHsKKwl7
CisJCS5uYW1lCQk9ICJ4eWxvbixkaXNwbGF5LWludGVyZmFjZSIsCisJCS5zdgkJPSBsb2dpY3Zj
X29mX2Rpc3BsYXlfaW50ZXJmYWNlX3N2LAorCQkucmFuZ2UJCT0geworCQkJTE9HSUNWQ19ESVNQ
TEFZX0lOVEVSRkFDRV9MVkRTXzRCSVRTLAorCQkJTE9HSUNWQ19ESVNQTEFZX0lOVEVSRkFDRV9M
VkRTXzNCSVRTLAorCQl9LAorCX0sCisJeworCQkubmFtZQkJPSAieHlsb24sZGlzcGxheS1jb2xv
cnNwYWNlIiwKKwkJLnN2CQk9IGxvZ2ljdmNfb2ZfZGlzcGxheV9jb2xvcnNwYWNlX3N2LAorCQku
cmFuZ2UJCT0geworCQkJTE9HSUNWQ19ESVNQTEFZX0NPTE9SU1BBQ0VfUkdCLAorCQkJTE9HSUNW
Q19ESVNQTEFZX0NPTE9SU1BBQ0VfWVVWNDQ0LAorCQl9LAorCX0sCisJeworCQkubmFtZQkJPSAi
eHlsb24sZGlzcGxheS1kZXB0aCIsCisJCS5yYW5nZQkJPSB7IDgsIDI0IH0sCisJfSwKKwl7CisJ
CS5uYW1lCQk9ICJ4eWxvbixyb3ctc3RyaWRlIiwKKwl9LAorCXsKKwkJLm5hbWUJCT0gInh5bG9u
LGRpdGhlcmluZyIsCisJCS5vcHRpb25hbAk9IHRydWUsCisJfSwKKwl7CisJCS5uYW1lCQk9ICJ4
eWxvbixiYWNrZ3JvdW5kLWxheWVyIiwKKwkJLm9wdGlvbmFsCT0gdHJ1ZSwKKwl9LAorCXsKKwkJ
Lm5hbWUJCT0gInh5bG9uLGxheWVycy1jb25maWd1cmFibGUiLAorCQkub3B0aW9uYWwJPSB0cnVl
LAorCX0sCisJeworCQkubmFtZQkJPSAieHlsb24sbGF5ZXJzLWNvdW50IiwKKwl9LAorCXsKKwkJ
Lm5hbWUJCT0gInh5bG9uLGxheWVyLWRlcHRoIiwKKwkJLnJhbmdlCQk9IHsgOCwgMjQgfSwKKwl9
LAorCXsKKwkJLm5hbWUJCT0gInh5bG9uLGxheWVyLWNvbG9yc3BhY2UiLAorCQkuc3YJCT0gbG9n
aWN2Y19vZl9sYXllcl9jb2xvcnNwYWNlX3N2LAorCQkucmFuZ2UJCT0geworCQkJTE9HSUNWQ19M
QVlFUl9DT0xPUlNQQUNFX1JHQiwKKwkJCUxPR0lDVkNfTEFZRVJfQ09MT1JTUEFDRV9SR0IsCisJ
CX0sCisJfSwKKwl7CisJCS5uYW1lCQk9ICJ4eWxvbixsYXllci1hbHBoYS1tb2RlIiwKKwkJLnN2
CQk9IGxvZ2ljdmNfb2ZfbGF5ZXJfYWxwaGFfbW9kZV9zdiwKKwkJLnJhbmdlCQk9IHsKKwkJCUxP
R0lDVkNfTEFZRVJfQUxQSEFfTEFZRVIsCisJCQlMT0dJQ1ZDX0xBWUVSX0FMUEhBX1BJWEVMLAor
CQl9LAorCX0sCisJeworCQkubmFtZQkJPSAieHlsb24sbGF5ZXItYmFzZS1vZmZzZXQiLAorCX0s
CisJeworCQkubmFtZQkJPSAieHlsb24sbGF5ZXItYnVmZmVyLW9mZnNldCIsCisJfSwKKwl7CisJ
CS5uYW1lCQk9ICJ4eWxvbixsYXllci1wcmltYXJ5IiwKKwkJLm9wdGlvbmFsCT0gdHJ1ZSwKKwl9
LAorCXsgfSwKK307CisKK3N0YXRpYyBpbnQgbG9naWN2Y19vZl9wcm9wZXJ0eV9zdl92YWx1ZShz
dHJ1Y3QgbG9naWN2Y19vZl9wcm9wZXJ0eV9zdiAqc3YsCisJCQkJCWNvbnN0IGNoYXIgKnN0cmlu
ZywgdTMyICp2YWx1ZSkKK3sKKwl1bnNpZ25lZCBpbnQgaSA9IDA7CisKKwl3aGlsZSAoc3ZbaV0u
c3RyaW5nKSB7CisJCWlmICghc3RyY21wKHN2W2ldLnN0cmluZywgc3RyaW5nKSkgeworCQkJKnZh
bHVlID0gc3ZbaV0udmFsdWU7CisJCQlyZXR1cm4gMDsKKwkJfQorCisJCWkrKzsKKwl9CisKKwly
ZXR1cm4gLUVJTlZBTDsKK30KKworc3RhdGljIHN0cnVjdCBsb2dpY3ZjX29mX3Byb3BlcnR5ICps
b2dpY3ZjX29mX3Byb3BlcnR5X2xvb2t1cChjb25zdCBjaGFyICpuYW1lKQoreworCXVuc2lnbmVk
IGludCBpID0gMDsKKworCXdoaWxlIChsb2dpY3ZjX29mX3Byb3BlcnRpZXNbaV0ubmFtZSkgewor
CQlpZiAoIXN0cmNtcChsb2dpY3ZjX29mX3Byb3BlcnRpZXNbaV0ubmFtZSwgbmFtZSkpCisJCQly
ZXR1cm4gJmxvZ2ljdmNfb2ZfcHJvcGVydGllc1tpXTsKKworCQlpKys7CisJfQorCisJcmV0dXJu
IE5VTEw7Cit9CisKK2ludCBsb2dpY3ZjX29mX3Byb3BlcnR5X3BhcnNlX3UzMihzdHJ1Y3QgZGV2
aWNlX25vZGUgKm9mX25vZGUsCisJCQkJICBjb25zdCBjaGFyICpuYW1lLCB1MzIgKnRhcmdldCkK
K3sKKwlzdHJ1Y3QgbG9naWN2Y19vZl9wcm9wZXJ0eSAqcHJvcGVydHk7CisJY29uc3QgY2hhciAq
c3RyaW5nOworCXUzMiB2YWx1ZTsKKwlpbnQgcmV0OworCisJcHJvcGVydHkgPSBsb2dpY3ZjX29m
X3Byb3BlcnR5X2xvb2t1cChuYW1lKTsKKwlpZiAoIXByb3BlcnR5KQorCQlyZXR1cm4gLUVJTlZB
TDsKKworCWlmICghcHJvcGVydHktPm9wdGlvbmFsICYmICFvZl9wcm9wZXJ0eV9yZWFkX2Jvb2wo
b2Zfbm9kZSwgbmFtZSkpIHsKKwkJRFJNX0VSUk9SKCJNaXNzaW5nIG5vbi1vcHRpb25hbCBPRiBw
cm9wZXJ0eSAlc1xuIiwgbmFtZSk7CisJCXJldHVybiAtRU5PREVWOworCX0KKworCWlmIChwcm9w
ZXJ0eS0+c3YpIHsKKwkJcmV0ID0gb2ZfcHJvcGVydHlfcmVhZF9zdHJpbmcob2Zfbm9kZSwgbmFt
ZSwgJnN0cmluZyk7CisJCWlmIChyZXQpIHsKKwkJCURSTV9FUlJPUigiRmFpbGVkIHRvIHJlYWQg
T0YgcHJvcGVydHkgJXNcbiIsIG5hbWUpOworCQkJcmV0dXJuIHJldDsKKwkJfQorCisJCXJldCA9
IGxvZ2ljdmNfb2ZfcHJvcGVydHlfc3ZfdmFsdWUocHJvcGVydHktPnN2LCBzdHJpbmcsCisJCQkJ
CQkgICAmdmFsdWUpOworCQlpZiAocmV0KSB7CisJCQlEUk1fRVJST1IoIkZhaWxlZCB0byBtYXRj
aCBPRiBzdHJpbmcgJXNcbiIsIG5hbWUpOworCQkJcmV0dXJuIHJldDsKKwkJfQorCX0gZWxzZSB7
CisJCXJldCA9IG9mX3Byb3BlcnR5X3JlYWRfdTMyKG9mX25vZGUsIG5hbWUsICZ2YWx1ZSk7CisJ
CWlmIChyZXQpIHsKKwkJCURSTV9FUlJPUigiRmFpbGVkIHRvIHJlYWQgT0YgcHJvcGVydHkgJXNc
biIsIG5hbWUpOworCQkJcmV0dXJuIHJldDsKKwkJfQorCX0KKworCWlmIChwcm9wZXJ0eS0+cmFu
Z2VbMF0gfHwgcHJvcGVydHktPnJhbmdlWzFdKQorCQlpZiAodmFsdWUgPCBwcm9wZXJ0eS0+cmFu
Z2VbMF0gfHwgdmFsdWUgPiBwcm9wZXJ0eS0+cmFuZ2VbMV0pCisJCQlyZXR1cm4gLUVSQU5HRTsK
KworCSp0YXJnZXQgPSB2YWx1ZTsKKworCXJldHVybiAwOworfQorCit2b2lkIGxvZ2ljdmNfb2Zf
cHJvcGVydHlfcGFyc2VfYm9vbChzdHJ1Y3QgZGV2aWNlX25vZGUgKm9mX25vZGUsCisJCQkJICAg
IGNvbnN0IGNoYXIgKm5hbWUsIGJvb2wgKnRhcmdldCkKK3sKKwlzdHJ1Y3QgbG9naWN2Y19vZl9w
cm9wZXJ0eSAqcHJvcGVydHk7CisKKwlwcm9wZXJ0eSA9IGxvZ2ljdmNfb2ZfcHJvcGVydHlfbG9v
a3VwKG5hbWUpOworCWlmICghcHJvcGVydHkpIHsKKwkJKnRhcmdldCA9IGZhbHNlOworCQlyZXR1
cm47CisJfQorCisJKnRhcmdldCA9IG9mX3Byb3BlcnR5X3JlYWRfYm9vbChvZl9ub2RlLCBuYW1l
KTsKK30KKworYm9vbCBsb2dpY3ZjX29mX25vZGVfaXNfbGF5ZXIoc3RydWN0IGRldmljZV9ub2Rl
ICpvZl9ub2RlKQoreworCXJldHVybiAhb2Zfbm9kZV9jbXAob2Zfbm9kZS0+bmFtZSwgImxheWVy
Iik7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX29mLmgg
Yi9kcml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX29mLmgKbmV3IGZpbGUgbW9kZSAxMDA2
NDQKaW5kZXggMDAwMDAwMDAwMDAwLi41YzZmM2YzMzUwM2EKLS0tIC9kZXYvbnVsbAorKysgYi9k
cml2ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX29mLmgKQEAgLTAsMCArMSwyOCBAQAorLyog
U1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjArICovCisvKgorICogQ29weXJpZ2h0IChD
KSAyMDE5IEJvb3RsaW4KKyAqIEF1dGhvcjogUGF1bCBLb2NpYWxrb3dza2kgPHBhdWwua29jaWFs
a293c2tpQGJvb3RsaW4uY29tPgorICovCisKKyNpZm5kZWYgX0xPR0lDVkNfT0ZfSF8KKyNkZWZp
bmUgX0xPR0lDVkNfT0ZfSF8KKworc3RydWN0IGxvZ2ljdmNfb2ZfcHJvcGVydHlfc3YgeworCWNv
bnN0IGNoYXIgKnN0cmluZzsKKwl1MzIgdmFsdWU7Cit9OworCitzdHJ1Y3QgbG9naWN2Y19vZl9w
cm9wZXJ0eSB7CisJY2hhciAqbmFtZTsKKwlib29sIG9wdGlvbmFsOworCXN0cnVjdCBsb2dpY3Zj
X29mX3Byb3BlcnR5X3N2ICpzdjsKKwl1MzIgcmFuZ2VbMl07Cit9OworCitpbnQgbG9naWN2Y19v
Zl9wcm9wZXJ0eV9wYXJzZV91MzIoc3RydWN0IGRldmljZV9ub2RlICpvZl9ub2RlLAorCQkJCSAg
Y29uc3QgY2hhciAqbmFtZSwgdTMyICp0YXJnZXQpOwordm9pZCBsb2dpY3ZjX29mX3Byb3BlcnR5
X3BhcnNlX2Jvb2woc3RydWN0IGRldmljZV9ub2RlICpvZl9ub2RlLAorCQkJCSAgICBjb25zdCBj
aGFyICpuYW1lLCBib29sICp0YXJnZXQpOworYm9vbCBsb2dpY3ZjX29mX25vZGVfaXNfbGF5ZXIo
c3RydWN0IGRldmljZV9ub2RlICpvZl9ub2RlKTsKKworI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vbG9naWN2Yy9sb2dpY3ZjX3JlZ3MuaCBiL2RyaXZlcnMvZ3B1L2RybS9sb2dp
Y3ZjL2xvZ2ljdmNfcmVncy5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAw
MC4uZDBiZTVmZTg0ODU2Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvZ2lj
dmMvbG9naWN2Y19yZWdzLmgKQEAgLTAsMCArMSw4OCBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50
aWZpZXI6IEdQTC0yLjArICovCisvKgorICogQ29weXJpZ2h0IChDKSAyMDE5IEJvb3RsaW4KKyAq
IEF1dGhvcjogUGF1bCBLb2NpYWxrb3dza2kgPHBhdWwua29jaWFsa293c2tpQGJvb3RsaW4uY29t
PgorICoKKyAqIENvcHlyaWdodCAoQykgMjAxNCBYeWxvbiBkLm8uby4KKyAqIEF1dGhvcjogRGF2
b3IgSm9qYSA8ZGF2b3Iuam9qYUBsb2dpY2JyaWNrcy5jb20+CisgKi8KKworI2lmbmRlZiBfTE9H
SUNWQ19SRUdTX0hfCisjZGVmaW5lIF9MT0dJQ1ZDX1JFR1NfSF8KKworI2RlZmluZSBMT0dJQ1ZD
X0ZJRUxEX0dFVChmaWVsZCwgdmFsdWUpIFwKKwkoKCh2YWx1ZSkgJiBmaWVsZCMjX01BU0spID4+
IGZpZWxkIyNfU0hJRlQpCisjZGVmaW5lIExPR0lDVkNfRklFTERfU0VUKGZpZWxkLCB2YWx1ZSkg
XAorCSgoKHZhbHVlKSA8PCBmaWVsZCMjX1NISUZUKSAmIGZpZWxkIyNfTUFTSykKKworI2RlZmlu
ZSBMT0dJQ1ZDX0RJTUVOU0lPTlNfTUFYCQkoQklUKDE2KSAtIDEpCisKKyNkZWZpbmUgTE9HSUNW
Q19IU1lOQ19GUk9OVF9QT1JDSF9SRUcJMHgwMAorI2RlZmluZSBMT0dJQ1ZDX0hTWU5DX1JFRwkJ
MHgwOAorI2RlZmluZSBMT0dJQ1ZDX0hTWU5DX0JBQ0tfUE9SQ0hfUkVHCTB4MTAKKyNkZWZpbmUg
TE9HSUNWQ19IUkVTX1JFRwkJMHgxOAorI2RlZmluZSBMT0dJQ1ZDX1ZTWU5DX0ZST05UX1BPUkNI
X1JFRwkweDIwCisjZGVmaW5lIExPR0lDVkNfVlNZTkNfUkVHCQkweDI4CisjZGVmaW5lIExPR0lD
VkNfVlNZTkNfQkFDS19QT1JDSF9SRUcJMHgzMAorI2RlZmluZSBMT0dJQ1ZDX1ZSRVNfUkVHCQkw
eDM4CisKKyNkZWZpbmUgTE9HSUNWQ19DVFJMX1JFRwkJMHg0MAorI2RlZmluZSBMT0dJQ1ZDX0NU
UkxfQ0xPQ0tfSU5WRVJUCUJJVCg4KQorI2RlZmluZSBMT0dJQ1ZDX0NUUkxfUElYRUxfSU5WRVJU
CUJJVCg3KQorI2RlZmluZSBMT0dJQ1ZDX0NUUkxfREVfSU5WRVJUCQlCSVQoNSkKKyNkZWZpbmUg
TE9HSUNWQ19DVFJMX0RFX0VOQUJMRQkJQklUKDQpCisjZGVmaW5lIExPR0lDVkNfQ1RSTF9WU1lO
Q19JTlZFUlQJQklUKDMpCisjZGVmaW5lIExPR0lDVkNfQ1RSTF9WU1lOQ19FTkFCTEUJQklUKDIp
CisjZGVmaW5lIExPR0lDVkNfQ1RSTF9IU1lOQ19JTlZFUlQJQklUKDEpCisjZGVmaW5lIExPR0lD
VkNfQ1RSTF9IU1lOQ19FTkFCTEUJQklUKDApCisKKyNkZWZpbmUgTE9HSUNWQ19EVFlQRV9SRUcJ
CTB4NDgKKyNkZWZpbmUgTE9HSUNWQ19CQUNLR1JPVU5EX0NPTE9SX1JFRwkweDUwCisKKyNkZWZp
bmUgTE9HSUNWQ19CVUZGRVJfU0VMX1JFRwkJMHg1OAorI2RlZmluZSBMT0dJQ1ZDX0JVRkZFUl9T
RUxfVkFMVUUoaSwgdikgXAorCShCSVQoMTAgKyAoaSkpIHwgKCh2KSA8PCAoMiAqIChpKSkpKQor
I2RlZmluZSBMT0dJQ1ZDX0JVRkZFUl9TRUxfTUFYCQkyCisKKyNkZWZpbmUgTE9HSUNWQ19ET1VC
TEVfQ0xVVF9SRUcJCTB4NjAKKworI2RlZmluZSBMT0dJQ1ZDX0lOVF9TVEFUX1JFRwkJMHg2OAor
I2RlZmluZSBMT0dJQ1ZDX0lOVF9TVEFUX1ZfU1lOQwkJQklUKDUpCisKKyNkZWZpbmUgTE9HSUNW
Q19JTlRfTUFTS19SRUcJCTB4NzAKKyNkZWZpbmUgTE9HSUNWQ19JTlRfTUFTS19WX1NZTkMJCUJJ
VCg1KQorCisjZGVmaW5lIExPR0lDVkNfUE9XRVJfQ1RSTF9SRUcJCTB4NzgKKyNkZWZpbmUgTE9H
SUNWQ19QT1dFUl9DVFJMX0JBQ0tMSUdIVF9FTkFCTEUJQklUKDApCisjZGVmaW5lIExPR0lDVkNf
UE9XRVJfQ1RSTF9WRERfRU5BQkxFCQlCSVQoMSkKKyNkZWZpbmUgTE9HSUNWQ19QT1dFUl9DVFJM
X1ZFRV9FTkFCTEUJCUJJVCgyKQorI2RlZmluZSBMT0dJQ1ZDX1BPV0VSX0NUUkxfVklERU9fRU5B
QkxFCQlCSVQoMykKKworI2RlZmluZSBMT0dJQ1ZDX0lQX1ZFUlNJT05fUkVHCQkweGY4CisjZGVm
aW5lIExPR0lDVkNfSVBfVkVSU0lPTl9NQUpPUl9NQVNLCUdFTk1BU0soMTYsIDExKQorI2RlZmlu
ZSBMT0dJQ1ZDX0lQX1ZFUlNJT05fTUFKT1JfU0hJRlQJMTEKKyNkZWZpbmUgTE9HSUNWQ19JUF9W
RVJTSU9OX01JTk9SX01BU0sJR0VOTUFTSygxMCwgNSkKKyNkZWZpbmUgTE9HSUNWQ19JUF9WRVJT
SU9OX01JTk9SX1NISUZUCTUKKyNkZWZpbmUgTE9HSUNWQ19JUF9WRVJTSU9OX0xFVkVMX01BU0sJ
R0VOTUFTSyg0LCAwKQorI2RlZmluZSBMT0dJQ1ZDX0lQX1ZFUlNJT05fTEVWRUxfU0hJRlQJMAor
CisjZGVmaW5lIExPR0lDVkNfTEFZRVJfQUREUkVTU19SRUcoaSkJKDB4MTAwICsgKGkpICogMHg4
MCkKKyNkZWZpbmUgTE9HSUNWQ19MQVlFUl9IT0ZGU0VUX1JFRyhpKQkoMHgxMDAgKyAoaSkgKiAw
eDgwKQorCisjZGVmaW5lIExPR0lDVkNfTEFZRVJfVk9GRlNFVF9SRUcoaSkJKDB4MTA4ICsgKGkp
ICogMHg4MCkKKyNkZWZpbmUgTE9HSUNWQ19MQVlFUl9WT0ZGU0VUX01BWAk0MDk1CisKKyNkZWZp
bmUgTE9HSUNWQ19MQVlFUl9IUE9TSVRJT05fUkVHKGkpCSgweDExMCArIChpKSAqIDB4ODApCisj
ZGVmaW5lIExPR0lDVkNfTEFZRVJfVlBPU0lUSU9OX1JFRyhpKQkoMHgxMTggKyAoaSkgKiAweDgw
KQorI2RlZmluZSBMT0dJQ1ZDX0xBWUVSX1dJRFRIX1JFRyhpKQkoMHgxMjAgKyAoaSkgKiAweDgw
KQorI2RlZmluZSBMT0dJQ1ZDX0xBWUVSX0hFSUdIVF9SRUcoaSkJKDB4MTI4ICsgKGkpICogMHg4
MCkKKyNkZWZpbmUgTE9HSUNWQ19MQVlFUl9BTFBIQV9SRUcoaSkJKDB4MTMwICsgKGkpICogMHg4
MCkKKworI2RlZmluZSBMT0dJQ1ZDX0xBWUVSX0NUUkxfUkVHKGkpCSgweDEzOCArIChpKSAqIDB4
ODApCisjZGVmaW5lIExPR0lDVkNfTEFZRVJfQ1RSTF9FTkFCTEUJQklUKDApCisjZGVmaW5lIExP
R0lDVkNfTEFZRVJfQ1RSTF9DT0xPUl9LRVlfRElTQUJMRQlCSVQoMSkKKyNkZWZpbmUgTE9HSUNW
Q19MQVlFUl9DVFJMX1BJWEVMX0ZPUk1BVF9JTlZFUlQJQklUKDQpCisKKyNkZWZpbmUgTE9HSUNW
Q19MQVlFUl9DT0xPUl9LRVlfUkVHKGkpCSgweDE0MCArIChpKSAqIDB4ODApCisKKyNlbmRpZgot
LSAKMi4yNC4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
XwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcK
aHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
