Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id B9ED24921E
	for <lists+dri-devel@lfdr.de>; Mon, 17 Jun 2019 23:10:11 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 264EE6E0AE;
	Mon, 17 Jun 2019 21:10:07 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from perceval.ideasonboard.com (perceval.ideasonboard.com
 [213.167.242.64])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4914989FF7
 for <dri-devel@lists.freedesktop.org>; Mon, 17 Jun 2019 21:09:54 +0000 (UTC)
Received: from pendragon.bb.dnainternet.fi
 (dfj612yhrgyx302h3jwwy-3.rev.dnainternet.fi
 [IPv6:2001:14ba:21f5:5b00:ce28:277f:58d7:3ca4])
 by perceval.ideasonboard.com (Postfix) with ESMTPSA id 1C8549CB;
 Mon, 17 Jun 2019 23:09:52 +0200 (CEST)
From: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v3 01/10] media: vsp1: drm: Split vsp1_du_setup_lif()
Date: Tue, 18 Jun 2019 00:09:21 +0300
Message-Id: <20190617210930.6054-2-laurent.pinchart+renesas@ideasonboard.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190617210930.6054-1-laurent.pinchart+renesas@ideasonboard.com>
References: <20190617210930.6054-1-laurent.pinchart+renesas@ideasonboard.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=ideasonboard.com; s=mail; t=1560805792;
 bh=ZMZDVLFZKh4r5XVi4dRLL0P/twTRfpPLmiOfvbtmz1E=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=QdkQTrc3I+9dkB+oWi+27gVzUp6wOxmS5QvnjUKhso5gr31+cojCz8IBGQYwU2G5/
 ftyfvSUEWyfWeXCwVyOJL23y+UYGNcu0ISBC1H6VJDOvYNOk79mG4LCSOZtusudM58
 2WXYQ08VfUuEciqS7OSXi6+JS42SpXf78eZnF9Q4=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: linux-renesas-soc@vger.kernel.org,
 Kieran Bingham <kieran.bingham@ideasonboard.com>, linux-media@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogS2llcmFuIEJpbmdoYW0gPGtpZXJhbi5iaW5naGFtK3JlbmVzYXNAaWRlYXNvbmJvYXJk
LmNvbT4KCkJyZWFrIHZzcDFfZHVfc2V0dXBfbGlmKCkgaW50byBjb21wb25lbnRzIG1vcmUgc3Vp
dGVkIHRvIHRoZSBEUk0gQXRvbWljCkFQSS4gVGhlIGV4aXN0aW5nIHZzcDFfZHVfc2V0dXBfbGlm
KCkgQVBJIGNhbGwgaXMgbWFpbnRhaW5lZCBhcyBpdCBpcwpzdGlsbCB1c2VkIGZyb20gdGhlIERV
LgoKU2lnbmVkLW9mZi1ieTogS2llcmFuIEJpbmdoYW0gPGtpZXJhbi5iaW5naGFtK3JlbmVzYXNA
aWRlYXNvbmJvYXJkLmNvbT4KU2lnbmVkLW9mZi1ieTogTGF1cmVudCBQaW5jaGFydCA8bGF1cmVu
dC5waW5jaGFydCtyZW5lc2FzQGlkZWFzb25ib2FyZC5jb20+Ci0tLQpDaGFuZ2VzIHNpbmNlIHYy
OgoKLSBNaW5vciBmb3JtYXR0aW5nIGNoYW5nZXMKLSBGaXggTlVMTCBwb2ludGVyIGRlcmVmZXJl
bmNlIGluIHZzcDFfZHVfc2V0dXBfbGlmKCkKLS0tCiBkcml2ZXJzL21lZGlhL3BsYXRmb3JtL3Zz
cDEvdnNwMV9kcm0uYyB8IDIyMCArKysrKysrKysrKysrKysrKystLS0tLS0tCiBpbmNsdWRlL21l
ZGlhL3ZzcDEuaCAgICAgICAgICAgICAgICAgICB8ICAzMiArKystCiAyIGZpbGVzIGNoYW5nZWQs
IDE4OSBpbnNlcnRpb25zKCspLCA2MyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJz
L21lZGlhL3BsYXRmb3JtL3ZzcDEvdnNwMV9kcm0uYyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0v
dnNwMS92c3AxX2RybS5jCmluZGV4IGE0YTQ1ZDY4YTZlZi4uNzk1N2UxNDM5ZGUwIDEwMDY0NAot
LS0gYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3ZzcDEvdnNwMV9kcm0uYworKysgYi9kcml2ZXJz
L21lZGlhL3BsYXRmb3JtL3ZzcDEvdnNwMV9kcm0uYwpAQCAtNjE2LDEwICs2MTYsMTAgQEAgaW50
IHZzcDFfZHVfaW5pdChzdHJ1Y3QgZGV2aWNlICpkZXYpCiBFWFBPUlRfU1lNQk9MX0dQTCh2c3Ax
X2R1X2luaXQpOwogCiAvKioKLSAqIHZzcDFfZHVfc2V0dXBfbGlmIC0gU2V0dXAgdGhlIG91dHB1
dCBwYXJ0IG9mIHRoZSBWU1AgcGlwZWxpbmUKKyAqIHZzcDFfZHVfYXRvbWljX21vZGVzZXQgLSBD
b25maWd1cmUgdGhlIG1vZGUgYXMgcGFydCBvZiBhbiBhdG9taWMgdXBkYXRlCiAgKiBAZGV2OiB0
aGUgVlNQIGRldmljZQogICogQHBpcGVfaW5kZXg6IHRoZSBEUk0gcGlwZWxpbmUgaW5kZXgKLSAq
IEBjZmc6IHRoZSBMSUYgY29uZmlndXJhdGlvbgorICogQGNmZzogdGhlIG1vZGUgY29uZmlndXJh
dGlvbgogICoKICAqIENvbmZpZ3VyZSB0aGUgb3V0cHV0IHBhcnQgb2YgVlNQIERSTSBwaXBlbGlu
ZSBmb3IgdGhlIGdpdmVuIGZyYW1lIEBjZmcud2lkdGgKICAqIGFuZCBAY2ZnLmhlaWdodC4gVGhp
cyBzZXRzIHVwIGZvcm1hdHMgb24gdGhlIEJSeCBzb3VyY2UgcGFkLCB0aGUgV1BGIHNpbmsgYW5k
CkBAIC02MzYsMTQgKzYzNiwxMiBAQCBFWFBPUlRfU1lNQk9MX0dQTCh2c3AxX2R1X2luaXQpOwog
ICoKICAqIFJldHVybiAwIG9uIHN1Y2Nlc3Mgb3IgYSBuZWdhdGl2ZSBlcnJvciBjb2RlIG9uIGZh
aWx1cmUuCiAgKi8KLWludCB2c3AxX2R1X3NldHVwX2xpZihzdHJ1Y3QgZGV2aWNlICpkZXYsIHVu
c2lnbmVkIGludCBwaXBlX2luZGV4LAotCQkgICAgICBjb25zdCBzdHJ1Y3QgdnNwMV9kdV9saWZf
Y29uZmlnICpjZmcpCitpbnQgdnNwMV9kdV9hdG9taWNfbW9kZXNldChzdHJ1Y3QgZGV2aWNlICpk
ZXYsIHVuc2lnbmVkIGludCBwaXBlX2luZGV4LAorCQkJICAgY29uc3Qgc3RydWN0IHZzcDFfZHVf
bW9kZXNldF9jb25maWcgKmNmZykKIHsKIAlzdHJ1Y3QgdnNwMV9kZXZpY2UgKnZzcDEgPSBkZXZf
Z2V0X2RydmRhdGEoZGV2KTsKIAlzdHJ1Y3QgdnNwMV9kcm1fcGlwZWxpbmUgKmRybV9waXBlOwog
CXN0cnVjdCB2c3AxX3BpcGVsaW5lICpwaXBlOwotCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Ci0JdW5z
aWduZWQgaW50IGk7CiAJaW50IHJldDsKIAogCWlmIChwaXBlX2luZGV4ID49IHZzcDEtPmluZm8t
PmxpZl9jb3VudCkKQEAgLTY1Miw2MCArNjUwLDYgQEAgaW50IHZzcDFfZHVfc2V0dXBfbGlmKHN0
cnVjdCBkZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IHBpcGVfaW5kZXgsCiAJZHJtX3BpcGUgPSAm
dnNwMS0+ZHJtLT5waXBlW3BpcGVfaW5kZXhdOwogCXBpcGUgPSAmZHJtX3BpcGUtPnBpcGU7CiAK
LQlpZiAoIWNmZykgewotCQlzdHJ1Y3QgdnNwMV9icnggKmJyeDsKLQotCQltdXRleF9sb2NrKCZ2
c3AxLT5kcm0tPmxvY2spOwotCi0JCWJyeCA9IHRvX2JyeCgmcGlwZS0+YnJ4LT5zdWJkZXYpOwot
Ci0JCS8qCi0JCSAqIE5VTEwgY29uZmlndXJhdGlvbiBtZWFucyB0aGUgQ1JUQyBpcyBiZWluZyBk
aXNhYmxlZCwgc3RvcAotCQkgKiB0aGUgcGlwZWxpbmUgYW5kIHR1cm4gdGhlIGxpZ2h0IG9mZi4K
LQkJICovCi0JCXJldCA9IHZzcDFfcGlwZWxpbmVfc3RvcChwaXBlKTsKLQkJaWYgKHJldCA9PSAt
RVRJTUVET1VUKQotCQkJZGV2X2Vycih2c3AxLT5kZXYsICJEUk0gcGlwZWxpbmUgc3RvcCB0aW1l
b3V0XG4iKTsKLQotCQlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShwaXBlLT5pbnB1dHMpOyAr
K2kpIHsKLQkJCXN0cnVjdCB2c3AxX3J3cGYgKnJwZiA9IHBpcGUtPmlucHV0c1tpXTsKLQotCQkJ
aWYgKCFycGYpCi0JCQkJY29udGludWU7Ci0KLQkJCS8qCi0JCQkgKiBSZW1vdmUgdGhlIFJQRiBm
cm9tIHRoZSBwaXBlIGFuZCB0aGUgbGlzdCBvZiBCUngKLQkJCSAqIGlucHV0cy4KLQkJCSAqLwot
CQkJV0FSTl9PTighcnBmLT5lbnRpdHkucGlwZSk7Ci0JCQlycGYtPmVudGl0eS5waXBlID0gTlVM
TDsKLQkJCWxpc3RfZGVsKCZycGYtPmVudGl0eS5saXN0X3BpcGUpOwotCQkJcGlwZS0+aW5wdXRz
W2ldID0gTlVMTDsKLQotCQkJYnJ4LT5pbnB1dHNbcnBmLT5icnhfaW5wdXRdLnJwZiA9IE5VTEw7
Ci0JCX0KLQotCQlkcm1fcGlwZS0+ZHVfY29tcGxldGUgPSBOVUxMOwotCQlwaXBlLT5udW1faW5w
dXRzID0gMDsKLQotCQlkZXZfZGJnKHZzcDEtPmRldiwgIiVzOiBwaXBlICV1OiByZWxlYXNpbmcg
JXNcbiIsCi0JCQlfX2Z1bmNfXywgcGlwZS0+bGlmLT5pbmRleCwKLQkJCUJSWF9OQU1FKHBpcGUt
PmJyeCkpOwotCi0JCWxpc3RfZGVsKCZwaXBlLT5icngtPmxpc3RfcGlwZSk7Ci0JCXBpcGUtPmJy
eC0+cGlwZSA9IE5VTEw7Ci0JCXBpcGUtPmJyeCA9IE5VTEw7Ci0KLQkJbXV0ZXhfdW5sb2NrKCZ2
c3AxLT5kcm0tPmxvY2spOwotCi0JCXZzcDFfZGxtX3Jlc2V0KHBpcGUtPm91dHB1dC0+ZGxtKTsK
LQkJdnNwMV9kZXZpY2VfcHV0KHZzcDEpOwotCi0JCWRldl9kYmcodnNwMS0+ZGV2LCAiJXM6IHBp
cGVsaW5lIGRpc2FibGVkXG4iLCBfX2Z1bmNfXyk7Ci0KLQkJcmV0dXJuIDA7Ci0JfQotCiAJZHJt
X3BpcGUtPndpZHRoID0gY2ZnLT53aWR0aDsKIAlkcm1fcGlwZS0+aGVpZ2h0ID0gY2ZnLT5oZWln
aHQ7CiAJcGlwZS0+aW50ZXJsYWNlZCA9IGNmZy0+aW50ZXJsYWNlZDsKQEAgLTcyMiw4ICs2NjYs
NDMgQEAgaW50IHZzcDFfZHVfc2V0dXBfbGlmKHN0cnVjdCBkZXZpY2UgKmRldiwgdW5zaWduZWQg
aW50IHBpcGVfaW5kZXgsCiAJCWdvdG8gdW5sb2NrOwogCiAJcmV0ID0gdnNwMV9kdV9waXBlbGlu
ZV9zZXR1cF9vdXRwdXQodnNwMSwgcGlwZSk7Ci0JaWYgKHJldCA8IDApCi0JCWdvdG8gdW5sb2Nr
OworCit1bmxvY2s6CisJbXV0ZXhfdW5sb2NrKCZ2c3AxLT5kcm0tPmxvY2spOworCisJcmV0dXJu
IHJldDsKK30KKworLyoqCisgKiB2c3AxX2R1X2F0b21pY19lbmFibGUgLSBFbmFibGUgYW5kIHN0
YXJ0IGEgRFUgcGlwZWxpbmUKKyAqIEBkZXY6IHRoZSBWU1AgZGV2aWNlCisgKiBAcGlwZV9pbmRl
eDogdGhlIERSTSBwaXBlbGluZSBpbmRleAorICogQGNmZzogdGhlIGVuYWJsZW1lbnQgY29uZmln
dXJhdGlvbgorICoKKyAqIFRoZSBAcGlwZV9pbmRleCBhcmd1bWVudCBzZWxlY3RzIHdoaWNoIERS
TSBwaXBlbGluZSB0byBlbmFibGUuIFRoZSBudW1iZXIgb2YKKyAqIGF2YWlsYWJsZSBwaXBlbGlu
ZXMgZGVwZW5kIG9uIHRoZSBWU1AgaW5zdGFuY2UuCisgKgorICogVGhlIGNvbmZpZ3VyYXRpb24g
cGFzc2VzIGEgY2FsbGJhY2sgZnVuY3Rpb24gdG8gcmVnaXN0ZXIgbm90aWZpY2F0aW9uIG9mCisg
KiBmcmFtZSBjb21wbGV0aW9uIGV2ZW50cy4KKyAqCisgKiBSZXR1cm4gMCBvbiBzdWNjZXNzIG9y
IGEgbmVnYXRpdmUgZXJyb3IgY29kZSBvbiBmYWlsdXJlLgorICovCitpbnQgdnNwMV9kdV9hdG9t
aWNfZW5hYmxlKHN0cnVjdCBkZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IHBpcGVfaW5kZXgsCisJ
CQkgIGNvbnN0IHN0cnVjdCB2c3AxX2R1X2VuYWJsZV9jb25maWcgKmNmZykKK3sKKwlzdHJ1Y3Qg
dnNwMV9kZXZpY2UgKnZzcDEgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKKwlzdHJ1Y3QgdnNwMV9k
cm1fcGlwZWxpbmUgKmRybV9waXBlOworCXN0cnVjdCB2c3AxX3BpcGVsaW5lICpwaXBlOworCXVu
c2lnbmVkIGxvbmcgZmxhZ3M7CisJaW50IHJldDsKKworCWlmIChwaXBlX2luZGV4ID49IHZzcDEt
PmluZm8tPmxpZl9jb3VudCkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlkcm1fcGlwZSA9ICZ2c3Ax
LT5kcm0tPnBpcGVbcGlwZV9pbmRleF07CisJcGlwZSA9ICZkcm1fcGlwZS0+cGlwZTsKKworCW11
dGV4X2xvY2soJnZzcDEtPmRybS0+bG9jayk7CiAKIAkvKiBFbmFibGUgdGhlIFZTUDEuICovCiAJ
cmV0ID0gdnNwMV9kZXZpY2VfZ2V0KHZzcDEpOwpAQCAtNzU4LDYgKzczNywxMjMgQEAgaW50IHZz
cDFfZHVfc2V0dXBfbGlmKHN0cnVjdCBkZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IHBpcGVfaW5k
ZXgsCiAJZGV2X2RiZyh2c3AxLT5kZXYsICIlczogcGlwZWxpbmUgZW5hYmxlZFxuIiwgX19mdW5j
X18pOwogCiAJcmV0dXJuIDA7CisKK30KK0VYUE9SVF9TWU1CT0xfR1BMKHZzcDFfZHVfYXRvbWlj
X2VuYWJsZSk7CisKKy8qKgorICogdnNwMV9kdV9hdG9taWNfZGlzYWJsZSAtIERpc2FibGUgYW5k
IHN0b3AgYSBEVSBwaXBlbGluZQorICogQGRldjogdGhlIFZTUCBkZXZpY2UKKyAqIEBwaXBlX2lu
ZGV4OiB0aGUgRFJNIHBpcGVsaW5lIGluZGV4CisgKgorICogVGhlIEBwaXBlX2luZGV4IGFyZ3Vt
ZW50IHNlbGVjdHMgd2hpY2ggRFJNIHBpcGVsaW5lIHRvIGRpc2FibGUuIFRoZSBudW1iZXIKKyAq
IG9mIGF2YWlsYWJsZSBwaXBlbGluZXMgZGVwZW5kIG9uIHRoZSBWU1AgaW5zdGFuY2UuCisgKgor
ICogUmV0dXJuIDAgb24gc3VjY2VzcyBvciBhIG5lZ2F0aXZlIGVycm9yIGNvZGUgb24gZmFpbHVy
ZS4KKyAqLworaW50IHZzcDFfZHVfYXRvbWljX2Rpc2FibGUoc3RydWN0IGRldmljZSAqZGV2LCB1
bnNpZ25lZCBpbnQgcGlwZV9pbmRleCkKK3sKKwlzdHJ1Y3QgdnNwMV9kZXZpY2UgKnZzcDEgPSBk
ZXZfZ2V0X2RydmRhdGEoZGV2KTsKKwlzdHJ1Y3QgdnNwMV9kcm1fcGlwZWxpbmUgKmRybV9waXBl
OworCXN0cnVjdCB2c3AxX3BpcGVsaW5lICpwaXBlOworCXN0cnVjdCB2c3AxX2JyeCAqYnJ4Owor
CXVuc2lnbmVkIGludCBpOworCWludCByZXQ7CisKKwlpZiAocGlwZV9pbmRleCA+PSB2c3AxLT5p
bmZvLT5saWZfY291bnQpCisJCXJldHVybiAtRUlOVkFMOworCisJZHJtX3BpcGUgPSAmdnNwMS0+
ZHJtLT5waXBlW3BpcGVfaW5kZXhdOworCXBpcGUgPSAmZHJtX3BpcGUtPnBpcGU7CisKKwltdXRl
eF9sb2NrKCZ2c3AxLT5kcm0tPmxvY2spOworCisJYnJ4ID0gdG9fYnJ4KCZwaXBlLT5icngtPnN1
YmRldik7CisKKwkvKiBTdG9wIHRoZSBwaXBlbGluZSBhbmQgdHVybiB0aGUgbGlnaHQgb2ZmLiAq
LworCXJldCA9IHZzcDFfcGlwZWxpbmVfc3RvcChwaXBlKTsKKwlpZiAocmV0ID09IC1FVElNRURP
VVQpCisJCWRldl9lcnIodnNwMS0+ZGV2LCAiRFJNIHBpcGVsaW5lIHN0b3AgdGltZW91dFxuIik7
CisKKwlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShwaXBlLT5pbnB1dHMpOyArK2kpIHsKKwkJ
c3RydWN0IHZzcDFfcndwZiAqcnBmID0gcGlwZS0+aW5wdXRzW2ldOworCisJCWlmICghcnBmKQor
CQkJY29udGludWU7CisKKwkJLyogUmVtb3ZlIHRoZSBSUEYgZnJvbSB0aGUgcGlwZSBhbmQgdGhl
IGxpc3Qgb2YgQlJ4IGlucHV0cy4gKi8KKwkJV0FSTl9PTighcnBmLT5lbnRpdHkucGlwZSk7CisJ
CXJwZi0+ZW50aXR5LnBpcGUgPSBOVUxMOworCQlsaXN0X2RlbCgmcnBmLT5lbnRpdHkubGlzdF9w
aXBlKTsKKwkJcGlwZS0+aW5wdXRzW2ldID0gTlVMTDsKKworCQlicngtPmlucHV0c1tycGYtPmJy
eF9pbnB1dF0ucnBmID0gTlVMTDsKKwl9CisKKwlkcm1fcGlwZS0+ZHVfY29tcGxldGUgPSBOVUxM
OworCXBpcGUtPm51bV9pbnB1dHMgPSAwOworCisJZGV2X2RiZyh2c3AxLT5kZXYsICIlczogcGlw
ZSAldTogcmVsZWFzaW5nICVzXG4iLCBfX2Z1bmNfXywKKwkJcGlwZS0+bGlmLT5pbmRleCwgQlJY
X05BTUUocGlwZS0+YnJ4KSk7CisKKwlsaXN0X2RlbCgmcGlwZS0+YnJ4LT5saXN0X3BpcGUpOwor
CXBpcGUtPmJyeC0+cGlwZSA9IE5VTEw7CisJcGlwZS0+YnJ4ID0gTlVMTDsKKworCW11dGV4X3Vu
bG9jaygmdnNwMS0+ZHJtLT5sb2NrKTsKKworCXZzcDFfZGxtX3Jlc2V0KHBpcGUtPm91dHB1dC0+
ZGxtKTsKKwl2c3AxX2RldmljZV9wdXQodnNwMSk7CisKKwlkZXZfZGJnKHZzcDEtPmRldiwgIiVz
OiBwaXBlbGluZSBkaXNhYmxlZFxuIiwgX19mdW5jX18pOworCisJcmV0dXJuIDA7Cit9CitFWFBP
UlRfU1lNQk9MX0dQTCh2c3AxX2R1X2F0b21pY19kaXNhYmxlKTsKKworLyoqCisgKiB2c3AxX2R1
X3NldHVwX2xpZiAtIFNldHVwIHRoZSBvdXRwdXQgcGFydCBvZiB0aGUgVlNQIHBpcGVsaW5lCisg
KiBAZGV2OiB0aGUgVlNQIGRldmljZQorICogQHBpcGVfaW5kZXg6IHRoZSBEUk0gcGlwZWxpbmUg
aW5kZXgKKyAqIEBjZmc6IHRoZSBMSUYgY29uZmlndXJhdGlvbgorICoKKyAqIENvbmZpZ3VyZSB0
aGUgb3V0cHV0IHBhcnQgb2YgVlNQIERSTSBwaXBlbGluZSBmb3IgdGhlIGdpdmVuIGZyYW1lIEBj
Zmcud2lkdGgKKyAqIGFuZCBAY2ZnLmhlaWdodC4gVGhpcyBzZXRzIHVwIGZvcm1hdHMgb24gdGhl
IEJSeCBzb3VyY2UgcGFkLCB0aGUgV1BGIHNpbmsgYW5kCisgKiBzb3VyY2UgcGFkcywgYW5kIHRo
ZSBMSUYgc2luayBwYWQuCisgKgorICogVGhlIEBwaXBlX2luZGV4IGFyZ3VtZW50IHNlbGVjdHMg
d2hpY2ggRFJNIHBpcGVsaW5lIHRvIHNldHVwLiBUaGUgbnVtYmVyIG9mCisgKiBhdmFpbGFibGUg
cGlwZWxpbmVzIGRlcGVuZCBvbiB0aGUgVlNQIGluc3RhbmNlLgorICoKKyAqIEFzIHRoZSBtZWRp
YSBidXMgY29kZSBvbiB0aGUgYmxlbmQgdW5pdCBzb3VyY2UgcGFkIGlzIGNvbmRpdGlvbmVkIGJ5
IHRoZQorICogY29uZmlndXJhdGlvbiBvZiBpdHMgc2luayAwIHBhZCwgd2UgYWxzbyBzZXQgdXAg
dGhlIGZvcm1hdHMgb24gYWxsIGJsZW5kIHVuaXQKKyAqIHNpbmtzLCBldmVuIGlmIHRoZSBjb25m
aWd1cmF0aW9uIHdpbGwgYmUgb3ZlcndyaXR0ZW4gbGF0ZXIgYnkKKyAqIHZzcDFfZHVfc2V0dXBf
cnBmKCkuIFRoaXMgZW5zdXJlcyB0aGF0IHRoZSBibGVuZCB1bml0IGNvbmZpZ3VyYXRpb24gaXMg
c2V0IHRvCisgKiBhIHdlbGwgZGVmaW5lZCBzdGF0ZS4KKyAqCisgKiBSZXR1cm4gMCBvbiBzdWNj
ZXNzIG9yIGEgbmVnYXRpdmUgZXJyb3IgY29kZSBvbiBmYWlsdXJlLgorICovCitpbnQgdnNwMV9k
dV9zZXR1cF9saWYoc3RydWN0IGRldmljZSAqZGV2LCB1bnNpZ25lZCBpbnQgcGlwZV9pbmRleCwK
KwkJICAgICAgY29uc3Qgc3RydWN0IHZzcDFfZHVfbGlmX2NvbmZpZyAqY2ZnKQoreworCXN0cnVj
dCB2c3AxX2R1X21vZGVzZXRfY29uZmlnIG1vZGVzOworCXN0cnVjdCB2c3AxX2R1X2VuYWJsZV9j
b25maWcgZW5hYmxlOworCWludCByZXQ7CisKKwlpZiAoIWNmZykKKwkJcmV0dXJuIHZzcDFfZHVf
YXRvbWljX2Rpc2FibGUoZGV2LCBwaXBlX2luZGV4KTsKKworCW1vZGVzLndpZHRoID0gY2ZnLT53
aWR0aDsKKwltb2Rlcy5oZWlnaHQgPSBjZmctPmhlaWdodDsKKwltb2Rlcy5pbnRlcmxhY2VkID0g
Y2ZnLT5pbnRlcmxhY2VkOworCisJcmV0ID0gdnNwMV9kdV9hdG9taWNfbW9kZXNldChkZXYsIHBp
cGVfaW5kZXgsICZtb2Rlcyk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCWVuYWJsZS5j
YWxsYmFjayA9IGNmZy0+Y2FsbGJhY2s7CisJZW5hYmxlLmNhbGxiYWNrX2RhdGEgPSBjZmctPmNh
bGxiYWNrX2RhdGE7CisKKwlyZXR1cm4gdnNwMV9kdV9hdG9taWNfZW5hYmxlKGRldiwgcGlwZV9p
bmRleCwgJmVuYWJsZSk7CiB9CiBFWFBPUlRfU1lNQk9MX0dQTCh2c3AxX2R1X3NldHVwX2xpZik7
CiAKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbWVkaWEvdnNwMS5oIGIvaW5jbHVkZS9tZWRpYS92c3Ax
LmgKaW5kZXggY2MxYjBkNDJjZTk1Li41NjY0M2Y5N2Q0YzkgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUv
bWVkaWEvdnNwMS5oCisrKyBiL2luY2x1ZGUvbWVkaWEvdnNwMS5oCkBAIC0yMSw3ICsyMSw3IEBA
IGludCB2c3AxX2R1X2luaXQoc3RydWN0IGRldmljZSAqZGV2KTsKICNkZWZpbmUgVlNQMV9EVV9T
VEFUVVNfV1JJVEVCQUNLCUJJVCgxKQogCiAvKioKLSAqIHN0cnVjdCB2c3AxX2R1X2xpZl9jb25m
aWcgLSBWU1AgTElGIGNvbmZpZ3VyYXRpb24KKyAqIHN0cnVjdCB2c3AxX2R1X2xpZl9jb25maWcg
LSBWU1AgTElGIGNvbmZpZ3VyYXRpb24gLSBEZXByZWNhdGVkCiAgKiBAd2lkdGg6IG91dHB1dCBm
cmFtZSB3aWR0aAogICogQGhlaWdodDogb3V0cHV0IGZyYW1lIGhlaWdodAogICogQGludGVybGFj
ZWQ6IHRydWUgZm9yIGludGVybGFjZWQgcGlwZWxpbmVzCkBAIC00Miw2ICs0MiwzMCBAQCBzdHJ1
Y3QgdnNwMV9kdV9saWZfY29uZmlnIHsKIGludCB2c3AxX2R1X3NldHVwX2xpZihzdHJ1Y3QgZGV2
aWNlICpkZXYsIHVuc2lnbmVkIGludCBwaXBlX2luZGV4LAogCQkgICAgICBjb25zdCBzdHJ1Y3Qg
dnNwMV9kdV9saWZfY29uZmlnICpjZmcpOwogCisvKioKKyAqIHN0cnVjdCB2c3AxX2R1X21vZGVz
ZXRfY29uZmlnIC0gVlNQIGRpc3BsYXkgbW9kZSBjb25maWd1cmF0aW9uCisgKiBAd2lkdGg6IG91
dHB1dCBmcmFtZSB3aWR0aAorICogQGhlaWdodDogb3V0cHV0IGZyYW1lIGhlaWdodAorICogQGlu
dGVybGFjZWQ6IHRydWUgZm9yIGludGVybGFjZWQgcGlwZWxpbmVzCisgKi8KK3N0cnVjdCB2c3Ax
X2R1X21vZGVzZXRfY29uZmlnIHsKKwl1bnNpZ25lZCBpbnQgd2lkdGg7CisJdW5zaWduZWQgaW50
IGhlaWdodDsKKwlib29sIGludGVybGFjZWQ7Cit9OworCisvKioKKyAqIHN0cnVjdCB2c3AxX2R1
X2VuYWJsZV9jb25maWcgLSBWU1AgZW5hYmxlIGNvbmZpZ3VyYXRpb24KKyAqIEBjYWxsYmFjazog
ZnJhbWUgY29tcGxldGlvbiBjYWxsYmFjayBmdW5jdGlvbiAob3B0aW9uYWwpLiBXaGVuIGEgY2Fs
bGJhY2sKKyAqCSAgICAgIGlzIHByb3ZpZGVkLCB0aGUgVlNQIGRyaXZlciBndWFyYW50ZWVzIHRo
YXQgaXQgd2lsbCBiZSBjYWxsZWQgb25jZQorICoJICAgICAgYW5kIG9ubHkgb25jZSBmb3IgZWFj
aCB2c3AxX2R1X2F0b21pY19mbHVzaCgpIGNhbGwuCisgKiBAY2FsbGJhY2tfZGF0YTogZGF0YSB0
byBiZSBwYXNzZWQgdG8gdGhlIGZyYW1lIGNvbXBsZXRpb24gY2FsbGJhY2sKKyAqLworc3RydWN0
IHZzcDFfZHVfZW5hYmxlX2NvbmZpZyB7CisJdm9pZCAoKmNhbGxiYWNrKSh2b2lkICpkYXRhLCB1
bnNpZ25lZCBpbnQgc3RhdHVzLCB1MzIgY3JjKTsKKwl2b2lkICpjYWxsYmFja19kYXRhOworfTsK
KwogLyoqCiAgKiBzdHJ1Y3QgdnNwMV9kdV9hdG9taWNfY29uZmlnIC0gVlNQIGF0b21pYyBjb25m
aWd1cmF0aW9uIHBhcmFtZXRlcnMKICAqIEBwaXhlbGZvcm1hdDogcGxhbmUgcGl4ZWwgZm9ybWF0
IChWNEwyIDRDQykKQEAgLTEwNiw2ICsxMzAsMTIgQEAgc3RydWN0IHZzcDFfZHVfYXRvbWljX3Bp
cGVfY29uZmlnIHsKIAlzdHJ1Y3QgdnNwMV9kdV93cml0ZWJhY2tfY29uZmlnIHdyaXRlYmFjazsK
IH07CiAKKworaW50IHZzcDFfZHVfYXRvbWljX21vZGVzZXQoc3RydWN0IGRldmljZSAqZGV2LCB1
bnNpZ25lZCBpbnQgcGlwZV9pbmRleCwKKwkJICAgIGNvbnN0IHN0cnVjdCB2c3AxX2R1X21vZGVz
ZXRfY29uZmlnICpjZmcpOworaW50IHZzcDFfZHVfYXRvbWljX2VuYWJsZShzdHJ1Y3QgZGV2aWNl
ICpkZXYsIHVuc2lnbmVkIGludCBwaXBlX2luZGV4LAorCQkgICBjb25zdCBzdHJ1Y3QgdnNwMV9k
dV9lbmFibGVfY29uZmlnICpjZmcpOworaW50IHZzcDFfZHVfYXRvbWljX2Rpc2FibGUoc3RydWN0
IGRldmljZSAqZGV2LCB1bnNpZ25lZCBpbnQgcGlwZV9pbmRleCk7CiB2b2lkIHZzcDFfZHVfYXRv
bWljX2JlZ2luKHN0cnVjdCBkZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IHBpcGVfaW5kZXgpOwog
aW50IHZzcDFfZHVfYXRvbWljX3VwZGF0ZShzdHJ1Y3QgZGV2aWNlICpkZXYsIHVuc2lnbmVkIGlu
dCBwaXBlX2luZGV4LAogCQkJICB1bnNpZ25lZCBpbnQgcnBmLAotLSAKUmVnYXJkcywKCkxhdXJl
bnQgUGluY2hhcnQKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9y
ZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZl
bA==
