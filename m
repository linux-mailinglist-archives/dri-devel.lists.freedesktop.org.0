Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id C9DB7DCDE9
	for <lists+dri-devel@lfdr.de>; Fri, 18 Oct 2019 20:25:08 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B45DE6EB85;
	Fri, 18 Oct 2019 18:25:05 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-lj1-x242.google.com (mail-lj1-x242.google.com
 [IPv6:2a00:1450:4864:20::242])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9A2326EB85
 for <dri-devel@lists.freedesktop.org>; Fri, 18 Oct 2019 18:25:02 +0000 (UTC)
Received: by mail-lj1-x242.google.com with SMTP id f5so7161533ljg.8
 for <dri-devel@lists.freedesktop.org>; Fri, 18 Oct 2019 11:25:02 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=KTI0dYLPEYExfO+lEpdRyDqfbGBYjF43OVtqy8KOjE4=;
 b=QqaUj5Ju/xOHM5q8RpFqVGLXhsFcWPzQ3HUif/T/Jwdxn5E4IrGWwXkvFH81l2U7UN
 go4FeEpCes0DYknETgeNHH6o0+f0x3ICrwl3qkQuBXUBeh6Sr3UADkTecS9TN6LFboAf
 pERUzml1k29JqXJ06yHvaT3QGDH0tmLUgkZSOsklfICFsOWKkAs9ic65eMrtFq1mvczR
 Hg0QlWOhdcjyTEkwj8K91UHi2d+alcWy75fjaIBOssL+NhoBNYV4o6g5UNsk7ZfDzPci
 Ys78X+1htDzdkR12wN4jc/pvi5FHypL9z6Kksi3b0Ca84OVmF3Z82lRRE96nqDL4ZT79
 0sNg==
X-Gm-Message-State: APjAAAUnSf//AMfwN54P1kK2QfldkkdWVFrNwEpQIdoNsKKLODIJwMkS
 6h8nsLrQjUj5vRwJG+bEynAOKA==
X-Google-Smtp-Source: APXvYqywUV8R0u/Ci2CEiGXM2P1V1ClIXVVBQuvyMCJYe407AYePUUE9wRH2lmVvuPJKSpkT9h7wag==
X-Received: by 2002:a2e:9e85:: with SMTP id f5mr6312751ljk.235.1571423100413; 
 Fri, 18 Oct 2019 11:25:00 -0700 (PDT)
Received: from genomnajs.ideon.se ([85.235.10.227])
 by smtp.gmail.com with ESMTPSA id g26sm3020617lje.80.2019.10.18.11.24.58
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 18 Oct 2019 11:24:59 -0700 (PDT)
From: Linus Walleij <linus.walleij@linaro.org>
To: Thierry Reding <thierry.reding@gmail.com>, Sam Ravnborg <sam@ravnborg.org>,
 dri-devel@lists.freedesktop.org, Andrzej Hajda <a.hajda@samsung.com>
Subject: [PATCH 3/3 v3] drm/panel: Add driver for Sony ACX424AKP panel
Date: Fri, 18 Oct 2019 20:24:46 +0200
Message-Id: <20191018182446.26131-3-linus.walleij@linaro.org>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20191018182446.26131-1-linus.walleij@linaro.org>
References: <20191018182446.26131-1-linus.walleij@linaro.org>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=linaro.org; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=KTI0dYLPEYExfO+lEpdRyDqfbGBYjF43OVtqy8KOjE4=;
 b=Kx0nEZzzr7k0q1x4niuO2/FW9SxP8PCzIlPEMMVYIfIQA8b23gT49LRmnyWe8UVkA0
 Y4Q25JN1pf/DkIiXsF7e80vxaiHVdhtAeaDZCIGLJxRlbhFy1BATIBbnKhHfq7/jMTKO
 SfW2ehHiqaiqOFx27OHyfL5id9GO6zKNBX+9XZ57hVJJhy/W9tKwJLXu2XqU5F4Pi0/3
 JTi+j5n7S1e3G/MR7UuujYEPVtQHVTEDrDSOL5yyGuh05XDFwgauLmVeNcBc83rfYSw8
 iZE/31FotW0VV/13gVlWggtpRdVhEk0C4QdCWNqgTBk/Gy7MSN0YsFTA6xEsqEAmsIOF
 RxAA==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIFNvbnkgQUNYNDI0QUtQIGlzIGEgY29tbWFuZC92aWRlb21vZGUgRFNJIHBhbmVsIGZvcgpt
b2JpbGUgZGV2aWNlcy4gSXQgaXMgdXNlZCBvbiB0aGUgU1QtRXJpY3Nzb24gSFJFRjUyMApyZWZl
cmVuY2UgZGVzaWduLiBXZSBzdXBwb3J0IHZpZGVvIG1vZGUgYnkgZGVmYXVsdCwgYnV0Cml0IGlz
IHBvc3NpYmxlIHRvIHN3aXRjaCB0aGUgcGFuZWwgaW50byBjb21tYW5kIG1vZGUKYnkgdXNpbmcg
dGhlIGJvb2wgcHJvcGVydHkgImRzaS1jb21tYW5kLW1vZGUiLgoKU2lnbmVkLW9mZi1ieTogTGlu
dXMgV2FsbGVpaiA8bGludXMud2FsbGVpakBsaW5hcm8ub3JnPgotLS0KQ2hhbmdlTG9nIHYyLT52
MzoKLSBObyBjaGFuZ2VzIGp1c3QgcmVzZW5kaW5nIHdpdGggdGhlIG5ldyBiaW5kaW5nIHVwZGF0
ZXMuCkNoYW5nZUxvZyB2MS0+djI6Ci0gRml4IHVwIHRoZSBJRCByZWFkIGZ1bmN0aW9uIHRvIHNw
bGl0IGludG8gcmVhZGluZyBoZWFkZXIsCiAgdmVyc2lvbiBhbmQgSUQsIHN0b3JlIHRoZSB2ZXJz
aW9uIGluIHRoZSBzdHJ1Y3QuCi0gR2V0IHJpZCBvZiBhIHN1cnBsdXMgc2VtaWNvbG9uIGZvdW5k
IGJ5IHRoZSBidWlsZCByb2JvdAogIHdoaWxlIHJld3JpdGluZyB0aGUgYWJvdmUgY29kZS4KLSBV
c2UgdW5zaWduZWQgaW50IGluIHByb2JlKCkgbG9vcC4KLSBTZXQgdnJlZnJlc2ggdG8gNjBIeiwg
YXMgZ29vZCBhcyBhbnksIHRoZSBtZWFzdXJlZCB2cmVmcmVzaAogIGluIGNvbnRpbm91cyBjb21t
YW5kIG1vZGUgaXMgfjExNyBIei4KLSBVc2UgYSBkaWZmZXJlbnQgZm9yKCkgaWRpb20gd2hpbGUg
cmV0cnlpbmcgdG8gcmVhZCBJRAogIDUgdGltZXMuCi0gRHJvcCB0aGUgc3luYyBwdWxzZSBzZXR0
aW5nLCB3ZSBhcmUgbm90IHVzaW5nIHRoaXMsIHRoaXMKICBwYW5lbCB1c2VzIGFuIGV2ZW50Lgot
IFVzZSB0aGUgZ2VuZXJpYyAiZW5mb3JjZS12aWRlby1tb2RlIiBmb3IgdmlkZW8gbW9kZQogIGVu
Zm9yY2VtZW50LgotLS0KIGRyaXZlcnMvZ3B1L2RybS9wYW5lbC9LY29uZmlnICAgICAgICAgICAg
ICAgIHwgICA3ICsKIGRyaXZlcnMvZ3B1L2RybS9wYW5lbC9NYWtlZmlsZSAgICAgICAgICAgICAg
IHwgICAxICsKIGRyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1zb255LWFjeDQyNGFrcC5jIHwg
NTQyICsrKysrKysrKysrKysrKysrKysKIGluY2x1ZGUvdmlkZW8vbWlwaV9kaXNwbGF5LmggICAg
ICAgICAgICAgICAgIHwgICAxICsKIDQgZmlsZXMgY2hhbmdlZCwgNTUxIGluc2VydGlvbnMoKykK
IGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vcGFuZWwvcGFuZWwtc29ueS1hY3g0
MjRha3AuYwoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9LY29uZmlnIGIvZHJp
dmVycy9ncHUvZHJtL3BhbmVsL0tjb25maWcKaW5kZXggZjE1MmJjNGVlYjUzLi45NTlkZjViZWE3
ZDIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9LY29uZmlnCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9wYW5lbC9LY29uZmlnCkBAIC0zMTYsNiArMzE2LDEzIEBAIGNvbmZpZyBEUk1f
UEFORUxfU0lUUk9OSVhfU1Q3Nzg5VgogCSAgU2F5IFkgaGVyZSBpZiB5b3Ugd2FudCB0byBlbmFi
bGUgc3VwcG9ydCBmb3IgdGhlIFNpdHJvbml4CiAJICBTVDc3ODlWIGNvbnRyb2xsZXIgZm9yIDI0
MHgzMjAgTENEIHBhbmVscwogCitjb25maWcgRFJNX1BBTkVMX1NPTllfQUNYNDI0QUtQCisJdHJp
c3RhdGUgIlNvbnkgQUNYNDI0QUtQIERTSSBjb21tYW5kIG1vZGUgcGFuZWwiCisJZGVwZW5kcyBv
biBPRgorCWRlcGVuZHMgb24gRFJNX01JUElfRFNJCisJZGVwZW5kcyBvbiBCQUNLTElHSFRfQ0xB
U1NfREVWSUNFCisJc2VsZWN0IFZJREVPTU9ERV9IRUxQRVJTCisKIGNvbmZpZyBEUk1fUEFORUxf
U09OWV9BQ1g1NjVBS00KIAl0cmlzdGF0ZSAiU29ueSBBQ1g1NjVBS00gcGFuZWwiCiAJZGVwZW5k
cyBvbiBHUElPTElCICYmIE9GICYmIFNQSQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Bh
bmVsL01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL3BhbmVsL01ha2VmaWxlCmluZGV4IGI2Y2Qz
OWZlMGYyMC4uMGI1MTc5M2UzYjQzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcGFuZWwv
TWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmVsL01ha2VmaWxlCkBAIC0zMyw2ICsz
Myw3IEBAIG9iai0kKENPTkZJR19EUk1fUEFORUxfU0hBUlBfTFMwMzdWN0RXMDEpICs9IHBhbmVs
LXNoYXJwLWxzMDM3djdkdzAxLm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfU0hBUlBfTFMwNDNU
MUxFMDEpICs9IHBhbmVsLXNoYXJwLWxzMDQzdDFsZTAxLm8KIG9iai0kKENPTkZJR19EUk1fUEFO
RUxfU0lUUk9OSVhfU1Q3NzAxKSArPSBwYW5lbC1zaXRyb25peC1zdDc3MDEubwogb2JqLSQoQ09O
RklHX0RSTV9QQU5FTF9TSVRST05JWF9TVDc3ODlWKSArPSBwYW5lbC1zaXRyb25peC1zdDc3ODl2
Lm8KK29iai0kKENPTkZJR19EUk1fUEFORUxfU09OWV9BQ1g0MjRBS1ApICs9IHBhbmVsLXNvbnkt
YWN4NDI0YWtwLm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfU09OWV9BQ1g1NjVBS00pICs9IHBh
bmVsLXNvbnktYWN4NTY1YWttLm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfVFBPX1REMDI4VFRF
QzEpICs9IHBhbmVsLXRwby10ZDAyOHR0ZWMxLm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfVFBP
X1REMDQzTVRFQTEpICs9IHBhbmVsLXRwby10ZDA0M210ZWExLm8KZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1zb255LWFjeDQyNGFrcC5jIGIvZHJpdmVycy9ncHUvZHJt
L3BhbmVsL3BhbmVsLXNvbnktYWN4NDI0YWtwLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXgg
MDAwMDAwMDAwMDAwLi45NmExNDUwYjY5OWUKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dw
dS9kcm0vcGFuZWwvcGFuZWwtc29ueS1hY3g0MjRha3AuYwpAQCAtMCwwICsxLDU0MiBAQAorLy8g
U1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjArCisvKgorICogTUlQSS1EU0kgU29ueSBB
Q1g0MjRBS1AgcGFuZWwgZHJpdmVyLiBUaGlzIGlzIGEgNDgweDg2NAorICogQU1PTEVEIHBhbmVs
IHdpdGggYSBjb21tYW5kLW9ubHkgRFNJIGludGVyZmFjZS4KKyAqCisgKiBDb3B5cmlnaHQgKEMp
IExpbmFybyBMdGQuIDIwMTkKKyAqIEF1dGhvcjogTGludXMgV2FsbGVpagorICogQmFzZWQgb24g
Y29kZSBhbmQga25vdy1ob3cgZnJvbSBNYXJjdXMgTG9yZW50em9uCisgKiBDb3B5cmlnaHQgKEMp
IFNULUVyaWNzc29uIFNBIDIwMTAKKyAqLworCisjaW5jbHVkZSA8ZHJtL2RybV9tb2Rlcy5oPgor
I2luY2x1ZGUgPGRybS9kcm1fbWlwaV9kc2kuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3BhbmVsLmg+
CisjaW5jbHVkZSA8ZHJtL2RybV9wcmludC5oPgorI2luY2x1ZGUgPHZpZGVvL21pcGlfZGlzcGxh
eS5oPgorCisjaW5jbHVkZSA8bGludXgvZ3Bpby9jb25zdW1lci5oPgorI2luY2x1ZGUgPGxpbnV4
L3JlZ3VsYXRvci9jb25zdW1lci5oPgorI2luY2x1ZGUgPGxpbnV4L2RlbGF5Lmg+CisjaW5jbHVk
ZSA8bGludXgvb2YuaD4KKyNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KKyNpbmNsdWRlIDxsaW51
eC9iYWNrbGlnaHQuaD4KKworI2RlZmluZSBBQ1g0MjRfRENTX1JFQURfSUQxCQkweERBCisjZGVm
aW5lIEFDWDQyNF9EQ1NfUkVBRF9JRDIJCTB4REIKKyNkZWZpbmUgQUNYNDI0X0RDU19SRUFEX0lE
MwkJMHhEQworCisjZGVmaW5lIERJU1BMQVlfU09OWV9BQ1g0MjRBS1BfSUQxCTB4ODExYgorI2Rl
ZmluZSBESVNQTEFZX1NPTllfQUNYNDI0QUtQX0lEMgkweDgxMWEKKyNkZWZpbmUgRElTUExBWV9T
T05ZX0FDWDQyNEFLUF9JRDMJMHg4MDAwCisKK3N0cnVjdCBhY3g0MjRha3AgeworCXN0cnVjdCBk
ZXZpY2UgKmRldjsKKwlzdHJ1Y3QgZHJtX3BhbmVsIHBhbmVsOworCXN0cnVjdCBiYWNrbGlnaHRf
ZGV2aWNlICpibDsKKwlzdHJ1Y3QgcmVndWxhdG9yICpzdXBwbHk7CisJc3RydWN0IGdwaW9fZGVz
YyAqcmVzZXRfZ3BpbzsKKwl1OCB2ZXJzaW9uOworCWJvb2wgdmlkZW9fbW9kZTsKK307CisKK3N0
YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSBzb255X2FjeDQyNGFrcF92aWRfbW9k
ZSA9IHsKKwkuY2xvY2sgPSAzMzAwMDAsCisJLmhkaXNwbGF5ID0gNDgwLAorCS5oc3luY19zdGFy
dCA9IDQ4MCArIDE1LAorCS5oc3luY19lbmQgPSA0ODAgKyAxNSArIDAsCisJLmh0b3RhbCA9IDQ4
MCArIDE1ICsgMCArIDE1LAorCS52ZGlzcGxheSA9IDg2NCwKKwkudnN5bmNfc3RhcnQgPSA4NjQg
KyAxNCwKKwkudnN5bmNfZW5kID0gODY0ICsgMTQgKyAxLAorCS52dG90YWwgPSA4NjQgKyAxNCAr
IDEgKyAxMSwKKwkudnJlZnJlc2ggPSA2MCwKKwkud2lkdGhfbW0gPSA0OCwKKwkuaGVpZ2h0X21t
ID0gODQsCisJLmZsYWdzID0gRFJNX01PREVfRkxBR19QVlNZTkMsCit9OworCisvKgorICogVGhl
IHRpbWluZ3MgYXJlIG5vdCB2ZXJ5IGhlbHBmdWwgYXMgdGhlIGRpc3BsYXkgaXMgdXNlZCBpbgor
ICogY29tbWFuZCBtb2RlIHVzaW5nIHRoZSBtYXhpbXVtIEhTIGZyZXF1ZW5jeS4KKyAqLworc3Rh
dGljIGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlIHNvbnlfYWN4NDI0YWtwX2NtZF9tb2Rl
ID0geworCS5jbG9jayA9IDQyMDE2MCwKKwkuaGRpc3BsYXkgPSA0ODAsCisJLmhzeW5jX3N0YXJ0
ID0gNDgwICsgMTU0LAorCS5oc3luY19lbmQgPSA0ODAgKyAxNTQgKyAxNiwKKwkuaHRvdGFsID0g
NDgwICsgMTU0ICsgMTYgKyAzMiwKKwkudmRpc3BsYXkgPSA4NjQsCisJLnZzeW5jX3N0YXJ0ID0g
ODY0ICsgMSwKKwkudnN5bmNfZW5kID0gODY0ICsgMSArIDEsCisJLnZ0b3RhbCA9IDg2NCArIDEg
KyAxICsgMSwKKwkvKgorCSAqIFNvbWUgZGVzaXJlZCByZWZyZXNoIHJhdGUsIGV4cGVyaW1lbnRz
IGF0IHRoZSBtYXhpbXVtICJwaXhlbCIKKwkgKiBjbG9jayBzcGVlZCAoSFMgY2xvY2sgNDIwIE1I
eikgeWllbGRzIGFyb3VuZCAxMTdIei4KKwkgKi8KKwkudnJlZnJlc2ggPSA2MCwKKwkud2lkdGhf
bW0gPSA0OCwKKwkuaGVpZ2h0X21tID0gODQsCit9OworCitzdGF0aWMgaW5saW5lIHN0cnVjdCBh
Y3g0MjRha3AgKnBhbmVsX3RvX2FjeDQyNGFrcChzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKK3sK
KwlyZXR1cm4gY29udGFpbmVyX29mKHBhbmVsLCBzdHJ1Y3QgYWN4NDI0YWtwLCBwYW5lbCk7Cit9
CisKKyNkZWZpbmUgRk9TQwkJCTIwIC8qIDIwTWh6ICovCisjZGVmaW5lIFNDQUxFX0ZBQ1RPUl9O
U19ESVZfTUhaCTEwMDAKKworc3RhdGljIGludCBhY3g0MjRha3Bfc2V0X2JyaWdodG5lc3Moc3Ry
dWN0IGJhY2tsaWdodF9kZXZpY2UgKmJsKQoreworCXN0cnVjdCBhY3g0MjRha3AgKmFjeCA9IGJs
X2dldF9kYXRhKGJsKTsKKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kgPSB0b19taXBpX2Rz
aV9kZXZpY2UoYWN4LT5kZXYpOworCWludCBwZXJpb2RfbnMgPSAxMDIzOworCWludCBkdXR5X25z
ID0gYmwtPnByb3BzLmJyaWdodG5lc3M7CisJdTggcHdtX3JhdGlvOworCXU4IHB3bV9kaXY7CisJ
dTggcGFyOworCWludCByZXQ7CisKKwkvKiBDYWxjdWxhdGUgdGhlIFBXTSBkdXR5IGN5Y2xlIGlu
IG4vMjU2J3MgKi8KKwlwd21fcmF0aW8gPSBtYXgoKChkdXR5X25zICogMjU2KSAvIHBlcmlvZF9u
cykgLSAxLCAxKTsKKwlwd21fZGl2ID0gbWF4KDEsCisJCSAgICAgICgoRk9TQyAqIHBlcmlvZF9u
cykgLyAyNTYpIC8KKwkJICAgICAgU0NBTEVfRkFDVE9SX05TX0RJVl9NSFopOworCisJLyogU2V0
IHVwIFBXTSBkdXR5Y3ljbGUgT05FIGJ5dGUgKGRpZmZlcnMgZnJvbSB0aGUgc3RhbmRhcmQpICov
CisJRFJNX0RFVl9ERUJVRyhhY3gtPmRldiwgImNhbGN1bGF0ZWQgZHV0eSBjeWNsZSAlMDJ4XG4i
LCBwd21fcmF0aW8pOworCXJldCA9IG1pcGlfZHNpX2Rjc193cml0ZShkc2ksIE1JUElfRENTX1NF
VF9ESVNQTEFZX0JSSUdIVE5FU1MsCisJCQkJICZwd21fcmF0aW8sIDEpOworCWlmIChyZXQgPCAw
KSB7CisJCURSTV9ERVZfRVJST1IoYWN4LT5kZXYsCisJCQkgICAgICAiZmFpbGVkIHRvIHNldCBk
aXNwbGF5IFBXTSByYXRpbyAoJWQpXG4iLAorCQkJICAgICAgcmV0KTsKKwkJcmV0dXJuIHJldDsK
Kwl9CisKKwkvKgorCSAqIFNlcXVlbmNlIHRvIHdyaXRlIFBXTURJVjoKKwkgKglhZGRyZXNzCQlk
YXRhCisJICoJMHhGMwkJMHhBQSAgIENNRDIgVW5sb2NrCisJICoJMHgwMAkJMHgwMSAgIEVudGVy
IENNRDIgcGFnZSAwCisJICoJMFg3RAkJMHgwMSAgIE5vIHJlbG9hZCBNVFAgb2YgQ01EMiBQMQor
CSAqCTB4MjIJCVBXTURJVgorCSAqCTB4N0YJCTB4QUEgICBDTUQyIHBhZ2UgMSBsb2NrCisJICov
CisJcGFyID0gMHhhYTsKKwlyZXQgPSBtaXBpX2RzaV9kY3Nfd3JpdGUoZHNpLCAweGYzLCAmcGFy
LCAxKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGFjeC0+ZGV2LAorCQkJICAg
ICAgImZhaWxlZCB0byB1bmxvY2sgQ01EIDIgKCVkKVxuIiwKKwkJCSAgICAgIHJldCk7CisJCXJl
dHVybiByZXQ7CisJfQorCXBhciA9IDB4MDE7CisJcmV0ID0gbWlwaV9kc2lfZGNzX3dyaXRlKGRz
aSwgMHgwMCwgJnBhciwgMSk7CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihhY3gt
PmRldiwKKwkJCSAgICAgICJmYWlsZWQgdG8gZW50ZXIgcGFnZSAxICglZClcbiIsCisJCQkgICAg
ICByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKwlwYXIgPSAweDAxOworCXJldCA9IG1pcGlfZHNp
X2Rjc193cml0ZShkc2ksIDB4N2QsICZwYXIsIDEpOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9E
RVZfRVJST1IoYWN4LT5kZXYsCisJCQkgICAgICAiZmFpbGVkIHRvIGRpc2FibGUgTVRQIHJlbG9h
ZCAoJWQpXG4iLAorCQkJICAgICAgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisJcmV0ID0gbWlw
aV9kc2lfZGNzX3dyaXRlKGRzaSwgMHgyMiwgJnB3bV9kaXYsIDEpOworCWlmIChyZXQgPCAwKSB7
CisJCURSTV9ERVZfRVJST1IoYWN4LT5kZXYsCisJCQkgICAgICAiZmFpbGVkIHRvIHNldCBQV00g
ZGl2aXNvciAoJWQpXG4iLAorCQkJICAgICAgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisJcGFy
ID0gMHhhYTsKKwlyZXQgPSBtaXBpX2RzaV9kY3Nfd3JpdGUoZHNpLCAweDdmLCAmcGFyLCAxKTsK
KwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGFjeC0+ZGV2LAorCQkJICAgICAgImZh
aWxlZCB0byBsb2NrIENNRCAyICglZClcbiIsCisJCQkgICAgICByZXQpOworCQlyZXR1cm4gcmV0
OworCX0KKworCS8qIEVuYWJsZSBiYWNrbGlnaHQgKi8KKwlwYXIgPSAweDI0OworCXJldCA9IG1p
cGlfZHNpX2Rjc193cml0ZShkc2ksIE1JUElfRENTX1dSSVRFX0NPTlRST0xfRElTUExBWSwKKwkJ
CQkgJnBhciwgMSk7CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihhY3gtPmRldiwK
KwkJCSAgICAgICJmYWlsZWQgdG8gZW5hYmxlIGRpc3BsYXkgYmFja2xpZ2h0ICglZClcbiIsCisJ
CQkgICAgICByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKworCXJldHVybiAwOworfQorCitzdGF0
aWMgY29uc3Qgc3RydWN0IGJhY2tsaWdodF9vcHMgYWN4NDI0YWtwX2JsX29wcyA9IHsKKwkudXBk
YXRlX3N0YXR1cyA9IGFjeDQyNGFrcF9zZXRfYnJpZ2h0bmVzcywKK307CisKK3N0YXRpYyBpbnQg
YWN4NDI0YWtwX3JlYWRfaWQoc3RydWN0IGFjeDQyNGFrcCAqYWN4KQoreworCXN0cnVjdCBtaXBp
X2RzaV9kZXZpY2UgKmRzaSA9IHRvX21pcGlfZHNpX2RldmljZShhY3gtPmRldik7CisJdTggaGVh
ZGVyLCB2ZXJzaW9uLCBpZDsKKwl1MTYgdmFsOworCWludCByZXQ7CisKKwlyZXQgPSBtaXBpX2Rz
aV9kY3NfcmVhZChkc2ksIEFDWDQyNF9EQ1NfUkVBRF9JRDEsICZoZWFkZXIsIDEpOworCWlmIChy
ZXQgPCAwKSB7CisJCURSTV9ERVZfRVJST1IoYWN4LT5kZXYsICJjb3VsZCBub3QgcmVhZCBJRCBo
ZWFkZXIgYnl0ZVxuIik7CisJCXJldHVybiByZXQ7CisJfQorCXJldCA9IG1pcGlfZHNpX2Rjc19y
ZWFkKGRzaSwgQUNYNDI0X0RDU19SRUFEX0lEMiwgJmlkLCAxKTsKKwlpZiAocmV0IDwgMCkgewor
CQlEUk1fREVWX0VSUk9SKGFjeC0+ZGV2LCAiY291bGQgbm90IHJlYWQgZGV2aWNlIElEIGJ5dGVc
biIpOworCQlyZXR1cm4gcmV0OworCX0KKwlyZXQgPSBtaXBpX2RzaV9kY3NfcmVhZChkc2ksIEFD
WDQyNF9EQ1NfUkVBRF9JRDMsICZ2ZXJzaW9uLCAxKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1f
REVWX0VSUk9SKGFjeC0+ZGV2LCAiY291bGQgbm90IHJlYWQgdmVyc2lvbiBieXRlXG4iKTsKKwkJ
cmV0dXJuIHJldDsKKwl9CisKKwlpZiAoaGVhZGVyID09IDB4MDApIHsKKwkJRFJNX0RFVl9FUlJP
UihhY3gtPmRldiwgImRldmljZSBJRCBoZWFkZXIgaXMgemVyb1xuIik7CisJCXJldHVybiAtRU5P
REVWOworCX0KKworCXZhbCA9IChpZCA8PCA4KSB8IHZlcnNpb247CisJc3dpdGNoICh2YWwpIHsK
KwljYXNlIERJU1BMQVlfU09OWV9BQ1g0MjRBS1BfSUQxOgorCWNhc2UgRElTUExBWV9TT05ZX0FD
WDQyNEFLUF9JRDI6CisJY2FzZSBESVNQTEFZX1NPTllfQUNYNDI0QUtQX0lEMzoKKwkJRFJNX0RF
Vl9JTkZPKGFjeC0+ZGV2LCAicGFuZWwgSUQgJTAyeCwgdmVyc2lvbjogJTAyeFxuIiwKKwkJCSAg
ICAgaWQsIHZlcnNpb24pOworCQlicmVhazsKKwlkZWZhdWx0OgorCQlEUk1fREVWX0lORk8oYWN4
LT5kZXYsICJ1bmtub3duIHBhbmVsIElEICUwMngsIHZlcnNpb246ICUwMnhcbiIsCisJCQkgICAg
IGlkLCB2ZXJzaW9uKTsKKwkJYnJlYWs7CisJfQorCWFjeC0+dmVyc2lvbiA9IHZlcnNpb247CisK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBhY3g0MjRha3BfcG93ZXJfb24oc3RydWN0IGFj
eDQyNGFrcCAqYWN4KQoreworCWludCByZXQ7CisKKwlyZXQgPSByZWd1bGF0b3JfZW5hYmxlKGFj
eC0+c3VwcGx5KTsKKwlpZiAocmV0KSB7CisJCURSTV9ERVZfRVJST1IoYWN4LT5kZXYsICJmYWls
ZWQgdG8gZW5hYmxlIHN1cHBseSAoJWQpXG4iLCByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKwor
CS8qIEFzc2VydCBSRVNFVCAqLworCWdwaW9kX3NldF92YWx1ZV9jYW5zbGVlcChhY3gtPnJlc2V0
X2dwaW8sIDEpOworCXVkZWxheSgyMCk7CisJLyogRGUtYXNzZXJ0IFJFU0VUICovCisJZ3Bpb2Rf
c2V0X3ZhbHVlX2NhbnNsZWVwKGFjeC0+cmVzZXRfZ3BpbywgMCk7CisJbXNsZWVwKDExKTsKKwor
CXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGFjeDQyNGFrcF9wcmVwYXJlKHN0cnVjdCBkcm1f
cGFuZWwgKnBhbmVsKQoreworCXN0cnVjdCBhY3g0MjRha3AgKmFjeCA9IHBhbmVsX3RvX2FjeDQy
NGFrcChwYW5lbCk7CisJc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpID0gdG9fbWlwaV9kc2lf
ZGV2aWNlKGFjeC0+ZGV2KTsKKwljb25zdCB1OCBtZGRpID0gMzsKKwlpbnQgcmV0OworCisJcmV0
ID0gYWN4NDI0YWtwX3Bvd2VyX29uKGFjeCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKwor
CS8qIEVuYWJlIHRlYXJpbmcgbW9kZTogc2VuZCBURSAodGVhcmluZyBlZmZlY3QpIGF0IFZCTEFO
SyAqLworCXJldCA9IG1pcGlfZHNpX2Rjc19zZXRfdGVhcl9vbihkc2ksCisJCQkJICAgICAgIE1J
UElfRFNJX0RDU19URUFSX01PREVfVkJMQU5LKTsKKwlpZiAocmV0KSB7CisJCURSTV9ERVZfRVJS
T1IoYWN4LT5kZXYsICJmYWlsZWQgdG8gZW5hYmxlIHZibGFuayBURSAoJWQpXG4iLAorCQkJICAg
ICAgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwkvKiBTZXQgTURESSAqLworCXJldCA9IG1p
cGlfZHNpX2Rjc193cml0ZShkc2ksIE1JUElfRFNJX0RDU19TRVRfTURESSwKKwkJCQkgJm1kZGks
IHNpemVvZihtZGRpKSk7CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihhY3gtPmRl
diwgImZhaWxlZCB0byBzZXQgTURESSAoJWQpXG4iLCByZXQpOworCQlyZXR1cm4gcmV0OworCX0K
KworCWFjeC0+YmwtPnByb3BzLnBvd2VyID0gRkJfQkxBTktfTk9STUFMOworCisJcmV0dXJuIDA7
Cit9CisKK3N0YXRpYyB2b2lkIGFjeDQyNGFrcF9wb3dlcl9vZmYoc3RydWN0IGFjeDQyNGFrcCAq
YWN4KQoreworCS8qIEFzc2VydCBSRVNFVCAqLworCWdwaW9kX3NldF92YWx1ZV9jYW5zbGVlcChh
Y3gtPnJlc2V0X2dwaW8sIDEpOworCW1zbGVlcCgxMSk7CisKKwlyZWd1bGF0b3JfZGlzYWJsZShh
Y3gtPnN1cHBseSk7Cit9CisKK3N0YXRpYyBpbnQgYWN4NDI0YWtwX3VucHJlcGFyZShzdHJ1Y3Qg
ZHJtX3BhbmVsICpwYW5lbCkKK3sKKwlzdHJ1Y3QgYWN4NDI0YWtwICphY3ggPSBwYW5lbF90b19h
Y3g0MjRha3AocGFuZWwpOworCisJYWN4NDI0YWtwX3Bvd2VyX29mZihhY3gpOworCWFjeC0+Ymwt
PnByb3BzLnBvd2VyID0gRkJfQkxBTktfUE9XRVJET1dOOworCisJcmV0dXJuIDA7Cit9CisKK3N0
YXRpYyBpbnQgYWN4NDI0YWtwX2VuYWJsZShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKK3sKKwlz
dHJ1Y3QgYWN4NDI0YWtwICphY3ggPSBwYW5lbF90b19hY3g0MjRha3AocGFuZWwpOworCXN0cnVj
dCBtaXBpX2RzaV9kZXZpY2UgKmRzaSA9IHRvX21pcGlfZHNpX2RldmljZShhY3gtPmRldik7CisJ
aW50IHJldDsKKworCS8qIEV4aXQgc2xlZXAgbW9kZSAqLworCXJldCA9IG1pcGlfZHNpX2Rjc19l
eGl0X3NsZWVwX21vZGUoZHNpKTsKKwlpZiAocmV0KSB7CisJCURSTV9ERVZfRVJST1IoYWN4LT5k
ZXYsICJmYWlsZWQgdG8gZXhpdCBzbGVlcCBtb2RlICglZClcbiIsCisJCQkgICAgICByZXQpOwor
CQlyZXR1cm4gcmV0OworCX0KKwltc2xlZXAoMTQwKTsKKworCXJldCA9IG1pcGlfZHNpX2Rjc19z
ZXRfZGlzcGxheV9vbihkc2kpOworCWlmIChyZXQpIHsKKwkJRFJNX0RFVl9FUlJPUihhY3gtPmRl
diwgImZhaWxlZCB0byB0dXJuIGRpc3BsYXkgb24gKCVkKVxuIiwKKwkJCSAgICAgIHJldCk7CisJ
CXJldHVybiByZXQ7CisJfQorCWlmIChhY3gtPnZpZGVvX21vZGUpIHsKKwkJLyogSW4gdmlkZW8g
bW9kZSB0dXJuIHBlcmlwaGVyYWwgb24gKi8KKwkJcmV0ID0gbWlwaV9kc2lfdHVybl9vbl9wZXJp
cGhlcmFsKGRzaSk7CisJCWlmIChyZXQpIHsKKwkJCWRldl9lcnIoYWN4LT5kZXYsICJmYWlsZWQg
dG8gdHVybiBvbiBwZXJpcGhlcmFsXG4iKTsKKwkJCXJldHVybiByZXQ7CisJCX0KKwl9CisKKwlh
Y3gtPmJsLT5wcm9wcy5wb3dlciA9IEZCX0JMQU5LX1VOQkxBTks7CisKKwlyZXR1cm4gMDsKK30K
Kworc3RhdGljIGludCBhY3g0MjRha3BfZGlzYWJsZShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkK
K3sKKwlzdHJ1Y3QgYWN4NDI0YWtwICphY3ggPSBwYW5lbF90b19hY3g0MjRha3AocGFuZWwpOwor
CXN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSA9IHRvX21pcGlfZHNpX2RldmljZShhY3gtPmRl
dik7CisJdTggcGFyOworCWludCByZXQ7CisKKwkvKiBEaXNhYmxlIGJhY2tsaWdodCAqLworCXBh
ciA9IDB4MDA7CisJcmV0ID0gbWlwaV9kc2lfZGNzX3dyaXRlKGRzaSwgTUlQSV9EQ1NfV1JJVEVf
Q09OVFJPTF9ESVNQTEFZLAorCQkJCSAmcGFyLCAxKTsKKwlpZiAocmV0KSB7CisJCURSTV9ERVZf
RVJST1IoYWN4LT5kZXYsCisJCQkgICAgICAiZmFpbGVkIHRvIGRpc2FibGUgZGlzcGxheSBiYWNr
bGlnaHQgKCVkKVxuIiwKKwkJCSAgICAgIHJldCk7CisJCXJldHVybiByZXQ7CisJfQorCisJcmV0
ID0gbWlwaV9kc2lfZGNzX3NldF9kaXNwbGF5X29mZihkc2kpOworCWlmIChyZXQpIHsKKwkJRFJN
X0RFVl9FUlJPUihhY3gtPmRldiwgImZhaWxlZCB0byB0dXJuIGRpc3BsYXkgb2ZmICglZClcbiIs
CisJCQkgICAgICByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKworCS8qIEVudGVyIHNsZWVwIG1v
ZGUgKi8KKwlyZXQgPSBtaXBpX2RzaV9kY3NfZW50ZXJfc2xlZXBfbW9kZShkc2kpOworCWlmIChy
ZXQpIHsKKwkJRFJNX0RFVl9FUlJPUihhY3gtPmRldiwgImZhaWxlZCB0byBlbnRlciBzbGVlcCBt
b2RlICglZClcbiIsCisJCQkgICAgICByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKwltc2xlZXAo
ODUpOworCisJYWN4LT5ibC0+cHJvcHMucG93ZXIgPSBGQl9CTEFOS19OT1JNQUw7CisKKwlyZXR1
cm4gMDsKK30KKworc3RhdGljIGludCBhY3g0MjRha3BfZ2V0X21vZGVzKHN0cnVjdCBkcm1fcGFu
ZWwgKnBhbmVsKQoreworCXN0cnVjdCBhY3g0MjRha3AgKmFjeCA9IHBhbmVsX3RvX2FjeDQyNGFr
cChwYW5lbCk7CisJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciA9IHBhbmVsLT5jb25u
ZWN0b3I7CisJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGU7CisKKwlpZiAoYWN4LT52aWRl
b19tb2RlKQorCQltb2RlID0gZHJtX21vZGVfZHVwbGljYXRlKHBhbmVsLT5kcm0sCisJCQkJCSAg
JnNvbnlfYWN4NDI0YWtwX3ZpZF9tb2RlKTsKKwllbHNlCisJCW1vZGUgPSBkcm1fbW9kZV9kdXBs
aWNhdGUocGFuZWwtPmRybSwKKwkJCQkJICAmc29ueV9hY3g0MjRha3BfY21kX21vZGUpOworCWlm
ICghbW9kZSkgeworCQlEUk1fRVJST1IoImJhZCBtb2RlIG9yIGZhaWxlZCB0byBhZGQgbW9kZVxu
Iik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKwlkcm1fbW9kZV9zZXRfbmFtZShtb2RlKTsKKwlt
b2RlLT50eXBlID0gRFJNX01PREVfVFlQRV9EUklWRVIgfCBEUk1fTU9ERV9UWVBFX1BSRUZFUlJF
RDsKKworCWNvbm5lY3Rvci0+ZGlzcGxheV9pbmZvLndpZHRoX21tID0gbW9kZS0+d2lkdGhfbW07
CisJY29ubmVjdG9yLT5kaXNwbGF5X2luZm8uaGVpZ2h0X21tID0gbW9kZS0+aGVpZ2h0X21tOwor
CisJZHJtX21vZGVfcHJvYmVkX2FkZChjb25uZWN0b3IsIG1vZGUpOworCisJcmV0dXJuIDE7IC8q
IE51bWJlciBvZiBtb2RlcyAqLworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9wYW5lbF9m
dW5jcyBhY3g0MjRha3BfZHJtX2Z1bmNzID0geworCS5kaXNhYmxlID0gYWN4NDI0YWtwX2Rpc2Fi
bGUsCisJLnVucHJlcGFyZSA9IGFjeDQyNGFrcF91bnByZXBhcmUsCisJLnByZXBhcmUgPSBhY3g0
MjRha3BfcHJlcGFyZSwKKwkuZW5hYmxlID0gYWN4NDI0YWtwX2VuYWJsZSwKKwkuZ2V0X21vZGVz
ID0gYWN4NDI0YWtwX2dldF9tb2RlcywKK307CisKK3N0YXRpYyBpbnQgYWN4NDI0YWtwX3Byb2Jl
KHN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSkKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAm
ZHNpLT5kZXY7CisJc3RydWN0IGFjeDQyNGFrcCAqYWN4OworCWludCByZXQ7CisJdW5zaWduZWQg
aW50IGk7CisKKwlhY3ggPSBkZXZtX2t6YWxsb2MoZGV2LCBzaXplb2Yoc3RydWN0IGFjeDQyNGFr
cCksIEdGUF9LRVJORUwpOworCWlmICghYWN4KQorCQlyZXR1cm4gLUVOT01FTTsKKwlhY3gtPnZp
ZGVvX21vZGUgPSBvZl9wcm9wZXJ0eV9yZWFkX2Jvb2woZGV2LT5vZl9ub2RlLAorCQkJCQkJImVu
Zm9yY2UtdmlkZW8tbW9kZSIpOworCisJbWlwaV9kc2lfc2V0X2RydmRhdGEoZHNpLCBhY3gpOwor
CWFjeC0+ZGV2ID0gZGV2OworCisJZHNpLT5sYW5lcyA9IDI7CisJZHNpLT5mb3JtYXQgPSBNSVBJ
X0RTSV9GTVRfUkdCODg4OworCS8qCisJICogRklYTUU6IHRoZXNlIGNvbWUgZnJvbSB0aGUgU1Qt
RXJpY3Nzb24gdmVuZG9yIGRyaXZlciBmb3IgdGhlCisJICogSFJFRjUyMCBhbmQgc2VlbXMgdG8g
cmVmbGVjdCBsaW1pdGF0aW9ucyBpbiB0aGUgUExMcyBvbiB0aGF0CisJICogcGxhdGZvcm0sIGlm
IHlvdSBoYXZlIHRoZSBkYXRhc2hlZXQsIHBsZWFzZSBjcm9zcy1jaGVjayB0aGUKKwkgKiBhY3R1
YWwgbWF4IHJhdGVzLgorCSAqLworCWRzaS0+bHBfcmF0ZSA9IDE5MjAwMDAwOworCWRzaS0+aHNf
cmF0ZSA9IDQyMDE2MDAwMDsKKworCWlmIChhY3gtPnZpZGVvX21vZGUpCisJCS8qIEJ1cnN0IG1v
ZGUgdXNpbmcgZXZlbnQgZm9yIHN5bmMgKi8KKwkJZHNpLT5tb2RlX2ZsYWdzID0KKwkJCU1JUElf
RFNJX01PREVfVklERU8gfAorCQkJTUlQSV9EU0lfTU9ERV9WSURFT19CVVJTVDsKKwllbHNlCisJ
CWRzaS0+bW9kZV9mbGFncyA9CisJCQlNSVBJX0RTSV9DTE9DS19OT05fQ09OVElOVU9VUyB8CisJ
CQlNSVBJX0RTSV9NT0RFX0VPVF9QQUNLRVQ7CisKKwlhY3gtPnN1cHBseSA9IGRldm1fcmVndWxh
dG9yX2dldChkZXYsICJ2ZGRpIik7CisJaWYgKElTX0VSUihhY3gtPnN1cHBseSkpCisJCXJldHVy
biBQVFJfRVJSKGFjeC0+c3VwcGx5KTsKKworCS8qIFRoaXMgYXNzZXJ0cyBSRVNFVCBieSBkZWZh
dWx0ICovCisJYWN4LT5yZXNldF9ncGlvID0gZGV2bV9ncGlvZF9nZXRfb3B0aW9uYWwoZGV2LCAi
cmVzZXQiLAorCQkJCQkJIEdQSU9EX09VVF9ISUdIKTsKKwlpZiAoSVNfRVJSKGFjeC0+cmVzZXRf
Z3BpbykpIHsKKwkJcmV0ID0gUFRSX0VSUihhY3gtPnJlc2V0X2dwaW8pOworCQlpZiAocmV0ICE9
IC1FUFJPQkVfREVGRVIpCisJCQlEUk1fREVWX0VSUk9SKGRldiwgImZhaWxlZCB0byByZXF1ZXN0
IEdQSU8gKCVkKVxuIiwKKwkJCQkgICAgICByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKworCWRy
bV9wYW5lbF9pbml0KCZhY3gtPnBhbmVsKTsKKwlhY3gtPnBhbmVsLmRldiA9IGRldjsKKwlhY3gt
PnBhbmVsLmZ1bmNzID0gJmFjeDQyNGFrcF9kcm1fZnVuY3M7CisKKwlhY3gtPmJsID0gZGV2bV9i
YWNrbGlnaHRfZGV2aWNlX3JlZ2lzdGVyKGRldiwgImFjeDQyNGFrcCIsIGRldiwgYWN4LAorCQkJ
CQkJICZhY3g0MjRha3BfYmxfb3BzLCBOVUxMKTsKKwlpZiAoSVNfRVJSKGFjeC0+YmwpKSB7CisJ
CURSTV9ERVZfRVJST1IoZGV2LCAiZmFpbGVkIHRvIHJlZ2lzdGVyIGJhY2tsaWdodCBkZXZpY2Vc
biIpOworCQlyZXR1cm4gUFRSX0VSUihhY3gtPmJsKTsKKwl9CisJYWN4LT5ibC0+cHJvcHMubWF4
X2JyaWdodG5lc3MgPSAxMDIzOworCWFjeC0+YmwtPnByb3BzLmJyaWdodG5lc3MgPSA1MTI7CisJ
YWN4LT5ibC0+cHJvcHMucG93ZXIgPSBGQl9CTEFOS19QT1dFUkRPV047CisKKwlyZXQgPSBkcm1f
cGFuZWxfYWRkKCZhY3gtPnBhbmVsKTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0dXJuIHJldDsKKwor
CXJldCA9IGFjeDQyNGFrcF9wb3dlcl9vbihhY3gpOworCWlmIChyZXQpIHsKKwkJRFJNX0RFVl9F
UlJPUihkZXYsICJmYWlsZWQgdG8gcG93ZXIgdXAgZGlzcGxheVxuIik7CisJCWdvdG8gb3V0X3Jl
bW92ZTsKKwl9CisKKwkvKiBUcnkgNSB0aW1lcyB0byByZWFkIHRoZSBkZXZpY2UgSUQgKi8KKwlm
b3IgKGkgPSAwOyBpIDwgNTsgaSsrKSB7CisJCXJldCA9IGFjeDQyNGFrcF9yZWFkX2lkKGFjeCk7
CisJCWlmICghcmV0KQorCQkJYnJlYWs7CisJfQorCisJaWYgKHJldCkgeworCQlEUk1fREVWX0VS
Uk9SKGFjeC0+ZGV2LCAiZmFpbGVkIHRvIHJlYWQgcGFuZWwgSUQgKCVkKVxuIiwgcmV0KTsKKwkJ
Z290byBvdXRfcG93ZXJvZmY7CisJfQorCWFjeDQyNGFrcF9wb3dlcl9vZmYoYWN4KTsKKworCXJl
dCA9IG1pcGlfZHNpX2F0dGFjaChkc2kpOworCWlmIChyZXQgPCAwKQorCQlnb3RvIG91dF9wb3dl
cm9mZjsKKworCXJldHVybiAwOworCitvdXRfcG93ZXJvZmY6CisJYWN4NDI0YWtwX3Bvd2VyX29m
ZihhY3gpOworb3V0X3JlbW92ZToKKwlkcm1fcGFuZWxfcmVtb3ZlKCZhY3gtPnBhbmVsKTsKKwly
ZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IGFjeDQyNGFrcF9yZW1vdmUoc3RydWN0IG1pcGlf
ZHNpX2RldmljZSAqZHNpKQoreworCXN0cnVjdCBhY3g0MjRha3AgKmFjeCA9IG1pcGlfZHNpX2dl
dF9kcnZkYXRhKGRzaSk7CisKKwltaXBpX2RzaV9kZXRhY2goZHNpKTsKKwlkcm1fcGFuZWxfcmVt
b3ZlKCZhY3gtPnBhbmVsKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0
IG9mX2RldmljZV9pZCBhY3g0MjRha3Bfb2ZfbWF0Y2hbXSA9IHsKKwl7IC5jb21wYXRpYmxlID0g
InNvbnksYWN4NDI0YWtwIiB9LAorCXsgfQorfTsKK01PRFVMRV9ERVZJQ0VfVEFCTEUob2YsIGFj
eDQyNGFrcF9vZl9tYXRjaCk7CisKK3N0YXRpYyBzdHJ1Y3QgbWlwaV9kc2lfZHJpdmVyIGFjeDQy
NGFrcF9kcml2ZXIgPSB7CisJLnByb2JlID0gYWN4NDI0YWtwX3Byb2JlLAorCS5yZW1vdmUgPSBh
Y3g0MjRha3BfcmVtb3ZlLAorCS5kcml2ZXIgPSB7CisJCS5uYW1lID0gInBhbmVsLXNvbnktYWN4
NDI0YWtwIiwKKwkJLm9mX21hdGNoX3RhYmxlID0gYWN4NDI0YWtwX29mX21hdGNoLAorCX0sCit9
OworbW9kdWxlX21pcGlfZHNpX2RyaXZlcihhY3g0MjRha3BfZHJpdmVyKTsKKworTU9EVUxFX0FV
VEhPUigiTGludXMgV2FsbGVpIDxsaW51cy53YWxsZWlqQGxpbmFyby5vcmc+Iik7CitNT0RVTEVf
REVTQ1JJUFRJT04oIk1JUEktRFNJIFNvbnkgYWN4NDI0YWtwIFBhbmVsIERyaXZlciIpOworTU9E
VUxFX0xJQ0VOU0UoIkdQTCB2MiIpOwpkaWZmIC0tZ2l0IGEvaW5jbHVkZS92aWRlby9taXBpX2Rp
c3BsYXkuaCBiL2luY2x1ZGUvdmlkZW8vbWlwaV9kaXNwbGF5LmgKaW5kZXggY2JhNTdhNjc4ZGFm
Li5jZjk5YzZhNTE5ZDUgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvdmlkZW8vbWlwaV9kaXNwbGF5LmgK
KysrIGIvaW5jbHVkZS92aWRlby9taXBpX2Rpc3BsYXkuaApAQCAtMTI1LDYgKzEyNSw3IEBAIGVu
dW0gewogCU1JUElfRENTX0dFVF9DQUJDX01JTl9CUklHSFRORVNTID0gMHg1RiwJLyogTUlQSSBE
Q1MgMS4zICovCiAJTUlQSV9EQ1NfUkVBRF9EREJfU1RBUlQJCT0gMHhBMSwKIAlNSVBJX0RDU19S
RUFEX0REQl9DT05USU5VRQk9IDB4QTgsCisJTUlQSV9EU0lfRENTX1NFVF9NRERJCQk9IDB4QUUs
CiB9OwogCiAvKiBNSVBJIERDUyBwaXhlbCBmb3JtYXRzICovCi0tIAoyLjIxLjAKCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5n
IGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVk
ZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
