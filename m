Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id A180398D30
	for <lists+dri-devel@lfdr.de>; Thu, 22 Aug 2019 10:15:14 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4F7D26EA74;
	Thu, 22 Aug 2019 08:14:57 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from inva021.nxp.com (inva021.nxp.com [92.121.34.21])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 527D36E948
 for <dri-devel@lists.freedesktop.org>; Wed, 21 Aug 2019 10:16:26 +0000 (UTC)
Received: from inva021.nxp.com (localhost [127.0.0.1])
 by inva021.eu-rdc02.nxp.com (Postfix) with ESMTP id 139502004F9;
 Wed, 21 Aug 2019 12:16:25 +0200 (CEST)
Received: from inva024.eu-rdc02.nxp.com (inva024.eu-rdc02.nxp.com
 [134.27.226.22])
 by inva021.eu-rdc02.nxp.com (Postfix) with ESMTP id 0662220050A;
 Wed, 21 Aug 2019 12:16:25 +0200 (CEST)
Received: from fsr-ub1664-120.ea.freescale.net
 (fsr-ub1664-120.ea.freescale.net [10.171.82.81])
 by inva024.eu-rdc02.nxp.com (Postfix) with ESMTP id 571E1205D3;
 Wed, 21 Aug 2019 12:16:24 +0200 (CEST)
From: Robert Chiras <robert.chiras@nxp.com>
To: =?UTF-8?q?Guido=20G=C3=BCnther?= <agx@sigxcpu.org>,
 Marek Vasut <marex@denx.de>, Stefan Agner <stefan@agner.ch>,
 David Airlie <airlied@linux.ie>, Daniel Vetter <daniel@ffwll.ch>,
 Rob Herring <robh+dt@kernel.org>, Mark Rutland <mark.rutland@arm.com>,
 Shawn Guo <shawnguo@kernel.org>, Sascha Hauer <s.hauer@pengutronix.de>,
 Fabio Estevam <festevam@gmail.com>
Subject: [PATCH v3 12/15] drm/mxsfb: Improve the axi clock usage
Date: Wed, 21 Aug 2019 13:15:52 +0300
Message-Id: <1566382555-12102-13-git-send-email-robert.chiras@nxp.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1566382555-12102-1-git-send-email-robert.chiras@nxp.com>
References: <1566382555-12102-1-git-send-email-robert.chiras@nxp.com>
X-Virus-Scanned: ClamAV using ClamSMTP
X-Mailman-Approved-At: Thu, 22 Aug 2019 08:14:56 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: devicetree@vger.kernel.org, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, NXP Linux Team <linux-imx@nxp.com>,
 Pengutronix Kernel Team <kernel@pengutronix.de>,
 linux-arm-kernel@lists.infradead.org
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

Q3VycmVudGx5LCB0aGUgZW5hYmxlIG9mIHRoZSBheGkgY2xvY2sgcmV0dXJuIHN0YXR1cyBpcyBp
Z25vcmVkLCBjYXVzaW5nCmlzc3VlcyB3aGVuIHRoZSBlbmFibGUgZmFpbHMgdGhlbiB3ZSB0cnkg
dG8gZGlzYWJsZSBpdC4gVGhlcmVmb3JlLCBpdCBpcwpiZXR0ZXIgdG8gY2hlY2sgdGhlIHJldHVy
biBzdGF0dXMgYW5kIGRpc2FibGUgaXQgb25seSB3aGVuIGVuYWJsZQpzdWNjZWVkZWQuCkFsc28s
IHJlbW92ZSB0aGUgaGVscGVyIGZ1bmN0aW9ucyBhcm91bmQgY2xrX2F4aSwgc2luY2Ugd2UgY2Fu
IGRpcmVjdGx5CnVzZSB0aGUgY2xrIEFQSSBmdW5jdGlvbiBmb3IgZW5hYmxlL2Rpc2FibGUgdGhl
IGNsb2NrLiBUaG9zZSBmdW5jdGlvbnMKYXJlIGFscmVhZHkgY2hlY2tpbmcgZm9yIE5VTEwgY2xr
IGFuZCByZXR1cm5pbmcgMCBpZiB0aGF0J3MgdGhlIGNhc2UuCgpTaWduZWQtb2ZmLWJ5OiBSb2Jl
cnQgQ2hpcmFzIDxyb2JlcnQuY2hpcmFzQG54cC5jb20+CkFja2VkLWJ5OiBMZW9uYXJkIENyZXN0
ZXogPGxlb25hcmQuY3Jlc3RlekBueHAuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9teHNmYi9t
eHNmYl9jcnRjLmMgfCAgOCArKysrLS0tLQogZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX2Ry
di5jICB8IDMyICsrKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9k
cm0vbXhzZmIvbXhzZmJfZHJ2LmggIHwgIDMgLS0tCiAzIGZpbGVzIGNoYW5nZWQsIDE3IGluc2Vy
dGlvbnMoKyksIDI2IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9t
eHNmYi9teHNmYl9jcnRjLmMgYi9kcml2ZXJzL2dwdS9kcm0vbXhzZmIvbXhzZmJfY3J0Yy5jCmlu
ZGV4IGE0YmEzNjguLmU3MjdmNWUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9teHNmYi9t
eHNmYl9jcnRjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX2NydGMuYwpAQCAt
NDA4LDcgKzQwOCw3IEBAIHZvaWQgbXhzZmJfY3J0Y19lbmFibGUoc3RydWN0IG14c2ZiX2RybV9w
cml2YXRlICpteHNmYikKIHsKIAlkbWFfYWRkcl90IHBhZGRyOwogCi0JbXhzZmJfZW5hYmxlX2F4
aV9jbGsobXhzZmIpOworCWNsa19wcmVwYXJlX2VuYWJsZShteHNmYi0+Y2xrX2F4aSk7CiAJd3Jp
dGVsKDAsIG14c2ZiLT5iYXNlICsgTENEQ19DVFJMKTsKIAlteHNmYl9jcnRjX21vZGVfc2V0X25v
ZmIobXhzZmIpOwogCkBAIC00MjUsNyArNDI1LDcgQEAgdm9pZCBteHNmYl9jcnRjX2VuYWJsZShz
dHJ1Y3QgbXhzZmJfZHJtX3ByaXZhdGUgKm14c2ZiKQogdm9pZCBteHNmYl9jcnRjX2Rpc2FibGUo
c3RydWN0IG14c2ZiX2RybV9wcml2YXRlICpteHNmYikKIHsKIAlteHNmYl9kaXNhYmxlX2NvbnRy
b2xsZXIobXhzZmIpOwotCW14c2ZiX2Rpc2FibGVfYXhpX2NsayhteHNmYik7CisJY2xrX2Rpc2Fi
bGVfdW5wcmVwYXJlKG14c2ZiLT5jbGtfYXhpKTsKIH0KIAogdm9pZCBteHNmYl9wbGFuZV9hdG9t
aWNfdXBkYXRlKHN0cnVjdCBteHNmYl9kcm1fcHJpdmF0ZSAqbXhzZmIsCkBAIC00NTEsOCArNDUx
LDggQEAgdm9pZCBteHNmYl9wbGFuZV9hdG9taWNfdXBkYXRlKHN0cnVjdCBteHNmYl9kcm1fcHJp
dmF0ZSAqbXhzZmIsCiAKIAlwYWRkciA9IG14c2ZiX2dldF9mYl9wYWRkcihteHNmYik7CiAJaWYg
KHBhZGRyKSB7Ci0JCW14c2ZiX2VuYWJsZV9heGlfY2xrKG14c2ZiKTsKKwkJY2xrX3ByZXBhcmVf
ZW5hYmxlKG14c2ZiLT5jbGtfYXhpKTsKIAkJd3JpdGVsKHBhZGRyLCBteHNmYi0+YmFzZSArIG14
c2ZiLT5kZXZkYXRhLT5uZXh0X2J1Zik7Ci0JCW14c2ZiX2Rpc2FibGVfYXhpX2NsayhteHNmYik7
CisJCWNsa19kaXNhYmxlX3VucHJlcGFyZShteHNmYi0+Y2xrX2F4aSk7CiAJfQogfQpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX2Rydi5jIGIvZHJpdmVycy9ncHUvZHJt
L214c2ZiL214c2ZiX2Rydi5jCmluZGV4IGRlYjVlMmIuLmRkNTgwOWIgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9teHNmYi9teHNmYl9kcnYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbXhz
ZmIvbXhzZmJfZHJ2LmMKQEAgLTk3LDE4ICs5Nyw2IEBAIGRybV9waXBlX3RvX214c2ZiX2RybV9w
cml2YXRlKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlwZSAqcGlwZSkKIAlyZXR1cm4gY29u
dGFpbmVyX29mKHBpcGUsIHN0cnVjdCBteHNmYl9kcm1fcHJpdmF0ZSwgcGlwZSk7CiB9CiAKLXZv
aWQgbXhzZmJfZW5hYmxlX2F4aV9jbGsoc3RydWN0IG14c2ZiX2RybV9wcml2YXRlICpteHNmYikK
LXsKLQlpZiAobXhzZmItPmNsa19heGkpCi0JCWNsa19wcmVwYXJlX2VuYWJsZShteHNmYi0+Y2xr
X2F4aSk7Ci19Ci0KLXZvaWQgbXhzZmJfZGlzYWJsZV9heGlfY2xrKHN0cnVjdCBteHNmYl9kcm1f
cHJpdmF0ZSAqbXhzZmIpCi17Ci0JaWYgKG14c2ZiLT5jbGtfYXhpKQotCQljbGtfZGlzYWJsZV91
bnByZXBhcmUobXhzZmItPmNsa19heGkpOwotfQotCiAvKioKICAqIG14c2ZiX2F0b21pY19oZWxw
ZXJfY2hlY2sgLSB2YWxpZGF0ZSBzdGF0ZSBvYmplY3QKICAqIEBkZXY6IERSTSBkZXZpY2UKQEAg
LTI3MiwyNSArMjYwLDMxIEBAIHN0YXRpYyB2b2lkIG14c2ZiX3BpcGVfdXBkYXRlKHN0cnVjdCBk
cm1fc2ltcGxlX2Rpc3BsYXlfcGlwZSAqcGlwZSwKIHN0YXRpYyBpbnQgbXhzZmJfcGlwZV9lbmFi
bGVfdmJsYW5rKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlwZSAqcGlwZSkKIHsKIAlzdHJ1
Y3QgbXhzZmJfZHJtX3ByaXZhdGUgKm14c2ZiID0gZHJtX3BpcGVfdG9fbXhzZmJfZHJtX3ByaXZh
dGUocGlwZSk7CisJaW50IHJldCA9IDA7CisKKwlyZXQgPSBjbGtfcHJlcGFyZV9lbmFibGUobXhz
ZmItPmNsa19heGkpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CiAKIAkvKiBDbGVhciBhbmQg
ZW5hYmxlIFZCTEFOSyBJUlEgKi8KLQlteHNmYl9lbmFibGVfYXhpX2NsayhteHNmYik7CiAJd3Jp
dGVsKENUUkwxX0NVUl9GUkFNRV9ET05FX0lSUSwgbXhzZmItPmJhc2UgKyBMQ0RDX0NUUkwxICsg
UkVHX0NMUik7CiAJd3JpdGVsKENUUkwxX0NVUl9GUkFNRV9ET05FX0lSUV9FTiwgbXhzZmItPmJh
c2UgKyBMQ0RDX0NUUkwxICsgUkVHX1NFVCk7Ci0JbXhzZmJfZGlzYWJsZV9heGlfY2xrKG14c2Zi
KTsKKwljbGtfZGlzYWJsZV91bnByZXBhcmUobXhzZmItPmNsa19heGkpOwogCi0JcmV0dXJuIDA7
CisJcmV0dXJuIHJldDsKIH0KIAogc3RhdGljIHZvaWQgbXhzZmJfcGlwZV9kaXNhYmxlX3ZibGFu
ayhzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUpCiB7CiAJc3RydWN0IG14c2Zi
X2RybV9wcml2YXRlICpteHNmYiA9IGRybV9waXBlX3RvX214c2ZiX2RybV9wcml2YXRlKHBpcGUp
OwogCisJaWYgKGNsa19wcmVwYXJlX2VuYWJsZShteHNmYi0+Y2xrX2F4aSkpCisJCXJldHVybjsK
KwogCS8qIERpc2FibGUgYW5kIGNsZWFyIFZCTEFOSyBJUlEgKi8KLQlteHNmYl9lbmFibGVfYXhp
X2NsayhteHNmYik7CiAJd3JpdGVsKENUUkwxX0NVUl9GUkFNRV9ET05FX0lSUV9FTiwgbXhzZmIt
PmJhc2UgKyBMQ0RDX0NUUkwxICsgUkVHX0NMUik7CiAJd3JpdGVsKENUUkwxX0NVUl9GUkFNRV9E
T05FX0lSUSwgbXhzZmItPmJhc2UgKyBMQ0RDX0NUUkwxICsgUkVHX0NMUik7Ci0JbXhzZmJfZGlz
YWJsZV9heGlfY2xrKG14c2ZiKTsKKwljbGtfZGlzYWJsZV91bnByZXBhcmUobXhzZmItPmNsa19h
eGkpOwogfQogCiBzdGF0aWMgc3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlX2Z1bmNzIG14
c2ZiX2Z1bmNzID0gewpAQCAtNDUxLDcgKzQ0NSw3IEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBteHNm
Yl9pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICpkYXRhKQogCXN0cnVjdCBteHNmYl9kcm1fcHJp
dmF0ZSAqbXhzZmIgPSBkcm0tPmRldl9wcml2YXRlOwogCXUzMiByZWc7CiAKLQlteHNmYl9lbmFi
bGVfYXhpX2NsayhteHNmYik7CisJY2xrX3ByZXBhcmVfZW5hYmxlKG14c2ZiLT5jbGtfYXhpKTsK
IAogCXJlZyA9IHJlYWRsKG14c2ZiLT5iYXNlICsgTENEQ19DVFJMMSk7CiAKQEAgLTQ2MCw3ICs0
NTQsNyBAQCBzdGF0aWMgaXJxcmV0dXJuX3QgbXhzZmJfaXJxX2hhbmRsZXIoaW50IGlycSwgdm9p
ZCAqZGF0YSkKIAogCXdyaXRlbChDVFJMMV9DVVJfRlJBTUVfRE9ORV9JUlEsIG14c2ZiLT5iYXNl
ICsgTENEQ19DVFJMMSArIFJFR19DTFIpOwogCi0JbXhzZmJfZGlzYWJsZV9heGlfY2xrKG14c2Zi
KTsKKwljbGtfZGlzYWJsZV91bnByZXBhcmUobXhzZmItPmNsa19heGkpOwogCiAJcmV0dXJuIElS
UV9IQU5ETEVEOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX2Ry
di5oIGIvZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX2Rydi5oCmluZGV4IGExNzgxNzMuLjU0
YzA2NDQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9teHNmYi9teHNmYl9kcnYuaAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vbXhzZmIvbXhzZmJfZHJ2LmgKQEAgLTM5LDkgKzM5LDYgQEAgc3Ry
dWN0IG14c2ZiX2RybV9wcml2YXRlIHsKIGludCBteHNmYl9zZXR1cF9jcnRjKHN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYpOwogaW50IG14c2ZiX2NyZWF0ZV9vdXRwdXQoc3RydWN0IGRybV9kZXZpY2Ug
KmRldik7CiAKLXZvaWQgbXhzZmJfZW5hYmxlX2F4aV9jbGsoc3RydWN0IG14c2ZiX2RybV9wcml2
YXRlICpteHNmYik7Ci12b2lkIG14c2ZiX2Rpc2FibGVfYXhpX2NsayhzdHJ1Y3QgbXhzZmJfZHJt
X3ByaXZhdGUgKm14c2ZiKTsKLQogdm9pZCBteHNmYl9jcnRjX2VuYWJsZShzdHJ1Y3QgbXhzZmJf
ZHJtX3ByaXZhdGUgKm14c2ZiKTsKIHZvaWQgbXhzZmJfY3J0Y19kaXNhYmxlKHN0cnVjdCBteHNm
Yl9kcm1fcHJpdmF0ZSAqbXhzZmIpOwogdm9pZCBteHNmYl9wbGFuZV9hdG9taWNfdXBkYXRlKHN0
cnVjdCBteHNmYl9kcm1fcHJpdmF0ZSAqbXhzZmIsCi0tIAoyLjcuNAoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApk
cmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Au
b3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
