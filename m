Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 30863B65F8
	for <lists+dri-devel@lfdr.de>; Wed, 18 Sep 2019 16:23:36 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1AA4A6F4B4;
	Wed, 18 Sep 2019 14:23:21 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 159AF6F4CB
 for <dri-devel@lists.freedesktop.org>; Wed, 18 Sep 2019 14:23:16 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 24F28B688;
 Wed, 18 Sep 2019 14:23:14 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: airlied@linux.ie, daniel@ffwll.ch, kraxel@redhat.com, sam@ravnborg.org,
 yc_chen@aspeedtech.com, corbet@lwn.net
Subject: [PATCH 09/11] drm/mgag200: Move cursor-image update to
 mgag200_show_cursor()
Date: Wed, 18 Sep 2019 16:23:05 +0200
Message-Id: <20190918142307.27127-10-tzimmermann@suse.de>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190918142307.27127-1-tzimmermann@suse.de>
References: <20190918142307.27127-1-tzimmermann@suse.de>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Zimmermann <tzimmermann@suse.de>, dri-devel@lists.freedesktop.org,
 linux-doc@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBzZXBhcmF0ZXMgdGhlIG1hbmFnZW1lbnQgb2YgYnVmZmVyIG9iamVjdHMgZnJvbSB1cGRh
dGluZyB0aGUKaGFyZHdhcmUgY3Vyc29yIGJ1ZmZlci4gV2hpbGUgZG9pbmcgdGhpcywgd2UgY2Fu
IGZ1cnRoZXIgc3BsaXQgdGhlCmltYWdlLXVwZGF0ZSBjb2RlIGludG8gY29kZSBmb3Igd3JpdGlu
ZyB0aGUgYnVmZmVyLCBzZXR0aW5nIHRoZSBiYXNlCnNjYW4tb3V0IGFkZHJlc3MsIGFuZCBlbmFi
bGluZyB0aGUgY3Vyc29yLiBUaGUgZmlyc3QgdHdvIG9wZXJhdGlvbnMKYXJlIGluIGRlZGljYXRl
ZCBmdW5jdGlvbnMgdXBkYXRlKCkgYW5kIHNldF9iYXNlKCkuIFRoaXMgc2ltcGxpZmllcwp0aGUg
Y29udmVyc2lvbiB0byBhIFZSQU0gYnVmZmVyLgoKU2lnbmVkLW9mZi1ieTogVGhvbWFzIFppbW1l
cm1hbm4gPHR6aW1tZXJtYW5uQHN1c2UuZGU+Ci0tLQogZHJpdmVycy9ncHUvZHJtL21nYWcyMDAv
bWdhZzIwMF9jdXJzb3IuYyB8IDIyMSArKysrKysrKysrKysrLS0tLS0tLS0tLQogMSBmaWxlIGNo
YW5nZWQsIDEyNiBpbnNlcnRpb25zKCspLCA5NSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vbWdhZzIwMC9tZ2FnMjAwX2N1cnNvci5jIGIvZHJpdmVycy9ncHUvZHJt
L21nYWcyMDAvbWdhZzIwMF9jdXJzb3IuYwppbmRleCBhYWJhY2RkM2U0MDEuLmFiM2RmZTZiZGQ5
MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL21nYWcyMDAvbWdhZzIwMF9jdXJzb3IuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vbWdhZzIwMC9tZ2FnMjAwX2N1cnNvci5jCkBAIC0xMiw2ICsx
MiwxMjggQEAKIHN0YXRpYyBib29sIHdhcm5fdHJhbnNwYXJlbnQgPSB0cnVlOwogc3RhdGljIGJv
b2wgd2Fybl9wYWxldHRlID0gdHJ1ZTsKIAorc3RhdGljIGludCBtZ2FnMjAwX2N1cnNvcl91cGRh
dGUoc3RydWN0IG1nYV9kZXZpY2UgKm1kZXYsIHZvaWQgKmRzdCwgdm9pZCAqc3JjLAorCQkJCSB1
bnNpZ25lZCBpbnQgd2lkdGgsIHVuc2lnbmVkIGludCBoZWlnaHQpCit7CisJc3RydWN0IGRybV9k
ZXZpY2UgKmRldiA9IG1kZXYtPmRldjsKKwl1bnNpZ25lZCBpbnQgaSwgcm93LCBjb2w7CisJdWlu
dDMyX3QgY29sb3VyX3NldFsxNl07CisJdWludDMyX3QgKm5leHRfc3BhY2UgPSAmY29sb3VyX3Nl
dFswXTsKKwl1aW50MzJfdCAqcGFsZXR0ZV9pdGVyOworCXVpbnQzMl90IHRoaXNfY29sb3VyOwor
CWJvb2wgZm91bmQgPSBmYWxzZTsKKwlpbnQgY29sb3VyX2NvdW50ID0gMDsKKwl1OCByZWdfaW5k
ZXg7CisJdTggdGhpc19yb3dbNDhdOworCisJbWVtc2V0KCZjb2xvdXJfc2V0WzBdLCAwLCBzaXpl
b2YodWludDMyX3QpKjE2KTsKKwkvKiB3aWR0aCpoZWlnaHQqNCA9IDE2Mzg0ICovCisJZm9yIChp
ID0gMDsgaSA8IDE2Mzg0OyBpICs9IDQpIHsKKwkJdGhpc19jb2xvdXIgPSBpb3JlYWQzMihzcmMg
KyBpKTsKKwkJLyogTm8gdHJhbnNwYXJlbmN5ICovCisJCWlmICh0aGlzX2NvbG91cj4+MjQgIT0g
MHhmZiAmJgorCQkJdGhpc19jb2xvdXI+PjI0ICE9IDB4MCkgeworCQkJaWYgKHdhcm5fdHJhbnNw
YXJlbnQpIHsKKwkJCQlkZXZfaW5mbygmZGV2LT5wZGV2LT5kZXYsICJWaWRlbyBjYXJkIGRvZXNu
J3Qgc3VwcG9ydCBjdXJzb3JzIHdpdGggcGFydGlhbCB0cmFuc3BhcmVuY3kuXG4iKTsKKwkJCQlk
ZXZfaW5mbygmZGV2LT5wZGV2LT5kZXYsICJOb3QgZW5hYmxpbmcgaGFyZHdhcmUgY3Vyc29yLlxu
Iik7CisJCQkJd2Fybl90cmFuc3BhcmVudCA9IGZhbHNlOyAvKiBPbmx5IHRlbGwgdGhlIHVzZXIg
b25jZS4gKi8KKwkJCX0KKwkJCXJldHVybiAtRUlOVkFMOworCQl9CisJCS8qIERvbid0IG5lZWQg
dG8gc3RvcmUgdHJhbnNwYXJlbnQgcGl4ZWxzIGFzIGNvbG91cnMgKi8KKwkJaWYgKHRoaXNfY29s
b3VyPj4yNCA9PSAweDApCisJCQljb250aW51ZTsKKwkJZm91bmQgPSBmYWxzZTsKKwkJZm9yIChw
YWxldHRlX2l0ZXIgPSAmY29sb3VyX3NldFswXTsgcGFsZXR0ZV9pdGVyICE9IG5leHRfc3BhY2U7
IHBhbGV0dGVfaXRlcisrKSB7CisJCQlpZiAoKnBhbGV0dGVfaXRlciA9PSB0aGlzX2NvbG91cikg
eworCQkJCWZvdW5kID0gdHJ1ZTsKKwkJCQlicmVhazsKKwkJCX0KKwkJfQorCQlpZiAoZm91bmQp
CisJCQljb250aW51ZTsKKwkJLyogV2Ugb25seSBzdXBwb3J0IDRiaXQgcGFsZXR0ZWQgY3Vyc29y
cyAqLworCQlpZiAoY29sb3VyX2NvdW50ID49IDE2KSB7CisJCQlpZiAod2Fybl9wYWxldHRlKSB7
CisJCQkJZGV2X2luZm8oJmRldi0+cGRldi0+ZGV2LCAiVmlkZW8gY2FyZCBvbmx5IHN1cHBvcnRz
IGN1cnNvcnMgd2l0aCB1cCB0byAxNiBjb2xvdXJzLlxuIik7CisJCQkJZGV2X2luZm8oJmRldi0+
cGRldi0+ZGV2LCAiTm90IGVuYWJsaW5nIGhhcmR3YXJlIGN1cnNvci5cbiIpOworCQkJCXdhcm5f
cGFsZXR0ZSA9IGZhbHNlOyAvKiBPbmx5IHRlbGwgdGhlIHVzZXIgb25jZS4gKi8KKwkJCX0KKwkJ
CXJldHVybiAtRUlOVkFMOworCQl9CisJCSpuZXh0X3NwYWNlID0gdGhpc19jb2xvdXI7CisJCW5l
eHRfc3BhY2UrKzsKKwkJY29sb3VyX2NvdW50Kys7CisJfQorCisJLyogUHJvZ3JhbSBjb2xvdXJz
IGZyb20gY3Vyc29yIGljb24gaW50byBwYWxldHRlICovCisJZm9yIChpID0gMDsgaSA8IGNvbG91
cl9jb3VudDsgaSsrKSB7CisJCWlmIChpIDw9IDIpCisJCQlyZWdfaW5kZXggPSAweDggKyBpKjB4
NDsKKwkJZWxzZQorCQkJcmVnX2luZGV4ID0gMHg2MCArIGkqMHgzOworCQlXUkVHX0RBQyhyZWdf
aW5kZXgsIGNvbG91cl9zZXRbaV0gJiAweGZmKTsKKwkJV1JFR19EQUMocmVnX2luZGV4KzEsIGNv
bG91cl9zZXRbaV0+PjggJiAweGZmKTsKKwkJV1JFR19EQUMocmVnX2luZGV4KzIsIGNvbG91cl9z
ZXRbaV0+PjE2ICYgMHhmZik7CisJCWlmIChXQVJOX09OKChjb2xvdXJfc2V0W2ldPj4yNCAmIDB4
ZmYpICE9IDB4ZmYpKQorCQkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJLyogbm93IHdyaXRlIGNv
bG91ciBpbmRpY2VzIGludG8gaGFyZHdhcmUgY3Vyc29yIGJ1ZmZlciAqLworCWZvciAocm93ID0g
MDsgcm93IDwgNjQ7IHJvdysrKSB7CisJCW1lbXNldCgmdGhpc19yb3dbMF0sIDAsIDQ4KTsKKwkJ
Zm9yIChjb2wgPSAwOyBjb2wgPCA2NDsgY29sKyspIHsKKwkJCXRoaXNfY29sb3VyID0gaW9yZWFk
MzIoc3JjICsgNCooY29sICsgNjQqcm93KSk7CisJCQkvKiB3cml0ZSB0cmFuc3BhcmVudCBwaXhl
bHMgKi8KKwkJCWlmICh0aGlzX2NvbG91cj4+MjQgPT0gMHgwKSB7CisJCQkJdGhpc19yb3dbNDcg
LSBjb2wvOF0gfD0gMHg4MD4+KGNvbCU4KTsKKwkJCQljb250aW51ZTsKKwkJCX0KKworCQkJLyog
d3JpdGUgY29sb3VyIGluZGV4IGhlcmUgKi8KKwkJCWZvciAoaSA9IDA7IGkgPCBjb2xvdXJfY291
bnQ7IGkrKykgeworCQkJCWlmIChjb2xvdXJfc2V0W2ldID09IHRoaXNfY29sb3VyKSB7CisJCQkJ
CWlmIChjb2wgJSAyKQorCQkJCQkJdGhpc19yb3dbY29sLzJdIHw9IGk8PDQ7CisJCQkJCWVsc2UK
KwkJCQkJCXRoaXNfcm93W2NvbC8yXSB8PSBpOworCQkJCQlicmVhazsKKwkJCQl9CisJCQl9CisJ
CX0KKwkJbWVtY3B5X3RvaW8oZHN0ICsgcm93KjQ4LCAmdGhpc19yb3dbMF0sIDQ4KTsKKwl9CisK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgbWdhZzIwMF9jdXJzb3Jfc2V0X2Jhc2Uoc3Ry
dWN0IG1nYV9kZXZpY2UgKm1kZXYsIHU2NCBhZGRyZXNzKQoreworCXU4IGFkZHJsID0gKGFkZHJl
c3MgPj4gMTApICYgMHhmZjsKKwl1OCBhZGRyaCA9IChhZGRyZXNzID4+IDE4KSAmIDB4M2Y7CisK
KwkvKiBQcm9ncmFtIGdwdSBhZGRyZXNzIG9mIGN1cnNvciBidWZmZXIgKi8KKwlXUkVHX0RBQyhN
R0ExMDY0X0NVUlNPUl9CQVNFX0FEUl9MT1csIGFkZHJsKTsKKwlXUkVHX0RBQyhNR0ExMDY0X0NV
UlNPUl9CQVNFX0FEUl9ISSwgYWRkcmgpOworfQorCitzdGF0aWMgaW50IG1nYWcyMDBfc2hvd19j
dXJzb3Ioc3RydWN0IG1nYV9kZXZpY2UgKm1kZXYsIHZvaWQgKmRzdCwgdm9pZCAqc3JjLAorCQkJ
ICAgICAgIHVuc2lnbmVkIGludCB3aWR0aCwgdW5zaWduZWQgaW50IGhlaWdodCwKKwkJCSAgICAg
ICB1NjQgZHN0X2dwdSkKK3sKKwlpbnQgcmV0OworCisJcmV0ID0gbWdhZzIwMF9jdXJzb3JfdXBk
YXRlKG1kZXYsIGRzdCwgc3JjLCB3aWR0aCwgaGVpZ2h0KTsKKwlpZiAocmV0KQorCQlyZXR1cm4g
cmV0OworCW1nYWcyMDBfY3Vyc29yX3NldF9iYXNlKG1kZXYsIGRzdF9ncHUpOworCisJLyogQWRq
dXN0IGN1cnNvciBjb250cm9sIHJlZ2lzdGVyIHRvIHR1cm4gb24gdGhlIGN1cnNvciAqLworCVdS
RUdfREFDKE1HQTEwNjRfQ1VSU09SX0NUTCwgNCk7IC8qIDE2LWNvbG91ciBwYWxsZXRpemVkIGN1
cnNvciBtb2RlICovCisKKwlyZXR1cm4gMDsKK30KKwogLyogSGlkZSB0aGUgY3Vyc29yIG9mZiBz
Y3JlZW4uIFdlIGNhbid0IGRpc2FibGUgdGhlIGN1cnNvciBoYXJkd2FyZSBiZWNhdXNlIGl0CiAg
KiB0YWtlcyB0b28gbG9uZyB0byByZS1hY3RpdmF0ZSBhbmQgY2F1c2VzIG1vbWVudGFyeSBjb3Jy
dXB0aW9uCiAgKi8KQEAgLTgxLDE5ICsyMDMsMTAgQEAgaW50IG1nYWcyMDBfY3J0Y19jdXJzb3Jf
c2V0KHN0cnVjdCBkcm1fY3J0YyAqY3J0Yywgc3RydWN0IGRybV9maWxlICpmaWxlX3ByaXYsCiAJ
c3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKnBpeGVsc19uZXh0OwogCXN0cnVjdCBkcm1fZ2Vt
X29iamVjdCAqb2JqOwogCXN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8gPSBOVUxMOwot
CWludCByZXQgPSAwOworCWludCByZXQ7CiAJdTggKnNyYywgKmRzdDsKLQl1bnNpZ25lZCBpbnQg
aSwgcm93LCBjb2w7Ci0JdWludDMyX3QgY29sb3VyX3NldFsxNl07Ci0JdWludDMyX3QgKm5leHRf
c3BhY2UgPSAmY29sb3VyX3NldFswXTsKLQl1aW50MzJfdCAqcGFsZXR0ZV9pdGVyOwotCXVpbnQz
Ml90IHRoaXNfY29sb3VyOwotCWJvb2wgZm91bmQgPSBmYWxzZTsKLQlpbnQgY29sb3VyX2NvdW50
ID0gMDsKIAlzNjQgZ3B1X2FkZHI7CiAJdTY0IGRzdF9ncHU7Ci0JdTggcmVnX2luZGV4OwotCXU4
IHRoaXNfcm93WzQ4XTsKIAogCWlmICghcGl4ZWxzXzEgfHwgIXBpeGVsc18yKSB7CiAJCVdSRUc4
KE1HQV9DVVJQT1NYTCwgMCk7CkBAIC0xNTgsOTEgKzI3MSw5IEBAIGludCBtZ2FnMjAwX2NydGNf
Y3Vyc29yX3NldChzdHJ1Y3QgZHJtX2NydGMgKmNydGMsIHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9w
cml2LAogCX0KIAlkc3RfZ3B1ID0gKHU2NClncHVfYWRkcjsKIAotCW1lbXNldCgmY29sb3VyX3Nl
dFswXSwgMCwgc2l6ZW9mKHVpbnQzMl90KSoxNik7Ci0JLyogd2lkdGgqaGVpZ2h0KjQgPSAxNjM4
NCAqLwotCWZvciAoaSA9IDA7IGkgPCAxNjM4NDsgaSArPSA0KSB7Ci0JCXRoaXNfY29sb3VyID0g
aW9yZWFkMzIoc3JjICsgaSk7Ci0JCS8qIE5vIHRyYW5zcGFyZW5jeSAqLwotCQlpZiAodGhpc19j
b2xvdXI+PjI0ICE9IDB4ZmYgJiYKLQkJCXRoaXNfY29sb3VyPj4yNCAhPSAweDApIHsKLQkJCWlm
ICh3YXJuX3RyYW5zcGFyZW50KSB7Ci0JCQkJZGV2X2luZm8oJmRldi0+cGRldi0+ZGV2LCAiVmlk
ZW8gY2FyZCBkb2Vzbid0IHN1cHBvcnQgY3Vyc29ycyB3aXRoIHBhcnRpYWwgdHJhbnNwYXJlbmN5
LlxuIik7Ci0JCQkJZGV2X2luZm8oJmRldi0+cGRldi0+ZGV2LCAiTm90IGVuYWJsaW5nIGhhcmR3
YXJlIGN1cnNvci5cbiIpOwotCQkJCXdhcm5fdHJhbnNwYXJlbnQgPSBmYWxzZTsgLyogT25seSB0
ZWxsIHRoZSB1c2VyIG9uY2UuICovCi0JCQl9Ci0JCQlyZXQgPSAtRUlOVkFMOwotCQkJZ290byBl
cnJfZHJtX2dlbV92cmFtX2t1bm1hcF9kc3Q7Ci0JCX0KLQkJLyogRG9uJ3QgbmVlZCB0byBzdG9y
ZSB0cmFuc3BhcmVudCBwaXhlbHMgYXMgY29sb3VycyAqLwotCQlpZiAodGhpc19jb2xvdXI+PjI0
ID09IDB4MCkKLQkJCWNvbnRpbnVlOwotCQlmb3VuZCA9IGZhbHNlOwotCQlmb3IgKHBhbGV0dGVf
aXRlciA9ICZjb2xvdXJfc2V0WzBdOyBwYWxldHRlX2l0ZXIgIT0gbmV4dF9zcGFjZTsgcGFsZXR0
ZV9pdGVyKyspIHsKLQkJCWlmICgqcGFsZXR0ZV9pdGVyID09IHRoaXNfY29sb3VyKSB7Ci0JCQkJ
Zm91bmQgPSB0cnVlOwotCQkJCWJyZWFrOwotCQkJfQotCQl9Ci0JCWlmIChmb3VuZCkKLQkJCWNv
bnRpbnVlOwotCQkvKiBXZSBvbmx5IHN1cHBvcnQgNGJpdCBwYWxldHRlZCBjdXJzb3JzICovCi0J
CWlmIChjb2xvdXJfY291bnQgPj0gMTYpIHsKLQkJCWlmICh3YXJuX3BhbGV0dGUpIHsKLQkJCQlk
ZXZfaW5mbygmZGV2LT5wZGV2LT5kZXYsICJWaWRlbyBjYXJkIG9ubHkgc3VwcG9ydHMgY3Vyc29y
cyB3aXRoIHVwIHRvIDE2IGNvbG91cnMuXG4iKTsKLQkJCQlkZXZfaW5mbygmZGV2LT5wZGV2LT5k
ZXYsICJOb3QgZW5hYmxpbmcgaGFyZHdhcmUgY3Vyc29yLlxuIik7Ci0JCQkJd2Fybl9wYWxldHRl
ID0gZmFsc2U7IC8qIE9ubHkgdGVsbCB0aGUgdXNlciBvbmNlLiAqLwotCQkJfQotCQkJcmV0ID0g
LUVJTlZBTDsKLQkJCWdvdG8gZXJyX2RybV9nZW1fdnJhbV9rdW5tYXBfZHN0OwotCQl9Ci0JCSpu
ZXh0X3NwYWNlID0gdGhpc19jb2xvdXI7Ci0JCW5leHRfc3BhY2UrKzsKLQkJY29sb3VyX2NvdW50
Kys7Ci0JfQotCi0JLyogUHJvZ3JhbSBjb2xvdXJzIGZyb20gY3Vyc29yIGljb24gaW50byBwYWxl
dHRlICovCi0JZm9yIChpID0gMDsgaSA8IGNvbG91cl9jb3VudDsgaSsrKSB7Ci0JCWlmIChpIDw9
IDIpCi0JCQlyZWdfaW5kZXggPSAweDggKyBpKjB4NDsKLQkJZWxzZQotCQkJcmVnX2luZGV4ID0g
MHg2MCArIGkqMHgzOwotCQlXUkVHX0RBQyhyZWdfaW5kZXgsIGNvbG91cl9zZXRbaV0gJiAweGZm
KTsKLQkJV1JFR19EQUMocmVnX2luZGV4KzEsIGNvbG91cl9zZXRbaV0+PjggJiAweGZmKTsKLQkJ
V1JFR19EQUMocmVnX2luZGV4KzIsIGNvbG91cl9zZXRbaV0+PjE2ICYgMHhmZik7Ci0JCUJVR19P
TigoY29sb3VyX3NldFtpXT4+MjQgJiAweGZmKSAhPSAweGZmKTsKLQl9Ci0KLQkvKiBub3cgd3Jp
dGUgY29sb3VyIGluZGljZXMgaW50byBoYXJkd2FyZSBjdXJzb3IgYnVmZmVyICovCi0JZm9yIChy
b3cgPSAwOyByb3cgPCA2NDsgcm93KyspIHsKLQkJbWVtc2V0KCZ0aGlzX3Jvd1swXSwgMCwgNDgp
OwotCQlmb3IgKGNvbCA9IDA7IGNvbCA8IDY0OyBjb2wrKykgewotCQkJdGhpc19jb2xvdXIgPSBp
b3JlYWQzMihzcmMgKyA0Kihjb2wgKyA2NCpyb3cpKTsKLQkJCS8qIHdyaXRlIHRyYW5zcGFyZW50
IHBpeGVscyAqLwotCQkJaWYgKHRoaXNfY29sb3VyPj4yNCA9PSAweDApIHsKLQkJCQl0aGlzX3Jv
d1s0NyAtIGNvbC84XSB8PSAweDgwPj4oY29sJTgpOwotCQkJCWNvbnRpbnVlOwotCQkJfQotCi0J
CQkvKiB3cml0ZSBjb2xvdXIgaW5kZXggaGVyZSAqLwotCQkJZm9yIChpID0gMDsgaSA8IGNvbG91
cl9jb3VudDsgaSsrKSB7Ci0JCQkJaWYgKGNvbG91cl9zZXRbaV0gPT0gdGhpc19jb2xvdXIpIHsK
LQkJCQkJaWYgKGNvbCAlIDIpCi0JCQkJCQl0aGlzX3Jvd1tjb2wvMl0gfD0gaTw8NDsKLQkJCQkJ
ZWxzZQotCQkJCQkJdGhpc19yb3dbY29sLzJdIHw9IGk7Ci0JCQkJCWJyZWFrOwotCQkJCX0KLQkJ
CX0KLQkJfQotCQltZW1jcHlfdG9pbyhkc3QgKyByb3cqNDgsICZ0aGlzX3Jvd1swXSwgNDgpOwot
CX0KLQotCS8qIFByb2dyYW0gZ3B1IGFkZHJlc3Mgb2YgY3Vyc29yIGJ1ZmZlciAqLwotCVdSRUdf
REFDKE1HQTEwNjRfQ1VSU09SX0JBU0VfQURSX0xPVywgKHU4KSgoZHN0X2dwdT4+MTApICYgMHhm
ZikpOwotCVdSRUdfREFDKE1HQTEwNjRfQ1VSU09SX0JBU0VfQURSX0hJLCAodTgpKChkc3RfZ3B1
Pj4xOCkgJiAweDNmKSk7Ci0KLQkvKiBBZGp1c3QgY3Vyc29yIGNvbnRyb2wgcmVnaXN0ZXIgdG8g
dHVybiBvbiB0aGUgY3Vyc29yICovCi0JV1JFR19EQUMoTUdBMTA2NF9DVVJTT1JfQ1RMLCA0KTsg
LyogMTYtY29sb3VyIHBhbGxldGl6ZWQgY3Vyc29yIG1vZGUgKi8KKwlyZXQgPSBtZ2FnMjAwX3No
b3dfY3Vyc29yKG1kZXYsIGRzdCwgc3JjLCB3aWR0aCwgaGVpZ2h0LCBkc3RfZ3B1KTsKKwlpZiAo
cmV0KQorCQlnb3RvIGVycl9kcm1fZ2VtX3ZyYW1fa3VubWFwX2RzdDsKIAogCS8qIE5vdyB1cGRh
dGUgaW50ZXJuYWwgYnVmZmVyIHBvaW50ZXJzICovCiAJaWYgKHBpeGVsc19jdXJyZW50KQotLSAK
Mi4yMy4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpk
cmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0
cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
