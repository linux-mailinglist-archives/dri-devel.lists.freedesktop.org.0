Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id A045C72897
	for <lists+dri-devel@lfdr.de>; Wed, 24 Jul 2019 08:54:33 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2BF4889FC3;
	Wed, 24 Jul 2019 06:54:26 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-pg1-x542.google.com (mail-pg1-x542.google.com
 [IPv6:2607:f8b0:4864:20::542])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 07B776E419
 for <dri-devel@lists.freedesktop.org>; Wed, 24 Jul 2019 01:26:11 +0000 (UTC)
Received: by mail-pg1-x542.google.com with SMTP id i70so9556233pgd.4
 for <dri-devel@lists.freedesktop.org>; Tue, 23 Jul 2019 18:26:11 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=bhISJM8Puuah8x38nAQ9RovICw9tsVA8mnG10T+jR8A=;
 b=Z0iiyoFm55nwnjvu/2kgbVtPqpMuhhjTnrJFmvXJ30VXy50xwX9eRzySfy/xb55cZm
 HToXwaLLgc08p/bm9QxVa45xbkiE3/r9fA7IF/+SIF/zae39wBz+DVmsPsdZEqNBrI1v
 7tYV2CtBcjJ385Jld1KDiNB6o1s1QoG31Waa3V8LFPHAH4ii/9GI6UKR8JMxbqUTM8JV
 bN4UjmADvf2U5vK4fgac+R1YKfI1+gz995YdMXHk0o/GJNqcJLyCAWCSxBOEAr5x//+f
 Erw2jf17xJHT8/50NtAO6Ffu0IjQ3e510RucOzrLQEjRoMO6MzWqAAyWFe4SCZF8wyYP
 Sszg==
X-Gm-Message-State: APjAAAVsRvnf6fPQkejlAnA22zelc3Je0LRuMzpKag5ZCw44z3a3cvGv
 +MDDew6WRbcU+JNwtbLNBTY=
X-Google-Smtp-Source: APXvYqyCdkt4ibt9fIPkrzzNl+NEdl1RVCVRLumtAtbSj8Bu7fq8bTQqZu6WuCt/OTVocCDq4UlCjg==
X-Received: by 2002:a63:1d2:: with SMTP id 201mr44242875pgb.307.1563931571511; 
 Tue, 23 Jul 2019 18:26:11 -0700 (PDT)
Received: from blueforge.nvidia.com (searspoint.nvidia.com. [216.228.112.21])
 by smtp.gmail.com with ESMTPSA id
 k36sm45950119pgl.42.2019.07.23.18.26.10
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Tue, 23 Jul 2019 18:26:11 -0700 (PDT)
From: john.hubbard@gmail.com
X-Google-Original-From: jhubbard@nvidia.com
To: Andrew Morton <akpm@linux-foundation.org>
Subject: [PATCH v2 1/3] mm/gup: add make_dirty arg to
 put_user_pages_dirty_lock()
Date: Tue, 23 Jul 2019 18:26:04 -0700
Message-Id: <20190724012606.25844-2-jhubbard@nvidia.com>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20190724012606.25844-1-jhubbard@nvidia.com>
References: <20190724012606.25844-1-jhubbard@nvidia.com>
MIME-Version: 1.0
X-NVConfidentiality: public
X-Mailman-Approved-At: Wed, 24 Jul 2019 06:54:25 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=bhISJM8Puuah8x38nAQ9RovICw9tsVA8mnG10T+jR8A=;
 b=Q/bgJr1JpzOWXoz2byTw4Q2bsTLJg5zwbfU1Qxt2NTN2sBWna+7J88KpXhgorvqtwI
 iMpwtqcxs7wX4w42OJVdwYlIJDSymjTz4roIqdstm0FQI/jrrxkg+vZ/mgxRYtcadkXU
 l0KA9TxZBJQ16F+IeHdWQLriA8ZHaFIwVxzyNIsHvgz+eTvMncvM57iXnsIjClp7FD5f
 yqVW6rtGwTRYS5MC4HU3svbbGRttlcThivkgYGSDGxA+whP8bRqJQna3oXzvlDkWZCT7
 j68RFQ0OPCQ8GXAJj/VHcRIxhA3JiyVaDM/SLvQZ4TsClt8txpttAFV29WhVFIq1L96R
 PJfg==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Boaz Harrosh <boaz@plexistor.com>, Jan Kara <jack@suse.cz>,
 David Airlie <airlied@linux.ie>, Dave Chinner <david@fromorbit.com>,
 dri-devel@lists.freedesktop.org, linux-mm@kvack.org,
 Ira Weiny <ira.weiny@intel.com>, Christoph Hellwig <hch@lst.de>,
 Sage Weil <sage@redhat.com>, Miklos Szeredi <miklos@szeredi.hu>,
 linux-rdma@vger.kernel.org, Matthew Wilcox <willy@infradead.org>,
 Jason Gunthorpe <jgg@ziepe.ca>, Johannes Thumshirn <jthumshirn@suse.de>,
 Ilya Dryomov <idryomov@gmail.com>,
 =?UTF-8?q?Bj=C3=B6rn=20T=C3=B6pel?= <bjorn.topel@intel.com>,
 John Hubbard <jhubbard@nvidia.com>,
 Santosh Shilimkar <santosh.shilimkar@oracle.com>,
 Ming Lei <ming.lei@redhat.com>,
 =?UTF-8?q?J=C3=A9r=C3=B4me=20Glisse?= <jglisse@redhat.com>,
 Alexander Viro <viro@zeniv.linux.org.uk>,
 Dan Williams <dan.j.williams@intel.com>,
 Magnus Karlsson <magnus.karlsson@intel.com>, Jens Axboe <axboe@kernel.dk>,
 netdev@vger.kernel.org, LKML <linux-kernel@vger.kernel.org>,
 Yan Zheng <zyan@redhat.com>, bpf@vger.kernel.org,
 "David S . Miller" <davem@davemloft.net>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogSm9obiBIdWJiYXJkIDxqaHViYmFyZEBudmlkaWEuY29tPgoKUHJvdmlkZSBtb3JlIGNh
cGFibGUgdmFyaWF0aW9uIG9mIHB1dF91c2VyX3BhZ2VzX2RpcnR5X2xvY2soKSwKYW5kIGRlbGV0
ZSBwdXRfdXNlcl9wYWdlc19kaXJ0eSgpLiBUaGlzIGlzIGJhc2VkIG9uIHRoZQpmb2xsb3dpbmc6
CgoxLiBMb3RzIG9mIGNhbGwgc2l0ZXMgYmVjb21lIHNpbXBsZXIgaWYgYSBib29sIGlzIHBhc3Nl
ZAppbnRvIHB1dF91c2VyX3BhZ2UqKCksIGluc3RlYWQgb2YgbWFraW5nIHRoZSBjYWxsIHNpdGUK
Y2hvb3NlIHdoaWNoIHB1dF91c2VyX3BhZ2UqKCkgdmFyaWFudCB0byBjYWxsLgoKMi4gQ2hyaXN0
b3BoIEhlbGx3aWcncyBvYnNlcnZhdGlvbiB0aGF0IHNldF9wYWdlX2RpcnR5X2xvY2soKQppcyB1
c3VhbGx5IGNvcnJlY3QsIGFuZCBzZXRfcGFnZV9kaXJ0eSgpIGlzIHVzdWFsbHkgYQpidWcsIG9y
IGF0IGxlYXN0IHF1ZXN0aW9uYWJsZSwgd2l0aGluIGEgcHV0X3VzZXJfcGFnZSooKQpjYWxsaW5n
IGNoYWluLgoKVGhpcyBsZWFkcyB0byB0aGUgZm9sbG93aW5nIEFQSSBjaG9pY2VzOgoKICAgICog
cHV0X3VzZXJfcGFnZXNfZGlydHlfbG9jayhwYWdlLCBucGFnZXMsIG1ha2VfZGlydHkpCgogICAg
KiBUaGVyZSBpcyBubyBwdXRfdXNlcl9wYWdlc19kaXJ0eSgpLiBZb3UgaGF2ZSB0bwogICAgICBo
YW5kIGNvZGUgdGhhdCwgaW4gdGhlIHJhcmUgY2FzZSB0aGF0IGl0J3MKICAgICAgcmVxdWlyZWQu
CgpDYzogTWF0dGhldyBXaWxjb3ggPHdpbGx5QGluZnJhZGVhZC5vcmc+CkNjOiBKYW4gS2FyYSA8
amFja0BzdXNlLmN6PgpDYzogQ2hyaXN0b3BoIEhlbGx3aWcgPGhjaEBsc3QuZGU+CkNjOiBJcmEg
V2VpbnkgPGlyYS53ZWlueUBpbnRlbC5jb20+CkNjOiBKYXNvbiBHdW50aG9ycGUgPGpnZ0B6aWVw
ZS5jYT4KU2lnbmVkLW9mZi1ieTogSm9obiBIdWJiYXJkIDxqaHViYmFyZEBudmlkaWEuY29tPgot
LS0KIGRyaXZlcnMvaW5maW5pYmFuZC9jb3JlL3VtZW0uYyAgICAgICAgICAgICB8ICAgNSArLQog
ZHJpdmVycy9pbmZpbmliYW5kL2h3L2hmaTEvdXNlcl9wYWdlcy5jICAgIHwgICA1ICstCiBkcml2
ZXJzL2luZmluaWJhbmQvaHcvcWliL3FpYl91c2VyX3BhZ2VzLmMgfCAgIDUgKy0KIGRyaXZlcnMv
aW5maW5pYmFuZC9ody91c25pYy91c25pY191aW9tLmMgICB8ICAgNSArLQogZHJpdmVycy9pbmZp
bmliYW5kL3N3L3Npdy9zaXdfbWVtLmMgICAgICAgIHwgICA4ICstCiBpbmNsdWRlL2xpbnV4L21t
LmggICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDUgKy0KIG1tL2d1cC5jICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB8IDExNiArKysrKysrKystLS0tLS0tLS0tLS0KIDcgZmls
ZXMgY2hhbmdlZCwgNTkgaW5zZXJ0aW9ucygrKSwgOTAgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9pbmZpbmliYW5kL2NvcmUvdW1lbS5jIGIvZHJpdmVycy9pbmZpbmliYW5kL2Nv
cmUvdW1lbS5jCmluZGV4IDA4ZGE4NDBlZDdlZS4uOTY1Y2Y5ZGVhNzFhIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2luZmluaWJhbmQvY29yZS91bWVtLmMKKysrIGIvZHJpdmVycy9pbmZpbmliYW5kL2Nv
cmUvdW1lbS5jCkBAIC01NCwxMCArNTQsNyBAQCBzdGF0aWMgdm9pZCBfX2liX3VtZW1fcmVsZWFz
ZShzdHJ1Y3QgaWJfZGV2aWNlICpkZXYsIHN0cnVjdCBpYl91bWVtICp1bWVtLCBpbnQgZAogCiAJ
Zm9yX2VhY2hfc2dfcGFnZSh1bWVtLT5zZ19oZWFkLnNnbCwgJnNnX2l0ZXIsIHVtZW0tPnNnX25l
bnRzLCAwKSB7CiAJCXBhZ2UgPSBzZ19wYWdlX2l0ZXJfcGFnZSgmc2dfaXRlcik7Ci0JCWlmICh1
bWVtLT53cml0YWJsZSAmJiBkaXJ0eSkKLQkJCXB1dF91c2VyX3BhZ2VzX2RpcnR5X2xvY2soJnBh
Z2UsIDEpOwotCQllbHNlCi0JCQlwdXRfdXNlcl9wYWdlKHBhZ2UpOworCQlwdXRfdXNlcl9wYWdl
c19kaXJ0eV9sb2NrKCZwYWdlLCAxLCB1bWVtLT53cml0YWJsZSAmJiBkaXJ0eSk7CiAJfQogCiAJ
c2dfZnJlZV90YWJsZSgmdW1lbS0+c2dfaGVhZCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2luZmlu
aWJhbmQvaHcvaGZpMS91c2VyX3BhZ2VzLmMgYi9kcml2ZXJzL2luZmluaWJhbmQvaHcvaGZpMS91
c2VyX3BhZ2VzLmMKaW5kZXggYjg5YTliOWFlZjdhLi40NjlhY2I5NjFmYmQgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvaW5maW5pYmFuZC9ody9oZmkxL3VzZXJfcGFnZXMuYworKysgYi9kcml2ZXJzL2lu
ZmluaWJhbmQvaHcvaGZpMS91c2VyX3BhZ2VzLmMKQEAgLTExOCwxMCArMTE4LDcgQEAgaW50IGhm
aTFfYWNxdWlyZV91c2VyX3BhZ2VzKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tLCB1bnNpZ25lZCBsb25n
IHZhZGRyLCBzaXplX3QgbnAKIHZvaWQgaGZpMV9yZWxlYXNlX3VzZXJfcGFnZXMoc3RydWN0IG1t
X3N0cnVjdCAqbW0sIHN0cnVjdCBwYWdlICoqcCwKIAkJCSAgICAgc2l6ZV90IG5wYWdlcywgYm9v
bCBkaXJ0eSkKIHsKLQlpZiAoZGlydHkpCi0JCXB1dF91c2VyX3BhZ2VzX2RpcnR5X2xvY2socCwg
bnBhZ2VzKTsKLQllbHNlCi0JCXB1dF91c2VyX3BhZ2VzKHAsIG5wYWdlcyk7CisJcHV0X3VzZXJf
cGFnZXNfZGlydHlfbG9jayhwLCBucGFnZXMsIGRpcnR5KTsKIAogCWlmIChtbSkgeyAvKiBkdXJp
bmcgY2xvc2UgYWZ0ZXIgc2lnbmFsLCBtbSBjYW4gYmUgTlVMTCAqLwogCQlhdG9taWM2NF9zdWIo
bnBhZ2VzLCAmbW0tPnBpbm5lZF92bSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2luZmluaWJhbmQv
aHcvcWliL3FpYl91c2VyX3BhZ2VzLmMgYi9kcml2ZXJzL2luZmluaWJhbmQvaHcvcWliL3FpYl91
c2VyX3BhZ2VzLmMKaW5kZXggYmZiZmJiN2UwZmY0Li42YmY3NjRlNDE4OTEgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvaW5maW5pYmFuZC9ody9xaWIvcWliX3VzZXJfcGFnZXMuYworKysgYi9kcml2ZXJz
L2luZmluaWJhbmQvaHcvcWliL3FpYl91c2VyX3BhZ2VzLmMKQEAgLTQwLDEwICs0MCw3IEBACiBz
dGF0aWMgdm9pZCBfX3FpYl9yZWxlYXNlX3VzZXJfcGFnZXMoc3RydWN0IHBhZ2UgKipwLCBzaXpl
X3QgbnVtX3BhZ2VzLAogCQkJCSAgICAgaW50IGRpcnR5KQogewotCWlmIChkaXJ0eSkKLQkJcHV0
X3VzZXJfcGFnZXNfZGlydHlfbG9jayhwLCBudW1fcGFnZXMpOwotCWVsc2UKLQkJcHV0X3VzZXJf
cGFnZXMocCwgbnVtX3BhZ2VzKTsKKwlwdXRfdXNlcl9wYWdlc19kaXJ0eV9sb2NrKHAsIG51bV9w
YWdlcywgZGlydHkpOwogfQogCiAvKioKZGlmZiAtLWdpdCBhL2RyaXZlcnMvaW5maW5pYmFuZC9o
dy91c25pYy91c25pY191aW9tLmMgYi9kcml2ZXJzL2luZmluaWJhbmQvaHcvdXNuaWMvdXNuaWNf
dWlvbS5jCmluZGV4IDBiMDIzN2Q0MTYxMy4uNjJlNmZmYTlhZDc4IDEwMDY0NAotLS0gYS9kcml2
ZXJzL2luZmluaWJhbmQvaHcvdXNuaWMvdXNuaWNfdWlvbS5jCisrKyBiL2RyaXZlcnMvaW5maW5p
YmFuZC9ody91c25pYy91c25pY191aW9tLmMKQEAgLTc1LDEwICs3NSw3IEBAIHN0YXRpYyB2b2lk
IHVzbmljX3Vpb21fcHV0X3BhZ2VzKHN0cnVjdCBsaXN0X2hlYWQgKmNodW5rX2xpc3QsIGludCBk
aXJ0eSkKIAkJZm9yX2VhY2hfc2coY2h1bmstPnBhZ2VfbGlzdCwgc2csIGNodW5rLT5uZW50cywg
aSkgewogCQkJcGFnZSA9IHNnX3BhZ2Uoc2cpOwogCQkJcGEgPSBzZ19waHlzKHNnKTsKLQkJCWlm
IChkaXJ0eSkKLQkJCQlwdXRfdXNlcl9wYWdlc19kaXJ0eV9sb2NrKCZwYWdlLCAxKTsKLQkJCWVs
c2UKLQkJCQlwdXRfdXNlcl9wYWdlKHBhZ2UpOworCQkJcHV0X3VzZXJfcGFnZXNfZGlydHlfbG9j
aygmcGFnZSwgMSwgZGlydHkpOwogCQkJdXNuaWNfZGJnKCJwYTogJXBhXG4iLCAmcGEpOwogCQl9
CiAJCWtmcmVlKGNodW5rKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvaW5maW5pYmFuZC9zdy9zaXcv
c2l3X21lbS5jIGIvZHJpdmVycy9pbmZpbmliYW5kL3N3L3Npdy9zaXdfbWVtLmMKaW5kZXggNjcx
NzFjODJiMGM0Li4zNThkNDQwZWZhMTEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvaW5maW5pYmFuZC9z
dy9zaXcvc2l3X21lbS5jCisrKyBiL2RyaXZlcnMvaW5maW5pYmFuZC9zdy9zaXcvc2l3X21lbS5j
CkBAIC02NSwxMyArNjUsNyBAQCBzdGF0aWMgdm9pZCBzaXdfZnJlZV9wbGlzdChzdHJ1Y3Qgc2l3
X3BhZ2VfY2h1bmsgKmNodW5rLCBpbnQgbnVtX3BhZ2VzLAogewogCXN0cnVjdCBwYWdlICoqcCA9
IGNodW5rLT5wbGlzdDsKIAotCXdoaWxlIChudW1fcGFnZXMtLSkgewotCQlpZiAoIVBhZ2VEaXJ0
eSgqcCkgJiYgZGlydHkpCi0JCQlwdXRfdXNlcl9wYWdlc19kaXJ0eV9sb2NrKHAsIDEpOwotCQll
bHNlCi0JCQlwdXRfdXNlcl9wYWdlKCpwKTsKLQkJcCsrOwotCX0KKwlwdXRfdXNlcl9wYWdlc19k
aXJ0eV9sb2NrKGNodW5rLT5wbGlzdCwgbnVtX3BhZ2VzLCBkaXJ0eSk7CiB9CiAKIHZvaWQgc2l3
X3VtZW1fcmVsZWFzZShzdHJ1Y3Qgc2l3X3VtZW0gKnVtZW0sIGJvb2wgZGlydHkpCmRpZmYgLS1n
aXQgYS9pbmNsdWRlL2xpbnV4L21tLmggYi9pbmNsdWRlL2xpbnV4L21tLmgKaW5kZXggMDMzNGNh
OTdjNTg0Li45NzU5YjZhMjQ0MjAgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvbGludXgvbW0uaAorKysg
Yi9pbmNsdWRlL2xpbnV4L21tLmgKQEAgLTEwNTcsOCArMTA1Nyw5IEBAIHN0YXRpYyBpbmxpbmUg
dm9pZCBwdXRfdXNlcl9wYWdlKHN0cnVjdCBwYWdlICpwYWdlKQogCXB1dF9wYWdlKHBhZ2UpOwog
fQogCi12b2lkIHB1dF91c2VyX3BhZ2VzX2RpcnR5KHN0cnVjdCBwYWdlICoqcGFnZXMsIHVuc2ln
bmVkIGxvbmcgbnBhZ2VzKTsKLXZvaWQgcHV0X3VzZXJfcGFnZXNfZGlydHlfbG9jayhzdHJ1Y3Qg
cGFnZSAqKnBhZ2VzLCB1bnNpZ25lZCBsb25nIG5wYWdlcyk7Cit2b2lkIHB1dF91c2VyX3BhZ2Vz
X2RpcnR5X2xvY2soc3RydWN0IHBhZ2UgKipwYWdlcywgdW5zaWduZWQgbG9uZyBucGFnZXMsCisJ
CQkgICAgICAgYm9vbCBtYWtlX2RpcnR5KTsKKwogdm9pZCBwdXRfdXNlcl9wYWdlcyhzdHJ1Y3Qg
cGFnZSAqKnBhZ2VzLCB1bnNpZ25lZCBsb25nIG5wYWdlcyk7CiAKICNpZiBkZWZpbmVkKENPTkZJ
R19TUEFSU0VNRU0pICYmICFkZWZpbmVkKENPTkZJR19TUEFSU0VNRU1fVk1FTU1BUCkKZGlmZiAt
LWdpdCBhL21tL2d1cC5jIGIvbW0vZ3VwLmMKaW5kZXggOThmMTNhYjM3YmFjLi5kMTRiZDM2MmVj
MjggMTAwNjQ0Ci0tLSBhL21tL2d1cC5jCisrKyBiL21tL2d1cC5jCkBAIC0yOSw4NSArMjksNzEg
QEAgc3RydWN0IGZvbGxvd19wYWdlX2NvbnRleHQgewogCXVuc2lnbmVkIGludCBwYWdlX21hc2s7
CiB9OwogCi10eXBlZGVmIGludCAoKnNldF9kaXJ0eV9mdW5jX3QpKHN0cnVjdCBwYWdlICpwYWdl
KTsKLQotc3RhdGljIHZvaWQgX19wdXRfdXNlcl9wYWdlc19kaXJ0eShzdHJ1Y3QgcGFnZSAqKnBh
Z2VzLAotCQkJCSAgIHVuc2lnbmVkIGxvbmcgbnBhZ2VzLAotCQkJCSAgIHNldF9kaXJ0eV9mdW5j
X3Qgc2RmKQotewotCXVuc2lnbmVkIGxvbmcgaW5kZXg7Ci0KLQlmb3IgKGluZGV4ID0gMDsgaW5k
ZXggPCBucGFnZXM7IGluZGV4KyspIHsKLQkJc3RydWN0IHBhZ2UgKnBhZ2UgPSBjb21wb3VuZF9o
ZWFkKHBhZ2VzW2luZGV4XSk7Ci0KLQkJLyoKLQkJICogQ2hlY2tpbmcgUGFnZURpcnR5IGF0IHRo
aXMgcG9pbnQgbWF5IHJhY2Ugd2l0aAotCQkgKiBjbGVhcl9wYWdlX2RpcnR5X2Zvcl9pbygpLCBi
dXQgdGhhdCdzIE9LLiBUd28ga2V5IGNhc2VzOgotCQkgKgotCQkgKiAxKSBUaGlzIGNvZGUgc2Vl
cyB0aGUgcGFnZSBhcyBhbHJlYWR5IGRpcnR5LCBzbyBpdCBza2lwcwotCQkgKiB0aGUgY2FsbCB0
byBzZGYoKS4gVGhhdCBjb3VsZCBoYXBwZW4gYmVjYXVzZQotCQkgKiBjbGVhcl9wYWdlX2RpcnR5
X2Zvcl9pbygpIGNhbGxlZCBwYWdlX21rY2xlYW4oKSwKLQkJICogZm9sbG93ZWQgYnkgc2V0X3Bh
Z2VfZGlydHkoKS4gSG93ZXZlciwgbm93IHRoZSBwYWdlIGlzCi0JCSAqIGdvaW5nIHRvIGdldCB3
cml0dGVuIGJhY2ssIHdoaWNoIG1lZXRzIHRoZSBvcmlnaW5hbAotCQkgKiBpbnRlbnRpb24gb2Yg
c2V0dGluZyBpdCBkaXJ0eSwgc28gYWxsIGlzIHdlbGw6Ci0JCSAqIGNsZWFyX3BhZ2VfZGlydHlf
Zm9yX2lvKCkgZ29lcyBvbiB0byBjYWxsCi0JCSAqIFRlc3RDbGVhclBhZ2VEaXJ0eSgpLCBhbmQg
d3JpdGUgdGhlIHBhZ2UgYmFjay4KLQkJICoKLQkJICogMikgVGhpcyBjb2RlIHNlZXMgdGhlIHBh
Z2UgYXMgY2xlYW4sIHNvIGl0IGNhbGxzIHNkZigpLgotCQkgKiBUaGUgcGFnZSBzdGF5cyBkaXJ0
eSwgZGVzcGl0ZSBiZWluZyB3cml0dGVuIGJhY2ssIHNvIGl0Ci0JCSAqIGdldHMgd3JpdHRlbiBi
YWNrIGFnYWluIGluIHRoZSBuZXh0IHdyaXRlYmFjayBjeWNsZS4KLQkJICogVGhpcyBpcyBoYXJt
bGVzcy4KLQkJICovCi0JCWlmICghUGFnZURpcnR5KHBhZ2UpKQotCQkJc2RmKHBhZ2UpOwotCi0J
CXB1dF91c2VyX3BhZ2UocGFnZSk7Ci0JfQotfQotCiAvKioKLSAqIHB1dF91c2VyX3BhZ2VzX2Rp
cnR5KCkgLSByZWxlYXNlIGFuZCBkaXJ0eSBhbiBhcnJheSBvZiBndXAtcGlubmVkIHBhZ2VzCi0g
KiBAcGFnZXM6ICBhcnJheSBvZiBwYWdlcyB0byBiZSBtYXJrZWQgZGlydHkgYW5kIHJlbGVhc2Vk
LgorICogcHV0X3VzZXJfcGFnZXNfZGlydHlfbG9jaygpIC0gcmVsZWFzZSBhbmQgb3B0aW9uYWxs
eSBkaXJ0eSBndXAtcGlubmVkIHBhZ2VzCisgKiBAcGFnZXM6ICBhcnJheSBvZiBwYWdlcyB0byBi
ZSBtYXliZSBtYXJrZWQgZGlydHksIGFuZCBkZWZpbml0ZWx5IHJlbGVhc2VkLgogICogQG5wYWdl
czogbnVtYmVyIG9mIHBhZ2VzIGluIHRoZSBAcGFnZXMgYXJyYXkuCisgKiBAbWFrZV9kaXJ0eTog
d2hldGhlciB0byBtYXJrIHRoZSBwYWdlcyBkaXJ0eQogICoKICAqICJndXAtcGlubmVkIHBhZ2Ui
IHJlZmVycyB0byBhIHBhZ2UgdGhhdCBoYXMgaGFkIG9uZSBvZiB0aGUgZ2V0X3VzZXJfcGFnZXMo
KQogICogdmFyaWFudHMgY2FsbGVkIG9uIHRoYXQgcGFnZS4KICAqCiAgKiBGb3IgZWFjaCBwYWdl
IGluIHRoZSBAcGFnZXMgYXJyYXksIG1ha2UgdGhhdCBwYWdlIChvciBpdHMgaGVhZCBwYWdlLCBp
ZiBhCi0gKiBjb21wb3VuZCBwYWdlKSBkaXJ0eSwgaWYgaXQgd2FzIHByZXZpb3VzbHkgbGlzdGVk
IGFzIGNsZWFuLiBUaGVuLCByZWxlYXNlCi0gKiB0aGUgcGFnZSB1c2luZyBwdXRfdXNlcl9wYWdl
KCkuCisgKiBjb21wb3VuZCBwYWdlKSBkaXJ0eSwgaWYgQG1ha2VfZGlydHkgaXMgdHJ1ZSwgYW5k
IGlmIHRoZSBwYWdlIHdhcyBwcmV2aW91c2x5CisgKiBsaXN0ZWQgYXMgY2xlYW4uIEluIGFueSBj
YXNlLCByZWxlYXNlcyBhbGwgcGFnZXMgdXNpbmcgcHV0X3VzZXJfcGFnZSgpLAorICogcG9zc2li
bHkgdmlhIHB1dF91c2VyX3BhZ2VzKCksIGZvciB0aGUgbm9uLWRpcnR5IGNhc2UuCiAgKgogICog
UGxlYXNlIHNlZSB0aGUgcHV0X3VzZXJfcGFnZSgpIGRvY3VtZW50YXRpb24gZm9yIGRldGFpbHMu
CiAgKgotICogc2V0X3BhZ2VfZGlydHkoKSwgd2hpY2ggZG9lcyBub3QgbG9jayB0aGUgcGFnZSwg
aXMgdXNlZCBoZXJlLgotICogVGhlcmVmb3JlLCBpdCBpcyB0aGUgY2FsbGVyJ3MgcmVzcG9uc2li
aWxpdHkgdG8gZW5zdXJlIHRoYXQgdGhpcyBpcwotICogc2FmZS4gSWYgbm90LCB0aGVuIHB1dF91
c2VyX3BhZ2VzX2RpcnR5X2xvY2soKSBzaG91bGQgYmUgY2FsbGVkIGluc3RlYWQuCisgKiBzZXRf
cGFnZV9kaXJ0eV9sb2NrKCkgaXMgdXNlZCBpbnRlcm5hbGx5LiBJZiBpbnN0ZWFkLCBzZXRfcGFn
ZV9kaXJ0eSgpIGlzCisgKiByZXF1aXJlZCwgdGhlbiB0aGUgY2FsbGVyIHNob3VsZCBhKSB2ZXJp
ZnkgdGhhdCB0aGlzIGlzIHJlYWxseSBjb3JyZWN0LAorICogYmVjYXVzZSBfbG9jaygpIGlzIHVz
dWFsbHkgcmVxdWlyZWQsIGFuZCBiKSBoYW5kIGNvZGUgaXQ6CisgKiBzZXRfcGFnZV9kaXJ0eV9s
b2NrKCksIHB1dF91c2VyX3BhZ2UoKS4KICAqCiAgKi8KLXZvaWQgcHV0X3VzZXJfcGFnZXNfZGly
dHkoc3RydWN0IHBhZ2UgKipwYWdlcywgdW5zaWduZWQgbG9uZyBucGFnZXMpCit2b2lkIHB1dF91
c2VyX3BhZ2VzX2RpcnR5X2xvY2soc3RydWN0IHBhZ2UgKipwYWdlcywgdW5zaWduZWQgbG9uZyBu
cGFnZXMsCisJCQkgICAgICAgYm9vbCBtYWtlX2RpcnR5KQogewotCV9fcHV0X3VzZXJfcGFnZXNf
ZGlydHkocGFnZXMsIG5wYWdlcywgc2V0X3BhZ2VfZGlydHkpOwotfQotRVhQT1JUX1NZTUJPTChw
dXRfdXNlcl9wYWdlc19kaXJ0eSk7CisJdW5zaWduZWQgbG9uZyBpbmRleDsKIAotLyoqCi0gKiBw
dXRfdXNlcl9wYWdlc19kaXJ0eV9sb2NrKCkgLSByZWxlYXNlIGFuZCBkaXJ0eSBhbiBhcnJheSBv
ZiBndXAtcGlubmVkIHBhZ2VzCi0gKiBAcGFnZXM6ICBhcnJheSBvZiBwYWdlcyB0byBiZSBtYXJr
ZWQgZGlydHkgYW5kIHJlbGVhc2VkLgotICogQG5wYWdlczogbnVtYmVyIG9mIHBhZ2VzIGluIHRo
ZSBAcGFnZXMgYXJyYXkuCi0gKgotICogRm9yIGVhY2ggcGFnZSBpbiB0aGUgQHBhZ2VzIGFycmF5
LCBtYWtlIHRoYXQgcGFnZSAob3IgaXRzIGhlYWQgcGFnZSwgaWYgYQotICogY29tcG91bmQgcGFn
ZSkgZGlydHksIGlmIGl0IHdhcyBwcmV2aW91c2x5IGxpc3RlZCBhcyBjbGVhbi4gVGhlbiwgcmVs
ZWFzZQotICogdGhlIHBhZ2UgdXNpbmcgcHV0X3VzZXJfcGFnZSgpLgotICoKLSAqIFBsZWFzZSBz
ZWUgdGhlIHB1dF91c2VyX3BhZ2UoKSBkb2N1bWVudGF0aW9uIGZvciBkZXRhaWxzLgotICoKLSAq
IFRoaXMgaXMganVzdCBsaWtlIHB1dF91c2VyX3BhZ2VzX2RpcnR5KCksIGV4Y2VwdCB0aGF0IGl0
IGludm9rZXMKLSAqIHNldF9wYWdlX2RpcnR5X2xvY2soKSwgaW5zdGVhZCBvZiBzZXRfcGFnZV9k
aXJ0eSgpLgotICoKLSAqLwotdm9pZCBwdXRfdXNlcl9wYWdlc19kaXJ0eV9sb2NrKHN0cnVjdCBw
YWdlICoqcGFnZXMsIHVuc2lnbmVkIGxvbmcgbnBhZ2VzKQotewotCV9fcHV0X3VzZXJfcGFnZXNf
ZGlydHkocGFnZXMsIG5wYWdlcywgc2V0X3BhZ2VfZGlydHlfbG9jayk7CisJLyoKKwkgKiBUT0RP
OiB0aGlzIGNhbiBiZSBvcHRpbWl6ZWQgZm9yIGh1Z2UgcGFnZXM6IGlmIGEgc2VyaWVzIG9mIHBh
Z2VzIGlzCisJICogcGh5c2ljYWxseSBjb250aWd1b3VzIGFuZCBwYXJ0IG9mIHRoZSBzYW1lIGNv
bXBvdW5kIHBhZ2UsIHRoZW4gYQorCSAqIHNpbmdsZSBvcGVyYXRpb24gdG8gdGhlIGhlYWQgcGFn
ZSBzaG91bGQgc3VmZmljZS4KKwkgKi8KKworCWlmICghbWFrZV9kaXJ0eSkgeworCQlwdXRfdXNl
cl9wYWdlcyhwYWdlcywgbnBhZ2VzKTsKKwkJcmV0dXJuOworCX0KKworCWZvciAoaW5kZXggPSAw
OyBpbmRleCA8IG5wYWdlczsgaW5kZXgrKykgeworCQlzdHJ1Y3QgcGFnZSAqcGFnZSA9IGNvbXBv
dW5kX2hlYWQocGFnZXNbaW5kZXhdKTsKKwkJLyoKKwkJICogQ2hlY2tpbmcgUGFnZURpcnR5IGF0
IHRoaXMgcG9pbnQgbWF5IHJhY2Ugd2l0aAorCQkgKiBjbGVhcl9wYWdlX2RpcnR5X2Zvcl9pbygp
LCBidXQgdGhhdCdzIE9LLiBUd28ga2V5CisJCSAqIGNhc2VzOgorCQkgKgorCQkgKiAxKSBUaGlz
IGNvZGUgc2VlcyB0aGUgcGFnZSBhcyBhbHJlYWR5IGRpcnR5LCBzbyBpdAorCQkgKiBza2lwcyB0
aGUgY2FsbCB0byBzZXRfcGFnZV9kaXJ0eSgpLiBUaGF0IGNvdWxkIGhhcHBlbgorCQkgKiBiZWNh
dXNlIGNsZWFyX3BhZ2VfZGlydHlfZm9yX2lvKCkgY2FsbGVkCisJCSAqIHBhZ2VfbWtjbGVhbigp
LCBmb2xsb3dlZCBieSBzZXRfcGFnZV9kaXJ0eSgpLgorCQkgKiBIb3dldmVyLCBub3cgdGhlIHBh
Z2UgaXMgZ29pbmcgdG8gZ2V0IHdyaXR0ZW4gYmFjaywKKwkJICogd2hpY2ggbWVldHMgdGhlIG9y
aWdpbmFsIGludGVudGlvbiBvZiBzZXR0aW5nIGl0CisJCSAqIGRpcnR5LCBzbyBhbGwgaXMgd2Vs
bDogY2xlYXJfcGFnZV9kaXJ0eV9mb3JfaW8oKSBnb2VzCisJCSAqIG9uIHRvIGNhbGwgVGVzdENs
ZWFyUGFnZURpcnR5KCksIGFuZCB3cml0ZSB0aGUgcGFnZQorCQkgKiBiYWNrLgorCQkgKgorCQkg
KiAyKSBUaGlzIGNvZGUgc2VlcyB0aGUgcGFnZSBhcyBjbGVhbiwgc28gaXQgY2FsbHMKKwkJICog
c2V0X3BhZ2VfZGlydHkoKS4gVGhlIHBhZ2Ugc3RheXMgZGlydHksIGRlc3BpdGUgYmVpbmcKKwkJ
ICogd3JpdHRlbiBiYWNrLCBzbyBpdCBnZXRzIHdyaXR0ZW4gYmFjayBhZ2FpbiBpbiB0aGUKKwkJ
ICogbmV4dCB3cml0ZWJhY2sgY3ljbGUuIFRoaXMgaXMgaGFybWxlc3MuCisJCSAqLworCQlpZiAo
IVBhZ2VEaXJ0eShwYWdlKSkKKwkJCXNldF9wYWdlX2RpcnR5X2xvY2socGFnZSk7CisJCWJyZWFr
OworCQlwdXRfdXNlcl9wYWdlKHBhZ2UpOworCX0KIH0KIEVYUE9SVF9TWU1CT0wocHV0X3VzZXJf
cGFnZXNfZGlydHlfbG9jayk7CiAKLS0gCjIuMjIuMAoKX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxA
bGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxt
YW4vbGlzdGluZm8vZHJpLWRldmVs
