Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id EE01E1079D6
	for <lists+dri-devel@lfdr.de>; Fri, 22 Nov 2019 22:09:47 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3F0CC6F591;
	Fri, 22 Nov 2019 21:09:18 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mga07.intel.com (mga07.intel.com [134.134.136.100])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 402D66F57A;
 Fri, 22 Nov 2019 21:09:02 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga007.fm.intel.com ([10.253.24.52])
 by orsmga105.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 22 Nov 2019 13:09:01 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.69,231,1571727600"; d="scan'208";a="205575868"
Received: from nvishwa1-desk.sc.intel.com ([10.3.160.185])
 by fmsmga007.fm.intel.com with ESMTP; 22 Nov 2019 13:09:00 -0800
From: Niranjana Vishwanathapura <niranjana.vishwanathapura@intel.com>
To: intel-gfx@lists.freedesktop.org
Subject: [RFC 10/13] drm/i915/svm: Add functions to blitter copy SVM buffers
Date: Fri, 22 Nov 2019 12:57:31 -0800
Message-Id: <20191122205734.15925-11-niranjana.vishwanathapura@intel.com>
X-Mailer: git-send-email 2.21.0.rc0.32.g243a4c7e27
In-Reply-To: <20191122205734.15925-1-niranjana.vishwanathapura@intel.com>
References: <20191122205734.15925-1-niranjana.vishwanathapura@intel.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: sanjay.k.kumar@intel.com, sudeep.dutt@intel.com,
 dri-devel@lists.freedesktop.org, dave.hansen@intel.com, jglisse@redhat.com,
 jon.bloomfield@intel.com, daniel.vetter@intel.com, dan.j.williams@intel.com,
 ira.weiny@intel.com, jgg@mellanox.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIHN1cHBvcnQgZnVuY3Rpb24gdG8gYmxpdHRlciBjb3B5IFNWTSBWQXMgd2l0aG91dCByZXF1
aXJpbmcgYW55CmdlbSBvYmplY3RzLiBBbHNvIGFkZCBmdW5jdGlvbiB0byB3YWl0IGZvciBjb21w
bGV0aW9uIG9mIHRoZSBjb3B5LgoKQ2M6IEpvb25hcyBMYWh0aW5lbiA8am9vbmFzLmxhaHRpbmVu
QGxpbnV4LmludGVsLmNvbT4KQ2M6IEpvbiBCbG9vbWZpZWxkIDxqb24uYmxvb21maWVsZEBpbnRl
bC5jb20+CkNjOiBEYW5pZWwgVmV0dGVyIDxkYW5pZWwudmV0dGVyQGludGVsLmNvbT4KQ2M6IFN1
ZGVlcCBEdXR0IDxzdWRlZXAuZHV0dEBpbnRlbC5jb20+ClNpZ25lZC1vZmYtYnk6IE5pcmFuamFu
YSBWaXNod2FuYXRoYXB1cmEgPG5pcmFuamFuYS52aXNod2FuYXRoYXB1cmFAaW50ZWwuY29tPgot
LS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlICAgICAgICAgICAgICB8ICAgMyArLQog
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oIHwgICAzICsKIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV93YWl0LmMgICB8ICAgMiArLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9zdm0uaCAgICAgICAgICAgIHwgICA2ICsKIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfc3ZtX2NvcHkuYyAgICAgICB8IDE3MiArKysrKysrKysrKysrKysrKysrKysK
IDUgZmlsZXMgY2hhbmdlZCwgMTg0IGluc2VydGlvbnMoKyksIDIgZGVsZXRpb25zKC0pCiBjcmVh
dGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zdm1fY29weS5jCgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9NYWtlZmlsZQppbmRleCBiNTc0ZWMzMWVhMmUuLjk3ZDQwMTcyYmYyNyAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvTWFrZWZpbGUKQEAgLTE1Niw3ICsxNTYsOCBAQCBpOTE1LXkgKz0gXAogIyBTVk0gY29kZQog
aTkxNS0kKENPTkZJR19EUk1fSTkxNV9TVk0pICs9IGdlbS9pOTE1X2dlbV9zdm0ubyBcCiAJCQkg
ICAgICAgaTkxNV9zdm0ubyBcCi0JCQkgICAgICAgaTkxNV9zdm1fZGV2bWVtLm8KKwkJCSAgICAg
ICBpOTE1X3N2bV9kZXZtZW0ubyBcCisJCQkgICAgICAgaTkxNV9zdm1fY29weS5vCiAKICMgZ2Vu
ZXJhbC1wdXJwb3NlIG1pY3JvY29udHJvbGxlciAoR3VDKSBzdXBwb3J0CiBvYmoteSArPSBndC91
Yy8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3Qu
aCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaAppbmRleCBlZWMz
MWQ5YTRmYTIuLjNmZTY5NzY1OTM2NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX29iamVjdC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV9vYmplY3QuaApAQCAtNDgxLDYgKzQ4MSw5IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBfX3N0
YXJ0X2NwdV93cml0ZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogaW50IGk5MTVf
Z2VtX29iamVjdF93YWl0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJCQkgdW5z
aWduZWQgaW50IGZsYWdzLAogCQkJIGxvbmcgdGltZW91dCk7Citsb25nIGk5MTVfZ2VtX29iamVj
dF93YWl0X2ZlbmNlKHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlLAorCQkJCXVuc2lnbmVkIGludCBm
bGFncywKKwkJCQlsb25nIHRpbWVvdXQpOwogaW50IGk5MTVfZ2VtX29iamVjdF93YWl0X3ByaW9y
aXR5KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJCQkJICB1bnNpZ25lZCBpbnQg
ZmxhZ3MsCiAJCQkJICBjb25zdCBzdHJ1Y3QgaTkxNV9zY2hlZF9hdHRyICphdHRyKTsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV93YWl0LmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fd2FpdC5jCmluZGV4IDhhZjU1Y2QzZTY5MC4uYjc5
MDVhYThmODIxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
d2FpdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV93YWl0LmMKQEAg
LTEyLDcgKzEyLDcgQEAKICNpbmNsdWRlICJpOTE1X2dlbV9pb2N0bHMuaCIKICNpbmNsdWRlICJp
OTE1X2dlbV9vYmplY3QuaCIKIAotc3RhdGljIGxvbmcKK2xvbmcKIGk5MTVfZ2VtX29iamVjdF93
YWl0X2ZlbmNlKHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlLAogCQkJICAgdW5zaWduZWQgaW50IGZs
YWdzLAogCQkJICAgbG9uZyB0aW1lb3V0KQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9zdm0uaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc3ZtLmgKaW5kZXggYTFi
NjI5OTdlOTI1Li41ZDI4ZTUzMWY3MzcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfc3ZtLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zdm0uaApAQCAtMzMs
NiArMzMsMTIgQEAgc3RhdGljIGlubGluZSBib29sIGk5MTVfdm1faXNfc3ZtX2VuYWJsZWQoc3Ry
dWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0pCiAJcmV0dXJuIHZtLT5zdm07CiB9CiAKK2ludCBp
OTE1X3N2bV9jb3B5X2JsdChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJCSAgICAgIHU2NCBz
cmNfc3RhcnQsIHU2NCBkc3Rfc3RhcnQsIHU2NCBzaXplLAorCQkgICAgICBzdHJ1Y3QgZG1hX2Zl
bmNlICoqZmVuY2UpOworaW50IGk5MTVfc3ZtX2NvcHlfYmx0X3dhaXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCisJCQkgICBzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSk7CisKIHZvaWQg
aTkxNV9kbWVtX2NvbnZlcnRfcGZuKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
IAkJCSAgIHN0cnVjdCBobW1fcmFuZ2UgKnJhbmdlKTsKIGludCBpOTE1X3N2bV9taWdyYXRlX2lv
Y3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N2bV9jb3B5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3N2bV9jb3B5LmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi40
MmY3ZDU2M2Y2YjQKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3N2bV9jb3B5LmMKQEAgLTAsMCArMSwxNzIgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVy
OiBNSVQKKy8qCisgKiBDb3B5cmlnaHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3JhdGlvbgorICovCisK
KyNpbmNsdWRlICJpOTE1X2Rydi5oIgorI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9vYmplY3RfYmx0
LmgiCisjaW5jbHVkZSAiZ3QvaW50ZWxfZW5naW5lX3BtLmgiCisjaW5jbHVkZSAiZ3QvaW50ZWxf
ZW5naW5lX3Bvb2wuaCIKKyNpbmNsdWRlICJndC9pbnRlbF9ncHVfY29tbWFuZHMuaCIKKyNpbmNs
dWRlICJndC9pbnRlbF9ndC5oIgorCitzdGF0aWMgc3RydWN0IGk5MTVfdm1hICoKK2ludGVsX2Vt
aXRfc3ZtX2NvcHlfYmx0KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJCXU2NCBzcmNfc3Rh
cnQsIHU2NCBkc3Rfc3RhcnQsIHU2NCBidWZmX3NpemUpCit7CisJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSBjZS0+dm0tPmk5MTU7CisJY29uc3QgdTMyIGJsb2NrX3NpemUgPSBTWl84
TTsgLyogfjFtcyBhdCA4R2lCL3MgcHJlZW1wdGlvbiBkZWxheSAqLworCXN0cnVjdCBpbnRlbF9l
bmdpbmVfcG9vbF9ub2RlICpwb29sOworCXN0cnVjdCBpOTE1X3ZtYSAqYmF0Y2g7CisJdTY0IGNv
dW50LCByZW07CisJdTMyIHNpemUsICpjbWQ7CisJaW50IGVycjsKKworCUdFTV9CVUdfT04oaW50
ZWxfZW5naW5lX2lzX3ZpcnR1YWwoY2UtPmVuZ2luZSkpOworCWludGVsX2VuZ2luZV9wbV9nZXQo
Y2UtPmVuZ2luZSk7CisKKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgOCkKKwkJcmV0dXJuIEVSUl9Q
VFIoLUVOT1RTVVBQKTsKKworCWNvdW50ID0gZGl2X3U2NChyb3VuZF91cChidWZmX3NpemUsIGJs
b2NrX3NpemUpLCBibG9ja19zaXplKTsKKwlzaXplID0gKDEgKyAxMSAqIGNvdW50KSAqIHNpemVv
Zih1MzIpOworCXNpemUgPSByb3VuZF91cChzaXplLCBQQUdFX1NJWkUpOworCXBvb2wgPSBpbnRl
bF9lbmdpbmVfZ2V0X3Bvb2woY2UtPmVuZ2luZSwgc2l6ZSk7CisJaWYgKElTX0VSUihwb29sKSkg
eworCQllcnIgPSBQVFJfRVJSKHBvb2wpOworCQlnb3RvIG91dF9wbTsKKwl9CisKKwljbWQgPSBp
OTE1X2dlbV9vYmplY3RfcGluX21hcChwb29sLT5vYmosIEk5MTVfTUFQX0ZPUkNFX1dDKTsKKwlp
ZiAoSVNfRVJSKGNtZCkpIHsKKwkJZXJyID0gUFRSX0VSUihjbWQpOworCQlnb3RvIG91dF9wdXQ7
CisJfQorCisJcmVtID0gYnVmZl9zaXplOworCWRvIHsKKwkJc2l6ZSA9IG1pbl90KHU2NCwgcmVt
LCBibG9ja19zaXplKTsKKwkJR0VNX0JVR19PTihzaXplID4+IFBBR0VfU0hJRlQgPiBTMTZfTUFY
KTsKKworCQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkpIHsKKwkJCSpjbWQrKyA9IEdFTjlfWFlf
RkFTVF9DT1BZX0JMVF9DTUQgfCAoMTAgLSAyKTsKKwkJCSpjbWQrKyA9IEJMVF9ERVBUSF8zMiB8
IFBBR0VfU0laRTsKKwkJCSpjbWQrKyA9IDA7CisJCQkqY21kKysgPSBzaXplID4+IFBBR0VfU0hJ
RlQgPDwgMTYgfCBQQUdFX1NJWkUgLyA0OworCQkJKmNtZCsrID0gbG93ZXJfMzJfYml0cyhkc3Rf
c3RhcnQpOworCQkJKmNtZCsrID0gdXBwZXJfMzJfYml0cyhkc3Rfc3RhcnQpOworCQkJKmNtZCsr
ID0gMDsKKwkJCSpjbWQrKyA9IFBBR0VfU0laRTsKKwkJCSpjbWQrKyA9IGxvd2VyXzMyX2JpdHMo
c3JjX3N0YXJ0KTsKKwkJCSpjbWQrKyA9IHVwcGVyXzMyX2JpdHMoc3JjX3N0YXJ0KTsKKwkJfSBl
bHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOCkgeworCQkJKmNtZCsrID0gWFlfU1JDX0NPUFlf
QkxUX0NNRCB8CisJCQkJIEJMVF9XUklURV9SR0JBIHwgKDEwIC0gMik7CisJCQkqY21kKysgPSBC
TFRfREVQVEhfMzIgfCBCTFRfUk9QX1NSQ19DT1BZIHwgUEFHRV9TSVpFOworCQkJKmNtZCsrID0g
MDsKKwkJCSpjbWQrKyA9IHNpemUgPj4gUEFHRV9TSElGVCA8PCAxNiB8IFBBR0VfU0laRSAvIDQ7
CisJCQkqY21kKysgPSBsb3dlcl8zMl9iaXRzKGRzdF9zdGFydCk7CisJCQkqY21kKysgPSB1cHBl
cl8zMl9iaXRzKGRzdF9zdGFydCk7CisJCQkqY21kKysgPSAwOworCQkJKmNtZCsrID0gUEFHRV9T
SVpFOworCQkJKmNtZCsrID0gbG93ZXJfMzJfYml0cyhzcmNfc3RhcnQpOworCQkJKmNtZCsrID0g
dXBwZXJfMzJfYml0cyhzcmNfc3RhcnQpOworCQl9CisKKwkJLyogQWxsb3cgb3Vyc2VsdmVzIHRv
IGJlIHByZWVtcHRlZCBpbiBiZXR3ZWVuIGJsb2NrcyAqLworCQkqY21kKysgPSBNSV9BUkJfQ0hF
Q0s7CisKKwkJc3JjX3N0YXJ0ICs9IHNpemU7CisJCWRzdF9zdGFydCArPSBzaXplOworCQlyZW0g
LT0gc2l6ZTsKKwl9IHdoaWxlIChyZW0pOworCisJKmNtZCA9IE1JX0JBVENIX0JVRkZFUl9FTkQ7
CisJaW50ZWxfZ3RfY2hpcHNldF9mbHVzaChjZS0+dm0tPmd0KTsKKworCWk5MTVfZ2VtX29iamVj
dF91bnBpbl9tYXAocG9vbC0+b2JqKTsKKworCWJhdGNoID0gaTkxNV92bWFfaW5zdGFuY2UocG9v
bC0+b2JqLCBjZS0+dm0sIE5VTEwpOworCWlmIChJU19FUlIoYmF0Y2gpKSB7CisJCWVyciA9IFBU
Ul9FUlIoYmF0Y2gpOworCQlnb3RvIG91dF9wdXQ7CisJfQorCisJZXJyID0gaTkxNV92bWFfcGlu
KGJhdGNoLCAwLCAwLCBQSU5fVVNFUik7CisJaWYgKHVubGlrZWx5KGVycikpCisJCWdvdG8gb3V0
X3B1dDsKKworCWJhdGNoLT5wcml2YXRlID0gcG9vbDsKKwlyZXR1cm4gYmF0Y2g7CisKK291dF9w
dXQ6CisJaW50ZWxfZW5naW5lX3Bvb2xfcHV0KHBvb2wpOworb3V0X3BtOgorCWludGVsX2VuZ2lu
ZV9wbV9wdXQoY2UtPmVuZ2luZSk7CisJcmV0dXJuIEVSUl9QVFIoZXJyKTsKK30KKworaW50IGk5
MTVfc3ZtX2NvcHlfYmx0KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJICAgICAgdTY0IHNy
Y19zdGFydCwgdTY0IGRzdF9zdGFydCwgdTY0IHNpemUsCisJCSAgICAgIHN0cnVjdCBkbWFfZmVu
Y2UgKipmZW5jZSkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGNlLT5nZW1f
Y29udGV4dC0+aTkxNTsKKwlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKKwlzdHJ1Y3QgaTkxNV92
bWEgKmJhdGNoOworCWludCBlcnI7CisKKwlEUk1fREVCVUdfRFJJVkVSKCJzcmNfc3RhcnQgMHgl
bGx4IGRzdF9zdGFydCAweCVsbHggc2l6ZSAweCVsbHhcbiIsCisJCQkgc3JjX3N0YXJ0LCBkc3Rf
c3RhcnQsIHNpemUpOworCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCWJh
dGNoID0gaW50ZWxfZW1pdF9zdm1fY29weV9ibHQoY2UsIHNyY19zdGFydCwgZHN0X3N0YXJ0LCBz
aXplKTsKKwlpZiAoSVNfRVJSKGJhdGNoKSkgeworCQllcnIgPSBQVFJfRVJSKGJhdGNoKTsKKwkJ
Z290byBvdXRfdW5sb2NrOworCX0KKworCXJxID0gaTkxNV9yZXF1ZXN0X2NyZWF0ZShjZSk7CisJ
aWYgKElTX0VSUihycSkpIHsKKwkJZXJyID0gUFRSX0VSUihycSk7CisJCWdvdG8gb3V0X2JhdGNo
OworCX0KKworCWVyciA9IGludGVsX2VtaXRfdm1hX21hcmtfYWN0aXZlKGJhdGNoLCBycSk7CisJ
aWYgKHVubGlrZWx5KGVycikpCisJCWdvdG8gb3V0X3JlcXVlc3Q7CisKKwlpZiAoY2UtPmVuZ2lu
ZS0+ZW1pdF9pbml0X2JyZWFkY3J1bWIpIHsKKwkJZXJyID0gY2UtPmVuZ2luZS0+ZW1pdF9pbml0
X2JyZWFkY3J1bWIocnEpOworCQlpZiAodW5saWtlbHkoZXJyKSkKKwkJCWdvdG8gb3V0X3JlcXVl
c3Q7CisJfQorCisJZXJyID0gcnEtPmVuZ2luZS0+ZW1pdF9iYl9zdGFydChycSwKKwkJCQkJYmF0
Y2gtPm5vZGUuc3RhcnQsIGJhdGNoLT5ub2RlLnNpemUsCisJCQkJCTApOworb3V0X3JlcXVlc3Q6
CisJaWYgKHVubGlrZWx5KGVycikpCisJCWk5MTVfcmVxdWVzdF9za2lwKHJxLCBlcnIpOworCWVs
c2UKKwkJKmZlbmNlID0gJnJxLT5mZW5jZTsKKworCWk5MTVfcmVxdWVzdF9hZGQocnEpOworb3V0
X2JhdGNoOgorCWludGVsX2VtaXRfdm1hX3JlbGVhc2UoY2UsIGJhdGNoKTsKK291dF91bmxvY2s6
CisJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKKwlyZXR1cm4gZXJyOwor
fQorCitpbnQgaTkxNV9zdm1fY29weV9ibHRfd2FpdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKKwkJCSAgIHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlKQoreworCWxvbmcgdGltZW91dDsK
KworCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCXRpbWVvdXQgPSBpOTE1
X2dlbV9vYmplY3Rfd2FpdF9mZW5jZShmZW5jZSwKKwkJCQkJICAgICBJOTE1X1dBSVRfSU5URVJS
VVBUSUJMRSB8CisJCQkJCSAgICAgSTkxNV9XQUlUX0FMTCwKKwkJCQkJICAgICBNQVhfU0NIRURV
TEVfVElNRU9VVCk7CisJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKKwly
ZXR1cm4gKHRpbWVvdXQgPCAwKSA/IHRpbWVvdXQgOiAwOworfQotLSAKMi4yMS4wLnJjMC4zMi5n
MjQzYTRjN2UyNwoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
Cmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
