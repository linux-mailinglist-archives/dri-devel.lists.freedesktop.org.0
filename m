Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 640272FEC20
	for <lists+dri-devel@lfdr.de>; Thu, 21 Jan 2021 14:37:26 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0D1A96E530;
	Thu, 21 Jan 2021 13:37:22 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-lj1-x22c.google.com (mail-lj1-x22c.google.com
 [IPv6:2a00:1450:4864:20::22c])
 by gabe.freedesktop.org (Postfix) with ESMTPS id AC4816E530
 for <dri-devel@lists.freedesktop.org>; Thu, 21 Jan 2021 13:37:20 +0000 (UTC)
Received: by mail-lj1-x22c.google.com with SMTP id e7so2469700ljg.10
 for <dri-devel@lists.freedesktop.org>; Thu, 21 Jan 2021 05:37:20 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=linaro.org; s=google;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc:content-transfer-encoding;
 bh=LEqV0YucJGoO/qBUnA782Gstn0eiwdK9KK0CxAlgdFQ=;
 b=mIzR3TwpRPZooXGXgWEuR9yR78ZPR30DNBbIDReYCADSMlmmjuZuogNLufjqNeEFmH
 io35mw8ym0R9pRMxY2MW9keSCMXyrglcOAQ+O2nsUTxojaiGc2Q6xkYMkwXTKQk2lz5j
 xG3n7HIaExSXumKW64SYDrRhrHtoAwsrebmVIEZIFQYqMTnTeXQNVb1rMrOXaJR1JmUd
 QvS4P3o1zYpF8zCOGpF6hL7VTo5KthcTjQs+h+VQxWTV+V4RXv/d3NwnD52MxnHA2d59
 0Wkp5u5d+DxsSy61ytCIITtSf1XyiQzoYZOmSKcG0rbwuV+G5ty9mqkAC2UpW5GHgR8T
 SBqQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc:content-transfer-encoding;
 bh=LEqV0YucJGoO/qBUnA782Gstn0eiwdK9KK0CxAlgdFQ=;
 b=WQu0N3swbU5vaWaSD8e6D/1NzMFDr3bUsub1yUnF5Ld+eS4w+xqWpeEla2gAkKVaLH
 HGHAqPyLxHrSlCJNhsZwDy2ew6XTT1W8Qq3yaf9rW2GfxPqlPoY7JjU9E71ATFGbIenJ
 jgK8+0Varv+7FtzryLvWxFzfAoNB8mRfjrUvMYlQWbyONSr6VmHajshRNyl5jHhxWdVC
 +TF+IiyTgSkUDWTl5VXAvh8Y32SVslmaAVYS50QLod9Akus5/9igWj2lkPcU1vO/KYfz
 yl1TkEnQZoBS13nA7iVoN6Y9mLYOLnAGMUmBC/Jgq3WSzgzkpbY67aHgD2Fe8wrvIEMl
 xFyA==
X-Gm-Message-State: AOAM5316ezi6I5e7HDo6nK3u8Mty1wLMUFUcCti2j0am2lbB/5lCCekM
 Z/Z6AQtXkOf3BJpnIoMmi44zA9cKf82SLkAVEGvKmQ==
X-Google-Smtp-Source: ABdhPJxKZVbqnH9MKFQr85KsvcDFd9G/BZ8oEWUq3NI2FnjiApGPAJEEtYP3Dslc+F02CFXuVn/j8TGnSZ0AmQNIV44=
X-Received: by 2002:a2e:9dc1:: with SMTP id x1mr6636681ljj.32.1611236238882;
 Thu, 21 Jan 2021 05:37:18 -0800 (PST)
MIME-Version: 1.0
References: <20210119204508.9256-1-john.stultz@linaro.org>
 <20210119204508.9256-3-john.stultz@linaro.org>
In-Reply-To: <20210119204508.9256-3-john.stultz@linaro.org>
From: Sumit Semwal <sumit.semwal@linaro.org>
Date: Thu, 21 Jan 2021 19:07:06 +0530
Message-ID: <CAO_48GGQ5AbHBWK6Bo75vihscmMTSdsVTYqWD2SjF_B5RdYWvg@mail.gmail.com>
Subject: Re: [RESEND][PATCH 3/3] dma-buf: heaps: Rework heep allocation hooks
 to return struct dma_buf instead of fd
To: John Stultz <john.stultz@linaro.org>
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Sandeep Patil <sspatil@google.com>,
 DRI mailing list <dri-devel@lists.freedesktop.org>,
 Ezequiel Garcia <ezequiel@collabora.com>, Robin Murphy <robin.murphy@arm.com>,
 James Jones <jajones@nvidia.com>, lkml <linux-kernel@vger.kernel.org>,
 Liam Mark <lmark@codeaurora.org>, Laura Abbott <labbott@kernel.org>,
 Chris Goldsworthy <cgoldswo@codeaurora.org>,
 Hridya Valsaraju <hridya@google.com>,
 =?UTF-8?Q?=C3=98rjan_Eide?= <orjan.eide@arm.com>,
 "open list:DMA BUFFER SHARING FRAMEWORK" <linux-media@vger.kernel.org>,
 Suren Baghdasaryan <surenb@google.com>, Daniel Mentz <danielmentz@google.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SGkgSm9obiwKCk9uIFdlZCwgMjAgSmFuIDIwMjEgYXQgMDI6MTUsIEpvaG4gU3R1bHR6IDxqb2hu
LnN0dWx0ekBsaW5hcm8ub3JnPiB3cm90ZToKPgo+IEV2ZXJ5IGhlYXAgbmVlZHMgdG8gY3JlYXRl
IGEgZG1hYnVmIGFuZCB0aGVuIGV4cG9ydCBpdCB0byBhIGZkCj4gdmlhIGRtYV9idWZfZmQoKSwg
c28gdG8gY29uc29saWRhdGUgdGhpbmdzIGEgYml0LCBoYXZlIHRoZSBoZWFwcwo+IGp1c3QgcmV0
dXJuIGEgc3RydWN0IGRtYWJ1ZiAqIGFuZCBsZXQgdGhlIHRvcCBsZXZlbAo+IGRtYV9oZWFwX2J1
ZmZlcl9hbGxvYygpIGNhbGwgaGFuZGxlIGNyZWF0aW5nIHRoZSBmZCB2aWEKPiBkbWFfYnVmX2Zk
KCkuCgpUaGFua3MgZm9yIHRoZSBwYXRjaCEgTEdUTSwgZmVlbHMgYSBsb3QgbmVhdGVyIG5vdy4g
SSdsbCBtZXJnZSBpbnRvCmRybS1taXNjLW5leHQuCj4KPiBDYzogU3VtaXQgU2Vtd2FsIDxzdW1p
dC5zZW13YWxAbGluYXJvLm9yZz4KPiBDYzogTGlhbSBNYXJrIDxsbWFya0Bjb2RlYXVyb3JhLm9y
Zz4KPiBDYzogTGF1cmEgQWJib3R0IDxsYWJib3R0QGtlcm5lbC5vcmc+Cj4gQ2M6IEJyaWFuIFN0
YXJrZXkgPEJyaWFuLlN0YXJrZXlAYXJtLmNvbT4KPiBDYzogSHJpZHlhIFZhbHNhcmFqdSA8aHJp
ZHlhQGdvb2dsZS5jb20+Cj4gQ2M6IFN1cmVuIEJhZ2hkYXNhcnlhbiA8c3VyZW5iQGdvb2dsZS5j
b20+Cj4gQ2M6IFNhbmRlZXAgUGF0aWwgPHNzcGF0aWxAZ29vZ2xlLmNvbT4KPiBDYzogRGFuaWVs
IE1lbnR6IDxkYW5pZWxtZW50ekBnb29nbGUuY29tPgo+IENjOiBDaHJpcyBHb2xkc3dvcnRoeSA8
Y2dvbGRzd29AY29kZWF1cm9yYS5vcmc+Cj4gQ2M6IMOYcmphbiBFaWRlIDxvcmphbi5laWRlQGFy
bS5jb20+Cj4gQ2M6IFJvYmluIE11cnBoeSA8cm9iaW4ubXVycGh5QGFybS5jb20+Cj4gQ2M6IEV6
ZXF1aWVsIEdhcmNpYSA8ZXplcXVpZWxAY29sbGFib3JhLmNvbT4KPiBDYzogU2ltb24gU2VyIDxj
b250YWN0QGVtZXJzaW9uLmZyPgo+IENjOiBKYW1lcyBKb25lcyA8amFqb25lc0BudmlkaWEuY29t
Pgo+IENjOiBsaW51eC1tZWRpYUB2Z2VyLmtlcm5lbC5vcmcKPiBDYzogZHJpLWRldmVsQGxpc3Rz
LmZyZWVkZXNrdG9wLm9yZwo+IFNpZ25lZC1vZmYtYnk6IEpvaG4gU3R1bHR6IDxqb2huLnN0dWx0
ekBsaW5hcm8ub3JnPgo+IC0tLQo+ICBkcml2ZXJzL2RtYS1idWYvZG1hLWhlYXAuYyAgICAgICAg
ICB8IDE0ICsrKysrKysrKysrKystCj4gIGRyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9jbWFfaGVhcC5j
ICAgIHwgMjIgKysrKysrKy0tLS0tLS0tLS0tLS0tLQo+ICBkcml2ZXJzL2RtYS1idWYvaGVhcHMv
c3lzdGVtX2hlYXAuYyB8IDIxICsrKysrKystLS0tLS0tLS0tLS0tLQo+ICBpbmNsdWRlL2xpbnV4
L2RtYS1oZWFwLmggICAgICAgICAgICB8IDEyICsrKysrKy0tLS0tLQo+ICA0IGZpbGVzIGNoYW5n
ZWQsIDMzIGluc2VydGlvbnMoKyksIDM2IGRlbGV0aW9ucygtKQo+Cj4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZG1hLWJ1Zi9kbWEtaGVhcC5jIGIvZHJpdmVycy9kbWEtYnVmL2RtYS1oZWFwLmMKPiBp
bmRleCBhZmQyMmM5ZGJkY2YuLjZiNWRiOTU0NTY5ZiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2Rt
YS1idWYvZG1hLWhlYXAuYwo+ICsrKyBiL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtaGVhcC5jCj4gQEAg
LTUyLDYgKzUyLDkgQEAgc3RhdGljIGludCBkbWFfaGVhcF9idWZmZXJfYWxsb2Moc3RydWN0IGRt
YV9oZWFwICpoZWFwLCBzaXplX3QgbGVuLAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHVuc2lnbmVkIGludCBmZF9mbGFncywKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1bnNpZ25lZCBpbnQgaGVhcF9mbGFncykKPiAgewo+ICsgICAgICAgc3RydWN0IGRtYV9i
dWYgKmRtYWJ1ZjsKPiArICAgICAgIGludCBmZDsKPiArCj4gICAgICAgICAvKgo+ICAgICAgICAg
ICogQWxsb2NhdGlvbnMgZnJvbSBhbGwgaGVhcHMgaGF2ZSB0byBiZWdpbgo+ICAgICAgICAgICog
YW5kIGVuZCBvbiBwYWdlIGJvdW5kYXJpZXMuCj4gQEAgLTYwLDcgKzYzLDE2IEBAIHN0YXRpYyBp
bnQgZG1hX2hlYXBfYnVmZmVyX2FsbG9jKHN0cnVjdCBkbWFfaGVhcCAqaGVhcCwgc2l6ZV90IGxl
biwKPiAgICAgICAgIGlmICghbGVuKQo+ICAgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsK
Pgo+IC0gICAgICAgcmV0dXJuIGhlYXAtPm9wcy0+YWxsb2NhdGUoaGVhcCwgbGVuLCBmZF9mbGFn
cywgaGVhcF9mbGFncyk7Cj4gKyAgICAgICBkbWFidWYgPSBoZWFwLT5vcHMtPmFsbG9jYXRlKGhl
YXAsIGxlbiwgZmRfZmxhZ3MsIGhlYXBfZmxhZ3MpOwo+ICsgICAgICAgaWYgKElTX0VSUihkbWFi
dWYpKQo+ICsgICAgICAgICAgICAgICByZXR1cm4gUFRSX0VSUihkbWFidWYpOwo+ICsKPiArICAg
ICAgIGZkID0gZG1hX2J1Zl9mZChkbWFidWYsIGZkX2ZsYWdzKTsKPiArICAgICAgIGlmIChmZCA8
IDApIHsKPiArICAgICAgICAgICAgICAgZG1hX2J1Zl9wdXQoZG1hYnVmKTsKPiArICAgICAgICAg
ICAgICAgLyoganVzdCByZXR1cm4sIGFzIHB1dCB3aWxsIGNhbGwgcmVsZWFzZSBhbmQgdGhhdCB3
aWxsIGZyZWUgKi8KPiArICAgICAgIH0KPiArICAgICAgIHJldHVybiBmZDsKPiAgfQo+Cj4gIHN0
YXRpYyBpbnQgZG1hX2hlYXBfb3BlbihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAq
ZmlsZSkKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9kbWEtYnVmL2hlYXBzL2NtYV9oZWFwLmMgYi9k
cml2ZXJzL2RtYS1idWYvaGVhcHMvY21hX2hlYXAuYwo+IGluZGV4IDBjNzZjYmMzZmIxMS4uOTg1
YzQxZmZkODViIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9jbWFfaGVhcC5j
Cj4gKysrIGIvZHJpdmVycy9kbWEtYnVmL2hlYXBzL2NtYV9oZWFwLmMKPiBAQCAtMjcyLDEwICsy
NzIsMTAgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkbWFfYnVmX29wcyBjbWFfaGVhcF9idWZfb3Bz
ID0gewo+ICAgICAgICAgLnJlbGVhc2UgPSBjbWFfaGVhcF9kbWFfYnVmX3JlbGVhc2UsCj4gIH07
Cj4KPiAtc3RhdGljIGludCBjbWFfaGVhcF9hbGxvY2F0ZShzdHJ1Y3QgZG1hX2hlYXAgKmhlYXAs
Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgbGVuLAo+
IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBsb25nIGZkX2ZsYWdz
LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBsb25nIGhlYXBf
ZmxhZ3MpCj4gK3N0YXRpYyBzdHJ1Y3QgZG1hX2J1ZiAqY21hX2hlYXBfYWxsb2NhdGUoc3RydWN0
IGRtYV9oZWFwICpoZWFwLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdW5zaWduZWQgbG9uZyBsZW4sCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB1bnNpZ25lZCBsb25nIGZkX2ZsYWdzLAo+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBoZWFwX2ZsYWdzKQo+ICB7Cj4gICAgICAg
ICBzdHJ1Y3QgY21hX2hlYXAgKmNtYV9oZWFwID0gZG1hX2hlYXBfZ2V0X2RydmRhdGEoaGVhcCk7
Cj4gICAgICAgICBzdHJ1Y3QgY21hX2hlYXBfYnVmZmVyICpidWZmZXI7Cj4gQEAgLTI5MCw3ICsy
OTAsNyBAQCBzdGF0aWMgaW50IGNtYV9oZWFwX2FsbG9jYXRlKHN0cnVjdCBkbWFfaGVhcCAqaGVh
cCwKPgo+ICAgICAgICAgYnVmZmVyID0ga3phbGxvYyhzaXplb2YoKmJ1ZmZlciksIEdGUF9LRVJO
RUwpOwo+ICAgICAgICAgaWYgKCFidWZmZXIpCj4gLSAgICAgICAgICAgICAgIHJldHVybiAtRU5P
TUVNOwo+ICsgICAgICAgICAgICAgICByZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKPgo+ICAgICAg
ICAgSU5JVF9MSVNUX0hFQUQoJmJ1ZmZlci0+YXR0YWNobWVudHMpOwo+ICAgICAgICAgbXV0ZXhf
aW5pdCgmYnVmZmVyLT5sb2NrKTsKPiBAQCAtMzQ5LDE1ICszNDksNyBAQCBzdGF0aWMgaW50IGNt
YV9oZWFwX2FsbG9jYXRlKHN0cnVjdCBkbWFfaGVhcCAqaGVhcCwKPiAgICAgICAgICAgICAgICAg
cmV0ID0gUFRSX0VSUihkbWFidWYpOwo+ICAgICAgICAgICAgICAgICBnb3RvIGZyZWVfcGFnZXM7
Cj4gICAgICAgICB9Cj4gLQo+IC0gICAgICAgcmV0ID0gZG1hX2J1Zl9mZChkbWFidWYsIGZkX2Zs
YWdzKTsKPiAtICAgICAgIGlmIChyZXQgPCAwKSB7Cj4gLSAgICAgICAgICAgICAgIGRtYV9idWZf
cHV0KGRtYWJ1Zik7Cj4gLSAgICAgICAgICAgICAgIC8qIGp1c3QgcmV0dXJuLCBhcyBwdXQgd2ls
bCBjYWxsIHJlbGVhc2UgYW5kIHRoYXQgd2lsbCBmcmVlICovCj4gLSAgICAgICAgICAgICAgIHJl
dHVybiByZXQ7Cj4gLSAgICAgICB9Cj4gLQo+IC0gICAgICAgcmV0dXJuIHJldDsKPiArICAgICAg
IHJldHVybiBkbWFidWY7Cj4KPiAgZnJlZV9wYWdlczoKPiAgICAgICAgIGtmcmVlKGJ1ZmZlci0+
cGFnZXMpOwo+IEBAIC0zNjYsNyArMzU4LDcgQEAgc3RhdGljIGludCBjbWFfaGVhcF9hbGxvY2F0
ZShzdHJ1Y3QgZG1hX2hlYXAgKmhlYXAsCj4gIGZyZWVfYnVmZmVyOgo+ICAgICAgICAga2ZyZWUo
YnVmZmVyKTsKPgo+IC0gICAgICAgcmV0dXJuIHJldDsKPiArICAgICAgIHJldHVybiBFUlJfUFRS
KHJldCk7Cj4gIH0KPgo+ICBzdGF0aWMgY29uc3Qgc3RydWN0IGRtYV9oZWFwX29wcyBjbWFfaGVh
cF9vcHMgPSB7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9zeXN0ZW1faGVh
cC5jIGIvZHJpdmVycy9kbWEtYnVmL2hlYXBzL3N5c3RlbV9oZWFwLmMKPiBpbmRleCAyMzIxYzkx
ODkxZjYuLjdiMTU0NDI0YWViMyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2RtYS1idWYvaGVhcHMv
c3lzdGVtX2hlYXAuYwo+ICsrKyBiL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9zeXN0ZW1faGVhcC5j
Cj4gQEAgLTMzMiwxMCArMzMyLDEwIEBAIHN0YXRpYyBzdHJ1Y3QgcGFnZSAqYWxsb2NfbGFyZ2Vz
dF9hdmFpbGFibGUodW5zaWduZWQgbG9uZyBzaXplLAo+ICAgICAgICAgcmV0dXJuIE5VTEw7Cj4g
IH0KPgo+IC1zdGF0aWMgaW50IHN5c3RlbV9oZWFwX2FsbG9jYXRlKHN0cnVjdCBkbWFfaGVhcCAq
aGVhcCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgbGVu
LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBmZF9mbGFn
cywKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgaGVhcF9m
bGFncykKPiArc3RhdGljIHN0cnVjdCBkbWFfYnVmICpzeXN0ZW1faGVhcF9hbGxvY2F0ZShzdHJ1
Y3QgZG1hX2hlYXAgKmhlYXAsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB1bnNpZ25lZCBsb25nIGxlbiwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgZmRfZmxhZ3MsCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBsb25nIGhlYXBfZmxhZ3MpCj4g
IHsKPiAgICAgICAgIHN0cnVjdCBzeXN0ZW1faGVhcF9idWZmZXIgKmJ1ZmZlcjsKPiAgICAgICAg
IERFRklORV9ETUFfQlVGX0VYUE9SVF9JTkZPKGV4cF9pbmZvKTsKPiBAQCAtMzUwLDcgKzM1MCw3
IEBAIHN0YXRpYyBpbnQgc3lzdGVtX2hlYXBfYWxsb2NhdGUoc3RydWN0IGRtYV9oZWFwICpoZWFw
LAo+Cj4gICAgICAgICBidWZmZXIgPSBremFsbG9jKHNpemVvZigqYnVmZmVyKSwgR0ZQX0tFUk5F
TCk7Cj4gICAgICAgICBpZiAoIWJ1ZmZlcikKPiAtICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9N
RU07Cj4gKyAgICAgICAgICAgICAgIHJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwo+Cj4gICAgICAg
ICBJTklUX0xJU1RfSEVBRCgmYnVmZmVyLT5hdHRhY2htZW50cyk7Cj4gICAgICAgICBtdXRleF9p
bml0KCZidWZmZXItPmxvY2spOwo+IEBAIC00MDAsMTQgKzQwMCw3IEBAIHN0YXRpYyBpbnQgc3lz
dGVtX2hlYXBfYWxsb2NhdGUoc3RydWN0IGRtYV9oZWFwICpoZWFwLAo+ICAgICAgICAgICAgICAg
ICByZXQgPSBQVFJfRVJSKGRtYWJ1Zik7Cj4gICAgICAgICAgICAgICAgIGdvdG8gZnJlZV9wYWdl
czsKPiAgICAgICAgIH0KPiAtCj4gLSAgICAgICByZXQgPSBkbWFfYnVmX2ZkKGRtYWJ1ZiwgZmRf
ZmxhZ3MpOwo+IC0gICAgICAgaWYgKHJldCA8IDApIHsKPiAtICAgICAgICAgICAgICAgZG1hX2J1
Zl9wdXQoZG1hYnVmKTsKPiAtICAgICAgICAgICAgICAgLyoganVzdCByZXR1cm4sIGFzIHB1dCB3
aWxsIGNhbGwgcmVsZWFzZSBhbmQgdGhhdCB3aWxsIGZyZWUgKi8KPiAtICAgICAgICAgICAgICAg
cmV0dXJuIHJldDsKPiAtICAgICAgIH0KPiAtICAgICAgIHJldHVybiByZXQ7Cj4gKyAgICAgICBy
ZXR1cm4gZG1hYnVmOwo+Cj4gIGZyZWVfcGFnZXM6Cj4gICAgICAgICBmb3JfZWFjaF9zZ3RhYmxl
X3NnKHRhYmxlLCBzZywgaSkgewo+IEBAIC00MjEsNyArNDE0LDcgQEAgc3RhdGljIGludCBzeXN0
ZW1faGVhcF9hbGxvY2F0ZShzdHJ1Y3QgZG1hX2hlYXAgKmhlYXAsCj4gICAgICAgICAgICAgICAg
IF9fZnJlZV9wYWdlcyhwYWdlLCBjb21wb3VuZF9vcmRlcihwYWdlKSk7Cj4gICAgICAgICBrZnJl
ZShidWZmZXIpOwo+Cj4gLSAgICAgICByZXR1cm4gcmV0Owo+ICsgICAgICAgcmV0dXJuIEVSUl9Q
VFIocmV0KTsKPiAgfQo+Cj4gIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZG1hX2hlYXBfb3BzIHN5c3Rl
bV9oZWFwX29wcyA9IHsKPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC9kbWEtaGVhcC5oIGIv
aW5jbHVkZS9saW51eC9kbWEtaGVhcC5oCj4gaW5kZXggNDU0ZTM1NGQxZmZiLi41YmM1Yzk0NmFm
NTggMTAwNjQ0Cj4gLS0tIGEvaW5jbHVkZS9saW51eC9kbWEtaGVhcC5oCj4gKysrIGIvaW5jbHVk
ZS9saW51eC9kbWEtaGVhcC5oCj4gQEAgLTE2LDE1ICsxNiwxNSBAQCBzdHJ1Y3QgZG1hX2hlYXA7
Cj4KPiAgLyoqCj4gICAqIHN0cnVjdCBkbWFfaGVhcF9vcHMgLSBvcHMgdG8gb3BlcmF0ZSBvbiBh
IGdpdmVuIGhlYXAKPiAtICogQGFsbG9jYXRlOiAgICAgICAgICBhbGxvY2F0ZSBkbWFidWYgYW5k
IHJldHVybiBmZAo+ICsgKiBAYWxsb2NhdGU6ICAgICAgICAgIGFsbG9jYXRlIGRtYWJ1ZiBhbmQg
cmV0dXJuIHN0cnVjdCBkbWFfYnVmIHB0cgo+ICAgKgo+IC0gKiBhbGxvY2F0ZSByZXR1cm5zIGRt
YWJ1ZiBmZCAgb24gc3VjY2VzcywgLWVycm5vIG9uIGVycm9yLgo+ICsgKiBhbGxvY2F0ZSByZXR1
cm5zIGRtYWJ1ZiBvbiBzdWNjZXNzLCBFUlJfUFRSKC1lcnJubykgb24gZXJyb3IuCj4gICAqLwo+
ICBzdHJ1Y3QgZG1hX2hlYXBfb3BzIHsKPiAtICAgICAgIGludCAoKmFsbG9jYXRlKShzdHJ1Y3Qg
ZG1hX2hlYXAgKmhlYXAsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBs
ZW4sCj4gLSAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBmZF9mbGFncywKPiAt
ICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBsb25nIGhlYXBfZmxhZ3MpOwo+ICsgICAg
ICAgc3RydWN0IGRtYV9idWYgKigqYWxsb2NhdGUpKHN0cnVjdCBkbWFfaGVhcCAqaGVhcCwKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBsb25nIGxlbiwKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBsb25nIGZkX2ZsYWdz
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgaGVh
cF9mbGFncyk7Cj4gIH07Cj4KPiAgLyoqCj4gLS0KPiAyLjE3LjEKPgoKQmVzdCwKU3VtaXQuCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBt
YWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3Rz
LmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbAo=
