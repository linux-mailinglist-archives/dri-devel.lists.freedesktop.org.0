Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id AA8F5100828
	for <lists+dri-devel@lfdr.de>; Mon, 18 Nov 2019 16:25:22 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8059D6E5B2;
	Mon, 18 Nov 2019 15:25:20 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from bhuna.collabora.co.uk (bhuna.collabora.co.uk [46.235.227.227])
 by gabe.freedesktop.org (Postfix) with ESMTPS id AC22889951
 for <dri-devel@lists.freedesktop.org>; Mon, 18 Nov 2019 15:25:09 +0000 (UTC)
Received: from [127.0.0.1] (localhost [127.0.0.1])
 (Authenticated sender: aratiu) with ESMTPSA id 08BE428E0E4
From: Adrian Ratiu <adrian.ratiu@collabora.com>
To: linux-arm-kernel@lists.infradead.org,
 linux-stm32@st-md-mailman.stormreply.com,
 linux-rockchip@lists.infradead.org, devicetree@vger.kernel.org
Subject: [PATCH v3 3/4] drm: imx: Add i.MX 6 MIPI DSI host driver
Date: Mon, 18 Nov 2019 17:25:17 +0200
Message-Id: <20191118152518.3374263-4-adrian.ratiu@collabora.com>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191118152518.3374263-1-adrian.ratiu@collabora.com>
References: <20191118152518.3374263-1-adrian.ratiu@collabora.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Martyn Welch <martyn.welch@collabora.com>,
 Sjoerd Simons <sjoerd.simons@collabora.com>, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, linux-imx@nxp.com, kernel@collabora.com,
 Emil Velikov <emil.velikov@collabora.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBhZGRzIHN1cHBvcnQgZm9yIHRoZSBTeW5vcHNpcyBEZXNpZ25XYXJlIE1JUEkgRFNJIHYx
LjAxIGhvc3QKY29udHJvbGxlciB3aGljaCBpcyBlbWJlZGRlZCBpbiBpLk1YIDYgU29Dcy4KCkJh
c2VkIG9uIGZvbGxvd2luZyBwYXRjaGVzLCBidXQgdXBkYXRlZC9leHRlbmRlZCB0byB3b3JrIHdp
dGggZXhpc3RpbmcKc3VwcG9ydCBmb3VuZCBpbiB0aGUga2VybmVsOgoKLSBkcm06IGlteDogU3Vw
cG9ydCBTeW5vcHN5cyBEZXNpZ25XYXJlIE1JUEkgRFNJIGhvc3QgY29udHJvbGxlcgogIFNpZ25l
ZC1vZmYtYnk6IExpdSBZaW5nIDxZaW5nLkxpdUBmcmVlc2NhbGUuY29tPgoKLSBBUk06IGR0c2k6
IGlteDZxZGw6IEFkZCBzdXBwb3J0IGZvciBNSVBJIERTSSBob3N0IGNvbnRyb2xsZXIKICBTaWdu
ZWQtb2ZmLWJ5OiBMaXUgWWluZyA8WWluZy5MaXVAZnJlZXNjYWxlLmNvbT4KClJldmlld2VkLWJ5
OiBFbWlsIFZlbGlrb3YgPGVtaWwudmVsaWtvdkBjb2xsYWJvcmEuY29tPgpTaWduZWQtb2ZmLWJ5
OiBTam9lcmQgU2ltb25zIDxzam9lcmQuc2ltb25zQGNvbGxhYm9yYS5jb20+ClNpZ25lZC1vZmYt
Ynk6IE1hcnR5biBXZWxjaCA8bWFydHluLndlbGNoQGNvbGxhYm9yYS5jb20+ClNpZ25lZC1vZmYt
Ynk6IEFkcmlhbiBSYXRpdSA8YWRyaWFuLnJhdGl1QGNvbGxhYm9yYS5jb20+Ci0tLQogZHJpdmVy
cy9ncHUvZHJtL2JyaWRnZS9zeW5vcHN5cy9kdy1taXBpLWRzaS5jIHwgMTQ2ICsrKysrKy0KIGRy
aXZlcnMvZ3B1L2RybS9pbXgvS2NvbmZpZyAgICAgICAgICAgICAgICAgICB8ICAgNyArCiBkcml2
ZXJzL2dwdS9kcm0vaW14L01ha2VmaWxlICAgICAgICAgICAgICAgICAgfCAgIDEgKwogZHJpdmVy
cy9ncHUvZHJtL2lteC9kd19taXBpX2RzaS1pbXguYyAgICAgICAgIHwgMzc4ICsrKysrKysrKysr
KysrKysrKwogNCBmaWxlcyBjaGFuZ2VkLCA1MjMgaW5zZXJ0aW9ucygrKSwgOSBkZWxldGlvbnMo
LSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaW14L2R3X21pcGlfZHNpLWlt
eC5jCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9zeW5vcHN5cy9kdy1taXBp
LWRzaS5jIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9zeW5vcHN5cy9kdy1taXBpLWRzaS5jCmlu
ZGV4IGE0MWE2MzAzMDJiNi4uNWYyZmE0Njc3MzRjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vYnJpZGdlL3N5bm9wc3lzL2R3LW1pcGktZHNpLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2Jy
aWRnZS9zeW5vcHN5cy9kdy1taXBpLWRzaS5jCkBAIC0zMSw2ICszMSw4IEBACiAjaW5jbHVkZSA8
ZHJtL2RybV9wcm9iZV9oZWxwZXIuaD4KIAogI2RlZmluZSBIV1ZFUl8xMzEJCQkweDMxMzMzMTAw
CS8qIElQIHZlcnNpb24gMS4zMSAqLworI2RlZmluZSBIV1ZFUl8xMzAJCQkweDMxMzMzMDAwCS8q
IElQIHZlcnNpb24gMS4zMCAqLworI2RlZmluZSBIV1ZFUl8xMDEJCQkweDMxMzAzMDAwCS8qIElQ
IHZlcnNpb24gMS4wMSAqLwogCiAjZGVmaW5lIERTSV9WRVJTSU9OCQkJMHgwMAogI2RlZmluZSBW
RVJTSU9OCQkJCUdFTk1BU0soMzEsIDgpCkBAIC05OSw2ICsxMDEsMjUgQEAKICNkZWZpbmUgRFNJ
X0VEUElfQ01EX1NJWkUJCTB4NjQKIAogI2RlZmluZSBEU0lfQ01EX01PREVfQ0ZHCQkweDY4CisK
KyNkZWZpbmUgRFNJX0RQSV9DRkcJCQkweDBjCisjZGVmaW5lIERTSV9UTVJfTElORV9DRkcJCTB4
MjgKKyNkZWZpbmUgRFNJX1ZUSU1JTkdfQ0ZHCQkJMHgyYworI2RlZmluZSBEU0lfUEhZX1RNUl9D
RkdfVjEwMQkJMHgzMAorI2RlZmluZSBEU0lfUEhZX0lGX0NGR19WMTAxCQkweDU4CisjZGVmaW5l
IERTSV9QSFlfSUZfQ1RSTAkJCTB4NWMKKyNkZWZpbmUgRFNJX1BIWV9SU1RaX1YxMDEJCTB4NTQK
KyNkZWZpbmUgRFNJX1BIWV9TVEFUVVNfVjEwMQkJMHg2MAorI2RlZmluZSBEU0lfUEhZX1RTVF9D
VFJMMF9WMTAxCQkweDY0CisjZGVmaW5lIERTSV9HRU5fSERSX1YxMDEJCTB4MzQKKyNkZWZpbmUg
RFNJX0dFTl9QTERfREFUQV9WMTAxCQkweDM4CisjZGVmaW5lIERTSV9DTURfTU9ERV9DRkdfVjEw
MQkJMHgyNAorI2RlZmluZSBEU0lfQ01EX1BLVF9TVEFUVVNfVjEwMQkJMHgzYworI2RlZmluZSBE
U0lfVklEX1BLVF9DRkcJCQkweDIwCisjZGVmaW5lIERTSV9WSURfTU9ERV9DRkdfVjEwMQkJMHgx
YworI2RlZmluZSBEU0lfVE9fQ05UX0NGR19WMTAxCQkweDQwCisjZGVmaW5lIERTSV9QQ0tIRExf
Q0ZHX1YxMDEJCTB4MTgKKwogI2RlZmluZSBNQVhfUkRfUEtUX1NJWkVfTFAJCUJJVCgyNCkKICNk
ZWZpbmUgRENTX0xXX1RYX0xQCQkJQklUKDE5KQogI2RlZmluZSBEQ1NfU1JfMFBfVFhfTFAJCQlC
SVQoMTgpCkBAIC0xMjYsNiArMTQ3LDMzIEBACiAJCQkJCSBHRU5fU1dfMVBfVFhfTFAgfCBcCiAJ
CQkJCSBHRU5fU1dfMFBfVFhfTFApCiAKKyNkZWZpbmUgRU5fVEVBUl9GWF9WMTAxCQkJQklUKDE0
KQorI2RlZmluZSBEQ1NfTFdfVFhfTFBfVjEwMQkJQklUKDEyKQorI2RlZmluZSBHRU5fTFdfVFhf
TFBfVjEwMQkJQklUKDExKQorI2RlZmluZSBNQVhfUkRfUEtUX1NJWkVfTFBfVjEwMQkJQklUKDEw
KQorI2RlZmluZSBEQ1NfU1dfMlBfVFhfTFBfVjEwMQkJQklUKDkpCisjZGVmaW5lIERDU19TV18x
UF9UWF9MUF9WMTAxCQlCSVQoOCkKKyNkZWZpbmUgRENTX1NXXzBQX1RYX0xQX1YxMDEJCUJJVCg3
KQorI2RlZmluZSBHRU5fU1JfMlBfVFhfTFBfVjEwMQkJQklUKDYpCisjZGVmaW5lIEdFTl9TUl8x
UF9UWF9MUF9WMTAxCQlCSVQoNSkKKyNkZWZpbmUgR0VOX1NSXzBQX1RYX0xQX1YxMDEJCUJJVCg0
KQorI2RlZmluZSBHRU5fU1dfMlBfVFhfTFBfVjEwMQkJQklUKDMpCisjZGVmaW5lIEdFTl9TV18x
UF9UWF9MUF9WMTAxCQlCSVQoMikKKyNkZWZpbmUgR0VOX1NXXzBQX1RYX0xQX1YxMDEJCUJJVCgx
KQorCisjZGVmaW5lIENNRF9NT0RFX0FMTF9MUF9WMTAxCQkoRENTX0xXX1RYX0xQX1YxMDEgfCBc
CisJCQkJCSBHRU5fTFdfVFhfTFBfVjEwMSB8IFwKKwkJCQkJIE1BWF9SRF9QS1RfU0laRV9MUF9W
MTAxIHwgXAorCQkJCQkgRENTX1NXXzJQX1RYX0xQX1YxMDEgfCBcCisJCQkJCSBEQ1NfU1dfMVBf
VFhfTFBfVjEwMSB8IFwKKwkJCQkJIERDU19TV18wUF9UWF9MUF9WMTAxIHwgXAorCQkJCQkgR0VO
X1NSXzJQX1RYX0xQX1YxMDEgfCBcCisJCQkJCSBHRU5fU1JfMVBfVFhfTFBfVjEwMSB8IFwKKwkJ
CQkJIEdFTl9TUl8wUF9UWF9MUF9WMTAxIHwgXAorCQkJCQkgR0VOX1NXXzJQX1RYX0xQX1YxMDEg
fCBcCisJCQkJCSBHRU5fU1dfMVBfVFhfTFBfVjEwMSB8IFwKKwkJCQkJIEdFTl9TV18wUF9UWF9M
UF9WMTAxKQorCiAjZGVmaW5lIERTSV9HRU5fSERSCQkJMHg2YwogI2RlZmluZSBEU0lfR0VOX1BM
RF9EQVRBCQkweDcwCiAKQEAgLTE2NCw2ICsyMTIsMTEgQEAKICNkZWZpbmUgRFNJX0lOVF9NU0sw
CQkJMHhjNAogI2RlZmluZSBEU0lfSU5UX01TSzEJCQkweGM4CiAKKyNkZWZpbmUgRFNJX0VSUk9S
X1NUMF9WMTAxCQkweDQ0CisjZGVmaW5lIERTSV9FUlJPUl9TVDFfVjEwMQkJMHg0OAorI2RlZmlu
ZSBEU0lfRVJST1JfTVNLMF9WMTAxCQkweDRjCisjZGVmaW5lIERTSV9FUlJPUl9NU0sxX1YxMDEJ
CTB4NTAKKwogI2RlZmluZSBEU0lfUEhZX1RNUl9SRF9DRkcJCTB4ZjQKIAogI2RlZmluZSBQSFlf
U1RBVFVTX1RJTUVPVVRfVVMJCTEwMDAwCkBAIC0zNTcsNiArNDEwLDQ5IEBAIHN0YXRpYyBjb25z
dCBzdHJ1Y3QgZHdfbWlwaV9kc2lfdmFyaWFudCBkd19taXBpX2RzaV92MTMwX3YxMzFfbGF5b3V0
ID0gewogCS5jZmdfZ2VuX3BheWxvYWQgPQkJUkVHX0ZJRUxEKERTSV9HRU5fUExEX0RBVEEsIDAs
IDMxKSwKIH07CiAKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHdfbWlwaV9kc2lfdmFyaWFudCBkd19t
aXBpX2RzaV92MTAxX2xheW91dCA9IHsKKwkuY2ZnX2RwaV92aWQgPQkJCVJFR19GSUVMRChEU0lf
RFBJX0NGRywgMCwgMSksCisJLmNmZ19kcGlfY29sb3JfY29kaW5nID0JCVJFR19GSUVMRChEU0lf
RFBJX0NGRywgMiwgNCksCisJLmNmZ19kcGlfMThsb29zZWx5X2VuID0JCVJFR19GSUVMRChEU0lf
RFBJX0NGRywgMTAsIDEwKSwKKwkuY2ZnX2RwaV92c3luY19hY3RpdmVfbG93ID0JUkVHX0ZJRUxE
KERTSV9EUElfQ0ZHLCA2LCA2KSwKKwkuY2ZnX2RwaV9oc3luY19hY3RpdmVfbG93ID0JUkVHX0ZJ
RUxEKERTSV9EUElfQ0ZHLCA3LCA3KSwKKwkuY2ZnX2NtZF9tb2RlX2VuID0JCVJFR19GSUVMRChE
U0lfQ01EX01PREVfQ0ZHX1YxMDEsIDAsIDApLAorCS5jZmdfY21kX21vZGVfYWxsX2xwX2VuID0J
UkVHX0ZJRUxEKERTSV9DTURfTU9ERV9DRkdfVjEwMSwgMSwgMTIpLAorCS5jZmdfY21kX21vZGVf
YWNrX3Jxc3RfZW4gPQlSRUdfRklFTEQoRFNJX0NNRF9NT0RFX0NGR19WMTAxLCAxMywgMTMpLAor
CS5jZmdfY21kX3BrdF9zdGF0dXMgPQkJUkVHX0ZJRUxEKERTSV9DTURfUEtUX1NUQVRVU19WMTAx
LCAwLCAxNCksCisJLmNmZ192aWRfbW9kZV9lbiA9CQlSRUdfRklFTEQoRFNJX1ZJRF9NT0RFX0NG
R19WMTAxLCAwLCAwKSwKKwkuY2ZnX3ZpZF9tb2RlX3R5cGUgPQkJUkVHX0ZJRUxEKERTSV9WSURf
TU9ERV9DRkdfVjEwMSwgMSwgMiksCisJLmNmZ192aWRfbW9kZV9sb3dfcG93ZXIgPQlSRUdfRklF
TEQoRFNJX1ZJRF9NT0RFX0NGR19WMTAxLCAzLCA4KSwKKwkuY2ZnX3ZpZF9wa3Rfc2l6ZSA9CQlS
RUdfRklFTEQoRFNJX1ZJRF9QS1RfQ0ZHLCAwLCAxMCksCisJLmNmZ192aWRfaHNhX3RpbWUgPQkJ
UkVHX0ZJRUxEKERTSV9UTVJfTElORV9DRkcsIDAsIDgpLAorCS5jZmdfdmlkX2hicF90aW1lID0J
CVJFR19GSUVMRChEU0lfVE1SX0xJTkVfQ0ZHLCA5LCAxNyksCisJLmNmZ192aWRfaGxpbmVfdGlt
ZSA9CQlSRUdfRklFTEQoRFNJX1RNUl9MSU5FX0NGRywgMTgsIDMxKSwKKwkuY2ZnX3ZpZF92c2Ff
dGltZSA9CQlSRUdfRklFTEQoRFNJX1ZUSU1JTkdfQ0ZHLCAwLCAzKSwKKwkuY2ZnX3ZpZF92YnBf
dGltZSA9CQlSRUdfRklFTEQoRFNJX1ZUSU1JTkdfQ0ZHLCA0LCA5KSwKKwkuY2ZnX3ZpZF92ZnBf
dGltZSA9CQlSRUdfRklFTEQoRFNJX1ZUSU1JTkdfQ0ZHLCAxMCwgMTUpLAorCS5jZmdfdmlkX3Zh
Y3RpdmVfdGltZSA9CQlSRUdfRklFTEQoRFNJX1ZUSU1JTkdfQ0ZHLCAxNiwgMjYpLAorCS5jZmdf
cGh5X3R4cmVxdWVzdGNsa2hzID0JUkVHX0ZJRUxEKERTSV9QSFlfSUZfQ1RSTCwgMCwgMCksCisJ
LmNmZ19waHlfYnRhX3RpbWUgPQkJUkVHX0ZJRUxEKERTSV9QSFlfVE1SX0NGR19WMTAxLCAwLCAx
MSksCisJLmNmZ19waHlfbHAyaHNfdGltZSA9CQlSRUdfRklFTEQoRFNJX1BIWV9UTVJfQ0ZHX1Yx
MDEsIDEyLCAxOSksCisJLmNmZ19waHlfaHMybHBfdGltZSA9CQlSRUdfRklFTEQoRFNJX1BIWV9U
TVJfQ0ZHX1YxMDEsIDIwLCAyNyksCisJLmNmZ19waHlfdGVzdGNsciA9CQlSRUdfRklFTEQoRFNJ
X1BIWV9UU1RfQ1RSTDBfVjEwMSwgMCwgMCksCisJLmNmZ19waHlfdW5zaHV0ZG93bnogPQkJUkVH
X0ZJRUxEKERTSV9QSFlfUlNUWl9WMTAxLCAwLCAwKSwKKwkuY2ZnX3BoeV91bnJzdHogPQkJUkVH
X0ZJRUxEKERTSV9QSFlfUlNUWl9WMTAxLCAxLCAxKSwKKwkuY2ZnX3BoeV9lbmFibGVjbGsgPQkJ
UkVHX0ZJRUxEKERTSV9QSFlfUlNUWl9WMTAxLCAyLCAyKSwKKwkuY2ZnX3BoeV9ubGFuZXMgPQkJ
UkVHX0ZJRUxEKERTSV9QSFlfSUZfQ0ZHX1YxMDEsIDAsIDEpLAorCS5jZmdfcGh5X3N0b3Bfd2Fp
dF90aW1lID0JUkVHX0ZJRUxEKERTSV9QSFlfSUZfQ0ZHX1YxMDEsIDIsIDkpLAorCS5jZmdfcGh5
X3N0YXR1cyA9CQlSRUdfRklFTEQoRFNJX1BIWV9TVEFUVVNfVjEwMSwgMCwgMCksCisJLmNmZ19w
Y2toZGxfY2ZnID0JCVJFR19GSUVMRChEU0lfUENLSERMX0NGR19WMTAxLCAwLCA0KSwKKwkuY2Zn
X2hzdHhfdGltZW91dF9jb3VudGVyID0JUkVHX0ZJRUxEKERTSV9UT19DTlRfQ0ZHX1YxMDEsIDAs
IDE1KSwKKwkuY2ZnX2xwcnhfdGltZW91dF9jb3VudGVyID0JUkVHX0ZJRUxEKERTSV9UT19DTlRf
Q0ZHX1YxMDEsIDE2LCAzMSksCisJLmNmZ19pbnRfc3RhdDAgPQkJUkVHX0ZJRUxEKERTSV9FUlJP
Ul9TVDBfVjEwMSwgMCwgMjApLAorCS5jZmdfaW50X3N0YXQxID0JCVJFR19GSUVMRChEU0lfRVJS
T1JfU1QxX1YxMDEsIDAsIDE3KSwKKwkuY2ZnX2ludF9tYXNrMCA9CQlSRUdfRklFTEQoRFNJX0VS
Uk9SX01TSzBfVjEwMSwgMCwgMjApLAorCS5jZmdfaW50X21hc2sxID0JCVJFR19GSUVMRChEU0lf
RVJST1JfTVNLMV9WMTAxLCAwLCAxNyksCisJLmNmZ19nZW5faGRyID0JCQlSRUdfRklFTEQoRFNJ
X0dFTl9IRFJfVjEwMSwgMCwgMzEpLAorCS5jZmdfZ2VuX3BheWxvYWQgPQkJUkVHX0ZJRUxEKERT
SV9HRU5fUExEX0RBVEFfVjEwMSwgMCwgMzEpLAorfTsKKwogLyoKICAqIENoZWNrIGlmIGVpdGhl
ciBhIGxpbmsgdG8gYSBtYXN0ZXIgb3Igc2xhdmUgaXMgcHJlc2VudAogICovCkBAIC00NTksMTIg
KzU1NSwyMSBAQCBzdGF0aWMgdm9pZCBkd19taXBpX21lc3NhZ2VfY29uZmlnKHN0cnVjdCBkd19t
aXBpX2RzaSAqZHNpLAogCWJvb2wgbHBtID0gbXNnLT5mbGFncyAmIE1JUElfRFNJX01TR19VU0Vf
TFBNOwogCXUzMiBjbWRfbW9kZV9scCA9IDA7CiAKKwlzd2l0Y2ggKGRzaS0+aHdfdmVyc2lvbikg
eworCWNhc2UgSFdWRVJfMTMwOgorCWNhc2UgSFdWRVJfMTMxOgorCQljbWRfbW9kZV9scCA9IENN
RF9NT0RFX0FMTF9MUDsKKwkJYnJlYWs7CisJY2FzZSBIV1ZFUl8xMDE6CisJCWNtZF9tb2RlX2xw
ID0gQ01EX01PREVfQUxMX0xQX1YxMDE7CisJCWJyZWFrOworCX0KKwogCWlmIChtc2ctPmZsYWdz
ICYgTUlQSV9EU0lfTVNHX1JFUV9BQ0spCiAJCXJlZ21hcF9maWVsZF93cml0ZShkc2ktPmZpZWxk
X2NtZF9tb2RlX2Fja19ycXN0X2VuLCAxKTsKIAogCWlmIChscG0pCi0JCXJlZ21hcF9maWVsZF93
cml0ZShkc2ktPmZpZWxkX2NtZF9tb2RlX2FsbF9scF9lbiwKLQkJCQkgICBDTURfTU9ERV9BTExf
TFApOworCQlyZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9jbWRfbW9kZV9hbGxfbHBfZW4s
IGNtZF9tb2RlX2xwKTsKIAogCXJlZ21hcF9maWVsZF93cml0ZShkc2ktPmZpZWxkX3BoeV90eHJl
cXVlc3RjbGtocywgbHBtID8gMCA6IDEpOwogfQpAQCAtNjM2LDcgKzc0MSw3IEBAIHN0YXRpYyB2
b2lkIGR3X21pcGlfZHNpX3ZpZGVvX21vZGVfY29uZmlnKHN0cnVjdCBkd19taXBpX2RzaSAqZHNp
KQogCQkJCSAgIFZJRF9NT0RFX1RZUEVfTk9OX0JVUlNUX1NZTkNfRVZFTlRTKTsKIAogI2lmZGVm
IENPTkZJR19ERUJVR19GUwotCWlmIChkc2ktPnZwZykgeworCWlmIChkc2ktPmh3X3ZlcnNpb24g
PiBIV1ZFUl8xMDEgJiYgZHNpLT52cGcpIHsKIAkJcmVnbWFwX2ZpZWxkX3dyaXRlKGRzaS0+cmVn
cywgZHNpLT5maWVsZF92aWRfbW9kZV92cGdfZW4sIDEpOwogCQlyZWdtYXBfZmllbGRfd3JpdGUo
ZHNpLT5yZWdzLCBkc2ktPmZpZWxkX3ZpZF9tb2RlX3ZwZ19ob3JpeiwKIAkJCQkgICBkc2ktPnZw
Z19ob3Jpem9udGFsID8gMSA6IDApOwpAQCAtNjU0LDkgKzc1OSwxNSBAQCBzdGF0aWMgdm9pZCBk
d19taXBpX2RzaV9zZXRfbW9kZShzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSwKIAogCQlkd19taXBp
X2RzaV92aWRlb19tb2RlX2NvbmZpZyhkc2kpOwogCisJCWlmIChkc2ktPmh3X3ZlcnNpb24gPT0g
SFdWRVJfMTAxKQorCQkJcmVnbWFwX2ZpZWxkX3dyaXRlKGRzaS0+ZmllbGRfdmlkX21vZGVfZW4s
IDEpOworCiAJCXJlZ21hcF9maWVsZF93cml0ZShkc2ktPmZpZWxkX3BoeV90eHJlcXVlc3RjbGto
cywgMSk7CiAJfSBlbHNlIHsKIAkJcmVnbWFwX2ZpZWxkX3dyaXRlKGRzaS0+ZmllbGRfY21kX21v
ZGVfZW4sIDEpOworCisJCWlmIChkc2ktPmh3X3ZlcnNpb24gPT0gSFdWRVJfMTAxKQorCQkJcmVn
bWFwX2ZpZWxkX3dyaXRlKGRzaS0+ZmllbGRfdmlkX21vZGVfZW4sIDApOwogCX0KIAogCXJlZ21h
cF93cml0ZShkc2ktPnJlZ3MsIERTSV9QV1JfVVAsIFBPV0VSVVApOwpAQCAtODQwLDkgKzk1MSwx
MSBAQCBzdGF0aWMgdm9pZCBkd19taXBpX2RzaV9kcGh5X3RpbWluZ19jb25maWcoc3RydWN0IGR3
X21pcGlfZHNpICpkc2kpCiAJcmVnbWFwX2ZpZWxkX3dyaXRlKGRzaS0+ZmllbGRfcGh5X2xwMmhz
X3RpbWUsIDB4NDApOwogCXJlZ21hcF9maWVsZF93cml0ZShkc2ktPmZpZWxkX3BoeV9oczJscF90
aW1lLCAweDQwKTsKIAotCXJlZ21hcF9maWVsZF93cml0ZShkc2ktPmZpZWxkX3BoeV9tYXhfcmRf
dGltZSwgMTAwMDApOwotCXJlZ21hcF9maWVsZF93cml0ZShkc2ktPmZpZWxkX3BoeV9jbGtscDJo
c190aW1lLCAweDQwKTsKLQlyZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfY2xraHMy
bHBfdGltZSwgMHg0MCk7CisJaWYgKGRzaS0+aHdfdmVyc2lvbiA+IEhXVkVSXzEwMSkgeworCQly
ZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfbWF4X3JkX3RpbWUsIDEwMDAwKTsKKwkJ
cmVnbWFwX2ZpZWxkX3dyaXRlKGRzaS0+ZmllbGRfcGh5X2Nsa2xwMmhzX3RpbWUsIDB4NDApOwor
CQlyZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfY2xraHMybHBfdGltZSwgMHg0MCk7
CisJfQogfQogCiBzdGF0aWMgdm9pZCBkd19taXBpX2RzaV9kcGh5X2ludGVyZmFjZV9jb25maWco
c3RydWN0IGR3X21pcGlfZHNpICpkc2kpCkBAIC04NjMsNyArOTc2LDggQEAgc3RhdGljIHZvaWQg
ZHdfbWlwaV9kc2lfZHBoeV9pbml0KHN0cnVjdCBkd19taXBpX2RzaSAqZHNpKQogCXJlZ21hcF9m
aWVsZF93cml0ZShkc2ktPmZpZWxkX3BoeV91bnJzdHosIDApOwogCXJlZ21hcF9maWVsZF93cml0
ZShkc2ktPmZpZWxkX3BoeV91bnNodXRkb3dueiwgMCk7CiAKLQlyZWdtYXBfZmllbGRfd3JpdGUo
ZHNpLT5maWVsZF9waHlfZm9yY2VwbGwsIDApOworCWlmIChkc2ktPmh3X3ZlcnNpb24gPiBIV1ZF
Ul8xMDEpCisJCXJlZ21hcF9maWVsZF93cml0ZShkc2ktPmZpZWxkX3BoeV9mb3JjZXBsbCwgMCk7
CiAKIAlyZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfdGVzdGNsciwgMCk7CiAJcmVn
bWFwX2ZpZWxkX3dyaXRlKGRzaS0+ZmllbGRfcGh5X3Rlc3RjbHIsIDEpOwpAQCAtODc5LDcgKzk5
Myw4IEBAIHN0YXRpYyB2b2lkIGR3X21pcGlfZHNpX2RwaHlfZW5hYmxlKHN0cnVjdCBkd19taXBp
X2RzaSAqZHNpKQogCXJlZ21hcF9maWVsZF93cml0ZShkc2ktPmZpZWxkX3BoeV91bnJzdHosIDEp
OwogCXJlZ21hcF9maWVsZF93cml0ZShkc2ktPmZpZWxkX3BoeV91bnNodXRkb3dueiwgMSk7CiAK
LQlyZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfZm9yY2VwbGwsIDEpOworCWlmIChk
c2ktPmh3X3ZlcnNpb24gPiBIV1ZFUl8xMDEpCisJCXJlZ21hcF9maWVsZF93cml0ZShkc2ktPmZp
ZWxkX3BoeV9mb3JjZXBsbCwgMSk7CiAKIAlyZXQgPSByZWdtYXBfZmllbGRfcmVhZF9wb2xsX3Rp
bWVvdXQoZHNpLT5maWVsZF9waHlfc3RhdHVzLAogCQkJCQkgICAgIHZhbCwgdmFsICYgUEhZX0xP
Q0ssCkBAIC0xMTA1LDcgKzEyMjAsMjAgQEAgc3RhdGljIHZvaWQgZHdfbWlwaV9kc2lfZ2V0X2h3
X3ZlcnNpb24oc3RydWN0IGR3X21pcGlfZHNpICpkc2kpCiAKIHN0YXRpYyBpbnQgZHdfbWlwaV9k
c2lfcmVnbWFwX2ZpZWxkc19pbml0KHN0cnVjdCBkd19taXBpX2RzaSAqZHNpKQogewotCWNvbnN0
IHN0cnVjdCBkd19taXBpX2RzaV92YXJpYW50ICp2YXJpYW50ID0gJmR3X21pcGlfZHNpX3YxMzBf
djEzMV9sYXlvdXQ7CisJY29uc3Qgc3RydWN0IGR3X21pcGlfZHNpX3ZhcmlhbnQgKnZhcmlhbnQ7
CisKKwlzd2l0Y2ggKGRzaS0+aHdfdmVyc2lvbikgeworCWNhc2UgSFdWRVJfMTMwOgorCWNhc2Ug
SFdWRVJfMTMxOgorCQl2YXJpYW50ID0gJmR3X21pcGlfZHNpX3YxMzBfdjEzMV9sYXlvdXQ7CisJ
CWJyZWFrOworCWNhc2UgSFdWRVJfMTAxOgorCQl2YXJpYW50ID0gJmR3X21pcGlfZHNpX3YxMDFf
bGF5b3V0OworCQlicmVhazsKKwlkZWZhdWx0OgorCQlEUk1fRVJST1IoIlVucmVjb2duaXplZCBE
U0kgaG9zdCBjb250cm9sbGVyIEhXIHJldmlzaW9uXG4iKTsKKwkJcmV0dXJuIC1FTk9ERVY7CisJ
fQogCiAJSU5JVF9GSUVMRChkcGlfMThsb29zZWx5X2VuKTsKIAlJTklUX0ZJRUxEKGRwaV92aWQp
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2lteC9LY29uZmlnIGIvZHJpdmVycy9ncHUv
ZHJtL2lteC9LY29uZmlnCmluZGV4IDIwN2JmNzQwOWRmYi4uMzk2NzkzZWJmNTQyIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaW14L0tjb25maWcKKysrIGIvZHJpdmVycy9ncHUvZHJtL2lt
eC9LY29uZmlnCkBAIC0zOSwzICszOSwxMCBAQCBjb25maWcgRFJNX0lNWF9IRE1JCiAJZGVwZW5k
cyBvbiBEUk1fSU1YCiAJaGVscAogCSAgQ2hvb3NlIHRoaXMgaWYgeW91IHdhbnQgdG8gdXNlIEhE
TUkgb24gaS5NWDYuCisKK2NvbmZpZyBEUk1fSU1YX01JUElfRFNJCisJdHJpc3RhdGUgIkZyZWVz
Y2FsZSBpLk1YIERSTSBNSVBJIERTSSIKKwlzZWxlY3QgRFJNX0RXX01JUElfRFNJCisJZGVwZW5k
cyBvbiBEUk1fSU1YCisJaGVscAorCSAgQ2hvb3NlIHRoaXMgaWYgeW91IHdhbnQgdG8gdXNlIE1J
UEkgRFNJIG9uIGkuTVg2LgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2lteC9NYWtlZmls
ZSBiL2RyaXZlcnMvZ3B1L2RybS9pbXgvTWFrZWZpbGUKaW5kZXggMjFjZGNjMmZhYWJjLi42NTQz
YTgxMzc2ZWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pbXgvTWFrZWZpbGUKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2lteC9NYWtlZmlsZQpAQCAtOSwzICs5LDQgQEAgb2JqLSQoQ09ORklH
X0RSTV9JTVhfVFZFKSArPSBpbXgtdHZlLm8KIG9iai0kKENPTkZJR19EUk1fSU1YX0xEQikgKz0g
aW14LWxkYi5vCiAKIG9iai0kKENPTkZJR19EUk1fSU1YX0hETUkpICs9IGR3X2hkbWktaW14Lm8K
K29iai0kKENPTkZJR19EUk1fSU1YX01JUElfRFNJKSArPSBkd19taXBpX2RzaS1pbXgubwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2lteC9kd19taXBpX2RzaS1pbXguYyBiL2RyaXZlcnMv
Z3B1L2RybS9pbXgvZHdfbWlwaV9kc2ktaW14LmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXgg
MDAwMDAwMDAwMDAwLi5hYWJhN2U4OGNhYTgKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dw
dS9kcm0vaW14L2R3X21pcGlfZHNpLWlteC5jCkBAIC0wLDAgKzEsMzc4IEBACisvLyBTUERYLUxp
Y2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCsKKy8qCisgKiBpLk1YIGRybSBkcml2ZXIgLSBNSVBJ
IERTSSBIb3N0IENvbnRyb2xsZXIKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMTEtMjAxNSBGcmVl
c2NhbGUgU2VtaWNvbmR1Y3RvciwgSW5jLgorICovCisKKyNpbmNsdWRlIDxsaW51eC9jbGsuaD4K
KyNpbmNsdWRlIDxsaW51eC9jb21wb25lbnQuaD4KKyNpbmNsdWRlIDxsaW51eC9tZmQvc3lzY29u
Lmg+CisjaW5jbHVkZSA8bGludXgvbWZkL3N5c2Nvbi9pbXg2cS1pb211eGMtZ3ByLmg+CisjaW5j
bHVkZSA8bGludXgvbW9kdWxlLmg+CisjaW5jbHVkZSA8bGludXgvb2ZfZGV2aWNlLmg+CisjaW5j
bHVkZSA8bGludXgvcmVnbWFwLmg+CisjaW5jbHVkZSA8bGludXgvdmlkZW9kZXYyLmg+CisjaW5j
bHVkZSA8ZHJtL2JyaWRnZS9kd19taXBpX2RzaS5oPgorI2luY2x1ZGUgPGRybS9kcm1fY3J0Y19o
ZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX21pcGlfZHNpLmg+CisjaW5jbHVkZSA8ZHJtL2Ry
bV9vZi5oPgorI2luY2x1ZGUgPGRybS9kcm1fcHJpbnQuaD4KKworI2luY2x1ZGUgImlteC1kcm0u
aCIKKworI2RlZmluZSBEUklWRVJfTkFNRQkiaW14LW1pcGktZHNpIgorCisjZGVmaW5lIERTSV9Q
V1JfVVAJCQkweDA0CisjZGVmaW5lIFJFU0VUCQkJCTAKKyNkZWZpbmUgUE9XRVJVUAkJCQlCSVQo
MCkKKworI2RlZmluZSBEU0lfUEhZX0lGX0NUUkwJCQkweDVjCisjZGVmaW5lIFBIWV9JRl9DVFJM
X1JFU0VUCQkweDAKKworI2RlZmluZSBEU0lfUEhZX1RTVF9DVFJMMAkJMHg2NAorI2RlZmluZSBQ
SFlfVEVTVENMSwkJCUJJVCgxKQorI2RlZmluZSBQSFlfVU5URVNUQ0xLCQkJMAorI2RlZmluZSBQ
SFlfVEVTVENMUgkJCUJJVCgwKQorI2RlZmluZSBQSFlfVU5URVNUQ0xSCQkJMAorCisjZGVmaW5l
IERTSV9QSFlfVFNUX0NUUkwxCQkweDY4CisjZGVmaW5lIFBIWV9URVNURU4JCQlCSVQoMTYpCisj
ZGVmaW5lIFBIWV9VTlRFU1RFTgkJCTAKKyNkZWZpbmUgUEhZX1RFU1RET1VUKG4pCQkJKCgobikg
JiAweGZmKSA8PCA4KQorI2RlZmluZSBQSFlfVEVTVERJTihuKQkJCSgoKG4pICYgMHhmZikgPDwg
MCkKKworc3RydWN0IGlteF9taXBpX2RzaSB7CisJc3RydWN0IGRybV9lbmNvZGVyIGVuY29kZXI7
CisJc3RydWN0IGRldmljZSAqZGV2OworCXN0cnVjdCByZWdtYXAgKm11eF9zZWw7CisJc3RydWN0
IGR3X21pcGlfZHNpICptaXBpX2RzaTsKKwlzdHJ1Y3QgY2xrICpwbGxyZWZfY2xrOworCisJc3Ry
dWN0IHJlZ21hcCAqcmVnczsKKwl1bnNpZ25lZCBpbnQgbGFuZV9tYnBzOworfTsKKworc3RydWN0
IGRwaHlfcGxsX3Rlc3RkaW5fbWFwIHsKKwl1bnNpZ25lZCBpbnQgbWF4X21icHM7CisJdTggdGVz
dGRpbjsKK307CisKKy8qIFRoZSB0YWJsZSBpcyBiYXNlZCBvbiAyN01IeiBEUEhZIHBsbCByZWZl
cmVuY2UgY2xvY2suICovCitzdGF0aWMgY29uc3Qgc3RydWN0IGRwaHlfcGxsX3Rlc3RkaW5fbWFw
IGRwdGRpbl9tYXBbXSA9IHsKKwl7MTYwLCAweDA0fSwgezE4MCwgMHgyNH0sIHsyMDAsIDB4NDR9
LCB7MjEwLCAweDA2fSwKKwl7MjQwLCAweDI2fSwgezI1MCwgMHg0Nn0sIHsyNzAsIDB4MDh9LCB7
MzAwLCAweDI4fSwKKwl7MzMwLCAweDQ4fSwgezM2MCwgMHgyYX0sIHs0MDAsIDB4NGF9LCB7NDUw
LCAweDBjfSwKKwl7NTAwLCAweDJjfSwgezU1MCwgMHgwZX0sIHs2MDAsIDB4MmV9LCB7NjUwLCAw
eDEwfSwKKwl7NzAwLCAweDMwfSwgezc1MCwgMHgxMn0sIHs4MDAsIDB4MzJ9LCB7ODUwLCAweDE0
fSwKKwl7OTAwLCAweDM0fSwgezk1MCwgMHg1NH0sIHsxMDAwLCAweDc0fQorfTsKKworc3RhdGlj
IGlubGluZSBzdHJ1Y3QgaW14X21pcGlfZHNpICplbmNfdG9fZHNpKHN0cnVjdCBkcm1fZW5jb2Rl
ciAqZW5jKQoreworCXJldHVybiBjb250YWluZXJfb2YoZW5jLCBzdHJ1Y3QgaW14X21pcGlfZHNp
LCBlbmNvZGVyKTsKK30KKworc3RhdGljIHZvaWQgaW14X21pcGlfZHNpX3NldF9pcHVfZGlfbXV4
KHN0cnVjdCBpbXhfbWlwaV9kc2kgKmRzaSwgaW50IGlwdV9kaSkKK3sKKwlyZWdtYXBfdXBkYXRl
X2JpdHMoZHNpLT5tdXhfc2VsLCBJT01VWENfR1BSMywKKwkJCSAgIElNWDZRX0dQUjNfTUlQSV9N
VVhfQ1RMX01BU0ssCisJCQkgICBpcHVfZGkgPDwgSU1YNlFfR1BSM19NSVBJX01VWF9DVExfU0hJ
RlQpOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9lbmNvZGVyX2Z1bmNzIGlteF9taXBp
X2RzaV9lbmNvZGVyX2Z1bmNzID0geworCS5kZXN0cm95ID0gaW14X2RybV9lbmNvZGVyX2Rlc3Ry
b3ksCit9OworCitzdGF0aWMgYm9vbCBpbXhfbWlwaV9kc2lfZW5jb2Rlcl9tb2RlX2ZpeHVwKHN0
cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlciwKKwkJCQkJICAgIGNvbnN0IHN0cnVjdCBkcm1fZGlz
cGxheV9tb2RlICptb2RlLAorCQkJCQkgICAgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkal9t
b2RlKQoreworCXJldHVybiB0cnVlOworfQorCitzdGF0aWMgaW50IGlteF9taXBpX2RzaV9lbmNv
ZGVyX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIsCisJCQkJCSAgICAg
c3RydWN0IGRybV9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAorCQkJCQkgICAgIHN0cnVjdCBkcm1f
Y29ubmVjdG9yX3N0YXRlICpjb25uKQoreworCXN0cnVjdCBpbXhfY3J0Y19zdGF0ZSAqaW14X2Ny
dGNfc3RhdGUgPSB0b19pbXhfY3J0Y19zdGF0ZShjcnRjX3N0YXRlKTsKKworCS8qIFRoZSBmb2xs
b3dpbmcgdmFsdWVzIGFyZSB0YWtlbiBmcm9tIGR3X2hkbWlfaW14X2F0b21pY19jaGVjayAqLwor
CWlteF9jcnRjX3N0YXRlLT5idXNfZm9ybWF0ID0gTUVESUFfQlVTX0ZNVF9SR0I4ODhfMVgyNDsK
KwlpbXhfY3J0Y19zdGF0ZS0+ZGlfaHN5bmNfcGluID0gMjsKKwlpbXhfY3J0Y19zdGF0ZS0+ZGlf
dnN5bmNfcGluID0gMzsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBpbXhfbWlwaV9k
c2lfZW5jb2Rlcl9jb21taXQoc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyKQoreworCXN0cnVj
dCBpbXhfbWlwaV9kc2kgKmRzaSA9IGVuY190b19kc2koZW5jb2Rlcik7CisJaW50IG11eCA9IGRy
bV9vZl9lbmNvZGVyX2FjdGl2ZV9wb3J0X2lkKGRzaS0+ZGV2LT5vZl9ub2RlLCBlbmNvZGVyKTsK
KworCWlteF9taXBpX2RzaV9zZXRfaXB1X2RpX211eChkc2ksIG11eCk7Cit9CisKK3N0YXRpYyB2
b2lkIGlteF9taXBpX2RzaV9lbmNvZGVyX2Rpc2FibGUoc3RydWN0IGRybV9lbmNvZGVyICplbmNv
ZGVyKQoreworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9lbmNvZGVyX2hlbHBlcl9mdW5j
cyBpbXhfbWlwaV9kc2lfZW5jb2Rlcl9oZWxwZXJzID0geworCS5tb2RlX2ZpeHVwID0gaW14X21p
cGlfZHNpX2VuY29kZXJfbW9kZV9maXh1cCwKKwkuY29tbWl0ID0gaW14X21pcGlfZHNpX2VuY29k
ZXJfY29tbWl0LAorCS5kaXNhYmxlID0gaW14X21pcGlfZHNpX2VuY29kZXJfZGlzYWJsZSwKKwku
YXRvbWljX2NoZWNrID0gaW14X21pcGlfZHNpX2VuY29kZXJfYXRvbWljX2NoZWNrLAorfTsKKwor
c3RhdGljIGludCBpbXhfbWlwaV9kc2lfcmVnaXN0ZXIoc3RydWN0IGRybV9kZXZpY2UgKmRybSwK
KwkJCQkgc3RydWN0IGlteF9taXBpX2RzaSAqZHNpKQoreworCWludCByZXQ7CisKKwlyZXQgPSBp
bXhfZHJtX2VuY29kZXJfcGFyc2Vfb2YoZHJtLCAmZHNpLT5lbmNvZGVyLCBkc2ktPmRldi0+b2Zf
bm9kZSk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCWRybV9lbmNvZGVyX2hlbHBlcl9h
ZGQoJmRzaS0+ZW5jb2RlciwKKwkJCSAgICAgICAmaW14X21pcGlfZHNpX2VuY29kZXJfaGVscGVy
cyk7CisJZHJtX2VuY29kZXJfaW5pdChkcm0sICZkc2ktPmVuY29kZXIsICZpbXhfbWlwaV9kc2lf
ZW5jb2Rlcl9mdW5jcywKKwkJCSBEUk1fTU9ERV9FTkNPREVSX0RTSSwgTlVMTCk7CisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyBlbnVtIGRybV9tb2RlX3N0YXR1cyBpbXhfbWlwaV9kc2lfbW9kZV92
YWxpZCh2b2lkICpwcml2X2RhdGEsCisJCQkJCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2Rl
ICptb2RlKQoreworCS8qCisJICogVGhlIFZJRF9QS1RfU0laRSBmaWVsZCBpbiB0aGUgRFNJX1ZJ
RF9QS1RfQ0ZHCisJICogcmVnaXN0ZXIgaXMgMTEtYml0LgorCSAqLworCWlmIChtb2RlLT5oZGlz
cGxheSA+IDB4N2ZmKQorCQlyZXR1cm4gTU9ERV9CQURfSFZBTFVFOworCisJLyoKKwkgKiBUaGUg
Vl9BQ1RJVkVfTElORVMgZmllbGQgaW4gdGhlIERTSV9WVElNSU5HX0NGRworCSAqIHJlZ2lzdGVy
IGlzIDExLWJpdC4KKwkgKi8KKwlpZiAobW9kZS0+dmRpc3BsYXkgPiAweDdmZikKKwkJcmV0dXJu
IE1PREVfQkFEX1ZWQUxVRTsKKworCXJldHVybiBNT0RFX09LOworfQorCisKK3N0YXRpYyB1bnNp
Z25lZCBpbnQgbWF4X21icHNfdG9fdGVzdGRpbih1bnNpZ25lZCBpbnQgbWF4X21icHMpCit7CisJ
dW5zaWduZWQgaW50IGk7CisKKwlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShkcHRkaW5fbWFw
KTsgaSsrKQorCQlpZiAoZHB0ZGluX21hcFtpXS5tYXhfbWJwcyA9PSBtYXhfbWJwcykKKwkJCXJl
dHVybiBkcHRkaW5fbWFwW2ldLnRlc3RkaW47CisKKwlyZXR1cm4gLUVJTlZBTDsKK30KKworc3Rh
dGljIGludCBpbXhfbWlwaV9kc2lfcGh5X2luaXQodm9pZCAqcHJpdl9kYXRhKQoreworCXN0cnVj
dCBpbXhfbWlwaV9kc2kgKmRzaSA9IHByaXZfZGF0YTsKKwlzdHJ1Y3QgcmVnbWFwICpyZWdzID0g
ZHNpLT5yZWdzOworCWludCB0ZXN0ZGluOworCisJdGVzdGRpbiA9IG1heF9tYnBzX3RvX3Rlc3Rk
aW4oZHNpLT5sYW5lX21icHMpOworCWlmICh0ZXN0ZGluIDwgMCkgeworCQlkZXZfZXJyKGRzaS0+
ZGV2LAorCQkJImZhaWxlZCB0byBnZXQgdGVzdGRpbiBmb3IgJWRtYnBzIGxhbmUgY2xvY2tcbiIs
CisJCQlkc2ktPmxhbmVfbWJwcyk7CisJCXJldHVybiB0ZXN0ZGluOworCX0KKworCXJlZ21hcF93
cml0ZShyZWdzLCBEU0lfUEhZX0lGX0NUUkwsIFBIWV9JRl9DVFJMX1JFU0VUKTsKKwlyZWdtYXBf
d3JpdGUocmVncywgRFNJX1BXUl9VUCwgUE9XRVJVUCk7CisKKwlyZWdtYXBfd3JpdGUocmVncywg
RFNJX1BIWV9UU1RfQ1RSTDAsIFBIWV9VTlRFU1RDTEsgfCBQSFlfVU5URVNUQ0xSKTsKKwlyZWdt
YXBfd3JpdGUocmVncywgRFNJX1BIWV9UU1RfQ1RSTDEsIFBIWV9URVNURU4gfCBQSFlfVEVTVERP
VVQoMCkgfAorCQkgICAgIFBIWV9URVNURElOKDB4NDQpKTsKKwlyZWdtYXBfd3JpdGUocmVncywg
RFNJX1BIWV9UU1RfQ1RSTDAsIFBIWV9URVNUQ0xLIHwgUEhZX1VOVEVTVENMUik7CisJcmVnbWFw
X3dyaXRlKHJlZ3MsIERTSV9QSFlfVFNUX0NUUkwwLCBQSFlfVU5URVNUQ0xLIHwgUEhZX1VOVEVT
VENMUik7CisJcmVnbWFwX3dyaXRlKHJlZ3MsIERTSV9QSFlfVFNUX0NUUkwxLCBQSFlfVU5URVNU
RU4gfCBQSFlfVEVTVERPVVQoMCkgfAorCQkgICAgIFBIWV9URVNURElOKHRlc3RkaW4pKTsKKwly
ZWdtYXBfd3JpdGUocmVncywgRFNJX1BIWV9UU1RfQ1RSTDAsIFBIWV9URVNUQ0xLIHwgUEhZX1VO
VEVTVENMUik7CisJcmVnbWFwX3dyaXRlKHJlZ3MsIERTSV9QSFlfVFNUX0NUUkwwLCBQSFlfVU5U
RVNUQ0xLIHwgUEhZX1VOVEVTVENMUik7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBp
bXhfbWlwaV9kc2lfZ2V0X2xhbmVfbWJwcyh2b2lkICpwcml2X2RhdGEsCisJCQkJICAgICAgY29u
c3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUsCisJCQkJICAgICAgdW5zaWduZWQgbG9u
ZyBtb2RlX2ZsYWdzLCB1MzIgbGFuZXMsCisJCQkJICAgICAgdTMyIGZvcm1hdCwgdW5zaWduZWQg
aW50ICpsYW5lX21icHMpCit7CisJc3RydWN0IGlteF9taXBpX2RzaSAqZHNpID0gcHJpdl9kYXRh
OworCWludCBicHA7CisJdW5zaWduZWQgaW50IGksIHRhcmdldF9tYnBzLCBtcGNsazsKKwl1bnNp
Z25lZCBsb25nIHBsbHJlZjsKKworCWJwcCA9IG1pcGlfZHNpX3BpeGVsX2Zvcm1hdF90b19icHAo
Zm9ybWF0KTsKKwlpZiAoYnBwIDwgMCkgeworCQlkZXZfZXJyKGRzaS0+ZGV2LCAiZmFpbGVkIHRv
IGdldCBicHAgZm9yIHBpeGVsIGZvcm1hdCAlZFxuIiwKKwkJCWZvcm1hdCk7CisJCXJldHVybiBi
cHA7CisJfQorCisJcGxscmVmID0gY2xrX2dldF9yYXRlKGRzaS0+cGxscmVmX2Nsayk7CisJaWYg
KHBsbHJlZiAhPSAyNzAwMDAwMCkKKwkJZGV2X3dhcm4oZHNpLT5kZXYsICJleHBlY3QgMjdNSHog
RFBIWSBwbGwgcmVmZXJlbmNlIGNsb2NrXG4iKTsKKworCW1wY2xrID0gRElWX1JPVU5EX1VQKG1v
ZGUtPmNsb2NrLCBNU0VDX1BFUl9TRUMpOworCWlmIChtcGNsaykgeworCQkvKiB0YWtlIDEvMC43
IGJsYW5raW5nIG92ZXJoZWFkIGludG8gY29uc2lkZXJhdGlvbiAqLworCQl0YXJnZXRfbWJwcyA9
IChtcGNsayAqIChicHAgLyBsYW5lcykgKiAxMCkgLyA3OworCX0gZWxzZSB7CisJCWRldl9kYmco
ZHNpLT5kZXYsICJ1c2UgZGVmYXVsdCAxR2JwcyBEUEhZIHBsbCBjbG9ja1xuIik7CisJCXRhcmdl
dF9tYnBzID0gMTAwMDsKKwl9CisKKwlkZXZfZGJnKGRzaS0+ZGV2LCAidGFyZ2V0IERQSFkgcGxs
IGNsb2NrIGZyZXF1ZW5jeSBpcyAldU1icHNcbiIsCisJCXRhcmdldF9tYnBzKTsKKworCWZvciAo
aSA9IDA7IGkgPCBBUlJBWV9TSVpFKGRwdGRpbl9tYXApOyBpKyspIHsKKwkJaWYgKHRhcmdldF9t
YnBzIDwgZHB0ZGluX21hcFtpXS5tYXhfbWJwcykgeworCQkJKmxhbmVfbWJwcyA9IGRwdGRpbl9t
YXBbaV0ubWF4X21icHM7CisJCQlkc2ktPmxhbmVfbWJwcyA9ICpsYW5lX21icHM7CisJCQlkZXZf
ZGJnKGRzaS0+ZGV2LAorCQkJCSJyZWFsIERQSFkgcGxsIGNsb2NrIGZyZXF1ZW5jeSBpcyAldU1i
cHNcbiIsCisJCQkJKmxhbmVfbWJwcyk7CisJCQlyZXR1cm4gMDsKKwkJfQorCX0KKworCWRldl9l
cnIoZHNpLT5kZXYsICJEUEhZIGNsb2NrIGZyZXF1ZW5jeSAldU1icHMgaXMgb3V0IG9mIHJhbmdl
XG4iLAorCQl0YXJnZXRfbWJwcyk7CisKKwlyZXR1cm4gLUVJTlZBTDsKK30KKworc3RhdGljIGNv
bnN0IHN0cnVjdCBkd19taXBpX2RzaV9waHlfb3BzIGR3X21pcGlfZHNpX3N0bV9waHlfb3BzID0g
eworCS5pbml0ID0gaW14X21pcGlfZHNpX3BoeV9pbml0LAorCS5nZXRfbGFuZV9tYnBzID0gaW14
X21pcGlfZHNpX2dldF9sYW5lX21icHMsCit9OworCitzdGF0aWMgc3RydWN0IGR3X21pcGlfZHNp
X3BsYXRfZGF0YSBpbXg2cV9taXBpX2RzaV9kcnZfZGF0YSA9IHsKKwkubWF4X2RhdGFfbGFuZXMg
PSAyLAorCS5tb2RlX3ZhbGlkID0gaW14X21pcGlfZHNpX21vZGVfdmFsaWQsCisJLnBoeV9vcHMg
PSAmZHdfbWlwaV9kc2lfc3RtX3BoeV9vcHMsCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IG9m
X2RldmljZV9pZCBpbXhfZHNpX2R0X2lkc1tdID0geworCXsKKwkJLmNvbXBhdGlibGUgPSAiZnNs
LGlteDZxLW1pcGktZHNpIiwKKwkJLmRhdGEgPSAmaW14NnFfbWlwaV9kc2lfZHJ2X2RhdGEsCisJ
fSwKKwl7IC8qIHNlbnRpbmVsICovIH0KK307CitNT0RVTEVfREVWSUNFX1RBQkxFKG9mLCBpbXhf
ZHNpX2R0X2lkcyk7CisKK3N0YXRpYyBpbnQgaW14X21pcGlfZHNpX2JpbmQoc3RydWN0IGRldmlj
ZSAqZGV2LCBzdHJ1Y3QgZGV2aWNlICptYXN0ZXIsCisJCQkgICAgIHZvaWQgKmRhdGEpCit7CisJ
c3RydWN0IGlteF9taXBpX2RzaSAqZHNpID0gZGV2X2dldF9kcnZkYXRhKGRldik7CisJc3RydWN0
IGRybV9kZXZpY2UgKmRybSA9IGRhdGE7CisJaW50IHJldDsKKworCXJldCA9IGlteF9taXBpX2Rz
aV9yZWdpc3Rlcihkcm0sIGRzaSk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCXJldCA9
IGR3X21pcGlfZHNpX2JpbmQoZHNpLT5taXBpX2RzaSwgJmRzaS0+ZW5jb2Rlcik7CisJaWYgKHJl
dCkKKwkJcmV0dXJuIHJldDsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBpbXhfbWlw
aV9kc2lfdW5iaW5kKHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRldmljZSAqbWFzdGVyLAor
CQkJCXZvaWQgKmRhdGEpCit7CisJc3RydWN0IGlteF9taXBpX2RzaSAqZHNpID0gZGV2X2dldF9k
cnZkYXRhKGRldik7CisKKwlyZXR1cm4gZHdfbWlwaV9kc2lfdW5iaW5kKGRzaS0+bWlwaV9kc2kp
OworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGNvbXBvbmVudF9vcHMgaW14X21pcGlfZHNpX29w
cyA9IHsKKwkuYmluZAk9IGlteF9taXBpX2RzaV9iaW5kLAorCS51bmJpbmQJPSBpbXhfbWlwaV9k
c2lfdW5iaW5kLAorfTsKKworc3RhdGljIGludCBpbXhfbWlwaV9kc2lfcHJvYmUoc3RydWN0IHBs
YXRmb3JtX2RldmljZSAqcGRldikKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmcGRldi0+ZGV2
OworCWNvbnN0IHN0cnVjdCBvZl9kZXZpY2VfaWQgKm9mX2lkID0gb2ZfbWF0Y2hfZGV2aWNlKGlt
eF9kc2lfZHRfaWRzLCBkZXYpOworCWNvbnN0IHN0cnVjdCBkd19taXBpX2RzaV9wbGF0X2RhdGEg
KnBkYXRhID0gb2ZfaWQtPmRhdGE7CisJc3RydWN0IGlteF9taXBpX2RzaSAqZHNpOworCWludCBy
ZXQ7CisKKwlkc2kgPSBkZXZtX2t6YWxsb2MoZGV2LCBzaXplb2YoKmRzaSksIEdGUF9LRVJORUwp
OworCWlmICghZHNpKQorCQlyZXR1cm4gLUVOT01FTTsKKworCWRzaS0+ZGV2ID0gZGV2OworCisJ
ZHNpLT5wbGxyZWZfY2xrID0gZGV2bV9jbGtfZ2V0KGRldiwgInJlZiIpOworCWlmIChJU19FUlIo
ZHNpLT5wbGxyZWZfY2xrKSkgeworCQlyZXQgPSBQVFJfRVJSKGRzaS0+cGxscmVmX2Nsayk7CisJ
CWRldl9kYmcoZGV2LCAiJXM6IFVuYWJsZSB0byBnZXQgcGxsIHJlZmVyZW5jZSBjbG9jazogJWRc
biIsCisJCQlfX2Z1bmNfXywgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXQgPSBjbGtf
cHJlcGFyZV9lbmFibGUoZHNpLT5wbGxyZWZfY2xrKTsKKwlpZiAocmV0KSB7CisJCWRldl9lcnIo
ZGV2LCAiJXM6IEZhaWxlZCB0byBlbmFibGUgcGxscmVmX2Nsa1xuIiwgX19mdW5jX18pOworCQly
ZXR1cm4gcmV0OworCX0KKworCWRzaS0+bXV4X3NlbCA9IHN5c2Nvbl9yZWdtYXBfbG9va3VwX2J5
X3BoYW5kbGUoZGV2LT5vZl9ub2RlLCAiZ3ByIik7CisJaWYgKElTX0VSUihkc2ktPm11eF9zZWwp
KSB7CisJCXJldCA9IFBUUl9FUlIoZHNpLT5tdXhfc2VsKTsKKwkJZGV2X2VycihkZXYsICIlczog
RmFpbGVkIHRvIGdldCBHUFIgcmVnbWFwOiAlZFxuIiwKKwkJCV9fZnVuY19fLCByZXQpOworCQly
ZXR1cm4gcmV0OworCX0KKworCWRldl9zZXRfZHJ2ZGF0YShkZXYsIGRzaSk7CisKKwlpbXg2cV9t
aXBpX2RzaV9kcnZfZGF0YS5wcml2X2RhdGEgPSBkc2k7CisKKwlkc2ktPm1pcGlfZHNpID0gZHdf
bWlwaV9kc2lfcHJvYmUocGRldiwgcGRhdGEpOworCWlmIChJU19FUlIoZHNpLT5taXBpX2RzaSkp
IHsKKwkJcmV0ID0gUFRSX0VSUihkc2ktPm1pcGlfZHNpKTsKKwkJZGV2X2RiZyhkZXYsICIlczog
VW5hYmxlIHRvIHByb2JlIERXIERTSSBob3N0IGRldmljZTogJWRcbiIsCisJCQlfX2Z1bmNfXywg
cmV0KTsKKwkJcmV0dXJuIC1FTk9ERVY7CisJfQorCisJZHNpLT5yZWdzID0gcGRhdGEtPnJlZ3M7
CisKKwlyZXR1cm4gY29tcG9uZW50X2FkZCgmcGRldi0+ZGV2LCAmaW14X21pcGlfZHNpX29wcyk7
Cit9CisKK3N0YXRpYyBpbnQgaW14X21pcGlfZHNpX3JlbW92ZShzdHJ1Y3QgcGxhdGZvcm1fZGV2
aWNlICpwZGV2KQoreworCWNvbXBvbmVudF9kZWwoJnBkZXYtPmRldiwgJmlteF9taXBpX2RzaV9v
cHMpOworCXJldHVybiAwOworfQorCitzdGF0aWMgc3RydWN0IHBsYXRmb3JtX2RyaXZlciBpbXhf
bWlwaV9kc2lfZHJpdmVyID0geworCS5wcm9iZQkJPSBpbXhfbWlwaV9kc2lfcHJvYmUsCisJLnJl
bW92ZQkJPSBpbXhfbWlwaV9kc2lfcmVtb3ZlLAorCS5kcml2ZXIJCT0geworCQkub2ZfbWF0Y2hf
dGFibGUgPSBpbXhfZHNpX2R0X2lkcywKKwkJLm5hbWUJPSBEUklWRVJfTkFNRSwKKwl9LAorfTsK
K21vZHVsZV9wbGF0Zm9ybV9kcml2ZXIoaW14X21pcGlfZHNpX2RyaXZlcik7CisKK01PRFVMRV9E
RVNDUklQVElPTigiaS5NWCBNSVBJIERTSSBob3N0IGNvbnRyb2xsZXIgZHJpdmVyIik7CitNT0RV
TEVfQVVUSE9SKCJMaXUgWWluZyA8WWluZy5MaXVAZnJlZXNjYWxlLmNvbT4iKTsKK01PRFVMRV9M
SUNFTlNFKCJHUEwiKTsKK01PRFVMRV9BTElBUygicGxhdGZvcm06IiBEUklWRVJfTkFNRSk7Ci0t
IAoyLjI0LjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
CmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpo
dHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
