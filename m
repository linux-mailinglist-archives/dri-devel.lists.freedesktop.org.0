Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id B97E3153817
	for <lists+dri-devel@lfdr.de>; Wed,  5 Feb 2020 19:24:48 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9A4176F91D;
	Wed,  5 Feb 2020 18:24:44 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from metis.ext.pengutronix.de (metis.ext.pengutronix.de
 [IPv6:2001:67c:670:201:290:27ff:fe1d:cc33])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 671946F91D
 for <dri-devel@lists.freedesktop.org>; Wed,  5 Feb 2020 18:24:43 +0000 (UTC)
Received: from kresse.hi.pengutronix.de ([2001:67c:670:100:1d::2a])
 by metis.ext.pengutronix.de with esmtp (Exim 4.92)
 (envelope-from <l.stach@pengutronix.de>)
 id 1izPLq-0000H9-4l; Wed, 05 Feb 2020 19:24:38 +0100
Message-ID: <0de5ad33ca2ff86fee13a453aa9096c274afbd3c.camel@pengutronix.de>
Subject: Re: [PATCH v4] drm/scheduler: Avoid accessing freed bad job.
From: Lucas Stach <l.stach@pengutronix.de>
To: Andrey Grodzovsky <andrey.grodzovsky@amd.com>
Date: Wed, 05 Feb 2020 19:24:37 +0100
In-Reply-To: <1574715089-14875-1-git-send-email-andrey.grodzovsky@amd.com>
References: <1574715089-14875-1-git-send-email-andrey.grodzovsky@amd.com>
User-Agent: Evolution 3.30.5-1.1 
MIME-Version: 1.0
X-SA-Exim-Connect-IP: 2001:67c:670:100:1d::2a
X-SA-Exim-Mail-From: l.stach@pengutronix.de
X-SA-Exim-Scanned: No (on metis.ext.pengutronix.de);
 SAEximRunCond expanded to false
X-PTX-Original-Recipient: dri-devel@lists.freedesktop.org
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Emily.Deng@amd.com, Christian.Koenig@amd.com,
 dri-devel@lists.freedesktop.org, amd-gfx@lists.freedesktop.org,
 steven.price@arm.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SGkgQW5kcmV5LAoKVGhpcyBjb21taXQgYnJlYWtzIGFsbCBkcml2ZXJzLCB3aGljaCBtYXkgYmFp
bCBvdXQgb2YgdGhlIHRpbWVvdXQKcHJvY2Vzc2luZyBhcyB0aGV5IHdpc2ggdG8gZXh0ZW5kIHRo
ZSB0aW1lb3V0IChldG5hdml2LCB2M2QpLgoKVGhvc2UgZHJpdmVycyBjdXJyZW50bHkganVzdCBy
ZXR1cm4gZnJvbSB0aGUgdGltZW91dCBoYW5kbGVyIGJlZm9yZQpjYWxsaW5nIGRybV9zY2hlZF9z
dG9wKCksIHdoaWNoIG1lYW5zIHdpdGggdGhpcyBjb21taXQgYXBwbGllZCB3ZSBhcmUKcmVtb3Zp
bmcgdGhlIGZpcnN0IGpvYiBmcm9tIHRoZSByaW5nX21pcnJvcl9saXN0LCBidXQgbmV2ZXIgcHV0
IGl0CmJhY2suIFRoaXMgbGVhZHMgdG8gam9icyBnZXR0aW5nIGxvc3QgZnJvbSB0aGUgcmluZyBt
aXJyb3IsIHdoaWNoIHRoZW4KY2F1c2VzIHF1aXRlIGEgYml0IG9mIGZhbGxvdXQgbGlrZSB1bnNp
Z25hbGVkIGZlbmNlcy4KCk5vdCBzdXJlIHlldCB3aGF0IHRvIGRvIGFib3V0IGl0LCB3ZSBjYW4g
ZWl0aGVyIGFkZCBhIGZ1bmN0aW9uIHRvIGFkZAp0aGUgam9iIGJhY2sgdG8gdGhlIHJpbmdfbWly
cm9yIGlmIHRoZSBkcml2ZXIgd2FudHMgdG8gZXh0ZW5kIHRoZQp0aW1lb3V0LCBvciB3ZSBjb3Vs
ZCBsb29rIGZvciBhbm90aGVyIHdheSB0byBzdG9wCmRybV9zY2hlZF9jbGVhbnVwX2pvYnMgZnJv
bSBmcmVlaW5nIGpvYnMgdGhhdCBhcmUgY3VycmVudGx5IGluIHRpbWVvdXQKcHJvY2Vzc2luZy4K
ClJlZ2FyZHMsCkx1Y2FzCgpPbiBNbywgMjAxOS0xMS0yNSBhdCAxNTo1MSAtMDUwMCwgQW5kcmV5
IEdyb2R6b3Zza3kgd3JvdGU6Cj4gUHJvYmxlbToKPiBEdWUgdG8gYSByYWNlIGJldHdlZW4gZHJt
X3NjaGVkX2NsZWFudXBfam9icyBpbiBzY2hlZCB0aHJlYWQgYW5kCj4gZHJtX3NjaGVkX2pvYl90
aW1lZG91dCBpbiB0aW1lb3V0IHdvcmsgdGhlcmUgaXMgYSBwb3NzaWJsaXR5IHRoYXQKPiBiYWQg
am9iIHdhcyBhbHJlYWR5IGZyZWVkIHdoaWxlIHN0aWxsIGJlaW5nIGFjY2Vzc2VkIGZyb20gdGhl
Cj4gdGltZW91dCB0aHJlYWQuCj4gCj4gRml4Ogo+IEluc3RlYWQgb2YganVzdCBwZWVraW5nIGF0
IHRoZSBiYWQgam9iIGluIHRoZSBtaXJyb3IgbGlzdAo+IHJlbW92ZSBpdCBmcm9tIHRoZSBsaXN0
IHVuZGVyIGxvY2sgYW5kIHRoZW4gcHV0IGl0IGJhY2sgbGF0ZXIgd2hlbgo+IHdlIGFyZSBnYXJh
bnRlZWQgbm8gcmFjZSB3aXRoIG1haW4gc2NoZWQgdGhyZWFkIGlzIHBvc3NpYmxlIHdoaWNoCj4g
aXMgYWZ0ZXIgdGhlIHRocmVhZCBpcyBwYXJrZWQuCj4gCj4gdjI6IExvY2sgYXJvdW5kIHByb2Nl
c3NpbmcgcmluZ19taXJyb3JfbGlzdCBpbiBkcm1fc2NoZWRfY2xlYW51cF9qb2JzLgo+IAo+IHYz
OiBSZWJhc2Ugb24gdG9wIG9mIGRybS1taXNjLW5leHQuIHYyIGlzIG5vdCBuZWVkZWQgYW55bW9y
ZSBhcwo+IGRybV9zY2hlZF9nZXRfY2xlYW51cF9qb2IgYWxyZWFkeSBoYXMgYSBsb2NrIHRoZXJl
Lgo+IAo+IHY0OiBGaXggY29tbWVudHMgdG8gcmVsZmVjdCBsYXRlc3QgY29kZSBpbiBkcm0tbWlz
Yy4KPiAKPiBTaWduZWQtb2ZmLWJ5OiBBbmRyZXkgR3JvZHpvdnNreSA8YW5kcmV5Lmdyb2R6b3Zz
a3lAYW1kLmNvbT4KPiBSZXZpZXdlZC1ieTogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0aWFuLmtv
ZW5pZ0BhbWQuY29tPgo+IFRlc3RlZC1ieTogRW1pbHkgRGVuZyA8RW1pbHkuRGVuZ0BhbWQuY29t
Pgo+IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vc2NoZWR1bGVyL3NjaGVkX21haW4uYyB8IDI3ICsr
KysrKysrKysrKysrKysrKysrKysrKysrKwo+ICAxIGZpbGUgY2hhbmdlZCwgMjcgaW5zZXJ0aW9u
cygrKQo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vc2NoZWR1bGVyL3NjaGVkX21h
aW4uYyBiL2RyaXZlcnMvZ3B1L2RybS9zY2hlZHVsZXIvc2NoZWRfbWFpbi5jCj4gaW5kZXggNjc3
NDk1NS4uMWJmOWM0MCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vc2NoZWR1bGVyL3Nj
aGVkX21haW4uYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9zY2hlZHVsZXIvc2NoZWRfbWFpbi5j
Cj4gQEAgLTI4NCwxMCArMjg0LDIxIEBAIHN0YXRpYyB2b2lkIGRybV9zY2hlZF9qb2JfdGltZWRv
dXQoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAJdW5zaWduZWQgbG9uZyBmbGFnczsKPiAg
Cj4gIAlzY2hlZCA9IGNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3QgZHJtX2dwdV9zY2hlZHVsZXIs
IHdvcmtfdGRyLndvcmspOwo+ICsKPiArCS8qIFByb3RlY3RzIGFnYWluc3QgY29uY3VycmVudCBk
ZWxldGlvbiBpbiBkcm1fc2NoZWRfZ2V0X2NsZWFudXBfam9iICovCj4gKwlzcGluX2xvY2tfaXJx
c2F2ZSgmc2NoZWQtPmpvYl9saXN0X2xvY2ssIGZsYWdzKTsKPiAgCWpvYiA9IGxpc3RfZmlyc3Rf
ZW50cnlfb3JfbnVsbCgmc2NoZWQtPnJpbmdfbWlycm9yX2xpc3QsCj4gIAkJCQkgICAgICAgc3Ry
dWN0IGRybV9zY2hlZF9qb2IsIG5vZGUpOwo+ICAKPiAgCWlmIChqb2IpIHsKPiArCQkvKgo+ICsJ
CSAqIFJlbW92ZSB0aGUgYmFkIGpvYiBzbyBpdCBjYW5ub3QgYmUgZnJlZWQgYnkgY29uY3VycmVu
dAo+ICsJCSAqIGRybV9zY2hlZF9jbGVhbnVwX2pvYnMuIEl0IHdpbGwgYmUgcmVpbnNlcnRlZCBi
YWNrIGFmdGVyIHNjaGVkLT50aHJlYWQKPiArCQkgKiBpcyBwYXJrZWQgYXQgd2hpY2ggcG9pbnQg
aXQncyBzYWZlLgo+ICsJCSAqLwo+ICsJCWxpc3RfZGVsX2luaXQoJmpvYi0+bm9kZSk7Cj4gKwkJ
c3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmc2NoZWQtPmpvYl9saXN0X2xvY2ssIGZsYWdzKTsKPiAr
Cj4gIAkJam9iLT5zY2hlZC0+b3BzLT50aW1lZG91dF9qb2Ioam9iKTsKPiAgCj4gIAkJLyoKPiBA
QCAtMjk4LDYgKzMwOSw4IEBAIHN0YXRpYyB2b2lkIGRybV9zY2hlZF9qb2JfdGltZWRvdXQoc3Ry
dWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAJCQlqb2ItPnNjaGVkLT5vcHMtPmZyZWVfam9iKGpv
Yik7Cj4gIAkJCXNjaGVkLT5mcmVlX2d1aWx0eSA9IGZhbHNlOwo+ICAJCX0KPiArCX0gZWxzZSB7
Cj4gKwkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmc2NoZWQtPmpvYl9saXN0X2xvY2ssIGZsYWdz
KTsKPiAgCX0KPiAgCj4gIAlzcGluX2xvY2tfaXJxc2F2ZSgmc2NoZWQtPmpvYl9saXN0X2xvY2ss
IGZsYWdzKTsKPiBAQCAtMzcwLDYgKzM4MywyMCBAQCB2b2lkIGRybV9zY2hlZF9zdG9wKHN0cnVj
dCBkcm1fZ3B1X3NjaGVkdWxlciAqc2NoZWQsIHN0cnVjdCBkcm1fc2NoZWRfam9iICpiYWQpCj4g
IAlrdGhyZWFkX3Bhcmsoc2NoZWQtPnRocmVhZCk7Cj4gIAo+ICAJLyoKPiArCSAqIFJlaW5zZXJ0
IGJhY2sgdGhlIGJhZCBqb2IgaGVyZSAtIG5vdyBpdCdzIHNhZmUgYXMKPiArCSAqIGRybV9zY2hl
ZF9nZXRfY2xlYW51cF9qb2IgY2Fubm90IHJhY2UgYWdhaW5zdCB1cyBhbmQgcmVsZWFzZSB0aGUK
PiArCSAqIGJhZCBqb2IgYXQgdGhpcyBwb2ludCAtIHdlIHBhcmtlZCAod2FpdGVkIGZvcikgYW55
IGluIHByb2dyZXNzCj4gKwkgKiAoZWFybGllcikgY2xlYW51cHMgYW5kIGRybV9zY2hlZF9nZXRf
Y2xlYW51cF9qb2Igd2lsbCBub3QgYmUgY2FsbGVkCj4gKwkgKiBub3cgdW50aWwgdGhlIHNjaGVk
dWxlciB0aHJlYWQgaXMgdW5wYXJrZWQuCj4gKwkgKi8KPiArCWlmIChiYWQgJiYgYmFkLT5zY2hl
ZCA9PSBzY2hlZCkKPiArCQkvKgo+ICsJCSAqIEFkZCBhdCB0aGUgaGVhZCBvZiB0aGUgcXVldWUg
dG8gcmVmbGVjdCBpdCB3YXMgdGhlIGVhcmxpZXN0Cj4gKwkJICogam9iIGV4dHJhY3RlZC4KPiAr
CQkgKi8KPiArCQlsaXN0X2FkZCgmYmFkLT5ub2RlLCAmc2NoZWQtPnJpbmdfbWlycm9yX2xpc3Qp
Owo+ICsKPiArCS8qCj4gIAkgKiBJdGVyYXRlIHRoZSBqb2IgbGlzdCBmcm9tIGxhdGVyIHRvICBl
YXJsaWVyIG9uZSBhbmQgZWl0aGVyIGRlYWN0aXZlCj4gIAkgKiB0aGVpciBIVyBjYWxsYmFja3Mg
b3IgcmVtb3ZlIHRoZW0gZnJvbSBtaXJyb3IgbGlzdCBpZiB0aGV5IGFscmVhZHkKPiAgCSAqIHNp
Z25hbGVkLgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18K
ZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0
dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVsCg==
