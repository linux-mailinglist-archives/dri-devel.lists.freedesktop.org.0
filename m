Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id A177EDCE48
	for <lists+dri-devel@lfdr.de>; Fri, 18 Oct 2019 20:39:12 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3067D6EBC2;
	Fri, 18 Oct 2019 18:37:54 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from smtp.codeaurora.org (smtp.codeaurora.org [198.145.29.96])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9EEB389B96
 for <dri-devel@lists.freedesktop.org>; Fri, 18 Oct 2019 12:34:35 +0000 (UTC)
Received: by smtp.codeaurora.org (Postfix, from userid 1000)
 id 18A19612C6; Fri, 18 Oct 2019 12:34:31 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on
 pdx-caf-mail.web.codeaurora.org
X-Spam-Level: 
X-Spam-Status: No, score=-2.7 required=2.0 tests=ALL_TRUSTED,BAYES_00,
 DKIM_INVALID,DKIM_SIGNED,SPF_NONE autolearn=no autolearn_force=no
 version=3.4.0
Received: from kgunda-linux.qualcomm.com
 (blr-c-bdr-fw-01_globalnat_allzones-outside.qualcomm.com [103.229.19.19])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-SHA256 (128/128 bits))
 (No client certificate requested)
 (Authenticated sender: kgunda@smtp.codeaurora.org)
 by smtp.codeaurora.org (Postfix) with ESMTPSA id D59B361273;
 Fri, 18 Oct 2019 12:34:22 +0000 (UTC)
DMARC-Filter: OpenDMARC Filter v1.3.2 smtp.codeaurora.org D59B361273
From: Kiran Gunda <kgunda@codeaurora.org>
To: bjorn.andersson@linaro.org, jingoohan1@gmail.com, lee.jones@linaro.org,
 b.zolnierkie@samsung.com, dri-devel@lists.freedesktop.org,
 daniel.thompson@linaro.org, jacek.anaszewski@gmail.com, pavel@ucw.cz,
 robh+dt@kernel.org, mark.rutland@arm.com, linux-leds@vger.kernel.org,
 devicetree@vger.kernel.org, linux-kernel@vger.kernel.org,
 Andy Gross <agross@kernel.org>, linux-arm-msm@vger.kernel.org,
 linux-fbdev@vger.kernel.org
Subject: [PATCH V8 6/6] backlight: qcom-wled: Add auto string detection logic
Date: Fri, 18 Oct 2019 18:03:29 +0530
Message-Id: <1571402009-8706-7-git-send-email-kgunda@codeaurora.org>
X-Mailer: git-send-email 1.9.1
In-Reply-To: <1571402009-8706-1-git-send-email-kgunda@codeaurora.org>
References: <1571402009-8706-1-git-send-email-kgunda@codeaurora.org>
X-Mailman-Approved-At: Fri, 18 Oct 2019 18:37:46 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=codeaurora.org; s=default; t=1571402075;
 bh=9LfF8rWL83P80bxW5adx9b4CL9hwzZ6cUe7pu2GR0n0=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=dsBEC3/RvDfi6tYRbDP8zwO07dOXvPJf2NEosyKaURydCEuhOzRXCA9JLFs//ydF3
 Sxdl6zL2bKH5F4r+7GvFWQDNq3S9dqMUE/E8dTjktkWQTp+WJbEMkunEAM+4H0EYS+
 uPe9T42+KxkSGzF+Q8Alat7u8wI5YpJD+1mNHOuQ=
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=codeaurora.org; s=default; t=1571402068;
 bh=9LfF8rWL83P80bxW5adx9b4CL9hwzZ6cUe7pu2GR0n0=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=aMaJiJPPtsBTJUkm1ziZR/Hc4aw2B2rzx/Qn1M9b8eAxNHq6iAf20KjIkmQiMxBKZ
 Lr6TIViLYlroFcARKxKrYSLBVLdcd1u2nMJZlwitHgRv8y2+otM8i8tt0MQ+umtAma
 tHC1xo/drGiejzd4BBDNTvzkbVTBIZVTdvD5BaDc=
X-Mailman-Original-Authentication-Results: pdx-caf-mail.web.codeaurora.org;
 dmarc=none (p=none dis=none)
 header.from=codeaurora.org
X-Mailman-Original-Authentication-Results: pdx-caf-mail.web.codeaurora.org;
 spf=none
 smtp.mailfrom=kgunda@codeaurora.org
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Kiran Gunda <kgunda@codeaurora.org>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIGF1dG8gc3RyaW5nIGRldGVjdGlvbiBhbGdvcml0aG0gY2hlY2tzIGlmIHRoZSBjdXJyZW50
IFdMRUQKc2luayBjb25maWd1cmF0aW9uIGlzIHZhbGlkLiBJdCB0cmllcyBlbmFibGluZyBldmVy
eSBzaW5rIGFuZApjaGVja3MgaWYgdGhlIE9WUCBmYXVsdCBpcyBvYnNlcnZlZC4gQmFzZWQgb24g
dGhpcyBpbmZvcm1hdGlvbgppdCBkZXRlY3RzIGFuZCBlbmFibGVzIHRoZSB2YWxpZCBzaW5rIGNv
bmZpZ3VyYXRpb24uCkF1dG8gY2FsaWJyYXRpb24gd2lsbCBiZSB0cmlnZ2VyZWQgd2hlbiB0aGUg
T1ZQIGZhdWx0IGludGVycnVwdHMKYXJlIHNlZW4gZnJlcXVlbnRseSB0aGVyZWJ5IGl0IHRyaWVz
IHRvIGZpeCB0aGUgc2luayBjb25maWd1cmF0aW9uLgoKVGhlIGF1dG8tZGV0ZWN0aW9uIGFsc28g
a2lja3MgaW4gd2hlbiB0aGUgY29ubmVjdGVkIExFRCBzdHJpbmcKb2YgdGhlIGRpc3BsYXktYmFj
a2xpZ2h0IG1hbGZ1bmN0aW9ucyAoYmVjYXVzZSBvZiBkYW1hZ2UpIGFuZApyZXF1aXJlcyB0aGUg
ZGFtYWdlZCBzdHJpbmcgdG8gYmUgdHVybmVkIG9mZiB0byBwcmV2ZW50IHRoZQpjb21wbGV0ZSBw
YW5lbCBhbmQvb3IgYm9hcmQgZnJvbSBiZWluZyBkYW1hZ2VkLgoKU2lnbmVkLW9mZi1ieTogS2ly
YW4gR3VuZGEgPGtndW5kYUBjb2RlYXVyb3JhLm9yZz4KLS0tCiBkcml2ZXJzL3ZpZGVvL2JhY2ts
aWdodC9xY29tLXdsZWQuYyB8IDM5OCArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
Ky0KIDEgZmlsZSBjaGFuZ2VkLCAzOTIgaW5zZXJ0aW9ucygrKSwgNiBkZWxldGlvbnMoLSkKCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL3ZpZGVvL2JhY2tsaWdodC9xY29tLXdsZWQuYyBiL2RyaXZlcnMv
dmlkZW8vYmFja2xpZ2h0L3Fjb20td2xlZC5jCmluZGV4IDY1OGIxZTAuLmIyZTY3NTQgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvdmlkZW8vYmFja2xpZ2h0L3Fjb20td2xlZC5jCisrKyBiL2RyaXZlcnMv
dmlkZW8vYmFja2xpZ2h0L3Fjb20td2xlZC5jCkBAIC0xNywxOSArMTcsMjkgQEAKICNkZWZpbmUg
V0xFRF9NQVhfU1RSSU5HUwkJCQk0CiAKICNkZWZpbmUgV0xFRF9ERUZBVUxUX0JSSUdIVE5FU1MJ
CQkJMjA0OAotCisjZGVmaW5lIFdMRURfU09GVF9TVEFSVF9ETFlfVVMJCQkJMTAwMDAKICNkZWZp
bmUgV0xFRDNfU0lOS19SRUdfQlJJR0hUX01BWAkJCTB4RkZGCiAKIC8qIFdMRUQzL1dMRUQ0IGNv
bnRyb2wgcmVnaXN0ZXJzICovCisjZGVmaW5lIFdMRUQzX0NUUkxfUkVHX0ZBVUxUX1NUQVRVUwkJ
CTB4MDgKKyNkZWZpbmUgIFdMRUQzX0NUUkxfUkVHX0lMSU1fRkFVTFRfQklUCQkJQklUKDApCisj
ZGVmaW5lICBXTEVEM19DVFJMX1JFR19PVlBfRkFVTFRfQklUCQkJQklUKDEpCisjZGVmaW5lICBX
TEVENF9DVFJMX1JFR19TQ19GQVVMVF9CSVQJCQlCSVQoMikKKworI2RlZmluZSBXTEVEM19DVFJM
X1JFR19JTlRfUlRfU1RTCQkJMHgxMAorI2RlZmluZSAgV0xFRDNfQ1RSTF9SRUdfT1ZQX0ZBVUxU
X1NUQVRVUwkJQklUKDEpCisKICNkZWZpbmUgV0xFRDNfQ1RSTF9SRUdfTU9EX0VOCQkJCTB4NDYK
ICNkZWZpbmUgIFdMRUQzX0NUUkxfUkVHX01PRF9FTl9NQVNLCQkJQklUKDcpCiAjZGVmaW5lICBX
TEVEM19DVFJMX1JFR19NT0RfRU5fU0hJRlQJCQk3CiAKKyNkZWZpbmUgV0xFRDNfQ1RSTF9SRUdf
RkVFREJBQ0tfQ09OVFJPTAkJCTB4NDgKKwogI2RlZmluZSBXTEVEM19DVFJMX1JFR19GUkVRCQkJ
CTB4NGMKICNkZWZpbmUgIFdMRUQzX0NUUkxfUkVHX0ZSRVFfTUFTSwkJCUdFTk1BU0soMywgMCkK
IAogI2RlZmluZSBXTEVEM19DVFJMX1JFR19PVlAJCQkJMHg0ZAotI2RlZmluZSAgV0xFRDNfQ1RS
TF9SRUdfT1ZQX01BU0sJCQkJR0VOTUFTSygxLCAwKQorI2RlZmluZSAgV0xFRDNfQ1RSTF9SRUdf
T1ZQX01BU0sJCQlHRU5NQVNLKDEsIDApCiAKICNkZWZpbmUgV0xFRDNfQ1RSTF9SRUdfSUxJTUlU
CQkJCTB4NGUKICNkZWZpbmUgIFdMRUQzX0NUUkxfUkVHX0lMSU1JVF9NQVNLCQkJR0VOTUFTSygy
LCAwKQpAQCAtMTE5LDYgKzEyOSw3IEBAIHN0cnVjdCB3bGVkX2NvbmZpZyB7CiAJYm9vbCBleHRf
Z2VuOwogCWJvb2wgY2FiYzsKIAlib29sIGV4dGVybmFsX3BmZXQ7CisJYm9vbCBhdXRvX2RldGVj
dGlvbl9lbmFibGVkOwogfTsKIAogc3RydWN0IHdsZWQgewpAQCAtMTI3LDE3ICsxMzgsMjIgQEAg
c3RydWN0IHdsZWQgewogCXN0cnVjdCByZWdtYXAgKnJlZ21hcDsKIAlzdHJ1Y3QgbXV0ZXggbG9j
azsJLyogTG9jayB0byBhdm9pZCByYWNlIGZyb20gdGhyZWFkIGlycSBoYW5kbGVyICovCiAJa3Rp
bWVfdCBsYXN0X3Nob3J0X2V2ZW50OworCWt0aW1lX3Qgc3RhcnRfb3ZwX2ZhdWx0X3RpbWU7CiAJ
dTE2IGN0cmxfYWRkcjsKIAl1MTYgc2lua19hZGRyOwogCXUxNiBtYXhfc3RyaW5nX2NvdW50Owor
CXUxNiBhdXRvX2RldGVjdGlvbl9vdnBfY291bnQ7CiAJdTMyIGJyaWdodG5lc3M7CiAJdTMyIG1h
eF9icmlnaHRuZXNzOwogCXUzMiBzaG9ydF9jb3VudDsKKwl1MzIgYXV0b19kZXRlY3RfY291bnQ7
CiAJYm9vbCBkaXNhYmxlZF9ieV9zaG9ydDsKIAlib29sIGhhc19zaG9ydF9kZXRlY3Q7CiAJaW50
IHNob3J0X2lycTsKKwlpbnQgb3ZwX2lycTsKIAogCXN0cnVjdCB3bGVkX2NvbmZpZyBjZmc7CisJ
c3RydWN0IGRlbGF5ZWRfd29yayBvdnBfd29yazsKIAlpbnQgKCp3bGVkX3NldF9icmlnaHRuZXNz
KShzdHJ1Y3Qgd2xlZCAqd2xlZCwgdTE2IGJyaWdodG5lc3MpOwogfTsKIApAQCAtMTgyLDYgKzE5
OCwxMyBAQCBzdGF0aWMgaW50IHdsZWQ0X3NldF9icmlnaHRuZXNzKHN0cnVjdCB3bGVkICp3bGVk
LCB1MTYgYnJpZ2h0bmVzcykKIAlyZXR1cm4gMDsKIH0KIAorc3RhdGljIHZvaWQgd2xlZF9vdnBf
d29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCit7CisJc3RydWN0IHdsZWQgKndsZWQgPSBj
b250YWluZXJfb2Yod29yaywKKwkJCQkJIHN0cnVjdCB3bGVkLCBvdnBfd29yay53b3JrKTsKKwll
bmFibGVfaXJxKHdsZWQtPm92cF9pcnEpOworfQorCiBzdGF0aWMgaW50IHdsZWRfbW9kdWxlX2Vu
YWJsZShzdHJ1Y3Qgd2xlZCAqd2xlZCwgaW50IHZhbCkKIHsKIAlpbnQgcmM7CkBAIC0xOTMsNyAr
MjE2LDIzIEBAIHN0YXRpYyBpbnQgd2xlZF9tb2R1bGVfZW5hYmxlKHN0cnVjdCB3bGVkICp3bGVk
LCBpbnQgdmFsKQogCQkJCVdMRUQzX0NUUkxfUkVHX01PRF9FTiwKIAkJCQlXTEVEM19DVFJMX1JF
R19NT0RfRU5fTUFTSywKIAkJCQl2YWwgPDwgV0xFRDNfQ1RSTF9SRUdfTU9EX0VOX1NISUZUKTsK
LQlyZXR1cm4gcmM7CisJaWYgKHJjIDwgMCkKKwkJcmV0dXJuIHJjOworCisJaWYgKHdsZWQtPm92
cF9pcnEgPiAwKSB7CisJCWlmICh2YWwpIHsKKwkJCS8qCisJCQkgKiBXYWl0IGZvciBhdCBsZWFz
dCAxMG1zIGJlZm9yZSBlbmFibGluZyBPVlAgaW50ZXJydXB0CisJCQkgKiBhZnRlciBtb2R1bGUg
ZW5hYmxlIHNvIHRoYXQgc29mdCBzdGFydCBpcyBjb21wbGV0ZWQuCisJCQkgKi8KKwkJCXNjaGVk
dWxlX2RlbGF5ZWRfd29yaygmd2xlZC0+b3ZwX3dvcmssIEhaIC8gMTAwKTsKKwkJfSBlbHNlIHsK
KwkJCWlmICghY2FuY2VsX2RlbGF5ZWRfd29ya19zeW5jKCZ3bGVkLT5vdnBfd29yaykpCisJCQkJ
ZGlzYWJsZV9pcnEod2xlZC0+b3ZwX2lycSk7CisJCX0KKwl9CisKKwlyZXR1cm4gMDsKIH0KIAog
c3RhdGljIGludCB3bGVkX3N5bmNfdG9nZ2xlKHN0cnVjdCB3bGVkICp3bGVkKQpAQCAtMzAwLDYg
KzMzOSwzMDQgQEAgc3RhdGljIGlycXJldHVybl90IHdsZWRfc2hvcnRfaXJxX2hhbmRsZXIoaW50
IGlycSwgdm9pZCAqX3dsZWQpCiAJcmV0dXJuIElSUV9IQU5ETEVEOwogfQogCisjZGVmaW5lIEFV
VE9fREVURUNUX0JSSUdIVE5FU1MJCTIwMAorCitzdGF0aWMgdm9pZCB3bGVkX2F1dG9fc3RyaW5n
X2RldGVjdGlvbihzdHJ1Y3Qgd2xlZCAqd2xlZCkKK3sKKwlpbnQgcmMgPSAwLCBpOworCXUzMiBz
aW5rX2NvbmZpZyA9IDAsIGludF9zdHM7CisJdTggc2lua190ZXN0ID0gMCwgc2lua192YWxpZCA9
IDAsIHZhbDsKKworCS8qIFJlYWQgY29uZmlndXJlZCBzaW5rIGNvbmZpZ3VyYXRpb24gKi8KKwly
YyA9IHJlZ21hcF9yZWFkKHdsZWQtPnJlZ21hcCwgd2xlZC0+c2lua19hZGRyICsKKwkJCSBXTEVE
NF9TSU5LX1JFR19DVVJSX1NJTkssICZzaW5rX2NvbmZpZyk7CisJaWYgKHJjIDwgMCkgeworCQlk
ZXZfZXJyKHdsZWQtPmRldiwgIkZhaWxlZCB0byByZWFkIFNJTksgY29uZmlndXJhdGlvbiByYz0l
ZFxuIiwKKwkJCXJjKTsKKwkJZ290byBmYWlsZWRfZGV0ZWN0OworCX0KKworCS8qIERpc2FibGUg
dGhlIG1vZHVsZSBiZWZvcmUgc3RhcnRpbmcgZGV0ZWN0aW9uICovCisJcmMgPSByZWdtYXBfdXBk
YXRlX2JpdHMod2xlZC0+cmVnbWFwLAorCQkJCXdsZWQtPmN0cmxfYWRkciArIFdMRUQzX0NUUkxf
UkVHX01PRF9FTiwKKwkJCQlXTEVEM19DVFJMX1JFR19NT0RfRU5fTUFTSywgMCk7CisJaWYgKHJj
IDwgMCkgeworCQlkZXZfZXJyKHdsZWQtPmRldiwgIkZhaWxlZCB0byBkaXNhYmxlIFdMRUQgbW9k
dWxlIHJjPSVkXG4iLCByYyk7CisJCWdvdG8gZmFpbGVkX2RldGVjdDsKKwl9CisKKwkvKiBTZXQg
bG93IGJyaWdodG5lc3MgYWNyb3NzIGFsbCBzaW5rcyAqLworCXJjID0gd2xlZDRfc2V0X2JyaWdo
dG5lc3Mod2xlZCwgQVVUT19ERVRFQ1RfQlJJR0hUTkVTUyk7CisJaWYgKHJjIDwgMCkgeworCQlk
ZXZfZXJyKHdsZWQtPmRldiwgIkZhaWxlZCB0byBzZXQgYnJpZ2h0bmVzcyBmb3IgYXV0byBkZXRl
Y3Rpb24gcmM9JWRcbiIsCisJCQlyYyk7CisJCWdvdG8gZmFpbGVkX2RldGVjdDsKKwl9CisKKwlp
ZiAod2xlZC0+Y2ZnLmNhYmMpIHsKKwkJZm9yIChpID0gMDsgaSA8IHdsZWQtPmNmZy5udW1fc3Ry
aW5nczsgaSsrKSB7CisJCQlyYyA9IHJlZ21hcF91cGRhdGVfYml0cyh3bGVkLT5yZWdtYXAsIHds
ZWQtPnNpbmtfYWRkciArCisJCQkJCQlXTEVENF9TSU5LX1JFR19TVFJfQ0FCQyhpKSwKKwkJCQkJ
CVdMRUQ0X1NJTktfUkVHX1NUUl9DQUJDX01BU0ssCisJCQkJCQkwKTsKKwkJCWlmIChyYyA8IDAp
CisJCQkJZ290byBmYWlsZWRfZGV0ZWN0OworCQl9CisJfQorCisJLyogRGlzYWJsZSBhbGwgc2lu
a3MgKi8KKwlyYyA9IHJlZ21hcF93cml0ZSh3bGVkLT5yZWdtYXAsCisJCQkgIHdsZWQtPnNpbmtf
YWRkciArIFdMRUQ0X1NJTktfUkVHX0NVUlJfU0lOSywgMCk7CisJaWYgKHJjIDwgMCkgeworCQlk
ZXZfZXJyKHdsZWQtPmRldiwgIkZhaWxlZCB0byBkaXNhYmxlIGFsbCBzaW5rcyByYz0lZFxuIiwg
cmMpOworCQlnb3RvIGZhaWxlZF9kZXRlY3Q7CisJfQorCisJLyogSXRlcmF0ZSB0aHJvdWdoIHRo
ZSBzdHJpbmdzIG9uZSBieSBvbmUgKi8KKwlmb3IgKGkgPSAwOyBpIDwgd2xlZC0+Y2ZnLm51bV9z
dHJpbmdzOyBpKyspIHsKKwkJc2lua190ZXN0ID0gQklUKChXTEVENF9TSU5LX1JFR19DVVJSX1NJ
TktfU0hGVCArIGkpKTsKKworCQkvKiBFbmFibGUgZmVlZGJhY2sgY29udHJvbCAqLworCQlyYyA9
IHJlZ21hcF93cml0ZSh3bGVkLT5yZWdtYXAsIHdsZWQtPmN0cmxfYWRkciArCisJCQkJICBXTEVE
M19DVFJMX1JFR19GRUVEQkFDS19DT05UUk9MLCBpICsgMSk7CisJCWlmIChyYyA8IDApIHsKKwkJ
CWRldl9lcnIod2xlZC0+ZGV2LCAiRmFpbGVkIHRvIGVuYWJsZSBmZWVkYmFjayBmb3IgU0lOSyAl
ZCByYyA9ICVkXG4iLAorCQkJCWkgKyAxLCByYyk7CisJCQlnb3RvIGZhaWxlZF9kZXRlY3Q7CisJ
CX0KKworCQkvKiBFbmFibGUgdGhlIHNpbmsgKi8KKwkJcmMgPSByZWdtYXBfd3JpdGUod2xlZC0+
cmVnbWFwLCB3bGVkLT5zaW5rX2FkZHIgKworCQkJCSAgV0xFRDRfU0lOS19SRUdfQ1VSUl9TSU5L
LCBzaW5rX3Rlc3QpOworCQlpZiAocmMgPCAwKSB7CisJCQlkZXZfZXJyKHdsZWQtPmRldiwgIkZh
aWxlZCB0byBjb25maWd1cmUgU0lOSyAlZCByYz0lZFxuIiwKKwkJCQlpICsgMSwgcmMpOworCQkJ
Z290byBmYWlsZWRfZGV0ZWN0OworCQl9CisKKwkJLyogRW5hYmxlIHRoZSBtb2R1bGUgKi8KKwkJ
cmMgPSByZWdtYXBfdXBkYXRlX2JpdHMod2xlZC0+cmVnbWFwLCB3bGVkLT5jdHJsX2FkZHIgKwor
CQkJCQlXTEVEM19DVFJMX1JFR19NT0RfRU4sCisJCQkJCVdMRUQzX0NUUkxfUkVHX01PRF9FTl9N
QVNLLAorCQkJCQlXTEVEM19DVFJMX1JFR19NT0RfRU5fTUFTSyk7CisJCWlmIChyYyA8IDApIHsK
KwkJCWRldl9lcnIod2xlZC0+ZGV2LCAiRmFpbGVkIHRvIGVuYWJsZSBXTEVEIG1vZHVsZSByYz0l
ZFxuIiwKKwkJCQlyYyk7CisJCQlnb3RvIGZhaWxlZF9kZXRlY3Q7CisJCX0KKworCQl1c2xlZXBf
cmFuZ2UoV0xFRF9TT0ZUX1NUQVJUX0RMWV9VUywKKwkJCSAgICAgV0xFRF9TT0ZUX1NUQVJUX0RM
WV9VUyArIDEwMDApOworCisJCXJjID0gcmVnbWFwX3JlYWQod2xlZC0+cmVnbWFwLCB3bGVkLT5j
dHJsX2FkZHIgKworCQkJCSBXTEVEM19DVFJMX1JFR19JTlRfUlRfU1RTLCAmaW50X3N0cyk7CisJ
CWlmIChyYyA8IDApIHsKKwkJCWRldl9lcnIod2xlZC0+ZGV2LCAiRXJyb3IgaW4gcmVhZGluZyBX
TEVEM19DVFJMX0lOVF9SVF9TVFMgcmM9JWRcbiIsCisJCQkJcmMpOworCQkJZ290byBmYWlsZWRf
ZGV0ZWN0OworCQl9CisKKwkJaWYgKGludF9zdHMgJiBXTEVEM19DVFJMX1JFR19PVlBfRkFVTFRf
U1RBVFVTKQorCQkJZGV2X2RiZyh3bGVkLT5kZXYsICJXTEVEIE9WUCBmYXVsdCBkZXRlY3RlZCB3
aXRoIFNJTksgJWRcbiIsCisJCQkJaSArIDEpOworCQllbHNlCisJCQlzaW5rX3ZhbGlkIHw9IHNp
bmtfdGVzdDsKKworCQkvKiBEaXNhYmxlIHRoZSBtb2R1bGUgKi8KKwkJcmMgPSByZWdtYXBfdXBk
YXRlX2JpdHMod2xlZC0+cmVnbWFwLAorCQkJCQl3bGVkLT5jdHJsX2FkZHIgKyBXTEVEM19DVFJM
X1JFR19NT0RfRU4sCisJCQkJCVdMRUQzX0NUUkxfUkVHX01PRF9FTl9NQVNLLCAwKTsKKwkJaWYg
KHJjIDwgMCkgeworCQkJZGV2X2Vycih3bGVkLT5kZXYsICJGYWlsZWQgdG8gZGlzYWJsZSBXTEVE
IG1vZHVsZSByYz0lZFxuIiwKKwkJCQlyYyk7CisJCQlnb3RvIGZhaWxlZF9kZXRlY3Q7CisJCX0K
Kwl9CisKKwlpZiAoIXNpbmtfdmFsaWQpIHsKKwkJZGV2X2Vycih3bGVkLT5kZXYsICJObyB2YWxp
ZCBXTEVEIHNpbmtzIGZvdW5kXG4iKTsKKwkJd2xlZC0+ZGlzYWJsZWRfYnlfc2hvcnQgPSB0cnVl
OworCQlnb3RvIGZhaWxlZF9kZXRlY3Q7CisJfQorCisJaWYgKHNpbmtfdmFsaWQgIT0gc2lua19j
b25maWcpIHsKKwkJZGV2X3dhcm4od2xlZC0+ZGV2LCAiJXggaXMgbm90IGEgdmFsaWQgc2luayBj
b25maWd1cmF0aW9uIC0gdXNpbmcgJXggaW5zdGVhZFxuIiwKKwkJCSBzaW5rX2NvbmZpZywgc2lu
a192YWxpZCk7CisJCXNpbmtfY29uZmlnID0gc2lua192YWxpZDsKKwl9CisKKwkvKiBXcml0ZSB0
aGUgbmV3IHNpbmsgY29uZmlndXJhdGlvbiAqLworCXJjID0gcmVnbWFwX3dyaXRlKHdsZWQtPnJl
Z21hcCwKKwkJCSAgd2xlZC0+c2lua19hZGRyICsgV0xFRDRfU0lOS19SRUdfQ1VSUl9TSU5LLAor
CQkJICBzaW5rX2NvbmZpZyk7CisJaWYgKHJjIDwgMCkgeworCQlkZXZfZXJyKHdsZWQtPmRldiwg
IkZhaWxlZCB0byByZWNvbmZpZ3VyZSB0aGUgZGVmYXVsdCBzaW5rIHJjPSVkXG4iLAorCQkJcmMp
OworCQlnb3RvIGZhaWxlZF9kZXRlY3Q7CisJfQorCisJLyogRW5hYmxlIHZhbGlkIHNpbmtzICov
CisJZm9yIChpID0gMDsgaSA8IHdsZWQtPmNmZy5udW1fc3RyaW5nczsgaSsrKSB7CisJCWlmICh3
bGVkLT5jZmcuY2FiYykgeworCQkJcmMgPSByZWdtYXBfdXBkYXRlX2JpdHMod2xlZC0+cmVnbWFw
LCB3bGVkLT5zaW5rX2FkZHIgKworCQkJCQkJV0xFRDRfU0lOS19SRUdfU1RSX0NBQkMoaSksCisJ
CQkJCQlXTEVENF9TSU5LX1JFR19TVFJfQ0FCQ19NQVNLLAorCQkJCQkJV0xFRDRfU0lOS19SRUdf
U1RSX0NBQkNfTUFTSyk7CisJCQlpZiAocmMgPCAwKQorCQkJCWdvdG8gZmFpbGVkX2RldGVjdDsK
KwkJfQorCisJCWlmIChzaW5rX2NvbmZpZyAmIEJJVChXTEVENF9TSU5LX1JFR19DVVJSX1NJTktf
U0hGVCArIGkpKQorCQkJdmFsID0gV0xFRDRfU0lOS19SRUdfU1RSX01PRF9NQVNLOworCQllbHNl
CisJCQl2YWwgPSAweDA7IC8qIERpc2FibGUgbW9kdWxhdG9yX2VuIGZvciB1bnVzZWQgc2luayAq
LworCisJCXJjID0gcmVnbWFwX3dyaXRlKHdsZWQtPnJlZ21hcCwgd2xlZC0+c2lua19hZGRyICsK
KwkJCQkgIFdMRUQ0X1NJTktfUkVHX1NUUl9NT0RfRU4oaSksIHZhbCk7CisJCWlmIChyYyA8IDAp
IHsKKwkJCWRldl9lcnIod2xlZC0+ZGV2LCAiRmFpbGVkIHRvIGNvbmZpZ3VyZSBNT0RVTEFUT1Jf
RU4gcmM9JWRcbiIsCisJCQkJcmMpOworCQkJZ290byBmYWlsZWRfZGV0ZWN0OworCQl9CisJfQor
CisJLyogUmVzdG9yZSB0aGUgZmVlZGJhY2sgc2V0dGluZyAqLworCXJjID0gcmVnbWFwX3dyaXRl
KHdsZWQtPnJlZ21hcCwKKwkJCSAgd2xlZC0+Y3RybF9hZGRyICsgV0xFRDNfQ1RSTF9SRUdfRkVF
REJBQ0tfQ09OVFJPTCwgMCk7CisJaWYgKHJjIDwgMCkgeworCQlkZXZfZXJyKHdsZWQtPmRldiwg
IkZhaWxlZCB0byByZXN0b3JlIGZlZWRiYWNrIHNldHRpbmcgcmM9JWRcbiIsCisJCQlyYyk7CisJ
CWdvdG8gZmFpbGVkX2RldGVjdDsKKwl9CisKKwkvKiBSZXN0b3JlIGJyaWdodG5lc3MgKi8KKwly
YyA9IHdsZWQ0X3NldF9icmlnaHRuZXNzKHdsZWQsIHdsZWQtPmJyaWdodG5lc3MpOworCWlmIChy
YyA8IDApIHsKKwkJZGV2X2Vycih3bGVkLT5kZXYsICJGYWlsZWQgdG8gc2V0IGJyaWdodG5lc3Mg
YWZ0ZXIgYXV0byBkZXRlY3Rpb24gcmM9JWRcbiIsCisJCQlyYyk7CisJCWdvdG8gZmFpbGVkX2Rl
dGVjdDsKKwl9CisKKwlyYyA9IHJlZ21hcF91cGRhdGVfYml0cyh3bGVkLT5yZWdtYXAsCisJCQkJ
d2xlZC0+Y3RybF9hZGRyICsgV0xFRDNfQ1RSTF9SRUdfTU9EX0VOLAorCQkJCVdMRUQzX0NUUkxf
UkVHX01PRF9FTl9NQVNLLAorCQkJCVdMRUQzX0NUUkxfUkVHX01PRF9FTl9NQVNLKTsKKwlpZiAo
cmMgPCAwKSB7CisJCWRldl9lcnIod2xlZC0+ZGV2LCAiRmFpbGVkIHRvIGVuYWJsZSBXTEVEIG1v
ZHVsZSByYz0lZFxuIiwgcmMpOworCQlnb3RvIGZhaWxlZF9kZXRlY3Q7CisJfQorCitmYWlsZWRf
ZGV0ZWN0OgorCXJldHVybjsKK30KKworI2RlZmluZSBXTEVEX0FVVE9fREVURUNUX09WUF9DT1VO
VAkJNQorI2RlZmluZSBXTEVEX0FVVE9fREVURUNUX0NOVF9ETFlfVVMJCVVTRUNfUEVSX1NFQwor
c3RhdGljIGJvb2wgd2xlZF9hdXRvX2RldGVjdGlvbl9yZXF1aXJlZChzdHJ1Y3Qgd2xlZCAqd2xl
ZCkKK3sKKwlzNjQgZWxhcHNlZF90aW1lX3VzOworCisJaWYgKCF3bGVkLT5jZmcuYXV0b19kZXRl
Y3Rpb25fZW5hYmxlZCkKKwkJcmV0dXJuIGZhbHNlOworCisJLyoKKwkgKiBDaGVjayBpZiB0aGUg
T1ZQIGZhdWx0IHdhcyBhbiBvY2Nhc2lvbmFsIG9uZQorCSAqIG9yIGlmIGl0J3MgZmlyaW5nIGNv
bnRpbnVvdXNseSwgdGhlIGxhdHRlciBxdWFsaWZpZXMKKwkgKiBmb3IgYW4gYXV0by1kZXRlY3Rp
b24gY2hlY2suCisJICovCisJaWYgKCF3bGVkLT5hdXRvX2RldGVjdGlvbl9vdnBfY291bnQpIHsK
KwkJd2xlZC0+c3RhcnRfb3ZwX2ZhdWx0X3RpbWUgPSBrdGltZV9nZXQoKTsKKwkJd2xlZC0+YXV0
b19kZXRlY3Rpb25fb3ZwX2NvdW50Kys7CisJfSBlbHNlIHsKKwkJZWxhcHNlZF90aW1lX3VzID0g
a3RpbWVfdXNfZGVsdGEoa3RpbWVfZ2V0KCksCisJCQkJCQkgd2xlZC0+c3RhcnRfb3ZwX2ZhdWx0
X3RpbWUpOworCQlpZiAoZWxhcHNlZF90aW1lX3VzID4gV0xFRF9BVVRPX0RFVEVDVF9DTlRfRExZ
X1VTKQorCQkJd2xlZC0+YXV0b19kZXRlY3Rpb25fb3ZwX2NvdW50ID0gMDsKKwkJZWxzZQorCQkJ
d2xlZC0+YXV0b19kZXRlY3Rpb25fb3ZwX2NvdW50Kys7CisKKwkJaWYgKHdsZWQtPmF1dG9fZGV0
ZWN0aW9uX292cF9jb3VudCA+PQorCQkJCVdMRURfQVVUT19ERVRFQ1RfT1ZQX0NPVU5UKSB7CisJ
CQl3bGVkLT5hdXRvX2RldGVjdGlvbl9vdnBfY291bnQgPSAwOworCQkJcmV0dXJuIHRydWU7CisJ
CX0KKwl9CisKKwlyZXR1cm4gZmFsc2U7Cit9CisKK3N0YXRpYyBpbnQgd2xlZF9hdXRvX2RldGVj
dGlvbl9hdF9pbml0KHN0cnVjdCB3bGVkICp3bGVkKQoreworCWludCByYzsKKwl1MzIgZmF1bHRf
c3RhdHVzLCBydF9zdGF0dXM7CisKKwlpZiAoIXdsZWQtPmNmZy5hdXRvX2RldGVjdGlvbl9lbmFi
bGVkKQorCQlyZXR1cm4gMDsKKworCXJjID0gcmVnbWFwX3JlYWQod2xlZC0+cmVnbWFwLAorCQkJ
IHdsZWQtPmN0cmxfYWRkciArIFdMRUQzX0NUUkxfUkVHX0lOVF9SVF9TVFMsCisJCQkgJnJ0X3N0
YXR1cyk7CisJaWYgKHJjIDwgMCkgeworCQlkZXZfZXJyKHdsZWQtPmRldiwgIkZhaWxlZCB0byBy
ZWFkIFJUIHN0YXR1cyByYz0lZFxuIiwgcmMpOworCQlyZXR1cm4gcmM7CisJfQorCisJcmMgPSBy
ZWdtYXBfcmVhZCh3bGVkLT5yZWdtYXAsCisJCQkgd2xlZC0+Y3RybF9hZGRyICsgV0xFRDNfQ1RS
TF9SRUdfRkFVTFRfU1RBVFVTLAorCQkJICZmYXVsdF9zdGF0dXMpOworCWlmIChyYyA8IDApIHsK
KwkJZGV2X2Vycih3bGVkLT5kZXYsICJGYWlsZWQgdG8gcmVhZCBmYXVsdCBzdGF0dXMgcmM9JWRc
biIsIHJjKTsKKwkJcmV0dXJuIHJjOworCX0KKworCWlmICgocnRfc3RhdHVzICYgV0xFRDNfQ1RS
TF9SRUdfT1ZQX0ZBVUxUX1NUQVRVUykgfHwKKwkgICAgKGZhdWx0X3N0YXR1cyAmIFdMRUQzX0NU
UkxfUkVHX09WUF9GQVVMVF9CSVQpKSB7CisJCW11dGV4X2xvY2soJndsZWQtPmxvY2spOworCQl3
bGVkX2F1dG9fc3RyaW5nX2RldGVjdGlvbih3bGVkKTsKKwkJbXV0ZXhfdW5sb2NrKCZ3bGVkLT5s
b2NrKTsKKwl9CisKKwlyZXR1cm4gcmM7Cit9CisKK3N0YXRpYyBpcnFyZXR1cm5fdCB3bGVkX292
cF9pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICpfd2xlZCkKK3sKKwlzdHJ1Y3Qgd2xlZCAqd2xl
ZCA9IF93bGVkOworCWludCByYzsKKwl1MzIgaW50X3N0cywgZmF1bHRfc3RzOworCisJcmMgPSBy
ZWdtYXBfcmVhZCh3bGVkLT5yZWdtYXAsCisJCQkgd2xlZC0+Y3RybF9hZGRyICsgV0xFRDNfQ1RS
TF9SRUdfSU5UX1JUX1NUUywgJmludF9zdHMpOworCWlmIChyYyA8IDApIHsKKwkJZGV2X2Vycih3
bGVkLT5kZXYsICJFcnJvciBpbiByZWFkaW5nIFdMRUQzX0lOVF9SVF9TVFMgcmM9JWRcbiIsCisJ
CQlyYyk7CisJCXJldHVybiBJUlFfSEFORExFRDsKKwl9CisKKwlyYyA9IHJlZ21hcF9yZWFkKHds
ZWQtPnJlZ21hcCwgd2xlZC0+Y3RybF9hZGRyICsKKwkJCSBXTEVEM19DVFJMX1JFR19GQVVMVF9T
VEFUVVMsICZmYXVsdF9zdHMpOworCWlmIChyYyA8IDApIHsKKwkJZGV2X2Vycih3bGVkLT5kZXYs
ICJFcnJvciBpbiByZWFkaW5nIFdMRURfRkFVTFRfU1RBVFVTIHJjPSVkXG4iLAorCQkJcmMpOwor
CQlyZXR1cm4gSVJRX0hBTkRMRUQ7CisJfQorCisJaWYgKGZhdWx0X3N0cyAmIChXTEVEM19DVFJM
X1JFR19PVlBfRkFVTFRfQklUIHwKKwkJV0xFRDNfQ1RSTF9SRUdfSUxJTV9GQVVMVF9CSVQpKQor
CQlkZXZfZGJnKHdsZWQtPmRldiwgIldMRUQgT1ZQIGZhdWx0IGRldGVjdGVkLCBpbnRfc3RzPSV4
IGZhdWx0X3N0cz0gJXhcbiIsCisJCQlpbnRfc3RzLCBmYXVsdF9zdHMpOworCisJaWYgKGZhdWx0
X3N0cyAmIFdMRUQzX0NUUkxfUkVHX09WUF9GQVVMVF9CSVQpIHsKKwkJaWYgKHdsZWRfYXV0b19k
ZXRlY3Rpb25fcmVxdWlyZWQod2xlZCkpIHsKKwkJCW11dGV4X2xvY2soJndsZWQtPmxvY2spOwor
CQkJd2xlZF9hdXRvX3N0cmluZ19kZXRlY3Rpb24od2xlZCk7CisJCQltdXRleF91bmxvY2soJnds
ZWQtPmxvY2spOworCQl9CisJfQorCisJcmV0dXJuIElSUV9IQU5ETEVEOworfQorCiBzdGF0aWMg
aW50IHdsZWQzX3NldHVwKHN0cnVjdCB3bGVkICp3bGVkKQogewogCXUxNiBhZGRyOwpAQCAtNDM2
LDggKzc3MywxMCBAQCBzdGF0aWMgaW50IHdsZWQ0X3NldHVwKHN0cnVjdCB3bGVkICp3bGVkKQog
CQlzaW5rX2VuIHw9IDEgPDwgdGVtcDsKIAl9CiAKLQlpZiAoc2lua19jZmcgPT0gc2lua19lbikK
LQkJcmV0dXJuIDA7CisJaWYgKHNpbmtfY2ZnID09IHNpbmtfZW4pIHsKKwkJcmMgPSB3bGVkX2F1
dG9fZGV0ZWN0aW9uX2F0X2luaXQod2xlZCk7CisJCXJldHVybiByYzsKKwl9CiAKIAlyYyA9IHJl
Z21hcF91cGRhdGVfYml0cyh3bGVkLT5yZWdtYXAsCiAJCQkJd2xlZC0+c2lua19hZGRyICsgV0xF
RDRfU0lOS19SRUdfQ1VSUl9TSU5LLApAQCAtNTAwLDcgKzgzOSw5IEBAIHN0YXRpYyBpbnQgd2xl
ZDRfc2V0dXAoc3RydWN0IHdsZWQgKndsZWQpCiAJCXJldHVybiByYzsKIAl9CiAKLQlyZXR1cm4g
MDsKKwlyYyA9IHdsZWRfYXV0b19kZXRlY3Rpb25fYXRfaW5pdCh3bGVkKTsKKworCXJldHVybiBy
YzsKIH0KIAogc3RhdGljIGNvbnN0IHN0cnVjdCB3bGVkX2NvbmZpZyB3bGVkNF9jb25maWdfZGVm
YXVsdHMgPSB7CkBAIC01MTEsNiArODUyLDcgQEAgc3RhdGljIGludCB3bGVkNF9zZXR1cChzdHJ1
Y3Qgd2xlZCAqd2xlZCkKIAkuc3dpdGNoX2ZyZXEgPSAxMSwKIAkuY2FiYyA9IGZhbHNlLAogCS5l
eHRlcm5hbF9wZmV0ID0gZmFsc2UsCisJLmF1dG9fZGV0ZWN0aW9uX2VuYWJsZWQgPSBmYWxzZSwK
IH07CiAKIHN0YXRpYyBjb25zdCB1MzIgd2xlZDNfYm9vc3RfaV9saW1pdF92YWx1ZXNbXSA9IHsK
QEAgLTY3Nyw2ICsxMDE5LDcgQEAgc3RhdGljIGludCB3bGVkX2NvbmZpZ3VyZShzdHJ1Y3Qgd2xl
ZCAqd2xlZCwgaW50IHZlcnNpb24pCiAJCXsgInFjb20sZXh0LWdlbiIsICZjZmctPmV4dF9nZW4s
IH0sCiAJCXsgInFjb20sY2FiYyIsICZjZmctPmNhYmMsIH0sCiAJCXsgInFjb20sZXh0ZXJuYWwt
cGZldCIsICZjZmctPmV4dGVybmFsX3BmZXQsIH0sCisJCXsgInFjb20sYXV0by1zdHJpbmctZGV0
ZWN0aW9uIiwgJmNmZy0+YXV0b19kZXRlY3Rpb25fZW5hYmxlZCwgfSwKIAl9OwogCiAJcHJvcF9h
ZGRyID0gb2ZfZ2V0X2FkZHJlc3MoZGV2LT5vZl9ub2RlLCAwLCBOVUxMLCBOVUxMKTsKQEAgLTc5
Nyw2ICsxMTQwLDQwIEBAIHN0YXRpYyBpbnQgd2xlZF9jb25maWd1cmVfc2hvcnRfaXJxKHN0cnVj
dCB3bGVkICp3bGVkLAogCXJldHVybiByYzsKIH0KIAorc3RhdGljIGludCB3bGVkX2NvbmZpZ3Vy
ZV9vdnBfaXJxKHN0cnVjdCB3bGVkICp3bGVkLAorCQkJCSAgc3RydWN0IHBsYXRmb3JtX2Rldmlj
ZSAqcGRldikKK3sKKwlpbnQgcmM7CisJdTMyIHZhbDsKKworCXdsZWQtPm92cF9pcnEgPSBwbGF0
Zm9ybV9nZXRfaXJxX2J5bmFtZShwZGV2LCAib3ZwIik7CisJaWYgKHdsZWQtPm92cF9pcnEgPCAw
KSB7CisJCWRldl9kYmcoJnBkZXYtPmRldiwgIk9WUCBJUlEgbm90IGZvdW5kIC0gZGlzYWJsaW5n
IGF1dG9tYXRpYyBzdHJpbmcgZGV0ZWN0aW9uXG4iKTsKKwkJcmV0dXJuIDA7CisJfQorCisJcmMg
PSBkZXZtX3JlcXVlc3RfdGhyZWFkZWRfaXJxKHdsZWQtPmRldiwgd2xlZC0+b3ZwX2lycSwgTlVM
TCwKKwkJCQkgICAgICAgd2xlZF9vdnBfaXJxX2hhbmRsZXIsIElSUUZfT05FU0hPVCwKKwkJCQkg
ICAgICAgIndsZWRfb3ZwX2lycSIsIHdsZWQpOworCWlmIChyYyA8IDApIHsKKwkJZGV2X2Vycih3
bGVkLT5kZXYsICJVbmFibGUgdG8gcmVxdWVzdCBvdnBfaXJxIChlcnI6JWQpXG4iLAorCQkJcmMp
OworCQl3bGVkLT5vdnBfaXJxID0gMDsKKwkJcmV0dXJuIDA7CisJfQorCisJcmMgPSByZWdtYXBf
cmVhZCh3bGVkLT5yZWdtYXAsIHdsZWQtPmN0cmxfYWRkciArCisJCQkgV0xFRDNfQ1RSTF9SRUdf
TU9EX0VOLCAmdmFsKTsKKwlpZiAocmMgPCAwKQorCQlyZXR1cm4gcmM7CisKKwkvKiBLZWVwIE9W
UCBpcnEgZGlzYWJsZWQgdW50aWwgbW9kdWxlIGlzIGVuYWJsZWQgKi8KKwlpZiAoISh2YWwgJiBX
TEVEM19DVFJMX1JFR19NT0RfRU5fTUFTSykpCisJCWRpc2FibGVfaXJxKHdsZWQtPm92cF9pcnEp
OworCisJcmV0dXJuIDA7Cit9CisKIHN0YXRpYyBjb25zdCBzdHJ1Y3QgYmFja2xpZ2h0X29wcyB3
bGVkX29wcyA9IHsKIAkudXBkYXRlX3N0YXR1cyA9IHdsZWRfdXBkYXRlX3N0YXR1cywKIH07CkBA
IC04MzcsNiArMTIxNCw3IEBAIHN0YXRpYyBpbnQgd2xlZF9wcm9iZShzdHJ1Y3QgcGxhdGZvcm1f
ZGV2aWNlICpwZGV2KQogCiAJc3dpdGNoICh2ZXJzaW9uKSB7CiAJY2FzZSAzOgorCQl3bGVkLT5j
ZmcuYXV0b19kZXRlY3Rpb25fZW5hYmxlZCA9IGZhbHNlOwogCQlyYyA9IHdsZWQzX3NldHVwKHds
ZWQpOwogCQlpZiAocmMpIHsKIAkJCWRldl9lcnIoJnBkZXYtPmRldiwgIndsZWQzX3NldHVwIGZh
aWxlZFxuIik7CkBAIC04NTgsMTAgKzEyMzYsMTYgQEAgc3RhdGljIGludCB3bGVkX3Byb2JlKHN0
cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpCiAJCWJyZWFrOwogCX0KIAorCUlOSVRfREVMQVlF
RF9XT1JLKCZ3bGVkLT5vdnBfd29yaywgd2xlZF9vdnBfd29yayk7CisKIAlyYyA9IHdsZWRfY29u
ZmlndXJlX3Nob3J0X2lycSh3bGVkLCBwZGV2KTsKIAlpZiAocmMgPCAwKQogCQlyZXR1cm4gcmM7
CiAKKwlyYyA9IHdsZWRfY29uZmlndXJlX292cF9pcnEod2xlZCwgcGRldik7CisJaWYgKHJjIDwg
MCkKKwkJcmV0dXJuIHJjOworCiAJdmFsID0gV0xFRF9ERUZBVUxUX0JSSUdIVE5FU1M7CiAJb2Zf
cHJvcGVydHlfcmVhZF91MzIocGRldi0+ZGV2Lm9mX25vZGUsICJkZWZhdWx0LWJyaWdodG5lc3Mi
LCAmdmFsKTsKIApAQCAtODgwLDcgKzEyNjQsOSBAQCBzdGF0aWMgaW50IHdsZWRfcmVtb3ZlKHN0
cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpCiAJc3RydWN0IHdsZWQgKndsZWQgPSBkZXZfZ2V0
X2RydmRhdGEoJnBkZXYtPmRldik7CiAKIAltdXRleF9kZXN0cm95KCZ3bGVkLT5sb2NrKTsKKwlj
YW5jZWxfZGVsYXllZF93b3JrX3N5bmMoJndsZWQtPm92cF93b3JrKTsKIAlkaXNhYmxlX2lycSh3
bGVkLT5zaG9ydF9pcnEpOworCWRpc2FibGVfaXJxKHdsZWQtPm92cF9pcnEpOwogCiAJcmV0dXJu
IDA7CiB9Ci0tIApUaGUgUXVhbGNvbW0gSW5ub3ZhdGlvbiBDZW50ZXIsIEluYy4gaXMgYSBtZW1i
ZXIgb2YgdGhlIENvZGUgQXVyb3JhIEZvcnVtLAogYSBMaW51eCBGb3VuZGF0aW9uIENvbGxhYm9y
YXRpdmUgUHJvamVjdAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Au
b3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRl
dmVs
