Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 00F23AD3C7
	for <lists+dri-devel@lfdr.de>; Mon,  9 Sep 2019 09:24:05 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 60C9589951;
	Mon,  9 Sep 2019 07:23:39 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from relay9-d.mail.gandi.net (relay9-d.mail.gandi.net
 [217.70.183.199])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 01F9C6E29F
 for <dri-devel@lists.freedesktop.org>; Fri,  6 Sep 2019 13:53:39 +0000 (UTC)
X-Originating-IP: 2.224.242.101
Received: from uno.lan (2-224-242-101.ip172.fastwebnet.it [2.224.242.101])
 (Authenticated sender: jacopo@jmondi.org)
 by relay9-d.mail.gandi.net (Postfix) with ESMTPSA id F311BFF802;
 Fri,  6 Sep 2019 13:53:35 +0000 (UTC)
From: Jacopo Mondi <jacopo+renesas@jmondi.org>
To: laurent.pinchart@ideasonboard.com, kieran.bingham+renesas@ideasonboard.com,
 geert@linux-m68k.org, horms@verge.net.au, uli+renesas@fpond.eu,
 VenkataRajesh.Kalakodima@in.bosch.com
Subject: [PATCH v4 5/9] drm: rcar-du: kms: Initialize CMM instances
Date: Fri,  6 Sep 2019 15:54:32 +0200
Message-Id: <20190906135436.10622-6-jacopo+renesas@jmondi.org>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190906135436.10622-1-jacopo+renesas@jmondi.org>
References: <20190906135436.10622-1-jacopo+renesas@jmondi.org>
MIME-Version: 1.0
X-Mailman-Approved-At: Mon, 09 Sep 2019 07:23:02 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: muroya@ksk.co.jp, airlied@linux.ie, koji.matsuoka.xm@renesas.com,
 dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org,
 linux-renesas-soc@vger.kernel.org, Jacopo Mondi <jacopo+renesas@jmondi.org>,
 Harsha.ManjulaMallikarjun@in.bosch.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW1wbGVtZW50IGRldmljZSB0cmVlIHBhcnNpbmcgdG8gY29sbGVjdCB0aGUgYXZhaWxhYmxlIENN
TSBpbnN0YW5jZXMKZGVzY3JpYmVkIGJ5IHRoZSAncmVuZXNhcyxjbW1zJyBwcm9wZXJ0eS4gQXNz
b2NpYXRlIENNTXMgd2l0aCBDUlRDcyBhbmQKc3RvcmUgYSBtYXNrIG9mIGFjdGl2ZSBDTU1zIGlu
IHRoZSBEVSBncm91cCBmb3IgbGF0ZXIgZW5hYmxlbWVudC4KCkVuZm9yY2UgdGhlIHByb2JlIGFu
ZCBzdXNwZW5kL3Jlc3VtZSBvcmRlcmluZyBvZiBEVSBhbmQgQ01NIGJ5IGNyZWF0aW5nCmEgc3Rh
dGVsZXNzIGRldmljZSBsaW5rIGJldHdlZW4gdGhlIHR3by4KClJldmlld2VkLWJ5OiBMYXVyZW50
IFBpbmNoYXJ0IDxsYXVyZW50LnBpbmNoYXJ0QGlkZWFzb25ib2FyZC5jb20+ClNpZ25lZC1vZmYt
Ynk6IEphY29wbyBNb25kaSA8amFjb3BvK3JlbmVzYXNAam1vbmRpLm9yZz4KLS0tCiBkcml2ZXJz
L2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X2NydGMuYyAgfCAgNiArKysKIGRyaXZlcnMvZ3B1L2Ry
bS9yY2FyLWR1L3JjYXJfZHVfY3J0Yy5oICB8ICAyICsKIGRyaXZlcnMvZ3B1L2RybS9yY2FyLWR1
L3JjYXJfZHVfZHJ2LmggICB8ICAyICsKIGRyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVf
Z3JvdXAuaCB8ICAyICsKIGRyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfa21zLmMgICB8
IDY4ICsrKysrKysrKysrKysrKysrKysrKysrKysKIDUgZmlsZXMgY2hhbmdlZCwgODAgaW5zZXJ0
aW9ucygrKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfY3J0
Yy5jIGIvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9jcnRjLmMKaW5kZXggMmRhNDZl
M2RjNGFlLi4yM2YxZDZjYzE3MTkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1
L3JjYXJfZHVfY3J0Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfY3J0
Yy5jCkBAIC0xMTk0LDYgKzExOTQsMTIgQEAgaW50IHJjYXJfZHVfY3J0Y19jcmVhdGUoc3RydWN0
IHJjYXJfZHVfZ3JvdXAgKnJncnAsIHVuc2lnbmVkIGludCBzd2luZGV4LAogCWlmIChyZXQgPCAw
KQogCQlyZXR1cm4gcmV0OwogCisJLyogQ01NIG1pZ2h0IGJlIGRpc2FibGVkIGZvciB0aGlzIENS
VEMuICovCisJaWYgKHJjZHUtPmNtbXNbc3dpbmRleF0pIHsKKwkJcmNydGMtPmNtbSA9IHJjZHUt
PmNtbXNbc3dpbmRleF07CisJCXJncnAtPmNtbXNfbWFzayB8PSBCSVQoaHdpbmRleCAlIDIpOwor
CX0KKwogCWRybV9jcnRjX2hlbHBlcl9hZGQoY3J0YywgJmNydGNfaGVscGVyX2Z1bmNzKTsKIAog
CS8qIFN0YXJ0IHdpdGggdmVydGljYWwgYmxhbmtpbmcgaW50ZXJydXB0IHJlcG9ydGluZyBkaXNh
YmxlZC4gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfY3J0
Yy5oIGIvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9jcnRjLmgKaW5kZXggM2I3ZmM2
Njg5OTZmLi41ZjI5NDBjNDIyMjUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1
L3JjYXJfZHVfY3J0Yy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfY3J0
Yy5oCkBAIC0zOSw2ICszOSw3IEBAIHN0cnVjdCByY2FyX2R1X3ZzcDsKICAqIEB2Ymxhbmtfd2Fp
dDogd2FpdCBxdWV1ZSB1c2VkIHRvIHNpZ25hbCB2ZXJ0aWNhbCBibGFua2luZwogICogQHZibGFu
a19jb3VudDogbnVtYmVyIG9mIHZlcnRpY2FsIGJsYW5raW5nIGludGVycnVwdHMgdG8gd2FpdCBm
b3IKICAqIEBncm91cDogQ1JUQyBncm91cCB0aGlzIENSVEMgYmVsb25ncyB0bworICogQGNtbTog
Q01NIGFzc29jaWF0ZWQgd2l0aCB0aGlzIENSVEMKICAqIEB2c3A6IFZTUCBmZWVkaW5nIHZpZGVv
IHRvIHRoaXMgQ1JUQwogICogQHZzcF9waXBlOiBpbmRleCBvZiB0aGUgVlNQIHBpcGVsaW5lIGZl
ZWRpbmcgdmlkZW8gdG8gdGhpcyBDUlRDCiAgKiBAd3JpdGViYWNrOiB0aGUgd3JpdGViYWNrIGNv
bm5lY3RvcgpAQCAtNjQsNiArNjUsNyBAQCBzdHJ1Y3QgcmNhcl9kdV9jcnRjIHsKIAl1bnNpZ25l
ZCBpbnQgdmJsYW5rX2NvdW50OwogCiAJc3RydWN0IHJjYXJfZHVfZ3JvdXAgKmdyb3VwOworCXN0
cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKmNtbTsKIAlzdHJ1Y3QgcmNhcl9kdV92c3AgKnZzcDsKIAl1
bnNpZ25lZCBpbnQgdnNwX3BpcGU7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yY2Fy
LWR1L3JjYXJfZHVfZHJ2LmggYi9kcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X2Rydi5o
CmluZGV4IGEwMGRjY2M0NDdhYS4uNjMxNmExYzUyMzZjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vcmNhci1kdS9yY2FyX2R1X2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1
L3JjYXJfZHVfZHJ2LmgKQEAgLTEzLDYgKzEzLDcgQEAKICNpbmNsdWRlIDxsaW51eC9rZXJuZWwu
aD4KICNpbmNsdWRlIDxsaW51eC93YWl0Lmg+CiAKKyNpbmNsdWRlICJyY2FyX2NtbS5oIgogI2lu
Y2x1ZGUgInJjYXJfZHVfY3J0Yy5oIgogI2luY2x1ZGUgInJjYXJfZHVfZ3JvdXAuaCIKICNpbmNs
dWRlICJyY2FyX2R1X3ZzcC5oIgpAQCAtODYsNiArODcsNyBAQCBzdHJ1Y3QgcmNhcl9kdV9kZXZp
Y2UgewogCXN0cnVjdCByY2FyX2R1X2VuY29kZXIgKmVuY29kZXJzW1JDQVJfRFVfT1VUUFVUX01B
WF07CiAKIAlzdHJ1Y3QgcmNhcl9kdV9ncm91cCBncm91cHNbUkNBUl9EVV9NQVhfR1JPVVBTXTsK
KwlzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpjbW1zW1JDQVJfRFVfTUFYX0NSVENTXTsKIAlzdHJ1
Y3QgcmNhcl9kdV92c3AgdnNwc1tSQ0FSX0RVX01BWF9WU1BTXTsKIAogCXN0cnVjdCB7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X2dyb3VwLmggYi9kcml2ZXJz
L2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X2dyb3VwLmgKaW5kZXggODc5NTBjMWY2YTUyLi5lOTkw
NjYwOWM2MzUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfZ3Jv
dXAuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X2dyb3VwLmgKQEAgLTIy
LDYgKzIyLDcgQEAgc3RydWN0IHJjYXJfZHVfZGV2aWNlOwogICogQG1taW9fb2Zmc2V0OiByZWdp
c3RlcnMgb2Zmc2V0IGluIHRoZSBkZXZpY2UgbWVtb3J5IG1hcAogICogQGluZGV4OiBncm91cCBp
bmRleAogICogQGNoYW5uZWxzX21hc2s6IGJpdG1hc2sgb2YgcG9wdWxhdGVkIERVIGNoYW5uZWxz
IGluIHRoaXMgZ3JvdXAKKyAqIEBjbW1zX21hc2s6IGJpdG1hc2sgb2YgYXZhaWxhYmxlIENNTXMg
aW4gdGhpcyBncm91cAogICogQG51bV9jcnRjczogbnVtYmVyIG9mIENSVENzIGluIHRoaXMgZ3Jv
dXAgKDEgb3IgMikKICAqIEB1c2VfY291bnQ6IG51bWJlciBvZiB1c2VycyBvZiB0aGUgZ3JvdXAg
KHJjYXJfZHVfZ3JvdXBfKGdldHxwdXQpKQogICogQHVzZWRfY3J0Y3M6IG51bWJlciBvZiBDUlRD
cyBjdXJyZW50bHkgaW4gdXNlCkBAIC0zNyw2ICszOCw3IEBAIHN0cnVjdCByY2FyX2R1X2dyb3Vw
IHsKIAl1bnNpZ25lZCBpbnQgaW5kZXg7CiAKIAl1bnNpZ25lZCBpbnQgY2hhbm5lbHNfbWFzazsK
Kwl1bnNpZ25lZCBpbnQgY21tc19tYXNrOwogCXVuc2lnbmVkIGludCBudW1fY3J0Y3M7CiAJdW5z
aWduZWQgaW50IHVzZV9jb3VudDsKIAl1bnNpZ25lZCBpbnQgdXNlZF9jcnRjczsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfa21zLmMgYi9kcml2ZXJzL2dwdS9k
cm0vcmNhci1kdS9yY2FyX2R1X2ttcy5jCmluZGV4IDJkYzljYWVlODc2Ny4uMjk0NjMwZTU2OTky
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X2ttcy5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfa21zLmMKQEAgLTE3LDcgKzE3LDkgQEAK
ICNpbmNsdWRlIDxkcm0vZHJtX3Byb2JlX2hlbHBlci5oPgogI2luY2x1ZGUgPGRybS9kcm1fdmJs
YW5rLmg+CiAKKyNpbmNsdWRlIDxsaW51eC9kZXZpY2UuaD4KICNpbmNsdWRlIDxsaW51eC9vZl9n
cmFwaC5oPgorI2luY2x1ZGUgPGxpbnV4L29mX3BsYXRmb3JtLmg+CiAjaW5jbHVkZSA8bGludXgv
d2FpdC5oPgogCiAjaW5jbHVkZSAicmNhcl9kdV9jcnRjLmgiCkBAIC02MTQsNiArNjE2LDY3IEBA
IHN0YXRpYyBpbnQgcmNhcl9kdV92c3BzX2luaXQoc3RydWN0IHJjYXJfZHVfZGV2aWNlICpyY2R1
KQogCXJldHVybiByZXQ7CiB9CiAKK3N0YXRpYyBpbnQgcmNhcl9kdV9jbW1faW5pdChzdHJ1Y3Qg
cmNhcl9kdV9kZXZpY2UgKnJjZHUpCit7CisJY29uc3Qgc3RydWN0IGRldmljZV9ub2RlICpucCA9
IHJjZHUtPmRldi0+b2Zfbm9kZTsKKwl1bnNpZ25lZCBpbnQgaTsKKwlpbnQgY2VsbHM7CisKKwlj
ZWxscyA9IG9mX3Byb3BlcnR5X2NvdW50X3UzMl9lbGVtcyhucCwgInJlbmVzYXMsY21tcyIpOwor
CWlmIChjZWxscyA9PSAtRUlOVkFMKQorCQlyZXR1cm4gMDsKKworCWlmIChjZWxscyA+IHJjZHUt
Pm51bV9jcnRjcykgeworCQlkZXZfZXJyKHJjZHUtPmRldiwKKwkJCSJJbnZhbGlkIG51bWJlciBv
ZiBlbnRyaWVzIGluICdyZW5lc2FzLGNtbXMnXG4iKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQor
CisJZm9yIChpID0gMDsgaSA8IGNlbGxzOyArK2kpIHsKKwkJc3RydWN0IHBsYXRmb3JtX2Rldmlj
ZSAqcGRldjsKKwkJc3RydWN0IGRldmljZV9saW5rICpsaW5rOworCQlzdHJ1Y3QgZGV2aWNlX25v
ZGUgKmNtbTsKKwkJaW50IHJldDsKKworCQljbW0gPSBvZl9wYXJzZV9waGFuZGxlKG5wLCAicmVu
ZXNhcyxjbW1zIiwgaSk7CisJCWlmIChJU19FUlIoY21tKSkgeworCQkJZGV2X2VycihyY2R1LT5k
ZXYsCisJCQkJIkZhaWxlZCB0byBwYXJzZSAncmVuZXNhcyxjbW1zJyBwcm9wZXJ0eVxuIik7CisJ
CQlyZXR1cm4gUFRSX0VSUihjbW0pOworCQl9CisKKwkJaWYgKCFvZl9kZXZpY2VfaXNfYXZhaWxh
YmxlKGNtbSkpIHsKKwkJCS8qIEl0J3MgZmluZSB0byBoYXZlIGEgcGhhbmRsZSB0byBhIG5vbi1l
bmFibGVkIENNTS4gKi8KKwkJCW9mX25vZGVfcHV0KGNtbSk7CisJCQljb250aW51ZTsKKwkJfQor
CisJCXBkZXYgPSBvZl9maW5kX2RldmljZV9ieV9ub2RlKGNtbSk7CisJCWlmIChJU19FUlIocGRl
dikpIHsKKwkJCWRldl9lcnIocmNkdS0+ZGV2LCAiTm8gZGV2aWNlIGZvdW5kIGZvciBDTU0ldVxu
IiwgaSk7CisJCQlvZl9ub2RlX3B1dChjbW0pOworCQkJcmV0dXJuIFBUUl9FUlIocGRldik7CisJ
CX0KKworCQlvZl9ub2RlX3B1dChjbW0pOworCisJCXJldCA9IHJjYXJfY21tX2luaXQocGRldik7
CisJCWlmIChyZXQpCisJCQlyZXR1cm4gcmV0OworCisJCWxpbmsgPSBkZXZpY2VfbGlua19hZGQo
cmNkdS0+ZGV2LCAmcGRldi0+ZGV2LCBETF9GTEFHX1NUQVRFTEVTUyk7CisJCWlmICghbGluaykg
eworCQkJZGV2X2VycihyY2R1LT5kZXYsCisJCQkJIkZhaWxlZCB0byBjcmVhdGUgZGV2aWNlIGxp
bmsgdG8gQ01NJXVcbiIsIGkpOworCQkJcmV0dXJuIC1FSU5WQUw7CisJCX0KKworCQlyY2R1LT5j
bW1zW2ldID0gcGRldjsKKwl9CisKKwlyZXR1cm4gMDsKK30KKwogaW50IHJjYXJfZHVfbW9kZXNl
dF9pbml0KHN0cnVjdCByY2FyX2R1X2RldmljZSAqcmNkdSkKIHsKIAlzdGF0aWMgY29uc3QgdW5z
aWduZWQgaW50IG1taW9fb2Zmc2V0c1tdID0gewpAQCAtNzA0LDYgKzc2NywxMSBAQCBpbnQgcmNh
cl9kdV9tb2Rlc2V0X2luaXQoc3RydWN0IHJjYXJfZHVfZGV2aWNlICpyY2R1KQogCQkJcmV0dXJu
IHJldDsKIAl9CiAKKwkvKiBJbml0aWFsaXplIHRoZSBDb2xvciBNYW5hZ2VtZW50IE1vZHVsZXMu
ICovCisJcmV0ID0gcmNhcl9kdV9jbW1faW5pdChyY2R1KTsKKwlpZiAocmV0KQorCQlyZXR1cm4g
cmV0OworCiAJLyogQ3JlYXRlIHRoZSBDUlRDcy4gKi8KIAlmb3IgKHN3aW5kZXggPSAwLCBod2lu
ZGV4ID0gMDsgc3dpbmRleCA8IHJjZHUtPm51bV9jcnRjczsgKytod2luZGV4KSB7CiAJCXN0cnVj
dCByY2FyX2R1X2dyb3VwICpyZ3JwOwotLSAKMi4yMy4wCgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZl
bEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFp
bG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
