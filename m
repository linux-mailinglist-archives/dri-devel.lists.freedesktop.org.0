Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 03B386315D
	for <lists+dri-devel@lfdr.de>; Tue,  9 Jul 2019 09:02:21 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3F6DD897E9;
	Tue,  9 Jul 2019 07:01:47 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mailgw01.mediatek.com (unknown [210.61.82.183])
 by gabe.freedesktop.org (Postfix) with ESMTPS id DB0FE89F6D
 for <dri-devel@lists.freedesktop.org>; Mon,  8 Jul 2019 22:34:39 +0000 (UTC)
X-UUID: 536a4d01dc9844dd90c8562765ac88c4-20190709
X-UUID: 536a4d01dc9844dd90c8562765ac88c4-20190709
Received: from mtkexhb01.mediatek.inc [(172.21.101.102)] by
 mailgw01.mediatek.com (envelope-from <yongqiang.niu@mediatek.com>)
 (mhqrelay.mediatek.com ESMTP with TLS)
 with ESMTP id 580935575; Tue, 09 Jul 2019 06:34:32 +0800
Received: from mtkcas08.mediatek.inc (172.21.101.126) by
 mtkmbs01n1.mediatek.inc (172.21.101.68) with Microsoft SMTP Server (TLS) id
 15.0.1395.4; Tue, 9 Jul 2019 06:34:32 +0800
Received: from localhost.localdomain (10.17.3.153) by mtkcas08.mediatek.inc
 (172.21.101.73) with Microsoft SMTP Server id 15.0.1395.4 via Frontend
 Transport; Tue, 9 Jul 2019 06:34:31 +0800
From: <yongqiang.niu@mediatek.com>
To: CK Hu <ck.hu@mediatek.com>, Philipp Zabel <p.zabel@pengutronix.de>, Rob
 Herring <robh+dt@kernel.org>, Matthias Brugger <matthias.bgg@gmail.com>
Subject: [PATCH v4,
 13/33] drm/mediatek: add mmsys private data for ddp path config
Date: Tue, 9 Jul 2019 06:33:53 +0800
Message-ID: <1562625253-29254-14-git-send-email-yongqiang.niu@mediatek.com>
X-Mailer: git-send-email 1.8.1.1.dirty
In-Reply-To: <1562625253-29254-1-git-send-email-yongqiang.niu@mediatek.com>
References: <1562625253-29254-1-git-send-email-yongqiang.niu@mediatek.com>
MIME-Version: 1.0
X-MTK: N
X-Mailman-Approved-At: Tue, 09 Jul 2019 07:01:45 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Mark Rutland <mark.rutland@arm.com>, devicetree@vger.kernel.org,
 Yongqiang Niu <yongqiang.niu@mediatek.com>, David Airlie <airlied@linux.ie>,
 linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org,
 linux-mediatek@lists.infradead.org, linux-arm-kernel@lists.infradead.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogWW9uZ3FpYW5nIE5pdSA8eW9uZ3FpYW5nLm5pdUBtZWRpYXRlay5jb20+CgpUaGlzIHBh
dGNoIGFkZCBtbXN5cyBwcml2YXRlIGRhdGEgZm9yIGRkcCBwYXRoIGNvbmZpZwphbGwgdGhlc2Ug
cmVnaXN0ZXIgb2Zmc2V0IGFuZCB2YWx1ZSB3aWxsIGJlIGRpZmZlcmVudCBpbiBmdXR1cmUgU09D
CmFkZCB0aGVzZSBkZWZpbmUgaW50byBtbXN5cyBwcml2YXRlIGRhdGEKCXUzMiBvdmwwX21vdXRf
ZW47Cgl1MzIgcmRtYTBfc291dF9zZWxfaW47Cgl1MzIgcmRtYTBfc291dF9jb2xvcjA7Cgl1MzIg
cmRtYTFfc291dF9zZWxfaW47Cgl1MzIgcmRtYTFfc291dF9kcGkwOwoJdTMyIHJkbWExX3NvdXRf
ZHNpMDsKCXUzMiBkcGkwX3NlbF9pbjsKCXUzMiBkcGkwX3NlbF9pbl9yZG1hMTsKCXUzMiBkc2kw
X3NlbF9pbjsKCXUzMiBkc2kwX3NlbF9pbl9yZG1hMTsKClNpZ25lZC1vZmYtYnk6IFlvbmdxaWFu
ZyBOaXUgPHlvbmdxaWFuZy5uaXVAbWVkaWF0ZWsuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9t
ZWRpYXRlay9tdGtfZHJtX2NydGMuYyB8ICA0ICsrCiBkcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsv
bXRrX2RybV9kZHAuYyAgfCA4OSArKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0KIGRy
aXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2RkcC5oICB8ICA1ICsrCiBkcml2ZXJzL2dw
dS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9kcnYuYyAgfCAgMyArKwogZHJpdmVycy9ncHUvZHJtL21l
ZGlhdGVrL210a19kcm1fZHJ2LmggIHwgIDMgKysKIDUgZmlsZXMgY2hhbmdlZCwgNzkgaW5zZXJ0
aW9ucygrKSwgMjUgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21l
ZGlhdGVrL210a19kcm1fY3J0Yy5jIGIvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1f
Y3J0Yy5jCmluZGV4IGU1MjBiNTYuLjVlYWMzNzYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9tZWRpYXRlay9tdGtfZHJtX2NydGMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsv
bXRrX2RybV9jcnRjLmMKQEAgLTQ5LDYgKzQ5LDcgQEAgc3RydWN0IG10a19kcm1fY3J0YyB7CiAJ
Ym9vbAkJCQlwZW5kaW5nX3BsYW5lczsKIAogCXZvaWQgX19pb21lbQkJCSpjb25maWdfcmVnczsK
Kwljb25zdCBzdHJ1Y3QgbXRrX21tc3lzX3JlZ19kYXRhICptbXN5c19yZWdfZGF0YTsKIAlzdHJ1
Y3QgbXRrX2Rpc3BfbXV0ZXgJCSptdXRleDsKIAl1bnNpZ25lZCBpbnQJCQlkZHBfY29tcF9ucjsK
IAlzdHJ1Y3QgbXRrX2RkcF9jb21wCQkqKmRkcF9jb21wOwpAQCAtMjcwLDYgKzI3MSw3IEBAIHN0
YXRpYyBpbnQgbXRrX2NydGNfZGRwX2h3X2luaXQoc3RydWN0IG10a19kcm1fY3J0YyAqbXRrX2Ny
dGMpCiAJRFJNX0RFQlVHX0RSSVZFUigibWVkaWF0ZWtfZGRwX2RkcF9wYXRoX3NldHVwXG4iKTsK
IAlmb3IgKGkgPSAwOyBpIDwgbXRrX2NydGMtPmRkcF9jb21wX25yIC0gMTsgaSsrKSB7CiAJCW10
a19kZHBfYWRkX2NvbXBfdG9fcGF0aChtdGtfY3J0Yy0+Y29uZmlnX3JlZ3MsCisJCQkJCSBtdGtf
Y3J0Yy0+bW1zeXNfcmVnX2RhdGEsCiAJCQkJCSBtdGtfY3J0Yy0+ZGRwX2NvbXBbaV0tPmlkLAog
CQkJCQkgbXRrX2NydGMtPmRkcF9jb21wW2kgKyAxXS0+aWQpOwogCQltdGtfZGlzcF9tdXRleF9h
ZGRfY29tcChtdGtfY3J0Yy0+bXV0ZXgsCkBAIC0zMTgsNiArMzIwLDcgQEAgc3RhdGljIHZvaWQg
bXRrX2NydGNfZGRwX2h3X2Zpbmkoc3RydWN0IG10a19kcm1fY3J0YyAqbXRrX2NydGMpCiAJbXRr
X2Rpc3BfbXV0ZXhfZGlzYWJsZShtdGtfY3J0Yy0+bXV0ZXgpOwogCWZvciAoaSA9IDA7IGkgPCBt
dGtfY3J0Yy0+ZGRwX2NvbXBfbnIgLSAxOyBpKyspIHsKIAkJbXRrX2RkcF9yZW1vdmVfY29tcF9m
cm9tX3BhdGgobXRrX2NydGMtPmNvbmZpZ19yZWdzLAorCQkJCQkgICAgICBtdGtfY3J0Yy0+bW1z
eXNfcmVnX2RhdGEsCiAJCQkJCSAgICAgIG10a19jcnRjLT5kZHBfY29tcFtpXS0+aWQsCiAJCQkJ
CSAgICAgIG10a19jcnRjLT5kZHBfY29tcFtpICsgMV0tPmlkKTsKIAkJbXRrX2Rpc3BfbXV0ZXhf
cmVtb3ZlX2NvbXAobXRrX2NydGMtPm11dGV4LApAQCAtNTQ5LDYgKzU1Miw3IEBAIGludCBtdGtf
ZHJtX2NydGNfY3JlYXRlKHN0cnVjdCBkcm1fZGV2aWNlICpkcm1fZGV2LAogCQlyZXR1cm4gLUVO
T01FTTsKIAogCW10a19jcnRjLT5jb25maWdfcmVncyA9IHByaXYtPmNvbmZpZ19yZWdzOworCW10
a19jcnRjLT5tbXN5c19yZWdfZGF0YSA9IHByaXYtPmRhdGEtPnJlZ19kYXRhOwogCW10a19jcnRj
LT5kZHBfY29tcF9uciA9IHBhdGhfbGVuOwogCW10a19jcnRjLT5kZHBfY29tcCA9IGRldm1fa21h
bGxvY19hcnJheShkZXYsIG10a19jcnRjLT5kZHBfY29tcF9uciwKIAkJCQkJCXNpemVvZigqbXRr
X2NydGMtPmRkcF9jb21wKSwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9t
dGtfZHJtX2RkcC5jIGIvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fZGRwLmMKaW5k
ZXggNDdiM2UzNS4uNzgxOWZkMzEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRl
ay9tdGtfZHJtX2RkcC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2Rk
cC5jCkBAIC0xNzUsNiArMTc1LDE5IEBAIHN0cnVjdCBtdGtfZGRwIHsKIAljb25zdCBzdHJ1Y3Qg
bXRrX2RkcF9kYXRhCSpkYXRhOwogfTsKIAorc3RydWN0IG10a19tbXN5c19yZWdfZGF0YSB7CisJ
dTMyIG92bDBfbW91dF9lbjsKKwl1MzIgcmRtYTBfc291dF9zZWxfaW47CisJdTMyIHJkbWEwX3Nv
dXRfY29sb3IwOworCXUzMiByZG1hMV9zb3V0X3NlbF9pbjsKKwl1MzIgcmRtYTFfc291dF9kcGkw
OworCXUzMiByZG1hMV9zb3V0X2RzaTA7CisJdTMyIGRwaTBfc2VsX2luOworCXUzMiBkcGkwX3Nl
bF9pbl9yZG1hMTsKKwl1MzIgZHNpMF9zZWxfaW47CisJdTMyIGRzaTBfc2VsX2luX3JkbWExOwor
fTsKKwogc3RhdGljIGNvbnN0IHVuc2lnbmVkIGludCBtdDI3MDFfbXV0ZXhfbW9kW0REUF9DT01Q
T05FTlRfSURfTUFYXSA9IHsKIAlbRERQX0NPTVBPTkVOVF9CTFNdID0gTVQyNzAxX01VVEVYX01P
RF9ESVNQX0JMUywKIAlbRERQX0NPTVBPTkVOVF9DT0xPUjBdID0gTVQyNzAxX01VVEVYX01PRF9E
SVNQX0NPTE9SLApAQCAtMjUzLDE3ICsyNjYsMzQgQEAgc3RydWN0IG10a19kZHAgewogCS5tdXRl
eF9zb2ZfcmVnID0gTVQyNzAxX0RJU1BfTVVURVgwX1NPRjAsCiB9OwogCi1zdGF0aWMgdW5zaWdu
ZWQgaW50IG10a19kZHBfbW91dF9lbihlbnVtIG10a19kZHBfY29tcF9pZCBjdXIsCitjb25zdCBz
dHJ1Y3QgbXRrX21tc3lzX3JlZ19kYXRhIG10MjcwMV9tbXN5c19yZWdfZGF0YSA9IHsKKwkub3Zs
MF9tb3V0X2VuID0gRElTUF9SRUdfQ09ORklHX0RJU1BfT1ZMX01PVVRfRU4sCisJLmRzaTBfc2Vs
X2luID0gRElTUF9SRUdfQ09ORklHX0RTSV9TRUwsCisJLmRzaTBfc2VsX2luX3JkbWExID0gRFNJ
X1NFTF9JTl9SRE1BLAorfTsKKworY29uc3Qgc3RydWN0IG10a19tbXN5c19yZWdfZGF0YSBtdDgx
NzNfbW1zeXNfcmVnX2RhdGEgPSB7CisJLm92bDBfbW91dF9lbiA9IERJU1BfUkVHX0NPTkZJR19E
SVNQX09WTDBfTU9VVF9FTiwKKwkucmRtYTFfc291dF9zZWxfaW4gPSBESVNQX1JFR19DT05GSUdf
RElTUF9SRE1BMV9TT1VUX0VOLAorCS5yZG1hMV9zb3V0X2RwaTAgPSBSRE1BMV9TT1VUX0RQSTAs
CisJLmRwaTBfc2VsX2luID0gRElTUF9SRUdfQ09ORklHX0RQSV9TRUxfSU4sCisJLmRwaTBfc2Vs
X2luX3JkbWExID0gRFBJMF9TRUxfSU5fUkRNQTEsCisJLmRzaTBfc2VsX2luID0gRElTUF9SRUdf
Q09ORklHX0RTSUVfU0VMX0lOLAorCS5kc2kwX3NlbF9pbl9yZG1hMSA9IERTSTBfU0VMX0lOX1JE
TUExLAorfTsKKworc3RhdGljIHVuc2lnbmVkIGludCBtdGtfZGRwX21vdXRfZW4oY29uc3Qgc3Ry
dWN0IG10a19tbXN5c19yZWdfZGF0YSAqZGF0YSwKKwkJCQkgICAgZW51bSBtdGtfZGRwX2NvbXBf
aWQgY3VyLAogCQkJCSAgICBlbnVtIG10a19kZHBfY29tcF9pZCBuZXh0LAogCQkJCSAgICB1bnNp
Z25lZCBpbnQgKmFkZHIpCiB7CiAJdW5zaWduZWQgaW50IHZhbHVlOwogCiAJaWYgKGN1ciA9PSBE
RFBfQ09NUE9ORU5UX09WTDAgJiYgbmV4dCA9PSBERFBfQ09NUE9ORU5UX0NPTE9SMCkgewotCQkq
YWRkciA9IERJU1BfUkVHX0NPTkZJR19ESVNQX09WTDBfTU9VVF9FTjsKKwkJKmFkZHIgPSBkYXRh
LT5vdmwwX21vdXRfZW47CiAJCXZhbHVlID0gT1ZMMF9NT1VUX0VOX0NPTE9SMDsKIAl9IGVsc2Ug
aWYgKGN1ciA9PSBERFBfQ09NUE9ORU5UX09WTDAgJiYgbmV4dCA9PSBERFBfQ09NUE9ORU5UX1JE
TUEwKSB7Ci0JCSphZGRyID0gRElTUF9SRUdfQ09ORklHX0RJU1BfT1ZMX01PVVRfRU47CisJCSph
ZGRyID0gZGF0YS0+b3ZsMF9tb3V0X2VuOwogCQl2YWx1ZSA9IE9WTF9NT1VUX0VOX1JETUE7CiAJ
fSBlbHNlIGlmIChjdXIgPT0gRERQX0NPTVBPTkVOVF9PRDAgJiYgbmV4dCA9PSBERFBfQ09NUE9O
RU5UX1JETUEwKSB7CiAJCSphZGRyID0gRElTUF9SRUdfQ09ORklHX0RJU1BfT0RfTU9VVF9FTjsK
QEAgLTMwNSw4ICszMzUsOCBAQCBzdGF0aWMgdW5zaWduZWQgaW50IG10a19kZHBfbW91dF9lbihl
bnVtIG10a19kZHBfY29tcF9pZCBjdXIsCiAJCSphZGRyID0gRElTUF9SRUdfQ09ORklHX0RJU1Bf
UkRNQTFfU09VVF9FTjsKIAkJdmFsdWUgPSBSRE1BMV9TT1VUX0RTSTM7CiAJfSBlbHNlIGlmIChj
dXIgPT0gRERQX0NPTVBPTkVOVF9SRE1BMSAmJiBuZXh0ID09IEREUF9DT01QT05FTlRfRFBJMCkg
ewotCQkqYWRkciA9IERJU1BfUkVHX0NPTkZJR19ESVNQX1JETUExX1NPVVRfRU47Ci0JCXZhbHVl
ID0gUkRNQTFfU09VVF9EUEkwOworCQkqYWRkciA9IGRhdGEtPnJkbWExX3NvdXRfc2VsX2luOwor
CQl2YWx1ZSA9IGRhdGEtPnJkbWExX3NvdXRfZHBpMDsKIAl9IGVsc2UgaWYgKGN1ciA9PSBERFBf
Q09NUE9ORU5UX1JETUExICYmIG5leHQgPT0gRERQX0NPTVBPTkVOVF9EUEkxKSB7CiAJCSphZGRy
ID0gRElTUF9SRUdfQ09ORklHX0RJU1BfUkRNQTFfU09VVF9FTjsKIAkJdmFsdWUgPSBSRE1BMV9T
T1VUX0RQSTE7CkBAIC0zMzIsNyArMzYyLDggQEAgc3RhdGljIHVuc2lnbmVkIGludCBtdGtfZGRw
X21vdXRfZW4oZW51bSBtdGtfZGRwX2NvbXBfaWQgY3VyLAogCXJldHVybiB2YWx1ZTsKIH0KIAot
c3RhdGljIHVuc2lnbmVkIGludCBtdGtfZGRwX3NlbF9pbihlbnVtIG10a19kZHBfY29tcF9pZCBj
dXIsCitzdGF0aWMgdW5zaWduZWQgaW50IG10a19kZHBfc2VsX2luKGNvbnN0IHN0cnVjdCBtdGtf
bW1zeXNfcmVnX2RhdGEgKmRhdGEsCisJCQkJICAgZW51bSBtdGtfZGRwX2NvbXBfaWQgY3VyLAog
CQkJCSAgIGVudW0gbXRrX2RkcF9jb21wX2lkIG5leHQsCiAJCQkJICAgdW5zaWduZWQgaW50ICph
ZGRyKQogewpAQCAtMzQyLDE0ICszNzMsMTQgQEAgc3RhdGljIHVuc2lnbmVkIGludCBtdGtfZGRw
X3NlbF9pbihlbnVtIG10a19kZHBfY29tcF9pZCBjdXIsCiAJCSphZGRyID0gRElTUF9SRUdfQ09O
RklHX0RJU1BfQ09MT1IwX1NFTF9JTjsKIAkJdmFsdWUgPSBDT0xPUjBfU0VMX0lOX09WTDA7CiAJ
fSBlbHNlIGlmIChjdXIgPT0gRERQX0NPTVBPTkVOVF9SRE1BMSAmJiBuZXh0ID09IEREUF9DT01Q
T05FTlRfRFBJMCkgewotCQkqYWRkciA9IERJU1BfUkVHX0NPTkZJR19EUElfU0VMX0lOOwotCQl2
YWx1ZSA9IERQSTBfU0VMX0lOX1JETUExOworCQkqYWRkciA9IGRhdGEtPmRwaTBfc2VsX2luOwor
CQl2YWx1ZSA9IGRhdGEtPmRwaTBfc2VsX2luX3JkbWExOwogCX0gZWxzZSBpZiAoY3VyID09IERE
UF9DT01QT05FTlRfUkRNQTEgJiYgbmV4dCA9PSBERFBfQ09NUE9ORU5UX0RQSTEpIHsKIAkJKmFk
ZHIgPSBESVNQX1JFR19DT05GSUdfRFBJX1NFTF9JTjsKIAkJdmFsdWUgPSBEUEkxX1NFTF9JTl9S
RE1BMTsKIAl9IGVsc2UgaWYgKGN1ciA9PSBERFBfQ09NUE9ORU5UX1JETUExICYmIG5leHQgPT0g
RERQX0NPTVBPTkVOVF9EU0kwKSB7Ci0JCSphZGRyID0gRElTUF9SRUdfQ09ORklHX0RTSUVfU0VM
X0lOOwotCQl2YWx1ZSA9IERTSTBfU0VMX0lOX1JETUExOworCQkqYWRkciA9IGRhdGEtPmRzaTBf
c2VsX2luOworCQl2YWx1ZSA9IGRhdGEtPmRzaTBfc2VsX2luX3JkbWExOwogCX0gZWxzZSBpZiAo
Y3VyID09IEREUF9DT01QT05FTlRfUkRNQTEgJiYgbmV4dCA9PSBERFBfQ09NUE9ORU5UX0RTSTEp
IHsKIAkJKmFkZHIgPSBESVNQX1JFR19DT05GSUdfRFNJT19TRUxfSU47CiAJCXZhbHVlID0gRFNJ
MV9TRUxfSU5fUkRNQTE7CkBAIC0zOTAsMzcgKzQyMSw0NCBAQCBzdGF0aWMgdW5zaWduZWQgaW50
IG10a19kZHBfc2VsX2luKGVudW0gbXRrX2RkcF9jb21wX2lkIGN1ciwKIAlyZXR1cm4gdmFsdWU7
CiB9CiAKLXN0YXRpYyB2b2lkIG10a19kZHBfc291dF9zZWwodm9pZCBfX2lvbWVtICpjb25maWdf
cmVncywKLQkJCSAgICAgZW51bSBtdGtfZGRwX2NvbXBfaWQgY3VyLAotCQkJICAgICBlbnVtIG10
a19kZHBfY29tcF9pZCBuZXh0KQorc3RhdGljIHVuc2lnbmVkIGludCBtdGtfZGRwX3NvdXRfc2Vs
KGNvbnN0IHN0cnVjdCBtdGtfbW1zeXNfcmVnX2RhdGEgKmRhdGEsCisJCQkJICAgICBlbnVtIG10
a19kZHBfY29tcF9pZCBjdXIsCisJCQkJICAgICBlbnVtIG10a19kZHBfY29tcF9pZCBuZXh0LAor
CQkJCSAgICAgdW5zaWduZWQgaW50ICphZGRyKQogeworCXVuc2lnbmVkIGludCB2YWx1ZTsKKwog
CWlmIChjdXIgPT0gRERQX0NPTVBPTkVOVF9CTFMgJiYgbmV4dCA9PSBERFBfQ09NUE9ORU5UX0RT
STApIHsKLQkJd3JpdGVsX3JlbGF4ZWQoQkxTX1RPX0RTSV9SRE1BMV9UT19EUEkxLAotCQkJICAg
ICAgIGNvbmZpZ19yZWdzICsgRElTUF9SRUdfQ09ORklHX09VVF9TRUwpOworCQkqYWRkciA9IERJ
U1BfUkVHX0NPTkZJR19PVVRfU0VMOworCQl2YWx1ZSA9IEJMU19UT19EU0lfUkRNQTFfVE9fRFBJ
MTsKIAl9IGVsc2UgaWYgKGN1ciA9PSBERFBfQ09NUE9ORU5UX0JMUyAmJiBuZXh0ID09IEREUF9D
T01QT05FTlRfRFBJMCkgewotCQl3cml0ZWxfcmVsYXhlZChCTFNfVE9fRFBJX1JETUExX1RPX0RT
SSwKLQkJCSAgICAgICBjb25maWdfcmVncyArIERJU1BfUkVHX0NPTkZJR19PVVRfU0VMKTsKLQl9
IGVsc2UgaWYgKGN1ciA9PSBERFBfQ09NUE9ORU5UX1JETUExICYmIG5leHQgPT0gRERQX0NPTVBP
TkVOVF9EU0kwKSB7Ci0JCXdyaXRlbF9yZWxheGVkKERTSV9TRUxfSU5fUkRNQSwKLQkJCSAgICAg
ICBjb25maWdfcmVncyArIERJU1BfUkVHX0NPTkZJR19EU0lfU0VMKTsKKwkJKmFkZHIgPSBESVNQ
X1JFR19DT05GSUdfT1VUX1NFTDsKKwkJdmFsdWUgPSBCTFNfVE9fRFBJX1JETUExX1RPX0RTSTsK
Kwl9IGVsc2UgeworCQl2YWx1ZSA9IDA7CiAJfQorCisJcmV0dXJuIHZhbHVlOwogfQogCiB2b2lk
IG10a19kZHBfYWRkX2NvbXBfdG9fcGF0aCh2b2lkIF9faW9tZW0gKmNvbmZpZ19yZWdzLAorCQkJ
ICAgICAgY29uc3Qgc3RydWN0IG10a19tbXN5c19yZWdfZGF0YSAqcmVnX2RhdGEsCiAJCQkgICAg
ICBlbnVtIG10a19kZHBfY29tcF9pZCBjdXIsCiAJCQkgICAgICBlbnVtIG10a19kZHBfY29tcF9p
ZCBuZXh0KQogewogCXVuc2lnbmVkIGludCBhZGRyLCB2YWx1ZSwgcmVnOwogCi0JdmFsdWUgPSBt
dGtfZGRwX21vdXRfZW4oY3VyLCBuZXh0LCAmYWRkcik7CisJdmFsdWUgPSBtdGtfZGRwX21vdXRf
ZW4ocmVnX2RhdGEsIGN1ciwgbmV4dCwgJmFkZHIpOwogCWlmICh2YWx1ZSkgewogCQlyZWcgPSBy
ZWFkbF9yZWxheGVkKGNvbmZpZ19yZWdzICsgYWRkcikgfCB2YWx1ZTsKIAkJd3JpdGVsX3JlbGF4
ZWQocmVnLCBjb25maWdfcmVncyArIGFkZHIpOwogCX0KIAotCW10a19kZHBfc291dF9zZWwoY29u
ZmlnX3JlZ3MsIGN1ciwgbmV4dCk7CisJdmFsdWUgPSBtdGtfZGRwX3NvdXRfc2VsKHJlZ19kYXRh
LCBjdXIsIG5leHQsICZhZGRyKTsKKwlpZiAodmFsdWUpCisJCXdyaXRlbF9yZWxheGVkKHZhbHVl
LCBjb25maWdfcmVncyArIGFkZHIpOwogCi0JdmFsdWUgPSBtdGtfZGRwX3NlbF9pbihjdXIsIG5l
eHQsICZhZGRyKTsKKwl2YWx1ZSA9IG10a19kZHBfc2VsX2luKHJlZ19kYXRhLCBjdXIsIG5leHQs
ICZhZGRyKTsKIAlpZiAodmFsdWUpIHsKIAkJcmVnID0gcmVhZGxfcmVsYXhlZChjb25maWdfcmVn
cyArIGFkZHIpIHwgdmFsdWU7CiAJCXdyaXRlbF9yZWxheGVkKHJlZywgY29uZmlnX3JlZ3MgKyBh
ZGRyKTsKQEAgLTQyOCwxOCArNDY2LDE5IEBAIHZvaWQgbXRrX2RkcF9hZGRfY29tcF90b19wYXRo
KHZvaWQgX19pb21lbSAqY29uZmlnX3JlZ3MsCiB9CiAKIHZvaWQgbXRrX2RkcF9yZW1vdmVfY29t
cF9mcm9tX3BhdGgodm9pZCBfX2lvbWVtICpjb25maWdfcmVncywKKwkJCQkgICBjb25zdCBzdHJ1
Y3QgbXRrX21tc3lzX3JlZ19kYXRhICpyZWdfZGF0YSwKIAkJCQkgICBlbnVtIG10a19kZHBfY29t
cF9pZCBjdXIsCiAJCQkJICAgZW51bSBtdGtfZGRwX2NvbXBfaWQgbmV4dCkKIHsKIAl1bnNpZ25l
ZCBpbnQgYWRkciwgdmFsdWUsIHJlZzsKIAotCXZhbHVlID0gbXRrX2RkcF9tb3V0X2VuKGN1ciwg
bmV4dCwgJmFkZHIpOworCXZhbHVlID0gbXRrX2RkcF9tb3V0X2VuKHJlZ19kYXRhLCBjdXIsIG5l
eHQsICZhZGRyKTsKIAlpZiAodmFsdWUpIHsKIAkJcmVnID0gcmVhZGxfcmVsYXhlZChjb25maWdf
cmVncyArIGFkZHIpICYgfnZhbHVlOwogCQl3cml0ZWxfcmVsYXhlZChyZWcsIGNvbmZpZ19yZWdz
ICsgYWRkcik7CiAJfQogCi0JdmFsdWUgPSBtdGtfZGRwX3NlbF9pbihjdXIsIG5leHQsICZhZGRy
KTsKKwl2YWx1ZSA9IG10a19kZHBfc2VsX2luKHJlZ19kYXRhLCBjdXIsIG5leHQsICZhZGRyKTsK
IAlpZiAodmFsdWUpIHsKIAkJcmVnID0gcmVhZGxfcmVsYXhlZChjb25maWdfcmVncyArIGFkZHIp
ICYgfnZhbHVlOwogCQl3cml0ZWxfcmVsYXhlZChyZWcsIGNvbmZpZ19yZWdzICsgYWRkcik7CmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9kZHAuaCBiL2RyaXZl
cnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2RkcC5oCmluZGV4IGY5YTc5OTEuLjQzZGFiYjYg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2RkcC5oCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2RkcC5oCkBAIC0xOSwxMSArMTksMTYg
QEAKIHN0cnVjdCByZWdtYXA7CiBzdHJ1Y3QgZGV2aWNlOwogc3RydWN0IG10a19kaXNwX211dGV4
Oworc3RydWN0IG10a19tbXN5c19yZWdfZGF0YTsKIAorZXh0ZXJuIGNvbnN0IHN0cnVjdCBtdGtf
bW1zeXNfcmVnX2RhdGEgbXQyNzAxX21tc3lzX3JlZ19kYXRhOworZXh0ZXJuIGNvbnN0IHN0cnVj
dCBtdGtfbW1zeXNfcmVnX2RhdGEgbXQ4MTczX21tc3lzX3JlZ19kYXRhOwogdm9pZCBtdGtfZGRw
X2FkZF9jb21wX3RvX3BhdGgodm9pZCBfX2lvbWVtICpjb25maWdfcmVncywKKwkJCSAgICAgIGNv
bnN0IHN0cnVjdCBtdGtfbW1zeXNfcmVnX2RhdGEgKnJlZ19kYXRhLAogCQkJICAgICAgZW51bSBt
dGtfZGRwX2NvbXBfaWQgY3VyLAogCQkJICAgICAgZW51bSBtdGtfZGRwX2NvbXBfaWQgbmV4dCk7
CiB2b2lkIG10a19kZHBfcmVtb3ZlX2NvbXBfZnJvbV9wYXRoKHZvaWQgX19pb21lbSAqY29uZmln
X3JlZ3MsCisJCQkJICAgY29uc3Qgc3RydWN0IG10a19tbXN5c19yZWdfZGF0YSAqcmVnX2RhdGEs
CiAJCQkJICAgZW51bSBtdGtfZGRwX2NvbXBfaWQgY3VyLAogCQkJCSAgIGVudW0gbXRrX2RkcF9j
b21wX2lkIG5leHQpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRr
X2RybV9kcnYuYyBiL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2Rydi5jCmluZGV4
IDU3Y2U0NzAuLjVmOTQyNTkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9t
dGtfZHJtX2Rydi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2Rydi5j
CkBAIC0xOTcsNiArMTk3LDcgQEAgc3RhdGljIGludCBtdGtfYXRvbWljX2NvbW1pdChzdHJ1Y3Qg
ZHJtX2RldmljZSAqZHJtLAogCS5tYWluX2xlbiA9IEFSUkFZX1NJWkUobXQyNzAxX210a19kZHBf
bWFpbiksCiAJLmV4dF9wYXRoID0gbXQyNzAxX210a19kZHBfZXh0LAogCS5leHRfbGVuID0gQVJS
QVlfU0laRShtdDI3MDFfbXRrX2RkcF9leHQpLAorCS5yZWdfZGF0YSA9ICZtdDI3MDFfbW1zeXNf
cmVnX2RhdGEsCiAJLnNoYWRvd19yZWdpc3RlciA9IHRydWUsCiB9OwogCkBAIC0yMDcsNiArMjA4
LDcgQEAgc3RhdGljIGludCBtdGtfYXRvbWljX2NvbW1pdChzdHJ1Y3QgZHJtX2RldmljZSAqZHJt
LAogCS5leHRfbGVuID0gQVJSQVlfU0laRShtdDI3MTJfbXRrX2RkcF9leHQpLAogCS50aGlyZF9w
YXRoID0gbXQyNzEyX210a19kZHBfdGhpcmQsCiAJLnRoaXJkX2xlbiA9IEFSUkFZX1NJWkUobXQy
NzEyX210a19kZHBfdGhpcmQpLAorCS5yZWdfZGF0YSA9ICZtdDgxNzNfbW1zeXNfcmVnX2RhdGEs
CiB9OwogCiBzdGF0aWMgY29uc3Qgc3RydWN0IG10a19tbXN5c19kcml2ZXJfZGF0YSBtdDgxNzNf
bW1zeXNfZHJpdmVyX2RhdGEgPSB7CkBAIC0yMTQsNiArMjE2LDcgQEAgc3RhdGljIGludCBtdGtf
YXRvbWljX2NvbW1pdChzdHJ1Y3QgZHJtX2RldmljZSAqZHJtLAogCS5tYWluX2xlbiA9IEFSUkFZ
X1NJWkUobXQ4MTczX210a19kZHBfbWFpbiksCiAJLmV4dF9wYXRoID0gbXQ4MTczX210a19kZHBf
ZXh0LAogCS5leHRfbGVuID0gQVJSQVlfU0laRShtdDgxNzNfbXRrX2RkcF9leHQpLAorCS5yZWdf
ZGF0YSA9ICZtdDgxNzNfbW1zeXNfcmVnX2RhdGEsCiB9OwogCiBzdGF0aWMgaW50IG10a19kcm1f
a21zX2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRybSkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9tZWRpYXRlay9tdGtfZHJtX2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210
a19kcm1fZHJ2LmgKaW5kZXggZWNjMDBjYS4uMWU2ZDc0YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL21lZGlhdGVrL210a19kcm1fZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL21lZGlh
dGVrL210a19kcm1fZHJ2LmgKQEAgLTE1LDYgKzE1LDcgQEAKICNkZWZpbmUgTVRLX0RSTV9EUlZf
SAogCiAjaW5jbHVkZSA8bGludXgvaW8uaD4KKyNpbmNsdWRlICJtdGtfZHJtX2RkcC5oIgogI2lu
Y2x1ZGUgIm10a19kcm1fZGRwX2NvbXAuaCIKIAogI2RlZmluZSBNQVhfQ1JUQwkzCkBAIC0zNiw2
ICszNyw4IEBAIHN0cnVjdCBtdGtfbW1zeXNfZHJpdmVyX2RhdGEgewogCWNvbnN0IGVudW0gbXRr
X2RkcF9jb21wX2lkICp0aGlyZF9wYXRoOwogCXVuc2lnbmVkIGludCB0aGlyZF9sZW47CiAKKwlj
b25zdCBzdHJ1Y3QgbXRrX21tc3lzX3JlZ19kYXRhICpyZWdfZGF0YTsKKwogCWJvb2wgc2hhZG93
X3JlZ2lzdGVyOwogfTsKIAotLSAKMS44LjEuMS5kaXJ0eQoKX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2
ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21h
aWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
