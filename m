Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 7F61A115095
	for <lists+dri-devel@lfdr.de>; Fri,  6 Dec 2019 13:47:23 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6A6BF6FA04;
	Fri,  6 Dec 2019 12:47:20 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3900E6F9FF
 for <dri-devel@lists.freedesktop.org>; Fri,  6 Dec 2019 12:47:18 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id AE296B3F0;
 Fri,  6 Dec 2019 12:47:16 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: airlied@redhat.com, daniel@ffwll.ch, sam@ravnborg.org, kraxel@redhat.com,
 emil.velikov@collabora.com, noralf@tronnes.org, zboszor@pr.hu
Subject: [PATCH v2 2/9] drm/udl: Convert to struct drm_simple_display_pipe
Date: Fri,  6 Dec 2019 13:47:06 +0100
Message-Id: <20191206124713.5748-3-tzimmermann@suse.de>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191206124713.5748-1-tzimmermann@suse.de>
References: <20191206124713.5748-1-tzimmermann@suse.de>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Zimmermann <tzimmermann@suse.de>, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VWRsIGhhcyBhIHNpbmdsZSBkaXNwbGF5IHBpcGVsaW5lIHdpdGggYSBwcmltYXJ5IHBsYW5lOyBw
ZXJmZWN0IGZvcgpzaW1wbGUtcGlwZSBoZWxwZXJzLiBDb252ZXJ0IGl0IG92ZXIuIFRoZSBvbGQg
ZW5jb2RlciBhbmQgQ1JUQyBjb2RlCmJlY29tZXMgdW51c2VkIGFuZCBvYnNvbGV0ZS4KCkV4cG9y
dGVkIGZvcm1hdHMgZm9yIHRoZSBwcmltYXJ5IHBsYW5lIGFyZSBSR0I1NjUgYW5kIFhSR0I4ODg4
LCB3aXRoCnRoZSBsYXR0ZXIgYmVpbmcgZW11bGF0ZWQuIFRoZSAxNi1iaXQgZm9ybWF0IGlzIHRo
ZSBkZWZhdWx0IGFuZCB3aGF0CmlzIHVzZWQgd2hlbiBjb21tdW5pY2F0aW5nIHdpdGggdGhlIGRl
dmljZS4KClRoaXMgcGF0Y2ggZW5hYmxlcyBhdG9taWMgbW9kZXNldHRpbmcgZm9yIHVkbCBkZXZp
Y2VzLgoKdjI6CgkqIG1vdmUgc3VzcGVuZC9yZXN1bWUgY2hhbmdlcyBpbnRvIHNlcGFyYXRlIHBh
dGNoCgkqIHJlbW92ZSBub24tYXRvbWljIGNvZGUKClNpZ25lZC1vZmYtYnk6IFRob21hcyBaaW1t
ZXJtYW5uIDx0emltbWVybWFubkBzdXNlLmRlPgotLS0KIGRyaXZlcnMvZ3B1L2RybS91ZGwvTWFr
ZWZpbGUgICAgICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vdWRsL3VkbF9jb25uZWN0b3Iu
YyB8ICAxMiArLQogZHJpdmVycy9ncHUvZHJtL3VkbC91ZGxfZHJ2LmMgICAgICAgfCAgIDIgKy0K
IGRyaXZlcnMvZ3B1L2RybS91ZGwvdWRsX2Rydi5oICAgICAgIHwgICA2ICstCiBkcml2ZXJzL2dw
dS9kcm0vdWRsL3VkbF9lbmNvZGVyLmMgICB8ICA3MCAtLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1
L2RybS91ZGwvdWRsX21vZGVzZXQuYyAgIHwgMTcwICsrKysrKysrKysrKystLS0tLS0tLS0tLS0t
LS0KIDYgZmlsZXMgY2hhbmdlZCwgODcgaW5zZXJ0aW9ucygrKSwgMTc1IGRlbGV0aW9ucygtKQog
ZGVsZXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS91ZGwvdWRsX2VuY29kZXIuYwoKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS91ZGwvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0v
dWRsL01ha2VmaWxlCmluZGV4IDljNDI4MjBhZTMzZC4uMTc3Y2U3NGY0Y2Y0IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vdWRsL01ha2VmaWxlCisrKyBiL2RyaXZlcnMvZ3B1L2RybS91ZGwv
TWFrZWZpbGUKQEAgLTEsNCArMSw0IEBACiAjIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwt
Mi4wLW9ubHkKLXVkbC15IDo9IHVkbF9kcnYubyB1ZGxfbW9kZXNldC5vIHVkbF9jb25uZWN0b3Iu
byB1ZGxfZW5jb2Rlci5vIHVkbF9tYWluLm8gdWRsX2ZiLm8gdWRsX3RyYW5zZmVyLm8gdWRsX2dl
bS5vCit1ZGwteSA6PSB1ZGxfZHJ2Lm8gdWRsX21vZGVzZXQubyB1ZGxfY29ubmVjdG9yLm8gdWRs
X21haW4ubyB1ZGxfZmIubyB1ZGxfdHJhbnNmZXIubyB1ZGxfZ2VtLm8KIAogb2JqLSQoQ09ORklH
X0RSTV9VREwpIDo9IHVkbC5vCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdWRsL3VkbF9j
b25uZWN0b3IuYyBiL2RyaXZlcnMvZ3B1L2RybS91ZGwvdWRsX2Nvbm5lY3Rvci5jCmluZGV4IGIx
ZDJmMzhlMzdlMC4uZTk2NzFkMzhiNGEwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdWRs
L3VkbF9jb25uZWN0b3IuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdWRsL3VkbF9jb25uZWN0b3Iu
YwpAQCAtNyw2ICs3LDcgQEAKICAqIENvcHlyaWdodCAoQykgMjAwOSBCZXJuaWUgVGhvbXBzb24g
PGJlcm5pZUBwbHVnYWJsZS5jb20+CiAgKi8KIAorI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljX3N0
YXRlX2hlbHBlci5oPgogI2luY2x1ZGUgPGRybS9kcm1fY3J0Y19oZWxwZXIuaD4KICNpbmNsdWRl
IDxkcm0vZHJtX3Byb2JlX2hlbHBlci5oPgogCkBAIC05MCwxMyArOTEsNiBAQCB1ZGxfZGV0ZWN0
KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsIGJvb2wgZm9yY2UpCiAJcmV0dXJuIGNv
bm5lY3Rvcl9zdGF0dXNfY29ubmVjdGVkOwogfQogCi1zdGF0aWMgaW50IHVkbF9jb25uZWN0b3Jf
c2V0X3Byb3BlcnR5KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCi0JCQkJICAgICAg
c3RydWN0IGRybV9wcm9wZXJ0eSAqcHJvcGVydHksCi0JCQkJICAgICAgdWludDY0X3QgdmFsKQot
ewotCXJldHVybiAwOwotfQotCiBzdGF0aWMgdm9pZCB1ZGxfY29ubmVjdG9yX2Rlc3Ryb3koc3Ry
dWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKIHsKIAlzdHJ1Y3QgdWRsX2RybV9jb25uZWN0
b3IgKnVkbF9jb25uZWN0b3IgPQpAQCAtMTE2LDEwICsxMTAsMTIgQEAgc3RhdGljIGNvbnN0IHN0
cnVjdCBkcm1fY29ubmVjdG9yX2hlbHBlcl9mdW5jcyB1ZGxfY29ubmVjdG9yX2hlbHBlcl9mdW5j
cyA9IHsKIAogc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX2Z1bmNzIHVkbF9jb25u
ZWN0b3JfZnVuY3MgPSB7CiAJLmRwbXMgPSBkcm1faGVscGVyX2Nvbm5lY3Rvcl9kcG1zLAorCS5y
ZXNldCA9IGRybV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9yZXNldCwKIAkuZGV0ZWN0ID0gdWRs
X2RldGVjdCwKIAkuZmlsbF9tb2RlcyA9IGRybV9oZWxwZXJfcHJvYmVfc2luZ2xlX2Nvbm5lY3Rv
cl9tb2RlcywKIAkuZGVzdHJveSA9IHVkbF9jb25uZWN0b3JfZGVzdHJveSwKLQkuc2V0X3Byb3Bl
cnR5ID0gdWRsX2Nvbm5lY3Rvcl9zZXRfcHJvcGVydHksCisJLmF0b21pY19kdXBsaWNhdGVfc3Rh
dGUgPSBkcm1fYXRvbWljX2hlbHBlcl9jb25uZWN0b3JfZHVwbGljYXRlX3N0YXRlLAorCS5hdG9t
aWNfZGVzdHJveV9zdGF0ZSAgID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2Rlc3Ryb3lf
c3RhdGUsCiB9OwogCiBzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqdWRsX2Nvbm5lY3Rvcl9pbml0KHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdWRsL3Vk
bF9kcnYuYyBiL2RyaXZlcnMvZ3B1L2RybS91ZGwvdWRsX2Rydi5jCmluZGV4IGQ1NzgzZmEzMmM1
Yi4uYWViOTY5MjA3NTdjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdWRsL3VkbF9kcnYu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vdWRsL3VkbF9kcnYuYwpAQCAtNDUsNyArNDUsNyBAQCBz
dGF0aWMgdm9pZCB1ZGxfZHJpdmVyX3JlbGVhc2Uoc3RydWN0IGRybV9kZXZpY2UgKmRldikKIH0K
IAogc3RhdGljIHN0cnVjdCBkcm1fZHJpdmVyIGRyaXZlciA9IHsKLQkuZHJpdmVyX2ZlYXR1cmVz
ID0gRFJJVkVSX01PREVTRVQgfCBEUklWRVJfR0VNLAorCS5kcml2ZXJfZmVhdHVyZXMgPSBEUklW
RVJfQVRPTUlDIHwgRFJJVkVSX0dFTSB8IERSSVZFUl9NT0RFU0VULAogCS5yZWxlYXNlID0gdWRs
X2RyaXZlcl9yZWxlYXNlLAogCiAJLyogZ2VtIGhvb2tzICovCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vdWRsL3VkbF9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS91ZGwvdWRsX2Rydi5oCmlu
ZGV4IGU2YTY2OWY2ZjIwNC4uMmVjNTdmMzhhZWMwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vdWRsL3VkbF9kcnYuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vdWRsL3VkbF9kcnYuaApAQCAt
MTcsOCArMTcsOCBAQAogI2luY2x1ZGUgPGRybS9kcm1fZGV2aWNlLmg+CiAjaW5jbHVkZSA8ZHJt
L2RybV9mcmFtZWJ1ZmZlci5oPgogI2luY2x1ZGUgPGRybS9kcm1fZ2VtLmg+CisjaW5jbHVkZSA8
ZHJtL2RybV9zaW1wbGVfa21zX2hlbHBlci5oPgogCi1zdHJ1Y3QgZHJtX2VuY29kZXI7CiBzdHJ1
Y3QgZHJtX21vZGVfY3JlYXRlX2R1bWI7CiAKICNkZWZpbmUgRFJJVkVSX05BTUUJCSJ1ZGwiCkBA
IC01Myw2ICs1Myw4IEBAIHN0cnVjdCB1ZGxfZGV2aWNlIHsKIAlzdHJ1Y3QgdXNiX2RldmljZSAq
dWRldjsKIAlzdHJ1Y3QgZHJtX2NydGMgKmNydGM7CiAKKwlzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNw
bGF5X3BpcGUgZGlzcGxheV9waXBlOworCiAJLyogYWN0aXZlIGZyYW1lYnVmZmVyIG9uIHRoZSAx
Ni1iaXQgY2hhbm5lbCAqLwogCWNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmFjdGl2ZV9m
Yl8xNjsKIAlzcGlubG9ja190IGFjdGl2ZV9mYl8xNl9sb2NrOwpAQCAtNzUsOCArNzcsNiBAQCB2
b2lkIHVkbF9tb2Rlc2V0X3Jlc3RvcmUoc3RydWN0IGRybV9kZXZpY2UgKmRldik7CiB2b2lkIHVk
bF9tb2Rlc2V0X2NsZWFudXAoc3RydWN0IGRybV9kZXZpY2UgKmRldik7CiBzdHJ1Y3QgZHJtX2Nv
bm5lY3RvciAqdWRsX2Nvbm5lY3Rvcl9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpOwogCi1z
dHJ1Y3QgZHJtX2VuY29kZXIgKnVkbF9lbmNvZGVyX2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRl
dik7Ci0KIHN0cnVjdCB1cmIgKnVkbF9nZXRfdXJiKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpOwog
CiBpbnQgdWRsX3N1Ym1pdF91cmIoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgc3RydWN0IHVyYiAq
dXJiLCBzaXplX3QgbGVuKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS91ZGwvdWRsX2Vu
Y29kZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS91ZGwvdWRsX2VuY29kZXIuYwpkZWxldGVkIGZpbGUg
bW9kZSAxMDA2NDQKaW5kZXggMjAzZjA0MWU3MzdjLi4wMDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL3VkbC91ZGxfZW5jb2Rlci5jCisrKyAvZGV2L251bGwKQEAgLTEsNzAgKzAsMCBA
QAotLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seQotLyoKLSAqIENvcHly
aWdodCAoQykgMjAxMiBSZWQgSGF0Ci0gKiBiYXNlZCBpbiBwYXJ0cyBvbiB1ZGxmYi5jOgotICog
Q29weXJpZ2h0IChDKSAyMDA5IFJvYmVydG8gRGUgSW9yaXMgPHJvYmVydG9AdW5iaXQuaXQ+Ci0g
KiBDb3B5cmlnaHQgKEMpIDIwMDkgSmF5YSBLdW1hciA8amF5YWt1bWFyLmxrbWxAZ21haWwuY29t
PgotICogQ29weXJpZ2h0IChDKSAyMDA5IEJlcm5pZSBUaG9tcHNvbiA8YmVybmllQHBsdWdhYmxl
LmNvbT4KLSAqLwotCi0jaW5jbHVkZSA8ZHJtL2RybV9lbmNvZGVyLmg+Ci0jaW5jbHVkZSA8ZHJt
L2RybV9tb2Rlc2V0X2hlbHBlcl92dGFibGVzLmg+Ci0KLSNpbmNsdWRlICJ1ZGxfZHJ2LmgiCi0K
LS8qIGR1bW15IGVuY29kZXIgKi8KLXN0YXRpYyB2b2lkIHVkbF9lbmNfZGVzdHJveShzdHJ1Y3Qg
ZHJtX2VuY29kZXIgKmVuY29kZXIpCi17Ci0JZHJtX2VuY29kZXJfY2xlYW51cChlbmNvZGVyKTsK
LQlrZnJlZShlbmNvZGVyKTsKLX0KLQotc3RhdGljIHZvaWQgdWRsX2VuY29kZXJfZGlzYWJsZShz
dHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIpCi17Ci19Ci0KLXN0YXRpYyB2b2lkIHVkbF9lbmNv
ZGVyX3ByZXBhcmUoc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyKQotewotfQotCi1zdGF0aWMg
dm9pZCB1ZGxfZW5jb2Rlcl9jb21taXQoc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyKQotewot
fQotCi1zdGF0aWMgdm9pZCB1ZGxfZW5jb2Rlcl9tb2RlX3NldChzdHJ1Y3QgZHJtX2VuY29kZXIg
KmVuY29kZXIsCi0JCQkJIHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlLAotCQkJCSBzdHJ1
Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSkKLXsKLX0KLQotc3RhdGljIHZvaWQK
LXVkbF9lbmNvZGVyX2RwbXMoc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyLCBpbnQgbW9kZSkK
LXsKLX0KLQotc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZW5jb2Rlcl9oZWxwZXJfZnVuY3MgdWRs
X2hlbHBlcl9mdW5jcyA9IHsKLQkuZHBtcyA9IHVkbF9lbmNvZGVyX2RwbXMsCi0JLnByZXBhcmUg
PSB1ZGxfZW5jb2Rlcl9wcmVwYXJlLAotCS5tb2RlX3NldCA9IHVkbF9lbmNvZGVyX21vZGVfc2V0
LAotCS5jb21taXQgPSB1ZGxfZW5jb2Rlcl9jb21taXQsCi0JLmRpc2FibGUgPSB1ZGxfZW5jb2Rl
cl9kaXNhYmxlLAotfTsKLQotc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZW5jb2Rlcl9mdW5jcyB1
ZGxfZW5jX2Z1bmNzID0gewotCS5kZXN0cm95ID0gdWRsX2VuY19kZXN0cm95LAotfTsKLQotc3Ry
dWN0IGRybV9lbmNvZGVyICp1ZGxfZW5jb2Rlcl9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYp
Ci17Ci0Jc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyOwotCi0JZW5jb2RlciA9IGt6YWxsb2Mo
c2l6ZW9mKHN0cnVjdCBkcm1fZW5jb2RlciksIEdGUF9LRVJORUwpOwotCWlmICghZW5jb2RlcikK
LQkJcmV0dXJuIE5VTEw7Ci0KLQlkcm1fZW5jb2Rlcl9pbml0KGRldiwgZW5jb2RlciwgJnVkbF9l
bmNfZnVuY3MsIERSTV9NT0RFX0VOQ09ERVJfVE1EUywKLQkJCSBOVUxMKTsKLQlkcm1fZW5jb2Rl
cl9oZWxwZXJfYWRkKGVuY29kZXIsICZ1ZGxfaGVscGVyX2Z1bmNzKTsKLQllbmNvZGVyLT5wb3Nz
aWJsZV9jcnRjcyA9IDE7Ci0JcmV0dXJuIGVuY29kZXI7Ci19CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vdWRsL3VkbF9tb2Rlc2V0LmMgYi9kcml2ZXJzL2dwdS9kcm0vdWRsL3VkbF9tb2Rl
c2V0LmMKaW5kZXggNWJiMTUyMjAzNmM3Li4zZTc0NjY0ODJlZjAgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS91ZGwvdWRsX21vZGVzZXQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdWRsL3Vk
bF9tb2Rlc2V0LmMKQEAgLTksMTIgKzksMTYgQEAKIAogICovCiAKKyNpbmNsdWRlIDxkcm0vZHJt
X2F0b21pY19oZWxwZXIuaD4KICNpbmNsdWRlIDxkcm0vZHJtX2NydGNfaGVscGVyLmg+CisjaW5j
bHVkZSA8ZHJtL2RybV9nZW1fZnJhbWVidWZmZXJfaGVscGVyLmg+CiAjaW5jbHVkZSA8ZHJtL2Ry
bV9tb2Rlc2V0X2hlbHBlcl92dGFibGVzLmg+CiAjaW5jbHVkZSA8ZHJtL2RybV92YmxhbmsuaD4K
IAogI2luY2x1ZGUgInVkbF9kcnYuaCIKIAorI2RlZmluZSBVRExfQ09MT1JfREVQVEhfMTZCUFAJ
MAorCiAvKgogICogQWxsIERpc3BsYXlMaW5rIGJ1bGsgb3BlcmF0aW9ucyBzdGFydCB3aXRoIDB4
QUYsIGZvbGxvd2VkIGJ5IHNwZWNpZmljIGNvZGUKICAqIEFsbCBvcGVyYXRpb25zIGFyZSB3cml0
dGVuIHRvIGJ1ZmZlcnMgd2hpY2ggdGhlbiBsYXRlciBnZXQgc2VudCB0byBkZXZpY2UKQEAgLTI3
Nyw0OCArMjgxLDQ0IEBAIHN0YXRpYyB2b2lkIHVkbF9jcnRjX2RwbXMoc3RydWN0IGRybV9jcnRj
ICpjcnRjLCBpbnQgbW9kZSkKIAogfQogCi0jaWYgMAotc3RhdGljIGludAotdWRsX3BpcGVfc2V0
X2Jhc2VfYXRvbWljKHN0cnVjdCBkcm1fY3J0YyAqY3J0Yywgc3RydWN0IGRybV9mcmFtZWJ1ZmZl
ciAqZmIsCi0JCQkgICBpbnQgeCwgaW50IHksIGVudW0gbW9kZV9zZXRfYXRvbWljIHN0YXRlKQot
ewotCXJldHVybiAwOwotfQorLyoKKyAqIFNpbXBsZSBkaXNwbGF5IHBpcGVsaW5lCisgKi8KIAot
c3RhdGljIGludAotdWRsX3BpcGVfc2V0X2Jhc2Uoc3RydWN0IGRybV9jcnRjICpjcnRjLCBpbnQg
eCwgaW50IHksCi0JCSAgICBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpvbGRfZmIpCitzdGF0aWMg
Y29uc3QgdWludDMyX3QgdWRsX3NpbXBsZV9kaXNwbGF5X3BpcGVfZm9ybWF0c1tdID0geworCURS
TV9GT1JNQVRfUkdCNTY1LAorCURSTV9GT1JNQVRfWFJHQjg4ODgsCit9OworCitzdGF0aWMgZW51
bSBkcm1fbW9kZV9zdGF0dXMKK3VkbF9zaW1wbGVfZGlzcGxheV9waXBlX21vZGVfdmFsaWQoc3Ry
dWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBlLAorCQkJCSAgIGNvbnN0IHN0cnVjdCBk
cm1fZGlzcGxheV9tb2RlICptb2RlKQogewotCXJldHVybiAwOworCXJldHVybiBNT0RFX09LOwog
fQotI2VuZGlmCi0KLXN0YXRpYyBpbnQgdWRsX2NydGNfbW9kZV9zZXQoc3RydWN0IGRybV9jcnRj
ICpjcnRjLAotCQkJICAgICAgIHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlLAotCQkJICAg
ICAgIHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlLAotCQkJICAgICAgIGlu
dCB4LCBpbnQgeSwKLQkJCSAgICAgICBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpvbGRfZmIpCiAK
K3N0YXRpYyB2b2lkCit1ZGxfc2ltcGxlX2Rpc3BsYXlfcGlwZV9lbmFibGUoc3RydWN0IGRybV9z
aW1wbGVfZGlzcGxheV9waXBlICpwaXBlLAorCQkJICAgICAgIHN0cnVjdCBkcm1fY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSwKKwkJCSAgICAgICBzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpwbGFuZV9z
dGF0ZSkKIHsKKwlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSAmcGlwZS0+Y3J0YzsKIAlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+ZGV2OwotCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZi
ID0gY3J0Yy0+cHJpbWFyeS0+ZmI7CisJc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBwbGFu
ZV9zdGF0ZS0+ZmI7CiAJc3RydWN0IHVkbF9kZXZpY2UgKnVkbCA9IGRldi0+ZGV2X3ByaXZhdGU7
CisJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUgPSAmY3J0Y19zdGF0ZS0+bW9kZTsKIAlj
aGFyICpidWY7CiAJY2hhciAqd3JwdHI7Ci0JaW50IGNvbG9yX2RlcHRoID0gMDsKKwlpbnQgY29s
b3JfZGVwdGggPSBVRExfQ09MT1JfREVQVEhfMTZCUFA7CiAKIAl1ZGwtPmNydGMgPSBjcnRjOwog
CiAJYnVmID0gKGNoYXIgKil1ZGwtPm1vZGVfYnVmOwogCi0JLyogZm9yIG5vdyB3ZSBqdXN0IGNs
aXAgMjQgLT4gMTYgLSBpZiB3ZSBmaXggdGhhdCBmaXggdGhpcyAqLwotCS8qaWYgIChjcnRjLT5m
Yi0+Yml0c19wZXJfcGl4ZWwgIT0gMTYpCi0JICBjb2xvcl9kZXB0aCA9IDE7ICovCi0KIAkvKiBU
aGlzIGZpcnN0IHNlY3Rpb24gaGFzIHRvIGRvIHdpdGggc2V0dGluZyB0aGUgYmFzZSBhZGRyZXNz
IG9uIHRoZQotCSogY29udHJvbGxlciAqIGFzc29jaWF0ZWQgd2l0aCB0aGUgZGlzcGxheS4gVGhl
cmUgYXJlIDIgYmFzZQotCSogcG9pbnRlcnMsIGN1cnJlbnRseSwgd2Ugb25seSAqIHVzZSB0aGUg
MTYgYnBwIHNlZ21lbnQuCi0JKi8KKwkgKiBjb250cm9sbGVyIGFzc29jaWF0ZWQgd2l0aCB0aGUg
ZGlzcGxheS4gVGhlcmUgYXJlIDIgYmFzZQorCSAqIHBvaW50ZXJzLCBjdXJyZW50bHksIHdlIG9u
bHkgdXNlIHRoZSAxNiBicHAgc2VnbWVudC4KKwkgKi8KIAl3cnB0ciA9IHVkbF92aWRyZWdfbG9j
ayhidWYpOwogCXdycHRyID0gdWRsX3NldF9jb2xvcl9kZXB0aCh3cnB0ciwgY29sb3JfZGVwdGgp
OwogCS8qIHNldCBiYXNlIGZvciAxNmJwcCBzZWdtZW50IHRvIDAgKi8KQEAgLTMyNiw3ICszMjYs
NyBAQCBzdGF0aWMgaW50IHVkbF9jcnRjX21vZGVfc2V0KHN0cnVjdCBkcm1fY3J0YyAqY3J0YywK
IAkvKiBzZXQgYmFzZSBmb3IgOGJwcCBzZWdtZW50IHRvIGVuZCBvZiBmYiAqLwogCXdycHRyID0g
dWRsX3NldF9iYXNlOGJwcCh3cnB0ciwgMiAqIG1vZGUtPnZkaXNwbGF5ICogbW9kZS0+aGRpc3Bs
YXkpOwogCi0Jd3JwdHIgPSB1ZGxfc2V0X3ZpZF9jbWRzKHdycHRyLCBhZGp1c3RlZF9tb2RlKTsK
Kwl3cnB0ciA9IHVkbF9zZXRfdmlkX2NtZHMod3JwdHIsIG1vZGUpOwogCXdycHRyID0gdWRsX3Nl
dF9ibGFuayh3cnB0ciwgRFJNX01PREVfRFBNU19PTik7CiAJd3JwdHIgPSB1ZGxfdmlkcmVnX3Vu
bG9jayh3cnB0cik7CiAKQEAgLTMzNyw5MiArMzM3LDcwIEBAIHN0YXRpYyBpbnQgdWRsX2NydGNf
bW9kZV9zZXQoc3RydWN0IGRybV9jcnRjICpjcnRjLAogCXNwaW5fdW5sb2NrKCZ1ZGwtPmFjdGl2
ZV9mYl8xNl9sb2NrKTsKIAl1ZGwtPm1vZGVfYnVmX2xlbiA9IHdycHRyIC0gYnVmOwogCi0JLyog
ZGFtYWdlIGFsbCBvZiBpdCAqLwogCXVkbF9oYW5kbGVfZGFtYWdlKGZiLCAwLCAwLCBmYi0+d2lk
dGgsIGZiLT5oZWlnaHQpOwotCXJldHVybiAwOwotfQogCisJdWRsX2NydGNfZHBtcygmcGlwZS0+
Y3J0YywgRFJNX01PREVfRFBNU19PTik7CiAKLXN0YXRpYyB2b2lkIHVkbF9jcnRjX2Rpc2FibGUo
c3RydWN0IGRybV9jcnRjICpjcnRjKQorCWNydGNfc3RhdGUtPm5vX3ZibGFuayA9IHRydWU7Cit9
CisKK3N0YXRpYyB2b2lkCit1ZGxfc2ltcGxlX2Rpc3BsYXlfcGlwZV9kaXNhYmxlKHN0cnVjdCBk
cm1fc2ltcGxlX2Rpc3BsYXlfcGlwZSAqcGlwZSkKIHsKLQl1ZGxfY3J0Y19kcG1zKGNydGMsIERS
TV9NT0RFX0RQTVNfT0ZGKTsKKwl1ZGxfY3J0Y19kcG1zKCZwaXBlLT5jcnRjLCBEUk1fTU9ERV9E
UE1TX09GRik7CiB9CiAKLXN0YXRpYyB2b2lkIHVkbF9jcnRjX2Rlc3Ryb3koc3RydWN0IGRybV9j
cnRjICpjcnRjKQorc3RhdGljIGludAordWRsX3NpbXBsZV9kaXNwbGF5X3BpcGVfY2hlY2soc3Ry
dWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBlLAorCQkJICAgICAgc3RydWN0IGRybV9w
bGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUsCisJCQkgICAgICBzdHJ1Y3QgZHJtX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUpCiB7Ci0JZHJtX2NydGNfY2xlYW51cChjcnRjKTsKLQlrZnJlZShjcnRjKTsK
KwlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB1ZGxfY3J0Y19wYWdlX2ZsaXAoc3RydWN0IGRy
bV9jcnRjICpjcnRjLAotCQkJICAgICAgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIsCi0JCQkg
ICAgICBzdHJ1Y3QgZHJtX3BlbmRpbmdfdmJsYW5rX2V2ZW50ICpldmVudCwKLQkJCSAgICAgIHVp
bnQzMl90IHBhZ2VfZmxpcF9mbGFncywKLQkJCSAgICAgIHN0cnVjdCBkcm1fbW9kZXNldF9hY3F1
aXJlX2N0eCAqY3R4KQorc3RhdGljIHZvaWQKK3VkbF9zaW1wbGVfZGlzcGxheV9waXBlX3VwZGF0
ZShzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCisJCQkgICAgICAgc3RydWN0
IGRybV9wbGFuZV9zdGF0ZSAqb2xkX3BsYW5lX3N0YXRlKQogewotCXN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYgPSBjcnRjLT5kZXY7CisJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IHBpcGUtPmNydGMu
ZGV2OwogCXN0cnVjdCB1ZGxfZGV2aWNlICp1ZGwgPSBkZXYtPmRldl9wcml2YXRlOworCXN0cnVj
dCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGlwZS0+cGxhbmUuc3RhdGUtPmZiOwogCiAJc3Bpbl9s
b2NrKCZ1ZGwtPmFjdGl2ZV9mYl8xNl9sb2NrKTsKIAl1ZGwtPmFjdGl2ZV9mYl8xNiA9IGZiOwog
CXNwaW5fdW5sb2NrKCZ1ZGwtPmFjdGl2ZV9mYl8xNl9sb2NrKTsKIAotCXVkbF9oYW5kbGVfZGFt
YWdlKGZiLCAwLCAwLCBmYi0+d2lkdGgsIGZiLT5oZWlnaHQpOwotCi0Jc3Bpbl9sb2NrX2lycSgm
ZGV2LT5ldmVudF9sb2NrKTsKLQlpZiAoZXZlbnQpCi0JCWRybV9jcnRjX3NlbmRfdmJsYW5rX2V2
ZW50KGNydGMsIGV2ZW50KTsKLQlzcGluX3VubG9ja19pcnEoJmRldi0+ZXZlbnRfbG9jayk7Ci0J
Y3J0Yy0+cHJpbWFyeS0+ZmIgPSBmYjsKLQotCXJldHVybiAwOwotfQotCi1zdGF0aWMgdm9pZCB1
ZGxfY3J0Y19wcmVwYXJlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykKLXsKLX0KKwlpZiAoIWZiKQor
CQlyZXR1cm47CiAKLXN0YXRpYyB2b2lkIHVkbF9jcnRjX2NvbW1pdChzdHJ1Y3QgZHJtX2NydGMg
KmNydGMpCi17Ci0JdWRsX2NydGNfZHBtcyhjcnRjLCBEUk1fTU9ERV9EUE1TX09OKTsKKwl1ZGxf
aGFuZGxlX2RhbWFnZShmYiwgMCwgMCwgZmItPndpZHRoLCBmYi0+aGVpZ2h0KTsKIH0KIAotc3Rh
dGljIGNvbnN0IHN0cnVjdCBkcm1fY3J0Y19oZWxwZXJfZnVuY3MgdWRsX2hlbHBlcl9mdW5jcyA9
IHsKLQkuZHBtcyA9IHVkbF9jcnRjX2RwbXMsCi0JLm1vZGVfc2V0ID0gdWRsX2NydGNfbW9kZV9z
ZXQsCi0JLnByZXBhcmUgPSB1ZGxfY3J0Y19wcmVwYXJlLAotCS5jb21taXQgPSB1ZGxfY3J0Y19j
b21taXQsCi0JLmRpc2FibGUgPSB1ZGxfY3J0Y19kaXNhYmxlLAotfTsKLQotc3RhdGljIGNvbnN0
IHN0cnVjdCBkcm1fY3J0Y19mdW5jcyB1ZGxfY3J0Y19mdW5jcyA9IHsKLQkuc2V0X2NvbmZpZyA9
IGRybV9jcnRjX2hlbHBlcl9zZXRfY29uZmlnLAotCS5kZXN0cm95ID0gdWRsX2NydGNfZGVzdHJv
eSwKLQkucGFnZV9mbGlwID0gdWRsX2NydGNfcGFnZV9mbGlwLAorc3RhdGljIGNvbnN0CitzdHJ1
Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGVfZnVuY3MgdWRsX3NpbXBsZV9kaXNwbGF5X3BpcGVf
ZnVuY3MgPSB7CisJLm1vZGVfdmFsaWQgPSB1ZGxfc2ltcGxlX2Rpc3BsYXlfcGlwZV9tb2RlX3Zh
bGlkLAorCS5lbmFibGUgPSB1ZGxfc2ltcGxlX2Rpc3BsYXlfcGlwZV9lbmFibGUsCisJLmRpc2Fi
bGUgPSB1ZGxfc2ltcGxlX2Rpc3BsYXlfcGlwZV9kaXNhYmxlLAorCS5jaGVjayA9IHVkbF9zaW1w
bGVfZGlzcGxheV9waXBlX2NoZWNrLAorCS51cGRhdGUgPSB1ZGxfc2ltcGxlX2Rpc3BsYXlfcGlw
ZV91cGRhdGUsCisJLnByZXBhcmVfZmIgPSBkcm1fZ2VtX2ZiX3NpbXBsZV9kaXNwbGF5X3BpcGVf
cHJlcGFyZV9mYiwKIH07CiAKLXN0YXRpYyBpbnQgdWRsX2NydGNfaW5pdChzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2KQotewotCXN0cnVjdCBkcm1fY3J0YyAqY3J0YzsKLQotCWNydGMgPSBremFsbG9j
KHNpemVvZihzdHJ1Y3QgZHJtX2NydGMpICsgc2l6ZW9mKHN0cnVjdCBkcm1fY29ubmVjdG9yICop
LCBHRlBfS0VSTkVMKTsKLQlpZiAoY3J0YyA9PSBOVUxMKQotCQlyZXR1cm4gLUVOT01FTTsKLQot
CWRybV9jcnRjX2luaXQoZGV2LCBjcnRjLCAmdWRsX2NydGNfZnVuY3MpOwotCWRybV9jcnRjX2hl
bHBlcl9hZGQoY3J0YywgJnVkbF9oZWxwZXJfZnVuY3MpOwotCi0JcmV0dXJuIDA7Ci19CisvKgor
ICogTW9kZXNldHRpbmcKKyAqLwogCiBzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9tb2RlX2NvbmZp
Z19mdW5jcyB1ZGxfbW9kZV9mdW5jcyA9IHsKIAkuZmJfY3JlYXRlID0gdWRsX2ZiX3VzZXJfZmJf
Y3JlYXRlLAorCS5hdG9taWNfY2hlY2sgID0gZHJtX2F0b21pY19oZWxwZXJfY2hlY2ssCisJLmF0
b21pY19jb21taXQgPSBkcm1fYXRvbWljX2hlbHBlcl9jb21taXQsCiB9OwogCiBpbnQgdWRsX21v
ZGVzZXRfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQogeworCXNpemVfdCBmb3JtYXRfY291
bnQgPSBBUlJBWV9TSVpFKHVkbF9zaW1wbGVfZGlzcGxheV9waXBlX2Zvcm1hdHMpOworCXN0cnVj
dCB1ZGxfZGV2aWNlICp1ZGwgPSBkZXYtPmRldl9wcml2YXRlOwogCXN0cnVjdCBkcm1fY29ubmVj
dG9yICpjb25uZWN0b3I7Ci0Jc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyOwogCWludCByZXQ7
CiAKIAlkcm1fbW9kZV9jb25maWdfaW5pdChkZXYpOwpAQCAtNDQ0LDEwICs0MjIsMTYgQEAgaW50
IHVkbF9tb2Rlc2V0X2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKIAkJZ290byBlcnJfZHJt
X21vZGVfY29uZmlnX2NsZWFudXA7CiAJfQogCi0JdWRsX2NydGNfaW5pdChkZXYpOworCWZvcm1h
dF9jb3VudCA9IEFSUkFZX1NJWkUodWRsX3NpbXBsZV9kaXNwbGF5X3BpcGVfZm9ybWF0cyk7CisK
KwlyZXQgPSBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlwZV9pbml0KGRldiwgJnVkbC0+ZGlzcGxheV9w
aXBlLAorCQkJCQkgICAmdWRsX3NpbXBsZV9kaXNwbGF5X3BpcGVfZnVuY3MsCisJCQkJCSAgIHVk
bF9zaW1wbGVfZGlzcGxheV9waXBlX2Zvcm1hdHMsCisJCQkJCSAgIGZvcm1hdF9jb3VudCwgTlVM
TCwgY29ubmVjdG9yKTsKKwlpZiAocmV0KQorCQlnb3RvIGVycl9kcm1fbW9kZV9jb25maWdfY2xl
YW51cDsKIAotCWVuY29kZXIgPSB1ZGxfZW5jb2Rlcl9pbml0KGRldik7Ci0JZHJtX2Nvbm5lY3Rv
cl9hdHRhY2hfZW5jb2Rlcihjb25uZWN0b3IsIGVuY29kZXIpOworCWRybV9tb2RlX2NvbmZpZ19y
ZXNldChkZXYpOwogCiAJcmV0dXJuIDA7CiAKQEAgLTQ1OSwxMiArNDQzLDE0IEBAIGludCB1ZGxf
bW9kZXNldF9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCiB2b2lkIHVkbF9tb2Rlc2V0X3Jl
c3RvcmUoc3RydWN0IGRybV9kZXZpY2UgKmRldikKIHsKIAlzdHJ1Y3QgdWRsX2RldmljZSAqdWRs
ID0gZGV2LT5kZXZfcHJpdmF0ZTsKLQlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYjsKKwlzdHJ1
Y3QgZHJtX2NydGMgKmNydGMgPSAmdWRsLT5kaXNwbGF5X3BpcGUuY3J0YzsKKwlzdHJ1Y3QgZHJt
X3BsYW5lICpwcmltYXJ5ID0gJnVkbC0+ZGlzcGxheV9waXBlLnBsYW5lOworCXN0cnVjdCBkcm1f
ZnJhbWVidWZmZXIgKmZiID0gcHJpbWFyeS0+ZmI7CiAKLQlpZiAoIXVkbC0+Y3J0YyB8fCAhdWRs
LT5jcnRjLT5wcmltYXJ5LT5mYikKKwlpZiAoIWZiKQogCQlyZXR1cm47Ci0JdWRsX2NydGNfY29t
bWl0KHVkbC0+Y3J0Yyk7Ci0JZmIgPSB1ZGwtPmNydGMtPnByaW1hcnktPmZiOworCisJdWRsX2Ny
dGNfZHBtcyhjcnRjLCBEUk1fTU9ERV9EUE1TX09OKTsKIAl1ZGxfaGFuZGxlX2RhbWFnZShmYiwg
MCwgMCwgZmItPndpZHRoLCBmYi0+aGVpZ2h0KTsKIH0KIAotLSAKMi4yMy4wCgpfX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBs
aXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVz
a3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
