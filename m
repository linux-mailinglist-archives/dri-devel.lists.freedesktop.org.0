Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 6E7C89A8F0
	for <lists+dri-devel@lfdr.de>; Fri, 23 Aug 2019 09:35:11 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D04146EBD7;
	Fri, 23 Aug 2019 07:35:08 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-lj1-x244.google.com (mail-lj1-x244.google.com
 [IPv6:2a00:1450:4864:20::244])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9FDFF6EBD8
 for <dri-devel@lists.freedesktop.org>; Fri, 23 Aug 2019 07:35:02 +0000 (UTC)
Received: by mail-lj1-x244.google.com with SMTP id x18so7982008ljh.1
 for <dri-devel@lists.freedesktop.org>; Fri, 23 Aug 2019 00:35:02 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=U4JjuaJiqXMB2o4Ei0Z8NiWiXfcICpnx2WAq5seW+dw=;
 b=UZihlrsYnkzI+QJOyXJ0B9atuCmXUAFqGFyFUsNAY9ky9eRB6c8rA+n6e0ZbL/UW9O
 LONd8XNzAhYRDAZdKdM1XM3XzdbOD9S7b7Ks4yn5p/ZJlm1vfqUGyWxYr6XeuHBzuUGW
 N5ROEMwcctyh0G4VvrxtiHETUjubyzwoQLEBXx+U4ljn0fj7kG8ak/TAuDbQH/zNwjRe
 tICWK9aK/5FHtHloybFvHtXKToSBMB6HfnCglKtcyUFVo//VzwvF2ZGFIA/x2CDgxkoq
 ikZJ1wvzE0m4XeTaZ8B6sHxuWH4yGpcctmO/afJx5soFh3aLDBbCY1fodhEo25CcFaIk
 FH3A==
X-Gm-Message-State: APjAAAXCpMcuWte1AgsO8SwPQGw7bJ2I9Sus3fiolrnUeJqZJNaISLnc
 BF2G3i/Ga71em0f3sLfLmyrEKg==
X-Google-Smtp-Source: APXvYqx61Q5ijD7n7Msa4Yk7wnjy3PO7NaRoLanNXNHaTVeOVPLkcRICF53epznQywZG1c9aDGtNpQ==
X-Received: by 2002:a2e:8651:: with SMTP id i17mr2102549ljj.136.1566545700968; 
 Fri, 23 Aug 2019 00:35:00 -0700 (PDT)
Received: from genomnajs.ideon.se ([85.235.10.227])
 by smtp.gmail.com with ESMTPSA id n7sm483780ljh.2.2019.08.23.00.34.59
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 23 Aug 2019 00:34:59 -0700 (PDT)
From: Linus Walleij <linus.walleij@linaro.org>
To: Rob Clark <robdclark@gmail.com>, Sean Paul <sean@poorly.run>,
 linux-arm-msm@vger.kernel.org, freedreno@lists.freedesktop.org
Subject: [PATCH 4/6 v2] drm/msm/hdmi: Convert to use GPIO descriptors
Date: Fri, 23 Aug 2019 09:34:46 +0200
Message-Id: <20190823073448.8385-4-linus.walleij@linaro.org>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190823073448.8385-1-linus.walleij@linaro.org>
References: <20190823073448.8385-1-linus.walleij@linaro.org>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=linaro.org; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=U4JjuaJiqXMB2o4Ei0Z8NiWiXfcICpnx2WAq5seW+dw=;
 b=beKwdrHHjuxuM0+kjruLKtl6q5NuVehPNcKCcVIjm80K0ZHnbd4x/gqtWXZv7zRPPe
 Ih2kNUo2fRTf+xw1lCPan3iXcUNi0TPr6bkXJHWyKxYfep4Yw5uw6HitrSBtNL/4voHp
 LFG3HGCk1lDI7uU605QCiQIpAxS1kRUSkQo5RICVVSfPKa3bgJBp3DqRbxLYOK6xQ3yS
 WvnPnt+pZgJKHa7t+KSFPJ6FOBCCDrRIIFLmdgZPxZu2kinYsyqBxbm+omEVcgGtogHt
 H1QzPhjyPeDFksPwhZUu0fpAhy+OkPhcW8Ztl7OaW99MgPfFCHADyoIdDQneceDcqwCW
 7a3Q==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: dri-devel@lists.freedesktop.org, Brian Masney <masneyb@onstation.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBzd2l0Y2hlcyB0aGUgTVNNIEhETUkgY29kZSB0byB1c2UgR1BJTyBkZXNjcmlwdG9ycy4K
Tm9ybWFsbHkgd2Ugd291bGQgZmV0Y2ggdGhlIEdQSU9zIGZyb20gdGhlIGRldmljZSB3aXRoIHRo
ZQpmbGFncyBHUElPRF9JTiBvciBHUElPRF9PVVRfW0xPV3xISUdIXSB0byBzZXQgdXAgdGhlIGxp
bmVzCmltbWVkaWF0ZWx5LCBidXQgc2luY2UgdGhlIGNvZGUgc2VlbXMgZWFnZXIgdG8gYWN0aXZl
bHkKZHJpdmUgdGhlIGxpbmVzIGhpZ2gvbG93IHdoZW4gdHVybmluZyBIRE1JIG9uIGFuZCBvZmYs
IHdlCmp1c3QgZmV0Y2ggdGhlIEdQSU9zIGFzLWlzIGFuZCBrZWVwIHRoZSBjb2RlIGV4cGxpY2l0
bHkKZHJpdmluZyB0aGVtLgoKVGhlIG9sZCBjb2RlIHdvdWxkIHRyeSBsZWdhY3kgYmluZGluZ3Mg
KEdQSU9zIHdpdGhvdXQgYW55CiItZ3Bpb3MiIHN1ZmZpeCkgYnV0IHRoaXMgaGFzIGJlZW4gbW92
ZWQgdG8gdGhlIGdwaW9saWIKYXMgYSBxdWlyayBieSB0aGUgcHJldmlvdXMgcGF0Y2guCgpDYzog
Um9iIENsYXJrIDxyb2JkY2xhcmtAZ21haWwuY29tPgpDYzogU2VhbiBQYXVsIDxzZWFuQHBvb3Js
eS5ydW4+CkNjOiBsaW51eC1hcm0tbXNtQHZnZXIua2VybmVsLm9yZwpDYzogZnJlZWRyZW5vQGxp
c3RzLmZyZWVkZXNrdG9wLm9yZwpSZXZpZXdlZC1ieTogQnJpYW4gTWFzbmV5IDxtYXNuZXliQG9u
c3RhdGlvbi5vcmc+ClNpZ25lZC1vZmYtYnk6IExpbnVzIFdhbGxlaWogPGxpbnVzLndhbGxlaWpA
bGluYXJvLm9yZz4KLS0tCkNoYW5nZUxvZyB2MS0+djI6Ci0gUmViYXNlZCBvbiB2NS4zLXJjMQot
IENvbGxlY3RlZCByZXZpZXcgdGFnCi0tLQogZHJpdmVycy9ncHUvZHJtL21zbS9oZG1pL2hkbWku
YyAgICAgICAgICAgfCA2NiArKysrKysrKysrKy0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJt
L21zbS9oZG1pL2hkbWkuaCAgICAgICAgICAgfCAgNCArLQogZHJpdmVycy9ncHUvZHJtL21zbS9o
ZG1pL2hkbWlfY29ubmVjdG9yLmMgfCA0MiArKysrKy0tLS0tLS0tLS0KIDMgZmlsZXMgY2hhbmdl
ZCwgNDUgaW5zZXJ0aW9ucygrKSwgNjcgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL21zbS9oZG1pL2hkbWkuYyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vaGRtaS9oZG1p
LmMKaW5kZXggMGU0MjE3YmUzZjAwLi4zNTVhZmI5MzY0MDEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9tc20vaGRtaS9oZG1pLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL21zbS9oZG1pL2hk
bWkuYwpAQCAtNDI1LDM4ICs0MjUsNiBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHsKIAl7ICJxY29t
LGhkbWktdHgtbXV4LWxwbSIsIHRydWUsIDEsICJIRE1JX01VWF9MUE0iIH0sCiB9OwogCi1zdGF0
aWMgaW50IG1zbV9oZG1pX2dldF9ncGlvKHN0cnVjdCBkZXZpY2Vfbm9kZSAqb2Zfbm9kZSwgY29u
c3QgY2hhciAqbmFtZSkKLXsKLQlpbnQgZ3BpbzsKLQotCS8qIHRyeSB3aXRoIHRoZSBncGlvIG5h
bWVzIGFzIGluIHRoZSB0YWJsZSAoZG93bnN0cmVhbSBiaW5kaW5ncykgKi8KLQlncGlvID0gb2Zf
Z2V0X25hbWVkX2dwaW8ob2Zfbm9kZSwgbmFtZSwgMCk7Ci0JaWYgKGdwaW8gPCAwKSB7Ci0JCWNo
YXIgbmFtZTJbMzJdOwotCi0JCS8qIHRyeSB3aXRoIHRoZSBncGlvIG5hbWVzIGFzIGluIHRoZSB1
cHN0cmVhbSBiaW5kaW5ncyAqLwotCQlzbnByaW50ZihuYW1lMiwgc2l6ZW9mKG5hbWUyKSwgIiVz
LWdwaW9zIiwgbmFtZSk7Ci0JCWdwaW8gPSBvZl9nZXRfbmFtZWRfZ3BpbyhvZl9ub2RlLCBuYW1l
MiwgMCk7Ci0JCWlmIChncGlvIDwgMCkgewotCQkJY2hhciBuYW1lM1szMl07Ci0KLQkJCS8qCi0J
CQkgKiB0cnkgYWdhaW4gYWZ0ZXIgc3RyaXBwaW5nIG91dCB0aGUgInFjb20saGRtaS10eCIKLQkJ
CSAqIHByZWZpeC4gVGhpcyBpcyBtYWlubHkgdG8gbWF0Y2ggImhwZC1ncGlvcyIgdXNlZAotCQkJ
ICogaW4gdGhlIHVwc3RyZWFtIGJpbmRpbmdzCi0JCQkgKi8KLQkJCWlmIChzc2NhbmYobmFtZTIs
ICJxY29tLGhkbWktdHgtJXMiLCBuYW1lMykpCi0JCQkJZ3BpbyA9IG9mX2dldF9uYW1lZF9ncGlv
KG9mX25vZGUsIG5hbWUzLCAwKTsKLQkJfQotCi0JCWlmIChncGlvIDwgMCkgewotCQkJREJHKCJm
YWlsZWQgdG8gZ2V0IGdwaW86ICVzICglZCkiLCBuYW1lLCBncGlvKTsKLQkJCWdwaW8gPSAtMTsK
LQkJfQotCX0KLQlyZXR1cm4gZ3BpbzsKLX0KLQogLyoKICAqIEhETUkgYXVkaW8gY29kZWMgY2Fs
bGJhY2tzCiAgKi8KQEAgLTU4MiwxMSArNTUwLDM5IEBAIHN0YXRpYyBpbnQgbXNtX2hkbWlfYmlu
ZChzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBkZXZpY2UgKm1hc3Rlciwgdm9pZCAqZGF0YSkK
IAloZG1pX2NmZy0+cWZwcm9tX21taW9fbmFtZSA9ICJxZnByb21fcGh5c2ljYWwiOwogCiAJZm9y
IChpID0gMDsgaSA8IEhETUlfTUFYX05VTV9HUElPOyBpKyspIHsKLQkJaGRtaV9jZmctPmdwaW9z
W2ldLm51bSA9IG1zbV9oZG1pX2dldF9ncGlvKG9mX25vZGUsCi0JCQkJCQltc21faGRtaV9ncGlv
X3BkYXRhW2ldLm5hbWUpOworCQljb25zdCBjaGFyICpuYW1lID0gbXNtX2hkbWlfZ3Bpb19wZGF0
YVtpXS5uYW1lOworCQlzdHJ1Y3QgZ3Bpb19kZXNjICpncGlvZDsKKworCQkvKgorCQkgKiBXZSBh
cmUgZmV0Y2hpbmcgdGhlIEdQSU8gbGluZXMgImFzIGlzIiBzaW5jZSB0aGUgY29ubmVjdG9yCisJ
CSAqIGNvZGUgaXMgZW5hYmxpbmcgYW5kIGRpc2FibGluZyB0aGUgbGluZXMuIFVudGlsIHRoYXQg
cG9pbnQKKwkJICogdGhlIHBvd2VyLW9uIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSBrZXB0LgorCQkg
Ki8KKwkJZ3Bpb2QgPSBkZXZtX2dwaW9kX2dldF9vcHRpb25hbChkZXYsIG5hbWUsIEdQSU9EX0FT
SVMpOworCQkvKiBUaGlzIHdpbGwgY2F0Y2ggZS5nLiAtUFJPQkVfREVGRVIgKi8KKwkJaWYgKElT
X0VSUihncGlvZCkpCisJCQlyZXR1cm4gUFRSX0VSUihncGlvZCk7CisJCWlmICghZ3Bpb2QpIHsK
KwkJCS8qIFRyeSBhIHNlY29uZCB0aW1lLCBzdHJpcHBpbmcgZG93biB0aGUgbmFtZSAqLworCQkJ
Y2hhciBuYW1lM1szMl07CisKKwkJCS8qCisJCQkgKiBUcnkgYWdhaW4gYWZ0ZXIgc3RyaXBwaW5n
IG91dCB0aGUgInFjb20saGRtaS10eCIKKwkJCSAqIHByZWZpeC4gVGhpcyBpcyBtYWlubHkgdG8g
bWF0Y2ggImhwZC1ncGlvcyIgdXNlZAorCQkJICogaW4gdGhlIHVwc3RyZWFtIGJpbmRpbmdzLgor
CQkJICovCisJCQlpZiAoc3NjYW5mKG5hbWUsICJxY29tLGhkbWktdHgtJXMiLCBuYW1lMykpCisJ
CQkJZ3Bpb2QgPSBkZXZtX2dwaW9kX2dldF9vcHRpb25hbChkZXYsIG5hbWUzLCBHUElPRF9BU0lT
KTsKKwkJCWlmIChJU19FUlIoZ3Bpb2QpKQorCQkJCXJldHVybiBQVFJfRVJSKGdwaW9kKTsKKwkJ
CWlmICghZ3Bpb2QpCisJCQkJREJHKCJmYWlsZWQgdG8gZ2V0IGdwaW86ICVzIiwgbmFtZSk7CisJ
CX0KKwkJaGRtaV9jZmctPmdwaW9zW2ldLmdwaW9kID0gZ3Bpb2Q7CisJCWlmIChncGlvZCkKKwkJ
CWdwaW9kX3NldF9jb25zdW1lcl9uYW1lKGdwaW9kLCBtc21faGRtaV9ncGlvX3BkYXRhW2ldLmxh
YmVsKTsKIAkJaGRtaV9jZmctPmdwaW9zW2ldLm91dHB1dCA9IG1zbV9oZG1pX2dwaW9fcGRhdGFb
aV0ub3V0cHV0OwogCQloZG1pX2NmZy0+Z3Bpb3NbaV0udmFsdWUgPSBtc21faGRtaV9ncGlvX3Bk
YXRhW2ldLnZhbHVlOwotCQloZG1pX2NmZy0+Z3Bpb3NbaV0ubGFiZWwgPSBtc21faGRtaV9ncGlv
X3BkYXRhW2ldLmxhYmVsOwogCX0KIAogCWRldi0+cGxhdGZvcm1fZGF0YSA9IGhkbWlfY2ZnOwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21zbS9oZG1pL2hkbWkuaCBiL2RyaXZlcnMvZ3B1
L2RybS9tc20vaGRtaS9oZG1pLmgKaW5kZXggOTgyODY1ODY2YTI5Li5iZGFjNDUyYjAwZmIgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9tc20vaGRtaS9oZG1pLmgKKysrIGIvZHJpdmVycy9n
cHUvZHJtL21zbS9oZG1pL2hkbWkuaApAQCAtMTEsNiArMTEsNyBAQAogI2luY2x1ZGUgPGxpbnV4
L2Nsay5oPgogI2luY2x1ZGUgPGxpbnV4L3BsYXRmb3JtX2RldmljZS5oPgogI2luY2x1ZGUgPGxp
bnV4L3JlZ3VsYXRvci9jb25zdW1lci5oPgorI2luY2x1ZGUgPGxpbnV4L2dwaW8vY29uc3VtZXIu
aD4KICNpbmNsdWRlIDxsaW51eC9oZG1pLmg+CiAKICNpbmNsdWRlICJtc21fZHJ2LmgiCkBAIC0y
MiwxMCArMjMsOSBAQCBzdHJ1Y3QgaGRtaV9waHk7CiBzdHJ1Y3QgaGRtaV9wbGF0Zm9ybV9jb25m
aWc7CiAKIHN0cnVjdCBoZG1pX2dwaW9fZGF0YSB7Ci0JaW50IG51bTsKKwlzdHJ1Y3QgZ3Bpb19k
ZXNjICpncGlvZDsKIAlib29sIG91dHB1dDsKIAlpbnQgdmFsdWU7Ci0JY29uc3QgY2hhciAqbGFi
ZWw7CiB9OwogCiBzdHJ1Y3QgaGRtaV9hdWRpbyB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vbXNtL2hkbWkvaGRtaV9jb25uZWN0b3IuYyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vaGRtaS9o
ZG1pX2Nvbm5lY3Rvci5jCmluZGV4IDA3YjRjYjg3N2Q4Mi4uZDA1NzVkNGY3NDdkIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vbXNtL2hkbWkvaGRtaV9jb25uZWN0b3IuYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vbXNtL2hkbWkvaGRtaV9jb25uZWN0b3IuYwpAQCAtNCw3ICs0LDcgQEAKICAq
IEF1dGhvcjogUm9iIENsYXJrIDxyb2JkY2xhcmtAZ21haWwuY29tPgogICovCiAKLSNpbmNsdWRl
IDxsaW51eC9ncGlvLmg+CisjaW5jbHVkZSA8bGludXgvZ3Bpby9jb25zdW1lci5oPgogI2luY2x1
ZGUgPGxpbnV4L3BpbmN0cmwvY29uc3VtZXIuaD4KIAogI2luY2x1ZGUgIm1zbV9rbXMuaCIKQEAg
LTY4LDMwICs2OCwyMSBAQCBzdGF0aWMgdm9pZCBtc21faGRtaV9waHlfcmVzZXQoc3RydWN0IGhk
bWkgKmhkbWkpCiAKIHN0YXRpYyBpbnQgZ3Bpb19jb25maWcoc3RydWN0IGhkbWkgKmhkbWksIGJv
b2wgb24pCiB7Ci0Jc3RydWN0IGRldmljZSAqZGV2ID0gJmhkbWktPnBkZXYtPmRldjsKIAljb25z
dCBzdHJ1Y3QgaGRtaV9wbGF0Zm9ybV9jb25maWcgKmNvbmZpZyA9IGhkbWktPmNvbmZpZzsKLQlp
bnQgcmV0LCBpOworCWludCBpOwogCiAJaWYgKG9uKSB7CiAJCWZvciAoaSA9IDA7IGkgPCBIRE1J
X01BWF9OVU1fR1BJTzsgaSsrKSB7CiAJCQlzdHJ1Y3QgaGRtaV9ncGlvX2RhdGEgZ3BpbyA9IGNv
bmZpZy0+Z3Bpb3NbaV07CiAKLQkJCWlmIChncGlvLm51bSAhPSAtMSkgewotCQkJCXJldCA9IGdw
aW9fcmVxdWVzdChncGlvLm51bSwgZ3Bpby5sYWJlbCk7Ci0JCQkJaWYgKHJldCkgewotCQkJCQlE
Uk1fREVWX0VSUk9SKGRldiwKLQkJCQkJCSInJXMnKCVkKSBncGlvX3JlcXVlc3QgZmFpbGVkOiAl
ZFxuIiwKLQkJCQkJCWdwaW8ubGFiZWwsIGdwaW8ubnVtLCByZXQpOwotCQkJCQlnb3RvIGVycjsK
LQkJCQl9Ci0KKwkJCWlmIChncGlvLmdwaW9kKSB7CiAJCQkJaWYgKGdwaW8ub3V0cHV0KSB7Ci0J
CQkJCWdwaW9fZGlyZWN0aW9uX291dHB1dChncGlvLm51bSwKLQkJCQkJCQkgICAgICBncGlvLnZh
bHVlKTsKKwkJCQkJZ3Bpb2RfZGlyZWN0aW9uX291dHB1dChncGlvLmdwaW9kLAorCQkJCQkJCSAg
ICAgICBncGlvLnZhbHVlKTsKIAkJCQl9IGVsc2UgewotCQkJCQlncGlvX2RpcmVjdGlvbl9pbnB1
dChncGlvLm51bSk7Ci0JCQkJCWdwaW9fc2V0X3ZhbHVlX2NhbnNsZWVwKGdwaW8ubnVtLAotCQkJ
CQkJCQlncGlvLnZhbHVlKTsKKwkJCQkJZ3Bpb2RfZGlyZWN0aW9uX2lucHV0KGdwaW8uZ3Bpb2Qp
OworCQkJCQlncGlvZF9zZXRfdmFsdWVfY2Fuc2xlZXAoZ3Bpby5ncGlvZCwKKwkJCQkJCQkJIGdw
aW8udmFsdWUpOwogCQkJCX0KIAkJCX0KIAkJfQpAQCAtMTAxLDI5ICs5MiwyMCBAQCBzdGF0aWMg
aW50IGdwaW9fY29uZmlnKHN0cnVjdCBoZG1pICpoZG1pLCBib29sIG9uKQogCQlmb3IgKGkgPSAw
OyBpIDwgSERNSV9NQVhfTlVNX0dQSU87IGkrKykgewogCQkJc3RydWN0IGhkbWlfZ3Bpb19kYXRh
IGdwaW8gPSBjb25maWctPmdwaW9zW2ldOwogCi0JCQlpZiAoZ3Bpby5udW0gPT0gLTEpCisJCQlp
ZiAoIWdwaW8uZ3Bpb2QpCiAJCQkJY29udGludWU7CiAKIAkJCWlmIChncGlvLm91dHB1dCkgewog
CQkJCWludCB2YWx1ZSA9IGdwaW8udmFsdWUgPyAwIDogMTsKIAotCQkJCWdwaW9fc2V0X3ZhbHVl
X2NhbnNsZWVwKGdwaW8ubnVtLCB2YWx1ZSk7CisJCQkJZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVw
KGdwaW8uZ3Bpb2QsIHZhbHVlKTsKIAkJCX0KLQotCQkJZ3Bpb19mcmVlKGdwaW8ubnVtKTsKIAkJ
fTsKIAogCQlEQkcoImdwaW8gb2ZmIik7CiAJfQogCiAJcmV0dXJuIDA7Ci1lcnI6Ci0Jd2hpbGUg
KGktLSkgewotCQlpZiAoY29uZmlnLT5ncGlvc1tpXS5udW0gIT0gLTEpCi0JCQlncGlvX2ZyZWUo
Y29uZmlnLT5ncGlvc1tpXS5udW0pOwotCX0KLQotCXJldHVybiByZXQ7CiB9CiAKIHN0YXRpYyB2
b2lkIGVuYWJsZV9ocGRfY2xvY2tzKHN0cnVjdCBoZG1pICpoZG1pLCBib29sIGVuYWJsZSkKQEAg
LTMxMSw3ICsyOTMsNyBAQCBzdGF0aWMgZW51bSBkcm1fY29ubmVjdG9yX3N0YXR1cyBkZXRlY3Rf
Z3BpbyhzdHJ1Y3QgaGRtaSAqaGRtaSkKIAljb25zdCBzdHJ1Y3QgaGRtaV9wbGF0Zm9ybV9jb25m
aWcgKmNvbmZpZyA9IGhkbWktPmNvbmZpZzsKIAlzdHJ1Y3QgaGRtaV9ncGlvX2RhdGEgaHBkX2dw
aW8gPSBjb25maWctPmdwaW9zW0hQRF9HUElPX0lOREVYXTsKIAotCXJldHVybiBncGlvX2dldF92
YWx1ZShocGRfZ3Bpby5udW0pID8KKwlyZXR1cm4gZ3Bpb2RfZ2V0X3ZhbHVlKGhwZF9ncGlvLmdw
aW9kKSA/CiAJCQljb25uZWN0b3Jfc3RhdHVzX2Nvbm5lY3RlZCA6CiAJCQljb25uZWN0b3Jfc3Rh
dHVzX2Rpc2Nvbm5lY3RlZDsKIH0KQEAgLTMzMCw3ICszMTIsNyBAQCBzdGF0aWMgZW51bSBkcm1f
Y29ubmVjdG9yX3N0YXR1cyBoZG1pX2Nvbm5lY3Rvcl9kZXRlY3QoCiAJICogc29tZSBwbGF0Zm9y
bXMgbWF5IG5vdCBoYXZlIGhwZCBncGlvLiBSZWx5IG9ubHkgb24gdGhlIHN0YXR1cwogCSAqIHBy
b3ZpZGVkIGJ5IFJFR19IRE1JX0hQRF9JTlRfU1RBVFVTIGluIHRoaXMgY2FzZS4KIAkgKi8KLQlp
ZiAoaHBkX2dwaW8ubnVtID09IC0xKQorCWlmICghaHBkX2dwaW8uZ3Bpb2QpCiAJCXJldHVybiBk
ZXRlY3RfcmVnKGhkbWkpOwogCiAJZG8gewotLSAKMi4yMS4wCgpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1k
ZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcv
bWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
