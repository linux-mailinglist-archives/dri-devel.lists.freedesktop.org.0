Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 5894424D944
	for <lists+dri-devel@lfdr.de>; Fri, 21 Aug 2020 18:01:14 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EC8476EB07;
	Fri, 21 Aug 2020 16:01:07 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-wm1-x344.google.com (mail-wm1-x344.google.com
 [IPv6:2a00:1450:4864:20::344])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4AAFB6EAE3;
 Fri, 21 Aug 2020 16:01:06 +0000 (UTC)
Received: by mail-wm1-x344.google.com with SMTP id 9so2387462wmj.5;
 Fri, 21 Aug 2020 09:01:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:subject:date:message-id:in-reply-to:references:mime-version
 :content-transfer-encoding;
 bh=hRm9Y/E2HM99+tnIiA9A9H58oW+FZuHAuMi/2kZPMJk=;
 b=QDW6MdgGA0foO1tu4mDeLC0oIAoQl8L3w65+ErHK8BcDq7X8xxipI/XNWiMK+TJjpi
 GjaOlBGrGSN+GM0x88qdwcceGCktd0h3rKTE0W5m1wafsYyC8S5Kjyf982AfV0MCuOsl
 Gtkf5bzHoJ4gilUlIfwOQNJKIgvzkVu4XwUm4SqDHk2AvX4F94knrG/18+n0FwWk05cA
 ynUlgK71BGUY3kwzvXQEKBciV0Svin4gXIkC5Y5PElREE+Pvv1Cwt7eJ5RMiL8Deom/X
 Bix9/PfQFA0e4tZAGAGut/jHQVhM96HXdqzd5rkMV3IpFu2mbEH0Vy33/FnNPgM8OVZN
 Z5Gw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=hRm9Y/E2HM99+tnIiA9A9H58oW+FZuHAuMi/2kZPMJk=;
 b=lSemPML3W4GFxzJkMfCHJx3l1d81MXbC7K8mbcNaimV2PUzeDcYjjwygX5CJS7X02m
 uJxTuG5HBQ5HOsoXpU4DAAvwqmtkDOSaJJ6mb2pNZSExJ+cTA2JzQSpIA3wta/4jYz9w
 5esYL+lo2xO9EJWkJKXP1Zdicp5f5uGDvv2EcoisYway3Iy0u97NWKuEnnw0M98n4tkh
 /g2AnDa8HH6hfBJqdVg9ThOaOP1P1HDA9yPFBF7XUgjWUVjvE1OD61D43nDQOCpD2rSK
 Sx7c8Kly3UhioBb9heN9fAlQ6AqiQIPiXfcEvykV0AnFD9yg9myWMNXWOXvA0YXjYxHQ
 /TUg==
X-Gm-Message-State: AOAM533/498vRHvuylA9LWGTfWS9glgObokj5seJ/wuN8F5ysdJtaSKD
 zVxqL4PXEI3dks4ZQaxf/BQ=
X-Google-Smtp-Source: ABdhPJzFcb6fZlojgRr6ksQz5U+r8fP3YWka4L7mj9iKh4B3xcSmdWn/aDd0BBRaQkxVYnZBl1qGNA==
X-Received: by 2002:a1c:105:: with SMTP id 5mr3815549wmb.175.1598025664652;
 Fri, 21 Aug 2020 09:01:04 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:f174:75c9:ca38:873f])
 by smtp.gmail.com with ESMTPSA id l81sm6554993wmf.4.2020.08.21.09.01.02
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 21 Aug 2020 09:01:02 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: airlied@gmail.com, skeggsb@gmail.com, dri-devel@lists.freedesktop.org,
 Nouveau@lists.freedesktop.org
Subject: [PATCH 3/3] drm/ttm: remove io_reserve_lru handling
Date: Fri, 21 Aug 2020 18:00:50 +0200
Message-Id: <20200821160050.1368-4-christian.koenig@amd.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200821160050.1368-1-christian.koenig@amd.com>
References: <20200821160050.1368-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogQ2hyaXN0aWFuIEvDtm5pZyA8Y2tvZW5pZy5sZWljaHR6dW1lcmtlbkBnbWFpbC5jb20+
CgpUaGF0IGlzIG5vdCB1c2VkIGFueSBtb3JlLgoKU2lnbmVkLW9mZi1ieTogQ2hyaXN0aWFuIEvD
tm5pZyA8Y2hyaXN0aWFuLmtvZW5pZ0BhbWQuY29tPgpBY2tlZC1ieTogRGFuaWVsIFZldHRlciA8
ZGFuaWVsLnZldHRlckBmZndsbC5jaD4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5j
ICAgICAgIHwgIDM0ICsrLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm9fdXRpbC5j
ICB8IDEwOCArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL3R0
bS90dG1fYm9fdm0uYyAgICB8ICAzOSArKystLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL3R0bS90
dG1fcmVzb3VyY2UuYyB8ICAgMyAtCiBpbmNsdWRlL2RybS90dG0vdHRtX2JvX2FwaS5oICAgICAg
IHwgICAxIC0KIGluY2x1ZGUvZHJtL3R0bS90dG1fYm9fZHJpdmVyLmggICAgfCAgIDUgLS0KIGlu
Y2x1ZGUvZHJtL3R0bS90dG1fcmVzb3VyY2UuaCAgICAgfCAgMTYgLS0tLS0KIDcgZmlsZXMgY2hh
bmdlZCwgMTggaW5zZXJ0aW9ucygrKSwgMTg4IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvLmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5j
CmluZGV4IDYwYjU4M2QwN2IwNC4uODI1NzQyMWZjOWEwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vdHRtL3R0bV9iby5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvLmMKQEAg
LTI2MywxMSArMjYzLDcgQEAgc3RhdGljIGludCB0dG1fYm9faGFuZGxlX21vdmVfbWVtKHN0cnVj
dCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICpu
ZXdfbWFuID0gdHRtX21hbmFnZXJfdHlwZShiZGV2LCBtZW0tPm1lbV90eXBlKTsKIAlpbnQgcmV0
OwogCi0JcmV0ID0gdHRtX21lbV9pb19sb2NrKG9sZF9tYW4sIHRydWUpOwotCWlmICh1bmxpa2Vs
eShyZXQgIT0gMCkpCi0JCWdvdG8gb3V0X2VycjsKLQl0dG1fYm9fdW5tYXBfdmlydHVhbF9sb2Nr
ZWQoYm8pOwotCXR0bV9tZW1faW9fdW5sb2NrKG9sZF9tYW4pOworCXR0bV9ib191bm1hcF92aXJ0
dWFsKGJvKTsKIAogCS8qCiAJICogQ3JlYXRlIGFuZCBiaW5kIGEgdHRtIGlmIHJlcXVpcmVkLgpA
QCAtNTM4LDcgKzUzNCw2IEBAIHN0YXRpYyB2b2lkIHR0bV9ib19yZWxlYXNlKHN0cnVjdCBrcmVm
ICprcmVmKQogCXN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8gPQogCSAgICBjb250YWluZXJf
b2Yoa3JlZiwgc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0LCBrcmVmKTsKIAlzdHJ1Y3QgdHRtX2Jv
X2RldmljZSAqYmRldiA9IGJvLT5iZGV2OwotCXN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAq
bWFuID0gdHRtX21hbmFnZXJfdHlwZShiZGV2LCBiby0+bWVtLm1lbV90eXBlKTsKIAlzaXplX3Qg
YWNjX3NpemUgPSBiby0+YWNjX3NpemU7CiAJaW50IHJldDsKIApAQCAtNTU2LDkgKzU1MSw3IEBA
IHN0YXRpYyB2b2lkIHR0bV9ib19yZWxlYXNlKHN0cnVjdCBrcmVmICprcmVmKQogCQkJYm8tPmJk
ZXYtPmRyaXZlci0+cmVsZWFzZV9ub3RpZnkoYm8pOwogCiAJCWRybV92bWFfb2Zmc2V0X3JlbW92
ZShiZGV2LT52bWFfbWFuYWdlciwgJmJvLT5iYXNlLnZtYV9ub2RlKTsKLQkJdHRtX21lbV9pb19s
b2NrKG1hbiwgZmFsc2UpOwotCQl0dG1fbWVtX2lvX2ZyZWVfdm0oYm8pOwotCQl0dG1fbWVtX2lv
X3VubG9jayhtYW4pOworCQl0dG1fbWVtX2lvX2ZyZWUoYmRldiwgJmJvLT5tZW0pOwogCX0KIAog
CWlmICghZG1hX3Jlc3ZfdGVzdF9zaWduYWxlZF9yY3UoYm8tPmJhc2UucmVzdiwgdHJ1ZSkgfHwK
QEAgLTY0OCw4ICs2NDEsNiBAQCBzdGF0aWMgaW50IHR0bV9ib19ldmljdChzdHJ1Y3QgdHRtX2J1
ZmZlcl9vYmplY3QgKmJvLAogCiAJZXZpY3RfbWVtID0gYm8tPm1lbTsKIAlldmljdF9tZW0ubW1f
bm9kZSA9IE5VTEw7Ci0JZXZpY3RfbWVtLmJ1cy5pb19yZXNlcnZlZF92bSA9IGZhbHNlOwotCWV2
aWN0X21lbS5idXMuaW9fcmVzZXJ2ZWRfY291bnQgPSAwOwogCWV2aWN0X21lbS5idXMuYmFzZSA9
IDA7CiAJZXZpY3RfbWVtLmJ1cy5vZmZzZXQgPSAwOwogCkBAIC0xMDg0LDggKzEwNzUsNiBAQCBz
dGF0aWMgaW50IHR0bV9ib19tb3ZlX2J1ZmZlcihzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJv
LAogCW1lbS5udW1fcGFnZXMgPSBiby0+bnVtX3BhZ2VzOwogCW1lbS5zaXplID0gbWVtLm51bV9w
YWdlcyA8PCBQQUdFX1NISUZUOwogCW1lbS5wYWdlX2FsaWdubWVudCA9IGJvLT5tZW0ucGFnZV9h
bGlnbm1lbnQ7Ci0JbWVtLmJ1cy5pb19yZXNlcnZlZF92bSA9IGZhbHNlOwotCW1lbS5idXMuaW9f
cmVzZXJ2ZWRfY291bnQgPSAwOwogCW1lbS5idXMuYmFzZSA9IDA7CiAJbWVtLmJ1cy5vZmZzZXQg
PSAwOwogCW1lbS5tbV9ub2RlID0gTlVMTDsKQEAgLTEyMzYsNyArMTIyNSw2IEBAIGludCB0dG1f
Ym9faW5pdF9yZXNlcnZlZChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKIAlJTklUX0xJU1Rf
SEVBRCgmYm8tPmxydSk7CiAJSU5JVF9MSVNUX0hFQUQoJmJvLT5kZGVzdHJveSk7CiAJSU5JVF9M
SVNUX0hFQUQoJmJvLT5zd2FwKTsKLQlJTklUX0xJU1RfSEVBRCgmYm8tPmlvX3Jlc2VydmVfbHJ1
KTsKIAliby0+YmRldiA9IGJkZXY7CiAJYm8tPnR5cGUgPSB0eXBlOwogCWJvLT5udW1fcGFnZXMg
PSBudW1fcGFnZXM7CkBAIC0xMjQ1LDggKzEyMzMsNiBAQCBpbnQgdHRtX2JvX2luaXRfcmVzZXJ2
ZWQoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCiAJYm8tPm1lbS5udW1fcGFnZXMgPSBiby0+
bnVtX3BhZ2VzOwogCWJvLT5tZW0ubW1fbm9kZSA9IE5VTEw7CiAJYm8tPm1lbS5wYWdlX2FsaWdu
bWVudCA9IHBhZ2VfYWxpZ25tZW50OwotCWJvLT5tZW0uYnVzLmlvX3Jlc2VydmVkX3ZtID0gZmFs
c2U7Ci0JYm8tPm1lbS5idXMuaW9fcmVzZXJ2ZWRfY291bnQgPSAwOwogCWJvLT5tZW0uYnVzLmJh
c2UgPSAwOwogCWJvLT5tZW0uYnVzLm9mZnNldCA9IDA7CiAJYm8tPm1vdmluZyA9IE5VTEw7CkBA
IC0xNTUxLDI1ICsxNTM3LDEzIEBAIEVYUE9SVF9TWU1CT0wodHRtX2JvX2RldmljZV9pbml0KTsK
ICAqIGJ1ZmZlciBvYmplY3Qgdm0gZnVuY3Rpb25zLgogICovCiAKLXZvaWQgdHRtX2JvX3VubWFw
X3ZpcnR1YWxfbG9ja2VkKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8pCi17Ci0Jc3RydWN0
IHR0bV9ib19kZXZpY2UgKmJkZXYgPSBiby0+YmRldjsKLQotCWRybV92bWFfbm9kZV91bm1hcCgm
Ym8tPmJhc2Uudm1hX25vZGUsIGJkZXYtPmRldl9tYXBwaW5nKTsKLQl0dG1fbWVtX2lvX2ZyZWVf
dm0oYm8pOwotfQotCiB2b2lkIHR0bV9ib191bm1hcF92aXJ0dWFsKHN0cnVjdCB0dG1fYnVmZmVy
X29iamVjdCAqYm8pCiB7CiAJc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYgPSBiby0+YmRldjsK
LQlzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiA9IHR0bV9tYW5hZ2VyX3R5cGUoYmRl
diwgYm8tPm1lbS5tZW1fdHlwZSk7CiAKLQl0dG1fbWVtX2lvX2xvY2sobWFuLCBmYWxzZSk7Ci0J
dHRtX2JvX3VubWFwX3ZpcnR1YWxfbG9ja2VkKGJvKTsKLQl0dG1fbWVtX2lvX3VubG9jayhtYW4p
OworCWRybV92bWFfbm9kZV91bm1hcCgmYm8tPmJhc2Uudm1hX25vZGUsIGJkZXYtPmRldl9tYXBw
aW5nKTsKKwl0dG1fbWVtX2lvX2ZyZWUoYmRldiwgJmJvLT5tZW0pOwogfQotCi0KIEVYUE9SVF9T
WU1CT0wodHRtX2JvX3VubWFwX3ZpcnR1YWwpOwogCiBpbnQgdHRtX2JvX3dhaXQoc3RydWN0IHR0
bV9idWZmZXJfb2JqZWN0ICpibywKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRt
X2JvX3V0aWwuYyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3V0aWwuYwppbmRleCA3YjM3
MmVkZTEyYzIuLjM4ZGJjYWUzMTAyNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0bS90
dG1fYm9fdXRpbC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3V0aWwuYwpAQCAt
OTEsMTE4ICs5MSwzMSBAQCBpbnQgdHRtX2JvX21vdmVfdHRtKHN0cnVjdCB0dG1fYnVmZmVyX29i
amVjdCAqYm8sCiB9CiBFWFBPUlRfU1lNQk9MKHR0bV9ib19tb3ZlX3R0bSk7CiAKLWludCB0dG1f
bWVtX2lvX2xvY2soc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYW4sIGJvb2wgaW50ZXJy
dXB0aWJsZSkKLXsKLQlpZiAobGlrZWx5KCFtYW4tPnVzZV9pb19yZXNlcnZlX2xydSkpCi0JCXJl
dHVybiAwOwotCi0JaWYgKGludGVycnVwdGlibGUpCi0JCXJldHVybiBtdXRleF9sb2NrX2ludGVy
cnVwdGlibGUoJm1hbi0+aW9fcmVzZXJ2ZV9tdXRleCk7Ci0KLQltdXRleF9sb2NrKCZtYW4tPmlv
X3Jlc2VydmVfbXV0ZXgpOwotCXJldHVybiAwOwotfQotCi12b2lkIHR0bV9tZW1faW9fdW5sb2Nr
KHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuKQotewotCWlmIChsaWtlbHkoIW1hbi0+
dXNlX2lvX3Jlc2VydmVfbHJ1KSkKLQkJcmV0dXJuOwotCi0JbXV0ZXhfdW5sb2NrKCZtYW4tPmlv
X3Jlc2VydmVfbXV0ZXgpOwotfQotCi1zdGF0aWMgaW50IHR0bV9tZW1faW9fZXZpY3Qoc3RydWN0
IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYW4pCi17Ci0Jc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0
ICpibzsKLQotCWJvID0gbGlzdF9maXJzdF9lbnRyeV9vcl9udWxsKCZtYW4tPmlvX3Jlc2VydmVf
bHJ1LAotCQkJCSAgICAgIHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCwKLQkJCQkgICAgICBpb19y
ZXNlcnZlX2xydSk7Ci0JaWYgKCFibykKLQkJcmV0dXJuIC1FTk9TUEM7Ci0KLQlsaXN0X2RlbF9p
bml0KCZiby0+aW9fcmVzZXJ2ZV9scnUpOwotCXR0bV9ib191bm1hcF92aXJ0dWFsX2xvY2tlZChi
byk7Ci0JcmV0dXJuIDA7Ci19Ci0KIGludCB0dG1fbWVtX2lvX3Jlc2VydmUoc3RydWN0IHR0bV9i
b19kZXZpY2UgKmJkZXYsCiAJCSAgICAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0pCiB7Ci0J
c3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYW4gPSB0dG1fbWFuYWdlcl90eXBlKGJkZXYs
IG1lbS0+bWVtX3R5cGUpOwotCWludCByZXQ7Ci0KLQlpZiAobWVtLT5idXMuaW9fcmVzZXJ2ZWRf
Y291bnQrKykKLQkJcmV0dXJuIDA7Ci0KIAlpZiAoIWJkZXYtPmRyaXZlci0+aW9fbWVtX3Jlc2Vy
dmUpCiAJCXJldHVybiAwOwogCi1yZXRyeToKLQlyZXQgPSBiZGV2LT5kcml2ZXItPmlvX21lbV9y
ZXNlcnZlKGJkZXYsIG1lbSk7Ci0JaWYgKHJldCA9PSAtRU5PU1BDKSB7Ci0JCXJldCA9IHR0bV9t
ZW1faW9fZXZpY3QobWFuKTsKLQkJaWYgKHJldCA9PSAwKQotCQkJZ290byByZXRyeTsKLQl9Ci0J
cmV0dXJuIHJldDsKKwlyZXR1cm4gYmRldi0+ZHJpdmVyLT5pb19tZW1fcmVzZXJ2ZShiZGV2LCBt
ZW0pOwogfQogCiB2b2lkIHR0bV9tZW1faW9fZnJlZShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRl
diwKIAkJICAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0pCiB7Ci0JaWYgKC0tbWVtLT5idXMu
aW9fcmVzZXJ2ZWRfY291bnQpCi0JCXJldHVybjsKLQotCWlmICghYmRldi0+ZHJpdmVyLT5pb19t
ZW1fZnJlZSkKLQkJcmV0dXJuOwotCi0JYmRldi0+ZHJpdmVyLT5pb19tZW1fZnJlZShiZGV2LCBt
ZW0pOwotfQotCi1pbnQgdHRtX21lbV9pb19yZXNlcnZlX3ZtKHN0cnVjdCB0dG1fYnVmZmVyX29i
amVjdCAqYm8pCi17Ci0Jc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYW4gPSB0dG1fbWFu
YWdlcl90eXBlKGJvLT5iZGV2LCBiby0+bWVtLm1lbV90eXBlKTsKLQlzdHJ1Y3QgdHRtX3Jlc291
cmNlICptZW0gPSAmYm8tPm1lbTsKLQlpbnQgcmV0OwotCi0JaWYgKG1lbS0+YnVzLmlvX3Jlc2Vy
dmVkX3ZtKQotCQlyZXR1cm4gMDsKLQotCXJldCA9IHR0bV9tZW1faW9fcmVzZXJ2ZShiby0+YmRl
diwgbWVtKTsKLQlpZiAodW5saWtlbHkocmV0ICE9IDApKQotCQlyZXR1cm4gcmV0OwotCW1lbS0+
YnVzLmlvX3Jlc2VydmVkX3ZtID0gdHJ1ZTsKLQlpZiAobWFuLT51c2VfaW9fcmVzZXJ2ZV9scnUp
Ci0JCWxpc3RfYWRkX3RhaWwoJmJvLT5pb19yZXNlcnZlX2xydSwKLQkJCSAgICAgICZtYW4tPmlv
X3Jlc2VydmVfbHJ1KTsKLQlyZXR1cm4gMDsKLX0KLQotdm9pZCB0dG1fbWVtX2lvX2ZyZWVfdm0o
c3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibykKLXsKLQlzdHJ1Y3QgdHRtX3Jlc291cmNlICpt
ZW0gPSAmYm8tPm1lbTsKLQotCWlmICghbWVtLT5idXMuaW9fcmVzZXJ2ZWRfdm0pCi0JCXJldHVy
bjsKLQotCW1lbS0+YnVzLmlvX3Jlc2VydmVkX3ZtID0gZmFsc2U7Ci0JbGlzdF9kZWxfaW5pdCgm
Ym8tPmlvX3Jlc2VydmVfbHJ1KTsKLQl0dG1fbWVtX2lvX2ZyZWUoYm8tPmJkZXYsIG1lbSk7CisJ
aWYgKGJkZXYtPmRyaXZlci0+aW9fbWVtX2ZyZWUpCisJCWJkZXYtPmRyaXZlci0+aW9fbWVtX2Zy
ZWUoYmRldiwgbWVtKTsKIH0KIAogc3RhdGljIGludCB0dG1fcmVzb3VyY2VfaW9yZW1hcChzdHJ1
Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKIAkJCSAgICAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlICpt
ZW0sCiAJCQkgICAgICAgdm9pZCAqKnZpcnR1YWwpCiB7Ci0Jc3RydWN0IHR0bV9yZXNvdXJjZV9t
YW5hZ2VyICptYW4gPSB0dG1fbWFuYWdlcl90eXBlKGJkZXYsIG1lbS0+bWVtX3R5cGUpOwogCWlu
dCByZXQ7CiAJdm9pZCAqYWRkcjsKIAogCSp2aXJ0dWFsID0gTlVMTDsKLQkodm9pZCkgdHRtX21l
bV9pb19sb2NrKG1hbiwgZmFsc2UpOwogCXJldCA9IHR0bV9tZW1faW9fcmVzZXJ2ZShiZGV2LCBt
ZW0pOwotCXR0bV9tZW1faW9fdW5sb2NrKG1hbik7CiAJaWYgKHJldCB8fCAhbWVtLT5idXMuaXNf
aW9tZW0pCiAJCXJldHVybiByZXQ7CiAKQEAgLTIxNiw5ICsxMjksNyBAQCBzdGF0aWMgaW50IHR0
bV9yZXNvdXJjZV9pb3JlbWFwKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAogCQkJYWRkciA9
IGlvcmVtYXAobWVtLT5idXMuYmFzZSArIG1lbS0+YnVzLm9mZnNldCwKIAkJCQkgICAgICAgbWVt
LT5idXMuc2l6ZSk7CiAJCWlmICghYWRkcikgewotCQkJKHZvaWQpIHR0bV9tZW1faW9fbG9jayht
YW4sIGZhbHNlKTsKIAkJCXR0bV9tZW1faW9fZnJlZShiZGV2LCBtZW0pOwotCQkJdHRtX21lbV9p
b191bmxvY2sobWFuKTsKIAkJCXJldHVybiAtRU5PTUVNOwogCQl9CiAJfQpAQCAtMjM2LDkgKzE0
Nyw3IEBAIHN0YXRpYyB2b2lkIHR0bV9yZXNvdXJjZV9pb3VubWFwKHN0cnVjdCB0dG1fYm9fZGV2
aWNlICpiZGV2LAogCiAJaWYgKHZpcnR1YWwgJiYgbWVtLT5idXMuYWRkciA9PSBOVUxMKQogCQlp
b3VubWFwKHZpcnR1YWwpOwotCSh2b2lkKSB0dG1fbWVtX2lvX2xvY2sobWFuLCBmYWxzZSk7CiAJ
dHRtX21lbV9pb19mcmVlKGJkZXYsIG1lbSk7Ci0JdHRtX21lbV9pb191bmxvY2sobWFuKTsKIH0K
IAogc3RhdGljIGludCB0dG1fY29weV9pb19wYWdlKHZvaWQgKmRzdCwgdm9pZCAqc3JjLCB1bnNp
Z25lZCBsb25nIHBhZ2UpCkBAIC00NTIsNyArMzYxLDYgQEAgc3RhdGljIGludCB0dG1fYnVmZmVy
X29iamVjdF90cmFuc2ZlcihzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCUlOSVRfTElT
VF9IRUFEKCZmYm8tPmJhc2UuZGRlc3Ryb3kpOwogCUlOSVRfTElTVF9IRUFEKCZmYm8tPmJhc2Uu
bHJ1KTsKIAlJTklUX0xJU1RfSEVBRCgmZmJvLT5iYXNlLnN3YXApOwotCUlOSVRfTElTVF9IRUFE
KCZmYm8tPmJhc2UuaW9fcmVzZXJ2ZV9scnUpOwogCWZiby0+YmFzZS5tb3ZpbmcgPSBOVUxMOwog
CWRybV92bWFfbm9kZV9yZXNldCgmZmJvLT5iYXNlLmJhc2Uudm1hX25vZGUpOwogCkBAIC01Njcs
OCArNDc1LDYgQEAgaW50IHR0bV9ib19rbWFwKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8s
CiAJCXVuc2lnbmVkIGxvbmcgc3RhcnRfcGFnZSwgdW5zaWduZWQgbG9uZyBudW1fcGFnZXMsCiAJ
CXN0cnVjdCB0dG1fYm9fa21hcF9vYmogKm1hcCkKIHsKLQlzdHJ1Y3QgdHRtX3Jlc291cmNlX21h
bmFnZXIgKm1hbiA9Ci0JCXR0bV9tYW5hZ2VyX3R5cGUoYm8tPmJkZXYsIGJvLT5tZW0ubWVtX3R5
cGUpOwogCXVuc2lnbmVkIGxvbmcgb2Zmc2V0LCBzaXplOwogCWludCByZXQ7CiAKQEAgLTU3OSw5
ICs0ODUsNyBAQCBpbnQgdHRtX2JvX2ttYXAoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywK
IAlpZiAoc3RhcnRfcGFnZSA+IGJvLT5udW1fcGFnZXMpCiAJCXJldHVybiAtRUlOVkFMOwogCi0J
KHZvaWQpIHR0bV9tZW1faW9fbG9jayhtYW4sIGZhbHNlKTsKIAlyZXQgPSB0dG1fbWVtX2lvX3Jl
c2VydmUoYm8tPmJkZXYsICZiby0+bWVtKTsKLQl0dG1fbWVtX2lvX3VubG9jayhtYW4pOwogCWlm
IChyZXQpCiAJCXJldHVybiByZXQ7CiAJaWYgKCFiby0+bWVtLmJ1cy5pc19pb21lbSkgewpAQCAt
NTk2LDEwICs1MDAsNiBAQCBFWFBPUlRfU1lNQk9MKHR0bV9ib19rbWFwKTsKIAogdm9pZCB0dG1f
Ym9fa3VubWFwKHN0cnVjdCB0dG1fYm9fa21hcF9vYmogKm1hcCkKIHsKLQlzdHJ1Y3QgdHRtX2J1
ZmZlcl9vYmplY3QgKmJvID0gbWFwLT5ibzsKLQlzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIg
Km1hbiA9Ci0JCXR0bV9tYW5hZ2VyX3R5cGUoYm8tPmJkZXYsIGJvLT5tZW0ubWVtX3R5cGUpOwot
CiAJaWYgKCFtYXAtPnZpcnR1YWwpCiAJCXJldHVybjsKIAlzd2l0Y2ggKG1hcC0+Ym9fa21hcF90
eXBlKSB7CkBAIC02MTcsOSArNTE3LDcgQEAgdm9pZCB0dG1fYm9fa3VubWFwKHN0cnVjdCB0dG1f
Ym9fa21hcF9vYmogKm1hcCkKIAlkZWZhdWx0OgogCQlCVUcoKTsKIAl9Ci0JKHZvaWQpIHR0bV9t
ZW1faW9fbG9jayhtYW4sIGZhbHNlKTsKIAl0dG1fbWVtX2lvX2ZyZWUobWFwLT5iby0+YmRldiwg
Jm1hcC0+Ym8tPm1lbSk7Ci0JdHRtX21lbV9pb191bmxvY2sobWFuKTsKIAltYXAtPnZpcnR1YWwg
PSBOVUxMOwogCW1hcC0+cGFnZSA9IE5VTEw7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vdHRtL3R0bV9ib192bS5jIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm9fdm0uYwppbmRl
eCAwYjgwNWY3MmQxOGUuLmQzZGMwNjgyNDI1YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L3R0bS90dG1fYm9fdm0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib192bS5jCkBA
IC0yODEsOCArMjgxLDYgQEAgdm1fZmF1bHRfdCB0dG1fYm9fdm1fZmF1bHRfcmVzZXJ2ZWQoc3Ry
dWN0IHZtX2ZhdWx0ICp2bWYsCiAJcGdvZmZfdCBpOwogCXZtX2ZhdWx0X3QgcmV0ID0gVk1fRkFV
TFRfTk9QQUdFOwogCXVuc2lnbmVkIGxvbmcgYWRkcmVzcyA9IHZtZi0+YWRkcmVzczsKLQlzdHJ1
Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiA9Ci0JCXR0bV9tYW5hZ2VyX3R5cGUoYmRldiwg
Ym8tPm1lbS5tZW1fdHlwZSk7CiAKIAkvKgogCSAqIFJlZnVzZSB0byBmYXVsdCBpbXBvcnRlZCBw
YWdlcy4gVGhpcyBzaG91bGQgYmUgaGFuZGxlZApAQCAtMzIxLDI0ICszMTksMTcgQEAgdm1fZmF1
bHRfdCB0dG1fYm9fdm1fZmF1bHRfcmVzZXJ2ZWQoc3RydWN0IHZtX2ZhdWx0ICp2bWYsCiAJaWYg
KHVubGlrZWx5KHJldCAhPSAwKSkKIAkJcmV0dXJuIHJldDsKIAotCWVyciA9IHR0bV9tZW1faW9f
bG9jayhtYW4sIHRydWUpOworCWVyciA9IHR0bV9tZW1faW9fcmVzZXJ2ZShiZGV2LCAmYm8tPm1l
bSk7CiAJaWYgKHVubGlrZWx5KGVyciAhPSAwKSkKLQkJcmV0dXJuIFZNX0ZBVUxUX05PUEFHRTsK
LQllcnIgPSB0dG1fbWVtX2lvX3Jlc2VydmVfdm0oYm8pOwotCWlmICh1bmxpa2VseShlcnIgIT0g
MCkpIHsKLQkJcmV0ID0gVk1fRkFVTFRfU0lHQlVTOwotCQlnb3RvIG91dF9pb191bmxvY2s7Ci0J
fQorCQlyZXR1cm4gVk1fRkFVTFRfU0lHQlVTOwogCiAJcGFnZV9vZmZzZXQgPSAoKGFkZHJlc3Mg
LSB2bWEtPnZtX3N0YXJ0KSA+PiBQQUdFX1NISUZUKSArCiAJCXZtYS0+dm1fcGdvZmYgLSBkcm1f
dm1hX25vZGVfc3RhcnQoJmJvLT5iYXNlLnZtYV9ub2RlKTsKIAlwYWdlX2xhc3QgPSB2bWFfcGFn
ZXModm1hKSArIHZtYS0+dm1fcGdvZmYgLQogCQlkcm1fdm1hX25vZGVfc3RhcnQoJmJvLT5iYXNl
LnZtYV9ub2RlKTsKIAotCWlmICh1bmxpa2VseShwYWdlX29mZnNldCA+PSBiby0+bnVtX3BhZ2Vz
KSkgewotCQlyZXQgPSBWTV9GQVVMVF9TSUdCVVM7Ci0JCWdvdG8gb3V0X2lvX3VubG9jazsKLQl9
CisJaWYgKHVubGlrZWx5KHBhZ2Vfb2Zmc2V0ID49IGJvLT5udW1fcGFnZXMpKQorCQlyZXR1cm4g
Vk1fRkFVTFRfU0lHQlVTOwogCiAJcHJvdCA9IHR0bV9pb19wcm90KGJvLT5tZW0ucGxhY2VtZW50
LCBwcm90KTsKIAlpZiAoIWJvLT5tZW0uYnVzLmlzX2lvbWVtKSB7CkBAIC0zNTAsMjEgKzM0MSwx
NyBAQCB2bV9mYXVsdF90IHR0bV9ib192bV9mYXVsdF9yZXNlcnZlZChzdHJ1Y3Qgdm1fZmF1bHQg
KnZtZiwKIAkJfTsKIAogCQl0dG0gPSBiby0+dHRtOwotCQlpZiAodHRtX3R0X3BvcHVsYXRlKGJv
LT50dG0sICZjdHgpKSB7Ci0JCQlyZXQgPSBWTV9GQVVMVF9PT007Ci0JCQlnb3RvIG91dF9pb191
bmxvY2s7Ci0JCX0KKwkJaWYgKHR0bV90dF9wb3B1bGF0ZShiby0+dHRtLCAmY3R4KSkKKwkJCXJl
dHVybiBWTV9GQVVMVF9PT007CiAJfSBlbHNlIHsKIAkJLyogSW9tZW0gc2hvdWxkIG5vdCBiZSBt
YXJrZWQgZW5jcnlwdGVkICovCiAJCXByb3QgPSBwZ3Byb3RfZGVjcnlwdGVkKHByb3QpOwogCX0K
IAogCS8qIFdlIGRvbid0IHByZWZhdWx0IG9uIGh1Z2UgZmF1bHRzLiBZZXQuICovCi0JaWYgKElT
X0VOQUJMRUQoQ09ORklHX1RSQU5TUEFSRU5UX0hVR0VQQUdFKSAmJiBmYXVsdF9wYWdlX3NpemUg
IT0gMSkgewotCQlyZXQgPSB0dG1fYm9fdm1faW5zZXJ0X2h1Z2Uodm1mLCBibywgcGFnZV9vZmZz
ZXQsCi0JCQkJCSAgICBmYXVsdF9wYWdlX3NpemUsIHByb3QpOwotCQlnb3RvIG91dF9pb191bmxv
Y2s7Ci0JfQorCWlmIChJU19FTkFCTEVEKENPTkZJR19UUkFOU1BBUkVOVF9IVUdFUEFHRSkgJiYg
ZmF1bHRfcGFnZV9zaXplICE9IDEpCisJCXJldHVybiB0dG1fYm9fdm1faW5zZXJ0X2h1Z2Uodm1m
LCBibywgcGFnZV9vZmZzZXQsCisJCQkJCSAgICAgZmF1bHRfcGFnZV9zaXplLCBwcm90KTsKIAog
CS8qCiAJICogU3BlY3VsYXRpdmVseSBwcmVmYXVsdCBhIG51bWJlciBvZiBwYWdlcy4gT25seSBl
cnJvciBvbgpAQCAtMzc2LDggKzM2Myw3IEBAIHZtX2ZhdWx0X3QgdHRtX2JvX3ZtX2ZhdWx0X3Jl
c2VydmVkKHN0cnVjdCB2bV9mYXVsdCAqdm1mLAogCQl9IGVsc2UgewogCQkJcGFnZSA9IHR0bS0+
cGFnZXNbcGFnZV9vZmZzZXRdOwogCQkJaWYgKHVubGlrZWx5KCFwYWdlICYmIGkgPT0gMCkpIHsK
LQkJCQlyZXQgPSBWTV9GQVVMVF9PT007Ci0JCQkJZ290byBvdXRfaW9fdW5sb2NrOworCQkJCXJl
dHVybiBWTV9GQVVMVF9PT007CiAJCQl9IGVsc2UgaWYgKHVubGlrZWx5KCFwYWdlKSkgewogCQkJ
CWJyZWFrOwogCQkJfQpAQCAtNDA0LDcgKzM5MCw3IEBAIHZtX2ZhdWx0X3QgdHRtX2JvX3ZtX2Zh
dWx0X3Jlc2VydmVkKHN0cnVjdCB2bV9mYXVsdCAqdm1mLAogCQkvKiBOZXZlciBlcnJvciBvbiBw
cmVmYXVsdGVkIFBURXMgKi8KIAkJaWYgKHVubGlrZWx5KChyZXQgJiBWTV9GQVVMVF9FUlJPUikp
KSB7CiAJCQlpZiAoaSA9PSAwKQotCQkJCWdvdG8gb3V0X2lvX3VubG9jazsKKwkJCQlyZXR1cm4g
Vk1fRkFVTFRfTk9QQUdFOwogCQkJZWxzZQogCQkJCWJyZWFrOwogCQl9CkBAIC00MTMsOSArMzk5
LDYgQEAgdm1fZmF1bHRfdCB0dG1fYm9fdm1fZmF1bHRfcmVzZXJ2ZWQoc3RydWN0IHZtX2ZhdWx0
ICp2bWYsCiAJCWlmICh1bmxpa2VseSgrK3BhZ2Vfb2Zmc2V0ID49IHBhZ2VfbGFzdCkpCiAJCQli
cmVhazsKIAl9Ci0JcmV0ID0gVk1fRkFVTFRfTk9QQUdFOwotb3V0X2lvX3VubG9jazoKLQl0dG1f
bWVtX2lvX3VubG9jayhtYW4pOwogCXJldHVybiByZXQ7CiB9CiBFWFBPUlRfU1lNQk9MKHR0bV9i
b192bV9mYXVsdF9yZXNlcnZlZCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0
bV9yZXNvdXJjZS5jIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fcmVzb3VyY2UuYwppbmRleCAz
M2I2NDI1MzJlNWMuLjNhNDYwMmY5YTAzYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0
bS90dG1fcmVzb3VyY2UuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9yZXNvdXJjZS5j
CkBAIC02NSwxMCArNjUsNyBAQCB2b2lkIHR0bV9yZXNvdXJjZV9tYW5hZ2VyX2luaXQoc3RydWN0
IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYW4sCiB7CiAJdW5zaWduZWQgaTsKIAotCW1hbi0+dXNl
X2lvX3Jlc2VydmVfbHJ1ID0gZmFsc2U7Ci0JbXV0ZXhfaW5pdCgmbWFuLT5pb19yZXNlcnZlX211
dGV4KTsKIAlzcGluX2xvY2tfaW5pdCgmbWFuLT5tb3ZlX2xvY2spOwotCUlOSVRfTElTVF9IRUFE
KCZtYW4tPmlvX3Jlc2VydmVfbHJ1KTsKIAltYW4tPnNpemUgPSBwX3NpemU7CiAKIAlmb3IgKGkg
PSAwOyBpIDwgVFRNX01BWF9CT19QUklPUklUWTsgKytpKQpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9k
cm0vdHRtL3R0bV9ib19hcGkuaCBiL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmgKaW5kZXgg
NmM1ODA5ODdiYTE2Li4zNmZmNjRlMjczNmMgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvZHJtL3R0bS90
dG1fYm9fYXBpLmgKKysrIGIvaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19hcGkuaApAQCAtMTUxLDcg
KzE1MSw2IEBAIHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCB7CiAJc3RydWN0IGxpc3RfaGVhZCBs
cnU7CiAJc3RydWN0IGxpc3RfaGVhZCBkZGVzdHJveTsKIAlzdHJ1Y3QgbGlzdF9oZWFkIHN3YXA7
Ci0Jc3RydWN0IGxpc3RfaGVhZCBpb19yZXNlcnZlX2xydTsKIAogCS8qKgogCSAqIE1lbWJlcnMg
cHJvdGVjdGVkIGJ5IGEgYm8gcmVzZXJ2YXRpb24uCmRpZmYgLS1naXQgYS9pbmNsdWRlL2RybS90
dG0vdHRtX2JvX2RyaXZlci5oIGIvaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19kcml2ZXIuaAppbmRl
eCBiYzhkMGViYjc1NjguLjk3NDRlZDlkNjc3ZSAxMDA2NDQKLS0tIGEvaW5jbHVkZS9kcm0vdHRt
L3R0bV9ib19kcml2ZXIuaAorKysgYi9pbmNsdWRlL2RybS90dG0vdHRtX2JvX2RyaXZlci5oCkBA
IC00NDEsMTEgKzQ0MSw2IEBAIHZvaWQgdHRtX2JvX3VubWFwX3ZpcnR1YWwoc3RydWN0IHR0bV9i
dWZmZXJfb2JqZWN0ICpibyk7CiAgKi8KIHZvaWQgdHRtX2JvX3VubWFwX3ZpcnR1YWxfbG9ja2Vk
KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8pOwogCi1pbnQgdHRtX21lbV9pb19yZXNlcnZl
X3ZtKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8pOwotdm9pZCB0dG1fbWVtX2lvX2ZyZWVf
dm0oc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibyk7Ci1pbnQgdHRtX21lbV9pb19sb2NrKHN0
cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuLCBib29sIGludGVycnVwdGlibGUpOwotdm9p
ZCB0dG1fbWVtX2lvX3VubG9jayhzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbik7Ci0K
IC8qKgogICogdHRtX2JvX3Jlc2VydmU6CiAgKgpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0vdHRt
L3R0bV9yZXNvdXJjZS5oIGIvaW5jbHVkZS9kcm0vdHRtL3R0bV9yZXNvdXJjZS5oCmluZGV4IGJh
YzIyYTU2ZjZjZC4uNTU1Y2NmMTRmOGI2IDEwMDY0NAotLS0gYS9pbmNsdWRlL2RybS90dG0vdHRt
X3Jlc291cmNlLmgKKysrIGIvaW5jbHVkZS9kcm0vdHRtL3R0bV9yZXNvdXJjZS5oCkBAIC0xMTMs
MTAgKzExMyw2IEBAIHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlcl9mdW5jIHsKICAqIEBkZWZh
dWx0X2NhY2hpbmc6IFRoZSBkZWZhdWx0IGNhY2hpbmcgcG9saWN5IHVzZWQgZm9yIGEgYnVmZmVy
IG9iamVjdAogICogcGxhY2VkIGluIHRoaXMgbWVtb3J5IHR5cGUgaWYgdGhlIHVzZXIgZG9lc24n
dCBwcm92aWRlIG9uZS4KICAqIEBmdW5jOiBzdHJ1Y3R1cmUgcG9pbnRlciBpbXBsZW1lbnRpbmcg
dGhlIHJhbmdlIG1hbmFnZXIuIFNlZSBhYm92ZQotICogQGlvX3Jlc2VydmVfbXV0ZXg6IE11dGV4
IG9wdGlvbmFsbHkgcHJvdGVjdGluZyBzaGFyZWQgaW9fcmVzZXJ2ZSBzdHJ1Y3R1cmVzCi0gKiBA
dXNlX2lvX3Jlc2VydmVfbHJ1OiBVc2UgYW4gbHJ1IGxpc3QgdG8gdHJ5IHRvIHVucmVzZXJ2ZSBp
b19tZW1fcmVnaW9ucwotICogcmVzZXJ2ZWQgYnkgdGhlIFRUTSB2bSBzeXN0ZW0uCi0gKiBAaW9f
cmVzZXJ2ZV9scnU6IE9wdGlvbmFsIGxydSBsaXN0IGZvciB1bnJlc2VydmluZyBpbyBtZW0gcmVn
aW9ucy4KICAqIEBtb3ZlX2xvY2s6IGxvY2sgZm9yIG1vdmUgZmVuY2UKICAqIHN0YXRpYyBpbmZv
cm1hdGlvbi4gYmRldjo6ZHJpdmVyOjppb19tZW1fZnJlZSBpcyBuZXZlciB1c2VkLgogICogQGxy
dTogVGhlIGxydSBsaXN0IGZvciB0aGlzIG1lbW9yeSB0eXBlLgpAQCAtMTM0LDE2ICsxMzAsOCBA
QCBzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgewogCXVpbnQzMl90IGF2YWlsYWJsZV9jYWNo
aW5nOwogCXVpbnQzMl90IGRlZmF1bHRfY2FjaGluZzsKIAljb25zdCBzdHJ1Y3QgdHRtX3Jlc291
cmNlX21hbmFnZXJfZnVuYyAqZnVuYzsKLQlzdHJ1Y3QgbXV0ZXggaW9fcmVzZXJ2ZV9tdXRleDsK
LQlib29sIHVzZV9pb19yZXNlcnZlX2xydTsKIAlzcGlubG9ja190IG1vdmVfbG9jazsKIAotCS8q
Ci0JICogUHJvdGVjdGVkIGJ5IEBpb19yZXNlcnZlX211dGV4OgotCSAqLwotCi0Jc3RydWN0IGxp
c3RfaGVhZCBpb19yZXNlcnZlX2xydTsKLQogCS8qCiAJICogUHJvdGVjdGVkIGJ5IHRoZSBnbG9i
YWwtPmxydV9sb2NrLgogCSAqLwpAQCAtMTY0LDggKzE1Miw2IEBAIHN0cnVjdCB0dG1fcmVzb3Vy
Y2VfbWFuYWdlciB7CiAgKiBAaXNfaW9tZW06CQlpcyB0aGlzIGlvIG1lbW9yeSA/CiAgKiBAc2l6
ZToJCXNpemUgaW4gYnl0ZQogICogQG9mZnNldDoJCW9mZnNldCBmcm9tIHRoZSBiYXNlIGFkZHJl
c3MKLSAqIEBpb19yZXNlcnZlZF92bTogICAgIFRoZSBWTSBzeXN0ZW0gaGFzIGEgcmVmY291bnQg
aW4gQGlvX3Jlc2VydmVkX2NvdW50Ci0gKiBAaW9fcmVzZXJ2ZWRfY291bnQ6ICBSZWZjb3VudGlu
ZyB0aGUgbnVtYmVycyBvZiBjYWxsZXJzIHRvIHR0bV9tZW1faW9fcmVzZXJ2ZQogICoKICAqIFN0
cnVjdHVyZSBpbmRpY2F0aW5nIHRoZSBidXMgcGxhY2VtZW50IG9mIGFuIG9iamVjdC4KICAqLwpA
QCAtMTc1LDggKzE2MSw2IEBAIHN0cnVjdCB0dG1fYnVzX3BsYWNlbWVudCB7CiAJdW5zaWduZWQg
bG9uZwlzaXplOwogCXVuc2lnbmVkIGxvbmcJb2Zmc2V0OwogCWJvb2wJCWlzX2lvbWVtOwotCWJv
b2wJCWlvX3Jlc2VydmVkX3ZtOwotCXVpbnQ2NF90ICAgICAgICBpb19yZXNlcnZlZF9jb3VudDsK
IH07CiAKIC8qKgotLSAKMi4xNy4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVl
ZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5m
by9kcmktZGV2ZWwK
