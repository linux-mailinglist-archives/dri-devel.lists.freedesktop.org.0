Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id B5213455B1
	for <lists+dri-devel@lfdr.de>; Fri, 14 Jun 2019 09:22:30 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2DD7389449;
	Fri, 14 Jun 2019 07:21:26 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from pandora.armlinux.org.uk (pandora.armlinux.org.uk
 [IPv6:2001:4d48:ad52:3201:214:fdff:fe10:1be6])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E0BD489AEE
 for <dri-devel@lists.freedesktop.org>; Thu, 13 Jun 2019 15:02:41 +0000 (UTC)
Received: from e0022681537dd.dyn.armlinux.org.uk
 ([2002:4e20:1eda:1:222:68ff:fe15:37dd]:44836 helo=rmk-PC.armlinux.org.uk)
 by pandora.armlinux.org.uk with esmtpsa
 (TLSv1.2:ECDHE-RSA-AES128-GCM-SHA256:128) (Exim 4.90_1)
 (envelope-from <rmk@armlinux.org.uk>)
 id 1hbRF6-0003jy-Kb; Thu, 13 Jun 2019 16:02:20 +0100
Received: from rmk by rmk-PC.armlinux.org.uk with local (Exim
 4.82_1-5b7a7c0-XX) (envelope-from <rmk@armlinux.org.uk>)
 id 1hbRF3-00007S-Rr; Thu, 13 Jun 2019 16:02:17 +0100
In-Reply-To: <20190613150114.xqkyb7j7w4ve4yvr@shell.armlinux.org.uk>
References: <20190613150114.xqkyb7j7w4ve4yvr@shell.armlinux.org.uk>
From: Russell King <rmk+kernel@armlinux.org.uk>
To: dri-devel@lists.freedesktop.org, linux-arm-kernel@lists.infradead.org
Subject: [PATCH 07/18] drm/armada: add support for setting gamma
MIME-Version: 1.0
Content-Disposition: inline
Message-Id: <E1hbRF3-00007S-Rr@rmk-PC.armlinux.org.uk>
Date: Thu, 13 Jun 2019 16:02:17 +0100
X-Mailman-Approved-At: Fri, 14 Jun 2019 07:21:24 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; 
 d=armlinux.org.uk; s=pandora-2019; h=Date:Sender:Message-Id:Content-Type:
 Content-Transfer-Encoding:MIME-Version:Subject:Cc:To:From:References:
 In-Reply-To:Reply-To:Content-ID:Content-Description:Resent-Date:Resent-From:
 Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:List-Id:List-Help:
 List-Unsubscribe:List-Subscribe:List-Post:List-Owner:List-Archive;
 bh=JeVMX6aI1+Z/tyR4St48w2936SMKwWSxzsX8PHJe/6Q=; b=JYlJSLreO6FEFhxPxQUz+FRx5/
 ckVhvqsmvlPjSFc0IeZWl7NqTgTwKfGUNm2NR/5tY9/PFlhPhZ6BCq8G73ky6bbfsDIsa1iiDlP4G
 xXorB146z0EnseekxNdhjAE7MXPZlhpb2iSFbYu6YB8eMDFFREgSz2jcCisN4WR277aKFwOAEutrl
 xu4msBGwd+nW5SmTQTC2RPg3ggAQxrQcQP9di3LboA+xk4byQZc3LtDWBcyHSetczu/SyM9j+BiKC
 uuSLEREl+Ml7R1oYrctn1PR0ePM+kDgaTy+2zFsSd50i0PB2Gm9QjgRg8JBkesvnkrEk/SFAFX4Xj
 yWJQ2t9g==;
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: David Airlie <airlied@linux.ie>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIHN1cHBvcnQgZm9yIHNldHRpbmcgZ2FtbWEgdGhyb3VnaCBib3RoIHRoZSBsZWdhY3kgaW50
ZXJmYWNlcyBhbmQKdGhlIGF0b21pYyBpbnRlcmZhY2VzLgoKU2lnbmVkLW9mZi1ieTogUnVzc2Vs
bCBLaW5nIDxybWsra2VybmVsQGFybWxpbnV4Lm9yZy51az4KLS0tCiBkcml2ZXJzL2dwdS9kcm0v
YXJtYWRhL2FybWFkYV9jcnRjLmMgIHwgNjMgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysKIGRyaXZlcnMvZ3B1L2RybS9hcm1hZGEvYXJtYWRhX2h3LmggICAgfCAgNCArKysKIGRy
aXZlcnMvZ3B1L2RybS9hcm1hZGEvYXJtYWRhX3BsYW5lLmMgfCAgMiArLQogMyBmaWxlcyBjaGFu
Z2VkLCA2OCBpbnNlcnRpb25zKCspLCAxIGRlbGV0aW9uKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FybWFkYS9hcm1hZGFfY3J0Yy5jIGIvZHJpdmVycy9ncHUvZHJtL2FybWFkYS9h
cm1hZGFfY3J0Yy5jCmluZGV4IDA5YmFkZTE1ZjUxYy4uNTk5MWZlYjFiY2M5IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vYXJtYWRhL2FybWFkYV9jcnRjLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2FybWFkYS9hcm1hZGFfY3J0Yy5jCkBAIC0xMzAsNiArMTMwLDQ0IEBAIHN0YXRpYyB2b2lk
IGFybWFkYV9kcm1fY3J0Y19xdWV1ZV9zdGF0ZV9ldmVudChzdHJ1Y3QgZHJtX2NydGMgKmNydGMp
CiAJfQogfQogCitzdGF0aWMgdm9pZCBhcm1hZGFfZHJtX3VwZGF0ZV9nYW1tYShzdHJ1Y3QgZHJt
X2NydGMgKmNydGMpCit7CisJc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpibG9iID0gY3J0Yy0+
c3RhdGUtPmdhbW1hX2x1dDsKKwl2b2lkIF9faW9tZW0gKmJhc2UgPSBkcm1fdG9fYXJtYWRhX2Ny
dGMoY3J0YyktPmJhc2U7CisJaW50IGk7CisKKwlpZiAoYmxvYikgeworCQlzdHJ1Y3QgZHJtX2Nv
bG9yX2x1dCAqbHV0ID0gYmxvYi0+ZGF0YTsKKworCQlhcm1hZGFfdXBkYXRlbChDRkdfQ1NCXzI1
Nng4LCBDRkdfQ1NCXzI1Nng4IHwgQ0ZHX1BEV04yNTZ4OCwKKwkJCSAgICAgICBiYXNlICsgTENE
X1NQVV9TUkFNX1BBUkExKTsKKworCQlmb3IgKGkgPSAwOyBpIDwgMjU2OyBpKyspIHsKKwkJCXdy
aXRlbF9yZWxheGVkKGRybV9jb2xvcl9sdXRfZXh0cmFjdChsdXRbaV0ucmVkLCA4KSwKKwkJCQkg
ICAgICAgYmFzZSArIExDRF9TUFVfU1JBTV9XUkRBVCk7CisJCQl3cml0ZWxfcmVsYXhlZChpIHwg
U1JBTV9XUklURSB8IFNSQU1fR0FNTUFfWVIsCisJCQkJICAgICAgIGJhc2UgKyBMQ0RfU1BVX1NS
QU1fQ1RSTCk7CisJCQlyZWFkbF9yZWxheGVkKGJhc2UgKyBMQ0RfU1BVX0hXQ19PVlNBX0hQWExf
VkxOKTsKKwkJCXdyaXRlbF9yZWxheGVkKGRybV9jb2xvcl9sdXRfZXh0cmFjdChsdXRbaV0uZ3Jl
ZW4sIDgpLAorCQkJCSAgICAgICBiYXNlICsgTENEX1NQVV9TUkFNX1dSREFUKTsKKwkJCXdyaXRl
bF9yZWxheGVkKGkgfCBTUkFNX1dSSVRFIHwgU1JBTV9HQU1NQV9VRywKKwkJCQkgICAgICAgYmFz
ZSArIExDRF9TUFVfU1JBTV9DVFJMKTsKKwkJCXJlYWRsX3JlbGF4ZWQoYmFzZSArIExDRF9TUFVf
SFdDX09WU0FfSFBYTF9WTE4pOworCQkJd3JpdGVsX3JlbGF4ZWQoZHJtX2NvbG9yX2x1dF9leHRy
YWN0KGx1dFtpXS5ibHVlLCA4KSwKKwkJCQkgICAgICAgYmFzZSArIExDRF9TUFVfU1JBTV9XUkRB
VCk7CisJCQl3cml0ZWxfcmVsYXhlZChpIHwgU1JBTV9XUklURSB8IFNSQU1fR0FNTUFfVkIsCisJ
CQkJICAgICAgIGJhc2UgKyBMQ0RfU1BVX1NSQU1fQ1RSTCk7CisJCQlyZWFkbF9yZWxheGVkKGJh
c2UgKyBMQ0RfU1BVX0hXQ19PVlNBX0hQWExfVkxOKTsKKwkJfQorCQlhcm1hZGFfdXBkYXRlbChD
RkdfR0FNTUFfRU5BLCBDRkdfR0FNTUFfRU5BLAorCQkJICAgICAgIGJhc2UgKyBMQ0RfU1BVX0RN
QV9DVFJMMCk7CisJfSBlbHNlIHsKKwkJYXJtYWRhX3VwZGF0ZWwoMCwgQ0ZHX0dBTU1BX0VOQSwg
YmFzZSArIExDRF9TUFVfRE1BX0NUUkwwKTsKKwkJYXJtYWRhX3VwZGF0ZWwoQ0ZHX1BEV04yNTZ4
OCwgQ0ZHX0NTQl8yNTZ4OCB8IENGR19QRFdOMjU2eDgsCisJCQkgICAgICAgYmFzZSArIExDRF9T
UFVfU1JBTV9QQVJBMSk7CisJfQorfQorCiAvKiBUaGUgbW9kZV9jb25maWcubXV0ZXggd2lsbCBi
ZSBoZWxkIGZvciB0aGlzIGNhbGwgKi8KIHN0YXRpYyBib29sIGFybWFkYV9kcm1fY3J0Y19tb2Rl
X2ZpeHVwKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKIAljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlf
bW9kZSAqbW9kZSwgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkaikKQEAgLTMzOCw2ICszNzYs
MjAgQEAgc3RhdGljIHZvaWQgYXJtYWRhX2RybV9jcnRjX21vZGVfc2V0X25vZmIoc3RydWN0IGRy
bV9jcnRjICpjcnRjKQogCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRjcnRjLT5pcnFfbG9jaywg
ZmxhZ3MpOwogfQogCitzdGF0aWMgaW50IGFybWFkYV9kcm1fY3J0Y19hdG9taWNfY2hlY2soc3Ry
dWN0IGRybV9jcnRjICpjcnRjLAorCQkJCQlzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKnN0YXRlKQor
eworCURSTV9ERUJVR19LTVMoIltDUlRDOiVkOiVzXVxuIiwgY3J0Yy0+YmFzZS5pZCwgY3J0Yy0+
bmFtZSk7CisKKwlpZiAoc3RhdGUtPmdhbW1hX2x1dCAmJiBkcm1fY29sb3JfbHV0X3NpemUoc3Rh
dGUtPmdhbW1hX2x1dCkgIT0gMjU2KQorCQlyZXR1cm4gLUVJTlZBTDsKKworCWlmIChzdGF0ZS0+
Y29sb3JfbWdtdF9jaGFuZ2VkKQorCQlzdGF0ZS0+cGxhbmVzX2NoYW5nZWQgPSB0cnVlOworCisJ
cmV0dXJuIDA7Cit9CisKIHN0YXRpYyB2b2lkIGFybWFkYV9kcm1fY3J0Y19hdG9taWNfYmVnaW4o
c3RydWN0IGRybV9jcnRjICpjcnRjLAogCQkJCQkgc3RydWN0IGRybV9jcnRjX3N0YXRlICpvbGRf
Y3J0Y19zdGF0ZSkKIHsKQEAgLTM0NSw2ICszOTcsOSBAQCBzdGF0aWMgdm9pZCBhcm1hZGFfZHJt
X2NydGNfYXRvbWljX2JlZ2luKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKIAogCURSTV9ERUJVR19L
TVMoIltDUlRDOiVkOiVzXVxuIiwgY3J0Yy0+YmFzZS5pZCwgY3J0Yy0+bmFtZSk7CiAKKwlpZiAo
Y3J0Yy0+c3RhdGUtPmNvbG9yX21nbXRfY2hhbmdlZCkKKwkJYXJtYWRhX2RybV91cGRhdGVfZ2Ft
bWEoY3J0Yyk7CisKIAlkY3J0Yy0+cmVnc19pZHggPSAwOwogCWRjcnRjLT5yZWdzID0gZGNydGMt
PmF0b21pY19yZWdzOwogfQpAQCAtNDM5LDYgKzQ5NCw3IEBAIHN0YXRpYyB2b2lkIGFybWFkYV9k
cm1fY3J0Y19hdG9taWNfZW5hYmxlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKIHN0YXRpYyBjb25z
dCBzdHJ1Y3QgZHJtX2NydGNfaGVscGVyX2Z1bmNzIGFybWFkYV9jcnRjX2hlbHBlcl9mdW5jcyA9
IHsKIAkubW9kZV9maXh1cAk9IGFybWFkYV9kcm1fY3J0Y19tb2RlX2ZpeHVwLAogCS5tb2RlX3Nl
dF9ub2ZiCT0gYXJtYWRhX2RybV9jcnRjX21vZGVfc2V0X25vZmIsCisJLmF0b21pY19jaGVjawk9
IGFybWFkYV9kcm1fY3J0Y19hdG9taWNfY2hlY2ssCiAJLmF0b21pY19iZWdpbgk9IGFybWFkYV9k
cm1fY3J0Y19hdG9taWNfYmVnaW4sCiAJLmF0b21pY19mbHVzaAk9IGFybWFkYV9kcm1fY3J0Y19h
dG9taWNfZmx1c2gsCiAJLmF0b21pY19kaXNhYmxlCT0gYXJtYWRhX2RybV9jcnRjX2F0b21pY19k
aXNhYmxlLApAQCAtNzAyLDYgKzc1OCw3IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2NydGNf
ZnVuY3MgYXJtYWRhX2NydGNfZnVuY3MgPSB7CiAJLmN1cnNvcl9zZXQJPSBhcm1hZGFfZHJtX2Ny
dGNfY3Vyc29yX3NldCwKIAkuY3Vyc29yX21vdmUJPSBhcm1hZGFfZHJtX2NydGNfY3Vyc29yX21v
dmUsCiAJLmRlc3Ryb3kJPSBhcm1hZGFfZHJtX2NydGNfZGVzdHJveSwKKwkuZ2FtbWFfc2V0CT0g
ZHJtX2F0b21pY19oZWxwZXJfbGVnYWN5X2dhbW1hX3NldCwKIAkuc2V0X2NvbmZpZwk9IGRybV9h
dG9taWNfaGVscGVyX3NldF9jb25maWcsCiAJLnBhZ2VfZmxpcAk9IGRybV9hdG9taWNfaGVscGVy
X3BhZ2VfZmxpcCwKIAkuYXRvbWljX2R1cGxpY2F0ZV9zdGF0ZSA9IGRybV9hdG9taWNfaGVscGVy
X2NydGNfZHVwbGljYXRlX3N0YXRlLApAQCAtNzkzLDYgKzg1MCwxMiBAQCBzdGF0aWMgaW50IGFy
bWFkYV9kcm1fY3J0Y19jcmVhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRybSwgc3RydWN0IGRldmlj
ZSAqZGV2LAogCiAJZHJtX2NydGNfaGVscGVyX2FkZCgmZGNydGMtPmNydGMsICZhcm1hZGFfY3J0
Y19oZWxwZXJfZnVuY3MpOwogCisJcmV0ID0gZHJtX21vZGVfY3J0Y19zZXRfZ2FtbWFfc2l6ZSgm
ZGNydGMtPmNydGMsIDI1Nik7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCWRybV9jcnRj
X2VuYWJsZV9jb2xvcl9tZ210KCZkY3J0Yy0+Y3J0YywgMCwgZmFsc2UsIDI1Nik7CisKIAlyZXR1
cm4gYXJtYWRhX292ZXJsYXlfcGxhbmVfY3JlYXRlKGRybSwgMSA8PCBkY3J0Yy0+bnVtKTsKIAog
ZXJyX2NydGNfaW5pdDoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hcm1hZGEvYXJtYWRh
X2h3LmggYi9kcml2ZXJzL2dwdS9kcm0vYXJtYWRhL2FybWFkYV9ody5oCmluZGV4IDM0NWRjNGQw
ODUxZS4uYmFiZmNhNzFjNGRiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYXJtYWRhL2Fy
bWFkYV9ody5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hcm1hZGEvYXJtYWRhX2h3LmgKQEAgLTE2
OSw2ICsxNjksMTAgQEAgZW51bSB7CiAJU1JBTV9SRUFECT0gMCA8PCAxNCwKIAlTUkFNX1dSSVRF
CT0gMiA8PCAxNCwKIAlTUkFNX0lOSVQJPSAzIDw8IDE0LAorCVNSQU1fR0FNTUFfWVIJPSAweDAg
PDwgOCwKKwlTUkFNX0dBTU1BX1VHCT0gMHgxIDw8IDgsCisJU1JBTV9HQU1NQV9WQgk9IDB4MiA8
PCA4LAorCVNSQU1fUEFMRVRURQk9IDB4MyA8PCA4LAogCVNSQU1fSFdDMzJfUkFNMQk9IDB4YyA8
PCA4LAogCVNSQU1fSFdDMzJfUkFNMgk9IDB4ZCA8PCA4LAogCVNSQU1fSFdDMzJfUkFNUgk9IFNS
QU1fSFdDMzJfUkFNMSwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hcm1hZGEvYXJtYWRh
X3BsYW5lLmMgYi9kcml2ZXJzL2dwdS9kcm0vYXJtYWRhL2FybWFkYV9wbGFuZS5jCmluZGV4IDQ1
MDkyZmMzNTk4ZS4uZGJkNGQ1MmU4YTMyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYXJt
YWRhL2FybWFkYV9wbGFuZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hcm1hZGEvYXJtYWRhX3Bs
YW5lLmMKQEAgLTI2NSw3ICsyNjUsNyBAQCBzdGF0aWMgdm9pZCBhcm1hZGFfZHJtX3ByaW1hcnlf
cGxhbmVfYXRvbWljX2Rpc2FibGUoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsCiAJLyogRGlzYWJs
ZSBwbGFuZSBhbmQgcG93ZXIgZG93biBtb3N0IFJBTXMgYW5kIEZJRk9zICovCiAJYXJtYWRhX3Jl
Z19xdWV1ZV9tb2QocmVncywgaWR4LCAwLCBDRkdfR1JBX0VOQSwgTENEX1NQVV9ETUFfQ1RSTDAp
OwogCWFybWFkYV9yZWdfcXVldWVfbW9kKHJlZ3MsIGlkeCwgQ0ZHX1BEV04yNTZ4MzIgfCBDRkdf
UERXTjI1NngyNCB8Ci0JCQkgICAgIENGR19QRFdOMjU2eDggfCBDRkdfUERXTjMyeDMyIHwgQ0ZH
X1BEV042NHg2NiwKKwkJCSAgICAgQ0ZHX1BEV04zMngzMiB8IENGR19QRFdONjR4NjYsCiAJCQkg
ICAgIDAsIExDRF9TUFVfU1JBTV9QQVJBMSk7CiAKIAlkY3J0Yy0+cmVnc19pZHggKz0gaWR4Owot
LSAKMi43LjQKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
CmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpo
dHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
