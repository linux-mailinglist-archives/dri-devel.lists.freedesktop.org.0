Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8D4F0AB2C0
	for <lists+dri-devel@lfdr.de>; Fri,  6 Sep 2019 09:01:20 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 012166E14A;
	Fri,  6 Sep 2019 07:01:02 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from NAM04-SN1-obe.outbound.protection.outlook.com
 (mail-eopbgr700091.outbound.protection.outlook.com [40.107.70.91])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1F32A89EBD
 for <dri-devel@lists.freedesktop.org>; Thu,  5 Sep 2019 09:11:55 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=CmnpinzOu7HCXmxO2qL2UjzIPIYTxYpWUzldSPiPLOpbEyJxSc3ZTcitOMaZ0xM0/bAcPIL/f8BxsMQlNeh+mFCXrPfnY8mKM9NdLdoMolw8IxfzteDnHcee65tXgFeVSa/8hKn3axSV9QjWHdBXaM5fxXx4f6JbW1RYmHFujBgM9UF01FxajGt9eB52lKj7Jq/DgXNaaF9Bwp9zWh/p8lragmhHND0fMn25wbEu63RpkO01Bc8012x/silofibgy+dn64Vhd6/L12oRBunX4y8/kjNqHvQTCxdCSPiZDx68JXKszTSFS7H+DtjUxNaiA39MXCpG3qiTu2Ix4BwScA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=OYMSQEz4Sv3yFw5DMmmsO3ZS25FSsCuxpgxZvYGJ7l8=;
 b=GNRVWNyZrkWJFJmPFvRq7bpkhZCK+TQq2kPX3F/yzyb2ktyUDMPRm+miFAPj70TC7zVfFCJuaVyA1u7/RGHypAa9QNJMan6HFIlbtvyn5FO3dyBvVz6/r5MX1wlhUWe1G8Zt/wjlYmo3cDL8IFTwB2T7/yw56DclxPRQ6YBP+EUbsh3HQ+A/FqOsNhB33jeeYj6QNihgPHbVLSmjBicxjD+3EM4EgU0rEa6+5GcqDX4zfYIWDRHrDLugdZJfWo3RTJV2qjRXsBTD20xyoXHUqf/cuQ5qDHYuDw4cB8BqjrVfIp/5qg63I2tXiNJbFXC8NODekU1aj1uYT32xve5e/g==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=microsoft.com; dmarc=pass action=none
 header.from=microsoft.com; dkim=pass header.d=microsoft.com; arc=none
Received: from DM6PR21MB1401.namprd21.prod.outlook.com (10.255.109.88) by
 DM6PR21MB1321.namprd21.prod.outlook.com (20.179.53.72) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2263.6; Thu, 5 Sep 2019 09:11:53 +0000
Received: from DM6PR21MB1401.namprd21.prod.outlook.com
 ([fe80::bd0e:e64e:a357:3759]) by DM6PR21MB1401.namprd21.prod.outlook.com
 ([fe80::bd0e:e64e:a357:3759%5]) with mapi id 15.20.2263.005; Thu, 5 Sep 2019
 09:11:53 +0000
From: Wei Hu <weh@microsoft.com>
To: Michael Kelley <mikelley@microsoft.com>, "b.zolnierkie@samsung.com"
 <b.zolnierkie@samsung.com>, "linux-hyperv@vger.kernel.org"
 <linux-hyperv@vger.kernel.org>, "dri-devel@lists.freedesktop.org"
 <dri-devel@lists.freedesktop.org>, "linux-fbdev@vger.kernel.org"
 <linux-fbdev@vger.kernel.org>, "linux-kernel@vger.kernel.org"
 <linux-kernel@vger.kernel.org>, Stephen Hemminger <sthemmin@microsoft.com>,
 "sashal@kernel.org" <sashal@kernel.org>, Haiyang Zhang
 <haiyangz@microsoft.com>, KY Srinivasan <kys@microsoft.com>, Dexuan Cui
 <decui@microsoft.com>
Subject: [PATCH v4] video: hyperv: hyperv_fb: Obtain screen resolution from
 Hyper-V host
Thread-Topic: [PATCH v4] video: hyperv: hyperv_fb: Obtain screen resolution
 from Hyper-V host
Thread-Index: AQHVY8n1ZHStyEKyQEWtq6qT8x1cIg==
Date: Thu, 5 Sep 2019 09:11:53 +0000
Message-ID: <20190905091120.16761-1-weh@microsoft.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: SG2PR06CA0119.apcprd06.prod.outlook.com
 (2603:1096:1:1d::21) To DM6PR21MB1401.namprd21.prod.outlook.com
 (2603:10b6:5:22d::24)
x-ms-exchange-messagesentrepresentingtype: 1
x-mailer: git-send-email 2.20.1
x-originating-ip: [167.220.255.49]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: dc7c4b5e-f1cd-4322-7be5-08d731e1176c
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600166)(711020)(4605104)(1401327)(4618075)(2017052603328)(7193020);
 SRVR:DM6PR21MB1321; 
x-ms-traffictypediagnostic: DM6PR21MB1321:|DM6PR21MB1321:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <DM6PR21MB13210DB90EF1141B5AAEF14BBBBB0@DM6PR21MB1321.namprd21.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:3513;
x-forefront-prvs: 015114592F
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10019020)(4636009)(346002)(396003)(376002)(136003)(366004)(39860400002)(199004)(189003)(6486002)(186003)(102836004)(7736002)(8676002)(14454004)(81166006)(81156014)(99286004)(6506007)(386003)(50226002)(3450700001)(43066004)(10290500003)(2501003)(66446008)(64756008)(66556008)(66476007)(66946007)(256004)(14444005)(10090500001)(8936002)(6636002)(478600001)(486006)(476003)(26005)(2616005)(52116002)(305945005)(4326008)(25786009)(6116002)(3846002)(6512007)(107886003)(2906002)(2201001)(316002)(110136005)(54906003)(86362001)(71200400001)(66066001)(71190400001)(22452003)(53936002)(6436002)(1076003)(36756003)(1511001)(5660300002)(921003)(1121003);
 DIR:OUT; SFP:1102; SCL:1; SRVR:DM6PR21MB1321;
 H:DM6PR21MB1401.namprd21.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: microsoft.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: nsbu6x50dRnmZEMoKmmhbfXet+LFs3QiCg3JtI9ZJWXl06e4WK4Qg3XyRnPRfPJSroh1n0IuZnUsrNzGer1YEozhoBjKTSAZwXBT01tdeIf0JinOYctm3EsRZpDse2jCxiLsR9iQ9q2sm5nSYTccwFWeJ8CvLASZjoHb3lilNudQDErOLYwqycG5SbsHzUEg/4qKG1B9s7+QPeUz2d1C0WmHCdxlWVCM2wZttepT+zctKpb8fDvgIDKYo6/xG+9zrluEK6OE9t6BFtXOG/5tuxNDxi+Ne+BwDrsWz74O+0+4wEPmtHz+KLE+PAtVGjilbtF05RhA2oo9atswVDJJLeJ+pDdfSYKuGvABv09TcEXVePLW7eA4eafARJmFmNZ0V9fasF4s1f4Eshpd4WoeF3dLaeFqRU641pG374tebQE=
MIME-Version: 1.0
X-OriginatorOrg: microsoft.com
X-MS-Exchange-CrossTenant-Network-Message-Id: dc7c4b5e-f1cd-4322-7be5-08d731e1176c
X-MS-Exchange-CrossTenant-originalarrivaltime: 05 Sep 2019 09:11:53.0515 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 72f988bf-86f1-41af-91ab-2d7cd011db47
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: Z0YFQZow2pzVKMZEQXa60m+exehBYGz71DzdOxbVo2jmT6+Co3M4CV4IRqqOeoaZZFmeHrBSQsyIlyqiQwTW3A==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM6PR21MB1321
X-Mailman-Approved-At: Fri, 06 Sep 2019 07:01:00 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=microsoft.com; s=selector1;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=OYMSQEz4Sv3yFw5DMmmsO3ZS25FSsCuxpgxZvYGJ7l8=;
 b=ag2HyVRicoG2RH9WoapKIBUNq1rQFauUVOounD8a/MNC0uSpwMZm4pRdgDjmoj1PGni2cJ/7UmJR5H32rFwYt419g7Xg0yppzRiRxQJm77I3/LdkghlJ6etRBKe0TfjdtTjqLXw+c79zzwwpGljvqPxDRAkbMpruXh3r5N+hjHE=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=weh@microsoft.com; 
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Reply-To: Wei Hu <weh@microsoft.com>
Cc: Wei Hu <weh@microsoft.com>, Iouri Tarassov <iourit@microsoft.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QmVnaW5uaW5nIGZyb20gV2luZG93cyAxMCBSUzUrLCBWTSBzY3JlZW4gcmVzb2x1dGlvbiBpcyBv
YnRhaW5lZCBmcm9tIGhvc3QuClRoZSAidmlkZW89aHlwZXJ2X2ZiIiBib290IHRpbWUgb3B0aW9u
IGlzIG5vdCBuZWVkZWQsIGJ1dCBzdGlsbCBjYW4gYmUKdXNlZCB0byBvdmVyd3JpdGUgd2hhdCB0
aGUgaG9zdCBzcGVjaWZpZXMuIFRoZSBWTSByZXNvbHV0aW9uIG9uIHRoZSBob3N0CmNvdWxkIGJl
IHNldCBieSBleGVjdXRpbmcgdGhlIHBvd2Vyc2hlbGwgInNldC12bXZpZGVvIiBjb21tYW5kLgoK
U2lnbmVkLW9mZi1ieTogSW91cmkgVGFyYXNzb3YgPGlvdXJpdEBtaWNyb3NvZnQuY29tPgpTaWdu
ZWQtb2ZmLWJ5OiBXZWkgSHUgPHdlaEBtaWNyb3NvZnQuY29tPgotLS0KICAgIHYyOgogICAgLSBJ
bXBsZW1lbnRlZCBmYWxsYmFjayB3aGVuIHZlcnNpb24gbmVnb3RpYXRpb24gZmFpbGVkLgogICAg
LSBEZWZpbmVkIGZ1bGwgc2l6ZSBmb3Igc3VwcG9ydGVkX3Jlc29sdXRpb24gYXJyYXkuCgogICAg
djM6CiAgICAtIENvcnJlY3RlZCB0aGUgc3ludGh2aWQgbWFqb3IgYW5kIG1pbm9yIHZlcnNpb24g
Y29tcGFyaXNvbiBwcm9ibGVtLgoKICAgIHY0OgogICAgLSBDaGFuZ2VkIGZ1bmN0aW9uIG5hbWUg
dG8gc3ludGh2aWRfdmVyX2dlKCkuCgogZHJpdmVycy92aWRlby9mYmRldi9oeXBlcnZfZmIuYyB8
IDE1OSArKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tLQogMSBmaWxlIGNoYW5nZWQsIDE0
NyBpbnNlcnRpb25zKCspLCAxMiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL3Zp
ZGVvL2ZiZGV2L2h5cGVydl9mYi5jIGIvZHJpdmVycy92aWRlby9mYmRldi9oeXBlcnZfZmIuYwpp
bmRleCAwMGY1YmRjYzZjNmYuLmZlMzE5ZmMzOWJlYyAxMDA2NDQKLS0tIGEvZHJpdmVycy92aWRl
by9mYmRldi9oeXBlcnZfZmIuYworKysgYi9kcml2ZXJzL3ZpZGVvL2ZiZGV2L2h5cGVydl9mYi5j
CkBAIC0yMyw2ICsyMywxNCBAQAogICoKICAqIFBvcnRyYWl0IG9yaWVudGF0aW9uIGlzIGFsc28g
c3VwcG9ydGVkOgogICogICAgIEZvciBleGFtcGxlOiB2aWRlbz1oeXBlcnZfZmI6ODY0eDExNTIK
KyAqCisgKiBXaGVuIGEgV2luZG93cyAxMCBSUzUrIGhvc3QgaXMgdXNlZCwgdGhlIHZpcnR1YWwg
bWFjaGluZSBzY3JlZW4KKyAqIHJlc29sdXRpb24gaXMgb2J0YWluZWQgZnJvbSB0aGUgaG9zdC4g
VGhlICJ2aWRlbz1oeXBlcnZfZmIiIG9wdGlvbiBpcworICogbm90IG5lZWRlZCwgYnV0IHN0aWxs
IGNhbiBiZSB1c2VkIHRvIG92ZXJ3cml0ZSB3aGF0IHRoZSBob3N0IHNwZWNpZmllcy4KKyAqIFRo
ZSBWTSByZXNvbHV0aW9uIG9uIHRoZSBob3N0IGNvdWxkIGJlIHNldCBieSBleGVjdXRpbmcgdGhl
IHBvd2Vyc2hlbGwKKyAqICJzZXQtdm12aWRlbyIgY29tbWFuZC4gRm9yIGV4YW1wbGUKKyAqICAg
ICBzZXQtdm12aWRlbyAtdm1uYW1lIG5hbWUgLWhvcml6b250YWxyZXNvbHV0aW9uOjE5MjAgXAor
ICogLXZlcnRpY2FscmVzb2x1dGlvbjoxMjAwIC1yZXNvbHV0aW9udHlwZSBzaW5nbGUKICAqLwog
CiAjZGVmaW5lIHByX2ZtdChmbXQpIEtCVUlMRF9NT0ROQU1FICI6ICIgZm10CkBAIC00NCw2ICs1
MiwxMCBAQAogI2RlZmluZSBTWU5USFZJRF9WRVJTSU9OKG1ham9yLCBtaW5vcikgKChtaW5vcikg
PDwgMTYgfCAobWFqb3IpKQogI2RlZmluZSBTWU5USFZJRF9WRVJTSU9OX1dJTjcgU1lOVEhWSURf
VkVSU0lPTigzLCAwKQogI2RlZmluZSBTWU5USFZJRF9WRVJTSU9OX1dJTjggU1lOVEhWSURfVkVS
U0lPTigzLCAyKQorI2RlZmluZSBTWU5USFZJRF9WRVJTSU9OX1dJTjEwIFNZTlRIVklEX1ZFUlNJ
T04oMywgNSkKKworI2RlZmluZSBTWU5USFZJRF9WRVJfR0VUX01BSk9SKHZlcikgKHZlciAmIDB4
MDAwMGZmZmYpCisjZGVmaW5lIFNZTlRIVklEX1ZFUl9HRVRfTUlOT1IodmVyKSAoKHZlciAmIDB4
ZmZmZjAwMDApID4+IDE2KQogCiAjZGVmaW5lIFNZTlRIVklEX0RFUFRIX1dJTjcgMTYKICNkZWZp
bmUgU1lOVEhWSURfREVQVEhfV0lOOCAzMgpAQCAtODIsMTYgKzk0LDI1IEBAIGVudW0gc3ludGh2
aWRfbXNnX3R5cGUgewogCVNZTlRIVklEX1BPSU5URVJfU0hBUEUJCT0gOCwKIAlTWU5USFZJRF9G
RUFUVVJFX0NIQU5HRQkJPSA5LAogCVNZTlRIVklEX0RJUlQJCQk9IDEwLAorCVNZTlRIVklEX1JF
U09MVVRJT05fUkVRVUVTVAk9IDEzLAorCVNZTlRIVklEX1JFU09MVVRJT05fUkVTUE9OU0UJPSAx
NCwKIAotCVNZTlRIVklEX01BWAkJCT0gMTEKKwlTWU5USFZJRF9NQVgJCQk9IDE1CiB9OwogCisj
ZGVmaW5lCQlTWU5USFZJRF9FRElEX0JMT0NLX1NJWkUJMTI4CisjZGVmaW5lCQlTWU5USFZJRF9N
QVhfUkVTT0xVVElPTl9DT1VOVAk2NAorCitzdHJ1Y3QgaHZkX3NjcmVlbl9pbmZvIHsKKwl1MTYg
d2lkdGg7CisJdTE2IGhlaWdodDsKK30gX19wYWNrZWQ7CisKIHN0cnVjdCBzeW50aHZpZF9tc2df
aGRyIHsKIAl1MzIgdHlwZTsKIAl1MzIgc2l6ZTsgIC8qIHNpemUgb2YgdGhpcyBoZWFkZXIgKyBw
YXlsb2FkIGFmdGVyIHRoaXMgZmllbGQqLwogfSBfX3BhY2tlZDsKIAotCiBzdHJ1Y3Qgc3ludGh2
aWRfdmVyc2lvbl9yZXEgewogCXUzMiB2ZXJzaW9uOwogfSBfX3BhY2tlZDsKQEAgLTEwMiw2ICsx
MjMsMTkgQEAgc3RydWN0IHN5bnRodmlkX3ZlcnNpb25fcmVzcCB7CiAJdTggbWF4X3ZpZGVvX291
dHB1dHM7CiB9IF9fcGFja2VkOwogCitzdHJ1Y3Qgc3ludGh2aWRfc3VwcG9ydGVkX3Jlc29sdXRp
b25fcmVxIHsKKwl1OCBtYXhpbXVtX3Jlc29sdXRpb25fY291bnQ7Cit9IF9fcGFja2VkOworCitz
dHJ1Y3Qgc3ludGh2aWRfc3VwcG9ydGVkX3Jlc29sdXRpb25fcmVzcCB7CisJdTggZWRpZF9ibG9j
a1tTWU5USFZJRF9FRElEX0JMT0NLX1NJWkVdOworCXU4IHJlc29sdXRpb25fY291bnQ7CisJdTgg
ZGVmYXVsdF9yZXNvbHV0aW9uX2luZGV4OworCXU4IGlzX3N0YW5kYXJkOworCXN0cnVjdCBodmRf
c2NyZWVuX2luZm8KKwkJc3VwcG9ydGVkX3Jlc29sdXRpb25bU1lOVEhWSURfTUFYX1JFU09MVVRJ
T05fQ09VTlRdOworfSBfX3BhY2tlZDsKKwogc3RydWN0IHN5bnRodmlkX3ZyYW1fbG9jYXRpb24g
ewogCXU2NCB1c2VyX2N0eDsKIAl1OCBpc192cmFtX2dwYV9zcGVjaWZpZWQ7CkBAIC0xODcsNiAr
MjIxLDggQEAgc3RydWN0IHN5bnRodmlkX21zZyB7CiAJCXN0cnVjdCBzeW50aHZpZF9wb2ludGVy
X3NoYXBlIHB0cl9zaGFwZTsKIAkJc3RydWN0IHN5bnRodmlkX2ZlYXR1cmVfY2hhbmdlIGZlYXR1
cmVfY2hnOwogCQlzdHJ1Y3Qgc3ludGh2aWRfZGlydCBkaXJ0OworCQlzdHJ1Y3Qgc3ludGh2aWRf
c3VwcG9ydGVkX3Jlc29sdXRpb25fcmVxIHJlc29sdXRpb25fcmVxOworCQlzdHJ1Y3Qgc3ludGh2
aWRfc3VwcG9ydGVkX3Jlc29sdXRpb25fcmVzcCByZXNvbHV0aW9uX3Jlc3A7CiAJfTsKIH0gX19w
YWNrZWQ7CiAKQEAgLTIyNCw2ICsyNjAsOCBAQCBzdHJ1Y3QgaHZmYl9wYXIgewogCiBzdGF0aWMg
dWludCBzY3JlZW5fd2lkdGggPSBIVkZCX1dJRFRIOwogc3RhdGljIHVpbnQgc2NyZWVuX2hlaWdo
dCA9IEhWRkJfSEVJR0hUOworc3RhdGljIHVpbnQgc2NyZWVuX3dpZHRoX21heCA9IEhWRkJfV0lE
VEg7CitzdGF0aWMgdWludCBzY3JlZW5faGVpZ2h0X21heCA9IEhWRkJfSEVJR0hUOwogc3RhdGlj
IHVpbnQgc2NyZWVuX2RlcHRoOwogc3RhdGljIHVpbnQgc2NyZWVuX2ZiX3NpemU7CiAKQEAgLTM1
NCw2ICszOTIsNyBAQCBzdGF0aWMgdm9pZCBzeW50aHZpZF9yZWN2X3N1YihzdHJ1Y3QgaHZfZGV2
aWNlICpoZGV2KQogCiAJLyogQ29tcGxldGUgdGhlIHdhaXQgZXZlbnQgKi8KIAlpZiAobXNnLT52
aWRfaGRyLnR5cGUgPT0gU1lOVEhWSURfVkVSU0lPTl9SRVNQT05TRSB8fAorCSAgICBtc2ctPnZp
ZF9oZHIudHlwZSA9PSBTWU5USFZJRF9SRVNPTFVUSU9OX1JFU1BPTlNFIHx8CiAJICAgIG1zZy0+
dmlkX2hkci50eXBlID09IFNZTlRIVklEX1ZSQU1fTE9DQVRJT05fQUNLKSB7CiAJCW1lbWNweShw
YXItPmluaXRfYnVmLCBtc2csIE1BWF9WTUJVU19QS1RfU0laRSk7CiAJCWNvbXBsZXRlKCZwYXIt
PndhaXQpOwpAQCAtNDAwLDYgKzQzOSwxNyBAQCBzdGF0aWMgdm9pZCBzeW50aHZpZF9yZWNlaXZl
KHZvaWQgKmN0eCkKIAl9IHdoaWxlIChieXRlc19yZWN2ZCA+IDAgJiYgcmV0ID09IDApOwogfQog
CisvKiBDaGVjayBpZiB0aGUgdmVyMSB2ZXJzaW9uIGlzIGVxdWFsIG9yIGdyZWF0ZXIgdGhhbiB2
ZXIyICovCitzdGF0aWMgaW5saW5lIGJvb2wgc3ludGh2aWRfdmVyX2dlKHUzMiB2ZXIxLCB1MzIg
dmVyMikKK3sKKwlpZiAoU1lOVEhWSURfVkVSX0dFVF9NQUpPUih2ZXIxKSA+IFNZTlRIVklEX1ZF
Ul9HRVRfTUFKT1IodmVyMikgfHwKKwkgICAgKFNZTlRIVklEX1ZFUl9HRVRfTUFKT1IodmVyMSkg
PT0gU1lOVEhWSURfVkVSX0dFVF9NQUpPUih2ZXIyKSAmJgorCSAgICAgU1lOVEhWSURfVkVSX0dF
VF9NSU5PUih2ZXIxKSA+PSBTWU5USFZJRF9WRVJfR0VUX01JTk9SKHZlcjIpKSkKKwkJcmV0dXJu
IHRydWU7CisKKwlyZXR1cm4gZmFsc2U7Cit9CisKIC8qIENoZWNrIHN5bnRoZXRpYyB2aWRlbyBw
cm90b2NvbCB2ZXJzaW9uIHdpdGggdGhlIGhvc3QgKi8KIHN0YXRpYyBpbnQgc3ludGh2aWRfbmVn
b3RpYXRlX3ZlcihzdHJ1Y3QgaHZfZGV2aWNlICpoZGV2LCB1MzIgdmVyKQogewpAQCAtNDI4LDYg
KzQ3OCw2NCBAQCBzdGF0aWMgaW50IHN5bnRodmlkX25lZ290aWF0ZV92ZXIoc3RydWN0IGh2X2Rl
dmljZSAqaGRldiwgdTMyIHZlcikKIAl9CiAKIAlwYXItPnN5bnRodmlkX3ZlcnNpb24gPSB2ZXI7
CisJcHJfaW5mbygiU3ludGh2aWQgVmVyc2lvbiBtYWpvciAlZCwgbWlub3IgJWRcbiIsCisJCVNZ
TlRIVklEX1ZFUl9HRVRfTUFKT1IodmVyKSwgU1lOVEhWSURfVkVSX0dFVF9NSU5PUih2ZXIpKTsK
Kworb3V0OgorCXJldHVybiByZXQ7Cit9CisKKy8qIEdldCBjdXJyZW50IHJlc29sdXRpb24gZnJv
bSB0aGUgaG9zdCAqLworc3RhdGljIGludCBzeW50aHZpZF9nZXRfc3VwcG9ydGVkX3Jlc29sdXRp
b24oc3RydWN0IGh2X2RldmljZSAqaGRldikKK3sKKwlzdHJ1Y3QgZmJfaW5mbyAqaW5mbyA9IGh2
X2dldF9kcnZkYXRhKGhkZXYpOworCXN0cnVjdCBodmZiX3BhciAqcGFyID0gaW5mby0+cGFyOwor
CXN0cnVjdCBzeW50aHZpZF9tc2cgKm1zZyA9IChzdHJ1Y3Qgc3ludGh2aWRfbXNnICopcGFyLT5p
bml0X2J1ZjsKKwlpbnQgcmV0ID0gMDsKKwl1bnNpZ25lZCBsb25nIHQ7CisJdTggaW5kZXg7CisJ
aW50IGk7CisKKwltZW1zZXQobXNnLCAwLCBzaXplb2Yoc3RydWN0IHN5bnRodmlkX21zZykpOwor
CW1zZy0+dmlkX2hkci50eXBlID0gU1lOVEhWSURfUkVTT0xVVElPTl9SRVFVRVNUOworCW1zZy0+
dmlkX2hkci5zaXplID0gc2l6ZW9mKHN0cnVjdCBzeW50aHZpZF9tc2dfaGRyKSArCisJCXNpemVv
ZihzdHJ1Y3Qgc3ludGh2aWRfc3VwcG9ydGVkX3Jlc29sdXRpb25fcmVxKTsKKworCW1zZy0+cmVz
b2x1dGlvbl9yZXEubWF4aW11bV9yZXNvbHV0aW9uX2NvdW50ID0KKwkJU1lOVEhWSURfTUFYX1JF
U09MVVRJT05fQ09VTlQ7CisJc3ludGh2aWRfc2VuZChoZGV2LCBtc2cpOworCisJdCA9IHdhaXRf
Zm9yX2NvbXBsZXRpb25fdGltZW91dCgmcGFyLT53YWl0LCBWU1BfVElNRU9VVCk7CisJaWYgKCF0
KSB7CisJCXByX2VycigiVGltZSBvdXQgb24gd2FpdGluZyByZXNvbHV0aW9uIHJlc3BvbnNlXG4i
KTsKKwkJCXJldCA9IC1FVElNRURPVVQ7CisJCQlnb3RvIG91dDsKKwl9CisKKwlpZiAobXNnLT5y
ZXNvbHV0aW9uX3Jlc3AucmVzb2x1dGlvbl9jb3VudCA9PSAwKSB7CisJCXByX2VycigiTm8gc3Vw
cG9ydGVkIHJlc29sdXRpb25zXG4iKTsKKwkJcmV0ID0gLUVOT0RFVjsKKwkJZ290byBvdXQ7CisJ
fQorCisJaW5kZXggPSBtc2ctPnJlc29sdXRpb25fcmVzcC5kZWZhdWx0X3Jlc29sdXRpb25faW5k
ZXg7CisJaWYgKGluZGV4ID49IG1zZy0+cmVzb2x1dGlvbl9yZXNwLnJlc29sdXRpb25fY291bnQp
IHsKKwkJcHJfZXJyKCJJbnZhbGlkIHJlc29sdXRpb24gaW5kZXg6ICVkXG4iLCBpbmRleCk7CisJ
CXJldCA9IC1FTk9ERVY7CisJCWdvdG8gb3V0OworCX0KKworCWZvciAoaSA9IDA7IGkgPCBtc2ct
PnJlc29sdXRpb25fcmVzcC5yZXNvbHV0aW9uX2NvdW50OyBpKyspIHsKKwkJc2NyZWVuX3dpZHRo
X21heCA9IG1heF90KHVuc2lnbmVkIGludCwgc2NyZWVuX3dpZHRoX21heCwKKwkJICAgIG1zZy0+
cmVzb2x1dGlvbl9yZXNwLnN1cHBvcnRlZF9yZXNvbHV0aW9uW2ldLndpZHRoKTsKKwkJc2NyZWVu
X2hlaWdodF9tYXggPSBtYXhfdCh1bnNpZ25lZCBpbnQsIHNjcmVlbl9oZWlnaHRfbWF4LAorCQkg
ICAgbXNnLT5yZXNvbHV0aW9uX3Jlc3Auc3VwcG9ydGVkX3Jlc29sdXRpb25baV0uaGVpZ2h0KTsK
Kwl9CisKKwlzY3JlZW5fd2lkdGggPQorCQltc2ctPnJlc29sdXRpb25fcmVzcC5zdXBwb3J0ZWRf
cmVzb2x1dGlvbltpbmRleF0ud2lkdGg7CisJc2NyZWVuX2hlaWdodCA9CisJCW1zZy0+cmVzb2x1
dGlvbl9yZXNwLnN1cHBvcnRlZF9yZXNvbHV0aW9uW2luZGV4XS5oZWlnaHQ7CiAKIG91dDoKIAly
ZXR1cm4gcmV0OwpAQCAtNDQ4LDExICs1NTYsMjcgQEAgc3RhdGljIGludCBzeW50aHZpZF9jb25u
ZWN0X3ZzcChzdHJ1Y3QgaHZfZGV2aWNlICpoZGV2KQogCX0KIAogCS8qIE5lZ290aWF0ZSB0aGUg
cHJvdG9jb2wgdmVyc2lvbiB3aXRoIGhvc3QgKi8KLQlpZiAodm1idXNfcHJvdG9fdmVyc2lvbiA9
PSBWRVJTSU9OX1dTMjAwOCB8fAotCSAgICB2bWJ1c19wcm90b192ZXJzaW9uID09IFZFUlNJT05f
V0lONykKLQkJcmV0ID0gc3ludGh2aWRfbmVnb3RpYXRlX3ZlcihoZGV2LCBTWU5USFZJRF9WRVJT
SU9OX1dJTjcpOwotCWVsc2UKKwlzd2l0Y2ggKHZtYnVzX3Byb3RvX3ZlcnNpb24pIHsKKwljYXNl
IFZFUlNJT05fV0lOMTA6CisJY2FzZSBWRVJTSU9OX1dJTjEwX1Y1OgorCQlyZXQgPSBzeW50aHZp
ZF9uZWdvdGlhdGVfdmVyKGhkZXYsIFNZTlRIVklEX1ZFUlNJT05fV0lOMTApOworCQlpZiAoIXJl
dCkKKwkJCWJyZWFrOworCQkvKiBGYWxsdGhyb3VnaCAqLworCWNhc2UgVkVSU0lPTl9XSU44Ogor
CWNhc2UgVkVSU0lPTl9XSU44XzE6CiAJCXJldCA9IHN5bnRodmlkX25lZ290aWF0ZV92ZXIoaGRl
diwgU1lOVEhWSURfVkVSU0lPTl9XSU44KTsKKwkJaWYgKCFyZXQpCisJCQlicmVhazsKKwkJLyog
RmFsbHRocm91Z2ggKi8KKwljYXNlIFZFUlNJT05fV1MyMDA4OgorCWNhc2UgVkVSU0lPTl9XSU43
OgorCQlyZXQgPSBzeW50aHZpZF9uZWdvdGlhdGVfdmVyKGhkZXYsIFNZTlRIVklEX1ZFUlNJT05f
V0lONyk7CisJCWJyZWFrOworCWRlZmF1bHQ6CisJCXJldCA9IHN5bnRodmlkX25lZ290aWF0ZV92
ZXIoaGRldiwgU1lOVEhWSURfVkVSU0lPTl9XSU4xMCk7CisJCWJyZWFrOworCX0KIAogCWlmIChy
ZXQpIHsKIAkJcHJfZXJyKCJTeW50aGV0aWMgdmlkZW8gZGV2aWNlIHZlcnNpb24gbm90IGFjY2Vw
dGVkXG4iKTsKQEAgLTQ2NCw2ICs1ODgsMTIgQEAgc3RhdGljIGludCBzeW50aHZpZF9jb25uZWN0
X3ZzcChzdHJ1Y3QgaHZfZGV2aWNlICpoZGV2KQogCWVsc2UKIAkJc2NyZWVuX2RlcHRoID0gU1lO
VEhWSURfREVQVEhfV0lOODsKIAorCWlmIChzeW50aHZpZF92ZXJfZ2UocGFyLT5zeW50aHZpZF92
ZXJzaW9uLCBTWU5USFZJRF9WRVJTSU9OX1dJTjEwKSkgeworCQlyZXQgPSBzeW50aHZpZF9nZXRf
c3VwcG9ydGVkX3Jlc29sdXRpb24oaGRldik7CisJCWlmIChyZXQpCisJCQlwcl9pbmZvKCJGYWls
ZWQgdG8gZ2V0IHN1cHBvcnRlZCByZXNvbHV0aW9uIGZyb20gaG9zdCwgdXNlIGRlZmF1bHRcbiIp
OworCX0KKwogCXNjcmVlbl9mYl9zaXplID0gaGRldi0+Y2hhbm5lbC0+b2ZmZXJtc2cub2ZmZXIu
CiAJCQkJbW1pb19tZWdhYnl0ZXMgKiAxMDI0ICogMTAyNDsKIApAQCAtNjUzLDYgKzc4Myw4IEBA
IHN0YXRpYyB2b2lkIGh2ZmJfZ2V0X29wdGlvbihzdHJ1Y3QgZmJfaW5mbyAqaW5mbykKIAl9CiAK
IAlpZiAoeCA8IEhWRkJfV0lEVEhfTUlOIHx8IHkgPCBIVkZCX0hFSUdIVF9NSU4gfHwKKwkgICAg
KHN5bnRodmlkX3Zlcl9nZShwYXItPnN5bnRodmlkX3ZlcnNpb24sIFNZTlRIVklEX1ZFUlNJT05f
V0lOMTApICYmCisJICAgICh4ID4gc2NyZWVuX3dpZHRoX21heCB8fCB5ID4gc2NyZWVuX2hlaWdo
dF9tYXgpKSB8fAogCSAgICAocGFyLT5zeW50aHZpZF92ZXJzaW9uID09IFNZTlRIVklEX1ZFUlNJ
T05fV0lOOCAmJgogCSAgICAgeCAqIHkgKiBzY3JlZW5fZGVwdGggLyA4ID4gU1lOVEhWSURfRkJf
U0laRV9XSU44KSB8fAogCSAgICAocGFyLT5zeW50aHZpZF92ZXJzaW9uID09IFNZTlRIVklEX1ZF
UlNJT05fV0lONyAmJgpAQCAtNjg5LDggKzgyMSwxMiBAQCBzdGF0aWMgaW50IGh2ZmJfZ2V0bWVt
KHN0cnVjdCBodl9kZXZpY2UgKmhkZXYsIHN0cnVjdCBmYl9pbmZvICppbmZvKQogCQl9CiAKIAkJ
aWYgKCEocGNpX3Jlc291cmNlX2ZsYWdzKHBkZXYsIDApICYgSU9SRVNPVVJDRV9NRU0pIHx8Ci0J
CSAgICBwY2lfcmVzb3VyY2VfbGVuKHBkZXYsIDApIDwgc2NyZWVuX2ZiX3NpemUpCisJCSAgICBw
Y2lfcmVzb3VyY2VfbGVuKHBkZXYsIDApIDwgc2NyZWVuX2ZiX3NpemUpIHsKKwkJCXByX2Vycigi
UmVzb3VyY2Ugbm90IGF2YWlsYWJsZSBvciAoMHglbHggPCAweCVseClcbiIsCisJCQkgICAgICAg
KHVuc2lnbmVkIGxvbmcpIHBjaV9yZXNvdXJjZV9sZW4ocGRldiwgMCksCisJCQkgICAgICAgKHVu
c2lnbmVkIGxvbmcpIHNjcmVlbl9mYl9zaXplKTsKIAkJCWdvdG8gZXJyMTsKKwkJfQogCiAJCXBv
dF9lbmQgPSBwY2lfcmVzb3VyY2VfZW5kKHBkZXYsIDApOwogCQlwb3Rfc3RhcnQgPSBwb3RfZW5k
IC0gc2NyZWVuX2ZiX3NpemUgKyAxOwpAQCAtNzgxLDE3ICs5MTcsMTYgQEAgc3RhdGljIGludCBo
dmZiX3Byb2JlKHN0cnVjdCBodl9kZXZpY2UgKmhkZXYsCiAJCWdvdG8gZXJyb3IxOwogCX0KIAor
CWh2ZmJfZ2V0X29wdGlvbihpbmZvKTsKKwlwcl9pbmZvKCJTY3JlZW4gcmVzb2x1dGlvbjogJWR4
JWQsIENvbG9yIGRlcHRoOiAlZFxuIiwKKwkJc2NyZWVuX3dpZHRoLCBzY3JlZW5faGVpZ2h0LCBz
Y3JlZW5fZGVwdGgpOworCiAJcmV0ID0gaHZmYl9nZXRtZW0oaGRldiwgaW5mbyk7CiAJaWYgKHJl
dCkgewogCQlwcl9lcnIoIk5vIG1lbW9yeSBmb3IgZnJhbWVidWZmZXJcbiIpOwogCQlnb3RvIGVy
cm9yMjsKIAl9CiAKLQlodmZiX2dldF9vcHRpb24oaW5mbyk7Ci0JcHJfaW5mbygiU2NyZWVuIHJl
c29sdXRpb246ICVkeCVkLCBDb2xvciBkZXB0aDogJWRcbiIsCi0JCXNjcmVlbl93aWR0aCwgc2Ny
ZWVuX2hlaWdodCwgc2NyZWVuX2RlcHRoKTsKLQotCiAJLyogU2V0IHVwIGZiX2luZm8gKi8KIAlp
bmZvLT5mbGFncyA9IEZCSU5GT19ERUZBVUxUOwogCi0tIAoyLjIwLjEKCl9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QK
ZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9w
Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
