Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id E8D70FF908
	for <lists+dri-devel@lfdr.de>; Sun, 17 Nov 2019 12:45:15 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8FE4D6E2E6;
	Sun, 17 Nov 2019 11:44:36 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from bhuna.collabora.co.uk (bhuna.collabora.co.uk [46.235.227.227])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 24C876E1F9
 for <dri-devel@lists.freedesktop.org>; Sun, 17 Nov 2019 02:41:50 +0000 (UTC)
Received: from [127.0.0.1] (localhost [127.0.0.1]) (Authenticated sender: sre)
 with ESMTPSA id E889D28F768
Received: by earth.universe (Postfix, from userid 1000)
 id B96B63C0C82; Sun, 17 Nov 2019 03:41:39 +0100 (CET)
From: Sebastian Reichel <sebastian.reichel@collabora.com>
To: Sebastian Reichel <sre@kernel.org>,
 Laurent Pinchart <laurent.pinchart@ideasonboard.com>,
 Tomi Valkeinen <tomi.valkeinen@ti.com>
Subject: [RFCv1 10/42] drm/omap: dsi: switch dsi_vc_send_long/short to
 mipi_dsi_msg
Date: Sun, 17 Nov 2019 03:39:56 +0100
Message-Id: <20191117024028.2233-11-sebastian.reichel@collabora.com>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191117024028.2233-1-sebastian.reichel@collabora.com>
References: <20191117024028.2233-1-sebastian.reichel@collabora.com>
MIME-Version: 1.0
X-Mailman-Approved-At: Sun, 17 Nov 2019 11:44:18 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: kernel@collabora.com, Tony Lindgren <tony@atomide.com>,
 "H. Nikolaus Schaller" <hns@goldelico.com>, Merlijn Wajer <merlijn@wizzup.org>,
 Sebastian Reichel <sebastian.reichel@collabora.com>,
 dri-devel@lists.freedesktop.org, linux-omap@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

U2ltcGxpZnkgdGhlIERTSSBlbmNvZGVyIGJ5IHVzaW5nIG1pcGlfZHNpX21zZyBmb3IKZHNpX3Zj
X3NlbmRfbG9uZyBhbmQgZHNpX3ZjX3NlbmRfc2hvcnQuIEZ1cnRoZXIgaW1wcm92ZW1lbnRzCnJl
cXVpcmUgY2xlYW5pbmcgdXAgdGhlIGNoYW5uZWwgYWxsb2NhdGlvbiBjb2RlIGZpcnN0LgoKU2ln
bmVkLW9mZi1ieTogU2ViYXN0aWFuIFJlaWNoZWwgPHNlYmFzdGlhbi5yZWljaGVsQGNvbGxhYm9y
YS5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vZHNzL2RzaS5jIHwgOTIgKysrKysr
KysrKysrKysrLS0tLS0tLS0tLS0tLS0tLQogMSBmaWxlIGNoYW5nZWQsIDQ1IGluc2VydGlvbnMo
KyksIDQ3IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJt
L2Rzcy9kc2kuYyBiL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL2Rzcy9kc2kuYwppbmRleCBjMjJk
NDM4YWUyYjUuLmQzOWI4NDQwOTY1NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL29tYXBk
cm0vZHNzL2RzaS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL2Rzcy9kc2kuYwpAQCAt
MjU5OSwzMCArMjU5OSwzNiBAQCBzdGF0aWMgaW5saW5lIHZvaWQgZHNpX3ZjX3dyaXRlX2xvbmdf
cGF5bG9hZChzdHJ1Y3QgZHNpX2RhdGEgKmRzaSwgaW50IGNoYW5uZWwsCiAJZHNpX3dyaXRlX3Jl
Zyhkc2ksIERTSV9WQ19MT05HX1BBQ0tFVF9QQVlMT0FEKGNoYW5uZWwpLCB2YWwpOwogfQogCi1z
dGF0aWMgaW50IGRzaV92Y19zZW5kX2xvbmcoc3RydWN0IGRzaV9kYXRhICpkc2ksIGludCBjaGFu
bmVsLCB1OCBkYXRhX3R5cGUsCi0JCQkgICAgY29uc3QgdTggKmRhdGEsIHUxNiBsZW4sIHU4IGVj
YykKK3N0YXRpYyBpbnQgZHNpX3ZjX3NlbmRfbG9uZyhzdHJ1Y3QgZHNpX2RhdGEgKmRzaSwKKwkJ
CSAgICBjb25zdCBzdHJ1Y3QgbWlwaV9kc2lfbXNnICptc2cpCiB7CisJc3RydWN0IG1pcGlfZHNp
X3BhY2tldCBwa2c7CiAJLyp1MzIgdmFsOyAqLwogCWludCBpOwogCWNvbnN0IHU4ICpwOwogCWlu
dCByID0gMDsKIAl1OCBiMSwgYjIsIGIzLCBiNDsKIAorCXIgPSBtaXBpX2RzaV9jcmVhdGVfcGFj
a2V0KCZwa2csIG1zZyk7CisJaWYgKHIgPCAwKQorCQlyZXR1cm4gcjsKKwogCWlmIChkc2ktPmRl
YnVnX3dyaXRlKQotCQlEU1NEQkcoImRzaV92Y19zZW5kX2xvbmcsICVkIGJ5dGVzXG4iLCBsZW4p
OworCQlEU1NEQkcoImRzaV92Y19zZW5kX2xvbmcsICVkIGJ5dGVzXG4iLCBtc2ctPnR4X2xlbik7
CiAKIAkvKiBsZW4gKyBoZWFkZXIgKi8KLQlpZiAoZHNpLT52Y1tjaGFubmVsXS50eF9maWZvX3Np
emUgKiAzMiAqIDQgPCBsZW4gKyA0KSB7CisJaWYgKGRzaS0+dmNbbXNnLT5jaGFubmVsXS50eF9m
aWZvX3NpemUgKiAzMiAqIDQgPCBtc2ctPnR4X2xlbiArIDQpIHsKIAkJRFNTRVJSKCJ1bmFibGUg
dG8gc2VuZCBsb25nIHBhY2tldDogcGFja2V0IHRvbyBsb25nLlxuIik7CiAJCXJldHVybiAtRUlO
VkFMOwogCX0KIAotCWRzaV92Y19jb25maWdfc291cmNlKGRzaSwgY2hhbm5lbCwgRFNJX1ZDX1NP
VVJDRV9MNCk7CisJZHNpX3ZjX2NvbmZpZ19zb3VyY2UoZHNpLCBtc2ctPmNoYW5uZWwsIERTSV9W
Q19TT1VSQ0VfTDQpOwogCi0JZHNpX3ZjX3dyaXRlX2xvbmdfaGVhZGVyKGRzaSwgY2hhbm5lbCwg
ZGF0YV90eXBlLCBsZW4sIGVjYyk7CisJZHNpX3ZjX3dyaXRlX2xvbmdfaGVhZGVyKGRzaSwgbXNn
LT5jaGFubmVsLCBtc2ctPnR5cGUsIG1zZy0+dHhfbGVuLAorCQkJCSBwa2cuaGVhZGVyWzNdKTsK
IAotCXAgPSBkYXRhOwotCWZvciAoaSA9IDA7IGkgPCBsZW4gPj4gMjsgaSsrKSB7CisJcCA9IG1z
Zy0+dHhfYnVmOworCWZvciAoaSA9IDA7IGkgPCBtc2ctPnR4X2xlbiA+PiAyOyBpKyspIHsKIAkJ
aWYgKGRzaS0+ZGVidWdfd3JpdGUpCiAJCQlEU1NEQkcoIlx0c2VuZGluZyBmdWxsIHBhY2tldCAl
ZFxuIiwgaSk7CiAKQEAgLTI2MzEsMTAgKzI2MzcsMTAgQEAgc3RhdGljIGludCBkc2lfdmNfc2Vu
ZF9sb25nKHN0cnVjdCBkc2lfZGF0YSAqZHNpLCBpbnQgY2hhbm5lbCwgdTggZGF0YV90eXBlLAog
CQliMyA9ICpwKys7CiAJCWI0ID0gKnArKzsKIAotCQlkc2lfdmNfd3JpdGVfbG9uZ19wYXlsb2Fk
KGRzaSwgY2hhbm5lbCwgYjEsIGIyLCBiMywgYjQpOworCQlkc2lfdmNfd3JpdGVfbG9uZ19wYXls
b2FkKGRzaSwgbXNnLT5jaGFubmVsLCBiMSwgYjIsIGIzLCBiNCk7CiAJfQogCi0JaSA9IGxlbiAl
IDQ7CisJaSA9IG1zZy0+dHhfbGVuICUgNDsKIAlpZiAoaSkgewogCQliMSA9IDA7IGIyID0gMDsg
YjMgPSAwOwogCkBAIC0yNjU2LDY0ICsyNjYyLDY0IEBAIHN0YXRpYyBpbnQgZHNpX3ZjX3NlbmRf
bG9uZyhzdHJ1Y3QgZHNpX2RhdGEgKmRzaSwgaW50IGNoYW5uZWwsIHU4IGRhdGFfdHlwZSwKIAkJ
CWJyZWFrOwogCQl9CiAKLQkJZHNpX3ZjX3dyaXRlX2xvbmdfcGF5bG9hZChkc2ksIGNoYW5uZWws
IGIxLCBiMiwgYjMsIDApOworCQlkc2lfdmNfd3JpdGVfbG9uZ19wYXlsb2FkKGRzaSwgbXNnLT5j
aGFubmVsLCBiMSwgYjIsIGIzLCAwKTsKIAl9CiAKIAlyZXR1cm4gcjsKIH0KIAotc3RhdGljIGlu
dCBkc2lfdmNfc2VuZF9zaG9ydChzdHJ1Y3QgZHNpX2RhdGEgKmRzaSwgaW50IGNoYW5uZWwsIHU4
IGRhdGFfdHlwZSwKLQkJCSAgICAgdTE2IGRhdGEsIHU4IGVjYykKK3N0YXRpYyBpbnQgZHNpX3Zj
X3NlbmRfc2hvcnQoc3RydWN0IGRzaV9kYXRhICpkc2ksCisJCQkgICAgIGNvbnN0IHN0cnVjdCBt
aXBpX2RzaV9tc2cgKm1zZykKIHsKKwlzdHJ1Y3QgbWlwaV9kc2lfcGFja2V0IHBrZzsKIAl1MzIg
cjsKLQl1OCBkYXRhX2lkOworCisJciA9IG1pcGlfZHNpX2NyZWF0ZV9wYWNrZXQoJnBrZywgbXNn
KTsKKwlpZiAociA8IDApCisJCXJldHVybiByOwogCiAJV0FSTl9PTighZHNpX2J1c19pc19sb2Nr
ZWQoZHNpKSk7CiAKIAlpZiAoZHNpLT5kZWJ1Z193cml0ZSkKIAkJRFNTREJHKCJkc2lfdmNfc2Vu
ZF9zaG9ydChjaCVkLCBkdCAlI3gsIGIxICUjeCwgYjIgJSN4KVxuIiwKLQkJCQljaGFubmVsLAot
CQkJCWRhdGFfdHlwZSwgZGF0YSAmIDB4ZmYsIChkYXRhID4+IDgpICYgMHhmZik7CisJCQkJbXNn
LT5jaGFubmVsLAorCQkJCW1zZy0+dHlwZSwgcGtnLmhlYWRlclsxXSwgcGtnLmhlYWRlclsyXSk7
CiAKLQlkc2lfdmNfY29uZmlnX3NvdXJjZShkc2ksIGNoYW5uZWwsIERTSV9WQ19TT1VSQ0VfTDQp
OworCWRzaV92Y19jb25maWdfc291cmNlKGRzaSwgbXNnLT5jaGFubmVsLCBEU0lfVkNfU09VUkNF
X0w0KTsKIAotCWlmIChGTERfR0VUKGRzaV9yZWFkX3JlZyhkc2ksIERTSV9WQ19DVFJMKGNoYW5u
ZWwpKSwgMTYsIDE2KSkgeworCWlmIChGTERfR0VUKGRzaV9yZWFkX3JlZyhkc2ksIERTSV9WQ19D
VFJMKG1zZy0+Y2hhbm5lbCkpLCAxNiwgMTYpKSB7CiAJCURTU0VSUigiRVJST1IgRklGTyBGVUxM
LCBhYm9ydGluZyB0cmFuc2ZlclxuIik7CiAJCXJldHVybiAtRUlOVkFMOwogCX0KIAotCWRhdGFf
aWQgPSBkYXRhX3R5cGUgfCBjaGFubmVsIDw8IDY7Ci0KLQlyID0gKGRhdGFfaWQgPDwgMCkgfCAo
ZGF0YSA8PCA4KSB8IChlY2MgPDwgMjQpOworCXIgPSBwa2cuaGVhZGVyWzNdIDw8IDI0IHwgcGtn
LmhlYWRlclsyXSA8PCAxNiB8IHBrZy5oZWFkZXJbMV0gPDwgOCB8CisJICAgIHBrZy5oZWFkZXJb
MF07CiAKLQlkc2lfd3JpdGVfcmVnKGRzaSwgRFNJX1ZDX1NIT1JUX1BBQ0tFVF9IRUFERVIoY2hh
bm5lbCksIHIpOworCWRzaV93cml0ZV9yZWcoZHNpLCBEU0lfVkNfU0hPUlRfUEFDS0VUX0hFQURF
Uihtc2ctPmNoYW5uZWwpLCByKTsKIAogCXJldHVybiAwOwogfQogCiBzdGF0aWMgaW50IGRzaV92
Y19zZW5kX251bGwoc3RydWN0IGRzaV9kYXRhICpkc2ksIGludCBjaGFubmVsKQogewotCXJldHVy
biBkc2lfdmNfc2VuZF9sb25nKGRzaSwgY2hhbm5lbCwgTUlQSV9EU0lfTlVMTF9QQUNLRVQsIE5V
TEwsIDAsIDApOworCWNvbnN0IHN0cnVjdCBtaXBpX2RzaV9tc2cgbXNnID0geworCQkuY2hhbm5l
bCA9IGNoYW5uZWwsCisJCS50eXBlID0gTUlQSV9EU0lfTlVMTF9QQUNLRVQsCisJfTsKKworCXJl
dHVybiBkc2lfdmNfc2VuZF9sb25nKGRzaSwgJm1zZyk7CiB9CiAKIHN0YXRpYyBpbnQgZHNpX3Zj
X3dyaXRlX2NvbW1vbihzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpkc3NkZXYsCiAJCQkgICAgICAg
Y29uc3Qgc3RydWN0IG1pcGlfZHNpX21zZyAqbXNnKQogewogCXN0cnVjdCBkc2lfZGF0YSAqZHNp
ID0gdG9fZHNpX2RhdGEoZHNzZGV2KTsKLQlzdHJ1Y3QgbWlwaV9kc2lfcGFja2V0IHBhY2tldDsK
IAlpbnQgcjsKIAotCXIgPSBtaXBpX2RzaV9jcmVhdGVfcGFja2V0KCZwYWNrZXQsIG1zZyk7Ci0J
aWYgKHIgPCAwKQotCQlyZXR1cm4gcjsKLQotCWlmIChtaXBpX2RzaV9wYWNrZXRfZm9ybWF0X2lz
X3Nob3J0KG1zZy0+dHlwZSkpIHsKLQkJdTE2IGRhdGEgPSBwYWNrZXQuaGVhZGVyWzFdIHwgKHBh
Y2tldC5oZWFkZXJbMl0gPDwgOCk7Ci0JCXIgPSBkc2lfdmNfc2VuZF9zaG9ydChkc2ksIG1zZy0+
Y2hhbm5lbCwgbXNnLT50eXBlLCBkYXRhLCAwKTsKLQl9IGVsc2UgewotCQlyID0gZHNpX3ZjX3Nl
bmRfbG9uZyhkc2ksIG1zZy0+Y2hhbm5lbCwgbXNnLT50eXBlLAotCQkJCQkJICAgbXNnLT50eF9i
dWYsIG1zZy0+dHhfbGVuLCAwKTsKLQl9CisJaWYgKG1pcGlfZHNpX3BhY2tldF9mb3JtYXRfaXNf
c2hvcnQobXNnLT50eXBlKSkKKwkJciA9IGRzaV92Y19zZW5kX3Nob3J0KGRzaSwgbXNnKTsKKwll
bHNlCisJCXIgPSBkc2lfdmNfc2VuZF9sb25nKGRzaSwgbXNnKTsKIAogCWlmIChyIDwgMCkKIAkJ
cmV0dXJuIHI7CkBAIC0yODUzLDEwICsyODU5LDEwIEBAIHN0YXRpYyBpbnQgZHNpX3ZjX2Rjc19y
ZWFkKHN0cnVjdCBvbWFwX2Rzc19kZXZpY2UgKmRzc2RldiwKIAkJCSAgIGNvbnN0IHN0cnVjdCBt
aXBpX2RzaV9tc2cgKm1zZykKIHsKIAlzdHJ1Y3QgZHNpX2RhdGEgKmRzaSA9IHRvX2RzaV9kYXRh
KGRzc2Rldik7CisJdTggY21kID0gKCh1OCopIG1zZy0+dHhfYnVmKVswXTsKIAlpbnQgcjsKLQl1
OCBkY3NfY21kID0gKCh1OCopIG1zZy0+dHhfYnVmKVswXTsKIAotCXIgPSBkc2lfdmNfc2VuZF9z
aG9ydChkc2ksIG1zZy0+Y2hhbm5lbCwgTUlQSV9EU0lfRENTX1JFQUQsIGRjc19jbWQsIDApOwor
CXIgPSBkc2lfdmNfc2VuZF9zaG9ydChkc2ksIG1zZyk7CiAJaWYgKHIpCiAJCWdvdG8gZXJyOwog
CkBAIC0yODc3LDcgKzI4ODMsNyBAQCBzdGF0aWMgaW50IGRzaV92Y19kY3NfcmVhZChzdHJ1Y3Qg
b21hcF9kc3NfZGV2aWNlICpkc3NkZXYsCiAJcmV0dXJuIDA7CiBlcnI6CiAJRFNTRVJSKCJkc2lf
dmNfZGNzX3JlYWQoY2ggJWQsIGNtZCAweCUwMngpIGZhaWxlZFxuIiwKLQkJbXNnLT5jaGFubmVs
LCBkY3NfY21kKTsKKwkJbXNnLT5jaGFubmVsLCBjbWQpOwogCXJldHVybiByOwogfQogCkBAIC0y
ODg1LDE3ICsyODkxLDkgQEAgc3RhdGljIGludCBkc2lfdmNfZ2VuZXJpY19yZWFkKHN0cnVjdCBv
bWFwX2Rzc19kZXZpY2UgKmRzc2RldiwKIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgbWlwaV9kc2lf
bXNnICptc2cpCiB7CiAJc3RydWN0IGRzaV9kYXRhICpkc2kgPSB0b19kc2lfZGF0YShkc3NkZXYp
OwotCXN0cnVjdCBtaXBpX2RzaV9wYWNrZXQgcGFja2V0OwotCXUxNiBkYXRhOwogCWludCByOwog
Ci0JciA9IG1pcGlfZHNpX2NyZWF0ZV9wYWNrZXQoJnBhY2tldCwgbXNnKTsKLQlpZiAociA8IDAp
Ci0JCWdvdG8gZXJyOwotCi0JZGF0YSA9IHBhY2tldC5oZWFkZXJbMV0gfCAocGFja2V0LmhlYWRl
clsyXSA8PCA4KTsKLQotCXIgPSBkc2lfdmNfc2VuZF9zaG9ydChkc2ksIG1zZy0+Y2hhbm5lbCwg
bXNnLT50eXBlLCBkYXRhLCAwKTsKKwlyID0gZHNpX3ZjX3NlbmRfc2hvcnQoZHNpLCBtc2cpOwog
CWlmIChyKQogCQlnb3RvIGVycjsKIAotLSAKMi4yNC4wCgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZl
bEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFp
bG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
