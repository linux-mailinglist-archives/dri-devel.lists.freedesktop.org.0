Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 345EAF1231
	for <lists+dri-devel@lfdr.de>; Wed,  6 Nov 2019 10:31:43 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 5DD776EC7F;
	Wed,  6 Nov 2019 09:31:31 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 683196EC77
 for <dri-devel@lists.freedesktop.org>; Wed,  6 Nov 2019 09:31:28 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id A8C4EB414;
 Wed,  6 Nov 2019 09:31:25 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: daniel@ffwll.ch,
	christian.koenig@amd.com,
	noralf@tronnes.org
Subject: [PATCH 5/8] drm/client: Return I/O memory flag from
 drm_client_buffer_vmap()
Date: Wed,  6 Nov 2019 10:31:18 +0100
Message-Id: <20191106093121.21762-6-tzimmermann@suse.de>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191106093121.21762-1-tzimmermann@suse.de>
References: <20191106093121.21762-1-tzimmermann@suse.de>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Zimmermann <tzimmermann@suse.de>, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

V2l0aCB0aGlzIHBhdGNoLCBkcm1fY2xpZW50X2J1ZmZlcl92bWFwKCkgZm9yd2FyZHMgdGhlIGlv
X21lbSBwYXJhbWV0ZXIKZnJvbSB0aGUgdm1hcCBpbXBsZW1lbnRhdGlvbiB0byBpdHMgY2FsbGVy
LiBCeSBkZWZhdWx0LCBpc19pb21lbSBpcwphc3N1bWVkIHRvIGJlIGZhbHNlLiBUaGlzIG1hdGNo
ZXMgdGhlIHJldHVybiB0eXBlIGFuZCB0aGUgb2xkIGJlaGF2aW91ci4KClNpZ25lZC1vZmYtYnk6
IFRob21hcyBaaW1tZXJtYW5uIDx0emltbWVybWFubkBzdXNlLmRlPgotLS0KIGRyaXZlcnMvZ3B1
L2RybS9kcm1fY2xpZW50LmMgICAgfCAxNSArKysrKysrKysrKystLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9kcm1fZmJfaGVscGVyLmMgfCAgNCArKy0tCiBpbmNsdWRlL2RybS9kcm1fY2xpZW50LmggICAg
ICAgIHwgIDcgKysrKysrLQogMyBmaWxlcyBjaGFuZ2VkLCAyMCBpbnNlcnRpb25zKCspLCA2IGRl
bGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9kcm1fY2xpZW50LmMgYi9k
cml2ZXJzL2dwdS9kcm0vZHJtX2NsaWVudC5jCmluZGV4IDBlY2I1ODg3NzhjNS4uNDRhZjU2ZmM0
YjRkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2NsaWVudC5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9kcm1fY2xpZW50LmMKQEAgLTI5MCw2ICsyOTAsOCBAQCBkcm1fY2xpZW50X2J1
ZmZlcl9jcmVhdGUoc3RydWN0IGRybV9jbGllbnRfZGV2ICpjbGllbnQsIHUzMiB3aWR0aCwgdTMy
IGhlaWdodCwgdQogLyoqCiAgKiBkcm1fY2xpZW50X2J1ZmZlcl92bWFwIC0gTWFwIERSTSBjbGll
bnQgYnVmZmVyIGludG8gYWRkcmVzcyBzcGFjZQogICogQGJ1ZmZlcjogRFJNIGNsaWVudCBidWZm
ZXIKKyAqIEBpc19pb21lbTogUmV0dXJucyB0cnVlIGlmIHRoZSBtYXBwZWQgbWVtb3J5IGlzIEkv
TyBtZW1vcnksIG9yIGZhbHNlCisgKiAgICAgICAgICAgIG90aGVyd2lzZTsgY2FuIGJlIE5VTEwK
ICAqCiAgKiBUaGlzIGZ1bmN0aW9uIG1hcHMgYSBjbGllbnQgYnVmZmVyIGludG8ga2VybmVsIGFk
ZHJlc3Mgc3BhY2UuIElmIHRoZQogICogYnVmZmVyIGlzIGFscmVhZHkgbWFwcGVkLCBpdCByZXR1
cm5zIHRoZSBtYXBwaW5nJ3MgYWRkcmVzcy4KQEAgLTMwMiwxMiArMzA0LDE2IEBAIGRybV9jbGll
bnRfYnVmZmVyX2NyZWF0ZShzdHJ1Y3QgZHJtX2NsaWVudF9kZXYgKmNsaWVudCwgdTMyIHdpZHRo
LCB1MzIgaGVpZ2h0LCB1CiAgKiBSZXR1cm5zOgogICoJVGhlIG1hcHBlZCBtZW1vcnkncyBhZGRy
ZXNzCiAgKi8KLXZvaWQgKmRybV9jbGllbnRfYnVmZmVyX3ZtYXAoc3RydWN0IGRybV9jbGllbnRf
YnVmZmVyICpidWZmZXIpCit2b2lkICpkcm1fY2xpZW50X2J1ZmZlcl92bWFwKHN0cnVjdCBkcm1f
Y2xpZW50X2J1ZmZlciAqYnVmZmVyLCBib29sICppc19pb21lbSkKIHsKIAl2b2lkICp2YWRkcjsK
Kwlib29sIHZhZGRyX2lzX2lvbWVtOwogCi0JaWYgKGJ1ZmZlci0+dmFkZHIpCisJaWYgKGJ1ZmZl
ci0+dmFkZHIpIHsKKwkJaWYgKGlzX2lvbWVtKQorCQkJKmlzX2lvbWVtID0gYnVmZmVyLT52YWRk
cl9pc19pb21lbTsKIAkJcmV0dXJuIGJ1ZmZlci0+dmFkZHI7CisJfQogCiAJLyoKIAkgKiBGSVhN
RTogVGhlIGRlcGVuZGVuY3kgb24gR0VNIGhlcmUgaXNuJ3QgcmVxdWlyZWQsIHdlIGNvdWxkCkBA
IC0zMTcsMTIgKzMyMywxNSBAQCB2b2lkICpkcm1fY2xpZW50X2J1ZmZlcl92bWFwKHN0cnVjdCBk
cm1fY2xpZW50X2J1ZmZlciAqYnVmZmVyKQogCSAqIGZkX2luc3RhbGwgc3RlcCBvdXQgb2YgdGhl
IGRyaXZlciBiYWNrZW5kIGhvb2tzLCB0byBtYWtlIHRoYXQKIAkgKiBmaW5hbCBzdGVwIG9wdGlv
bmFsIGZvciBpbnRlcm5hbCB1c2Vycy4KIAkgKi8KLQl2YWRkciA9IGRybV9nZW1fdm1hcChidWZm
ZXItPmdlbSwgTlVMTCk7CisJdmFkZHIgPSBkcm1fZ2VtX3ZtYXAoYnVmZmVyLT5nZW0sICZ2YWRk
cl9pc19pb21lbSk7CiAJaWYgKElTX0VSUih2YWRkcikpCiAJCXJldHVybiB2YWRkcjsKIAogCWJ1
ZmZlci0+dmFkZHIgPSB2YWRkcjsKKwlidWZmZXItPnZhZGRyX2lzX2lvbWVtID0gdmFkZHJfaXNf
aW9tZW07CiAKKwlpZiAoaXNfaW9tZW0pCisJCSppc19pb21lbSA9IHZhZGRyX2lzX2lvbWVtOwog
CXJldHVybiB2YWRkcjsKIH0KIEVYUE9SVF9TWU1CT0woZHJtX2NsaWVudF9idWZmZXJfdm1hcCk7
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2ZiX2hlbHBlci5jIGIvZHJpdmVycy9n
cHUvZHJtL2RybV9mYl9oZWxwZXIuYwppbmRleCA4ZWJlY2NkZWVkMjMuLmVmZjc1ZmFkN2NhYiAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2RybV9mYl9oZWxwZXIuYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vZHJtX2ZiX2hlbHBlci5jCkBAIC00MjIsNyArNDIyLDcgQEAgc3RhdGljIHZvaWQg
ZHJtX2ZiX2hlbHBlcl9kaXJ0eV93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKIAogCQkv
KiBHZW5lcmljIGZiZGV2IHVzZXMgYSBzaGFkb3cgYnVmZmVyICovCiAJCWlmIChoZWxwZXItPmJ1
ZmZlcikgewotCQkJdmFkZHIgPSBkcm1fY2xpZW50X2J1ZmZlcl92bWFwKGhlbHBlci0+YnVmZmVy
KTsKKwkJCXZhZGRyID0gZHJtX2NsaWVudF9idWZmZXJfdm1hcChoZWxwZXItPmJ1ZmZlciwgTlVM
TCk7CiAJCQlpZiAoSVNfRVJSKHZhZGRyKSkKIAkJCQlyZXR1cm47CiAJCQlkcm1fZmJfaGVscGVy
X2RpcnR5X2JsaXRfcmVhbChoZWxwZXIsICZjbGlwX2NvcHkpOwpAQCAtMjIxMiw3ICsyMjEyLDcg
QEAgaW50IGRybV9mYl9oZWxwZXJfZ2VuZXJpY19wcm9iZShzdHJ1Y3QgZHJtX2ZiX2hlbHBlciAq
ZmJfaGVscGVyLAogCQlmYl9kZWZlcnJlZF9pb19pbml0KGZiaSk7CiAJfSBlbHNlIHsKIAkJLyog
YnVmZmVyIGlzIG1hcHBlZCBmb3IgSFcgZnJhbWVidWZmZXIgKi8KLQkJdmFkZHIgPSBkcm1fY2xp
ZW50X2J1ZmZlcl92bWFwKGZiX2hlbHBlci0+YnVmZmVyKTsKKwkJdmFkZHIgPSBkcm1fY2xpZW50
X2J1ZmZlcl92bWFwKGZiX2hlbHBlci0+YnVmZmVyLCBOVUxMKTsKIAkJaWYgKElTX0VSUih2YWRk
cikpCiAJCQlyZXR1cm4gUFRSX0VSUih2YWRkcik7CiAKZGlmZiAtLWdpdCBhL2luY2x1ZGUvZHJt
L2RybV9jbGllbnQuaCBiL2luY2x1ZGUvZHJtL2RybV9jbGllbnQuaAppbmRleCA1Y2YyYzVkZDhi
MWUuLjA1M2Q1ODIxNWJlNyAxMDA2NDQKLS0tIGEvaW5jbHVkZS9kcm0vZHJtX2NsaWVudC5oCisr
KyBiL2luY2x1ZGUvZHJtL2RybV9jbGllbnQuaApAQCAtMTQwLDYgKzE0MCwxMSBAQCBzdHJ1Y3Qg
ZHJtX2NsaWVudF9idWZmZXIgewogCSAqLwogCXZvaWQgKnZhZGRyOwogCisJLyoqCisJICogQHZh
ZGRyX2lzX2lvbWVtOiBUcnVlIGlmIHZhZGRyIHBvaW50cyB0byBJL08gbWVtb3J5LCBmYWxzZSBv
dGhlcndpc2UKKwkgKi8KKwlib29sIHZhZGRyX2lzX2lvbWVtOworCiAJLyoqCiAJICogQGZiOiBE
Uk0gZnJhbWVidWZmZXIKIAkgKi8KQEAgLTE0OSw3ICsxNTQsNyBAQCBzdHJ1Y3QgZHJtX2NsaWVu
dF9idWZmZXIgewogc3RydWN0IGRybV9jbGllbnRfYnVmZmVyICoKIGRybV9jbGllbnRfZnJhbWVi
dWZmZXJfY3JlYXRlKHN0cnVjdCBkcm1fY2xpZW50X2RldiAqY2xpZW50LCB1MzIgd2lkdGgsIHUz
MiBoZWlnaHQsIHUzMiBmb3JtYXQpOwogdm9pZCBkcm1fY2xpZW50X2ZyYW1lYnVmZmVyX2RlbGV0
ZShzdHJ1Y3QgZHJtX2NsaWVudF9idWZmZXIgKmJ1ZmZlcik7Ci12b2lkICpkcm1fY2xpZW50X2J1
ZmZlcl92bWFwKHN0cnVjdCBkcm1fY2xpZW50X2J1ZmZlciAqYnVmZmVyKTsKK3ZvaWQgKmRybV9j
bGllbnRfYnVmZmVyX3ZtYXAoc3RydWN0IGRybV9jbGllbnRfYnVmZmVyICpidWZmZXIsIGJvb2wg
KmlzX2lvbWVtKTsKIHZvaWQgZHJtX2NsaWVudF9idWZmZXJfdnVubWFwKHN0cnVjdCBkcm1fY2xp
ZW50X2J1ZmZlciAqYnVmZmVyKTsKIAogaW50IGRybV9jbGllbnRfbW9kZXNldF9jcmVhdGUoc3Ry
dWN0IGRybV9jbGllbnRfZGV2ICpjbGllbnQpOwotLSAKMi4yMy4wCgpfX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRy
aS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5v
cmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
