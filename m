Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 5C7DC3633F
	for <lists+dri-devel@lfdr.de>; Wed,  5 Jun 2019 20:17:47 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id DABD7895C1;
	Wed,  5 Jun 2019 18:17:41 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 031C5895B5;
 Wed,  5 Jun 2019 18:17:41 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx04.intmail.prod.int.phx2.redhat.com
 [10.5.11.14])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 908F12F8BC8;
 Wed,  5 Jun 2019 18:17:40 +0000 (UTC)
Received: from shalem.localdomain.com (ovpn-116-66.ams2.redhat.com
 [10.36.116.66])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 04B8D18E3C;
 Wed,  5 Jun 2019 18:17:38 +0000 (UTC)
From: Hans de Goede <hdegoede@redhat.com>
To: Jani Nikula <jani.nikula@linux.intel.com>,
 Joonas Lahtinen <joonas.lahtinen@linux.intel.com>,
 Rodrigo Vivi <rodrigo.vivi@intel.com>,
 =?UTF-8?q?Ville=20Syrj=C3=A4l=C3=A4?= <ville.syrjala@linux.intel.com>
Subject: [PATCH 2/3] drm/i915/dsi: Move vlv/icl_dphy_param_init call out of
 intel_dsi_vbt_init (v2)
Date: Wed,  5 Jun 2019 20:17:34 +0200
Message-Id: <20190605181735.7020-2-hdegoede@redhat.com>
In-Reply-To: <20190605181735.7020-1-hdegoede@redhat.com>
References: <20190605181735.7020-1-hdegoede@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.14
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.38]); Wed, 05 Jun 2019 18:17:40 +0000 (UTC)
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Hans de Goede <hdegoede@redhat.com>,
 intel-gfx <intel-gfx@lists.freedesktop.org>, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIHZsdi9pY2xfZHBoeV9wYXJhbV9pbml0IGNhbGxzIGRvIHZhcmlvdXMgY2FsY3VsYXRpb25z
IHRvIHNldCBkcGh5CnBhcmFtZXRlcnMgYmFzZWQgb24gdGhlIHBjbGsuCgpNb3ZlIHRoZSBjYWxs
aW5nIG9mIHZsdi9pY2xfZHBoeV9wYXJhbV9pbml0IHRvIHZsdl9kc2lfaW5pdCB0byBnaXZlCnZs
dl9kc2lfaW5pdCBhIGNoYW5jZSB0byB0d2VhayB0aGUgcGNsayBiZWZvcmUgdGhlc2UgY2FsY3Vs
YXRpb25zIGFyZSBkb25lLgoKQ2hhbmdlcyBpbiB2MjoKLUFsc28gbW92ZXMgdGhlIGljbCBhbmQg
dmx2IHNwZWNpZmljIGRwaHlfcGFyYW1faW5pdCBmdW5jdGlvbnMgZnJvbSB0aGUKIGdlbmVyaWMg
aW50ZWxfZHNpX3ZidC5jIGZpbGUgaW50byB0aGUgaWNsXyBhbmQgdmx2X2RzaS5jIHNwZWNpZmlj
IGZpbGVzLgoKTm90ZSBpY2xfZHBoeV9wYXJhbV9pbml0KCkgYW5kIHZsdl9kcGh5X3BhcmFtX2lu
aXQoKSBhcmUgb25seSBtb3ZlZCwKb3RoZXJ3aXNlIHRoZXkgYXJlIGNvbXBsZXRlbHkgdW5jaGFu
Z2VkLgoKU2lnbmVkLW9mZi1ieTogSGFucyBkZSBHb2VkZSA8aGRlZ29lZGVAcmVkaGF0LmNvbT4K
LS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pY2xfZHNpLmMgICAgICAgfCAxMDggKysrKysrKysr
KwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHNpLmggICAgIHwgICAxICsKIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX2RzaV92YnQuYyB8IDI4MiArLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L3Zsdl9kc2kuYyAgICAgICB8IDE3MCArKysrKysr
KysrKysrKysrCiA0IGZpbGVzIGNoYW5nZWQsIDI4MCBpbnNlcnRpb25zKCspLCAyODEgZGVsZXRp
b25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaWNsX2RzaS5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaWNsX2RzaS5jCmluZGV4IDlkOTYyZWExZTYzNS4uNTExYzc2ZTc4
OGVmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pY2xfZHNpLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaWNsX2RzaS5jCkBAIC0xMzYzLDYgKzEzNjMsMTEzIEBAIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgbWlwaV9kc2lfaG9zdF9vcHMgZ2VuMTFfZHNpX2hvc3Rfb3BzID0gewog
CS50cmFuc2ZlciA9IGdlbjExX2RzaV9ob3N0X3RyYW5zZmVyLAogfTsKIAorI2RlZmluZSBJQ0xf
UFJFUEFSRV9DTlRfTUFYCTB4NworI2RlZmluZSBJQ0xfQ0xLX1pFUk9fQ05UX01BWAkweGYKKyNk
ZWZpbmUgSUNMX1RSQUlMX0NOVF9NQVgJMHg3CisjZGVmaW5lIElDTF9UQ0xLX1BSRV9DTlRfTUFY
CTB4MworI2RlZmluZSBJQ0xfVENMS19QT1NUX0NOVF9NQVgJMHg3CisjZGVmaW5lIElDTF9IU19a
RVJPX0NOVF9NQVgJMHhmCisjZGVmaW5lIElDTF9FWElUX1pFUk9fQ05UX01BWAkweDcKKworc3Rh
dGljIHZvaWQgaWNsX2RwaHlfcGFyYW1faW5pdChzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kp
Cit7CisJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGludGVsX2RzaS0+YmFzZS5iYXNlLmRldjsK
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7CisJc3Ry
dWN0IG1pcGlfY29uZmlnICptaXBpX2NvbmZpZyA9IGRldl9wcml2LT52YnQuZHNpLmNvbmZpZzsK
Kwl1MzIgdGxweF9uczsKKwl1MzIgcHJlcGFyZV9jbnQsIGV4aXRfemVyb19jbnQsIGNsa196ZXJv
X2NudCwgdHJhaWxfY250OworCXUzMiB0aHNfcHJlcGFyZV9ucywgdGNsa190cmFpbF9uczsKKwl1
MzIgaHNfemVyb19jbnQ7CisJdTMyIHRjbGtfcHJlX2NudCwgdGNsa19wb3N0X2NudDsKKworCXRs
cHhfbnMgPSBpbnRlbF9kc2lfdGxweF9ucyhpbnRlbF9kc2kpOworCisJdGNsa190cmFpbF9ucyA9
IG1heChtaXBpX2NvbmZpZy0+dGNsa190cmFpbCwgbWlwaV9jb25maWctPnRoc190cmFpbCk7CisJ
dGhzX3ByZXBhcmVfbnMgPSBtYXgobWlwaV9jb25maWctPnRoc19wcmVwYXJlLAorCQkJICAgICBt
aXBpX2NvbmZpZy0+dGNsa19wcmVwYXJlKTsKKworCS8qCisJICogcHJlcGFyZSBjbnQgaW4gZXNj
YXBlIGNsb2NrcworCSAqIHRoaXMgZmllbGQgcmVwcmVzZW50cyBhIGhleGFkZWNpbWFsIHZhbHVl
IHdpdGggYSBwcmVjaXNpb24KKwkgKiBvZiAxLjIg4oCTIGkuZS4gdGhlIG1vc3Qgc2lnbmlmaWNh
bnQgYml0IGlzIHRoZSBpbnRlZ2VyCisJICogYW5kIHRoZSBsZWFzdCBzaWduaWZpY2FudCAyIGJp
dHMgYXJlIGZyYWN0aW9uIGJpdHMuCisJICogc28sIHRoZSBmaWVsZCBjYW4gcmVwcmVzZW50IGEg
cmFuZ2Ugb2YgMC4yNSB0byAxLjc1CisJICovCisJcHJlcGFyZV9jbnQgPSBESVZfUk9VTkRfVVAo
dGhzX3ByZXBhcmVfbnMgKiA0LCB0bHB4X25zKTsKKwlpZiAocHJlcGFyZV9jbnQgPiBJQ0xfUFJF
UEFSRV9DTlRfTUFYKSB7CisJCURSTV9ERUJVR19LTVMoInByZXBhcmVfY250IG91dCBvZiByYW5n
ZSAoJWQpXG4iLCBwcmVwYXJlX2NudCk7CisJCXByZXBhcmVfY250ID0gSUNMX1BSRVBBUkVfQ05U
X01BWDsKKwl9CisKKwkvKiBjbGsgemVybyBjb3VudCBpbiBlc2NhcGUgY2xvY2tzICovCisJY2xr
X3plcm9fY250ID0gRElWX1JPVU5EX1VQKG1pcGlfY29uZmlnLT50Y2xrX3ByZXBhcmVfY2xremVy
byAtCisJCQkJICAgIHRoc19wcmVwYXJlX25zLCB0bHB4X25zKTsKKwlpZiAoY2xrX3plcm9fY250
ID4gSUNMX0NMS19aRVJPX0NOVF9NQVgpIHsKKwkJRFJNX0RFQlVHX0tNUygiY2xrX3plcm9fY250
IG91dCBvZiByYW5nZSAoJWQpXG4iLCBjbGtfemVyb19jbnQpOworCQljbGtfemVyb19jbnQgPSBJ
Q0xfQ0xLX1pFUk9fQ05UX01BWDsKKwl9CisKKwkvKiB0cmFpbCBjbnQgaW4gZXNjYXBlIGNsb2Nr
cyovCisJdHJhaWxfY250ID0gRElWX1JPVU5EX1VQKHRjbGtfdHJhaWxfbnMsIHRscHhfbnMpOwor
CWlmICh0cmFpbF9jbnQgPiBJQ0xfVFJBSUxfQ05UX01BWCkgeworCQlEUk1fREVCVUdfS01TKCJ0
cmFpbF9jbnQgb3V0IG9mIHJhbmdlICglZClcbiIsIHRyYWlsX2NudCk7CisJCXRyYWlsX2NudCA9
IElDTF9UUkFJTF9DTlRfTUFYOworCX0KKworCS8qIHRjbGsgcHJlIGNvdW50IGluIGVzY2FwZSBj
bG9ja3MgKi8KKwl0Y2xrX3ByZV9jbnQgPSBESVZfUk9VTkRfVVAobWlwaV9jb25maWctPnRjbGtf
cHJlLCB0bHB4X25zKTsKKwlpZiAodGNsa19wcmVfY250ID4gSUNMX1RDTEtfUFJFX0NOVF9NQVgp
IHsKKwkJRFJNX0RFQlVHX0tNUygidGNsa19wcmVfY250IG91dCBvZiByYW5nZSAoJWQpXG4iLCB0
Y2xrX3ByZV9jbnQpOworCQl0Y2xrX3ByZV9jbnQgPSBJQ0xfVENMS19QUkVfQ05UX01BWDsKKwl9
CisKKwkvKiB0Y2xrIHBvc3QgY291bnQgaW4gZXNjYXBlIGNsb2NrcyAqLworCXRjbGtfcG9zdF9j
bnQgPSBESVZfUk9VTkRfVVAobWlwaV9jb25maWctPnRjbGtfcG9zdCwgdGxweF9ucyk7CisJaWYg
KHRjbGtfcG9zdF9jbnQgPiBJQ0xfVENMS19QT1NUX0NOVF9NQVgpIHsKKwkJRFJNX0RFQlVHX0tN
UygidGNsa19wb3N0X2NudCBvdXQgb2YgcmFuZ2UgKCVkKVxuIiwgdGNsa19wb3N0X2NudCk7CisJ
CXRjbGtfcG9zdF9jbnQgPSBJQ0xfVENMS19QT1NUX0NOVF9NQVg7CisJfQorCisJLyogaHMgemVy
byBjbnQgaW4gZXNjYXBlIGNsb2NrcyAqLworCWhzX3plcm9fY250ID0gRElWX1JPVU5EX1VQKG1p
cGlfY29uZmlnLT50aHNfcHJlcGFyZV9oc3plcm8gLQorCQkJCSAgIHRoc19wcmVwYXJlX25zLCB0
bHB4X25zKTsKKwlpZiAoaHNfemVyb19jbnQgPiBJQ0xfSFNfWkVST19DTlRfTUFYKSB7CisJCURS
TV9ERUJVR19LTVMoImhzX3plcm9fY250IG91dCBvZiByYW5nZSAoJWQpXG4iLCBoc196ZXJvX2Nu
dCk7CisJCWhzX3plcm9fY250ID0gSUNMX0hTX1pFUk9fQ05UX01BWDsKKwl9CisKKwkvKiBocyBl
eGl0IHplcm8gY250IGluIGVzY2FwZSBjbG9ja3MgKi8KKwlleGl0X3plcm9fY250ID0gRElWX1JP
VU5EX1VQKG1pcGlfY29uZmlnLT50aHNfZXhpdCwgdGxweF9ucyk7CisJaWYgKGV4aXRfemVyb19j
bnQgPiBJQ0xfRVhJVF9aRVJPX0NOVF9NQVgpIHsKKwkJRFJNX0RFQlVHX0tNUygiZXhpdF96ZXJv
X2NudCBvdXQgb2YgcmFuZ2UgKCVkKVxuIiwgZXhpdF96ZXJvX2NudCk7CisJCWV4aXRfemVyb19j
bnQgPSBJQ0xfRVhJVF9aRVJPX0NOVF9NQVg7CisJfQorCisJLyogY2xvY2sgbGFuZSBkcGh5IHRp
bWluZ3MgKi8KKwlpbnRlbF9kc2ktPmRwaHlfcmVnID0gKENMS19QUkVQQVJFX09WRVJSSURFIHwK
KwkJCSAgICAgICBDTEtfUFJFUEFSRShwcmVwYXJlX2NudCkgfAorCQkJICAgICAgIENMS19aRVJP
X09WRVJSSURFIHwKKwkJCSAgICAgICBDTEtfWkVSTyhjbGtfemVyb19jbnQpIHwKKwkJCSAgICAg
ICBDTEtfUFJFX09WRVJSSURFIHwKKwkJCSAgICAgICBDTEtfUFJFKHRjbGtfcHJlX2NudCkgfAor
CQkJICAgICAgIENMS19QT1NUX09WRVJSSURFIHwKKwkJCSAgICAgICBDTEtfUE9TVCh0Y2xrX3Bv
c3RfY250KSB8CisJCQkgICAgICAgQ0xLX1RSQUlMX09WRVJSSURFIHwKKwkJCSAgICAgICBDTEtf
VFJBSUwodHJhaWxfY250KSk7CisKKwkvKiBkYXRhIGxhbmVzIGRwaHkgdGltaW5ncyAqLworCWlu
dGVsX2RzaS0+ZHBoeV9kYXRhX2xhbmVfcmVnID0gKEhTX1BSRVBBUkVfT1ZFUlJJREUgfAorCQkJ
CQkgSFNfUFJFUEFSRShwcmVwYXJlX2NudCkgfAorCQkJCQkgSFNfWkVST19PVkVSUklERSB8CisJ
CQkJCSBIU19aRVJPKGhzX3plcm9fY250KSB8CisJCQkJCSBIU19UUkFJTF9PVkVSUklERSB8CisJ
CQkJCSBIU19UUkFJTCh0cmFpbF9jbnQpIHwKKwkJCQkJIEhTX0VYSVRfT1ZFUlJJREUgfAorCQkJ
CQkgSFNfRVhJVChleGl0X3plcm9fY250KSk7CisKKwlpbnRlbF9kc2lfbG9nX3BhcmFtcyhpbnRl
bF9kc2kpOworfQorCiB2b2lkIGljbF9kc2lfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCiB7CiAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZkZXZfcHJpdi0+ZHJtOwpA
QCAtMTQ1NSw2ICsxNTYyLDcgQEAgdm9pZCBpY2xfZHNpX2luaXQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQogCQlnb3RvIGVycjsKIAl9CiAKKwlpY2xfZHBoeV9wYXJhbV9pbml0
KGludGVsX2RzaSk7CiAJcmV0dXJuOwogCiBlcnI6CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9kc2kuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RzaS5oCmlu
ZGV4IDcwNWE2MDkwNTBjMC4uMmU5OTcxODdmZWQ1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9kc2kuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kc2ku
aApAQCAtMTkyLDUgKzE5Miw2IEBAIGJvb2wgaW50ZWxfZHNpX3ZidF9pbml0KHN0cnVjdCBpbnRl
bF9kc2kgKmludGVsX2RzaSwgdTE2IHBhbmVsX2lkKTsKIHZvaWQgaW50ZWxfZHNpX3ZidF9leGVj
X3NlcXVlbmNlKHN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSwKIAkJCQkgZW51bSBtaXBpX3Nl
cSBzZXFfaWQpOwogdm9pZCBpbnRlbF9kc2lfbXNsZWVwKHN0cnVjdCBpbnRlbF9kc2kgKmludGVs
X2RzaSwgaW50IG1zZWMpOwordm9pZCBpbnRlbF9kc2lfbG9nX3BhcmFtcyhzdHJ1Y3QgaW50ZWxf
ZHNpICppbnRlbF9kc2kpOwogCiAjZW5kaWYgLyogX0lOVEVMX0RTSV9IICovCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kc2lfdmJ0LmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9kc2lfdmJ0LmMKaW5kZXggM2ExODdmZmFiZmJkLi4yNmZjYjMzNDRlYmIgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RzaV92YnQuYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kc2lfdmJ0LmMKQEAgLTQxLDEzICs0MSw2IEBACiAjZGVm
aW5lIE1JUElfVklSVFVBTF9DSEFOTkVMX1NISUZUCTEKICNkZWZpbmUgTUlQSV9QT1JUX1NISUZU
CQkJMwogCi0jZGVmaW5lIFBSRVBBUkVfQ05UX01BWAkJMHgzRgotI2RlZmluZSBFWElUX1pFUk9f
Q05UX01BWAkweDNGCi0jZGVmaW5lIENMS19aRVJPX0NOVF9NQVgJMHhGRgotI2RlZmluZSBUUkFJ
TF9DTlRfTUFYCQkweDFGCi0KLSNkZWZpbmUgTlNfS0haX1JBVElPIDEwMDAwMDAKLQogLyogYmFz
ZSBvZmZzZXRzIGZvciBncGlvIHBhZHMgKi8KICNkZWZpbmUgVkxWX0dQSU9fTkNfMF9IVl9EREkw
X0hQRAkweDQxMzAKICNkZWZpbmUgVkxWX0dQSU9fTkNfMV9IVl9EREkwX0REQ19TREEJMHg0MTIw
CkBAIC01MzIsNyArNTI1LDcgQEAgdm9pZCBpbnRlbF9kc2lfbXNsZWVwKHN0cnVjdCBpbnRlbF9k
c2kgKmludGVsX2RzaSwgaW50IG1zZWMpCiAJbXNsZWVwKG1zZWMpOwogfQogCi1zdGF0aWMgdm9p
ZCBpbnRlbF9kc2lfbG9nX3BhcmFtcyhzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kpCit2b2lk
IGludGVsX2RzaV9sb2dfcGFyYW1zKHN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSkKIHsKIAlE
Uk1fREVCVUdfS01TKCJQY2xrICVkXG4iLCBpbnRlbF9kc2ktPnBjbGspOwogCURSTV9ERUJVR19L
TVMoIlBpeGVsIG92ZXJsYXAgJWRcbiIsIGludGVsX2RzaS0+cGl4ZWxfb3ZlcmxhcCk7CkBAIC01
NzAsMjc0ICs1NjMsNiBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kc2lfbG9nX3BhcmFtcyhzdHJ1Y3Qg
aW50ZWxfZHNpICppbnRlbF9kc2kpCiAJCQllbmFibGVkZGlzYWJsZWQoIShpbnRlbF9kc2ktPnZp
ZGVvX2ZybXRfY2ZnX2JpdHMgJiBESVNBQkxFX1ZJREVPX0JUQSkpKTsKIH0KIAotI2RlZmluZSBJ
Q0xfUFJFUEFSRV9DTlRfTUFYCTB4NwotI2RlZmluZSBJQ0xfQ0xLX1pFUk9fQ05UX01BWAkweGYK
LSNkZWZpbmUgSUNMX1RSQUlMX0NOVF9NQVgJMHg3Ci0jZGVmaW5lIElDTF9UQ0xLX1BSRV9DTlRf
TUFYCTB4MwotI2RlZmluZSBJQ0xfVENMS19QT1NUX0NOVF9NQVgJMHg3Ci0jZGVmaW5lIElDTF9I
U19aRVJPX0NOVF9NQVgJMHhmCi0jZGVmaW5lIElDTF9FWElUX1pFUk9fQ05UX01BWAkweDcKLQot
c3RhdGljIHZvaWQgaWNsX2RwaHlfcGFyYW1faW5pdChzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9k
c2kpCi17Ci0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGludGVsX2RzaS0+YmFzZS5iYXNlLmRl
djsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Ci0J
c3RydWN0IG1pcGlfY29uZmlnICptaXBpX2NvbmZpZyA9IGRldl9wcml2LT52YnQuZHNpLmNvbmZp
ZzsKLQl1MzIgdGxweF9uczsKLQl1MzIgcHJlcGFyZV9jbnQsIGV4aXRfemVyb19jbnQsIGNsa196
ZXJvX2NudCwgdHJhaWxfY250OwotCXUzMiB0aHNfcHJlcGFyZV9ucywgdGNsa190cmFpbF9uczsK
LQl1MzIgaHNfemVyb19jbnQ7Ci0JdTMyIHRjbGtfcHJlX2NudCwgdGNsa19wb3N0X2NudDsKLQot
CXRscHhfbnMgPSBpbnRlbF9kc2lfdGxweF9ucyhpbnRlbF9kc2kpOwotCi0JdGNsa190cmFpbF9u
cyA9IG1heChtaXBpX2NvbmZpZy0+dGNsa190cmFpbCwgbWlwaV9jb25maWctPnRoc190cmFpbCk7
Ci0JdGhzX3ByZXBhcmVfbnMgPSBtYXgobWlwaV9jb25maWctPnRoc19wcmVwYXJlLAotCQkJICAg
ICBtaXBpX2NvbmZpZy0+dGNsa19wcmVwYXJlKTsKLQotCS8qCi0JICogcHJlcGFyZSBjbnQgaW4g
ZXNjYXBlIGNsb2NrcwotCSAqIHRoaXMgZmllbGQgcmVwcmVzZW50cyBhIGhleGFkZWNpbWFsIHZh
bHVlIHdpdGggYSBwcmVjaXNpb24KLQkgKiBvZiAxLjIg4oCTIGkuZS4gdGhlIG1vc3Qgc2lnbmlm
aWNhbnQgYml0IGlzIHRoZSBpbnRlZ2VyCi0JICogYW5kIHRoZSBsZWFzdCBzaWduaWZpY2FudCAy
IGJpdHMgYXJlIGZyYWN0aW9uIGJpdHMuCi0JICogc28sIHRoZSBmaWVsZCBjYW4gcmVwcmVzZW50
IGEgcmFuZ2Ugb2YgMC4yNSB0byAxLjc1Ci0JICovCi0JcHJlcGFyZV9jbnQgPSBESVZfUk9VTkRf
VVAodGhzX3ByZXBhcmVfbnMgKiA0LCB0bHB4X25zKTsKLQlpZiAocHJlcGFyZV9jbnQgPiBJQ0xf
UFJFUEFSRV9DTlRfTUFYKSB7Ci0JCURSTV9ERUJVR19LTVMoInByZXBhcmVfY250IG91dCBvZiBy
YW5nZSAoJWQpXG4iLCBwcmVwYXJlX2NudCk7Ci0JCXByZXBhcmVfY250ID0gSUNMX1BSRVBBUkVf
Q05UX01BWDsKLQl9Ci0KLQkvKiBjbGsgemVybyBjb3VudCBpbiBlc2NhcGUgY2xvY2tzICovCi0J
Y2xrX3plcm9fY250ID0gRElWX1JPVU5EX1VQKG1pcGlfY29uZmlnLT50Y2xrX3ByZXBhcmVfY2xr
emVybyAtCi0JCQkJICAgIHRoc19wcmVwYXJlX25zLCB0bHB4X25zKTsKLQlpZiAoY2xrX3plcm9f
Y250ID4gSUNMX0NMS19aRVJPX0NOVF9NQVgpIHsKLQkJRFJNX0RFQlVHX0tNUygiY2xrX3plcm9f
Y250IG91dCBvZiByYW5nZSAoJWQpXG4iLCBjbGtfemVyb19jbnQpOwotCQljbGtfemVyb19jbnQg
PSBJQ0xfQ0xLX1pFUk9fQ05UX01BWDsKLQl9Ci0KLQkvKiB0cmFpbCBjbnQgaW4gZXNjYXBlIGNs
b2NrcyovCi0JdHJhaWxfY250ID0gRElWX1JPVU5EX1VQKHRjbGtfdHJhaWxfbnMsIHRscHhfbnMp
OwotCWlmICh0cmFpbF9jbnQgPiBJQ0xfVFJBSUxfQ05UX01BWCkgewotCQlEUk1fREVCVUdfS01T
KCJ0cmFpbF9jbnQgb3V0IG9mIHJhbmdlICglZClcbiIsIHRyYWlsX2NudCk7Ci0JCXRyYWlsX2Nu
dCA9IElDTF9UUkFJTF9DTlRfTUFYOwotCX0KLQotCS8qIHRjbGsgcHJlIGNvdW50IGluIGVzY2Fw
ZSBjbG9ja3MgKi8KLQl0Y2xrX3ByZV9jbnQgPSBESVZfUk9VTkRfVVAobWlwaV9jb25maWctPnRj
bGtfcHJlLCB0bHB4X25zKTsKLQlpZiAodGNsa19wcmVfY250ID4gSUNMX1RDTEtfUFJFX0NOVF9N
QVgpIHsKLQkJRFJNX0RFQlVHX0tNUygidGNsa19wcmVfY250IG91dCBvZiByYW5nZSAoJWQpXG4i
LCB0Y2xrX3ByZV9jbnQpOwotCQl0Y2xrX3ByZV9jbnQgPSBJQ0xfVENMS19QUkVfQ05UX01BWDsK
LQl9Ci0KLQkvKiB0Y2xrIHBvc3QgY291bnQgaW4gZXNjYXBlIGNsb2NrcyAqLwotCXRjbGtfcG9z
dF9jbnQgPSBESVZfUk9VTkRfVVAobWlwaV9jb25maWctPnRjbGtfcG9zdCwgdGxweF9ucyk7Ci0J
aWYgKHRjbGtfcG9zdF9jbnQgPiBJQ0xfVENMS19QT1NUX0NOVF9NQVgpIHsKLQkJRFJNX0RFQlVH
X0tNUygidGNsa19wb3N0X2NudCBvdXQgb2YgcmFuZ2UgKCVkKVxuIiwgdGNsa19wb3N0X2NudCk7
Ci0JCXRjbGtfcG9zdF9jbnQgPSBJQ0xfVENMS19QT1NUX0NOVF9NQVg7Ci0JfQotCi0JLyogaHMg
emVybyBjbnQgaW4gZXNjYXBlIGNsb2NrcyAqLwotCWhzX3plcm9fY250ID0gRElWX1JPVU5EX1VQ
KG1pcGlfY29uZmlnLT50aHNfcHJlcGFyZV9oc3plcm8gLQotCQkJCSAgIHRoc19wcmVwYXJlX25z
LCB0bHB4X25zKTsKLQlpZiAoaHNfemVyb19jbnQgPiBJQ0xfSFNfWkVST19DTlRfTUFYKSB7Ci0J
CURSTV9ERUJVR19LTVMoImhzX3plcm9fY250IG91dCBvZiByYW5nZSAoJWQpXG4iLCBoc196ZXJv
X2NudCk7Ci0JCWhzX3plcm9fY250ID0gSUNMX0hTX1pFUk9fQ05UX01BWDsKLQl9Ci0KLQkvKiBo
cyBleGl0IHplcm8gY250IGluIGVzY2FwZSBjbG9ja3MgKi8KLQlleGl0X3plcm9fY250ID0gRElW
X1JPVU5EX1VQKG1pcGlfY29uZmlnLT50aHNfZXhpdCwgdGxweF9ucyk7Ci0JaWYgKGV4aXRfemVy
b19jbnQgPiBJQ0xfRVhJVF9aRVJPX0NOVF9NQVgpIHsKLQkJRFJNX0RFQlVHX0tNUygiZXhpdF96
ZXJvX2NudCBvdXQgb2YgcmFuZ2UgKCVkKVxuIiwgZXhpdF96ZXJvX2NudCk7Ci0JCWV4aXRfemVy
b19jbnQgPSBJQ0xfRVhJVF9aRVJPX0NOVF9NQVg7Ci0JfQotCi0JLyogY2xvY2sgbGFuZSBkcGh5
IHRpbWluZ3MgKi8KLQlpbnRlbF9kc2ktPmRwaHlfcmVnID0gKENMS19QUkVQQVJFX09WRVJSSURF
IHwKLQkJCSAgICAgICBDTEtfUFJFUEFSRShwcmVwYXJlX2NudCkgfAotCQkJICAgICAgIENMS19a
RVJPX09WRVJSSURFIHwKLQkJCSAgICAgICBDTEtfWkVSTyhjbGtfemVyb19jbnQpIHwKLQkJCSAg
ICAgICBDTEtfUFJFX09WRVJSSURFIHwKLQkJCSAgICAgICBDTEtfUFJFKHRjbGtfcHJlX2NudCkg
fAotCQkJICAgICAgIENMS19QT1NUX09WRVJSSURFIHwKLQkJCSAgICAgICBDTEtfUE9TVCh0Y2xr
X3Bvc3RfY250KSB8Ci0JCQkgICAgICAgQ0xLX1RSQUlMX09WRVJSSURFIHwKLQkJCSAgICAgICBD
TEtfVFJBSUwodHJhaWxfY250KSk7Ci0KLQkvKiBkYXRhIGxhbmVzIGRwaHkgdGltaW5ncyAqLwot
CWludGVsX2RzaS0+ZHBoeV9kYXRhX2xhbmVfcmVnID0gKEhTX1BSRVBBUkVfT1ZFUlJJREUgfAot
CQkJCQkgSFNfUFJFUEFSRShwcmVwYXJlX2NudCkgfAotCQkJCQkgSFNfWkVST19PVkVSUklERSB8
Ci0JCQkJCSBIU19aRVJPKGhzX3plcm9fY250KSB8Ci0JCQkJCSBIU19UUkFJTF9PVkVSUklERSB8
Ci0JCQkJCSBIU19UUkFJTCh0cmFpbF9jbnQpIHwKLQkJCQkJIEhTX0VYSVRfT1ZFUlJJREUgfAot
CQkJCQkgSFNfRVhJVChleGl0X3plcm9fY250KSk7Ci0KLQlpbnRlbF9kc2lfbG9nX3BhcmFtcyhp
bnRlbF9kc2kpOwotfQotCi1zdGF0aWMgdm9pZCB2bHZfZHBoeV9wYXJhbV9pbml0KHN0cnVjdCBp
bnRlbF9kc2kgKmludGVsX2RzaSkKLXsKLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gaW50ZWxf
ZHNpLT5iYXNlLmJhc2UuZGV2OwotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZGV2KTsKLQlzdHJ1Y3QgbWlwaV9jb25maWcgKm1pcGlfY29uZmlnID0gZGV2X3By
aXYtPnZidC5kc2kuY29uZmlnOwotCXUzMiB0bHB4X25zLCBleHRyYV9ieXRlX2NvdW50LCB0bHB4
X3VpOwotCXUzMiB1aV9udW0sIHVpX2RlbjsKLQl1MzIgcHJlcGFyZV9jbnQsIGV4aXRfemVyb19j
bnQsIGNsa196ZXJvX2NudCwgdHJhaWxfY250OwotCXUzMiB0aHNfcHJlcGFyZV9ucywgdGNsa190
cmFpbF9uczsKLQl1MzIgdGNsa19wcmVwYXJlX2Nsa3plcm8sIHRoc19wcmVwYXJlX2hzemVybzsK
LQl1MzIgbHBfdG9faHNfc3dpdGNoLCBoc190b19scF9zd2l0Y2g7Ci0JdTMyIG11bDsKLQotCXRs
cHhfbnMgPSBpbnRlbF9kc2lfdGxweF9ucyhpbnRlbF9kc2kpOwotCi0Jc3dpdGNoIChpbnRlbF9k
c2ktPmxhbmVfY291bnQpIHsKLQljYXNlIDE6Ci0JY2FzZSAyOgotCQlleHRyYV9ieXRlX2NvdW50
ID0gMjsKLQkJYnJlYWs7Ci0JY2FzZSAzOgotCQlleHRyYV9ieXRlX2NvdW50ID0gNDsKLQkJYnJl
YWs7Ci0JY2FzZSA0OgotCWRlZmF1bHQ6Ci0JCWV4dHJhX2J5dGVfY291bnQgPSAzOwotCQlicmVh
azsKLQl9Ci0KLQkvKiBpbiBLYnBzICovCi0JdWlfbnVtID0gTlNfS0haX1JBVElPOwotCXVpX2Rl
biA9IGludGVsX2RzaV9iaXRyYXRlKGludGVsX2RzaSk7Ci0KLQl0Y2xrX3ByZXBhcmVfY2xremVy
byA9IG1pcGlfY29uZmlnLT50Y2xrX3ByZXBhcmVfY2xremVybzsKLQl0aHNfcHJlcGFyZV9oc3pl
cm8gPSBtaXBpX2NvbmZpZy0+dGhzX3ByZXBhcmVfaHN6ZXJvOwotCi0JLyoKLQkgKiBCMDYwCi0J
ICogTFAgYnl0ZSBjbG9jayA9IFRMUFgvICg4VUkpCi0JICovCi0JaW50ZWxfZHNpLT5scF9ieXRl
X2NsayA9IERJVl9ST1VORF9VUCh0bHB4X25zICogdWlfZGVuLCA4ICogdWlfbnVtKTsKLQotCS8q
IEREUiBjbG9jayBwZXJpb2QgPSAyICogVUkKLQkgKiBVSShzZWMpID0gMS8oYml0cmF0ZSAqIDEw
XjMpIChiaXRyYXRlIGlzIGluIEtIWikKLQkgKiBVSShuc2VjKSA9IDEwXjYgLyBiaXRyYXRlCi0J
ICogRERSIGNsb2NrIHBlcmlvZCAobnNlYykgPSAyICogVUkgPSAoMiAqIDEwXjYpLyBiaXRyYXRl
Ci0JICogRERSIGNsb2NrIGNvdW50ICA9IG5zX3ZhbHVlIC8gRERSIGNsb2NrIHBlcmlvZAotCSAq
Ci0JICogRm9yIEdFTUlOSUxBS0UgZHBoeV9wYXJhbV9yZWcgd2lsbCBiZSBwcm9ncmFtbWVkIGlu
IHRlcm1zIG9mCi0JICogSFMgYnl0ZSBjbG9jayBjb3VudCBmb3Igb3RoZXIgcGxhdGZvcm0gaW4g
SFMgZGRyIGNsb2NrIGNvdW50Ci0JICovCi0JbXVsID0gSVNfR0VNSU5JTEFLRShkZXZfcHJpdikg
PyA4IDogMjsKLQl0aHNfcHJlcGFyZV9ucyA9IG1heChtaXBpX2NvbmZpZy0+dGhzX3ByZXBhcmUs
Ci0JCQkgICAgIG1pcGlfY29uZmlnLT50Y2xrX3ByZXBhcmUpOwotCi0JLyogcHJlcGFyZSBjb3Vu
dCAqLwotCXByZXBhcmVfY250ID0gRElWX1JPVU5EX1VQKHRoc19wcmVwYXJlX25zICogdWlfZGVu
LCB1aV9udW0gKiBtdWwpOwotCi0JaWYgKHByZXBhcmVfY250ID4gUFJFUEFSRV9DTlRfTUFYKSB7
Ci0JCURSTV9ERUJVR19LTVMoInByZXBhcmUgY291bnQgdG9vIGhpZ2ggJXVcbiIsIHByZXBhcmVf
Y250KTsKLQkJcHJlcGFyZV9jbnQgPSBQUkVQQVJFX0NOVF9NQVg7Ci0JfQotCi0JLyogZXhpdCB6
ZXJvIGNvdW50ICovCi0JZXhpdF96ZXJvX2NudCA9IERJVl9ST1VORF9VUCgKLQkJCQkodGhzX3By
ZXBhcmVfaHN6ZXJvIC0gdGhzX3ByZXBhcmVfbnMpICogdWlfZGVuLAotCQkJCXVpX251bSAqIG11
bAotCQkJCSk7Ci0KLQkvKgotCSAqIEV4aXQgemVybyBpcyB1bmlmaWVkIHZhbCB0aHNfemVybyBh
bmQgdGhzX2V4aXQKLQkgKiBtaW5pbXVtIHZhbHVlIGZvciB0aHNfZXhpdCA9IDExMG5zCi0JICog
bWluIChleGl0X3plcm9fY250ICogMikgPSAxMTAvVUkKLQkgKiBleGl0X3plcm9fY250ID0gNTUv
VUkKLQkgKi8KLQlpZiAoZXhpdF96ZXJvX2NudCA8ICg1NSAqIHVpX2RlbiAvIHVpX251bSkgJiYg
KDU1ICogdWlfZGVuKSAlIHVpX251bSkKLQkJZXhpdF96ZXJvX2NudCArPSAxOwotCi0JaWYgKGV4
aXRfemVyb19jbnQgPiBFWElUX1pFUk9fQ05UX01BWCkgewotCQlEUk1fREVCVUdfS01TKCJleGl0
IHplcm8gY291bnQgdG9vIGhpZ2ggJXVcbiIsIGV4aXRfemVyb19jbnQpOwotCQlleGl0X3plcm9f
Y250ID0gRVhJVF9aRVJPX0NOVF9NQVg7Ci0JfQotCi0JLyogY2xrIHplcm8gY291bnQgKi8KLQlj
bGtfemVyb19jbnQgPSBESVZfUk9VTkRfVVAoCi0JCQkJKHRjbGtfcHJlcGFyZV9jbGt6ZXJvIC0J
dGhzX3ByZXBhcmVfbnMpCi0JCQkJKiB1aV9kZW4sIHVpX251bSAqIG11bCk7Ci0KLQlpZiAoY2xr
X3plcm9fY250ID4gQ0xLX1pFUk9fQ05UX01BWCkgewotCQlEUk1fREVCVUdfS01TKCJjbG9jayB6
ZXJvIGNvdW50IHRvbyBoaWdoICV1XG4iLCBjbGtfemVyb19jbnQpOwotCQljbGtfemVyb19jbnQg
PSBDTEtfWkVST19DTlRfTUFYOwotCX0KLQotCS8qIHRyYWlsIGNvdW50ICovCi0JdGNsa190cmFp
bF9ucyA9IG1heChtaXBpX2NvbmZpZy0+dGNsa190cmFpbCwgbWlwaV9jb25maWctPnRoc190cmFp
bCk7Ci0JdHJhaWxfY250ID0gRElWX1JPVU5EX1VQKHRjbGtfdHJhaWxfbnMgKiB1aV9kZW4sIHVp
X251bSAqIG11bCk7Ci0KLQlpZiAodHJhaWxfY250ID4gVFJBSUxfQ05UX01BWCkgewotCQlEUk1f
REVCVUdfS01TKCJ0cmFpbCBjb3VudCB0b28gaGlnaCAldVxuIiwgdHJhaWxfY250KTsKLQkJdHJh
aWxfY250ID0gVFJBSUxfQ05UX01BWDsKLQl9Ci0KLQkvKiBCMDgwICovCi0JaW50ZWxfZHNpLT5k
cGh5X3JlZyA9IGV4aXRfemVyb19jbnQgPDwgMjQgfCB0cmFpbF9jbnQgPDwgMTYgfAotCQkJCQkJ
Y2xrX3plcm9fY250IDw8IDggfCBwcmVwYXJlX2NudDsKLQotCS8qCi0JICogTFAgdG8gSFMgc3dp
dGNoIGNvdW50ID0gNFRMUFggKyBQUkVQX0NPVU5UICogbXVsICsgRVhJVF9aRVJPX0NPVU5UICoK
LQkgKgkJCQkJbXVsICsgMTBVSSArIEV4dHJhIEJ5dGUgQ291bnQKLQkgKgotCSAqIEhTIHRvIExQ
IHN3aXRjaCBjb3VudCA9IFRIUy1UUkFJTCArIDJUTFBYICsgRXh0cmEgQnl0ZSBDb3VudAotCSAq
IEV4dHJhIEJ5dGUgQ291bnQgaXMgY2FsY3VsYXRlZCBhY2NvcmRpbmcgdG8gbnVtYmVyIG9mIGxh
bmVzLgotCSAqIEhpZ2ggTG93IFN3aXRjaCBDb3VudCBpcyB0aGUgTWF4IG9mIExQIHRvIEhTIGFu
ZAotCSAqIEhTIHRvIExQIHN3aXRjaCBjb3VudAotCSAqCi0JICovCi0JdGxweF91aSA9IERJVl9S
T1VORF9VUCh0bHB4X25zICogdWlfZGVuLCB1aV9udW0pOwotCi0JLyogQjA0NCAqLwotCS8qIEZJ
WE1FOgotCSAqIFRoZSBjb21tZW50IGFib3ZlIGRvZXMgbm90IG1hdGNoIHdpdGggdGhlIGNvZGUg
Ki8KLQlscF90b19oc19zd2l0Y2ggPSBESVZfUk9VTkRfVVAoNCAqIHRscHhfdWkgKyBwcmVwYXJl
X2NudCAqIG11bCArCi0JCQkJCQlleGl0X3plcm9fY250ICogbXVsICsgMTAsIDgpOwotCi0JaHNf
dG9fbHBfc3dpdGNoID0gRElWX1JPVU5EX1VQKG1pcGlfY29uZmlnLT50aHNfdHJhaWwgKyAyICog
dGxweF91aSwgOCk7Ci0KLQlpbnRlbF9kc2ktPmhzX3RvX2xwX2NvdW50ID0gbWF4KGxwX3RvX2hz
X3N3aXRjaCwgaHNfdG9fbHBfc3dpdGNoKTsKLQlpbnRlbF9kc2ktPmhzX3RvX2xwX2NvdW50ICs9
IGV4dHJhX2J5dGVfY291bnQ7Ci0KLQkvKiBCMDg4ICovCi0JLyogTFAgLT4gSFMgZm9yIGNsb2Nr
IGxhbmVzCi0JICogTFAgY2xrIHN5bmMgKyBMUDExICsgTFAwMSArIHRjbGtfcHJlcGFyZSArIHRj
bGtfemVybyArCi0JICoJCQkJCQlleHRyYSBieXRlIGNvdW50Ci0JICogMlRQTFggKyAxVExQWCAr
IDEgVFBMWChpbiBucykgKyBwcmVwYXJlX2NudCAqIDIgKyBjbGtfemVyb19jbnQgKgotCSAqCQkJ
CQkyKGluIFVJKSArIGV4dHJhIGJ5dGUgY291bnQKLQkgKiBJbiBieXRlY2xrcyA9ICg0VExQWCAr
IHByZXBhcmVfY250ICogMiArIGNsa196ZXJvX2NudCAqMiAoaW4gVUkpKSAvCi0JICoJCQkJCTgg
KyBleHRyYSBieXRlIGNvdW50Ci0JICovCi0JaW50ZWxfZHNpLT5jbGtfbHBfdG9faHNfY291bnQg
PQotCQlESVZfUk9VTkRfVVAoCi0JCQk0ICogdGxweF91aSArIHByZXBhcmVfY250ICogMiArCi0J
CQljbGtfemVyb19jbnQgKiAyLAotCQkJOCk7Ci0KLQlpbnRlbF9kc2ktPmNsa19scF90b19oc19j
b3VudCArPSBleHRyYV9ieXRlX2NvdW50OwotCi0JLyogSFMtPkxQIGZvciBDbG9jayBMYW5lcwot
CSAqIExvdyBQb3dlciBjbG9jayBzeW5jaHJvbmlzYXRpb25zICsgMVR4IGJ5dGVjbGsgKyB0Y2xr
X3RyYWlsICsKLQkgKgkJCQkJCUV4dHJhIGJ5dGUgY291bnQKLQkgKiAyVExQWCArIDhVSSArICh0
cmFpbF9jb3VudCoyKShpbiBVSSkgKyBFeHRyYSBieXRlIGNvdW50Ci0JICogSW4gYnl0ZWNsa3Mg
PSAoMipUTHB4KGluIFVJKSArIHRyYWlsX2NvdW50KjIgKzgpKGluIFVJKS84ICsKLQkgKgkJCQkJ
CUV4dHJhIGJ5dGUgY291bnQKLQkgKi8KLQlpbnRlbF9kc2ktPmNsa19oc190b19scF9jb3VudCA9
Ci0JCURJVl9ST1VORF9VUCgyICogdGxweF91aSArIHRyYWlsX2NudCAqIDIgKyA4LAotCQkJOCk7
Ci0JaW50ZWxfZHNpLT5jbGtfaHNfdG9fbHBfY291bnQgKz0gZXh0cmFfYnl0ZV9jb3VudDsKLQot
CWludGVsX2RzaV9sb2dfcGFyYW1zKGludGVsX2RzaSk7Ci19Ci0KIGJvb2wgaW50ZWxfZHNpX3Zi
dF9pbml0KHN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSwgdTE2IHBhbmVsX2lkKQogewogCXN0
cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBpbnRlbF9kc2ktPmJhc2UuYmFzZS5kZXY7CkBAIC05MjUs
MTEgKzY1MCw2IEBAIGJvb2wgaW50ZWxfZHNpX3ZidF9pbml0KHN0cnVjdCBpbnRlbF9kc2kgKmlu
dGVsX2RzaSwgdTE2IHBhbmVsX2lkKQogCiAJaW50ZWxfZHNpLT5idXJzdF9tb2RlX3JhdGlvID0g
YnVyc3RfbW9kZV9yYXRpbzsKIAotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQotCQlp
Y2xfZHBoeV9wYXJhbV9pbml0KGludGVsX2RzaSk7Ci0JZWxzZQotCQl2bHZfZHBoeV9wYXJhbV9p
bml0KGludGVsX2RzaSk7Ci0KIAkvKiBkZWxheXMgaW4gVkJUIGFyZSBpbiB1bml0IG9mIDEwMHVz
LCBzbyBuZWVkIHRvIGNvbnZlcnQKIAkgKiBoZXJlIGluIG1zCiAJICogRGVsYXkgKDEwMHVzKSAq
IDEwMCAvMTAwMCA9IERlbGF5IC8gMTAgKG1zKSAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvdmx2X2RzaS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvdmx2X2RzaS5jCmluZGV4
IDI1NTk5NmE3MWI5MS4uNTk1MDBjODM4YjlkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS92bHZfZHNpLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvdmx2X2RzaS5jCkBAIC0x
Njg5LDYgKzE2ODksMTc0IEBAIHN0YXRpYyB2b2lkIGludGVsX2RzaV9hZGRfcHJvcGVydGllcyhz
dHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCiAJfQogfQogCisjZGVmaW5lIE5TX0tI
Wl9SQVRJTwkJMTAwMDAwMAorCisjZGVmaW5lIFBSRVBBUkVfQ05UX01BWAkJMHgzRgorI2RlZmlu
ZSBFWElUX1pFUk9fQ05UX01BWAkweDNGCisjZGVmaW5lIENMS19aRVJPX0NOVF9NQVgJMHhGRgor
I2RlZmluZSBUUkFJTF9DTlRfTUFYCQkweDFGCisKK3N0YXRpYyB2b2lkIHZsdl9kcGh5X3BhcmFt
X2luaXQoc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpKQoreworCXN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYgPSBpbnRlbF9kc2ktPmJhc2UuYmFzZS5kZXY7CisJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOworCXN0cnVjdCBtaXBpX2NvbmZpZyAqbWlwaV9j
b25maWcgPSBkZXZfcHJpdi0+dmJ0LmRzaS5jb25maWc7CisJdTMyIHRscHhfbnMsIGV4dHJhX2J5
dGVfY291bnQsIHRscHhfdWk7CisJdTMyIHVpX251bSwgdWlfZGVuOworCXUzMiBwcmVwYXJlX2Nu
dCwgZXhpdF96ZXJvX2NudCwgY2xrX3plcm9fY250LCB0cmFpbF9jbnQ7CisJdTMyIHRoc19wcmVw
YXJlX25zLCB0Y2xrX3RyYWlsX25zOworCXUzMiB0Y2xrX3ByZXBhcmVfY2xremVybywgdGhzX3By
ZXBhcmVfaHN6ZXJvOworCXUzMiBscF90b19oc19zd2l0Y2gsIGhzX3RvX2xwX3N3aXRjaDsKKwl1
MzIgbXVsOworCisJdGxweF9ucyA9IGludGVsX2RzaV90bHB4X25zKGludGVsX2RzaSk7CisKKwlz
d2l0Y2ggKGludGVsX2RzaS0+bGFuZV9jb3VudCkgeworCWNhc2UgMToKKwljYXNlIDI6CisJCWV4
dHJhX2J5dGVfY291bnQgPSAyOworCQlicmVhazsKKwljYXNlIDM6CisJCWV4dHJhX2J5dGVfY291
bnQgPSA0OworCQlicmVhazsKKwljYXNlIDQ6CisJZGVmYXVsdDoKKwkJZXh0cmFfYnl0ZV9jb3Vu
dCA9IDM7CisJCWJyZWFrOworCX0KKworCS8qIGluIEticHMgKi8KKwl1aV9udW0gPSBOU19LSFpf
UkFUSU87CisJdWlfZGVuID0gaW50ZWxfZHNpX2JpdHJhdGUoaW50ZWxfZHNpKTsKKworCXRjbGtf
cHJlcGFyZV9jbGt6ZXJvID0gbWlwaV9jb25maWctPnRjbGtfcHJlcGFyZV9jbGt6ZXJvOworCXRo
c19wcmVwYXJlX2hzemVybyA9IG1pcGlfY29uZmlnLT50aHNfcHJlcGFyZV9oc3plcm87CisKKwkv
KgorCSAqIEIwNjAKKwkgKiBMUCBieXRlIGNsb2NrID0gVExQWC8gKDhVSSkKKwkgKi8KKwlpbnRl
bF9kc2ktPmxwX2J5dGVfY2xrID0gRElWX1JPVU5EX1VQKHRscHhfbnMgKiB1aV9kZW4sIDggKiB1
aV9udW0pOworCisJLyogRERSIGNsb2NrIHBlcmlvZCA9IDIgKiBVSQorCSAqIFVJKHNlYykgPSAx
LyhiaXRyYXRlICogMTBeMykgKGJpdHJhdGUgaXMgaW4gS0haKQorCSAqIFVJKG5zZWMpID0gMTBe
NiAvIGJpdHJhdGUKKwkgKiBERFIgY2xvY2sgcGVyaW9kIChuc2VjKSA9IDIgKiBVSSA9ICgyICog
MTBeNikvIGJpdHJhdGUKKwkgKiBERFIgY2xvY2sgY291bnQgID0gbnNfdmFsdWUgLyBERFIgY2xv
Y2sgcGVyaW9kCisJICoKKwkgKiBGb3IgR0VNSU5JTEFLRSBkcGh5X3BhcmFtX3JlZyB3aWxsIGJl
IHByb2dyYW1tZWQgaW4gdGVybXMgb2YKKwkgKiBIUyBieXRlIGNsb2NrIGNvdW50IGZvciBvdGhl
ciBwbGF0Zm9ybSBpbiBIUyBkZHIgY2xvY2sgY291bnQKKwkgKi8KKwltdWwgPSBJU19HRU1JTklM
QUtFKGRldl9wcml2KSA/IDggOiAyOworCXRoc19wcmVwYXJlX25zID0gbWF4KG1pcGlfY29uZmln
LT50aHNfcHJlcGFyZSwKKwkJCSAgICAgbWlwaV9jb25maWctPnRjbGtfcHJlcGFyZSk7CisKKwkv
KiBwcmVwYXJlIGNvdW50ICovCisJcHJlcGFyZV9jbnQgPSBESVZfUk9VTkRfVVAodGhzX3ByZXBh
cmVfbnMgKiB1aV9kZW4sIHVpX251bSAqIG11bCk7CisKKwlpZiAocHJlcGFyZV9jbnQgPiBQUkVQ
QVJFX0NOVF9NQVgpIHsKKwkJRFJNX0RFQlVHX0tNUygicHJlcGFyZSBjb3VudCB0b28gaGlnaCAl
dVxuIiwgcHJlcGFyZV9jbnQpOworCQlwcmVwYXJlX2NudCA9IFBSRVBBUkVfQ05UX01BWDsKKwl9
CisKKwkvKiBleGl0IHplcm8gY291bnQgKi8KKwlleGl0X3plcm9fY250ID0gRElWX1JPVU5EX1VQ
KAorCQkJCSh0aHNfcHJlcGFyZV9oc3plcm8gLSB0aHNfcHJlcGFyZV9ucykgKiB1aV9kZW4sCisJ
CQkJdWlfbnVtICogbXVsCisJCQkJKTsKKworCS8qCisJICogRXhpdCB6ZXJvIGlzIHVuaWZpZWQg
dmFsIHRoc196ZXJvIGFuZCB0aHNfZXhpdAorCSAqIG1pbmltdW0gdmFsdWUgZm9yIHRoc19leGl0
ID0gMTEwbnMKKwkgKiBtaW4gKGV4aXRfemVyb19jbnQgKiAyKSA9IDExMC9VSQorCSAqIGV4aXRf
emVyb19jbnQgPSA1NS9VSQorCSAqLworCWlmIChleGl0X3plcm9fY250IDwgKDU1ICogdWlfZGVu
IC8gdWlfbnVtKSAmJiAoNTUgKiB1aV9kZW4pICUgdWlfbnVtKQorCQlleGl0X3plcm9fY250ICs9
IDE7CisKKwlpZiAoZXhpdF96ZXJvX2NudCA+IEVYSVRfWkVST19DTlRfTUFYKSB7CisJCURSTV9E
RUJVR19LTVMoImV4aXQgemVybyBjb3VudCB0b28gaGlnaCAldVxuIiwgZXhpdF96ZXJvX2NudCk7
CisJCWV4aXRfemVyb19jbnQgPSBFWElUX1pFUk9fQ05UX01BWDsKKwl9CisKKwkvKiBjbGsgemVy
byBjb3VudCAqLworCWNsa196ZXJvX2NudCA9IERJVl9ST1VORF9VUCgKKwkJCQkodGNsa19wcmVw
YXJlX2Nsa3plcm8gLQl0aHNfcHJlcGFyZV9ucykKKwkJCQkqIHVpX2RlbiwgdWlfbnVtICogbXVs
KTsKKworCWlmIChjbGtfemVyb19jbnQgPiBDTEtfWkVST19DTlRfTUFYKSB7CisJCURSTV9ERUJV
R19LTVMoImNsb2NrIHplcm8gY291bnQgdG9vIGhpZ2ggJXVcbiIsIGNsa196ZXJvX2NudCk7CisJ
CWNsa196ZXJvX2NudCA9IENMS19aRVJPX0NOVF9NQVg7CisJfQorCisJLyogdHJhaWwgY291bnQg
Ki8KKwl0Y2xrX3RyYWlsX25zID0gbWF4KG1pcGlfY29uZmlnLT50Y2xrX3RyYWlsLCBtaXBpX2Nv
bmZpZy0+dGhzX3RyYWlsKTsKKwl0cmFpbF9jbnQgPSBESVZfUk9VTkRfVVAodGNsa190cmFpbF9u
cyAqIHVpX2RlbiwgdWlfbnVtICogbXVsKTsKKworCWlmICh0cmFpbF9jbnQgPiBUUkFJTF9DTlRf
TUFYKSB7CisJCURSTV9ERUJVR19LTVMoInRyYWlsIGNvdW50IHRvbyBoaWdoICV1XG4iLCB0cmFp
bF9jbnQpOworCQl0cmFpbF9jbnQgPSBUUkFJTF9DTlRfTUFYOworCX0KKworCS8qIEIwODAgKi8K
KwlpbnRlbF9kc2ktPmRwaHlfcmVnID0gZXhpdF96ZXJvX2NudCA8PCAyNCB8IHRyYWlsX2NudCA8
PCAxNiB8CisJCQkJCQljbGtfemVyb19jbnQgPDwgOCB8IHByZXBhcmVfY250OworCisJLyoKKwkg
KiBMUCB0byBIUyBzd2l0Y2ggY291bnQgPSA0VExQWCArIFBSRVBfQ09VTlQgKiBtdWwgKyBFWElU
X1pFUk9fQ09VTlQgKgorCSAqCQkJCQltdWwgKyAxMFVJICsgRXh0cmEgQnl0ZSBDb3VudAorCSAq
CisJICogSFMgdG8gTFAgc3dpdGNoIGNvdW50ID0gVEhTLVRSQUlMICsgMlRMUFggKyBFeHRyYSBC
eXRlIENvdW50CisJICogRXh0cmEgQnl0ZSBDb3VudCBpcyBjYWxjdWxhdGVkIGFjY29yZGluZyB0
byBudW1iZXIgb2YgbGFuZXMuCisJICogSGlnaCBMb3cgU3dpdGNoIENvdW50IGlzIHRoZSBNYXgg
b2YgTFAgdG8gSFMgYW5kCisJICogSFMgdG8gTFAgc3dpdGNoIGNvdW50CisJICoKKwkgKi8KKwl0
bHB4X3VpID0gRElWX1JPVU5EX1VQKHRscHhfbnMgKiB1aV9kZW4sIHVpX251bSk7CisKKwkvKiBC
MDQ0ICovCisJLyogRklYTUU6CisJICogVGhlIGNvbW1lbnQgYWJvdmUgZG9lcyBub3QgbWF0Y2gg
d2l0aCB0aGUgY29kZSAqLworCWxwX3RvX2hzX3N3aXRjaCA9IERJVl9ST1VORF9VUCg0ICogdGxw
eF91aSArIHByZXBhcmVfY250ICogbXVsICsKKwkJCQkJCWV4aXRfemVyb19jbnQgKiBtdWwgKyAx
MCwgOCk7CisKKwloc190b19scF9zd2l0Y2ggPSBESVZfUk9VTkRfVVAobWlwaV9jb25maWctPnRo
c190cmFpbCArIDIgKiB0bHB4X3VpLCA4KTsKKworCWludGVsX2RzaS0+aHNfdG9fbHBfY291bnQg
PSBtYXgobHBfdG9faHNfc3dpdGNoLCBoc190b19scF9zd2l0Y2gpOworCWludGVsX2RzaS0+aHNf
dG9fbHBfY291bnQgKz0gZXh0cmFfYnl0ZV9jb3VudDsKKworCS8qIEIwODggKi8KKwkvKiBMUCAt
PiBIUyBmb3IgY2xvY2sgbGFuZXMKKwkgKiBMUCBjbGsgc3luYyArIExQMTEgKyBMUDAxICsgdGNs
a19wcmVwYXJlICsgdGNsa196ZXJvICsKKwkgKgkJCQkJCWV4dHJhIGJ5dGUgY291bnQKKwkgKiAy
VFBMWCArIDFUTFBYICsgMSBUUExYKGluIG5zKSArIHByZXBhcmVfY250ICogMiArIGNsa196ZXJv
X2NudCAqCisJICoJCQkJCTIoaW4gVUkpICsgZXh0cmEgYnl0ZSBjb3VudAorCSAqIEluIGJ5dGVj
bGtzID0gKDRUTFBYICsgcHJlcGFyZV9jbnQgKiAyICsgY2xrX3plcm9fY250ICoyIChpbiBVSSkp
IC8KKwkgKgkJCQkJOCArIGV4dHJhIGJ5dGUgY291bnQKKwkgKi8KKwlpbnRlbF9kc2ktPmNsa19s
cF90b19oc19jb3VudCA9CisJCURJVl9ST1VORF9VUCgKKwkJCTQgKiB0bHB4X3VpICsgcHJlcGFy
ZV9jbnQgKiAyICsKKwkJCWNsa196ZXJvX2NudCAqIDIsCisJCQk4KTsKKworCWludGVsX2RzaS0+
Y2xrX2xwX3RvX2hzX2NvdW50ICs9IGV4dHJhX2J5dGVfY291bnQ7CisKKwkvKiBIUy0+TFAgZm9y
IENsb2NrIExhbmVzCisJICogTG93IFBvd2VyIGNsb2NrIHN5bmNocm9uaXNhdGlvbnMgKyAxVHgg
Ynl0ZWNsayArIHRjbGtfdHJhaWwgKworCSAqCQkJCQkJRXh0cmEgYnl0ZSBjb3VudAorCSAqIDJU
TFBYICsgOFVJICsgKHRyYWlsX2NvdW50KjIpKGluIFVJKSArIEV4dHJhIGJ5dGUgY291bnQKKwkg
KiBJbiBieXRlY2xrcyA9ICgyKlRMcHgoaW4gVUkpICsgdHJhaWxfY291bnQqMiArOCkoaW4gVUkp
LzggKworCSAqCQkJCQkJRXh0cmEgYnl0ZSBjb3VudAorCSAqLworCWludGVsX2RzaS0+Y2xrX2hz
X3RvX2xwX2NvdW50ID0KKwkJRElWX1JPVU5EX1VQKDIgKiB0bHB4X3VpICsgdHJhaWxfY250ICog
MiArIDgsCisJCQk4KTsKKwlpbnRlbF9kc2ktPmNsa19oc190b19scF9jb3VudCArPSBleHRyYV9i
eXRlX2NvdW50OworCisJaW50ZWxfZHNpX2xvZ19wYXJhbXMoaW50ZWxfZHNpKTsKK30KKwogdm9p
ZCB2bHZfZHNpX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewogCXN0
cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKQEAgLTE3NzgsNiArMTk0Niw4
IEBAIHZvaWQgdmx2X2RzaV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
IAkJZ290byBlcnI7CiAJfQogCisJdmx2X2RwaHlfcGFyYW1faW5pdChpbnRlbF9kc2kpOworCiAJ
LyoKIAkgKiBJbiBjYXNlIG9mIEJZVCB3aXRoIENSQyBQTUlDLCB3ZSBuZWVkIHRvIHVzZSBHUElP
IGZvcgogCSAqIFBhbmVsIGNvbnRyb2wuCi0tIAoyLjIxLjAKCl9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRl
dmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9t
YWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
