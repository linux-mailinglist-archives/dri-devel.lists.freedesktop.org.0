Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 78936D8D68
	for <lists+dri-devel@lfdr.de>; Wed, 16 Oct 2019 12:11:52 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A4DCC6E920;
	Wed, 16 Oct 2019 10:11:38 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from relay10.mail.gandi.net (relay10.mail.gandi.net [217.70.178.230])
 by gabe.freedesktop.org (Postfix) with ESMTPS id CA37D6E906
 for <dri-devel@lists.freedesktop.org>; Wed, 16 Oct 2019 08:55:04 +0000 (UTC)
Received: from uno.localdomain (2-224-242-101.ip172.fastwebnet.it
 [2.224.242.101]) (Authenticated sender: jacopo@jmondi.org)
 by relay10.mail.gandi.net (Postfix) with ESMTPSA id 28C1624000A;
 Wed, 16 Oct 2019 08:54:59 +0000 (UTC)
From: Jacopo Mondi <jacopo+renesas@jmondi.org>
To: laurent.pinchart@ideasonboard.com, kieran.bingham+renesas@ideasonboard.com,
 geert@linux-m68k.org, horms@verge.net.au, uli+renesas@fpond.eu
Subject: [PATCH v6 3/8] drm: rcar-du: Add support for CMM
Date: Wed, 16 Oct 2019 10:55:43 +0200
Message-Id: <20191016085548.105703-4-jacopo+renesas@jmondi.org>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191016085548.105703-1-jacopo+renesas@jmondi.org>
References: <20191016085548.105703-1-jacopo+renesas@jmondi.org>
MIME-Version: 1.0
X-Mailman-Approved-At: Wed, 16 Oct 2019 10:11:37 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: airlied@linux.ie, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, linux-renesas-soc@vger.kernel.org,
 Jacopo Mondi <jacopo+renesas@jmondi.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIGEgZHJpdmVyIGZvciB0aGUgUi1DYXIgRGlzcGxheSBVbml0IENvbG9yIENvcnJlY3Rpb24g
TW9kdWxlLgoKSW4gbW9zdCBvZiBHZW4zIFNvQ3MsIGVhY2ggRFUgb3V0cHV0IGNoYW5uZWwgaXMg
cHJvdmlkZWQgd2l0aCBhIENNTSB1bml0CnRvIHBlcmZvcm0gaW1hZ2UgZW5oYW5jZW1lbnQgYW5k
IGNvbG9yIGNvcnJlY3Rpb24uCgpBZGQgc3VwcG9ydCBmb3IgQ01NIHRocm91Z2ggYSBkcml2ZXIg
dGhhdCBzdXBwb3J0cyBjb25maWd1cmF0aW9uIG9mCnRoZSAxLWRpbWVuc2lvbmFsIExVVCB0YWJs
ZS4gTW9yZSBhZHZhbmNlZCBDTU0gZmVhdHVyZXMgd2lsbCBiZQppbXBsZW1lbnRlZCBvbiB0b3Ag
b2YgdGhpcyBpbml0aWFsIG9uZS4KClJldmlld2VkLWJ5OiBMYXVyZW50IFBpbmNoYXJ0IDxsYXVy
ZW50LnBpbmNoYXJ0QGlkZWFzb25ib2FyZC5jb20+ClJldmlld2VkLWJ5OiBLaWVyYW4gQmluZ2hh
bSA8a2llcmFuLmJpbmdoYW0rcmVuZXNhc0BpZGVhc29uYm9hcmQuY29tPgpTaWduZWQtb2ZmLWJ5
OiBKYWNvcG8gTW9uZGkgPGphY29wbytyZW5lc2FzQGptb25kaS5vcmc+Ci0tLQogZHJpdmVycy9n
cHUvZHJtL3JjYXItZHUvS2NvbmZpZyAgICB8ICAgNyArCiBkcml2ZXJzL2dwdS9kcm0vcmNhci1k
dS9NYWtlZmlsZSAgIHwgICAxICsKIGRyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfY21tLmMg
fCAyMTIgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9yY2Fy
LWR1L3JjYXJfY21tLmggfCAgNTggKysrKysrKysKIDQgZmlsZXMgY2hhbmdlZCwgMjc4IGluc2Vy
dGlvbnMoKykKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2Fy
X2NtbS5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9j
bW0uaAoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L0tjb25maWcgYi9kcml2
ZXJzL2dwdS9kcm0vcmNhci1kdS9LY29uZmlnCmluZGV4IDE1Mjk4NDllMjE3ZS4uNTM5ZDIzMjc5
MGQxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9LY29uZmlnCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9yY2FyLWR1L0tjb25maWcKQEAgLTEzLDYgKzEzLDEzIEBAIGNvbmZpZyBE
Uk1fUkNBUl9EVQogCSAgQ2hvb3NlIHRoaXMgb3B0aW9uIGlmIHlvdSBoYXZlIGFuIFItQ2FyIGNo
aXBzZXQuCiAJICBJZiBNIGlzIHNlbGVjdGVkIHRoZSBtb2R1bGUgd2lsbCBiZSBjYWxsZWQgcmNh
ci1kdS1kcm0uCiAKK2NvbmZpZyBEUk1fUkNBUl9DTU0KKwlib29sICJSLUNhciBEVSBDb2xvciBN
YW5hZ2VtZW50IE1vZHVsZSAoQ01NKSBTdXBwb3J0IgorCWRlcGVuZHMgb24gRFJNICYmIE9GCisJ
ZGVwZW5kcyBvbiBEUk1fUkNBUl9EVQorCWhlbHAKKwkgIEVuYWJsZSBzdXBwb3J0IGZvciBSLUNh
ciBDb2xvciBNYW5hZ2VtZW50IE1vZHVsZSAoQ01NKS4KKwogY29uZmlnIERSTV9SQ0FSX0RXX0hE
TUkKIAl0cmlzdGF0ZSAiUi1DYXIgRFUgR2VuMyBIRE1JIEVuY29kZXIgU3VwcG9ydCIKIAlkZXBl
bmRzIG9uIERSTSAmJiBPRgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvTWFr
ZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9NYWtlZmlsZQppbmRleCA2YzJlZDljNDY0
NjcuLjRkMTE4N2NjYzNlNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvTWFr
ZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvTWFrZWZpbGUKQEAgLTE1LDYgKzE1
LDcgQEAgcmNhci1kdS1kcm0tJChDT05GSUdfRFJNX1JDQVJfTFZEUykJKz0gcmNhcl9kdV9vZi5v
IFwKIHJjYXItZHUtZHJtLSQoQ09ORklHX0RSTV9SQ0FSX1ZTUCkJKz0gcmNhcl9kdV92c3Aubwog
cmNhci1kdS1kcm0tJChDT05GSUdfRFJNX1JDQVJfV1JJVEVCQUNLKSArPSByY2FyX2R1X3dyaXRl
YmFjay5vCiAKK29iai0kKENPTkZJR19EUk1fUkNBUl9DTU0pCQkrPSByY2FyX2NtbS5vCiBvYmot
JChDT05GSUdfRFJNX1JDQVJfRFUpCQkrPSByY2FyLWR1LWRybS5vCiBvYmotJChDT05GSUdfRFJN
X1JDQVJfRFdfSERNSSkJCSs9IHJjYXJfZHdfaGRtaS5vCiBvYmotJChDT05GSUdfRFJNX1JDQVJf
TFZEUykJCSs9IHJjYXJfbHZkcy5vCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcmNhci1k
dS9yY2FyX2NtbS5jIGIvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9jbW0uYwpuZXcgZmls
ZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjQxNzA2MjYyMDhjZgotLS0gL2Rldi9u
dWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfY21tLmMKQEAgLTAsMCArMSwy
MTIgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wKworLyoKKyAqIHJjYXJf
Y21tLmMgLS0gUi1DYXIgRGlzcGxheSBVbml0IENvbG9yIE1hbmFnZW1lbnQgTW9kdWxlCisgKgor
ICogQ29weXJpZ2h0IChDKSAyMDE5IEphY29wbyBNb25kaSA8amFjb3BvK3JlbmVzYXNAam1vbmRp
Lm9yZz4KKyAqLworCisjaW5jbHVkZSA8bGludXgvaW8uaD4KKyNpbmNsdWRlIDxsaW51eC9tb2R1
bGUuaD4KKyNpbmNsdWRlIDxsaW51eC9vZi5oPgorI2luY2x1ZGUgPGxpbnV4L3BsYXRmb3JtX2Rl
dmljZS5oPgorI2luY2x1ZGUgPGxpbnV4L3BtX3J1bnRpbWUuaD4KKworI2luY2x1ZGUgPGRybS9k
cm1fY29sb3JfbWdtdC5oPgorCisjaW5jbHVkZSAicmNhcl9jbW0uaCIKKworI2RlZmluZSBDTTJf
TFVUX0NUUkwJCTB4MDAwMAorI2RlZmluZSBDTTJfTFVUX0NUUkxfTFVUX0VOCUJJVCgwKQorI2Rl
ZmluZSBDTTJfTFVUX1RCTF9CQVNFCTB4MDYwMAorI2RlZmluZSBDTTJfTFVUX1RCTChfX2kpCShD
TTJfTFVUX1RCTF9CQVNFICsgKF9faSkgKiA0KQorCitzdHJ1Y3QgcmNhcl9jbW0geworCXZvaWQg
X19pb21lbSAqYmFzZTsKKworCS8qCisJICogQGx1dDoJCTFELUxVVCBzdGF0ZQorCSAqIEBsdXQu
ZW5hYmxlZDoJMUQtTFVUIGVuYWJsZWQgZmxhZworCSAqLworCXN0cnVjdCB7CisJCWJvb2wgZW5h
YmxlZDsKKwl9IGx1dDsKK307CisKK3N0YXRpYyBpbmxpbmUgaW50IHJjYXJfY21tX3JlYWQoc3Ry
dWN0IHJjYXJfY21tICpyY21tLCB1MzIgcmVnKQoreworCXJldHVybiBpb3JlYWQzMihyY21tLT5i
YXNlICsgcmVnKTsKK30KKworc3RhdGljIGlubGluZSB2b2lkIHJjYXJfY21tX3dyaXRlKHN0cnVj
dCByY2FyX2NtbSAqcmNtbSwgdTMyIHJlZywgdTMyIGRhdGEpCit7CisJaW93cml0ZTMyKGRhdGEs
IHJjbW0tPmJhc2UgKyByZWcpOworfQorCisvKgorICogcmNhcl9jbW1fbHV0X3dyaXRlKCkgLSBT
Y2FsZSB0aGUgRFJNIExVVCB0YWJsZSBlbnRyaWVzIHRvIGhhcmR3YXJlIHByZWNpc2lvbgorICoJ
CQkgIGFuZCB3cml0ZSB0byB0aGUgQ01NIHJlZ2lzdGVycworICogQHJjbW06IFBvaW50ZXIgdG8g
dGhlIENNTSBkZXZpY2UKKyAqIEBkcm1fbHV0OiBQb2ludGVyIHRvIHRoZSBEUk0gTFVUIHRhYmxl
CisgKi8KK3N0YXRpYyB2b2lkIHJjYXJfY21tX2x1dF93cml0ZShzdHJ1Y3QgcmNhcl9jbW0gKnJj
bW0sCisJCQkgICAgICAgY29uc3Qgc3RydWN0IGRybV9jb2xvcl9sdXQgKmRybV9sdXQpCit7CisJ
dW5zaWduZWQgaW50IGk7CisKKwlmb3IgKGkgPSAwOyBpIDwgQ00yX0xVVF9TSVpFOyArK2kpIHsK
KwkJdTMyIGVudHJ5ID0gZHJtX2NvbG9yX2x1dF9leHRyYWN0KGRybV9sdXRbaV0ucmVkLCA4KSA8
PCAxNgorCQkJICB8IGRybV9jb2xvcl9sdXRfZXh0cmFjdChkcm1fbHV0W2ldLmdyZWVuLCA4KSA8
PCA4CisJCQkgIHwgZHJtX2NvbG9yX2x1dF9leHRyYWN0KGRybV9sdXRbaV0uYmx1ZSwgOCk7CisK
KwkJcmNhcl9jbW1fd3JpdGUocmNtbSwgQ00yX0xVVF9UQkwoaSksIGVudHJ5KTsKKwl9Cit9CisK
Ky8qCisgKiByY2FyX2NtbV9zZXR1cCgpIC0gQ29uZmlndXJlIHRoZSBDTU0gdW5pdAorICogQHBk
ZXY6IFRoZSBwbGF0Zm9ybSBkZXZpY2UgYXNzb2NpYXRlZCB3aXRoIHRoZSBDTU0gaW5zdGFuY2UK
KyAqIEBjb25maWc6IFRoZSBDTU0gdW5pdCBjb25maWd1cmF0aW9uCisgKgorICogQ29uZmlndXJl
IHRoZSBDTU0gdW5pdCB3aXRoIHRoZSBnaXZlbiBjb25maWd1cmF0aW9uLiBDdXJyZW50bHkgZW5h
YmxpbmcsCisgKiBkaXNhYmxpbmcgYW5kIHByb2dyYW1taW5nIG9mIHRoZSAxLUQgTFVUIHVuaXQg
aXMgc3VwcG9ydGVkLgorICoKKyAqIFRPRE86IEFkZCBzdXBwb3J0IGZvciBMVVQgZG91YmxlIGJ1
ZmZlciBvcGVyYXRpb25zIHRvIGF2b2lkIHVwZGF0aW5nIHRoZQorICogTFVUIHRhYmxlIGVudHJp
ZXMgd2hpbGUgYSBmcmFtZSBpcyBiZWluZyBkaXNwbGF5ZWQuCisgKi8KK2ludCByY2FyX2NtbV9z
ZXR1cChzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2LAorCQkgICBjb25zdCBzdHJ1Y3QgcmNh
cl9jbW1fY29uZmlnICpjb25maWcpCit7CisJc3RydWN0IHJjYXJfY21tICpyY21tID0gcGxhdGZv
cm1fZ2V0X2RydmRhdGEocGRldik7CisKKwkvKiBEaXNhYmxlIExVVCBpZiBubyB0YWJsZSBpcyBw
cm92aWRlZC4gKi8KKwlpZiAoIWNvbmZpZy0+bHV0LnRhYmxlKSB7CisJCWlmIChyY21tLT5sdXQu
ZW5hYmxlZCkgeworCQkJcmNhcl9jbW1fd3JpdGUocmNtbSwgQ00yX0xVVF9DVFJMLCAwKTsKKwkJ
CXJjbW0tPmx1dC5lbmFibGVkID0gZmFsc2U7CisJCX0KKworCQlyZXR1cm4gMDsKKwl9CisKKwkv
KiBFbmFibGUgTFVUIGFuZCBwcm9ncmFtIHRoZSBuZXcgZ2FtbWEgdGFibGUgdmFsdWVzLiAqLwor
CWlmICghcmNtbS0+bHV0LmVuYWJsZWQpIHsKKwkJcmNhcl9jbW1fd3JpdGUocmNtbSwgQ00yX0xV
VF9DVFJMLCBDTTJfTFVUX0NUUkxfTFVUX0VOKTsKKwkJcmNtbS0+bHV0LmVuYWJsZWQgPSB0cnVl
OworCX0KKworCXJjYXJfY21tX2x1dF93cml0ZShyY21tLCBjb25maWctPmx1dC50YWJsZSk7CisK
KwlyZXR1cm4gMDsKK30KK0VYUE9SVF9TWU1CT0xfR1BMKHJjYXJfY21tX3NldHVwKTsKKworLyoK
KyAqIHJjYXJfY21tX2VuYWJsZSgpIC0gRW5hYmxlIHRoZSBDTU0gdW5pdAorICogQHBkZXY6IFRo
ZSBwbGF0Zm9ybSBkZXZpY2UgYXNzb2NpYXRlZCB3aXRoIHRoZSBDTU0gaW5zdGFuY2UKKyAqCisg
KiBXaGVuIHRoZSBvdXRwdXQgb2YgdGhlIGNvcnJlc3BvbmRpbmcgRFUgY2hhbm5lbCBpcyByb3V0
ZWQgdG8gdGhlIENNTSB1bml0LAorICogdGhlIHVuaXQgc2hhbGwgYmUgZW5hYmxlZCBiZWZvcmUg
dGhlIERVIGNoYW5uZWwgaXMgc3RhcnRlZCwgYW5kIHJlbWFpbgorICogZW5hYmxlZCB1bnRpbCB0
aGUgY2hhbm5lbCBpcyBzdG9wcGVkLiBUaGUgQ01NIHVuaXQgc2hhbGwgYmUgZGlzYWJsZWQgd2l0
aAorICogcmNhcl9jbW1fZGlzYWJsZSgpLgorICoKKyAqIENhbGxzIHRvIHJjYXJfY21tX2VuYWJs
ZSgpIGFuZCByY2FyX2NtbV9kaXNhYmxlKCkgYXJlIG5vdCByZWZlcmVuY2UtY291bnRlZC4KKyAq
IEl0IGlzIGFuIGVycm9yIHRvIGF0dGVtcHQgdG8gZW5hYmxlIGFuIGFscmVhZHkgZW5hYmxlZCBD
TU0gdW5pdCwgb3IgdG8KKyAqIGF0dGVtcHQgdG8gZGlzYWJsZSBhIGRpc2FibGVkIHVuaXQuCisg
Ki8KK2ludCByY2FyX2NtbV9lbmFibGUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKK3sK
KwlpbnQgcmV0OworCisJcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYygmcGRldi0+ZGV2KTsKKwlp
ZiAocmV0IDwgMCkKKwkJcmV0dXJuIHJldDsKKworCXJldHVybiAwOworfQorRVhQT1JUX1NZTUJP
TF9HUEwocmNhcl9jbW1fZW5hYmxlKTsKKworLyoKKyAqIHJjYXJfY21tX2Rpc2FibGUoKSAtIERp
c2FibGUgdGhlIENNTSB1bml0CisgKiBAcGRldjogVGhlIHBsYXRmb3JtIGRldmljZSBhc3NvY2lh
dGVkIHdpdGggdGhlIENNTSBpbnN0YW5jZQorICoKKyAqIFNlZSByY2FyX2NtbV9lbmFibGUoKSBm
b3IgdXNhZ2UgaW5mb3JtYXRpb24uCisgKgorICogRGlzYWJsaW5nIHRoZSBDTU0gdW5pdCBkaXNh
YmxlIGFsbCB0aGUgaW50ZXJuYWwgcHJvY2Vzc2luZyBibG9ja3MuIFRoZSBDTU0KKyAqIHN0YXRl
IHNoYWxsIHRodXMgYmUgcmVzdG9yZWQgd2l0aCByY2FyX2NtbV9zZXR1cCgpIHdoZW4gcmUtZW5h
YmxpbmcgdGhlIENNTQorICogdW5pdCBhZnRlciB0aGUgbmV4dCByY2FyX2NtbV9lbmFibGUoKSBj
YWxsLgorICovCit2b2lkIHJjYXJfY21tX2Rpc2FibGUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAq
cGRldikKK3sKKwlzdHJ1Y3QgcmNhcl9jbW0gKnJjbW0gPSBwbGF0Zm9ybV9nZXRfZHJ2ZGF0YShw
ZGV2KTsKKworCXJjYXJfY21tX3dyaXRlKHJjbW0sIENNMl9MVVRfQ1RSTCwgMCk7CisJcmNtbS0+
bHV0LmVuYWJsZWQgPSBmYWxzZTsKKworCXBtX3J1bnRpbWVfcHV0KCZwZGV2LT5kZXYpOworfQor
RVhQT1JUX1NZTUJPTF9HUEwocmNhcl9jbW1fZGlzYWJsZSk7CisKKy8qCisgKiByY2FyX2NtbV9p
bml0KCkgLSBJbml0aWFsaXplIHRoZSBDTU0gdW5pdAorICogQHBkZXY6IFRoZSBwbGF0Zm9ybSBk
ZXZpY2UgYXNzb2NpYXRlZCB3aXRoIHRoZSBDTU0gaW5zdGFuY2UKKyAqCisgKiBSZXR1cm46IDAg
b24gc3VjY2VzcywgLUVQUk9CRV9ERUZFUiBpZiB0aGUgQ01NIGlzIG5vdCBhdmFpbGFibGUgeWV0
LAorICogICAgICAgICAtRU5PREVWIGlmIHRoZSBEUk1fUkNBUl9DTU0gY29uZmlnIG9wdGlvbiBp
cyBkaXNhYmxlZAorICovCitpbnQgcmNhcl9jbW1faW5pdChzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNl
ICpwZGV2KQoreworCXN0cnVjdCByY2FyX2NtbSAqcmNtbSA9IHBsYXRmb3JtX2dldF9kcnZkYXRh
KHBkZXYpOworCisJaWYgKCFyY21tKQorCQlyZXR1cm4gLUVQUk9CRV9ERUZFUjsKKworCXJldHVy
biAwOworfQorRVhQT1JUX1NZTUJPTF9HUEwocmNhcl9jbW1faW5pdCk7CisKK3N0YXRpYyBpbnQg
cmNhcl9jbW1fcHJvYmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKK3sKKwlzdHJ1Y3Qg
cmNhcl9jbW0gKnJjbW07CisKKwlyY21tID0gZGV2bV9remFsbG9jKCZwZGV2LT5kZXYsIHNpemVv
ZigqcmNtbSksIEdGUF9LRVJORUwpOworCWlmICghcmNtbSkKKwkJcmV0dXJuIC1FTk9NRU07CisJ
cGxhdGZvcm1fc2V0X2RydmRhdGEocGRldiwgcmNtbSk7CisKKwlyY21tLT5iYXNlID0gZGV2bV9w
bGF0Zm9ybV9pb3JlbWFwX3Jlc291cmNlKHBkZXYsIDApOworCWlmIChJU19FUlIocmNtbS0+YmFz
ZSkpCisJCXJldHVybiBQVFJfRVJSKHJjbW0tPmJhc2UpOworCisJcG1fcnVudGltZV9lbmFibGUo
JnBkZXYtPmRldik7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCByY2FyX2NtbV9yZW1v
dmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKK3sKKwlwbV9ydW50aW1lX2Rpc2FibGUo
JnBkZXYtPmRldik7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBvZl9k
ZXZpY2VfaWQgcmNhcl9jbW1fb2ZfdGFibGVbXSA9IHsKKwl7IC5jb21wYXRpYmxlID0gInJlbmVz
YXMscmNhci1nZW4zLWNtbSIsIH0sCisJeyAuY29tcGF0aWJsZSA9ICJyZW5lc2FzLHJjYXItZ2Vu
Mi1jbW0iLCB9LAorCXsgfSwKK307CitNT0RVTEVfREVWSUNFX1RBQkxFKG9mLCByY2FyX2NtbV9v
Zl90YWJsZSk7CisKK3N0YXRpYyBzdHJ1Y3QgcGxhdGZvcm1fZHJpdmVyIHJjYXJfY21tX3BsYXRm
b3JtX2RyaXZlciA9IHsKKwkucHJvYmUJCT0gcmNhcl9jbW1fcHJvYmUsCisJLnJlbW92ZQkJPSBy
Y2FyX2NtbV9yZW1vdmUsCisJLmRyaXZlcgkJPSB7CisJCS5uYW1lCT0gInJjYXItY21tIiwKKwkJ
Lm9mX21hdGNoX3RhYmxlID0gcmNhcl9jbW1fb2ZfdGFibGUsCisJfSwKK307CisKK21vZHVsZV9w
bGF0Zm9ybV9kcml2ZXIocmNhcl9jbW1fcGxhdGZvcm1fZHJpdmVyKTsKKworTU9EVUxFX0FVVEhP
UigiSmFjb3BvIE1vbmRpIDxqYWNvcG8rcmVuZXNhc0BqbW9uZGkub3JnPiIpOworTU9EVUxFX0RF
U0NSSVBUSU9OKCJSZW5lc2FzIFItQ2FyIENNTSBEcml2ZXIiKTsKK01PRFVMRV9MSUNFTlNFKCJH
UEwgdjIiKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfY21tLmgg
Yi9kcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2NtbS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0
CmluZGV4IDAwMDAwMDAwMDAwMC4uYjVmN2VjNmRiMDRhCi0tLSAvZGV2L251bGwKKysrIGIvZHJp
dmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9jbW0uaApAQCAtMCwwICsxLDU4IEBACisvKiBTUERY
LUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCsgKi8KKy8qCisgKiByY2FyX2NtbS5oIC0tIFIt
Q2FyIERpc3BsYXkgVW5pdCBDb2xvciBNYW5hZ2VtZW50IE1vZHVsZQorICoKKyAqIENvcHlyaWdo
dCAoQykgMjAxOSBKYWNvcG8gTW9uZGkgPGphY29wbytyZW5lc2FzQGptb25kaS5vcmc+CisgKi8K
KworI2lmbmRlZiBfX1JDQVJfQ01NX0hfXworI2RlZmluZSBfX1JDQVJfQ01NX0hfXworCisjZGVm
aW5lIENNMl9MVVRfU0laRQkJMjU2CisKK3N0cnVjdCBkcm1fY29sb3JfbHV0Oworc3RydWN0IHBs
YXRmb3JtX2RldmljZTsKKworLyoqCisgKiBzdHJ1Y3QgcmNhcl9jbW1fY29uZmlnIC0gQ01NIGNv
bmZpZ3VyYXRpb24KKyAqCisgKiBAbHV0OgkxRC1MVVQgY29uZmlndXJhdGlvbgorICogQGx1dC50
YWJsZToJMUQtTFVUIHRhYmxlIGVudHJpZXMuIERpc2FibGUgTFVUIG9wZXJhdGlvbnMgd2hlbiBO
VUxMCisgKi8KK3N0cnVjdCByY2FyX2NtbV9jb25maWcgeworCXN0cnVjdCB7CisJCXN0cnVjdCBk
cm1fY29sb3JfbHV0ICp0YWJsZTsKKwl9IGx1dDsKK307CisKKyNpZiBJU19FTkFCTEVEKENPTkZJ
R19EUk1fUkNBUl9DTU0pCitpbnQgcmNhcl9jbW1faW5pdChzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNl
ICpwZGV2KTsKKworaW50IHJjYXJfY21tX2VuYWJsZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpw
ZGV2KTsKK3ZvaWQgcmNhcl9jbW1fZGlzYWJsZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2
KTsKKworaW50IHJjYXJfY21tX3NldHVwKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYsCisJ
CSAgIGNvbnN0IHN0cnVjdCByY2FyX2NtbV9jb25maWcgKmNvbmZpZyk7CisjZWxzZQorc3RhdGlj
IGlubGluZSBpbnQgcmNhcl9jbW1faW5pdChzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQor
eworCXJldHVybiAtRU5PREVWOworfQorCitzdGF0aWMgaW5saW5lIGludCByY2FyX2NtbV9lbmFi
bGUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKK3sKKwlyZXR1cm4gMDsKK30KKworc3Rh
dGljIGlubGluZSB2b2lkIHJjYXJfY21tX2Rpc2FibGUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAq
cGRldikKK3sKK30KKworc3RhdGljIGlubGluZSBpbnQgcmNhcl9jbW1fc2V0dXAoc3RydWN0IHBs
YXRmb3JtX2RldmljZSAqcGRldiwKKwkJCQkgY29uc3Qgc3RydWN0IHJjYXJfY21tX2NvbmZpZyAq
Y29uZmlnKQoreworCXJldHVybiAwOworfQorI2VuZGlmIC8qIElTX0VOQUJMRUQoQ09ORklHX0RS
TV9SQ0FSX0NNTSkgKi8KKworI2VuZGlmIC8qIF9fUkNBUl9DTU1fSF9fICovCi0tIAoyLjIzLjAK
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZl
bCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xp
c3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
