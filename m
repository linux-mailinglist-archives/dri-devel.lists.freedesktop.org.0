Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id E057ADCE65
	for <lists+dri-devel@lfdr.de>; Fri, 18 Oct 2019 20:40:15 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9CD986EBA3;
	Fri, 18 Oct 2019 18:39:52 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from relay2-d.mail.gandi.net (relay2-d.mail.gandi.net
 [217.70.183.194])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4C7806EAA1
 for <dri-devel@lists.freedesktop.org>; Thu, 17 Oct 2019 13:41:56 +0000 (UTC)
X-Originating-IP: 2.224.242.101
Received: from uno.lan (2-224-242-101.ip172.fastwebnet.it [2.224.242.101])
 (Authenticated sender: jacopo@jmondi.org)
 by relay2-d.mail.gandi.net (Postfix) with ESMTPSA id 7786C40005;
 Thu, 17 Oct 2019 13:41:51 +0000 (UTC)
From: Jacopo Mondi <jacopo+renesas@jmondi.org>
To: laurent.pinchart@ideasonboard.com, kieran.bingham+renesas@ideasonboard.com,
 geert@linux-m68k.org, horms@verge.net.au, uli+renesas@fpond.eu
Subject: [PATCH 6.1 3/8] drm: rcar-du: Add support for CMM
Date: Thu, 17 Oct 2019 15:43:32 +0200
Message-Id: <20191017134332.535677-1-jacopo+renesas@jmondi.org>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191016085548.105703-4-jacopo+renesas@jmondi.org>
References: <20191016085548.105703-4-jacopo+renesas@jmondi.org>
MIME-Version: 1.0
X-Mailman-Approved-At: Fri, 18 Oct 2019 18:37:46 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: airlied@linux.ie, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, linux-renesas-soc@vger.kernel.org,
 Jacopo Mondi <jacopo+renesas@jmondi.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIGEgZHJpdmVyIGZvciB0aGUgUi1DYXIgRGlzcGxheSBVbml0IENvbG9yIENvcnJlY3Rpb24g
TW9kdWxlLgoKSW4gbW9zdCBvZiBHZW4zIFNvQ3MsIGVhY2ggRFUgb3V0cHV0IGNoYW5uZWwgaXMg
cHJvdmlkZWQgd2l0aCBhIENNTSB1bml0CnRvIHBlcmZvcm0gaW1hZ2UgZW5oYW5jZW1lbnQgYW5k
IGNvbG9yIGNvcnJlY3Rpb24uCgpBZGQgc3VwcG9ydCBmb3IgQ01NIHRocm91Z2ggYSBkcml2ZXIg
dGhhdCBzdXBwb3J0cyBjb25maWd1cmF0aW9uIG9mCnRoZSAxLWRpbWVuc2lvbmFsIExVVCB0YWJs
ZS4gTW9yZSBhZHZhbmNlZCBDTU0gZmVhdHVyZXMgd2lsbCBiZQppbXBsZW1lbnRlZCBvbiB0b3Ag
b2YgdGhpcyBpbml0aWFsIG9uZS4KClJldmlld2VkLWJ5OiBMYXVyZW50IFBpbmNoYXJ0IDxsYXVy
ZW50LnBpbmNoYXJ0QGlkZWFzb25ib2FyZC5jb20+ClJldmlld2VkLWJ5OiBLaWVyYW4gQmluZ2hh
bSA8a2llcmFuLmJpbmdoYW0rcmVuZXNhc0BpZGVhc29uYm9hcmQuY29tPgpTaWduZWQtb2ZmLWJ5
OiBKYWNvcG8gTW9uZGkgPGphY29wbytyZW5lc2FzQGptb25kaS5vcmc+CgotLS0KdjYgLT4gdjYu
MQotIEV4cGFuZCByY2FyX2NtbV9zZXR1cCgpIGZ1bmN0aW9uIGRvY3VtZW50YXRpb24gdG8gZGV0
YWlsIGl0cyByZWxhdGlvbnNoaXAKICB3aXRoIHJjYXJfY21tX2VuYWJsZSgpIGFuZCB0aGVpciBj
YWxsIG9yZGVyIHByZWNlZGVuY2UuCi0tLQoKIGRyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L0tjb25m
aWcgICAgfCAgIDcgKwogZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvTWFrZWZpbGUgICB8ICAgMSAr
CiBkcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2NtbS5jIHwgMjE3ICsrKysrKysrKysrKysr
KysrKysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2NtbS5oIHwgIDU4
ICsrKysrKysrCiA0IGZpbGVzIGNoYW5nZWQsIDI4MyBpbnNlcnRpb25zKCspCiBjcmVhdGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9jbW0uYwogY3JlYXRlIG1vZGUg
MTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfY21tLmgKCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vcmNhci1kdS9LY29uZmlnIGIvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUv
S2NvbmZpZwppbmRleCAxNTI5ODQ5ZTIxN2UuLjUzOWQyMzI3OTBkMSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL3JjYXItZHUvS2NvbmZpZworKysgYi9kcml2ZXJzL2dwdS9kcm0vcmNhci1k
dS9LY29uZmlnCkBAIC0xMyw2ICsxMywxMyBAQCBjb25maWcgRFJNX1JDQVJfRFUKIAkgIENob29z
ZSB0aGlzIG9wdGlvbiBpZiB5b3UgaGF2ZSBhbiBSLUNhciBjaGlwc2V0LgogCSAgSWYgTSBpcyBz
ZWxlY3RlZCB0aGUgbW9kdWxlIHdpbGwgYmUgY2FsbGVkIHJjYXItZHUtZHJtLgoKK2NvbmZpZyBE
Uk1fUkNBUl9DTU0KKwlib29sICJSLUNhciBEVSBDb2xvciBNYW5hZ2VtZW50IE1vZHVsZSAoQ01N
KSBTdXBwb3J0IgorCWRlcGVuZHMgb24gRFJNICYmIE9GCisJZGVwZW5kcyBvbiBEUk1fUkNBUl9E
VQorCWhlbHAKKwkgIEVuYWJsZSBzdXBwb3J0IGZvciBSLUNhciBDb2xvciBNYW5hZ2VtZW50IE1v
ZHVsZSAoQ01NKS4KKwogY29uZmlnIERSTV9SQ0FSX0RXX0hETUkKIAl0cmlzdGF0ZSAiUi1DYXIg
RFUgR2VuMyBIRE1JIEVuY29kZXIgU3VwcG9ydCIKIAlkZXBlbmRzIG9uIERSTSAmJiBPRgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9k
cm0vcmNhci1kdS9NYWtlZmlsZQppbmRleCA2YzJlZDljNDY0NjcuLjRkMTE4N2NjYzNlNSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9n
cHUvZHJtL3JjYXItZHUvTWFrZWZpbGUKQEAgLTE1LDYgKzE1LDcgQEAgcmNhci1kdS1kcm0tJChD
T05GSUdfRFJNX1JDQVJfTFZEUykJKz0gcmNhcl9kdV9vZi5vIFwKIHJjYXItZHUtZHJtLSQoQ09O
RklHX0RSTV9SQ0FSX1ZTUCkJKz0gcmNhcl9kdV92c3AubwogcmNhci1kdS1kcm0tJChDT05GSUdf
RFJNX1JDQVJfV1JJVEVCQUNLKSArPSByY2FyX2R1X3dyaXRlYmFjay5vCgorb2JqLSQoQ09ORklH
X0RSTV9SQ0FSX0NNTSkJCSs9IHJjYXJfY21tLm8KIG9iai0kKENPTkZJR19EUk1fUkNBUl9EVSkJ
CSs9IHJjYXItZHUtZHJtLm8KIG9iai0kKENPTkZJR19EUk1fUkNBUl9EV19IRE1JKQkJKz0gcmNh
cl9kd19oZG1pLm8KIG9iai0kKENPTkZJR19EUk1fUkNBUl9MVkRTKQkJKz0gcmNhcl9sdmRzLm8K
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfY21tLmMgYi9kcml2ZXJz
L2dwdS9kcm0vcmNhci1kdS9yY2FyX2NtbS5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAw
MDAwMDAwMDAwMC4uOTUyMzE2ZWIyMDJiCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL3JjYXItZHUvcmNhcl9jbW0uYwpAQCAtMCwwICsxLDIxNyBAQAorLy8gU1BEWC1MaWNlbnNl
LUlkZW50aWZpZXI6IEdQTC0yLjArCisvKgorICogcmNhcl9jbW0uYyAtLSBSLUNhciBEaXNwbGF5
IFVuaXQgQ29sb3IgTWFuYWdlbWVudCBNb2R1bGUKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMTkg
SmFjb3BvIE1vbmRpIDxqYWNvcG8rcmVuZXNhc0BqbW9uZGkub3JnPgorICovCisKKyNpbmNsdWRl
IDxsaW51eC9pby5oPgorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgorI2luY2x1ZGUgPGxpbnV4
L29mLmg+CisjaW5jbHVkZSA8bGludXgvcGxhdGZvcm1fZGV2aWNlLmg+CisjaW5jbHVkZSA8bGlu
dXgvcG1fcnVudGltZS5oPgorCisjaW5jbHVkZSA8ZHJtL2RybV9jb2xvcl9tZ210Lmg+CisKKyNp
bmNsdWRlICJyY2FyX2NtbS5oIgorCisjZGVmaW5lIENNMl9MVVRfQ1RSTAkJMHgwMDAwCisjZGVm
aW5lIENNMl9MVVRfQ1RSTF9MVVRfRU4JQklUKDApCisjZGVmaW5lIENNMl9MVVRfVEJMX0JBU0UJ
MHgwNjAwCisjZGVmaW5lIENNMl9MVVRfVEJMKF9faSkJKENNMl9MVVRfVEJMX0JBU0UgKyAoX19p
KSAqIDQpCisKK3N0cnVjdCByY2FyX2NtbSB7CisJdm9pZCBfX2lvbWVtICpiYXNlOworCisJLyoK
KwkgKiBAbHV0OgkJMUQtTFVUIHN0YXRlCisJICogQGx1dC5lbmFibGVkOgkxRC1MVVQgZW5hYmxl
ZCBmbGFnCisJICovCisJc3RydWN0IHsKKwkJYm9vbCBlbmFibGVkOworCX0gbHV0OworfTsKKwor
c3RhdGljIGlubGluZSBpbnQgcmNhcl9jbW1fcmVhZChzdHJ1Y3QgcmNhcl9jbW0gKnJjbW0sIHUz
MiByZWcpCit7CisJcmV0dXJuIGlvcmVhZDMyKHJjbW0tPmJhc2UgKyByZWcpOworfQorCitzdGF0
aWMgaW5saW5lIHZvaWQgcmNhcl9jbW1fd3JpdGUoc3RydWN0IHJjYXJfY21tICpyY21tLCB1MzIg
cmVnLCB1MzIgZGF0YSkKK3sKKwlpb3dyaXRlMzIoZGF0YSwgcmNtbS0+YmFzZSArIHJlZyk7Cit9
CisKKy8qCisgKiByY2FyX2NtbV9sdXRfd3JpdGUoKSAtIFNjYWxlIHRoZSBEUk0gTFVUIHRhYmxl
IGVudHJpZXMgdG8gaGFyZHdhcmUgcHJlY2lzaW9uCisgKgkJCSAgYW5kIHdyaXRlIHRvIHRoZSBD
TU0gcmVnaXN0ZXJzCisgKiBAcmNtbTogUG9pbnRlciB0byB0aGUgQ01NIGRldmljZQorICogQGRy
bV9sdXQ6IFBvaW50ZXIgdG8gdGhlIERSTSBMVVQgdGFibGUKKyAqLworc3RhdGljIHZvaWQgcmNh
cl9jbW1fbHV0X3dyaXRlKHN0cnVjdCByY2FyX2NtbSAqcmNtbSwKKwkJCSAgICAgICBjb25zdCBz
dHJ1Y3QgZHJtX2NvbG9yX2x1dCAqZHJtX2x1dCkKK3sKKwl1bnNpZ25lZCBpbnQgaTsKKworCWZv
ciAoaSA9IDA7IGkgPCBDTTJfTFVUX1NJWkU7ICsraSkgeworCQl1MzIgZW50cnkgPSBkcm1fY29s
b3JfbHV0X2V4dHJhY3QoZHJtX2x1dFtpXS5yZWQsIDgpIDw8IDE2CisJCQkgIHwgZHJtX2NvbG9y
X2x1dF9leHRyYWN0KGRybV9sdXRbaV0uZ3JlZW4sIDgpIDw8IDgKKwkJCSAgfCBkcm1fY29sb3Jf
bHV0X2V4dHJhY3QoZHJtX2x1dFtpXS5ibHVlLCA4KTsKKworCQlyY2FyX2NtbV93cml0ZShyY21t
LCBDTTJfTFVUX1RCTChpKSwgZW50cnkpOworCX0KK30KKworLyoKKyAqIHJjYXJfY21tX3NldHVw
KCkgLSBDb25maWd1cmUgdGhlIENNTSB1bml0CisgKiBAcGRldjogVGhlIHBsYXRmb3JtIGRldmlj
ZSBhc3NvY2lhdGVkIHdpdGggdGhlIENNTSBpbnN0YW5jZQorICogQGNvbmZpZzogVGhlIENNTSB1
bml0IGNvbmZpZ3VyYXRpb24KKyAqCisgKiBDb25maWd1cmUgdGhlIENNTSB1bml0IHdpdGggdGhl
IGdpdmVuIGNvbmZpZ3VyYXRpb24uIEN1cnJlbnRseSBlbmFibGluZywKKyAqIGRpc2FibGluZyBh
bmQgcHJvZ3JhbW1pbmcgb2YgdGhlIDEtRCBMVVQgdW5pdCBpcyBzdXBwb3J0ZWQuCisgKgorICog
QXMgcmNhcl9jbW1fc2V0dXAoKSBhY2Nlc3NlcyB0aGUgQ01NIHJlZ2lzdGVycyB0aGUgdW5pdCBz
aG91bGQgYmUgcG93ZXJlZAorICogYW5kIGl0cyBmdW5jdGlvbmFsIGNsb2NrIGVuYWJsZWQuIFRv
IGd1YXJhbnRlZSB0aGlzLCBiZWZvcmUgYW55IGNhbGwgdG8KKyAqIHRoaXMgZnVuY3Rpb24gaXMg
bWFkZSwgdGhlIENNTSB1bml0IGhhcyB0byBiZSBlbmFibGVkIGJ5IGNhbGxpbmcKKyAqIHJjYXJf
Y21tX2VuYWJsZSgpIGZpcnN0LgorICoKKyAqIFRPRE86IEFkZCBzdXBwb3J0IGZvciBMVVQgZG91
YmxlIGJ1ZmZlciBvcGVyYXRpb25zIHRvIGF2b2lkIHVwZGF0aW5nIHRoZQorICogTFVUIHRhYmxl
IGVudHJpZXMgd2hpbGUgYSBmcmFtZSBpcyBiZWluZyBkaXNwbGF5ZWQuCisgKi8KK2ludCByY2Fy
X2NtbV9zZXR1cChzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2LAorCQkgICBjb25zdCBzdHJ1
Y3QgcmNhcl9jbW1fY29uZmlnICpjb25maWcpCit7CisJc3RydWN0IHJjYXJfY21tICpyY21tID0g
cGxhdGZvcm1fZ2V0X2RydmRhdGEocGRldik7CisKKwkvKiBEaXNhYmxlIExVVCBpZiBubyB0YWJs
ZSBpcyBwcm92aWRlZC4gKi8KKwlpZiAoIWNvbmZpZy0+bHV0LnRhYmxlKSB7CisJCWlmIChyY21t
LT5sdXQuZW5hYmxlZCkgeworCQkJcmNhcl9jbW1fd3JpdGUocmNtbSwgQ00yX0xVVF9DVFJMLCAw
KTsKKwkJCXJjbW0tPmx1dC5lbmFibGVkID0gZmFsc2U7CisJCX0KKworCQlyZXR1cm4gMDsKKwl9
CisKKwkvKiBFbmFibGUgTFVUIGFuZCBwcm9ncmFtIHRoZSBuZXcgZ2FtbWEgdGFibGUgdmFsdWVz
LiAqLworCWlmICghcmNtbS0+bHV0LmVuYWJsZWQpIHsKKwkJcmNhcl9jbW1fd3JpdGUocmNtbSwg
Q00yX0xVVF9DVFJMLCBDTTJfTFVUX0NUUkxfTFVUX0VOKTsKKwkJcmNtbS0+bHV0LmVuYWJsZWQg
PSB0cnVlOworCX0KKworCXJjYXJfY21tX2x1dF93cml0ZShyY21tLCBjb25maWctPmx1dC50YWJs
ZSk7CisKKwlyZXR1cm4gMDsKK30KK0VYUE9SVF9TWU1CT0xfR1BMKHJjYXJfY21tX3NldHVwKTsK
KworLyoKKyAqIHJjYXJfY21tX2VuYWJsZSgpIC0gRW5hYmxlIHRoZSBDTU0gdW5pdAorICogQHBk
ZXY6IFRoZSBwbGF0Zm9ybSBkZXZpY2UgYXNzb2NpYXRlZCB3aXRoIHRoZSBDTU0gaW5zdGFuY2UK
KyAqCisgKiBXaGVuIHRoZSBvdXRwdXQgb2YgdGhlIGNvcnJlc3BvbmRpbmcgRFUgY2hhbm5lbCBp
cyByb3V0ZWQgdG8gdGhlIENNTSB1bml0LAorICogdGhlIHVuaXQgc2hhbGwgYmUgZW5hYmxlZCBi
ZWZvcmUgdGhlIERVIGNoYW5uZWwgaXMgc3RhcnRlZCwgYW5kIHJlbWFpbgorICogZW5hYmxlZCB1
bnRpbCB0aGUgY2hhbm5lbCBpcyBzdG9wcGVkLiBUaGUgQ01NIHVuaXQgc2hhbGwgYmUgZGlzYWJs
ZWQgd2l0aAorICogcmNhcl9jbW1fZGlzYWJsZSgpLgorICoKKyAqIENhbGxzIHRvIHJjYXJfY21t
X2VuYWJsZSgpIGFuZCByY2FyX2NtbV9kaXNhYmxlKCkgYXJlIG5vdCByZWZlcmVuY2UtY291bnRl
ZC4KKyAqIEl0IGlzIGFuIGVycm9yIHRvIGF0dGVtcHQgdG8gZW5hYmxlIGFuIGFscmVhZHkgZW5h
YmxlZCBDTU0gdW5pdCwgb3IgdG8KKyAqIGF0dGVtcHQgdG8gZGlzYWJsZSBhIGRpc2FibGVkIHVu
aXQuCisgKi8KK2ludCByY2FyX2NtbV9lbmFibGUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRl
dikKK3sKKwlpbnQgcmV0OworCisJcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYygmcGRldi0+ZGV2
KTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0dXJuIHJldDsKKworCXJldHVybiAwOworfQorRVhQT1JU
X1NZTUJPTF9HUEwocmNhcl9jbW1fZW5hYmxlKTsKKworLyoKKyAqIHJjYXJfY21tX2Rpc2FibGUo
KSAtIERpc2FibGUgdGhlIENNTSB1bml0CisgKiBAcGRldjogVGhlIHBsYXRmb3JtIGRldmljZSBh
c3NvY2lhdGVkIHdpdGggdGhlIENNTSBpbnN0YW5jZQorICoKKyAqIFNlZSByY2FyX2NtbV9lbmFi
bGUoKSBmb3IgdXNhZ2UgaW5mb3JtYXRpb24uCisgKgorICogRGlzYWJsaW5nIHRoZSBDTU0gdW5p
dCBkaXNhYmxlIGFsbCB0aGUgaW50ZXJuYWwgcHJvY2Vzc2luZyBibG9ja3MuIFRoZSBDTU0KKyAq
IHN0YXRlIHNoYWxsIHRodXMgYmUgcmVzdG9yZWQgd2l0aCByY2FyX2NtbV9zZXR1cCgpIHdoZW4g
cmUtZW5hYmxpbmcgdGhlIENNTQorICogdW5pdCBhZnRlciB0aGUgbmV4dCByY2FyX2NtbV9lbmFi
bGUoKSBjYWxsLgorICovCit2b2lkIHJjYXJfY21tX2Rpc2FibGUoc3RydWN0IHBsYXRmb3JtX2Rl
dmljZSAqcGRldikKK3sKKwlzdHJ1Y3QgcmNhcl9jbW0gKnJjbW0gPSBwbGF0Zm9ybV9nZXRfZHJ2
ZGF0YShwZGV2KTsKKworCXJjYXJfY21tX3dyaXRlKHJjbW0sIENNMl9MVVRfQ1RSTCwgMCk7CisJ
cmNtbS0+bHV0LmVuYWJsZWQgPSBmYWxzZTsKKworCXBtX3J1bnRpbWVfcHV0KCZwZGV2LT5kZXYp
OworfQorRVhQT1JUX1NZTUJPTF9HUEwocmNhcl9jbW1fZGlzYWJsZSk7CisKKy8qCisgKiByY2Fy
X2NtbV9pbml0KCkgLSBJbml0aWFsaXplIHRoZSBDTU0gdW5pdAorICogQHBkZXY6IFRoZSBwbGF0
Zm9ybSBkZXZpY2UgYXNzb2NpYXRlZCB3aXRoIHRoZSBDTU0gaW5zdGFuY2UKKyAqCisgKiBSZXR1
cm46IDAgb24gc3VjY2VzcywgLUVQUk9CRV9ERUZFUiBpZiB0aGUgQ01NIGlzIG5vdCBhdmFpbGFi
bGUgeWV0LAorICogICAgICAgICAtRU5PREVWIGlmIHRoZSBEUk1fUkNBUl9DTU0gY29uZmlnIG9w
dGlvbiBpcyBkaXNhYmxlZAorICovCitpbnQgcmNhcl9jbW1faW5pdChzdHJ1Y3QgcGxhdGZvcm1f
ZGV2aWNlICpwZGV2KQoreworCXN0cnVjdCByY2FyX2NtbSAqcmNtbSA9IHBsYXRmb3JtX2dldF9k
cnZkYXRhKHBkZXYpOworCisJaWYgKCFyY21tKQorCQlyZXR1cm4gLUVQUk9CRV9ERUZFUjsKKwor
CXJldHVybiAwOworfQorRVhQT1JUX1NZTUJPTF9HUEwocmNhcl9jbW1faW5pdCk7CisKK3N0YXRp
YyBpbnQgcmNhcl9jbW1fcHJvYmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKK3sKKwlz
dHJ1Y3QgcmNhcl9jbW0gKnJjbW07CisKKwlyY21tID0gZGV2bV9remFsbG9jKCZwZGV2LT5kZXYs
IHNpemVvZigqcmNtbSksIEdGUF9LRVJORUwpOworCWlmICghcmNtbSkKKwkJcmV0dXJuIC1FTk9N
RU07CisJcGxhdGZvcm1fc2V0X2RydmRhdGEocGRldiwgcmNtbSk7CisKKwlyY21tLT5iYXNlID0g
ZGV2bV9wbGF0Zm9ybV9pb3JlbWFwX3Jlc291cmNlKHBkZXYsIDApOworCWlmIChJU19FUlIocmNt
bS0+YmFzZSkpCisJCXJldHVybiBQVFJfRVJSKHJjbW0tPmJhc2UpOworCisJcG1fcnVudGltZV9l
bmFibGUoJnBkZXYtPmRldik7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCByY2FyX2Nt
bV9yZW1vdmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKK3sKKwlwbV9ydW50aW1lX2Rp
c2FibGUoJnBkZXYtPmRldik7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVj
dCBvZl9kZXZpY2VfaWQgcmNhcl9jbW1fb2ZfdGFibGVbXSA9IHsKKwl7IC5jb21wYXRpYmxlID0g
InJlbmVzYXMscmNhci1nZW4zLWNtbSIsIH0sCisJeyAuY29tcGF0aWJsZSA9ICJyZW5lc2FzLHJj
YXItZ2VuMi1jbW0iLCB9LAorCXsgfSwKK307CitNT0RVTEVfREVWSUNFX1RBQkxFKG9mLCByY2Fy
X2NtbV9vZl90YWJsZSk7CisKK3N0YXRpYyBzdHJ1Y3QgcGxhdGZvcm1fZHJpdmVyIHJjYXJfY21t
X3BsYXRmb3JtX2RyaXZlciA9IHsKKwkucHJvYmUJCT0gcmNhcl9jbW1fcHJvYmUsCisJLnJlbW92
ZQkJPSByY2FyX2NtbV9yZW1vdmUsCisJLmRyaXZlcgkJPSB7CisJCS5uYW1lCT0gInJjYXItY21t
IiwKKwkJLm9mX21hdGNoX3RhYmxlID0gcmNhcl9jbW1fb2ZfdGFibGUsCisJfSwKK307CisKK21v
ZHVsZV9wbGF0Zm9ybV9kcml2ZXIocmNhcl9jbW1fcGxhdGZvcm1fZHJpdmVyKTsKKworTU9EVUxF
X0FVVEhPUigiSmFjb3BvIE1vbmRpIDxqYWNvcG8rcmVuZXNhc0BqbW9uZGkub3JnPiIpOworTU9E
VUxFX0RFU0NSSVBUSU9OKCJSZW5lc2FzIFItQ2FyIENNTSBEcml2ZXIiKTsKK01PRFVMRV9MSUNF
TlNFKCJHUEwgdjIiKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJf
Y21tLmggYi9kcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2NtbS5oCm5ldyBmaWxlIG1vZGUg
MTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uYjVmN2VjNmRiMDRhCi0tLSAvZGV2L251bGwKKysr
IGIvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9jbW0uaApAQCAtMCwwICsxLDU4IEBACisv
KiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCsgKi8KKy8qCisgKiByY2FyX2NtbS5o
IC0tIFItQ2FyIERpc3BsYXkgVW5pdCBDb2xvciBNYW5hZ2VtZW50IE1vZHVsZQorICoKKyAqIENv
cHlyaWdodCAoQykgMjAxOSBKYWNvcG8gTW9uZGkgPGphY29wbytyZW5lc2FzQGptb25kaS5vcmc+
CisgKi8KKworI2lmbmRlZiBfX1JDQVJfQ01NX0hfXworI2RlZmluZSBfX1JDQVJfQ01NX0hfXwor
CisjZGVmaW5lIENNMl9MVVRfU0laRQkJMjU2CisKK3N0cnVjdCBkcm1fY29sb3JfbHV0Oworc3Ry
dWN0IHBsYXRmb3JtX2RldmljZTsKKworLyoqCisgKiBzdHJ1Y3QgcmNhcl9jbW1fY29uZmlnIC0g
Q01NIGNvbmZpZ3VyYXRpb24KKyAqCisgKiBAbHV0OgkxRC1MVVQgY29uZmlndXJhdGlvbgorICog
QGx1dC50YWJsZToJMUQtTFVUIHRhYmxlIGVudHJpZXMuIERpc2FibGUgTFVUIG9wZXJhdGlvbnMg
d2hlbiBOVUxMCisgKi8KK3N0cnVjdCByY2FyX2NtbV9jb25maWcgeworCXN0cnVjdCB7CisJCXN0
cnVjdCBkcm1fY29sb3JfbHV0ICp0YWJsZTsKKwl9IGx1dDsKK307CisKKyNpZiBJU19FTkFCTEVE
KENPTkZJR19EUk1fUkNBUl9DTU0pCitpbnQgcmNhcl9jbW1faW5pdChzdHJ1Y3QgcGxhdGZvcm1f
ZGV2aWNlICpwZGV2KTsKKworaW50IHJjYXJfY21tX2VuYWJsZShzdHJ1Y3QgcGxhdGZvcm1fZGV2
aWNlICpwZGV2KTsKK3ZvaWQgcmNhcl9jbW1fZGlzYWJsZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNl
ICpwZGV2KTsKKworaW50IHJjYXJfY21tX3NldHVwKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBk
ZXYsCisJCSAgIGNvbnN0IHN0cnVjdCByY2FyX2NtbV9jb25maWcgKmNvbmZpZyk7CisjZWxzZQor
c3RhdGljIGlubGluZSBpbnQgcmNhcl9jbW1faW5pdChzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpw
ZGV2KQoreworCXJldHVybiAtRU5PREVWOworfQorCitzdGF0aWMgaW5saW5lIGludCByY2FyX2Nt
bV9lbmFibGUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKK3sKKwlyZXR1cm4gMDsKK30K
Kworc3RhdGljIGlubGluZSB2b2lkIHJjYXJfY21tX2Rpc2FibGUoc3RydWN0IHBsYXRmb3JtX2Rl
dmljZSAqcGRldikKK3sKK30KKworc3RhdGljIGlubGluZSBpbnQgcmNhcl9jbW1fc2V0dXAoc3Ry
dWN0IHBsYXRmb3JtX2RldmljZSAqcGRldiwKKwkJCQkgY29uc3Qgc3RydWN0IHJjYXJfY21tX2Nv
bmZpZyAqY29uZmlnKQoreworCXJldHVybiAwOworfQorI2VuZGlmIC8qIElTX0VOQUJMRUQoQ09O
RklHX0RSTV9SQ0FSX0NNTSkgKi8KKworI2VuZGlmIC8qIF9fUkNBUl9DTU1fSF9fICovCi0tCjIu
MjMuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJp
LWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
