Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 117271CB95A
	for <lists+dri-devel@lfdr.de>; Fri,  8 May 2020 22:59:20 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 262D86EB6B;
	Fri,  8 May 2020 20:59:16 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-oi1-x243.google.com (mail-oi1-x243.google.com
 [IPv6:2607:f8b0:4864:20::243])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 477886EB6E
 for <dri-devel@lists.freedesktop.org>; Fri,  8 May 2020 20:59:15 +0000 (UTC)
Received: by mail-oi1-x243.google.com with SMTP id j16so9612564oih.10
 for <dri-devel@lists.freedesktop.org>; Fri, 08 May 2020 13:59:15 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=ffwll.ch; s=google;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc:content-transfer-encoding;
 bh=JvQWomvjxRLudQWRCaB9megG2fXdC0dsqrE9wIO6QIg=;
 b=UzoCHcnW0VeddBNAXca5ePUWKDqO4F5IKcddt+7x2DPPr5wW20lpdInECrtT3H1iq4
 KchnkNi2mevHqKxSjitcQY6w/pz2vX/CqsvJ0y4w1UezxkAI4Gy4SCZS2mGwDFDEL33p
 9ej4GLctnLkeHfH7cseZZkPYJS/WcYjvU2k8c=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc:content-transfer-encoding;
 bh=JvQWomvjxRLudQWRCaB9megG2fXdC0dsqrE9wIO6QIg=;
 b=jkuHgegWvB8aFwdk5QO7AWpwUn5hQ+eY7jCVGGAY3mE2/onbXUVUY6jm91+CNkM/XH
 hIWT3f42B9yJ+BXnuvzKj7bcBbhYmmrJ4Qv3+S1Z307qMfmwe3IFRL7CO2OMfT7r0CTr
 VppIc4aKiGtWqFVl6UnpdUWdp0ItPKd3GVL56B/k8/87XB6PAUAe2oGs6s5j3bKLd3RM
 LnsnjZBGjq77jXMoZg1yOG1WKdnccEAmc0nzfp+lkZTrNyN3yxX2u1LQriRTxZeDk26S
 ZAMpFEJz8fjAEWseFwJYtmre1SVMeOrqEgMiXl71zVng/EPQ7TpcOOaXJMNMW22rApxY
 s/+w==
X-Gm-Message-State: AGi0PuaHZecedHH66smTgfEp9/arY8kUr3owadIk/1YCqdTkaSNuTD0E
 wJjSBwGkMVvvxtzlBLdZAs2gOG5vLbkOubR6u+zcow==
X-Google-Smtp-Source: APiQypLAu0p1Krm7EdSF7szPOyo3xTBi08s9nDniaTs/XUU/hUlKs8JR8+zGu/R5I2zr21JRDg9KubXRs4AnLxBrUgg=
X-Received: by 2002:aca:2113:: with SMTP id 19mr3361674oiz.128.1588971554521; 
 Fri, 08 May 2020 13:59:14 -0700 (PDT)
MIME-Version: 1.0
References: <20200508204751.155488-1-lyude@redhat.com>
 <20200508204751.155488-4-lyude@redhat.com>
In-Reply-To: <20200508204751.155488-4-lyude@redhat.com>
From: Daniel Vetter <daniel@ffwll.ch>
Date: Fri, 8 May 2020 22:59:03 +0200
Message-ID: <CAKMK7uGEssowz-9jX1LP4=eRNTuxN_k4MLfrGqG3szjQE=Gonw@mail.gmail.com>
Subject: Re: [RFC v4 03/12] drm/vblank: Register drmm cleanup action once per
 drm_vblank_crtc
To: Lyude Paul <lyude@redhat.com>
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: David Airlie <airlied@linux.ie>,
 Nouveau Dev <nouveau@lists.freedesktop.org>,
 Linux Kernel Mailing List <linux-kernel@vger.kernel.org>,
 dri-devel <dri-devel@lists.freedesktop.org>,
 Thomas Zimmermann <tzimmermann@suse.de>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gRnJpLCBNYXkgOCwgMjAyMCBhdCAxMDo0OCBQTSBMeXVkZSBQYXVsIDxseXVkZUByZWRoYXQu
Y29tPiB3cm90ZToKPgo+IFNpbmNlIHdlJ2xsIGJlIGFsbG9jYXRpbmcgcmVzb3VyY2VzIGZvciBr
dGhyZWFkX2NyZWF0ZV93b3JrZXIoKSBpbiB0aGUKPiBuZXh0IGNvbW1pdCAod2hpY2ggY291bGQg
ZmFpbCBhbmQgcmVxdWlyZSB1cyB0byBjbGVhbiB1cCB0aGUgbWVzcyksCj4gbGV0J3Mgc2ltcGxp
ZnkgdGhlIGNsZWFudXAgcHJvY2VzcyBhIGJpdCBieSByZWdpc3RlcmluZyBhCj4gZHJtX3ZibGFu
a19pbml0X3JlbGVhc2UoKSBhY3Rpb24gZm9yIGVhY2ggZHJtX3ZibGFua19jcnRjIHNvIHRoZXkn
cmUKPiBzdGlsbCBjbGVhbmVkIHVwIGlmIHdlIGZhaWwgdG8gaW5pdGlhbGl6ZSBvbmUgb2YgdGhl
bS4KPgo+IENoYW5nZXMgc2luY2UgdjM6Cj4gKiBVc2UgZHJtbV9hZGRfYWN0aW9uX29yX3Jlc2V0
KCkgLSBEYW5pZWwgVmV0dGVyCj4KPiBDYzogRGFuaWVsIFZldHRlciA8ZGFuaWVsQGZmd2xsLmNo
Pgo+IENjOiBWaWxsZSBTeXJqw6Rsw6QgPHZpbGxlLnN5cmphbGFAbGludXguaW50ZWwuY29tPgo+
IENjOiBkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCj4gQ2M6IG5vdXZlYXVAbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnCj4gU2lnbmVkLW9mZi1ieTogTHl1ZGUgUGF1bCA8bHl1ZGVAcmVkaGF0
LmNvbT4KClJldmlld2VkLWJ5OiBEYW5pZWwgVmV0dGVyIDxkYW5pZWwudmV0dGVyQGZmd2xsLmNo
PgoKSSB0aGluayB0aGUgb3RoZXIgcGF0Y2hlcyBuZWVkIGEgYnJhaW4gdGhhdCdzIGxlc3MgaW4g
dy9lIG1vZGUgOi0pCgpDaGVlcnMsIERhbmllbAoKPiAtLS0KPiAgZHJpdmVycy9ncHUvZHJtL2Ry
bV92YmxhbmsuYyB8IDIzICsrKysrKysrKystLS0tLS0tLS0tLS0tCj4gIDEgZmlsZSBjaGFuZ2Vk
LCAxMCBpbnNlcnRpb25zKCspLCAxMyBkZWxldGlvbnMoLSkKPgo+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vZHJtX3ZibGFuay5jIGIvZHJpdmVycy9ncHUvZHJtL2RybV92YmxhbmsuYwo+
IGluZGV4IDc1OGJmNzRlMWNhYi4uYTRhOTAxMzU4NGUyIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9kcm1fdmJsYW5rLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX3ZibGFuay5j
Cj4gQEAgLTQ5MSwxNiArNDkxLDEyIEBAIHN0YXRpYyB2b2lkIHZibGFua19kaXNhYmxlX2ZuKHN0
cnVjdCB0aW1lcl9saXN0ICp0KQo+Cj4gIHN0YXRpYyB2b2lkIGRybV92YmxhbmtfaW5pdF9yZWxl
YXNlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKnB0cikKPiAgewo+IC0gICAgICAgdW5z
aWduZWQgaW50IHBpcGU7Cj4gLQo+IC0gICAgICAgZm9yIChwaXBlID0gMDsgcGlwZSA8IGRldi0+
bnVtX2NydGNzOyBwaXBlKyspIHsKPiAtICAgICAgICAgICAgICAgc3RydWN0IGRybV92Ymxhbmtf
Y3J0YyAqdmJsYW5rID0gJmRldi0+dmJsYW5rW3BpcGVdOwo+ICsgICAgICAgc3RydWN0IGRybV92
YmxhbmtfY3J0YyAqdmJsYW5rID0gcHRyOwo+Cj4gLSAgICAgICAgICAgICAgIFdBUk5fT04oUkVB
RF9PTkNFKHZibGFuay0+ZW5hYmxlZCkgJiYKPiAtICAgICAgICAgICAgICAgICAgICAgICBkcm1f
Y29yZV9jaGVja19mZWF0dXJlKGRldiwgRFJJVkVSX01PREVTRVQpKTsKPiArICAgICAgIFdBUk5f
T04oUkVBRF9PTkNFKHZibGFuay0+ZW5hYmxlZCkgJiYKPiArICAgICAgICAgICAgICAgZHJtX2Nv
cmVfY2hlY2tfZmVhdHVyZShkZXYsIERSSVZFUl9NT0RFU0VUKSk7Cj4KPiAtICAgICAgICAgICAg
ICAgZGVsX3RpbWVyX3N5bmMoJnZibGFuay0+ZGlzYWJsZV90aW1lcik7Cj4gLSAgICAgICB9Cj4g
KyAgICAgICBkZWxfdGltZXJfc3luYygmdmJsYW5rLT5kaXNhYmxlX3RpbWVyKTsKPiAgfQo+Cj4g
IC8qKgo+IEBAIC01MTAsNyArNTA2LDcgQEAgc3RhdGljIHZvaWQgZHJtX3ZibGFua19pbml0X3Jl
bGVhc2Uoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqcHRyKQo+ICAgKgo+ICAgKiBUaGlz
IGZ1bmN0aW9uIGluaXRpYWxpemVzIHZibGFuayBzdXBwb3J0IGZvciBAbnVtX2NydGNzIGRpc3Bs
YXkgcGlwZWxpbmVzLgo+ICAgKiBDbGVhbnVwIGlzIGhhbmRsZWQgYXV0b21hdGljYWxseSB0aHJv
dWdoIGEgY2xlYW51cCBmdW5jdGlvbiBhZGRlZCB3aXRoCj4gLSAqIGRybW1fYWRkX2FjdGlvbigp
Lgo+ICsgKiBkcm1tX2FkZF9hY3Rpb25fb3JfcmVzZXQoKS4KPiAgICoKPiAgICogUmV0dXJuczoK
PiAgICogWmVybyBvbiBzdWNjZXNzIG9yIGEgbmVnYXRpdmUgZXJyb3IgY29kZSBvbiBmYWlsdXJl
Lgo+IEBAIC01MjksMTAgKzUyNSw2IEBAIGludCBkcm1fdmJsYW5rX2luaXQoc3RydWN0IGRybV9k
ZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IG51bV9jcnRjcykKPgo+ICAgICAgICAgZGV2LT5udW1f
Y3J0Y3MgPSBudW1fY3J0Y3M7Cj4KPiAtICAgICAgIHJldCA9IGRybW1fYWRkX2FjdGlvbihkZXYs
IGRybV92YmxhbmtfaW5pdF9yZWxlYXNlLCBOVUxMKTsKPiAtICAgICAgIGlmIChyZXQpCj4gLSAg
ICAgICAgICAgICAgIHJldHVybiByZXQ7Cj4gLQo+ICAgICAgICAgZm9yIChpID0gMDsgaSA8IG51
bV9jcnRjczsgaSsrKSB7Cj4gICAgICAgICAgICAgICAgIHN0cnVjdCBkcm1fdmJsYW5rX2NydGMg
KnZibGFuayA9ICZkZXYtPnZibGFua1tpXTsKPgo+IEBAIC01NDEsNiArNTMzLDExIEBAIGludCBk
cm1fdmJsYW5rX2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IG51bV9j
cnRjcykKPiAgICAgICAgICAgICAgICAgaW5pdF93YWl0cXVldWVfaGVhZCgmdmJsYW5rLT5xdWV1
ZSk7Cj4gICAgICAgICAgICAgICAgIHRpbWVyX3NldHVwKCZ2YmxhbmstPmRpc2FibGVfdGltZXIs
IHZibGFua19kaXNhYmxlX2ZuLCAwKTsKPiAgICAgICAgICAgICAgICAgc2VxbG9ja19pbml0KCZ2
YmxhbmstPnNlcWxvY2spOwo+ICsKPiArICAgICAgICAgICAgICAgcmV0ID0gZHJtbV9hZGRfYWN0
aW9uX29yX3Jlc2V0KGRldiwgZHJtX3ZibGFua19pbml0X3JlbGVhc2UsCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YmxhbmspOwo+ICsgICAgICAgICAg
ICAgICBpZiAocmV0KQo+ICsgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXQ7Cj4gICAg
ICAgICB9Cj4KPiAgICAgICAgIERSTV9JTkZPKCJTdXBwb3J0cyB2YmxhbmsgdGltZXN0YW1wIGNh
Y2hpbmcgUmV2IDIgKDIxLjEwLjIwMTMpLlxuIik7Cj4gLS0KPiAyLjI1LjQKPgoKCi0tIApEYW5p
ZWwgVmV0dGVyClNvZnR3YXJlIEVuZ2luZWVyLCBJbnRlbCBDb3Jwb3JhdGlvbgorNDEgKDApIDc5
IDM2NSA1NyA0OCAtIGh0dHA6Ly9ibG9nLmZmd2xsLmNoCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVs
QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWls
bWFuL2xpc3RpbmZvL2RyaS1kZXZlbAo=
