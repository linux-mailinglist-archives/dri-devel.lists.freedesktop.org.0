Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 5638957CD1
	for <lists+dri-devel@lfdr.de>; Thu, 27 Jun 2019 09:11:54 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CF31F6E5D5;
	Thu, 27 Jun 2019 07:11:32 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from inva020.nxp.com (inva020.nxp.com [92.121.34.13])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 44D246E42D
 for <dri-devel@lists.freedesktop.org>; Wed, 26 Jun 2019 13:32:24 +0000 (UTC)
Received: from inva020.nxp.com (localhost [127.0.0.1])
 by inva020.eu-rdc02.nxp.com (Postfix) with ESMTP id DEDA51A0A2B;
 Wed, 26 Jun 2019 15:32:22 +0200 (CEST)
Received: from inva024.eu-rdc02.nxp.com (inva024.eu-rdc02.nxp.com
 [134.27.226.22])
 by inva020.eu-rdc02.nxp.com (Postfix) with ESMTP id C63191A0A0B;
 Wed, 26 Jun 2019 15:32:22 +0200 (CEST)
Received: from fsr-ub1664-120.ea.freescale.net
 (fsr-ub1664-120.ea.freescale.net [10.171.82.81])
 by inva024.eu-rdc02.nxp.com (Postfix) with ESMTP id 218D7205DB;
 Wed, 26 Jun 2019 15:32:22 +0200 (CEST)
From: Robert Chiras <robert.chiras@nxp.com>
To: Marek Vasut <marex@denx.de>, Stefan Agner <stefan@agner.ch>,
 David Airlie <airlied@linux.ie>, Daniel Vetter <daniel@ffwll.ch>,
 Rob Herring <robh+dt@kernel.org>, Mark Rutland <mark.rutland@arm.com>,
 Shawn Guo <shawnguo@kernel.org>, Sascha Hauer <s.hauer@pengutronix.de>,
 Fabio Estevam <festevam@gmail.com>
Subject: [PATCH 01/10] drm/mxsfb: Update mxsfb to support a bridge
Date: Wed, 26 Jun 2019 16:32:09 +0300
Message-Id: <1561555938-21595-2-git-send-email-robert.chiras@nxp.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1561555938-21595-1-git-send-email-robert.chiras@nxp.com>
References: <1561555938-21595-1-git-send-email-robert.chiras@nxp.com>
X-Virus-Scanned: ClamAV using ClamSMTP
X-Mailman-Approved-At: Thu, 27 Jun 2019 07:11:26 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: devicetree@vger.kernel.org, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, NXP Linux Team <linux-imx@nxp.com>,
 Pengutronix Kernel Team <kernel@pengutronix.de>,
 Robert Chiras <robert.chiras@nxp.com>, linux-arm-kernel@lists.infradead.org
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

Q3VycmVudGx5LCB0aGUgTVhTRkIgRFJNIGRyaXZlciBvbmx5IHN1cHBvcnRzIGEgcGFuZWwuIEJ1
dCwgaXRzIG91dHB1dApkaXNwbGF5IHNpZ25hbCBjYW4gYWxzbyBiZSByZWRpcmVjdGVkIHRvIGFu
b3RoZXIgZW5jb2RlciwgbGlrZSBhIERTSQpjb250cm9sbGVyLiBJbiB0aGlzIGNhc2UsIHRoYXQg
RFNJIGNvbnRyb2xsZXIgbWF5IGFjdCBsaWtlIGEgZHJtX2JyaWRnZS4KSW4gb3JkZXIgc3VwcG9y
dCB0aGlzIHVzZS1jYXNlIHRvbywgdGhpcyBwYXRjaCBhZGRzIHN1cHBvcnQgZm9yCmRybV9icmlk
Z2UgaW4gbXhzZmIuCgpTaWduZWQtb2ZmLWJ5OiBSb2JlcnQgQ2hpcmFzIDxyb2JlcnQuY2hpcmFz
QG54cC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX2NydGMuYyB8IDQ2ICsr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tCiBkcml2ZXJzL2dwdS9kcm0vbXhz
ZmIvbXhzZmJfZHJ2LmMgIHwgNDYgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0t
LS0KIGRyaXZlcnMvZ3B1L2RybS9teHNmYi9teHNmYl9kcnYuaCAgfCAgNCArKystCiBkcml2ZXJz
L2dwdS9kcm0vbXhzZmIvbXhzZmJfb3V0LmMgIHwgMjYgKysrKysrKysrKystLS0tLS0tLS0tCiBk
cml2ZXJzL2dwdS9kcm0vbXhzZmIvbXhzZmJfcmVncy5oIHwgMTUgKysrKysrKysrKysrKwogNSBm
aWxlcyBjaGFuZ2VkLCAxMTYgaW5zZXJ0aW9ucygrKSwgMjEgZGVsZXRpb25zKC0pCgpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX2NydGMuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9teHNmYi9teHNmYl9jcnRjLmMKaW5kZXggOTNmNDEzMy4uMTRiZGUwMjQgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9teHNmYi9teHNmYl9jcnRjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L214c2ZiL214c2ZiX2NydGMuYwpAQCAtOTMsOCArOTMsMTEgQEAgc3RhdGljIHZvaWQgbXhzZmJf
c2V0X2J1c19mbXQoc3RydWN0IG14c2ZiX2RybV9wcml2YXRlICpteHNmYikKIAogCXJlZyA9IHJl
YWRsKG14c2ZiLT5iYXNlICsgTENEQ19DVFJMKTsKIAotCWlmIChteHNmYi0+Y29ubmVjdG9yLmRp
c3BsYXlfaW5mby5udW1fYnVzX2Zvcm1hdHMpCi0JCWJ1c19mb3JtYXQgPSBteHNmYi0+Y29ubmVj
dG9yLmRpc3BsYXlfaW5mby5idXNfZm9ybWF0c1swXTsKKwlpZiAobXhzZmItPmNvbm5lY3Rvci0+
ZGlzcGxheV9pbmZvLm51bV9idXNfZm9ybWF0cykKKwkJYnVzX2Zvcm1hdCA9IG14c2ZiLT5jb25u
ZWN0b3ItPmRpc3BsYXlfaW5mby5idXNfZm9ybWF0c1swXTsKKworCURSTV9ERVZfREVCVUdfRFJJ
VkVSKGRybS0+ZGV2LCAiVXNpbmcgYnVzX2Zvcm1hdDogMHglMDhYXG4iLAorCQkJICAgICBidXNf
Zm9ybWF0KTsKIAogCXJlZyAmPSB+Q1RSTF9CVVNfV0lEVEhfTUFTSzsKIAlzd2l0Y2ggKGJ1c19m
b3JtYXQpIHsKQEAgLTEyMiw2ICsxMjUsOSBAQCBzdGF0aWMgdm9pZCBteHNmYl9lbmFibGVfY29u
dHJvbGxlcihzdHJ1Y3QgbXhzZmJfZHJtX3ByaXZhdGUgKm14c2ZiKQogCQljbGtfcHJlcGFyZV9l
bmFibGUobXhzZmItPmNsa19kaXNwX2F4aSk7CiAJY2xrX3ByZXBhcmVfZW5hYmxlKG14c2ZiLT5j
bGspOwogCisJd3JpdGVsKENUUkwyX09VVFNUQU5ESU5HX1JFUVNfX1JFUV8xNiwKKwkgICAgICAg
bXhzZmItPmJhc2UgKyBMQ0RDX1Y0X0NUUkwyICsgUkVHX1NFVCk7CisKIAkvKiBJZiBpdCB3YXMg
ZGlzYWJsZWQsIHJlLWVuYWJsZSB0aGUgbW9kZSBhZ2FpbiAqLwogCXdyaXRlbChDVFJMX0RPVENM
S19NT0RFLCBteHNmYi0+YmFzZSArIExDRENfQ1RSTCArIFJFR19TRVQpOwogCkBAIC0xMzEsMTIg
KzEzNywxNSBAQCBzdGF0aWMgdm9pZCBteHNmYl9lbmFibGVfY29udHJvbGxlcihzdHJ1Y3QgbXhz
ZmJfZHJtX3ByaXZhdGUgKm14c2ZiKQogCXdyaXRlbChyZWcsIG14c2ZiLT5iYXNlICsgTENEQ19W
RENUUkw0KTsKIAogCXdyaXRlbChDVFJMX1JVTiwgbXhzZmItPmJhc2UgKyBMQ0RDX0NUUkwgKyBS
RUdfU0VUKTsKKwl3cml0ZWwoQ1RSTDFfUkVDT1ZFUllfT05fVU5ERVJGTE9XLCBteHNmYi0+YmFz
ZSArIExDRENfQ1RSTDEgKyBSRUdfU0VUKTsKIH0KIAogc3RhdGljIHZvaWQgbXhzZmJfZGlzYWJs
ZV9jb250cm9sbGVyKHN0cnVjdCBteHNmYl9kcm1fcHJpdmF0ZSAqbXhzZmIpCiB7CiAJdTMyIHJl
ZzsKIAorCXdyaXRlbChDVFJMX1JVTiwgbXhzZmItPmJhc2UgKyBMQ0RDX0NUUkwgKyBSRUdfQ0xS
KTsKKwogCS8qCiAJICogRXZlbiBpZiB3ZSBkaXNhYmxlIHRoZSBjb250cm9sbGVyIGhlcmUsIGl0
IHdpbGwgc3RpbGwgY29udGludWUKIAkgKiB1bnRpbCBpdHMgRklGT3MgYXJlIHJ1bm5pbmcgb3V0
IG9mIGRhdGEKQEAgLTIwMiw4ICsyMTEsOSBAQCBzdGF0aWMgZG1hX2FkZHJfdCBteHNmYl9nZXRf
ZmJfcGFkZHIoc3RydWN0IG14c2ZiX2RybV9wcml2YXRlICpteHNmYikKIAogc3RhdGljIHZvaWQg
bXhzZmJfY3J0Y19tb2RlX3NldF9ub2ZiKHN0cnVjdCBteHNmYl9kcm1fcHJpdmF0ZSAqbXhzZmIp
CiB7CisJc3RydWN0IGRybV9kZXZpY2UgKmRybSA9IG14c2ZiLT5waXBlLmNydGMuZGV2OwogCXN0
cnVjdCBkcm1fZGlzcGxheV9tb2RlICptID0gJm14c2ZiLT5waXBlLmNydGMuc3RhdGUtPmFkanVz
dGVkX21vZGU7Ci0JY29uc3QgdTMyIGJ1c19mbGFncyA9IG14c2ZiLT5jb25uZWN0b3IuZGlzcGxh
eV9pbmZvLmJ1c19mbGFnczsKKwljb25zdCB1MzIgYnVzX2ZsYWdzID0gbXhzZmItPmNvbm5lY3Rv
ci0+ZGlzcGxheV9pbmZvLmJ1c19mbGFnczsKIAl1MzIgdmRjdHJsMCwgdnN5bmNfcHVsc2VfbGVu
LCBoc3luY19wdWxzZV9sZW47CiAJaW50IGVycjsKIApAQCAtMjI3LDYgKzIzNywxMyBAQCBzdGF0
aWMgdm9pZCBteHNmYl9jcnRjX21vZGVfc2V0X25vZmIoc3RydWN0IG14c2ZiX2RybV9wcml2YXRl
ICpteHNmYikKIAogCWNsa19zZXRfcmF0ZShteHNmYi0+Y2xrLCBtLT5jcnRjX2Nsb2NrICogMTAw
MCk7CiAKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkcm0tPmRldiwgIlBpeGVsIGNsb2NrOiAlZGtI
eiAoYWN0dWFsOiAlZGtIeilcbiIsCisJCQkgICAgIG0tPmNydGNfY2xvY2ssCisJCQkgICAgIChp
bnQpKGNsa19nZXRfcmF0ZShteHNmYi0+Y2xrKSAvIDEwMDApKTsKKwlEUk1fREVWX0RFQlVHX0RS
SVZFUihkcm0tPmRldiwgIkNvbm5lY3RvciBidXNfZmxhZ3M6IDB4JTA4WFxuIiwKKwkJCSAgICAg
YnVzX2ZsYWdzKTsKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkcm0tPmRldiwgIk1vZGUgZmxhZ3M6
IDB4JTA4WFxuIiwgbS0+ZmxhZ3MpOworCiAJd3JpdGVsKFRSQU5TRkVSX0NPVU5UX1NFVF9WQ09V
TlQobS0+Y3J0Y192ZGlzcGxheSkgfAogCSAgICAgICBUUkFOU0ZFUl9DT1VOVF9TRVRfSENPVU5U
KG0tPmNydGNfaGRpc3BsYXkpLAogCSAgICAgICBteHNmYi0+YmFzZSArIG14c2ZiLT5kZXZkYXRh
LT50cmFuc2Zlcl9jb3VudCk7CkBAIC0yNzksNiArMjk2LDcgQEAgdm9pZCBteHNmYl9jcnRjX2Vu
YWJsZShzdHJ1Y3QgbXhzZmJfZHJtX3ByaXZhdGUgKm14c2ZiKQogCWRtYV9hZGRyX3QgcGFkZHI7
CiAKIAlteHNmYl9lbmFibGVfYXhpX2NsayhteHNmYik7CisJd3JpdGVsKDAsIG14c2ZiLT5iYXNl
ICsgTENEQ19DVFJMKTsKIAlteHNmYl9jcnRjX21vZGVfc2V0X25vZmIobXhzZmIpOwogCiAJLyog
V3JpdGUgY3VyX2J1ZiBhcyB3ZWxsIHRvIGF2b2lkIGFuIGluaXRpYWwgY29ycnVwdCBmcmFtZSAq
LwpAQCAtMzAyLDYgKzMyMCw4IEBAIHZvaWQgbXhzZmJfcGxhbmVfYXRvbWljX3VwZGF0ZShzdHJ1
Y3QgbXhzZmJfZHJtX3ByaXZhdGUgKm14c2ZiLAogewogCXN0cnVjdCBkcm1fc2ltcGxlX2Rpc3Bs
YXlfcGlwZSAqcGlwZSA9ICZteHNmYi0+cGlwZTsKIAlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSAm
cGlwZS0+Y3J0YzsKKwlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHBpcGUtPnBsYW5lLnN0
YXRlLT5mYjsKKwlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpvbGRfZmIgPSBvbGRfc3RhdGUtPmZi
OwogCXN0cnVjdCBkcm1fcGVuZGluZ192YmxhbmtfZXZlbnQgKmV2ZW50OwogCWRtYV9hZGRyX3Qg
cGFkZHI7CiAKQEAgLTMyNCw0ICszNDQsMjQgQEAgdm9pZCBteHNmYl9wbGFuZV9hdG9taWNfdXBk
YXRlKHN0cnVjdCBteHNmYl9kcm1fcHJpdmF0ZSAqbXhzZmIsCiAJCXdyaXRlbChwYWRkciwgbXhz
ZmItPmJhc2UgKyBteHNmYi0+ZGV2ZGF0YS0+bmV4dF9idWYpOwogCQlteHNmYl9kaXNhYmxlX2F4
aV9jbGsobXhzZmIpOwogCX0KKworCWlmICghZmIgfHwgIW9sZF9mYikKKwkJcmV0dXJuOworCisJ
LyoKKwkgKiBUT0RPOiBDdXJyZW50bHksIHdlIG9ubHkgc3VwcG9ydCBwaXhlbCBmb3JtYXQgY2hh
bmdlLCBidXQgd2UgbmVlZAorCSAqIGFsc28gdG8gY2FyZSBhYm91dCBzaXplIGNoYW5nZXMgdG9v
CisJICovCisJaWYgKG9sZF9mYi0+Zm9ybWF0LT5mb3JtYXQgIT0gZmItPmZvcm1hdC0+Zm9ybWF0
KSB7CisJCXN0cnVjdCBkcm1fZm9ybWF0X25hbWVfYnVmIG9sZF9mbXRfYnVmOworCQlzdHJ1Y3Qg
ZHJtX2Zvcm1hdF9uYW1lX2J1ZiBuZXdfZm10X2J1ZjsKKworCQlEUk1fREVWX0RFQlVHX0RSSVZF
UihjcnRjLT5kZXYtPmRldiwKKwkJCQkgICAgICJTd2l0Y2hpbmcgcGl4ZWwgZm9ybWF0OiAlcyAt
PiAlc1xuIiwKKwkJCQkgICAgIGRybV9nZXRfZm9ybWF0X25hbWUob2xkX2ZiLT5mb3JtYXQtPmZv
cm1hdCwKKwkJCQkJCQkgJm9sZF9mbXRfYnVmKSwKKwkJCQkgICAgIGRybV9nZXRfZm9ybWF0X25h
bWUoZmItPmZvcm1hdC0+Zm9ybWF0LAorCQkJCQkJCSAmbmV3X2ZtdF9idWYpKTsKKwkJbXhzZmJf
c2V0X3BpeGVsX2ZtdChteHNmYiwgdHJ1ZSk7CisJfQogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL214c2ZiL214c2ZiX2Rydi5jIGIvZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX2Ry
di5jCmluZGV4IDZmYWZjOTAuLjBkMTcxZTkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9t
eHNmYi9teHNmYl9kcnYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbXhzZmIvbXhzZmJfZHJ2LmMK
QEAgLTk4LDkgKzk4LDI1IEBAIHN0YXRpYyB2b2lkIG14c2ZiX3BpcGVfZW5hYmxlKHN0cnVjdCBk
cm1fc2ltcGxlX2Rpc3BsYXlfcGlwZSAqcGlwZSwKIAkJCSAgICAgIHN0cnVjdCBkcm1fY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCSAgICAgIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnBsYW5l
X3N0YXRlKQogeworCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3I7CiAJc3RydWN0IG14
c2ZiX2RybV9wcml2YXRlICpteHNmYiA9IGRybV9waXBlX3RvX214c2ZiX2RybV9wcml2YXRlKHBp
cGUpOwogCXN0cnVjdCBkcm1fZGV2aWNlICpkcm0gPSBwaXBlLT5wbGFuZS5kZXY7CiAKKwlpZiAo
IW14c2ZiLT5jb25uZWN0b3IpIHsKKwkJbGlzdF9mb3JfZWFjaF9lbnRyeShjb25uZWN0b3IsCisJ
CQkJICAgICZkcm0tPm1vZGVfY29uZmlnLmNvbm5lY3Rvcl9saXN0LAorCQkJCSAgICBoZWFkKQor
CQkJaWYgKGNvbm5lY3Rvci0+ZW5jb2RlciA9PSAmbXhzZmItPnBpcGUuZW5jb2RlcikgeworCQkJ
CW14c2ZiLT5jb25uZWN0b3IgPSBjb25uZWN0b3I7CisJCQkJYnJlYWs7CisJCQl9CisJfQorCisJ
aWYgKCFteHNmYi0+Y29ubmVjdG9yKSB7CisJCWRldl93YXJuKGRybS0+ZGV2LCAiTm8gY29ubmVj
dG9yIGF0dGFjaGVkLCB1c2luZyBkZWZhdWx0XG4iKTsKKwkJbXhzZmItPmNvbm5lY3RvciA9ICZt
eHNmYi0+cGFuZWxfY29ubmVjdG9yOworCX0KKwogCXBtX3J1bnRpbWVfZ2V0X3N5bmMoZHJtLT5k
ZXYpOwogCWRybV9wYW5lbF9wcmVwYXJlKG14c2ZiLT5wYW5lbCk7CiAJbXhzZmJfY3J0Y19lbmFi
bGUobXhzZmIpOwpAQCAtMTI2LDYgKzE0Miw5IEBAIHN0YXRpYyB2b2lkIG14c2ZiX3BpcGVfZGlz
YWJsZShzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUpCiAJCWRybV9jcnRjX3Nl
bmRfdmJsYW5rX2V2ZW50KGNydGMsIGV2ZW50KTsKIAl9CiAJc3Bpbl91bmxvY2tfaXJxKCZkcm0t
PmV2ZW50X2xvY2spOworCisJaWYgKG14c2ZiLT5jb25uZWN0b3IgIT0gJm14c2ZiLT5wYW5lbF9j
b25uZWN0b3IpCisJCW14c2ZiLT5jb25uZWN0b3IgPSBOVUxMOwogfQogCiBzdGF0aWMgdm9pZCBt
eHNmYl9waXBlX3VwZGF0ZShzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCkBA
IC0yMjMsMTYgKzI0MiwzMyBAQCBzdGF0aWMgaW50IG14c2ZiX2xvYWQoc3RydWN0IGRybV9kZXZp
Y2UgKmRybSwgdW5zaWduZWQgbG9uZyBmbGFncykKIAogCXJldCA9IGRybV9zaW1wbGVfZGlzcGxh
eV9waXBlX2luaXQoZHJtLCAmbXhzZmItPnBpcGUsICZteHNmYl9mdW5jcywKIAkJCW14c2ZiX2Zv
cm1hdHMsIEFSUkFZX1NJWkUobXhzZmJfZm9ybWF0cyksIE5VTEwsCi0JCQkmbXhzZmItPmNvbm5l
Y3Rvcik7CisJCQlteHNmYi0+Y29ubmVjdG9yKTsKIAlpZiAocmV0IDwgMCkgewogCQlkZXZfZXJy
KGRybS0+ZGV2LCAiQ2Fubm90IHNldHVwIHNpbXBsZSBkaXNwbGF5IHBpcGVcbiIpOwogCQlnb3Rv
IGVycl92Ymxhbms7CiAJfQogCi0JcmV0ID0gZHJtX3BhbmVsX2F0dGFjaChteHNmYi0+cGFuZWws
ICZteHNmYi0+Y29ubmVjdG9yKTsKLQlpZiAocmV0KSB7Ci0JCWRldl9lcnIoZHJtLT5kZXYsICJD
YW5ub3QgY29ubmVjdCBwYW5lbFxuIik7Ci0JCWdvdG8gZXJyX3ZibGFuazsKKwkvKgorCSAqIEF0
dGFjaCBwYW5lbCBvbmx5IGlmIHRoZXJlIGlzIG9uZS4KKwkgKiBJZiB0aGVyZSBpcyBubyBwYW5l
bCBhdHRhY2gsIGl0IG11c3QgYmUgYSBicmlkZ2UuIEluIHRoaXMgY2FzZSwgd2UKKwkgKiBuZWVk
IGEgcmVmZXJlbmNlIHRvIGl0cyBjb25uZWN0b3IgZm9yIGEgcHJvcGVyIGluaXRpYWxpemF0aW9u
LgorCSAqIFdlIHdpbGwgZG8gdGhpcyBjaGVjayBpbiBwaXBlLT5lbmFibGUoKSwgc2luY2UgdGhl
IGNvbm5lY3RvciB3b24ndAorCSAqIGJlIGF0dGFjaGVkIHRvIGFuIGVuY29kZXIgdW50aWwgdGhl
bi4KKwkgKi8KKworCWlmIChteHNmYi0+cGFuZWwpIHsKKwkJcmV0ID0gZHJtX3BhbmVsX2F0dGFj
aChteHNmYi0+cGFuZWwsIG14c2ZiLT5jb25uZWN0b3IpOworCQlpZiAocmV0KSB7CisJCQlkZXZf
ZXJyKGRybS0+ZGV2LCAiQ2Fubm90IGNvbm5lY3QgcGFuZWxcbiIpOworCQkJZ290byBlcnJfdmJs
YW5rOworCQl9CisJfSBlbHNlIGlmIChteHNmYi0+YnJpZGdlKSB7CisJCXJldCA9IGRybV9zaW1w
bGVfZGlzcGxheV9waXBlX2F0dGFjaF9icmlkZ2UoJm14c2ZiLT5waXBlLAorCQkJCQkJCSAgICBt
eHNmYi0+YnJpZGdlKTsKKwkJaWYgKHJldCkgeworCQkJZGV2X2Vycihkcm0tPmRldiwgIkNhbm5v
dCBjb25uZWN0IGJyaWRnZVxuIik7CisJCQlnb3RvIGVycl92Ymxhbms7CisJCX0KIAl9CiAKIAlk
cm0tPm1vZGVfY29uZmlnLm1pbl93aWR0aAk9IE1YU0ZCX01JTl9YUkVTOwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL214c2Zi
L214c2ZiX2Rydi5oCmluZGV4IGQ5NzUzMDAuLjBiNjViNTEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9teHNmYi9teHNmYl9kcnYuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbXhzZmIvbXhz
ZmJfZHJ2LmgKQEAgLTI3LDggKzI3LDEwIEBAIHN0cnVjdCBteHNmYl9kcm1fcHJpdmF0ZSB7CiAJ
c3RydWN0IGNsawkJCSpjbGtfZGlzcF9heGk7CiAKIAlzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5
X3BpcGUJcGlwZTsKLQlzdHJ1Y3QgZHJtX2Nvbm5lY3RvcgkJY29ubmVjdG9yOworCXN0cnVjdCBk
cm1fY29ubmVjdG9yCQlwYW5lbF9jb25uZWN0b3I7CisJc3RydWN0IGRybV9jb25uZWN0b3IJCSpj
b25uZWN0b3I7CiAJc3RydWN0IGRybV9wYW5lbAkJKnBhbmVsOworCXN0cnVjdCBkcm1fYnJpZGdl
CQkqYnJpZGdlOwogfTsKIAogaW50IG14c2ZiX3NldHVwX2NydGMoc3RydWN0IGRybV9kZXZpY2Ug
KmRldik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbXhzZmIvbXhzZmJfb3V0LmMgYi9k
cml2ZXJzL2dwdS9kcm0vbXhzZmIvbXhzZmJfb3V0LmMKaW5kZXggOTFlNzZmOS4uYjlhY2YyYiAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX291dC5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9teHNmYi9teHNmYl9vdXQuYwpAQCAtMjIsNyArMjIsOCBAQAogc3RhdGljIHN0
cnVjdCBteHNmYl9kcm1fcHJpdmF0ZSAqCiBkcm1fY29ubmVjdG9yX3RvX214c2ZiX2RybV9wcml2
YXRlKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCiB7Ci0JcmV0dXJuIGNvbnRhaW5l
cl9vZihjb25uZWN0b3IsIHN0cnVjdCBteHNmYl9kcm1fcHJpdmF0ZSwgY29ubmVjdG9yKTsKKwly
ZXR1cm4gY29udGFpbmVyX29mKGNvbm5lY3Rvciwgc3RydWN0IG14c2ZiX2RybV9wcml2YXRlLAor
CQkJICAgIHBhbmVsX2Nvbm5lY3Rvcik7CiB9CiAKIHN0YXRpYyBpbnQgbXhzZmJfcGFuZWxfZ2V0
X21vZGVzKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCkBAIC03NywyMiArNzgsMjMg
QEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX2Z1bmNzIG14c2ZiX3BhbmVsX2Nv
bm5lY3Rvcl9mdW5jcyA9IHsKIGludCBteHNmYl9jcmVhdGVfb3V0cHV0KHN0cnVjdCBkcm1fZGV2
aWNlICpkcm0pCiB7CiAJc3RydWN0IG14c2ZiX2RybV9wcml2YXRlICpteHNmYiA9IGRybS0+ZGV2
X3ByaXZhdGU7Ci0Jc3RydWN0IGRybV9wYW5lbCAqcGFuZWw7CiAJaW50IHJldDsKIAotCXJldCA9
IGRybV9vZl9maW5kX3BhbmVsX29yX2JyaWRnZShkcm0tPmRldi0+b2Zfbm9kZSwgMCwgMCwgJnBh
bmVsLCBOVUxMKTsKKwlyZXQgPSBkcm1fb2ZfZmluZF9wYW5lbF9vcl9icmlkZ2UoZHJtLT5kZXYt
Pm9mX25vZGUsIDAsIDAsCisJCQkJCSAgJm14c2ZiLT5wYW5lbCwgJm14c2ZiLT5icmlkZ2UpOwog
CWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKLQlteHNmYi0+Y29ubmVjdG9yLmRwbXMgPSBEUk1f
TU9ERV9EUE1TX09GRjsKLQlteHNmYi0+Y29ubmVjdG9yLnBvbGxlZCA9IDA7Ci0JZHJtX2Nvbm5l
Y3Rvcl9oZWxwZXJfYWRkKCZteHNmYi0+Y29ubmVjdG9yLAotCQkJJm14c2ZiX3BhbmVsX2Nvbm5l
Y3Rvcl9oZWxwZXJfZnVuY3MpOwotCXJldCA9IGRybV9jb25uZWN0b3JfaW5pdChkcm0sICZteHNm
Yi0+Y29ubmVjdG9yLAotCQkJCSAmbXhzZmJfcGFuZWxfY29ubmVjdG9yX2Z1bmNzLAotCQkJCSBE
Uk1fTU9ERV9DT05ORUNUT1JfVW5rbm93bik7Ci0JaWYgKCFyZXQpCi0JCW14c2ZiLT5wYW5lbCA9
IHBhbmVsOworCWlmIChteHNmYi0+cGFuZWwpIHsKKwkJbXhzZmItPmNvbm5lY3RvciA9ICZteHNm
Yi0+cGFuZWxfY29ubmVjdG9yOworCQlteHNmYi0+Y29ubmVjdG9yLT5kcG1zID0gRFJNX01PREVf
RFBNU19PRkY7CisJCW14c2ZiLT5jb25uZWN0b3ItPnBvbGxlZCA9IDA7CisJCWRybV9jb25uZWN0
b3JfaGVscGVyX2FkZChteHNmYi0+Y29ubmVjdG9yLAorCQkJCQkgJm14c2ZiX3BhbmVsX2Nvbm5l
Y3Rvcl9oZWxwZXJfZnVuY3MpOworCQlyZXQgPSBkcm1fY29ubmVjdG9yX2luaXQoZHJtLCBteHNm
Yi0+Y29ubmVjdG9yLAorCQkJCQkgJm14c2ZiX3BhbmVsX2Nvbm5lY3Rvcl9mdW5jcywKKwkJCQkJ
IERSTV9NT0RFX0NPTk5FQ1RPUl9Vbmtub3duKTsKKwl9CiAKIAlyZXR1cm4gcmV0OwogfQpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX3JlZ3MuaCBiL2RyaXZlcnMvZ3B1
L2RybS9teHNmYi9teHNmYl9yZWdzLmgKaW5kZXggOTMyZDdlYS4uNzE0MjZhYSAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX3JlZ3MuaAorKysgYi9kcml2ZXJzL2dwdS9k
cm0vbXhzZmIvbXhzZmJfcmVncy5oCkBAIC0xNCwxOSArMTQsMzEgQEAKIAogI2RlZmluZSBMQ0RD
X0NUUkwJCQkweDAwCiAjZGVmaW5lIExDRENfQ1RSTDEJCQkweDEwCisjZGVmaW5lIExDRENfVjRf
Q1RSTDIJCQkweDIwCiAjZGVmaW5lIExDRENfVjNfVFJBTlNGRVJfQ09VTlQJCTB4MjAKICNkZWZp
bmUgTENEQ19WNF9UUkFOU0ZFUl9DT1VOVAkJMHgzMAogI2RlZmluZSBMQ0RDX1Y0X0NVUl9CVUYJ
CQkweDQwCiAjZGVmaW5lIExDRENfVjRfTkVYVF9CVUYJCTB4NTAKICNkZWZpbmUgTENEQ19WM19D
VVJfQlVGCQkJMHgzMAogI2RlZmluZSBMQ0RDX1YzX05FWFRfQlVGCQkweDQwCisjZGVmaW5lIExD
RENfVElNSU5HCQkJMHg2MAogI2RlZmluZSBMQ0RDX1ZEQ1RSTDAJCQkweDcwCiAjZGVmaW5lIExD
RENfVkRDVFJMMQkJCTB4ODAKICNkZWZpbmUgTENEQ19WRENUUkwyCQkJMHg5MAogI2RlZmluZSBM
Q0RDX1ZEQ1RSTDMJCQkweGEwCiAjZGVmaW5lIExDRENfVkRDVFJMNAkJCTB4YjAKKyNkZWZpbmUg
TENEQ19EVklDVFJMMAkJCTB4YzAKKyNkZWZpbmUgTENEQ19EVklDVFJMMQkJCTB4ZDAKKyNkZWZp
bmUgTENEQ19EVklDVFJMMgkJCTB4ZTAKKyNkZWZpbmUgTENEQ19EVklDVFJMMwkJCTB4ZjAKKyNk
ZWZpbmUgTENEQ19EVklDVFJMNAkJCTB4MTAwCisjZGVmaW5lIExDRENfVjRfREFUQQkJCTB4MTgw
CisjZGVmaW5lIExDRENfVjNfREFUQQkJCTB4MWIwCiAjZGVmaW5lIExDRENfVjRfREVCVUcwCQkJ
MHgxZDAKICNkZWZpbmUgTENEQ19WM19ERUJVRzAJCQkweDFmMAorI2RlZmluZSBMQ0RDX0FTX0NU
UkwJCQkweDIxMAorI2RlZmluZSBMQ0RDX0FTX0JVRgkJCTB4MjIwCisjZGVmaW5lIExDRENfQVNf
TkVYVF9CVUYJCTB4MjMwCiAKICNkZWZpbmUgQ1RSTF9TRlRSU1QJCQkoMSA8PCAzMSkKICNkZWZp
bmUgQ1RSTF9DTEtHQVRFCQkJKDEgPDwgMzApCkBAIC00NSwxMiArNTcsMTUgQEAKICNkZWZpbmUg
Q1RSTF9ERjI0CQkJKDEgPDwgMSkKICNkZWZpbmUgQ1RSTF9SVU4JCQkoMSA8PCAwKQogCisjZGVm
aW5lIENUUkwxX1JFQ09WRVJZX09OX1VOREVSRkxPVwkoMSA8PCAyNCkKICNkZWZpbmUgQ1RSTDFf
RklGT19DTEVBUgkJKDEgPDwgMjEpCiAjZGVmaW5lIENUUkwxX1NFVF9CWVRFX1BBQ0tBR0lORyh4
KQkoKCh4KSAmIDB4ZikgPDwgMTYpCiAjZGVmaW5lIENUUkwxX0dFVF9CWVRFX1BBQ0tBR0lORyh4
KQkoKCh4KSA+PiAxNikgJiAweGYpCiAjZGVmaW5lIENUUkwxX0NVUl9GUkFNRV9ET05FX0lSUV9F
TgkoMSA8PCAxMykKICNkZWZpbmUgQ1RSTDFfQ1VSX0ZSQU1FX0RPTkVfSVJRCSgxIDw8IDkpCiAK
KyNkZWZpbmUgQ1RSTDJfT1VUU1RBTkRJTkdfUkVRU19fUkVRXzE2CQkoNCA8PCAyMSkKKwogI2Rl
ZmluZSBUUkFOU0ZFUl9DT1VOVF9TRVRfVkNPVU5UKHgpCSgoKHgpICYgMHhmZmZmKSA8PCAxNikK
ICNkZWZpbmUgVFJBTlNGRVJfQ09VTlRfR0VUX1ZDT1VOVCh4KQkoKCh4KSA+PiAxNikgJiAweGZm
ZmYpCiAjZGVmaW5lIFRSQU5TRkVSX0NPVU5UX1NFVF9IQ09VTlQoeCkJKCh4KSAmIDB4ZmZmZikK
LS0gCjIuNy40CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
XwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcK
aHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
