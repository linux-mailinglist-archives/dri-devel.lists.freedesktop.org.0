Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 19173839ED
	for <lists+dri-devel@lfdr.de>; Tue,  6 Aug 2019 21:57:39 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D95976E546;
	Tue,  6 Aug 2019 19:57:34 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0BBA56E542;
 Tue,  6 Aug 2019 19:57:32 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 17909986-1500050 for multiple; Tue, 06 Aug 2019 20:57:28 +0100
MIME-Version: 1.0
From: Chris Wilson <chris@chris-wilson.co.uk>
User-Agent: alot/0.6
To: =?utf-8?q?Christian_K=C3=B6nig?= <ckoenig.leichtzumerken@gmail.com>,
 dri-devel@lists.freedesktop.org, intel-gfx@lists.freedesktop.org,
 linaro-mm-sig@lists.linaro.org
References: <20190806150134.104222-1-christian.koenig@amd.com>
 <20190806150134.104222-8-christian.koenig@amd.com>
In-Reply-To: <20190806150134.104222-8-christian.koenig@amd.com>
Message-ID: <156512144622.6198.5051468008483309313@skylake-alporthouse-com>
Subject: Re: [PATCH 8/8] dma-buf: nuke reservation_object seq number
Date: Tue, 06 Aug 2019 20:57:26 +0100
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

UXVvdGluZyBDaHJpc3RpYW4gS8O2bmlnICgyMDE5LTA4LTA2IDE2OjAxOjM0KQo+IFRoZSBvbmx5
IHJlbWFpbmluZyB1c2UgZm9yIHRoaXMgaXMgdG8gcHJvdGVjdCBhZ2FpbnN0IHNldHRpbmcgYSBu
ZXcgZXhjbHVzaXZlCj4gZmVuY2Ugd2hpbGUgd2UgZ3JhYiBib3RoIGV4Y2x1c2l2ZSBhbmQgc2hh
cmVkLiBUaGF0IGNhbiBhbHNvIGJlIGFyY2hpdmVkIGJ5Cj4gbG9va2luZyBpZiB0aGUgZXhjbHVz
aXZlIGZlbmNlIGhhcyBjaGFuZ2VkIG9yIG5vdCBhZnRlciBjb21wbGV0aW5nIHRoZQo+IG9wZXJh
dGlvbi4KPiAKPiBTaWduZWQtb2ZmLWJ5OiBDaHJpc3RpYW4gS8O2bmlnIDxjaHJpc3RpYW4ua29l
bmlnQGFtZC5jb20+Cj4gLS0tCj4gIGRyaXZlcnMvZG1hLWJ1Zi9yZXNlcnZhdGlvbi5jIHwgMjAg
KysrLS0tLS0tLS0tLS0tLS0tLS0KPiAgaW5jbHVkZS9saW51eC9yZXNlcnZhdGlvbi5oICAgfCAg
OSArKy0tLS0tLS0KPiAgMiBmaWxlcyBjaGFuZ2VkLCA1IGluc2VydGlvbnMoKyksIDI0IGRlbGV0
aW9ucygtKQo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2RtYS1idWYvcmVzZXJ2YXRpb24uYyBi
L2RyaXZlcnMvZG1hLWJ1Zi9yZXNlcnZhdGlvbi5jCj4gaW5kZXggODM5ZDcyYWY3YWQ4Li40MzU0
OWE0ZDY2NTggMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9kbWEtYnVmL3Jlc2VydmF0aW9uLmMKPiAr
KysgYi9kcml2ZXJzL2RtYS1idWYvcmVzZXJ2YXRpb24uYwo+IEBAIC00OSwxMiArNDksNiBAQAo+
ICBERUZJTkVfV0RfQ0xBU1MocmVzZXJ2YXRpb25fd3dfY2xhc3MpOwo+ICBFWFBPUlRfU1lNQk9M
KHJlc2VydmF0aW9uX3d3X2NsYXNzKTsKPiAgCj4gLXN0cnVjdCBsb2NrX2NsYXNzX2tleSByZXNl
cnZhdGlvbl9zZXFjb3VudF9jbGFzczsKPiAtRVhQT1JUX1NZTUJPTChyZXNlcnZhdGlvbl9zZXFj
b3VudF9jbGFzcyk7Cj4gLQo+IC1jb25zdCBjaGFyIHJlc2VydmF0aW9uX3NlcWNvdW50X3N0cmlu
Z1tdID0gInJlc2VydmF0aW9uX3NlcWNvdW50IjsKPiAtRVhQT1JUX1NZTUJPTChyZXNlcnZhdGlv
bl9zZXFjb3VudF9zdHJpbmcpOwo+IC0KPiAgLyoqCj4gICAqIHJlc2VydmF0aW9uX29iamVjdF9s
aXN0X2FsbG9jIC0gYWxsb2NhdGUgZmVuY2UgbGlzdAo+ICAgKiBAc2hhcmVkX21heDogbnVtYmVy
IG9mIGZlbmNlcyB3ZSBuZWVkIHNwYWNlIGZvcgo+IEBAIC0xMDMsOSArOTcsNiBAQCBzdGF0aWMg
dm9pZCByZXNlcnZhdGlvbl9vYmplY3RfbGlzdF9mcmVlKHN0cnVjdCByZXNlcnZhdGlvbl9vYmpl
Y3RfbGlzdCAqbGlzdCkKPiAgdm9pZCByZXNlcnZhdGlvbl9vYmplY3RfaW5pdChzdHJ1Y3QgcmVz
ZXJ2YXRpb25fb2JqZWN0ICpvYmopCj4gIHsKPiAgICAgICAgIHd3X211dGV4X2luaXQoJm9iai0+
bG9jaywgJnJlc2VydmF0aW9uX3d3X2NsYXNzKTsKPiAtCj4gLSAgICAgICBfX3NlcWNvdW50X2lu
aXQoJm9iai0+c2VxLCByZXNlcnZhdGlvbl9zZXFjb3VudF9zdHJpbmcsCj4gLSAgICAgICAgICAg
ICAgICAgICAgICAgJnJlc2VydmF0aW9uX3NlcWNvdW50X2NsYXNzKTsKPiAgICAgICAgIFJDVV9J
TklUX1BPSU5URVIob2JqLT5mZW5jZSwgTlVMTCk7Cj4gICAgICAgICBSQ1VfSU5JVF9QT0lOVEVS
KG9iai0+ZmVuY2VfZXhjbCwgTlVMTCk7Cj4gIH0KPiBAQCAtMjgyLDEyICsyNzMsMTAgQEAgdm9p
ZCByZXNlcnZhdGlvbl9vYmplY3RfYWRkX2V4Y2xfZmVuY2Uoc3RydWN0IHJlc2VydmF0aW9uX29i
amVjdCAqb2JqLAo+ICAgICAgICAgICAgICAgICBkbWFfZmVuY2VfZ2V0KGZlbmNlKTsKPiAgCj4g
ICAgICAgICBwcmVlbXB0X2Rpc2FibGUoKTsKPiAtICAgICAgIHdyaXRlX3NlcWNvdW50X2JlZ2lu
KCZvYmotPnNlcSk7Cj4gLSAgICAgICAvKiB3cml0ZV9zZXFjb3VudF9iZWdpbiBwcm92aWRlcyB0
aGUgbmVjZXNzYXJ5IG1lbW9yeSBiYXJyaWVyICovCj4gICAgICAgICBSQ1VfSU5JVF9QT0lOVEVS
KG9iai0+ZmVuY2VfZXhjbCwgZmVuY2UpOwoKSSB0aGluaywgbm93IGhhcyB0byBiZSByY3VfYXNz
aWduX3BvaW50ZXIuCgogKiBJbml0aWFsaXplIGFuIFJDVS1wcm90ZWN0ZWQgcG9pbnRlciBpbiBz
cGVjaWFsIGNhc2VzIHdoZXJlIHJlYWRlcnMKICogZG8gbm90IG5lZWQgb3JkZXJpbmcgY29uc3Ry
YWludHMgb24gdGhlIENQVSBvciB0aGUgY29tcGlsZXIuICBUaGVzZQogKiBzcGVjaWFsIGNhc2Vz
IGFyZToKICoKICogMS4gICBUaGlzIHVzZSBvZiBSQ1VfSU5JVF9QT0lOVEVSKCkgaXMgTlVMTGlu
ZyBvdXQgdGhlIHBvaW50ZXIgKm9yKgogKiAyLiAgIFRoZSBjYWxsZXIgaGFzIHRha2VuIHdoYXRl
dmVyIHN0ZXBzIGFyZSByZXF1aXJlZCB0byBwcmV2ZW50CiAqICAgICAgUkNVIHJlYWRlcnMgZnJv
bSBjb25jdXJyZW50bHkgYWNjZXNzaW5nIHRoaXMgcG9pbnRlciAqb3IqCiAqIDMuICAgVGhlIHJl
ZmVyZW5jZWQgZGF0YSBzdHJ1Y3R1cmUgaGFzIGFscmVhZHkgYmVlbiBleHBvc2VkIHRvCiAqICAg
ICAgcmVhZGVycyBlaXRoZXIgYXQgY29tcGlsZSB0aW1lIG9yIHZpYSByY3VfYXNzaWduX3BvaW50
ZXIoKSAqYW5kKgogKgogKiAgICAgIGEuICAgICAgWW91IGhhdmUgbm90IG1hZGUgKmFueSogcmVh
ZGVyLXZpc2libGUgY2hhbmdlcyB0bwogKiAgICAgICAgICAgICAgdGhpcyBzdHJ1Y3R1cmUgc2lu
Y2UgdGhlbiAqb3IqCiAqICAgICAgYi4gICAgICBJdCBpcyBPSyBmb3IgcmVhZGVycyBhY2Nlc3Np
bmcgdGhpcyBzdHJ1Y3R1cmUgZnJvbSBpdHMKICogICAgICAgICAgICAgIG5ldyBsb2NhdGlvbiB0
byBzZWUgdGhlIG9sZCBzdGF0ZSBvZiB0aGUgc3RydWN0dXJlLiAgKEZvcgogKiAgICAgICAgICAg
ICAgZXhhbXBsZSwgdGhlIGNoYW5nZXMgd2VyZSB0byBzdGF0aXN0aWNhbCBjb3VudGVycyBvciB0
bwogKiAgICAgICAgICAgICAgb3RoZXIgc3RhdGUgd2hlcmUgZXhhY3Qgc3luY2hyb25pemF0aW9u
IGlzIG5vdCByZXF1aXJlZC4pCgpXZSB1c2VkIHRvIGFwcGx5IDIgZnJvbSB0aGUgc2VxY291bnQs
IGFuZCAzIGRvZXMgbm90IGFwcGx5IGhlcmUuCgo+ICsgICAgICAgLyogcG9pbnRlciB1cGRhdGUg
bXVzdCBiZSB2aXNpYmxlIGJlZm9yZSB3ZSBtb2RpZnkgdGhlIHNoYXJlZF9jb3VudCAqLwo+ICAg
ICAgICAgaWYgKG9sZCkKPiAtICAgICAgICAgICAgICAgb2xkLT5zaGFyZWRfY291bnQgPSAwOwo+
IC0gICAgICAgd3JpdGVfc2VxY291bnRfZW5kKCZvYmotPnNlcSk7Cj4gKyAgICAgICAgICAgICAg
IHNtcF9zdG9yZV9tYihvbGQtPnNoYXJlZF9jb3VudCwgMCk7CgpIbW0uIE9rLCBJIHRoaW5rLgoK
PiAgewo+IC0gICAgICAgdW5zaWduZWQgaW50IHNlcTsKPiAtCj4gICAgICAgICBkbyB7Cj4gLSAg
ICAgICAgICAgICAgIHNlcSA9IHJlYWRfc2VxY291bnRfYmVnaW4oJm9iai0+c2VxKTsKPiAgICAg
ICAgICAgICAgICAgKmV4Y2wgPSByY3VfZGVyZWZlcmVuY2Uob2JqLT5mZW5jZV9leGNsKTsKPiAg
ICAgICAgICAgICAgICAgKmxpc3QgPSByY3VfZGVyZWZlcmVuY2Uob2JqLT5mZW5jZSk7Cj4gLSAg
ICAgICB9IHdoaWxlIChyZWFkX3NlcWNvdW50X3JldHJ5KCZvYmotPnNlcSwgc2VxKSk7Cj4gKyAg
ICAgICAgICAgICAgIHNtcF9ybWIoKTsgLyogU2VlIHJlc2VydmF0aW9uX29iamVjdF9hZGRfZXhj
bF9mZW5jZSAqLwo+ICsgICAgICAgfSB3aGlsZSAocmN1X2FjY2Vzc19wb2ludGVyKG9iai0+ZmVu
Y2VfZXhjbCkgIT0gKmV4Y2wpOwo+ICB9CgpTbywgaWYgd2UgYXJlIGFkZF9leGNsX2ZlbmNlIGFu
ZCBjYW5jZWxsaW5nIGEgc2hhcmVkLWxpc3QsIGJlZm9yZSB3ZQpyZXR1cm4gd2UgZ3VhcmFudGVl
IHRoYXQgdGhlIHNoYXJlZC1saXN0IGlzIHNldCB0byB6ZXJvIGlmIGV4Y2wgaXMgc2V0CmFzIHdl
IHJlYWQuCgpJZiB3ZSBhZGQgdG8gc2hhcmVkLWxpc3QgZHVyaW5nIHRoZSByZWFkLCAuLi4gSG1t
LCBhY3R1YWxseSB3ZSBzaG91bGQKcmV0dXJuIG51bV9saXN0LCBpLmUuCgpkbyB7CgkqbGlzdCA9
IHJjdV9kZXJlZmVyZW5jZShvYmotPmZlbmNlKTsKCW51bV9saXN0ID0gKmxpc3QgPyAoKmxpc3Qp
LT5jb3VudCA6IDA7CglzbXBfcm1iKCk7Cn0gd2hpbGUgKC4uLikKCnJldHVybiBudW1fbGlzdC4K
CmFzIHRoZSByZWxhdGlvbnNoaXAgYmV0d2VlbiB0aGUgY291bnQgYW5kIHRoZSBmZW5jZSBlbnRy
aWVzIGlzIGFsc28KZGV0ZXJtaW5lZCBieSB0aGUgbWIgaW4gYWRkX3NoYXJlZF9mZW5jZS4KCk9v
cHMsIHRoYXQgd2FzIGFuIG92ZXJzaWdodCBpbiB0aGUgcHJldmlvdXMgcmV2aWV3LgoKPiAgICAg
ICAgIHByZWVtcHRfZW5hYmxlKCk7Cj4gIAo+ICAgICAgICAgLyogaW5wbGFjZSB1cGRhdGUsIG5v
IHNoYXJlZCBmZW5jZXMgKi8KPiBAQCAtMzcwLDExICszNTksOCBAQCBpbnQgcmVzZXJ2YXRpb25f
b2JqZWN0X2NvcHlfZmVuY2VzKHN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKmRzdCwKPiAgICAg
ICAgIG9sZCA9IHJlc2VydmF0aW9uX29iamVjdF9nZXRfZXhjbChkc3QpOwo+ICAKPiAgICAgICAg
IHByZWVtcHRfZGlzYWJsZSgpOwo+IC0gICAgICAgd3JpdGVfc2VxY291bnRfYmVnaW4oJmRzdC0+
c2VxKTsKPiAtICAgICAgIC8qIHdyaXRlX3NlcWNvdW50X2JlZ2luIHByb3ZpZGVzIHRoZSBuZWNl
c3NhcnkgbWVtb3J5IGJhcnJpZXIgKi8KPiAgICAgICAgIFJDVV9JTklUX1BPSU5URVIoZHN0LT5m
ZW5jZV9leGNsLCBuZXcpOwoKcmN1X2Fzc2lnbl9wb2ludGVyIGFnYWluIEkgYmVsaWV2ZS4KLUNo
cmlzCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1k
ZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczov
L2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
