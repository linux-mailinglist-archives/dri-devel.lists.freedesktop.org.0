Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id B0E71F59DC
	for <lists+dri-devel@lfdr.de>; Fri,  8 Nov 2019 22:29:14 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 707136FA91;
	Fri,  8 Nov 2019 21:29:12 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mo6-p01-ob.smtp.rzone.de (mo6-p01-ob.smtp.rzone.de
 [IPv6:2a01:238:20a:202:5301::5])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E4D096FA90;
 Fri,  8 Nov 2019 21:29:10 +0000 (UTC)
X-RZG-AUTH: ":P3gBZUipdd93FF5ZZvYFPugejmSTVR2nRPhVORvLd4SsytBXQrEOHTIXsMnvtxdYcg=="
X-RZG-CLASS-ID: mo00
Received: from localhost.localdomain by smtp.strato.de (RZmta 44.29.0 AUTH)
 with ESMTPSA id e07688vA8LT6tLL
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (curve secp521r1 with
 521 ECDH bits, eq. 15360 bits RSA))
 (Client did not present a certificate);
 Fri, 8 Nov 2019 22:29:06 +0100 (CET)
From: Stephan Gerhold <stephan@gerhold.net>
To: Rob Clark <robdclark@gmail.com>,
	Sean Paul <sean@poorly.run>
Subject: [PATCH] drm/msm/dsi: Delay drm_panel_enable() until
 dsi_mgr_bridge_enable()
Date: Fri,  8 Nov 2019 22:28:40 +0100
Message-Id: <20191108212840.13586-1-stephan@gerhold.net>
X-Mailer: git-send-email 2.23.0
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 t=1573248548; 
 s=strato-dkim-0002; d=gerhold.net;
 h=Message-Id:Date:Subject:Cc:To:From:X-RZG-CLASS-ID:X-RZG-AUTH:From:
 Subject:Sender;
 bh=RpCrO/BdsXbNks/Ok4F1Wqjf9N5GuN0H6cCDR5uSLF0=;
 b=FVW+PId/VIUw0CtYzhhpGfUC5M1i61G78o3p41B5qNzMtDr8RJjFDa6lb7Fo/PU7ud
 BPMf6hEj2lbGZMBm1jZjRmSArKvyo6bNIK46TuLv2EE1uy01cess8OKpvROsm2MFUD8p
 hVMJjaad2ZJg9LPIq0nrBEj39lJ2z4XOIvr4PBLULUebs/kluhXW+Uygrz6+lRjW3ODH
 STFsb8khtuX2dK3RJkuiJpUP1f+AIBJdr4bcb20HmvmAwZR53hLs1v9wyOt6W6tbGRnt
 zysEEZsr4H+eMOYdDc7FhwY7Rc/J1f2xjpKobDOHd4zRfZ9IMgQCFFXaseL2SmMW1pRL
 EdhQ==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Jasper Korten <jja2000@gmail.com>, Hai Li <hali@codeaurora.org>,
 Stephan Gerhold <stephan@gerhold.net>, David Airlie <airlied@linux.ie>,
 linux-arm-msm@vger.kernel.org, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, freedreno@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QXQgdGhlIG1vbWVudCwgdGhlIE1TTSBEU0kgZHJpdmVyIGNhbGxzIGRybV9wYW5lbF9lbmFibGUo
KSByYXRoZXIgZWFybHkKZnJvbSB0aGUgRFNJIGJyaWRnZSBwcmVfZW5hYmxlKCkgZnVuY3Rpb24u
IEF0IHRoaXMgcG9pbnQsIHRoZSBlbmNvZGVyCihlLmcuIE1EUDUpIGlzIG5vdCBlbmFibGVkLCBz
byB3ZSBoYXZlIG5vdCBzdGFydGVkIHRyYW5zbWl0dGluZwp2aWRlbyBkYXRhLgoKSG93ZXZlciwg
dGhlIGRybV9wYW5lbF9mdW5jcyBkb2N1bWVudGF0aW9uIHN0YXRlcyB0aGF0IGVuYWJsZSgpCnNo
b3VsZCBiZSBjYWxsZWQgb24gdGhlIHBhbmVsICphZnRlciogdmlkZW8gZGF0YSBpcyBiZWluZyB0
cmFuc21pdHRlZDoKCiAgVGhlIC5wcmVwYXJlKCkgZnVuY3Rpb24gaXMgdHlwaWNhbGx5IGNhbGxl
ZCBiZWZvcmUgdGhlIGRpc3BsYXkgY29udHJvbGxlcgogIHN0YXJ0cyB0byB0cmFuc21pdCB2aWRl
byBkYXRhLiBbLi4uXSBBZnRlciB0aGUgZGlzcGxheSBjb250cm9sbGVyIGhhcwogIHN0YXJ0ZWQg
dHJhbnNtaXR0aW5nIHZpZGVvIGRhdGEsIGl0J3Mgc2FmZSB0byBjYWxsIHRoZSAuZW5hYmxlKCkg
ZnVuY3Rpb24uCiAgVGhpcyB3aWxsIHR5cGljYWxseSBlbmFibGUgdGhlIGJhY2tsaWdodCB0byBt
YWtlIHRoZSBpbWFnZSBvbiBzY3JlZW4gdmlzaWJsZS4KCkNhbGxpbmcgZHJtX3BhbmVsX2VuYWJs
ZSgpIHRvbyBlYXJseSBjYXVzZXMgcHJvYmxlbXMgZm9yIHNvbWUgcGFuZWxzOgpUaGUgVEZUIExD
RCBwYW5lbCB1c2VkIGluIHRoZSBTYW1zdW5nIEdhbGF4eSBUYWIgQSA5LjcgKDIwMTUpIChBUFE4
MDE2KQp1c2VzIHRoZSBNSVBJX0RDU19TRVRfRElTUExBWV9CUklHSFRORVNTIGNvbW1hbmQgdG8g
Y29udHJvbApiYWNrbGlnaHQvYnJpZ2h0bmVzcyBvZiB0aGUgc2NyZWVuLiBUaGUgZW5hYmxlIHNl
cXVlbmNlIGlzIHRoZXJlZm9yZToKCiAgZHJtX3BhbmVsX2VuYWJsZSgpCiAgICBkcm1fcGFuZWxf
ZnVuY3MuZW5hYmxlKCk6CiAgICAgIGJhY2tsaWdodF9lbmFibGUoKQogICAgICAgIGJhY2tsaWdo
dF9vcHMudXBkYXRlX3N0YXR1cygpOgogICAgICAgICAgbWlwaV9kc2lfZGNzX3NldF9kaXNwbGF5
X2JyaWdodG5lc3MoZHNpLCBibC0+cHJvcHMuYnJpZ2h0bmVzcyk7CgpUaGUgcGFuZWwgc2VlbXMg
dG8gc2lsZW50bHkgaWdub3JlIHRoZSBNSVBJX0RDU19TRVRfRElTUExBWV9CUklHSFRORVNTCmNv
bW1hbmQgaWYgaXQgaXMgc2VudCB0b28gZWFybHkuIFRoaXMgcHJldmVudHMgc2V0dGluZyB0aGUg
aW5pdGlhbCBicmlnaHRuZXNzLApjYXVzaW5nIHRoZSBkaXNwbGF5IHRvIGJlIGVuYWJsZWQgd2l0
aCBtaW5pbXVtIGJyaWdodG5lc3MgaW5zdGVhZC4KQWRkaW5nIHZhcmlvdXMgZGVsYXlzIGluIHRo
ZSBwYW5lbCBpbml0aWFsaXphdGlvbiBjb2RlIGRvZXMgbm90IHJlc3VsdAppbiBhbnkgZGlmZmVy
ZW5jZS4KCk9uIHRoZSBvdGhlciBoYW5kLCBtb3ZpbmcgZHJtX3BhbmVsX2VuYWJsZSgpIHRvIGRz
aV9tZ3JfYnJpZGdlX2VuYWJsZSgpCmZpeGVzIHRoZSBwcm9ibGVtLCBpbmRpY2F0aW5nIHRoYXQg
dGhlIHBhbmVsIHJlcXVpcmVzIHRoZSB2aWRlbyBzdHJlYW0KdG8gYmUgYWN0aXZlIGJlZm9yZSB0
aGUgYnJpZ2h0bmVzcyBjb21tYW5kIGlzIGFjY2VwdGVkLgoKVGhlcmVmb3JlOiBNb3ZlIGRybV9w
YW5lbF9lbmFibGUoKSB0byBkc2lfbWdyX2JyaWRnZV9lbmFibGUoKSB0bwpkZWxheSBjYWxsaW5n
IGl0IHVudGlsIHZpZGVvIGRhdGEgaXMgYmVpbmcgdHJhbnNtaXR0ZWQuCgpNb3ZlIGRybV9wYW5l
bF9kaXNhYmxlKCkgdG8gZHNpX21ncl9icmlkZ2VfZGlzYWJsZSgpIGZvciBzaW1pbGFyIHJlYXNv
bnMuCihUaGlzIGlzIG5vdCBzdHJpY3RseSByZXF1aXJlZCBmb3IgdGhlIHBhbmVsIGFmZmVjdGVk
IGFib3ZlLi4uKQoKVGVzdGVkLWJ5OiBKYXNwZXIgS29ydGVuIDxqamEyMDAwQGdtYWlsLmNvbT4K
U2lnbmVkLW9mZi1ieTogU3RlcGhhbiBHZXJob2xkIDxzdGVwaGFuQGdlcmhvbGQubmV0PgotLS0K
U2luY2UgdGhpcyBpcyBhIGNvcmUgY2hhbmdlIEkgdGhvdWdodCBpdCB3b3VsZCBiZSBiZXR0ZXIg
dG8gc2VuZCB0aGlzCmVhcmx5LiBJIGJlbGlldmUgSmFzcGVyIHN0aWxsIHdhbnRzIHRvIGZpbmlz
aCBzb21lIG90aGVyIGNoYW5nZXMgYmVmb3JlCnN1Ym1pdHRpbmcgdGhlIGluaXRpYWwgZGV2aWNl
IHRyZWUgZm9yIHRoZSBTYW1zdW5nIEdhbGF4eSBUYWIgQSA5LjcgKDIwMTUpLiA7KQoKSSBhbHNv
IHRlc3RlZCBpdCBvbiBtc204OTE2LXNhbXN1bmctYTV1LWV1ciwgaXRzIGRpc3BsYXkgaXMgd29y
a2luZyBmaW5lCndpdGggb3Igd2l0aG91dCB0aGlzIHBhdGNoLgotLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9tc20vZHNpL2RzaV9tYW5hZ2VyLmMgfCA2MiArKysrKysrKysrKysrKysrKystLS0tLS0tLS0K
IDEgZmlsZSBjaGFuZ2VkLCA0MSBpbnNlcnRpb25zKCspLCAyMSBkZWxldGlvbnMoLSkKCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbXNtL2RzaS9kc2lfbWFuYWdlci5jIGIvZHJpdmVycy9n
cHUvZHJtL21zbS9kc2kvZHNpX21hbmFnZXIuYwppbmRleCAyNzFhYTdiYmNhOTIuLmVlYTEwODg2
NWNkMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL21zbS9kc2kvZHNpX21hbmFnZXIuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL2RzaS9kc2lfbWFuYWdlci5jCkBAIC00MzIsMjAgKzQz
Miw4IEBAIHN0YXRpYyB2b2lkIGRzaV9tZ3JfYnJpZGdlX3ByZV9lbmFibGUoc3RydWN0IGRybV9i
cmlkZ2UgKmJyaWRnZSkKIAkJfQogCX0KIAotCWlmIChwYW5lbCkgewotCQlyZXQgPSBkcm1fcGFu
ZWxfZW5hYmxlKHBhbmVsKTsKLQkJaWYgKHJldCkgewotCQkJcHJfZXJyKCIlczogZW5hYmxlIHBh
bmVsICVkIGZhaWxlZCwgJWRcbiIsIF9fZnVuY19fLCBpZCwKLQkJCQkJCQkJCXJldCk7Ci0JCQln
b3RvIHBhbmVsX2VuX2ZhaWw7Ci0JCX0KLQl9Ci0KIAlyZXR1cm47CiAKLXBhbmVsX2VuX2ZhaWw6
Ci0JaWYgKGlzX2R1YWxfZHNpICYmIG1zbV9kc2kxKQotCQltc21fZHNpX2hvc3RfZGlzYWJsZSht
c21fZHNpMS0+aG9zdCk7CiBob3N0MV9lbl9mYWlsOgogCW1zbV9kc2lfaG9zdF9kaXNhYmxlKGhv
c3QpOwogaG9zdF9lbl9mYWlsOgpAQCAtNDY0LDEyICs0NTIsNTEgQEAgc3RhdGljIHZvaWQgZHNp
X21ncl9icmlkZ2VfcHJlX2VuYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQogCiBzdGF0
aWMgdm9pZCBkc2lfbWdyX2JyaWRnZV9lbmFibGUoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSkK
IHsKLQlEQkcoIiIpOworCWludCBpZCA9IGRzaV9tZ3JfYnJpZGdlX2dldF9pZChicmlkZ2UpOwor
CXN0cnVjdCBtc21fZHNpICptc21fZHNpID0gZHNpX21ncl9nZXRfZHNpKGlkKTsKKwlzdHJ1Y3Qg
ZHJtX3BhbmVsICpwYW5lbCA9IG1zbV9kc2ktPnBhbmVsOworCWJvb2wgaXNfZHVhbF9kc2kgPSBJ
U19EVUFMX0RTSSgpOworCWludCByZXQ7CisKKwlEQkcoImlkPSVkIiwgaWQpOworCWlmICghbXNt
X2RzaV9kZXZpY2VfY29ubmVjdGVkKG1zbV9kc2kpKQorCQlyZXR1cm47CisKKwkvKiBEbyBub3Ro
aW5nIHdpdGggdGhlIGhvc3QgaWYgaXQgaXMgc2xhdmUtRFNJIGluIGNhc2Ugb2YgZHVhbCBEU0kg
Ki8KKwlpZiAoaXNfZHVhbF9kc2kgJiYgIUlTX01BU1RFUl9EU0lfTElOSyhpZCkpCisJCXJldHVy
bjsKKworCWlmIChwYW5lbCkgeworCQlyZXQgPSBkcm1fcGFuZWxfZW5hYmxlKHBhbmVsKTsKKwkJ
aWYgKHJldCkgeworCQkJcHJfZXJyKCIlczogZW5hYmxlIHBhbmVsICVkIGZhaWxlZCwgJWRcbiIs
IF9fZnVuY19fLCBpZCwKKwkJCQkJCQkJCXJldCk7CisJCX0KKwl9CiB9CiAKIHN0YXRpYyB2b2lk
IGRzaV9tZ3JfYnJpZGdlX2Rpc2FibGUoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSkKIHsKLQlE
QkcoIiIpOworCWludCBpZCA9IGRzaV9tZ3JfYnJpZGdlX2dldF9pZChicmlkZ2UpOworCXN0cnVj
dCBtc21fZHNpICptc21fZHNpID0gZHNpX21ncl9nZXRfZHNpKGlkKTsKKwlzdHJ1Y3QgZHJtX3Bh
bmVsICpwYW5lbCA9IG1zbV9kc2ktPnBhbmVsOworCWJvb2wgaXNfZHVhbF9kc2kgPSBJU19EVUFM
X0RTSSgpOworCWludCByZXQ7CisKKwlEQkcoImlkPSVkIiwgaWQpOworCWlmICghbXNtX2RzaV9k
ZXZpY2VfY29ubmVjdGVkKG1zbV9kc2kpKQorCQlyZXR1cm47CisKKwkvKiBEbyBub3RoaW5nIHdp
dGggdGhlIGhvc3QgaWYgaXQgaXMgc2xhdmUtRFNJIGluIGNhc2Ugb2YgZHVhbCBEU0kgKi8KKwlp
ZiAoaXNfZHVhbF9kc2kgJiYgIUlTX01BU1RFUl9EU0lfTElOSyhpZCkpCisJCXJldHVybjsKKwor
CWlmIChwYW5lbCkgeworCQlyZXQgPSBkcm1fcGFuZWxfZGlzYWJsZShwYW5lbCk7CisJCWlmIChy
ZXQpCisJCQlwcl9lcnIoIiVzOiBQYW5lbCAlZCBPRkYgZmFpbGVkLCAlZFxuIiwgX19mdW5jX18s
IGlkLAorCQkJCQkJCQkJcmV0KTsKKwl9CiB9CiAKIHN0YXRpYyB2b2lkIGRzaV9tZ3JfYnJpZGdl
X3Bvc3RfZGlzYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQpAQCAtNDk1LDEzICs1MjIs
NiBAQCBzdGF0aWMgdm9pZCBkc2lfbWdyX2JyaWRnZV9wb3N0X2Rpc2FibGUoc3RydWN0IGRybV9i
cmlkZ2UgKmJyaWRnZSkKIAlpZiAoaXNfZHVhbF9kc2kgJiYgIUlTX01BU1RFUl9EU0lfTElOSyhp
ZCkpCiAJCWdvdG8gZGlzYWJsZV9waHk7CiAKLQlpZiAocGFuZWwpIHsKLQkJcmV0ID0gZHJtX3Bh
bmVsX2Rpc2FibGUocGFuZWwpOwotCQlpZiAocmV0KQotCQkJcHJfZXJyKCIlczogUGFuZWwgJWQg
T0ZGIGZhaWxlZCwgJWRcbiIsIF9fZnVuY19fLCBpZCwKLQkJCQkJCQkJCXJldCk7Ci0JfQotCiAJ
cmV0ID0gbXNtX2RzaV9ob3N0X2Rpc2FibGUoaG9zdCk7CiAJaWYgKHJldCkKIAkJcHJfZXJyKCIl
czogaG9zdCAlZCBkaXNhYmxlIGZhaWxlZCwgJWRcbiIsIF9fZnVuY19fLCBpZCwgcmV0KTsKLS0g
CjIuMjMuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18K
ZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0
dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
