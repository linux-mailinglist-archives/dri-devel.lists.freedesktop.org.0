Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 5552A17F9D
	for <lists+dri-devel@lfdr.de>; Wed,  8 May 2019 20:12:28 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E1946898E8;
	Wed,  8 May 2019 18:12:25 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mga04.intel.com (mga04.intel.com [192.55.52.120])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 85B15898BC;
 Wed,  8 May 2019 18:12:24 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga006.jf.intel.com ([10.7.209.51])
 by fmsmga104.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 08 May 2019 11:12:24 -0700
X-ExtLoop1: 1
Received: from linuxpresi1-desktop.iind.intel.com ([10.223.74.121])
 by orsmga006.jf.intel.com with ESMTP; 08 May 2019 11:12:20 -0700
From: Uma Shankar <uma.shankar@intel.com>
To: intel-gfx@lists.freedesktop.org,
	dri-devel@lists.freedesktop.org
Subject: [v9 06/13] drm/i915: Write HDR infoframe and send to panel
Date: Thu,  9 May 2019 00:08:46 +0530
Message-Id: <1557340733-9629-7-git-send-email-uma.shankar@intel.com>
X-Mailer: git-send-email 1.9.1
In-Reply-To: <1557340733-9629-1-git-send-email-uma.shankar@intel.com>
References: <1557340733-9629-1-git-send-email-uma.shankar@intel.com>
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: dcastagna@chromium.org, jonas@kwiboo.se, emil.l.velikov@gmail.com,
 Uma Shankar <uma.shankar@intel.com>, seanpaul@chromium.org,
 ville.syrjala@intel.com, maarten.lankhorst@intel.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RW5hYmxlIHdyaXRpbmcgb2YgSERSIG1ldGFkYXRhIGluZm9mcmFtZSB0byBwYW5lbC4KVGhlIGRh
dGEgd2lsbCBiZSBwcm92aWQgYnkgdXNlcnNhcGFjZSBjb21wb3NpdG9ycywgYmFzZWQKb24gYmxl
bmRpbmcgcG9saWNpZXMgYW5kIHBhc3NzZWQgdG8gZHJpdmVyIHRocm91Z2ggYSBibG9iCnByb3Bl
cnR5LgoKdjI6IFJlYmFzZQoKdjM6IEZpeGVkIGEgd2FybmluZyBtZXNzYWdlCgp2NDogQWRkcmVz
c2VkIFNoYXNoYW5rJ3MgcmV2aWV3IGNvbW1lbnRzCgp2NTogUmViYXNlLiBBZGRlZCBpbmZvZnJh
bWUgY2FsY3VsYXRpb24gaW4gY29tcHV0ZSBjb25maWcuCgp2NjogQWRkcmVzc2VkIFNoYXNoYW5r
J3MgcmV2aWV3IGNvbW1lbnQuIEFkZGVkIEhEUiBtZXRhZGF0YQpzdXBwb3J0IGZyb20gR0VOMTAg
b253YXJkcyBhcyBwZXIgU2hhc2hhbmsncyByZWNvbW1lbmRhdGlvbi4KCnY3OiBBZGRyZXNzZWQg
U2hhc2hhbmsncyByZXZpZXcgY29tbWVudHMKCnY4OiBBZGRlZCBTaGFzaGFuaydzIFJCLgoKU2ln
bmVkLW9mZi1ieTogVW1hIFNoYW5rYXIgPHVtYS5zaGFua2FyQGludGVsLmNvbT4KUmV2aWV3ZWQt
Ynk6IFNoYXNoYW5rIFNoYXJtYSA8c2hhc2hhbmsuc2hhcm1hQGludGVsLmNvbT4KLS0tCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcnYuaCAgfCAgMSArCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9oZG1pLmMgfCA0OCArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysKIDIgZmlsZXMgY2hhbmdlZCwgNDkgaW5zZXJ0aW9ucygrKQoKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
ZHJ2LmgKaW5kZXggMjQ3ODkzZS4uYmMzMmIyYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHJ2LmgK
QEAgLTkxMCw2ICs5MTAsNyBAQCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSB7CiAJCXVuaW9uIGhk
bWlfaW5mb2ZyYW1lIGF2aTsKIAkJdW5pb24gaGRtaV9pbmZvZnJhbWUgc3BkOwogCQl1bmlvbiBo
ZG1pX2luZm9mcmFtZSBoZG1pOworCQl1bmlvbiBoZG1pX2luZm9mcmFtZSBkcm07CiAJfSBpbmZv
ZnJhbWVzOwogCiAJLyogSERNSSBzY3JhbWJsaW5nIHN0YXR1cyAqLwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfaGRtaS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfaGRtaS5jCmluZGV4IDkyNTk3ZDguLjk4MDkwMGIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX2hkbWkuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9o
ZG1pLmMKQEAgLTU3Myw2ICs1NzMsNyBAQCBzdGF0aWMgdTMyIGhzd19pbmZvZnJhbWVzX2VuYWJs
ZWQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJSERNSV9JTkZPRlJBTUVfVFlQRV9B
VkksCiAJSERNSV9JTkZPRlJBTUVfVFlQRV9TUEQsCiAJSERNSV9JTkZPRlJBTUVfVFlQRV9WRU5E
T1IsCisJSERNSV9JTkZPRlJBTUVfVFlQRV9EUk0sCiB9OwogCiB1MzIgaW50ZWxfaGRtaV9pbmZv
ZnJhbWVfZW5hYmxlKHVuc2lnbmVkIGludCB0eXBlKQpAQCAtNzk1LDYgKzc5NiwzMCBAQCB2b2lk
IGludGVsX3JlYWRfaW5mb2ZyYW1lKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCXJl
dHVybiB0cnVlOwogfQogCitzdGF0aWMgYm9vbAoraW50ZWxfaGRtaV9jb21wdXRlX2RybV9pbmZv
ZnJhbWUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCisJCQkJIHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlLAorCQkJCSBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAq
Y29ubl9zdGF0ZSkKK3sKKwlzdHJ1Y3QgaGRtaV9kcm1faW5mb2ZyYW1lICpmcmFtZSA9ICZjcnRj
X3N0YXRlLT5pbmZvZnJhbWVzLmRybS5kcm07CisJc3RydWN0IGhkcl9vdXRwdXRfbWV0YWRhdGEg
Kmhkcl9tZXRhZGF0YTsKKwlpbnQgcmV0OworCisJaGRyX21ldGFkYXRhID0gKHN0cnVjdCBoZHJf
b3V0cHV0X21ldGFkYXRhICopCisJCQljb25uX3N0YXRlLT5oZHJfb3V0cHV0X21ldGFkYXRhLT5k
YXRhOworCisJcmV0ID0gZHJtX2hkbWlfaW5mb2ZyYW1lX3NldF9oZHJfbWV0YWRhdGEoZnJhbWUs
IGhkcl9tZXRhZGF0YSk7CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0VSUk9SKCJjb3VsZG4ndCBz
ZXQgSERSIG1ldGFkYXRhIGluIGluZm9mcmFtZVxuIik7CisJCXJldHVybiBmYWxzZTsKKwl9CisK
KwljcnRjX3N0YXRlLT5pbmZvZnJhbWVzLmVuYWJsZSB8PQorCQlpbnRlbF9oZG1pX2luZm9mcmFt
ZV9lbmFibGUoSERNSV9JTkZPRlJBTUVfVFlQRV9EUk0pOworCisJcmV0dXJuIHRydWU7Cit9CisK
IHN0YXRpYyB2b2lkIGc0eF9zZXRfaW5mb2ZyYW1lcyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKIAkJCSAgICAgICBib29sIGVuYWJsZSwKIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKQEAgLTExODAsNiArMTIwNSwxNiBAQCBzdGF0aWMg
dm9pZCBoc3dfc2V0X2luZm9mcmFtZXMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJ
aW50ZWxfd3JpdGVfaW5mb2ZyYW1lKGVuY29kZXIsIGNydGNfc3RhdGUsCiAJCQkgICAgICBIRE1J
X0lORk9GUkFNRV9UWVBFX1ZFTkRPUiwKIAkJCSAgICAgICZjcnRjX3N0YXRlLT5pbmZvZnJhbWVz
LmhkbWkpOworCisJLyoKKwkgKiBTdXBwb3J0IEhEUiBNZXRhZGF0YSBmcm9tIEdlbjEwIG9ud2Fy
ZHMKKwkgKiBUb0RvOiBHZW45IGFsc28gY2FuIHN1cHBvcnQgSERSIHdpdGggTFNQQ09OLgorCSAq
IFN1cHBvcnQgZm9yIHRoZSBzYW1lIHRvIGJlIGVuYWJsZWQgbGF0ZXIuCisJICovCisJaWYgKElO
VEVMX0dFTihkZXZfcHJpdikgPj0gMTApCisJCWludGVsX3dyaXRlX2luZm9mcmFtZShlbmNvZGVy
LCBjcnRjX3N0YXRlLAorCQkJCSAgICAgIEhETUlfSU5GT0ZSQU1FX1RZUEVfRFJNLAorCQkJCSAg
ICAgICZjcnRjX3N0YXRlLT5pbmZvZnJhbWVzLmRybSk7CiB9CiAKIHZvaWQgaW50ZWxfZHBfZHVh
bF9tb2RlX3NldF90bWRzX291dHB1dChzdHJ1Y3QgaW50ZWxfaGRtaSAqaGRtaSwgYm9vbCBlbmFi
bGUpCkBAIC0yMzg2LDYgKzI0MjEsMTkgQEAgaW50IGludGVsX2hkbWlfY29tcHV0ZV9jb25maWco
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCXJldHVybiAtRUlOVkFMOwogCX0KIAor
CS8qCisJICogU3VwcG9ydCBIRFIgTWV0YWRhdGEgZnJvbSBHZW4xMCBvbndhcmRzCisJICogVG9E
bzogR2VuOSBhbHNvIGNhbiBzdXBwb3J0IEhEUiB3aXRoIExTUENPTi4KKwkgKiBTdXBwb3J0IGZv
ciB0aGUgc2FtZSB0byBiZSBlbmFibGVkIGxhdGVyLgorCSAqLworCWlmIChJTlRFTF9HRU4oZGV2
X3ByaXYpID49IDEwIHx8IElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKSB7CisJCWlmICghaW50ZWxf
aGRtaV9jb21wdXRlX2RybV9pbmZvZnJhbWUoZW5jb2RlciwgcGlwZV9jb25maWcsCisJCQkJCQkg
ICAgICBjb25uX3N0YXRlKSkgeworCQkJRFJNX0RFQlVHX0tNUygiYmFkIERSTSBpbmZvZnJhbWVc
biIpOworCQkJcmV0dXJuIC1FSU5WQUw7CisJCX0KKwl9CisKIAlyZXR1cm4gMDsKIH0KIAotLSAK
MS45LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRy
aS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRw
czovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
