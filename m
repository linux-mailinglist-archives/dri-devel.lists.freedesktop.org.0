Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 255949533D
	for <lists+dri-devel@lfdr.de>; Tue, 20 Aug 2019 03:19:09 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CC9CA6E58F;
	Tue, 20 Aug 2019 01:18:19 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from perceval.ideasonboard.com (perceval.ideasonboard.com
 [IPv6:2001:4b98:dc2:55:216:3eff:fef7:d647])
 by gabe.freedesktop.org (Postfix) with ESMTPS id ABBDF6E520
 for <dri-devel@lists.freedesktop.org>; Tue, 20 Aug 2019 01:18:02 +0000 (UTC)
Received: from pendragon.bb.dnainternet.fi
 (dfj612yhrgyx302h3jwwy-3.rev.dnainternet.fi
 [IPv6:2001:14ba:21f5:5b00:ce28:277f:58d7:3ca4])
 by perceval.ideasonboard.com (Postfix) with ESMTPSA id 90306AF9;
 Tue, 20 Aug 2019 03:17:55 +0200 (CEST)
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v2 34/50] drm/omap: Create connector for bridges
Date: Tue, 20 Aug 2019 04:17:05 +0300
Message-Id: <20190820011721.30136-35-laurent.pinchart@ideasonboard.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190820011721.30136-1-laurent.pinchart@ideasonboard.com>
References: <20190820011721.30136-1-laurent.pinchart@ideasonboard.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=ideasonboard.com; s=mail; t=1566263876;
 bh=8F8KXO7zy3kbyNOuEdqeap3y6+AW/wj8XnF5Os4erqA=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=iqaQFNbW/VW2oKiK1Svc4FvENmrXpY8dO80533hBgC6YWKpNVum1Y6KYcoJVi2GLi
 4DBj46vMrLHyUxTUxE9ACOmIQUEEIZJV0XLyGcOfwmTlwzU/WgACvscwZhQlblDJW8
 jUNs1pqREn+SFwGngcRzgdOyOtLfZtnBXOs3s4k4=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Maxime Ripard <maxime.ripard@bootlin.com>,
 Tomi Valkeinen <tomi.valkeinen@ti.com>, Sean Paul <sean@poorly.run>,
 Sebastian Reichel <sebastian.reichel@collabora.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VXNlIHRoZSBkcm1fYnJpZGdlX2Nvbm5lY3RvciBoZWxwZXIgdG8gY3JlYXRlIGEgY29ubmVjdG9y
IGZvciBwaXBlbGluZXMKdGhhdCB1c2UgZHJtX2JyaWRnZS4gVGhpcyBhbGxvd3Mgc3BsaXR0aW5n
IGNvbm5lY3RvciBvcGVyYXRpb25zIGFjcm9zcwptdWx0aXBsZSBicmlkZ2VzIHdoZW4gbmVjZXNz
YXJ5LCBpbnN0ZWFkIG9mIGhhdmluZyB0aGUgbGFzdCBicmlkZ2UgaW4KdGhlIGNoYWluIGNyZWF0
aW5nIHRoZSBjb25uZWN0b3IgYW5kIGhhbmRsaW5nIGFsbCBjb25uZWN0b3Igb3BlcmF0aW9ucwpp
bnRlcm5hbGx5LgoKU2lnbmVkLW9mZi1ieTogTGF1cmVudCBQaW5jaGFydCA8bGF1cmVudC5waW5j
aGFydEBpZGVhc29uYm9hcmQuY29tPgotLS0KQ2hhbmdlcyBzaW5jZSB2MToKCi0gU3F1YXNoIHdp
dGggcGF0Y2ggImRybS9vbWFwOiBEZXRhY2ggZnJvbSBwYW5lbHMgYXQgcmVtb3ZlIHRpbWUiCi0t
LQogZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vb21hcF9kcnYuYyB8IDgyICsrKysrKysrKysrKysr
KysrKysrKysrKystLS0tLQogMSBmaWxlIGNoYW5nZWQsIDcwIGluc2VydGlvbnMoKyksIDEyIGRl
bGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL29tYXBfZHJ2
LmMgYi9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9vbWFwX2Rydi5jCmluZGV4IGRlMzczZmQ1MDcy
OS4uZjM4ZDk1Y2IzMWJhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9vbWFw
X2Rydi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL29tYXBfZHJ2LmMKQEAgLTExLDEw
ICsxMSwxMiBAQAogCiAjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWMuaD4KICNpbmNsdWRlIDxkcm0v
ZHJtX2F0b21pY19oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2JyaWRnZV9jb25uZWN0b3Iu
aD4KICNpbmNsdWRlIDxkcm0vZHJtX2Rydi5oPgogI2luY2x1ZGUgPGRybS9kcm1fZmJfaGVscGVy
Lmg+CiAjaW5jbHVkZSA8ZHJtL2RybV9maWxlLmg+CiAjaW5jbHVkZSA8ZHJtL2RybV9pb2N0bC5o
PgorI2luY2x1ZGUgPGRybS9kcm1fcGFuZWwuaD4KICNpbmNsdWRlIDxkcm0vZHJtX3ByaW1lLmg+
CiAjaW5jbHVkZSA8ZHJtL2RybV9wcm9iZV9oZWxwZXIuaD4KICNpbmNsdWRlIDxkcm0vZHJtX3Zi
bGFuay5oPgpAQCAtMjkwLDkgKzI5MiwxNCBAQCBzdGF0aWMgaW50IG9tYXBfbW9kZXNldF9pbml0
KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCiAKIAkJaWYgKHBpcGUtPm91dHB1dC0+YnJpZGdlKSB7
CiAJCQlyZXQgPSBkcm1fYnJpZGdlX2F0dGFjaChwaXBlLT5lbmNvZGVyLAotCQkJCQkJcGlwZS0+
b3V0cHV0LT5icmlkZ2UsIE5VTEwsIDApOwotCQkJaWYgKHJldCA8IDApCisJCQkJCQlwaXBlLT5v
dXRwdXQtPmJyaWRnZSwgTlVMTCwKKwkJCQkJCURSTV9CUklER0VfQVRUQUNIX05PX0NPTk5FQ1RP
Uik7CisJCQlpZiAocmV0IDwgMCkgeworCQkJCWRldl9lcnIocHJpdi0+ZGV2LAorCQkJCQkidW5h
YmxlIHRvIGF0dGFjaCBicmlkZ2UgJXBPRlxuIiwKKwkJCQkJcGlwZS0+b3V0cHV0LT5icmlkZ2Ut
Pm9mX25vZGUpOwogCQkJCXJldHVybiByZXQ7CisJCQl9CiAJCX0KIAogCQlpZCA9IG9tYXBfZGlz
cGxheV9pZChwaXBlLT5vdXRwdXQpOwpAQCAtMzI4LDggKzMzNSwzMSBAQCBzdGF0aWMgaW50IG9t
YXBfbW9kZXNldF9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCiAJCQkJCQkJICAgICAgZW5j
b2Rlcik7CiAJCQlpZiAoIXBpcGUtPmNvbm5lY3RvcikKIAkJCQlyZXR1cm4gLUVOT01FTTsKKwkJ
fSBlbHNlIHsKKwkJCXN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UgPSBwaXBlLT5vdXRwdXQtPmJy
aWRnZTsKIAotCQkJZHJtX2Nvbm5lY3Rvcl9hdHRhY2hfZW5jb2RlcihwaXBlLT5jb25uZWN0b3Is
IGVuY29kZXIpOworCQkJcGlwZS0+Y29ubmVjdG9yID0gZHJtX2JyaWRnZV9jb25uZWN0b3JfaW5p
dChkZXYsCisJCQkJCQkJCSAgICBicmlkZ2UpOworCQkJaWYgKElTX0VSUihwaXBlLT5jb25uZWN0
b3IpKSB7CisJCQkJZGV2X2Vycihwcml2LT5kZXYsCisJCQkJCSJ1bmFibGUgdG8gY3JlYXRlIGJy
aWRnZSBjb25uZWN0b3IgZm9yICVwT0ZcbiIsCisJCQkJCWJyaWRnZS0+b2Zfbm9kZSk7CisJCQkJ
cmV0dXJuIFBUUl9FUlIocGlwZS0+Y29ubmVjdG9yKTsKKwkJCX0KKwkJfQorCisJCWRybV9jb25u
ZWN0b3JfYXR0YWNoX2VuY29kZXIocGlwZS0+Y29ubmVjdG9yLCBlbmNvZGVyKTsKKworCQkvKgor
CQkgKiBGSVhNRTogZHJtX3BhbmVsIHNob3VsZCBub3Qgc3RvcmUgdGhlIGRybV9jb25uZWN0b3Ig
cG9pbnRlcgorCQkgKiBpbnRlcm5hbGx5IGJ1dCBzaG91bGQgcmVjZWl2ZSBpdCBpbiBpdHMgLmdl
dF9tb2RlcygpCisJCSAqIG9wZXJhdGlvbi4KKwkJICovCisJCWlmIChwaXBlLT5vdXRwdXQtPnBh
bmVsKSB7CisJCQlyZXQgPSBkcm1fcGFuZWxfYXR0YWNoKHBpcGUtPm91dHB1dC0+cGFuZWwsCisJ
CQkJCSAgICAgICBwaXBlLT5jb25uZWN0b3IpOworCQkJaWYgKHJldCA8IDApCisJCQkJcmV0dXJu
IHJldDsKIAkJfQogCiAJCWNydGMgPSBvbWFwX2NydGNfaW5pdChkZXYsIHBpcGUsIHByaXYtPnBs
YW5lc1tpXSk7CkBAIC0zNjgsNiArMzk4LDIzIEBAIHN0YXRpYyBpbnQgb21hcF9tb2Rlc2V0X2lu
aXQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKIAlyZXR1cm4gMDsKIH0KIAorc3RhdGljIHZvaWQg
b21hcF9tb2Rlc2V0X2Zpbmkoc3RydWN0IGRybV9kZXZpY2UgKmRkZXYpCit7CisJc3RydWN0IG9t
YXBfZHJtX3ByaXZhdGUgKnByaXYgPSBkZGV2LT5kZXZfcHJpdmF0ZTsKKwl1bnNpZ25lZCBpbnQg
aTsKKworCW9tYXBfZHJtX2lycV91bmluc3RhbGwoZGRldik7CisKKwlmb3IgKGkgPSAwOyBpIDwg
cHJpdi0+bnVtX3BpcGVzOyBpKyspIHsKKwkJc3RydWN0IG9tYXBfZHJtX3BpcGVsaW5lICpwaXBl
ID0gJnByaXYtPnBpcGVzW2ldOworCisJCWlmIChwaXBlLT5vdXRwdXQtPnBhbmVsKQorCQkJZHJt
X3BhbmVsX2RldGFjaChwaXBlLT5vdXRwdXQtPnBhbmVsKTsKKwl9CisKKwlkcm1fbW9kZV9jb25m
aWdfY2xlYW51cChkZGV2KTsKK30KKwogLyoKICAqIEVuYWJsZSB0aGUgSFBEIGluIGV4dGVybmFs
IGNvbXBvbmVudHMgaWYgc3VwcG9ydGVkCiAgKi8KQEAgLTM3Nyw4ICs0MjQsMTUgQEAgc3RhdGlj
IHZvaWQgb21hcF9tb2Rlc2V0X2VuYWJsZV9leHRlcm5hbF9ocGQoc3RydWN0IGRybV9kZXZpY2Ug
KmRkZXYpCiAJdW5zaWduZWQgaW50IGk7CiAKIAlmb3IgKGkgPSAwOyBpIDwgcHJpdi0+bnVtX3Bp
cGVzOyBpKyspIHsKLQkJaWYgKHByaXYtPnBpcGVzW2ldLmNvbm5lY3RvcikKLQkJCW9tYXBfY29u
bmVjdG9yX2VuYWJsZV9ocGQocHJpdi0+cGlwZXNbaV0uY29ubmVjdG9yKTsKKwkJc3RydWN0IGRy
bV9jb25uZWN0b3IgKmNvbm5lY3RvciA9IHByaXYtPnBpcGVzW2ldLmNvbm5lY3RvcjsKKworCQlp
ZiAoIWNvbm5lY3RvcikKKwkJCWNvbnRpbnVlOworCisJCWlmIChwcml2LT5waXBlc1tpXS5vdXRw
dXQtPm5leHQpCisJCQlvbWFwX2Nvbm5lY3Rvcl9lbmFibGVfaHBkKGNvbm5lY3Rvcik7CisJCWVs
c2UKKwkJCWRybV9icmlkZ2VfY29ubmVjdG9yX2VuYWJsZV9ocGQoY29ubmVjdG9yKTsKIAl9CiB9
CiAKQEAgLTM5MSw4ICs0NDUsMTUgQEAgc3RhdGljIHZvaWQgb21hcF9tb2Rlc2V0X2Rpc2FibGVf
ZXh0ZXJuYWxfaHBkKHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2KQogCXVuc2lnbmVkIGludCBpOwog
CiAJZm9yIChpID0gMDsgaSA8IHByaXYtPm51bV9waXBlczsgaSsrKSB7Ci0JCWlmIChwcml2LT5w
aXBlc1tpXS5jb25uZWN0b3IpCi0JCQlvbWFwX2Nvbm5lY3Rvcl9kaXNhYmxlX2hwZChwcml2LT5w
aXBlc1tpXS5jb25uZWN0b3IpOworCQlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yID0g
cHJpdi0+cGlwZXNbaV0uY29ubmVjdG9yOworCisJCWlmICghY29ubmVjdG9yKQorCQkJY29udGlu
dWU7CisKKwkJaWYgKHByaXYtPnBpcGVzW2ldLm91dHB1dC0+bmV4dCkKKwkJCW9tYXBfY29ubmVj
dG9yX2Rpc2FibGVfaHBkKGNvbm5lY3Rvcik7CisJCWVsc2UKKwkJCWRybV9icmlkZ2VfY29ubmVj
dG9yX2Rpc2FibGVfaHBkKGNvbm5lY3Rvcik7CiAJfQogfQogCkBAIC02MTUsOCArNjc2LDcgQEAg
c3RhdGljIGludCBvbWFwZHJtX2luaXQoc3RydWN0IG9tYXBfZHJtX3ByaXZhdGUgKnByaXYsIHN0
cnVjdCBkZXZpY2UgKmRldikKIAogCW9tYXBfZmJkZXZfZmluaShkZGV2KTsKIGVycl9jbGVhbnVw
X21vZGVzZXQ6Ci0JZHJtX21vZGVfY29uZmlnX2NsZWFudXAoZGRldik7Ci0Jb21hcF9kcm1faXJx
X3VuaW5zdGFsbChkZGV2KTsKKwlvbWFwX21vZGVzZXRfZmluaShkZGV2KTsKIGVycl9nZW1fZGVp
bml0OgogCW9tYXBfZ2VtX2RlaW5pdChkZGV2KTsKIAlkZXN0cm95X3dvcmtxdWV1ZShwcml2LT53
cSk7CkBAIC02NDEsOSArNzAxLDcgQEAgc3RhdGljIHZvaWQgb21hcGRybV9jbGVhbnVwKHN0cnVj
dCBvbWFwX2RybV9wcml2YXRlICpwcml2KQogCiAJZHJtX2F0b21pY19oZWxwZXJfc2h1dGRvd24o
ZGRldik7CiAKLQlkcm1fbW9kZV9jb25maWdfY2xlYW51cChkZGV2KTsKLQotCW9tYXBfZHJtX2ly
cV91bmluc3RhbGwoZGRldik7CisJb21hcF9tb2Rlc2V0X2ZpbmkoZGRldik7CiAJb21hcF9nZW1f
ZGVpbml0KGRkZXYpOwogCiAJZGVzdHJveV93b3JrcXVldWUocHJpdi0+d3EpOwotLSAKUmVnYXJk
cywKCkxhdXJlbnQgUGluY2hhcnQKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVk
ZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZv
L2RyaS1kZXZlbA==
