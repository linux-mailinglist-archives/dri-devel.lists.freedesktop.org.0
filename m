Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 16057BD8F0
	for <lists+dri-devel@lfdr.de>; Wed, 25 Sep 2019 09:19:42 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 56E328996F;
	Wed, 25 Sep 2019 07:19:30 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from NAM05-DM3-obe.outbound.protection.outlook.com
 (mail-eopbgr730093.outbound.protection.outlook.com [40.107.73.93])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4082D6EB1F
 for <dri-devel@lists.freedesktop.org>; Wed, 25 Sep 2019 04:16:59 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=AVx2mwyyRq+6cMIlExcrThqd76RxMwcBUfCl4jHDVu4Xh8fLE0u53llCdOQkwkCXHH40dHY4LHJBxj5aVioB/DQwt18xHo8rbGoC5JJvKOlsudtMJQbbR988vfFAHpoGDfMgwM8uH8JOwfcGsUTIV7H1cz1c//zgpE0Su1YHeEIx9EBF9H9ryCu5P8SlK65NeZSuvkq/1E6Kaqd7gckNb2C/sfwXtd39K+zbuAJIP7C9MjF5x4FHX5D0ee9KmCdssuSbdbGYGj26JPCSE5rj1/qJN6G2iaR3x0YE8buXdD+bbbuiVUD+rfkLwkyTkh2grkbqxvDs1wYtTDr83a/94w==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=CHTPzzG7WzqlJwzrN3HLPQL8iM9flXqwyeBFy88xZls=;
 b=KrXo0B0F4LSUJ0BAqYCwAz8o5eSZvY5B9NJFMEp4/1leYMWh4nJS0jJUCuLkG3Z7lxu64ocgBtCNf+HLKGCiheYmsb08+IXZN0seUyy+sZSDAeU78BvvP5WWxiW/V4zPQgv/oKBo3QwlA/IUwvuwvFAJYHPQK3/1l5zEiUSULVj4hF+BKo7f5RE0VKzVtfyJCuBe5XzzvELmUlRUwXsMrZdp5ew+p0sREZ8KvW//rqwcpppglkHg0yDj6ow5rkgI4fN5mYqPTk0q2YhL0oVSLJ/IRAk5feF6A4Z3WpdKx6NqRSlmxgOt0PV+VjHYEjp+XrSKendOayN0e2F0l2QKIg==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=analogixsemi.com; dmarc=pass action=none
 header.from=analogixsemi.com; dkim=pass header.d=analogixsemi.com; arc=none
Received: from MN2PR04MB5886.namprd04.prod.outlook.com (20.179.22.213) by
 MN2PR04MB5712.namprd04.prod.outlook.com (20.179.21.13) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2284.20; Wed, 25 Sep 2019 04:16:56 +0000
Received: from MN2PR04MB5886.namprd04.prod.outlook.com
 ([fe80::8520:f80f:ae9:63cd]) by MN2PR04MB5886.namprd04.prod.outlook.com
 ([fe80::8520:f80f:ae9:63cd%6]) with mapi id 15.20.2284.023; Wed, 25 Sep 2019
 04:16:56 +0000
From: Xin Ji <xji@analogixsemi.com>
To: Dan Carpenter <dan.carpenter@oracle.com>
Subject: Re: [PATCH v1 2/2] drm/bridge: anx7625: Add anx7625 MIPI to DP bridge
 driver
Thread-Topic: [PATCH v1 2/2] drm/bridge: anx7625: Add anx7625 MIPI to DP
 bridge driver
Thread-Index: AQHVb3m3O6Kkudc69k2BA5rT6xVhEKc5UIWAgAKAn4A=
Date: Wed, 25 Sep 2019 04:16:56 +0000
Message-ID: <20190925041647.GA3388@xin-VirtualBox>
References: <cover.1568957788.git.xji@analogixsemi.com>
 <02319a7db948900efe0f945b684221ac076bac48.1568957789.git.xji@analogixsemi.com>
 <20190923140355.GH2959@kadam>
In-Reply-To: <20190923140355.GH2959@kadam>
Accept-Language: zh-CN, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: HK0PR04CA0009.apcprd04.prod.outlook.com
 (2603:1096:203:36::21) To MN2PR04MB5886.namprd04.prod.outlook.com
 (2603:10b6:208:a3::21)
x-ms-exchange-messagesentrepresentingtype: 1
x-originating-ip: [43.252.149.35]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 9fea7581-f7dc-48b6-89e4-08d7416f334d
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(5600167)(711020)(4605104)(1401327)(4534185)(7168020)(4627221)(201703031133081)(201702281549075)(8990200)(2017052603328)(7193020);
 SRVR:MN2PR04MB5712; 
x-ms-traffictypediagnostic: MN2PR04MB5712:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <MN2PR04MB57128ECACF9C67C86E97EF78C7870@MN2PR04MB5712.namprd04.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:257;
x-forefront-prvs: 01713B2841
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10019020)(7916004)(346002)(376002)(366004)(39840400004)(396003)(136003)(199004)(189003)(2906002)(256004)(186003)(9686003)(305945005)(86362001)(30864003)(446003)(71190400001)(26005)(6486002)(6512007)(229853002)(5660300002)(6246003)(52116002)(8936002)(107886003)(66946007)(66066001)(14454004)(6436002)(478600001)(25786009)(66556008)(66476007)(66446008)(64756008)(6116002)(54906003)(3846002)(486006)(81166006)(7416002)(6916009)(76176011)(71200400001)(4326008)(561924002)(33716001)(5024004)(476003)(6506007)(386003)(8676002)(11346002)(7736002)(1076003)(316002)(102836004)(81156014)(33656002)(55236004)(99286004)(14444005)(579004)(559001)(569006);
 DIR:OUT; SFP:1102; SCL:1; SRVR:MN2PR04MB5712;
 H:MN2PR04MB5886.namprd04.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: analogixsemi.com does not
 designate permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: OJlCuBs4vfktXI6R0jX0ZTK7qWeSVyaVS/IOPTcZXqJPMFYEiCJivQlawrsZc7iRRdU2EIinFnxWv7j3+ivaRd6oxiRLJIaBduToG7EXqhO+Qg+FpJV+xXCaTAfq8jhdhl04Pxq5ubkooVNO8RV3JRrvJtMuHLvdSVNg0w6YfBj2iOSS1pvz3xR5/mY8ulMKPIf690czZB66ri8OoSLQkxfiK9LOefedb0f2nMU/84TSRRbAXwNnuRChBU8IwZgSwZ0giWNZyKt3unSejgd2V8MIBZKtj+EKCvtBw4x8myTfuq4PHVuf2MghqaWvN+Mw5sVnXr6JlDwWu5uVhj0Lh+kMGktVyVUHFeBW4tiHkge2NBqWO9Muz7Vcps3tdEl7TzKzAb4XC0LAfqW09qmFnFLs6022hnhQkngrVnvuY8Y=
Content-ID: <63D33D3DCEAF51458312DF259E126E26@namprd04.prod.outlook.com>
MIME-Version: 1.0
X-OriginatorOrg: analogixsemi.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 9fea7581-f7dc-48b6-89e4-08d7416f334d
X-MS-Exchange-CrossTenant-originalarrivaltime: 25 Sep 2019 04:16:56.2224 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: b099b0b4-f26c-4cf5-9a0f-d5be9acab205
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: EnluRwAzXrsLBdWzHLT8P/ZO6uA0vBsMoxgNBKj8FGpnUrkxO557F+CKETOWiuzNVAVt9ka9kdRUDpKDhiWxGA==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: MN2PR04MB5712
X-Mailman-Approved-At: Wed, 25 Sep 2019 07:19:29 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=Analogixsemi.onmicrosoft.com; s=selector2-Analogixsemi-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=CHTPzzG7WzqlJwzrN3HLPQL8iM9flXqwyeBFy88xZls=;
 b=id5zm/MFqZlreQF/MixseV64vVgrE/Ou75LNOpKk2v1tISMIoHDuSvqzmq8zObknYMTDLr5iVA5ZMCdUHaahoasmNp/E6GwCnFAJGsm8q4He1hLuKhYokbBCZ24LXSYpoRzJ9F987YamzLTOtUqr409G9zoXv4AH//205UHWHSU=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=xji@analogixsemi.com; 
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: "devel@driverdev.osuosl.org" <devel@driverdev.osuosl.org>,
 Jernej Skrabec <jernej.skrabec@siol.net>, Jonas Karlman <jonas@kwiboo.se>,
 David Airlie <airlied@linux.ie>, Neil Armstrong <narmstrong@baylibre.com>,
 "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
 "dri-devel@lists.freedesktop.org" <dri-devel@lists.freedesktop.org>,
 Laurent Pinchart <laurent.pinchart@ideasonboard.com>,
 Sheng Pan <span@analogixsemi.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gTW9uLCBTZXAgMjMsIDIwMTkgYXQgMDU6MDM6NTVQTSArMDMwMCwgRGFuIENhcnBlbnRlciB3
cm90ZToKPiBJIHdpc2ggeW91IHdvdWxkIHRoaW5rIG1vcmUgYWJvdXQgdGhlIGVycm9yIGNvZGVz
IHRoYXQgeW91J3JlIHJldHVybmluZy4KPiBNb3N0IGZ1bmN0aW9ucyBkbyAicmV0IHw9IGZyb2Io
KS4iIHdoaWNoIE9ScyB0aGUgZXJyb3IgY29kZXMgdG9nZXRoZXIsCj4gYW5kIHJlc3VsdHMgaW4g
YSBub25zZW5zZSBuZWdhdGl2ZSBlcnJvciBjb2RlLiAgQnV0IHRoZW4gc29tZSBmdW5jdGlvbnMK
PiByZXR1cm4gMSBvbiBlcnJvciBhbmQgemVybyBvbiBzdWNjZXNzIHdoaWNoIGlzIHNvbWV0aW1l
cyBhIGJ1ZywKPiBzb21ldGltZXMgY29uZnVzaW5nIGJ1dCBhbHdheXMgdWdseS4KSGkgRGFuIENh
cnBlbnRlciwgSSdsbCB0YWtlIG1vcmUgY2FyZSBhYm91dCByZXR1cm4gZXJyb3IgY29kZXMuCkFz
IEkgY2Fubm90IHRvIGNoZWNrIGFsbCBJMkMgb3BlcmF0aW9uIHJlc3VsdCwgc28gSSB1c2UgInJl
dCB8PSBmcm9iKCkuIgp0byBjb21iaW5lIHRoZW0sIGlmIG9uZSBvZiB0aGVtIGhhcyBuZWdhdGl2
ZSByZXR1cm4gdmFsdWUsIEknbGwgcG9wIG91dCBlcnJvcgptZXNzYWdlIGFuZCByZXR1YW4uIEFu
eXdheSBJJ2xsIHVzZSB1bmlmb3JtIHJldHVybiBlcnJvciBjb2RlKG5lZ2F0aXZlCnZhbHVlIGFz
IGZhaWxlZCwgMCBhcyBzdWNjZXNzKS4KClRoYW5rcywKWGluCj4gCj4gT24gRnJpLCBTZXAgMjAs
IDIwMTkgYXQgMDY6MDc6NDNBTSArMDAwMCwgWGluIEppIHdyb3RlOgo+ID4gVGhlIEFOWDc2MjUg
aXMgYW4gdWx0cmEtbG93IHBvd2VyIDRLIE1vYmlsZSBIRCBUcmFuc21pdHRlciBkZXNpZ25lZAo+
ID4gZm9yIHBvcnRhYmxlIGRldmljZS4gSXQgY29udmVydHMgTUlQSSB0byBEaXNwbGF5UG9ydCAx
LjMgNEsuCj4gPiAKPiA+IFNpZ25lZC1vZmYtYnk6IFhpbiBKaSA8eGppQGFuYWxvZ2l4c2VtaS5j
b20+Cj4gPiAtLS0KPiA+ICBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL01ha2VmaWxlICAgICAgICAg
ICB8ICAgIDIgKy0KPiA+ICBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L0tjb25maWcg
ICB8ICAgIDYgKwo+ID4gIGRyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvTWFrZWZpbGUg
IHwgICAgMSArCj4gPiAgZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9hbng3NjI1LmMg
fCAyMDg1ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrCj4gPiAgZHJpdmVycy9ncHUvZHJt
L2JyaWRnZS9hbmFsb2dpeC9hbng3NjI1LmggfCAgMzk3ICsrKysrKwo+ID4gIDUgZmlsZXMgY2hh
bmdlZCwgMjQ5MCBpbnNlcnRpb25zKCspLCAxIGRlbGV0aW9uKC0pCj4gPiAgY3JlYXRlIG1vZGUg
MTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvYW54NzYyNS5jCj4gPiAgY3Jl
YXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvYW54NzYyNS5o
Cj4gPiAKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL01ha2VmaWxlIGIv
ZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9NYWtlZmlsZQo+ID4gaW5kZXggNDkzNGZjZi4uYmNkMzg4
YSAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvTWFrZWZpbGUKPiA+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvTWFrZWZpbGUKPiA+IEBAIC0xMiw4ICsxMiw4IEBA
IG9iai0kKENPTkZJR19EUk1fU0lJOTIzNCkgKz0gc2lpOTIzNC5vCj4gPiAgb2JqLSQoQ09ORklH
X0RSTV9USElORV9USEM2M0xWRDEwMjQpICs9IHRoYzYzbHZkMTAyNC5vCj4gPiAgb2JqLSQoQ09O
RklHX0RSTV9UT1NISUJBX1RDMzU4NzY0KSArPSB0YzM1ODc2NC5vCj4gPiAgb2JqLSQoQ09ORklH
X0RSTV9UT1NISUJBX1RDMzU4NzY3KSArPSB0YzM1ODc2Ny5vCj4gPiAtb2JqLSQoQ09ORklHX0RS
TV9BTkFMT0dJWF9EUCkgKz0gYW5hbG9naXgvCj4gPiAgb2JqLSQoQ09ORklHX0RSTV9JMkNfQURW
NzUxMSkgKz0gYWR2NzUxMS8KPiA+ICBvYmotJChDT05GSUdfRFJNX1RJX1NONjVEU0k4NikgKz0g
dGktc242NWRzaTg2Lm8KPiA+ICBvYmotJChDT05GSUdfRFJNX1RJX1RGUDQxMCkgKz0gdGktdGZw
NDEwLm8KPiA+ICtvYmoteSArPSBhbmFsb2dpeC8KPiA+ICBvYmoteSArPSBzeW5vcHN5cy8KPiA+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L0tjb25maWcgYi9k
cml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L0tjb25maWcKPiA+IGluZGV4IGU5MzBmZjku
LmIyZjEyN2UgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4
L0tjb25maWcKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvS2NvbmZp
Zwo+ID4gQEAgLTIsMyArMiw5IEBACj4gPiAgY29uZmlnIERSTV9BTkFMT0dJWF9EUAo+ID4gIAl0
cmlzdGF0ZQo+ID4gIAlkZXBlbmRzIG9uIERSTQo+ID4gKwo+ID4gK2NvbmZpZyBBTkFMT0dJWF9B
Tlg3NjI1Cj4gPiArCXRyaXN0YXRlICJBbmFsb2dpeCBNSVBJIHRvIERQIGludGVyZmFjZSBzdXBw
b3J0Igo+ID4gKwloZWxwCj4gPiArCQlBTlg3NjI1IGlzIGFuIHVsdHJhLWxvdyBwb3dlciA0SyBt
b2JpbGUgSEQgdHJhbnNtaXR0ZXIgZGVzaWduZWQKPiA+ICsJCWZvciBwb3J0YWJsZSBkZXZpY2Vz
LiBJdCBjb252ZXJ0cyBNSVBJL0RQSSB0byBEaXNwbGF5UG9ydDEuMyA0Sy4KPiA+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L01ha2VmaWxlIGIvZHJpdmVycy9n
cHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9NYWtlZmlsZQo+ID4gaW5kZXggZmRiZjNmZC4uOGE1Mjg2
NyAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvTWFrZWZp
bGUKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvTWFrZWZpbGUKPiA+
IEBAIC0xLDMgKzEsNCBAQAo+ID4gICMgU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAt
b25seQo+ID4gK29iai0kKENPTkZJR19BTkFMT0dJWF9BTlg3NjI1KSArPSBhbng3NjI1Lm8KPiA+
ICBhbmFsb2dpeF9kcC1vYmpzIDo9IGFuYWxvZ2l4X2RwX2NvcmUubyBhbmFsb2dpeF9kcF9yZWcu
bwo+ID4gIG9iai0kKENPTkZJR19EUk1fQU5BTE9HSVhfRFApICs9IGFuYWxvZ2l4X2RwLm8KPiA+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L2FueDc2MjUuYyBi
L2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvYW54NzYyNS5jCj4gPiBuZXcgZmlsZSBt
b2RlIDEwMDY0NAo+ID4gaW5kZXggMDAwMDAwMC4uZWNlYWRlZgo+ID4gLS0tIC9kZXYvbnVsbAo+
ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9hbng3NjI1LmMKPiA+IEBA
IC0wLDAgKzEsMjA4NSBAQAo+ID4gKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4w
LW9ubHkKPiA+ICsvKgo+ID4gKyAqIENvcHlyaWdodChjKSAyMDE2LCBBbmFsb2dpeCBTZW1pY29u
ZHVjdG9yLiBBbGwgcmlnaHRzIHJlc2VydmVkLgo+ID4gKyAqCj4gPiArICovCj4gPiArI2luY2x1
ZGUgPGxpbnV4L2V4dGNvbi5oPgo+ID4gKyNpbmNsdWRlIDxsaW51eC9nY2QuaD4KPiA+ICsjaW5j
bHVkZSA8bGludXgvZ3Bpby9jb25zdW1lci5oPgo+ID4gKyNpbmNsdWRlIDxsaW51eC9pMmMuaD4K
PiA+ICsjaW5jbHVkZSA8bGludXgvaW50ZXJydXB0Lmg+Cj4gPiArI2luY2x1ZGUgPGxpbnV4L2lv
cG9sbC5oPgo+ID4gKyNpbmNsdWRlIDxsaW51eC9rZXJuZWwuaD4KPiA+ICsjaW5jbHVkZSA8bGlu
dXgvbW9kdWxlLmg+Cj4gPiArI2luY2x1ZGUgPGxpbnV4L211dGV4Lmg+Cj4gPiArI2luY2x1ZGUg
PGxpbnV4L3NsYWIuaD4KPiA+ICsjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KPiA+ICsjaW5jbHVk
ZSA8bGludXgvd29ya3F1ZXVlLmg+Cj4gPiArCj4gPiArI2luY2x1ZGUgPGxpbnV4L29mX2dwaW8u
aD4KPiA+ICsjaW5jbHVkZSA8bGludXgvb2ZfZ3JhcGguaD4KPiA+ICsjaW5jbHVkZSA8bGludXgv
b2ZfcGxhdGZvcm0uaD4KPiA+ICsKPiA+ICsjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWNfaGVscGVy
Lmg+Cj4gPiArI2luY2x1ZGUgPGRybS9kcm1fYnJpZGdlLmg+Cj4gPiArI2luY2x1ZGUgPGRybS9k
cm1fY3J0Y19oZWxwZXIuaD4KPiA+ICsjaW5jbHVkZSA8ZHJtL2RybV9kcF9oZWxwZXIuaD4KPiA+
ICsjaW5jbHVkZSA8ZHJtL2RybV9lZGlkLmg+Cj4gPiArI2luY2x1ZGUgPGRybS9kcm1fbWlwaV9k
c2kuaD4KPiA+ICsjaW5jbHVkZSA8ZHJtL2RybV9wcmludC5oPgo+ID4gKyNpbmNsdWRlIDxkcm0v
ZHJtX3Byb2JlX2hlbHBlci5oPgo+ID4gKwo+ID4gKyNpbmNsdWRlIDx2aWRlby9kaXNwbGF5X3Rp
bWluZy5oPgo+ID4gKwo+ID4gKyNpbmNsdWRlICJhbng3NjI1LmgiCj4gPiArCj4gPiArLyoKPiA+
ICsgKiB0aGVyZSBpcyBhIHN5bmMgaXNzdWUgd2hpbGUgYWNjZXNzIEkyQyByZWdpc3RlciBiZXR3
ZWVuIEFQKENQVSkgYW5kCj4gPiArICogaW50ZXJuYWwgZmlybXdhcmUoT0NNKSwgdG8gYXZvaWQg
dGhlIHJhY2UgY29uZGl0aW9uLCBBUCBzaG91bGQgYWNjZXNzCj4gPiArICogdGhlIHJlc2VydmVk
IHNsYXZlIGFkZHJlc3MgYmVmb3JlIHNsYXZlIGFkZHJlc3Mgb2NjdXJzIGNoYW5nZXMuCj4gPiAr
ICovCj4gPiArc3RhdGljIGludCBpMmNfYWNjZXNzX3dvcmthcm91bmQoc3RydWN0IGFueDc2MjVf
ZGF0YSAqY3R4LAo+ID4gKwkJCQkgc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCkKPiA+ICt7Cj4g
PiArCXU4IG9mZnNldDsKPiA+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmNsaWVudC0+ZGV2Owo+
ID4gKwlzdHJ1Y3QgaTJjX2NsaWVudCAqbGFzdF9jbGllbnQgPSBjdHgtPmxhc3RfY2xpZW50Owo+
ID4gKwlpbnQgcmV0ID0gMDsKPiA+ICsKPiA+ICsJaWYgKGNsaWVudCAhPSBsYXN0X2NsaWVudCkg
ewo+IAo+IEZsaXAgdGhpcyBhcm91bmQ6Cj4gCj4gCWlmIChjbGllbnQgPT0gbGFzdF9jbGllbnQp
Cj4gCQlyZXR1cm4gMDsKPiAKPiA+ICsJCWN0eC0+bGFzdF9jbGllbnQgPSBjbGllbnQ7Cj4gPiAr
Cj4gPiArCQlpZiAoY2xpZW50ID09IGN0eC0+aTJjLnRjcGNfY2xpZW50KQo+ID4gKwkJCW9mZnNl
dCA9IFJTVkRfMDBfQUREUjsKPiA+ICsJCWVsc2UgaWYgKGNsaWVudCA9PSBjdHgtPmkyYy50eF9w
MF9jbGllbnQpCj4gPiArCQkJb2Zmc2V0ID0gUlNWRF9EMV9BRERSOwo+ID4gKwkJZWxzZSBpZiAo
Y2xpZW50ID09IGN0eC0+aTJjLnR4X3AxX2NsaWVudCkKPiA+ICsJCQlvZmZzZXQgPSBSU1ZEXzYw
X0FERFI7Cj4gPiArCQllbHNlIGlmIChjbGllbnQgPT0gY3R4LT5pMmMucnhfcDBfY2xpZW50KQo+
ID4gKwkJCW9mZnNldCA9IFJTVkRfMzlfQUREUjsKPiA+ICsJCWVsc2UgaWYgKGNsaWVudCA9PSBj
dHgtPmkyYy5yeF9wMV9jbGllbnQpCj4gPiArCQkJb2Zmc2V0ID0gUlNWRF83Rl9BRERSOwo+ID4g
KwkJZWxzZQo+ID4gKwkJCW9mZnNldCA9IFJTVkRfMDBfQUREUjsKPiA+ICsKPiA+ICsJCXJldCA9
IGkyY19zbWJ1c193cml0ZV9ieXRlX2RhdGEoY2xpZW50LCBvZmZzZXQsIDB4MDApOwo+ID4gKwkJ
aWYgKHJldCA8IDApCj4gPiArCQkJRFJNX0RFVl9FUlJPUihkZXYsCj4gPiArCQkJCSAgICAgICJm
YWlsZWQgdG8gYWNjZXNzIGkyYyBpZD0leFxuOiV4IiwKPiA+ICsJCQkJICAgICAgY2xpZW50LT5h
ZGRyLCBvZmZzZXQpOwo+ID4gKwl9Cj4gPiArCj4gPiArCXJldHVybiByZXQ7Cj4gPiArfQo+ID4g
Kwo+ID4gK3N0YXRpYyBpbnQgYW54NzYyNV9yZWdfcmVhZChzdHJ1Y3QgYW54NzYyNV9kYXRhICpj
dHgsCj4gPiArCQkJICAgIHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQsIHU4IHJlZ19hZGRyKQo+
ID4gK3sKPiA+ICsJaW50IHJldDsKPiA+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmNsaWVudC0+
ZGV2Owo+ID4gKwo+ID4gKwlpMmNfYWNjZXNzX3dvcmthcm91bmQoY3R4LCBjbGllbnQpOwo+ID4g
Kwo+ID4gKwlyZXQgPSBpMmNfc21idXNfcmVhZF9ieXRlX2RhdGEoY2xpZW50LCByZWdfYWRkcik7
Cj4gPiArCWlmIChyZXQgPCAwKQo+ID4gKwkJRFJNX0RFVl9FUlJPUihkZXYsICJyZWFkIGkyYyBm
YWlsZWQgaWQ9JXg6JXhcbiIsCj4gPiArCQkJICAgICAgY2xpZW50LT5hZGRyLCByZWdfYWRkcik7
Cj4gPiArCj4gPiArCXJldHVybiByZXQ7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgYW54
NzYyNV9yZWdfYmxvY2tfcmVhZChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCj4gPiArCQkJCSAg
c3RydWN0IGkyY19jbGllbnQgKmNsaWVudCwKPiA+ICsJCQkJICB1OCByZWdfYWRkciwgdTggbGVu
LCB1OCAqYnVmKQo+ID4gK3sKPiA+ICsJaW50IHJldDsKPiA+ICsJc3RydWN0IGRldmljZSAqZGV2
ID0gJmNsaWVudC0+ZGV2Owo+ID4gKwo+ID4gKwlpMmNfYWNjZXNzX3dvcmthcm91bmQoY3R4LCBj
bGllbnQpOwo+ID4gKwo+ID4gKwlyZXQgPSBpMmNfc21idXNfcmVhZF9pMmNfYmxvY2tfZGF0YShj
bGllbnQsIHJlZ19hZGRyLCBsZW4sIGJ1Zik7Cj4gPiArCWlmIChyZXQgPCAwKQo+ID4gKwkJRFJN
X0RFVl9FUlJPUihkZXYsICJyZWFkIGkyYyBibG9jayBmYWlsZWQgaWQ9JXg6JXhcbiIsCj4gPiAr
CQkJICAgICAgY2xpZW50LT5hZGRyLCByZWdfYWRkcik7Cj4gPiArCj4gPiArCXJldHVybiByZXQ7
Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgYW54NzYyNV9yZWdfd3JpdGUoc3RydWN0IGFu
eDc2MjVfZGF0YSAqY3R4LAo+ID4gKwkJCSAgICAgc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCwK
PiA+ICsJCQkgICAgIHU4IHJlZ19hZGRyLCB1OCByZWdfdmFsKQo+ID4gK3sKPiA+ICsJaW50IHJl
dDsKPiA+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmNsaWVudC0+ZGV2Owo+ID4gKwo+ID4gKwlp
MmNfYWNjZXNzX3dvcmthcm91bmQoY3R4LCBjbGllbnQpOwo+ID4gKwo+ID4gKwlyZXQgPSBpMmNf
c21idXNfd3JpdGVfYnl0ZV9kYXRhKGNsaWVudCwgcmVnX2FkZHIsIHJlZ192YWwpOwo+ID4gKwo+
ID4gKwlpZiAocmV0IDwgMCkKPiA+ICsJCURSTV9ERVZfRVJST1IoZGV2LCAiZmFpbGVkIHRvIHdy
aXRlIGkyYyBpZD0leFxuOiV4IiwKPiA+ICsJCQkgICAgICBjbGllbnQtPmFkZHIsIHJlZ19hZGRy
KTsKPiA+ICsKPiA+ICsJcmV0dXJuIHJldDsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBh
bng3NjI1X3dyaXRlX29yKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKPiA+ICsJCQkgICAgc3Ry
dWN0IGkyY19jbGllbnQgKmNsaWVudCwKPiA+ICsJCQkgICAgdTggb2Zmc2V0LCB1OCBtYXNrKQo+
ID4gK3sKPiA+ICsJaW50IHZhbCA9IGFueDc2MjVfcmVnX3JlYWQoY3R4LCBjbGllbnQsIG9mZnNl
dCk7Cj4gPiArCj4gPiArCXJldHVybiAodmFsIDwgMCkgPyB2YWwgOgo+ID4gKwkJYW54NzYyNV9y
ZWdfd3JpdGUoY3R4LCBjbGllbnQsIG9mZnNldCwgKHZhbCB8IChtYXNrKSkpOwo+IAo+IAo+IFdy
aXRlIHRoZXNlIGZ1bmN0aW9ucyBjbGVhbmVyIGxpa2UgdGhpczoKPiAKPiAJaW50IHZhbDsKPiAK
PiAJdmFsID0gYW54NzYyNV9yZWdfcmVhZChjdHgsIGNsaWVudCwgb2Zmc2V0KTsKPiAJaWYgKHZh
bCA8IDApCj4gCQlyZXR1cm4gdmFsOwo+IAo+IAlyZXR1cm4gYW54NzYyNV9yZWdfd3JpdGUoY3R4
LCBjbGllbnQsIG9mZnNldCwgKHZhbCB8IChtYXNrKSkpOwo+IAo+IAo+ID4gK30KPiA+ICsKPiA+
ICtzdGF0aWMgaW50IGFueDc2MjVfd3JpdGVfYW5kKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwK
PiA+ICsJCQkgICAgIHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQsCj4gPiArCQkJICAgICB1OCBv
ZmZzZXQsIHU4IG1hc2spCj4gPiArewo+ID4gKwlpbnQgdmFsID0gYW54NzYyNV9yZWdfcmVhZChj
dHgsIGNsaWVudCwgb2Zmc2V0KTsKPiA+ICsKPiA+ICsJcmV0dXJuICh2YWwgPCAwKSA/IHZhbCA6
Cj4gPiArCQlhbng3NjI1X3JlZ193cml0ZShjdHgsIGNsaWVudCwgb2Zmc2V0LCAodmFsICYgKG1h
c2spKSk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgYW54NzYyNV93cml0ZV9hbmRfb3Io
c3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAo+ID4gKwkJCQlzdHJ1Y3QgaTJjX2NsaWVudCAqY2xp
ZW50LAo+ID4gKwkJCQl1OCBvZmZzZXQsIHU4IGFuZF9tYXNrLCB1OCBvcl9tYXNrKQo+ID4gK3sK
PiA+ICsJaW50IHZhbCA9IGFueDc2MjVfcmVnX3JlYWQoY3R4LCBjbGllbnQsIG9mZnNldCk7Cj4g
PiArCj4gPiArCXJldHVybiAodmFsIDwgMCkgPyB2YWwgOgo+ID4gKwkJYW54NzYyNV9yZWdfd3Jp
dGUoY3R4LCBjbGllbnQsIG9mZnNldCwKPiA+ICsJCQkJICAodmFsICYgYW5kX21hc2spIHwgKG9y
X21hc2spKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBhbng3NjI1X2NvbmZpZ19iaXRf
bWF0cml4KHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKPiA+ICt7Cj4gPiArCWludCBpLCByZXQ7
Cj4gPiArCj4gPiArCXJldCA9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMudHhfcDJf
Y2xpZW50LAo+ID4gKwkJCQlBVURJT19DT05UUk9MX1JFR0lTVEVSLCAweDgwKTsKPiA+ICsJZm9y
IChpID0gMDsgaSA8IDEzOyBpKyspCj4gICAgICAgICAgICAgICAgICAgICAgICAgXl4KPiBNYWdp
YyBudW1iZXIuCj4gCj4gCj4gPiArCQlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgt
PmkyYy50eF9wMl9jbGllbnQsCj4gPiArCQkJCQkgVklERU9fQklUX01BVFJJWF8xMiArIGksCj4g
PiArCQkJCQkgMHgxOCArIGkpOwo+ID4gKwo+ID4gKwlyZXR1cm4gcmV0Owo+ID4gK30KPiA+ICsK
PiA+ICtzdGF0aWMgaW50IGFueDc2MjVfcmVhZF9jdHJsX3N0YXR1c19wMChzdHJ1Y3QgYW54NzYy
NV9kYXRhICpjdHgpCj4gPiArewo+ID4gKwlyZXR1cm4gYW54NzYyNV9yZWdfcmVhZChjdHgsIGN0
eC0+aTJjLnJ4X3AwX2NsaWVudCwgQVBfQVVYX0NUUkxfU1RBVFVTKTsKPiA+ICt9Cj4gPiArCj4g
PiArc3RhdGljIGludCB3YWl0X2F1eF9vcF9maW5pc2goc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4
KQo+ID4gK3sKPiA+ICsJaW50IHZhbDsKPiA+ICsJaW50IHJldDsKPiA+ICsJc3RydWN0IGRldmlj
ZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7Cj4gPiArCj4gPiArCXJldCA9IHJlYWR4X3BvbGxf
dGltZW91dChhbng3NjI1X3JlYWRfY3RybF9zdGF0dXNfcDAsCj4gPiArCQkJCSBjdHgsIHZhbCwK
PiA+ICsJCQkJICghKHZhbCAmIEFQX0FVWF9DVFJMX09QX0VOKSB8fCAodmFsIDwgMCkpLAo+ID4g
KwkJCQkgMjAwMCwKPiA+ICsJCQkJIDIwMDAgKiAxNTApOwo+ID4gKwlpZiAocmV0KSB7Cj4gPiAr
CQlEUk1fREVWX0VSUk9SKGRldiwgImF1eCBvcGVyYXRpb24gZmFpbGVkIVxuIik7Cj4gPiArCQl2
YWwgPSAtRUlPOwo+IAo+IFJldHVybiBkaXJlY3RseToKPiAKPiAJaWYgKHJldCkgewo+IAkJRFJN
X0RFVl9FUlJPUihkZXYsICJhdXggb3BlcmF0aW9uIGZhaWxlZCFcbiIpOwo+IAkJcmV0dXJuIHJl
dDsKPiAJfQo+IAo+IAo+ID4gKwl9IGVsc2Ugewo+ID4gKwkJdmFsID0gYW54NzYyNV9yZWdfcmVh
ZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiA+ICsJCQkJICAgICAgIEFQX0FVWF9DVFJM
X1NUQVRVUyk7Cj4gPiArCQlpZiAodmFsIDwgMCB8fCAodmFsICYgMHgwRikpIHsKPiA+ICsJCQlE
Uk1fREVWX0VSUk9SKGRldiwgImF1eCBzdGF0dXMgJTAyeFxuIiwgdmFsKTsKPiA+ICsJCQl2YWwg
PSAtRUlPOwo+ID4gKwkJfQo+ID4gKwl9Cj4gPiArCj4gPiArCXJldHVybiB2YWw7Cj4gPiArfQo+
ID4gKwo+ID4gK3N0YXRpYyBpbnQgd3JpdGVfZHBjZF9hZGRyKHN0cnVjdCBhbng3NjI1X2RhdGEg
KmN0eCwKPiA+ICsJCQkgICB1OCBhZGRyaCwgdTggYWRkcm0sIHU4IGFkZHJsKQo+ID4gK3sKPiA+
ICsJaW50IHJldDsKPiA+ICsKPiA+ICsJcmV0ID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgt
PmkyYy5yeF9wMF9jbGllbnQsCj4gPiArCQkJCUFQX0FVWF9BRERSXzdfMCwgKHU4KWFkZHJsKTsK
PiA+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50
LAo+ID4gKwkJCQkgQVBfQVVYX0FERFJfMTVfOCwgKHU4KWFkZHJtKTsKPiA+ICsJcmV0IHw9IGFu
eDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ID4gKwkJCQkgQVBf
QVVYX0FERFJfMTlfMTYsICh1OClhZGRyaCk7Cj4gPiArCj4gPiArCXJldHVybiByZXQ7Cj4gPiAr
fQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgc3BfdHhfYXV4X2RwY2RyZWFkX2J5dGVzKHN0cnVjdCBh
bng3NjI1X2RhdGEgKmN0eCwKPiA+ICsJCQkJICAgIHU4IGFkZHJoLCB1OCBhZGRybSwKPiA+ICsJ
CQkJICAgIHU4IGFkZHJsLCB1OCBjb3VudCwKPiA+ICsJCQkJICAgIHU4ICpidWYpCj4gPiArewo+
ID4gKwl1OCBjOwo+ID4gKwlpbnQgcmV0Owo+ID4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4
LT5jbGllbnQtPmRldjsKPiA+ICsKPiA+ICsJaWYgKFdBUk5fT04oY291bnQgPiAoc2l6ZV90KU1B
WF9EUENEX0JVRkZFUl9TSVpFKSkKPiAKPiBUaGlzIGNhc3QgaXMgbm90IHJlcXVpcmVkLgo+IAo+
ID4gKwkJcmV0dXJuIC1FMkJJRzsKPiA+ICsKPiA+ICsJLyogY29tbWFuZCBhbmQgbGVuZ3RoICov
Cj4gPiArCWMgPSAoKGNvdW50IC0gMSkgPDwgNCkgfCAweDA5Owo+ID4gKwlyZXQgPSBhbng3NjI1
X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwgQVBfQVVYX0NPTU1BTkQsIGMp
Owo+ID4gKwkvKiBhZGRyZXNzICovCj4gPiArCXJldCB8PSB3cml0ZV9kcGNkX2FkZHIoY3R4LCBh
ZGRyaCwgYWRkcm0sIGFkZHJsKTsKPiA+ICsJLyogYXV4IGVuICovCj4gPiArCXJldCB8PSBhbng3
NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LCBBUF9BVVhfQ1RSTF9TVEFU
VVMsCj4gPiArCQkJCUFQX0FVWF9DVFJMX09QX0VOKTsKPiA+ICsJaWYgKHJldCA8IDApIHsKPiA+
ICsJCURSTV9ERVZfRVJST1IoZGV2LCAiYXV4IGVuYWJsZSBmYWlsZWQuXG4iKTsKPiA+ICsJCXJl
dHVybiByZXQ7Cj4gPiArCX0KPiA+ICsKPiA+ICsJdXNsZWVwX3JhbmdlKDIwMDAsIDIxMDApOwo+
ID4gKwo+ID4gKwlyZXQgPSB3YWl0X2F1eF9vcF9maW5pc2goY3R4KTsKPiA+ICsJaWYgKHJldCA8
IDApIHsKPiA+ICsJCURSTV9ERVZfRVJST1IoZGV2LCAiYXV4IHJlYWQgZmFpbGVkXG4iKTsKPiA+
ICsJCXJldHVybiByZXQ7Cj4gPiArCX0KPiA+ICsKPiA+ICsJcmV0dXJuIGFueDc2MjVfcmVnX2Js
b2NrX3JlYWQoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4gPiArCQkJQVBfQVVYX0JVRkZf
U1RBUlQsIGNvdW50LCBidWYpOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW50IGFueDc2MjVf
dmlkZW9fbXV0ZV9jb250cm9sKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKPiA+ICsJCQkJICAg
ICAgdTggc3RhdHVzKQo+ID4gK3sKPiA+ICsJaW50IHJldDsKPiA+ICsKPiA+ICsJaWYgKHN0YXR1
cykgeyAvKiBtdXRlIG9uICovCj4gPiArCQkvKiBzZXQgbXV0ZSBmbGFnICovCj4gPiArCQlyZXQg
PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ID4gKwkJCQkg
ICAgICAgQVBfQVZfU1RBVFVTLCBBUF9NSVBJX01VVEUpOwo+ID4gKwkJLyogY2xlYXIgbWlwaSBS
WCBlbiAqLwo+ID4gKwkJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhf
cDBfY2xpZW50LAo+ID4gKwkJCQkJIEFQX0FWX1NUQVRVUywgKHU4KX5BUF9NSVBJX1JYX0VOKTsK
PiA+ICsJfSBlbHNlIHsgLyogbXV0ZSBvZmYgKi8KPiA+ICsJCS8qIGNsZWFyIG11dGUgZmxhZyAq
Lwo+ID4gKwkJcmV0ID0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGll
bnQsCj4gPiArCQkJCQlBUF9BVl9TVEFUVVMsICh1OCl+QVBfTUlQSV9NVVRFKTsKPiA+ICsJCS8q
IHNldCBNSVBJIFJYIEVOICovCj4gPiArCQlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0
eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiA+ICsJCQkJCUFQX0FWX1NUQVRVUywgQVBfTUlQSV9SWF9F
Tik7Cj4gPiArCX0KPiA+ICsKPiA+ICsJcmV0dXJuIHJldDsKPiA+ICt9Cj4gPiArCj4gPiArc3Rh
dGljIGludCBhbng3NjI1X2NvbmZpZ19hdWRpb19pbnB1dChzdHJ1Y3QgYW54NzYyNV9kYXRhICpj
dHgpCj4gPiArewo+ID4gKwlpbnQgcmV0Owo+ID4gKwo+ID4gKwkvKiBjaGFubmVsIG51bSAqLwo+
ID4gKwlyZXQgPSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnR4X3AyX2NsaWVudCwK
PiA+ICsJCQkJQVVESU9fQ0hBTk5FTF9TVEFUVVNfNiwgSTJTX0NIXzIgPDwgNSk7Cj4gPiArCS8q
IGxheW91dCAqLwo+ID4gKwkvKiBhcyBJMlMgY2hhbm5lbCBpcyAyLCBubyBuZWVkIHRvIHNldCBs
YXlvdXQgKi8KPiA+ICsKPiA+ICsJLyogRlMgKi8KPiA+ICsJcmV0IHw9IGFueDc2MjVfd3JpdGVf
YW5kX29yKGN0eCwgY3R4LT5pMmMudHhfcDJfY2xpZW50LAo+ID4gKwkJCQkgICAgQVVESU9fQ0hB
Tk5FTF9TVEFUVVNfNCwKPiA+ICsJCQkJICAgIDB4ZjAsIEFVRElPX0ZTXzQ4Syk7Cj4gPiArCS8q
IHdvcmQgbGVuZ3RoICovCj4gPiArCXJldCB8PSBhbng3NjI1X3dyaXRlX2FuZF9vcihjdHgsIGN0
eC0+aTJjLnR4X3AyX2NsaWVudCwKPiA+ICsJCQkJICAgIEFVRElPX0NIQU5ORUxfU1RBVFVTXzUs
Cj4gPiArCQkJCSAgICAweGYwLCBBVURJT19XX0xFTl8yNF8yNE1BWCk7Cj4gPiArCS8qIEkyUyAq
Lwo+ID4gKwlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnR4X3AyX2NsaWVu
dCwKPiA+ICsJCQkJQVVESU9fQ0hBTk5FTF9TVEFUVVNfNiwgSTJTX1NMQVZFX01PREUpOwo+ID4g
KwlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy50eF9wMl9jbGllbnQsCj4g
PiArCQkJCSBBVURJT19DT05UUk9MX1JFR0lTVEVSLCB+VERNX1RJTUlOR19NT0RFKTsKPiA+ICsJ
LyogYXVkaW8gY2hhbmdlIGZsYWcgKi8KPiA+ICsJcmV0IHw9IGFueDc2MjVfd3JpdGVfb3IoY3R4
LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4gPiArCQkJCUFQX0FWX1NUQVRVUywgQVBfQVVESU9f
Q0hHKTsKPiA+ICsKPiA+ICsJaWYgKHJldCA8IDApCj4gPiArCQlEUk1fRVJST1IoImZhaWxlZCB0
byBjb25maWcgYXVkaW8uXG4iKTsKPiA+ICsKPiA+ICsJcmV0dXJuIHJldDsKPiA+ICt9Cj4gPiAr
Cj4gPiArLyogcmVkdWN0aW9uIG9mIGZyYWN0aW9uIGEvYiAqLwo+ID4gK3N0YXRpYyB2b2lkIGFu
eDc2MjVfcmVkdWN0aW9uX29mX2FfZnJhY3Rpb24odW5zaWduZWQgbG9uZyAqYSwgdW5zaWduZWQg
bG9uZyAqYikKPiA+ICt7Cj4gPiArCXVuc2lnbmVkIGxvbmcgZ2NkX251bTsKPiA+ICsJdW5zaWdu
ZWQgbG9uZyB0bXBfYSwgdG1wX2I7Cj4gPiArCXUzMiBpID0gMTsKPiA+ICsKPiA+ICsJZ2NkX251
bSA9IGdjZCgqYSwgKmIpOwo+ID4gKwkqYSAvPSBnY2RfbnVtOwo+ID4gKwkqYiAvPSBnY2RfbnVt
Owo+ID4gKwo+ID4gKwl0bXBfYSA9ICphOwo+ID4gKwl0bXBfYiA9ICpiOwo+ID4gKwo+ID4gKwl3
aGlsZSAoKCphID4gTUFYX1VOU0lHTkVEXzI0QklUKSB8fCAoKmIgPiBNQVhfVU5TSUdORURfMjRC
SVQpKSB7Cj4gPiArCQlpKys7Cj4gPiArCQkqYSA9IHRtcF9hIC8gaTsKPiA+ICsJCSpiID0gdG1w
X2IgLyBpOwo+ID4gKwl9Cj4gPiArCj4gPiArCS8qCj4gPiArCSAqIGluIHRoZSBlbmQsIG1ha2Ug
YSwgYiBsYXJnZXIgdG8gaGF2ZSBoaWdoZXIgT0RGQyBQTEwKPiA+ICsJICogb3V0cHV0IGZyZXF1
ZW5jeSBhY2N1cmFjeQo+ID4gKwkgKi8KPiA+ICsJd2hpbGUgKCgqYSA8IE1BWF9VTlNJR05FRF8y
NEJJVCkgJiYgKCpiIDwgTUFYX1VOU0lHTkVEXzI0QklUKSkgewo+ID4gKwkJKmEgPDw9IDE7Cj4g
PiArCQkqYiA8PD0gMTsKPiA+ICsJfQo+ID4gKwo+ID4gKwkqYSA+Pj0gMTsKPiA+ICsJKmIgPj49
IDE7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgYW54NzYyNV9jYWxjdWxhdGVfbV9uKHUz
MiBwaXhlbGNsb2NrLAo+ID4gKwkJCQkgdW5zaWduZWQgbG9uZyAqbSwKPiA+ICsJCQkJIHVuc2ln
bmVkIGxvbmcgKm4sCj4gPiArCQkJCSB1OCAqcG9zdF9kaXZpZGVyKQo+ID4gK3sKPiA+ICsJaWYg
KHBpeGVsY2xvY2sgPiBQTExfT1VUX0ZSRVFfQUJTX01BWCAvIFBPU1RfRElWSURFUl9NSU4pIHsK
PiA+ICsJCS8qIHBpeGVsIGNsb2NrIGZyZXF1ZW5jeSBpcyB0b28gaGlnaCAqLwo+ID4gKwkJRFJN
X0VSUk9SKCJwaXhlbGNsb2NrIHRvbyBoaWdoLCBhY3QoJWQpLCBtYXhpbXVtKCVsdSlcbiIsCj4g
PiArCQkJICBwaXhlbGNsb2NrLAo+ID4gKwkJCSAgUExMX09VVF9GUkVRX0FCU19NQVggLyBQT1NU
X0RJVklERVJfTUlOKTsKPiA+ICsJCXJldHVybiAxOwo+IAo+IFJldHVybmluZyBvbmUgb24gZXJy
b3IgaXMgdWdseS4gIHJldHVybiAtRUlOVkFMOwo+IAo+ID4gKwl9Cj4gPiArCj4gPiArCWlmIChw
aXhlbGNsb2NrIDwgUExMX09VVF9GUkVRX0FCU19NSU4gLyBQT1NUX0RJVklERVJfTUFYKSB7Cj4g
PiArCQkvKiBwaXhlbCBjbG9jayBmcmVxdWVuY3kgaXMgdG9vIGxvdyAqLwo+ID4gKwkJRFJNX0VS
Uk9SKCJwaXhlbGNsb2NrIHRvbyBsb3csIGFjdCglZCksIG1heGltdW0oJWx1KVxuIiwKPiA+ICsJ
CQkgIHBpeGVsY2xvY2ssCj4gPiArCQkJICBQTExfT1VUX0ZSRVFfQUJTX01JTiAvIFBPU1RfRElW
SURFUl9NQVgpOwo+ID4gKwkJcmV0dXJuIDE7Cj4gPiArCX0KPiA+ICsKPiA+ICsJKnBvc3RfZGl2
aWRlciA9IDE7Cj4gPiArCj4gPiArCWZvciAoKnBvc3RfZGl2aWRlciA9IDE7Cj4gPiArCQlwaXhl
bGNsb2NrIDwgKFBMTF9PVVRfRlJFUV9NSU4gLyAoKnBvc3RfZGl2aWRlcikpOykKPiA+ICsJCSpw
b3N0X2RpdmlkZXIgKz0gMTsKPiA+ICsKPiA+ICsJaWYgKCpwb3N0X2RpdmlkZXIgPiBQT1NUX0RJ
VklERVJfTUFYKSB7Cj4gPiArCQlmb3IgKCpwb3N0X2RpdmlkZXIgPSAxOwo+ID4gKwkJCShwaXhl
bGNsb2NrIDwKPiA+ICsJCQkgKFBMTF9PVVRfRlJFUV9BQlNfTUlOIC8gKCpwb3N0X2RpdmlkZXIp
KSk7KQo+ID4gKwkJCSpwb3N0X2RpdmlkZXIgKz0gMTsKPiA+ICsKPiA+ICsJCWlmICgqcG9zdF9k
aXZpZGVyID4gUE9TVF9ESVZJREVSX01BWCkgewo+ID4gKwkJCURSTV9FUlJPUigiY2Fubm90IGZp
bmQgcHJvcGVydHkgcG9zdF9kaXZpZGVyKCVkKVxuIiwKPiA+ICsJCQkJICAqcG9zdF9kaXZpZGVy
KTsKPiA+ICsJCQlyZXR1cm4gMTsKPiA+ICsJCX0KPiA+ICsJfQo+ID4gKwo+ID4gKwkvKiBwYXRj
aCB0byBpbXByb3ZlIHRoZSBhY2N1cmFjeSAqLwo+ID4gKwlpZiAoKnBvc3RfZGl2aWRlciA9PSA3
KSB7Cj4gPiArCQkvKiAyNywwMDAsMDAwIGlzIG5vdCBkaXZpc2libGUgYnkgNyAqLwo+ID4gKwkJ
KnBvc3RfZGl2aWRlciA9IDg7Cj4gPiArCX0gZWxzZSBpZiAoKnBvc3RfZGl2aWRlciA9PSAxMSkg
ewo+ID4gKwkJLyogMjcsMDAwLDAwMCBpcyBub3QgZGl2aXNpYmxlIGJ5IDExICovCj4gPiArCQkq
cG9zdF9kaXZpZGVyID0gMTI7Cj4gPiArCX0gZWxzZSBpZiAoKCpwb3N0X2RpdmlkZXIgPT0gMTMp
IHx8ICgqcG9zdF9kaXZpZGVyID09IDE0KSkgewo+ID4gKwkJLyoyNywwMDAsMDAwIGlzIG5vdCBk
aXZpc2libGUgYnkgMTMgb3IgMTQqLwo+ID4gKwkJKnBvc3RfZGl2aWRlciA9IDE1Owo+ID4gKwl9
Cj4gPiArCj4gPiArCWlmIChwaXhlbGNsb2NrICogKCpwb3N0X2RpdmlkZXIpID4gUExMX09VVF9G
UkVRX0FCU19NQVgpIHsKPiA+ICsJCURSTV9FUlJPUigiYWN0IGNsb2NrKCV1KSBsYXJnZSB0aGFu
IG1heGltdW0oJWx1KVxuIiwKPiA+ICsJCQkgIHBpeGVsY2xvY2sgKiAoKnBvc3RfZGl2aWRlciks
Cj4gPiArCQkJICBQTExfT1VUX0ZSRVFfQUJTX01BWCk7Cj4gPiArCQlyZXR1cm4gMTsKPiA+ICsJ
fQo+ID4gKwo+ID4gKwkqbSA9IHBpeGVsY2xvY2s7Cj4gPiArCSpuID0gWFRBTF9GUlEgLyAoKnBv
c3RfZGl2aWRlcik7Cj4gPiArCj4gPiArCWFueDc2MjVfcmVkdWN0aW9uX29mX2FfZnJhY3Rpb24o
bSwgbik7Cj4gPiArCj4gPiArCXJldHVybiAwOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW50
IGFueDc2MjVfb2RmY19jb25maWcoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAo+ID4gKwkJCSAg
ICAgICB1OCBwb3N0X2RpdmlkZXIpCj4gPiArewo+ID4gKwlpbnQgcmV0Owo+ID4gKwo+ID4gKwkv
KiBjb25maWcgaW5wdXQgcmVmZXJlbmNlIGNsb2NrIGZyZXF1ZW5jeSAyN01Iei8xOS4yTUh6ICov
Cj4gPiArCXJldCA9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50
LCBNSVBJX0RJR0lUQUxfUExMXzE2LAo+ID4gKwkJCQl+KFJFRl9DTEtfMjcwMDBLSFogPDwgTUlQ
SV9GUkVGX0RfSU5EKSk7Cj4gPiArCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5p
MmMucnhfcDFfY2xpZW50LCBNSVBJX0RJR0lUQUxfUExMXzE2LAo+ID4gKwkJCQkoUkVGX0NMS18y
NzAwMEtIWiA8PCBNSVBJX0ZSRUZfRF9JTkQpKTsKPiA+ICsJLyogcG9zdCBkaXZpZGVyICovCj4g
PiArCXJldCB8PSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwK
PiA+ICsJCQkJIE1JUElfRElHSVRBTF9QTExfOCwgMHgwZik7Cj4gPiArCXJldCB8PSBhbng3NjI1
X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCBNSVBJX0RJR0lUQUxfUExMXzgs
Cj4gPiArCQkJCXBvc3RfZGl2aWRlciA8PCA0KTsKPiA+ICsKPiA+ICsJLyogYWRkIHBhdGNoIGZv
ciBNSVMyLTEyNSAoNXBjcyBBTlg3NjI1IGZhaWwgQVRFIE1CSVNUIHRlc3QpICovCj4gPiArCXJl
dCB8PSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9E
SUdJVEFMX1BMTF83LAo+ID4gKwkJCQkgfk1JUElfUExMX1ZDT19UVU5FX1JFR19WQUwpOwo+ID4g
Kwo+ID4gKwkvKiByZXNldCBPREZDIFBMTCAqLwo+ID4gKwlyZXQgfD0gYW54NzYyNV93cml0ZV9h
bmQoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIE1JUElfRElHSVRBTF9QTExfNywKPiA+ICsJ
CQkJIH5NSVBJX1BMTF9SRVNFVF9OKTsKPiA+ICsJcmV0IHw9IGFueDc2MjVfd3JpdGVfb3IoY3R4
LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIE1JUElfRElHSVRBTF9QTExfNywKPiA+ICsJCQkJTUlQ
SV9QTExfUkVTRVRfTik7Cj4gPiArCj4gPiArCWlmIChyZXQgPCAwKQo+ID4gKwkJRFJNX0VSUk9S
KCJJTyBlcnJvci5cbiIpOwo+ID4gKwo+ID4gKwlyZXR1cm4gcmV0Owo+ID4gK30KPiA+ICsKPiA+
ICtzdGF0aWMgaW50IGFueDc2MjVfZHNpX3ZpZGVvX3RpbWluZ19jb25maWcoc3RydWN0IGFueDc2
MjVfZGF0YSAqY3R4KQo+ID4gK3sKPiA+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xp
ZW50LT5kZXY7Cj4gPiArCXVuc2lnbmVkIGxvbmcgbSwgbjsKPiA+ICsJdTE2IGh0b3RhbDsKPiA+
ICsJaW50IHJldDsKPiA+ICsJdTggcG9zdF9kaXZpZGVyID0gMDsKPiA+ICsKPiA+ICsJcmV0ID0g
YW54NzYyNV9jYWxjdWxhdGVfbV9uKGN0eC0+ZHQucGl4ZWxjbG9jay5taW4gKiAxMDAwLAo+ID4g
KwkJCQkgICAgJm0sICZuLCAmcG9zdF9kaXZpZGVyKTsKPiA+ICsKPiA+ICsJaWYgKHJldCAhPSAw
KSB7Cj4gPiArCQlEUk1fRVJST1IoImNhbm5vdCBnZXQgcHJvcGVydHkgbSBuIHZhbHVlLlxuIik7
Cj4gPiArCQlyZXR1cm4gLUVJTlZBTDsKPiA+ICsJfQo+IAo+IAlpZiAocmV0KQo+IAkJcmV0dXJu
IHJldDsKPiAKPiA+ICsKPiA+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiY29tcHV0ZSBN
KCVsdSksIE4oJWx1KSwgZGl2aWRlciglZCkuXG4iLAo+ID4gKwkJCSAgICAgbSwgbiwgcG9zdF9k
aXZpZGVyKTsKPiA+ICsKPiA+ICsJLyogY29uZmlndXJlIHBpeGVsIGNsb2NrICovCj4gPiArCXJl
dCA9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LCBQSVhFTF9D
TE9DS19MLAo+ID4gKwkJCQkoY3R4LT5kdC5waXhlbGNsb2NrLm1pbiAvIDEwMDApICYgMHhGRik7
Cj4gPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVu
dCwgUElYRUxfQ0xPQ0tfSCwKPiA+ICsJCQkJIChjdHgtPmR0LnBpeGVsY2xvY2subWluIC8gMTAw
MCkgPj4gOCk7Cj4gPiArCS8qIGxhbmUgY291bnQgKi8KPiA+ICsJcmV0IHw9IGFueDc2MjVfd3Jp
dGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAo+ID4gKwkJCU1JUElfTEFORV9DVFJM
XzAsIDB4ZmMpOwo+ID4gKwlpZiAoY3R4LT5wZGF0YS5kc2lfbGFuZXMpCj4gPiArCQlyZXQgfD0g
YW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKPiA+ICsJCQkJCU1J
UElfTEFORV9DVFJMXzAsCj4gPiArCQkJCQkoY3R4LT5wZGF0YS5kc2lfbGFuZXMgLSAxKSk7Cj4g
PiArCWVsc2UKPiA+ICsJCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhf
cDFfY2xpZW50LAo+ID4gKwkJCQkJTUlQSV9MQU5FX0NUUkxfMCwgMyk7Cj4gPiArCj4gPiArCS8q
IEh0b3RhbCAqLwo+ID4gKwlodG90YWwgPSBjdHgtPmR0LmhhY3RpdmUubWluICsgY3R4LT5kdC5o
ZnJvbnRfcG9yY2gubWluICsKPiA+ICsJCWN0eC0+ZHQuaGJhY2tfcG9yY2gubWluICsgY3R4LT5k
dC5oc3luY19sZW4ubWluOwo+ID4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgt
PmkyYy5yeF9wMl9jbGllbnQsCj4gPiArCQkJSE9SSVpPTlRBTF9UT1RBTF9QSVhFTFNfTCwgaHRv
dGFsICYgMHhGRik7Cj4gPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJj
LnJ4X3AyX2NsaWVudCwKPiA+ICsJCQlIT1JJWk9OVEFMX1RPVEFMX1BJWEVMU19ILCBodG90YWwg
Pj4gOCk7Cj4gPiArCS8qIEhhY3RpdmUgKi8KPiA+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRl
KGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAo+ID4gKwkJCUhPUklaT05UQUxfQUNUSVZFX1BJ
WEVMU19MLCBjdHgtPmR0LmhhY3RpdmUubWluICYgMHhGRik7Cj4gPiArCXJldCB8PSBhbng3NjI1
X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwKPiA+ICsJCQlIT1JJWk9OVEFM
X0FDVElWRV9QSVhFTFNfSCwgY3R4LT5kdC5oYWN0aXZlLm1pbiA+PiA4KTsKPiA+ICsJLyogSEZQ
ICovCj4gPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2Ns
aWVudCwKPiA+ICsJCQlIT1JJWk9OVEFMX0ZST05UX1BPUkNIX0wsIGN0eC0+ZHQuaGZyb250X3Bv
cmNoLm1pbik7Cj4gPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4
X3AyX2NsaWVudCwKPiA+ICsJCQlIT1JJWk9OVEFMX0ZST05UX1BPUkNIX0gsCj4gPiArCQkJY3R4
LT5kdC5oZnJvbnRfcG9yY2gubWluID4+IDgpOwo+ID4gKwkvKiBIV1MgKi8KPiA+ICsJcmV0IHw9
IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAo+ID4gKwkJCUhP
UklaT05UQUxfU1lOQ19XSURUSF9MLCBjdHgtPmR0LmhzeW5jX2xlbi5taW4pOwo+ID4gKwlyZXQg
fD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQsCj4gPiArCQkJ
SE9SSVpPTlRBTF9TWU5DX1dJRFRIX0gsIGN0eC0+ZHQuaHN5bmNfbGVuLm1pbiA+PiA4KTsKPiA+
ICsJLyogSEJQICovCj4gPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJj
LnJ4X3AyX2NsaWVudCwKPiA+ICsJCQlIT1JJWk9OVEFMX0JBQ0tfUE9SQ0hfTCwgY3R4LT5kdC5o
YmFja19wb3JjaC5taW4pOwo+ID4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgt
PmkyYy5yeF9wMl9jbGllbnQsCj4gPiArCQkJSE9SSVpPTlRBTF9CQUNLX1BPUkNIX0gsIGN0eC0+
ZHQuaGJhY2tfcG9yY2gubWluID4+IDgpOwo+ID4gKwkvKiBWYWN0aXZlICovCj4gPiArCXJldCB8
PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwgQUNUSVZFX0xJ
TkVTX0wsCj4gPiArCQkJY3R4LT5kdC52YWN0aXZlLm1pbik7Cj4gPiArCXJldCB8PSBhbng3NjI1
X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwgQUNUSVZFX0xJTkVTX0gsCj4g
PiArCQkJY3R4LT5kdC52YWN0aXZlLm1pbiA+PiA4KTsKPiA+ICsJLyogVkZQICovCj4gPiArCXJl
dCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwKPiA+ICsJ
CQlWRVJUSUNBTF9GUk9OVF9QT1JDSCwgY3R4LT5kdC52ZnJvbnRfcG9yY2gubWluKTsKPiA+ICsJ
LyogVldTICovCj4gPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4
X3AyX2NsaWVudCwKPiA+ICsJCQlWRVJUSUNBTF9TWU5DX1dJRFRILCBjdHgtPmR0LnZzeW5jX2xl
bi5taW4pOwo+ID4gKwkvKiBWQlAgKi8KPiA+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0
eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAo+ID4gKwkJCVZFUlRJQ0FMX0JBQ0tfUE9SQ0gsIGN0
eC0+ZHQudmJhY2tfcG9yY2gubWluKTsKPiA+ICsJLyogTSB2YWx1ZSAqLwo+ID4gKwlyZXQgfD0g
YW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCj4gPiArCQkJTUlQ
SV9QTExfTV9OVU1fMjNfMTYsIChtID4+IDE2KSAmIDB4ZmYpOwo+ID4gKwlyZXQgfD0gYW54NzYy
NV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCj4gPiArCQkJTUlQSV9QTExf
TV9OVU1fMTVfOCwgKG0gPj4gOCkgJiAweGZmKTsKPiA+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dy
aXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAo+ID4gKwkJCU1JUElfUExMX01fTlVNXzdf
MCwgKG0gJiAweGZmKSk7Cj4gPiArCS8qIE4gdmFsdWUgKi8KPiA+ICsJcmV0IHw9IGFueDc2MjVf
cmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAo+ID4gKwkJCU1JUElfUExMX05f
TlVNXzIzXzE2LCAobiA+PiAxNikgJiAweGZmKTsKPiA+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dy
aXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAo+ID4gKwkJCU1JUElfUExMX05fTlVNXzE1
XzgsIChuID4+IDgpICYgMHhmZik7Cj4gPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgs
IGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9QTExfTl9OVU1fN18wLAo+ID4gKwkJCShuICYg
MHhmZikpOwo+ID4gKwkvKiBkaWZmICovCj4gPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShj
dHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKPiA+ICsJCQlNSVBJX0RJR0lUQUxfQURKXzEsIDB4
MzcpOwo+ID4gKwo+ID4gKwlyZXQgfD0gYW54NzYyNV9vZGZjX2NvbmZpZyhjdHgsIHBvc3RfZGl2
aWRlciAtIDEpOwo+ID4gKwo+ID4gKwlpZiAocmV0IDwgMCkKPiA+ICsJCURSTV9FUlJPUigibWlw
aSBkc2kgc2V0dXAgSU8gZXJyb3IuXG4iKTsKPiA+ICsKPiA+ICsJcmV0dXJuIHJldDsKPiA+ICt9
Cj4gPiArCj4gPiArc3RhdGljIGludCBhbng3NjI1X3N3YXBfZHNpX2xhbmUzKHN0cnVjdCBhbng3
NjI1X2RhdGEgKmN0eCkKPiA+ICt7Cj4gPiArCWludCB2YWw7Cj4gPiArCj4gPiArCS8qIHN3YXAg
TUlQSS1EU0kgZGF0YSBsYW5lIDMgUCBhbmQgTiAqLwo+ID4gKwl2YWwgPSBhbng3NjI1X3JlZ19y
ZWFkKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCBNSVBJX1NXQVApOwo+ID4gKwlpZiAodmFs
IDwgMCkgewo+ID4gKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGFjY2VzcyBNSVBJX1NXQVAuXG4i
KTsKPiA+ICsJCXJldHVybiAtRUlPOwo+ID4gKwl9Cj4gPiArCj4gPiArCXZhbCB8PSAoMSA8PCBN
SVBJX1NXQVBfQ0gzKTsKPiA+ICsJcmV0dXJuIGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5p
MmMucnhfcDFfY2xpZW50LCBNSVBJX1NXQVAsIHZhbCk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRp
YyBpbnQgYW54NzYyNV9hcGlfZHNpX2NvbmZpZyhzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4g
PiArCj4gPiArewo+ID4gKwlpbnQgdmFsLCByZXQ7Cj4gPiArCj4gPiArCS8qIHN3YXAgTUlQSS1E
U0kgZGF0YSBsYW5lIDMgUCBhbmQgTiAqLwo+ID4gKwlyZXQgPSBhbng3NjI1X3N3YXBfZHNpX2xh
bmUzKGN0eCk7Cj4gPiArCWlmIChyZXQgPCAwKSB7Cj4gPiArCQlEUk1fRVJST1IoIklPIGVycm9y
IDogc3dhcCBkc2kgbGFuZSAzIGZhaWxlZC5cbiIpOwo+ID4gKwkJcmV0dXJuIHJldDsKPiA+ICsJ
fQo+ID4gKwo+ID4gKwkvKiBEU0kgY2xvY2sgc2V0dGluZ3MgKi8KPiA+ICsJdmFsID0gKDAgPDwg
TUlQSV9IU19QV0RfQ0xLKQkJfAo+ID4gKwkJKDAgPDwgTUlQSV9IU19SVF9DTEspCQl8Cj4gPiAr
CQkoMCA8PCBNSVBJX1BEX0NMSykJCXwKPiA+ICsJCSgxIDw8IE1JUElfQ0xLX1JUX01BTlVBTF9Q
RF9FTikJfAo+ID4gKwkJKDEgPDwgTUlQSV9DTEtfSFNfTUFOVUFMX1BEX0VOKQl8Cj4gPiArCQko
MCA8PCBNSVBJX0NMS19ERVRfREVUX0JZUEFTUykJfAo+ID4gKwkJKDAgPDwgTUlQSV9DTEtfTUlT
U19DVFJMKQl8Cj4gPiArCQkoMCA8PCBNSVBJX1BEX0xQVFhfQ0hfTUFOVUFMX1BEX0VOKTsKPiA+
ICsJcmV0ID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCj4g
PiArCQkJCU1JUElfUEhZX0NPTlRST0xfMywgdmFsKTsKPiA+ICsKPiA+ICsJLyoKPiA+ICsJICog
RGVjcmVhc2VkIEhTIHByZXBhcmUgdGltaW5nIGRlbGF5IGZyb20gMTYwbnMgdG8gODBucyB3b3Jr
IHdpdGgKPiA+ICsJICogICAgIGEpIERyYWdvbiBib2FyZCA4MTAgc2VyaWVzIChRdWFsY29tbSBB
UCkKPiA+ICsJICogICAgIGIpIE1vdmluZyBQaXhlbCBEU0kgc291cmNlIChQRzNBIHBhdHRlcm4g
Z2VuZXJhdG9yICsKPiA+ICsJICoJUDMzMiBELVBIWSBQcm9iZSkgZGVmYXVsdCBELVBIWSB0aW1p
bmcKPiA+ICsJICoJNW5zL3N0ZXAKPiA+ICsJICovCj4gPiArCXJldCB8PSBhbng3NjI1X3JlZ193
cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKPiA+ICsJCQkJIE1JUElfVElNRV9IU19Q
UlBSLCAweDEwKTsKPiA+ICsKPiA+ICsJLyogZW5hYmxlIERTSSBtb2RlKi8KPiA+ICsJcmV0IHw9
IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIE1JUElfRElHSVRB
TF9QTExfMTgsCj4gPiArCQkJCVNFTEVDVF9EU0kgPDwgTUlQSV9EUElfU0VMRUNUKTsKPiA+ICsK
PiA+ICsJcmV0IHw9IGFueDc2MjVfZHNpX3ZpZGVvX3RpbWluZ19jb25maWcoY3R4KTsKPiA+ICsJ
aWYgKHJldCA8IDApIHsKPiA+ICsJCURSTV9FUlJPUigiZHNpIHZpZGVvIHRpbWluZyBjb25maWcg
ZmFpbGVkXG4iKTsKPiA+ICsJCXJldHVybiByZXQ7Cj4gPiArCX0KPiA+ICsKPiA+ICsJLyogdG9n
Z2xlIG0sIG4gcmVhZHkgKi8KPiA+ICsJcmV0ID0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgt
PmkyYy5yeF9wMV9jbGllbnQsIE1JUElfRElHSVRBTF9QTExfNiwKPiA+ICsJCQkJfihNSVBJX01f
TlVNX1JFQURZIHwgTUlQSV9OX05VTV9SRUFEWSkpOwo+ID4gKwl1c2xlZXBfcmFuZ2UoMTAwMCwg
MTEwMCk7Cj4gPiArCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDFf
Y2xpZW50LCBNSVBJX0RJR0lUQUxfUExMXzYsCj4gPiArCQkJCU1JUElfTV9OVU1fUkVBRFkgfCBN
SVBJX05fTlVNX1JFQURZKTsKPiA+ICsKPiA+ICsJLyogY29uZmlndXJlIGludGVnZXIgc3RhYmxl
IHJlZ2lzdGVyICovCj4gPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJj
LnJ4X3AxX2NsaWVudCwKPiA+ICsJCQkJIE1JUElfVklERU9fU1RBQkxFX0NOVCwgMHgwMik7Cj4g
PiArCS8qIHBvd2VyIG9uIE1JUEkgUlggKi8KPiA+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRl
KGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAo+ID4gKwkJCQkgTUlQSV9MQU5FX0NUUkxfMTAs
IDB4MDApOwo+ID4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9w
MV9jbGllbnQsCj4gPiArCQkJCSBNSVBJX0xBTkVfQ1RSTF8xMCwgMHg4MCk7Cj4gPiArCj4gPiAr
CWlmIChyZXQgPCAwKQo+ID4gKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IG1pcGkgZHNpIGVuYWJs
ZSBpbml0IGZhaWxlZC5cbiIpOwo+ID4gKwo+ID4gKwlyZXR1cm4gcmV0Owo+ID4gK30KPiA+ICsK
PiA+ICtzdGF0aWMgaW50IGFueDc2MjVfZHNpX2NvbmZpZyhzdHJ1Y3QgYW54NzYyNV9kYXRhICpj
dHgpCj4gPiArewo+ID4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsK
PiA+ICsJaW50IHJldDsKPiA+ICsKPiA+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiY29u
ZmlnIGRzaS5cbiIpOwo+ID4gKwo+ID4gKwkvKiBEU0MgZGlzYWJsZSAqLwo+ID4gKwlyZXQgPSBh
bng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiA+ICsJCQkJUl9E
U0NfQ1RSTF8wLCB+RFNDX0VOKTsKPiA+ICsKPiA+ICsJcmV0IHw9IGFueDc2MjVfYXBpX2RzaV9j
b25maWcoY3R4KTsKPiA+ICsKPiA+ICsJaWYgKHJldCA8IDApIHsKPiA+ICsJCURSTV9FUlJPUigi
SU8gZXJyb3IgOiBhcGkgZHNpIGNvbmZpZyBlcnJvci5cbiIpOwo+ID4gKwl9IGVsc2Ugewo+ID4g
KwkJLyogc2V0IE1JUEkgUlggRU4gKi8KPiA+ICsJCXJldCA9IGFueDc2MjVfd3JpdGVfb3IoY3R4
LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4gPiArCQkJCSAgICAgICBBUF9BVl9TVEFUVVMsIEFQ
X01JUElfUlhfRU4pOwo+ID4gKwkJLyogY2xlYXIgbXV0ZSBmbGFnICovCj4gPiArCQlyZXQgfD0g
YW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4gPiArCQkJCQkg
QVBfQVZfU1RBVFVTLCAodTgpfkFQX01JUElfTVVURSk7Cj4gPiArCQlpZiAocmV0IDwgMCkKPiA+
ICsJCQlEUk1fRVJST1IoIklPIGVycm9yIDogZW5hYmxlIG1pcGkgcnggZmFpbGVkLlxuIik7Cj4g
PiArCQllbHNlCj4gPiArCQkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAic3VjY2VzcyB0byBj
b25maWcgRFNJXG4iKTsKPiA+ICsJfQo+ID4gKwo+ID4gKwlyZXR1cm4gcmV0Owo+ID4gK30KPiA+
ICsKPiA+ICtzdGF0aWMgaW50IGFueDc2MjVfYXBpX2RwaV9jb25maWcoc3RydWN0IGFueDc2MjVf
ZGF0YSAqY3R4KQo+ID4gK3sKPiA+ICsJdTE2IGZyZXEgPSBjdHgtPmR0LnBpeGVsY2xvY2subWlu
IC8gMTAwMDsKPiA+ICsJaW50IHJldDsKPiA+ICsKPiA+ICsJLyogY29uZmlndXJlIHBpeGVsIGNs
b2NrICovCj4gPiArCXJldCA9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBf
Y2xpZW50LAo+ID4gKwkJCQlQSVhFTF9DTE9DS19MLCBmcmVxICYgMHhGRik7Cj4gPiArCXJldCB8
PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiA+ICsJCQkJ
IFBJWEVMX0NMT0NLX0gsIChmcmVxID4+IDgpKTsKPiA+ICsKPiA+ICsJLyogc2V0IERQSSBtb2Rl
ICovCj4gPiArCS8qIHNldCB0byBEUEkgUExMIG1vZHVsZSBzZWwgKi8KPiA+ICsJcmV0IHw9IGFu
eDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAo+ID4gKwkJCQkgTUlQ
SV9ESUdJVEFMX1BMTF85LCAweDIwKTsKPiA+ICsJLyogcG93ZXIgZG93biBNSVBJICovCj4gPiAr
CXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKPiA+
ICsJCQkJIE1JUElfTEFORV9DVFJMXzEwLCAweDA4KTsKPiA+ICsJLyogZW5hYmxlIERQSSBtb2Rl
ICovCj4gPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2Ns
aWVudCwKPiA+ICsJCQkJIE1JUElfRElHSVRBTF9QTExfMTgsIDB4MUMpOwo+ID4gKwkvKiBzZXQg
Zmlyc3QgZWRnZSAqLwo+ID4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmky
Yy50eF9wMl9jbGllbnQsCj4gPiArCQkJCSBWSURFT19DT05UUk9MXzAsIDB4MDUpOwo+ID4gKwlp
ZiAocmV0IDwgMCkKPiA+ICsJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBkcGkgcGh5IHNldCBmYWls
ZWQuXG4iKTsKPiA+ICsKPiA+ICsJcmV0dXJuIHJldDsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGlj
IGludCBhbng3NjI1X2RwaV9jb25maWcoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQo+ID4gK3sK
PiA+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7Cj4gPiArCWludCBy
ZXQ7Cj4gPiArCj4gPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImNvbmZpZyBkcGlcbiIp
Owo+ID4gKwo+ID4gKwkvKiBEU0MgZGlzYWJsZSAqLwo+ID4gKwlyZXQgPSBhbng3NjI1X3dyaXRl
X2FuZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiA+ICsJCQkJUl9EU0NfQ1RSTF8wLCB+
RFNDX0VOKTsKPiA+ICsJaWYgKHJldCA8IDApIHsKPiA+ICsJCURSTV9FUlJPUigiSU8gZXJyb3Ig
OiBkaXNhYmxlIGRzYyBmYWlsZWQuXG4iKTsKPiA+ICsJCXJldHVybiByZXQ7Cj4gPiArCX0KPiA+
ICsKPiA+ICsJcmV0ID0gYW54NzYyNV9jb25maWdfYml0X21hdHJpeChjdHgpOwo+ID4gKwlpZiAo
cmV0IDwgMCkgewo+ID4gKwkJRFJNX0VSUk9SKCJjb25maWcgYml0IG1hdHJpeCBmYWlsZWQuXG4i
KTsKPiA+ICsJCXJldHVybiByZXQ7Cj4gPiArCX0KPiA+ICsKPiA+ICsJcmV0ID0gYW54NzYyNV9h
cGlfZHBpX2NvbmZpZyhjdHgpOwo+ID4gKwlpZiAocmV0IDwgMCkgewo+ID4gKwkJRFJNX0VSUk9S
KCJtaXBpIHBoeShkcGkpIHNldHVwIGZhaWxlZC5cbiIpOwo+ID4gKwkJcmV0dXJuIHJldDsKPiA+
ICsJfQo+ID4gKwo+ID4gKwkvKiBzZXQgTUlQSSBSWCBFTiAqLwo+ID4gKwlyZXQgPSBhbng3NjI1
X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ID4gKwkJCSAgICAgICBBUF9B
Vl9TVEFUVVMsIEFQX01JUElfUlhfRU4pOwo+ID4gKwkvKiBjbGVhciBtdXRlIGZsYWcgKi8KPiA+
ICsJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+
ID4gKwkJCQkgQVBfQVZfU1RBVFVTLCAodTgpfkFQX01JUElfTVVURSk7Cj4gPiArCWlmIChyZXQg
PCAwKQo+ID4gKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGVuYWJsZSBtaXBpIHJ4IGZhaWxlZC5c
biIpOwo+ID4gKwo+ID4gKwlyZXR1cm4gcmV0Owo+ID4gK30KPiA+ICsKPiA+ICtjb25zdCB1OCBB
TlhfT1VJWzNdID0geyAweDAwLCAweDIyLCAweEI5IH07Cj4gPiArc3RhdGljIGludCBpc19hbnhf
ZG9uZ2xlKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKPiA+ICt7Cj4gPiArCXU4IGJ1ZlszXTsK
PiA+ICsKPiA+ICsJLyogMHgwNTAwfjB4MDUwMjogQlJBTkNIX0lFRUVfT1VJICovCj4gPiArCXNw
X3R4X2F1eF9kcGNkcmVhZF9ieXRlcyhjdHgsIDB4MDAsIDB4MDUsIDB4MDAsIHNpemVvZihidWYp
LCBidWYpOwo+ID4gKwlpZiAobWVtY21wKGJ1ZiwgQU5YX09VSSwgc2l6ZW9mKGJ1ZikpID09IDAp
Cj4gPiArCQlyZXR1cm4gMTsKPiA+ICsKPiA+ICsJcmV0dXJuIDA7Cj4gPiArfQo+ID4gKwo+ID4g
K3N0YXRpYyB2b2lkIHNwX3R4X2dldF9yeF9idyhzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsIHU4
ICpidykKPiA+ICt7Cj4gPiArCXU4IGRhdGFfYnVmWzRdOwo+ID4gKwkvKgo+ID4gKwkgKiBXaGVu
IEFOWCBkb25nbGUgY29ubmVjdGVkLCBpZiBDSElQX0lEID0gMHg3NzUwLCBiYW5kd2lkdGggaXMg
Ni43NUcsCj4gPiArCSAqIGJlY2F1c2UgQU5YNzc1MCBEUENEIDB4MDUyeCB3YXMgbm90IGF2YWls
YWJsZS4KPiA+ICsJICovCj4gPiArCWlmIChpc19hbnhfZG9uZ2xlKGN0eCkpIHsKPiA+ICsJCXNw
X3R4X2F1eF9kcGNkcmVhZF9ieXRlcyhjdHgsIDB4MDAsIDB4MDUsIDB4MDMsIDB4MDQsIGRhdGFf
YnVmKTsKPiA+ICsJCWlmIChkYXRhX2J1ZlswXSA9PSAweDM3ICYmIGRhdGFfYnVmWzFdID09IDB4
MzcgJiYKPiA+ICsJCSAgICBkYXRhX2J1ZlsyXSA9PSAweDM1ICYmIGRhdGFfYnVmWzNdID09IDB4
MzApIHsKPiA+ICsJCQkvKiAweDE5IDogNi43NUcgKi8KPiA+ICsJCQkqYncgPSAweDE5Owo+ID4g
KwkJfSBlbHNlIHsKPiA+ICsJCQlzcF90eF9hdXhfZHBjZHJlYWRfYnl0ZXMoY3R4LCAweDAwLCAw
eDA1LCAweDIxLCAxLCBidyk7Cj4gPiArCQkJLyoKPiA+ICsJCQkgKiBzb21lIEFOWCBkb25nbGUg
cmVhZCBvdXQgdmFsdWUgMCwKPiA+ICsJCQkgKiByZXRyeSBzdGFuZGFyZCByZWdpc3Rlci4KPiA+
ICsJCQkgKi8KPiA+ICsJCQlpZiAoKCgqYncpID09IDApIHx8ICgoKmJ3KSA9PSAweGZmKSkKPiA+
ICsJCQkJc3BfdHhfYXV4X2RwY2RyZWFkX2J5dGVzKGN0eCwgMHgwMCwgMHgwMCwKPiA+ICsJCQkJ
CQkJIERQQ0RfTUFYX0xJTktfUkFURSwKPiA+ICsJCQkJCQkJIDEsIGJ3KTsKPiA+ICsJCX0KPiA+
ICsJfSBlbHNlIHsKPiA+ICsJCXNwX3R4X2F1eF9kcGNkcmVhZF9ieXRlcyhjdHgsIDB4MDAsIDB4
MDAsCj4gPiArCQkJCQkgRFBDRF9NQVhfTElOS19SQVRFLCAxLCBidyk7Cj4gPiArCX0KPiA+ICt9
Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgYW54NzYyNV9kcF9zdGFydChzdHJ1Y3QgYW54NzYyNV9k
YXRhICpjdHgpCj4gPiArewo+ID4gKwlpbnQgcmV0Owo+ID4gKwo+ID4gKwlpZiAoIWN0eC0+ZGlz
cGxheV90aW1pbmdfdmFsaWQpIHsKPiA+ICsJCURSTV9FUlJPUigibWlwaSBkcm0gaGF2ZW4ndCBz
ZXQgZGlzcGxheSB0aW1pbmcgeWV0LlxuIik7Cj4gPiArCQlyZXR1cm47Cj4gPiArCX0KPiA+ICsK
PiA+ICsJcmV0ID0gYW54NzYyNV9jb25maWdfYXVkaW9faW5wdXQoY3R4KTsKPiA+ICsJaWYgKHJl
dCA8IDApCj4gPiArCQlEUk1fRVJST1IoImNvbmZpZyBhdWRpbyBpbnB1dCBmYWlsZWQuXG4iKTsK
PiAKPiByZXR1cm4gYWZ0ZXIgZXJyb3I/Cj4gCj4gPiArCj4gPiArCWlmIChjdHgtPnBkYXRhLmRz
aV9zdXBwb3J0ZWQpCj4gPiArCQlyZXQgPSBhbng3NjI1X2RzaV9jb25maWcoY3R4KTsKPiA+ICsJ
ZWxzZQo+ID4gKwkJcmV0ID0gYW54NzYyNV9kcGlfY29uZmlnKGN0eCk7Cj4gPiArCj4gPiArCWlm
IChyZXQgPCAwKQo+ID4gKwkJRFJNX0VSUk9SKCJNSVBJIHBoeSBzZXR1cCBlcnJvci5cbiIpOwo+
ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCBhbng3NjI1X2RwX3N0b3Aoc3RydWN0IGFueDc2
MjVfZGF0YSAqY3R4KQo+ID4gK3sKPiA+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xp
ZW50LT5kZXY7Cj4gPiArCWludCByZXQ7Cj4gPiArCj4gPiArCURSTV9ERVZfREVCVUdfRFJJVkVS
KGRldiwgInN0b3AgZHAgb3V0cHV0XG4iKTsKPiA+ICsKPiA+ICsJLyoKPiA+ICsJICogdmlkZW8g
ZGlzYWJsZTogMHg3MjowOCBiaXQgNyA9IDA7Cj4gPiArCSAqIGF1ZGlvIGRpc2FibGU6IDB4NzA6
ODcgYml0IDAgPSAwOwo+ID4gKwkgKi8KPiA+ICsJcmV0ID0gYW54NzYyNV93cml0ZV9hbmQoY3R4
LCBjdHgtPmkyYy50eF9wMF9jbGllbnQsIDB4ODcsIDB4ZmUpOwo+ID4gKwlyZXQgfD0gYW54NzYy
NV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy50eF9wMl9jbGllbnQsIDB4MDgsIDB4N2YpOwo+ID4g
Kwo+ID4gKwlyZXQgfD0gYW54NzYyNV92aWRlb19tdXRlX2NvbnRyb2woY3R4LCAxKTsKPiA+ICsJ
aWYgKHJldCA8IDApCj4gPiArCQlEUk1fRVJST1IoIklPIGVycm9yIDogbXV0ZSB2aWRlbyBmYWls
ZWRcbiIpOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW50IHNwX3R4X3JzdF9hdXgoc3RydWN0
IGFueDc2MjVfZGF0YSAqY3R4KQo+ID4gK3sKPiA+ICsJaW50IHJldDsKPiA+ICsKPiA+ICsJcmV0
ID0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnR4X3AyX2NsaWVudCwgUlNUX0NUUkwy
LAo+ID4gKwkJCSAgICAgICBBVVhfUlNUKTsKPiA+ICsJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5k
KGN0eCwgY3R4LT5pMmMudHhfcDJfY2xpZW50LCBSU1RfQ1RSTDIsCj4gPiArCQkJCSB+QVVYX1JT
VCk7Cj4gPiArCXJldHVybiByZXQ7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgc3BfdHhf
YXV4X3dyKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwgdTggb2Zmc2V0KQo+ID4gK3sKPiA+ICsJ
aW50IHJldDsKPiA+ICsKPiA+ICsJcmV0ID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmky
Yy5yeF9wMF9jbGllbnQsCj4gPiArCQkJCUFQX0FVWF9CVUZGX1NUQVJULCBvZmZzZXQpOwo+ID4g
KwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4g
PiArCQkJCSBBUF9BVVhfQ09NTUFORCwgMHgwNCk7Cj4gPiArCXJldCB8PSBhbng3NjI1X3dyaXRl
X29yKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ID4gKwkJCQlBUF9BVVhfQ1RSTF9TVEFU
VVMsIEFQX0FVWF9DVFJMX09QX0VOKTsKPiA+ICsJcmV0dXJuIChyZXQgfCB3YWl0X2F1eF9vcF9m
aW5pc2goY3R4KSk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgc3BfdHhfYXV4X3JkKHN0
cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwgdTggbGVuX2NtZCkKPiA+ICt7Cj4gPiArCWludCByZXQ7
Cj4gPiArCj4gPiArCXJldCA9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBf
Y2xpZW50LAo+ID4gKwkJCQlBUF9BVVhfQ09NTUFORCwgbGVuX2NtZCk7Cj4gPiArCXJldCB8PSBh
bng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ID4gKwkJCQlBUF9B
VVhfQ1RSTF9TVEFUVVMsIEFQX0FVWF9DVFJMX09QX0VOKTsKPiA+ICsJcmV0dXJuIChyZXQgfCB3
YWl0X2F1eF9vcF9maW5pc2goY3R4KSk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgc3Bf
dHhfZ2V0X2VkaWRfYmxvY2soc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQo+ID4gK3sKPiA+ICsJ
aW50IGMgPSAwOwo+ID4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsK
PiA+ICsKPiA+ICsJc3BfdHhfYXV4X3dyKGN0eCwgMHg3ZSk7Cj4gPiArCXNwX3R4X2F1eF9yZChj
dHgsIDB4MDEpOwo+ID4gKwljID0gYW54NzYyNV9yZWdfcmVhZChjdHgsIGN0eC0+aTJjLnJ4X3Aw
X2NsaWVudCwgQVBfQVVYX0JVRkZfU1RBUlQpOwo+ID4gKwlpZiAoYyA8IDApIHsKPiA+ICsJCURS
TV9FUlJPUigiSU8gZXJyb3IgOiBhY2Nlc3MgQVVYIEJVRkYuXG4iKTsKPiA+ICsJCXJldHVybiAt
RUlPOwo+ID4gKwl9Cj4gPiArCj4gPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIiBFRElE
IEJsb2NrID0gJWRcbiIsIGMgKyAxKTsKPiA+ICsKPiA+ICsJaWYgKGMgPiAzKQo+ID4gKwkJYyA9
IDE7Cj4gPiArCj4gPiArCXJldHVybiBjOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW50IGVk
aWRfcmVhZChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCj4gPiArCQkgICAgIHU4IG9mZnNldCwg
dTggKnBibG9ja19idWYpCj4gPiArewo+ID4gKwl1OCBjLCBjbnQgPSAwOwo+ICAgICAgICAgICAg
ICAgICAgIF5eXgo+IAo+ICJjIiBuZWVkcyB0byBiZSBhbiBpbnRlZ2VyLiAgImNudCIgc2hvdWxk
IGJlIGFuIGludCB0b28sIGJ1dCBpdCBkb2Vzbid0Cj4gY2F1c2UgYSBidWcgZWl0aGVyIHdheS4g
IERlbGV0ZSB0aGUgYm9ndXMgImNudCIgaW5pdGlhbGl6YXRpb24uCj4gCj4gPiArCXN0cnVjdCBk
ZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ID4gKwo+ID4gKwljID0gMDsKPiAgICAg
ICAgIF5eXl5eCj4gRGVsZXRlLgo+IAo+ID4gKwlmb3IgKGNudCA9IDA7IGNudCA8IDM7IGNudCsr
KSB7Cj4gPiArCQlzcF90eF9hdXhfd3IoY3R4LCBvZmZzZXQpOwo+ID4gKwkJLyogc2V0IEkyQyBy
ZWFkIGNvbSAweDAxIG1vdCA9IDAgYW5kIHJlYWQgMTYgYnl0ZXMgKi8KPiA+ICsJCWMgPSBzcF90
eF9hdXhfcmQoY3R4LCAweGYxKTsKPiA+ICsKPiA+ICsJCWlmIChjID09IDEpIHsKPiAKPiAxIGlz
IGEgbWFnaWMgbnVtYmVyIGhlcmUuICBXZSBuZWVkIHRvIGNoZWNrIGZvciBuZWdhdGl2ZSByZXR1
cm5zIGFzCj4gd2VsbC4KPiAKPiAKPiA+ICsJCQlzcF90eF9yc3RfYXV4KGN0eCk7Cj4gPiArCQkJ
RFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZWRpZCByZWFkIGZhaWxlZCwgcmVzZXQhXG4iKTsK
PiA+ICsJCQljbnQrKzsKPiA+ICsJCX0gZWxzZSB7Cj4gPiArCQkJYW54NzYyNV9yZWdfYmxvY2tf
cmVhZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiA+ICsJCQkJCSAgICAgICBBUF9BVVhf
QlVGRl9TVEFSVCwKPiA+ICsJCQkJCSAgICAgICBNQVhfRFBDRF9CVUZGRVJfU0laRSwKPiA+ICsJ
CQkJCSAgICAgICBwYmxvY2tfYnVmKTsKPiA+ICsJCQlyZXR1cm4gMDsKPiA+ICsJCX0KPiA+ICsJ
fQo+ID4gKwo+ID4gKwlyZXR1cm4gMTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBzZWdt
ZW50c19lZGlkX3JlYWQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAo+ID4gKwkJCSAgICAgIHU4
IHNlZ21lbnQsIHU4ICpidWYsIHU4IG9mZnNldCkKPiA+ICt7Cj4gPiArCXU4IGMsIGNudCA9IDA7
Cj4gCj4gYyBuZWVkcyB0byBiZSBhbiBpbnQuCj4gCj4gPiArCWludCByZXQ7Cj4gPiArCXN0cnVj
dCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ID4gKwo+ID4gKwkvKiB3cml0ZSBh
ZGRyZXNzIG9ubHkgKi8KPiA+ICsJcmV0ID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmky
Yy5yeF9wMF9jbGllbnQsCj4gPiArCQkJCUFQX0FVWF9BRERSXzdfMCwgMHgzMCk7Cj4gPiArCXJl
dCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiA+ICsJ
CQkJIEFQX0FVWF9DT01NQU5ELCAweDA0KTsKPiA+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRl
KGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ID4gKwkJCQkgQVBfQVVYX0NUUkxfU1RBVFVT
LAo+ID4gKwkJCQkgQVBfQVVYX0NUUkxfQUREUk9OTFkgfCBBUF9BVVhfQ1RSTF9PUF9FTik7Cj4g
PiArCj4gPiArCXJldCB8PSB3YWl0X2F1eF9vcF9maW5pc2goY3R4KTsKPiA+ICsJLyogd3JpdGUg
c2VnbWVudCBhZGRyZXNzICovCj4gPiArCXJldCB8PSBzcF90eF9hdXhfd3IoY3R4LCBzZWdtZW50
KTsKPiA+ICsJLyogZGF0YSByZWFkICovCj4gPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShj
dHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiA+ICsJCQkJIEFQX0FVWF9BRERSXzdfMCwgMHg1
MCk7Cj4gPiArCWlmIChyZXQgPCAwKSB7Cj4gPiArCQlEUk1fRVJST1IoIklPIGVycm9yIDogYXV4
IGluaXRpYWwgZmFpbGVkLlxuIik7Cj4gPiArCQlyZXR1cm4gcmV0Owo+ID4gKwl9Cj4gPiArCj4g
PiArCWZvciAoY250ID0gMDsgY250IDwgMzsgY250KyspIHsKPiA+ICsJCXNwX3R4X2F1eF93cihj
dHgsIG9mZnNldCk7Cj4gPiArCQkvKiBzZXQgSTJDIHJlYWQgY29tIDB4MDEgbW90ID0gMCBhbmQg
cmVhZCAxNiBieXRlcyAqLwo+ID4gKwkJYyA9IHNwX3R4X2F1eF9yZChjdHgsIDB4ZjEpOwo+ID4g
Kwo+ID4gKwkJaWYgKGMgPT0gMSkgewo+IAo+IAo+IFdoZXJlIGRvZXMgMSBjb21lIGZyb20/ICBX
ZSBuZWVkIHRvIGNoZWNrIGZvciBuZWdhdGl2ZSByZXR1cm5zLgo+IAo+ID4gKwkJCXJldCA9IHNw
X3R4X3JzdF9hdXgoY3R4KTsKPiA+ICsJCQlEUk1fREVWX0VSUk9SKGRldiwgInNlZ21lbnQgcmVh
ZCBmYWlsZWQsIHJlc2V0IVxuIik7Cj4gPiArCQkJY250Kys7Cj4gPiArCQl9IGVsc2Ugewo+ID4g
KwkJCXJldCA9IGFueDc2MjVfcmVnX2Jsb2NrX3JlYWQoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGll
bnQsCj4gPiArCQkJCQkJICAgICBBUF9BVVhfQlVGRl9TVEFSVCwKPiA+ICsJCQkJCQkgICAgIE1B
WF9EUENEX0JVRkZFUl9TSVpFLCBidWYpOwo+ID4gKwkJCXJldHVybiByZXQ7Cj4gPiArCQl9Cj4g
PiArCX0KPiA+ICsKPiA+ICsJcmV0dXJuIHJldDsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGlu
dCBzcF90eF9lZGlkX3JlYWQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAo+ID4gKwkJCSAgIHU4
ICpwZWRpZF9ibG9ja3NfYnVmKQo+ID4gK3sKPiA+ICsJdTggb2Zmc2V0LCBlZGlkX3BvczsKPiA+
ICsJaW50IGNvdW50LCBibG9ja3NfbnVtOwo+ID4gKwl1OCBwYmxvY2tfYnVmW01BWF9EUENEX0JV
RkZFUl9TSVpFXTsKPiA+ICsJdTggaSwgajsKPiA+ICsJdTggZ19lZGlkX2JyZWFrID0gMDsKPiA+
ICsJaW50IHJldDsKPiA+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7
Cj4gPiArCj4gPiArCS8qIGFkZHJlc3MgaW5pdGlhbCAqLwo+ID4gKwlyZXQgPSBhbng3NjI1X3Jl
Z193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiA+ICsJCQkJQVBfQVVYX0FERFJf
N18wLCAweDUwKTsKPiA+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMu
cnhfcDBfY2xpZW50LAo+ID4gKwkJCQkgQVBfQVVYX0FERFJfMTVfOCwgMCk7Cj4gPiArCXJldCB8
PSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiA+ICsJCQkJ
IEFQX0FVWF9BRERSXzE5XzE2LCAweGYwKTsKPiA+ICsJaWYgKHJldCA8IDApIHsKPiA+ICsJCURS
TV9FUlJPUigiYWNjZXNzIGF1eCBjaGFubmVsIElPIGVycm9yLlxuIik7Cj4gPiArCQlyZXR1cm4g
LUVJTzsKPiA+ICsJfQo+ID4gKwo+ID4gKwlibG9ja3NfbnVtID0gc3BfdHhfZ2V0X2VkaWRfYmxv
Y2soY3R4KTsKPiA+ICsJaWYgKGJsb2Nrc19udW0gPCAwKQo+ID4gKwkJcmV0dXJuIGJsb2Nrc19u
dW07Cj4gPiArCj4gPiArCWNvdW50ID0gMDsKPiA+ICsKPiA+ICsJZG8gewo+ID4gKwkJc3dpdGNo
IChjb3VudCkgewo+ID4gKwkJY2FzZSAwOgo+ID4gKwkJY2FzZSAxOgo+ID4gKwkJCWZvciAoaSA9
IDA7IGkgPCA4OyBpKyspIHsKPiA+ICsJCQkJb2Zmc2V0ID0gKGkgKyBjb3VudCAqIDgpICogTUFY
X0RQQ0RfQlVGRkVSX1NJWkU7Cj4gPiArCQkJCWdfZWRpZF9icmVhayA9IGVkaWRfcmVhZChjdHgs
IG9mZnNldCwKPiA+ICsJCQkJCQkJIHBibG9ja19idWYpOwo+ID4gKwo+ID4gKwkJCQlpZiAoZ19l
ZGlkX2JyZWFrID09IDEpCj4gPiArCQkJCQlicmVhazsKPiA+ICsKPiA+ICsJCQkJbWVtY3B5KCZw
ZWRpZF9ibG9ja3NfYnVmW29mZnNldF0sCj4gPiArCQkJCSAgICAgICBwYmxvY2tfYnVmLAo+ID4g
KwkJCQkgICAgICAgTUFYX0RQQ0RfQlVGRkVSX1NJWkUpOwo+ID4gKwkJCX0KPiA+ICsKPiA+ICsJ
CQlicmVhazsKPiA+ICsJCWNhc2UgMjoKPiA+ICsJCQlvZmZzZXQgPSAweDAwOwo+ID4gKwo+ID4g
KwkJCWZvciAoaiA9IDA7IGogPCA4OyBqKyspIHsKPiA+ICsJCQkJZWRpZF9wb3MgPSAoaiArIGNv
dW50ICogOCkgKgo+ID4gKwkJCQkJTUFYX0RQQ0RfQlVGRkVSX1NJWkU7Cj4gPiArCj4gPiArCQkJ
CWlmIChnX2VkaWRfYnJlYWsgPT0gMSkKPiA+ICsJCQkJCWJyZWFrOwo+ID4gKwo+ID4gKwkJCQlz
ZWdtZW50c19lZGlkX3JlYWQoY3R4LCBjb3VudCAvIDIsCj4gPiArCQkJCQkJICAgcGJsb2NrX2J1
Ziwgb2Zmc2V0KTsKPiA+ICsJCQkJbWVtY3B5KCZwZWRpZF9ibG9ja3NfYnVmW2VkaWRfcG9zXSwK
PiA+ICsJCQkJICAgICAgIHBibG9ja19idWYsCj4gPiArCQkJCSAgICAgICBNQVhfRFBDRF9CVUZG
RVJfU0laRSk7Cj4gPiArCQkJCW9mZnNldCA9IG9mZnNldCArIDB4MTA7Cj4gPiArCQkJfQo+ID4g
Kwo+ID4gKwkJCWJyZWFrOwo+ID4gKwkJY2FzZSAzOgo+ID4gKwkJCW9mZnNldCA9IDB4ODA7Cj4g
PiArCj4gPiArCQkJZm9yIChqID0gMDsgaiA8IDg7IGorKykgewo+ID4gKwkJCQllZGlkX3BvcyA9
IChqICsgY291bnQgKiA4KSAqCj4gPiArCQkJCQlNQVhfRFBDRF9CVUZGRVJfU0laRTsKPiA+ICsJ
CQkJaWYgKGdfZWRpZF9icmVhayA9PSAxKQo+ID4gKwkJCQkJYnJlYWs7Cj4gPiArCj4gPiArCQkJ
CXNlZ21lbnRzX2VkaWRfcmVhZChjdHgsIGNvdW50IC8gMiwKPiA+ICsJCQkJCQkgICBwYmxvY2tf
YnVmLCBvZmZzZXQpOwo+ID4gKwkJCQltZW1jcHkoJnBlZGlkX2Jsb2Nrc19idWZbZWRpZF9wb3Nd
LAo+ID4gKwkJCQkgICAgICAgcGJsb2NrX2J1ZiwKPiA+ICsJCQkJICAgICAgIE1BWF9EUENEX0JV
RkZFUl9TSVpFKTsKPiA+ICsJCQkJb2Zmc2V0ID0gb2Zmc2V0ICsgMHgxMDsKPiA+ICsJCQl9Cj4g
PiArCj4gPiArCQkJYnJlYWs7Cj4gPiArCQlkZWZhdWx0Ogo+ID4gKwkJCWJyZWFrOwo+ID4gKwkJ
fQo+ID4gKwo+ID4gKwkJY291bnQrKzsKPiA+ICsKPiA+ICsJfSB3aGlsZSAoYmxvY2tzX251bSA+
PSBjb3VudCk7Cj4gPiArCj4gPiArCS8qIGNoZWNrIGVkaWQgZGF0YSAqLwo+ID4gKwlpZiAoZHJt
X2VkaWRfaXNfdmFsaWQoKHN0cnVjdCBlZGlkICopcGVkaWRfYmxvY2tzX2J1ZikgPT0gZmFsc2Up
Cj4gPiArCQlEUk1fREVWX0VSUk9SKGRldiwgIldBUk5JTkchIGVkaWQgY2hlY2sgZmFpbGVkIVxu
Iik7Cj4gPiArCj4gPiArCS8qIHJlc2V0IGF1eCBjaGFubmVsICovCj4gPiArCXNwX3R4X3JzdF9h
dXgoY3R4KTsKPiA+ICsKPiA+ICsJcmV0dXJuIGJsb2Nrc19udW07Cj4gPiArfQo+ID4gKwo+ID4g
K3N0YXRpYyB2b2lkIGFueDc2MjVfcG93ZXJfb24oc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQo+
ID4gK3sKPiA+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7Cj4gPiAr
Cj4gPiArCWlmIChjdHgtPnBkYXRhLmxvd19wb3dlcl9tb2RlKSB7Cj4gCj4gRmxpcCB0aGlzIGFy
b3VuZC4KPiAKPiAJaWYgKCFjdHgtPnBkYXRhLmxvd19wb3dlcl9tb2RlKSB7Cj4gCQlEUk1fREVW
X0RFQlVHX0RSSVZFUihkZXYsICJBbng3NjI1IG5vdCBsb3cgcG93ZXIgbW9kZSFcbiIpOwo+IAkJ
cmV0dXJuOwo+IAl9Cj4gCj4gPiArCQkvKiBwb3dlciBvbiBwaW4gZW5hYmxlICovCj4gPiArCQln
cGlvX3NldF92YWx1ZShjdHgtPnBkYXRhLmdwaW9fcF9vbiwgMSk7Cj4gPiArCQl1c2xlZXBfcmFu
Z2UoMTAwMDAsIDExMDAwKTsKPiA+ICsJCS8qIHBvd2VyIHJlc2V0IHBpbiBlbmFibGUgKi8KPiA+
ICsJCWdwaW9fc2V0X3ZhbHVlKGN0eC0+cGRhdGEuZ3Bpb19yZXNldCwgMSk7Cj4gPiArCQl1c2xl
ZXBfcmFuZ2UoMTAwMDAsIDExMDAwKTsKPiA+ICsKPiA+ICsJCURSTV9ERVZfREVCVUdfRFJJVkVS
KGRldiwgIkFueDc2MjUgcG93ZXIgb24gIVxuIik7Cj4gPiArCX0gZWxzZSB7Cj4gPiArCQlEUk1f
REVWX0RFQlVHX0RSSVZFUihkZXYsICJBbng3NjI1IG5vdCBsb3cgcG93ZXIgbW9kZSFcbiIpOwo+
ID4gKwl9Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGFueDc2MjVfcG93ZXJfc3RhbmRi
eShzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gPiArewo+ID4gKwlzdHJ1Y3QgZGV2aWNlICpk
ZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKPiA+ICsKPiA+ICsJaWYgKGN0eC0+cGRhdGEubG93X3Bv
d2VyX21vZGUpIHsKPiAKPiBGbGlwLgo+IAo+ID4gKwkJZ3Bpb19zZXRfdmFsdWUoY3R4LT5wZGF0
YS5ncGlvX3Jlc2V0LCAwKTsKPiA+ICsJCXVzbGVlcF9yYW5nZSgxMDAwLCAxMTAwKTsKPiA+ICsJ
CWdwaW9fc2V0X3ZhbHVlKGN0eC0+cGRhdGEuZ3Bpb19wX29uLCAwKTsKPiA+ICsJCXVzbGVlcF9y
YW5nZSgxMDAwLCAxMTAwKTsKPiA+ICsJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImFueDc2
MjUgcG93ZXIgZG93blxuIik7Cj4gPiArCX0gZWxzZSB7Cj4gPiArCQlEUk1fREVWX0RFQlVHX0RS
SVZFUihkZXYsICJhbng3NjI1IG5vdCBsb3cgcG93ZXIgbW9kZSFcbiIpOwo+ID4gKwl9Cj4gPiAr
fQo+ID4gKwo+ID4gKy8qIGJhc2ljIGNvbmZpZ3VyYXRpb25zIG9mIEFOWDc2MjUgKi8KPiA+ICtz
dGF0aWMgdm9pZCBhbng3NjI1X2NvbmZpZyhzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gPiAr
ewo+ID4gKwlhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiA+
ICsJCQkgIFhUQUxfRlJRX1NFTCwgWFRBTF9GUlFfMjdNKTsKPiA+ICt9Cj4gPiArCj4gPiArc3Rh
dGljIHZvaWQgYW54NzYyNV9kaXNhYmxlX3BkX3Byb3RvY29sKHN0cnVjdCBhbng3NjI1X2RhdGEg
KmN0eCkKPiA+ICt7Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2
Owo+ID4gKwlpbnQgcmV0Owo+ID4gKwo+ID4gKwkvKiByZXNldCBtYWluIG9jbSAqLwo+ID4gKwly
ZXQgPSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwgMHg4OCwg
MHg0MCk7Cj4gPiArCS8qIERpc2FibGUgUEQgKi8KPiA+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dy
aXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ID4gKwkJCQkgQVBfQVZfU1RBVFVTLCBB
UF9ESVNBQkxFX1BEKTsKPiA+ICsJLyogcmVsZWFzZSBtYWluIG9jbSAqLwo+ID4gKwlyZXQgfD0g
YW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsIDB4ODgsIDB4MDAp
Owo+ID4gKwo+ID4gKwlpZiAocmV0IDwgMCkKPiA+ICsJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRl
diwgImRpc2FibGUgUEQgZmVhdHVyZSBmYWlsZWQuXG4iKTsKPiA+ICsJZWxzZQo+ID4gKwkJRFJN
X0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZGlzYWJsZSBQRCBmZWF0dXJlIHN1Y2NlZWRlZC5cbiIp
Owo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCBhbng3NjI1X3Bvd2VyX29uX2luaXQoc3Ry
dWN0IGFueDc2MjVfZGF0YSAqY3R4KQo+ID4gK3sKPiA+ICsJaW50IHJldHJ5X2NvdW50LCBpOwo+
ID4gKwlpbnQgcmV0ID0gMDsKPiAgICAgICAgICAgICAgICBeXl5eCj4gRGVsZXRlIGluaXRpYWxp
emF0aW9uLgo+IAo+ID4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsK
PiA+ICsKPiA+ICsJZm9yIChyZXRyeV9jb3VudCA9IDA7IHJldHJ5X2NvdW50IDwgMzsgcmV0cnlf
Y291bnQrKykgewo+ID4gKwkJYW54NzYyNV9wb3dlcl9vbihjdHgpOwo+ID4gKwkJYW54NzYyNV9j
b25maWcoY3R4KTsKPiA+ICsKPiA+ICsJCWZvciAoaSA9IDA7IGkgPCBPQ01fTE9BRElOR19USU1F
OyBpKyspIHsKPiA+ICsJCQkvKiBjaGVjayBpbnRlcmZhY2Ugd29ya2FibGUgKi8KPiA+ICsJCQly
ZXQgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ID4gKwkJ
CQkJICAgICAgIEZMQVNIX0xPQURfU1RBKTsKPiA+ICsJCQlpZiAocmV0IDwgMCkgewo+ID4gKwkJ
CQlEUk1fRVJST1IoIklPIGVycm9yIDogYWNjZXNzIGZsYXNoIGxvYWQuXG4iKTsKPiA+ICsJCQkJ
cmV0dXJuOwo+ID4gKwkJCX0KPiA+ICsJCQlpZiAoKHJldCAmIEZMQVNIX0xPQURfU1RBX0NISykg
PT0gRkxBU0hfTE9BRF9TVEFfQ0hLKSB7Cj4gPiArCQkJCWFueDc2MjVfZGlzYWJsZV9wZF9wcm90
b2NvbChjdHgpOwo+ID4gKwkJCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsCj4gPiArCQkJCQkJ
ICAgICAiRmlybXdhcmUgdmVyICUwMnglMDJ4LCIsCj4gPiArCQkJCQlhbng3NjI1X3JlZ19yZWFk
KGN0eCwKPiA+ICsJCQkJCQkJIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiA+ICsJCQkJCQkJIE9D
TV9GV19WRVJTSU9OKSwKPiA+ICsJCQkJCWFueDc2MjVfcmVnX3JlYWQoY3R4LAo+ID4gKwkJCQkJ
CQkgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ID4gKwkJCQkJCQkgT0NNX0ZXX1JFVkVSU0lPTikp
Owo+ID4gKwkJCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJEcml2ZXIgdmVyc2lvbiAlc1xu
IiwKPiA+ICsJCQkJCQkgICAgIEFOWDc2MjVfRFJWX1ZFUlNJT04pOwo+ID4gKwo+ID4gKwkJCQly
ZXR1cm47Cj4gPiArCQkJfQo+ID4gKwkJCXVzbGVlcF9yYW5nZSgxMDAwLCAxMTAwKTsKPiA+ICsJ
CX0KPiA+ICsJCWFueDc2MjVfcG93ZXJfc3RhbmRieShjdHgpOwo+ID4gKwl9Cj4gPiArfQo+ID4g
Kwo+ID4gK3N0YXRpYyBpbnQgYW54NzYyNV9leHRjb25fbm90aWZpZXIoc3RydWN0IG5vdGlmaWVy
X2Jsb2NrICpuYiwKPiA+ICsJCQkJICAgdW5zaWduZWQgbG9uZyBldmVudCwgdm9pZCAqcHRyKQo+
ID4gK3sKPiA+ICsJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0KPiA+ICsJCWNvbnRhaW5lcl9v
ZihuYiwgc3RydWN0IGFueDc2MjVfZGF0YSwgZXZlbnRfbmIpOwo+ID4gKwo+ID4gKwlzY2hlZHVs
ZV93b3JrKCZjdHgtPmV4dGNvbl93cSk7Cj4gPiArCXJldHVybiBOT1RJRllfRE9ORTsKPiA+ICt9
Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgYW54NzYyNV9jaGlwX2NvbnRyb2woc3RydWN0IGFueDc2
MjVfZGF0YSAqY3R4KQo+ID4gK3sKPiA+ICsJaW50IHN0YXRlID0gZXh0Y29uX2dldF9zdGF0ZShj
dHgtPmV4dGNvbiwgRVhUQ09OX0RJU1BfRFApOwo+ID4gKwo+ID4gKwlpZiAoY3R4LT5wZGF0YS5s
b3dfcG93ZXJfbW9kZSkgewo+ID4gKwkJaWYgKHN0YXRlID4gMCkgewo+ID4gKwkJCWlmIChhdG9t
aWNfcmVhZCgmY3R4LT5wb3dlcl9zdGF0dXMpID09IDApIHsKPiA+ICsJCQkJYW54NzYyNV9wb3dl
cl9vbl9pbml0KGN0eCk7Cj4gPiArCQkJCWF0b21pY19zZXQoJmN0eC0+cG93ZXJfc3RhdHVzLCAx
KTsKPiA+ICsJCQl9Cj4gPiArCQl9IGVsc2Ugewo+ID4gKwkJCWlmIChhdG9taWNfcmVhZCgmY3R4
LT5wb3dlcl9zdGF0dXMpID09IDEpIHsKPiA+ICsJCQkJYW54NzYyNV9wb3dlcl9zdGFuZGJ5KGN0
eCk7Cj4gPiArCQkJCWF0b21pY19zZXQoJmN0eC0+cG93ZXJfc3RhdHVzLCAwKTsKPiA+ICsJCQl9
Cj4gPiArCQl9Cj4gPiArCX0KPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgYW54NzYyNV9l
eHRjb25fd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gPiArewo+ID4gKwlzdHJ1Y3Qg
YW54NzYyNV9kYXRhICpjdHggPQo+ID4gKwkJY29udGFpbmVyX29mKHdvcmssIHN0cnVjdCBhbng3
NjI1X2RhdGEsIGV4dGNvbl93cSk7Cj4gPiArCj4gPiArCW11dGV4X2xvY2soJmN0eC0+bG9jayk7
Cj4gPiArCWFueDc2MjVfY2hpcF9jb250cm9sKGN0eCk7Cj4gPiArCW11dGV4X3VubG9jaygmY3R4
LT5sb2NrKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBhbng3NjI1X2V4dGNvbl9ub3Rp
Zmllcl9pbml0KHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKPiA+ICt7Cj4gPiArCWludCByZXQ7
Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ID4gKwo+ID4g
KwljdHgtPmV2ZW50X25iLm5vdGlmaWVyX2NhbGwgPSBhbng3NjI1X2V4dGNvbl9ub3RpZmllcjsK
PiA+ICsJSU5JVF9XT1JLKCZjdHgtPmV4dGNvbl93cSwgYW54NzYyNV9leHRjb25fd29yayk7Cj4g
PiArCXJldCA9IGRldm1fZXh0Y29uX3JlZ2lzdGVyX25vdGlmaWVyKCZjdHgtPmNsaWVudC0+ZGV2
LCBjdHgtPmV4dGNvbiwKPiA+ICsJCQkJCSAgICBFWFRDT05fRElTUF9EUCwgJmN0eC0+ZXZlbnRf
bmIpOwo+ID4gKwlpZiAocmV0KSB7Cj4gPiArCQlEUk1fREVWX0VSUk9SKGRldiwgImZhaWxlZCB0
byByZWdpc3RlciBub3RpZmllciBmb3IgRFAiKTsKPiA+ICsJCXJldHVybiByZXQ7Cj4gPiArCX0K
PiA+ICsJcmV0dXJuIDA7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGFueDc2MjVfZnJl
ZV9ncGlvKHN0cnVjdCBhbng3NjI1X2RhdGEgKnBsYXRmb3JtKQo+ID4gK3sKPiA+ICsJaWYgKHBs
YXRmb3JtLT5wZGF0YS5ncGlvX2ludHJfaHBkKQo+ID4gKwkJZ3Bpb19mcmVlKHBsYXRmb3JtLT5w
ZGF0YS5ncGlvX2ludHJfaHBkKTsKPiA+ICsKPiA+ICsJaWYgKHBsYXRmb3JtLT5wZGF0YS5sb3df
cG93ZXJfbW9kZSkgewo+ID4gKwkJZ3Bpb19mcmVlKHBsYXRmb3JtLT5wZGF0YS5ncGlvX3Jlc2V0
KTsKPiA+ICsJCWdwaW9fZnJlZShwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19wX29uKTsKPiA+ICsJfQo+
ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW50IGFueDc2MjVfaW5pdF9ncGlvKHN0cnVjdCBhbng3
NjI1X2RhdGEgKnBsYXRmb3JtKQo+ID4gK3sKPiA+ICsJaW50IHJldCA9IDA7Cj4gPiArCXN0cnVj
dCBkZXZpY2UgKmRldiA9ICZwbGF0Zm9ybS0+Y2xpZW50LT5kZXY7Cj4gPiArCj4gPiArCURSTV9E
RVZfREVCVUdfRFJJVkVSKGRldiwgImFueDc2MjUgaW5pdCBncGlvXG4iKTsKPiA+ICsKPiA+ICsJ
aWYgKHBsYXRmb3JtLT5wZGF0YS5sb3dfcG93ZXJfbW9kZSkgewo+ID4gKwkJLyogZ3BpbyBmb3Ig
Y2hpcCBwb3dlciBkb3duICovCj4gPiArCQlyZXQgPSBncGlvX3JlcXVlc3QocGxhdGZvcm0tPnBk
YXRhLmdwaW9fcF9vbiwKPiA+ICsJCQkJICAgImFueDc2MjVfcF9vbl9jdGwiKTsKPiA+ICsJCWlm
IChyZXQpIHsKPiA+ICsJCQlEUk1fREVWX0VSUk9SKGRldiwgImZhaWxlZCB0byByZXF1ZXN0IGdw
aW8gJWRcbiIsCj4gPiArCQkJCSAgICAgIHBsYXRmb3JtLT5wZGF0YS5ncGlvX3Bfb24pOwo+ID4g
KwkJCWdvdG8gZXJyMDsKPiAKPiBDaG9vc2UgZXJyb3IgbGFiZWxzIHRoYXQgc2F5IHdoYXQgdGhl
IGVycm9yIGhhbmRsaW5nIGRvZXMuICBJbWFnaW5lIGlmCj4gd2UgZGlkbid0IGhhdmUgbmFtZXMs
IHdlIGp1c3QgYW5kICJpbnQgdmFyMSwgdmFyMiwgdmFyMzsgIGZ1bmMxKHZhcjIpOyIuCj4gSXQn
cyB0aGUgc2FtZSB0aGluZyBmb3IgZXJyb3IgbGFiZWxzLCB0aGUgbmFtZSBzaG91bGQgYmUgdXNl
ZnVsLgo+IAo+IEluIHRoaXMgY2FzZSB0aGUgZXJyb3IgaGFuZGxpbmcgaXMgd3JvbmcgYmVjYXVz
ZSB0aGUgZ3Bpb19yZXF1ZXN0KCkKPiBmYWlsZWQgc28gdGhlcmUgaXMgbm8gY2xlYW51cCByZXF1
aXJlZC4gIFdlIHNob3VsZCBhbHdheXMganVzdCBjbGVhbgo+IHVwIHRoZSBtb3N0IHJlY2VudCBh
bGxvY2F0aW9uLiAgSW4gdGhpcyBjYXNlIHNpbmNlIHdlIGhhdmVuJ3QgYWxsb2NhdGVkCj4gYW55
dGhpbmcgd2UgY2FuIGp1c3QgcmV0dXJuOwo+IAo+IAkJaWYgKHJldCkgewo+IAkJCURSTV9ERVZf
RVJST1IoZGV2LCAiZmFpbGVkIHRvIHJlcXVlc3QgZ3BpbyAlZFxuIiwKPiAJCQkJICAgICAgcGxh
dGZvcm0tPnBkYXRhLmdwaW9fcF9vbik7Cj4gCQkJcmV0dXJuIHJldDsKPiAJCX0KPiAKPiAKPiA+
ICsJCX0KPiA+ICsJCS8qIGdwaW8gZm9yIGNoaXAgcmVzZXQgKi8KPiA+ICsJCXJldCA9IGdwaW9f
cmVxdWVzdChwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19yZXNldCwKPiA+ICsJCQkJICAgImFueDc2MjVf
cmVzZXRfbiIpOwo+ID4gKwkJaWYgKHJldCkgewo+ID4gKwkJCURSTV9ERVZfRVJST1IoZGV2LCAi
ZmFpbGVkIHRvIHJlcXVlc3QgZ3BpbyAlZFxuIiwKPiA+ICsJCQkJICAgICAgcGxhdGZvcm0tPnBk
YXRhLmdwaW9fcmVzZXQpOwo+ID4gKwkJCWdvdG8gZXJyMTsKPiAKPiBUaGUgbW9zdCByZWNlbnQg
YWxsb2NhdGlvbiBpcyBzbyBncGlvX3Bfb24gImdvdG8gZnJlZV9ncGlvX3Bfb247Ii4KPiAKPiA+
ICsJCX0KPiA+ICsJfQo+ID4gKwo+ID4gKwlpZiAocGxhdGZvcm0tPnBkYXRhLmdwaW9faW50cl9o
cGQpIHsKPiA+ICsJCS8qIGdwaW8gZm9yIGNoaXAgaW50ZXJmYWNlIGNvbW11bmFjdGlvbiAqLwo+
ID4gKwkJcmV0ID0gZ3Bpb19yZXF1ZXN0KHBsYXRmb3JtLT5wZGF0YS5ncGlvX2ludHJfaHBkLAo+
ID4gKwkJCQkgICAiYW54NzYyNV9ocGQiKTsKPiA+ICsJCWlmIChyZXQpIHsKPiA+ICsJCQlEUk1f
REVWX0VSUk9SKGRldiwgImZhaWxlZCB0byByZXF1ZXN0IGdwaW8gJWRcbiIsCj4gPiArCQkJCSAg
ICAgIHBsYXRmb3JtLT5wZGF0YS5ncGlvX2ludHJfaHBkKTsKPiA+ICsJCQlnb3RvIGVycjI7Cj4g
Cj4gZ290byBmcmVlX2dwaW9fcmVzZXQ7Cj4gCj4gPiArCQl9Cj4gPiArCX0KPiA+ICsKPiA+ICsJ
Z290byBvdXQ7Cj4gCj4gSnVzdCAicmV0dXJuIDA7IiAgInJldHVybiAwOyIgaXMgaW1tZWRpYXRl
bHkgcmVhZGFibGUuICBUaGUgbGl0dGxlIGdvdG8KPiBob3BzIGFyb3VuZCBhcmUgbGlrZSBjaGFz
aW5nIGEgcmFiYml0LiAgRnVuIGZvciBhIGxpdHRsZSB3aGlsZSBidXQKPiB0aXJpbmcgaW4gdGhl
IGVuZC4KPiAKPiBmcmVlX2dwaW9fcmVzZXQ6Cj4gCWlmIChwbGF0Zm9ybS0+cGRhdGEubG93X3Bv
d2VyX21vZGUpCj4gCQlncGlvX2ZyZWUocGxhdGZvcm0tPnBkYXRhLmdwaW9fcmVzZXQpOwo+IGZy
ZWVfZ3Bpb19wX29uOgo+IAlpZiAocGxhdGZvcm0tPnBkYXRhLmxvd19wb3dlcl9tb2RlKQo+IAkJ
Z3Bpb19mcmVlKHBsYXRmb3JtLT5wZGF0YS5ncGlvX3Bfb24pOwo+IAo+IAlyZXR1cm4gcmV0Owo+
IAo+IAo+ID4gKwo+ID4gK2VycjI6Cj4gPiArCWlmIChwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19pbnRy
X2hwZCkKPiA+ICsJCWdwaW9fZnJlZShwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19pbnRyX2hwZCk7Cj4g
PiArZXJyMToKPiA+ICsJaWYgKHBsYXRmb3JtLT5wZGF0YS5sb3dfcG93ZXJfbW9kZSkKPiA+ICsJ
CWdwaW9fZnJlZShwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19yZXNldCk7Cj4gPiArZXJyMDoKPiA+ICsJ
aWYgKHBsYXRmb3JtLT5wZGF0YS5sb3dfcG93ZXJfbW9kZSkKPiA+ICsJCWdwaW9fZnJlZShwbGF0
Zm9ybS0+cGRhdGEuZ3Bpb19wX29uKTsKPiA+ICsKPiA+ICsJcmV0dXJuIDE7Cj4gCj4gcmV0dXJu
aW5nIDEgaGVyZSBpcyBhIGJ1ZyBiZWNhdXNlIGl0IGdldCBwcm9wb2dhdGVkIG91dHNpZGUgdGhl
IGRyaXZlci4KPiAKPiA+ICtvdXQ6Cj4gPiArCj4gPiArCXJldHVybiAwOwo+ID4gK30KPiA+ICsK
PiA+ICtzdGF0aWMgdm9pZCBhbng3NjI1X3N0b3BfZHBfd29yayhzdHJ1Y3QgYW54NzYyNV9kYXRh
ICpjdHgpCj4gPiArewo+ID4gKwljdHgtPmhwZF9zdGF0dXMgPSAwOwo+ID4gKwljdHgtPmhwZF9o
aWdoX2NudCA9IDA7Cj4gPiArCWN0eC0+ZGlzcGxheV90aW1pbmdfdmFsaWQgPSAwOwo+ID4gKwo+
ID4gKwlrZnJlZShjdHgtPnNsaW1wb3J0X2VkaWRfcCk7Cj4gPiArCWN0eC0+c2xpbXBvcnRfZWRp
ZF9wID0gTlVMTDsKPiA+ICsKPiA+ICsJaWYgKGN0eC0+cGRhdGEubG93X3Bvd2VyX21vZGUgPT0g
MCkKPiA+ICsJCWFueDc2MjVfZGlzYWJsZV9wZF9wcm90b2NvbChjdHgpOwo+ID4gK30KPiA+ICsK
PiA+ICtzdGF0aWMgdm9pZCBhbng3NjI1X3N0YXJ0X2RwX3dvcmsoc3RydWN0IGFueDc2MjVfZGF0
YSAqY3R4KQo+ID4gK3sKPiA+ICsJaW50IHJldDsKPiA+ICsJdTggYnVmW01BWF9EUENEX0JVRkZF
Ul9TSVpFXTsKPiA+ICsJdTggaGRjcF9jYXA7Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZj
dHgtPmNsaWVudC0+ZGV2Owo+ID4gKwo+ID4gKwl1OCBzcF90eF9idzsgLyogbGlua3RyYWluaW5n
IGJhbndpZHRoICovCj4gPiArCXU4IHNwX3R4X2xhbmVfY291bnQ7IC8qIGxpbmsgdHJhaW5pbmcg
bGFuZSBjb3VudCAqLwo+ID4gKwo+ID4gKwlpZiAoY3R4LT5ocGRfaGlnaF9jbnQgPj0gMikgewo+
ID4gKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiYW54NzYyNSBmaWx0ZXIgdXNlbGVzcyBI
UERcbiIpOwo+ID4gKwkJcmV0dXJuOwo+ID4gKwl9Cj4gPiArCj4gPiArCWN0eC0+aHBkX2hpZ2hf
Y250Kys7Cj4gPiArCj4gPiArCXNwX3R4X2dldF9yeF9idyhjdHgsICZzcF90eF9idyk7Cj4gPiAr
Cj4gPiArCXNwX3R4X2F1eF9kcGNkcmVhZF9ieXRlcyhjdHgsIDB4MDAsIDB4MDAsIERQQ0RfTUFY
X0xBTkVfQ09VTlQsCj4gPiArCQkJCSAxLCAmc3BfdHhfbGFuZV9jb3VudCk7Cj4gPiArCj4gPiAr
CXNwX3R4X2xhbmVfY291bnQgPSBzcF90eF9sYW5lX2NvdW50ICYgMHgxZjsKPiA+ICsJc3BfdHhf
YXV4X2RwY2RyZWFkX2J5dGVzKGN0eCwgMHgwNiwgMHg4MCwgMHgyOCwgMSwgYnVmKTsvKiByZWFk
IEJjYXAgKi8KPiA+ICsKPiA+ICsJaGRjcF9jYXAgPSBidWZbMF0gJiAweDAxOwo+ID4gKwo+ID4g
KwkvKiBub3Qgc3VwcG9ydCBIRENQICovCj4gPiArCXJldCA9IGFueDc2MjVfd3JpdGVfYW5kKGN0
eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCAweGVlLCAweDlmKTsKPiA+ICsKPiA+ICsJaWYgKGhk
Y3BfY2FwID09IDB4MDEpCj4gPiArCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJIRENQMS40
XG4iKTsKPiA+ICsKPiA+ICsJLyogdHJ5IGF1dGggZmxhZyAqLwo+ID4gKwlyZXQgfD0gYW54NzYy
NV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgMHhlYywgMHgxMCk7Cj4gPiAr
CS8qIGludGVycnVwdCBmb3IgRFJNICovCj4gPiArCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0
eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCAweGZmLCAweDAxKTsKPiA+ICsJaWYgKHJldCA8IDAp
Cj4gPiArCQlyZXR1cm47Cj4gPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIk1BWCBCVz0l
MDJ4LCBNQVggTGFuZSBjbnQ9JTAyeCwgSERDUD0lMDJ4XG4iLAo+ID4gKwkJCSAgICAgKHUzMilz
cF90eF9idywKPiA+ICsJCQkgICAgICh1MzIpc3BfdHhfbGFuZV9jb3VudCwKPiA+ICsJCQkgICAg
ICh1MzIpaGRjcF9jYXApOwo+ID4gKwo+ID4gKwlyZXQgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwg
Y3R4LT5pMmMucnhfcDFfY2xpZW50LCAweDg2KTsKPiA+ICsJaWYgKHJldCA8IDApCj4gPiArCQly
ZXR1cm47Cj4gPiArCj4gPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIlNlY3VyZSBPQ00g
dmVyc2lvbj0lMDJ4XG4iLCByZXQpOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCBkcF9o
cGRfY2hhbmdlX2hhbmRsZXIoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LCBib29sIG9uKQo+ID4g
K3sKPiA+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7Cj4gPiArCj4g
PiArCS8qIGhwZCBjaGFuZ2VkICovCj4gPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRw
X2hwZF9jaGFuZ2VfZGVmYXVsdF9mdW5jOiAlZFxuIiwKPiA+ICsJCQkgICAgICh1MzIpb24pOwo+
ID4gKwo+ID4gKwlpZiAob24gPT0gMCkgewo+ID4gKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2
LCAiIEhQRCBsb3dcbiIpOwo+ID4gKwkJYW54NzYyNV9zdG9wX2RwX3dvcmsoY3R4KTsKPiA+ICsJ
fSBlbHNlIHsKPiA+ICsJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIiBIUEQgaGlnaFxuIik7
Cj4gPiArCQlhbng3NjI1X3N0YXJ0X2RwX3dvcmsoY3R4KTsKPiA+ICsJfQo+ID4gKwo+ID4gKwlj
dHgtPmhwZF9zdGF0dXMgPSBvbjsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBhbng3NjI1
X2hwZF9jaGFuZ2VfZGV0ZWN0KHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKPiA+ICt7Cj4gPiAr
CWludCBpbnRyX3ZlY3Rvciwgc3RhdHVzOwo+ID4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4
LT5jbGllbnQtPmRldjsKPiA+ICsKPiA+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAicG93
ZXJfc3RhdHVzPSVkXG4iLAo+ID4gKwkJCSAgICAgKHUzMilhdG9taWNfcmVhZCgmY3R4LT5wb3dl
cl9zdGF0dXMpKTsKPiA+ICsKPiA+ICsJc3RhdHVzID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBj
dHgtPmkyYy50Y3BjX2NsaWVudCwKPiA+ICsJCQkJICAgSU5UUl9BTEVSVF8xLCAweEZGKTsKPiA+
ICsJaWYgKHN0YXR1cyA8IDApIHsKPiA+ICsJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBjbGVhciBh
bGVydCByZWdpc3Rlci5cbiIpOwo+ID4gKwkJcmV0dXJuIHN0YXR1czsKPiA+ICsJfQo+ID4gKwo+
ID4gKwlpbnRyX3ZlY3RvciA9IGFueDc2MjVfcmVnX3JlYWQoY3R4LCBjdHgtPmkyYy5yeF9wMF9j
bGllbnQsCj4gPiArCQkJCSAgICAgICBJTlRFUkZBQ0VfQ0hBTkdFX0lOVCk7Cj4gPiArCWlmIChp
bnRyX3ZlY3RvciA8IDApIHsKPiA+ICsJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBhY2Nlc3MgaW50
ZXJydXB0IGNoYW5nZSByZWdpc3Rlci5cbiIpOwo+ID4gKwkJcmV0dXJuIGludHJfdmVjdG9yOwo+
ID4gKwl9Cj4gPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIjB4N2U6MHg0ND0leFxuIiwg
aW50cl92ZWN0b3IpOwo+ID4gKwlzdGF0dXMgPSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+
aTJjLnJ4X3AwX2NsaWVudCwKPiA+ICsJCQkJICAgSU5URVJGQUNFX0NIQU5HRV9JTlQsCj4gPiAr
CQkJCSAgIGludHJfdmVjdG9yICYgKH5pbnRyX3ZlY3RvcikpOwo+ID4gKwlpZiAoc3RhdHVzIDwg
MCkgewo+ID4gKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGNsZWFyIGludGVycnVwdCBjaGFuZ2Ug
cmVnaXN0ZXIuXG4iKTsKPiA+ICsJCXJldHVybiBzdGF0dXM7Cj4gPiArCX0KPiA+ICsKPiA+ICsJ
aWYgKGludHJfdmVjdG9yICYgSFBEX1NUQVRVU19DSEFOR0UpIHsKPiA+ICsJCXN0YXR1cyA9IGFu
eDc2MjVfcmVnX3JlYWQoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4gPiArCQkJCQkgIFNZ
U1RFTV9TVFNUVVMpOwo+ID4gKwkJaWYgKHN0YXR1cyA8IDApIHsKPiA+ICsJCQlEUk1fRVJST1Io
IklPIGVycm9yIDogY2xlYXIgaW50ZXJydXB0IHN0YXR1cy5cbiIpOwo+ID4gKwkJCXJldHVybiBz
dGF0dXM7Cj4gPiArCQl9Cj4gPiArCj4gPiArCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICIw
eDdlOjB4NDU9JXhcbiIsIHN0YXR1cyk7Cj4gPiArCQlkcF9ocGRfY2hhbmdlX2hhbmRsZXIoY3R4
LCBzdGF0dXMgJiBIUERfU1RBVFVTKTsKPiA+ICsJCXJldHVybiAxOwo+ID4gKwl9Cj4gPiArCj4g
PiArCXJldHVybiAwOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCBhbng3NjI1X3dvcmtf
ZnVuYyhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gPiArewo+ID4gKwlpbnQgZXZlbnQ7Cj4g
PiArCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCA9IGNvbnRhaW5lcl9vZih3b3JrLAo+ID4gKwkJ
CQkJCXN0cnVjdCBhbng3NjI1X2RhdGEsIHdvcmspOwo+ID4gKwo+ID4gKwltdXRleF9sb2NrKCZj
dHgtPmxvY2spOwo+ID4gKwlldmVudCA9IGFueDc2MjVfaHBkX2NoYW5nZV9kZXRlY3QoY3R4KTsK
PiA+ICsJbXV0ZXhfdW5sb2NrKCZjdHgtPmxvY2spOwo+ID4gKwo+ID4gKwlpZiAoZXZlbnQgPCAw
KQo+ID4gKwkJcmV0dXJuOwo+ID4gKwo+ID4gKwlpZiAoZXZlbnQgJiYgY3R4LT5icmlkZ2VfYXR0
YWNoZWQpCj4gPiArCQlkcm1faGVscGVyX2hwZF9pcnFfZXZlbnQoY3R4LT5jb25uZWN0b3IuZGV2
KTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGlycXJldHVybl90IGFueDc2MjVfaW50cl9ocGRf
aXNyKGludCBpcnEsIHZvaWQgKmRhdGEpCj4gPiArewo+ID4gKwlzdHJ1Y3QgYW54NzYyNV9kYXRh
ICpjdHggPSAoc3RydWN0IGFueDc2MjVfZGF0YSAqKWRhdGE7Cj4gPiArCj4gPiArCWlmIChhdG9t
aWNfcmVhZCgmY3R4LT5wb3dlcl9zdGF0dXMpICE9IDEpCj4gPiArCQlyZXR1cm4gSVJRX05PTkU7
Cj4gPiArCj4gPiArCXF1ZXVlX3dvcmsoY3R4LT53b3JrcXVldWUsICZjdHgtPndvcmspOwo+ID4g
Kwo+ID4gKwlyZXR1cm4gSVJRX0hBTkRMRUQ7Cj4gPiArfQo+ID4gKwo+ID4gKyNpZmRlZiBDT05G
SUdfT0YKPiA+ICtzdGF0aWMgaW50IGFueDc2MjVfcGFyc2VfZHQoc3RydWN0IGRldmljZSAqZGV2
LAo+ID4gKwkJCSAgICBzdHJ1Y3QgYW54NzYyNV9wbGF0Zm9ybV9kYXRhICpwZGF0YSkKPiA+ICt7
Cj4gPiArCWludCByZXQ7Cj4gPiArCXN0cnVjdCBkZXZpY2Vfbm9kZSAqbnAgPSBkZXYtPm9mX25v
ZGU7Cj4gPiArCj4gPiArCXJldCA9IG9mX3Byb3BlcnR5X3JlYWRfdTMyKGRldi0+b2Zfbm9kZSwg
Imxvdy1wb3dlci1tb2RlIiwKPiA+ICsJCQkJICAgJnBkYXRhLT5sb3dfcG93ZXJfbW9kZSk7Cj4g
PiArCWlmIChyZXQpCj4gPiArCQlwZGF0YS0+bG93X3Bvd2VyX21vZGUgPSAxOyAvKiBkZWZhdWx0
IGxvdyBwb3dlciBtb2RlICovCj4gPiArCj4gPiArCXJldCA9IG9mX3Byb3BlcnR5X3JlYWRfdTMy
KGRldi0+b2Zfbm9kZSwgImRzaS1zdXBwb3J0ZWQiLAo+ID4gKwkJCQkgICAmcGRhdGEtPmRzaV9z
dXBwb3J0ZWQpOwo+ID4gKwlpZiAocmV0KQo+ID4gKwkJcGRhdGEtPmRzaV9zdXBwb3J0ZWQgPSAx
OyAvKiBkZWZhdWx0IGRzaSBtb2RlICovCj4gPiArCj4gPiArCXJldCA9IG9mX3Byb3BlcnR5X3Jl
YWRfdTMyKGRldi0+b2Zfbm9kZSwgImV4dGNvbi1zdXBwb3J0ZWQiLAo+ID4gKwkJCQkgICAmcGRh
dGEtPmV4dGNvbl9zdXBwb3J0ZWQpOwo+ID4gKwlpZiAocmV0KQo+ID4gKwkJcGRhdGEtPmV4dGNv
bl9zdXBwb3J0ZWQgPSAwOwo+ID4gKwo+ID4gKwlyZXQgPSBvZl9wcm9wZXJ0eV9yZWFkX3UzMihk
ZXYtPm9mX25vZGUsICJpbnRlcm5hbC1wYW5uZWwtc3VwcG9ydGVkIiwKPiA+ICsJCQkJICAgJnBk
YXRhLT5pbnRlcm5hbF9wYW5uZWwpOwo+ID4gKwlpZiAocmV0KQo+ID4gKwkJcGRhdGEtPmludGVy
bmFsX3Bhbm5lbCA9IDA7Cj4gPiArCj4gPiArCW9mX3Byb3BlcnR5X3JlYWRfdTMyKGRldi0+b2Zf
bm9kZSwgImRzaS1jaGFubmVsLWlkIiwKPiA+ICsJCQkgICAgICZwZGF0YS0+ZHNpX2NoYW5uZWwp
Owo+ID4gKwo+ID4gKwlvZl9wcm9wZXJ0eV9yZWFkX3UzMihkZXYtPm9mX25vZGUsICJkc2ktbGFu
ZXMtbnVtIiwgJnBkYXRhLT5kc2lfbGFuZXMpOwo+ID4gKwo+ID4gKwlwZGF0YS0+aG9zdF9ub2Rl
ID0gb2ZfZ3JhcGhfZ2V0X3JlbW90ZV9ub2RlKG5wLCAwLCAwKTsKPiA+ICsJaWYgKHBkYXRhLT5o
b3N0X25vZGUpCj4gPiArCQlvZl9ub2RlX3B1dChwZGF0YS0+aG9zdF9ub2RlKTsKPiA+ICsKPiA+
ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAibG93X3Bvd2VyX21vZGUgOiAlZCwgZHNpX3N1
cHBvcnRlZCA6ICVkXG4iLAo+ID4gKwkJCSAgICAgcGRhdGEtPmxvd19wb3dlcl9tb2RlLCBwZGF0
YS0+ZHNpX3N1cHBvcnRlZCk7Cj4gPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRzaV9j
aGFubmVsIDogJWQsIGRzaV9sYW5lcyA6ICVkLCAlcyBub2RlXG4iLAo+ID4gKwkJCSAgICAgcGRh
dGEtPmRzaV9jaGFubmVsLCBwZGF0YS0+ZHNpX2xhbmVzLAo+ID4gKwkJCSAgICAgKCFwZGF0YS0+
aG9zdF9ub2RlKSA/ICJub3QiIDogImhhcyIpOwo+ID4gKwo+ID4gKwlpZiAocGRhdGEtPmxvd19w
b3dlcl9tb2RlKSB7Cj4gPiArCQlwZGF0YS0+Z3Bpb19wX29uID0KPiA+ICsJCQlvZl9nZXRfbmFt
ZWRfZ3Bpb19mbGFncyhucCwgInBvbi1ncGlvcyIsCj4gPiArCQkJCQkJMCwgTlVMTCk7Cj4gPiAr
Cj4gPiArCQlwZGF0YS0+Z3Bpb19yZXNldCA9Cj4gPiArCQkJb2ZfZ2V0X25hbWVkX2dwaW9fZmxh
Z3MobnAsICJyZXNldC1ncGlvcyIsCj4gPiArCQkJCQkJMCwgTlVMTCk7Cj4gPiArCQlEUk1fREVW
X0RFQlVHX0RSSVZFUihkZXYsICJncGlvIHBfb24gOiAlZCwgcmVzZXQgOiAlZFxuIiwKPiA+ICsJ
CQkJICAgICBwZGF0YS0+Z3Bpb19wX29uLCBwZGF0YS0+Z3Bpb19yZXNldCk7Cj4gPiArCX0KPiA+
ICsKPiA+ICsJcGRhdGEtPmdwaW9faW50cl9ocGQgPQo+ID4gKwkJb2ZfZ2V0X25hbWVkX2dwaW9f
ZmxhZ3MobnAsICJocGQtZ3Bpb3MiLCAwLCBOVUxMKTsKPiA+ICsKPiA+ICsJRFJNX0RFVl9ERUJV
R19EUklWRVIoZGV2LCAiZ3BpbyBocGQgOiAlZFxuIiwgcGRhdGEtPmdwaW9faW50cl9ocGQpOwo+
ID4gKwo+ID4gKwlyZXR1cm4gMDsKPiA+ICt9Cj4gPiArI2Vsc2UKPiA+ICtzdGF0aWMgaW50IGFu
eDc2MjVfcGFyc2VfZHQoc3RydWN0IGRldmljZSAqZGV2LAo+ID4gKwkJCSAgICBzdHJ1Y3QgYW54
NzYyNV9wbGF0Zm9ybV9kYXRhICpwZGF0YSkKPiA+ICt7Cj4gPiArCXJldHVybiAtRU5PREVWOwo+
ID4gK30KPiA+ICsjZW5kaWYKPiA+ICsKPiA+ICtzdGF0aWMgaW5saW5lIHN0cnVjdCBhbng3NjI1
X2RhdGEgKmNvbm5lY3Rvcl90b19hbng3NjI1KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjKQo+ID4g
K3sKPiA+ICsJcmV0dXJuIGNvbnRhaW5lcl9vZihjLCBzdHJ1Y3QgYW54NzYyNV9kYXRhLCBjb25u
ZWN0b3IpOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW5saW5lIHN0cnVjdCBhbng3NjI1X2Rh
dGEgKmJyaWRnZV90b19hbng3NjI1KHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UpCj4gPiArewo+
ID4gKwlyZXR1cm4gY29udGFpbmVyX29mKGJyaWRnZSwgc3RydWN0IGFueDc2MjVfZGF0YSwgYnJp
ZGdlKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBhbng3NjI1X3JlYWRfaHBkX3N0YXR1
c19wMChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gPiArewo+ID4gKwlyZXR1cm4gYW54NzYy
NV9yZWdfcmVhZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwgU1lTVEVNX1NUU1RVUyk7Cj4g
PiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgYW54NzYyNV9nZXRfbW9kZXMoc3RydWN0IGRybV9j
b25uZWN0b3IgKmNvbm5lY3RvcikKPiA+ICt7Cj4gPiArCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0
eCA9IGNvbm5lY3Rvcl90b19hbng3NjI1KGNvbm5lY3Rvcik7Cj4gPiArCWludCBlcnIsIG51bV9t
b2RlcyA9IDA7Cj4gPiArCWludCB2YWwsIHJldDsKPiA+ICsJc3RydWN0IHNfZWRpZF9kYXRhICpw
X2VkaWQgPSAoc3RydWN0IHNfZWRpZF9kYXRhICopY3R4LT5zbGltcG9ydF9lZGlkX3A7Cj4gPiAr
CXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ID4gKwo+ID4gKwlEUk1f
REVWX0RFQlVHX0RSSVZFUihkZXYsICJkcm0gZ2V0IG1vZGVzXG4iKTsKPiA+ICsKPiA+ICsJaWYg
KGN0eC0+cGRhdGEuaW50ZXJuYWxfcGFubmVsICYmCj4gPiArCSAgICBjdHgtPnBkYXRhLmxvd19w
b3dlcl9tb2RlICYmCj4gPiArCSAgICAoIWF0b21pY19yZWFkKCZjdHgtPnBvd2VyX3N0YXR1cykp
KSB7Cj4gPiArCQlhbng3NjI1X3Bvd2VyX29uX2luaXQoY3R4KTsKPiA+ICsJCWF0b21pY19zZXQo
JmN0eC0+cG93ZXJfc3RhdHVzLCAxKTsKPiA+ICsKPiA+ICsJCXJldCA9IHJlYWR4X3BvbGxfdGlt
ZW91dChhbng3NjI1X3JlYWRfaHBkX3N0YXR1c19wMCwKPiA+ICsJCQkJCSBjdHgsIHZhbCwKPiA+
ICsJCQkJCSAoKHZhbCAmIEhQRF9TVEFUVVMpIHx8ICh2YWwgPCAwKSksCj4gPiArCQkJCQkgNTAw
MCwKPiA+ICsJCQkJCSA1MDAwICogMTAwKTsKPiA+ICsJCWlmIChyZXQpIHsKPiA+ICsJCQlEUk1f
REVWX0VSUk9SKGRldiwgIkhQRCBzdGF0dXMgcG9sbGluZyB0aW1lb3V0IVxuIik7Cj4gPiArCQl9
IGVsc2Ugewo+ID4gKwkJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIkhQRCByYWlzZSB1cC5c
biIpOwo+ID4gKwkJCWFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMudGNwY19jbGllbnQs
Cj4gPiArCQkJCQkgIElOVFJfQUxFUlRfMSwgMHhGRik7Cj4gPiArCQkJYW54NzYyNV9yZWdfd3Jp
dGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4gPiArCQkJCQkgIElOVEVSRkFDRV9DSEFO
R0VfSU5ULCAwKTsKPiA+ICsJCX0KPiA+ICsKPiA+ICsJCWFueDc2MjVfc3RhcnRfZHBfd29yayhj
dHgpOwo+ID4gKwl9Cj4gPiArCj4gPiArCWlmIChXQVJOX09OKCFhdG9taWNfcmVhZCgmY3R4LT5w
b3dlcl9zdGF0dXMpKSkKPiA+ICsJCXJldHVybiAwOwo+ID4gKwo+ID4gKwlpZiAoY3R4LT5zbGlt
cG9ydF9lZGlkX3AgJiYgY3R4LT5zbGltcG9ydF9lZGlkX3AtPmVkaWRfYmxvY2tfbnVtID49IDAp
Cj4gPiArCQlyZXR1cm4gZHJtX2FkZF9lZGlkX21vZGVzKGNvbm5lY3RvciwKPiA+ICsJCQkJCSAg
KHN0cnVjdCBlZGlkICopCj4gPiArCQkJCQkgICZwX2VkaWQtPmVkaWRfcmF3X2RhdGEpOwo+ID4g
Kwo+ID4gKwltdXRleF9sb2NrKCZjdHgtPmxvY2spOwo+ID4gKwo+ID4gKwlpZiAoIWN0eC0+c2xp
bXBvcnRfZWRpZF9wKQo+ID4gKwkJY3R4LT5zbGltcG9ydF9lZGlkX3AgPSBremFsbG9jKHNpemVv
ZigqY3R4LT5zbGltcG9ydF9lZGlkX3ApLAo+ID4gKwkJCQkJICAgICAgIEdGUF9LRVJORUwpOwo+
IAo+IEFkZCBhIGNoZWNrIGZvciBOVUxMLgo+IAo+ID4gKwlwX2VkaWQgPSBjdHgtPnNsaW1wb3J0
X2VkaWRfcDsKPiA+ICsJcF9lZGlkLT5lZGlkX2Jsb2NrX251bSA9IHNwX3R4X2VkaWRfcmVhZChj
dHgsIHBfZWRpZC0+ZWRpZF9yYXdfZGF0YSk7Cj4gPiArCWlmIChwX2VkaWQtPmVkaWRfYmxvY2tf
bnVtIDwgMCkgewo+ID4gKwkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gcmVhZCBFRElELlxuIik7Cj4g
PiArCQlnb3RvIHVubG9jazsKPiA+ICsJfQo+ID4gKwo+ID4gKwllcnIgPSBkcm1fY29ubmVjdG9y
X3VwZGF0ZV9lZGlkX3Byb3BlcnR5KGNvbm5lY3RvciwKPiA+ICsJCQkJCQkgKHN0cnVjdCBlZGlk
ICopCj4gPiArCQkJCQkJICZwX2VkaWQtPmVkaWRfcmF3X2RhdGEpOwo+ID4gKwo+ID4gKwlpZiAo
ZXJyKSB7Cj4gPiArCQlEUk1fRVJST1IoIkZhaWxlZCB0byB1cGRhdGUgRURJRCBwcm9wZXJ0eTog
JWRcbiIsIGVycik7Cj4gPiArCQlnb3RvIHVubG9jazsKPiA+ICsJfQo+ID4gKwo+ID4gKwludW1f
bW9kZXMgPSBkcm1fYWRkX2VkaWRfbW9kZXMoY29ubmVjdG9yLAo+ID4gKwkJCQkgICAgICAgKHN0
cnVjdCBlZGlkICopJnBfZWRpZC0+ZWRpZF9yYXdfZGF0YSk7Cj4gPiArCj4gPiArdW5sb2NrOgo+
ID4gKwltdXRleF91bmxvY2soJmN0eC0+bG9jayk7Cj4gPiArCj4gPiArCXJldHVybiBudW1fbW9k
ZXM7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBlbnVtIGRybV9tb2RlX3N0YXR1cwo+ID4gK2Fu
eDc2MjVfY29ubmVjdG9yX21vZGVfdmFsaWQoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3Rv
ciwKPiA+ICsJCQkgICAgIHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlKQo+ID4gK3sKPiA+
ICsJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0gY29ubmVjdG9yX3RvX2FueDc2MjUoY29ubmVj
dG9yKTsKPiA+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7Cj4gPiAr
Cj4gPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRybSBtb2RlcyB2YWxpZCB2ZXJpZnlc
biIpOwo+ID4gKwo+ID4gKwlpZiAobW9kZS0+Y2xvY2sgPiAzMDAwMDApCj4gPiArCQlyZXR1cm4g
TU9ERV9DTE9DS19ISUdIOwo+ID4gKwo+ID4gKwlyZXR1cm4gTU9ERV9PSzsKPiA+ICt9Cj4gPiAr
Cj4gPiArc3RhdGljIHN0cnVjdCBkcm1fY29ubmVjdG9yX2hlbHBlcl9mdW5jcyBhbng3NjI1X2Nv
bm5lY3Rvcl9oZWxwZXJfZnVuY3MgPSB7Cj4gPiArCS5nZXRfbW9kZXMgPSBhbng3NjI1X2dldF9t
b2RlcywKPiA+ICsJLm1vZGVfdmFsaWQgPSBhbng3NjI1X2Nvbm5lY3Rvcl9tb2RlX3ZhbGlkLAo+
ID4gK307Cj4gPiArCj4gPiArc3RhdGljIGVudW0gZHJtX2Nvbm5lY3Rvcl9zdGF0dXMgYW54NzYy
NV9kZXRlY3Qoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKPiA+ICsJCQkJCQlib29s
IGZvcmNlKQo+ID4gK3sKPiA+ICsJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0gY29ubmVjdG9y
X3RvX2FueDc2MjUoY29ubmVjdG9yKTsKPiA+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+
Y2xpZW50LT5kZXY7Cj4gPiArCj4gPiArCWlmICghKGN0eC0+aHBkX3N0YXR1cykpCj4gCj4gUmVt
b3ZlIGV4dHJhIHBhcmVucy4KPiAKPiA+ICsJCXJldHVybiBjb25uZWN0b3Jfc3RhdHVzX2Rpc2Nv
bm5lY3RlZDsKPiA+ICsKPiA+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZHJtIGRldGVj
dFxuIik7Cj4gPiArCj4gPiArCXJldHVybiBjb25uZWN0b3Jfc3RhdHVzX2Nvbm5lY3RlZDsKPiA+
ICt9Cj4gPiArCj4gPiArc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX2Z1bmNzIGFu
eDc2MjVfY29ubmVjdG9yX2Z1bmNzID0gewo+ID4gKwkuZmlsbF9tb2RlcyA9IGRybV9oZWxwZXJf
cHJvYmVfc2luZ2xlX2Nvbm5lY3Rvcl9tb2RlcywKPiA+ICsJLmRldGVjdCA9IGFueDc2MjVfZGV0
ZWN0LAo+ID4gKwkuZGVzdHJveSA9IGRybV9jb25uZWN0b3JfY2xlYW51cCwKPiA+ICsJLnJlc2V0
ID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX3Jlc2V0LAo+ID4gKwkuYXRvbWljX2R1cGxp
Y2F0ZV9zdGF0ZSA9IGRybV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9kdXBsaWNhdGVfc3RhdGUs
Cj4gPiArCS5hdG9taWNfZGVzdHJveV9zdGF0ZSA9IGRybV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rv
cl9kZXN0cm95X3N0YXRlLAo+ID4gK307Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgYW54NzYyNV9h
dHRhY2hfZHNpKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKPiA+ICt7Cj4gPiArCXN0cnVjdCBt
aXBpX2RzaV9ob3N0ICpob3N0Owo+ID4gKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2k7Cj4g
PiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ID4gKwljb25zdCBz
dHJ1Y3QgbWlwaV9kc2lfZGV2aWNlX2luZm8gaW5mbyA9IHsKPiA+ICsJCS50eXBlID0gImFueDc2
MjUiLAo+ID4gKwkJLmNoYW5uZWwgPSBjdHgtPnBkYXRhLmRzaV9jaGFubmVsLAo+ID4gKwkJLm5v
ZGUgPSBOVUxMLAo+ID4gKwl9Owo+ID4gKwo+ID4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYs
ICJhdHRhY2ggZHNpXG4iKTsKPiA+ICsKPiA+ICsJaG9zdCA9IG9mX2ZpbmRfbWlwaV9kc2lfaG9z
dF9ieV9ub2RlKGN0eC0+cGRhdGEuaG9zdF9ub2RlKTsKPiA+ICsJaWYgKCFob3N0KSB7Cj4gPiAr
CQlEUk1fRVJST1IoImZhaWxlZCB0byBmaW5kIGRzaSBob3N0LlxuIik7Cj4gPiArCQlyZXR1cm47
Cj4gCj4gSSBmZWVsIGxpa2UgdGhpcyBzaG91bGQgcmVhbGx5IHJldHVybiBuZWdhdGl2ZSBlcnJv
ciBjb2Rlcy4KPiAKPiA+ICsJfQo+ID4gKwo+ID4gKwlkc2kgPSBtaXBpX2RzaV9kZXZpY2VfcmVn
aXN0ZXJfZnVsbChob3N0LCAmaW5mbyk7Cj4gPiArCWlmIChJU19FUlIoZHNpKSkgewo+ID4gKwkJ
RFJNX0VSUk9SKCJmYWlsZWQgdG8gY3JlYXRlIGRzaSBkZXZpY2UuXG4iKTsKPiA+ICsJCXJldHVy
bjsKPiA+ICsJfQo+ID4gKwo+ID4gKwlkc2ktPmxhbmVzID0gY3R4LT5wZGF0YS5kc2lfbGFuZXM7
Cj4gPiArCWRzaS0+Zm9ybWF0ID0gTUlQSV9EU0lfRk1UX1JHQjg4ODsKPiA+ICsJZHNpLT5tb2Rl
X2ZsYWdzID0gTUlQSV9EU0lfTU9ERV9WSURFTwl8Cj4gPiArCQlNSVBJX0RTSV9NT0RFX1ZJREVP
X1NZTkNfUFVMU0UJfAo+ID4gKwkJTUlQSV9EU0lfTU9ERV9FT1RfUEFDS0VUCXwKPiA+ICsJCU1J
UElfRFNJX01PREVfVklERU9fSFNFOwo+ID4gKwo+ID4gKwlpZiAobWlwaV9kc2lfYXR0YWNoKGRz
aSkgPCAwKSB7Cj4gPiArCQlEUk1fRVJST1IoImZhaWxlZCB0byBhdHRhY2ggZHNpIHRvIGhvc3Qu
XG4iKTsKPiA+ICsJCW1pcGlfZHNpX2RldmljZV91bnJlZ2lzdGVyKGRzaSk7Cj4gPiArCQlyZXR1
cm47Cj4gPiArCX0KPiA+ICsKPiA+ICsJY3R4LT5kc2kgPSBkc2k7Cj4gPiArCj4gPiArCURSTV9E
RVZfREVCVUdfRFJJVkVSKGRldiwgImF0dGFjaCBkc2kgc3VjY2VlZGVkLlxuIik7Cj4gPiArfQo+
ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGFueDc2MjVfZGV0YWNoX2RzaShzdHJ1Y3QgYW54NzYyNV9k
YXRhICpjdHgpCj4gPiArewo+ID4gKwlpZiAoY3R4LT5kc2kpIHsKPiA+ICsJCW1pcGlfZHNpX2Rl
dGFjaChjdHgtPmRzaSk7Cj4gPiArCQltaXBpX2RzaV9kZXZpY2VfdW5yZWdpc3RlcihjdHgtPmRz
aSk7Cj4gPiArCX0KPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBhbng3NjI1X2JyaWRnZV9h
dHRhY2goc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSkKPiA+ICt7Cj4gPiArCXN0cnVjdCBhbng3
NjI1X2RhdGEgKmN0eCA9IGJyaWRnZV90b19hbng3NjI1KGJyaWRnZSk7Cj4gPiArCWludCBlcnI7
Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ID4gKwo+ID4g
KwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJkcm0gYXR0YWNoXG4iKTsKPiA+ICsJaWYgKCFi
cmlkZ2UtPmVuY29kZXIpIHsKPiA+ICsJCURSTV9FUlJPUigiUGFyZW50IGVuY29kZXIgb2JqZWN0
IG5vdCBmb3VuZCIpOwo+ID4gKwkJcmV0dXJuIC1FTk9ERVY7Cj4gPiArCX0KPiA+ICsKPiA+ICsJ
ZXJyID0gZHJtX2Nvbm5lY3Rvcl9pbml0KGJyaWRnZS0+ZGV2LCAmY3R4LT5jb25uZWN0b3IsCj4g
PiArCQkJCSAmYW54NzYyNV9jb25uZWN0b3JfZnVuY3MsCj4gPiArCQkJCSBEUk1fTU9ERV9DT05O
RUNUT1JfRGlzcGxheVBvcnQpOwo+ID4gKwlpZiAoZXJyKSB7Cj4gPiArCQlEUk1fRVJST1IoIkZh
aWxlZCB0byBpbml0aWFsaXplIGNvbm5lY3RvcjogJWRcbiIsIGVycik7Cj4gPiArCQlyZXR1cm4g
ZXJyOwo+ID4gKwl9Cj4gPiArCj4gPiArCWRybV9jb25uZWN0b3JfaGVscGVyX2FkZCgmY3R4LT5j
b25uZWN0b3IsCj4gPiArCQkJCSAmYW54NzYyNV9jb25uZWN0b3JfaGVscGVyX2Z1bmNzKTsKPiA+
ICsKPiA+ICsJZXJyID0gZHJtX2Nvbm5lY3Rvcl9yZWdpc3RlcigmY3R4LT5jb25uZWN0b3IpOwo+
ID4gKwlpZiAoZXJyKSB7Cj4gPiArCQlEUk1fRVJST1IoIkZhaWxlZCB0byByZWdpc3RlciBjb25u
ZWN0b3I6ICVkXG4iLCBlcnIpOwo+ID4gKwkJcmV0dXJuIGVycjsKPiA+ICsJfQo+ID4gKwo+ID4g
KwljdHgtPmNvbm5lY3Rvci5wb2xsZWQgPSBEUk1fQ09OTkVDVE9SX1BPTExfSFBEOwo+ID4gKwo+
ID4gKwllcnIgPSBkcm1fY29ubmVjdG9yX2F0dGFjaF9lbmNvZGVyKCZjdHgtPmNvbm5lY3Rvciwg
YnJpZGdlLT5lbmNvZGVyKTsKPiA+ICsJaWYgKGVycikgewo+ID4gKwkJRFJNX0VSUk9SKCJGYWls
ZWQgdG8gbGluayB1cCBjb25uZWN0b3IgdG8gZW5jb2RlcjogJWRcbiIsIGVycik7Cj4gPiArCQlk
cm1fY29ubmVjdG9yX3VucmVnaXN0ZXIoJmN0eC0+Y29ubmVjdG9yKTsKPiA+ICsJCXJldHVybiBl
cnI7Cj4gPiArCX0KPiA+ICsKPiA+ICsJYW54NzYyNV9hdHRhY2hfZHNpKGN0eCk7Cj4gPiArCj4g
PiArCWN0eC0+YnJpZGdlX2F0dGFjaGVkID0gMTsKPiA+ICsKPiA+ICsJcmV0dXJuIDA7Cj4gPiAr
fQo+ID4gKwo+ID4gK3N0YXRpYyBlbnVtIGRybV9tb2RlX3N0YXR1cwo+ID4gK2FueDc2MjVfYnJp
ZGdlX21vZGVfdmFsaWQoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSwKPiA+ICsJCQkgIGNvbnN0
IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlKQo+ID4gK3sKPiA+ICsJc3RydWN0IGFueDc2
MjVfZGF0YSAqY3R4ID0gYnJpZGdlX3RvX2FueDc2MjUoYnJpZGdlKTsKPiA+ICsJc3RydWN0IGRl
dmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7Cj4gPiArCj4gPiArCURSTV9ERVZfREVCVUdf
RFJJVkVSKGRldiwgImRybSBtb2RlIGNoZWNraW5nXG4iKTsKPiA+ICsKPiA+ICsJLyogTWF4IDEy
MDBwIGF0IDUuNCBHaHosIG9uZSBsYW5lLCBwaXhlbCBjbG9jayAzMDBNICovCj4gPiArCWlmICht
b2RlLT5jbG9jayA+IDMwMDAwMCkgewo+ID4gKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LAo+
ID4gKwkJCQkgICAgICJkcm0gbW9kZSBpbnZhbGlkLCBwaXhlbGNsb2NrIHRvbyBoaWdoLlxuIik7
Cj4gPiArCQlyZXR1cm4gTU9ERV9DTE9DS19ISUdIOwo+ID4gKwl9Cj4gPiArCj4gPiArCURSTV9E
RVZfREVCVUdfRFJJVkVSKGRldiwgImRybSBtb2RlIHZhbGlkLlxuIik7Cj4gPiArCXJldHVybiBN
T0RFX09LOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCBhbng3NjI1X2JyaWRnZV9tb2Rl
X3NldChzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAo+ID4gKwkJCQkgICAgY29uc3Qgc3RydWN0
IGRybV9kaXNwbGF5X21vZGUgKm9sZF9tb2RlLAo+ID4gKwkJCQkgICAgY29uc3Qgc3RydWN0IGRy
bV9kaXNwbGF5X21vZGUgKm1vZGUpCj4gPiArewo+ID4gKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpj
dHggPSBicmlkZ2VfdG9fYW54NzYyNShicmlkZ2UpOwo+ID4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYg
PSAmY3R4LT5jbGllbnQtPmRldjsKPiA+ICsKPiA+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2
LCAiZHJtIG1vZGUgc2V0XG4iKTsKPiAKPiBZb3UgY2FuIGdldCBiZXR0ZXIgaW5mb3JtYXRpb24g
d2l0aCBmdHJhY2UuCj4gCj4gPiArCj4gPiArCWlmIChXQVJOX09OKCFhdG9taWNfcmVhZCgmY3R4
LT5wb3dlcl9zdGF0dXMpKSkKPiA+ICsJCXJldHVybjsKPiA+ICsKPiA+ICsJbXV0ZXhfbG9jaygm
Y3R4LT5sb2NrKTsKPiA+ICsKPiA+ICsJY3R4LT5kdC5waXhlbGNsb2NrLm1pbiA9IG1vZGUtPmNs
b2NrOwo+ID4gKwljdHgtPmR0LmhhY3RpdmUubWluID0gbW9kZS0+aGRpc3BsYXk7Cj4gPiArCWN0
eC0+ZHQuaHN5bmNfbGVuLm1pbiA9IG1vZGUtPmhzeW5jX2VuZCAtIG1vZGUtPmhzeW5jX3N0YXJ0
Owo+ID4gKwljdHgtPmR0Lmhmcm9udF9wb3JjaC5taW4gPSBtb2RlLT5oc3luY19zdGFydCAtIG1v
ZGUtPmhkaXNwbGF5Owo+ID4gKwljdHgtPmR0LmhiYWNrX3BvcmNoLm1pbiA9IG1vZGUtPmh0b3Rh
bCAtIG1vZGUtPmhzeW5jX2VuZDsKPiA+ICsJY3R4LT5kdC52YWN0aXZlLm1pbiA9IG1vZGUtPnZk
aXNwbGF5Owo+ID4gKwljdHgtPmR0LnZzeW5jX2xlbi5taW4gPSBtb2RlLT52c3luY19lbmQgLSBt
b2RlLT52c3luY19zdGFydDsKPiA+ICsJY3R4LT5kdC52ZnJvbnRfcG9yY2gubWluID0gbW9kZS0+
dnN5bmNfc3RhcnQgLSBtb2RlLT52ZGlzcGxheTsKPiA+ICsJY3R4LT5kdC52YmFja19wb3JjaC5t
aW4gPSBtb2RlLT52dG90YWwgLSBtb2RlLT52c3luY19lbmQ7Cj4gPiArCj4gPiArCWN0eC0+ZGlz
cGxheV90aW1pbmdfdmFsaWQgPSAxOwo+ID4gKwo+ID4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihk
ZXYsICJwaXhlbGNsb2NrKCVkKS5cbiIsIGN0eC0+ZHQucGl4ZWxjbG9jay5taW4pOwo+ID4gKwlE
Uk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJoYWN0aXZlKCVkKSwgaHN5bmMoJWQpLCBoZnAoJWQp
LCBoYnAoJWQpXG4iLAo+ID4gKwkJCSAgICAgY3R4LT5kdC5oYWN0aXZlLm1pbiwKPiA+ICsJCQkg
ICAgIGN0eC0+ZHQuaHN5bmNfbGVuLm1pbiwKPiA+ICsJCQkgICAgIGN0eC0+ZHQuaGZyb250X3Bv
cmNoLm1pbiwKPiA+ICsJCQkgICAgIGN0eC0+ZHQuaGJhY2tfcG9yY2gubWluKTsKPiA+ICsJRFJN
X0RFVl9ERUJVR19EUklWRVIoZGV2LCAidmFjdGl2ZSglZCksIHZzeW5jKCVkKSwgdmZwKCVkKSwg
dmJwKCVkKVxuIiwKPiA+ICsJCQkgICAgIGN0eC0+ZHQudmFjdGl2ZS5taW4sCj4gPiArCQkJICAg
ICBjdHgtPmR0LnZzeW5jX2xlbi5taW4sCj4gPiArCQkJICAgICBjdHgtPmR0LnZmcm9udF9wb3Jj
aC5taW4sCj4gPiArCQkJICAgICBjdHgtPmR0LnZiYWNrX3BvcmNoLm1pbik7Cj4gPiArCURSTV9E
RVZfREVCVUdfRFJJVkVSKGRldiwgImhkaXNwbGF5KCVkKSxoc3luY19zdGFydCglZCkuXG4iLAo+
ID4gKwkJCSAgICAgbW9kZS0+aGRpc3BsYXksCj4gPiArCQkJICAgICBtb2RlLT5oc3luY19zdGFy
dCk7Cj4gPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImhzeW5jX2VuZCglZCksaHRvdGFs
KCVkKS5cbiIsCj4gPiArCQkJICAgICBtb2RlLT5oc3luY19lbmQsCj4gPiArCQkJICAgICBtb2Rl
LT5odG90YWwpOwo+ID4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJ2ZGlzcGxheSglZCks
dnN5bmNfc3RhcnQoJWQpLlxuIiwKPiA+ICsJCQkgICAgIG1vZGUtPnZkaXNwbGF5LAo+ID4gKwkJ
CSAgICAgbW9kZS0+dnN5bmNfc3RhcnQpOwo+ID4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYs
ICJ2c3luY19lbmQoJWQpLHZ0b3RhbCglZCkuXG4iLAo+ID4gKwkJCSAgICAgbW9kZS0+dnN5bmNf
ZW5kLAo+ID4gKwkJCSAgICAgbW9kZS0+dnRvdGFsKTsKPiA+ICsKPiA+ICsJbXV0ZXhfdW5sb2Nr
KCZjdHgtPmxvY2spOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCBhbng3NjI1X2JyaWRn
ZV9lbmFibGUoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSkKPiA+ICt7Cj4gPiArCXN0cnVjdCBh
bng3NjI1X2RhdGEgKmN0eCA9IGJyaWRnZV90b19hbng3NjI1KGJyaWRnZSk7Cj4gPiArCXN0cnVj
dCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ID4gKwo+ID4gKwlEUk1fREVWX0RF
QlVHX0RSSVZFUihkZXYsICJkcm0gZW5hYmxlXG4iKTsKPiAKPiBmdHJhY2UuCj4gCj4gPiArCj4g
PiArCWlmIChXQVJOX09OKCFhdG9taWNfcmVhZCgmY3R4LT5wb3dlcl9zdGF0dXMpKSkKPiA+ICsJ
CXJldHVybjsKPiA+ICsKPiA+ICsJbXV0ZXhfbG9jaygmY3R4LT5sb2NrKTsKPiA+ICsKPiA+ICsJ
YW54NzYyNV9kcF9zdGFydChjdHgpOwo+ID4gKwo+ID4gKwltdXRleF91bmxvY2soJmN0eC0+bG9j
ayk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGFueDc2MjVfYnJpZGdlX2Rpc2FibGUo
c3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSkKPiA+ICt7Cj4gPiArCXN0cnVjdCBhbng3NjI1X2Rh
dGEgKmN0eCA9IGJyaWRnZV90b19hbng3NjI1KGJyaWRnZSk7Cj4gPiArCXN0cnVjdCBkZXZpY2Ug
KmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ID4gKwo+ID4gKwlpZiAoV0FSTl9PTighYXRvbWlj
X3JlYWQoJmN0eC0+cG93ZXJfc3RhdHVzKSkpCj4gPiArCQlyZXR1cm47Cj4gPiArCj4gPiArCURS
TV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRybSBkaXNhYmxlXG4iKTsKPiAKPiBmdHJhY2UuCj4g
Cj4gPiArCW11dGV4X2xvY2soJmN0eC0+bG9jayk7Cj4gPiArCj4gPiArCWFueDc2MjVfZHBfc3Rv
cChjdHgpOwo+ID4gKwo+ID4gKwlpZiAoY3R4LT5wZGF0YS5pbnRlcm5hbF9wYW5uZWwgJiYKPiA+
ICsJICAgIGN0eC0+cGRhdGEubG93X3Bvd2VyX21vZGUgJiYKPiA+ICsJICAgIChhdG9taWNfcmVh
ZCgmY3R4LT5wb3dlcl9zdGF0dXMpKSkgewo+ID4gKwkJYW54NzYyNV9zdG9wX2RwX3dvcmsoY3R4
KTsKPiA+ICsJCWFueDc2MjVfcG93ZXJfc3RhbmRieShjdHgpOwo+ID4gKwkJYXRvbWljX3NldCgm
Y3R4LT5wb3dlcl9zdGF0dXMsIDApOwo+ID4gKwl9Cj4gPiArCj4gPiArCW11dGV4X3VubG9jaygm
Y3R4LT5sb2NrKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fYnJp
ZGdlX2Z1bmNzIGFueDc2MjVfYnJpZGdlX2Z1bmNzID0gewo+ID4gKwkuYXR0YWNoID0gYW54NzYy
NV9icmlkZ2VfYXR0YWNoLAo+ID4gKwkuZGlzYWJsZSA9IGFueDc2MjVfYnJpZGdlX2Rpc2FibGUs
Cj4gPiArCS5tb2RlX3ZhbGlkID0gYW54NzYyNV9icmlkZ2VfbW9kZV92YWxpZCwKPiA+ICsJLm1v
ZGVfc2V0ID0gYW54NzYyNV9icmlkZ2VfbW9kZV9zZXQsCj4gPiArCS5lbmFibGUgPSBhbng3NjI1
X2JyaWRnZV9lbmFibGUsCj4gPiArfTsKPiA+ICsKPiA+ICtzdGF0aWMgaW50IGFueDc2MjVfcmVn
aXN0ZXJfaTJjX2R1bW15X2NsaWVudHMoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAo+ID4gKwkJ
CQkJICAgICAgc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCkKPiA+ICt7Cj4gPiArCWN0eC0+aTJj
LnR4X3AwX2NsaWVudCA9IGkyY19uZXdfZHVtbXkoY2xpZW50LT5hZGFwdGVyLAo+ID4gKwkJCQkJ
ICAgICBUWF9QMF9BRERSID4+IDEpOwo+ID4gKwljdHgtPmkyYy50eF9wMV9jbGllbnQgPSBpMmNf
bmV3X2R1bW15KGNsaWVudC0+YWRhcHRlciwKPiA+ICsJCQkJCSAgICAgIFRYX1AxX0FERFIgPj4g
MSk7Cj4gPiArCWN0eC0+aTJjLnR4X3AyX2NsaWVudCA9IGkyY19uZXdfZHVtbXkoY2xpZW50LT5h
ZGFwdGVyLAo+ID4gKwkJCQkJICAgICAgVFhfUDJfQUREUiA+PiAxKTsKPiA+ICsKPiA+ICsJY3R4
LT5pMmMucnhfcDBfY2xpZW50ID0gaTJjX25ld19kdW1teShjbGllbnQtPmFkYXB0ZXIsCj4gPiAr
CQkJCQkgICAgICBSWF9QMF9BRERSID4+IDEpOwo+ID4gKwljdHgtPmkyYy5yeF9wMV9jbGllbnQg
PSBpMmNfbmV3X2R1bW15KGNsaWVudC0+YWRhcHRlciwKPiA+ICsJCQkJCSAgICAgIFJYX1AxX0FE
RFIgPj4gMSk7Cj4gPiArCWN0eC0+aTJjLnJ4X3AyX2NsaWVudCA9IGkyY19uZXdfZHVtbXkoY2xp
ZW50LT5hZGFwdGVyLAo+ID4gKwkJCQkJICAgICAgUlhfUDJfQUREUiA+PiAxKTsKPiA+ICsKPiA+
ICsJY3R4LT5pMmMudGNwY19jbGllbnQgPSBpMmNfbmV3X2R1bW15KGNsaWVudC0+YWRhcHRlciwK
PiA+ICsJCQkJCSAgICAgVENQQ19JTlRFUkZBQ0VfQUREUiA+PiAxKTsKPiA+ICsKPiA+ICsJaWYg
KCghY3R4LT5pMmMudHhfcDBfY2xpZW50IHwKPiA+ICsJICAgICAhY3R4LT5pMmMudHhfcDFfY2xp
ZW50IHwKPiA+ICsJICAgICAhY3R4LT5pMmMudHhfcDJfY2xpZW50IHwKPiA+ICsJICAgICAhY3R4
LT5pMmMucnhfcDBfY2xpZW50IHwKPiA+ICsJICAgICAhY3R4LT5pMmMucnhfcDFfY2xpZW50IHwK
PiA+ICsJICAgICAhY3R4LT5pMmMucnhfcDJfY2xpZW50IHwKPiA+ICsJICAgICAhY3R4LT5pMmMu
dGNwY19jbGllbnQpICE9IDApCj4gCj4gVGhpcyBpcyB0b28gY29tcGxpY2F0ZWQuICBEb24ndCBy
ZXR1cm4gMSBvbiBmYWlsdXJlLiAgRXZlcnkgZnVuY3Rpb24KPiBzaG91bGQgY2xlYW4gdXAgaXQn
cyBvd24gcGFydGlhbCBhbGxvY2F0aW9ucy4KPiAKPiAJaWYgKCFjdHgtPmkyYy50eF9wMF9jbGll
bnQgfHwKPiAJICAgICFjdHgtPmkyYy50eF9wMV9jbGllbnQgfHwKPiAJCS4uLgo+IAkgICAgIWN0
eC0+aTJjLnRjcGNfY2xpZW50KSB7Cj4gCQlhbng3NjI1X3VucmVnaXN0ZXJfaTJjX2R1bW15X2Ns
aWVudHMoY3R4KTsKPiAJCXJldHVybiAtRU5PTUVNOwo+IAl9Cj4gCj4gPiArCQlyZXR1cm4gMTsK
PiA+ICsKPiA+ICsJcmV0dXJuIDA7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGFueDc2
MjVfdW5yZWdpc3Rlcl9pMmNfZHVtbXlfY2xpZW50cyhzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgp
Cj4gPiArewo+ID4gKwlpMmNfdW5yZWdpc3Rlcl9kZXZpY2UoY3R4LT5pMmMudHhfcDBfY2xpZW50
KTsKPiA+ICsJaTJjX3VucmVnaXN0ZXJfZGV2aWNlKGN0eC0+aTJjLnR4X3AxX2NsaWVudCk7Cj4g
PiArCWkyY191bnJlZ2lzdGVyX2RldmljZShjdHgtPmkyYy50eF9wMl9jbGllbnQpOwo+ID4gKwlp
MmNfdW5yZWdpc3Rlcl9kZXZpY2UoY3R4LT5pMmMucnhfcDFfY2xpZW50KTsKPiA+ICsJaTJjX3Vu
cmVnaXN0ZXJfZGV2aWNlKGN0eC0+aTJjLnJ4X3AyX2NsaWVudCk7Cj4gPiArCWkyY191bnJlZ2lz
dGVyX2RldmljZShjdHgtPmkyYy5yeF9wM19jbGllbnQpOwo+ID4gKwlpMmNfdW5yZWdpc3Rlcl9k
ZXZpY2UoY3R4LT5pMmMudGNwY19jbGllbnQpOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW50
IGFueDc2MjVfaTJjX3Byb2JlKHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQsCj4gPiArCQkJICAg
ICBjb25zdCBzdHJ1Y3QgaTJjX2RldmljZV9pZCAqaWQpCj4gPiArewo+ID4gKwlzdHJ1Y3QgYW54
NzYyNV9kYXRhICpwbGF0Zm9ybTsKPiA+ICsJc3RydWN0IGFueDc2MjVfcGxhdGZvcm1fZGF0YSAq
cGRhdGE7Cj4gPiArCWludCByZXQgPSAwOwo+ID4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY2xp
ZW50LT5kZXY7Cj4gPiArCj4gPiArCWlmICghaTJjX2NoZWNrX2Z1bmN0aW9uYWxpdHkoY2xpZW50
LT5hZGFwdGVyLAo+ID4gKwkJCQkgICAgIEkyQ19GVU5DX1NNQlVTX0kyQ19CTE9DSykpIHsKPiA+
ICsJCURSTV9ERVZfRVJST1IoZGV2LCAiYW54NzYyNSdzIGkyYyBidXMgZG9lc24ndCBzdXBwb3J0
XG4iKTsKPiA+ICsJCXJldCA9IC1FTk9ERVY7Cj4gPiArCQlnb3RvIGV4aXQ7Cj4gCj4gcmV0dXJu
IC1FTk9ERVY7Cj4gCj4gPiArCX0KPiA+ICsKPiA+ICsJcGxhdGZvcm0gPSBremFsbG9jKHNpemVv
ZigqcGxhdGZvcm0pLCBHRlBfS0VSTkVMKTsKPiA+ICsJaWYgKCFwbGF0Zm9ybSkgewo+ID4gKwkJ
RFJNX0RFVl9FUlJPUihkZXYsICJmYWlsZWQgdG8gYWxsb2NhdGUgZHJpdmVyIGRhdGFcbiIpOwo+
ID4gKwkJcmV0ID0gLUVOT01FTTsKPiA+ICsJCWdvdG8gZXhpdDsKPiAKPiBVc2UgZGV2bV9remFs
bG9jKCk/ICByZXR1cm4gLUVOT01FTTsKPiAKPiA+ICsJfQo+ID4gKwo+ID4gKwlwZGF0YSA9ICZw
bGF0Zm9ybS0+cGRhdGE7Cj4gPiArCj4gPiArCS8qIGRldmljZSB0cmVlIHBhcnNpbmcgZnVuY3Rp
b24gY2FsbCAqLwo+ID4gKwlyZXQgPSBhbng3NjI1X3BhcnNlX2R0KCZjbGllbnQtPmRldiwgcGRh
dGEpOwo+ID4gKwlpZiAocmV0ICE9IDApCS8qIGlmIG9jY3VycyBlcnJvciAqLwo+IAo+IE9ubHkg
dXNlID09IDAgd2hlbiB5b3UgYXJlIHRhbGtpbmcgYWJvdXQgbnVtYmVycyBhcyBpbiBpZiAoc2l6
ZSA9PSAwKSBvcgo+IGlmIChjbnQgPT0gMCkgb3IgZm9yIHN0cmNtcCgpID09IDAuICBIZXJlIHpl
cm8gaXMgdGhlIGFic2VuY2Ugb2YgZXJyb3JzCj4gc28gaXQgc2hvdWxkIGJlICJpZiAocmV0KSAi
Lgo+IAo+ID4gKwkJZ290byBlcnIwOwo+IAo+IGdvdG8gZnJlZV9wbGF0ZnJvbTsKPiAKPiA+ICsK
PiA+ICsJLyogdG8gYWNjZXNzIGdsb2JhbCBwbGF0Zm9ybSBkYXRhICovCj4gPiArCXBsYXRmb3Jt
LT5jbGllbnQgPSBjbGllbnQ7Cj4gPiArCWkyY19zZXRfY2xpZW50ZGF0YShjbGllbnQsIHBsYXRm
b3JtKTsKPiA+ICsKPiA+ICsJaWYgKHBsYXRmb3JtLT5wZGF0YS5leHRjb25fc3VwcG9ydGVkKSB7
Cj4gPiArCQkvKiBnZXQgZXh0Y29uIGRldmljZSBmcm9tIERUUyAqLwo+ID4gKwkJcGxhdGZvcm0t
PmV4dGNvbiA9IGV4dGNvbl9nZXRfZWRldl9ieV9waGFuZGxlKCZjbGllbnQtPmRldiwgMCk7Cj4g
PiArCQlpZiAoUFRSX0VSUihwbGF0Zm9ybS0+ZXh0Y29uKSA9PSAtRVBST0JFX0RFRkVSKQo+ID4g
KwkJCWdvdG8gZXJyMDsKPiA+ICsJCWlmIChJU19FUlIocGxhdGZvcm0tPmV4dGNvbikpIHsKPiA+
ICsJCQlEUk1fREVWX0VSUk9SKCZjbGllbnQtPmRldiwKPiA+ICsJCQkJICAgICAgImNhbiBub3Qg
Z2V0IGV4dGNvbiBkZXZpY2UhIik7Cj4gPiArCQkJZ290byBlcnIwOwo+ID4gKwkJfQo+ID4gKwo+
ID4gKwkJcmV0ID0gYW54NzYyNV9leHRjb25fbm90aWZpZXJfaW5pdChwbGF0Zm9ybSk7Cj4gPiAr
CQlpZiAocmV0IDwgMCkKPiA+ICsJCQlnb3RvIGVycjA7Cj4gPiArCX0KPiA+ICsKPiA+ICsJYXRv
bWljX3NldCgmcGxhdGZvcm0tPnBvd2VyX3N0YXR1cywgMCk7Cj4gPiArCj4gPiArCW11dGV4X2lu
aXQoJnBsYXRmb3JtLT5sb2NrKTsKPiA+ICsKPiA+ICsJcmV0ID0gYW54NzYyNV9pbml0X2dwaW8o
cGxhdGZvcm0pOwo+ID4gKwlpZiAocmV0KSB7Cj4gPiArCQlEUk1fREVWX0VSUk9SKGRldiwgImZh
aWxlZCB0byBpbml0aWFsaXplIGdwaW9cbiIpOwo+ID4gKwkJZ290byBlcnIwOwo+ID4gKwl9Cj4g
PiArCj4gPiArCUlOSVRfV09SSygmcGxhdGZvcm0tPndvcmssIGFueDc2MjVfd29ya19mdW5jKTsK
PiA+ICsKPiA+ICsJcGxhdGZvcm0tPndvcmtxdWV1ZSA9IGNyZWF0ZV93b3JrcXVldWUoImFueDc2
MjVfd29yayIpOwo+ID4gKwlpZiAoIXBsYXRmb3JtLT53b3JrcXVldWUpIHsKPiA+ICsJCURSTV9E
RVZfRVJST1IoZGV2LCAiZmFpbGVkIHRvIGNyZWF0ZSB3b3JrIHF1ZXVlXG4iKTsKPiA+ICsJCXJl
dCA9IC1FTk9NRU07Cj4gPiArCQlnb3RvIGVycjE7Cj4gCj4gZ290byBlcnJfZnJlZV9ncGlvOwo+
IAo+ID4gKwl9Cj4gPiArCj4gPiArCWlmIChwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19pbnRyX2hwZCkg
ewo+ID4gKwkJcGxhdGZvcm0tPnBkYXRhLmhwZF9pcnEgPQo+ID4gKwkJCWdwaW9fdG9faXJxKHBs
YXRmb3JtLT5wZGF0YS5ncGlvX2ludHJfaHBkKTsKPiA+ICsJCWlmIChwbGF0Zm9ybS0+cGRhdGEu
aHBkX2lycSA8IDApIHsKPiA+ICsJCQlEUk1fREVWX0VSUk9SKGRldiwgImZhaWxlZCB0byBnZXQg
Z3BpbyBpcnFcbiIpOwo+ID4gKwkJCWdvdG8gZXJyMTsKPiAKPiBMZWFrLiAgZ290byBlcnJfZGVz
dHJveV93cTsKPiAKPiA+ICsJCX0KPiA+ICsKPiA+ICsJCXJldCA9IHJlcXVlc3RfdGhyZWFkZWRf
aXJxKHBsYXRmb3JtLT5wZGF0YS5ocGRfaXJxLAo+ID4gKwkJCQkJICAgTlVMTCwgYW54NzYyNV9p
bnRyX2hwZF9pc3IsCj4gPiArCQkJCQkgICBJUlFGX1RSSUdHRVJfRkFMTElORyB8Cj4gPiArCQkJ
CQkgICBJUlFGX1RSSUdHRVJfUklTSU5HIHwKPiA+ICsJCQkJCSAgIElSUUZfT05FU0hPVCwKPiA+
ICsJCQkJCSAgICJhbng3NjI1LWhwZCIsIHBsYXRmb3JtKTsKPiA+ICsJCWlmIChyZXQgPCAwKSB7
Cj4gPiArCQkJRFJNX0RFVl9FUlJPUihkZXYsICJmYWlsZWQgdG8gcmVxdWVzdCBpcnFcbiIpOwo+
ID4gKwkJCWdvdG8gZXJyMjsKPiAKPiAKPiBnb3RvIGZyZWVfd29ya3F1ZXVlOwo+IAo+ID4gKwkJ
fQo+ID4gKwo+ID4gKwkJcmV0ID0gaXJxX3NldF9pcnFfd2FrZShwbGF0Zm9ybS0+cGRhdGEuaHBk
X2lycSwgMSk7Cj4gPiArCQlpZiAocmV0IDwgMCkgewo+ID4gKwkJCURSTV9ERVZfRVJST1IoZGV2
LCAiUmVxdWVzdCBpcnEgZm9yIGhwZCIpOwo+ID4gKwkJCURSTV9ERVZfRVJST1IoZGV2LCAiaW50
ZXJydXB0IHdha2Ugc2V0IGZhaWxcbiIpOwo+ID4gKwkJCWdvdG8gZXJyMjsKPiAKPiBMZWFrPyAg
Z290byBlcnJfZnJlZV9pcnE/Cj4gCj4gCj4gPiArCQl9Cj4gPiArCj4gPiArCQlyZXQgPSBlbmFi
bGVfaXJxX3dha2UocGxhdGZvcm0tPnBkYXRhLmhwZF9pcnEpOwo+ID4gKwkJaWYgKHJldCA8IDAp
IHsKPiA+ICsJCQlEUk1fREVWX0VSUk9SKGRldiwgIkVuYWJsZSBpcnEgZm9yIEhQRCIpOwo+ID4g
KwkJCURSTV9ERVZfRVJST1IoZGV2LCAiaW50ZXJydXB0IHdha2UgZW5hYmxlIGZhaWxcbiIpOwo+
ID4gKwkJCWdvdG8gZXJyMjsKPiAKPiBMZWFrPwo+IAo+ID4gKwkJfQo+ID4gKwl9Cj4gPiArCj4g
PiArCWlmIChhbng3NjI1X3JlZ2lzdGVyX2kyY19kdW1teV9jbGllbnRzKHBsYXRmb3JtLCBjbGll
bnQpICE9IDApIHsKPiAKPiBOb3cgdGhhdCBhbng3NjI1X3JlZ2lzdGVyX2kyY19kdW1teV9jbGll
bnRzKCkgcmV0dXJucyBhIHZhbGlkIGVycm9yCj4gY29kZSB3ZSBzaG91bGQgcHJlc2VydmUgaXQu
ICBObyBuZWVkIHRvIHJlbGVhc2UgdGhlIHBhcnRpYWxseSBhbGxvY2F0ZWQKPiBkdW1teSBjbGll
bnRzIGJlY2F1c2UgaXQgZWl0aGVyIGFsbG9jYXRlcyBldmVyeXRoaW5nIG9yIGl0IGRvZXNuJ3QK
PiBhbGxvY2F0ZSBhbnl0aGluZy4KPiAKPiAJcmV0ID0gYW54NzYyNV9yZWdpc3Rlcl9pMmNfZHVt
bXlfY2xpZW50cygpOwo+IAlpZiAocmV0KQo+IAkJZ290byBlcnJfZnJlZV9pcnE7Cj4gCj4gPiAr
CQlyZXQgPSAtRU5PTUVNOwo+ID4gKwkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gcmVzZXJ2ZSBJMkMg
YnVzLlxuIik7Cj4gPiArCQlnb3RvIGVycjM7Cj4gPiArCX0KPiA+ICsKPiA+ICsJaWYgKHBsYXRm
b3JtLT5wZGF0YS5sb3dfcG93ZXJfbW9kZSA9PSAwKSB7Cj4gPiArCQlhbng3NjI1X2Rpc2FibGVf
cGRfcHJvdG9jb2wocGxhdGZvcm0pOwo+ID4gKwkJYXRvbWljX3NldCgmcGxhdGZvcm0tPnBvd2Vy
X3N0YXR1cywgMSk7Cj4gPiArCX0KPiA+ICsKPiA+ICsJLyogYWRkIHdvcmsgZnVuY3Rpb24gKi8K
PiA+ICsJcXVldWVfd29yayhwbGF0Zm9ybS0+d29ya3F1ZXVlLCAmcGxhdGZvcm0tPndvcmspOwo+
ID4gKwo+ID4gKwlwbGF0Zm9ybS0+YnJpZGdlLmZ1bmNzID0gJmFueDc2MjVfYnJpZGdlX2Z1bmNz
Owo+ID4gKyNpZiBJU19FTkFCTEVEKENPTkZJR19PRikKPiA+ICsJcGxhdGZvcm0tPmJyaWRnZS5v
Zl9ub2RlID0gY2xpZW50LT5kZXYub2Zfbm9kZTsKPiA+ICsjZW5kaWYKPiAKPiBXZSBjYW4gZ2V0
IHJpZCBvZiB0aGUgaWZkZWYuCj4gCj4gCWlmIChJU19FTkFCTEVEKENPTkZJR19PRikpCj4gCQlw
bGF0Zm9ybS0+YnJpZGdlLm9mX25vZGUgPSBjbGllbnQtPmRldi5vZl9ub2RlOwo+IAo+IAo+ID4g
Kwlkcm1fYnJpZGdlX2FkZCgmcGxhdGZvcm0tPmJyaWRnZSk7Cj4gPiArCj4gPiArCURSTV9ERVZf
REVCVUdfRFJJVkVSKGRldiwgInByb2JlIGRvbmVcbiIpOwo+ID4gKwlnb3RvIGV4aXQ7Cj4gCj4g
cmV0dXJuIDA7Cj4gCj4gPiArCj4gPiArZXJyMzoKPiA+ICsJYW54NzYyNV91bnJlZ2lzdGVyX2ky
Y19kdW1teV9jbGllbnRzKHBsYXRmb3JtKTsKPiA+ICtlcnIyOgo+ID4gKwlpZiAocGxhdGZvcm0t
PnBkYXRhLmdwaW9faW50cl9ocGQpCj4gPiArCQlmcmVlX2lycShwbGF0Zm9ybS0+cGRhdGEuaHBk
X2lycSwgcGxhdGZvcm0pOwo+ID4gK2VycjE6Cj4gPiArCWFueDc2MjVfZnJlZV9ncGlvKHBsYXRm
b3JtKTsKPiA+ICsJZGVzdHJveV93b3JrcXVldWUocGxhdGZvcm0tPndvcmtxdWV1ZSk7Cj4gPiAr
ZXJyMDoKPiA+ICsJa2ZyZWUocGxhdGZvcm0pOwo+ID4gK2V4aXQ6Cj4gPiArCXJldHVybiByZXQ7
Cj4gCj4gZXJyX2ZyZWVfaXJxOgo+IAlpZiAocGxhdGZvcm0tPnBkYXRhLmdwaW9faW50cl9ocGQp
Cj4gCQlmcmVlX2lycShwbGF0Zm9ybS0+cGRhdGEuaHBkX2lycSwgcGxhdGZvcm0pOwo+IGVycl9k
ZXN0cm95X3dxOgo+IAlkZXN0cm95X3dvcmtxdWV1ZShwbGF0Zm9ybS0+d29ya3F1ZXVlKTsKPiBl
cnJfZnJlZV9ncGlvOgo+IAlhbng3NjI1X2ZyZWVfZ3BpbyhwbGF0Zm9ybSk7Cj4gZXJyX2ZyZWVf
cGxhdGZvcm06Cj4gCWtmcmVlKHBsYXRmb3JtKTsKPiAKPiAJcmV0dXJuIHJldDsKPiAKPiAKPiA+
ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBhbng3NjI1X2kyY19yZW1vdmUoc3RydWN0IGkyY19j
bGllbnQgKmNsaWVudCkKPiA+ICt7Cj4gPiArCXN0cnVjdCBhbng3NjI1X2RhdGEgKnBsYXRmb3Jt
ID0gaTJjX2dldF9jbGllbnRkYXRhKGNsaWVudCk7Cj4gPiArCj4gPiArCWRybV9icmlkZ2VfcmVt
b3ZlKCZwbGF0Zm9ybS0+YnJpZGdlKTsKPiA+ICsKPiA+ICsJaWYgKHBsYXRmb3JtLT5wZGF0YS5n
cGlvX2ludHJfaHBkKQo+ID4gKwkJZnJlZV9pcnEocGxhdGZvcm0tPnBkYXRhLmhwZF9pcnEsIHBs
YXRmb3JtKTsKPiA+ICsKPiA+ICsJZGVzdHJveV93b3JrcXVldWUocGxhdGZvcm0tPndvcmtxdWV1
ZSk7Cj4gPiArCj4gPiArCWlmIChwbGF0Zm9ybS0+cGRhdGEuZXh0Y29uX3N1cHBvcnRlZCkgewo+
ID4gKwkJZGV2bV9leHRjb25fdW5yZWdpc3Rlcl9ub3RpZmllcigmcGxhdGZvcm0tPmNsaWVudC0+
ZGV2LAo+ID4gKwkJCQkJCXBsYXRmb3JtLT5leHRjb24sCj4gPiArCQkJCQkJRVhUQ09OX0RJU1Bf
RFAsCj4gPiArCQkJCQkJJnBsYXRmb3JtLT5ldmVudF9uYik7Cj4gPiArCQlmbHVzaF93b3JrKCZw
bGF0Zm9ybS0+ZXh0Y29uX3dxKTsKPiA+ICsJfQo+ID4gKwo+ID4gKwlhbng3NjI1X2RldGFjaF9k
c2kocGxhdGZvcm0pOwo+ID4gKwo+ID4gKwlpZiAocGxhdGZvcm0tPmJyaWRnZV9hdHRhY2hlZCkK
PiA+ICsJCWRybV9jb25uZWN0b3JfdW5yZWdpc3RlcigmcGxhdGZvcm0tPmNvbm5lY3Rvcik7Cj4g
PiArCj4gCj4gV2UgZG9uJ3QgY2FsbCBhbng3NjI1X2F0dGFjaF9kaXMoKSBvciBkcm1fY29ubmVj
dG9yX3JlZ2lzdGVyKCkgZHVyaW5nCj4gcHJvYmUgc28gaXQncyB3ZWlyZCB0aGF0IHdlIGFyZSBk
b2luZyBpdCBpbiByZW1vdmUuCj4gCj4gPiArCWFueDc2MjVfdW5yZWdpc3Rlcl9pMmNfZHVtbXlf
Y2xpZW50cyhwbGF0Zm9ybSk7Cj4gCj4gVGhpcyBzaG91bGQgZG9uZSBiZXR3ZWVuIGRybV9icmlk
Z2VfcmVtb3ZlKCkgYW5kIGZyZWVfaXJxKCkgc28gdGhhdAo+IHdlIHVud2luZCBpbiB0aGUgb3Bw
b3NpdGUvbWlycm9yIG9yZGVyIG9mIGhvdyB3ZSBwcm9iZSgpLgo+IAo+ID4gKwo+ID4gKwlhbng3
NjI1X2ZyZWVfZ3BpbyhwbGF0Zm9ybSk7Cj4gPiArCj4gPiArCWtmcmVlKHBsYXRmb3JtKTsKPiA+
ICsJcmV0dXJuIDA7Cj4gPiArfQo+IAo+IHJlZ2FyZHMsCj4gZGFuIGNhcnBlbnRlcgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGlu
ZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
