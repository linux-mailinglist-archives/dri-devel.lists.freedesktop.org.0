Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 917B11BC674
	for <lists+dri-devel@lfdr.de>; Tue, 28 Apr 2020 19:20:45 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2661E6E882;
	Tue, 28 Apr 2020 17:20:42 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mga01.intel.com (mga01.intel.com [192.55.52.88])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 72CAF6E875;
 Tue, 28 Apr 2020 17:20:35 +0000 (UTC)
IronPort-SDR: pJAdPlF1tPym7AR6gdgVYWFeZpBI3ZuX9NlOKo0bGGi4lAodLacHN49D4bdRsuB6gVrVUSyFsF
 zdXPTrL93WYQ==
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga002.jf.intel.com ([10.7.209.21])
 by fmsmga101.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 28 Apr 2020 10:20:34 -0700
IronPort-SDR: F8vCPT/9WK65gxkwKCpCKeeloUrFvOOwYPzfPqM4tTtHPu06tcl4HKeC3hhMK4g7BYPu3ATMA0
 guve2knVbnzg==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.73,328,1583222400"; d="scan'208";a="275905996"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.174])
 by orsmga002.jf.intel.com with SMTP; 28 Apr 2020 10:20:30 -0700
Received: by stinkbox (sSMTP sendmail emulation);
 Tue, 28 Apr 2020 20:20:29 +0300
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v3 12/16] drm/i915: Stop using mode->private_flags
Date: Tue, 28 Apr 2020 20:19:36 +0300
Message-Id: <20200428171940.19552-13-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.24.1
In-Reply-To: <20200428171940.19552-1-ville.syrjala@linux.intel.com>
References: <20200428171940.19552-1-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Daniel Vetter <daniel.vetter@ffwll.ch>, intel-gfx@lists.freedesktop.org,
 Sam Ravnborg <sam@ravnborg.org>, Emil Velikov <emil.l.velikov@gmail.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KClJl
cGxhY2UgdGhlIHVzZSBvZiBtb2RlLT5wcml2YXRlX2ZsYWdzIHdpdGggYSB0cnVseSBwcml2YXRl
IGJpdG1ha3MKaW4gb3VyIG93biBjcnRjIHN0YXRlLiBXZSBhbHNvIG5lZWQgYSBjb3B5IGluIHRo
ZSBjcnRjIGl0c2VsZiBzbyB0aGUKdmJsYW5rIGNvZGUgY2FuIGdldCBhdCBpdC4gV2UgYWxyZWFk
eSBoYXZlIHNjYW5saW5lX29mZnNldCBpbiB0aGVyZQpmb3IgYSBzaW1pbGFyIHJlYXNvbiwgYXMg
d2VsbCBhcyB0aGUgdmJsYW5rLT5od21vZGUgd2hpY2ggaXMgYXNzaWduZWQKdmlhIGRybV9jYWxj
X3RpbWVzdGFtcGluZ19jb25zdGFudHMoKS4gRm9ydHVuYXRlbHkgd2Ugbm93IGhhdmUgYQpuaWNl
IHBsYWNlIGZvciBkb2luZyB0aGUgY3J0Y19zdGF0ZS0+Y3J0YyBjb3B5IGluCmludGVsX2NydGNf
dXBkYXRlX2FjdGl2ZV90aW1pbmdzKCkgd2hpY2ggZ2V0cyBjYWxsZWQgYm90aCBmb3IKbW9kZXNl
dHMgYW5kIGluaXQvcmVzdW1lIHJlYWRvdXQuCgpUaGUgb25lIHNsaWdodGx5IGlmZnkgc3BvdCBp
cyB0aGUgSU5IRVJJVEVEIGZsYWcgd2hpY2ggd2Ugd2FudCB0bwpwcmVzZXJ2ZSB1bnRpbCB1c2Vy
c3BhY2UvZmJfaGVscGVyIGRvZXMgdGhlIGZpcnN0IHByb3BlciBjb21taXQgYWZ0ZXIKYWN0dWFs
bHkgY2FsbGluZyAuZGV0ZWN0aSgpIG9uIHRoZSBjb25uZWN0b3JzLiBPdGhlcndpc2Ugd2UgZG9u
J3QgaGF2ZQp0aGUgZnVsbCBzaW5rIGNhcGFiaWxpdGllcyAoYXVkaW8saW5mb2ZyYW1lcyxldGMu
KSB3aGVuIC5jb21wdXRlX2NvbmZpZygpCmdldHMgY2FsbGVkIGFuZCB0aHVzIHdlIHdpbGwgZmFp
bCB0byBlbmFibGUgdGhvc2UgZmVhdHVyZXMgd2hlbiB0aGUKZmlyc3QgdXNlcnNwYWNlIGNvbW1p
dCBoYXBwZW5zLiBUaGUgb25seSBpbnRlcm5hbCBjb21taXQgd2UgZG8gcHJpb3IgdG8KdGhhdCBz
aG91bGQgYmUgZnJvbSBpbnRlbF9pbml0aWFsX2NvbW1pdCgpIGFuZCB0aGVyZSB3ZSBjYW4gc2lt
cGx5CnByZXNlcnZlIHRoZSBJTkhFUklURUQgZmxhZyBmcm9tIHRoZSByZWFkb3V0LgoKQ0M6IFNh
bSBSYXZuYm9yZyA8c2FtQHJhdm5ib3JnLm9yZz4KQ2M6IERhbmllbCBWZXR0ZXIgPGRhbmllbC52
ZXR0ZXJAZmZ3bGwuY2g+CkNjOiBFbWlsIFZlbGlrb3YgPGVtaWwubC52ZWxpa292QGdtYWlsLmNv
bT4KUmV2aWV3ZWQtYnk6IERhbmllbCBWZXR0ZXIgPGRhbmllbC52ZXR0ZXJAZmZ3bGwuY2g+ClNp
Z25lZC1vZmYtYnk6IFZpbGxlIFN5cmrDpGzDpCA8dmlsbGUuc3lyamFsYUBsaW51eC5pbnRlbC5j
b20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pY2xfZHNpLmMgICAgICAgIHwg
MTMgKysrKy0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9taWMu
YyAgIHwgIDEgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMg
IHwgMjQgKysrKysrKysrKysrKy0tLS0tLQogLi4uL2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlz
cGxheV90eXBlcy5oICAgIHwgIDkgKysrKysrLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF90di5jICAgICAgIHwgIDQgKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS92bHZfZHNpLmMgICAgICAgIHwgIDYgKystLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
aXJxLmMgICAgICAgICAgICAgICB8ICA0ICsrLS0KIDcgZmlsZXMgY2hhbmdlZCwgMzcgaW5zZXJ0
aW9ucygrKSwgMjQgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pY2xfZHNpLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ljbF9k
c2kuYwppbmRleCA0ZmVjNWJkNjQ5MjAuLjI1MjAwZjI4OWU2ZSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pY2xfZHNpLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pY2xfZHNpLmMKQEAgLTE0NjksOCArMTQ2OSw3IEBAIHN0YXRpYyB2b2lkIGdl
bjExX2RzaV9nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCXBpcGVf
Y29uZmlnLT5waXBlX2JwcCA9IGJkd19nZXRfcGlwZW1pc2NfYnBwKGNydGMpOwogCiAJaWYgKGdl
bjExX2RzaV9pc19wZXJpb2RpY19jbWRfbW9kZShpbnRlbF9kc2kpKQotCQlwaXBlX2NvbmZpZy0+
aHcuYWRqdXN0ZWRfbW9kZS5wcml2YXRlX2ZsYWdzIHw9Ci0JCQkJCUk5MTVfTU9ERV9GTEFHX0RT
SV9QRVJJT0RJQ19DTURfTU9ERTsKKwkJcGlwZV9jb25maWctPm1vZGVfZmxhZ3MgfD0gSTkxNV9N
T0RFX0ZMQUdfRFNJX1BFUklPRElDX0NNRF9NT0RFOwogfQogCiBzdGF0aWMgaW50IGdlbjExX2Rz
aV9kc2NfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCkBAIC0x
NTU4LDEwICsxNTU3LDYgQEAgc3RhdGljIGludCBnZW4xMV9kc2lfY29tcHV0ZV9jb25maWcoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAKIAlwaXBlX2NvbmZpZy0+cG9ydF9jbG9jayA9
IGFmZV9jbGsoZW5jb2RlciwgcGlwZV9jb25maWcpIC8gNTsKIAotCS8qIFdlIHdvdWxkIG5vdCBv
cGVyYXRlIGluIHBlcmlvZGljIGNvbW1hbmQgbW9kZSAqLwotCXBpcGVfY29uZmlnLT5ody5hZGp1
c3RlZF9tb2RlLnByaXZhdGVfZmxhZ3MgJj0KLQkJCQkJfkk5MTVfTU9ERV9GTEFHX0RTSV9QRVJJ
T0RJQ19DTURfTU9ERTsKLQogCS8qCiAJICogSW4gY2FzZSBvZiBURSBHQVRFIGNtZCBtb2RlLCB3
ZQogCSAqIHJlY2VpdmUgVEUgZnJvbSB0aGUgc2xhdmUgaWYKQEAgLTE1NjksMTQgKzE1NjQsMTQg
QEAgc3RhdGljIGludCBnZW4xMV9kc2lfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsCiAJICovCiAJaWYgKGlzX2NtZF9tb2RlKGludGVsX2RzaSkpIHsKIAkJaWYg
KGludGVsX2RzaS0+cG9ydHMgPT0gKEJJVChQT1JUX0IpIHwgQklUKFBPUlRfQSkpKQotCQkJcGlw
ZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUucHJpdmF0ZV9mbGFncyB8PQorCQkJcGlwZV9jb25m
aWctPm1vZGVfZmxhZ3MgfD0KIAkJCQkJCUk5MTVfTU9ERV9GTEFHX0RTSV9VU0VfVEUxIHwKIAkJ
CQkJCUk5MTVfTU9ERV9GTEFHX0RTSV9VU0VfVEUwOwogCQllbHNlIGlmIChpbnRlbF9kc2ktPnBv
cnRzID09IEJJVChQT1JUX0IpKQotCQkJcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUucHJp
dmF0ZV9mbGFncyB8PQorCQkJcGlwZV9jb25maWctPm1vZGVfZmxhZ3MgfD0KIAkJCQkJCUk5MTVf
TU9ERV9GTEFHX0RTSV9VU0VfVEUxOwogCQllbHNlCi0JCQlwaXBlX2NvbmZpZy0+aHcuYWRqdXN0
ZWRfbW9kZS5wcml2YXRlX2ZsYWdzIHw9CisJCQlwaXBlX2NvbmZpZy0+bW9kZV9mbGFncyB8PQog
CQkJCQkJSTkxNV9NT0RFX0ZMQUdfRFNJX1VTRV9URTA7CiAJfQogCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0b21pYy5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9hdG9taWMuYwppbmRleCBkMDQzMDU3ZDJmYTAuLjU4NjNlMzM5
YTQyNiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9t
aWMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0b21pYy5jCkBA
IC0yNTIsNiArMjUyLDcgQEAgaW50ZWxfY3J0Y19kdXBsaWNhdGVfc3RhdGUoc3RydWN0IGRybV9j
cnRjICpjcnRjKQogCWNydGNfc3RhdGUtPndtLm5lZWRfcG9zdHZibF91cGRhdGUgPSBmYWxzZTsK
IAljcnRjX3N0YXRlLT5mYl9iaXRzID0gMDsKIAljcnRjX3N0YXRlLT51cGRhdGVfcGxhbmVzID0g
MDsKKwljcnRjX3N0YXRlLT5tb2RlX2ZsYWdzICY9IH5JOTE1X01PREVfRkxBR19JTkhFUklURUQ7
CiAKIAlyZXR1cm4gJmNydGNfc3RhdGUtPnVhcGk7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCmluZGV4IDlmNDY1ZWRmNDA2My4uYTM3MjZlOTM2Zjdi
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXku
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwpAQCAt
NjQyNSw3ICs2NDI1LDcgQEAgc3RhdGljIGJvb2wgaHN3X3Bvc3RfdXBkYXRlX2VuYWJsZV9pcHMo
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3MKIAkgKiBmb3JjaWJseSBl
bmFibGUgSVBTIG9uIHRoZSBmaXJzdCBmYXN0c2V0LgogCSAqLwogCWlmIChuZXdfY3J0Y19zdGF0
ZS0+dXBkYXRlX3BpcGUgJiYKLQkgICAgb2xkX2NydGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGUu
cHJpdmF0ZV9mbGFncyAmIEk5MTVfTU9ERV9GTEFHX0lOSEVSSVRFRCkKKwkgICAgb2xkX2NydGNf
c3RhdGUtPm1vZGVfZmxhZ3MgJiBJOTE1X01PREVfRkxBR19JTkhFUklURUQpCiAJCXJldHVybiB0
cnVlOwogCiAJcmV0dXJuICFvbGRfY3J0Y19zdGF0ZS0+aXBzX2VuYWJsZWQ7CkBAIC0xMzU0NCw4
ICsxMzU0NCw4IEBAIGludGVsX3BpcGVfY29uZmlnX2NvbXBhcmUoY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmN1cnJlbnRfY29uZmlnLAogCWJvb2wgcmV0ID0gdHJ1ZTsKIAl1MzIgYnBf
Z2FtbWEgPSAwOwogCWJvb2wgZml4dXBfaW5oZXJpdGVkID0gZmFzdHNldCAmJgotCQkoY3VycmVu
dF9jb25maWctPmh3Lm1vZGUucHJpdmF0ZV9mbGFncyAmIEk5MTVfTU9ERV9GTEFHX0lOSEVSSVRF
RCkgJiYKLQkJIShwaXBlX2NvbmZpZy0+aHcubW9kZS5wcml2YXRlX2ZsYWdzICYgSTkxNV9NT0RF
X0ZMQUdfSU5IRVJJVEVEKTsKKwkJKGN1cnJlbnRfY29uZmlnLT5tb2RlX2ZsYWdzICYgSTkxNV9N
T0RFX0ZMQUdfSU5IRVJJVEVEKSAmJgorCQkhKHBpcGVfY29uZmlnLT5tb2RlX2ZsYWdzICYgSTkx
NV9NT0RFX0ZMQUdfSU5IRVJJVEVEKTsKIAogCWlmIChmaXh1cF9pbmhlcml0ZWQgJiYgIWZhc3Ri
b290X2VuYWJsZWQoZGV2X3ByaXYpKSB7CiAJCWRybV9kYmdfa21zKCZkZXZfcHJpdi0+ZHJtLApA
QCAtMTQzMzcsNiArMTQzMzcsOCBAQCBpbnRlbF9jcnRjX3VwZGF0ZV9hY3RpdmVfdGltaW5ncyhj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKIAogCWRybV9jYWxjX3Rp
bWVzdGFtcGluZ19jb25zdGFudHMoJmNydGMtPmJhc2UsIGFkanVzdGVkX21vZGUpOwogCisJY3J0
Yy0+bW9kZV9mbGFncyA9IGNydGNfc3RhdGUtPm1vZGVfZmxhZ3M7CisKIAkvKgogCSAqIFRoZSBz
Y2FubGluZSBjb3VudGVyIGluY3JlbWVudHMgYXQgdGhlIGxlYWRpbmcgZWRnZSBvZiBoc3luYy4K
IAkgKgpAQCAtMTQ2OTgsOCArMTQ3MDAsNyBAQCBzdGF0aWMgaW50IGludGVsX2F0b21pY19jaGVj
ayhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogCS8qIENhdGNoIEk5MTVfTU9ERV9GTEFHX0lOSEVS
SVRFRCAqLwogCWZvcl9lYWNoX29sZG5ld19pbnRlbF9jcnRjX2luX3N0YXRlKHN0YXRlLCBjcnRj
LCBvbGRfY3J0Y19zdGF0ZSwKIAkJCQkJICAgIG5ld19jcnRjX3N0YXRlLCBpKSB7Ci0JCWlmIChu
ZXdfY3J0Y19zdGF0ZS0+dWFwaS5tb2RlLnByaXZhdGVfZmxhZ3MgIT0KLQkJICAgIG9sZF9jcnRj
X3N0YXRlLT51YXBpLm1vZGUucHJpdmF0ZV9mbGFncykKKwkJaWYgKG5ld19jcnRjX3N0YXRlLT5t
b2RlX2ZsYWdzICE9IG9sZF9jcnRjX3N0YXRlLT5tb2RlX2ZsYWdzKQogCQkJbmV3X2NydGNfc3Rh
dGUtPnVhcGkubW9kZV9jaGFuZ2VkID0gdHJ1ZTsKIAl9CiAKQEAgLTE1MDQ1LDcgKzE1MDQ2LDcg
QEAgc3RhdGljIHZvaWQgaW50ZWxfdXBkYXRlX2NydGMoc3RydWN0IGludGVsX2F0b21pY19zdGF0
ZSAqc3RhdGUsCiAJICogb2YgZW5hYmxpbmcgdGhlbSBvbiB0aGUgQ1JUQydzIGZpcnN0IGZhc3Rz
ZXQuCiAJICovCiAJaWYgKG5ld19jcnRjX3N0YXRlLT51cGRhdGVfcGlwZSAmJiAhbW9kZXNldCAm
JgotCSAgICBvbGRfY3J0Y19zdGF0ZS0+aHcubW9kZS5wcml2YXRlX2ZsYWdzICYgSTkxNV9NT0RF
X0ZMQUdfSU5IRVJJVEVEKQorCSAgICBvbGRfY3J0Y19zdGF0ZS0+bW9kZV9mbGFncyAmIEk5MTVf
TU9ERV9GTEFHX0lOSEVSSVRFRCkKIAkJaW50ZWxfY3J0Y19hcm1fZmlmb191bmRlcnJ1bihjcnRj
LCBuZXdfY3J0Y19zdGF0ZSk7CiB9CiAKQEAgLTE3NTExLDYgKzE3NTEyLDE1IEBAIHN0YXRpYyBp
bnQgaW50ZWxfaW5pdGlhbF9jb21taXQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKIAkJfQogCiAJ
CWlmIChjcnRjX3N0YXRlLT5ody5hY3RpdmUpIHsKKwkJCS8qCisJCQkgKiBXZSd2ZSBub3QgeWV0
IGRldGVjdGVkIHNpbmsgY2FwYWJpbGl0aWVzCisJCQkgKiAoYXVkaW8saW5mb2ZyYW1lcyxldGMu
KSBhbmQgdGh1cyB3ZSBkb24ndCB3YW50IHRvCisJCQkgKiBmb3JjZSBhIGZ1bGwgc3RhdGUgcmVj
b21wdXRhdGlvbiB5ZXQuIFdlIHdhbnQgdGhhdCB0bworCQkJICogaGFwcGVuIG9ubHkgZm9yIHRo
ZSBmaXJzdCByZWFsIGNvbW1pdCBmcm9tIHVzZXJzcGFjZS4KKwkJCSAqIFNvIHByZXNlcnZlIHRo
ZSBpbmhlcml0ZWQgZmxhZyBmb3IgdGhlIHRpbWUgYmVpbmcuCisJCQkgKi8KKwkJCWNydGNfc3Rh
dGUtPm1vZGVfZmxhZ3MgfD0gSTkxNV9NT0RFX0ZMQUdfSU5IRVJJVEVEOworCiAJCQlyZXQgPSBk
cm1fYXRvbWljX2FkZF9hZmZlY3RlZF9wbGFuZXMoc3RhdGUsICZjcnRjLT5iYXNlKTsKIAkJCWlm
IChyZXQpCiAJCQkJZ290byBvdXQ7CkBAIC0xODI4MSw3ICsxODI5MSw3IEBAIHN0YXRpYyB2b2lk
IGludGVsX21vZGVzZXRfcmVhZG91dF9od19zdGF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQog
CQkJICogc2V0IGEgZmxhZyB0byBpbmRpY2F0ZSB0aGF0IGEgZnVsbCByZWNhbGN1bGF0aW9uIGlz
CiAJCQkgKiBuZWVkZWQgb24gdGhlIG5leHQgY29tbWl0LgogCQkJICovCi0JCQltb2RlLT5wcml2
YXRlX2ZsYWdzID0gSTkxNV9NT0RFX0ZMQUdfSU5IRVJJVEVEOworCQkJY3J0Y19zdGF0ZS0+bW9k
ZV9mbGFncyB8PSBJOTE1X01PREVfRkxBR19JTkhFUklURUQ7CiAKIAkJCWludGVsX2NydGNfY29t
cHV0ZV9waXhlbF9yYXRlKGNydGNfc3RhdGUpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oCmluZGV4IDk0ODg0NDllNGI5NC4uNDBj
NjUyNzQyMTBiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2Rpc3BsYXlfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2Rpc3BsYXlfdHlwZXMuaApAQCAtNjQzLDcgKzY0Myw3IEBAIHN0cnVjdCBpbnRlbF9jcnRjX3Nj
YWxlcl9zdGF0ZSB7CiAJaW50IHNjYWxlcl9pZDsKIH07CiAKLS8qIGRybV9tb2RlLT5wcml2YXRl
X2ZsYWdzICovCisvKiB7Y3J0YyxjcnRjX3N0YXRlfS0+bW9kZV9mbGFncyAqLwogI2RlZmluZSBJ
OTE1X01PREVfRkxBR19JTkhFUklURUQgKDE8PDApCiAvKiBGbGFnIHRvIGdldCBzY2FubGluZSB1
c2luZyBmcmFtZSB0aW1lIHN0YW1wcyAqLwogI2RlZmluZSBJOTE1X01PREVfRkxBR19HRVRfU0NB
TkxJTkVfRlJPTV9USU1FU1RBTVAgKDE8PDEpCkBAIC05NTQsNiArOTU0LDkgQEAgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgewogCS8qIFVzZWQgYnkgU0RWTyAoYW5kIGlmIHdlIGV2ZXIgZml4IGl0
LCBIRE1JKS4gKi8KIAl1bnNpZ25lZCBwaXhlbF9tdWx0aXBsaWVyOwogCisJLyogSTkxNV9NT0RF
X0ZMQUdfKiAqLworCXU4IG1vZGVfZmxhZ3M7CisKIAl1OCBsYW5lX2NvdW50OwogCiAJLyoKQEAg
LTExMTYsNiArMTExOSwxMCBAQCBzdHJ1Y3QgaW50ZWxfY3J0YyB7CiAJICovCiAJYm9vbCBhY3Rp
dmU7CiAJdTggcGxhbmVfaWRzX21hc2s7CisKKwkvKiBJOTE1X01PREVfRkxBR18qICovCisJdTgg
bW9kZV9mbGFnczsKKwogCXVuc2lnbmVkIGxvbmcgbG9uZyBlbmFibGVkX3Bvd2VyX2RvbWFpbnM7
CiAJc3RydWN0IGludGVsX292ZXJsYXkgKm92ZXJsYXk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfdHYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfdHYuYwppbmRleCBhYmM2NzIwN2YyZjMuLjc3NzAzMmQ5Njk3YiAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF90di5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfdHYuYwpAQCAtMTE1OCw3ICsxMTU4LDcgQEAg
aW50ZWxfdHZfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAogCS8q
IHBpeGVsIGNvdW50ZXIgZG9lc24ndCB3b3JrIG9uIGk5NjVnbSBUViBvdXRwdXQgKi8KIAlpZiAo
SVNfSTk2NUdNKGRldl9wcml2KSkKLQkJYWRqdXN0ZWRfbW9kZS0+cHJpdmF0ZV9mbGFncyB8PQor
CQlwaXBlX2NvbmZpZy0+bW9kZV9mbGFncyB8PQogCQkJSTkxNV9NT0RFX0ZMQUdfVVNFX1NDQU5M
SU5FX0NPVU5URVI7CiB9CiAKQEAgLTEzMjgsNyArMTMyOCw3IEBAIGludGVsX3R2X2NvbXB1dGVf
Y29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCiAJLyogcGl4ZWwgY291bnRl
ciBkb2Vzbid0IHdvcmsgb24gaTk2NWdtIFRWIG91dHB1dCAqLwogCWlmIChJU19JOTY1R00oZGV2
X3ByaXYpKQotCQlhZGp1c3RlZF9tb2RlLT5wcml2YXRlX2ZsYWdzIHw9CisJCXBpcGVfY29uZmln
LT5tb2RlX2ZsYWdzIHw9CiAJCQlJOTE1X01PREVfRkxBR19VU0VfU0NBTkxJTkVfQ09VTlRFUjsK
IAogCXJldHVybiAwOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS92
bHZfZHNpLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L3Zsdl9kc2kuYwppbmRleCBm
NTgyYWI1MmYwYjAuLjA1MmUwYjMxYTJkYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS92bHZfZHNpLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS92
bHZfZHNpLmMKQEAgLTI5OCw3ICsyOTgsNyBAQCBzdGF0aWMgaW50IGludGVsX2RzaV9jb21wdXRl
X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAogCWlmIChJU19HRU45X0xQ
KGRldl9wcml2KSkgewogCQkvKiBFbmFibGUgRnJhbWUgdGltZSBzdGFtcCBiYXNlZCBzY2FubGlu
ZSByZXBvcnRpbmcgKi8KLQkJYWRqdXN0ZWRfbW9kZS0+cHJpdmF0ZV9mbGFncyB8PQorCQlwaXBl
X2NvbmZpZy0+bW9kZV9mbGFncyB8PQogCQkJSTkxNV9NT0RFX0ZMQUdfR0VUX1NDQU5MSU5FX0ZS
T01fVElNRVNUQU1QOwogCiAJCS8qIER1YWwgbGluayBnb2VzIHRvIERTSSB0cmFuc2NvZGVyIEEu
ICovCkBAIC0xMDk3LDggKzEwOTcsOCBAQCBzdGF0aWMgdm9pZCBieHRfZHNpX2dldF9waXBlX2Nv
bmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAlwaXBlX2NvbmZpZy0+cGlwZV9i
cHAgPSBiZHdfZ2V0X3BpcGVtaXNjX2JwcChjcnRjKTsKIAogCS8qIEVuYWJsZSBGcmFtZSB0aW1l
IHN0YW1vIGJhc2VkIHNjYW5saW5lIHJlcG9ydGluZyAqLwotCWFkanVzdGVkX21vZGUtPnByaXZh
dGVfZmxhZ3MgfD0KLQkJCUk5MTVfTU9ERV9GTEFHX0dFVF9TQ0FOTElORV9GUk9NX1RJTUVTVEFN
UDsKKwlwaXBlX2NvbmZpZy0+bW9kZV9mbGFncyB8PQorCQlJOTE1X01PREVfRkxBR19HRVRfU0NB
TkxJTkVfRlJPTV9USU1FU1RBTVA7CiAKIAkvKiBJbiB0ZXJtcyBvZiBwaXhlbHMgKi8KIAlhZGp1
c3RlZF9tb2RlLT5jcnRjX2hkaXNwbGF5ID0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfaXJxLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2lycS5jCmluZGV4IGJk
NzIyZDA2NTBjOC4uZTVkMWViMDE4OGE2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2lycS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmMKQEAgLTcz
NSw3ICs3MzUsNyBAQCBzdGF0aWMgaW50IF9faW50ZWxfZ2V0X2NydGNfc2NhbmxpbmUoc3RydWN0
IGludGVsX2NydGMgKmNydGMpCiAJdmJsYW5rID0gJmNydGMtPmJhc2UuZGV2LT52YmxhbmtbZHJt
X2NydGNfaW5kZXgoJmNydGMtPmJhc2UpXTsKIAltb2RlID0gJnZibGFuay0+aHdtb2RlOwogCi0J
aWYgKG1vZGUtPnByaXZhdGVfZmxhZ3MgJiBJOTE1X01PREVfRkxBR19HRVRfU0NBTkxJTkVfRlJP
TV9USU1FU1RBTVApCisJaWYgKGNydGMtPm1vZGVfZmxhZ3MgJiBJOTE1X01PREVfRkxBR19HRVRf
U0NBTkxJTkVfRlJPTV9USU1FU1RBTVApCiAJCXJldHVybiBfX2ludGVsX2dldF9jcnRjX3NjYW5s
aW5lX2Zyb21fdGltZXN0YW1wKGNydGMpOwogCiAJdnRvdGFsID0gbW9kZS0+Y3J0Y192dG90YWw7
CkBAIC03OTQsNyArNzk0LDcgQEAgc3RhdGljIGJvb2wgaTkxNV9nZXRfY3J0Y19zY2Fub3V0cG9z
KHN0cnVjdCBkcm1fY3J0YyAqX2NydGMsCiAJdW5zaWduZWQgbG9uZyBpcnFmbGFnczsKIAlib29s
IHVzZV9zY2FubGluZV9jb3VudGVyID0gSU5URUxfR0VOKGRldl9wcml2KSA+PSA1IHx8CiAJCUlT
X0c0WChkZXZfcHJpdikgfHwgSVNfR0VOKGRldl9wcml2LCAyKSB8fAotCQltb2RlLT5wcml2YXRl
X2ZsYWdzICYgSTkxNV9NT0RFX0ZMQUdfVVNFX1NDQU5MSU5FX0NPVU5URVI7CisJCWNydGMtPm1v
ZGVfZmxhZ3MgJiBJOTE1X01PREVfRkxBR19VU0VfU0NBTkxJTkVfQ09VTlRFUjsKIAogCWlmIChk
cm1fV0FSTl9PTigmZGV2X3ByaXYtPmRybSwgIW1vZGUtPmNydGNfY2xvY2spKSB7CiAJCWRybV9k
YmcoJmRldl9wcml2LT5kcm0sCi0tIAoyLjI0LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxp
c3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFu
L2xpc3RpbmZvL2RyaS1kZXZlbAo=
