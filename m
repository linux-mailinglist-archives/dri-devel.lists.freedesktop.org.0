Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id CC7296FDFF
	for <lists+dri-devel@lfdr.de>; Mon, 22 Jul 2019 12:43:35 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 63CC289BF8;
	Mon, 22 Jul 2019 10:43:29 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from smtp.domeneshop.no (smtp.domeneshop.no
 [IPv6:2a01:5b40:0:3005::1])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E3F1A89A77
 for <dri-devel@lists.freedesktop.org>; Mon, 22 Jul 2019 10:43:26 +0000 (UTC)
Received: from 211.81-166-168.customer.lyse.net ([81.166.168.211]:55388
 helo=localhost.localdomain)
 by smtp.domeneshop.no with esmtpsa (TLS1.2:ECDHE_RSA_AES_128_CBC_SHA1:128)
 (Exim 4.84_2) (envelope-from <noralf@tronnes.org>)
 id 1hpVmv-0001lD-1d; Mon, 22 Jul 2019 12:43:25 +0200
From: =?UTF-8?q?Noralf=20Tr=C3=B8nnes?= <noralf@tronnes.org>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v2 4/9] drm/tinydrm: Split struct mipi_dbi in two
Date: Mon, 22 Jul 2019 12:43:07 +0200
Message-Id: <20190722104312.16184-5-noralf@tronnes.org>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190722104312.16184-1-noralf@tronnes.org>
References: <20190722104312.16184-1-noralf@tronnes.org>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; d=tronnes.org; s=ds201810; 
 h=Content-Transfer-Encoding:Content-Type:MIME-Version:References:In-Reply-To:Message-Id:Date:Subject:Cc:To:From;
 bh=HIg52yJYwXfDtqqHm8Y5RESKbIcZJtsTIxAHUfF72Ig=; 
 b=mOGp1bXnCM8W7C2t6sfl87xTqaBb8AxzOUXOtri8t6hL6I46iwVyUzxoQ23V7AD1yybgQH5wziVMRYY9l7sHPdikjUA9sno8t7H7i0i/6C0BaWI7mV5mWeVH/AKKm6o5bhsHswZvCR19C6Jbq2wWjMEUlUea+P4Bz/L44S0ekartKBaY32g03KzshMIC25wsEH/5Sal0lg5cH6wfP/H3jmHEno6uECW5YCpLNoS58VR5m28cLJgE7f6+idS5UvA8BlqL/GBj2q97PXOlBsL3OZO6UNTBKcFxQtx4HXSkUf8TdhTVTb7Qix29bqCosgjQXiDFgldO7d3Fxem4W2HgnA==;
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: sam@ravnborg.org, david@lechnology.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

U3BsaXQgc3RydWN0IG1pcGlfZGJpIGludG8gYW4gaW50ZXJmYWNlIHBhcnQgYW5kIGEgZGlzcGxh
eSBwaXBlbGluZSBwYXJ0LgpUaGUgaW50ZXJmYWNlIHBhcnQgY2FuIGJlIHVzZWQgYnkgZHJpdmVy
cyB0aGF0IG5lZWQgdG8gaW5pdGlhbGl6ZSB0aGUKY29udHJvbGxlciwgYnV0IHRoYXQgd29uJ3Qg
dXBsb2FkIHRoZSBmcmFtZWJ1ZmZlciBvdmVyIHRoaXMgaW50ZXJmYWNlLgoKTUlQSSBEQkkgc3Vw
cG9ydHMgMyBpbnRlcmZhY2UgdHlwZXM6Ci0gQS4gTW90b3JvbGEgNjgwMCB0eXBlIHBhcmFsbGVs
IGJ1cwotIEIuIEludGVsIDgwODAgdHlwZSBwYXJhbGxlbCBidXMKLSBDLiBTUEkgdHlwZSB3aXRo
IDMgb3B0aW9uczoKCkkndmUgZW1iZWRkZWQgdGhlIFNQSSB0eXBlIHNwZWNpZmljcyBpbiB0aGUg
bWlwaV9kYmkgc3RydWN0IHRvIGF2b2lkCmFkZGluZyB1bm5lY2Vzc2FyeSBjb21wbGV4aXR5LiBJ
ZiBtb3JlIGludGVyZmFjZSB0eXBlcyB3aWxsIGJlIHN1cHBvcnRlZAppbiB0aGUgZnV0dXJlLCB0
aGUgdHlwZSBzcGVjaWZpY3MgbWlnaHQgaGF2ZSB0byBiZSBzcGxpdCBvdXQuCgpSZW5hbWUgZnVu
Y3Rpb25zIHRvIG1hdGNoIHRoZSBuZXcgc3RydWN0IG1pcGlfZGJpX2RldjoKLSBkcm1fdG9fbWlw
aV9kYmkoKSAtPiBkcm1fdG9fbWlwaV9kYmlfZGV2KCkuCi0gbWlwaV9kYmlfaW5pdCooKSAtPiBt
aXBpX2RiaV9kZXZfaW5pdCooKS4KCkNjOiBFcmljIEFuaG9sdCA8ZXJpY0BhbmhvbHQubmV0PgpD
YzogRGF2aWQgTGVjaG5lciA8ZGF2aWRAbGVjaG5vbG9neS5jb20+ClJldmlld2VkLWJ5OiBTYW0g
UmF2bmJvcmcgPHNhbUByYXZuYm9yZy5vcmc+ClNpZ25lZC1vZmYtYnk6IE5vcmFsZiBUcsO4bm5l
cyA8bm9yYWxmQHRyb25uZXMub3JnPgotLS0KIGRyaXZlcnMvZ3B1L2RybS90aW55ZHJtL2h4ODM1
N2QuYyAgfCAgMTAgKy0tCiBkcml2ZXJzL2dwdS9kcm0vdGlueWRybS9pbGk5MjI1LmMgIHwgIDE4
ICsrLS0KIGRyaXZlcnMvZ3B1L2RybS90aW55ZHJtL2lsaTkzNDEuYyAgfCAgMTAgKy0tCiBkcml2
ZXJzL2dwdS9kcm0vdGlueWRybS9taTAyODNxdC5jIHwgIDEwICstLQogZHJpdmVycy9ncHUvZHJt
L3Rpbnlkcm0vbWlwaS1kYmkuYyB8ICA4MyArKysrKysrKysrLS0tLS0tLS0tCiBkcml2ZXJzL2dw
dS9kcm0vdGlueWRybS9zdDc1ODYuYyAgIHwgIDI2ICsrKy0tLQogZHJpdmVycy9ncHUvZHJtL3Rp
bnlkcm0vc3Q3NzM1ci5jICB8ICAxMCArLS0KIGluY2x1ZGUvZHJtL3Rpbnlkcm0vbWlwaS1kYmku
aCAgICAgfCAxMjkgKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0KIDggZmlsZXMgY2hhbmdl
ZCwgMTc1IGluc2VydGlvbnMoKyksIDEyMSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vdGlueWRybS9oeDgzNTdkLmMgYi9kcml2ZXJzL2dwdS9kcm0vdGlueWRybS9o
eDgzNTdkLmMKaW5kZXggZTExM2M0MzRmZjU1Li40NzFlNTQ1MTU0YjMgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS90aW55ZHJtL2h4ODM1N2QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdGlu
eWRybS9oeDgzNTdkLmMKQEAgLTQ3LDggKzQ3LDggQEAgc3RhdGljIHZvaWQgeXgyNDBxdjI5X2Vu
YWJsZShzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCiAJCQkgICAgIHN0cnVj
dCBkcm1fY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCSAgICAgc3RydWN0IGRybV9wbGFuZV9z
dGF0ZSAqcGxhbmVfc3RhdGUpCiB7Ci0Jc3RydWN0IG1pcGlfZGJpICpkYmlkZXYgPSBkcm1fdG9f
bWlwaV9kYmkocGlwZS0+Y3J0Yy5kZXYpOwotCXN0cnVjdCBtaXBpX2RiaSAqZGJpID0gZGJpZGV2
OworCXN0cnVjdCBtaXBpX2RiaV9kZXYgKmRiaWRldiA9IGRybV90b19taXBpX2RiaV9kZXYocGlw
ZS0+Y3J0Yy5kZXYpOworCXN0cnVjdCBtaXBpX2RiaSAqZGJpID0gJmRiaWRldi0+ZGJpOwogCXU4
IGFkZHJfbW9kZTsKIAlpbnQgcmV0LCBpZHg7CiAKQEAgLTIyMCw3ICsyMjAsNyBAQCBNT0RVTEVf
REVWSUNFX1RBQkxFKHNwaSwgaHg4MzU3ZF9pZCk7CiBzdGF0aWMgaW50IGh4ODM1N2RfcHJvYmUo
c3RydWN0IHNwaV9kZXZpY2UgKnNwaSkKIHsKIAlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmc3BpLT5k
ZXY7Ci0Jc3RydWN0IG1pcGlfZGJpICpkYmlkZXY7CisJc3RydWN0IG1pcGlfZGJpX2RldiAqZGJp
ZGV2OwogCXN0cnVjdCBkcm1fZGV2aWNlICpkcm07CiAJc3RydWN0IGdwaW9fZGVzYyAqZGM7CiAJ
dTMyIHJvdGF0aW9uID0gMDsKQEAgLTI1MSwxMSArMjUxLDExIEBAIHN0YXRpYyBpbnQgaHg4MzU3
ZF9wcm9iZShzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpKQogCiAJZGV2aWNlX3Byb3BlcnR5X3JlYWRf
dTMyKGRldiwgInJvdGF0aW9uIiwgJnJvdGF0aW9uKTsKIAotCXJldCA9IG1pcGlfZGJpX3NwaV9p
bml0KHNwaSwgZGJpZGV2LCBkYyk7CisJcmV0ID0gbWlwaV9kYmlfc3BpX2luaXQoc3BpLCAmZGJp
ZGV2LT5kYmksIGRjKTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCi0JcmV0ID0gbWlwaV9k
YmlfaW5pdChkYmlkZXYsICZoeDgzNTdkX3BpcGVfZnVuY3MsICZ5eDM1MGh2MTVfbW9kZSwgcm90
YXRpb24pOworCXJldCA9IG1pcGlfZGJpX2Rldl9pbml0KGRiaWRldiwgJmh4ODM1N2RfcGlwZV9m
dW5jcywgJnl4MzUwaHYxNV9tb2RlLCByb3RhdGlvbik7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJl
dDsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Rpbnlkcm0vaWxpOTIyNS5jIGIvZHJp
dmVycy9ncHUvZHJtL3Rpbnlkcm0vaWxpOTIyNS5jCmluZGV4IDIwOWE3NWRhYjdjZS4uMzM3NjZm
YzIxYjJiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdGlueWRybS9pbGk5MjI1LmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL3Rpbnlkcm0vaWxpOTIyNS5jCkBAIC03OCwxMCArNzgsMTAgQEAg
c3RhdGljIGlubGluZSBpbnQgaWxpOTIyNV9jb21tYW5kKHN0cnVjdCBtaXBpX2RiaSAqZGJpLCB1
OCBjbWQsIHUxNiBkYXRhKQogc3RhdGljIHZvaWQgaWxpOTIyNV9mYl9kaXJ0eShzdHJ1Y3QgZHJt
X2ZyYW1lYnVmZmVyICpmYiwgc3RydWN0IGRybV9yZWN0ICpyZWN0KQogewogCXN0cnVjdCBkcm1f
Z2VtX2NtYV9vYmplY3QgKmNtYV9vYmogPSBkcm1fZmJfY21hX2dldF9nZW1fb2JqKGZiLCAwKTsK
LQlzdHJ1Y3QgbWlwaV9kYmkgKmRiaWRldiA9IGRybV90b19taXBpX2RiaShmYi0+ZGV2KTsKKwlz
dHJ1Y3QgbWlwaV9kYmlfZGV2ICpkYmlkZXYgPSBkcm1fdG9fbWlwaV9kYmlfZGV2KGZiLT5kZXYp
OwogCXVuc2lnbmVkIGludCBoZWlnaHQgPSByZWN0LT55MiAtIHJlY3QtPnkxOwogCXVuc2lnbmVk
IGludCB3aWR0aCA9IHJlY3QtPngyIC0gcmVjdC0+eDE7Ci0Jc3RydWN0IG1pcGlfZGJpICpkYmkg
PSBkYmlkZXY7CisJc3RydWN0IG1pcGlfZGJpICpkYmkgPSAmZGJpZGV2LT5kYmk7CiAJYm9vbCBz
d2FwID0gZGJpLT5zd2FwX2J5dGVzOwogCXUxNiB4X3N0YXJ0LCB5X3N0YXJ0OwogCXUxNiB4MSwg
eDIsIHkxLCB5MjsKQEAgLTE4MywxMCArMTgzLDEwIEBAIHN0YXRpYyB2b2lkIGlsaTkyMjVfcGlw
ZV9lbmFibGUoc3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBlLAogCQkJCXN0cnVj
dCBkcm1fY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCQlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRl
ICpwbGFuZV9zdGF0ZSkKIHsKLQlzdHJ1Y3QgbWlwaV9kYmkgKmRiaWRldiA9IGRybV90b19taXBp
X2RiaShwaXBlLT5jcnRjLmRldik7CisJc3RydWN0IG1pcGlfZGJpX2RldiAqZGJpZGV2ID0gZHJt
X3RvX21pcGlfZGJpX2RldihwaXBlLT5jcnRjLmRldik7CiAJc3RydWN0IGRybV9mcmFtZWJ1ZmZl
ciAqZmIgPSBwbGFuZV9zdGF0ZS0+ZmI7CiAJc3RydWN0IGRldmljZSAqZGV2ID0gcGlwZS0+Y3J0
Yy5kZXYtPmRldjsKLQlzdHJ1Y3QgbWlwaV9kYmkgKmRiaSA9IGRiaWRldjsKKwlzdHJ1Y3QgbWlw
aV9kYmkgKmRiaSA9ICZkYmlkZXYtPmRiaTsKIAlzdHJ1Y3QgZHJtX3JlY3QgcmVjdCA9IHsKIAkJ
LngxID0gMCwKIAkJLngyID0gZmItPndpZHRoLApAQCAtMjkxLDggKzI5MSw4IEBAIHN0YXRpYyB2
b2lkIGlsaTkyMjVfcGlwZV9lbmFibGUoc3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpw
aXBlLAogCiBzdGF0aWMgdm9pZCBpbGk5MjI1X3BpcGVfZGlzYWJsZShzdHJ1Y3QgZHJtX3NpbXBs
ZV9kaXNwbGF5X3BpcGUgKnBpcGUpCiB7Ci0Jc3RydWN0IG1pcGlfZGJpICpkYmlkZXYgPSBkcm1f
dG9fbWlwaV9kYmkocGlwZS0+Y3J0Yy5kZXYpOwotCXN0cnVjdCBtaXBpX2RiaSAqZGJpID0gZGJp
ZGV2OworCXN0cnVjdCBtaXBpX2RiaV9kZXYgKmRiaWRldiA9IGRybV90b19taXBpX2RiaV9kZXYo
cGlwZS0+Y3J0Yy5kZXYpOworCXN0cnVjdCBtaXBpX2RiaSAqZGJpID0gJmRiaWRldi0+ZGJpOwog
CiAJRFJNX0RFQlVHX0tNUygiXG4iKTsKIApAQCAtMzc4LDcgKzM3OCw3IEBAIE1PRFVMRV9ERVZJ
Q0VfVEFCTEUoc3BpLCBpbGk5MjI1X2lkKTsKIHN0YXRpYyBpbnQgaWxpOTIyNV9wcm9iZShzdHJ1
Y3Qgc3BpX2RldmljZSAqc3BpKQogewogCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZzcGktPmRldjsK
LQlzdHJ1Y3QgbWlwaV9kYmkgKmRiaWRldjsKKwlzdHJ1Y3QgbWlwaV9kYmlfZGV2ICpkYmlkZXY7
CiAJc3RydWN0IGRybV9kZXZpY2UgKmRybTsKIAlzdHJ1Y3QgbWlwaV9kYmkgKmRiaTsKIAlzdHJ1
Y3QgZ3Bpb19kZXNjICpyczsKQEAgLTM4OSw3ICszODksNyBAQCBzdGF0aWMgaW50IGlsaTkyMjVf
cHJvYmUoc3RydWN0IHNwaV9kZXZpY2UgKnNwaSkKIAlpZiAoIWRiaWRldikKIAkJcmV0dXJuIC1F
Tk9NRU07CiAKLQlkYmkgPSBkYmlkZXY7CisJZGJpID0gJmRiaWRldi0+ZGJpOwogCWRybSA9ICZk
YmlkZXYtPmRybTsKIAlyZXQgPSBkZXZtX2RybV9kZXZfaW5pdChkZXYsIGRybSwgJmlsaTkyMjVf
ZHJpdmVyKTsKIAlpZiAocmV0KSB7CkBAIC00MjAsNyArNDIwLDcgQEAgc3RhdGljIGludCBpbGk5
MjI1X3Byb2JlKHN0cnVjdCBzcGlfZGV2aWNlICpzcGkpCiAJLyogb3ZlcnJpZGUgdGhlIGNvbW1h
bmQgZnVuY3Rpb24gc2V0IGluICBtaXBpX2RiaV9zcGlfaW5pdCgpICovCiAJZGJpLT5jb21tYW5k
ID0gaWxpOTIyNV9kYmlfY29tbWFuZDsKIAotCXJldCA9IG1pcGlfZGJpX2luaXQoZGJpZGV2LCAm
aWxpOTIyNV9waXBlX2Z1bmNzLCAmaWxpOTIyNV9tb2RlLCByb3RhdGlvbik7CisJcmV0ID0gbWlw
aV9kYmlfZGV2X2luaXQoZGJpZGV2LCAmaWxpOTIyNV9waXBlX2Z1bmNzLCAmaWxpOTIyNV9tb2Rl
LCByb3RhdGlvbik7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL3Rpbnlkcm0vaWxpOTM0MS5jIGIvZHJpdmVycy9ncHUvZHJtL3Rpbnlkcm0v
aWxpOTM0MS5jCmluZGV4IGRmYThjNmU5NTJjOC4uNzFhZjI3NTUyMmE1IDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vdGlueWRybS9pbGk5MzQxLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3Rp
bnlkcm0vaWxpOTM0MS5jCkBAIC01Myw4ICs1Myw4IEBAIHN0YXRpYyB2b2lkIHl4MjQwcXYyOV9l
bmFibGUoc3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBlLAogCQkJICAgICBzdHJ1
Y3QgZHJtX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCQkgICAgIHN0cnVjdCBkcm1fcGxhbmVf
c3RhdGUgKnBsYW5lX3N0YXRlKQogewotCXN0cnVjdCBtaXBpX2RiaSAqZGJpZGV2ID0gZHJtX3Rv
X21pcGlfZGJpKHBpcGUtPmNydGMuZGV2KTsKLQlzdHJ1Y3QgbWlwaV9kYmkgKmRiaSA9IGRiaWRl
djsKKwlzdHJ1Y3QgbWlwaV9kYmlfZGV2ICpkYmlkZXYgPSBkcm1fdG9fbWlwaV9kYmlfZGV2KHBp
cGUtPmNydGMuZGV2KTsKKwlzdHJ1Y3QgbWlwaV9kYmkgKmRiaSA9ICZkYmlkZXYtPmRiaTsKIAl1
OCBhZGRyX21vZGU7CiAJaW50IHJldCwgaWR4OwogCkBAIC0xNzYsNyArMTc2LDcgQEAgTU9EVUxF
X0RFVklDRV9UQUJMRShzcGksIGlsaTkzNDFfaWQpOwogc3RhdGljIGludCBpbGk5MzQxX3Byb2Jl
KHN0cnVjdCBzcGlfZGV2aWNlICpzcGkpCiB7CiAJc3RydWN0IGRldmljZSAqZGV2ID0gJnNwaS0+
ZGV2OwotCXN0cnVjdCBtaXBpX2RiaSAqZGJpZGV2OworCXN0cnVjdCBtaXBpX2RiaV9kZXYgKmRi
aWRldjsKIAlzdHJ1Y3QgZHJtX2RldmljZSAqZHJtOwogCXN0cnVjdCBtaXBpX2RiaSAqZGJpOwog
CXN0cnVjdCBncGlvX2Rlc2MgKmRjOwpAQCAtMTg3LDcgKzE4Nyw3IEBAIHN0YXRpYyBpbnQgaWxp
OTM0MV9wcm9iZShzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpKQogCWlmICghZGJpZGV2KQogCQlyZXR1
cm4gLUVOT01FTTsKIAotCWRiaSA9IGRiaWRldjsKKwlkYmkgPSAmZGJpZGV2LT5kYmk7CiAJZHJt
ID0gJmRiaWRldi0+ZHJtOwogCXJldCA9IGRldm1fZHJtX2Rldl9pbml0KGRldiwgZHJtLCAmaWxp
OTM0MV9kcml2ZXIpOwogCWlmIChyZXQpIHsKQEAgLTIxOSw3ICsyMTksNyBAQCBzdGF0aWMgaW50
IGlsaTkzNDFfcHJvYmUoc3RydWN0IHNwaV9kZXZpY2UgKnNwaSkKIAlpZiAocmV0KQogCQlyZXR1
cm4gcmV0OwogCi0JcmV0ID0gbWlwaV9kYmlfaW5pdChkYmlkZXYsICZpbGk5MzQxX3BpcGVfZnVu
Y3MsICZ5eDI0MHF2MjlfbW9kZSwgcm90YXRpb24pOworCXJldCA9IG1pcGlfZGJpX2Rldl9pbml0
KGRiaWRldiwgJmlsaTkzNDFfcGlwZV9mdW5jcywgJnl4MjQwcXYyOV9tb2RlLCByb3RhdGlvbik7
CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L3Rpbnlkcm0vbWkwMjgzcXQuYyBiL2RyaXZlcnMvZ3B1L2RybS90aW55ZHJtL21pMDI4M3F0LmMK
aW5kZXggOWQyODRmYjI0YzM2Li43OTI1ZjY5YmM1MDIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS90aW55ZHJtL21pMDI4M3F0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3Rpbnlkcm0vbWkw
MjgzcXQuYwpAQCAtNTEsOCArNTEsOCBAQCBzdGF0aWMgdm9pZCBtaTAyODNxdF9lbmFibGUoc3Ry
dWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBlLAogCQkJICAgIHN0cnVjdCBkcm1fY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCSAgICBzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpwbGFu
ZV9zdGF0ZSkKIHsKLQlzdHJ1Y3QgbWlwaV9kYmkgKmRiaWRldiA9IGRybV90b19taXBpX2RiaShw
aXBlLT5jcnRjLmRldik7Ci0Jc3RydWN0IG1pcGlfZGJpICpkYmkgPSBkYmlkZXY7CisJc3RydWN0
IG1pcGlfZGJpX2RldiAqZGJpZGV2ID0gZHJtX3RvX21pcGlfZGJpX2RldihwaXBlLT5jcnRjLmRl
dik7CisJc3RydWN0IG1pcGlfZGJpICpkYmkgPSAmZGJpZGV2LT5kYmk7CiAJdTggYWRkcl9tb2Rl
OwogCWludCByZXQsIGlkeDsKIApAQCAtMTgwLDcgKzE4MCw3IEBAIE1PRFVMRV9ERVZJQ0VfVEFC
TEUoc3BpLCBtaTAyODNxdF9pZCk7CiBzdGF0aWMgaW50IG1pMDI4M3F0X3Byb2JlKHN0cnVjdCBz
cGlfZGV2aWNlICpzcGkpCiB7CiAJc3RydWN0IGRldmljZSAqZGV2ID0gJnNwaS0+ZGV2OwotCXN0
cnVjdCBtaXBpX2RiaSAqZGJpZGV2OworCXN0cnVjdCBtaXBpX2RiaV9kZXYgKmRiaWRldjsKIAlz
dHJ1Y3QgZHJtX2RldmljZSAqZHJtOwogCXN0cnVjdCBtaXBpX2RiaSAqZGJpOwogCXN0cnVjdCBn
cGlvX2Rlc2MgKmRjOwpAQCAtMTkxLDcgKzE5MSw3IEBAIHN0YXRpYyBpbnQgbWkwMjgzcXRfcHJv
YmUoc3RydWN0IHNwaV9kZXZpY2UgKnNwaSkKIAlpZiAoIWRiaWRldikKIAkJcmV0dXJuIC1FTk9N
RU07CiAKLQlkYmkgPSBkYmlkZXY7CisJZGJpID0gJmRiaWRldi0+ZGJpOwogCWRybSA9ICZkYmlk
ZXYtPmRybTsKIAlyZXQgPSBkZXZtX2RybV9kZXZfaW5pdChkZXYsIGRybSwgJm1pMDI4M3F0X2Ry
aXZlcik7CiAJaWYgKHJldCkgewpAQCAtMjI3LDcgKzIyNyw3IEBAIHN0YXRpYyBpbnQgbWkwMjgz
cXRfcHJvYmUoc3RydWN0IHNwaV9kZXZpY2UgKnNwaSkKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0
OwogCi0JcmV0ID0gbWlwaV9kYmlfaW5pdChkYmlkZXYsICZtaTAyODNxdF9waXBlX2Z1bmNzLCAm
bWkwMjgzcXRfbW9kZSwgcm90YXRpb24pOworCXJldCA9IG1pcGlfZGJpX2Rldl9pbml0KGRiaWRl
diwgJm1pMDI4M3F0X3BpcGVfZnVuY3MsICZtaTAyODNxdF9tb2RlLCByb3RhdGlvbik7CiAJaWYg
KHJldCkKIAkJcmV0dXJuIHJldDsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Rpbnlk
cm0vbWlwaS1kYmkuYyBiL2RyaXZlcnMvZ3B1L2RybS90aW55ZHJtL21pcGktZGJpLmMKaW5kZXgg
OTViMDMyYTRiMzRiLi4xNjE3Nzg0ZmVmMDkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS90
aW55ZHJtL21pcGktZGJpLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3Rpbnlkcm0vbWlwaS1kYmku
YwpAQCAtMjQxLDEwICsyNDEsMTAgQEAgRVhQT1JUX1NZTUJPTChtaXBpX2RiaV9idWZfY29weSk7
CiBzdGF0aWMgdm9pZCBtaXBpX2RiaV9mYl9kaXJ0eShzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpm
Yiwgc3RydWN0IGRybV9yZWN0ICpyZWN0KQogewogCXN0cnVjdCBkcm1fZ2VtX2NtYV9vYmplY3Qg
KmNtYV9vYmogPSBkcm1fZmJfY21hX2dldF9nZW1fb2JqKGZiLCAwKTsKLQlzdHJ1Y3QgbWlwaV9k
YmkgKmRiaWRldiA9IGRybV90b19taXBpX2RiaShmYi0+ZGV2KTsKKwlzdHJ1Y3QgbWlwaV9kYmlf
ZGV2ICpkYmlkZXYgPSBkcm1fdG9fbWlwaV9kYmlfZGV2KGZiLT5kZXYpOwogCXVuc2lnbmVkIGlu
dCBoZWlnaHQgPSByZWN0LT55MiAtIHJlY3QtPnkxOwogCXVuc2lnbmVkIGludCB3aWR0aCA9IHJl
Y3QtPngyIC0gcmVjdC0+eDE7Ci0Jc3RydWN0IG1pcGlfZGJpICpkYmkgPSBkYmlkZXY7CisJc3Ry
dWN0IG1pcGlfZGJpICpkYmkgPSAmZGJpZGV2LT5kYmk7CiAJYm9vbCBzd2FwID0gZGJpLT5zd2Fw
X2J5dGVzOwogCWludCBpZHgsIHJldCA9IDA7CiAJYm9vbCBmdWxsOwpAQCAtMzI3LDcgKzMyNyw3
IEBAIEVYUE9SVF9TWU1CT0wobWlwaV9kYmlfcGlwZV91cGRhdGUpOwogICogZnJhbWVidWZmZXIg
Zmx1c2hpbmcsIGNhbid0IHVzZSB0aGlzIGZ1bmN0aW9uIHNpbmNlIHRoZXkgYm90aCB1c2UgdGhl
IHNhbWUKICAqIGZsdXNoaW5nIGNvZGUuCiAgKi8KLXZvaWQgbWlwaV9kYmlfZW5hYmxlX2ZsdXNo
KHN0cnVjdCBtaXBpX2RiaSAqZGJpZGV2LAordm9pZCBtaXBpX2RiaV9lbmFibGVfZmx1c2goc3Ry
dWN0IG1pcGlfZGJpX2RldiAqZGJpZGV2LAogCQkJICAgc3RydWN0IGRybV9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAogCQkJICAgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCiB7
CkBAIC0zNTEsMTMgKzM1MSwxMyBAQCB2b2lkIG1pcGlfZGJpX2VuYWJsZV9mbHVzaChzdHJ1Y3Qg
bWlwaV9kYmkgKmRiaWRldiwKIH0KIEVYUE9SVF9TWU1CT0wobWlwaV9kYmlfZW5hYmxlX2ZsdXNo
KTsKIAotc3RhdGljIHZvaWQgbWlwaV9kYmlfYmxhbmsoc3RydWN0IG1pcGlfZGJpICpkYmlkZXYp
CitzdGF0aWMgdm9pZCBtaXBpX2RiaV9ibGFuayhzdHJ1Y3QgbWlwaV9kYmlfZGV2ICpkYmlkZXYp
CiB7CiAJc3RydWN0IGRybV9kZXZpY2UgKmRybSA9ICZkYmlkZXYtPmRybTsKIAl1MTYgaGVpZ2h0
ID0gZHJtLT5tb2RlX2NvbmZpZy5taW5faGVpZ2h0OwogCXUxNiB3aWR0aCA9IGRybS0+bW9kZV9j
b25maWcubWluX3dpZHRoOworCXN0cnVjdCBtaXBpX2RiaSAqZGJpID0gJmRiaWRldi0+ZGJpOwog
CXNpemVfdCBsZW4gPSB3aWR0aCAqIGhlaWdodCAqIDI7Ci0Jc3RydWN0IG1pcGlfZGJpICpkYmkg
PSBkYmlkZXY7CiAJaW50IGlkeDsKIAogCWlmICghZHJtX2Rldl9lbnRlcihkcm0sICZpZHgpKQpA
QCAtMzg1LDcgKzM4NSw3IEBAIHN0YXRpYyB2b2lkIG1pcGlfZGJpX2JsYW5rKHN0cnVjdCBtaXBp
X2RiaSAqZGJpZGV2KQogICovCiB2b2lkIG1pcGlfZGJpX3BpcGVfZGlzYWJsZShzdHJ1Y3QgZHJt
X3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUpCiB7Ci0Jc3RydWN0IG1pcGlfZGJpICpkYmlkZXYg
PSBkcm1fdG9fbWlwaV9kYmkocGlwZS0+Y3J0Yy5kZXYpOworCXN0cnVjdCBtaXBpX2RiaV9kZXYg
KmRiaWRldiA9IGRybV90b19taXBpX2RiaV9kZXYocGlwZS0+Y3J0Yy5kZXYpOwogCiAJaWYgKCFk
YmlkZXYtPmVuYWJsZWQpCiAJCXJldHVybjsKQEAgLTQwNiw3ICs0MDYsNyBAQCBFWFBPUlRfU1lN
Qk9MKG1pcGlfZGJpX3BpcGVfZGlzYWJsZSk7CiAKIHN0YXRpYyBpbnQgbWlwaV9kYmlfY29ubmVj
dG9yX2dldF9tb2RlcyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQogewotCXN0cnVj
dCBtaXBpX2RiaSAqZGJpZGV2ID0gZHJtX3RvX21pcGlfZGJpKGNvbm5lY3Rvci0+ZGV2KTsKKwlz
dHJ1Y3QgbWlwaV9kYmlfZGV2ICpkYmlkZXYgPSBkcm1fdG9fbWlwaV9kYmlfZGV2KGNvbm5lY3Rv
ci0+ZGV2KTsKIAlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZTsKIAogCW1vZGUgPSBkcm1f
bW9kZV9kdXBsaWNhdGUoY29ubmVjdG9yLT5kZXYsICZkYmlkZXYtPm1vZGUpOwpAQCAtNDcwLDcg
KzQ3MCw3IEBAIHN0YXRpYyBjb25zdCB1aW50MzJfdCBtaXBpX2RiaV9mb3JtYXRzW10gPSB7CiB9
OwogCiAvKioKLSAqIG1pcGlfZGJpX2luaXRfd2l0aF9mb3JtYXRzIC0gTUlQSSBEQkkgaW5pdGlh
bGl6YXRpb24gd2l0aCBjdXN0b20gZm9ybWF0cworICogbWlwaV9kYmlfZGV2X2luaXRfd2l0aF9m
b3JtYXRzIC0gTUlQSSBEQkkgZGV2aWNlIGluaXRpYWxpemF0aW9uIHdpdGggY3VzdG9tIGZvcm1h
dHMKICAqIEBkYmlkZXY6IE1JUEkgREJJIGRldmljZSBzdHJ1Y3R1cmUgdG8gaW5pdGlhbGl6ZQog
ICogQGZ1bmNzOiBEaXNwbGF5IHBpcGUgZnVuY3Rpb25zCiAgKiBAZm9ybWF0czogQXJyYXkgb2Yg
c3VwcG9ydGVkIGZvcm1hdHMgKERSTV9GT1JNQVRcX1wqKS4KQEAgLTQ4Myw3ICs0ODMsNyBAQCBz
dGF0aWMgY29uc3QgdWludDMyX3QgbWlwaV9kYmlfZm9ybWF0c1tdID0gewogICogaGFzIG9uZSBm
aXhlZCAmZHJtX2Rpc3BsYXlfbW9kZSB3aGljaCBpcyByb3RhdGVkIGFjY29yZGluZyB0byBAcm90
YXRpb24uCiAgKiBUaGlzIG1vZGUgaXMgdXNlZCB0byBzZXQgdGhlIG1vZGUgY29uZmlnIG1pbi9t
YXggd2lkdGgvaGVpZ2h0IHByb3BlcnRpZXMuCiAgKgotICogVXNlIG1pcGlfZGJpX2luaXQoKSBp
ZiB5b3UgZG9uJ3QgbmVlZCBjdXN0b20gZm9ybWF0cy4KKyAqIFVzZSBtaXBpX2RiaV9kZXZfaW5p
dCgpIGlmIHlvdSBkb24ndCBuZWVkIGN1c3RvbSBmb3JtYXRzLgogICoKICAqIE5vdGU6CiAgKiBT
b21lIG9mIHRoZSBoZWxwZXIgZnVuY3Rpb25zIGV4cGVjdHMgUkdCNTY1IHRvIGJlIHRoZSBkZWZh
dWx0IGZvcm1hdCBhbmQgdGhlCkBAIC00OTIsMTEgKzQ5MiwxMSBAQCBzdGF0aWMgY29uc3QgdWlu
dDMyX3QgbWlwaV9kYmlfZm9ybWF0c1tdID0gewogICogUmV0dXJuczoKICAqIFplcm8gb24gc3Vj
Y2VzcywgbmVnYXRpdmUgZXJyb3IgY29kZSBvbiBmYWlsdXJlLgogICovCi1pbnQgbWlwaV9kYmlf
aW5pdF93aXRoX2Zvcm1hdHMoc3RydWN0IG1pcGlfZGJpICpkYmlkZXYsCi0JCQkgICAgICAgY29u
c3Qgc3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlX2Z1bmNzICpmdW5jcywKLQkJCSAgICAg
ICBjb25zdCB1aW50MzJfdCAqZm9ybWF0cywgdW5zaWduZWQgaW50IGZvcm1hdF9jb3VudCwKLQkJ
CSAgICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSwKLQkJCSAgICAgICB1
bnNpZ25lZCBpbnQgcm90YXRpb24sIHNpemVfdCB0eF9idWZfc2l6ZSkKK2ludCBtaXBpX2RiaV9k
ZXZfaW5pdF93aXRoX2Zvcm1hdHMoc3RydWN0IG1pcGlfZGJpX2RldiAqZGJpZGV2LAorCQkJCSAg
IGNvbnN0IHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlwZV9mdW5jcyAqZnVuY3MsCisJCQkJ
ICAgY29uc3QgdWludDMyX3QgKmZvcm1hdHMsIHVuc2lnbmVkIGludCBmb3JtYXRfY291bnQsCisJ
CQkJICAgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUsCisJCQkJICAgdW5zaWdu
ZWQgaW50IHJvdGF0aW9uLCBzaXplX3QgdHhfYnVmX3NpemUpCiB7CiAJc3RhdGljIGNvbnN0IHVp
bnQ2NF90IG1vZGlmaWVyc1tdID0gewogCQlEUk1fRk9STUFUX01PRF9MSU5FQVIsCkBAIC01MDUs
NyArNTA1LDcgQEAgaW50IG1pcGlfZGJpX2luaXRfd2l0aF9mb3JtYXRzKHN0cnVjdCBtaXBpX2Ri
aSAqZGJpZGV2LAogCXN0cnVjdCBkcm1fZGV2aWNlICpkcm0gPSAmZGJpZGV2LT5kcm07CiAJaW50
IHJldDsKIAotCWlmICghZGJpZGV2LT5jb21tYW5kKQorCWlmICghZGJpZGV2LT5kYmkuY29tbWFu
ZCkKIAkJcmV0dXJuIC1FSU5WQUw7CiAKIAlkYmlkZXYtPnR4X2J1ZiA9IGRldm1fa21hbGxvYyhk
cm0tPmRldiwgdHhfYnVmX3NpemUsIEdGUF9LRVJORUwpOwpAQCAtNTQzLDEwICs1NDMsMTAgQEAg
aW50IG1pcGlfZGJpX2luaXRfd2l0aF9mb3JtYXRzKHN0cnVjdCBtaXBpX2RiaSAqZGJpZGV2LAog
CiAJcmV0dXJuIDA7CiB9Ci1FWFBPUlRfU1lNQk9MKG1pcGlfZGJpX2luaXRfd2l0aF9mb3JtYXRz
KTsKK0VYUE9SVF9TWU1CT0wobWlwaV9kYmlfZGV2X2luaXRfd2l0aF9mb3JtYXRzKTsKIAogLyoq
Ci0gKiBtaXBpX2RiaV9pbml0IC0gTUlQSSBEQkkgaW5pdGlhbGl6YXRpb24KKyAqIG1pcGlfZGJp
X2Rldl9pbml0IC0gTUlQSSBEQkkgZGV2aWNlIGluaXRpYWxpemF0aW9uCiAgKiBAZGJpZGV2OiBN
SVBJIERCSSBkZXZpY2Ugc3RydWN0dXJlIHRvIGluaXRpYWxpemUKICAqIEBmdW5jczogRGlzcGxh
eSBwaXBlIGZ1bmN0aW9ucwogICogQG1vZGU6IERpc3BsYXkgbW9kZQpAQCAtNTYyLDE5ICs1NjIs
MTkgQEAgRVhQT1JUX1NZTUJPTChtaXBpX2RiaV9pbml0X3dpdGhfZm9ybWF0cyk7CiAgKiBSZXR1
cm5zOgogICogWmVybyBvbiBzdWNjZXNzLCBuZWdhdGl2ZSBlcnJvciBjb2RlIG9uIGZhaWx1cmUu
CiAgKi8KLWludCBtaXBpX2RiaV9pbml0KHN0cnVjdCBtaXBpX2RiaSAqZGJpZGV2LAotCQkgIGNv
bnN0IHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlwZV9mdW5jcyAqZnVuY3MsCi0JCSAgY29u
c3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUsIHVuc2lnbmVkIGludCByb3RhdGlvbikK
K2ludCBtaXBpX2RiaV9kZXZfaW5pdChzdHJ1Y3QgbWlwaV9kYmlfZGV2ICpkYmlkZXYsCisJCSAg
ICAgIGNvbnN0IHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlwZV9mdW5jcyAqZnVuY3MsCisJ
CSAgICAgIGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlLCB1bnNpZ25lZCBpbnQg
cm90YXRpb24pCiB7CiAJc2l6ZV90IGJ1ZnNpemUgPSBtb2RlLT52ZGlzcGxheSAqIG1vZGUtPmhk
aXNwbGF5ICogc2l6ZW9mKHUxNik7CiAKIAlkYmlkZXYtPmRybS5tb2RlX2NvbmZpZy5wcmVmZXJy
ZWRfZGVwdGggPSAxNjsKIAotCXJldHVybiBtaXBpX2RiaV9pbml0X3dpdGhfZm9ybWF0cyhkYmlk
ZXYsIGZ1bmNzLCBtaXBpX2RiaV9mb3JtYXRzLAotCQkJCQkgIEFSUkFZX1NJWkUobWlwaV9kYmlf
Zm9ybWF0cyksIG1vZGUsCi0JCQkJCSAgcm90YXRpb24sIGJ1ZnNpemUpOworCXJldHVybiBtaXBp
X2RiaV9kZXZfaW5pdF93aXRoX2Zvcm1hdHMoZGJpZGV2LCBmdW5jcywgbWlwaV9kYmlfZm9ybWF0
cywKKwkJCQkJICAgICAgQVJSQVlfU0laRShtaXBpX2RiaV9mb3JtYXRzKSwgbW9kZSwKKwkJCQkJ
ICAgICAgcm90YXRpb24sIGJ1ZnNpemUpOwogfQotRVhQT1JUX1NZTUJPTChtaXBpX2RiaV9pbml0
KTsKK0VYUE9SVF9TWU1CT0wobWlwaV9kYmlfZGV2X2luaXQpOwogCiAvKioKICAqIG1pcGlfZGJp
X3JlbGVhc2UgLSBEUk0gZHJpdmVyIHJlbGVhc2UgaGVscGVyCkBAIC01ODYsMTMgKzU4NiwxMyBA
QCBFWFBPUlRfU1lNQk9MKG1pcGlfZGJpX2luaXQpOwogICovCiB2b2lkIG1pcGlfZGJpX3JlbGVh
c2Uoc3RydWN0IGRybV9kZXZpY2UgKmRybSkKIHsKLQlzdHJ1Y3QgbWlwaV9kYmkgKmRiaSA9IGRy
bV90b19taXBpX2RiaShkcm0pOworCXN0cnVjdCBtaXBpX2RiaV9kZXYgKmRiaWRldiA9IGRybV90
b19taXBpX2RiaV9kZXYoZHJtKTsKIAogCURSTV9ERUJVR19EUklWRVIoIlxuIik7CiAKIAlkcm1f
bW9kZV9jb25maWdfY2xlYW51cChkcm0pOwogCWRybV9kZXZfZmluaShkcm0pOwotCWtmcmVlKGRi
aSk7CisJa2ZyZWUoZGJpZGV2KTsKIH0KIEVYUE9SVF9TWU1CT0wobWlwaV9kYmlfcmVsZWFzZSk7
CiAKQEAgLTY0NiwxMCArNjQ2LDEwIEBAIGJvb2wgbWlwaV9kYmlfZGlzcGxheV9pc19vbihzdHJ1
Y3QgbWlwaV9kYmkgKmRiaSkKIH0KIEVYUE9SVF9TWU1CT0wobWlwaV9kYmlfZGlzcGxheV9pc19v
bik7CiAKLXN0YXRpYyBpbnQgbWlwaV9kYmlfcG93ZXJvbl9yZXNldF9jb25kaXRpb25hbChzdHJ1
Y3QgbWlwaV9kYmkgKmRiaWRldiwgYm9vbCBjb25kKQorc3RhdGljIGludCBtaXBpX2RiaV9wb3dl
cm9uX3Jlc2V0X2NvbmRpdGlvbmFsKHN0cnVjdCBtaXBpX2RiaV9kZXYgKmRiaWRldiwgYm9vbCBj
b25kKQogewogCXN0cnVjdCBkZXZpY2UgKmRldiA9IGRiaWRldi0+ZHJtLmRldjsKLQlzdHJ1Y3Qg
bWlwaV9kYmkgKmRiaSA9IGRiaWRldjsKKwlzdHJ1Y3QgbWlwaV9kYmkgKmRiaSA9ICZkYmlkZXYt
PmRiaTsKIAlpbnQgcmV0OwogCiAJaWYgKGRiaWRldi0+cmVndWxhdG9yKSB7CkBAIC02OTUsNyAr
Njk1LDcgQEAgc3RhdGljIGludCBtaXBpX2RiaV9wb3dlcm9uX3Jlc2V0X2NvbmRpdGlvbmFsKHN0
cnVjdCBtaXBpX2RiaSAqZGJpZGV2LCBib29sIGNvbmQKICAqIFJldHVybnM6CiAgKiBaZXJvIG9u
IHN1Y2Nlc3MsIG9yIGEgbmVnYXRpdmUgZXJyb3IgY29kZS4KICAqLwotaW50IG1pcGlfZGJpX3Bv
d2Vyb25fcmVzZXQoc3RydWN0IG1pcGlfZGJpICpkYmlkZXYpCitpbnQgbWlwaV9kYmlfcG93ZXJv
bl9yZXNldChzdHJ1Y3QgbWlwaV9kYmlfZGV2ICpkYmlkZXYpCiB7CiAJcmV0dXJuIG1pcGlfZGJp
X3Bvd2Vyb25fcmVzZXRfY29uZGl0aW9uYWwoZGJpZGV2LCBmYWxzZSk7CiB9CkBAIC03MTMsNyAr
NzEzLDcgQEAgRVhQT1JUX1NZTUJPTChtaXBpX2RiaV9wb3dlcm9uX3Jlc2V0KTsKICAqIFplcm8g
aWYgdGhlIGNvbnRyb2xsZXIgd2FzIHJlc2V0LCAxIGlmIHRoZSBkaXNwbGF5IHdhcyBhbHJlYWR5
IG9uLCBvciBhCiAgKiBuZWdhdGl2ZSBlcnJvciBjb2RlLgogICovCi1pbnQgbWlwaV9kYmlfcG93
ZXJvbl9jb25kaXRpb25hbF9yZXNldChzdHJ1Y3QgbWlwaV9kYmkgKmRiaWRldikKK2ludCBtaXBp
X2RiaV9wb3dlcm9uX2NvbmRpdGlvbmFsX3Jlc2V0KHN0cnVjdCBtaXBpX2RiaV9kZXYgKmRiaWRl
dikKIHsKIAlyZXR1cm4gbWlwaV9kYmlfcG93ZXJvbl9yZXNldF9jb25kaXRpb25hbChkYmlkZXYs
IHRydWUpOwogfQpAQCAtMTA2Niw3ICsxMDY2LDcgQEAgc3RhdGljIGludCBtaXBpX2RiaV90eXBl
YzNfY29tbWFuZChzdHJ1Y3QgbWlwaV9kYmkgKmRiaSwgdTggKmNtZCwKICAqIEBkYzogRC9DIGdw
aW8gKG9wdGlvbmFsKQogICoKICAqIFRoaXMgZnVuY3Rpb24gc2V0cyAmbWlwaV9kYmktPmNvbW1h
bmQsIGVuYWJsZXMgJm1pcGlfZGJpLT5yZWFkX2NvbW1hbmRzIGZvciB0aGUKLSAqIHVzdWFsIHJl
YWQgY29tbWFuZHMuIEl0IHNob3VsZCBiZSBmb2xsb3dlZCBieSBhIGNhbGwgdG8gbWlwaV9kYmlf
aW5pdCgpIG9yCisgKiB1c3VhbCByZWFkIGNvbW1hbmRzLiBJdCBzaG91bGQgYmUgZm9sbG93ZWQg
YnkgYSBjYWxsIHRvIG1pcGlfZGJpX2Rldl9pbml0KCkgb3IKICAqIGEgZHJpdmVyLXNwZWNpZmlj
IGluaXQuCiAgKgogICogSWYgQGRjIGlzIHNldCwgYSBUeXBlIEMgT3B0aW9uIDMgaW50ZXJmYWNl
IGlzIGFzc3VtZWQsIGlmIG5vdApAQCAtMTE4MywxMyArMTE4MywxMyBAQCBzdGF0aWMgc3NpemVf
dCBtaXBpX2RiaV9kZWJ1Z2ZzX2NvbW1hbmRfd3JpdGUoc3RydWN0IGZpbGUgKmZpbGUsCiAJCQkJ
CSAgICAgIHNpemVfdCBjb3VudCwgbG9mZl90ICpwcG9zKQogewogCXN0cnVjdCBzZXFfZmlsZSAq
bSA9IGZpbGUtPnByaXZhdGVfZGF0YTsKLQlzdHJ1Y3QgbWlwaV9kYmkgKm1pcGkgPSBtLT5wcml2
YXRlOworCXN0cnVjdCBtaXBpX2RiaV9kZXYgKmRiaWRldiA9IG0tPnByaXZhdGU7CiAJdTggdmFs
LCBjbWQgPSAwLCBwYXJhbWV0ZXJzWzY0XTsKIAljaGFyICpidWYsICpwb3MsICp0b2tlbjsKIAl1
bnNpZ25lZCBpbnQgaTsKIAlpbnQgcmV0LCBpZHg7CiAKLQlpZiAoIWRybV9kZXZfZW50ZXIoJm1p
cGktPmRybSwgJmlkeCkpCisJaWYgKCFkcm1fZGV2X2VudGVyKCZkYmlkZXYtPmRybSwgJmlkeCkp
CiAJCXJldHVybiAtRU5PREVWOwogCiAJYnVmID0gbWVtZHVwX3VzZXJfbnVsKHVidWYsIGNvdW50
KTsKQEAgLTEyMjgsNyArMTIyOCw3IEBAIHN0YXRpYyBzc2l6ZV90IG1pcGlfZGJpX2RlYnVnZnNf
Y29tbWFuZF93cml0ZShzdHJ1Y3QgZmlsZSAqZmlsZSwKIAkJfQogCX0KIAotCXJldCA9IG1pcGlf
ZGJpX2NvbW1hbmRfYnVmKG1pcGksIGNtZCwgcGFyYW1ldGVycywgaSk7CisJcmV0ID0gbWlwaV9k
YmlfY29tbWFuZF9idWYoJmRiaWRldi0+ZGJpLCBjbWQsIHBhcmFtZXRlcnMsIGkpOwogCiBlcnJf
ZnJlZToKIAlrZnJlZShidWYpOwpAQCAtMTI0MCwxNiArMTI0MCwxNyBAQCBzdGF0aWMgc3NpemVf
dCBtaXBpX2RiaV9kZWJ1Z2ZzX2NvbW1hbmRfd3JpdGUoc3RydWN0IGZpbGUgKmZpbGUsCiAKIHN0
YXRpYyBpbnQgbWlwaV9kYmlfZGVidWdmc19jb21tYW5kX3Nob3coc3RydWN0IHNlcV9maWxlICpt
LCB2b2lkICp1bnVzZWQpCiB7Ci0Jc3RydWN0IG1pcGlfZGJpICptaXBpID0gbS0+cHJpdmF0ZTsK
KwlzdHJ1Y3QgbWlwaV9kYmlfZGV2ICpkYmlkZXYgPSBtLT5wcml2YXRlOworCXN0cnVjdCBtaXBp
X2RiaSAqZGJpID0gJmRiaWRldi0+ZGJpOwogCXU4IGNtZCwgdmFsWzRdOwogCWludCByZXQsIGlk
eDsKIAlzaXplX3QgbGVuOwogCi0JaWYgKCFkcm1fZGV2X2VudGVyKCZtaXBpLT5kcm0sICZpZHgp
KQorCWlmICghZHJtX2Rldl9lbnRlcigmZGJpZGV2LT5kcm0sICZpZHgpKQogCQlyZXR1cm4gLUVO
T0RFVjsKIAogCWZvciAoY21kID0gMDsgY21kIDwgMjU1OyBjbWQrKykgewotCQlpZiAoIW1pcGlf
ZGJpX2NvbW1hbmRfaXNfcmVhZChtaXBpLCBjbWQpKQorCQlpZiAoIW1pcGlfZGJpX2NvbW1hbmRf
aXNfcmVhZChkYmksIGNtZCkpCiAJCQljb250aW51ZTsKIAogCQlzd2l0Y2ggKGNtZCkgewpAQCAt
MTI2OSw3ICsxMjcwLDcgQEAgc3RhdGljIGludCBtaXBpX2RiaV9kZWJ1Z2ZzX2NvbW1hbmRfc2hv
dyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKIAkJfQogCiAJCXNlcV9wcmludGYo
bSwgIiUwMng6ICIsIGNtZCk7Ci0JCXJldCA9IG1pcGlfZGJpX2NvbW1hbmRfYnVmKG1pcGksIGNt
ZCwgdmFsLCBsZW4pOworCQlyZXQgPSBtaXBpX2RiaV9jb21tYW5kX2J1ZihkYmksIGNtZCwgdmFs
LCBsZW4pOwogCQlpZiAocmV0KSB7CiAJCQlzZXFfcHV0cyhtLCAiWFhcbiIpOwogCQkJY29udGlu
dWU7CkBAIC0xMzExLDEyICsxMzEyLDEyIEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVy
YXRpb25zIG1pcGlfZGJpX2RlYnVnZnNfY29tbWFuZF9mb3BzID0gewogICovCiBpbnQgbWlwaV9k
YmlfZGVidWdmc19pbml0KHN0cnVjdCBkcm1fbWlub3IgKm1pbm9yKQogewotCXN0cnVjdCBtaXBp
X2RiaSAqbWlwaSA9IGRybV90b19taXBpX2RiaShtaW5vci0+ZGV2KTsKKwlzdHJ1Y3QgbWlwaV9k
YmlfZGV2ICpkYmlkZXYgPSBkcm1fdG9fbWlwaV9kYmlfZGV2KG1pbm9yLT5kZXYpOwogCXVtb2Rl
X3QgbW9kZSA9IFNfSUZSRUcgfCBTX0lXVVNSOwogCi0JaWYgKG1pcGktPnJlYWRfY29tbWFuZHMp
CisJaWYgKGRiaWRldi0+ZGJpLnJlYWRfY29tbWFuZHMpCiAJCW1vZGUgfD0gU19JUlVHTzsKLQlk
ZWJ1Z2ZzX2NyZWF0ZV9maWxlKCJjb21tYW5kIiwgbW9kZSwgbWlub3ItPmRlYnVnZnNfcm9vdCwg
bWlwaSwKKwlkZWJ1Z2ZzX2NyZWF0ZV9maWxlKCJjb21tYW5kIiwgbW9kZSwgbWlub3ItPmRlYnVn
ZnNfcm9vdCwgZGJpZGV2LAogCQkJICAgICZtaXBpX2RiaV9kZWJ1Z2ZzX2NvbW1hbmRfZm9wcyk7
CiAKIAlyZXR1cm4gMDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90aW55ZHJtL3N0NzU4
Ni5jIGIvZHJpdmVycy9ncHUvZHJtL3Rpbnlkcm0vc3Q3NTg2LmMKaW5kZXggY2YwZDdhMjYwMDlj
Li41MTg3MWVlMTZlZjYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS90aW55ZHJtL3N0NzU4
Ni5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90aW55ZHJtL3N0NzU4Ni5jCkBAIC0xMTQsOCArMTE0
LDggQEAgc3RhdGljIGludCBzdDc1ODZfYnVmX2NvcHkodm9pZCAqZHN0LCBzdHJ1Y3QgZHJtX2Zy
YW1lYnVmZmVyICpmYiwKIAogc3RhdGljIHZvaWQgc3Q3NTg2X2ZiX2RpcnR5KHN0cnVjdCBkcm1f
ZnJhbWVidWZmZXIgKmZiLCBzdHJ1Y3QgZHJtX3JlY3QgKnJlY3QpCiB7Ci0Jc3RydWN0IG1pcGlf
ZGJpICpkYmlkZXYgPSBkcm1fdG9fbWlwaV9kYmkoZmItPmRldik7Ci0Jc3RydWN0IG1pcGlfZGJp
ICpkYmkgPSBkYmlkZXY7CisJc3RydWN0IG1pcGlfZGJpX2RldiAqZGJpZGV2ID0gZHJtX3RvX21p
cGlfZGJpX2RldihmYi0+ZGV2KTsKKwlzdHJ1Y3QgbWlwaV9kYmkgKmRiaSA9ICZkYmlkZXYtPmRi
aTsKIAlpbnQgc3RhcnQsIGVuZCwgaWR4LCByZXQgPSAwOwogCiAJaWYgKCFkYmlkZXYtPmVuYWJs
ZWQpCkBAIC0xNzcsOSArMTc3LDkgQEAgc3RhdGljIHZvaWQgc3Q3NTg2X3BpcGVfZW5hYmxlKHN0
cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlwZSAqcGlwZSwKIAkJCSAgICAgICBzdHJ1Y3QgZHJt
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCQkgICAgICAgc3RydWN0IGRybV9wbGFuZV9zdGF0
ZSAqcGxhbmVfc3RhdGUpCiB7Ci0Jc3RydWN0IG1pcGlfZGJpICpkYmlkZXYgPSBkcm1fdG9fbWlw
aV9kYmkocGlwZS0+Y3J0Yy5kZXYpOworCXN0cnVjdCBtaXBpX2RiaV9kZXYgKmRiaWRldiA9IGRy
bV90b19taXBpX2RiaV9kZXYocGlwZS0+Y3J0Yy5kZXYpOwogCXN0cnVjdCBkcm1fZnJhbWVidWZm
ZXIgKmZiID0gcGxhbmVfc3RhdGUtPmZiOwotCXN0cnVjdCBtaXBpX2RiaSAqZGJpID0gZGJpZGV2
OworCXN0cnVjdCBtaXBpX2RiaSAqZGJpID0gJmRiaWRldi0+ZGJpOwogCXN0cnVjdCBkcm1fcmVj
dCByZWN0ID0gewogCQkueDEgPSAwLAogCQkueDIgPSBmYi0+d2lkdGgsCkBAIC0yNTUsNyArMjU1
LDcgQEAgc3RhdGljIHZvaWQgc3Q3NTg2X3BpcGVfZW5hYmxlKHN0cnVjdCBkcm1fc2ltcGxlX2Rp
c3BsYXlfcGlwZSAqcGlwZSwKIAogc3RhdGljIHZvaWQgc3Q3NTg2X3BpcGVfZGlzYWJsZShzdHJ1
Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUpCiB7Ci0Jc3RydWN0IG1pcGlfZGJpICpt
aXBpID0gZHJtX3RvX21pcGlfZGJpKHBpcGUtPmNydGMuZGV2KTsKKwlzdHJ1Y3QgbWlwaV9kYmlf
ZGV2ICpkYmlkZXYgPSBkcm1fdG9fbWlwaV9kYmlfZGV2KHBpcGUtPmNydGMuZGV2KTsKIAogCS8q
CiAJICogVGhpcyBjYWxsYmFjayBpcyBub3QgcHJvdGVjdGVkIGJ5IGRybV9kZXZfZW50ZXIvZXhp
dCBzaW5jZSB3ZSB3YW50IHRvCkBAIC0yNjYsMTEgKzI2NiwxMSBAQCBzdGF0aWMgdm9pZCBzdDc1
ODZfcGlwZV9kaXNhYmxlKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlwZSAqcGlwZSkKIAog
CURSTV9ERUJVR19LTVMoIlxuIik7CiAKLQlpZiAoIW1pcGktPmVuYWJsZWQpCisJaWYgKCFkYmlk
ZXYtPmVuYWJsZWQpCiAJCXJldHVybjsKIAotCW1pcGlfZGJpX2NvbW1hbmQobWlwaSwgTUlQSV9E
Q1NfU0VUX0RJU1BMQVlfT0ZGKTsKLQltaXBpLT5lbmFibGVkID0gZmFsc2U7CisJbWlwaV9kYmlf
Y29tbWFuZCgmZGJpZGV2LT5kYmksIE1JUElfRENTX1NFVF9ESVNQTEFZX09GRik7CisJZGJpZGV2
LT5lbmFibGVkID0gZmFsc2U7CiB9CiAKIHN0YXRpYyBjb25zdCB1MzIgc3Q3NTg2X2Zvcm1hdHNb
XSA9IHsKQEAgLTMxOCw3ICszMTgsNyBAQCBNT0RVTEVfREVWSUNFX1RBQkxFKHNwaSwgc3Q3NTg2
X2lkKTsKIHN0YXRpYyBpbnQgc3Q3NTg2X3Byb2JlKHN0cnVjdCBzcGlfZGV2aWNlICpzcGkpCiB7
CiAJc3RydWN0IGRldmljZSAqZGV2ID0gJnNwaS0+ZGV2OwotCXN0cnVjdCBtaXBpX2RiaSAqZGJp
ZGV2OworCXN0cnVjdCBtaXBpX2RiaV9kZXYgKmRiaWRldjsKIAlzdHJ1Y3QgZHJtX2RldmljZSAq
ZHJtOwogCXN0cnVjdCBtaXBpX2RiaSAqZGJpOwogCXN0cnVjdCBncGlvX2Rlc2MgKmEwOwpAQCAt
MzMwLDcgKzMzMCw3IEBAIHN0YXRpYyBpbnQgc3Q3NTg2X3Byb2JlKHN0cnVjdCBzcGlfZGV2aWNl
ICpzcGkpCiAJaWYgKCFkYmlkZXYpCiAJCXJldHVybiAtRU5PTUVNOwogCi0JZGJpID0gZGJpZGV2
OworCWRiaSA9ICZkYmlkZXYtPmRiaTsKIAlkcm0gPSAmZGJpZGV2LT5kcm07CiAJcmV0ID0gZGV2
bV9kcm1fZGV2X2luaXQoZGV2LCBkcm0sICZzdDc1ODZfZHJpdmVyKTsKIAlpZiAocmV0KSB7CkBA
IC0zNjMsOSArMzYzLDkgQEAgc3RhdGljIGludCBzdDc1ODZfcHJvYmUoc3RydWN0IHNwaV9kZXZp
Y2UgKnNwaSkKIAkvKiBDYW5ub3QgcmVhZCBmcm9tIHRoaXMgY29udHJvbGxlciB2aWEgU1BJICov
CiAJZGJpLT5yZWFkX2NvbW1hbmRzID0gTlVMTDsKIAotCXJldCA9IG1pcGlfZGJpX2luaXRfd2l0
aF9mb3JtYXRzKGRiaWRldiwgJnN0NzU4Nl9waXBlX2Z1bmNzLAotCQkJCQkgc3Q3NTg2X2Zvcm1h
dHMsIEFSUkFZX1NJWkUoc3Q3NTg2X2Zvcm1hdHMpLAotCQkJCQkgJnN0NzU4Nl9tb2RlLCByb3Rh
dGlvbiwgYnVmc2l6ZSk7CisJcmV0ID0gbWlwaV9kYmlfZGV2X2luaXRfd2l0aF9mb3JtYXRzKGRi
aWRldiwgJnN0NzU4Nl9waXBlX2Z1bmNzLAorCQkJCQkgICAgIHN0NzU4Nl9mb3JtYXRzLCBBUlJB
WV9TSVpFKHN0NzU4Nl9mb3JtYXRzKSwKKwkJCQkJICAgICAmc3Q3NTg2X21vZGUsIHJvdGF0aW9u
LCBidWZzaXplKTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vdGlueWRybS9zdDc3MzVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vdGlueWRybS9z
dDc3MzVyLmMKaW5kZXggNWIyMzY1NzY1OWM2Li42NjI3NWVmM2E0NTYgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS90aW55ZHJtL3N0NzczNXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdGlu
eWRybS9zdDc3MzVyLmMKQEAgLTQyLDggKzQyLDggQEAgc3RhdGljIHZvaWQgamRfdDE4MDAzX3Qw
MV9waXBlX2VuYWJsZShzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCiAJCQkJ
ICAgICAgc3RydWN0IGRybV9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCQkJCSAgICAgIHN0cnVj
dCBkcm1fcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQogewotCXN0cnVjdCBtaXBpX2RiaSAqZGJp
ZGV2ID0gZHJtX3RvX21pcGlfZGJpKHBpcGUtPmNydGMuZGV2KTsKLQlzdHJ1Y3QgbWlwaV9kYmkg
KmRiaSA9IGRiaWRldjsKKwlzdHJ1Y3QgbWlwaV9kYmlfZGV2ICpkYmlkZXYgPSBkcm1fdG9fbWlw
aV9kYmlfZGV2KHBpcGUtPmNydGMuZGV2KTsKKwlzdHJ1Y3QgbWlwaV9kYmkgKmRiaSA9ICZkYmlk
ZXYtPmRiaTsKIAlpbnQgcmV0LCBpZHg7CiAJdTggYWRkcl9tb2RlOwogCkBAIC0xNTAsNyArMTUw
LDcgQEAgTU9EVUxFX0RFVklDRV9UQUJMRShzcGksIHN0NzczNXJfaWQpOwogc3RhdGljIGludCBz
dDc3MzVyX3Byb2JlKHN0cnVjdCBzcGlfZGV2aWNlICpzcGkpCiB7CiAJc3RydWN0IGRldmljZSAq
ZGV2ID0gJnNwaS0+ZGV2OwotCXN0cnVjdCBtaXBpX2RiaSAqZGJpZGV2OworCXN0cnVjdCBtaXBp
X2RiaV9kZXYgKmRiaWRldjsKIAlzdHJ1Y3QgZHJtX2RldmljZSAqZHJtOwogCXN0cnVjdCBtaXBp
X2RiaSAqZGJpOwogCXN0cnVjdCBncGlvX2Rlc2MgKmRjOwpAQCAtMTYxLDcgKzE2MSw3IEBAIHN0
YXRpYyBpbnQgc3Q3NzM1cl9wcm9iZShzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpKQogCWlmICghZGJp
ZGV2KQogCQlyZXR1cm4gLUVOT01FTTsKIAotCWRiaSA9IGRiaWRldjsKKwlkYmkgPSAmZGJpZGV2
LT5kYmk7CiAJZHJtID0gJmRiaWRldi0+ZHJtOwogCXJldCA9IGRldm1fZHJtX2Rldl9pbml0KGRl
diwgZHJtLCAmc3Q3NzM1cl9kcml2ZXIpOwogCWlmIChyZXQpIHsKQEAgLTE5Niw3ICsxOTYsNyBA
QCBzdGF0aWMgaW50IHN0NzczNXJfcHJvYmUoc3RydWN0IHNwaV9kZXZpY2UgKnNwaSkKIAkvKiBD
YW5ub3QgcmVhZCBmcm9tIEFkYWZydWl0IDEuOCIgZGlzcGxheSB2aWEgU1BJICovCiAJZGJpLT5y
ZWFkX2NvbW1hbmRzID0gTlVMTDsKIAotCXJldCA9IG1pcGlfZGJpX2luaXQoZGJpZGV2LCAmamRf
dDE4MDAzX3QwMV9waXBlX2Z1bmNzLCAmamRfdDE4MDAzX3QwMV9tb2RlLCByb3RhdGlvbik7CisJ
cmV0ID0gbWlwaV9kYmlfZGV2X2luaXQoZGJpZGV2LCAmamRfdDE4MDAzX3QwMV9waXBlX2Z1bmNz
LCAmamRfdDE4MDAzX3QwMV9tb2RlLCByb3RhdGlvbik7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJl
dDsKIApkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0vdGlueWRybS9taXBpLWRiaS5oIGIvaW5jbHVk
ZS9kcm0vdGlueWRybS9taXBpLWRiaS5oCmluZGV4IGI3YjMwMTEzMGFmNy4uNjdjNjZmNWVlNTkx
IDEwMDY0NAotLS0gYS9pbmNsdWRlL2RybS90aW55ZHJtL21pcGktZGJpLmgKKysrIGIvaW5jbHVk
ZS9kcm0vdGlueWRybS9taXBpLWRiaS5oCkBAIC0xOCwyNCArMTgsNjIgQEAgc3RydWN0IGdwaW9f
ZGVzYzsKIHN0cnVjdCByZWd1bGF0b3I7CiAKIC8qKgotICogc3RydWN0IG1pcGlfZGJpIC0gTUlQ
SSBEQkkgY29udHJvbGxlcgotICogQHNwaTogU1BJIGRldmljZQotICogQGVuYWJsZWQ6IFBpcGVs
aW5lIGlzIGVuYWJsZWQKLSAqIEBjbWRsb2NrOiBDb21tYW5kIGxvY2sKLSAqIEBjb21tYW5kOiBC
dXMgc3BlY2lmaWMgY2FsbGJhY2sgZXhlY3V0aW5nIGNvbW1hbmRzLgotICogQHJlYWRfY29tbWFu
ZHM6IEFycmF5IG9mIHJlYWQgY29tbWFuZHMgdGVybWluYXRlZCBieSBhIHplcm8gZW50cnkuCi0g
KiAgICAgICAgICAgICAgICAgUmVhZGluZyBpcyBkaXNhYmxlZCBpZiB0aGlzIGlzIE5VTEwuCi0g
KiBAZGM6IE9wdGlvbmFsIEQvQyBncGlvLgotICogQHR4X2J1ZjogQnVmZmVyIHVzZWQgZm9yIHRy
YW5zZmVyIChjb3B5IGNsaXAgcmVjdCBhcmVhKQotICogQHR4X2J1Zjk6IEJ1ZmZlciB1c2VkIGZv
ciBPcHRpb24gMSA5LWJpdCBjb252ZXJzaW9uCi0gKiBAdHhfYnVmOV9sZW46IFNpemUgb2YgdHhf
YnVmOS4KLSAqIEBzd2FwX2J5dGVzOiBTd2FwIGJ5dGVzIGluIGJ1ZmZlciBiZWZvcmUgdHJhbnNm
ZXIKLSAqIEByZXNldDogT3B0aW9uYWwgcmVzZXQgZ3BpbwotICogQHJvdGF0aW9uOiBpbml0aWFs
IHJvdGF0aW9uIGluIGRlZ3JlZXMgQ291bnRlciBDbG9jayBXaXNlCi0gKiBAYmFja2xpZ2h0OiBi
YWNrbGlnaHQgZGV2aWNlIChvcHRpb25hbCkKLSAqIEByZWd1bGF0b3I6IHBvd2VyIHJlZ3VsYXRv
ciAob3B0aW9uYWwpCisgKiBzdHJ1Y3QgbWlwaV9kYmkgLSBNSVBJIERCSSBpbnRlcmZhY2UKICAq
Lwogc3RydWN0IG1pcGlfZGJpIHsKKwkvKioKKwkgKiBAY21kbG9jazogQ29tbWFuZCBsb2NrCisJ
ICovCisJc3RydWN0IG11dGV4IGNtZGxvY2s7CisKKwkvKioKKwkgKiBAY29tbWFuZDogQnVzIHNw
ZWNpZmljIGNhbGxiYWNrIGV4ZWN1dGluZyBjb21tYW5kcy4KKwkgKi8KKwlpbnQgKCpjb21tYW5k
KShzdHJ1Y3QgbWlwaV9kYmkgKmRiaSwgdTggKmNtZCwgdTggKnBhcmFtLCBzaXplX3QgbnVtKTsK
KworCS8qKgorCSAqIEByZWFkX2NvbW1hbmRzOiBBcnJheSBvZiByZWFkIGNvbW1hbmRzIHRlcm1p
bmF0ZWQgYnkgYSB6ZXJvIGVudHJ5LgorCSAqICAgICAgICAgICAgICAgICBSZWFkaW5nIGlzIGRp
c2FibGVkIGlmIHRoaXMgaXMgTlVMTC4KKwkgKi8KKwljb25zdCB1OCAqcmVhZF9jb21tYW5kczsK
KworCS8qKgorCSAqIEBzd2FwX2J5dGVzOiBTd2FwIGJ5dGVzIGluIGJ1ZmZlciBiZWZvcmUgdHJh
bnNmZXIKKwkgKi8KKwlib29sIHN3YXBfYnl0ZXM7CisKKwkvKioKKwkgKiBAcmVzZXQ6IE9wdGlv
bmFsIHJlc2V0IGdwaW8KKwkgKi8KKwlzdHJ1Y3QgZ3Bpb19kZXNjICpyZXNldDsKKworCS8qIFR5
cGUgQyBzcGVjaWZpYyAqLworCisJLyoqCisJICogQHNwaTogU1BJIGRldmljZQorCSAqLworCXN0
cnVjdCBzcGlfZGV2aWNlICpzcGk7CisKKwkvKioKKwkgKiBAZGM6IE9wdGlvbmFsIEQvQyBncGlv
LgorCSAqLworCXN0cnVjdCBncGlvX2Rlc2MgKmRjOworCisJLyoqCisJICogQHR4X2J1Zjk6IEJ1
ZmZlciB1c2VkIGZvciBPcHRpb24gMSA5LWJpdCBjb252ZXJzaW9uCisJICovCisJdm9pZCAqdHhf
YnVmOTsKKworCS8qKgorCSAqIEB0eF9idWY5X2xlbjogU2l6ZSBvZiB0eF9idWY5LgorCSAqLwor
CXNpemVfdCB0eF9idWY5X2xlbjsKK307CisKKy8qKgorICogc3RydWN0IG1pcGlfZGJpX2RldiAt
IE1JUEkgREJJIGRldmljZQorICovCitzdHJ1Y3QgbWlwaV9kYmlfZGV2IHsKIAkvKioKIAkgKiBA
ZHJtOiBEUk0gZGV2aWNlCiAJICovCkBAIC01Niw0OCArOTQsNjMgQEAgc3RydWN0IG1pcGlfZGJp
IHsKIAkgKi8KIAlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSBtb2RlOwogCi0Jc3RydWN0IHNwaV9k
ZXZpY2UgKnNwaTsKKwkvKioKKwkgKiBAZW5hYmxlZDogUGlwZWxpbmUgaXMgZW5hYmxlZAorCSAq
LwogCWJvb2wgZW5hYmxlZDsKLQlzdHJ1Y3QgbXV0ZXggY21kbG9jazsKLQlpbnQgKCpjb21tYW5k
KShzdHJ1Y3QgbWlwaV9kYmkgKmRiaSwgdTggKmNtZCwgdTggKnBhcmFtLCBzaXplX3QgbnVtKTsK
LQljb25zdCB1OCAqcmVhZF9jb21tYW5kczsKLQlzdHJ1Y3QgZ3Bpb19kZXNjICpkYzsKKworCS8q
KgorCSAqIEB0eF9idWY6IEJ1ZmZlciB1c2VkIGZvciB0cmFuc2ZlciAoY29weSBjbGlwIHJlY3Qg
YXJlYSkKKwkgKi8KIAl1MTYgKnR4X2J1ZjsKLQl2b2lkICp0eF9idWY5OwotCXNpemVfdCB0eF9i
dWY5X2xlbjsKLQlib29sIHN3YXBfYnl0ZXM7Ci0Jc3RydWN0IGdwaW9fZGVzYyAqcmVzZXQ7CisK
KwkvKioKKwkgKiBAcm90YXRpb246IGluaXRpYWwgcm90YXRpb24gaW4gZGVncmVlcyBDb3VudGVy
IENsb2NrIFdpc2UKKwkgKi8KIAl1bnNpZ25lZCBpbnQgcm90YXRpb247CisKKwkvKioKKwkgKiBA
YmFja2xpZ2h0OiBiYWNrbGlnaHQgZGV2aWNlIChvcHRpb25hbCkKKwkgKi8KIAlzdHJ1Y3QgYmFj
a2xpZ2h0X2RldmljZSAqYmFja2xpZ2h0OworCisJLyoqCisJICogQHJlZ3VsYXRvcjogcG93ZXIg
cmVndWxhdG9yIChvcHRpb25hbCkKKwkgKi8KIAlzdHJ1Y3QgcmVndWxhdG9yICpyZWd1bGF0b3I7
CisKKwkvKioKKwkgKiBAZGJpOiBNSVBJIERCSSBpbnRlcmZhY2UKKwkgKi8KKwlzdHJ1Y3QgbWlw
aV9kYmkgZGJpOwogfTsKIAotc3RhdGljIGlubGluZSBzdHJ1Y3QgbWlwaV9kYmkgKmRybV90b19t
aXBpX2RiaShzdHJ1Y3QgZHJtX2RldmljZSAqZHJtKQorc3RhdGljIGlubGluZSBzdHJ1Y3QgbWlw
aV9kYmlfZGV2ICpkcm1fdG9fbWlwaV9kYmlfZGV2KHN0cnVjdCBkcm1fZGV2aWNlICpkcm0pCiB7
Ci0JcmV0dXJuIGNvbnRhaW5lcl9vZihkcm0sIHN0cnVjdCBtaXBpX2RiaSwgZHJtKTsKKwlyZXR1
cm4gY29udGFpbmVyX29mKGRybSwgc3RydWN0IG1pcGlfZGJpX2RldiwgZHJtKTsKIH0KIAogaW50
IG1pcGlfZGJpX3NwaV9pbml0KHN0cnVjdCBzcGlfZGV2aWNlICpzcGksIHN0cnVjdCBtaXBpX2Ri
aSAqZGJpLAogCQkgICAgICBzdHJ1Y3QgZ3Bpb19kZXNjICpkYyk7Ci1pbnQgbWlwaV9kYmlfaW5p
dF93aXRoX2Zvcm1hdHMoc3RydWN0IG1pcGlfZGJpICpkYmlkZXYsCi0JCQkgICAgICAgY29uc3Qg
c3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlX2Z1bmNzICpmdW5jcywKLQkJCSAgICAgICBj
b25zdCB1aW50MzJfdCAqZm9ybWF0cywgdW5zaWduZWQgaW50IGZvcm1hdF9jb3VudCwKLQkJCSAg
ICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSwKLQkJCSAgICAgICB1bnNp
Z25lZCBpbnQgcm90YXRpb24sIHNpemVfdCB0eF9idWZfc2l6ZSk7Ci1pbnQgbWlwaV9kYmlfaW5p
dChzdHJ1Y3QgbWlwaV9kYmkgKmRiaWRldiwKLQkJICBjb25zdCBzdHJ1Y3QgZHJtX3NpbXBsZV9k
aXNwbGF5X3BpcGVfZnVuY3MgKmZ1bmNzLAotCQkgIGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9t
b2RlICptb2RlLCB1bnNpZ25lZCBpbnQgcm90YXRpb24pOworaW50IG1pcGlfZGJpX2Rldl9pbml0
X3dpdGhfZm9ybWF0cyhzdHJ1Y3QgbWlwaV9kYmlfZGV2ICpkYmlkZXYsCisJCQkJICAgY29uc3Qg
c3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlX2Z1bmNzICpmdW5jcywKKwkJCQkgICBjb25z
dCB1aW50MzJfdCAqZm9ybWF0cywgdW5zaWduZWQgaW50IGZvcm1hdF9jb3VudCwKKwkJCQkgICBj
b25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSwKKwkJCQkgICB1bnNpZ25lZCBpbnQg
cm90YXRpb24sIHNpemVfdCB0eF9idWZfc2l6ZSk7CitpbnQgbWlwaV9kYmlfZGV2X2luaXQoc3Ry
dWN0IG1pcGlfZGJpX2RldiAqZGJpZGV2LAorCQkgICAgICBjb25zdCBzdHJ1Y3QgZHJtX3NpbXBs
ZV9kaXNwbGF5X3BpcGVfZnVuY3MgKmZ1bmNzLAorCQkgICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Rp
c3BsYXlfbW9kZSAqbW9kZSwgdW5zaWduZWQgaW50IHJvdGF0aW9uKTsKIHZvaWQgbWlwaV9kYmlf
cmVsZWFzZShzdHJ1Y3QgZHJtX2RldmljZSAqZHJtKTsKIHZvaWQgbWlwaV9kYmlfcGlwZV91cGRh
dGUoc3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBlLAogCQkJICBzdHJ1Y3QgZHJt
X3BsYW5lX3N0YXRlICpvbGRfc3RhdGUpOwotdm9pZCBtaXBpX2RiaV9lbmFibGVfZmx1c2goc3Ry
dWN0IG1pcGlfZGJpICpkYmlkZXYsCit2b2lkIG1pcGlfZGJpX2VuYWJsZV9mbHVzaChzdHJ1Y3Qg
bWlwaV9kYmlfZGV2ICpkYmlkZXYsCiAJCQkgICBzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUsCiAJCQkgICBzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpwbGFuX3N0YXRlKTsKIHZvaWQg
bWlwaV9kYmlfcGlwZV9kaXNhYmxlKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlwZSAqcGlw
ZSk7CiB2b2lkIG1pcGlfZGJpX2h3X3Jlc2V0KHN0cnVjdCBtaXBpX2RiaSAqZGJpKTsKIGJvb2wg
bWlwaV9kYmlfZGlzcGxheV9pc19vbihzdHJ1Y3QgbWlwaV9kYmkgKmRiaSk7Ci1pbnQgbWlwaV9k
YmlfcG93ZXJvbl9yZXNldChzdHJ1Y3QgbWlwaV9kYmkgKmRiaWRldik7Ci1pbnQgbWlwaV9kYmlf
cG93ZXJvbl9jb25kaXRpb25hbF9yZXNldChzdHJ1Y3QgbWlwaV9kYmkgKmRiaWRldik7CitpbnQg
bWlwaV9kYmlfcG93ZXJvbl9yZXNldChzdHJ1Y3QgbWlwaV9kYmlfZGV2ICpkYmlkZXYpOworaW50
IG1pcGlfZGJpX3Bvd2Vyb25fY29uZGl0aW9uYWxfcmVzZXQoc3RydWN0IG1pcGlfZGJpX2RldiAq
ZGJpZGV2KTsKIAogdTMyIG1pcGlfZGJpX3NwaV9jbWRfbWF4X3NwZWVkKHN0cnVjdCBzcGlfZGV2
aWNlICpzcGksIHNpemVfdCBsZW4pOwogaW50IG1pcGlfZGJpX3NwaV90cmFuc2ZlcihzdHJ1Y3Qg
c3BpX2RldmljZSAqc3BpLCB1MzIgc3BlZWRfaHosCi0tIAoyLjIwLjEKCl9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QK
ZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9w
Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
