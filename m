Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id AA9B496936
	for <lists+dri-devel@lfdr.de>; Tue, 20 Aug 2019 21:12:58 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C94206E875;
	Tue, 20 Aug 2019 19:12:38 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from NAM03-BY2-obe.outbound.protection.outlook.com
 (mail-eopbgr780048.outbound.protection.outlook.com [40.107.78.48])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2E11F6E871;
 Tue, 20 Aug 2019 19:12:32 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=CgekKhlEPvMZwPpTQC5ugjDQG9aDYKo2r+vvVydH0lIP9AdhFBOoZKFL/q6V4u9KVKf5sXAW9JBQ/0XGR/60olZTAR7WPt9FE8DamZvurjhnTO10RG+6xq7X6JaFeRJs1WO+hnkyNDi4cAIECuKZle20n0taMoILVUq0wrb43rVt+b4BNMLk4IvxFpAwuwre1bqwz7h1OdqEF761IE2EQcNlOxvwpZvsimFUPOdg+yLuv4gE5XUg+9ikg1r0GnRteWbeSsmRdw7+Ps67xvxPyL7BadQb3wku+wFecfH2Nb1DW6rFnT91tK4PTMp0Sbmado9akwAZN4M/5DB4vx3ZbQ==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=RUEEM2d6WZBmN3Dott5Eu5Hr40MSNGSkPWQ84FFXrgg=;
 b=Ldnd8pkqvzwZAZoGIKG4ngjXyNNFRZfQ6fET8D0hwYUs4xCCv6sARB8AfMKHJu16YvswO1t3MN3YK9U5tJiQdf1IBdBKAafXGqO9kyvCQambapVutOZ11R2ytl/6y6qfuXmkX0uKS7YS1UdMtoE/zF4JF/7zZs643e6VANDzn6VUcvAanxiTnIFcr9MclxGhDrjosXoLAe4pj9X1xSHAd7903wK8hpW9QX4vatDKPSyZt9eZoLqUbtHmcSc/Efnkqyz5DRG/UgGenW6AyyJaE8fSxrbKABfh3RizLudKoLUCTtOsNmICjkBP9zAsKxMRBczoCG+fdF42Tjzk2Ut8nw==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=none (sender ip is
 165.204.84.17) smtp.rcpttodomain=lists.freedesktop.org smtp.mailfrom=amd.com; 
 dmarc=permerror action=none header.from=amd.com; dkim=none (message not
 signed); arc=none
Received: from MWHPR1201CA0010.namprd12.prod.outlook.com
 (2603:10b6:301:4a::20) by SN6PR12MB2719.namprd12.prod.outlook.com
 (2603:10b6:805:70::12) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2178.16; Tue, 20 Aug
 2019 19:12:30 +0000
Received: from BY2NAM03FT012.eop-NAM03.prod.protection.outlook.com
 (2a01:111:f400:7e4a::205) by MWHPR1201CA0010.outlook.office365.com
 (2603:10b6:301:4a::20) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id 15.20.2178.16 via Frontend
 Transport; Tue, 20 Aug 2019 19:12:30 +0000
Received-SPF: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
Received: from SATLEXCHOV01.amd.com (165.204.84.17) by
 BY2NAM03FT012.mail.protection.outlook.com (10.152.84.235) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id
 15.20.2178.16 via Frontend Transport; Tue, 20 Aug 2019 19:12:30 +0000
Received: from localhost.localdomain (10.180.168.240) by SATLEXCHOV01.amd.com
 (10.181.40.71) with Microsoft SMTP Server id 14.3.389.1;
 Tue, 20 Aug 2019 14:12:26 -0500
From: David Francis <David.Francis@amd.com>
To: <dri-devel@lists.freedesktop.org>, <amd-gfx@lists.freedesktop.org>
Subject: [PATCH v2 11/14] drm/amd/display: Validate DSC caps on MST endpoints
Date: Tue, 20 Aug 2019 15:12:00 -0400
Message-ID: <20190820191203.25807-12-David.Francis@amd.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190820191203.25807-1-David.Francis@amd.com>
References: <20190820191203.25807-1-David.Francis@amd.com>
MIME-Version: 1.0
X-EOPAttributedMessage: 0
X-MS-Office365-Filtering-HT: Tenant
X-Forefront-Antispam-Report: CIP:165.204.84.17; IPV:NLI; CTRY:US; EFV:NLI;
 SFV:NSPM;
 SFS:(10009020)(4636009)(136003)(39860400002)(396003)(376002)(346002)(2980300002)(428003)(199004)(189003)(81156014)(50226002)(16586007)(81166006)(316002)(15650500001)(2906002)(450100002)(305945005)(8936002)(47776003)(6666004)(446003)(478600001)(476003)(86362001)(486006)(36756003)(426003)(11346002)(2616005)(70586007)(70206006)(356004)(49486002)(8676002)(4326008)(336012)(53936002)(126002)(50466002)(1076003)(76176011)(54906003)(51416003)(5660300002)(5024004)(14444005)(26005)(110136005)(186003)(48376002);
 DIR:OUT; SFP:1101; SCL:1; SRVR:SN6PR12MB2719; H:SATLEXCHOV01.amd.com; FPR:;
 SPF:None; LANG:en; PTR:InfoDomainNonexistent; A:1; MX:1; 
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: 22900b48-e869-4359-a62f-08d725a25903
X-Microsoft-Antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(5600148)(711020)(4605104)(1401327)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(2017052603328);
 SRVR:SN6PR12MB2719; 
X-MS-TrafficTypeDiagnostic: SN6PR12MB2719:
X-Microsoft-Antispam-PRVS: <SN6PR12MB27196997653A6FB6D29FCF61EFAB0@SN6PR12MB2719.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:8882;
X-Forefront-PRVS: 013568035E
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam-Message-Info: tIGTpnAfUSlpE2YV95mvSrlhIUdWhfXPLQ772Fy0KXoZGjsqwYCjt0hod7g90E4PSCrE8UY3olWipnv1Xla+OHM3Z94UenWRAz+H+EKaVAFfnkb/M1+rYxZ2ALM4vSUaZf3LT2aV2O0x3as3ThTHZB09qAizvzKMOaH3GLwhKpRl0I7C91Miib0JD6lKHFJCquzS85nZXapXqzx/J607Io+WapXRMWTpPL21Lbt1Ot5ceo9oGNdG0wiEUce9p4PbStmiswJDIyZ2U5fSuAJUl9nCMJZx6K778H97OoDJooZEwUldp08IuZIdwk52eWVgk/J5l+lUQSjbIYCHkB6VhXarzEkQHqPJAH55qcrxUXoH/eVN5mUIQ6oIxE86bQ37M+9nC9i5dsDtsmMNuiWsmb7qmHvu/AFE06SzdimXrY4=
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 20 Aug 2019 19:12:30.3004 (UTC)
X-MS-Exchange-CrossTenant-Network-Message-Id: 22900b48-e869-4359-a62f-08d725a25903
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-OriginalAttributedTenantConnectingIp: TenantId=3dd8961f-e488-4e60-8e11-a82d994e183d; Ip=[165.204.84.17];
 Helo=[SATLEXCHOV01.amd.com]
X-MS-Exchange-CrossTenant-FromEntityHeader: HybridOnPrem
X-MS-Exchange-Transport-CrossTenantHeadersStamped: SN6PR12MB2719
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=RUEEM2d6WZBmN3Dott5Eu5Hr40MSNGSkPWQ84FFXrgg=;
 b=gzFkNI9LIsiMILYvKv1AXwruJfs1dGRqByjOrgJtYLw8GeDVg1R0F5TTvGlfolQIoUPs1sQV+DEQmBQjRJvFeBHGa3C5iMSJ0I6URIear0qzFTdoY9vvjvSQpgOdWdc43bV6j2myTgRENcTVCSYh4SYgCP7+bNK39rh2+NamGm4=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is
 165.204.84.17)
 smtp.mailfrom=amd.com; lists.freedesktop.org; dkim=none (message not signed)
 header.d=none;lists.freedesktop.org; dmarc=permerror action=none
 header.from=amd.com;
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: David Francis <David.Francis@amd.com>, Wenjing Liu <Wenjing.Liu@amd.com>,
 Nikola Cornij <Nikola.Cornij@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIGZpcnN0IHN0ZXAgaW4gTVNUIERTQyBpcyBjaGVja2luZyBNU1QgZW5kcG9pbnRzCnRvIHNl
ZSBob3cgRFNDIGNhbiBiZSBlbmFibGVkCgpDYXNlIDE6IERQLXRvLURQIHBlZXIgZGV2aWNlCmlm
IHRoZSBicmFuY2ggaW1tZWRpYXRlbHkgdXBzdHJlYW0gaGFzCiAtIFBEVCA9IERQX1BFRVJfREVW
SUNFX0RQX01TVF9CUkFOQ0hJTkcgKDIpCiAtIERQQ0QgcmV2LiA+PSBEUCAxLjQKIC0gRXhhY3Rs
eSBvbmUgaW5wdXQgYW5kIG9uZSBvdXRwdXQKIC0gVGhlIG91dHB1dCBoYXMgUERUID0gRFBfUEVF
Ul9ERVZJQ0VfU1NUX1NJTksgKDMpCgpJbiB0aGlzIGNhc2UsIERTQyBjb3VsZCBiZSBwb3NzaWJs
ZSBlaXRoZXIgb24gdGhlIGVuZHBvaW50Cm9yIHRoZSBwZWVyIGRldmljZS4gUHJlZmVyIHRoZSBl
bmRwb2ludCwgd2hpY2ggaXMgcG9zc2libGUgaWYKIC0gVGhlIGVuZHBvaW50IGhhcyBEUF9EU0Nf
REVDT01QUkVTU0lPTl9JU19TVVBQT1JURUQgYml0IHNldAogLSBUaGUgZW5kcG9pbnQgaGFzIERQ
X0ZFQ19DQVBBQkxFIGJpdCBzZXQKIC0gVGhlIHBlZXIgZGV2aWNlIGhhcyBEU0NfUEFTU1RIUk9V
R0hfQ0FQQUJJTElUWSBiaXQgc2V0IChmcm9tIERQIHYyLjApCgpPdGhlcndpc2UsIHVzZSB0aGUg
cGVlciBkZXZpY2UKCkNhc2UgMjogRFAtdG8tSERNSSBwZWVyIGRldmljZQpJZiB0aGUgb3V0cHV0
IHBvcnQgaGFzCiAtIFBEVCA9IERQX1BFRVJfREVWSUNFX0RQX0xFR0FDWV9DT05WICg0KQogLSBE
UENEIHJldi4gPj0gRFAgMS40CiAtIExEUFMgPSB0cnVlCiAtIE1DUyA9IGZhbHNlCgpJbiB0aGlz
IGNhc2UsIERTQyBjYW4gb25seSBiZSBhdHRlbXB0ZWQgb24gdGhlIHBlZXIgZGV2aWNlCih0aGUg
b3V0cHV0IHBvcnQpCgpDYXNlIDM6IFZpcnR1YWwgRFAgU2luayAoSW50ZXJuYWwgRGlzcGxheSBQ
YW5lbCkKSWYgdGhlIG91dHB1dCBwb3J0IGhhcwogLSBEUENEIHJldi4gPj0gRFAgMS40CiAtIHBv
cnRfbnVtID49IDgKCkluIHRoaXMgY2FzZSwgRFNDIGNhbiBvbmx5IGJlIGF0dGVtcHRlZCBvbiB0
aGUgcGVlciBkZXZpY2UKKHRoZSBvdXRwdXQgcG9ydCkKCkNhc2UgNDogU3luYXB0aXggV29ya2Fy
b3VuZApJZiB0aGUgb3V0cHV0IGhhcwogLSBsaW5rIERQQ0QgcmV2LiA+PSBEUCAxLjQKIC0gbGlu
ayBicmFuY2hfZGV2X2lkID0gMHg5MENDMjQgKFN5bmFwdGl4KQogLSBUaGVyZSBpcyBleGFjdGx5
IG9uZSBicmFuY2ggZGV2aWNlIGJldHdlZW4gdGhlIGxpbmsgYW5kIG91dHB1dAoKSW4gdGhpcyBj
YXNlLCBEU0MgY2FuIGJlIGF0dGVtcHRlZCwgYnV0IG9ubHkgdXNpbmcgdGhlICpsaW5rKgphdXgg
ZGV2aWNlJ3MgY2Fwcy4gVGhpcyBpcyBhIHF1aXJrLgoKVGVzdCBmb3IgdGhlc2UgY2FzZXMgYXMg
bW9kZXMgYXJlIGVudW1lcmF0ZWQgZm9yIGFuIE1TVCBlbmRwb2ludC4KV2UgY2Fubm90IGRvIHRo
aXMgZHVyaW5nIGxpbmsgYXR0YWNoIGJlY2F1c2UgdGhlIGRjX3Npbmsgb2JqZWN0CndpbGwgbm90
IGhhdmUgYmVlbiBjcmVhdGVkIHlldAoKSWYgbm8gRFNDIGlzIGF0dGVtcHRlZCwgemVybyB0aGUg
RFNDIGNhcHMKCkNjOiBXZW5qaW5nIExpdSA8V2VuamluZy5MaXVAYW1kLmNvbT4KQ2M6IE5pa29s
YSBDb3JuaWogPE5pa29sYS5Db3JuaWpAYW1kLmNvbT4KU2lnbmVkLW9mZi1ieTogRGF2aWQgRnJh
bmNpcyA8RGF2aWQuRnJhbmNpc0BhbWQuY29tPgotLS0KIC4uLi9kaXNwbGF5L2FtZGdwdV9kbS9h
bWRncHVfZG1fbXN0X3R5cGVzLmMgICB8IDEyMyArKysrKysrKysrKysrKysrKy0KIC4uLi9kaXNw
bGF5L2FtZGdwdV9kbS9hbWRncHVfZG1fbXN0X3R5cGVzLmggICB8ICAgMyArCiAyIGZpbGVzIGNo
YW5nZWQsIDEyNSBpbnNlcnRpb25zKCspLCAxIGRlbGV0aW9uKC0pCgpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG1fbXN0X3R5cGVzLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbV9tc3RfdHlw
ZXMuYwppbmRleCAxNjIxOGEyMDJiNTkuLjU4NTcxODQ0ZjZkNSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG1fbXN0X3R5cGVzLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG1fbXN0X3R5
cGVzLmMKQEAgLTI1LDYgKzI1LDcgQEAKIAogI2luY2x1ZGUgPGxpbnV4L3ZlcnNpb24uaD4KICNp
bmNsdWRlIDxkcm0vZHJtX2F0b21pY19oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2RwX21z
dF9oZWxwZXIuaD4KICNpbmNsdWRlICJkbV9zZXJ2aWNlcy5oIgogI2luY2x1ZGUgImFtZGdwdS5o
IgogI2luY2x1ZGUgImFtZGdwdV9kbS5oIgpAQCAtMTg5LDYgKzE5MCwxMjAgQEAgc3RhdGljIGNv
bnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX2Z1bmNzIGRtX2RwX21zdF9jb25uZWN0b3JfZnVuY3Mg
PSB7CiAJLmVhcmx5X3VucmVnaXN0ZXIgPSBhbWRncHVfZG1fbXN0X2Nvbm5lY3Rvcl9lYXJseV91
bnJlZ2lzdGVyLAogfTsKIAorYm9vbCBpc192aXJ0dWFsX2RwY2Qoc3RydWN0IGRybV9kcF9tc3Rf
cG9ydCAqcG9ydCkKK3sKKwlzdHJ1Y3QgZHJtX2RwX21zdF9wb3J0ICpkb3duc3RyZWFtX3BvcnQ7
CisKKwlpZiAoIXBvcnQpCisJCXJldHVybiBmYWxzZTsKKworCWlmIChwb3J0LT5wb3J0X251bSA+
PSA4ICYmCisJCXBvcnQtPmRwY2RfcmV2ID49IERQX0RQQ0RfUkVWXzE0KSB7CisJCS8qIFZpcnR1
YWwgRFAgU2luayAoSW50ZXJuYWwgRGlzcGxheSBQYW5lbCkgKi8KKwkJcmV0dXJuIHRydWU7CisJ
fSBlbHNlIGlmIChwb3J0LT5wZHQgPT0gRFBfUEVFUl9ERVZJQ0VfRFBfTEVHQUNZX0NPTlYgJiYK
KwkJCSFwb3J0LT5tY3MgJiYKKwkJCXBvcnQtPmxkcHMgJiYKKwkJCXBvcnQtPmRwY2RfcmV2ID49
IERQX0RQQ0RfUkVWXzE0KSB7CisJCS8qIERQLXRvLUhETUkgUHJvdG9jb2wgQ29udmVydGVyICov
CisJCXJldHVybiB0cnVlOworCX0gZWxzZSBpZiAocG9ydC0+cGR0ID09IERQX1BFRVJfREVWSUNF
X01TVF9CUkFOQ0hJTkcgJiYKKwkJCXBvcnQtPm1zdGIgJiYKKwkJCXBvcnQtPmRwY2RfcmV2ID49
IERQX0RQQ0RfUkVWXzE0KSB7CisJCS8qIERQLXRvLURQICovCisJCWlmIChwb3J0LT5tc3RiLT5u
dW1fcG9ydHMgPT0gMikgeworCQkJbGlzdF9mb3JfZWFjaF9lbnRyeShkb3duc3RyZWFtX3BvcnQs
ICZwb3J0LT5tc3RiLT5wb3J0cywgbmV4dCkgeworCQkJCWlmICghZG93bnN0cmVhbV9wb3J0LT5p
bnB1dCAmJgorCQkJCQkJZG93bnN0cmVhbV9wb3J0LT5wZHQgPT0gRFBfUEVFUl9ERVZJQ0VfU1NU
X1NJTkspCisJCQkJCXJldHVybiB0cnVlOworCQkJfQorCQl9CisJfQorCXJldHVybiBmYWxzZTsK
K30KKworYm9vbCBzeW5hcHRpeF93b3JrYXJvdW5kKHN0cnVjdCBhbWRncHVfZG1fY29ubmVjdG9y
ICphY29ubmVjdG9yKQoreworCXN0cnVjdCBkcm1fZHBfbXN0X3BvcnQgKnBvcnQgPSBhY29ubmVj
dG9yLT5wb3J0OworCXN0cnVjdCBkY19saW5rICpsaW5rID0gYWNvbm5lY3Rvci0+ZGNfc2luay0+
bGluazsKKwl1OCBkb3duX3N0cmVhbV9wb3J0X2RhdGE7CisKKwlpZiAocG9ydC0+bWdyLT5tc3Rf
cHJpbWFyeSA9PSBwb3J0LT5wYXJlbnQgJiYKKwkJCWxpbmstPmRwY2RfY2Fwcy5icmFuY2hfZGV2
X2lkID09IDB4OTBDQzI0ICYmCisJCQlsaW5rLT5kcGNkX2NhcHMuZHBjZF9yZXYucmF3ID49IERQ
X0RQQ0RfUkVWXzE0KSB7CisJCWRybV9kcF9tc3RfZHBjZF9yZWFkKCZwb3J0LT5hdXgsIERQX0RP
V05TVFJFQU1QT1JUX1BSRVNFTlQsICZkb3duX3N0cmVhbV9wb3J0X2RhdGEsIDEpOworCQlpZiAo
KGRvd25fc3RyZWFtX3BvcnRfZGF0YSAmIDcpICE9IDMpCisJCQlyZXR1cm4gdHJ1ZTsKKwl9CisJ
cmV0dXJuIGZhbHNlOworfQorCisjaWZkZWYgQ09ORklHX0RSTV9BTURfRENfRFNDX1NVUFBPUlQK
K3N0YXRpYyBib29sIHZhbGlkYXRlX2RzY19jYXBzX29uX2Nvbm5lY3RvcihzdHJ1Y3QgYW1kZ3B1
X2RtX2Nvbm5lY3RvciAqYWNvbm5lY3RvcikKK3sKKwl1OCB1cHN0cmVhbV9kc2NfY2Fwc1sxNl0g
PSB7IDAgfTsKKwl1OCBlbmRwb2ludF9kc2NfY2Fwc1sxNl0gPSB7IDAgfTsKKwl1OCBlbmRwb2lu
dF9mZWNfY2FwcyA9IDA7CisJc3RydWN0IGRjX3NpbmsgKmRjX3NpbmsgPSBhY29ubmVjdG9yLT5k
Y19zaW5rOworCXN0cnVjdCBkcm1fZHBfbXN0X3BvcnQgKm91dHB1dF9wb3J0ID0gYWNvbm5lY3Rv
ci0+cG9ydDsKKwlzdHJ1Y3QgZHJtX2RwX21zdF9wb3J0ICppbW1lZGlhdGVfdXBzdHJlYW1fcG9y
dDsKKwlzdHJ1Y3QgZHJtX2RwX21zdF9wb3J0ICpmZWNfcG9ydDsKKworCWlmIChhY29ubmVjdG9y
LT5wb3J0ICYmIGFjb25uZWN0b3ItPnBvcnQtPnBhcmVudCkKKwkJaW1tZWRpYXRlX3Vwc3RyZWFt
X3BvcnQgPSBhY29ubmVjdG9yLT5wb3J0LT5wYXJlbnQtPnBvcnRfcGFyZW50OworCWVsc2UKKwkJ
aW1tZWRpYXRlX3Vwc3RyZWFtX3BvcnQgPSBOVUxMOworCisJZmVjX3BvcnQgPSBpbW1lZGlhdGVf
dXBzdHJlYW1fcG9ydDsKKwl3aGlsZSAoZmVjX3BvcnQpIHsKKwkJaWYgKCFmZWNfcG9ydC0+ZmVj
X2NhcGFibGUpCisJCQlyZXR1cm4gZmFsc2U7CisKKwkJZmVjX3BvcnQgPSBmZWNfcG9ydC0+cGFy
ZW50LT5wb3J0X3BhcmVudDsKKwl9CisKKwlpZiAoaW1tZWRpYXRlX3Vwc3RyZWFtX3BvcnQpCisJ
CWRybV9kcF9tc3RfZHBjZF9yZWFkKCZpbW1lZGlhdGVfdXBzdHJlYW1fcG9ydC0+YXV4LCBEUF9E
U0NfU1VQUE9SVCwgdXBzdHJlYW1fZHNjX2NhcHMsIDE2KTsKKwlkcm1fZHBfbXN0X2RwY2RfcmVh
ZCgmb3V0cHV0X3BvcnQtPmF1eCwgRFBfRFNDX1NVUFBPUlQsIGVuZHBvaW50X2RzY19jYXBzLCAx
Nik7CisJZHJtX2RwX21zdF9kcGNkX3JlYWQoJm91dHB1dF9wb3J0LT5hdXgsIERQX0ZFQ19DQVBB
QklMSVRZLCAmZW5kcG9pbnRfZmVjX2NhcHMsIDEpOworCisJaWYgKGlzX3ZpcnR1YWxfZHBjZChp
bW1lZGlhdGVfdXBzdHJlYW1fcG9ydCkKKwkJCSYmICh1cHN0cmVhbV9kc2NfY2Fwc1swXSAmIDB4
MikgLyogRFNDIHBhc3N0aHJvdWdoIGNhcGFiaWxpdHkgKi8KKwkJCSYmIChlbmRwb2ludF9mZWNf
Y2FwcyAmIERQX0ZFQ19DQVBBQkxFKQorCQkJJiYgKGVuZHBvaW50X2RzY19jYXBzWzBdICYgRFBf
RFNDX0RFQ09NUFJFU1NJT05fSVNfU1VQUE9SVEVEKSkgeworCQkvKiBFbnBvaW50IGRlY29tcHJl
c3Npb24gd2l0aCBEUC10by1EUCBwZWVyIGRldmljZSAqLworCQlpZiAoIWRjX2RzY19wYXJzZV9k
c2NfZHBjZChlbmRwb2ludF9kc2NfY2FwcywgTlVMTCwgJmRjX3NpbmstPnNpbmtfZHNjX2NhcHMu
ZHNjX2RlY19jYXBzKSkKKwkJCXJldHVybiBmYWxzZTsKKworCQlkY19zaW5rLT5zaW5rX2RzY19j
YXBzLmlzX3ZpcnR1YWxfZHBjZF9kc2MgPSBmYWxzZTsKKwl9IGVsc2UgaWYgKGlzX3ZpcnR1YWxf
ZHBjZChpbW1lZGlhdGVfdXBzdHJlYW1fcG9ydCkpIHsKKwkJLyogVmlydHVhbCBEUENEIGRlY29t
cHJlc3Npb24gd2l0aCBEUC10by1EUCBwZWVyIGRldmljZSAqLworCQlpZiAoIWRjX2RzY19wYXJz
ZV9kc2NfZHBjZCh1cHN0cmVhbV9kc2NfY2FwcywgTlVMTCwgJmRjX3NpbmstPnNpbmtfZHNjX2Nh
cHMuZHNjX2RlY19jYXBzKSkKKwkJCXJldHVybiBmYWxzZTsKKworCQlkY19zaW5rLT5zaW5rX2Rz
Y19jYXBzLmlzX3ZpcnR1YWxfZHBjZF9kc2MgPSB0cnVlOworCX0gZWxzZSBpZiAoaXNfdmlydHVh
bF9kcGNkKG91dHB1dF9wb3J0KSkgeworCQkvKiBWaXJ0dWFsIERQQ0QgZGVjb21wcmVzc2lvbiB3
aXRoIERQLXRvLUhETUkgb3IgVmlydHVhbCBEUCBTaW5rICovCisJCWlmICghZGNfZHNjX3BhcnNl
X2RzY19kcGNkKGVuZHBvaW50X2RzY19jYXBzLCBOVUxMLCAmZGNfc2luay0+c2lua19kc2NfY2Fw
cy5kc2NfZGVjX2NhcHMpKQorCQkJcmV0dXJuIGZhbHNlOworCisJCWRjX3NpbmstPnNpbmtfZHNj
X2NhcHMuaXNfdmlydHVhbF9kcGNkX2RzYyA9IHRydWU7CisJfSBlbHNlIGlmIChzeW5hcHRpeF93
b3JrYXJvdW5kKGFjb25uZWN0b3IpKSB7CisJCS8qIFN5bmFwdGl4IHdvcmthcm91bmQgKi8KKwkJ
YWNvbm5lY3RvciA9IGRjX3NpbmstPmxpbmstPnByaXY7CisJCWRybV9kcF9kcGNkX3JlYWQoJmFj
b25uZWN0b3ItPmRtX2RwX2F1eC5hdXgsIERQX0RTQ19TVVBQT1JULCB1cHN0cmVhbV9kc2NfY2Fw
cywgMTYpOworCQlpZiAoIWRjX2RzY19wYXJzZV9kc2NfZHBjZCh1cHN0cmVhbV9kc2NfY2Fwcywg
TlVMTCwgJmRjX3NpbmstPnNpbmtfZHNjX2NhcHMuZHNjX2RlY19jYXBzKSkKKwkJCXJldHVybiBm
YWxzZTsKKworCQlkY19zaW5rLT5zaW5rX2RzY19jYXBzLmlzX3ZpcnR1YWxfZHBjZF9kc2MgPSB0
cnVlOworCX0gZWxzZSB7CisJCXJldHVybiBmYWxzZTsKKwl9CisKKwlyZXR1cm4gdHJ1ZTsKK30K
KyNlbmRpZgorCiBzdGF0aWMgaW50IGRtX2RwX21zdF9nZXRfbW9kZXMoc3RydWN0IGRybV9jb25u
ZWN0b3IgKmNvbm5lY3RvcikKIHsKIAlzdHJ1Y3QgYW1kZ3B1X2RtX2Nvbm5lY3RvciAqYWNvbm5l
Y3RvciA9IHRvX2FtZGdwdV9kbV9jb25uZWN0b3IoY29ubmVjdG9yKTsKQEAgLTIzMSwxMCArMzQ2
LDE2IEBAIHN0YXRpYyBpbnQgZG1fZHBfbXN0X2dldF9tb2RlcyhzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
ciAqY29ubmVjdG9yKQogCQkvKiBkY19saW5rX2FkZF9yZW1vdGVfc2luayByZXR1cm5zIGEgbmV3
IHJlZmVyZW5jZSAqLwogCQlhY29ubmVjdG9yLT5kY19zaW5rID0gZGNfc2luazsKIAotCQlpZiAo
YWNvbm5lY3Rvci0+ZGNfc2luaykKKwkJaWYgKGFjb25uZWN0b3ItPmRjX3NpbmspIHsKIAkJCWFt
ZGdwdV9kbV91cGRhdGVfZnJlZXN5bmNfY2FwcygKIAkJCQkJY29ubmVjdG9yLCBhY29ubmVjdG9y
LT5lZGlkKTsKIAorI2lmZGVmIENPTkZJR19EUk1fQU1EX0RDX0RTQ19TVVBQT1JUCisJCQlpZiAo
IXZhbGlkYXRlX2RzY19jYXBzX29uX2Nvbm5lY3RvcihhY29ubmVjdG9yKSkKKwkJCQltZW1zZXQo
JmFjb25uZWN0b3ItPmRjX3NpbmstPnNpbmtfZHNjX2NhcHMsCisJCQkJICAgICAgIDAsIHNpemVv
ZihhY29ubmVjdG9yLT5kY19zaW5rLT5zaW5rX2RzY19jYXBzKSk7CisjZW5kaWYKKwkJfQogCX0K
IAogCWRybV9jb25uZWN0b3JfdXBkYXRlX2VkaWRfcHJvcGVydHkoCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbV9tc3RfdHlwZXMuaCBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtX21zdF90eXBl
cy5oCmluZGV4IDJkYTg1MWI0MDA0Mi4uOGRlM2Q4YzMwZjhkIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbV9tc3RfdHlwZXMuaAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbV9tc3RfdHlw
ZXMuaApAQCAtMzIsNCArMzIsNyBAQCBzdHJ1Y3QgYW1kZ3B1X2RtX2Nvbm5lY3RvcjsKIHZvaWQg
YW1kZ3B1X2RtX2luaXRpYWxpemVfZHBfY29ubmVjdG9yKHN0cnVjdCBhbWRncHVfZGlzcGxheV9t
YW5hZ2VyICpkbSwKIAkJCQkgICAgICAgc3RydWN0IGFtZGdwdV9kbV9jb25uZWN0b3IgKmFjb25u
ZWN0b3IpOwogCitib29sIGlzX3ZpcnR1YWxfZHBjZChzdHJ1Y3QgZHJtX2RwX21zdF9wb3J0ICpw
b3J0KTsKK2Jvb2wgc3luYXB0aXhfd29ya2Fyb3VuZChzdHJ1Y3QgYW1kZ3B1X2RtX2Nvbm5lY3Rv
ciAqYWNvbm5lY3Rvcik7CisKICNlbmRpZgotLSAKMi4xNy4xCgpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1k
ZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcv
bWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
