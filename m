Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id C4C5ED41C6
	for <lists+dri-devel@lfdr.de>; Fri, 11 Oct 2019 15:48:28 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 973836EC42;
	Fri, 11 Oct 2019 13:48:21 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 036396EC3E
 for <dri-devel@lists.freedesktop.org>; Fri, 11 Oct 2019 13:48:19 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 52247AFE3;
 Fri, 11 Oct 2019 13:48:18 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: hdegoede@redhat.com,
	airlied@linux.ie,
	daniel@ffwll.ch
Subject: [PATCH 1/3] drm/vboxvideo: Switch to generic fbdev emulation
Date: Fri, 11 Oct 2019 15:48:06 +0200
Message-Id: <20191011134808.3955-2-tzimmermann@suse.de>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191011134808.3955-1-tzimmermann@suse.de>
References: <20191011134808.3955-1-tzimmermann@suse.de>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Zimmermann <tzimmermann@suse.de>, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlcmUncyBub3RoaW5nIHNwZWNpYWwgYWJvdXQgdmJveHZpZGVvJ3MgZmJkZXYgZW11bGF0aW9u
IHRoYXQgaXMKbm90IHByb3ZpZGVkIGJ5IHRoZSBnZW5lcmljIGltcGxlbWVudGF0aW9uLiBTd2l0
Y2ggb3ZlciBhbmQgcmVtb3ZlCnRoZSBkcml2ZXIncyBjb2RlLgoKU2lnbmVkLW9mZi1ieTogVGhv
bWFzIFppbW1lcm1hbm4gPHR6aW1tZXJtYW5uQHN1c2UuZGU+Ci0tLQogZHJpdmVycy9ncHUvZHJt
L3Zib3h2aWRlby9NYWtlZmlsZSAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL3Zib3h2aWRl
by92Ym94X2Rydi5jICB8ICAxNCArLS0KIGRyaXZlcnMvZ3B1L2RybS92Ym94dmlkZW8vdmJveF9k
cnYuaCAgfCAgIDcgLS0KIGRyaXZlcnMvZ3B1L2RybS92Ym94dmlkZW8vdmJveF9mYi5jICAgfCAx
NDkgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS92Ym94dmlkZW8v
dmJveF9tb2RlLmMgfCAgIDMgKy0KIDUgZmlsZXMgY2hhbmdlZCwgNiBpbnNlcnRpb25zKCspLCAx
NjkgZGVsZXRpb25zKC0pCiBkZWxldGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL3Zib3h2
aWRlby92Ym94X2ZiLmMKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdmJveHZpZGVvL01h
a2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL3Zib3h2aWRlby9NYWtlZmlsZQppbmRleCA1NWQ3OThj
NzZiMjEuLmYyZTk2OGI1ZmZhNiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Zib3h2aWRl
by9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2dwdS9kcm0vdmJveHZpZGVvL01ha2VmaWxlCkBAIC0x
LDYgKzEsNiBAQAogIyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAogdmJveHZpZGVv
LXkgOj0gIGhnc21pX2Jhc2UubyBtb2Rlc2V0dGluZy5vIHZidmFfYmFzZS5vIFwKLQkJdmJveF9k
cnYubyB2Ym94X2ZiLm8gdmJveF9oZ3NtaS5vIHZib3hfaXJxLm8gdmJveF9tYWluLm8gXAorCQl2
Ym94X2Rydi5vIHZib3hfaGdzbWkubyB2Ym94X2lycS5vIHZib3hfbWFpbi5vIFwKIAkJdmJveF9t
b2RlLm8gdmJveF90dG0ubwogCiBvYmotJChDT05GSUdfRFJNX1ZCT1hWSURFTykgKz0gdmJveHZp
ZGVvLm8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92Ym94dmlkZW8vdmJveF9kcnYuYyBi
L2RyaXZlcnMvZ3B1L2RybS92Ym94dmlkZW8vdmJveF9kcnYuYwppbmRleCA4NjJkYjQ5NWQxMTEu
LjZlZTMwOGI0NTNkYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Zib3h2aWRlby92Ym94
X2Rydi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92Ym94dmlkZW8vdmJveF9kcnYuYwpAQCAtMTQs
NiArMTQsNyBAQAogCiAjaW5jbHVkZSA8ZHJtL2RybV9jcnRjX2hlbHBlci5oPgogI2luY2x1ZGUg
PGRybS9kcm1fZHJ2Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV9mYl9oZWxwZXIuaD4KICNpbmNsdWRl
IDxkcm0vZHJtX2ZpbGUuaD4KICNpbmNsdWRlIDxkcm0vZHJtX2lvY3RsLmg+CiAKQEAgLTMyLDEw
ICszMyw2IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgcGNpX2RldmljZV9pZCBwY2lpZGxpc3RbXSA9
IHsKIH07CiBNT0RVTEVfREVWSUNFX1RBQkxFKHBjaSwgcGNpaWRsaXN0KTsKIAotc3RhdGljIGNv
bnN0IHN0cnVjdCBkcm1fZmJfaGVscGVyX2Z1bmNzIHZib3hfZmJfaGVscGVyX2Z1bmNzID0gewot
CS5mYl9wcm9iZSA9IHZib3hmYl9jcmVhdGUsCi19OwotCiBzdGF0aWMgaW50IHZib3hfcGNpX3By
b2JlKHN0cnVjdCBwY2lfZGV2ICpwZGV2LCBjb25zdCBzdHJ1Y3QgcGNpX2RldmljZV9pZCAqZW50
KQogewogCXN0cnVjdCB2Ym94X3ByaXZhdGUgKnZib3g7CkBAIC03OSwyMCArNzYsMTYgQEAgc3Rh
dGljIGludCB2Ym94X3BjaV9wcm9iZShzdHJ1Y3QgcGNpX2RldiAqcGRldiwgY29uc3Qgc3RydWN0
IHBjaV9kZXZpY2VfaWQgKmVudCkKIAlpZiAocmV0KQogCQlnb3RvIGVycl9tb2RlX2Zpbmk7CiAK
LQlyZXQgPSBkcm1fZmJfaGVscGVyX2ZiZGV2X3NldHVwKCZ2Ym94LT5kZGV2LCAmdmJveC0+ZmJf
aGVscGVyLAotCQkJCQkmdmJveF9mYl9oZWxwZXJfZnVuY3MsIDMyLAotCQkJCQl2Ym94LT5udW1f
Y3J0Y3MpOworCXJldCA9IGRybV9mYmRldl9nZW5lcmljX3NldHVwKCZ2Ym94LT5kZGV2LCAzMik7
CiAJaWYgKHJldCkKIAkJZ290byBlcnJfaXJxX2Zpbmk7CiAKIAlyZXQgPSBkcm1fZGV2X3JlZ2lz
dGVyKCZ2Ym94LT5kZGV2LCAwKTsKIAlpZiAocmV0KQotCQlnb3RvIGVycl9mYmRldl9maW5pOwor
CQlnb3RvIGVycl9pcnFfZmluaTsKIAogCXJldHVybiAwOwogCi1lcnJfZmJkZXZfZmluaToKLQl2
Ym94X2ZiZGV2X2ZpbmkodmJveCk7CiBlcnJfaXJxX2Zpbmk6CiAJdmJveF9pcnFfZmluaSh2Ym94
KTsKIGVycl9tb2RlX2Zpbmk6CkBAIC0xMTMsNyArMTA2LDYgQEAgc3RhdGljIHZvaWQgdmJveF9w
Y2lfcmVtb3ZlKHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogCXN0cnVjdCB2Ym94X3ByaXZhdGUgKnZi
b3ggPSBwY2lfZ2V0X2RydmRhdGEocGRldik7CiAKIAlkcm1fZGV2X3VucmVnaXN0ZXIoJnZib3gt
PmRkZXYpOwotCXZib3hfZmJkZXZfZmluaSh2Ym94KTsKIAl2Ym94X2lycV9maW5pKHZib3gpOwog
CXZib3hfbW9kZV9maW5pKHZib3gpOwogCXZib3hfbW1fZmluaSh2Ym94KTsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS92Ym94dmlkZW8vdmJveF9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS92
Ym94dmlkZW8vdmJveF9kcnYuaAppbmRleCBmYjQzNmVjNzYwZWEuLmJiMGMzOWZlNzkxMSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Zib3h2aWRlby92Ym94X2Rydi5oCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS92Ym94dmlkZW8vdmJveF9kcnYuaApAQCAtMTYsNyArMTYsNiBAQAogI2luY2x1
ZGUgPGxpbnV4L3N0cmluZy5oPgogCiAjaW5jbHVkZSA8ZHJtL2RybV9lbmNvZGVyLmg+Ci0jaW5j
bHVkZSA8ZHJtL2RybV9mYl9oZWxwZXIuaD4KICNpbmNsdWRlIDxkcm0vZHJtX2dlbS5oPgogI2lu
Y2x1ZGUgPGRybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmg+CiAKQEAgLTU0LDggKzUzLDYgQEAgc3Ry
dWN0IHZib3hfZnJhbWVidWZmZXIgewogc3RydWN0IHZib3hfcHJpdmF0ZSB7CiAJLyogTXVzdCBi
ZSBmaXJzdDsgb3Igd2UgbXVzdCBkZWZpbmUgb3VyIG93biByZWxlYXNlIGNhbGxiYWNrICovCiAJ
c3RydWN0IGRybV9kZXZpY2UgZGRldjsKLQlzdHJ1Y3QgZHJtX2ZiX2hlbHBlciBmYl9oZWxwZXI7
Ci0Jc3RydWN0IHZib3hfZnJhbWVidWZmZXIgYWZiOwogCiAJdTggX19pb21lbSAqZ3Vlc3RfaGVh
cDsKIAl1OCBfX2lvbWVtICp2YnZhX2J1ZmZlcnM7CkBAIC0xNTUsMTAgKzE1Miw2IEBAIGludCB2
Ym94X2ZyYW1lYnVmZmVyX2luaXQoc3RydWN0IHZib3hfcHJpdmF0ZSAqdmJveCwKIAkJCSAgY29u
c3Qgc3RydWN0IGRybV9tb2RlX2ZiX2NtZDIgKm1vZGVfY21kLAogCQkJICBzdHJ1Y3QgZHJtX2dl
bV9vYmplY3QgKm9iaik7CiAKLWludCB2Ym94ZmJfY3JlYXRlKHN0cnVjdCBkcm1fZmJfaGVscGVy
ICpoZWxwZXIsCi0JCSAgc3RydWN0IGRybV9mYl9oZWxwZXJfc3VyZmFjZV9zaXplICpzaXplcyk7
Ci12b2lkIHZib3hfZmJkZXZfZmluaShzdHJ1Y3QgdmJveF9wcml2YXRlICp2Ym94KTsKLQogaW50
IHZib3hfbW1faW5pdChzdHJ1Y3QgdmJveF9wcml2YXRlICp2Ym94KTsKIHZvaWQgdmJveF9tbV9m
aW5pKHN0cnVjdCB2Ym94X3ByaXZhdGUgKnZib3gpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vdmJveHZpZGVvL3Zib3hfZmIuYyBiL2RyaXZlcnMvZ3B1L2RybS92Ym94dmlkZW8vdmJv
eF9mYi5jCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCA4Zjc0YmNmZmMwMzQuLjAwMDAw
MDAwMDAwMAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdmJveHZpZGVvL3Zib3hfZmIuYworKysgL2Rl
di9udWxsCkBAIC0xLDE0OSArMCwwIEBACi0vLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlU
Ci0vKgotICogQ29weXJpZ2h0IChDKSAyMDEzLTIwMTcgT3JhY2xlIENvcnBvcmF0aW9uCi0gKiBU
aGlzIGZpbGUgaXMgYmFzZWQgb24gYXN0X2ZiLmMKLSAqIENvcHlyaWdodCAyMDEyIFJlZCBIYXQg
SW5jLgotICogQXV0aG9yczogRGF2ZSBBaXJsaWUgPGFpcmxpZWRAcmVkaGF0LmNvbT4KLSAqICAg
ICAgICAgIE1pY2hhZWwgVGhheWVyIDxtaWNoYWVsLnRoYXllckBvcmFjbGUuY29tLAotICovCi0j
aW5jbHVkZSA8bGludXgvZGVsYXkuaD4KLSNpbmNsdWRlIDxsaW51eC9lcnJuby5oPgotI2luY2x1
ZGUgPGxpbnV4L2ZiLmg+Ci0jaW5jbHVkZSA8bGludXgvaW5pdC5oPgotI2luY2x1ZGUgPGxpbnV4
L2tlcm5lbC5oPgotI2luY2x1ZGUgPGxpbnV4L21tLmg+Ci0jaW5jbHVkZSA8bGludXgvbW9kdWxl
Lmg+Ci0jaW5jbHVkZSA8bGludXgvcGNpLmg+Ci0jaW5jbHVkZSA8bGludXgvc3RyaW5nLmg+Ci0j
aW5jbHVkZSA8bGludXgvc3lzcnEuaD4KLSNpbmNsdWRlIDxsaW51eC90dHkuaD4KLQotI2luY2x1
ZGUgPGRybS9kcm1fY3J0Yy5oPgotI2luY2x1ZGUgPGRybS9kcm1fY3J0Y19oZWxwZXIuaD4KLSNp
bmNsdWRlIDxkcm0vZHJtX2ZiX2hlbHBlci5oPgotI2luY2x1ZGUgPGRybS9kcm1fZm91cmNjLmg+
Ci0KLSNpbmNsdWRlICJ2Ym94X2Rydi5oIgotI2luY2x1ZGUgInZib3h2aWRlby5oIgotCi0jaWZk
ZWYgQ09ORklHX0RSTV9LTVNfRkJfSEVMUEVSCi1zdGF0aWMgc3RydWN0IGZiX2RlZmVycmVkX2lv
IHZib3hfZGVmaW8gPSB7Ci0JLmRlbGF5ID0gSFogLyAzMCwKLQkuZGVmZXJyZWRfaW8gPSBkcm1f
ZmJfaGVscGVyX2RlZmVycmVkX2lvLAotfTsKLSNlbmRpZgotCi1zdGF0aWMgc3RydWN0IGZiX29w
cyB2Ym94ZmJfb3BzID0gewotCS5vd25lciA9IFRISVNfTU9EVUxFLAotCURSTV9GQl9IRUxQRVJf
REVGQVVMVF9PUFMsCi0JLmZiX2ZpbGxyZWN0ID0gZHJtX2ZiX2hlbHBlcl9zeXNfZmlsbHJlY3Qs
Ci0JLmZiX2NvcHlhcmVhID0gZHJtX2ZiX2hlbHBlcl9zeXNfY29weWFyZWEsCi0JLmZiX2ltYWdl
YmxpdCA9IGRybV9mYl9oZWxwZXJfc3lzX2ltYWdlYmxpdCwKLX07Ci0KLWludCB2Ym94ZmJfY3Jl
YXRlKHN0cnVjdCBkcm1fZmJfaGVscGVyICpoZWxwZXIsCi0JCSAgc3RydWN0IGRybV9mYl9oZWxw
ZXJfc3VyZmFjZV9zaXplICpzaXplcykKLXsKLQlzdHJ1Y3QgdmJveF9wcml2YXRlICp2Ym94ID0K
LQkJY29udGFpbmVyX29mKGhlbHBlciwgc3RydWN0IHZib3hfcHJpdmF0ZSwgZmJfaGVscGVyKTsK
LQlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IHZib3gtPmRkZXYucGRldjsKLQlzdHJ1Y3QgZHJtX21v
ZGVfZmJfY21kMiBtb2RlX2NtZDsKLQlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYjsKLQlzdHJ1
Y3QgZmJfaW5mbyAqaW5mbzsKLQlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdvYmo7Ci0Jc3RydWN0
IGRybV9nZW1fdnJhbV9vYmplY3QgKmdibzsKLQlpbnQgc2l6ZSwgcmV0OwotCXM2NCBncHVfYWRk
cjsKLQl1MzIgcGl0Y2g7Ci0KLQltb2RlX2NtZC53aWR0aCA9IHNpemVzLT5zdXJmYWNlX3dpZHRo
OwotCW1vZGVfY21kLmhlaWdodCA9IHNpemVzLT5zdXJmYWNlX2hlaWdodDsKLQlwaXRjaCA9IG1v
ZGVfY21kLndpZHRoICogKChzaXplcy0+c3VyZmFjZV9icHAgKyA3KSAvIDgpOwotCW1vZGVfY21k
LnBpeGVsX2Zvcm1hdCA9IGRybV9tb2RlX2xlZ2FjeV9mYl9mb3JtYXQoc2l6ZXMtPnN1cmZhY2Vf
YnBwLAotCQkJCQkJCSAgc2l6ZXMtPnN1cmZhY2VfZGVwdGgpOwotCW1vZGVfY21kLnBpdGNoZXNb
MF0gPSBwaXRjaDsKLQotCXNpemUgPSBwaXRjaCAqIG1vZGVfY21kLmhlaWdodDsKLQotCXJldCA9
IHZib3hfZ2VtX2NyZWF0ZSh2Ym94LCBzaXplLCB0cnVlLCAmZ29iaik7Ci0JaWYgKHJldCkgewot
CQlEUk1fRVJST1IoImZhaWxlZCB0byBjcmVhdGUgZmJjb24gYmFja2luZyBvYmplY3QgJWRcbiIs
IHJldCk7Ci0JCXJldHVybiByZXQ7Ci0JfQotCi0JcmV0ID0gdmJveF9mcmFtZWJ1ZmZlcl9pbml0
KHZib3gsICZ2Ym94LT5hZmIsICZtb2RlX2NtZCwgZ29iaik7Ci0JaWYgKHJldCkKLQkJcmV0dXJu
IHJldDsKLQotCWdibyA9IGRybV9nZW1fdnJhbV9vZl9nZW0oZ29iaik7Ci0KLQlyZXQgPSBkcm1f
Z2VtX3ZyYW1fcGluKGdibywgRFJNX0dFTV9WUkFNX1BMX0ZMQUdfVlJBTSk7Ci0JaWYgKHJldCkK
LQkJcmV0dXJuIHJldDsKLQotCWluZm8gPSBkcm1fZmJfaGVscGVyX2FsbG9jX2ZiaShoZWxwZXIp
OwotCWlmIChJU19FUlIoaW5mbykpCi0JCXJldHVybiBQVFJfRVJSKGluZm8pOwotCi0JaW5mby0+
c2NyZWVuX3NpemUgPSBzaXplOwotCWluZm8tPnNjcmVlbl9iYXNlID0gKGNoYXIgX19pb21lbSAq
KWRybV9nZW1fdnJhbV9rbWFwKGdibywgdHJ1ZSwgTlVMTCk7Ci0JaWYgKElTX0VSUihpbmZvLT5z
Y3JlZW5fYmFzZSkpCi0JCXJldHVybiBQVFJfRVJSKGluZm8tPnNjcmVlbl9iYXNlKTsKLQotCWZi
ID0gJnZib3gtPmFmYi5iYXNlOwotCWhlbHBlci0+ZmIgPSBmYjsKLQotCWluZm8tPmZib3BzID0g
JnZib3hmYl9vcHM7Ci0KLQkvKgotCSAqIFRoaXMgc2VlbXMgdG8gYmUgZG9uZSBmb3Igc2FmZXR5
IGNoZWNraW5nIHRoYXQgdGhlIGZyYW1lYnVmZmVyCi0JICogaXMgbm90IHJlZ2lzdGVyZWQgdHdp
Y2UgYnkgZGlmZmVyZW50IGRyaXZlcnMuCi0JICovCi0JaW5mby0+YXBlcnR1cmVzLT5yYW5nZXNb
MF0uYmFzZSA9IHBjaV9yZXNvdXJjZV9zdGFydChwZGV2LCAwKTsKLQlpbmZvLT5hcGVydHVyZXMt
PnJhbmdlc1swXS5zaXplID0gcGNpX3Jlc291cmNlX2xlbihwZGV2LCAwKTsKLQotCWRybV9mYl9o
ZWxwZXJfZmlsbF9pbmZvKGluZm8sIGhlbHBlciwgc2l6ZXMpOwotCi0JZ3B1X2FkZHIgPSBkcm1f
Z2VtX3ZyYW1fb2Zmc2V0KGdibyk7Ci0JaWYgKGdwdV9hZGRyIDwgMCkKLQkJcmV0dXJuIChpbnQp
Z3B1X2FkZHI7Ci0JaW5mby0+Zml4LnNtZW1fc3RhcnQgPSBpbmZvLT5hcGVydHVyZXMtPnJhbmdl
c1swXS5iYXNlICsgZ3B1X2FkZHI7Ci0JaW5mby0+Zml4LnNtZW1fbGVuID0gdmJveC0+YXZhaWxh
YmxlX3ZyYW1fc2l6ZSAtIGdwdV9hZGRyOwotCi0jaWZkZWYgQ09ORklHX0RSTV9LTVNfRkJfSEVM
UEVSCi0JaW5mby0+ZmJkZWZpbyA9ICZ2Ym94X2RlZmlvOwotCWZiX2RlZmVycmVkX2lvX2luaXQo
aW5mbyk7Ci0jZW5kaWYKLQotCWluZm8tPnBpeG1hcC5mbGFncyA9IEZCX1BJWE1BUF9TWVNURU07
Ci0KLQlEUk1fREVCVUdfS01TKCJhbGxvY2F0ZWQgJWR4JWRcbiIsIGZiLT53aWR0aCwgZmItPmhl
aWdodCk7Ci0KLQlyZXR1cm4gMDsKLX0KLQotdm9pZCB2Ym94X2ZiZGV2X2Zpbmkoc3RydWN0IHZi
b3hfcHJpdmF0ZSAqdmJveCkKLXsKLQlzdHJ1Y3QgdmJveF9mcmFtZWJ1ZmZlciAqYWZiID0gJnZi
b3gtPmFmYjsKLQotI2lmZGVmIENPTkZJR19EUk1fS01TX0ZCX0hFTFBFUgotCWlmICh2Ym94LT5m
Yl9oZWxwZXIuZmJkZXYgJiYgdmJveC0+ZmJfaGVscGVyLmZiZGV2LT5mYmRlZmlvKQotCQlmYl9k
ZWZlcnJlZF9pb19jbGVhbnVwKHZib3gtPmZiX2hlbHBlci5mYmRldik7Ci0jZW5kaWYKLQotCWRy
bV9mYl9oZWxwZXJfdW5yZWdpc3Rlcl9mYmkoJnZib3gtPmZiX2hlbHBlcik7Ci0KLQlpZiAoYWZi
LT5vYmopIHsKLQkJc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKmdibyA9IGRybV9nZW1fdnJh
bV9vZl9nZW0oYWZiLT5vYmopOwotCi0JCWRybV9nZW1fdnJhbV9rdW5tYXAoZ2JvKTsKLQkJZHJt
X2dlbV92cmFtX3VucGluKGdibyk7Ci0KLQkJZHJtX2dlbV9vYmplY3RfcHV0X3VubG9ja2VkKGFm
Yi0+b2JqKTsKLQkJYWZiLT5vYmogPSBOVUxMOwotCX0KLQlkcm1fZmJfaGVscGVyX2ZpbmkoJnZi
b3gtPmZiX2hlbHBlcik7Ci0KLQlkcm1fZnJhbWVidWZmZXJfdW5yZWdpc3Rlcl9wcml2YXRlKCZh
ZmItPmJhc2UpOwotCWRybV9mcmFtZWJ1ZmZlcl9jbGVhbnVwKCZhZmItPmJhc2UpOwotfQpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Zib3h2aWRlby92Ym94X21vZGUuYyBiL2RyaXZlcnMv
Z3B1L2RybS92Ym94dmlkZW8vdmJveF9tb2RlLmMKaW5kZXggZTFlNDhiYTkxOWViLi5kZDlhZDNm
ZGQ5MTkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92Ym94dmlkZW8vdmJveF9tb2RlLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL3Zib3h2aWRlby92Ym94X21vZGUuYwpAQCAtMTMsNiArMTMs
NyBAQAogCiAjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWMuaD4KICNpbmNsdWRlIDxkcm0vZHJtX2F0
b21pY19oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2ZiX2hlbHBlci5oPgogI2luY2x1ZGUg
PGRybS9kcm1fZm91cmNjLmg+CiAjaW5jbHVkZSA8ZHJtL2RybV9wbGFuZV9oZWxwZXIuaD4KICNp
bmNsdWRlIDxkcm0vZHJtX3Byb2JlX2hlbHBlci5oPgpAQCAtMTMzLDcgKzEzNCw3IEBAIHN0YXRp
YyBib29sIHZib3hfc2V0X3VwX2lucHV0X21hcHBpbmcoc3RydWN0IHZib3hfcHJpdmF0ZSAqdmJv
eCkKIAogCQlpZiAoIWZiMSkgewogCQkJZmIxID0gZmI7Ci0JCQlpZiAodG9fdmJveF9mcmFtZWJ1
ZmZlcihmYjEpID09ICZ2Ym94LT5hZmIpCisJCQlpZiAoZmIxID09IHZib3gtPmRkZXYuZmJfaGVs
cGVyLT5mYikKIAkJCQlicmVhazsKIAkJfSBlbHNlIGlmIChmYiAhPSBmYjEpIHsKIAkJCXNpbmds
ZV9mcmFtZWJ1ZmZlciA9IGZhbHNlOwotLSAKMi4yMy4wCgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZl
bEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFp
bG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
