Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 7797427FE57
	for <lists+dri-devel@lfdr.de>; Thu,  1 Oct 2020 13:28:32 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 646DE6E890;
	Thu,  1 Oct 2020 11:28:25 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ej1-x642.google.com (mail-ej1-x642.google.com
 [IPv6:2a00:1450:4864:20::642])
 by gabe.freedesktop.org (Postfix) with ESMTPS id F3E1F6E895
 for <dri-devel@lists.freedesktop.org>; Thu,  1 Oct 2020 11:28:23 +0000 (UTC)
Received: by mail-ej1-x642.google.com with SMTP id qp15so6581110ejb.3
 for <dri-devel@lists.freedesktop.org>; Thu, 01 Oct 2020 04:28:23 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:subject:date:message-id:in-reply-to:references:mime-version
 :content-transfer-encoding;
 bh=Am960dGZKbkejvBFnbmG6WSIST1cLx8Jaj6soXtj1cw=;
 b=qJFT0kRZMIETdNbqpvk5nJ2RyJ13aOknCML+uVF1XyoB6okmTRhy2Flv7lcRayxyU1
 mHcWkXOaL1zErh+ofD29sY1t/xBDbN7DLJ5FvRzxFHUWTwsnJUDbf63mYBcuDfxzxmrq
 rAC+eTeWSUs8d7hjpzpiAH7ZKkZbbv2elBCIB99U1R3Rp74ILeWcP7mDw6vStYc6WICz
 ciLn9tIavv9moJ1m+pT9Lz8wo0gmLCmLPKKAvQdgJGX5RWoZYlKdOTNr9hZU7WXYps5p
 R4o5yUMteepH2JLrJekENsxxMTPr/4zJ6rA65Y97X1ard/or+7nrAtPHjN7d2p3QzboP
 EoIA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=Am960dGZKbkejvBFnbmG6WSIST1cLx8Jaj6soXtj1cw=;
 b=MftukN+IJz8AOpkoZXPLlTbqG3NbWO+2cVG2Y8XeEr8uPcuV3JvBuXCANSxvvhFniP
 B52ZJBOtrFwav2gLOT96b7uUT4q6sJAcwoUq1gOGQztIeTMIUFnSQpBChEffEQsWEqqI
 i/1kR7PLHQwf+WuO3QuT2V6ExbQItitZo+VgIesNqk+xnP+LiqKo/TLXODfaPQcCC68W
 R9crv3rYsyxoU4QoRN9MzuvUVuefspDF4kYo7MiucX1i3SwTFAU86vo2Ll+dr2EZdDB5
 l1JRoOkSA+5KXlv3X6+NDoJD/XZtooTUYBK+cC8oYvh6Dk34Foz3bHmRiDfoJu3qBbQM
 AOcg==
X-Gm-Message-State: AOAM532rUln5TIfaSZQ4IPj9JR6ZhGOfsb/iiRUmpONsW73wr87Uq8MR
 8RlFhSCQ7/OJTfOIf6eUl8mRyT60t5I=
X-Google-Smtp-Source: ABdhPJx1atNRbvfrhJfAjyL5j1FKhBVp93i6GSKz3dgW2FzgL2w3ufC3fR4xSpzmZzHbYDR56r9zTQ==
X-Received: by 2002:a17:906:4993:: with SMTP id
 p19mr7834919eju.277.1601551702181; 
 Thu, 01 Oct 2020 04:28:22 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:36be:5a08:8c1d:6b2b])
 by smtp.gmail.com with ESMTPSA id p3sm3834892edp.28.2020.10.01.04.28.21
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Thu, 01 Oct 2020 04:28:21 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: dri-devel@lists.freedesktop.org, ray.huang@amd.com, airlied@gmail.com,
 daniel@ffwll.ch
Subject: [PATCH 5/8] drm/ttm: set the tt caching state at creation time
Date: Thu,  1 Oct 2020 13:28:14 +0200
Message-Id: <20201001112817.20967-5-christian.koenig@amd.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20201001112817.20967-1-christian.koenig@amd.com>
References: <20201001112817.20967-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWxsIGRyaXZlcnMgY2FuIGRldGVybWluZSB0aGUgdHQgY2FjaGluZyBzdGF0ZSBhdCBjcmVhdGlv
biB0aW1lLApubyBuZWVkIHRvIGRvIHRoaXMgb24gdGhlIGZseSBkdXJpbmcgZXZlcnkgdmFsaWRh
dGlvbi4KClNpZ25lZC1vZmYtYnk6IENocmlzdGlhbiBLw7ZuaWcgPGNocmlzdGlhbi5rb2VuaWdA
YW1kLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmMgICAg
fCAgOSArKysrKysrKy0KIGRyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMgICAg
ICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X3NnZG1hLmMgICAgfCAx
MyArKysrKysrKysrKystCiBkcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF90dG0uYyAgICAgICAgICAg
ICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fdHRtLmMgICAgICAgIHwg
MTQgKysrKysrKysrKysrKy0KIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2FncF9iYWNrZW5kLmMg
ICAgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV90dC5jICAgICAgICAgICAgICAg
fCAxNiArKysrKysrKystLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF90dG1f
YnVmZmVyLmMgfCAgNiArKysrLS0KIGluY2x1ZGUvZHJtL3R0bS90dG1fdHQuaCAgICAgICAgICAg
ICAgICAgICB8ICA3ICsrKystLS0KIDkgZmlsZXMgY2hhbmdlZCwgNTMgaW5zZXJ0aW9ucygrKSwg
MTggZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X3R0bS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jCmlu
ZGV4IDJhZjI0Y2YzOWU5NC4uN2Y0MWE0N2U3MzUzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X3R0bS5jCkBAIC0xMjkyLDcgKzEyOTIsOSBAQCBzdGF0aWMgdm9pZCBhbWRncHVf
dHRtX2JhY2tlbmRfZGVzdHJveShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKIHN0YXRpYyBz
dHJ1Y3QgdHRtX3R0ICphbWRncHVfdHRtX3R0X2NyZWF0ZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmpl
Y3QgKmJvLAogCQkJCQkgICB1aW50MzJfdCBwYWdlX2ZsYWdzKQogeworCXN0cnVjdCBhbWRncHVf
Ym8gKmFibyA9IHR0bV90b19hbWRncHVfYm8oYm8pOwogCXN0cnVjdCBhbWRncHVfdHRtX3R0ICpn
dHQ7CisJZW51bSB0dG1fY2FjaGluZyBjYWNoaW5nOwogCiAJZ3R0ID0ga3phbGxvYyhzaXplb2Yo
c3RydWN0IGFtZGdwdV90dG1fdHQpLCBHRlBfS0VSTkVMKTsKIAlpZiAoZ3R0ID09IE5VTEwpIHsK
QEAgLTEzMDAsOCArMTMwMiwxMyBAQCBzdGF0aWMgc3RydWN0IHR0bV90dCAqYW1kZ3B1X3R0bV90
dF9jcmVhdGUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAl9CiAJZ3R0LT5nb2JqID0g
JmJvLT5iYXNlOwogCisJaWYgKGFiby0+ZmxhZ3MgJiBBTURHUFVfR0VNX0NSRUFURV9DUFVfR1RU
X1VTV0MpCisJCWNhY2hpbmcgPSB0dG1fd3JpdGVfY29tYmluZWQ7CisJZWxzZQorCQljYWNoaW5n
ID0gdHRtX2NhY2hlZDsKKwogCS8qIGFsbG9jYXRlIHNwYWNlIGZvciB0aGUgdW5pbml0aWFsaXpl
ZCBwYWdlIGVudHJpZXMgKi8KLQlpZiAodHRtX3NnX3R0X2luaXQoJmd0dC0+dHRtLCBibywgcGFn
ZV9mbGFncykpIHsKKwlpZiAodHRtX3NnX3R0X2luaXQoJmd0dC0+dHRtLCBibywgcGFnZV9mbGFn
cywgY2FjaGluZykpIHsKIAkJa2ZyZWUoZ3R0KTsKIAkJcmV0dXJuIE5VTEw7CiAJfQpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2RybV9nZW1fdnJhbV9oZWxwZXIuYyBiL2RyaXZlcnMvZ3B1
L2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMKaW5kZXggM2ZlNGIzMjZlMThlLi42MjIzNTkyNmUw
NzcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2RybV9nZW1fdnJhbV9oZWxwZXIuYwpAQCAtOTEwLDcgKzkxMCw3
IEBAIHN0YXRpYyBzdHJ1Y3QgdHRtX3R0ICpib19kcml2ZXJfdHRtX3R0X2NyZWF0ZShzdHJ1Y3Qg
dHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCWlmICghdHQpCiAJCXJldHVybiBOVUxMOwogCi0JcmV0
ID0gdHRtX3R0X2luaXQodHQsIGJvLCBwYWdlX2ZsYWdzKTsKKwlyZXQgPSB0dG1fdHRfaW5pdCh0
dCwgYm8sIHBhZ2VfZmxhZ3MsIHR0bV9jYWNoZWQpOwogCWlmIChyZXQgPCAwKQogCQlnb3RvIGVy
cl90dG1fdHRfaW5pdDsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91
dmVhdV9zZ2RtYS5jIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9zZ2RtYS5jCmlu
ZGV4IDgwNmQ5ZWMzMTBmNS4uY2Q2ZmRlYmFlNzk1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vbm91dmVhdS9ub3V2ZWF1X3NnZG1hLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUv
bm91dmVhdV9zZ2RtYS5jCkBAIC01LDYgKzUsNyBAQAogI2luY2x1ZGUgIm5vdXZlYXVfZHJ2Lmgi
CiAjaW5jbHVkZSAibm91dmVhdV9tZW0uaCIKICNpbmNsdWRlICJub3V2ZWF1X3R0bS5oIgorI2lu
Y2x1ZGUgIm5vdXZlYXVfYm8uaCIKIAogc3RydWN0IG5vdXZlYXVfc2dkbWFfYmUgewogCS8qIHRo
aXMgaGFzIHRvIGJlIHRoZSBmaXJzdCBmaWVsZCBzbyBwb3B1bGF0ZS91bnBvcHVsYXRlZCBpbgpA
QCAtNjcsMTMgKzY4LDIzIEBAIG5vdXZlYXVfc2dkbWFfdW5iaW5kKHN0cnVjdCB0dG1fYm9fZGV2
aWNlICpiZGV2LCBzdHJ1Y3QgdHRtX3R0ICp0dG0pCiBzdHJ1Y3QgdHRtX3R0ICoKIG5vdXZlYXVf
c2dkbWFfY3JlYXRlX3R0bShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLCB1aW50MzJfdCBw
YWdlX2ZsYWdzKQogeworCXN0cnVjdCBub3V2ZWF1X2RybSAqZHJtID0gbm91dmVhdV9iZGV2KGJv
LT5iZGV2KTsKKwlzdHJ1Y3Qgbm91dmVhdV9ibyAqbnZibyA9IG5vdXZlYXVfYm8oYm8pOwogCXN0
cnVjdCBub3V2ZWF1X3NnZG1hX2JlICpudmJlOworCWVudW0gdHRtX2NhY2hpbmcgY2FjaGluZzsK
KworCWlmIChudmJvLT5mb3JjZV9jb2hlcmVudCkKKwkJY2FjaGluZyA9IHR0bV91bmNhY2hlZDsK
KwllbHNlIGlmIChkcm0tPmFncC5icmlkZ2UpCisJCWNhY2hpbmcgPSB0dG1fd3JpdGVfY29tYmlu
ZWQ7CisJZWxzZQorCQljYWNoaW5nID0gdHRtX2NhY2hlZDsKIAogCW52YmUgPSBremFsbG9jKHNp
emVvZigqbnZiZSksIEdGUF9LRVJORUwpOwogCWlmICghbnZiZSkKIAkJcmV0dXJuIE5VTEw7CiAK
LQlpZiAodHRtX2RtYV90dF9pbml0KCZudmJlLT50dG0sIGJvLCBwYWdlX2ZsYWdzKSkgeworCWlm
ICh0dG1fZG1hX3R0X2luaXQoJm52YmUtPnR0bSwgYm8sIHBhZ2VfZmxhZ3MsIGNhY2hpbmcpKSB7
CiAJCWtmcmVlKG52YmUpOwogCQlyZXR1cm4gTlVMTDsKIAl9CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vcXhsL3F4bF90dG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9xeGwvcXhsX3R0bS5jCmlu
ZGV4IDJjMzVjYTQyNzBjNi4uZGNmNGFjMTQ4MGM3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vcXhsL3F4bF90dG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF90dG0uYwpAQCAt
MTQ2LDcgKzE0Niw3IEBAIHN0YXRpYyBzdHJ1Y3QgdHRtX3R0ICpxeGxfdHRtX3R0X2NyZWF0ZShz
dHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCWlmIChndHQgPT0gTlVMTCkKIAkJcmV0dXJu
IE5VTEw7CiAJZ3R0LT5xZGV2ID0gcWRldjsKLQlpZiAodHRtX3R0X2luaXQoJmd0dC0+dHRtLCBi
bywgcGFnZV9mbGFncykpIHsKKwlpZiAodHRtX3R0X2luaXQoJmd0dC0+dHRtLCBibywgcGFnZV9m
bGFncywgdHRtX2NhY2hlZCkpIHsKIAkJa2ZyZWUoZ3R0KTsKIAkJcmV0dXJuIE5VTEw7CiAJfQpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fdHRtLmMgYi9kcml2ZXJz
L2dwdS9kcm0vcmFkZW9uL3JhZGVvbl90dG0uYwppbmRleCBmMDFlNzQxMTNmNDAuLjEzMGE3Y2Vh
MzVjMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fdHRtLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fdHRtLmMKQEAgLTU5MCw2ICs1OTAsMTAg
QEAgc3RhdGljIHN0cnVjdCB0dG1fdHQgKnJhZGVvbl90dG1fdHRfY3JlYXRlKHN0cnVjdCB0dG1f
YnVmZmVyX29iamVjdCAqYm8sCiB7CiAJc3RydWN0IHJhZGVvbl9kZXZpY2UgKnJkZXY7CiAJc3Ry
dWN0IHJhZGVvbl90dG1fdHQgKmd0dDsKKwllbnVtIHR0bV9jYWNoaW5nIGNhY2hpbmc7CisJc3Ry
dWN0IHJhZGVvbl9ibyAqcmJvOworCisJcmJvID0gY29udGFpbmVyX29mKGJvLCBzdHJ1Y3QgcmFk
ZW9uX2JvLCB0Ym8pOwogCiAJcmRldiA9IHJhZGVvbl9nZXRfcmRldihiby0+YmRldik7CiAjaWYg
SVNfRU5BQkxFRChDT05GSUdfQUdQKQpAQCAtNjAzLDcgKzYwNywxNSBAQCBzdGF0aWMgc3RydWN0
IHR0bV90dCAqcmFkZW9uX3R0bV90dF9jcmVhdGUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpi
bywKIAlpZiAoZ3R0ID09IE5VTEwpIHsKIAkJcmV0dXJuIE5VTEw7CiAJfQotCWlmICh0dG1fZG1h
X3R0X2luaXQoJmd0dC0+dHRtLCBibywgcGFnZV9mbGFncykpIHsKKworCWlmIChyYm8tPmZsYWdz
ICYgUkFERU9OX0dFTV9HVFRfVUMpCisJCWNhY2hpbmcgPSB0dG1fdW5jYWNoZWQ7CisJZWxzZSBp
ZiAocmJvLT5mbGFncyAmIFJBREVPTl9HRU1fR1RUX1dDKQorCQljYWNoaW5nID0gdHRtX3dyaXRl
X2NvbWJpbmVkOworCWVsc2UKKwkJY2FjaGluZyA9IHR0bV9jYWNoZWQ7CisKKwlpZiAodHRtX2Rt
YV90dF9pbml0KCZndHQtPnR0bSwgYm8sIHBhZ2VfZmxhZ3MsIGNhY2hpbmcpKSB7CiAJCWtmcmVl
KGd0dCk7CiAJCXJldHVybiBOVUxMOwogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90
dG0vdHRtX2FncF9iYWNrZW5kLmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9hZ3BfYmFja2Vu
ZC5jCmluZGV4IGE5OGZkNzk1Yjc1Mi4uYTcyMzA2MmQzN2U3IDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vdHRtL3R0bV9hZ3BfYmFja2VuZC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0v
dHRtX2FncF9iYWNrZW5kLmMKQEAgLTEzNiw3ICsxMzYsNyBAQCBzdHJ1Y3QgdHRtX3R0ICp0dG1f
YWdwX3R0X2NyZWF0ZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCWFncF9iZS0+bWVt
ID0gTlVMTDsKIAlhZ3BfYmUtPmJyaWRnZSA9IGJyaWRnZTsKIAotCWlmICh0dG1fdHRfaW5pdCgm
YWdwX2JlLT50dG0sIGJvLCBwYWdlX2ZsYWdzKSkgeworCWlmICh0dG1fdHRfaW5pdCgmYWdwX2Jl
LT50dG0sIGJvLCBwYWdlX2ZsYWdzLCB0dG1fd3JpdGVfY29tYmluZWQpKSB7CiAJCWtmcmVlKGFn
cF9iZSk7CiAJCXJldHVybiBOVUxMOwogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90
dG0vdHRtX3R0LmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV90dC5jCmluZGV4IGQ0YzgwZTBm
M2IzYi4uYTQ2NWY1MWRmMDI3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV90
dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3R0LmMKQEAgLTE2MSw3ICsxNjEsOCBA
QCB2b2lkIHR0bV90dF9kZXN0cm95KHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LCBzdHJ1Y3Qg
dHRtX3R0ICp0dG0pCiAKIHN0YXRpYyB2b2lkIHR0bV90dF9pbml0X2ZpZWxkcyhzdHJ1Y3QgdHRt
X3R0ICp0dG0sCiAJCQkgICAgICAgc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKLQkJCSAg
ICAgICB1aW50MzJfdCBwYWdlX2ZsYWdzKQorCQkJICAgICAgIHVpbnQzMl90IHBhZ2VfZmxhZ3Ms
CisJCQkgICAgICAgZW51bSB0dG1fY2FjaGluZyBjYWNoaW5nKQogewogCXR0bS0+bnVtX3BhZ2Vz
ID0gYm8tPm51bV9wYWdlczsKIAl0dG0tPmNhY2hpbmcgPSB0dG1fY2FjaGVkOwpAQCAtMTY5LDEy
ICsxNzAsMTMgQEAgc3RhdGljIHZvaWQgdHRtX3R0X2luaXRfZmllbGRzKHN0cnVjdCB0dG1fdHQg
KnR0bSwKIAl0dG1fdHRfc2V0X3VucG9wdWxhdGVkKHR0bSk7CiAJdHRtLT5zd2FwX3N0b3JhZ2Ug
PSBOVUxMOwogCXR0bS0+c2cgPSBiby0+c2c7CisJdHRtLT5jYWNoaW5nID0gY2FjaGluZzsKIH0K
IAogaW50IHR0bV90dF9pbml0KHN0cnVjdCB0dG1fdHQgKnR0bSwgc3RydWN0IHR0bV9idWZmZXJf
b2JqZWN0ICpibywKLQkJdWludDMyX3QgcGFnZV9mbGFncykKKwkJdWludDMyX3QgcGFnZV9mbGFn
cywgZW51bSB0dG1fY2FjaGluZyBjYWNoaW5nKQogewotCXR0bV90dF9pbml0X2ZpZWxkcyh0dG0s
IGJvLCBwYWdlX2ZsYWdzKTsKKwl0dG1fdHRfaW5pdF9maWVsZHModHRtLCBibywgcGFnZV9mbGFn
cywgY2FjaGluZyk7CiAKIAlpZiAodHRtX3R0X2FsbG9jX3BhZ2VfZGlyZWN0b3J5KHR0bSkpIHsK
IAkJcHJfZXJyKCJGYWlsZWQgYWxsb2NhdGluZyBwYWdlIHRhYmxlXG4iKTsKQEAgLTE5MiwxMSAr
MTk0LDExIEBAIHZvaWQgdHRtX3R0X2Zpbmkoc3RydWN0IHR0bV90dCAqdHRtKQogRVhQT1JUX1NZ
TUJPTCh0dG1fdHRfZmluaSk7CiAKIGludCB0dG1fZG1hX3R0X2luaXQoc3RydWN0IHR0bV9kbWFf
dHQgKnR0bV9kbWEsIHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCi0JCSAgICB1aW50MzJf
dCBwYWdlX2ZsYWdzKQorCQkgICAgdWludDMyX3QgcGFnZV9mbGFncywgZW51bSB0dG1fY2FjaGlu
ZyBjYWNoaW5nKQogewogCXN0cnVjdCB0dG1fdHQgKnR0bSA9ICZ0dG1fZG1hLT50dG07CiAKLQl0
dG1fdHRfaW5pdF9maWVsZHModHRtLCBibywgcGFnZV9mbGFncyk7CisJdHRtX3R0X2luaXRfZmll
bGRzKHR0bSwgYm8sIHBhZ2VfZmxhZ3MsIGNhY2hpbmcpOwogCiAJSU5JVF9MSVNUX0hFQUQoJnR0
bV9kbWEtPnBhZ2VzX2xpc3QpOwogCWlmICh0dG1fZG1hX3R0X2FsbG9jX3BhZ2VfZGlyZWN0b3J5
KHR0bV9kbWEpKSB7CkBAIC0yMDgsMTIgKzIxMCwxMiBAQCBpbnQgdHRtX2RtYV90dF9pbml0KHN0
cnVjdCB0dG1fZG1hX3R0ICp0dG1fZG1hLCBzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAog
RVhQT1JUX1NZTUJPTCh0dG1fZG1hX3R0X2luaXQpOwogCiBpbnQgdHRtX3NnX3R0X2luaXQoc3Ry
dWN0IHR0bV9kbWFfdHQgKnR0bV9kbWEsIHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCi0J
CSAgIHVpbnQzMl90IHBhZ2VfZmxhZ3MpCisJCSAgIHVpbnQzMl90IHBhZ2VfZmxhZ3MsIGVudW0g
dHRtX2NhY2hpbmcgY2FjaGluZykKIHsKIAlzdHJ1Y3QgdHRtX3R0ICp0dG0gPSAmdHRtX2RtYS0+
dHRtOwogCWludCByZXQ7CiAKLQl0dG1fdHRfaW5pdF9maWVsZHModHRtLCBibywgcGFnZV9mbGFn
cyk7CisJdHRtX3R0X2luaXRfZmllbGRzKHR0bSwgYm8sIHBhZ2VfZmxhZ3MsIGNhY2hpbmcpOwog
CiAJSU5JVF9MSVNUX0hFQUQoJnR0bV9kbWEtPnBhZ2VzX2xpc3QpOwogCWlmIChwYWdlX2ZsYWdz
ICYgVFRNX1BBR0VfRkxBR19TRykKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngv
dm13Z2Z4X3R0bV9idWZmZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3R0bV9i
dWZmZXIuYwppbmRleCBmYzY4ZjU0ZGY0NmEuLjQyZjk1N2Q0MGM5ZiAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfdHRtX2J1ZmZlci5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS92bXdnZngvdm13Z2Z4X3R0bV9idWZmZXIuYwpAQCAtNjQ3LDkgKzY0NywxMSBAQCBzdGF0
aWMgc3RydWN0IHR0bV90dCAqdm13X3R0bV90dF9jcmVhdGUoc3RydWN0IHR0bV9idWZmZXJfb2Jq
ZWN0ICpibywKIAl2bXdfYmUtPm1vYiA9IE5VTEw7CiAKIAlpZiAodm13X2JlLT5kZXZfcHJpdi0+
bWFwX21vZGUgPT0gdm13X2RtYV9hbGxvY19jb2hlcmVudCkKLQkJcmV0ID0gdHRtX2RtYV90dF9p
bml0KCZ2bXdfYmUtPmRtYV90dG0sIGJvLCBwYWdlX2ZsYWdzKTsKKwkJcmV0ID0gdHRtX2RtYV90
dF9pbml0KCZ2bXdfYmUtPmRtYV90dG0sIGJvLCBwYWdlX2ZsYWdzLAorCQkJCSAgICAgIHR0bV9j
YWNoZWQpOwogCWVsc2UKLQkJcmV0ID0gdHRtX3R0X2luaXQoJnZtd19iZS0+ZG1hX3R0bS50dG0s
IGJvLCBwYWdlX2ZsYWdzKTsKKwkJcmV0ID0gdHRtX3R0X2luaXQoJnZtd19iZS0+ZG1hX3R0bS50
dG0sIGJvLCBwYWdlX2ZsYWdzLAorCQkJCSAgdHRtX2NhY2hlZCk7CiAJaWYgKHVubGlrZWx5KHJl
dCAhPSAwKSkKIAkJZ290byBvdXRfbm9faW5pdDsKIApkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0v
dHRtL3R0bV90dC5oIGIvaW5jbHVkZS9kcm0vdHRtL3R0bV90dC5oCmluZGV4IGI5MGM4YzQ1MWE1
NC4uYzM5YzcyMmQ1MTg0IDEwMDY0NAotLS0gYS9pbmNsdWRlL2RybS90dG0vdHRtX3R0LmgKKysr
IGIvaW5jbHVkZS9kcm0vdHRtL3R0bV90dC5oCkBAIC0xMTYsNiArMTE2LDcgQEAgaW50IHR0bV90
dF9jcmVhdGUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywgYm9vbCB6ZXJvX2FsbG9jKTsK
ICAqIEB0dG06IFRoZSBzdHJ1Y3QgdHRtX3R0LgogICogQGJvOiBUaGUgYnVmZmVyIG9iamVjdCB3
ZSBjcmVhdGUgdGhlIHR0bSBmb3IuCiAgKiBAcGFnZV9mbGFnczogUGFnZSBmbGFncyBhcyBpZGVu
dGlmaWVkIGJ5IFRUTV9QQUdFX0ZMQUdfWFggZmxhZ3MuCisgKiBAY2FjaGluZzogdGhlIGRlc2ly
ZWQgY2FjaGluZyBzdGF0ZSBvZiB0aGUgcGFnZXMKICAqCiAgKiBDcmVhdGUgYSBzdHJ1Y3QgdHRt
X3R0IHRvIGJhY2sgZGF0YSB3aXRoIHN5c3RlbSBtZW1vcnkgcGFnZXMuCiAgKiBObyBwYWdlcyBh
cmUgYWN0dWFsbHkgYWxsb2NhdGVkLgpAQCAtMTIzLDExICsxMjQsMTEgQEAgaW50IHR0bV90dF9j
cmVhdGUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywgYm9vbCB6ZXJvX2FsbG9jKTsKICAq
IE5VTEw6IE91dCBvZiBtZW1vcnkuCiAgKi8KIGludCB0dG1fdHRfaW5pdChzdHJ1Y3QgdHRtX3R0
ICp0dG0sIHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCi0JCXVpbnQzMl90IHBhZ2VfZmxh
Z3MpOworCQl1aW50MzJfdCBwYWdlX2ZsYWdzLCBlbnVtIHR0bV9jYWNoaW5nIGNhY2hpbmcpOwog
aW50IHR0bV9kbWFfdHRfaW5pdChzdHJ1Y3QgdHRtX2RtYV90dCAqdHRtX2RtYSwgc3RydWN0IHR0
bV9idWZmZXJfb2JqZWN0ICpibywKLQkJICAgIHVpbnQzMl90IHBhZ2VfZmxhZ3MpOworCQkgICAg
dWludDMyX3QgcGFnZV9mbGFncywgZW51bSB0dG1fY2FjaGluZyBjYWNoaW5nKTsKIGludCB0dG1f
c2dfdHRfaW5pdChzdHJ1Y3QgdHRtX2RtYV90dCAqdHRtX2RtYSwgc3RydWN0IHR0bV9idWZmZXJf
b2JqZWN0ICpibywKLQkJICAgdWludDMyX3QgcGFnZV9mbGFncyk7CisJCSAgIHVpbnQzMl90IHBh
Z2VfZmxhZ3MsIGVudW0gdHRtX2NhY2hpbmcgY2FjaGluZyk7CiAKIC8qKgogICogdHRtX3R0X2Zp
bmkKLS0gCjIuMTcuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Au
b3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRl
dmVsCg==
