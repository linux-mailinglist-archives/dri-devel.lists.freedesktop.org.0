Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 4592B95312
	for <lists+dri-devel@lfdr.de>; Tue, 20 Aug 2019 03:17:50 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E81696E50D;
	Tue, 20 Aug 2019 01:17:41 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from perceval.ideasonboard.com (perceval.ideasonboard.com
 [213.167.242.64])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5F7276E4A0
 for <dri-devel@lists.freedesktop.org>; Tue, 20 Aug 2019 01:17:37 +0000 (UTC)
Received: from pendragon.bb.dnainternet.fi
 (dfj612yhrgyx302h3jwwy-3.rev.dnainternet.fi
 [IPv6:2001:14ba:21f5:5b00:ce28:277f:58d7:3ca4])
 by perceval.ideasonboard.com (Postfix) with ESMTPSA id 75BDCAF9;
 Tue, 20 Aug 2019 03:17:34 +0200 (CEST)
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v2 04/50] drm/bridge: Add connector-related bridge operations
 and data
Date: Tue, 20 Aug 2019 04:16:35 +0300
Message-Id: <20190820011721.30136-5-laurent.pinchart@ideasonboard.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190820011721.30136-1-laurent.pinchart@ideasonboard.com>
References: <20190820011721.30136-1-laurent.pinchart@ideasonboard.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=ideasonboard.com; s=mail; t=1566263854;
 bh=ODd7Sqe0XkMPxOiQ2ngOY2b4q15sBzlotZyZTnCUrI0=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=iM7tPbl1alEwtmuUyGYoqyPfPnLc8Bg55qnW259nRaphOCaMjnRhtfHIjdZmg0gg0
 yD8MYHsw0XZ7giJNiRweShGinZhxWGmCXD+sq5GIcbxpQXQ2YPtIySAh8Bv2IyU3o7
 cE8opblpsn0457a1sgAolEUruFXYX8uwewhopDEQ=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Maxime Ripard <maxime.ripard@bootlin.com>,
 Tomi Valkeinen <tomi.valkeinen@ti.com>, Sean Paul <sean@poorly.run>,
 Sebastian Reichel <sebastian.reichel@collabora.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VG8gc3VwcG9ydCBpbXBsZW1lbnRhdGlvbiBvZiBEUk0gY29ubmVjdG9ycyBvbiB0b3Agb2YgRFJN
IGJyaWRnZXMKaW5zdGVhZCBvZiBieSBicmlkZ2VzLCB0aGUgZHJtX2JyaWRnZSBuZWVkcyB0byBl
eHBvc2UgbmV3IG9wZXJhdGlvbnMgYW5kCmRhdGE6CgotIE91dHB1dCBkZXRlY3Rpb24sIGhvdC1w
bHVnIG5vdGlmaWNhdGlvbiwgbW9kZSByZXRyaWV2YWwgYW5kIEVESUQKICByZXRyaWV2YWwgb3Bl
cmF0aW9ucwotIEJpdG1hc2sgb2Ygc3VwcG9ydGVkIG9wZXJhdGlvbnMKLSBCcmlkZ2Ugb3V0cHV0
IHR5cGUKLSBJMkMgYWRhcHRlciBmb3IgRERDIGFjY2VzcwoKQWRkIGFuZCBkb2N1bWVudCB0aGVz
ZS4KClRocmVlIG5ldyBicmlkZ2UgaGVscGVyIGZ1bmN0aW9ucyBhcmUgYWxzbyBhZGRlZCB0byBo
YW5kbGUgaG90IHBsdWcKbm90aWZpY2F0aW9uIGluIGEgd2F5IHRoYXQgaXMgYXMgdHJhbnNwYXJl
bnQgYXMgcG9zc2libGUgZm9yIHRoZQpicmlkZ2VzLgoKU2lnbmVkLW9mZi1ieTogTGF1cmVudCBQ
aW5jaGFydCA8bGF1cmVudC5waW5jaGFydEBpZGVhc29uYm9hcmQuY29tPgotLS0KQ2hhbmdlcyBz
aW5jZSB2MToKCi0gTWFrZSAuaHBkX2VuYWJsZSgpIGFuZCAuaHBkX2Rpc2FibGUoKSBvcHRpb25h
bAotIFJlbmFtZSAubG9zdF9ob3RwbHVnKCkgdG8gLmhwZF9ub3RpZnkoKQotIEFkZCBkZGMgZmll
bGQgdG8gZHJtX2JyaWRnZQotLS0KIGRyaXZlcnMvZ3B1L2RybS9kcm1fYnJpZGdlLmMgfCAgOTQg
KysrKysrKysrKysrKysrKysrKwogaW5jbHVkZS9kcm0vZHJtX2JyaWRnZS5oICAgICB8IDE3NyAr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLQogMiBmaWxlcyBjaGFuZ2VkLCAyNzAg
aW5zZXJ0aW9ucygrKSwgMSBkZWxldGlvbigtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9kcm1fYnJpZGdlLmMgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX2JyaWRnZS5jCmluZGV4IGNiYTUz
N2M5OWU0My4uY2YxZmJlZDg4NDEwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2Jy
aWRnZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fYnJpZGdlLmMKQEAgLTcwLDYgKzcwLDgg
QEAgc3RhdGljIExJU1RfSEVBRChicmlkZ2VfbGlzdCk7CiAgKi8KIHZvaWQgZHJtX2JyaWRnZV9h
ZGQoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSkKIHsKKwltdXRleF9pbml0KCZicmlkZ2UtPmhw
ZF9tdXRleCk7CisKIAltdXRleF9sb2NrKCZicmlkZ2VfbG9jayk7CiAJbGlzdF9hZGRfdGFpbCgm
YnJpZGdlLT5saXN0LCAmYnJpZGdlX2xpc3QpOwogCW11dGV4X3VubG9jaygmYnJpZGdlX2xvY2sp
OwpAQCAtODYsNiArODgsOCBAQCB2b2lkIGRybV9icmlkZ2VfcmVtb3ZlKHN0cnVjdCBkcm1fYnJp
ZGdlICpicmlkZ2UpCiAJbXV0ZXhfbG9jaygmYnJpZGdlX2xvY2spOwogCWxpc3RfZGVsX2luaXQo
JmJyaWRnZS0+bGlzdCk7CiAJbXV0ZXhfdW5sb2NrKCZicmlkZ2VfbG9jayk7CisKKwltdXRleF9k
ZXN0cm95KCZicmlkZ2UtPmhwZF9tdXRleCk7CiB9CiBFWFBPUlRfU1lNQk9MKGRybV9icmlkZ2Vf
cmVtb3ZlKTsKIApAQCAtNDYyLDYgKzQ2Niw5NiBAQCB2b2lkIGRybV9hdG9taWNfYnJpZGdlX2Vu
YWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAogfQogRVhQT1JUX1NZTUJPTChkcm1fYXRv
bWljX2JyaWRnZV9lbmFibGUpOwogCisvKioKKyAqIGRybV9icmlkZ2VfaHBkX2VuYWJsZSAtIGVu
YWJsZSBob3QgcGx1ZyBkZXRlY3Rpb24gZm9yIHRoZSBicmlkZ2UKKyAqIEBicmlkZ2U6IGJyaWRn
ZSBjb250cm9sIHN0cnVjdHVyZQorICogQGNiOiBob3QtcGx1ZyBkZXRlY3Rpb24gY2FsbGJhY2sK
KyAqIEBkYXRhOiBkYXRhIHRvIGJlIHBhc3NlZCB0byB0aGUgaG90LXBsdWcgZGV0ZWN0aW9uIGNh
bGxiYWNrCisgKgorICogQ2FsbCAmZHJtX2JyaWRnZV9mdW5jcy5ocGRfZW5hYmxlIGlmIGltcGxl
bWVudGVkIGFuZCByZWdpc3RlciB0aGUgZ2l2ZW4gQGNiCisgKiBhbmQgQGRhdGEgYXMgaG90IHBs
dWcgbm90aWZpY2F0aW9uIGNhbGxiYWNrLiBGcm9tIG5vdyBvbiB0aGUgQGNiIHdpbGwgYmUKKyAq
IGNhbGxlZCB3aXRoIEBkYXRhIHdoZW4gYW4gb3V0cHV0IHN0YXR1cyBjaGFuZ2UgaXMgZGV0ZWN0
ZWQgYnkgdGhlIGJyaWRnZSwKKyAqIHVudGlsIGhvdCBwbHVnIG5vdGlmaWNhdGlvbiBnZXRzIGRp
c2FibGVkIHdpdGggZHJtX2JyaWRnZV9ocGRfZGlzYWJsZSgpLgorICoKKyAqIEhvdCBwbHVnIGRl
dGVjdGlvbiBpcyBzdXBwb3J0ZWQgb25seSBpZiB0aGUgRFJNX0JSSURHRV9PUF9IUEQgZmxhZyBp
cyBzZXQgaW4KKyAqIGJyaWRnZS0+b3BzLiBUaGlzIGZ1bmN0aW9uIHNoYWxsIG5vdCBiZSBjYWxs
ZWQgd2hlbiB0aGUgZmxhZyBpcyBub3Qgc2V0LgorICoKKyAqIE9ubHkgb25lIGhvdCBwbHVnIGRl
dGVjdGlvbiBjYWxsYmFjayBjYW4gYmUgcmVnaXN0ZXJlZCBhdCBhIHRpbWUsIGl0IGlzIGFuCisg
KiBlcnJvciB0byBjYWxsIHRoaXMgZnVuY3Rpb24gd2hlbiBob3QgcGx1ZyBkZXRlY3Rpb24gaXMg
YWxyZWFkeSBlbmFibGVkIGZvcgorICogdGhlIGJyaWRnZS4KKyAqLwordm9pZCBkcm1fYnJpZGdl
X2hwZF9lbmFibGUoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSwKKwkJCSAgIHZvaWQgKCpjYiko
dm9pZCAqZGF0YSwKKwkJCQkgICAgICBlbnVtIGRybV9jb25uZWN0b3Jfc3RhdHVzIHN0YXR1cyks
CisJCQkgICB2b2lkICpkYXRhKQoreworCWlmICghYnJpZGdlIHx8ICEoYnJpZGdlLT5vcHMgJiBE
Uk1fQlJJREdFX09QX0hQRCkpCisJCXJldHVybjsKKworCW11dGV4X2xvY2soJmJyaWRnZS0+aHBk
X211dGV4KTsKKworCWlmIChXQVJOKGJyaWRnZS0+aHBkX2NiLCAiSG90IHBsdWcgZGV0ZWN0aW9u
IGFscmVhZHkgZW5hYmxlZFxuIikpCisJCWdvdG8gdW5sb2NrOworCisJYnJpZGdlLT5ocGRfY2Ig
PSBjYjsKKwlicmlkZ2UtPmhwZF9kYXRhID0gZGF0YTsKKworCWlmIChicmlkZ2UtPmZ1bmNzLT5o
cGRfZW5hYmxlKQorCQlicmlkZ2UtPmZ1bmNzLT5ocGRfZW5hYmxlKGJyaWRnZSk7CisKK3VubG9j
azoKKwltdXRleF91bmxvY2soJmJyaWRnZS0+aHBkX211dGV4KTsKK30KK0VYUE9SVF9TWU1CT0xf
R1BMKGRybV9icmlkZ2VfaHBkX2VuYWJsZSk7CisKKy8qKgorICogZHJtX2JyaWRnZV9ocGRfZGlz
YWJsZSAtIGRpc2FibGUgaG90IHBsdWcgZGV0ZWN0aW9uIGZvciB0aGUgYnJpZGdlCisgKiBAYnJp
ZGdlOiBicmlkZ2UgY29udHJvbCBzdHJ1Y3R1cmUKKyAqCisgKiBDYWxsICZkcm1fYnJpZGdlX2Z1
bmNzLmhwZF9kaXNhYmxlIGlmIGltcGxlbWVudGVkIGFuZCB1bnJlZ2lzdGVyIHRoZSBob3QKKyAq
IHBsdWcgZGV0ZWN0aW9uIGNhbGxiYWNrIHByZXZpb3VzbHkgcmVnaXN0ZXJlZCB3aXRoIGRybV9i
cmlkZ2VfaHBkX2VuYWJsZSgpLgorICogT25jZSB0aGlzIGZ1bmN0aW9uIHJldHVybnMgdGhlIGNh
bGxiYWNrIHdpbGwgbm90IGJlIGNhbGxlZCBieSB0aGUgYnJpZGdlCisgKiB3aGVuIGFuIG91dHB1
dCBzdGF0dXMgY2hhbmdlIG9jY3Vycy4KKyAqCisgKiBIb3QgcGx1ZyBkZXRlY3Rpb24gaXMgc3Vw
cG9ydGVkIG9ubHkgaWYgdGhlIERSTV9CUklER0VfT1BfSFBEIGZsYWcgaXMgc2V0IGluCisgKiBi
cmlkZ2UtPm9wcy4gVGhpcyBmdW5jdGlvbiBzaGFsbCBub3QgYmUgY2FsbGVkIHdoZW4gdGhlIGZs
YWcgaXMgbm90IHNldC4KKyAqLwordm9pZCBkcm1fYnJpZGdlX2hwZF9kaXNhYmxlKHN0cnVjdCBk
cm1fYnJpZGdlICpicmlkZ2UpCit7CisJaWYgKCFicmlkZ2UgfHwgIShicmlkZ2UtPm9wcyAmIERS
TV9CUklER0VfT1BfSFBEKSkKKwkJcmV0dXJuOworCisJbXV0ZXhfbG9jaygmYnJpZGdlLT5ocGRf
bXV0ZXgpOworCWlmIChicmlkZ2UtPmZ1bmNzLT5ocGRfZGlzYWJsZSkKKwkJYnJpZGdlLT5mdW5j
cy0+aHBkX2Rpc2FibGUoYnJpZGdlKTsKKworCWJyaWRnZS0+aHBkX2NiID0gTlVMTDsKKwlicmlk
Z2UtPmhwZF9kYXRhID0gTlVMTDsKKwltdXRleF91bmxvY2soJmJyaWRnZS0+aHBkX211dGV4KTsK
K30KK0VYUE9SVF9TWU1CT0xfR1BMKGRybV9icmlkZ2VfaHBkX2Rpc2FibGUpOworCisvKioKKyAq
IGRybV9icmlkZ2VfaHBkX25vdGlmeSAtIG5vdGlmeSBob3QgcGx1ZyBkZXRlY3Rpb24gZXZlbnRz
CisgKiBAYnJpZGdlOiBicmlkZ2UgY29udHJvbCBzdHJ1Y3R1cmUKKyAqIEBzdGF0dXM6IG91dHB1
dCBjb25uZWN0aW9uIHN0YXR1cworICoKKyAqIEJyaWRnZSBkcml2ZXJzIHNoYWxsIGNhbGwgdGhp
cyBmdW5jdGlvbiB0byByZXBvcnQgaG90IHBsdWcgZXZlbnRzIHdoZW4gdGhleQorICogZGV0ZWN0
IGEgY2hhbmdlIGluIHRoZSBvdXRwdXQgc3RhdHVzLCB3aGVuIGhvdCBwbHVnIGRldGVjdGlvbiBo
YXMgYmVlbgorICogZW5hYmxlZCBieSBkcm1fYnJpZGdlX2hwZF9lbmFibGUoKS4KKyAqCisgKiBU
aGlzIGZ1bmN0aW9uIHNoYWxsIGJlIGNhbGxlZCBpbiBhIGNvbnRleHQgdGhhdCBjYW4gc2xlZXAu
CisgKi8KK3ZvaWQgZHJtX2JyaWRnZV9ocGRfbm90aWZ5KHN0cnVjdCBkcm1fYnJpZGdlICpicmlk
Z2UsCisJCQkgICBlbnVtIGRybV9jb25uZWN0b3Jfc3RhdHVzIHN0YXR1cykKK3sKKwltdXRleF9s
b2NrKCZicmlkZ2UtPmhwZF9tdXRleCk7CisJaWYgKGJyaWRnZS0+aHBkX2NiKQorCQlicmlkZ2Ut
PmhwZF9jYihicmlkZ2UtPmhwZF9kYXRhLCBzdGF0dXMpOworCW11dGV4X3VubG9jaygmYnJpZGdl
LT5ocGRfbXV0ZXgpOworfQorRVhQT1JUX1NZTUJPTF9HUEwoZHJtX2JyaWRnZV9ocGRfbm90aWZ5
KTsKKwogI2lmZGVmIENPTkZJR19PRgogLyoqCiAgKiBvZl9kcm1fZmluZF9icmlkZ2UgLSBmaW5k
IHRoZSBicmlkZ2UgY29ycmVzcG9uZGluZyB0byB0aGUgZGV2aWNlIG5vZGUgaW4KZGlmZiAtLWdp
dCBhL2luY2x1ZGUvZHJtL2RybV9icmlkZ2UuaCBiL2luY2x1ZGUvZHJtL2RybV9icmlkZ2UuaApp
bmRleCA3NjE2ZjY1NjJmZTQuLjdkYjZjYTBmZDc1ZCAxMDA2NDQKLS0tIGEvaW5jbHVkZS9kcm0v
ZHJtX2JyaWRnZS5oCisrKyBiL2luY2x1ZGUvZHJtL2RybV9icmlkZ2UuaApAQCAtMjMsMTQgKzIz
LDE2IEBACiAjaWZuZGVmIF9fRFJNX0JSSURHRV9IX18KICNkZWZpbmUgX19EUk1fQlJJREdFX0hf
XwogCi0jaW5jbHVkZSA8bGludXgvbGlzdC5oPgogI2luY2x1ZGUgPGxpbnV4L2N0eXBlLmg+Cisj
aW5jbHVkZSA8bGludXgvbGlzdC5oPgorI2luY2x1ZGUgPGxpbnV4L211dGV4Lmg+CiAjaW5jbHVk
ZSA8ZHJtL2RybV9tb2RlX29iamVjdC5oPgogI2luY2x1ZGUgPGRybS9kcm1fbW9kZXMuaD4KIAog
c3RydWN0IGRybV9icmlkZ2U7CiBzdHJ1Y3QgZHJtX2JyaWRnZV90aW1pbmdzOwogc3RydWN0IGRy
bV9wYW5lbDsKK3N0cnVjdCBpMmNfYWRhcHRlcjsKIAogLyoqCiAgKiBzdHJ1Y3QgZHJtX2JyaWRn
ZV9mdW5jcyAtIGRybV9icmlkZ2UgY29udHJvbCBmdW5jdGlvbnMKQEAgLTMzNCw2ICszMzYsMTEx
IEBAIHN0cnVjdCBkcm1fYnJpZGdlX2Z1bmNzIHsKIAkgKi8KIAl2b2lkICgqYXRvbWljX3Bvc3Rf
ZGlzYWJsZSkoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSwKIAkJCQkgICAgc3RydWN0IGRybV9h
dG9taWNfc3RhdGUgKnN0YXRlKTsKKworCS8qKgorCSAqIEBkZXRlY3Q6CisJICoKKwkgKiBDaGVj
ayBpZiBhbnl0aGluZyBpcyBhdHRhY2hlZCB0byB0aGUgYnJpZGdlIG91dHB1dC4KKwkgKgorCSAq
IFRoaXMgY2FsbGJhY2sgaXMgb3B0aW9uYWwsIGlmIG5vdCBpbXBsZW1lbnRlZCB0aGUgYnJpZGdl
IHdpbGwgYmUKKwkgKiBjb25zaWRlcmVkIGFzIGFsd2F5cyBoYXZpbmcgYSBjb21wb25lbnQgYXR0
YWNoZWQgdG8gaXRzIG91dHB1dC4KKwkgKiBCcmlkZ2VzIHRoYXQgaW1wbGVtZW50IHRoaXMgY2Fs
bGJhY2sgc2hhbGwgc2V0IHRoZQorCSAqIERSTV9CUklER0VfT1BfREVURUNUIGZsYWcgaW4gdGhl
aXIgJmRybV9icmlkZ2UtPm9wcy4KKwkgKgorCSAqIFJFVFVSTlM6CisJICoKKwkgKiBkcm1fY29u
bmVjdG9yX3N0YXR1cyBpbmRpY2F0aW5nIHRoZSBicmlkZ2Ugb3V0cHV0IHN0YXR1cy4KKwkgKi8K
KwllbnVtIGRybV9jb25uZWN0b3Jfc3RhdHVzICgqZGV0ZWN0KShzdHJ1Y3QgZHJtX2JyaWRnZSAq
YnJpZGdlKTsKKworCS8qKgorCSAqIEBnZXRfbW9kZXM6CisJICoKKwkgKiBGaWxsIGFsbCBtb2Rl
cyBjdXJyZW50bHkgdmFsaWQgZm9yIHRoZSBzaW5rIGludG8gdGhlICZkcm1fY29ubmVjdG9yCisJ
ICogd2l0aCBkcm1fbW9kZV9wcm9iZWRfYWRkKCkuCisJICoKKwkgKiBUaGUgQGdldF9tb2RlcyBj
YWxsYmFjayBpcyBtb3N0bHkgaW50ZW5kZWQgdG8gc3VwcG9ydCBub24tcHJvYmFibGUKKwkgKiBk
aXNwbGF5cyBzdWNoIGFzIG1hbnkgZml4ZWQgcGFuZWxzLiBCcmlkZ2VzIHRoYXQgc3VwcG9ydCBy
ZWFkaW5nCisJICogRURJRCBzaGFsbCBsZWF2ZSBAZ2V0X21vZGVzIHVuaW1wbGVtZW50ZWQgYW5k
IGltcGxlbWVudCB0aGUKKwkgKiAmZHJtX2JyaWRnZV9mdW5jcy0+Z2V0X2VkaWQgY2FsbGJhY2sg
aW5zdGVhZC4KKwkgKgorCSAqIFRoaXMgY2FsbGJhY2sgaXMgb3B0aW9uYWwuIEJyaWRnZXMgdGhh
dCBpbXBsZW1lbnQgaXQgc2hhbGwgc2V0IHRoZQorCSAqIERSTV9CUklER0VfT1BfTU9ERVMgZmxh
ZyBpbiB0aGVpciAmZHJtX2JyaWRnZS0+b3BzLgorCSAqCisJICogUkVUVVJOUzoKKwkgKgorCSAq
IFRoZSBudW1iZXIgb2YgbW9kZXMgYWRkZWQgYnkgY2FsbGluZyBkcm1fbW9kZV9wcm9iZWRfYWRk
KCkuCisJICovCisJaW50ICgqZ2V0X21vZGVzKShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAor
CQkJIHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpOworCisJLyoqCisJICogQGdldF9l
ZGlkOgorCSAqCisJICogUmVhZCBhbmQgcGFyc2UgdGhlIEVESUQgZGF0YSBvZiB0aGUgY29ubmVj
dGVkIGRpc3BsYXkuCisJICoKKwkgKiBUaGUgQGdldF9lZGlkIGNhbGxiYWNrIGlzIHRoZSBwcmVm
ZXJyZWQgd2F5IG9mIHJlcG9ydGluZyBtb2RlCisJICogaW5mb3JtYXRpb24gZm9yIGEgZGlzcGxh
eSBjb25uZWN0ZWQgdG8gdGhlIGJyaWRnZSBvdXRwdXQuIEJyaWRnZXMKKwkgKiB0aGF0IHN1cHBv
cnQgcmVhZGluZCBFRElEIHNoYWxsIGltcGxlbWVudCB0aGlzIGNhbGxiYWNrIGFuZCBsZWF2ZQor
CSAqIHRoZSBAZ2V0X21vZGVzIGNhbGxiYWNrIHVuaW1wbGVtZW50ZWQuCisJICoKKwkgKiBUaGUg
Y2FsbGVyIG9mIHRoaXMgb3BlcmF0aW9uIHNoYWxsIGZpcnN0IHZlcmlmeSB0aGUgb3V0cHV0CisJ
ICogY29ubmVjdGlvbiBzdGF0dXMgYW5kIHJlZnJhaW4gZnJvbSByZWFkaW5nIEVESUQgZnJvbSBh
IGRpc2Nvbm5lY3RlZAorCSAqIG91dHB1dC4KKwkgKgorCSAqIFRoaXMgY2FsbGJhY2sgaXMgb3B0
aW9uYWwuIEJyaWRnZXMgdGhhdCBpbXBsZW1lbnQgaXQgc2hhbGwgc2V0IHRoZQorCSAqIERSTV9C
UklER0VfT1BfRURJRCBmbGFnIGluIHRoZWlyICZkcm1fYnJpZGdlLT5vcHMuCisJICoKKwkgKiBS
RVRVUk5TOgorCSAqCisJICogQW4gZWRpZCBzdHJ1Y3R1cmUgbmV3bHkgYWxsb2NhdGVkIHdpdGgg
a21hbGxvYygpIChvciBzaW1pbGFyKSBvbgorCSAqIHN1Y2Nlc3MsIG9yIE5VTEwgb3RoZXJ3aXNl
LiBUaGUgY2FsbGVyIGlzIHJlc3BvbnNpYmxlIGZvciBmcmVlaW5nCisJICogdGhlIHJldHVybmVk
IGVkaWQgc3RydWN0dXJlIHdpdGgga2ZyZWUoKS4KKwkgKi8KKwlzdHJ1Y3QgZWRpZCAqKCpnZXRf
ZWRpZCkoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSwKKwkJCQkgc3RydWN0IGRybV9jb25uZWN0
b3IgKmNvbm5lY3Rvcik7CisKKwkvKioKKwkgKiBAaHBkX25vdGlmeToKKwkgKgorCSAqIE5vdGlm
eSB0aGUgYnJpZGdlIG9mIGhvdCBwbHVnIGRldGVjdGlvbi4KKwkgKgorCSAqIFRoaXMgY2FsbGJh
Y2sgaXMgb3B0aW9uYWwsIGl0IG1heSBiZSBpbXBsZW1lbnRlZCBieSBicmlkZ2VzIHRoYXQKKwkg
KiBuZWVkIHRvIGJlIG5vdGlmaWVkIG9mIGRpc3BsYXkgY29ubmVjdGlvbiBvciBkaXNjb25uZWN0
aW9uIGZvcgorCSAqIGludGVybmFsIHJlYXNvbnMuIE9uZSB1c2UgY2FzZSBpcyB0byByZXNldCB0
aGUgaW50ZXJuYWwgc3RhdGUgb2YgQ0VDCisJICogY29udHJvbGxlcnMgZm9yIEhETUkgYnJpZGdl
cy4KKwkgKi8KKwl2b2lkICgqaHBkX25vdGlmeSkoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSwK
KwkJCSAgIGVudW0gZHJtX2Nvbm5lY3Rvcl9zdGF0dXMgc3RhdHVzKTsKKworCS8qKgorCSAqIEBo
cGRfZW5hYmxlOgorCSAqCisJICogRW5hYmxlIGhvdCBwbHVnIGRldGVjdGlvbi4gRnJvbSBub3cg
b24gdGhlIGJyaWRnZSBzaGFsbCBjYWxsCisJICogZHJtX2JyaWRnZV9ocGRfbm90aWZ5KCkgZWFj
aCB0aW1lIGEgY2hhbmdlIGlzIGRldGVjdGVkIGluIHRoZSBvdXRwdXQKKwkgKiBjb25uZWN0aW9u
IHN0YXR1cywgdW50aWwgaG90IHBsdWcgZGV0ZWN0aW9uIGdldHMgZGlzYWJsZWQgd2l0aAorCSAq
IEBocGRfZGlzYWJsZS4KKwkgKgorCSAqIFRoaXMgY2FsbGJhY2sgaXMgb3B0aW9uYWwgYW5kIHNo
YWxsIG9ubHkgYmUgaW1wbGVtZW50ZWQgYnkgYnJpZGdlcworCSAqIHRoYXQgc3VwcG9ydCBob3Qt
cGx1ZyBub3RpZmljYXRpb24gd2l0aG91dCBwb2xsaW5nLiBCcmlkZ2VzIHRoYXQKKwkgKiBpbXBs
ZW1lbnQgaXQgc2hhbGwgYWxzbyBpbXBsZW1lbnQgdGhlIEBocGRfZGlzYWJsZSBjYWxsYmFjayBh
bmQgc2V0CisJICogdGhlIERSTV9CUklER0VfT1BfSFBEIGZsYWcgaW4gdGhlaXIgJmRybV9icmlk
Z2UtPm9wcy4KKwkgKi8KKwl2b2lkICgqaHBkX2VuYWJsZSkoc3RydWN0IGRybV9icmlkZ2UgKmJy
aWRnZSk7CisKKwkvKioKKwkgKiBAaHBkX2Rpc2FibGU6CisJICoKKwkgKiBEaXNhYmxlIGhvdCBw
bHVnIGRldGVjdGlvbi4gT25jZSB0aGlzIGZ1bmN0aW9uIHJldHVybnMgdGhlIGJyaWRnZQorCSAq
IHNoYWxsIG5vdCBjYWxsIGRybV9icmlkZ2VfaHBkX25vdGlmeSgpIHdoZW4gYSBjaGFuZ2UgaW4g
dGhlIG91dHB1dAorCSAqIGNvbm5lY3Rpb24gc3RhdHVzIG9jY3Vycy4KKwkgKgorCSAqIFRoaXMg
Y2FsbGJhY2sgaXMgb3B0aW9uYWwgYW5kIHNoYWxsIG9ubHkgYmUgaW1wbGVtZW50ZWQgYnkgYnJp
ZGdlcworCSAqIHRoYXQgc3VwcG9ydCBob3QtcGx1ZyBub3RpZmljYXRpb24gd2l0aG91dCBwb2xs
aW5nLiBCcmlkZ2VzIHRoYXQKKwkgKiBpbXBsZW1lbnQgaXQgc2hhbGwgYWxzbyBpbXBsZW1lbnQg
dGhlIEBocGRfZW5hYmxlIGNhbGxiYWNrIGFuZCBzZXQKKwkgKiB0aGUgRFJNX0JSSURHRV9PUF9I
UEQgZmxhZyBpbiB0aGVpciAmZHJtX2JyaWRnZS0+b3BzLgorCSAqLworCXZvaWQgKCpocGRfZGlz
YWJsZSkoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSk7CiB9OwogCiAvKioKQEAgLTM3Miw2ICs0
NzksMzkgQEAgc3RydWN0IGRybV9icmlkZ2VfdGltaW5ncyB7CiAJYm9vbCBkdWFsX2xpbms7CiB9
OwogCisvKioKKyAqIGVudW0gZHJtX2JyaWRnZV9vcHMgLSBCaXRtYXNrIG9mIG9wZXJhdGlvbnMg
c3VwcG9ydGVkIGJ5IHRoZSBicmlkZ2UKKyAqLworZW51bSBkcm1fYnJpZGdlX29wcyB7CisJLyoq
CisJICogQERSTV9CUklER0VfT1BfREVURUNUOiBUaGUgYnJpZGdlIGNhbiBkZXRlY3QgZGlzcGxh
eXMgY29ubmVjdGVkIHRvCisJICogaXRzIG91dHB1dC4gQnJpZGdlcyB0aGF0IHNldCB0aGlzIGZs
YWcgc2hhbGwgaW1wbGVtZW50IHRoZQorCSAqICZkcm1fYnJpZGdlX2Z1bmNzLT5kZXRlY3QgY2Fs
bGJhY2suCisJICovCisJRFJNX0JSSURHRV9PUF9ERVRFQ1QgPSBCSVQoMCksCisJLyoqCisJICog
QERSTV9CUklER0VfT1BfRURJRDogVGhlIGJyaWRnZSBjYW4gcmV0cmlldmUgdGhlIEVESUQgb2Yg
dGhlIGRpc3BsYXkKKwkgKiBjb25uZWN0ZWQgdG8gaXRzIG91dHB1dC4gQnJpZGdlcyB0aGF0IHNl
dCB0aGlzIGZsYWcgc2hhbGwgaW1wbGVtZW50CisJICogdGhlICZkcm1fYnJpZGdlX2Z1bmNzLT5n
ZXRfZWRpZCBjYWxsYmFjay4KKwkgKi8KKwlEUk1fQlJJREdFX09QX0VESUQgPSBCSVQoMSksCisJ
LyoqCisJICogQERSTV9CUklER0VfT1BfSFBEOiBUaGUgYnJpZGdlIGNhbiBkZXRlY3QgaG90LXBs
dWcgYW5kIGhvdC11bnBsdWcKKwkgKiB3aXRob3V0IHJlcXVpcmluZyBwb2xsaW5nLiBCcmlkZ2Vz
IHRoYXQgc2V0IHRoaXMgZmxhZyBzaGFsbAorCSAqIGltcGxlbWVudCB0aGUgJmRybV9icmlkZ2Vf
ZnVuY3MtPmhwZF9lbmFibGUgYW5kCisJICogJmRybV9icmlkZ2VfZnVuY3MtPmhwZF9kaXNhYmxl
IGNhbGxiYWNrcyBpZiB0aGV5IHN1cHBvcnQgZW5hYmxpbmcKKwkgKiBhbmQgZGlzYWJsaW5nIGhv
dC1wbHVnIGRldGVjdGlvbiBkeW5hbWljYWxseS4KKwkgKi8KKwlEUk1fQlJJREdFX09QX0hQRCA9
IEJJVCgyKSwKKwkvKioKKwkgKiBARFJNX0JSSURHRV9PUF9NT0RFUzogVGhlIGJyaWRnZSBjYW4g
cmV0cmlldmluZyB0aGUgbW9kZXMgc3VwcG9ydGVkCisJICogYnkgdGhlIGRpc3BsYXkgYXQgaXRz
IG91dHB1dC4gVGhpcyBkb2VzIG5vdCBpbmNsdWRlIHJlYWRpbmQgRURJRAorCSAqIHdoaWNoIGlz
IHNlcGFyYXRlbHkgY292ZXJlZCBieSBARFJNX0JSSURHRV9PUF9FRElELiBCcmlkZ2VzIHRoYXQg
c2V0CisJICogdGhpcyBmbGFnIHNoYWxsIGltcGxlbWVudCB0aGUgJmRybV9icmlkZ2VfZnVuY3Mt
PmdldF9tb2RlcyBjYWxsYmFjay4KKwkgKi8KKwlEUk1fQlJJREdFX09QX01PREVTID0gQklUKDMp
LAorfTsKKwogLyoqCiAgKiBzdHJ1Y3QgZHJtX2JyaWRnZSAtIGNlbnRyYWwgRFJNIGJyaWRnZSBj
b250cm9sIHN0cnVjdHVyZQogICovCkBAIC0zOTgsNiArNTM4LDMzIEBAIHN0cnVjdCBkcm1fYnJp
ZGdlIHsKIAljb25zdCBzdHJ1Y3QgZHJtX2JyaWRnZV9mdW5jcyAqZnVuY3M7CiAJLyoqIEBkcml2
ZXJfcHJpdmF0ZTogcG9pbnRlciB0byB0aGUgYnJpZGdlIGRyaXZlcidzIGludGVybmFsIGNvbnRl
eHQgKi8KIAl2b2lkICpkcml2ZXJfcHJpdmF0ZTsKKwkvKiogQG9wczogYml0bWFzayBvZiBvcGVy
YXRpb25zIHN1cHBvcnRlZCBieSB0aGUgYnJpZGdlICovCisJZW51bSBkcm1fYnJpZGdlX29wcyBv
cHM7CisJLyoqCisJICogQHR5cGU6IFR5cGUgb2YgdGhlIGNvbm5lY3Rpb24gYXQgdGhlIGJyaWRn
ZSBvdXRwdXQKKwkgKiAoRFJNX01PREVfQ09OTkVDVE9SXyopLiBGb3IgYnJpZGdlcyBhdCB0aGUg
ZW5kIG9mIHRoaXMgY2hhaW4gdGhpcworCSAqIGlkZW50aWZpZXMgdGhlIHR5cGUgb2YgY29ubmVj
dGVkIGRpc3BsYXkuCisJICovCisJaW50IHR5cGU7CisJLyoqCisJICogQGRkYzogQXNzb2NpYXRl
ZCBJMkMgYWRhcHRlciBmb3IgRERDIGFjY2VzcywgaWYgYW55LgorCSAqLworCXN0cnVjdCBpMmNf
YWRhcHRlciAqZGRjOworCS8qKiBwcml2YXRlOiAqLworCS8qKgorCSAqIEBocGRfbXV0ZXg6IFBy
b3RlY3RzIHRoZSBAaHBkX2NiIGFuZCBAaHBkX2RhdGEgZmllbGRzLgorCSAqLworCXN0cnVjdCBt
dXRleCBocGRfbXV0ZXg7CisJLyoqCisJICogQGhwZF9jYjogSG90IHBsdWcgZGV0ZWN0aW9uIGNh
bGxiYWNrLCByZWdpc3RlcmVkIHdpdGgKKwkgKiBkcm1fYnJpZGdlX2hwZF9lbmFibGUoKS4KKwkg
Ki8KKwl2b2lkICgqaHBkX2NiKSh2b2lkICpkYXRhLCBlbnVtIGRybV9jb25uZWN0b3Jfc3RhdHVz
IHN0YXR1cyk7CisJLyoqCisJICogQGhwZF9kYXRhOiBQcml2YXRlIGRhdGEgcGFzc2VkIHRvIHRo
ZSBIb3QgcGx1ZyBkZXRlY3Rpb24gY2FsbGJhY2sKKwkgKiBAaHBkX2NiLgorCSAqLworCXZvaWQg
KmhwZF9kYXRhOwogfTsKIAogdm9pZCBkcm1fYnJpZGdlX2FkZChzdHJ1Y3QgZHJtX2JyaWRnZSAq
YnJpZGdlKTsKQEAgLTQyOCw2ICs1OTUsMTQgQEAgdm9pZCBkcm1fYXRvbWljX2JyaWRnZV9wcmVf
ZW5hYmxlKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UsCiB2b2lkIGRybV9hdG9taWNfYnJpZGdl
X2VuYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAogCQkJICAgICAgc3RydWN0IGRybV9h
dG9taWNfc3RhdGUgKnN0YXRlKTsKIAordm9pZCBkcm1fYnJpZGdlX2hwZF9lbmFibGUoc3RydWN0
IGRybV9icmlkZ2UgKmJyaWRnZSwKKwkJCSAgIHZvaWQgKCpjYikodm9pZCAqZGF0YSwKKwkJCQkg
ICAgICBlbnVtIGRybV9jb25uZWN0b3Jfc3RhdHVzIHN0YXR1cyksCisJCQkgICB2b2lkICpkYXRh
KTsKK3ZvaWQgZHJtX2JyaWRnZV9ocGRfZGlzYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdl
KTsKK3ZvaWQgZHJtX2JyaWRnZV9ocGRfbm90aWZ5KHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2Us
CisJCQkgICBlbnVtIGRybV9jb25uZWN0b3Jfc3RhdHVzIHN0YXR1cyk7CisKICNpZmRlZiBDT05G
SUdfRFJNX1BBTkVMX0JSSURHRQogc3RydWN0IGRybV9icmlkZ2UgKmRybV9wYW5lbF9icmlkZ2Vf
YWRkKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsLAogCQkJCQl1MzIgY29ubmVjdG9yX3R5cGUpOwot
LSAKUmVnYXJkcywKCkxhdXJlbnQgUGluY2hhcnQKCl9fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxp
c3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFu
L2xpc3RpbmZvL2RyaS1kZXZlbA==
