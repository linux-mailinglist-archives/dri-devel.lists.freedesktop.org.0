Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id B4773310636
	for <lists+dri-devel@lfdr.de>; Fri,  5 Feb 2021 09:06:36 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E9DE46F406;
	Fri,  5 Feb 2021 08:06:31 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-pg1-x532.google.com (mail-pg1-x532.google.com
 [IPv6:2607:f8b0:4864:20::532])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 626946F405
 for <dri-devel@lists.freedesktop.org>; Fri,  5 Feb 2021 08:06:31 +0000 (UTC)
Received: by mail-pg1-x532.google.com with SMTP id n10so3982307pgl.10
 for <dri-devel@lists.freedesktop.org>; Fri, 05 Feb 2021 00:06:31 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=linaro.org; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=Eppkc7cbhBhkKsBh0TVfEHFBhagPwlMZuH5kYXNg9Sk=;
 b=LvkxxuZDAt3g61EzURtwZNN7B+c9BI9CcoYDAacfHmWWZaJmA/Q8ueMntoQL87InPz
 x3cic234jsbfsSUbgOlH9EphjhLyv75y5ljVcj96lD8GWTzU94A237kWBn6zXhPaZSVv
 Qxl5gI8MIE7AZ+8ju558OSalzhBAC+kamKS43qb/4rZZJCsnWqBeGMaKqEO4z6XB3UBy
 NICgSOqMmB85OIVfSU/BHZ31T9K5ZA/WU4F1VuEGj27Tm0IsEqPG/qmh1F+9RQIJlF/+
 72ItAQdnjOo4oeXkb2xUerZye6TyguzkprgbaF9p5TRXlRe/6wuok2G0jnFH6JqwoP9I
 KBsw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=Eppkc7cbhBhkKsBh0TVfEHFBhagPwlMZuH5kYXNg9Sk=;
 b=lp7XWF8LQg1qoBvM9UP1ksMdbyI3nvZ+3MOtvAY9ZIAcN1PSt8JfB9Secdnx9Hu+MP
 SGeSkChRq6R6C9oML1IB8jahweSzR4KWA6+EpnlJmQ6R8j2N3FHwLIKpok/Awt3Kucqj
 HSK+oBpeh8ET8hBnjB167FEctgJm62d2b2duqmljDeAKmf5pqpZbvPCQT+ilkD8BNHq3
 dc9SIiR23HRGwR8cYU8G42USTxbD1UiegOVjbl8gXsOp75WhHsBzK1sqz43C9BYKWM37
 Ft1GTpY7PzkDqId8xWxM/zQ634wGSV+zSKYAsOQE+DLn6l1JzY369iw21mgIuoAZiLut
 yk6A==
X-Gm-Message-State: AOAM533Xhn2iCZNcJqE3tjqerKfvQgPgQTlvrulVfY/m1cfZQjql5jgT
 gcSRTnfmeacHpLgTy06s5tHusw==
X-Google-Smtp-Source: ABdhPJx48bhhs1D3gknefKfUqkMUbp2y+z4at6TszkoS7X+/fr9erWj+jlUYkxFBhUUgi39EnSaBGA==
X-Received: by 2002:aa7:946c:0:b029:1ce:3f04:3f67 with SMTP id
 t12-20020aa7946c0000b02901ce3f043f67mr3589630pfq.6.1612512390927; 
 Fri, 05 Feb 2021 00:06:30 -0800 (PST)
Received: from localhost.localdomain ([2601:1c2:680:1319:692:26ff:feda:3a81])
 by smtp.gmail.com with ESMTPSA id
 32sm9520070pgq.80.2021.02.05.00.06.29
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 05 Feb 2021 00:06:30 -0800 (PST)
From: John Stultz <john.stultz@linaro.org>
To: lkml <linux-kernel@vger.kernel.org>
Subject: [RFC][PATCH v6 3/7] drm: ttm_pool: Rework ttm_pool_free_page to allow
 us to use it as a function pointer
Date: Fri,  5 Feb 2021 08:06:17 +0000
Message-Id: <20210205080621.3102035-4-john.stultz@linaro.org>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20210205080621.3102035-1-john.stultz@linaro.org>
References: <20210205080621.3102035-1-john.stultz@linaro.org>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: dri-devel@lists.freedesktop.org, Sandeep Patil <sspatil@google.com>,
 Ezequiel Garcia <ezequiel@collabora.com>, Robin Murphy <robin.murphy@arm.com>,
 James Jones <jajones@nvidia.com>, Liam Mark <lmark@codeaurora.org>,
 Laura Abbott <labbott@kernel.org>, Chris Goldsworthy <cgoldswo@codeaurora.org>,
 Hridya Valsaraju <hridya@google.com>,
 =?UTF-8?q?=C3=98rjan=20Eide?= <orjan.eide@arm.com>,
 linux-media@vger.kernel.org, Suren Baghdasaryan <surenb@google.com>,
 Christian Koenig <christian.koenig@amd.com>,
 Daniel Mentz <danielmentz@google.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyByZWZhY3RvcnMgdHRtX3Bvb2xfZnJlZV9wYWdlKCksIGFuZCBieSBhZGRpbmcgZXh0cmEg
ZW50cmllcwp0byB0dG1fcG9vbF9wYWdlX2RhdCwgd2UgdGhlbiB1c2UgaXQgZm9yIGFsbCBhbGxv
Y2F0aW9ucywgd2hpY2gKYWxsb3dzIHVzIHRvIHNpbXBsaWZ5IHRoZSBhcmd1bWVudHMgbmVlZGVk
IHRvIGJlIHBhc3NlZCB0bwp0dG1fcG9vbF9mcmVlX3BhZ2UoKS4KClRoaXMgaXMgY3JpdGljYWwg
Zm9yIGFsbG93aW5nIHRoZSBmcmVlIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZApieSB0aGUgc2hhcmFi
bGUgZHJtX3BhZ2VfcG9vbCBsb2dpYy4KCkNjOiBEYW5pZWwgVmV0dGVyIDxkYW5pZWxAZmZ3bGwu
Y2g+CkNjOiBDaHJpc3RpYW4gS29lbmlnIDxjaHJpc3RpYW4ua29lbmlnQGFtZC5jb20+CkNjOiBT
dW1pdCBTZW13YWwgPHN1bWl0LnNlbXdhbEBsaW5hcm8ub3JnPgpDYzogTGlhbSBNYXJrIDxsbWFy
a0Bjb2RlYXVyb3JhLm9yZz4KQ2M6IENocmlzIEdvbGRzd29ydGh5IDxjZ29sZHN3b0Bjb2RlYXVy
b3JhLm9yZz4KQ2M6IExhdXJhIEFiYm90dCA8bGFiYm90dEBrZXJuZWwub3JnPgpDYzogQnJpYW4g
U3RhcmtleSA8QnJpYW4uU3RhcmtleUBhcm0uY29tPgpDYzogSHJpZHlhIFZhbHNhcmFqdSA8aHJp
ZHlhQGdvb2dsZS5jb20+CkNjOiBTdXJlbiBCYWdoZGFzYXJ5YW4gPHN1cmVuYkBnb29nbGUuY29t
PgpDYzogU2FuZGVlcCBQYXRpbCA8c3NwYXRpbEBnb29nbGUuY29tPgpDYzogRGFuaWVsIE1lbnR6
IDxkYW5pZWxtZW50ekBnb29nbGUuY29tPgpDYzogw5hyamFuIEVpZGUgPG9yamFuLmVpZGVAYXJt
LmNvbT4KQ2M6IFJvYmluIE11cnBoeSA8cm9iaW4ubXVycGh5QGFybS5jb20+CkNjOiBFemVxdWll
bCBHYXJjaWEgPGV6ZXF1aWVsQGNvbGxhYm9yYS5jb20+CkNjOiBTaW1vbiBTZXIgPGNvbnRhY3RA
ZW1lcnNpb24uZnI+CkNjOiBKYW1lcyBKb25lcyA8amFqb25lc0BudmlkaWEuY29tPgpDYzogbGlu
dXgtbWVkaWFAdmdlci5rZXJuZWwub3JnCkNjOiBkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Au
b3JnClNpZ25lZC1vZmYtYnk6IEpvaG4gU3R1bHR6IDxqb2huLnN0dWx0ekBsaW5hcm8ub3JnPgot
LS0KIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3Bvb2wuYyB8IDYwICsrKysrKysrKysrKysrKysr
Ky0tLS0tLS0tLS0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCAzMiBpbnNlcnRpb25zKCspLCAyOCBk
ZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9wb29sLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9wb29sLmMKaW5kZXggYzAyNzRlMjU2YmUzLi5lY2Ez
NjY3OGY5NjcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3Bvb2wuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9wb29sLmMKQEAgLTQ0LDEwICs0NCwxNCBAQAogLyoq
CiAgKiBzdHJ1Y3QgdHRtX3Bvb2xfcGFnZV9kYXQgLSBIZWxwZXIgb2JqZWN0IGZvciBjb2hlcmVu
dCBETUEgbWFwcGluZ3MKICAqCisgKiBAcG9vbDogdHRtX3Bvb2wgcG9pbnRlciB0aGUgcGFnZSB3
YXMgYWxsb2NhdGVkIGJ5CisgKiBAY2FjaGluZzogdGhlIGNhY2hpbmcgdmFsdWUgdGhlIGFsbG9j
YXRlZCBwYWdlIHdhcyBjb25maWd1cmVkIGZvcgogICogQGFkZHI6IG9yaWdpbmFsIERNQSBhZGRy
ZXNzIHJldHVybmVkIGZvciB0aGUgbWFwcGluZwogICogQHZhZGRyOiBvcmlnaW5hbCB2YWRkciBy
ZXR1cm4gZm9yIHRoZSBtYXBwaW5nIGFuZCBvcmRlciBpbiB0aGUgbG93ZXIgYml0cwogICovCiBz
dHJ1Y3QgdHRtX3Bvb2xfcGFnZV9kYXQgeworCXN0cnVjdCB0dG1fcG9vbCAqcG9vbDsKKwllbnVt
IHR0bV9jYWNoaW5nIGNhY2hpbmc7CiAJZG1hX2FkZHJfdCBhZGRyOwogCXVuc2lnbmVkIGxvbmcg
dmFkZHI7CiB9OwpAQCAtNzEsMTMgKzc1LDIwIEBAIHN0YXRpYyBzdHJ1Y3Qgc2hyaW5rZXIgbW1f
c2hyaW5rZXI7CiAKIC8qIEFsbG9jYXRlIHBhZ2VzIG9mIHNpemUgMSA8PCBvcmRlciB3aXRoIHRo
ZSBnaXZlbiBnZnBfZmxhZ3MgKi8KIHN0YXRpYyBzdHJ1Y3QgcGFnZSAqdHRtX3Bvb2xfYWxsb2Nf
cGFnZShzdHJ1Y3QgdHRtX3Bvb2wgKnBvb2wsIGdmcF90IGdmcF9mbGFncywKLQkJCQkJdW5zaWdu
ZWQgaW50IG9yZGVyKQorCQkJCQl1bnNpZ25lZCBpbnQgb3JkZXIsIGVudW0gdHRtX2NhY2hpbmcg
Y2FjaGluZykKIHsKIAl1bnNpZ25lZCBsb25nIGF0dHIgPSBETUFfQVRUUl9GT1JDRV9DT05USUdV
T1VTOwogCXN0cnVjdCB0dG1fcG9vbF9wYWdlX2RhdCAqZGF0OwogCXN0cnVjdCBwYWdlICpwOwog
CXZvaWQgKnZhZGRyOwogCisJZGF0ID0ga21hbGxvYyhzaXplb2YoKmRhdCksIEdGUF9LRVJORUwp
OworCWlmICghZGF0KQorCQlyZXR1cm4gTlVMTDsKKworCWRhdC0+cG9vbCA9IHBvb2w7CisJZGF0
LT5jYWNoaW5nID0gY2FjaGluZzsKKwogCS8qIERvbid0IHNldCB0aGUgX19HRlBfQ09NUCBmbGFn
IGZvciBoaWdoZXIgb3JkZXIgYWxsb2NhdGlvbnMuCiAJICogTWFwcGluZyBwYWdlcyBkaXJlY3Rs
eSBpbnRvIGFuIHVzZXJzcGFjZSBwcm9jZXNzIGFuZCBjYWxsaW5nCiAJICogcHV0X3BhZ2UoKSBv
biBhIFRUTSBhbGxvY2F0ZWQgcGFnZSBpcyBpbGxlZ2FsLgpAQCAtODgsMTUgKzk5LDEzIEBAIHN0
YXRpYyBzdHJ1Y3QgcGFnZSAqdHRtX3Bvb2xfYWxsb2NfcGFnZShzdHJ1Y3QgdHRtX3Bvb2wgKnBv
b2wsIGdmcF90IGdmcF9mbGFncywKIAogCWlmICghcG9vbC0+dXNlX2RtYV9hbGxvYykgewogCQlw
ID0gYWxsb2NfcGFnZXMoZ2ZwX2ZsYWdzLCBvcmRlcik7Ci0JCWlmIChwKQotCQkJcC0+cHJpdmF0
ZSA9IG9yZGVyOworCQlpZiAoIXApCisJCQlnb3RvIGVycm9yX2ZyZWU7CisJCWRhdC0+dmFkZHIg
PSBvcmRlcjsKKwkJcC0+cHJpdmF0ZSA9ICh1bnNpZ25lZCBsb25nKWRhdDsKIAkJcmV0dXJuIHA7
CiAJfQogCi0JZGF0ID0ga21hbGxvYyhzaXplb2YoKmRhdCksIEdGUF9LRVJORUwpOwotCWlmICgh
ZGF0KQotCQlyZXR1cm4gTlVMTDsKLQogCWlmIChvcmRlcikKIAkJYXR0ciB8PSBETUFfQVRUUl9O
T19XQVJOOwogCkBAIC0xMjMsMzQgKzEzMiwzNCBAQCBzdGF0aWMgc3RydWN0IHBhZ2UgKnR0bV9w
b29sX2FsbG9jX3BhZ2Uoc3RydWN0IHR0bV9wb29sICpwb29sLCBnZnBfdCBnZnBfZmxhZ3MsCiB9
CiAKIC8qIFJlc2V0IHRoZSBjYWNoaW5nIGFuZCBwYWdlcyBvZiBzaXplIDEgPDwgb3JkZXIgKi8K
LXN0YXRpYyB2b2lkIHR0bV9wb29sX2ZyZWVfcGFnZShzdHJ1Y3QgdHRtX3Bvb2wgKnBvb2wsIGVu
dW0gdHRtX2NhY2hpbmcgY2FjaGluZywKLQkJCSAgICAgICB1bnNpZ25lZCBpbnQgb3JkZXIsIHN0
cnVjdCBwYWdlICpwKQorc3RhdGljIGludCB0dG1fcG9vbF9mcmVlX3BhZ2Uoc3RydWN0IHBhZ2Ug
KnAsIHVuc2lnbmVkIGludCBvcmRlcikKIHsKIAl1bnNpZ25lZCBsb25nIGF0dHIgPSBETUFfQVRU
Ul9GT1JDRV9DT05USUdVT1VTOwotCXN0cnVjdCB0dG1fcG9vbF9wYWdlX2RhdCAqZGF0OworCXN0
cnVjdCB0dG1fcG9vbF9wYWdlX2RhdCAqZGF0ID0gKHZvaWQgKilwLT5wcml2YXRlOwogCXZvaWQg
KnZhZGRyOwogCiAjaWZkZWYgQ09ORklHX1g4NgogCS8qIFdlIGRvbid0IGNhcmUgdGhhdCBzZXRf
cGFnZXNfd2IgaXMgaW5lZmZpY2llbnQgaGVyZS4gVGhpcyBpcyBvbmx5CiAJICogdXNlZCB3aGVu
IHdlIGhhdmUgdG8gc2hyaW5rIGFuZCBDUFUgb3ZlcmhlYWQgaXMgaXJyZWxldmFudCB0aGVuLgog
CSAqLwotCWlmIChjYWNoaW5nICE9IHR0bV9jYWNoZWQgJiYgIVBhZ2VIaWdoTWVtKHApKQorCWlm
IChkYXQtPmNhY2hpbmcgIT0gdHRtX2NhY2hlZCAmJiAhUGFnZUhpZ2hNZW0ocCkpCiAJCXNldF9w
YWdlc193YihwLCAxIDw8IG9yZGVyKTsKICNlbmRpZgogCi0JaWYgKCFwb29sIHx8ICFwb29sLT51
c2VfZG1hX2FsbG9jKSB7CisJaWYgKCFkYXQtPnBvb2wgfHwgIWRhdC0+cG9vbC0+dXNlX2RtYV9h
bGxvYykgewogCQlfX2ZyZWVfcGFnZXMocCwgb3JkZXIpOwotCQlyZXR1cm47CisJCWdvdG8gb3V0
OwogCX0KIAogCWlmIChvcmRlcikKIAkJYXR0ciB8PSBETUFfQVRUUl9OT19XQVJOOwogCi0JZGF0
ID0gKHZvaWQgKilwLT5wcml2YXRlOwogCXZhZGRyID0gKHZvaWQgKikoZGF0LT52YWRkciAmIFBB
R0VfTUFTSyk7Ci0JZG1hX2ZyZWVfYXR0cnMocG9vbC0+ZGV2LCAoMVVMIDw8IG9yZGVyKSAqIFBB
R0VfU0laRSwgdmFkZHIsIGRhdC0+YWRkciwKKwlkbWFfZnJlZV9hdHRycyhkYXQtPnBvb2wtPmRl
diwgKDFVTCA8PCBvcmRlcikgKiBQQUdFX1NJWkUsIHZhZGRyLCBkYXQtPmFkZHIsCiAJCSAgICAg
ICBhdHRyKTsKK291dDoKIAlrZnJlZShkYXQpOworCXJldHVybiAxIDw8IG9yZGVyOwogfQogCiAv
KiBBcHBseSBhIG5ldyBjYWNoaW5nIHRvIGFuIGFycmF5IG9mIHBhZ2VzICovCkBAIC0yNjQsNyAr
MjczLDcgQEAgc3RhdGljIHZvaWQgdHRtX3Bvb2xfdHlwZV9maW5pKHN0cnVjdCB0dG1fcG9vbF90
eXBlICpwdCkKIAltdXRleF91bmxvY2soJnNocmlua2VyX2xvY2spOwogCiAJbGlzdF9mb3JfZWFj
aF9lbnRyeV9zYWZlKHAsIHRtcCwgJnB0LT5wYWdlcywgbHJ1KQotCQl0dG1fcG9vbF9mcmVlX3Bh
Z2UocHQtPnBvb2wsIHB0LT5jYWNoaW5nLCBwdC0+b3JkZXIsIHApOworCQl0dG1fcG9vbF9mcmVl
X3BhZ2UocCwgcHQtPm9yZGVyKTsKIH0KIAogLyogUmV0dXJuIHRoZSBwb29sX3R5cGUgdG8gdXNl
IGZvciB0aGUgZ2l2ZW4gY2FjaGluZyBhbmQgb3JkZXIgKi8KQEAgLTMwNyw3ICszMTYsNyBAQCBz
dGF0aWMgdW5zaWduZWQgaW50IHR0bV9wb29sX3Nocmluayh2b2lkKQogCiAJcCA9IHR0bV9wb29s
X3R5cGVfdGFrZShwdCk7CiAJaWYgKHApIHsKLQkJdHRtX3Bvb2xfZnJlZV9wYWdlKHB0LT5wb29s
LCBwdC0+Y2FjaGluZywgcHQtPm9yZGVyLCBwKTsKKwkJdHRtX3Bvb2xfZnJlZV9wYWdlKHAsIHB0
LT5vcmRlcik7CiAJCW51bV9mcmVlZCA9IDEgPDwgcHQtPm9yZGVyOwogCX0gZWxzZSB7CiAJCW51
bV9mcmVlZCA9IDA7CkBAIC0zMjIsMTMgKzMzMSw5IEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgdHRt
X3Bvb2xfc2hyaW5rKHZvaWQpCiAvKiBSZXR1cm4gdGhlIGFsbG9jYXRpb24gb3JkZXIgYmFzZWQg
Zm9yIGEgcGFnZSAqLwogc3RhdGljIHVuc2lnbmVkIGludCB0dG1fcG9vbF9wYWdlX29yZGVyKHN0
cnVjdCB0dG1fcG9vbCAqcG9vbCwgc3RydWN0IHBhZ2UgKnApCiB7Ci0JaWYgKHBvb2wtPnVzZV9k
bWFfYWxsb2MpIHsKLQkJc3RydWN0IHR0bV9wb29sX3BhZ2VfZGF0ICpkYXQgPSAodm9pZCAqKXAt
PnByaXZhdGU7Ci0KLQkJcmV0dXJuIGRhdC0+dmFkZHIgJiB+UEFHRV9NQVNLOwotCX0KKwlzdHJ1
Y3QgdHRtX3Bvb2xfcGFnZV9kYXQgKmRhdCA9ICh2b2lkICopcC0+cHJpdmF0ZTsKIAotCXJldHVy
biBwLT5wcml2YXRlOworCXJldHVybiBkYXQtPnZhZGRyICYgflBBR0VfTUFTSzsKIH0KIAogLyoq
CkBAIC0zNzksNyArMzg0LDcgQEAgaW50IHR0bV9wb29sX2FsbG9jKHN0cnVjdCB0dG1fcG9vbCAq
cG9vbCwgc3RydWN0IHR0bV90dCAqdHQsCiAJCWlmIChwKSB7CiAJCQlhcHBseV9jYWNoaW5nID0g
dHJ1ZTsKIAkJfSBlbHNlIHsKLQkJCXAgPSB0dG1fcG9vbF9hbGxvY19wYWdlKHBvb2wsIGdmcF9m
bGFncywgb3JkZXIpOworCQkJcCA9IHR0bV9wb29sX2FsbG9jX3BhZ2UocG9vbCwgZ2ZwX2ZsYWdz
LCBvcmRlciwgdHQtPmNhY2hpbmcpOwogCQkJaWYgKHAgJiYgUGFnZUhpZ2hNZW0ocCkpCiAJCQkJ
YXBwbHlfY2FjaGluZyA9IHRydWU7CiAJCX0KQEAgLTQyOCwxMyArNDMzLDEzIEBAIGludCB0dG1f
cG9vbF9hbGxvYyhzdHJ1Y3QgdHRtX3Bvb2wgKnBvb2wsIHN0cnVjdCB0dG1fdHQgKnR0LAogCXR0
bV9tZW1fZ2xvYmFsX2ZyZWVfcGFnZSgmdHRtX21lbV9nbG9iLCBwLCAoMSA8PCBvcmRlcikgKiBQ
QUdFX1NJWkUpOwogCiBlcnJvcl9mcmVlX3BhZ2U6Ci0JdHRtX3Bvb2xfZnJlZV9wYWdlKHBvb2ws
IHR0LT5jYWNoaW5nLCBvcmRlciwgcCk7CisJdHRtX3Bvb2xfZnJlZV9wYWdlKHAsIG9yZGVyKTsK
IAogZXJyb3JfZnJlZV9hbGw6CiAJbnVtX3BhZ2VzID0gdHQtPm51bV9wYWdlcyAtIG51bV9wYWdl
czsKIAlmb3IgKGkgPSAwOyBpIDwgbnVtX3BhZ2VzOyApIHsKIAkJb3JkZXIgPSB0dG1fcG9vbF9w
YWdlX29yZGVyKHBvb2wsIHR0LT5wYWdlc1tpXSk7Ci0JCXR0bV9wb29sX2ZyZWVfcGFnZShwb29s
LCB0dC0+Y2FjaGluZywgb3JkZXIsIHR0LT5wYWdlc1tpXSk7CisJCXR0bV9wb29sX2ZyZWVfcGFn
ZSh0dC0+cGFnZXNbaV0sIG9yZGVyKTsKIAkJaSArPSAxIDw8IG9yZGVyOwogCX0KIApAQCAtNDcw
LDggKzQ3NSw3IEBAIHZvaWQgdHRtX3Bvb2xfZnJlZShzdHJ1Y3QgdHRtX3Bvb2wgKnBvb2wsIHN0
cnVjdCB0dG1fdHQgKnR0KQogCQlpZiAocHQpCiAJCQl0dG1fcG9vbF90eXBlX2dpdmUocHQsIHR0
LT5wYWdlc1tpXSk7CiAJCWVsc2UKLQkJCXR0bV9wb29sX2ZyZWVfcGFnZShwb29sLCB0dC0+Y2Fj
aGluZywgb3JkZXIsCi0JCQkJCSAgIHR0LT5wYWdlc1tpXSk7CisJCQl0dG1fcG9vbF9mcmVlX3Bh
Z2UodHQtPnBhZ2VzW2ldLCBvcmRlcik7CiAKIAkJaSArPSBudW1fcGFnZXM7CiAJfQotLSAKMi4y
NS4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmkt
ZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6
Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWwK
