Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id BDB51114E47
	for <lists+dri-devel@lfdr.de>; Fri,  6 Dec 2019 10:43:11 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C016F6F979;
	Fri,  6 Dec 2019 09:43:08 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-lj1-x241.google.com (mail-lj1-x241.google.com
 [IPv6:2a00:1450:4864:20::241])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 487C86F98B
 for <dri-devel@lists.freedesktop.org>; Fri,  6 Dec 2019 09:43:07 +0000 (UTC)
Received: by mail-lj1-x241.google.com with SMTP id r19so6982104ljg.3
 for <dri-devel@lists.freedesktop.org>; Fri, 06 Dec 2019 01:43:07 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=SE4RenSlT5DUFqtRLib1fZomOEprcHnoGm71WhlZESc=;
 b=eXhBZNn5bVFAbYfE0SXo5QRVsIGp741EW2xQIfBFn2Gjp+Dw+sp+wOrQ1VgtOFInyq
 EoQt4EvCInILZGNlV3L9SbVtxUuSZZuCcyBCUXTNuFw0xX3kqVclM1xTQZIPE6h2s5TE
 q3yBGNGL45syfNDAw+7M/kvErQsG9m6TJPCX0Ks0eDFG+6IvMm7mFK87zV4W0KEwJlIT
 k3wL6aroguc/Wz5eal6xkfm+qHLV9TiZLs8+k63of0UNve7Bj6Ypuw2qZjUTWvBZjNE5
 KVQECLz5uXAyyK3DCqkS0wyplJGmHoCiBDR0PzDLjzWEpJr0Rp8IQ+LnID/dEqiHR05H
 VvoA==
X-Gm-Message-State: APjAAAWvH0GUeNcE+f0FHTq9Z2+ybaHI2AHqCYeozEVM5ZILSFmaeJgF
 mDvhU9ZaHTNjCf+xhJPEZdlNjGPytCc=
X-Google-Smtp-Source: APXvYqzjfW2qCrQ+XZq48PSYDX5BG4LzBMTfYzqey3/S3aFh6GDpK6i4/1e/ErBKM2xby/Z+srSESw==
X-Received: by 2002:a2e:995a:: with SMTP id r26mr8209424ljj.78.1575625385161; 
 Fri, 06 Dec 2019 01:43:05 -0800 (PST)
Received: from genomnajs.ideon.se ([85.235.10.227])
 by smtp.gmail.com with ESMTPSA id d11sm6152215lfj.3.2019.12.06.01.43.03
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 06 Dec 2019 01:43:03 -0800 (PST)
From: Linus Walleij <linus.walleij@linaro.org>
To: dri-devel@lists.freedesktop.org,
 Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
 Maxime Ripard <mripard@kernel.org>, Sean Paul <sean@poorly.run>
Subject: [PATCH] drm/gma500: Pass GPIO for Intel MID using descriptors
Date: Fri,  6 Dec 2019 10:43:01 +0100
Message-Id: <20191206094301.76368-1-linus.walleij@linaro.org>
X-Mailer: git-send-email 2.23.0
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=linaro.org; s=google;
 h=from:to:cc:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=SE4RenSlT5DUFqtRLib1fZomOEprcHnoGm71WhlZESc=;
 b=RtClRhVsZMheMJd44Typ8ci8MBVI9/BfIQyShw8fpGiafyjLBuhwl3gSwiOIkz2pbE
 qBPGKsO9KDVDOe3xZXQJTpxqfvkpwx8hsqICckZXcTn33zBP2Dx2BaXyRShv+rWCIXcz
 sxUlufMz2qMhz4HnhZ7Z0EY8yzx0hRAHoNhky+3fJKFewbbZjWXftp6PophGVrwbjYCC
 C4QXOyceiK8HfHO63LEmcfLw5af0G/oB+nx+c+aVKqWmbIShNf3PuweVYYx9z+7l3ewB
 g006suRt3qZ2IYjhsNq9dj7SJu87MRiwoYvkCB8HMX/mrzrIX06vzACFzg+MagMuM6tF
 KEnw==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Daniel Stone <daniels@collabora.com>,
 Daniel Vetter <daniel.vetter@ffwll.ch>,
 Andy Shevchenko <andriy.shevchenko@linux.intel.com>,
 linux-arm-kernel@lists.infradead.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIEdNQTUwMCBkcml2ZXIgaXMgdXNpbmcgdGhlIGxlZ2FjeSBHUElPIEFQSSB0byBmZXRjaAp0
aHJlZSBvcHRpb25hbCBkaXNwbGF5IGNvbnRyb2wgR1BJTyBsaW5lcyBmcm9tIHRoZSBTRkkKZGVz
Y3JpcHRpb24gdXNlZCBieSB0aGUgTWVkZmllbGQgcGxhdGZvcm0uCgpTd2l0Y2ggdGhpcyBvdmVy
IHRvIHVzZSBHUElPIGRlc2NyaXB0b3JzIGFuZCBkZWxldGUgdGhlCmN1c3RvbSBwbGF0Zm9ybSBk
YXRhLgoKV2UgY3JlYXRlIHRocmVlIG5ldyBzdGF0aWMgbG9jYWxzIGluIHRoZSB0YzM1ODc2eCBi
cmlkZ2UKY29kZSBidXQgaXQgaXMgaGFyZGx5IGFueSB3b3JzZSB0aGFuIHRoZSBJMkMgY2xpZW50
IHN0YXRpYwpsb2NhbCBhbHJlYWR5IHRoZXJlOiBJIHRyaWVkIGZpcnN0IHRvIG1vdmUgaXQgdG8g
dGhlIERSTQpkcml2ZXIgc3RhdGUgY29udGFpbmVyIGJ1dCB0aGVyZSBhcmUgd29ya2Fyb3VuZHMg
Zm9yCnByb2JlIG9yZGVyIGluIHRoZSBjb2RlIHNvIEkganVzdCBzdGF5ZWQgb2ZmIGl0LCBhcyB0
aGUKcmVzdWx0IGlzIHVucHJlZGljdGFibGUuCgpQZW9wbGUgd2FudGluZyB0byBkbyBhIG1vcmUg
dGhyb3J1Z2ggYW5kIHByb3BlciBjbGVhbnVwCm9mIHRoZSBHTUE1MDAgZHJpdmVyIGNhbiB3b3Jr
IG9uIHRvcCBvZiB0aGlzLCBJIGNhbid0CnNvbHZlIG11Y2ggbW9yZSBzaW5jZSBJIGRvbid0IGhh
dmUgYWNjZXNzIHRvIHRoZSBoYXJkd2FyZSwKSSBjYW4gb25seSBhdHRlbXB0IHRvIHRpZHkgdXAg
bXkgR1BJTyBjb3JuZXIuCgpDYzogUGF0cmlrIEpha29ic3NvbiA8cGF0cmlrLnIuamFrb2Jzc29u
QGdtYWlsLmNvbT4KQ2M6IERhbmllbCBTdG9uZSA8ZGFuaWVsc0Bjb2xsYWJvcmEuY29tPgpDYzog
RGFuaWVsIFZldHRlciA8ZGFuaWVsLnZldHRlckBmZndsbC5jaD4KQ2M6IEFuZHkgU2hldmNoZW5r
byA8YW5kcml5LnNoZXZjaGVua29AbGludXguaW50ZWwuY29tPgpTaWduZWQtb2ZmLWJ5OiBMaW51
cyBXYWxsZWlqIDxsaW51cy53YWxsZWlqQGxpbmFyby5vcmc+Ci0tLQpJZiBzb21lb25lIGNhbiB0
ZXN0IHRoaXMgb24gdGhlIHRhcmdldCBwbGF0Zm9ybSBJJ2QgYmUKaGFwcHkuCi0tLQogLi4uL2lu
dGVsLW1pZC9kZXZpY2VfbGlicy9wbGF0Zm9ybV90YzM1ODc2eC5jIHwgMjYgKysrKy0tCiBkcml2
ZXJzL2dwdS9kcm0vZ21hNTAwL3RjMzU4NzZ4LWRzaS1sdmRzLmMgICAgfCA4OCArKysrKysrLS0t
LS0tLS0tLS0tCiBpbmNsdWRlL2xpbnV4L3BsYXRmb3JtX2RhdGEvdGMzNTg3NnguaCAgICAgICAg
fCAxMSAtLS0KIDMgZmlsZXMgY2hhbmdlZCwgNTEgaW5zZXJ0aW9ucygrKSwgNzQgZGVsZXRpb25z
KC0pCiBkZWxldGUgbW9kZSAxMDA2NDQgaW5jbHVkZS9saW51eC9wbGF0Zm9ybV9kYXRhL3RjMzU4
NzZ4LmgKCmRpZmYgLS1naXQgYS9hcmNoL3g4Ni9wbGF0Zm9ybS9pbnRlbC1taWQvZGV2aWNlX2xp
YnMvcGxhdGZvcm1fdGMzNTg3NnguYyBiL2FyY2gveDg2L3BsYXRmb3JtL2ludGVsLW1pZC9kZXZp
Y2VfbGlicy9wbGF0Zm9ybV90YzM1ODc2eC5jCmluZGV4IDQ0ZDFmODg0YzNkMy4uMTM5NzM4YmJk
ZDM2IDEwMDY0NAotLS0gYS9hcmNoL3g4Ni9wbGF0Zm9ybS9pbnRlbC1taWQvZGV2aWNlX2xpYnMv
cGxhdGZvcm1fdGMzNTg3NnguYworKysgYi9hcmNoL3g4Ni9wbGF0Zm9ybS9pbnRlbC1taWQvZGV2
aWNlX2xpYnMvcGxhdGZvcm1fdGMzNTg3NnguYwpAQCAtNiwyMSArNiwzMSBAQAogICogQXV0aG9y
OiBTYXRoeWFuYXJheWFuYW4gS3VwcHVzd2FteSA8c2F0aHlhbmFyYXlhbmFuLmt1cHB1c3dhbXlA
aW50ZWwuY29tPgogICovCiAKLSNpbmNsdWRlIDxsaW51eC9ncGlvLmg+Ci0jaW5jbHVkZSA8bGlu
dXgvcGxhdGZvcm1fZGF0YS90YzM1ODc2eC5oPgorI2luY2x1ZGUgPGxpbnV4L2dwaW8vbWFjaGlu
ZS5oPgogI2luY2x1ZGUgPGFzbS9pbnRlbC1taWQuaD4KIAorc3RhdGljIHN0cnVjdCBncGlvZF9s
b29rdXBfdGFibGUgdGMzNTg3NnhfZ3Bpb190YWJsZSA9IHsKKwkuZGV2X2lkCT0gImkyY19kaXNw
X2JyaWciLAorCS50YWJsZQk9IHsKKwkJR1BJT19MT09LVVAoIjAwMDA6MDA6MGMuMCIsIC0xLCAi
YnJpZGdlLXJlc2V0IiwgR1BJT19BQ1RJVkVfSElHSCksCisJCUdQSU9fTE9PS1VQKCIwMDAwOjAw
OjBjLjAiLCAtMSwgImJsLWVuIiwgR1BJT19BQ1RJVkVfSElHSCksCisJCUdQSU9fTE9PS1VQKCIw
MDAwOjAwOjBjLjAiLCAtMSwgInZhZGQiLCBHUElPX0FDVElWRV9ISUdIKSwKKwkJeyB9LAorCX0s
Cit9OworCiAvKnRjMzU4NzZ4IERTSV9MVkRTIGJyaWRnZSBjaGlwIGFuZCBwYW5lbCBwbGF0Zm9y
bSBkYXRhKi8KIHN0YXRpYyB2b2lkICp0YzM1ODc2eF9wbGF0Zm9ybV9kYXRhKHZvaWQgKmRhdGEp
CiB7Ci0Jc3RhdGljIHN0cnVjdCB0YzM1ODc2eF9wbGF0Zm9ybV9kYXRhIHBkYXRhOworCXN0cnVj
dCBncGlvZF9sb29rdXBfdGFibGUgKnRhYmxlID0gJnRjMzU4NzZ4X2dwaW9fdGFibGU7CisJc3Ry
dWN0IGdwaW9kX2xvb2t1cCAqbG9va3VwID0gdGFibGUtPnRhYmxlOwogCi0JLyogZ3BpbyBwaW5z
IHNldCB0byAtMSB3aWxsIG5vdCBiZSB1c2VkIGJ5IHRoZSBkcml2ZXIgKi8KLQlwZGF0YS5ncGlv
X2JyaWRnZV9yZXNldCA9IGdldF9ncGlvX2J5X25hbWUoIkxDTUJfUlhFTiIpOwotCXBkYXRhLmdw
aW9fcGFuZWxfYmxfZW4gPSBnZXRfZ3Bpb19ieV9uYW1lKCI2UzZQX0JMX0VOIik7Ci0JcGRhdGEu
Z3Bpb19wYW5lbF92YWRkID0gZ2V0X2dwaW9fYnlfbmFtZSgiRU5fVlJFR19MQ0RfVjNQMyIpOwor
CWxvb2t1cFswXS5jaGlwX2h3bnVtID0gZ2V0X2dwaW9fYnlfbmFtZSgiTENNQl9SWEVOIik7CisJ
bG9va3VwWzFdLmNoaXBfaHdudW0gPSBnZXRfZ3Bpb19ieV9uYW1lKCI2UzZQX0JMX0VOIik7CisJ
bG9va3VwWzJdLmNoaXBfaHdudW0gPSBnZXRfZ3Bpb19ieV9uYW1lKCJFTl9WUkVHX0xDRF9WM1Az
Iik7CisJZ3Bpb2RfYWRkX2xvb2t1cF90YWJsZSh0YWJsZSk7CiAKLQlyZXR1cm4gJnBkYXRhOwor
CXJldHVybiBOVUxMOwogfQogCiBzdGF0aWMgY29uc3Qgc3RydWN0IGRldnNfaWQgdGMzNTg3Nnhf
ZGV2X2lkIF9faW5pdGNvbnN0ID0gewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2dtYTUw
MC90YzM1ODc2eC1kc2ktbHZkcy5jIGIvZHJpdmVycy9ncHUvZHJtL2dtYTUwMC90YzM1ODc2eC1k
c2ktbHZkcy5jCmluZGV4IDdkZTNjZTYzN2M3Zi4uOWU4MjI0NDU2ZWEyIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vZ21hNTAwL3RjMzU4NzZ4LWRzaS1sdmRzLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2dtYTUwMC90YzM1ODc2eC1kc2ktbHZkcy5jCkBAIC0yNSw3ICsyNSw3IEBACiAjaW5j
bHVkZSA8bGludXgvZGVsYXkuaD4KICNpbmNsdWRlIDxsaW51eC9rZXJuZWwuaD4KICNpbmNsdWRl
IDxsaW51eC9tb2R1bGUuaD4KLSNpbmNsdWRlIDxsaW51eC9wbGF0Zm9ybV9kYXRhL3RjMzU4NzZ4
Lmg+CisjaW5jbHVkZSA8bGludXgvZ3Bpby9jb25zdW1lci5oPgogCiAjaW5jbHVkZSA8YXNtL2lu
dGVsX3NjdV9pcGMuaD4KIApAQCAtMzYsNiArMzYsMTEgQEAKIAogc3RhdGljIHN0cnVjdCBpMmNf
Y2xpZW50ICp0YzM1ODc2eF9jbGllbnQ7CiBzdGF0aWMgc3RydWN0IGkyY19jbGllbnQgKmNtaV9s
Y2RfaTJjX2NsaWVudDsKKy8qIFBhbmVsIEdQSU9zICovCitzdGF0aWMgc3RydWN0IGdwaW9fZGVz
YyAqYnJpZGdlX3Jlc2V0Oworc3RhdGljIHN0cnVjdCBncGlvX2Rlc2MgKmJyaWRnZV9ibF9lbmFi
bGU7CitzdGF0aWMgc3RydWN0IGdwaW9fZGVzYyAqYmFja2xpZ2h0X3ZvbHRhZ2U7CisKIAogI2Rl
ZmluZSBGTERfTUFTSyhzdGFydCwgZW5kKQkoKCgxIDw8ICgoc3RhcnQpIC0gKGVuZCkgKyAxKSkg
LSAxKSA8PCAoZW5kKSkKICNkZWZpbmUgRkxEX1ZBTCh2YWwsIHN0YXJ0LCBlbmQpICgoKHZhbCkg
PDwgKGVuZCkpICYgRkxEX01BU0soc3RhcnQsIGVuZCkpCkBAIC0zMTYsMjcgKzMyMSwyMyBAQCBz
dGF0aWMgaW50IHRjMzU4NzZ4X3JlZ3Ioc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCwgdTE2IHJl
ZywgdTMyICp2YWx1ZSkKIAogdm9pZCB0YzM1ODc2eF9zZXRfYnJpZGdlX3Jlc2V0X3N0YXRlKHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYsIGludCBzdGF0ZSkKIHsKLQlzdHJ1Y3QgdGMzNTg3NnhfcGxh
dGZvcm1fZGF0YSAqcGRhdGE7Ci0KIAlpZiAoV0FSTighdGMzNTg3NnhfY2xpZW50LCAiJXMgY2Fs
bGVkIGJlZm9yZSBwcm9iZSIsIF9fZnVuY19fKSkKIAkJcmV0dXJuOwogCiAJZGV2X2RiZygmdGMz
NTg3NnhfY2xpZW50LT5kZXYsICIlczogc3RhdGUgJWRcbiIsIF9fZnVuY19fLCBzdGF0ZSk7CiAK
LQlwZGF0YSA9IGRldl9nZXRfcGxhdGRhdGEoJnRjMzU4NzZ4X2NsaWVudC0+ZGV2KTsKLQotCWlm
IChwZGF0YS0+Z3Bpb19icmlkZ2VfcmVzZXQgPT0gLTEpCisJaWYgKCFicmlkZ2VfcmVzZXQpCiAJ
CXJldHVybjsKIAogCWlmIChzdGF0ZSkgewotCQlncGlvX3NldF92YWx1ZV9jYW5zbGVlcChwZGF0
YS0+Z3Bpb19icmlkZ2VfcmVzZXQsIDApOworCQlncGlvZF9zZXRfdmFsdWVfY2Fuc2xlZXAoYnJp
ZGdlX3Jlc2V0LCAwKTsKIAkJbWRlbGF5KDEwKTsKIAl9IGVsc2UgewogCQkvKiBQdWxsIE1JUEkg
QnJpZGdlIHJlc2V0IHBpbiB0byBMb3cgKi8KLQkJZ3Bpb19zZXRfdmFsdWVfY2Fuc2xlZXAocGRh
dGEtPmdwaW9fYnJpZGdlX3Jlc2V0LCAwKTsKKwkJZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKGJy
aWRnZV9yZXNldCwgMCk7CiAJCW1kZWxheSgyMCk7CiAJCS8qIFB1bGwgTUlQSSBCcmlkZ2UgcmVz
ZXQgcGluIHRvIEhpZ2ggKi8KLQkJZ3Bpb19zZXRfdmFsdWVfY2Fuc2xlZXAocGRhdGEtPmdwaW9f
YnJpZGdlX3Jlc2V0LCAxKTsKKwkJZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKGJyaWRnZV9yZXNl
dCwgMSk7CiAJCW1kZWxheSg0MCk7CiAJfQogfQpAQCAtNTEwLDI1ICs1MTEsMjAgQEAgdm9pZCB0
YzM1ODc2eF9icmlnaHRuZXNzX2NvbnRyb2woc3RydWN0IGRybV9kZXZpY2UgKmRldiwgaW50IGxl
dmVsKQogCiB2b2lkIHRjMzU4NzZ4X3Rvc2hpYmFfYnJpZGdlX3BhbmVsX29mZihzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2KQogewotCXN0cnVjdCB0YzM1ODc2eF9wbGF0Zm9ybV9kYXRhICpwZGF0YTsK
LQogCWlmIChXQVJOKCF0YzM1ODc2eF9jbGllbnQsICIlcyBjYWxsZWQgYmVmb3JlIHByb2JlIiwg
X19mdW5jX18pKQogCQlyZXR1cm47CiAKIAlkZXZfZGJnKCZ0YzM1ODc2eF9jbGllbnQtPmRldiwg
IiVzXG4iLCBfX2Z1bmNfXyk7CiAKLQlwZGF0YSA9IGRldl9nZXRfcGxhdGRhdGEoJnRjMzU4NzZ4
X2NsaWVudC0+ZGV2KTsKLQotCWlmIChwZGF0YS0+Z3Bpb19wYW5lbF9ibF9lbiAhPSAtMSkKLQkJ
Z3Bpb19zZXRfdmFsdWVfY2Fuc2xlZXAocGRhdGEtPmdwaW9fcGFuZWxfYmxfZW4sIDApOworCWlm
IChicmlkZ2VfYmxfZW5hYmxlKQorCQlncGlvZF9zZXRfdmFsdWVfY2Fuc2xlZXAoYnJpZGdlX2Js
X2VuYWJsZSwgMCk7CiAKLQlpZiAocGRhdGEtPmdwaW9fcGFuZWxfdmFkZCAhPSAtMSkKLQkJZ3Bp
b19zZXRfdmFsdWVfY2Fuc2xlZXAocGRhdGEtPmdwaW9fcGFuZWxfdmFkZCwgMCk7CisJaWYgKGJh
Y2tsaWdodF92b2x0YWdlKQorCQlncGlvZF9zZXRfdmFsdWVfY2Fuc2xlZXAoYmFja2xpZ2h0X3Zv
bHRhZ2UsIDApOwogfQogCiB2b2lkIHRjMzU4NzZ4X3Rvc2hpYmFfYnJpZGdlX3BhbmVsX29uKHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYpCiB7Ci0Jc3RydWN0IHRjMzU4NzZ4X3BsYXRmb3JtX2RhdGEg
KnBkYXRhOwogCXN0cnVjdCBkcm1fcHNiX3ByaXZhdGUgKmRldl9wcml2ID0gZGV2LT5kZXZfcHJp
dmF0ZTsKIAogCWlmIChXQVJOKCF0YzM1ODc2eF9jbGllbnQsICIlcyBjYWxsZWQgYmVmb3JlIHBy
b2JlIiwgX19mdW5jX18pKQpAQCAtNTM2LDEwICs1MzIsOCBAQCB2b2lkIHRjMzU4NzZ4X3Rvc2hp
YmFfYnJpZGdlX3BhbmVsX29uKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCiAKIAlkZXZfZGJnKCZ0
YzM1ODc2eF9jbGllbnQtPmRldiwgIiVzXG4iLCBfX2Z1bmNfXyk7CiAKLQlwZGF0YSA9IGRldl9n
ZXRfcGxhdGRhdGEoJnRjMzU4NzZ4X2NsaWVudC0+ZGV2KTsKLQotCWlmIChwZGF0YS0+Z3Bpb19w
YW5lbF92YWRkICE9IC0xKSB7Ci0JCWdwaW9fc2V0X3ZhbHVlX2NhbnNsZWVwKHBkYXRhLT5ncGlv
X3BhbmVsX3ZhZGQsIDEpOworCWlmIChiYWNrbGlnaHRfdm9sdGFnZSkgeworCQlncGlvZF9zZXRf
dmFsdWVfY2Fuc2xlZXAoYmFja2xpZ2h0X3ZvbHRhZ2UsIDEpOwogCQltc2xlZXAoMjYwKTsKIAl9
CiAKQEAgLTU3MSw4ICs1NjUsOCBAQCB2b2lkIHRjMzU4NzZ4X3Rvc2hpYmFfYnJpZGdlX3BhbmVs
X29uKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCiAJCQkJImkyYyB3cml0ZSBmYWlsZWQgKCVkKVxu
IiwgcmV0KTsKIAl9CiAKLQlpZiAocGRhdGEtPmdwaW9fcGFuZWxfYmxfZW4gIT0gLTEpCi0JCWdw
aW9fc2V0X3ZhbHVlX2NhbnNsZWVwKHBkYXRhLT5ncGlvX3BhbmVsX2JsX2VuLCAxKTsKKwlpZiAo
YnJpZGdlX2JsX2VuYWJsZSkKKwkJZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKGJyaWRnZV9ibF9l
bmFibGUsIDEpOwogCiAJdGMzNTg3NnhfYnJpZ2h0bmVzc19jb250cm9sKGRldiwgZGV2X3ByaXYt
PmJyaWdodG5lc3NfYWRqdXN0ZWQpOwogfQpAQCAtNjM1LDggKzYyOSw2IEBAIHN0YXRpYyBpbnQg
dGMzNTg3NnhfZ2V0X3BhbmVsX2luZm8oc3RydWN0IGRybV9kZXZpY2UgKmRldiwgaW50IHBpcGUs
CiBzdGF0aWMgaW50IHRjMzU4NzZ4X2JyaWRnZV9wcm9iZShzdHJ1Y3QgaTJjX2NsaWVudCAqY2xp
ZW50LAogCQkJCWNvbnN0IHN0cnVjdCBpMmNfZGV2aWNlX2lkICppZCkKIHsKLQlzdHJ1Y3QgdGMz
NTg3NnhfcGxhdGZvcm1fZGF0YSAqcGRhdGE7Ci0KIAlkZXZfaW5mbygmY2xpZW50LT5kZXYsICIl
c1xuIiwgX19mdW5jX18pOwogCiAJaWYgKCFpMmNfY2hlY2tfZnVuY3Rpb25hbGl0eShjbGllbnQt
PmFkYXB0ZXIsIEkyQ19GVU5DX0kyQykpIHsKQEAgLTY0NSwyNiArNjM3LDIzIEBAIHN0YXRpYyBp
bnQgdGMzNTg3NnhfYnJpZGdlX3Byb2JlKHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQsCiAJCXJl
dHVybiAtRU5PREVWOwogCX0KIAotCXBkYXRhID0gZGV2X2dldF9wbGF0ZGF0YSgmY2xpZW50LT5k
ZXYpOwotCWlmICghcGRhdGEpIHsKLQkJZGV2X2VycigmY2xpZW50LT5kZXYsICIlczogbm8gcGxh
dGZvcm0gZGF0YVxuIiwgX19mdW5jX18pOwotCQlyZXR1cm4gLUVOT0RFVjsKLQl9CisJYnJpZGdl
X3Jlc2V0ID0gZGV2bV9ncGlvZF9nZXRfb3B0aW9uYWwoJmNsaWVudC0+ZGV2LCAiYnJpZGdlLXJl
c2V0IiwgR1BJT0RfT1VUX0xPVyk7CisJaWYgKElTX0VSUihicmlkZ2VfcmVzZXQpKQorCQlyZXR1
cm4gUFRSX0VSUihicmlkZ2VfcmVzZXQpOworCWlmIChicmlkZ2VfcmVzZXQpCisJCWdwaW9kX3Nl
dF9jb25zdW1lcl9uYW1lKGJyaWRnZV9yZXNldCwgInRjMzU4NzZ4IGJyaWRnZSByZXNldCIpOwog
Ci0JaWYgKHBkYXRhLT5ncGlvX2JyaWRnZV9yZXNldCAhPSAtMSkgewotCQlncGlvX3JlcXVlc3Qo
cGRhdGEtPmdwaW9fYnJpZGdlX3Jlc2V0LCAidGMzNTg3NnggYnJpZGdlIHJlc2V0Iik7Ci0JCWdw
aW9fZGlyZWN0aW9uX291dHB1dChwZGF0YS0+Z3Bpb19icmlkZ2VfcmVzZXQsIDApOwotCX0KLQot
CWlmIChwZGF0YS0+Z3Bpb19wYW5lbF9ibF9lbiAhPSAtMSkgewotCQlncGlvX3JlcXVlc3QocGRh
dGEtPmdwaW9fcGFuZWxfYmxfZW4sICJ0YzM1ODc2eCBwYW5lbCBibCBlbiIpOwotCQlncGlvX2Rp
cmVjdGlvbl9vdXRwdXQocGRhdGEtPmdwaW9fcGFuZWxfYmxfZW4sIDApOwotCX0KKwlicmlkZ2Vf
YmxfZW5hYmxlID0gZGV2bV9ncGlvZF9nZXRfb3B0aW9uYWwoJmNsaWVudC0+ZGV2LCAiYmwtZW4i
LCBHUElPRF9PVVRfTE9XKTsKKwlpZiAoSVNfRVJSKGJyaWRnZV9ibF9lbmFibGUpKQorCQlyZXR1
cm4gUFRSX0VSUihicmlkZ2VfYmxfZW5hYmxlKTsKKwlpZiAoYnJpZGdlX2JsX2VuYWJsZSkKKwkJ
Z3Bpb2Rfc2V0X2NvbnN1bWVyX25hbWUoYnJpZGdlX2JsX2VuYWJsZSwgInRjMzU4NzZ4IHBhbmVs
IGJsIGVuIik7CiAKLQlpZiAocGRhdGEtPmdwaW9fcGFuZWxfdmFkZCAhPSAtMSkgewotCQlncGlv
X3JlcXVlc3QocGRhdGEtPmdwaW9fcGFuZWxfdmFkZCwgInRjMzU4NzZ4IHBhbmVsIHZhZGQiKTsK
LQkJZ3Bpb19kaXJlY3Rpb25fb3V0cHV0KHBkYXRhLT5ncGlvX3BhbmVsX3ZhZGQsIDApOwotCX0K
KwliYWNrbGlnaHRfdm9sdGFnZSA9IGRldm1fZ3Bpb2RfZ2V0X29wdGlvbmFsKCZjbGllbnQtPmRl
diwgInZhZGQiLCBHUElPRF9PVVRfTE9XKTsKKwlpZiAoSVNfRVJSKGJhY2tsaWdodF92b2x0YWdl
KSkKKwkJcmV0dXJuIFBUUl9FUlIoYmFja2xpZ2h0X3ZvbHRhZ2UpOworCWlmIChiYWNrbGlnaHRf
dm9sdGFnZSkKKwkJZ3Bpb2Rfc2V0X2NvbnN1bWVyX25hbWUoYmFja2xpZ2h0X3ZvbHRhZ2UsICJ0
YzM1ODc2eCBwYW5lbCB2YWRkIik7CiAKIAl0YzM1ODc2eF9jbGllbnQgPSBjbGllbnQ7CiAKQEAg
LTY3MywxOSArNjYyLDggQEAgc3RhdGljIGludCB0YzM1ODc2eF9icmlkZ2VfcHJvYmUoc3RydWN0
IGkyY19jbGllbnQgKmNsaWVudCwKIAogc3RhdGljIGludCB0YzM1ODc2eF9icmlkZ2VfcmVtb3Zl
KHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQpCiB7Ci0Jc3RydWN0IHRjMzU4NzZ4X3BsYXRmb3Jt
X2RhdGEgKnBkYXRhID0gZGV2X2dldF9wbGF0ZGF0YSgmY2xpZW50LT5kZXYpOwotCiAJZGV2X2Ri
ZygmY2xpZW50LT5kZXYsICIlc1xuIiwgX19mdW5jX18pOwogCi0JaWYgKHBkYXRhLT5ncGlvX2Jy
aWRnZV9yZXNldCAhPSAtMSkKLQkJZ3Bpb19mcmVlKHBkYXRhLT5ncGlvX2JyaWRnZV9yZXNldCk7
Ci0KLQlpZiAocGRhdGEtPmdwaW9fcGFuZWxfYmxfZW4gIT0gLTEpCi0JCWdwaW9fZnJlZShwZGF0
YS0+Z3Bpb19wYW5lbF9ibF9lbik7Ci0KLQlpZiAocGRhdGEtPmdwaW9fcGFuZWxfdmFkZCAhPSAt
MSkKLQkJZ3Bpb19mcmVlKHBkYXRhLT5ncGlvX3BhbmVsX3ZhZGQpOwotCiAJdGMzNTg3NnhfY2xp
ZW50ID0gTlVMTDsKIAogCXJldHVybiAwOwpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC9wbGF0
Zm9ybV9kYXRhL3RjMzU4NzZ4LmggYi9pbmNsdWRlL2xpbnV4L3BsYXRmb3JtX2RhdGEvdGMzNTg3
NnguaApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggY2Q2YTUxYzcxZTdlLi4wMDAwMDAw
MDAwMDAKLS0tIGEvaW5jbHVkZS9saW51eC9wbGF0Zm9ybV9kYXRhL3RjMzU4NzZ4LmgKKysrIC9k
ZXYvbnVsbApAQCAtMSwxMSArMCwwIEBACi0KLSNpZm5kZWYgX1RDMzU4NzZYX0gKLSNkZWZpbmUg
X1RDMzU4NzZYX0gKLQotc3RydWN0IHRjMzU4NzZ4X3BsYXRmb3JtX2RhdGEgewotCWludCBncGlv
X2JyaWRnZV9yZXNldDsKLQlpbnQgZ3Bpb19wYW5lbF9ibF9lbjsKLQlpbnQgZ3Bpb19wYW5lbF92
YWRkOwotfTsKLQotI2VuZGlmIC8qIF9UQzM1ODc2WF9IICovCi0tIAoyLjIzLjAKCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5n
IGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVk
ZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
