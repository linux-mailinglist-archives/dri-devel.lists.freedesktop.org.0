Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 7409B2796BC
	for <lists+dri-devel@lfdr.de>; Sat, 26 Sep 2020 06:25:11 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2E6006ED94;
	Sat, 26 Sep 2020 04:25:05 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-pj1-x1044.google.com (mail-pj1-x1044.google.com
 [IPv6:2607:f8b0:4864:20::1044])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8A6E86ED8E
 for <dri-devel@lists.freedesktop.org>; Sat, 26 Sep 2020 04:25:02 +0000 (UTC)
Received: by mail-pj1-x1044.google.com with SMTP id t7so492352pjd.3
 for <dri-devel@lists.freedesktop.org>; Fri, 25 Sep 2020 21:25:02 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=linaro.org; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=06XEeGHHOGK/ICro7P5tlQH3HvkQIwMvcU78rykFbzY=;
 b=zvgDh4o5Ge79q49paWYi3m66nq39k6wE7QrzuzFKjgrLCt8H6LTyl4Xw3VTyN+n9lY
 rky20HuPWlBlj+KWAX4O2GSLc8Q5OdlMwGIpopsrMZZVxaeOBONzNdNKIXPGsPKDWlwW
 5xWD+b3YsxF3/Ld8pR2QpunLtPqhxmZAbGkAepYz9x2gwNkc2yNwvU6723eJIZ6E8fLA
 hPV1S9ltYjCPplxqTslDhPUnjJOt02AAgpJvKtwqlYNuwnb8jFmPfHvU7RycoOAt/JWQ
 dC9V7Mcf9aJ6DwzrM1Hbtajy0ROoW+thxsif1+wjUq+KfX54sUSUBQoh/WCqDfF0bkpE
 73aQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=06XEeGHHOGK/ICro7P5tlQH3HvkQIwMvcU78rykFbzY=;
 b=BhDqWApW766PUjeEsyaQ+9ExKaaI+F6dA2uuNi5VGR2xpfejg4xc7IJEoLe98Y36o3
 RjFWRwD559mRf4hM8bLl+7/ncwbRcmkhUV7vvu4savAn/7KubE7a8fIB/sIBsIkFyc8S
 7niXALAwpyYNro99PAB7TRvTP5Fwya6w38sHFHqIJKhfZPa2xkLEsZm74d5Pn7j4i01y
 64TKoylUS00Teaf+0jnY/th3K/tj0pGBOFAYAHSDlxiPH8lb3/tQDaUMgRva/P5Vf3nr
 NdBh+ooCDTVBgBttd7ne4Y8ez7JH3KerTpsdri2MGAA4d4H+JPf4di4fthHPebEcJhLO
 yL7Q==
X-Gm-Message-State: AOAM532nHJzb0rKlJJvxkkQP03jGlRD+VOjzCEBVKTRjVfl/f2tFniqT
 JdX4sqde74NwFU0YJh2K9RBr3Q==
X-Google-Smtp-Source: ABdhPJwGMjuNMK0u01WspM91aYEUZeR21jjDkWdw78qV4eHRAn/Uu873Er9oNPryyHIHXILdP7eGZQ==
X-Received: by 2002:a17:90a:aa94:: with SMTP id
 l20mr668572pjq.95.1601094301975; 
 Fri, 25 Sep 2020 21:25:01 -0700 (PDT)
Received: from localhost.localdomain ([2601:1c2:680:1319:692:26ff:feda:3a81])
 by smtp.gmail.com with ESMTPSA id
 a5sm3585886pgk.13.2020.09.25.21.25.00
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 25 Sep 2020 21:25:01 -0700 (PDT)
From: John Stultz <john.stultz@linaro.org>
To: lkml <linux-kernel@vger.kernel.org>
Subject: [RFC][PATCH 3/6] dma-buf: heaps: Remove heap-helpers code
Date: Sat, 26 Sep 2020 04:24:50 +0000
Message-Id: <20200926042453.67517-4-john.stultz@linaro.org>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200926042453.67517-1-john.stultz@linaro.org>
References: <20200926042453.67517-1-john.stultz@linaro.org>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Sandeep Patil <sspatil@google.com>, dri-devel@lists.freedesktop.org,
 Ezequiel Garcia <ezequiel@collabora.com>, Robin Murphy <robin.murphy@arm.com>,
 James Jones <jajones@nvidia.com>, Liam Mark <lmark@codeaurora.org>,
 Laura Abbott <labbott@kernel.org>, Hridya Valsaraju <hridya@google.com>,
 =?UTF-8?q?=C3=98rjan=20Eide?= <orjan.eide@arm.com>,
 Suren Baghdasaryan <surenb@google.com>, linux-media@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIGhlYXAtaGVscGVycyBjb2RlIHdhcyBub3QgYXMgZ2VuZXJpYyBhcyBpbml0aWFsbHkgaG9w
ZWQKYW5kIGl0IGlzIG5vdyBub3QgYmVpbmcgdXNlZCwgc28gcmVtb3ZlIGl0IGZyb20gdGhlIHRy
ZWUuCgpDYzogU3VtaXQgU2Vtd2FsIDxzdW1pdC5zZW13YWxAbGluYXJvLm9yZz4KQ2M6IExpYW0g
TWFyayA8bG1hcmtAY29kZWF1cm9yYS5vcmc+CkNjOiBMYXVyYSBBYmJvdHQgPGxhYmJvdHRAa2Vy
bmVsLm9yZz4KQ2M6IEJyaWFuIFN0YXJrZXkgPEJyaWFuLlN0YXJrZXlAYXJtLmNvbT4KQ2M6IEhy
aWR5YSBWYWxzYXJhanUgPGhyaWR5YUBnb29nbGUuY29tPgpDYzogU3VyZW4gQmFnaGRhc2FyeWFu
IDxzdXJlbmJAZ29vZ2xlLmNvbT4KQ2M6IFNhbmRlZXAgUGF0aWwgPHNzcGF0aWxAZ29vZ2xlLmNv
bT4KQ2M6IMOYcmphbiBFaWRlIDxvcmphbi5laWRlQGFybS5jb20+CkNjOiBSb2JpbiBNdXJwaHkg
PHJvYmluLm11cnBoeUBhcm0uY29tPgpDYzogRXplcXVpZWwgR2FyY2lhIDxlemVxdWllbEBjb2xs
YWJvcmEuY29tPgpDYzogU2ltb24gU2VyIDxjb250YWN0QGVtZXJzaW9uLmZyPgpDYzogSmFtZXMg
Sm9uZXMgPGpham9uZXNAbnZpZGlhLmNvbT4KQ2M6IGxpbnV4LW1lZGlhQHZnZXIua2VybmVsLm9y
ZwpDYzogZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpTaWduZWQtb2ZmLWJ5OiBKb2hu
IFN0dWx0eiA8am9obi5zdHVsdHpAbGluYXJvLm9yZz4KLS0tCiBkcml2ZXJzL2RtYS1idWYvaGVh
cHMvTWFrZWZpbGUgICAgICAgfCAgIDEgLQogZHJpdmVycy9kbWEtYnVmL2hlYXBzL2hlYXAtaGVs
cGVycy5jIHwgMjcxIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogZHJpdmVycy9kbWEtYnVm
L2hlYXBzL2hlYXAtaGVscGVycy5oIHwgIDUzIC0tLS0tLQogMyBmaWxlcyBjaGFuZ2VkLCAzMjUg
ZGVsZXRpb25zKC0pCiBkZWxldGUgbW9kZSAxMDA2NDQgZHJpdmVycy9kbWEtYnVmL2hlYXBzL2hl
YXAtaGVscGVycy5jCiBkZWxldGUgbW9kZSAxMDA2NDQgZHJpdmVycy9kbWEtYnVmL2hlYXBzL2hl
YXAtaGVscGVycy5oCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9kbWEtYnVmL2hlYXBzL01ha2VmaWxl
IGIvZHJpdmVycy9kbWEtYnVmL2hlYXBzL01ha2VmaWxlCmluZGV4IDZlNTRjZGVjM2RhMC4uOTc0
NDY3NzkxMDMyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2RtYS1idWYvaGVhcHMvTWFrZWZpbGUKKysr
IGIvZHJpdmVycy9kbWEtYnVmL2hlYXBzL01ha2VmaWxlCkBAIC0xLDQgKzEsMyBAQAogIyBTUERY
LUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAotb2JqLXkJCQkJCSs9IGhlYXAtaGVscGVycy5v
CiBvYmotJChDT05GSUdfRE1BQlVGX0hFQVBTX1NZU1RFTSkJKz0gc3lzdGVtX2hlYXAubwogb2Jq
LSQoQ09ORklHX0RNQUJVRl9IRUFQU19DTUEpCQkrPSBjbWFfaGVhcC5vCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2RtYS1idWYvaGVhcHMvaGVhcC1oZWxwZXJzLmMgYi9kcml2ZXJzL2RtYS1idWYvaGVh
cHMvaGVhcC1oZWxwZXJzLmMKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDlmOTY0Y2Ez
ZjU5Yy4uMDAwMDAwMDAwMDAwCi0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9oZWFwLWhlbHBl
cnMuYworKysgL2Rldi9udWxsCkBAIC0xLDI3MSArMCwwIEBACi0vLyBTUERYLUxpY2Vuc2UtSWRl
bnRpZmllcjogR1BMLTIuMAotI2luY2x1ZGUgPGxpbnV4L2RldmljZS5oPgotI2luY2x1ZGUgPGxp
bnV4L2RtYS1idWYuaD4KLSNpbmNsdWRlIDxsaW51eC9lcnIuaD4KLSNpbmNsdWRlIDxsaW51eC9o
aWdobWVtLmg+Ci0jaW5jbHVkZSA8bGludXgvaWRyLmg+Ci0jaW5jbHVkZSA8bGludXgvbGlzdC5o
PgotI2luY2x1ZGUgPGxpbnV4L3NsYWIuaD4KLSNpbmNsdWRlIDxsaW51eC91YWNjZXNzLmg+Ci0j
aW5jbHVkZSA8bGludXgvdm1hbGxvYy5oPgotI2luY2x1ZGUgPHVhcGkvbGludXgvZG1hLWhlYXAu
aD4KLQotI2luY2x1ZGUgImhlYXAtaGVscGVycy5oIgotCi12b2lkIGluaXRfaGVhcF9oZWxwZXJf
YnVmZmVyKHN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKmJ1ZmZlciwKLQkJCSAgICAgdm9pZCAo
KmZyZWUpKHN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKikpCi17Ci0JYnVmZmVyLT5wcml2X3Zp
cnQgPSBOVUxMOwotCW11dGV4X2luaXQoJmJ1ZmZlci0+bG9jayk7Ci0JYnVmZmVyLT52bWFwX2Nu
dCA9IDA7Ci0JYnVmZmVyLT52YWRkciA9IE5VTEw7Ci0JYnVmZmVyLT5wYWdlY291bnQgPSAwOwot
CWJ1ZmZlci0+cGFnZXMgPSBOVUxMOwotCUlOSVRfTElTVF9IRUFEKCZidWZmZXItPmF0dGFjaG1l
bnRzKTsKLQlidWZmZXItPmZyZWUgPSBmcmVlOwotfQotCi1zdHJ1Y3QgZG1hX2J1ZiAqaGVhcF9o
ZWxwZXJfZXhwb3J0X2RtYWJ1ZihzdHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICpidWZmZXIsCi0J
CQkJCSAgaW50IGZkX2ZsYWdzKQotewotCURFRklORV9ETUFfQlVGX0VYUE9SVF9JTkZPKGV4cF9p
bmZvKTsKLQotCWV4cF9pbmZvLm9wcyA9ICZoZWFwX2hlbHBlcl9vcHM7Ci0JZXhwX2luZm8uc2l6
ZSA9IGJ1ZmZlci0+c2l6ZTsKLQlleHBfaW5mby5mbGFncyA9IGZkX2ZsYWdzOwotCWV4cF9pbmZv
LnByaXYgPSBidWZmZXI7Ci0KLQlyZXR1cm4gZG1hX2J1Zl9leHBvcnQoJmV4cF9pbmZvKTsKLX0K
LQotc3RhdGljIHZvaWQgKmRtYV9oZWFwX21hcF9rZXJuZWwoc3RydWN0IGhlYXBfaGVscGVyX2J1
ZmZlciAqYnVmZmVyKQotewotCXZvaWQgKnZhZGRyOwotCi0JdmFkZHIgPSB2bWFwKGJ1ZmZlci0+
cGFnZXMsIGJ1ZmZlci0+cGFnZWNvdW50LCBWTV9NQVAsIFBBR0VfS0VSTkVMKTsKLQlpZiAoIXZh
ZGRyKQotCQlyZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKLQotCXJldHVybiB2YWRkcjsKLX0KLQot
c3RhdGljIHZvaWQgZG1hX2hlYXBfYnVmZmVyX2Rlc3Ryb3koc3RydWN0IGhlYXBfaGVscGVyX2J1
ZmZlciAqYnVmZmVyKQotewotCWlmIChidWZmZXItPnZtYXBfY250ID4gMCkgewotCQlXQVJOKDEs
ICIlczogYnVmZmVyIHN0aWxsIG1hcHBlZCBpbiB0aGUga2VybmVsXG4iLCBfX2Z1bmNfXyk7Ci0J
CXZ1bm1hcChidWZmZXItPnZhZGRyKTsKLQl9Ci0KLQlidWZmZXItPmZyZWUoYnVmZmVyKTsKLX0K
LQotc3RhdGljIHZvaWQgKmRtYV9oZWFwX2J1ZmZlcl92bWFwX2dldChzdHJ1Y3QgaGVhcF9oZWxw
ZXJfYnVmZmVyICpidWZmZXIpCi17Ci0Jdm9pZCAqdmFkZHI7Ci0KLQlpZiAoYnVmZmVyLT52bWFw
X2NudCkgewotCQlidWZmZXItPnZtYXBfY250Kys7Ci0JCXJldHVybiBidWZmZXItPnZhZGRyOwot
CX0KLQl2YWRkciA9IGRtYV9oZWFwX21hcF9rZXJuZWwoYnVmZmVyKTsKLQlpZiAoSVNfRVJSKHZh
ZGRyKSkKLQkJcmV0dXJuIHZhZGRyOwotCWJ1ZmZlci0+dmFkZHIgPSB2YWRkcjsKLQlidWZmZXIt
PnZtYXBfY250Kys7Ci0JcmV0dXJuIHZhZGRyOwotfQotCi1zdGF0aWMgdm9pZCBkbWFfaGVhcF9i
dWZmZXJfdm1hcF9wdXQoc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyKQotewotCWlm
ICghLS1idWZmZXItPnZtYXBfY250KSB7Ci0JCXZ1bm1hcChidWZmZXItPnZhZGRyKTsKLQkJYnVm
ZmVyLT52YWRkciA9IE5VTEw7Ci0JfQotfQotCi1zdHJ1Y3QgZG1hX2hlYXBzX2F0dGFjaG1lbnQg
ewotCXN0cnVjdCBkZXZpY2UgKmRldjsKLQlzdHJ1Y3Qgc2dfdGFibGUgdGFibGU7Ci0Jc3RydWN0
IGxpc3RfaGVhZCBsaXN0OwotfTsKLQotc3RhdGljIGludCBkbWFfaGVhcF9hdHRhY2goc3RydWN0
IGRtYV9idWYgKmRtYWJ1ZiwKLQkJCSAgIHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFj
aG1lbnQpCi17Ci0Jc3RydWN0IGRtYV9oZWFwc19hdHRhY2htZW50ICphOwotCXN0cnVjdCBoZWFw
X2hlbHBlcl9idWZmZXIgKmJ1ZmZlciA9IGRtYWJ1Zi0+cHJpdjsKLQlpbnQgcmV0OwotCi0JYSA9
IGt6YWxsb2Moc2l6ZW9mKCphKSwgR0ZQX0tFUk5FTCk7Ci0JaWYgKCFhKQotCQlyZXR1cm4gLUVO
T01FTTsKLQotCXJldCA9IHNnX2FsbG9jX3RhYmxlX2Zyb21fcGFnZXMoJmEtPnRhYmxlLCBidWZm
ZXItPnBhZ2VzLAotCQkJCQlidWZmZXItPnBhZ2Vjb3VudCwgMCwKLQkJCQkJYnVmZmVyLT5wYWdl
Y291bnQgPDwgUEFHRV9TSElGVCwKLQkJCQkJR0ZQX0tFUk5FTCk7Ci0JaWYgKHJldCkgewotCQlr
ZnJlZShhKTsKLQkJcmV0dXJuIHJldDsKLQl9Ci0KLQlhLT5kZXYgPSBhdHRhY2htZW50LT5kZXY7
Ci0JSU5JVF9MSVNUX0hFQUQoJmEtPmxpc3QpOwotCi0JYXR0YWNobWVudC0+cHJpdiA9IGE7Ci0K
LQltdXRleF9sb2NrKCZidWZmZXItPmxvY2spOwotCWxpc3RfYWRkKCZhLT5saXN0LCAmYnVmZmVy
LT5hdHRhY2htZW50cyk7Ci0JbXV0ZXhfdW5sb2NrKCZidWZmZXItPmxvY2spOwotCi0JcmV0dXJu
IDA7Ci19Ci0KLXN0YXRpYyB2b2lkIGRtYV9oZWFwX2RldGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZG1h
YnVmLAotCQkJICAgIHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFjaG1lbnQpCi17Ci0J
c3RydWN0IGRtYV9oZWFwc19hdHRhY2htZW50ICphID0gYXR0YWNobWVudC0+cHJpdjsKLQlzdHJ1
Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICpidWZmZXIgPSBkbWFidWYtPnByaXY7Ci0KLQltdXRleF9s
b2NrKCZidWZmZXItPmxvY2spOwotCWxpc3RfZGVsKCZhLT5saXN0KTsKLQltdXRleF91bmxvY2so
JmJ1ZmZlci0+bG9jayk7Ci0KLQlzZ19mcmVlX3RhYmxlKCZhLT50YWJsZSk7Ci0Ja2ZyZWUoYSk7
Ci19Ci0KLXN0YXRpYwotc3RydWN0IHNnX3RhYmxlICpkbWFfaGVhcF9tYXBfZG1hX2J1ZihzdHJ1
Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICphdHRhY2htZW50LAotCQkJCSAgICAgIGVudW0gZG1hX2Rh
dGFfZGlyZWN0aW9uIGRpcmVjdGlvbikKLXsKLQlzdHJ1Y3QgZG1hX2hlYXBzX2F0dGFjaG1lbnQg
KmEgPSBhdHRhY2htZW50LT5wcml2OwotCXN0cnVjdCBzZ190YWJsZSAqdGFibGU7Ci0KLQl0YWJs
ZSA9ICZhLT50YWJsZTsKLQotCWlmICghZG1hX21hcF9zZyhhdHRhY2htZW50LT5kZXYsIHRhYmxl
LT5zZ2wsIHRhYmxlLT5uZW50cywKLQkJCWRpcmVjdGlvbikpCi0JCXRhYmxlID0gRVJSX1BUUigt
RU5PTUVNKTsKLQlyZXR1cm4gdGFibGU7Ci19Ci0KLXN0YXRpYyB2b2lkIGRtYV9oZWFwX3VubWFw
X2RtYV9idWYoc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCAqYXR0YWNobWVudCwKLQkJCQkgICBz
dHJ1Y3Qgc2dfdGFibGUgKnRhYmxlLAotCQkJCSAgIGVudW0gZG1hX2RhdGFfZGlyZWN0aW9uIGRp
cmVjdGlvbikKLXsKLQlkbWFfdW5tYXBfc2coYXR0YWNobWVudC0+ZGV2LCB0YWJsZS0+c2dsLCB0
YWJsZS0+bmVudHMsIGRpcmVjdGlvbik7Ci19Ci0KLXN0YXRpYyB2bV9mYXVsdF90IGRtYV9oZWFw
X3ZtX2ZhdWx0KHN0cnVjdCB2bV9mYXVsdCAqdm1mKQotewotCXN0cnVjdCB2bV9hcmVhX3N0cnVj
dCAqdm1hID0gdm1mLT52bWE7Ci0Jc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyID0g
dm1hLT52bV9wcml2YXRlX2RhdGE7Ci0KLQlpZiAodm1mLT5wZ29mZiA+IGJ1ZmZlci0+cGFnZWNv
dW50KQotCQlyZXR1cm4gVk1fRkFVTFRfU0lHQlVTOwotCi0Jdm1mLT5wYWdlID0gYnVmZmVyLT5w
YWdlc1t2bWYtPnBnb2ZmXTsKLQlnZXRfcGFnZSh2bWYtPnBhZ2UpOwotCi0JcmV0dXJuIDA7Ci19
Ci0KLXN0YXRpYyBjb25zdCBzdHJ1Y3Qgdm1fb3BlcmF0aW9uc19zdHJ1Y3QgZG1hX2hlYXBfdm1f
b3BzID0gewotCS5mYXVsdCA9IGRtYV9oZWFwX3ZtX2ZhdWx0LAotfTsKLQotc3RhdGljIGludCBk
bWFfaGVhcF9tbWFwKHN0cnVjdCBkbWFfYnVmICpkbWFidWYsIHN0cnVjdCB2bV9hcmVhX3N0cnVj
dCAqdm1hKQotewotCXN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKmJ1ZmZlciA9IGRtYWJ1Zi0+
cHJpdjsKLQotCWlmICgodm1hLT52bV9mbGFncyAmIChWTV9TSEFSRUQgfCBWTV9NQVlTSEFSRSkp
ID09IDApCi0JCXJldHVybiAtRUlOVkFMOwotCi0Jdm1hLT52bV9vcHMgPSAmZG1hX2hlYXBfdm1f
b3BzOwotCXZtYS0+dm1fcHJpdmF0ZV9kYXRhID0gYnVmZmVyOwotCi0JcmV0dXJuIDA7Ci19Ci0K
LXN0YXRpYyB2b2lkIGRtYV9oZWFwX2RtYV9idWZfcmVsZWFzZShzdHJ1Y3QgZG1hX2J1ZiAqZG1h
YnVmKQotewotCXN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKmJ1ZmZlciA9IGRtYWJ1Zi0+cHJp
djsKLQotCWRtYV9oZWFwX2J1ZmZlcl9kZXN0cm95KGJ1ZmZlcik7Ci19Ci0KLXN0YXRpYyBpbnQg
ZG1hX2hlYXBfZG1hX2J1Zl9iZWdpbl9jcHVfYWNjZXNzKHN0cnVjdCBkbWFfYnVmICpkbWFidWYs
Ci0JCQkJCSAgICAgZW51bSBkbWFfZGF0YV9kaXJlY3Rpb24gZGlyZWN0aW9uKQotewotCXN0cnVj
dCBoZWFwX2hlbHBlcl9idWZmZXIgKmJ1ZmZlciA9IGRtYWJ1Zi0+cHJpdjsKLQlzdHJ1Y3QgZG1h
X2hlYXBzX2F0dGFjaG1lbnQgKmE7Ci0JaW50IHJldCA9IDA7Ci0KLQltdXRleF9sb2NrKCZidWZm
ZXItPmxvY2spOwotCi0JaWYgKGJ1ZmZlci0+dm1hcF9jbnQpCi0JCWludmFsaWRhdGVfa2VybmVs
X3ZtYXBfcmFuZ2UoYnVmZmVyLT52YWRkciwgYnVmZmVyLT5zaXplKTsKLQotCWxpc3RfZm9yX2Vh
Y2hfZW50cnkoYSwgJmJ1ZmZlci0+YXR0YWNobWVudHMsIGxpc3QpIHsKLQkJZG1hX3N5bmNfc2df
Zm9yX2NwdShhLT5kZXYsIGEtPnRhYmxlLnNnbCwgYS0+dGFibGUubmVudHMsCi0JCQkJICAgIGRp
cmVjdGlvbik7Ci0JfQotCW11dGV4X3VubG9jaygmYnVmZmVyLT5sb2NrKTsKLQotCXJldHVybiBy
ZXQ7Ci19Ci0KLXN0YXRpYyBpbnQgZG1hX2hlYXBfZG1hX2J1Zl9lbmRfY3B1X2FjY2VzcyhzdHJ1
Y3QgZG1hX2J1ZiAqZG1hYnVmLAotCQkJCQkgICBlbnVtIGRtYV9kYXRhX2RpcmVjdGlvbiBkaXJl
Y3Rpb24pCi17Ci0Jc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyID0gZG1hYnVmLT5w
cml2OwotCXN0cnVjdCBkbWFfaGVhcHNfYXR0YWNobWVudCAqYTsKLQotCW11dGV4X2xvY2soJmJ1
ZmZlci0+bG9jayk7Ci0KLQlpZiAoYnVmZmVyLT52bWFwX2NudCkKLQkJZmx1c2hfa2VybmVsX3Zt
YXBfcmFuZ2UoYnVmZmVyLT52YWRkciwgYnVmZmVyLT5zaXplKTsKLQotCWxpc3RfZm9yX2VhY2hf
ZW50cnkoYSwgJmJ1ZmZlci0+YXR0YWNobWVudHMsIGxpc3QpIHsKLQkJZG1hX3N5bmNfc2dfZm9y
X2RldmljZShhLT5kZXYsIGEtPnRhYmxlLnNnbCwgYS0+dGFibGUubmVudHMsCi0JCQkJICAgICAg
IGRpcmVjdGlvbik7Ci0JfQotCW11dGV4X3VubG9jaygmYnVmZmVyLT5sb2NrKTsKLQotCXJldHVy
biAwOwotfQotCi1zdGF0aWMgdm9pZCAqZG1hX2hlYXBfZG1hX2J1Zl92bWFwKHN0cnVjdCBkbWFf
YnVmICpkbWFidWYpCi17Ci0Jc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyID0gZG1h
YnVmLT5wcml2OwotCXZvaWQgKnZhZGRyOwotCi0JbXV0ZXhfbG9jaygmYnVmZmVyLT5sb2NrKTsK
LQl2YWRkciA9IGRtYV9oZWFwX2J1ZmZlcl92bWFwX2dldChidWZmZXIpOwotCW11dGV4X3VubG9j
aygmYnVmZmVyLT5sb2NrKTsKLQotCXJldHVybiB2YWRkcjsKLX0KLQotc3RhdGljIHZvaWQgZG1h
X2hlYXBfZG1hX2J1Zl92dW5tYXAoc3RydWN0IGRtYV9idWYgKmRtYWJ1Ziwgdm9pZCAqdmFkZHIp
Ci17Ci0Jc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyID0gZG1hYnVmLT5wcml2Owot
Ci0JbXV0ZXhfbG9jaygmYnVmZmVyLT5sb2NrKTsKLQlkbWFfaGVhcF9idWZmZXJfdm1hcF9wdXQo
YnVmZmVyKTsKLQltdXRleF91bmxvY2soJmJ1ZmZlci0+bG9jayk7Ci19Ci0KLWNvbnN0IHN0cnVj
dCBkbWFfYnVmX29wcyBoZWFwX2hlbHBlcl9vcHMgPSB7Ci0JLm1hcF9kbWFfYnVmID0gZG1hX2hl
YXBfbWFwX2RtYV9idWYsCi0JLnVubWFwX2RtYV9idWYgPSBkbWFfaGVhcF91bm1hcF9kbWFfYnVm
LAotCS5tbWFwID0gZG1hX2hlYXBfbW1hcCwKLQkucmVsZWFzZSA9IGRtYV9oZWFwX2RtYV9idWZf
cmVsZWFzZSwKLQkuYXR0YWNoID0gZG1hX2hlYXBfYXR0YWNoLAotCS5kZXRhY2ggPSBkbWFfaGVh
cF9kZXRhY2gsCi0JLmJlZ2luX2NwdV9hY2Nlc3MgPSBkbWFfaGVhcF9kbWFfYnVmX2JlZ2luX2Nw
dV9hY2Nlc3MsCi0JLmVuZF9jcHVfYWNjZXNzID0gZG1hX2hlYXBfZG1hX2J1Zl9lbmRfY3B1X2Fj
Y2VzcywKLQkudm1hcCA9IGRtYV9oZWFwX2RtYV9idWZfdm1hcCwKLQkudnVubWFwID0gZG1hX2hl
YXBfZG1hX2J1Zl92dW5tYXAsCi19OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9kbWEtYnVmL2hlYXBz
L2hlYXAtaGVscGVycy5oIGIvZHJpdmVycy9kbWEtYnVmL2hlYXBzL2hlYXAtaGVscGVycy5oCmRl
bGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCA4MDVkMmRmODgwMjQuLjAwMDAwMDAwMDAwMAot
LS0gYS9kcml2ZXJzL2RtYS1idWYvaGVhcHMvaGVhcC1oZWxwZXJzLmgKKysrIC9kZXYvbnVsbApA
QCAtMSw1MyArMCwwIEBACi0vKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCAqLwot
LyoKLSAqIERNQUJVRiBIZWFwcyBoZWxwZXIgY29kZQotICoKLSAqIENvcHlyaWdodCAoQykgMjAx
MSBHb29nbGUsIEluYy4KLSAqIENvcHlyaWdodCAoQykgMjAxOSBMaW5hcm8gTHRkLgotICovCi0K
LSNpZm5kZWYgX0hFQVBfSEVMUEVSU19ICi0jZGVmaW5lIF9IRUFQX0hFTFBFUlNfSAotCi0jaW5j
bHVkZSA8bGludXgvZG1hLWhlYXAuaD4KLSNpbmNsdWRlIDxsaW51eC9saXN0Lmg+Ci0KLS8qKgot
ICogc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAtIGhlbHBlciBidWZmZXIgbWV0YWRhdGEKLSAq
IEBoZWFwOgkJYmFjayBwb2ludGVyIHRvIHRoZSBoZWFwIHRoZSBidWZmZXIgY2FtZSBmcm9tCi0g
KiBAZG1hYnVmOgkJYmFja2luZyBkbWEtYnVmIGZvciB0aGlzIGJ1ZmZlcgotICogQHNpemU6CQlz
aXplIG9mIHRoZSBidWZmZXIKLSAqIEBwcml2X3ZpcnQJCXBvaW50ZXIgdG8gaGVhcCBzcGVjaWZp
YyBwcml2YXRlIHZhbHVlCi0gKiBAbG9jawkJbXV0ZXh0IHRvIHByb3RlY3QgdGhlIGRhdGEgaW4g
dGhpcyBzdHJ1Y3R1cmUKLSAqIEB2bWFwX2NudAkJY291bnQgb2Ygdm1hcCByZWZlcmVuY2VzIG9u
IHRoZSBidWZmZXIKLSAqIEB2YWRkcgkJdm1hcCdlZCB2aXJ0dWFsIGFkZHJlc3MKLSAqIEBwYWdl
Y291bnQJCW51bWJlciBvZiBwYWdlcyBpbiB0aGUgYnVmZmVyCi0gKiBAcGFnZXMJCWxpc3Qgb2Yg
cGFnZSBwb2ludGVycwotICogQGF0dGFjaG1lbnRzCQlsaXN0IG9mIGRldmljZSBhdHRhY2htZW50
cwotICoKLSAqIEBmcmVlCQloZWFwIGNhbGxiYWNrIHRvIGZyZWUgdGhlIGJ1ZmZlcgotICovCi1z
dHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVyIHsKLQlzdHJ1Y3QgZG1hX2hlYXAgKmhlYXA7Ci0Jc3Ry
dWN0IGRtYV9idWYgKmRtYWJ1ZjsKLQlzaXplX3Qgc2l6ZTsKLQotCXZvaWQgKnByaXZfdmlydDsK
LQlzdHJ1Y3QgbXV0ZXggbG9jazsKLQlpbnQgdm1hcF9jbnQ7Ci0Jdm9pZCAqdmFkZHI7Ci0JcGdv
ZmZfdCBwYWdlY291bnQ7Ci0Jc3RydWN0IHBhZ2UgKipwYWdlczsKLQlzdHJ1Y3QgbGlzdF9oZWFk
IGF0dGFjaG1lbnRzOwotCi0Jdm9pZCAoKmZyZWUpKHN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIg
KmJ1ZmZlcik7Ci19OwotCi12b2lkIGluaXRfaGVhcF9oZWxwZXJfYnVmZmVyKHN0cnVjdCBoZWFw
X2hlbHBlcl9idWZmZXIgKmJ1ZmZlciwKLQkJCSAgICAgdm9pZCAoKmZyZWUpKHN0cnVjdCBoZWFw
X2hlbHBlcl9idWZmZXIgKikpOwotCi1zdHJ1Y3QgZG1hX2J1ZiAqaGVhcF9oZWxwZXJfZXhwb3J0
X2RtYWJ1ZihzdHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICpidWZmZXIsCi0JCQkJCSAgaW50IGZk
X2ZsYWdzKTsKLQotZXh0ZXJuIGNvbnN0IHN0cnVjdCBkbWFfYnVmX29wcyBoZWFwX2hlbHBlcl9v
cHM7Ci0jZW5kaWYgLyogX0hFQVBfSEVMUEVSU19IICovCi0tIAoyLjE3LjEKCl9fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxp
c3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNr
dG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbAo=
