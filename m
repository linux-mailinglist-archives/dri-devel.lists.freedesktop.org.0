Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id BB44C6BF533
	for <lists+dri-devel@lfdr.de>; Fri, 17 Mar 2023 23:33:52 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B4D3510E2BF;
	Fri, 17 Mar 2023 22:33:45 +0000 (UTC)
X-Original-To: DRI-Devel@lists.freedesktop.org
Delivered-To: DRI-Devel@lists.freedesktop.org
Received: from mga07.intel.com (mga07.intel.com [134.134.136.100])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 08AF710E288;
 Fri, 17 Mar 2023 22:33:42 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=intel.com; i=@intel.com; q=dns/txt; s=Intel;
 t=1679092423; x=1710628423;
 h=date:message-id:from:to:cc:subject:in-reply-to:
 references:mime-version;
 bh=8l70R9GcJ6YeYTuYXe0lFe7BIOKEHLqAVwuJ5HHbu8Y=;
 b=nsEOPgYTg/aSUJC248VUbSepmRVOgrwa8U2zm9wrYDrppk6BB/fiZwUI
 u+p4O+BvrA0IRxjk83lh19ct33baLWjW2/otrUx0qEW5Bpm9+QyQQJ5p5
 6ILC/qv4pg0/0CNrQlJVlkgjhxQbcM7mMs1tcLVy2GXqRWK8Z5xK4ysnT
 /EhP2UA7te1HzhOzOfc49+DaBdHrN5dpqSmYMPJipvwaEPUOBG5asMiqC
 dPSgKH9qNpeNNKCgC8d+Rf3c5adv9qChwPjdeDIoUDUPJB6IVF72Zsjc5
 m2eliInMynkKC5N/oantJfqn1Kn1WkOL6B/izoAGqSVTSba4uv0V3Oy1W w==;
X-IronPort-AV: E=McAfee;i="6600,9927,10652"; a="403246013"
X-IronPort-AV: E=Sophos;i="5.98,270,1673942400"; d="scan'208";a="403246013"
Received: from fmsmga006.fm.intel.com ([10.253.24.20])
 by orsmga105.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 17 Mar 2023 15:33:40 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=McAfee;i="6600,9927,10652"; a="926297238"
X-IronPort-AV: E=Sophos;i="5.98,270,1673942400"; d="scan'208";a="926297238"
Received: from adixit-mobl.amr.corp.intel.com (HELO adixit-arch.intel.com)
 ([10.212.197.230])
 by fmsmga006-auth.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 17 Mar 2023 15:33:39 -0700
Date: Fri, 17 Mar 2023 15:33:39 -0700
Message-ID: <87bkkrvwho.wl-ashutosh.dixit@intel.com>
From: "Dixit, Ashutosh" <ashutosh.dixit@intel.com>
To: John.C.Harrison@Intel.com
Subject: Re: [Intel-gfx] [PATCH v2 2/2] drm/i915/guc: Allow for very slow GuC
 loading
In-Reply-To: <20230316220632.3312218-3-John.C.Harrison@Intel.com>
References: <20230316220632.3312218-1-John.C.Harrison@Intel.com>
 <20230316220632.3312218-3-John.C.Harrison@Intel.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI-EPG/1.14.7 (Harue)
 FLIM-LB/1.14.9 (=?ISO-8859-4?Q?Goj=F2?=) APEL-LB/10.8 EasyPG/1.0.0
 Emacs/28.2 (x86_64-pc-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Intel-GFX@Lists.FreeDesktop.Org,
 Daniele Ceraolo Spurio <daniele.ceraolospurio@intel.com>,
 DRI-Devel@Lists.FreeDesktop.Org
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

On Thu, 16 Mar 2023 15:06:32 -0700, John.C.Harrison@Intel.com wrote:
>
> From: John Harrison <John.C.Harrison@Intel.com>
>
> A failure to load the GuC is occasionally observed where the GuC log
> actually showed that the GuC had loaded just fine. The implication
> being that the load just took ever so slightly longer than the 200ms
> timeout. Given that the actual time should be tens of milliseconds at
> the slowest, this should never happen. So far the issue has generally
> been caused by a bad IFWI resulting in low frequencies during boot
> (depsite the KMD requesting max frequency). However, the issue seems
> to happen more often than one would like.
>
> So a) increase the timeout so that the user still gets a working
> system even in the case of slow load. And b) report the frequency
> during the load to see if that is the case of the slow down.
>
> v2: Reduce timeout in non-debug builds, add references (Daniele)
>
> References: https://gitlab.freedesktop.org/drm/intel/-/issues/7931
> References: https://gitlab.freedesktop.org/drm/intel/-/issues/8060
> References: https://gitlab.freedesktop.org/drm/intel/-/issues/8083
> References: https://gitlab.freedesktop.org/drm/intel/-/issues/8136
> References: https://gitlab.freedesktop.org/drm/intel/-/issues/8137
> Signed-off-by: John Harrison <John.C.Harrison@Intel.com>

Tested this on ATSM and saw the interrmittent GuC FW load timeouts
disappear:

Tested-by: Ashutosh Dixit <ashutosh.dixit@intel.com>
