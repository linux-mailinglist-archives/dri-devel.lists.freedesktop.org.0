Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id A51331103A7
	for <lists+dri-devel@lfdr.de>; Tue,  3 Dec 2019 18:37:34 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D9A506EA47;
	Tue,  3 Dec 2019 17:37:31 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-yb1-xb42.google.com (mail-yb1-xb42.google.com
 [IPv6:2607:f8b0:4864:20::b42])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 061E16EA49
 for <dri-devel@lists.freedesktop.org>; Tue,  3 Dec 2019 17:37:31 +0000 (UTC)
Received: by mail-yb1-xb42.google.com with SMTP id a11so1843415ybc.9
 for <dri-devel@lists.freedesktop.org>; Tue, 03 Dec 2019 09:37:30 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=Km82VcRkTZuSw6qGN0kn4itOohtD+O7wdXp8OYBw050=;
 b=hRyWjabj4WrjlN2vrXP2x0uWf26coJ8p5xnRsQYNVHgE78o1DJWMUzpHZ+tpv/xphq
 pc/UMbD+hg8+kYUVx0tCvDwMPUjQoTYplhZzC9kXc//0rOFuzuUlVqmJ6dqhX5Jy+uA1
 gthCohfmGCugNNZTqcUCCMiorM6ZyTddyTh13t0yBx0cFVpyKlRFdz+1goZhx2RNiNTI
 7pYyqQX2kIBhGS+ZdoYG7K42ife9T5yCPD2pDYyEIvpTi0D6L1wfahGq1tzh2z4ENXT1
 JzIjvW/p+fJ762rr5bOo++AqJQfq4Rg9wzNnILcXp+LHqQsb/Vby9clF9dPsXHjr/ru/
 iKOw==
X-Gm-Message-State: APjAAAW/tqQGXDXz1Y6zMswAB/3dKV/rj80JWoq97wSzjOCdCCJeI6vS
 MbpM3NCfxvKxEbZ4enVEAXZbwZqYezk5rA==
X-Google-Smtp-Source: APXvYqz8xSQ7FEL3txDfFc9JPXjfO9mHCYMS6nNLBPvKfRL5AiTGaM3naoaBIVRQGTjA39BZw7XaHg==
X-Received: by 2002:a25:b090:: with SMTP id f16mr5433670ybj.437.1575394649890; 
 Tue, 03 Dec 2019 09:37:29 -0800 (PST)
Received: from rosewood.cam.corp.google.com
 ([2620:0:1013:11:89c6:2139:5435:371d])
 by smtp.gmail.com with ESMTPSA id g190sm1729426ywf.41.2019.12.03.09.37.29
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 03 Dec 2019 09:37:29 -0800 (PST)
From: Sean Paul <sean@poorly.run>
To: dri-devel@lists.freedesktop.org, intel-gfx@lists.freedesktop.org,
 ramalingm.c@intel.com
Subject: [PATCH 07/11] drm/i915: Don't fully disable HDCP on a port if
 multiple pipes are using it
Date: Tue,  3 Dec 2019 12:36:30 -0500
Message-Id: <20191203173638.94919-8-sean@poorly.run>
X-Mailer: git-send-email 2.24.0.393.g34dc348eaf-goog
In-Reply-To: <20191203173638.94919-1-sean@poorly.run>
References: <20191203173638.94919-1-sean@poorly.run>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=poorly.run; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=Km82VcRkTZuSw6qGN0kn4itOohtD+O7wdXp8OYBw050=;
 b=I4JYMUkd0vXwZQRB6JAog8eIW4nnp9K74RxN6q6Has4Es9uMZbuWvFedZ9UhZ8xrbw
 qn57pyoZIe2ZPgcXYnGz3zSyWiOBlzEqD9ef/oJqytzcb1n9PGVypRRltio2M3gNUeoP
 pH2VuDV7asTEF2Ut7NnurXt0ScIgLv5Q0qZNACHpTSqLuDcRu/1IvSzwWrSX/1QEIhlE
 2jdZtsvTpR2aLym86RXaOHC3RwV76QayWFW/dSnADmT2IkdrjDnTC629SJlY9bvelEg8
 x20eyhsDJ9e7YYDQUYmrZ3Ji4A03YZhatWajxGeymZ/vRyNi635r0FtQMjsWyF0/uxxe
 I9Sw==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: David Airlie <airlied@linux.ie>, Sean Paul <seanpaul@chromium.org>,
 Rodrigo Vivi <rodrigo.vivi@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogU2VhbiBQYXVsIDxzZWFucGF1bEBjaHJvbWl1bS5vcmc+CgpUaGlzIHBhdGNoIGlzIHJl
cXVpcmVkIGZvciBIRENQIG92ZXIgTVNULiBJZiBhIHBvcnQgaXMgYmVpbmcgdXNlZCBmb3IKbXVs
dGlwbGUgSERDUCBzdHJlYW1zLCB3ZSBkb24ndCB3YW50IHRvIGZ1bGx5IGRpc2FibGUgSERDUCBv
biBhIHBvcnQgaWYKb25lIG9mIHRoZW0gaXMgZGlzYWJsZWQuIEluc3RlYWQsIHdlIGp1c3QgZGlz
YWJsZSB0aGUgSERDUCBzaWduYWxsaW5nIG9uCnRoYXQgcGFydGljdWxhciBwaXBlIGFuZCBleGl0
IGVhcmx5LiBUaGUgbGFzdCBwaXBlIHRvIGRpc2FibGUgSERDUCB3aWxsCmFsc28gYnJpbmcgZG93
biBIRENQIG9uIHRoZSBwb3J0LgoKSW4gb3JkZXIgdG8gYWNoaWV2ZSB0aGlzLCB3ZSBuZWVkIHRv
IGtlZXAgYSByZWZjb3VudCBpbiBpbnRlbF9kaWdpdGFsX3BvcnQKYW5kIHByb3RlY3QgaXQgdXNp
bmcgYSBuZXcgaGRjcF9tdXRleC4KClNpZ25lZC1vZmYtYnk6IFNlYW4gUGF1bCA8c2VhbnBhdWxA
Y2hyb21pdW0ub3JnPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRp
LmMgICAgICB8ICAzICsrCiAuLi4vZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVz
LmggICAgfCAgNSArKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jICAg
ICAgIHwgIDIgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9oZGNwLmMgICAg
IHwgNDkgKysrKysrKysrKysrKysrKy0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9oZG1pLmMgICAgIHwgIDIgKwogNSBmaWxlcyBjaGFuZ2VkLCA1MyBpbnNlcnRpb25zKCsp
LCA4IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfZGRpLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RkaS5j
CmluZGV4IGNhMjg5MTNhNGM5Zi4uYTU1YmM3MTA5MDQ1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RkaS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZGRpLmMKQEAgLTQ3MTcsNiArNDcxNyw5IEBAIHZvaWQgaW50ZWxfZGRp
X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBvcnQgcG9ydCkK
IAlpbnRlbF9lbmNvZGVyID0gJmludGVsX2RpZ19wb3J0LT5iYXNlOwogCWVuY29kZXIgPSAmaW50
ZWxfZW5jb2Rlci0+YmFzZTsKIAorCW11dGV4X2luaXQoJmludGVsX2RpZ19wb3J0LT5oZGNwX211
dGV4KTsKKwlpbnRlbF9kaWdfcG9ydC0+bnVtX2hkY3Bfc3RyZWFtcyA9IDA7CisKIAlkcm1fZW5j
b2Rlcl9pbml0KCZkZXZfcHJpdi0+ZHJtLCBlbmNvZGVyLCAmaW50ZWxfZGRpX2Z1bmNzLAogCQkJ
IERSTV9NT0RFX0VOQ09ERVJfVE1EUywgIkRESSAlYyIsIHBvcnRfbmFtZShwb3J0KSk7CiAKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBl
cy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgK
aW5kZXggYmJkNDQ3NzJiOWIwLi40ODllMWQwMDkyOGIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oCkBAIC0xMzA5LDYgKzEzMDks
MTEgQEAgc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCB7CiAJZW51bSBwaHlfZmlhIHRjX3BoeV9m
aWE7CiAJdTggdGNfcGh5X2ZpYV9pZHg7CiAKKwkvKiBwcm90ZWN0cyBudW1faGRjcF9zdHJlYW1z
IHJlZmVyZW5jZSBjb3VudCAqLworCXN0cnVjdCBtdXRleCBoZGNwX211dGV4OworCS8qIHRoZSBu
dW1iZXIgb2YgcGlwZXMgdXNpbmcgSERDUCBzaWduYWxsaW5nIG91dCBvZiB0aGlzIHBvcnQgKi8K
Kwl1bnNpZ25lZCBpbnQgbnVtX2hkY3Bfc3RyZWFtczsKKwogCXZvaWQgKCp3cml0ZV9pbmZvZnJh
bWUpKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJCWNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCQkJCXVuc2lnbmVkIGludCB0eXBlLApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jCmluZGV4IGUyNmZiMjZiMTkwOS4uZmM1YTdk
YzZhYjliIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rw
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jCkBAIC03NTM1
LDYgKzc1MzUsOCBAQCBib29sIGludGVsX2RwX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAogCWludGVsX2VuY29kZXIgPSAmaW50ZWxfZGlnX3BvcnQtPmJhc2U7CiAJZW5j
b2RlciA9ICZpbnRlbF9lbmNvZGVyLT5iYXNlOwogCisJbXV0ZXhfaW5pdCgmaW50ZWxfZGlnX3Bv
cnQtPmhkY3BfbXV0ZXgpOworCiAJaWYgKGRybV9lbmNvZGVyX2luaXQoJmRldl9wcml2LT5kcm0s
ICZpbnRlbF9lbmNvZGVyLT5iYXNlLAogCQkJICAgICAmaW50ZWxfZHBfZW5jX2Z1bmNzLCBEUk1f
TU9ERV9FTkNPREVSX1RNRFMsCiAJCQkgICAgICJEUCAlYyIsIHBvcnRfbmFtZShwb3J0KSkpCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2hkY3AuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRjcC5jCmluZGV4IGYzNDc2M2ZhNWI0
Mi4uY2QyNDZmNTAxNzM4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2hkY3AuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2hk
Y3AuYwpAQCAtODQ5LDYgKzg0OSw3IEBAIHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmludGVsX2hk
Y3BfdG9fY29ubmVjdG9yKHN0cnVjdCBpbnRlbF9oZGNwICpoZGNwKQogc3RhdGljIHZvaWQgaW50
ZWxfaGRjcF91cGRhdGVfdmFsdWUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLAog
CQkJCSAgICB1NjQgdmFsdWUsIGJvb2wgdXBkYXRlX3Byb3BlcnR5KQogeworCXN0cnVjdCBpbnRl
bF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0gY29ubl90b19kaWdfcG9ydChjb25uZWN0
b3IpOwogCXN0cnVjdCBpbnRlbF9oZGNwICpoZGNwID0gJmNvbm5lY3Rvci0+aGRjcDsKIAogCVdB
Uk5fT04oIW11dGV4X2lzX2xvY2tlZCgmaGRjcC0+bXV0ZXgpKTsKQEAgLTg1Niw2ICs4NTcsMTUg
QEAgc3RhdGljIHZvaWQgaW50ZWxfaGRjcF91cGRhdGVfdmFsdWUoc3RydWN0IGludGVsX2Nvbm5l
Y3RvciAqY29ubmVjdG9yLAogCWlmIChoZGNwLT52YWx1ZSA9PSB2YWx1ZSkKIAkJcmV0dXJuOwog
CisJV0FSTl9PTighbXV0ZXhfaXNfbG9ja2VkKCZpbnRlbF9kaWdfcG9ydC0+aGRjcF9tdXRleCkp
OworCisJaWYgKGhkY3AtPnZhbHVlID09IERSTV9NT0RFX0NPTlRFTlRfUFJPVEVDVElPTl9FTkFC
TEVEKSB7CisJCWlmICghV0FSTl9PTihpbnRlbF9kaWdfcG9ydC0+bnVtX2hkY3Bfc3RyZWFtcyA9
PSAwKSkKKwkJCWludGVsX2RpZ19wb3J0LT5udW1faGRjcF9zdHJlYW1zLS07CisJfSBlbHNlIGlm
ICh2YWx1ZSA9PSBEUk1fTU9ERV9DT05URU5UX1BST1RFQ1RJT05fRU5BQkxFRCkgeworCQlpbnRl
bF9kaWdfcG9ydC0+bnVtX2hkY3Bfc3RyZWFtcysrOworCX0KKwogCWhkY3AtPnZhbHVlID0gdmFs
dWU7CiAJaWYgKHVwZGF0ZV9wcm9wZXJ0eSkKIAkJc2NoZWR1bGVfd29yaygmaGRjcC0+cHJvcF93
b3JrKTsKQEAgLTg3Miw2ICs4ODIsOCBAQCBzdGF0aWMgaW50IGludGVsX2hkY3BfY2hlY2tfbGlu
ayhzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCiAJaW50IHJldCA9IDA7CiAKIAlt
dXRleF9sb2NrKCZoZGNwLT5tdXRleCk7CisJbXV0ZXhfbG9jaygmaW50ZWxfZGlnX3BvcnQtPmhk
Y3BfbXV0ZXgpOworCiAJY3B1X3RyYW5zY29kZXIgPSBoZGNwLT5jcHVfdHJhbnNjb2RlcjsKIAog
CS8qIENoZWNrX2xpbmsgdmFsaWQgb25seSB3aGVuIEhEQ1AxLjQgaXMgZW5hYmxlZCAqLwpAQCAt
OTIzLDYgKzkzNSw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfaGRjcF9jaGVja19saW5rKHN0cnVjdCBp
bnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKIAl9CiAKIG91dDoKKwltdXRleF91bmxvY2soJmlu
dGVsX2RpZ19wb3J0LT5oZGNwX211dGV4KTsKIAltdXRleF91bmxvY2soJmhkY3AtPm11dGV4KTsK
IAlyZXR1cm4gcmV0OwogfQpAQCAtMTk5NCw2ICsyMDA3LDcgQEAgaW50IGludGVsX2hkY3BfaW5p
dChzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IsCiAKIGludCBpbnRlbF9oZGNwX2Vu
YWJsZShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IsIHU4IGNvbnRlbnRfdHlwZSkK
IHsKKwlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCA9IGNvbm5fdG9f
ZGlnX3BvcnQoY29ubmVjdG9yKTsKIAlzdHJ1Y3QgaW50ZWxfaGRjcCAqaGRjcCA9ICZjb25uZWN0
b3ItPmhkY3A7CiAJdW5zaWduZWQgbG9uZyBjaGVja19saW5rX2ludGVydmFsID0gRFJNX0hEQ1Bf
Q0hFQ0tfUEVSSU9EX01TOwogCWludCByZXQgPSAtRUlOVkFMOwpAQCAtMjAwMiw2ICsyMDE2LDcg
QEAgaW50IGludGVsX2hkY3BfZW5hYmxlKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3Rv
ciwgdTggY29udGVudF90eXBlKQogCQlyZXR1cm4gLUVOT0VOVDsKIAogCW11dGV4X2xvY2soJmhk
Y3AtPm11dGV4KTsKKwltdXRleF9sb2NrKCZpbnRlbF9kaWdfcG9ydC0+aGRjcF9tdXRleCk7CiAJ
V0FSTl9PTihoZGNwLT52YWx1ZSA9PSBEUk1fTU9ERV9DT05URU5UX1BST1RFQ1RJT05fRU5BQkxF
RCk7CiAJaGRjcC0+Y29udGVudF90eXBlID0gY29udGVudF90eXBlOwogCkBAIC0yMDMxLDEyICsy
MDQ2LDE0IEBAIGludCBpbnRlbF9oZGNwX2VuYWJsZShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpj
b25uZWN0b3IsIHU4IGNvbnRlbnRfdHlwZSkKIAkJCQkJdHJ1ZSk7CiAJfQogCisJbXV0ZXhfdW5s
b2NrKCZpbnRlbF9kaWdfcG9ydC0+aGRjcF9tdXRleCk7CiAJbXV0ZXhfdW5sb2NrKCZoZGNwLT5t
dXRleCk7CiAJcmV0dXJuIHJldDsKIH0KIAogaW50IGludGVsX2hkY3BfZGlzYWJsZShzdHJ1Y3Qg
aW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCiB7CisJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9y
dCAqaW50ZWxfZGlnX3BvcnQgPSBjb25uX3RvX2RpZ19wb3J0KGNvbm5lY3Rvcik7CiAJc3RydWN0
IGludGVsX2hkY3AgKmhkY3AgPSAmY29ubmVjdG9yLT5oZGNwOwogCWludCByZXQgPSAwOwogCkBA
IC0yMDQ0LDE3ICsyMDYxLDMzIEBAIGludCBpbnRlbF9oZGNwX2Rpc2FibGUoc3RydWN0IGludGVs
X2Nvbm5lY3RvciAqY29ubmVjdG9yKQogCQlyZXR1cm4gLUVOT0VOVDsKIAogCW11dGV4X2xvY2so
JmhkY3AtPm11dGV4KTsKKwltdXRleF9sb2NrKCZpbnRlbF9kaWdfcG9ydC0+aGRjcF9tdXRleCk7
CiAKLQlpZiAoaGRjcC0+dmFsdWUgIT0gRFJNX01PREVfQ09OVEVOVF9QUk9URUNUSU9OX1VOREVT
SVJFRCkgewotCQlpbnRlbF9oZGNwX3VwZGF0ZV92YWx1ZShjb25uZWN0b3IsCi0JCQkJCURSTV9N
T0RFX0NPTlRFTlRfUFJPVEVDVElPTl9VTkRFU0lSRUQsCi0JCQkJCWZhbHNlKTsKLQkJaWYgKGhk
Y3AtPmhkY3AyX2VuY3J5cHRlZCkKLQkJCXJldCA9IF9pbnRlbF9oZGNwMl9kaXNhYmxlKGNvbm5l
Y3Rvcik7Ci0JCWVsc2UgaWYgKGhkY3AtPmhkY3BfZW5jcnlwdGVkKQotCQkJcmV0ID0gX2ludGVs
X2hkY3BfZGlzYWJsZShjb25uZWN0b3IpOworCWlmIChoZGNwLT52YWx1ZSA9PSBEUk1fTU9ERV9D
T05URU5UX1BST1RFQ1RJT05fVU5ERVNJUkVEKQorCQlnb3RvIG91dDsKKworCWludGVsX2hkY3Bf
dXBkYXRlX3ZhbHVlKGNvbm5lY3RvciwKKwkJCQlEUk1fTU9ERV9DT05URU5UX1BST1RFQ1RJT05f
VU5ERVNJUkVELCBmYWxzZSk7CisKKwkvKgorCSAqIElmIHRoZXJlIGFyZSBvdGhlciBjb25uZWN0
b3JzIG9uIHRoaXMgcG9ydCB1c2luZyBIRENQLCBkb24ndCBkaXNhYmxlCisJICogaXQuIEluc3Rl
YWQsIHRvZ2dsZSB0aGUgSERDUCBzaWduYWxsaW5nIG9mZiBvbiB0aGF0IHBhcnRpY3VsYXIKKwkg
KiBjb25uZWN0b3IvcGlwZSBhbmQgZXhpdC4KKwkgKi8KKwlpZiAoaW50ZWxfZGlnX3BvcnQtPm51
bV9oZGNwX3N0cmVhbXMgPiAwKSB7CisJCXJldCA9IGhkY3AtPnNoaW0tPnRvZ2dsZV9zaWduYWxs
aW5nKGNvbm5lY3RvciwgZmFsc2UpOworCQlpZiAocmV0KQorCQkJRFJNX0RFQlVHX0tNUygiRmFp
bGVkIHRvIGRpc2FibGUgSERDUCBzaWduYWxsaW5nXG4iKTsKKwkJZ290byBvdXQ7CiAJfQogCisJ
aWYgKGhkY3AtPmhkY3AyX2VuY3J5cHRlZCkKKwkJcmV0ID0gX2ludGVsX2hkY3AyX2Rpc2FibGUo
Y29ubmVjdG9yKTsKKwllbHNlIGlmIChoZGNwLT5oZGNwX2VuY3J5cHRlZCkKKwkJcmV0ID0gX2lu
dGVsX2hkY3BfZGlzYWJsZShjb25uZWN0b3IpOworCitvdXQ6CisJbXV0ZXhfdW5sb2NrKCZpbnRl
bF9kaWdfcG9ydC0+aGRjcF9tdXRleCk7CiAJbXV0ZXhfdW5sb2NrKCZoZGNwLT5tdXRleCk7CiAJ
Y2FuY2VsX2RlbGF5ZWRfd29ya19zeW5jKCZoZGNwLT5jaGVja193b3JrKTsKIAlyZXR1cm4gcmV0
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9oZG1pLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2hkbWkuYwppbmRleCA2YTFlNzEx
YzRmN2EuLmMyMzBkMzdjNDI3NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9oZG1pLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9oZG1pLmMKQEAgLTMyNDMsNiArMzI0Myw4IEBAIHZvaWQgaW50ZWxfaGRtaV9pbml0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAogCWludGVsX2VuY29kZXIgPSAmaW50ZWxf
ZGlnX3BvcnQtPmJhc2U7CiAKKwltdXRleF9pbml0KCZpbnRlbF9kaWdfcG9ydC0+aGRjcF9tdXRl
eCk7CisKIAlkcm1fZW5jb2Rlcl9pbml0KCZkZXZfcHJpdi0+ZHJtLCAmaW50ZWxfZW5jb2Rlci0+
YmFzZSwKIAkJCSAmaW50ZWxfaGRtaV9lbmNfZnVuY3MsIERSTV9NT0RFX0VOQ09ERVJfVE1EUywK
IAkJCSAiSERNSSAlYyIsIHBvcnRfbmFtZShwb3J0KSk7Ci0tIApTZWFuIFBhdWwsIFNvZnR3YXJl
IEVuZ2luZWVyLCBHb29nbGUgLyBDaHJvbWl1bSBPUwoKX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxA
bGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxt
YW4vbGlzdGluZm8vZHJpLWRldmVs
