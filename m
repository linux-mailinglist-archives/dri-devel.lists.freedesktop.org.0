Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 5BA818E67F
	for <lists+dri-devel@lfdr.de>; Thu, 15 Aug 2019 10:35:17 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0F29D6E8D8;
	Thu, 15 Aug 2019 08:34:57 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from NAM04-BN3-obe.outbound.protection.outlook.com
 (mail-eopbgr680128.outbound.protection.outlook.com [40.107.68.128])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 09ADB89F63
 for <dri-devel@lists.freedesktop.org>; Tue, 13 Aug 2019 10:36:35 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=oKJEQDyqTY3fIbhYKIQxQq+Mj3Tv4uZE99cublcovuFNoxn6Or1Eo9ss1aB0sjYTBj7ukFUMMcGNPYXnbppfVFqpYwk9DpC9hYwh1TA3WdE8HBAuYbeCoO+C/jfHaUF0HtlmrmWHlWXPPuwQSXfoQ5VEeL/DE+CpoJ5oesVKFE1HPZeH+vrqe2h2hwtSB2Rg2NuKIurfAkDCNQqXoYmf6s6nntqqvX7JshR8+WqSusr4SsklV0p3H69QJL4OYjEy4rF2sQNxxsuR7ow9Jf3EwQAcb3SOYUSh9pYpivZwizyZK85TZvGBjLttrZM7gys05P9UR1mDtzpDFNSghvkXHw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=3G+MalTj6ugNToav7NSTvepY8cOsJbD+BmigBbWeMxQ=;
 b=kkzkuR2QY0/j69XfZG4ouuK/LMp9IitcbHqUnvZwHx5fdolWJIgayUqZ4klJjtdjeKu1xfxl0jcPkZ+tSc7LIzG/lby4ShroqSUj23zVRkNJ9JIi4v3HjFjP63HF3eps/wwHvX3ByuF2S2MepvO0h9m6HQkPImO6m2UjoOt69AB2wh2p8EYnRZziiiL2H5hQA3a5/HMWN5WgJQAdHKo1MiGm2XRwmNwniL4gAMZm4TOFpuCQAGdE8bF1kmeBDJtEKlN0rZArANGnFtNDN0s0rkeEygB5jyVQcu9/Sj4zMZfLB+b9RdDRdhgG2erRoPLqbwseQZY9XWcn63NPAIMfhw==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=microsoft.com; dmarc=pass action=none
 header.from=microsoft.com; dkim=pass header.d=microsoft.com; arc=none
Received: from DM6PR21MB1401.namprd21.prod.outlook.com (10.255.109.88) by
 DM6PR21MB1259.namprd21.prod.outlook.com (20.179.50.205) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2178.7; Tue, 13 Aug 2019 10:36:32 +0000
Received: from DM6PR21MB1401.namprd21.prod.outlook.com
 ([fe80::bd0e:e64e:a357:3759]) by DM6PR21MB1401.namprd21.prod.outlook.com
 ([fe80::bd0e:e64e:a357:3759%5]) with mapi id 15.20.2199.004; Tue, 13 Aug 2019
 10:36:32 +0000
From: Wei Hu <weh@microsoft.com>
To: "rdunlap@infradead.org" <rdunlap@infradead.org>, "shc_work@mail.ru"
 <shc_work@mail.ru>, "gregkh@linuxfoundation.org"
 <gregkh@linuxfoundation.org>, "lee.jones@linaro.org" <lee.jones@linaro.org>,
 "alexandre.belloni@bootlin.com" <alexandre.belloni@bootlin.com>,
 "baijiaju1990@gmail.com" <baijiaju1990@gmail.com>,
 "fthain@telegraphics.com.au" <fthain@telegraphics.com.au>, "info@metux.net"
 <info@metux.net>, "linux-hyperv@vger.kernel.org"
 <linux-hyperv@vger.kernel.org>, "dri-devel@lists.freedesktop.org"
 <dri-devel@lists.freedesktop.org>, "linux-fbdev@vger.kernel.org"
 <linux-fbdev@vger.kernel.org>, "linux-kernel@vger.kernel.org"
 <linux-kernel@vger.kernel.org>, "sashal@kernel.org" <sashal@kernel.org>,
 Stephen Hemminger <sthemmin@microsoft.com>, Haiyang Zhang
 <haiyangz@microsoft.com>, KY Srinivasan <kys@microsoft.com>, Dexuan Cui
 <decui@microsoft.com>, Iouri Tarassov <iourit@microsoft.com>, Michael Kelley
 <mikelley@microsoft.com>, Wei Hu <weh@microsoft.com>
Subject: [PATCH] video: hyperv: hyperv_fb: Support deferred IO for Hyper-V
 frame buffer driver
Thread-Topic: [PATCH] video: hyperv: hyperv_fb: Support deferred IO for
 Hyper-V frame buffer driver
Thread-Index: AQHVUcL5xwYcgiTbLE2rph4+nLCFtw==
Date: Tue, 13 Aug 2019 10:36:32 +0000
Message-ID: <20190813103548.2008-1-weh@microsoft.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: SG2PR0401CA0024.apcprd04.prod.outlook.com
 (2603:1096:3:1::34) To DM6PR21MB1401.namprd21.prod.outlook.com
 (2603:10b6:5:22d::24)
x-ms-exchange-messagesentrepresentingtype: 2
x-mailer: git-send-email 2.20.1
x-originating-ip: [167.220.255.113]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: a7e3c932-3f04-423e-6c29-08d71fda1bcd
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(5600158)(711020)(4605104)(1401327)(4618075)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(2017052603328)(7193020);
 SRVR:DM6PR21MB1259; 
x-ms-traffictypediagnostic: DM6PR21MB1259:|DM6PR21MB1259:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <DM6PR21MB125917231604A497C56B8A2BADD20@DM6PR21MB1259.namprd21.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:7691;
x-forefront-prvs: 01283822F8
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10019020)(4636009)(376002)(136003)(396003)(366004)(39860400002)(346002)(199004)(189003)(6512007)(36756003)(81156014)(2501003)(43066004)(99286004)(26005)(81166006)(476003)(50226002)(14454004)(2616005)(10290500003)(10090500001)(186003)(8676002)(386003)(52116002)(71200400001)(6506007)(316002)(478600001)(102836004)(256004)(1511001)(22452003)(25786009)(71190400001)(66066001)(110136005)(486006)(14444005)(6116002)(7416002)(53936002)(30864003)(6486002)(2201001)(1250700005)(8936002)(3846002)(6436002)(7846003)(66476007)(1076003)(7049001)(66556008)(2906002)(3450700001)(6392003)(5660300002)(64756008)(305945005)(66446008)(7736002)(66946007)(921003)(1121003);
 DIR:OUT; SFP:1102; SCL:1; SRVR:DM6PR21MB1259;
 H:DM6PR21MB1401.namprd21.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: microsoft.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: i8yiMDdqROJdO2GgUTRYaxVIbRBKlH/m+OZ8QNioepx2TZxviLgVf1Xqh6zO/RfElvSfx8pWpLm69q0HoBmX8E0UUixMCazNnOaBUKKfgooW5xcmm4mFCrRwcbQrazhus5P5DPQo6tP2B04EbJNW7zSyiGX3ULyNeev4vGSOnV7bB1yYnq30ZgkLkeAy/UHNkBbDgE6w2sik9MgX7qY//WatzwcG5HehYj3uQaDJ/fGd/xbp/jSZm2vZBTW8g6NB6wkakft2tEjfIrSEcdD4Q3M7khikNX0R7vHBPwp3ACDntSyzpnj+FAQ/J7CVZw3J6Lbtk9LPn7M3itOtVZ2Ld9qJPHr57c3xv4linRPkEiNjAgvJd6OG61cbgpVzQzTPGleFDRtu3GGYLpl/84jD6DCDWSHJKc41LEaHDKcDq7Y=
MIME-Version: 1.0
X-OriginatorOrg: microsoft.com
X-MS-Exchange-CrossTenant-Network-Message-Id: a7e3c932-3f04-423e-6c29-08d71fda1bcd
X-MS-Exchange-CrossTenant-originalarrivaltime: 13 Aug 2019 10:36:32.8205 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 72f988bf-86f1-41af-91ab-2d7cd011db47
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: ixynKrpnTqZex1ptLgNyGySwDc7MdKrIzwzItKRI1eqGB054Oj2PbJ7u575s9Mk7oTC3w0gPjt/XmS02AfkvOw==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM6PR21MB1259
X-Mailman-Approved-At: Thu, 15 Aug 2019 08:34:55 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=microsoft.com; s=selector1;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=3G+MalTj6ugNToav7NSTvepY8cOsJbD+BmigBbWeMxQ=;
 b=a+IXtl/GaBFiMt7cA3tkG1xUciIM1Rx7izeuFNUAYllyBehEAMdPIM7gWk6ImIfdAru/rapHwKW+XNZQvCjTaCydiMknnsImbZNt8Na2NfhPM5Yst4tloMoRCiHuoPBhMlfTS7s1cf8yed9XDeEVf5xffQtjFED3Qs/LHsxDigw=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=lkmlwhu@microsoft.com; 
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Reply-To: Wei Hu <weh@microsoft.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

V2l0aG91dCBkZWZlcnJlZCBJTyBzdXBwb3J0LCBoeXBlcnZfZmIgZHJpdmVyIGluZm9ybXMgdGhl
IGhvc3QgdG8gcmVmcmVzaAp0aGUgZW50aXJlIGd1ZXN0IGZyYW1lIGJ1ZmZlciBhdCBmaXhlZCBy
YXRlLCBlLmcuIGF0IDIwSHosIG5vIG1hdHRlciB0aGVyZQppcyBzY3JlZW4gdXBkYXRlIG9yIG5v
dC4gVGhpcyBwYXRjaCBzdXBwb3J0cyBkZWZlcmVkIElPIGZvciBzY3JlZW5zIGluCmdyYXBoaWMg
bW9kZSBhbmQgYWxzbyBlbmFibGVzIHRoZSBmcmFtbWUgYnVmZmVyIG9uLWRlbWFuZCByZWZyZXNo
LiBUaGUKaGlnaGVzdCByZWZyZXNoIHJhdGUgaXMgc3RpbGwgc2V0IGF0IDIwSHouCgpEdWUgdG8g
bGltaXRhdGlvbiBvbiBIeXBlci1WIGhvc3QsIHdlIGtlZXAgYSBzaGFkb3cgY29weSBvZiBmcmFt
ZSBidWZmZXIKaW4gdGhlIGd1ZXN0LiBUaGlzIG1lYW5zIG9uZSBtb3JlIGNvcHkgb2YgdGhlIGRp
cnR5IHJlY3RhbmdsZSBpbnNpZGUKZ3Vlc3Qgd2hlbiBkb2luZyB0aGUgb24tZGVtYW5kIHJlZnJl
c2guIFRoaXMgY2FuIGJlIG9wdGltaXplZCBpbiB0aGUKZnV0dXJlIHdpdGggaGVscCBmcm9tIGhv
c3QuIEZvciBub3cgdGhlIGhvc3QgcGVyZm9ybWFuY2UgZ2FpbiBmcm9tIGRlZmVycmVkCklPIG91
dHdlaWdocyB0aGUgc2hhZG93IGNvcHkgaW1wYWN0IGluIHRoZSBndWVzdC4KClNpZ25lZC1vZmYt
Ynk6IFdlaSBIdSA8d2VoQG1pY3Jvc29mdC5jb20+Ci0tLQogZHJpdmVycy92aWRlby9mYmRldi9L
Y29uZmlnICAgICB8ICAgMSArCiBkcml2ZXJzL3ZpZGVvL2ZiZGV2L2h5cGVydl9mYi5jIHwgMjE3
ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tCiAyIGZpbGVzIGNoYW5nZWQsIDE5OCBp
bnNlcnRpb25zKCspLCAyMCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL3ZpZGVv
L2ZiZGV2L0tjb25maWcgYi9kcml2ZXJzL3ZpZGVvL2ZiZGV2L0tjb25maWcKaW5kZXggMWIyZjVm
MzFmYjZmLi5lNzgxZjg5YTE4MjQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvdmlkZW8vZmJkZXYvS2Nv
bmZpZworKysgYi9kcml2ZXJzL3ZpZGVvL2ZiZGV2L0tjb25maWcKQEAgLTIyNDEsNiArMjI0MSw3
IEBAIGNvbmZpZyBGQl9IWVBFUlYKIAlzZWxlY3QgRkJfQ0ZCX0ZJTExSRUNUCiAJc2VsZWN0IEZC
X0NGQl9DT1BZQVJFQQogCXNlbGVjdCBGQl9DRkJfSU1BR0VCTElUCisJc2VsZWN0IEZCX0RFRkVS
UkVEX0lPCiAJaGVscAogCSAgVGhpcyBmcmFtZWJ1ZmZlciBkcml2ZXIgc3VwcG9ydHMgTWljcm9z
b2Z0IEh5cGVyLVYgU3ludGhldGljIFZpZGVvLgogCmRpZmYgLS1naXQgYS9kcml2ZXJzL3ZpZGVv
L2ZiZGV2L2h5cGVydl9mYi5jIGIvZHJpdmVycy92aWRlby9mYmRldi9oeXBlcnZfZmIuYwppbmRl
eCAxMDQyZjMzMTFmYTIuLjg1MTk4YTZlYThlNyAxMDA2NDQKLS0tIGEvZHJpdmVycy92aWRlby9m
YmRldi9oeXBlcnZfZmIuYworKysgYi9kcml2ZXJzL3ZpZGVvL2ZiZGV2L2h5cGVydl9mYi5jCkBA
IC0yMzMsNiArMjMzLDcgQEAgc3RydWN0IHN5bnRodmlkX21zZyB7CiAjZGVmaW5lIFJJTkdfQlVG
U0laRSAoMjU2ICogMTAyNCkKICNkZWZpbmUgVlNQX1RJTUVPVVQgKDEwICogSFopCiAjZGVmaW5l
IEhWRkJfVVBEQVRFX0RFTEFZIChIWiAvIDIwKQorI2RlZmluZSBIVkZCX09OREVNQU5EX1RIUk9U
VExFIChIWiAvIDIwKQogCiBzdHJ1Y3QgaHZmYl9wYXIgewogCXN0cnVjdCBmYl9pbmZvICppbmZv
OwpAQCAtMjUyLDYgKzI1MywxNyBAQCBzdHJ1Y3QgaHZmYl9wYXIgewogCWJvb2wgc3luY2hyb25v
dXNfZmI7CiAKIAlzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgaHZmYl9wYW5pY19uYjsKKworCS8qIE1l
bW9yeSBmb3IgZGVmZXJyZWQgSU8gYW5kIGZyYW1lIGJ1ZmZlciBpdHNlbGYgKi8KKwl1bnNpZ25l
ZCBjaGFyICpkaW9fdnA7CisJdW5zaWduZWQgY2hhciAqbW1pb192cDsKKwl1bnNpZ25lZCBsb25n
IG1taW9fcHA7CisJc3BpbmxvY2tfdCBkb2NvcHlfbG9jazsgLyogTG9jayB0byBwcm90ZWN0IG1l
bW9yeSBjb3B5ICovCisKKwkvKiBEaXJ0eSByZWN0YW5nbGUsIHByb3RlY3RlZCBieSBkZWxheWVk
X3JlZnJlc2hfbG9jayAqLworCWludCB4MSwgeTEsIHgyLCB5MjsKKwlib29sIGRlbGF5ZWRfcmVm
cmVzaDsKKwlzcGlubG9ja190IGRlbGF5ZWRfcmVmcmVzaF9sb2NrOwogfTsKIAogc3RhdGljIHVp
bnQgc2NyZWVuX3dpZHRoID0gSFZGQl9XSURUSDsKQEAgLTI2MCw2ICsyNzIsNyBAQCBzdGF0aWMg
dWludCBzY3JlZW5fd2lkdGhfbWF4ID0gSFZGQl9XSURUSDsKIHN0YXRpYyB1aW50IHNjcmVlbl9o
ZWlnaHRfbWF4ID0gSFZGQl9IRUlHSFQ7CiBzdGF0aWMgdWludCBzY3JlZW5fZGVwdGg7CiBzdGF0
aWMgdWludCBzY3JlZW5fZmJfc2l6ZTsKK3N0YXRpYyB1aW50IGRpb19mYl9zaXplOyAvKiBGQiBz
aXplIGZvciBkZWZlcnJlZCBJTyAqLwogCiAvKiBTZW5kIG1lc3NhZ2UgdG8gSHlwZXItViBob3N0
ICovCiBzdGF0aWMgaW5saW5lIGludCBzeW50aHZpZF9zZW5kKHN0cnVjdCBodl9kZXZpY2UgKmhk
ZXYsCkBAIC0zNDYsMjggKzM1OSw4OCBAQCBzdGF0aWMgaW50IHN5bnRodmlkX3NlbmRfcHRyKHN0
cnVjdCBodl9kZXZpY2UgKmhkZXYpCiB9CiAKIC8qIFNlbmQgdXBkYXRlZCBzY3JlZW4gYXJlYSAo
ZGlydHkgcmVjdGFuZ2xlKSBsb2NhdGlvbiB0byBob3N0ICovCi1zdGF0aWMgaW50IHN5bnRodmlk
X3VwZGF0ZShzdHJ1Y3QgZmJfaW5mbyAqaW5mbykKK3N0YXRpYyBpbnQKK3N5bnRodmlkX3VwZGF0
ZShzdHJ1Y3QgZmJfaW5mbyAqaW5mbywgaW50IHgxLCBpbnQgeTEsIGludCB4MiwgaW50IHkyKQog
ewogCXN0cnVjdCBodl9kZXZpY2UgKmhkZXYgPSBkZXZpY2VfdG9faHZfZGV2aWNlKGluZm8tPmRl
dmljZSk7CiAJc3RydWN0IHN5bnRodmlkX21zZyBtc2c7CiAKIAltZW1zZXQoJm1zZywgMCwgc2l6
ZW9mKHN0cnVjdCBzeW50aHZpZF9tc2cpKTsKKwlpZiAoeDIgPT0gSU5UX01BWCkKKwkJeDIgPSBp
bmZvLT52YXIueHJlczsKKwlpZiAoeTIgPT0gSU5UX01BWCkKKwkJeTIgPSBpbmZvLT52YXIueXJl
czsKIAogCW1zZy52aWRfaGRyLnR5cGUgPSBTWU5USFZJRF9ESVJUOwogCW1zZy52aWRfaGRyLnNp
emUgPSBzaXplb2Yoc3RydWN0IHN5bnRodmlkX21zZ19oZHIpICsKIAkJc2l6ZW9mKHN0cnVjdCBz
eW50aHZpZF9kaXJ0KTsKIAltc2cuZGlydC52aWRlb19vdXRwdXQgPSAwOwogCW1zZy5kaXJ0LmRp
cnRfY291bnQgPSAxOwotCW1zZy5kaXJ0LnJlY3RbMF0ueDEgPSAwOwotCW1zZy5kaXJ0LnJlY3Rb
MF0ueTEgPSAwOwotCW1zZy5kaXJ0LnJlY3RbMF0ueDIgPSBpbmZvLT52YXIueHJlczsKLQltc2cu
ZGlydC5yZWN0WzBdLnkyID0gaW5mby0+dmFyLnlyZXM7CisJbXNnLmRpcnQucmVjdFswXS54MSA9
ICh4MSA8IDAgfHwgeDEgPiB4MikgPyAwIDogeDE7CisJbXNnLmRpcnQucmVjdFswXS55MSA9ICh5
MiA8IDAgfHwgeTEgPiB5MikgPyAwIDogeTE7CisJbXNnLmRpcnQucmVjdFswXS54MiA9CisJCSh4
MiA8IHgxIHx8IHgyID4gaW5mby0+dmFyLnhyZXMpID8gaW5mby0+dmFyLnhyZXMgOiB4MjsKKwlt
c2cuZGlydC5yZWN0WzBdLnkyID0KKwkJKHkyIDwgeTEgfHwgeTIgPiBpbmZvLT52YXIueXJlcykg
PyBpbmZvLT52YXIueXJlcyA6IHkyOwogCiAJc3ludGh2aWRfc2VuZChoZGV2LCAmbXNnKTsKIAog
CXJldHVybiAwOwogfQogCitzdGF0aWMgdm9pZCBodmZiX2RvY29weShzdHJ1Y3QgaHZmYl9wYXIg
KnBhciwKKwkJCXVuc2lnbmVkIGxvbmcgb2Zmc2V0LAorCQkJdW5zaWduZWQgbG9uZyBzaXplKQor
eworCWlmICghcGFyIHx8ICFwYXItPm1taW9fdnAgfHwgIXBhci0+ZGlvX3ZwIHx8ICFwYXItPmZi
X3JlYWR5IHx8CisJICAgIHNpemUgPT0gMCB8fCBvZmZzZXQgPj0gZGlvX2ZiX3NpemUpCisJCXJl
dHVybjsKKworCWlmIChvZmZzZXQgKyBzaXplID4gZGlvX2ZiX3NpemUpCisJCXNpemUgPSBkaW9f
ZmJfc2l6ZSAtIG9mZnNldDsKKworCW1lbWNweShwYXItPm1taW9fdnAgKyBvZmZzZXQsIHBhci0+
ZGlvX3ZwICsgb2Zmc2V0LCBzaXplKTsKK30KKworLyogRGVmZXJyZWQgSU8gY2FsbGJhY2sgKi8K
K3N0YXRpYyB2b2lkIHN5bnRodmlkX2RlZmVycmVkX2lvKHN0cnVjdCBmYl9pbmZvICpwLAorCQkJ
CSBzdHJ1Y3QgbGlzdF9oZWFkICpwYWdlbGlzdCkKK3sKKwlzdHJ1Y3QgaHZmYl9wYXIgKnBhciA9
IHAtPnBhcjsKKwlzdHJ1Y3QgcGFnZSAqcGFnZTsKKwl1bnNpZ25lZCBsb25nIHN0YXJ0LCBlbmQ7
CisJaW50IHkxLCB5MiwgbWlueSwgbWF4eTsKKwl1bnNpZ25lZCBsb25nIGZsYWdzOworCisJbWlu
eSA9IElOVF9NQVg7CisJbWF4eSA9IDA7CisKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KHBhZ2UsIHBh
Z2VsaXN0LCBscnUpIHsKKwkJc3RhcnQgPSBwYWdlLT5pbmRleCA8PCBQQUdFX1NISUZUOworCQll
bmQgPSBzdGFydCArIFBBR0VfU0laRSAtIDE7CisJCXkxID0gc3RhcnQgLyBwLT5maXgubGluZV9s
ZW5ndGg7CisJCXkyID0gZW5kIC8gcC0+Zml4LmxpbmVfbGVuZ3RoOworCQlpZiAoeTIgPiBwLT52
YXIueXJlcykKKwkJCXkyID0gcC0+dmFyLnlyZXM7CisJCW1pbnkgPSBtaW5fdChpbnQsIG1pbnks
IHkxKTsKKwkJbWF4eSA9IG1heF90KGludCwgbWF4eSwgeTIpOworCisJCS8qIENvcHkgZnJvbSBk
aW8gc3BhY2UgdG8gbW1pbyBhZGRyZXNzICovCisJCWlmIChwYXItPmZiX3JlYWR5KSB7CisJCQlz
cGluX2xvY2tfaXJxc2F2ZSgmcGFyLT5kb2NvcHlfbG9jaywgZmxhZ3MpOworCQkJaHZmYl9kb2Nv
cHkocGFyLCBzdGFydCwgUEFHRV9TSVpFKTsKKwkJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnBh
ci0+ZG9jb3B5X2xvY2ssIGZsYWdzKTsKKwkJfQorCX0KKworCWlmIChwYXItPmZiX3JlYWR5KQor
CQlzeW50aHZpZF91cGRhdGUocCwgMCwgbWlueSwgcC0+dmFyLnhyZXMsIG1heHkpOworfQorCitz
dGF0aWMgc3RydWN0IGZiX2RlZmVycmVkX2lvIHN5bnRodmlkX2RlZmlvID0geworCS5kZWxheQkJ
PSBIWiAvIDIwLAorCS5kZWZlcnJlZF9pbwk9IHN5bnRodmlkX2RlZmVycmVkX2lvLAorfTsKIAog
LyoKICAqIEFjdGlvbnMgb24gcmVjZWl2ZWQgbWVzc2FnZXMgZnJvbSBob3N0OgpAQCAtNTk3LDcg
KzY3MCw3IEBAIHN0YXRpYyBpbnQgc3ludGh2aWRfc2VuZF9jb25maWcoc3RydWN0IGh2X2Rldmlj
ZSAqaGRldikKIAltc2ctPnZpZF9oZHIudHlwZSA9IFNZTlRIVklEX1ZSQU1fTE9DQVRJT047CiAJ
bXNnLT52aWRfaGRyLnNpemUgPSBzaXplb2Yoc3RydWN0IHN5bnRodmlkX21zZ19oZHIpICsKIAkJ
c2l6ZW9mKHN0cnVjdCBzeW50aHZpZF92cmFtX2xvY2F0aW9uKTsKLQltc2ctPnZyYW0udXNlcl9j
dHggPSBtc2ctPnZyYW0udnJhbV9ncGEgPSBpbmZvLT5maXguc21lbV9zdGFydDsKKwltc2ctPnZy
YW0udXNlcl9jdHggPSBtc2ctPnZyYW0udnJhbV9ncGEgPSBwYXItPm1taW9fcHA7CiAJbXNnLT52
cmFtLmlzX3ZyYW1fZ3BhX3NwZWNpZmllZCA9IDE7CiAJc3ludGh2aWRfc2VuZChoZGV2LCBtc2cp
OwogCkBAIC02MDcsNyArNjgwLDcgQEAgc3RhdGljIGludCBzeW50aHZpZF9zZW5kX2NvbmZpZyhz
dHJ1Y3QgaHZfZGV2aWNlICpoZGV2KQogCQlyZXQgPSAtRVRJTUVET1VUOwogCQlnb3RvIG91dDsK
IAl9Ci0JaWYgKG1zZy0+dnJhbV9hY2sudXNlcl9jdHggIT0gaW5mby0+Zml4LnNtZW1fc3RhcnQp
IHsKKwlpZiAobXNnLT52cmFtX2Fjay51c2VyX2N0eCAhPSBwYXItPm1taW9fcHApIHsKIAkJcHJf
ZXJyKCJVbmFibGUgdG8gc2V0IFZSQU0gbG9jYXRpb25cbiIpOwogCQlyZXQgPSAtRU5PREVWOwog
CQlnb3RvIG91dDsKQEAgLTYyNCwxOSArNjk3LDg1IEBAIHN0YXRpYyBpbnQgc3ludGh2aWRfc2Vu
ZF9jb25maWcoc3RydWN0IGh2X2RldmljZSAqaGRldikKIAogLyoKICAqIERlbGF5ZWQgd29yayBj
YWxsYmFjazoKLSAqIEl0IGlzIGNhbGxlZCBhdCBIVkZCX1VQREFURV9ERUxBWSBvciBsb25nZXIg
dGltZSBpbnRlcnZhbCB0byBwcm9jZXNzCi0gKiBzY3JlZW4gdXBkYXRlcy4gSXQgaXMgcmUtc2No
ZWR1bGVkIGlmIGZ1cnRoZXIgdXBkYXRlIGlzIG5lY2Vzc2FyeS4KKyAqIEl0IGlzIHNjaGVkdWxl
ZCB0byBjYWxsIHdoZW5ldmVyIHVwZGF0ZSByZXF1ZXN0IGlzIHJlY2VpdmVkIGFuZCBpdCBoYXMK
KyAqIG5vdCBiZWVuIGNhbGxlZCBpbiBsYXN0IEhWRkJfT05ERU1BTkRfVEhST1RUTEUgdGltZSBp
bnRlcnZhbC4KICAqLwogc3RhdGljIHZvaWQgaHZmYl91cGRhdGVfd29yayhzdHJ1Y3Qgd29ya19z
dHJ1Y3QgKncpCiB7CiAJc3RydWN0IGh2ZmJfcGFyICpwYXIgPSBjb250YWluZXJfb2Yodywgc3Ry
dWN0IGh2ZmJfcGFyLCBkd29yay53b3JrKTsKIAlzdHJ1Y3QgZmJfaW5mbyAqaW5mbyA9IHBhci0+
aW5mbzsKKwl1bnNpZ25lZCBsb25nIGZsYWdzOworCWludCB4MSwgeDIsIHkxLCB5MjsKKwlpbnQg
ajsKKworCXgxID0geTEgPSAwOworCXgyID0geTIgPSBJTlRfTUFYOworCisJc3Bpbl9sb2NrX2ly
cXNhdmUoJnBhci0+ZGVsYXllZF9yZWZyZXNoX2xvY2ssIGZsYWdzKTsKKwkvKiBSZXNldCB0aGUg
cmVxdWVzdCBmbGFnICovCisJcGFyLT5kZWxheWVkX3JlZnJlc2ggPSBmYWxzZTsKKworCS8qIFN0
b3JlIHRoZSBkaXJ0eSByZWN0YW5nbGUgdG8gbG9jYWwgdmFyaWFibGVzICovCisJeDEgPSBwYXIt
PngxOworCXgyID0gcGFyLT54MjsKKwl5MSA9IHBhci0+eTE7CisJeTIgPSBwYXItPnkyOworCisJ
LyogQ2xlYXIgZGlydHkgcmVjdGFuZ2xlICovCisJcGFyLT54MSA9IHBhci0+eTEgPSBJTlRfTUFY
OworCXBhci0+eDIgPSBwYXItPnkyID0gMDsKIAorCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnBh
ci0+ZGVsYXllZF9yZWZyZXNoX2xvY2ssIGZsYWdzKTsKKworCWlmICh4MSA8IDAgfHwgeDEgPiBp
bmZvLT52YXIueHJlcyB8fCB4MiA8IDAgfHwKKwkgICAgeDIgPiBpbmZvLT52YXIueHJlcyB8fCB5
MSA8IDAgfHwgeTEgPiBpbmZvLT52YXIueXJlcyB8fAorCSAgICB5MiA8IDAgfHwgeTIgPiBpbmZv
LT52YXIueXJlcykKKwkJcmV0dXJuOworCisJLyogQ29weSB0aGUgZGlydHkgcmVjdGFuZ2xlIHRv
IGZyYW1lIGJ1ZmZlciBtZW1vcnkgKi8KKwlzcGluX2xvY2tfaXJxc2F2ZSgmcGFyLT5kb2NvcHlf
bG9jaywgZmxhZ3MpOworCWZvciAoaiA9IHkxOyBqIDw9IHkyICYmIHgxIDwgeDI7IGorKykgewor
CQlpZiAoaiA9PSBpbmZvLT52YXIueXJlcykKKwkJCWJyZWFrOworCQlodmZiX2RvY29weShwYXIs
CisJCQkgICAgaiAqIGluZm8tPmZpeC5saW5lX2xlbmd0aCArCisJCQkgICAgKHgxICogc2NyZWVu
X2RlcHRoIC8gOCksCisJCQkgICAgKHgyIC0geDEgKyAxKSAqIHNjcmVlbl9kZXB0aCAvIDgpOwor
CX0KKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZwYXItPmRvY29weV9sb2NrLCBmbGFncyk7CisK
KwkvKiBSZWZyZXNoICovCiAJaWYgKHBhci0+ZmJfcmVhZHkpCi0JCXN5bnRodmlkX3VwZGF0ZShp
bmZvKTsKKwkJc3ludGh2aWRfdXBkYXRlKGluZm8sIHgxLCB5MSwgeDIsIHkyKTsKK30KKworLyoK
KyAqIENvbnRyb2wgdGhlIG9uLWRlbWFuZCByZWZyZXNoIGZyZXF1ZW5jeS4gSXQgc2NoZWR1bGVz
IGEgZGVsYXllZAorICogc2NyZWVuIHVwZGF0ZSBpZiBpdCBoYXMgbm90IHlldC4KKyAqLworc3Rh
dGljIHZvaWQgaHZmYl9vbmRlbWFuZF9yZWZyZXNoX3Rocm90dGxlKHN0cnVjdCBodmZiX3BhciAq
cGFyLAorCQkJCQkgICBpbnQgeDEsIGludCB5MSwgaW50IHcsIGludCBoKQoreworCXVuc2lnbmVk
IGxvbmcgZmxhZ3M7CisJaW50IHgyID0geDEgKyB3OworCWludCB5MiA9IHkxICsgaDsKKworCXNw
aW5fbG9ja19pcnFzYXZlKCZwYXItPmRlbGF5ZWRfcmVmcmVzaF9sb2NrLCBmbGFncyk7CisKKwkv
KiBNZXJnZSBkaXJ0eSByZWN0YW5nbGUgKi8KKwlwYXItPngxID0gbWluX3QoaW50LCBwYXItPngx
LCB4MSk7CisJcGFyLT55MSA9IG1pbl90KGludCwgcGFyLT55MSwgeTEpOworCXBhci0+eDIgPSBt
YXhfdChpbnQsIHBhci0+eDIsIHgyKTsKKwlwYXItPnkyID0gbWF4X3QoaW50LCBwYXItPnkyLCB5
Mik7CisKKwkvKiBTY2hlZHVsZSBhIGRlbGF5ZWQgc2NyZWVuIHVwZGF0ZSBpZiBub3QgeWV0ICov
CisJaWYgKHBhci0+ZGVsYXllZF9yZWZyZXNoID09IGZhbHNlKSB7CisJCXNjaGVkdWxlX2RlbGF5
ZWRfd29yaygmcGFyLT5kd29yaywKKwkJCQkgICAgICBIVkZCX09OREVNQU5EX1RIUk9UVExFKTsK
KwkJcGFyLT5kZWxheWVkX3JlZnJlc2ggPSB0cnVlOworCX0KIAotCWlmIChwYXItPnVwZGF0ZSkK
LQkJc2NoZWR1bGVfZGVsYXllZF93b3JrKCZwYXItPmR3b3JrLCBIVkZCX1VQREFURV9ERUxBWSk7
CisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmcGFyLT5kZWxheWVkX3JlZnJlc2hfbG9jaywgZmxh
Z3MpOwogfQogCiBzdGF0aWMgaW50IGh2ZmJfb25fcGFuaWMoc3RydWN0IG5vdGlmaWVyX2Jsb2Nr
ICpuYiwKQEAgLTY0OCw3ICs3ODcsOCBAQCBzdGF0aWMgaW50IGh2ZmJfb25fcGFuaWMoc3RydWN0
IG5vdGlmaWVyX2Jsb2NrICpuYiwKIAlwYXIgPSBjb250YWluZXJfb2YobmIsIHN0cnVjdCBodmZi
X3BhciwgaHZmYl9wYW5pY19uYik7CiAJcGFyLT5zeW5jaHJvbm91c19mYiA9IHRydWU7CiAJaW5m
byA9IHBhci0+aW5mbzsKLQlzeW50aHZpZF91cGRhdGUoaW5mbyk7CisJaHZmYl9kb2NvcHkocGFy
LCAwLCBkaW9fZmJfc2l6ZSk7CisJc3ludGh2aWRfdXBkYXRlKGluZm8sIDAsIDAsIElOVF9NQVgs
IElOVF9NQVgpOwogCiAJcmV0dXJuIE5PVElGWV9ET05FOwogfQpAQCAtNzA5LDcgKzg0OSwxMCBA
QCBzdGF0aWMgdm9pZCBodmZiX2NmYl9maWxscmVjdChzdHJ1Y3QgZmJfaW5mbyAqcCwKIAogCWNm
Yl9maWxscmVjdChwLCByZWN0KTsKIAlpZiAocGFyLT5zeW5jaHJvbm91c19mYikKLQkJc3ludGh2
aWRfdXBkYXRlKHApOworCQlzeW50aHZpZF91cGRhdGUocCwgMCwgMCwgSU5UX01BWCwgSU5UX01B
WCk7CisJZWxzZQorCQlodmZiX29uZGVtYW5kX3JlZnJlc2hfdGhyb3R0bGUocGFyLCByZWN0LT5k
eCwgcmVjdC0+ZHksCisJCQkJCSAgICAgICByZWN0LT53aWR0aCwgcmVjdC0+aGVpZ2h0KTsKIH0K
IAogc3RhdGljIHZvaWQgaHZmYl9jZmJfY29weWFyZWEoc3RydWN0IGZiX2luZm8gKnAsCkBAIC03
MTksNyArODYyLDEwIEBAIHN0YXRpYyB2b2lkIGh2ZmJfY2ZiX2NvcHlhcmVhKHN0cnVjdCBmYl9p
bmZvICpwLAogCiAJY2ZiX2NvcHlhcmVhKHAsIGFyZWEpOwogCWlmIChwYXItPnN5bmNocm9ub3Vz
X2ZiKQotCQlzeW50aHZpZF91cGRhdGUocCk7CisJCXN5bnRodmlkX3VwZGF0ZShwLCAwLCAwLCBJ
TlRfTUFYLCBJTlRfTUFYKTsKKwllbHNlCisJCWh2ZmJfb25kZW1hbmRfcmVmcmVzaF90aHJvdHRs
ZShwYXIsIGFyZWEtPmR4LCBhcmVhLT5keSwKKwkJCQkJICAgICAgIGFyZWEtPndpZHRoLCBhcmVh
LT5oZWlnaHQpOwogfQogCiBzdGF0aWMgdm9pZCBodmZiX2NmYl9pbWFnZWJsaXQoc3RydWN0IGZi
X2luZm8gKnAsCkBAIC03MjksNyArODc1LDEwIEBAIHN0YXRpYyB2b2lkIGh2ZmJfY2ZiX2ltYWdl
YmxpdChzdHJ1Y3QgZmJfaW5mbyAqcCwKIAogCWNmYl9pbWFnZWJsaXQocCwgaW1hZ2UpOwogCWlm
IChwYXItPnN5bmNocm9ub3VzX2ZiKQotCQlzeW50aHZpZF91cGRhdGUocCk7CisJCXN5bnRodmlk
X3VwZGF0ZShwLCAwLCAwLCBJTlRfTUFYLCBJTlRfTUFYKTsKKwllbHNlCisJCWh2ZmJfb25kZW1h
bmRfcmVmcmVzaF90aHJvdHRsZShwYXIsIGltYWdlLT5keCwgaW1hZ2UtPmR5LAorCQkJCQkgICAg
ICAgaW1hZ2UtPndpZHRoLCBpbWFnZS0+aGVpZ2h0KTsKIH0KIAogc3RhdGljIHN0cnVjdCBmYl9v
cHMgaHZmYl9vcHMgPSB7CkBAIC03ODgsNiArOTM3LDkgQEAgc3RhdGljIGludCBodmZiX2dldG1l
bShzdHJ1Y3QgaHZfZGV2aWNlICpoZGV2LCBzdHJ1Y3QgZmJfaW5mbyAqaW5mbykKIAlyZXNvdXJj
ZV9zaXplX3QgcG90X3N0YXJ0LCBwb3RfZW5kOwogCWludCByZXQ7CiAKKwlkaW9fZmJfc2l6ZSA9
CisJCXNjcmVlbl93aWR0aCAqIHNjcmVlbl9oZWlnaHQgKiBzY3JlZW5fZGVwdGggLyA4OworCiAJ
aWYgKGdlbjJ2bSkgewogCQlwb3Rfc3RhcnQgPSAwOwogCQlwb3RfZW5kID0gLTE7CkBAIC04MjIs
OSArOTc0LDE1IEBAIHN0YXRpYyBpbnQgaHZmYl9nZXRtZW0oc3RydWN0IGh2X2RldmljZSAqaGRl
diwgc3RydWN0IGZiX2luZm8gKmluZm8pCiAJaWYgKCFmYl92aXJ0KQogCQlnb3RvIGVycjI7CiAK
KwkvKiBBbGxvY2F0ZSBtZW1vcnkgZm9yIGRlZmVycmVkIElPICovCisJcGFyLT5kaW9fdnAgPSB2
emFsbG9jKCgoZGlvX2ZiX3NpemUgPj4gUEFHRV9TSElGVCkgKyAxKQorCQkJCSA8PCBQQUdFX1NI
SUZUKTsKKwlpZiAocGFyLT5kaW9fdnAgPT0gTlVMTCkKKwkJZ290byBlcnIzOworCiAJaW5mby0+
YXBlcnR1cmVzID0gYWxsb2NfYXBlcnR1cmVzKDEpOwogCWlmICghaW5mby0+YXBlcnR1cmVzKQot
CQlnb3RvIGVycjM7CisJCWdvdG8gZXJyNDsKIAogCWlmIChnZW4ydm0pIHsKIAkJaW5mby0+YXBl
cnR1cmVzLT5yYW5nZXNbMF0uYmFzZSA9IHNjcmVlbl9pbmZvLmxmYl9iYXNlOwpAQCAtODM2LDE2
ICs5OTQsMjMgQEAgc3RhdGljIGludCBodmZiX2dldG1lbShzdHJ1Y3QgaHZfZGV2aWNlICpoZGV2
LCBzdHJ1Y3QgZmJfaW5mbyAqaW5mbykKIAkJaW5mby0+YXBlcnR1cmVzLT5yYW5nZXNbMF0uc2l6
ZSA9IHBjaV9yZXNvdXJjZV9sZW4ocGRldiwgMCk7CiAJfQogCisJLyogUGh5c2ljYWwgYWRkcmVz
cyBvZiBGQiBkZXZpY2UgKi8KKwlwYXItPm1taW9fcHAgPSBwYXItPm1lbS0+c3RhcnQ7CisJLyog
VmlydHVhbCBhZGRyZXNzIG9mIEZCIGRldmljZSAqLworCXBhci0+bW1pb192cCA9ICh1bnNpZ25l
ZCBjaGFyICopIGZiX3ZpcnQ7CisKIAlpbmZvLT5maXguc21lbV9zdGFydCA9IHBhci0+bWVtLT5z
dGFydDsKLQlpbmZvLT5maXguc21lbV9sZW4gPSBzY3JlZW5fZmJfc2l6ZTsKLQlpbmZvLT5zY3Jl
ZW5fYmFzZSA9IGZiX3ZpcnQ7Ci0JaW5mby0+c2NyZWVuX3NpemUgPSBzY3JlZW5fZmJfc2l6ZTsK
KwlpbmZvLT5maXguc21lbV9sZW4gPSBkaW9fZmJfc2l6ZTsKKwlpbmZvLT5zY3JlZW5fYmFzZSA9
IHBhci0+ZGlvX3ZwOworCWluZm8tPnNjcmVlbl9zaXplID0gZGlvX2ZiX3NpemU7CiAKIAlpZiAo
IWdlbjJ2bSkKIAkJcGNpX2Rldl9wdXQocGRldik7CiAKIAlyZXR1cm4gMDsKIAorZXJyNDoKKwl2
ZnJlZShwYXItPmRpb192cCk7CiBlcnIzOgogCWlvdW5tYXAoZmJfdmlydCk7CiBlcnIyOgpAQCAt
ODYzLDYgKzEwMjgsNyBAQCBzdGF0aWMgdm9pZCBodmZiX3B1dG1lbShzdHJ1Y3QgZmJfaW5mbyAq
aW5mbykKIHsKIAlzdHJ1Y3QgaHZmYl9wYXIgKnBhciA9IGluZm8tPnBhcjsKIAorCXZmcmVlKHBh
ci0+ZGlvX3ZwKTsKIAlpb3VubWFwKGluZm8tPnNjcmVlbl9iYXNlKTsKIAl2bWJ1c19mcmVlX21t
aW8ocGFyLT5tZW0tPnN0YXJ0LCBzY3JlZW5fZmJfc2l6ZSk7CiAJcGFyLT5tZW0gPSBOVUxMOwpA
QCAtODg4LDYgKzEwNTQsMTIgQEAgc3RhdGljIGludCBodmZiX3Byb2JlKHN0cnVjdCBodl9kZXZp
Y2UgKmhkZXYsCiAJaW5pdF9jb21wbGV0aW9uKCZwYXItPndhaXQpOwogCUlOSVRfREVMQVlFRF9X
T1JLKCZwYXItPmR3b3JrLCBodmZiX3VwZGF0ZV93b3JrKTsKIAorCXBhci0+ZGVsYXllZF9yZWZy
ZXNoID0gZmFsc2U7CisJc3Bpbl9sb2NrX2luaXQoJnBhci0+ZGVsYXllZF9yZWZyZXNoX2xvY2sp
OworCXNwaW5fbG9ja19pbml0KCZwYXItPmRvY29weV9sb2NrKTsKKwlwYXItPngxID0gcGFyLT55
MSA9IElOVF9NQVg7CisJcGFyLT54MiA9IHBhci0+eTIgPSAwOworCiAJLyogQ29ubmVjdCB0byBW
U1AgKi8KIAlodl9zZXRfZHJ2ZGF0YShoZGV2LCBpbmZvKTsKIAlyZXQgPSBzeW50aHZpZF9jb25u
ZWN0X3ZzcChoZGV2KTsKQEAgLTkzOSw2ICsxMTExLDEwIEBAIHN0YXRpYyBpbnQgaHZmYl9wcm9i
ZShzdHJ1Y3QgaHZfZGV2aWNlICpoZGV2LAogCWluZm8tPmZib3BzID0gJmh2ZmJfb3BzOwogCWlu
Zm8tPnBzZXVkb19wYWxldHRlID0gcGFyLT5wc2V1ZG9fcGFsZXR0ZTsKIAorCS8qIEluaXRpYWxp
emUgZGVmZXJyZWQgSU8gKi8KKwlpbmZvLT5mYmRlZmlvID0gJnN5bnRodmlkX2RlZmlvOworCWZi
X2RlZmVycmVkX2lvX2luaXQoaW5mbyk7CisKIAkvKiBTZW5kIGNvbmZpZyB0byBob3N0ICovCiAJ
cmV0ID0gc3ludGh2aWRfc2VuZF9jb25maWcoaGRldik7CiAJaWYgKHJldCkKQEAgLTk2MCw2ICsx
MTM2LDcgQEAgc3RhdGljIGludCBodmZiX3Byb2JlKHN0cnVjdCBodl9kZXZpY2UgKmhkZXYsCiAJ
cmV0dXJuIDA7CiAKIGVycm9yOgorCWZiX2RlZmVycmVkX2lvX2NsZWFudXAoaW5mbyk7CiAJaHZm
Yl9wdXRtZW0oaW5mbyk7CiBlcnJvcjI6CiAJdm1idXNfY2xvc2UoaGRldi0+Y2hhbm5lbCk7Ci0t
IAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
CmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpo
dHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
