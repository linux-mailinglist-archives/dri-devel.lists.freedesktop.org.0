Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 32889D2120
	for <lists+dri-devel@lfdr.de>; Thu, 10 Oct 2019 08:55:17 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E5F756EA97;
	Thu, 10 Oct 2019 06:55:11 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from NAM03-BY2-obe.outbound.protection.outlook.com
 (mail-eopbgr780125.outbound.protection.outlook.com [40.107.78.125])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 032E86EA7D
 for <dri-devel@lists.freedesktop.org>; Thu, 10 Oct 2019 03:19:36 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=TLNvOmcAXu1BVyj78ubiHSrZjwWfI82WH9qy1Kv9RsY1k40ih2v0ftOQFk18OkkPvvUXhC+E46kchCEeI1GYVhiRBB9oHA4s48IjqEU/hv2uO/JfNXPI/5aX6iTQUlbE+Ycv63SIeG2Zy8eSljUvVB1X0J4xTVtUNpyzeucFXRmqf5bJ43aQikRQT50SANyMsnqmUbxuiKAbhjUHauiQAyWDq8OH6TrJIal7w8LUBCl8ElnwnkKFF9FXqmgxHrqxeK4PHmCR686gKJhwQ4uk42oaAWRQjNx1C3DNHqFay4SY+ZocD4EUhQ6+XiERH4cyY6PBZKLsh8www3BBYGfU9w==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=1k/h9x6BMxzo8Eu/CIuJyI6dedAQXn9XD490CAdTSXs=;
 b=F3PIOLNbvyvYxyslDGYqANsvpgwMUohjxeRTB8JbVLy4wwEZ10UBwijM6xpz8ivjbyXhbpJV012Wih3cVyD0YxmF5ar8MevL3GKEJrUV747qgms7ITaaKp9LXNZCz/a+5CKxazR9lxpSce9I1Zjtjhk29bVbZFXT1KadA59Rwzh57GmfbFIMown96hdcP07DrSqJ8cjgV7Yw2TKLlr6zKRBVDcJDWieB82qIAm3v5Gj0hOwnyYp7btXW4E77FqscOg6NG3oZyZniJi2C0f+zp4CHw30eYWJKiiDO3NSvJJiYPIVYUMPsBzMO4kMBz0ZAcfQzdJVeplBu/4M7BHNbLQ==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=analogixsemi.com; dmarc=pass action=none
 header.from=analogixsemi.com; dkim=pass header.d=analogixsemi.com; arc=none
Received: from SN6PR04MB4543.namprd04.prod.outlook.com (52.135.120.29) by
 SN6PR04MB3806.namprd04.prod.outlook.com (52.135.81.27) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2327.24; Thu, 10 Oct 2019 03:19:34 +0000
Received: from SN6PR04MB4543.namprd04.prod.outlook.com
 ([fe80::c55e:6c70:adbb:cf87]) by SN6PR04MB4543.namprd04.prod.outlook.com
 ([fe80::c55e:6c70:adbb:cf87%5]) with mapi id 15.20.2347.016; Thu, 10 Oct 2019
 03:19:33 +0000
From: Xin Ji <xji@analogixsemi.com>
To: Dan Carpenter <dan.carpenter@oracle.com>
Subject: Re: [PATCH v2 2/2] drm/bridge: anx7625: Add anx7625 MIPI DSI/DPI to
 DP bridge driver
Thread-Topic: [PATCH v2 2/2] drm/bridge: anx7625: Add anx7625 MIPI DSI/DPI to
 DP bridge driver
Thread-Index: AQHVfoPZsDTKCGgGvEaBZzoEPcILl6dSLOMAgAEJG4A=
Date: Thu, 10 Oct 2019 03:19:32 +0000
Message-ID: <20191010031922.GA10005@xin-VirtualBox>
References: <cover.1570588741.git.xji@analogixsemi.com>
 <6ad16e52cd7591d320001a842fc357d976006ef7.1570588741.git.xji@analogixsemi.com>
 <20191009113032.GL25098@kadam>
In-Reply-To: <20191009113032.GL25098@kadam>
Accept-Language: zh-CN, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: HK0P153CA0031.APCP153.PROD.OUTLOOK.COM
 (2603:1096:203:17::19) To SN6PR04MB4543.namprd04.prod.outlook.com
 (2603:10b6:805:a8::29)
x-ms-exchange-messagesentrepresentingtype: 1
x-originating-ip: [114.247.245.252]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 813e5d9c-f190-4089-9989-08d74d30aa9e
x-ms-traffictypediagnostic: SN6PR04MB3806:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <SN6PR04MB380696141059A98CEE751B3CC7940@SN6PR04MB3806.namprd04.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:1728;
x-forefront-prvs: 018632C080
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10019020)(7916004)(366004)(136003)(346002)(376002)(39850400004)(396003)(189003)(199004)(66066001)(66556008)(66476007)(66446008)(4326008)(66946007)(64756008)(14444005)(7736002)(33716001)(5024004)(2906002)(6246003)(107886003)(71200400001)(71190400001)(5660300002)(6116002)(256004)(3846002)(1076003)(561924002)(30864003)(86362001)(6916009)(25786009)(7416002)(386003)(8936002)(76176011)(6512007)(6506007)(446003)(26005)(9686003)(186003)(102836004)(99286004)(486006)(229853002)(6486002)(52116002)(6436002)(11346002)(476003)(316002)(54906003)(33656002)(14454004)(478600001)(81156014)(81166006)(8676002)(305945005)(559001)(569006);
 DIR:OUT; SFP:1102; SCL:1; SRVR:SN6PR04MB3806;
 H:SN6PR04MB4543.namprd04.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; MX:1; A:1; 
received-spf: None (protection.outlook.com: analogixsemi.com does not
 designate permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: jPRw3s2/za78dMBVy50lC0QHggIS99Gq5WLrrtXE5a2d+O5cyrY4S+s916ItrNheDjRJvXEDnoFHWVj63AExcgOGp8IfFfF7URJ5SgqOlqq3fPjmhJ8gIO6SUWNshi96M7K9tNR++yoyyOXFQhKmTPZZqEXQfXbG7Wk3WrOiOtZv/iAmLLoB2vq7fYK/QIrGSLEJGdYhPI4feboEIzyHZGzJRyUHXvkpRZZXYCrj1RnSsAWqiaOLU60jhWw6sXt5RKnxGvoF2hIjguZ+ecRonOzhVvAIzaM6S5E+5lZRTiy1EAYYaQ3RB9gfgZLY2RgME/Bz1wUF3S7+n/uhm5I9rq+OpnLF8iAjPUQeJFU6oZ6UXu2sk8ZWarPjDJM4BMG6jLAgu6E+l20AUwbKpsWH8I5SKuDNSFKvOnP3RaELrEk=
Content-ID: <F2B999F1C28ECB44AC0DEE38CB954619@namprd04.prod.outlook.com>
MIME-Version: 1.0
X-OriginatorOrg: analogixsemi.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 813e5d9c-f190-4089-9989-08d74d30aa9e
X-MS-Exchange-CrossTenant-originalarrivaltime: 10 Oct 2019 03:19:33.6040 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: b099b0b4-f26c-4cf5-9a0f-d5be9acab205
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: 57zzHSLFhF6pPxNgfKm3ADH8brbMil+/WSf7LqG5He3Ihwp3aS7MASvq12ffDvbqdBi8YFdEHxARUyHQDtNcvQ==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: SN6PR04MB3806
X-Mailman-Approved-At: Thu, 10 Oct 2019 06:55:05 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=Analogixsemi.onmicrosoft.com; s=selector2-Analogixsemi-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=1k/h9x6BMxzo8Eu/CIuJyI6dedAQXn9XD490CAdTSXs=;
 b=Nh/uND/HDBb7n2vTasNXLTHvAvXc7aRkJwpDAKNIGHhG+FP3JpomGzBvOJ0xGAXIwFgIxuzYinflaz2uI+dQTvRJGvpS3kyj2AXMmfR1ZK1EeCcTaTskUqRV+YjvuEY4F9Xn33qGXfMww2vadnd/k8NZ6TlN2SNKvbLydnMLIJg=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=xji@analogixsemi.com; 
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: "devel@driverdev.osuosl.org" <devel@driverdev.osuosl.org>,
 Jernej Skrabec <jernej.skrabec@siol.net>, Jonas Karlman <jonas@kwiboo.se>,
 David Airlie <airlied@linux.ie>, Neil Armstrong <narmstrong@baylibre.com>,
 "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
 "dri-devel@lists.freedesktop.org" <dri-devel@lists.freedesktop.org>,
 Laurent Pinchart <laurent.pinchart@ideasonboard.com>,
 Dan Carpenter <dan.carpenter@oracle.com>, Sheng Pan <span@analogixsemi.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SGkgRGFuIENhcnBlbnRlciwgc29ycnkgZm9yIHRoYXQsIEkgc2VuZCB0aGUgd3JvbmcgcGF0Y2gs
IEkgZGlkbid0CmNvcnJlY3RseSBtZXJnZSB0aGUgY2hhbmdlZCBjb2RlLiBXaWxsIHNlbmQgdGhl
IG5ldyBwYXRjaCBiYXNlZCBvbiB5b3VyCm5ldyBjb21tZW50cy4KClRoYW5rcywKWGluCgpPbiBX
ZWQsIE9jdCAwOSwgMjAxOSBhdCAwMjozMDozMlBNICswMzAwLCBEYW4gQ2FycGVudGVyIHdyb3Rl
Ogo+IEFyZSB5b3Ugc3VyZSB5b3Ugc2VudCB0aGUgY29ycmVjdCBwYXRjaD8gIFRoaXMgaGFzIG1h
bnkgb2YgdGhlIHNhbWUKPiBzdHlsZSBpc3N1ZXMgSSBtZW50aW9uZWQgaW4gdGhlIHByZXZpb3Vz
IGVtYWlsLiAgVGhlIGVycm9yIGhhbmRsaW5nCj4gaW4gZWRpZF9yZWFkKCkgaXMgd3JvbmcuICBw
cm9iZSgpIHdpbGwgc3RpbGwgY3Jhc2ggaWYgYWxsb2NhdGluZyB0aGUKPiB3b3JrIHF1ZXVlIGZh
aWxzLgo+IAo+IE9uIFdlZCwgT2N0IDA5LCAyMDE5IGF0IDA5OjI4OjAyQU0gKzAwMDAsIFhpbiBK
aSB3cm90ZToKPiA+IFRoZSBBTlg3NjI1IGlzIGFuIHVsdHJhLWxvdyBwb3dlciA0SyBNb2JpbGUg
SEQgVHJhbnNtaXR0ZXIgZGVzaWduZWQKPiA+IGZvciBwb3J0YWJsZSBkZXZpY2UuIEl0IGNvbnZl
cnRzIE1JUEkgRFNJL0RQSSB0byBEaXNwbGF5UG9ydCAxLjMgNEsuCj4gPiAKPiA+IFRoZSBBTlg3
NjI1IGNhbiBzdXBwb3J0IGJvdGggVVNCIFR5cGUtQyBQRCBmZWF0dXJlIGFuZCBNSVBJIERTSS9E
UEkKPiA+IHRvIERQIGZlYXR1cmUuIFRoaXMgZHJpdmVyIG9ubHkgZW5hYmxlZCBNSVBJIERTSS9E
UEkgdG8gRFAgZmVhdHVyZS4KPiA+IAo+ID4gU2lnbmVkLW9mZi1ieTogWGluIEppIDx4amlAYW5h
bG9naXhzZW1pLmNvbT4KPiA+IC0tLQo+ID4gIGRyaXZlcnMvZ3B1L2RybS9icmlkZ2UvTWFrZWZp
bGUgICAgICAgICAgIHwgICAgMiArLQo+ID4gIGRyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9n
aXgvS2NvbmZpZyAgIHwgICAgNiArCj4gPiAgZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dp
eC9NYWtlZmlsZSAgfCAgICAxICsKPiA+ICBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4
L2FueDc2MjUuYyB8IDIxMzIgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKPiA+ICBkcml2
ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L2FueDc2MjUuaCB8ICA0MDUgKysrKysrCj4gPiAg
NSBmaWxlcyBjaGFuZ2VkLCAyNTQ1IGluc2VydGlvbnMoKyksIDEgZGVsZXRpb24oLSkKPiA+ICBj
cmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9hbng3NjI1
LmMKPiA+ICBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dp
eC9hbng3NjI1LmgKPiA+IAo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2Uv
TWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL01ha2VmaWxlCj4gPiBpbmRleCA0OTM0
ZmNmLi5iY2QzODhhIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9NYWtl
ZmlsZQo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9NYWtlZmlsZQo+ID4gQEAgLTEy
LDggKzEyLDggQEAgb2JqLSQoQ09ORklHX0RSTV9TSUk5MjM0KSArPSBzaWk5MjM0Lm8KPiA+ICBv
YmotJChDT05GSUdfRFJNX1RISU5FX1RIQzYzTFZEMTAyNCkgKz0gdGhjNjNsdmQxMDI0Lm8KPiA+
ICBvYmotJChDT05GSUdfRFJNX1RPU0hJQkFfVEMzNTg3NjQpICs9IHRjMzU4NzY0Lm8KPiA+ICBv
YmotJChDT05GSUdfRFJNX1RPU0hJQkFfVEMzNTg3NjcpICs9IHRjMzU4NzY3Lm8KPiA+IC1vYmot
JChDT05GSUdfRFJNX0FOQUxPR0lYX0RQKSArPSBhbmFsb2dpeC8KPiA+ICBvYmotJChDT05GSUdf
RFJNX0kyQ19BRFY3NTExKSArPSBhZHY3NTExLwo+ID4gIG9iai0kKENPTkZJR19EUk1fVElfU042
NURTSTg2KSArPSB0aS1zbjY1ZHNpODYubwo+ID4gIG9iai0kKENPTkZJR19EUk1fVElfVEZQNDEw
KSArPSB0aS10ZnA0MTAubwo+ID4gK29iai15ICs9IGFuYWxvZ2l4Lwo+ID4gIG9iai15ICs9IHN5
bm9wc3lzLwo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgv
S2NvbmZpZyBiL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvS2NvbmZpZwo+ID4gaW5k
ZXggZTkzMGZmOS4uYjJmMTI3ZSAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9icmlk
Z2UvYW5hbG9naXgvS2NvbmZpZwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFs
b2dpeC9LY29uZmlnCj4gPiBAQCAtMiwzICsyLDkgQEAKPiA+ICBjb25maWcgRFJNX0FOQUxPR0lY
X0RQCj4gPiAgCXRyaXN0YXRlCj4gPiAgCWRlcGVuZHMgb24gRFJNCj4gPiArCj4gPiArY29uZmln
IEFOQUxPR0lYX0FOWDc2MjUKPiA+ICsJdHJpc3RhdGUgIkFuYWxvZ2l4IE1JUEkgdG8gRFAgaW50
ZXJmYWNlIHN1cHBvcnQiCj4gPiArCWhlbHAKPiA+ICsJCUFOWDc2MjUgaXMgYW4gdWx0cmEtbG93
IHBvd2VyIDRLIG1vYmlsZSBIRCB0cmFuc21pdHRlciBkZXNpZ25lZAo+ID4gKwkJZm9yIHBvcnRh
YmxlIGRldmljZXMuIEl0IGNvbnZlcnRzIE1JUEkvRFBJIHRvIERpc3BsYXlQb3J0MS4zIDRLLgo+
ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvTWFrZWZpbGUg
Yi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L01ha2VmaWxlCj4gPiBpbmRleCBmZGJm
M2ZkLi44YTUyODY3IDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFs
b2dpeC9NYWtlZmlsZQo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9N
YWtlZmlsZQo+ID4gQEAgLTEsMyArMSw0IEBACj4gPiAgIyBTUERYLUxpY2Vuc2UtSWRlbnRpZmll
cjogR1BMLTIuMC1vbmx5Cj4gPiArb2JqLSQoQ09ORklHX0FOQUxPR0lYX0FOWDc2MjUpICs9IGFu
eDc2MjUubwo+ID4gIGFuYWxvZ2l4X2RwLW9ianMgOj0gYW5hbG9naXhfZHBfY29yZS5vIGFuYWxv
Z2l4X2RwX3JlZy5vCj4gPiAgb2JqLSQoQ09ORklHX0RSTV9BTkFMT0dJWF9EUCkgKz0gYW5hbG9n
aXhfZHAubwo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgv
YW54NzYyNS5jIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9hbng3NjI1LmMKPiA+
IG5ldyBmaWxlIG1vZGUgMTAwNjQ0Cj4gPiBpbmRleCAwMDAwMDAwLi43YmI0ZTE3Cj4gPiAtLS0g
L2Rldi9udWxsCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L2FueDc2
MjUuYwo+ID4gQEAgLTAsMCArMSwyMTMyIEBACj4gPiArLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IEdQTC0yLjAtb25seQo+ID4gKy8qCj4gPiArICogQ29weXJpZ2h0KGMpIDIwMTYsIEFuYWxv
Z2l4IFNlbWljb25kdWN0b3IuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCj4gPiArICoKPiA+ICsgKi8K
PiA+ICsjaW5jbHVkZSA8bGludXgvZXh0Y29uLmg+Cj4gPiArI2luY2x1ZGUgPGxpbnV4L2djZC5o
Pgo+ID4gKyNpbmNsdWRlIDxsaW51eC9ncGlvL2NvbnN1bWVyLmg+Cj4gPiArI2luY2x1ZGUgPGxp
bnV4L2kyYy5oPgo+ID4gKyNpbmNsdWRlIDxsaW51eC9pbnRlcnJ1cHQuaD4KPiA+ICsjaW5jbHVk
ZSA8bGludXgvaW9wb2xsLmg+Cj4gPiArI2luY2x1ZGUgPGxpbnV4L2tlcm5lbC5oPgo+ID4gKyNp
bmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KPiA+ICsjaW5jbHVkZSA8bGludXgvbXV0ZXguaD4KPiA+
ICsjaW5jbHVkZSA8bGludXgvc2xhYi5oPgo+ID4gKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgo+
ID4gKyNpbmNsdWRlIDxsaW51eC93b3JrcXVldWUuaD4KPiA+ICsKPiA+ICsjaW5jbHVkZSA8bGlu
dXgvb2ZfZ3Bpby5oPgo+ID4gKyNpbmNsdWRlIDxsaW51eC9vZl9ncmFwaC5oPgo+ID4gKyNpbmNs
dWRlIDxsaW51eC9vZl9wbGF0Zm9ybS5oPgo+ID4gKwo+ID4gKyNpbmNsdWRlIDxkcm0vZHJtX2F0
b21pY19oZWxwZXIuaD4KPiA+ICsjaW5jbHVkZSA8ZHJtL2RybV9icmlkZ2UuaD4KPiA+ICsjaW5j
bHVkZSA8ZHJtL2RybV9jcnRjX2hlbHBlci5oPgo+ID4gKyNpbmNsdWRlIDxkcm0vZHJtX2RwX2hl
bHBlci5oPgo+ID4gKyNpbmNsdWRlIDxkcm0vZHJtX2VkaWQuaD4KPiA+ICsjaW5jbHVkZSA8ZHJt
L2RybV9taXBpX2RzaS5oPgo+ID4gKyNpbmNsdWRlIDxkcm0vZHJtX3BhbmVsLmg+Cj4gPiArI2lu
Y2x1ZGUgPGRybS9kcm1fcHJpbnQuaD4KPiA+ICsjaW5jbHVkZSA8ZHJtL2RybV9wcm9iZV9oZWxw
ZXIuaD4KPiA+ICsKPiA+ICsjaW5jbHVkZSA8dmlkZW8vZGlzcGxheV90aW1pbmcuaD4KPiA+ICsK
PiA+ICsjaW5jbHVkZSAiYW54NzYyNS5oIgo+ID4gKwo+ID4gKy8qCj4gPiArICogdGhlcmUgaXMg
YSBzeW5jIGlzc3VlIHdoaWxlIGFjY2VzcyBJMkMgcmVnaXN0ZXIgYmV0d2VlbiBBUChDUFUpIGFu
ZAo+ID4gKyAqIGludGVybmFsIGZpcm13YXJlKE9DTSksIHRvIGF2b2lkIHRoZSByYWNlIGNvbmRp
dGlvbiwgQVAgc2hvdWxkIGFjY2Vzcwo+ID4gKyAqIHRoZSByZXNlcnZlZCBzbGF2ZSBhZGRyZXNz
IGJlZm9yZSBzbGF2ZSBhZGRyZXNzIG9jY3VycyBjaGFuZ2VzLgo+ID4gKyAqLwo+ID4gK3N0YXRp
YyBpbnQgaTJjX2FjY2Vzc193b3JrYXJvdW5kKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKPiA+
ICsJCQkJIHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQpCj4gPiArewo+ID4gKwl1OCBvZmZzZXQ7
Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjbGllbnQtPmRldjsKPiA+ICsJc3RydWN0IGky
Y19jbGllbnQgKmxhc3RfY2xpZW50ID0gY3R4LT5sYXN0X2NsaWVudDsKPiA+ICsJaW50IHJldCA9
IDA7Cj4gPiArCj4gPiArCWlmIChjbGllbnQgIT0gbGFzdF9jbGllbnQpIHsKPiAKPiAKPiBQbGVh
c2UgcmV2ZXJzZSB0aGlzIGNvbmRpdGlvbi4KPiAKPiAJaWYgKGNsaWVudCA9PSBjdHgtPmxhc3Rf
Y2xpZW50KQo+IAkJcmV0dXJuIDA7Cj4gCj4gR2V0IHJpZCBvZiB0aGUgbGFzdF9jbGllbnQgdmFy
aWFibGUuCj4gCj4gCj4gPiArCQljdHgtPmxhc3RfY2xpZW50ID0gY2xpZW50Owo+ID4gKwo+ID4g
KwkJaWYgKGNsaWVudCA9PSBjdHgtPmkyYy50Y3BjX2NsaWVudCkKPiA+ICsJCQlvZmZzZXQgPSBS
U1ZEXzAwX0FERFI7Cj4gPiArCQllbHNlIGlmIChjbGllbnQgPT0gY3R4LT5pMmMudHhfcDBfY2xp
ZW50KQo+ID4gKwkJCW9mZnNldCA9IFJTVkRfRDFfQUREUjsKPiA+ICsJCWVsc2UgaWYgKGNsaWVu
dCA9PSBjdHgtPmkyYy50eF9wMV9jbGllbnQpCj4gPiArCQkJb2Zmc2V0ID0gUlNWRF82MF9BRERS
Owo+ID4gKwkJZWxzZSBpZiAoY2xpZW50ID09IGN0eC0+aTJjLnJ4X3AwX2NsaWVudCkKPiA+ICsJ
CQlvZmZzZXQgPSBSU1ZEXzM5X0FERFI7Cj4gPiArCQllbHNlIGlmIChjbGllbnQgPT0gY3R4LT5p
MmMucnhfcDFfY2xpZW50KQo+ID4gKwkJCW9mZnNldCA9IFJTVkRfN0ZfQUREUjsKPiA+ICsJCWVs
c2UKPiA+ICsJCQlvZmZzZXQgPSBSU1ZEXzAwX0FERFI7Cj4gPiArCj4gPiArCQlyZXQgPSBpMmNf
c21idXNfd3JpdGVfYnl0ZV9kYXRhKGNsaWVudCwgb2Zmc2V0LCAweDAwKTsKPiA+ICsJCWlmIChy
ZXQgPCAwKQo+ID4gKwkJCURSTV9ERVZfRVJST1IoZGV2LAo+ID4gKwkJCQkgICAgICAiZmFpbGVk
IHRvIGFjY2VzcyBpMmMgaWQ9JXhcbjoleCIsCj4gPiArCQkJCSAgICAgIGNsaWVudC0+YWRkciwg
b2Zmc2V0KTsKPiA+ICsJfQo+ID4gKwo+ID4gKwlyZXR1cm4gcmV0Owo+ID4gK30KPiA+ICsKPiA+
ICtzdGF0aWMgaW50IGFueDc2MjVfcmVnX3JlYWQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAo+
ID4gKwkJCSAgICBzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50LCB1OCByZWdfYWRkcikKPiA+ICt7
Cj4gPiArCWludCByZXQ7Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjbGllbnQtPmRldjsK
PiA+ICsKPiA+ICsJaTJjX2FjY2Vzc193b3JrYXJvdW5kKGN0eCwgY2xpZW50KTsKPiA+ICsKPiA+
ICsJcmV0ID0gaTJjX3NtYnVzX3JlYWRfYnl0ZV9kYXRhKGNsaWVudCwgcmVnX2FkZHIpOwo+ID4g
KwlpZiAocmV0IDwgMCkKPiA+ICsJCURSTV9ERVZfRVJST1IoZGV2LCAicmVhZCBpMmMgZmFpbGVk
IGlkPSV4OiV4XG4iLAo+ID4gKwkJCSAgICAgIGNsaWVudC0+YWRkciwgcmVnX2FkZHIpOwo+ID4g
Kwo+ID4gKwlyZXR1cm4gcmV0Owo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW50IGFueDc2MjVf
cmVnX2Jsb2NrX3JlYWQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAo+ID4gKwkJCQkgIHN0cnVj
dCBpMmNfY2xpZW50ICpjbGllbnQsCj4gPiArCQkJCSAgdTggcmVnX2FkZHIsIHU4IGxlbiwgdTgg
KmJ1ZikKPiA+ICt7Cj4gPiArCWludCByZXQ7Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZj
bGllbnQtPmRldjsKPiA+ICsKPiA+ICsJaTJjX2FjY2Vzc193b3JrYXJvdW5kKGN0eCwgY2xpZW50
KTsKPiA+ICsKPiA+ICsJcmV0ID0gaTJjX3NtYnVzX3JlYWRfaTJjX2Jsb2NrX2RhdGEoY2xpZW50
LCByZWdfYWRkciwgbGVuLCBidWYpOwo+ID4gKwlpZiAocmV0IDwgMCkKPiA+ICsJCURSTV9ERVZf
RVJST1IoZGV2LCAicmVhZCBpMmMgYmxvY2sgZmFpbGVkIGlkPSV4OiV4XG4iLAo+ID4gKwkJCSAg
ICAgIGNsaWVudC0+YWRkciwgcmVnX2FkZHIpOwo+ID4gKwo+ID4gKwlyZXR1cm4gcmV0Owo+ID4g
K30KPiA+ICsKPiA+ICtzdGF0aWMgaW50IGFueDc2MjVfcmVnX3dyaXRlKHN0cnVjdCBhbng3NjI1
X2RhdGEgKmN0eCwKPiA+ICsJCQkgICAgIHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQsCj4gPiAr
CQkJICAgICB1OCByZWdfYWRkciwgdTggcmVnX3ZhbCkKPiA+ICt7Cj4gPiArCWludCByZXQ7Cj4g
PiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjbGllbnQtPmRldjsKPiA+ICsKPiA+ICsJaTJjX2Fj
Y2Vzc193b3JrYXJvdW5kKGN0eCwgY2xpZW50KTsKPiA+ICsKPiA+ICsJcmV0ID0gaTJjX3NtYnVz
X3dyaXRlX2J5dGVfZGF0YShjbGllbnQsIHJlZ19hZGRyLCByZWdfdmFsKTsKPiA+ICsKPiA+ICsJ
aWYgKHJldCA8IDApCj4gPiArCQlEUk1fREVWX0VSUk9SKGRldiwgImZhaWxlZCB0byB3cml0ZSBp
MmMgaWQ9JXhcbjoleCIsCj4gPiArCQkJICAgICAgY2xpZW50LT5hZGRyLCByZWdfYWRkcik7Cj4g
PiArCj4gPiArCXJldHVybiByZXQ7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgYW54NzYy
NV93cml0ZV9vcihzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCj4gPiArCQkJICAgIHN0cnVjdCBp
MmNfY2xpZW50ICpjbGllbnQsCj4gPiArCQkJICAgIHU4IG9mZnNldCwgdTggbWFzaykKPiA+ICt7
Cj4gPiArCWludCB2YWwgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY2xpZW50LCBvZmZzZXQpOwo+
ID4gKwo+ID4gKwlyZXR1cm4gKHZhbCA8IDApID8gdmFsIDoKPiA+ICsJCWFueDc2MjVfcmVnX3dy
aXRlKGN0eCwgY2xpZW50LCBvZmZzZXQsICh2YWwgfCAobWFzaykpKTsKPiAKPiAKPiBQbGVhc2Ug
d3JpdGUgaXQgbGlrZSB0aGlzOgo+IAo+IHN0YXRpYyBpbnQgYW54NzYyNV93cml0ZV9vcihzdHJ1
Y3QgYW54NzYyNV9kYXRhICpjdHgsCj4gCQkJICAgIHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQs
Cj4gCQkJICAgIHU4IG9mZnNldCwgdTggbWFzaykKPiB7Cj4gCWludCB2YWw7Cj4gCj4gCXZhbCA9
IGFueDc2MjVfcmVnX3JlYWQoY3R4LCBjbGllbnQsIG9mZnNldCk7Cj4gCWlmICh2YWwgPCAwKQo+
IAkJcmV0dXJuIHZhbDsKPiAKPiAJcmV0dXJuIGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY2xpZW50
LCBvZmZzZXQsICh2YWwgfCAobWFzaykpKTsKPiB9Cj4gCj4gPiArfQo+ID4gKwo+ID4gK3N0YXRp
YyBpbnQgYW54NzYyNV93cml0ZV9hbmQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAo+ID4gKwkJ
CSAgICAgc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCwKPiA+ICsJCQkgICAgIHU4IG9mZnNldCwg
dTggbWFzaykKPiA+ICt7Cj4gPiArCWludCB2YWwgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY2xp
ZW50LCBvZmZzZXQpOwo+ID4gKwo+ID4gKwlyZXR1cm4gKHZhbCA8IDApID8gdmFsIDoKPiA+ICsJ
CWFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY2xpZW50LCBvZmZzZXQsICh2YWwgJiAobWFzaykpKTsK
PiAKPiBTYW1lLgo+IAo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW50IGFueDc2MjVfd3JpdGVf
YW5kX29yKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKPiA+ICsJCQkJc3RydWN0IGkyY19jbGll
bnQgKmNsaWVudCwKPiA+ICsJCQkJdTggb2Zmc2V0LCB1OCBhbmRfbWFzaywgdTggb3JfbWFzaykK
PiA+ICt7Cj4gPiArCWludCB2YWwgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY2xpZW50LCBvZmZz
ZXQpOwo+ID4gKwo+ID4gKwlyZXR1cm4gKHZhbCA8IDApID8gdmFsIDoKPiA+ICsJCWFueDc2MjVf
cmVnX3dyaXRlKGN0eCwgY2xpZW50LCBvZmZzZXQsCj4gPiArCQkJCSAgKHZhbCAmIGFuZF9tYXNr
KSB8IChvcl9tYXNrKSk7Cj4gCj4gU2FtZS4KPiAKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGlu
dCBhbng3NjI1X2NvbmZpZ19iaXRfbWF0cml4KHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKPiA+
ICt7Cj4gPiArCWludCBpLCByZXQ7Cj4gPiArCj4gPiArCXJldCA9IGFueDc2MjVfcmVnX3dyaXRl
KGN0eCwgY3R4LT5pMmMudHhfcDJfY2xpZW50LAo+ID4gKwkJCQlBVURJT19DT05UUk9MX1JFR0lT
VEVSLCAweDgwKTsKPiA+ICsJZm9yIChpID0gMDsgaSA8IDEzOyBpKyspCj4gPiArCQlyZXQgfD0g
YW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy50eF9wMl9jbGllbnQsCj4gPiArCQkJCQkg
VklERU9fQklUX01BVFJJWF8xMiArIGksCj4gPiArCQkJCQkgMHgxOCArIGkpOwo+ID4gKwo+ID4g
KwlyZXR1cm4gcmV0Owo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW50IGFueDc2MjVfcmVhZF9j
dHJsX3N0YXR1c19wMChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gPiArewo+ID4gKwlyZXR1
cm4gYW54NzYyNV9yZWdfcmVhZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwgQVBfQVVYX0NU
UkxfU1RBVFVTKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCB3YWl0X2F1eF9vcF9maW5p
c2goc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQo+ID4gK3sKPiA+ICsJaW50IHZhbDsKPiA+ICsJ
aW50IHJldDsKPiA+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7Cj4g
PiArCj4gPiArCXJldCA9IHJlYWR4X3BvbGxfdGltZW91dChhbng3NjI1X3JlYWRfY3RybF9zdGF0
dXNfcDAsCj4gPiArCQkJCSBjdHgsIHZhbCwKPiA+ICsJCQkJICghKHZhbCAmIEFQX0FVWF9DVFJM
X09QX0VOKSB8fCAodmFsIDwgMCkpLAo+ID4gKwkJCQkgMjAwMCwKPiA+ICsJCQkJIDIwMDAgKiAx
NTApOwo+ID4gKwlpZiAocmV0KSB7Cj4gPiArCQlEUk1fREVWX0VSUk9SKGRldiwgImF1eCBvcGVy
YXRpb24gZmFpbGVkIVxuIik7Cj4gPiArCQl2YWwgPSAtRUlPOwo+IAo+IFJldHVybiBkaXJlY3Rs
eSBoZXJlOgo+IAo+IAkJcmV0dXJuIC1FSU87Cj4gCj4gPiArCX0gZWxzZSB7Cj4gPiArCQl2YWwg
PSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ID4gKwkJCQkg
ICAgICAgQVBfQVVYX0NUUkxfU1RBVFVTKTsKPiA+ICsJCWlmICh2YWwgPCAwIHx8ICh2YWwgJiAw
eDBGKSkgewo+ID4gKwkJCURSTV9ERVZfRVJST1IoZGV2LCAiYXV4IHN0YXR1cyAlMDJ4XG4iLCB2
YWwpOwo+ID4gKwkJCXZhbCA9IC1FSU87Cj4gPiArCQl9Cj4gPiArCX0KPiA+ICsKPiA+ICsJcmV0
dXJuIHZhbDsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCB3cml0ZV9kcGNkX2FkZHIoc3Ry
dWN0IGFueDc2MjVfZGF0YSAqY3R4LAo+ID4gKwkJCSAgIHU4IGFkZHJoLCB1OCBhZGRybSwgdTgg
YWRkcmwpCj4gPiArewo+ID4gKwlpbnQgcmV0Owo+ID4gKwo+ID4gKwlyZXQgPSBhbng3NjI1X3Jl
Z193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiA+ICsJCQkJQVBfQVVYX0FERFJf
N18wLCAodTgpYWRkcmwpOwo+ID4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgt
PmkyYy5yeF9wMF9jbGllbnQsCj4gPiArCQkJCSBBUF9BVVhfQUREUl8xNV84LCAodTgpYWRkcm0p
Owo+ID4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGll
bnQsCj4gPiArCQkJCSBBUF9BVVhfQUREUl8xOV8xNiwgKHU4KWFkZHJoKTsKPiA+ICsKPiA+ICsJ
cmV0dXJuIHJldDsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBzcF90eF9hdXhfZHBjZHJl
YWRfYnl0ZXMoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAo+ID4gKwkJCQkgICAgdTggYWRkcmgs
IHU4IGFkZHJtLAo+ID4gKwkJCQkgICAgdTggYWRkcmwsIHU4IGNvdW50LAo+ID4gKwkJCQkgICAg
dTggKmJ1ZikKPiA+ICt7Cj4gPiArCXU4IGM7Cj4gPiArCWludCByZXQ7Cj4gPiArCXN0cnVjdCBk
ZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ID4gKwo+ID4gKwlpZiAoV0FSTl9PTihj
b3VudCA+IChzaXplX3QpTUFYX0RQQ0RfQlVGRkVSX1NJWkUpKQo+IAo+IE5vIG5lZWQgZm9yIHRo
aXMgY2FzdC4KPiAKPiA+ICsJCXJldHVybiAtRTJCSUc7Cj4gPiArCj4gPiArCS8qIGNvbW1hbmQg
YW5kIGxlbmd0aCAqLwo+ID4gKwljID0gKChjb3VudCAtIDEpIDw8IDQpIHwgMHgwOTsKPiAKPiBJ
ZiBjb3VudCA9PSAwIHRoaXMgd291bGQgY2F1c2UgYSBwcm9ibGVtLiAgQnV0IGNvdW50IGlzIG5l
dmVyIGludmFsaWQKPiBzbyB0aGF0J3Mgb2theS4KPiAKPiA+ICsJcmV0ID0gYW54NzYyNV9yZWdf
d3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsIEFQX0FVWF9DT01NQU5ELCBjKTsKPiA+
ICsJLyogYWRkcmVzcyAqLwo+ID4gKwlyZXQgfD0gd3JpdGVfZHBjZF9hZGRyKGN0eCwgYWRkcmgs
IGFkZHJtLCBhZGRybCk7Cj4gPiArCS8qIGF1eCBlbiAqLwo+ID4gKwlyZXQgfD0gYW54NzYyNV93
cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwgQVBfQVVYX0NUUkxfU1RBVFVTLAo+
ID4gKwkJCQlBUF9BVVhfQ1RSTF9PUF9FTik7Cj4gPiArCWlmIChyZXQgPCAwKSB7Cj4gPiArCQlE
Uk1fREVWX0VSUk9SKGRldiwgImF1eCBlbmFibGUgZmFpbGVkLlxuIik7Cj4gPiArCQlyZXR1cm4g
cmV0Owo+ID4gKwl9Cj4gPiArCj4gPiArCXVzbGVlcF9yYW5nZSgyMDAwLCAyMTAwKTsKPiA+ICsK
PiA+ICsJcmV0ID0gd2FpdF9hdXhfb3BfZmluaXNoKGN0eCk7Cj4gPiArCWlmIChyZXQgPCAwKSB7
Cj4gPiArCQlEUk1fREVWX0VSUk9SKGRldiwgImF1eCByZWFkIGZhaWxlZFxuIik7Cj4gPiArCQly
ZXR1cm4gcmV0Owo+ID4gKwl9Cj4gPiArCj4gPiArCXJldHVybiBhbng3NjI1X3JlZ19ibG9ja19y
ZWFkKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ID4gKwkJCUFQX0FVWF9CVUZGX1NUQVJU
LCBjb3VudCwgYnVmKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBhbng3NjI1X3ZpZGVv
X211dGVfY29udHJvbChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCj4gPiArCQkJCSAgICAgIHU4
IHN0YXR1cykKPiA+ICt7Cj4gPiArCWludCByZXQ7Cj4gPiArCj4gPiArCWlmIChzdGF0dXMpIHsg
LyogbXV0ZSBvbiAqLwo+ID4gKwkJLyogc2V0IG11dGUgZmxhZyAqLwo+ID4gKwkJcmV0ID0gYW54
NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiA+ICsJCQkJICAgICAg
IEFQX0FWX1NUQVRVUywgQVBfTUlQSV9NVVRFKTsKPiA+ICsJCS8qIGNsZWFyIG1pcGkgUlggZW4g
Ki8KPiA+ICsJCXJldCB8PSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2Ns
aWVudCwKPiA+ICsJCQkJCSBBUF9BVl9TVEFUVVMsICh1OCl+QVBfTUlQSV9SWF9FTik7Cj4gPiAr
CX0gZWxzZSB7IC8qIG11dGUgb2ZmICovCj4gPiArCQkvKiBjbGVhciBtdXRlIGZsYWcgKi8KPiA+
ICsJCXJldCA9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+
ID4gKwkJCQkJQVBfQVZfU1RBVFVTLCAodTgpfkFQX01JUElfTVVURSk7Cj4gPiArCQkvKiBzZXQg
TUlQSSBSWCBFTiAqLwo+ID4gKwkJcmV0IHw9IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmky
Yy5yeF9wMF9jbGllbnQsCj4gPiArCQkJCQlBUF9BVl9TVEFUVVMsIEFQX01JUElfUlhfRU4pOwo+
ID4gKwl9Cj4gPiArCj4gPiArCXJldHVybiByZXQ7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBp
bnQgYW54NzYyNV9jb25maWdfYXVkaW9faW5wdXQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQo+
ID4gK3sKPiA+ICsJaW50IHJldDsKPiA+ICsKPiA+ICsJLyogY2hhbm5lbCBudW0gKi8KPiA+ICsJ
cmV0ID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy50eF9wMl9jbGllbnQsCj4gPiAr
CQkJCUFVRElPX0NIQU5ORUxfU1RBVFVTXzYsIEkyU19DSF8yIDw8IDUpOwo+ID4gKwkvKiBsYXlv
dXQgKi8KPiA+ICsJLyogYXMgSTJTIGNoYW5uZWwgaXMgMiwgbm8gbmVlZCB0byBzZXQgbGF5b3V0
ICovCj4gPiArCj4gPiArCS8qIEZTICovCj4gPiArCXJldCB8PSBhbng3NjI1X3dyaXRlX2FuZF9v
cihjdHgsIGN0eC0+aTJjLnR4X3AyX2NsaWVudCwKPiA+ICsJCQkJICAgIEFVRElPX0NIQU5ORUxf
U1RBVFVTXzQsCj4gPiArCQkJCSAgICAweGYwLCBBVURJT19GU180OEspOwo+ID4gKwkvKiB3b3Jk
IGxlbmd0aCAqLwo+ID4gKwlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmRfb3IoY3R4LCBjdHgtPmky
Yy50eF9wMl9jbGllbnQsCj4gPiArCQkJCSAgICBBVURJT19DSEFOTkVMX1NUQVRVU181LAo+ID4g
KwkJCQkgICAgMHhmMCwgQVVESU9fV19MRU5fMjRfMjRNQVgpOwo+ID4gKwkvKiBJMlMgKi8KPiA+
ICsJcmV0IHw9IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy50eF9wMl9jbGllbnQsCj4g
PiArCQkJCUFVRElPX0NIQU5ORUxfU1RBVFVTXzYsIEkyU19TTEFWRV9NT0RFKTsKPiA+ICsJcmV0
IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMudHhfcDJfY2xpZW50LAo+ID4gKwkJ
CQkgQVVESU9fQ09OVFJPTF9SRUdJU1RFUiwgflRETV9USU1JTkdfTU9ERSk7Cj4gPiArCS8qIGF1
ZGlvIGNoYW5nZSBmbGFnICovCj4gPiArCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4
LT5pMmMucnhfcDBfY2xpZW50LAo+ID4gKwkJCQlBUF9BVl9TVEFUVVMsIEFQX0FVRElPX0NIRyk7
Cj4gPiArCj4gPiArCWlmIChyZXQgPCAwKQo+ID4gKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gY29u
ZmlnIGF1ZGlvLlxuIik7Cj4gPiArCj4gPiArCXJldHVybiByZXQ7Cj4gPiArfQo+ID4gKwo+ID4g
Ky8qIHJlZHVjdGlvbiBvZiBmcmFjdGlvbiBhL2IgKi8KPiA+ICtzdGF0aWMgdm9pZCBhbng3NjI1
X3JlZHVjdGlvbl9vZl9hX2ZyYWN0aW9uKHVuc2lnbmVkIGxvbmcgKmEsIHVuc2lnbmVkIGxvbmcg
KmIpCj4gPiArewo+ID4gKwl1bnNpZ25lZCBsb25nIGdjZF9udW07Cj4gPiArCXVuc2lnbmVkIGxv
bmcgdG1wX2EsIHRtcF9iOwo+ID4gKwl1MzIgaSA9IDE7Cj4gPiArCj4gPiArCWdjZF9udW0gPSBn
Y2QoKmEsICpiKTsKPiA+ICsJKmEgLz0gZ2NkX251bTsKPiA+ICsJKmIgLz0gZ2NkX251bTsKPiA+
ICsKPiA+ICsJdG1wX2EgPSAqYTsKPiA+ICsJdG1wX2IgPSAqYjsKPiA+ICsKPiA+ICsJd2hpbGUg
KCgqYSA+IE1BWF9VTlNJR05FRF8yNEJJVCkgfHwgKCpiID4gTUFYX1VOU0lHTkVEXzI0QklUKSkg
ewo+ID4gKwkJaSsrOwo+ID4gKwkJKmEgPSB0bXBfYSAvIGk7Cj4gPiArCQkqYiA9IHRtcF9iIC8g
aTsKPiA+ICsJfQo+ID4gKwo+ID4gKwkvKgo+ID4gKwkgKiBpbiB0aGUgZW5kLCBtYWtlIGEsIGIg
bGFyZ2VyIHRvIGhhdmUgaGlnaGVyIE9ERkMgUExMCj4gPiArCSAqIG91dHB1dCBmcmVxdWVuY3kg
YWNjdXJhY3kKPiA+ICsJICovCj4gPiArCXdoaWxlICgoKmEgPCBNQVhfVU5TSUdORURfMjRCSVQp
ICYmICgqYiA8IE1BWF9VTlNJR05FRF8yNEJJVCkpIHsKPiA+ICsJCSphIDw8PSAxOwo+ID4gKwkJ
KmIgPDw9IDE7Cj4gPiArCX0KPiA+ICsKPiA+ICsJKmEgPj49IDE7Cj4gPiArCSpiID4+PSAxOwo+
ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW50IGFueDc2MjVfY2FsY3VsYXRlX21fbih1MzIgcGl4
ZWxjbG9jaywKPiA+ICsJCQkJIHVuc2lnbmVkIGxvbmcgKm0sCj4gPiArCQkJCSB1bnNpZ25lZCBs
b25nICpuLAo+ID4gKwkJCQkgdTggKnBvc3RfZGl2aWRlcikKPiA+ICt7Cj4gPiArCWlmIChwaXhl
bGNsb2NrID4gUExMX09VVF9GUkVRX0FCU19NQVggLyBQT1NUX0RJVklERVJfTUlOKSB7Cj4gPiAr
CQkvKiBwaXhlbCBjbG9jayBmcmVxdWVuY3kgaXMgdG9vIGhpZ2ggKi8KPiA+ICsJCURSTV9FUlJP
UigicGl4ZWxjbG9jayB0b28gaGlnaCwgYWN0KCVkKSwgbWF4aW11bSglbHUpXG4iLAo+ID4gKwkJ
CSAgcGl4ZWxjbG9jaywKPiA+ICsJCQkgIFBMTF9PVVRfRlJFUV9BQlNfTUFYIC8gUE9TVF9ESVZJ
REVSX01JTik7Cj4gPiArCQlyZXR1cm4gLUVET007Cj4gCj4gV2h5IC1FRE9NIGluc3RlYWQgb2Yg
LUVJTlZBTD8KPiAKPiA+ICsJfQo+ID4gKwo+ID4gKwlpZiAocGl4ZWxjbG9jayA8IFBMTF9PVVRf
RlJFUV9BQlNfTUlOIC8gUE9TVF9ESVZJREVSX01BWCkgewo+ID4gKwkJLyogcGl4ZWwgY2xvY2sg
ZnJlcXVlbmN5IGlzIHRvbyBsb3cgKi8KPiA+ICsJCURSTV9FUlJPUigicGl4ZWxjbG9jayB0b28g
bG93LCBhY3QoJWQpLCBtYXhpbXVtKCVsdSlcbiIsCj4gPiArCQkJICBwaXhlbGNsb2NrLAo+ID4g
KwkJCSAgUExMX09VVF9GUkVRX0FCU19NSU4gLyBQT1NUX0RJVklERVJfTUFYKTsKPiA+ICsJCXJl
dHVybiAtRURPTTsKPiA+ICsJfQo+ID4gKwo+ID4gKwkqcG9zdF9kaXZpZGVyID0gMTsKPiAgICAg
ICAgIF5eXl5eXl5eXl5eXl5eXl5eCj4gRGVsZXRlLgo+IAo+ID4gKwo+ID4gKwlmb3IgKCpwb3N0
X2RpdmlkZXIgPSAxOwo+ICAgICAgICAgICAgICBeXl5eXl5eXl5eXl5eXl5eXgo+IER1cGxpY2F0
ZS4KPiAKPiA+ICsJCXBpeGVsY2xvY2sgPCAoUExMX09VVF9GUkVRX01JTiAvICgqcG9zdF9kaXZp
ZGVyKSk7KQo+ID4gKwkJKnBvc3RfZGl2aWRlciArPSAxOwo+ID4gKwo+ID4gKwlpZiAoKnBvc3Rf
ZGl2aWRlciA+IFBPU1RfRElWSURFUl9NQVgpIHsKPiA+ICsJCWZvciAoKnBvc3RfZGl2aWRlciA9
IDE7Cj4gPiArCQkJKHBpeGVsY2xvY2sgPAo+ID4gKwkJCSAoUExMX09VVF9GUkVRX0FCU19NSU4g
LyAoKnBvc3RfZGl2aWRlcikpKTspCj4gPiArCQkJKnBvc3RfZGl2aWRlciArPSAxOwo+ID4gKwo+
ID4gKwkJaWYgKCpwb3N0X2RpdmlkZXIgPiBQT1NUX0RJVklERVJfTUFYKSB7Cj4gPiArCQkJRFJN
X0VSUk9SKCJjYW5ub3QgZmluZCBwcm9wZXJ0eSBwb3N0X2RpdmlkZXIoJWQpXG4iLAo+ID4gKwkJ
CQkgICpwb3N0X2RpdmlkZXIpOwo+ID4gKwkJCXJldHVybiAtRURPTTsKPiA+ICsJCX0KPiA+ICsJ
fQo+ID4gKwo+ID4gKwkvKiBwYXRjaCB0byBpbXByb3ZlIHRoZSBhY2N1cmFjeSAqLwo+ID4gKwlp
ZiAoKnBvc3RfZGl2aWRlciA9PSA3KSB7Cj4gPiArCQkvKiAyNywwMDAsMDAwIGlzIG5vdCBkaXZp
c2libGUgYnkgNyAqLwo+ID4gKwkJKnBvc3RfZGl2aWRlciA9IDg7Cj4gPiArCX0gZWxzZSBpZiAo
KnBvc3RfZGl2aWRlciA9PSAxMSkgewo+ID4gKwkJLyogMjcsMDAwLDAwMCBpcyBub3QgZGl2aXNp
YmxlIGJ5IDExICovCj4gPiArCQkqcG9zdF9kaXZpZGVyID0gMTI7Cj4gPiArCX0gZWxzZSBpZiAo
KCpwb3N0X2RpdmlkZXIgPT0gMTMpIHx8ICgqcG9zdF9kaXZpZGVyID09IDE0KSkgewo+ID4gKwkJ
LyoyNywwMDAsMDAwIGlzIG5vdCBkaXZpc2libGUgYnkgMTMgb3IgMTQqLwo+ID4gKwkJKnBvc3Rf
ZGl2aWRlciA9IDE1Owo+ID4gKwl9Cj4gPiArCj4gPiArCWlmIChwaXhlbGNsb2NrICogKCpwb3N0
X2RpdmlkZXIpID4gUExMX09VVF9GUkVRX0FCU19NQVgpIHsKPiA+ICsJCURSTV9FUlJPUigiYWN0
IGNsb2NrKCV1KSBsYXJnZSB0aGFuIG1heGltdW0oJWx1KVxuIiwKPiA+ICsJCQkgIHBpeGVsY2xv
Y2sgKiAoKnBvc3RfZGl2aWRlciksCj4gPiArCQkJICBQTExfT1VUX0ZSRVFfQUJTX01BWCk7Cj4g
PiArCQlyZXR1cm4gLUVET007Cj4gPiArCX0KPiA+ICsKPiA+ICsJKm0gPSBwaXhlbGNsb2NrOwo+
ID4gKwkqbiA9IFhUQUxfRlJRIC8gKCpwb3N0X2RpdmlkZXIpOwo+ID4gKwo+ID4gKwlhbng3NjI1
X3JlZHVjdGlvbl9vZl9hX2ZyYWN0aW9uKG0sIG4pOwo+ID4gKwo+ID4gKwlyZXR1cm4gMDsKPiA+
ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBhbng3NjI1X29kZmNfY29uZmlnKHN0cnVjdCBhbng3
NjI1X2RhdGEgKmN0eCwKPiA+ICsJCQkgICAgICAgdTggcG9zdF9kaXZpZGVyKQo+ID4gK3sKPiA+
ICsJaW50IHJldDsKPiA+ICsKPiA+ICsJLyogY29uZmlnIGlucHV0IHJlZmVyZW5jZSBjbG9jayBm
cmVxdWVuY3kgMjdNSHovMTkuMk1IeiAqLwo+ID4gKwlyZXQgPSBhbng3NjI1X3dyaXRlX2FuZChj
dHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9ESUdJVEFMX1BMTF8xNiwKPiA+ICsJCQkJ
fihSRUZfQ0xLXzI3MDAwS0haIDw8IE1JUElfRlJFRl9EX0lORCkpOwo+ID4gKwlyZXQgfD0gYW54
NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9ESUdJVEFMX1BM
TF8xNiwKPiA+ICsJCQkJKFJFRl9DTEtfMjcwMDBLSFogPDwgTUlQSV9GUkVGX0RfSU5EKSk7Cj4g
PiArCS8qIHBvc3QgZGl2aWRlciAqLwo+ID4gKwlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmQoY3R4
LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCj4gPiArCQkJCSBNSVBJX0RJR0lUQUxfUExMXzgsIDB4
MGYpOwo+ID4gKwlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AxX2Ns
aWVudCwgTUlQSV9ESUdJVEFMX1BMTF84LAo+ID4gKwkJCQlwb3N0X2RpdmlkZXIgPDwgNCk7Cj4g
PiArCj4gPiArCS8qIGFkZCBwYXRjaCBmb3IgTUlTMi0xMjUgKDVwY3MgQU5YNzYyNSBmYWlsIEFU
RSBNQklTVCB0ZXN0KSAqLwo+ID4gKwlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgt
PmkyYy5yeF9wMV9jbGllbnQsIE1JUElfRElHSVRBTF9QTExfNywKPiA+ICsJCQkJIH5NSVBJX1BM
TF9WQ09fVFVORV9SRUdfVkFMKTsKPiA+ICsKPiA+ICsJLyogcmVzZXQgT0RGQyBQTEwgKi8KPiA+
ICsJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCBN
SVBJX0RJR0lUQUxfUExMXzcsCj4gPiArCQkJCSB+TUlQSV9QTExfUkVTRVRfTik7Cj4gPiArCXJl
dCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCBNSVBJX0RJ
R0lUQUxfUExMXzcsCj4gPiArCQkJCU1JUElfUExMX1JFU0VUX04pOwo+ID4gKwo+ID4gKwlpZiAo
cmV0IDwgMCkKPiA+ICsJCURSTV9FUlJPUigiSU8gZXJyb3IuXG4iKTsKPiA+ICsKPiA+ICsJcmV0
dXJuIHJldDsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBhbng3NjI1X2RzaV92aWRlb190
aW1pbmdfY29uZmlnKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKPiA+ICt7Cj4gPiArCXN0cnVj
dCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ID4gKwl1bnNpZ25lZCBsb25nIG0s
IG47Cj4gPiArCXUxNiBodG90YWw7Cj4gPiArCWludCByZXQ7Cj4gPiArCXU4IHBvc3RfZGl2aWRl
ciA9IDA7Cj4gPiArCj4gPiArCXJldCA9IGFueDc2MjVfY2FsY3VsYXRlX21fbihjdHgtPmR0LnBp
eGVsY2xvY2subWluICogMTAwMCwKPiA+ICsJCQkJICAgICZtLCAmbiwgJnBvc3RfZGl2aWRlcik7
Cj4gPiArCj4gPiArCWlmIChyZXQgIT0gMCkgewo+IAo+IGlmIChyZXQpIHsKPiAKPiA+ICsJCURS
TV9FUlJPUigiY2Fubm90IGdldCBwcm9wZXJ0eSBtIG4gdmFsdWUuXG4iKTsKPiA+ICsJCXJldHVy
biAtRUlOVkFMOwo+ID4gKwl9Cj4gPiArCj4gPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwg
ImNvbXB1dGUgTSglbHUpLCBOKCVsdSksIGRpdmlkZXIoJWQpLlxuIiwKPiA+ICsJCQkgICAgIG0s
IG4sIHBvc3RfZGl2aWRlcik7Cj4gPiArCj4gPiArCS8qIGNvbmZpZ3VyZSBwaXhlbCBjbG9jayAq
Lwo+ID4gKwlyZXQgPSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVu
dCwgUElYRUxfQ0xPQ0tfTCwKPiA+ICsJCQkJKGN0eC0+ZHQucGl4ZWxjbG9jay5taW4gLyAxMDAw
KSAmIDB4RkYpOwo+ID4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5y
eF9wMF9jbGllbnQsIFBJWEVMX0NMT0NLX0gsCj4gPiArCQkJCSAoY3R4LT5kdC5waXhlbGNsb2Nr
Lm1pbiAvIDEwMDApID4+IDgpOwo+ID4gKwkvKiBsYW5lIGNvdW50ICovCj4gPiArCXJldCB8PSBh
bng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKPiA+ICsJCQlNSVBJ
X0xBTkVfQ1RSTF8wLCAweGZjKTsKPiA+ICsJcmV0IHw9IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBj
dHgtPmkyYy5yeF9wMV9jbGllbnQsCj4gPiArCQkJCU1JUElfTEFORV9DVFJMXzAsIDMpOwo+ID4g
Kwo+ID4gKwkvKiBIdG90YWwgKi8KPiA+ICsJaHRvdGFsID0gY3R4LT5kdC5oYWN0aXZlLm1pbiAr
IGN0eC0+ZHQuaGZyb250X3BvcmNoLm1pbiArCj4gPiArCQljdHgtPmR0LmhiYWNrX3BvcmNoLm1p
biArIGN0eC0+ZHQuaHN5bmNfbGVuLm1pbjsKPiA+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRl
KGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAo+ID4gKwkJCUhPUklaT05UQUxfVE9UQUxfUElY
RUxTX0wsIGh0b3RhbCAmIDB4RkYpOwo+ID4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4
LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQsCj4gPiArCQkJSE9SSVpPTlRBTF9UT1RBTF9QSVhFTFNf
SCwgaHRvdGFsID4+IDgpOwo+ID4gKwkvKiBIYWN0aXZlICovCj4gPiArCXJldCB8PSBhbng3NjI1
X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwKPiA+ICsJCQlIT1JJWk9OVEFM
X0FDVElWRV9QSVhFTFNfTCwgY3R4LT5kdC5oYWN0aXZlLm1pbiAmIDB4RkYpOwo+ID4gKwlyZXQg
fD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQsCj4gPiArCQkJ
SE9SSVpPTlRBTF9BQ1RJVkVfUElYRUxTX0gsIGN0eC0+ZHQuaGFjdGl2ZS5taW4gPj4gOCk7Cj4g
PiArCS8qIEhGUCAqLwo+ID4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmky
Yy5yeF9wMl9jbGllbnQsCj4gPiArCQkJSE9SSVpPTlRBTF9GUk9OVF9QT1JDSF9MLCBjdHgtPmR0
Lmhmcm9udF9wb3JjaC5taW4pOwo+ID4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBj
dHgtPmkyYy5yeF9wMl9jbGllbnQsCj4gPiArCQkJSE9SSVpPTlRBTF9GUk9OVF9QT1JDSF9ILAo+
ID4gKwkJCWN0eC0+ZHQuaGZyb250X3BvcmNoLm1pbiA+PiA4KTsKPiA+ICsJLyogSFdTICovCj4g
PiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwK
PiA+ICsJCQlIT1JJWk9OVEFMX1NZTkNfV0lEVEhfTCwgY3R4LT5kdC5oc3luY19sZW4ubWluKTsK
PiA+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50
LAo+ID4gKwkJCUhPUklaT05UQUxfU1lOQ19XSURUSF9ILCBjdHgtPmR0LmhzeW5jX2xlbi5taW4g
Pj4gOCk7Cj4gPiArCS8qIEhCUCAqLwo+ID4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4
LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQsCj4gPiArCQkJSE9SSVpPTlRBTF9CQUNLX1BPUkNIX0ws
IGN0eC0+ZHQuaGJhY2tfcG9yY2gubWluKTsKPiA+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRl
KGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAo+ID4gKwkJCUhPUklaT05UQUxfQkFDS19QT1JD
SF9ILCBjdHgtPmR0LmhiYWNrX3BvcmNoLm1pbiA+PiA4KTsKPiA+ICsJLyogVmFjdGl2ZSAqLwo+
ID4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQs
IEFDVElWRV9MSU5FU19MLAo+ID4gKwkJCWN0eC0+ZHQudmFjdGl2ZS5taW4pOwo+ID4gKwlyZXQg
fD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQsIEFDVElWRV9M
SU5FU19ILAo+ID4gKwkJCWN0eC0+ZHQudmFjdGl2ZS5taW4gPj4gOCk7Cj4gPiArCS8qIFZGUCAq
Lwo+ID4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMl9jbGll
bnQsCj4gPiArCQkJVkVSVElDQUxfRlJPTlRfUE9SQ0gsIGN0eC0+ZHQudmZyb250X3BvcmNoLm1p
bik7Cj4gPiArCS8qIFZXUyAqLwo+ID4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBj
dHgtPmkyYy5yeF9wMl9jbGllbnQsCj4gPiArCQkJVkVSVElDQUxfU1lOQ19XSURUSCwgY3R4LT5k
dC52c3luY19sZW4ubWluKTsKPiA+ICsJLyogVkJQICovCj4gPiArCXJldCB8PSBhbng3NjI1X3Jl
Z193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwKPiA+ICsJCQlWRVJUSUNBTF9CQUNL
X1BPUkNILCBjdHgtPmR0LnZiYWNrX3BvcmNoLm1pbik7Cj4gPiArCS8qIE0gdmFsdWUgKi8KPiA+
ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAo+
ID4gKwkJCU1JUElfUExMX01fTlVNXzIzXzE2LCAobSA+PiAxNikgJiAweGZmKTsKPiA+ICsJcmV0
IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAo+ID4gKwkJ
CU1JUElfUExMX01fTlVNXzE1XzgsIChtID4+IDgpICYgMHhmZik7Cj4gPiArCXJldCB8PSBhbng3
NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKPiA+ICsJCQlNSVBJX1BM
TF9NX05VTV83XzAsIChtICYgMHhmZikpOwo+ID4gKwkvKiBOIHZhbHVlICovCj4gPiArCXJldCB8
PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKPiA+ICsJCQlN
SVBJX1BMTF9OX05VTV8yM18xNiwgKG4gPj4gMTYpICYgMHhmZik7Cj4gPiArCXJldCB8PSBhbng3
NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKPiA+ICsJCQlNSVBJX1BM
TF9OX05VTV8xNV84LCAobiA+PiA4KSAmIDB4ZmYpOwo+ID4gKwlyZXQgfD0gYW54NzYyNV9yZWdf
d3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIE1JUElfUExMX05fTlVNXzdfMCwKPiA+
ICsJCQkobiAmIDB4ZmYpKTsKPiA+ICsJLyogZGlmZiAqLwo+ID4gKwlyZXQgfD0gYW54NzYyNV9y
ZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCj4gPiArCQkJTUlQSV9ESUdJVEFM
X0FESl8xLCAweDM3KTsKPiA+ICsKPiA+ICsJcmV0IHw9IGFueDc2MjVfb2RmY19jb25maWcoY3R4
LCBwb3N0X2RpdmlkZXIgLSAxKTsKPiA+ICsKPiA+ICsJaWYgKHJldCA8IDApCj4gPiArCQlEUk1f
RVJST1IoIm1pcGkgZHNpIHNldHVwIElPIGVycm9yLlxuIik7Cj4gPiArCj4gPiArCXJldHVybiBy
ZXQ7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgYW54NzYyNV9zd2FwX2RzaV9sYW5lMyhz
dHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gPiArewo+ID4gKwlpbnQgdmFsOwo+ID4gKwo+ID4g
KwkvKiBzd2FwIE1JUEktRFNJIGRhdGEgbGFuZSAzIFAgYW5kIE4gKi8KPiA+ICsJdmFsID0gYW54
NzYyNV9yZWdfcmVhZChjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9TV0FQKTsKPiA+
ICsJaWYgKHZhbCA8IDApIHsKPiA+ICsJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBhY2Nlc3MgTUlQ
SV9TV0FQLlxuIik7Cj4gPiArCQlyZXR1cm4gLUVJTzsKPiA+ICsJfQo+ID4gKwo+ID4gKwl2YWwg
fD0gKDEgPDwgTUlQSV9TV0FQX0NIMyk7Cj4gPiArCXJldHVybiBhbng3NjI1X3JlZ193cml0ZShj
dHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9TV0FQLCB2YWwpOwo+ID4gK30KPiA+ICsK
PiA+ICtzdGF0aWMgaW50IGFueDc2MjVfYXBpX2RzaV9jb25maWcoc3RydWN0IGFueDc2MjVfZGF0
YSAqY3R4KQo+ID4gKwo+ID4gK3sKPiA+ICsJaW50IHZhbCwgcmV0Owo+ID4gKwo+ID4gKwkvKiBz
d2FwIE1JUEktRFNJIGRhdGEgbGFuZSAzIFAgYW5kIE4gKi8KPiA+ICsJcmV0ID0gYW54NzYyNV9z
d2FwX2RzaV9sYW5lMyhjdHgpOwo+ID4gKwlpZiAocmV0IDwgMCkgewo+ID4gKwkJRFJNX0VSUk9S
KCJJTyBlcnJvciA6IHN3YXAgZHNpIGxhbmUgMyBmYWlsZWQuXG4iKTsKPiA+ICsJCXJldHVybiBy
ZXQ7Cj4gPiArCX0KPiA+ICsKPiA+ICsJLyogRFNJIGNsb2NrIHNldHRpbmdzICovCj4gPiArCXZh
bCA9ICgwIDw8IE1JUElfSFNfUFdEX0NMSykJCXwKPiA+ICsJCSgwIDw8IE1JUElfSFNfUlRfQ0xL
KQkJfAo+ID4gKwkJKDAgPDwgTUlQSV9QRF9DTEspCQl8Cj4gPiArCQkoMSA8PCBNSVBJX0NMS19S
VF9NQU5VQUxfUERfRU4pCXwKPiA+ICsJCSgxIDw8IE1JUElfQ0xLX0hTX01BTlVBTF9QRF9FTikJ
fAo+ID4gKwkJKDAgPDwgTUlQSV9DTEtfREVUX0RFVF9CWVBBU1MpCXwKPiA+ICsJCSgwIDw8IE1J
UElfQ0xLX01JU1NfQ1RSTCkJfAo+ID4gKwkJKDAgPDwgTUlQSV9QRF9MUFRYX0NIX01BTlVBTF9Q
RF9FTik7Cj4gPiArCXJldCA9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDFf
Y2xpZW50LAo+ID4gKwkJCQlNSVBJX1BIWV9DT05UUk9MXzMsIHZhbCk7Cj4gPiArCj4gPiArCS8q
Cj4gPiArCSAqIERlY3JlYXNlZCBIUyBwcmVwYXJlIHRpbWluZyBkZWxheSBmcm9tIDE2MG5zIHRv
IDgwbnMgd29yayB3aXRoCj4gPiArCSAqICAgICBhKSBEcmFnb24gYm9hcmQgODEwIHNlcmllcyAo
UXVhbGNvbW0gQVApCj4gPiArCSAqICAgICBiKSBNb3ZpbmcgUGl4ZWwgRFNJIHNvdXJjZSAoUEcz
QSBwYXR0ZXJuIGdlbmVyYXRvciArCj4gPiArCSAqCVAzMzIgRC1QSFkgUHJvYmUpIGRlZmF1bHQg
RC1QSFkgdGltaW5nCj4gPiArCSAqCTVucy9zdGVwCj4gPiArCSAqLwo+ID4gKwlyZXQgfD0gYW54
NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCj4gPiArCQkJCSBNSVBJ
X1RJTUVfSFNfUFJQUiwgMHgxMCk7Cj4gPiArCj4gPiArCS8qIGVuYWJsZSBEU0kgbW9kZSovCj4g
PiArCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCBN
SVBJX0RJR0lUQUxfUExMXzE4LAo+ID4gKwkJCQlTRUxFQ1RfRFNJIDw8IE1JUElfRFBJX1NFTEVD
VCk7Cj4gPiArCj4gPiArCXJldCB8PSBhbng3NjI1X2RzaV92aWRlb190aW1pbmdfY29uZmlnKGN0
eCk7Cj4gPiArCWlmIChyZXQgPCAwKSB7Cj4gPiArCQlEUk1fRVJST1IoImRzaSB2aWRlbyB0aW1p
bmcgY29uZmlnIGZhaWxlZFxuIik7Cj4gPiArCQlyZXR1cm4gcmV0Owo+ID4gKwl9Cj4gPiArCj4g
PiArCS8qIHRvZ2dsZSBtLCBuIHJlYWR5ICovCj4gPiArCXJldCA9IGFueDc2MjVfd3JpdGVfYW5k
KGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCBNSVBJX0RJR0lUQUxfUExMXzYsCj4gPiArCQkJ
CX4oTUlQSV9NX05VTV9SRUFEWSB8IE1JUElfTl9OVU1fUkVBRFkpKTsKPiA+ICsJdXNsZWVwX3Jh
bmdlKDEwMDAsIDExMDApOwo+ID4gKwlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+
aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9ESUdJVEFMX1BMTF82LAo+ID4gKwkJCQlNSVBJX01fTlVN
X1JFQURZIHwgTUlQSV9OX05VTV9SRUFEWSk7Cj4gPiArCj4gPiArCS8qIGNvbmZpZ3VyZSBpbnRl
Z2VyIHN0YWJsZSByZWdpc3RlciAqLwo+ID4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4
LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCj4gPiArCQkJCSBNSVBJX1ZJREVPX1NUQUJMRV9DTlQs
IDB4MDIpOwo+ID4gKwkvKiBwb3dlciBvbiBNSVBJIFJYICovCj4gPiArCXJldCB8PSBhbng3NjI1
X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKPiA+ICsJCQkJIE1JUElfTEFO
RV9DVFJMXzEwLCAweDAwKTsKPiA+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4
LT5pMmMucnhfcDFfY2xpZW50LAo+ID4gKwkJCQkgTUlQSV9MQU5FX0NUUkxfMTAsIDB4ODApOwo+
ID4gKwo+ID4gKwlpZiAocmV0IDwgMCkKPiA+ICsJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBtaXBp
IGRzaSBlbmFibGUgaW5pdCBmYWlsZWQuXG4iKTsKPiA+ICsKPiA+ICsJcmV0dXJuIHJldDsKPiA+
ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBhbng3NjI1X2RzaV9jb25maWcoc3RydWN0IGFueDc2
MjVfZGF0YSAqY3R4KQo+ID4gK3sKPiA+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xp
ZW50LT5kZXY7Cj4gPiArCWludCByZXQ7Cj4gPiArCj4gPiArCURSTV9ERVZfREVCVUdfRFJJVkVS
KGRldiwgImNvbmZpZyBkc2kuXG4iKTsKPiA+ICsKPiA+ICsJLyogRFNDIGRpc2FibGUgKi8KPiA+
ICsJcmV0ID0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4g
PiArCQkJCVJfRFNDX0NUUkxfMCwgfkRTQ19FTik7Cj4gPiArCj4gPiArCXJldCB8PSBhbng3NjI1
X2FwaV9kc2lfY29uZmlnKGN0eCk7Cj4gPiArCj4gPiArCWlmIChyZXQgPCAwKSB7Cj4gPiArCQlE
Uk1fRVJST1IoIklPIGVycm9yIDogYXBpIGRzaSBjb25maWcgZXJyb3IuXG4iKTsKPiAKPiByZXR1
cm4gcmV0Owo+IAo+ID4gKwl9IGVsc2Ugewo+ID4gKwkJLyogc2V0IE1JUEkgUlggRU4gKi8KPiA+
ICsJCXJldCA9IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4g
PiArCQkJCSAgICAgICBBUF9BVl9TVEFUVVMsIEFQX01JUElfUlhfRU4pOwo+ID4gKwkJLyogY2xl
YXIgbXV0ZSBmbGFnICovCj4gPiArCQlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgt
PmkyYy5yeF9wMF9jbGllbnQsCj4gPiArCQkJCQkgQVBfQVZfU1RBVFVTLCAodTgpfkFQX01JUElf
TVVURSk7Cj4gPiArCQlpZiAocmV0IDwgMCkKPiA+ICsJCQlEUk1fRVJST1IoIklPIGVycm9yIDog
ZW5hYmxlIG1pcGkgcnggZmFpbGVkLlxuIik7Cj4gPiArCQllbHNlCj4gPiArCQkJRFJNX0RFVl9E
RUJVR19EUklWRVIoZGV2LCAic3VjY2VzcyB0byBjb25maWcgRFNJXG4iKTsKPiA+ICsJfQo+ID4g
Kwo+ID4gKwlyZXR1cm4gcmV0Owo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW50IGFueDc2MjVf
YXBpX2RwaV9jb25maWcoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQo+ID4gK3sKPiA+ICsJdTE2
IGZyZXEgPSBjdHgtPmR0LnBpeGVsY2xvY2subWluIC8gMTAwMDsKPiA+ICsJaW50IHJldDsKPiA+
ICsKPiA+ICsJLyogY29uZmlndXJlIHBpeGVsIGNsb2NrICovCj4gPiArCXJldCA9IGFueDc2MjVf
cmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ID4gKwkJCQlQSVhFTF9DTE9D
S19MLCBmcmVxICYgMHhGRik7Cj4gPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0
eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiA+ICsJCQkJIFBJWEVMX0NMT0NLX0gsIChmcmVxID4+IDgp
KTsKPiA+ICsKPiA+ICsJLyogc2V0IERQSSBtb2RlICovCj4gPiArCS8qIHNldCB0byBEUEkgUExM
IG1vZHVsZSBzZWwgKi8KPiA+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5p
MmMucnhfcDFfY2xpZW50LAo+ID4gKwkJCQkgTUlQSV9ESUdJVEFMX1BMTF85LCAweDIwKTsKPiA+
ICsJLyogcG93ZXIgZG93biBNSVBJICovCj4gPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShj
dHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKPiA+ICsJCQkJIE1JUElfTEFORV9DVFJMXzEwLCAw
eDA4KTsKPiA+ICsJLyogZW5hYmxlIERQSSBtb2RlICovCj4gPiArCXJldCB8PSBhbng3NjI1X3Jl
Z193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKPiA+ICsJCQkJIE1JUElfRElHSVRB
TF9QTExfMTgsIDB4MUMpOwo+ID4gKwkvKiBzZXQgZmlyc3QgZWRnZSAqLwo+ID4gKwlyZXQgfD0g
YW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy50eF9wMl9jbGllbnQsCj4gPiArCQkJCSBW
SURFT19DT05UUk9MXzAsIDB4MDUpOwo+ID4gKwlpZiAocmV0IDwgMCkKPiA+ICsJCURSTV9FUlJP
UigiSU8gZXJyb3IgOiBkcGkgcGh5IHNldCBmYWlsZWQuXG4iKTsKPiA+ICsKPiA+ICsJcmV0dXJu
IHJldDsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBhbng3NjI1X2RwaV9jb25maWcoc3Ry
dWN0IGFueDc2MjVfZGF0YSAqY3R4KQo+ID4gK3sKPiA+ICsJc3RydWN0IGRldmljZSAqZGV2ID0g
JmN0eC0+Y2xpZW50LT5kZXY7Cj4gPiArCWludCByZXQ7Cj4gPiArCj4gPiArCURSTV9ERVZfREVC
VUdfRFJJVkVSKGRldiwgImNvbmZpZyBkcGlcbiIpOwo+ID4gKwo+ID4gKwkvKiBEU0MgZGlzYWJs
ZSAqLwo+ID4gKwlyZXQgPSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2Ns
aWVudCwKPiA+ICsJCQkJUl9EU0NfQ1RSTF8wLCB+RFNDX0VOKTsKPiA+ICsJaWYgKHJldCA8IDAp
IHsKPiA+ICsJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBkaXNhYmxlIGRzYyBmYWlsZWQuXG4iKTsK
PiA+ICsJCXJldHVybiByZXQ7Cj4gPiArCX0KPiA+ICsKPiA+ICsJcmV0ID0gYW54NzYyNV9jb25m
aWdfYml0X21hdHJpeChjdHgpOwo+ID4gKwlpZiAocmV0IDwgMCkgewo+ID4gKwkJRFJNX0VSUk9S
KCJjb25maWcgYml0IG1hdHJpeCBmYWlsZWQuXG4iKTsKPiA+ICsJCXJldHVybiByZXQ7Cj4gPiAr
CX0KPiA+ICsKPiA+ICsJcmV0ID0gYW54NzYyNV9hcGlfZHBpX2NvbmZpZyhjdHgpOwo+ID4gKwlp
ZiAocmV0IDwgMCkgewo+ID4gKwkJRFJNX0VSUk9SKCJtaXBpIHBoeShkcGkpIHNldHVwIGZhaWxl
ZC5cbiIpOwo+ID4gKwkJcmV0dXJuIHJldDsKPiA+ICsJfQo+ID4gKwo+ID4gKwkvKiBzZXQgTUlQ
SSBSWCBFTiAqLwo+ID4gKwlyZXQgPSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhf
cDBfY2xpZW50LAo+ID4gKwkJCSAgICAgICBBUF9BVl9TVEFUVVMsIEFQX01JUElfUlhfRU4pOwo+
ID4gKwkvKiBjbGVhciBtdXRlIGZsYWcgKi8KPiA+ICsJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5k
KGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ID4gKwkJCQkgQVBfQVZfU1RBVFVTLCAodTgp
fkFQX01JUElfTVVURSk7Cj4gPiArCWlmIChyZXQgPCAwKQo+ID4gKwkJRFJNX0VSUk9SKCJJTyBl
cnJvciA6IGVuYWJsZSBtaXBpIHJ4IGZhaWxlZC5cbiIpOwo+ID4gKwo+ID4gKwlyZXR1cm4gcmV0
Owo+ID4gK30KPiA+ICsKPiA+ICtjb25zdCB1OCBBTlhfT1VJWzNdID0geyAweDAwLCAweDIyLCAw
eEI5IH07Cj4gPiArc3RhdGljIGludCBpc19hbnhfZG9uZ2xlKHN0cnVjdCBhbng3NjI1X2RhdGEg
KmN0eCkKPiA+ICt7Cj4gPiArCXU4IGJ1ZlszXTsKPiA+ICsKPiA+ICsJLyogMHgwNTAwfjB4MDUw
MjogQlJBTkNIX0lFRUVfT1VJICovCj4gPiArCXNwX3R4X2F1eF9kcGNkcmVhZF9ieXRlcyhjdHgs
IDB4MDAsIDB4MDUsIDB4MDAsIHNpemVvZihidWYpLCBidWYpOwo+ID4gKwlpZiAobWVtY21wKGJ1
ZiwgQU5YX09VSSwgc2l6ZW9mKGJ1ZikpID09IDApCj4gPiArCQlyZXR1cm4gMDsKPiA+ICsKPiA+
ICsJcmV0dXJuIC1FTlhJTzsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgc3BfdHhfZ2V0
X3J4X2J3KHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwgdTggKmJ3KQo+ID4gK3sKPiA+ICsJdTgg
ZGF0YV9idWZbNF07Cj4gPiArCS8qCj4gPiArCSAqIFdoZW4gQU5YIGRvbmdsZSBjb25uZWN0ZWQs
IGlmIENISVBfSUQgPSAweDc3NTAsIGJhbmR3aWR0aCBpcyA2Ljc1RywKPiA+ICsJICogYmVjYXVz
ZSBBTlg3NzUwIERQQ0QgMHgwNTJ4IHdhcyBub3QgYXZhaWxhYmxlLgo+ID4gKwkgKi8KPiA+ICsJ
aWYgKCFpc19hbnhfZG9uZ2xlKGN0eCkpIHsKPiA+ICsJCXNwX3R4X2F1eF9kcGNkcmVhZF9ieXRl
cyhjdHgsIDB4MDAsIDB4MDUsIDB4MDMsIDB4MDQsIGRhdGFfYnVmKTsKPiA+ICsJCWlmIChkYXRh
X2J1ZlswXSA9PSAweDM3ICYmIGRhdGFfYnVmWzFdID09IDB4MzcgJiYKPiA+ICsJCSAgICBkYXRh
X2J1ZlsyXSA9PSAweDM1ICYmIGRhdGFfYnVmWzNdID09IDB4MzApIHsKPiA+ICsJCQkvKiAweDE5
IDogNi43NUcgKi8KPiA+ICsJCQkqYncgPSAweDE5Owo+ID4gKwkJfSBlbHNlIHsKPiA+ICsJCQlz
cF90eF9hdXhfZHBjZHJlYWRfYnl0ZXMoY3R4LCAweDAwLCAweDA1LCAweDIxLCAxLCBidyk7Cj4g
PiArCQkJLyoKPiA+ICsJCQkgKiBzb21lIEFOWCBkb25nbGUgcmVhZCBvdXQgdmFsdWUgMCwKPiA+
ICsJCQkgKiByZXRyeSBzdGFuZGFyZCByZWdpc3Rlci4KPiA+ICsJCQkgKi8KPiA+ICsJCQlpZiAo
KCgqYncpID09IDApIHx8ICgoKmJ3KSA9PSAweGZmKSkKPiA+ICsJCQkJc3BfdHhfYXV4X2RwY2Ry
ZWFkX2J5dGVzKGN0eCwgMHgwMCwgMHgwMCwKPiA+ICsJCQkJCQkJIERQQ0RfTUFYX0xJTktfUkFU
RSwKPiA+ICsJCQkJCQkJIDEsIGJ3KTsKPiA+ICsJCX0KPiA+ICsJfSBlbHNlIHsKPiA+ICsJCXNw
X3R4X2F1eF9kcGNkcmVhZF9ieXRlcyhjdHgsIDB4MDAsIDB4MDAsCj4gPiArCQkJCQkgRFBDRF9N
QVhfTElOS19SQVRFLCAxLCBidyk7Cj4gPiArCX0KPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHZv
aWQgYW54NzYyNV9kcF9zdGFydChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gPiArewo+ID4g
KwlpbnQgcmV0Owo+ID4gKwo+ID4gKwlpZiAoIWN0eC0+ZGlzcGxheV90aW1pbmdfdmFsaWQpIHsK
PiA+ICsJCURSTV9FUlJPUigibWlwaSBkcm0gaGF2ZW4ndCBzZXQgZGlzcGxheSB0aW1pbmcgeWV0
LlxuIik7Cj4gPiArCQlyZXR1cm47Cj4gPiArCX0KPiA+ICsKPiA+ICsJcmV0ID0gYW54NzYyNV9j
b25maWdfYXVkaW9faW5wdXQoY3R4KTsKPiA+ICsJaWYgKHJldCA8IDApCj4gPiArCQlEUk1fRVJS
T1IoImNvbmZpZyBhdWRpbyBpbnB1dCBmYWlsZWQuXG4iKTsKPiA+ICsKPiA+ICsJaWYgKGN0eC0+
cGRhdGEuZHNpX3N1cHBvcnRlZCkKPiA+ICsJCXJldCA9IGFueDc2MjVfZHNpX2NvbmZpZyhjdHgp
Owo+ID4gKwllbHNlCj4gPiArCQlyZXQgPSBhbng3NjI1X2RwaV9jb25maWcoY3R4KTsKPiA+ICsK
PiA+ICsJaWYgKHJldCA8IDApCj4gPiArCQlEUk1fRVJST1IoIk1JUEkgcGh5IHNldHVwIGVycm9y
LlxuIik7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGFueDc2MjVfZHBfc3RvcChzdHJ1
Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gPiArewo+ID4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAm
Y3R4LT5jbGllbnQtPmRldjsKPiA+ICsJaW50IHJldDsKPiA+ICsKPiA+ICsJRFJNX0RFVl9ERUJV
R19EUklWRVIoZGV2LCAic3RvcCBkcCBvdXRwdXRcbiIpOwo+ID4gKwo+ID4gKwkvKgo+ID4gKwkg
KiB2aWRlbyBkaXNhYmxlOiAweDcyOjA4IGJpdCA3ID0gMDsKPiA+ICsJICogYXVkaW8gZGlzYWJs
ZTogMHg3MDo4NyBiaXQgMCA9IDA7Cj4gPiArCSAqLwo+ID4gKwlyZXQgPSBhbng3NjI1X3dyaXRl
X2FuZChjdHgsIGN0eC0+aTJjLnR4X3AwX2NsaWVudCwgMHg4NywgMHhmZSk7Cj4gPiArCXJldCB8
PSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+aTJjLnR4X3AyX2NsaWVudCwgMHgwOCwgMHg3
Zik7Cj4gPiArCj4gPiArCXJldCB8PSBhbng3NjI1X3ZpZGVvX211dGVfY29udHJvbChjdHgsIDEp
Owo+ID4gKwlpZiAocmV0IDwgMCkKPiA+ICsJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBtdXRlIHZp
ZGVvIGZhaWxlZFxuIik7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgc3BfdHhfcnN0X2F1
eChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gPiArewo+ID4gKwlpbnQgcmV0Owo+ID4gKwo+
ID4gKwlyZXQgPSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMudHhfcDJfY2xpZW50LCBS
U1RfQ1RSTDIsCj4gPiArCQkJICAgICAgIEFVWF9SU1QpOwo+ID4gKwlyZXQgfD0gYW54NzYyNV93
cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy50eF9wMl9jbGllbnQsIFJTVF9DVFJMMiwKPiA+ICsJCQkJ
IH5BVVhfUlNUKTsKPiA+ICsJcmV0dXJuIHJldDsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGlu
dCBzcF90eF9hdXhfd3Ioc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LCB1OCBvZmZzZXQpCj4gPiAr
ewo+ID4gKwlpbnQgcmV0Owo+ID4gKwo+ID4gKwlyZXQgPSBhbng3NjI1X3JlZ193cml0ZShjdHgs
IGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiA+ICsJCQkJQVBfQVVYX0JVRkZfU1RBUlQsIG9mZnNl
dCk7Cj4gPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2Ns
aWVudCwKPiA+ICsJCQkJIEFQX0FVWF9DT01NQU5ELCAweDA0KTsKPiA+ICsJcmV0IHw9IGFueDc2
MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4gPiArCQkJCUFQX0FVWF9D
VFJMX1NUQVRVUywgQVBfQVVYX0NUUkxfT1BfRU4pOwo+ID4gKwlyZXR1cm4gKHJldCB8IHdhaXRf
YXV4X29wX2ZpbmlzaChjdHgpKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBzcF90eF9h
dXhfcmQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LCB1OCBsZW5fY21kKQo+ID4gK3sKPiA+ICsJ
aW50IHJldDsKPiA+ICsKPiA+ICsJcmV0ID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmky
Yy5yeF9wMF9jbGllbnQsCj4gPiArCQkJCUFQX0FVWF9DT01NQU5ELCBsZW5fY21kKTsKPiA+ICsJ
cmV0IHw9IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4gPiAr
CQkJCUFQX0FVWF9DVFJMX1NUQVRVUywgQVBfQVVYX0NUUkxfT1BfRU4pOwo+ID4gKwlyZXR1cm4g
KHJldCB8IHdhaXRfYXV4X29wX2ZpbmlzaChjdHgpKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGlj
IGludCBzcF90eF9nZXRfZWRpZF9ibG9jayhzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gPiAr
ewo+ID4gKwlpbnQgYyA9IDA7Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVu
dC0+ZGV2Owo+ID4gKwo+ID4gKwlzcF90eF9hdXhfd3IoY3R4LCAweDdlKTsKPiA+ICsJc3BfdHhf
YXV4X3JkKGN0eCwgMHgwMSk7Cj4gPiArCWMgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY3R4LT5p
MmMucnhfcDBfY2xpZW50LCBBUF9BVVhfQlVGRl9TVEFSVCk7Cj4gPiArCWlmIChjIDwgMCkgewo+
ID4gKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGFjY2VzcyBBVVggQlVGRi5cbiIpOwo+ID4gKwkJ
cmV0dXJuIC1FSU87Cj4gPiArCX0KPiA+ICsKPiA+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2
LCAiIEVESUQgQmxvY2sgPSAlZFxuIiwgYyArIDEpOwo+ID4gKwo+ID4gKwlpZiAoYyA+IDMpCj4g
Cj4gUmVwbGFjZSBtYWdpYyBudW1iZXIgMyB3aXRoIGEgZGVmaW5lLgo+IAo+ID4gKwkJYyA9IDE7
Cj4gPiArCj4gPiArCXJldHVybiBjOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW50IGVkaWRf
cmVhZChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCj4gPiArCQkgICAgIHU4IG9mZnNldCwgdTgg
KnBibG9ja19idWYpCj4gPiArewo+ID4gKwl1OCBjLCBjbnQgPSAwOwo+ICAgICAgICAgICAgICAg
Xl5eXl5eXgo+IE5vIG5lZWQuCj4gCj4gPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNs
aWVudC0+ZGV2Owo+ID4gKwo+ID4gKwljID0gMDsKPiA+ICsJZm9yIChjbnQgPSAwOyBjbnQgPCAz
OyBjbnQrKykgewo+ID4gKwkJc3BfdHhfYXV4X3dyKGN0eCwgb2Zmc2V0KTsKPiA+ICsJCS8qIHNl
dCBJMkMgcmVhZCBjb20gMHgwMSBtb3QgPSAwIGFuZCByZWFkIDE2IGJ5dGVzICovCj4gPiArCQlj
ID0gc3BfdHhfYXV4X3JkKGN0eCwgMHhmMSk7Cj4gCj4gYyBuZWVkcyB0byBiZSBhbiBpbnQgYmVj
YXVzZSB0aGlzIHJldHVybnMgbmVnYXRpdmUgZXJyb3IgY29kZXMuCj4gCj4gPiArCj4gPiArCQlp
ZiAoYyA9PSAxKSB7Cj4gCj4gV2hhdCBkb2VzIDEgbWVhbiBpbiB0aGlzIGNvbnRleHQ/ICBJdCBz
ZWVtcyBsaWtlIGEgbWFnaWMgbnVtYmVyLiAgTWFrZQo+IGl0IGEgZGVmaW5lLgo+IAo+ID4gKwkJ
CXNwX3R4X3JzdF9hdXgoY3R4KTsKPiA+ICsJCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJl
ZGlkIHJlYWQgZmFpbGVkLCByZXNldCFcbiIpOwo+ID4gKwkJCWNudCsrOwo+ID4gKwkJfSBlbHNl
IHsKPiA+ICsJCQlhbng3NjI1X3JlZ19ibG9ja19yZWFkKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xp
ZW50LAo+ID4gKwkJCQkJICAgICAgIEFQX0FVWF9CVUZGX1NUQVJULAo+ID4gKwkJCQkJICAgICAg
IE1BWF9EUENEX0JVRkZFUl9TSVpFLAo+ID4gKwkJCQkJICAgICAgIHBibG9ja19idWYpOwo+ID4g
KwkJCXJldHVybiAwOwo+IAo+IFdoeSBkbyB3ZSBkbyB0aGlzIHJlYWQ/ICBJdCdzIHdlaXJkIHRo
YXQgd2UgZG9uJ3QgY2hlY2sgZm9yIGVycm9ycy4KPiAKPiA+ICsJCX0KPiA+ICsJfQo+ID4gKwo+
ID4gKwlyZXR1cm4gLUVJTzsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBzZWdtZW50c19l
ZGlkX3JlYWQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAo+ID4gKwkJCSAgICAgIHU4IHNlZ21l
bnQsIHU4ICpidWYsIHU4IG9mZnNldCkKPiA+ICt7Cj4gPiArCXU4IGMsIGNudCA9IDA7Cj4gPiAr
CWludCByZXQ7Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+
ID4gKwo+ID4gKwkvKiB3cml0ZSBhZGRyZXNzIG9ubHkgKi8KPiA+ICsJcmV0ID0gYW54NzYyNV9y
ZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4gPiArCQkJCUFQX0FVWF9BRERS
XzdfMCwgMHgzMCk7Cj4gPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJj
LnJ4X3AwX2NsaWVudCwKPiA+ICsJCQkJIEFQX0FVWF9DT01NQU5ELCAweDA0KTsKPiA+ICsJcmV0
IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ID4gKwkJ
CQkgQVBfQVVYX0NUUkxfU1RBVFVTLAo+ID4gKwkJCQkgQVBfQVVYX0NUUkxfQUREUk9OTFkgfCBB
UF9BVVhfQ1RSTF9PUF9FTik7Cj4gPiArCj4gPiArCXJldCB8PSB3YWl0X2F1eF9vcF9maW5pc2go
Y3R4KTsKPiA+ICsJLyogd3JpdGUgc2VnbWVudCBhZGRyZXNzICovCj4gPiArCXJldCB8PSBzcF90
eF9hdXhfd3IoY3R4LCBzZWdtZW50KTsKPiA+ICsJLyogZGF0YSByZWFkICovCj4gPiArCXJldCB8
PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiA+ICsJCQkJ
IEFQX0FVWF9BRERSXzdfMCwgMHg1MCk7Cj4gPiArCWlmIChyZXQgPCAwKSB7Cj4gPiArCQlEUk1f
RVJST1IoIklPIGVycm9yIDogYXV4IGluaXRpYWwgZmFpbGVkLlxuIik7Cj4gPiArCQlyZXR1cm4g
cmV0Owo+ID4gKwl9Cj4gPiArCj4gPiArCWZvciAoY250ID0gMDsgY250IDwgMzsgY250KyspIHsK
PiA+ICsJCXNwX3R4X2F1eF93cihjdHgsIG9mZnNldCk7Cj4gPiArCQkvKiBzZXQgSTJDIHJlYWQg
Y29tIDB4MDEgbW90ID0gMCBhbmQgcmVhZCAxNiBieXRlcyAqLwo+ID4gKwkJYyA9IHNwX3R4X2F1
eF9yZChjdHgsIDB4ZjEpOwo+ID4gKwo+ID4gKwkJaWYgKGMgPT0gMSkgewo+IAo+IFNhbWUuCj4g
Cj4gPiArCQkJcmV0ID0gc3BfdHhfcnN0X2F1eChjdHgpOwo+ID4gKwkJCURSTV9ERVZfRVJST1Io
ZGV2LCAic2VnbWVudCByZWFkIGZhaWxlZCwgcmVzZXQhXG4iKTsKPiA+ICsJCQljbnQrKzsKPiA+
ICsJCX0gZWxzZSB7Cj4gPiArCQkJcmV0ID0gYW54NzYyNV9yZWdfYmxvY2tfcmVhZChjdHgsIGN0
eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiA+ICsJCQkJCQkgICAgIEFQX0FVWF9CVUZGX1NUQVJULAo+
ID4gKwkJCQkJCSAgICAgTUFYX0RQQ0RfQlVGRkVSX1NJWkUsIGJ1Zik7Cj4gPiArCQkJcmV0dXJu
IHJldDsKPiA+ICsJCX0KPiA+ICsJfQo+ID4gKwo+ID4gKwlyZXR1cm4gcmV0Owo+ID4gK30KPiA+
ICsKPiA+ICtzdGF0aWMgaW50IHNwX3R4X2VkaWRfcmVhZChzdHJ1Y3QgYW54NzYyNV9kYXRhICpj
dHgsCj4gPiArCQkJICAgdTggKnBlZGlkX2Jsb2Nrc19idWYpCj4gPiArewo+ID4gKwl1OCBvZmZz
ZXQsIGVkaWRfcG9zOwo+ID4gKwlpbnQgY291bnQsIGJsb2Nrc19udW07Cj4gPiArCXU4IHBibG9j
a19idWZbTUFYX0RQQ0RfQlVGRkVSX1NJWkVdOwo+ID4gKwl1OCBpLCBqOwo+ID4gKwl1OCBnX2Vk
aWRfYnJlYWsgPSAwOwo+ID4gKwlpbnQgcmV0Owo+ID4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAm
Y3R4LT5jbGllbnQtPmRldjsKPiA+ICsKPiA+ICsJLyogYWRkcmVzcyBpbml0aWFsICovCj4gPiAr
CXJldCA9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ID4g
KwkJCQlBUF9BVVhfQUREUl83XzAsIDB4NTApOwo+ID4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3Jp
dGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4gPiArCQkJCSBBUF9BVVhfQUREUl8xNV84
LCAwKTsKPiA+ICsJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDBf
Y2xpZW50LAo+ID4gKwkJCQkgQVBfQVVYX0FERFJfMTlfMTYsIDB4ZjApOwo+ID4gKwlpZiAocmV0
IDwgMCkgewo+ID4gKwkJRFJNX0VSUk9SKCJhY2Nlc3MgYXV4IGNoYW5uZWwgSU8gZXJyb3IuXG4i
KTsKPiA+ICsJCXJldHVybiAtRUlPOwo+ID4gKwl9Cj4gPiArCj4gPiArCWJsb2Nrc19udW0gPSBz
cF90eF9nZXRfZWRpZF9ibG9jayhjdHgpOwo+ID4gKwlpZiAoYmxvY2tzX251bSA8IDApCj4gPiAr
CQlyZXR1cm4gYmxvY2tzX251bTsKPiA+ICsKPiA+ICsJY291bnQgPSAwOwo+ID4gKwo+ID4gKwlk
byB7Cj4gPiArCQlzd2l0Y2ggKGNvdW50KSB7Cj4gPiArCQljYXNlIDA6Cj4gPiArCQljYXNlIDE6
Cj4gPiArCQkJZm9yIChpID0gMDsgaSA8IDg7IGkrKykgewo+ID4gKwkJCQlvZmZzZXQgPSAoaSAr
IGNvdW50ICogOCkgKiBNQVhfRFBDRF9CVUZGRVJfU0laRTsKPiA+ICsJCQkJZ19lZGlkX2JyZWFr
ID0gZWRpZF9yZWFkKGN0eCwgb2Zmc2V0LAo+ID4gKwkJCQkJCQkgcGJsb2NrX2J1Zik7Cj4gPiAr
Cj4gPiArCQkJCWlmIChnX2VkaWRfYnJlYWspCj4gPiArCQkJCQlicmVhazsKPiA+ICsKPiA+ICsJ
CQkJbWVtY3B5KCZwZWRpZF9ibG9ja3NfYnVmW29mZnNldF0sCj4gPiArCQkJCSAgICAgICBwYmxv
Y2tfYnVmLAo+ID4gKwkJCQkgICAgICAgTUFYX0RQQ0RfQlVGRkVSX1NJWkUpOwo+ID4gKwkJCX0K
PiA+ICsKPiA+ICsJCQlicmVhazsKPiA+ICsJCWNhc2UgMjoKPiA+ICsJCQlvZmZzZXQgPSAweDAw
Owo+ID4gKwo+ID4gKwkJCWZvciAoaiA9IDA7IGogPCA4OyBqKyspIHsKPiA+ICsJCQkJZWRpZF9w
b3MgPSAoaiArIGNvdW50ICogOCkgKgo+ID4gKwkJCQkJTUFYX0RQQ0RfQlVGRkVSX1NJWkU7Cj4g
PiArCj4gPiArCQkJCWlmIChnX2VkaWRfYnJlYWsgPT0gMSkKPiA+ICsJCQkJCWJyZWFrOwo+ID4g
Kwo+ID4gKwkJCQlzZWdtZW50c19lZGlkX3JlYWQoY3R4LCBjb3VudCAvIDIsCj4gPiArCQkJCQkJ
ICAgcGJsb2NrX2J1Ziwgb2Zmc2V0KTsKPiA+ICsJCQkJbWVtY3B5KCZwZWRpZF9ibG9ja3NfYnVm
W2VkaWRfcG9zXSwKPiA+ICsJCQkJICAgICAgIHBibG9ja19idWYsCj4gPiArCQkJCSAgICAgICBN
QVhfRFBDRF9CVUZGRVJfU0laRSk7Cj4gPiArCQkJCW9mZnNldCA9IG9mZnNldCArIDB4MTA7Cj4g
PiArCQkJfQo+ID4gKwo+ID4gKwkJCWJyZWFrOwo+ID4gKwkJY2FzZSAzOgo+ID4gKwkJCW9mZnNl
dCA9IDB4ODA7Cj4gPiArCj4gPiArCQkJZm9yIChqID0gMDsgaiA8IDg7IGorKykgewo+ID4gKwkJ
CQllZGlkX3BvcyA9IChqICsgY291bnQgKiA4KSAqCj4gPiArCQkJCQlNQVhfRFBDRF9CVUZGRVJf
U0laRTsKPiA+ICsJCQkJaWYgKGdfZWRpZF9icmVhayA9PSAxKQo+ID4gKwkJCQkJYnJlYWs7Cj4g
PiArCj4gPiArCQkJCXNlZ21lbnRzX2VkaWRfcmVhZChjdHgsIGNvdW50IC8gMiwKPiA+ICsJCQkJ
CQkgICBwYmxvY2tfYnVmLCBvZmZzZXQpOwo+ID4gKwkJCQltZW1jcHkoJnBlZGlkX2Jsb2Nrc19i
dWZbZWRpZF9wb3NdLAo+ID4gKwkJCQkgICAgICAgcGJsb2NrX2J1ZiwKPiA+ICsJCQkJICAgICAg
IE1BWF9EUENEX0JVRkZFUl9TSVpFKTsKPiA+ICsJCQkJb2Zmc2V0ID0gb2Zmc2V0ICsgMHgxMDsK
PiA+ICsJCQl9Cj4gPiArCj4gPiArCQkJYnJlYWs7Cj4gPiArCQlkZWZhdWx0Ogo+ID4gKwkJCWJy
ZWFrOwo+ID4gKwkJfQo+ID4gKwo+ID4gKwkJY291bnQrKzsKPiA+ICsKPiA+ICsJfSB3aGlsZSAo
YmxvY2tzX251bSA+PSBjb3VudCk7Cj4gPiArCj4gPiArCS8qIGNoZWNrIGVkaWQgZGF0YSAqLwo+
ID4gKwlpZiAoZHJtX2VkaWRfaXNfdmFsaWQoKHN0cnVjdCBlZGlkICopcGVkaWRfYmxvY2tzX2J1
ZikgPT0gZmFsc2UpCj4gCj4gaWYgKCFkcm1fZWRpZF9pc192YWxpZCgoc3RydWN0IGVkaWQgKilw
ZWRpZF9ibG9ja3NfYnVmKSkKPiAKPiBTaG91bGRuJ3QgdGhpcyByZXR1cm4gYSBuZWdhdGl2ZSBl
cnJvcj8KPiAKPiA+ICsJCURSTV9ERVZfRVJST1IoZGV2LCAiV0FSTklORyEgZWRpZCBjaGVjayBm
YWlsZWQhXG4iKTsKPiA+ICsKPiA+ICsJLyogcmVzZXQgYXV4IGNoYW5uZWwgKi8KPiA+ICsJc3Bf
dHhfcnN0X2F1eChjdHgpOwo+ID4gKwo+ID4gKwlyZXR1cm4gKGJsb2Nrc19udW0gKyAxKTsKPiA+
ICt9Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgYW54NzYyNV9wb3dlcl9vbihzdHJ1Y3QgYW54NzYy
NV9kYXRhICpjdHgpCj4gPiArewo+ID4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGll
bnQtPmRldjsKPiA+ICsKPiA+ICsJaWYgKGN0eC0+cGRhdGEubG93X3Bvd2VyX21vZGUpIHsKPiAK
PiBSZXZlcnNlIHRoaXMgY29uZGl0aW9uCj4gCj4gCWlmICghY3R4LT5wZGF0YS5sb3dfcG93ZXJf
bW9kZSkgewo+IAkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiQW54NzYyNSBub3QgbG93IHBv
d2VyIG1vZGUhXG4iKTsKPiAJCXJldHVybjsKPiAJfQo+IAo+ID4gKwkJLyogcG93ZXIgb24gcGlu
IGVuYWJsZSAqLwo+ID4gKwkJZ3Bpb2Rfc2V0X3ZhbHVlKGN0eC0+cGRhdGEuZ3Bpb19wX29uLCAx
KTsKPiA+ICsJCXVzbGVlcF9yYW5nZSgxMDAwMCwgMTEwMDApOwo+ID4gKwkJLyogcG93ZXIgcmVz
ZXQgcGluIGVuYWJsZSAqLwo+ID4gKwkJZ3Bpb2Rfc2V0X3ZhbHVlKGN0eC0+cGRhdGEuZ3Bpb19y
ZXNldCwgMSk7Cj4gPiArCQl1c2xlZXBfcmFuZ2UoMTAwMDAsIDExMDAwKTsKPiA+ICsKPiA+ICsJ
CURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIkFueDc2MjUgcG93ZXIgb24gIVxuIik7Cj4gPiAr
CX0gZWxzZSB7Cj4gPiArCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJBbng3NjI1IG5vdCBs
b3cgcG93ZXIgbW9kZSFcbiIpOwo+ID4gKwl9Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lk
IGFueDc2MjVfcG93ZXJfc3RhbmRieShzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gPiArewo+
ID4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKPiA+ICsKPiA+ICsJ
aWYgKGN0eC0+cGRhdGEubG93X3Bvd2VyX21vZGUpIHsKPiAKPiBTYW1lCj4gCj4gPiArCQlncGlv
ZF9zZXRfdmFsdWUoY3R4LT5wZGF0YS5ncGlvX3Jlc2V0LCAwKTsKPiA+ICsJCXVzbGVlcF9yYW5n
ZSgxMDAwLCAxMTAwKTsKPiA+ICsJCWdwaW9kX3NldF92YWx1ZShjdHgtPnBkYXRhLmdwaW9fcF9v
biwgMCk7Cj4gPiArCQl1c2xlZXBfcmFuZ2UoMTAwMCwgMTEwMCk7Cj4gPiArCQlEUk1fREVWX0RF
QlVHX0RSSVZFUihkZXYsICJhbng3NjI1IHBvd2VyIGRvd25cbiIpOwo+ID4gKwl9IGVsc2Ugewo+
ID4gKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiYW54NzYyNSBub3QgbG93IHBvd2VyIG1v
ZGUhXG4iKTsKPiA+ICsJfQo+ID4gK30KPiA+ICsKPiA+ICsvKiBiYXNpYyBjb25maWd1cmF0aW9u
cyBvZiBBTlg3NjI1ICovCj4gPiArc3RhdGljIHZvaWQgYW54NzYyNV9jb25maWcoc3RydWN0IGFu
eDc2MjVfZGF0YSAqY3R4KQo+ID4gK3sKPiA+ICsJYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgt
PmkyYy5yeF9wMF9jbGllbnQsCj4gPiArCQkJICBYVEFMX0ZSUV9TRUwsIFhUQUxfRlJRXzI3TSk7
Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGFueDc2MjVfZGlzYWJsZV9wZF9wcm90b2Nv
bChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gPiArewo+ID4gKwlzdHJ1Y3QgZGV2aWNlICpk
ZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKPiA+ICsJaW50IHJldDsKPiA+ICsKPiA+ICsJLyogcmVz
ZXQgbWFpbiBvY20gKi8KPiA+ICsJcmV0ID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmky
Yy5yeF9wMF9jbGllbnQsIDB4ODgsIDB4NDApOwo+ID4gKwkvKiBEaXNhYmxlIFBEICovCj4gPiAr
CXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiA+
ICsJCQkJIEFQX0FWX1NUQVRVUywgQVBfRElTQUJMRV9QRCk7Cj4gPiArCS8qIHJlbGVhc2UgbWFp
biBvY20gKi8KPiA+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhf
cDBfY2xpZW50LCAweDg4LCAweDAwKTsKPiA+ICsKPiA+ICsJaWYgKHJldCA8IDApCj4gPiArCQlE
Uk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJkaXNhYmxlIFBEIGZlYXR1cmUgZmFpbGVkLlxuIik7
Cj4gPiArCWVsc2UKPiA+ICsJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRpc2FibGUgUEQg
ZmVhdHVyZSBzdWNjZWVkZWQuXG4iKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgYW54
NzYyNV9wb3dlcl9vbl9pbml0KHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKPiA+ICt7Cj4gPiAr
CWludCByZXRyeV9jb3VudCwgaTsKPiA+ICsJaW50IHJldCA9IDA7Cj4gPiArCXN0cnVjdCBkZXZp
Y2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ID4gKwo+ID4gKwlmb3IgKHJldHJ5X2NvdW50
ID0gMDsgcmV0cnlfY291bnQgPCAzOyByZXRyeV9jb3VudCsrKSB7Cj4gPiArCQlhbng3NjI1X3Bv
d2VyX29uKGN0eCk7Cj4gPiArCQlhbng3NjI1X2NvbmZpZyhjdHgpOwo+ID4gKwo+ID4gKwkJZm9y
IChpID0gMDsgaSA8IE9DTV9MT0FESU5HX1RJTUU7IGkrKykgewo+ID4gKwkJCS8qIGNoZWNrIGlu
dGVyZmFjZSB3b3JrYWJsZSAqLwo+ID4gKwkJCXJldCA9IGFueDc2MjVfcmVnX3JlYWQoY3R4LCBj
dHgtPmkyYy5yeF9wMF9jbGllbnQsCj4gPiArCQkJCQkgICAgICAgRkxBU0hfTE9BRF9TVEEpOwo+
ID4gKwkJCWlmIChyZXQgPCAwKSB7Cj4gPiArCQkJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBhY2Nl
c3MgZmxhc2ggbG9hZC5cbiIpOwo+ID4gKwkJCQlyZXR1cm47Cj4gPiArCQkJfQo+ID4gKwkJCWlm
ICgocmV0ICYgRkxBU0hfTE9BRF9TVEFfQ0hLKSA9PSBGTEFTSF9MT0FEX1NUQV9DSEspIHsKPiA+
ICsJCQkJYW54NzYyNV9kaXNhYmxlX3BkX3Byb3RvY29sKGN0eCk7Cj4gPiArCQkJCURSTV9ERVZf
REVCVUdfRFJJVkVSKGRldiwKPiA+ICsJCQkJCQkgICAgICJGaXJtd2FyZSB2ZXIgJTAyeCUwMngs
IiwKPiA+ICsJCQkJCWFueDc2MjVfcmVnX3JlYWQoY3R4LAo+ID4gKwkJCQkJCQkgY3R4LT5pMmMu
cnhfcDBfY2xpZW50LAo+ID4gKwkJCQkJCQkgT0NNX0ZXX1ZFUlNJT04pLAo+ID4gKwkJCQkJYW54
NzYyNV9yZWdfcmVhZChjdHgsCj4gPiArCQkJCQkJCSBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4g
PiArCQkJCQkJCSBPQ01fRldfUkVWRVJTSU9OKSk7Cj4gPiArCQkJCURSTV9ERVZfREVCVUdfRFJJ
VkVSKGRldiwgIkRyaXZlciB2ZXJzaW9uICVzXG4iLAo+ID4gKwkJCQkJCSAgICAgQU5YNzYyNV9E
UlZfVkVSU0lPTik7Cj4gPiArCj4gPiArCQkJCXJldHVybjsKPiA+ICsJCQl9Cj4gPiArCQkJdXNs
ZWVwX3JhbmdlKDEwMDAsIDExMDApOwo+ID4gKwkJfQo+ID4gKwkJYW54NzYyNV9wb3dlcl9zdGFu
ZGJ5KGN0eCk7Cj4gPiArCX0KPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBhbng3NjI1X2V4
dGNvbl9ub3RpZmllcihzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgKm5iLAo+ID4gKwkJCQkgICB1bnNp
Z25lZCBsb25nIGV2ZW50LCB2b2lkICpwdHIpCj4gPiArewo+ID4gKwlzdHJ1Y3QgYW54NzYyNV9k
YXRhICpjdHggPQo+ID4gKwkJY29udGFpbmVyX29mKG5iLCBzdHJ1Y3QgYW54NzYyNV9kYXRhLCBl
dmVudF9uYik7Cj4gPiArCj4gPiArCXNjaGVkdWxlX3dvcmsoJmN0eC0+ZXh0Y29uX3dxKTsKPiA+
ICsJcmV0dXJuIE5PVElGWV9ET05FOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCBhbng3
NjI1X2NoaXBfY29udHJvbChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsIGludCBzdGF0ZSkKPiA+
ICt7Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ID4gKwo+
ID4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJiZWZvcmUgc2V0LCBwb3dlcl9zdGF0ZSgl
ZCkuXG4iLAo+ID4gKwkJCSAgICAgYXRvbWljX3JlYWQoJmN0eC0+cG93ZXJfc3RhdHVzKSk7Cj4g
PiArCWlmIChjdHgtPnBkYXRhLmxvd19wb3dlcl9tb2RlKSB7Cj4gCj4gUmV2c2Vyc2UgdGhpcyBj
b25kaXRpb246Cj4gCj4gCWlmICghY3R4LT5wZGF0YS5sb3dfcG93ZXJfbW9kZSkKPiAJCXJldHVy
bjsKPiAKPiA+ICsJCWlmIChzdGF0ZSkgewo+ID4gKwkJCWF0b21pY19pbmMoJmN0eC0+cG93ZXJf
c3RhdHVzKTsKPiA+ICsJCQlpZiAoYXRvbWljX3JlYWQoJmN0eC0+cG93ZXJfc3RhdHVzKSA9PSAx
KQo+ID4gKwkJCQlhbng3NjI1X3Bvd2VyX29uX2luaXQoY3R4KTsKPiA+ICsJCX0gZWxzZSB7Cj4g
PiArCQkJaWYgKGF0b21pY19yZWFkKCZjdHgtPnBvd2VyX3N0YXR1cykpIHsKPiA+ICsJCQkJYXRv
bWljX2RlYygmY3R4LT5wb3dlcl9zdGF0dXMpOwo+ID4gKwo+ID4gKwkJCQlpZiAoYXRvbWljX3Jl
YWQoJmN0eC0+cG93ZXJfc3RhdHVzKSA9PSAwKQo+ID4gKwkJCQkJYW54NzYyNV9wb3dlcl9zdGFu
ZGJ5KGN0eCk7Cj4gPiArCQkJfQo+ID4gKwkJfQo+ID4gKwl9Cj4gPiArCj4gPiArCURSTV9ERVZf
REVCVUdfRFJJVkVSKGRldiwgImFmdGVyIHNldCwgcG93ZXJfc3RhdGUoJWQpLlxuIiwKPiA+ICsJ
CQkgICAgIGF0b21pY19yZWFkKCZjdHgtPnBvd2VyX3N0YXR1cykpOwo+ID4gK30KPiA+ICsKPiA+
ICtzdGF0aWMgdm9pZCBhbng3NjI1X2V4dGNvbl93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29y
aykKPiA+ICt7Cj4gPiArCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCA9Cj4gPiArCQljb250YWlu
ZXJfb2Yod29yaywgc3RydWN0IGFueDc2MjVfZGF0YSwgZXh0Y29uX3dxKTsKPiA+ICsJaW50IHN0
YXRlID0gZXh0Y29uX2dldF9zdGF0ZShjdHgtPmV4dGNvbiwgRVhUQ09OX0RJU1BfRFApOwo+ID4g
Kwo+ID4gKwltdXRleF9sb2NrKCZjdHgtPmxvY2spOwo+ID4gKwlhbng3NjI1X2NoaXBfY29udHJv
bChjdHgsIHN0YXRlKTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZjdHgtPmxvY2spOwo+ID4gK30KPiA+
ICsKPiA+ICtzdGF0aWMgaW50IGFueDc2MjVfZXh0Y29uX25vdGlmaWVyX2luaXQoc3RydWN0IGFu
eDc2MjVfZGF0YSAqY3R4KQo+ID4gK3sKPiA+ICsJaW50IHJldDsKPiA+ICsJc3RydWN0IGRldmlj
ZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7Cj4gPiArCj4gPiArCWN0eC0+ZXZlbnRfbmIubm90
aWZpZXJfY2FsbCA9IGFueDc2MjVfZXh0Y29uX25vdGlmaWVyOwo+ID4gKwlJTklUX1dPUksoJmN0
eC0+ZXh0Y29uX3dxLCBhbng3NjI1X2V4dGNvbl93b3JrKTsKPiA+ICsJcmV0ID0gZGV2bV9leHRj
b25fcmVnaXN0ZXJfbm90aWZpZXIoJmN0eC0+Y2xpZW50LT5kZXYsIGN0eC0+ZXh0Y29uLAo+ID4g
KwkJCQkJICAgIEVYVENPTl9ESVNQX0RQLCAmY3R4LT5ldmVudF9uYik7Cj4gPiArCWlmIChyZXQp
IHsKPiA+ICsJCURSTV9ERVZfRVJST1IoZGV2LCAiZmFpbGVkIHRvIHJlZ2lzdGVyIG5vdGlmaWVy
IGZvciBEUCIpOwo+ID4gKwkJcmV0dXJuIHJldDsKPiA+ICsJfQo+ID4gKwlyZXR1cm4gMDsKPiA+
ICt9Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgYW54NzYyNV9pbml0X2dwaW8oc3RydWN0IGFueDc2
MjVfZGF0YSAqcGxhdGZvcm0pCj4gPiArewo+ID4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmcGxh
dGZvcm0tPmNsaWVudC0+ZGV2Owo+ID4gKwo+ID4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYs
ICJhbng3NjI1IGluaXQgZ3Bpb1xuIik7Cj4gPiArCj4gPiArCS8qIGdwaW8gZm9yIGNoaXAgcG93
ZXIgZW5hYmxlICovCj4gPiArCXBsYXRmb3JtLT5wZGF0YS5ncGlvX3Bfb24gPQo+ID4gKwkJZGV2
bV9ncGlvZF9nZXRfb3B0aW9uYWwoZGV2LCAiZW5hYmxlIiwgR1BJT0RfT1VUX0xPVyk7Cj4gPiAr
CS8qIGdwaW8gZm9yIGNoaXAgcmVzZXQgKi8KPiA+ICsJcGxhdGZvcm0tPnBkYXRhLmdwaW9fcmVz
ZXQgPQo+ID4gKwkJZGV2bV9ncGlvZF9nZXRfb3B0aW9uYWwoZGV2LCAicmVzZXQiLCBHUElPRF9P
VVRfTE9XKTsKPiA+ICsKPiA+ICsJaWYgKHBsYXRmb3JtLT5wZGF0YS5ncGlvX3Bfb24gJiYgcGxh
dGZvcm0tPnBkYXRhLmdwaW9fcmVzZXQpIHsKPiA+ICsJCXBsYXRmb3JtLT5wZGF0YS5sb3dfcG93
ZXJfbW9kZSA9IDE7Cj4gPiArCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJsb3cgcG93ZXIg
bW9kZSwgcG9uICVkLCByZXNldCAlZC5cbiIsCj4gPiArCQkJCSAgICAgZGVzY190b19ncGlvKHBs
YXRmb3JtLT5wZGF0YS5ncGlvX3Bfb24pLAo+ID4gKwkJCQkgICAgIGRlc2NfdG9fZ3BpbyhwbGF0
Zm9ybS0+cGRhdGEuZ3Bpb19yZXNldCkpOwo+ID4gKwl9IGVsc2Ugewo+ID4gKwkJcGxhdGZvcm0t
PnBkYXRhLmxvd19wb3dlcl9tb2RlID0gMDsKPiA+ICsJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRl
diwgIm5vdCBsb3cgcG93ZXIgbW9kZS5cbiIpOwo+ID4gKwl9Cj4gPiArCj4gPiArCXBsYXRmb3Jt
LT5wZGF0YS5ncGlvX2ludHJfaHBkID0KPiA+ICsJCWRldm1fZ3Bpb2RfZ2V0X29wdGlvbmFsKGRl
diwgImhwZCIsIEdQSU9EX0lOKTsKPiA+ICsKPiA+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2
LCAiaHBkIGdwaW8gJWQuXG4iLAo+ID4gKwkJCSAgICAgKCFwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19p
bnRyX2hwZCkgPyAwIDoKPiA+ICsJCQkgICAgIGRlc2NfdG9fZ3BpbyhwbGF0Zm9ybS0+cGRhdGEu
Z3Bpb19pbnRyX2hwZCkpOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCBhbng3NjI1X3N0
b3BfZHBfd29yayhzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gPiArewo+ID4gKwljdHgtPmhw
ZF9zdGF0dXMgPSAwOwo+ID4gKwljdHgtPmhwZF9oaWdoX2NudCA9IDA7Cj4gPiArCWN0eC0+ZGlz
cGxheV90aW1pbmdfdmFsaWQgPSAwOwo+ID4gKwo+ID4gKwljdHgtPnNsaW1wb3J0X2VkaWRfcC5l
ZGlkX2Jsb2NrX251bSA9IC0xOwo+ID4gKwo+ID4gKwlpZiAoY3R4LT5wZGF0YS5sb3dfcG93ZXJf
bW9kZSA9PSAwKQo+ID4gKwkJYW54NzYyNV9kaXNhYmxlX3BkX3Byb3RvY29sKGN0eCk7Cj4gPiAr
fQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGFueDc2MjVfc3RhcnRfZHBfd29yayhzdHJ1Y3QgYW54
NzYyNV9kYXRhICpjdHgpCj4gPiArewo+ID4gKwlpbnQgcmV0Owo+ID4gKwl1OCBidWZbTUFYX0RQ
Q0RfQlVGRkVSX1NJWkVdOwo+ID4gKwl1OCBoZGNwX2NhcDsKPiA+ICsJc3RydWN0IGRldmljZSAq
ZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7Cj4gPiArCj4gCj4gRGVsZXRlIHRoaXMgYmxhbmsgbGlu
ZS4KPiAKPiA+ICsJdTggc3BfdHhfYnc7IC8qIGxpbmt0cmFpbmluZyBiYW53aWR0aCAqLwo+ID4g
Kwl1OCBzcF90eF9sYW5lX2NvdW50OyAvKiBsaW5rIHRyYWluaW5nIGxhbmUgY291bnQgKi8KPiA+
ICsKPiA+ICsJaWYgKGN0eC0+aHBkX2hpZ2hfY250ID49IDIpIHsKPiA+ICsJCURSTV9ERVZfREVC
VUdfRFJJVkVSKGRldiwgImFueDc2MjUgZmlsdGVyIHVzZWxlc3MgSFBEXG4iKTsKPiA+ICsJCXJl
dHVybjsKPiA+ICsJfQo+ID4gKwo+ID4gKwljdHgtPmhwZF9oaWdoX2NudCsrOwo+ID4gKwo+ID4g
KwlzcF90eF9nZXRfcnhfYncoY3R4LCAmc3BfdHhfYncpOwo+ID4gKwo+ID4gKwlzcF90eF9hdXhf
ZHBjZHJlYWRfYnl0ZXMoY3R4LCAweDAwLCAweDAwLCBEUENEX01BWF9MQU5FX0NPVU5ULAo+ID4g
KwkJCQkgMSwgJnNwX3R4X2xhbmVfY291bnQpOwo+ID4gKwo+ID4gKwlzcF90eF9sYW5lX2NvdW50
ID0gc3BfdHhfbGFuZV9jb3VudCAmIDB4MWY7Cj4gPiArCXNwX3R4X2F1eF9kcGNkcmVhZF9ieXRl
cyhjdHgsIDB4MDYsIDB4ODAsIDB4MjgsIDEsIGJ1Zik7LyogcmVhZCBCY2FwICovCj4gPiArCj4g
PiArCWhkY3BfY2FwID0gYnVmWzBdICYgMHgwMTsKPiA+ICsKPiA+ICsJLyogbm90IHN1cHBvcnQg
SERDUCAqLwo+ID4gKwlyZXQgPSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+aTJjLnJ4X3Ax
X2NsaWVudCwgMHhlZSwgMHg5Zik7Cj4gPiArCj4gPiArCWlmIChoZGNwX2NhcCA9PSAweDAxKQo+
ID4gKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiSERDUDEuNFxuIik7Cj4gPiArCj4gPiAr
CS8qIHRyeSBhdXRoIGZsYWcgKi8KPiA+ICsJcmV0IHw9IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBj
dHgtPmkyYy5yeF9wMV9jbGllbnQsIDB4ZWMsIDB4MTApOwo+ID4gKwkvKiBpbnRlcnJ1cHQgZm9y
IERSTSAqLwo+ID4gKwlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3Ax
X2NsaWVudCwgMHhmZiwgMHgwMSk7Cj4gPiArCWlmIChyZXQgPCAwKQo+ID4gKwkJcmV0dXJuOwo+
ID4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJNQVggQlc9JTAyeCwgTUFYIExhbmUgY250
PSUwMngsIEhEQ1A9JTAyeFxuIiwKPiA+ICsJCQkgICAgICh1MzIpc3BfdHhfYncsCj4gPiArCQkJ
ICAgICAodTMyKXNwX3R4X2xhbmVfY291bnQsCj4gPiArCQkJICAgICAodTMyKWhkY3BfY2FwKTsK
PiA+ICsKPiA+ICsJcmV0ID0gYW54NzYyNV9yZWdfcmVhZChjdHgsIGN0eC0+aTJjLnJ4X3AxX2Ns
aWVudCwgMHg4Nik7Cj4gPiArCWlmIChyZXQgPCAwKQo+ID4gKwkJcmV0dXJuOwo+ID4gKwo+ID4g
KwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJTZWN1cmUgT0NNIHZlcnNpb249JTAyeFxuIiwg
cmV0KTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBhbng3NjI1X3JlYWRfaHBkX3N0YXR1
c19wMChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gPiArewo+ID4gKwlyZXR1cm4gYW54NzYy
NV9yZWdfcmVhZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwgU1lTVEVNX1NUU1RVUyk7Cj4g
PiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGFueDc2MjVfaHBkX3BvbGxpbmcoc3RydWN0IGFu
eDc2MjVfZGF0YSAqY3R4KQo+ID4gK3sKPiA+ICsJaW50IHJldCwgdmFsOwo+ID4gKwlzdHJ1Y3Qg
ZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKPiA+ICsKPiA+ICsJaWYgKGF0b21pY19y
ZWFkKCZjdHgtPnBvd2VyX3N0YXR1cykgIT0gMSkgewo+ID4gKwkJRFJNX0RFVl9ERUJVR19EUklW
RVIoZGV2LCAiTm8gbmVlZCB0byBwb2xpbmcgSFBEIHN0YXR1cy5cbiIpOwo+ID4gKwkJcmV0dXJu
Owo+ID4gKwl9Cj4gPiArCj4gPiArCXJldCA9IHJlYWR4X3BvbGxfdGltZW91dChhbng3NjI1X3Jl
YWRfaHBkX3N0YXR1c19wMCwKPiA+ICsJCQkJIGN0eCwgdmFsLAo+ID4gKwkJCQkgKCh2YWwgJiBI
UERfU1RBVFVTKSB8fCAodmFsIDwgMCkpLAo+ID4gKwkJCQkgNTAwMCwKPiA+ICsJCQkJIDUwMDAg
KiAxMDApOwo+ID4gKwlpZiAocmV0KSB7Cj4gPiArCQlEUk1fREVWX0VSUk9SKGRldiwgIkhQRCBw
b2xsaW5nIHRpbWVvdXQhXG4iKTsKPiA+ICsJfSBlbHNlIHsKPiA+ICsJCURSTV9ERVZfREVCVUdf
RFJJVkVSKGRldiwgIkhQRCByYWlzZSB1cC5cbiIpOwo+ID4gKwkJYW54NzYyNV9yZWdfd3JpdGUo
Y3R4LCBjdHgtPmkyYy50Y3BjX2NsaWVudCwKPiA+ICsJCQkJICBJTlRSX0FMRVJUXzEsIDB4RkYp
Owo+ID4gKwkJYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4g
PiArCQkJCSAgSU5URVJGQUNFX0NIQU5HRV9JTlQsIDApOwo+ID4gKwl9Cj4gPiArCj4gPiArCWFu
eDc2MjVfc3RhcnRfZHBfd29yayhjdHgpOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCBh
bng3NjI1X2Rpc2Nvbm5lY3RfY2hlY2soc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQo+ID4gK3sK
PiA+ICsJaWYgKGF0b21pY19yZWFkKCZjdHgtPnBvd2VyX3N0YXR1cykgPT0gMCkKPiA+ICsJCWFu
eDc2MjVfc3RvcF9kcF93b3JrKGN0eCk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGFu
eDc2MjVfbG93X3Bvd2VyX21vZGVfY2hlY2soc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAo+ID4g
KwkJCQkJIGludCBzdGF0ZSkKPiA+ICt7Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgt
PmNsaWVudC0+ZGV2Owo+ID4gKwo+ID4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJsb3cg
cG93ZXIgbW9kZSBjaGVjaywgc3RhdGUoJWQpLlxuIiwgc3RhdGUpOwo+ID4gKwo+ID4gKwlpZiAo
Y3R4LT5wZGF0YS5sb3dfcG93ZXJfbW9kZSkgewo+ID4gKwkJYW54NzYyNV9jaGlwX2NvbnRyb2wo
Y3R4LCBzdGF0ZSk7Cj4gPiArCQlpZiAoc3RhdGUpCj4gPiArCQkJYW54NzYyNV9ocGRfcG9sbGlu
ZyhjdHgpOwo+ID4gKwkJZWxzZQo+ID4gKwkJCWFueDc2MjVfZGlzY29ubmVjdF9jaGVjayhjdHgp
Owo+ID4gKwl9Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGRwX2hwZF9jaGFuZ2VfaGFu
ZGxlcihzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsIGJvb2wgb24pCj4gPiArewo+ID4gKwlzdHJ1
Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKPiA+ICsKPiA+ICsJLyogaHBkIGNo
YW5nZWQgKi8KPiA+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZHBfaHBkX2NoYW5nZV9k
ZWZhdWx0X2Z1bmM6ICVkXG4iLAo+ID4gKwkJCSAgICAgKHUzMilvbik7Cj4gPiArCj4gPiArCWlm
IChvbiA9PSAwKSB7Cj4gPiArCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICIgSFBEIGxvd1xu
Iik7Cj4gPiArCQlhbng3NjI1X3N0b3BfZHBfd29yayhjdHgpOwo+ID4gKwl9IGVsc2Ugewo+ID4g
KwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiIEhQRCBoaWdoXG4iKTsKPiA+ICsJCWFueDc2
MjVfc3RhcnRfZHBfd29yayhjdHgpOwo+ID4gKwl9Cj4gPiArCj4gPiArCWN0eC0+aHBkX3N0YXR1
cyA9IDE7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgYW54NzYyNV9ocGRfY2hhbmdlX2Rl
dGVjdChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gPiArewo+ID4gKwlpbnQgaW50cl92ZWN0
b3IsIHN0YXR1czsKPiA+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7
Cj4gPiArCj4gPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgInBvd2VyX3N0YXR1cz0lZFxu
IiwKPiA+ICsJCQkgICAgICh1MzIpYXRvbWljX3JlYWQoJmN0eC0+cG93ZXJfc3RhdHVzKSk7Cj4g
PiArCj4gPiArCXN0YXR1cyA9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMudGNwY19j
bGllbnQsCj4gPiArCQkJCSAgIElOVFJfQUxFUlRfMSwgMHhGRik7Cj4gPiArCWlmIChzdGF0dXMg
PCAwKSB7Cj4gPiArCQlEUk1fRVJST1IoIklPIGVycm9yIDogY2xlYXIgYWxlcnQgcmVnaXN0ZXIu
XG4iKTsKPiA+ICsJCXJldHVybiBzdGF0dXM7Cj4gPiArCX0KPiA+ICsKPiA+ICsJaW50cl92ZWN0
b3IgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ID4gKwkJ
CQkgICAgICAgSU5URVJGQUNFX0NIQU5HRV9JTlQpOwo+ID4gKwlpZiAoaW50cl92ZWN0b3IgPCAw
KSB7Cj4gPiArCQlEUk1fRVJST1IoIklPIGVycm9yIDogYWNjZXNzIGludGVycnVwdCBjaGFuZ2Ug
cmVnaXN0ZXIuXG4iKTsKPiA+ICsJCXJldHVybiBpbnRyX3ZlY3RvcjsKPiA+ICsJfQo+ID4gKwlE
Uk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICIweDdlOjB4NDQ9JXhcbiIsIGludHJfdmVjdG9yKTsK
PiA+ICsJc3RhdHVzID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGll
bnQsCj4gPiArCQkJCSAgIElOVEVSRkFDRV9DSEFOR0VfSU5ULAo+ID4gKwkJCQkgICBpbnRyX3Zl
Y3RvciAmICh+aW50cl92ZWN0b3IpKTsKPiA+ICsJaWYgKHN0YXR1cyA8IDApIHsKPiA+ICsJCURS
TV9FUlJPUigiSU8gZXJyb3IgOiBjbGVhciBpbnRlcnJ1cHQgY2hhbmdlIHJlZ2lzdGVyLlxuIik7
Cj4gPiArCQlyZXR1cm4gc3RhdHVzOwo+ID4gKwl9Cj4gPiArCj4gPiArCWlmIChpbnRyX3ZlY3Rv
ciAmIEhQRF9TVEFUVVNfQ0hBTkdFKSB7Cj4gCj4gUmV2ZXJzZSB0aGlzIGNvbmRpdGlvbi4gIFdl
IGFsd2F5cyB3YW50IHRoZSBub3JtYWwvc3VjY2VzcyBwYXRoCj4gaW5kZW50ZWQgb25lIHRhYiBh
bmQgdGhlIHdlaXJkL2Vycm9yIHBhdGggaW5kZW50ZWQgdHdvIHRhYnMuCj4gCj4gCWlmIChzdGF0
dXMgPCAwKSB7Cj4gCQlEUk1fRVJST1IoIklPIGVycm9yIDogY2xlYXIgaW50ZXJydXB0IGNoYW5n
ZSByZWdpc3Rlci5cbiIpOwo+IAkJcmV0dXJuIHN0YXR1czsKPiAJfQo+IAlpZiAoIShpbnRyX3Zl
Y3RvciAmIEhQRF9TVEFUVVNfQ0hBTkdFKSkKPiAJCXJldHVybiAtRU5PRU5UOwo+IAo+ID4gKwkJ
c3RhdHVzID0gYW54NzYyNV9yZWdfcmVhZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiA+
ICsJCQkJCSAgU1lTVEVNX1NUU1RVUyk7Cj4gPiArCQlpZiAoc3RhdHVzIDwgMCkgewo+ID4gKwkJ
CURSTV9FUlJPUigiSU8gZXJyb3IgOiBjbGVhciBpbnRlcnJ1cHQgc3RhdHVzLlxuIik7Cj4gPiAr
CQkJcmV0dXJuIHN0YXR1czsKPiA+ICsJCX0KPiA+ICsKPiA+ICsJCURSTV9ERVZfREVCVUdfRFJJ
VkVSKGRldiwgIjB4N2U6MHg0NT0leFxuIiwgc3RhdHVzKTsKPiA+ICsJCWRwX2hwZF9jaGFuZ2Vf
aGFuZGxlcihjdHgsIHN0YXR1cyAmIEhQRF9TVEFUVVMpOwo+ID4gKwkJcmV0dXJuIDA7Cj4gPiAr
CX0KPiA+ICsKPiA+ICsJcmV0dXJuIC1FTk9FTlQ7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2
b2lkIGFueDc2MjVfd29ya19mdW5jKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiA+ICt7Cj4g
PiArCWludCBldmVudDsKPiA+ICsJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0gY29udGFpbmVy
X29mKHdvcmssCj4gPiArCQkJCQkJc3RydWN0IGFueDc2MjVfZGF0YSwgd29yayk7Cj4gPiArCj4g
PiArCW11dGV4X2xvY2soJmN0eC0+bG9jayk7Cj4gPiArCWV2ZW50ID0gYW54NzYyNV9ocGRfY2hh
bmdlX2RldGVjdChjdHgpOwo+ID4gKwltdXRleF91bmxvY2soJmN0eC0+bG9jayk7Cj4gPiArCj4g
PiArCWlmIChldmVudCA8IDApCj4gPiArCQlyZXR1cm47Cj4gPiArCj4gPiArCWlmIChjdHgtPmJy
aWRnZV9hdHRhY2hlZCkKPiA+ICsJCWRybV9oZWxwZXJfaHBkX2lycV9ldmVudChjdHgtPmNvbm5l
Y3Rvci5kZXYpOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaXJxcmV0dXJuX3QgYW54NzYyNV9p
bnRyX2hwZF9pc3IoaW50IGlycSwgdm9pZCAqZGF0YSkKPiA+ICt7Cj4gPiArCXN0cnVjdCBhbng3
NjI1X2RhdGEgKmN0eCA9IChzdHJ1Y3QgYW54NzYyNV9kYXRhICopZGF0YTsKPiA+ICsKPiA+ICsJ
aWYgKGF0b21pY19yZWFkKCZjdHgtPnBvd2VyX3N0YXR1cykgIT0gMSkKPiA+ICsJCXJldHVybiBJ
UlFfTk9ORTsKPiA+ICsKPiA+ICsJcXVldWVfd29yayhjdHgtPndvcmtxdWV1ZSwgJmN0eC0+d29y
ayk7Cj4gPiArCj4gPiArCXJldHVybiBJUlFfSEFORExFRDsKPiA+ICt9Cj4gPiArCj4gPiArI2lm
ZGVmIENPTkZJR19PRgo+ID4gK3N0YXRpYyBpbnQgYW54NzYyNV9wYXJzZV9kdChzdHJ1Y3QgZGV2
aWNlICpkZXYsCj4gPiArCQkJICAgIHN0cnVjdCBhbng3NjI1X3BsYXRmb3JtX2RhdGEgKnBkYXRh
KQo+ID4gK3sKPiA+ICsJc3RydWN0IGRldmljZV9ub2RlICpucCA9IGRldi0+b2Zfbm9kZTsKPiA+
ICsJc3RydWN0IGRldmljZV9ub2RlICptaXBpX2hvc3Rfbm9kZTsKPiA+ICsJc3RydWN0IGRldmlj
ZV9ub2RlICpwYW5lbF9ub2RlLCAqb3V0X2VwOwo+ID4gKwo+ID4gKwlwZGF0YS0+bm9kZS5taXBp
X2RzaV9ob3N0X25vZGUgPSBvZl9ncmFwaF9nZXRfcmVtb3RlX25vZGUobnAsIDAsIDApOwo+ID4g
KwlpZiAocGRhdGEtPm5vZGUubWlwaV9kc2lfaG9zdF9ub2RlKSB7Cj4gPiArCQlvZl9ub2RlX3B1
dChwZGF0YS0+bm9kZS5taXBpX2RzaV9ob3N0X25vZGUpOwo+ID4gKwkJcGRhdGEtPmRzaV9zdXBw
b3J0ZWQgPSAxOwo+ID4gKwkJbWlwaV9ob3N0X25vZGUgPSBwZGF0YS0+bm9kZS5taXBpX2RzaV9o
b3N0X25vZGU7Cj4gPiArCX0gZWxzZSB7Cj4gPiArCQlwZGF0YS0+bm9kZS5taXBpX2RwaV9ob3N0
X25vZGUgPQo+ID4gKwkJCW9mX2dyYXBoX2dldF9yZW1vdGVfbm9kZShucCwgMSwgMCk7Cj4gPiAr
CQlpZiAoIXBkYXRhLT5ub2RlLm1pcGlfZHBpX2hvc3Rfbm9kZSkKPiA+ICsJCQlEUk1fRVJST1Io
ImNhbm5vdCByZXNvbHZlIGFueSBNSVBJIGhvc3Qgbm9kZS5cbiIpOwo+ID4gKwkJZWxzZQo+ID4g
KwkJCW9mX25vZGVfcHV0KHBkYXRhLT5ub2RlLm1pcGlfZHBpX2hvc3Rfbm9kZSk7Cj4gPiArCj4g
PiArCQltaXBpX2hvc3Rfbm9kZSA9IHBkYXRhLT5ub2RlLm1pcGlfZHBpX2hvc3Rfbm9kZTsKPiA+
ICsJfQo+ID4gKwo+ID4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJkc2lfc3VwcG9ydGVk
IDogJWRcbiIsIHBkYXRhLT5kc2lfc3VwcG9ydGVkKTsKPiA+ICsJRFJNX0RFVl9ERUJVR19EUklW
RVIoZGV2LCAibWlwaSBob3N0IG5vZGUgJXMgZXhpc3RcbiIsCj4gPiArCQkJICAgICAoIW1pcGlf
aG9zdF9ub2RlKSA/ICJub3QiIDogIiAiKTsKPiAKPiBUaGlzIGRlYnVnIG1lc3NhZ2UgaXMgcG9p
bnRsZXMgYmVjYXVzZSBpZiBtaXBpX2hvc3Rfbm9kZSBpcyBOVUxMIHRoZW4KPiB3ZSBhbHJlYWR5
IHByaW50ZWQgYW4gZXJyb3IgbWVzc2FnZS4gIERlbGV0ZSB0aGUgbWlwaV9ob3N0X25vZGUgdmFy
aWFibGUKPiBhcyB3ZWxsLgo+IAo+ID4gKwo+ID4gKwlwZGF0YS0+bm9kZS5leHRjb25fbm9kZSA9
IG9mX2dyYXBoX2dldF9wb3J0X2J5X2lkKG5wLCAyKTsKPiA+ICsJcGRhdGEtPm5vZGUuaW50ZXJu
YWxfcGFuZWxfbm9kZSA9IG9mX2dyYXBoX2dldF9wb3J0X2J5X2lkKG5wLCAzKTsKPiA+ICsJcGRh
dGEtPm5vZGUuZWRwX25vZGUgPSBvZl9ncmFwaF9nZXRfcG9ydF9ieV9pZChucCwgNCk7Cj4gPiAr
CWlmIChwZGF0YS0+bm9kZS5leHRjb25fbm9kZSkKPiA+ICsJCXBkYXRhLT5leHRjb25fc3VwcG9y
dGVkID0gMTsKPiA+ICsKPiA+ICsJaWYgKHBkYXRhLT5ub2RlLmludGVybmFsX3BhbmVsX25vZGUp
IHsKPiA+ICsJCXBkYXRhLT5pbnRlcm5hbF9wYW5lbCA9IDE7Cj4gPiArCQlvZl9ub2RlX3B1dChw
ZGF0YS0+bm9kZS5pbnRlcm5hbF9wYW5lbF9ub2RlKTsKPiA+ICsJCW91dF9lcCA9IG9mX2dldF9j
aGlsZF9ieV9uYW1lKHBkYXRhLT5ub2RlLmludGVybmFsX3BhbmVsX25vZGUsCj4gPiArCQkJCQkg
ICAgICAiZW5kcG9pbnQiKTsKPiA+ICsJCWlmIChvdXRfZXApIHsKPiAKPiBSZXZlcnNlIHRoaXMg
Y29uZGl0aW9uLiAgRXJyb3IgcGF0aCBpcyBpbmRlbnRlZCwgc3VjY2VzcyBwYXRoIGlzIG5vdC4K
PiAKPiA+ICsJCQlwYW5lbF9ub2RlID0gb2ZfZ3JhcGhfZ2V0X3JlbW90ZV9wb3J0X3BhcmVudChv
dXRfZXApOwo+ID4gKwkJCW9mX25vZGVfcHV0KG91dF9lcCk7Cj4gPiArCj4gPiArCQkJcGRhdGEt
PnBhbmVsID0gb2ZfZHJtX2ZpbmRfcGFuZWwocGFuZWxfbm9kZSk7Cj4gPiArCQkJRFJNX0RFVl9E
RUJVR19EUklWRVIoZGV2LCAiZ2V0IHBhbmVsIG5vZGUuXG4iKTsKPiA+ICsJCQlvZl9ub2RlX3B1
dChwYW5lbF9ub2RlKTsKPiA+ICsJCQlpZiAoSVNfRVJSX09SX05VTEwocGRhdGEtPnBhbmVsKSkK
PiA+ICsJCQkJcmV0dXJuIC1FUFJPQkVfREVGRVI7Cj4gPiArCQl9IGVsc2Ugewo+ID4gKwkJCURS
TV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImNhbm5vdCBnZXQgZW5kcG9pbnQuXG4iKTsKPiA+ICsJ
CQlyZXR1cm4gLUVQUk9CRV9ERUZFUjsKPiA+ICsJCX0KPiA+ICsJfQo+ID4gKwo+ID4gKwlEUk1f
REVWX0RFQlVHX0RSSVZFUihkZXYsICIlcyBzdXBwb3J0IGV4dGNvbiwgJXMgaW50ZXJuYWwgcGFu
ZWxcbiIsCj4gPiArCQkJICAgICBwZGF0YS0+ZXh0Y29uX3N1cHBvcnRlZCA/ICIiIDogIm5vdCIs
Cj4gPiArCQkJICAgICBwZGF0YS0+aW50ZXJuYWxfcGFuZWwgPyAiaGFzIiA6ICJubyIpOwo+ID4g
Kwo+ID4gKwlyZXR1cm4gMDsKPiA+ICt9Cj4gPiArI2Vsc2UKPiA+ICtzdGF0aWMgaW50IGFueDc2
MjVfcGFyc2VfZHQoc3RydWN0IGRldmljZSAqZGV2LAo+ID4gKwkJCSAgICBzdHJ1Y3QgYW54NzYy
NV9wbGF0Zm9ybV9kYXRhICpwZGF0YSkKPiA+ICt7Cj4gPiArCXJldHVybiAtRU5PREVWOwo+ID4g
K30KPiA+ICsjZW5kaWYKPiA+ICsKPiA+ICtzdGF0aWMgaW5saW5lIHN0cnVjdCBhbng3NjI1X2Rh
dGEgKmNvbm5lY3Rvcl90b19hbng3NjI1KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjKQo+ID4gK3sK
PiA+ICsJcmV0dXJuIGNvbnRhaW5lcl9vZihjLCBzdHJ1Y3QgYW54NzYyNV9kYXRhLCBjb25uZWN0
b3IpOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW5saW5lIHN0cnVjdCBhbng3NjI1X2RhdGEg
KmJyaWRnZV90b19hbng3NjI1KHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UpCj4gPiArewo+ID4g
KwlyZXR1cm4gY29udGFpbmVyX29mKGJyaWRnZSwgc3RydWN0IGFueDc2MjVfZGF0YSwgYnJpZGdl
KTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgYW54NzYyNV9wb3N0X2Rpc2FibGUoc3Ry
dWN0IGRybV9icmlkZ2UgKmJyaWRnZSkKPiA+ICt7Cj4gPiArCXN0cnVjdCBhbng3NjI1X2RhdGEg
KmN0eCA9IGJyaWRnZV90b19hbng3NjI1KGJyaWRnZSk7Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmRl
diA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ID4gKwlpbnQgcmV0Owo+ID4gKwo+ID4gKwlEUk1fREVW
X0RFQlVHX0RSSVZFUihkZXYsICJwb3N0IGRpc2FibGVcbiIpOwo+ID4gKwlpZiAoY3R4LT5wZGF0
YS5wYW5lbCkgewo+IAo+IFJldmVyc2UuCj4gCj4gPiArCQlyZXQgPSBkcm1fcGFuZWxfdW5wcmVw
YXJlKGN0eC0+cGRhdGEucGFuZWwpOwo+ID4gKwkJaWYgKHJldCkKPiA+ICsJCQlEUk1fRVJST1Io
ImZhaWxlZCB0byB1bnByZXBhcmUgcGFuZWw6ICVkXG4iLCByZXQpOwo+ID4gKwkJZWxzZQo+ID4g
KwkJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImJhY2tsaWdodCB1bnByZXBhcmVkLlxuIik7
Cj4gPiArCj4gPiArCQlhdG9taWNfc2V0KCZjdHgtPnBhbmVsX3Bvd2VyLCAwKTsKPiA+ICsJfQo+
ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCBhbng3NjI1X3ByZV9lbmFibGUoc3RydWN0IGRy
bV9icmlkZ2UgKmJyaWRnZSkKPiA+ICt7Cj4gPiArCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCA9
IGJyaWRnZV90b19hbng3NjI1KGJyaWRnZSk7Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZj
dHgtPmNsaWVudC0+ZGV2Owo+ID4gKwlpbnQgcmV0Owo+ID4gKwo+ID4gKwlEUk1fREVWX0RFQlVH
X0RSSVZFUihkZXYsICJwcmUgZW5hYmxlXG4iKTsKPiA+ICsJaWYgKGN0eC0+cGRhdGEucGFuZWwp
IHsKPiAKPiBSZXZlcnNlLgo+IAo+ID4gKwkJcmV0ID0gZHJtX3BhbmVsX3ByZXBhcmUoY3R4LT5w
ZGF0YS5wYW5lbCk7Cj4gPiArCQlpZiAocmV0IDwgMCkKPiA+ICsJCQlEUk1fRVJST1IoImZhaWxl
ZCB0byBwcmVwYXJlIHBhbmVsOiAlZFxuIiwgcmV0KTsKPiA+ICsJCWVsc2UKPiA+ICsJCQlEUk1f
REVWX0RFQlVHX0RSSVZFUihkZXYsICJiYWNrbGlnaHQgcHJlcGFyZWQuXG4iKTsKPiA+ICsJCWF0
b21pY19zZXQoJmN0eC0+cGFuZWxfcG93ZXIsIDEpOwo+ID4gKwl9Cj4gPiArfQo+ID4gKwo+ID4g
K3N0YXRpYyBpbnQgYW54NzYyNV9nZXRfbW9kZXMoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5l
Y3RvcikKPiA+ICt7Cj4gPiArCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCA9IGNvbm5lY3Rvcl90
b19hbng3NjI1KGNvbm5lY3Rvcik7Cj4gPiArCWludCBlcnIsIG51bV9tb2RlcyA9IDA7Cj4gPiAr
CWludCB0dXJuX29mZl9mbGFnID0gMDsKPiA+ICsJc3RydWN0IHNfZWRpZF9kYXRhICpwX2VkaWQg
PSAmY3R4LT5zbGltcG9ydF9lZGlkX3A7Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgt
PmNsaWVudC0+ZGV2Owo+ID4gKwo+ID4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJkcm0g
Z2V0IG1vZGVzXG4iKTsKPiA+ICsKPiA+ICsJaWYgKGN0eC0+c2xpbXBvcnRfZWRpZF9wLmVkaWRf
YmxvY2tfbnVtID4gMCkKPiA+ICsJCWdvdG8gb3V0Owo+ID4gKwo+ID4gKwltdXRleF9sb2NrKCZj
dHgtPmxvY2spOwo+ID4gKwo+ID4gKwlpZiAoY3R4LT5wZGF0YS5wYW5lbCAmJiBhdG9taWNfcmVh
ZCgmY3R4LT5wYW5lbF9wb3dlcikgPT0gMCkgewo+ID4gKwkJdHVybl9vZmZfZmxhZyA9IDE7Cj4g
PiArCQlhbng3NjI1X3ByZV9lbmFibGUoJmN0eC0+YnJpZGdlKTsKPiA+ICsJfQo+ID4gKwo+ID4g
Kwlhbng3NjI1X2xvd19wb3dlcl9tb2RlX2NoZWNrKGN0eCwgMSk7Cj4gPiArCj4gPiArCXBfZWRp
ZC0+ZWRpZF9ibG9ja19udW0gPSBzcF90eF9lZGlkX3JlYWQoY3R4LCBwX2VkaWQtPmVkaWRfcmF3
X2RhdGEpOwo+ID4gKwo+ID4gKwllcnIgPSAtRUlPOwo+ID4gKwlpZiAocF9lZGlkLT5lZGlkX2Js
b2NrX251bSA8IDApIHsKPiA+ICsJCURSTV9FUlJPUigiRmFpbGVkIHRvIHJlYWQgRURJRC5cbiIp
Owo+ID4gKwkJZ290byBmYWlsOwo+ID4gKwl9Cj4gPiArCj4gPiArCWVyciA9IGRybV9jb25uZWN0
b3JfdXBkYXRlX2VkaWRfcHJvcGVydHkoY29ubmVjdG9yLAo+ID4gKwkJCQkJCSAoc3RydWN0IGVk
aWQgKikKPiA+ICsJCQkJCQkgJnBfZWRpZC0+ZWRpZF9yYXdfZGF0YSk7Cj4gPiArCj4gPiArCWlm
IChlcnIpCj4gPiArCQlEUk1fRVJST1IoIkZhaWxlZCB0byB1cGRhdGUgRURJRCBwcm9wZXJ0eTog
JWRcbiIsIGVycik7Cj4gPiArCj4gPiArZmFpbDoKPiA+ICsJbXV0ZXhfdW5sb2NrKCZjdHgtPmxv
Y2spOwo+ID4gKwlhbng3NjI1X2xvd19wb3dlcl9tb2RlX2NoZWNrKGN0eCwgMCk7Cj4gPiArCWlm
IChjdHgtPnBkYXRhLnBhbmVsICYmIHR1cm5fb2ZmX2ZsYWcgPT0gMSkKPiA+ICsJCWFueDc2MjVf
cG9zdF9kaXNhYmxlKCZjdHgtPmJyaWRnZSk7Cj4gPiArCj4gPiArCWlmIChlcnIpCj4gPiArCQly
ZXR1cm4gZXJyOwo+ID4gKwo+ID4gK291dDoKPiA+ICsJbnVtX21vZGVzID0gZHJtX2FkZF9lZGlk
X21vZGVzKGNvbm5lY3RvciwKPiA+ICsJCQkJICAgICAgIChzdHJ1Y3QgZWRpZCAqKSZwX2VkaWQt
PmVkaWRfcmF3X2RhdGEpOwo+ID4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJudW1fbW9k
ZXMoJWQpXG4iLCBudW1fbW9kZXMpOwo+ID4gKwo+ID4gKwlyZXR1cm4gbnVtX21vZGVzOwo+ID4g
K30KPiA+ICsKPiA+ICtzdGF0aWMgZW51bSBkcm1fbW9kZV9zdGF0dXMKPiA+ICthbng3NjI1X2Nv
bm5lY3Rvcl9tb2RlX3ZhbGlkKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCj4gPiAr
CQkJICAgICBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkKPiA+ICt7Cj4gPiArCXN0cnVj
dCBhbng3NjI1X2RhdGEgKmN0eCA9IGNvbm5lY3Rvcl90b19hbng3NjI1KGNvbm5lY3Rvcik7Cj4g
PiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ID4gKwo+ID4gKwlE
Uk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJkcm0gbW9kZXMgdmFsaWQgdmVyaWZ5XG4iKTsKPiA+
ICsKPiA+ICsJaWYgKG1vZGUtPmNsb2NrID4gMzAwMDAwKQo+IAo+IE1ha2UgYWxsIHRoZSByZWZl
cmVuY2VzIHRvIDMwMDAwMCBhIGRlZmluZS4KPiAKPiA+ICsJCXJldHVybiBNT0RFX0NMT0NLX0hJ
R0g7Cj4gPiArCj4gPiArCXJldHVybiBNT0RFX09LOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMg
c3RydWN0IGRybV9jb25uZWN0b3JfaGVscGVyX2Z1bmNzIGFueDc2MjVfY29ubmVjdG9yX2hlbHBl
cl9mdW5jcyA9IHsKPiA+ICsJLmdldF9tb2RlcyA9IGFueDc2MjVfZ2V0X21vZGVzLAo+ID4gKwku
bW9kZV92YWxpZCA9IGFueDc2MjVfY29ubmVjdG9yX21vZGVfdmFsaWQsCj4gPiArfTsKPiA+ICsK
PiA+ICtzdGF0aWMgZW51bSBkcm1fY29ubmVjdG9yX3N0YXR1cyBhbng3NjI1X2RldGVjdChzdHJ1
Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+ID4gKwkJCQkJCWJvb2wgZm9yY2UpCj4gPiAr
ewo+ID4gKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHggPSBjb25uZWN0b3JfdG9fYW54NzYyNShj
b25uZWN0b3IpOwo+ID4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsK
PiA+ICsKPiA+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZHJtIGRldGVjdFxuIik7Cj4g
PiArCj4gPiArCWlmIChjdHgtPnBkYXRhLmludGVybmFsX3BhbmVsKQo+ID4gKwkJcmV0dXJuIGNv
bm5lY3Rvcl9zdGF0dXNfY29ubmVjdGVkOwo+ID4gKwo+ID4gKwlpZiAoIWN0eC0+aHBkX3N0YXR1
cykKPiA+ICsJCXJldHVybiBjb25uZWN0b3Jfc3RhdHVzX2Rpc2Nvbm5lY3RlZDsKPiA+ICsKPiA+
ICsJcmV0dXJuIGNvbm5lY3Rvcl9zdGF0dXNfY29ubmVjdGVkOwo+ID4gK30KPiA+ICsKPiA+ICtz
dGF0aWMgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3JfZnVuY3MgYW54NzYyNV9jb25uZWN0b3Jf
ZnVuY3MgPSB7Cj4gPiArCS5maWxsX21vZGVzID0gZHJtX2hlbHBlcl9wcm9iZV9zaW5nbGVfY29u
bmVjdG9yX21vZGVzLAo+ID4gKwkuZGV0ZWN0ID0gYW54NzYyNV9kZXRlY3QsCj4gPiArCS5kZXN0
cm95ID0gZHJtX2Nvbm5lY3Rvcl9jbGVhbnVwLAo+ID4gKwkucmVzZXQgPSBkcm1fYXRvbWljX2hl
bHBlcl9jb25uZWN0b3JfcmVzZXQsCj4gPiArCS5hdG9taWNfZHVwbGljYXRlX3N0YXRlID0gZHJt
X2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2R1cGxpY2F0ZV9zdGF0ZSwKPiA+ICsJLmF0b21pY19k
ZXN0cm95X3N0YXRlID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2Rlc3Ryb3lfc3RhdGUs
Cj4gPiArfTsKPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCBhbng3NjI1X2F0dGFjaF9kc2koc3RydWN0
IGFueDc2MjVfZGF0YSAqY3R4KQo+ID4gK3sKPiA+ICsJc3RydWN0IG1pcGlfZHNpX2hvc3QgKmhv
c3Q7Cj4gPiArCXN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaTsKPiA+ICsJc3RydWN0IGRldmlj
ZV9ub2RlICptaXBpX2hvc3Rfbm9kZTsKPiA+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+
Y2xpZW50LT5kZXY7Cj4gPiArCWNvbnN0IHN0cnVjdCBtaXBpX2RzaV9kZXZpY2VfaW5mbyBpbmZv
ID0gewo+ID4gKwkJLnR5cGUgPSAiYW54NzYyNSIsCj4gPiArCQkuY2hhbm5lbCA9IDAsCj4gPiAr
CQkubm9kZSA9IE5VTEwsCj4gPiArCX07Cj4gPiArCj4gPiArCURSTV9ERVZfREVCVUdfRFJJVkVS
KGRldiwgImF0dGFjaCBkc2lcbiIpOwo+ID4gKwo+ID4gKwlpZiAoY3R4LT5wZGF0YS5kc2lfc3Vw
cG9ydGVkKQo+ID4gKwkJbWlwaV9ob3N0X25vZGUgPSBjdHgtPnBkYXRhLm5vZGUubWlwaV9kc2lf
aG9zdF9ub2RlOwo+ID4gKwllbHNlCj4gPiArCQltaXBpX2hvc3Rfbm9kZSA9IGN0eC0+cGRhdGEu
bm9kZS5taXBpX2RwaV9ob3N0X25vZGU7Cj4gPiArCj4gPiArCWlmICghbWlwaV9ob3N0X25vZGUp
IHsKPiA+ICsJCURSTV9FUlJPUigiZHNpIGhvc3QgaXMgbm90IGNvbmZpZ3VyZWQuXG4iKTsKPiA+
ICsJCXJldHVybjsKPiA+ICsJfQo+ID4gKwo+ID4gKwlob3N0ID0gb2ZfZmluZF9taXBpX2RzaV9o
b3N0X2J5X25vZGUobWlwaV9ob3N0X25vZGUpOwo+ID4gKwlpZiAoIWhvc3QpIHsKPiA+ICsJCURS
TV9FUlJPUigiZmFpbGVkIHRvIGZpbmQgZHNpIGhvc3QuXG4iKTsKPiA+ICsJCXJldHVybjsKPiA+
ICsJfQo+ID4gKwo+ID4gKwlkc2kgPSBtaXBpX2RzaV9kZXZpY2VfcmVnaXN0ZXJfZnVsbChob3N0
LCAmaW5mbyk7Cj4gPiArCWlmIChJU19FUlIoZHNpKSkgewo+ID4gKwkJRFJNX0VSUk9SKCJmYWls
ZWQgdG8gY3JlYXRlIGRzaSBkZXZpY2UuXG4iKTsKPiA+ICsJCXJldHVybjsKPiA+ICsJfQo+ID4g
Kwo+ID4gKwlkc2ktPmxhbmVzID0gNDsKPiA+ICsJZHNpLT5mb3JtYXQgPSBNSVBJX0RTSV9GTVRf
UkdCODg4Owo+ID4gKwlkc2ktPm1vZGVfZmxhZ3MgPSBNSVBJX0RTSV9NT0RFX1ZJREVPCXwKPiA+
ICsJCU1JUElfRFNJX01PREVfVklERU9fU1lOQ19QVUxTRQl8Cj4gPiArCQlNSVBJX0RTSV9NT0RF
X0VPVF9QQUNLRVQJfAo+ID4gKwkJTUlQSV9EU0lfTU9ERV9WSURFT19IU0U7Cj4gPiArCj4gPiAr
CWlmIChtaXBpX2RzaV9hdHRhY2goZHNpKSA8IDApIHsKPiA+ICsJCURSTV9FUlJPUigiZmFpbGVk
IHRvIGF0dGFjaCBkc2kgdG8gaG9zdC5cbiIpOwo+ID4gKwkJbWlwaV9kc2lfZGV2aWNlX3VucmVn
aXN0ZXIoZHNpKTsKPiA+ICsJCXJldHVybjsKPiA+ICsJfQo+ID4gKwo+ID4gKwljdHgtPmRzaSA9
IGRzaTsKPiA+ICsKPiA+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiYXR0YWNoIGRzaSBz
dWNjZWVkZWQuXG4iKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgYW54NzYyNV9kZXRh
Y2hfZHNpKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKPiA+ICt7Cj4gPiArCWlmIChjdHgtPmRz
aSkgewo+ID4gKwkJbWlwaV9kc2lfZGV0YWNoKGN0eC0+ZHNpKTsKPiA+ICsJCW1pcGlfZHNpX2Rl
dmljZV91bnJlZ2lzdGVyKGN0eC0+ZHNpKTsKPiA+ICsJfQo+ID4gK30KPiA+ICsKPiA+ICtzdGF0
aWMgaW50IGFueDc2MjVfYnJpZGdlX2F0dGFjaChzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQo+
ID4gK3sKPiA+ICsJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0gYnJpZGdlX3RvX2FueDc2MjUo
YnJpZGdlKTsKPiA+ICsJaW50IGVycjsKPiA+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+
Y2xpZW50LT5kZXY7Cj4gPiArCj4gPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRybSBh
dHRhY2hcbiIpOwo+ID4gKwlpZiAoIWJyaWRnZS0+ZW5jb2Rlcikgewo+ID4gKwkJRFJNX0VSUk9S
KCJQYXJlbnQgZW5jb2RlciBvYmplY3Qgbm90IGZvdW5kIik7Cj4gPiArCQlyZXR1cm4gLUVOT0RF
VjsKPiA+ICsJfQo+ID4gKwo+ID4gKwllcnIgPSBkcm1fY29ubmVjdG9yX2luaXQoYnJpZGdlLT5k
ZXYsICZjdHgtPmNvbm5lY3RvciwKPiA+ICsJCQkJICZhbng3NjI1X2Nvbm5lY3Rvcl9mdW5jcywK
PiA+ICsJCQkJIERSTV9NT0RFX0NPTk5FQ1RPUl9EaXNwbGF5UG9ydCk7Cj4gPiArCWlmIChlcnIp
IHsKPiA+ICsJCURSTV9FUlJPUigiRmFpbGVkIHRvIGluaXRpYWxpemUgY29ubmVjdG9yOiAlZFxu
IiwgZXJyKTsKPiA+ICsJCXJldHVybiBlcnI7Cj4gPiArCX0KPiA+ICsKPiA+ICsJZHJtX2Nvbm5l
Y3Rvcl9oZWxwZXJfYWRkKCZjdHgtPmNvbm5lY3RvciwKPiA+ICsJCQkJICZhbng3NjI1X2Nvbm5l
Y3Rvcl9oZWxwZXJfZnVuY3MpOwo+ID4gKwo+ID4gKwllcnIgPSBkcm1fY29ubmVjdG9yX3JlZ2lz
dGVyKCZjdHgtPmNvbm5lY3Rvcik7Cj4gPiArCWlmIChlcnIpIHsKPiA+ICsJCURSTV9FUlJPUigi
RmFpbGVkIHRvIHJlZ2lzdGVyIGNvbm5lY3RvcjogJWRcbiIsIGVycik7Cj4gPiArCQlyZXR1cm4g
ZXJyOwo+ID4gKwl9Cj4gPiArCj4gPiArCWN0eC0+Y29ubmVjdG9yLnBvbGxlZCA9IERSTV9DT05O
RUNUT1JfUE9MTF9IUEQ7Cj4gPiArCj4gPiArCWVyciA9IGRybV9jb25uZWN0b3JfYXR0YWNoX2Vu
Y29kZXIoJmN0eC0+Y29ubmVjdG9yLCBicmlkZ2UtPmVuY29kZXIpOwo+ID4gKwlpZiAoZXJyKSB7
Cj4gPiArCQlEUk1fRVJST1IoIkZhaWxlZCB0byBsaW5rIHVwIGNvbm5lY3RvciB0byBlbmNvZGVy
OiAlZFxuIiwgZXJyKTsKPiA+ICsJCWRybV9jb25uZWN0b3JfdW5yZWdpc3RlcigmY3R4LT5jb25u
ZWN0b3IpOwo+ID4gKwkJcmV0dXJuIGVycjsKPiA+ICsJfQo+ID4gKwo+ID4gKwlhbng3NjI1X2F0
dGFjaF9kc2koY3R4KTsKPiA+ICsKPiA+ICsJY3R4LT5icmlkZ2VfYXR0YWNoZWQgPSAxOwo+ID4g
Kwo+ID4gKwlyZXR1cm4gMDsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGVudW0gZHJtX21vZGVf
c3RhdHVzCj4gPiArYW54NzYyNV9icmlkZ2VfbW9kZV92YWxpZChzdHJ1Y3QgZHJtX2JyaWRnZSAq
YnJpZGdlLAo+ID4gKwkJCSAgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUpCj4g
PiArewo+ID4gKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHggPSBicmlkZ2VfdG9fYW54NzYyNShi
cmlkZ2UpOwo+ID4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKPiA+
ICsKPiA+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZHJtIG1vZGUgY2hlY2tpbmdcbiIp
Owo+ID4gKwo+ID4gKwkvKiBNYXggMTIwMHAgYXQgNS40IEdoeiwgb25lIGxhbmUsIHBpeGVsIGNs
b2NrIDMwME0gKi8KPiA+ICsJaWYgKG1vZGUtPmNsb2NrID4gMzAwMDAwKSB7Cj4gPiArCQlEUk1f
REVWX0RFQlVHX0RSSVZFUihkZXYsCj4gPiArCQkJCSAgICAgImRybSBtb2RlIGludmFsaWQsIHBp
eGVsY2xvY2sgdG9vIGhpZ2guXG4iKTsKPiA+ICsJCXJldHVybiBNT0RFX0NMT0NLX0hJR0g7Cj4g
PiArCX0KPiA+ICsKPiA+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZHJtIG1vZGUgdmFs
aWQuXG4iKTsKPiA+ICsKPiA+ICsJcmV0dXJuIE1PREVfT0s7Cj4gPiArfQo+ID4gKwo+ID4gK3N0
YXRpYyB2b2lkIGFueDc2MjVfYnJpZGdlX21vZGVfc2V0KHN0cnVjdCBkcm1fYnJpZGdlICpicmlk
Z2UsCj4gPiArCQkJCSAgICBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqb2xkX21vZGUs
Cj4gPiArCQkJCSAgICBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkKPiA+ICt7
Cj4gPiArCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCA9IGJyaWRnZV90b19hbng3NjI1KGJyaWRn
ZSk7Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ID4gKwo+
ID4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJkcm0gbW9kZSBzZXRcbiIpOwo+ID4gKwo+
ID4gKwltdXRleF9sb2NrKCZjdHgtPmxvY2spOwo+ID4gKwo+ID4gKwljdHgtPmR0LnBpeGVsY2xv
Y2subWluID0gbW9kZS0+Y2xvY2s7Cj4gPiArCWN0eC0+ZHQuaGFjdGl2ZS5taW4gPSBtb2RlLT5o
ZGlzcGxheTsKPiA+ICsJY3R4LT5kdC5oc3luY19sZW4ubWluID0gbW9kZS0+aHN5bmNfZW5kIC0g
bW9kZS0+aHN5bmNfc3RhcnQ7Cj4gPiArCWN0eC0+ZHQuaGZyb250X3BvcmNoLm1pbiA9IG1vZGUt
PmhzeW5jX3N0YXJ0IC0gbW9kZS0+aGRpc3BsYXk7Cj4gPiArCWN0eC0+ZHQuaGJhY2tfcG9yY2gu
bWluID0gbW9kZS0+aHRvdGFsIC0gbW9kZS0+aHN5bmNfZW5kOwo+ID4gKwljdHgtPmR0LnZhY3Rp
dmUubWluID0gbW9kZS0+dmRpc3BsYXk7Cj4gPiArCWN0eC0+ZHQudnN5bmNfbGVuLm1pbiA9IG1v
ZGUtPnZzeW5jX2VuZCAtIG1vZGUtPnZzeW5jX3N0YXJ0Owo+ID4gKwljdHgtPmR0LnZmcm9udF9w
b3JjaC5taW4gPSBtb2RlLT52c3luY19zdGFydCAtIG1vZGUtPnZkaXNwbGF5Owo+ID4gKwljdHgt
PmR0LnZiYWNrX3BvcmNoLm1pbiA9IG1vZGUtPnZ0b3RhbCAtIG1vZGUtPnZzeW5jX2VuZDsKPiA+
ICsKPiA+ICsJY3R4LT5kaXNwbGF5X3RpbWluZ192YWxpZCA9IDE7Cj4gPiArCj4gPiArCURSTV9E
RVZfREVCVUdfRFJJVkVSKGRldiwgInBpeGVsY2xvY2soJWQpLlxuIiwgY3R4LT5kdC5waXhlbGNs
b2NrLm1pbik7Cj4gPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImhhY3RpdmUoJWQpLCBo
c3luYyglZCksIGhmcCglZCksIGhicCglZClcbiIsCj4gPiArCQkJICAgICBjdHgtPmR0LmhhY3Rp
dmUubWluLAo+ID4gKwkJCSAgICAgY3R4LT5kdC5oc3luY19sZW4ubWluLAo+ID4gKwkJCSAgICAg
Y3R4LT5kdC5oZnJvbnRfcG9yY2gubWluLAo+ID4gKwkJCSAgICAgY3R4LT5kdC5oYmFja19wb3Jj
aC5taW4pOwo+ID4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJ2YWN0aXZlKCVkKSwgdnN5
bmMoJWQpLCB2ZnAoJWQpLCB2YnAoJWQpXG4iLAo+ID4gKwkJCSAgICAgY3R4LT5kdC52YWN0aXZl
Lm1pbiwKPiA+ICsJCQkgICAgIGN0eC0+ZHQudnN5bmNfbGVuLm1pbiwKPiA+ICsJCQkgICAgIGN0
eC0+ZHQudmZyb250X3BvcmNoLm1pbiwKPiA+ICsJCQkgICAgIGN0eC0+ZHQudmJhY2tfcG9yY2gu
bWluKTsKPiA+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiaGRpc3BsYXkoJWQpLGhzeW5j
X3N0YXJ0KCVkKS5cbiIsCj4gPiArCQkJICAgICBtb2RlLT5oZGlzcGxheSwKPiA+ICsJCQkgICAg
IG1vZGUtPmhzeW5jX3N0YXJ0KTsKPiA+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiaHN5
bmNfZW5kKCVkKSxodG90YWwoJWQpLlxuIiwKPiA+ICsJCQkgICAgIG1vZGUtPmhzeW5jX2VuZCwK
PiA+ICsJCQkgICAgIG1vZGUtPmh0b3RhbCk7Cj4gPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRl
diwgInZkaXNwbGF5KCVkKSx2c3luY19zdGFydCglZCkuXG4iLAo+ID4gKwkJCSAgICAgbW9kZS0+
dmRpc3BsYXksCj4gPiArCQkJICAgICBtb2RlLT52c3luY19zdGFydCk7Cj4gPiArCURSTV9ERVZf
REVCVUdfRFJJVkVSKGRldiwgInZzeW5jX2VuZCglZCksdnRvdGFsKCVkKS5cbiIsCj4gPiArCQkJ
ICAgICBtb2RlLT52c3luY19lbmQsCj4gPiArCQkJICAgICBtb2RlLT52dG90YWwpOwo+ID4gKwo+
ID4gKwltdXRleF91bmxvY2soJmN0eC0+bG9jayk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2
b2lkIGFueDc2MjVfYnJpZGdlX2VuYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQo+ID4g
K3sKPiA+ICsJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0gYnJpZGdlX3RvX2FueDc2MjUoYnJp
ZGdlKTsKPiA+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7Cj4gPiAr
CWludCByZXQ7Cj4gPiArCj4gPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRybSBlbmFi
bGVcbiIpOwo+ID4gKwo+ID4gKwlhbng3NjI1X2xvd19wb3dlcl9tb2RlX2NoZWNrKGN0eCwgMSk7
Cj4gPiArCj4gPiArCWlmIChXQVJOX09OKCFhdG9taWNfcmVhZCgmY3R4LT5wb3dlcl9zdGF0dXMp
KSkKPiA+ICsJCXJldHVybjsKPiA+ICsKPiA+ICsJaWYgKGN0eC0+cGRhdGEucGFuZWwpIHsKPiA+
ICsJCXJldCA9IGRybV9wYW5lbF9lbmFibGUoY3R4LT5wZGF0YS5wYW5lbCk7Cj4gPiArCQlpZiAo
cmV0IDwgMCkgewo+ID4gKwkJCURSTV9FUlJPUigiZmFpbGVkIHRvIGVuYWJsZSBwYW5lbDogJWQu
XG4iLCByZXQpOwo+ID4gKwkJCXJldHVybjsKPiA+ICsJCX0KPiA+ICsJfQo+ID4gKwo+ID4gKwlt
dXRleF9sb2NrKCZjdHgtPmxvY2spOwo+ID4gKwlhbng3NjI1X2RwX3N0YXJ0KGN0eCk7Cj4gPiAr
CW11dGV4X3VubG9jaygmY3R4LT5sb2NrKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHZvaWQg
YW54NzYyNV9icmlkZ2VfZGlzYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQo+ID4gK3sK
PiA+ICsJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0gYnJpZGdlX3RvX2FueDc2MjUoYnJpZGdl
KTsKPiA+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7Cj4gPiArCWlu
dCByZXQ7Cj4gPiArCj4gPiArCWlmIChXQVJOX09OKCFhdG9taWNfcmVhZCgmY3R4LT5wb3dlcl9z
dGF0dXMpKSkKPiA+ICsJCXJldHVybjsKPiA+ICsKPiA+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIo
ZGV2LCAiZHJtIGRpc2FibGVcbiIpOwo+ID4gKwo+ID4gKwlpZiAoY3R4LT5wZGF0YS5wYW5lbCkg
ewo+ID4gKwkJcmV0ID0gZHJtX3BhbmVsX2Rpc2FibGUoY3R4LT5wZGF0YS5wYW5lbCk7Cj4gPiAr
CQlpZiAocmV0IDwgMCkKPiA+ICsJCQlEUk1fRVJST1IoImZhaWxlZCB0byBkaXNhYmxlIHBhbmVs
OiAlZC5cbiIsIHJldCk7Cj4gPiArCX0KPiA+ICsKPiA+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIo
ZGV2LCAiZHJtIGRpc2FibGVcbiIpOwo+ID4gKwltdXRleF9sb2NrKCZjdHgtPmxvY2spOwo+ID4g
Kwo+ID4gKwlhbng3NjI1X2RwX3N0b3AoY3R4KTsKPiA+ICsKPiA+ICsJYW54NzYyNV9sb3dfcG93
ZXJfbW9kZV9jaGVjayhjdHgsIDApOwo+ID4gKwo+ID4gKwltdXRleF91bmxvY2soJmN0eC0+bG9j
ayk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2JyaWRnZV9mdW5j
cyBhbng3NjI1X2JyaWRnZV9mdW5jcyA9IHsKPiA+ICsJLmF0dGFjaCA9IGFueDc2MjVfYnJpZGdl
X2F0dGFjaCwKPiA+ICsJLmRpc2FibGUgPSBhbng3NjI1X2JyaWRnZV9kaXNhYmxlLAo+ID4gKwku
cG9zdF9kaXNhYmxlID0gYW54NzYyNV9wb3N0X2Rpc2FibGUsCj4gPiArCS5wcmVfZW5hYmxlID0g
YW54NzYyNV9wcmVfZW5hYmxlLAo+ID4gKwkubW9kZV92YWxpZCA9IGFueDc2MjVfYnJpZGdlX21v
ZGVfdmFsaWQsCj4gPiArCS5tb2RlX3NldCA9IGFueDc2MjVfYnJpZGdlX21vZGVfc2V0LAo+ID4g
KwkuZW5hYmxlID0gYW54NzYyNV9icmlkZ2VfZW5hYmxlLAo+ID4gK307Cj4gPiArCj4gPiArc3Rh
dGljIGludCBhbng3NjI1X3JlZ2lzdGVyX2kyY19kdW1teV9jbGllbnRzKHN0cnVjdCBhbng3NjI1
X2RhdGEgKmN0eCwKPiA+ICsJCQkJCSAgICAgIHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQpCj4g
PiArewo+ID4gKwljdHgtPmkyYy50eF9wMF9jbGllbnQgPSBpMmNfbmV3X2R1bW15KGNsaWVudC0+
YWRhcHRlciwKPiA+ICsJCQkJCSAgICAgIFRYX1AwX0FERFIgPj4gMSk7Cj4gPiArCWN0eC0+aTJj
LnR4X3AxX2NsaWVudCA9IGkyY19uZXdfZHVtbXkoY2xpZW50LT5hZGFwdGVyLAo+ID4gKwkJCQkJ
ICAgICAgVFhfUDFfQUREUiA+PiAxKTsKPiA+ICsJY3R4LT5pMmMudHhfcDJfY2xpZW50ID0gaTJj
X25ld19kdW1teShjbGllbnQtPmFkYXB0ZXIsCj4gPiArCQkJCQkgICAgICBUWF9QMl9BRERSID4+
IDEpOwo+ID4gKwo+ID4gKwljdHgtPmkyYy5yeF9wMF9jbGllbnQgPSBpMmNfbmV3X2R1bW15KGNs
aWVudC0+YWRhcHRlciwKPiA+ICsJCQkJCSAgICAgIFJYX1AwX0FERFIgPj4gMSk7Cj4gPiArCWN0
eC0+aTJjLnJ4X3AxX2NsaWVudCA9IGkyY19uZXdfZHVtbXkoY2xpZW50LT5hZGFwdGVyLAo+ID4g
KwkJCQkJICAgICAgUlhfUDFfQUREUiA+PiAxKTsKPiA+ICsJY3R4LT5pMmMucnhfcDJfY2xpZW50
ID0gaTJjX25ld19kdW1teShjbGllbnQtPmFkYXB0ZXIsCj4gPiArCQkJCQkgICAgICBSWF9QMl9B
RERSID4+IDEpOwo+ID4gKwo+ID4gKwljdHgtPmkyYy50Y3BjX2NsaWVudCA9IGkyY19uZXdfZHVt
bXkoY2xpZW50LT5hZGFwdGVyLAo+ID4gKwkJCQkJICAgICBUQ1BDX0lOVEVSRkFDRV9BRERSID4+
IDEpOwo+ID4gKwo+ID4gKwlpZiAoKCFjdHgtPmkyYy50eF9wMF9jbGllbnQgfAo+ID4gKwkgICAg
ICFjdHgtPmkyYy50eF9wMV9jbGllbnQgfAo+ID4gKwkgICAgICFjdHgtPmkyYy50eF9wMl9jbGll
bnQgfAo+ID4gKwkgICAgICFjdHgtPmkyYy5yeF9wMF9jbGllbnQgfAo+ID4gKwkgICAgICFjdHgt
PmkyYy5yeF9wMV9jbGllbnQgfAo+ID4gKwkgICAgICFjdHgtPmkyYy5yeF9wMl9jbGllbnQgfAo+
ID4gKwkgICAgICFjdHgtPmkyYy50Y3BjX2NsaWVudCkgIT0gMCkKPiAKPiAhPSAwIGlzIGEgZG91
YmxlIG5lZ2F0aXZlLiAgT25seSAhPSAwIGFuZCA9PSAwIHdoZW4geW91IGFyZSB0YWxraW5nCj4g
bnVtYmVycyBvciBzdHJjbXAoKS4KPiAKPiAJaWYgKG5yID09IDApIHsKPiAJaWYgKHN0cmNtcChm
b28sIGJhcikgPT0gMCkgewo+IAo+IERvbid0IHVzZSBpdCBmb3IgcG9pbnRlcnMgb3IgZXJyb3Ig
Y29kZXMuICBUaGVyZSBpcyBubyByZWFzb24gdG8gZG8KPiBhIGJpdHdpc2UgT1IgaW5zdGVhZCBv
ZiBhIGxvZ2ljYWwgT1IgaGVyZS4gIEp1c3Qgc2F5Ogo+IAo+IAo+IAlpZiAoIWN0eC0+aTJjLnR4
X3AwX2NsaWVudCB8fAo+IAkgICAgIWN0eC0+aTJjLnR4X3AxX2NsaWVudCB8fAo+IAkgICAgIWN0
eC0+aTJjLnR4X3AyX2NsaWVudCB8fAo+IAkgICAgIWN0eC0+aTJjLnJ4X3AwX2NsaWVudCB8fAo+
IAkgICAgIWN0eC0+aTJjLnJ4X3AxX2NsaWVudCB8fAo+IAkgICAgIWN0eC0+aTJjLnJ4X3AyX2Ns
aWVudCB8fAo+IAkgICAgIWN0eC0+aTJjLnRjcGNfY2xpZW50KQo+IAkJcmV0dXJuIC1FSU87Cj4g
Cj4gSXQgd291bGRuJ3QgYmUgdGhhdCBoYXJkIHRvIHdyaXRlIHRoaXMgd2l0aG91dCB0aGUgbWVt
b3J5IGxlYWtzLCBidHcuCj4gSnVzdCB1c2UgIkZyZWUgdGhlIG1vc3QgcmVjZW50IGFsbG9jYXRp
b24iIHN0eWxlLgo+IAo+IAljdHgtPmkyYy50eF9wMF9jbGllbnQgPSBpMmNfbmV3X2R1bW15KGNs
aWVudC0+YWRhcHRlciwKPiAJCQkJCSAgICAgIFRYX1AwX0FERFIgPj4gMSk7Cj4gCWlmICghY3R4
LT5pMmMudHhfcDBfY2xpZW50KQo+IAkJcmV0dXJuIC1FTk9NRU07Cj4gCj4gCWN0eC0+aTJjLnR4
X3AxX2NsaWVudCA9IGkyY19uZXdfZHVtbXkoY2xpZW50LT5hZGFwdGVyLAo+IAkJCQkJICAgICAg
VFhfUDFfQUREUiA+PiAxKTsKPiAJaWYgKCFjdHgtPmkyYy50eF9wMV9jbGllbnQpCj4gCQlnb3Rv
IGZyZWVfdHhfcDA7Cj4gCj4gCWN0eC0+aTJjLnR4X3AyX2NsaWVudCA9IGkyY19uZXdfZHVtbXko
Y2xpZW50LT5hZGFwdGVyLAo+IAkJCQkJICAgICAgVFhfUDJfQUREUiA+PiAxKTsKPiAJaWYgKCFj
dHgtPmkyYy50eF9wMl9jbGllbnQpCj4gCQlnb3RvIGZyZWVfdHhfcDE7Cj4gCj4gCj4gCWN0eC0+
aTJjLnJ4X3AwX2NsaWVudCA9IGkyY19uZXdfZHVtbXkoY2xpZW50LT5hZGFwdGVyLAo+IAkJCQkJ
ICAgICAgUlhfUDBfQUREUiA+PiAxKTsKPiAJaWYgKCFjdHgtPmkyYy5yeF9wMF9jbGllbnQpCj4g
CQlnb3RvIGZyZWVfdHhfcDI7Cj4gCj4gCWN0eC0+aTJjLnJ4X3AxX2NsaWVudCA9IGkyY19uZXdf
ZHVtbXkoY2xpZW50LT5hZGFwdGVyLAo+IAkJCQkJICAgICAgUlhfUDFfQUREUiA+PiAxKTsKPiAJ
aWYgKCFjdHgtPmkyYy5yeF9wMV9jbGllbnQpCj4gCQlnb3RvIGZyZWVfcnhfcDA7Cj4gCj4gCWN0
eC0+aTJjLnJ4X3AyX2NsaWVudCA9IGkyY19uZXdfZHVtbXkoY2xpZW50LT5hZGFwdGVyLAo+IAkJ
CQkJICAgICAgUlhfUDJfQUREUiA+PiAxKTsKPiAJaWYgKCFjdHgtPmkyYy5yeF9wMl9jbGllbnQp
Cj4gCQlnb3RvIGZyZWVfcnhfcDE7Cj4gCj4gCj4gCWN0eC0+aTJjLnRjcGNfY2xpZW50ID0gaTJj
X25ld19kdW1teShjbGllbnQtPmFkYXB0ZXIsCj4gCQkJCQkgICAgIFRDUENfSU5URVJGQUNFX0FE
RFIgPj4gMSk7Cj4gCWlmICghY3R4LT5pMmMudGNwY19jbGllbnQpCj4gCQlnb3RvIGZyZWVfcnhf
cDI7Cj4gCj4gCXJldHVybiAwOwo+IAo+IGZyZWVfcnhfcDI6Cj4gCWkyY191bnJlZ2lzdGVyX2Rl
dmljZShjdHgtPmkyYy5yeF9wMl9jbGllbnQpOwo+IGZyZWVfcnhfcDE6Cj4gCWkyY191bnJlZ2lz
dGVyX2RldmljZShjdHgtPmkyYy5yeF9wMV9jbGllbnQpOwo+IGZyZWVfcnhfcDA6Cj4gCWkyY191
bnJlZ2lzdGVyX2RldmljZShjdHgtPmkyYy5yeF9wMF9jbGllbnQpOwo+IGZyZWVfdHhfcDI6Cj4g
CWkyY191bnJlZ2lzdGVyX2RldmljZShjdHgtPmkyYy50eF9wMl9jbGllbnQpOwo+IGZyZWVfdHhf
cDE6Cj4gCWkyY191bnJlZ2lzdGVyX2RldmljZShjdHgtPmkyYy50eF9wMV9jbGllbnQpOwo+IGZy
ZWVfdHhfcDA6Cj4gCWkyY191bnJlZ2lzdGVyX2RldmljZShjdHgtPmkyYy50eF9wMF9jbGllbnQp
Owo+IAo+IAlyZXR1cm4gLUVOT01FTTsKPiAKPiBJdCdzIGEgbGl0dGxlIGJpdCBleHRyYSB3b3Jr
LCBidXQgSSBoYXZlIGRvbmUgaXQgc28gSSBrbm93IGhvdyBoYXJkIGl0Cj4gaXMuICBBbHNvIG5v
dyBzdGF0aWMgYW5hbHlzaXMgdG9vbHMgd29uJ3QgY29tcGxhaW4gYWJvdXQgdGhlIGxlYWtzLgo+
IAo+IAo+ID4gKwkJcmV0dXJuIC1FSU87Cj4gPiArCj4gPiArCXJldHVybiAwOwo+ID4gK30KPiA+
ICsKPiA+ICtzdGF0aWMgdm9pZCBhbng3NjI1X3VucmVnaXN0ZXJfaTJjX2R1bW15X2NsaWVudHMo
c3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQo+ID4gK3sKPiA+ICsJaTJjX3VucmVnaXN0ZXJfZGV2
aWNlKGN0eC0+aTJjLnR4X3AwX2NsaWVudCk7Cj4gPiArCWkyY191bnJlZ2lzdGVyX2RldmljZShj
dHgtPmkyYy50eF9wMV9jbGllbnQpOwo+ID4gKwlpMmNfdW5yZWdpc3Rlcl9kZXZpY2UoY3R4LT5p
MmMudHhfcDJfY2xpZW50KTsKPiA+ICsJaTJjX3VucmVnaXN0ZXJfZGV2aWNlKGN0eC0+aTJjLnJ4
X3AxX2NsaWVudCk7Cj4gPiArCWkyY191bnJlZ2lzdGVyX2RldmljZShjdHgtPmkyYy5yeF9wMl9j
bGllbnQpOwo+ID4gKwlpMmNfdW5yZWdpc3Rlcl9kZXZpY2UoY3R4LT5pMmMucnhfcDNfY2xpZW50
KTsKPiAKPiBEZWxldGUgdGhlIGN0eC0+aTJjLnJ4X3AzX2NsaWVudCBiZWNhdXNlIGl0J3MgbmV2
ZXIgdXNlZC4KPiAKPiA+ICsJaTJjX3VucmVnaXN0ZXJfZGV2aWNlKGN0eC0+aTJjLnRjcGNfY2xp
ZW50KTsKPiAKPiAKPiBUaGUgb3RoZXIgYWR2YW50YWdlIG9mIHRoZSAiRnJlZSB0aGUgbGFzdCBy
ZXNvdXJjZSBzdHlsZSIgaXMgdGhhdCB5b3UKPiBjYW4ganVzdCBhZGQgYToKPiAKPiAJaTJjX3Vu
cmVnaXN0ZXJfZGV2aWNlKGN0eC0+aTJjLnRjcGNfY2xpZW50KTsKPiAKPiBhbmQgZGVsZXRlIHRo
ZSBlcnJvciBsYWJlbHMgYW5kIHlvdSBoYXZlIGFuCj4gYW54NzYyNV91bnJlZ2lzdGVyX2kyY19k
dW1teV9jbGllbnRzKCkgZnVuY3Rpb24uCj4gCj4gVGhlcmUgaXMgYW5vdGhlciBidWcgaGVyZSBi
ZWNhdXNlIHdlIGZvcmdvdCB0byBmcmVlICJpMmMucnhfcDBfY2xpZW50Ii4KPiAKPiA+ICt9Cj4g
PiArCj4gPiArc3RhdGljIGludCBhbng3NjI1X2kyY19wcm9iZShzdHJ1Y3QgaTJjX2NsaWVudCAq
Y2xpZW50LAo+ID4gKwkJCSAgICAgY29uc3Qgc3RydWN0IGkyY19kZXZpY2VfaWQgKmlkKQo+ID4g
K3sKPiA+ICsJc3RydWN0IGFueDc2MjVfZGF0YSAqcGxhdGZvcm07Cj4gPiArCXN0cnVjdCBhbng3
NjI1X3BsYXRmb3JtX2RhdGEgKnBkYXRhOwo+ID4gKwlpbnQgcmV0ID0gMDsKPiA+ICsJc3RydWN0
IGRldmljZSAqZGV2ID0gJmNsaWVudC0+ZGV2Owo+ID4gKwo+ID4gKwlpZiAoIWkyY19jaGVja19m
dW5jdGlvbmFsaXR5KGNsaWVudC0+YWRhcHRlciwKPiA+ICsJCQkJICAgICBJMkNfRlVOQ19TTUJV
U19JMkNfQkxPQ0spKSB7Cj4gPiArCQlEUk1fREVWX0VSUk9SKGRldiwgImFueDc2MjUncyBpMmMg
YnVzIGRvZXNuJ3Qgc3VwcG9ydFxuIik7Cj4gPiArCQlyZXQgPSAtRU5PREVWOwo+ID4gKwkJZ290
byBleGl0Owo+IAo+IFJldHVybiBkaXJlY3RseSwgcGxlYXNlLiAgImdvdG8gZXhpdCIgaXMgbGVz
cyByZWFkYWJsZSB0aGFuCj4gcmV0dXJuIC1FTk9ERVY7Cj4gCj4gPiArCX0KPiA+ICsKPiA+ICsJ
cGxhdGZvcm0gPSBremFsbG9jKHNpemVvZigqcGxhdGZvcm0pLCBHRlBfS0VSTkVMKTsKPiA+ICsJ
aWYgKCFwbGF0Zm9ybSkgewo+ID4gKwkJRFJNX0RFVl9FUlJPUihkZXYsICJmYWlsZWQgdG8gYWxs
b2NhdGUgZHJpdmVyIGRhdGFcbiIpOwo+ID4gKwkJcmV0ID0gLUVOT01FTTsKPiA+ICsJCWdvdG8g
ZXhpdDsKPiAKPiByZXR1cm4gLUVOT01FTTsKPiAKPiA+ICsJfQo+ID4gKwo+ID4gKwlwZGF0YSA9
ICZwbGF0Zm9ybS0+cGRhdGE7Cj4gPiArCj4gPiArCS8qIGRldmljZSB0cmVlIHBhcnNpbmcgZnVu
Y3Rpb24gY2FsbCAqLwo+ID4gKwlyZXQgPSBhbng3NjI1X3BhcnNlX2R0KCZjbGllbnQtPmRldiwg
cGRhdGEpOwo+ID4gKwlpZiAocmV0ICE9IDApCS8qIGlmIG9jY3VycyBlcnJvciAqLwo+ID4gKwkJ
Z290byBlcnIwOwo+IAo+ICE9IDAgaXMgZG91YmxlIG5lZ2F0aXZlLiAgQ2hvb3NlIGJldHRlciBs
YWJlbCBuYW1lcy4gIFJlbW92ZSB0aGUgb2J2aW91cwo+IGNvbW1lbnQuCj4gCj4gaWYgKHJldCkK
PiAJZ290byBmcmVlX3BsYXRmb3JtOwo+IAo+ID4gKwo+ID4gKwlhbng3NjI1X2luaXRfZ3Bpbyhw
bGF0Zm9ybSk7Cj4gPiArCj4gPiArCS8qIHRvIGFjY2VzcyBnbG9iYWwgcGxhdGZvcm0gZGF0YSAq
Lwo+ID4gKwlwbGF0Zm9ybS0+Y2xpZW50ID0gY2xpZW50Owo+ID4gKwlpMmNfc2V0X2NsaWVudGRh
dGEoY2xpZW50LCBwbGF0Zm9ybSk7Cj4gPiArCj4gPiArCWlmIChwbGF0Zm9ybS0+cGRhdGEuZXh0
Y29uX3N1cHBvcnRlZCkgewo+ID4gKwkJLyogZ2V0IGV4dGNvbiBkZXZpY2UgZnJvbSBEVFMgKi8K
PiA+ICsJCXBsYXRmb3JtLT5leHRjb24gPSBleHRjb25fZ2V0X2VkZXZfYnlfcGhhbmRsZSgmY2xp
ZW50LT5kZXYsIDApOwo+ID4gKwkJaWYgKFBUUl9FUlIocGxhdGZvcm0tPmV4dGNvbikgPT0gLUVQ
Uk9CRV9ERUZFUikKPiA+ICsJCQlnb3RvIGVycjA7Cj4gCj4gUHJlc2VydmUgdGhlIGVycm9yIGNv
ZGUuCj4gCj4gPiArCQlpZiAoSVNfRVJSKHBsYXRmb3JtLT5leHRjb24pKSB7Cj4gPiArCQkJRFJN
X0RFVl9FUlJPUigmY2xpZW50LT5kZXYsCj4gPiArCQkJCSAgICAgICJjYW4gbm90IGdldCBleHRj
b24gZGV2aWNlISIpOwo+ID4gKwkJCWdvdG8gZXJyMDsKPiAKPiBQcmVydmUgdGhlIGVycm9yIGNv
ZGUuCj4gCj4gPiArCQl9Cj4gPiArCj4gPiArCQlyZXQgPSBhbng3NjI1X2V4dGNvbl9ub3RpZmll
cl9pbml0KHBsYXRmb3JtKTsKPiA+ICsJCWlmIChyZXQgPCAwKQo+ID4gKwkJCWdvdG8gZXJyMDsK
PiA+ICsJfQo+ID4gKwo+ID4gKwlhdG9taWNfc2V0KCZwbGF0Zm9ybS0+cG93ZXJfc3RhdHVzLCAw
KTsKPiA+ICsKPiA+ICsJbXV0ZXhfaW5pdCgmcGxhdGZvcm0tPmxvY2spOwo+ID4gKwo+ID4gKwlp
ZiAocGxhdGZvcm0tPnBkYXRhLmdwaW9faW50cl9ocGQpIHsKPiA+ICsJCUlOSVRfV09SSygmcGxh
dGZvcm0tPndvcmssIGFueDc2MjVfd29ya19mdW5jKTsKPiA+ICsJCXBsYXRmb3JtLT53b3JrcXVl
dWUgPSBjcmVhdGVfd29ya3F1ZXVlKCJhbng3NjI1X3dvcmsiKTsKPiA+ICsJCWlmICghcGxhdGZv
cm0tPndvcmtxdWV1ZSkgewo+ID4gKwkJCURSTV9ERVZfRVJST1IoZGV2LCAiZmFpbGVkIHRvIGNy
ZWF0ZSB3b3JrIHF1ZXVlXG4iKTsKPiA+ICsJCQlyZXQgPSAtRU5PTUVNOwo+ID4gKwkJCWdvdG8g
ZXJyMTsKPiAKPiBUaGlzIGdvdG8gd2lsbCBjcmFzaC4gIEJlY2F1c2UgeW91IGhhdmUgZm9yZ290
dGVuIHdoYXQgdGhlIG1vc3QgcmVjZW50bHkKPiBhbGxvY2F0ZWQgcmVzb3VyY2Ugd2FzLiAgSXQg
c2hvdWxkIGJlICJnb3RvIGZyZWVfcGxhdGZvcm07IiBzdGlsbC4KPiAKPiA+ICsJCX0KPiA+ICsK
PiA+ICsJCXBsYXRmb3JtLT5wZGF0YS5ocGRfaXJxID0KPiA+ICsJCQlncGlvZF90b19pcnEocGxh
dGZvcm0tPnBkYXRhLmdwaW9faW50cl9ocGQpOwo+ID4gKwkJaWYgKHBsYXRmb3JtLT5wZGF0YS5o
cGRfaXJxIDwgMCkgewo+ID4gKwkJCURSTV9ERVZfRVJST1IoZGV2LCAiZmFpbGVkIHRvIGdldCBn
cGlvIGlycVxuIik7Cj4gPiArCQkJZ290byBlcnIxOwo+IAo+IGdvdG8gZnJlZV93cTsKPiAKPiA+
ICsJCX0KPiA+ICsKPiA+ICsJCXJldCA9IHJlcXVlc3RfdGhyZWFkZWRfaXJxKHBsYXRmb3JtLT5w
ZGF0YS5ocGRfaXJxLAo+ID4gKwkJCQkJICAgTlVMTCwgYW54NzYyNV9pbnRyX2hwZF9pc3IsCj4g
PiArCQkJCQkgICBJUlFGX1RSSUdHRVJfRkFMTElORyB8Cj4gPiArCQkJCQkgICBJUlFGX1RSSUdH
RVJfUklTSU5HIHwKPiA+ICsJCQkJCSAgIElSUUZfT05FU0hPVCwKPiA+ICsJCQkJCSAgICJhbng3
NjI1LWhwZCIsIHBsYXRmb3JtKTsKPiA+ICsJCWlmIChyZXQgPCAwKSB7Cj4gPiArCQkJRFJNX0RF
Vl9FUlJPUihkZXYsICJmYWlsZWQgdG8gcmVxdWVzdCBpcnFcbiIpOwo+ID4gKwkJCWdvdG8gZXJy
MTsKPiA+ICsJCX0KPiA+ICsKPiA+ICsJCXJldCA9IGlycV9zZXRfaXJxX3dha2UocGxhdGZvcm0t
PnBkYXRhLmhwZF9pcnEsIDEpOwo+ID4gKwkJaWYgKHJldCA8IDApIHsKPiA+ICsJCQlEUk1fREVW
X0VSUk9SKGRldiwgIlJlcXVlc3QgaXJxIGZvciBocGQiKTsKPiA+ICsJCQlEUk1fREVWX0VSUk9S
KGRldiwgImludGVycnVwdCB3YWtlIHNldCBmYWlsXG4iKTsKPiA+ICsJCQlnb3RvIGVycjE7Cj4g
PiArCQl9Cj4gPiArCj4gPiArCQlyZXQgPSBlbmFibGVfaXJxX3dha2UocGxhdGZvcm0tPnBkYXRh
LmhwZF9pcnEpOwo+ID4gKwkJaWYgKHJldCA8IDApIHsKPiA+ICsJCQlEUk1fREVWX0VSUk9SKGRl
diwgIkVuYWJsZSBpcnEgZm9yIEhQRCIpOwo+ID4gKwkJCURSTV9ERVZfRVJST1IoZGV2LCAiaW50
ZXJydXB0IHdha2UgZW5hYmxlIGZhaWxcbiIpOwo+ID4gKwkJCWdvdG8gZXJyMTsKPiA+ICsJCX0K
PiA+ICsJfQo+ID4gKwo+ID4gKwlpZiAoYW54NzYyNV9yZWdpc3Rlcl9pMmNfZHVtbXlfY2xpZW50
cyhwbGF0Zm9ybSwgY2xpZW50KSAhPSAwKSB7Cj4gCj4gUHJlc2VydmUgdGhlIGVycm9yIGNvZGUu
Cj4gCj4gCXJldCA9IGFueDc2MjVfcmVnaXN0ZXJfaTJjX2R1bW15X2NsaWVudHMoKTsKPiAJaWYg
KHJldCkKPiAJCWdvdG8gZnJlZV9wbGF0Zm9ybTsKPiAKPiBVZ2guLi4gIFRoZSBlcnIyIGlzIGEg
bGF5ZXJpbmcgdmlvbGF0aW9uLiAgRXZlcnkgZnVuY3Rpb24gc2hvdWxkIGZyZWUKPiBpdHMgb3du
IHBhcnRpYWxseSBhbGxvY2F0ZWQgbWVtb3J5LiAgSXQgc2hvdWxkIGVpdGhlciBzdWNjZWVkIG9y
IGZhaWwKPiBhbmQgaXQgc2hvdWxkbid0IGV4cGVjdCB0aGUgY2FsbGVyIHRvIGNsZWFuIHVwIHBh
cnRpYWxseSBhbGxvY2F0ZWQKPiByZXNvdXJjZXMgZm9yIGl0Lgo+IAo+IAo+ID4gKwkJcmV0ID0g
LUVOT01FTTsKPiA+ICsJCURSTV9FUlJPUigiRmFpbGVkIHRvIHJlc2VydmUgSTJDIGJ1cy5cbiIp
Owo+ID4gKwkJZ290byBlcnIyOwo+ID4gKwl9Cj4gPiArCj4gPiArCWlmIChwbGF0Zm9ybS0+cGRh
dGEubG93X3Bvd2VyX21vZGUgPT0gMCkgewo+ID4gKwkJYW54NzYyNV9kaXNhYmxlX3BkX3Byb3Rv
Y29sKHBsYXRmb3JtKTsKPiA+ICsJCWF0b21pY19zZXQoJnBsYXRmb3JtLT5wb3dlcl9zdGF0dXMs
IDEpOwo+ID4gKwl9Cj4gPiArCj4gPiArCS8qIGFkZCB3b3JrIGZ1bmN0aW9uICovCj4gPiArCWlm
IChwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19pbnRyX2hwZCkKPiA+ICsJCXF1ZXVlX3dvcmsocGxhdGZv
cm0tPndvcmtxdWV1ZSwgJnBsYXRmb3JtLT53b3JrKTsKPiA+ICsKPiA+ICsJcGxhdGZvcm0tPmJy
aWRnZS5mdW5jcyA9ICZhbng3NjI1X2JyaWRnZV9mdW5jczsKPiA+ICsjaWYgSVNfRU5BQkxFRChD
T05GSUdfT0YpCj4gPiArCXBsYXRmb3JtLT5icmlkZ2Uub2Zfbm9kZSA9IGNsaWVudC0+ZGV2Lm9m
X25vZGU7Cj4gPiArI2VuZGlmCj4gPiArCWRybV9icmlkZ2VfYWRkKCZwbGF0Zm9ybS0+YnJpZGdl
KTsKPiA+ICsKPiA+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAicHJvYmUgZG9uZVxuIik7
Cj4gPiArCWdvdG8gZXhpdDsKPiAKPiByZXR1cm4gMDsKPiAKPiA+ICsKPiA+ICtlcnIyOgo+ID4g
Kwlhbng3NjI1X3VucmVnaXN0ZXJfaTJjX2R1bW15X2NsaWVudHMocGxhdGZvcm0pOwo+ID4gK2Vy
cjE6Cj4gPiArCWlmIChwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19pbnRyX2hwZCkKPiA+ICsJCWRlc3Ry
b3lfd29ya3F1ZXVlKHBsYXRmb3JtLT53b3JrcXVldWUpOwo+ID4gK2VycjA6Cj4gPiArCWtmcmVl
KHBsYXRmb3JtKTsKPiA+ICtleGl0Ogo+ID4gKwlyZXR1cm4gcmV0Owo+ID4gK30KPiA+ICsKPiAK
PiByZWdhcmRzLAo+IGRhbiBjYXJwZW50ZXIKPiAKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlz
dHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4v
bGlzdGluZm8vZHJpLWRldmVs
