Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 0EC5261603
	for <lists+dri-devel@lfdr.de>; Sun,  7 Jul 2019 20:36:35 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D8C5089BD5;
	Sun,  7 Jul 2019 18:36:32 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from perceval.ideasonboard.com (perceval.ideasonboard.com
 [IPv6:2001:4b98:dc2:55:216:3eff:fef7:d647])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 163CC89BD5
 for <dri-devel@lists.freedesktop.org>; Sun,  7 Jul 2019 18:36:31 +0000 (UTC)
Received: from pendragon.nordic-sky.finnair.com (unknown [38.98.37.142])
 by perceval.ideasonboard.com (Postfix) with ESMTPSA id B8898CC;
 Sun,  7 Jul 2019 20:36:11 +0200 (CEST)
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 45/60] drm/omap: Remove HPD, detect and EDID omapdss operations
Date: Sun,  7 Jul 2019 21:19:22 +0300
Message-Id: <20190707181937.6250-42-laurent.pinchart@ideasonboard.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190707181937.6250-1-laurent.pinchart@ideasonboard.com>
References: <20190707180852.5512-1-laurent.pinchart@ideasonboard.com>
 <20190707181937.6250-1-laurent.pinchart@ideasonboard.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=ideasonboard.com; s=mail; t=1562524589;
 bh=1PQ7IP2pXzXCT1qlcllLfFTbE4URY7qPdchCSaiNX5c=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=XeDkcl2TLLQ49dWu1NToqP6yK98t9gi6VEszN/PORkY6U5st/PjT7gFqcrepG2/xQ
 7cv75qIdHpC11Uq8yebjqm5nZjr/SALxSxPKGPpm31/i1sE4pACSQku8e71Z4N9YTY
 FdK1LT5Soehj5VfVBgShlDF7o3/KMURHDcjU4idM=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Maxime Ripard <maxime.ripard@bootlin.com>,
 Sebastian Reichel <sebastian.reichel@collabora.com>,
 Tomi Valkeinen <tomi.valkeinen@ti.com>, Sean Paul <sean@poorly.run>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RHVlIHRvIHRoZSByZW1vdmFsIG9mIHNldmVyYWwgb21hcGRybSBkaXNwbGF5IGRyaXZlcnMsIHRo
ZSBvbWFwZHNzIEhQRCwKZGV0ZWN0ZWQgYW5kIEVESUQgb3BlcmF0aW9ucyBhcmUgbm90IHVzZWQg
YW55bW9yZS4gUmVtb3ZlIHRoZW0gYW5kIGFsbApyZWxhdGVkIGNvZGUuCgpTaWduZWQtb2ZmLWJ5
OiBMYXVyZW50IFBpbmNoYXJ0IDxsYXVyZW50LnBpbmNoYXJ0QGlkZWFzb25ib2FyZC5jb20+Ci0t
LQogZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vZHNzL2hkbWk0LmMgICAgICB8ICA1OSAtLS0tLS0t
CiBkcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3MvaGRtaTUuYyAgICAgIHwgIDQ0IC0tLS0tLQog
ZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vZHNzL29tYXBkc3MuaCAgICB8ICAyNSArLS0KIGRyaXZl
cnMvZ3B1L2RybS9vbWFwZHJtL29tYXBfY29ubmVjdG9yLmMgfCAxOTAgKysrLS0tLS0tLS0tLS0t
LS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL29tYXBfY29ubmVjdG9yLmggfCAgIDIg
LQogZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vb21hcF9kcnYuYyAgICAgICB8ICAgOCArLQogNiBm
aWxlcyBjaGFuZ2VkLCAyMiBpbnNlcnRpb25zKCspLCAzMDYgZGVsZXRpb25zKC0pCgpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vZHNzL2hkbWk0LmMgYi9kcml2ZXJzL2dwdS9k
cm0vb21hcGRybS9kc3MvaGRtaTQuYwppbmRleCBiNjVhZmE4YjkzYzYuLjJmZWFlOWJhMTcyOSAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vZHNzL2hkbWk0LmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL29tYXBkcm0vZHNzL2hkbWk0LmMKQEAgLTMzMSw0NSArMzMxLDYgQEAgc3Rh
dGljIHZvaWQgaGRtaV9kaXNjb25uZWN0KHN0cnVjdCBvbWFwX2Rzc19kZXZpY2UgKnNyYywKIAlv
bWFwZHNzX2RldmljZV9kaXNjb25uZWN0KGRzdCwgZHN0LT5uZXh0KTsKIH0KIAotc3RhdGljIHN0
cnVjdCBlZGlkICpoZG1pX3JlYWRfZWRpZF9kYXRhKHN0cnVjdCBvbWFwX2hkbWkgKmhkbWksCi0J
CQkJCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCi17Ci0JdTggKmVkaWQ7Ci0JaW50
IHI7Ci0KLQllZGlkID0ga3phbGxvYyg1MTIsIEdGUF9LRVJORUwpOwotCWlmICghZWRpZCkKLQkJ
cmV0dXJuIE5VTEw7Ci0KLQlyID0gaGRtaTRfY29yZV9kZGNfcmVhZCgmaGRtaS0+Y29yZSwgZWRp
ZCwgMCwgRURJRF9MRU5HVEgpOwotCWlmIChyKQotCQlnb3RvIGVycm9yOwotCi0JaWYgKGVkaWRb
MHg3ZV0gPiAwKSB7Ci0JCWNoYXIgY2hlY2tzdW0gPSAwOwotCQl1bnNpZ25lZCBpbnQgaTsKLQot
CQlyID0gaGRtaTRfY29yZV9kZGNfcmVhZCgmaGRtaS0+Y29yZSwgZWRpZCArIEVESURfTEVOR1RI
LCAxLAotCQkJCQlFRElEX0xFTkdUSCk7Ci0JCWlmIChyKQotCQkJZ290byBlcnJvcjsKLQotCQlm
b3IgKGkgPSAwOyBpIDwgRURJRF9MRU5HVEg7ICsraSkKLQkJCWNoZWNrc3VtICs9IGVkaWRbRURJ
RF9MRU5HVEggKyBpXTsKLQotCQlpZiAoY2hlY2tzdW0gIT0gMCkgewotCQkJRFNTRVJSKCJFLUVE
SUQgY2hlY2tzdW0gZmFpbGVkISFcbiIpOwotCQkJZ290byBlcnJvcjsKLQkJfQotCX0KLQotCXJl
dHVybiAoc3RydWN0IGVkaWQgKillZGlkOwotCi1lcnJvcjoKLQlrZnJlZShlZGlkKTsKLQlyZXR1
cm4gTlVMTDsKLX0KLQogc3RhdGljIHN0cnVjdCBlZGlkICoKIGhkbWlfZG9fcmVhZF9lZGlkKHN0
cnVjdCBvbWFwX2hkbWkgKmhkbWksCiAJCSAgc3RydWN0IGVkaWQgKigqcmVhZCkoc3RydWN0IG9t
YXBfaGRtaSAqaGRtaSwKQEAgLTQxOSwyOCArMzgwLDkgQEAgaGRtaV9kb19yZWFkX2VkaWQoc3Ry
dWN0IG9tYXBfaGRtaSAqaGRtaSwKIAlyZXR1cm4gZWRpZDsKIH0KIAotc3RhdGljIHN0cnVjdCBl
ZGlkICpoZG1pX3JlYWRfZWRpZChzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpkc3NkZXYpCi17Ci0J
cmV0dXJuIGhkbWlfZG9fcmVhZF9lZGlkKGRzc2Rldl90b19oZG1pKGRzc2RldiksIGhkbWlfcmVh
ZF9lZGlkX2RhdGEsCi0JCQkJIE5VTEwpOwotfQotCi1zdGF0aWMgdm9pZCBoZG1pX2xvc3RfaG90
cGx1ZyhzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpkc3NkZXYpCi17Ci0Jc3RydWN0IG9tYXBfaGRt
aSAqaGRtaSA9IGRzc2Rldl90b19oZG1pKGRzc2Rldik7Ci0KLQloZG1pNF9jZWNfc2V0X3BoeXNf
YWRkcigmaGRtaS0+Y29yZSwgQ0VDX1BIWVNfQUREUl9JTlZBTElEKTsKLX0KLQogc3RhdGljIGNv
bnN0IHN0cnVjdCBvbWFwX2Rzc19kZXZpY2Vfb3BzIGhkbWlfb3BzID0gewogCS5jb25uZWN0CQk9
IGhkbWlfY29ubmVjdCwKIAkuZGlzY29ubmVjdAkJPSBoZG1pX2Rpc2Nvbm5lY3QsCi0KLQkucmVh
ZF9lZGlkCQk9IGhkbWlfcmVhZF9lZGlkLAotCi0JLmhkbWkgPSB7Ci0JCS5sb3N0X2hvdHBsdWcJ
CT0gaGRtaV9sb3N0X2hvdHBsdWcsCi0JfSwKIH07CiAKIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
CkBAIC04MDUsNyArNzQ3LDYgQEAgc3RhdGljIGludCBoZG1pNF9pbml0X291dHB1dChzdHJ1Y3Qg
b21hcF9oZG1pICpoZG1pKQogCW91dC0+b3BzID0gJmhkbWlfb3BzOwogCW91dC0+b3duZXIgPSBU
SElTX01PRFVMRTsKIAlvdXQtPm9mX3BvcnQgPSAwOwotCW91dC0+b3BzX2ZsYWdzID0gT01BUF9E
U1NfREVWSUNFX09QX0VESUQ7CiAKIAlyID0gb21hcGRzc19kZXZpY2VfaW5pdF9vdXRwdXQob3V0
LCAmaGRtaS0+YnJpZGdlKTsKIAlpZiAociA8IDApCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vb21hcGRybS9kc3MvaGRtaTUuYyBiL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL2Rzcy9oZG1p
NS5jCmluZGV4IGZkMzg2ZTE4OWFiNC4uMDUwMmU2OTJkNjQ2IDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vb21hcGRybS9kc3MvaGRtaTUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vb21hcGRy
bS9kc3MvaGRtaTUuYwpAQCAtMzI5LDQxICszMjksNiBAQCBzdGF0aWMgdm9pZCBoZG1pX2Rpc2Nv
bm5lY3Qoc3RydWN0IG9tYXBfZHNzX2RldmljZSAqc3JjLAogCW9tYXBkc3NfZGV2aWNlX2Rpc2Nv
bm5lY3QoZHN0LCBkc3QtPm5leHQpOwogfQogCi1zdGF0aWMgc3RydWN0IGVkaWQgKmhkbWlfcmVh
ZF9lZGlkX2RhdGEoc3RydWN0IG9tYXBfaGRtaSAqaGRtaSwKLQkJCQkJc3RydWN0IGRybV9jb25u
ZWN0b3IgKmNvbm5lY3RvcikKLXsKLQlzdHJ1Y3QgaGRtaV9jb3JlX2RhdGEgKmNvcmUgPSAmaGRt
aS0+Y29yZTsKLQlpbnQgbWF4X2V4dF9ibG9ja3MgPSAzOwotCWludCByLCBuLCBpOwotCXU4ICpl
ZGlkOwotCi0JZWRpZCA9IGt6YWxsb2MoNTEyLCBHRlBfS0VSTkVMKTsKLQlpZiAoIWVkaWQpCi0J
CXJldHVybiBOVUxMOwotCi0JciA9IGhkbWk1X2NvcmVfZGRjX3JlYWQoY29yZSwgZWRpZCwgMCwg
RURJRF9MRU5HVEgpOwotCWlmIChyKQotCQlnb3RvIGVycm9yOwotCi0JbiA9IGVkaWRbMHg3ZV07
Ci0KLQlpZiAobiA+IG1heF9leHRfYmxvY2tzKQotCQluID0gbWF4X2V4dF9ibG9ja3M7Ci0KLQlm
b3IgKGkgPSAxOyBpIDw9IG47IGkrKykgewotCQlyID0gaGRtaTVfY29yZV9kZGNfcmVhZChjb3Jl
LCBlZGlkICsgaSAqIEVESURfTEVOR1RILCBpLAotCQkJCQlFRElEX0xFTkdUSCk7Ci0JCWlmIChy
KQotCQkJZ290byBlcnJvcjsKLQl9Ci0KLQlyZXR1cm4gKHN0cnVjdCBlZGlkICopZWRpZDsKLQot
ZXJyb3I6Ci0Ja2ZyZWUoZWRpZCk7Ci0JcmV0dXJuIE5VTEw7Ci19Ci0KIHN0YXRpYyBzdHJ1Y3Qg
ZWRpZCAqCiBoZG1pX2RvX3JlYWRfZWRpZChzdHJ1Y3Qgb21hcF9oZG1pICpoZG1pLAogCQkgIHN0
cnVjdCBlZGlkICooKnJlYWQpKHN0cnVjdCBvbWFwX2hkbWkgKmhkbWksCkBAIC00MDgsMTcgKzM3
Myw5IEBAIGhkbWlfZG9fcmVhZF9lZGlkKHN0cnVjdCBvbWFwX2hkbWkgKmhkbWksCiAJcmV0dXJu
IChzdHJ1Y3QgZWRpZCAqKWVkaWQ7CiB9CiAKLXN0YXRpYyBzdHJ1Y3QgZWRpZCAqaGRtaV9yZWFk
X2VkaWQoc3RydWN0IG9tYXBfZHNzX2RldmljZSAqZHNzZGV2KQotewotCXJldHVybiBoZG1pX2Rv
X3JlYWRfZWRpZChkc3NkZXZfdG9faGRtaShkc3NkZXYpLCBoZG1pX3JlYWRfZWRpZF9kYXRhLAot
CQkJCSBOVUxMKTsKLX0KLQogc3RhdGljIGNvbnN0IHN0cnVjdCBvbWFwX2Rzc19kZXZpY2Vfb3Bz
IGhkbWlfb3BzID0gewogCS5jb25uZWN0CQk9IGhkbWlfY29ubmVjdCwKIAkuZGlzY29ubmVjdAkJ
PSBoZG1pX2Rpc2Nvbm5lY3QsCi0KLQkucmVhZF9lZGlkCQk9IGhkbWlfcmVhZF9lZGlkLAogfTsK
IAogLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KQEAgLTc2Niw3ICs3MjMsNiBAQCBzdGF0aWMgaW50
IGhkbWk1X2luaXRfb3V0cHV0KHN0cnVjdCBvbWFwX2hkbWkgKmhkbWkpCiAJb3V0LT5vcHMgPSAm
aGRtaV9vcHM7CiAJb3V0LT5vd25lciA9IFRISVNfTU9EVUxFOwogCW91dC0+b2ZfcG9ydCA9IDA7
Ci0Jb3V0LT5vcHNfZmxhZ3MgPSBPTUFQX0RTU19ERVZJQ0VfT1BfRURJRDsKIAogCXIgPSBvbWFw
ZHNzX2RldmljZV9pbml0X291dHB1dChvdXQsICZoZG1pLT5icmlkZ2UpOwogCWlmIChyIDwgMCkK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL2Rzcy9vbWFwZHNzLmggYi9kcml2
ZXJzL2dwdS9kcm0vb21hcGRybS9kc3Mvb21hcGRzcy5oCmluZGV4IDVlMGExNDZiMmYzNi4uMjRi
NDIxZjY3NDA2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3Mvb21hcGRz
cy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL2Rzcy9vbWFwZHNzLmgKQEAgLTI5Niwx
MCArMjk2LDYgQEAgc3RydWN0IG9tYXBfZHNzX3dyaXRlYmFja19pbmZvIHsKIAl1OCBwcmVfbXVs
dF9hbHBoYTsKIH07CiAKLXN0cnVjdCBvbWFwZHNzX2hkbWlfb3BzIHsKLQl2b2lkICgqbG9zdF9o
b3RwbHVnKShzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpkc3NkZXYpOwotfTsKLQogc3RydWN0IG9t
YXBkc3NfZHNpX29wcyB7CiAJdm9pZCAoKmRpc2FibGUpKHN0cnVjdCBvbWFwX2Rzc19kZXZpY2Ug
KmRzc2RldiwgYm9vbCBkaXNjb25uZWN0X2xhbmVzLAogCQkJYm9vbCBlbnRlcl91bHBzKTsKQEAg
LTM2NywzNiArMzYzLDE3IEBAIHN0cnVjdCBvbWFwX2Rzc19kZXZpY2Vfb3BzIHsKIAl2b2lkICgq
c2V0X3RpbWluZ3MpKHN0cnVjdCBvbWFwX2Rzc19kZXZpY2UgKmRzc2RldiwKIAkJCSAgICBjb25z
dCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSk7CiAKLQlib29sICgqZGV0ZWN0KShzdHJ1
Y3Qgb21hcF9kc3NfZGV2aWNlICpkc3NkZXYpOwotCi0Jdm9pZCAoKnJlZ2lzdGVyX2hwZF9jYiko
c3RydWN0IG9tYXBfZHNzX2RldmljZSAqZHNzZGV2LAotCQkJCXZvaWQgKCpjYikodm9pZCAqY2Jf
ZGF0YSwKLQkJCQkJICBlbnVtIGRybV9jb25uZWN0b3Jfc3RhdHVzIHN0YXR1cyksCi0JCQkJdm9p
ZCAqY2JfZGF0YSk7Ci0Jdm9pZCAoKnVucmVnaXN0ZXJfaHBkX2NiKShzdHJ1Y3Qgb21hcF9kc3Nf
ZGV2aWNlICpkc3NkZXYpOwotCi0Jc3RydWN0IGVkaWQgKigqcmVhZF9lZGlkKShzdHJ1Y3Qgb21h
cF9kc3NfZGV2aWNlICpkc3NkZXYpOwotCiAJaW50ICgqZ2V0X21vZGVzKShzdHJ1Y3Qgb21hcF9k
c3NfZGV2aWNlICpkc3NkZXYsCiAJCQkgc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3Rvcik7
CiAKLQl1bmlvbiB7Ci0JCWNvbnN0IHN0cnVjdCBvbWFwZHNzX2hkbWlfb3BzIGhkbWk7Ci0JCWNv
bnN0IHN0cnVjdCBvbWFwZHNzX2RzaV9vcHMgZHNpOwotCX07CisJY29uc3Qgc3RydWN0IG9tYXBk
c3NfZHNpX29wcyBkc2k7CiB9OwogCiAvKioKICAqIGVudW0gb21hcF9kc3NfZGV2aWNlX29wc19m
bGFnIC0gSW5kaWNhdGVzIHdoaWNoIGRldmljZSBvcHMgYXJlIHN1cHBvcnRlZAotICogQE9NQVBf
RFNTX0RFVklDRV9PUF9ERVRFQ1Q6IFRoZSBkZXZpY2Ugc3VwcG9ydHMgb3V0cHV0IGNvbm5lY3Rp
b24gZGV0ZWN0aW9uCi0gKiBAT01BUF9EU1NfREVWSUNFX09QX0hQRDogVGhlIGRldmljZSBzdXBw
b3J0cyBhbGwgaG90LXBsdWctcmVsYXRlZCBvcGVyYXRpb25zCi0gKiBAT01BUF9EU1NfREVWSUNF
X09QX0VESUQ6IFRoZSBkZXZpY2Ugc3VwcG9ydHMgcmVhZGluZyBFRElECiAgKiBAT01BUF9EU1Nf
REVWSUNFX09QX01PREVTOiBUaGUgZGV2aWNlIHN1cHBvcnRzIHJlYWRpbmcgbW9kZXMKICAqLwog
ZW51bSBvbWFwX2Rzc19kZXZpY2Vfb3BzX2ZsYWcgewotCU9NQVBfRFNTX0RFVklDRV9PUF9ERVRF
Q1QgPSBCSVQoMCksCi0JT01BUF9EU1NfREVWSUNFX09QX0hQRCA9IEJJVCgxKSwKLQlPTUFQX0RT
U19ERVZJQ0VfT1BfRURJRCA9IEJJVCgyKSwKIAlPTUFQX0RTU19ERVZJQ0VfT1BfTU9ERVMgPSBC
SVQoMyksCiB9OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9vbWFwX2Nv
bm5lY3Rvci5jIGIvZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vb21hcF9jb25uZWN0b3IuYwppbmRl
eCBmOGIyZTYzZDllNzQuLjRiOGE5OWJlMjA4NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L29tYXBkcm0vb21hcF9jb25uZWN0b3IuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9v
bWFwX2Nvbm5lY3Rvci5jCkBAIC0zMCwxMTEgKzMwLDIyIEBACiBzdHJ1Y3Qgb21hcF9jb25uZWN0
b3IgewogCXN0cnVjdCBkcm1fY29ubmVjdG9yIGJhc2U7CiAJc3RydWN0IG9tYXBfZHNzX2Rldmlj
ZSAqb3V0cHV0OwotCXN0cnVjdCBvbWFwX2Rzc19kZXZpY2UgKmhwZDsKIH07CiAKLXN0YXRpYyB2
b2lkIG9tYXBfY29ubmVjdG9yX2hwZF9ub3RpZnkoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5l
Y3RvciwKLQkJCQkgICAgICBlbnVtIGRybV9jb25uZWN0b3Jfc3RhdHVzIHN0YXR1cykKLXsKLQlz
dHJ1Y3Qgb21hcF9jb25uZWN0b3IgKm9tYXBfY29ubmVjdG9yID0gdG9fb21hcF9jb25uZWN0b3Io
Y29ubmVjdG9yKTsKLQlzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpkc3NkZXY7Ci0KLQlpZiAoc3Rh
dHVzICE9IGNvbm5lY3Rvcl9zdGF0dXNfZGlzY29ubmVjdGVkKQotCQlyZXR1cm47Ci0KLQkvKgot
CSAqIE5vdGlmeSBhbGwgZGV2aWNzIGluIHRoZSBwaXBlbGluZSBvZiBkaXNjb25uZWN0aW9uLiBU
aGlzIGlzIHJlcXVpcmVkCi0JICogdG8gbGV0IHRoZSBIRE1JIGVuY29kZXJzIHJlc2V0IHRoZWly
IGludGVybmFsIHN0YXRlIHJlbGF0ZWQgdG8KLQkgKiBjb25uZWN0aW9uIHN0YXR1cywgc3VjaCBh
cyB0aGUgQ0VDIGFkZHJlc3MuCi0JICovCi0JZm9yIChkc3NkZXYgPSBvbWFwX2Nvbm5lY3Rvci0+
b3V0cHV0OyBkc3NkZXY7IGRzc2RldiA9IGRzc2Rldi0+bmV4dCkgewotCQlpZiAoZHNzZGV2LT5v
cHMgJiYgZHNzZGV2LT5vcHMtPmhkbWkubG9zdF9ob3RwbHVnKQotCQkJZHNzZGV2LT5vcHMtPmhk
bWkubG9zdF9ob3RwbHVnKGRzc2Rldik7Ci0JfQotfQotCi1zdGF0aWMgdm9pZCBvbWFwX2Nvbm5l
Y3Rvcl9ocGRfY2Iodm9pZCAqY2JfZGF0YSwKLQkJCQkgIGVudW0gZHJtX2Nvbm5lY3Rvcl9zdGF0
dXMgc3RhdHVzKQotewotCXN0cnVjdCBvbWFwX2Nvbm5lY3RvciAqb21hcF9jb25uZWN0b3IgPSBj
Yl9kYXRhOwotCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IgPSAmb21hcF9jb25uZWN0
b3ItPmJhc2U7Ci0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNvbm5lY3Rvci0+ZGV2OwotCWVu
dW0gZHJtX2Nvbm5lY3Rvcl9zdGF0dXMgb2xkX3N0YXR1czsKLQotCW11dGV4X2xvY2soJmRldi0+
bW9kZV9jb25maWcubXV0ZXgpOwotCW9sZF9zdGF0dXMgPSBjb25uZWN0b3ItPnN0YXR1czsKLQlj
b25uZWN0b3ItPnN0YXR1cyA9IHN0YXR1czsKLQltdXRleF91bmxvY2soJmRldi0+bW9kZV9jb25m
aWcubXV0ZXgpOwotCi0JaWYgKG9sZF9zdGF0dXMgPT0gc3RhdHVzKQotCQlyZXR1cm47Ci0KLQlv
bWFwX2Nvbm5lY3Rvcl9ocGRfbm90aWZ5KGNvbm5lY3Rvciwgc3RhdHVzKTsKLQotCWRybV9rbXNf
aGVscGVyX2hvdHBsdWdfZXZlbnQoZGV2KTsKLX0KLQotdm9pZCBvbWFwX2Nvbm5lY3Rvcl9lbmFi
bGVfaHBkKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCi17Ci0Jc3RydWN0IG9tYXBf
Y29ubmVjdG9yICpvbWFwX2Nvbm5lY3RvciA9IHRvX29tYXBfY29ubmVjdG9yKGNvbm5lY3Rvcik7
Ci0Jc3RydWN0IG9tYXBfZHNzX2RldmljZSAqaHBkID0gb21hcF9jb25uZWN0b3ItPmhwZDsKLQot
CWlmIChocGQpCi0JCWhwZC0+b3BzLT5yZWdpc3Rlcl9ocGRfY2IoaHBkLCBvbWFwX2Nvbm5lY3Rv
cl9ocGRfY2IsCi0JCQkJCSAgb21hcF9jb25uZWN0b3IpOwotfQotCi12b2lkIG9tYXBfY29ubmVj
dG9yX2Rpc2FibGVfaHBkKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCi17Ci0Jc3Ry
dWN0IG9tYXBfY29ubmVjdG9yICpvbWFwX2Nvbm5lY3RvciA9IHRvX29tYXBfY29ubmVjdG9yKGNv
bm5lY3Rvcik7Ci0Jc3RydWN0IG9tYXBfZHNzX2RldmljZSAqaHBkID0gb21hcF9jb25uZWN0b3It
PmhwZDsKLQotCWlmIChocGQpCi0JCWhwZC0+b3BzLT51bnJlZ2lzdGVyX2hwZF9jYihocGQpOwot
fQotCi1zdGF0aWMgc3RydWN0IG9tYXBfZHNzX2RldmljZSAqCi1vbWFwX2Nvbm5lY3Rvcl9maW5k
X2RldmljZShzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAotCQkJICAgZW51bSBvbWFw
X2Rzc19kZXZpY2Vfb3BzX2ZsYWcgb3ApCi17Ci0Jc3RydWN0IG9tYXBfY29ubmVjdG9yICpvbWFw
X2Nvbm5lY3RvciA9IHRvX29tYXBfY29ubmVjdG9yKGNvbm5lY3Rvcik7Ci0Jc3RydWN0IG9tYXBf
ZHNzX2RldmljZSAqZHNzZGV2ID0gTlVMTDsKLQlzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpkOwot
Ci0JZm9yIChkID0gb21hcF9jb25uZWN0b3ItPm91dHB1dDsgZDsgZCA9IGQtPm5leHQpIHsKLQkJ
aWYgKGQtPm9wc19mbGFncyAmIG9wKQotCQkJZHNzZGV2ID0gZDsKLQl9Ci0KLQlyZXR1cm4gZHNz
ZGV2OwotfQotCiBzdGF0aWMgZW51bSBkcm1fY29ubmVjdG9yX3N0YXR1cyBvbWFwX2Nvbm5lY3Rv
cl9kZXRlY3QoCiAJCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsIGJvb2wgZm9yY2Up
CiB7Ci0Jc3RydWN0IG9tYXBfZHNzX2RldmljZSAqZHNzZGV2OwogCWVudW0gZHJtX2Nvbm5lY3Rv
cl9zdGF0dXMgc3RhdHVzOwogCi0JZHNzZGV2ID0gb21hcF9jb25uZWN0b3JfZmluZF9kZXZpY2Uo
Y29ubmVjdG9yLAotCQkJCQkgICAgT01BUF9EU1NfREVWSUNFX09QX0RFVEVDVCk7Ci0KLQlpZiAo
ZHNzZGV2KSB7Ci0JCXN0YXR1cyA9IGRzc2Rldi0+b3BzLT5kZXRlY3QoZHNzZGV2KQotCQkgICAg
ICAgPyBjb25uZWN0b3Jfc3RhdHVzX2Nvbm5lY3RlZAotCQkgICAgICAgOiBjb25uZWN0b3Jfc3Rh
dHVzX2Rpc2Nvbm5lY3RlZDsKLQotCQlvbWFwX2Nvbm5lY3Rvcl9ocGRfbm90aWZ5KGNvbm5lY3Rv
ciwgc3RhdHVzKTsKLQl9IGVsc2UgewotCQlzd2l0Y2ggKGNvbm5lY3Rvci0+Y29ubmVjdG9yX3R5
cGUpIHsKLQkJY2FzZSBEUk1fTU9ERV9DT05ORUNUT1JfRFBJOgotCQljYXNlIERSTV9NT0RFX0NP
Tk5FQ1RPUl9MVkRTOgotCQljYXNlIERSTV9NT0RFX0NPTk5FQ1RPUl9EU0k6Ci0JCQlzdGF0dXMg
PSBjb25uZWN0b3Jfc3RhdHVzX2Nvbm5lY3RlZDsKLQkJCWJyZWFrOwotCQlkZWZhdWx0OgotCQkJ
c3RhdHVzID0gY29ubmVjdG9yX3N0YXR1c191bmtub3duOwotCQkJYnJlYWs7Ci0JCX0KKwlzd2l0
Y2ggKGNvbm5lY3Rvci0+Y29ubmVjdG9yX3R5cGUpIHsKKwljYXNlIERSTV9NT0RFX0NPTk5FQ1RP
Ul9EUEk6CisJY2FzZSBEUk1fTU9ERV9DT05ORUNUT1JfTFZEUzoKKwljYXNlIERSTV9NT0RFX0NP
Tk5FQ1RPUl9EU0k6CisJCXN0YXR1cyA9IGNvbm5lY3Rvcl9zdGF0dXNfY29ubmVjdGVkOworCQli
cmVhazsKKwlkZWZhdWx0OgorCQlzdGF0dXMgPSBjb25uZWN0b3Jfc3RhdHVzX3Vua25vd247CisJ
CWJyZWFrOwogCX0KIAogCVZFUkIoIiVzOiAlZCAoZm9yY2U9JWQpIiwgY29ubmVjdG9yLT5uYW1l
LCBzdGF0dXMsIGZvcmNlKTsKQEAgLTE0OCwxNCArNTksNiBAQCBzdGF0aWMgdm9pZCBvbWFwX2Nv
bm5lY3Rvcl9kZXN0cm95KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCiAKIAlEQkco
IiVzIiwgY29ubmVjdG9yLT5uYW1lKTsKIAotCWlmIChvbWFwX2Nvbm5lY3Rvci0+aHBkKSB7Ci0J
CXN0cnVjdCBvbWFwX2Rzc19kZXZpY2UgKmhwZCA9IG9tYXBfY29ubmVjdG9yLT5ocGQ7Ci0KLQkJ
aHBkLT5vcHMtPnVucmVnaXN0ZXJfaHBkX2NiKGhwZCk7Ci0JCW9tYXBkc3NfZGV2aWNlX3B1dCho
cGQpOwotCQlvbWFwX2Nvbm5lY3Rvci0+aHBkID0gTlVMTDsKLQl9Ci0KIAlkcm1fY29ubmVjdG9y
X3VucmVnaXN0ZXIoY29ubmVjdG9yKTsKIAlkcm1fY29ubmVjdG9yX2NsZWFudXAoY29ubmVjdG9y
KTsKIApAQCAtMTY0LDYzICs2NywyNyBAQCBzdGF0aWMgdm9pZCBvbWFwX2Nvbm5lY3Rvcl9kZXN0
cm95KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCiAJa2ZyZWUob21hcF9jb25uZWN0
b3IpOwogfQogCi1zdGF0aWMgaW50IG9tYXBfY29ubmVjdG9yX2dldF9tb2Rlc19lZGlkKHN0cnVj
dCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCi0JCQkJCSBzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNl
ICpkc3NkZXYpCi17Ci0JZW51bSBkcm1fY29ubmVjdG9yX3N0YXR1cyBzdGF0dXM7Ci0Jc3RydWN0
IGVkaWQgKmVkaWQ7Ci0JaW50IG47Ci0KLQlzdGF0dXMgPSBvbWFwX2Nvbm5lY3Rvcl9kZXRlY3Qo
Y29ubmVjdG9yLCBmYWxzZSk7Ci0JaWYgKHN0YXR1cyAhPSBjb25uZWN0b3Jfc3RhdHVzX2Nvbm5l
Y3RlZCkKLQkJZ290byBub19lZGlkOwotCi0JZWRpZCA9IGRzc2Rldi0+b3BzLT5yZWFkX2VkaWQo
ZHNzZGV2KTsKLQlpZiAoIWVkaWQgfHwgIWRybV9lZGlkX2lzX3ZhbGlkKGVkaWQpKSB7Ci0JCWtm
cmVlKGVkaWQpOwotCQlnb3RvIG5vX2VkaWQ7Ci0JfQotCi0JZHJtX2Nvbm5lY3Rvcl91cGRhdGVf
ZWRpZF9wcm9wZXJ0eShjb25uZWN0b3IsIGVkaWQpOwotCW4gPSBkcm1fYWRkX2VkaWRfbW9kZXMo
Y29ubmVjdG9yLCBlZGlkKTsKLQotCWtmcmVlKGVkaWQpOwotCXJldHVybiBuOwotCi1ub19lZGlk
OgotCWRybV9jb25uZWN0b3JfdXBkYXRlX2VkaWRfcHJvcGVydHkoY29ubmVjdG9yLCBOVUxMKTsK
LQlyZXR1cm4gMDsKLX0KLQogc3RhdGljIGludCBvbWFwX2Nvbm5lY3Rvcl9nZXRfbW9kZXMoc3Ry
dWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKIHsKLQlzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNl
ICpkc3NkZXY7CisJc3RydWN0IG9tYXBfY29ubmVjdG9yICpvbWFwX2Nvbm5lY3RvciA9IHRvX29t
YXBfY29ubmVjdG9yKGNvbm5lY3Rvcik7CisJc3RydWN0IG9tYXBfZHNzX2RldmljZSAqZHNzZGV2
ID0gTlVMTDsKKwlzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpkOwogCiAJREJHKCIlcyIsIGNvbm5l
Y3Rvci0+bmFtZSk7CiAKIAkvKgotCSAqIElmIGRpc3BsYXkgZXhwb3NlcyBFRElELCB0aGVuIHdl
IHBhcnNlIHRoYXQgaW4gdGhlIG5vcm1hbCB3YXkgdG8KLQkgKiBidWlsZCB0YWJsZSBvZiBzdXBw
b3J0ZWQgbW9kZXMuCisJICogSWYgdGhlIGRpc3BsYXkgcGlwZWxpbmUgcmVwb3J0cyBtb2RlcyAo
ZS5nLiB3aXRoIGEgZml4ZWQgcmVzb2x1dGlvbgorCSAqIHBhbmVsIG9yIGFuIGFuYWxvZyBUViBv
dXRwdXQpLCBxdWVyeSBpdC4KIAkgKi8KLQlkc3NkZXYgPSBvbWFwX2Nvbm5lY3Rvcl9maW5kX2Rl
dmljZShjb25uZWN0b3IsCi0JCQkJCSAgICBPTUFQX0RTU19ERVZJQ0VfT1BfRURJRCk7Ci0JaWYg
KGRzc2RldikKLQkJcmV0dXJuIG9tYXBfY29ubmVjdG9yX2dldF9tb2Rlc19lZGlkKGNvbm5lY3Rv
ciwgZHNzZGV2KTsKKwlmb3IgKGQgPSBvbWFwX2Nvbm5lY3Rvci0+b3V0cHV0OyBkOyBkID0gZC0+
bmV4dCkgeworCQlpZiAoZC0+b3BzX2ZsYWdzICYgT01BUF9EU1NfREVWSUNFX09QX01PREVTKQor
CQkJZHNzZGV2ID0gZDsKKwl9CiAKLQkvKgotCSAqIE90aGVyd2lzZSBpZiB0aGUgZGlzcGxheSBw
aXBlbGluZSByZXBvcnRzIG1vZGVzIChlLmcuIHdpdGggYSBmaXhlZAotCSAqIHJlc29sdXRpb24g
cGFuZWwgb3IgYW4gYW5hbG9nIFRWIG91dHB1dCksIHF1ZXJ5IGl0LgotCSAqLwotCWRzc2RldiA9
IG9tYXBfY29ubmVjdG9yX2ZpbmRfZGV2aWNlKGNvbm5lY3RvciwKLQkJCQkJICAgIE9NQVBfRFNT
X0RFVklDRV9PUF9NT0RFUyk7CiAJaWYgKGRzc2RldikKIAkJcmV0dXJuIGRzc2Rldi0+b3BzLT5n
ZXRfbW9kZXMoZHNzZGV2LCBjb25uZWN0b3IpOwogCi0JLyoKLQkgKiBXZSBjYW4ndCByZXRyaWV2
ZSBtb2Rlcywgd2hpY2ggY2FuIGhhcHBlbiBmb3IgaW5zdGFuY2UgZm9yIGEgRFZJIG9yCi0JICog
VkdBIG91dHB1dCB3aXRoIHRoZSBEREMgYnVzIHVuY29ubmVjdGVkLiBUaGUgS01TIGNvcmUgd2ls
bCBhZGQgdGhlCi0JICogZGVmYXVsdCBtb2Rlcy4KLQkgKi8KKwkvKiBXZSBjYW4ndCByZXRyaWV2
ZSBtb2Rlcy4gVGhlIEtNUyBjb3JlIHdpbGwgYWRkIHRoZSBkZWZhdWx0IG1vZGVzLiAqLwogCXJl
dHVybiAwOwogfQogCkBAIC0zMDEsNyArMTY4LDYgQEAgc3RydWN0IGRybV9jb25uZWN0b3IgKm9t
YXBfY29ubmVjdG9yX2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKIHsKIAlzdHJ1Y3QgZHJt
X2Nvbm5lY3RvciAqY29ubmVjdG9yID0gTlVMTDsKIAlzdHJ1Y3Qgb21hcF9jb25uZWN0b3IgKm9t
YXBfY29ubmVjdG9yOwotCXN0cnVjdCBvbWFwX2Rzc19kZXZpY2UgKmRzc2RldjsKIAogCURCRygi
JXMiLCBvdXRwdXQtPm5hbWUpOwogCkBAIC0zMTksMjQgKzE4NSw2IEBAIHN0cnVjdCBkcm1fY29u
bmVjdG9yICpvbWFwX2Nvbm5lY3Rvcl9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJCQkg
ICBvbWFwX2Nvbm5lY3Rvcl9nZXRfdHlwZShvdXRwdXQpKTsKIAlkcm1fY29ubmVjdG9yX2hlbHBl
cl9hZGQoY29ubmVjdG9yLCAmb21hcF9jb25uZWN0b3JfaGVscGVyX2Z1bmNzKTsKIAotCS8qCi0J
ICogSW5pdGlhbGl6ZSBjb25uZWN0b3Igc3RhdHVzIGhhbmRsaW5nLiBGaXJzdCB0cnkgdG8gZmlu
ZCBhIGRldmljZSB0aGF0Ci0JICogc3VwcG9ydHMgaG90LXBsdWcgcmVwb3J0aW5nLiBJZiBpdCBm
YWlscywgZmFsbCBiYWNrIHRvIGEgZGV2aWNlIHRoYXQKLQkgKiBzdXBwb3J0IHBvbGxpbmcuIElm
IHRoYXQgZmFpbHMgdG9vLCB3ZSBkb24ndCBzdXBwb3J0IGhvdC1wbHVnCi0JICogZGV0ZWN0aW9u
IGF0IGFsbC4KLQkgKi8KLQlkc3NkZXYgPSBvbWFwX2Nvbm5lY3Rvcl9maW5kX2RldmljZShjb25u
ZWN0b3IsIE9NQVBfRFNTX0RFVklDRV9PUF9IUEQpOwotCWlmIChkc3NkZXYpIHsKLQkJb21hcF9j
b25uZWN0b3ItPmhwZCA9IG9tYXBkc3NfZGV2aWNlX2dldChkc3NkZXYpOwotCQljb25uZWN0b3It
PnBvbGxlZCA9IERSTV9DT05ORUNUT1JfUE9MTF9IUEQ7Ci0JfSBlbHNlIHsKLQkJZHNzZGV2ID0g
b21hcF9jb25uZWN0b3JfZmluZF9kZXZpY2UoY29ubmVjdG9yLAotCQkJCQkJICAgIE9NQVBfRFNT
X0RFVklDRV9PUF9ERVRFQ1QpOwotCQlpZiAoZHNzZGV2KQotCQkJY29ubmVjdG9yLT5wb2xsZWQg
PSBEUk1fQ09OTkVDVE9SX1BPTExfQ09OTkVDVCB8Ci0JCQkJCSAgICBEUk1fQ09OTkVDVE9SX1BP
TExfRElTQ09OTkVDVDsKLQl9Ci0KIAlyZXR1cm4gY29ubmVjdG9yOwogCiBmYWlsOgpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vb21hcF9jb25uZWN0b3IuaCBiL2RyaXZlcnMv
Z3B1L2RybS9vbWFwZHJtL29tYXBfY29ubmVjdG9yLmgKaW5kZXggYTIzYjNhODA2NTdiLi40ODdi
ODY1M2UwMGMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL29tYXBfY29ubmVj
dG9yLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vb21hcF9jb25uZWN0b3IuaApAQCAt
MzIsOCArMzIsNiBAQCBzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlOwogc3RydWN0IGRybV9jb25uZWN0
b3IgKm9tYXBfY29ubmVjdG9yX2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKIAkJCQkJICBz
dHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpvdXRwdXQsCiAJCQkJCSAgc3RydWN0IGRybV9lbmNvZGVy
ICplbmNvZGVyKTsKLXZvaWQgb21hcF9jb25uZWN0b3JfZW5hYmxlX2hwZChzdHJ1Y3QgZHJtX2Nv
bm5lY3RvciAqY29ubmVjdG9yKTsKLXZvaWQgb21hcF9jb25uZWN0b3JfZGlzYWJsZV9ocGQoc3Ry
dWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3Rvcik7CiBlbnVtIGRybV9tb2RlX3N0YXR1cyBvbWFw
X2Nvbm5lY3Rvcl9tb2RlX2ZpeHVwKHN0cnVjdCBvbWFwX2Rzc19kZXZpY2UgKmRzc2RldiwKIAkJ
CQkJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUsCiAJCQkJCXN0cnVjdCBkcm1f
ZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9vbWFwZHJtL29tYXBfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9vbWFwX2Rydi5j
CmluZGV4IDg4ZjkzMjhlZGE3Mi4uODlhMzYzM2I5N2FkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vb21hcGRybS9vbWFwX2Rydi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL29t
YXBfZHJ2LmMKQEAgLTQzNCw5ICs0MzQsNyBAQCBzdGF0aWMgdm9pZCBvbWFwX21vZGVzZXRfZW5h
YmxlX2V4dGVybmFsX2hwZChzdHJ1Y3QgZHJtX2RldmljZSAqZGRldikKIAkJaWYgKCFjb25uZWN0
b3IpCiAJCQljb250aW51ZTsKIAotCQlpZiAocHJpdi0+cGlwZXNbaV0ub3V0cHV0LT5uZXh0KQot
CQkJb21hcF9jb25uZWN0b3JfZW5hYmxlX2hwZChjb25uZWN0b3IpOwotCQllbHNlCisJCWlmIChw
cml2LT5waXBlc1tpXS5vdXRwdXQtPmJyaWRnZSkKIAkJCWRybV9icmlkZ2VfY29ubmVjdG9yX2Vu
YWJsZV9ocGQoY29ubmVjdG9yKTsKIAl9CiB9CkBAIC00NTUsOSArNDUzLDcgQEAgc3RhdGljIHZv
aWQgb21hcF9tb2Rlc2V0X2Rpc2FibGVfZXh0ZXJuYWxfaHBkKHN0cnVjdCBkcm1fZGV2aWNlICpk
ZGV2KQogCQlpZiAoIWNvbm5lY3RvcikKIAkJCWNvbnRpbnVlOwogCi0JCWlmIChwcml2LT5waXBl
c1tpXS5vdXRwdXQtPm5leHQpCi0JCQlvbWFwX2Nvbm5lY3Rvcl9kaXNhYmxlX2hwZChjb25uZWN0
b3IpOwotCQllbHNlCisJCWlmIChwcml2LT5waXBlc1tpXS5vdXRwdXQtPmJyaWRnZSkKIAkJCWRy
bV9icmlkZ2VfY29ubmVjdG9yX2Rpc2FibGVfaHBkKGNvbm5lY3Rvcik7CiAJfQogfQotLSAKUmVn
YXJkcywKCkxhdXJlbnQgUGluY2hhcnQKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZy
ZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3Rp
bmZvL2RyaS1kZXZlbA==
