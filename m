Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id D7AD8D0D61E
	for <lists+dri-devel@lfdr.de>; Sat, 10 Jan 2026 13:45:19 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CD9F210E02F;
	Sat, 10 Jan 2026 12:45:05 +0000 (UTC)
Authentication-Results: gabe.freedesktop.org;
	dkim=fail reason="key not found in DNS" (0-bit key; unprotected) header.d=stu.xidian.edu.cn header.i=@stu.xidian.edu.cn header.b="41qcudr4";
	dkim-atps=neutral
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from zg8tmtyylji0my4xnjqumte4.icoremail.net
 (zg8tmtyylji0my4xnjqumte4.icoremail.net [162.243.164.118])
 by gabe.freedesktop.org (Postfix) with ESMTP id 470F110E00C
 for <dri-devel@lists.freedesktop.org>; Sat, 10 Jan 2026 11:25:14 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=stu.xidian.edu.cn; s=dkim; h=Received:Date:From:To:Cc:Subject:
 Content-Type:MIME-Version:Message-ID; bh=t2c6XHiKEcwMM6TNEH4spRO
 VjhmhjDvfAm5OXRtPEcc=; b=41qcudr4sRlxOc6Cv7P90t/xEFmFeKEtxcq/4Ta
 sR1zCSiMG3ljxFTj+GfIsEDui4sbEOihRR/ksMXkgu/vYi5hn9VVmkgo6JLeTXub
 HJDFwFdN0WgxB4jR8hTWPHAK+GU/qce3N/UvNR9tuPe4JAhT3tVKhvuzyRTwgNbO
 5m6g=
Received: from wangzhi_xd$stu.xidian.edu.cn ( [113.200.174.49] ) by
 ajax-webmail-hzbj-edu-front-4.icoremail.net (Coremail) ; Sat, 10 Jan 2026
 19:25:04 +0800 (GMT+08:00)
X-Originating-IP: [113.200.174.49]
Date: Sat, 10 Jan 2026 19:25:04 +0800 (GMT+08:00)
X-CM-HeaderCharset: UTF-8
From: =?UTF-8?B?546L5b+X?= <wangzhi_xd@stu.xidian.edu.cn>
To: "Maarten Lankhorst" <maarten.lankhorst@linux.intel.com>,
 "Maxime Ripard" <mripard@kernel.org>,
 "Thomas Zimmermann" <tzimmermann@suse.de>
Cc: dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org
Subject: [BUG] WARNING in drm_gem_object_handle_put_unlocked during
 drm_release on Linux 6.18
X-Priority: 3
X-Mailer: Coremail Webmail Server Version 2024.3-cmXT6 build
 20250410(2f5ccd7f) Copyright (c) 2002-2026 www.mailtech.cn
 mispb-8dfce572-2f24-404d-b59d-0dd2e304114c-icoremail.cn
Content-Type: multipart/mixed; 
 boundary="----=_Part_169223_1754403738.1768044304827"
MIME-Version: 1.0
Message-ID: <40d309e5.ba84.19ba7a719d3.Coremail.wangzhi_xd@stu.xidian.edu.cn>
X-Coremail-Locale: zh_CN
X-CM-TRANSID: BrQMCkBmzeARN2JpIQwDAQ--.16689W
X-CM-SenderInfo: qstqimqsqqliuu6v33wo0lvxldqovvfxof0/1tbiAgUJCGlhD89fy
	wAAsa
X-Coremail-Antispam: 1Ur529EdanIXcx71UUUUU7IcSsGvfJ3iIAIbVAYjsxI4VWxJw
 CS07vEb4IE77IF4wCS07vE1I0E4x80FVAKz4kxMIAIbVAFxVCaYxvI4VCIwcAKzIAtYxBI
 daVFxhVjvjDU=
X-Mailman-Approved-At: Sat, 10 Jan 2026 12:45:04 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

------=_Part_169223_1754403738.1768044304827
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: base64

RGVhciBNYWludGFpbmVycywKV2hlbiB1c2luZyBvdXIgY3VzdG9taXplZCBTeXprYWxsZXIgdG8g
ZnV6eiB0aGUgbGF0ZXN0IExpbnV4IGtlcm5lbCwgdGhlIGZvbGxvd2luZyBjcmFzaCB3YXMgdHJp
Z2dlcmVkLgpIRUFEIGNvbW1pdDo3ZDBhNjZlNGJiOTA4MWQ3NWM4MmVjNDk1N2M1MDAzNGNiMGVh
NDQ5CmdpdCB0cmVlOiB1cHN0cmVhbQpPdXRwdXQ6aHR0cHM6Ly9naXRodWIuY29tL21hbnVhbDAv
Y3Jhc2gvYmxvYi9tYWluL3JlcG9ydDEudHh0Cktlcm5lbCBjb25maWc6IGh0dHBzOi8vZ2l0aHVi
LmNvbS9tYW51YWwwL2NyYXNoL2Jsb2IvbWFpbi9jb25maWcudHh0CkMgcmVwcm9kdWNlcjpodHRw
czovL2dpdGh1Yi5jb20vbWFudWFsMC9jcmFzaC9ibG9iL21haW4vcmVwcm8xLmMKCmRybV9nZW1f
b2JqZWN0X2hhbmRsZV9wdXRfdW5sb2NrZWQgd2l0aGluIGRyaXZlcnMvZ3B1L2RybS9kcm1fZ2Vt
LmMgd2hpY2ggd2FzIGlkZW50aWZpZWQgZHVyaW5nIGZ1enppbmcgb24gYSBMaW51eCA2LjE4IGtl
cm5lbC4gVGhpcyB3YXJuaW5nIGluZGljYXRlcyBhIHJlZmVyZW5jZSBjb3VudGluZyBpbmNvbnNp
c3RlbmN5IHdoZW4gcmVsZWFzaW5nIGEgR0VNIG9iamVjdCBoYW5kbGUgZHVyaW5nIHRoZSBwcm9j
ZXNzIGV4aXQgcGF0aC5UaGUgaXNzdWUgY29uc2lzdGVudGx5IG9jY3VycyBkdXJpbmcgdGhlIHJl
c291cmNlIGNsZWFudXAgc2VxdWVuY2Ugd2hlcmUgZHJtX3JlbGVhc2UgY2FsbHMgZHJtX2ZpbGVf
ZnJlZSBhbmQgc3Vic2VxdWVudGx5IGRybV9nZW1fcmVsZWFzZSwgd2hpY2ggdGhlbiBpdGVyYXRl
cyB0aHJvdWdoIEdFTSBoYW5kbGVzIHZpYSBpZHJfZm9yX2VhY2guIFdlIG5vdGljZWQgdGhhdCBz
eXpib3QgaGFzIHByZXZpb3VzbHkgcmVwb3J0ZWQgYSBzaW1pbGFyIHdhcm5pbmcgaW4gZHJtX2dl
bV9vYmplY3RfaGFuZGxlX3B1dF91bmxvY2tlZCB1bmRlciBleHRpZCBlZjMyNTZhMzYwYzAyMjA3
YTRjYiwgYnV0IG91ciBmaW5kaW5nIGlzIGRpc3RpbmN0IGJlY2F1c2UgdGhlIHN5emJvdCByZXBv
cnQgaXMgdHJpZ2dlcmVkIGR1cmluZyB0aGUgY3JlYXRpb24gcGF0aCB2aWEgZHJtX21vZGVfY3Jl
YXRlX2R1bWJfaW9jdGwgd2hlcmVhcyBvdXIgdHJhY2UgcHJvdmVzIHRoZSBpc3N1ZSBwZXJzaXN0
cyBpbiB0aGUgY2xlYW51cCBwYXRoIGV2ZW4gb24gdGhlIG5ld2VyIDYuMTguMCB1cHN0cmVhbSB0
cmVlLiBXZSBoYXZlIHNlYXJjaGVkIGZvciBleGlzdGluZyBwYXRjaGVzIGJ1dCBmb3VuZCBub25l
IHRoYXQgYWRkcmVzcyB0aGlzIHNwZWNpZmljIHJlbGVhc2Utc2lkZSBpbmNvbnNpc3RlbmN5LiBU
aGlzIGJ1ZyB3YXMgcmVwcm9kdWNlZCBpbiBhIHNwZWNpYWxpemVkIGVudmlyb25tZW50IHVzaW5n
IGEgY3VzdG9tLW1vZGVsZWQgZGV2aWNlIGFkZGVkIHRvIFFFTVUgdG8gc2ltdWxhdGUgc3BlY2lm
aWMgaGFyZHdhcmUtZHJpdmVyIGludGVyYWN0aW9ucy4gVG8gYXNzaXN0IGluIHlvdXIgYW5hbHlz
aXMsIHdlIGhhdmUgcHJvdmlkZWQgb3VyIFFFTVUgZGV2aWNlIG1vZGVsaW5nIGZpbGUgaW4gdGhl
IGFwcGVuZGl4IGFzIHRoZSBidWcgbWF5IG5vdCBiZSB0cmlnZ2VyYWJsZSBvbiBzdGFuZGFyZCBl
bXVsYXRlZCBoYXJkd2FyZS4gCgpJZiB5b3UgZml4IHRoaXMgaXNzdWUsIHBsZWFzZSBhZGQgdGhl
IGZvbGxvd2luZyB0YWcgdG8gdGhlIGNvbW1pdDoKUmVwb3J0ZWQtYnk6IFpoaSBXYW5nIDx3YW5n
emhpQHN0dS54aWRpYW4uZWR1LmNuPiwgQmluIFl1PGJ5dUB4aWRpYW4uZWR1LmNuPiwgTWluZ1l1
IFdhbmc8dzE1MzAzNzQ2MDYyQDE2My5jb20+LCBXZW5KaWFuIEx1PDE5ODYxNzAyNjc4QDE2My5j
b20+LCBLZUZlbmcgR2FvPDI0MDE1NTMwNjRAcXEuY29tPiwgdGhhbmsgeW91IQoKV0FSTklORzog
Q1BVOiAxIFBJRDogMTA4ODA2IGF0IGRyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtLmM6MzAwIGRybV9n
ZW1fb2JqZWN0X2hhbmRsZV9wdXRfdW5sb2NrZWQrMHgzMGUvMHgzZTAKTW9kdWxlcyBsaW5rZWQg
aW46CkNQVTogMSBVSUQ6IDAgUElEOiAxMDg4MDYgQ29tbTogc3l6LjEuMzE5NzggTm90IHRhaW50
ZWQgNi4xOC4wICMxIFBSRUVNUFQoZnVsbCkgCkhhcmR3YXJlIG5hbWU6IFFFTVUgU3RhbmRhcmQg
UEMgKGk0NDBGWCArIFBJSVgsIDE5OTYpLCBCSU9TIHJlbC0xLjE2LjMtMC1nYTZlZDZiNzAxZjBh
LXByZWJ1aWx0LnFlbXUub3JnIDA0LzAxLzIwMTQKUklQOiAwMDEwOmRybV9nZW1fb2JqZWN0X2hh
bmRsZV9wdXRfdW5sb2NrZWQrMHgzMGUvMHgzZTAKQ29kZTogZWQgNzQgNjEgZTggNzQgYTggODQg
ZmMgNGMgODkgZTcgZTggMmMgOWUgOTQgMDAgNDggYzcgYzEgNjAgMDkgZWEgOGIgNGMgODkgZWEg
NDggYzcgYzcgNDAgMDUgZWEgOGIgNDggODkgYzYgZTggZTMgM2IgNDQgZmMgOTAgPDBmPiAwYiA5
MCA5MCA1YiA1ZCA0MSA1YyA0MSA1ZCA0MSA1ZSA0MSA1ZiBlOSAzZiBhOCA4NCBmYyA0YyA4OSBm
ZgpSU1A6IDAwMTg6ZmZmZmM5MDAwMmQyN2I4MCBFRkxBR1M6IDAwMDEwMjg2ClJBWDogMDAwMDAw
MDAwMDAwMDAwMCBSQlg6IGZmZmY4ODgxMWFjMGZiZTAgUkNYOiBmZmZmZmZmZjgxNzllZDA5ClJE
WDogZmZmZjg4ODEyNGEyYmEwMCBSU0k6IGZmZmZmZmZmODE3OWVkMTYgUkRJOiAwMDAwMDAwMDAw
MDAwMDAxClJCUDogZmZmZjg4ODEwN2RmMTAwMCBSMDg6IDAwMDAwMDAwMDAwMDAwMDEgUjA5OiBm
ZmZmZWQxMDI2YmM0ODQxClIxMDogMDAwMDAwMDAwMDAwMDAwMSBSMTE6IDAwMDAwMDAwMDAxMzlm
YzAgUjEyOiBmZmZmODg4MTAwMWVjMGM4ClIxMzogZmZmZjg4ODAxYzcxYmQ2MCBSMTQ6IDAwMDAw
MDAwMDAwMDAwMDAgUjE1OiBmZmZmODg4MTA3ZGYxMDA0CkZTOiAgMDAwMDU1NTU3Y2VkMTUwMCgw
MDAwKSBHUzpmZmZmODg4MWEyNjAxMDAwKDAwMDApIGtubEdTOjAwMDAwMDAwMDAwMDAwMDAKQ1M6
ICAwMDEwIERTOiAwMDAwIEVTOiAwMDAwIENSMDogMDAwMDAwMDA4MDA1MDAzMwpDUjI6IDAwMDA3
ZmZlNTY0NmZmMDAgQ1IzOiAwMDAwMDAwMTJmYmEyMDAwIENSNDogMDAwMDAwMDAwMDAwMDZmMApD
YWxsIFRyYWNlOgogPFRBU0s+CiBkcm1fZ2VtX29iamVjdF9yZWxlYXNlX2hhbmRsZSsweGM3LzB4
MjAwCiBpZHJfZm9yX2VhY2grMHgxMTkvMHgyMzAgaG9tZS93bXkvRnV6emVyL3RoaXJkX3Rvb2wv
bGludXgtNi4xOC9saWIvaWRyLmM6MjA4CiBkcm1fZ2VtX3JlbGVhc2UrMHgyOS8weDQwCiBkcm1f
ZmlsZV9mcmVlLnBhcnQuMCsweDcyNC8weGNmMAogZHJtX2Nsb3NlX2hlbHBlci5pc3JhLjArMHgx
ODMvMHgxZjAKIGRybV9yZWxlYXNlKzB4MWFiLzB4MzYwCiBfX2ZwdXQrMHg0MDIvMHhiNTAgaG9t
ZS93bXkvRnV6emVyL3RoaXJkX3Rvb2wvbGludXgtNi4xOC9mcy9maWxlX3RhYmxlLmM6NDY4CiB0
YXNrX3dvcmtfcnVuKzB4MTZiLzB4MjYwIGhvbWUvd215L0Z1enplci90aGlyZF90b29sL2xpbnV4
LTYuMTgva2VybmVsL3Rhc2tfd29yay5jOjIyNwogZXhpdF90b191c2VyX21vZGVfbG9vcCsweGY5
LzB4MTMwCiBkb19zeXNjYWxsXzY0KzB4NDI0LzB4ZmEwIGhvbWUvd215L0Z1enplci90aGlyZF90
b29sL2xpbnV4LTYuMTgvYXJjaC94ODYvZW50cnkvc3lzY2FsbF8zMi5jOjMwOAogZW50cnlfU1lT
Q0FMTF82NF9hZnRlcl9od2ZyYW1lKzB4NzcvMHg3ZgpSSVA6IDAwMzM6MHg3ZjVmOWQzYjA1OWQK
Q29kZTogMDIgYjggZmYgZmYgZmYgZmYgYzMgNjYgMGYgMWYgNDQgMDAgMDAgZjMgMGYgMWUgZmEg
NDggODkgZjggNDggODkgZjcgNDggODkgZDYgNDggODkgY2EgNGQgODkgYzIgNGQgODkgYzggNGMg
OGIgNGMgMjQgMDggMGYgMDUgPDQ4PiAzZCAwMSBmMCBmZiBmZiA3MyAwMSBjMyA0OCBjNyBjMSBh
OCBmZiBmZiBmZiBmNyBkOCA2NCA4OSAwMSA0OApSU1A6IDAwMmI6MDAwMDdmZmViODVmYzZkOCBF
RkxBR1M6IDAwMDAwMjQ2IE9SSUdfUkFYOiAwMDAwMDAwMDAwMDAwMWI0ClJBWDogMDAwMDAwMDAw
MDAwMDAwMCBSQlg6IDAwMDA3ZjVmOWQ2MjdkYTAgUkNYOiAwMDAwN2Y1ZjlkM2IwNTlkClJEWDog
MDAwMDAwMDAwMDAwMDAwMCBSU0k6IDAwMDAwMDAwMDAwMDAwMWUgUkRJOiAwMDAwMDAwMDAwMDAw
MDAzClJCUDogMDAwMDdmZmViODVmYzc3OCBSMDg6IDAwMDAwMDFiMzI5MjAxNmEgUjA5OiAwMDAw
MDAwMDAwMDAwMDAwClIxMDogMDAwMDAwMWIzMmQyMDAwMCBSMTE6IDAwMDAwMDAwMDAwMDAyNDYg
UjEyOiBmZmZmZmZmZmZmZmZmZmZmClIxMzogMDAwMDdmNWY5ZDYyNjA5YyBSMTQ6IDAwMDA3ZjVm
OWQ2MjdkYTAgUjE1OiAwMDAwN2ZmZWI4NWZjN2EwCiA8L1RBU0s+CgpUaGFua3MsClpoaSBXYW5n
Cg==
------=_Part_169223_1754403738.1768044304827
Content-Type: text/plain; name=bochs_drm_pci.c
Content-Transfer-Encoding: base64
Content-Disposition: attachment; filename="bochs_drm_pci.c"

LyoKICogUUVNVSBCb2NocyBEUk0tY29tcGF0aWJsZSBQQ0kgZGV2aWNlCiAqCiAqIEltcGxlbWVu
dHMgdGhlIG1pbmltYWwgQm9jaHMvUUVNVSBzdGR2Z2EgImRpc3BpIiBpbnRlcmZhY2UgYW5kIE1N
SU8KICogbGF5b3V0IG5lZWRlZCBieSB0aGUgTGludXggZHJpdmVycy9ncHUvZHJtL3RpbnkvYm9j
aHMuYyBkcml2ZXIuCiAqCiAqIFRhcmdldCBRRU1VOiA4LjIuMTAKICovCgojaW5jbHVkZSAicWVt
dS9vc2RlcC5oIgojaW5jbHVkZSA8aW50dHlwZXMuaD4KI2luY2x1ZGUgPHN0cmluZy5oPgojaW5j
bHVkZSAicWVtdS9tb2R1bGUuaCIKI2luY2x1ZGUgInFlbXUvbG9nLmgiCiNpbmNsdWRlICJxYXBp
L2Vycm9yLmgiCiNpbmNsdWRlICJleGVjL21lbW9yeS5oIgojaW5jbHVkZSAic3lzZW11L2RtYS5o
IgojaW5jbHVkZSAiaHcvaXJxLmgiCiNpbmNsdWRlICJody9wY2kvcGNpLmgiCiNpbmNsdWRlICJo
dy9wY2kvbXNpLmgiCiNpbmNsdWRlICJody9wY2kvbXNpeC5oIgojaW5jbHVkZSAiaHcvcGNpL3Bj
aWUuaCIKI2luY2x1ZGUgInFvbS9vYmplY3QuaCIKI2luY2x1ZGUgInFhcGkvdmlzaXRvci5oIgoj
aW5jbHVkZSAiaHcvcWRldi1wcm9wZXJ0aWVzLmgiCgojZGVmaW5lIFRZUEVfUENJQkFTRV9ERVZJ
Q0UgImJvY2hzX2RybV9wY2kiCnR5cGVkZWYgc3RydWN0IFBDSUJhc2VTdGF0ZSBQQ0lCYXNlU3Rh
dGU7Ck9CSkVDVF9ERUNMQVJFX1NJTVBMRV9UWVBFKFBDSUJhc2VTdGF0ZSwgUENJQkFTRV9ERVZJ
Q0UpCgojZGVmaW5lIFZCRV9ESVNQSV9JTkRFWF9JRCAgICAgICAgICAgICAgIDB4MAojZGVmaW5l
IFZCRV9ESVNQSV9JTkRFWF9YUkVTICAgICAgICAgICAgIDB4MQojZGVmaW5lIFZCRV9ESVNQSV9J
TkRFWF9ZUkVTICAgICAgICAgICAgIDB4MgojZGVmaW5lIFZCRV9ESVNQSV9JTkRFWF9CUFAgICAg
ICAgICAgICAgIDB4MwojZGVmaW5lIFZCRV9ESVNQSV9JTkRFWF9FTkFCTEUgICAgICAgICAgIDB4
NAojZGVmaW5lIFZCRV9ESVNQSV9JTkRFWF9CQU5LICAgICAgICAgICAgIDB4NQojZGVmaW5lIFZC
RV9ESVNQSV9JTkRFWF9WSVJUX1dJRFRIICAgICAgIDB4NgojZGVmaW5lIFZCRV9ESVNQSV9JTkRF
WF9WSVJUX0hFSUdIVCAgICAgIDB4NwojZGVmaW5lIFZCRV9ESVNQSV9JTkRFWF9YX09GRlNFVCAg
ICAgICAgIDB4OAojZGVmaW5lIFZCRV9ESVNQSV9JTkRFWF9ZX09GRlNFVCAgICAgICAgIDB4OQoj
ZGVmaW5lIFZCRV9ESVNQSV9JTkRFWF9WSURFT19NRU1PUllfNjRLIDB4YQojZGVmaW5lIFZCRV9E
SVNQSV9JRDAgICAgICAgICAgICAgICAgICAgIDB4QjBDMAojZGVmaW5lIFZCRV9ESVNQSV9JRDEg
ICAgICAgICAgICAgICAgICAgIDB4QjBDMQojZGVmaW5lIFZCRV9ESVNQSV9JRDIgICAgICAgICAg
ICAgICAgICAgIDB4QjBDMgojZGVmaW5lIFZCRV9ESVNQSV9JRDMgICAgICAgICAgICAgICAgICAg
IDB4QjBDMwojZGVmaW5lIFZCRV9ESVNQSV9JRDQgICAgICAgICAgICAgICAgICAgIDB4QjBDNAoj
ZGVmaW5lIFZCRV9ESVNQSV9JRDUgICAgICAgICAgICAgICAgICAgIDB4QjBDNQojZGVmaW5lIFZC
RV9ESVNQSV9ESVNBQkxFRCAgICAgICAgICAgICAgIDB4MDAKI2RlZmluZSBWQkVfRElTUElfRU5B
QkxFRCAgICAgICAgICAgICAgICAweDAxCiNkZWZpbmUgVkJFX0RJU1BJX0dFVENBUFMgICAgICAg
ICAgICAgICAgMHgwMgojZGVmaW5lIFZCRV9ESVNQSV84QklUX0RBQyAgICAgICAgICAgICAgIDB4
MjAKI2RlZmluZSBWQkVfRElTUElfTEZCX0VOQUJMRUQgICAgICAgICAgICAweDQwCiNkZWZpbmUg
VkJFX0RJU1BJX05PQ0xFQVJNRU0gICAgICAgICAgICAgMHg4MAojZGVmaW5lIFZCRV9ESVNQSV9J
T1BPUlRfSU5ERVggICAgICAgICAgIDB4MDFDRQojZGVmaW5lIFZCRV9ESVNQSV9JT1BPUlRfREFU
QSAgICAgICAgICAgIDB4MDFDRgojZGVmaW5lIEJPQ0hTX1ZFTkRPUl9JRCAgICAgICAgICAgICAg
ICAgIDB4MTIzNAojZGVmaW5lIEJPQ0hTX0RFVklDRV9JRCAgICAgICAgICAgICAgICAgIDB4MTEx
MQoKLyogQkFSIG1ldGFkYXRhICovCnR5cGVkZWYgZW51bSB7CiAgICBCQVJfVFlQRV9OT05FID0g
MCwKICAgIEJBUl9UWVBFX01NSU8sCiAgICBCQVJfVFlQRV9QSU8sCiAgICBCQVJfVFlQRV9SQU0K
fSBCQVJUeXBlOwoKdHlwZWRlZiBzdHJ1Y3QgewogICAgaW50IGluZGV4OwogICAgQkFSVHlwZSB0
eXBlOwogICAgaHdhZGRyIHNpemU7CiAgICBjb25zdCBjaGFyICpuYW1lOwogICAgYm9vbCBzcGFy
c2U7Cn0gQkFSSW5mbzsKCnN0cnVjdCBQQ0lCYXNlU3RhdGUgewogICAgUENJRGV2aWNlIHBhcmVu
dF9vYmo7CgogICAgTWVtb3J5UmVnaW9uIGJhcl9yZWdpb25zWzZdOwoKICAgIHVpbnQ4X3QgKm1t
aW9fYmFja2luZzsKICAgIHNpemVfdCBtbWlvX2JhY2tpbmdfc2l6ZTsKCiAgICBCQVJJbmZvIGJh
cl9pbmZvWzZdOwogICAgaW50IG51bV9iYXJzOwoKICAgIGJvb2wgaGFzX21zaTsKICAgIGJvb2wg
aGFzX21zaXg7CgogICAgLyogRGlzcGkvVkdBIGVtdWxhdGlvbiBzdGF0ZSAqLwogICAgdWludDE2
X3QgZGlzcGlfaW5kZXg7CiAgICB1aW50MTZfdCBkaXNwaV9yZWdzWzE2XTsKCiAgICAvKiBTaW1w
bGUgZnJhbWUgYnVmZmVyIGJhY2tpbmcgZm9yIEJBUjAgKFZSQU0pICovCiAgICBNZW1vcnlSZWdp
b24gdnJhbV9yZWdpb247CiAgICBod2FkZHIgdnJhbV9zaXplOwoKICAgIC8qIE1NSU8gQkFSMiBz
aXplIGNhY2hlZCAqLwogICAgaHdhZGRyIG1taW9fc2l6ZTsKfTsKCnN0YXRpYyB1aW50NjRfdCBw
Y2liYXNlX21taW9fcmVhZCh2b2lkICpvcGFxdWUsIGh3YWRkciBhZGRyLCB1bnNpZ25lZCBzaXpl
KTsKc3RhdGljIHZvaWQgcGNpYmFzZV9tbWlvX3dyaXRlKHZvaWQgKm9wYXF1ZSwgaHdhZGRyIGFk
ZHIsIHVpbnQ2NF90IHZhbCwgdW5zaWduZWQgc2l6ZSk7CnN0YXRpYyB1aW50NjRfdCBwY2liYXNl
X3Bpb19yZWFkKHZvaWQgKm9wYXF1ZSwgaHdhZGRyIGFkZHIsIHVuc2lnbmVkIHNpemUpOwpzdGF0
aWMgdm9pZCBwY2liYXNlX3Bpb193cml0ZSh2b2lkICpvcGFxdWUsIGh3YWRkciBhZGRyLCB1aW50
NjRfdCB2YWwsIHVuc2lnbmVkIHNpemUpOwpzdGF0aWMgdWludDMyX3QgcGNpYmFzZV9jb25maWdf
cmVhZChQQ0lEZXZpY2UgKnBkZXYsIHVpbnQzMl90IGFkZHIsIGludCBsZW4pOwpzdGF0aWMgdm9p
ZCBwY2liYXNlX2NvbmZpZ193cml0ZShQQ0lEZXZpY2UgKnBkZXYsIHVpbnQzMl90IGFkZHIsIHVp
bnQzMl90IHZhbCwgaW50IGxlbik7CnN0YXRpYyB2b2lkIHBjaWJhc2VfcmVzZXQoRGV2aWNlU3Rh
dGUgKmRldik7CnN0YXRpYyB2b2lkIHBjaWJhc2VfcmVhbGl6ZShQQ0lEZXZpY2UgKnBkZXYsIEVy
cm9yICoqZXJycCk7CnN0YXRpYyB2b2lkIHBjaWJhc2VfdW5pbml0KFBDSURldmljZSAqcGRldik7
CgpzdGF0aWMgY29uc3QgTWVtb3J5UmVnaW9uT3BzIHBjaWJhc2VfbW1pb19vcHMgPSB7CiAgICAu
cmVhZCA9IHBjaWJhc2VfbW1pb19yZWFkLAogICAgLndyaXRlID0gcGNpYmFzZV9tbWlvX3dyaXRl
LAogICAgLmVuZGlhbm5lc3MgPSBERVZJQ0VfTElUVExFX0VORElBTiwKICAgIC52YWxpZCA9IHsg
Lm1pbl9hY2Nlc3Nfc2l6ZSA9IDEsIC5tYXhfYWNjZXNzX3NpemUgPSA0IH0sCiAgICAuaW1wbCAg
PSB7IC5taW5fYWNjZXNzX3NpemUgPSAxLCAubWF4X2FjY2Vzc19zaXplID0gNCB9LAp9OwoKc3Rh
dGljIGNvbnN0IE1lbW9yeVJlZ2lvbk9wcyBwY2liYXNlX3Bpb19vcHMgPSB7CiAgICAucmVhZCA9
IHBjaWJhc2VfcGlvX3JlYWQsCiAgICAud3JpdGUgPSBwY2liYXNlX3Bpb193cml0ZSwKICAgIC5l
bmRpYW5uZXNzID0gREVWSUNFX0xJVFRMRV9FTkRJQU4sCiAgICAudmFsaWQgPSB7IC5taW5fYWNj
ZXNzX3NpemUgPSAxLCAubWF4X2FjY2Vzc19zaXplID0gNCB9LAogICAgLmltcGwgID0geyAubWlu
X2FjY2Vzc19zaXplID0gMSwgLm1heF9hY2Nlc3Nfc2l6ZSA9IDQgfSwKfTsKCnN0YXRpYyB2b2lk
IHBjaWJhc2VfcmVnaXN0ZXJfYmFyKFBDSURldmljZSAqcGRldiwgUENJQmFzZVN0YXRlICpzLCBC
QVJJbmZvICpiaSwgRXJyb3IgKiplcnJwKQp7CiAgICBpZiAoIWJpIHx8IGJpLT50eXBlID09IEJB
Ul9UWVBFX05PTkUpIHsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgTWVtb3J5UmVnaW9uICpt
ciA9ICZzLT5iYXJfcmVnaW9uc1tiaS0+aW5kZXhdOwoKICAgIGlmIChiaS0+dHlwZSA9PSBCQVJf
VFlQRV9NTUlPKSB7CiAgICAgICAgbWVtb3J5X3JlZ2lvbl9pbml0X2lvKG1yLCBPQkpFQ1Qocyks
ICZwY2liYXNlX21taW9fb3BzLCBzLCBiaS0+bmFtZSwgYmktPnNpemUpOwogICAgICAgIHBjaV9y
ZWdpc3Rlcl9iYXIocGRldiwgYmktPmluZGV4LCBQQ0lfQkFTRV9BRERSRVNTX1NQQUNFX01FTU9S
WSwgbXIpOwogICAgfSBlbHNlIGlmIChiaS0+dHlwZSA9PSBCQVJfVFlQRV9QSU8pIHsKICAgICAg
ICBtZW1vcnlfcmVnaW9uX2luaXRfaW8obXIsIE9CSkVDVChzKSwgJnBjaWJhc2VfcGlvX29wcywg
cywgYmktPm5hbWUsIGJpLT5zaXplKTsKICAgICAgICBwY2lfcmVnaXN0ZXJfYmFyKHBkZXYsIGJp
LT5pbmRleCwgUENJX0JBU0VfQUREUkVTU19TUEFDRV9JTywgbXIpOwogICAgfSBlbHNlIGlmIChi
aS0+dHlwZSA9PSBCQVJfVFlQRV9SQU0pIHsKICAgICAgICBtZW1vcnlfcmVnaW9uX2luaXRfcmFt
KG1yLCBPQkpFQ1QocyksIGJpLT5uYW1lLCBiaS0+c2l6ZSwgZXJycCk7CiAgICAgICAgcGNpX3Jl
Z2lzdGVyX2JhcihwZGV2LCBiaS0+aW5kZXgsIFBDSV9CQVNFX0FERFJFU1NfU1BBQ0VfTUVNT1JZ
LCBtcik7CiAgICB9Cn0KCi8qIE1NSU8gQkFSMiBsYXlvdXQgaW1wbGVtZW50ZWQgZnJvbSBkcml2
ZXIgdXNhZ2U6CiAqICAweDAwMC0weDNmZiA6IEVESUQgYnVmZmVyIChib2Noc19nZXRfZWRpZF9i
bG9jaykKICogIDB4NDAwLTB4NDNmIDogVkdBIHBvcnRzIDB4M2MwLTB4M2RmIG1hcHBlZCBhcyBi
eXRlcwogKiAgMHg1MDAtMHg1MWYgOiBkaXNwaSByZWdpc3RlcnMsIDE2LWJpdCBlYWNoOiBvZmZz
ZXQgPSAweDUwMCArIChyZWc8PDEpCiAqICAweDYwMCAgICAgICA6IHFleHRfc2l6ZSAocmVhZGwp
CiAqICAweDYwNCAgICAgICA6IGVuZGlhbiBjb250cm9sICh3cml0ZWwgMHhiZWJlYmViZSAvIDB4
MWUxZTFlMWUpCiAqLwoKc3RhdGljIHVpbnQ2NF90IHBjaWJhc2VfbW1pb19yZWFkKHZvaWQgKm9w
YXF1ZSwgaHdhZGRyIGFkZHIsIHVuc2lnbmVkIHNpemUpCnsKICAgIFBDSUJhc2VTdGF0ZSAqcyA9
IG9wYXF1ZTsKCiAgICBpZiAoYWRkciA8IDB4NDAwKSB7CiAgICAgICAgLyogRURJRCBhbmQgb3Ro
ZXIgZGF0YTsgZHJpdmVyIG9ubHkgcmVhZHMgYnl0ZXMgKi8KICAgICAgICBpZiAoc2l6ZSA9PSAx
ICYmIHMtPm1taW9fYmFja2luZyAmJiBhZGRyIDwgcy0+bW1pb19iYWNraW5nX3NpemUpIHsKICAg
ICAgICAgICAgcmV0dXJuIHMtPm1taW9fYmFja2luZ1thZGRyXTsKICAgICAgICB9CiAgICAgICAg
cmV0dXJuIDA7CiAgICB9CgogICAgaWYgKGFkZHIgPj0gMHg0MDAgJiYgYWRkciA8IDB4NDQwKSB7
CiAgICAgICAgLyogVkdBIE1NSU8gd2luZG93IGZvciBwb3J0cyAweDNjMC0weDNkZi4gRHJpdmVy
IHVzZXMgb25seSBib2Noc192Z2FfcmVhZGIgKi8KICAgICAgICBpZiAoc2l6ZSA9PSAxKSB7CiAg
ICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAgICAgICByZXR1cm4gMDsKICAgIH0KCiAg
ICBpZiAoYWRkciA+PSAweDUwMCAmJiBhZGRyIDwgMHg1MjApIHsKICAgICAgICAvKiBkaXNwaSBy
ZWdpc3RlcnMgYXMgMTYtYml0ICovCiAgICAgICAgaWYgKHNpemUgIT0gMikgewogICAgICAgICAg
ICByZXR1cm4gMDsKICAgICAgICB9CiAgICAgICAgdWludDE2X3QgcmVnID0gKGFkZHIgLSAweDUw
MCkgPj4gMTsKICAgICAgICBpZiAocmVnID49IDE2KSB7CiAgICAgICAgICAgIHJldHVybiAwOwog
ICAgICAgIH0KICAgICAgICByZXR1cm4gcy0+ZGlzcGlfcmVnc1tyZWddOwogICAgfQoKICAgIGlm
IChhZGRyID09IDB4NjAwICYmIHNpemUgPT0gNCkgewogICAgICAgIC8qIHFleHRfc2l6ZSBmaWVs
ZCAqLwogICAgICAgIHJldHVybiBzLT5tbWlvX3NpemU7CiAgICB9CgogICAgaWYgKGFkZHIgPT0g
MHg2MDQgJiYgc2l6ZSA9PSA0KSB7CiAgICAgICAgLyogZW5kaWFuIGNvbnRyb2wgcmVhZGJhY2s6
IGtlZXAgYXMgemVybzsgZHJpdmVyIG9ubHkgY2hlY2tzIHdyaXRlIHBhdHRlcm4gKi8KICAgICAg
ICByZXR1cm4gMDsKICAgIH0KCiAgICByZXR1cm4gMDsKfQoKc3RhdGljIHZvaWQgcGNpYmFzZV9t
bWlvX3dyaXRlKHZvaWQgKm9wYXF1ZSwgaHdhZGRyIGFkZHIsIHVpbnQ2NF90IHZhbCwgdW5zaWdu
ZWQgc2l6ZSkKewogICAgUENJQmFzZVN0YXRlICpzID0gb3BhcXVlOwoKICAgIGlmIChhZGRyIDwg
MHg0MDApIHsKICAgICAgICAvKiBFRElEIC8gb3RoZXIgcmVhZC1vbmx5IGZvciBvdXIgcHVycG9z
ZXM7IGRyaXZlciBvbmx5IHJlYWRzICovCiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmIChh
ZGRyID49IDB4NDAwICYmIGFkZHIgPCAweDQ0MCkgewogICAgICAgIC8qIFZHQSBNTUlPIHdpbmRv
dyBmb3IgcG9ydHMgMHgzYzAtMHgzZGY7IGRyaXZlciB1c2VzIHdyaXRlYiAqLwogICAgICAgIGlm
IChzaXplID09IDEpIHsKICAgICAgICAgICAgaWYgKHMtPm1taW9fYmFja2luZyAmJiBhZGRyIDwg
cy0+bW1pb19iYWNraW5nX3NpemUpIHsKICAgICAgICAgICAgICAgIHMtPm1taW9fYmFja2luZ1th
ZGRyXSA9ICh1aW50OF90KXZhbDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1
cm47CiAgICB9CgogICAgaWYgKGFkZHIgPj0gMHg1MDAgJiYgYWRkciA8IDB4NTIwKSB7CiAgICAg
ICAgaWYgKHNpemUgIT0gMikgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAg
IHVpbnQxNl90IHJlZyA9IChhZGRyIC0gMHg1MDApID4+IDE7CiAgICAgICAgaWYgKHJlZyA+PSAx
NikgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHVpbnQxNl90IHYgPSAo
dWludDE2X3QpdmFsOwogICAgICAgIHMtPmRpc3BpX3JlZ3NbcmVnXSA9IHY7CiAgICAgICAgcmV0
dXJuOwogICAgfQoKICAgIGlmIChhZGRyID09IDB4NjAwICYmIHNpemUgPT0gNCkgewogICAgICAg
IC8qIHFleHRfc2l6ZSBpcyByZWFkLW9ubHkgZm9yIGRyaXZlcjsgaWdub3JlIHdyaXRlcyAqLwog
ICAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAoYWRkciA9PSAweDYwNCAmJiBzaXplID09IDQp
IHsKICAgICAgICAvKiBlbmRpYW4gY29udHJvbDogZHJpdmVyIHdyaXRlcyBtYXJrZXJzIG9ubHk7
IG5vIG90aGVyIGVmZmVjdCBpbXBsZW1lbnRlZCAqLwogICAgICAgIHJldHVybjsKICAgIH0KfQoK
LyogQm9jaHMgZHJpdmVyIG1heSBmYWxsIGJhY2sgdG8gSS9PIHBvcnRzIGlmIE1NSU8gQkFSMiBp
cyBub3QgcHJlc2VudC4KICogRm9yIHNpbXBsaWNpdHkgd2UgZW11bGF0ZSBvbmx5IHRoZSBzdWJz
ZXQgb2YgcG9ydHMgdXNlZCBieSB0aGUgZHJpdmVyLgogKi8Kc3RhdGljIHVpbnQ2NF90IHBjaWJh
c2VfcGlvX3JlYWQodm9pZCAqb3BhcXVlLCBod2FkZHIgYWRkciwgdW5zaWduZWQgc2l6ZSkKewog
ICAgUENJQmFzZVN0YXRlICpzID0gb3BhcXVlOwoKICAgIGlmIChhZGRyID09IChWQkVfRElTUElf
SU9QT1JUX0lOREVYICYgMHhmZmYpICYmIHNpemUgPT0gMikgewogICAgICAgIHJldHVybiBzLT5k
aXNwaV9pbmRleDsKICAgIH0KICAgIGlmIChhZGRyID09IChWQkVfRElTUElfSU9QT1JUX0RBVEEg
JiAweGZmZikgJiYgc2l6ZSA9PSAyKSB7CiAgICAgICAgdWludDE2X3QgcmVnID0gcy0+ZGlzcGlf
aW5kZXg7CiAgICAgICAgaWYgKHJlZyA8IDE2KSB7CiAgICAgICAgICAgIHJldHVybiBzLT5kaXNw
aV9yZWdzW3JlZ107CiAgICAgICAgfQogICAgICAgIHJldHVybiAwOwogICAgfQoKICAgIHJldHVy
biAwOwp9CgpzdGF0aWMgdm9pZCBwY2liYXNlX3Bpb193cml0ZSh2b2lkICpvcGFxdWUsIGh3YWRk
ciBhZGRyLCB1aW50NjRfdCB2YWwsIHVuc2lnbmVkIHNpemUpCnsKICAgIFBDSUJhc2VTdGF0ZSAq
cyA9IG9wYXF1ZTsKCiAgICBpZiAoYWRkciA9PSAoVkJFX0RJU1BJX0lPUE9SVF9JTkRFWCAmIDB4
ZmZmKSAmJiBzaXplID09IDIpIHsKICAgICAgICBzLT5kaXNwaV9pbmRleCA9ICh1aW50MTZfdCl2
YWw7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgaWYgKGFkZHIgPT0gKFZCRV9ESVNQSV9JT1BP
UlRfREFUQSAmIDB4ZmZmKSAmJiBzaXplID09IDIpIHsKICAgICAgICB1aW50MTZfdCByZWcgPSBz
LT5kaXNwaV9pbmRleDsKICAgICAgICBpZiAocmVnIDwgMTYpIHsKICAgICAgICAgICAgcy0+ZGlz
cGlfcmVnc1tyZWddID0gKHVpbnQxNl90KXZhbDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuOwog
ICAgfQp9CgpzdGF0aWMgdm9pZCBwY2liYXNlX3Jlc2V0KERldmljZVN0YXRlICpkZXYpCnsKICAg
IFBDSUJhc2VTdGF0ZSAqcyA9IFBDSUJBU0VfREVWSUNFKGRldik7CiAgICBQQ0lEZXZpY2UgKnBk
ZXYgPSBQQ0lfREVWSUNFKGRldik7CgogICAgcGNpX2RldmljZV9yZXNldChwZGV2KTsKCiAgICBp
ZiAocy0+bW1pb19iYWNraW5nICYmIHMtPm1taW9fYmFja2luZ19zaXplKSB7CiAgICAgICAgbWVt
c2V0KHMtPm1taW9fYmFja2luZywgMCwgcy0+bW1pb19iYWNraW5nX3NpemUpOwogICAgfQoKICAg
IG1lbXNldChzLT5kaXNwaV9yZWdzLCAwLCBzaXplb2Yocy0+ZGlzcGlfcmVncykpOwogICAgcy0+
ZGlzcGlfaW5kZXggPSAwOwoKICAgIC8qIEluaXRpYWxpemUgSUQgYW5kIHZpZGVvIG1lbW9yeSBz
aXplICovCiAgICBzLT5kaXNwaV9yZWdzW1ZCRV9ESVNQSV9JTkRFWF9JRF0gPSBWQkVfRElTUElf
SUQ1OwogICAgaWYgKHMtPnZyYW1fc2l6ZSkgewogICAgICAgIHMtPmRpc3BpX3JlZ3NbVkJFX0RJ
U1BJX0lOREVYX1ZJREVPX01FTU9SWV82NEtdID0gKHVpbnQxNl90KShzLT52cmFtX3NpemUgLyAo
NjQgKiAxMDI0KSk7CiAgICB9Cn0KCnN0YXRpYyB2b2lkIHBjaWJhc2VfZG1hX2RldmljZV9yZWFs
aXplKFBDSURldmljZSAqcGRldiwgRXJyb3IgKiplcnJwKQp7CiAgICAodm9pZClwZGV2OwogICAg
KHZvaWQpZXJycDsKfQoKc3RhdGljIHVpbnQzMl90IHBjaWJhc2VfY29uZmlnX3JlYWQoUENJRGV2
aWNlICpwZGV2LCB1aW50MzJfdCBhZGRyLCBpbnQgbGVuKQp7CiAgICB1aW50MzJfdCB2YWwgPSBw
Y2lfZGVmYXVsdF9yZWFkX2NvbmZpZyhwZGV2LCBhZGRyLCBsZW4pOwoKICAgIHN3aXRjaCAobGVu
KSB7CiAgICBjYXNlIDE6CiAgICAgICAgdmFsICY9IDB4RkY7CiAgICAgICAgYnJlYWs7CiAgICBj
YXNlIDI6CiAgICAgICAgdmFsICY9IDB4RkZGRjsKICAgICAgICBicmVhazsKICAgIGNhc2UgNDoK
ICAgIGRlZmF1bHQ6CiAgICAgICAgYnJlYWs7CiAgICB9CiAgICByZXR1cm4gdmFsOwp9CgpzdGF0
aWMgdm9pZCBwY2liYXNlX2NvbmZpZ193cml0ZShQQ0lEZXZpY2UgKnBkZXYsIHVpbnQzMl90IGFk
ZHIsIHVpbnQzMl90IHZhbCwgaW50IGxlbikKewogICAgcGNpX2RlZmF1bHRfd3JpdGVfY29uZmln
KHBkZXYsIGFkZHIsIHZhbCwgbGVuKTsKfQoKc3RhdGljIHZvaWQgcGNpYmFzZV9yZWFsaXplKFBD
SURldmljZSAqcGRldiwgRXJyb3IgKiplcnJwKQp7CiAgICBQQ0lCYXNlU3RhdGUgKnMgPSBQQ0lC
QVNFX0RFVklDRShwZGV2KTsKICAgIHVpbnQ4X3QgKnBjaV9jb25mID0gcGRldi0+Y29uZmlnOwoK
ICAgIHMtPm51bV9iYXJzID0gMDsKCiAgICAvKiBTZXQgdXAgVlJBTSAoQkFSMCk6IDE2IE1pQiAq
LwogICAgcy0+dnJhbV9zaXplID0gMTYgKiAxMDI0ICogMTAyNDsKICAgIHMtPm1taW9fYmFja2lu
Z19zaXplID0gcy0+dnJhbV9zaXplOwogICAgcy0+bW1pb19iYWNraW5nID0gZ19tYWxsb2MwKHMt
Pm1taW9fYmFja2luZ19zaXplKTsKCiAgICBtZW1vcnlfcmVnaW9uX2luaXRfcmFtKCZzLT52cmFt
X3JlZ2lvbiwgT0JKRUNUKHMpLCAiYm9jaHMtdnJhbSIsIHMtPnZyYW1fc2l6ZSwgZXJycCk7CiAg
ICBwY2lfcmVnaXN0ZXJfYmFyKHBkZXYsIDAsIFBDSV9CQVNFX0FERFJFU1NfU1BBQ0VfTUVNT1JZ
LCAmcy0+dnJhbV9yZWdpb24pOwoKICAgIC8qIE1NSU8gQkFSMjogbWFwIE1NSU8gc3BhY2UgdXNl
ZCBieSBkcml2ZXIgKEVESUQsIFZHQSwgZGlzcGksIHFleHQpICovCiAgICBzLT5tbWlvX3NpemUg
PSAweDEwMDA7CiAgICBzLT5iYXJfaW5mb1tzLT5udW1fYmFyc10uaW5kZXggPSAyOwogICAgcy0+
YmFyX2luZm9bcy0+bnVtX2JhcnNdLnR5cGUgPSBCQVJfVFlQRV9NTUlPOwogICAgcy0+YmFyX2lu
Zm9bcy0+bnVtX2JhcnNdLnNpemUgPSBzLT5tbWlvX3NpemU7CiAgICBzLT5iYXJfaW5mb1tzLT5u
dW1fYmFyc10ubmFtZSA9ICJib2Nocy1tbWlvIjsKICAgIHMtPmJhcl9pbmZvW3MtPm51bV9iYXJz
XS5zcGFyc2UgPSBmYWxzZTsKICAgIHMtPm51bV9iYXJzKys7CgogICAgcGNpX3NldF93b3JkKHBj
aV9jb25mICsgUENJX1ZFTkRPUl9JRCwgIEJPQ0hTX1ZFTkRPUl9JRCk7CiAgICBwY2lfc2V0X3dv
cmQocGNpX2NvbmYgKyBQQ0lfREVWSUNFX0lELCAgQk9DSFNfREVWSUNFX0lEKTsKICAgIHBjaV9z
ZXRfd29yZChwY2lfY29uZiArIFBDSV9DTEFTU19ERVZJQ0UsIFBDSV9DTEFTU19ESVNQTEFZX09U
SEVSKTsKICAgIHBjaV9zZXRfYnl0ZShwY2lfY29uZiArIFBDSV9SRVZJU0lPTl9JRCwgMik7IC8q
ID49IDIgc28gcWV4dCBpcyB1c2VkICovCiAgICBwY2lfY29uZmlnX3NldF9pbnRlcnJ1cHRfcGlu
KHBjaV9jb25mLCAxKTsKCiAgICBmb3IgKGludCBpID0gMDsgaSA8IHMtPm51bV9iYXJzOyBpKysp
IHsKICAgICAgICBwY2liYXNlX3JlZ2lzdGVyX2JhcihwZGV2LCBzLCAmcy0+YmFyX2luZm9baV0s
IGVycnApOwogICAgfQoKICAgIHBjaWJhc2VfZG1hX2RldmljZV9yZWFsaXplKHBkZXYsIGVycnAp
OwogICAgaWYgKGVycnAgJiYgKmVycnApIHsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgcGNp
YmFzZV9yZXNldChERVZJQ0UocGRldikpOwp9CgpzdGF0aWMgdm9pZCBwY2liYXNlX3VuaW5pdChQ
Q0lEZXZpY2UgKnBkZXYpCnsKICAgIFBDSUJhc2VTdGF0ZSAqcyA9IFBDSUJBU0VfREVWSUNFKHBk
ZXYpOwoKICAgIGlmIChzLT5oYXNfbXNpeCkgewogICAgICAgIG1zaXhfdW5pbml0KHBkZXYsIE5V
TEwsIDApOwogICAgICAgIHMtPmhhc19tc2l4ID0gZmFsc2U7CiAgICB9CiAgICBpZiAocy0+aGFz
X21zaSkgewogICAgICAgIG1zaV91bmluaXQocGRldik7CiAgICAgICAgcy0+aGFzX21zaSA9IGZh
bHNlOwogICAgfQoKICAgIGlmIChzLT5tbWlvX2JhY2tpbmcpIHsKICAgICAgICBnX2ZyZWUocy0+
bW1pb19iYWNraW5nKTsKICAgICAgICBzLT5tbWlvX2JhY2tpbmcgPSBOVUxMOwogICAgfQp9Cgpz
dGF0aWMgdm9pZCBwY2liYXNlX2NsYXNzX2luaXQoT2JqZWN0Q2xhc3MgKmtsYXNzLCB2b2lkICpk
YXRhKQp7CiAgICBEZXZpY2VDbGFzcyAqZGMgPSBERVZJQ0VfQ0xBU1Moa2xhc3MpOwogICAgUENJ
RGV2aWNlQ2xhc3MgKmsgPSBQQ0lfREVWSUNFX0NMQVNTKGtsYXNzKTsKCiAgICBrLT5jb25maWdf
cmVhZCAgPSBwY2liYXNlX2NvbmZpZ19yZWFkOwogICAgay0+Y29uZmlnX3dyaXRlID0gcGNpYmFz
ZV9jb25maWdfd3JpdGU7CgogICAgay0+cmVhbGl6ZSA9IHBjaWJhc2VfcmVhbGl6ZTsKICAgIGst
PmV4aXQgICAgPSBwY2liYXNlX3VuaW5pdDsKICAgIGRjLT5yZXNldCAgPSBwY2liYXNlX3Jlc2V0
OwoKICAgIHNldF9iaXQoREVWSUNFX0NBVEVHT1JZX0RJU1BMQVksIGRjLT5jYXRlZ29yaWVzKTsK
fQoKc3RhdGljIHZvaWQgcGNpYmFzZV9yZWdpc3Rlcl90eXBlcyh2b2lkKQp7CiAgICBzdGF0aWMg
SW50ZXJmYWNlSW5mbyBpbnRlcmZhY2VzW10gPSB7CiAgICAgICAgeyBJTlRFUkZBQ0VfQ09OVkVO
VElPTkFMX1BDSV9ERVZJQ0UgfSwKICAgICAgICB7IH0sCiAgICB9OwoKICAgIHN0YXRpYyBjb25z
dCBUeXBlSW5mbyBwY2liYXNlX2luZm8gPSB7CiAgICAgICAgLm5hbWUgPSBUWVBFX1BDSUJBU0Vf
REVWSUNFLAogICAgICAgIC5wYXJlbnQgPSBUWVBFX1BDSV9ERVZJQ0UsCiAgICAgICAgLmluc3Rh
bmNlX3NpemUgPSBzaXplb2YoUENJQmFzZVN0YXRlKSwKICAgICAgICAuY2xhc3NfaW5pdCA9IHBj
aWJhc2VfY2xhc3NfaW5pdCwKICAgICAgICAuaW50ZXJmYWNlcyA9IGludGVyZmFjZXMsCiAgICB9
OwoKICAgIHR5cGVfcmVnaXN0ZXJfc3RhdGljKCZwY2liYXNlX2luZm8pOwp9Cgp0eXBlX2luaXQo
cGNpYmFzZV9yZWdpc3Rlcl90eXBlcyk7Cgo=
------=_Part_169223_1754403738.1768044304827--

