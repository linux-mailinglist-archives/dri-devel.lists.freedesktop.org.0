Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 132E3A2281
	for <lists+dri-devel@lfdr.de>; Thu, 29 Aug 2019 19:39:35 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 095306E086;
	Thu, 29 Aug 2019 17:39:32 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x543.google.com (mail-ed1-x543.google.com
 [IPv6:2a00:1450:4864:20::543])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5757B6E086
 for <dri-devel@lists.freedesktop.org>; Thu, 29 Aug 2019 17:39:30 +0000 (UTC)
Received: by mail-ed1-x543.google.com with SMTP id s49so4978663edb.1
 for <dri-devel@lists.freedesktop.org>; Thu, 29 Aug 2019 10:39:30 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=vWvompOB9P3qSUAQt3RGkWbjvpOgrGjuuiR+hcj9nz0=;
 b=qp6tryLi0nRhHGwrciavSjpa+YM3iq+eLlsJqY9UcoWptJ3cetMEd70aTXcoxErMJa
 PID5MjqFXa9C5I8hcfavVCokSLOpv1QA+onnZ04SXkXgirr5c3oC/NgzuZkhbg0pDx9Z
 67fpbcjsrpF+BJ5CXghPTcDmndkXdJo30sUQk3sCQ7KgB4G3O2m/b60AJ6ZikmYUX9i7
 skEZhQpiM0LcWDBjKKDTyWyWHecYMHMDMtLabJaVX5endvkuTycVDBEoHy7FOJp/jEXW
 u/TP9OP7UpdA7NdXuM8xPspVbUyBiOGUj8Ce8ywniDxnI34U/1vv3V0lEjW9uy7mcNTB
 7cdg==
X-Gm-Message-State: APjAAAUNm6gyItCTHN3p615/mqsWPb9XyDyIMd558kUtIL0bkpXbIwJ4
 qiana9VTZV30h9vYaflgO75kwLHMM1LkwGv4Yro=
X-Google-Smtp-Source: APXvYqw0dTgLE2E3lYLOddKp9RHLShKkrEGWc3qWj/KUwq93H6wlWpEC6wNZ/syjoFr1eFEB/Mfak6Emj2EJWOp1cOU=
X-Received: by 2002:a17:906:6bc4:: with SMTP id
 t4mr9666690ejs.256.1567100368758; 
 Thu, 29 Aug 2019 10:39:28 -0700 (PDT)
MIME-Version: 1.0
References: <20190829060550.62095-1-john.stultz@linaro.org>
In-Reply-To: <20190829060550.62095-1-john.stultz@linaro.org>
From: Rob Clark <robdclark@gmail.com>
Date: Thu, 29 Aug 2019 10:39:17 -0700
Message-ID: <CAF6AEGvborwLmjfC6_vgZ-ZbfvF3HEFFyb_NHSLRoYWF35bw+g@mail.gmail.com>
Subject: Re: [RFC][PATCH] drm: kirin: Fix dsi probe/attach logic
To: John Stultz <john.stultz@linaro.org>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=vWvompOB9P3qSUAQt3RGkWbjvpOgrGjuuiR+hcj9nz0=;
 b=cGl12q3btanfNBIfBGgNS4OEaxSll4YH3jpxfoItAFYfLShzkFsQFe/Zi6WPHuCUB5
 wnyh5sS0NdIw2bhi5WjVqDWtlaWM4nwHwZVdfj8Z8tioAq3mf/HTivEIBFvf5kdpnqF9
 0GsDpqdOawZDOvghZj/hJnGZ7i/MFSS/bSEhts/OQRxp4Ms/cMPmgVnp6tZM1xFYuyIv
 AvvSPgY+DQ1TGxg/6BRJ18Eqvtdl+edRhgNbYBY02bS2c/qfSCApUwsbei9uNwuF0unj
 luOVI25PBjZDI6JTS0uJLaTBj2B4svdX5lXvscrozuHUU5EM9zJHkErLhJtn2eD/SlI7
 cnVA==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Jernej Skrabec <jernej.skrabec@siol.net>, Jonas Karlman <jonas@kwiboo.se>,
 David Airlie <airlied@linux.ie>, Neil Armstrong <narmstrong@baylibre.com>,
 lkml <linux-kernel@vger.kernel.org>,
 "dri-devel@lists.freedesktop.org" <dri-devel@lists.freedesktop.org>,
 Xinliang Liu <z.liuxinliang@hisilicon.com>,
 Thierry Reding <thierry.reding@gmail.com>, Sean Paul <seanpaul@chromium.org>,
 Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
 Rongrong Zou <zourongrong@gmail.com>, Sam Ravnborg <sam@ravnborg.org>,
 Matt Redfearn <matt.redfearn@thinci.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gV2VkLCBBdWcgMjgsIDIwMTkgYXQgMTE6MDYgUE0gSm9obiBTdHVsdHogPGpvaG4uc3R1bHR6
QGxpbmFyby5vcmc+IHdyb3RlOgo+Cj4gU2luY2UgY29tbWl0IDgzZjM1YmMzYTg1MiAoImRybS9i
cmlkZ2U6IGFkdjc1MTE6IEF0dGFjaCB0byBEU0kKPiBob3N0IGF0IHByb2JlIHRpbWUiKSBsYW5k
ZWQgaW4gLW5leHQgdGhlIEhpS2V5IGJvYXJkIHdvdWxkIGZhaWwKPiB0byBib290LCBsb29waW5n
OgoKTm8sIHBsZWFzZSByZXZlcnQgODNmMzViYzNhODUyLi4gdGhhdCBpcyBnb2luZyBpbiB0aGUg
KmNvbXBsZXRlKiB3cm9uZwpkaXJlY3Rpb24uICBXZSBhY3R1YWxseSBzaG91bGQgYmUgbW92aW5n
IHBhbmVscyB0byBub3QgcmVxdWlyZSBkc2kKaG9zdCB1bnRpbCBhdHRhY2ggdGltZSwgc2ltaWxh
ciB0byBob3cgYnJpZGdlcyB3b3JrLCBub3QgdGhlIG90aGVyIHdheQphcm91bmQuCgpUaGUgcHJv
YmxlbSBpcyB0aGF0LCB3aGVuIGRlYWxpbmcgd2l0aCBib290bG9hZGVyIGVuYWJsZWQgZGlzcGxh
eSwgd2UKbmVlZCB0byBiZSByZWFsbHkgY2FyZWZ1bCBub3QgdG8gdG91Y2ggdGhlIGhhcmR3YXJl
IHVudGlsIHRoZSBkaXNwbGF5CmRyaXZlciBrbm93cyB0aGUgYnJpZGdlL3BhbmVsIGlzIHByZXNl
bnQuICBJZiB0aGUgYnJpZGdlL3BhbmVsIHByb2JlcwphZnRlciB0aGUgZGlzcGxheSBkcml2ZXIs
IHdlIGNvdWxkIGVuZCB1cCBraWxsaW5nIHNjYW5vdXQKKGVmaWZiL3NpbXBsZWZiKS4uIGlmIHRo
ZSBicmlkZ2UvcGFuZWwgaXMgbWlzc2luZyBzb21lIGRlcGVuZGVuY3kgYW5kCm5ldmVyIHByb2Jl
cywgaXQgaXMgcmF0aGVyIHVucGxlYXNhbnQgdG8gYmUgc3R1Y2sgdHJ5aW5nIHRvIGRlYnVnIHdo
YXQKd2VudCB3cm9uZyB3aXRoIG5vIGRpc3BsYXkuCgpTb3JyeSBJIGRpZG4ndCBub3RpY2UgdGhh
dCBhZHY3NTExIHBhdGNoIGJlZm9yZSBpdCBsYW5kZWQsIGJ1dCB0aGUKcmlnaHQgdGhpbmcgdG8g
ZG8gbm93IGlzIHRvIHJldmVydCBpdC4KCkJSLAotUgoKPiAgIGFkdjc1MTEgMi0wMDM5OiBmYWls
ZWQgdG8gZmluZCBkc2kgaG9zdAo+Cj4gbWVzc2FnZXMgb3ZlciBhbmQgb3Zlci4gQW5kcnplaiBI
YWpkYSBzdWdnZXN0ZWQgdGhpcyBpcyBkdWUgdG8gYQo+IGNpcmN1bGFyIGRlcGVuZGVuY3kgaXNz
dWUsIGFuZCB0aGF0IHRoZSBhZHY3NTExIGNoYW5nZSBpcwo+IGNvcnJlY3RpbmcgdGhlIGltcHJv
cGVyIG9yZGVyIHVzZWQgZWFybGllci4KPgo+IFVuZm9ydHVuYXRlbHkgdGhpcyBtZWFucyB0aGUg
RFNJIGRyaXZlcnMgdGhhdCB1c2UgYWR2NzUxMSBuZWVkCj4gdG8gYWxzbyBuZWVkIHRvIGJlIHVw
ZGF0ZWQgdG8gdXNlIHRoZSBwcm9wZXIgb3JkZXJpbmcgdG8KPiBjb250aW51ZSB0byB3b3JrLgo+
Cj4gVGhpcyBwYXRjaCB0cmllcyB0byByZW9yZGVyIHRoZSBpbml0aWFsaXphdGlvbiB0byByZWdp
c3RlciB0aGUKPiBkc2lfaG9zdCBmaXJzdCwgYW5kIHRoZW4gY2FsbCBjb21wb25lbnRfYWRkIHZp
YSBkc2lfaG9zdF9hdHRhY2gsCj4gaW5zdGVhZCBvZiBkb2luZyB0aGF0IGF0IHByb2JlIHRpbWUu
Cj4KPiBUaGlzIHNlZW1zIHRvIHJlc29sdmUgdGhlIGlzc3VlIHdpdGggdGhlIEhpS2V5IGJvYXJk
Lgo+Cj4gQ2M6IEFuZHJ6ZWogSGFqZGEgPGEuaGFqZGFAc2Ftc3VuZy5jb20+Cj4gQ2M6IE1hdHQg
UmVkZmVhcm4gPG1hdHQucmVkZmVhcm5AdGhpbmNpLmNvbT4KPiBDYzogWGlubGlhbmcgTGl1IDx6
LmxpdXhpbmxpYW5nQGhpc2lsaWNvbi5jb20+Cj4gQ2M6IFJvbmdyb25nIFpvdSA8em91cm9uZ3Jv
bmdAZ21haWwuY29tPgo+IENjOiBMYXVyZW50IFBpbmNoYXJ0IDxMYXVyZW50LnBpbmNoYXJ0QGlk
ZWFzb25ib2FyZC5jb20+Cj4gQ2M6IE5laWwgQXJtc3Ryb25nIDxuYXJtc3Ryb25nQGJheWxpYnJl
LmNvbT4KPiBDYzogSm9uYXMgS2FybG1hbiA8am9uYXNAa3dpYm9vLnNlPgo+IENjOiBKZXJuZWog
U2tyYWJlYyA8amVybmVqLnNrcmFiZWNAc2lvbC5uZXQ+Cj4gQ2M6IFRoaWVycnkgUmVkaW5nIDx0
aGllcnJ5LnJlZGluZ0BnbWFpbC5jb20+Cj4gQ2M6IERhdmlkIEFpcmxpZSA8YWlybGllZEBsaW51
eC5pZT4sCj4gQ2M6IFNlYW4gUGF1bCA8c2VhbnBhdWxAY2hyb21pdW0ub3JnPgo+IENjOiBTYW0g
UmF2bmJvcmcgPHNhbUByYXZuYm9yZy5vcmc+Cj4gQ2M6ICJkcmktZGV2ZWxAbGlzdHMuZnJlZWRl
c2t0b3Aub3JnIiA8ZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZz4KPiBGaXhlczogODNm
MzViYzNhODUyICgiZHJtL2JyaWRnZTogYWR2NzUxMTogQXR0YWNoIHRvIERTSSBob3N0IGF0IHBy
b2JlIHRpbWUiKQo+IFNpZ25lZC1vZmYtYnk6IEpvaG4gU3R1bHR6IDxqb2huLnN0dWx0ekBsaW5h
cm8ub3JnPgo+IC0tLQo+IE5vdGU6IEknbSByZWFsbHkgbm90IHN1cGVyIGZhbWlsaWFyIHdpdGgg
dGhlIERTSSBjb2RlIGhlcmUsCj4gYW5kIGFtIG1vc3RseSBqdXN0IHRyeWluZyB0byByZWZhY3Rv
ciB0aGUgZXhpc3RpbmcgY29kZSBpbiBhCj4gc2ltaWxhciBmYXNoaW9uIHRvIHRoZSBzdWdnZXN0
ZWQgZHctbWlwaS1kc2ktcm9ja2NoaXAuYwo+IGltcGxlbWVudGF0aW9uLiBDYXJlZnVsIHJldmll
dyB3b3VsZCBiZSBncmVhdGx5IGFwcHJlY2lhdGVkIQo+Cj4gQWxzbyB0aGVyZSBpcyBhbiBvdXRz
dGFuZGluZyByZWdyZXNzaW9uIG9uIHRoZSBkYjQxMGMgc2luY2UgaXQKPiBzaW1pbGFybHkgdXNl
cyB0aGUgYWR2NzUxMSBhbmQgcHJvYmFibHkgbmVlZHMgYSBzaW1pbGFyIHJld29yay4KPiAtLS0K
PiAgZHJpdmVycy9ncHUvZHJtL2hpc2lsaWNvbi9raXJpbi9kd19kcm1fZHNpLmMgfCAxMTEgKysr
KysrKysrKy0tLS0tLS0tLQo+ICAxIGZpbGUgY2hhbmdlZCwgNTYgaW5zZXJ0aW9ucygrKSwgNTUg
ZGVsZXRpb25zKC0pCj4KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2hpc2lsaWNvbi9r
aXJpbi9kd19kcm1fZHNpLmMgYi9kcml2ZXJzL2dwdS9kcm0vaGlzaWxpY29uL2tpcmluL2R3X2Ry
bV9kc2kuYwo+IGluZGV4IDViZjgxMzg5NDFkZS4uNjk2Y2VlMWExMjE5IDEwMDY0NAo+IC0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9oaXNpbGljb24va2lyaW4vZHdfZHJtX2RzaS5jCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2hpc2lsaWNvbi9raXJpbi9kd19kcm1fZHNpLmMKPiBAQCAtNzksNiArNzks
NyBAQCBzdHJ1Y3QgZHNpX2h3X2N0eCB7Cj4gIH07Cj4KPiAgc3RydWN0IGR3X2RzaSB7Cj4gKyAg
ICAgICBzdHJ1Y3QgZGV2aWNlICpkZXY7Cj4gICAgICAgICBzdHJ1Y3QgZHJtX2VuY29kZXIgZW5j
b2RlcjsKPiAgICAgICAgIHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2U7Cj4gICAgICAgICBzdHJ1
Y3QgbWlwaV9kc2lfaG9zdCBob3N0Owo+IEBAIC03MjQsNTEgKzcyNSw2IEBAIHN0YXRpYyBpbnQg
ZHdfZHJtX2VuY29kZXJfaW5pdChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAgICAgICByZXR1cm4g
MDsKPiAgfQo+Cj4gLXN0YXRpYyBpbnQgZHNpX2hvc3RfYXR0YWNoKHN0cnVjdCBtaXBpX2RzaV9o
b3N0ICpob3N0LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBtaXBpX2RzaV9k
ZXZpY2UgKm1kc2kpCj4gLXsKPiAtICAgICAgIHN0cnVjdCBkd19kc2kgKmRzaSA9IGhvc3RfdG9f
ZHNpKGhvc3QpOwo+IC0KPiAtICAgICAgIGlmIChtZHNpLT5sYW5lcyA8IDEgfHwgbWRzaS0+bGFu
ZXMgPiA0KSB7Cj4gLSAgICAgICAgICAgICAgIERSTV9FUlJPUigiZHNpIGRldmljZSBwYXJhbXMg
aW52YWxpZFxuIik7Cj4gLSAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwo+IC0gICAgICAg
fQo+IC0KPiAtICAgICAgIGRzaS0+bGFuZXMgPSBtZHNpLT5sYW5lczsKPiAtICAgICAgIGRzaS0+
Zm9ybWF0ID0gbWRzaS0+Zm9ybWF0Owo+IC0gICAgICAgZHNpLT5tb2RlX2ZsYWdzID0gbWRzaS0+
bW9kZV9mbGFnczsKPiAtCj4gLSAgICAgICByZXR1cm4gMDsKPiAtfQo+IC0KPiAtc3RhdGljIGlu
dCBkc2lfaG9zdF9kZXRhY2goc3RydWN0IG1pcGlfZHNpX2hvc3QgKmhvc3QsCj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IG1pcGlfZHNpX2RldmljZSAqbWRzaSkKPiAtewo+IC0g
ICAgICAgLyogZG8gbm90aGluZyAqLwo+IC0gICAgICAgcmV0dXJuIDA7Cj4gLX0KPiAtCj4gLXN0
YXRpYyBjb25zdCBzdHJ1Y3QgbWlwaV9kc2lfaG9zdF9vcHMgZHNpX2hvc3Rfb3BzID0gewo+IC0g
ICAgICAgLmF0dGFjaCA9IGRzaV9ob3N0X2F0dGFjaCwKPiAtICAgICAgIC5kZXRhY2ggPSBkc2lf
aG9zdF9kZXRhY2gsCj4gLX07Cj4gLQo+IC1zdGF0aWMgaW50IGRzaV9ob3N0X2luaXQoc3RydWN0
IGRldmljZSAqZGV2LCBzdHJ1Y3QgZHdfZHNpICpkc2kpCj4gLXsKPiAtICAgICAgIHN0cnVjdCBt
aXBpX2RzaV9ob3N0ICpob3N0ID0gJmRzaS0+aG9zdDsKPiAtICAgICAgIGludCByZXQ7Cj4gLQo+
IC0gICAgICAgaG9zdC0+ZGV2ID0gZGV2Owo+IC0gICAgICAgaG9zdC0+b3BzID0gJmRzaV9ob3N0
X29wczsKPiAtICAgICAgIHJldCA9IG1pcGlfZHNpX2hvc3RfcmVnaXN0ZXIoaG9zdCk7Cj4gLSAg
ICAgICBpZiAocmV0KSB7Cj4gLSAgICAgICAgICAgICAgIERSTV9FUlJPUigiZmFpbGVkIHRvIHJl
Z2lzdGVyIGRzaSBob3N0XG4iKTsKPiAtICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKPiAtICAg
ICAgIH0KPiAtCj4gLSAgICAgICByZXR1cm4gMDsKPiAtfQo+IC0KPiAgc3RhdGljIGludCBkc2lf
YnJpZGdlX2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgc3RydWN0IGR3X2RzaSAqZHNpKQo+
ICB7Cj4gICAgICAgICBzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIgPSAmZHNpLT5lbmNvZGVy
Owo+IEBAIC03OTYsMTAgKzc1Miw2IEBAIHN0YXRpYyBpbnQgZHNpX2JpbmQoc3RydWN0IGRldmlj
ZSAqZGV2LCBzdHJ1Y3QgZGV2aWNlICptYXN0ZXIsIHZvaWQgKmRhdGEpCj4gICAgICAgICBpZiAo
cmV0KQo+ICAgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+Cj4gLSAgICAgICByZXQgPSBkc2lf
aG9zdF9pbml0KGRldiwgZHNpKTsKPiAtICAgICAgIGlmIChyZXQpCj4gLSAgICAgICAgICAgICAg
IHJldHVybiByZXQ7Cj4gLQo+ICAgICAgICAgcmV0ID0gZHNpX2JyaWRnZV9pbml0KGRybV9kZXYs
IGRzaSk7Cj4gICAgICAgICBpZiAocmV0KQo+ICAgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+
IEBAIC04MTcsMTMgKzc2OSwyMiBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGNvbXBvbmVudF9vcHMg
ZHNpX29wcyA9IHsKPiAgICAgICAgIC51bmJpbmQgPSBkc2lfdW5iaW5kLAo+ICB9Owo+Cj4gLXN0
YXRpYyBpbnQgZHNpX3BhcnNlX2R0KHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYsIHN0cnVj
dCBkd19kc2kgKmRzaSkKPiArc3RhdGljIGludCBkc2lfaG9zdF9hdHRhY2goc3RydWN0IG1pcGlf
ZHNpX2hvc3QgKmhvc3QsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IG1pcGlf
ZHNpX2RldmljZSAqbWRzaSkKPiAgewo+IC0gICAgICAgc3RydWN0IGRzaV9od19jdHggKmN0eCA9
IGRzaS0+Y3R4Owo+IC0gICAgICAgc3RydWN0IGRldmljZV9ub2RlICpucCA9IHBkZXYtPmRldi5v
Zl9ub2RlOwo+IC0gICAgICAgc3RydWN0IHJlc291cmNlICpyZXM7Cj4gKyAgICAgICBzdHJ1Y3Qg
ZHdfZHNpICpkc2kgPSBob3N0X3RvX2RzaShob3N0KTsKPiArICAgICAgIHN0cnVjdCBkZXZpY2Vf
bm9kZSAqbnAgPSBkc2ktPmRldi0+b2Zfbm9kZTsKPiAgICAgICAgIGludCByZXQ7Cj4KPiArICAg
ICAgIGlmIChtZHNpLT5sYW5lcyA8IDEgfHwgbWRzaS0+bGFuZXMgPiA0KSB7Cj4gKyAgICAgICAg
ICAgICAgIERSTV9FUlJPUigiZHNpIGRldmljZSBwYXJhbXMgaW52YWxpZFxuIik7Cj4gKyAgICAg
ICAgICAgICAgIHJldHVybiAtRUlOVkFMOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGRzaS0+
bGFuZXMgPSBtZHNpLT5sYW5lczsKPiArICAgICAgIGRzaS0+Zm9ybWF0ID0gbWRzaS0+Zm9ybWF0
Owo+ICsgICAgICAgZHNpLT5tb2RlX2ZsYWdzID0gbWRzaS0+bW9kZV9mbGFnczsKPiArCj4gICAg
ICAgICAvKgo+ICAgICAgICAgICogR2V0IHRoZSBlbmRwb2ludCBub2RlLiBJbiBvdXIgY2FzZSwg
ZHNpIGhhcyBvbmUgb3V0cHV0IHBvcnQxCj4gICAgICAgICAgKiB0byB3aGljaCB0aGUgZXh0ZXJu
YWwgSERNSSBicmlkZ2UgaXMgY29ubmVjdGVkLgo+IEBAIC04MzIsNiArNzkzLDQyIEBAIHN0YXRp
YyBpbnQgZHNpX3BhcnNlX2R0KHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYsIHN0cnVjdCBk
d19kc2kgKmRzaSkKPiAgICAgICAgIGlmIChyZXQpCj4gICAgICAgICAgICAgICAgIHJldHVybiBy
ZXQ7Cj4KPiArICAgICAgIHJldHVybiBjb21wb25lbnRfYWRkKGRzaS0+ZGV2LCAmZHNpX29wcyk7
Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgZHNpX2hvc3RfZGV0YWNoKHN0cnVjdCBtaXBpX2RzaV9o
b3N0ICpob3N0LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBtaXBpX2RzaV9k
ZXZpY2UgKm1kc2kpCj4gK3sKPiArICAgICAgIC8qIGRvIG5vdGhpbmcgKi8KPiArICAgICAgIHJl
dHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgY29uc3Qgc3RydWN0IG1pcGlfZHNpX2hvc3Rfb3Bz
IGRzaV9ob3N0X29wcyA9IHsKPiArICAgICAgIC5hdHRhY2ggPSBkc2lfaG9zdF9hdHRhY2gsCj4g
KyAgICAgICAuZGV0YWNoID0gZHNpX2hvc3RfZGV0YWNoLAo+ICt9Owo+ICsKPiArc3RhdGljIGlu
dCBkc2lfaG9zdF9pbml0KHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGR3X2RzaSAqZHNpKQo+
ICt7Cj4gKyAgICAgICBzdHJ1Y3QgbWlwaV9kc2lfaG9zdCAqaG9zdCA9ICZkc2ktPmhvc3Q7Cj4g
KyAgICAgICBpbnQgcmV0Owo+ICsKPiArICAgICAgIGhvc3QtPmRldiA9IGRldjsKPiArICAgICAg
IGhvc3QtPm9wcyA9ICZkc2lfaG9zdF9vcHM7Cj4gKyAgICAgICByZXQgPSBtaXBpX2RzaV9ob3N0
X3JlZ2lzdGVyKGhvc3QpOwo+ICsgICAgICAgaWYgKHJldCkgewo+ICsgICAgICAgICAgICAgICBE
Uk1fRVJST1IoImZhaWxlZCB0byByZWdpc3RlciBkc2kgaG9zdFxuIik7Cj4gKyAgICAgICAgICAg
ICAgIHJldHVybiByZXQ7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgcmV0dXJuIDA7Cj4gK30K
PiArCj4gK3N0YXRpYyBpbnQgZHNpX3BhcnNlX2R0KHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBk
ZXYsIHN0cnVjdCBkd19kc2kgKmRzaSkKPiArewo+ICsgICAgICAgc3RydWN0IGRzaV9od19jdHgg
KmN0eCA9IGRzaS0+Y3R4Owo+ICsgICAgICAgc3RydWN0IHJlc291cmNlICpyZXM7Cj4gKwo+ICAg
ICAgICAgY3R4LT5wY2xrID0gZGV2bV9jbGtfZ2V0KCZwZGV2LT5kZXYsICJwY2xrIik7Cj4gICAg
ICAgICBpZiAoSVNfRVJSKGN0eC0+cGNsaykpIHsKPiAgICAgICAgICAgICAgICAgRFJNX0VSUk9S
KCJmYWlsZWQgdG8gZ2V0IHBjbGsgY2xvY2tcbiIpOwo+IEBAIC04NjIsMTUgKzg1OSwxOSBAQCBz
dGF0aWMgaW50IGRzaV9wcm9iZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQo+ICAgICAg
ICAgfQo+ICAgICAgICAgZHNpID0gJmRhdGEtPmRzaTsKPiAgICAgICAgIGN0eCA9ICZkYXRhLT5j
dHg7Cj4gKyAgICAgICBkc2ktPmRldiA9ICZwZGV2LT5kZXY7Cj4gICAgICAgICBkc2ktPmN0eCA9
IGN0eDsKPgo+ICAgICAgICAgcmV0ID0gZHNpX3BhcnNlX2R0KHBkZXYsIGRzaSk7Cj4gICAgICAg
ICBpZiAocmV0KQo+ICAgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+Cj4gLSAgICAgICBwbGF0
Zm9ybV9zZXRfZHJ2ZGF0YShwZGV2LCBkYXRhKTsKPiArICAgICAgIHJldCA9IGRzaV9ob3N0X2lu
aXQoJnBkZXYtPmRldiwgZHNpKTsKPiArICAgICAgIGlmIChyZXQpCj4gKyAgICAgICAgICAgICAg
IHJldHVybiByZXQ7Cj4KPiAtICAgICAgIHJldHVybiBjb21wb25lbnRfYWRkKCZwZGV2LT5kZXYs
ICZkc2lfb3BzKTsKPiArICAgICAgIHBsYXRmb3JtX3NldF9kcnZkYXRhKHBkZXYsIGRhdGEpOwo+
ICsgICAgICAgcmV0dXJuIDA7Cj4gIH0KPgo+ICBzdGF0aWMgaW50IGRzaV9yZW1vdmUoc3RydWN0
IHBsYXRmb3JtX2RldmljZSAqcGRldikKPiAtLQo+IDIuMTcuMQo+Cj4gX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KPiBkcmktZGV2ZWwgbWFpbGluZyBsaXN0
Cj4gZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwo+IGh0dHBzOi8vbGlzdHMuZnJlZWRl
c2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVsCl9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRl
dmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9t
YWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
