Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id BB72135EDC
	for <lists+dri-devel@lfdr.de>; Wed,  5 Jun 2019 16:13:47 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6E4BC89B66;
	Wed,  5 Jun 2019 14:13:45 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-lj1-x241.google.com (mail-lj1-x241.google.com
 [IPv6:2a00:1450:4864:20::241])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 033E389B66
 for <dri-devel@lists.freedesktop.org>; Wed,  5 Jun 2019 14:13:44 +0000 (UTC)
Received: by mail-lj1-x241.google.com with SMTP id m15so14991529ljg.13
 for <dri-devel@lists.freedesktop.org>; Wed, 05 Jun 2019 07:13:43 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:sender:from:to:cc:subject:date:message-id
 :in-reply-to:references:mime-version:content-transfer-encoding;
 bh=ox0ECNm2cCcFChVy6Ha/d7zAhnBPXRCPgNm9RBGebOE=;
 b=R1Nytr1r2R+yz1zjwqyZZWXmM5XGCZxfFfphytGQbj1U44oe46WCOrPJCeDh2y4sHt
 dAD3d/PJ3h5o8pOZkwSK5ElEy0GKHgMZKnioOq2cTcdQqxT0QbNrXf0rU0SVg80E82n7
 7xHxcKla4pJQFD9ZTXlzlfddjkxATlEuyCPuY9ZQ2u6pWce1JLf2AS2xEg7oFixdUSU+
 A54RhAt99V1i0UKI1sGiUMHb/66ZB4EfqOElnCinatMdZnTjxcim2A2lK/4GiGbibW6e
 7OH8tBA+QgbPVy+zuGTme2iwt45o1V7pbXiZK12r2jGg1IaSxaAUZiLdX/KL6DchOSpz
 U7ig==
X-Gm-Message-State: APjAAAVUAPFzIQ4Gi1mVh83rtvD+vK4Kyu0Z3nEF/LJmHzf/CCMEWN/7
 v7ZkJj7D/28zmcESG6yBMwukdbTOpFA=
X-Google-Smtp-Source: APXvYqzI5dHLwsK7HMCXfolHbqFEyNDaUDPDVcR6mbHRWR1yFmXzOeH7e0jv6ZPWBAzQxAjQmm90NQ==
X-Received: by 2002:a2e:5341:: with SMTP id t1mr11672166ljd.170.1559744022020; 
 Wed, 05 Jun 2019 07:13:42 -0700 (PDT)
Received: from saturn.lan (18.158-248-194.customer.lyse.net. [158.248.194.18])
 by smtp.gmail.com with ESMTPSA id
 f30sm4261675lfa.48.2019.06.05.07.13.41
 (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
 Wed, 05 Jun 2019 07:13:41 -0700 (PDT)
From: Sam Ravnborg <sam@ravnborg.org>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v1 1/2] drm/r128: drop drm_os_linux dependencies
Date: Wed,  5 Jun 2019 16:13:20 +0200
Message-Id: <20190605141321.17819-2-sam@ravnborg.org>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190605141321.17819-1-sam@ravnborg.org>
References: <20190605141321.17819-1-sam@ravnborg.org>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=sender:from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=ox0ECNm2cCcFChVy6Ha/d7zAhnBPXRCPgNm9RBGebOE=;
 b=IryTGk2Lsp6rME6WUHC7iMMLXQVL1UMfBuWNeQIq/0P3oujBxsV6iyMHCwz0CRCSnE
 wjViwarrT3NwpMIyuPS+z6zeIRQ1+a+MoFmvqvHtGfHyergJOEHfb6a/3B/pgzbeUlm3
 VytwIV2sYJe/WlxueOGrbkrjiVK/2WIspJHuVhBuhwaZZHVvUBc7TRHqw6ugPpTHCI1h
 ku+ISOfodPg9gwtsrsHoKrYtPCn/M+PYPK2YkTtAzgszSAbOxEkaXDBMgJzcc1dDD+WB
 wGseqYHkExkfqY1sDXBqBh9xNtYFbmvHR3Nf/RhYwdnle/fVUZulcoSRMhlKdPGPv+S2
 lgug==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: David Airlie <airlied@linux.ie>, Sam Ravnborg <sam@ravnborg.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RHJvcCB1c2Ugb2YgZHJtX29zX2xpbnV4IG1hY3Jvcy4KClNpbXBsZSAxOjEgcmVwbGFjZW1lbnRz
IG9mCi0gRFJNX1VERUxBWQotIERSTV9DVVJSRU5UUElECi0gRFJNX1JFQUQKLSBEUk1fV1JJVEUK
CldpdGggdGhpcyBjaGFuZ2Ugd2UgZG8gbm90IG5lZWQgdG8gaW50cm9kdWNlIHRoZSBkZXByZWNh
dGVkCmRybV9vc19saW51eC5oIGhlYWRlciB3aGVuIHdlIGRyb3AgdXNlIG9mIGRybVAuaC4KClNp
Z25lZC1vZmYtYnk6IFNhbSBSYXZuYm9yZyA8c2FtQHJhdm5ib3JnLm9yZz4KQ2M6IERhdmlkIEFp
cmxpZSA8YWlybGllZEBsaW51eC5pZT4KQ2M6IERhbmllbCBWZXR0ZXIgPGRhbmllbEBmZndsbC5j
aD4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vcjEyOC9yMTI4X2NjZS5jICAgfCAxNiArKysrKysrKy0t
LS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vcjEyOC9yMTI4X2Rydi5oICAgfCAxMCArKysrKy0tLS0t
CiBkcml2ZXJzL2dwdS9kcm0vcjEyOC9yMTI4X3N0YXRlLmMgfCAxNiArKysrKysrKy0tLS0tLS0t
CiAzIGZpbGVzIGNoYW5nZWQsIDIxIGluc2VydGlvbnMoKyksIDIxIGRlbGV0aW9ucygtKQoKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yMTI4L3IxMjhfY2NlLmMgYi9kcml2ZXJzL2dwdS9k
cm0vcjEyOC9yMTI4X2NjZS5jCmluZGV4IGI5MWFmMWJmNTMxYi4uNmY0MjZiYjA2OTM0IDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcjEyOC9yMTI4X2NjZS5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9yMTI4L3IxMjhfY2NlLmMKQEAgLTg1LDcgKzg1LDcgQEAgc3RhdGljIGludCByMTI4X2Rv
X3BpeGNhY2hlX2ZsdXNoKGRybV9yMTI4X3ByaXZhdGVfdCAqZGV2X3ByaXYpCiAJZm9yIChpID0g
MDsgaSA8IGRldl9wcml2LT51c2VjX3RpbWVvdXQ7IGkrKykgewogCQlpZiAoIShSMTI4X1JFQUQo
UjEyOF9QQ19OR1VJX0NUTFNUQVQpICYgUjEyOF9QQ19CVVNZKSkKIAkJCXJldHVybiAwOwotCQlE
Uk1fVURFTEFZKDEpOworCQl1ZGVsYXkoMSk7CiAJfQogCiAjaWYgUjEyOF9GSUZPX0RFQlVHCkBA
IC0xMDIsNyArMTAyLDcgQEAgc3RhdGljIGludCByMTI4X2RvX3dhaXRfZm9yX2ZpZm8oZHJtX3Ix
MjhfcHJpdmF0ZV90ICpkZXZfcHJpdiwgaW50IGVudHJpZXMpCiAJCWludCBzbG90cyA9IFIxMjhf
UkVBRChSMTI4X0dVSV9TVEFUKSAmIFIxMjhfR1VJX0ZJRk9DTlRfTUFTSzsKIAkJaWYgKHNsb3Rz
ID49IGVudHJpZXMpCiAJCQlyZXR1cm4gMDsKLQkJRFJNX1VERUxBWSgxKTsKKwkJdWRlbGF5KDEp
OwogCX0KIAogI2lmIFIxMjhfRklGT19ERUJVRwpAQCAtMTI0LDcgKzEyNCw3IEBAIHN0YXRpYyBp
bnQgcjEyOF9kb193YWl0X2Zvcl9pZGxlKGRybV9yMTI4X3ByaXZhdGVfdCAqZGV2X3ByaXYpCiAJ
CQlyMTI4X2RvX3BpeGNhY2hlX2ZsdXNoKGRldl9wcml2KTsKIAkJCXJldHVybiAwOwogCQl9Ci0J
CURSTV9VREVMQVkoMSk7CisJCXVkZWxheSgxKTsKIAl9CiAKICNpZiBSMTI4X0ZJRk9fREVCVUcK
QEAgLTIxMSw3ICsyMTEsNyBAQCBpbnQgcjEyOF9kb19jY2VfaWRsZShkcm1fcjEyOF9wcml2YXRl
X3QgKmRldl9wcml2KQogCQkJCXJldHVybiByMTI4X2RvX3BpeGNhY2hlX2ZsdXNoKGRldl9wcml2
KTsKIAkJCX0KIAkJfQotCQlEUk1fVURFTEFZKDEpOworCQl1ZGVsYXkoMSk7CiAJfQogCiAjaWYg
UjEyOF9GSUZPX0RFQlVHCkBAIC04MzgsNyArODM4LDcgQEAgc3RhdGljIHN0cnVjdCBkcm1fYnVm
ICpyMTI4X2ZyZWVsaXN0X2dldChzdHJ1Y3QgZHJtX2RldmljZSAqIGRldikKIAkJCQlyZXR1cm4g
YnVmOwogCQkJfQogCQl9Ci0JCURSTV9VREVMQVkoMSk7CisJCXVkZWxheSgxKTsKIAl9CiAKIAlE
Uk1fREVCVUcoInJldHVybmluZyBOVUxMIVxuIik7CkBAIC04NzAsNyArODcwLDcgQEAgaW50IHIx
Mjhfd2FpdF9yaW5nKGRybV9yMTI4X3ByaXZhdGVfdCAqZGV2X3ByaXYsIGludCBuKQogCQlyMTI4
X3VwZGF0ZV9yaW5nX3NuYXBzaG90KGRldl9wcml2KTsKIAkJaWYgKHJpbmctPnNwYWNlID49IG4p
CiAJCQlyZXR1cm4gMDsKLQkJRFJNX1VERUxBWSgxKTsKKwkJdWRlbGF5KDEpOwogCX0KIAogCS8q
IEZJWE1FOiBUaGlzIGlzIGJlaW5nIGlnbm9yZWQuLi4gKi8KQEAgLTkxNiw3ICs5MTYsNyBAQCBp
bnQgcjEyOF9jY2VfYnVmZmVycyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLCBz
dHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcAogCSAqLwogCWlmIChkLT5zZW5kX2NvdW50ICE9IDApIHsK
IAkJRFJNX0VSUk9SKCJQcm9jZXNzICVkIHRyeWluZyB0byBzZW5kICVkIGJ1ZmZlcnMgdmlhIGRy
bURNQVxuIiwKLQkJCSAgRFJNX0NVUlJFTlRQSUQsIGQtPnNlbmRfY291bnQpOworCQkJICB0YXNr
X3BpZF9ucihjdXJyZW50KSwgZC0+c2VuZF9jb3VudCk7CiAJCXJldHVybiAtRUlOVkFMOwogCX0K
IApAQCAtOTI0LDcgKzkyNCw3IEBAIGludCByMTI4X2NjZV9idWZmZXJzKHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYsIHZvaWQgKmRhdGEsIHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wCiAJICovCiAJaWYg
KGQtPnJlcXVlc3RfY291bnQgPCAwIHx8IGQtPnJlcXVlc3RfY291bnQgPiBkbWEtPmJ1Zl9jb3Vu
dCkgewogCQlEUk1fRVJST1IoIlByb2Nlc3MgJWQgdHJ5aW5nIHRvIGdldCAlZCBidWZmZXJzIChv
ZiAlZCBtYXgpXG4iLAotCQkJICBEUk1fQ1VSUkVOVFBJRCwgZC0+cmVxdWVzdF9jb3VudCwgZG1h
LT5idWZfY291bnQpOworCQkJICB0YXNrX3BpZF9ucihjdXJyZW50KSwgZC0+cmVxdWVzdF9jb3Vu
dCwgZG1hLT5idWZfY291bnQpOwogCQlyZXR1cm4gLUVJTlZBTDsKIAl9CiAKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9yMTI4L3IxMjhfZHJ2LmggYi9kcml2ZXJzL2dwdS9kcm0vcjEyOC9y
MTI4X2Rydi5oCmluZGV4IDJkZTQwZDI3NjExNi4uMTE1YmIyODZkZDJhIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vcjEyOC9yMTI4X2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yMTI4
L3IxMjhfZHJ2LmgKQEAgLTM5NywxMCArMzk3LDEwIEBAIGV4dGVybiBsb25nIHIxMjhfY29tcGF0
X2lvY3RsKHN0cnVjdCBmaWxlICpmaWxwLCB1bnNpZ25lZCBpbnQgY21kLAogCiAjZGVmaW5lIFIx
MjhfUENJR0FSVF9UQUJMRV9TSVpFICAgICAgICAgMzI3NjgKIAotI2RlZmluZSBSMTI4X1JFQUQo
cmVnKQkJRFJNX1JFQUQzMihkZXZfcHJpdi0+bW1pbywgKHJlZykpCi0jZGVmaW5lIFIxMjhfV1JJ
VEUocmVnLCB2YWwpCURSTV9XUklURTMyKGRldl9wcml2LT5tbWlvLCAocmVnKSwgKHZhbCkpCi0j
ZGVmaW5lIFIxMjhfUkVBRDgocmVnKQkJRFJNX1JFQUQ4KGRldl9wcml2LT5tbWlvLCAocmVnKSkK
LSNkZWZpbmUgUjEyOF9XUklURTgocmVnLCB2YWwpCURSTV9XUklURTgoZGV2X3ByaXYtPm1taW8s
IChyZWcpLCAodmFsKSkKKyNkZWZpbmUgUjEyOF9SRUFEKHJlZykJCXJlYWRsKCgodm9pZCBfX2lv
bWVtICopZGV2X3ByaXYtPm1taW8tPmhhbmRsZSkgKyAocmVnKSkKKyNkZWZpbmUgUjEyOF9XUklU
RShyZWcsIHZhbCkJd3JpdGVsKHZhbCwgKCh2b2lkIF9faW9tZW0gKilkZXZfcHJpdi0+bW1pby0+
aGFuZGxlKSArIChyZWcpKQorI2RlZmluZSBSMTI4X1JFQUQ4KHJlZykJCXJlYWRiKCgodm9pZCBf
X2lvbWVtICopZGV2X3ByaXYtPm1taW8tPmhhbmRsZSkgKyAocmVnKSkKKyNkZWZpbmUgUjEyOF9X
UklURTgocmVnLCB2YWwpCXdyaXRlYih2YWwsICgodm9pZCBfX2lvbWVtICopZGV2X3ByaXYtPm1t
aW8tPmhhbmRsZSkgKyAocmVnKSkKIAogI2RlZmluZSBSMTI4X1dSSVRFX1BMTChhZGRyLCB2YWwp
CQkJCQlcCiBkbyB7CQkJCQkJCQkJXApAQCAtNDQ1LDcgKzQ0NSw3IEBAIGRvIHsJCQkJCQkJCQlc
CiAJCQlyMTI4X3VwZGF0ZV9yaW5nX3NuYXBzaG90KGRldl9wcml2KTsJCVwKIAkJCWlmIChyaW5n
LT5zcGFjZSA+PSByaW5nLT5oaWdoX21hcmspCQlcCiAJCQkJZ290byBfX3Jpbmdfc3BhY2VfZG9u
ZTsJCQlcCi0JCQlEUk1fVURFTEFZKDEpOwkJCQkJXAorCQkJdWRlbGF5KDEpOwkJCQkJXAogCQl9
CQkJCQkJCVwKIAkJRFJNX0VSUk9SKCJyaW5nIHNwYWNlIGNoZWNrIGZhaWxlZCFcbiIpOwkJXAog
CQlyZXR1cm4gLUVCVVNZOwkJCQkJCVwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yMTI4
L3IxMjhfc3RhdGUuYyBiL2RyaXZlcnMvZ3B1L2RybS9yMTI4L3IxMjhfc3RhdGUuYwppbmRleCBi
OWJmYTgwNmQzNDYuLjI1MzVlYThkMmQ5YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Ix
MjgvcjEyOF9zdGF0ZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yMTI4L3IxMjhfc3RhdGUuYwpA
QCAtODI0LDcgKzgyNCw3IEBAIHN0YXRpYyBpbnQgcjEyOF9jY2VfZGlzcGF0Y2hfYmxpdChzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2LAogCiAJaWYgKGJ1Zi0+ZmlsZV9wcml2ICE9IGZpbGVfcHJpdikg
ewogCQlEUk1fRVJST1IoInByb2Nlc3MgJWQgdXNpbmcgYnVmZmVyIG93bmVkIGJ5ICVwXG4iLAot
CQkJICBEUk1fQ1VSUkVOVFBJRCwgYnVmLT5maWxlX3ByaXYpOworCQkJICB0YXNrX3BpZF9ucihj
dXJyZW50KSwgYnVmLT5maWxlX3ByaXYpOwogCQlyZXR1cm4gLUVJTlZBTDsKIAl9CiAJaWYgKGJ1
Zi0+cGVuZGluZykgewpAQCAtMTMxNyw3ICsxMzE3LDcgQEAgc3RhdGljIGludCByMTI4X2NjZV92
ZXJ0ZXgoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwgc3RydWN0IGRybV9maWxl
ICoKIAlERVZfSU5JVF9URVNUX1dJVEhfUkVUVVJOKGRldl9wcml2KTsKIAogCURSTV9ERUJVRygi
cGlkPSVkIGluZGV4PSVkIGNvdW50PSVkIGRpc2NhcmQ9JWRcbiIsCi0JCSAgRFJNX0NVUlJFTlRQ
SUQsIHZlcnRleC0+aWR4LCB2ZXJ0ZXgtPmNvdW50LCB2ZXJ0ZXgtPmRpc2NhcmQpOworCQkgIHRh
c2tfcGlkX25yKGN1cnJlbnQpLCB2ZXJ0ZXgtPmlkeCwgdmVydGV4LT5jb3VudCwgdmVydGV4LT5k
aXNjYXJkKTsKIAogCWlmICh2ZXJ0ZXgtPmlkeCA8IDAgfHwgdmVydGV4LT5pZHggPj0gZG1hLT5i
dWZfY291bnQpIHsKIAkJRFJNX0VSUk9SKCJidWZmZXIgaW5kZXggJWQgKG9mICVkIG1heClcbiIs
CkBAIC0xMzM4LDcgKzEzMzgsNyBAQCBzdGF0aWMgaW50IHIxMjhfY2NlX3ZlcnRleChzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLCBzdHJ1Y3QgZHJtX2ZpbGUgKgogCiAJaWYgKGJ1
Zi0+ZmlsZV9wcml2ICE9IGZpbGVfcHJpdikgewogCQlEUk1fRVJST1IoInByb2Nlc3MgJWQgdXNp
bmcgYnVmZmVyIG93bmVkIGJ5ICVwXG4iLAotCQkJICBEUk1fQ1VSUkVOVFBJRCwgYnVmLT5maWxl
X3ByaXYpOworCQkJICB0YXNrX3BpZF9ucihjdXJyZW50KSwgYnVmLT5maWxlX3ByaXYpOwogCQly
ZXR1cm4gLUVJTlZBTDsKIAl9CiAJaWYgKGJ1Zi0+cGVuZGluZykgewpAQCAtMTM2OSw3ICsxMzY5
LDcgQEAgc3RhdGljIGludCByMTI4X2NjZV9pbmRpY2VzKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYs
IHZvaWQgKmRhdGEsIHN0cnVjdCBkcm1fZmlsZQogCiAJREVWX0lOSVRfVEVTVF9XSVRIX1JFVFVS
TihkZXZfcHJpdik7CiAKLQlEUk1fREVCVUcoInBpZD0lZCBidWY9JWQgcz0lZCBlPSVkIGQ9JWRc
biIsIERSTV9DVVJSRU5UUElELAorCURSTV9ERUJVRygicGlkPSVkIGJ1Zj0lZCBzPSVkIGU9JWQg
ZD0lZFxuIiwgdGFza19waWRfbnIoY3VycmVudCksCiAJCSAgZWx0cy0+aWR4LCBlbHRzLT5zdGFy
dCwgZWx0cy0+ZW5kLCBlbHRzLT5kaXNjYXJkKTsKIAogCWlmIChlbHRzLT5pZHggPCAwIHx8IGVs
dHMtPmlkeCA+PSBkbWEtPmJ1Zl9jb3VudCkgewpAQCAtMTM5MSw3ICsxMzkxLDcgQEAgc3RhdGlj
IGludCByMTI4X2NjZV9pbmRpY2VzKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEs
IHN0cnVjdCBkcm1fZmlsZQogCiAJaWYgKGJ1Zi0+ZmlsZV9wcml2ICE9IGZpbGVfcHJpdikgewog
CQlEUk1fRVJST1IoInByb2Nlc3MgJWQgdXNpbmcgYnVmZmVyIG93bmVkIGJ5ICVwXG4iLAotCQkJ
ICBEUk1fQ1VSUkVOVFBJRCwgYnVmLT5maWxlX3ByaXYpOworCQkJICB0YXNrX3BpZF9ucihjdXJy
ZW50KSwgYnVmLT5maWxlX3ByaXYpOwogCQlyZXR1cm4gLUVJTlZBTDsKIAl9CiAJaWYgKGJ1Zi0+
cGVuZGluZykgewpAQCAtMTQzMiw3ICsxNDMyLDcgQEAgc3RhdGljIGludCByMTI4X2NjZV9ibGl0
KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsIHN0cnVjdCBkcm1fZmlsZSAqZmkK
IAogCURFVl9JTklUX1RFU1RfV0lUSF9SRVRVUk4oZGV2X3ByaXYpOwogCi0JRFJNX0RFQlVHKCJw
aWQ9JWQgaW5kZXg9JWRcbiIsIERSTV9DVVJSRU5UUElELCBibGl0LT5pZHgpOworCURSTV9ERUJV
RygicGlkPSVkIGluZGV4PSVkXG4iLCB0YXNrX3BpZF9ucihjdXJyZW50KSwgYmxpdC0+aWR4KTsK
IAogCWlmIChibGl0LT5pZHggPCAwIHx8IGJsaXQtPmlkeCA+PSBkbWEtPmJ1Zl9jb3VudCkgewog
CQlEUk1fRVJST1IoImJ1ZmZlciBpbmRleCAlZCAob2YgJWQgbWF4KVxuIiwKQEAgLTE1MzIsNyAr
MTUzMiw3IEBAIHN0YXRpYyBpbnQgcjEyOF9jY2VfaW5kaXJlY3Qoc3RydWN0IGRybV9kZXZpY2Ug
KmRldiwgdm9pZCAqZGF0YSwgc3RydWN0IGRybV9maWxlCiAKIAlpZiAoYnVmLT5maWxlX3ByaXYg
IT0gZmlsZV9wcml2KSB7CiAJCURSTV9FUlJPUigicHJvY2VzcyAlZCB1c2luZyBidWZmZXIgb3du
ZWQgYnkgJXBcbiIsCi0JCQkgIERSTV9DVVJSRU5UUElELCBidWYtPmZpbGVfcHJpdik7CisJCQkg
IHRhc2tfcGlkX25yKGN1cnJlbnQpLCBidWYtPmZpbGVfcHJpdik7CiAJCXJldHVybiAtRUlOVkFM
OwogCX0KIAlpZiAoYnVmLT5wZW5kaW5nKSB7CkBAIC0xNTc5LDcgKzE1NzksNyBAQCBpbnQgcjEy
OF9nZXRwYXJhbShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLCBzdHJ1Y3QgZHJt
X2ZpbGUgKmZpbGVfcHJpdgogCiAJREVWX0lOSVRfVEVTVF9XSVRIX1JFVFVSTihkZXZfcHJpdik7
CiAKLQlEUk1fREVCVUcoInBpZD0lZFxuIiwgRFJNX0NVUlJFTlRQSUQpOworCURSTV9ERUJVRygi
cGlkPSVkXG4iLCB0YXNrX3BpZF9ucihjdXJyZW50KSk7CiAKIAlzd2l0Y2ggKHBhcmFtLT5wYXJh
bSkgewogCWNhc2UgUjEyOF9QQVJBTV9JUlFfTlI6Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QK
ZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9w
Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
