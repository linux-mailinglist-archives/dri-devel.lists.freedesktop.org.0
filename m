Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 5690C7EBFD
	for <lists+dri-devel@lfdr.de>; Fri,  2 Aug 2019 07:23:23 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CB5D96E8C2;
	Fri,  2 Aug 2019 05:23:00 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E39A36E8AD
 for <dri-devel@lists.freedesktop.org>; Fri,  2 Aug 2019 05:22:56 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx05.intmail.prod.int.phx2.redhat.com
 [10.5.11.15])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 722F331CD7F;
 Fri,  2 Aug 2019 05:22:56 +0000 (UTC)
Received: from sirius.home.kraxel.org (ovpn-116-81.ams2.redhat.com
 [10.36.116.81])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 57F9D5D713;
 Fri,  2 Aug 2019 05:22:54 +0000 (UTC)
Received: by sirius.home.kraxel.org (Postfix, from userid 1000)
 id 015E29D14; Fri,  2 Aug 2019 07:22:51 +0200 (CEST)
From: Gerd Hoffmann <kraxel@redhat.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v4 12/17] drm/vmwgfx: switch driver from bo->resv to
 bo->base.resv
Date: Fri,  2 Aug 2019 07:22:42 +0200
Message-Id: <20190802052247.18427-13-kraxel@redhat.com>
In-Reply-To: <20190802052247.18427-1-kraxel@redhat.com>
References: <20190802052247.18427-1-kraxel@redhat.com>
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.15
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.29]); Fri, 02 Aug 2019 05:22:56 +0000 (UTC)
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Hellstrom <thellstrom@vmware.com>, thomas@shipmail.org,
 tzimmermann@suse.de, David Airlie <airlied@linux.ie>,
 ckoenig.leichtzumerken@gmail.com, open list <linux-kernel@vger.kernel.org>,
 VMware Graphics <linux-graphics-maintainer@vmware.com>,
 Gerd Hoffmann <kraxel@redhat.com>, bskeggs@redhat.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

U2lnbmVkLW9mZi1ieTogR2VyZCBIb2ZmbWFubiA8a3JheGVsQHJlZGhhdC5jb20+Ci0tLQogZHJp
dmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfYmxpdC5jICAgICB8IDQgKystLQogZHJpdmVycy9n
cHUvZHJtL3Ztd2dmeC92bXdnZnhfYm8uYyAgICAgICB8IDggKysrKy0tLS0KIGRyaXZlcnMvZ3B1
L2RybS92bXdnZngvdm13Z2Z4X2NvdGFibGUuYyAgfCA0ICsrLS0KIGRyaXZlcnMvZ3B1L2RybS92
bXdnZngvdm13Z2Z4X3Jlc291cmNlLmMgfCA2ICsrKy0tLQogNCBmaWxlcyBjaGFuZ2VkLCAxMSBp
bnNlcnRpb25zKCspLCAxMSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vdm13Z2Z4L3Ztd2dmeF9ibGl0LmMgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9i
bGl0LmMKaW5kZXggZmM2NjczY2RlMjg5Li45MTdlZWI3OTM1ODUgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2JsaXQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdm13
Z2Z4L3Ztd2dmeF9ibGl0LmMKQEAgLTQ1OSw5ICs0NTksOSBAQCBpbnQgdm13X2JvX2NwdV9ibGl0
KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqZHN0LAogCiAJLyogQnVmZmVyIG9iamVjdHMgbmVl
ZCB0byBiZSBlaXRoZXIgcGlubmVkIG9yIHJlc2VydmVkOiAqLwogCWlmICghKGRzdC0+bWVtLnBs
YWNlbWVudCAmIFRUTV9QTF9GTEFHX05PX0VWSUNUKSkKLQkJbG9ja2RlcF9hc3NlcnRfaGVsZCgm
ZHN0LT5yZXN2LT5sb2NrLmJhc2UpOworCQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkc3QtPmJhc2Uu
cmVzdi0+bG9jay5iYXNlKTsKIAlpZiAoIShzcmMtPm1lbS5wbGFjZW1lbnQgJiBUVE1fUExfRkxB
R19OT19FVklDVCkpCi0JCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJnNyYy0+cmVzdi0+bG9jay5iYXNl
KTsKKwkJbG9ja2RlcF9hc3NlcnRfaGVsZCgmc3JjLT5iYXNlLnJlc3YtPmxvY2suYmFzZSk7CiAK
IAlpZiAoZHN0LT50dG0tPnN0YXRlID09IHR0X3VucG9wdWxhdGVkKSB7CiAJCXJldCA9IGRzdC0+
dHRtLT5iZGV2LT5kcml2ZXItPnR0bV90dF9wb3B1bGF0ZShkc3QtPnR0bSwgJmN0eCk7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9iby5jIGIvZHJpdmVycy9ncHUv
ZHJtL3Ztd2dmeC92bXdnZnhfYm8uYwppbmRleCAwZDk0NzhkMmU3MDAuLjRhMzhhYjA3MzNjNCAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfYm8uYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9iby5jCkBAIC0zNDIsNyArMzQyLDcgQEAgdm9pZCB2
bXdfYm9fcGluX3Jlc2VydmVkKHN0cnVjdCB2bXdfYnVmZmVyX29iamVjdCAqdmJvLCBib29sIHBp
bikKIAl1aW50MzJfdCBvbGRfbWVtX3R5cGUgPSBiby0+bWVtLm1lbV90eXBlOwogCWludCByZXQ7
CiAKLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZiby0+cmVzdi0+bG9jay5iYXNlKTsKKwlsb2NrZGVw
X2Fzc2VydF9oZWxkKCZiby0+YmFzZS5yZXN2LT5sb2NrLmJhc2UpOwogCiAJaWYgKHBpbikgewog
CQlpZiAodmJvLT5waW5fY291bnQrKyA+IDApCkBAIC02OTAsNyArNjkwLDcgQEAgc3RhdGljIGlu
dCB2bXdfdXNlcl9ib19zeW5jY3B1X2dyYWIoc3RydWN0IHZtd191c2VyX2J1ZmZlcl9vYmplY3Qg
KnVzZXJfYm8sCiAJCWxvbmcgbHJldDsKIAogCQlscmV0ID0gcmVzZXJ2YXRpb25fb2JqZWN0X3dh
aXRfdGltZW91dF9yY3UKLQkJCShiby0+cmVzdiwgdHJ1ZSwgdHJ1ZSwKKwkJCShiby0+YmFzZS5y
ZXN2LCB0cnVlLCB0cnVlLAogCQkJIG5vbmJsb2NrID8gMCA6IE1BWF9TQ0hFRFVMRV9USU1FT1VU
KTsKIAkJaWYgKCFscmV0KQogCQkJcmV0dXJuIC1FQlVTWTsKQEAgLTEwMDcsMTAgKzEwMDcsMTAg
QEAgdm9pZCB2bXdfYm9fZmVuY2Vfc2luZ2xlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8s
CiAKIAlpZiAoZmVuY2UgPT0gTlVMTCkgewogCQl2bXdfZXhlY2J1Zl9mZW5jZV9jb21tYW5kcyhO
VUxMLCBkZXZfcHJpdiwgJmZlbmNlLCBOVUxMKTsKLQkJcmVzZXJ2YXRpb25fb2JqZWN0X2FkZF9l
eGNsX2ZlbmNlKGJvLT5yZXN2LCAmZmVuY2UtPmJhc2UpOworCQlyZXNlcnZhdGlvbl9vYmplY3Rf
YWRkX2V4Y2xfZmVuY2UoYm8tPmJhc2UucmVzdiwgJmZlbmNlLT5iYXNlKTsKIAkJZG1hX2ZlbmNl
X3B1dCgmZmVuY2UtPmJhc2UpOwogCX0gZWxzZQotCQlyZXNlcnZhdGlvbl9vYmplY3RfYWRkX2V4
Y2xfZmVuY2UoYm8tPnJlc3YsICZmZW5jZS0+YmFzZSk7CisJCXJlc2VydmF0aW9uX29iamVjdF9h
ZGRfZXhjbF9mZW5jZShiby0+YmFzZS5yZXN2LCAmZmVuY2UtPmJhc2UpOwogfQogCiAKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2NvdGFibGUuYyBiL2RyaXZlcnMv
Z3B1L2RybS92bXdnZngvdm13Z2Z4X2NvdGFibGUuYwppbmRleCBiNGY2ZTEyMTdjOWQuLmUxNDI3
MTRmMTMyYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfY290YWJs
ZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2NvdGFibGUuYwpAQCAtMTY5
LDcgKzE2OSw3IEBAIHN0YXRpYyBpbnQgdm13X2NvdGFibGVfdW5zY3J1YihzdHJ1Y3Qgdm13X3Jl
c291cmNlICpyZXMpCiAJfSAqY21kOwogCiAJV0FSTl9PTl9PTkNFKGJvLT5tZW0ubWVtX3R5cGUg
IT0gVk1XX1BMX01PQik7Ci0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmYm8tPnJlc3YtPmxvY2suYmFz
ZSk7CisJbG9ja2RlcF9hc3NlcnRfaGVsZCgmYm8tPmJhc2UucmVzdi0+bG9jay5iYXNlKTsKIAog
CWNtZCA9IFZNV19GSUZPX1JFU0VSVkUoZGV2X3ByaXYsIHNpemVvZigqY21kKSk7CiAJaWYgKCFj
bWQpCkBAIC0zMTEsNyArMzExLDcgQEAgc3RhdGljIGludCB2bXdfY290YWJsZV91bmJpbmQoc3Ry
dWN0IHZtd19yZXNvdXJjZSAqcmVzLAogCQlyZXR1cm4gMDsKIAogCVdBUk5fT05fT05DRShiby0+
bWVtLm1lbV90eXBlICE9IFZNV19QTF9NT0IpOwotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmJvLT5y
ZXN2LT5sb2NrLmJhc2UpOworCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmJvLT5iYXNlLnJlc3YtPmxv
Y2suYmFzZSk7CiAKIAltdXRleF9sb2NrKCZkZXZfcHJpdi0+YmluZGluZ19tdXRleCk7CiAJaWYg
KCF2Y290YmwtPnNjcnViYmVkKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92
bXdnZnhfcmVzb3VyY2UuYyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3Jlc291cmNl
LmMKaW5kZXggMWQzOGE4YjJmMmVjLi5jY2Q3Zjc1OGJmOGMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS92bXdnZngvdm13Z2Z4X3Jlc291cmNlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3Zt
d2dmeC92bXdnZnhfcmVzb3VyY2UuYwpAQCAtNDAyLDE0ICs0MDIsMTQgQEAgdm9pZCB2bXdfcmVz
b3VyY2VfdW5yZXNlcnZlKHN0cnVjdCB2bXdfcmVzb3VyY2UgKnJlcywKIAogCWlmIChzd2l0Y2hf
YmFja3VwICYmIG5ld19iYWNrdXAgIT0gcmVzLT5iYWNrdXApIHsKIAkJaWYgKHJlcy0+YmFja3Vw
KSB7Ci0JCQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZyZXMtPmJhY2t1cC0+YmFzZS5yZXN2LT5sb2Nr
LmJhc2UpOworCQkJbG9ja2RlcF9hc3NlcnRfaGVsZCgmcmVzLT5iYWNrdXAtPmJhc2UuYmFzZS5y
ZXN2LT5sb2NrLmJhc2UpOwogCQkJbGlzdF9kZWxfaW5pdCgmcmVzLT5tb2JfaGVhZCk7CiAJCQl2
bXdfYm9fdW5yZWZlcmVuY2UoJnJlcy0+YmFja3VwKTsKIAkJfQogCiAJCWlmIChuZXdfYmFja3Vw
KSB7CiAJCQlyZXMtPmJhY2t1cCA9IHZtd19ib19yZWZlcmVuY2UobmV3X2JhY2t1cCk7Ci0JCQls
b2NrZGVwX2Fzc2VydF9oZWxkKCZuZXdfYmFja3VwLT5iYXNlLnJlc3YtPmxvY2suYmFzZSk7CisJ
CQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZuZXdfYmFja3VwLT5iYXNlLmJhc2UucmVzdi0+bG9jay5i
YXNlKTsKIAkJCWxpc3RfYWRkX3RhaWwoJnJlcy0+bW9iX2hlYWQsICZuZXdfYmFja3VwLT5yZXNf
bGlzdCk7CiAJCX0gZWxzZSB7CiAJCQlyZXMtPmJhY2t1cCA9IE5VTEw7CkBAIC02OTEsNyArNjkx
LDcgQEAgdm9pZCB2bXdfcmVzb3VyY2VfdW5iaW5kX2xpc3Qoc3RydWN0IHZtd19idWZmZXJfb2Jq
ZWN0ICp2Ym8pCiAJCS5udW1fc2hhcmVkID0gMAogCX07CiAKLQlsb2NrZGVwX2Fzc2VydF9oZWxk
KCZ2Ym8tPmJhc2UucmVzdi0+bG9jay5iYXNlKTsKKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZ2Ym8t
PmJhc2UuYmFzZS5yZXN2LT5sb2NrLmJhc2UpOwogCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShy
ZXMsIG5leHQsICZ2Ym8tPnJlc19saXN0LCBtb2JfaGVhZCkgewogCQlpZiAoIXJlcy0+ZnVuYy0+
dW5iaW5kKQogCQkJY29udGludWU7Ci0tIAoyLjE4LjEKCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVs
QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWls
bWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
