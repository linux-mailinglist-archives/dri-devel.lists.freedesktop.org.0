Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id CF41C11509E
	for <lists+dri-devel@lfdr.de>; Fri,  6 Dec 2019 13:47:46 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 864E388FFB;
	Fri,  6 Dec 2019 12:47:44 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A24D86F9F4
 for <dri-devel@lists.freedesktop.org>; Fri,  6 Dec 2019 12:47:19 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id F1642B3FC;
 Fri,  6 Dec 2019 12:47:17 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: airlied@redhat.com, daniel@ffwll.ch, sam@ravnborg.org, kraxel@redhat.com,
 emil.velikov@collabora.com, noralf@tronnes.org, zboszor@pr.hu
Subject: [PATCH v2 6/9] drm/udl: Convert to drm_atomic_helper_dirtyfb()
Date: Fri,  6 Dec 2019 13:47:10 +0100
Message-Id: <20191206124713.5748-7-tzimmermann@suse.de>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191206124713.5748-1-tzimmermann@suse.de>
References: <20191206124713.5748-1-tzimmermann@suse.de>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Daniel Vetter <daniel.vetter@ffwll.ch>,
 Thomas Zimmermann <tzimmermann@suse.de>, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIGluZnJhc3RydXR1cmUgZm9yIGF0b21pYyBtb2Rlc2V0dGluZyBhbGxvd3MgdXMgdG8gdXNl
IHRoZSBnZW5lcmljCmNvZGUgZm9yIGRpcnR5LUZCIGFuZCBkYW1hZ2UgaGFuZGxpbmcuIFN3aXRj
aCBvdmVyIHVkbCBhbmQgcmVtb3ZlIHRoZQpkcml2ZXIncyBpbXBsZW1lbnRhdGlvbi4gVGhlIHNp
bXBsZS1waXBlJ3MgdXBkYXRlIGZ1bmN0aW9uIG5vdyBwaWNrcyB1cAp0aGUgcHJpbWFyeSBwbGFu
ZSdzIGRhbWFnZSBhbmQgdXBkYXRlcyBhIG1pbmltYWwgcmVnaW9uIG9mIHRoZSBzY3JlZW4uCgpT
aWduZWQtb2ZmLWJ5OiBUaG9tYXMgWmltbWVybWFubiA8dHppbW1lcm1hbm5Ac3VzZS5kZT4KUmV2
aWV3ZWQtYnk6IERhbmllbCBWZXR0ZXIgPGRhbmllbC52ZXR0ZXJAZmZ3bGwuY2g+Ci0tLQogZHJp
dmVycy9ncHUvZHJtL3VkbC91ZGxfZHJ2LmggICAgIHwgIDUgLS0tCiBkcml2ZXJzL2dwdS9kcm0v
dWRsL3VkbF9mYi5jICAgICAgfCA1MiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiBk
cml2ZXJzL2dwdS9kcm0vdWRsL3VkbF9tb2Rlc2V0LmMgfCAxMSArKysrKy0tCiAzIGZpbGVzIGNo
YW5nZWQsIDggaW5zZXJ0aW9ucygrKSwgNjAgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL3VkbC91ZGxfZHJ2LmggYi9kcml2ZXJzL2dwdS9kcm0vdWRsL3VkbF9kcnYu
aAppbmRleCBiNDU1ZGJkZmUwY2YuLjcwNzU2ZjhkNGU2NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL3VkbC91ZGxfZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL3VkbC91ZGxfZHJ2LmgK
QEAgLTg0LDExICs4NCw2IEBAIHZvaWQgdWRsX3VyYl9jb21wbGV0aW9uKHN0cnVjdCB1cmIgKnVy
Yik7CiBpbnQgdWRsX2luaXQoc3RydWN0IHVkbF9kZXZpY2UgKnVkbCk7CiB2b2lkIHVkbF9maW5p
KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpOwogCi1zdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICoKLXVk
bF9mYl91c2VyX2ZiX2NyZWF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAotCQkgICAgICBzdHJ1
Y3QgZHJtX2ZpbGUgKmZpbGUsCi0JCSAgICAgIGNvbnN0IHN0cnVjdCBkcm1fbW9kZV9mYl9jbWQy
ICptb2RlX2NtZCk7Ci0KIGludCB1ZGxfcmVuZGVyX2hsaW5lKHN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYsIGludCBsb2dfYnBwLCBzdHJ1Y3QgdXJiICoqdXJiX3B0ciwKIAkJICAgICBjb25zdCBjaGFy
ICpmcm9udCwgY2hhciAqKnVyYl9idWZfcHRyLAogCQkgICAgIHUzMiBieXRlX29mZnNldCwgdTMy
IGRldmljZV9ieXRlX29mZnNldCwgdTMyIGJ5dGVfd2lkdGgpOwpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL3VkbC91ZGxfZmIuYyBiL2RyaXZlcnMvZ3B1L2RybS91ZGwvdWRsX2ZiLmMKaW5k
ZXggMzJhNDU1MTQ0N2I1Li45OGNjMmFiM2E5MTYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS91ZGwvdWRsX2ZiLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3VkbC91ZGxfZmIuYwpAQCAtMTEs
MTIgKzExLDggQEAKICNpbmNsdWRlIDxsaW51eC9tb2R1bGVwYXJhbS5oPgogI2luY2x1ZGUgPGxp
bnV4L2RtYS1idWYuaD4KIAotI2luY2x1ZGUgPGRybS9kcm1fY3J0Y19oZWxwZXIuaD4KLSNpbmNs
dWRlIDxkcm0vZHJtX2Rydi5oPgogI2luY2x1ZGUgPGRybS9kcm1fZm91cmNjLmg+Ci0jaW5jbHVk
ZSA8ZHJtL2RybV9nZW1fZnJhbWVidWZmZXJfaGVscGVyLmg+CiAjaW5jbHVkZSA8ZHJtL2RybV9n
ZW1fc2htZW1faGVscGVyLmg+Ci0jaW5jbHVkZSA8ZHJtL2RybV9tb2Rlc2V0X2hlbHBlci5oPgog
CiAjaW5jbHVkZSAidWRsX2Rydi5oIgogCkBAIC0xNzIsNTEgKzE2OCwzIEBAIGludCB1ZGxfaGFu
ZGxlX2RhbWFnZShzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwgaW50IHgsIGludCB5LAogCiAJ
cmV0dXJuIHJldDsKIH0KLQotc3RhdGljIGludCB1ZGxfdXNlcl9mcmFtZWJ1ZmZlcl9kaXJ0eShz
dHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwKLQkJCQkgICAgICBzdHJ1Y3QgZHJtX2ZpbGUgKmZp
bGUsCi0JCQkJICAgICAgdW5zaWduZWQgZmxhZ3MsIHVuc2lnbmVkIGNvbG9yLAotCQkJCSAgICAg
IHN0cnVjdCBkcm1fY2xpcF9yZWN0ICpjbGlwcywKLQkJCQkgICAgICB1bnNpZ25lZCBudW1fY2xp
cHMpCi17Ci0Jc3RydWN0IHVkbF9kZXZpY2UgKnVkbCA9IGZiLT5kZXYtPmRldl9wcml2YXRlOwot
CWludCBpOwotCWludCByZXQgPSAwOwotCi0JZHJtX21vZGVzZXRfbG9ja19hbGwoZmItPmRldik7
Ci0KLQlzcGluX2xvY2soJnVkbC0+YWN0aXZlX2ZiXzE2X2xvY2spOwotCWlmICh1ZGwtPmFjdGl2
ZV9mYl8xNiAhPSBmYikgewotCQlzcGluX3VubG9jaygmdWRsLT5hY3RpdmVfZmJfMTZfbG9jayk7
Ci0JCWdvdG8gdW5sb2NrOwotCX0KLQlzcGluX3VubG9jaygmdWRsLT5hY3RpdmVfZmJfMTZfbG9j
ayk7Ci0KLQlmb3IgKGkgPSAwOyBpIDwgbnVtX2NsaXBzOyBpKyspIHsKLQkJcmV0ID0gdWRsX2hh
bmRsZV9kYW1hZ2UoZmIsIGNsaXBzW2ldLngxLCBjbGlwc1tpXS55MSwKLQkJCQkJY2xpcHNbaV0u
eDIgLSBjbGlwc1tpXS54MSwKLQkJCQkJY2xpcHNbaV0ueTIgLSBjbGlwc1tpXS55MSk7Ci0JCWlm
IChyZXQpCi0JCQlicmVhazsKLQl9Ci0KLSB1bmxvY2s6Ci0JZHJtX21vZGVzZXRfdW5sb2NrX2Fs
bChmYi0+ZGV2KTsKLQotCXJldHVybiByZXQ7Ci19Ci0KLXN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJt
X2ZyYW1lYnVmZmVyX2Z1bmNzIHVkbGZiX2Z1bmNzID0gewotCS5kZXN0cm95CT0gZHJtX2dlbV9m
Yl9kZXN0cm95LAotCS5jcmVhdGVfaGFuZGxlCT0gZHJtX2dlbV9mYl9jcmVhdGVfaGFuZGxlLAot
CS5kaXJ0eQkJPSB1ZGxfdXNlcl9mcmFtZWJ1ZmZlcl9kaXJ0eSwKLX07Ci0KLXN0cnVjdCBkcm1f
ZnJhbWVidWZmZXIgKgotdWRsX2ZiX3VzZXJfZmJfY3JlYXRlKHN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYsCi0JCSAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSwKLQkJICAgY29uc3Qgc3RydWN0IGRybV9t
b2RlX2ZiX2NtZDIgKm1vZGVfY21kKQotewotCXJldHVybiBkcm1fZ2VtX2ZiX2NyZWF0ZV93aXRo
X2Z1bmNzKGRldiwgZmlsZSwgbW9kZV9jbWQsCi0JCQkJCSAgICAmdWRsZmJfZnVuY3MpOwotfQpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3VkbC91ZGxfbW9kZXNldC5jIGIvZHJpdmVycy9n
cHUvZHJtL3VkbC91ZGxfbW9kZXNldC5jCmluZGV4IDAzZDNmYjE3YTFkOS4uMjhjMGQ5MzE0MWQx
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdWRsL3VkbF9tb2Rlc2V0LmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL3VkbC91ZGxfbW9kZXNldC5jCkBAIC0xMSw2ICsxMSw3IEBACiAKICNpbmNs
dWRlIDxkcm0vZHJtX2F0b21pY19oZWxwZXIuaD4KICNpbmNsdWRlIDxkcm0vZHJtX2NydGNfaGVs
cGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9kYW1hZ2VfaGVscGVyLmg+CiAjaW5jbHVkZSA8ZHJt
L2RybV9nZW1fZnJhbWVidWZmZXJfaGVscGVyLmg+CiAjaW5jbHVkZSA8ZHJtL2RybV9tb2Rlc2V0
X2hlbHBlcl92dGFibGVzLmg+CiAjaW5jbHVkZSA8ZHJtL2RybV92YmxhbmsuaD4KQEAgLTM0MCw3
ICszNDEsOSBAQCB1ZGxfc2ltcGxlX2Rpc3BsYXlfcGlwZV91cGRhdGUoc3RydWN0IGRybV9zaW1w
bGVfZGlzcGxheV9waXBlICpwaXBlLAogewogCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBwaXBl
LT5jcnRjLmRldjsKIAlzdHJ1Y3QgdWRsX2RldmljZSAqdWRsID0gZGV2LT5kZXZfcHJpdmF0ZTsK
LQlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHBpcGUtPnBsYW5lLnN0YXRlLT5mYjsKKwlz
dHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpzdGF0ZSA9IHBpcGUtPnBsYW5lLnN0YXRlOworCXN0cnVj
dCBkcm1fZnJhbWVidWZmZXIgKmZiID0gc3RhdGUtPmZiOworCXN0cnVjdCBkcm1fcmVjdCByZWN0
OwogCiAJc3Bpbl9sb2NrKCZ1ZGwtPmFjdGl2ZV9mYl8xNl9sb2NrKTsKIAl1ZGwtPmFjdGl2ZV9m
Yl8xNiA9IGZiOwpAQCAtMzQ5LDcgKzM1Miw5IEBAIHVkbF9zaW1wbGVfZGlzcGxheV9waXBlX3Vw
ZGF0ZShzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUsCiAJaWYgKCFmYikKIAkJ
cmV0dXJuOwogCi0JdWRsX2hhbmRsZV9kYW1hZ2UoZmIsIDAsIDAsIGZiLT53aWR0aCwgZmItPmhl
aWdodCk7CisJaWYgKGRybV9hdG9taWNfaGVscGVyX2RhbWFnZV9tZXJnZWQob2xkX3BsYW5lX3N0
YXRlLCBzdGF0ZSwgJnJlY3QpKQorCQl1ZGxfaGFuZGxlX2RhbWFnZShmYiwgcmVjdC54MSwgcmVj
dC55MSwgcmVjdC54MiAtIHJlY3QueDEsCisJCQkJICByZWN0LnkyIC0gcmVjdC55MSk7CiB9CiAK
IHN0YXRpYyBjb25zdApAQCAtMzY3LDcgKzM3Miw3IEBAIHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3Bs
YXlfcGlwZV9mdW5jcyB1ZGxfc2ltcGxlX2Rpc3BsYXlfcGlwZV9mdW5jcyA9IHsKICAqLwogCiBz
dGF0aWMgY29uc3Qgc3RydWN0IGRybV9tb2RlX2NvbmZpZ19mdW5jcyB1ZGxfbW9kZV9mdW5jcyA9
IHsKLQkuZmJfY3JlYXRlID0gdWRsX2ZiX3VzZXJfZmJfY3JlYXRlLAorCS5mYl9jcmVhdGUgPSBk
cm1fZ2VtX2ZiX2NyZWF0ZV93aXRoX2RpcnR5LAogCS5hdG9taWNfY2hlY2sgID0gZHJtX2F0b21p
Y19oZWxwZXJfY2hlY2ssCiAJLmF0b21pY19jb21taXQgPSBkcm1fYXRvbWljX2hlbHBlcl9jb21t
aXQsCiB9OwotLSAKMi4yMy4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVz
a3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9k
cmktZGV2ZWw=
