Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id B41D47DCDF
	for <lists+dri-devel@lfdr.de>; Thu,  1 Aug 2019 15:53:16 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4452F6E618;
	Thu,  1 Aug 2019 13:53:12 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from smtp.domeneshop.no (smtp.domeneshop.no
 [IPv6:2a01:5b40:0:3005::1])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 81DB56E618
 for <dri-devel@lists.freedesktop.org>; Thu,  1 Aug 2019 13:53:08 +0000 (UTC)
Received: from 211.81-166-168.customer.lyse.net ([81.166.168.211]:56446
 helo=localhost.localdomain)
 by smtp.domeneshop.no with esmtpsa (TLS1.2:ECDHE_RSA_AES_128_CBC_SHA1:128)
 (Exim 4.84_2) (envelope-from <noralf@tronnes.org>)
 id 1htBVy-0000ZK-JU; Thu, 01 Aug 2019 15:53:06 +0200
From: =?UTF-8?q?Noralf=20Tr=C3=B8nnes?= <noralf@tronnes.org>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 4/4] drm/panel/ili9341: Support DPI panels
Date: Thu,  1 Aug 2019 15:52:49 +0200
Message-Id: <20190801135249.28803-5-noralf@tronnes.org>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190801135249.28803-1-noralf@tronnes.org>
References: <20190801135249.28803-1-noralf@tronnes.org>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; d=tronnes.org; s=ds201810; 
 h=Content-Transfer-Encoding:Content-Type:MIME-Version:References:In-Reply-To:Message-Id:Date:Subject:Cc:To:From;
 bh=gmNv3MGp0f0mCb3B+cZpPezOqz8w6ZQEmrcOgN1/3Xg=; 
 b=t9XHvfu/KvBSM98t8fE3zi3QiNFi65RgNiIDw3LsbCP0wv5R9wrZVTh6HzDgfE8h6lsCRDRo+fHgPgk+r9b1W/3N7YAvXN8vDlFs1BwpuCfjmxVGAgQjzpJrhVCJrpx4Vt3Za4F15VtAXdtdqlvI8XQ4qtANmg2zfVcLNXadCgskIh8ILjMi4CcC0u2+1j3sSsQEQPQOJl8B2Ke4CcLFqmJE5eDrqTFuyznPFao9DaHeRAPj37B8UdZ1WVJ4pCbw99AjXcBHgwXoY9M0OGVFNb0oIFY5QmjdIpQCD6TAVWhgWoQhhQdNKD/1WtFEBM0qjO/UFxY7jXXYNylBT0j+2Q==;
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: daniel.vetter@ffwll.ch, emil.l.velikov@gmail.com, josef@lusticky.cz,
 thierry.reding@gmail.com, laurent.pinchart@ideasonboard.com, sam@ravnborg.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIHN1cHBvcnQgZm9yIHBhbmVscyB0aGF0IHVzZSB0aGUgRFBJIGludGVyZmFjZS4KSUxJOTM0
MSBoYXMgb25ib2FyZCBSQU0gc28gdGhlIGFzc3VtcHRpb24gbWFkZSBoZXJlIGlzIHRoYXQgYWxs
IHN1Y2gKcGFuZWxzIHN1cHBvcnQgcGl4ZWwgdXBsb2FkIG92ZXIgREJJLgoKVGhlIHByZXNlbmNl
L2Fic2Vuc2Ugb2YgdGhlIERldmljZSBUcmVlICdwb3J0JyBub2RlIGRlY2lkZXMgd2hpY2gKaW50
ZXJmYWNlIGlzIHVzZWQgZm9yIHBpeGVsIHRyYW5zZmVyLgoKU2lnbmVkLW9mZi1ieTogTm9yYWxm
IFRyw7hubmVzIDxub3JhbGZAdHJvbm5lcy5vcmc+Ci0tLQogZHJpdmVycy9ncHUvZHJtL3BhbmVs
L3BhbmVsLWlsaXRlay1pbGk5MzQxLmMgfCA1NiArKysrKysrKysrKysrKysrLS0tLQogMSBmaWxl
IGNoYW5nZWQsIDQ1IGluc2VydGlvbnMoKyksIDExIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1pbGl0ZWstaWxpOTM0MS5jIGIvZHJpdmVycy9n
cHUvZHJtL3BhbmVsL3BhbmVsLWlsaXRlay1pbGk5MzQxLmMKaW5kZXggZjYwODJmYTJhMzg5Li43
Y2JmZDczOWM3ZmQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1pbGl0
ZWstaWxpOTM0MS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1pbGl0ZWstaWxp
OTM0MS5jCkBAIC0xMSw2ICsxMSw3IEBACiAjaW5jbHVkZSA8bGludXgvZ3Bpby9jb25zdW1lci5o
PgogI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgogI2luY2x1ZGUgPGxpbnV4L29mX2RldmljZS5o
PgorI2luY2x1ZGUgPGxpbnV4L29mX2dyYXBoLmg+CiAjaW5jbHVkZSA8bGludXgvcG0uaD4KICNp
bmNsdWRlIDxsaW51eC9wcm9wZXJ0eS5oPgogI2luY2x1ZGUgPGxpbnV4L3JlZ3VsYXRvci9jb25z
dW1lci5oPgpAQCAtNTMsMTEgKzU0LDEzIEBACiBzdHJ1Y3QgaWxpOTM0MV9jb25maWcgewogCWNv
bnN0IHN0cnVjdCBkcm1fcGFuZWxfZnVuY3MgKmZ1bmNzOwogCWNvbnN0IHN0cnVjdCBkcm1fZGlz
cGxheV9tb2RlICptb2RlOworCWJvb2wgbm9fZHBpOwogfTsKIAogc3RydWN0IGlsaTkzNDEgewog
CXN0cnVjdCBtaXBpX2RiaV9kZXYgZGJpZGV2OyAvKiBUaGlzIG11c3QgYmUgdGhlIGZpcnN0IGVu
dHJ5ICovCiAJc3RydWN0IGRybV9wYW5lbCBwYW5lbDsKKwlib29sIHVzZV9kcGk7CiAJc3RydWN0
IHJlZ3VsYXRvciAqcmVndWxhdG9yOwogCXN0cnVjdCBiYWNrbGlnaHRfZGV2aWNlICpiYWNrbGln
aHQ7CiAJY29uc3Qgc3RydWN0IGlsaTkzNDFfY29uZmlnICpjb25mOwpAQCAtMTc0LDYgKzE3Nyw3
IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSB5eDI0MHF2MjlfbW9kZSA9
IHsKIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaWxpOTM0MV9jb25maWcgeXgyNDBxdjI5X2RhdGEgPSB7
CiAJLmZ1bmNzID0gJnl4MjQwcXYyOV9mdW5jcywKIAkubW9kZSA9ICZ5eDI0MHF2MjlfbW9kZSwK
Kwkubm9fZHBpID0gdHJ1ZSwKIH07CiAKIHN0YXRpYyBpbnQgbWkwMjgzcXRfcHJlcGFyZShzdHJ1
Y3QgZHJtX3BhbmVsICpwYW5lbCkKQEAgLTI5MSw2ICsyOTUsNyBAQCBzdGF0aWMgY29uc3Qgc3Ry
dWN0IGRybV9kaXNwbGF5X21vZGUgbWkwMjgzcXRfbW9kZSA9IHsKIHN0YXRpYyBjb25zdCBzdHJ1
Y3QgaWxpOTM0MV9jb25maWcgbWkwMjgzcXRfZGF0YSA9IHsKIAkuZnVuY3MgPSAmbWkwMjgzcXRf
ZHJtX2Z1bmNzLAogCS5tb2RlID0gJm1pMDI4M3F0X21vZGUsCisJLm5vX2RwaSA9IHRydWUsCiB9
OwogCiAvKiBMZWdhY3ksIERSTSBkcml2ZXIgbmFtZSBpcyBBQkkgKi8KQEAgLTMwMyw2ICszMDgs
NyBAQCBzdGF0aWMgaW50IGlsaTkzNDFfcHJvYmUoc3RydWN0IHNwaV9kZXZpY2UgKnNwaSkKIAlj
b25zdCBzdHJ1Y3Qgc3BpX2RldmljZV9pZCAqc3BpX2lkOwogCXN0cnVjdCBkZXZpY2UgKmRldiA9
ICZzcGktPmRldjsKIAlzdHJ1Y3QgZHJtX2RyaXZlciAqZHJpdmVyOworCXN0cnVjdCBkZXZpY2Vf
bm9kZSAqcG9ydDsKIAlzdHJ1Y3QgbWlwaV9kYmkgKmRiaTsKIAlzdHJ1Y3QgZ3Bpb19kZXNjICpk
YzsKIAlzdHJ1Y3QgaWxpOTM0MSAqaWxpOwpAQCAtMzU3LDIxICszNjMsNDQgQEAgc3RhdGljIGlu
dCBpbGk5MzQxX3Byb2JlKHN0cnVjdCBzcGlfZGV2aWNlICpzcGkpCiAJaWxpLT5wYW5lbC5kZXYg
PSBkZXY7CiAJaWxpLT5wYW5lbC5mdW5jcyA9IGlsaS0+Y29uZi0+ZnVuY3M7CiAKLQlpZiAoaWxp
LT5jb25mID09ICZtaTAyODNxdF9kYXRhKQotCQlkcml2ZXIgPSAmbWkwMjgzcXRfZHJtX2RyaXZl
cjsKLQllbHNlCi0JCWRyaXZlciA9ICZpbGk5MzQxX2RybV9kcml2ZXI7CiAKLQlyZXR1cm4gZHJt
X21pcGlfZGJpX3BhbmVsX3JlZ2lzdGVyKCZpbGktPnBhbmVsLCAmaWxpLT5kYmlkZXYsIGRyaXZl
ciwKLQkJCQkJICAgaWxpLT5jb25mLT5tb2RlLCByb3RhdGlvbik7CisJcG9ydCA9IG9mX2dldF9j
aGlsZF9ieV9uYW1lKGRldi0+b2Zfbm9kZSwgInBvcnQiKTsKKwlpZiAocG9ydCkgeworCQlvZl9u
b2RlX3B1dChwb3J0KTsKKwkJaWxpLT51c2VfZHBpID0gdHJ1ZTsKKwl9CisKKwlpZiAoaWxpLT5j
b25mLT5ub19kcGkpCisJCWlsaS0+dXNlX2RwaSA9IGZhbHNlOworCisJaWYgKGlsaS0+dXNlX2Rw
aSkgeworCQlyZXQgPSBkcm1fcGFuZWxfYWRkKCZpbGktPnBhbmVsKTsKKwl9IGVsc2UgeworCQlp
ZiAoaWxpLT5jb25mID09ICZtaTAyODNxdF9kYXRhKQorCQkJZHJpdmVyID0gJm1pMDI4M3F0X2Ry
bV9kcml2ZXI7CisJCWVsc2UKKwkJCWRyaXZlciA9ICZpbGk5MzQxX2RybV9kcml2ZXI7CisKKwkJ
cmV0ID0gZHJtX21pcGlfZGJpX3BhbmVsX3JlZ2lzdGVyKCZpbGktPnBhbmVsLCAmaWxpLT5kYmlk
ZXYsIGRyaXZlciwKKwkJCQkJCSAgaWxpLT5jb25mLT5tb2RlLCByb3RhdGlvbik7CisJfQorCisJ
cmV0dXJuIHJldDsKIH0KIAogc3RhdGljIGludCBpbGk5MzQxX3JlbW92ZShzdHJ1Y3Qgc3BpX2Rl
dmljZSAqc3BpKQogewogCXN0cnVjdCBpbGk5MzQxICppbGkgPSBzcGlfZ2V0X2RydmRhdGEoc3Bp
KTsKIAotCWRybV9kZXZfdW5wbHVnKCZpbGktPmRiaWRldi5kcm0pOwotCWRybV9hdG9taWNfaGVs
cGVyX3NodXRkb3duKCZpbGktPmRiaWRldi5kcm0pOworCWlmIChpbGktPnVzZV9kcGkpIHsKKwkJ
ZHJtX3BhbmVsX3JlbW92ZSgmaWxpLT5wYW5lbCk7CisJCWRybV9wYW5lbF9kaXNhYmxlKCZpbGkt
PnBhbmVsKTsKKwkJZHJtX3BhbmVsX3VucHJlcGFyZSgmaWxpLT5wYW5lbCk7CisJCWtmcmVlKGls
aSk7CisJfSBlbHNlIHsKKwkJZHJtX2Rldl91bnBsdWcoJmlsaS0+ZGJpZGV2LmRybSk7CisJCWRy
bV9hdG9taWNfaGVscGVyX3NodXRkb3duKCZpbGktPmRiaWRldi5kcm0pOworCX0KIAogCXJldHVy
biAwOwogfQpAQCAtMzgwLDIxICs0MDksMjYgQEAgc3RhdGljIHZvaWQgaWxpOTM0MV9zaHV0ZG93
bihzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpKQogewogCXN0cnVjdCBpbGk5MzQxICppbGkgPSBzcGlf
Z2V0X2RydmRhdGEoc3BpKTsKIAotCWRybV9hdG9taWNfaGVscGVyX3NodXRkb3duKCZpbGktPmRi
aWRldi5kcm0pOworCWlmICghaWxpLT51c2VfZHBpKQorCQlkcm1fYXRvbWljX2hlbHBlcl9zaHV0
ZG93bigmaWxpLT5kYmlkZXYuZHJtKTsKIH0KIAogc3RhdGljIGludCBfX21heWJlX3VudXNlZCBp
bGk5MzQxX3BtX3N1c3BlbmQoc3RydWN0IGRldmljZSAqZGV2KQogewogCXN0cnVjdCBpbGk5MzQx
ICppbGkgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKIAotCXJldHVybiBkcm1fbW9kZV9jb25maWdf
aGVscGVyX3N1c3BlbmQoJmlsaS0+ZGJpZGV2LmRybSk7CisJaWYgKCFpbGktPnVzZV9kcGkpCisJ
CXJldHVybiBkcm1fbW9kZV9jb25maWdfaGVscGVyX3N1c3BlbmQoJmlsaS0+ZGJpZGV2LmRybSk7
CisKKwlyZXR1cm4gMDsKIH0KIAogc3RhdGljIGludCBfX21heWJlX3VudXNlZCBpbGk5MzQxX3Bt
X3Jlc3VtZShzdHJ1Y3QgZGV2aWNlICpkZXYpCiB7CiAJc3RydWN0IGlsaTkzNDEgKmlsaSA9IGRl
dl9nZXRfZHJ2ZGF0YShkZXYpOwogCi0JZHJtX21vZGVfY29uZmlnX2hlbHBlcl9yZXN1bWUoJmls
aS0+ZGJpZGV2LmRybSk7CisJaWYgKCFpbGktPnVzZV9kcGkpCisJCWRybV9tb2RlX2NvbmZpZ19o
ZWxwZXJfcmVzdW1lKCZpbGktPmRiaWRldi5kcm0pOwogCiAJcmV0dXJuIDA7CiB9Ci0tIAoyLjIw
LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1k
ZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczov
L2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
