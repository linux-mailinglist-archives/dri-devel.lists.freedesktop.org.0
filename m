Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 252A2102D1D
	for <lists+dri-devel@lfdr.de>; Tue, 19 Nov 2019 20:59:55 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E43FE6E8C3;
	Tue, 19 Nov 2019 19:59:51 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from NAM01-SN1-obe.outbound.protection.outlook.com
 (mail-eopbgr820084.outbound.protection.outlook.com [40.107.82.84])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 513B66E8C3;
 Tue, 19 Nov 2019 19:59:50 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=UdHKf1n6AA9fKDKdMY+ZpcHfOW9c5okOVsVstIO7j1Cn3ej+xp7rJldSgHBMForwXpsMNAjcW8Wh9ilVvuea9bVRzjRhG8isBXKgaR36CMwQVyAhtuOU7DIYxygTu2eBiOZYuwQq9ADUn+4iUmQ9AVEtiOiRmRBxIHl8blNmp8Y0s1KdphUkunI0r9HaYK96zihECC3D1bsXkSuOpHVtSKJ2Lq15i/grYitrV7/dQ3XmG8hDVdECiedkqPooS401ze+ek1Le15FOkq/NyVXCFj03pSABpfcxKFjAA8M53wKV+nfWpjoHoWApJPBZYdVC5rjRRN0J6kRjZnx2QOScwg==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=mSYXDeMAN05psprQO41iWZ2GrM0UOoxGgU0DoZIN7Hk=;
 b=MrYEf+pOeIKc2Sa9GfL89/H0EwbDxAYFayvQG3YWQGs7R/KC/6V/4w2dVZYBCFnoaOEyp3RauwZg0mh4Psv5nGwo7tFAQWr1vOvkeMFzLGGPI9W1SsiapRrN72+/FCr6SXeW2sTHGsnAfyDTQ4gmf6VU/nE0GJJuFZpirCKlKJeHbztVaIHi/Qrhqc2nRLfhj5ImDzVazQlxbNQ98uC7KanUVAAd2Af9KYU4IkG3ppLad0UsmpYR7RaEB0nHO3IPnouJwe91typBd+th+AuibL4kb/DlDCz/R34i/arAgdls0ZvLlNG/3GfOcB6jg4BTCZJZR4Yc+O7XHykZI7DtTQ==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
Received: from MN2PR12MB4030.namprd12.prod.outlook.com (10.255.86.25) by
 MN2PR12MB4174.namprd12.prod.outlook.com (10.255.224.140) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2474.16; Tue, 19 Nov 2019 19:59:47 +0000
Received: from MN2PR12MB4030.namprd12.prod.outlook.com
 ([fe80::b9e3:2087:df4d:1e0a]) by MN2PR12MB4030.namprd12.prod.outlook.com
 ([fe80::b9e3:2087:df4d:1e0a%6]) with mapi id 15.20.2451.031; Tue, 19 Nov 2019
 19:59:47 +0000
Subject: Re: [PATCH v3 12/14] drm/amdgpu: Use mmu_interval_notifier instead of
 hmm_mirror
To: Jason Gunthorpe <jgg@ziepe.ca>, linux-mm@kvack.org,
 Jerome Glisse <jglisse@redhat.com>, Ralph Campbell <rcampbell@nvidia.com>,
 John Hubbard <jhubbard@nvidia.com>, Felix.Kuehling@amd.com
References: <20191112202231.3856-1-jgg@ziepe.ca>
 <20191112202231.3856-13-jgg@ziepe.ca>
From: Philip Yang <philip.yang@amd.com>
Message-ID: <34d0a0d6-9800-be3f-c1f0-4d87b1b4cbdb@amd.com>
Date: Tue, 19 Nov 2019 14:59:43 -0500
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.1.0
In-Reply-To: <20191112202231.3856-13-jgg@ziepe.ca>
Content-Language: en-GB
X-ClientProxiedBy: YT1PR01CA0036.CANPRD01.PROD.OUTLOOK.COM (2603:10b6:b01::49)
 To MN2PR12MB4030.namprd12.prod.outlook.com
 (2603:10b6:208:159::25)
MIME-Version: 1.0
X-Originating-IP: [165.204.55.251]
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-HT: Tenant
X-MS-Office365-Filtering-Correlation-Id: 6fbe2520-1a7c-4eee-cbda-08d76d2b077d
X-MS-TrafficTypeDiagnostic: MN2PR12MB4174:
X-MS-Exchange-Transport-Forked: True
X-Microsoft-Antispam-PRVS: <MN2PR12MB417438D013404B150B256E6BE64C0@MN2PR12MB4174.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:6430;
X-Forefront-PRVS: 022649CC2C
X-Forefront-Antispam-Report: SFV:NSPM;
 SFS:(10009020)(4636009)(366004)(376002)(396003)(136003)(39860400002)(346002)(189003)(199004)(6486002)(316002)(6436002)(30864003)(229853002)(5660300002)(14444005)(6512007)(31696002)(8936002)(76176011)(4326008)(54906003)(110136005)(58126008)(52116002)(86362001)(23676004)(2486003)(8676002)(81156014)(81166006)(99286004)(6246003)(186003)(36756003)(31686004)(4001150100001)(478600001)(386003)(7416002)(26005)(66946007)(446003)(66556008)(66476007)(6636002)(6506007)(53546011)(305945005)(25786009)(47776003)(6666004)(7736002)(230700001)(486006)(3846002)(2616005)(476003)(6116002)(14454004)(65806001)(65956001)(66066001)(44832011)(2906002)(50466002)(11346002);
 DIR:OUT; SFP:1101; SCL:1; SRVR:MN2PR12MB4174;
 H:MN2PR12MB4030.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; MX:1; A:1; 
Received-SPF: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: cq0PTmd2uTnCej6+cYyMY2/tqp+k2CbRZxPw4YGXc6sufNVJcz8vWxvh2fHbdOT6+io3V2R3UYaXQ553WC03zX5TAs6e2yG8BICHdmTqfsKbzZMj8UDQM5YTnvM2Zr31m/qfnzLj55Jo5OHeytiyFP1srL5pc8Ht8PsxRYmaiKdfIX4+PmjJQFvnkubjzsG85AlvaUZLufHJ4Ew9zmGXMx+I1yvhKa/9nahsQbK2VKaxzOP+IOHW8lUOlIOvoz2OfyGz+3s+V4i4VnI1lSbHUobYpx3eOuJX8qfPSsuIxQqZHwKvxNUIfXkKf9ogemesq58TwcSuADzPWEZibv49XK3PmJ7Snfq7wD69cjGr++9mMF4A11iz7x3drJo493g+NvPQmgPFGOIjXgtbXgZr7aFJdFtrKtkVYynm+sktbsX1AuAXCr5RNQgHX04mdUKr
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 6fbe2520-1a7c-4eee-cbda-08d76d2b077d
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 19 Nov 2019 19:59:47.6968 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: ij3w6ScInDA8Ei9N9WcygQqTAagFF/062xPkSG+Mrl//z9mKl/1nsYwhEivC5daa
X-MS-Exchange-Transport-CrossTenantHeadersStamped: MN2PR12MB4174
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=mSYXDeMAN05psprQO41iWZ2GrM0UOoxGgU0DoZIN7Hk=;
 b=oUhw6Ft0Os6VotvTuoMsrkZO4buKsU4VPP59ZCG2T4h+3iRmGxE+psdCdL8Ic50eqFnSBfvAB85rvYUirJq4QpGpcXd902W9w6QIl0VlXCBx8K5eBsaZes95ewKHZs2Q8wslsFXyDaBLa6FTQvK/fUdF3s+d426kFld4TKziot0=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Philip.Yang@amd.com; 
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>,
 Mike Marciniszyn <mike.marciniszyn@intel.com>,
 Stefano Stabellini <sstabellini@kernel.org>,
 Oleksandr Andrushchenko <oleksandr_andrushchenko@epam.com>,
 linux-rdma@vger.kernel.org, nouveau@lists.freedesktop.org,
 Dennis Dalessandro <dennis.dalessandro@intel.com>,
 amd-gfx@lists.freedesktop.org, Christoph Hellwig <hch@infradead.org>,
 Jason Gunthorpe <jgg@mellanox.com>, dri-devel@lists.freedesktop.org,
 Alex Deucher <alexander.deucher@amd.com>, xen-devel@lists.xenproject.org,
 Boris Ostrovsky <boris.ostrovsky@oracle.com>, Petr Cvek <petrcvekcz@gmail.com>,
 =?UTF-8?Q?Christian_K=c3=b6nig?= <christian.koenig@amd.com>,
 Ben Skeggs <bskeggs@redhat.com>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SSB0ZXN0IHYzIGFuZCBpdCB3b3JrcyBmaW5lLgoKUmVnYXJkcywKUGhpbGlwCgpPbiAyMDE5LTEx
LTEyIDM6MjIgcC5tLiwgSmFzb24gR3VudGhvcnBlIHdyb3RlOgo+IEZyb206IEphc29uIEd1bnRo
b3JwZSA8amdnQG1lbGxhbm94LmNvbT4KPiAKPiBDb252ZXJ0IHRoZSBjb2xsaXNpb24tcmV0cnkg
bG9jayBhcm91bmQgaG1tX3JhbmdlX2ZhdWx0IHRvIHVzZSB0aGUgb25lIG5vdwo+IHByb3ZpZGVk
IGJ5IHRoZSBtbXVfaW50ZXJ2YWwgbm90aWZpZXIuCj4gCj4gQWx0aG91Z2ggdGhpcyBkcml2ZXIg
ZG9lcyBub3Qgc2VlbSB0byB1c2UgdGhlIGNvbGxpc2lvbiByZXRyeSBsb2NrIHRoYXQKPiBobW0g
cHJvdmlkZXMgY29ycmVjdGx5LCBpdCBjYW4gc3RpbGwgYmUgY29udmVydGVkIG92ZXIgdG8gdXNl
IHRoZQo+IG1tdV9pbnRlcnZhbF9ub3RpZmllciBhcGkgaW5zdGVhZCBvZiBobW1fbWlycm9yIHdp
dGhvdXQgdG9vIG11Y2ggdHJvdWJsZS4KPiAKPiBUaGlzIGFsc28gZGVsZXRlcyBhbm90aGVyIHBs
YWNlIHdoZXJlIGEgZHJpdmVyIGlzIGFzc29jaWF0aW5nIGFkZGl0aW9uYWwKPiBkYXRhIChzdHJ1
Y3QgYW1kZ3B1X21uKSB3aXRoIGEgbW11X3N0cnVjdC4KPiAKPiBTaWduZWQtb2ZmLWJ5OiBQaGls
aXAgWWFuZyA8UGhpbGlwLllhbmdAYW1kLmNvbT4KPiBSZXZpZXdlZC1ieTogUGhpbGlwIFlhbmcg
PFBoaWxpcC5ZYW5nQGFtZC5jb20+Cj4gVGVzdGVkLWJ5OiBQaGlsaXAgWWFuZyA8UGhpbGlwLllh
bmdAYW1kLmNvbT4KPiBTaWduZWQtb2ZmLWJ5OiBKYXNvbiBHdW50aG9ycGUgPGpnZ0BtZWxsYW5v
eC5jb20+Cj4gLS0tCj4gICAuLi4vZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ3B1
dm0uYyAgfCAgIDQgKwo+ICAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2NzLmMg
ICAgICAgIHwgIDE0ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfbW4u
YyAgICAgICAgfCAxNDggKystLS0tLS0tLS0tLS0tLS0tCj4gICBkcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfbW4uaCAgICAgICAgfCAgNDkgLS0tLS0tCj4gICBkcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmMgICAgICAgfCAxMTYgKysrKysrKystLS0tLS0KPiAg
IDUgZmlsZXMgY2hhbmdlZCwgOTQgaW5zZXJ0aW9ucygrKSwgMjM3IGRlbGV0aW9ucygtKQo+IAo+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dw
dXZtLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dwdXZtLmMK
PiBpbmRleCA0NzcwMDMwMmEwOGI3Zi4uMWJjZWRiOWI0NzdkY2UgMTAwNjQ0Cj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9ncHV2bS5jCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9ncHV2bS5jCj4gQEAgLTE3Mzgs
NiArMTczOCwxMCBAQCBzdGF0aWMgaW50IHVwZGF0ZV9pbnZhbGlkX3VzZXJfcGFnZXMoc3RydWN0
IGFtZGtmZF9wcm9jZXNzX2luZm8gKnByb2Nlc3NfaW5mbywKPiAgIAkJCXJldHVybiByZXQ7Cj4g
ICAJCX0KPiAgIAo+ICsJCS8qCj4gKwkJICogRklYTUU6IENhbm5vdCBpZ25vcmUgdGhlIHJldHVy
biBjb2RlLCBtdXN0IGhvbGQKPiArCQkgKiBub3RpZmllcl9sb2NrCj4gKwkJICovCj4gICAJCWFt
ZGdwdV90dG1fdHRfZ2V0X3VzZXJfcGFnZXNfZG9uZShiby0+dGJvLnR0bSk7Cj4gICAKPiAgIAkJ
LyogTWFyayB0aGUgQk8gYXMgdmFsaWQgdW5sZXNzIGl0IHdhcyBpbnZhbGlkYXRlZAo+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfY3MuYyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9jcy5jCj4gaW5kZXggODI4MjNkOWE4YmE4ODcuLjIy
Yzk4OWJjYTc1MTRjIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV9jcy5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2NzLmMK
PiBAQCAtNjAzLDggKzYwMyw2IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2NzX3BhcnNlcl9ib3Moc3Ry
dWN0IGFtZGdwdV9jc19wYXJzZXIgKnAsCj4gICAJCWUtPnR2Lm51bV9zaGFyZWQgPSAyOwo+ICAg
Cj4gICAJYW1kZ3B1X2JvX2xpc3RfZ2V0X2xpc3QocC0+Ym9fbGlzdCwgJnAtPnZhbGlkYXRlZCk7
Cj4gLQlpZiAocC0+Ym9fbGlzdC0+Zmlyc3RfdXNlcnB0ciAhPSBwLT5ib19saXN0LT5udW1fZW50
cmllcykKPiAtCQlwLT5tbiA9IGFtZGdwdV9tbl9nZXQocC0+YWRldiwgQU1ER1BVX01OX1RZUEVf
R0ZYKTsKPiAgIAo+ICAgCUlOSVRfTElTVF9IRUFEKCZkdXBsaWNhdGVzKTsKPiAgIAlhbWRncHVf
dm1fZ2V0X3BkX2JvKCZmcHJpdi0+dm0sICZwLT52YWxpZGF0ZWQsICZwLT52bV9wZCk7Cj4gQEAg
LTEyODcsMTEgKzEyODUsMTEgQEAgc3RhdGljIGludCBhbWRncHVfY3Nfc3VibWl0KHN0cnVjdCBh
bWRncHVfY3NfcGFyc2VyICpwLAo+ICAgCWlmIChyKQo+ICAgCQlnb3RvIGVycm9yX3VubG9jazsK
PiAgIAo+IC0JLyogTm8gbWVtb3J5IGFsbG9jYXRpb24gaXMgYWxsb3dlZCB3aGlsZSBob2xkaW5n
IHRoZSBtbiBsb2NrLgo+IC0JICogcC0+bW4gaXMgaG9sZCB1bnRpbCBhbWRncHVfY3Nfc3VibWl0
IGlzIGZpbmlzaGVkIGFuZCBmZW5jZSBpcyBhZGRlZAo+IC0JICogdG8gQk9zLgo+ICsJLyogTm8g
bWVtb3J5IGFsbG9jYXRpb24gaXMgYWxsb3dlZCB3aGlsZSBob2xkaW5nIHRoZSBub3RpZmllciBs
b2NrLgo+ICsJICogVGhlIGxvY2sgaXMgaGVsZCB1bnRpbCBhbWRncHVfY3Nfc3VibWl0IGlzIGZp
bmlzaGVkIGFuZCBmZW5jZSBpcwo+ICsJICogYWRkZWQgdG8gQk9zLgo+ICAgCSAqLwo+IC0JYW1k
Z3B1X21uX2xvY2socC0+bW4pOwo+ICsJbXV0ZXhfbG9jaygmcC0+YWRldi0+bm90aWZpZXJfbG9j
ayk7Cj4gICAKPiAgIAkvKiBJZiB1c2VycHRyIGFyZSBpbnZhbGlkYXRlZCBhZnRlciBhbWRncHVf
Y3NfcGFyc2VyX2JvcygpLCByZXR1cm4KPiAgIAkgKiAtRUFHQUlOLCBkcm1Jb2N0bCBpbiBsaWJk
cm0gd2lsbCByZXN0YXJ0IHRoZSBhbWRncHVfY3NfaW9jdGwuCj4gQEAgLTEzMzQsMTMgKzEzMzIs
MTMgQEAgc3RhdGljIGludCBhbWRncHVfY3Nfc3VibWl0KHN0cnVjdCBhbWRncHVfY3NfcGFyc2Vy
ICpwLAo+ICAgCWFtZGdwdV92bV9tb3ZlX3RvX2xydV90YWlsKHAtPmFkZXYsICZmcHJpdi0+dm0p
Owo+ICAgCj4gICAJdHRtX2V1X2ZlbmNlX2J1ZmZlcl9vYmplY3RzKCZwLT50aWNrZXQsICZwLT52
YWxpZGF0ZWQsIHAtPmZlbmNlKTsKPiAtCWFtZGdwdV9tbl91bmxvY2socC0+bW4pOwo+ICsJbXV0
ZXhfdW5sb2NrKCZwLT5hZGV2LT5ub3RpZmllcl9sb2NrKTsKPiAgIAo+ICAgCXJldHVybiAwOwo+
ICAgCj4gICBlcnJvcl9hYm9ydDoKPiAgIAlkcm1fc2NoZWRfam9iX2NsZWFudXAoJmpvYi0+YmFz
ZSk7Cj4gLQlhbWRncHVfbW5fdW5sb2NrKHAtPm1uKTsKPiArCW11dGV4X3VubG9jaygmcC0+YWRl
di0+bm90aWZpZXJfbG9jayk7Cj4gICAKPiAgIGVycm9yX3VubG9jazoKPiAgIAlhbWRncHVfam9i
X2ZyZWUoam9iKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X21uLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfbW4uYwo+IGluZGV4
IDlmZTFjMzFjZTE3YTMwLi44MjhiNTE2N2ZmMTI4ZiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfbW4uYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV9tbi5jCj4gQEAgLTUwLDI4ICs1MCw2IEBACj4gICAjaW5jbHVkZSAiYW1k
Z3B1LmgiCj4gICAjaW5jbHVkZSAiYW1kZ3B1X2FtZGtmZC5oIgo+ICAgCj4gLS8qKgo+IC0gKiBh
bWRncHVfbW5fbG9jayAtIHRha2UgdGhlIHdyaXRlIHNpZGUgbG9jayBmb3IgdGhpcyBub3RpZmll
cgo+IC0gKgo+IC0gKiBAbW46IG91ciBub3RpZmllcgo+IC0gKi8KPiAtdm9pZCBhbWRncHVfbW5f
bG9jayhzdHJ1Y3QgYW1kZ3B1X21uICptbikKPiAtewo+IC0JaWYgKG1uKQo+IC0JCWRvd25fd3Jp
dGUoJm1uLT5sb2NrKTsKPiAtfQo+IC0KPiAtLyoqCj4gLSAqIGFtZGdwdV9tbl91bmxvY2sgLSBk
cm9wIHRoZSB3cml0ZSBzaWRlIGxvY2sgZm9yIHRoaXMgbm90aWZpZXIKPiAtICoKPiAtICogQG1u
OiBvdXIgbm90aWZpZXIKPiAtICovCj4gLXZvaWQgYW1kZ3B1X21uX3VubG9jayhzdHJ1Y3QgYW1k
Z3B1X21uICptbikKPiAtewo+IC0JaWYgKG1uKQo+IC0JCXVwX3dyaXRlKCZtbi0+bG9jayk7Cj4g
LX0KPiAtCj4gICAvKioKPiAgICAqIGFtZGdwdV9tbl9pbnZhbGlkYXRlX2dmeCAtIGNhbGxiYWNr
IHRvIG5vdGlmeSBhYm91dCBtbSBjaGFuZ2UKPiAgICAqCj4gQEAgLTk0LDYgKzcyLDkgQEAgc3Rh
dGljIGJvb2wgYW1kZ3B1X21uX2ludmFsaWRhdGVfZ2Z4KHN0cnVjdCBtbXVfaW50ZXJ2YWxfbm90
aWZpZXIgKm1uaSwKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCj4gICAJbXV0ZXhfbG9jaygmYWRl
di0+bm90aWZpZXJfbG9jayk7Cj4gKwo+ICsJbW11X2ludGVydmFsX3NldF9zZXEobW5pLCBjdXJf
c2VxKTsKPiArCj4gICAJciA9IGRtYV9yZXN2X3dhaXRfdGltZW91dF9yY3UoYm8tPnRiby5iYXNl
LnJlc3YsIHRydWUsIGZhbHNlLAo+ICAgCQkJCSAgICAgIE1BWF9TQ0hFRFVMRV9USU1FT1VUKTsK
PiAgIAltdXRleF91bmxvY2soJmFkZXYtPm5vdGlmaWVyX2xvY2spOwo+IEBAIC0xMjcsNiArMTA4
LDkgQEAgc3RhdGljIGJvb2wgYW1kZ3B1X21uX2ludmFsaWRhdGVfaHNhKHN0cnVjdCBtbXVfaW50
ZXJ2YWxfbm90aWZpZXIgKm1uaSwKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCj4gICAJbXV0ZXhf
bG9jaygmYWRldi0+bm90aWZpZXJfbG9jayk7Cj4gKwo+ICsJbW11X2ludGVydmFsX3NldF9zZXEo
bW5pLCBjdXJfc2VxKTsKPiArCj4gICAJYW1kZ3B1X2FtZGtmZF9ldmljdF91c2VycHRyKGJvLT5r
ZmRfYm8sIGJvLT5ub3RpZmllci5tbSk7Cj4gICAJbXV0ZXhfdW5sb2NrKCZhZGV2LT5ub3RpZmll
cl9sb2NrKTsKPiAgIAo+IEBAIC0xMzcsOTIgKzEyMSw2IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3Qg
bW11X2ludGVydmFsX25vdGlmaWVyX29wcyBhbWRncHVfbW5faHNhX29wcyA9IHsKPiAgIAkuaW52
YWxpZGF0ZSA9IGFtZGdwdV9tbl9pbnZhbGlkYXRlX2hzYSwKPiAgIH07Cj4gICAKPiAtc3RhdGlj
IGludCBhbWRncHVfbW5fc3luY19wYWdldGFibGVzKHN0cnVjdCBobW1fbWlycm9yICptaXJyb3Is
Cj4gLQkJCQkgICAgIGNvbnN0IHN0cnVjdCBtbXVfbm90aWZpZXJfcmFuZ2UgKnVwZGF0ZSkKPiAt
ewo+IC0Jc3RydWN0IGFtZGdwdV9tbiAqYW1uID0gY29udGFpbmVyX29mKG1pcnJvciwgc3RydWN0
IGFtZGdwdV9tbiwgbWlycm9yKTsKPiAtCj4gLQlpZiAoIW1tdV9ub3RpZmllcl9yYW5nZV9ibG9j
a2FibGUodXBkYXRlKSkKPiAtCQlyZXR1cm4gLUVBR0FJTjsKPiAtCj4gLQlkb3duX3JlYWQoJmFt
bi0+bG9jayk7Cj4gLQl1cF9yZWFkKCZhbW4tPmxvY2spOwo+IC0JcmV0dXJuIDA7Cj4gLX0KPiAt
Cj4gLS8qIExvdyBiaXRzIG9mIGFueSByZWFzb25hYmxlIG1tIHBvaW50ZXIgd2lsbCBiZSB1bnVz
ZWQgZHVlIHRvIHN0cnVjdAo+IC0gKiBhbGlnbm1lbnQuIFVzZSB0aGVzZSBiaXRzIHRvIG1ha2Ug
YSB1bmlxdWUga2V5IGZyb20gdGhlIG1tIHBvaW50ZXIKPiAtICogYW5kIG5vdGlmaWVyIHR5cGUu
Cj4gLSAqLwo+IC0jZGVmaW5lIEFNREdQVV9NTl9LRVkobW0sIHR5cGUpICgodW5zaWduZWQgbG9u
ZykobW0pICsgKHR5cGUpKQo+IC0KPiAtc3RhdGljIHN0cnVjdCBobW1fbWlycm9yX29wcyBhbWRn
cHVfaG1tX21pcnJvcl9vcHNbXSA9IHsKPiAtCVtBTURHUFVfTU5fVFlQRV9HRlhdID0gewo+IC0J
CS5zeW5jX2NwdV9kZXZpY2VfcGFnZXRhYmxlcyA9IGFtZGdwdV9tbl9zeW5jX3BhZ2V0YWJsZXMs
Cj4gLQl9LAo+IC0JW0FNREdQVV9NTl9UWVBFX0hTQV0gPSB7Cj4gLQkJLnN5bmNfY3B1X2Rldmlj
ZV9wYWdldGFibGVzID0gYW1kZ3B1X21uX3N5bmNfcGFnZXRhYmxlcywKPiAtCX0sCj4gLX07Cj4g
LQo+IC0vKioKPiAtICogYW1kZ3B1X21uX2dldCAtIGNyZWF0ZSBITU0gbWlycm9yIGNvbnRleHQK
PiAtICoKPiAtICogQGFkZXY6IGFtZGdwdSBkZXZpY2UgcG9pbnRlcgo+IC0gKiBAdHlwZTogdHlw
ZSBvZiBNTVUgbm90aWZpZXIgY29udGV4dAo+IC0gKgo+IC0gKiBDcmVhdGVzIGEgSE1NIG1pcnJv
ciBjb250ZXh0IGZvciBjdXJyZW50LT5tbS4KPiAtICovCj4gLXN0cnVjdCBhbWRncHVfbW4gKmFt
ZGdwdV9tbl9nZXQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCj4gLQkJCQllbnVtIGFtZGdw
dV9tbl90eXBlIHR5cGUpCj4gLXsKPiAtCXN0cnVjdCBtbV9zdHJ1Y3QgKm1tID0gY3VycmVudC0+
bW07Cj4gLQlzdHJ1Y3QgYW1kZ3B1X21uICphbW47Cj4gLQl1bnNpZ25lZCBsb25nIGtleSA9IEFN
REdQVV9NTl9LRVkobW0sIHR5cGUpOwo+IC0JaW50IHI7Cj4gLQo+IC0JbXV0ZXhfbG9jaygmYWRl
di0+bW5fbG9jayk7Cj4gLQlpZiAoZG93bl93cml0ZV9raWxsYWJsZSgmbW0tPm1tYXBfc2VtKSkg
ewo+IC0JCW11dGV4X3VubG9jaygmYWRldi0+bW5fbG9jayk7Cj4gLQkJcmV0dXJuIEVSUl9QVFIo
LUVJTlRSKTsKPiAtCX0KPiAtCj4gLQloYXNoX2Zvcl9lYWNoX3Bvc3NpYmxlKGFkZXYtPm1uX2hh
c2gsIGFtbiwgbm9kZSwga2V5KQo+IC0JCWlmIChBTURHUFVfTU5fS0VZKGFtbi0+bWlycm9yLmht
bS0+bW11X25vdGlmaWVyLm1tLAo+IC0JCQkJICBhbW4tPnR5cGUpID09IGtleSkKPiAtCQkJZ290
byByZWxlYXNlX2xvY2tzOwo+IC0KPiAtCWFtbiA9IGt6YWxsb2Moc2l6ZW9mKCphbW4pLCBHRlBf
S0VSTkVMKTsKPiAtCWlmICghYW1uKSB7Cj4gLQkJYW1uID0gRVJSX1BUUigtRU5PTUVNKTsKPiAt
CQlnb3RvIHJlbGVhc2VfbG9ja3M7Cj4gLQl9Cj4gLQo+IC0JYW1uLT5hZGV2ID0gYWRldjsKPiAt
CWluaXRfcndzZW0oJmFtbi0+bG9jayk7Cj4gLQlhbW4tPnR5cGUgPSB0eXBlOwo+IC0KPiAtCWFt
bi0+bWlycm9yLm9wcyA9ICZhbWRncHVfaG1tX21pcnJvcl9vcHNbdHlwZV07Cj4gLQlyID0gaG1t
X21pcnJvcl9yZWdpc3RlcigmYW1uLT5taXJyb3IsIG1tKTsKPiAtCWlmIChyKQo+IC0JCWdvdG8g
ZnJlZV9hbW47Cj4gLQo+IC0JaGFzaF9hZGQoYWRldi0+bW5faGFzaCwgJmFtbi0+bm9kZSwgQU1E
R1BVX01OX0tFWShtbSwgdHlwZSkpOwo+IC0KPiAtcmVsZWFzZV9sb2NrczoKPiAtCXVwX3dyaXRl
KCZtbS0+bW1hcF9zZW0pOwo+IC0JbXV0ZXhfdW5sb2NrKCZhZGV2LT5tbl9sb2NrKTsKPiAtCj4g
LQlyZXR1cm4gYW1uOwo+IC0KPiAtZnJlZV9hbW46Cj4gLQl1cF93cml0ZSgmbW0tPm1tYXBfc2Vt
KTsKPiAtCW11dGV4X3VubG9jaygmYWRldi0+bW5fbG9jayk7Cj4gLQlrZnJlZShhbW4pOwo+IC0K
PiAtCXJldHVybiBFUlJfUFRSKHIpOwo+IC19Cj4gLQo+ICAgLyoqCj4gICAgKiBhbWRncHVfbW5f
cmVnaXN0ZXIgLSByZWdpc3RlciBhIEJPIGZvciBub3RpZmllciB1cGRhdGVzCj4gICAgKgo+IEBA
IC0yMzUsMTIgKzEzMywxMiBAQCBzdHJ1Y3QgYW1kZ3B1X21uICphbWRncHVfbW5fZ2V0KHN0cnVj
dCBhbWRncHVfZGV2aWNlICphZGV2LAo+ICAgaW50IGFtZGdwdV9tbl9yZWdpc3RlcihzdHJ1Y3Qg
YW1kZ3B1X2JvICpibywgdW5zaWduZWQgbG9uZyBhZGRyKQo+ICAgewo+ICAgCWlmIChiby0+a2Zk
X2JvKQo+IC0JCWJvLT5ub3RpZmllci5vcHMgPSAmYW1kZ3B1X21uX2hzYV9vcHM7Cj4gLQllbHNl
Cj4gLQkJYm8tPm5vdGlmaWVyLm9wcyA9ICZhbWRncHVfbW5fZ2Z4X29wczsKPiAtCj4gLQlyZXR1
cm4gbW11X2ludGVydmFsX25vdGlmaWVyX2luc2VydCgmYm8tPm5vdGlmaWVyLCBhZGRyLAo+IC0J
CQkJCSAgICBhbWRncHVfYm9fc2l6ZShibyksIGN1cnJlbnQtPm1tKTsKPiArCQlyZXR1cm4gbW11
X2ludGVydmFsX25vdGlmaWVyX2luc2VydCgmYm8tPm5vdGlmaWVyLCBjdXJyZW50LT5tbSwKPiAr
CQkJCQkJICAgIGFkZHIsIGFtZGdwdV9ib19zaXplKGJvKSwKPiArCQkJCQkJICAgICZhbWRncHVf
bW5faHNhX29wcyk7Cj4gKwlyZXR1cm4gbW11X2ludGVydmFsX25vdGlmaWVyX2luc2VydCgmYm8t
Pm5vdGlmaWVyLCBjdXJyZW50LT5tbSwgYWRkciwKPiArCQkJCQkgICAgYW1kZ3B1X2JvX3NpemUo
Ym8pLAo+ICsJCQkJCSAgICAmYW1kZ3B1X21uX2dmeF9vcHMpOwo+ICAgfQo+ICAgCj4gICAvKioK
PiBAQCAtMjU3LDI1ICsxNTUsMyBAQCB2b2lkIGFtZGdwdV9tbl91bnJlZ2lzdGVyKHN0cnVjdCBh
bWRncHVfYm8gKmJvKQo+ICAgCW1tdV9pbnRlcnZhbF9ub3RpZmllcl9yZW1vdmUoJmJvLT5ub3Rp
Zmllcik7Cj4gICAJYm8tPm5vdGlmaWVyLm1tID0gTlVMTDsKPiAgIH0KPiAtCj4gLS8qIGZsYWdz
IHVzZWQgYnkgSE1NIGludGVybmFsLCBub3QgcmVsYXRlZCB0byBDUFUvR1BVIFBURSBmbGFncyAq
Lwo+IC1zdGF0aWMgY29uc3QgdWludDY0X3QgaG1tX3JhbmdlX2ZsYWdzW0hNTV9QRk5fRkxBR19N
QVhdID0gewo+IC0JCSgxIDw8IDApLCAvKiBITU1fUEZOX1ZBTElEICovCj4gLQkJKDEgPDwgMSks
IC8qIEhNTV9QRk5fV1JJVEUgKi8KPiAtCQkwIC8qIEhNTV9QRk5fREVWSUNFX1BSSVZBVEUgKi8K
PiAtfTsKPiAtCj4gLXN0YXRpYyBjb25zdCB1aW50NjRfdCBobW1fcmFuZ2VfdmFsdWVzW0hNTV9Q
Rk5fVkFMVUVfTUFYXSA9IHsKPiAtCQkweGZmZmZmZmZmZmZmZmZmZmVVTCwgLyogSE1NX1BGTl9F
UlJPUiAqLwo+IC0JCTAsIC8qIEhNTV9QRk5fTk9ORSAqLwo+IC0JCTB4ZmZmZmZmZmZmZmZmZmZm
Y1VMIC8qIEhNTV9QRk5fU1BFQ0lBTCAqLwo+IC19Owo+IC0KPiAtdm9pZCBhbWRncHVfaG1tX2lu
aXRfcmFuZ2Uoc3RydWN0IGhtbV9yYW5nZSAqcmFuZ2UpCj4gLXsKPiAtCWlmIChyYW5nZSkgewo+
IC0JCXJhbmdlLT5mbGFncyA9IGhtbV9yYW5nZV9mbGFnczsKPiAtCQlyYW5nZS0+dmFsdWVzID0g
aG1tX3JhbmdlX3ZhbHVlczsKPiAtCQlyYW5nZS0+cGZuX3NoaWZ0ID0gUEFHRV9TSElGVDsKPiAt
CX0KPiAtfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
bW4uaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9tbi5oCj4gaW5kZXggZDcz
YWIyOTQ3YjIyYjIuLmEyOTIyMzhmNzVlYmFlIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV9tbi5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X21uLmgKPiBAQCAtMzAsNTkgKzMwLDEwIEBACj4gICAjaW5jbHVkZSA8bGludXgv
d29ya3F1ZXVlLmg+Cj4gICAjaW5jbHVkZSA8bGludXgvaW50ZXJ2YWxfdHJlZS5oPgo+ICAgCj4g
LWVudW0gYW1kZ3B1X21uX3R5cGUgewo+IC0JQU1ER1BVX01OX1RZUEVfR0ZYLAo+IC0JQU1ER1BV
X01OX1RZUEVfSFNBLAo+IC19Owo+IC0KPiAtLyoqCj4gLSAqIHN0cnVjdCBhbWRncHVfbW4KPiAt
ICoKPiAtICogQGFkZXY6IGFtZGdwdSBkZXZpY2UgcG9pbnRlcgo+IC0gKiBAdHlwZTogdHlwZSBv
ZiBNTVUgbm90aWZpZXIKPiAtICogQHdvcms6IGRlc3RydWN0aW9uIHdvcmsgaXRlbQo+IC0gKiBA
bm9kZTogaGFzaCB0YWJsZSBub2RlIHRvIGZpbmQgc3RydWN0dXJlIGJ5IGFkZXYgYW5kIG1uCj4g
LSAqIEBsb2NrOiBydyBzZW1hcGhvcmUgcHJvdGVjdGluZyB0aGUgbm90aWZpZXIgbm9kZXMKPiAt
ICogQG1pcnJvcjogSE1NIG1pcnJvciBmdW5jdGlvbiBzdXBwb3J0Cj4gLSAqCj4gLSAqIERhdGEg
Zm9yIGVhY2ggYW1kZ3B1IGRldmljZSBhbmQgcHJvY2VzcyBhZGRyZXNzIHNwYWNlLgo+IC0gKi8K
PiAtc3RydWN0IGFtZGdwdV9tbiB7Cj4gLQkvKiBjb25zdGFudCBhZnRlciBpbml0aWFsaXNhdGlv
biAqLwo+IC0Jc3RydWN0IGFtZGdwdV9kZXZpY2UJKmFkZXY7Cj4gLQllbnVtIGFtZGdwdV9tbl90
eXBlCXR5cGU7Cj4gLQo+IC0JLyogb25seSB1c2VkIG9uIGRlc3RydWN0aW9uICovCj4gLQlzdHJ1
Y3Qgd29ya19zdHJ1Y3QJd29yazsKPiAtCj4gLQkvKiBwcm90ZWN0ZWQgYnkgYWRldi0+bW5fbG9j
ayAqLwo+IC0Jc3RydWN0IGhsaXN0X25vZGUJbm9kZTsKPiAtCj4gLQkvKiBvYmplY3RzIHByb3Rl
Y3RlZCBieSBsb2NrICovCj4gLQlzdHJ1Y3Qgcndfc2VtYXBob3JlCWxvY2s7Cj4gLQo+IC0jaWZk
ZWYgQ09ORklHX0hNTV9NSVJST1IKPiAtCS8qIEhNTSBtaXJyb3IgKi8KPiAtCXN0cnVjdCBobW1f
bWlycm9yCW1pcnJvcjsKPiAtI2VuZGlmCj4gLX07Cj4gLQo+ICAgI2lmIGRlZmluZWQoQ09ORklH
X0hNTV9NSVJST1IpCj4gLXZvaWQgYW1kZ3B1X21uX2xvY2soc3RydWN0IGFtZGdwdV9tbiAqbW4p
Owo+IC12b2lkIGFtZGdwdV9tbl91bmxvY2soc3RydWN0IGFtZGdwdV9tbiAqbW4pOwo+IC1zdHJ1
Y3QgYW1kZ3B1X21uICphbWRncHVfbW5fZ2V0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAo+
IC0JCQkJZW51bSBhbWRncHVfbW5fdHlwZSB0eXBlKTsKPiAgIGludCBhbWRncHVfbW5fcmVnaXN0
ZXIoc3RydWN0IGFtZGdwdV9ibyAqYm8sIHVuc2lnbmVkIGxvbmcgYWRkcik7Cj4gICB2b2lkIGFt
ZGdwdV9tbl91bnJlZ2lzdGVyKHN0cnVjdCBhbWRncHVfYm8gKmJvKTsKPiAtdm9pZCBhbWRncHVf
aG1tX2luaXRfcmFuZ2Uoc3RydWN0IGhtbV9yYW5nZSAqcmFuZ2UpOwo+ICAgI2Vsc2UKPiAtc3Rh
dGljIGlubGluZSB2b2lkIGFtZGdwdV9tbl9sb2NrKHN0cnVjdCBhbWRncHVfbW4gKm1uKSB7fQo+
IC1zdGF0aWMgaW5saW5lIHZvaWQgYW1kZ3B1X21uX3VubG9jayhzdHJ1Y3QgYW1kZ3B1X21uICpt
bikge30KPiAtc3RhdGljIGlubGluZSBzdHJ1Y3QgYW1kZ3B1X21uICphbWRncHVfbW5fZ2V0KHN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAo+IC0JCQkJCSAgICAgIGVudW0gYW1kZ3B1X21uX3R5
cGUgdHlwZSkKPiAtewo+IC0JcmV0dXJuIE5VTEw7Cj4gLX0KPiAgIHN0YXRpYyBpbmxpbmUgaW50
IGFtZGdwdV9tbl9yZWdpc3RlcihzdHJ1Y3QgYW1kZ3B1X2JvICpibywgdW5zaWduZWQgbG9uZyBh
ZGRyKQo+ICAgewo+ICAgCURSTV9XQVJOX09OQ0UoIkhNTV9NSVJST1Iga2VybmVsIGNvbmZpZyBv
cHRpb24gaXMgbm90IGVuYWJsZWQsICIKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1X3R0bS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X3R0bS5jCj4gaW5kZXggYzBlNDFmMWYwYzIzNjUuLmM0MWEyNmJkZTg1MmU2IDEwMDY0NAo+IC0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYwo+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYwo+IEBAIC03NzMsNiArNzczLDIwIEBA
IHN0cnVjdCBhbWRncHVfdHRtX3R0IHsKPiAgICNlbmRpZgo+ICAgfTsKPiAgIAo+ICsjaWZkZWYg
Q09ORklHX0RSTV9BTURHUFVfVVNFUlBUUgo+ICsvKiBmbGFncyB1c2VkIGJ5IEhNTSBpbnRlcm5h
bCwgbm90IHJlbGF0ZWQgdG8gQ1BVL0dQVSBQVEUgZmxhZ3MgKi8KPiArc3RhdGljIGNvbnN0IHVp
bnQ2NF90IGhtbV9yYW5nZV9mbGFnc1tITU1fUEZOX0ZMQUdfTUFYXSA9IHsKPiArCSgxIDw8IDAp
LCAvKiBITU1fUEZOX1ZBTElEICovCj4gKwkoMSA8PCAxKSwgLyogSE1NX1BGTl9XUklURSAqLwo+
ICsJMCAvKiBITU1fUEZOX0RFVklDRV9QUklWQVRFICovCj4gK307Cj4gKwo+ICtzdGF0aWMgY29u
c3QgdWludDY0X3QgaG1tX3JhbmdlX3ZhbHVlc1tITU1fUEZOX1ZBTFVFX01BWF0gPSB7Cj4gKwkw
eGZmZmZmZmZmZmZmZmZmZmVVTCwgLyogSE1NX1BGTl9FUlJPUiAqLwo+ICsJMCwgLyogSE1NX1BG
Tl9OT05FICovCj4gKwkweGZmZmZmZmZmZmZmZmZmZmNVTCAvKiBITU1fUEZOX1NQRUNJQUwgKi8K
PiArfTsKPiArCj4gICAvKioKPiAgICAqIGFtZGdwdV90dG1fdHRfZ2V0X3VzZXJfcGFnZXMgLSBn
ZXQgZGV2aWNlIGFjY2Vzc2libGUgcGFnZXMgdGhhdCBiYWNrIHVzZXIKPiAgICAqIG1lbW9yeSBh
bmQgc3RhcnQgSE1NIHRyYWNraW5nIENQVSBwYWdlIHRhYmxlIHVwZGF0ZQo+IEBAIC03ODAsMjkg
Kzc5NCwyOCBAQCBzdHJ1Y3QgYW1kZ3B1X3R0bV90dCB7Cj4gICAgKiBDYWxsaW5nIGZ1bmN0aW9u
IG11c3QgY2FsbCBhbWRncHVfdHRtX3R0X3VzZXJwdHJfcmFuZ2VfZG9uZSgpIG9uY2UgYW5kIG9u
bHkKPiAgICAqIG9uY2UgYWZ0ZXJ3YXJkcyB0byBzdG9wIEhNTSB0cmFja2luZwo+ICAgICovCj4g
LSNpZiBJU19FTkFCTEVEKENPTkZJR19EUk1fQU1ER1BVX1VTRVJQVFIpCj4gLQo+IC0jZGVmaW5l
IE1BWF9SRVRSWV9ITU1fUkFOR0VfRkFVTFQJMTYKPiAtCj4gICBpbnQgYW1kZ3B1X3R0bV90dF9n
ZXRfdXNlcl9wYWdlcyhzdHJ1Y3QgYW1kZ3B1X2JvICpibywgc3RydWN0IHBhZ2UgKipwYWdlcykK
PiAgIHsKPiAtCXN0cnVjdCBobW1fbWlycm9yICptaXJyb3IgPSBiby0+bW4gPyAmYm8tPm1uLT5t
aXJyb3IgOiBOVUxMOwo+ICAgCXN0cnVjdCB0dG1fdHQgKnR0bSA9IGJvLT50Ym8udHRtOwo+ICAg
CXN0cnVjdCBhbWRncHVfdHRtX3R0ICpndHQgPSAodm9pZCAqKXR0bTsKPiAtCXN0cnVjdCBtbV9z
dHJ1Y3QgKm1tOwo+ICAgCXVuc2lnbmVkIGxvbmcgc3RhcnQgPSBndHQtPnVzZXJwdHI7Cj4gICAJ
c3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWE7Cj4gICAJc3RydWN0IGhtbV9yYW5nZSAqcmFuZ2U7
Cj4gKwl1bnNpZ25lZCBsb25nIHRpbWVvdXQ7Cj4gKwlzdHJ1Y3QgbW1fc3RydWN0ICptbTsKPiAg
IAl1bnNpZ25lZCBsb25nIGk7Cj4gLQl1aW50NjRfdCAqcGZuczsKPiAgIAlpbnQgciA9IDA7Cj4g
ICAKPiAtCWlmICh1bmxpa2VseSghbWlycm9yKSkgewo+IC0JCURSTV9ERUJVR19EUklWRVIoIkZh
aWxlZCB0byBnZXQgaG1tX21pcnJvclxuIik7Cj4gKwltbSA9IGJvLT5ub3RpZmllci5tbTsKPiAr
CWlmICh1bmxpa2VseSghbW0pKSB7Cj4gKwkJRFJNX0RFQlVHX0RSSVZFUigiQk8gaXMgbm90IHJl
Z2lzdGVyZWQ/XG4iKTsKPiAgIAkJcmV0dXJuIC1FRkFVTFQ7Cj4gICAJfQo+ICAgCj4gLQltbSA9
IG1pcnJvci0+aG1tLT5tbXVfbm90aWZpZXIubW07Cj4gKwkvKiBBbm90aGVyIGdldF91c2VyX3Bh
Z2VzIGlzIHJ1bm5pbmcgYXQgdGhlIHNhbWUgdGltZT8/ICovCj4gKwlpZiAoV0FSTl9PTihndHQt
PnJhbmdlKSkKPiArCQlyZXR1cm4gLUVGQVVMVDsKPiArCj4gICAJaWYgKCFtbWdldF9ub3RfemVy
byhtbSkpIC8qIEhhcHBlbnMgZHVyaW5nIHByb2Nlc3Mgc2h1dGRvd24gKi8KPiAgIAkJcmV0dXJu
IC1FU1JDSDsKPiAgIAo+IEBAIC04MTEsMzEgKzgyNCwyMyBAQCBpbnQgYW1kZ3B1X3R0bV90dF9n
ZXRfdXNlcl9wYWdlcyhzdHJ1Y3QgYW1kZ3B1X2JvICpibywgc3RydWN0IHBhZ2UgKipwYWdlcykK
PiAgIAkJciA9IC1FTk9NRU07Cj4gICAJCWdvdG8gb3V0Owo+ICAgCX0KPiArCXJhbmdlLT5ub3Rp
ZmllciA9ICZiby0+bm90aWZpZXI7Cj4gKwlyYW5nZS0+ZmxhZ3MgPSBobW1fcmFuZ2VfZmxhZ3M7
Cj4gKwlyYW5nZS0+dmFsdWVzID0gaG1tX3JhbmdlX3ZhbHVlczsKPiArCXJhbmdlLT5wZm5fc2hp
ZnQgPSBQQUdFX1NISUZUOwo+ICsJcmFuZ2UtPnN0YXJ0ID0gYm8tPm5vdGlmaWVyLmludGVydmFs
X3RyZWUuc3RhcnQ7Cj4gKwlyYW5nZS0+ZW5kID0gYm8tPm5vdGlmaWVyLmludGVydmFsX3RyZWUu
bGFzdCArIDE7Cj4gKwlyYW5nZS0+ZGVmYXVsdF9mbGFncyA9IGhtbV9yYW5nZV9mbGFnc1tITU1f
UEZOX1ZBTElEXTsKPiArCWlmICghYW1kZ3B1X3R0bV90dF9pc19yZWFkb25seSh0dG0pKQo+ICsJ
CXJhbmdlLT5kZWZhdWx0X2ZsYWdzIHw9IHJhbmdlLT5mbGFnc1tITU1fUEZOX1dSSVRFXTsKPiAg
IAo+IC0JcGZucyA9IGt2bWFsbG9jX2FycmF5KHR0bS0+bnVtX3BhZ2VzLCBzaXplb2YoKnBmbnMp
LCBHRlBfS0VSTkVMKTsKPiAtCWlmICh1bmxpa2VseSghcGZucykpIHsKPiArCXJhbmdlLT5wZm5z
ID0ga3ZtYWxsb2NfYXJyYXkodHRtLT5udW1fcGFnZXMsIHNpemVvZigqcmFuZ2UtPnBmbnMpLAo+
ICsJCQkJICAgICBHRlBfS0VSTkVMKTsKPiArCWlmICh1bmxpa2VseSghcmFuZ2UtPnBmbnMpKSB7
Cj4gICAJCXIgPSAtRU5PTUVNOwo+ICAgCQlnb3RvIG91dF9mcmVlX3JhbmdlczsKPiAgIAl9Cj4g
ICAKPiAtCWFtZGdwdV9obW1faW5pdF9yYW5nZShyYW5nZSk7Cj4gLQlyYW5nZS0+ZGVmYXVsdF9m
bGFncyA9IHJhbmdlLT5mbGFnc1tITU1fUEZOX1ZBTElEXTsKPiAtCXJhbmdlLT5kZWZhdWx0X2Zs
YWdzIHw9IGFtZGdwdV90dG1fdHRfaXNfcmVhZG9ubHkodHRtKSA/Cj4gLQkJCQkwIDogcmFuZ2Ut
PmZsYWdzW0hNTV9QRk5fV1JJVEVdOwo+IC0JcmFuZ2UtPnBmbl9mbGFnc19tYXNrID0gMDsKPiAt
CXJhbmdlLT5wZm5zID0gcGZuczsKPiAtCXJhbmdlLT5zdGFydCA9IHN0YXJ0Owo+IC0JcmFuZ2Ut
PmVuZCA9IHN0YXJ0ICsgdHRtLT5udW1fcGFnZXMgKiBQQUdFX1NJWkU7Cj4gLQo+IC0JaG1tX3Jh
bmdlX3JlZ2lzdGVyKHJhbmdlLCBtaXJyb3IpOwo+IC0KPiAtCS8qCj4gLQkgKiBKdXN0IHdhaXQg
Zm9yIHJhbmdlIHRvIGJlIHZhbGlkLCBzYWZlIHRvIGlnbm9yZSByZXR1cm4gdmFsdWUgYXMgd2UK
PiAtCSAqIHdpbGwgdXNlIHRoZSByZXR1cm4gdmFsdWUgb2YgaG1tX3JhbmdlX2ZhdWx0KCkgYmVs
b3cgdW5kZXIgdGhlCj4gLQkgKiBtbWFwX3NlbSB0byBhc2NlcnRhaW4gdGhlIHZhbGlkaXR5IG9m
IHRoZSByYW5nZS4KPiAtCSAqLwo+IC0JaG1tX3JhbmdlX3dhaXRfdW50aWxfdmFsaWQocmFuZ2Us
IEhNTV9SQU5HRV9ERUZBVUxUX1RJTUVPVVQpOwo+IC0KPiAgIAlkb3duX3JlYWQoJm1tLT5tbWFw
X3NlbSk7Cj4gICAJdm1hID0gZmluZF92bWEobW0sIHN0YXJ0KTsKPiAgIAlpZiAodW5saWtlbHko
IXZtYSB8fCBzdGFydCA8IHZtYS0+dm1fc3RhcnQpKSB7Cj4gQEAgLTg0NywxOCArODUyLDMxIEBA
IGludCBhbWRncHVfdHRtX3R0X2dldF91c2VyX3BhZ2VzKHN0cnVjdCBhbWRncHVfYm8gKmJvLCBz
dHJ1Y3QgcGFnZSAqKnBhZ2VzKQo+ICAgCQlyID0gLUVQRVJNOwo+ICAgCQlnb3RvIG91dF91bmxv
Y2s7Cj4gICAJfQo+ICsJdXBfcmVhZCgmbW0tPm1tYXBfc2VtKTsKPiArCXRpbWVvdXQgPSBqaWZm
aWVzICsgbXNlY3NfdG9famlmZmllcyhITU1fUkFOR0VfREVGQVVMVF9USU1FT1VUKTsKPiAgIAo+
ICtyZXRyeToKPiArCXJhbmdlLT5ub3RpZmllcl9zZXEgPSBtbXVfaW50ZXJ2YWxfcmVhZF9iZWdp
bigmYm8tPm5vdGlmaWVyKTsKPiArCj4gKwlkb3duX3JlYWQoJm1tLT5tbWFwX3NlbSk7Cj4gICAJ
ciA9IGhtbV9yYW5nZV9mYXVsdChyYW5nZSwgMCk7Cj4gICAJdXBfcmVhZCgmbW0tPm1tYXBfc2Vt
KTsKPiAtCj4gLQlpZiAodW5saWtlbHkociA8IDApKQo+ICsJaWYgKHVubGlrZWx5KHIgPD0gMCkp
IHsKPiArCQkvKgo+ICsJCSAqIEZJWE1FOiBUaGlzIHRpbWVvdXQgc2hvdWxkIGVuY29tcGFzcyB0
aGUgcmV0cnkgZnJvbQo+ICsJCSAqIG1tdV9pbnRlcnZhbF9yZWFkX3JldHJ5KCkgYXMgd2VsbC4K
PiArCQkgKi8KPiArCQlpZiAoKHIgPT0gMCB8fCByID09IC1FQlVTWSkgJiYgIXRpbWVfYWZ0ZXIo
amlmZmllcywgdGltZW91dCkpCj4gKwkJCWdvdG8gcmV0cnk7Cj4gICAJCWdvdG8gb3V0X2ZyZWVf
cGZuczsKPiArCX0KPiAgIAo+ICAgCWZvciAoaSA9IDA7IGkgPCB0dG0tPm51bV9wYWdlczsgaSsr
KSB7Cj4gLQkJcGFnZXNbaV0gPSBobW1fZGV2aWNlX2VudHJ5X3RvX3BhZ2UocmFuZ2UsIHBmbnNb
aV0pOwo+ICsJCS8qIEZJWE1FOiBUaGUgcGFnZXMgY2Fubm90IGJlIHRvdWNoZWQgb3V0c2lkZSB0
aGUgbm90aWZpZXJfbG9jayAqLwo+ICsJCXBhZ2VzW2ldID0gaG1tX2RldmljZV9lbnRyeV90b19w
YWdlKHJhbmdlLCByYW5nZS0+cGZuc1tpXSk7Cj4gICAJCWlmICh1bmxpa2VseSghcGFnZXNbaV0p
KSB7Cj4gICAJCQlwcl9lcnIoIlBhZ2UgZmF1bHQgZmFpbGVkIGZvciBwZm5bJWx1XSA9IDB4JWxs
eFxuIiwKPiAtCQkJICAgICAgIGksIHBmbnNbaV0pOwo+ICsJCQkgICAgICAgaSwgcmFuZ2UtPnBm
bnNbaV0pOwo+ICAgCQkJciA9IC1FTk9NRU07Cj4gICAKPiAgIAkJCWdvdG8gb3V0X2ZyZWVfcGZu
czsKPiBAQCAtODczLDggKzg5MSw3IEBAIGludCBhbWRncHVfdHRtX3R0X2dldF91c2VyX3BhZ2Vz
KHN0cnVjdCBhbWRncHVfYm8gKmJvLCBzdHJ1Y3QgcGFnZSAqKnBhZ2VzKQo+ICAgb3V0X3VubG9j
azoKPiAgIAl1cF9yZWFkKCZtbS0+bW1hcF9zZW0pOwo+ICAgb3V0X2ZyZWVfcGZuczoKPiAtCWht
bV9yYW5nZV91bnJlZ2lzdGVyKHJhbmdlKTsKPiAtCWt2ZnJlZShwZm5zKTsKPiArCWt2ZnJlZShy
YW5nZS0+cGZucyk7Cj4gICBvdXRfZnJlZV9yYW5nZXM6Cj4gICAJa2ZyZWUocmFuZ2UpOwo+ICAg
b3V0Ogo+IEBAIC05MDMsMTUgKzkyMCwxOCBAQCBib29sIGFtZGdwdV90dG1fdHRfZ2V0X3VzZXJf
cGFnZXNfZG9uZShzdHJ1Y3QgdHRtX3R0ICp0dG0pCj4gICAJCSJObyB1c2VyIHBhZ2VzIHRvIGNo
ZWNrXG4iKTsKPiAgIAo+ICAgCWlmIChndHQtPnJhbmdlKSB7Cj4gLQkJciA9IGhtbV9yYW5nZV92
YWxpZChndHQtPnJhbmdlKTsKPiAtCQlobW1fcmFuZ2VfdW5yZWdpc3RlcihndHQtPnJhbmdlKTsK
PiAtCj4gKwkJLyoKPiArCQkgKiBGSVhNRTogTXVzdCBhbHdheXMgaG9sZCBub3RpZmllcl9sb2Nr
IGZvciB0aGlzLCBhbmQgbXVzdAo+ICsJCSAqIG5vdCBpZ25vcmUgdGhlIHJldHVybiBjb2RlLgo+
ICsJCSAqLwo+ICsJCXIgPSBtbXVfaW50ZXJ2YWxfcmVhZF9yZXRyeShndHQtPnJhbmdlLT5ub3Rp
ZmllciwKPiArCQkJCQkgZ3R0LT5yYW5nZS0+bm90aWZpZXJfc2VxKTsKPiAgIAkJa3ZmcmVlKGd0
dC0+cmFuZ2UtPnBmbnMpOwo+ICAgCQlrZnJlZShndHQtPnJhbmdlKTsKPiAgIAkJZ3R0LT5yYW5n
ZSA9IE5VTEw7Cj4gICAJfQo+ICAgCj4gLQlyZXR1cm4gcjsKPiArCXJldHVybiAhcjsKPiAgIH0K
PiAgICNlbmRpZgo+ICAgCj4gQEAgLTk5MiwxMCArMTAxMiwxOCBAQCBzdGF0aWMgdm9pZCBhbWRn
cHVfdHRtX3R0X3VucGluX3VzZXJwdHIoc3RydWN0IHR0bV90dCAqdHRtKQo+ICAgCXNnX2ZyZWVf
dGFibGUodHRtLT5zZyk7Cj4gICAKPiAgICNpZiBJU19FTkFCTEVEKENPTkZJR19EUk1fQU1ER1BV
X1VTRVJQVFIpCj4gLQlpZiAoZ3R0LT5yYW5nZSAmJgo+IC0JICAgIHR0bS0+cGFnZXNbMF0gPT0g
aG1tX2RldmljZV9lbnRyeV90b19wYWdlKGd0dC0+cmFuZ2UsCj4gLQkJCQkJCSAgICAgIGd0dC0+
cmFuZ2UtPnBmbnNbMF0pKQo+IC0JCVdBUk5fT05DRSgxLCAiTWlzc2luZyBnZXRfdXNlcl9wYWdl
X2RvbmVcbiIpOwo+ICsJaWYgKGd0dC0+cmFuZ2UpIHsKPiArCQl1bnNpZ25lZCBsb25nIGk7Cj4g
Kwo+ICsJCWZvciAoaSA9IDA7IGkgPCB0dG0tPm51bV9wYWdlczsgaSsrKSB7Cj4gKwkJCWlmICh0
dG0tPnBhZ2VzW2ldICE9Cj4gKwkJCQlobW1fZGV2aWNlX2VudHJ5X3RvX3BhZ2UoZ3R0LT5yYW5n
ZSwKPiArCQkJCQkgICAgICBndHQtPnJhbmdlLT5wZm5zW2ldKSkKPiArCQkJCWJyZWFrOwo+ICsJ
CX0KPiArCj4gKwkJV0FSTigoaSA9PSB0dG0tPm51bV9wYWdlcyksICJNaXNzaW5nIGdldF91c2Vy
X3BhZ2VfZG9uZVxuIik7Cj4gKwl9Cj4gICAjZW5kaWYKPiAgIH0KPiAgIAo+IApfX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBs
aXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVz
a3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
