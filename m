Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 44104B743B
	for <lists+dri-devel@lfdr.de>; Thu, 19 Sep 2019 09:36:24 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F13EA6F9F5;
	Thu, 19 Sep 2019 07:36:14 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-pf1-x443.google.com (mail-pf1-x443.google.com
 [IPv6:2607:f8b0:4864:20::443])
 by gabe.freedesktop.org (Postfix) with ESMTPS id F38E66F468
 for <dri-devel@lists.freedesktop.org>; Thu, 19 Sep 2019 06:16:35 +0000 (UTC)
Received: by mail-pf1-x443.google.com with SMTP id y22so1579390pfr.3
 for <dri-devel@lists.freedesktop.org>; Wed, 18 Sep 2019 23:16:35 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id;
 bh=DfYIaYtzRDKrh/EWpYcz74xxIZg77HEnPNIMsOLe0ok=;
 b=mksELLFvwcvRyK8rxneuUmXUVMJp8HU4ViCaTceQ/tq8bH6LC7AnPI/dD8E9pnrbPT
 I65zDXJ3C097BNnAcuwrjjznEW6h9gk6tjY7TGKow+nolYZXLvN3bViFHJez+cSSPhj+
 du15TXObBeeoCcVIq9NM5cY0dQXOC2h/Bdw44WzJzIxalfsKed3YU2LA4pGNFo8TFuZG
 Ehd+70ZjspgzqYLrv2REK3NpcQsFnIKcUnp/gvfrqpLDM9V7y+sG7xdvBGsNIH/7bBEN
 Xt/KVAUaeHN2yBULkT/OkmlNSExu32MoaveRKJWSeVKXgeafFJ3aYUu3AHcB1vMMGiX5
 YfrA==
X-Gm-Message-State: APjAAAX+qSdnfw2ihbU9emmBGocJBV+o6IY2XzAZ5UvW14LVl2U17GWD
 ZU+/FL3uKFwBfG3XjVJARCIeaav0fvs=
X-Google-Smtp-Source: APXvYqwgVTYgWSQTMmU2+KSU40xERESDK3dg+yIgU6CK2dsnUvK0XQUMMfX+JvYWzBYmurzKgX1jNg==
X-Received: by 2002:a17:90a:ff18:: with SMTP id
 ce24mr2025811pjb.0.1568873795086; 
 Wed, 18 Sep 2019 23:16:35 -0700 (PDT)
Received: from super-sugar.huaqin.com ([101.78.151.194])
 by smtp.gmail.com with ESMTPSA id y17sm9898413pfo.171.2019.09.18.23.16.33
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Wed, 18 Sep 2019 23:16:34 -0700 (PDT)
From: Jerry Han <jerry.han.hq@gmail.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 1/9] [v10, 1/9] drm/panel:Add Boe Himax8279d MIPI-DSI LCD panel
Date: Thu, 19 Sep 2019 14:16:22 +0800
Message-Id: <20190919061622.2040-1-jerry.han.hq@gmail.com>
X-Mailer: git-send-email 2.17.1
X-Mailman-Approved-At: Thu, 19 Sep 2019 07:35:45 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id;
 bh=DfYIaYtzRDKrh/EWpYcz74xxIZg77HEnPNIMsOLe0ok=;
 b=XpFodyxN46SpmfIvE1wIO71RntFoxATqc0acKcpOKHDBiIY0+JrLpnpU7/Tab1DNVv
 HZiY7O7ewzgJTFDgkbKVIVySdI+Vz0ZqV9ZRolwIF+DVcDMts+2t+atyjoOUNRUaDSsW
 DXIP5bULuC712gTArgGQ5O+E0iavk896UTIg1VB8UUF2oNo8FI+0gC0TsTd8DpFCY/LR
 AkDGA0F3yeusMk1WM83zJ2/4vOS0S7N6wzgpaenokhil174gk36/wjDD8yUOPar5Y905
 yXyudzyy8SOfqEZbdt7OcWVmkUeK7IWw84JsMmkVE0H0G7gtNsTUG98wgZwK1GF8Zjxa
 g1BQ==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Jerry Han <jerry.han.hq@gmail.com>,
 Jerry Han <hanxu5@huaqin.corp-partner.google.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIHBhbmVsIGRyaXZlciBmb3IgaXQuCgpTaWduZWQtb2ZmLWJ5OiBKZXJyeSBIYW4gPGhhbnh1
NUBodWFxaW4uY29ycC1wYXJ0bmVyLmdvb2dsZS5jb20+Ci0tLQogTUFJTlRBSU5FUlMgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDYgKwogZHJpdmVycy9ncHUvZHJtL3BhbmVs
L0tjb25maWcgICAgICAgICAgICAgICAgfCAgMTEgKwogZHJpdmVycy9ncHUvZHJtL3BhbmVsL01h
a2VmaWxlICAgICAgICAgICAgICAgfCAgIDEgKwogZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVs
LWJvZS1oaW1heDgyNzlkLmMgfCA1OTMgKysrKysrKysrKysrKysrKysrKwogNCBmaWxlcyBjaGFu
Z2VkLCA2MTEgaW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2Ry
bS9wYW5lbC9wYW5lbC1ib2UtaGltYXg4Mjc5ZC5jCgpkaWZmIC0tZ2l0IGEvTUFJTlRBSU5FUlMg
Yi9NQUlOVEFJTkVSUwppbmRleCAyOGY0YTIwOTQwY2IuLjdjNmFjMThiOTIyZSAxMDA2NDQKLS0t
IGEvTUFJTlRBSU5FUlMKKysrIGIvTUFJTlRBSU5FUlMKQEAgLTUxMTAsNiArNTExMCwxMiBAQCBT
OglNYWludGFpbmVkCiBGOglkcml2ZXJzL2dwdS9kcm0vdGlueS9pbGk5MjI1LmMKIEY6CURvY3Vt
ZW50YXRpb24vZGV2aWNldHJlZS9iaW5kaW5ncy9kaXNwbGF5L2lsaXRlayxpbGk5MjI1LnR4dAog
CitEUk0gRFJJVkVSIEZPUiBCT0UgSElNQVg4Mjc5RCBQQU5FTFMKK006CUplcnJ5IEhhbiA8aGFu
eHU1QGh1YXFpbi5jb3JwLXBhcnRuZXIuZ29vZ2xlLmNvbT4KK1M6CU1haW50YWluZWQKK0Y6CWRy
aXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1ib2UtaGltYXg4Mjc5ZC5jCitGOglEb2N1bWVudGF0
aW9uL2RldmljZXRyZWUvYmluZGluZ3MvZGlzcGxheS9wYW5lbC9ib2UsaGltYXg4Mjc5ZC50eHQK
KwogRFJNIERSSVZFUiBGT1IgSFg4MzU3RCBQQU5FTFMKIE06CUVyaWMgQW5ob2x0IDxlcmljQGFu
aG9sdC5uZXQ+CiBUOglnaXQgZ2l0Oi8vYW5vbmdpdC5mcmVlZGVza3RvcC5vcmcvZHJtL2RybS1t
aXNjCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvS2NvbmZpZyBiL2RyaXZlcnMv
Z3B1L2RybS9wYW5lbC9LY29uZmlnCmluZGV4IGYxNTJiYzRlZWI1My4uY2ZkOGM4ODZmZmY3IDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvS2NvbmZpZworKysgYi9kcml2ZXJzL2dw
dS9kcm0vcGFuZWwvS2NvbmZpZwpAQCAtMzM5LDYgKzMzOSwxNyBAQCBjb25maWcgRFJNX1BBTkVM
X1RQT19URDA0M01URUExCiAJICBTYXkgWSBoZXJlIGlmIHlvdSB3YW50IHRvIGVuYWJsZSBzdXBw
b3J0IGZvciBUUE8gVEQwNDNNVEVBMSA4MDB4NDgwCiAJICA0LjMiIHBhbmVsIChmb3VuZCBvbiB0
aGUgT01BUDMgUGFuZG9yYSBib2FyZCkuCiAKK2NvbmZpZyBEUk1fUEFORUxfQk9FX0hJTUFYODI3
OUQKKwl0cmlzdGF0ZSAiQm9lIEhpbWF4ODI3OWQgcGFuZWwiCisJZGVwZW5kcyBvbiBPRgorCWRl
cGVuZHMgb24gRFJNX01JUElfRFNJCisJZGVwZW5kcyBvbiBCQUNLTElHSFRfQ0xBU1NfREVWSUNF
CisJaGVscAorCSAgU2F5IFkgaGVyZSBpZiB5b3Ugd2FudCB0byBlbmFibGUgc3VwcG9ydCBmb3Ig
U2FtZSB0eXBlCisJICBURlQtTENEIG1vZHVsZXMuIFRoZSBwYW5lbCBoYXMgYSAxMjAweDE5MjAg
cmVzb2x1dGlvbiBhbmQgdXNlcworCSAgMjQgYml0IFJHQiBwZXIgcGl4ZWwuIEl0IHByb3ZpZGVz
IGEgTUlQSSBEU0kgaW50ZXJmYWNlIHRvCisJICB0aGUgaG9zdCBhbmQgaGFzIGEgYnVpbHQtaW4g
TEVEIGJhY2tsaWdodC4KKwogY29uZmlnIERSTV9QQU5FTF9UUE9fVFBHMTEwCiAJdHJpc3RhdGUg
IlRQTyBUUEcgODAweDQwMCBwYW5lbCIKIAlkZXBlbmRzIG9uIE9GICYmIFNQSSAmJiBHUElPTElC
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvTWFrZWZpbGUgYi9kcml2ZXJzL2dw
dS9kcm0vcGFuZWwvTWFrZWZpbGUKaW5kZXggYjZjZDM5ZmUwZjIwLi5hNzcxYzkyZjg4MGEgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2dw
dS9kcm0vcGFuZWwvTWFrZWZpbGUKQEAgLTM2LDUgKzM2LDYgQEAgb2JqLSQoQ09ORklHX0RSTV9Q
QU5FTF9TSVRST05JWF9TVDc3ODlWKSArPSBwYW5lbC1zaXRyb25peC1zdDc3ODl2Lm8KIG9iai0k
KENPTkZJR19EUk1fUEFORUxfU09OWV9BQ1g1NjVBS00pICs9IHBhbmVsLXNvbnktYWN4NTY1YWtt
Lm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfVFBPX1REMDI4VFRFQzEpICs9IHBhbmVsLXRwby10
ZDAyOHR0ZWMxLm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfVFBPX1REMDQzTVRFQTEpICs9IHBh
bmVsLXRwby10ZDA0M210ZWExLm8KK29iai0kKENPTkZJR19EUk1fUEFORUxfQk9FX0hJTUFYODI3
OUQpICs9IHBhbmVsLWJvZS1oaW1heDgyNzlkLm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfVFBP
X1RQRzExMCkgKz0gcGFuZWwtdHBvLXRwZzExMC5vCiBvYmotJChDT05GSUdfRFJNX1BBTkVMX1RS
VUxZX05UMzU1OTdfV1FYR0EpICs9IHBhbmVsLXRydWx5LW50MzU1OTcubwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLWJvZS1oaW1heDgyNzlkLmMgYi9kcml2ZXJzL2dw
dS9kcm0vcGFuZWwvcGFuZWwtYm9lLWhpbWF4ODI3OWQuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NApp
bmRleCAwMDAwMDAwMDAwMDAuLjI3ODhiZGRhNjllYwotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1ib2UtaGltYXg4Mjc5ZC5jCkBAIC0wLDAgKzEsNTkzIEBA
CisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAorLyoKKyAqIENvcHlyaWdodCAo
YykgMjAxOSwgSHVhcWluIEVsZWN0cm9uaWNzIENvLiwgTHRkCisgKgorICogVGhpcyBwcm9ncmFt
IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkK
KyAqIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2Ug
YXMgcHVibGlzaGVkIGJ5CisgKiB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIg
dmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcgorICogKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0
ZXIgdmVyc2lvbi4KKyAqLworCisjaW5jbHVkZSA8bGludXgvYmFja2xpZ2h0Lmg+CisjaW5jbHVk
ZSA8bGludXgvZ3Bpby9jb25zdW1lci5oPgorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgorI2lu
Y2x1ZGUgPGxpbnV4L29mLmg+CisjaW5jbHVkZSA8bGludXgvb2ZfZGV2aWNlLmg+CisjaW5jbHVk
ZSA8bGludXgvcmVndWxhdG9yL2NvbnN1bWVyLmg+CisKKyNpbmNsdWRlIDxkcm0vZHJtUC5oPgor
I2luY2x1ZGUgPGRybS9kcm1fY3J0Yy5oPgorI2luY2x1ZGUgPGRybS9kcm1fbWlwaV9kc2kuaD4K
KyNpbmNsdWRlIDxkcm0vZHJtX3BhbmVsLmg+CisKKyNpbmNsdWRlIDx2aWRlby9taXBpX2Rpc3Bs
YXkuaD4KKyNpbmNsdWRlIDxsaW51eC9lcnIuaD4KKworc3RydWN0IGRzaV9jbWRfZGVzYyB7CisJ
Y2hhciB3YWl0OworCWNoYXIgY21kOworCWNoYXIgbGVuOworCWNoYXIgKnBheWxvYWQ7Cit9Owor
CitzdHJ1Y3QgZHNpX3BhbmVsX2NtZHMgeworCWNoYXIgKmJ1ZjsKKwlpbnQgYmxlbjsKKwlzdHJ1
Y3QgZHNpX2NtZF9kZXNjICpjbWRzOworCWludCBjbWRfY250OworfTsKKworc3RydWN0IHBhbmVs
X2luZm8geworCXN0cnVjdCBkcm1fcGFuZWwgYmFzZTsKKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNl
ICpsaW5rOworCisJc3RydWN0IGJhY2tsaWdodF9kZXZpY2UgKmJhY2tsaWdodDsKKwlzdHJ1Y3Qg
Z3Bpb19kZXNjICpyZXNldF9ncGlvOworCXN0cnVjdCBncGlvX2Rlc2MgKnBwMzMwMDBfZ3BpbzsK
KwlzdHJ1Y3QgZ3Bpb19kZXNjICpwcDE4MDAwX2dwaW87CisKKwl1MzIgcnN0X3NlcVsxMF07CisJ
dTMyIHJzdF9zZXFfbGVuOworCisJc3RydWN0IGRzaV9wYW5lbF9jbWRzICpvbl9jbWRzOworCXN0
cnVjdCBkc2lfcGFuZWxfY21kcyAqb2ZmX2NtZHM7CisJc3RydWN0IGRybV9kaXNwbGF5X21vZGUJ
KnBhbmVsX2Rpc3BsYXlfbW9kZTsKKworCXVuc2lnbmVkIGludCBwYW5lbF93aWR0aF9tbTsKKwl1
bnNpZ25lZCBpbnQgcGFuZWxfaGVpZ2h0X21tOworCXVuc2lnbmVkIGludCBwZXJfY29sb3JfY2hh
bm5lbDsKKworCWJvb2wgcHJlcGFyZWQ7CisJYm9vbCBlbmFibGVkOworfTsKKworc3RhdGljIGlu
dCBkc2lfcGFyc2VfcmVzZXRfc2VxKHN0cnVjdCBkZXZpY2Vfbm9kZSAqbnAsIHUzMiByc3Rfc2Vx
WzEwXSwKKwkJdTMyICpyc3RfbGVuLCBjb25zdCBjaGFyICpuYW1lKQoreworCWludCBudW0gPSAw
LCBpOworCWludCByYzsKKwlzdHJ1Y3QgcHJvcGVydHkgKmRhdGE7CisJdTMyIHRtcFsxMF07CisJ
KnJzdF9sZW4gPSAwOworCWRhdGEgPSBvZl9maW5kX3Byb3BlcnR5KG5wLCBuYW1lLCAmbnVtKTsK
KworCW51bSAvPSBzaXplb2YodTMyKTsKKwlpZiAoIWRhdGEgfHwgIW51bSB8fCBudW0gPiAxMCB8
fCBudW0gJSAyKSB7CisJCXByX2VycigiJXM6JWQsIGVycm9yIHJlYWRpbmcgJXMsIGxlbmd0aCBm
b3VuZCA9ICVkXG4iLAorCQkJCV9fZnVuY19fLCBfX0xJTkVfXywgbmFtZSwgbnVtKTsKKwkJcmV0
dXJuIC1FSU5WQUw7CisJfQorCisJcmMgPSBvZl9wcm9wZXJ0eV9yZWFkX3UzMl9hcnJheShucCwg
bmFtZSwgdG1wLCBudW0pOworCWlmIChyYykgeworCQlwcl9lcnIoIiVzOiVkLCBlcnJvciByZWFk
aW5nICVzLCByYyA9ICVkXG4iLAorCQkJCQlfX2Z1bmNfXywgX19MSU5FX18sIG5hbWUsIHJjKTsK
KwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJZm9yIChpID0gMDsgaSA8IG51bTsgKytpKSB7CisJ
CXJzdF9zZXFbaV0gPSB0bXBbaV07CisJCSpyc3RfbGVuID0gbnVtOworCX0KKwlyZXR1cm4gMDsK
K30KKworc3NpemVfdCBtaXBpX2RzaV9kY3Nfd3JpdGVfZGVsYXkoc3RydWN0IG1pcGlfZHNpX2Rl
dmljZSAqZHNpLCB1OCBjbWQsCisJCWNvbnN0IHZvaWQgKmRhdGEsIHNpemVfdCBsZW4sIHNpemVf
dCB0aW1lKQoreworCXNzaXplX3QgcmV0OworCisJaWYgKGxlbiA9PSAwKQorCQlyZXQgPSBtaXBp
X2RzaV9kY3Nfd3JpdGUoZHNpLCBjbWQsIE5VTEwsIDApOworCWVsc2UKKwkJcmV0ID0gbWlwaV9k
c2lfZGNzX3dyaXRlKGRzaSwgY21kLCBkYXRhLCBsZW4pOworCisJbXNsZWVwKHRpbWUpOworCisJ
cmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCB3cml0ZV9jbWRzKHN0cnVjdCBtaXBpX2RzaV9k
ZXZpY2UgKmRzaV9kZXZpY2UsCisJCQkJCXN0cnVjdCBkc2lfcGFuZWxfY21kcyAqaW5pdF9jbWRz
KQoreworCXN0cnVjdCBkc2lfY21kX2Rlc2MgKm9uZV9jbWQgPSBpbml0X2NtZHMtPmNtZHM7CisJ
aW50IGkgPSAwOworCWludCByZXQ7CisKKwlmb3IgKGkgPSAwOyBpIDwgaW5pdF9jbWRzLT5jbWRf
Y250OyBpKyspIHsKKwkJaWYgKG9uZV9jbWQgPT0gTlVMTCkKKwkJCXJldHVybiAtRUlOVkFMOwor
CisJCXJldCA9IG1pcGlfZHNpX2Rjc193cml0ZV9kZWxheShkc2lfZGV2aWNlLAorCQkJCW9uZV9j
bWQtPmNtZCwgb25lX2NtZC0+cGF5bG9hZCwKKwkJCQlvbmVfY21kLT5sZW4sIG9uZV9jbWQtPndh
aXQpOworCQlvbmVfY21kKys7CisJfQorCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBw
YXJzZV9kY3NfY21kcyhzdHJ1Y3QgZGV2aWNlX25vZGUgKm5wLAorCQkJCXN0cnVjdCBkc2lfcGFu
ZWxfY21kcyAqcGNtZHMsIGNoYXIgKmNtZF9rZXkpCit7CisJY29uc3QgY2hhciAqZGF0YTsKKwlp
bnQgYmxlbiA9IDAsIGxlbiwgY250ID0gMDsKKwljaGFyICpidWYsICpicDsKKwlzdHJ1Y3QgZHNp
X2NtZF9kZXNjICp0ZW1wX2NtZDsKKworCWRhdGEgPSBvZl9nZXRfcHJvcGVydHkobnAsIGNtZF9r
ZXksICZibGVuKTsKKwlpZiAoIWRhdGEpIHsKKwkJcHJfZXJyKCIlczogZmFpbGVkLCBrZXk9JXNc
biIsIF9fZnVuY19fLCBjbWRfa2V5KTsKKwkJcmV0dXJuIC1FTk9NRU07CisJfQorCisJYnVmID0g
a3phbGxvYyhzaXplb2YoY2hhcikgKiBibGVuLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWJ1ZikKKwkJ
cmV0dXJuIC1FTk9NRU07CisKKwltZW1jcHkoYnVmLCBkYXRhLCBibGVuKTsKKworCS8qIHNjYW4g
ZGNzIGNvbW1hbmRzICovCisJYnAgPSBidWY7CisJbGVuID0gYmxlbjsKKworCS8qIGdldCBob3cg
bXVjaCBjbWQgY250ICAqLworCXdoaWxlIChsZW4gPiAwKSB7CisJCWNudCsrOworCQlsZW4gPSBs
ZW4gLSAqKGJwKTsKKwkJYnAgPSBicCArICooYnApOworCX0KKworCXBjbWRzLT5jbWRfY250ID0g
Y250OworCisJcGNtZHMtPmNtZHMgPSBrY2FsbG9jKGNudCwgc2l6ZW9mKHN0cnVjdCBkc2lfY21k
X2Rlc2MpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIXBjbWRzLT5jbWRzKQorCQlyZXR1cm4gLUVOT01F
TTsKKwl0ZW1wX2NtZCA9IHBjbWRzLT5jbWRzOworCisJYnAgPSBidWY7CisJbGVuID0gYmxlbjsK
KworCXdoaWxlIChjbnQgIT0gMCkgeworCQl0ZW1wX2NtZC0+d2FpdCA9ICooYnArMSk7CisJCXRl
bXBfY21kLT5jbWQgPSAqKGJwKzIpOworCQl0ZW1wX2NtZC0+bGVuID0gKihicCkgLSAzOworCQl0
ZW1wX2NtZC0+cGF5bG9hZCA9IGJwICsgMzsKKworCQljbnQtLTsKKwkJdGVtcF9jbWQrKzsKKwkJ
YnAgPSBicCArICooYnApOworCX0KKworCXBjbWRzLT5idWYgPSBidWY7CisJcGNtZHMtPmJsZW4g
PSBibGVuOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgcGFuZWxfcGFyc2VfZHQoc3Ry
dWN0IHBhbmVsX2luZm8gKnBpbmZvKQoreworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqcGFuZWxzX25v
ZGU7CisJc3RydWN0IGRldmljZV9ub2RlICpwYXJhbWV0ZXJfbm9kZTsKKwlzdGF0aWMgY29uc3Qg
Y2hhciAqbGNkX25hbWU7CisJc3RhdGljIGNvbnN0IGNoYXIgKnBhbmVsX3BhcmFtZXRlcjsKKwlz
dHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqZGlzcGxheV9tb2RlOworCXN0cnVjdCBtaXBpX2RzaV9k
ZXZpY2UJKmRzaV9kZXZpY2UgPSBwaW5mby0+bGluazsKKwlpbnQgcmV0ID0gMDsKKwl1MzIJdG1w
OworCisJcGFuZWxzX25vZGUgPSBvZl9maW5kX25vZGVfYnlfbmFtZShOVUxMLCAicGFuZWxzIik7
CisJaWYgKCFwYW5lbHNfbm9kZSkgeworCQlwcl9lcnIoIkdldCBwYW5lbHMgbm9kZSBGYWlsIVxu
Iik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCXBhbmVsX3BhcmFtZXRlciA9IG9mX2dldF9w
cm9wZXJ0eShwYW5lbHNfbm9kZSwgInBhbmVsLXBhcmFtZXRlciIsIE5VTEwpOworCWlmICghcGFu
ZWxfcGFyYW1ldGVyKSB7CisJCXByX2VycigiR2V0IHBhbmVsIHBhcmFtZXRlciBGYWlsIVxuIik7
CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCXBhcmFtZXRlcl9ub2RlID0gb2ZfZmluZF9ub2Rl
X2J5X25hbWUocGFuZWxzX25vZGUsIHBhbmVsX3BhcmFtZXRlcik7CisJaWYgKCFwYXJhbWV0ZXJf
bm9kZSkKKwkJcmV0dXJuIC1FTk9ERVY7CisKKwkvKiBnZXQgbGNkIG5hbWUgKi8KKwlsY2RfbmFt
ZSA9IG9mX2dldF9wcm9wZXJ0eShwYXJhbWV0ZXJfbm9kZSwgImRzaS1wYW5lbC1uYW1lIiwgTlVM
TCk7CisJaWYgKCFsY2RfbmFtZSkgeworCQlwcl9lcnIoIkdldCBsY2RfbmFtZSBGYWlsIVxuIik7
CisJCXJldHVybiAtRUlOVkFMOworCX0KKwlwcl9pbmZvKCIlczogTGNkIE5hbWUgPSAlc1xuIiwg
X19mdW5jX18sIGxjZF9uYW1lKTsKKworCS8qIGdldCBsY2QgaW5pdCBjb2RlICovCisJcGluZm8t
Pm9uX2NtZHMgPSBremFsbG9jKHNpemVvZihzdHJ1Y3QgZHNpX3BhbmVsX2NtZHMpLCBHRlBfS0VS
TkVMKTsKKwlpZiAoIShwaW5mby0+b25fY21kcykpCisJCXJldHVybiAtRU5PTUVNOworCisJcmV0
ID0gcGFyc2VfZGNzX2NtZHMocGFyYW1ldGVyX25vZGUsIHBpbmZvLT5vbl9jbWRzLCAiZHNpLW9u
LWNvbW1hbmQiKTsKKwlpZiAocmV0IDwgMCkgeworCQlwcl9lcnIoIkdldCBEc2kgb24gY29tbWFu
ZCBGYWlsXG4iKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJLyogZ2V0IGxjZCBvZmYgY29k
ZSAqLworCXBpbmZvLT5vZmZfY21kcyA9IGt6YWxsb2Moc2l6ZW9mKHN0cnVjdCBkc2lfcGFuZWxf
Y21kcyksIEdGUF9LRVJORUwpOworCWlmICghKHBpbmZvLT5vZmZfY21kcykpCisJCXJldHVybiAt
RU5PTUVNOworCisJcmV0ID0gcGFyc2VfZGNzX2NtZHMocGFyYW1ldGVyX25vZGUsIHBpbmZvLT5v
ZmZfY21kcywKKwkJCSJkc2ktb2ZmLWNvbW1hbmQiKTsKKwlpZiAocmV0IDwgMCkgeworCQlwcl9l
cnIoIkdldCBEc2kgb2ZmIGNvbW1hbmQgRmFpbFxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0K
KworCS8qIGdldCBQb3JjaCAgKi8KKwlkaXNwbGF5X21vZGUgPSBremFsbG9jKHNpemVvZihzdHJ1
Y3QgZHJtX2Rpc3BsYXlfbW9kZSksIEdGUF9LRVJORUwpOworCWlmICghZGlzcGxheV9tb2RlKQor
CQlyZXR1cm4gLUVOT01FTTsKKwlwaW5mby0+cGFuZWxfZGlzcGxheV9tb2RlID0gZGlzcGxheV9t
b2RlOworCisJcmV0ID0gb2ZfcHJvcGVydHlfcmVhZF91MzIocGFyYW1ldGVyX25vZGUsICJkc2kt
cGl4ZWwtY2xrIiwgJnRtcCk7CisJZGlzcGxheV9tb2RlLT5jbG9jayA9ICghcmV0ID8gdG1wIDog
MCk7CisKKwlyZXQgPSBvZl9wcm9wZXJ0eV9yZWFkX3UzMihwYXJhbWV0ZXJfbm9kZSwKKwkJCSJk
c2ktcGFuZWwtaHpvcml6b250YWwiLCAmdG1wKTsKKwlkaXNwbGF5X21vZGUtPmhkaXNwbGF5ID0g
KCFyZXQgPyB0bXAgOiAwKTsKKworCXJldCA9IG9mX3Byb3BlcnR5X3JlYWRfdTMyKHBhcmFtZXRl
cl9ub2RlLCAiZHNpLWgtZnJvbnQtcG9yY2giLCAmdG1wKTsKKwl0bXAgPSAoIXJldCA/IHRtcCA6
IDApOworCWRpc3BsYXlfbW9kZS0+aHN5bmNfc3RhcnQgPSBkaXNwbGF5X21vZGUtPmhkaXNwbGF5
ICsgdG1wOworCisJcmV0ID0gb2ZfcHJvcGVydHlfcmVhZF91MzIocGFyYW1ldGVyX25vZGUsICJk
c2ktaC1iYWNrLXBvcmNoIiwgJnRtcCk7CisJdG1wID0gKCFyZXQgPyB0bXAgOiAwKTsKKwlkaXNw
bGF5X21vZGUtPmhzeW5jX2VuZCA9IGRpc3BsYXlfbW9kZS0+aHN5bmNfc3RhcnQgKyB0bXA7CisK
KwlyZXQgPSBvZl9wcm9wZXJ0eV9yZWFkX3UzMihwYXJhbWV0ZXJfbm9kZSwgImRzaS1oLXB1bHNl
LXdpZHRoIiwgJnRtcCk7CisJdG1wID0gKCFyZXQgPyB0bXAgOiAwKTsKKwlkaXNwbGF5X21vZGUt
Pmh0b3RhbCA9IGRpc3BsYXlfbW9kZS0+aHN5bmNfZW5kICsgdG1wOworCisJcmV0ID0gb2ZfcHJv
cGVydHlfcmVhZF91MzIocGFyYW1ldGVyX25vZGUsICJkc2ktcGFuZWwtdmVydGljYWwiLCAmdG1w
KTsKKwlkaXNwbGF5X21vZGUtPnZkaXNwbGF5ID0gKCFyZXQgPyB0bXAgOiAwKTsKKworCXJldCA9
IG9mX3Byb3BlcnR5X3JlYWRfdTMyKHBhcmFtZXRlcl9ub2RlLCAiZHNpLXYtZnJvbnQtcG9yY2gi
LCAmdG1wKTsKKwl0bXAgPSAoIXJldCA/IHRtcCA6IDApOworCWRpc3BsYXlfbW9kZS0+dnN5bmNf
c3RhcnQgPSBkaXNwbGF5X21vZGUtPnZkaXNwbGF5ICsgdG1wOworCisJcmV0ID0gb2ZfcHJvcGVy
dHlfcmVhZF91MzIocGFyYW1ldGVyX25vZGUsICJkc2ktdi1iYWNrLXBvcmNoIiwgJnRtcCk7CisJ
dG1wID0gKCFyZXQgPyB0bXAgOiAwKTsKKwlkaXNwbGF5X21vZGUtPnZzeW5jX2VuZCA9IGRpc3Bs
YXlfbW9kZS0+dnN5bmNfc3RhcnQgKyB0bXA7CisKKwlyZXQgPSBvZl9wcm9wZXJ0eV9yZWFkX3Uz
MihwYXJhbWV0ZXJfbm9kZSwgImRzaS12LXB1bHNlLXdpZHRoIiwgJnRtcCk7CisJdG1wID0gKCFy
ZXQgPyB0bXAgOiAwKTsKKwlkaXNwbGF5X21vZGUtPnZ0b3RhbCA9IGRpc3BsYXlfbW9kZS0+dnN5
bmNfZW5kICsgdG1wOworCisJcmV0ID0gb2ZfcHJvcGVydHlfcmVhZF91MzIocGFyYW1ldGVyX25v
ZGUsICJkc2ktcGFuZWwtcmVmcmVzaCIsICZ0bXApOworCWRpc3BsYXlfbW9kZS0+dnJlZnJlc2gg
PSAoIXJldCA/IHRtcCA6IDApOworCisJLyogZ2V0IGxhbnMgKi8KKwlyZXQgPSBvZl9wcm9wZXJ0
eV9yZWFkX3UzMihwYXJhbWV0ZXJfbm9kZSwgImRzaS1wYW5lbC1sYW5lcyIsICZ0bXApOworCWRz
aV9kZXZpY2UtPmxhbmVzICA9ICghcmV0ID8gdG1wIDogMCk7CisKKwlyZXQgPSBvZl9wcm9wZXJ0
eV9yZWFkX3UzMihwYXJhbWV0ZXJfbm9kZSwgImRzaS1wYW5lbC1mb3JtYXQiLCAmdG1wKTsKKwlk
c2lfZGV2aWNlLT5mb3JtYXQgPSAoIXJldCA/IHRtcCA6IDApOworCisJcmV0ID0gb2ZfcHJvcGVy
dHlfcmVhZF91MzIocGFyYW1ldGVyX25vZGUsCisJCQkiZHNpLXBhbmVsLW1vZGUtZmxhZ3MiLCAm
dG1wKTsKKwlkc2lfZGV2aWNlLT5tb2RlX2ZsYWdzID0gKCFyZXQgPyB0bXAgOiAwKTsKKworCS8q
IGdldCBXeEggKi8KKwlyZXQgPSBvZl9wcm9wZXJ0eV9yZWFkX3UzMihwYXJhbWV0ZXJfbm9kZSwg
ImRzaS1wYW5lbC13aWR0aC1tbSIsICZ0bXApOworCXBpbmZvLT5wYW5lbF93aWR0aF9tbSAgPSAo
IXJldCA/IHRtcCA6IDApOworCisJcmV0ID0gb2ZfcHJvcGVydHlfcmVhZF91MzIocGFyYW1ldGVy
X25vZGUsICJkc2ktcGFuZWwtaGVpZ2h0LW1tIiwgJnRtcCk7CisJcGluZm8tPnBhbmVsX2hlaWdo
dF9tbSAgPSAoIXJldCA/IHRtcCA6IDApOworCisJcmV0ID0gb2ZfcHJvcGVydHlfcmVhZF91MzIo
cGFyYW1ldGVyX25vZGUsICJwZXItY29sb3ItY2hhbm5lbCIsICZ0bXApOworCXBpbmZvLT5wZXJf
Y29sb3JfY2hhbm5lbCA9ICghcmV0ID8gdG1wIDogMCk7CisKKwkvKiByZXNldCB0aW1lICovCisJ
cmV0ID0gZHNpX3BhcnNlX3Jlc2V0X3NlcShwYXJhbWV0ZXJfbm9kZSwgcGluZm8tPnJzdF9zZXEs
CisJCQkJJihwaW5mby0+cnN0X3NlcV9sZW4pLCAiZHNpLXJlc2V0LXNlcXVlbmNlIik7CisJaWYg
KHJldCA8IDApCisJCXJldHVybiByZXQ7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGlubGlu
ZSBzdHJ1Y3QgcGFuZWxfaW5mbyAqdG9fcGFuZWxfaW5mbyhzdHJ1Y3QgZHJtX3BhbmVsICpwYW5l
bCkKK3sKKwlyZXR1cm4gY29udGFpbmVyX29mKHBhbmVsLCBzdHJ1Y3QgcGFuZWxfaW5mbywgYmFz
ZSk7Cit9CisKK3N0YXRpYyBpbnQgcGFuZWxfZGlzYWJsZShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5l
bCkKK3sKKwlzdHJ1Y3QgcGFuZWxfaW5mbyAqcGluZm8gPSB0b19wYW5lbF9pbmZvKHBhbmVsKTsK
KworCWlmICghcGluZm8tPmVuYWJsZWQpCisJCXJldHVybiAwOworCisJYmFja2xpZ2h0X2Rpc2Fi
bGUocGluZm8tPmJhY2tsaWdodCk7CisKKwlwaW5mby0+ZW5hYmxlZCA9IGZhbHNlOworCisJcmV0
dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgcGFuZWxfdW5wcmVwYXJlKHN0cnVjdCBkcm1fcGFuZWwg
KnBhbmVsKQoreworCXN0cnVjdCBwYW5lbF9pbmZvICpwaW5mbyA9IHRvX3BhbmVsX2luZm8ocGFu
ZWwpOworCWludCBlcnI7CisKKwlpZiAoIXBpbmZvLT5wcmVwYXJlZCkKKwkJcmV0dXJuIDA7CisK
KwllcnIgPSB3cml0ZV9jbWRzKHBpbmZvLT5saW5rLCBwaW5mby0+b2ZmX2NtZHMpOworCWlmIChl
cnIgPCAwKSB7CisJCWRldl9lcnIocGFuZWwtPmRldiwKKwkJCQkiZmFpbGVkIHRvIHNlbmQgRENT
IE9mZiBDb2RlOiAlZFxuIiwgZXJyKTsKKwkJcmV0dXJuIGVycjsKKwl9CisKKwl1c2xlZXBfcmFu
Z2UoMTAwMCwgMTAwMCk7CisJZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKHBpbmZvLT5yZXNldF9n
cGlvLCAwKTsKKwlncGlvZF9zZXRfdmFsdWVfY2Fuc2xlZXAocGluZm8tPnBwMzMwMDBfZ3Bpbywg
MCk7CisJZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKHBpbmZvLT5wcDE4MDAwX2dwaW8sIDApOwor
CisJcGluZm8tPnByZXBhcmVkID0gZmFsc2U7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGlu
dCBwYW5lbF9wcmVwYXJlKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQoreworCXN0cnVjdCBwYW5l
bF9pbmZvICpwaW5mbyA9IHRvX3BhbmVsX2luZm8ocGFuZWwpOworCWludCBlcnIsIGk7CisKKwlp
ZiAocGluZm8tPnByZXBhcmVkKQorCQlyZXR1cm4gMDsKKworCWdwaW9kX3NldF92YWx1ZV9jYW5z
bGVlcChwaW5mby0+cHAxODAwMF9ncGlvLCAxKTsKKwlncGlvZF9zZXRfdmFsdWVfY2Fuc2xlZXAo
cGluZm8tPnBwMzMwMDBfZ3BpbywgMSk7CisKKwkvKiByZXNldCBzZXF1ZW5jZSAqLworCWZvciAo
aSA9IDA7IGkgPCBwaW5mby0+cnN0X3NlcV9sZW47ICsraSkgeworCQlncGlvZF9zZXRfdmFsdWVf
Y2Fuc2xlZXAocGluZm8tPnJlc2V0X2dwaW8sIHBpbmZvLT5yc3Rfc2VxW2ldKTsKKwkJaWYgKHBp
bmZvLT5yc3Rfc2VxWysraV0pCisJCQl1c2xlZXBfcmFuZ2UocGluZm8tPnJzdF9zZXFbaV0gKiAx
MDAwLAorCQkJCQkJcGluZm8tPnJzdF9zZXFbaV0gKiAxMDAwKTsKKwl9CisKKwkvKiBzZW5kIGlu
aXQgY29kZSAqLworCWVyciA9IHdyaXRlX2NtZHMocGluZm8tPmxpbmssIHBpbmZvLT5vbl9jbWRz
KTsKKwlpZiAoZXJyIDwgMCkgeworCQlkZXZfZXJyKHBhbmVsLT5kZXYsCisJCQkJImZhaWxlZCB0
byBzZW5kIERDUyBJbml0IENvZGU6ICVkXG4iLCBlcnIpOworCQlnb3RvIHBvd2Vyb2ZmOworCX0K
KworCXBpbmZvLT5wcmVwYXJlZCA9IHRydWU7CisKKwlyZXR1cm4gMDsKKworcG93ZXJvZmY6CisJ
Z3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKHBpbmZvLT5yZXNldF9ncGlvLCAwKTsKKwlncGlvZF9z
ZXRfdmFsdWVfY2Fuc2xlZXAocGluZm8tPnBwMzMwMDBfZ3BpbywgMCk7CisJZ3Bpb2Rfc2V0X3Zh
bHVlX2NhbnNsZWVwKHBpbmZvLT5wcDE4MDAwX2dwaW8sIDApOworCXJldHVybiBlcnI7Cit9CisK
K3N0YXRpYyBpbnQgcGFuZWxfZW5hYmxlKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQoreworCXN0
cnVjdCBwYW5lbF9pbmZvICpwaW5mbyA9IHRvX3BhbmVsX2luZm8ocGFuZWwpOworCWludCByZXQ7
CisKKwlpZiAocGluZm8tPmVuYWJsZWQpCisJCXJldHVybiAwOworCisJcmV0ID0gYmFja2xpZ2h0
X2VuYWJsZShwaW5mby0+YmFja2xpZ2h0KTsKKwlpZiAocmV0KSB7CisJCURSTV9ERVZfRVJST1Io
cGFuZWwtPmRybS0+ZGV2LAorCQkJICAgICAgIkZhaWxlZCB0byBlbmFibGUgYmFja2xpZ2h0ICVk
XG4iLCByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKworCXBpbmZvLT5lbmFibGVkID0gdHJ1ZTsK
KworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IHBhbmVsX2dldF9tb2RlcyhzdHJ1Y3QgZHJt
X3BhbmVsICpwYW5lbCkKK3sKKwlzdHJ1Y3QgcGFuZWxfaW5mbyAqcGluZm8gPSB0b19wYW5lbF9p
bmZvKHBhbmVsKTsKKwlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZTsKKworCWlmICghcGlu
Zm8tPnBhbmVsX2Rpc3BsYXlfbW9kZSkgeworCQlwcl9lcnIoIkdldCBwYW5lbF9kaXNwbGF5X21v
ZGUgZmFpbCFcbiIpOworCQlyZXR1cm4gLTE7CisJfQorCisJbW9kZSA9IGRybV9tb2RlX2R1cGxp
Y2F0ZShwYW5lbC0+ZHJtLCBwaW5mby0+cGFuZWxfZGlzcGxheV9tb2RlKTsKKwlpZiAoIW1vZGUp
IHsKKwkJcHJfZXJyKCJmYWlsZWQgdG8gYWRkIG1vZGVcbiIpOworCQlyZXR1cm4gLUVOT01FTTsK
Kwl9CisKKwlkcm1fbW9kZV9zZXRfbmFtZShtb2RlKTsKKworCWRybV9tb2RlX3Byb2JlZF9hZGQo
cGFuZWwtPmNvbm5lY3RvciwgbW9kZSk7CisKKwlwYW5lbC0+Y29ubmVjdG9yLT5kaXNwbGF5X2lu
Zm8ud2lkdGhfbW0gPSBwaW5mby0+cGFuZWxfd2lkdGhfbW07CisJcGFuZWwtPmNvbm5lY3Rvci0+
ZGlzcGxheV9pbmZvLmhlaWdodF9tbSA9IHBpbmZvLT5wYW5lbF9oZWlnaHRfbW07CisJcGFuZWwt
PmNvbm5lY3Rvci0+ZGlzcGxheV9pbmZvLmJwYyA9IHBpbmZvLT5wZXJfY29sb3JfY2hhbm5lbDsK
KworCXJldHVybiAxOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9wYW5lbF9mdW5jcyBw
YW5lbF9mdW5jcyA9IHsKKwkuZGlzYWJsZSA9IHBhbmVsX2Rpc2FibGUsCisJLnVucHJlcGFyZSA9
IHBhbmVsX3VucHJlcGFyZSwKKwkucHJlcGFyZSA9IHBhbmVsX3ByZXBhcmUsCisJLmVuYWJsZSA9
IHBhbmVsX2VuYWJsZSwKKwkuZ2V0X21vZGVzID0gcGFuZWxfZ2V0X21vZGVzLAorfTsKKworc3Rh
dGljIGNvbnN0IHN0cnVjdCBvZl9kZXZpY2VfaWQgcGFuZWxfb2ZfbWF0Y2hbXSA9IHsKKwl7IC5j
b21wYXRpYmxlID0gImJvZSxoaW1heDgyNzlkIiwgfSwKKwl7IH0KK307CitNT0RVTEVfREVWSUNF
X1RBQkxFKG9mLCBwYW5lbF9vZl9tYXRjaCk7CisKK3N0YXRpYyBpbnQgcGFuZWxfYWRkKHN0cnVj
dCBwYW5lbF9pbmZvICpwaW5mbykKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmcGluZm8tPmxp
bmstPmRldjsKKwlzdHJ1Y3QgZGV2aWNlX25vZGUgKm5wOworCWludCBlcnI7CisKKwlwaW5mby0+
cHAzMzAwMF9ncGlvID0gZGV2bV9ncGlvZF9nZXRfb3B0aW9uYWwoZGV2LAorCQkJCQkJCSJwcDMz
MDAwIiwKKwkJCQkJCQlHUElPRF9PVVRfSElHSCk7CisJaWYgKElTX0VSUihwaW5mby0+cHAzMzAw
MF9ncGlvKSkgeworCQllcnIgPSBQVFJfRVJSKHBpbmZvLT5wcDMzMDAwX2dwaW8pOworCQlkZXZf
ZXJyKGRldiwgImZhaWxlZCB0byBnZXQgcHAzMzAwMCBncGlvOiAlZFxuIiwgZXJyKTsKKwkJcGlu
Zm8tPnBwMzMwMDBfZ3BpbyA9IE5VTEw7CisJfQorCisJcGluZm8tPnBwMTgwMDBfZ3BpbyA9IGRl
dm1fZ3Bpb2RfZ2V0X29wdGlvbmFsKGRldiwKKwkJCQkJCQkicHAxODAwMCIsCisJCQkJCQkJR1BJ
T0RfT1VUX0hJR0gpOworCWlmIChJU19FUlIocGluZm8tPnBwMTgwMDBfZ3BpbykpIHsKKwkJZXJy
ID0gUFRSX0VSUihwaW5mby0+cHAxODAwMF9ncGlvKTsKKwkJZGV2X2VycihkZXYsICJmYWlsZWQg
dG8gZ2V0IHBwMTgwMDAgZ3BpbzogJWRcbiIsIGVycik7CisJCXBpbmZvLT5wcDE4MDAwX2dwaW8g
PSBOVUxMOworCX0KKworCXBpbmZvLT5yZXNldF9ncGlvID0gZGV2bV9ncGlvZF9nZXRfb3B0aW9u
YWwoZGV2LCAiZW5hYmxlIiwKKwkJCQkJCQlHUElPRF9PVVRfSElHSCk7CisJaWYgKElTX0VSUihw
aW5mby0+cmVzZXRfZ3BpbykpIHsKKwkJZXJyID0gUFRSX0VSUihwaW5mby0+cmVzZXRfZ3Bpbyk7
CisJCWRldl9lcnIoZGV2LCAiZmFpbGVkIHRvIGdldCBlbmFibGUgZ3BpbzogJWRcbiIsIGVycik7
CisJCXBpbmZvLT5yZXNldF9ncGlvID0gTlVMTDsKKwl9CisKKwlucCA9IG9mX3BhcnNlX3BoYW5k
bGUoZGV2LT5vZl9ub2RlLCAiYmFja2xpZ2h0IiwgMCk7CisJaWYgKG5wKSB7CisJCXBpbmZvLT5i
YWNrbGlnaHQgPSBvZl9maW5kX2JhY2tsaWdodF9ieV9ub2RlKG5wKTsKKwkJb2Zfbm9kZV9wdXQo
bnApOworCisJCWlmICghcGluZm8tPmJhY2tsaWdodCkKKwkJCXJldHVybiAtRVBST0JFX0RFRkVS
OworCX0KKworCWRybV9wYW5lbF9pbml0KCZwaW5mby0+YmFzZSk7CisJcGluZm8tPmJhc2UuZnVu
Y3MgPSAmcGFuZWxfZnVuY3M7CisJcGluZm8tPmJhc2UuZGV2ID0gJnBpbmZvLT5saW5rLT5kZXY7
CisKKwllcnIgPSBkcm1fcGFuZWxfYWRkKCZwaW5mby0+YmFzZSk7CisJaWYgKGVyciA8IDApCisJ
CWdvdG8gcHV0X2JhY2tsaWdodDsKKworCXJldHVybiAwOworCitwdXRfYmFja2xpZ2h0OgorCXB1
dF9kZXZpY2UoJnBpbmZvLT5iYWNrbGlnaHQtPmRldik7CisKKwlyZXR1cm4gZXJyOworfQorCitz
dGF0aWMgdm9pZCBwYW5lbF9kZWwoc3RydWN0IHBhbmVsX2luZm8gKnBpbmZvKQoreworCWlmIChw
aW5mby0+YmFzZS5kZXYpCisJCWRybV9wYW5lbF9yZW1vdmUoJnBpbmZvLT5iYXNlKTsKKworCXB1
dF9kZXZpY2UoJnBpbmZvLT5iYWNrbGlnaHQtPmRldik7Cit9CisKK3N0YXRpYyBpbnQgcGFuZWxf
cHJvYmUoc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpKQoreworCXN0cnVjdCBwYW5lbF9pbmZv
ICpwaW5mbzsKKwlpbnQgZXJyOworCisJcGluZm8gPSBkZXZtX2t6YWxsb2MoJmRzaS0+ZGV2LCBz
aXplb2YoKnBpbmZvKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFwaW5mbykKKwkJcmV0dXJuIC1FTk9N
RU07CisKKwlwaW5mby0+bGluayA9IGRzaTsKKwlwYW5lbF9wYXJzZV9kdChwaW5mbyk7CisJbWlw
aV9kc2lfc2V0X2RydmRhdGEoZHNpLCBwaW5mbyk7CisKKwllcnIgPSBwYW5lbF9hZGQocGluZm8p
OworCWlmIChlcnIgPCAwKQorCQlyZXR1cm4gZXJyOworCisJcmV0dXJuIG1pcGlfZHNpX2F0dGFj
aChkc2kpOworfQorCitzdGF0aWMgaW50IHBhbmVsX3JlbW92ZShzdHJ1Y3QgbWlwaV9kc2lfZGV2
aWNlICpkc2kpCit7CisJc3RydWN0IHBhbmVsX2luZm8gKnBpbmZvID0gbWlwaV9kc2lfZ2V0X2Ry
dmRhdGEoZHNpKTsKKwlpbnQgZXJyOworCisJZXJyID0gcGFuZWxfdW5wcmVwYXJlKCZwaW5mby0+
YmFzZSk7CisJaWYgKGVyciA8IDApCisJCURSTV9ERVZfRVJST1IoJmRzaS0+ZGV2LCAiZmFpbGVk
IHRvIHVucHJlcGFyZSBwYW5lbDogJWRcbiIsCisJCQkgICAgICBlcnIpOworCisJZXJyID0gcGFu
ZWxfZGlzYWJsZSgmcGluZm8tPmJhc2UpOworCWlmIChlcnIgPCAwKQorCQlEUk1fREVWX0VSUk9S
KCZkc2ktPmRldiwgImZhaWxlZCB0byBkaXNhYmxlIHBhbmVsOiAlZFxuIiwgZXJyKTsKKworCWVy
ciA9IG1pcGlfZHNpX2RldGFjaChkc2kpOworCWlmIChlcnIgPCAwKQorCQlEUk1fREVWX0VSUk9S
KCZkc2ktPmRldiwgImZhaWxlZCB0byBkZXRhY2ggZnJvbSBEU0kgaG9zdDogJWRcbiIsCisJCQkg
ICAgICBlcnIpOworCisJZHJtX3BhbmVsX2RldGFjaCgmcGluZm8tPmJhc2UpOworCXBhbmVsX2Rl
bChwaW5mbyk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgcGFuZWxfc2h1dGRvd24o
c3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpKQoreworCXN0cnVjdCBwYW5lbF9pbmZvICpwaW5m
byA9IG1pcGlfZHNpX2dldF9kcnZkYXRhKGRzaSk7CisKKwlwYW5lbF91bnByZXBhcmUoJnBpbmZv
LT5iYXNlKTsKKwlwYW5lbF9kaXNhYmxlKCZwaW5mby0+YmFzZSk7Cit9CisKK3N0YXRpYyBzdHJ1
Y3QgbWlwaV9kc2lfZHJpdmVyIHBhbmVsX2RyaXZlciA9IHsKKwkuZHJpdmVyID0geworCQkubmFt
ZSA9ICJwYW5lbC1pbm5vbHV4LW90YTcyOTBiIiwKKwkJLm9mX21hdGNoX3RhYmxlID0gcGFuZWxf
b2ZfbWF0Y2gsCisJfSwKKwkucHJvYmUgPSBwYW5lbF9wcm9iZSwKKwkucmVtb3ZlID0gcGFuZWxf
cmVtb3ZlLAorCS5zaHV0ZG93biA9IHBhbmVsX3NodXRkb3duLAorfTsKK21vZHVsZV9taXBpX2Rz
aV9kcml2ZXIocGFuZWxfZHJpdmVyKTsKKworTU9EVUxFX0FVVEhPUigiSmVycnkgSGFuIDxoYW54
dTVAaHVhcWluLmNvcnAtcGFydG5lci5nb29nbGUuY29tPiIpOworTU9EVUxFX0RFU0NSSVBUSU9O
KCJCb2UgSGltYXg4Mjc5ZCBkcml2ZXIiKTsKK01PRFVMRV9MSUNFTlNFKCJHUEwgdjIiKTsKLS0g
CjIuMTcuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18K
ZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0
dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
