Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 49E5772086
	for <lists+dri-devel@lfdr.de>; Tue, 23 Jul 2019 22:10:41 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C035F6E3B8;
	Tue, 23 Jul 2019 20:10:38 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-lj1-x244.google.com (mail-lj1-x244.google.com
 [IPv6:2a00:1450:4864:20::244])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0D1EB6E3B8;
 Tue, 23 Jul 2019 20:10:37 +0000 (UTC)
Received: by mail-lj1-x244.google.com with SMTP id v18so42242274ljh.6;
 Tue, 23 Jul 2019 13:10:36 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:sender:from:to:cc:subject:date:message-id
 :in-reply-to:references:mime-version:content-transfer-encoding;
 bh=oE2GCWUZjElyuUxUkWwexdCv/sFyiwrD0HUdJqH9gW4=;
 b=asg+7Y211UtMiXbNr5D/Ha8mV7s4N4Jch93XiRh6CLeh5soqqu4z57CS3bmeRMEgju
 SNiJAMWbn9QuNbP/i2kblsUPAmPt22hoSgDJN/2i7LMQ8cO1o4u4zbI+NC5anzTs5xib
 Bu71a3SCt8UDAgjKwmGKDPzsXM0XVo4rxNvC9UqjpDT8XBp1wNppz9SeOzPfgarnrrBl
 4W/4L4s5RIFCU2duCR1OcGhfCiAfuZC31e/zS/siIqWlR1vPXBvSfzKxlI5lD7Gm/hOp
 hnzsMsruu3vgUjGxNnVdnrtC4OcUdlrELClRuS4tclG6KU9bSvMTlnLvQvflCODVhbFR
 whNw==
X-Gm-Message-State: APjAAAVlD6u4v14m4Vj/kOpAlffSdiTvu0sqo2VN/FDE7L9M7J8afIF4
 tfEEEsNzmNH2vCkIusDwO0e6U+pI0XU=
X-Google-Smtp-Source: APXvYqy0wP5KwGsophZjpv4ijxSLsU0u5aoS31vFo/C+wYIRLWFNMzrxOxy4CfTqaMA+/l731nJNSA==
X-Received: by 2002:a2e:93c8:: with SMTP id p8mr40191657ljh.6.1563912635177;
 Tue, 23 Jul 2019 13:10:35 -0700 (PDT)
Received: from saturn.lan (18.158-248-194.customer.lyse.net. [158.248.194.18])
 by smtp.gmail.com with ESMTPSA id
 p21sm6708006lfc.41.2019.07.23.13.10.34
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Tue, 23 Jul 2019 13:10:34 -0700 (PDT)
From: Sam Ravnborg <sam@ravnborg.org>
To: dri-devel@lists.freedesktop.org,
	openchrome-devel@lists.freedesktop.org
Subject: [PATCH v4 2/4] drm/via: copy DRM_WAIT_ON as VIA_WAIT_ON and use it
Date: Tue, 23 Jul 2019 22:09:42 +0200
Message-Id: <20190723200944.17285-3-sam@ravnborg.org>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190723200944.17285-1-sam@ravnborg.org>
References: <20190723200944.17285-1-sam@ravnborg.org>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=sender:from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=oE2GCWUZjElyuUxUkWwexdCv/sFyiwrD0HUdJqH9gW4=;
 b=PGg/Iqq2OcdMDksksfNGD2mc6FN7eFW29sbpTAL10HlhfZI20rDLV3cZWEf/MVrweq
 hwEdnfPij0Mii/9w/Mr5M9a2b3V4+7QnUbandgsaPJyf7YnXY++YMOJv4cpKWRdoW3jP
 V9QNbm5D5gzeCOyCWdOavgkprzXgvTfTxi3tdNHrHixff6vnb2ke5Q2kV4zRJDjwBcet
 Ayn9wnd6lZ1A70gZgmeQxPqofxtiQfX2nrfg/C9rR9ojtpjxBA/BewqC/vUSYue3jJuE
 6wzKLkvFVxm/tXyVMYYtc3w/cd+k1W3Pvqt9n6yP64aewF6ORxloe+axHMV+2yed6o1A
 yNaw==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Hellstrom <thellstrom@vmware.com>, Sam Ravnborg <sam@ravnborg.org>,
 "Gustavo A. R. Silva" <gustavo@embeddedor.com>,
 David Airlie <airlied@linux.ie>, Daniel Vetter <daniel.vetter@ffwll.ch>,
 =?UTF-8?q?Michel=20D=C3=A4nzer?= <michel@daenzer.net>,
 Kevin Brace <kevinbrace@gmx.com>, Mike Marshall <hubcap@omnibond.com>,
 Ira Weiny <ira.weiny@intel.com>, Emil Velikov <emil.velikov@collabora.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VklBX1dBSVRfT04oKSBpcyBhIGRpcmVjdCBjb3B5IG9mIERSTV9XQUlUX09OKCkgZnJvbQpkcm1f
b3NfbGludXguaC4KVGhlIGNvcHkgaXMgbWFkZSBzbyB3ZSBjYW4gYXZvaWQgdGhlIGRlcGVuZGVu
Y3kgb24gdGhlIGxlZ2FjeSBoZWFkZXIuCkEgbW9yZSBpbnZvbHZlZCBhcHByb2FjaCBoYWQgYmVl
biB0byBpbnRyb2R1Y2Ugd2FpdF9ldmVudF8qIGJ1dCBmb3IgdGhpcwpsZWdhY3kgZHJpdmVyIHRo
ZSBzaW1wbGVyIGFuZCBtb3JlIHNhZmUgYXBwcm9hY2ggd2l0aCBhIGNvcHkgb2YgdGhlCm1hY3Jv
IHdhcyBzZWxlY3RlZC4KQWRkZWQgdGhlIHJlbGV2YW50IGhlYWRlciBmaWxlcyBmb3IgdGhlIGZ1
bmN0aW9ucyB1c2VkIGluIFZJQV9XQUlUX09OLgoKdjM6Ci0gVXBkYXRlZCB1c2VycyBvZiBEUk1f
V0FJVF9PTiA9PiBWSUFfV0FJVF9PTiAoRW1pbCkKLSBVcGRhdGVkICRzdWJqZWN0IChFbWlsKQoK
U2lnbmVkLW9mZi1ieTogU2FtIFJhdm5ib3JnIDxzYW1AcmF2bmJvcmcub3JnPgpDYzogS2V2aW4g
QnJhY2UgPGtldmluYnJhY2VAZ214LmNvbT4KQ2M6IFRob21hcyBIZWxsc3Ryb20gPHRoZWxsc3Ry
b21Adm13YXJlLmNvbT4KQ2M6ICJHdXN0YXZvIEEuIFIuIFNpbHZhIiA8Z3VzdGF2b0BlbWJlZGRl
ZG9yLmNvbT4KQ2M6IE1pa2UgTWFyc2hhbGwgPGh1YmNhcEBvbW5pYm9uZC5jb20+CkNjOiBJcmEg
V2VpbnkgPGlyYS53ZWlueUBpbnRlbC5jb20+CkNjOiBEYW5pZWwgVmV0dGVyIDxkYW5pZWwudmV0
dGVyQGZmd2xsLmNoPgpDYzogRW1pbCBWZWxpa292IDxlbWlsLnZlbGlrb3ZAY29sbGFib3JhLmNv
bT4KQ2M6IE1pY2hlbCBEw6RuemVyIDxtaWNoZWxAZGFlbnplci5uZXQ+Ci0tLQogZHJpdmVycy9n
cHUvZHJtL3ZpYS92aWFfZG1hYmxpdC5jIHwgIDQgKy0tCiBkcml2ZXJzL2dwdS9kcm0vdmlhL3Zp
YV9kcnYuaCAgICAgfCA0MiArKysrKysrKysrKysrKysrKysrKysrKysrKysrKystCiBkcml2ZXJz
L2dwdS9kcm0vdmlhL3ZpYV9pcnEuYyAgICAgfCAgNCArLS0KIGRyaXZlcnMvZ3B1L2RybS92aWEv
dmlhX3ZpZGVvLmMgICB8ICAyICstCiA0IGZpbGVzIGNoYW5nZWQsIDQ2IGluc2VydGlvbnMoKyks
IDYgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZpYS92aWFfZG1h
YmxpdC5jIGIvZHJpdmVycy9ncHUvZHJtL3ZpYS92aWFfZG1hYmxpdC5jCmluZGV4IGUxNTU3ZGQ2
NzA4My4uMmVjOTNkOTc2YTQzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdmlhL3ZpYV9k
bWFibGl0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3ZpYS92aWFfZG1hYmxpdC5jCkBAIC00MzYs
NyArNDM2LDcgQEAgdmlhX2RtYWJsaXRfc3luYyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1aW50
MzJfdCBoYW5kbGUsIGludCBlbmdpbmUpCiAJaW50IHJldCA9IDA7CiAKIAlpZiAodmlhX2RtYWJs
aXRfYWN0aXZlKGJsaXRxLCBlbmdpbmUsIGhhbmRsZSwgJnF1ZXVlKSkgewotCQlEUk1fV0FJVF9P
TihyZXQsICpxdWV1ZSwgMyAqIEhaLAorCQlWSUFfV0FJVF9PTihyZXQsICpxdWV1ZSwgMyAqIEha
LAogCQkJICAgICF2aWFfZG1hYmxpdF9hY3RpdmUoYmxpdHEsIGVuZ2luZSwgaGFuZGxlLCBOVUxM
KSk7CiAJfQogCURSTV9ERUJVRygiRE1BIGJsaXQgc3luYyBoYW5kbGUgMHgleCBlbmdpbmUgJWQg
cmV0dXJuZWQgJWRcbiIsCkBAIC02ODcsNyArNjg3LDcgQEAgdmlhX2RtYWJsaXRfZ3JhYl9zbG90
KGRybV92aWFfYmxpdHFfdCAqYmxpdHEsIGludCBlbmdpbmUpCiAJd2hpbGUgKGJsaXRxLT5udW1f
ZnJlZSA9PSAwKSB7CiAJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmJsaXRxLT5ibGl0X2xvY2ss
IGlycXNhdmUpOwogCi0JCURSTV9XQUlUX09OKHJldCwgYmxpdHEtPmJ1c3lfcXVldWUsIEhaLCBi
bGl0cS0+bnVtX2ZyZWUgPiAwKTsKKwkJVklBX1dBSVRfT04ocmV0LCBibGl0cS0+YnVzeV9xdWV1
ZSwgSFosIGJsaXRxLT5udW1fZnJlZSA+IDApOwogCQlpZiAocmV0KQogCQkJcmV0dXJuICgtRUlO
VFIgPT0gcmV0KSA/IC1FQUdBSU4gOiByZXQ7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS92aWEvdmlhX2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL3ZpYS92aWFfZHJ2LmgKaW5kZXggMzY4
MTg1YjgwMTg0Li45ZTZhMGM1ZjMxNmMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92aWEv
dmlhX2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92aWEvdmlhX2Rydi5oCkBAIC0yNCw4ICsy
NCwxMyBAQAogI2lmbmRlZiBfVklBX0RSVl9IXwogI2RlZmluZSBfVklBX0RSVl9IXwogCi0jaW5j
bHVkZSA8ZHJtL2RybV9tbS5oPgorI2luY2x1ZGUgPGxpbnV4L2ppZmZpZXMuaD4KKyNpbmNsdWRl
IDxsaW51eC9zY2hlZC5oPgorI2luY2x1ZGUgPGxpbnV4L3NjaGVkL3NpZ25hbC5oPgorI2luY2x1
ZGUgPGxpbnV4L3dhaXQuaD4KKwogI2luY2x1ZGUgPGRybS9kcm1fbGVnYWN5Lmg+CisjaW5jbHVk
ZSA8ZHJtL2RybV9tbS5oPgogCiAjZGVmaW5lIERSSVZFUl9BVVRIT1IJIlZhcmlvdXMiCiAKQEAg
LTE0MCw2ICsxNDUsNDEgQEAgc3RhdGljIGlubGluZSB2b2lkIHZpYV93cml0ZThfbWFzayhzdHJ1
Y3QgZHJtX3ZpYV9wcml2YXRlICpkZXZfcHJpdiwKIAl3cml0ZWIodG1wLCAodm9pZCBfX2lvbWVt
ICopKGRldl9wcml2LT5tbWlvLT5oYW5kbGUgKyByZWcpKTsKIH0KIAorLyoKKyAqIFBvbGwgaW4g
YSBsb29wIHdhaXRpbmcgZm9yICdjb250aWRpdGlvbicgdG8gYmUgdHJ1ZS4KKyAqIE5vdGU6IEEg
ZGlyZWN0IHJlcGxhY2VtZW50IHdpdGggd2FpdF9ldmVudF9pbnRlcnJ1cHRpYmxlX3RpbWVvdXQo
KQorICogICAgICAgd2lsbCBub3Qgd29yayB1bmxlc3MgZHJpdmVyIGlzIHVwZGF0ZWQgdG8gZW1p
dCB3YWtlX3VwKCkKKyAqICAgICAgIGluIHJlbGV2YW50IHBsYWNlcyB0aGF0IGNhbiBpbXBhY3Qg
dGhlICdjb25kaXRpb24nCisgKgorICogUmV0dXJuczoKKyAqICAgcmV0IGtlZXBzIGN1cnJlbnQg
dmFsdWUgaWYgJ2NvbmRpdGlvbicgYmVjb21lcyB0cnVlCisgKiAgIHJldCA9IC1CVVNZIGlmIHRp
bWVvdXQgaGFwcGVucworICogICByZXQgPSAtRUlOVFIgaWYgYSBzaWduYWwgaW50ZXJydXB0ZWQg
dGhlIHdhaXRpbmcgcGVyaW9kCisgKi8KKyNkZWZpbmUgVklBX1dBSVRfT04oIHJldCwgcXVldWUs
IHRpbWVvdXQsIGNvbmRpdGlvbiApCQlcCitkbyB7CQkJCQkJCQlcCisJREVDTEFSRV9XQUlUUVVF
VUUoZW50cnksIGN1cnJlbnQpOwkJCVwKKwl1bnNpZ25lZCBsb25nIGVuZCA9IGppZmZpZXMgKyAo
dGltZW91dCk7CQlcCisJYWRkX3dhaXRfcXVldWUoJihxdWV1ZSksICZlbnRyeSk7CQkJXAorCQkJ
CQkJCQlcCisJZm9yICg7OykgewkJCQkJCVwKKwkJX19zZXRfY3VycmVudF9zdGF0ZShUQVNLX0lO
VEVSUlVQVElCTEUpOwlcCisJCWlmIChjb25kaXRpb24pCQkJCQlcCisJCQlicmVhazsJCQkJCVwK
KwkJaWYgKHRpbWVfYWZ0ZXJfZXEoamlmZmllcywgZW5kKSkgewkJXAorCQkJcmV0ID0gLUVCVVNZ
OwkJCQlcCisJCQlicmVhazsJCQkJCVwKKwkJfQkJCQkJCVwKKwkJc2NoZWR1bGVfdGltZW91dCgo
SFovMTAwID4gMSkgPyBIWi8xMDAgOiAxKTsJXAorCQlpZiAoc2lnbmFsX3BlbmRpbmcoY3VycmVu
dCkpIHsJCQlcCisJCQlyZXQgPSAtRUlOVFI7CQkJCVwKKwkJCWJyZWFrOwkJCQkJXAorCQl9CQkJ
CQkJXAorCX0JCQkJCQkJXAorCV9fc2V0X2N1cnJlbnRfc3RhdGUoVEFTS19SVU5OSU5HKTsJCQlc
CisJcmVtb3ZlX3dhaXRfcXVldWUoJihxdWV1ZSksICZlbnRyeSk7CQkJXAorfSB3aGlsZSAoMCkK
KwogZXh0ZXJuIGNvbnN0IHN0cnVjdCBkcm1faW9jdGxfZGVzYyB2aWFfaW9jdGxzW107CiBleHRl
cm4gaW50IHZpYV9tYXhfaW9jdGw7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92aWEv
dmlhX2lycS5jIGIvZHJpdmVycy9ncHUvZHJtL3ZpYS92aWFfaXJxLmMKaW5kZXggMDhjODcxMjdm
MTQzLi4zZTY4Y2ZhNjViMTIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92aWEvdmlhX2ly
cS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92aWEvdmlhX2lycS5jCkBAIC0yMzMsMTIgKzIzMywx
MiBAQCB2aWFfZHJpdmVyX2lycV93YWl0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHVuc2lnbmVk
IGludCBpcnEsIGludCBmb3JjZV9zZXF1ZW5jZQogCWN1cl9pcnEgPSBkZXZfcHJpdi0+dmlhX2ly
cXMgKyByZWFsX2lycTsKIAogCWlmIChtYXNrc1tyZWFsX2lycV1bMl0gJiYgIWZvcmNlX3NlcXVl
bmNlKSB7Ci0JCURSTV9XQUlUX09OKHJldCwgY3VyX2lycS0+aXJxX3F1ZXVlLCAzICogSFosCisJ
CVZJQV9XQUlUX09OKHJldCwgY3VyX2lycS0+aXJxX3F1ZXVlLCAzICogSFosCiAJCQkgICAgKCh2
aWFfcmVhZChkZXZfcHJpdiwgbWFza3NbaXJxXVsyXSkgJiBtYXNrc1tpcnFdWzNdKSA9PQogCQkJ
ICAgICBtYXNrc1tpcnFdWzRdKSk7CiAJCWN1cl9pcnFfc2VxdWVuY2UgPSBhdG9taWNfcmVhZCgm
Y3VyX2lycS0+aXJxX3JlY2VpdmVkKTsKIAl9IGVsc2UgewotCQlEUk1fV0FJVF9PTihyZXQsIGN1
cl9pcnEtPmlycV9xdWV1ZSwgMyAqIEhaLAorCQlWSUFfV0FJVF9PTihyZXQsIGN1cl9pcnEtPmly
cV9xdWV1ZSwgMyAqIEhaLAogCQkJICAgICgoKGN1cl9pcnFfc2VxdWVuY2UgPQogCQkJICAgICAg
IGF0b21pY19yZWFkKCZjdXJfaXJxLT5pcnFfcmVjZWl2ZWQpKSAtCiAJCQkgICAgICAqc2VxdWVu
Y2UpIDw9ICgxIDw8IDIzKSkpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZpYS92aWFf
dmlkZW8uYyBiL2RyaXZlcnMvZ3B1L2RybS92aWEvdmlhX3ZpZGVvLmMKaW5kZXggYTlmZmJhZDFj
ZmRkLi5jZjUzNjEyYzk0NWUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92aWEvdmlhX3Zp
ZGVvLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3ZpYS92aWFfdmlkZW8uYwpAQCAtODIsNyArODIs
NyBAQCBpbnQgdmlhX2RlY29kZXJfZnV0ZXgoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAq
ZGF0YSwgc3RydWN0IGRybV9maWxlICpmaWxlXwogCiAJc3dpdGNoIChmeC0+ZnVuYykgewogCWNh
c2UgVklBX0ZVVEVYX1dBSVQ6Ci0JCURSTV9XQUlUX09OKHJldCwgZGV2X3ByaXYtPmRlY29kZXJf
cXVldWVbZngtPmxvY2tdLAorCQlWSUFfV0FJVF9PTihyZXQsIGRldl9wcml2LT5kZWNvZGVyX3F1
ZXVlW2Z4LT5sb2NrXSwKIAkJCSAgICAoZngtPm1zIC8gMTApICogKEhaIC8gMTAwKSwgKmxvY2sg
IT0gZngtPnZhbCk7CiAJCXJldHVybiByZXQ7CiAJY2FzZSBWSUFfRlVURVhfV0FLRToKLS0gCjIu
MjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJp
LWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
