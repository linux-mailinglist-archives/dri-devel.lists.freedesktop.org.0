Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id DC8B58E6D3
	for <lists+dri-devel@lfdr.de>; Thu, 15 Aug 2019 10:37:17 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id AA1F76E93B;
	Thu, 15 Aug 2019 08:35:10 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from inva021.nxp.com (inva021.nxp.com [92.121.34.21])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 64D616E5D4
 for <dri-devel@lists.freedesktop.org>; Wed, 14 Aug 2019 10:57:58 +0000 (UTC)
Received: from inva021.nxp.com (localhost [127.0.0.1])
 by inva021.eu-rdc02.nxp.com (Postfix) with ESMTP id A26132007DA;
 Wed, 14 Aug 2019 12:49:02 +0200 (CEST)
Received: from inva024.eu-rdc02.nxp.com (inva024.eu-rdc02.nxp.com
 [134.27.226.22])
 by inva021.eu-rdc02.nxp.com (Postfix) with ESMTP id 949262003CB;
 Wed, 14 Aug 2019 12:49:02 +0200 (CEST)
Received: from fsr-ub1664-120.ea.freescale.net
 (fsr-ub1664-120.ea.freescale.net [10.171.82.81])
 by inva024.eu-rdc02.nxp.com (Postfix) with ESMTP id 961DF2060E;
 Wed, 14 Aug 2019 12:49:01 +0200 (CEST)
From: Robert Chiras <robert.chiras@nxp.com>
To: =?UTF-8?q?Guido=20G=C3=BCnther?= <agx@sigxcpu.org>,
 Marek Vasut <marex@denx.de>, Stefan Agner <stefan@agner.ch>,
 David Airlie <airlied@linux.ie>, Daniel Vetter <daniel@ffwll.ch>,
 Rob Herring <robh+dt@kernel.org>, Mark Rutland <mark.rutland@arm.com>,
 Shawn Guo <shawnguo@kernel.org>, Sascha Hauer <s.hauer@pengutronix.de>,
 Fabio Estevam <festevam@gmail.com>
Subject: [PATCH v2 06/15] drm/mxsfb: Update mxsfb with additional pixel formats
Date: Wed, 14 Aug 2019 13:48:42 +0300
Message-Id: <1565779731-1300-7-git-send-email-robert.chiras@nxp.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1565779731-1300-1-git-send-email-robert.chiras@nxp.com>
References: <1565779731-1300-1-git-send-email-robert.chiras@nxp.com>
X-Virus-Scanned: ClamAV using ClamSMTP
X-Mailman-Approved-At: Thu, 15 Aug 2019 08:34:55 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: devicetree@vger.kernel.org, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, NXP Linux Team <linux-imx@nxp.com>,
 Pengutronix Kernel Team <kernel@pengutronix.de>,
 linux-arm-kernel@lists.infradead.org
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

U2luY2UgdmVyc2lvbiA0IG9mIGVMQ0RJRiwgdGhlcmUgYXJlIHNvbWUgcmVnaXN0ZXJzIHRoYXQg
Y2FuIGRvCnRyYW5zZm9ybWF0aW9ucyBvbiB0aGUgaW5wdXQgZGF0YSwgbGlrZSByZS1hcnJhbmdp
bmcgdGhlIHBpeGVsCmNvbXBvbmVudHMuIEJ5IGRvaW5nIHRoYXQsIHdlIGNhbiBzdXBwb3J0IG1v
cmUgcGl4ZWwgZm9ybWF0cy4KVGhpcyBwYXRjaCBhZGRzIHN1cHBvcnQgZm9yIFgvQUJHUiBhbmQg
UkdCWC9BLiBBbHRob3VnaCwgdGhlIGxvY2FsIGFscGhhCmlzIG5vdCBzdXBwb3J0ZWQgYnkgZUxD
RElGLCB0aGUgYWxwaGEgcGl4ZWwgZm9ybWF0cyB3ZXJlIGFkZGVkIHRvIHRoZQpzdXBwb3J0ZWQg
cGl4ZWwgZm9ybWF0cyBidXQgaXQgd2lsbCBiZSBpZ25vcmVkLiBUaGlzIHdhcyBuZWNlc3Nhcnkg
c2luY2UKdGhlcmUgYXJlIHN5c3RlbXMgKGxpa2UgQW5kcm9pZCkgdGhhdCByZXF1aXJlcyBzdWNo
IHBpeGVsIGZvcm1hdHMuCgpBbHNvLCBhZGQgc3VwcG9ydCBmb3IgdGhlIGZvbGxvd2luZyBwaXhl
bCBmb3JtYXRzOgogICAgICAgICAgICAxNiBicHA6IFJHMTYgLEJHMTYsIFhSMTUsIFhCMTUsIEFS
MTUsIEFCMTUKClNldCB0aGUgYnVzIGZvcm1hdCBiYXNlZCBvbiBpbnB1dCBmcm9tIHRoZSB1c2Vy
IGFuZCBwYW5lbApjYXBhYmlsaXRpZXMuClNhdmUgdGhlIGJ1cyBmb3JtYXQgaW4gY3J0Yy0+bW9k
ZS5wcml2YXRlX2ZsYWdzLCBzbyB0aGUgYnJpZGdlIGNhbgp1c2UgaXQuCgpTaWduZWQtb2ZmLWJ5
OiBSb2JlcnQgQ2hpcmFzIDxyb2JlcnQuY2hpcmFzQG54cC5jb20+ClNpZ25lZC1vZmYtYnk6IE1p
cmVsYSBSYWJ1bGVhIDxtaXJlbGEucmFidWxlYUBueHAuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9teHNmYi9teHNmYl9jcnRjLmMgfCAxNDcgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
LS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX2Rydi5jICB8ICAzMCArKysrKyst
LQogZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX2Rydi5oICB8ICAgMyArLQogZHJpdmVycy9n
cHUvZHJtL214c2ZiL214c2ZiX3JlZ3MuaCB8ICAxNSArKysrCiA0IGZpbGVzIGNoYW5nZWQsIDE2
MyBpbnNlcnRpb25zKCspLCAzMiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vbXhzZmIvbXhzZmJfY3J0Yy5jIGIvZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX2Ny
dGMuYwppbmRleCA1ZTQ0ZjU3Li4xYmUyOWY1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
bXhzZmIvbXhzZmJfY3J0Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9teHNmYi9teHNmYl9jcnRj
LmMKQEAgLTQzLDE0ICs0MywxNyBAQCBzdGF0aWMgdTMyIHNldF9oc3luY19wdWxzZV93aWR0aChz
dHJ1Y3QgbXhzZmJfZHJtX3ByaXZhdGUgKm14c2ZiLCB1MzIgdmFsKQogfQogCiAvKiBTZXR1cCB0
aGUgTVhTRkIgcmVnaXN0ZXJzIGZvciBkZWNvZGluZyB0aGUgcGl4ZWxzIG91dCBvZiB0aGUgZnJh
bWVidWZmZXIgKi8KLXN0YXRpYyBpbnQgbXhzZmJfc2V0X3BpeGVsX2ZtdChzdHJ1Y3QgbXhzZmJf
ZHJtX3ByaXZhdGUgKm14c2ZiKQorc3RhdGljIGludCBteHNmYl9zZXRfcGl4ZWxfZm10KHN0cnVj
dCBteHNmYl9kcm1fcHJpdmF0ZSAqbXhzZmIsIGJvb2wgdXBkYXRlKQogewogCXN0cnVjdCBkcm1f
Y3J0YyAqY3J0YyA9ICZteHNmYi0+cGlwZS5jcnRjOwogCXN0cnVjdCBkcm1fZGV2aWNlICpkcm0g
PSBjcnRjLT5kZXY7CiAJY29uc3QgdTMyIGZvcm1hdCA9IGNydGMtPnByaW1hcnktPnN0YXRlLT5m
Yi0+Zm9ybWF0LT5mb3JtYXQ7Ci0JdTMyIGN0cmwsIGN0cmwxOworCXUzMiBjdHJsID0gMCwgY3Ry
bDEgPSAwOworCWJvb2wgYmdyX2Zvcm1hdCA9IHRydWU7CisJc3RydWN0IGRybV9mb3JtYXRfbmFt
ZV9idWYgZm9ybWF0X25hbWVfYnVmOwogCi0JY3RybCA9IENUUkxfQllQQVNTX0NPVU5UIHwgQ1RS
TF9NQVNURVI7CisJaWYgKCF1cGRhdGUpCisJCWN0cmwgPSBDVFJMX0JZUEFTU19DT1VOVCB8IENU
UkxfTUFTVEVSOwogCiAJLyoKIAkgKiBXQVJOSU5HOiBUaGUgYnVzIHdpZHRoLCBDVFJMX1NFVF9C
VVNfV0lEVEgoKSwgaXMgY29uZmlndXJlZCB0bwpAQCAtNTksNjQgKzYyLDE1OCBAQCBzdGF0aWMg
aW50IG14c2ZiX3NldF9waXhlbF9mbXQoc3RydWN0IG14c2ZiX2RybV9wcml2YXRlICpteHNmYikK
IAkgKiB0byBhcmJpdHJhcnkgdmFsdWUuIFRoaXMgbGltaXRhdGlvbiBzaG91bGQgbm90IHBvc2Ug
YW4gaXNzdWUuCiAJICovCiAKLQkvKiBDVFJMMSBjb250YWlucyBJUlEgY29uZmlnIGFuZCBzdGF0
dXMgYml0cywgcHJlc2VydmUgdGhvc2UuICovCi0JY3RybDEgPSByZWFkbChteHNmYi0+YmFzZSAr
IExDRENfQ1RSTDEpOwotCWN0cmwxICY9IENUUkwxX0NVUl9GUkFNRV9ET05FX0lSUV9FTiB8IENU
UkwxX0NVUl9GUkFNRV9ET05FX0lSUTsKKwlpZiAoIXVwZGF0ZSkgeworCQkvKiBDVFJMMSBjb250
YWlucyBJUlEgY29uZmlnIGFuZCBzdGF0dXMgYml0cywgcHJlc2VydmUgdGhvc2UuICovCisJCWN0
cmwxID0gcmVhZGwobXhzZmItPmJhc2UgKyBMQ0RDX0NUUkwxKTsKKwkJY3RybDEgJj0gQ1RSTDFf
Q1VSX0ZSQU1FX0RPTkVfSVJRX0VOIHwgQ1RSTDFfQ1VSX0ZSQU1FX0RPTkVfSVJROworCX0KKwor
CURSTV9ERVZfREVCVUdfRFJJVkVSKGRybS0+ZGV2LCAiU2V0dGluZyB1cCAlcyBtb2RlXG4iLAor
CQkJICAgICBkcm1fZ2V0X2Zvcm1hdF9uYW1lKGZvcm1hdCwgJmZvcm1hdF9uYW1lX2J1ZikpOwor
CisJLyogRG8gc29tZSBjbGVhbi11cCB0aGF0IHdlIG1pZ2h0IGhhdmUgZnJvbSBhIHByZXZpb3Vz
IG1vZGUgKi8KKwljdHJsICY9IH5DVFJMX1NISUZUX0RJUigxKTsKKwljdHJsICY9IH5DVFJMX1NI
SUZUX05VTSgweDNmKTsKKwlpZiAobXhzZmItPmRldmRhdGEtPmlwdmVyc2lvbiA+PSA0KQorCQl3
cml0ZWwoQ1RSTDJfT0REX0xJTkVfUEFUVEVSTihDVFJMMl9MSU5FX1BBVFRFUk5fQ0xSKSB8CisJ
CSAgICAgICBDVFJMMl9FVkVOX0xJTkVfUEFUVEVSTihDVFJMMl9MSU5FX1BBVFRFUk5fQ0xSKSwK
KwkJICAgICAgIG14c2ZiLT5iYXNlICsgTENEQ19WNF9DVFJMMiArIFJFR19DTFIpOwogCiAJc3dp
dGNoIChmb3JtYXQpIHsKLQljYXNlIERSTV9GT1JNQVRfUkdCNTY1OgotCQlkZXZfZGJnKGRybS0+
ZGV2LCAiU2V0dGluZyB1cCBSR0I1NjUgbW9kZVxuIik7CisJY2FzZSBEUk1fRk9STUFUX0JHUjU2
NTogLyogQkcxNiAqLworCQlpZiAobXhzZmItPmRldmRhdGEtPmlwdmVyc2lvbiA8IDQpCisJCQln
b3RvIGVycjsKKwkJd3JpdGVsKENUUkwyX09ERF9MSU5FX1BBVFRFUk4oQ1RSTDJfTElORV9QQVRU
RVJOX0JHUikgfAorCQkJQ1RSTDJfRVZFTl9MSU5FX1BBVFRFUk4oQ1RSTDJfTElORV9QQVRURVJO
X0JHUiksCisJCQlteHNmYi0+YmFzZSArIExDRENfVjRfQ1RSTDIgKyBSRUdfU0VUKTsKKwkJLyog
RmFsbCB0aHJvdWdoICovCisJY2FzZSBEUk1fRk9STUFUX1JHQjU2NTogLyogUkcxNiAqLworCQlj
dHJsIHw9IENUUkxfU0VUX1dPUkRfTEVOR1RIKDApOworCQljdHJsICY9IH5DVFJMX0RGMTY7CisJ
CWN0cmwxIHw9IENUUkwxX1NFVF9CWVRFX1BBQ0tBR0lORygweGYpOworCQlicmVhazsKKwljYXNl
IERSTV9GT1JNQVRfWEJHUjE1NTU6IC8qIFhCMTUgKi8KKwljYXNlIERSTV9GT1JNQVRfQUJHUjE1
NTU6IC8qIEFCMTUgKi8KKwkJaWYgKG14c2ZiLT5kZXZkYXRhLT5pcHZlcnNpb24gPCA0KQorCQkJ
Z290byBlcnI7CisJCXdyaXRlbChDVFJMMl9PRERfTElORV9QQVRURVJOKENUUkwyX0xJTkVfUEFU
VEVSTl9CR1IpIHwKKwkJCUNUUkwyX0VWRU5fTElORV9QQVRURVJOKENUUkwyX0xJTkVfUEFUVEVS
Tl9CR1IpLAorCQkJbXhzZmItPmJhc2UgKyBMQ0RDX1Y0X0NUUkwyICsgUkVHX1NFVCk7CisJCS8q
IEZhbGwgdGhyb3VnaCAqLworCWNhc2UgRFJNX0ZPUk1BVF9YUkdCMTU1NTogLyogWFIxNSAqLwor
CWNhc2UgRFJNX0ZPUk1BVF9BUkdCMTU1NTogLyogQVIxNSAqLwogCQljdHJsIHw9IENUUkxfU0VU
X1dPUkRfTEVOR1RIKDApOworCQljdHJsIHw9IENUUkxfREYxNjsKIAkJY3RybDEgfD0gQ1RSTDFf
U0VUX0JZVEVfUEFDS0FHSU5HKDB4Zik7CiAJCWJyZWFrOwotCWNhc2UgRFJNX0ZPUk1BVF9YUkdC
ODg4ODoKLQkJZGV2X2RiZyhkcm0tPmRldiwgIlNldHRpbmcgdXAgWFJHQjg4ODggbW9kZVxuIik7
CisJY2FzZSBEUk1fRk9STUFUX1JHQlg4ODg4OiAvKiBSWDI0ICovCisJY2FzZSBEUk1fRk9STUFU
X1JHQkE4ODg4OiAvKiBSQTI0ICovCisJCS8qIFJHQlggLSA+IDBSR0IgKi8KKwkJY3RybCB8PSBD
VFJMX1NISUZUX0RJUigxKTsKKwkJY3RybCB8PSBDVFJMX1NISUZUX05VTSg4KTsKKwkJYmdyX2Zv
cm1hdCA9IGZhbHNlOworCQkvKiBGYWxsIHRocm91Z2ggKi8KKwljYXNlIERSTV9GT1JNQVRfWEJH
Ujg4ODg6IC8qIFhCMjQgKi8KKwljYXNlIERSTV9GT1JNQVRfQUJHUjg4ODg6IC8qIEFCMjQgKi8K
KwkJaWYgKGJncl9mb3JtYXQpIHsKKwkJCWlmIChteHNmYi0+ZGV2ZGF0YS0+aXB2ZXJzaW9uIDwg
NCkKKwkJCQlnb3RvIGVycjsKKwkJCXdyaXRlbChDVFJMMl9PRERfTElORV9QQVRURVJOKENUUkwy
X0xJTkVfUEFUVEVSTl9CR1IpIHwKKwkJCSAgICAgICBDVFJMMl9FVkVOX0xJTkVfUEFUVEVSTihD
VFJMMl9MSU5FX1BBVFRFUk5fQkdSKSwKKwkJCSAgICAgICBteHNmYi0+YmFzZSArIExDRENfVjRf
Q1RSTDIgKyBSRUdfU0VUKTsKKwkJfQorCQkvKiBGYWxsIHRocm91Z2ggKi8KKwljYXNlIERSTV9G
T1JNQVRfWFJHQjg4ODg6IC8qIFhSMjQgKi8KKwljYXNlIERSTV9GT1JNQVRfQVJHQjg4ODg6IC8q
IEFSMjQgKi8KIAkJY3RybCB8PSBDVFJMX1NFVF9XT1JEX0xFTkdUSCgzKTsKIAkJLyogRG8gbm90
IHVzZSBwYWNrZWQgcGl4ZWxzID0gb25lIHBpeGVsIHBlciB3b3JkIGluc3RlYWQuICovCiAJCWN0
cmwxIHw9IENUUkwxX1NFVF9CWVRFX1BBQ0tBR0lORygweDcpOwogCQlicmVhazsKIAlkZWZhdWx0
OgotCQlkZXZfZXJyKGRybS0+ZGV2LCAiVW5oYW5kbGVkIHBpeGVsIGZvcm1hdCAlMDh4XG4iLCBm
b3JtYXQpOwotCQlyZXR1cm4gLUVJTlZBTDsKKwkJZ290byBlcnI7CiAJfQogCi0Jd3JpdGVsKGN0
cmwxLCBteHNmYi0+YmFzZSArIExDRENfQ1RSTDEpOwotCXdyaXRlbChjdHJsLCBteHNmYi0+YmFz
ZSArIExDRENfQ1RSTCk7CisJaWYgKHVwZGF0ZSkgeworCQl3cml0ZWwoY3RybCwgbXhzZmItPmJh
c2UgKyBMQ0RDX0NUUkwgKyBSRUdfU0VUKTsKKwkJd3JpdGVsKGN0cmwxLCBteHNmYi0+YmFzZSAr
IExDRENfQ1RSTDEgKyBSRUdfU0VUKTsKKwl9IGVsc2UgeworCQl3cml0ZWwoY3RybCwgbXhzZmIt
PmJhc2UgKyBMQ0RDX0NUUkwpOworCQl3cml0ZWwoY3RybDEsIG14c2ZiLT5iYXNlICsgTENEQ19D
VFJMMSk7CisJfQogCiAJcmV0dXJuIDA7CisKK2VycjoKKwlEUk1fREVWX0VSUk9SKGRybS0+ZGV2
LCAiVW5oYW5kbGVkIHBpeGVsIGZvcm1hdDogJXNcbiIsCisJCSAgICAgIGRybV9nZXRfZm9ybWF0
X25hbWUoZm9ybWF0LCAmZm9ybWF0X25hbWVfYnVmKSk7CisKKwlyZXR1cm4gLUVJTlZBTDsKK30K
Kworc3RhdGljIHUzMiBnZXRfYnVzX2Zvcm1hdF9mcm9tX2JwcCh1MzIgYnBwKQoreworCXN3aXRj
aCAoYnBwKSB7CisJY2FzZSAxNjoKKwkJcmV0dXJuIE1FRElBX0JVU19GTVRfUkdCNTY1XzFYMTY7
CisJY2FzZSAxODoKKwkJcmV0dXJuIE1FRElBX0JVU19GTVRfUkdCNjY2XzFYMTg7CisJY2FzZSAy
NDoKKwkJcmV0dXJuIE1FRElBX0JVU19GTVRfUkdCODg4XzFYMjQ7CisJZGVmYXVsdDoKKwkJcmV0
dXJuIE1FRElBX0JVU19GTVRfUkdCODg4XzFYMjQ7CisJfQogfQogCiBzdGF0aWMgdm9pZCBteHNm
Yl9zZXRfYnVzX2ZtdChzdHJ1Y3QgbXhzZmJfZHJtX3ByaXZhdGUgKm14c2ZiKQogewogCXN0cnVj
dCBkcm1fY3J0YyAqY3J0YyA9ICZteHNmYi0+cGlwZS5jcnRjOworCXVuc2lnbmVkIGludCBiaXRz
X3Blcl9waXhlbCA9IGNydGMtPnByaW1hcnktPnN0YXRlLT5mYi0+Zm9ybWF0LT5kZXB0aDsKIAlz
dHJ1Y3QgZHJtX2RldmljZSAqZHJtID0gY3J0Yy0+ZGV2OwogCXUzMiBidXNfZm9ybWF0ID0gTUVE
SUFfQlVTX0ZNVF9SR0I4ODhfMVgyNDsKLQl1MzIgcmVnOwotCi0JcmVnID0gcmVhZGwobXhzZmIt
PmJhc2UgKyBMQ0RDX0NUUkwpOworCWludCBudW1fYnVzX2Zvcm1hdHMgPSBteHNmYi0+Y29ubmVj
dG9yLT5kaXNwbGF5X2luZm8ubnVtX2J1c19mb3JtYXRzOworCWNvbnN0IHUzMiAqYnVzX2Zvcm1h
dHMgPSBteHNmYi0+Y29ubmVjdG9yLT5kaXNwbGF5X2luZm8uYnVzX2Zvcm1hdHM7CisJdTMyIHJl
ZyA9IDA7CisJaW50IGkgPSAwOworCisJLyogbWF0Y2ggdGhlIHVzZXIgcmVxdWVzdGVkIGJ1c19m
b3JtYXQgdG8gb25lIHN1cHBvcnRlZCBieSB0aGUgcGFuZWwgKi8KKwlpZiAobnVtX2J1c19mb3Jt
YXRzKSB7CisJCXUzMiB1c2VyX2J1c19mb3JtYXQgPSBnZXRfYnVzX2Zvcm1hdF9mcm9tX2JwcChi
aXRzX3Blcl9waXhlbCk7CisKKwkJYnVzX2Zvcm1hdCA9IGJ1c19mb3JtYXRzWzBdOworCQlmb3Ig
KGkgPSAwOyBpIDwgbnVtX2J1c19mb3JtYXRzOyBpKyspIHsKKwkJCWlmICh1c2VyX2J1c19mb3Jt
YXQgPT0gYnVzX2Zvcm1hdHNbaV0pIHsKKwkJCQlidXNfZm9ybWF0ID0gdXNlcl9idXNfZm9ybWF0
OworCQkJCWJyZWFrOworCQkJfQorCQl9CisJfQogCi0JaWYgKG14c2ZiLT5jb25uZWN0b3ItPmRp
c3BsYXlfaW5mby5udW1fYnVzX2Zvcm1hdHMpCi0JCWJ1c19mb3JtYXQgPSBteHNmYi0+Y29ubmVj
dG9yLT5kaXNwbGF5X2luZm8uYnVzX2Zvcm1hdHNbMF07CisJLyoKKwkgKiBDUlRDIHdpbGwgZGlj
dGF0ZSB0aGUgYnVzIGZvcm1hdCB2aWEgcHJpdmF0ZV9mbGFnc1sxNjoxXQorCSAqIGFuZCBwcml2
YXRlX2ZsYWdzWzBdIHdpbGwgc2lnbmFsIGEgYnVzIGZvcm1hdCBjaGFuZ2UKKwkgKi8KKwljcnRj
LT5tb2RlLnByaXZhdGVfZmxhZ3MgJj0gfjB4MUZGRkY7IC8qIGNsZWFyIGJ1cyBmb3JtYXQgKi8K
KwljcnRjLT5tb2RlLnByaXZhdGVfZmxhZ3MgfD0gKGJ1c19mb3JtYXQgPDwgMSk7IC8qIHNldCBi
dXMgZm9ybWF0ICovCisJY3J0Yy0+bW9kZS5wcml2YXRlX2ZsYWdzIHw9IDB4MTsgLyogYnVzIGZv
cm1hdCBjaGFuZ2UgaW5kaWNhdGlvbiovCiAKIAlEUk1fREVWX0RFQlVHX0RSSVZFUihkcm0tPmRl
diwgIlVzaW5nIGJ1c19mb3JtYXQ6IDB4JTA4WFxuIiwKIAkJCSAgICAgYnVzX2Zvcm1hdCk7CiAK
LQlyZWcgJj0gfkNUUkxfQlVTX1dJRFRIX01BU0s7CiAJc3dpdGNoIChidXNfZm9ybWF0KSB7CiAJ
Y2FzZSBNRURJQV9CVVNfRk1UX1JHQjU2NV8xWDE2OgotCQlyZWcgfD0gQ1RSTF9TRVRfQlVTX1dJ
RFRIKFNUTUxDRElGXzE2QklUKTsKKwkJcmVnID0gQ1RSTF9TRVRfQlVTX1dJRFRIKFNUTUxDRElG
XzE2QklUKTsKIAkJYnJlYWs7CiAJY2FzZSBNRURJQV9CVVNfRk1UX1JHQjY2Nl8xWDE4OgotCQly
ZWcgfD0gQ1RSTF9TRVRfQlVTX1dJRFRIKFNUTUxDRElGXzE4QklUKTsKKwkJcmVnID0gQ1RSTF9T
RVRfQlVTX1dJRFRIKFNUTUxDRElGXzE4QklUKTsKIAkJYnJlYWs7CiAJY2FzZSBNRURJQV9CVVNf
Rk1UX1JHQjg4OF8xWDI0OgotCQlyZWcgfD0gQ1RSTF9TRVRfQlVTX1dJRFRIKFNUTUxDRElGXzI0
QklUKTsKKwkJcmVnID0gQ1RSTF9TRVRfQlVTX1dJRFRIKFNUTUxDRElGXzI0QklUKTsKIAkJYnJl
YWs7CiAJZGVmYXVsdDoKIAkJZGV2X2Vycihkcm0tPmRldiwgIlVua25vd24gbWVkaWEgYnVzIGZv
cm1hdCAlZFxuIiwgYnVzX2Zvcm1hdCk7CiAJCWJyZWFrOwogCX0KLQl3cml0ZWwocmVnLCBteHNm
Yi0+YmFzZSArIExDRENfQ1RSTCk7CisJd3JpdGVsKHJlZywgbXhzZmItPmJhc2UgKyBMQ0RDX0NU
UkwgKyBSRUdfU0VUKTsKIH0KIAogc3RhdGljIHZvaWQgbXhzZmJfZW5hYmxlX2NvbnRyb2xsZXIo
c3RydWN0IG14c2ZiX2RybV9wcml2YXRlICpteHNmYikKQEAgLTIzOCw3ICszMzUsNyBAQCBzdGF0
aWMgdm9pZCBteHNmYl9jcnRjX21vZGVfc2V0X25vZmIoc3RydWN0IG14c2ZiX2RybV9wcml2YXRl
ICpteHNmYikKIAkvKiBDbGVhciB0aGUgRklGT3MgKi8KIAl3cml0ZWwoQ1RSTDFfRklGT19DTEVB
UiwgbXhzZmItPmJhc2UgKyBMQ0RDX0NUUkwxICsgUkVHX1NFVCk7CiAKLQllcnIgPSBteHNmYl9z
ZXRfcGl4ZWxfZm10KG14c2ZiKTsKKwllcnIgPSBteHNmYl9zZXRfcGl4ZWxfZm10KG14c2ZiLCBm
YWxzZSk7CiAJaWYgKGVycikKIAkJcmV0dXJuOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vbXhzZmIvbXhzZmJfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vbXhzZmIvbXhzZmJfZHJ2LmMK
aW5kZXggOWRjNjliNy4uMjc0Mzk3NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL214c2Zi
L214c2ZiX2Rydi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9teHNmYi9teHNmYl9kcnYuYwpAQCAt
NDMsNiArNDMsMjcgQEAgZW51bSBteHNmYl9kZXZ0eXBlIHsKIAlNWFNGQl9WNCwKIH07CiAKKy8q
CisgKiBXaGVuIGFkZGluZyBuZXcgZm9ybWF0cywgbWFrZSBzdXJlIHRvIHVwZGF0ZSB0aGUgbnVt
X2Zvcm1hdHMgZnJvbQorICogbXhzZmJfZGV2ZGF0YSBiZWxvdy4KKyAqLworc3RhdGljIGNvbnN0
IHUzMiBteHNmYl9mb3JtYXRzW10gPSB7CisJLyogTVhTRkJfVjMgKi8KKwlEUk1fRk9STUFUX1hS
R0I4ODg4LAorCURSTV9GT1JNQVRfQVJHQjg4ODgsCisJRFJNX0ZPUk1BVF9SR0I1NjUsCisJLyog
TVhTRkJfVjQgKi8KKwlEUk1fRk9STUFUX1hCR1I4ODg4LAorCURSTV9GT1JNQVRfQUJHUjg4ODgs
CisJRFJNX0ZPUk1BVF9SR0JYODg4OCwKKwlEUk1fRk9STUFUX1JHQkE4ODg4LAorCURSTV9GT1JN
QVRfQVJHQjE1NTUsCisJRFJNX0ZPUk1BVF9YUkdCMTU1NSwKKwlEUk1fRk9STUFUX0FCR1IxNTU1
LAorCURSTV9GT1JNQVRfWEJHUjE1NTUsCisJRFJNX0ZPUk1BVF9CR1I1NjUKK307CisKIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgbXhzZmJfZGV2ZGF0YSBteHNmYl9kZXZkYXRhW10gPSB7CiAJW01YU0ZC
X1YzXSA9IHsKIAkJLnRyYW5zZmVyX2NvdW50CT0gTENEQ19WM19UUkFOU0ZFUl9DT1VOVCwKQEAg
LTUyLDYgKzczLDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBteHNmYl9kZXZkYXRhIG14c2ZiX2Rl
dmRhdGFbXSA9IHsKIAkJLmhzX3dkdGhfbWFzawk9IDB4ZmYsCiAJCS5oc193ZHRoX3NoaWZ0CT0g
MjQsCiAJCS5pcHZlcnNpb24JPSAzLAorCQkubnVtX2Zvcm1hdHMJPSAzLAogCX0sCiAJW01YU0ZC
X1Y0XSA9IHsKIAkJLnRyYW5zZmVyX2NvdW50CT0gTENEQ19WNF9UUkFOU0ZFUl9DT1VOVCwKQEAg
LTYxLDE0ICs4MywxMCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IG14c2ZiX2RldmRhdGEgbXhzZmJf
ZGV2ZGF0YVtdID0gewogCQkuaHNfd2R0aF9tYXNrCT0gMHgzZmZmLAogCQkuaHNfd2R0aF9zaGlm
dAk9IDE4LAogCQkuaXB2ZXJzaW9uCT0gNCwKKwkJLm51bV9mb3JtYXRzCT0gQVJSQVlfU0laRSht
eHNmYl9mb3JtYXRzKSwKIAl9LAogfTsKIAotc3RhdGljIGNvbnN0IHVpbnQzMl90IG14c2ZiX2Zv
cm1hdHNbXSA9IHsKLQlEUk1fRk9STUFUX1hSR0I4ODg4LAotCURSTV9GT1JNQVRfUkdCNTY1Ci19
OwotCiBzdGF0aWMgc3RydWN0IG14c2ZiX2RybV9wcml2YXRlICoKIGRybV9waXBlX3RvX214c2Zi
X2RybV9wcml2YXRlKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlfcGlwZSAqcGlwZSkKIHsKQEAg
LTI0NCw3ICsyNjIsNyBAQCBzdGF0aWMgaW50IG14c2ZiX2xvYWQoc3RydWN0IGRybV9kZXZpY2Ug
KmRybSwgdW5zaWduZWQgbG9uZyBmbGFncykKIAl9CiAKIAlyZXQgPSBkcm1fc2ltcGxlX2Rpc3Bs
YXlfcGlwZV9pbml0KGRybSwgJm14c2ZiLT5waXBlLCAmbXhzZmJfZnVuY3MsCi0JCQlteHNmYl9m
b3JtYXRzLCBBUlJBWV9TSVpFKG14c2ZiX2Zvcm1hdHMpLCBOVUxMLAorCQkJbXhzZmJfZm9ybWF0
cywgbXhzZmItPmRldmRhdGEtPm51bV9mb3JtYXRzLCBOVUxMLAogCQkJbXhzZmItPmNvbm5lY3Rv
cik7CiAJaWYgKHJldCA8IDApIHsKIAkJZGV2X2Vycihkcm0tPmRldiwgIkNhbm5vdCBzZXR1cCBz
aW1wbGUgZGlzcGxheSBwaXBlXG4iKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9teHNm
Yi9teHNmYl9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9teHNmYi9teHNmYl9kcnYuaAppbmRleCAw
YjY1YjUxLi44ZmI2NWQzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbXhzZmIvbXhzZmJf
ZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX2Rydi5oCkBAIC0xNiw2ICsx
Niw3IEBAIHN0cnVjdCBteHNmYl9kZXZkYXRhIHsKIAl1bnNpZ25lZCBpbnQJIGhzX3dkdGhfbWFz
azsKIAl1bnNpZ25lZCBpbnQJIGhzX3dkdGhfc2hpZnQ7CiAJdW5zaWduZWQgaW50CSBpcHZlcnNp
b247CisJdW5zaWduZWQgaW50CSBudW1fZm9ybWF0czsKIH07CiAKIHN0cnVjdCBteHNmYl9kcm1f
cHJpdmF0ZSB7CkBAIC00Miw2ICs0Myw2IEBAIHZvaWQgbXhzZmJfZGlzYWJsZV9heGlfY2xrKHN0
cnVjdCBteHNmYl9kcm1fcHJpdmF0ZSAqbXhzZmIpOwogdm9pZCBteHNmYl9jcnRjX2VuYWJsZShz
dHJ1Y3QgbXhzZmJfZHJtX3ByaXZhdGUgKm14c2ZiKTsKIHZvaWQgbXhzZmJfY3J0Y19kaXNhYmxl
KHN0cnVjdCBteHNmYl9kcm1fcHJpdmF0ZSAqbXhzZmIpOwogdm9pZCBteHNmYl9wbGFuZV9hdG9t
aWNfdXBkYXRlKHN0cnVjdCBteHNmYl9kcm1fcHJpdmF0ZSAqbXhzZmIsCi0JCQkgICAgICAgc3Ry
dWN0IGRybV9wbGFuZV9zdGF0ZSAqc3RhdGUpOworCQkJICAgICAgIHN0cnVjdCBkcm1fcGxhbmVf
c3RhdGUgKm9sZF9zdGF0ZSk7CiAKICNlbmRpZiAvKiBfX01YU0ZCX0RSVl9IX18gKi8KZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9teHNmYi9teHNmYl9yZWdzLmggYi9kcml2ZXJzL2dwdS9k
cm0vbXhzZmIvbXhzZmJfcmVncy5oCmluZGV4IDlmY2IxZGIuLmRjNGRhYTAgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9teHNmYi9teHNmYl9yZWdzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJt
L214c2ZiL214c2ZiX3JlZ3MuaApAQCAtNDQsNiArNDQsMTEgQEAKICNkZWZpbmUgUkVHX1BVVCh4
LCBoLCBsKSAoKCh4KSA8PCAobCkpICYgR0VOTUFTSyhoLCBsKSkKICNkZWZpbmUgUkVHX0dFVCh4
LCBoLCBsKSAoKCh4KSAmIEdFTk1BU0soaCwgbCkpID4+IChsKSkKIAorI2RlZmluZSBTV0laWkxF
X0xFCQkwIC8qIExpdHRsZS1FbmRpYW4gb3IgTm8gc3dhcCAqLworI2RlZmluZSBTV0laWkxFX0JF
CQkxIC8qIEJpZy1FbmRpYW4gb3Igc3dhcCBhbGwgKi8KKyNkZWZpbmUgU1dJWlpMRV9IV0QJCTIg
LyogU3dhcCBoYWxmLXdvcmRzICovCisjZGVmaW5lIFNXSVpaTEVfSFdEX0JZVEUJMyAvKiBTd2Fw
IGJ5dGVzIHdpdGhpbiBlYWNoIGhhbGYtd29yZCAqLworCiAjZGVmaW5lIENUUkxfU0ZUUlNUCQkJ
QklUKDMxKQogI2RlZmluZSBDVFJMX0NMS0dBVEUJCQlCSVQoMzApCiAjZGVmaW5lIENUUkxfU0hJ
RlRfRElSKHgpCQlSRUdfUFVUKCh4KSwgMjYsIDI2KQpAQCAtOTMsNiArOTgsMTYgQEAKICNkZWZp
bmUgUkVRXzgJMwogI2RlZmluZSBSRVFfMTYJNAogCisjZGVmaW5lIENUUkwyX09ERF9MSU5FX1BB
VFRFUk4oeCkJUkVHX1BVVCgoeCksIDE4LCAxNikKKyNkZWZpbmUgQ1RSTDJfRVZFTl9MSU5FX1BB
VFRFUk4oeCkJUkVHX1BVVCgoeCksIDE0LCAxMikKKyNkZWZpbmUgQ1RSTDJfTElORV9QQVRURVJO
X1JHQgkwCisjZGVmaW5lIENUUkwyX0xJTkVfUEFUVEVSTl9SQkcJMQorI2RlZmluZSBDVFJMMl9M
SU5FX1BBVFRFUk5fR0JSCTIKKyNkZWZpbmUgQ1RSTDJfTElORV9QQVRURVJOX0dSQgkzCisjZGVm
aW5lIENUUkwyX0xJTkVfUEFUVEVSTl9CUkcJNAorI2RlZmluZSBDVFJMMl9MSU5FX1BBVFRFUk5f
QkdSCTUKKyNkZWZpbmUgQ1RSTDJfTElORV9QQVRURVJOX0NMUgk3CisKICNkZWZpbmUgVFJBTlNG
RVJfQ09VTlRfU0VUX1ZDT1VOVCh4KQlSRUdfUFVUKCh4KSwgMzEsIDE2KQogI2RlZmluZSBUUkFO
U0ZFUl9DT1VOVF9HRVRfVkNPVU5UKHgpCVJFR19HRVQoKHgpLCAzMSwgMTYpCiAjZGVmaW5lIFRS
QU5TRkVSX0NPVU5UX1NFVF9IQ09VTlQoeCkJUkVHX1BVVCgoeCksIDE1LCAwKQotLSAKMi43LjQK
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZl
bCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xp
c3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
