Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id E014F10F9F
	for <lists+dri-devel@lfdr.de>; Thu,  2 May 2019 01:03:28 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id DF99D892EA;
	Wed,  1 May 2019 23:03:26 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-qt1-x849.google.com (mail-qt1-x849.google.com
 [IPv6:2607:f8b0:4864:20::849])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6624B892EA
 for <dri-devel@lists.freedesktop.org>; Wed,  1 May 2019 23:03:25 +0000 (UTC)
Received: by mail-qt1-x849.google.com with SMTP id o17so363122qtf.4
 for <dri-devel@lists.freedesktop.org>; Wed, 01 May 2019 16:03:25 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:date:in-reply-to:message-id:mime-version
 :references:subject:from:to:cc;
 bh=urCLrOiw73Vv5m0tMcCZvTwJh/aJ5kKPWwQUr8lpbDs=;
 b=IuP7GZE0zvwngmRuWU5zCabnSL0t2ECJACDhX1fKP67EJfKjh3iTW0Nw4hamFzOw/f
 KQAqyKZ+Za3tqHva4ZTUt+qKouFVXCwQQ5mlf4Y7isogrpfLs1ELtvqhh4zT0te4Lg/s
 AYksmwaapcyW++2Hy1F/06+YOtz9f45L6Yzs5RqPt7GoiIhQWGkdCZ3YPWoZtqiY5pQh
 ve0YeKyv5y8YPEuz7WTGd9tci6mpAvQuTPSfaWn1S/TkeqFksLJQyVoOpTWanEfiIlVL
 d9ukFpD6eZiU9OkuJzK3PMN6ZjGHgnXP7T8t3uAuiGkgX2qtjfEABmwn3tjoj3yUWHdL
 ZxrQ==
X-Gm-Message-State: APjAAAXYJQZB2nk70lLvfMPaL2L8vtKq5YNTDloQx8qstNH0VCQfufTW
 kS5278WllGxoz097epNWUXEE7hVqUUyp9Ey8FZOXfA==
X-Google-Smtp-Source: APXvYqzuaah6eN+BnmU2QIpoTy8skknwndesM81SnMIUGPEVKZJRALywtm4GzLckHSPDXmcsRuwc+JtPytB6XBF7YEiU2A==
X-Received: by 2002:a37:b584:: with SMTP id e126mr518765qkf.199.1556751804530; 
 Wed, 01 May 2019 16:03:24 -0700 (PDT)
Date: Wed,  1 May 2019 16:01:13 -0700
In-Reply-To: <20190501230126.229218-1-brendanhiggins@google.com>
Message-Id: <20190501230126.229218-5-brendanhiggins@google.com>
Mime-Version: 1.0
References: <20190501230126.229218-1-brendanhiggins@google.com>
X-Mailer: git-send-email 2.21.0.593.g511ec345e18-goog
Subject: [PATCH v2 04/17] kunit: test: add kunit_stream a std::stream like
 logger
From: Brendan Higgins <brendanhiggins@google.com>
To: frowand.list@gmail.com, gregkh@linuxfoundation.org, keescook@google.com, 
 kieran.bingham@ideasonboard.com, mcgrof@kernel.org, robh@kernel.org, 
 sboyd@kernel.org, shuah@kernel.org
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=google.com; s=20161025;
 h=date:in-reply-to:message-id:mime-version:references:subject:from:to
 :cc;
 bh=urCLrOiw73Vv5m0tMcCZvTwJh/aJ5kKPWwQUr8lpbDs=;
 b=v3lZRqq8dgL9+PqnTUTbY+8dJh4vp53nIOdXSIzGhHpcQ0w6vRo1cvTduoA4Nj1eHO
 Vj1iscYKcGHhJT1LDHo8rdN4jjC9NUVjk4dIx4jQtvhcXEgglk4duUVMreW99xnbfCvc
 bSH283YpBrzoc5hyBIq5VaCNQgTA5Go0LwNo98GpxaGYnHQOqpwwWwPEOsJ6eFfp2kzQ
 W9BbQpk5TAL2/OVhivKy9yEhBjRCwIKJf6tje/aOObay9RAn9ha33Xzn0VmEpWnRGIld
 RrBcIhMCibkbFSaJA/uzVkDRd1srcEaUzbR2flslENnIUlVc8jnqbwDWrLThgi8BlCDk
 kYlw==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: pmladek@suse.com, linux-doc@vger.kernel.org, amir73il@gmail.com,
 Brendan Higgins <brendanhiggins@google.com>, dri-devel@lists.freedesktop.org,
 Alexander.Levin@microsoft.com, linux-kselftest@vger.kernel.org,
 linux-nvdimm@lists.01.org, khilman@baylibre.com, knut.omang@oracle.com,
 wfg@linux.intel.com, joel@jms.id.au, rientjes@google.com, jdike@addtoit.com,
 dan.carpenter@oracle.com, devicetree@vger.kernel.org,
 linux-kbuild@vger.kernel.org, Tim.Bird@sony.com, linux-um@lists.infradead.org,
 rostedt@goodmis.org, julia.lawall@lip6.fr, dan.j.williams@intel.com,
 kunit-dev@googlegroups.com, richard@nod.at, linux-kernel@vger.kernel.org,
 mpe@ellerman.id.au, linux-fsdevel@vger.kernel.org, logang@deltatee.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QSBsb3Qgb2YgdGhlIGV4cGVjdGF0aW9uIGFuZCBhc3NlcnRpb24gaW5mcmFzdHJ1Y3R1cmUgcHJp
bnRzIG91dCBmYWlybHkKY29tcGxpY2F0ZWQgdGVzdCBmYWlsdXJlIG1lc3NhZ2VzLCBzbyBhZGQg
YSBDKysgc3R5bGUgbG9nIGxpYnJhcnkgZm9yCmZvciBsb2dnaW5nIHRlc3QgcmVzdWx0cy4KClNp
Z25lZC1vZmYtYnk6IEJyZW5kYW4gSGlnZ2lucyA8YnJlbmRhbmhpZ2dpbnNAZ29vZ2xlLmNvbT4K
LS0tCiBpbmNsdWRlL2t1bml0L2t1bml0LXN0cmVhbS5oIHwgIDg1ICsrKysrKysrKysrKysrKysr
KysrCiBpbmNsdWRlL2t1bml0L3Rlc3QuaCAgICAgICAgIHwgICAyICsKIGt1bml0L01ha2VmaWxl
ICAgICAgICAgICAgICAgfCAgIDMgKy0KIGt1bml0L2t1bml0LXN0cmVhbS5jICAgICAgICAgfCAx
NDkgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIGt1bml0L3Rlc3QuYyAgICAg
ICAgICAgICAgICAgfCAgIDggKysKIDUgZmlsZXMgY2hhbmdlZCwgMjQ2IGluc2VydGlvbnMoKyks
IDEgZGVsZXRpb24oLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBpbmNsdWRlL2t1bml0L2t1bml0LXN0
cmVhbS5oCiBjcmVhdGUgbW9kZSAxMDA2NDQga3VuaXQva3VuaXQtc3RyZWFtLmMKCmRpZmYgLS1n
aXQgYS9pbmNsdWRlL2t1bml0L2t1bml0LXN0cmVhbS5oIGIvaW5jbHVkZS9rdW5pdC9rdW5pdC1z
dHJlYW0uaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAwLi5kNDU3YTU0
ZmUwMTAwCi0tLSAvZGV2L251bGwKKysrIGIvaW5jbHVkZS9rdW5pdC9rdW5pdC1zdHJlYW0uaApA
QCAtMCwwICsxLDg1IEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCAqLwor
LyoKKyAqIEMrKyBzdHJlYW0gc3R5bGUgc3RyaW5nIGZvcm1hdHRlciBhbmQgcHJpbnRlciB1c2Vk
IGluIEtVbml0IGZvciBvdXRwdXR0aW5nCisgKiBLVW5pdCBtZXNzYWdlcy4KKyAqCisgKiBDb3B5
cmlnaHQgKEMpIDIwMTksIEdvb2dsZSBMTEMuCisgKiBBdXRob3I6IEJyZW5kYW4gSGlnZ2lucyA8
YnJlbmRhbmhpZ2dpbnNAZ29vZ2xlLmNvbT4KKyAqLworCisjaWZuZGVmIF9LVU5JVF9LVU5JVF9T
VFJFQU1fSAorI2RlZmluZSBfS1VOSVRfS1VOSVRfU1RSRUFNX0gKKworI2luY2x1ZGUgPGxpbnV4
L3R5cGVzLmg+CisjaW5jbHVkZSA8a3VuaXQvc3RyaW5nLXN0cmVhbS5oPgorCitzdHJ1Y3Qga3Vu
aXQ7CisKKy8qKgorICogc3RydWN0IGt1bml0X3N0cmVhbSAtIGEgc3RkOjpzdHJlYW0gc3R5bGUg
c3RyaW5nIGJ1aWxkZXIuCisgKgorICogQSBzdGQ6OnN0cmVhbSBzdHlsZSBzdHJpbmcgYnVpbGRl
ci4gQWxsb3dzIG1lc3NhZ2VzIHRvIGJlIGJ1aWx0IHVwIGFuZAorICogcHJpbnRlZCBhbGwgYXQg
b25jZS4KKyAqLworc3RydWN0IGt1bml0X3N0cmVhbSB7CisJLyogcHJpdmF0ZTogaW50ZXJuYWwg
dXNlIG9ubHkuICovCisJc3RydWN0IGt1bml0ICp0ZXN0OworCXNwaW5sb2NrX3QgbG9jazsgLyog
R3VhcmRzIGxldmVsLiAqLworCWNvbnN0IGNoYXIgKmxldmVsOworCXN0cnVjdCBzdHJpbmdfc3Ry
ZWFtICppbnRlcm5hbF9zdHJlYW07Cit9OworCisvKioKKyAqIGt1bml0X25ld19zdHJlYW0oKSAt
IGNvbnN0cnVjdHMgYSBuZXcgJnN0cnVjdCBrdW5pdF9zdHJlYW0uCisgKiBAdGVzdDogVGhlIHRl
c3QgY29udGV4dCBvYmplY3QuCisgKgorICogQ29uc3RydWN0cyBhIG5ldyB0ZXN0IG1hbmFnZWQg
JnN0cnVjdCBrdW5pdF9zdHJlYW0uCisgKi8KK3N0cnVjdCBrdW5pdF9zdHJlYW0gKmt1bml0X25l
d19zdHJlYW0oc3RydWN0IGt1bml0ICp0ZXN0KTsKKworLyoqCisgKiBrdW5pdF9zdHJlYW1fc2V0
X2xldmVsKCk6IHNldHMgdGhlIGxldmVsIHRoYXQgc3RyaW5nIHNob3VsZCBiZSBwcmludGVkIGF0
LgorICogQHRoaXM6IHRoZSBzdHJlYW0gYmVpbmcgb3BlcmF0ZWQgb24uCisgKiBAbGV2ZWw6IHRo
ZSBwcmludCBsZXZlbCB0aGUgc3RyZWFtIGlzIHNldCB0byBvdXRwdXQgdG8uCisgKgorICogU2V0
cyB0aGUgcHJpbnQgbGV2ZWwgYXQgd2hpY2ggdGhlIHN0cmVhbSBvdXRwdXRzLgorICovCit2b2lk
IGt1bml0X3N0cmVhbV9zZXRfbGV2ZWwoc3RydWN0IGt1bml0X3N0cmVhbSAqdGhpcywgY29uc3Qg
Y2hhciAqbGV2ZWwpOworCisvKioKKyAqIGt1bml0X3N0cmVhbV9hZGQoKTogYWRkcyB0aGUgZm9y
bWF0dGVkIGlucHV0IHRvIHRoZSBpbnRlcm5hbCBidWZmZXIuCisgKiBAdGhpczogdGhlIHN0cmVh
bSBiZWluZyBvcGVyYXRlZCBvbi4KKyAqIEBmbXQ6IHByaW50ZiBzdHlsZSBmb3JtYXQgc3RyaW5n
IHRvIGFwcGVuZCB0byBzdHJlYW0uCisgKgorICogQXBwZW5kcyB0aGUgZm9ybWF0dGVkIHN0cmlu
ZywgQGZtdCwgdG8gdGhlIGludGVybmFsIGJ1ZmZlci4KKyAqLwordm9pZCBfX3ByaW50ZigyLCAz
KSBrdW5pdF9zdHJlYW1fYWRkKHN0cnVjdCBrdW5pdF9zdHJlYW0gKnRoaXMsCisJCQkJICAgICBj
b25zdCBjaGFyICpmbXQsIC4uLik7CisKKy8qKgorICoga3VuaXRfc3RyZWFtX2FwcGVuZCgpOiBh
cHBlbmRzIHRoZSBjb250ZW50cyBvZiBAb3RoZXIgdG8gQHRoaXMuCisgKiBAdGhpczogdGhlIHN0
cmVhbSB0byB3aGljaCBAb3RoZXIgaXMgYXBwZW5kZWQuCisgKiBAb3RoZXI6IHRoZSBzdHJlYW0g
d2hvc2UgY29udGVudHMgYXJlIGFwcGVuZGVkIHRvIEB0aGlzLgorICoKKyAqIEFwcGVuZHMgdGhl
IGNvbnRlbnRzIG9mIEBvdGhlciB0byBAdGhpcy4KKyAqLwordm9pZCBrdW5pdF9zdHJlYW1fYXBw
ZW5kKHN0cnVjdCBrdW5pdF9zdHJlYW0gKnRoaXMsIHN0cnVjdCBrdW5pdF9zdHJlYW0gKm90aGVy
KTsKKworLyoqCisgKiBrdW5pdF9zdHJlYW1fY29tbWl0KCk6IHByaW50cyBvdXQgdGhlIGludGVy
bmFsIGJ1ZmZlciB0byB0aGUgdXNlci4KKyAqIEB0aGlzOiB0aGUgc3RyZWFtIGJlaW5nIG9wZXJh
dGVkIG9uLgorICoKKyAqIE91dHB1dHMgdGhlIGNvbnRlbnRzIG9mIHRoZSBpbnRlcm5hbCBidWZm
ZXIgYXMgYSBrdW5pdF9wcmludGsgZm9ybWF0dGVkCisgKiBvdXRwdXQuCisgKi8KK3ZvaWQga3Vu
aXRfc3RyZWFtX2NvbW1pdChzdHJ1Y3Qga3VuaXRfc3RyZWFtICp0aGlzKTsKKworLyoqCisgKiBr
dW5pdF9zdHJlYW1fY2xlYXIoKTogY2xlYXJzIHRoZSBpbnRlcm5hbCBidWZmZXIuCisgKiBAdGhp
czogdGhlIHN0cmVhbSBiZWluZyBvcGVyYXRlZCBvbi4KKyAqCisgKiBDbGVhcnMgdGhlIGNvbnRl
bnRzIG9mIHRoZSBpbnRlcm5hbCBidWZmZXIuCisgKi8KK3ZvaWQga3VuaXRfc3RyZWFtX2NsZWFy
KHN0cnVjdCBrdW5pdF9zdHJlYW0gKnRoaXMpOworCisjZW5kaWYgLyogX0tVTklUX0tVTklUX1NU
UkVBTV9IICovCmRpZmYgLS1naXQgYS9pbmNsdWRlL2t1bml0L3Rlc3QuaCBiL2luY2x1ZGUva3Vu
aXQvdGVzdC5oCmluZGV4IDgxOWVkZDhkYjRlODEuLjQ2NjhlOGE2MzU5NTQgMTAwNjQ0Ci0tLSBh
L2luY2x1ZGUva3VuaXQvdGVzdC5oCisrKyBiL2luY2x1ZGUva3VuaXQvdGVzdC5oCkBAIC0xMSw2
ICsxMSw3IEBACiAKICNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgogI2luY2x1ZGUgPGxpbnV4L3Ns
YWIuaD4KKyNpbmNsdWRlIDxrdW5pdC9rdW5pdC1zdHJlYW0uaD4KIAogc3RydWN0IGt1bml0X3Jl
c291cmNlOwogCkBAIC0xNzEsNiArMTcyLDcgQEAgc3RydWN0IGt1bml0IHsKIAl2b2lkICgqdnBy
aW50aykoY29uc3Qgc3RydWN0IGt1bml0ICp0ZXN0LAogCQkJY29uc3QgY2hhciAqbGV2ZWwsCiAJ
CQlzdHJ1Y3QgdmFfZm9ybWF0ICp2YWYpOworCXZvaWQgKCpmYWlsKShzdHJ1Y3Qga3VuaXQgKnRl
c3QsIHN0cnVjdCBrdW5pdF9zdHJlYW0gKnN0cmVhbSk7CiB9OwogCiBpbnQga3VuaXRfaW5pdF90
ZXN0KHN0cnVjdCBrdW5pdCAqdGVzdCwgY29uc3QgY2hhciAqbmFtZSk7CmRpZmYgLS1naXQgYS9r
dW5pdC9NYWtlZmlsZSBiL2t1bml0L01ha2VmaWxlCmluZGV4IDI3NWI1NjVhMGU4MWYuLjZkZGM2
MjJlZTZiMWMgMTAwNjQ0Ci0tLSBhL2t1bml0L01ha2VmaWxlCisrKyBiL2t1bml0L01ha2VmaWxl
CkBAIC0xLDIgKzEsMyBAQAogb2JqLSQoQ09ORklHX0tVTklUKSArPQkJCXRlc3QubyBcCi0JCQkJ
CXN0cmluZy1zdHJlYW0ubworCQkJCQlzdHJpbmctc3RyZWFtLm8gXAorCQkJCQlrdW5pdC1zdHJl
YW0ubwpkaWZmIC0tZ2l0IGEva3VuaXQva3VuaXQtc3RyZWFtLmMgYi9rdW5pdC9rdW5pdC1zdHJl
YW0uYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAwLi45M2MxNGVlYzAz
ODQ0Ci0tLSAvZGV2L251bGwKKysrIGIva3VuaXQva3VuaXQtc3RyZWFtLmMKQEAgLTAsMCArMSwx
NDkgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisvKgorICogQysrIHN0
cmVhbSBzdHlsZSBzdHJpbmcgZm9ybWF0dGVyIGFuZCBwcmludGVyIHVzZWQgaW4gS1VuaXQgZm9y
IG91dHB1dHRpbmcKKyAqIEtVbml0IG1lc3NhZ2VzLgorICoKKyAqIENvcHlyaWdodCAoQykgMjAx
OSwgR29vZ2xlIExMQy4KKyAqIEF1dGhvcjogQnJlbmRhbiBIaWdnaW5zIDxicmVuZGFuaGlnZ2lu
c0Bnb29nbGUuY29tPgorICovCisKKyNpbmNsdWRlIDxrdW5pdC90ZXN0Lmg+CisjaW5jbHVkZSA8
a3VuaXQva3VuaXQtc3RyZWFtLmg+CisjaW5jbHVkZSA8a3VuaXQvc3RyaW5nLXN0cmVhbS5oPgor
Citjb25zdCBjaGFyICprdW5pdF9zdHJlYW1fZ2V0X2xldmVsKHN0cnVjdCBrdW5pdF9zdHJlYW0g
KnRoaXMpCit7CisJdW5zaWduZWQgbG9uZyBmbGFnczsKKwljb25zdCBjaGFyICpsZXZlbDsKKwor
CXNwaW5fbG9ja19pcnFzYXZlKCZ0aGlzLT5sb2NrLCBmbGFncyk7CisJbGV2ZWwgPSB0aGlzLT5s
ZXZlbDsKKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZ0aGlzLT5sb2NrLCBmbGFncyk7CisKKwly
ZXR1cm4gbGV2ZWw7Cit9CisKK3ZvaWQga3VuaXRfc3RyZWFtX3NldF9sZXZlbChzdHJ1Y3Qga3Vu
aXRfc3RyZWFtICp0aGlzLCBjb25zdCBjaGFyICpsZXZlbCkKK3sKKwl1bnNpZ25lZCBsb25nIGZs
YWdzOworCisJc3Bpbl9sb2NrX2lycXNhdmUoJnRoaXMtPmxvY2ssIGZsYWdzKTsKKwl0aGlzLT5s
ZXZlbCA9IGxldmVsOworCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnRoaXMtPmxvY2ssIGZsYWdz
KTsKK30KKwordm9pZCBrdW5pdF9zdHJlYW1fYWRkKHN0cnVjdCBrdW5pdF9zdHJlYW0gKnRoaXMs
IGNvbnN0IGNoYXIgKmZtdCwgLi4uKQoreworCXZhX2xpc3QgYXJnczsKKwlzdHJ1Y3Qgc3RyaW5n
X3N0cmVhbSAqc3RyZWFtID0gdGhpcy0+aW50ZXJuYWxfc3RyZWFtOworCisJdmFfc3RhcnQoYXJn
cywgZm10KTsKKworCWlmIChzdHJpbmdfc3RyZWFtX3ZhZGQoc3RyZWFtLCBmbXQsIGFyZ3MpIDwg
MCkKKwkJa3VuaXRfZXJyKHRoaXMtPnRlc3QsICJGYWlsZWQgdG8gYWxsb2NhdGUgZnJhZ21lbnQ6
ICVzXG4iLCBmbXQpOworCisJdmFfZW5kKGFyZ3MpOworfQorCit2b2lkIGt1bml0X3N0cmVhbV9h
cHBlbmQoc3RydWN0IGt1bml0X3N0cmVhbSAqdGhpcywKKwkJCQlzdHJ1Y3Qga3VuaXRfc3RyZWFt
ICpvdGhlcikKK3sKKwlzdHJ1Y3Qgc3RyaW5nX3N0cmVhbSAqb3RoZXJfc3RyZWFtID0gb3RoZXIt
PmludGVybmFsX3N0cmVhbTsKKwljb25zdCBjaGFyICpvdGhlcl9jb250ZW50OworCisJb3RoZXJf
Y29udGVudCA9IHN0cmluZ19zdHJlYW1fZ2V0X3N0cmluZyhvdGhlcl9zdHJlYW0pOworCisJaWYg
KCFvdGhlcl9jb250ZW50KSB7CisJCWt1bml0X2Vycih0aGlzLT50ZXN0LAorCQkJICAiRmFpbGVk
IHRvIGdldCBzdHJpbmcgZnJvbSBzZWNvbmQgYXJndW1lbnQgZm9yIGFwcGVuZGluZy5cbiIpOwor
CQlyZXR1cm47CisJfQorCisJa3VuaXRfc3RyZWFtX2FkZCh0aGlzLCBvdGhlcl9jb250ZW50KTsK
K30KKwordm9pZCBrdW5pdF9zdHJlYW1fY2xlYXIoc3RydWN0IGt1bml0X3N0cmVhbSAqdGhpcykK
K3sKKwlzdHJpbmdfc3RyZWFtX2NsZWFyKHRoaXMtPmludGVybmFsX3N0cmVhbSk7Cit9CisKK3Zv
aWQga3VuaXRfc3RyZWFtX2NvbW1pdChzdHJ1Y3Qga3VuaXRfc3RyZWFtICp0aGlzKQoreworCXN0
cnVjdCBzdHJpbmdfc3RyZWFtICpzdHJlYW0gPSB0aGlzLT5pbnRlcm5hbF9zdHJlYW07CisJc3Ry
dWN0IHN0cmluZ19zdHJlYW1fZnJhZ21lbnQgKmZyYWdtZW50OworCWNvbnN0IGNoYXIgKmxldmVs
OworCWNoYXIgKmJ1ZjsKKworCWxldmVsID0ga3VuaXRfc3RyZWFtX2dldF9sZXZlbCh0aGlzKTsK
KwlpZiAoIWxldmVsKSB7CisJCWt1bml0X2Vycih0aGlzLT50ZXN0LAorCQkJICAiU3RyZWFtIHdh
cyBjb21taXR0ZWQgd2l0aG91dCBhIHNwZWNpZmllZCBsb2cgbGV2ZWwuXG4iKTsKKwkJbGV2ZWwg
PSBLRVJOX0VSUjsKKwkJa3VuaXRfc3RyZWFtX3NldF9sZXZlbCh0aGlzLCBsZXZlbCk7CisJfQor
CisJYnVmID0gc3RyaW5nX3N0cmVhbV9nZXRfc3RyaW5nKHN0cmVhbSk7CisJaWYgKCFidWYpIHsK
KwkJa3VuaXRfZXJyKHRoaXMtPnRlc3QsCisJCQkgIkNvdWxkIG5vdCBhbGxvY2F0ZSBidWZmZXIs
IGR1bXBpbmcgc3RyZWFtOlxuIik7CisJCWxpc3RfZm9yX2VhY2hfZW50cnkoZnJhZ21lbnQsICZz
dHJlYW0tPmZyYWdtZW50cywgbm9kZSkgeworCQkJa3VuaXRfZXJyKHRoaXMtPnRlc3QsIGZyYWdt
ZW50LT5mcmFnbWVudCk7CisJCX0KKwkJa3VuaXRfZXJyKHRoaXMtPnRlc3QsICJcbiIpOworCQln
b3RvIGNsZWFudXA7CisJfQorCisJa3VuaXRfcHJpbnRrKGxldmVsLCB0aGlzLT50ZXN0LCBidWYp
OworCWtmcmVlKGJ1Zik7CisKK2NsZWFudXA6CisJa3VuaXRfc3RyZWFtX2NsZWFyKHRoaXMpOwor
fQorCitzdGF0aWMgaW50IGt1bml0X3N0cmVhbV9pbml0KHN0cnVjdCBrdW5pdF9yZXNvdXJjZSAq
cmVzLCB2b2lkICpjb250ZXh0KQoreworCXN0cnVjdCBrdW5pdCAqdGVzdCA9IGNvbnRleHQ7CisJ
c3RydWN0IGt1bml0X3N0cmVhbSAqc3RyZWFtOworCisJc3RyZWFtID0ga3phbGxvYyhzaXplb2Yo
KnN0cmVhbSksIEdGUF9LRVJORUwpOworCWlmICghc3RyZWFtKQorCQlyZXR1cm4gLUVOT01FTTsK
KwlyZXMtPmFsbG9jYXRpb24gPSBzdHJlYW07CisJc3RyZWFtLT50ZXN0ID0gdGVzdDsKKwlzcGlu
X2xvY2tfaW5pdCgmc3RyZWFtLT5sb2NrKTsKKwlzdHJlYW0tPmludGVybmFsX3N0cmVhbSA9IG5l
d19zdHJpbmdfc3RyZWFtKCk7CisKKwlpZiAoIXN0cmVhbS0+aW50ZXJuYWxfc3RyZWFtKQorCQly
ZXR1cm4gLUVOT01FTTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBrdW5pdF9zdHJl
YW1fZnJlZShzdHJ1Y3Qga3VuaXRfcmVzb3VyY2UgKnJlcykKK3sKKwlzdHJ1Y3Qga3VuaXRfc3Ry
ZWFtICpzdHJlYW0gPSByZXMtPmFsbG9jYXRpb247CisKKwlpZiAoIXN0cmluZ19zdHJlYW1faXNf
ZW1wdHkoc3RyZWFtLT5pbnRlcm5hbF9zdHJlYW0pKSB7CisJCWt1bml0X2VycihzdHJlYW0tPnRl
c3QsCisJCQkgIkVuZCBvZiB0ZXN0IGNhc2UgcmVhY2hlZCB3aXRoIHVuY29tbWl0dGVkIHN0cmVh
bSBlbnRyaWVzLlxuIik7CisJCWt1bml0X3N0cmVhbV9jb21taXQoc3RyZWFtKTsKKwl9CisKKwlk
ZXN0cm95X3N0cmluZ19zdHJlYW0oc3RyZWFtLT5pbnRlcm5hbF9zdHJlYW0pOworCWtmcmVlKHN0
cmVhbSk7Cit9CisKK3N0cnVjdCBrdW5pdF9zdHJlYW0gKmt1bml0X25ld19zdHJlYW0oc3RydWN0
IGt1bml0ICp0ZXN0KQoreworCXN0cnVjdCBrdW5pdF9yZXNvdXJjZSAqcmVzOworCisJcmVzID0g
a3VuaXRfYWxsb2NfcmVzb3VyY2UodGVzdCwKKwkJCQkgICBrdW5pdF9zdHJlYW1faW5pdCwKKwkJ
CQkgICBrdW5pdF9zdHJlYW1fZnJlZSwKKwkJCQkgICB0ZXN0KTsKKworCWlmIChyZXMpCisJCXJl
dHVybiByZXMtPmFsbG9jYXRpb247CisJZWxzZQorCQlyZXR1cm4gTlVMTDsKK30KZGlmZiAtLWdp
dCBhL2t1bml0L3Rlc3QuYyBiL2t1bml0L3Rlc3QuYwppbmRleCA1NDFmOWFkYjE2MDhjLi5mNzU3
NWIxMjdlMmRmIDEwMDY0NAotLS0gYS9rdW5pdC90ZXN0LmMKKysrIGIva3VuaXQvdGVzdC5jCkBA
IC02MywxMiArNjMsMjAgQEAgc3RhdGljIHZvaWQga3VuaXRfdnByaW50ayhjb25zdCBzdHJ1Y3Qg
a3VuaXQgKnRlc3QsCiAJCQkgICJrdW5pdCAlczogJXBWIiwgdGVzdC0+bmFtZSwgdmFmKTsKIH0K
IAorc3RhdGljIHZvaWQga3VuaXRfZmFpbChzdHJ1Y3Qga3VuaXQgKnRlc3QsIHN0cnVjdCBrdW5p
dF9zdHJlYW0gKnN0cmVhbSkKK3sKKwlrdW5pdF9zZXRfc3VjY2Vzcyh0ZXN0LCBmYWxzZSk7CisJ
a3VuaXRfc3RyZWFtX3NldF9sZXZlbChzdHJlYW0sIEtFUk5fRVJSKTsKKwlrdW5pdF9zdHJlYW1f
Y29tbWl0KHN0cmVhbSk7Cit9CisKIGludCBrdW5pdF9pbml0X3Rlc3Qoc3RydWN0IGt1bml0ICp0
ZXN0LCBjb25zdCBjaGFyICpuYW1lKQogewogCXNwaW5fbG9ja19pbml0KCZ0ZXN0LT5sb2NrKTsK
IAlJTklUX0xJU1RfSEVBRCgmdGVzdC0+cmVzb3VyY2VzKTsKIAl0ZXN0LT5uYW1lID0gbmFtZTsK
IAl0ZXN0LT52cHJpbnRrID0ga3VuaXRfdnByaW50azsKKwl0ZXN0LT5mYWlsID0ga3VuaXRfZmFp
bDsKIAogCXJldHVybiAwOwogfQotLSAKMi4yMS4wLjU5My5nNTExZWMzNDVlMTgtZ29vZwoKX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1h
aWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
