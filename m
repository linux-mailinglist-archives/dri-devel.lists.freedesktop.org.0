Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 6507BECA66
	for <lists+dri-devel@lfdr.de>; Fri,  1 Nov 2019 22:42:53 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CBEA36F87C;
	Fri,  1 Nov 2019 21:42:48 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-pf1-x441.google.com (mail-pf1-x441.google.com
 [IPv6:2607:f8b0:4864:20::441])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A129F6E332
 for <dri-devel@lists.freedesktop.org>; Fri,  1 Nov 2019 21:42:45 +0000 (UTC)
Received: by mail-pf1-x441.google.com with SMTP id r4so7906760pfl.7
 for <dri-devel@lists.freedesktop.org>; Fri, 01 Nov 2019 14:42:45 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references;
 bh=zsyNUtxc9hXZeSAhIQe7CJ4uz0AseevIwmkwC456WIM=;
 b=FrxCDKpV6efLXRiFC2qsOXo7WXOtwmi3JqNVnFaafrupuqZQx0dwtgx4Wq1gO8jcTm
 SLUjW2WmlsQQ6ZmtGhba7kDfrOa0Jg7EaJAklc1t/pYC/B2djVACE2lLwLU7PyDkj/pH
 VFrhCVJ8EBU+x4jZFR3L+TNiO5lMZFd6RQx4eRTMyzlBXRSAMXm3Umd2UQI1bhwd7++U
 Yus44RPeSlkGM7cwmCe5FQRknkG0dO2UThiHyyt2XgIk0yvkwbo0fI3+jDkRjfXPvVQ6
 PNjU/UnO6G92Z+8CvWHT1ZIR7Ej6Puun5b6ukS97gLB0i4jqwp/MbgtD5Xd/nvh3BNcp
 M1uw==
X-Gm-Message-State: APjAAAXEbw/3uGqc+ASlrLIhY/biuxFdSysmMJ0gCvvHADhWw1dIVb0+
 cBcOOmYS8Ujbe/lpLgJvptjlpg==
X-Google-Smtp-Source: APXvYqzD05OeotubP9D6EuYseumR2DT41+TpoL69H5vG+rcqcfKHVj/jrqYz5iZrdLfnH93q2/977w==
X-Received: by 2002:a62:108:: with SMTP id 8mr16120307pfb.53.1572644565180;
 Fri, 01 Nov 2019 14:42:45 -0700 (PDT)
Received: from localhost.localdomain ([2601:1c2:680:1319:692:26ff:feda:3a81])
 by smtp.gmail.com with ESMTPSA id
 u36sm8299058pgn.29.2019.11.01.14.42.44
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 01 Nov 2019 14:42:44 -0700 (PDT)
From: John Stultz <john.stultz@linaro.org>
To: lkml <linux-kernel@vger.kernel.org>
Subject: [PATCH v14 3/5] dma-buf: heaps: Add system heap to dmabuf heaps
Date: Fri,  1 Nov 2019 21:42:36 +0000
Message-Id: <20191101214238.78015-4-john.stultz@linaro.org>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20191101214238.78015-1-john.stultz@linaro.org>
References: <20191101214238.78015-1-john.stultz@linaro.org>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=linaro.org; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references;
 bh=zsyNUtxc9hXZeSAhIQe7CJ4uz0AseevIwmkwC456WIM=;
 b=FottNfCa6Y2ifojb04XiQ4QD7BavbugchST44Gitb/q4wPFyuBg0HpoteYS6zSLrgS
 B0/t6BxerfwYT4VQ9maXk88FF1jPqJFAWh2zasRJgbwaZOKMFIccZ4VtXVo7rNDnelQc
 6ZwnXWDoSbJ0baqNQTmEHIM29AnTHTLyExB0Rcq6uCHa/zxgyJxFHfDrG5qutGPMOyJI
 Mbz7x9uAmoSpEvXLXrDQeK3FazRx5HhQpJA9EIghuoL2P3CuxyN35Cxl1vD9zfd+HBiP
 FaDWuOQmdDuU9KsKbN9BPrTbp4ejlSMqXCkscxdZm2kat/Ij+8cf8NoD2TYX4S1fN/oV
 KSGg==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Hillf Danton <hdanton@sina.com>, Sudipto Paul <Sudipto.Paul@arm.com>,
 Sandeep Patil <sspatil@google.com>,
 Vincent Donnefort <Vincent.Donnefort@arm.com>, Chenbo Feng <fengc@google.com>,
 Alistair Strachan <astrachan@google.com>, Liam Mark <lmark@codeaurora.org>,
 Christoph Hellwig <hch@infradead.org>, dri-devel@lists.freedesktop.org,
 "Andrew F . Davis" <afd@ti.com>, Hridya Valsaraju <hridya@google.com>,
 Pratik Patel <pratikp@codeaurora.org>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBwYXRjaCBhZGRzIHN5c3RlbSBoZWFwIHRvIHRoZSBkbWEtYnVmIGhlYXBzIGZyYW1ld29y
ay4KClRoaXMgYWxsb3dzIGFwcGxpY2F0aW9ucyB0byBnZXQgYSBwYWdlLWFsbG9jYXRvciBiYWNr
ZWQgZG1hLWJ1Zgpmb3Igbm9uLWNvbnRpZ3VvdXMgbWVtb3J5LgoKVGhpcyBjb2RlIGlzIGFuIGV2
b2x1dGlvbiBvZiB0aGUgQW5kcm9pZCBJT04gaW1wbGVtZW50YXRpb24sIHNvCnRoYW5rcyB0byBp
dHMgb3JpZ2luYWwgYXV0aG9ycyBhbmQgbWFpbnRhaW50ZXJzOgogIFJlYmVjY2EgU2NodWx0eiBa
YXZpbiwgQ29saW4gQ3Jvc3MsIExhdXJhIEFiYm90dCwgYW5kIG90aGVycyEKCkNjOiBMYXVyYSBB
YmJvdHQgPGxhYmJvdHRAcmVkaGF0LmNvbT4KQ2M6IEJlbmphbWluIEdhaWduYXJkIDxiZW5qYW1p
bi5nYWlnbmFyZEBsaW5hcm8ub3JnPgpDYzogU3VtaXQgU2Vtd2FsIDxzdW1pdC5zZW13YWxAbGlu
YXJvLm9yZz4KQ2M6IExpYW0gTWFyayA8bG1hcmtAY29kZWF1cm9yYS5vcmc+CkNjOiBQcmF0aWsg
UGF0ZWwgPHByYXRpa3BAY29kZWF1cm9yYS5vcmc+CkNjOiBCcmlhbiBTdGFya2V5IDxCcmlhbi5T
dGFya2V5QGFybS5jb20+CkNjOiBWaW5jZW50IERvbm5lZm9ydCA8VmluY2VudC5Eb25uZWZvcnRA
YXJtLmNvbT4KQ2M6IFN1ZGlwdG8gUGF1bCA8U3VkaXB0by5QYXVsQGFybS5jb20+CkNjOiBBbmRy
ZXcgRi4gRGF2aXMgPGFmZEB0aS5jb20+CkNjOiBDaHJpc3RvcGggSGVsbHdpZyA8aGNoQGluZnJh
ZGVhZC5vcmc+CkNjOiBDaGVuYm8gRmVuZyA8ZmVuZ2NAZ29vZ2xlLmNvbT4KQ2M6IEFsaXN0YWly
IFN0cmFjaGFuIDxhc3RyYWNoYW5AZ29vZ2xlLmNvbT4KQ2M6IEhyaWR5YSBWYWxzYXJhanUgPGhy
aWR5YUBnb29nbGUuY29tPgpDYzogU2FuZGVlcCBQYXRpbCA8c3NwYXRpbEBnb29nbGUuY29tPgpD
YzogSGlsbGYgRGFudG9uIDxoZGFudG9uQHNpbmEuY29tPgpDYzogRGF2ZSBBaXJsaWUgPGFpcmxp
ZWRAZ21haWwuY29tPgpDYzogZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpSZXZpZXdl
ZC1ieTogQmVuamFtaW4gR2FpZ25hcmQgPGJlbmphbWluLmdhaWduYXJkQGxpbmFyby5vcmc+ClJl
dmlld2VkLWJ5OiBCcmlhbiBTdGFya2V5IDxicmlhbi5zdGFya2V5QGFybS5jb20+CkFja2VkLWJ5
OiBMYXVyYSBBYmJvdHQgPGxhYmJvdHRAcmVkaGF0LmNvbT4KVGVzdGVkLWJ5OiBBeWFuIEt1bWFy
IEhhbGRlciA8YXlhbi5oYWxkZXJAYXJtLmNvbT4KU2lnbmVkLW9mZi1ieTogSm9obiBTdHVsdHog
PGpvaG4uc3R1bHR6QGxpbmFyby5vcmc+Ci0tLQp2MjoKKiBTd2l0Y2ggYWxsb2NhdGUgdG8gcmV0
dXJuIGRtYWJ1ZiBmZAoqIFNpbXBsaWZ5IGluaXQgY29kZQoqIENoZWNrcGF0Y2ggZml4dXBzCiog
RHJvcGVkIGRlYWQgc3lzdGVtLWNvbnRpZyBjb2RlCnYzOgoqIFdoaXRlc3BhY2UgZml4dXBzIGZy
b20gQmVuamFtaW4KKiBNYWtlIHN1cmUgd2UncmUgemVyb2luZyB0aGUgYWxsb2NhdGVkIHBhZ2Vz
IChmcm9tIExpYW0pCiogVXNlIFBBR0VfQUxJR04oKSBjb25zaXN0ZW50bHkgKHN1Z2dlc3RlZCBi
eSBCcmlhbikKKiBGb2xkIGluIG5ldyByZWdpc3RyYXRpb24gc3R5bGUgZnJvbSBBbmRyZXcKKiBB
dm9pZCBuZWVkbGVzcyBkeW5hbWljIGFsbG9jYXRpb24gb2Ygc3lzX2hlYXAgKHN1Z2dlc3RlZCBi
eQogIENocmlzdG9waCkKKiBNaW5vciBjbGVhbnVwcwoqIEZvbGRlZCBpbiBjaGFuZ2VzIGZyb20g
QW5kcmV3IHRvIHVzZSBzaW1wbGlmaWVkIHBhZ2UgbGlzdAogIGZyb20gdGhlIGhlYXAgaGVscGVy
cwp2NDoKKiBPcHRpbWl6YXRpb24gdG8gYWxsb2NhdGUgcGFnZXMgaW4gY2h1bmtzLCBzaW1pbGFy
IHRvIG9sZAogIHBhZ2Vwb29sIGNvZGUKKiBVc2UgZmRfZmxhZ3Mgd2hlbiBjcmVhdGluZyBkbWFi
dWYgZmQgKFN1Z2dlc3RlZCBieSBCZW5qYW1pbikKdjU6CiogQmFjayBvdXQgbGFyZ2Ugb3JkZXIg
cGFnZSBhbGxvY2F0aW9ucyAod2FzIGxlYWtpbmcgbWVtb3J5LAogIGFzIHRoZSBwYWdlIGFycmF5
IGRpZG4ndCBwcm9wZXJseSB0cmFjayBvcmRlciBzaXplKQp2NjoKKiBNaW5vciB3aGl0ZXNwYWNl
IGNoYW5nZSBzdWdnZXN0ZWQgYnkgQnJpYW4KKiBSZW1vdmUgdW51c2VkIHZhcmlhYmxlCnY3Ogoq
IFVzZSBuZXdseSBsb3dlci1jYXNlZCBpbml0X2hlYXBfaGVscGVyX2J1ZmZlciBoZWxwZXIKKiBB
ZGQgc3lzdGVtIGhlYXAgRE9TIGF2b2lkYW5jZSBzdWdnZXN0ZWQgYnkgTGF1cmEgZnJvbSBJT04g
Y29kZQoqIFVzZSBuZXcgZG1hYnVmIGV4cG9ydCBoZWxwZXIKdjg6CiogTWFrZSBzdHJ1Y3QgZG1h
X2hlYXBfb3BzIGNvbnN0cyAoc3VnZ2VzdGVkIGJ5IENocmlzdG9waCkKKiBHZXQgcmlkIG9mIG5l
ZWRsZXNzIHN0cnVjdCBzeXN0ZW1faGVhcCAoc3VnZ2VzdGVkIGJ5IENocmlzdG9waCkKKiBDb25k
ZW5zZSBkbWFfaGVhcF9idWZmZXIgYW5kIGhlYXBfaGVscGVyX2J1ZmZlciAoc3VnZ2VzdGVkIGJ5
CiAgQ2hyaXN0b3BoKQoqIEFkZCBmb3Jnb3R0ZW4gaW5jbHVkZSBmaWxlIHRvIGZpeCBidWlsZCBp
c3N1ZSBvbiB4ODYKdjEyOgoqIE1pbm9yIHR3ZWFrcyB0byBwcmVwIGxvYWRpbmcgaGVhcCBmcm9t
IG1vZHVsZQp2MTQ6CiogRml4ICJyZWR1bmRhbnQgYXNzaWdubWVudCB0byB2YXJpYWJsZSByZXQi
IGlzc3VlIHJlcG9ydGVkCiAgYnkgQ29saW4gS2luZyBhbmQgZml4ZWQgYnkgQW5kcmV3IERhdmlz
Ci0tLQogZHJpdmVycy9kbWEtYnVmL0tjb25maWcgICAgICAgICAgICAgfCAgIDIgKwogZHJpdmVy
cy9kbWEtYnVmL2hlYXBzL0tjb25maWcgICAgICAgfCAgIDYgKysKIGRyaXZlcnMvZG1hLWJ1Zi9o
ZWFwcy9NYWtlZmlsZSAgICAgIHwgICAxICsKIGRyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9zeXN0ZW1f
aGVhcC5jIHwgMTI0ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysKIDQgZmlsZXMgY2hhbmdl
ZCwgMTMzIGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2RtYS1idWYv
aGVhcHMvS2NvbmZpZwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9z
eXN0ZW1faGVhcC5jCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9kbWEtYnVmL0tjb25maWcgYi9kcml2
ZXJzL2RtYS1idWYvS2NvbmZpZwppbmRleCBiZmZhNThmYzNlNmUuLjA2MTNiYjc3NzBmNSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9kbWEtYnVmL0tjb25maWcKKysrIGIvZHJpdmVycy9kbWEtYnVmL0tj
b25maWcKQEAgLTUzLDQgKzUzLDYgQEAgbWVudWNvbmZpZyBETUFCVUZfSEVBUFMKIAkgIGFsbG93
cyB1c2Vyc3BhY2UgdG8gYWxsb2NhdGUgZG1hLWJ1ZnMgdGhhdCBjYW4gYmUgc2hhcmVkCiAJICBi
ZXR3ZWVuIGRyaXZlcnMuCiAKK3NvdXJjZSAiZHJpdmVycy9kbWEtYnVmL2hlYXBzL0tjb25maWci
CisKIGVuZG1lbnUKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9LY29uZmlnIGIv
ZHJpdmVycy9kbWEtYnVmL2hlYXBzL0tjb25maWcKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXgg
MDAwMDAwMDAwMDAwLi4yMDUwNTI3NDQxNjkKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2Rt
YS1idWYvaGVhcHMvS2NvbmZpZwpAQCAtMCwwICsxLDYgQEAKK2NvbmZpZyBETUFCVUZfSEVBUFNf
U1lTVEVNCisJYm9vbCAiRE1BLUJVRiBTeXN0ZW0gSGVhcCIKKwlkZXBlbmRzIG9uIERNQUJVRl9I
RUFQUworCWhlbHAKKwkgIENob29zZSB0aGlzIG9wdGlvbiB0byBlbmFibGUgdGhlIHN5c3RlbSBk
bWFidWYgaGVhcC4gVGhlIHN5c3RlbSBoZWFwCisJICBpcyBiYWNrZWQgYnkgcGFnZXMgZnJvbSB0
aGUgYnVkZHkgYWxsb2NhdG9yLiBJZiBpbiBkb3VidCwgc2F5IFkuCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2RtYS1idWYvaGVhcHMvTWFrZWZpbGUgYi9kcml2ZXJzL2RtYS1idWYvaGVhcHMvTWFrZWZp
bGUKaW5kZXggZGU0OTg5ODExMmRiLi5kMTgwOGVjYTI1ODEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
ZG1hLWJ1Zi9oZWFwcy9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2RtYS1idWYvaGVhcHMvTWFrZWZp
bGUKQEAgLTEsMiArMSwzIEBACiAjIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCiBv
YmoteQkJCQkJKz0gaGVhcC1oZWxwZXJzLm8KK29iai0kKENPTkZJR19ETUFCVUZfSEVBUFNfU1lT
VEVNKQkrPSBzeXN0ZW1faGVhcC5vCmRpZmYgLS1naXQgYS9kcml2ZXJzL2RtYS1idWYvaGVhcHMv
c3lzdGVtX2hlYXAuYyBiL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9zeXN0ZW1faGVhcC5jCm5ldyBm
aWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uOWE1NjM5M2U0MGI0Ci0tLSAvZGV2
L251bGwKKysrIGIvZHJpdmVycy9kbWEtYnVmL2hlYXBzL3N5c3RlbV9oZWFwLmMKQEAgLTAsMCAr
MSwxMjQgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisvKgorICogRE1B
QlVGIFN5c3RlbSBoZWFwIGV4cG9ydGVyCisgKgorICogQ29weXJpZ2h0IChDKSAyMDExIEdvb2ds
ZSwgSW5jLgorICogQ29weXJpZ2h0IChDKSAyMDE5IExpbmFybyBMdGQuCisgKi8KKworI2luY2x1
ZGUgPGxpbnV4L2RtYS1idWYuaD4KKyNpbmNsdWRlIDxsaW51eC9kbWEtbWFwcGluZy5oPgorI2lu
Y2x1ZGUgPGxpbnV4L2RtYS1oZWFwLmg+CisjaW5jbHVkZSA8bGludXgvZXJyLmg+CisjaW5jbHVk
ZSA8bGludXgvaGlnaG1lbS5oPgorI2luY2x1ZGUgPGxpbnV4L21tLmg+CisjaW5jbHVkZSA8bGlu
dXgvbW9kdWxlLmg+CisjaW5jbHVkZSA8bGludXgvc2NhdHRlcmxpc3QuaD4KKyNpbmNsdWRlIDxs
aW51eC9zbGFiLmg+CisjaW5jbHVkZSA8bGludXgvc2NoZWQvc2lnbmFsLmg+CisjaW5jbHVkZSA8
YXNtL3BhZ2UuaD4KKworI2luY2x1ZGUgImhlYXAtaGVscGVycy5oIgorCitzdHJ1Y3QgZG1hX2hl
YXAgKnN5c19oZWFwOworCitzdGF0aWMgdm9pZCBzeXN0ZW1faGVhcF9mcmVlKHN0cnVjdCBoZWFw
X2hlbHBlcl9idWZmZXIgKmJ1ZmZlcikKK3sKKwlwZ29mZl90IHBnOworCisJZm9yIChwZyA9IDA7
IHBnIDwgYnVmZmVyLT5wYWdlY291bnQ7IHBnKyspCisJCV9fZnJlZV9wYWdlKGJ1ZmZlci0+cGFn
ZXNbcGddKTsKKwlrZnJlZShidWZmZXItPnBhZ2VzKTsKKwlrZnJlZShidWZmZXIpOworfQorCitz
dGF0aWMgaW50IHN5c3RlbV9oZWFwX2FsbG9jYXRlKHN0cnVjdCBkbWFfaGVhcCAqaGVhcCwKKwkJ
CQl1bnNpZ25lZCBsb25nIGxlbiwKKwkJCQl1bnNpZ25lZCBsb25nIGZkX2ZsYWdzLAorCQkJCXVu
c2lnbmVkIGxvbmcgaGVhcF9mbGFncykKK3sKKwlzdHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICpo
ZWxwZXJfYnVmZmVyOworCXN0cnVjdCBkbWFfYnVmICpkbWFidWY7CisJaW50IHJldCA9IC1FTk9N
RU07CisJcGdvZmZfdCBwZzsKKworCWhlbHBlcl9idWZmZXIgPSBremFsbG9jKHNpemVvZigqaGVs
cGVyX2J1ZmZlciksIEdGUF9LRVJORUwpOworCWlmICghaGVscGVyX2J1ZmZlcikKKwkJcmV0dXJu
IC1FTk9NRU07CisKKwlpbml0X2hlYXBfaGVscGVyX2J1ZmZlcihoZWxwZXJfYnVmZmVyLCBzeXN0
ZW1faGVhcF9mcmVlKTsKKwloZWxwZXJfYnVmZmVyLT5mbGFncyA9IGhlYXBfZmxhZ3M7CisJaGVs
cGVyX2J1ZmZlci0+aGVhcCA9IGhlYXA7CisJaGVscGVyX2J1ZmZlci0+c2l6ZSA9IGxlbjsKKwor
CWhlbHBlcl9idWZmZXItPnBhZ2Vjb3VudCA9IGxlbiAvIFBBR0VfU0laRTsKKwloZWxwZXJfYnVm
ZmVyLT5wYWdlcyA9IGttYWxsb2NfYXJyYXkoaGVscGVyX2J1ZmZlci0+cGFnZWNvdW50LAorCQkJ
CQkgICAgIHNpemVvZigqaGVscGVyX2J1ZmZlci0+cGFnZXMpLAorCQkJCQkgICAgIEdGUF9LRVJO
RUwpOworCWlmICghaGVscGVyX2J1ZmZlci0+cGFnZXMpIHsKKwkJcmV0ID0gLUVOT01FTTsKKwkJ
Z290byBlcnIwOworCX0KKworCWZvciAocGcgPSAwOyBwZyA8IGhlbHBlcl9idWZmZXItPnBhZ2Vj
b3VudDsgcGcrKykgeworCQkvKgorCQkgKiBBdm9pZCB0cnlpbmcgdG8gYWxsb2NhdGUgbWVtb3J5
IGlmIHRoZSBwcm9jZXNzCisJCSAqIGhhcyBiZWVuIGtpbGxlZCBieSBieSBTSUdLSUxMCisJCSAq
LworCQlpZiAoZmF0YWxfc2lnbmFsX3BlbmRpbmcoY3VycmVudCkpCisJCQlnb3RvIGVycjE7CisK
KwkJaGVscGVyX2J1ZmZlci0+cGFnZXNbcGddID0gYWxsb2NfcGFnZShHRlBfS0VSTkVMIHwgX19H
RlBfWkVSTyk7CisJCWlmICghaGVscGVyX2J1ZmZlci0+cGFnZXNbcGddKQorCQkJZ290byBlcnIx
OworCX0KKworCS8qIGNyZWF0ZSB0aGUgZG1hYnVmICovCisJZG1hYnVmID0gaGVhcF9oZWxwZXJf
ZXhwb3J0X2RtYWJ1ZihoZWxwZXJfYnVmZmVyLCBmZF9mbGFncyk7CisJaWYgKElTX0VSUihkbWFi
dWYpKSB7CisJCXJldCA9IFBUUl9FUlIoZG1hYnVmKTsKKwkJZ290byBlcnIxOworCX0KKworCWhl
bHBlcl9idWZmZXItPmRtYWJ1ZiA9IGRtYWJ1ZjsKKworCXJldCA9IGRtYV9idWZfZmQoZG1hYnVm
LCBmZF9mbGFncyk7CisJaWYgKHJldCA8IDApIHsKKwkJZG1hX2J1Zl9wdXQoZG1hYnVmKTsKKwkJ
LyoganVzdCByZXR1cm4sIGFzIHB1dCB3aWxsIGNhbGwgcmVsZWFzZSBhbmQgdGhhdCB3aWxsIGZy
ZWUgKi8KKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXR1cm4gcmV0OworCitlcnIxOgorCXdoaWxl
IChwZyA+IDApCisJCV9fZnJlZV9wYWdlKGhlbHBlcl9idWZmZXItPnBhZ2VzWy0tcGddKTsKKwlr
ZnJlZShoZWxwZXJfYnVmZmVyLT5wYWdlcyk7CitlcnIwOgorCWtmcmVlKGhlbHBlcl9idWZmZXIp
OworCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBkbWFfaGVhcF9vcHMg
c3lzdGVtX2hlYXBfb3BzID0geworCS5hbGxvY2F0ZSA9IHN5c3RlbV9oZWFwX2FsbG9jYXRlLAor
fTsKKworc3RhdGljIGludCBzeXN0ZW1faGVhcF9jcmVhdGUodm9pZCkKK3sKKwlzdHJ1Y3QgZG1h
X2hlYXBfZXhwb3J0X2luZm8gZXhwX2luZm87CisJaW50IHJldCA9IDA7CisKKwlleHBfaW5mby5u
YW1lID0gInN5c3RlbV9oZWFwIjsKKwlleHBfaW5mby5vcHMgPSAmc3lzdGVtX2hlYXBfb3BzOwor
CWV4cF9pbmZvLnByaXYgPSBOVUxMOworCisJc3lzX2hlYXAgPSBkbWFfaGVhcF9hZGQoJmV4cF9p
bmZvKTsKKwlpZiAoSVNfRVJSKHN5c19oZWFwKSkKKwkJcmV0ID0gUFRSX0VSUihzeXNfaGVhcCk7
CisKKwlyZXR1cm4gcmV0OworfQorbW9kdWxlX2luaXQoc3lzdGVtX2hlYXBfY3JlYXRlKTsKK01P
RFVMRV9MSUNFTlNFKCJHUEwgdjIiKTsKLS0gCjIuMTcuMQoKX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2
ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21h
aWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
