Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 2E2B665340
	for <lists+dri-devel@lfdr.de>; Thu, 11 Jul 2019 10:34:49 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F29C66E07F;
	Thu, 11 Jul 2019 08:34:46 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x544.google.com (mail-ed1-x544.google.com
 [IPv6:2a00:1450:4864:20::544])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A67166E07F
 for <dri-devel@lists.freedesktop.org>; Thu, 11 Jul 2019 08:34:45 +0000 (UTC)
Received: by mail-ed1-x544.google.com with SMTP id p15so4916925eds.8
 for <dri-devel@lists.freedesktop.org>; Thu, 11 Jul 2019 01:34:45 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:sender:date:from:to:cc:subject:message-id
 :mail-followup-to:references:mime-version:content-disposition
 :in-reply-to:user-agent;
 bh=CsHw28pKgN+na8MsfU5qTAb99IUST4U40dznTgxiPFI=;
 b=ZHZoxa+dtmvLHDygk9eCyqExoxqs2Mm/Vp2+0dk8M6aZWJmnY0d3TOqk0bUc7GDjw8
 x3t+7gS1QQsbgGesVPuat4jqiSnl9VvZdHGJHVkgNaE4nR8hhMbrwzw9G+yrRg6dPfib
 YGCxOnSfDECEzZ9APKytqqOAP9bZn+hMonMtK/x4jjhIy8lOM1RVjFoXEVohxuiQ2bgo
 MoQc6tCKtnQDPAaUeV8i01gOU2XjhxPOmM8OxxlF9BlqsiYBn/IhRbJ6XiAQGAkJhXc/
 dmNNkrbeFf2xPFR32otWpRRjaTpY0uAUozjHuEJNimm5s4ylkLZSNtwROvw7YekjkhN0
 AMNQ==
X-Gm-Message-State: APjAAAXxxMTKcGUkwcPNMyAStVUddBrf5tP9WxBuhVpD8pkPAQGQtIXE
 NQiSJJXobg4kCKtzN3v4OB6d5yMc
X-Google-Smtp-Source: APXvYqzV1asblfhenexP+5NuH0bzB0A6r1RZq1UlvbE7k0NvTT47IiMWBygNa6b3vciwdHXO9bumYw==
X-Received: by 2002:a50:941c:: with SMTP id p28mr2266855eda.103.1562834084222; 
 Thu, 11 Jul 2019 01:34:44 -0700 (PDT)
Received: from phenom.ffwll.local ([2a02:168:569e:0:3106:d637:d723:e855])
 by smtp.gmail.com with ESMTPSA id rv16sm1014202ejb.79.2019.07.11.01.34.43
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Thu, 11 Jul 2019 01:34:43 -0700 (PDT)
Date: Thu, 11 Jul 2019 10:34:41 +0200
From: Daniel Vetter <daniel@ffwll.ch>
To: Rodrigo Siqueira <rodrigosiqueiramelo@gmail.com>
Subject: Re: [PATCH V3 5/5] drm/vkms: Add support for writeback
Message-ID: <20190711083441.GJ15868@phenom.ffwll.local>
Mail-Followup-To: Rodrigo Siqueira <rodrigosiqueiramelo@gmail.com>,
 Brian Starkey <brian.starkey@arm.com>,
 Liviu Dudau <liviu.dudau@arm.com>,
 Haneen Mohammed <hamohammed.sa@gmail.com>,
 Simon Ser <contact@emersion.fr>, dri-devel@lists.freedesktop.org,
 linux-kernel@vger.kernel.org
References: <cover.1561491964.git.rodrigosiqueiramelo@gmail.com>
 <917fda9b620cd84a0826d2d5a59bff9ea07bfde2.1561491964.git.rodrigosiqueiramelo@gmail.com>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <917fda9b620cd84a0826d2d5a59bff9ea07bfde2.1561491964.git.rodrigosiqueiramelo@gmail.com>
X-Operating-System: Linux phenom 4.19.0-5-amd64 
User-Agent: Mutt/1.10.1 (2018-07-13)
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ffwll.ch; s=google;
 h=sender:date:from:to:cc:subject:message-id:mail-followup-to
 :references:mime-version:content-disposition:in-reply-to:user-agent;
 bh=CsHw28pKgN+na8MsfU5qTAb99IUST4U40dznTgxiPFI=;
 b=baJN3gmHffVGzGA5zNavCv2NKnmscYpdh9/R3+Uzq5y6bRTFrW8DcvsfYcroDi2zY9
 1gJtHI4Hz2FjYy2zGqiiG3krVh5QbQe6r/RNcqd+IEoXvPnbD25LbD/hXxajGKMyjccZ
 hqfDfIuxn1wLeh46NNl2XtJJQE2/g77uqqnnY=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Haneen Mohammed <hamohammed.sa@gmail.com>, Simon Ser <contact@emersion.fr>,
 Liviu Dudau <liviu.dudau@arm.com>, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gVHVlLCBKdW4gMjUsIDIwMTkgYXQgMTA6Mzk6MDNQTSAtMDMwMCwgUm9kcmlnbyBTaXF1ZWly
YSB3cm90ZToKPiBUaGlzIHBhdGNoIGltcGxlbWVudHMgdGhlIG5lY2Vzc2FyeSBmdW5jdGlvbnMg
dG8gYWRkIHdyaXRlYmFjayBzdXBwb3J0Cj4gZm9yIHZrbXMuIFRoaXMgZmVhdHVyZSBpcyB1c2Vm
dWwgZm9yIHRlc3RpbmcgY29tcG9zaXRvcnMgaWYgeW91IGRvbid0Cj4gaGF2ZSBoYXJkd2FyZSB3
aXRoIHdyaXRlYmFjayBzdXBwb3J0Lgo+IAo+IENoYW5nZSBpbiBWMyAoRGFuaWVsKToKPiAtIElm
IHdyaXRlYmFjayBpcyBlbmFibGVkLCBjb21wb3NlIGV2ZXJ5dGhpbmcgaW50byB0aGUgd3JpdGVi
YWNrIGJ1ZmZlcgo+IGluc3RlYWQgb2YgQ1JDIHByaXZhdGUgYnVmZmVyLgo+IC0gR3VhcmFudGVl
cyB0aGF0IHRoZSBDUkMgd2lsbCBtYXRjaCBleGFjdGx5IHdoYXQgd2UgaGF2ZSBpbiB0aGUKPiB3
cml0ZWJhY2sgYnVmZmVyLgo+IAo+IENoYW5nZSBpbiBWMjoKPiAtIFJld29yayBzaWduYWwgY29t
cGxldGlvbiAoQnJpYW4pCj4gLSBJbnRlZ3JhdGVzIHdyaXRlYmFjayB3aXRoIGFjdGl2ZV9wbGFu
ZXMgKERhbmllbCkKPiAtIENvbXBvc2UgY3Vyc29yIChEYW5pZWwpCj4gCj4gU2lnbmVkLW9mZi1i
eTogUm9kcmlnbyBTaXF1ZWlyYSA8cm9kcmlnb3NpcXVlaXJhbWVsb0BnbWFpbC5jb20+Cj4gLS0t
Cj4gIGRyaXZlcnMvZ3B1L2RybS92a21zL01ha2VmaWxlICAgICAgICAgfCAgIDkgKy0KPiAgZHJp
dmVycy9ncHUvZHJtL3ZrbXMvdmttc19jb21wb3Nlci5jICB8ICAxNiArKy0KPiAgZHJpdmVycy9n
cHUvZHJtL3ZrbXMvdmttc19kcnYuYyAgICAgICB8ICAgNCArCj4gIGRyaXZlcnMvZ3B1L2RybS92
a21zL3ZrbXNfZHJ2LmggICAgICAgfCAgIDggKysKPiAgZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmtt
c19vdXRwdXQuYyAgICB8ICAxMCArKwo+ICBkcml2ZXJzL2dwdS9kcm0vdmttcy92a21zX3dyaXRl
YmFjay5jIHwgMTQxICsrKysrKysrKysrKysrKysrKysrKysrKysrCj4gIDYgZmlsZXMgY2hhbmdl
ZCwgMTg1IGluc2VydGlvbnMoKyksIDMgZGVsZXRpb25zKC0pCj4gIGNyZWF0ZSBtb2RlIDEwMDY0
NCBkcml2ZXJzL2dwdS9kcm0vdmttcy92a21zX3dyaXRlYmFjay5jCj4gCj4gZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS92a21zL01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL3ZrbXMvTWFr
ZWZpbGUKPiBpbmRleCAwYjc2N2Q3ZWZhMjQuLjMzM2QzY2VhZDBlMyAxMDA2NDQKPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vdmttcy9NYWtlZmlsZQo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS92a21z
L01ha2VmaWxlCj4gQEAgLTEsNCArMSwxMSBAQAo+ICAjIFNQRFgtTGljZW5zZS1JZGVudGlmaWVy
OiBHUEwtMi4wLW9ubHkKPiAtdmttcy15IDo9IHZrbXNfZHJ2Lm8gdmttc19wbGFuZS5vIHZrbXNf
b3V0cHV0Lm8gdmttc19jcnRjLm8gdmttc19nZW0ubyB2a21zX2NvbXBvc2VyLm8KPiArdmttcy15
IDo9IFwKPiArCXZrbXNfZHJ2Lm8gXAo+ICsJdmttc19wbGFuZS5vIFwKPiArCXZrbXNfb3V0cHV0
Lm8gXAo+ICsJdmttc19jcnRjLm8gXAo+ICsJdmttc19nZW0ubyBcCj4gKwl2a21zX2NvbXBvc2Vy
Lm8gXAo+ICsJdmttc193cml0ZWJhY2subwo+ICAKPiAgb2JqLSQoQ09ORklHX0RSTV9WS01TKSAr
PSB2a21zLm8KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19jb21wb3Nl
ci5jIGIvZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19jb21wb3Nlci5jCj4gaW5kZXggODEyNmFh
MGY5NjhmLi4yMzE3ODAzZTczMjAgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL3ZrbXMv
dmttc19jb21wb3Nlci5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19jb21wb3Nl
ci5jCj4gQEAgLTE1NywxNiArMTU3LDE3IEBAIHZvaWQgdmttc19jb21wb3Nlcl93b3JrZXIoc3Ry
dWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAJc3RydWN0IHZrbXNfb3V0cHV0ICpvdXQgPSBkcm1f
Y3J0Y190b192a21zX291dHB1dChjcnRjKTsKPiAgCXN0cnVjdCB2a21zX2NvbXBvc2VyICpwcmlt
YXJ5X2NvbXBvc2VyID0gTlVMTDsKPiAgCXN0cnVjdCB2a21zX2NvbXBvc2VyICpjdXJzb3JfY29t
cG9zZXIgPSBOVUxMOwo+ICsJYm9vbCBjcmNfcGVuZGluZywgd2JfcGVuZGluZzsKCkknbSBub3Qg
c2VlaW5nIGhvdyB5b3Ugc2NoZWR1bGUgdGhpcyB3b3JrIGZvciB3cml0ZWJhY2sgaWYgdGhlcmUn
cyBubyBjcmMKZW5hYmxlZC4gRG9lcyB0aGF0IHdvcms/Cj4gIAl2b2lkICp2YWRkcl9vdXQgPSBO
VUxMOwo+ICAJdTMyIGNyYzMyID0gMDsKPiAgCXU2NCBmcmFtZV9zdGFydCwgZnJhbWVfZW5kOwo+
IC0JYm9vbCBjcmNfcGVuZGluZzsKPiAgCWludCByZXQ7Cj4gIAo+ICAJc3Bpbl9sb2NrX2lycSgm
b3V0LT5jb21wb3Nlcl9sb2NrKTsKPiAgCWZyYW1lX3N0YXJ0ID0gY3J0Y19zdGF0ZS0+ZnJhbWVf
c3RhcnQ7Cj4gIAlmcmFtZV9lbmQgPSBjcnRjX3N0YXRlLT5mcmFtZV9lbmQ7Cj4gIAljcmNfcGVu
ZGluZyA9IGNydGNfc3RhdGUtPmNyY19wZW5kaW5nOwo+ICsJd2JfcGVuZGluZyA9IGNydGNfc3Rh
dGUtPndiX3BlbmRpbmc7Cj4gIAljcnRjX3N0YXRlLT5mcmFtZV9zdGFydCA9IDA7Cj4gIAljcnRj
X3N0YXRlLT5mcmFtZV9lbmQgPSAwOwo+ICAJY3J0Y19zdGF0ZS0+Y3JjX3BlbmRpbmcgPSBmYWxz
ZTsKPiBAQCAtMTg4LDkgKzE4OSwxMiBAQCB2b2lkIHZrbXNfY29tcG9zZXJfd29ya2VyKHN0cnVj
dCB3b3JrX3N0cnVjdCAqd29yaykKPiAgCWlmICghcHJpbWFyeV9jb21wb3NlcikKPiAgCQlyZXR1
cm47Cj4gIAo+ICsJaWYgKHdiX3BlbmRpbmcpCj4gKwkJdmFkZHJfb3V0ID0gY3J0Y19zdGF0ZS0+
YWN0aXZlX3dyaXRlYmFjazsKPiArCj4gIAlyZXQgPSBjb21wb3NlX3BsYW5lcygmdmFkZHJfb3V0
LCBwcmltYXJ5X2NvbXBvc2VyLCBjdXJzb3JfY29tcG9zZXIpOwo+ICAJaWYgKHJldCkgewo+IC0J
CWlmIChyZXQgPT0gLUVJTlZBTCkKPiArCQlpZiAocmV0ID09IC1FSU5WQUwgJiYgIXdiX3BlbmRp
bmcpCj4gIAkJCWtmcmVlKHZhZGRyX291dCk7Cj4gIAkJcmV0dXJuOwo+ICAJfQo+IEBAIC0yMDMs
NiArMjA3LDE0IEBAIHZvaWQgdmttc19jb21wb3Nlcl93b3JrZXIoc3RydWN0IHdvcmtfc3RydWN0
ICp3b3JrKQo+ICAJd2hpbGUgKGZyYW1lX3N0YXJ0IDw9IGZyYW1lX2VuZCkKPiAgCQlkcm1fY3J0
Y19hZGRfY3JjX2VudHJ5KGNydGMsIHRydWUsIGZyYW1lX3N0YXJ0KyssICZjcmMzMik7Cj4gIAo+
ICsJaWYgKHdiX3BlbmRpbmcpIHsKPiArCQlkcm1fd3JpdGViYWNrX3NpZ25hbF9jb21wbGV0aW9u
KCZvdXQtPndiX2Nvbm5lY3RvciwgMCk7Cj4gKwkJc3Bpbl9sb2NrX2lycSgmb3V0LT5jb21wb3Nl
cl9sb2NrKTsKPiArCQljcnRjX3N0YXRlLT53Yl9wZW5kaW5nID0gZmFsc2U7Cj4gKwkJc3Bpbl91
bmxvY2tfaXJxKCZvdXQtPmNvbXBvc2VyX2xvY2spOwo+ICsJCXJldHVybjsKPiArCX0KPiArCj4g
IAlrZnJlZSh2YWRkcl9vdXQpOwo+ICB9Cj4gIAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vdmttcy92a21zX2Rydi5jIGIvZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19kcnYuYwo+IGlu
ZGV4IGFjNzkwYjY1MjdlNC4uMTUyZDdkZTI0YTc2IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS92a21zL3ZrbXNfZHJ2LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vdmttcy92a21zX2Ry
di5jCj4gQEAgLTMwLDYgKzMwLDEwIEBAIGJvb2wgZW5hYmxlX2N1cnNvcjsKPiAgbW9kdWxlX3Bh
cmFtX25hbWVkKGVuYWJsZV9jdXJzb3IsIGVuYWJsZV9jdXJzb3IsIGJvb2wsIDA0NDQpOwo+ICBN
T0RVTEVfUEFSTV9ERVNDKGVuYWJsZV9jdXJzb3IsICJFbmFibGUvRGlzYWJsZSBjdXJzb3Igc3Vw
cG9ydCIpOwo+ICAKPiArYm9vbCBlbmFibGVfd3JpdGViYWNrOwo+ICttb2R1bGVfcGFyYW1fbmFt
ZWQoZW5hYmxlX3dyaXRlYmFjaywgZW5hYmxlX3dyaXRlYmFjaywgYm9vbCwgMDQ0NCk7Cj4gK01P
RFVMRV9QQVJNX0RFU0MoZW5hYmxlX3dyaXRlYmFjaywgIkVuYWJsZS9EaXNhYmxlIHdyaXRlYmFj
ayBjb25uZWN0b3IiKTsKPiArCj4gIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRpb25z
IHZrbXNfZHJpdmVyX2ZvcHMgPSB7Cj4gIAkub3duZXIJCT0gVEhJU19NT0RVTEUsCj4gIAkub3Bl
bgkJPSBkcm1fb3BlbiwKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19k
cnYuaCBiL2RyaXZlcnMvZ3B1L2RybS92a21zL3ZrbXNfZHJ2LmgKPiBpbmRleCBmYzZjZGExNjQz
MzYuLjlmZjJjZDRlYmY4MSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vdmttcy92a21z
X2Rydi5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19kcnYuaAo+IEBAIC03LDYg
KzcsNyBAQAo+ICAjaW5jbHVkZSA8ZHJtL2RybS5oPgo+ICAjaW5jbHVkZSA8ZHJtL2RybV9nZW0u
aD4KPiAgI2luY2x1ZGUgPGRybS9kcm1fZW5jb2Rlci5oPgo+ICsjaW5jbHVkZSA8ZHJtL2RybV93
cml0ZWJhY2suaD4KPiAgI2luY2x1ZGUgPGxpbnV4L2hydGltZXIuaD4KPiAgCj4gICNkZWZpbmUg
WFJFU19NSU4gICAgMjAKPiBAQCAtMTksNiArMjAsNyBAQAo+ICAjZGVmaW5lIFlSRVNfTUFYICA4
MTkyCj4gIAo+ICBleHRlcm4gYm9vbCBlbmFibGVfY3Vyc29yOwo+ICtleHRlcm4gYm9vbCBlbmFi
bGVfd3JpdGViYWNrOwo+ICAKPiAgc3RydWN0IHZrbXNfY29tcG9zZXIgewo+ICAJc3RydWN0IGRy
bV9mcmFtZWJ1ZmZlciBmYjsKPiBAQCAtNTIsOSArNTQsMTEgQEAgc3RydWN0IHZrbXNfY3J0Y19z
dGF0ZSB7Cj4gIAlpbnQgbnVtX2FjdGl2ZV9wbGFuZXM7Cj4gIAkvKiBzdGFjayBvZiBhY3RpdmUg
cGxhbmVzIGZvciBjcmMgY29tcHV0YXRpb24sIHNob3VsZCBiZSBpbiB6IG9yZGVyICovCj4gIAlz
dHJ1Y3Qgdmttc19wbGFuZV9zdGF0ZSAqKmFjdGl2ZV9wbGFuZXM7Cj4gKwl2b2lkICphY3RpdmVf
d3JpdGViYWNrOwo+ICAKPiAgCS8qIGJlbG93IHRocmVlIGFyZSBwcm90ZWN0ZWQgYnkgdmttc19v
dXRwdXQuY29tcG9zZXJfbG9jayAqLwo+ICAJYm9vbCBjcmNfcGVuZGluZzsKPiArCWJvb2wgd2Jf
cGVuZGluZzsKPiAgCXU2NCBmcmFtZV9zdGFydDsKPiAgCXU2NCBmcmFtZV9lbmQ7Cj4gIH07Cj4g
QEAgLTYzLDYgKzY3LDcgQEAgc3RydWN0IHZrbXNfb3V0cHV0IHsKPiAgCXN0cnVjdCBkcm1fY3J0
YyBjcnRjOwo+ICAJc3RydWN0IGRybV9lbmNvZGVyIGVuY29kZXI7Cj4gIAlzdHJ1Y3QgZHJtX2Nv
bm5lY3RvciBjb25uZWN0b3I7Cj4gKwlzdHJ1Y3QgZHJtX3dyaXRlYmFja19jb25uZWN0b3Igd2Jf
Y29ubmVjdG9yOwo+ICAJc3RydWN0IGhydGltZXIgdmJsYW5rX2hydGltZXI7Cj4gIAlrdGltZV90
IHBlcmlvZF9uczsKPiAgCXN0cnVjdCBkcm1fcGVuZGluZ192YmxhbmtfZXZlbnQgKmV2ZW50Owo+
IEBAIC0xNDcsNCArMTUyLDcgQEAgaW50IHZrbXNfdmVyaWZ5X2NyY19zb3VyY2Uoc3RydWN0IGRy
bV9jcnRjICpjcnRjLCBjb25zdCBjaGFyICpzb3VyY2VfbmFtZSwKPiAgLyogQ29tcG9zZXIgU3Vw
cG9ydCAqLwo+ICB2b2lkIHZrbXNfY29tcG9zZXJfd29ya2VyKHN0cnVjdCB3b3JrX3N0cnVjdCAq
d29yayk7Cj4gIAo+ICsvKiBXcml0ZWJhY2sgKi8KPiAraW50IGVuYWJsZV93cml0ZWJhY2tfY29u
bmVjdG9yKHN0cnVjdCB2a21zX2RldmljZSAqdmttc2Rldik7Cj4gKwo+ICAjZW5kaWYgLyogX1ZL
TVNfRFJWX0hfICovCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92a21zL3ZrbXNfb3V0
cHV0LmMgYi9kcml2ZXJzL2dwdS9kcm0vdmttcy92a21zX291dHB1dC5jCj4gaW5kZXggZmIxOTQx
YTY1MjJjLi5hZWExZDQ0MTA4NjQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL3ZrbXMv
dmttc19vdXRwdXQuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS92a21zL3ZrbXNfb3V0cHV0LmMK
PiBAQCAtODQsNiArODQsMTYgQEAgaW50IHZrbXNfb3V0cHV0X2luaXQoc3RydWN0IHZrbXNfZGV2
aWNlICp2a21zZGV2LCBpbnQgaW5kZXgpCj4gIAkJZ290byBlcnJfYXR0YWNoOwo+ICAJfQo+ICAK
PiArCWlmIChlbmFibGVfd3JpdGViYWNrKSB7Cj4gKwkJcmV0ID0gZW5hYmxlX3dyaXRlYmFja19j
b25uZWN0b3Iodmttc2Rldik7Cj4gKwkJaWYgKCFyZXQpIHsKPiArCQkJb3V0cHV0LT5jb21wb3Nl
cl9lbmFibGVkID0gdHJ1ZTsKPiArCQkJRFJNX0lORk8oIldyaXRlYmFjayBjb25uZWN0b3IgZW5h
YmxlZCIpOwo+ICsJCX0gZWxzZSB7Cj4gKwkJCURSTV9FUlJPUigiRmFpbGVkIHRvIGluaXQgd3Jp
dGViYWNrIGNvbm5lY3RvclxuIik7Cj4gKwkJfQo+ICsJfQo+ICsKPiAgCWRybV9tb2RlX2NvbmZp
Z19yZXNldChkZXYpOwo+ICAKPiAgCXJldHVybiAwOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vdmttcy92a21zX3dyaXRlYmFjay5jIGIvZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc193
cml0ZWJhY2suYwo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0Cj4gaW5kZXggMDAwMDAwMDAwMDAwLi4z
NGRhZDM3YTAyMzYKPiAtLS0gL2Rldi9udWxsCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3ZrbXMv
dmttc193cml0ZWJhY2suYwo+IEBAIC0wLDAgKzEsMTQxIEBACj4gKy8vIFNQRFgtTGljZW5zZS1J
ZGVudGlmaWVyOiBHUEwtMi4wKwo+ICsKPiArI2luY2x1ZGUgInZrbXNfZHJ2LmgiCj4gKyNpbmNs
dWRlIDxkcm0vZHJtX3dyaXRlYmFjay5oPgo+ICsjaW5jbHVkZSA8ZHJtL2RybV9wcm9iZV9oZWxw
ZXIuaD4KPiArI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljX2hlbHBlci5oPgo+ICsjaW5jbHVkZSA8
ZHJtL2RybV9nZW1fZnJhbWVidWZmZXJfaGVscGVyLmg+Cj4gKwo+ICtzdGF0aWMgY29uc3QgdTMy
IHZrbXNfd2JfZm9ybWF0c1tdID0gewo+ICsJRFJNX0ZPUk1BVF9YUkdCODg4OCwKPiArfTsKPiAr
Cj4gK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9mdW5jcyB2a21zX3diX2Nvbm5l
Y3Rvcl9mdW5jcyA9IHsKPiArCS5maWxsX21vZGVzID0gZHJtX2hlbHBlcl9wcm9iZV9zaW5nbGVf
Y29ubmVjdG9yX21vZGVzLAo+ICsJLmRlc3Ryb3kgPSBkcm1fY29ubmVjdG9yX2NsZWFudXAsCj4g
KwkucmVzZXQgPSBkcm1fYXRvbWljX2hlbHBlcl9jb25uZWN0b3JfcmVzZXQsCj4gKwkuYXRvbWlj
X2R1cGxpY2F0ZV9zdGF0ZSA9IGRybV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9kdXBsaWNhdGVf
c3RhdGUsCj4gKwkuYXRvbWljX2Rlc3Ryb3lfc3RhdGUgPSBkcm1fYXRvbWljX2hlbHBlcl9jb25u
ZWN0b3JfZGVzdHJveV9zdGF0ZSwKPiArfTsKPiArCj4gK3N0YXRpYyBpbnQgdmttc193Yl9lbmNv
ZGVyX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIsCj4gKwkJCQkJc3Ry
dWN0IGRybV9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICsJCQkJCXN0cnVjdCBkcm1fY29ubmVj
dG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ICt7Cj4gKwlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpm
YjsKPiArCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlID0gJmNydGNfc3RhdGUt
Pm1vZGU7Cj4gKwo+ICsJaWYgKCFjb25uX3N0YXRlLT53cml0ZWJhY2tfam9iIHx8ICFjb25uX3N0
YXRlLT53cml0ZWJhY2tfam9iLT5mYikKPiArCQlyZXR1cm4gMDsKPiArCj4gKwlmYiA9IGNvbm5f
c3RhdGUtPndyaXRlYmFja19qb2ItPmZiOwo+ICsJaWYgKGZiLT53aWR0aCAhPSBtb2RlLT5oZGlz
cGxheSB8fCBmYi0+aGVpZ2h0ICE9IG1vZGUtPnZkaXNwbGF5KSB7Cj4gKwkJRFJNX0RFQlVHX0tN
UygiSW52YWxpZCBmcmFtZWJ1ZmZlciBzaXplICV1eCV1XG4iLAo+ICsJCQkgICAgICBmYi0+d2lk
dGgsIGZiLT5oZWlnaHQpOwo+ICsJCXJldHVybiAtRUlOVkFMOwo+ICsJfQo+ICsKPiArCWlmIChm
Yi0+Zm9ybWF0LT5mb3JtYXQgIT0gRFJNX0ZPUk1BVF9YUkdCODg4OCkgewo+ICsJCXN0cnVjdCBk
cm1fZm9ybWF0X25hbWVfYnVmIGZvcm1hdF9uYW1lOwo+ICsKPiArCQlEUk1fREVCVUdfS01TKCJJ
bnZhbGlkIHBpeGVsIGZvcm1hdCAlc1xuIiwKPiArCQkJICAgICAgZHJtX2dldF9mb3JtYXRfbmFt
ZShmYi0+Zm9ybWF0LT5mb3JtYXQsCj4gKwkJCQkJCSAgJmZvcm1hdF9uYW1lKSk7Cj4gKwkJcmV0
dXJuIC1FSU5WQUw7Cj4gKwl9Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyBj
b25zdCBzdHJ1Y3QgZHJtX2VuY29kZXJfaGVscGVyX2Z1bmNzIHZrbXNfd2JfZW5jb2Rlcl9oZWxw
ZXJfZnVuY3MgPSB7Cj4gKwkuYXRvbWljX2NoZWNrID0gdmttc193Yl9lbmNvZGVyX2F0b21pY19j
aGVjaywKPiArfTsKPiArCj4gK3N0YXRpYyBpbnQgdmttc193Yl9jb25uZWN0b3JfZ2V0X21vZGVz
KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCj4gK3sKPiArCXN0cnVjdCBkcm1fZGV2
aWNlICpkZXYgPSBjb25uZWN0b3ItPmRldjsKPiArCj4gKwlyZXR1cm4gZHJtX2FkZF9tb2Rlc19u
b2VkaWQoY29ubmVjdG9yLCBkZXYtPm1vZGVfY29uZmlnLm1heF93aWR0aCwKPiArCQkJCSAgICBk
ZXYtPm1vZGVfY29uZmlnLm1heF9oZWlnaHQpOwo+ICt9CgpEbyB3ZSBuZWVkIGEgbW9kZSBmb3Ig
d3JpdGViIGNvbm5lY3Rvcj8gSXMgdGhhdCB1c2VkIGJ5IHVzZXJzcGFjZSB0bwpmaWd1cmUgb3V0
IHRoZSBtYXggc2l6ZSBmb3Igd3JpdGViYWNrPwoKPiArCj4gK3N0YXRpYyBpbnQgdmttc193Yl9w
cmVwYXJlX2pvYihzdHJ1Y3QgZHJtX3dyaXRlYmFja19jb25uZWN0b3IgKndiX2Nvbm5lY3RvciwK
PiArCQkJICAgICAgIHN0cnVjdCBkcm1fd3JpdGViYWNrX2pvYiAqam9iKQo+ICt7Cj4gKwlzdHJ1
Y3Qgdmttc19nZW1fb2JqZWN0ICp2a21zX29iajsKPiArCXN0cnVjdCBkcm1fZ2VtX29iamVjdCAq
Z2VtX29iajsKPiArCWludCByZXQ7Cj4gKwo+ICsJaWYgKCFqb2ItPmZiKQo+ICsJCXJldHVybiAw
OwoKQ2FuIHRoaXMgaGFwcGVuPwoKPiArCj4gKwlnZW1fb2JqID0gZHJtX2dlbV9mYl9nZXRfb2Jq
KGpvYi0+ZmIsIDApOwo+ICsJcmV0ID0gdmttc19nZW1fdm1hcChnZW1fb2JqKTsKPiArCWlmIChy
ZXQpIHsKPiArCQlEUk1fRVJST1IoInZtYXAgZmFpbGVkOiAlZFxuIiwgcmV0KTsKPiArCQlyZXR1
cm4gcmV0Owo+ICsJfQo+ICsKPiArCXZrbXNfb2JqID0gZHJtX2dlbV90b192a21zX2dlbShnZW1f
b2JqKTsKPiArCWpvYi0+cHJpdiA9IHZrbXNfb2JqLT52YWRkcjsKPiArCj4gKwlyZXR1cm4gMDsK
PiArfQo+ICsKPiArc3RhdGljIHZvaWQgdmttc193Yl9jbGVhbnVwX2pvYihzdHJ1Y3QgZHJtX3dy
aXRlYmFja19jb25uZWN0b3IgKmNvbm5lY3RvciwKPiArCQkJCXN0cnVjdCBkcm1fd3JpdGViYWNr
X2pvYiAqam9iKQo+ICt7Cj4gKwlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdlbV9vYmo7Cj4gKwo+
ICsJaWYgKCFqb2ItPmZiKQo+ICsJCXJldHVybjsKClNhbWUgaGVyZT8KCj4gKwo+ICsJZ2VtX29i
aiA9IGRybV9nZW1fZmJfZ2V0X29iaihqb2ItPmZiLCAwKTsKPiArCXZrbXNfZ2VtX3Z1bm1hcChn
ZW1fb2JqKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgdmttc193Yl9hdG9taWNfY29tbWl0KHN0
cnVjdCBkcm1fY29ubmVjdG9yICpjb25uLAo+ICsJCQkJICBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9z
dGF0ZSAqc3RhdGUpCj4gK3sKPiArCXN0cnVjdCB2a21zX2RldmljZSAqdmttc2RldiA9IGRybV9k
ZXZpY2VfdG9fdmttc19kZXZpY2UoY29ubi0+ZGV2KTsKPiArCXN0cnVjdCB2a21zX291dHB1dCAq
b3V0cHV0ID0gJnZrbXNkZXYtPm91dHB1dDsKPiArCXN0cnVjdCBkcm1fd3JpdGViYWNrX2Nvbm5l
Y3RvciAqd2JfY29ubiA9ICZvdXRwdXQtPndiX2Nvbm5lY3RvcjsKPiArCXN0cnVjdCBkcm1fY29u
bmVjdG9yX3N0YXRlICpjb25uX3N0YXRlID0gd2JfY29ubi0+YmFzZS5zdGF0ZTsKPiArCXN0cnVj
dCB2a21zX2NydGNfc3RhdGUgKmNydGNfc3RhdGUgPSBvdXRwdXQtPmNvbXBvc2VyX3N0YXRlOwo+
ICsKPiArCWlmICghY29ubl9zdGF0ZSkKPiArCQlyZXR1cm47Cj4gKwo+ICsJaWYgKCFjb25uX3N0
YXRlLT53cml0ZWJhY2tfam9iIHx8ICFjb25uX3N0YXRlLT53cml0ZWJhY2tfam9iLT5mYikgewo+
ICsJCURSTV9ERUJVR19EUklWRVIoIkRpc2FibGUgd3JpdGViYWNrXG4iKTsKPiArCQlyZXR1cm47
Cj4gKwl9CgpBbGwgdGhyZWUgY2hlY2tzIGFib3ZlIHNvdW5kIGxpa2UgaGVscGVycyBzaG91bGQg
dGFrZSBjYXJlIG9mIHRoaXM/Cgo+ICsKPiArCXNwaW5fbG9ja19pcnEoJm91dHB1dC0+Y29tcG9z
ZXJfbG9jayk7Cj4gKwljcnRjX3N0YXRlLT5hY3RpdmVfd3JpdGViYWNrID0gY29ubl9zdGF0ZS0+
d3JpdGViYWNrX2pvYi0+cHJpdjsKPiArCWNydGNfc3RhdGUtPndiX3BlbmRpbmcgPSB0cnVlOwo+
ICsJc3Bpbl91bmxvY2tfaXJxKCZvdXRwdXQtPmNvbXBvc2VyX2xvY2spOwo+ICsJZHJtX3dyaXRl
YmFja19xdWV1ZV9qb2Iod2JfY29ubiwgc3RhdGUpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgY29uc3Qg
c3RydWN0IGRybV9jb25uZWN0b3JfaGVscGVyX2Z1bmNzIHZrbXNfd2JfY29ubl9oZWxwZXJfZnVu
Y3MgPSB7Cj4gKwkuZ2V0X21vZGVzID0gdmttc193Yl9jb25uZWN0b3JfZ2V0X21vZGVzLAo+ICsJ
LnByZXBhcmVfd3JpdGViYWNrX2pvYiA9IHZrbXNfd2JfcHJlcGFyZV9qb2IsCj4gKwkuY2xlYW51
cF93cml0ZWJhY2tfam9iID0gdmttc193Yl9jbGVhbnVwX2pvYiwKPiArCS5hdG9taWNfY29tbWl0
ID0gdmttc193Yl9hdG9taWNfY29tbWl0LAo+ICt9Owo+ICsKPiAraW50IGVuYWJsZV93cml0ZWJh
Y2tfY29ubmVjdG9yKHN0cnVjdCB2a21zX2RldmljZSAqdmttc2RldikKPiArewo+ICsJc3RydWN0
IGRybV93cml0ZWJhY2tfY29ubmVjdG9yICp3YiA9ICZ2a21zZGV2LT5vdXRwdXQud2JfY29ubmVj
dG9yOwo+ICsKPiArCXZrbXNkZXYtPm91dHB1dC53Yl9jb25uZWN0b3IuZW5jb2Rlci5wb3NzaWJs
ZV9jcnRjcyA9IDE7Cj4gKwlkcm1fY29ubmVjdG9yX2hlbHBlcl9hZGQoJndiLT5iYXNlLCAmdmtt
c193Yl9jb25uX2hlbHBlcl9mdW5jcyk7Cj4gKwo+ICsJcmV0dXJuIGRybV93cml0ZWJhY2tfY29u
bmVjdG9yX2luaXQoJnZrbXNkZXYtPmRybSwgd2IsCj4gKwkJCQkJICAgICZ2a21zX3diX2Nvbm5l
Y3Rvcl9mdW5jcywKPiArCQkJCQkgICAgJnZrbXNfd2JfZW5jb2Rlcl9oZWxwZXJfZnVuY3MsCj4g
KwkJCQkJICAgIHZrbXNfd2JfZm9ybWF0cywKPiArCQkJCQkgICAgQVJSQVlfU0laRSh2a21zX3di
X2Zvcm1hdHMpKTsKPiArfQoKT3ZlcmFsbCBsb29rcyBsaWtlIGdvb2QgYXBwcm9hY2guCi1EYW5p
ZWwKLS0gCkRhbmllbCBWZXR0ZXIKU29mdHdhcmUgRW5naW5lZXIsIEludGVsIENvcnBvcmF0aW9u
Cmh0dHA6Ly9ibG9nLmZmd2xsLmNoCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVk
ZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZv
L2RyaS1kZXZlbA==
