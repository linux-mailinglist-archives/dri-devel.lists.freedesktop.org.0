Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 849AF615FA
	for <lists+dri-devel@lfdr.de>; Sun,  7 Jul 2019 20:33:49 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6080889B9E;
	Sun,  7 Jul 2019 18:33:47 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from perceval.ideasonboard.com (perceval.ideasonboard.com
 [IPv6:2001:4b98:dc2:55:216:3eff:fef7:d647])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E63CF89B9E
 for <dri-devel@lists.freedesktop.org>; Sun,  7 Jul 2019 18:33:45 +0000 (UTC)
Received: from pendragon.nordic-sky.finnair.com (unknown [38.98.37.142])
 by perceval.ideasonboard.com (Postfix) with ESMTPSA id 07F80CC;
 Sun,  7 Jul 2019 20:33:23 +0200 (CEST)
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 37/60] drm/omap: hdmi5: Register a drm_bridge for EDID read
Date: Sun,  7 Jul 2019 21:19:14 +0300
Message-Id: <20190707181937.6250-34-laurent.pinchart@ideasonboard.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190707181937.6250-1-laurent.pinchart@ideasonboard.com>
References: <20190707180852.5512-1-laurent.pinchart@ideasonboard.com>
 <20190707181937.6250-1-laurent.pinchart@ideasonboard.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=ideasonboard.com; s=mail; t=1562524424;
 bh=gdhhXJLlgDrzKOB9AoGVH15L1NnE19ry889cH42792c=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=TDXszHP/HwhMJlOSOVYMSC4VTKVg5T+tTOx0wKFd1y/vkPl53kI3FLmyFgurTYHHC
 UH6gnDkn3waocTj6T3ORfxrPeXbHavcw2aMMmB4R7ZxQPfmD1snn49fi3Qq67KkwZy
 YgLC20ycS5nLnPDM0REstSdKYO6zbPvWQEmpohb4=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Maxime Ripard <maxime.ripard@bootlin.com>,
 Sebastian Reichel <sebastian.reichel@collabora.com>,
 Tomi Valkeinen <tomi.valkeinen@ti.com>, Sean Paul <sean@poorly.run>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW4gb3JkZXIgdG8gaW50ZWdyYXRlIHdpdGggYSBjaGFpbiBvZiBkcm1fYnJpZGdlLCB0aGUgaW50
ZXJuYWwgSERNSTUKZW5jb2RlciBoYXMgdG8gZXhwb3NlIHRoZSBFRElEIHJlYWQgb3BlcmF0aW9u
IHRocm91Z2ggdGhlIGRybV9icmlkZ2UKQVBJLiBSZWdpc3RlciBhIGJyaWRnZSBhdCBpbml0aWFs
aXNhdGlvbiB0aW1lIHRvIGRvIHNvLgoKRm9yIHRoZSB0aW1lIGJlaW5nIG1ha2UgdGhlIG5leHQg
YnJpZGdlIGluIHRoZSBjaGFpbiBvcHRpb25hbCBhcyB0aGUKSERNSSBvdXRwdXQgaXMgc3RpbGwg
YmFzZWQgb24gb21hcF9kc3NfZGV2aWNlLiBUaGUgY3JlYXRlX2Nvbm5lY3Rvcgphcmd1bWVudCB0
byB0aGUgYnJpZGdlIGF0dGFjaCBmdW5jdGlvbiBpcyBhbHNvIGlnbm9yZWQgZm9yIHRoZSBzYW1l
CnJlYXNvbi4gVGhpcyB3aWxsIGJlIGNoYW5nZWQgbGF0ZXIgd2hlbiByZW1vdmluZyB0aGUgcmVs
YXRlZApvbWFwZHJtLXNwZWNpZmljIGRpc3BsYXkgZHJpdmVycy4KClNpZ25lZC1vZmYtYnk6IExh
dXJlbnQgUGluY2hhcnQgPGxhdXJlbnQucGluY2hhcnRAaWRlYXNvbmJvYXJkLmNvbT4KLS0tCiBk
cml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3MvaGRtaTUuYyB8IDc0ICsrKysrKysrKysrKysrKysr
KysrKysrKysrKy0tCiAxIGZpbGUgY2hhbmdlZCwgNjkgaW5zZXJ0aW9ucygrKSwgNSBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3MvaGRtaTUuYyBi
L2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL2Rzcy9oZG1pNS5jCmluZGV4IDJkZmNhY2RjMDcyZS4u
ZGQ2N2E2MDQ0NTNmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3MvaGRt
aTUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3MvaGRtaTUuYwpAQCAtMzk3LDgg
KzM5NywxMCBAQCBzdGF0aWMgdm9pZCBoZG1pX2Rpc2Nvbm5lY3Qoc3RydWN0IG9tYXBfZHNzX2Rl
dmljZSAqc3JjLAogCW9tYXBkc3NfZGV2aWNlX2Rpc2Nvbm5lY3QoZHN0LCBkc3QtPm5leHQpOwog
fQogCi1zdGF0aWMgc3RydWN0IGVkaWQgKmhkbWlfcmVhZF9lZGlkX2RhdGEoc3RydWN0IGhkbWlf
Y29yZV9kYXRhICpjb3JlKQorc3RhdGljIHN0cnVjdCBlZGlkICpoZG1pX3JlYWRfZWRpZF9kYXRh
KHN0cnVjdCBvbWFwX2hkbWkgKmhkbWksCisJCQkJCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25u
ZWN0b3IpCiB7CisJc3RydWN0IGhkbWlfY29yZV9kYXRhICpjb3JlID0gJmhkbWktPmNvcmU7CiAJ
aW50IG1heF9leHRfYmxvY2tzID0gMzsKIAlpbnQgciwgbiwgaTsKIAl1OCAqZWRpZDsKQEAgLTQz
MCw5ICs0MzIsMTIgQEAgc3RhdGljIHN0cnVjdCBlZGlkICpoZG1pX3JlYWRfZWRpZF9kYXRhKHN0
cnVjdCBoZG1pX2NvcmVfZGF0YSAqY29yZSkKIAlyZXR1cm4gTlVMTDsKIH0KIAotc3RhdGljIHN0
cnVjdCBlZGlkICpoZG1pX3JlYWRfZWRpZChzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpkc3NkZXYp
CitzdGF0aWMgc3RydWN0IGVkaWQgKgoraGRtaV9kb19yZWFkX2VkaWQoc3RydWN0IG9tYXBfaGRt
aSAqaGRtaSwKKwkJICBzdHJ1Y3QgZWRpZCAqKCpyZWFkKShzdHJ1Y3Qgb21hcF9oZG1pICpoZG1p
LAorCQkJCSAgICAgICBzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKSwKKwkJICBzdHJ1
Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQogewotCXN0cnVjdCBvbWFwX2hkbWkgKmhkbWkg
PSBkc3NkZXZfdG9faGRtaShkc3NkZXYpOwogCXN0cnVjdCBlZGlkICplZGlkOwogCWJvb2wgbmVl
ZF9lbmFibGU7CiAJaW50IGlkbGVtb2RlOwpAQCAtNDU2LDcgKzQ2MSw3IEBAIHN0YXRpYyBzdHJ1
Y3QgZWRpZCAqaGRtaV9yZWFkX2VkaWQoc3RydWN0IG9tYXBfZHNzX2RldmljZSAqZHNzZGV2KQog
CiAJaGRtaTVfY29yZV9kZGNfaW5pdCgmaGRtaS0+Y29yZSk7CiAKLQllZGlkID0gaGRtaV9yZWFk
X2VkaWRfZGF0YSgmaGRtaS0+Y29yZSk7CisJZWRpZCA9IHJlYWQoaGRtaSwgY29ubmVjdG9yKTsK
IAogCWhkbWk1X2NvcmVfZGRjX3VuaW5pdCgmaGRtaS0+Y29yZSk7CiAKQEAgLTQ3MSw2ICs0NzYs
MTIgQEAgc3RhdGljIHN0cnVjdCBlZGlkICpoZG1pX3JlYWRfZWRpZChzdHJ1Y3Qgb21hcF9kc3Nf
ZGV2aWNlICpkc3NkZXYpCiAJcmV0dXJuIChzdHJ1Y3QgZWRpZCAqKWVkaWQ7CiB9CiAKK3N0YXRp
YyBzdHJ1Y3QgZWRpZCAqaGRtaV9yZWFkX2VkaWQoc3RydWN0IG9tYXBfZHNzX2RldmljZSAqZHNz
ZGV2KQoreworCXJldHVybiBoZG1pX2RvX3JlYWRfZWRpZChkc3NkZXZfdG9faGRtaShkc3NkZXYp
LCBoZG1pX3JlYWRfZWRpZF9kYXRhLAorCQkJCSBOVUxMKTsKK30KKwogc3RhdGljIGludCBoZG1p
X3NldF9pbmZvZnJhbWUoc3RydWN0IG9tYXBfZHNzX2RldmljZSAqZHNzZGV2LAogCQljb25zdCBz
dHJ1Y3QgaGRtaV9hdmlfaW5mb2ZyYW1lICphdmkpCiB7CkBAIC01MDYsNiArNTE3LDU1IEBAIHN0
YXRpYyBjb25zdCBzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlX29wcyBoZG1pX29wcyA9IHsKIAl9LAog
fTsKIAorLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqIERSTSBCcmlkZ2UgT3BlcmF0aW9ucwor
ICovCisKK3N0YXRpYyBpbnQgaGRtaTVfYnJpZGdlX2F0dGFjaChzdHJ1Y3QgZHJtX2JyaWRnZSAq
YnJpZGdlLCBib29sIGNyZWF0ZV9jb25uZWN0b3IpCit7CisJc3RydWN0IG9tYXBfaGRtaSAqaGRt
aSA9IGRybV9icmlkZ2VfdG9faGRtaShicmlkZ2UpOworCisJaWYgKCFoZG1pLT5vdXRwdXQubmV4
dF9icmlkZ2UpCisJCXJldHVybiAwOworCisJcmV0dXJuIGRybV9icmlkZ2VfYXR0YWNoKGJyaWRn
ZS0+ZW5jb2RlciwgaGRtaS0+b3V0cHV0Lm5leHRfYnJpZGdlLAorCQkJCSBicmlkZ2UsIGZhbHNl
KTsKK30KKworc3RhdGljIHN0cnVjdCBlZGlkICpoZG1pNV9icmlkZ2VfcmVhZF9lZGlkKHN0cnVj
dCBvbWFwX2hkbWkgKmhkbWksCisJCQkJCSAgIHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0
b3IpCit7CisJcmV0dXJuIGRybV9kb19nZXRfZWRpZChjb25uZWN0b3IsIGhkbWk1X2NvcmVfZGRj
X3JlYWQsICZoZG1pLT5jb3JlKTsKK30KKworc3RhdGljIHN0cnVjdCBlZGlkICpoZG1pNV9icmlk
Z2VfZ2V0X2VkaWQoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSwKKwkJCQkJICBzdHJ1Y3QgZHJt
X2Nvbm5lY3RvciAqY29ubmVjdG9yKQoreworCXN0cnVjdCBvbWFwX2hkbWkgKmhkbWkgPSBkcm1f
YnJpZGdlX3RvX2hkbWkoYnJpZGdlKTsKKworCXJldHVybiBoZG1pX2RvX3JlYWRfZWRpZChoZG1p
LCBoZG1pNV9icmlkZ2VfcmVhZF9lZGlkLCBjb25uZWN0b3IpOworfQorCitzdGF0aWMgY29uc3Qg
c3RydWN0IGRybV9icmlkZ2VfZnVuY3MgaGRtaTVfYnJpZGdlX2Z1bmNzID0geworCS5hdHRhY2gg
PSBoZG1pNV9icmlkZ2VfYXR0YWNoLAorCS5nZXRfZWRpZCA9IGhkbWk1X2JyaWRnZV9nZXRfZWRp
ZCwKK307CisKK3N0YXRpYyB2b2lkIGhkbWk1X2JyaWRnZV9pbml0KHN0cnVjdCBvbWFwX2hkbWkg
KmhkbWkpCit7CisJaGRtaS0+YnJpZGdlLmZ1bmNzID0gJmhkbWk1X2JyaWRnZV9mdW5jczsKKwlo
ZG1pLT5icmlkZ2Uub2Zfbm9kZSA9IGhkbWktPnBkZXYtPmRldi5vZl9ub2RlOworCWhkbWktPmJy
aWRnZS5vcHMgPSBEUk1fQlJJREdFX09QX0VESUQ7CisJaGRtaS0+YnJpZGdlLnR5cGUgPSBEUk1f
TU9ERV9DT05ORUNUT1JfSERNSUE7CisKKwlkcm1fYnJpZGdlX2FkZCgmaGRtaS0+YnJpZGdlKTsK
K30KKworc3RhdGljIHZvaWQgaGRtaTVfYnJpZGdlX2NsZWFudXAoc3RydWN0IG9tYXBfaGRtaSAq
aGRtaSkKK3sKKwlkcm1fYnJpZGdlX3JlbW92ZSgmaGRtaS0+YnJpZGdlKTsKK30KKwogLyogLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0KICAqIEF1ZGlvIENhbGxiYWNrcwogICovCkBAIC02ODgsNiArNzQ4
LDggQEAgc3RhdGljIGludCBoZG1pNV9pbml0X291dHB1dChzdHJ1Y3Qgb21hcF9oZG1pICpoZG1p
KQogCXN0cnVjdCBvbWFwX2Rzc19kZXZpY2UgKm91dCA9ICZoZG1pLT5vdXRwdXQ7CiAJaW50IHI7
CiAKKwloZG1pNV9icmlkZ2VfaW5pdChoZG1pKTsKKwogCW91dC0+ZGV2ID0gJmhkbWktPnBkZXYt
PmRldjsKIAlvdXQtPmlkID0gT01BUF9EU1NfT1VUUFVUX0hETUk7CiAJb3V0LT50eXBlID0gT01B
UF9ESVNQTEFZX1RZUEVfSERNSTsKQEAgLTY5OCw3ICs3NjAsNyBAQCBzdGF0aWMgaW50IGhkbWk1
X2luaXRfb3V0cHV0KHN0cnVjdCBvbWFwX2hkbWkgKmhkbWkpCiAJb3V0LT5vZl9wb3J0ID0gMDsK
IAlvdXQtPm9wc19mbGFncyA9IE9NQVBfRFNTX0RFVklDRV9PUF9FRElEOwogCi0JciA9IG9tYXBk
c3NfZGV2aWNlX2luaXRfb3V0cHV0KG91dCwgTlVMTCk7CisJciA9IG9tYXBkc3NfZGV2aWNlX2lu
aXRfb3V0cHV0KG91dCwgJmhkbWktPmJyaWRnZSk7CiAJaWYgKHIgPCAwKQogCQlyZXR1cm4gcjsK
IApAQCAtNzEzLDYgKzc3NSw4IEBAIHN0YXRpYyB2b2lkIGhkbWk1X3VuaW5pdF9vdXRwdXQoc3Ry
dWN0IG9tYXBfaGRtaSAqaGRtaSkKIAogCW9tYXBkc3NfZGV2aWNlX3VucmVnaXN0ZXIob3V0KTsK
IAlvbWFwZHNzX2RldmljZV9jbGVhbnVwX291dHB1dChvdXQpOworCisJaGRtaTVfYnJpZGdlX2Ns
ZWFudXAoaGRtaSk7CiB9CiAKIHN0YXRpYyBpbnQgaGRtaTVfcHJvYmVfb2Yoc3RydWN0IG9tYXBf
aGRtaSAqaGRtaSkKLS0gClJlZ2FyZHMsCgpMYXVyZW50IFBpbmNoYXJ0CgpfX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0
CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3Rv
cC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
