Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 62346CCB3A
	for <lists+dri-devel@lfdr.de>; Sat,  5 Oct 2019 18:37:57 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4DE166E3AE;
	Sat,  5 Oct 2019 16:37:36 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mo6-p03-ob.smtp.rzone.de (mo6-p03-ob.smtp.rzone.de
 [IPv6:2a01:238:20a:202:5303::9])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6DCA26EC1E
 for <dri-devel@lists.freedesktop.org>; Fri,  4 Oct 2019 19:09:53 +0000 (UTC)
X-RZG-AUTH: ":OWANVUa4dPFUgKR/3dpvnYP0Np73dmm4I5W0/AvA67Ot4fvR82tdd3x2KJk="
X-RZG-CLASS-ID: mo00
Received: from groucho.site by smtp.strato.de (RZmta 44.28.0 DYNA|AUTH)
 with ESMTPSA id i07086v94J9FcdZ
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-SHA (curve secp521r1 with 521 ECDH
 bits, eq. 15360 bits RSA)) (Client did not present a certificate);
 Fri, 4 Oct 2019 21:09:15 +0200 (CEST)
From: Ulrich Hecht <uli@fpond.eu>
To: linux-mediatek@lists.infradead.org, dri-devel@lists.freedesktop.org,
 jitao.shi@mediatek.com
Subject: [PATCH v19 2/2] drm/bridge: Add I2C based driver for ps8640 bridge
Date: Fri,  4 Oct 2019 21:09:08 +0200
Message-Id: <1570216148-22802-3-git-send-email-uli@fpond.eu>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1570216148-22802-1-git-send-email-uli@fpond.eu>
References: <1570216148-22802-1-git-send-email-uli@fpond.eu>
X-Mailman-Approved-At: Sat, 05 Oct 2019 16:37:28 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 t=1570216191; 
 s=strato-dkim-0002; d=fpond.eu;
 h=References:In-Reply-To:Message-Id:Date:Subject:Cc:To:From:
 X-RZG-CLASS-ID:X-RZG-AUTH:From:Subject:Sender;
 bh=uY64EtDogp2k8dzWwkolDaSWQgodwV7a45KMolGYAdA=;
 b=b+L37VPuo1Py4r7ECwMPPUyoejjoEFkFgkGbOCdliWdSoE5EpgSfWiUacBgKFiDCHj
 YiWO4kZ0ecYwpLedmuoC9A6zAS/zvbWg1TVX7X2mRdw6rmhKn18OlwKkQPppJzVlsFd9
 6LaBFbiFAaJJfKGJdBUCbmVxt/0S4CwFggXE4OJ1dQjzzZKC28PwQb7O4ozKEmAyrL8F
 4T6rthSszGN2kFcpIN8BBT+ErCkYRCez+tdtHNUVphdTgBvv7nyE6pyUa1iSnaFld1AJ
 mdMI3kEV62tbM3d56wT7D+iuHQ2cmwTH/msRibrWlTVULEMBAvitFvOfYoyKLdea1SVU
 aCwg==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: mark.rutland@arm.com, Ulrich Hecht <uli@fpond.eu>, stonea168@163.com,
 ajaykumar.rs@samsung.com, architt@codeaurora.org, vpalatin@chromium.org,
 cawa.cheng@mediatek.com, yingjoe.chen@mediatek.com, devicetree@vger.kernel.org,
 pawel.moll@arm.com, ijc+devicetree@hellion.org.uk, robh+dt@kernel.org,
 seanpaul@chromium.org, matthias.bgg@gmail.com, eddie.huang@mediatek.com,
 rahul.sharma@samsung.com, kernel@pengutronix.de, galak@codeaurora.org,
 enric.balletbo@collabora.com, andy.yan@rock-chips.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogSml0YW8gU2hpIDxqaXRhby5zaGlAbWVkaWF0ZWsuY29tPgoKVGhpcyBwYXRjaCBhZGRz
IGRybV9icmlkZ2UgZHJpdmVyIGZvciBwYXJhZGUgRFNJIHRvIGVEUCBicmlkZ2UgY2hpcC4KClNp
Z25lZC1vZmYtYnk6IEppdGFvIFNoaSA8aml0YW8uc2hpQG1lZGlhdGVrLmNvbT4KUmV2aWV3ZWQt
Ynk6IERhbmllbCBLdXJ0eiA8ZGprdXJ0ekBjaHJvbWl1bS5vcmc+ClJldmlld2VkLWJ5OiBFbnJp
YyBCYWxsZXRibyBpIFNlcnJhIDxlbnJpYy5iYWxsZXRib0Bjb2xsYWJvcmEuY29tPgpbdWxpOiBm
b2xsb3dlZCBBUEkgY2hhbmdlcywgcmVtb3ZlZCBGVyB1cGRhdGUgZmVhdHVyZV0KU2lnbmVkLW9m
Zi1ieTogVWxyaWNoIEhlY2h0IDx1bGlAZnBvbmQuZXU+Ci0tLQoKQ2hhbmdlcyBzaW5jZSB2MTg6
CiAtIGZvbGxvd2VkIERSTSBBUEkgY2hhbmdlcwogLSB1c2UgREVWSUNFX0FUVFJfUk8oKQogLSBy
ZW1vdmUgZmlybXdhcmUgdXBkYXRlIGNvZGUKIC0gYWRkIFNQRFggaWRlbnRpZmllcgoKQ2hhbmdl
cyBzaW5jZSB2MTc6CiAtIHJlbW92ZSBzb21lIHVudXNlZCBoZWFkIGZpbGVzLgogLSBhZGQgbWFj
cm9zIGZvciBwczg2NDAgcGFnZXMuCiAtIHJlbW92ZSBkZGNfaTJjIGNsaWVudAogLSBhZGQgbWlw
aV9kc2lfZGV2aWNlX3JlZ2lzdGVyX2Z1bGwKIC0gcmVtb3ZlIHRoZSBtYW51ZmFjdHVyZXIgZnJv
bSB0aGUgbmFtZSBhbmQgaTJjX2RldmljZV9pZAogCkNoYW5nZXMgc2luY2UgdjE2OgogLSBEaXNh
YmxlIHBzODY0MCBEU0kgTUNTIEZ1bmN0aW9uLgogLSBSZW5hbWUgZ3Bpb3MgbmFtZSBtb3JlIGNs
ZWFybHkuCiAtIFR1bmUgdGhlIHBzODY0MCBwb3dlciBvbiBzZXF1ZW5jZS4KCkNoYW5nZXMgc2lu
Y2UgdjE1OgogLSBEcm9wIGRybV9jb25uZWN0b3JfKHVuKXJlZ2lzdGVyIGNhbGxzIGZyb20gcGFy
YWRlIHBzODY0MC4KICAgVGhlIG1haW4gRFJNIGRyaXZlciBtdGtfZHJtX2RydiBub3cgY2FsbHMK
ICAgZHJtX2Nvbm5lY3Rvcl9yZWdpc3Rlcl9hbGwoKSBhZnRlciBkcm1fZGV2X3JlZ2lzdGVyKCkg
aW4gdGhlCiAgIG10a19kcm1fYmluZCgpIGZ1bmN0aW9uLiBUaGF0IGZ1bmN0aW9uIHNob3VsZCBp
dGVyYXRlIG92ZXIgYWxsCiAgIGNvbm5lY3RvcnMgYW5kIGNhbGwgZHJtX2Nvbm5lY3Rvcl9yZWdp
c3RlcigpIGZvciBlYWNoIG9mIHRoZW0uCiAgIFNvLCByZW1vdmUgZHJtX2Nvbm5lY3Rvcl8odW4p
cmVnaXN0ZXIgY2FsbHMgZnJvbSBwYXJhZGUgcHM4NjQwLgoKQ2hhbmdlcyBzaW5jZSB2MTQ6CiAt
IHVwZGF0ZSBjb3B5cmlnaHQgaW5mby4KIC0gY2hhbmdlIGJyaWRnZV90b19wczg2NDAgYW5kIGNv
bm5lY3Rvcl90b19wczg2NDAgdG8gaW5saW5lIGZ1bmN0aW9uLgogLSBmaXggc29tZSBjb2Rpbmcg
c3R5bGUuCiAtIHVzZSBzaXplb2YgYXMgYXJyYXkgY291bnRlci4KIC0gdXNlIGRybV9nZXRfZWRp
ZCB3aGVuIHJlYWQgZWRpZC4KIC0gYWRkIG11dGV4IHdoZW4gZmlybXdhcmUgdXBkYXRpbmcuIAoK
Q2hhbmdlcyBzaW5jZSB2MTM6CiAtIGFkZCBjb25zdCBvbiBkYXRhLCBwczg2NDBfd3JpdGVfYnl0
ZXMoc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCwgY29uc3QgdTggKmRhdGEsIHUxNiBkYXRhX2xl
bikKIC0gZml4IFBBR0UyX1NXX1JFU1QgdHlyby4KIC0gbW92ZSB0aGUgYnVmWzNdIGluaXQgdG8g
ZW50cmFuY2Ugb2YgdGhlIGZ1bmN0aW9uLgoKQ2hhbmdlcyBzaW5jZSB2MTI6CiAtIGZpeCBod19j
aGlwX2lkIGJ1aWxkIHdhcm5pbmcKCkNoYW5nZXMgc2luY2UgdjExOgogLSBSZW1vdmUgZGVwZW5k
cyBvbiBJMkMsIGFkZCBEUk0gZGVwZW5kcwogLSBSZXVzZSBwczg2NDBfd3JpdGVfYnl0ZXMoKSBp
biBwczg2NDBfd3JpdGVfYnl0ZSgpCiAtIFVzZSB0aW1lciBjaGVjayBmb3IgcG9sbGluZyBsaWtl
IHRoZSByb3V0aW5lcyBpbiA8bGludXgvaW9wb2xsLmg+CiAtIEZpeCBubyBkcm1fY29ubmVjdG9y
X3VucmVnaXN0ZXIvZHJtX2Nvbm5lY3Rvcl9jbGVhbnVwIHdoZW4gcHM4NjQwX2JyaWRnZV9hdHRh
Y2ggZmFpbAogLSBDaGVjayB0aGUgcHM4NjQwIGhhcmR3YXJlIGlkIGluIHBzODY0MF92YWxpZGF0
ZV9maXJtd2FyZQogLSBSZW1vdmUgZndfdmVyc2lvbiBjaGVjawogLSBNb3ZlIHBzODY0MF92YWxp
ZGF0ZV9maXJtd2FyZSBiZWZvcmUgcHM4NjQwX2VudGVyX2JsCiAtIEFkZCBkZGNfaTJjIHVucmVn
aXN0ZXIgd2hlbiBwcm9iZSBmYWlsIGFuZCBwczg2NDBfcmVtb3ZlCgoKIGRyaXZlcnMvZ3B1L2Ry
bS9icmlkZ2UvS2NvbmZpZyAgICAgICAgIHwgIDEyICsKIGRyaXZlcnMvZ3B1L2RybS9icmlkZ2Uv
TWFrZWZpbGUgICAgICAgIHwgICAxICsKIGRyaXZlcnMvZ3B1L2RybS9icmlkZ2UvcGFyYWRlLXBz
ODY0MC5jIHwgNjcyICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKwogMyBmaWxlcyBj
aGFuZ2VkLCA2ODUgaW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1
L2RybS9icmlkZ2UvcGFyYWRlLXBzODY0MC5jCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2JyaWRnZS9LY29uZmlnIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9LY29uZmlnCmluZGV4IDFj
YzlmNTAuLjYxYzY0MTUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvS2NvbmZp
ZworKysgYi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL0tjb25maWcKQEAgLTgyLDYgKzgyLDE4IEBA
IGNvbmZpZyBEUk1fUEFSQURFX1BTODYyMgogCS0tLWhlbHAtLS0KIAkgIFBhcmFkZSBlRFAtTFZE
UyBicmlkZ2UgY2hpcCBkcml2ZXIuCiAKK2NvbmZpZyBEUk1fUEFSQURFX1BTODY0MAorCXRyaXN0
YXRlICJQYXJhZGUgUFM4NjQwIE1JUEkgRFNJIHRvIGVEUCBDb252ZXJ0ZXIiCisJZGVwZW5kcyBv
biBEUk0KKwlkZXBlbmRzIG9uIE9GCisJc2VsZWN0IERSTV9LTVNfSEVMUEVSCisJc2VsZWN0IERS
TV9NSVBJX0RTSQorCXNlbGVjdCBEUk1fUEFORUwKKwloZWxwCisJICBDaG9vc2UgdGhpcyBvcHRp
b24gaWYgeW91IGhhdmUgUFM4NjQwIGZvciBkaXNwbGF5CisJICBUaGUgUFM4NjQwIGlzIGEgaGln
aC1wZXJmb3JtYW5jZSBhbmQgbG93LXBvd2VyCisJICBNSVBJIERTSSB0byBlRFAgY29udmVydGVy
CisKIGNvbmZpZyBEUk1fU0lMX1NJSTg2MjAKIAl0cmlzdGF0ZSAiU2lsaWNvbiBJbWFnZSBTSUk4
NjIwIEhETUkvTUhMIGJyaWRnZSIKIAlkZXBlbmRzIG9uIE9GCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vYnJpZGdlL01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9NYWtlZmls
ZQppbmRleCA0OTM0ZmNmLi4xNDY2MGFiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYnJp
ZGdlL01ha2VmaWxlCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvTWFrZWZpbGUKQEAgLTYs
NiArNiw3IEBAIG9iai0kKENPTkZJR19EUk1fTFZEU19FTkNPREVSKSArPSBsdmRzLWVuY29kZXIu
bwogb2JqLSQoQ09ORklHX0RSTV9NRUdBQ0hJUFNfU1REUFhYWFhfR0VfQjg1MFYzX0ZXKSArPSBt
ZWdhY2hpcHMtc3RkcHh4eHgtZ2UtYjg1MHYzLWZ3Lm8KIG9iai0kKENPTkZJR19EUk1fTlhQX1BU
TjM0NjApICs9IG54cC1wdG4zNDYwLm8KIG9iai0kKENPTkZJR19EUk1fUEFSQURFX1BTODYyMikg
Kz0gcGFyYWRlLXBzODYyMi5vCitvYmotJChDT05GSUdfRFJNX1BBUkFERV9QUzg2NDApICs9IHBh
cmFkZS1wczg2NDAubwogb2JqLSQoQ09ORklHX0RSTV9TSUxfU0lJODYyMCkgKz0gc2lsLXNpaTg2
MjAubwogb2JqLSQoQ09ORklHX0RSTV9TSUk5MDJYKSArPSBzaWk5MDJ4Lm8KIG9iai0kKENPTkZJ
R19EUk1fU0lJOTIzNCkgKz0gc2lpOTIzNC5vCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
YnJpZGdlL3BhcmFkZS1wczg2NDAuYyBiL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvcGFyYWRlLXBz
ODY0MC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLmQ2NDVkYzgKLS0tIC9k
ZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL3BhcmFkZS1wczg2NDAuYwpAQCAt
MCwwICsxLDY3MiBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seQor
LyoKKyAqIENvcHlyaWdodCAoYykgMjAxNiBNZWRpYVRlayBJbmMuCisgKgorICogVGhpcyBwcm9n
cmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2Rp
ZnkKKyAqIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vu
c2UgdmVyc2lvbiAyIGFzCisgKiBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRh
dGlvbi4KKyAqCisgKiBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhh
dCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91
dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklU
TkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCisgKiBHTlUgR2VuZXJhbCBQ
dWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorICovCisKKyNpbmNsdWRlIDxsaW51eC9k
ZWxheS5oPgorI2luY2x1ZGUgPGxpbnV4L2Vyci5oPgorI2luY2x1ZGUgPGxpbnV4L2Zpcm13YXJl
Lmg+CisjaW5jbHVkZSA8bGludXgvZ3Bpby9jb25zdW1lci5oPgorI2luY2x1ZGUgPGxpbnV4L2ky
Yy5oPgorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgorI2luY2x1ZGUgPGxpbnV4L29mX2dyYXBo
Lmg+CisjaW5jbHVkZSA8bGludXgvcmVndWxhdG9yL2NvbnN1bWVyLmg+CisjaW5jbHVkZSA8YXNt
L3VuYWxpZ25lZC5oPgorI2luY2x1ZGUgPGRybS9kcm1fcGFuZWwuaD4KKworI2luY2x1ZGUgPGRy
bS9kcm1fYXRvbWljX2hlbHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fY3J0Y19oZWxwZXIuaD4K
KyNpbmNsdWRlIDxkcm0vZHJtX2VkaWQuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX21pcGlfZHNpLmg+
CisjaW5jbHVkZSA8ZHJtL2RybV9wcmludC5oPgorI2luY2x1ZGUgPGRybS9kcm1fcHJvYmVfaGVs
cGVyLmg+CisKKyNkZWZpbmUgUEFHRTFfVlNUQVJUCQkweDZiCisjZGVmaW5lIFBBR0UyX1NQSV9D
RkczCQkweDgyCisjZGVmaW5lIEkyQ19UT19TUElfUkVTRVQJMHgyMAorI2RlZmluZSBQQUdFMl9S
T01BRERfQllURTEJMHg4ZQorI2RlZmluZSBQQUdFMl9ST01BRERfQllURTIJMHg4ZgorI2RlZmlu
ZSBQQUdFMl9TV1NQSV9XREFUQQkweDkwCisjZGVmaW5lIFBBR0UyX1NXU1BJX1JEQVRBCTB4OTEK
KyNkZWZpbmUgUEFHRTJfU1dTUElfTEVOCQkweDkyCisjZGVmaW5lIFBBR0UyX1NXU1BJX0NUTAkJ
MHg5MworI2RlZmluZSBUUklHR0VSX05PX1JFQURCQUNLCTB4MDUKKyNkZWZpbmUgVFJJR0dFUl9S
RUFEQkFDSwkweDAxCisjZGVmaW5lIFBBR0UyX1NQSV9TVEFUVVMJMHg5ZQorI2RlZmluZSBTUElf
UkVBRFkJCTB4MGMKKyNkZWZpbmUgUEFHRTJfR1BJT19MCQkweGE2CisjZGVmaW5lIFBBR0UyX0dQ
SU9fSAkJMHhhNworI2RlZmluZSBQU19HUElPOQkJQklUKDEpCisjZGVmaW5lIFBBR0UyX0lST01f
Q1RSTAkJMHhiMAorI2RlZmluZSBJUk9NX0VOQUJMRQkJMHhjMAorI2RlZmluZSBJUk9NX0RJU0FC
TEUJCTB4ODAKKyNkZWZpbmUgUEFHRTJfU1dfUkVTRVQJCTB4YmMKKyNkZWZpbmUgU1BJX1NXX1JF
U0VUCQlCSVQoNykKKyNkZWZpbmUgTVBVX1NXX1JFU0VUCQlCSVQoNikKKyNkZWZpbmUgUEFHRTJf
RU5DVExTUElfV1IJMHhkYQorI2RlZmluZSBQQUdFMl9JMkNfQllQQVNTCTB4ZWEKKyNkZWZpbmUg
STJDX0JZUEFTU19FTgkJMHhkMAorI2RlZmluZSBQQUdFMl9NQ1NfRU4JCTB4ZjMKKyNkZWZpbmUg
TUNTX0VOCQkJQklUKDApCisjZGVmaW5lIFBBR0UzX1NFVF9BREQJCTB4ZmUKKyNkZWZpbmUgUEFH
RTNfU0VUX1ZBTAkJMHhmZgorI2RlZmluZSBWRE9fQ1RMX0FERAkJMHgxMworI2RlZmluZSBWRE9f
RElTCQkJMHgxOAorI2RlZmluZSBWRE9fRU4JCQkweDFjCisjZGVmaW5lIFBBR0U0X1JFVl9MCQkw
eGYwCisjZGVmaW5lIFBBR0U0X1JFVl9ICQkweGYxCisjZGVmaW5lIFBBR0U0X0NISVBfTAkJMHhm
MgorI2RlZmluZSBQQUdFNF9DSElQX0gJCTB4ZjMKKworI2RlZmluZSBQQUdFMF9EUF9DTlRMCTAK
KyNkZWZpbmUgUEFHRTFfVkRPX0JERwkxCisjZGVmaW5lIFBBR0UyX1RPUF9DTlRMCTIKKyNkZWZp
bmUgUEFHRTNfRFNJX0NOVEwxCTMKKyNkZWZpbmUgUEFHRTRfTUlQSV9QSFkJNAorI2RlZmluZSBQ
QUdFNV9WUExMCTUKKyNkZWZpbmUgUEFHRTZfRFNJX0NOVEwyCTYKKyNkZWZpbmUgUEFHRTdfU1BJ
X0NOVEwJNworI2RlZmluZSBNQVhfREVWUwkJMHg4CisKK3N0cnVjdCBwczg2NDBfaW5mbyB7CisJ
dTggZmFtaWx5X2lkOworCXU4IHZhcmlhbnRfaWQ7CisJdTE2IHZlcnNpb247Cit9OworCitzdHJ1
Y3QgcHM4NjQwIHsKKwlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciBjb25uZWN0b3I7CisJc3RydWN0IGRy
bV9icmlkZ2UgYnJpZGdlOworCXN0cnVjdCBlZGlkICplZGlkOworCXN0cnVjdCBtaXBpX2RzaV9k
ZXZpY2UgKmRzaTsKKwlzdHJ1Y3QgaTJjX2NsaWVudCAqcGFnZVtNQVhfREVWU107CisJc3RydWN0
IHJlZ3VsYXRvcl9idWxrX2RhdGEgc3VwcGxpZXNbMl07CisJc3RydWN0IGRybV9wYW5lbCAqcGFu
ZWw7CisJc3RydWN0IGdwaW9fZGVzYyAqZ3Bpb19yZXNldDsKKwlzdHJ1Y3QgZ3Bpb19kZXNjICpn
cGlvX3Bvd2VyX2Rvd247CisJc3RydWN0IGdwaW9fZGVzYyAqZ3Bpb19tb2RlX3NlbDsKKwlib29s
IGVuYWJsZWQ7CisKKwkvKiBmaXJtd2FyZSBmaWxlIGluZm8gKi8KKwlzdHJ1Y3QgcHM4NjQwX2lu
Zm8gaW5mbzsKKwlib29sIGluX2Z3X3VwZGF0ZTsKKwkvKiBmb3IgZmlybXdhcmUgdXBkYXRlIHBy
b3RlY3QgKi8KKwlzdHJ1Y3QgbXV0ZXggZndfbXV0ZXg7Cit9OworCitzdGF0aWMgY29uc3QgdTgg
ZW5jX2N0cmxfY29kZVs2XSA9IHsgMHhhYSwgMHg1NSwgMHg1MCwgMHg0MSwgMHg1MiwgMHg0NCB9
Oworc3RhdGljIGNvbnN0IHU4IGh3X2NoaXBfaWRbNF0gPSB7IDB4MDAsIDB4MGEsIDB4MDAsIDB4
MzAgfTsKKworc3RhdGljIGlubGluZSBzdHJ1Y3QgcHM4NjQwICpicmlkZ2VfdG9fcHM4NjQwKHN0
cnVjdCBkcm1fYnJpZGdlICplKQoreworCXJldHVybiBjb250YWluZXJfb2YoZSwgc3RydWN0IHBz
ODY0MCwgYnJpZGdlKTsKK30KKworc3RhdGljIGlubGluZSBzdHJ1Y3QgcHM4NjQwICpjb25uZWN0
b3JfdG9fcHM4NjQwKHN0cnVjdCBkcm1fY29ubmVjdG9yICplKQoreworCXJldHVybiBjb250YWlu
ZXJfb2YoZSwgc3RydWN0IHBzODY0MCwgY29ubmVjdG9yKTsKK30KKworc3RhdGljIGludCBwczg2
NDBfcmVhZChzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50LCB1OCByZWcsIHU4ICpkYXRhLAorCQkg
ICAgICAgdTE2IGRhdGFfbGVuKQoreworCWludCByZXQ7CisJc3RydWN0IGkyY19tc2cgbXNnc1td
ID0geworCQl7CisJCSAuYWRkciA9IGNsaWVudC0+YWRkciwKKwkJIC5mbGFncyA9IDAsCisJCSAu
bGVuID0gMSwKKwkJIC5idWYgPSAmcmVnLAorCQl9LAorCQl7CisJCSAuYWRkciA9IGNsaWVudC0+
YWRkciwKKwkJIC5mbGFncyA9IEkyQ19NX1JELAorCQkgLmxlbiA9IGRhdGFfbGVuLAorCQkgLmJ1
ZiA9IGRhdGEsCisJCX0KKwl9OworCisJcmV0ID0gaTJjX3RyYW5zZmVyKGNsaWVudC0+YWRhcHRl
ciwgbXNncywgMik7CisKKwlpZiAocmV0ID09IDIpCisJCXJldHVybiAwOworCWlmIChyZXQgPCAw
KQorCQlyZXR1cm4gcmV0OworCWVsc2UKKwkJcmV0dXJuIC1FSU87Cit9CisKK3N0YXRpYyBpbnQg
cHM4NjQwX3dyaXRlX2J5dGVzKHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQsIGNvbnN0IHU4ICpk
YXRhLAorCQkJICAgICAgdTE2IGRhdGFfbGVuKQoreworCWludCByZXQ7CisJc3RydWN0IGkyY19t
c2cgbXNnOworCisJbXNnLmFkZHIgPSBjbGllbnQtPmFkZHI7CisJbXNnLmZsYWdzID0gMDsKKwlt
c2cubGVuID0gZGF0YV9sZW47CisJbXNnLmJ1ZiA9ICh1OCAqKWRhdGE7CisKKwlyZXQgPSBpMmNf
dHJhbnNmZXIoY2xpZW50LT5hZGFwdGVyLCAmbXNnLCAxKTsKKwlpZiAocmV0ID09IDEpCisJCXJl
dHVybiAwOworCWlmIChyZXQgPCAwKQorCQlyZXR1cm4gcmV0OworCWVsc2UKKwkJcmV0dXJuIC1F
SU87Cit9CisKK3N0YXRpYyBpbnQgcHM4NjQwX3dyaXRlX2J5dGUoc3RydWN0IGkyY19jbGllbnQg
KmNsaWVudCwgdTggcmVnLCAgdTggZGF0YSkKK3sKKwl1OCBidWZbXSA9IHsgcmVnLCBkYXRhIH07
CisKKwlyZXR1cm4gcHM4NjQwX3dyaXRlX2J5dGVzKGNsaWVudCwgYnVmLCBzaXplb2YoYnVmKSk7
Cit9CisKK3N0YXRpYyB2b2lkIHBzODY0MF9nZXRfbWN1X2Z3X3ZlcnNpb24oc3RydWN0IHBzODY0
MCAqcHNfYnJpZGdlKQoreworCXN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQgPSBwc19icmlkZ2Ut
PnBhZ2VbUEFHRTVfVlBMTF07CisJdTggZndfdmVyWzJdOworCisJcHM4NjQwX3JlYWQoY2xpZW50
LCAweDQsIGZ3X3Zlciwgc2l6ZW9mKGZ3X3ZlcikpOworCXBzX2JyaWRnZS0+aW5mby52ZXJzaW9u
ID0gKGZ3X3ZlclswXSA8PCA4KSB8IGZ3X3ZlclsxXTsKKworCURSTV9JTkZPX09OQ0UoInBzODY0
MCByb20gZncgdmVyc2lvbiAlZC4lZFxuIiwgZndfdmVyWzBdLCBmd192ZXJbMV0pOworfQorCitz
dGF0aWMgaW50IHBzODY0MF9icmlkZ2VfdW5tdXRlKHN0cnVjdCBwczg2NDAgKnBzX2JyaWRnZSkK
K3sKKwlzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50ID0gcHNfYnJpZGdlLT5wYWdlW1BBR0UzX0RT
SV9DTlRMMV07CisJdTggdmRvX2N0cmxfYnVmWzNdID0geyBQQUdFM19TRVRfQURELCBWRE9fQ1RM
X0FERCwgVkRPX0VOIH07CisKKwlyZXR1cm4gcHM4NjQwX3dyaXRlX2J5dGVzKGNsaWVudCwgdmRv
X2N0cmxfYnVmLCBzaXplb2YodmRvX2N0cmxfYnVmKSk7Cit9CisKK3N0YXRpYyBpbnQgcHM4NjQw
X2JyaWRnZV9tdXRlKHN0cnVjdCBwczg2NDAgKnBzX2JyaWRnZSkKK3sKKwlzdHJ1Y3QgaTJjX2Ns
aWVudCAqY2xpZW50ID0gcHNfYnJpZGdlLT5wYWdlW1BBR0UzX0RTSV9DTlRMMV07CisJdTggdmRv
X2N0cmxfYnVmWzNdID0geyBQQUdFM19TRVRfQURELCBWRE9fQ1RMX0FERCwgVkRPX0RJUyB9Owor
CisJcmV0dXJuIHBzODY0MF93cml0ZV9ieXRlcyhjbGllbnQsIHZkb19jdHJsX2J1Ziwgc2l6ZW9m
KHZkb19jdHJsX2J1ZikpOworfQorCitzdGF0aWMgdm9pZCBwczg2NDBfcHJlX2VuYWJsZShzdHJ1
Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQoreworCXN0cnVjdCBwczg2NDAgKnBzX2JyaWRnZSA9IGJy
aWRnZV90b19wczg2NDAoYnJpZGdlKTsKKwlzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50ID0gcHNf
YnJpZGdlLT5wYWdlW1BBR0UyX1RPUF9DTlRMXTsKKwlzdHJ1Y3QgaTJjX2NsaWVudCAqcGFnZTEg
PSBwc19icmlkZ2UtPnBhZ2VbUEFHRTFfVkRPX0JER107CisJaW50IGVycjsKKwl1OCBzZXRfdmRv
X2RvbmUsIG1jc19lbiwgdnN0YXJ0OworCWt0aW1lX3QgdGltZW91dDsKKworCWlmIChwc19icmlk
Z2UtPmluX2Z3X3VwZGF0ZSkKKwkJcmV0dXJuOworCisJaWYgKHBzX2JyaWRnZS0+ZW5hYmxlZCkK
KwkJcmV0dXJuOworCisJZXJyID0gZHJtX3BhbmVsX3ByZXBhcmUocHNfYnJpZGdlLT5wYW5lbCk7
CisJaWYgKGVyciA8IDApIHsKKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gcHJlcGFyZSBwYW5lbDog
JWRcbiIsIGVycik7CisJCXJldHVybjsKKwl9CisKKwllcnIgPSByZWd1bGF0b3JfYnVsa19lbmFi
bGUoQVJSQVlfU0laRShwc19icmlkZ2UtPnN1cHBsaWVzKSwKKwkJCQkgICAgcHNfYnJpZGdlLT5z
dXBwbGllcyk7CisJaWYgKGVyciA8IDApIHsKKwkJRFJNX0VSUk9SKCJjYW5ub3QgZW5hYmxlIHJl
Z3VsYXRvcnMgJWRcbiIsIGVycik7CisJCWdvdG8gZXJyX3BhbmVsX3VucHJlcGFyZTsKKwl9CisK
KwlncGlvZF9zZXRfdmFsdWUocHNfYnJpZGdlLT5ncGlvX3Bvd2VyX2Rvd24sIDEpOworCWdwaW9k
X3NldF92YWx1ZShwc19icmlkZ2UtPmdwaW9fcmVzZXQsIDApOworCXVzbGVlcF9yYW5nZSgyMDAw
LCAyNTAwKTsKKwlncGlvZF9zZXRfdmFsdWUocHNfYnJpZGdlLT5ncGlvX3Jlc2V0LCAxKTsKKwor
CS8qCisJICogV2FpdCBmb3IgdGhlIHBzODY0MCBlbWJlZCBtY3UgcmVhZHkKKwkgKiBGaXJzdCB3
YWl0IDIwMG1zIGFuZCB0aGVuIGNoZWNrIHRoZSBtY3UgcmVhZHkgZmxhZyBldmVyeSAyMG1zCisJ
ICovCisJbXNsZWVwKDIwMCk7CisKKwl0aW1lb3V0ID0ga3RpbWVfYWRkX21zKGt0aW1lX2dldCgp
LCAyMDApOworCWZvciAoOzspIHsKKwkJZXJyID0gcHM4NjQwX3JlYWQoY2xpZW50LCBQQUdFMl9H
UElPX0gsICZzZXRfdmRvX2RvbmUsIDEpOworCQlpZiAoZXJyIDwgMCkgeworCQkJRFJNX0VSUk9S
KCJmYWlsZWQgcmVhZCBQQUdFMl9HUElPX0g6ICVkXG4iLCBlcnIpOworCQkJZ290byBlcnJfcmVn
dWxhdG9yc19kaXNhYmxlOworCQl9CisJCWlmICgoc2V0X3Zkb19kb25lICYgUFNfR1BJTzkpID09
IFBTX0dQSU85KQorCQkJYnJlYWs7CisJCWlmIChrdGltZV9jb21wYXJlKGt0aW1lX2dldCgpLCB0
aW1lb3V0KSA+IDApCisJCQlicmVhazsKKwkJbXNsZWVwKDIwKTsKKwl9CisKKwltc2xlZXAoNTAp
OworCisJcHM4NjQwX3JlYWQocGFnZTEsIFBBR0UxX1ZTVEFSVCwgJnZzdGFydCwgMSk7CisJRFJN
X0lORk8oIlBTODY0MCBQQUdFMS4weDZCID0gMHgleFxuIiwgdnN0YXJ0KTsKKworCS8qKgorCSAq
IFRoZSBNYW51ZmFjdHVyZXIgQ29tbWFuZCBTZXQgKE1DUykgaXMgYSBkZXZpY2UgZGVwZW5kZW50
IGludGVyZmFjZQorCSAqIGludGVuZGVkIGZvciBmYWN0b3J5IHByb2dyYW1taW5nIG9mIHRoZSBk
aXNwbGF5IG1vZHVsZSBkZWZhdWx0CisJICogcGFyYW1ldGVycy4gT25jZSB0aGUgZGlzcGxheSBt
b2R1bGUgaXMgY29uZmlndXJlZCwgdGhlIE1DUyBzaGFsbCBiZQorCSAqIGRpc2FibGVkIGJ5IHRo
ZSBtYW51ZmFjdHVyZXIuIE9uY2UgZGlzYWJsZWQsIGFsbCBNQ1MgY29tbWFuZHMgYXJlCisJICog
aWdub3JlZCBieSB0aGUgZGlzcGxheSBpbnRlcmZhY2UuCisJICovCisJcHM4NjQwX3JlYWQoY2xp
ZW50LCBQQUdFMl9NQ1NfRU4sICZtY3NfZW4sIDEpOworCXBzODY0MF93cml0ZV9ieXRlKGNsaWVu
dCwgUEFHRTJfTUNTX0VOLCBtY3NfZW4gJiB+TUNTX0VOKTsKKworCWlmIChwc19icmlkZ2UtPmlu
Zm8udmVyc2lvbiA9PSAwKQorCQlwczg2NDBfZ2V0X21jdV9md192ZXJzaW9uKHBzX2JyaWRnZSk7
CisKKwllcnIgPSBwczg2NDBfYnJpZGdlX3VubXV0ZShwc19icmlkZ2UpOworCWlmIChlcnIpCisJ
CURSTV9FUlJPUigiZmFpbGVkIHRvIGVuYWJsZSB1bm11dGV2aWRlbzogJWRcbiIsIGVycik7CisJ
LyogU3dpdGNoIGFjY2VzcyBlZHAgcGFuZWwncyBlZGlkIHRocm91Z2ggaTJjICovCisJcHM4NjQw
X3dyaXRlX2J5dGUoY2xpZW50LCBQQUdFMl9JMkNfQllQQVNTLCBJMkNfQllQQVNTX0VOKTsKKwlw
c19icmlkZ2UtPmVuYWJsZWQgPSB0cnVlOworCisJcmV0dXJuOworCitlcnJfcmVndWxhdG9yc19k
aXNhYmxlOgorCXJlZ3VsYXRvcl9idWxrX2Rpc2FibGUoQVJSQVlfU0laRShwc19icmlkZ2UtPnN1
cHBsaWVzKSwKKwkJCSAgICAgICBwc19icmlkZ2UtPnN1cHBsaWVzKTsKK2Vycl9wYW5lbF91bnBy
ZXBhcmU6CisJZHJtX3BhbmVsX3VucHJlcGFyZShwc19icmlkZ2UtPnBhbmVsKTsKK30KKworc3Rh
dGljIHZvaWQgcHM4NjQwX2VuYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQoreworCXN0
cnVjdCBwczg2NDAgKnBzX2JyaWRnZSA9IGJyaWRnZV90b19wczg2NDAoYnJpZGdlKTsKKwlpbnQg
ZXJyOworCisJZXJyID0gZHJtX3BhbmVsX2VuYWJsZShwc19icmlkZ2UtPnBhbmVsKTsKKwlpZiAo
ZXJyIDwgMCkKKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gZW5hYmxlIHBhbmVsOiAlZFxuIiwgZXJy
KTsKK30KKworc3RhdGljIHZvaWQgcHM4NjQwX2Rpc2FibGUoc3RydWN0IGRybV9icmlkZ2UgKmJy
aWRnZSkKK3sKKwlzdHJ1Y3QgcHM4NjQwICpwc19icmlkZ2UgPSBicmlkZ2VfdG9fcHM4NjQwKGJy
aWRnZSk7CisJaW50IGVycjsKKworCWVyciA9IGRybV9wYW5lbF9kaXNhYmxlKHBzX2JyaWRnZS0+
cGFuZWwpOworCWlmIChlcnIgPCAwKQorCQlEUk1fRVJST1IoImZhaWxlZCB0byBkaXNhYmxlIHBh
bmVsOiAlZFxuIiwgZXJyKTsKK30KKworc3RhdGljIHZvaWQgcHM4NjQwX3Bvc3RfZGlzYWJsZShz
dHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQoreworCXN0cnVjdCBwczg2NDAgKnBzX2JyaWRnZSA9
IGJyaWRnZV90b19wczg2NDAoYnJpZGdlKTsKKwlpbnQgZXJyOworCisJaWYgKHBzX2JyaWRnZS0+
aW5fZndfdXBkYXRlKQorCQlyZXR1cm47CisKKwlpZiAoIXBzX2JyaWRnZS0+ZW5hYmxlZCkKKwkJ
cmV0dXJuOworCisJcHNfYnJpZGdlLT5lbmFibGVkID0gZmFsc2U7CisKKwllcnIgPSBwczg2NDBf
YnJpZGdlX211dGUocHNfYnJpZGdlKTsKKwlpZiAoZXJyIDwgMCkKKwkJRFJNX0VSUk9SKCJmYWls
ZWQgdG8gdW5tdXRldmlkZW86ICVkXG4iLCBlcnIpOworCisJZ3Bpb2Rfc2V0X3ZhbHVlKHBzX2Jy
aWRnZS0+Z3Bpb19yZXNldCwgMCk7CisJZ3Bpb2Rfc2V0X3ZhbHVlKHBzX2JyaWRnZS0+Z3Bpb19w
b3dlcl9kb3duLCAwKTsKKwllcnIgPSByZWd1bGF0b3JfYnVsa19kaXNhYmxlKEFSUkFZX1NJWkUo
cHNfYnJpZGdlLT5zdXBwbGllcyksCisJCQkJICAgICBwc19icmlkZ2UtPnN1cHBsaWVzKTsKKwlp
ZiAoZXJyIDwgMCkKKwkJRFJNX0VSUk9SKCJjYW5ub3QgZGlzYWJsZSByZWd1bGF0b3JzICVkXG4i
LCBlcnIpOworCisJZXJyID0gZHJtX3BhbmVsX3VucHJlcGFyZShwc19icmlkZ2UtPnBhbmVsKTsK
KwlpZiAoZXJyKQorCQlEUk1fRVJST1IoImZhaWxlZCB0byB1bnByZXBhcmUgcGFuZWw6ICVkXG4i
LCBlcnIpOworfQorCitzdGF0aWMgaW50IHBzODY0MF9nZXRfbW9kZXMoc3RydWN0IGRybV9jb25u
ZWN0b3IgKmNvbm5lY3RvcikKK3sKKwlzdHJ1Y3QgcHM4NjQwICpwc19icmlkZ2UgPSBjb25uZWN0
b3JfdG9fcHM4NjQwKGNvbm5lY3Rvcik7CisJc3RydWN0IGVkaWQgKmVkaWQ7CisJaW50IG51bV9t
b2RlcyA9IDA7CisJYm9vbCBwb3dlcl9vZmY7CisKKwlpZiAocHNfYnJpZGdlLT5lZGlkKQorCQly
ZXR1cm4gZHJtX2FkZF9lZGlkX21vZGVzKGNvbm5lY3RvciwgcHNfYnJpZGdlLT5lZGlkKTsKKwor
CXBvd2VyX29mZiA9ICFwc19icmlkZ2UtPmVuYWJsZWQ7CisJcHM4NjQwX3ByZV9lbmFibGUoJnBz
X2JyaWRnZS0+YnJpZGdlKTsKKworCWVkaWQgPSBkcm1fZ2V0X2VkaWQoY29ubmVjdG9yLCBwc19i
cmlkZ2UtPnBhZ2VbMF0tPmFkYXB0ZXIpOworCWlmICghZWRpZCkKKwkJZ290byBvdXQ7CisKKwlw
c19icmlkZ2UtPmVkaWQgPSBlZGlkOworCWRybV9jb25uZWN0b3JfdXBkYXRlX2VkaWRfcHJvcGVy
dHkoY29ubmVjdG9yLCBwc19icmlkZ2UtPmVkaWQpOworCW51bV9tb2RlcyA9IGRybV9hZGRfZWRp
ZF9tb2Rlcyhjb25uZWN0b3IsIHBzX2JyaWRnZS0+ZWRpZCk7CisKK291dDoKKwlpZiAocG93ZXJf
b2ZmKQorCQlwczg2NDBfcG9zdF9kaXNhYmxlKCZwc19icmlkZ2UtPmJyaWRnZSk7CisKKwlyZXR1
cm4gbnVtX21vZGVzOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3JfaGVs
cGVyX2Z1bmNzIHBzODY0MF9jb25uZWN0b3JfaGVscGVyX2Z1bmNzID0geworCS5nZXRfbW9kZXMg
PSBwczg2NDBfZ2V0X21vZGVzLAorfTsKKworc3RhdGljIGVudW0gZHJtX2Nvbm5lY3Rvcl9zdGF0
dXMgcHM4NjQwX2RldGVjdChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAorCQkJCQkg
ICAgICAgYm9vbCBmb3JjZSkKK3sKKwlyZXR1cm4gY29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQ7
Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9mdW5jcyBwczg2NDBfY29u
bmVjdG9yX2Z1bmNzID0geworCS5maWxsX21vZGVzID0gZHJtX2hlbHBlcl9wcm9iZV9zaW5nbGVf
Y29ubmVjdG9yX21vZGVzLAorCS5kZXRlY3QgPSBwczg2NDBfZGV0ZWN0LAorCS5yZXNldCA9IGRy
bV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9yZXNldCwKKwkuYXRvbWljX2R1cGxpY2F0ZV9zdGF0
ZSA9IGRybV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9kdXBsaWNhdGVfc3RhdGUsCisJLmF0b21p
Y19kZXN0cm95X3N0YXRlID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2Rlc3Ryb3lfc3Rh
dGUsCit9OworCitpbnQgcHM4NjQwX2JyaWRnZV9hdHRhY2goc3RydWN0IGRybV9icmlkZ2UgKmJy
aWRnZSkKK3sKKwlzdHJ1Y3QgcHM4NjQwICpwc19icmlkZ2UgPSBicmlkZ2VfdG9fcHM4NjQwKGJy
aWRnZSk7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJnBzX2JyaWRnZS0+cGFnZVswXS0+ZGV2Owor
CXN0cnVjdCBkZXZpY2Vfbm9kZSAqaW5fZXAsICpkc2lfbm9kZSA9IE5VTEw7CisJc3RydWN0IG1p
cGlfZHNpX2RldmljZSAqZHNpOworCXN0cnVjdCBtaXBpX2RzaV9ob3N0ICpob3N0ID0gTlVMTDsK
KwlpbnQgcmV0OworCWNvbnN0IHN0cnVjdCBtaXBpX2RzaV9kZXZpY2VfaW5mbyBpbmZvID0geyAu
dHlwZSA9ICJwczg2NDAiLAorCQkJCQkJICAgLmNoYW5uZWwgPSAwLAorCQkJCQkJICAgLm5vZGUg
PSBOVUxMLAorCQkJCQkJIH07CisKKwlyZXQgPSBkcm1fY29ubmVjdG9yX2luaXQoYnJpZGdlLT5k
ZXYsICZwc19icmlkZ2UtPmNvbm5lY3RvciwKKwkJCQkgJnBzODY0MF9jb25uZWN0b3JfZnVuY3Ms
CisJCQkJIERSTV9NT0RFX0NPTk5FQ1RPUl9lRFApOworCisJaWYgKHJldCkgeworCQlEUk1fRVJS
T1IoIkZhaWxlZCB0byBpbml0aWFsaXplIGNvbm5lY3RvciB3aXRoIGRybTogJWRcbiIsIHJldCk7
CisJCXJldHVybiByZXQ7CisJfQorCisJZHJtX2Nvbm5lY3Rvcl9oZWxwZXJfYWRkKCZwc19icmlk
Z2UtPmNvbm5lY3RvciwKKwkJCQkgJnBzODY0MF9jb25uZWN0b3JfaGVscGVyX2Z1bmNzKTsKKwor
CXBzX2JyaWRnZS0+Y29ubmVjdG9yLmRwbXMgPSBEUk1fTU9ERV9EUE1TX09OOworCWRybV9jb25u
ZWN0b3JfYXR0YWNoX2VuY29kZXIoJnBzX2JyaWRnZS0+Y29ubmVjdG9yLAorCQkJCQkgIGJyaWRn
ZS0+ZW5jb2Rlcik7CisKKwlpZiAocHNfYnJpZGdlLT5wYW5lbCkKKwkJZHJtX3BhbmVsX2F0dGFj
aChwc19icmlkZ2UtPnBhbmVsLCAmcHNfYnJpZGdlLT5jb25uZWN0b3IpOworCisJLyogcG9ydEAw
IGlzIHBzODY0MCBkc2kgaW5wdXQgcG9ydCAqLworCWluX2VwID0gb2ZfZ3JhcGhfZ2V0X2VuZHBv
aW50X2J5X3JlZ3MoZGV2LT5vZl9ub2RlLCAwLCAtMSk7CisJaWYgKGluX2VwKSB7CisJCWRzaV9u
b2RlID0gb2ZfZ3JhcGhfZ2V0X3JlbW90ZV9wb3J0X3BhcmVudChpbl9lcCk7CisJCW9mX25vZGVf
cHV0KGluX2VwKTsKKwl9CisKKwlpZiAoZHNpX25vZGUpIHsKKwkJaG9zdCA9IG9mX2ZpbmRfbWlw
aV9kc2lfaG9zdF9ieV9ub2RlKGRzaV9ub2RlKTsKKwkJb2Zfbm9kZV9wdXQoZHNpX25vZGUpOwor
CQlpZiAoIWhvc3QpIHsKKwkJCXJldCA9IC1FTk9ERVY7CisJCQlnb3RvIGVycjsKKwkJfQorCX0K
KworCWRzaSA9IG1pcGlfZHNpX2RldmljZV9yZWdpc3Rlcl9mdWxsKGhvc3QsICZpbmZvKTsKKwlp
ZiAoSVNfRVJSKGRzaSkpIHsKKwkJZGV2X2VycihkZXYsICJmYWlsZWQgdG8gY3JlYXRlIGRzaSBk
ZXZpY2VcbiIpOworCQlyZXQgPSBQVFJfRVJSKGRzaSk7CisJCWdvdG8gZXJyOworCX0KKworCXBz
X2JyaWRnZS0+ZHNpID0gZHNpOworCisJZHNpLT5ob3N0ID0gaG9zdDsKKwlkc2ktPm1vZGVfZmxh
Z3MgPSBNSVBJX0RTSV9NT0RFX1ZJREVPIHwKKwkJCQkgICAgIE1JUElfRFNJX01PREVfVklERU9f
U1lOQ19QVUxTRTsKKwlkc2ktPmZvcm1hdCA9IE1JUElfRFNJX0ZNVF9SR0I4ODg7CisJZHNpLT5s
YW5lcyA9IDQ7CisJcmV0ID0gbWlwaV9kc2lfYXR0YWNoKGRzaSk7CisJaWYgKHJldCkKKwkJZ290
byBlcnJfZHNpX2F0dGFjaDsKKworCXJldHVybiAwOworCitlcnJfZHNpX2F0dGFjaDoKKwltaXBp
X2RzaV9kZXZpY2VfdW5yZWdpc3Rlcihkc2kpOworZXJyOgorCWlmIChwc19icmlkZ2UtPnBhbmVs
KQorCQlkcm1fcGFuZWxfZGV0YWNoKHBzX2JyaWRnZS0+cGFuZWwpOworCWRybV9jb25uZWN0b3Jf
Y2xlYW51cCgmcHNfYnJpZGdlLT5jb25uZWN0b3IpOworCXJldHVybiByZXQ7Cit9CisKK3N0YXRp
YyBjb25zdCBzdHJ1Y3QgZHJtX2JyaWRnZV9mdW5jcyBwczg2NDBfYnJpZGdlX2Z1bmNzID0gewor
CS5hdHRhY2ggPSBwczg2NDBfYnJpZGdlX2F0dGFjaCwKKwkuZGlzYWJsZSA9IHBzODY0MF9kaXNh
YmxlLAorCS5wb3N0X2Rpc2FibGUgPSBwczg2NDBfcG9zdF9kaXNhYmxlLAorCS5wcmVfZW5hYmxl
ID0gcHM4NjQwX3ByZV9lbmFibGUsCisJLmVuYWJsZSA9IHBzODY0MF9lbmFibGUsCit9OworCisv
KiBGaXJtd2FyZSBWZXJzaW9uIGlzIHJldHVybmVkIGFzIE1ham9yLk1pbm9yICovCitzdGF0aWMg
c3NpemVfdCBmd192ZXJzaW9uX3Nob3coc3RydWN0IGRldmljZSAqZGV2LAorCQkJCSAgICAgIHN0
cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCit7CisJc3RydWN0IHBzODY0
MCAqcHNfYnJpZGdlID0gZGV2X2dldF9kcnZkYXRhKGRldik7CisJc3RydWN0IHBzODY0MF9pbmZv
ICppbmZvID0gJnBzX2JyaWRnZS0+aW5mbzsKKworCXJldHVybiBzY25wcmludGYoYnVmLCBQQUdF
X1NJWkUsICIldS4ldVxuIiwgaW5mby0+dmVyc2lvbiA+PiA4LAorCQkJIGluZm8tPnZlcnNpb24g
JiAweGZmKTsKK30KKworLyogSGFyZHdhcmUgVmVyc2lvbiBpcyByZXR1cm5lZCBhcyBGYW1pbHlJ
RC5WYXJpYW50SUQgKi8KK3N0YXRpYyBzc2l6ZV90IGh3X3ZlcnNpb25fc2hvdyhzdHJ1Y3QgZGV2
aWNlICpkZXYsCisJCQkJICAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIg
KmJ1ZikKK3sKKwlzdHJ1Y3QgcHM4NjQwICpwc19icmlkZ2UgPSBkZXZfZ2V0X2RydmRhdGEoZGV2
KTsKKwlzdHJ1Y3QgcHM4NjQwX2luZm8gKmluZm8gPSAmcHNfYnJpZGdlLT5pbmZvOworCisJcmV0
dXJuIHNjbnByaW50ZihidWYsIFBBR0VfU0laRSwgInBzJXUuJXVcbiIsIGluZm8tPmZhbWlseV9p
ZCwKKwkJCSBpbmZvLT52YXJpYW50X2lkKTsKK30KKworc3RhdGljIERFVklDRV9BVFRSX1JPKGZ3
X3ZlcnNpb24pOworc3RhdGljIERFVklDRV9BVFRSX1JPKGh3X3ZlcnNpb24pOworCitzdGF0aWMg
c3RydWN0IGF0dHJpYnV0ZSAqcHM4NjQwX2F0dHJzW10gPSB7CisJJmRldl9hdHRyX2Z3X3ZlcnNp
b24uYXR0ciwKKwkmZGV2X2F0dHJfaHdfdmVyc2lvbi5hdHRyLAorCU5VTEwKK307CisKK3N0YXRp
YyBjb25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwIHBzODY0MF9hdHRyX2dyb3VwID0geworCS5h
dHRycyA9IHBzODY0MF9hdHRycywKK307CisKK3N0YXRpYyB2b2lkIHBzODY0MF9yZW1vdmVfc3lz
ZnNfZ3JvdXAodm9pZCAqZGF0YSkKK3sKKwlzdHJ1Y3QgcHM4NjQwICpwc19icmlkZ2UgPSBkYXRh
OworCisJc3lzZnNfcmVtb3ZlX2dyb3VwKCZwc19icmlkZ2UtPnBhZ2VbMF0tPmRldi5rb2JqLCAm
cHM4NjQwX2F0dHJfZ3JvdXApOworfQorCitzdGF0aWMgaW50IHBzODY0MF9wcm9iZShzdHJ1Y3Qg
aTJjX2NsaWVudCAqY2xpZW50LAorCQkJY29uc3Qgc3RydWN0IGkyY19kZXZpY2VfaWQgKmlkKQor
eworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjbGllbnQtPmRldjsKKwlzdHJ1Y3QgcHM4NjQwICpw
c19icmlkZ2U7CisJc3RydWN0IGRldmljZV9ub2RlICpucCA9IGRldi0+b2Zfbm9kZTsKKwlzdHJ1
Y3QgZGV2aWNlX25vZGUgKnBvcnQsICpvdXRfZXA7CisJc3RydWN0IGRldmljZV9ub2RlICpwYW5l
bF9ub2RlID0gTlVMTDsKKwlpbnQgcmV0OworCXUzMiBpOworCisJcHNfYnJpZGdlID0gZGV2bV9r
emFsbG9jKGRldiwgc2l6ZW9mKCpwc19icmlkZ2UpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIXBzX2Jy
aWRnZSkKKwkJcmV0dXJuIC1FTk9NRU07CisKKwkvKiBwb3J0QDEgaXMgcHM4NjQwIG91dHB1dCBw
b3J0ICovCisJcG9ydCA9IG9mX2dyYXBoX2dldF9wb3J0X2J5X2lkKG5wLCAxKTsKKwlpZiAocG9y
dCkgeworCQlvdXRfZXAgPSBvZl9nZXRfY2hpbGRfYnlfbmFtZShwb3J0LCAiZW5kcG9pbnQiKTsK
KwkJb2Zfbm9kZV9wdXQocG9ydCk7CisJCWlmIChvdXRfZXApIHsKKwkJCXBhbmVsX25vZGUgPSBv
Zl9ncmFwaF9nZXRfcmVtb3RlX3BvcnRfcGFyZW50KG91dF9lcCk7CisJCQlvZl9ub2RlX3B1dChv
dXRfZXApOworCQl9CisJfQorCWlmIChwYW5lbF9ub2RlKSB7CisJCXBzX2JyaWRnZS0+cGFuZWwg
PSBvZl9kcm1fZmluZF9wYW5lbChwYW5lbF9ub2RlKTsKKwkJb2Zfbm9kZV9wdXQocGFuZWxfbm9k
ZSk7CisJCWlmICghcHNfYnJpZGdlLT5wYW5lbCkKKwkJCXJldHVybiAtRVBST0JFX0RFRkVSOwor
CX0KKworCW11dGV4X2luaXQoJnBzX2JyaWRnZS0+ZndfbXV0ZXgpOworCXBzX2JyaWRnZS0+c3Vw
cGxpZXNbMF0uc3VwcGx5ID0gInZkZDMzIjsKKwlwc19icmlkZ2UtPnN1cHBsaWVzWzFdLnN1cHBs
eSA9ICJ2ZGQxMiI7CisJcmV0ID0gZGV2bV9yZWd1bGF0b3JfYnVsa19nZXQoZGV2LCBBUlJBWV9T
SVpFKHBzX2JyaWRnZS0+c3VwcGxpZXMpLAorCQkJCSAgICAgIHBzX2JyaWRnZS0+c3VwcGxpZXMp
OworCWlmIChyZXQpIHsKKwkJZGV2X2luZm8oZGV2LCAiZmFpbGVkIHRvIGdldCByZWd1bGF0b3Jz
OiAlZFxuIiwgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlwc19icmlkZ2UtPmdwaW9fbW9k
ZV9zZWwgPSBkZXZtX2dwaW9kX2dldF9vcHRpb25hbCgmY2xpZW50LT5kZXYsCisJCQkJCQkJICAg
ICAibW9kZS1zZWwiLAorCQkJCQkJCSAgICAgR1BJT0RfT1VUX0hJR0gpOworCWlmIChJU19FUlIo
cHNfYnJpZGdlLT5ncGlvX21vZGVfc2VsKSkgeworCQlyZXQgPSBQVFJfRVJSKHBzX2JyaWRnZS0+
Z3Bpb19tb2RlX3NlbCk7CisJCWRldl9lcnIoZGV2LCAiY2Fubm90IGdldCBtb2RlLXNlbCAlZFxu
IiwgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlwc19icmlkZ2UtPmdwaW9fcG93ZXJfZG93
biA9IGRldm1fZ3Bpb2RfZ2V0KCZjbGllbnQtPmRldiwgInNsZWVwIiwKKwkJCQkJICAgICAgIEdQ
SU9EX09VVF9MT1cpOworCWlmIChJU19FUlIocHNfYnJpZGdlLT5ncGlvX3Bvd2VyX2Rvd24pKSB7
CisJCXJldCA9IFBUUl9FUlIocHNfYnJpZGdlLT5ncGlvX3Bvd2VyX2Rvd24pOworCQlkZXZfZXJy
KGRldiwgImNhbm5vdCBnZXQgc2xlZXA6ICVkXG4iLCByZXQpOworCQlyZXR1cm4gcmV0OworCX0K
KworCS8qCisJICogUmVxdWVzdCB0aGUgcmVzZXQgcGluIGxvdyB0byBhdm9pZCB0aGUgYnJpZGdl
IGJlaW5nCisJICogaW5pdGlhbGl6ZWQgcHJlbWF0dXJlbHkKKwkgKi8KKwlwc19icmlkZ2UtPmdw
aW9fcmVzZXQgPSBkZXZtX2dwaW9kX2dldCgmY2xpZW50LT5kZXYsICJyZXNldCIsCisJCQkJCSAg
ICAgICBHUElPRF9PVVRfTE9XKTsKKwlpZiAoSVNfRVJSKHBzX2JyaWRnZS0+Z3Bpb19yZXNldCkp
IHsKKwkJcmV0ID0gUFRSX0VSUihwc19icmlkZ2UtPmdwaW9fcmVzZXQpOworCQlkZXZfZXJyKGRl
diwgImNhbm5vdCBnZXQgcmVzZXQ6ICVkXG4iLCByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKwor
CXBzX2JyaWRnZS0+YnJpZGdlLmZ1bmNzID0gJnBzODY0MF9icmlkZ2VfZnVuY3M7CisJcHNfYnJp
ZGdlLT5icmlkZ2Uub2Zfbm9kZSA9IGRldi0+b2Zfbm9kZTsKKworCXBzX2JyaWRnZS0+cGFnZVsw
XSA9IGNsaWVudDsKKworCS8qCisJICogcHM4NjQwIHVzZXMgbXVsdGlwbGUgYWRkcmVzc2VzLCB1
c2UgZHVtbXkgZGV2aWNlcyBmb3IgdGhlbQorCSAqIHBhZ2VbMF06IGZvciBEUCBjb250cm9sCisJ
ICogcGFnZVsxXTogZm9yIFZJREVPIEJyaWRnZQorCSAqIHBhZ2VbMl06IGZvciBjb250cm9sIHRv
cAorCSAqIHBhZ2VbM106IGZvciBEU0kgTGluayBDb250cm9sMQorCSAqIHBhZ2VbNF06IGZvciBN
SVBJIFBoeQorCSAqIHBhZ2VbNV06IGZvciBWUExMCisJICogcGFnZVs2XTogZm9yIERTSSBMaW5r
IENvbnRyb2wyCisJICogcGFnZVs3XTogZm9yIHNwaSByb20gbWFwcGluZworCSAqLworCWZvciAo
aSA9IDE7IGkgPCBNQVhfREVWUzsgaSsrKSB7CisJCXBzX2JyaWRnZS0+cGFnZVtpXSA9IGkyY19u
ZXdfZHVtbXkoY2xpZW50LT5hZGFwdGVyLAorCQkJCQkJICAgY2xpZW50LT5hZGRyICsgaSk7CisJ
CWlmICghcHNfYnJpZGdlLT5wYWdlW2ldKSB7CisJCQlkZXZfZXJyKGRldiwgImZhaWxlZCBpMmMg
ZHVtbXkgZGV2aWNlLCBhZGRyZXNzJTAyeFxuIiwKKwkJCQljbGllbnQtPmFkZHIgKyBpKTsKKwkJ
CXJldCA9IC1FQlVTWTsKKwkJCWdvdG8gZXhpdF9kdW1teTsKKwkJfQorCX0KKwlpMmNfc2V0X2Ns
aWVudGRhdGEoY2xpZW50LCBwc19icmlkZ2UpOworCisJcmV0ID0gc3lzZnNfY3JlYXRlX2dyb3Vw
KCZjbGllbnQtPmRldi5rb2JqLCAmcHM4NjQwX2F0dHJfZ3JvdXApOworCWlmIChyZXQpIHsKKwkJ
ZGV2X2VycihkZXYsICJmYWlsZWQgdG8gY3JlYXRlIHN5c2ZzIGVudHJpZXM6ICVkXG4iLCByZXQp
OworCQlnb3RvIGV4aXRfZHVtbXk7CisJfQorCisJcmV0ID0gZGV2bV9hZGRfYWN0aW9uKGRldiwg
cHM4NjQwX3JlbW92ZV9zeXNmc19ncm91cCwgcHNfYnJpZGdlKTsKKwlpZiAocmV0KSB7CisJCWRl
dl9lcnIoZGV2LCAiZmFpbGVkIHRvIGFkZCBzeXNmcyBjbGVhbnVwIGFjdGlvbjogJWRcbiIsIHJl
dCk7CisJCWdvdG8gZXhpdF9yZW1vdmVfc3lzZnM7CisJfQorCisJZHJtX2JyaWRnZV9hZGQoJnBz
X2JyaWRnZS0+YnJpZGdlKTsKKwlyZXR1cm4gMDsKKworZXhpdF9yZW1vdmVfc3lzZnM6CisJc3lz
ZnNfcmVtb3ZlX2dyb3VwKCZwc19icmlkZ2UtPnBhZ2VbMF0tPmRldi5rb2JqLCAmcHM4NjQwX2F0
dHJfZ3JvdXApOworZXhpdF9kdW1teToKKwl3aGlsZSAoLS1pKQorCQlpMmNfdW5yZWdpc3Rlcl9k
ZXZpY2UocHNfYnJpZGdlLT5wYWdlW2ldKTsKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50
IHBzODY0MF9yZW1vdmUoc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCkKK3sKKwlzdHJ1Y3QgcHM4
NjQwICpwc19icmlkZ2UgPSBpMmNfZ2V0X2NsaWVudGRhdGEoY2xpZW50KTsKKwlpbnQgaSA9IE1B
WF9ERVZTOworCisJZHJtX2JyaWRnZV9yZW1vdmUoJnBzX2JyaWRnZS0+YnJpZGdlKTsKKwlzeXNm
c19yZW1vdmVfZ3JvdXAoJnBzX2JyaWRnZS0+cGFnZVswXS0+ZGV2LmtvYmosICZwczg2NDBfYXR0
cl9ncm91cCk7CisJd2hpbGUgKC0taSkKKwkJaTJjX3VucmVnaXN0ZXJfZGV2aWNlKHBzX2JyaWRn
ZS0+cGFnZVtpXSk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBpMmNf
ZGV2aWNlX2lkIHBzODY0MF9pMmNfdGFibGVbXSA9IHsKKwl7ICJwczg2NDAiLCAwIH0sCisJeyAv
KiBzZW50aW5lbCAqLyB9LAorfTsKK01PRFVMRV9ERVZJQ0VfVEFCTEUoaTJjLCBwczg2NDBfaTJj
X3RhYmxlKTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBvZl9kZXZpY2VfaWQgcHM4NjQwX21hdGNo
W10gPSB7CisJeyAuY29tcGF0aWJsZSA9ICJwYXJhZGUscHM4NjQwIiB9LAorCXsgLyogc2VudGlu
ZWwgKi8gfSwKK307CitNT0RVTEVfREVWSUNFX1RBQkxFKG9mLCBwczg2NDBfbWF0Y2gpOworCitz
dGF0aWMgc3RydWN0IGkyY19kcml2ZXIgcHM4NjQwX2RyaXZlciA9IHsKKwkuaWRfdGFibGUgPSBw
czg2NDBfaTJjX3RhYmxlLAorCS5wcm9iZSA9IHBzODY0MF9wcm9iZSwKKwkucmVtb3ZlID0gcHM4
NjQwX3JlbW92ZSwKKwkuZHJpdmVyID0geworCQkubmFtZSA9ICJwczg2NDAiLAorCQkub2ZfbWF0
Y2hfdGFibGUgPSBwczg2NDBfbWF0Y2gsCisJfSwKK307Cittb2R1bGVfaTJjX2RyaXZlcihwczg2
NDBfZHJpdmVyKTsKKworTU9EVUxFX0FVVEhPUigiSml0YW8gU2hpIDxqaXRhby5zaGlAbWVkaWF0
ZWsuY29tPiIpOworTU9EVUxFX0FVVEhPUigiQ0sgSHUgPGNrLmh1QG1lZGlhdGVrLmNvbT4iKTsK
K01PRFVMRV9ERVNDUklQVElPTigiUEFSQURFIHBzODY0MCBEU0ktZURQIGNvbnZlcnRlciBkcml2
ZXIiKTsKK01PRFVMRV9MSUNFTlNFKCJHUEwgdjIiKTsKLS0gCjIuNy40CgpfX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0
CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3Rv
cC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
