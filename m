Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id EBDBB9532B
	for <lists+dri-devel@lfdr.de>; Tue, 20 Aug 2019 03:18:38 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9687D6E58B;
	Tue, 20 Aug 2019 01:18:18 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from perceval.ideasonboard.com (perceval.ideasonboard.com
 [213.167.242.64])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BA5506E52C
 for <dri-devel@lists.freedesktop.org>; Tue, 20 Aug 2019 01:17:57 +0000 (UTC)
Received: from pendragon.bb.dnainternet.fi
 (dfj612yhrgyx302h3jwwy-3.rev.dnainternet.fi
 [IPv6:2001:14ba:21f5:5b00:ce28:277f:58d7:3ca4])
 by perceval.ideasonboard.com (Postfix) with ESMTPSA id 810B2510;
 Tue, 20 Aug 2019 03:17:51 +0200 (CEST)
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v2 28/50] drm/omap: hdmi5: Register a drm_bridge for EDID read
Date: Tue, 20 Aug 2019 04:16:59 +0300
Message-Id: <20190820011721.30136-29-laurent.pinchart@ideasonboard.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190820011721.30136-1-laurent.pinchart@ideasonboard.com>
References: <20190820011721.30136-1-laurent.pinchart@ideasonboard.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=ideasonboard.com; s=mail; t=1566263871;
 bh=sJXcAQgtgfE5BEAUqOoKJV4MVa6Hvb/BXR/1B72lOZo=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=kbM/7T3xH9d5nWjJKFNar01qBjPDK+Rh9i9r71sVF4Hjvr7yiNqLExQ6bW7Rizmk+
 6PwxZa05k6GHiZOyck8KKVwTyLvFlf+4Yo77Ba1hPa1UNS7r/ziAIZqc8JYiqo0GHv
 dHqUHK2jsCD4WbtNCWd+UBGv+rkK6s8Ii1V9zaAk=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Maxime Ripard <maxime.ripard@bootlin.com>,
 Tomi Valkeinen <tomi.valkeinen@ti.com>, Sean Paul <sean@poorly.run>,
 Sebastian Reichel <sebastian.reichel@collabora.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW4gb3JkZXIgdG8gaW50ZWdyYXRlIHdpdGggYSBjaGFpbiBvZiBkcm1fYnJpZGdlLCB0aGUgaW50
ZXJuYWwgSERNSTUKZW5jb2RlciBoYXMgdG8gZXhwb3NlIHRoZSBFRElEIHJlYWQgb3BlcmF0aW9u
IHRocm91Z2ggdGhlIGRybV9icmlkZ2UKQVBJLiBSZWdpc3RlciBhIGJyaWRnZSBhdCBpbml0aWFs
aXNhdGlvbiB0aW1lIHRvIGRvIHNvLgoKRm9yIHRoZSB0aW1lIGJlaW5nIG1ha2UgdGhlIG5leHQg
YnJpZGdlIGluIHRoZSBjaGFpbiBvcHRpb25hbCBhcyB0aGUKSERNSSBvdXRwdXQgaXMgc3RpbGwg
YmFzZWQgb24gb21hcF9kc3NfZGV2aWNlLiBUaGUgY3JlYXRlX2Nvbm5lY3Rvcgphcmd1bWVudCB0
byB0aGUgYnJpZGdlIGF0dGFjaCBmdW5jdGlvbiBpcyBhbHNvIGlnbm9yZWQgZm9yIHRoZSBzYW1l
CnJlYXNvbi4gVGhpcyB3aWxsIGJlIGNoYW5nZWQgbGF0ZXIgd2hlbiByZW1vdmluZyB0aGUgcmVs
YXRlZApvbWFwZHJtLXNwZWNpZmljIGRpc3BsYXkgZHJpdmVycy4KClNpZ25lZC1vZmYtYnk6IExh
dXJlbnQgUGluY2hhcnQgPGxhdXJlbnQucGluY2hhcnRAaWRlYXNvbmJvYXJkLmNvbT4KLS0tCiBk
cml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3MvaGRtaTUuYyB8IDc1ICsrKysrKysrKysrKysrKysr
KysrKysrKysrKy0tCiAxIGZpbGUgY2hhbmdlZCwgNzAgaW5zZXJ0aW9ucygrKSwgNSBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3MvaGRtaTUuYyBi
L2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL2Rzcy9oZG1pNS5jCmluZGV4IDJiMDJiMGExMTY5Ni4u
YTg5NWVkMTU5OTgxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3MvaGRt
aTUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3MvaGRtaTUuYwpAQCAtMzg4LDgg
KzM4OCwxMCBAQCBzdGF0aWMgdm9pZCBoZG1pX2Rpc2Nvbm5lY3Qoc3RydWN0IG9tYXBfZHNzX2Rl
dmljZSAqc3JjLAogCiAjZGVmaW5lIE1BWF9FRElECTUxMgogCi1zdGF0aWMgc3RydWN0IGVkaWQg
KmhkbWlfcmVhZF9lZGlkX2RhdGEoc3RydWN0IGhkbWlfY29yZV9kYXRhICpjb3JlKQorc3RhdGlj
IHN0cnVjdCBlZGlkICpoZG1pX3JlYWRfZWRpZF9kYXRhKHN0cnVjdCBvbWFwX2hkbWkgKmhkbWks
CisJCQkJCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCiB7CisJc3RydWN0IGhkbWlf
Y29yZV9kYXRhICpjb3JlID0gJmhkbWktPmNvcmU7CiAJaW50IG1heF9leHRfYmxvY2tzID0gMzsK
IAlpbnQgciwgbiwgaTsKIAl1OCAqZWRpZDsKQEAgLTQyMSw5ICs0MjMsMTIgQEAgc3RhdGljIHN0
cnVjdCBlZGlkICpoZG1pX3JlYWRfZWRpZF9kYXRhKHN0cnVjdCBoZG1pX2NvcmVfZGF0YSAqY29y
ZSkKIAlyZXR1cm4gTlVMTDsKIH0KIAotc3RhdGljIHN0cnVjdCBlZGlkICpoZG1pX3JlYWRfZWRp
ZChzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpkc3NkZXYpCitzdGF0aWMgc3RydWN0IGVkaWQgKgor
aGRtaV9kb19yZWFkX2VkaWQoc3RydWN0IG9tYXBfaGRtaSAqaGRtaSwKKwkJICBzdHJ1Y3QgZWRp
ZCAqKCpyZWFkKShzdHJ1Y3Qgb21hcF9oZG1pICpoZG1pLAorCQkJCSAgICAgICBzdHJ1Y3QgZHJt
X2Nvbm5lY3RvciAqY29ubmVjdG9yKSwKKwkJICBzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVj
dG9yKQogewotCXN0cnVjdCBvbWFwX2hkbWkgKmhkbWkgPSBkc3NkZXZfdG9faGRtaShkc3NkZXYp
OwogCXN0cnVjdCBlZGlkICplZGlkOwogCWJvb2wgbmVlZF9lbmFibGU7CiAJaW50IGlkbGVtb2Rl
OwpAQCAtNDQ3LDcgKzQ1Miw3IEBAIHN0YXRpYyBzdHJ1Y3QgZWRpZCAqaGRtaV9yZWFkX2VkaWQo
c3RydWN0IG9tYXBfZHNzX2RldmljZSAqZHNzZGV2KQogCiAJaGRtaTVfY29yZV9kZGNfaW5pdCgm
aGRtaS0+Y29yZSk7CiAKLQllZGlkID0gaGRtaV9yZWFkX2VkaWRfZGF0YSgmaGRtaS0+Y29yZSk7
CisJZWRpZCA9IHJlYWQoaGRtaSwgY29ubmVjdG9yKTsKIAogCWhkbWk1X2NvcmVfZGRjX3VuaW5p
dCgmaGRtaS0+Y29yZSk7CiAKQEAgLTQ2Miw2ICs0NjcsMTIgQEAgc3RhdGljIHN0cnVjdCBlZGlk
ICpoZG1pX3JlYWRfZWRpZChzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpkc3NkZXYpCiAJcmV0dXJu
IChzdHJ1Y3QgZWRpZCAqKWVkaWQ7CiB9CiAKK3N0YXRpYyBzdHJ1Y3QgZWRpZCAqaGRtaV9yZWFk
X2VkaWQoc3RydWN0IG9tYXBfZHNzX2RldmljZSAqZHNzZGV2KQoreworCXJldHVybiBoZG1pX2Rv
X3JlYWRfZWRpZChkc3NkZXZfdG9faGRtaShkc3NkZXYpLCBoZG1pX3JlYWRfZWRpZF9kYXRhLAor
CQkJCSBOVUxMKTsKK30KKwogc3RhdGljIGludCBoZG1pX3NldF9pbmZvZnJhbWUoc3RydWN0IG9t
YXBfZHNzX2RldmljZSAqZHNzZGV2LAogCQljb25zdCBzdHJ1Y3QgaGRtaV9hdmlfaW5mb2ZyYW1l
ICphdmkpCiB7CkBAIC00OTcsNiArNTA4LDU2IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3Qgb21hcF9k
c3NfZGV2aWNlX29wcyBoZG1pX29wcyA9IHsKIAl9LAogfTsKIAorLyogLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0KKyAqIERSTSBCcmlkZ2UgT3BlcmF0aW9ucworICovCisKK3N0YXRpYyBpbnQgaGRtaTVf
YnJpZGdlX2F0dGFjaChzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAorCQkJICAgICAgIGVudW0g
ZHJtX2JyaWRnZV9hdHRhY2hfZmxhZ3MgZmxhZ3MpCit7CisJc3RydWN0IG9tYXBfaGRtaSAqaGRt
aSA9IGRybV9icmlkZ2VfdG9faGRtaShicmlkZ2UpOworCisJaWYgKCFoZG1pLT5vdXRwdXQubmV4
dF9icmlkZ2UpCisJCXJldHVybiAwOworCisJcmV0dXJuIGRybV9icmlkZ2VfYXR0YWNoKGJyaWRn
ZS0+ZW5jb2RlciwgaGRtaS0+b3V0cHV0Lm5leHRfYnJpZGdlLAorCQkJCSBicmlkZ2UsIGZsYWdz
KTsKK30KKworc3RhdGljIHN0cnVjdCBlZGlkICpoZG1pNV9icmlkZ2VfcmVhZF9lZGlkKHN0cnVj
dCBvbWFwX2hkbWkgKmhkbWksCisJCQkJCSAgIHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0
b3IpCit7CisJcmV0dXJuIGRybV9kb19nZXRfZWRpZChjb25uZWN0b3IsIGhkbWk1X2NvcmVfZGRj
X3JlYWQsICZoZG1pLT5jb3JlKTsKK30KKworc3RhdGljIHN0cnVjdCBlZGlkICpoZG1pNV9icmlk
Z2VfZ2V0X2VkaWQoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSwKKwkJCQkJICBzdHJ1Y3QgZHJt
X2Nvbm5lY3RvciAqY29ubmVjdG9yKQoreworCXN0cnVjdCBvbWFwX2hkbWkgKmhkbWkgPSBkcm1f
YnJpZGdlX3RvX2hkbWkoYnJpZGdlKTsKKworCXJldHVybiBoZG1pX2RvX3JlYWRfZWRpZChoZG1p
LCBoZG1pNV9icmlkZ2VfcmVhZF9lZGlkLCBjb25uZWN0b3IpOworfQorCitzdGF0aWMgY29uc3Qg
c3RydWN0IGRybV9icmlkZ2VfZnVuY3MgaGRtaTVfYnJpZGdlX2Z1bmNzID0geworCS5hdHRhY2gg
PSBoZG1pNV9icmlkZ2VfYXR0YWNoLAorCS5nZXRfZWRpZCA9IGhkbWk1X2JyaWRnZV9nZXRfZWRp
ZCwKK307CisKK3N0YXRpYyB2b2lkIGhkbWk1X2JyaWRnZV9pbml0KHN0cnVjdCBvbWFwX2hkbWkg
KmhkbWkpCit7CisJaGRtaS0+YnJpZGdlLmZ1bmNzID0gJmhkbWk1X2JyaWRnZV9mdW5jczsKKwlo
ZG1pLT5icmlkZ2Uub2Zfbm9kZSA9IGhkbWktPnBkZXYtPmRldi5vZl9ub2RlOworCWhkbWktPmJy
aWRnZS5vcHMgPSBEUk1fQlJJREdFX09QX0VESUQ7CisJaGRtaS0+YnJpZGdlLnR5cGUgPSBEUk1f
TU9ERV9DT05ORUNUT1JfSERNSUE7CisKKwlkcm1fYnJpZGdlX2FkZCgmaGRtaS0+YnJpZGdlKTsK
K30KKworc3RhdGljIHZvaWQgaGRtaTVfYnJpZGdlX2NsZWFudXAoc3RydWN0IG9tYXBfaGRtaSAq
aGRtaSkKK3sKKwlkcm1fYnJpZGdlX3JlbW92ZSgmaGRtaS0+YnJpZGdlKTsKK30KKwogLyogLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0KICAqIEF1ZGlvIENhbGxiYWNrcwogICovCkBAIC02NzksNiArNzQw
LDggQEAgc3RhdGljIGludCBoZG1pNV9pbml0X291dHB1dChzdHJ1Y3Qgb21hcF9oZG1pICpoZG1p
KQogCXN0cnVjdCBvbWFwX2Rzc19kZXZpY2UgKm91dCA9ICZoZG1pLT5vdXRwdXQ7CiAJaW50IHI7
CiAKKwloZG1pNV9icmlkZ2VfaW5pdChoZG1pKTsKKwogCW91dC0+ZGV2ID0gJmhkbWktPnBkZXYt
PmRldjsKIAlvdXQtPmlkID0gT01BUF9EU1NfT1VUUFVUX0hETUk7CiAJb3V0LT50eXBlID0gT01B
UF9ESVNQTEFZX1RZUEVfSERNSTsKQEAgLTY4OSw3ICs3NTIsNyBAQCBzdGF0aWMgaW50IGhkbWk1
X2luaXRfb3V0cHV0KHN0cnVjdCBvbWFwX2hkbWkgKmhkbWkpCiAJb3V0LT5vZl9wb3J0ID0gMDsK
IAlvdXQtPm9wc19mbGFncyA9IE9NQVBfRFNTX0RFVklDRV9PUF9FRElEOwogCi0JciA9IG9tYXBk
c3NfZGV2aWNlX2luaXRfb3V0cHV0KG91dCwgTlVMTCk7CisJciA9IG9tYXBkc3NfZGV2aWNlX2lu
aXRfb3V0cHV0KG91dCwgJmhkbWktPmJyaWRnZSk7CiAJaWYgKHIgPCAwKQogCQlyZXR1cm4gcjsK
IApAQCAtNzA0LDYgKzc2Nyw4IEBAIHN0YXRpYyB2b2lkIGhkbWk1X3VuaW5pdF9vdXRwdXQoc3Ry
dWN0IG9tYXBfaGRtaSAqaGRtaSkKIAogCW9tYXBkc3NfZGV2aWNlX3VucmVnaXN0ZXIob3V0KTsK
IAlvbWFwZHNzX2RldmljZV9jbGVhbnVwX291dHB1dChvdXQpOworCisJaGRtaTVfYnJpZGdlX2Ns
ZWFudXAoaGRtaSk7CiB9CiAKIHN0YXRpYyBpbnQgaGRtaTVfcHJvYmVfb2Yoc3RydWN0IG9tYXBf
aGRtaSAqaGRtaSkKLS0gClJlZ2FyZHMsCgpMYXVyZW50IFBpbmNoYXJ0CgpfX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0
CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3Rv
cC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
