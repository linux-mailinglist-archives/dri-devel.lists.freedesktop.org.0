Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 79976B4F0A
	for <lists+dri-devel@lfdr.de>; Tue, 17 Sep 2019 15:23:13 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B46236EC6E;
	Tue, 17 Sep 2019 13:23:10 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x544.google.com (mail-ed1-x544.google.com
 [IPv6:2a00:1450:4864:20::544])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5DC2C6EC68
 for <dri-devel@lists.freedesktop.org>; Tue, 17 Sep 2019 13:23:09 +0000 (UTC)
Received: by mail-ed1-x544.google.com with SMTP id h33so3271432edh.12
 for <dri-devel@lists.freedesktop.org>; Tue, 17 Sep 2019 06:23:09 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:sender:date:from:to:cc:subject:message-id
 :mail-followup-to:references:mime-version:content-disposition
 :in-reply-to:user-agent;
 bh=1SWRftNvzxWOKqVnmLJOgwarluQctTJe9TpYjYM6L1A=;
 b=XPR3vw7y9eQszl6CXf0/vWwhpx1krkIxCwLHGdpwhGFvK+QgJKyFuYlClij0o13aFq
 BKM34b7ZgCioHU5DpCFYkQmEaCNLg/hpI5gQ8+3MOfdcZKt3jKO0cP/D7OaYjjN+Jfay
 GlO+j23SJQY/OVhohkTF7Ysl9hsKtavDbPMVAmrzVqIem8+cF5LGxK6H2KCY3ihlz664
 UfpYmp5cEdYQGtdpWMjgkzPhPz084/gF7lH12CI6JTt/bnMP/4nWoiaR2aaUZzCXt9qG
 XmDvMR+mKR2mkhvR/rfTgrbF55RuODIuydThhn0BMIys1OCYTkYgaRLiRHgVrhaQDrzG
 AeUQ==
X-Gm-Message-State: APjAAAW1F4mMGqNi16pp7V/W9KgyhxLfIBZzv4Mcychu7jnVeaiI710Q
 ZXlSRBuaqt1NC/GWqhssTrGxbw==
X-Google-Smtp-Source: APXvYqzeXgZKLYose3Ug8/PgepGFRWs0DLYGdo48jxuYITXu325okDnpdIkY2tTOdj7awDsOSqPKGA==
X-Received: by 2002:a17:906:2542:: with SMTP id
 j2mr4877303ejb.278.1568726587875; 
 Tue, 17 Sep 2019 06:23:07 -0700 (PDT)
Received: from phenom.ffwll.local (212-51-149-96.fiber7.init7.net.
 [212.51.149.96])
 by smtp.gmail.com with ESMTPSA id h3sm278607ejp.77.2019.09.17.06.23.06
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 17 Sep 2019 06:23:07 -0700 (PDT)
Date: Tue, 17 Sep 2019 15:23:05 +0200
From: Daniel Vetter <daniel@ffwll.ch>
To: Tomasz Figa <tfiga@chromium.org>
Subject: Re: [RFC PATCH] drm/virtio: Export resource handles via DMA-buf API
Message-ID: <20190917132305.GV3958@phenom.ffwll.local>
Mail-Followup-To: Tomasz Figa <tfiga@chromium.org>,
 David Airlie <airlied@linux.ie>, Gerd Hoffmann <kraxel@redhat.com>,
 dri-devel@lists.freedesktop.org,
 virtualization@lists.linux-foundation.org,
 linux-kernel@vger.kernel.org, stevensd@chromium.org,
 marcheu@chromium.org, zachr@chromium.org, keiichiw@chromium.org,
 posciak@chromium.org
References: <20190912094121.228435-1-tfiga@chromium.org>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <20190912094121.228435-1-tfiga@chromium.org>
X-Operating-System: Linux phenom 5.2.0-2-amd64 
User-Agent: Mutt/1.10.1 (2018-07-13)
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ffwll.ch; s=google;
 h=sender:date:from:to:cc:subject:message-id:mail-followup-to
 :references:mime-version:content-disposition:in-reply-to:user-agent;
 bh=1SWRftNvzxWOKqVnmLJOgwarluQctTJe9TpYjYM6L1A=;
 b=ZPEVLQWhUlTBW0nB55ahotiqBPB+FgyfBilgSwzVG85vW/xu+mkehr2ZEpPQwEVxi9
 M5rzP3sPHQj1DOAEPj32rPebczosoVfAsUgUePocjzLYtjxztpenohIJXQVkKj9pvLys
 PzOcIQjCrAFIasBqbv0OFUHgEzFBSyIOS5Wa0=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: zachr@chromium.org, David Airlie <airlied@linux.ie>,
 linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org,
 virtualization@lists.linux-foundation.org, keiichiw@chromium.org,
 Gerd Hoffmann <kraxel@redhat.com>, marcheu@chromium.org, posciak@chromium.org,
 stevensd@chromium.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gVGh1LCBTZXAgMTIsIDIwMTkgYXQgMDY6NDE6MjFQTSArMDkwMCwgVG9tYXN6IEZpZ2Egd3Jv
dGU6Cj4gVGhpcyBwYXRjaCBpcyBhbiBlYXJseSBSRkMgdG8ganVkZ2UgdGhlIGRpcmVjdGlvbiB3
ZSBhcmUgZm9sbG93aW5nIGluCj4gb3VyIHZpcnR1YWxpemF0aW9uIGVmZm9ydHMgaW4gQ2hyb21l
IE9TLiBUaGUgcHVycG9zZSBpcyB0byBzdGFydCBhCj4gZGlzY3Vzc2lvbiBvbiBob3cgdG8gaGFu
ZGxlIGJ1ZmZlciBzaGFyaW5nIGJldHdlZW4gbXVsdGlwbGUgdmlydGlvCj4gZGV2aWNlcy4KPiAK
PiBPbiBhIHNpZGUgbm90ZSwgd2UgYXJlIGFsc28gd29ya2luZyBvbiBhIHZpcnRpbyB2aWRlbyBk
ZWNvZGVyIGludGVyZmFjZQo+IGFuZCBpbXBsZW1lbnRhdGlvbiwgd2l0aCBhIFY0TDIgZHJpdmVy
IGZvciBMaW51eC4gVGhvc2Ugd2lsbCBiZSBwb3N0ZWQKPiBmb3IgcmV2aWV3IGluIHRoZSBuZWFy
IGZ1dHVyZSBhcyB3ZWxsLgo+IAo+IEFueSBmZWVkYmFjayB3aWxsIGJlIGFwcHJlY2lhdGVkISBU
aGFua3MgaW4gYWR2YW5jZS4KPiAKPiA9PT0KPiAKPiBXaXRoIHRoZSByYW5nZSBvZiB1c2UgY2Fz
ZXMgZm9yIHZpcnR1YWxpemF0aW9uIGV4cGFuZGluZywgdGhlcmUgaXMgZ29pbmcKPiB0byBiZSBt
b3JlIHZpcnRpbyBkZXZpY2VzIGFkZGVkIHRvIHRoZSBlY29zeXN0ZW0uIERldmljZXMgc3VjaCBh
cyB2aWRlbwo+IGRlY29kZXJzLCBlbmNvZGVycywgY2FtZXJhcywgZXRjLiB0eXBpY2FsbHkgd29y
ayB0b2dldGhlciB3aXRoIHRoZQo+IGRpc3BsYXkgYW5kIEdQVSBpbiBhIHBpcGVsaW5lIG1hbm5l
ciwgd2hpY2ggY2FuIG9ubHkgYmUgaW1wbGVtZW50ZWQKPiBlZmZpY2llbnRseSBieSBzaGFyaW5n
IHRoZSBidWZmZXJzIGJldHdlZW4gcHJvZHVjZXJzIGFuZCBjb25zdW1lcnMuCj4gCj4gRXhpc3Rp
bmcgYnVmZmVyIG1hbmFnZW1lbnQgZnJhbWV3b3JrIGluIExpbnV4LCBzdWNoIGFzIHRoZSB2aWRl
b2J1ZjIKPiBmcmFtZXdvcmsgaW4gVjRMMiwgaW1wbGVtZW50cyBhbGwgdGhlIERNQS1idWYgaGFu
ZGxpbmcgaW5zaWRlIGdlbmVyaWMKPiBjb2RlIGFuZCBkbyBub3QgZXhwb3NlIGFueSBsb3cgbGV2
ZWwgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGJ1ZmZlcnMgdG8KPiB0aGUgZHJpdmVycy4KPiAKPiBU
byBzZWFtbGVzc2x5IGVuYWJsZSBidWZmZXIgc2hhcmluZyB3aXRoIGRyaXZlcnMgdXNpbmcgc3Vj
aCBmcmFtZXdvcmtzLAo+IG1ha2UgdGhlIHZpcnRpby1ncHUgZHJpdmVyIGV4cG9zZSB0aGUgcmVz
b3VyY2UgaGFuZGxlIGFzIHRoZSBETUEgYWRkcmVzcwo+IG9mIHRoZSBidWZmZXIgcmV0dXJuZWQg
ZnJvbSB0aGUgRE1BLWJ1ZiBtYXBwaW5nIG9wZXJhdGlvbi4gQXJndWFibHksIHRoZQo+IHJlc291
cmNlIGhhbmRsZSBpcyBhIGtpbmQgb2YgRE1BIGFkZHJlc3MgYWxyZWFkeSwgYXMgaXQgaXMgdGhl
IGJ1ZmZlcgo+IGlkZW50aWZpZXIgdGhhdCB0aGUgZGV2aWNlIG5lZWRzIHRvIGFjY2VzcyB0aGUg
YmFja2luZyBtZW1vcnksIHdoaWNoIGlzCj4gZXhhY3RseSB0aGUgc2FtZSByb2xlIGEgRE1BIGFk
ZHJlc3MgcHJvdmlkZXMgZm9yIG5hdGl2ZSBkZXZpY2VzLgo+IAo+IEEgdmlydGlvIGRyaXZlciB0
aGF0IGRvZXMgbWVtb3J5IG1hbmFnZW1lbnQgZnVsbHkgb24gaXRzIG93biB3b3VsZCBoYXZlCj4g
Y29kZSBzaW1pbGFyIHRvIGZvbGxvd2luZy4gVGhlIGNvZGUgaXMgaWRlbnRpY2FsIHRvIHdoYXQg
YSByZWd1bGFyCj4gZHJpdmVyIGZvciByZWFsIGhhcmR3YXJlIHdvdWxkIGRvIHRvIGltcG9ydCBh
IERNQS1idWYuCj4gCj4gc3RhdGljIGludCB2aXJ0aW9fZm9vX2dldF9yZXNvdXJjZV9oYW5kbGUo
c3RydWN0IHZpcnRpb19mb28gKmZvbywKPiAJCQkJCSAgc3RydWN0IGRtYV9idWYgKmRtYV9idWYs
IHUzMiAqaWQpCj4gewo+IAlzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICphdHRhY2g7Cj4gCXN0
cnVjdCBzZ190YWJsZSAqc2d0Owo+IAlpbnQgcmV0ID0gMDsKPiAKPiAJYXR0YWNoID0gZG1hX2J1
Zl9hdHRhY2goZG1hX2J1ZiwgZm9vLT5kZXYpOwo+IAlpZiAoSVNfRVJSKGF0dGFjaCkpCj4gCQly
ZXR1cm4gUFRSX0VSUihhdHRhY2gpOwo+IAo+IAlzZ3QgPSBkbWFfYnVmX21hcF9hdHRhY2htZW50
KGF0dGFjaCwgRE1BX0JJRElSRUNUSU9OQUwpOwo+IAlpZiAoSVNfRVJSKHNndCkpIHsKPiAJCXJl
dCA9IFBUUl9FUlIoc2d0KTsKPiAJCWdvdG8gZXJyX2RldGFjaDsKPiAJfQo+IAo+IAlpZiAoc2d0
LT5uZW50cyAhPSAxKSB7Cj4gCQlyZXQgPSAtRUlOVkFMOwo+IAkJZ290byBlcnJfdW5tYXA7Cj4g
CX0KPiAKPiAJKmlkID0gc2dfZG1hX2FkZHJlc3Moc2d0LT5zZ2wpOwoKSSBhZ3JlZSB3aXRoIEdl
cmQsIHRoaXMgbG9va3MgcHJldHR5IGhvcnJpYmxlIHRvIG1lLgoKVGhlIHVzdWFsIHdheSB3ZSd2
ZSBkb25lIHRoZXNlIGtpbmQgb2Ygc3BlY2lhbCBkbWEtYnVmcyBpczoKCi0gVGhleSBhbGwgZ2V0
IGFsbG9jYXRlZCBhdCB0aGUgc2FtZSBwbGFjZSwgdGhyb3VnaCBzb21lIGxpYnJhcnkgb3IKICB3
aGF0ZXZlci4KCi0gWW91IGFkZCBhIGRtYV9idWZfaXNfdmlydGlvKGRtYV9idWYpIGZ1bmN0aW9u
LCBvciBtYXliZSBzb21ldGhpbmcgdGhhdAogIGFsc28gdXBjYXN0cyBvciByZXR1cm5zIE5VTEws
IHdoaWNoIGNoZWNrcyBmb3IgZG1hX2J1Zi0+b3BzLgoKLSBPbmNlIHlvdSd2ZSB1cGNhc3RlZCBh
dCBydW50aW1lIGJ5IGNoZWNraW5nIGZvciAtPm9wcywgeW91IGNhbiBhZGQKICB3aGF0ZXZlciBm
YW5jeSBpbnRlcmZhY2VzIHlvdSB3YW50LiBJbmNsdWRpbmcgYSByZWFsJnByb3BlciBpbnRlcmZh
Y2UgdG8KICBnZXQgYXQgd2hhdGV2ZXIgdW5kZXJseWluZyBpZCB5b3UgbmVlZCB0byBmb3IgcmVh
bCBidWZmZXIgc2hhcmluZwogIGJldHdlZW4gdmlydGlvIGRldmljZXMuCgpJbiBhIHdheSB2aXJ0
aW8gYnVmZmVyL21lbW9yeSBpZHMgYXJlIGEga2luZCBvZiBwcml2YXRlIGJ1cywgZW50aXJlbHkK
ZGlzdGluY3QgZnJvbSB0aGUgZG1hX2FkZHJfdCBidXMuIFNvIGNhbid0IHJlYWxseSBzdHVmZiB0
aGVtIHVuZGVyIHRoaXMKc2FtZSB0aGluZyBsaWtlIHdlIGUuZy4gZG8gd2l0aCBwY2kgcGVlcjJw
ZWVyLgotRGFuaWVsCgo+IAo+IGVycl91bm1hcDoKPiAJZG1hX2J1Zl91bm1hcF9hdHRhY2htZW50
KGF0dGFjaCwgc2d0LCBETUFfQklESVJFQ1RJT05BTCk7Cj4gZXJyX2RldGFjaDoKPiAJZG1hX2J1
Zl9kZXRhY2goZG1hX2J1ZiwgYXR0YWNoKTsKPiAKPiAJcmV0dXJuIHJldDsKPiB9Cj4gCj4gT24g
dGhlIG90aGVyIGhhbmQsIGEgdmlydGlvIGRyaXZlciB0aGF0IHVzZXMgYW4gZXhpc3Rpbmcga2Vy
bmVsCj4gZnJhbWV3b3JrIHRvIG1hbmFnZSBidWZmZXJzIHdvdWxkIG5vdCBuZWVkIHRvIGV4cGxp
Y2l0bHkgaGFuZGxlIGFueXRoaW5nCj4gYXQgYWxsLCBhcyB0aGUgZnJhbWV3b3JrIHBhcnQgcmVz
cG9uc2libGUgZm9yIGltcG9ydGluZyBETUEtYnVmcyB3b3VsZAo+IGFscmVhZHkgZG8gdGhlIHdv
cmsuIEZvciBleGFtcGxlLCBhIFY0TDIgZHJpdmVyIHVzaW5nIHRoZSB2aWRlb2J1ZjIKPiBmcmFt
ZXdvcmsgd291bGQganVzdCBjYWxsIHRoZWUgdmIyX2RtYV9jb250aWdfcGxhbmVfZG1hX2FkZHIo
KSBmdW5jdGlvbgo+IHRvIGdldCB3aGF0IHRoZSBhYm92ZSBvcGVuLWNvZGVkIGZ1bmN0aW9uIHdv
dWxkIHJldHVybi4KPiAKPiBTaWduZWQtb2ZmLWJ5OiBUb21hc3ogRmlnYSA8dGZpZ2FAY2hyb21p
dW0ub3JnPgo+IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfZHJ2LmMgICB8
ICAyICsKPiAgZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X2Rydi5oICAgfCAgNCArKwo+
ICBkcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfcHJpbWUuYyB8IDgxICsrKysrKysrKysr
KysrKysrKysrKysrKysrCj4gIDMgZmlsZXMgY2hhbmdlZCwgODcgaW5zZXJ0aW9ucygrKQo+IAo+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfZHJ2LmMgYi9kcml2
ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfZHJ2LmMKPiBpbmRleCAwZmMzMmZhMGIzYzAuLmFj
MDk1ZjgxMzEzNCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVf
ZHJ2LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfZHJ2LmMKPiBAQCAt
MjEwLDYgKzIxMCw4IEBAIHN0YXRpYyBzdHJ1Y3QgZHJtX2RyaXZlciBkcml2ZXIgPSB7Cj4gICNl
bmRpZgo+ICAJLnByaW1lX2hhbmRsZV90b19mZCA9IGRybV9nZW1fcHJpbWVfaGFuZGxlX3RvX2Zk
LAo+ICAJLnByaW1lX2ZkX3RvX2hhbmRsZSA9IGRybV9nZW1fcHJpbWVfZmRfdG9faGFuZGxlLAo+
ICsJLmdlbV9wcmltZV9leHBvcnQgPSB2aXJ0Z3B1X2dlbV9wcmltZV9leHBvcnQsCj4gKwkuZ2Vt
X3ByaW1lX2ltcG9ydCA9IHZpcnRncHVfZ2VtX3ByaW1lX2ltcG9ydCwKPiAgCS5nZW1fcHJpbWVf
Z2V0X3NnX3RhYmxlID0gdmlydGdwdV9nZW1fcHJpbWVfZ2V0X3NnX3RhYmxlLAo+ICAJLmdlbV9w
cmltZV9pbXBvcnRfc2dfdGFibGUgPSB2aXJ0Z3B1X2dlbV9wcmltZV9pbXBvcnRfc2dfdGFibGUs
Cj4gIAkuZ2VtX3ByaW1lX3ZtYXAgPSB2aXJ0Z3B1X2dlbV9wcmltZV92bWFwLAo+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfZHJ2LmggYi9kcml2ZXJzL2dwdS9k
cm0vdmlydGlvL3ZpcnRncHVfZHJ2LmgKPiBpbmRleCBlMjg4Mjk2NjE3MjQuLjY4N2NmY2U5MTg4
NSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfZHJ2LmgKPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfZHJ2LmgKPiBAQCAtMzY3LDYgKzM2
NywxMCBAQCB2b2lkIHZpcnRpb19ncHVfb2JqZWN0X2ZyZWVfc2dfdGFibGUoc3RydWN0IHZpcnRp
b19ncHVfb2JqZWN0ICpibyk7Cj4gIGludCB2aXJ0aW9fZ3B1X29iamVjdF93YWl0KHN0cnVjdCB2
aXJ0aW9fZ3B1X29iamVjdCAqYm8sIGJvb2wgbm9fd2FpdCk7Cj4gIAo+ICAvKiB2aXJ0Z3B1X3By
aW1lLmMgKi8KPiArc3RydWN0IGRtYV9idWYgKnZpcnRncHVfZ2VtX3ByaW1lX2V4cG9ydChzdHJ1
Y3QgZHJtX2dlbV9vYmplY3QgKm9iaiwKPiArCQkJCQkgaW50IGZsYWdzKTsKPiArc3RydWN0IGRy
bV9nZW1fb2JqZWN0ICp2aXJ0Z3B1X2dlbV9wcmltZV9pbXBvcnQoc3RydWN0IGRybV9kZXZpY2Ug
KmRldiwKPiArCQkJCQkJc3RydWN0IGRtYV9idWYgKmJ1Zik7Cj4gIHN0cnVjdCBzZ190YWJsZSAq
dmlydGdwdV9nZW1fcHJpbWVfZ2V0X3NnX3RhYmxlKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2Jq
KTsKPiAgc3RydWN0IGRybV9nZW1fb2JqZWN0ICp2aXJ0Z3B1X2dlbV9wcmltZV9pbXBvcnRfc2df
dGFibGUoCj4gIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2ht
ZW50ICphdHRhY2gsCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8vdmlydGdw
dV9wcmltZS5jIGIvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X3ByaW1lLmMKPiBpbmRl
eCBkYzY0MmE4ODRiODguLjU2MmViMWEyZWQ1YiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vdmlydGlvL3ZpcnRncHVfcHJpbWUuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8v
dmlydGdwdV9wcmltZS5jCj4gQEAgLTIyLDYgKzIyLDkgQEAKPiAgICogQXV0aG9yczogQW5kcmVh
cyBQb2tvcm55Cj4gICAqLwo+ICAKPiArI2luY2x1ZGUgPGxpbnV4L2RtYS1idWYuaD4KPiArI2lu
Y2x1ZGUgPGxpbnV4L2RtYS1kaXJlY3Rpb24uaD4KPiArCj4gICNpbmNsdWRlIDxkcm0vZHJtX3By
aW1lLmg+Cj4gIAo+ICAjaW5jbHVkZSAidmlydGdwdV9kcnYuaCIKPiBAQCAtMzAsNiArMzMsODQg
QEAKPiAgICogZGV2aWNlIHRoYXQgbWlnaHQgc2hhcmUgYnVmZmVycyB3aXRoIHZpcnRncHUKPiAg
ICovCj4gIAo+ICtzdGF0aWMgc3RydWN0IHNnX3RhYmxlICoKPiArdmlydGdwdV9nZW1fbWFwX2Rt
YV9idWYoc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCAqYXR0YWNoLAo+ICsJCQllbnVtIGRtYV9k
YXRhX2RpcmVjdGlvbiBkaXIpCj4gK3sKPiArCXN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqID0g
YXR0YWNoLT5kbWFidWYtPnByaXY7Cj4gKwlzdHJ1Y3QgdmlydGlvX2dwdV9vYmplY3QgKmJvID0g
Z2VtX3RvX3ZpcnRpb19ncHVfb2JqKG9iaik7Cj4gKwlzdHJ1Y3Qgc2dfdGFibGUgKnNndDsKPiAr
CWludCByZXQ7Cj4gKwo+ICsJc2d0ID0ga3phbGxvYyhzaXplb2YoKnNndCksIEdGUF9LRVJORUwp
Owo+ICsJaWYgKCFzZ3QpCj4gKwkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7Cj4gKwo+ICsJcmV0
ID0gc2dfYWxsb2NfdGFibGUoc2d0LCAxLCBHRlBfS0VSTkVMKTsKPiArCWlmIChyZXQpIHsKPiAr
CQlrZnJlZShzZ3QpOwo+ICsJCXJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwo+ICsJfQo+ICsKPiAr
CXNnX2RtYV9hZGRyZXNzKHNndC0+c2dsKSA9IGJvLT5od19yZXNfaGFuZGxlOwo+ICsJc2dfZG1h
X2xlbihzZ3QtPnNnbCkgPSBvYmotPnNpemU7Cj4gKwlzZ3QtPm5lbnRzID0gMTsKPiArCj4gKwly
ZXR1cm4gc2d0Owo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCB2aXJ0Z3B1X2dlbV91bm1hcF9kbWFf
YnVmKHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFjaCwKPiArCQkJCSAgICAgIHN0cnVj
dCBzZ190YWJsZSAqc2d0LAo+ICsJCQkJICAgICAgZW51bSBkbWFfZGF0YV9kaXJlY3Rpb24gZGly
KQo+ICt7Cj4gKwlzZ19mcmVlX3RhYmxlKHNndCk7Cj4gKwlrZnJlZShzZ3QpOwo+ICt9Cj4gKwo+
ICtzdGF0aWMgY29uc3Qgc3RydWN0IGRtYV9idWZfb3BzIHZpcnRncHVfZG1hYnVmX29wcyA9ICB7
Cj4gKwkuY2FjaGVfc2d0X21hcHBpbmcgPSB0cnVlLAo+ICsJLmF0dGFjaCA9IGRybV9nZW1fbWFw
X2F0dGFjaCwKPiArCS5kZXRhY2ggPSBkcm1fZ2VtX21hcF9kZXRhY2gsCj4gKwkubWFwX2RtYV9i
dWYgPSB2aXJ0Z3B1X2dlbV9tYXBfZG1hX2J1ZiwKPiArCS51bm1hcF9kbWFfYnVmID0gdmlydGdw
dV9nZW1fdW5tYXBfZG1hX2J1ZiwKPiArCS5yZWxlYXNlID0gZHJtX2dlbV9kbWFidWZfcmVsZWFz
ZSwKPiArCS5tbWFwID0gZHJtX2dlbV9kbWFidWZfbW1hcCwKPiArCS52bWFwID0gZHJtX2dlbV9k
bWFidWZfdm1hcCwKPiArCS52dW5tYXAgPSBkcm1fZ2VtX2RtYWJ1Zl92dW5tYXAsCj4gK307Cj4g
Kwo+ICtzdHJ1Y3QgZG1hX2J1ZiAqdmlydGdwdV9nZW1fcHJpbWVfZXhwb3J0KHN0cnVjdCBkcm1f
Z2VtX29iamVjdCAqb2JqLAo+ICsJCQkJCSBpbnQgZmxhZ3MpCj4gK3sKPiArCXN0cnVjdCBkbWFf
YnVmICpidWY7Cj4gKwo+ICsJYnVmID0gZHJtX2dlbV9wcmltZV9leHBvcnQob2JqLCBmbGFncyk7
Cj4gKwlpZiAoIUlTX0VSUihidWYpKQo+ICsJCWJ1Zi0+b3BzID0gJnZpcnRncHVfZG1hYnVmX29w
czsKPiArCj4gKwlyZXR1cm4gYnVmOwo+ICt9Cj4gKwo+ICtzdHJ1Y3QgZHJtX2dlbV9vYmplY3Qg
KnZpcnRncHVfZ2VtX3ByaW1lX2ltcG9ydChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ICsJCQkJ
CQlzdHJ1Y3QgZG1hX2J1ZiAqYnVmKQo+ICt7Cj4gKwlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9i
ajsKPiArCj4gKwlpZiAoYnVmLT5vcHMgPT0gJnZpcnRncHVfZG1hYnVmX29wcykgewo+ICsJCW9i
aiA9IGJ1Zi0+cHJpdjsKPiArCQlpZiAob2JqLT5kZXYgPT0gZGV2KSB7Cj4gKwkJCS8qCj4gKwkJ
CSAqIEltcG9ydGluZyBkbWFidWYgZXhwb3J0ZWQgZnJvbSBvdXIgb3duIGdlbSBpbmNyZWFzZXMK
PiArCQkJICogcmVmY291bnQgb24gZ2VtIGl0c2VsZiBpbnN0ZWFkIG9mIGZfY291bnQgb2YgZG1h
YnVmLgo+ICsJCQkgKi8KPiArCQkJZHJtX2dlbV9vYmplY3RfZ2V0KG9iaik7Cj4gKwkJCXJldHVy
biBvYmo7Cj4gKwkJfQo+ICsJfQo+ICsKPiArCXJldHVybiBkcm1fZ2VtX3ByaW1lX2ltcG9ydChk
ZXYsIGJ1Zik7Cj4gK30KPiArCj4gIHN0cnVjdCBzZ190YWJsZSAqdmlydGdwdV9nZW1fcHJpbWVf
Z2V0X3NnX3RhYmxlKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqKQo+ICB7Cj4gIAlzdHJ1Y3Qg
dmlydGlvX2dwdV9vYmplY3QgKmJvID0gZ2VtX3RvX3ZpcnRpb19ncHVfb2JqKG9iaik7Cj4gLS0g
Cj4gMi4yMy4wLjIzNy5nYzZhNGNlNTBhMC1nb29nCj4gCgotLSAKRGFuaWVsIFZldHRlcgpTb2Z0
d2FyZSBFbmdpbmVlciwgSW50ZWwgQ29ycG9yYXRpb24KaHR0cDovL2Jsb2cuZmZ3bGwuY2gKX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1h
aWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
