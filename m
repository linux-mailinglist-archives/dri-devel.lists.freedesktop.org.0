Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id EB51EB4E54
	for <lists+dri-devel@lfdr.de>; Tue, 17 Sep 2019 14:46:07 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id DFCA06E04E;
	Tue, 17 Sep 2019 12:46:05 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from foss.arm.com (foss.arm.com [217.140.110.172])
 by gabe.freedesktop.org (Postfix) with ESMTP id A1E0C6E04E
 for <dri-devel@lists.freedesktop.org>; Tue, 17 Sep 2019 12:46:04 +0000 (UTC)
Received: from usa-sjc-imap-foss1.foss.arm.com (unknown [10.121.207.14])
 by usa-sjc-mx-foss1.foss.arm.com (Postfix) with ESMTP id 67C6D1000;
 Tue, 17 Sep 2019 05:46:04 -0700 (PDT)
Received: from [10.37.9.122] (unknown [10.37.9.122])
 by usa-sjc-imap-foss1.foss.arm.com (Postfix) with ESMTPSA id B9DF73F59C;
 Tue, 17 Sep 2019 05:46:03 -0700 (PDT)
Subject: Re: blocking ops in drm_sched_cleanup_jobs()
To: "Koenig, Christian" <Christian.Koenig@amd.com>,
 dri-devel <dri-devel@lists.freedesktop.org>
References: <6ed945cb-619a-b26d-21b0-9bdaeaa69582@arm.com>
 <6ad57904-d145-1771-84a1-926d6e95bade@amd.com>
From: Steven Price <steven.price@arm.com>
Message-ID: <1c56e435-f05b-e40b-372e-5b6af2f25291@arm.com>
Date: Tue, 17 Sep 2019 13:46:01 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <6ad57904-d145-1771-84a1-926d6e95bade@amd.com>
Content-Language: en-GB
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gMTcvMDkvMjAxOSAwOTo0MiwgS29lbmlnLCBDaHJpc3RpYW4gd3JvdGU6Cj4gSGkgU3RldmVu
LAo+IAo+IHRob3VnaHQgYWJvdXQgdGhhdCBpc3N1ZSBhIGJpdCBtb3JlIGFuZCBJIHRoaW5rIEkg
Y2FtZSB1cCB3aXRoIGEgc29sdXRpb24uCj4gCj4gV2hhdCB5b3UgY291bGQgZG8gaXMgdG8gc3Bs
aXQgdXAgZHJtX3NjaGVkX2NsZWFudXBfam9icygpIGludG8gdHdvCj4gZnVuY3Rpb25zLgo+IAo+
IE9uZSB0aGF0IGNoZWNrcyBpZiBqb2JzIHRvIGJlIGNsZWFuZWQgdXAgYXJlIHByZXNlbnQgYW5k
IG9uZSB3aGljaCBkb2VzCj4gdGhlIGFjdHVhbCBjbGVhbnVwLgo+IAo+IFRoaXMgd2F5IHdlIGNv
dWxkIGNhbGwgZHJtX3NjaGVkX2NsZWFudXBfam9icygpIG91dHNpZGUgb2YgdGhlCj4gd2FpdF9l
dmVudF9pbnRlcnJ1cHRpYmxlKCkuCgpZZXMgdGhhdCBzZWVtcyBsaWtlIGEgZ29vZCBzb2x1dGlv
biAtIHRoZXJlIGRvZXNuJ3Qgc2VlbSB0byBiZSBhIGdvb2QgCnJlYXNvbiB3aHkgdGhlIGFjdHVh
bCBqb2IgY2xlYW51cCBuZWVkcyB0byBiZSBkb25lIHdpdGhpbiB0aGUgCndhaXRfZXZlbnRfaW50
ZXJydXB0aWJsZSgpIGNvbmRpdGlvbi4gSSBkaWQgYnJpZWZseSBhdHRlbXB0IHRoYXQgYmVmb3Jl
LCAKYnV0IEkgY291bGRuJ3Qgd29yayBvdXQgZXhhY3RseSB3aGF0IHRoZSBjb25kaXRpb24gaXMg
d2hpY2ggc2hvdWxkIGNhdXNlIAp0aGUgd2FrZSAobXkgaW5pdGlhbCBhdHRlbXB0IGNhdXNlZCBj
b250aW51b3VzIHdha2UtdXBzKS4KCkknbSBub3QgYmFjayBpbiB0aGUgb2ZmaWNlIHVudGlsIE1v
bmRheSwgYnV0IEknbGwgaGF2ZSBhbm90aGVyIGdvIHRoZW4gCmF0IHNwaXR0aW5nIHRoZSBjaGVj
a2luZyBhbmQgdGhlIGFjdHVhbCBmcmVlaW5nIG9mIHRoZSBqb2JzLgoKVGhhbmtzLAoKU3RldmUK
Cj4gCj4gUmVnYXJkcywKPiBDaHJpc3RpYW4uCj4gCj4gQW0gMTMuMDkuMTkgdW0gMTY6NTAgc2No
cmllYiBTdGV2ZW4gUHJpY2U6Cj4+IEhpLAo+Pgo+PiBJIGhpdCB0aGUgYmVsb3cgc3BsYXQgcmFu
ZG9tbHkgd2l0aCBwYW5mcm9zdC4gRnJvbSB3aGF0IEkgY2FuIHRlbGwgdGhpcwo+PiBpcyBhIG1v
cmUgZ2VuZXJhbCBpc3N1ZSB3aGljaCB3b3VsZCBhZmZlY3Qgb3RoZXIgZHJpdmVycy4KPj4KPj4g
LS0tLTg8LS0tLS0KPj4gWzU4NjA0LjkxMzEzMF0gLS0tLS0tLS0tLS0tWyBjdXQgaGVyZSBdLS0t
LS0tLS0tLS0tCj4+IFs1ODYwNC45MTg1OTBdIFdBUk5JTkc6IENQVTogMSBQSUQ6IDE3NTggYXQg
a2VybmVsL3NjaGVkL2NvcmUuYzo2NTU2IF9fbWlnaHRfc2xlZXArMHg3NC8weDk4Cj4+IFs1ODYw
NC45Mjc5NjVdIGRvIG5vdCBjYWxsIGJsb2NraW5nIG9wcyB3aGVuICFUQVNLX1JVTk5JTkc7IHN0
YXRlPTEgc2V0IGF0IFs8MGM1OTA0OTQ+XSBwcmVwYXJlX3RvX3dhaXRfZXZlbnQrMHgxMDQvMHgx
NjQKPj4gWzU4NjA0Ljk0MDA0N10gTW9kdWxlcyBsaW5rZWQgaW46IHBhbmZyb3N0IGdwdV9zY2hl
ZAo+PiBbNTg2MDQuOTQ1MzcwXSBDUFU6IDEgUElEOiAxNzU4IENvbW06IHBhbl9qcyBOb3QgdGFp
bnRlZCA1LjMuMC1yYzErICMxMwo+PiBbNTg2MDQuOTUyNTAwXSBIYXJkd2FyZSBuYW1lOiBSb2Nr
Y2hpcCAoRGV2aWNlIFRyZWUpCj4+IFs1ODYwNC45NTc4MTVdIFs8YzAxMTExNTA+XSAodW53aW5k
X2JhY2t0cmFjZSkgZnJvbSBbPGMwMTBjOTljPl0gKHNob3dfc3RhY2srMHgxMC8weDE0KQo+PiBb
NTg2MDQuOTY2NTIxXSBbPGMwMTBjOTljPl0gKHNob3dfc3RhY2spIGZyb20gWzxjMDdhZGJiND5d
IChkdW1wX3N0YWNrKzB4OWMvMHhkNCkKPj4gWzU4NjA0Ljk3NDYzOV0gWzxjMDdhZGJiND5dIChk
dW1wX3N0YWNrKSBmcm9tIFs8YzAxMjFkYTg+XSAoX193YXJuKzB4ZTgvMHgxMDQpCj4+IFs1ODYw
NC45ODI0NjJdIFs8YzAxMjFkYTg+XSAoX193YXJuKSBmcm9tIFs8YzAxMjFlMDg+XSAod2Fybl9z
bG93cGF0aF9mbXQrMHg0NC8weDZjKQo+PiBbNTg2MDQuOTkwODY3XSBbPGMwMTIxZTA4Pl0gKHdh
cm5fc2xvd3BhdGhfZm10KSBmcm9tIFs8YzAxNGVjY2M+XSAoX19taWdodF9zbGVlcCsweDc0LzB4
OTgpCj4+IFs1ODYwNC45OTk5NzNdIFs8YzAxNGVjY2M+XSAoX19taWdodF9zbGVlcCkgZnJvbSBb
PGMwN2M3M2Q4Pl0gKF9fbXV0ZXhfbG9jaysweDM4LzB4OTQ4KQo+PiBbNTg2MDUuMDA4NjkwXSBb
PGMwN2M3M2Q4Pl0gKF9fbXV0ZXhfbG9jaykgZnJvbSBbPGMwN2M3ZDAwPl0gKG11dGV4X2xvY2tf
bmVzdGVkKzB4MTgvMHgyMCkKPj4gWzU4NjA1LjAxNzg0MV0gWzxjMDdjN2QwMD5dIChtdXRleF9s
b2NrX25lc3RlZCkgZnJvbSBbPGJmMDBiNTRjPl0gKHBhbmZyb3N0X2dlbV9mcmVlX29iamVjdCsw
eDYwLzB4MTBjIFtwYW5mcm9zdF0pCj4+IFs1ODYwNS4wMjk0MzBdIFs8YmYwMGI1NGM+XSAocGFu
ZnJvc3RfZ2VtX2ZyZWVfb2JqZWN0IFtwYW5mcm9zdF0pIGZyb20gWzxiZjAwY2VjYz5dIChwYW5m
cm9zdF9qb2JfcHV0KzB4MTM4LzB4MTUwIFtwYW5mcm9zdF0pCj4+IFs1ODYwNS4wNDIwNzZdIFs8
YmYwMGNlY2M+XSAocGFuZnJvc3Rfam9iX3B1dCBbcGFuZnJvc3RdKSBmcm9tIFs8YmYwMDEyMWM+
XSAoZHJtX3NjaGVkX2NsZWFudXBfam9icysweGM4LzB4ZTAgW2dwdV9zY2hlZF0pCj4+IFs1ODYw
NS4wNTQ0MTddIFs8YmYwMDEyMWM+XSAoZHJtX3NjaGVkX2NsZWFudXBfam9icyBbZ3B1X3NjaGVk
XSkgZnJvbSBbPGJmMDAxMzAwPl0gKGRybV9zY2hlZF9tYWluKzB4Y2MvMHgyNmMgW2dwdV9zY2hl
ZF0pCj4+IFs1ODYwNS4wNjY2MjBdIFs8YmYwMDEzMDA+XSAoZHJtX3NjaGVkX21haW4gW2dwdV9z
Y2hlZF0pIGZyb20gWzxjMDE0NmNmYz5dIChrdGhyZWFkKzB4MTNjLzB4MTU0KQo+PiBbNTg2MDUu
MDc2MjI2XSBbPGMwMTQ2Y2ZjPl0gKGt0aHJlYWQpIGZyb20gWzxjMDEwMTBiND5dIChyZXRfZnJv
bV9mb3JrKzB4MTQvMHgyMCkKPj4gWzU4NjA1LjA4NDM0Nl0gRXhjZXB0aW9uIHN0YWNrKDB4ZTk1
OWJmYjAgdG8gMHhlOTU5YmZmOCkKPj4gWzU4NjA1LjA5MDA0Nl0gYmZhMDogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgMDAwMDAwMDAgMDAwMDAwMDAgMDAwMDAwMDAgMDAwMDAw
MDAKPj4gWzU4NjA1LjA5OTI1MF0gYmZjMDogMDAwMDAwMDAgMDAwMDAwMDAgMDAwMDAwMDAgMDAw
MDAwMDAgMDAwMDAwMDAgMDAwMDAwMDAgMDAwMDAwMDAgMDAwMDAwMDAKPj4gWzU4NjA1LjEwODQ4
MF0gYmZlMDogMDAwMDAwMDAgMDAwMDAwMDAgMDAwMDAwMDAgMDAwMDAwMDAgMDAwMDAwMTMgMDAw
MDAwMDAKPj4gWzU4NjA1LjExNjIxMF0gaXJxIGV2ZW50IHN0YW1wOiAxNzkKPj4gWzU4NjA1LjEx
OTk1NV0gaGFyZGlycXMgbGFzdCAgZW5hYmxlZCBhdCAoMTg3KTogWzxjMDE3ZjdlND5dIGNvbnNv
bGVfdW5sb2NrKzB4NTY0LzB4NWM0Cj4+IFs1ODYwNS4xMjg5MzVdIGhhcmRpcnFzIGxhc3QgZGlz
YWJsZWQgYXQgKDIwMik6IFs8YzAxN2YzMDg+XSBjb25zb2xlX3VubG9jaysweDg4LzB4NWM0Cj4+
IFs1ODYwNS4xMzc3ODhdIHNvZnRpcnFzIGxhc3QgIGVuYWJsZWQgYXQgKDIxNik6IFs8YzAxMDIz
MzQ+XSBfX2RvX3NvZnRpcnErMHgxOGMvMHg1NDgKPj4gWzU4NjA1LjE0NjU0M10gc29mdGlycXMg
bGFzdCBkaXNhYmxlZCBhdCAoMjI3KTogWzxjMDEyOTUyOD5dIGlycV9leGl0KzB4YzQvMHgxMGMK
Pj4gWzU4NjA1LjE1NDYxOF0gLS0tWyBlbmQgdHJhY2UgZjY1YmRiZDllYTlhZGZjMCBdLS0tCj4+
IC0tLS04PC0tLS0tCj4+Cj4+IFRoZSBwcm9ibGVtIGlzIHRoYXQgZHJtX3NjaGVkX21haW4oKSBj
YWxscyBkcm1fc2NoZWRfY2xlYW51cF9qb2JzKCkgYXMKPj4gcGFydCBvZiB0aGUgY29uZGl0aW9u
IG9mIHdhaXRfZXZlbnRfaW50ZXJydXB0aWJsZToKPj4KPj4+IAkJd2FpdF9ldmVudF9pbnRlcnJ1
cHRpYmxlKHNjaGVkLT53YWtlX3VwX3dvcmtlciwKPj4+IAkJCQkJIChkcm1fc2NoZWRfY2xlYW51
cF9qb2JzKHNjaGVkKSwKPj4+IAkJCQkJICghZHJtX3NjaGVkX2Jsb2NrZWQoc2NoZWQpICYmCj4+
PiAJCQkJCSAgKGVudGl0eSA9IGRybV9zY2hlZF9zZWxlY3RfZW50aXR5KHNjaGVkKSkpIHx8Cj4+
PiAJCQkJCSBrdGhyZWFkX3Nob3VsZF9zdG9wKCkpKTsKPj4gV2hlbiBkcm1fc2NoZWRfY2xlYW51
cF9qb2JzKCkgaXMgY2FsbGVkICphZnRlciogYSB3YWl0IChpLmUuIGFmdGVyCj4+IHByZXBhcmVf
dG9fd2FpdF9ldmVudCgpIGhhcyBiZWVuIGNhbGxlZCksIHRoZW4gYW55IG1pZ2h0X3NsZWVwKCkg
d2lsbAo+PiBtb2FuIGxvdWRseSBhYm91dCBpdC4gVGhpcyBkb2Vzbid0IHNlZW0gdG8gaGFwcGVu
IG9mdGVuIChJJ3ZlIG9ubHkKPj4gdHJpZ2dlcmVkIGl0IG9uY2UpIGJlY2F1c2UgdXN1YWxseSBk
cm1fc2NoZWRfY2xlYW51cF9qb2JzKCkgZWl0aGVyCj4+IGRvZXNuJ3Qgc2xlZXAgb3IgZG9lcyB0
aGUgc2xlZXBpbmcgZHVyaW5nIHRoZSBmaXJzdCBjYWxsIHRoYXQKPj4gd2FpdF9ldmVudF9pbnRl
cnJ1cHRpYmxlKCkgbWFrZXMgKHdoaWNoIGlzIGJlZm9yZSB0aGUgdGFzayBzdGF0ZSBpcyBzZXQp
Lgo+Pgo+PiBJIGRvbid0IHJlYWxseSB1bmRlcnN0YW5kIHdoeSBkcm1fc2NoZWRfY2xlYW51cF9q
b2JzKCkgbmVlZHMgdG8gYmUKPj4gY2FsbGVkIGhlcmUsIGEgc2ltcGxlIGNoYW5nZSBsaWtlIGJl
bG93ICdmaXhlcycgaXQuIEJ1dCBJIHByZXN1bWUKPj4gdGhlcmUncyBzb21lIHJlYXNvbiBmb3Ig
dGhlIGNhbGwgYmVpbmcgcGFydCBvZiB0aGUKPj4gd2FpdF9ldmVudF9pbnRlcnJ1cHRpYmxlIGNv
bmRpdGlvbi4gQ2FuIGFueW9uZSBzaGVkIGxpZ2h0IG9uIHRoaXM/Cj4+Cj4+IFRoZSBjb2RlIHdh
cyBpbnRyb2R1Y2VkIGluIGNvbW1pdCA1OTE4MDQ1YzRlZDQgKCJkcm0vc2NoZWR1bGVyOiByZXdv
cmsgam9iIGRlc3RydWN0aW9uIikKPj4KPj4gU3RldmUKPj4KPj4gLS0tLTg8LS0tLS0KPj4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9zY2hlZHVsZXIvc2NoZWRfbWFpbi5jIGIvZHJpdmVy
cy9ncHUvZHJtL3NjaGVkdWxlci9zY2hlZF9tYWluLmMKPj4gaW5kZXggOWEwZWU3NGQ4MmRjLi41
MjhmMjk1ZTNhMzEgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9zY2hlZHVsZXIvc2No
ZWRfbWFpbi5jCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9zY2hlZHVsZXIvc2NoZWRfbWFpbi5j
Cj4+IEBAIC02OTksMTEgKzY5OSwxMiBAQCBzdGF0aWMgaW50IGRybV9zY2hlZF9tYWluKHZvaWQg
KnBhcmFtKQo+PiAgICAJCXN0cnVjdCBkcm1fc2NoZWRfam9iICpzY2hlZF9qb2I7Cj4+ICAgIAkJ
c3RydWN0IGRtYV9mZW5jZSAqZmVuY2U7Cj4+ICAgIAo+PiArCQlkcm1fc2NoZWRfY2xlYW51cF9q
b2JzKHNjaGVkKTsKPj4gKwo+PiAgICAJCXdhaXRfZXZlbnRfaW50ZXJydXB0aWJsZShzY2hlZC0+
d2FrZV91cF93b3JrZXIsCj4+IC0JCQkJCSAoZHJtX3NjaGVkX2NsZWFudXBfam9icyhzY2hlZCks
Cj4+ICAgIAkJCQkJICghZHJtX3NjaGVkX2Jsb2NrZWQoc2NoZWQpICYmCj4+ICAgIAkJCQkJICAo
ZW50aXR5ID0gZHJtX3NjaGVkX3NlbGVjdF9lbnRpdHkoc2NoZWQpKSkgfHwKPj4gLQkJCQkJIGt0
aHJlYWRfc2hvdWxkX3N0b3AoKSkpOwo+PiArCQkJCQkga3RocmVhZF9zaG91bGRfc3RvcCgpKTsK
Pj4gICAgCj4+ICAgIAkJaWYgKCFlbnRpdHkpCj4+ICAgIAkJCWNvbnRpbnVlOwo+IAo+IF9fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCj4gZHJpLWRldmVsIG1h
aWxpbmcgbGlzdAo+IGRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKPiBodHRwczovL2xp
c3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbAo+IAoKX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxp
bmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
