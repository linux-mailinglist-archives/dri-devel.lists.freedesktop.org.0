Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id A5BBE318C03
	for <lists+dri-devel@lfdr.de>; Thu, 11 Feb 2021 14:29:56 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 102AA6E415;
	Thu, 11 Feb 2021 13:29:47 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ej1-x632.google.com (mail-ej1-x632.google.com
 [IPv6:2a00:1450:4864:20::632])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 15F816E0EB
 for <dri-devel@lists.freedesktop.org>; Thu, 11 Feb 2021 13:29:45 +0000 (UTC)
Received: by mail-ej1-x632.google.com with SMTP id y9so10002281ejp.10
 for <dri-devel@lists.freedesktop.org>; Thu, 11 Feb 2021 05:29:45 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=G1YlUwmYfs48fdEZ9G3J8L9qwvrvrX+jwyHNUDWNnV8=;
 b=dEDCdhvP/x7VWouLsNCWipGbLzpqktNgxByCA4b4dBpOSwyMMJ41MpZLuXqgiWPxz1
 CaiLp+n6JFBdBZSvIjZz9X1i8+FAWcg3hq8+Uuat9MGWYH7gUcp6nb4g08ztfoTi5x8V
 P3EmonJUOa+JbANPBqiwnpNg870R+xdpEY2NlHFkqr5m1J9+4KwCMvCU9/d7JHJOEAfN
 oTj11gt4OsHs0ftmrMz5aLSYz//9ER8cr5yNjzQ7tK9TGA+7WQ6im3t/2IedxT80tY36
 dA/onCVNVeoJ94q9LnAVpPxppZwii2hT6AUnXladu/gpoDnjHPv/JLEhotZEn5scq5i4
 lJ8w==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=G1YlUwmYfs48fdEZ9G3J8L9qwvrvrX+jwyHNUDWNnV8=;
 b=XNvfigaakeNQ6e3wfOtzhSgUM6iY/9rxfE0Le+oUJVaDldAj6fv1fFttF7vql2FuaK
 xtl6UM2DloSLXD4nIi3d/vtUH/bKXJIiBN13uZjPTooeyKgP9pJQvhReLMNiAI5PhWiV
 XerQJfAnEn7XKTxZfjePqI6HBC4sxH/rxicTSoaNMAulRljEadzNqJ1n/Rqo8AmQjSJS
 VvB2JhbUp2smeIFggpSQQIvnKQdXBPz/jK6E2YD9X9P3LO4J18kPi6avhcJPIIHgqGO8
 uK4fMXDhO3X2a+blX0Hvi1Y4VGXFkSFaO1VHLCEjHPbCG7BGeczu6xrv/mSzXq3XanLo
 sVmQ==
X-Gm-Message-State: AOAM530GWxQbS9iac8QfcSfhkaKOrf7Ci5oNaDQPgzVGhKDBJHZArrh7
 GlbtlmeT3NAD1U4//uYbMeGEE2QsHZNnaQ==
X-Google-Smtp-Source: ABdhPJwOZ9MqTFabwt00304R9Jvhb8bu8w0YodEzk7Sl/TMQWmUHvEYsFB9Tp0BizwZwoHJ1CxnL+Q==
X-Received: by 2002:a17:907:9495:: with SMTP id
 dm21mr8491888ejc.462.1613050183766; 
 Thu, 11 Feb 2021 05:29:43 -0800 (PST)
Received: from abel.fritz.box ([2a02:908:1252:fb60:820:5af6:9146:2c9f])
 by smtp.gmail.com with ESMTPSA id w26sm3862627edq.46.2021.02.11.05.29.43
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Thu, 11 Feb 2021 05:29:43 -0800 (PST)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 2/3] drm/ttm: remove swap LRU v2
Date: Thu, 11 Feb 2021 14:29:40 +0100
Message-Id: <20210211132941.290772-2-christian.koenig@amd.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20210211132941.290772-1-christian.koenig@amd.com>
References: <20210211132941.290772-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: ray.huang@amd.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW5zdGVhZCBldmljdCByb3VuZCByb2JpbiBmcm9tIGVhY2ggZGV2aWNlcyBTWVNURU0gYW5kIFRU
IGRvbWFpbi4KCnYyOiByZW9yZGVyIG51bV9wYWdlcyBhY2Nlc3MgcmVwb3J0ZWQgYnkgRGFuJ3Mg
c2NyaXB0CgpTaWduZWQtb2ZmLWJ5OiBDaHJpc3RpYW4gS8O2bmlnIDxjaHJpc3RpYW4ua29lbmln
QGFtZC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm8uYyAgICAgICAgfCAzMSAr
Ky0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3V0aWwuYyAgIHwgIDEg
LQogZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fZGV2aWNlLmMgICAgfCA2MCArKysrKysrKysrKysr
KysrKysrKystLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfZHJ2LmMgfCAg
MiArLQogaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19hcGkuaCAgICAgICAgfCAgMSAtCiBpbmNsdWRl
L2RybS90dG0vdHRtX2JvX2RyaXZlci5oICAgICB8ICAxIC0KIGluY2x1ZGUvZHJtL3R0bS90dG1f
ZGV2aWNlLmggICAgICAgIHwgIDcgKy0tLQogNyBmaWxlcyBjaGFuZ2VkLCA1MiBpbnNlcnRpb25z
KCspLCA1MSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0
bV9iby5jIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm8uYwppbmRleCBkMzM1NzhhMTEyYjQu
LmExYmU4OGJlMzU3YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm8uYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5jCkBAIC03Myw3ICs3Myw2IEBAIHN0YXRp
YyB2b2lkIHR0bV9ib19kZWxfZnJvbV9scnUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibykK
IHsKIAlzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiA9IGJvLT5iZGV2OwogCi0JbGlzdF9kZWxfaW5p
dCgmYm8tPnN3YXApOwogCWxpc3RfZGVsX2luaXQoJmJvLT5scnUpOwogCiAJaWYgKGJkZXYtPmZ1
bmNzLT5kZWxfZnJvbV9scnVfbm90aWZ5KQpAQCAtMTA0LDE0ICsxMDMsNiBAQCB2b2lkIHR0bV9i
b19tb3ZlX3RvX2xydV90YWlsKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAKIAltYW4g
PSB0dG1fbWFuYWdlcl90eXBlKGJkZXYsIG1lbS0+bWVtX3R5cGUpOwogCWxpc3RfbW92ZV90YWls
KCZiby0+bHJ1LCAmbWFuLT5scnVbYm8tPnByaW9yaXR5XSk7Ci0JaWYgKG1hbi0+dXNlX3R0ICYm
IGJvLT50dG0gJiYKLQkgICAgIShiby0+dHRtLT5wYWdlX2ZsYWdzICYgKFRUTV9QQUdFX0ZMQUdf
U0cgfAotCQkJCSAgICAgVFRNX1BBR0VfRkxBR19TV0FQUEVEKSkpIHsKLQkJc3RydWN0IGxpc3Rf
aGVhZCAqc3dhcDsKLQotCQlzd2FwID0gJnR0bV9nbG9iLnN3YXBfbHJ1W2JvLT5wcmlvcml0eV07
Ci0JCWxpc3RfbW92ZV90YWlsKCZiby0+c3dhcCwgc3dhcCk7Ci0JfQogCiAJaWYgKGJkZXYtPmZ1
bmNzLT5kZWxfZnJvbV9scnVfbm90aWZ5KQogCQliZGV2LT5mdW5jcy0+ZGVsX2Zyb21fbHJ1X25v
dGlmeShibyk7CkBAIC0xMjYsOSArMTE3LDYgQEAgdm9pZCB0dG1fYm9fbW92ZV90b19scnVfdGFp
bChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQkJdHRtX2JvX2J1bGtfbW92ZV9zZXRf
cG9zKCZidWxrLT52cmFtW2JvLT5wcmlvcml0eV0sIGJvKTsKIAkJCWJyZWFrOwogCQl9Ci0JCWlm
IChiby0+dHRtICYmICEoYm8tPnR0bS0+cGFnZV9mbGFncyAmCi0JCQkJIChUVE1fUEFHRV9GTEFH
X1NHIHwgVFRNX1BBR0VfRkxBR19TV0FQUEVEKSkpCi0JCQl0dG1fYm9fYnVsa19tb3ZlX3NldF9w
b3MoJmJ1bGstPnN3YXBbYm8tPnByaW9yaXR5XSwgYm8pOwogCX0KIH0KIEVYUE9SVF9TWU1CT0wo
dHRtX2JvX21vdmVfdG9fbHJ1X3RhaWwpOwpAQCAtMTY2LDIwICsxNTQsNiBAQCB2b2lkIHR0bV9i
b19idWxrX21vdmVfbHJ1X3RhaWwoc3RydWN0IHR0bV9scnVfYnVsa19tb3ZlICpidWxrKQogCQls
aXN0X2J1bGtfbW92ZV90YWlsKCZtYW4tPmxydVtpXSwgJnBvcy0+Zmlyc3QtPmxydSwKIAkJCQkg
ICAgJnBvcy0+bGFzdC0+bHJ1KTsKIAl9Ci0KLQlmb3IgKGkgPSAwOyBpIDwgVFRNX01BWF9CT19Q
UklPUklUWTsgKytpKSB7Ci0JCXN0cnVjdCB0dG1fbHJ1X2J1bGtfbW92ZV9wb3MgKnBvcyA9ICZi
dWxrLT5zd2FwW2ldOwotCQlzdHJ1Y3QgbGlzdF9oZWFkICpscnU7Ci0KLQkJaWYgKCFwb3MtPmZp
cnN0KQotCQkJY29udGludWU7Ci0KLQkJZG1hX3Jlc3ZfYXNzZXJ0X2hlbGQocG9zLT5maXJzdC0+
YmFzZS5yZXN2KTsKLQkJZG1hX3Jlc3ZfYXNzZXJ0X2hlbGQocG9zLT5sYXN0LT5iYXNlLnJlc3Yp
OwotCi0JCWxydSA9ICZ0dG1fZ2xvYi5zd2FwX2xydVtpXTsKLQkJbGlzdF9idWxrX21vdmVfdGFp
bChscnUsICZwb3MtPmZpcnN0LT5zd2FwLCAmcG9zLT5sYXN0LT5zd2FwKTsKLQl9CiB9CiBFWFBP
UlRfU1lNQk9MKHR0bV9ib19idWxrX21vdmVfbHJ1X3RhaWwpOwogCkBAIC0xMDU2LDcgKzEwMzAs
NiBAQCBpbnQgdHRtX2JvX2luaXRfcmVzZXJ2ZWQoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsCiAJ
a3JlZl9pbml0KCZiby0+a3JlZik7CiAJSU5JVF9MSVNUX0hFQUQoJmJvLT5scnUpOwogCUlOSVRf
TElTVF9IRUFEKCZiby0+ZGRlc3Ryb3kpOwotCUlOSVRfTElTVF9IRUFEKCZiby0+c3dhcCk7CiAJ
Ym8tPmJkZXYgPSBiZGV2OwogCWJvLT50eXBlID0gdHlwZTsKIAliby0+bWVtLm1lbV90eXBlID0g
VFRNX1BMX1NZU1RFTTsKQEAgLTExOTEsNiArMTE2NCwxMCBAQCBpbnQgdHRtX2JvX3N3YXBvdXQo
c3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywgc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4ICpj
dHgsCiAJYm9vbCBsb2NrZWQ7CiAJaW50IHJldDsKIAorCWlmICghYm8tPnR0bSB8fCBiby0+dHRt
LT5wYWdlX2ZsYWdzICYgKFRUTV9QQUdFX0ZMQUdfU0cgfAorCQkJCQkgICAgICAgVFRNX1BBR0Vf
RkxBR19TV0FQUEVEKSkKKwkJcmV0dXJuIGZhbHNlOworCiAJaWYgKCF0dG1fYm9fZXZpY3Rfc3dh
cG91dF9hbGxvd2FibGUoYm8sIGN0eCwgJmxvY2tlZCwgTlVMTCkpCiAJCXJldHVybiAtRUJVU1k7
CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3V0aWwuYyBiL2RyaXZl
cnMvZ3B1L2RybS90dG0vdHRtX2JvX3V0aWwuYwppbmRleCAwMzFlNTgxOWZlYzQuLmEyYTE3Yzg0
Y2ViMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm9fdXRpbC5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3V0aWwuYwpAQCAtMzAzLDcgKzMwMyw2IEBAIHN0
YXRpYyBpbnQgdHRtX2J1ZmZlcl9vYmplY3RfdHJhbnNmZXIoc3RydWN0IHR0bV9idWZmZXJfb2Jq
ZWN0ICpibywKIAlhdG9taWNfaW5jKCZ0dG1fZ2xvYi5ib19jb3VudCk7CiAJSU5JVF9MSVNUX0hF
QUQoJmZiby0+YmFzZS5kZGVzdHJveSk7CiAJSU5JVF9MSVNUX0hFQUQoJmZiby0+YmFzZS5scnUp
OwotCUlOSVRfTElTVF9IRUFEKCZmYm8tPmJhc2Uuc3dhcCk7CiAJZmJvLT5iYXNlLm1vdmluZyA9
IE5VTEw7CiAJZHJtX3ZtYV9ub2RlX3Jlc2V0KCZmYm8tPmJhc2UuYmFzZS52bWFfbm9kZSk7CiAK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2RldmljZS5jIGIvZHJpdmVycy9n
cHUvZHJtL3R0bS90dG1fZGV2aWNlLmMKaW5kZXggZGZjMmE3ZTRlNDkwLi4yYzI4MGZiMWU5OTIg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2RldmljZS5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS90dG0vdHRtX2RldmljZS5jCkBAIC02Nyw3ICs2Nyw2IEBAIHN0YXRpYyBpbnQg
dHRtX2dsb2JhbF9pbml0KHZvaWQpCiAJdW5zaWduZWQgbG9uZyBudW1fcGFnZXM7CiAJc3RydWN0
IHN5c2luZm8gc2k7CiAJaW50IHJldCA9IDA7Ci0JdW5zaWduZWQgaTsKIAogCW11dGV4X2xvY2so
JnR0bV9nbG9iYWxfbXV0ZXgpOwogCWlmICgrK3R0bV9nbG9iX3VzZV9jb3VudCA+IDEpCkBAIC05
MCw4ICs4OSw2IEBAIHN0YXRpYyBpbnQgdHRtX2dsb2JhbF9pbml0KHZvaWQpCiAJCWdvdG8gb3V0
OwogCX0KIAotCWZvciAoaSA9IDA7IGkgPCBUVE1fTUFYX0JPX1BSSU9SSVRZOyArK2kpCi0JCUlO
SVRfTElTVF9IRUFEKCZnbG9iLT5zd2FwX2xydVtpXSk7CiAJSU5JVF9MSVNUX0hFQUQoJmdsb2It
PmRldmljZV9saXN0KTsKIAlhdG9taWNfc2V0KCZnbG9iLT5ib19jb3VudCwgMCk7CiAKQEAgLTEw
OSwyNyArMTA2LDYwIEBAIHN0YXRpYyBpbnQgdHRtX2dsb2JhbF9pbml0KHZvaWQpCiBsb25nIHR0
bV9nbG9iYWxfc3dhcG91dChzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHggKmN0eCwgZ2ZwX3QgZ2Zw
X2ZsYWdzKQogewogCXN0cnVjdCB0dG1fZ2xvYmFsICpnbG9iID0gJnR0bV9nbG9iOworCXN0cnVj
dCB0dG1fZGV2aWNlICpiZGV2OworCWludCByZXQgPSAtRUJVU1k7CisKKwltdXRleF9sb2NrKCZ0
dG1fZ2xvYmFsX211dGV4KTsKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KGJkZXYsICZnbG9iLT5kZXZp
Y2VfbGlzdCwgZGV2aWNlX2xpc3QpIHsKKwkJcmV0ID0gdHRtX2RldmljZV9zd2Fwb3V0KGJkZXYs
IGN0eCwgZ2ZwX2ZsYWdzKTsKKwkJaWYgKHJldCA+IDApIHsKKwkJCWxpc3RfbW92ZV90YWlsKCZi
ZGV2LT5kZXZpY2VfbGlzdCwgJmdsb2ItPmRldmljZV9saXN0KTsKKwkJCWJyZWFrOworCQl9CisJ
fQorCW11dGV4X3VubG9jaygmdHRtX2dsb2JhbF9tdXRleCk7CisJcmV0dXJuIHJldDsKK30KK0VY
UE9SVF9TWU1CT0wodHRtX2dsb2JhbF9zd2Fwb3V0KTsKKworbG9uZyB0dG1fZGV2aWNlX3N3YXBv
dXQoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0eCAqY3R4
LAorCQkJZ2ZwX3QgZ2ZwX2ZsYWdzKQoreworCXN0cnVjdCB0dG1fZ2xvYmFsICpnbG9iID0gJnR0
bV9nbG9iOworCXN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuOwogCXN0cnVjdCB0dG1f
YnVmZmVyX29iamVjdCAqYm87Ci0JdW5zaWduZWQgaTsKKwl1bnNpZ25lZCBpLCBqOwogCWludCBy
ZXQ7CiAKIAlzcGluX2xvY2soJmdsb2ItPmxydV9sb2NrKTsKLQlmb3IgKGkgPSAwOyBpIDwgVFRN
X01BWF9CT19QUklPUklUWTsgKytpKSB7Ci0JCWxpc3RfZm9yX2VhY2hfZW50cnkoYm8sICZnbG9i
LT5zd2FwX2xydVtpXSwgc3dhcCkgewotCQkJdWludDMyX3QgbnVtX3BhZ2VzID0gYm8tPnR0bS0+
bnVtX3BhZ2VzOwotCi0JCQlyZXQgPSB0dG1fYm9fc3dhcG91dChibywgY3R4LCBnZnBfZmxhZ3Mp
OwotCQkJLyogdHRtX2JvX3N3YXBvdXQgaGFzIGRyb3BwZWQgdGhlIGxydV9sb2NrICovCi0JCQlp
ZiAoIXJldCkKLQkJCQlyZXR1cm4gbnVtX3BhZ2VzOwotCQkJaWYgKHJldCAhPSAtRUJVU1kpCi0J
CQkJcmV0dXJuIHJldDsKKwlmb3IgKGkgPSBUVE1fUExfU1lTVEVNOyBpIDwgVFRNX05VTV9NRU1f
VFlQRVM7ICsraSkgeworCQltYW4gPSB0dG1fbWFuYWdlcl90eXBlKGJkZXYsIGkpOworCQlpZiAo
IW1hbiB8fCAhbWFuLT51c2VfdHQpCisJCQljb250aW51ZTsKKworCQlmb3IgKGogPSAwOyBqIDwg
VFRNX01BWF9CT19QUklPUklUWTsgKytqKSB7CisJCQlsaXN0X2Zvcl9lYWNoX2VudHJ5KGJvLCAm
bWFuLT5scnVbal0sIGxydSkgeworCQkJCWxvbmcgbnVtX3BhZ2VzOworCisJCQkJaWYgKCFiby0+
dHRtIHx8CisJCQkJICAgIGJvLT50dG0tPnBhZ2VfZmxhZ3MgJiBUVE1fUEFHRV9GTEFHX1NHIHx8
CisJCQkJICAgIGJvLT50dG0tPnBhZ2VfZmxhZ3MgJiBUVE1fUEFHRV9GTEFHX1NXQVBQRUQpCisJ
CQkJCWNvbnRpbnVlOworCisJCQkJbnVtX3BhZ2VzID0gYm8tPnR0bS0+bnVtX3BhZ2VzOworCQkJ
CXJldCA9IHR0bV9ib19zd2Fwb3V0KGJvLCBjdHgsIGdmcF9mbGFncyk7CisJCQkJLyogdHRtX2Jv
X3N3YXBvdXQgaGFzIGRyb3BwZWQgdGhlIGxydV9sb2NrICovCisJCQkJaWYgKCFyZXQpCisJCQkJ
CXJldHVybiBudW1fcGFnZXM7CisJCQkJaWYgKHJldCAhPSAtRUJVU1kpCisJCQkJCXJldHVybiBy
ZXQ7CisJCQl9CiAJCX0KIAl9CiAJc3Bpbl91bmxvY2soJmdsb2ItPmxydV9sb2NrKTsKIAlyZXR1
cm4gMDsKIH0KLUVYUE9SVF9TWU1CT0wodHRtX2dsb2JhbF9zd2Fwb3V0KTsKK0VYUE9SVF9TWU1C
T0wodHRtX2RldmljZV9zd2Fwb3V0KTsKIAogc3RhdGljIHZvaWQgdHRtX2luaXRfc3lzbWFuKHN0
cnVjdCB0dG1fZGV2aWNlICpiZGV2KQogewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Zt
d2dmeC92bXdnZnhfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9kcnYuYwpp
bmRleCAwMWRhMzU1Yjg2ZjMuLmNlZjg5NjEyNjM2MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL3Ztd2dmeC92bXdnZnhfZHJ2LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdn
ZnhfZHJ2LmMKQEAgLTEzODQsNyArMTM4NCw3IEBAIHN0YXRpYyBpbnQgdm13X3BtX2ZyZWV6ZShz
dHJ1Y3QgZGV2aWNlICprZGV2KQogCXZtd19leGVjYnVmX3JlbGVhc2VfcGlubmVkX2JvKGRldl9w
cml2KTsKIAl2bXdfcmVzb3VyY2VfZXZpY3RfYWxsKGRldl9wcml2KTsKIAl2bXdfcmVsZWFzZV9k
ZXZpY2VfZWFybHkoZGV2X3ByaXYpOwotCXdoaWxlICh0dG1fZ2xvYmFsX3N3YXBvdXQoJmN0eCwg
R0ZQX0tFUk5FTCkgPiAwKTsKKwl3aGlsZSAodHRtX2RldmljZV9zd2Fwb3V0KCZkZXZfcHJpdi0+
YmRldiwgJmN0eCwgR0ZQX0tFUk5FTCkgPT0gMCk7CiAJaWYgKGRldl9wcml2LT5lbmFibGVfZmIp
CiAJCXZtd19maWZvX3Jlc291cmNlX2RlYyhkZXZfcHJpdik7CiAJaWYgKGF0b21pY19yZWFkKCZk
ZXZfcHJpdi0+bnVtX2ZpZm9fcmVzb3VyY2VzKSAhPSAwKSB7CmRpZmYgLS1naXQgYS9pbmNsdWRl
L2RybS90dG0vdHRtX2JvX2FwaS5oIGIvaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19hcGkuaAppbmRl
eCA1MDQ0YWMzMzA4NTguLjM1ODdmNjYwZThmNCAxMDA2NDQKLS0tIGEvaW5jbHVkZS9kcm0vdHRt
L3R0bV9ib19hcGkuaAorKysgYi9pbmNsdWRlL2RybS90dG0vdHRtX2JvX2FwaS5oCkBAIC0xNDQs
NyArMTQ0LDYgQEAgc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0IHsKIAogCXN0cnVjdCBsaXN0X2hl
YWQgbHJ1OwogCXN0cnVjdCBsaXN0X2hlYWQgZGRlc3Ryb3k7Ci0Jc3RydWN0IGxpc3RfaGVhZCBz
d2FwOwogCiAJLyoqCiAJICogTWVtYmVycyBwcm90ZWN0ZWQgYnkgYSBibyByZXNlcnZhdGlvbi4K
ZGlmZiAtLWdpdCBhL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fZHJpdmVyLmggYi9pbmNsdWRlL2Ry
bS90dG0vdHRtX2JvX2RyaXZlci5oCmluZGV4IDg5NTljMDA3NWNmZC4uZDAwN2ZlZWY3Njc2IDEw
MDY0NAotLS0gYS9pbmNsdWRlL2RybS90dG0vdHRtX2JvX2RyaXZlci5oCisrKyBiL2luY2x1ZGUv
ZHJtL3R0bS90dG1fYm9fZHJpdmVyLmgKQEAgLTY5LDcgKzY5LDYgQEAgc3RydWN0IHR0bV9scnVf
YnVsa19tb3ZlX3BvcyB7CiBzdHJ1Y3QgdHRtX2xydV9idWxrX21vdmUgewogCXN0cnVjdCB0dG1f
bHJ1X2J1bGtfbW92ZV9wb3MgdHRbVFRNX01BWF9CT19QUklPUklUWV07CiAJc3RydWN0IHR0bV9s
cnVfYnVsa19tb3ZlX3BvcyB2cmFtW1RUTV9NQVhfQk9fUFJJT1JJVFldOwotCXN0cnVjdCB0dG1f
bHJ1X2J1bGtfbW92ZV9wb3Mgc3dhcFtUVE1fTUFYX0JPX1BSSU9SSVRZXTsKIH07CiAKIC8qCmRp
ZmYgLS1naXQgYS9pbmNsdWRlL2RybS90dG0vdHRtX2RldmljZS5oIGIvaW5jbHVkZS9kcm0vdHRt
L3R0bV9kZXZpY2UuaAppbmRleCA2YTBiMjY3ZDRmZTYuLmNkYTZlZmI0YzM0YiAxMDA2NDQKLS0t
IGEvaW5jbHVkZS9kcm0vdHRtL3R0bV9kZXZpY2UuaAorKysgYi9pbmNsdWRlL2RybS90dG0vdHRt
X2RldmljZS5oCkBAIC02MywxMSArNjMsNiBAQCBleHRlcm4gc3RydWN0IHR0bV9nbG9iYWwgewog
CSAqLwogCXN0cnVjdCBsaXN0X2hlYWQgZGV2aWNlX2xpc3Q7CiAKLQkvKioKLQkgKiBQcm90ZWN0
ZWQgYnkgdGhlIGxydV9sb2NrLgotCSAqLwotCXN0cnVjdCBsaXN0X2hlYWQgc3dhcF9scnVbVFRN
X01BWF9CT19QUklPUklUWV07Ci0KIAkvKioKIAkgKiBJbnRlcm5hbCBwcm90ZWN0aW9uLgogCSAq
LwpAQCAtMjk4LDYgKzI5Myw4IEBAIHN0cnVjdCB0dG1fZGV2aWNlIHsKIH07CiAKIGxvbmcgdHRt
X2dsb2JhbF9zd2Fwb3V0KHN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0eCAqY3R4LCBnZnBfdCBnZnBf
ZmxhZ3MpOworbG9uZyB0dG1fZGV2aWNlX3N3YXBvdXQoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYs
IHN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0eCAqY3R4LAorCQkgICAgICAgZ2ZwX3QgZ2ZwX2ZsYWdz
KTsKIAogc3RhdGljIGlubGluZSBzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKgogdHRtX21h
bmFnZXJfdHlwZShzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwgaW50IG1lbV90eXBlKQotLSAKMi4y
NS4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmkt
ZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6
Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWwK
