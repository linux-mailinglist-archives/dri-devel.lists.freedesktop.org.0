Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 95F3E17581
	for <lists+dri-devel@lfdr.de>; Wed,  8 May 2019 11:57:59 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 323CA8958E;
	Wed,  8 May 2019 09:57:57 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x544.google.com (mail-ed1-x544.google.com
 [IPv6:2a00:1450:4864:20::544])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6727B8958E
 for <dri-devel@lists.freedesktop.org>; Wed,  8 May 2019 09:57:55 +0000 (UTC)
Received: by mail-ed1-x544.google.com with SMTP id w11so21507711edl.5
 for <dri-devel@lists.freedesktop.org>; Wed, 08 May 2019 02:57:55 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:sender:date:from:to:cc:subject:message-id
 :references:mime-version:content-disposition
 :content-transfer-encoding:in-reply-to:user-agent;
 bh=hyyhjRazC0AaJ+DB+OTThKcNQx89H6njOqmBHKQGtnk=;
 b=XsMRaG5coxbc5CCmI6eDVZZBBIAYfQq+yqUirfIKkip6PayOU4JW7Vynt5t+LtCIY1
 WBPCb8rJuh4JBUOn2u+1ZiUbf0EF2utpxIDLMyzJJdxbeJNhHo/X6kbDNjobmd7s51H/
 2NsgXEcP+MVxQG7SJGi0KS/lV+Wz5WvrMTYwUeUSKqgHwMDJVYn92NUZcnD33cF6P0xb
 GAlEA+vBA4CsBcwXBg0bTkXByuMFToPXkJHWl643p1ssEUzjxEjuDfhJXRD56xqc19Xu
 xQ9lK5g/U8uBB7pCFOjT4acfiHhUgRrGESWnIf2Nc8oAu2zX9UxSkFnvxf73I0kJpM6H
 ywlA==
X-Gm-Message-State: APjAAAVxLzbL+Z7BU2gJrkVjGAc2Pda6Nn6Zxkw455vCPfeC9Uw6xuhS
 attfwy5hpeejYude9Lbfc6BYYA==
X-Google-Smtp-Source: APXvYqxejmu1gomqn66bLKdApfWX2GzHARHG0mD931ftz3Hx/ejmP2EoDape8wmitUrU/iW5adGv/Q==
X-Received: by 2002:a17:906:ef1:: with SMTP id
 x17mr28608701eji.15.1557309473901; 
 Wed, 08 May 2019 02:57:53 -0700 (PDT)
Received: from phenom.ffwll.local ([2a02:168:569e:0:3106:d637:d723:e855])
 by smtp.gmail.com with ESMTPSA id a40sm4981024edd.1.2019.05.08.02.57.52
 (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
 Wed, 08 May 2019 02:57:52 -0700 (PDT)
Date: Wed, 8 May 2019 11:57:50 +0200
From: Daniel Vetter <daniel@ffwll.ch>
To: Christian =?iso-8859-1?Q?K=F6nig?= <ckoenig.leichtzumerken@gmail.com>
Subject: Re: [PATCH 3/9] drm: remove prime sg_table caching
Message-ID: <20190508095749.GW17751@phenom.ffwll.local>
References: <20190507081338.2571-1-christian.koenig@amd.com>
 <20190507081338.2571-3-christian.koenig@amd.com>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <20190507081338.2571-3-christian.koenig@amd.com>
X-Operating-System: Linux phenom 4.14.0-3-amd64 
User-Agent: Mutt/1.10.1 (2018-07-13)
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ffwll.ch; s=google;
 h=sender:date:from:to:cc:subject:message-id:references:mime-version
 :content-disposition:content-transfer-encoding:in-reply-to
 :user-agent;
 bh=hyyhjRazC0AaJ+DB+OTThKcNQx89H6njOqmBHKQGtnk=;
 b=eEStOpZR8q86c5y8oKWdBNHYrG22Q6+NE9k81fw+tyBqqqYa0qguExiQZQ4GOQY4BR
 /PI3TCb2j2HerJVoe+eyuCmBnvnUnNKb5YR/FNlSSFuxm3VP/l5nb+dlOshi5lxuLk62
 WLb+tyvfSgs4uV65CikdkGjPeHvaDI7DzeklY=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gVHVlLCBNYXkgMDcsIDIwMTkgYXQgMTA6MTM6MzJBTSArMDIwMCwgQ2hyaXN0aWFuIEvDtm5p
ZyB3cm90ZToKPiBUaGF0IGlzIG5vdyBkb25lIGJ5IHRoZSBETUEtYnVmIGhlbHBlcnMgaW5zdGVh
ZC4KPiAKPiBTaWduZWQtb2ZmLWJ5OiBDaHJpc3RpYW4gS8O2bmlnIDxjaHJpc3RpYW4ua29lbmln
QGFtZC5jb20+Cj4gLS0tCj4gIGRyaXZlcnMvZ3B1L2RybS9kcm1fcHJpbWUuYyB8IDc2ICsrKysr
KysrLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KPiAgMSBmaWxlIGNoYW5nZWQsIDE2IGlu
c2VydGlvbnMoKyksIDYwIGRlbGV0aW9ucygtKQo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vZHJtX3ByaW1lLmMgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX3ByaW1lLmMKPiBpbmRleCAy
MzFlM2Y2ZDVmNDEuLjkwZjUyMzBjYzBkNSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0v
ZHJtX3ByaW1lLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX3ByaW1lLmMKPiBAQCAtODYs
MTEgKzg2LDYgQEAgc3RydWN0IGRybV9wcmltZV9tZW1iZXIgewo+ICAJc3RydWN0IHJiX25vZGUg
aGFuZGxlX3JiOwo+ICB9Owo+ICAKPiAtc3RydWN0IGRybV9wcmltZV9hdHRhY2htZW50IHsKPiAt
CXN0cnVjdCBzZ190YWJsZSAqc2d0Owo+IC0JZW51bSBkbWFfZGF0YV9kaXJlY3Rpb24gZGlyOwo+
IC19Owo+IC0KPiAgc3RhdGljIGludCBkcm1fcHJpbWVfYWRkX2J1Zl9oYW5kbGUoc3RydWN0IGRy
bV9wcmltZV9maWxlX3ByaXZhdGUgKnByaW1lX2Zwcml2LAo+ICAJCQkJICAgIHN0cnVjdCBkbWFf
YnVmICpkbWFfYnVmLCB1aW50MzJfdCBoYW5kbGUpCj4gIHsKPiBAQCAtMTg4LDI1ICsxODMsMTYg
QEAgc3RhdGljIGludCBkcm1fcHJpbWVfbG9va3VwX2J1Zl9oYW5kbGUoc3RydWN0IGRybV9wcmlt
ZV9maWxlX3ByaXZhdGUgKnByaW1lX2ZwcmkKPiAgICogQGRtYV9idWY6IGJ1ZmZlciB0byBhdHRh
Y2ggZGV2aWNlIHRvCj4gICAqIEBhdHRhY2g6IGJ1ZmZlciBhdHRhY2htZW50IGRhdGEKPiAgICoK
PiAtICogQWxsb2NhdGVzICZkcm1fcHJpbWVfYXR0YWNobWVudCBhbmQgY2FsbHMgJmRybV9kcml2
ZXIuZ2VtX3ByaW1lX3BpbiBmb3IKPiAtICogZGV2aWNlIHNwZWNpZmljIGF0dGFjaG1lbnQuIFRo
aXMgY2FuIGJlIHVzZWQgYXMgdGhlICZkbWFfYnVmX29wcy5hdHRhY2gKPiAtICogY2FsbGJhY2su
Cj4gKyAqIENhbGxzICZkcm1fZHJpdmVyLmdlbV9wcmltZV9waW4gZm9yIGRldmljZSBzcGVjaWZp
YyBoYW5kbGluZy4gVGhpcyBjYW4gYmUKPiArICogdXNlZCBhcyB0aGUgJmRtYV9idWZfb3BzLmF0
dGFjaCBjYWxsYmFjay4KPiAgICoKPiAgICogUmV0dXJucyAwIG9uIHN1Y2Nlc3MsIG5lZ2F0aXZl
IGVycm9yIGNvZGUgb24gZmFpbHVyZS4KPiAgICovCj4gIGludCBkcm1fZ2VtX21hcF9hdHRhY2go
c3RydWN0IGRtYV9idWYgKmRtYV9idWYsCj4gIAkJICAgICAgIHN0cnVjdCBkbWFfYnVmX2F0dGFj
aG1lbnQgKmF0dGFjaCkKPiAgewo+IC0Jc3RydWN0IGRybV9wcmltZV9hdHRhY2htZW50ICpwcmlt
ZV9hdHRhY2g7Cj4gIAlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iaiA9IGRtYV9idWYtPnByaXY7
Cj4gIAo+IC0JcHJpbWVfYXR0YWNoID0ga3phbGxvYyhzaXplb2YoKnByaW1lX2F0dGFjaCksIEdG
UF9LRVJORUwpOwo+IC0JaWYgKCFwcmltZV9hdHRhY2gpCj4gLQkJcmV0dXJuIC1FTk9NRU07Cj4g
LQo+IC0JcHJpbWVfYXR0YWNoLT5kaXIgPSBETUFfTk9ORTsKPiAtCWF0dGFjaC0+cHJpdiA9IHBy
aW1lX2F0dGFjaDsKPiAtCj4gIAlyZXR1cm4gZHJtX2dlbV9waW4ob2JqKTsKPiAgfQo+ICBFWFBP
UlRfU1lNQk9MKGRybV9nZW1fbWFwX2F0dGFjaCk7Cj4gQEAgLTIyMiwyNiArMjA4LDggQEAgRVhQ
T1JUX1NZTUJPTChkcm1fZ2VtX21hcF9hdHRhY2gpOwo+ICB2b2lkIGRybV9nZW1fbWFwX2RldGFj
aChzdHJ1Y3QgZG1hX2J1ZiAqZG1hX2J1ZiwKPiAgCQkJc3RydWN0IGRtYV9idWZfYXR0YWNobWVu
dCAqYXR0YWNoKQo+ICB7Cj4gLQlzdHJ1Y3QgZHJtX3ByaW1lX2F0dGFjaG1lbnQgKnByaW1lX2F0
dGFjaCA9IGF0dGFjaC0+cHJpdjsKPiAgCXN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqID0gZG1h
X2J1Zi0+cHJpdjsKPiAgCj4gLQlpZiAocHJpbWVfYXR0YWNoKSB7Cj4gLQkJc3RydWN0IHNnX3Rh
YmxlICpzZ3QgPSBwcmltZV9hdHRhY2gtPnNndDsKPiAtCj4gLQkJaWYgKHNndCkgewo+IC0JCQlp
ZiAocHJpbWVfYXR0YWNoLT5kaXIgIT0gRE1BX05PTkUpCj4gLQkJCQlkbWFfdW5tYXBfc2dfYXR0
cnMoYXR0YWNoLT5kZXYsIHNndC0+c2dsLAo+IC0JCQkJCQkgICBzZ3QtPm5lbnRzLAo+IC0JCQkJ
CQkgICBwcmltZV9hdHRhY2gtPmRpciwKPiAtCQkJCQkJICAgRE1BX0FUVFJfU0tJUF9DUFVfU1lO
Qyk7Cj4gLQkJCXNnX2ZyZWVfdGFibGUoc2d0KTsKPiAtCQl9Cj4gLQo+IC0JCWtmcmVlKHNndCk7
Cj4gLQkJa2ZyZWUocHJpbWVfYXR0YWNoKTsKPiAtCQlhdHRhY2gtPnByaXYgPSBOVUxMOwo+IC0J
fQo+IC0KPiAgCWRybV9nZW1fdW5waW4ob2JqKTsKPiAgfQo+ICBFWFBPUlRfU1lNQk9MKGRybV9n
ZW1fbWFwX2RldGFjaCk7Cj4gQEAgLTI4NiwzOSArMjU0LDIyIEBAIHZvaWQgZHJtX3ByaW1lX3Jl
bW92ZV9idWZfaGFuZGxlX2xvY2tlZChzdHJ1Y3QgZHJtX3ByaW1lX2ZpbGVfcHJpdmF0ZSAqcHJp
bWVfZnByCj4gIHN0cnVjdCBzZ190YWJsZSAqZHJtX2dlbV9tYXBfZG1hX2J1ZihzdHJ1Y3QgZG1h
X2J1Zl9hdHRhY2htZW50ICphdHRhY2gsCj4gIAkJCQkgICAgIGVudW0gZG1hX2RhdGFfZGlyZWN0
aW9uIGRpcikKPiAgewo+IC0Jc3RydWN0IGRybV9wcmltZV9hdHRhY2htZW50ICpwcmltZV9hdHRh
Y2ggPSBhdHRhY2gtPnByaXY7Cj4gIAlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iaiA9IGF0dGFj
aC0+ZG1hYnVmLT5wcml2Owo+ICAJc3RydWN0IHNnX3RhYmxlICpzZ3Q7Cj4gIAo+IC0JaWYgKFdB
Uk5fT04oZGlyID09IERNQV9OT05FIHx8ICFwcmltZV9hdHRhY2gpKQo+ICsJaWYgKFdBUk5fT04o
ZGlyID09IERNQV9OT05FKSkKPiAgCQlyZXR1cm4gRVJSX1BUUigtRUlOVkFMKTsKPiAgCj4gLQkv
KiByZXR1cm4gdGhlIGNhY2hlZCBtYXBwaW5nIHdoZW4gcG9zc2libGUgKi8KPiAtCWlmIChwcmlt
ZV9hdHRhY2gtPmRpciA9PSBkaXIpCj4gLQkJcmV0dXJuIHByaW1lX2F0dGFjaC0+c2d0Owo+IC0K
PiAtCS8qCj4gLQkgKiB0d28gbWFwcGluZ3Mgd2l0aCBkaWZmZXJlbnQgZGlyZWN0aW9ucyBmb3Ig
dGhlIHNhbWUgYXR0YWNobWVudCBhcmUKPiAtCSAqIG5vdCBhbGxvd2VkCj4gLQkgKi8KPiAtCWlm
IChXQVJOX09OKHByaW1lX2F0dGFjaC0+ZGlyICE9IERNQV9OT05FKSkKPiAtCQlyZXR1cm4gRVJS
X1BUUigtRUJVU1kpOwo+IC0KPiAgCWlmIChvYmotPmZ1bmNzKQo+ICAJCXNndCA9IG9iai0+ZnVu
Y3MtPmdldF9zZ190YWJsZShvYmopOwo+ICAJZWxzZQo+ICAJCXNndCA9IG9iai0+ZGV2LT5kcml2
ZXItPmdlbV9wcmltZV9nZXRfc2dfdGFibGUob2JqKTsKPiAgCj4gLQlpZiAoIUlTX0VSUihzZ3Qp
KSB7Cj4gLQkJaWYgKCFkbWFfbWFwX3NnX2F0dHJzKGF0dGFjaC0+ZGV2LCBzZ3QtPnNnbCwgc2d0
LT5uZW50cywgZGlyLAo+IC0JCQkJICAgICAgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQykpIHsKPiAt
CQkJc2dfZnJlZV90YWJsZShzZ3QpOwo+IC0JCQlrZnJlZShzZ3QpOwo+IC0JCQlzZ3QgPSBFUlJf
UFRSKC1FTk9NRU0pOwo+IC0JCX0gZWxzZSB7Cj4gLQkJCXByaW1lX2F0dGFjaC0+c2d0ID0gc2d0
Owo+IC0JCQlwcmltZV9hdHRhY2gtPmRpciA9IGRpcjsKPiAtCQl9Cj4gKwlpZiAoIWRtYV9tYXBf
c2dfYXR0cnMoYXR0YWNoLT5kZXYsIHNndC0+c2dsLCBzZ3QtPm5lbnRzLCBkaXIsCj4gKwkJCSAg
ICAgIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpKSB7Cj4gKwkJc2dfZnJlZV90YWJsZShzZ3QpOwo+
ICsJCWtmcmVlKHNndCk7Cj4gKwkJc2d0ID0gRVJSX1BUUigtRU5PTUVNKTsKPiAgCX0KPiAgCj4g
IAlyZXR1cm4gc2d0Owo+IEBAIC0zMzEsMTQgKzI4MiwxOSBAQCBFWFBPUlRfU1lNQk9MKGRybV9n
ZW1fbWFwX2RtYV9idWYpOwo+ICAgKiBAc2d0OiBzY2F0dGVybGlzdCBpbmZvIG9mIHRoZSBidWZm
ZXIgdG8gdW5tYXAKPiAgICogQGRpcjogZGlyZWN0aW9uIG9mIERNQSB0cmFuc2Zlcgo+ICAgKgo+
IC0gKiBOb3QgaW1wbGVtZW50ZWQuIFRoZSB1bm1hcCBpcyBkb25lIGF0IGRybV9nZW1fbWFwX2Rl
dGFjaCgpLiAgVGhpcyBjYW4gYmUKPiAtICogdXNlZCBhcyB0aGUgJmRtYV9idWZfb3BzLnVubWFw
X2RtYV9idWYgY2FsbGJhY2suCj4gKyAqIFRoaXMgY2FuIGJlIHVzZWQgYXMgdGhlICZkbWFfYnVm
X29wcy51bm1hcF9kbWFfYnVmIGNhbGxiYWNrLgo+ICAgKi8KPiAgdm9pZCBkcm1fZ2VtX3VubWFw
X2RtYV9idWYoc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCAqYXR0YWNoLAo+ICAJCQkgICBzdHJ1
Y3Qgc2dfdGFibGUgKnNndCwKPiAgCQkJICAgZW51bSBkbWFfZGF0YV9kaXJlY3Rpb24gZGlyKQo+
ICB7Cj4gLQkvKiBub3RoaW5nIHRvIGJlIGRvbmUgaGVyZSAqLwo+ICsJaWYgKCFzZ3QpCj4gKwkJ
cmV0dXJuOwoKVGhpcyBjb3B5cGFzdGEgaXNuJ3QgbmVlZGVkIGFueW1vcmUsIGl0J3MgYSBjYWxs
ZXIgYnVnIGlmIHlvdSBkb24ndCBzdXBwbHkKYW4gc2d0IGhlcmUuIFRoZSBvbGQgY2FjaGluZyBj
b2RlIG9ubHkgbmVlZGVkIGl0IGJlY2F1c2UgaXQgb25seSBjYWNoZWQKb24tZGVtYW5kIGluIHRo
ZSBtYXAgY2FsbGJhY2suIFdpdGggdGhhdDoKClJldmlld2VkLWJ5OiBEYW5pZWwgVmV0dGVyIDxk
YW5pZWwudmV0dGVyQGZmd2xsLmNoPgoKCj4gKwo+ICsJZG1hX3VubWFwX3NnX2F0dHJzKGF0dGFj
aC0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5uZW50cywgZGlyLAo+ICsJCQkgICBETUFfQVRUUl9TS0lQ
X0NQVV9TWU5DKTsKPiArCXNnX2ZyZWVfdGFibGUoc2d0KTsKPiArCWtmcmVlKHNndCk7Cj4gIH0K
PiAgRVhQT1JUX1NZTUJPTChkcm1fZ2VtX3VubWFwX2RtYV9idWYpOwo+ICAKPiAtLSAKPiAyLjE3
LjEKPiAKPiBfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwo+
IGRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKPiBkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
Cj4gaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2
ZWwKCi0tIApEYW5pZWwgVmV0dGVyClNvZnR3YXJlIEVuZ2luZWVyLCBJbnRlbCBDb3Jwb3JhdGlv
bgpodHRwOi8vYmxvZy5mZndsbC5jaApfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVl
ZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5m
by9kcmktZGV2ZWw=
