Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 2EEB310FE05
	for <lists+dri-devel@lfdr.de>; Tue,  3 Dec 2019 13:48:55 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E78BF6E4E8;
	Tue,  3 Dec 2019 12:48:33 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx0a-0014ca01.pphosted.com (mx0b-0014ca01.pphosted.com
 [208.86.201.193])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E07776E03F
 for <dri-devel@lists.freedesktop.org>; Tue,  3 Dec 2019 10:46:11 +0000 (UTC)
Received: from pps.filterd (m0042333.ppops.net [127.0.0.1])
 by mx0b-0014ca01.pphosted.com (8.16.0.42/8.16.0.42) with SMTP id
 xB3AEAZr026025; Tue, 3 Dec 2019 02:14:22 -0800
Received: from nam05-co1-obe.outbound.protection.outlook.com
 (mail-co1nam05lp2056.outbound.protection.outlook.com [104.47.48.56])
 by mx0b-0014ca01.pphosted.com with ESMTP id 2wkmvyurhd-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Tue, 03 Dec 2019 02:14:21 -0800
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=Gpog8tvfrZklhGKYMwQnWM8ZoNAHY9jgP7cOk8LP7vlruFhoRl5zc3E1aGiBxPNy8AXyX/T5o007gJtlcFe44DfHjb506pRhb6ls9w1Bf30A46J/y4hpGyzHffpbkXceIL2vYfuvBBfdxDU8n8hWW7IbnNZQJvUsXk46UF7KxlpSa0PRZohJQ+x/UZrBSXRwVNES0CElrewy16hJ34b4ELmb9VxB1DCV3t35f+3p48dTOgaj4d4gwZDyNI8sJf58kvu463N0o5I8bgk16BgdEvUnSzpMWGrUWJzZtMZtYkgjjqS3XFXP/ps7XOrzvIG4U88ps/ghc4glUdTsgQ+eZw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=l48AtdCfFxxM+p55i2S9fGifCjm4/On2x8xPd5DI3qE=;
 b=JXuszoM2NUP3hpGMkKuq3lk242oDcN1/w1RvzA/tCjbWxPju+hQi6nuA+z3eXwLJOKXJWojTosDLR9jVXjggxGDf3GnIy4kEPmuWqktjpG+OzJ3tUAND2gCVc4CSNrOZv1khNnbpA+go3y5H+MWMp2zgZtBD6H90uPXx9X9OHqoOLoHC+o7G/ailC2F2XUxxfxzyOxDP16sh82iMRPC06iE6K30aDDh2EQeo01MARYjhZevK6h5+9QX0iNEPCLJ2v1ZcfsYmnPQ4yvrp40VweIyaN+hnm77h80RZ+kEYnIF/Ok/XFpt52rwEWu/R+S3tU3u6eRgnYnZloqO88uIBww==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=softfail (sender ip
 is 158.140.1.28) smtp.rcpttodomain=ti.com smtp.mailfrom=cadence.com;
 dmarc=fail (p=none sp=none pct=100) action=none header.from=cadence.com;
 dkim=none (message not signed); arc=none
Received: from MN2PR07CA0014.namprd07.prod.outlook.com (2603:10b6:208:1a0::24)
 by DM5PR07MB3991.namprd07.prod.outlook.com (2603:10b6:4:b0::20) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2495.22; Tue, 3 Dec
 2019 10:14:18 +0000
Received: from MW2NAM12FT060.eop-nam12.prod.protection.outlook.com
 (2a01:111:f400:fe5a::203) by MN2PR07CA0014.outlook.office365.com
 (2603:10b6:208:1a0::24) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2516.12 via Frontend
 Transport; Tue, 3 Dec 2019 10:14:17 +0000
Received-SPF: SoftFail (protection.outlook.com: domain of transitioning
 cadence.com discourages use of 158.140.1.28 as permitted sender)
Received: from sjmaillnx2.cadence.com (158.140.1.28) by
 MW2NAM12FT060.mail.protection.outlook.com (10.13.181.67) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2495.18 via Frontend Transport; Tue, 3 Dec 2019 10:14:17 +0000
Received: from maileu3.global.cadence.com (maileu3.cadence.com [10.160.88.99])
 by sjmaillnx2.cadence.com (8.14.4/8.14.4) with ESMTP id
 xB3AE7t1027708
 (version=TLSv1/SSLv3 cipher=AES256-SHA bits=256 verify=OK);
 Tue, 3 Dec 2019 02:14:16 -0800
X-CrossPremisesHeadersFilteredBySendConnector: maileu3.global.cadence.com
Received: from maileu3.global.cadence.com (10.160.88.99) by
 maileu3.global.cadence.com (10.160.88.99) with Microsoft SMTP Server (TLS) id
 15.0.1367.3; Tue, 3 Dec 2019 11:14:10 +0100
Received: from vleu-orange.cadence.com (10.160.88.83) by
 maileu3.global.cadence.com (10.160.88.99) with Microsoft SMTP Server (TLS) id
 15.0.1367.3 via Frontend Transport; Tue, 3 Dec 2019 11:14:10 +0100
Received: from vleu-orange.cadence.com (localhost.localdomain [127.0.0.1])
 by vleu-orange.cadence.com (8.14.4/8.14.4) with ESMTP id xB3AE9Yp030977;
 Tue, 3 Dec 2019 11:14:09 +0100
Received: (from yamonkar@localhost)
 by vleu-orange.cadence.com (8.14.4/8.14.4/Submit) id xB3AE9Kl030976;
 Tue, 3 Dec 2019 11:14:09 +0100
From: Yuti Amonkar <yamonkar@cadence.com>
To: <dri-devel@lists.freedesktop.org>
Subject: [PATCH v1 12/15] phy: cadence-torrent: Use regmap to read and write
 Torrent PHY registers
Date: Tue, 3 Dec 2019 11:13:22 +0100
Message-ID: <1575368005-29797-13-git-send-email-yamonkar@cadence.com>
X-Mailer: git-send-email 2.4.5
In-Reply-To: <1575368005-29797-1-git-send-email-yamonkar@cadence.com>
References: <1575368005-29797-1-git-send-email-yamonkar@cadence.com>
MIME-Version: 1.0
X-OrganizationHeadersPreserved: maileu3.global.cadence.com
X-EOPAttributedMessage: 0
X-Forefront-Antispam-Report: CIP:158.140.1.28; IPV:CAL; SCL:-1; CTRY:US;
 EFV:NLI; SFV:NSPM;
 SFS:(10009020)(4636009)(39860400002)(396003)(376002)(346002)(136003)(199004)(189003)(36092001)(2906002)(76176011)(50226002)(478600001)(54906003)(70586007)(4326008)(76130400001)(26826003)(87636003)(70206006)(16586007)(2351001)(246002)(7636002)(36756003)(8936002)(305945005)(8676002)(30864003)(5660300002)(316002)(42186006)(11346002)(6916009)(14444005)(336012)(107886003)(2616005)(426003)(186003)(26005)(446003)(356004)(51416003)(50466002)(6666004)(48376002)(86362001)(559001)(579004);
 DIR:OUT; SFP:1101; SCL:1; SRVR:DM5PR07MB3991; H:sjmaillnx2.cadence.com; FPR:;
 SPF:SoftFail; LANG:en; PTR:corp.Cadence.COM; A:1; MX:1; 
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: e67ec4d8-4800-41de-7b2e-08d777d98e5d
X-MS-TrafficTypeDiagnostic: DM5PR07MB3991:
X-Microsoft-Antispam-PRVS: <DM5PR07MB3991362B08882E0FBB0415D4D2420@DM5PR07MB3991.namprd07.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:6108;
X-Forefront-PRVS: 02408926C4
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: qKZ9WHixA++8dBNJ7aVpEHXHydJluG8CRpcW27feavTzpyUyQYHhMXQ4gE6t8v8yYY8tqiSlWkuXzobzSq6/TRze61BK1P1WGF7WXzJmDmjTyVFQcx2f3OfCjW/dGtSKfgF8BFowsnejiecFFV4NEsaSSAnrfkszBHLTd6yKfutvBi2UnhqxU3ESDQns0PnC0ifM6hZwTc4NJa8KiwaTnsgo8uUtJzk/zGOVoq1PvTSY/pLIga3831rCJqFqn1AqqsNiP1XmgH3RkYrPJRVfGhQI2VnDO5/qvrjjKbKTl3KNdRN+FvFHrCK5YFps6/hoLQkF4Oo0Mf5O1A/zp6Q93X3jM7miwlqZW9auNB9dE8N0yPAbirwLplkibIPuZ2KUELNqZo4vyqtLI/u1NcXvXFvvjYaFSoxCVBXeSKgSFGn1ZOwK5OTgyg2QwwxKDShJf19HgWaYP70c3bUAN7Nk4w==
X-OriginatorOrg: cadence.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 03 Dec 2019 10:14:17.5543 (UTC)
X-MS-Exchange-CrossTenant-Network-Message-Id: e67ec4d8-4800-41de-7b2e-08d777d98e5d
X-MS-Exchange-CrossTenant-Id: d36035c5-6ce6-4662-a3dc-e762e61ae4c9
X-MS-Exchange-CrossTenant-OriginalAttributedTenantConnectingIp: TenantId=d36035c5-6ce6-4662-a3dc-e762e61ae4c9; Ip=[158.140.1.28];
 Helo=[sjmaillnx2.cadence.com]
X-MS-Exchange-CrossTenant-FromEntityHeader: HybridOnPrem
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM5PR07MB3991
X-Proofpoint-Virus-Version: vendor=fsecure engine=2.50.10434:6.0.95,18.0.572
 definitions=2019-12-03_02:2019-11-29,2019-12-03 signatures=0
X-Proofpoint-Spam-Details: rule=outbound_check_notspam policy=outbound_check
 score=0
 priorityscore=1501 suspectscore=1 phishscore=0 spamscore=0
 lowpriorityscore=0 bulkscore=0 clxscore=1015 adultscore=0 mlxlogscore=999
 malwarescore=0 mlxscore=0 impostorscore=0 classifier=spam adjust=0
 reason=mlx scancount=1 engine=8.12.0-1910280000
 definitions=main-1912030082
X-Mailman-Approved-At: Tue, 03 Dec 2019 12:48:27 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=cadence.com; h=from : to : cc :
 subject : date : message-id : in-reply-to : references : mime-version :
 content-type; s=proofpoint;
 bh=l48AtdCfFxxM+p55i2S9fGifCjm4/On2x8xPd5DI3qE=;
 b=nkE+fPxOUbpetg46BLj4VbjAsYAzbZ60NfFIOXMkibASj/xi5UthkzJX9GE/Z2kCxeVm
 OFrJyVSXRd+dbxxTyTBQh+Ubcp7enQ/Z+yMAZ6aoUvvuks3TX/s9Tr1hiX3SkZn85uvf
 ZKTYm087AF0lwQR3Noq/5DjC14I/M6E49cEAgyKCqGQRtJHdJo2t7O8nDWJVqp0hmY8T
 Cxqn+mDYmJ9OLek18JbMneDEg1VvZT8PSvzfHx/0vJblPweCvj+Pl3NUYFqEFDma7YVN
 RusnbAyksrlc5fElGzWJf7eu2ecQ+ZCCCy8kA3gWwl6cxqFe11lbU8Y07QpraEtbAHcZ Lw== 
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=cadence.com; s=selector2;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=l48AtdCfFxxM+p55i2S9fGifCjm4/On2x8xPd5DI3qE=;
 b=qlcWxkKbLl9dOBhuNl2//Ty/LMzNauEXNoDzI4lpyTMHMv4fXhZ+z+BbA9fpEh1vQLTIV0YnLMkPfU+eyhdYlA61DUEuGiAOmLKHfq3NiyVFNGle1qFfuElJCI6WQmGymsbuYFEenU8C30fSnvEkeSVkTehj3P80sVvna8ax7K4=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: mparab@cadence.com, yamonkar@cadence.com, praneeth@ti.com,
 dkangude@cadence.com, jsarha@ti.com, kishon@ti.com, tomi.valkeinen@ti.com,
 sjakhade@cadence.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VXNlIHJlZ21hcCBmb3IgYWNjZXNzaW5nIFRvcnJlbnQgUEhZIHJlZ2lzdGVycy4gTW9kaWZ5IHJl
Z2lzdGVyIG9mZnNldHMKYXMgZGVmaW5lZCBpbiBUb3JyZW50IFBIWSB1c2VyIGd1aWRlLiBBYnN0
cmFjdCBhZGRyZXNzIGNhbGN1bGF0aW9uCnVzaW5nIHJlZ21hcCBBUElzLgoKU2lnbmVkLW9mZi1i
eTogWXV0aSBBbW9ua2FyIDx5YW1vbmthckBjYWRlbmNlLmNvbT4KLS0tCiBkcml2ZXJzL3BoeS9j
YWRlbmNlL3BoeS1jYWRlbmNlLXRvcnJlbnQuYyB8IDEwMjAgKysrKysrKysrKysrKysrKysrLS0t
LS0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA2NTAgaW5zZXJ0aW9ucygrKSwgMzcwIGRlbGV0aW9u
cygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvcGh5L2NhZGVuY2UvcGh5LWNhZGVuY2UtdG9ycmVu
dC5jIGIvZHJpdmVycy9waHkvY2FkZW5jZS9waHktY2FkZW5jZS10b3JyZW50LmMKaW5kZXggMDA2
ZTc4Ni4uNzViOGE4MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9waHkvY2FkZW5jZS9waHktY2FkZW5j
ZS10b3JyZW50LmMKKysrIGIvZHJpdmVycy9waHkvY2FkZW5jZS9waHktY2FkZW5jZS10b3JyZW50
LmMKQEAgLTE5LDYgKzE5LDcgQEAKICNpbmNsdWRlIDxsaW51eC9waHkvcGh5Lmg+CiAjaW5jbHVk
ZSA8bGludXgvcGxhdGZvcm1fZGV2aWNlLmg+CiAjaW5jbHVkZSA8bGludXgvcmVzZXQuaD4KKyNp
bmNsdWRlIDxsaW51eC9yZWdtYXAuaD4KIAogI2RlZmluZSBSRUZfQ0xLXzE5XzJNSHoJCTE5MjAw
MDAwCiAjZGVmaW5lIFJFRl9DTEtfMjVNSHoJCTI1MDAwMDAwCkBAIC0yOCw3ICsyOSwyMiBAQAog
I2RlZmluZSBERUZBVUxUX01BWF9CSVRfUkFURQk4MTAwIC8qIGluIE1icHMgKi8KIAogI2RlZmlu
ZSBQT0xMX1RJTUVPVVRfVVMJCTUwMDAKLSNkZWZpbmUgTEFORV9NQVNLCQkweDcKKworI2RlZmlu
ZSBUT1JSRU5UX0NPTU1PTl9DREJfT0ZGU0VUCTB4MAorCisjZGVmaW5lIFRPUlJFTlRfVFhfTEFO
RV9DREJfT0ZGU0VUKGxuLCBibG9ja19vZmZzZXQsIHJlZ19vZmZzZXQpCVwKKwkJCQkoKDB4NDAw
MCA8PCAoYmxvY2tfb2Zmc2V0KSkgKwkJXAorCQkJCSgoKGxuKSA8PCA5KSA8PCAocmVnX29mZnNl
dCkpKQorCisjZGVmaW5lIFRPUlJFTlRfUlhfTEFORV9DREJfT0ZGU0VUKGxuLCBibG9ja19vZmZz
ZXQsIHJlZ19vZmZzZXQpCVwKKwkJCQkoKDB4ODAwMCA8PCAoYmxvY2tfb2Zmc2V0KSkgKwkJXAor
CQkJCSgoKGxuKSA8PCA5KSA8PCAocmVnX29mZnNldCkpKQorCisjZGVmaW5lIFRPUlJFTlRfUEhZ
X1BDU19DT01NT05fT0ZGU0VUKGJsb2NrX29mZnNldCkJXAorCQkJCSgweEMwMDAgPDwgKGJsb2Nr
X29mZnNldCkpCisKKyNkZWZpbmUgVE9SUkVOVF9QSFlfUE1BX0NPTU1PTl9PRkZTRVQoYmxvY2tf
b2Zmc2V0KQlcCisJCQkJKDB4RTAwMCA8PCAoYmxvY2tfb2Zmc2V0KSkKIAogLyoKICAqIHJlZ2lz
dGVyIG9mZnNldHMgZnJvbSBEUFRYIFBIWSByZWdpc3RlciBibG9jayBiYXNlIChpLmUgTUhEUApA
QCAtNTcsMTAwICs3MywxMTQgQEAKICAqIHJlZ2lzdGVyIG9mZnNldHMgZnJvbSBTRDA4MDEgUEhZ
IHJlZ2lzdGVyIGJsb2NrIGJhc2UgKGkuZSBNSERQCiAgKiByZWdpc3RlciBiYXNlICsgMHg1MDAw
MDApCiAgKi8KLSNkZWZpbmUgQ01OX1NTTV9CQU5ER0FQX1RNUgkJMHgwMDA4NAotI2RlZmluZSBD
TU5fU1NNX0JJQVNfVE1SCQkweDAwMDg4Ci0jZGVmaW5lIENNTl9QTExTTTBfUExMUFJFX1RNUgkJ
MHgwMDBhOAotI2RlZmluZSBDTU5fUExMU00wX1BMTExPQ0tfVE1SCQkweDAwMGIwCi0jZGVmaW5l
IENNTl9QTExTTTFfUExMUFJFX1RNUgkJMHgwMDBjOAotI2RlZmluZSBDTU5fUExMU00xX1BMTExP
Q0tfVE1SCQkweDAwMGQwCi0jZGVmaW5lIENNTl9CR0NBTF9JTklUX1RNUgkJMHgwMDE5MAotI2Rl
ZmluZSBDTU5fQkdDQUxfSVRFUl9UTVIJCTB4MDAxOTQKLSNkZWZpbmUgQ01OX0lCQ0FMX0lOSVRf
VE1SCQkweDAwMWQwCi0jZGVmaW5lIENNTl9QTEwwX1ZDT0NBTF9UQ1RSTAkJMHgwMDIwOAotI2Rl
ZmluZSBDTU5fUExMMF9WQ09DQUxfSU5JVF9UTVIJMHgwMDIxMAotI2RlZmluZSBDTU5fUExMMF9W
Q09DQUxfSVRFUl9UTVIJMHgwMDIxNAotI2RlZmluZSBDTU5fUExMMF9WQ09DQUxfUkVGVElNX1NU
QVJUCTB4MDAyMTgKLSNkZWZpbmUgQ01OX1BMTDBfVkNPQ0FMX1BMTENOVF9TVEFSVAkweDAwMjIw
Ci0jZGVmaW5lIENNTl9QTEwwX0lOVERJVl9NMAkJMHgwMDI0MAotI2RlZmluZSBDTU5fUExMMF9G
UkFDRElWTF9NMAkJMHgwMDI0NAotI2RlZmluZSBDTU5fUExMMF9GUkFDRElWSF9NMAkJMHgwMDI0
OAotI2RlZmluZSBDTU5fUExMMF9ISUdIX1RIUl9NMAkJMHgwMDI0YwotI2RlZmluZSBDTU5fUExM
MF9EU01fRElBR19NMAkJMHgwMDI1MAotI2RlZmluZSBDTU5fUExMMF9TU19DVFJMMV9NMAkJMHgw
MDI2MAotI2RlZmluZSBDTU5fUExMMF9TU19DVFJMMl9NMCAgICAgICAgICAgIDB4MDAyNjQKLSNk
ZWZpbmUgQ01OX1BMTDBfU1NfQ1RSTDNfTTAgICAgICAgICAgICAweDAwMjY4Ci0jZGVmaW5lIENN
Tl9QTEwwX1NTX0NUUkw0X00wICAgICAgICAgICAgMHgwMDI2QwotI2RlZmluZSBDTU5fUExMMF9M
T0NLX1JFRkNOVF9TVEFSVCAgICAgIDB4MDAyNzAKLSNkZWZpbmUgQ01OX1BMTDBfTE9DS19QTExD
TlRfU1RBUlQJMHgwMDI3OAotI2RlZmluZSBDTU5fUExMMF9MT0NLX1BMTENOVF9USFIgICAgICAg
IDB4MDAyN0MKLSNkZWZpbmUgQ01OX1BMTDFfVkNPQ0FMX1RDVFJMCQkweDAwMzA4Ci0jZGVmaW5l
IENNTl9QTEwxX1ZDT0NBTF9JTklUX1RNUgkweDAwMzEwCi0jZGVmaW5lIENNTl9QTEwxX1ZDT0NB
TF9JVEVSX1RNUgkweDAwMzE0Ci0jZGVmaW5lIENNTl9QTEwxX1ZDT0NBTF9SRUZUSU1fU1RBUlQJ
MHgwMDMxOAotI2RlZmluZSBDTU5fUExMMV9WQ09DQUxfUExMQ05UX1NUQVJUCTB4MDAzMjAKLSNk
ZWZpbmUgQ01OX1BMTDFfSU5URElWX00wCQkweDAwMzQwCi0jZGVmaW5lIENNTl9QTEwxX0ZSQUNE
SVZMX00wCQkweDAwMzQ0Ci0jZGVmaW5lIENNTl9QTEwxX0ZSQUNESVZIX00wCQkweDAwMzQ4Ci0j
ZGVmaW5lIENNTl9QTEwxX0hJR0hfVEhSX00wCQkweDAwMzRjCi0jZGVmaW5lIENNTl9QTEwxX0RT
TV9ESUFHX00wCQkweDAwMzUwCi0jZGVmaW5lIENNTl9QTEwxX1NTX0NUUkwxX00wCQkweDAwMzYw
Ci0jZGVmaW5lIENNTl9QTEwxX1NTX0NUUkwyX00wICAgICAgICAgICAgMHgwMDM2NAotI2RlZmlu
ZSBDTU5fUExMMV9TU19DVFJMM19NMCAgICAgICAgICAgIDB4MDAzNjgKLSNkZWZpbmUgQ01OX1BM
TDFfU1NfQ1RSTDRfTTAgICAgICAgICAgICAweDAwMzZDCi0jZGVmaW5lIENNTl9QTEwxX0xPQ0tf
UkVGQ05UX1NUQVJUICAgICAgMHgwMDM3MAotI2RlZmluZSBDTU5fUExMMV9MT0NLX1BMTENOVF9T
VEFSVAkweDAwMzc4Ci0jZGVmaW5lIENNTl9QTEwxX0xPQ0tfUExMQ05UX1RIUiAgICAgICAgMHgw
MDM3QwotI2RlZmluZSBDTU5fVFhQVUNBTF9JTklUX1RNUgkJMHgwMDQxMAotI2RlZmluZSBDTU5f
VFhQVUNBTF9JVEVSX1RNUgkJMHgwMDQxNAotI2RlZmluZSBDTU5fVFhQRENBTF9JTklUX1RNUgkJ
MHgwMDQzMAotI2RlZmluZSBDTU5fVFhQRENBTF9JVEVSX1RNUgkJMHgwMDQzNAotI2RlZmluZSBD
TU5fUlhDQUxfSU5JVF9UTVIJCTB4MDA0NTAKLSNkZWZpbmUgQ01OX1JYQ0FMX0lURVJfVE1SCQkw
eDAwNDU0Ci0jZGVmaW5lIENNTl9TRF9DQUxfSU5JVF9UTVIJCTB4MDA0OTAKLSNkZWZpbmUgQ01O
X1NEX0NBTF9JVEVSX1RNUgkJMHgwMDQ5NAotI2RlZmluZSBDTU5fU0RfQ0FMX1JFRlRJTV9TVEFS
VAkJMHgwMDQ5OAotI2RlZmluZSBDTU5fU0RfQ0FMX1BMTENOVF9TVEFSVAkJMHgwMDRhMAotI2Rl
ZmluZSBDTU5fUERJQUdfUExMMF9DVFJMX00wCQkweDAwNjgwCi0jZGVmaW5lIENNTl9QRElBR19Q
TEwwX0NMS19TRUxfTTAJMHgwMDY4NAotI2RlZmluZSBDTU5fUERJQUdfUExMMF9DUF9QQURKX00w
CTB4MDA2OTAKLSNkZWZpbmUgQ01OX1BESUFHX1BMTDBfQ1BfSUFESl9NMAkweDAwNjk0Ci0jZGVm
aW5lIENNTl9QRElBR19QTEwwX0ZJTFRfUEFESl9NMAkweDAwNjk4Ci0jZGVmaW5lIENNTl9QRElB
R19QTEwwX0NQX1BBREpfTTEJMHgwMDZkMAotI2RlZmluZSBDTU5fUERJQUdfUExMMF9DUF9JQURK
X00xCTB4MDA2ZDQKLSNkZWZpbmUgQ01OX1BESUFHX1BMTDFfQ1RSTF9NMAkJMHgwMDcwMAotI2Rl
ZmluZSBDTU5fUERJQUdfUExMMV9DTEtfU0VMX00wCTB4MDA3MDQKLSNkZWZpbmUgQ01OX1BESUFH
X1BMTDFfQ1BfUEFESl9NMAkweDAwNzEwCi0jZGVmaW5lIENNTl9QRElBR19QTEwxX0NQX0lBREpf
TTAJMHgwMDcxNAotI2RlZmluZSBDTU5fUERJQUdfUExMMV9GSUxUX1BBREpfTTAJMHgwMDcxOAot
Ci0jZGVmaW5lIFRYX1RYQ0NfQ1RSTAkJCTB4MTAxMDAKLSNkZWZpbmUgVFhfVFhDQ19DUE9TVF9N
VUxUXzAwCQkweDEwMTMwCi0jZGVmaW5lIFRYX1RYQ0NfTUdORlNfTVVMVF8wMDAJCTB4MTAxNDAK
LSNkZWZpbmUgRFJWX0RJQUdfVFhfRFJWCQkJMHgxMDMxOAotI2RlZmluZSBYQ1ZSX0RJQUdfUExM
RFJDX0NUUkwJCTB4MTAzOTQKLSNkZWZpbmUgWENWUl9ESUFHX0hTQ0xLX1NFTAkJMHgxMDM5OAot
I2RlZmluZSBYQ1ZSX0RJQUdfSFNDTEtfRElWCQkweDEwMzljCi0jZGVmaW5lIFhDVlJfRElBR19C
SURJX0NUUkwJCTB4MTAzYTgKLSNkZWZpbmUgVFhfUFNDX0EwCQkJMHgxMDQwMAotI2RlZmluZSBU
WF9QU0NfQTEJCQkweDEwNDA0Ci0jZGVmaW5lIFRYX1BTQ19BMgkJCTB4MTA0MDgKLSNkZWZpbmUg
VFhfUFNDX0EzCQkJMHgxMDQwYwotI2RlZmluZSBUWF9SQ1ZERVRfU1RfVE1SCQkweDEwNDhjCi0j
ZGVmaW5lIFRYX0RJQUdfQUNZQQkJCTB4MTA3OWMKKyNkZWZpbmUgQ01OX1NTTV9CQU5ER0FQX1RN
UgkJMHgwMDIxVQorI2RlZmluZSBDTU5fU1NNX0JJQVNfVE1SCQkweDAwMjJVCisjZGVmaW5lIENN
Tl9QTExTTTBfUExMUFJFX1RNUgkJMHgwMDJBVQorI2RlZmluZSBDTU5fUExMU00wX1BMTExPQ0tf
VE1SCQkweDAwMkNVCisjZGVmaW5lIENNTl9QTExTTTFfUExMUFJFX1RNUgkJMHgwMDMyVQorI2Rl
ZmluZSBDTU5fUExMU00xX1BMTExPQ0tfVE1SCQkweDAwMzRVCisjZGVmaW5lIENNTl9CR0NBTF9J
TklUX1RNUgkJMHgwMDY0VQorI2RlZmluZSBDTU5fQkdDQUxfSVRFUl9UTVIJCTB4MDA2NVUKKyNk
ZWZpbmUgQ01OX0lCQ0FMX0lOSVRfVE1SCQkweDAwNzRVCisjZGVmaW5lIENNTl9QTEwwX1ZDT0NB
TF9UQ1RSTAkJMHgwMDgyVQorI2RlZmluZSBDTU5fUExMMF9WQ09DQUxfSU5JVF9UTVIJMHgwMDg0
VQorI2RlZmluZSBDTU5fUExMMF9WQ09DQUxfSVRFUl9UTVIJMHgwMDg1VQorI2RlZmluZSBDTU5f
UExMMF9WQ09DQUxfUkVGVElNX1NUQVJUCTB4MDA4NlUKKyNkZWZpbmUgQ01OX1BMTDBfVkNPQ0FM
X1BMTENOVF9TVEFSVAkweDAwODhVCisjZGVmaW5lIENNTl9QTEwwX0lOVERJVl9NMAkJMHgwMDkw
VQorI2RlZmluZSBDTU5fUExMMF9GUkFDRElWTF9NMAkJMHgwMDkxVQorI2RlZmluZSBDTU5fUExM
MF9GUkFDRElWSF9NMAkJMHgwMDkyVQorI2RlZmluZSBDTU5fUExMMF9ISUdIX1RIUl9NMAkJMHgw
MDkzVQorI2RlZmluZSBDTU5fUExMMF9EU01fRElBR19NMAkJMHgwMDk0VQorI2RlZmluZSBDTU5f
UExMMF9TU19DVFJMMV9NMAkJMHgwMDk4VQorI2RlZmluZSBDTU5fUExMMF9TU19DVFJMMl9NMCAg
ICAgICAgICAgIDB4MDA5OVUKKyNkZWZpbmUgQ01OX1BMTDBfU1NfQ1RSTDNfTTAgICAgICAgICAg
ICAweDAwOUFVCisjZGVmaW5lIENNTl9QTEwwX1NTX0NUUkw0X00wICAgICAgICAgICAgMHgwMDlC
VQorI2RlZmluZSBDTU5fUExMMF9MT0NLX1JFRkNOVF9TVEFSVCAgICAgIDB4MDA5Q1UKKyNkZWZp
bmUgQ01OX1BMTDBfTE9DS19QTExDTlRfU1RBUlQJMHgwMDlFVQorI2RlZmluZSBDTU5fUExMMF9M
T0NLX1BMTENOVF9USFIgICAgICAgIDB4MDA5RlUKKyNkZWZpbmUgQ01OX1BMTDFfVkNPQ0FMX1RD
VFJMCQkweDAwQzJVCisjZGVmaW5lIENNTl9QTEwxX1ZDT0NBTF9JTklUX1RNUgkweDAwQzRVCisj
ZGVmaW5lIENNTl9QTEwxX1ZDT0NBTF9JVEVSX1RNUgkweDAwQzVVCisjZGVmaW5lIENNTl9QTEwx
X1ZDT0NBTF9SRUZUSU1fU1RBUlQJMHgwMEM2VQorI2RlZmluZSBDTU5fUExMMV9WQ09DQUxfUExM
Q05UX1NUQVJUCTB4MDBDOFUKKyNkZWZpbmUgQ01OX1BMTDFfSU5URElWX00wCQkweDAwRDBVCisj
ZGVmaW5lIENNTl9QTEwxX0ZSQUNESVZMX00wCQkweDAwRDFVCisjZGVmaW5lIENNTl9QTEwxX0ZS
QUNESVZIX00wCQkweDAwRDJVCisjZGVmaW5lIENNTl9QTEwxX0hJR0hfVEhSX00wCQkweDAwRDNV
CisjZGVmaW5lIENNTl9QTEwxX0RTTV9ESUFHX00wCQkweDAwRDRVCisjZGVmaW5lIENNTl9QTEwx
X1NTX0NUUkwxX00wCQkweDAwRDhVCisjZGVmaW5lIENNTl9QTEwxX1NTX0NUUkwyX00wICAgICAg
ICAgICAgMHgwMEQ5VQorI2RlZmluZSBDTU5fUExMMV9TU19DVFJMM19NMCAgICAgICAgICAgIDB4
MDBEQVUKKyNkZWZpbmUgQ01OX1BMTDFfU1NfQ1RSTDRfTTAgICAgICAgICAgICAweDAwREJVCisj
ZGVmaW5lIENNTl9QTEwxX0xPQ0tfUkVGQ05UX1NUQVJUICAgICAgMHgwMERDVQorI2RlZmluZSBD
TU5fUExMMV9MT0NLX1BMTENOVF9TVEFSVAkweDAwREVVCisjZGVmaW5lIENNTl9QTEwxX0xPQ0tf
UExMQ05UX1RIUiAgICAgICAgMHgwMERGVQorI2RlZmluZSBDTU5fVFhQVUNBTF9JTklUX1RNUgkJ
MHgwMTA0VQorI2RlZmluZSBDTU5fVFhQVUNBTF9JVEVSX1RNUgkJMHgwMTA1VQorI2RlZmluZSBD
TU5fVFhQRENBTF9JTklUX1RNUgkJMHgwMTBDVQorI2RlZmluZSBDTU5fVFhQRENBTF9JVEVSX1RN
UgkJMHgwMTBEVQorI2RlZmluZSBDTU5fUlhDQUxfSU5JVF9UTVIJCTB4MDExNFUKKyNkZWZpbmUg
Q01OX1JYQ0FMX0lURVJfVE1SCQkweDAxMTVVCisjZGVmaW5lIENNTl9TRF9DQUxfSU5JVF9UTVIJ
CTB4MDEyNFUKKyNkZWZpbmUgQ01OX1NEX0NBTF9JVEVSX1RNUgkJMHgwMTI1VQorI2RlZmluZSBD
TU5fU0RfQ0FMX1JFRlRJTV9TVEFSVAkJMHgwMTI2VQorI2RlZmluZSBDTU5fU0RfQ0FMX1BMTENO
VF9TVEFSVAkJMHgwMTI4VQorI2RlZmluZSBDTU5fUERJQUdfUExMMF9DVFJMX00wCQkweDAxQTBV
CisjZGVmaW5lIENNTl9QRElBR19QTEwwX0NMS19TRUxfTTAJMHgwMUExVQorI2RlZmluZSBDTU5f
UERJQUdfUExMMF9DUF9QQURKX00wCTB4MDFBNFUKKyNkZWZpbmUgQ01OX1BESUFHX1BMTDBfQ1Bf
SUFESl9NMAkweDAxQTVVCisjZGVmaW5lIENNTl9QRElBR19QTEwwX0ZJTFRfUEFESl9NMAkweDAx
QTZVCisjZGVmaW5lIENNTl9QRElBR19QTEwwX0NQX1BBREpfTTEJMHgwMUI0VQorI2RlZmluZSBD
TU5fUERJQUdfUExMMF9DUF9JQURKX00xCTB4MDFCNVUKKyNkZWZpbmUgQ01OX1BESUFHX1BMTDFf
Q1RSTF9NMAkJMHgwMUMwVQorI2RlZmluZSBDTU5fUERJQUdfUExMMV9DTEtfU0VMX00wCTB4MDFD
MVUKKyNkZWZpbmUgQ01OX1BESUFHX1BMTDFfQ1BfUEFESl9NMAkweDAxQzRVCisjZGVmaW5lIENN
Tl9QRElBR19QTEwxX0NQX0lBREpfTTAJMHgwMUM1VQorI2RlZmluZSBDTU5fUERJQUdfUExMMV9G
SUxUX1BBREpfTTAJMHgwMUM2VQorCisvKiBQTUEgVFggTGFuZSByZWdpc3RlcnMgKi8KKyNkZWZp
bmUgVFhfVFhDQ19DVFJMCQkJMHgwMDQwVQorI2RlZmluZSBUWF9UWENDX0NQT1NUX01VTFRfMDAJ
CTB4MDA0Q1UKKyNkZWZpbmUgVFhfVFhDQ19NR05GU19NVUxUXzAwMAkJMHgwMDUwVQorI2RlZmlu
ZSBEUlZfRElBR19UWF9EUlYJCQkweDAwQzZVCisjZGVmaW5lIFhDVlJfRElBR19QTExEUkNfQ1RS
TAkJMHgwMEU1VQorI2RlZmluZSBYQ1ZSX0RJQUdfSFNDTEtfU0VMCQkweDAwRTZVCisjZGVmaW5l
IFhDVlJfRElBR19IU0NMS19ESVYJCTB4MDBFN1UKKyNkZWZpbmUgWENWUl9ESUFHX0JJRElfQ1RS
TAkJMHgwMEVBVQorI2RlZmluZSBUWF9QU0NfQTAJCQkweDAxMDBVCisjZGVmaW5lIFRYX1BTQ19B
MgkJCTB4MDEwMlUKKyNkZWZpbmUgVFhfUFNDX0EzCQkJMHgwMTAzVQorI2RlZmluZSBUWF9SQ1ZE
RVRfU1RfVE1SCQkweDAxMjNVCisjZGVmaW5lIFRYX0RJQUdfQUNZQQkJCTB4MDFFN1UKICNkZWZp
bmUgVFhfRElBR19BQ1lBX0hCRENfTUFTSwkJMHgwMDAxVQotI2RlZmluZSBSWF9QU0NfQTAJCQkw
eDIwMDAwCi0jZGVmaW5lIFJYX1BTQ19BMQkJCTB4MjAwMDQKLSNkZWZpbmUgUlhfUFNDX0EyCQkJ
MHgyMDAwOAotI2RlZmluZSBSWF9QU0NfQTMJCQkweDIwMDBjCi0jZGVmaW5lIFJYX1BTQ19DQUwJ
CQkweDIwMDE4Ci0jZGVmaW5lIFJYX1JFRV9HQ1NNMV9DVFJMCQkweDIwNDIwCi0jZGVmaW5lIFJY
X1JFRV9HQ1NNMl9DVFJMCQkweDIwNDQwCi0jZGVmaW5lIFJYX1JFRV9QRVJHQ1NNX0NUUkwJCTB4
MjA0NjAKIAotI2RlZmluZSBQSFlfUExMX0NGRwkJCTB4MzAwMzgKKy8qIFBNQSBSWCBMYW5lIHJl
Z2lzdGVycyAqLworI2RlZmluZSBSWF9QU0NfQTAJCQkweDAwMDBVCisjZGVmaW5lIFJYX1BTQ19B
MgkJCTB4MDAwMlUKKyNkZWZpbmUgUlhfUFNDX0EzCQkJMHgwMDAzVQorI2RlZmluZSBSWF9QU0Nf
Q0FMCQkJMHgwMDA2VQorI2RlZmluZSBSWF9SRUVfR0NTTTFfQ1RSTAkJMHgwMTA4VQorI2RlZmlu
ZSBSWF9SRUVfR0NTTTJfQ1RSTAkJMHgwMTEwVQorI2RlZmluZSBSWF9SRUVfUEVSR0NTTV9DVFJM
CQkweDAxMThVCisKKy8qIFBIWSBQQ1MgY29tbW9uIHJlZ2lzdGVycyAqLworI2RlZmluZSBQSFlf
UExMX0NGRwkJCTB4MDAwRVUKKworLyogUEhZIFBNQSBjb21tb24gcmVnaXN0ZXJzICovCisjZGVm
aW5lIFBIWV9QTUFfQ01OX0NUUkwyCQkweDAwMDFVCisjZGVmaW5lIFBIWV9QTUFfUExMX1JBV19D
VFJMCQkweDAwMDNVCiAKLSNkZWZpbmUgUEhZX1BNQV9DTU5fQ1RSTDIJCTB4MzgwMDQKLSNkZWZp
bmUgUEhZX1BNQV9QTExfUkFXX0NUUkwJCTB4MzgwMGMKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgcmVn
X2ZpZWxkIHBoeV9wbGxfY2ZnID0KKwkJCQlSRUdfRklFTEQoUEhZX1BMTF9DRkcsIDAsIDEpOwor
CitzdGF0aWMgY29uc3Qgc3RydWN0IHJlZ19maWVsZCBwaHlfcG1hX2Ntbl9jdHJsXzIgPQorCQkJ
CVJFR19GSUVMRChQSFlfUE1BX0NNTl9DVFJMMiwgMCwgNyk7CisKK3N0YXRpYyBjb25zdCBzdHJ1
Y3QgcmVnX2ZpZWxkIHBoeV9wbWFfcGxsX3Jhd19jdHJsID0KKwkJCQlSRUdfRklFTEQoUEhZX1BN
QV9QTExfUkFXX0NUUkwsIDAsIDEpOworCitzdGF0aWMgY29uc3Qgc3RydWN0IG9mX2RldmljZV9p
ZCBjZG5zX3RvcnJlbnRfcGh5X29mX21hdGNoW107CiAKIHN0cnVjdCBjZG5zX3RvcnJlbnRfcGh5
IHsKIAl2b2lkIF9faW9tZW0gKmJhc2U7CS8qIERQVFggcmVnaXN0ZXJzIGJhc2UgKi8KQEAgLTE2
MSw2ICsxOTEsMTUgQEAgc3RydWN0IGNkbnNfdG9ycmVudF9waHkgewogCXN0cnVjdCBkZXZpY2Ug
KmRldjsKIAlzdHJ1Y3QgY2xrICpjbGs7CiAJdW5zaWduZWQgbG9uZyByZWZfY2xrX3JhdGU7CisJ
c3RydWN0IHJlZ21hcCAqcmVnbWFwOworCXN0cnVjdCByZWdtYXAgKnJlZ21hcF9jb21tb25fY2Ri
OworCXN0cnVjdCByZWdtYXAgKnJlZ21hcF9waHlfcGNzX2NvbW1vbl9jZGI7CisJc3RydWN0IHJl
Z21hcCAqcmVnbWFwX3BoeV9wbWFfY29tbW9uX2NkYjsKKwlzdHJ1Y3QgcmVnbWFwICpyZWdtYXBf
dHhfbGFuZV9jZGJbTUFYX05VTV9MQU5FU107CisJc3RydWN0IHJlZ21hcCAqcmVnbWFwX3J4X2xh
bmVfY2RiW01BWF9OVU1fTEFORVNdOworCXN0cnVjdCByZWdtYXBfZmllbGQgKnBoeV9wbGxfY2Zn
OworCXN0cnVjdCByZWdtYXBfZmllbGQgKnBoeV9wbWFfY21uX2N0cmxfMjsKKwlzdHJ1Y3QgcmVn
bWFwX2ZpZWxkICpwaHlfcG1hX3BsbF9yYXdfY3RybDsKIH07CiAKIGVudW0gcGh5X3Bvd2Vyc3Rh
dGUgewpAQCAtMjEzLDIzICsyNTIsMTA2IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgcGh5X29wcyBj
ZG5zX3RvcnJlbnRfcGh5X29wcyA9IHsKIAkub3duZXIJCT0gVEhJU19NT0RVTEUsCiB9OwogCi0v
KiBQSFkgbW1yIGFjY2VzcyBmdW5jdGlvbnMgKi8KK3N0cnVjdCBjZG5zX3RvcnJlbnRfZGF0YSB7
CisJCXU4IGJsb2NrX29mZnNldF9zaGlmdDsKKwkJdTggcmVnX29mZnNldF9zaGlmdDsKK307CiAK
LXN0YXRpYyB2b2lkIGNkbnNfdG9ycmVudF9waHlfd3JpdGUoc3RydWN0IGNkbnNfdG9ycmVudF9w
aHkgKmNkbnNfcGh5LAotCQkJCSAgIHUzMiBvZmZzZXQsIHUzMiB2YWwpCitzdHJ1Y3QgY2Ruc19y
ZWdtYXBfY2RiX2NvbnRleHQgeworCXN0cnVjdCBkZXZpY2UgKmRldjsKKwl2b2lkIF9faW9tZW0g
KmJhc2U7CisJdTggcmVnX29mZnNldF9zaGlmdDsKK307CisKK3N0YXRpYyBpbnQgY2Ruc19yZWdt
YXBfd3JpdGUodm9pZCAqY29udGV4dCwgdW5zaWduZWQgaW50IHJlZywgdW5zaWduZWQgaW50IHZh
bCkKIHsKLQl3cml0ZWwodmFsLCBjZG5zX3BoeS0+c2RfYmFzZSArIG9mZnNldCk7CisJc3RydWN0
IGNkbnNfcmVnbWFwX2NkYl9jb250ZXh0ICpjdHggPSBjb250ZXh0OworCXUzMiBvZmZzZXQgPSBy
ZWcgPDwgY3R4LT5yZWdfb2Zmc2V0X3NoaWZ0OworCisJd3JpdGV3KHZhbCwgY3R4LT5iYXNlICsg
b2Zmc2V0KTsKKworCXJldHVybiAwOwogfQogCi1zdGF0aWMgdTMyIGNkbnNfdG9ycmVudF9waHlf
cmVhZChzdHJ1Y3QgY2Ruc190b3JyZW50X3BoeSAqY2Ruc19waHksIHUzMiBvZmZzZXQpCitzdGF0
aWMgaW50IGNkbnNfcmVnbWFwX3JlYWQodm9pZCAqY29udGV4dCwgdW5zaWduZWQgaW50IHJlZywg
dW5zaWduZWQgaW50ICp2YWwpCiB7Ci0JcmV0dXJuIHJlYWRsKGNkbnNfcGh5LT5zZF9iYXNlICsg
b2Zmc2V0KTsKKwlzdHJ1Y3QgY2Ruc19yZWdtYXBfY2RiX2NvbnRleHQgKmN0eCA9IGNvbnRleHQ7
CisJdTMyIG9mZnNldCA9IHJlZyA8PCBjdHgtPnJlZ19vZmZzZXRfc2hpZnQ7CisKKwkqdmFsID0g
cmVhZHcoY3R4LT5iYXNlICsgb2Zmc2V0KTsKKwlyZXR1cm4gMDsKIH0KIAotI2RlZmluZSBjZG5z
X3RvcnJlbnRfcGh5X3JlYWRfcG9sbF90aW1lb3V0KGNkbnNfcGh5LCBvZmZzZXQsIHZhbCwgY29u
ZCwgXAotCQkJCQkgICBkZWxheV91cywgdGltZW91dF91cykgXAotCXJlYWRsX3BvbGxfdGltZW91
dCgoY2Ruc19waHkpLT5zZF9iYXNlICsgKG9mZnNldCksIFwKLQkJCSAgIHZhbCwgY29uZCwgZGVs
YXlfdXMsIHRpbWVvdXRfdXMpCisjZGVmaW5lIFRPUlJFTlRfVFhfTEFORV9DREJfUkVHTUFQX0NP
TkYobikgXAoreyBcCisJLm5hbWUgPSAidG9ycmVudF90eF9sYW5lIiBuICJfY2RiIiwgXAorCS5y
ZWdfc3RyaWRlID0gMSwgXAorCS5mYXN0X2lvID0gdHJ1ZSwgXAorCS5yZWdfd3JpdGUgPSBjZG5z
X3JlZ21hcF93cml0ZSwgXAorCS5yZWdfcmVhZCA9IGNkbnNfcmVnbWFwX3JlYWQsIFwKK30KKwor
I2RlZmluZSBUT1JSRU5UX1JYX0xBTkVfQ0RCX1JFR01BUF9DT05GKG4pIFwKK3sgXAorCS5uYW1l
ID0gInRvcnJlbnRfcnhfbGFuZSIgbiAiX2NkYiIsIFwKKwkucmVnX3N0cmlkZSA9IDEsIFwKKwku
ZmFzdF9pbyA9IHRydWUsIFwKKwkucmVnX3dyaXRlID0gY2Ruc19yZWdtYXBfd3JpdGUsIFwKKwku
cmVnX3JlYWQgPSBjZG5zX3JlZ21hcF9yZWFkLCBcCit9CisKK3N0YXRpYyBzdHJ1Y3QgcmVnbWFw
X2NvbmZpZyBjZG5zX3RvcnJlbnRfdHhfbGFuZV9jZGJfY29uZmlnW10gPSB7CisJVE9SUkVOVF9U
WF9MQU5FX0NEQl9SRUdNQVBfQ09ORigiMCIpLAorCVRPUlJFTlRfVFhfTEFORV9DREJfUkVHTUFQ
X0NPTkYoIjEiKSwKKwlUT1JSRU5UX1RYX0xBTkVfQ0RCX1JFR01BUF9DT05GKCIyIiksCisJVE9S
UkVOVF9UWF9MQU5FX0NEQl9SRUdNQVBfQ09ORigiMyIpLAorfTsKKworc3RhdGljIHN0cnVjdCBy
ZWdtYXBfY29uZmlnIGNkbnNfdG9ycmVudF9yeF9sYW5lX2NkYl9jb25maWdbXSA9IHsKKwlUT1JS
RU5UX1JYX0xBTkVfQ0RCX1JFR01BUF9DT05GKCIwIiksCisJVE9SUkVOVF9SWF9MQU5FX0NEQl9S
RUdNQVBfQ09ORigiMSIpLAorCVRPUlJFTlRfUlhfTEFORV9DREJfUkVHTUFQX0NPTkYoIjIiKSwK
KwlUT1JSRU5UX1JYX0xBTkVfQ0RCX1JFR01BUF9DT05GKCIzIiksCit9OworCitzdGF0aWMgc3Ry
dWN0IHJlZ21hcF9jb25maWcgY2Ruc190b3JyZW50X2NvbW1vbl9jZGJfY29uZmlnID0geworCS5u
YW1lID0gInRvcnJlbnRfY29tbW9uX2NkYiIsCisJLnJlZ19zdHJpZGUgPSAxLAorCS5mYXN0X2lv
ID0gdHJ1ZSwKKwkucmVnX3dyaXRlID0gY2Ruc19yZWdtYXBfd3JpdGUsCisJLnJlZ19yZWFkID0g
Y2Ruc19yZWdtYXBfcmVhZCwKK307CisKK3N0YXRpYyBzdHJ1Y3QgcmVnbWFwX2NvbmZpZyBjZG5z
X3RvcnJlbnRfcGh5X3Bjc19jbW5fY2RiX2NvbmZpZyA9IHsKKwkubmFtZSA9ICJ0b3JyZW50X3Bo
eV9wY3NfY21uX2NkYiIsCisJLnJlZ19zdHJpZGUgPSAxLAorCS5mYXN0X2lvID0gdHJ1ZSwKKwku
cmVnX3dyaXRlID0gY2Ruc19yZWdtYXBfd3JpdGUsCisJLnJlZ19yZWFkID0gY2Ruc19yZWdtYXBf
cmVhZCwKK307CisKK3N0YXRpYyBzdHJ1Y3QgcmVnbWFwX2NvbmZpZyBjZG5zX3RvcnJlbnRfcGh5
X3BtYV9jbW5fY2RiX2NvbmZpZyA9IHsKKwkubmFtZSA9ICJ0b3JyZW50X3BoeV9wbWFfY21uX2Nk
YiIsCisJLnJlZ19zdHJpZGUgPSAxLAorCS5mYXN0X2lvID0gdHJ1ZSwKKwkucmVnX3dyaXRlID0g
Y2Ruc19yZWdtYXBfd3JpdGUsCisJLnJlZ19yZWFkID0gY2Ruc19yZWdtYXBfcmVhZCwKK307CisK
Ky8qIFBIWSBtbXIgYWNjZXNzIGZ1bmN0aW9ucyAqLworCitzdGF0aWMgdm9pZCBjZG5zX3RvcnJl
bnRfcGh5X3dyaXRlKHN0cnVjdCByZWdtYXAgKnJlZ21hcCwgdTMyIG9mZnNldCwgdTMyIHZhbCkK
K3sKKwlyZWdtYXBfd3JpdGUocmVnbWFwLCBvZmZzZXQsIHZhbCk7Cit9CisKK3N0YXRpYyB1MzIg
Y2Ruc190b3JyZW50X3BoeV9yZWFkKHN0cnVjdCByZWdtYXAgKnJlZ21hcCwgdTMyIG9mZnNldCkK
K3sKKwl1bnNpZ25lZCBpbnQgdmFsOworCisJcmVnbWFwX3JlYWQocmVnbWFwLCBvZmZzZXQsICZ2
YWwpOworCXJldHVybiB2YWw7Cit9CiAKIC8qIERQVFggbW1yIGFjY2VzcyBmdW5jdGlvbnMgKi8K
IApAQCAtMzc2LDE2ICs0OTgsMTYgQEAgc3RhdGljIGludCBjZG5zX3RvcnJlbnRfZHBfY29uZmln
dXJlX3JhdGUoc3RydWN0IGNkbnNfdG9ycmVudF9waHkgKmNkbnNfcGh5LAogCXUzMiByZWFkX3Zh
bDsKIAogCS8qIERpc2FibGUgdGhlIGNtbl9wbGwwX2VuIGJlZm9yZSByZS1wcm9ncmFtbWluZyB0
aGUgbmV3IGRhdGEgcmF0ZS4gKi8KLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBQ
SFlfUE1BX1BMTF9SQVdfQ1RSTCwgMCk7CisJcmVnbWFwX2ZpZWxkX3dyaXRlKGNkbnNfcGh5LT5w
aHlfcG1hX3BsbF9yYXdfY3RybCwgMHgwKTsKIAogCS8qCiAJICogV2FpdCBmb3IgUExMIHJlYWR5
IGRlLWFzc2VydGlvbi4KIAkgKiBGb3IgUExMMCAtIFBIWV9QTUFfQ01OX0NUUkwyWzJdID09IDEK
IAkgKi8KLQlyZXQgPSBjZG5zX3RvcnJlbnRfcGh5X3JlYWRfcG9sbF90aW1lb3V0KGNkbnNfcGh5
LCBQSFlfUE1BX0NNTl9DVFJMMiwKLQkJCQkJCSByZWFkX3ZhbCwKLQkJCQkJCSAoKHJlYWRfdmFs
ID4+IDIpICYgMHgwMSkgIT0gMCwKLQkJCQkJCSAwLCBQT0xMX1RJTUVPVVRfVVMpOworCXJldCA9
IHJlZ21hcF9maWVsZF9yZWFkX3BvbGxfdGltZW91dChjZG5zX3BoeS0+cGh5X3BtYV9jbW5fY3Ry
bF8yLAorCQkJCQkgICAgIHJlYWRfdmFsLAorCQkJCQkgICAgICgocmVhZF92YWwgPj4gMikgJiAw
eDAxKSAhPSAwLAorCQkJCQkgICAgIDAsIFBPTExfVElNRU9VVF9VUyk7CiAJaWYgKHJldCkKIAkJ
cmV0dXJuIHJldDsKIAluZGVsYXkoMjAwKTsKQEAgLTQwNSwxNiArNTI3LDE2IEBAIHN0YXRpYyBp
bnQgY2Ruc190b3JyZW50X2RwX2NvbmZpZ3VyZV9yYXRlKHN0cnVjdCBjZG5zX3RvcnJlbnRfcGh5
ICpjZG5zX3BoeSwKIAljZG5zX3RvcnJlbnRfZHBfcG1hX2Ntbl9yYXRlKGNkbnNfcGh5LCBkcC0+
bGlua19yYXRlLCBkcC0+bGFuZXMpOwogCiAJLyogRW5hYmxlIHRoZSBjbW5fcGxsMF9lbi4gKi8K
LQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBQSFlfUE1BX1BMTF9SQVdfQ1RSTCwg
MHgzKTsKKwlyZWdtYXBfZmllbGRfd3JpdGUoY2Ruc19waHktPnBoeV9wbWFfcGxsX3Jhd19jdHJs
LCAweDMpOwogCiAJLyoKIAkgKiBXYWl0IGZvciBQTEwgcmVhZHkgYXNzZXJ0aW9uLgogCSAqIEZv
ciBQTEwwIC0gUEhZX1BNQV9DTU5fQ1RSTDJbMF0gPT0gMQogCSAqLwotCXJldCA9IGNkbnNfdG9y
cmVudF9waHlfcmVhZF9wb2xsX3RpbWVvdXQoY2Ruc19waHksIFBIWV9QTUFfQ01OX0NUUkwyLAot
CQkJCQkJIHJlYWRfdmFsLAotCQkJCQkJIChyZWFkX3ZhbCAmIDB4MDEpICE9IDAsCi0JCQkJCQkg
MCwgUE9MTF9USU1FT1VUX1VTKTsKKwlyZXQgPSByZWdtYXBfZmllbGRfcmVhZF9wb2xsX3RpbWVv
dXQoY2Ruc19waHktPnBoeV9wbWFfY21uX2N0cmxfMiwKKwkJCQkJICAgICByZWFkX3ZhbCwKKwkJ
CQkJICAgICAocmVhZF92YWwgJiAweDAxKSAhPSAwLAorCQkJCQkgICAgIDAsIFBPTExfVElNRU9V
VF9VUyk7CiAJcmV0dXJuIHJldDsKIH0KIApAQCAtNjA2LDQ0ICs3MjgsNDEgQEAgc3RhdGljIHZv
aWQgY2Ruc190b3JyZW50X2RwX3NldF92b2x0YWdlcyhzdHJ1Y3QgY2Ruc190b3JyZW50X3BoeSAq
Y2Ruc19waHksCiB7CiAJdTggbGFuZTsKIAl1MTYgdmFsOwotCXVuc2lnbmVkIGludCBsYW5lX2Jp
dHM7CiAKIAlmb3IgKGxhbmUgPSAwOyBsYW5lIDwgZHAtPmxhbmVzOyBsYW5lKyspIHsKLQkJbGFu
ZV9iaXRzID0gKGxhbmUgJiBMQU5FX01BU0spIDw8IDExOwotCi0JCXZhbCA9IGNkbnNfdG9ycmVu
dF9waHlfcmVhZChjZG5zX3BoeSwKLQkJCQkJICAgIChUWF9ESUFHX0FDWUEgfCBsYW5lX2JpdHMp
KTsKKwkJdmFsID0gY2Ruc190b3JyZW50X3BoeV9yZWFkKGNkbnNfcGh5LT5yZWdtYXBfdHhfbGFu
ZV9jZGJbbGFuZV0sCisJCQkJCSAgICBUWF9ESUFHX0FDWUEpOwogCQkvKgogCQkgKiBXcml0ZSAx
IHRvIHJlZ2lzdGVyIGJpdCBUWF9ESUFHX0FDWUFbMF0gdG8gZnJlZXplIHRoZQogCQkgKiBjdXJy
ZW50IHN0YXRlIG9mIHRoZSBhbmFsb2cgVFggZHJpdmVyLgogCQkgKi8KIAkJdmFsIHw9IFRYX0RJ
QUdfQUNZQV9IQkRDX01BU0s7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksCi0J
CQkJICAgICAgIChUWF9ESUFHX0FDWUEgfCBsYW5lX2JpdHMpLCB2YWwpOworCQljZG5zX3RvcnJl
bnRfcGh5X3dyaXRlKGNkbnNfcGh5LT5yZWdtYXBfdHhfbGFuZV9jZGJbbGFuZV0sCisJCQkJICAg
ICAgIFRYX0RJQUdfQUNZQSwgdmFsKTsKIAotCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNf
cGh5LAotCQkJCSAgICAgICAoVFhfVFhDQ19DVFJMIHwgbGFuZV9iaXRzKSwgMHgwOEE0KTsKKwkJ
Y2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeS0+cmVnbWFwX3R4X2xhbmVfY2RiW2xhbmVd
LAorCQkJCSAgICAgICBUWF9UWENDX0NUUkwsIDB4MDhBNCk7CiAJCXZhbCA9IHZsdGdfY29lZmZb
ZHAtPnZvbHRhZ2VbbGFuZV1dW2RwLT5wcmVbbGFuZV1dLmRpYWdfdHhfZHJ2OwotCQljZG5zX3Rv
cnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LAotCQkJCSAgICAgICAoRFJWX0RJQUdfVFhfRFJWIHwg
bGFuZV9iaXRzKSwgdmFsKTsKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeS0+cmVn
bWFwX3R4X2xhbmVfY2RiW2xhbmVdLAorCQkJCSAgICAgICBEUlZfRElBR19UWF9EUlYsIHZhbCk7
CiAJCXZhbCA9IHZsdGdfY29lZmZbZHAtPnZvbHRhZ2VbbGFuZV1dW2RwLT5wcmVbbGFuZV1dLm1n
bmZzX211bHQ7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksCi0JCQkJICAgICAg
IChUWF9UWENDX01HTkZTX01VTFRfMDAwIHwgbGFuZV9iaXRzKSwKKwkJY2Ruc190b3JyZW50X3Bo
eV93cml0ZShjZG5zX3BoeS0+cmVnbWFwX3R4X2xhbmVfY2RiW2xhbmVdLAorCQkJCSAgICAgICBU
WF9UWENDX01HTkZTX01VTFRfMDAwLAogCQkJCSAgICAgICB2YWwpOwogCQl2YWwgPSB2bHRnX2Nv
ZWZmW2RwLT52b2x0YWdlW2xhbmVdXVtkcC0+cHJlW2xhbmVdXS5jcG9zdF9tdWx0OwotCQljZG5z
X3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LAotCQkJCSAgICAgICAoVFhfVFhDQ19DUE9TVF9N
VUxUXzAwIHwgbGFuZV9iaXRzKSwKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeS0+
cmVnbWFwX3R4X2xhbmVfY2RiW2xhbmVdLAorCQkJCSAgICAgICBUWF9UWENDX0NQT1NUX01VTFRf
MDAsCiAJCQkJICAgICAgIHZhbCk7CiAKLQkJdmFsID0gY2Ruc190b3JyZW50X3BoeV9yZWFkKGNk
bnNfcGh5LAotCQkJCQkgICAgKFRYX0RJQUdfQUNZQSB8IGxhbmVfYml0cykpOworCQl2YWwgPSBj
ZG5zX3RvcnJlbnRfcGh5X3JlYWQoY2Ruc19waHktPnJlZ21hcF90eF9sYW5lX2NkYltsYW5lXSwK
KwkJCQkJICAgIFRYX0RJQUdfQUNZQSk7CiAJCS8qCiAJCSAqIFdyaXRlIDAgdG8gcmVnaXN0ZXIg
Yml0IFRYX0RJQUdfQUNZQVswXSB0byBhbGxvdyB0aGUgc3RhdGUgb2YKIAkJICogYW5hbG9nIFRY
IGRyaXZlciB0byByZWZsZWN0IHRoZSBuZXcgcHJvZ3JhbW1lZCBvbmUuCiAJCSAqLwogCQl2YWwg
Jj0gflRYX0RJQUdfQUNZQV9IQkRDX01BU0s7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ru
c19waHksCi0JCQkJICAgICAgIChUWF9ESUFHX0FDWUEgfCBsYW5lX2JpdHMpLCB2YWwpOworCQlj
ZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LT5yZWdtYXBfdHhfbGFuZV9jZGJbbGFuZV0s
CisJCQkJICAgICAgIFRYX0RJQUdfQUNZQSwgdmFsKTsKIAl9CiB9OwogCkBAIC04MDUsNDMgKzky
NCw0NSBAQCBzdGF0aWMgdm9pZCBjZG5zX3RvcnJlbnRfZHBfcG1hX2NmZyhzdHJ1Y3QgY2Ruc190
b3JyZW50X3BoeSAqY2Ruc19waHkpCiBzdGF0aWMKIHZvaWQgY2Ruc190b3JyZW50X2RwX3BtYV9j
bW5fY2ZnXzE5XzJtaHooc3RydWN0IGNkbnNfdG9ycmVudF9waHkgKmNkbnNfcGh5KQogeworCXN0
cnVjdCByZWdtYXAgKnJlZ21hcCA9IGNkbnNfcGh5LT5yZWdtYXBfY29tbW9uX2NkYjsKKwogCS8q
IHJlZmNsb2NrIHJlZ2lzdGVycyAtIGFzc3VtZXMgMTkuMiBNSHogcmVmY2xvY2sgKi8KLQljZG5z
X3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fU1NNX0JJQVNfVE1SLCAweDAwMTQpOwot
CWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTExTTTBfUExMUFJFX1RNUiwg
MHgwMDI3KTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUExMU00wX1BM
TExPQ0tfVE1SLCAweDAwQTEpOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENN
Tl9QTExTTTFfUExMUFJFX1RNUiwgMHgwMDI3KTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNk
bnNfcGh5LCBDTU5fUExMU00xX1BMTExPQ0tfVE1SLCAweDAwQTEpOwotCWNkbnNfdG9ycmVudF9w
aHlfd3JpdGUoY2Ruc19waHksIENNTl9CR0NBTF9JTklUX1RNUiwgMHgwMDYwKTsKLQljZG5zX3Rv
cnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fQkdDQUxfSVRFUl9UTVIsIDB4MDA2MCk7Ci0J
Y2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX0lCQ0FMX0lOSVRfVE1SLCAweDAw
MTQpOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9UWFBVQ0FMX0lOSVRf
VE1SLCAweDAwMTgpOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9UWFBV
Q0FMX0lURVJfVE1SLCAweDAwMDUpOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHks
IENNTl9UWFBEQ0FMX0lOSVRfVE1SLCAweDAwMTgpOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUo
Y2Ruc19waHksIENNTl9UWFBEQ0FMX0lURVJfVE1SLCAweDAwMDUpOwotCWNkbnNfdG9ycmVudF9w
aHlfd3JpdGUoY2Ruc19waHksIENNTl9SWENBTF9JTklUX1RNUiwgMHgwMjQwKTsKLQljZG5zX3Rv
cnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUlhDQUxfSVRFUl9UTVIsIDB4MDAwNSk7Ci0J
Y2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX1NEX0NBTF9JTklUX1RNUiwgMHgw
MDAyKTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fU0RfQ0FMX0lURVJf
VE1SLCAweDAwMDIpOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9TRF9D
QUxfUkVGVElNX1NUQVJULCAweDAwMEIpOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19w
aHksIENNTl9TRF9DQUxfUExMQ05UX1NUQVJULCAweDAxMzcpOworCWNkbnNfdG9ycmVudF9waHlf
d3JpdGUocmVnbWFwLCBDTU5fU1NNX0JJQVNfVE1SLCAweDAwMTQpOworCWNkbnNfdG9ycmVudF9w
aHlfd3JpdGUocmVnbWFwLCBDTU5fUExMU00wX1BMTFBSRV9UTVIsIDB4MDAyNyk7CisJY2Ruc190
b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9QTExTTTBfUExMTE9DS19UTVIsIDB4MDBBMSk7
CisJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9QTExTTTFfUExMUFJFX1RNUiwg
MHgwMDI3KTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTFNNMV9QTExM
T0NLX1RNUiwgMHgwMEExKTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX0JH
Q0FMX0lOSVRfVE1SLCAweDAwNjApOworCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBD
TU5fQkdDQUxfSVRFUl9UTVIsIDB4MDA2MCk7CisJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdt
YXAsIENNTl9JQkNBTF9JTklUX1RNUiwgMHgwMDE0KTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRl
KHJlZ21hcCwgQ01OX1RYUFVDQUxfSU5JVF9UTVIsIDB4MDAxOCk7CisJY2Ruc190b3JyZW50X3Bo
eV93cml0ZShyZWdtYXAsIENNTl9UWFBVQ0FMX0lURVJfVE1SLCAweDAwMDUpOworCWNkbnNfdG9y
cmVudF9waHlfd3JpdGUocmVnbWFwLCBDTU5fVFhQRENBTF9JTklUX1RNUiwgMHgwMDE4KTsKKwlj
ZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1RYUERDQUxfSVRFUl9UTVIsIDB4MDAw
NSk7CisJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9SWENBTF9JTklUX1RNUiwg
MHgwMjQwKTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1JYQ0FMX0lURVJf
VE1SLCAweDAwMDUpOworCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBDTU5fU0RfQ0FM
X0lOSVRfVE1SLCAweDAwMDIpOworCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBDTU5f
U0RfQ0FMX0lURVJfVE1SLCAweDAwMDIpOworCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFw
LCBDTU5fU0RfQ0FMX1JFRlRJTV9TVEFSVCwgMHgwMDBCKTsKKwljZG5zX3RvcnJlbnRfcGh5X3dy
aXRlKHJlZ21hcCwgQ01OX1NEX0NBTF9QTExDTlRfU1RBUlQsIDB4MDEzNyk7CiAKIAkvKiBQTEwg
cmVnaXN0ZXJzICovCi0JY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX1BESUFH
X1BMTDBfQ1BfUEFESl9NMCwgMHgwNTA5KTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNf
cGh5LCBDTU5fUERJQUdfUExMMF9DUF9JQURKX00wLCAweDBGMDApOwotCWNkbnNfdG9ycmVudF9w
aHlfd3JpdGUoY2Ruc19waHksIENNTl9QRElBR19QTEwwX0ZJTFRfUEFESl9NMCwgMHgwRjA4KTsK
LQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUExMMF9EU01fRElBR19NMCwg
MHgwMDA0KTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUERJQUdfUExM
MV9DUF9QQURKX00wLCAweDA1MDkpOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHks
IENNTl9QRElBR19QTEwxX0NQX0lBREpfTTAsIDB4MEYwMCk7Ci0JY2Ruc190b3JyZW50X3BoeV93
cml0ZShjZG5zX3BoeSwgQ01OX1BESUFHX1BMTDFfRklMVF9QQURKX00wLCAweDBGMDgpOwotCWNk
bnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwxX0RTTV9ESUFHX00wLCAweDAw
MDQpOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwwX1ZDT0NBTF9J
TklUX1RNUiwgMHgwMEMwKTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5f
UExMMF9WQ09DQUxfSVRFUl9UTVIsIDB4MDAwNCk7Ci0JY2Ruc190b3JyZW50X3BoeV93cml0ZShj
ZG5zX3BoeSwgQ01OX1BMTDFfVkNPQ0FMX0lOSVRfVE1SLCAweDAwQzApOwotCWNkbnNfdG9ycmVu
dF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwxX1ZDT0NBTF9JVEVSX1RNUiwgMHgwMDA0KTsK
LQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUExMMF9WQ09DQUxfUkVGVElN
X1NUQVJULCAweDAyNjApOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9Q
TEwwX1ZDT0NBTF9UQ1RSTCwgMHgwMDAzKTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNf
cGh5LCBDTU5fUExMMV9WQ09DQUxfUkVGVElNX1NUQVJULCAweDAyNjApOwotCWNkbnNfdG9ycmVu
dF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwxX1ZDT0NBTF9UQ1RSTCwgMHgwMDAzKTsKKwlj
ZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BESUFHX1BMTDBfQ1BfUEFESl9NMCwg
MHgwNTA5KTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BESUFHX1BMTDBf
Q1BfSUFESl9NMCwgMHgwRjAwKTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01O
X1BESUFHX1BMTDBfRklMVF9QQURKX00wLCAweDBGMDgpOworCWNkbnNfdG9ycmVudF9waHlfd3Jp
dGUocmVnbWFwLCBDTU5fUExMMF9EU01fRElBR19NMCwgMHgwMDA0KTsKKwljZG5zX3RvcnJlbnRf
cGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BESUFHX1BMTDFfQ1BfUEFESl9NMCwgMHgwNTA5KTsKKwlj
ZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BESUFHX1BMTDFfQ1BfSUFESl9NMCwg
MHgwRjAwKTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BESUFHX1BMTDFf
RklMVF9QQURKX00wLCAweDBGMDgpOworCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBD
TU5fUExMMV9EU01fRElBR19NMCwgMHgwMDA0KTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJl
Z21hcCwgQ01OX1BMTDBfVkNPQ0FMX0lOSVRfVE1SLCAweDAwQzApOworCWNkbnNfdG9ycmVudF9w
aHlfd3JpdGUocmVnbWFwLCBDTU5fUExMMF9WQ09DQUxfSVRFUl9UTVIsIDB4MDAwNCk7CisJY2Ru
c190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9QTEwxX1ZDT0NBTF9JTklUX1RNUiwgMHgw
MEMwKTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTDFfVkNPQ0FMX0lU
RVJfVE1SLCAweDAwMDQpOworCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBDTU5fUExM
MF9WQ09DQUxfUkVGVElNX1NUQVJULCAweDAyNjApOworCWNkbnNfdG9ycmVudF9waHlfd3JpdGUo
cmVnbWFwLCBDTU5fUExMMF9WQ09DQUxfVENUUkwsIDB4MDAwMyk7CisJY2Ruc190b3JyZW50X3Bo
eV93cml0ZShyZWdtYXAsIENNTl9QTEwxX1ZDT0NBTF9SRUZUSU1fU1RBUlQsIDB4MDI2MCk7CisJ
Y2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9QTEwxX1ZDT0NBTF9UQ1RSTCwgMHgw
MDAzKTsKIH0KIAogLyoKQEAgLTg1Miw0NCArOTczLDQ4IEBAIHN0YXRpYwogdm9pZCBjZG5zX3Rv
cnJlbnRfZHBfZW5hYmxlX3NzY18xOV8ybWh6KHN0cnVjdCBjZG5zX3RvcnJlbnRfcGh5ICpjZG5z
X3BoeSwKIAkJCQkJdTMyIGN0cmwyX3ZhbCwgdTMyIGN0cmwzX3ZhbCkKIHsKLQljZG5zX3RvcnJl
bnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUExMMF9TU19DVFJMMV9NMCwgMHgwMDAxKTsKLQlj
ZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUExMMF9TU19DVFJMMV9NMCwgY3Ry
bDJfdmFsKTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUExMMF9TU19D
VFJMMV9NMCwgY3RybDNfdmFsKTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBD
TU5fUExMMF9TU19DVFJMNF9NMCwgMHgwMDAzKTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNk
bnNfcGh5LCBDTU5fUExMMV9TU19DVFJMMV9NMCwgMHgwMDAxKTsKLQljZG5zX3RvcnJlbnRfcGh5
X3dyaXRlKGNkbnNfcGh5LCBDTU5fUExMMV9TU19DVFJMMV9NMCwgY3RybDJfdmFsKTsKLQljZG5z
X3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUExMMV9TU19DVFJMMV9NMCwgY3RybDNf
dmFsKTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUExMMV9TU19DVFJM
NF9NMCwgMHgwMDAzKTsKKwlzdHJ1Y3QgcmVnbWFwICpyZWdtYXAgPSBjZG5zX3BoeS0+cmVnbWFw
X2NvbW1vbl9jZGI7CisKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTDBf
U1NfQ1RSTDFfTTAsIDB4MDAwMSk7CisJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENN
Tl9QTEwwX1NTX0NUUkwxX00wLCBjdHJsMl92YWwpOworCWNkbnNfdG9ycmVudF9waHlfd3JpdGUo
cmVnbWFwLCBDTU5fUExMMF9TU19DVFJMMV9NMCwgY3RybDNfdmFsKTsKKwljZG5zX3RvcnJlbnRf
cGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTDBfU1NfQ1RSTDRfTTAsIDB4MDAwMyk7CisJY2Ruc190
b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9QTEwxX1NTX0NUUkwxX00wLCAweDAwMDEpOwor
CWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBDTU5fUExMMV9TU19DVFJMMV9NMCwgY3Ry
bDJfdmFsKTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTDFfU1NfQ1RS
TDFfTTAsIGN0cmwzX3ZhbCk7CisJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9Q
TEwxX1NTX0NUUkw0X00wLCAweDAwMDMpOwogfQogCiBzdGF0aWMKIHZvaWQgY2Ruc190b3JyZW50
X2RwX3BtYV9jbW5fdmNvX2NmZ18xOV8ybWh6KHN0cnVjdCBjZG5zX3RvcnJlbnRfcGh5ICpjZG5z
X3BoeSwKIAkJCQkJICAgICB1MzIgcmF0ZSwgYm9vbCBzc2MpCiB7CisJc3RydWN0IHJlZ21hcCAq
cmVnbWFwID0gY2Ruc19waHktPnJlZ21hcF9jb21tb25fY2RiOworCiAJLyogQXNzdW1lcyAxOS4y
IE1IeiByZWZjbG9jayAqLwogCXN3aXRjaCAocmF0ZSkgewogCS8qIFNldHRpbmcgVkNPIGZvciAx
MC44R0h6ICovCiAJY2FzZSAyNzAwOgogCWNhc2UgNTQwMDoKLQkJY2Ruc190b3JyZW50X3BoeV93
cml0ZShjZG5zX3BoeSwKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsCiAJCQkJICAg
ICAgIENNTl9QTEwwX0lOVERJVl9NMCwgMHgwMTE5KTsKLQkJY2Ruc190b3JyZW50X3BoeV93cml0
ZShjZG5zX3BoeSwKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsCiAJCQkJICAgICAg
IENNTl9QTEwwX0ZSQUNESVZMX00wLCAweDQwMDApOwotCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRl
KGNkbnNfcGh5LAorCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwKIAkJCQkgICAgICAg
Q01OX1BMTDBfRlJBQ0RJVkhfTTAsIDB4MDAwMik7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUo
Y2Ruc19waHksCisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLAogCQkJCSAgICAgICBD
TU5fUExMMF9ISUdIX1RIUl9NMCwgMHgwMEJDKTsKLQkJY2Ruc190b3JyZW50X3BoeV93cml0ZShj
ZG5zX3BoeSwKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsCiAJCQkJICAgICAgIENN
Tl9QRElBR19QTEwwX0NUUkxfTTAsIDB4MDAxMik7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUo
Y2Ruc19waHksCisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLAogCQkJCSAgICAgICBD
TU5fUExMMV9JTlRESVZfTTAsIDB4MDExOSk7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ru
c19waHksCisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLAogCQkJCSAgICAgICBDTU5f
UExMMV9GUkFDRElWTF9NMCwgMHg0MDAwKTsKLQkJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5z
X3BoeSwKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsCiAJCQkJICAgICAgIENNTl9Q
TEwxX0ZSQUNESVZIX00wLCAweDAwMDIpOwotCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNf
cGh5LAorCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwKIAkJCQkgICAgICAgQ01OX1BM
TDFfSElHSF9USFJfTTAsIDB4MDBCQyk7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19w
aHksCisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLAogCQkJCSAgICAgICBDTU5fUERJ
QUdfUExMMV9DVFJMX00wLCAweDAwMTIpOwogCQlpZiAoc3NjKQogCQkJY2Ruc190b3JyZW50X2Rw
X2VuYWJsZV9zc2NfMTlfMm1oeihjZG5zX3BoeSwgMHgwMzNBLApAQCAtODk5LDI1ICsxMDI0LDI1
IEBAIHZvaWQgY2Ruc190b3JyZW50X2RwX3BtYV9jbW5fdmNvX2NmZ18xOV8ybWh6KHN0cnVjdCBj
ZG5zX3RvcnJlbnRfcGh5ICpjZG5zX3BoeSwKIAljYXNlIDE2MjA6CiAJY2FzZSAyNDMwOgogCWNh
c2UgMzI0MDoKLQkJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwKKwkJY2Ruc190b3Jy
ZW50X3BoeV93cml0ZShyZWdtYXAsCiAJCQkJICAgICAgIENNTl9QTEwwX0lOVERJVl9NMCwgMHgw
MUZBKTsKLQkJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwKKwkJY2Ruc190b3JyZW50
X3BoeV93cml0ZShyZWdtYXAsCiAJCQkJICAgICAgIENNTl9QTEwwX0ZSQUNESVZMX00wLCAweDQw
MDApOwotCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LAorCQljZG5zX3RvcnJlbnRf
cGh5X3dyaXRlKHJlZ21hcCwKIAkJCQkgICAgICAgQ01OX1BMTDBfRlJBQ0RJVkhfTTAsIDB4MDAw
Mik7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksCisJCWNkbnNfdG9ycmVudF9w
aHlfd3JpdGUocmVnbWFwLAogCQkJCSAgICAgICBDTU5fUExMMF9ISUdIX1RIUl9NMCwgMHgwMTUy
KTsKLQkJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwKKwkJY2Ruc190b3JyZW50X3Bo
eV93cml0ZShyZWdtYXAsCiAJCQkJICAgICAgIENNTl9QRElBR19QTEwwX0NUUkxfTTAsIDB4MDAw
Mik7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksCisJCWNkbnNfdG9ycmVudF9w
aHlfd3JpdGUocmVnbWFwLAogCQkJCSAgICAgICBDTU5fUExMMV9JTlRESVZfTTAsIDB4MDFGQSk7
Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksCisJCWNkbnNfdG9ycmVudF9waHlf
d3JpdGUocmVnbWFwLAogCQkJCSAgICAgICBDTU5fUExMMV9GUkFDRElWTF9NMCwgMHg0MDAwKTsK
LQkJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwKKwkJY2Ruc190b3JyZW50X3BoeV93
cml0ZShyZWdtYXAsCiAJCQkJICAgICAgIENNTl9QTEwxX0ZSQUNESVZIX00wLCAweDAwMDIpOwot
CQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LAorCQljZG5zX3RvcnJlbnRfcGh5X3dy
aXRlKHJlZ21hcCwKIAkJCQkgICAgICAgQ01OX1BMTDFfSElHSF9USFJfTTAsIDB4MDE1Mik7Ci0J
CWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksCisJCWNkbnNfdG9ycmVudF9waHlfd3Jp
dGUocmVnbWFwLAogCQkJCSAgICAgICBDTU5fUERJQUdfUExMMV9DVFJMX00wLCAweDAwMDIpOwog
CQlpZiAoc3NjKQogCQkJY2Ruc190b3JyZW50X2RwX2VuYWJsZV9zc2NfMTlfMm1oeihjZG5zX3Bo
eSwgMHgwNURELApAQCAtOTI2LDI1ICsxMDUxLDI1IEBAIHZvaWQgY2Ruc190b3JyZW50X2RwX3Bt
YV9jbW5fdmNvX2NmZ18xOV8ybWh6KHN0cnVjdCBjZG5zX3RvcnJlbnRfcGh5ICpjZG5zX3BoeSwK
IAkvKiBTZXR0aW5nIFZDTyBmb3IgOC42NEdIeiAqLwogCWNhc2UgMjE2MDoKIAljYXNlIDQzMjA6
Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksCisJCWNkbnNfdG9ycmVudF9waHlf
d3JpdGUocmVnbWFwLAogCQkJCSAgICAgICBDTU5fUExMMF9JTlRESVZfTTAsIDB4MDFDMik7Ci0J
CWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksCisJCWNkbnNfdG9ycmVudF9waHlfd3Jp
dGUocmVnbWFwLAogCQkJCSAgICAgICBDTU5fUExMMF9GUkFDRElWTF9NMCwgMHgwMDAwKTsKLQkJ
Y2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwKKwkJY2Ruc190b3JyZW50X3BoeV93cml0
ZShyZWdtYXAsCiAJCQkJICAgICAgIENNTl9QTEwwX0ZSQUNESVZIX00wLCAweDAwMDIpOwotCQlj
ZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LAorCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRl
KHJlZ21hcCwKIAkJCQkgICAgICAgQ01OX1BMTDBfSElHSF9USFJfTTAsIDB4MDEyQyk7Ci0JCWNk
bnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksCisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUo
cmVnbWFwLAogCQkJCSAgICAgICBDTU5fUERJQUdfUExMMF9DVFJMX00wLCAweDAwMDIpOwotCQlj
ZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LAorCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRl
KHJlZ21hcCwKIAkJCQkgICAgICAgQ01OX1BMTDFfSU5URElWX00wLCAweDAxQzIpOwotCQljZG5z
X3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LAorCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJl
Z21hcCwKIAkJCQkgICAgICAgQ01OX1BMTDFfRlJBQ0RJVkxfTTAsIDB4MDAwMCk7Ci0JCWNkbnNf
dG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksCisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVn
bWFwLAogCQkJCSAgICAgICBDTU5fUExMMV9GUkFDRElWSF9NMCwgMHgwMDAyKTsKLQkJY2Ruc190
b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdt
YXAsCiAJCQkJICAgICAgIENNTl9QTEwxX0hJR0hfVEhSX00wLCAweDAxMkMpOwotCQljZG5zX3Rv
cnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LAorCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21h
cCwKIAkJCQkgICAgICAgQ01OX1BESUFHX1BMTDFfQ1RSTF9NMCwgMHgwMDAyKTsKIAkJaWYgKHNz
YykKIAkJCWNkbnNfdG9ycmVudF9kcF9lbmFibGVfc3NjXzE5XzJtaHooY2Ruc19waHksIDB4MDUz
NiwKQEAgLTk1MiwyNSArMTA3NywyNSBAQCB2b2lkIGNkbnNfdG9ycmVudF9kcF9wbWFfY21uX3Zj
b19jZmdfMTlfMm1oeihzdHJ1Y3QgY2Ruc190b3JyZW50X3BoeSAqY2Ruc19waHksCiAJCWJyZWFr
OwogCS8qIFNldHRpbmcgVkNPIGZvciA4LjFHSHogKi8KIAljYXNlIDgxMDA6Ci0JCWNkbnNfdG9y
cmVudF9waHlfd3JpdGUoY2Ruc19waHksCisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFw
LAogCQkJCSAgICAgICBDTU5fUExMMF9JTlRESVZfTTAsIDB4MDFBNSk7Ci0JCWNkbnNfdG9ycmVu
dF9waHlfd3JpdGUoY2Ruc19waHksCisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLAog
CQkJCSAgICAgICBDTU5fUExMMF9GUkFDRElWTF9NMCwgMHhFMDAwKTsKLQkJY2Ruc190b3JyZW50
X3BoeV93cml0ZShjZG5zX3BoeSwKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsCiAJ
CQkJICAgICAgIENNTl9QTEwwX0ZSQUNESVZIX00wLCAweDAwMDIpOwotCQljZG5zX3RvcnJlbnRf
cGh5X3dyaXRlKGNkbnNfcGh5LAorCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwKIAkJ
CQkgICAgICAgQ01OX1BMTDBfSElHSF9USFJfTTAsIDB4MDExQSk7Ci0JCWNkbnNfdG9ycmVudF9w
aHlfd3JpdGUoY2Ruc19waHksCisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLAogCQkJ
CSAgICAgICBDTU5fUERJQUdfUExMMF9DVFJMX00wLCAweDAwMDIpOwotCQljZG5zX3RvcnJlbnRf
cGh5X3dyaXRlKGNkbnNfcGh5LAorCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwKIAkJ
CQkgICAgICAgQ01OX1BMTDFfSU5URElWX00wLCAweDAxQTUpOwotCQljZG5zX3RvcnJlbnRfcGh5
X3dyaXRlKGNkbnNfcGh5LAorCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwKIAkJCQkg
ICAgICAgQ01OX1BMTDFfRlJBQ0RJVkxfTTAsIDB4RTAwMCk7Ci0JCWNkbnNfdG9ycmVudF9waHlf
d3JpdGUoY2Ruc19waHksCisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLAogCQkJCSAg
ICAgICBDTU5fUExMMV9GUkFDRElWSF9NMCwgMHgwMDAyKTsKLQkJY2Ruc190b3JyZW50X3BoeV93
cml0ZShjZG5zX3BoeSwKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsCiAJCQkJICAg
ICAgIENNTl9QTEwxX0hJR0hfVEhSX00wLCAweDAxMUEpOwotCQljZG5zX3RvcnJlbnRfcGh5X3dy
aXRlKGNkbnNfcGh5LAorCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwKIAkJCQkgICAg
ICAgQ01OX1BESUFHX1BMTDFfQ1RSTF9NMCwgMHgwMDAyKTsKIAkJaWYgKHNzYykKIAkJCWNkbnNf
dG9ycmVudF9kcF9lbmFibGVfc3NjXzE5XzJtaHooY2Ruc19waHksIDB4MDRENywKQEAgLTk3OSw4
OCArMTEwNCw5MCBAQCB2b2lkIGNkbnNfdG9ycmVudF9kcF9wbWFfY21uX3Zjb19jZmdfMTlfMm1o
eihzdHJ1Y3QgY2Ruc190b3JyZW50X3BoeSAqY2Ruc19waHksCiAJfQogCiAJaWYgKHNzYykgewot
CQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LAorCQljZG5zX3RvcnJlbnRfcGh5X3dy
aXRlKHJlZ21hcCwKIAkJCQkgICAgICAgQ01OX1BMTDBfVkNPQ0FMX1BMTENOVF9TVEFSVCwgMHgw
MjVFKTsKLQkJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwKKwkJY2Ruc190b3JyZW50
X3BoeV93cml0ZShyZWdtYXAsCiAJCQkJICAgICAgIENNTl9QTEwwX0xPQ0tfUExMQ05UX1RIUiwg
MHgwMDA1KTsKLQkJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwKKwkJY2Ruc190b3Jy
ZW50X3BoeV93cml0ZShyZWdtYXAsCiAJCQkJICAgICAgIENNTl9QTEwxX1ZDT0NBTF9QTExDTlRf
U1RBUlQsIDB4MDI1RSk7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksCisJCWNk
bnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLAogCQkJCSAgICAgICBDTU5fUExMMV9MT0NLX1BM
TENOVF9USFIsIDB4MDAwNSk7CiAJfSBlbHNlIHsKLQkJY2Ruc190b3JyZW50X3BoeV93cml0ZShj
ZG5zX3BoeSwKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsCiAJCQkJICAgICAgIENN
Tl9QTEwwX1ZDT0NBTF9QTExDTlRfU1RBUlQsIDB4MDI2MCk7Ci0JCWNkbnNfdG9ycmVudF9waHlf
d3JpdGUoY2Ruc19waHksCisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLAogCQkJCSAg
ICAgICBDTU5fUExMMV9WQ09DQUxfUExMQ05UX1NUQVJULCAweDAyNjApOwogCQkvKiBTZXQgcmVz
ZXQgcmVnaXN0ZXIgdmFsdWVzIHRvIGRpc2FibGUgU1NDICovCi0JCWNkbnNfdG9ycmVudF9waHlf
d3JpdGUoY2Ruc19waHksCisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLAogCQkJCSAg
ICAgICBDTU5fUExMMF9TU19DVFJMMV9NMCwgMHgwMDAyKTsKLQkJY2Ruc190b3JyZW50X3BoeV93
cml0ZShjZG5zX3BoeSwKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsCiAJCQkJICAg
ICAgIENNTl9QTEwwX1NTX0NUUkwyX00wLCAweDAwMDApOwotCQljZG5zX3RvcnJlbnRfcGh5X3dy
aXRlKGNkbnNfcGh5LAorCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwKIAkJCQkgICAg
ICAgQ01OX1BMTDBfU1NfQ1RSTDNfTTAsIDB4MDAwMCk7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3Jp
dGUoY2Ruc19waHksCisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLAogCQkJCSAgICAg
ICBDTU5fUExMMF9TU19DVFJMNF9NMCwgMHgwMDAwKTsKLQkJY2Ruc190b3JyZW50X3BoeV93cml0
ZShjZG5zX3BoeSwKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsCiAJCQkJICAgICAg
IENNTl9QTEwwX0xPQ0tfUExMQ05UX1RIUiwgMHgwMDAzKTsKLQkJY2Ruc190b3JyZW50X3BoeV93
cml0ZShjZG5zX3BoeSwKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsCiAJCQkJICAg
ICAgIENNTl9QTEwxX1NTX0NUUkwxX00wLCAweDAwMDIpOwotCQljZG5zX3RvcnJlbnRfcGh5X3dy
aXRlKGNkbnNfcGh5LAorCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwKIAkJCQkgICAg
ICAgQ01OX1BMTDFfU1NfQ1RSTDJfTTAsIDB4MDAwMCk7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3Jp
dGUoY2Ruc19waHksCisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLAogCQkJCSAgICAg
ICBDTU5fUExMMV9TU19DVFJMM19NMCwgMHgwMDAwKTsKLQkJY2Ruc190b3JyZW50X3BoeV93cml0
ZShjZG5zX3BoeSwKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsCiAJCQkJICAgICAg
IENNTl9QTEwxX1NTX0NUUkw0X00wLCAweDAwMDApOwotCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRl
KGNkbnNfcGh5LAorCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwKIAkJCQkgICAgICAg
Q01OX1BMTDFfTE9DS19QTExDTlRfVEhSLCAweDAwMDMpOwogCX0KIAotCWNkbnNfdG9ycmVudF9w
aHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwwX0xPQ0tfUkVGQ05UX1NUQVJULCAweDAwOTkpOwot
CWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwwX0xPQ0tfUExMQ05UX1NU
QVJULCAweDAwOTkpOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwx
X0xPQ0tfUkVGQ05UX1NUQVJULCAweDAwOTkpOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ru
c19waHksIENNTl9QTEwxX0xPQ0tfUExMQ05UX1NUQVJULCAweDAwOTkpOworCWNkbnNfdG9ycmVu
dF9waHlfd3JpdGUocmVnbWFwLCBDTU5fUExMMF9MT0NLX1JFRkNOVF9TVEFSVCwgMHgwMDk5KTsK
KwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTDBfTE9DS19QTExDTlRfU1RB
UlQsIDB4MDA5OSk7CisJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9QTEwxX0xP
Q0tfUkVGQ05UX1NUQVJULCAweDAwOTkpOworCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFw
LCBDTU5fUExMMV9MT0NLX1BMTENOVF9TVEFSVCwgMHgwMDk5KTsKIH0KIAogc3RhdGljCiB2b2lk
IGNkbnNfdG9ycmVudF9kcF9wbWFfY21uX2NmZ18yNW1oeihzdHJ1Y3QgY2Ruc190b3JyZW50X3Bo
eSAqY2Ruc19waHkpCiB7CisJc3RydWN0IHJlZ21hcCAqcmVnbWFwID0gY2Ruc19waHktPnJlZ21h
cF9jb21tb25fY2RiOworCiAJLyogcmVmY2xvY2sgcmVnaXN0ZXJzIC0gYXNzdW1lcyAyNSBNSHog
cmVmY2xvY2sgKi8KLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fU1NNX0JJ
QVNfVE1SLCAweDAwMTkpOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9Q
TExTTTBfUExMUFJFX1RNUiwgMHgwMDMyKTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNf
cGh5LCBDTU5fUExMU00wX1BMTExPQ0tfVE1SLCAweDAwRDEpOwotCWNkbnNfdG9ycmVudF9waHlf
d3JpdGUoY2Ruc19waHksIENNTl9QTExTTTFfUExMUFJFX1RNUiwgMHgwMDMyKTsKLQljZG5zX3Rv
cnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUExMU00xX1BMTExPQ0tfVE1SLCAweDAwRDEp
OwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9CR0NBTF9JTklUX1RNUiwg
MHgwMDdEKTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fQkdDQUxfSVRF
Ul9UTVIsIDB4MDA3RCk7Ci0JY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX0lC
Q0FMX0lOSVRfVE1SLCAweDAwMTkpOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHks
IENNTl9UWFBVQ0FMX0lOSVRfVE1SLCAweDAwMUUpOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUo
Y2Ruc19waHksIENNTl9UWFBVQ0FMX0lURVJfVE1SLCAweDAwMDYpOwotCWNkbnNfdG9ycmVudF9w
aHlfd3JpdGUoY2Ruc19waHksIENNTl9UWFBEQ0FMX0lOSVRfVE1SLCAweDAwMUUpOwotCWNkbnNf
dG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9UWFBEQ0FMX0lURVJfVE1SLCAweDAwMDYp
OwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9SWENBTF9JTklUX1RNUiwg
MHgwMkVFKTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUlhDQUxfSVRF
Ul9UTVIsIDB4MDAwNik7Ci0JY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX1NE
X0NBTF9JTklUX1RNUiwgMHgwMDAyKTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5
LCBDTU5fU0RfQ0FMX0lURVJfVE1SLCAweDAwMDIpOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUo
Y2Ruc19waHksIENNTl9TRF9DQUxfUkVGVElNX1NUQVJULCAweDAwMEUpOwotCWNkbnNfdG9ycmVu
dF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9TRF9DQUxfUExMQ05UX1NUQVJULCAweDAxMkIpOwor
CWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBDTU5fU1NNX0JJQVNfVE1SLCAweDAwMTkp
OworCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBDTU5fUExMU00wX1BMTFBSRV9UTVIs
IDB4MDAzMik7CisJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9QTExTTTBfUExM
TE9DS19UTVIsIDB4MDBEMSk7CisJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9Q
TExTTTFfUExMUFJFX1RNUiwgMHgwMDMyKTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21h
cCwgQ01OX1BMTFNNMV9QTExMT0NLX1RNUiwgMHgwMEQxKTsKKwljZG5zX3RvcnJlbnRfcGh5X3dy
aXRlKHJlZ21hcCwgQ01OX0JHQ0FMX0lOSVRfVE1SLCAweDAwN0QpOworCWNkbnNfdG9ycmVudF9w
aHlfd3JpdGUocmVnbWFwLCBDTU5fQkdDQUxfSVRFUl9UTVIsIDB4MDA3RCk7CisJY2Ruc190b3Jy
ZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9JQkNBTF9JTklUX1RNUiwgMHgwMDE5KTsKKwljZG5z
X3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1RYUFVDQUxfSU5JVF9UTVIsIDB4MDAxRSk7
CisJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9UWFBVQ0FMX0lURVJfVE1SLCAw
eDAwMDYpOworCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBDTU5fVFhQRENBTF9JTklU
X1RNUiwgMHgwMDFFKTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1RYUERD
QUxfSVRFUl9UTVIsIDB4MDAwNik7CisJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENN
Tl9SWENBTF9JTklUX1RNUiwgMHgwMkVFKTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21h
cCwgQ01OX1JYQ0FMX0lURVJfVE1SLCAweDAwMDYpOworCWNkbnNfdG9ycmVudF9waHlfd3JpdGUo
cmVnbWFwLCBDTU5fU0RfQ0FMX0lOSVRfVE1SLCAweDAwMDIpOworCWNkbnNfdG9ycmVudF9waHlf
d3JpdGUocmVnbWFwLCBDTU5fU0RfQ0FMX0lURVJfVE1SLCAweDAwMDIpOworCWNkbnNfdG9ycmVu
dF9waHlfd3JpdGUocmVnbWFwLCBDTU5fU0RfQ0FMX1JFRlRJTV9TVEFSVCwgMHgwMDBFKTsKKwlj
ZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1NEX0NBTF9QTExDTlRfU1RBUlQsIDB4
MDEyQik7CiAKIAkvKiBQTEwgcmVnaXN0ZXJzICovCi0JY2Ruc190b3JyZW50X3BoeV93cml0ZShj
ZG5zX3BoeSwgQ01OX1BESUFHX1BMTDBfQ1BfUEFESl9NMCwgMHgwNTA5KTsKLQljZG5zX3RvcnJl
bnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUERJQUdfUExMMF9DUF9JQURKX00wLCAweDBGMDAp
OwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QRElBR19QTEwwX0ZJTFRf
UEFESl9NMCwgMHgwRjA4KTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5f
UExMMF9EU01fRElBR19NMCwgMHgwMDA0KTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNf
cGh5LCBDTU5fUERJQUdfUExMMV9DUF9QQURKX00wLCAweDA1MDkpOwotCWNkbnNfdG9ycmVudF9w
aHlfd3JpdGUoY2Ruc19waHksIENNTl9QRElBR19QTEwxX0NQX0lBREpfTTAsIDB4MEYwMCk7Ci0J
Y2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX1BESUFHX1BMTDFfRklMVF9QQURK
X00wLCAweDBGMDgpOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwx
X0RTTV9ESUFHX00wLCAweDAwMDQpOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHks
IENNTl9QTEwwX1ZDT0NBTF9JTklUX1RNUiwgMHgwMEZBKTsKLQljZG5zX3RvcnJlbnRfcGh5X3dy
aXRlKGNkbnNfcGh5LCBDTU5fUExMMF9WQ09DQUxfSVRFUl9UTVIsIDB4MDAwNCk7Ci0JY2Ruc190
b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX1BMTDFfVkNPQ0FMX0lOSVRfVE1SLCAweDAw
RkEpOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwxX1ZDT0NBTF9J
VEVSX1RNUiwgMHgwMDA0KTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5f
UExMMF9WQ09DQUxfUkVGVElNX1NUQVJULCAweDAzMTcpOwotCWNkbnNfdG9ycmVudF9waHlfd3Jp
dGUoY2Ruc19waHksIENNTl9QTEwwX1ZDT0NBTF9UQ1RSTCwgMHgwMDAzKTsKLQljZG5zX3RvcnJl
bnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUExMMV9WQ09DQUxfUkVGVElNX1NUQVJULCAweDAz
MTcpOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwxX1ZDT0NBTF9U
Q1RSTCwgMHgwMDAzKTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BESUFH
X1BMTDBfQ1BfUEFESl9NMCwgMHgwNTA5KTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21h
cCwgQ01OX1BESUFHX1BMTDBfQ1BfSUFESl9NMCwgMHgwRjAwKTsKKwljZG5zX3RvcnJlbnRfcGh5
X3dyaXRlKHJlZ21hcCwgQ01OX1BESUFHX1BMTDBfRklMVF9QQURKX00wLCAweDBGMDgpOworCWNk
bnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBDTU5fUExMMF9EU01fRElBR19NMCwgMHgwMDA0
KTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BESUFHX1BMTDFfQ1BfUEFE
Sl9NMCwgMHgwNTA5KTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BESUFH
X1BMTDFfQ1BfSUFESl9NMCwgMHgwRjAwKTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21h
cCwgQ01OX1BESUFHX1BMTDFfRklMVF9QQURKX00wLCAweDBGMDgpOworCWNkbnNfdG9ycmVudF9w
aHlfd3JpdGUocmVnbWFwLCBDTU5fUExMMV9EU01fRElBR19NMCwgMHgwMDA0KTsKKwljZG5zX3Rv
cnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTDBfVkNPQ0FMX0lOSVRfVE1SLCAweDAwRkEp
OworCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBDTU5fUExMMF9WQ09DQUxfSVRFUl9U
TVIsIDB4MDAwNCk7CisJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9QTEwxX1ZD
T0NBTF9JTklUX1RNUiwgMHgwMEZBKTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwg
Q01OX1BMTDFfVkNPQ0FMX0lURVJfVE1SLCAweDAwMDQpOworCWNkbnNfdG9ycmVudF9waHlfd3Jp
dGUocmVnbWFwLCBDTU5fUExMMF9WQ09DQUxfUkVGVElNX1NUQVJULCAweDAzMTcpOworCWNkbnNf
dG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBDTU5fUExMMF9WQ09DQUxfVENUUkwsIDB4MDAwMyk7
CisJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9QTEwxX1ZDT0NBTF9SRUZUSU1f
U1RBUlQsIDB4MDMxNyk7CisJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9QTEwx
X1ZDT0NBTF9UQ1RSTCwgMHgwMDAzKTsKIH0KIAogLyoKQEAgLTEwNzAsMzMgKzExOTcsMzcgQEAg
dm9pZCBjZG5zX3RvcnJlbnRfZHBfcG1hX2Ntbl9jZmdfMjVtaHooc3RydWN0IGNkbnNfdG9ycmVu
dF9waHkgKmNkbnNfcGh5KQogc3RhdGljIHZvaWQgY2Ruc190b3JyZW50X2RwX2VuYWJsZV9zc2Nf
MjVtaHooc3RydWN0IGNkbnNfdG9ycmVudF9waHkgKmNkbnNfcGh5LAogCQkJCQkgICAgIHUzMiBj
dHJsMl92YWwpCiB7Ci0JY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX1BMTDBf
U1NfQ1RSTDFfTTAsIDB4MDAwMSk7Ci0JY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwg
Q01OX1BMTDBfU1NfQ1RSTDFfTTAsIGN0cmwyX3ZhbCk7Ci0JY2Ruc190b3JyZW50X3BoeV93cml0
ZShjZG5zX3BoeSwgQ01OX1BMTDBfU1NfQ1RSTDFfTTAsIDB4MDA3Rik7Ci0JY2Ruc190b3JyZW50
X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX1BMTDBfU1NfQ1RSTDRfTTAsIDB4MDAwMyk7Ci0JY2Ru
c190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX1BMTDFfU1NfQ1RSTDFfTTAsIDB4MDAw
MSk7Ci0JY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX1BMTDFfU1NfQ1RSTDFf
TTAsIGN0cmwyX3ZhbCk7Ci0JY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX1BM
TDFfU1NfQ1RSTDFfTTAsIDB4MDA3Rik7Ci0JY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3Bo
eSwgQ01OX1BMTDFfU1NfQ1RSTDRfTTAsIDB4MDAwMyk7CisJc3RydWN0IHJlZ21hcCAqcmVnbWFw
ID0gY2Ruc19waHktPnJlZ21hcF9jb21tb25fY2RiOworCisJY2Ruc190b3JyZW50X3BoeV93cml0
ZShyZWdtYXAsIENNTl9QTEwwX1NTX0NUUkwxX00wLCAweDAwMDEpOworCWNkbnNfdG9ycmVudF9w
aHlfd3JpdGUocmVnbWFwLCBDTU5fUExMMF9TU19DVFJMMV9NMCwgY3RybDJfdmFsKTsKKwljZG5z
X3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTDBfU1NfQ1RSTDFfTTAsIDB4MDA3Rik7
CisJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9QTEwwX1NTX0NUUkw0X00wLCAw
eDAwMDMpOworCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBDTU5fUExMMV9TU19DVFJM
MV9NMCwgMHgwMDAxKTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTDFf
U1NfQ1RSTDFfTTAsIGN0cmwyX3ZhbCk7CisJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAs
IENNTl9QTEwxX1NTX0NUUkwxX00wLCAweDAwN0YpOworCWNkbnNfdG9ycmVudF9waHlfd3JpdGUo
cmVnbWFwLCBDTU5fUExMMV9TU19DVFJMNF9NMCwgMHgwMDAzKTsKIH0KIAogc3RhdGljCiB2b2lk
IGNkbnNfdG9ycmVudF9kcF9wbWFfY21uX3Zjb19jZmdfMjVtaHooc3RydWN0IGNkbnNfdG9ycmVu
dF9waHkgKmNkbnNfcGh5LAogCQkJCQkgICB1MzIgcmF0ZSwgYm9vbCBzc2MpCiB7CisJc3RydWN0
IHJlZ21hcCAqcmVnbWFwID0gY2Ruc19waHktPnJlZ21hcF9jb21tb25fY2RiOworCiAJLyogQXNz
dW1lcyAyNSBNSHogcmVmY2xvY2sgKi8KIAlzd2l0Y2ggKHJhdGUpIHsKIAkvKiBTZXR0aW5nIFZD
TyBmb3IgMTAuOEdIeiAqLwogCWNhc2UgMjcwMDoKIAljYXNlIDU0MDA6Ci0JCWNkbnNfdG9ycmVu
dF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwwX0lOVERJVl9NMCwgMHgwMUIwKTsKLQkJY2Ru
c190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX1BMTDBfRlJBQ0RJVkxfTTAsIDB4MDAw
MCk7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwwX0ZSQUNESVZI
X00wLCAweDAwMDIpOwotCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUExM
MF9ISUdIX1RIUl9NMCwgMHgwMTIwKTsKLQkJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3Bo
eSwgQ01OX1BMTDFfSU5URElWX00wLCAweDAxQjApOwotCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRl
KGNkbnNfcGh5LCBDTU5fUExMMV9GUkFDRElWTF9NMCwgMHgwMDAwKTsKLQkJY2Ruc190b3JyZW50
X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX1BMTDFfRlJBQ0RJVkhfTTAsIDB4MDAwMik7Ci0JCWNk
bnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwxX0hJR0hfVEhSX00wLCAweDAx
MjApOworCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTDBfSU5URElWX00w
LCAweDAxQjApOworCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTDBfRlJB
Q0RJVkxfTTAsIDB4MDAwMCk7CisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBDTU5f
UExMMF9GUkFDRElWSF9NMCwgMHgwMDAyKTsKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdt
YXAsIENNTl9QTEwwX0hJR0hfVEhSX00wLCAweDAxMjApOworCQljZG5zX3RvcnJlbnRfcGh5X3dy
aXRlKHJlZ21hcCwgQ01OX1BMTDFfSU5URElWX00wLCAweDAxQjApOworCQljZG5zX3RvcnJlbnRf
cGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTDFfRlJBQ0RJVkxfTTAsIDB4MDAwMCk7CisJCWNkbnNf
dG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBDTU5fUExMMV9GUkFDRElWSF9NMCwgMHgwMDAyKTsK
KwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9QTEwxX0hJR0hfVEhSX00wLCAw
eDAxMjApOwogCQlpZiAoc3NjKQogCQkJY2Ruc190b3JyZW50X2RwX2VuYWJsZV9zc2NfMjVtaHoo
Y2Ruc19waHksIDB4MDQyMyk7CiAJCWJyZWFrOwpAQCAtMTEwNCw4MiArMTIzNSw4MiBAQCB2b2lk
IGNkbnNfdG9ycmVudF9kcF9wbWFfY21uX3Zjb19jZmdfMjVtaHooc3RydWN0IGNkbnNfdG9ycmVu
dF9waHkgKmNkbnNfcGh5LAogCWNhc2UgMTYyMDoKIAljYXNlIDI0MzA6CiAJY2FzZSAzMjQwOgot
CQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUExMMF9JTlRESVZfTTAsIDB4
MDE4NCk7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwwX0ZSQUNE
SVZMX00wLCAweENDQ0QpOwotCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5f
UExMMF9GUkFDRElWSF9NMCwgMHgwMDAyKTsKLQkJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5z
X3BoeSwgQ01OX1BMTDBfSElHSF9USFJfTTAsIDB4MDEwNCk7Ci0JCWNkbnNfdG9ycmVudF9waHlf
d3JpdGUoY2Ruc19waHksIENNTl9QTEwxX0lOVERJVl9NMCwgMHgwMTg0KTsKLQkJY2Ruc190b3Jy
ZW50X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX1BMTDFfRlJBQ0RJVkxfTTAsIDB4Q0NDRCk7Ci0J
CWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwxX0ZSQUNESVZIX00wLCAw
eDAwMDIpOwotCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUExMMV9ISUdI
X1RIUl9NMCwgMHgwMTA0KTsKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9Q
TEwwX0lOVERJVl9NMCwgMHgwMTg0KTsKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAs
IENNTl9QTEwwX0ZSQUNESVZMX00wLCAweENDQ0QpOworCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRl
KHJlZ21hcCwgQ01OX1BMTDBfRlJBQ0RJVkhfTTAsIDB4MDAwMik7CisJCWNkbnNfdG9ycmVudF9w
aHlfd3JpdGUocmVnbWFwLCBDTU5fUExMMF9ISUdIX1RIUl9NMCwgMHgwMTA0KTsKKwkJY2Ruc190
b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9QTEwxX0lOVERJVl9NMCwgMHgwMTg0KTsKKwkJ
Y2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9QTEwxX0ZSQUNESVZMX00wLCAweEND
Q0QpOworCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTDFfRlJBQ0RJVkhf
TTAsIDB4MDAwMik7CisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBDTU5fUExMMV9I
SUdIX1RIUl9NMCwgMHgwMTA0KTsKIAkJaWYgKHNzYykKIAkJCWNkbnNfdG9ycmVudF9kcF9lbmFi
bGVfc3NjXzI1bWh6KGNkbnNfcGh5LCAweDAzQjkpOwogCQlicmVhazsKIAkvKiBTZXR0aW5nIFZD
TyBmb3IgOC42NEdIeiAqLwogCWNhc2UgMjE2MDoKIAljYXNlIDQzMjA6Ci0JCWNkbnNfdG9ycmVu
dF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwwX0lOVERJVl9NMCwgMHgwMTU5KTsKLQkJY2Ru
c190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX1BMTDBfRlJBQ0RJVkxfTTAsIDB4OTk5
QSk7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwwX0ZSQUNESVZI
X00wLCAweDAwMDIpOwotCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUExM
MF9ISUdIX1RIUl9NMCwgMHgwMEU3KTsKLQkJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3Bo
eSwgQ01OX1BMTDFfSU5URElWX00wLCAweDAxNTkpOwotCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRl
KGNkbnNfcGh5LCBDTU5fUExMMV9GUkFDRElWTF9NMCwgMHg5OTlBKTsKLQkJY2Ruc190b3JyZW50
X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX1BMTDFfRlJBQ0RJVkhfTTAsIDB4MDAwMik7Ci0JCWNk
bnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwxX0hJR0hfVEhSX00wLCAweDAw
RTcpOworCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTDBfSU5URElWX00w
LCAweDAxNTkpOworCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTDBfRlJB
Q0RJVkxfTTAsIDB4OTk5QSk7CisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBDTU5f
UExMMF9GUkFDRElWSF9NMCwgMHgwMDAyKTsKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdt
YXAsIENNTl9QTEwwX0hJR0hfVEhSX00wLCAweDAwRTcpOworCQljZG5zX3RvcnJlbnRfcGh5X3dy
aXRlKHJlZ21hcCwgQ01OX1BMTDFfSU5URElWX00wLCAweDAxNTkpOworCQljZG5zX3RvcnJlbnRf
cGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTDFfRlJBQ0RJVkxfTTAsIDB4OTk5QSk7CisJCWNkbnNf
dG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBDTU5fUExMMV9GUkFDRElWSF9NMCwgMHgwMDAyKTsK
KwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9QTEwxX0hJR0hfVEhSX00wLCAw
eDAwRTcpOwogCQlpZiAoc3NjKQogCQkJY2Ruc190b3JyZW50X2RwX2VuYWJsZV9zc2NfMjVtaHoo
Y2Ruc19waHksIDB4MDM0Rik7CiAJCWJyZWFrOwogCS8qIFNldHRpbmcgVkNPIGZvciA4LjFHSHog
Ki8KIAljYXNlIDgxMDA6Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9Q
TEwwX0lOVERJVl9NMCwgMHgwMTQ0KTsKLQkJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3Bo
eSwgQ01OX1BMTDBfRlJBQ0RJVkxfTTAsIDB4MDAwMCk7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3Jp
dGUoY2Ruc19waHksIENNTl9QTEwwX0ZSQUNESVZIX00wLCAweDAwMDIpOwotCQljZG5zX3RvcnJl
bnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUExMMF9ISUdIX1RIUl9NMCwgMHgwMEQ4KTsKLQkJ
Y2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX1BMTDFfSU5URElWX00wLCAweDAx
NDQpOwotCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUExMMV9GUkFDRElW
TF9NMCwgMHgwMDAwKTsKLQkJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX1BM
TDFfRlJBQ0RJVkhfTTAsIDB4MDAwMik7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19w
aHksIENNTl9QTEwxX0hJR0hfVEhSX00wLCAweDAwRDgpOworCQljZG5zX3RvcnJlbnRfcGh5X3dy
aXRlKHJlZ21hcCwgQ01OX1BMTDBfSU5URElWX00wLCAweDAxNDQpOworCQljZG5zX3RvcnJlbnRf
cGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTDBfRlJBQ0RJVkxfTTAsIDB4MDAwMCk7CisJCWNkbnNf
dG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBDTU5fUExMMF9GUkFDRElWSF9NMCwgMHgwMDAyKTsK
KwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9QTEwwX0hJR0hfVEhSX00wLCAw
eDAwRDgpOworCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTDFfSU5URElW
X00wLCAweDAxNDQpOworCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTDFf
RlJBQ0RJVkxfTTAsIDB4MDAwMCk7CisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBD
TU5fUExMMV9GUkFDRElWSF9NMCwgMHgwMDAyKTsKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShy
ZWdtYXAsIENNTl9QTEwxX0hJR0hfVEhSX00wLCAweDAwRDgpOwogCQlpZiAoc3NjKQogCQkJY2Ru
c190b3JyZW50X2RwX2VuYWJsZV9zc2NfMjVtaHooY2Ruc19waHksIDB4MDMxQSk7CiAJCWJyZWFr
OwogCX0KIAotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QRElBR19QTEww
X0NUUkxfTTAsIDB4MDAwMik7Ci0JY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwgQ01O
X1BESUFHX1BMTDFfQ1RSTF9NMCwgMHgwMDAyKTsKKwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJl
Z21hcCwgQ01OX1BESUFHX1BMTDBfQ1RSTF9NMCwgMHgwMDAyKTsKKwljZG5zX3RvcnJlbnRfcGh5
X3dyaXRlKHJlZ21hcCwgQ01OX1BESUFHX1BMTDFfQ1RSTF9NMCwgMHgwMDAyKTsKIAogCWlmIChz
c2MpIHsKLQkJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwKKwkJY2Ruc190b3JyZW50
X3BoeV93cml0ZShyZWdtYXAsCiAJCQkJICAgICAgIENNTl9QTEwwX1ZDT0NBTF9QTExDTlRfU1RB
UlQsIDB4MDMxNSk7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksCisJCWNkbnNf
dG9ycmVudF9waHlfd3JpdGUocmVnbWFwLAogCQkJCSAgICAgICBDTU5fUExMMF9MT0NLX1BMTENO
VF9USFIsIDB4MDAwNSk7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksCisJCWNk
bnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLAogCQkJCSAgICAgICBDTU5fUExMMV9WQ09DQUxf
UExMQ05UX1NUQVJULCAweDAzMTUpOwotCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5
LAorCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwKIAkJCQkgICAgICAgQ01OX1BMTDFf
TE9DS19QTExDTlRfVEhSLCAweDAwMDUpOwogCX0gZWxzZSB7Ci0JCWNkbnNfdG9ycmVudF9waHlf
d3JpdGUoY2Ruc19waHksCisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLAogCQkJCSAg
ICAgICBDTU5fUExMMF9WQ09DQUxfUExMQ05UX1NUQVJULCAweDAzMTcpOwotCQljZG5zX3RvcnJl
bnRfcGh5X3dyaXRlKGNkbnNfcGh5LAorCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwK
IAkJCQkgICAgICAgQ01OX1BMTDFfVkNPQ0FMX1BMTENOVF9TVEFSVCwgMHgwMzE3KTsKIAkJLyog
U2V0IHJlc2V0IHJlZ2lzdGVyIHZhbHVlcyB0byBkaXNhYmxlIFNTQyAqLwotCQljZG5zX3RvcnJl
bnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUExMMF9TU19DVFJMMV9NMCwgMHgwMDAyKTsKLQkJ
Y2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX1BMTDBfU1NfQ1RSTDJfTTAsIDB4
MDAwMCk7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwwX1NTX0NU
UkwzX00wLCAweDAwMDApOwotCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5f
UExMMF9TU19DVFJMNF9NMCwgMHgwMDAwKTsKLQkJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5z
X3BoeSwKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9QTEwwX1NTX0NUUkwx
X00wLCAweDAwMDIpOworCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTDBf
U1NfQ1RSTDJfTTAsIDB4MDAwMCk7CisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBD
TU5fUExMMF9TU19DVFJMM19NMCwgMHgwMDAwKTsKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShy
ZWdtYXAsIENNTl9QTEwwX1NTX0NUUkw0X00wLCAweDAwMDApOworCQljZG5zX3RvcnJlbnRfcGh5
X3dyaXRlKHJlZ21hcCwKIAkJCQkgICAgICAgQ01OX1BMTDBfTE9DS19QTExDTlRfVEhSLCAweDAw
MDMpOwotCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCBDTU5fUExMMV9TU19DVFJM
MV9NMCwgMHgwMDAyKTsKLQkJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwgQ01OX1BM
TDFfU1NfQ1RSTDJfTTAsIDB4MDAwMCk7Ci0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19w
aHksIENNTl9QTEwxX1NTX0NUUkwzX00wLCAweDAwMDApOwotCQljZG5zX3RvcnJlbnRfcGh5X3dy
aXRlKGNkbnNfcGh5LCBDTU5fUExMMV9TU19DVFJMNF9NMCwgMHgwMDAwKTsKLQkJY2Ruc190b3Jy
ZW50X3BoeV93cml0ZShjZG5zX3BoeSwKKwkJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAs
IENNTl9QTEwxX1NTX0NUUkwxX00wLCAweDAwMDIpOworCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRl
KHJlZ21hcCwgQ01OX1BMTDFfU1NfQ1RSTDJfTTAsIDB4MDAwMCk7CisJCWNkbnNfdG9ycmVudF9w
aHlfd3JpdGUocmVnbWFwLCBDTU5fUExMMV9TU19DVFJMM19NMCwgMHgwMDAwKTsKKwkJY2Ruc190
b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9QTEwxX1NTX0NUUkw0X00wLCAweDAwMDApOwor
CQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKHJlZ21hcCwKIAkJCQkgICAgICAgQ01OX1BMTDFfTE9D
S19QTExDTlRfVEhSLCAweDAwMDMpOwogCX0KIAotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ru
c19waHksIENNTl9QTEwwX0xPQ0tfUkVGQ05UX1NUQVJULCAweDAwQzcpOwotCWNkbnNfdG9ycmVu
dF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwwX0xPQ0tfUExMQ05UX1NUQVJULCAweDAwQzcp
OwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9QTEwxX0xPQ0tfUkVGQ05U
X1NUQVJULCAweDAwQzcpOwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIENNTl9Q
TEwxX0xPQ0tfUExMQ05UX1NUQVJULCAweDAwQzcpOworCWNkbnNfdG9ycmVudF9waHlfd3JpdGUo
cmVnbWFwLCBDTU5fUExMMF9MT0NLX1JFRkNOVF9TVEFSVCwgMHgwMEM3KTsKKwljZG5zX3RvcnJl
bnRfcGh5X3dyaXRlKHJlZ21hcCwgQ01OX1BMTDBfTE9DS19QTExDTlRfU1RBUlQsIDB4MDBDNyk7
CisJY2Ruc190b3JyZW50X3BoeV93cml0ZShyZWdtYXAsIENNTl9QTEwxX0xPQ0tfUkVGQ05UX1NU
QVJULCAweDAwQzcpOworCWNkbnNfdG9ycmVudF9waHlfd3JpdGUocmVnbWFwLCBDTU5fUExMMV9M
T0NLX1BMTENOVF9TVEFSVCwgMHgwMEM3KTsKIH0KIAogc3RhdGljIHZvaWQgY2Ruc190b3JyZW50
X2RwX3BtYV9jbW5fcmF0ZShzdHJ1Y3QgY2Ruc190b3JyZW50X3BoeSAqY2Ruc19waHksCkBAIC0x
MTkwLDcgKzEzMjEsNyBAQCBzdGF0aWMgdm9pZCBjZG5zX3RvcnJlbnRfZHBfcG1hX2Ntbl9yYXRl
KHN0cnVjdCBjZG5zX3RvcnJlbnRfcGh5ICpjZG5zX3BoeSwKIAl1bnNpZ25lZCBpbnQgaTsKIAog
CS8qIDE2J2gwMDAwIGZvciBzaW5nbGUgRFAgbGluayBjb25maWd1cmF0aW9uICovCi0JY2Ruc190
b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwgUEhZX1BMTF9DRkcsIDB4MDAwMCk7CisJcmVnbWFw
X2ZpZWxkX3dyaXRlKGNkbnNfcGh5LT5waHlfcGxsX2NmZywgMHgwKTsKIAogCXN3aXRjaCAocmF0
ZSkgewogCWNhc2UgMTYyMDoKQEAgLTEyMTgsNTQgKzEzNDksNTggQEAgc3RhdGljIHZvaWQgY2Ru
c190b3JyZW50X2RwX3BtYV9jbW5fcmF0ZShzdHJ1Y3QgY2Ruc190b3JyZW50X3BoeSAqY2Ruc19w
aHksCiAJCWJyZWFrOwogCX0KIAotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksCisJ
Y2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeS0+cmVnbWFwX2NvbW1vbl9jZGIsCiAJCQkg
ICAgICAgQ01OX1BESUFHX1BMTDBfQ0xLX1NFTF9NMCwgY2xrX3NlbF92YWwpOwotCWNkbnNfdG9y
cmVudF9waHlfd3JpdGUoY2Ruc19waHksCisJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3Bo
eS0+cmVnbWFwX2NvbW1vbl9jZGIsCiAJCQkgICAgICAgQ01OX1BESUFHX1BMTDFfQ0xLX1NFTF9N
MCwgY2xrX3NlbF92YWwpOwogCiAJLyogUE1BIGxhbmUgY29uZmlndXJhdGlvbiB0byBkZWFsIHdp
dGggbXVsdGktbGluayBvcGVyYXRpb24gKi8KIAlmb3IgKGkgPSAwOyBpIDwgY2Ruc19waHktPm51
bV9sYW5lczsgaSsrKQotCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LAotCQkJCSAg
ICAgICAoWENWUl9ESUFHX0hTQ0xLX0RJViB8IChpIDw8IDExKSksCi0JCQkJICAgICAgIGhzY2xr
X2Rpdl92YWwpOworCQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LT5yZWdtYXBfdHhf
bGFuZV9jZGJbaV0sCisJCQkJICAgICAgIFhDVlJfRElBR19IU0NMS19ESVYsIGhzY2xrX2Rpdl92
YWwpOwogfQogCiBzdGF0aWMgdm9pZCBjZG5zX3RvcnJlbnRfZHBfcG1hX2xhbmVfY2ZnKHN0cnVj
dCBjZG5zX3RvcnJlbnRfcGh5ICpjZG5zX3BoeSwKIAkJCQkJIHVuc2lnbmVkIGludCBsYW5lKQog
ewotCXVuc2lnbmVkIGludCBsYW5lX2JpdHMgPSAobGFuZSAmIExBTkVfTUFTSykgPDwgMTE7Ci0K
IAkvKiBQZXIgbGFuZSwgcmVmY2xvY2stZGVwZW5kZW50IHJlY2VpdmVyIGRldGVjdGlvbiBzZXR0
aW5nICovCiAJaWYgKGNkbnNfcGh5LT5yZWZfY2xrX3JhdGUgPT0gUkVGX0NMS18xOV8yTUh6KQot
CQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LAotCQkJCSAgICAgICAoVFhfUkNWREVU
X1NUX1RNUiB8IGxhbmVfYml0cyksIDB4MDc4MCk7CisJCWNkbnNfdG9ycmVudF9waHlfd3JpdGUo
Y2Ruc19waHktPnJlZ21hcF90eF9sYW5lX2NkYltsYW5lXSwKKwkJCQkgICAgICAgVFhfUkNWREVU
X1NUX1RNUiwgMHgwNzgwKTsKIAllbHNlIGlmIChjZG5zX3BoeS0+cmVmX2Nsa19yYXRlID09IFJF
Rl9DTEtfMjVNSHopCi0JCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksCi0JCQkJICAg
ICAgIChUWF9SQ1ZERVRfU1RfVE1SIHwgbGFuZV9iaXRzKSwgMHgwOUM0KTsKKwkJY2Ruc190b3Jy
ZW50X3BoeV93cml0ZShjZG5zX3BoeS0+cmVnbWFwX3R4X2xhbmVfY2RiW2xhbmVdLAorCQkJCSAg
ICAgICBUWF9SQ1ZERVRfU1RfVE1SLCAweDA5QzQpOwogCiAJLyogV3JpdGluZyBUeC9SeCBQb3dl
ciBTdGF0ZSBDb250cm9sbGVycyByZWdpc3RlcnMgKi8KLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRl
KGNkbnNfcGh5LCAoVFhfUFNDX0EwIHwgbGFuZV9iaXRzKSwgMHgwMEZCKTsKLQljZG5zX3RvcnJl
bnRfcGh5X3dyaXRlKGNkbnNfcGh5LCAoVFhfUFNDX0EyIHwgbGFuZV9iaXRzKSwgMHgwNEFBKTsK
LQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCAoVFhfUFNDX0EzIHwgbGFuZV9iaXRz
KSwgMHgwNEFBKTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LCAoUlhfUFNDX0Ew
IHwgbGFuZV9iaXRzKSwgMHgwMDAwKTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5
LCAoUlhfUFNDX0EyIHwgbGFuZV9iaXRzKSwgMHgwMDAwKTsKLQljZG5zX3RvcnJlbnRfcGh5X3dy
aXRlKGNkbnNfcGh5LCAoUlhfUFNDX0EzIHwgbGFuZV9iaXRzKSwgMHgwMDAwKTsKLQotCWNkbnNf
dG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksIChSWF9QU0NfQ0FMIHwgbGFuZV9iaXRzKSwgMHgw
MDAwKTsKLQotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksCi0JCQkgICAgICAgKFJY
X1JFRV9HQ1NNMV9DVFJMIHwgbGFuZV9iaXRzKSwgMHgwMDAwKTsKLQljZG5zX3RvcnJlbnRfcGh5
X3dyaXRlKGNkbnNfcGh5LAotCQkJICAgICAgIChSWF9SRUVfR0NTTTJfQ1RSTCB8IGxhbmVfYml0
cyksIDB4MDAwMCk7Ci0JY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeSwKLQkJCSAgICAg
ICAoUlhfUkVFX1BFUkdDU01fQ1RSTCB8IGxhbmVfYml0cyksIDB4MDAwMCk7Ci0KLQljZG5zX3Rv
cnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LAotCQkJICAgICAgIChYQ1ZSX0RJQUdfQklESV9DVFJM
IHwgbGFuZV9iaXRzKSwgMHgwMDBGKTsKLQljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5
LAotCQkJICAgICAgIChYQ1ZSX0RJQUdfUExMRFJDX0NUUkwgfCBsYW5lX2JpdHMpLCAweDAwMDEp
OwotCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19waHksCi0JCQkgICAgICAgKFhDVlJfRElB
R19IU0NMS19TRUwgfCBsYW5lX2JpdHMpLCAweDAwMDApOworCWNkbnNfdG9ycmVudF9waHlfd3Jp
dGUoY2Ruc19waHktPnJlZ21hcF90eF9sYW5lX2NkYltsYW5lXSwKKwkJCSAgICAgICBUWF9QU0Nf
QTAsIDB4MDBGQik7CisJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeS0+cmVnbWFwX3R4
X2xhbmVfY2RiW2xhbmVdLAorCQkJICAgICAgIFRYX1BTQ19BMiwgMHgwNEFBKTsKKwljZG5zX3Rv
cnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LT5yZWdtYXBfdHhfbGFuZV9jZGJbbGFuZV0sCisJCQkg
ICAgICAgVFhfUFNDX0EzLCAweDA0QUEpOworCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ruc19w
aHktPnJlZ21hcF9yeF9sYW5lX2NkYltsYW5lXSwKKwkJCSAgICAgICBSWF9QU0NfQTAsIDB4MDAw
MCk7CisJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeS0+cmVnbWFwX3J4X2xhbmVfY2Ri
W2xhbmVdLAorCQkJICAgICAgIFJYX1BTQ19BMiwgMHgwMDAwKTsKKwljZG5zX3RvcnJlbnRfcGh5
X3dyaXRlKGNkbnNfcGh5LT5yZWdtYXBfcnhfbGFuZV9jZGJbbGFuZV0sCisJCQkgICAgICAgUlhf
UFNDX0EzLCAweDAwMDApOworCisJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeS0+cmVn
bWFwX3J4X2xhbmVfY2RiW2xhbmVdLAorCQkJICAgICAgIFJYX1BTQ19DQUwsIDB4MDAwMCk7CisK
KwljZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LT5yZWdtYXBfcnhfbGFuZV9jZGJbbGFu
ZV0sCisJCQkgICAgICAgUlhfUkVFX0dDU00xX0NUUkwsIDB4MDAwMCk7CisJY2Ruc190b3JyZW50
X3BoeV93cml0ZShjZG5zX3BoeS0+cmVnbWFwX3J4X2xhbmVfY2RiW2xhbmVdLAorCQkJICAgICAg
IFJYX1JFRV9HQ1NNMl9DVFJMLCAweDAwMDApOworCWNkbnNfdG9ycmVudF9waHlfd3JpdGUoY2Ru
c19waHktPnJlZ21hcF9yeF9sYW5lX2NkYltsYW5lXSwKKwkJCSAgICAgICBSWF9SRUVfUEVSR0NT
TV9DVFJMLCAweDAwMDApOworCisJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeS0+cmVn
bWFwX3R4X2xhbmVfY2RiW2xhbmVdLAorCQkJICAgICAgIFhDVlJfRElBR19CSURJX0NUUkwsIDB4
MDAwRik7CisJY2Ruc190b3JyZW50X3BoeV93cml0ZShjZG5zX3BoeS0+cmVnbWFwX3R4X2xhbmVf
Y2RiW2xhbmVdLAorCQkJICAgICAgIFhDVlJfRElBR19QTExEUkNfQ1RSTCwgMHgwMDAxKTsKKwlj
ZG5zX3RvcnJlbnRfcGh5X3dyaXRlKGNkbnNfcGh5LT5yZWdtYXBfdHhfbGFuZV9jZGJbbGFuZV0s
CisJCQkgICAgICAgWENWUl9ESUFHX0hTQ0xLX1NFTCwgMHgwMDAwKTsKIH0KIAogc3RhdGljIGlu
dCBjZG5zX3RvcnJlbnRfZHBfc2V0X3Bvd2VyX3N0YXRlKHN0cnVjdCBjZG5zX3RvcnJlbnRfcGh5
ICpjZG5zX3BoeSwKQEAgLTEzOTQsMTQgKzE1MjksMTQyIEBAIHN0YXRpYyBpbnQgY2Ruc190b3Jy
ZW50X3BoeV9vZmYoc3RydWN0IHBoeSAqcGh5KQogCXJldHVybiByZXNldF9jb250cm9sX2Fzc2Vy
dChjZG5zX3BoeS0+cGh5X3JzdCk7CiB9CiAKK3N0YXRpYyBzdHJ1Y3QgcmVnbWFwICpjZG5zX3Jl
Z21hcF9pbml0KHN0cnVjdCBkZXZpY2UgKmRldiwgdm9pZCBfX2lvbWVtICpiYXNlLAorCQkJCSAg
ICAgICB1MzIgYmxvY2tfb2Zmc2V0LAorCQkJCSAgICAgICB1OCByZWdfb2Zmc2V0X3NoaWZ0LAor
CQkJCSAgICAgICBjb25zdCBzdHJ1Y3QgcmVnbWFwX2NvbmZpZyAqY29uZmlnKQoreworCXN0cnVj
dCBjZG5zX3JlZ21hcF9jZGJfY29udGV4dCAqY3R4OworCisJY3R4ID0gZGV2bV9remFsbG9jKGRl
diwgc2l6ZW9mKCpjdHgpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWN0eCkKKwkJcmV0dXJuIEVSUl9Q
VFIoLUVOT01FTSk7CisKKwljdHgtPmRldiA9IGRldjsKKwljdHgtPmJhc2UgPSBiYXNlICsgYmxv
Y2tfb2Zmc2V0OworCWN0eC0+cmVnX29mZnNldF9zaGlmdCA9IHJlZ19vZmZzZXRfc2hpZnQ7CisK
KwlyZXR1cm4gZGV2bV9yZWdtYXBfaW5pdChkZXYsIE5VTEwsIGN0eCwgY29uZmlnKTsKK30KKwor
c3RhdGljIGludCBjZG5zX3JlZ2ZpZWxkX2luaXQoc3RydWN0IGNkbnNfdG9ycmVudF9waHkgKmNk
bnNfcGh5KQoreworCXN0cnVjdCBkZXZpY2UgKmRldiA9IGNkbnNfcGh5LT5kZXY7CisJc3RydWN0
IHJlZ21hcF9maWVsZCAqZmllbGQ7CisJc3RydWN0IHJlZ21hcCAqcmVnbWFwOworCisJcmVnbWFw
ID0gY2Ruc19waHktPnJlZ21hcF9waHlfcGNzX2NvbW1vbl9jZGI7CisJZmllbGQgPSBkZXZtX3Jl
Z21hcF9maWVsZF9hbGxvYyhkZXYsIHJlZ21hcCwgcGh5X3BsbF9jZmcpOworCWlmIChJU19FUlIo
ZmllbGQpKSB7CisJCWRldl9lcnIoZGV2LCAiUEhZX1BMTF9DRkcgcmVnIGZpZWxkIGluaXQgZmFp
bGVkXG4iKTsKKwkJcmV0dXJuIFBUUl9FUlIoZmllbGQpOworCX0KKwljZG5zX3BoeS0+cGh5X3Bs
bF9jZmcgPSBmaWVsZDsKKworCXJlZ21hcCA9IGNkbnNfcGh5LT5yZWdtYXBfcGh5X3BtYV9jb21t
b25fY2RiOworCWZpZWxkID0gZGV2bV9yZWdtYXBfZmllbGRfYWxsb2MoZGV2LCByZWdtYXAsIHBo
eV9wbWFfY21uX2N0cmxfMik7CisJaWYgKElTX0VSUihmaWVsZCkpIHsKKwkJZGV2X2VycihkZXYs
ICJQSFlfUE1BX0NNTl9DVFJMMiByZWcgZmllbGQgaW5pdCBmYWlsZWRcbiIpOworCQlyZXR1cm4g
UFRSX0VSUihmaWVsZCk7CisJfQorCWNkbnNfcGh5LT5waHlfcG1hX2Ntbl9jdHJsXzIgPSBmaWVs
ZDsKKworCXJlZ21hcCA9IGNkbnNfcGh5LT5yZWdtYXBfcGh5X3BtYV9jb21tb25fY2RiOworCWZp
ZWxkID0gZGV2bV9yZWdtYXBfZmllbGRfYWxsb2MoZGV2LCByZWdtYXAsIHBoeV9wbWFfcGxsX3Jh
d19jdHJsKTsKKwlpZiAoSVNfRVJSKGZpZWxkKSkgeworCQlkZXZfZXJyKGRldiwgIlBIWV9QTUFf
UExMX1JBV19DVFJMIHJlZyBmaWVsZCBpbml0IGZhaWxlZFxuIik7CisJCXJldHVybiBQVFJfRVJS
KGZpZWxkKTsKKwl9CisJY2Ruc19waHktPnBoeV9wbWFfcGxsX3Jhd19jdHJsID0gZmllbGQ7CisK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBjZG5zX3JlZ21hcF9pbml0X3RvcnJlbnRfZHAo
c3RydWN0IGNkbnNfdG9ycmVudF9waHkgKmNkbnNfcGh5LAorCQkJCSAgICAgICB2b2lkIF9faW9t
ZW0gKnNkX2Jhc2UsCisJCQkJICAgICAgIHZvaWQgX19pb21lbSAqYmFzZSwKKwkJCQkgICAgICAg
dTggYmxvY2tfb2Zmc2V0X3NoaWZ0LAorCQkJCSAgICAgICB1OCByZWdfb2Zmc2V0X3NoaWZ0KQor
eworCXN0cnVjdCBkZXZpY2UgKmRldiA9IGNkbnNfcGh5LT5kZXY7CisJc3RydWN0IHJlZ21hcCAq
cmVnbWFwOworCXUzMiBibG9ja19vZmZzZXQ7CisJaW50IGk7CisKKwlmb3IgKGkgPSAwOyBpIDwg
TUFYX05VTV9MQU5FUzsgaSsrKSB7CisJCWJsb2NrX29mZnNldCA9IFRPUlJFTlRfVFhfTEFORV9D
REJfT0ZGU0VUKGksIGJsb2NrX29mZnNldF9zaGlmdCwKKwkJCQkJCQkgIHJlZ19vZmZzZXRfc2hp
ZnQpOworCQlyZWdtYXAgPSBjZG5zX3JlZ21hcF9pbml0KGRldiwgc2RfYmFzZSwgYmxvY2tfb2Zm
c2V0LAorCQkJCQkgIHJlZ19vZmZzZXRfc2hpZnQsCisJCQkJCSAgJmNkbnNfdG9ycmVudF90eF9s
YW5lX2NkYl9jb25maWdbaV0pOworCQlpZiAoSVNfRVJSKHJlZ21hcCkpIHsKKwkJCWRldl9lcnIo
ZGV2LCAiRmFpbGVkIHRvIGluaXQgdHggbGFuZSBDREIgcmVnbWFwXG4iKTsKKwkJCXJldHVybiBQ
VFJfRVJSKHJlZ21hcCk7CisJCX0KKwkJY2Ruc19waHktPnJlZ21hcF90eF9sYW5lX2NkYltpXSA9
IHJlZ21hcDsKKworCQlibG9ja19vZmZzZXQgPSBUT1JSRU5UX1JYX0xBTkVfQ0RCX09GRlNFVChp
LCBibG9ja19vZmZzZXRfc2hpZnQsCisJCQkJCQkJICByZWdfb2Zmc2V0X3NoaWZ0KTsKKwkJcmVn
bWFwID0gY2Ruc19yZWdtYXBfaW5pdChkZXYsIHNkX2Jhc2UsIGJsb2NrX29mZnNldCwKKwkJCQkJ
ICByZWdfb2Zmc2V0X3NoaWZ0LAorCQkJCQkgICZjZG5zX3RvcnJlbnRfcnhfbGFuZV9jZGJfY29u
ZmlnW2ldKTsKKwkJaWYgKElTX0VSUihyZWdtYXApKSB7CisJCQlkZXZfZXJyKGRldiwgIkZhaWxl
ZCB0byBpbml0IHJ4IGxhbmUgQ0RCIHJlZ21hcFxuIik7CisJCQlyZXR1cm4gUFRSX0VSUihyZWdt
YXApOworCQl9CisJCWNkbnNfcGh5LT5yZWdtYXBfcnhfbGFuZV9jZGJbaV0gPSByZWdtYXA7CisJ
fQorCisJYmxvY2tfb2Zmc2V0ID0gVE9SUkVOVF9DT01NT05fQ0RCX09GRlNFVDsKKwlyZWdtYXAg
PSBjZG5zX3JlZ21hcF9pbml0KGRldiwgc2RfYmFzZSwgYmxvY2tfb2Zmc2V0LAorCQkJCSAgcmVn
X29mZnNldF9zaGlmdCwKKwkJCQkgICZjZG5zX3RvcnJlbnRfY29tbW9uX2NkYl9jb25maWcpOwor
CWlmIChJU19FUlIocmVnbWFwKSkgeworCQlkZXZfZXJyKGRldiwgIkZhaWxlZCB0byBpbml0IGNv
bW1vbiBDREIgcmVnbWFwXG4iKTsKKwkJcmV0dXJuIFBUUl9FUlIocmVnbWFwKTsKKwl9CisJY2Ru
c19waHktPnJlZ21hcF9jb21tb25fY2RiID0gcmVnbWFwOworCisJYmxvY2tfb2Zmc2V0ID0gVE9S
UkVOVF9QSFlfUENTX0NPTU1PTl9PRkZTRVQoYmxvY2tfb2Zmc2V0X3NoaWZ0KTsKKwlyZWdtYXAg
PSBjZG5zX3JlZ21hcF9pbml0KGRldiwgc2RfYmFzZSwgYmxvY2tfb2Zmc2V0LAorCQkJCSAgcmVn
X29mZnNldF9zaGlmdCwKKwkJCQkgICZjZG5zX3RvcnJlbnRfcGh5X3Bjc19jbW5fY2RiX2NvbmZp
Zyk7CisJaWYgKElTX0VSUihyZWdtYXApKSB7CisJCWRldl9lcnIoZGV2LCAiRmFpbGVkIHRvIGlu
aXQgUEhZIFBDUyBjb21tb24gQ0RCIHJlZ21hcFxuIik7CisJCXJldHVybiBQVFJfRVJSKHJlZ21h
cCk7CisJfQorCWNkbnNfcGh5LT5yZWdtYXBfcGh5X3Bjc19jb21tb25fY2RiID0gcmVnbWFwOwor
CisJYmxvY2tfb2Zmc2V0ID0gVE9SUkVOVF9QSFlfUE1BX0NPTU1PTl9PRkZTRVQoYmxvY2tfb2Zm
c2V0X3NoaWZ0KTsKKwlyZWdtYXAgPSBjZG5zX3JlZ21hcF9pbml0KGRldiwgc2RfYmFzZSwgYmxv
Y2tfb2Zmc2V0LAorCQkJCSAgcmVnX29mZnNldF9zaGlmdCwKKwkJCQkgICZjZG5zX3RvcnJlbnRf
cGh5X3BtYV9jbW5fY2RiX2NvbmZpZyk7CisJaWYgKElTX0VSUihyZWdtYXApKSB7CisJCWRldl9l
cnIoZGV2LCAiRmFpbGVkIHRvIGluaXQgUEhZIFBNQSBjb21tb24gQ0RCIHJlZ21hcFxuIik7CisJ
CXJldHVybiBQVFJfRVJSKHJlZ21hcCk7CisJfQorCWNkbnNfcGh5LT5yZWdtYXBfcGh5X3BtYV9j
b21tb25fY2RiID0gcmVnbWFwOworCisJcmV0dXJuIDA7Cit9CisKIHN0YXRpYyBpbnQgY2Ruc190
b3JyZW50X3BoeV9wcm9iZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQogewogCXN0cnVj
dCByZXNvdXJjZSAqcmVnczsKIAlzdHJ1Y3QgY2Ruc190b3JyZW50X3BoeSAqY2Ruc19waHk7CiAJ
c3RydWN0IGRldmljZSAqZGV2ID0gJnBkZXYtPmRldjsKIAlzdHJ1Y3QgcGh5X3Byb3ZpZGVyICpw
aHlfcHJvdmlkZXI7CisJY29uc3Qgc3RydWN0IG9mX2RldmljZV9pZCAqbWF0Y2g7CisJc3RydWN0
IGNkbnNfdG9ycmVudF9kYXRhICpkYXRhOwogCXN0cnVjdCBwaHkgKnBoeTsKLQlpbnQgZXJyOwor
CWludCBlcnIsIHJldDsKKworCS8qIEdldCBpbml0IGRhdGEgZm9yIHRoaXMgUEhZICovCisJbWF0
Y2ggPSBvZl9tYXRjaF9kZXZpY2UoY2Ruc190b3JyZW50X3BoeV9vZl9tYXRjaCwgZGV2KTsKKwlp
ZiAoIW1hdGNoKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCWRhdGEgPSAoc3RydWN0IGNkbnNfdG9y
cmVudF9kYXRhICopbWF0Y2gtPmRhdGE7CiAKIAljZG5zX3BoeSA9IGRldm1fa3phbGxvYyhkZXYs
IHNpemVvZigqY2Ruc19waHkpLCBHRlBfS0VSTkVMKTsKIAlpZiAoIWNkbnNfcGh5KQpAQCAtMTQx
NiwxNSArMTY3OSwxNSBAQCBzdGF0aWMgaW50IGNkbnNfdG9ycmVudF9waHlfcHJvYmUoc3RydWN0
IHBsYXRmb3JtX2RldmljZSAqcGRldikKIAl9CiAKIAlyZWdzID0gcGxhdGZvcm1fZ2V0X3Jlc291
cmNlKHBkZXYsIElPUkVTT1VSQ0VfTUVNLCAwKTsKLQljZG5zX3BoeS0+YmFzZSA9IGRldm1faW9y
ZW1hcF9yZXNvdXJjZSgmcGRldi0+ZGV2LCByZWdzKTsKLQlpZiAoSVNfRVJSKGNkbnNfcGh5LT5i
YXNlKSkKLQkJcmV0dXJuIFBUUl9FUlIoY2Ruc19waHktPmJhc2UpOwotCi0JcmVncyA9IHBsYXRm
b3JtX2dldF9yZXNvdXJjZShwZGV2LCBJT1JFU09VUkNFX01FTSwgMSk7CiAJY2Ruc19waHktPnNk
X2Jhc2UgPSBkZXZtX2lvcmVtYXBfcmVzb3VyY2UoJnBkZXYtPmRldiwgcmVncyk7CiAJaWYgKElT
X0VSUihjZG5zX3BoeS0+c2RfYmFzZSkpCiAJCXJldHVybiBQVFJfRVJSKGNkbnNfcGh5LT5zZF9i
YXNlKTsKIAorCXJlZ3MgPSBwbGF0Zm9ybV9nZXRfcmVzb3VyY2UocGRldiwgSU9SRVNPVVJDRV9N
RU0sIDEpOworCWNkbnNfcGh5LT5iYXNlID0gZGV2bV9pb3JlbWFwX3Jlc291cmNlKCZwZGV2LT5k
ZXYsIHJlZ3MpOworCWlmIChJU19FUlIoY2Ruc19waHktPmJhc2UpKQorCQlyZXR1cm4gUFRSX0VS
UihjZG5zX3BoeS0+YmFzZSk7CisKIAljZG5zX3BoeS0+cGh5X3JzdCA9IGRldm1fcmVzZXRfY29u
dHJvbF9hcnJheV9nZXRfZXhjbHVzaXZlKGRldik7CiAKIAllcnIgPSBkZXZpY2VfcHJvcGVydHlf
cmVhZF91MzIoZGV2LCAibnVtX2xhbmVzIiwKQEAgLTE0NzQsNiArMTczNywxNyBAQCBzdGF0aWMg
aW50IGNkbnNfdG9ycmVudF9waHlfcHJvYmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikK
IAogCXBoeV9zZXRfZHJ2ZGF0YShwaHksIGNkbnNfcGh5KTsKIAorCXJldCA9IGNkbnNfcmVnbWFw
X2luaXRfdG9ycmVudF9kcChjZG5zX3BoeSwgY2Ruc19waHktPnNkX2Jhc2UsCisJCQkJCSAgY2Ru
c19waHktPmJhc2UsCisJCQkJCSAgZGF0YS0+YmxvY2tfb2Zmc2V0X3NoaWZ0LAorCQkJCQkgIGRh
dGEtPnJlZ19vZmZzZXRfc2hpZnQpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwlyZXQg
PSBjZG5zX3JlZ2ZpZWxkX2luaXQoY2Ruc19waHkpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7
CisKIAlwaHlfcHJvdmlkZXIgPSBkZXZtX29mX3BoeV9wcm92aWRlcl9yZWdpc3RlcihkZXYsIG9m
X3BoeV9zaW1wbGVfeGxhdGUpOwogCiAJZGV2X2luZm8oZGV2LCAiJWQgbGFuZXMsIG1heCBiaXQg
cmF0ZSAlZC4lMDNkIEdicHNcbiIsCkBAIC0xNDg0LDkgKzE3NTgsMTUgQEAgc3RhdGljIGludCBj
ZG5zX3RvcnJlbnRfcGh5X3Byb2JlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpCiAJcmV0
dXJuIFBUUl9FUlJfT1JfWkVSTyhwaHlfcHJvdmlkZXIpOwogfQogCitzdGF0aWMgY29uc3Qgc3Ry
dWN0IGNkbnNfdG9ycmVudF9kYXRhIGNkbnNfbWFwX3RvcnJlbnQgPSB7CisJLmJsb2NrX29mZnNl
dF9zaGlmdCA9IDB4MiwKKwkucmVnX29mZnNldF9zaGlmdCA9IDB4MiwKK307CisKIHN0YXRpYyBj
b25zdCBzdHJ1Y3Qgb2ZfZGV2aWNlX2lkIGNkbnNfdG9ycmVudF9waHlfb2ZfbWF0Y2hbXSA9IHsK
IAl7Ci0JCS5jb21wYXRpYmxlID0gImNkbnMsdG9ycmVudC1waHkiCisJCS5jb21wYXRpYmxlID0g
ImNkbnMsdG9ycmVudC1waHkiLAorCQkuZGF0YSA9ICZjZG5zX21hcF90b3JyZW50LAogCX0sCiAJ
e30KIH07Ci0tIAoyLjcuNAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0
b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJp
LWRldmVs
