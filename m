Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 4D727D0DAF
	for <lists+dri-devel@lfdr.de>; Wed,  9 Oct 2019 13:31:20 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id DCBE289317;
	Wed,  9 Oct 2019 11:31:17 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from aserp2120.oracle.com (aserp2120.oracle.com [141.146.126.78])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BBA0189317
 for <dri-devel@lists.freedesktop.org>; Wed,  9 Oct 2019 11:31:16 +0000 (UTC)
Received: from pps.filterd (aserp2120.oracle.com [127.0.0.1])
 by aserp2120.oracle.com (8.16.0.27/8.16.0.27) with SMTP id x99BSw5M075660;
 Wed, 9 Oct 2019 11:30:56 GMT
Received: from aserp3030.oracle.com (aserp3030.oracle.com [141.146.126.71])
 by aserp2120.oracle.com with ESMTP id 2vek4qkgr4-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=OK);
 Wed, 09 Oct 2019 11:30:56 +0000
Received: from pps.filterd (aserp3030.oracle.com [127.0.0.1])
 by aserp3030.oracle.com (8.16.0.27/8.16.0.27) with SMTP id x99BNcbg006904;
 Wed, 9 Oct 2019 11:30:55 GMT
Received: from aserv0121.oracle.com (aserv0121.oracle.com [141.146.126.235])
 by aserp3030.oracle.com with ESMTP id 2vh8k0k4f4-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=OK);
 Wed, 09 Oct 2019 11:30:55 +0000
Received: from abhmp0017.oracle.com (abhmp0017.oracle.com [141.146.116.23])
 by aserv0121.oracle.com (8.14.4/8.13.8) with ESMTP id x99BUis4018992;
 Wed, 9 Oct 2019 11:30:44 GMT
Received: from kadam (/41.57.98.10) by default (Oracle Beehive Gateway v4.0)
 with ESMTP ; Wed, 09 Oct 2019 04:30:41 -0700
Date: Wed, 9 Oct 2019 14:30:32 +0300
From: Dan Carpenter <dan.carpenter@oracle.com>
To: Xin Ji <xji@analogixsemi.com>
Subject: Re: [PATCH v2 2/2] drm/bridge: anx7625: Add anx7625 MIPI DSI/DPI to
 DP bridge driver
Message-ID: <20191009113032.GL25098@kadam>
References: <cover.1570588741.git.xji@analogixsemi.com>
 <6ad16e52cd7591d320001a842fc357d976006ef7.1570588741.git.xji@analogixsemi.com>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <6ad16e52cd7591d320001a842fc357d976006ef7.1570588741.git.xji@analogixsemi.com>
User-Agent: Mutt/1.9.4 (2018-02-28)
X-Proofpoint-Virus-Version: vendor=nai engine=6000 definitions=9404
 signatures=668684
X-Proofpoint-Spam-Details: rule=notspam policy=default score=0 suspectscore=2
 malwarescore=0
 phishscore=0 bulkscore=0 spamscore=0 mlxscore=0 mlxlogscore=999
 adultscore=0 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.0.1-1908290000 definitions=main-1910090107
X-Proofpoint-Virus-Version: vendor=nai engine=6000 definitions=9404
 signatures=668684
X-Proofpoint-Spam-Details: rule=notspam policy=default score=0
 priorityscore=1501 malwarescore=0
 suspectscore=2 phishscore=0 bulkscore=0 spamscore=0 clxscore=1011
 lowpriorityscore=0 mlxscore=0 impostorscore=0 mlxlogscore=999 adultscore=0
 classifier=spam adjust=0 reason=mlx scancount=1 engine=8.0.1-1908290000
 definitions=main-1910090108
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=oracle.com; h=date : from : to : cc
 : subject : message-id : references : mime-version : content-type :
 in-reply-to; s=corp-2019-08-05;
 bh=x0t4pz5i6y4fppPA4/GtE2i/uV7NYcnFPjATpiWK+zY=;
 b=Me6J7mMLShhQGhzc3Malz/o2b+TerPB9WGpb1gs1OjJABPmlWRE4uuAcUXHancuo0tZf
 95aHMabKBZTmCiBOSVAzjjbK+zXeFTrZkOGGv+qCP9Vk/sbnZDtpijkMRFKN3/bAtGLB
 en9dQTTO2/O8b2znJGmztmQwda/ym4iZsNFe3hYiD8119ASLV3zqBbOLRHZV63tFsQuB
 RgXQlfflwBrSXuh9x/N8+MYGNYtHiCzHrzCUuMSdTquwfvEbbHtG7Fg8Yab8fo2/2caJ
 GCLmeVkHusirIA3wwP13Hy5GPnQIgcmqBbqg8elcFaaGImUabeGLAAoqnREipoNZ1NUT Vw== 
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: "devel@driverdev.osuosl.org" <devel@driverdev.osuosl.org>,
 Jernej Skrabec <jernej.skrabec@siol.net>,
 Nicolas Boichat <drinkcat@chromium.org>, Jonas Karlman <jonas@kwiboo.se>,
 David Airlie <airlied@linux.ie>, Neil Armstrong <narmstrong@baylibre.com>,
 "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
 "dri-devel@lists.freedesktop.org" <dri-devel@lists.freedesktop.org>,
 Laurent Pinchart <laurent.pinchart@ideasonboard.com>,
 Sheng Pan <span@analogixsemi.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QXJlIHlvdSBzdXJlIHlvdSBzZW50IHRoZSBjb3JyZWN0IHBhdGNoPyAgVGhpcyBoYXMgbWFueSBv
ZiB0aGUgc2FtZQpzdHlsZSBpc3N1ZXMgSSBtZW50aW9uZWQgaW4gdGhlIHByZXZpb3VzIGVtYWls
LiAgVGhlIGVycm9yIGhhbmRsaW5nCmluIGVkaWRfcmVhZCgpIGlzIHdyb25nLiAgcHJvYmUoKSB3
aWxsIHN0aWxsIGNyYXNoIGlmIGFsbG9jYXRpbmcgdGhlCndvcmsgcXVldWUgZmFpbHMuCgpPbiBX
ZWQsIE9jdCAwOSwgMjAxOSBhdCAwOToyODowMkFNICswMDAwLCBYaW4gSmkgd3JvdGU6Cj4gVGhl
IEFOWDc2MjUgaXMgYW4gdWx0cmEtbG93IHBvd2VyIDRLIE1vYmlsZSBIRCBUcmFuc21pdHRlciBk
ZXNpZ25lZAo+IGZvciBwb3J0YWJsZSBkZXZpY2UuIEl0IGNvbnZlcnRzIE1JUEkgRFNJL0RQSSB0
byBEaXNwbGF5UG9ydCAxLjMgNEsuCj4gCj4gVGhlIEFOWDc2MjUgY2FuIHN1cHBvcnQgYm90aCBV
U0IgVHlwZS1DIFBEIGZlYXR1cmUgYW5kIE1JUEkgRFNJL0RQSQo+IHRvIERQIGZlYXR1cmUuIFRo
aXMgZHJpdmVyIG9ubHkgZW5hYmxlZCBNSVBJIERTSS9EUEkgdG8gRFAgZmVhdHVyZS4KPiAKPiBT
aWduZWQtb2ZmLWJ5OiBYaW4gSmkgPHhqaUBhbmFsb2dpeHNlbWkuY29tPgo+IC0tLQo+ICBkcml2
ZXJzL2dwdS9kcm0vYnJpZGdlL01ha2VmaWxlICAgICAgICAgICB8ICAgIDIgKy0KPiAgZHJpdmVy
cy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9LY29uZmlnICAgfCAgICA2ICsKPiAgZHJpdmVycy9n
cHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9NYWtlZmlsZSAgfCAgICAxICsKPiAgZHJpdmVycy9ncHUv
ZHJtL2JyaWRnZS9hbmFsb2dpeC9hbng3NjI1LmMgfCAyMTMyICsrKysrKysrKysrKysrKysrKysr
KysrKysrKysrCj4gIGRyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvYW54NzYyNS5oIHwg
IDQwNSArKysrKysKPiAgNSBmaWxlcyBjaGFuZ2VkLCAyNTQ1IGluc2VydGlvbnMoKyksIDEgZGVs
ZXRpb24oLSkKPiAgY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5h
bG9naXgvYW54NzYyNS5jCj4gIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vYnJp
ZGdlL2FuYWxvZ2l4L2FueDc2MjUuaAo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
YnJpZGdlL01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9NYWtlZmlsZQo+IGluZGV4
IDQ5MzRmY2YuLmJjZDM4OGEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9N
YWtlZmlsZQo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvTWFrZWZpbGUKPiBAQCAtMTIs
OCArMTIsOCBAQCBvYmotJChDT05GSUdfRFJNX1NJSTkyMzQpICs9IHNpaTkyMzQubwo+ICBvYmot
JChDT05GSUdfRFJNX1RISU5FX1RIQzYzTFZEMTAyNCkgKz0gdGhjNjNsdmQxMDI0Lm8KPiAgb2Jq
LSQoQ09ORklHX0RSTV9UT1NISUJBX1RDMzU4NzY0KSArPSB0YzM1ODc2NC5vCj4gIG9iai0kKENP
TkZJR19EUk1fVE9TSElCQV9UQzM1ODc2NykgKz0gdGMzNTg3Njcubwo+IC1vYmotJChDT05GSUdf
RFJNX0FOQUxPR0lYX0RQKSArPSBhbmFsb2dpeC8KPiAgb2JqLSQoQ09ORklHX0RSTV9JMkNfQURW
NzUxMSkgKz0gYWR2NzUxMS8KPiAgb2JqLSQoQ09ORklHX0RSTV9USV9TTjY1RFNJODYpICs9IHRp
LXNuNjVkc2k4Ni5vCj4gIG9iai0kKENPTkZJR19EUk1fVElfVEZQNDEwKSArPSB0aS10ZnA0MTAu
bwo+ICtvYmoteSArPSBhbmFsb2dpeC8KPiAgb2JqLXkgKz0gc3lub3BzeXMvCj4gZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvS2NvbmZpZyBiL2RyaXZlcnMvZ3B1
L2RybS9icmlkZ2UvYW5hbG9naXgvS2NvbmZpZwo+IGluZGV4IGU5MzBmZjkuLmIyZjEyN2UgMTAw
NjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9LY29uZmlnCj4gKysr
IGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9LY29uZmlnCj4gQEAgLTIsMyArMiw5
IEBACj4gIGNvbmZpZyBEUk1fQU5BTE9HSVhfRFAKPiAgCXRyaXN0YXRlCj4gIAlkZXBlbmRzIG9u
IERSTQo+ICsKPiArY29uZmlnIEFOQUxPR0lYX0FOWDc2MjUKPiArCXRyaXN0YXRlICJBbmFsb2dp
eCBNSVBJIHRvIERQIGludGVyZmFjZSBzdXBwb3J0Igo+ICsJaGVscAo+ICsJCUFOWDc2MjUgaXMg
YW4gdWx0cmEtbG93IHBvd2VyIDRLIG1vYmlsZSBIRCB0cmFuc21pdHRlciBkZXNpZ25lZAo+ICsJ
CWZvciBwb3J0YWJsZSBkZXZpY2VzLiBJdCBjb252ZXJ0cyBNSVBJL0RQSSB0byBEaXNwbGF5UG9y
dDEuMyA0Sy4KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9N
YWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvTWFrZWZpbGUKPiBpbmRl
eCBmZGJmM2ZkLi44YTUyODY3IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2Uv
YW5hbG9naXgvTWFrZWZpbGUKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4
L01ha2VmaWxlCj4gQEAgLTEsMyArMSw0IEBACj4gICMgU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6
IEdQTC0yLjAtb25seQo+ICtvYmotJChDT05GSUdfQU5BTE9HSVhfQU5YNzYyNSkgKz0gYW54NzYy
NS5vCj4gIGFuYWxvZ2l4X2RwLW9ianMgOj0gYW5hbG9naXhfZHBfY29yZS5vIGFuYWxvZ2l4X2Rw
X3JlZy5vCj4gIG9iai0kKENPTkZJR19EUk1fQU5BTE9HSVhfRFApICs9IGFuYWxvZ2l4X2RwLm8K
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9hbng3NjI1LmMg
Yi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L2FueDc2MjUuYwo+IG5ldyBmaWxlIG1v
ZGUgMTAwNjQ0Cj4gaW5kZXggMDAwMDAwMC4uN2JiNGUxNwo+IC0tLSAvZGV2L251bGwKPiArKysg
Yi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L2FueDc2MjUuYwo+IEBAIC0wLDAgKzEs
MjEzMiBAQAo+ICsvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5Cj4gKy8q
Cj4gKyAqIENvcHlyaWdodChjKSAyMDE2LCBBbmFsb2dpeCBTZW1pY29uZHVjdG9yLiBBbGwgcmln
aHRzIHJlc2VydmVkLgo+ICsgKgo+ICsgKi8KPiArI2luY2x1ZGUgPGxpbnV4L2V4dGNvbi5oPgo+
ICsjaW5jbHVkZSA8bGludXgvZ2NkLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9ncGlvL2NvbnN1bWVy
Lmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9pMmMuaD4KPiArI2luY2x1ZGUgPGxpbnV4L2ludGVycnVw
dC5oPgo+ICsjaW5jbHVkZSA8bGludXgvaW9wb2xsLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9rZXJu
ZWwuaD4KPiArI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgo+ICsjaW5jbHVkZSA8bGludXgvbXV0
ZXguaD4KPiArI2luY2x1ZGUgPGxpbnV4L3NsYWIuaD4KPiArI2luY2x1ZGUgPGxpbnV4L3R5cGVz
Lmg+Cj4gKyNpbmNsdWRlIDxsaW51eC93b3JrcXVldWUuaD4KPiArCj4gKyNpbmNsdWRlIDxsaW51
eC9vZl9ncGlvLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9vZl9ncmFwaC5oPgo+ICsjaW5jbHVkZSA8
bGludXgvb2ZfcGxhdGZvcm0uaD4KPiArCj4gKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pY19oZWxw
ZXIuaD4KPiArI2luY2x1ZGUgPGRybS9kcm1fYnJpZGdlLmg+Cj4gKyNpbmNsdWRlIDxkcm0vZHJt
X2NydGNfaGVscGVyLmg+Cj4gKyNpbmNsdWRlIDxkcm0vZHJtX2RwX2hlbHBlci5oPgo+ICsjaW5j
bHVkZSA8ZHJtL2RybV9lZGlkLmg+Cj4gKyNpbmNsdWRlIDxkcm0vZHJtX21pcGlfZHNpLmg+Cj4g
KyNpbmNsdWRlIDxkcm0vZHJtX3BhbmVsLmg+Cj4gKyNpbmNsdWRlIDxkcm0vZHJtX3ByaW50Lmg+
Cj4gKyNpbmNsdWRlIDxkcm0vZHJtX3Byb2JlX2hlbHBlci5oPgo+ICsKPiArI2luY2x1ZGUgPHZp
ZGVvL2Rpc3BsYXlfdGltaW5nLmg+Cj4gKwo+ICsjaW5jbHVkZSAiYW54NzYyNS5oIgo+ICsKPiAr
LyoKPiArICogdGhlcmUgaXMgYSBzeW5jIGlzc3VlIHdoaWxlIGFjY2VzcyBJMkMgcmVnaXN0ZXIg
YmV0d2VlbiBBUChDUFUpIGFuZAo+ICsgKiBpbnRlcm5hbCBmaXJtd2FyZShPQ00pLCB0byBhdm9p
ZCB0aGUgcmFjZSBjb25kaXRpb24sIEFQIHNob3VsZCBhY2Nlc3MKPiArICogdGhlIHJlc2VydmVk
IHNsYXZlIGFkZHJlc3MgYmVmb3JlIHNsYXZlIGFkZHJlc3Mgb2NjdXJzIGNoYW5nZXMuCj4gKyAq
Lwo+ICtzdGF0aWMgaW50IGkyY19hY2Nlc3Nfd29ya2Fyb3VuZChzdHJ1Y3QgYW54NzYyNV9kYXRh
ICpjdHgsCj4gKwkJCQkgc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCkKPiArewo+ICsJdTggb2Zm
c2V0Owo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmNsaWVudC0+ZGV2Owo+ICsJc3RydWN0IGky
Y19jbGllbnQgKmxhc3RfY2xpZW50ID0gY3R4LT5sYXN0X2NsaWVudDsKPiArCWludCByZXQgPSAw
Owo+ICsKPiArCWlmIChjbGllbnQgIT0gbGFzdF9jbGllbnQpIHsKCgpQbGVhc2UgcmV2ZXJzZSB0
aGlzIGNvbmRpdGlvbi4KCglpZiAoY2xpZW50ID09IGN0eC0+bGFzdF9jbGllbnQpCgkJcmV0dXJu
IDA7CgpHZXQgcmlkIG9mIHRoZSBsYXN0X2NsaWVudCB2YXJpYWJsZS4KCgo+ICsJCWN0eC0+bGFz
dF9jbGllbnQgPSBjbGllbnQ7Cj4gKwo+ICsJCWlmIChjbGllbnQgPT0gY3R4LT5pMmMudGNwY19j
bGllbnQpCj4gKwkJCW9mZnNldCA9IFJTVkRfMDBfQUREUjsKPiArCQllbHNlIGlmIChjbGllbnQg
PT0gY3R4LT5pMmMudHhfcDBfY2xpZW50KQo+ICsJCQlvZmZzZXQgPSBSU1ZEX0QxX0FERFI7Cj4g
KwkJZWxzZSBpZiAoY2xpZW50ID09IGN0eC0+aTJjLnR4X3AxX2NsaWVudCkKPiArCQkJb2Zmc2V0
ID0gUlNWRF82MF9BRERSOwo+ICsJCWVsc2UgaWYgKGNsaWVudCA9PSBjdHgtPmkyYy5yeF9wMF9j
bGllbnQpCj4gKwkJCW9mZnNldCA9IFJTVkRfMzlfQUREUjsKPiArCQllbHNlIGlmIChjbGllbnQg
PT0gY3R4LT5pMmMucnhfcDFfY2xpZW50KQo+ICsJCQlvZmZzZXQgPSBSU1ZEXzdGX0FERFI7Cj4g
KwkJZWxzZQo+ICsJCQlvZmZzZXQgPSBSU1ZEXzAwX0FERFI7Cj4gKwo+ICsJCXJldCA9IGkyY19z
bWJ1c193cml0ZV9ieXRlX2RhdGEoY2xpZW50LCBvZmZzZXQsIDB4MDApOwo+ICsJCWlmIChyZXQg
PCAwKQo+ICsJCQlEUk1fREVWX0VSUk9SKGRldiwKPiArCQkJCSAgICAgICJmYWlsZWQgdG8gYWNj
ZXNzIGkyYyBpZD0leFxuOiV4IiwKPiArCQkJCSAgICAgIGNsaWVudC0+YWRkciwgb2Zmc2V0KTsK
PiArCX0KPiArCj4gKwlyZXR1cm4gcmV0Owo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGFueDc2MjVf
cmVnX3JlYWQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAo+ICsJCQkgICAgc3RydWN0IGkyY19j
bGllbnQgKmNsaWVudCwgdTggcmVnX2FkZHIpCj4gK3sKPiArCWludCByZXQ7Cj4gKwlzdHJ1Y3Qg
ZGV2aWNlICpkZXYgPSAmY2xpZW50LT5kZXY7Cj4gKwo+ICsJaTJjX2FjY2Vzc193b3JrYXJvdW5k
KGN0eCwgY2xpZW50KTsKPiArCj4gKwlyZXQgPSBpMmNfc21idXNfcmVhZF9ieXRlX2RhdGEoY2xp
ZW50LCByZWdfYWRkcik7Cj4gKwlpZiAocmV0IDwgMCkKPiArCQlEUk1fREVWX0VSUk9SKGRldiwg
InJlYWQgaTJjIGZhaWxlZCBpZD0leDoleFxuIiwKPiArCQkJICAgICAgY2xpZW50LT5hZGRyLCBy
ZWdfYWRkcik7Cj4gKwo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKPiArc3RhdGljIGludCBhbng3
NjI1X3JlZ19ibG9ja19yZWFkKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKPiArCQkJCSAgc3Ry
dWN0IGkyY19jbGllbnQgKmNsaWVudCwKPiArCQkJCSAgdTggcmVnX2FkZHIsIHU4IGxlbiwgdTgg
KmJ1ZikKPiArewo+ICsJaW50IHJldDsKPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjbGllbnQt
PmRldjsKPiArCj4gKwlpMmNfYWNjZXNzX3dvcmthcm91bmQoY3R4LCBjbGllbnQpOwo+ICsKPiAr
CXJldCA9IGkyY19zbWJ1c19yZWFkX2kyY19ibG9ja19kYXRhKGNsaWVudCwgcmVnX2FkZHIsIGxl
biwgYnVmKTsKPiArCWlmIChyZXQgPCAwKQo+ICsJCURSTV9ERVZfRVJST1IoZGV2LCAicmVhZCBp
MmMgYmxvY2sgZmFpbGVkIGlkPSV4OiV4XG4iLAo+ICsJCQkgICAgICBjbGllbnQtPmFkZHIsIHJl
Z19hZGRyKTsKPiArCj4gKwlyZXR1cm4gcmV0Owo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGFueDc2
MjVfcmVnX3dyaXRlKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKPiArCQkJICAgICBzdHJ1Y3Qg
aTJjX2NsaWVudCAqY2xpZW50LAo+ICsJCQkgICAgIHU4IHJlZ19hZGRyLCB1OCByZWdfdmFsKQo+
ICt7Cj4gKwlpbnQgcmV0Owo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmNsaWVudC0+ZGV2Owo+
ICsKPiArCWkyY19hY2Nlc3Nfd29ya2Fyb3VuZChjdHgsIGNsaWVudCk7Cj4gKwo+ICsJcmV0ID0g
aTJjX3NtYnVzX3dyaXRlX2J5dGVfZGF0YShjbGllbnQsIHJlZ19hZGRyLCByZWdfdmFsKTsKPiAr
Cj4gKwlpZiAocmV0IDwgMCkKPiArCQlEUk1fREVWX0VSUk9SKGRldiwgImZhaWxlZCB0byB3cml0
ZSBpMmMgaWQ9JXhcbjoleCIsCj4gKwkJCSAgICAgIGNsaWVudC0+YWRkciwgcmVnX2FkZHIpOwo+
ICsKPiArCXJldHVybiByZXQ7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgYW54NzYyNV93cml0ZV9v
cihzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCj4gKwkJCSAgICBzdHJ1Y3QgaTJjX2NsaWVudCAq
Y2xpZW50LAo+ICsJCQkgICAgdTggb2Zmc2V0LCB1OCBtYXNrKQo+ICt7Cj4gKwlpbnQgdmFsID0g
YW54NzYyNV9yZWdfcmVhZChjdHgsIGNsaWVudCwgb2Zmc2V0KTsKPiArCj4gKwlyZXR1cm4gKHZh
bCA8IDApID8gdmFsIDoKPiArCQlhbng3NjI1X3JlZ193cml0ZShjdHgsIGNsaWVudCwgb2Zmc2V0
LCAodmFsIHwgKG1hc2spKSk7CgoKUGxlYXNlIHdyaXRlIGl0IGxpa2UgdGhpczoKCnN0YXRpYyBp
bnQgYW54NzYyNV93cml0ZV9vcihzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCgkJCSAgICBzdHJ1
Y3QgaTJjX2NsaWVudCAqY2xpZW50LAoJCQkgICAgdTggb2Zmc2V0LCB1OCBtYXNrKQp7CglpbnQg
dmFsOwoKCXZhbCA9IGFueDc2MjVfcmVnX3JlYWQoY3R4LCBjbGllbnQsIG9mZnNldCk7CglpZiAo
dmFsIDwgMCkKCQlyZXR1cm4gdmFsOwoKCXJldHVybiBhbng3NjI1X3JlZ193cml0ZShjdHgsIGNs
aWVudCwgb2Zmc2V0LCAodmFsIHwgKG1hc2spKSk7Cn0KCj4gK30KPiArCj4gK3N0YXRpYyBpbnQg
YW54NzYyNV93cml0ZV9hbmQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAo+ICsJCQkgICAgIHN0
cnVjdCBpMmNfY2xpZW50ICpjbGllbnQsCj4gKwkJCSAgICAgdTggb2Zmc2V0LCB1OCBtYXNrKQo+
ICt7Cj4gKwlpbnQgdmFsID0gYW54NzYyNV9yZWdfcmVhZChjdHgsIGNsaWVudCwgb2Zmc2V0KTsK
PiArCj4gKwlyZXR1cm4gKHZhbCA8IDApID8gdmFsIDoKPiArCQlhbng3NjI1X3JlZ193cml0ZShj
dHgsIGNsaWVudCwgb2Zmc2V0LCAodmFsICYgKG1hc2spKSk7CgpTYW1lLgoKPiArfQo+ICsKPiAr
c3RhdGljIGludCBhbng3NjI1X3dyaXRlX2FuZF9vcihzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgs
Cj4gKwkJCQlzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50LAo+ICsJCQkJdTggb2Zmc2V0LCB1OCBh
bmRfbWFzaywgdTggb3JfbWFzaykKPiArewo+ICsJaW50IHZhbCA9IGFueDc2MjVfcmVnX3JlYWQo
Y3R4LCBjbGllbnQsIG9mZnNldCk7Cj4gKwo+ICsJcmV0dXJuICh2YWwgPCAwKSA/IHZhbCA6Cj4g
KwkJYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjbGllbnQsIG9mZnNldCwKPiArCQkJCSAgKHZhbCAm
IGFuZF9tYXNrKSB8IChvcl9tYXNrKSk7CgpTYW1lLgoKPiArfQo+ICsKPiArc3RhdGljIGludCBh
bng3NjI1X2NvbmZpZ19iaXRfbWF0cml4KHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKPiArewo+
ICsJaW50IGksIHJldDsKPiArCj4gKwlyZXQgPSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+
aTJjLnR4X3AyX2NsaWVudCwKPiArCQkJCUFVRElPX0NPTlRST0xfUkVHSVNURVIsIDB4ODApOwo+
ICsJZm9yIChpID0gMDsgaSA8IDEzOyBpKyspCj4gKwkJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRl
KGN0eCwgY3R4LT5pMmMudHhfcDJfY2xpZW50LAo+ICsJCQkJCSBWSURFT19CSVRfTUFUUklYXzEy
ICsgaSwKPiArCQkJCQkgMHgxOCArIGkpOwo+ICsKPiArCXJldHVybiByZXQ7Cj4gK30KPiArCj4g
K3N0YXRpYyBpbnQgYW54NzYyNV9yZWFkX2N0cmxfc3RhdHVzX3AwKHN0cnVjdCBhbng3NjI1X2Rh
dGEgKmN0eCkKPiArewo+ICsJcmV0dXJuIGFueDc2MjVfcmVnX3JlYWQoY3R4LCBjdHgtPmkyYy5y
eF9wMF9jbGllbnQsIEFQX0FVWF9DVFJMX1NUQVRVUyk7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQg
d2FpdF9hdXhfb3BfZmluaXNoKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKPiArewo+ICsJaW50
IHZhbDsKPiArCWludCByZXQ7Cj4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQt
PmRldjsKPiArCj4gKwlyZXQgPSByZWFkeF9wb2xsX3RpbWVvdXQoYW54NzYyNV9yZWFkX2N0cmxf
c3RhdHVzX3AwLAo+ICsJCQkJIGN0eCwgdmFsLAo+ICsJCQkJICghKHZhbCAmIEFQX0FVWF9DVFJM
X09QX0VOKSB8fCAodmFsIDwgMCkpLAo+ICsJCQkJIDIwMDAsCj4gKwkJCQkgMjAwMCAqIDE1MCk7
Cj4gKwlpZiAocmV0KSB7Cj4gKwkJRFJNX0RFVl9FUlJPUihkZXYsICJhdXggb3BlcmF0aW9uIGZh
aWxlZCFcbiIpOwo+ICsJCXZhbCA9IC1FSU87CgpSZXR1cm4gZGlyZWN0bHkgaGVyZToKCgkJcmV0
dXJuIC1FSU87Cgo+ICsJfSBlbHNlIHsKPiArCQl2YWwgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwg
Y3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ICsJCQkJICAgICAgIEFQX0FVWF9DVFJMX1NUQVRVUyk7
Cj4gKwkJaWYgKHZhbCA8IDAgfHwgKHZhbCAmIDB4MEYpKSB7Cj4gKwkJCURSTV9ERVZfRVJST1Io
ZGV2LCAiYXV4IHN0YXR1cyAlMDJ4XG4iLCB2YWwpOwo+ICsJCQl2YWwgPSAtRUlPOwo+ICsJCX0K
PiArCX0KPiArCj4gKwlyZXR1cm4gdmFsOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHdyaXRlX2Rw
Y2RfYWRkcihzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCj4gKwkJCSAgIHU4IGFkZHJoLCB1OCBh
ZGRybSwgdTggYWRkcmwpCj4gK3sKPiArCWludCByZXQ7Cj4gKwo+ICsJcmV0ID0gYW54NzYyNV9y
ZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4gKwkJCQlBUF9BVVhfQUREUl83
XzAsICh1OClhZGRybCk7Cj4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmky
Yy5yeF9wMF9jbGllbnQsCj4gKwkJCQkgQVBfQVVYX0FERFJfMTVfOCwgKHU4KWFkZHJtKTsKPiAr
CXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiAr
CQkJCSBBUF9BVVhfQUREUl8xOV8xNiwgKHU4KWFkZHJoKTsKPiArCj4gKwlyZXR1cm4gcmV0Owo+
ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHNwX3R4X2F1eF9kcGNkcmVhZF9ieXRlcyhzdHJ1Y3QgYW54
NzYyNV9kYXRhICpjdHgsCj4gKwkJCQkgICAgdTggYWRkcmgsIHU4IGFkZHJtLAo+ICsJCQkJICAg
IHU4IGFkZHJsLCB1OCBjb3VudCwKPiArCQkJCSAgICB1OCAqYnVmKQo+ICt7Cj4gKwl1OCBjOwo+
ICsJaW50IHJldDsKPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+
ICsKPiArCWlmIChXQVJOX09OKGNvdW50ID4gKHNpemVfdClNQVhfRFBDRF9CVUZGRVJfU0laRSkp
CgpObyBuZWVkIGZvciB0aGlzIGNhc3QuCgo+ICsJCXJldHVybiAtRTJCSUc7Cj4gKwo+ICsJLyog
Y29tbWFuZCBhbmQgbGVuZ3RoICovCj4gKwljID0gKChjb3VudCAtIDEpIDw8IDQpIHwgMHgwOTsK
CklmIGNvdW50ID09IDAgdGhpcyB3b3VsZCBjYXVzZSBhIHByb2JsZW0uICBCdXQgY291bnQgaXMg
bmV2ZXIgaW52YWxpZApzbyB0aGF0J3Mgb2theS4KCj4gKwlyZXQgPSBhbng3NjI1X3JlZ193cml0
ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwgQVBfQVVYX0NPTU1BTkQsIGMpOwo+ICsJLyog
YWRkcmVzcyAqLwo+ICsJcmV0IHw9IHdyaXRlX2RwY2RfYWRkcihjdHgsIGFkZHJoLCBhZGRybSwg
YWRkcmwpOwo+ICsJLyogYXV4IGVuICovCj4gKwlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgs
IGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwgQVBfQVVYX0NUUkxfU1RBVFVTLAo+ICsJCQkJQVBfQVVY
X0NUUkxfT1BfRU4pOwo+ICsJaWYgKHJldCA8IDApIHsKPiArCQlEUk1fREVWX0VSUk9SKGRldiwg
ImF1eCBlbmFibGUgZmFpbGVkLlxuIik7Cj4gKwkJcmV0dXJuIHJldDsKPiArCX0KPiArCj4gKwl1
c2xlZXBfcmFuZ2UoMjAwMCwgMjEwMCk7Cj4gKwo+ICsJcmV0ID0gd2FpdF9hdXhfb3BfZmluaXNo
KGN0eCk7Cj4gKwlpZiAocmV0IDwgMCkgewo+ICsJCURSTV9ERVZfRVJST1IoZGV2LCAiYXV4IHJl
YWQgZmFpbGVkXG4iKTsKPiArCQlyZXR1cm4gcmV0Owo+ICsJfQo+ICsKPiArCXJldHVybiBhbng3
NjI1X3JlZ19ibG9ja19yZWFkKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ICsJCQlBUF9B
VVhfQlVGRl9TVEFSVCwgY291bnQsIGJ1Zik7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgYW54NzYy
NV92aWRlb19tdXRlX2NvbnRyb2woc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAo+ICsJCQkJICAg
ICAgdTggc3RhdHVzKQo+ICt7Cj4gKwlpbnQgcmV0Owo+ICsKPiArCWlmIChzdGF0dXMpIHsgLyog
bXV0ZSBvbiAqLwo+ICsJCS8qIHNldCBtdXRlIGZsYWcgKi8KPiArCQlyZXQgPSBhbng3NjI1X3dy
aXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ICsJCQkJICAgICAgIEFQX0FWX1NU
QVRVUywgQVBfTUlQSV9NVVRFKTsKPiArCQkvKiBjbGVhciBtaXBpIFJYIGVuICovCj4gKwkJcmV0
IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ICsJCQkJ
CSBBUF9BVl9TVEFUVVMsICh1OCl+QVBfTUlQSV9SWF9FTik7Cj4gKwl9IGVsc2UgeyAvKiBtdXRl
IG9mZiAqLwo+ICsJCS8qIGNsZWFyIG11dGUgZmxhZyAqLwo+ICsJCXJldCA9IGFueDc2MjVfd3Jp
dGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ICsJCQkJCUFQX0FWX1NUQVRVUywg
KHU4KX5BUF9NSVBJX01VVEUpOwo+ICsJCS8qIHNldCBNSVBJIFJYIEVOICovCj4gKwkJcmV0IHw9
IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4gKwkJCQkJQVBf
QVZfU1RBVFVTLCBBUF9NSVBJX1JYX0VOKTsKPiArCX0KPiArCj4gKwlyZXR1cm4gcmV0Owo+ICt9
Cj4gKwo+ICtzdGF0aWMgaW50IGFueDc2MjVfY29uZmlnX2F1ZGlvX2lucHV0KHN0cnVjdCBhbng3
NjI1X2RhdGEgKmN0eCkKPiArewo+ICsJaW50IHJldDsKPiArCj4gKwkvKiBjaGFubmVsIG51bSAq
Lwo+ICsJcmV0ID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy50eF9wMl9jbGllbnQs
Cj4gKwkJCQlBVURJT19DSEFOTkVMX1NUQVRVU182LCBJMlNfQ0hfMiA8PCA1KTsKPiArCS8qIGxh
eW91dCAqLwo+ICsJLyogYXMgSTJTIGNoYW5uZWwgaXMgMiwgbm8gbmVlZCB0byBzZXQgbGF5b3V0
ICovCj4gKwo+ICsJLyogRlMgKi8KPiArCXJldCB8PSBhbng3NjI1X3dyaXRlX2FuZF9vcihjdHgs
IGN0eC0+aTJjLnR4X3AyX2NsaWVudCwKPiArCQkJCSAgICBBVURJT19DSEFOTkVMX1NUQVRVU180
LAo+ICsJCQkJICAgIDB4ZjAsIEFVRElPX0ZTXzQ4Syk7Cj4gKwkvKiB3b3JkIGxlbmd0aCAqLwo+
ICsJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kX29yKGN0eCwgY3R4LT5pMmMudHhfcDJfY2xpZW50
LAo+ICsJCQkJICAgIEFVRElPX0NIQU5ORUxfU1RBVFVTXzUsCj4gKwkJCQkgICAgMHhmMCwgQVVE
SU9fV19MRU5fMjRfMjRNQVgpOwo+ICsJLyogSTJTICovCj4gKwlyZXQgfD0gYW54NzYyNV93cml0
ZV9vcihjdHgsIGN0eC0+aTJjLnR4X3AyX2NsaWVudCwKPiArCQkJCUFVRElPX0NIQU5ORUxfU1RB
VFVTXzYsIEkyU19TTEFWRV9NT0RFKTsKPiArCXJldCB8PSBhbng3NjI1X3dyaXRlX2FuZChjdHgs
IGN0eC0+aTJjLnR4X3AyX2NsaWVudCwKPiArCQkJCSBBVURJT19DT05UUk9MX1JFR0lTVEVSLCB+
VERNX1RJTUlOR19NT0RFKTsKPiArCS8qIGF1ZGlvIGNoYW5nZSBmbGFnICovCj4gKwlyZXQgfD0g
YW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiArCQkJCUFQX0FW
X1NUQVRVUywgQVBfQVVESU9fQ0hHKTsKPiArCj4gKwlpZiAocmV0IDwgMCkKPiArCQlEUk1fRVJS
T1IoImZhaWxlZCB0byBjb25maWcgYXVkaW8uXG4iKTsKPiArCj4gKwlyZXR1cm4gcmV0Owo+ICt9
Cj4gKwo+ICsvKiByZWR1Y3Rpb24gb2YgZnJhY3Rpb24gYS9iICovCj4gK3N0YXRpYyB2b2lkIGFu
eDc2MjVfcmVkdWN0aW9uX29mX2FfZnJhY3Rpb24odW5zaWduZWQgbG9uZyAqYSwgdW5zaWduZWQg
bG9uZyAqYikKPiArewo+ICsJdW5zaWduZWQgbG9uZyBnY2RfbnVtOwo+ICsJdW5zaWduZWQgbG9u
ZyB0bXBfYSwgdG1wX2I7Cj4gKwl1MzIgaSA9IDE7Cj4gKwo+ICsJZ2NkX251bSA9IGdjZCgqYSwg
KmIpOwo+ICsJKmEgLz0gZ2NkX251bTsKPiArCSpiIC89IGdjZF9udW07Cj4gKwo+ICsJdG1wX2Eg
PSAqYTsKPiArCXRtcF9iID0gKmI7Cj4gKwo+ICsJd2hpbGUgKCgqYSA+IE1BWF9VTlNJR05FRF8y
NEJJVCkgfHwgKCpiID4gTUFYX1VOU0lHTkVEXzI0QklUKSkgewo+ICsJCWkrKzsKPiArCQkqYSA9
IHRtcF9hIC8gaTsKPiArCQkqYiA9IHRtcF9iIC8gaTsKPiArCX0KPiArCj4gKwkvKgo+ICsJICog
aW4gdGhlIGVuZCwgbWFrZSBhLCBiIGxhcmdlciB0byBoYXZlIGhpZ2hlciBPREZDIFBMTAo+ICsJ
ICogb3V0cHV0IGZyZXF1ZW5jeSBhY2N1cmFjeQo+ICsJICovCj4gKwl3aGlsZSAoKCphIDwgTUFY
X1VOU0lHTkVEXzI0QklUKSAmJiAoKmIgPCBNQVhfVU5TSUdORURfMjRCSVQpKSB7Cj4gKwkJKmEg
PDw9IDE7Cj4gKwkJKmIgPDw9IDE7Cj4gKwl9Cj4gKwo+ICsJKmEgPj49IDE7Cj4gKwkqYiA+Pj0g
MTsKPiArfQo+ICsKPiArc3RhdGljIGludCBhbng3NjI1X2NhbGN1bGF0ZV9tX24odTMyIHBpeGVs
Y2xvY2ssCj4gKwkJCQkgdW5zaWduZWQgbG9uZyAqbSwKPiArCQkJCSB1bnNpZ25lZCBsb25nICpu
LAo+ICsJCQkJIHU4ICpwb3N0X2RpdmlkZXIpCj4gK3sKPiArCWlmIChwaXhlbGNsb2NrID4gUExM
X09VVF9GUkVRX0FCU19NQVggLyBQT1NUX0RJVklERVJfTUlOKSB7Cj4gKwkJLyogcGl4ZWwgY2xv
Y2sgZnJlcXVlbmN5IGlzIHRvbyBoaWdoICovCj4gKwkJRFJNX0VSUk9SKCJwaXhlbGNsb2NrIHRv
byBoaWdoLCBhY3QoJWQpLCBtYXhpbXVtKCVsdSlcbiIsCj4gKwkJCSAgcGl4ZWxjbG9jaywKPiAr
CQkJICBQTExfT1VUX0ZSRVFfQUJTX01BWCAvIFBPU1RfRElWSURFUl9NSU4pOwo+ICsJCXJldHVy
biAtRURPTTsKCldoeSAtRURPTSBpbnN0ZWFkIG9mIC1FSU5WQUw/Cgo+ICsJfQo+ICsKPiArCWlm
IChwaXhlbGNsb2NrIDwgUExMX09VVF9GUkVRX0FCU19NSU4gLyBQT1NUX0RJVklERVJfTUFYKSB7
Cj4gKwkJLyogcGl4ZWwgY2xvY2sgZnJlcXVlbmN5IGlzIHRvbyBsb3cgKi8KPiArCQlEUk1fRVJS
T1IoInBpeGVsY2xvY2sgdG9vIGxvdywgYWN0KCVkKSwgbWF4aW11bSglbHUpXG4iLAo+ICsJCQkg
IHBpeGVsY2xvY2ssCj4gKwkJCSAgUExMX09VVF9GUkVRX0FCU19NSU4gLyBQT1NUX0RJVklERVJf
TUFYKTsKPiArCQlyZXR1cm4gLUVET007Cj4gKwl9Cj4gKwo+ICsJKnBvc3RfZGl2aWRlciA9IDE7
CiAgICAgICAgXl5eXl5eXl5eXl5eXl5eXl4KRGVsZXRlLgoKPiArCj4gKwlmb3IgKCpwb3N0X2Rp
dmlkZXIgPSAxOwogICAgICAgICAgICAgXl5eXl5eXl5eXl5eXl5eXl4KRHVwbGljYXRlLgoKPiAr
CQlwaXhlbGNsb2NrIDwgKFBMTF9PVVRfRlJFUV9NSU4gLyAoKnBvc3RfZGl2aWRlcikpOykKPiAr
CQkqcG9zdF9kaXZpZGVyICs9IDE7Cj4gKwo+ICsJaWYgKCpwb3N0X2RpdmlkZXIgPiBQT1NUX0RJ
VklERVJfTUFYKSB7Cj4gKwkJZm9yICgqcG9zdF9kaXZpZGVyID0gMTsKPiArCQkJKHBpeGVsY2xv
Y2sgPAo+ICsJCQkgKFBMTF9PVVRfRlJFUV9BQlNfTUlOIC8gKCpwb3N0X2RpdmlkZXIpKSk7KQo+
ICsJCQkqcG9zdF9kaXZpZGVyICs9IDE7Cj4gKwo+ICsJCWlmICgqcG9zdF9kaXZpZGVyID4gUE9T
VF9ESVZJREVSX01BWCkgewo+ICsJCQlEUk1fRVJST1IoImNhbm5vdCBmaW5kIHByb3BlcnR5IHBv
c3RfZGl2aWRlciglZClcbiIsCj4gKwkJCQkgICpwb3N0X2RpdmlkZXIpOwo+ICsJCQlyZXR1cm4g
LUVET007Cj4gKwkJfQo+ICsJfQo+ICsKPiArCS8qIHBhdGNoIHRvIGltcHJvdmUgdGhlIGFjY3Vy
YWN5ICovCj4gKwlpZiAoKnBvc3RfZGl2aWRlciA9PSA3KSB7Cj4gKwkJLyogMjcsMDAwLDAwMCBp
cyBub3QgZGl2aXNpYmxlIGJ5IDcgKi8KPiArCQkqcG9zdF9kaXZpZGVyID0gODsKPiArCX0gZWxz
ZSBpZiAoKnBvc3RfZGl2aWRlciA9PSAxMSkgewo+ICsJCS8qIDI3LDAwMCwwMDAgaXMgbm90IGRp
dmlzaWJsZSBieSAxMSAqLwo+ICsJCSpwb3N0X2RpdmlkZXIgPSAxMjsKPiArCX0gZWxzZSBpZiAo
KCpwb3N0X2RpdmlkZXIgPT0gMTMpIHx8ICgqcG9zdF9kaXZpZGVyID09IDE0KSkgewo+ICsJCS8q
MjcsMDAwLDAwMCBpcyBub3QgZGl2aXNpYmxlIGJ5IDEzIG9yIDE0Ki8KPiArCQkqcG9zdF9kaXZp
ZGVyID0gMTU7Cj4gKwl9Cj4gKwo+ICsJaWYgKHBpeGVsY2xvY2sgKiAoKnBvc3RfZGl2aWRlcikg
PiBQTExfT1VUX0ZSRVFfQUJTX01BWCkgewo+ICsJCURSTV9FUlJPUigiYWN0IGNsb2NrKCV1KSBs
YXJnZSB0aGFuIG1heGltdW0oJWx1KVxuIiwKPiArCQkJICBwaXhlbGNsb2NrICogKCpwb3N0X2Rp
dmlkZXIpLAo+ICsJCQkgIFBMTF9PVVRfRlJFUV9BQlNfTUFYKTsKPiArCQlyZXR1cm4gLUVET007
Cj4gKwl9Cj4gKwo+ICsJKm0gPSBwaXhlbGNsb2NrOwo+ICsJKm4gPSBYVEFMX0ZSUSAvICgqcG9z
dF9kaXZpZGVyKTsKPiArCj4gKwlhbng3NjI1X3JlZHVjdGlvbl9vZl9hX2ZyYWN0aW9uKG0sIG4p
Owo+ICsKPiArCXJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGFueDc2MjVfb2RmY19j
b25maWcoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAo+ICsJCQkgICAgICAgdTggcG9zdF9kaXZp
ZGVyKQo+ICt7Cj4gKwlpbnQgcmV0Owo+ICsKPiArCS8qIGNvbmZpZyBpbnB1dCByZWZlcmVuY2Ug
Y2xvY2sgZnJlcXVlbmN5IDI3TUh6LzE5LjJNSHogKi8KPiArCXJldCA9IGFueDc2MjVfd3JpdGVf
YW5kKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCBNSVBJX0RJR0lUQUxfUExMXzE2LAo+ICsJ
CQkJfihSRUZfQ0xLXzI3MDAwS0haIDw8IE1JUElfRlJFRl9EX0lORCkpOwo+ICsJcmV0IHw9IGFu
eDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIE1JUElfRElHSVRBTF9Q
TExfMTYsCj4gKwkJCQkoUkVGX0NMS18yNzAwMEtIWiA8PCBNSVBJX0ZSRUZfRF9JTkQpKTsKPiAr
CS8qIHBvc3QgZGl2aWRlciAqLwo+ICsJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4
LT5pMmMucnhfcDFfY2xpZW50LAo+ICsJCQkJIE1JUElfRElHSVRBTF9QTExfOCwgMHgwZik7Cj4g
KwlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQ
SV9ESUdJVEFMX1BMTF84LAo+ICsJCQkJcG9zdF9kaXZpZGVyIDw8IDQpOwo+ICsKPiArCS8qIGFk
ZCBwYXRjaCBmb3IgTUlTMi0xMjUgKDVwY3MgQU5YNzYyNSBmYWlsIEFURSBNQklTVCB0ZXN0KSAq
Lwo+ICsJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50
LCBNSVBJX0RJR0lUQUxfUExMXzcsCj4gKwkJCQkgfk1JUElfUExMX1ZDT19UVU5FX1JFR19WQUwp
Owo+ICsKPiArCS8qIHJlc2V0IE9ERkMgUExMICovCj4gKwlyZXQgfD0gYW54NzYyNV93cml0ZV9h
bmQoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIE1JUElfRElHSVRBTF9QTExfNywKPiArCQkJ
CSB+TUlQSV9QTExfUkVTRVRfTik7Cj4gKwlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0
eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9ESUdJVEFMX1BMTF83LAo+ICsJCQkJTUlQSV9QTExf
UkVTRVRfTik7Cj4gKwo+ICsJaWYgKHJldCA8IDApCj4gKwkJRFJNX0VSUk9SKCJJTyBlcnJvci5c
biIpOwo+ICsKPiArCXJldHVybiByZXQ7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgYW54NzYyNV9k
c2lfdmlkZW9fdGltaW5nX2NvbmZpZyhzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gK3sKPiAr
CXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ICsJdW5zaWduZWQgbG9u
ZyBtLCBuOwo+ICsJdTE2IGh0b3RhbDsKPiArCWludCByZXQ7Cj4gKwl1OCBwb3N0X2RpdmlkZXIg
PSAwOwo+ICsKPiArCXJldCA9IGFueDc2MjVfY2FsY3VsYXRlX21fbihjdHgtPmR0LnBpeGVsY2xv
Y2subWluICogMTAwMCwKPiArCQkJCSAgICAmbSwgJm4sICZwb3N0X2RpdmlkZXIpOwo+ICsKPiAr
CWlmIChyZXQgIT0gMCkgewoKaWYgKHJldCkgewoKPiArCQlEUk1fRVJST1IoImNhbm5vdCBnZXQg
cHJvcGVydHkgbSBuIHZhbHVlLlxuIik7Cj4gKwkJcmV0dXJuIC1FSU5WQUw7Cj4gKwl9Cj4gKwo+
ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiY29tcHV0ZSBNKCVsdSksIE4oJWx1KSwgZGl2
aWRlciglZCkuXG4iLAo+ICsJCQkgICAgIG0sIG4sIHBvc3RfZGl2aWRlcik7Cj4gKwo+ICsJLyog
Y29uZmlndXJlIHBpeGVsIGNsb2NrICovCj4gKwlyZXQgPSBhbng3NjI1X3JlZ193cml0ZShjdHgs
IGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwgUElYRUxfQ0xPQ0tfTCwKPiArCQkJCShjdHgtPmR0LnBp
eGVsY2xvY2subWluIC8gMTAwMCkgJiAweEZGKTsKPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0
ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwgUElYRUxfQ0xPQ0tfSCwKPiArCQkJCSAoY3R4
LT5kdC5waXhlbGNsb2NrLm1pbiAvIDEwMDApID4+IDgpOwo+ICsJLyogbGFuZSBjb3VudCAqLwo+
ICsJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAo+
ICsJCQlNSVBJX0xBTkVfQ1RSTF8wLCAweGZjKTsKPiArCXJldCB8PSBhbng3NjI1X3dyaXRlX29y
KGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAo+ICsJCQkJTUlQSV9MQU5FX0NUUkxfMCwgMyk7
Cj4gKwo+ICsJLyogSHRvdGFsICovCj4gKwlodG90YWwgPSBjdHgtPmR0LmhhY3RpdmUubWluICsg
Y3R4LT5kdC5oZnJvbnRfcG9yY2gubWluICsKPiArCQljdHgtPmR0LmhiYWNrX3BvcmNoLm1pbiAr
IGN0eC0+ZHQuaHN5bmNfbGVuLm1pbjsKPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgs
IGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwKPiArCQkJSE9SSVpPTlRBTF9UT1RBTF9QSVhFTFNfTCwg
aHRvdGFsICYgMHhGRik7Cj4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmky
Yy5yeF9wMl9jbGllbnQsCj4gKwkJCUhPUklaT05UQUxfVE9UQUxfUElYRUxTX0gsIGh0b3RhbCA+
PiA4KTsKPiArCS8qIEhhY3RpdmUgKi8KPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgs
IGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwKPiArCQkJSE9SSVpPTlRBTF9BQ1RJVkVfUElYRUxTX0ws
IGN0eC0+ZHQuaGFjdGl2ZS5taW4gJiAweEZGKTsKPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0
ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwKPiArCQkJSE9SSVpPTlRBTF9BQ1RJVkVfUElY
RUxTX0gsIGN0eC0+ZHQuaGFjdGl2ZS5taW4gPj4gOCk7Cj4gKwkvKiBIRlAgKi8KPiArCXJldCB8
PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwKPiArCQkJSE9S
SVpPTlRBTF9GUk9OVF9QT1JDSF9MLCBjdHgtPmR0Lmhmcm9udF9wb3JjaC5taW4pOwo+ICsJcmV0
IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAo+ICsJCQlI
T1JJWk9OVEFMX0ZST05UX1BPUkNIX0gsCj4gKwkJCWN0eC0+ZHQuaGZyb250X3BvcmNoLm1pbiA+
PiA4KTsKPiArCS8qIEhXUyAqLwo+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4
LT5pMmMucnhfcDJfY2xpZW50LAo+ICsJCQlIT1JJWk9OVEFMX1NZTkNfV0lEVEhfTCwgY3R4LT5k
dC5oc3luY19sZW4ubWluKTsKPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+
aTJjLnJ4X3AyX2NsaWVudCwKPiArCQkJSE9SSVpPTlRBTF9TWU5DX1dJRFRIX0gsIGN0eC0+ZHQu
aHN5bmNfbGVuLm1pbiA+PiA4KTsKPiArCS8qIEhCUCAqLwo+ICsJcmV0IHw9IGFueDc2MjVfcmVn
X3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAo+ICsJCQlIT1JJWk9OVEFMX0JBQ0tf
UE9SQ0hfTCwgY3R4LT5kdC5oYmFja19wb3JjaC5taW4pOwo+ICsJcmV0IHw9IGFueDc2MjVfcmVn
X3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAo+ICsJCQlIT1JJWk9OVEFMX0JBQ0tf
UE9SQ0hfSCwgY3R4LT5kdC5oYmFja19wb3JjaC5taW4gPj4gOCk7Cj4gKwkvKiBWYWN0aXZlICov
Cj4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQs
IEFDVElWRV9MSU5FU19MLAo+ICsJCQljdHgtPmR0LnZhY3RpdmUubWluKTsKPiArCXJldCB8PSBh
bng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwgQUNUSVZFX0xJTkVT
X0gsCj4gKwkJCWN0eC0+ZHQudmFjdGl2ZS5taW4gPj4gOCk7Cj4gKwkvKiBWRlAgKi8KPiArCXJl
dCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwKPiArCQkJ
VkVSVElDQUxfRlJPTlRfUE9SQ0gsIGN0eC0+ZHQudmZyb250X3BvcmNoLm1pbik7Cj4gKwkvKiBW
V1MgKi8KPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2Ns
aWVudCwKPiArCQkJVkVSVElDQUxfU1lOQ19XSURUSCwgY3R4LT5kdC52c3luY19sZW4ubWluKTsK
PiArCS8qIFZCUCAqLwo+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMu
cnhfcDJfY2xpZW50LAo+ICsJCQlWRVJUSUNBTF9CQUNLX1BPUkNILCBjdHgtPmR0LnZiYWNrX3Bv
cmNoLm1pbik7Cj4gKwkvKiBNIHZhbHVlICovCj4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUo
Y3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCj4gKwkJCU1JUElfUExMX01fTlVNXzIzXzE2LCAo
bSA+PiAxNikgJiAweGZmKTsKPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+
aTJjLnJ4X3AxX2NsaWVudCwKPiArCQkJTUlQSV9QTExfTV9OVU1fMTVfOCwgKG0gPj4gOCkgJiAw
eGZmKTsKPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2Ns
aWVudCwKPiArCQkJTUlQSV9QTExfTV9OVU1fN18wLCAobSAmIDB4ZmYpKTsKPiArCS8qIE4gdmFs
dWUgKi8KPiArCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2Ns
aWVudCwKPiArCQkJTUlQSV9QTExfTl9OVU1fMjNfMTYsIChuID4+IDE2KSAmIDB4ZmYpOwo+ICsJ
cmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAo+ICsJ
CQlNSVBJX1BMTF9OX05VTV8xNV84LCAobiA+PiA4KSAmIDB4ZmYpOwo+ICsJcmV0IHw9IGFueDc2
MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCBNSVBJX1BMTF9OX05VTV83
XzAsCj4gKwkJCShuICYgMHhmZikpOwo+ICsJLyogZGlmZiAqLwo+ICsJcmV0IHw9IGFueDc2MjVf
cmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAo+ICsJCQlNSVBJX0RJR0lUQUxf
QURKXzEsIDB4MzcpOwo+ICsKPiArCXJldCB8PSBhbng3NjI1X29kZmNfY29uZmlnKGN0eCwgcG9z
dF9kaXZpZGVyIC0gMSk7Cj4gKwo+ICsJaWYgKHJldCA8IDApCj4gKwkJRFJNX0VSUk9SKCJtaXBp
IGRzaSBzZXR1cCBJTyBlcnJvci5cbiIpOwo+ICsKPiArCXJldHVybiByZXQ7Cj4gK30KPiArCj4g
K3N0YXRpYyBpbnQgYW54NzYyNV9zd2FwX2RzaV9sYW5lMyhzdHJ1Y3QgYW54NzYyNV9kYXRhICpj
dHgpCj4gK3sKPiArCWludCB2YWw7Cj4gKwo+ICsJLyogc3dhcCBNSVBJLURTSSBkYXRhIGxhbmUg
MyBQIGFuZCBOICovCj4gKwl2YWwgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY3R4LT5pMmMucnhf
cDFfY2xpZW50LCBNSVBJX1NXQVApOwo+ICsJaWYgKHZhbCA8IDApIHsKPiArCQlEUk1fRVJST1Io
IklPIGVycm9yIDogYWNjZXNzIE1JUElfU1dBUC5cbiIpOwo+ICsJCXJldHVybiAtRUlPOwo+ICsJ
fQo+ICsKPiArCXZhbCB8PSAoMSA8PCBNSVBJX1NXQVBfQ0gzKTsKPiArCXJldHVybiBhbng3NjI1
X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9TV0FQLCB2YWwpOwo+
ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGFueDc2MjVfYXBpX2RzaV9jb25maWcoc3RydWN0IGFueDc2
MjVfZGF0YSAqY3R4KQo+ICsKPiArewo+ICsJaW50IHZhbCwgcmV0Owo+ICsKPiArCS8qIHN3YXAg
TUlQSS1EU0kgZGF0YSBsYW5lIDMgUCBhbmQgTiAqLwo+ICsJcmV0ID0gYW54NzYyNV9zd2FwX2Rz
aV9sYW5lMyhjdHgpOwo+ICsJaWYgKHJldCA8IDApIHsKPiArCQlEUk1fRVJST1IoIklPIGVycm9y
IDogc3dhcCBkc2kgbGFuZSAzIGZhaWxlZC5cbiIpOwo+ICsJCXJldHVybiByZXQ7Cj4gKwl9Cj4g
Kwo+ICsJLyogRFNJIGNsb2NrIHNldHRpbmdzICovCj4gKwl2YWwgPSAoMCA8PCBNSVBJX0hTX1BX
RF9DTEspCQl8Cj4gKwkJKDAgPDwgTUlQSV9IU19SVF9DTEspCQl8Cj4gKwkJKDAgPDwgTUlQSV9Q
RF9DTEspCQl8Cj4gKwkJKDEgPDwgTUlQSV9DTEtfUlRfTUFOVUFMX1BEX0VOKQl8Cj4gKwkJKDEg
PDwgTUlQSV9DTEtfSFNfTUFOVUFMX1BEX0VOKQl8Cj4gKwkJKDAgPDwgTUlQSV9DTEtfREVUX0RF
VF9CWVBBU1MpCXwKPiArCQkoMCA8PCBNSVBJX0NMS19NSVNTX0NUUkwpCXwKPiArCQkoMCA8PCBN
SVBJX1BEX0xQVFhfQ0hfTUFOVUFMX1BEX0VOKTsKPiArCXJldCA9IGFueDc2MjVfcmVnX3dyaXRl
KGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAo+ICsJCQkJTUlQSV9QSFlfQ09OVFJPTF8zLCB2
YWwpOwo+ICsKPiArCS8qCj4gKwkgKiBEZWNyZWFzZWQgSFMgcHJlcGFyZSB0aW1pbmcgZGVsYXkg
ZnJvbSAxNjBucyB0byA4MG5zIHdvcmsgd2l0aAo+ICsJICogICAgIGEpIERyYWdvbiBib2FyZCA4
MTAgc2VyaWVzIChRdWFsY29tbSBBUCkKPiArCSAqICAgICBiKSBNb3ZpbmcgUGl4ZWwgRFNJIHNv
dXJjZSAoUEczQSBwYXR0ZXJuIGdlbmVyYXRvciArCj4gKwkgKglQMzMyIEQtUEhZIFByb2JlKSBk
ZWZhdWx0IEQtUEhZIHRpbWluZwo+ICsJICoJNW5zL3N0ZXAKPiArCSAqLwo+ICsJcmV0IHw9IGFu
eDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAo+ICsJCQkJIE1JUElf
VElNRV9IU19QUlBSLCAweDEwKTsKPiArCj4gKwkvKiBlbmFibGUgRFNJIG1vZGUqLwo+ICsJcmV0
IHw9IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIE1JUElfRElH
SVRBTF9QTExfMTgsCj4gKwkJCQlTRUxFQ1RfRFNJIDw8IE1JUElfRFBJX1NFTEVDVCk7Cj4gKwo+
ICsJcmV0IHw9IGFueDc2MjVfZHNpX3ZpZGVvX3RpbWluZ19jb25maWcoY3R4KTsKPiArCWlmIChy
ZXQgPCAwKSB7Cj4gKwkJRFJNX0VSUk9SKCJkc2kgdmlkZW8gdGltaW5nIGNvbmZpZyBmYWlsZWRc
biIpOwo+ICsJCXJldHVybiByZXQ7Cj4gKwl9Cj4gKwo+ICsJLyogdG9nZ2xlIG0sIG4gcmVhZHkg
Ki8KPiArCXJldCA9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50
LCBNSVBJX0RJR0lUQUxfUExMXzYsCj4gKwkJCQl+KE1JUElfTV9OVU1fUkVBRFkgfCBNSVBJX05f
TlVNX1JFQURZKSk7Cj4gKwl1c2xlZXBfcmFuZ2UoMTAwMCwgMTEwMCk7Cj4gKwlyZXQgfD0gYW54
NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9ESUdJVEFMX1BM
TF82LAo+ICsJCQkJTUlQSV9NX05VTV9SRUFEWSB8IE1JUElfTl9OVU1fUkVBRFkpOwo+ICsKPiAr
CS8qIGNvbmZpZ3VyZSBpbnRlZ2VyIHN0YWJsZSByZWdpc3RlciAqLwo+ICsJcmV0IHw9IGFueDc2
MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAo+ICsJCQkJIE1JUElfVklE
RU9fU1RBQkxFX0NOVCwgMHgwMik7Cj4gKwkvKiBwb3dlciBvbiBNSVBJIFJYICovCj4gKwlyZXQg
fD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCj4gKwkJCQkg
TUlQSV9MQU5FX0NUUkxfMTAsIDB4MDApOwo+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0
eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAo+ICsJCQkJIE1JUElfTEFORV9DVFJMXzEwLCAweDgw
KTsKPiArCj4gKwlpZiAocmV0IDwgMCkKPiArCQlEUk1fRVJST1IoIklPIGVycm9yIDogbWlwaSBk
c2kgZW5hYmxlIGluaXQgZmFpbGVkLlxuIik7Cj4gKwo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsK
PiArc3RhdGljIGludCBhbng3NjI1X2RzaV9jb25maWcoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4
KQo+ICt7Cj4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKPiArCWlu
dCByZXQ7Cj4gKwo+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiY29uZmlnIGRzaS5cbiIp
Owo+ICsKPiArCS8qIERTQyBkaXNhYmxlICovCj4gKwlyZXQgPSBhbng3NjI1X3dyaXRlX2FuZChj
dHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiArCQkJCVJfRFNDX0NUUkxfMCwgfkRTQ19FTik7
Cj4gKwo+ICsJcmV0IHw9IGFueDc2MjVfYXBpX2RzaV9jb25maWcoY3R4KTsKPiArCj4gKwlpZiAo
cmV0IDwgMCkgewo+ICsJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBhcGkgZHNpIGNvbmZpZyBlcnJv
ci5cbiIpOwoKcmV0dXJuIHJldDsKCj4gKwl9IGVsc2Ugewo+ICsJCS8qIHNldCBNSVBJIFJYIEVO
ICovCj4gKwkJcmV0ID0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVu
dCwKPiArCQkJCSAgICAgICBBUF9BVl9TVEFUVVMsIEFQX01JUElfUlhfRU4pOwo+ICsJCS8qIGNs
ZWFyIG11dGUgZmxhZyAqLwo+ICsJCXJldCB8PSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+
aTJjLnJ4X3AwX2NsaWVudCwKPiArCQkJCQkgQVBfQVZfU1RBVFVTLCAodTgpfkFQX01JUElfTVVU
RSk7Cj4gKwkJaWYgKHJldCA8IDApCj4gKwkJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBlbmFibGUg
bWlwaSByeCBmYWlsZWQuXG4iKTsKPiArCQllbHNlCj4gKwkJCURSTV9ERVZfREVCVUdfRFJJVkVS
KGRldiwgInN1Y2Nlc3MgdG8gY29uZmlnIERTSVxuIik7Cj4gKwl9Cj4gKwo+ICsJcmV0dXJuIHJl
dDsKPiArfQo+ICsKPiArc3RhdGljIGludCBhbng3NjI1X2FwaV9kcGlfY29uZmlnKHN0cnVjdCBh
bng3NjI1X2RhdGEgKmN0eCkKPiArewo+ICsJdTE2IGZyZXEgPSBjdHgtPmR0LnBpeGVsY2xvY2su
bWluIC8gMTAwMDsKPiArCWludCByZXQ7Cj4gKwo+ICsJLyogY29uZmlndXJlIHBpeGVsIGNsb2Nr
ICovCj4gKwlyZXQgPSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVu
dCwKPiArCQkJCVBJWEVMX0NMT0NLX0wsIGZyZXEgJiAweEZGKTsKPiArCXJldCB8PSBhbng3NjI1
X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiArCQkJCSBQSVhFTF9DTE9D
S19ILCAoZnJlcSA+PiA4KSk7Cj4gKwo+ICsJLyogc2V0IERQSSBtb2RlICovCj4gKwkvKiBzZXQg
dG8gRFBJIFBMTCBtb2R1bGUgc2VsICovCj4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4
LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCj4gKwkJCQkgTUlQSV9ESUdJVEFMX1BMTF85LCAweDIw
KTsKPiArCS8qIHBvd2VyIGRvd24gTUlQSSAqLwo+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRl
KGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAo+ICsJCQkJIE1JUElfTEFORV9DVFJMXzEwLCAw
eDA4KTsKPiArCS8qIGVuYWJsZSBEUEkgbW9kZSAqLwo+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dy
aXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAo+ICsJCQkJIE1JUElfRElHSVRBTF9QTExf
MTgsIDB4MUMpOwo+ICsJLyogc2V0IGZpcnN0IGVkZ2UgKi8KPiArCXJldCB8PSBhbng3NjI1X3Jl
Z193cml0ZShjdHgsIGN0eC0+aTJjLnR4X3AyX2NsaWVudCwKPiArCQkJCSBWSURFT19DT05UUk9M
XzAsIDB4MDUpOwo+ICsJaWYgKHJldCA8IDApCj4gKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGRw
aSBwaHkgc2V0IGZhaWxlZC5cbiIpOwo+ICsKPiArCXJldHVybiByZXQ7Cj4gK30KPiArCj4gK3N0
YXRpYyBpbnQgYW54NzYyNV9kcGlfY29uZmlnKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKPiAr
ewo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7Cj4gKwlpbnQgcmV0
Owo+ICsKPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImNvbmZpZyBkcGlcbiIpOwo+ICsK
PiArCS8qIERTQyBkaXNhYmxlICovCj4gKwlyZXQgPSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0
eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiArCQkJCVJfRFNDX0NUUkxfMCwgfkRTQ19FTik7Cj4gKwlp
ZiAocmV0IDwgMCkgewo+ICsJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBkaXNhYmxlIGRzYyBmYWls
ZWQuXG4iKTsKPiArCQlyZXR1cm4gcmV0Owo+ICsJfQo+ICsKPiArCXJldCA9IGFueDc2MjVfY29u
ZmlnX2JpdF9tYXRyaXgoY3R4KTsKPiArCWlmIChyZXQgPCAwKSB7Cj4gKwkJRFJNX0VSUk9SKCJj
b25maWcgYml0IG1hdHJpeCBmYWlsZWQuXG4iKTsKPiArCQlyZXR1cm4gcmV0Owo+ICsJfQo+ICsK
PiArCXJldCA9IGFueDc2MjVfYXBpX2RwaV9jb25maWcoY3R4KTsKPiArCWlmIChyZXQgPCAwKSB7
Cj4gKwkJRFJNX0VSUk9SKCJtaXBpIHBoeShkcGkpIHNldHVwIGZhaWxlZC5cbiIpOwo+ICsJCXJl
dHVybiByZXQ7Cj4gKwl9Cj4gKwo+ICsJLyogc2V0IE1JUEkgUlggRU4gKi8KPiArCXJldCA9IGFu
eDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4gKwkJCSAgICAgICBB
UF9BVl9TVEFUVVMsIEFQX01JUElfUlhfRU4pOwo+ICsJLyogY2xlYXIgbXV0ZSBmbGFnICovCj4g
KwlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4g
KwkJCQkgQVBfQVZfU1RBVFVTLCAodTgpfkFQX01JUElfTVVURSk7Cj4gKwlpZiAocmV0IDwgMCkK
PiArCQlEUk1fRVJST1IoIklPIGVycm9yIDogZW5hYmxlIG1pcGkgcnggZmFpbGVkLlxuIik7Cj4g
Kwo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKPiArY29uc3QgdTggQU5YX09VSVszXSA9IHsgMHgw
MCwgMHgyMiwgMHhCOSB9Owo+ICtzdGF0aWMgaW50IGlzX2FueF9kb25nbGUoc3RydWN0IGFueDc2
MjVfZGF0YSAqY3R4KQo+ICt7Cj4gKwl1OCBidWZbM107Cj4gKwo+ICsJLyogMHgwNTAwfjB4MDUw
MjogQlJBTkNIX0lFRUVfT1VJICovCj4gKwlzcF90eF9hdXhfZHBjZHJlYWRfYnl0ZXMoY3R4LCAw
eDAwLCAweDA1LCAweDAwLCBzaXplb2YoYnVmKSwgYnVmKTsKPiArCWlmIChtZW1jbXAoYnVmLCBB
TlhfT1VJLCBzaXplb2YoYnVmKSkgPT0gMCkKPiArCQlyZXR1cm4gMDsKPiArCj4gKwlyZXR1cm4g
LUVOWElPOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBzcF90eF9nZXRfcnhfYncoc3RydWN0IGFu
eDc2MjVfZGF0YSAqY3R4LCB1OCAqYncpCj4gK3sKPiArCXU4IGRhdGFfYnVmWzRdOwo+ICsJLyoK
PiArCSAqIFdoZW4gQU5YIGRvbmdsZSBjb25uZWN0ZWQsIGlmIENISVBfSUQgPSAweDc3NTAsIGJh
bmR3aWR0aCBpcyA2Ljc1RywKPiArCSAqIGJlY2F1c2UgQU5YNzc1MCBEUENEIDB4MDUyeCB3YXMg
bm90IGF2YWlsYWJsZS4KPiArCSAqLwo+ICsJaWYgKCFpc19hbnhfZG9uZ2xlKGN0eCkpIHsKPiAr
CQlzcF90eF9hdXhfZHBjZHJlYWRfYnl0ZXMoY3R4LCAweDAwLCAweDA1LCAweDAzLCAweDA0LCBk
YXRhX2J1Zik7Cj4gKwkJaWYgKGRhdGFfYnVmWzBdID09IDB4MzcgJiYgZGF0YV9idWZbMV0gPT0g
MHgzNyAmJgo+ICsJCSAgICBkYXRhX2J1ZlsyXSA9PSAweDM1ICYmIGRhdGFfYnVmWzNdID09IDB4
MzApIHsKPiArCQkJLyogMHgxOSA6IDYuNzVHICovCj4gKwkJCSpidyA9IDB4MTk7Cj4gKwkJfSBl
bHNlIHsKPiArCQkJc3BfdHhfYXV4X2RwY2RyZWFkX2J5dGVzKGN0eCwgMHgwMCwgMHgwNSwgMHgy
MSwgMSwgYncpOwo+ICsJCQkvKgo+ICsJCQkgKiBzb21lIEFOWCBkb25nbGUgcmVhZCBvdXQgdmFs
dWUgMCwKPiArCQkJICogcmV0cnkgc3RhbmRhcmQgcmVnaXN0ZXIuCj4gKwkJCSAqLwo+ICsJCQlp
ZiAoKCgqYncpID09IDApIHx8ICgoKmJ3KSA9PSAweGZmKSkKPiArCQkJCXNwX3R4X2F1eF9kcGNk
cmVhZF9ieXRlcyhjdHgsIDB4MDAsIDB4MDAsCj4gKwkJCQkJCQkgRFBDRF9NQVhfTElOS19SQVRF
LAo+ICsJCQkJCQkJIDEsIGJ3KTsKPiArCQl9Cj4gKwl9IGVsc2Ugewo+ICsJCXNwX3R4X2F1eF9k
cGNkcmVhZF9ieXRlcyhjdHgsIDB4MDAsIDB4MDAsCj4gKwkJCQkJIERQQ0RfTUFYX0xJTktfUkFU
RSwgMSwgYncpOwo+ICsJfQo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBhbng3NjI1X2RwX3N0YXJ0
KHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKPiArewo+ICsJaW50IHJldDsKPiArCj4gKwlpZiAo
IWN0eC0+ZGlzcGxheV90aW1pbmdfdmFsaWQpIHsKPiArCQlEUk1fRVJST1IoIm1pcGkgZHJtIGhh
dmVuJ3Qgc2V0IGRpc3BsYXkgdGltaW5nIHlldC5cbiIpOwo+ICsJCXJldHVybjsKPiArCX0KPiAr
Cj4gKwlyZXQgPSBhbng3NjI1X2NvbmZpZ19hdWRpb19pbnB1dChjdHgpOwo+ICsJaWYgKHJldCA8
IDApCj4gKwkJRFJNX0VSUk9SKCJjb25maWcgYXVkaW8gaW5wdXQgZmFpbGVkLlxuIik7Cj4gKwo+
ICsJaWYgKGN0eC0+cGRhdGEuZHNpX3N1cHBvcnRlZCkKPiArCQlyZXQgPSBhbng3NjI1X2RzaV9j
b25maWcoY3R4KTsKPiArCWVsc2UKPiArCQlyZXQgPSBhbng3NjI1X2RwaV9jb25maWcoY3R4KTsK
PiArCj4gKwlpZiAocmV0IDwgMCkKPiArCQlEUk1fRVJST1IoIk1JUEkgcGh5IHNldHVwIGVycm9y
LlxuIik7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGFueDc2MjVfZHBfc3RvcChzdHJ1Y3QgYW54
NzYyNV9kYXRhICpjdHgpCj4gK3sKPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVu
dC0+ZGV2Owo+ICsJaW50IHJldDsKPiArCj4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJz
dG9wIGRwIG91dHB1dFxuIik7Cj4gKwo+ICsJLyoKPiArCSAqIHZpZGVvIGRpc2FibGU6IDB4NzI6
MDggYml0IDcgPSAwOwo+ICsJICogYXVkaW8gZGlzYWJsZTogMHg3MDo4NyBiaXQgMCA9IDA7Cj4g
KwkgKi8KPiArCXJldCA9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMudHhfcDBfY2xp
ZW50LCAweDg3LCAweGZlKTsKPiArCXJldCB8PSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+
aTJjLnR4X3AyX2NsaWVudCwgMHgwOCwgMHg3Zik7Cj4gKwo+ICsJcmV0IHw9IGFueDc2MjVfdmlk
ZW9fbXV0ZV9jb250cm9sKGN0eCwgMSk7Cj4gKwlpZiAocmV0IDwgMCkKPiArCQlEUk1fRVJST1Io
IklPIGVycm9yIDogbXV0ZSB2aWRlbyBmYWlsZWRcbiIpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50
IHNwX3R4X3JzdF9hdXgoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQo+ICt7Cj4gKwlpbnQgcmV0
Owo+ICsKPiArCXJldCA9IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy50eF9wMl9jbGll
bnQsIFJTVF9DVFJMMiwKPiArCQkJICAgICAgIEFVWF9SU1QpOwo+ICsJcmV0IHw9IGFueDc2MjVf
d3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMudHhfcDJfY2xpZW50LCBSU1RfQ1RSTDIsCj4gKwkJCQkg
fkFVWF9SU1QpOwo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKPiArc3RhdGljIGludCBzcF90eF9h
dXhfd3Ioc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LCB1OCBvZmZzZXQpCj4gK3sKPiArCWludCBy
ZXQ7Cj4gKwo+ICsJcmV0ID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9j
bGllbnQsCj4gKwkJCQlBUF9BVVhfQlVGRl9TVEFSVCwgb2Zmc2V0KTsKPiArCXJldCB8PSBhbng3
NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiArCQkJCSBBUF9BVVhf
Q09NTUFORCwgMHgwNCk7Cj4gKwlyZXQgfD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJj
LnJ4X3AwX2NsaWVudCwKPiArCQkJCUFQX0FVWF9DVFJMX1NUQVRVUywgQVBfQVVYX0NUUkxfT1Bf
RU4pOwo+ICsJcmV0dXJuIChyZXQgfCB3YWl0X2F1eF9vcF9maW5pc2goY3R4KSk7Cj4gK30KPiAr
Cj4gK3N0YXRpYyBpbnQgc3BfdHhfYXV4X3JkKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwgdTgg
bGVuX2NtZCkKPiArewo+ICsJaW50IHJldDsKPiArCj4gKwlyZXQgPSBhbng3NjI1X3JlZ193cml0
ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiArCQkJCUFQX0FVWF9DT01NQU5ELCBsZW5f
Y21kKTsKPiArCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xp
ZW50LAo+ICsJCQkJQVBfQVVYX0NUUkxfU1RBVFVTLCBBUF9BVVhfQ1RSTF9PUF9FTik7Cj4gKwly
ZXR1cm4gKHJldCB8IHdhaXRfYXV4X29wX2ZpbmlzaChjdHgpKTsKPiArfQo+ICsKPiArc3RhdGlj
IGludCBzcF90eF9nZXRfZWRpZF9ibG9jayhzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gK3sK
PiArCWludCBjID0gMDsKPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2
Owo+ICsKPiArCXNwX3R4X2F1eF93cihjdHgsIDB4N2UpOwo+ICsJc3BfdHhfYXV4X3JkKGN0eCwg
MHgwMSk7Cj4gKwljID0gYW54NzYyNV9yZWdfcmVhZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVu
dCwgQVBfQVVYX0JVRkZfU1RBUlQpOwo+ICsJaWYgKGMgPCAwKSB7Cj4gKwkJRFJNX0VSUk9SKCJJ
TyBlcnJvciA6IGFjY2VzcyBBVVggQlVGRi5cbiIpOwo+ICsJCXJldHVybiAtRUlPOwo+ICsJfQo+
ICsKPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIiBFRElEIEJsb2NrID0gJWRcbiIsIGMg
KyAxKTsKPiArCj4gKwlpZiAoYyA+IDMpCgpSZXBsYWNlIG1hZ2ljIG51bWJlciAzIHdpdGggYSBk
ZWZpbmUuCgo+ICsJCWMgPSAxOwo+ICsKPiArCXJldHVybiBjOwo+ICt9Cj4gKwo+ICtzdGF0aWMg
aW50IGVkaWRfcmVhZChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCj4gKwkJICAgICB1OCBvZmZz
ZXQsIHU4ICpwYmxvY2tfYnVmKQo+ICt7Cj4gKwl1OCBjLCBjbnQgPSAwOwogICAgICAgICAgICAg
IF5eXl5eXl4KTm8gbmVlZC4KCj4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQt
PmRldjsKPiArCj4gKwljID0gMDsKPiArCWZvciAoY250ID0gMDsgY250IDwgMzsgY250KyspIHsK
PiArCQlzcF90eF9hdXhfd3IoY3R4LCBvZmZzZXQpOwo+ICsJCS8qIHNldCBJMkMgcmVhZCBjb20g
MHgwMSBtb3QgPSAwIGFuZCByZWFkIDE2IGJ5dGVzICovCj4gKwkJYyA9IHNwX3R4X2F1eF9yZChj
dHgsIDB4ZjEpOwoKYyBuZWVkcyB0byBiZSBhbiBpbnQgYmVjYXVzZSB0aGlzIHJldHVybnMgbmVn
YXRpdmUgZXJyb3IgY29kZXMuCgo+ICsKPiArCQlpZiAoYyA9PSAxKSB7CgpXaGF0IGRvZXMgMSBt
ZWFuIGluIHRoaXMgY29udGV4dD8gIEl0IHNlZW1zIGxpa2UgYSBtYWdpYyBudW1iZXIuICBNYWtl
Cml0IGEgZGVmaW5lLgoKPiArCQkJc3BfdHhfcnN0X2F1eChjdHgpOwo+ICsJCQlEUk1fREVWX0RF
QlVHX0RSSVZFUihkZXYsICJlZGlkIHJlYWQgZmFpbGVkLCByZXNldCFcbiIpOwo+ICsJCQljbnQr
KzsKPiArCQl9IGVsc2Ugewo+ICsJCQlhbng3NjI1X3JlZ19ibG9ja19yZWFkKGN0eCwgY3R4LT5p
MmMucnhfcDBfY2xpZW50LAo+ICsJCQkJCSAgICAgICBBUF9BVVhfQlVGRl9TVEFSVCwKPiArCQkJ
CQkgICAgICAgTUFYX0RQQ0RfQlVGRkVSX1NJWkUsCj4gKwkJCQkJICAgICAgIHBibG9ja19idWYp
Owo+ICsJCQlyZXR1cm4gMDsKCldoeSBkbyB3ZSBkbyB0aGlzIHJlYWQ/ICBJdCdzIHdlaXJkIHRo
YXQgd2UgZG9uJ3QgY2hlY2sgZm9yIGVycm9ycy4KCj4gKwkJfQo+ICsJfQo+ICsKPiArCXJldHVy
biAtRUlPOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHNlZ21lbnRzX2VkaWRfcmVhZChzdHJ1Y3Qg
YW54NzYyNV9kYXRhICpjdHgsCj4gKwkJCSAgICAgIHU4IHNlZ21lbnQsIHU4ICpidWYsIHU4IG9m
ZnNldCkKPiArewo+ICsJdTggYywgY250ID0gMDsKPiArCWludCByZXQ7Cj4gKwlzdHJ1Y3QgZGV2
aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKPiArCj4gKwkvKiB3cml0ZSBhZGRyZXNzIG9u
bHkgKi8KPiArCXJldCA9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xp
ZW50LAo+ICsJCQkJQVBfQVVYX0FERFJfN18wLCAweDMwKTsKPiArCXJldCB8PSBhbng3NjI1X3Jl
Z193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiArCQkJCSBBUF9BVVhfQ09NTUFO
RCwgMHgwNCk7Cj4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9w
MF9jbGllbnQsCj4gKwkJCQkgQVBfQVVYX0NUUkxfU1RBVFVTLAo+ICsJCQkJIEFQX0FVWF9DVFJM
X0FERFJPTkxZIHwgQVBfQVVYX0NUUkxfT1BfRU4pOwo+ICsKPiArCXJldCB8PSB3YWl0X2F1eF9v
cF9maW5pc2goY3R4KTsKPiArCS8qIHdyaXRlIHNlZ21lbnQgYWRkcmVzcyAqLwo+ICsJcmV0IHw9
IHNwX3R4X2F1eF93cihjdHgsIHNlZ21lbnQpOwo+ICsJLyogZGF0YSByZWFkICovCj4gKwlyZXQg
fD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4gKwkJCQkg
QVBfQVVYX0FERFJfN18wLCAweDUwKTsKPiArCWlmIChyZXQgPCAwKSB7Cj4gKwkJRFJNX0VSUk9S
KCJJTyBlcnJvciA6IGF1eCBpbml0aWFsIGZhaWxlZC5cbiIpOwo+ICsJCXJldHVybiByZXQ7Cj4g
Kwl9Cj4gKwo+ICsJZm9yIChjbnQgPSAwOyBjbnQgPCAzOyBjbnQrKykgewo+ICsJCXNwX3R4X2F1
eF93cihjdHgsIG9mZnNldCk7Cj4gKwkJLyogc2V0IEkyQyByZWFkIGNvbSAweDAxIG1vdCA9IDAg
YW5kIHJlYWQgMTYgYnl0ZXMgKi8KPiArCQljID0gc3BfdHhfYXV4X3JkKGN0eCwgMHhmMSk7Cj4g
Kwo+ICsJCWlmIChjID09IDEpIHsKClNhbWUuCgo+ICsJCQlyZXQgPSBzcF90eF9yc3RfYXV4KGN0
eCk7Cj4gKwkJCURSTV9ERVZfRVJST1IoZGV2LCAic2VnbWVudCByZWFkIGZhaWxlZCwgcmVzZXQh
XG4iKTsKPiArCQkJY250Kys7Cj4gKwkJfSBlbHNlIHsKPiArCQkJcmV0ID0gYW54NzYyNV9yZWdf
YmxvY2tfcmVhZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiArCQkJCQkJICAgICBBUF9B
VVhfQlVGRl9TVEFSVCwKPiArCQkJCQkJICAgICBNQVhfRFBDRF9CVUZGRVJfU0laRSwgYnVmKTsK
PiArCQkJcmV0dXJuIHJldDsKPiArCQl9Cj4gKwl9Cj4gKwo+ICsJcmV0dXJuIHJldDsKPiArfQo+
ICsKPiArc3RhdGljIGludCBzcF90eF9lZGlkX3JlYWQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4
LAo+ICsJCQkgICB1OCAqcGVkaWRfYmxvY2tzX2J1ZikKPiArewo+ICsJdTggb2Zmc2V0LCBlZGlk
X3BvczsKPiArCWludCBjb3VudCwgYmxvY2tzX251bTsKPiArCXU4IHBibG9ja19idWZbTUFYX0RQ
Q0RfQlVGRkVSX1NJWkVdOwo+ICsJdTggaSwgajsKPiArCXU4IGdfZWRpZF9icmVhayA9IDA7Cj4g
KwlpbnQgcmV0Owo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7Cj4g
Kwo+ICsJLyogYWRkcmVzcyBpbml0aWFsICovCj4gKwlyZXQgPSBhbng3NjI1X3JlZ193cml0ZShj
dHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiArCQkJCUFQX0FVWF9BRERSXzdfMCwgMHg1MCk7
Cj4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQs
Cj4gKwkJCQkgQVBfQVVYX0FERFJfMTVfOCwgMCk7Cj4gKwlyZXQgfD0gYW54NzYyNV93cml0ZV9h
bmQoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4gKwkJCQkgQVBfQVVYX0FERFJfMTlfMTYs
IDB4ZjApOwo+ICsJaWYgKHJldCA8IDApIHsKPiArCQlEUk1fRVJST1IoImFjY2VzcyBhdXggY2hh
bm5lbCBJTyBlcnJvci5cbiIpOwo+ICsJCXJldHVybiAtRUlPOwo+ICsJfQo+ICsKPiArCWJsb2Nr
c19udW0gPSBzcF90eF9nZXRfZWRpZF9ibG9jayhjdHgpOwo+ICsJaWYgKGJsb2Nrc19udW0gPCAw
KQo+ICsJCXJldHVybiBibG9ja3NfbnVtOwo+ICsKPiArCWNvdW50ID0gMDsKPiArCj4gKwlkbyB7
Cj4gKwkJc3dpdGNoIChjb3VudCkgewo+ICsJCWNhc2UgMDoKPiArCQljYXNlIDE6Cj4gKwkJCWZv
ciAoaSA9IDA7IGkgPCA4OyBpKyspIHsKPiArCQkJCW9mZnNldCA9IChpICsgY291bnQgKiA4KSAq
IE1BWF9EUENEX0JVRkZFUl9TSVpFOwo+ICsJCQkJZ19lZGlkX2JyZWFrID0gZWRpZF9yZWFkKGN0
eCwgb2Zmc2V0LAo+ICsJCQkJCQkJIHBibG9ja19idWYpOwo+ICsKPiArCQkJCWlmIChnX2VkaWRf
YnJlYWspCj4gKwkJCQkJYnJlYWs7Cj4gKwo+ICsJCQkJbWVtY3B5KCZwZWRpZF9ibG9ja3NfYnVm
W29mZnNldF0sCj4gKwkJCQkgICAgICAgcGJsb2NrX2J1ZiwKPiArCQkJCSAgICAgICBNQVhfRFBD
RF9CVUZGRVJfU0laRSk7Cj4gKwkJCX0KPiArCj4gKwkJCWJyZWFrOwo+ICsJCWNhc2UgMjoKPiAr
CQkJb2Zmc2V0ID0gMHgwMDsKPiArCj4gKwkJCWZvciAoaiA9IDA7IGogPCA4OyBqKyspIHsKPiAr
CQkJCWVkaWRfcG9zID0gKGogKyBjb3VudCAqIDgpICoKPiArCQkJCQlNQVhfRFBDRF9CVUZGRVJf
U0laRTsKPiArCj4gKwkJCQlpZiAoZ19lZGlkX2JyZWFrID09IDEpCj4gKwkJCQkJYnJlYWs7Cj4g
Kwo+ICsJCQkJc2VnbWVudHNfZWRpZF9yZWFkKGN0eCwgY291bnQgLyAyLAo+ICsJCQkJCQkgICBw
YmxvY2tfYnVmLCBvZmZzZXQpOwo+ICsJCQkJbWVtY3B5KCZwZWRpZF9ibG9ja3NfYnVmW2VkaWRf
cG9zXSwKPiArCQkJCSAgICAgICBwYmxvY2tfYnVmLAo+ICsJCQkJICAgICAgIE1BWF9EUENEX0JV
RkZFUl9TSVpFKTsKPiArCQkJCW9mZnNldCA9IG9mZnNldCArIDB4MTA7Cj4gKwkJCX0KPiArCj4g
KwkJCWJyZWFrOwo+ICsJCWNhc2UgMzoKPiArCQkJb2Zmc2V0ID0gMHg4MDsKPiArCj4gKwkJCWZv
ciAoaiA9IDA7IGogPCA4OyBqKyspIHsKPiArCQkJCWVkaWRfcG9zID0gKGogKyBjb3VudCAqIDgp
ICoKPiArCQkJCQlNQVhfRFBDRF9CVUZGRVJfU0laRTsKPiArCQkJCWlmIChnX2VkaWRfYnJlYWsg
PT0gMSkKPiArCQkJCQlicmVhazsKPiArCj4gKwkJCQlzZWdtZW50c19lZGlkX3JlYWQoY3R4LCBj
b3VudCAvIDIsCj4gKwkJCQkJCSAgIHBibG9ja19idWYsIG9mZnNldCk7Cj4gKwkJCQltZW1jcHko
JnBlZGlkX2Jsb2Nrc19idWZbZWRpZF9wb3NdLAo+ICsJCQkJICAgICAgIHBibG9ja19idWYsCj4g
KwkJCQkgICAgICAgTUFYX0RQQ0RfQlVGRkVSX1NJWkUpOwo+ICsJCQkJb2Zmc2V0ID0gb2Zmc2V0
ICsgMHgxMDsKPiArCQkJfQo+ICsKPiArCQkJYnJlYWs7Cj4gKwkJZGVmYXVsdDoKPiArCQkJYnJl
YWs7Cj4gKwkJfQo+ICsKPiArCQljb3VudCsrOwo+ICsKPiArCX0gd2hpbGUgKGJsb2Nrc19udW0g
Pj0gY291bnQpOwo+ICsKPiArCS8qIGNoZWNrIGVkaWQgZGF0YSAqLwo+ICsJaWYgKGRybV9lZGlk
X2lzX3ZhbGlkKChzdHJ1Y3QgZWRpZCAqKXBlZGlkX2Jsb2Nrc19idWYpID09IGZhbHNlKQoKaWYg
KCFkcm1fZWRpZF9pc192YWxpZCgoc3RydWN0IGVkaWQgKilwZWRpZF9ibG9ja3NfYnVmKSkKClNo
b3VsZG4ndCB0aGlzIHJldHVybiBhIG5lZ2F0aXZlIGVycm9yPwoKPiArCQlEUk1fREVWX0VSUk9S
KGRldiwgIldBUk5JTkchIGVkaWQgY2hlY2sgZmFpbGVkIVxuIik7Cj4gKwo+ICsJLyogcmVzZXQg
YXV4IGNoYW5uZWwgKi8KPiArCXNwX3R4X3JzdF9hdXgoY3R4KTsKPiArCj4gKwlyZXR1cm4gKGJs
b2Nrc19udW0gKyAxKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgYW54NzYyNV9wb3dlcl9vbihz
dHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gK3sKPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZj
dHgtPmNsaWVudC0+ZGV2Owo+ICsKPiArCWlmIChjdHgtPnBkYXRhLmxvd19wb3dlcl9tb2RlKSB7
CgpSZXZlcnNlIHRoaXMgY29uZGl0aW9uCgoJaWYgKCFjdHgtPnBkYXRhLmxvd19wb3dlcl9tb2Rl
KSB7CgkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiQW54NzYyNSBub3QgbG93IHBvd2VyIG1v
ZGUhXG4iKTsKCQlyZXR1cm47Cgl9Cgo+ICsJCS8qIHBvd2VyIG9uIHBpbiBlbmFibGUgKi8KPiAr
CQlncGlvZF9zZXRfdmFsdWUoY3R4LT5wZGF0YS5ncGlvX3Bfb24sIDEpOwo+ICsJCXVzbGVlcF9y
YW5nZSgxMDAwMCwgMTEwMDApOwo+ICsJCS8qIHBvd2VyIHJlc2V0IHBpbiBlbmFibGUgKi8KPiAr
CQlncGlvZF9zZXRfdmFsdWUoY3R4LT5wZGF0YS5ncGlvX3Jlc2V0LCAxKTsKPiArCQl1c2xlZXBf
cmFuZ2UoMTAwMDAsIDExMDAwKTsKPiArCj4gKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAi
QW54NzYyNSBwb3dlciBvbiAhXG4iKTsKPiArCX0gZWxzZSB7Cj4gKwkJRFJNX0RFVl9ERUJVR19E
UklWRVIoZGV2LCAiQW54NzYyNSBub3QgbG93IHBvd2VyIG1vZGUhXG4iKTsKPiArCX0KPiArfQo+
ICsKPiArc3RhdGljIHZvaWQgYW54NzYyNV9wb3dlcl9zdGFuZGJ5KHN0cnVjdCBhbng3NjI1X2Rh
dGEgKmN0eCkKPiArewo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7
Cj4gKwo+ICsJaWYgKGN0eC0+cGRhdGEubG93X3Bvd2VyX21vZGUpIHsKClNhbWUKCj4gKwkJZ3Bp
b2Rfc2V0X3ZhbHVlKGN0eC0+cGRhdGEuZ3Bpb19yZXNldCwgMCk7Cj4gKwkJdXNsZWVwX3Jhbmdl
KDEwMDAsIDExMDApOwo+ICsJCWdwaW9kX3NldF92YWx1ZShjdHgtPnBkYXRhLmdwaW9fcF9vbiwg
MCk7Cj4gKwkJdXNsZWVwX3JhbmdlKDEwMDAsIDExMDApOwo+ICsJCURSTV9ERVZfREVCVUdfRFJJ
VkVSKGRldiwgImFueDc2MjUgcG93ZXIgZG93blxuIik7Cj4gKwl9IGVsc2Ugewo+ICsJCURSTV9E
RVZfREVCVUdfRFJJVkVSKGRldiwgImFueDc2MjUgbm90IGxvdyBwb3dlciBtb2RlIVxuIik7Cj4g
Kwl9Cj4gK30KPiArCj4gKy8qIGJhc2ljIGNvbmZpZ3VyYXRpb25zIG9mIEFOWDc2MjUgKi8KPiAr
c3RhdGljIHZvaWQgYW54NzYyNV9jb25maWcoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQo+ICt7
Cj4gKwlhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiArCQkJ
ICBYVEFMX0ZSUV9TRUwsIFhUQUxfRlJRXzI3TSk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGFu
eDc2MjVfZGlzYWJsZV9wZF9wcm90b2NvbChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gK3sK
PiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ICsJaW50IHJldDsK
PiArCj4gKwkvKiByZXNldCBtYWluIG9jbSAqLwo+ICsJcmV0ID0gYW54NzYyNV9yZWdfd3JpdGUo
Y3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsIDB4ODgsIDB4NDApOwo+ICsJLyogRGlzYWJsZSBQ
RCAqLwo+ICsJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xp
ZW50LAo+ICsJCQkJIEFQX0FWX1NUQVRVUywgQVBfRElTQUJMRV9QRCk7Cj4gKwkvKiByZWxlYXNl
IG1haW4gb2NtICovCj4gKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5y
eF9wMF9jbGllbnQsIDB4ODgsIDB4MDApOwo+ICsKPiArCWlmIChyZXQgPCAwKQo+ICsJCURSTV9E
RVZfREVCVUdfRFJJVkVSKGRldiwgImRpc2FibGUgUEQgZmVhdHVyZSBmYWlsZWQuXG4iKTsKPiAr
CWVsc2UKPiArCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJkaXNhYmxlIFBEIGZlYXR1cmUg
c3VjY2VlZGVkLlxuIik7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGFueDc2MjVfcG93ZXJfb25f
aW5pdChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gK3sKPiArCWludCByZXRyeV9jb3VudCwg
aTsKPiArCWludCByZXQgPSAwOwo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50
LT5kZXY7Cj4gKwo+ICsJZm9yIChyZXRyeV9jb3VudCA9IDA7IHJldHJ5X2NvdW50IDwgMzsgcmV0
cnlfY291bnQrKykgewo+ICsJCWFueDc2MjVfcG93ZXJfb24oY3R4KTsKPiArCQlhbng3NjI1X2Nv
bmZpZyhjdHgpOwo+ICsKPiArCQlmb3IgKGkgPSAwOyBpIDwgT0NNX0xPQURJTkdfVElNRTsgaSsr
KSB7Cj4gKwkJCS8qIGNoZWNrIGludGVyZmFjZSB3b3JrYWJsZSAqLwo+ICsJCQlyZXQgPSBhbng3
NjI1X3JlZ19yZWFkKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAo+ICsJCQkJCSAgICAgICBG
TEFTSF9MT0FEX1NUQSk7Cj4gKwkJCWlmIChyZXQgPCAwKSB7Cj4gKwkJCQlEUk1fRVJST1IoIklP
IGVycm9yIDogYWNjZXNzIGZsYXNoIGxvYWQuXG4iKTsKPiArCQkJCXJldHVybjsKPiArCQkJfQo+
ICsJCQlpZiAoKHJldCAmIEZMQVNIX0xPQURfU1RBX0NISykgPT0gRkxBU0hfTE9BRF9TVEFfQ0hL
KSB7Cj4gKwkJCQlhbng3NjI1X2Rpc2FibGVfcGRfcHJvdG9jb2woY3R4KTsKPiArCQkJCURSTV9E
RVZfREVCVUdfRFJJVkVSKGRldiwKPiArCQkJCQkJICAgICAiRmlybXdhcmUgdmVyICUwMnglMDJ4
LCIsCj4gKwkJCQkJYW54NzYyNV9yZWdfcmVhZChjdHgsCj4gKwkJCQkJCQkgY3R4LT5pMmMucnhf
cDBfY2xpZW50LAo+ICsJCQkJCQkJIE9DTV9GV19WRVJTSU9OKSwKPiArCQkJCQlhbng3NjI1X3Jl
Z19yZWFkKGN0eCwKPiArCQkJCQkJCSBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4gKwkJCQkJCQkg
T0NNX0ZXX1JFVkVSU0lPTikpOwo+ICsJCQkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiRHJp
dmVyIHZlcnNpb24gJXNcbiIsCj4gKwkJCQkJCSAgICAgQU5YNzYyNV9EUlZfVkVSU0lPTik7Cj4g
Kwo+ICsJCQkJcmV0dXJuOwo+ICsJCQl9Cj4gKwkJCXVzbGVlcF9yYW5nZSgxMDAwLCAxMTAwKTsK
PiArCQl9Cj4gKwkJYW54NzYyNV9wb3dlcl9zdGFuZGJ5KGN0eCk7Cj4gKwl9Cj4gK30KPiArCj4g
K3N0YXRpYyBpbnQgYW54NzYyNV9leHRjb25fbm90aWZpZXIoc3RydWN0IG5vdGlmaWVyX2Jsb2Nr
ICpuYiwKPiArCQkJCSAgIHVuc2lnbmVkIGxvbmcgZXZlbnQsIHZvaWQgKnB0cikKPiArewo+ICsJ
c3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0KPiArCQljb250YWluZXJfb2YobmIsIHN0cnVjdCBh
bng3NjI1X2RhdGEsIGV2ZW50X25iKTsKPiArCj4gKwlzY2hlZHVsZV93b3JrKCZjdHgtPmV4dGNv
bl93cSk7Cj4gKwlyZXR1cm4gTk9USUZZX0RPTkU7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGFu
eDc2MjVfY2hpcF9jb250cm9sKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwgaW50IHN0YXRlKQo+
ICt7Cj4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKPiArCj4gKwlE
Uk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJiZWZvcmUgc2V0LCBwb3dlcl9zdGF0ZSglZCkuXG4i
LAo+ICsJCQkgICAgIGF0b21pY19yZWFkKCZjdHgtPnBvd2VyX3N0YXR1cykpOwo+ICsJaWYgKGN0
eC0+cGRhdGEubG93X3Bvd2VyX21vZGUpIHsKClJldnNlcnNlIHRoaXMgY29uZGl0aW9uOgoKCWlm
ICghY3R4LT5wZGF0YS5sb3dfcG93ZXJfbW9kZSkKCQlyZXR1cm47Cgo+ICsJCWlmIChzdGF0ZSkg
ewo+ICsJCQlhdG9taWNfaW5jKCZjdHgtPnBvd2VyX3N0YXR1cyk7Cj4gKwkJCWlmIChhdG9taWNf
cmVhZCgmY3R4LT5wb3dlcl9zdGF0dXMpID09IDEpCj4gKwkJCQlhbng3NjI1X3Bvd2VyX29uX2lu
aXQoY3R4KTsKPiArCQl9IGVsc2Ugewo+ICsJCQlpZiAoYXRvbWljX3JlYWQoJmN0eC0+cG93ZXJf
c3RhdHVzKSkgewo+ICsJCQkJYXRvbWljX2RlYygmY3R4LT5wb3dlcl9zdGF0dXMpOwo+ICsKPiAr
CQkJCWlmIChhdG9taWNfcmVhZCgmY3R4LT5wb3dlcl9zdGF0dXMpID09IDApCj4gKwkJCQkJYW54
NzYyNV9wb3dlcl9zdGFuZGJ5KGN0eCk7Cj4gKwkJCX0KPiArCQl9Cj4gKwl9Cj4gKwo+ICsJRFJN
X0RFVl9ERUJVR19EUklWRVIoZGV2LCAiYWZ0ZXIgc2V0LCBwb3dlcl9zdGF0ZSglZCkuXG4iLAo+
ICsJCQkgICAgIGF0b21pY19yZWFkKCZjdHgtPnBvd2VyX3N0YXR1cykpOwo+ICt9Cj4gKwo+ICtz
dGF0aWMgdm9pZCBhbng3NjI1X2V4dGNvbl93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykK
PiArewo+ICsJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0KPiArCQljb250YWluZXJfb2Yod29y
aywgc3RydWN0IGFueDc2MjVfZGF0YSwgZXh0Y29uX3dxKTsKPiArCWludCBzdGF0ZSA9IGV4dGNv
bl9nZXRfc3RhdGUoY3R4LT5leHRjb24sIEVYVENPTl9ESVNQX0RQKTsKPiArCj4gKwltdXRleF9s
b2NrKCZjdHgtPmxvY2spOwo+ICsJYW54NzYyNV9jaGlwX2NvbnRyb2woY3R4LCBzdGF0ZSk7Cj4g
KwltdXRleF91bmxvY2soJmN0eC0+bG9jayk7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgYW54NzYy
NV9leHRjb25fbm90aWZpZXJfaW5pdChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gK3sKPiAr
CWludCByZXQ7Cj4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKPiAr
Cj4gKwljdHgtPmV2ZW50X25iLm5vdGlmaWVyX2NhbGwgPSBhbng3NjI1X2V4dGNvbl9ub3RpZmll
cjsKPiArCUlOSVRfV09SSygmY3R4LT5leHRjb25fd3EsIGFueDc2MjVfZXh0Y29uX3dvcmspOwo+
ICsJcmV0ID0gZGV2bV9leHRjb25fcmVnaXN0ZXJfbm90aWZpZXIoJmN0eC0+Y2xpZW50LT5kZXYs
IGN0eC0+ZXh0Y29uLAo+ICsJCQkJCSAgICBFWFRDT05fRElTUF9EUCwgJmN0eC0+ZXZlbnRfbmIp
Owo+ICsJaWYgKHJldCkgewo+ICsJCURSTV9ERVZfRVJST1IoZGV2LCAiZmFpbGVkIHRvIHJlZ2lz
dGVyIG5vdGlmaWVyIGZvciBEUCIpOwo+ICsJCXJldHVybiByZXQ7Cj4gKwl9Cj4gKwlyZXR1cm4g
MDsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgYW54NzYyNV9pbml0X2dwaW8oc3RydWN0IGFueDc2
MjVfZGF0YSAqcGxhdGZvcm0pCj4gK3sKPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZwbGF0Zm9y
bS0+Y2xpZW50LT5kZXY7Cj4gKwo+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiYW54NzYy
NSBpbml0IGdwaW9cbiIpOwo+ICsKPiArCS8qIGdwaW8gZm9yIGNoaXAgcG93ZXIgZW5hYmxlICov
Cj4gKwlwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19wX29uID0KPiArCQlkZXZtX2dwaW9kX2dldF9vcHRp
b25hbChkZXYsICJlbmFibGUiLCBHUElPRF9PVVRfTE9XKTsKPiArCS8qIGdwaW8gZm9yIGNoaXAg
cmVzZXQgKi8KPiArCXBsYXRmb3JtLT5wZGF0YS5ncGlvX3Jlc2V0ID0KPiArCQlkZXZtX2dwaW9k
X2dldF9vcHRpb25hbChkZXYsICJyZXNldCIsIEdQSU9EX09VVF9MT1cpOwo+ICsKPiArCWlmIChw
bGF0Zm9ybS0+cGRhdGEuZ3Bpb19wX29uICYmIHBsYXRmb3JtLT5wZGF0YS5ncGlvX3Jlc2V0KSB7
Cj4gKwkJcGxhdGZvcm0tPnBkYXRhLmxvd19wb3dlcl9tb2RlID0gMTsKPiArCQlEUk1fREVWX0RF
QlVHX0RSSVZFUihkZXYsICJsb3cgcG93ZXIgbW9kZSwgcG9uICVkLCByZXNldCAlZC5cbiIsCj4g
KwkJCQkgICAgIGRlc2NfdG9fZ3BpbyhwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19wX29uKSwKPiArCQkJ
CSAgICAgZGVzY190b19ncGlvKHBsYXRmb3JtLT5wZGF0YS5ncGlvX3Jlc2V0KSk7Cj4gKwl9IGVs
c2Ugewo+ICsJCXBsYXRmb3JtLT5wZGF0YS5sb3dfcG93ZXJfbW9kZSA9IDA7Cj4gKwkJRFJNX0RF
Vl9ERUJVR19EUklWRVIoZGV2LCAibm90IGxvdyBwb3dlciBtb2RlLlxuIik7Cj4gKwl9Cj4gKwo+
ICsJcGxhdGZvcm0tPnBkYXRhLmdwaW9faW50cl9ocGQgPQo+ICsJCWRldm1fZ3Bpb2RfZ2V0X29w
dGlvbmFsKGRldiwgImhwZCIsIEdQSU9EX0lOKTsKPiArCj4gKwlEUk1fREVWX0RFQlVHX0RSSVZF
UihkZXYsICJocGQgZ3BpbyAlZC5cbiIsCj4gKwkJCSAgICAgKCFwbGF0Zm9ybS0+cGRhdGEuZ3Bp
b19pbnRyX2hwZCkgPyAwIDoKPiArCQkJICAgICBkZXNjX3RvX2dwaW8ocGxhdGZvcm0tPnBkYXRh
LmdwaW9faW50cl9ocGQpKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgYW54NzYyNV9zdG9wX2Rw
X3dvcmsoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQo+ICt7Cj4gKwljdHgtPmhwZF9zdGF0dXMg
PSAwOwo+ICsJY3R4LT5ocGRfaGlnaF9jbnQgPSAwOwo+ICsJY3R4LT5kaXNwbGF5X3RpbWluZ192
YWxpZCA9IDA7Cj4gKwo+ICsJY3R4LT5zbGltcG9ydF9lZGlkX3AuZWRpZF9ibG9ja19udW0gPSAt
MTsKPiArCj4gKwlpZiAoY3R4LT5wZGF0YS5sb3dfcG93ZXJfbW9kZSA9PSAwKQo+ICsJCWFueDc2
MjVfZGlzYWJsZV9wZF9wcm90b2NvbChjdHgpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBhbng3
NjI1X3N0YXJ0X2RwX3dvcmsoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQo+ICt7Cj4gKwlpbnQg
cmV0Owo+ICsJdTggYnVmW01BWF9EUENEX0JVRkZFUl9TSVpFXTsKPiArCXU4IGhkY3BfY2FwOwo+
ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7Cj4gKwoKRGVsZXRlIHRo
aXMgYmxhbmsgbGluZS4KCj4gKwl1OCBzcF90eF9idzsgLyogbGlua3RyYWluaW5nIGJhbndpZHRo
ICovCj4gKwl1OCBzcF90eF9sYW5lX2NvdW50OyAvKiBsaW5rIHRyYWluaW5nIGxhbmUgY291bnQg
Ki8KPiArCj4gKwlpZiAoY3R4LT5ocGRfaGlnaF9jbnQgPj0gMikgewo+ICsJCURSTV9ERVZfREVC
VUdfRFJJVkVSKGRldiwgImFueDc2MjUgZmlsdGVyIHVzZWxlc3MgSFBEXG4iKTsKPiArCQlyZXR1
cm47Cj4gKwl9Cj4gKwo+ICsJY3R4LT5ocGRfaGlnaF9jbnQrKzsKPiArCj4gKwlzcF90eF9nZXRf
cnhfYncoY3R4LCAmc3BfdHhfYncpOwo+ICsKPiArCXNwX3R4X2F1eF9kcGNkcmVhZF9ieXRlcyhj
dHgsIDB4MDAsIDB4MDAsIERQQ0RfTUFYX0xBTkVfQ09VTlQsCj4gKwkJCQkgMSwgJnNwX3R4X2xh
bmVfY291bnQpOwo+ICsKPiArCXNwX3R4X2xhbmVfY291bnQgPSBzcF90eF9sYW5lX2NvdW50ICYg
MHgxZjsKPiArCXNwX3R4X2F1eF9kcGNkcmVhZF9ieXRlcyhjdHgsIDB4MDYsIDB4ODAsIDB4Mjgs
IDEsIGJ1Zik7LyogcmVhZCBCY2FwICovCj4gKwo+ICsJaGRjcF9jYXAgPSBidWZbMF0gJiAweDAx
Owo+ICsKPiArCS8qIG5vdCBzdXBwb3J0IEhEQ1AgKi8KPiArCXJldCA9IGFueDc2MjVfd3JpdGVf
YW5kKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCAweGVlLCAweDlmKTsKPiArCj4gKwlpZiAo
aGRjcF9jYXAgPT0gMHgwMSkKPiArCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJIRENQMS40
XG4iKTsKPiArCj4gKwkvKiB0cnkgYXV0aCBmbGFnICovCj4gKwlyZXQgfD0gYW54NzYyNV93cml0
ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgMHhlYywgMHgxMCk7Cj4gKwkvKiBpbnRl
cnJ1cHQgZm9yIERSTSAqLwo+ICsJcmV0IHw9IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmky
Yy5yeF9wMV9jbGllbnQsIDB4ZmYsIDB4MDEpOwo+ICsJaWYgKHJldCA8IDApCj4gKwkJcmV0dXJu
Owo+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiTUFYIEJXPSUwMngsIE1BWCBMYW5lIGNu
dD0lMDJ4LCBIRENQPSUwMnhcbiIsCj4gKwkJCSAgICAgKHUzMilzcF90eF9idywKPiArCQkJICAg
ICAodTMyKXNwX3R4X2xhbmVfY291bnQsCj4gKwkJCSAgICAgKHUzMiloZGNwX2NhcCk7Cj4gKwo+
ICsJcmV0ID0gYW54NzYyNV9yZWdfcmVhZChjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgMHg4
Nik7Cj4gKwlpZiAocmV0IDwgMCkKPiArCQlyZXR1cm47Cj4gKwo+ICsJRFJNX0RFVl9ERUJVR19E
UklWRVIoZGV2LCAiU2VjdXJlIE9DTSB2ZXJzaW9uPSUwMnhcbiIsIHJldCk7Cj4gK30KPiArCj4g
K3N0YXRpYyBpbnQgYW54NzYyNV9yZWFkX2hwZF9zdGF0dXNfcDAoc3RydWN0IGFueDc2MjVfZGF0
YSAqY3R4KQo+ICt7Cj4gKwlyZXR1cm4gYW54NzYyNV9yZWdfcmVhZChjdHgsIGN0eC0+aTJjLnJ4
X3AwX2NsaWVudCwgU1lTVEVNX1NUU1RVUyk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGFueDc2
MjVfaHBkX3BvbGxpbmcoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQo+ICt7Cj4gKwlpbnQgcmV0
LCB2YWw7Cj4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKPiArCj4g
KwlpZiAoYXRvbWljX3JlYWQoJmN0eC0+cG93ZXJfc3RhdHVzKSAhPSAxKSB7Cj4gKwkJRFJNX0RF
Vl9ERUJVR19EUklWRVIoZGV2LCAiTm8gbmVlZCB0byBwb2xpbmcgSFBEIHN0YXR1cy5cbiIpOwo+
ICsJCXJldHVybjsKPiArCX0KPiArCj4gKwlyZXQgPSByZWFkeF9wb2xsX3RpbWVvdXQoYW54NzYy
NV9yZWFkX2hwZF9zdGF0dXNfcDAsCj4gKwkJCQkgY3R4LCB2YWwsCj4gKwkJCQkgKCh2YWwgJiBI
UERfU1RBVFVTKSB8fCAodmFsIDwgMCkpLAo+ICsJCQkJIDUwMDAsCj4gKwkJCQkgNTAwMCAqIDEw
MCk7Cj4gKwlpZiAocmV0KSB7Cj4gKwkJRFJNX0RFVl9FUlJPUihkZXYsICJIUEQgcG9sbGluZyB0
aW1lb3V0IVxuIik7Cj4gKwl9IGVsc2Ugewo+ICsJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwg
IkhQRCByYWlzZSB1cC5cbiIpOwo+ICsJCWFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMu
dGNwY19jbGllbnQsCj4gKwkJCQkgIElOVFJfQUxFUlRfMSwgMHhGRik7Cj4gKwkJYW54NzYyNV9y
ZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCj4gKwkJCQkgIElOVEVSRkFDRV9D
SEFOR0VfSU5ULCAwKTsKPiArCX0KPiArCj4gKwlhbng3NjI1X3N0YXJ0X2RwX3dvcmsoY3R4KTsK
PiArfQo+ICsKPiArc3RhdGljIHZvaWQgYW54NzYyNV9kaXNjb25uZWN0X2NoZWNrKHN0cnVjdCBh
bng3NjI1X2RhdGEgKmN0eCkKPiArewo+ICsJaWYgKGF0b21pY19yZWFkKCZjdHgtPnBvd2VyX3N0
YXR1cykgPT0gMCkKPiArCQlhbng3NjI1X3N0b3BfZHBfd29yayhjdHgpOwo+ICt9Cj4gKwo+ICtz
dGF0aWMgdm9pZCBhbng3NjI1X2xvd19wb3dlcl9tb2RlX2NoZWNrKHN0cnVjdCBhbng3NjI1X2Rh
dGEgKmN0eCwKPiArCQkJCQkgaW50IHN0YXRlKQo+ICt7Cj4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYg
PSAmY3R4LT5jbGllbnQtPmRldjsKPiArCj4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJs
b3cgcG93ZXIgbW9kZSBjaGVjaywgc3RhdGUoJWQpLlxuIiwgc3RhdGUpOwo+ICsKPiArCWlmIChj
dHgtPnBkYXRhLmxvd19wb3dlcl9tb2RlKSB7Cj4gKwkJYW54NzYyNV9jaGlwX2NvbnRyb2woY3R4
LCBzdGF0ZSk7Cj4gKwkJaWYgKHN0YXRlKQo+ICsJCQlhbng3NjI1X2hwZF9wb2xsaW5nKGN0eCk7
Cj4gKwkJZWxzZQo+ICsJCQlhbng3NjI1X2Rpc2Nvbm5lY3RfY2hlY2soY3R4KTsKPiArCX0KPiAr
fQo+ICsKPiArc3RhdGljIHZvaWQgZHBfaHBkX2NoYW5nZV9oYW5kbGVyKHN0cnVjdCBhbng3NjI1
X2RhdGEgKmN0eCwgYm9vbCBvbikKPiArewo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+
Y2xpZW50LT5kZXY7Cj4gKwo+ICsJLyogaHBkIGNoYW5nZWQgKi8KPiArCURSTV9ERVZfREVCVUdf
RFJJVkVSKGRldiwgImRwX2hwZF9jaGFuZ2VfZGVmYXVsdF9mdW5jOiAlZFxuIiwKPiArCQkJICAg
ICAodTMyKW9uKTsKPiArCj4gKwlpZiAob24gPT0gMCkgewo+ICsJCURSTV9ERVZfREVCVUdfRFJJ
VkVSKGRldiwgIiBIUEQgbG93XG4iKTsKPiArCQlhbng3NjI1X3N0b3BfZHBfd29yayhjdHgpOwo+
ICsJfSBlbHNlIHsKPiArCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICIgSFBEIGhpZ2hcbiIp
Owo+ICsJCWFueDc2MjVfc3RhcnRfZHBfd29yayhjdHgpOwo+ICsJfQo+ICsKPiArCWN0eC0+aHBk
X3N0YXR1cyA9IDE7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgYW54NzYyNV9ocGRfY2hhbmdlX2Rl
dGVjdChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gK3sKPiArCWludCBpbnRyX3ZlY3Rvciwg
c3RhdHVzOwo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7Cj4gKwo+
ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAicG93ZXJfc3RhdHVzPSVkXG4iLAo+ICsJCQkg
ICAgICh1MzIpYXRvbWljX3JlYWQoJmN0eC0+cG93ZXJfc3RhdHVzKSk7Cj4gKwo+ICsJc3RhdHVz
ID0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy50Y3BjX2NsaWVudCwKPiArCQkJCSAg
IElOVFJfQUxFUlRfMSwgMHhGRik7Cj4gKwlpZiAoc3RhdHVzIDwgMCkgewo+ICsJCURSTV9FUlJP
UigiSU8gZXJyb3IgOiBjbGVhciBhbGVydCByZWdpc3Rlci5cbiIpOwo+ICsJCXJldHVybiBzdGF0
dXM7Cj4gKwl9Cj4gKwo+ICsJaW50cl92ZWN0b3IgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY3R4
LT5pMmMucnhfcDBfY2xpZW50LAo+ICsJCQkJICAgICAgIElOVEVSRkFDRV9DSEFOR0VfSU5UKTsK
PiArCWlmIChpbnRyX3ZlY3RvciA8IDApIHsKPiArCQlEUk1fRVJST1IoIklPIGVycm9yIDogYWNj
ZXNzIGludGVycnVwdCBjaGFuZ2UgcmVnaXN0ZXIuXG4iKTsKPiArCQlyZXR1cm4gaW50cl92ZWN0
b3I7Cj4gKwl9Cj4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICIweDdlOjB4NDQ9JXhcbiIs
IGludHJfdmVjdG9yKTsKPiArCXN0YXR1cyA9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5p
MmMucnhfcDBfY2xpZW50LAo+ICsJCQkJICAgSU5URVJGQUNFX0NIQU5HRV9JTlQsCj4gKwkJCQkg
ICBpbnRyX3ZlY3RvciAmICh+aW50cl92ZWN0b3IpKTsKPiArCWlmIChzdGF0dXMgPCAwKSB7Cj4g
KwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGNsZWFyIGludGVycnVwdCBjaGFuZ2UgcmVnaXN0ZXIu
XG4iKTsKPiArCQlyZXR1cm4gc3RhdHVzOwo+ICsJfQo+ICsKPiArCWlmIChpbnRyX3ZlY3RvciAm
IEhQRF9TVEFUVVNfQ0hBTkdFKSB7CgpSZXZlcnNlIHRoaXMgY29uZGl0aW9uLiAgV2UgYWx3YXlz
IHdhbnQgdGhlIG5vcm1hbC9zdWNjZXNzIHBhdGgKaW5kZW50ZWQgb25lIHRhYiBhbmQgdGhlIHdl
aXJkL2Vycm9yIHBhdGggaW5kZW50ZWQgdHdvIHRhYnMuCgoJaWYgKHN0YXR1cyA8IDApIHsKCQlE
Uk1fRVJST1IoIklPIGVycm9yIDogY2xlYXIgaW50ZXJydXB0IGNoYW5nZSByZWdpc3Rlci5cbiIp
OwoJCXJldHVybiBzdGF0dXM7Cgl9CglpZiAoIShpbnRyX3ZlY3RvciAmIEhQRF9TVEFUVVNfQ0hB
TkdFKSkKCQlyZXR1cm4gLUVOT0VOVDsKCj4gKwkJc3RhdHVzID0gYW54NzYyNV9yZWdfcmVhZChj
dHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKPiArCQkJCQkgIFNZU1RFTV9TVFNUVVMpOwo+ICsJ
CWlmIChzdGF0dXMgPCAwKSB7Cj4gKwkJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBjbGVhciBpbnRl
cnJ1cHQgc3RhdHVzLlxuIik7Cj4gKwkJCXJldHVybiBzdGF0dXM7Cj4gKwkJfQo+ICsKPiArCQlE
Uk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICIweDdlOjB4NDU9JXhcbiIsIHN0YXR1cyk7Cj4gKwkJ
ZHBfaHBkX2NoYW5nZV9oYW5kbGVyKGN0eCwgc3RhdHVzICYgSFBEX1NUQVRVUyk7Cj4gKwkJcmV0
dXJuIDA7Cj4gKwl9Cj4gKwo+ICsJcmV0dXJuIC1FTk9FTlQ7Cj4gK30KPiArCj4gK3N0YXRpYyB2
b2lkIGFueDc2MjVfd29ya19mdW5jKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiArewo+ICsJ
aW50IGV2ZW50Owo+ICsJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0gY29udGFpbmVyX29mKHdv
cmssCj4gKwkJCQkJCXN0cnVjdCBhbng3NjI1X2RhdGEsIHdvcmspOwo+ICsKPiArCW11dGV4X2xv
Y2soJmN0eC0+bG9jayk7Cj4gKwlldmVudCA9IGFueDc2MjVfaHBkX2NoYW5nZV9kZXRlY3QoY3R4
KTsKPiArCW11dGV4X3VubG9jaygmY3R4LT5sb2NrKTsKPiArCj4gKwlpZiAoZXZlbnQgPCAwKQo+
ICsJCXJldHVybjsKPiArCj4gKwlpZiAoY3R4LT5icmlkZ2VfYXR0YWNoZWQpCj4gKwkJZHJtX2hl
bHBlcl9ocGRfaXJxX2V2ZW50KGN0eC0+Y29ubmVjdG9yLmRldik7Cj4gK30KPiArCj4gK3N0YXRp
YyBpcnFyZXR1cm5fdCBhbng3NjI1X2ludHJfaHBkX2lzcihpbnQgaXJxLCB2b2lkICpkYXRhKQo+
ICt7Cj4gKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHggPSAoc3RydWN0IGFueDc2MjVfZGF0YSAq
KWRhdGE7Cj4gKwo+ICsJaWYgKGF0b21pY19yZWFkKCZjdHgtPnBvd2VyX3N0YXR1cykgIT0gMSkK
PiArCQlyZXR1cm4gSVJRX05PTkU7Cj4gKwo+ICsJcXVldWVfd29yayhjdHgtPndvcmtxdWV1ZSwg
JmN0eC0+d29yayk7Cj4gKwo+ICsJcmV0dXJuIElSUV9IQU5ETEVEOwo+ICt9Cj4gKwo+ICsjaWZk
ZWYgQ09ORklHX09GCj4gK3N0YXRpYyBpbnQgYW54NzYyNV9wYXJzZV9kdChzdHJ1Y3QgZGV2aWNl
ICpkZXYsCj4gKwkJCSAgICBzdHJ1Y3QgYW54NzYyNV9wbGF0Zm9ybV9kYXRhICpwZGF0YSkKPiAr
ewo+ICsJc3RydWN0IGRldmljZV9ub2RlICpucCA9IGRldi0+b2Zfbm9kZTsKPiArCXN0cnVjdCBk
ZXZpY2Vfbm9kZSAqbWlwaV9ob3N0X25vZGU7Cj4gKwlzdHJ1Y3QgZGV2aWNlX25vZGUgKnBhbmVs
X25vZGUsICpvdXRfZXA7Cj4gKwo+ICsJcGRhdGEtPm5vZGUubWlwaV9kc2lfaG9zdF9ub2RlID0g
b2ZfZ3JhcGhfZ2V0X3JlbW90ZV9ub2RlKG5wLCAwLCAwKTsKPiArCWlmIChwZGF0YS0+bm9kZS5t
aXBpX2RzaV9ob3N0X25vZGUpIHsKPiArCQlvZl9ub2RlX3B1dChwZGF0YS0+bm9kZS5taXBpX2Rz
aV9ob3N0X25vZGUpOwo+ICsJCXBkYXRhLT5kc2lfc3VwcG9ydGVkID0gMTsKPiArCQltaXBpX2hv
c3Rfbm9kZSA9IHBkYXRhLT5ub2RlLm1pcGlfZHNpX2hvc3Rfbm9kZTsKPiArCX0gZWxzZSB7Cj4g
KwkJcGRhdGEtPm5vZGUubWlwaV9kcGlfaG9zdF9ub2RlID0KPiArCQkJb2ZfZ3JhcGhfZ2V0X3Jl
bW90ZV9ub2RlKG5wLCAxLCAwKTsKPiArCQlpZiAoIXBkYXRhLT5ub2RlLm1pcGlfZHBpX2hvc3Rf
bm9kZSkKPiArCQkJRFJNX0VSUk9SKCJjYW5ub3QgcmVzb2x2ZSBhbnkgTUlQSSBob3N0IG5vZGUu
XG4iKTsKPiArCQllbHNlCj4gKwkJCW9mX25vZGVfcHV0KHBkYXRhLT5ub2RlLm1pcGlfZHBpX2hv
c3Rfbm9kZSk7Cj4gKwo+ICsJCW1pcGlfaG9zdF9ub2RlID0gcGRhdGEtPm5vZGUubWlwaV9kcGlf
aG9zdF9ub2RlOwo+ICsJfQo+ICsKPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRzaV9z
dXBwb3J0ZWQgOiAlZFxuIiwgcGRhdGEtPmRzaV9zdXBwb3J0ZWQpOwo+ICsJRFJNX0RFVl9ERUJV
R19EUklWRVIoZGV2LCAibWlwaSBob3N0IG5vZGUgJXMgZXhpc3RcbiIsCj4gKwkJCSAgICAgKCFt
aXBpX2hvc3Rfbm9kZSkgPyAibm90IiA6ICIgIik7CgpUaGlzIGRlYnVnIG1lc3NhZ2UgaXMgcG9p
bnRsZXMgYmVjYXVzZSBpZiBtaXBpX2hvc3Rfbm9kZSBpcyBOVUxMIHRoZW4Kd2UgYWxyZWFkeSBw
cmludGVkIGFuIGVycm9yIG1lc3NhZ2UuICBEZWxldGUgdGhlIG1pcGlfaG9zdF9ub2RlIHZhcmlh
YmxlCmFzIHdlbGwuCgo+ICsKPiArCXBkYXRhLT5ub2RlLmV4dGNvbl9ub2RlID0gb2ZfZ3JhcGhf
Z2V0X3BvcnRfYnlfaWQobnAsIDIpOwo+ICsJcGRhdGEtPm5vZGUuaW50ZXJuYWxfcGFuZWxfbm9k
ZSA9IG9mX2dyYXBoX2dldF9wb3J0X2J5X2lkKG5wLCAzKTsKPiArCXBkYXRhLT5ub2RlLmVkcF9u
b2RlID0gb2ZfZ3JhcGhfZ2V0X3BvcnRfYnlfaWQobnAsIDQpOwo+ICsJaWYgKHBkYXRhLT5ub2Rl
LmV4dGNvbl9ub2RlKQo+ICsJCXBkYXRhLT5leHRjb25fc3VwcG9ydGVkID0gMTsKPiArCj4gKwlp
ZiAocGRhdGEtPm5vZGUuaW50ZXJuYWxfcGFuZWxfbm9kZSkgewo+ICsJCXBkYXRhLT5pbnRlcm5h
bF9wYW5lbCA9IDE7Cj4gKwkJb2Zfbm9kZV9wdXQocGRhdGEtPm5vZGUuaW50ZXJuYWxfcGFuZWxf
bm9kZSk7Cj4gKwkJb3V0X2VwID0gb2ZfZ2V0X2NoaWxkX2J5X25hbWUocGRhdGEtPm5vZGUuaW50
ZXJuYWxfcGFuZWxfbm9kZSwKPiArCQkJCQkgICAgICAiZW5kcG9pbnQiKTsKPiArCQlpZiAob3V0
X2VwKSB7CgpSZXZlcnNlIHRoaXMgY29uZGl0aW9uLiAgRXJyb3IgcGF0aCBpcyBpbmRlbnRlZCwg
c3VjY2VzcyBwYXRoIGlzIG5vdC4KCj4gKwkJCXBhbmVsX25vZGUgPSBvZl9ncmFwaF9nZXRfcmVt
b3RlX3BvcnRfcGFyZW50KG91dF9lcCk7Cj4gKwkJCW9mX25vZGVfcHV0KG91dF9lcCk7Cj4gKwo+
ICsJCQlwZGF0YS0+cGFuZWwgPSBvZl9kcm1fZmluZF9wYW5lbChwYW5lbF9ub2RlKTsKPiArCQkJ
RFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZ2V0IHBhbmVsIG5vZGUuXG4iKTsKPiArCQkJb2Zf
bm9kZV9wdXQocGFuZWxfbm9kZSk7Cj4gKwkJCWlmIChJU19FUlJfT1JfTlVMTChwZGF0YS0+cGFu
ZWwpKQo+ICsJCQkJcmV0dXJuIC1FUFJPQkVfREVGRVI7Cj4gKwkJfSBlbHNlIHsKPiArCQkJRFJN
X0RFVl9ERUJVR19EUklWRVIoZGV2LCAiY2Fubm90IGdldCBlbmRwb2ludC5cbiIpOwo+ICsJCQly
ZXR1cm4gLUVQUk9CRV9ERUZFUjsKPiArCQl9Cj4gKwl9Cj4gKwo+ICsJRFJNX0RFVl9ERUJVR19E
UklWRVIoZGV2LCAiJXMgc3VwcG9ydCBleHRjb24sICVzIGludGVybmFsIHBhbmVsXG4iLAo+ICsJ
CQkgICAgIHBkYXRhLT5leHRjb25fc3VwcG9ydGVkID8gIiIgOiAibm90IiwKPiArCQkJICAgICBw
ZGF0YS0+aW50ZXJuYWxfcGFuZWwgPyAiaGFzIiA6ICJubyIpOwo+ICsKPiArCXJldHVybiAwOwo+
ICt9Cj4gKyNlbHNlCj4gK3N0YXRpYyBpbnQgYW54NzYyNV9wYXJzZV9kdChzdHJ1Y3QgZGV2aWNl
ICpkZXYsCj4gKwkJCSAgICBzdHJ1Y3QgYW54NzYyNV9wbGF0Zm9ybV9kYXRhICpwZGF0YSkKPiAr
ewo+ICsJcmV0dXJuIC1FTk9ERVY7Cj4gK30KPiArI2VuZGlmCj4gKwo+ICtzdGF0aWMgaW5saW5l
IHN0cnVjdCBhbng3NjI1X2RhdGEgKmNvbm5lY3Rvcl90b19hbng3NjI1KHN0cnVjdCBkcm1fY29u
bmVjdG9yICpjKQo+ICt7Cj4gKwlyZXR1cm4gY29udGFpbmVyX29mKGMsIHN0cnVjdCBhbng3NjI1
X2RhdGEsIGNvbm5lY3Rvcik7Cj4gK30KPiArCj4gK3N0YXRpYyBpbmxpbmUgc3RydWN0IGFueDc2
MjVfZGF0YSAqYnJpZGdlX3RvX2FueDc2MjUoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSkKPiAr
ewo+ICsJcmV0dXJuIGNvbnRhaW5lcl9vZihicmlkZ2UsIHN0cnVjdCBhbng3NjI1X2RhdGEsIGJy
aWRnZSk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGFueDc2MjVfcG9zdF9kaXNhYmxlKHN0cnVj
dCBkcm1fYnJpZGdlICpicmlkZ2UpCj4gK3sKPiArCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCA9
IGJyaWRnZV90b19hbng3NjI1KGJyaWRnZSk7Cj4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4
LT5jbGllbnQtPmRldjsKPiArCWludCByZXQ7Cj4gKwo+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIo
ZGV2LCAicG9zdCBkaXNhYmxlXG4iKTsKPiArCWlmIChjdHgtPnBkYXRhLnBhbmVsKSB7CgpSZXZl
cnNlLgoKPiArCQlyZXQgPSBkcm1fcGFuZWxfdW5wcmVwYXJlKGN0eC0+cGRhdGEucGFuZWwpOwo+
ICsJCWlmIChyZXQpCj4gKwkJCURSTV9FUlJPUigiZmFpbGVkIHRvIHVucHJlcGFyZSBwYW5lbDog
JWRcbiIsIHJldCk7Cj4gKwkJZWxzZQo+ICsJCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJi
YWNrbGlnaHQgdW5wcmVwYXJlZC5cbiIpOwo+ICsKPiArCQlhdG9taWNfc2V0KCZjdHgtPnBhbmVs
X3Bvd2VyLCAwKTsKPiArCX0KPiArfQo+ICsKPiArc3RhdGljIHZvaWQgYW54NzYyNV9wcmVfZW5h
YmxlKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UpCj4gK3sKPiArCXN0cnVjdCBhbng3NjI1X2Rh
dGEgKmN0eCA9IGJyaWRnZV90b19hbng3NjI1KGJyaWRnZSk7Cj4gKwlzdHJ1Y3QgZGV2aWNlICpk
ZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKPiArCWludCByZXQ7Cj4gKwo+ICsJRFJNX0RFVl9ERUJV
R19EUklWRVIoZGV2LCAicHJlIGVuYWJsZVxuIik7Cj4gKwlpZiAoY3R4LT5wZGF0YS5wYW5lbCkg
ewoKUmV2ZXJzZS4KCj4gKwkJcmV0ID0gZHJtX3BhbmVsX3ByZXBhcmUoY3R4LT5wZGF0YS5wYW5l
bCk7Cj4gKwkJaWYgKHJldCA8IDApCj4gKwkJCURSTV9FUlJPUigiZmFpbGVkIHRvIHByZXBhcmUg
cGFuZWw6ICVkXG4iLCByZXQpOwo+ICsJCWVsc2UKPiArCQkJRFJNX0RFVl9ERUJVR19EUklWRVIo
ZGV2LCAiYmFja2xpZ2h0IHByZXBhcmVkLlxuIik7Cj4gKwkJYXRvbWljX3NldCgmY3R4LT5wYW5l
bF9wb3dlciwgMSk7Cj4gKwl9Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgYW54NzYyNV9nZXRfbW9k
ZXMoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiArewo+ICsJc3RydWN0IGFueDc2
MjVfZGF0YSAqY3R4ID0gY29ubmVjdG9yX3RvX2FueDc2MjUoY29ubmVjdG9yKTsKPiArCWludCBl
cnIsIG51bV9tb2RlcyA9IDA7Cj4gKwlpbnQgdHVybl9vZmZfZmxhZyA9IDA7Cj4gKwlzdHJ1Y3Qg
c19lZGlkX2RhdGEgKnBfZWRpZCA9ICZjdHgtPnNsaW1wb3J0X2VkaWRfcDsKPiArCXN0cnVjdCBk
ZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ICsKPiArCURSTV9ERVZfREVCVUdfRFJJ
VkVSKGRldiwgImRybSBnZXQgbW9kZXNcbiIpOwo+ICsKPiArCWlmIChjdHgtPnNsaW1wb3J0X2Vk
aWRfcC5lZGlkX2Jsb2NrX251bSA+IDApCj4gKwkJZ290byBvdXQ7Cj4gKwo+ICsJbXV0ZXhfbG9j
aygmY3R4LT5sb2NrKTsKPiArCj4gKwlpZiAoY3R4LT5wZGF0YS5wYW5lbCAmJiBhdG9taWNfcmVh
ZCgmY3R4LT5wYW5lbF9wb3dlcikgPT0gMCkgewo+ICsJCXR1cm5fb2ZmX2ZsYWcgPSAxOwo+ICsJ
CWFueDc2MjVfcHJlX2VuYWJsZSgmY3R4LT5icmlkZ2UpOwo+ICsJfQo+ICsKPiArCWFueDc2MjVf
bG93X3Bvd2VyX21vZGVfY2hlY2soY3R4LCAxKTsKPiArCj4gKwlwX2VkaWQtPmVkaWRfYmxvY2tf
bnVtID0gc3BfdHhfZWRpZF9yZWFkKGN0eCwgcF9lZGlkLT5lZGlkX3Jhd19kYXRhKTsKPiArCj4g
KwllcnIgPSAtRUlPOwo+ICsJaWYgKHBfZWRpZC0+ZWRpZF9ibG9ja19udW0gPCAwKSB7Cj4gKwkJ
RFJNX0VSUk9SKCJGYWlsZWQgdG8gcmVhZCBFRElELlxuIik7Cj4gKwkJZ290byBmYWlsOwo+ICsJ
fQo+ICsKPiArCWVyciA9IGRybV9jb25uZWN0b3JfdXBkYXRlX2VkaWRfcHJvcGVydHkoY29ubmVj
dG9yLAo+ICsJCQkJCQkgKHN0cnVjdCBlZGlkICopCj4gKwkJCQkJCSAmcF9lZGlkLT5lZGlkX3Jh
d19kYXRhKTsKPiArCj4gKwlpZiAoZXJyKQo+ICsJCURSTV9FUlJPUigiRmFpbGVkIHRvIHVwZGF0
ZSBFRElEIHByb3BlcnR5OiAlZFxuIiwgZXJyKTsKPiArCj4gK2ZhaWw6Cj4gKwltdXRleF91bmxv
Y2soJmN0eC0+bG9jayk7Cj4gKwlhbng3NjI1X2xvd19wb3dlcl9tb2RlX2NoZWNrKGN0eCwgMCk7
Cj4gKwlpZiAoY3R4LT5wZGF0YS5wYW5lbCAmJiB0dXJuX29mZl9mbGFnID09IDEpCj4gKwkJYW54
NzYyNV9wb3N0X2Rpc2FibGUoJmN0eC0+YnJpZGdlKTsKPiArCj4gKwlpZiAoZXJyKQo+ICsJCXJl
dHVybiBlcnI7Cj4gKwo+ICtvdXQ6Cj4gKwludW1fbW9kZXMgPSBkcm1fYWRkX2VkaWRfbW9kZXMo
Y29ubmVjdG9yLAo+ICsJCQkJICAgICAgIChzdHJ1Y3QgZWRpZCAqKSZwX2VkaWQtPmVkaWRfcmF3
X2RhdGEpOwo+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAibnVtX21vZGVzKCVkKVxuIiwg
bnVtX21vZGVzKTsKPiArCj4gKwlyZXR1cm4gbnVtX21vZGVzOwo+ICt9Cj4gKwo+ICtzdGF0aWMg
ZW51bSBkcm1fbW9kZV9zdGF0dXMKPiArYW54NzYyNV9jb25uZWN0b3JfbW9kZV92YWxpZChzdHJ1
Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+ICsJCQkgICAgIHN0cnVjdCBkcm1fZGlzcGxh
eV9tb2RlICptb2RlKQo+ICt7Cj4gKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHggPSBjb25uZWN0
b3JfdG9fYW54NzYyNShjb25uZWN0b3IpOwo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+
Y2xpZW50LT5kZXY7Cj4gKwo+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZHJtIG1vZGVz
IHZhbGlkIHZlcmlmeVxuIik7Cj4gKwo+ICsJaWYgKG1vZGUtPmNsb2NrID4gMzAwMDAwKQoKTWFr
ZSBhbGwgdGhlIHJlZmVyZW5jZXMgdG8gMzAwMDAwIGEgZGVmaW5lLgoKPiArCQlyZXR1cm4gTU9E
RV9DTE9DS19ISUdIOwo+ICsKPiArCXJldHVybiBNT0RFX09LOwo+ICt9Cj4gKwo+ICtzdGF0aWMg
c3RydWN0IGRybV9jb25uZWN0b3JfaGVscGVyX2Z1bmNzIGFueDc2MjVfY29ubmVjdG9yX2hlbHBl
cl9mdW5jcyA9IHsKPiArCS5nZXRfbW9kZXMgPSBhbng3NjI1X2dldF9tb2RlcywKPiArCS5tb2Rl
X3ZhbGlkID0gYW54NzYyNV9jb25uZWN0b3JfbW9kZV92YWxpZCwKPiArfTsKPiArCj4gK3N0YXRp
YyBlbnVtIGRybV9jb25uZWN0b3Jfc3RhdHVzIGFueDc2MjVfZGV0ZWN0KHN0cnVjdCBkcm1fY29u
bmVjdG9yICpjb25uZWN0b3IsCj4gKwkJCQkJCWJvb2wgZm9yY2UpCj4gK3sKPiArCXN0cnVjdCBh
bng3NjI1X2RhdGEgKmN0eCA9IGNvbm5lY3Rvcl90b19hbng3NjI1KGNvbm5lY3Rvcik7Cj4gKwlz
dHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKPiArCj4gKwlEUk1fREVWX0RF
QlVHX0RSSVZFUihkZXYsICJkcm0gZGV0ZWN0XG4iKTsKPiArCj4gKwlpZiAoY3R4LT5wZGF0YS5p
bnRlcm5hbF9wYW5lbCkKPiArCQlyZXR1cm4gY29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQ7Cj4g
Kwo+ICsJaWYgKCFjdHgtPmhwZF9zdGF0dXMpCj4gKwkJcmV0dXJuIGNvbm5lY3Rvcl9zdGF0dXNf
ZGlzY29ubmVjdGVkOwo+ICsKPiArCXJldHVybiBjb25uZWN0b3Jfc3RhdHVzX2Nvbm5lY3RlZDsK
PiArfQo+ICsKPiArc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX2Z1bmNzIGFueDc2
MjVfY29ubmVjdG9yX2Z1bmNzID0gewo+ICsJLmZpbGxfbW9kZXMgPSBkcm1faGVscGVyX3Byb2Jl
X3NpbmdsZV9jb25uZWN0b3JfbW9kZXMsCj4gKwkuZGV0ZWN0ID0gYW54NzYyNV9kZXRlY3QsCj4g
KwkuZGVzdHJveSA9IGRybV9jb25uZWN0b3JfY2xlYW51cCwKPiArCS5yZXNldCA9IGRybV9hdG9t
aWNfaGVscGVyX2Nvbm5lY3Rvcl9yZXNldCwKPiArCS5hdG9taWNfZHVwbGljYXRlX3N0YXRlID0g
ZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2R1cGxpY2F0ZV9zdGF0ZSwKPiArCS5hdG9taWNf
ZGVzdHJveV9zdGF0ZSA9IGRybV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9kZXN0cm95X3N0YXRl
LAo+ICt9Owo+ICsKPiArc3RhdGljIHZvaWQgYW54NzYyNV9hdHRhY2hfZHNpKHN0cnVjdCBhbng3
NjI1X2RhdGEgKmN0eCkKPiArewo+ICsJc3RydWN0IG1pcGlfZHNpX2hvc3QgKmhvc3Q7Cj4gKwlz
dHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2k7Cj4gKwlzdHJ1Y3QgZGV2aWNlX25vZGUgKm1pcGlf
aG9zdF9ub2RlOwo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7Cj4g
Kwljb25zdCBzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlX2luZm8gaW5mbyA9IHsKPiArCQkudHlwZSA9
ICJhbng3NjI1IiwKPiArCQkuY2hhbm5lbCA9IDAsCj4gKwkJLm5vZGUgPSBOVUxMLAo+ICsJfTsK
PiArCj4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJhdHRhY2ggZHNpXG4iKTsKPiArCj4g
KwlpZiAoY3R4LT5wZGF0YS5kc2lfc3VwcG9ydGVkKQo+ICsJCW1pcGlfaG9zdF9ub2RlID0gY3R4
LT5wZGF0YS5ub2RlLm1pcGlfZHNpX2hvc3Rfbm9kZTsKPiArCWVsc2UKPiArCQltaXBpX2hvc3Rf
bm9kZSA9IGN0eC0+cGRhdGEubm9kZS5taXBpX2RwaV9ob3N0X25vZGU7Cj4gKwo+ICsJaWYgKCFt
aXBpX2hvc3Rfbm9kZSkgewo+ICsJCURSTV9FUlJPUigiZHNpIGhvc3QgaXMgbm90IGNvbmZpZ3Vy
ZWQuXG4iKTsKPiArCQlyZXR1cm47Cj4gKwl9Cj4gKwo+ICsJaG9zdCA9IG9mX2ZpbmRfbWlwaV9k
c2lfaG9zdF9ieV9ub2RlKG1pcGlfaG9zdF9ub2RlKTsKPiArCWlmICghaG9zdCkgewo+ICsJCURS
TV9FUlJPUigiZmFpbGVkIHRvIGZpbmQgZHNpIGhvc3QuXG4iKTsKPiArCQlyZXR1cm47Cj4gKwl9
Cj4gKwo+ICsJZHNpID0gbWlwaV9kc2lfZGV2aWNlX3JlZ2lzdGVyX2Z1bGwoaG9zdCwgJmluZm8p
Owo+ICsJaWYgKElTX0VSUihkc2kpKSB7Cj4gKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gY3JlYXRl
IGRzaSBkZXZpY2UuXG4iKTsKPiArCQlyZXR1cm47Cj4gKwl9Cj4gKwo+ICsJZHNpLT5sYW5lcyA9
IDQ7Cj4gKwlkc2ktPmZvcm1hdCA9IE1JUElfRFNJX0ZNVF9SR0I4ODg7Cj4gKwlkc2ktPm1vZGVf
ZmxhZ3MgPSBNSVBJX0RTSV9NT0RFX1ZJREVPCXwKPiArCQlNSVBJX0RTSV9NT0RFX1ZJREVPX1NZ
TkNfUFVMU0UJfAo+ICsJCU1JUElfRFNJX01PREVfRU9UX1BBQ0tFVAl8Cj4gKwkJTUlQSV9EU0lf
TU9ERV9WSURFT19IU0U7Cj4gKwo+ICsJaWYgKG1pcGlfZHNpX2F0dGFjaChkc2kpIDwgMCkgewo+
ICsJCURSTV9FUlJPUigiZmFpbGVkIHRvIGF0dGFjaCBkc2kgdG8gaG9zdC5cbiIpOwo+ICsJCW1p
cGlfZHNpX2RldmljZV91bnJlZ2lzdGVyKGRzaSk7Cj4gKwkJcmV0dXJuOwo+ICsJfQo+ICsKPiAr
CWN0eC0+ZHNpID0gZHNpOwo+ICsKPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImF0dGFj
aCBkc2kgc3VjY2VlZGVkLlxuIik7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGFueDc2MjVfZGV0
YWNoX2RzaShzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCj4gK3sKPiArCWlmIChjdHgtPmRzaSkg
ewo+ICsJCW1pcGlfZHNpX2RldGFjaChjdHgtPmRzaSk7Cj4gKwkJbWlwaV9kc2lfZGV2aWNlX3Vu
cmVnaXN0ZXIoY3R4LT5kc2kpOwo+ICsJfQo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGFueDc2MjVf
YnJpZGdlX2F0dGFjaChzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQo+ICt7Cj4gKwlzdHJ1Y3Qg
YW54NzYyNV9kYXRhICpjdHggPSBicmlkZ2VfdG9fYW54NzYyNShicmlkZ2UpOwo+ICsJaW50IGVy
cjsKPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ICsKPiArCURS
TV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRybSBhdHRhY2hcbiIpOwo+ICsJaWYgKCFicmlkZ2Ut
PmVuY29kZXIpIHsKPiArCQlEUk1fRVJST1IoIlBhcmVudCBlbmNvZGVyIG9iamVjdCBub3QgZm91
bmQiKTsKPiArCQlyZXR1cm4gLUVOT0RFVjsKPiArCX0KPiArCj4gKwllcnIgPSBkcm1fY29ubmVj
dG9yX2luaXQoYnJpZGdlLT5kZXYsICZjdHgtPmNvbm5lY3RvciwKPiArCQkJCSAmYW54NzYyNV9j
b25uZWN0b3JfZnVuY3MsCj4gKwkJCQkgRFJNX01PREVfQ09OTkVDVE9SX0Rpc3BsYXlQb3J0KTsK
PiArCWlmIChlcnIpIHsKPiArCQlEUk1fRVJST1IoIkZhaWxlZCB0byBpbml0aWFsaXplIGNvbm5l
Y3RvcjogJWRcbiIsIGVycik7Cj4gKwkJcmV0dXJuIGVycjsKPiArCX0KPiArCj4gKwlkcm1fY29u
bmVjdG9yX2hlbHBlcl9hZGQoJmN0eC0+Y29ubmVjdG9yLAo+ICsJCQkJICZhbng3NjI1X2Nvbm5l
Y3Rvcl9oZWxwZXJfZnVuY3MpOwo+ICsKPiArCWVyciA9IGRybV9jb25uZWN0b3JfcmVnaXN0ZXIo
JmN0eC0+Y29ubmVjdG9yKTsKPiArCWlmIChlcnIpIHsKPiArCQlEUk1fRVJST1IoIkZhaWxlZCB0
byByZWdpc3RlciBjb25uZWN0b3I6ICVkXG4iLCBlcnIpOwo+ICsJCXJldHVybiBlcnI7Cj4gKwl9
Cj4gKwo+ICsJY3R4LT5jb25uZWN0b3IucG9sbGVkID0gRFJNX0NPTk5FQ1RPUl9QT0xMX0hQRDsK
PiArCj4gKwllcnIgPSBkcm1fY29ubmVjdG9yX2F0dGFjaF9lbmNvZGVyKCZjdHgtPmNvbm5lY3Rv
ciwgYnJpZGdlLT5lbmNvZGVyKTsKPiArCWlmIChlcnIpIHsKPiArCQlEUk1fRVJST1IoIkZhaWxl
ZCB0byBsaW5rIHVwIGNvbm5lY3RvciB0byBlbmNvZGVyOiAlZFxuIiwgZXJyKTsKPiArCQlkcm1f
Y29ubmVjdG9yX3VucmVnaXN0ZXIoJmN0eC0+Y29ubmVjdG9yKTsKPiArCQlyZXR1cm4gZXJyOwo+
ICsJfQo+ICsKPiArCWFueDc2MjVfYXR0YWNoX2RzaShjdHgpOwo+ICsKPiArCWN0eC0+YnJpZGdl
X2F0dGFjaGVkID0gMTsKPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIGVudW0g
ZHJtX21vZGVfc3RhdHVzCj4gK2FueDc2MjVfYnJpZGdlX21vZGVfdmFsaWQoc3RydWN0IGRybV9i
cmlkZ2UgKmJyaWRnZSwKPiArCQkJICBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9k
ZSkKPiArewo+ICsJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0gYnJpZGdlX3RvX2FueDc2MjUo
YnJpZGdlKTsKPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ICsK
PiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRybSBtb2RlIGNoZWNraW5nXG4iKTsKPiAr
Cj4gKwkvKiBNYXggMTIwMHAgYXQgNS40IEdoeiwgb25lIGxhbmUsIHBpeGVsIGNsb2NrIDMwME0g
Ki8KPiArCWlmIChtb2RlLT5jbG9jayA+IDMwMDAwMCkgewo+ICsJCURSTV9ERVZfREVCVUdfRFJJ
VkVSKGRldiwKPiArCQkJCSAgICAgImRybSBtb2RlIGludmFsaWQsIHBpeGVsY2xvY2sgdG9vIGhp
Z2guXG4iKTsKPiArCQlyZXR1cm4gTU9ERV9DTE9DS19ISUdIOwo+ICsJfQo+ICsKPiArCURSTV9E
RVZfREVCVUdfRFJJVkVSKGRldiwgImRybSBtb2RlIHZhbGlkLlxuIik7Cj4gKwo+ICsJcmV0dXJu
IE1PREVfT0s7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGFueDc2MjVfYnJpZGdlX21vZGVfc2V0
KHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UsCj4gKwkJCQkgICAgY29uc3Qgc3RydWN0IGRybV9k
aXNwbGF5X21vZGUgKm9sZF9tb2RlLAo+ICsJCQkJICAgIGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxh
eV9tb2RlICptb2RlKQo+ICt7Cj4gKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHggPSBicmlkZ2Vf
dG9fYW54NzYyNShicmlkZ2UpOwo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50
LT5kZXY7Cj4gKwo+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZHJtIG1vZGUgc2V0XG4i
KTsKPiArCj4gKwltdXRleF9sb2NrKCZjdHgtPmxvY2spOwo+ICsKPiArCWN0eC0+ZHQucGl4ZWxj
bG9jay5taW4gPSBtb2RlLT5jbG9jazsKPiArCWN0eC0+ZHQuaGFjdGl2ZS5taW4gPSBtb2RlLT5o
ZGlzcGxheTsKPiArCWN0eC0+ZHQuaHN5bmNfbGVuLm1pbiA9IG1vZGUtPmhzeW5jX2VuZCAtIG1v
ZGUtPmhzeW5jX3N0YXJ0Owo+ICsJY3R4LT5kdC5oZnJvbnRfcG9yY2gubWluID0gbW9kZS0+aHN5
bmNfc3RhcnQgLSBtb2RlLT5oZGlzcGxheTsKPiArCWN0eC0+ZHQuaGJhY2tfcG9yY2gubWluID0g
bW9kZS0+aHRvdGFsIC0gbW9kZS0+aHN5bmNfZW5kOwo+ICsJY3R4LT5kdC52YWN0aXZlLm1pbiA9
IG1vZGUtPnZkaXNwbGF5Owo+ICsJY3R4LT5kdC52c3luY19sZW4ubWluID0gbW9kZS0+dnN5bmNf
ZW5kIC0gbW9kZS0+dnN5bmNfc3RhcnQ7Cj4gKwljdHgtPmR0LnZmcm9udF9wb3JjaC5taW4gPSBt
b2RlLT52c3luY19zdGFydCAtIG1vZGUtPnZkaXNwbGF5Owo+ICsJY3R4LT5kdC52YmFja19wb3Jj
aC5taW4gPSBtb2RlLT52dG90YWwgLSBtb2RlLT52c3luY19lbmQ7Cj4gKwo+ICsJY3R4LT5kaXNw
bGF5X3RpbWluZ192YWxpZCA9IDE7Cj4gKwo+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAi
cGl4ZWxjbG9jayglZCkuXG4iLCBjdHgtPmR0LnBpeGVsY2xvY2subWluKTsKPiArCURSTV9ERVZf
REVCVUdfRFJJVkVSKGRldiwgImhhY3RpdmUoJWQpLCBoc3luYyglZCksIGhmcCglZCksIGhicCgl
ZClcbiIsCj4gKwkJCSAgICAgY3R4LT5kdC5oYWN0aXZlLm1pbiwKPiArCQkJICAgICBjdHgtPmR0
LmhzeW5jX2xlbi5taW4sCj4gKwkJCSAgICAgY3R4LT5kdC5oZnJvbnRfcG9yY2gubWluLAo+ICsJ
CQkgICAgIGN0eC0+ZHQuaGJhY2tfcG9yY2gubWluKTsKPiArCURSTV9ERVZfREVCVUdfRFJJVkVS
KGRldiwgInZhY3RpdmUoJWQpLCB2c3luYyglZCksIHZmcCglZCksIHZicCglZClcbiIsCj4gKwkJ
CSAgICAgY3R4LT5kdC52YWN0aXZlLm1pbiwKPiArCQkJICAgICBjdHgtPmR0LnZzeW5jX2xlbi5t
aW4sCj4gKwkJCSAgICAgY3R4LT5kdC52ZnJvbnRfcG9yY2gubWluLAo+ICsJCQkgICAgIGN0eC0+
ZHQudmJhY2tfcG9yY2gubWluKTsKPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImhkaXNw
bGF5KCVkKSxoc3luY19zdGFydCglZCkuXG4iLAo+ICsJCQkgICAgIG1vZGUtPmhkaXNwbGF5LAo+
ICsJCQkgICAgIG1vZGUtPmhzeW5jX3N0YXJ0KTsKPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRl
diwgImhzeW5jX2VuZCglZCksaHRvdGFsKCVkKS5cbiIsCj4gKwkJCSAgICAgbW9kZS0+aHN5bmNf
ZW5kLAo+ICsJCQkgICAgIG1vZGUtPmh0b3RhbCk7Cj4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihk
ZXYsICJ2ZGlzcGxheSglZCksdnN5bmNfc3RhcnQoJWQpLlxuIiwKPiArCQkJICAgICBtb2RlLT52
ZGlzcGxheSwKPiArCQkJICAgICBtb2RlLT52c3luY19zdGFydCk7Cj4gKwlEUk1fREVWX0RFQlVH
X0RSSVZFUihkZXYsICJ2c3luY19lbmQoJWQpLHZ0b3RhbCglZCkuXG4iLAo+ICsJCQkgICAgIG1v
ZGUtPnZzeW5jX2VuZCwKPiArCQkJICAgICBtb2RlLT52dG90YWwpOwo+ICsKPiArCW11dGV4X3Vu
bG9jaygmY3R4LT5sb2NrKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgYW54NzYyNV9icmlkZ2Vf
ZW5hYmxlKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UpCj4gK3sKPiArCXN0cnVjdCBhbng3NjI1
X2RhdGEgKmN0eCA9IGJyaWRnZV90b19hbng3NjI1KGJyaWRnZSk7Cj4gKwlzdHJ1Y3QgZGV2aWNl
ICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKPiArCWludCByZXQ7Cj4gKwo+ICsJRFJNX0RFVl9E
RUJVR19EUklWRVIoZGV2LCAiZHJtIGVuYWJsZVxuIik7Cj4gKwo+ICsJYW54NzYyNV9sb3dfcG93
ZXJfbW9kZV9jaGVjayhjdHgsIDEpOwo+ICsKPiArCWlmIChXQVJOX09OKCFhdG9taWNfcmVhZCgm
Y3R4LT5wb3dlcl9zdGF0dXMpKSkKPiArCQlyZXR1cm47Cj4gKwo+ICsJaWYgKGN0eC0+cGRhdGEu
cGFuZWwpIHsKPiArCQlyZXQgPSBkcm1fcGFuZWxfZW5hYmxlKGN0eC0+cGRhdGEucGFuZWwpOwo+
ICsJCWlmIChyZXQgPCAwKSB7Cj4gKwkJCURSTV9FUlJPUigiZmFpbGVkIHRvIGVuYWJsZSBwYW5l
bDogJWQuXG4iLCByZXQpOwo+ICsJCQlyZXR1cm47Cj4gKwkJfQo+ICsJfQo+ICsKPiArCW11dGV4
X2xvY2soJmN0eC0+bG9jayk7Cj4gKwlhbng3NjI1X2RwX3N0YXJ0KGN0eCk7Cj4gKwltdXRleF91
bmxvY2soJmN0eC0+bG9jayk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGFueDc2MjVfYnJpZGdl
X2Rpc2FibGUoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSkKPiArewo+ICsJc3RydWN0IGFueDc2
MjVfZGF0YSAqY3R4ID0gYnJpZGdlX3RvX2FueDc2MjUoYnJpZGdlKTsKPiArCXN0cnVjdCBkZXZp
Y2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2Owo+ICsJaW50IHJldDsKPiArCj4gKwlpZiAoV0FS
Tl9PTighYXRvbWljX3JlYWQoJmN0eC0+cG93ZXJfc3RhdHVzKSkpCj4gKwkJcmV0dXJuOwo+ICsK
PiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRybSBkaXNhYmxlXG4iKTsKPiArCj4gKwlp
ZiAoY3R4LT5wZGF0YS5wYW5lbCkgewo+ICsJCXJldCA9IGRybV9wYW5lbF9kaXNhYmxlKGN0eC0+
cGRhdGEucGFuZWwpOwo+ICsJCWlmIChyZXQgPCAwKQo+ICsJCQlEUk1fRVJST1IoImZhaWxlZCB0
byBkaXNhYmxlIHBhbmVsOiAlZC5cbiIsIHJldCk7Cj4gKwl9Cj4gKwo+ICsJRFJNX0RFVl9ERUJV
R19EUklWRVIoZGV2LCAiZHJtIGRpc2FibGVcbiIpOwo+ICsJbXV0ZXhfbG9jaygmY3R4LT5sb2Nr
KTsKPiArCj4gKwlhbng3NjI1X2RwX3N0b3AoY3R4KTsKPiArCj4gKwlhbng3NjI1X2xvd19wb3dl
cl9tb2RlX2NoZWNrKGN0eCwgMCk7Cj4gKwo+ICsJbXV0ZXhfdW5sb2NrKCZjdHgtPmxvY2spOwo+
ICt9Cj4gKwo+ICtzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9icmlkZ2VfZnVuY3MgYW54NzYyNV9i
cmlkZ2VfZnVuY3MgPSB7Cj4gKwkuYXR0YWNoID0gYW54NzYyNV9icmlkZ2VfYXR0YWNoLAo+ICsJ
LmRpc2FibGUgPSBhbng3NjI1X2JyaWRnZV9kaXNhYmxlLAo+ICsJLnBvc3RfZGlzYWJsZSA9IGFu
eDc2MjVfcG9zdF9kaXNhYmxlLAo+ICsJLnByZV9lbmFibGUgPSBhbng3NjI1X3ByZV9lbmFibGUs
Cj4gKwkubW9kZV92YWxpZCA9IGFueDc2MjVfYnJpZGdlX21vZGVfdmFsaWQsCj4gKwkubW9kZV9z
ZXQgPSBhbng3NjI1X2JyaWRnZV9tb2RlX3NldCwKPiArCS5lbmFibGUgPSBhbng3NjI1X2JyaWRn
ZV9lbmFibGUsCj4gK307Cj4gKwo+ICtzdGF0aWMgaW50IGFueDc2MjVfcmVnaXN0ZXJfaTJjX2R1
bW15X2NsaWVudHMoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAo+ICsJCQkJCSAgICAgIHN0cnVj
dCBpMmNfY2xpZW50ICpjbGllbnQpCj4gK3sKPiArCWN0eC0+aTJjLnR4X3AwX2NsaWVudCA9IGky
Y19uZXdfZHVtbXkoY2xpZW50LT5hZGFwdGVyLAo+ICsJCQkJCSAgICAgIFRYX1AwX0FERFIgPj4g
MSk7Cj4gKwljdHgtPmkyYy50eF9wMV9jbGllbnQgPSBpMmNfbmV3X2R1bW15KGNsaWVudC0+YWRh
cHRlciwKPiArCQkJCQkgICAgICBUWF9QMV9BRERSID4+IDEpOwo+ICsJY3R4LT5pMmMudHhfcDJf
Y2xpZW50ID0gaTJjX25ld19kdW1teShjbGllbnQtPmFkYXB0ZXIsCj4gKwkJCQkJICAgICAgVFhf
UDJfQUREUiA+PiAxKTsKPiArCj4gKwljdHgtPmkyYy5yeF9wMF9jbGllbnQgPSBpMmNfbmV3X2R1
bW15KGNsaWVudC0+YWRhcHRlciwKPiArCQkJCQkgICAgICBSWF9QMF9BRERSID4+IDEpOwo+ICsJ
Y3R4LT5pMmMucnhfcDFfY2xpZW50ID0gaTJjX25ld19kdW1teShjbGllbnQtPmFkYXB0ZXIsCj4g
KwkJCQkJICAgICAgUlhfUDFfQUREUiA+PiAxKTsKPiArCWN0eC0+aTJjLnJ4X3AyX2NsaWVudCA9
IGkyY19uZXdfZHVtbXkoY2xpZW50LT5hZGFwdGVyLAo+ICsJCQkJCSAgICAgIFJYX1AyX0FERFIg
Pj4gMSk7Cj4gKwo+ICsJY3R4LT5pMmMudGNwY19jbGllbnQgPSBpMmNfbmV3X2R1bW15KGNsaWVu
dC0+YWRhcHRlciwKPiArCQkJCQkgICAgIFRDUENfSU5URVJGQUNFX0FERFIgPj4gMSk7Cj4gKwo+
ICsJaWYgKCghY3R4LT5pMmMudHhfcDBfY2xpZW50IHwKPiArCSAgICAgIWN0eC0+aTJjLnR4X3Ax
X2NsaWVudCB8Cj4gKwkgICAgICFjdHgtPmkyYy50eF9wMl9jbGllbnQgfAo+ICsJICAgICAhY3R4
LT5pMmMucnhfcDBfY2xpZW50IHwKPiArCSAgICAgIWN0eC0+aTJjLnJ4X3AxX2NsaWVudCB8Cj4g
KwkgICAgICFjdHgtPmkyYy5yeF9wMl9jbGllbnQgfAo+ICsJICAgICAhY3R4LT5pMmMudGNwY19j
bGllbnQpICE9IDApCgohPSAwIGlzIGEgZG91YmxlIG5lZ2F0aXZlLiAgT25seSAhPSAwIGFuZCA9
PSAwIHdoZW4geW91IGFyZSB0YWxraW5nCm51bWJlcnMgb3Igc3RyY21wKCkuCgoJaWYgKG5yID09
IDApIHsKCWlmIChzdHJjbXAoZm9vLCBiYXIpID09IDApIHsKCkRvbid0IHVzZSBpdCBmb3IgcG9p
bnRlcnMgb3IgZXJyb3IgY29kZXMuICBUaGVyZSBpcyBubyByZWFzb24gdG8gZG8KYSBiaXR3aXNl
IE9SIGluc3RlYWQgb2YgYSBsb2dpY2FsIE9SIGhlcmUuICBKdXN0IHNheToKCgoJaWYgKCFjdHgt
PmkyYy50eF9wMF9jbGllbnQgfHwKCSAgICAhY3R4LT5pMmMudHhfcDFfY2xpZW50IHx8CgkgICAg
IWN0eC0+aTJjLnR4X3AyX2NsaWVudCB8fAoJICAgICFjdHgtPmkyYy5yeF9wMF9jbGllbnQgfHwK
CSAgICAhY3R4LT5pMmMucnhfcDFfY2xpZW50IHx8CgkgICAgIWN0eC0+aTJjLnJ4X3AyX2NsaWVu
dCB8fAoJICAgICFjdHgtPmkyYy50Y3BjX2NsaWVudCkKCQlyZXR1cm4gLUVJTzsKCkl0IHdvdWxk
bid0IGJlIHRoYXQgaGFyZCB0byB3cml0ZSB0aGlzIHdpdGhvdXQgdGhlIG1lbW9yeSBsZWFrcywg
YnR3LgpKdXN0IHVzZSAiRnJlZSB0aGUgbW9zdCByZWNlbnQgYWxsb2NhdGlvbiIgc3R5bGUuCgoJ
Y3R4LT5pMmMudHhfcDBfY2xpZW50ID0gaTJjX25ld19kdW1teShjbGllbnQtPmFkYXB0ZXIsCgkJ
CQkJICAgICAgVFhfUDBfQUREUiA+PiAxKTsKCWlmICghY3R4LT5pMmMudHhfcDBfY2xpZW50KQoJ
CXJldHVybiAtRU5PTUVNOwoKCWN0eC0+aTJjLnR4X3AxX2NsaWVudCA9IGkyY19uZXdfZHVtbXko
Y2xpZW50LT5hZGFwdGVyLAoJCQkJCSAgICAgIFRYX1AxX0FERFIgPj4gMSk7CglpZiAoIWN0eC0+
aTJjLnR4X3AxX2NsaWVudCkKCQlnb3RvIGZyZWVfdHhfcDA7CgoJY3R4LT5pMmMudHhfcDJfY2xp
ZW50ID0gaTJjX25ld19kdW1teShjbGllbnQtPmFkYXB0ZXIsCgkJCQkJICAgICAgVFhfUDJfQURE
UiA+PiAxKTsKCWlmICghY3R4LT5pMmMudHhfcDJfY2xpZW50KQoJCWdvdG8gZnJlZV90eF9wMTsK
CgoJY3R4LT5pMmMucnhfcDBfY2xpZW50ID0gaTJjX25ld19kdW1teShjbGllbnQtPmFkYXB0ZXIs
CgkJCQkJICAgICAgUlhfUDBfQUREUiA+PiAxKTsKCWlmICghY3R4LT5pMmMucnhfcDBfY2xpZW50
KQoJCWdvdG8gZnJlZV90eF9wMjsKCgljdHgtPmkyYy5yeF9wMV9jbGllbnQgPSBpMmNfbmV3X2R1
bW15KGNsaWVudC0+YWRhcHRlciwKCQkJCQkgICAgICBSWF9QMV9BRERSID4+IDEpOwoJaWYgKCFj
dHgtPmkyYy5yeF9wMV9jbGllbnQpCgkJZ290byBmcmVlX3J4X3AwOwoKCWN0eC0+aTJjLnJ4X3Ay
X2NsaWVudCA9IGkyY19uZXdfZHVtbXkoY2xpZW50LT5hZGFwdGVyLAoJCQkJCSAgICAgIFJYX1Ay
X0FERFIgPj4gMSk7CglpZiAoIWN0eC0+aTJjLnJ4X3AyX2NsaWVudCkKCQlnb3RvIGZyZWVfcnhf
cDE7CgoKCWN0eC0+aTJjLnRjcGNfY2xpZW50ID0gaTJjX25ld19kdW1teShjbGllbnQtPmFkYXB0
ZXIsCgkJCQkJICAgICBUQ1BDX0lOVEVSRkFDRV9BRERSID4+IDEpOwoJaWYgKCFjdHgtPmkyYy50
Y3BjX2NsaWVudCkKCQlnb3RvIGZyZWVfcnhfcDI7CgoJcmV0dXJuIDA7CgpmcmVlX3J4X3AyOgoJ
aTJjX3VucmVnaXN0ZXJfZGV2aWNlKGN0eC0+aTJjLnJ4X3AyX2NsaWVudCk7CmZyZWVfcnhfcDE6
CglpMmNfdW5yZWdpc3Rlcl9kZXZpY2UoY3R4LT5pMmMucnhfcDFfY2xpZW50KTsKZnJlZV9yeF9w
MDoKCWkyY191bnJlZ2lzdGVyX2RldmljZShjdHgtPmkyYy5yeF9wMF9jbGllbnQpOwpmcmVlX3R4
X3AyOgoJaTJjX3VucmVnaXN0ZXJfZGV2aWNlKGN0eC0+aTJjLnR4X3AyX2NsaWVudCk7CmZyZWVf
dHhfcDE6CglpMmNfdW5yZWdpc3Rlcl9kZXZpY2UoY3R4LT5pMmMudHhfcDFfY2xpZW50KTsKZnJl
ZV90eF9wMDoKCWkyY191bnJlZ2lzdGVyX2RldmljZShjdHgtPmkyYy50eF9wMF9jbGllbnQpOwoK
CXJldHVybiAtRU5PTUVNOwoKSXQncyBhIGxpdHRsZSBiaXQgZXh0cmEgd29yaywgYnV0IEkgaGF2
ZSBkb25lIGl0IHNvIEkga25vdyBob3cgaGFyZCBpdAppcy4gIEFsc28gbm93IHN0YXRpYyBhbmFs
eXNpcyB0b29scyB3b24ndCBjb21wbGFpbiBhYm91dCB0aGUgbGVha3MuCgoKPiArCQlyZXR1cm4g
LUVJTzsKPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgYW54NzYyNV91
bnJlZ2lzdGVyX2kyY19kdW1teV9jbGllbnRzKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKPiAr
ewo+ICsJaTJjX3VucmVnaXN0ZXJfZGV2aWNlKGN0eC0+aTJjLnR4X3AwX2NsaWVudCk7Cj4gKwlp
MmNfdW5yZWdpc3Rlcl9kZXZpY2UoY3R4LT5pMmMudHhfcDFfY2xpZW50KTsKPiArCWkyY191bnJl
Z2lzdGVyX2RldmljZShjdHgtPmkyYy50eF9wMl9jbGllbnQpOwo+ICsJaTJjX3VucmVnaXN0ZXJf
ZGV2aWNlKGN0eC0+aTJjLnJ4X3AxX2NsaWVudCk7Cj4gKwlpMmNfdW5yZWdpc3Rlcl9kZXZpY2Uo
Y3R4LT5pMmMucnhfcDJfY2xpZW50KTsKPiArCWkyY191bnJlZ2lzdGVyX2RldmljZShjdHgtPmky
Yy5yeF9wM19jbGllbnQpOwoKRGVsZXRlIHRoZSBjdHgtPmkyYy5yeF9wM19jbGllbnQgYmVjYXVz
ZSBpdCdzIG5ldmVyIHVzZWQuCgo+ICsJaTJjX3VucmVnaXN0ZXJfZGV2aWNlKGN0eC0+aTJjLnRj
cGNfY2xpZW50KTsKCgpUaGUgb3RoZXIgYWR2YW50YWdlIG9mIHRoZSAiRnJlZSB0aGUgbGFzdCBy
ZXNvdXJjZSBzdHlsZSIgaXMgdGhhdCB5b3UKY2FuIGp1c3QgYWRkIGE6CgoJaTJjX3VucmVnaXN0
ZXJfZGV2aWNlKGN0eC0+aTJjLnRjcGNfY2xpZW50KTsKCmFuZCBkZWxldGUgdGhlIGVycm9yIGxh
YmVscyBhbmQgeW91IGhhdmUgYW4KYW54NzYyNV91bnJlZ2lzdGVyX2kyY19kdW1teV9jbGllbnRz
KCkgZnVuY3Rpb24uCgpUaGVyZSBpcyBhbm90aGVyIGJ1ZyBoZXJlIGJlY2F1c2Ugd2UgZm9yZ290
IHRvIGZyZWUgImkyYy5yeF9wMF9jbGllbnQiLgoKPiArfQo+ICsKPiArc3RhdGljIGludCBhbng3
NjI1X2kyY19wcm9iZShzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50LAo+ICsJCQkgICAgIGNvbnN0
IHN0cnVjdCBpMmNfZGV2aWNlX2lkICppZCkKPiArewo+ICsJc3RydWN0IGFueDc2MjVfZGF0YSAq
cGxhdGZvcm07Cj4gKwlzdHJ1Y3QgYW54NzYyNV9wbGF0Zm9ybV9kYXRhICpwZGF0YTsKPiArCWlu
dCByZXQgPSAwOwo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJmNsaWVudC0+ZGV2Owo+ICsKPiAr
CWlmICghaTJjX2NoZWNrX2Z1bmN0aW9uYWxpdHkoY2xpZW50LT5hZGFwdGVyLAo+ICsJCQkJICAg
ICBJMkNfRlVOQ19TTUJVU19JMkNfQkxPQ0spKSB7Cj4gKwkJRFJNX0RFVl9FUlJPUihkZXYsICJh
bng3NjI1J3MgaTJjIGJ1cyBkb2Vzbid0IHN1cHBvcnRcbiIpOwo+ICsJCXJldCA9IC1FTk9ERVY7
Cj4gKwkJZ290byBleGl0OwoKUmV0dXJuIGRpcmVjdGx5LCBwbGVhc2UuICAiZ290byBleGl0IiBp
cyBsZXNzIHJlYWRhYmxlIHRoYW4KcmV0dXJuIC1FTk9ERVY7Cgo+ICsJfQo+ICsKPiArCXBsYXRm
b3JtID0ga3phbGxvYyhzaXplb2YoKnBsYXRmb3JtKSwgR0ZQX0tFUk5FTCk7Cj4gKwlpZiAoIXBs
YXRmb3JtKSB7Cj4gKwkJRFJNX0RFVl9FUlJPUihkZXYsICJmYWlsZWQgdG8gYWxsb2NhdGUgZHJp
dmVyIGRhdGFcbiIpOwo+ICsJCXJldCA9IC1FTk9NRU07Cj4gKwkJZ290byBleGl0OwoKcmV0dXJu
IC1FTk9NRU07Cgo+ICsJfQo+ICsKPiArCXBkYXRhID0gJnBsYXRmb3JtLT5wZGF0YTsKPiArCj4g
KwkvKiBkZXZpY2UgdHJlZSBwYXJzaW5nIGZ1bmN0aW9uIGNhbGwgKi8KPiArCXJldCA9IGFueDc2
MjVfcGFyc2VfZHQoJmNsaWVudC0+ZGV2LCBwZGF0YSk7Cj4gKwlpZiAocmV0ICE9IDApCS8qIGlm
IG9jY3VycyBlcnJvciAqLwo+ICsJCWdvdG8gZXJyMDsKCiE9IDAgaXMgZG91YmxlIG5lZ2F0aXZl
LiAgQ2hvb3NlIGJldHRlciBsYWJlbCBuYW1lcy4gIFJlbW92ZSB0aGUgb2J2aW91cwpjb21tZW50
LgoKaWYgKHJldCkKCWdvdG8gZnJlZV9wbGF0Zm9ybTsKCj4gKwo+ICsJYW54NzYyNV9pbml0X2dw
aW8ocGxhdGZvcm0pOwo+ICsKPiArCS8qIHRvIGFjY2VzcyBnbG9iYWwgcGxhdGZvcm0gZGF0YSAq
Lwo+ICsJcGxhdGZvcm0tPmNsaWVudCA9IGNsaWVudDsKPiArCWkyY19zZXRfY2xpZW50ZGF0YShj
bGllbnQsIHBsYXRmb3JtKTsKPiArCj4gKwlpZiAocGxhdGZvcm0tPnBkYXRhLmV4dGNvbl9zdXBw
b3J0ZWQpIHsKPiArCQkvKiBnZXQgZXh0Y29uIGRldmljZSBmcm9tIERUUyAqLwo+ICsJCXBsYXRm
b3JtLT5leHRjb24gPSBleHRjb25fZ2V0X2VkZXZfYnlfcGhhbmRsZSgmY2xpZW50LT5kZXYsIDAp
Owo+ICsJCWlmIChQVFJfRVJSKHBsYXRmb3JtLT5leHRjb24pID09IC1FUFJPQkVfREVGRVIpCj4g
KwkJCWdvdG8gZXJyMDsKClByZXNlcnZlIHRoZSBlcnJvciBjb2RlLgoKPiArCQlpZiAoSVNfRVJS
KHBsYXRmb3JtLT5leHRjb24pKSB7Cj4gKwkJCURSTV9ERVZfRVJST1IoJmNsaWVudC0+ZGV2LAo+
ICsJCQkJICAgICAgImNhbiBub3QgZ2V0IGV4dGNvbiBkZXZpY2UhIik7Cj4gKwkJCWdvdG8gZXJy
MDsKClByZXJ2ZSB0aGUgZXJyb3IgY29kZS4KCj4gKwkJfQo+ICsKPiArCQlyZXQgPSBhbng3NjI1
X2V4dGNvbl9ub3RpZmllcl9pbml0KHBsYXRmb3JtKTsKPiArCQlpZiAocmV0IDwgMCkKPiArCQkJ
Z290byBlcnIwOwo+ICsJfQo+ICsKPiArCWF0b21pY19zZXQoJnBsYXRmb3JtLT5wb3dlcl9zdGF0
dXMsIDApOwo+ICsKPiArCW11dGV4X2luaXQoJnBsYXRmb3JtLT5sb2NrKTsKPiArCj4gKwlpZiAo
cGxhdGZvcm0tPnBkYXRhLmdwaW9faW50cl9ocGQpIHsKPiArCQlJTklUX1dPUksoJnBsYXRmb3Jt
LT53b3JrLCBhbng3NjI1X3dvcmtfZnVuYyk7Cj4gKwkJcGxhdGZvcm0tPndvcmtxdWV1ZSA9IGNy
ZWF0ZV93b3JrcXVldWUoImFueDc2MjVfd29yayIpOwo+ICsJCWlmICghcGxhdGZvcm0tPndvcmtx
dWV1ZSkgewo+ICsJCQlEUk1fREVWX0VSUk9SKGRldiwgImZhaWxlZCB0byBjcmVhdGUgd29yayBx
dWV1ZVxuIik7Cj4gKwkJCXJldCA9IC1FTk9NRU07Cj4gKwkJCWdvdG8gZXJyMTsKClRoaXMgZ290
byB3aWxsIGNyYXNoLiAgQmVjYXVzZSB5b3UgaGF2ZSBmb3Jnb3R0ZW4gd2hhdCB0aGUgbW9zdCBy
ZWNlbnRseQphbGxvY2F0ZWQgcmVzb3VyY2Ugd2FzLiAgSXQgc2hvdWxkIGJlICJnb3RvIGZyZWVf
cGxhdGZvcm07IiBzdGlsbC4KCj4gKwkJfQo+ICsKPiArCQlwbGF0Zm9ybS0+cGRhdGEuaHBkX2ly
cSA9Cj4gKwkJCWdwaW9kX3RvX2lycShwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19pbnRyX2hwZCk7Cj4g
KwkJaWYgKHBsYXRmb3JtLT5wZGF0YS5ocGRfaXJxIDwgMCkgewo+ICsJCQlEUk1fREVWX0VSUk9S
KGRldiwgImZhaWxlZCB0byBnZXQgZ3BpbyBpcnFcbiIpOwo+ICsJCQlnb3RvIGVycjE7Cgpnb3Rv
IGZyZWVfd3E7Cgo+ICsJCX0KPiArCj4gKwkJcmV0ID0gcmVxdWVzdF90aHJlYWRlZF9pcnEocGxh
dGZvcm0tPnBkYXRhLmhwZF9pcnEsCj4gKwkJCQkJICAgTlVMTCwgYW54NzYyNV9pbnRyX2hwZF9p
c3IsCj4gKwkJCQkJICAgSVJRRl9UUklHR0VSX0ZBTExJTkcgfAo+ICsJCQkJCSAgIElSUUZfVFJJ
R0dFUl9SSVNJTkcgfAo+ICsJCQkJCSAgIElSUUZfT05FU0hPVCwKPiArCQkJCQkgICAiYW54NzYy
NS1ocGQiLCBwbGF0Zm9ybSk7Cj4gKwkJaWYgKHJldCA8IDApIHsKPiArCQkJRFJNX0RFVl9FUlJP
UihkZXYsICJmYWlsZWQgdG8gcmVxdWVzdCBpcnFcbiIpOwo+ICsJCQlnb3RvIGVycjE7Cj4gKwkJ
fQo+ICsKPiArCQlyZXQgPSBpcnFfc2V0X2lycV93YWtlKHBsYXRmb3JtLT5wZGF0YS5ocGRfaXJx
LCAxKTsKPiArCQlpZiAocmV0IDwgMCkgewo+ICsJCQlEUk1fREVWX0VSUk9SKGRldiwgIlJlcXVl
c3QgaXJxIGZvciBocGQiKTsKPiArCQkJRFJNX0RFVl9FUlJPUihkZXYsICJpbnRlcnJ1cHQgd2Fr
ZSBzZXQgZmFpbFxuIik7Cj4gKwkJCWdvdG8gZXJyMTsKPiArCQl9Cj4gKwo+ICsJCXJldCA9IGVu
YWJsZV9pcnFfd2FrZShwbGF0Zm9ybS0+cGRhdGEuaHBkX2lycSk7Cj4gKwkJaWYgKHJldCA8IDAp
IHsKPiArCQkJRFJNX0RFVl9FUlJPUihkZXYsICJFbmFibGUgaXJxIGZvciBIUEQiKTsKPiArCQkJ
RFJNX0RFVl9FUlJPUihkZXYsICJpbnRlcnJ1cHQgd2FrZSBlbmFibGUgZmFpbFxuIik7Cj4gKwkJ
CWdvdG8gZXJyMTsKPiArCQl9Cj4gKwl9Cj4gKwo+ICsJaWYgKGFueDc2MjVfcmVnaXN0ZXJfaTJj
X2R1bW15X2NsaWVudHMocGxhdGZvcm0sIGNsaWVudCkgIT0gMCkgewoKUHJlc2VydmUgdGhlIGVy
cm9yIGNvZGUuCgoJcmV0ID0gYW54NzYyNV9yZWdpc3Rlcl9pMmNfZHVtbXlfY2xpZW50cygpOwoJ
aWYgKHJldCkKCQlnb3RvIGZyZWVfcGxhdGZvcm07CgpVZ2guLi4gIFRoZSBlcnIyIGlzIGEgbGF5
ZXJpbmcgdmlvbGF0aW9uLiAgRXZlcnkgZnVuY3Rpb24gc2hvdWxkIGZyZWUKaXRzIG93biBwYXJ0
aWFsbHkgYWxsb2NhdGVkIG1lbW9yeS4gIEl0IHNob3VsZCBlaXRoZXIgc3VjY2VlZCBvciBmYWls
CmFuZCBpdCBzaG91bGRuJ3QgZXhwZWN0IHRoZSBjYWxsZXIgdG8gY2xlYW4gdXAgcGFydGlhbGx5
IGFsbG9jYXRlZApyZXNvdXJjZXMgZm9yIGl0LgoKCj4gKwkJcmV0ID0gLUVOT01FTTsKPiArCQlE
Uk1fRVJST1IoIkZhaWxlZCB0byByZXNlcnZlIEkyQyBidXMuXG4iKTsKPiArCQlnb3RvIGVycjI7
Cj4gKwl9Cj4gKwo+ICsJaWYgKHBsYXRmb3JtLT5wZGF0YS5sb3dfcG93ZXJfbW9kZSA9PSAwKSB7
Cj4gKwkJYW54NzYyNV9kaXNhYmxlX3BkX3Byb3RvY29sKHBsYXRmb3JtKTsKPiArCQlhdG9taWNf
c2V0KCZwbGF0Zm9ybS0+cG93ZXJfc3RhdHVzLCAxKTsKPiArCX0KPiArCj4gKwkvKiBhZGQgd29y
ayBmdW5jdGlvbiAqLwo+ICsJaWYgKHBsYXRmb3JtLT5wZGF0YS5ncGlvX2ludHJfaHBkKQo+ICsJ
CXF1ZXVlX3dvcmsocGxhdGZvcm0tPndvcmtxdWV1ZSwgJnBsYXRmb3JtLT53b3JrKTsKPiArCj4g
KwlwbGF0Zm9ybS0+YnJpZGdlLmZ1bmNzID0gJmFueDc2MjVfYnJpZGdlX2Z1bmNzOwo+ICsjaWYg
SVNfRU5BQkxFRChDT05GSUdfT0YpCj4gKwlwbGF0Zm9ybS0+YnJpZGdlLm9mX25vZGUgPSBjbGll
bnQtPmRldi5vZl9ub2RlOwo+ICsjZW5kaWYKPiArCWRybV9icmlkZ2VfYWRkKCZwbGF0Zm9ybS0+
YnJpZGdlKTsKPiArCj4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJwcm9iZSBkb25lXG4i
KTsKPiArCWdvdG8gZXhpdDsKCnJldHVybiAwOwoKPiArCj4gK2VycjI6Cj4gKwlhbng3NjI1X3Vu
cmVnaXN0ZXJfaTJjX2R1bW15X2NsaWVudHMocGxhdGZvcm0pOwo+ICtlcnIxOgo+ICsJaWYgKHBs
YXRmb3JtLT5wZGF0YS5ncGlvX2ludHJfaHBkKQo+ICsJCWRlc3Ryb3lfd29ya3F1ZXVlKHBsYXRm
b3JtLT53b3JrcXVldWUpOwo+ICtlcnIwOgo+ICsJa2ZyZWUocGxhdGZvcm0pOwo+ICtleGl0Ogo+
ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKCnJlZ2FyZHMsCmRhbiBjYXJwZW50ZXIKCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGlu
ZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
