Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 0FD1319991
	for <lists+dri-devel@lfdr.de>; Fri, 10 May 2019 10:24:02 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 02490899DB;
	Fri, 10 May 2019 08:23:55 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ot1-x349.google.com (mail-ot1-x349.google.com
 [IPv6:2607:f8b0:4864:20::349])
 by gabe.freedesktop.org (Postfix) with ESMTPS id EBB76897EF
 for <dri-devel@lists.freedesktop.org>; Fri, 10 May 2019 00:00:40 +0000 (UTC)
Received: by mail-ot1-x349.google.com with SMTP id 72so1971897otv.23
 for <dri-devel@lists.freedesktop.org>; Thu, 09 May 2019 17:00:40 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:date:in-reply-to:message-id:mime-version
 :references:subject:from:to:cc;
 bh=ZeoJmeVmdaLlUYqpdR4tYo7PLVche4+REuZ+a12ZbZ4=;
 b=SNy1E/B0itedl61I4LdYurmsPgMS/g9lP+MDkWkuI1raFOwUgNuoFAJtP3rdxZNa2d
 resDXzQy6LinOYGqa4FQEsZik9rmaYPt4ByfkojnBNS6kpuxbk/samIE0PuupYoKL/E7
 13Z4KM8Kjqsls3i4ZV08ZyrToJ43dkw+/Ia4vJFcFsrHHUqoN9ybUqeYZK1J4Km0f15g
 N2YS6OBzILhtkQBTIVTgwUSCO0jWTCowQx53xoIJ9X9pFnd8ZiZEVtngZLHYH7ieVGIY
 jHKSud2TP3EEoEIUP3Obeg6iUoD/oA9YSuZkyAG23OyD4yCZErWN28TlBzNFYR4jIwbM
 WTOg==
X-Gm-Message-State: APjAAAWTpQqm8wAkgJFgmHtEZp8TJLf9U+mUGBHVvZySeesKJSFgnyHd
 g1OQAgNpn9WSrl1EGII3E0uIUjBeCQ==
X-Google-Smtp-Source: APXvYqzG6xLzpbiFMvx9NI0qwQGX5W5Vqzds/q7jeKS4RVpx2YMuk0v6g5xOIEd2iz26P4xRk0I2Lhh1Pw==
X-Received: by 2002:aca:4f11:: with SMTP id d17mr2055944oib.9.1557446440191;
 Thu, 09 May 2019 17:00:40 -0700 (PDT)
Date: Thu,  9 May 2019 17:00:31 -0700
In-Reply-To: <20190510000032.40749-1-fengc@google.com>
Message-Id: <20190510000032.40749-3-fengc@google.com>
Mime-Version: 1.0
References: <20190510000032.40749-1-fengc@google.com>
X-Mailer: git-send-email 2.21.0.1020.gf2820cf01a-goog
Subject: [dma-buf v3 2/3] dma-buf: add DMA_BUF_{GET,SET}_NAME ioctls
From: Chenbo Feng <fengc@google.com>
To: linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org, 
 linux-media@vger.kernel.org
X-Mailman-Approved-At: Fri, 10 May 2019 08:23:54 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=google.com; s=20161025;
 h=date:in-reply-to:message-id:mime-version:references:subject:from:to
 :cc;
 bh=ZeoJmeVmdaLlUYqpdR4tYo7PLVche4+REuZ+a12ZbZ4=;
 b=oA0+g3tEHKO5sSwmn2RXOjiy2/CqtildrTg4wIqr6a+JAKjsFi/eYYnp8icgip6s6z
 g3omjogp4NWiMcXAluZo1YukLO4m8YphkZtr49cD/LZvSJpQOs89XdmFSQKn2pL7rYtX
 8qcpUC0+gtRJw1C+z3Vnp7Uic/I4NCyOLMDfTQwDWc36+//7shA551ysxFoKWSGUMigd
 HzrHBwUXjuQIi2n3SK5ZAlnjYkaxdG2Zc9l5FbuMRyKTts7/M4wRE7hAG+W5SfDtjE9M
 lbLKeLKruke6SzEc3KBnKq59/RYHAQDcvSOi6+n2FMKQddqK6sdYN/CLCmxFa5frvUyb
 njcQ==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: erickreyes@google.com, kernel-team@android.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogR3JlZyBIYWNrbWFubiA8Z2hhY2ttYW5uQGdvb2dsZS5jb20+CgpUaGlzIHBhdGNoIGFk
ZHMgY29tcGxpbWVudGFyeSBETUFfQlVGX1NFVF9OQU1FIGFuZCBETUFfQlVGX0dFVF9OQU1FCmlv
Y3Rscywgd2hpY2ggbGV0cyB1c2Vyc3BhY2UgcHJvY2Vzc2VzIGF0dGFjaCBhIGZyZWUtZm9ybSBu
YW1lIHRvIGVhY2gKYnVmZmVyLgoKVGhpcyBpbmZvcm1hdGlvbiBjYW4gYmUgZXh0cmVtZWx5IGhl
bHBmdWwgZm9yIHRyYWNraW5nIGFuZCBhY2NvdW50aW5nCnNoYXJlZCBidWZmZXJzLiAgRm9yIGV4
YW1wbGUsIG9uIEFuZHJvaWQsIHdlIGtub3cgd2hhdCBlYWNoIGJ1ZmZlciB3aWxsCmJlIHVzZWQg
Zm9yIGF0IGFsbG9jYXRpb24gdGltZTogR0wsIG11bHRpbWVkaWEsIGNhbWVyYSwgZXRjLiAgVGhl
CnVzZXJzcGFjZSBhbGxvY2F0b3IgY2FuIHVzZSBETUFfQlVGX1NFVF9OQU1FIHRvIGFzc29jaWF0
ZSB0aGF0CmluZm9ybWF0aW9uIHdpdGggdGhlIGJ1ZmZlciwgc28gd2UgY2FuIGxhdGVyIGdpdmUg
ZGV2ZWxvcGVycyBhCmJyZWFrZG93biBvZiBob3cgbXVjaCBtZW1vcnkgdGhleSdyZSBhbGxvY2F0
aW5nIGZvciBncmFwaGljcywgY2FtZXJhLApldGMuCgpTaWduZWQtb2ZmLWJ5OiBHcmVnIEhhY2tt
YW5uIDxnaGFja21hbm5AZ29vZ2xlLmNvbT4KU2lnbmVkLW9mZi1ieTogQ2hlbmJvIEZlbmcgPGZl
bmdjQGdvb2dsZS5jb20+Ci0tLQogZHJpdmVycy9kbWEtYnVmL2RtYS1idWYuYyAgICB8IDQ5ICsr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tLQogaW5jbHVkZS9saW51eC9kbWEtYnVm
LmggICAgICB8ICA1ICsrKy0KIGluY2x1ZGUvdWFwaS9saW51eC9kbWEtYnVmLmggfCAgMyArKysK
IDMgZmlsZXMgY2hhbmdlZCwgNTMgaW5zZXJ0aW9ucygrKSwgNCBkZWxldGlvbnMoLSkKCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2RtYS1idWYvZG1hLWJ1Zi5jIGIvZHJpdmVycy9kbWEtYnVmL2RtYS1i
dWYuYwppbmRleCBmZmQ1YTJhZDdkNmYuLmMxZGE1ZjljZTQ0ZCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9kbWEtYnVmL2RtYS1idWYuYworKysgYi9kcml2ZXJzL2RtYS1idWYvZG1hLWJ1Zi5jCkBAIC00
OCw4ICs0OCwyNCBAQCBzdHJ1Y3QgZG1hX2J1Zl9saXN0IHsKIAogc3RhdGljIHN0cnVjdCBkbWFf
YnVmX2xpc3QgZGJfbGlzdDsKIAorc3RhdGljIGNoYXIgKmRtYWJ1ZmZzX2RuYW1lKHN0cnVjdCBk
ZW50cnkgKmRlbnRyeSwgY2hhciAqYnVmZmVyLCBpbnQgYnVmbGVuKQoreworCXN0cnVjdCBkbWFf
YnVmICpkbWFidWY7CisJY2hhciBuYW1lW0RNQV9CVUZfTkFNRV9MRU5dOworCXNpemVfdCByZXQg
PSAwOworCisJZG1hYnVmID0gZGVudHJ5LT5kX2ZzZGF0YTsKKwltdXRleF9sb2NrKCZkbWFidWYt
PmxvY2spOworCWlmIChkbWFidWYtPm5hbWUpCisJCXJldCA9IHN0cmxjcHkobmFtZSwgZG1hYnVm
LT5uYW1lLCBETUFfQlVGX05BTUVfTEVOKTsKKwltdXRleF91bmxvY2soJmRtYWJ1Zi0+bG9jayk7
CisKKwlyZXR1cm4gZHluYW1pY19kbmFtZShkZW50cnksIGJ1ZmZlciwgYnVmbGVuLCAiLyVzOiVz
IiwKKwkJCSAgICAgZGVudHJ5LT5kX25hbWUubmFtZSwgcmV0ID4gMCA/IG5hbWUgOiAiIik7Cit9
CisKIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZGVudHJ5X29wZXJhdGlvbnMgZG1hX2J1Zl9kZW50cnlf
b3BzID0gewotCS5kX2RuYW1lID0gc2ltcGxlX2RuYW1lLAorCS5kX2RuYW1lID0gZG1hYnVmZnNf
ZG5hbWUsCiB9OwogCiBzdGF0aWMgc3RydWN0IHZmc21vdW50ICpkbWFfYnVmX21udDsKQEAgLTI5
Nyw2ICszMTMsMjcgQEAgc3RhdGljIF9fcG9sbF90IGRtYV9idWZfcG9sbChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgcG9sbF90YWJsZSAqcG9sbCkKIAlyZXR1cm4gZXZlbnRzOwogfQogCitzdGF0aWMgbG9u
ZyBkbWFfYnVmX3NldF9uYW1lKHN0cnVjdCBkbWFfYnVmICpkbWFidWYsIGNvbnN0IGNoYXIgX191
c2VyICpidWYpCit7CisJY2hhciAqbmFtZSA9IHN0cm5kdXBfdXNlcihidWYsIERNQV9CVUZfTkFN
RV9MRU4pOworCWxvbmcgcmV0ID0gMDsKKworCWlmIChJU19FUlIobmFtZSkpCisJCXJldHVybiBQ
VFJfRVJSKG5hbWUpOworCisJbXV0ZXhfbG9jaygmZG1hYnVmLT5sb2NrKTsKKwlpZiAoIWxpc3Rf
ZW1wdHkoJmRtYWJ1Zi0+YXR0YWNobWVudHMpKSB7CisJCXJldCA9IC1FQlVTWTsKKwkJZ290byBv
dXRfdW5sb2NrOworCX0KKwlrZnJlZShkbWFidWYtPm5hbWUpOworCWRtYWJ1Zi0+bmFtZSA9IG5h
bWU7CisKK291dF91bmxvY2s6CisJbXV0ZXhfdW5sb2NrKCZkbWFidWYtPmxvY2spOworCXJldHVy
biByZXQ7Cit9CisKIHN0YXRpYyBsb25nIGRtYV9idWZfaW9jdGwoc3RydWN0IGZpbGUgKmZpbGUs
CiAJCQkgIHVuc2lnbmVkIGludCBjbWQsIHVuc2lnbmVkIGxvbmcgYXJnKQogewpAQCAtMzM1LDYg
KzM3MiwxMCBAQCBzdGF0aWMgbG9uZyBkbWFfYnVmX2lvY3RsKHN0cnVjdCBmaWxlICpmaWxlLAog
CQkJcmV0ID0gZG1hX2J1Zl9iZWdpbl9jcHVfYWNjZXNzKGRtYWJ1ZiwgZGlyZWN0aW9uKTsKIAog
CQlyZXR1cm4gcmV0OworCisJY2FzZSBETUFfQlVGX1NFVF9OQU1FOgorCQlyZXR1cm4gZG1hX2J1
Zl9zZXRfbmFtZShkbWFidWYsIChjb25zdCBjaGFyIF9fdXNlciAqKWFyZyk7CisKIAlkZWZhdWx0
OgogCQlyZXR1cm4gLUVOT1RUWTsKIAl9CkBAIC0zNzYsNiArNDE3LDcgQEAgc3RhdGljIHN0cnVj
dCBmaWxlICpkbWFfYnVmX2dldGZpbGUoc3RydWN0IGRtYV9idWYgKmRtYWJ1ZiwgaW50IGZsYWdz
KQogCQlnb3RvIGVycl9hbGxvY19maWxlOwogCWZpbGUtPmZfZmxhZ3MgPSBmbGFncyAmIChPX0FD
Q01PREUgfCBPX05PTkJMT0NLKTsKIAlmaWxlLT5wcml2YXRlX2RhdGEgPSBkbWFidWY7CisJZmls
ZS0+Zl9wYXRoLmRlbnRyeS0+ZF9mc2RhdGEgPSBkbWFidWY7CiAKIAlyZXR1cm4gZmlsZTsKIApA
QCAtMTA4MiwxMiArMTEyNCwxMyBAQCBzdGF0aWMgaW50IGRtYV9idWZfZGVidWdfc2hvdyhzdHJ1
Y3Qgc2VxX2ZpbGUgKnMsIHZvaWQgKnVudXNlZCkKIAkJCWNvbnRpbnVlOwogCQl9CiAKLQkJc2Vx
X3ByaW50ZihzLCAiJTA4enVcdCUwOHhcdCUwOHhcdCUwOGxkXHQlc1x0JTA4bHVcbiIsCisJCXNl
cV9wcmludGYocywgIiUwOHp1XHQlMDh4XHQlMDh4XHQlMDhsZFx0JXNcdCUwOGx1XHQlc1xuIiwK
IAkJCQlidWZfb2JqLT5zaXplLAogCQkJCWJ1Zl9vYmotPmZpbGUtPmZfZmxhZ3MsIGJ1Zl9vYmot
PmZpbGUtPmZfbW9kZSwKIAkJCQlmaWxlX2NvdW50KGJ1Zl9vYmotPmZpbGUpLAogCQkJCWJ1Zl9v
YmotPmV4cF9uYW1lLAotCQkJCWZpbGVfaW5vZGUoYnVmX29iai0+ZmlsZSktPmlfaW5vKTsKKwkJ
CQlmaWxlX2lub2RlKGJ1Zl9vYmotPmZpbGUpLT5pX2lubywKKwkJCQlidWZfb2JqLT5uYW1lID86
ICIiKTsKIAogCQlyb2JqID0gYnVmX29iai0+cmVzdjsKIAkJd2hpbGUgKHRydWUpIHsKZGlmZiAt
LWdpdCBhL2luY2x1ZGUvbGludXgvZG1hLWJ1Zi5oIGIvaW5jbHVkZS9saW51eC9kbWEtYnVmLmgK
aW5kZXggNTg3MjVmODkwYjViLi41ODI5OThlMTlkZjYgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvbGlu
dXgvZG1hLWJ1Zi5oCisrKyBiL2luY2x1ZGUvbGludXgvZG1hLWJ1Zi5oCkBAIC0yNTUsMTAgKzI1
NSwxMiBAQCBzdHJ1Y3QgZG1hX2J1Zl9vcHMgewogICogQGZpbGU6IGZpbGUgcG9pbnRlciB1c2Vk
IGZvciBzaGFyaW5nIGJ1ZmZlcnMgYWNyb3NzLCBhbmQgZm9yIHJlZmNvdW50aW5nLgogICogQGF0
dGFjaG1lbnRzOiBsaXN0IG9mIGRtYV9idWZfYXR0YWNobWVudCB0aGF0IGRlbm90ZXMgYWxsIGRl
dmljZXMgYXR0YWNoZWQuCiAgKiBAb3BzOiBkbWFfYnVmX29wcyBhc3NvY2lhdGVkIHdpdGggdGhp
cyBidWZmZXIgb2JqZWN0LgotICogQGxvY2s6IHVzZWQgaW50ZXJuYWxseSB0byBzZXJpYWxpemUg
bGlzdCBtYW5pcHVsYXRpb24sIGF0dGFjaC9kZXRhY2ggYW5kIHZtYXAvdW5tYXAKKyAqIEBsb2Nr
OiB1c2VkIGludGVybmFsbHkgdG8gc2VyaWFsaXplIGxpc3QgbWFuaXB1bGF0aW9uLCBhdHRhY2gv
ZGV0YWNoIGFuZAorICogICAgICAgIHZtYXAvdW5tYXAsIGFuZCBhY2Nlc3NlcyB0byBuYW1lCiAg
KiBAdm1hcHBpbmdfY291bnRlcjogdXNlZCBpbnRlcm5hbGx5IHRvIHJlZmNudCB0aGUgdm1hcHMK
ICAqIEB2bWFwX3B0cjogdGhlIGN1cnJlbnQgdm1hcCBwdHIgaWYgdm1hcHBpbmdfY291bnRlciA+
IDAKICAqIEBleHBfbmFtZTogbmFtZSBvZiB0aGUgZXhwb3J0ZXI7IHVzZWZ1bCBmb3IgZGVidWdn
aW5nLgorICogQG5hbWU6IHVzZXJzcGFjZS1wcm92aWRlZCBuYW1lOyB1c2VmdWwgZm9yIGFjY291
bnRpbmcgYW5kIGRlYnVnZ2luZy4KICAqIEBvd25lcjogcG9pbnRlciB0byBleHBvcnRlciBtb2R1
bGU7IHVzZWQgZm9yIHJlZmNvdW50aW5nIHdoZW4gZXhwb3J0ZXIgaXMgYQogICogICAgICAgICBr
ZXJuZWwgbW9kdWxlLgogICogQGxpc3Rfbm9kZTogbm9kZSBmb3IgZG1hX2J1ZiBhY2NvdW50aW5n
IGFuZCBkZWJ1Z2dpbmcuCkBAIC0yODYsNiArMjg4LDcgQEAgc3RydWN0IGRtYV9idWYgewogCXVu
c2lnbmVkIHZtYXBwaW5nX2NvdW50ZXI7CiAJdm9pZCAqdm1hcF9wdHI7CiAJY29uc3QgY2hhciAq
ZXhwX25hbWU7CisJY29uc3QgY2hhciAqbmFtZTsKIAlzdHJ1Y3QgbW9kdWxlICpvd25lcjsKIAlz
dHJ1Y3QgbGlzdF9oZWFkIGxpc3Rfbm9kZTsKIAl2b2lkICpwcml2OwpkaWZmIC0tZ2l0IGEvaW5j
bHVkZS91YXBpL2xpbnV4L2RtYS1idWYuaCBiL2luY2x1ZGUvdWFwaS9saW51eC9kbWEtYnVmLmgK
aW5kZXggZDc1ZGY1MjEwYTRhLi5kYmM3MDkyZTA0YjUgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvdWFw
aS9saW51eC9kbWEtYnVmLmgKKysrIGIvaW5jbHVkZS91YXBpL2xpbnV4L2RtYS1idWYuaApAQCAt
MzUsNyArMzUsMTAgQEAgc3RydWN0IGRtYV9idWZfc3luYyB7CiAjZGVmaW5lIERNQV9CVUZfU1lO
Q19WQUxJRF9GTEFHU19NQVNLIFwKIAkoRE1BX0JVRl9TWU5DX1JXIHwgRE1BX0JVRl9TWU5DX0VO
RCkKIAorI2RlZmluZSBETUFfQlVGX05BTUVfTEVOCTMyCisKICNkZWZpbmUgRE1BX0JVRl9CQVNF
CQknYicKICNkZWZpbmUgRE1BX0JVRl9JT0NUTF9TWU5DCV9JT1coRE1BX0JVRl9CQVNFLCAwLCBz
dHJ1Y3QgZG1hX2J1Zl9zeW5jKQorI2RlZmluZSBETUFfQlVGX1NFVF9OQU1FCV9JT1coRE1BX0JV
Rl9CQVNFLCAxLCBjb25zdCBjaGFyICopCiAKICNlbmRpZgotLSAKMi4yMS4wLjEwMjAuZ2YyODIw
Y2YwMWEtZ29vZwoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
Cmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
