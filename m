Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 8FB06474E7
	for <lists+dri-devel@lfdr.de>; Sun, 16 Jun 2019 16:02:02 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 418E3891B5;
	Sun, 16 Jun 2019 14:01:49 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-pf1-x444.google.com (mail-pf1-x444.google.com
 [IPv6:2607:f8b0:4864:20::444])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6010D88DF5
 for <dri-devel@lists.freedesktop.org>; Fri, 14 Jun 2019 19:02:50 +0000 (UTC)
Received: by mail-pf1-x444.google.com with SMTP id r7so1988091pfl.3
 for <dri-devel@lists.freedesktop.org>; Fri, 14 Jun 2019 12:02:50 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references;
 bh=q4CwzHvSxPdrHbLfdvEnU6XX5mvUWE4s13V3F5wL12w=;
 b=cY+iz2ogZpiImjXJJUWUgb/T71WsvBxtZ7ei1r+j1L4KLke8pCWwu5A5dQUjPALQjh
 ECW2pQtWd7U47CGzsLkAjzdGtQdeXuX1seLjRFQGWAij8bPuSY8vso4aliRxcYSN+lX8
 4mOtyvWLb9BF1VgPwlnGJyhDPsim75UDdvQwy6WpFv63CIeZ58qWcHmJsIID1Ji0adoc
 Dj6jGjSP1UlRRHSjLvUO9zvBXZXlOu0p0csEr6grr7EcgG7uc295oW7KZEsfvIiouJcd
 n1F/4Wacg21psYP1OEJFFFdkcamT0rD0wQC6BON3viCDjzR26S+D0URYDzLHjRFS2pdK
 WkMg==
X-Gm-Message-State: APjAAAVCnSB0xNt51BuSc3KgtXaxbc+Si+Dvp6eZbZpwsWcp9nssgcuZ
 Dv9yjYpRJcoahCdz45lZbUY=
X-Google-Smtp-Source: APXvYqxq86nvk7En+2k6Qmb/e8xJH64H+1W/yXHf3yXI+rH8Q7VcbhbG90OHDiI6i/RtgLk0xZk3Wg==
X-Received: by 2002:a63:ec42:: with SMTP id r2mr38185907pgj.262.1560538969771; 
 Fri, 14 Jun 2019 12:02:49 -0700 (PDT)
Received: from aw-bldr-10.qualcomm.com (i-global254.qualcomm.com.
 [199.106.103.254])
 by smtp.gmail.com with ESMTPSA id d9sm3507675pgj.34.2019.06.14.12.02.48
 (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
 Fri, 14 Jun 2019 12:02:49 -0700 (PDT)
From: Jeffrey Hugo <jeffrey.l.hugo@gmail.com>
To: airlied@linux.ie, daniel@ffwll.ch, thierry.reding@gmail.com,
 sam@ravnborg.org
Subject: [PATCH 2/2] drm/panel: truly: Add MSM8998 MTP support
Date: Fri, 14 Jun 2019 12:02:46 -0700
Message-Id: <20190614190246.34617-1-jeffrey.l.hugo@gmail.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190614185547.34518-1-jeffrey.l.hugo@gmail.com>
References: <20190614185547.34518-1-jeffrey.l.hugo@gmail.com>
X-Mailman-Approved-At: Sun, 16 Jun 2019 14:01:48 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references;
 bh=q4CwzHvSxPdrHbLfdvEnU6XX5mvUWE4s13V3F5wL12w=;
 b=qjIapLAZMVuaAJkOeMRv+8i9iLR84SVKaupIVQsaLF0hzsAZYOnverun5g6jQcwYvR
 z0wRvqyGkeiHYxRTApMjfTIf8Hpf9ZwV1z4LxYcgpedll0fryUO6937UFxqVzo83aO2A
 oROiCTPfXs9tEFuUvws7SZcpWrsWoR4NyG2s/1k3lXf/isUTJsqYCDTVAuA+qwxM4yCP
 +iz+2GTUXiamJCLBw2kx0ZrhO8K0lArk7xf3G8q2kLkaXX4TDP9cc7VIfsMV8PRC5O7j
 sfhjqyIyKtwKI1H5wLGd+idzysSkpM6f6yaq5D4m6Wzr+YwjaPp2JIhtNNfielVHHT2N
 346g==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: mark.rutland@arm.com, devicetree@vger.kernel.org,
 Jeffrey Hugo <jeffrey.l.hugo@gmail.com>, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, bjorn.andersson@linaro.org,
 robh+dt@kernel.org
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIE1TTTg5OTggTVRQIGlzIHRoZSBNU004OTk4IHJlZmVyZW5jZSBwbGF0Zm9ybSwgYW5kIGxp
a2UgdGhlIFNETTg0NSBNVFAKaXQgdXNlcyB0aGUgVHJ1bHkgTlQzNTU4NyBEaXNwbGF5IGRyaXZl
ci4gIEhvd2V2ZXIsIHVubGlrZSB0aGUgU0RNODQ1IE1UUCwKdGhlIGluc3RhbmNlIGluIHRoZSBN
U004OTk4IE1UUCBpcyBhIHNpbmdsZSBEU0kgaW50ZXJmYWNlLCBjb21tYW5kIG1vZGUKdHlwZSBw
YW5lbCB0aGF0IHN1cHBvcnRzIGEgV1FIRCByZXNvbHV0aW9uIGFuZCByZXF1aXJlcyBEU0MgY29t
cHJlc3Npb24uCgpBZGQgc3VwcG9ydCBmb3IgdGhlIE1TTTg5OTggTVRQIGJ5IGV4dGVuZGluZyB0
aGUgZHJpdmVyIHRvIGhhbmRsZSBib3RoCmNvbmZpZ3VyYXRpb25zLgoKTm90ZSB0aGF0IHRoZSBk
ZWxheSBhZnRlciB0aGUgcmVzZXQgaGFzIGJlZW4gZGUtYXNzZXJ0ZWQgaGFzIGJlZW4gZXh0ZW5k
ZWQKdG8gMTAwIG1zLiAgVGhyb3VnaCBleHBlcmltZW50YXRpb24sIGl0IGhhcyBiZWVuIGRldGVy
bWluZWQgdGhhdCB0aGUKTVNNODk5OCBpbnN0YW5jZSByZXF1aXJlcyBhIDUwIG1zIGRlbGF5IGJl
dHdlZW4gcmVzZXQgZGUtYXNzZXJ0IGFuZCBzZW5kaW5nCmNvbmZpZ3VyYXRpb24gY29tbWFuZHMg
Zm9yIHRoZSBkaXNwbGF5IHRvIHdvcmsuICBTaWduaWZpY2FudGx5IHNob3J0ZXIKdGhhbiB0aGF0
LCBhbmQgdGltZW91dHMvZXJyb3JzIG9jY3VyIHNpZ25hbGluZyBhIG5vbi13b3JraW5nIGRpc3Bs
YXkuClNob3J0ZXIgdGhhbiA1MCBtcywgYnV0IGluIHRoZSBiYWxsIHBhcmssIHJlc3VsdHMgaW4g
bm8gImxvdWQiIGVycm9ycywgYnV0Cm5vdGhpbmcgaXMgZGlzcGxheWVkLiAgMTAwIG1zIGlzIHVz
ZWQgc2luY2UgZG91YmxlIHRoZSBtaW5pbXVtIHNob3VsZApndWFyYW50ZWUgZW5vdWdoIGRlbGF5
IGZvciB0aGUgZGV2aWNlIHRvIGZpbmlzaCB3aGF0ZXZlciByZXNldCBwcm9jZXNzaW5nCnNlZW1z
IG5lY2Vzc2FyeSwgd2hpbGUgYWxzbyBwcm92aWRpbmcgYSBzYWZlIGJ1ZmZlciBpbmNhc2UgdGhl
IGV4cGVyaW1lbnRhbAptZWFzdXJlbWVudCB3YXMgc29tZWhvdyBub3QgYWNjdXJhdGUgZW5vdWdo
IGZvciBldmVyeW9uZS4KClNpZ25lZC1vZmYtYnk6IEplZmZyZXkgSHVnbyA8amVmZnJleS5sLmh1
Z29AZ21haWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC10cnVseS1udDM1
NTk3LmMgfCAxNDkgKysrKysrKysrKysrKysrLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCAxMTIgaW5z
ZXJ0aW9ucygrKSwgMzcgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L3BhbmVsL3BhbmVsLXRydWx5LW50MzU1OTcuYyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5l
bC10cnVseS1udDM1NTk3LmMKaW5kZXggNzdlMTMxMWI3YzY5Li41ZWU3NmFjYjhmNDkgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC10cnVseS1udDM1NTk3LmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLXRydWx5LW50MzU1OTcuYwpAQCAtNDksNiArNDks
OCBAQCBzdHJ1Y3QgbnQzNTU5N19jb25maWcgewogCWNvbnN0IHN0cnVjdCBjbWRfc2V0ICpwYW5l
bF9vbl9jbWRzOwogCXUzMiBudW1fb25fY21kczsKIAljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlf
bW9kZSAqZG07CisJYm9vbCBkdWFsX2RzaTsgLyogdHJ1ZSBpZiBwYW5lbCB1c2VzIHR3byBkc2kg
Y29ubmVjdGlvbnMgKi8KKwlib29sIGNtZF90eXBlOyAvKiB0cnVlIGlmIHBhbmVsIGlzIGNvbW1h
bmQgbW9kZSB0eXBlLCBub3QgdmlkZW8gbW9kZSAqLwogfTsKIAogc3RydWN0IHRydWx5X250MzU1
OTcgewpAQCAtNjMsNiArNjUsNyBAQCBzdHJ1Y3QgdHJ1bHlfbnQzNTU5NyB7CiAJc3RydWN0IGJh
Y2tsaWdodF9kZXZpY2UgKmJhY2tsaWdodDsKIAogCXN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRz
aVsyXTsKKwlpbnQgbnVtX2RzaTsKIAogCWNvbnN0IHN0cnVjdCBudDM1NTk3X2NvbmZpZyAqY29u
ZmlnOwogCWJvb2wgcHJlcGFyZWQ7CkBAIC0yMjMsMTIgKzIyNiw0MiBAQCBzdGF0aWMgY29uc3Qg
c3RydWN0IGNtZF9zZXQgcWNvbV8ya19wYW5lbF9tYWdpY19jbWRzW10gPSB7CiAJeyB7IDB4RkIs
IDB4MDEgfSwgMiB9LAogfTsKIAorc3RhdGljIGNvbnN0IHN0cnVjdCBjbWRfc2V0IHFjb21fd3Fo
ZF9jbWRfZHNjX3BhbmVsX21hZ2ljX2NtZHNbXSA9IHsKKwl7IHsgMHhmZiwgMHgxMCB9LCAyIH0s
CisJeyB7IDB4ZmIsIDB4MDEgfSwgMiB9LAorCXsgeyAweGJhLCAweDAzIH0sIDIgfSwKKwl7IHsg
MHhlNSwgMHgwMSB9LCAyIH0sCisJeyB7IDB4YjAsIDB4MDMgfSwgMiB9LAorCXsgeyAweGZmLCAw
eDI4IH0sIDIgfSwKKwl7IHsgMHg3YSwgMHgwMiB9LCAyIH0sCisJeyB7IDB4ZmIsIDB4MDEgfSwg
MiB9LAorCXsgeyAweGZmLCAweDEwIH0sIDIgfSwKKwl7IHsgMHhmYiwgMHgwMSB9LCAyIH0sCisJ
eyB7IDB4YzAsIDB4MDMgfSwgMiB9LAorCXsgeyAweGJiLCAweDEwIH0sIDIgfSwKKwl7IHsgMHhm
ZiwgMHhlMCB9LCAyIH0sCisJeyB7IDB4ZmIsIDB4MDEgfSwgMiB9LAorCXsgeyAweDZiLCAweDNk
IH0sIDIgfSwKKwl7IHsgMHg2YywgMHgzZCB9LCAyIH0sCisJeyB7IDB4NmQsIDB4M2QgfSwgMiB9
LAorCXsgeyAweDZlLCAweDNkIH0sIDIgfSwKKwl7IHsgMHg2ZiwgMHgzZCB9LCAyIH0sCisJeyB7
IDB4MzUsIDB4MDIgfSwgMiB9LAorCXsgeyAweDM2LCAweDcyIH0sIDIgfSwKKwl7IHsgMHgzNywg
MHgxMCB9LCAyIH0sCisJeyB7IDB4MDgsIDB4YzAgfSwgMiB9LAorCXsgeyAweGZmLCAweDI0IH0s
IDIgfSwKKwl7IHsgMHhmYiwgMHgwMSB9LCAyIH0sCisJeyB7IDB4YzYsIDB4MDYgfSwgMiB9LAor
CXsgeyAweGZmLCAweDEwIH0sIDIgfSwKK307CisKIHN0YXRpYyBpbnQgdHJ1bHlfZGNzX3dyaXRl
KHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsLCB1MzIgY29tbWFuZCkKIHsKIAlzdHJ1Y3QgdHJ1bHlf
bnQzNTU5NyAqY3R4ID0gcGFuZWxfdG9fY3R4KHBhbmVsKTsKLQlpbnQgaSwgcmV0OworCWludCBp
LCByZXQgPSAwOwogCi0JZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoY3R4LT5kc2kpOyBpKysp
IHsKKwlmb3IgKGkgPSAwOyBpIDwgY3R4LT5udW1fZHNpOyBpKyspIHsKIAkJcmV0ID0gbWlwaV9k
c2lfZGNzX3dyaXRlKGN0eC0+ZHNpW2ldLCBjb21tYW5kLCBOVUxMLCAwKTsKIAkJaWYgKHJldCA8
IDApIHsKIAkJCURSTV9ERVZfRVJST1IoY3R4LT5kZXYsCkBAIC0yNDcsNyArMjgwLDcgQEAgc3Rh
dGljIGludCB0cnVseV9kY3Nfd3JpdGVfYnVmKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsLAogCWlu
dCByZXQgPSAwOwogCWludCBpOwogCi0JZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoY3R4LT5k
c2kpOyBpKyspIHsKKwlmb3IgKGkgPSAwOyBpIDwgY3R4LT5udW1fZHNpOyBpKyspIHsKIAkJcmV0
ID0gbWlwaV9kc2lfZGNzX3dyaXRlX2J1ZmZlcihjdHgtPmRzaVtpXSwgYnVmLCBzaXplKTsKIAkJ
aWYgKHJldCA8IDApIHsKIAkJCURSTV9ERVZfRVJST1IoY3R4LT5kZXYsCkBAIC0yODQsNyArMzE3
LDcgQEAgc3RhdGljIGludCB0cnVseV8zNTU5N19wb3dlcl9vbihzdHJ1Y3QgdHJ1bHlfbnQzNTU5
NyAqY3R4KQogCWdwaW9kX3NldF92YWx1ZShjdHgtPnJlc2V0X2dwaW8sIDEpOwogCXVzbGVlcF9y
YW5nZSgxMDAwMCwgMjAwMDApOwogCWdwaW9kX3NldF92YWx1ZShjdHgtPnJlc2V0X2dwaW8sIDAp
OwotCXVzbGVlcF9yYW5nZSgxMDAwMCwgMjAwMDApOworCW1zbGVlcCgxMDApOwogCiAJcmV0dXJu
IDA7CiB9CkBAIC0zNDIsNyArMzc1LDggQEAgc3RhdGljIGludCB0cnVseV9udDM1NTk3X3VucHJl
cGFyZShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKIAkJcmV0dXJuIDA7CiAKIAljdHgtPmRzaVsw
XS0+bW9kZV9mbGFncyA9IDA7Ci0JY3R4LT5kc2lbMV0tPm1vZGVfZmxhZ3MgPSAwOworCWlmIChj
dHgtPmNvbmZpZy0+ZHVhbF9kc2kpCisJCWN0eC0+ZHNpWzFdLT5tb2RlX2ZsYWdzID0gMDsKIAog
CXJldCA9IHRydWx5X2Rjc193cml0ZShwYW5lbCwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlfT0ZGKTsK
IAlpZiAocmV0IDwgMCkgewpAQCAtMzg0LDEwICs0MTgsMTIgQEAgc3RhdGljIGludCB0cnVseV9u
dDM1NTk3X3ByZXBhcmUoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwpCiAJaWYgKHJldCA8IDApCiAJ
CXJldHVybiByZXQ7CiAKKwljb25maWcgPSBjdHgtPmNvbmZpZzsKKwogCWN0eC0+ZHNpWzBdLT5t
b2RlX2ZsYWdzIHw9IE1JUElfRFNJX01PREVfTFBNOwotCWN0eC0+ZHNpWzFdLT5tb2RlX2ZsYWdz
IHw9IE1JUElfRFNJX01PREVfTFBNOworCWlmIChjb25maWctPmR1YWxfZHNpKQorCQljdHgtPmRz
aVsxXS0+bW9kZV9mbGFncyB8PSBNSVBJX0RTSV9NT0RFX0xQTTsKIAotCWNvbmZpZyA9IGN0eC0+
Y29uZmlnOwogCXBhbmVsX29uX2NtZHMgPSBjb25maWctPnBhbmVsX29uX2NtZHM7CiAJbnVtX2Nt
ZHMgPSBjb25maWctPm51bV9vbl9jbWRzOwogCkBAIC01MTUsOCArNTUxLDEwIEBAIHN0YXRpYyBp
bnQgdHJ1bHlfbnQzNTU5N19wYW5lbF9hZGQoc3RydWN0IHRydWx5X250MzU1OTcgKmN0eCkKIAkJ
cmV0dXJuIFBUUl9FUlIoY3R4LT5tb2RlX2dwaW8pOwogCX0KIAotCS8qIGR1YWwgcG9ydCAqLwot
CWdwaW9kX3NldF92YWx1ZShjdHgtPm1vZGVfZ3BpbywgMCk7CisJaWYgKGNvbmZpZy0+ZHVhbF9k
c2kpCisJCWdwaW9kX3NldF92YWx1ZShjdHgtPm1vZGVfZ3BpbywgMCk7CisJZWxzZQorCQlncGlv
ZF9zZXRfdmFsdWUoY3R4LT5tb2RlX2dwaW8sIDEpOwogCiAJZHJtX3BhbmVsX2luaXQoJmN0eC0+
cGFuZWwpOwogCWN0eC0+cGFuZWwuZGV2ID0gZGV2OwpAQCAtNTQxLDYgKzU3OSwyMSBAQCBzdGF0
aWMgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgcWNvbV9zZG04NDVfbXRwXzJrX21vZGUg
PSB7CiAJLmZsYWdzID0gMCwKIH07CiAKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlf
bW9kZSBxY29tX21zbTg5OThfbXRwX3dxaGRfbW9kZSA9IHsKKwkubmFtZSA9ICIxNDQweDI1NjAi
LAorCS5jbG9jayA9IDExMzQ0NywKKwkuaGRpc3BsYXkgPSAxNDQwLAorCS5oc3luY19zdGFydCA9
IDE0NDAgKyAxNTQsCisJLmhzeW5jX2VuZCA9IDE0NDAgKyAxNTQgKyAzMiwKKwkuaHRvdGFsID0g
MTQ0MCArIDE1NCArIDMyICsgNjgsCisJLnZkaXNwbGF5ID0gMjU2MCwKKwkudnN5bmNfc3RhcnQg
PSAyNTYwICsgOCwKKwkudnN5bmNfZW5kID0gMjU2MCArIDggKyAxLAorCS52dG90YWwgPSAyNTYw
ICsgOCArIDEgKyA3LAorCS52cmVmcmVzaCA9IDYwLAorCS5mbGFncyA9IDAsCit9OworCiBzdGF0
aWMgY29uc3Qgc3RydWN0IG50MzU1OTdfY29uZmlnIG50MzU1OTdfZGlyID0gewogCS53aWR0aF9t
bSA9IDc0LAogCS5oZWlnaHRfbW0gPSAxMzEsCkBAIC01NDgsMTMgKzYwMSwyNCBAQCBzdGF0aWMg
Y29uc3Qgc3RydWN0IG50MzU1OTdfY29uZmlnIG50MzU1OTdfZGlyID0gewogCS5kbSA9ICZxY29t
X3NkbTg0NV9tdHBfMmtfbW9kZSwKIAkucGFuZWxfb25fY21kcyA9IHFjb21fMmtfcGFuZWxfbWFn
aWNfY21kcywKIAkubnVtX29uX2NtZHMgPSBBUlJBWV9TSVpFKHFjb21fMmtfcGFuZWxfbWFnaWNf
Y21kcyksCisJLmR1YWxfZHNpID0gdHJ1ZSwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgbnQz
NTU5N19jb25maWcgbXNtODk5OF9tdHAgPSB7CisJLndpZHRoX21tID0gNzQsCisJLmhlaWdodF9t
bSA9IDEzMSwKKwkucGFuZWxfbmFtZSA9ICJxY29tX21zbTg5OThfbXRwX3dxaGRfcGFuZWwiLAor
CS5kbSA9ICZxY29tX21zbTg5OThfbXRwX3dxaGRfbW9kZSwKKwkucGFuZWxfb25fY21kcyA9IHFj
b21fd3FoZF9jbWRfZHNjX3BhbmVsX21hZ2ljX2NtZHMsCisJLm51bV9vbl9jbWRzID0gQVJSQVlf
U0laRShxY29tX3dxaGRfY21kX2RzY19wYW5lbF9tYWdpY19jbWRzKSwKKwkuY21kX3R5cGUgPSB0
cnVlLAogfTsKIAogc3RhdGljIGludCB0cnVseV9udDM1NTk3X3Byb2JlKHN0cnVjdCBtaXBpX2Rz
aV9kZXZpY2UgKmRzaSkKIHsKIAlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmZHNpLT5kZXY7CiAJc3Ry
dWN0IHRydWx5X250MzU1OTcgKmN0eDsKLQlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kxX2Rl
dmljZTsKKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kxX2RldmljZSA9IE5VTEw7CiAJc3Ry
dWN0IGRldmljZV9ub2RlICpkc2kxOwogCXN0cnVjdCBtaXBpX2RzaV9ob3N0ICpkc2kxX2hvc3Q7
CiAJc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpX2RldjsKQEAgLTU3MiwxMyArNjM2LDYgQEAg
c3RhdGljIGludCB0cnVseV9udDM1NTk3X3Byb2JlKHN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRz
aSkKIAlpZiAoIWN0eCkKIAkJcmV0dXJuIC1FTk9NRU07CiAKLQkvKgotCSAqIFRoaXMgZGV2aWNl
IHJlcHJlc2VudHMgaXRzZWxmIGFzIG9uZSB3aXRoIHR3byBpbnB1dCBwb3J0cyB3aGljaCBhcmUK
LQkgKiBmZWQgYnkgdGhlIG91dHB1dCBwb3J0cyBvZiB0aGUgdHdvIERTSSBjb250cm9sbGVycyAu
IFRoZSBEU0kwIGlzCi0JICogdGhlIG1hc3RlciBjb250cm9sbGVyIGFuZCBoYXMgbW9zdCBvZiB0
aGUgcGFuZWwgcmVsYXRlZCBpbmZvIGluIGl0cwotCSAqIGNoaWxkIG5vZGUuCi0JICovCi0KIAlj
dHgtPmNvbmZpZyA9IG9mX2RldmljZV9nZXRfbWF0Y2hfZGF0YShkZXYpOwogCiAJaWYgKCFjdHgt
PmNvbmZpZykgewpAQCAtNTg2LDI1ICs2NDMsMzYgQEAgc3RhdGljIGludCB0cnVseV9udDM1NTk3
X3Byb2JlKHN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSkKIAkJcmV0dXJuIC1FTk9ERVY7CiAJ
fQogCi0JZHNpMSA9IG9mX2dyYXBoX2dldF9yZW1vdGVfbm9kZShkc2ktPmRldi5vZl9ub2RlLCAx
LCAtMSk7Ci0JaWYgKCFkc2kxKSB7Ci0JCURSTV9ERVZfRVJST1IoZGV2LAotCQkJImZhaWxlZCB0
byBnZXQgcmVtb3RlIG5vZGUgZm9yIGRzaTFfZGV2aWNlXG4iKTsKLQkJcmV0dXJuIC1FTk9ERVY7
Ci0JfQorCWN0eC0+bnVtX2RzaSA9IDE7CisJLyoKKwkgKiBUaGlzIGRldmljZSByZXByZXNlbnRz
IGl0c2VsZiBhcyBvbmUgd2l0aCB0d28gaW5wdXQgcG9ydHMgd2hpY2ggYXJlCisJICogZmVkIGJ5
IHRoZSBvdXRwdXQgcG9ydHMgb2YgdGhlIHR3byBEU0kgY29udHJvbGxlcnMgLiBUaGUgRFNJMCBp
cworCSAqIHRoZSBtYXN0ZXIgY29udHJvbGxlciBhbmQgaGFzIG1vc3Qgb2YgdGhlIHBhbmVsIHJl
bGF0ZWQgaW5mbyBpbiBpdHMKKwkgKiBjaGlsZCBub2RlLgorCSAqLworCWlmIChjdHgtPmNvbmZp
Zy0+ZHVhbF9kc2kpIHsKKwkJY3R4LT5udW1fZHNpID0gMjsKIAotCWRzaTFfaG9zdCA9IG9mX2Zp
bmRfbWlwaV9kc2lfaG9zdF9ieV9ub2RlKGRzaTEpOwotCW9mX25vZGVfcHV0KGRzaTEpOwotCWlm
ICghZHNpMV9ob3N0KSB7Ci0JCURSTV9ERVZfRVJST1IoZGV2LCAiZmFpbGVkIHRvIGZpbmQgZHNp
IGhvc3RcbiIpOwotCQlyZXR1cm4gLUVQUk9CRV9ERUZFUjsKLQl9CisJCWRzaTEgPSBvZl9ncmFw
aF9nZXRfcmVtb3RlX25vZGUoZHNpLT5kZXYub2Zfbm9kZSwgMSwgLTEpOworCQlpZiAoIWRzaTEp
IHsKKwkJCURSTV9ERVZfRVJST1IoZGV2LAorCQkJCSJmYWlsZWQgdG8gZ2V0IHJlbW90ZSBub2Rl
IGZvciBkc2kxX2RldmljZVxuIik7CisJCQlyZXR1cm4gLUVOT0RFVjsKKwkJfQorCisJCWRzaTFf
aG9zdCA9IG9mX2ZpbmRfbWlwaV9kc2lfaG9zdF9ieV9ub2RlKGRzaTEpOworCQlvZl9ub2RlX3B1
dChkc2kxKTsKKwkJaWYgKCFkc2kxX2hvc3QpIHsKKwkJCURSTV9ERVZfRVJST1IoZGV2LCAiZmFp
bGVkIHRvIGZpbmQgZHNpIGhvc3RcbiIpOworCQkJcmV0dXJuIC1FUFJPQkVfREVGRVI7CisJCX0K
IAotCS8qIHJlZ2lzdGVyIHRoZSBzZWNvbmQgRFNJIGRldmljZSAqLwotCWRzaTFfZGV2aWNlID0g
bWlwaV9kc2lfZGV2aWNlX3JlZ2lzdGVyX2Z1bGwoZHNpMV9ob3N0LCAmaW5mbyk7Ci0JaWYgKElT
X0VSUihkc2kxX2RldmljZSkpIHsKLQkJRFJNX0RFVl9FUlJPUihkZXYsICJmYWlsZWQgdG8gY3Jl
YXRlIGRzaSBkZXZpY2VcbiIpOwotCQlyZXR1cm4gUFRSX0VSUihkc2kxX2RldmljZSk7CisJCS8q
IHJlZ2lzdGVyIHRoZSBzZWNvbmQgRFNJIGRldmljZSAqLworCQlkc2kxX2RldmljZSA9IG1pcGlf
ZHNpX2RldmljZV9yZWdpc3Rlcl9mdWxsKGRzaTFfaG9zdCwgJmluZm8pOworCQlpZiAoSVNfRVJS
KGRzaTFfZGV2aWNlKSkgeworCQkJRFJNX0RFVl9FUlJPUihkZXYsICJmYWlsZWQgdG8gY3JlYXRl
IGRzaSBkZXZpY2VcbiIpOworCQkJcmV0dXJuIFBUUl9FUlIoZHNpMV9kZXZpY2UpOworCQl9CiAJ
fQogCiAJbWlwaV9kc2lfc2V0X2RydmRhdGEoZHNpLCBjdHgpOwpAQCAtNjE5LDEyICs2ODcsMTQg
QEAgc3RhdGljIGludCB0cnVseV9udDM1NTk3X3Byb2JlKHN0cnVjdCBtaXBpX2RzaV9kZXZpY2Ug
KmRzaSkKIAkJZ290byBlcnJfcGFuZWxfYWRkOwogCX0KIAotCWZvciAoaSA9IDA7IGkgPCBBUlJB
WV9TSVpFKGN0eC0+ZHNpKTsgaSsrKSB7CisJZm9yIChpID0gMDsgaSA8IGN0eC0+bnVtX2RzaTsg
aSsrKSB7CiAJCWRzaV9kZXYgPSBjdHgtPmRzaVtpXTsKIAkJZHNpX2Rldi0+bGFuZXMgPSA0Owog
CQlkc2lfZGV2LT5mb3JtYXQgPSBNSVBJX0RTSV9GTVRfUkdCODg4OwotCQlkc2lfZGV2LT5tb2Rl
X2ZsYWdzID0gTUlQSV9EU0lfTU9ERV9WSURFTyB8IE1JUElfRFNJX01PREVfTFBNIHwKKwkJZHNp
X2Rldi0+bW9kZV9mbGFncyA9ICBNSVBJX0RTSV9NT0RFX0xQTSB8CiAJCQlNSVBJX0RTSV9DTE9D
S19OT05fQ09OVElOVU9VUzsKKwkJaWYgKCFjdHgtPmNvbmZpZy0+Y21kX3R5cGUpCisJCQlkc2lf
ZGV2LT5tb2RlX2ZsYWdzIHw9IE1JUElfRFNJX01PREVfVklERU87CiAJCXJldCA9IG1pcGlfZHNp
X2F0dGFjaChkc2lfZGV2KTsKIAkJaWYgKHJldCA8IDApIHsKIAkJCURSTV9ERVZfRVJST1IoZGV2
LApAQCAtNjM4LDcgKzcwOCw4IEBAIHN0YXRpYyBpbnQgdHJ1bHlfbnQzNTU5N19wcm9iZShzdHJ1
Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kpCiBlcnJfZHNpX2F0dGFjaDoKIAlkcm1fcGFuZWxfcmVt
b3ZlKCZjdHgtPnBhbmVsKTsKIGVycl9wYW5lbF9hZGQ6Ci0JbWlwaV9kc2lfZGV2aWNlX3VucmVn
aXN0ZXIoZHNpMV9kZXZpY2UpOworCWlmIChjdHgtPmNvbmZpZy0+ZHVhbF9kc2kpCisJCW1pcGlf
ZHNpX2RldmljZV91bnJlZ2lzdGVyKGRzaTFfZGV2aWNlKTsKIAlyZXR1cm4gcmV0OwogfQogCkBA
IC02NjIsNiArNzMzLDEwIEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3Qgb2ZfZGV2aWNlX2lkIHRydWx5
X250MzU1OTdfb2ZfbWF0Y2hbXSA9IHsKIAkJLmNvbXBhdGlibGUgPSAidHJ1bHksbnQzNTU5Ny0y
Sy1kaXNwbGF5IiwKIAkJLmRhdGEgPSAmbnQzNTU5N19kaXIsCiAJfSwKKwl7CisJCS5jb21wYXRp
YmxlID0gInRydWx5LG50MzU1OTctd3FoZC1jbWQtZHNjLWRpc3BsYXkiLAorCQkuZGF0YSA9ICZt
c204OTk4X210cCwKKwl9LAogCXsgfQogfTsKIE1PRFVMRV9ERVZJQ0VfVEFCTEUob2YsIHRydWx5
X250MzU1OTdfb2ZfbWF0Y2gpOwotLSAKMi4xNy4xCgpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBs
aXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1h
bi9saXN0aW5mby9kcmktZGV2ZWw=
