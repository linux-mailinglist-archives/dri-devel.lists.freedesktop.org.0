Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id A2409BC0D2
	for <lists+dri-devel@lfdr.de>; Tue, 24 Sep 2019 05:56:26 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 152536E9EA;
	Tue, 24 Sep 2019 03:56:23 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-oi1-x242.google.com (mail-oi1-x242.google.com
 [IPv6:2607:f8b0:4864:20::242])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0456C6E9EA
 for <dri-devel@lists.freedesktop.org>; Tue, 24 Sep 2019 03:56:20 +0000 (UTC)
Received: by mail-oi1-x242.google.com with SMTP id i185so391612oif.9
 for <dri-devel@lists.freedesktop.org>; Mon, 23 Sep 2019 20:56:20 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=EJMU0HK9vJ1lowa4jWCUIKkeVq+MEDMO5VsUdTJtPh0=;
 b=RdlnGxeRV9/c4RilrVpqyo1vh8jokWLIXFMAoTDDv/2hxeIh+ZBAUXVf65IKPwrEZA
 zqqF50pmzbex6jlv+hwmBpv3XgQWaDn2dq0cmNuIaosIGcCsNy5IY7Xl5A2mVOvTA+7Z
 VBZSfTws5DEEQxcyp8rH75qEDzdjF8AWDXBGFol5kTx9teFCvlmnq/sbyVmOB63yo9xT
 AD8AyonfVbPvyPaYa54VOC2eiThuBJy2MtWglwAP4gE5A/4C7Akb0x1ShAfik7bqohGn
 4n02uzE7p3qD1NWCe9XXiEt9aiAAfNsWpnD67HxOlvgMOVfXah6os2AIG0vhCgJupzQh
 1eRg==
X-Gm-Message-State: APjAAAX/tI9NdqftZgrULhcR/LwMJ2sNR2KZsbayFORSsdhzk6dNQ06I
 EYiPubsiuAH5S7qmzyk0VEBn7An3DbWc2ZUOBzo=
X-Google-Smtp-Source: APXvYqyeJ3XadzxXr+vuPxYqDz3qrYWEEDzYeQlgusvb6Yi4LNK7UdCueErjHB+JQrqvSKpV5pipi3E/EKxI+SYChI0=
X-Received: by 2002:a05:6808:b0d:: with SMTP id
 s13mr540393oij.52.1569297379402; 
 Mon, 23 Sep 2019 20:56:19 -0700 (PDT)
MIME-Version: 1.0
References: <1569248002-2485-1-git-send-email-laurentiu.palcu@nxp.com>
 <1569248002-2485-4-git-send-email-laurentiu.palcu@nxp.com>
In-Reply-To: <1569248002-2485-4-git-send-email-laurentiu.palcu@nxp.com>
From: Ying Liu <gnuiyl@gmail.com>
Date: Tue, 24 Sep 2019 11:56:07 +0800
Message-ID: <CAOcKUNUWrswJ0jZc5SkvYv68wSqL6Js9X0Mey6_w-OmzLyvVRQ@mail.gmail.com>
Subject: Re: [PATCH 3/5] drm/imx: Add initial support for DCSS on iMX8MQ
To: Laurentiu Palcu <laurentiu.palcu@nxp.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=EJMU0HK9vJ1lowa4jWCUIKkeVq+MEDMO5VsUdTJtPh0=;
 b=CMDVbKVd78FFKUwYPDBdTgUWeYzNOTfu7B1Geg1SALqjhtIrt1DA6ZAlGl+PUpNLDn
 yTL4KNnrQeyA3Kvg9aufv7sZABCyqCKbVuSWH94zsQgexBlaxc+dJD2vfTisTBVySKpH
 8VmSanrKtfHrvnPHPeX5HOIhXOpSkk+tv3+kmz4GBYPgE3n8K6wcpuf37Gwg34BGXyX4
 gZIFbkfgtjiI7dW5wT0tvGnImdMTl49cxtkZumcPJdOAjNht30lJ99ojb2JceZYbmytg
 EDZXdAinWbtfIuyhuU4EXZsL6zx/NVZ8CKFK0uR+0aP1L/wAItj1nBvUW+9psyYrUT+e
 2hBA==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Shawn Guo <shawnguo@kernel.org>, Sascha Hauer <s.hauer@pengutronix.de>,
 linux-kernel@vger.kernel.org,
 DRI Development <dri-devel@lists.freedesktop.org>,
 NXP Linux Team <linux-imx@nxp.com>,
 Pengutronix Kernel Team <kernel@pengutronix.de>, agx@sigxcpu.org,
 linux-arm-kernel@lists.infradead.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SGksCgpPbiBNb24sIFNlcCAyMywgMjAxOSBhdCAxMDoyMiBQTSBMYXVyZW50aXUgUGFsY3UKPGxh
dXJlbnRpdS5wYWxjdUBueHAuY29tPiB3cm90ZToKPgo+IFRoaXMgYWRkcyBpbml0aWFsIHN1cHBv
cnQgZm9yIGlNWDhNUSdzIERpc3BsYXkgQ29udHJvbGxlciBTdWJzeXN0ZW0gKERDU1MpLgo+IFNv
bWUgb2YgaXRzIGNhcGFiaWxpdGllcyBpbmNsdWRlOgo+ICAqIDRLQDYwZnBzOwo+ICAqIEhEUjEw
Owo+ICAqIG9uZSBncmFwaGljcyBhbmQgMiB2aWRlbyBwaXBlbGluZXM7Cj4gICogb24tdGhlLWZs
eSBkZWNvbXByZXNzaW9uIG9mIGNvbXByZXNzZWQgdmlkZW8gYW5kIGdyYXBoaWNzOwo+Cj4gVGhl
IHJlZmVyZW5jZSBtYW51YWwgY2FuIGJlIGZvdW5kIGhlcmU6Cj4gaHR0cHM6Ly93d3cubnhwLmNv
bS93ZWJhcHAvRG93bmxvYWQ/Y29sQ29kZT1JTVg4TURRTFFSTQo+Cj4gVGhlIGN1cnJlbnQgcGF0
Y2ggYWRkcyBvbmx5IGJhc2ljIGZ1bmN0aW9uYWxpdHk6IG9uZSBwcmltYXJ5IHBsYW5lIGZvcgo+
IGdyYXBoaWNzLCBsaW5lYXIsIHRpbGVkIGFuZCBzdXBlci10aWxlZCBidWZmZXJzIHN1cHBvcnQg
KG5vIGdyYXBoaWNzCj4gZGVjb21wcmVzc2lvbiB5ZXQpLCBubyBIRFIxMCBhbmQgbm8gdmlkZW8g
cGxhbmVzLgo+Cj4gVmlkZW8gcGxhbmVzIHN1cHBvcnQgYW5kIEhEUjEwIHdpbGwgYmUgYWRkZWQg
aW4gc3Vic2VxdWVudCBwYXRjaGVzIG9uY2UKPiBwZXItcGxhbmUgZGUtZ2FtbWEvQ1NDL2dhbW1h
IHN1cHBvcnQgaXMgaW4uCj4KPiBTaWduZWQtb2ZmLWJ5OiBMYXVyZW50aXUgUGFsY3UgPGxhdXJl
bnRpdS5wYWxjdUBueHAuY29tPgo+IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vaW14L0tjb25maWcg
ICAgICAgICAgICB8ICAgMiArCj4gIGRyaXZlcnMvZ3B1L2RybS9pbXgvTWFrZWZpbGUgICAgICAg
ICAgIHwgICAxICsKPiAgZHJpdmVycy9ncHUvZHJtL2lteC9kY3NzL0tjb25maWcgICAgICAgfCAg
IDcgKwo+ICBkcml2ZXJzL2dwdS9kcm0vaW14L2Rjc3MvTWFrZWZpbGUgICAgICB8ICAgNiArCj4g
IGRyaXZlcnMvZ3B1L2RybS9pbXgvZGNzcy9kY3NzLWJsa2N0bC5jIHwgIDc1ICsrKwo+ICBkcml2
ZXJzL2dwdS9kcm0vaW14L2Rjc3MvZGNzcy1jcnRjLmMgICB8IDIyMyArKysrKysrKysKPiAgZHJp
dmVycy9ncHUvZHJtL2lteC9kY3NzL2Rjc3MtY3R4bGQuYyAgfCA0NDcgKysrKysrKysrKysrKysr
KysrCj4gIGRyaXZlcnMvZ3B1L2RybS9pbXgvZGNzcy9kY3NzLWRldi5jICAgIHwgMjg2ICsrKysr
KysrKysrKwo+ICBkcml2ZXJzL2dwdS9kcm0vaW14L2Rjc3MvZGNzcy1kZXYuaCAgICB8IDE5NSAr
KysrKysrKwo+ICBkcml2ZXJzL2dwdS9kcm0vaW14L2Rjc3MvZGNzcy1kcHIuYyAgICB8IDU1MiAr
KysrKysrKysrKysrKysrKysrKysrCj4gIGRyaXZlcnMvZ3B1L2RybS9pbXgvZGNzcy9kY3NzLWRy
di5jICAgIHwgMTgyICsrKysrKysrCj4gIGRyaXZlcnMvZ3B1L2RybS9pbXgvZGNzcy9kY3NzLWR0
Zy5jICAgIHwgNDM4ICsrKysrKysrKysrKysrKysrCj4gIGRyaXZlcnMvZ3B1L2RybS9pbXgvZGNz
cy9kY3NzLWttcy5jICAgIHwgMzIxICsrKysrKysrKysrKysKPiAgZHJpdmVycy9ncHUvZHJtL2lt
eC9kY3NzL2Rjc3Mta21zLmggICAgfCAgNTIgKysrCj4gIGRyaXZlcnMvZ3B1L2RybS9pbXgvZGNz
cy9kY3NzLXBsYW5lLmMgIHwgNDE4ICsrKysrKysrKysrKysrKysrCj4gIGRyaXZlcnMvZ3B1L2Ry
bS9pbXgvZGNzcy9kY3NzLXNjYWxlci5jIHwgODMwICsrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKwo+ICBkcml2ZXJzL2dwdS9kcm0vaW14L2Rjc3MvZGNzcy1zcy5jICAgICB8IDE3OSAr
KysrKysrCj4gIDE3IGZpbGVzIGNoYW5nZWQsIDQyMTQgaW5zZXJ0aW9ucygrKQo+ICBjcmVhdGUg
bW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2lteC9kY3NzL0tjb25maWcKPiAgY3JlYXRlIG1v
ZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pbXgvZGNzcy9NYWtlZmlsZQo+ICBjcmVhdGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2lteC9kY3NzL2Rjc3MtYmxrY3RsLmMKPiAgY3JlYXRl
IG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pbXgvZGNzcy9kY3NzLWNydGMuYwo+ICBjcmVh
dGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2lteC9kY3NzL2Rjc3MtY3R4bGQuYwo+ICBj
cmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2lteC9kY3NzL2Rjc3MtZGV2LmMKPiAg
Y3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pbXgvZGNzcy9kY3NzLWRldi5oCj4g
IGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaW14L2Rjc3MvZGNzcy1kcHIuYwoK
RFBSIGVtYmVkZGVkIGluIGkuTVg4UU0gJiBpLk1YOFFYUCBTb0NzIGhhcwpjb21wYXRpYmxlIHJl
Z2lzdGVyIGRlZmluaXRpb25zIHdpdGggdGhlIG9uZSBpbiBpLk1YOE1RLgpUb2dldGhlciB3aXRo
IFBSRyhQcmVmZXRjaCBSZXNvbHZlIEdhc2tldCksIERQUiBzZXJ2ZXMKdGhlIGRpc3BsYXkgY29u
dHJvbGxlciBEUFUgb2YgaS5NWDhRTSAmIGkuTVg4UVhQIFNvQ3MKYXMgdGhlIHByZWZldGNoIGVu
Z2luZS4gIElNSE8sIHRoZXJlIHNob3VsZCBiZSBhIHNlcGFyYXRlCkRQUiBkcml2ZXIgd2hpY2gg
c3RhbmRzIG91dCBzaWRlIG9mIHRoZSBkY3NzIGRpcmVjdG9yeSBhbmQKaGFzIERUIGNvbXBhdGli
bGUgc3RyaW5ncyBmb3IgaS5NWDhNUSwgaS5NWDhRTSBhbmQKaS5NWDhRWFAgU29Dcy4KCj4gIGNy
ZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaW14L2Rjc3MvZGNzcy1kcnYuYwo+ICBj
cmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2lteC9kY3NzL2Rjc3MtZHRnLmMKPiAg
Y3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pbXgvZGNzcy9kY3NzLWttcy5jCj4g
IGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaW14L2Rjc3MvZGNzcy1rbXMuaAo+
ICBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2lteC9kY3NzL2Rjc3MtcGxhbmUu
Ywo+ICBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2lteC9kY3NzL2Rjc3Mtc2Nh
bGVyLmMKPiAgY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pbXgvZGNzcy9kY3Nz
LXNzLmMKPgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaW14L0tjb25maWcgYi9kcml2
ZXJzL2dwdS9kcm0vaW14L0tjb25maWcKPiBpbmRleCAyMDdiZjc0Li42MjMxMDQ4IDEwMDY0NAo+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pbXgvS2NvbmZpZwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pbXgvS2NvbmZpZwo+IEBAIC0zOSwzICszOSw1IEBAIGNvbmZpZyBEUk1fSU1YX0hETUkKPiAg
ICAgICAgIGRlcGVuZHMgb24gRFJNX0lNWAo+ICAgICAgICAgaGVscAo+ICAgICAgICAgICBDaG9v
c2UgdGhpcyBpZiB5b3Ugd2FudCB0byB1c2UgSERNSSBvbiBpLk1YNi4KPiArCj4gK3NvdXJjZSAi
ZHJpdmVycy9ncHUvZHJtL2lteC9kY3NzL0tjb25maWciCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pbXgvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vaW14L01ha2VmaWxlCj4gaW5k
ZXggMjFjZGNjMi4uYjY0NGRlZiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaW14L01h
a2VmaWxlCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2lteC9NYWtlZmlsZQo+IEBAIC05LDMgKzks
NCBAQCBvYmotJChDT05GSUdfRFJNX0lNWF9UVkUpICs9IGlteC10dmUubwo+ICBvYmotJChDT05G
SUdfRFJNX0lNWF9MREIpICs9IGlteC1sZGIubwo+Cj4gIG9iai0kKENPTkZJR19EUk1fSU1YX0hE
TUkpICs9IGR3X2hkbWktaW14Lm8KPiArb2JqLSQoQ09ORklHX0RSTV9JTVhfRENTUykgKz0gZGNz
cy8KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2lteC9kY3NzL0tjb25maWcgYi9kcml2
ZXJzL2dwdS9kcm0vaW14L2Rjc3MvS2NvbmZpZwo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0Cj4gaW5k
ZXggMDAwMDAwMDAuLjYzOTljMTIKPiAtLS0gL2Rldi9udWxsCj4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2lteC9kY3NzL0tjb25maWcKPiBAQCAtMCwwICsxLDcgQEAKPiArY29uZmlnIERSTV9JTVhf
RENTUwo+ICsgICAgICAgdHJpc3RhdGUgImkuTVg4TVEgRENTUyIKPiArICAgICAgIHNlbGVjdCBS
RVNFVF9DT05UUk9MTEVSCj4gKyAgICAgICBzZWxlY3QgSU1YX0lSUVNURUVSCj4gKyAgICAgICBo
ZWxwCj4gKyAgICAgICAgIENob29zZSB0aGlzIGlmIHlvdSBoYXZlIGEgTlhQIGkuTVg4TVEgYmFz
ZWQgc3lzdGVtIGFuZCB3YW50IHRvIHVzZSB0aGUKPiArICAgICAgICAgRGlzcGxheSBDb250cm9s
bGVyIFN1YnN5c3RlbS4gVGhpcyBvcHRpb24gZW5hYmxlcyBEQ1NTIHN1cHBvcnQuCj4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pbXgvZGNzcy9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2Ry
bS9pbXgvZGNzcy9NYWtlZmlsZQo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0Cj4gaW5kZXggMDAwMDAw
MDAuLjhjN2M4ZGEKPiAtLS0gL2Rldi9udWxsCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2lteC9k
Y3NzL01ha2VmaWxlCj4gQEAgLTAsMCArMSw2IEBACj4gK2lteC1kY3NzLW9ianMgOj0gZGNzcy1k
cnYubyBkY3NzLWRldi5vIGRjc3MtYmxrY3RsLm8gZGNzcy1jdHhsZC5vIGRjc3MtZHRnLm8gXAo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRjc3Mtc3MubyBkY3NzLWRwci5vIGRj
c3Mtc2NhbGVyLm8gZGNzcy1rbXMubyBkY3NzLWNydGMubyBcCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgZGNzcy1wbGFuZS5vCj4gKwo+ICtvYmotJChDT05GSUdfRFJNX0lNWF9E
Q1NTKSArPSBpbXgtZGNzcy5vCj4gKwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaW14
L2Rjc3MvZGNzcy1ibGtjdGwuYyBiL2RyaXZlcnMvZ3B1L2RybS9pbXgvZGNzcy9kY3NzLWJsa2N0
bC5jCj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRleCAwMDAwMDAwMC4uZWU3ZmZhMQo+IC0t
LSAvZGV2L251bGwKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaW14L2Rjc3MvZGNzcy1ibGtjdGwu
Ywo+IEBAIC0wLDAgKzEsNzUgQEAKPiArLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0y
LjAKPiArLyoKPiArICogQ29weXJpZ2h0IDIwMTkgTlhQLgo+ICsgKi8KPiArCj4gKyNpbmNsdWRl
IDxsaW51eC9kZXZpY2UuaD4KPiArI2luY2x1ZGUgPGxpbnV4L29mLmg+Cj4gKwo+ICsjaW5jbHVk
ZSAiZGNzcy1kZXYuaCIKPiArCj4gKyNkZWZpbmUgRENTU19CTEtDVExfUkVTRVRfQ1RSTCAgICAg
ICAgIDB4MDAKPiArI2RlZmluZSAgIEJfQ0xLX1JFU0VUTiAgICAgICAgICAgICAgICAgQklUKDAp
Cj4gKyNkZWZpbmUgICBBUEJfQ0xLX1JFU0VUTiAgICAgICAgICAgICAgIEJJVCgxKQo+ICsjZGVm
aW5lICAgUF9DTEtfUkVTRVROICAgICAgICAgICAgICAgICBCSVQoMikKPiArI2RlZmluZSAgIFJU
Ul9DTEtfUkVTRVROICAgICAgICAgICAgICAgQklUKDMpCj4gKyNkZWZpbmUgRENTU19CTEtDVExf
Q09OVFJPTDAgICAgICAgICAgIDB4MTAKPiArI2RlZmluZSAgIEhETUlfTUlQSV9DTEtfU0VMICAg
ICAgICAgICAgQklUKDApCj4gKyNkZWZpbmUgICBESVNQTUlYX1JFRkNMS19TRUxfUE9TICAgICAg
IDQKPiArI2RlZmluZSAgIERJU1BNSVhfUkVGQ0xLX1NFTF9NQVNLICAgICAgR0VOTUFTSyg1LCA0
KQo+ICsjZGVmaW5lICAgRElTUE1JWF9QSVhDTEtfU0VMICAgICAgICAgICBCSVQoOCkKPiArI2Rl
ZmluZSAgIEhETUlfU1JDX1NFQ1VSRV9FTiAgICAgICAgICAgQklUKDE2KQo+ICsKPiArc3RydWN0
IGRjc3NfYmxrY3RsIHsKPiArICAgICAgIHN0cnVjdCBkZXZpY2UgKmRldjsKPiArICAgICAgIHZv
aWQgX19pb21lbSAqYmFzZV9yZWc7Cj4gKwo+ICsgICAgICAgYm9vbCBoZG1pX291dHB1dDsKPiAr
fTsKPiArCj4gK3ZvaWQgZGNzc19ibGtjdGxfY2ZnKHN0cnVjdCBkY3NzX2Jsa2N0bCAqYmxrY3Rs
KQo+ICt7Cj4gKyAgICAgICBpZiAoYmxrY3RsLT5oZG1pX291dHB1dCkKPiArICAgICAgICAgICAg
ICAgZGNzc193cml0ZWwoMCwgYmxrY3RsLT5iYXNlX3JlZyArIERDU1NfQkxLQ1RMX0NPTlRST0ww
KTsKPiArICAgICAgIGVsc2UKPiArICAgICAgICAgICAgICAgZGNzc193cml0ZWwoRElTUE1JWF9Q
SVhDTEtfU0VMLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICBibGtjdGwtPmJhc2VfcmVn
ICsgRENTU19CTEtDVExfQ09OVFJPTDApOwo+ICsKPiArICAgICAgIGRjc3Nfc2V0KEJfQ0xLX1JF
U0VUTiB8IEFQQl9DTEtfUkVTRVROIHwgUF9DTEtfUkVTRVROIHwgUlRSX0NMS19SRVNFVE4sCj4g
KyAgICAgICAgICAgICAgICBibGtjdGwtPmJhc2VfcmVnICsgRENTU19CTEtDVExfUkVTRVRfQ1RS
TCk7Cj4gK30KPiArCj4gK2ludCBkY3NzX2Jsa2N0bF9pbml0KHN0cnVjdCBkY3NzX2RldiAqZGNz
cywgdW5zaWduZWQgbG9uZyBibGtjdGxfYmFzZSkKPiArewo+ICsgICAgICAgc3RydWN0IGRjc3Nf
YmxrY3RsICpibGtjdGw7Cj4gKwo+ICsgICAgICAgYmxrY3RsID0gZGV2bV9remFsbG9jKGRjc3Mt
PmRldiwgc2l6ZW9mKCpibGtjdGwpLCBHRlBfS0VSTkVMKTsKPiArICAgICAgIGlmICghYmxrY3Rs
KQo+ICsgICAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKPiArCj4gKyAgICAgICBibGtjdGwt
PmJhc2VfcmVnID0gZGV2bV9pb3JlbWFwKGRjc3MtPmRldiwgYmxrY3RsX2Jhc2UsIFNaXzRLKTsK
PiArICAgICAgIGlmICghYmxrY3RsLT5iYXNlX3JlZykgewo+ICsgICAgICAgICAgICAgICBkZXZf
ZXJyKGRjc3MtPmRldiwgInVuYWJsZSB0byByZW1hcCBCTEsgQ1RSTCBiYXNlXG4iKTsKPiArICAg
ICAgICAgICAgICAgZGV2bV9rZnJlZShkY3NzLT5kZXYsIGJsa2N0bCk7Cj4gKyAgICAgICAgICAg
ICAgIHJldHVybiAtRU5PTUVNOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGRjc3MtPmJsa2N0
bCA9IGJsa2N0bDsKPiArICAgICAgIGJsa2N0bC0+ZGV2ID0gZGNzcy0+ZGV2Owo+ICsgICAgICAg
YmxrY3RsLT5oZG1pX291dHB1dCA9IGRjc3MtPmhkbWlfb3V0cHV0Owo+ICsKPiArICAgICAgIGRj
c3NfYmxrY3RsX2NmZyhibGtjdGwpOwo+ICsKPiArICAgICAgIHJldHVybiAwOwo+ICt9Cj4gKwo+
ICt2b2lkIGRjc3NfYmxrY3RsX2V4aXQoc3RydWN0IGRjc3NfYmxrY3RsICpibGtjdGwpCj4gK3sK
PiArICAgICAgIGRjc3NfY2xyKFBfQ0xLX1JFU0VUTiB8IFJUUl9DTEtfUkVTRVROLAo+ICsgICAg
ICAgICAgICAgICAgYmxrY3RsLT5iYXNlX3JlZyArIERDU1NfQkxLQ1RMX1JFU0VUX0NUUkwpOwo+
ICsKPiArICAgICAgIGlmIChibGtjdGwtPmJhc2VfcmVnKQo+ICsgICAgICAgICAgICAgICBkZXZt
X2lvdW5tYXAoYmxrY3RsLT5kZXYsIGJsa2N0bC0+YmFzZV9yZWcpOwo+ICsKPiArICAgICAgIGRl
dm1fa2ZyZWUoYmxrY3RsLT5kZXYsIGJsa2N0bCk7Cj4gK30KPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2lteC9kY3NzL2Rjc3MtY3J0Yy5jIGIvZHJpdmVycy9ncHUvZHJtL2lteC9kY3Nz
L2Rjc3MtY3J0Yy5jCj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRleCAwMDAwMDAwMC4uNmFi
YjQwYwo+IC0tLSAvZGV2L251bGwKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaW14L2Rjc3MvZGNz
cy1jcnRjLmMKPiBAQCAtMCwwICsxLDIyMyBAQAo+ICsvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmll
cjogR1BMLTIuMAo+ICsvKgo+ICsgKiBDb3B5cmlnaHQgMjAxOSBOWFAuCj4gKyAqLwo+ICsKPiAr
I2luY2x1ZGUgPGRybS9kcm1QLmg+Cj4gKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pY19oZWxwZXIu
aD4KPiArI2luY2x1ZGUgPGxpbnV4L3BtX3J1bnRpbWUuaD4KPiArCj4gKyNpbmNsdWRlICJkY3Nz
LWRldi5oIgo+ICsjaW5jbHVkZSAiZGNzcy1rbXMuaCIKPiArCj4gK3N0YXRpYyBpbnQgZGNzc19l
bmFibGVfdmJsYW5rKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykKPiArewo+ICsgICAgICAgc3RydWN0
IGRjc3NfY3J0YyAqZGNzc19jcnRjID0gY29udGFpbmVyX29mKGNydGMsIHN0cnVjdCBkY3NzX2Ny
dGMsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
YmFzZSk7Cj4gKyAgICAgICBzdHJ1Y3QgZGNzc19kZXYgKmRjc3MgPSBjcnRjLT5kZXYtPmRldl9w
cml2YXRlOwo+ICsKPiArICAgICAgIGlmIChkY3NzX2NydGMtPmlycV9lbmFibGVkKQo+ICsgICAg
ICAgICAgICAgICByZXR1cm4gMDsKPiArCj4gKyAgICAgICBkY3NzX2NydGMtPmlycV9lbmFibGVk
ID0gdHJ1ZTsKPiArCj4gKyAgICAgICBkY3NzX2R0Z192YmxhbmtfaXJxX2VuYWJsZShkY3NzLT5k
dGcsIHRydWUpOwo+ICsKPiArICAgICAgIGRjc3NfZHRnX2N0eGxkX2tpY2tfaXJxX2VuYWJsZShk
Y3NzLT5kdGcsIHRydWUpOwo+ICsKPiArICAgICAgIGVuYWJsZV9pcnEoZGNzc19jcnRjLT5pcnEp
Owo+ICsKPiArICAgICAgIHJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBkY3NzX2Rp
c2FibGVfdmJsYW5rKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykKPiArewo+ICsgICAgICAgc3RydWN0
IGRjc3NfY3J0YyAqZGNzc19jcnRjID0gY29udGFpbmVyX29mKGNydGMsIHN0cnVjdCBkY3NzX2Ny
dGMsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
YmFzZSk7Cj4gKyAgICAgICBzdHJ1Y3QgZGNzc19kZXYgKmRjc3MgPSBkY3NzX2NydGMtPmJhc2Uu
ZGV2LT5kZXZfcHJpdmF0ZTsKPiArCj4gKyAgICAgICBkaXNhYmxlX2lycV9ub3N5bmMoZGNzc19j
cnRjLT5pcnEpOwo+ICsKPiArICAgICAgIGRjc3NfZHRnX3ZibGFua19pcnFfZW5hYmxlKGRjc3Mt
PmR0ZywgZmFsc2UpOwo+ICsKPiArICAgICAgIGRjc3NfZHRnX2N0eGxkX2tpY2tfaXJxX2VuYWJs
ZShkY3NzLT5kdGcsIGZhbHNlKTsKPiArCj4gKyAgICAgICBkY3NzX2NydGMtPmlycV9lbmFibGVk
ID0gZmFsc2U7Cj4gK30KPiArCj4gK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2NydGNfZnVuY3Mg
ZGNzc19jcnRjX2Z1bmNzID0gewo+ICsgICAgICAgLnNldF9jb25maWcgPSBkcm1fYXRvbWljX2hl
bHBlcl9zZXRfY29uZmlnLAo+ICsgICAgICAgLmRlc3Ryb3kgPSBkcm1fY3J0Y19jbGVhbnVwLAo+
ICsgICAgICAgLnBhZ2VfZmxpcCA9IGRybV9hdG9taWNfaGVscGVyX3BhZ2VfZmxpcCwKPiArICAg
ICAgIC5yZXNldCA9IGRybV9hdG9taWNfaGVscGVyX2NydGNfcmVzZXQsCj4gKyAgICAgICAuYXRv
bWljX2R1cGxpY2F0ZV9zdGF0ZSA9IGRybV9hdG9taWNfaGVscGVyX2NydGNfZHVwbGljYXRlX3N0
YXRlLAo+ICsgICAgICAgLmF0b21pY19kZXN0cm95X3N0YXRlID0gZHJtX2F0b21pY19oZWxwZXJf
Y3J0Y19kZXN0cm95X3N0YXRlLAo+ICsgICAgICAgLmVuYWJsZV92YmxhbmsgPSBkY3NzX2VuYWJs
ZV92YmxhbmssCj4gKyAgICAgICAuZGlzYWJsZV92YmxhbmsgPSBkY3NzX2Rpc2FibGVfdmJsYW5r
LAo+ICt9Owo+ICsKPiArc3RhdGljIHZvaWQgZGNzc19jcnRjX2F0b21pY19iZWdpbihzdHJ1Y3Qg
ZHJtX2NydGMgKmNydGMsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1
Y3QgZHJtX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlKQo+ICt7Cj4gKyAgICAgICBkcm1fY3J0
Y192Ymxhbmtfb24oY3J0Yyk7Cj4gKwo+ICsgICAgICAgc3Bpbl9sb2NrX2lycSgmY3J0Yy0+ZGV2
LT5ldmVudF9sb2NrKTsKPiArICAgICAgIGlmIChjcnRjLT5zdGF0ZS0+ZXZlbnQpIHsKPiArICAg
ICAgICAgICAgICAgV0FSTl9PTihkcm1fY3J0Y192YmxhbmtfZ2V0KGNydGMpKTsKPiArICAgICAg
ICAgICAgICAgZHJtX2NydGNfYXJtX3ZibGFua19ldmVudChjcnRjLCBjcnRjLT5zdGF0ZS0+ZXZl
bnQpOwo+ICsgICAgICAgICAgICAgICBjcnRjLT5zdGF0ZS0+ZXZlbnQgPSBOVUxMOwo+ICsgICAg
ICAgfQo+ICsgICAgICAgc3Bpbl91bmxvY2tfaXJxKCZjcnRjLT5kZXYtPmV2ZW50X2xvY2spOwo+
ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBkY3NzX2NydGNfYXRvbWljX2ZsdXNoKHN0cnVjdCBkcm1f
Y3J0YyAqY3J0YywKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBk
cm1fY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUpCj4gK3sKPiArICAgICAgIHN0cnVjdCBkY3Nz
X2NydGMgKmRjc3NfY3J0YyA9IGNvbnRhaW5lcl9vZihjcnRjLCBzdHJ1Y3QgZGNzc19jcnRjLAo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2Up
Owo+ICsgICAgICAgc3RydWN0IGRjc3NfZGV2ICpkY3NzID0gZGNzc19jcnRjLT5iYXNlLmRldi0+
ZGV2X3ByaXZhdGU7Cj4gKwo+ICsgICAgICAgaWYgKGRjc3NfZHRnX2lzX2VuYWJsZWQoZGNzcy0+
ZHRnKSkKPiArICAgICAgICAgICAgICAgZGNzc19jdHhsZF9lbmFibGUoZGNzcy0+Y3R4bGQpOwo+
ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBkY3NzX2NydGNfYXRvbWljX2VuYWJsZShzdHJ1Y3QgZHJt
X2NydGMgKmNydGMsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0
IGRybV9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKPiArewo+ICsgICAgICAgc3RydWN0IGRj
c3NfY3J0YyAqZGNzc19jcnRjID0gY29udGFpbmVyX29mKGNydGMsIHN0cnVjdCBkY3NzX2NydGMs
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFz
ZSk7Cj4gKyAgICAgICBzdHJ1Y3QgZGNzc19kZXYgKmRjc3MgPSBkY3NzX2NydGMtPmJhc2UuZGV2
LT5kZXZfcHJpdmF0ZTsKPiArICAgICAgIHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlID0g
JmNydGMtPnN0YXRlLT5hZGp1c3RlZF9tb2RlOwo+ICsgICAgICAgc3RydWN0IHZpZGVvbW9kZSB2
bTsKPiArCj4gKyAgICAgICBkcm1fZGlzcGxheV9tb2RlX3RvX3ZpZGVvbW9kZShtb2RlLCAmdm0p
Owo+ICsKPiArICAgICAgIHBtX3J1bnRpbWVfZ2V0X3N5bmMoZGNzcy0+ZGV2KTsKPiArCj4gKyAg
ICAgICBkY3NzX2R0Z19jdHhsZF9raWNrX2lycV9lbmFibGUoZGNzcy0+ZHRnLCB0cnVlKTsKPiAr
Cj4gKyAgICAgICB2bS5waXhlbGNsb2NrID0gbW9kZS0+Y3J0Y19jbG9jayAqIDEwMDA7Cj4gKwo+
ICsgICAgICAgZGNzc19kdGdfc3luY19zZXQoZGNzcy0+ZHRnLCAmdm0pOwo+ICsKPiArICAgICAg
IGRjc3Nfc3Nfc3Vic2FtX3NldChkY3NzLT5zcyk7Cj4gKyAgICAgICBkY3NzX3NzX3N5bmNfc2V0
KGRjc3MtPnNzLCAmdm0sIG1vZGUtPmZsYWdzICYgRFJNX01PREVfRkxBR19QSFNZTkMsCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgIG1vZGUtPmZsYWdzICYgRFJNX01PREVfRkxBR19QVlNZTkMp
Owo+ICsKPiArICAgICAgIGRjc3NfZHRnX2Nzc19zZXQoZGNzcy0+ZHRnKTsKPiArCj4gKyAgICAg
ICBkY3NzX3NzX2VuYWJsZShkY3NzLT5zcyk7Cj4gKyAgICAgICBkY3NzX2R0Z19lbmFibGUoZGNz
cy0+ZHRnLCB0cnVlLCBOVUxMKTsKPiArICAgICAgIGRjc3NfY3R4bGRfZW5hYmxlKGRjc3MtPmN0
eGxkKTsKPiArCj4gKyAgICAgICByZWluaXRfY29tcGxldGlvbigmZGNzc19jcnRjLT5lbl9jb21w
bGV0aW9uKTsKPiArICAgICAgIHdhaXRfZm9yX2NvbXBsZXRpb25fdGltZW91dCgmZGNzc19jcnRj
LT5lbl9jb21wbGV0aW9uLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1z
ZWNzX3RvX2ppZmZpZXMoNTAwKSk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGRjc3NfY3J0Y19h
dG9taWNfZGlzYWJsZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUp
Cj4gK3sKPiArICAgICAgIHN0cnVjdCBkY3NzX2NydGMgKmRjc3NfY3J0YyA9IGNvbnRhaW5lcl9v
ZihjcnRjLCBzdHJ1Y3QgZGNzc19jcnRjLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGJhc2UpOwo+ICsgICAgICAgc3RydWN0IGRjc3NfZGV2ICpk
Y3NzID0gZGNzc19jcnRjLT5iYXNlLmRldi0+ZGV2X3ByaXZhdGU7Cj4gKwo+ICsgICAgICAgZHJt
X2F0b21pY19oZWxwZXJfZGlzYWJsZV9wbGFuZXNfb25fY3J0YyhvbGRfY3J0Y19zdGF0ZSwgZmFs
c2UpOwo+ICsKPiArICAgICAgIHNwaW5fbG9ja19pcnEoJmNydGMtPmRldi0+ZXZlbnRfbG9jayk7
Cj4gKyAgICAgICBpZiAoY3J0Yy0+c3RhdGUtPmV2ZW50KSB7Cj4gKyAgICAgICAgICAgICAgIGRy
bV9jcnRjX3NlbmRfdmJsYW5rX2V2ZW50KGNydGMsIGNydGMtPnN0YXRlLT5ldmVudCk7Cj4gKyAg
ICAgICAgICAgICAgIGNydGMtPnN0YXRlLT5ldmVudCA9IE5VTEw7Cj4gKyAgICAgICB9Cj4gKyAg
ICAgICBzcGluX3VubG9ja19pcnEoJmNydGMtPmRldi0+ZXZlbnRfbG9jayk7Cj4gKwo+ICsgICAg
ICAgZGNzc19kdGdfY3R4bGRfa2lja19pcnFfZW5hYmxlKGRjc3MtPmR0ZywgdHJ1ZSk7Cj4gKwo+
ICsgICAgICAgZGNzc19zc19kaXNhYmxlKGRjc3MtPnNzKTsKPiArICAgICAgIGRjc3NfZHRnX2Vu
YWJsZShkY3NzLT5kdGcsIGZhbHNlLCAmZGNzc19jcnRjLT5kaXNfY29tcGxldGlvbik7Cj4gKyAg
ICAgICBkY3NzX2N0eGxkX2VuYWJsZShkY3NzLT5jdHhsZCk7Cj4gKwo+ICsgICAgICAgcmVpbml0
X2NvbXBsZXRpb24oJmRjc3NfY3J0Yy0+ZGlzX2NvbXBsZXRpb24pOwo+ICsgICAgICAgd2FpdF9m
b3JfY29tcGxldGlvbl90aW1lb3V0KCZkY3NzX2NydGMtPmRpc19jb21wbGV0aW9uLAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZWNzX3RvX2ppZmZpZXMoMTAwKSk7Cj4g
Kwo+ICsgICAgICAgZHJtX2NydGNfdmJsYW5rX29mZihjcnRjKTsKPiArCj4gKyAgICAgICBkY3Nz
X2R0Z19jdHhsZF9raWNrX2lycV9lbmFibGUoZGNzcy0+ZHRnLCBmYWxzZSk7Cj4gKwo+ICsgICAg
ICAgcG1fcnVudGltZV9wdXRfc3luYyhkY3NzLT5kZXYpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgY29u
c3Qgc3RydWN0IGRybV9jcnRjX2hlbHBlcl9mdW5jcyBkY3NzX2hlbHBlcl9mdW5jcyA9IHsKPiAr
ICAgICAgIC5hdG9taWNfYmVnaW4gPSBkY3NzX2NydGNfYXRvbWljX2JlZ2luLAo+ICsgICAgICAg
LmF0b21pY19mbHVzaCA9IGRjc3NfY3J0Y19hdG9taWNfZmx1c2gsCj4gKyAgICAgICAuYXRvbWlj
X2VuYWJsZSA9IGRjc3NfY3J0Y19hdG9taWNfZW5hYmxlLAo+ICsgICAgICAgLmF0b21pY19kaXNh
YmxlID0gZGNzc19jcnRjX2F0b21pY19kaXNhYmxlLAo+ICt9Owo+ICsKPiArc3RhdGljIGlycXJl
dHVybl90IGRjc3NfY3J0Y19pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICpkZXZfaWQpCj4gK3sK
PiArICAgICAgIHN0cnVjdCBkY3NzX2NydGMgKmRjc3NfY3J0YyA9IGRldl9pZDsKPiArICAgICAg
IHN0cnVjdCBkY3NzX2RldiAqZGNzcyA9IGRjc3NfY3J0Yy0+YmFzZS5kZXYtPmRldl9wcml2YXRl
Owo+ICsKPiArICAgICAgIGlmICghZGNzc19kdGdfdmJsYW5rX2lycV92YWxpZChkY3NzLT5kdGcp
KQo+ICsgICAgICAgICAgICAgICByZXR1cm4gSVJRX0hBTkRMRUQ7Cj4gKwo+ICsgICAgICAgY29t
cGxldGUoJmRjc3NfY3J0Yy0+ZW5fY29tcGxldGlvbik7Cj4gKwo+ICsgICAgICAgaWYgKGRjc3Nf
Y3R4bGRfaXNfZmx1c2hlZChkY3NzLT5jdHhsZCkpCj4gKyAgICAgICAgICAgICAgIGRybV9jcnRj
X2hhbmRsZV92YmxhbmsoJmRjc3NfY3J0Yy0+YmFzZSk7Cj4gKwo+ICsgICAgICAgZGNzc19kdGdf
dmJsYW5rX2lycV9jbGVhcihkY3NzLT5kdGcpOwo+ICsKPiArICAgICAgIHJldHVybiBJUlFfSEFO
RExFRDsKPiArfQo+ICsKPiAraW50IGRjc3NfY3J0Y19pbml0KHN0cnVjdCBkY3NzX2NydGMgKmNy
dGMsIHN0cnVjdCBkcm1fZGV2aWNlICpkcm0pCj4gK3sKPiArICAgICAgIHN0cnVjdCBkY3NzX2Rl
diAqZGNzcyA9IGRybS0+ZGV2X3ByaXZhdGU7Cj4gKyAgICAgICBzdHJ1Y3QgcGxhdGZvcm1fZGV2
aWNlICpwZGV2ID0gdG9fcGxhdGZvcm1fZGV2aWNlKGRjc3MtPmRldik7Cj4gKyAgICAgICBpbnQg
cmV0Owo+ICsKPiArICAgICAgIGNydGMtPnBsYW5lWzBdID0gZGNzc19wbGFuZV9pbml0KGRybSwg
ZHJtX2NydGNfbWFzaygmY3J0Yy0+YmFzZSksCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBEUk1fUExBTkVfVFlQRV9QUklNQVJZLCAwKTsKPiArICAgICAgIGlmIChJ
U19FUlIoY3J0Yy0+cGxhbmVbMF0pKQo+ICsgICAgICAgICAgICAgICByZXR1cm4gUFRSX0VSUihj
cnRjLT5wbGFuZVswXSk7Cj4gKwo+ICsgICAgICAgY3J0Yy0+YmFzZS5wb3J0ID0gZGNzcy0+b2Zf
cG9ydDsKPiArCj4gKyAgICAgICBkcm1fY3J0Y19oZWxwZXJfYWRkKCZjcnRjLT5iYXNlLCAmZGNz
c19oZWxwZXJfZnVuY3MpOwo+ICsgICAgICAgcmV0ID0gZHJtX2NydGNfaW5pdF93aXRoX3BsYW5l
cyhkcm0sICZjcnRjLT5iYXNlLCAmY3J0Yy0+cGxhbmVbMF0tPmJhc2UsCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5VTEwsICZkY3NzX2NydGNfZnVuY3MsIE5VTEwp
Owo+ICsgICAgICAgaWYgKHJldCkgewo+ICsgICAgICAgICAgICAgICBkZXZfZXJyKGRjc3MtPmRl
diwgImZhaWxlZCB0byBpbml0IGNydGNcbiIpOwo+ICsgICAgICAgICAgICAgICByZXR1cm4gcmV0
Owo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGNydGMtPmlycSA9IHBsYXRmb3JtX2dldF9pcnFf
YnluYW1lKHBkZXYsICJ2YmxhbmsiKTsKPiArICAgICAgIGlmIChjcnRjLT5pcnEgPCAwKSB7Cj4g
KyAgICAgICAgICAgICAgIGRldl9lcnIoZGNzcy0+ZGV2LCAidW5hYmxlIHRvIGdldCB2Ymxhbmsg
aW50ZXJydXB0XG4iKTsKPiArICAgICAgICAgICAgICAgcmV0dXJuIGNydGMtPmlycTsKPiArICAg
ICAgIH0KPiArCj4gKyAgICAgICBpbml0X2NvbXBsZXRpb24oJmNydGMtPmVuX2NvbXBsZXRpb24p
Owo+ICsgICAgICAgaW5pdF9jb21wbGV0aW9uKCZjcnRjLT5kaXNfY29tcGxldGlvbik7Cj4gKwo+
ICsgICAgICAgcmV0ID0gZGV2bV9yZXF1ZXN0X2lycShkY3NzLT5kZXYsIGNydGMtPmlycSwgZGNz
c19jcnRjX2lycV9oYW5kbGVyLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJUlFG
X1RSSUdHRVJfUklTSU5HLCAiZGNzc19kcm0iLCBjcnRjKTsKPiArICAgICAgIGlmIChyZXQpIHsK
PiArICAgICAgICAgICAgICAgZGV2X2VycihkY3NzLT5kZXYsICJpcnEgcmVxdWVzdCBmYWlsZWQg
d2l0aCAlZC5cbiIsIHJldCk7Cj4gKyAgICAgICAgICAgICAgIHJldHVybiByZXQ7Cj4gKyAgICAg
ICB9Cj4gKwo+ICsgICAgICAgZGlzYWJsZV9pcnEoY3J0Yy0+aXJxKTsKPiArCj4gKyAgICAgICBy
ZXR1cm4gMDsKPiArfQo+ICsKPiArdm9pZCBkY3NzX2NydGNfZGVpbml0KHN0cnVjdCBkY3NzX2Ny
dGMgKmNydGMsIHN0cnVjdCBkcm1fZGV2aWNlICpkcm0pCj4gK3sKPiArICAgICAgIHN0cnVjdCBk
Y3NzX2RldiAqZGNzcyA9IGRybS0+ZGV2X3ByaXZhdGU7Cj4gKwo+ICsgICAgICAgZGV2bV9mcmVl
X2lycShkY3NzLT5kZXYsIGNydGMtPmlycSwgY3J0Yyk7Cj4gK30KPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2lteC9kY3NzL2Rjc3MtY3R4bGQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pbXgv
ZGNzcy9kY3NzLWN0eGxkLmMKPiBuZXcgZmlsZSBtb2RlIDEwMDY0NAo+IGluZGV4IDAwMDAwMDAw
Li40ZmUzNWIyYgo+IC0tLSAvZGV2L251bGwKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaW14L2Rj
c3MvZGNzcy1jdHhsZC5jCj4gQEAgLTAsMCArMSw0NDcgQEAKPiArLy8gU1BEWC1MaWNlbnNlLUlk
ZW50aWZpZXI6IEdQTC0yLjAKPiArLyoKPiArICogQ29weXJpZ2h0IDIwMTkgTlhQLgo+ICsgKi8K
PiArCj4gKyNpbmNsdWRlIDxsaW51eC9kZWxheS5oPgo+ICsjaW5jbHVkZSA8bGludXgvZG1hLW1h
cHBpbmcuaD4KPiArI2luY2x1ZGUgPGxpbnV4L2ludGVycnVwdC5oPgo+ICsjaW5jbHVkZSA8bGlu
dXgvcGxhdGZvcm1fZGV2aWNlLmg+Cj4gKwo+ICsjaW5jbHVkZSAiZGNzcy1kZXYuaCIKPiArCj4g
KyNkZWZpbmUgRENTU19DVFhMRF9ERVZOQU1FICAgICAgICAgICAgICJkY3NzX2N0eGxkIgo+ICsK
PiArI2RlZmluZSBEQ1NTX0NUWExEX0NPTlRST0xfU1RBVFVTICAgICAgMHgwCj4gKyNkZWZpbmUg
ICBDVFhMRF9FTkFCTEUgICAgICAgICAgICAgICAgIEJJVCgwKQo+ICsjZGVmaW5lICAgQVJCX1NF
TCAgICAgICAgICAgICAgICAgICAgICBCSVQoMSkKPiArI2RlZmluZSAgIFJEX0VSUl9FTiAgICAg
ICAgICAgICAgICAgICAgQklUKDIpCj4gKyNkZWZpbmUgICBEQl9DT01QX0VOICAgICAgICAgICAg
ICAgICAgIEJJVCgzKQo+ICsjZGVmaW5lICAgU0JfSFBfQ09NUF9FTiAgICAgICAgICAgICAgICAg
ICAgICAgIEJJVCg0KQo+ICsjZGVmaW5lICAgU0JfTFBfQ09NUF9FTiAgICAgICAgICAgICAgICAg
ICAgICAgIEJJVCg1KQo+ICsjZGVmaW5lICAgREJfUEVORF9TQl9SRUNfRU4gICAgICAgICAgICBC
SVQoNikKPiArI2RlZmluZSAgIFNCX1BFTkRfRElTUF9BQ1RJVkVfRU4gICAgICAgQklUKDcpCj4g
KyNkZWZpbmUgICBBSEJfRVJSX0VOICAgICAgICAgICAgICAgICAgIEJJVCg4KQo+ICsjZGVmaW5l
ICAgUkRfRVJSICAgICAgICAgICAgICAgICAgICAgICBCSVQoMTYpCj4gKyNkZWZpbmUgICBEQl9D
T01QICAgICAgICAgICAgICAgICAgICAgIEJJVCgxNykKPiArI2RlZmluZSAgIFNCX0hQX0NPTVAg
ICAgICAgICAgICAgICAgICAgQklUKDE4KQo+ICsjZGVmaW5lICAgU0JfTFBfQ09NUCAgICAgICAg
ICAgICAgICAgICBCSVQoMTkpCj4gKyNkZWZpbmUgICBEQl9QRU5EX1NCX1JFQyAgICAgICAgICAg
ICAgIEJJVCgyMCkKPiArI2RlZmluZSAgIFNCX1BFTkRfRElTUF9BQ1RJVkUgICAgICAgICAgQklU
KDIxKQo+ICsjZGVmaW5lICAgQUhCX0VSUiAgICAgICAgICAgICAgICAgICAgICBCSVQoMjIpCj4g
KyNkZWZpbmUgRENTU19DVFhMRF9EQl9CQVNFX0FERFIgICAgICAgICAgICAgICAgMHgxMAo+ICsj
ZGVmaW5lIERDU1NfQ1RYTERfREJfQ09VTlQgICAgICAgICAgICAweDE0Cj4gKyNkZWZpbmUgRENT
U19DVFhMRF9TQl9CQVNFX0FERFIgICAgICAgICAgICAgICAgMHgxOAo+ICsjZGVmaW5lIERDU1Nf
Q1RYTERfU0JfQ09VTlQgICAgICAgICAgICAweDFDCj4gKyNkZWZpbmUgICBTQl9IUF9DT1VOVF9Q
T1MgICAgICAgICAgICAgIDAKPiArI2RlZmluZSAgIFNCX0hQX0NPVU5UX01BU0sgICAgICAgICAg
ICAgMHhmZmZmCj4gKyNkZWZpbmUgICBTQl9MUF9DT1VOVF9QT1MgICAgICAgICAgICAgIDE2Cj4g
KyNkZWZpbmUgICBTQl9MUF9DT1VOVF9NQVNLICAgICAgICAgICAgIDB4ZmZmZjAwMDAKPiArI2Rl
ZmluZSBEQ1NTX0FIQl9FUlJfQUREUiAgICAgICAgICAgICAgMHgyMAo+ICsKPiArI2RlZmluZSBD
VFhMRF9JUlFfTkFNRSAgICAgICAgICAgICAgICAgImN0eF9sZCIKPiArI2RlZmluZSBDVFhMRF9J
UlFfQ09NUExFVElPTiAgICAgICAgICAgKERCX0NPTVAgfCBTQl9IUF9DT01QIHwgU0JfTFBfQ09N
UCkKPiArI2RlZmluZSBDVFhMRF9JUlFfRVJST1IgICAgICAgICAgICAgICAgICAgICAgICAoUkRf
RVJSIHwgREJfUEVORF9TQl9SRUMgfCBBSEJfRVJSKQo+ICsKPiArLyogVGhlIGZvbGxvd2luZyBz
aXplcyBhcmUgaW4gY29udGV4dCBsb2FkZXIgZW50cmllcywgOCBieXRlcyBlYWNoLiAqLwo+ICsj
ZGVmaW5lIENUWExEX0RCX0NUWF9FTlRSSUVTICAgICAgICAgICAxMDI0ICAgIC8qIG1heCA2NTUz
NiAqLwo+ICsjZGVmaW5lIENUWExEX1NCX0xQX0NUWF9FTlRSSUVTICAgICAgICAgICAgICAgIDEw
MjQwICAgLyogbWF4IDY1NTM2ICovCj4gKyNkZWZpbmUgQ1RYTERfU0JfSFBfQ1RYX0VOVFJJRVMg
ICAgICAgICAgICAgICAgMjAwMDAgICAvKiBtYXggNjU1MzYgKi8KPiArI2RlZmluZSBDVFhMRF9T
Ql9DVFhfRU5UUklFUyAgICAgICAgICAgKENUWExEX1NCX0xQX0NUWF9FTlRSSUVTICsgXAo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1RYTERfU0JfSFBfQ1RYX0VO
VFJJRVMpCj4gKwo+ICsvKiBTaXplcywgaW4gZW50cmllcywgb2YgdGhlIERCLCBTQl9IUCBhbmQg
U0JfTFAgY29udGV4dCByZWdpb25zLiAqLwo+ICtzdGF0aWMgdTE2IGRjc3NfY3R4bGRfY3R4X3Np
emVbM10gPSB7Cj4gKyAgICAgICBDVFhMRF9EQl9DVFhfRU5UUklFUywKPiArICAgICAgIENUWExE
X1NCX0hQX0NUWF9FTlRSSUVTLAo+ICsgICAgICAgQ1RYTERfU0JfTFBfQ1RYX0VOVFJJRVMKPiAr
fTsKPiArCj4gKy8qIHRoaXMgcmVwcmVzZW50cyBhbiBlbnRyeSBpbiB0aGUgY29udGV4dCBsb2Fk
ZXIgbWFwICovCj4gK3N0cnVjdCBkY3NzX2N0eGxkX2l0ZW0gewo+ICsgICAgICAgdTMyIHZhbDsK
PiArICAgICAgIHUzMiBvZnM7Cj4gK307Cj4gKwo+ICsjZGVmaW5lIENUWF9JVEVNX1NJWkUgICAg
ICAgICAgICAgICAgICBzaXplb2Yoc3RydWN0IGRjc3NfY3R4bGRfaXRlbSkKPiArCj4gK3N0cnVj
dCBkY3NzX2N0eGxkIHsKPiArICAgICAgIHN0cnVjdCBkZXZpY2UgKmRldjsKPiArICAgICAgIHZv
aWQgX19pb21lbSAqY3R4bGRfcmVnOwo+ICsgICAgICAgaW50IGlycTsKPiArICAgICAgIGJvb2wg
aXJxX2VuOwo+ICsKPiArICAgICAgIHN0cnVjdCBkY3NzX2N0eGxkX2l0ZW0gKmRiWzJdOwo+ICsg
ICAgICAgc3RydWN0IGRjc3NfY3R4bGRfaXRlbSAqc2JfaHBbMl07Cj4gKyAgICAgICBzdHJ1Y3Qg
ZGNzc19jdHhsZF9pdGVtICpzYl9scFsyXTsKPiArCj4gKyAgICAgICBkbWFfYWRkcl90IGRiX3Bh
ZGRyWzJdOwo+ICsgICAgICAgZG1hX2FkZHJfdCBzYl9wYWRkclsyXTsKPiArCj4gKyAgICAgICB1
MTYgY3R4X3NpemVbMl1bM107IC8qIGhvbGRzIHRoZSBzaXplcyBvZiBEQiwgU0JfSFAgYW5kIFNC
X0xQIGN0eCAqLwo+ICsgICAgICAgdTggY3VycmVudF9jdHg7Cj4gKwo+ICsgICAgICAgYm9vbCBp
bl91c2U7Cj4gKyAgICAgICBib29sIGFybWVkOwo+ICsKPiArICAgICAgIHNwaW5sb2NrX3QgbG9j
azsgLyogcHJvdGVjdHMgY29uY3VyZW50IGFjY2VzcyB0byBwcml2YXRlIGRhdGEgKi8KPiArCj4g
KyAgICAgICB2b2lkICgqZHRnX2Rpc2FibGVfY2IpKHZvaWQgKmRhdGEpOwo+ICsgICAgICAgdm9p
ZCAqZHRnX2Rpc2FibGVfZGF0YTsKPiArfTsKPiArCj4gK3N0YXRpYyBpbnQgX19kY3NzX2N0eGxk
X2VuYWJsZShzdHJ1Y3QgZGNzc19jdHhsZCAqY3R4bGQpOwo+ICsKPiArc3RhdGljIGlycXJldHVy
bl90IGRjc3NfY3R4bGRfaXJxX2hhbmRsZXIoaW50IGlycSwgdm9pZCAqZGF0YSkKPiArewo+ICsg
ICAgICAgc3RydWN0IGRjc3NfY3R4bGQgKmN0eGxkID0gZGF0YTsKPiArICAgICAgIHUzMiBpcnFf
c3RhdHVzOwo+ICsKPiArICAgICAgIGlycV9zdGF0dXMgPSBkY3NzX3JlYWRsKGN0eGxkLT5jdHhs
ZF9yZWcgKyBEQ1NTX0NUWExEX0NPTlRST0xfU1RBVFVTKTsKPiArCj4gKyAgICAgICBpZiAoaXJx
X3N0YXR1cyAmIENUWExEX0lSUV9DT01QTEVUSU9OICYmCj4gKyAgICAgICAgICAgIShpcnFfc3Rh
dHVzICYgQ1RYTERfRU5BQkxFKSAmJiBjdHhsZC0+aW5fdXNlKSB7Cj4gKyAgICAgICAgICAgICAg
IGN0eGxkLT5pbl91c2UgPSBmYWxzZTsKPiArCj4gKyAgICAgICAgICAgICAgIGlmIChjdHhsZC0+
ZHRnX2Rpc2FibGVfY2IpIHsKPiArICAgICAgICAgICAgICAgICAgICAgICBjdHhsZC0+ZHRnX2Rp
c2FibGVfY2IoY3R4bGQtPmR0Z19kaXNhYmxlX2RhdGEpOwo+ICsgICAgICAgICAgICAgICAgICAg
ICAgIGN0eGxkLT5kdGdfZGlzYWJsZV9jYiA9IE5VTEw7Cj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgY3R4bGQtPmR0Z19kaXNhYmxlX2RhdGEgPSBOVUxMOwo+ICsgICAgICAgICAgICAgICB9Cj4g
KyAgICAgICB9IGVsc2UgaWYgKGlycV9zdGF0dXMgJiBDVFhMRF9JUlFfRVJST1IpIHsKPiArICAg
ICAgICAgICAgICAgLyoKPiArICAgICAgICAgICAgICAgICogRXhjZXB0IGZvciB0aHJvd2luZyBh
biBlcnJvciBtZXNzYWdlIGFuZCBjbGVhcmluZyB0aGUgc3RhdHVzCj4gKyAgICAgICAgICAgICAg
ICAqIHJlZ2lzdGVyLCB0aGVyZSdzIG5vdCBtdWNoIHdlIGNhbiBkbyBoZXJlLgo+ICsgICAgICAg
ICAgICAgICAgKi8KPiArICAgICAgICAgICAgICAgZGV2X2VycihjdHhsZC0+ZGV2LCAiY3R4bGQ6
IGVycm9yIGVuY291bnRlcmVkOiAlMDh4XG4iLAo+ICsgICAgICAgICAgICAgICAgICAgICAgIGly
cV9zdGF0dXMpOwo+ICsgICAgICAgICAgICAgICBkZXZfZXJyKGN0eGxkLT5kZXYsICJjdHhsZDog
ZGI9JWQsIHNiX2hwPSVkLCBzYl9scD0lZFxuIiwKPiArICAgICAgICAgICAgICAgICAgICAgICBj
dHhsZC0+Y3R4X3NpemVbY3R4bGQtPmN1cnJlbnRfY3R4IF4gMV1bQ1RYX0RCXSwKPiArICAgICAg
ICAgICAgICAgICAgICAgICBjdHhsZC0+Y3R4X3NpemVbY3R4bGQtPmN1cnJlbnRfY3R4IF4gMV1b
Q1RYX1NCX0hQXSwKPiArICAgICAgICAgICAgICAgICAgICAgICBjdHhsZC0+Y3R4X3NpemVbY3R4
bGQtPmN1cnJlbnRfY3R4IF4gMV1bQ1RYX1NCX0xQXSk7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAg
ICAgZGNzc19jbHIoaXJxX3N0YXR1cyAmIChDVFhMRF9JUlFfRVJST1IgfCBDVFhMRF9JUlFfQ09N
UExFVElPTiksCj4gKyAgICAgICAgICAgICAgICBjdHhsZC0+Y3R4bGRfcmVnICsgRENTU19DVFhM
RF9DT05UUk9MX1NUQVRVUyk7Cj4gKwo+ICsgICAgICAgcmV0dXJuIElSUV9IQU5ETEVEOwo+ICt9
Cj4gKwo+ICtzdGF0aWMgaW50IGRjc3NfY3R4bGRfaXJxX2NvbmZpZyhzdHJ1Y3QgZGNzc19jdHhs
ZCAqY3R4bGQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHBsYXRm
b3JtX2RldmljZSAqcGRldikKPiArewo+ICsgICAgICAgaW50IHJldDsKPiArCj4gKyAgICAgICBj
dHhsZC0+aXJxID0gcGxhdGZvcm1fZ2V0X2lycV9ieW5hbWUocGRldiwgQ1RYTERfSVJRX05BTUUp
Owo+ICsgICAgICAgaWYgKGN0eGxkLT5pcnEgPCAwKSB7Cj4gKyAgICAgICAgICAgICAgIGRldl9l
cnIoY3R4bGQtPmRldiwgImN0eGxkOiBjYW4ndCBnZXQgaXJxIG51bWJlclxuIik7Cj4gKyAgICAg
ICAgICAgICAgIHJldHVybiBjdHhsZC0+aXJxOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIHJl
dCA9IGRldm1fcmVxdWVzdF9pcnEoY3R4bGQtPmRldiwgY3R4bGQtPmlycSwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgZGNzc19jdHhsZF9pcnFfaGFuZGxlciwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgSVJRRl9PTkVTSE9UIHwgSVJRRl9UUklHR0VSX0hJR0gsCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERDU1NfQ1RYTERfREVWTkFNRSwgY3R4bGQp
Owo+ICsgICAgICAgaWYgKHJldCkgewo+ICsgICAgICAgICAgICAgICBkZXZfZXJyKGN0eGxkLT5k
ZXYsICJjdHhsZDogaXJxIHJlcXVlc3QgZmFpbGVkLlxuIik7Cj4gKyAgICAgICAgICAgICAgIHJl
dHVybiByZXQ7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgY3R4bGQtPmlycV9lbiA9IHRydWU7
Cj4gKwo+ICsgICAgICAgcmV0dXJuIDA7Cj4gK30KPiArCj4gK3ZvaWQgZGNzc19jdHhsZF9od19j
Zmcoc3RydWN0IGRjc3NfY3R4bGQgKmN0eGxkKQo+ICt7Cj4gKyAgICAgICBkY3NzX3dyaXRlbChS
RF9FUlJfRU4gfCBTQl9IUF9DT01QX0VOIHwKPiArICAgICAgICAgICAgICAgICAgIERCX1BFTkRf
U0JfUkVDX0VOIHwgQUhCX0VSUl9FTiB8IFJEX0VSUiB8IEFIQl9FUlIsCj4gKyAgICAgICAgICAg
ICAgICAgICBjdHhsZC0+Y3R4bGRfcmVnICsgRENTU19DVFhMRF9DT05UUk9MX1NUQVRVUyk7Cj4g
K30KPiArCj4gK3N0YXRpYyB2b2lkIGRjc3NfY3R4bGRfZnJlZV9jdHgoc3RydWN0IGRjc3NfY3R4
bGQgKmN0eGxkKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZGNzc19jdHhsZF9pdGVtICpjdHg7Cj4g
KyAgICAgICBpbnQgaTsKPiArCj4gKyAgICAgICBmb3IgKGkgPSAwOyBpIDwgMjsgaSsrKSB7Cj4g
KyAgICAgICAgICAgICAgIGlmIChjdHhsZC0+ZGJbaV0pIHsKPiArICAgICAgICAgICAgICAgICAg
ICAgICBkbWFtX2ZyZWVfY29oZXJlbnQoY3R4bGQtPmRldiwKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgQ1RYTERfREJfQ1RYX0VOVFJJRVMgKiBzaXplb2YoKmN0
eCksCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eGxkLT5k
YltpXSwgY3R4bGQtPmRiX3BhZGRyW2ldKTsKPiArICAgICAgICAgICAgICAgICAgICAgICBjdHhs
ZC0+ZGJbaV0gPSBOVUxMOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIGN0eGxkLT5kYl9wYWRk
cltpXSA9IDA7Cj4gKyAgICAgICAgICAgICAgIH0KPiArCj4gKyAgICAgICAgICAgICAgIGlmIChj
dHhsZC0+c2JfaHBbaV0pIHsKPiArICAgICAgICAgICAgICAgICAgICAgICBkbWFtX2ZyZWVfY29o
ZXJlbnQoY3R4bGQtPmRldiwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgQ1RYTERfU0JfQ1RYX0VOVFJJRVMgKiBzaXplb2YoKmN0eCksCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eGxkLT5zYl9ocFtpXSwgY3R4bGQtPnNi
X3BhZGRyW2ldKTsKPiArICAgICAgICAgICAgICAgICAgICAgICBjdHhsZC0+c2JfaHBbaV0gPSBO
VUxMOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIGN0eGxkLT5zYl9wYWRkcltpXSA9IDA7Cj4g
KyAgICAgICAgICAgICAgIH0KPiArICAgICAgIH0KPiArfQo+ICsKPiArc3RhdGljIGludCBkY3Nz
X2N0eGxkX2FsbG9jX2N0eChzdHJ1Y3QgZGNzc19jdHhsZCAqY3R4bGQpCj4gK3sKPiArICAgICAg
IHN0cnVjdCBkY3NzX2N0eGxkX2l0ZW0gKmN0eDsKPiArICAgICAgIGludCBpOwo+ICsgICAgICAg
ZG1hX2FkZHJfdCBkbWFfaGFuZGxlOwo+ICsKPiArICAgICAgIGZvciAoaSA9IDA7IGkgPCAyOyBp
KyspIHsKPiArICAgICAgICAgICAgICAgY3R4ID0gZG1hbV9hbGxvY19jb2hlcmVudChjdHhsZC0+
ZGV2LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENUWExEX0RC
X0NUWF9FTlRSSUVTICogc2l6ZW9mKCpjdHgpLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICZkbWFfaGFuZGxlLCBHRlBfS0VSTkVMKTsKPiArICAgICAgICAgICAg
ICAgaWYgKCFjdHgpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4g
Kwo+ICsgICAgICAgICAgICAgICBjdHhsZC0+ZGJbaV0gPSBjdHg7Cj4gKyAgICAgICAgICAgICAg
IGN0eGxkLT5kYl9wYWRkcltpXSA9IGRtYV9oYW5kbGU7Cj4gKwo+ICsgICAgICAgICAgICAgICBj
dHggPSBkbWFtX2FsbG9jX2NvaGVyZW50KGN0eGxkLT5kZXYsCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgQ1RYTERfU0JfQ1RYX0VOVFJJRVMgKiBzaXplb2YoKmN0
eCksCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmRtYV9oYW5k
bGUsIEdGUF9LRVJORUwpOwo+ICsgICAgICAgICAgICAgICBpZiAoIWN0eCkKPiArICAgICAgICAg
ICAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKPiArCj4gKyAgICAgICAgICAgICAgIGN0eGxk
LT5zYl9ocFtpXSA9IGN0eDsKPiArICAgICAgICAgICAgICAgY3R4bGQtPnNiX2xwW2ldID0gY3R4
ICsgQ1RYTERfU0JfSFBfQ1RYX0VOVFJJRVM7Cj4gKwo+ICsgICAgICAgICAgICAgICBjdHhsZC0+
c2JfcGFkZHJbaV0gPSBkbWFfaGFuZGxlOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIHJldHVy
biAwOwo+ICt9Cj4gKwo+ICtpbnQgZGNzc19jdHhsZF9pbml0KHN0cnVjdCBkY3NzX2RldiAqZGNz
cywgdW5zaWduZWQgbG9uZyBjdHhsZF9iYXNlKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZGNzc19j
dHhsZCAqY3R4bGQ7Cj4gKyAgICAgICBpbnQgcmV0Owo+ICsKPiArICAgICAgIGN0eGxkID0gZGV2
bV9remFsbG9jKGRjc3MtPmRldiwgc2l6ZW9mKHN0cnVjdCBkY3NzX2N0eGxkKSwKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIEdGUF9LRVJORUwpOwo+ICsgICAgICAgaWYgKCFjdHhsZCkK
PiArICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsgICAgICAgZGNzcy0+Y3R4
bGQgPSBjdHhsZDsKPiArICAgICAgIGN0eGxkLT5kZXYgPSBkY3NzLT5kZXY7Cj4gKwo+ICsgICAg
ICAgc3Bpbl9sb2NrX2luaXQoJmN0eGxkLT5sb2NrKTsKPiArCj4gKyAgICAgICByZXQgPSBkY3Nz
X2N0eGxkX2FsbG9jX2N0eChjdHhsZCk7Cj4gKyAgICAgICBpZiAocmV0KSB7Cj4gKyAgICAgICAg
ICAgICAgIGRldl9lcnIoZGNzcy0+ZGV2LCAiY3R4bGQ6IGNhbm5vdCBhbGxvY2F0ZSBjb250ZXh0
IG1lbW9yeS5cbiIpOwo+ICsgICAgICAgICAgICAgICBnb3RvIGVycjsKPiArICAgICAgIH0KPiAr
Cj4gKyAgICAgICBjdHhsZC0+Y3R4bGRfcmVnID0gZGV2bV9pb3JlbWFwKGRjc3MtPmRldiwgY3R4
bGRfYmFzZSwgU1pfNEspOwo+ICsgICAgICAgaWYgKCFjdHhsZC0+Y3R4bGRfcmVnKSB7Cj4gKyAg
ICAgICAgICAgICAgIGRldl9lcnIoZGNzcy0+ZGV2LCAiY3R4bGQ6IHVuYWJsZSB0byByZW1hcCBj
dHhsZCBiYXNlXG4iKTsKPiArICAgICAgICAgICAgICAgcmV0ID0gLUVOT01FTTsKPiArICAgICAg
ICAgICAgICAgZ290byBlcnI7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgcmV0ID0gZGNzc19j
dHhsZF9pcnFfY29uZmlnKGN0eGxkLCB0b19wbGF0Zm9ybV9kZXZpY2UoZGNzcy0+ZGV2KSk7Cj4g
KyAgICAgICBpZiAocmV0KQo+ICsgICAgICAgICAgICAgICBnb3RvIGVycl9pcnE7Cj4gKwo+ICsg
ICAgICAgZGNzc19jdHhsZF9od19jZmcoY3R4bGQpOwo+ICsKPiArICAgICAgIHJldHVybiAwOwo+
ICsKPiArZXJyX2lycToKPiArICAgICAgIGRldm1faW91bm1hcChjdHhsZC0+ZGV2LCBjdHhsZC0+
Y3R4bGRfcmVnKTsKPiArCj4gK2VycjoKPiArICAgICAgIGRjc3NfY3R4bGRfZnJlZV9jdHgoY3R4
bGQpOwo+ICsgICAgICAgZGV2bV9rZnJlZShjdHhsZC0+ZGV2LCBjdHhsZCk7Cj4gKwo+ICsgICAg
ICAgcmV0dXJuIHJldDsKPiArfQo+ICsKPiArdm9pZCBkY3NzX2N0eGxkX2V4aXQoc3RydWN0IGRj
c3NfY3R4bGQgKmN0eGxkKQo+ICt7Cj4gKyAgICAgICBkZXZtX2ZyZWVfaXJxKGN0eGxkLT5kZXYs
IGN0eGxkLT5pcnEsIGN0eGxkKTsKPiArCj4gKyAgICAgICBpZiAoY3R4bGQtPmN0eGxkX3JlZykK
PiArICAgICAgICAgICAgICAgZGV2bV9pb3VubWFwKGN0eGxkLT5kZXYsIGN0eGxkLT5jdHhsZF9y
ZWcpOwo+ICsKPiArICAgICAgIGRjc3NfY3R4bGRfZnJlZV9jdHgoY3R4bGQpOwo+ICsgICAgICAg
ZGV2bV9rZnJlZShjdHhsZC0+ZGV2LCBjdHhsZCk7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgX19k
Y3NzX2N0eGxkX2VuYWJsZShzdHJ1Y3QgZGNzc19jdHhsZCAqY3R4bGQpCj4gK3sKPiArICAgICAg
IGludCBjdXJyX2N0eCA9IGN0eGxkLT5jdXJyZW50X2N0eDsKPiArICAgICAgIHUzMiBkYl9iYXNl
LCBzYl9iYXNlLCBzYl9jb3VudDsKPiArICAgICAgIHUzMiBzYl9ocF9jbnQsIHNiX2xwX2NudCwg
ZGJfY250Owo+ICsgICAgICAgc3RydWN0IGRjc3NfZGV2ICpkY3NzID0gZGNzc19kcnZfZGV2X3Rv
X2Rjc3MoY3R4bGQtPmRldik7Cj4gKwo+ICsgICAgICAgZGNzc19kcHJfd3JpdGVfc3lzY3RybChk
Y3NzLT5kcHIpOwo+ICsKPiArICAgICAgIGRjc3Nfc2NhbGVyX3dyaXRlX3NjbGN0cmwoZGNzcy0+
c2NhbGVyKTsKPiArCj4gKyAgICAgICBzYl9ocF9jbnQgPSBjdHhsZC0+Y3R4X3NpemVbY3Vycl9j
dHhdW0NUWF9TQl9IUF07Cj4gKyAgICAgICBzYl9scF9jbnQgPSBjdHhsZC0+Y3R4X3NpemVbY3Vy
cl9jdHhdW0NUWF9TQl9MUF07Cj4gKyAgICAgICBkYl9jbnQgPSBjdHhsZC0+Y3R4X3NpemVbY3Vy
cl9jdHhdW0NUWF9EQl07Cj4gKwo+ICsgICAgICAgLyogbWFrZSBzdXJlIFNCX0xQIGNvbnRleHQg
YXJlYSBjb21lcyBhZnRlciBTQl9IUCAqLwo+ICsgICAgICAgaWYgKHNiX2xwX2NudCAmJgo+ICsg
ICAgICAgICAgIGN0eGxkLT5zYl9scFtjdXJyX2N0eF0gIT0gY3R4bGQtPnNiX2hwW2N1cnJfY3R4
XSArIHNiX2hwX2NudCkgewo+ICsgICAgICAgICAgICAgICBzdHJ1Y3QgZGNzc19jdHhsZF9pdGVt
ICpzYl9scF9hZGp1c3RlZDsKPiArCj4gKyAgICAgICAgICAgICAgIHNiX2xwX2FkanVzdGVkID0g
Y3R4bGQtPnNiX2hwW2N1cnJfY3R4XSArIHNiX2hwX2NudDsKPiArCj4gKyAgICAgICAgICAgICAg
IG1lbWNweShzYl9scF9hZGp1c3RlZCwgY3R4bGQtPnNiX2xwW2N1cnJfY3R4XSwKPiArICAgICAg
ICAgICAgICAgICAgICAgIHNiX2xwX2NudCAqIENUWF9JVEVNX1NJWkUpOwo+ICsgICAgICAgfQo+
ICsKPiArICAgICAgIGRiX2Jhc2UgPSBkYl9jbnQgPyBjdHhsZC0+ZGJfcGFkZHJbY3Vycl9jdHhd
IDogMDsKPiArCj4gKyAgICAgICBkY3NzX3dyaXRlbChkYl9iYXNlLCBjdHhsZC0+Y3R4bGRfcmVn
ICsgRENTU19DVFhMRF9EQl9CQVNFX0FERFIpOwo+ICsgICAgICAgZGNzc193cml0ZWwoZGJfY250
LCBjdHhsZC0+Y3R4bGRfcmVnICsgRENTU19DVFhMRF9EQl9DT1VOVCk7Cj4gKwo+ICsgICAgICAg
aWYgKHNiX2hwX2NudCkKPiArICAgICAgICAgICAgICAgc2JfY291bnQgPSAoKHNiX2hwX2NudCA8
PCBTQl9IUF9DT1VOVF9QT1MpICYgU0JfSFBfQ09VTlRfTUFTSykgfAo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICgoc2JfbHBfY250IDw8IFNCX0xQX0NPVU5UX1BPUykgJiBTQl9MUF9DT1VO
VF9NQVNLKTsKPiArICAgICAgIGVsc2UKPiArICAgICAgICAgICAgICAgc2JfY291bnQgPSAoc2Jf
bHBfY250IDw8IFNCX0hQX0NPVU5UX1BPUykgJiBTQl9IUF9DT1VOVF9NQVNLOwo+ICsKPiArICAg
ICAgIHNiX2Jhc2UgPSBzYl9jb3VudCA/IGN0eGxkLT5zYl9wYWRkcltjdXJyX2N0eF0gOiAwOwo+
ICsKPiArICAgICAgIGRjc3Nfd3JpdGVsKHNiX2Jhc2UsIGN0eGxkLT5jdHhsZF9yZWcgKyBEQ1NT
X0NUWExEX1NCX0JBU0VfQUREUik7Cj4gKyAgICAgICBkY3NzX3dyaXRlbChzYl9jb3VudCwgY3R4
bGQtPmN0eGxkX3JlZyArIERDU1NfQ1RYTERfU0JfQ09VTlQpOwo+ICsKPiArICAgICAgIC8qIGVu
YWJsZSB0aGUgY29udGV4dCBsb2FkZXIgKi8KPiArICAgICAgIGRjc3Nfc2V0KENUWExEX0VOQUJM
RSwgY3R4bGQtPmN0eGxkX3JlZyArIERDU1NfQ1RYTERfQ09OVFJPTF9TVEFUVVMpOwo+ICsKPiAr
ICAgICAgIGN0eGxkLT5pbl91c2UgPSB0cnVlOwo+ICsKPiArICAgICAgIC8qCj4gKyAgICAgICAg
KiBUb2dnbGUgdGhlIGN1cnJlbnQgY29udGV4dCB0byB0aGUgYWx0ZXJuYXRlIG9uZSBzbyB0aGF0
IGFueSB1cGRhdGVzCj4gKyAgICAgICAgKiBpbiB0aGUgbW9kdWxlcycgc2V0dGluZ3MgdGFrZSBw
bGFjZSB0aGVyZS4KPiArICAgICAgICAqLwo+ICsgICAgICAgY3R4bGQtPmN1cnJlbnRfY3R4IF49
IDE7Cj4gKwo+ICsgICAgICAgY3R4bGQtPmN0eF9zaXplW2N0eGxkLT5jdXJyZW50X2N0eF1bQ1RY
X0RCXSA9IDA7Cj4gKyAgICAgICBjdHhsZC0+Y3R4X3NpemVbY3R4bGQtPmN1cnJlbnRfY3R4XVtD
VFhfU0JfSFBdID0gMDsKPiArICAgICAgIGN0eGxkLT5jdHhfc2l6ZVtjdHhsZC0+Y3VycmVudF9j
dHhdW0NUWF9TQl9MUF0gPSAwOwo+ICsKPiArICAgICAgIHJldHVybiAwOwo+ICt9Cj4gKwo+ICtp
bnQgZGNzc19jdHhsZF9lbmFibGUoc3RydWN0IGRjc3NfY3R4bGQgKmN0eGxkKQo+ICt7Cj4gKyAg
ICAgICB1bnNpZ25lZCBsb25nIGZsYWdzOwo+ICsKPiArICAgICAgIHNwaW5fbG9ja19pcnFzYXZl
KCZjdHhsZC0+bG9jaywgZmxhZ3MpOwo+ICsgICAgICAgY3R4bGQtPmFybWVkID0gdHJ1ZTsKPiAr
ICAgICAgIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmN0eGxkLT5sb2NrLCBmbGFncyk7Cj4gKwo+
ICsgICAgICAgcmV0dXJuIDA7Cj4gK30KPiArCj4gK3ZvaWQgZGNzc19jdHhsZF9raWNrKHN0cnVj
dCBkY3NzX2N0eGxkICpjdHhsZCkKPiArewo+ICsgICAgICAgdW5zaWduZWQgbG9uZyBmbGFnczsK
PiArCj4gKyAgICAgICBzcGluX2xvY2tfaXJxc2F2ZSgmY3R4bGQtPmxvY2ssIGZsYWdzKTsKPiAr
ICAgICAgIGlmIChjdHhsZC0+YXJtZWQgJiYgIWN0eGxkLT5pbl91c2UpIHsKPiArICAgICAgICAg
ICAgICAgY3R4bGQtPmFybWVkID0gZmFsc2U7Cj4gKyAgICAgICAgICAgICAgIF9fZGNzc19jdHhs
ZF9lbmFibGUoY3R4bGQpOwo+ICsgICAgICAgfQo+ICsgICAgICAgc3Bpbl91bmxvY2tfaXJxcmVz
dG9yZSgmY3R4bGQtPmxvY2ssIGZsYWdzKTsKPiArfQo+ICsKPiArdm9pZCBkY3NzX2N0eGxkX3dy
aXRlX2lycXNhZmUoc3RydWN0IGRjc3NfY3R4bGQgKmN0eGxkLCB1MzIgY3R4X2lkLCB1MzIgdmFs
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUzMiByZWdfb2ZzKQo+ICt7Cj4gKyAg
ICAgICBpbnQgY3Vycl9jdHggPSBjdHhsZC0+Y3VycmVudF9jdHg7Cj4gKyAgICAgICBzdHJ1Y3Qg
ZGNzc19jdHhsZF9pdGVtICpjdHhbXSA9IHsKPiArICAgICAgICAgICAgICAgW0NUWF9EQl0gPSBj
dHhsZC0+ZGJbY3Vycl9jdHhdLAo+ICsgICAgICAgICAgICAgICBbQ1RYX1NCX0hQXSA9IGN0eGxk
LT5zYl9ocFtjdXJyX2N0eF0sCj4gKyAgICAgICAgICAgICAgIFtDVFhfU0JfTFBdID0gY3R4bGQt
PnNiX2xwW2N1cnJfY3R4XQo+ICsgICAgICAgfTsKPiArICAgICAgIGludCBpdGVtX2lkeCA9IGN0
eGxkLT5jdHhfc2l6ZVtjdXJyX2N0eF1bY3R4X2lkXTsKPiArCj4gKyAgICAgICBpZiAoaXRlbV9p
ZHggKyAxID4gZGNzc19jdHhsZF9jdHhfc2l6ZVtjdHhfaWRdKSB7Cj4gKyAgICAgICAgICAgICAg
IFdBUk5fT04oMSk7Cj4gKyAgICAgICAgICAgICAgIHJldHVybjsKPiArICAgICAgIH0KPiArCj4g
KyAgICAgICBjdHhbY3R4X2lkXVtpdGVtX2lkeF0udmFsID0gdmFsOwo+ICsgICAgICAgY3R4W2N0
eF9pZF1baXRlbV9pZHhdLm9mcyA9IHJlZ19vZnM7Cj4gKyAgICAgICBjdHhsZC0+Y3R4X3NpemVb
Y3Vycl9jdHhdW2N0eF9pZF0gKz0gMTsKPiArfQo+ICsKPiArdm9pZCBkY3NzX2N0eGxkX3dyaXRl
KHN0cnVjdCBkY3NzX2N0eGxkICpjdHhsZCwgdTMyIGN0eF9pZCwKPiArICAgICAgICAgICAgICAg
ICAgICAgdTMyIHZhbCwgdTMyIHJlZ19vZnMpCj4gK3sKPiArICAgICAgIHVuc2lnbmVkIGxvbmcg
ZmxhZ3M7Cj4gKwo+ICsgICAgICAgc3Bpbl9sb2NrX2lycXNhdmUoJmN0eGxkLT5sb2NrLCBmbGFn
cyk7Cj4gKyAgICAgICBkY3NzX2N0eGxkX3dyaXRlX2lycXNhZmUoY3R4bGQsIGN0eF9pZCwgdmFs
LCByZWdfb2ZzKTsKPiArICAgICAgIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmN0eGxkLT5sb2Nr
LCBmbGFncyk7Cj4gK30KPiArCj4gK2Jvb2wgZGNzc19jdHhsZF9pc19mbHVzaGVkKHN0cnVjdCBk
Y3NzX2N0eGxkICpjdHhsZCkKPiArewo+ICsgICAgICAgcmV0dXJuIGN0eGxkLT5jdHhfc2l6ZVtj
dHhsZC0+Y3VycmVudF9jdHhdW0NUWF9EQl0gPT0gMCAmJgo+ICsgICAgICAgICAgICAgICBjdHhs
ZC0+Y3R4X3NpemVbY3R4bGQtPmN1cnJlbnRfY3R4XVtDVFhfU0JfSFBdID09IDAgJiYKPiArICAg
ICAgICAgICAgICAgY3R4bGQtPmN0eF9zaXplW2N0eGxkLT5jdXJyZW50X2N0eF1bQ1RYX1NCX0xQ
XSA9PSAwOwo+ICt9Cj4gKwo+ICtpbnQgZGNzc19jdHhsZF9yZXN1bWUoc3RydWN0IGRjc3NfY3R4
bGQgKmN0eGxkKQo+ICt7Cj4gKyAgICAgICBkY3NzX2N0eGxkX2h3X2NmZyhjdHhsZCk7Cj4gKwo+
ICsgICAgICAgaWYgKCFjdHhsZC0+aXJxX2VuKSB7Cj4gKyAgICAgICAgICAgICAgIGVuYWJsZV9p
cnEoY3R4bGQtPmlycSk7Cj4gKyAgICAgICAgICAgICAgIGN0eGxkLT5pcnFfZW4gPSB0cnVlOwo+
ICsgICAgICAgfQo+ICsKPiArICAgICAgIHJldHVybiAwOwo+ICt9Cj4gKwo+ICtpbnQgZGNzc19j
dHhsZF9zdXNwZW5kKHN0cnVjdCBkY3NzX2N0eGxkICpjdHhsZCkKPiArewo+ICsgICAgICAgaW50
IHJldCA9IDA7Cj4gKyAgICAgICBpbnQgd2FpdF90aW1lX21zID0gMDsKPiArICAgICAgIHVuc2ln
bmVkIGxvbmcgZmxhZ3M7Cj4gKwo+ICsgICAgICAgZGNzc19jdHhsZF9raWNrKGN0eGxkKTsKPiAr
Cj4gKyAgICAgICB3aGlsZSAoY3R4bGQtPmluX3VzZSAmJiB3YWl0X3RpbWVfbXMgPCA1MDApIHsK
PiArICAgICAgICAgICAgICAgbXNsZWVwKDIwKTsKPiArICAgICAgICAgICAgICAgd2FpdF90aW1l
X21zICs9IDIwOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGlmICh3YWl0X3RpbWVfbXMgPiA1
MDApCj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRVRJTUVET1VUOwo+ICsKPiArICAgICAgIHNw
aW5fbG9ja19pcnFzYXZlKCZjdHhsZC0+bG9jaywgZmxhZ3MpOwo+ICsKPiArICAgICAgIGlmIChj
dHhsZC0+aXJxX2VuKSB7Cj4gKyAgICAgICAgICAgICAgIGRpc2FibGVfaXJxX25vc3luYyhjdHhs
ZC0+aXJxKTsKPiArICAgICAgICAgICAgICAgY3R4bGQtPmlycV9lbiA9IGZhbHNlOwo+ICsgICAg
ICAgfQo+ICsKPiArICAgICAgIC8qIHJlc2V0IGNvbnRleHQgcmVnaW9uIGFuZCBzaXplcyAqLwo+
ICsgICAgICAgY3R4bGQtPmN1cnJlbnRfY3R4ID0gMDsKPiArICAgICAgIGN0eGxkLT5jdHhfc2l6
ZVswXVtDVFhfREJdID0gMDsKPiArICAgICAgIGN0eGxkLT5jdHhfc2l6ZVswXVtDVFhfU0JfSFBd
ID0gMDsKPiArICAgICAgIGN0eGxkLT5jdHhfc2l6ZVswXVtDVFhfU0JfTFBdID0gMDsKPiArCj4g
KyAgICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZjdHhsZC0+bG9jaywgZmxhZ3MpOwo+ICsK
PiArICAgICAgIHJldHVybiByZXQ7Cj4gK30KPiArCj4gK3ZvaWQgZGNzc19jdHhsZF9yZWdpc3Rl
cl9kdGdfZGlzYWJsZV9jYihzdHJ1Y3QgZGNzc19jdHhsZCAqY3R4bGQsCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKCpjYikodm9pZCAqKSwKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqZGF0YSkKPiArewo+ICsgICAg
ICAgY3R4bGQtPmR0Z19kaXNhYmxlX2NiID0gY2I7Cj4gKyAgICAgICBjdHhsZC0+ZHRnX2Rpc2Fi
bGVfZGF0YSA9IGRhdGE7Cj4gK30KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2lteC9k
Y3NzL2Rjc3MtZGV2LmMgYi9kcml2ZXJzL2dwdS9kcm0vaW14L2Rjc3MvZGNzcy1kZXYuYwo+IG5l
dyBmaWxlIG1vZGUgMTAwNjQ0Cj4gaW5kZXggMDAwMDAwMDAuLjI2NWJmM2MKPiAtLS0gL2Rldi9u
dWxsCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2lteC9kY3NzL2Rjc3MtZGV2LmMKPiBAQCAtMCww
ICsxLDI4NiBAQAo+ICsvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAo+ICsvKgo+
ICsgKiBDb3B5cmlnaHQgMjAxOSBOWFAuCj4gKyAqLwo+ICsKPiArI2luY2x1ZGUgPGxpbnV4L2Ns
ay5oPgo+ICsjaW5jbHVkZSA8bGludXgvb2ZfZGV2aWNlLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9v
Zl9ncmFwaC5oPgo+ICsjaW5jbHVkZSA8bGludXgvcG1fcnVudGltZS5oPgo+ICsjaW5jbHVkZSA8
ZHJtL2RybV9tb2Rlc2V0X2hlbHBlci5oPgo+ICsKPiArI2luY2x1ZGUgImRjc3MtZGV2LmgiCj4g
Kwo+ICtzdGF0aWMgdm9pZCBkY3NzX2Nsb2Nrc19lbmFibGUoc3RydWN0IGRjc3NfZGV2ICpkY3Nz
KQo+ICt7Cj4gKyAgICAgICBpZiAoZGNzcy0+Y2xrc19vbikKPiArICAgICAgICAgICAgICAgcmV0
dXJuOwo+ICsKPiArICAgICAgIGNsa19wcmVwYXJlX2VuYWJsZShkY3NzLT5heGlfY2xrKTsKPiAr
ICAgICAgIGNsa19wcmVwYXJlX2VuYWJsZShkY3NzLT5hcGJfY2xrKTsKPiArICAgICAgIGNsa19w
cmVwYXJlX2VuYWJsZShkY3NzLT5ydHJtX2Nsayk7Cj4gKyAgICAgICBjbGtfcHJlcGFyZV9lbmFi
bGUoZGNzcy0+ZHRyY19jbGspOwo+ICsgICAgICAgY2xrX3ByZXBhcmVfZW5hYmxlKGRjc3MtPnBp
eF9jbGspOwo+ICsKPiArICAgICAgIGRjc3MtPmNsa3Nfb24gPSB0cnVlOwo+ICt9Cj4gKwo+ICtz
dGF0aWMgdm9pZCBkY3NzX2Nsb2Nrc19kaXNhYmxlKHN0cnVjdCBkY3NzX2RldiAqZGNzcykKPiAr
ewo+ICsgICAgICAgaWYgKCFkY3NzLT5jbGtzX29uKQo+ICsgICAgICAgICAgICAgICByZXR1cm47
Cj4gKwo+ICsgICAgICAgY2xrX2Rpc2FibGVfdW5wcmVwYXJlKGRjc3MtPnBpeF9jbGspOwo+ICsg
ICAgICAgY2xrX2Rpc2FibGVfdW5wcmVwYXJlKGRjc3MtPmR0cmNfY2xrKTsKPiArICAgICAgIGNs
a19kaXNhYmxlX3VucHJlcGFyZShkY3NzLT5ydHJtX2Nsayk7Cj4gKyAgICAgICBjbGtfZGlzYWJs
ZV91bnByZXBhcmUoZGNzcy0+YXBiX2Nsayk7Cj4gKyAgICAgICBjbGtfZGlzYWJsZV91bnByZXBh
cmUoZGNzcy0+YXhpX2Nsayk7Cj4gKwo+ICsgICAgICAgZGNzcy0+Y2xrc19vbiA9IGZhbHNlOwo+
ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGRjc3Nfc3VibW9kdWxlc19pbml0KHN0cnVjdCBkY3NzX2Rl
diAqZGNzcykKPiArewo+ICsgICAgICAgaW50IHJldCA9IDA7Cj4gKyAgICAgICB1MzIgYmFzZV9h
ZGRyID0gZGNzcy0+c3RhcnRfYWRkcjsKPiArICAgICAgIGNvbnN0IHN0cnVjdCBkY3NzX3R5cGVf
ZGF0YSAqZGV2dHlwZSA9IGRjc3MtPmRldnR5cGU7Cj4gKwo+ICsgICAgICAgZGNzc19jbG9ja3Nf
ZW5hYmxlKGRjc3MpOwo+ICsKPiArICAgICAgIHJldCA9IGRjc3NfYmxrY3RsX2luaXQoZGNzcywg
YmFzZV9hZGRyICsgZGV2dHlwZS0+YmxrY3RsX29mcyk7Cj4gKyAgICAgICBpZiAocmV0KQo+ICsg
ICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+ICsKPiArICAgICAgIHJldCA9IGRjc3NfY3R4bGRf
aW5pdChkY3NzLCBiYXNlX2FkZHIgKyBkZXZ0eXBlLT5jdHhsZF9vZnMpOwo+ICsgICAgICAgaWYg
KHJldCkKPiArICAgICAgICAgICAgICAgZ290byBjdHhsZF9lcnI7Cj4gKwo+ICsgICAgICAgcmV0
ID0gZGNzc19kdGdfaW5pdChkY3NzLCBiYXNlX2FkZHIgKyBkZXZ0eXBlLT5kdGdfb2ZzKTsKPiAr
ICAgICAgIGlmIChyZXQpCj4gKyAgICAgICAgICAgICAgIGdvdG8gZHRnX2VycjsKPiArCj4gKyAg
ICAgICByZXQgPSBkY3NzX3NzX2luaXQoZGNzcywgYmFzZV9hZGRyICsgZGV2dHlwZS0+c3Nfb2Zz
KTsKPiArICAgICAgIGlmIChyZXQpCj4gKyAgICAgICAgICAgICAgIGdvdG8gc3NfZXJyOwo+ICsK
PiArICAgICAgIHJldCA9IGRjc3NfZHByX2luaXQoZGNzcywgYmFzZV9hZGRyICsgZGV2dHlwZS0+
ZHByX29mcyk7Cj4gKyAgICAgICBpZiAocmV0KQo+ICsgICAgICAgICAgICAgICBnb3RvIGRwcl9l
cnI7Cj4gKwo+ICsgICAgICAgcmV0ID0gZGNzc19zY2FsZXJfaW5pdChkY3NzLCBiYXNlX2FkZHIg
KyBkZXZ0eXBlLT5zY2FsZXJfb2ZzKTsKPiArICAgICAgIGlmIChyZXQpCj4gKyAgICAgICAgICAg
ICAgIGdvdG8gc2NhbGVyX2VycjsKPiArCj4gKyAgICAgICByZXR1cm4gMDsKPiArCj4gK3NjYWxl
cl9lcnI6Cj4gKyAgICAgICBkY3NzX2Rwcl9leGl0KGRjc3MtPmRwcik7Cj4gKwo+ICtkcHJfZXJy
Ogo+ICsgICAgICAgZGNzc19zc19leGl0KGRjc3MtPnNzKTsKPiArCj4gK3NzX2VycjoKPiArICAg
ICAgIGRjc3NfZHRnX2V4aXQoZGNzcy0+ZHRnKTsKPiArCj4gK2R0Z19lcnI6Cj4gKyAgICAgICBk
Y3NzX2N0eGxkX2V4aXQoZGNzcy0+Y3R4bGQpOwo+ICsKPiArY3R4bGRfZXJyOgo+ICsgICAgICAg
ZGNzc19ibGtjdGxfZXhpdChkY3NzLT5ibGtjdGwpOwo+ICsKPiArICAgICAgIGRjc3NfY2xvY2tz
X2Rpc2FibGUoZGNzcyk7Cj4gKwo+ICsgICAgICAgcmV0dXJuIHJldDsKPiArfQo+ICsKPiArc3Rh
dGljIHZvaWQgZGNzc19zdWJtb2R1bGVzX3N0b3Aoc3RydWN0IGRjc3NfZGV2ICpkY3NzKQo+ICt7
Cj4gKyAgICAgICBkY3NzX2Nsb2Nrc19lbmFibGUoZGNzcyk7Cj4gKyAgICAgICBkY3NzX3NjYWxl
cl9leGl0KGRjc3MtPnNjYWxlcik7Cj4gKyAgICAgICBkY3NzX2Rwcl9leGl0KGRjc3MtPmRwcik7
Cj4gKyAgICAgICBkY3NzX3NzX2V4aXQoZGNzcy0+c3MpOwo+ICsgICAgICAgZGNzc19kdGdfZXhp
dChkY3NzLT5kdGcpOwo+ICsgICAgICAgZGNzc19jdHhsZF9leGl0KGRjc3MtPmN0eGxkKTsKPiAr
ICAgICAgIGRjc3NfYmxrY3RsX2V4aXQoZGNzcy0+YmxrY3RsKTsKPiArICAgICAgIGRjc3NfY2xv
Y2tzX2Rpc2FibGUoZGNzcyk7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgZGNzc19jbGtzX2luaXQo
c3RydWN0IGRjc3NfZGV2ICpkY3NzKQo+ICt7Cj4gKyAgICAgICBpbnQgaTsKPiArICAgICAgIHN0
cnVjdCB7Cj4gKyAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmlkOwo+ICsgICAgICAgICAgICAg
ICBzdHJ1Y3QgY2xrICoqY2xrOwo+ICsgICAgICAgfSBjbGtzW10gPSB7Cj4gKyAgICAgICAgICAg
ICAgIHsiYXBiIiwgICAmZGNzcy0+YXBiX2Nsa30sCj4gKyAgICAgICAgICAgICAgIHsiYXhpIiwg
ICAmZGNzcy0+YXhpX2Nsa30sCj4gKyAgICAgICAgICAgICAgIHsicGl4IiwgICAmZGNzcy0+cGl4
X2Nsa30sCj4gKyAgICAgICAgICAgICAgIHsicnRybSIsICAmZGNzcy0+cnRybV9jbGt9LAo+ICsg
ICAgICAgICAgICAgICB7ImR0cmMiLCAgJmRjc3MtPmR0cmNfY2xrfSwKPiArICAgICAgIH07Cj4g
Kwo+ICsgICAgICAgZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoY2xrcyk7IGkrKykgewo+ICsg
ICAgICAgICAgICAgICAqY2xrc1tpXS5jbGsgPSBkZXZtX2Nsa19nZXQoZGNzcy0+ZGV2LCBjbGtz
W2ldLmlkKTsKPiArICAgICAgICAgICAgICAgaWYgKElTX0VSUigqY2xrc1tpXS5jbGspKSB7Cj4g
KyAgICAgICAgICAgICAgICAgICAgICAgZGV2X2VycihkY3NzLT5kZXYsICJmYWlsZWQgdG8gZ2V0
ICVzIGNsb2NrXG4iLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xrc1tpXS5p
ZCk7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFBUUl9FUlIoKmNsa3NbaV0uY2xr
KTsKPiArICAgICAgICAgICAgICAgfQo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGRjc3MtPmNs
a3Nfb24gPSBmYWxzZTsKPiArCj4gKyAgICAgICByZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGlj
IHZvaWQgZGNzc19jbGtzX3JlbGVhc2Uoc3RydWN0IGRjc3NfZGV2ICpkY3NzKQo+ICt7Cj4gKyAg
ICAgICBkZXZtX2Nsa19wdXQoZGNzcy0+ZGV2LCBkY3NzLT5kdHJjX2Nsayk7Cj4gKyAgICAgICBk
ZXZtX2Nsa19wdXQoZGNzcy0+ZGV2LCBkY3NzLT5ydHJtX2Nsayk7Cj4gKyAgICAgICBkZXZtX2Ns
a19wdXQoZGNzcy0+ZGV2LCBkY3NzLT5waXhfY2xrKTsKPiArICAgICAgIGRldm1fY2xrX3B1dChk
Y3NzLT5kZXYsIGRjc3MtPmF4aV9jbGspOwo+ICsgICAgICAgZGV2bV9jbGtfcHV0KGRjc3MtPmRl
diwgZGNzcy0+YXBiX2Nsayk7Cj4gK30KPiArCj4gK3N0cnVjdCBkY3NzX2RldiAqZGNzc19kZXZf
Y3JlYXRlKHN0cnVjdCBkZXZpY2UgKmRldiwgYm9vbCBoZG1pX291dHB1dCkKPiArewo+ICsgICAg
ICAgc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldiA9IHRvX3BsYXRmb3JtX2RldmljZShkZXYp
Owo+ICsgICAgICAgaW50IHJldDsKPiArICAgICAgIHN0cnVjdCByZXNvdXJjZSAqcmVzOwo+ICsg
ICAgICAgc3RydWN0IGRjc3NfZGV2ICpkY3NzOwo+ICsgICAgICAgY29uc3Qgc3RydWN0IGRjc3Nf
dHlwZV9kYXRhICpkZXZ0eXBlOwo+ICsKPiArICAgICAgIGRldnR5cGUgPSBvZl9kZXZpY2VfZ2V0
X21hdGNoX2RhdGEoZGV2KTsKPiArICAgICAgIGlmICghZGV2dHlwZSkgewo+ICsgICAgICAgICAg
ICAgICBkZXZfZXJyKGRldiwgIm5vIGRldmljZSBtYXRjaCBmb3VuZFxuIik7Cj4gKyAgICAgICAg
ICAgICAgIHJldHVybiBFUlJfUFRSKC1FTk9ERVYpOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAg
IHJlcyA9IHBsYXRmb3JtX2dldF9yZXNvdXJjZShwZGV2LCBJT1JFU09VUkNFX01FTSwgMCk7Cj4g
KyAgICAgICBpZiAoIXJlcykgewo+ICsgICAgICAgICAgICAgICBkZXZfZXJyKGRldiwgImNhbm5v
dCBnZXQgbWVtb3J5IHJlc291cmNlXG4iKTsKPiArICAgICAgICAgICAgICAgcmV0dXJuIEVSUl9Q
VFIoLUVJTlZBTCk7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgZGNzcyA9IGRldm1fa3phbGxv
YyhkZXYsIHNpemVvZihzdHJ1Y3QgZGNzc19kZXYpLCBHRlBfS0VSTkVMKTsKPiArICAgICAgIGlm
ICghZGNzcykKPiArICAgICAgICAgICAgICAgcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7Cj4gKwo+
ICsgICAgICAgZGNzcy0+ZGV2ID0gZGV2Owo+ICsgICAgICAgZGNzcy0+ZGV2dHlwZSA9IGRldnR5
cGU7Cj4gKyAgICAgICBkY3NzLT5oZG1pX291dHB1dCA9IGhkbWlfb3V0cHV0Owo+ICsKPiArICAg
ICAgIHJldCA9IGRjc3NfY2xrc19pbml0KGRjc3MpOwo+ICsgICAgICAgaWYgKHJldCkgewo+ICsg
ICAgICAgICAgICAgICBkZXZfZXJyKGRldiwgImNsb2NrcyBpbml0aWFsaXphdGlvbiBmYWlsZWRc
biIpOwo+ICsgICAgICAgICAgICAgICBnb3RvIGVycjsKPiArICAgICAgIH0KPiArCj4gKyAgICAg
ICBkY3NzLT5vZl9wb3J0ID0gb2ZfZ3JhcGhfZ2V0X3BvcnRfYnlfaWQoZGV2LT5vZl9ub2RlLCAw
KTsKPiArICAgICAgIGlmICghZGNzcy0+b2ZfcG9ydCkgewo+ICsgICAgICAgICAgICAgICBkZXZf
ZXJyKGRldiwgIm5vIHBvcnRAMCBub2RlIGluICVzXG4iLCBkZXYtPm9mX25vZGUtPmZ1bGxfbmFt
ZSk7Cj4gKyAgICAgICAgICAgICAgIHJldCA9IC1FTk9ERVY7Cj4gKyAgICAgICAgICAgICAgIGdv
dG8gY2xrc19lcnI7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgZGNzcy0+c3RhcnRfYWRkciA9
IHJlcy0+c3RhcnQ7Cj4gKwo+ICsgICAgICAgcmV0ID0gZGNzc19zdWJtb2R1bGVzX2luaXQoZGNz
cyk7Cj4gKyAgICAgICBpZiAocmV0KSB7Cj4gKyAgICAgICAgICAgICAgIGRldl9lcnIoZGV2LCAi
c3VibW9kdWxlcyBpbml0aWFsaXphdGlvbiBmYWlsZWRcbiIpOwo+ICsgICAgICAgICAgICAgICBn
b3RvIGNsa3NfZXJyOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIHBtX3J1bnRpbWVfZW5hYmxl
KGRldik7Cj4gKwo+ICsgICAgICAgcmV0dXJuIGRjc3M7Cj4gKwo+ICtjbGtzX2VycjoKPiArICAg
ICAgIGRjc3NfY2xrc19yZWxlYXNlKGRjc3MpOwo+ICsKPiArZXJyOgo+ICsgICAgICAgZGV2bV9r
ZnJlZShkY3NzLT5kZXYsIGRjc3MpOwo+ICsKPiArICAgICAgIHJldHVybiBFUlJfUFRSKHJldCk7
Cj4gK30KPiArCj4gK3ZvaWQgZGNzc19kZXZfZGVzdHJveShzdHJ1Y3QgZGNzc19kZXYgKmRjc3Mp
Cj4gK3sKPiArICAgICAgIHBtX3J1bnRpbWVfZGlzYWJsZShkY3NzLT5kZXYpOwo+ICsKPiArICAg
ICAgIGRjc3Nfc3VibW9kdWxlc19zdG9wKGRjc3MpOwo+ICsKPiArICAgICAgIGRjc3NfY2xrc19y
ZWxlYXNlKGRjc3MpOwo+ICsKPiArICAgICAgIGRldm1fa2ZyZWUoZGNzcy0+ZGV2LCBkY3NzKTsK
PiArfQo+ICsKPiArI2lmZGVmIENPTkZJR19QTV9TTEVFUAo+ICtpbnQgZGNzc19kZXZfc3VzcGVu
ZChzdHJ1Y3QgZGV2aWNlICpkZXYpCj4gK3sKPiArICAgICAgIHN0cnVjdCBkY3NzX2RldiAqZGNz
cyA9IGRjc3NfZHJ2X2Rldl90b19kY3NzKGRldik7Cj4gKyAgICAgICBpbnQgcmV0Owo+ICsKPiAr
ICAgICAgIGRybV9tb2RlX2NvbmZpZ19oZWxwZXJfc3VzcGVuZChkY3NzX2Rydl9kZXZfdG9fZHJt
KGRldikpOwo+ICsKPiArICAgICAgIGlmIChwbV9ydW50aW1lX3N1c3BlbmRlZChkZXYpKQo+ICsg
ICAgICAgICAgICAgICByZXR1cm4gMDsKPiArCj4gKyAgICAgICByZXQgPSBkY3NzX2N0eGxkX3N1
c3BlbmQoZGNzcy0+Y3R4bGQpOwo+ICsgICAgICAgaWYgKHJldCkKPiArICAgICAgICAgICAgICAg
cmV0dXJuIHJldDsKPiArCj4gKyAgICAgICBkY3NzX2Nsb2Nrc19kaXNhYmxlKGRjc3MpOwo+ICsK
PiArICAgICAgIHJldHVybiAwOwo+ICt9Cj4gKwo+ICtpbnQgZGNzc19kZXZfcmVzdW1lKHN0cnVj
dCBkZXZpY2UgKmRldikKPiArewo+ICsgICAgICAgc3RydWN0IGRjc3NfZGV2ICpkY3NzID0gZGNz
c19kcnZfZGV2X3RvX2Rjc3MoZGV2KTsKPiArCj4gKyAgICAgICBpZiAocG1fcnVudGltZV9zdXNw
ZW5kZWQoZGV2KSkgewo+ICsgICAgICAgICAgICAgICBkcm1fbW9kZV9jb25maWdfaGVscGVyX3Jl
c3VtZShkY3NzX2Rydl9kZXZfdG9fZHJtKGRldikpOwo+ICsgICAgICAgICAgICAgICByZXR1cm4g
MDsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICBkY3NzX2Nsb2Nrc19lbmFibGUoZGNzcyk7Cj4g
Kwo+ICsgICAgICAgZGNzc19ibGtjdGxfY2ZnKGRjc3MtPmJsa2N0bCk7Cj4gKwo+ICsgICAgICAg
ZGNzc19jdHhsZF9yZXN1bWUoZGNzcy0+Y3R4bGQpOwo+ICsKPiArICAgICAgIGRybV9tb2RlX2Nv
bmZpZ19oZWxwZXJfcmVzdW1lKGRjc3NfZHJ2X2Rldl90b19kcm0oZGV2KSk7Cj4gKwo+ICsgICAg
ICAgcmV0dXJuIDA7Cj4gK30KPiArI2VuZGlmIC8qIENPTkZJR19QTV9TTEVFUCAqLwo+ICsKPiAr
I2lmZGVmIENPTkZJR19QTQo+ICtpbnQgZGNzc19kZXZfcnVudGltZV9zdXNwZW5kKHN0cnVjdCBk
ZXZpY2UgKmRldikKPiArewo+ICsgICAgICAgc3RydWN0IGRjc3NfZGV2ICpkY3NzID0gZGNzc19k
cnZfZGV2X3RvX2Rjc3MoZGV2KTsKPiArICAgICAgIGludCByZXQ7Cj4gKwo+ICsgICAgICAgcmV0
ID0gZGNzc19jdHhsZF9zdXNwZW5kKGRjc3MtPmN0eGxkKTsKPiArICAgICAgIGlmIChyZXQpCj4g
KyAgICAgICAgICAgICAgIHJldHVybiByZXQ7Cj4gKwo+ICsgICAgICAgZGNzc19jbG9ja3NfZGlz
YWJsZShkY3NzKTsKPiArCj4gKyAgICAgICByZXR1cm4gMDsKPiArfQo+ICsKPiAraW50IGRjc3Nf
ZGV2X3J1bnRpbWVfcmVzdW1lKHN0cnVjdCBkZXZpY2UgKmRldikKPiArewo+ICsgICAgICAgc3Ry
dWN0IGRjc3NfZGV2ICpkY3NzID0gZGNzc19kcnZfZGV2X3RvX2Rjc3MoZGV2KTsKPiArCj4gKyAg
ICAgICBkY3NzX2Nsb2Nrc19lbmFibGUoZGNzcyk7Cj4gKwo+ICsgICAgICAgZGNzc19ibGtjdGxf
Y2ZnKGRjc3MtPmJsa2N0bCk7Cj4gKwo+ICsgICAgICAgZGNzc19jdHhsZF9yZXN1bWUoZGNzcy0+
Y3R4bGQpOwo+ICsKPiArICAgICAgIHJldHVybiAwOwo+ICt9Cj4gKyNlbmRpZiAvKiBDT05GSUdf
UE0gKi8KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2lteC9kY3NzL2Rjc3MtZGV2Lmgg
Yi9kcml2ZXJzL2dwdS9kcm0vaW14L2Rjc3MvZGNzcy1kZXYuaAo+IG5ldyBmaWxlIG1vZGUgMTAw
NjQ0Cj4gaW5kZXggMDAwMDAwMDAuLjE1YzVkZTMKPiAtLS0gL2Rldi9udWxsCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2lteC9kY3NzL2Rjc3MtZGV2LmgKPiBAQCAtMCwwICsxLDE5NSBAQAo+ICsv
KiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCAqLwo+ICsvKgo+ICsgKiBDb3B5cmln
aHQgMjAxOSBOWFAuCj4gKyAqLwo+ICsKPiArI2lmbmRlZiBfX0RDU1NfUFJWX0hfXwo+ICsjZGVm
aW5lIF9fRENTU19QUlZfSF9fCj4gKwo+ICsjaW5jbHVkZSA8ZHJtL2RybV9mb3VyY2MuaD4KPiAr
I2luY2x1ZGUgPGxpbnV4L2lvLmg+Cj4gKyNpbmNsdWRlIDx2aWRlby92aWRlb21vZGUuaD4KPiAr
Cj4gKyNkZWZpbmUgU0VUICAgICAgICAgICAgICAgICAgICAweDA0Cj4gKyNkZWZpbmUgQ0xSICAg
ICAgICAgICAgICAgICAgICAweDA4Cj4gKyNkZWZpbmUgVEdMICAgICAgICAgICAgICAgICAgICAw
eDBDCj4gKwo+ICsjZGVmaW5lIGRjc3Nfd3JpdGVsKHYsIGMpICAgICAgd3JpdGVsKCh2KSwgKGMp
KQo+ICsjZGVmaW5lIGRjc3NfcmVhZGwoYykgICAgICAgICAgcmVhZGwoYykKPiArI2RlZmluZSBk
Y3NzX3NldCh2LCBjKSAgICAgICAgIHdyaXRlbCgodiksIChjKSArIFNFVCkKPiArI2RlZmluZSBk
Y3NzX2Nscih2LCBjKSAgICAgICAgIHdyaXRlbCgodiksIChjKSArIENMUikKPiArI2RlZmluZSBk
Y3NzX3RvZ2dsZSh2LCBjKSAgICAgIHdyaXRlbCgodiksIChjKSArIFRHTCkKPiArCj4gK3N0YXRp
YyBpbmxpbmUgdm9pZCBkY3NzX3VwZGF0ZSh1MzIgdiwgdTMyIG0sIHZvaWQgX19pb21lbSAqYykK
PiArewo+ICsgICAgICAgd3JpdGVsKChyZWFkbChjKSAmIH4obSkpIHwgKHYpLCAoYykpOwo+ICt9
Cj4gKwo+ICsjZGVmaW5lIERDU1NfREJHX1JFRyhyZWcpICAgICAgey5uYW1lID0gI3JlZywgLm9m
cyA9IHJlZ30KPiArCj4gK2VudW0gewo+ICsgICAgICAgRENTU19JTVg4TVEgPSAwLAo+ICt9Owo+
ICsKPiArc3RydWN0IGRjc3NfdHlwZV9kYXRhIHsKPiArICAgICAgIGNvbnN0IGNoYXIgKm5hbWU7
Cj4gKyAgICAgICB1MzIgYmxrY3RsX29mczsKPiArICAgICAgIHUzMiBjdHhsZF9vZnM7Cj4gKyAg
ICAgICB1MzIgcmRzcmNfb2ZzOwo+ICsgICAgICAgdTMyIHdyc2NsX29mczsKPiArICAgICAgIHUz
MiBkdGdfb2ZzOwo+ICsgICAgICAgdTMyIHNjYWxlcl9vZnM7Cj4gKyAgICAgICB1MzIgc3Nfb2Zz
Owo+ICsgICAgICAgdTMyIGRwcl9vZnM7Cj4gKyAgICAgICB1MzIgZHRyY19vZnM7Cj4gKyAgICAg
ICB1MzIgZGVjNDAwZF9vZnM7Cj4gKyAgICAgICB1MzIgaGRyMTBfb2ZzOwo+ICt9Owo+ICsKPiAr
c3RydWN0IGRjc3NfZGVidWdfcmVnIHsKPiArICAgICAgIGNoYXIgKm5hbWU7Cj4gKyAgICAgICB1
MzIgb2ZzOwo+ICt9Owo+ICsKPiArZW51bSBkY3NzX2N0eGxkX2N0eF90eXBlIHsKPiArICAgICAg
IENUWF9EQiwKPiArICAgICAgIENUWF9TQl9IUCwgLyogaGlnaC1wcmlvcml0eSAqLwo+ICsgICAg
ICAgQ1RYX1NCX0xQLCAvKiBsb3ctcHJpb3JpdHkgICovCj4gK307Cj4gKwo+ICtzdHJ1Y3QgZGNz
c19kZXYgewo+ICsgICAgICAgc3RydWN0IGRldmljZSAqZGV2Owo+ICsgICAgICAgY29uc3Qgc3Ry
dWN0IGRjc3NfdHlwZV9kYXRhICpkZXZ0eXBlOwo+ICsgICAgICAgc3RydWN0IGRldmljZV9ub2Rl
ICpvZl9wb3J0Owo+ICsKPiArICAgICAgIHUzMiBzdGFydF9hZGRyOwo+ICsKPiArICAgICAgIHN0
cnVjdCBkY3NzX2Jsa2N0bCAqYmxrY3RsOwo+ICsgICAgICAgc3RydWN0IGRjc3NfY3R4bGQgKmN0
eGxkOwo+ICsgICAgICAgc3RydWN0IGRjc3NfZHByICpkcHI7Cj4gKyAgICAgICBzdHJ1Y3QgZGNz
c19kdGcgKmR0ZzsKPiArICAgICAgIHN0cnVjdCBkY3NzX3NzICpzczsKPiArICAgICAgIHN0cnVj
dCBkY3NzX2hkcjEwICpoZHIxMDsKPiArICAgICAgIHN0cnVjdCBkY3NzX3NjYWxlciAqc2NhbGVy
Owo+ICsgICAgICAgc3RydWN0IGRjc3NfZHRyYyAqZHRyYzsKPiArICAgICAgIHN0cnVjdCBkY3Nz
X2RlYzQwMGQgKmRlYzQwMGQ7Cj4gKyAgICAgICBzdHJ1Y3QgZGNzc193cnNjbCAqd3JzY2w7Cj4g
KyAgICAgICBzdHJ1Y3QgZGNzc19yZHNyYyAqcmRzcmM7Cj4gKwo+ICsgICAgICAgc3RydWN0IGNs
ayAqYXBiX2NsazsKPiArICAgICAgIHN0cnVjdCBjbGsgKmF4aV9jbGs7Cj4gKyAgICAgICBzdHJ1
Y3QgY2xrICpwaXhfY2xrOwo+ICsgICAgICAgc3RydWN0IGNsayAqcnRybV9jbGs7Cj4gKyAgICAg
ICBzdHJ1Y3QgY2xrICpkdHJjX2NsazsKPiArICAgICAgIHN0cnVjdCBjbGsgKnBsbF9zcmNfY2xr
Owo+ICsgICAgICAgc3RydWN0IGNsayAqcGxsX3BoeV9yZWZfY2xrOwo+ICsKPiArICAgICAgIHZv
aWQgKCpkY3NzX2Rpc2FibGVfY2FsbGJhY2spKHZvaWQgKmRhdGEpOwo+ICsKPiArICAgICAgIGJv
b2wgY2xrc19vbjsKPiArICAgICAgIGJvb2wgaGRtaV9vdXRwdXQ7Cj4gK307Cj4gKwo+ICtlbnVt
IGRjc3NfY29sb3Jfc3BhY2Ugewo+ICsgICAgICAgRENTU19DT0xPUlNQQUNFX1JHQiwKPiArICAg
ICAgIERDU1NfQ09MT1JTUEFDRV9ZVVYsCj4gKyAgICAgICBEQ1NTX0NPTE9SU1BBQ0VfVU5LTk9X
TiwKPiArfTsKPiArCj4gK3N0cnVjdCBkY3NzX2RldiAqZGNzc19kcnZfZGV2X3RvX2Rjc3Moc3Ry
dWN0IGRldmljZSAqZGV2KTsKPiArc3RydWN0IGRybV9kZXZpY2UgKmRjc3NfZHJ2X2Rldl90b19k
cm0oc3RydWN0IGRldmljZSAqZGV2KTsKPiArc3RydWN0IGRjc3NfZGV2ICpkY3NzX2Rldl9jcmVh
dGUoc3RydWN0IGRldmljZSAqZGV2LCBib29sIG1pcGlfb3V0cHV0KTsKPiArdm9pZCBkY3NzX2Rl
dl9kZXN0cm95KHN0cnVjdCBkY3NzX2RldiAqZGNzcyk7Cj4gK2ludCBkY3NzX2Rldl9ydW50aW1l
X3N1c3BlbmQoc3RydWN0IGRldmljZSAqZGV2KTsKPiAraW50IGRjc3NfZGV2X3J1bnRpbWVfcmVz
dW1lKHN0cnVjdCBkZXZpY2UgKmRldik7Cj4gK2ludCBkY3NzX2Rldl9zdXNwZW5kKHN0cnVjdCBk
ZXZpY2UgKmRldik7Cj4gK2ludCBkY3NzX2Rldl9yZXN1bWUoc3RydWN0IGRldmljZSAqZGV2KTsK
PiArCj4gKy8qIEJMS0NUTCAqLwo+ICtpbnQgZGNzc19ibGtjdGxfaW5pdChzdHJ1Y3QgZGNzc19k
ZXYgKmRjc3MsIHVuc2lnbmVkIGxvbmcgYmxrY3RsX2Jhc2UpOwo+ICt2b2lkIGRjc3NfYmxrY3Rs
X2NmZyhzdHJ1Y3QgZGNzc19ibGtjdGwgKmJsa2N0bCk7Cj4gK3ZvaWQgZGNzc19ibGtjdGxfZXhp
dChzdHJ1Y3QgZGNzc19ibGtjdGwgKmJsa2N0bCk7Cj4gKwo+ICsvKiBDVFhMRCAqLwo+ICtpbnQg
ZGNzc19jdHhsZF9pbml0KHN0cnVjdCBkY3NzX2RldiAqZGNzcywgdW5zaWduZWQgbG9uZyBjdHhs
ZF9iYXNlKTsKPiArdm9pZCBkY3NzX2N0eGxkX2V4aXQoc3RydWN0IGRjc3NfY3R4bGQgKmN0eGxk
KTsKPiArdm9pZCBkY3NzX2N0eGxkX3dyaXRlKHN0cnVjdCBkY3NzX2N0eGxkICpjdHhsZCwgdTMy
IGN0eF9pZCwKPiArICAgICAgICAgICAgICAgICAgICAgdTMyIHZhbCwgdTMyIHJlZ19pZHgpOwo+
ICtpbnQgZGNzc19jdHhsZF9yZXN1bWUoc3RydWN0IGRjc3NfY3R4bGQgKmRjc3NfY3R4bGQpOwo+
ICtpbnQgZGNzc19jdHhsZF9zdXNwZW5kKHN0cnVjdCBkY3NzX2N0eGxkICpkY3NzX2N0eGxkKTsK
PiArdm9pZCBkY3NzX2N0eGxkX3dyaXRlX2lycXNhZmUoc3RydWN0IGRjc3NfY3R4bGQgKmN0bHhk
LCB1MzIgY3R4X2lkLCB1MzIgdmFsLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUz
MiByZWdfb2ZzKTsKPiArdm9pZCBkY3NzX2N0eGxkX2tpY2soc3RydWN0IGRjc3NfY3R4bGQgKmN0
eGxkKTsKPiArYm9vbCBkY3NzX2N0eGxkX2lzX2ZsdXNoZWQoc3RydWN0IGRjc3NfY3R4bGQgKmN0
eGxkKTsKPiAraW50IGRjc3NfY3R4bGRfZW5hYmxlKHN0cnVjdCBkY3NzX2N0eGxkICpjdHhsZCk7
Cj4gK3ZvaWQgZGNzc19jdHhsZF9yZWdpc3Rlcl9kdGdfZGlzYWJsZV9jYihzdHJ1Y3QgZGNzc19j
dHhsZCAqY3R4bGQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZv
aWQgKCpjYikodm9pZCAqKSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdm9pZCAqZGF0YSk7Cj4gKwo+ICsvKiBEUFIgKi8KPiArZW51bSBkY3NzX3RpbGVfdHlwZSB7
Cj4gKyAgICAgICBUSUxFX0xJTkVBUiA9IDAsCj4gKyAgICAgICBUSUxFX0dQVV9TVEFOREFSRCwK
PiArICAgICAgIFRJTEVfR1BVX1NVUEVSLAo+ICsgICAgICAgVElMRV9WUFVfWVVWNDIwLAo+ICsg
ICAgICAgVElMRV9WUFVfVlA5LAo+ICt9Owo+ICsKPiArZW51bSBkY3NzX3BpeF9zaXplIHsKPiAr
ICAgICAgIFBJWF9TSVpFXzgsCj4gKyAgICAgICBQSVhfU0laRV8xNiwKPiArICAgICAgIFBJWF9T
SVpFXzMyLAo+ICt9Owo+ICsKPiAraW50IGRjc3NfZHByX2luaXQoc3RydWN0IGRjc3NfZGV2ICpk
Y3NzLCB1bnNpZ25lZCBsb25nIGRwcl9iYXNlKTsKPiArdm9pZCBkY3NzX2Rwcl9leGl0KHN0cnVj
dCBkY3NzX2RwciAqZHByKTsKPiArdm9pZCBkY3NzX2Rwcl93cml0ZV9zeXNjdHJsKHN0cnVjdCBk
Y3NzX2RwciAqZHByKTsKPiArdm9pZCBkY3NzX2Rwcl9zZXRfcmVzKHN0cnVjdCBkY3NzX2RwciAq
ZHByLCBpbnQgY2hfbnVtLCB1MzIgeHJlcywgdTMyIHlyZXMpOwo+ICt2b2lkIGRjc3NfZHByX2Fk
ZHJfc2V0KHN0cnVjdCBkY3NzX2RwciAqZHByLCBpbnQgY2hfbnVtLCB1MzIgbHVtYV9iYXNlX2Fk
ZHIsCj4gKyAgICAgICAgICAgICAgICAgICAgICB1MzIgY2hyb21hX2Jhc2VfYWRkciwgdTE2IHBp
dGNoKTsKPiArdm9pZCBkY3NzX2Rwcl9lbmFibGUoc3RydWN0IGRjc3NfZHByICpkcHIsIGludCBj
aF9udW0sIGJvb2wgZW4pOwo+ICt2b2lkIGRjc3NfZHByX2Zvcm1hdF9zZXQoc3RydWN0IGRjc3Nf
ZHByICpkcHIsIGludCBjaF9udW0sCj4gKyAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0
cnVjdCBkcm1fZm9ybWF0X2luZm8gKmZvcm1hdCwgdTY0IG1vZGlmaWVyKTsKPiArdm9pZCBkY3Nz
X2Rwcl9zZXRfcm90YXRpb24oc3RydWN0IGRjc3NfZHByICpkcHIsIGludCBjaF9udW0sIHUzMiBy
b3RhdGlvbik7Cj4gKwo+ICsvKiBEVEcgKi8KPiAraW50IGRjc3NfZHRnX2luaXQoc3RydWN0IGRj
c3NfZGV2ICpkY3NzLCB1bnNpZ25lZCBsb25nIGR0Z19iYXNlKTsKPiArdm9pZCBkY3NzX2R0Z19l
eGl0KHN0cnVjdCBkY3NzX2R0ZyAqZHRnKTsKPiArYm9vbCBkY3NzX2R0Z192YmxhbmtfaXJxX3Zh
bGlkKHN0cnVjdCBkY3NzX2R0ZyAqZHRnKTsKPiArdm9pZCBkY3NzX2R0Z192YmxhbmtfaXJxX2Vu
YWJsZShzdHJ1Y3QgZGNzc19kdGcgKmR0ZywgYm9vbCBlbik7Cj4gK3ZvaWQgZGNzc19kdGdfdmJs
YW5rX2lycV9jbGVhcihzdHJ1Y3QgZGNzc19kdGcgKmR0Zyk7Cj4gK3ZvaWQgZGNzc19kdGdfc3lu
Y19zZXQoc3RydWN0IGRjc3NfZHRnICpkdGcsIHN0cnVjdCB2aWRlb21vZGUgKnZtKTsKPiArdm9p
ZCBkY3NzX2R0Z19jc3Nfc2V0KHN0cnVjdCBkY3NzX2R0ZyAqZHRnKTsKPiArdm9pZCBkY3NzX2R0
Z19lbmFibGUoc3RydWN0IGRjc3NfZHRnICpkdGcsIGJvb2wgZW4sCj4gKyAgICAgICAgICAgICAg
ICAgICAgc3RydWN0IGNvbXBsZXRpb24gKmRpc19jb21wbGV0aW9uKTsKPiArYm9vbCBkY3NzX2R0
Z19pc19lbmFibGVkKHN0cnVjdCBkY3NzX2R0ZyAqZHRnKTsKPiArdm9pZCBkY3NzX2R0Z19jdHhs
ZF9raWNrX2lycV9lbmFibGUoc3RydWN0IGRjc3NfZHRnICpkdGcsIGJvb2wgZW4pOwo+ICtib29s
IGRjc3NfZHRnX2dsb2JhbF9hbHBoYV9jaGFuZ2VkKHN0cnVjdCBkY3NzX2R0ZyAqZHRnLCBpbnQg
Y2hfbnVtLCBpbnQgYWxwaGEpOwo+ICt2b2lkIGRjc3NfZHRnX3BsYW5lX2FscGhhX3NldChzdHJ1
Y3QgZGNzc19kdGcgKmR0ZywgaW50IGNoX251bSwKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Zvcm1hdF9pbmZvICpmb3JtYXQsIGludCBhbHBoYSk7Cj4g
K3ZvaWQgZGNzc19kdGdfcGxhbmVfcG9zX3NldChzdHJ1Y3QgZGNzc19kdGcgKmR0ZywgaW50IGNo
X251bSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHB4LCBpbnQgcHksIGludCBw
dywgaW50IHBoKTsKPiArdm9pZCBkY3NzX2R0Z19jaF9lbmFibGUoc3RydWN0IGRjc3NfZHRnICpk
dGcsIGludCBjaF9udW0sIGJvb2wgZW4pOwo+ICsKPiArLyogU1VCU0FNICovCj4gK2ludCBkY3Nz
X3NzX2luaXQoc3RydWN0IGRjc3NfZGV2ICpkY3NzLCB1bnNpZ25lZCBsb25nIHN1YnNhbV9iYXNl
KTsKPiArdm9pZCBkY3NzX3NzX2V4aXQoc3RydWN0IGRjc3Nfc3MgKnNzKTsKPiArdm9pZCBkY3Nz
X3NzX2VuYWJsZShzdHJ1Y3QgZGNzc19zcyAqc3MpOwo+ICt2b2lkIGRjc3Nfc3NfZGlzYWJsZShz
dHJ1Y3QgZGNzc19zcyAqc3MpOwo+ICt2b2lkIGRjc3Nfc3Nfc3Vic2FtX3NldChzdHJ1Y3QgZGNz
c19zcyAqc3MpOwo+ICt2b2lkIGRjc3Nfc3Nfc3luY19zZXQoc3RydWN0IGRjc3Nfc3MgKnNzLCBz
dHJ1Y3QgdmlkZW9tb2RlICp2bSwKPiArICAgICAgICAgICAgICAgICAgICAgYm9vbCBwaHN5bmMs
IGJvb2wgcHZzeW5jKTsKPiArCj4gKy8qIFNDQUxFUiAqLwo+ICtpbnQgZGNzc19zY2FsZXJfaW5p
dChzdHJ1Y3QgZGNzc19kZXYgKmRjc3MsIHVuc2lnbmVkIGxvbmcgc2NhbGVyX2Jhc2UpOwo+ICt2
b2lkIGRjc3Nfc2NhbGVyX2V4aXQoc3RydWN0IGRjc3Nfc2NhbGVyICpzY2wpOwo+ICt2b2lkIGRj
c3Nfc2NhbGVyX3NldHVwKHN0cnVjdCBkY3NzX3NjYWxlciAqc2NsLCBpbnQgY2hfbnVtLAo+ICsg
ICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IGRybV9mb3JtYXRfaW5mbyAqZm9ybWF0
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgaW50IHNyY194cmVzLCBpbnQgc3JjX3lyZXMsIGlu
dCBkc3RfeHJlcywgaW50IGRzdF95cmVzLAo+ICsgICAgICAgICAgICAgICAgICAgICAgdTMyIHZy
ZWZyZXNoX2h6KTsKPiArdm9pZCBkY3NzX3NjYWxlcl9jaF9lbmFibGUoc3RydWN0IGRjc3Nfc2Nh
bGVyICpzY2wsIGludCBjaF9udW0sIGJvb2wgZW4pOwo+ICtpbnQgZGNzc19zY2FsZXJfZ2V0X21p
bl9tYXhfcmF0aW9zKHN0cnVjdCBkY3NzX3NjYWxlciAqc2NsLCBpbnQgY2hfbnVtLAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50ICptaW4sIGludCAqbWF4KTsKPiArdm9p
ZCBkY3NzX3NjYWxlcl93cml0ZV9zY2xjdHJsKHN0cnVjdCBkY3NzX3NjYWxlciAqc2NsKTsKPiAr
Cj4gKyNlbmRpZiAvKiBfX0RDU1NfUFJWX0hfXyAqLwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaW14L2Rjc3MvZGNzcy1kcHIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pbXgvZGNzcy9kY3Nz
LWRwci5jCj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRleCAwMDAwMDAwMC4uZGJjNzE2OQo+
IC0tLSAvZGV2L251bGwKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaW14L2Rjc3MvZGNzcy1kcHIu
Ywo+IEBAIC0wLDAgKzEsNTUyIEBACj4gKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwt
Mi4wCj4gKy8qCj4gKyAqIENvcHlyaWdodCAyMDE5IE5YUC4KPiArICovCj4gKwo+ICsjaW5jbHVk
ZSA8bGludXgvZGV2aWNlLmg+Cj4gKwo+ICsjaW5jbHVkZSAiZGNzcy1kZXYuaCIKPiArCj4gKyNk
ZWZpbmUgRENTU19EUFJfU1lTVEVNX0NUUkwwICAgICAgICAgICAgICAgICAgMHgwMDAKPiArI2Rl
ZmluZSAgIFJVTl9FTiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCSVQoMCkKPiArI2Rl
ZmluZSAgIFNPRlRfUkVTRVQgICAgICAgICAgICAgICAgICAgICAgICAgICBCSVQoMSkKPiArI2Rl
ZmluZSAgIFJFUEVBVF9FTiAgICAgICAgICAgICAgICAgICAgICAgICAgICBCSVQoMikKPiArI2Rl
ZmluZSAgIFNIQURPV19MT0FEX0VOICAgICAgICAgICAgICAgICAgICAgICBCSVQoMykKPiArI2Rl
ZmluZSAgIFNXX1NIQURPV19MT0FEX1NFTCAgICAgICAgICAgICAgICAgICBCSVQoNCkKPiArI2Rl
ZmluZSAgIEJDTUQyQVhJX01TVFJfSURfQ1RSTCAgICAgICAgICAgICAgICAgICAgICAgIEJJVCgx
NikKPiArI2RlZmluZSBEQ1NTX0RQUl9JUlFfTUFTSyAgICAgICAgICAgICAgICAgICAgICAweDAy
MAo+ICsjZGVmaW5lIERDU1NfRFBSX0lSUV9NQVNLX1NUQVRVUyAgICAgICAgICAgICAgIDB4MDMw
Cj4gKyNkZWZpbmUgRENTU19EUFJfSVJRX05PTk1BU0tfU1RBVFVTICAgICAgICAgICAgMHgwNDAK
PiArI2RlZmluZSAgIElSUV9EUFJfQ1RSTF9ET05FICAgICAgICAgICAgICAgICAgICBCSVQoMCkK
PiArI2RlZmluZSAgIElSUV9EUFJfUlVOICAgICAgICAgICAgICAgICAgICAgICAgICBCSVQoMSkK
PiArI2RlZmluZSAgIElSUV9EUFJfU0hBRE9XX0xPQURFRCAgICAgICAgICAgICAgICAgICAgICAg
IEJJVCgyKQo+ICsjZGVmaW5lICAgSVJRX0FYSV9SRUFEX0VSUiAgICAgICAgICAgICAgICAgICAg
IEJJVCgzKQo+ICsjZGVmaW5lICAgRFBSMlJUUl9ZUkdCX0ZJRk9fT1ZGTCAgICAgICAgICAgICAg
IEJJVCg0KQo+ICsjZGVmaW5lICAgRFBSMlJUUl9VVl9GSUZPX09WRkwgICAgICAgICAgICAgICAg
IEJJVCg1KQo+ICsjZGVmaW5lICAgRFBSMlJUUl9GSUZPX0xEX0JVRl9SRFlfWVJHQl9FUlIgICAg
IEJJVCg2KQo+ICsjZGVmaW5lICAgRFBSMlJUUl9GSUZPX0xEX0JVRl9SRFlfVVZfRVJSICAgICAg
IEJJVCg3KQo+ICsjZGVmaW5lIERDU1NfRFBSX01PREVfQ1RSTDAgICAgICAgICAgICAgICAgICAg
IDB4MDUwCj4gKyNkZWZpbmUgICBSVFJfM0JVRl9FTiAgICAgICAgICAgICAgICAgICAgICAgICAg
QklUKDApCj4gKyNkZWZpbmUgICBSVFJfNExJTkVfQlVGX0VOICAgICAgICAgICAgICAgICAgICAg
QklUKDEpCj4gKyNkZWZpbmUgICBUSUxFX1RZUEVfUE9TICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAyCj4gKyNkZWZpbmUgICBUSUxFX1RZUEVfTUFTSyAgICAgICAgICAgICAgICAgICAg
ICAgR0VOTUFTSyg0LCAyKQo+ICsjZGVmaW5lICAgWVVWX0VOICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIEJJVCg2KQo+ICsjZGVmaW5lICAgQ09NUF8yUExBTkVfRU4gICAgICAgICAgICAg
ICAgICAgICAgIEJJVCg3KQo+ICsjZGVmaW5lICAgUElYX1NJWkVfUE9TICAgICAgICAgICAgICAg
ICAgICAgICAgIDgKPiArI2RlZmluZSAgIFBJWF9TSVpFX01BU0sgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIEdFTk1BU0soOSwgOCkKPiArI2RlZmluZSAgIFBJWF9MVU1BX1VWX1NXQVAg
ICAgICAgICAgICAgICAgICAgICBCSVQoMTApCj4gKyNkZWZpbmUgICBQSVhfVVZfU1dBUCAgICAg
ICAgICAgICAgICAgICAgICAgICAgQklUKDExKQo+ICsjZGVmaW5lICAgQl9DT01QX1NFTF9QT1Mg
ICAgICAgICAgICAgICAgICAgICAgIDEyCj4gKyNkZWZpbmUgICBCX0NPTVBfU0VMX01BU0sgICAg
ICAgICAgICAgICAgICAgICAgR0VOTUFTSygxMywgMTIpCj4gKyNkZWZpbmUgICBHX0NPTVBfU0VM
X1BPUyAgICAgICAgICAgICAgICAgICAgICAgMTQKPiArI2RlZmluZSAgIEdfQ09NUF9TRUxfTUFT
SyAgICAgICAgICAgICAgICAgICAgICBHRU5NQVNLKDE1LCAxNCkKPiArI2RlZmluZSAgIFJfQ09N
UF9TRUxfUE9TICAgICAgICAgICAgICAgICAgICAgICAxNgo+ICsjZGVmaW5lICAgUl9DT01QX1NF
TF9NQVNLICAgICAgICAgICAgICAgICAgICAgIEdFTk1BU0soMTcsIDE2KQo+ICsjZGVmaW5lICAg
QV9DT01QX1NFTF9QT1MgICAgICAgICAgICAgICAgICAgICAgIDE4Cj4gKyNkZWZpbmUgICBBX0NP
TVBfU0VMX01BU0sgICAgICAgICAgICAgICAgICAgICAgR0VOTUFTSygxOSwgMTgpCj4gKyNkZWZp
bmUgRENTU19EUFJfRlJBTUVfQ1RSTDAgICAgICAgICAgICAgICAgICAgMHgwNzAKPiArI2RlZmlu
ZSAgIEhGTElQX0VOICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCSVQoMCkKPiArI2RlZmlu
ZSAgIFZGTElQX0VOICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCSVQoMSkKPiArI2RlZmlu
ZSAgIFJPVF9FTkNfUE9TICAgICAgICAgICAgICAgICAgICAgICAgICAyCj4gKyNkZWZpbmUgICBS
T1RfRU5DX01BU0sgICAgICAgICAgICAgICAgICAgICAgICAgR0VOTUFTSygzLCAyKQo+ICsjZGVm
aW5lICAgUk9UX0ZMSVBfT1JERVJfRU4gICAgICAgICAgICAgICAgICAgIEJJVCg0KQo+ICsjZGVm
aW5lICAgUElUQ0hfUE9TICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE2Cj4gKyNkZWZpbmUg
ICBQSVRDSF9NQVNLICAgICAgICAgICAgICAgICAgICAgICAgICAgR0VOTUFTSygzMSwgMTYpCj4g
KyNkZWZpbmUgRENTU19EUFJfRlJBTUVfMVBfQ1RSTDAgICAgICAgICAgICAgICAgICAgICAgICAw
eDA5MAo+ICsjZGVmaW5lIERDU1NfRFBSX0ZSQU1FXzFQX1BJWF9YX0NUUkwgICAgICAgICAgIDB4
MEEwCj4gKyNkZWZpbmUgRENTU19EUFJfRlJBTUVfMVBfUElYX1lfQ1RSTCAgICAgICAgICAgMHgw
QjAKPiArI2RlZmluZSBEQ1NTX0RQUl9GUkFNRV8xUF9CQVNFX0FERFIgICAgICAgICAgICAweDBD
MAo+ICsjZGVmaW5lIERDU1NfRFBSX0ZSQU1FXzJQX0NUUkwwICAgICAgICAgICAgICAgICAgICAg
ICAgMHgwRTAKPiArI2RlZmluZSBEQ1NTX0RQUl9GUkFNRV8yUF9QSVhfWF9DVFJMICAgICAgICAg
ICAweDBGMAo+ICsjZGVmaW5lIERDU1NfRFBSX0ZSQU1FXzJQX1BJWF9ZX0NUUkwgICAgICAgICAg
IDB4MTAwCj4gKyNkZWZpbmUgRENTU19EUFJfRlJBTUVfMlBfQkFTRV9BRERSICAgICAgICAgICAg
MHgxMTAKPiArI2RlZmluZSBEQ1NTX0RQUl9TVEFUVVNfQ1RSTDAgICAgICAgICAgICAgICAgICAw
eDEzMAo+ICsjZGVmaW5lICAgU1RBVFVTX01VWF9TRUxfTUFTSyAgICAgICAgICAgICAgICAgIEdF
Tk1BU0soMiwgMCkKPiArI2RlZmluZSAgIFNUQVRVU19TUkNfU0VMX1BPUyAgICAgICAgICAgICAg
ICAgICAxNgo+ICsjZGVmaW5lICAgU1RBVFVTX1NSQ19TRUxfTUFTSyAgICAgICAgICAgICAgICAg
IEdFTk1BU0soMTgsIDE2KQo+ICsjZGVmaW5lIERDU1NfRFBSX1NUQVRVU19DVFJMMSAgICAgICAg
ICAgICAgICAgIDB4MTQwCj4gKyNkZWZpbmUgRENTU19EUFJfUlRSQU1fQ1RSTDAgICAgICAgICAg
ICAgICAgICAgMHgyMDAKPiArI2RlZmluZSAgIE5VTV9ST1dTX0FDVElWRSAgICAgICAgICAgICAg
ICAgICAgICBCSVQoMCkKPiArI2RlZmluZSAgIFRIUkVTX0hJR0hfUE9TICAgICAgICAgICAgICAg
ICAgICAgICAxCj4gKyNkZWZpbmUgICBUSFJFU19ISUdIX01BU0sgICAgICAgICAgICAgICAgICAg
ICAgR0VOTUFTSygzLCAxKQo+ICsjZGVmaW5lICAgVEhSRVNfTE9XX1BPUyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgNAo+ICsjZGVmaW5lICAgVEhSRVNfTE9XX01BU0sgICAgICAgICAg
ICAgICAgICAgICAgIEdFTk1BU0soNiwgNCkKPiArI2RlZmluZSAgIEFCT1JUX1NFTCAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBCSVQoNykKPiArCj4gK3N0cnVjdCBkY3NzX2Rwcl9jaCB7Cj4g
KyAgICAgICBzdHJ1Y3QgZGNzc19kcHIgKmRwcjsKPiArICAgICAgIHZvaWQgX19pb21lbSAqYmFz
ZV9yZWc7Cj4gKyAgICAgICB1MzIgYmFzZV9vZnM7Cj4gKwo+ICsgICAgICAgc3RydWN0IGRybV9m
b3JtYXRfaW5mbyBmb3JtYXQ7Cj4gKyAgICAgICBlbnVtIGRjc3NfcGl4X3NpemUgcGl4X3NpemU7
Cj4gKyAgICAgICBlbnVtIGRjc3NfdGlsZV90eXBlIHRpbGU7Cj4gKyAgICAgICBib29sIHJ0cmFt
XzRsaW5lX2VuOwo+ICsgICAgICAgYm9vbCBydHJhbV8zYnVmX2VuOwo+ICsKPiArICAgICAgIHUz
MiBmcmFtZV9jdHJsOwo+ICsgICAgICAgdTMyIG1vZGVfY3RybDsKPiArICAgICAgIHUzMiBzeXNf
Y3RybDsKPiArICAgICAgIHUzMiBydHJhbV9jdHJsOwo+ICsKPiArICAgICAgIGJvb2wgc3lzX2N0
cmxfY2hnZDsKPiArCj4gKyAgICAgICB1MzIgcGl0Y2g7Cj4gKwo+ICsgICAgICAgaW50IGNoX251
bTsKPiArICAgICAgIGludCBpcnE7Cj4gK307Cj4gKwo+ICtzdHJ1Y3QgZGNzc19kcHIgewo+ICsg
ICAgICAgc3RydWN0IGRldmljZSAqZGV2Owo+ICsgICAgICAgc3RydWN0IGRjc3NfY3R4bGQgKmN0
eGxkOwo+ICsgICAgICAgdTMyICBjdHhfaWQ7Cj4gKwo+ICsgICAgICAgc3RydWN0IGRjc3NfZHBy
X2NoIGNoWzNdOwo+ICt9Owo+ICsKPiArc3RhdGljIHZvaWQgZGNzc19kcHJfd3JpdGUoc3RydWN0
IGRjc3NfZHByX2NoICpjaCwgdTMyIHZhbCwgdTMyIG9mcykKPiArewo+ICsgICAgICAgc3RydWN0
IGRjc3NfZHByICpkcHIgPSBjaC0+ZHByOwo+ICsKPiArICAgICAgIGRjc3NfY3R4bGRfd3JpdGUo
ZHByLT5jdHhsZCwgZHByLT5jdHhfaWQsIHZhbCwgY2gtPmJhc2Vfb2ZzICsgb2ZzKTsKPiArfQo+
ICsKPiArc3RhdGljIGludCBkY3NzX2Rwcl9jaF9pbml0X2FsbChzdHJ1Y3QgZGNzc19kcHIgKmRw
ciwgdW5zaWduZWQgbG9uZyBkcHJfYmFzZSkKPiArewo+ICsgICAgICAgc3RydWN0IGRjc3NfZHBy
X2NoICpjaDsKPiArICAgICAgIGludCBpOwo+ICsKPiArICAgICAgIGZvciAoaSA9IDA7IGkgPCAz
OyBpKyspIHsKPiArICAgICAgICAgICAgICAgY2ggPSAmZHByLT5jaFtpXTsKPiArCj4gKyAgICAg
ICAgICAgICAgIGNoLT5iYXNlX29mcyA9IGRwcl9iYXNlICsgaSAqIDB4MTAwMDsKClNhbWUgd2l0
aCBpLk1YOFFNICYgaS5NWDhRWFAsIGV2ZXJ5IERQUiBpbnN0YW5jZSBoYXMgdGhyZWUgY2hhbm5l
bHMuCkVhY2ggY2hhbm5lbCBoYXMgaXQncyBvd24gcmVnaXN0ZXIgc3BhY2UuCkZvciBpLk1YOFFN
ICYgaS5NWDhRWFAgU29DcywgdGhlIGNvbm5lY3Rpb24gYmV0d2VlbiBEUFIgY2hhbm5lbAphbmQg
UFJHKHMpIGNhbiBiZSByZWZsZWN0ZWQgaW4gZGV2aWNlIHRyZWUuICBTbywgaXQgd291bGQgYmUg
Z29vZCBpZiB0aGUKRFBSIGRyaXZlciB3cmFwcyBvbmUgc2luZ2xlIERQUiBjaGFubmVsIG9ubHku
CgpSZWdhcmRzLApMaXUgWWluZwoKPiArCj4gKyAgICAgICAgICAgICAgIGNoLT5iYXNlX3JlZyA9
IGRldm1faW9yZW1hcChkcHItPmRldiwgY2gtPmJhc2Vfb2ZzLCBTWl80Syk7Cj4gKyAgICAgICAg
ICAgICAgIGlmICghY2gtPmJhc2VfcmVnKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgZGV2
X2VycihkcHItPmRldiwgImRwcjogdW5hYmxlIHRvIHJlbWFwIGNoICVkIGJhc2VcbiIsCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpKTsKPiArICAgICAgICAgICAgICAgICAgICAg
ICByZXR1cm4gLUVOT01FTTsKPiArICAgICAgICAgICAgICAgfQo+ICsKPiArICAgICAgICAgICAg
ICAgY2gtPmRwciA9IGRwcjsKPiArICAgICAgICAgICAgICAgY2gtPmNoX251bSA9IGk7Cj4gKyAg
ICAgICB9Cj4gKwo+ICsgICAgICAgcmV0dXJuIDA7Cj4gK30KPiArCj4gK2ludCBkY3NzX2Rwcl9p
bml0KHN0cnVjdCBkY3NzX2RldiAqZGNzcywgdW5zaWduZWQgbG9uZyBkcHJfYmFzZSkKPiArewo+
ICsgICAgICAgc3RydWN0IGRjc3NfZHByICpkcHI7Cj4gKwo+ICsgICAgICAgZHByID0gZGV2bV9r
emFsbG9jKGRjc3MtPmRldiwgc2l6ZW9mKHN0cnVjdCBkY3NzX2RwciksIEdGUF9LRVJORUwpOwo+
ICsgICAgICAgaWYgKCFkcHIpCj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwo+ICsK
PiArICAgICAgIGRjc3MtPmRwciA9IGRwcjsKPiArICAgICAgIGRwci0+ZGV2ID0gZGNzcy0+ZGV2
Owo+ICsgICAgICAgZHByLT5jdHhsZCA9IGRjc3MtPmN0eGxkOwo+ICsgICAgICAgZHByLT5jdHhf
aWQgPSBDVFhfU0JfSFA7Cj4gKwo+ICsgICAgICAgaWYgKGRjc3NfZHByX2NoX2luaXRfYWxsKGRw
ciwgZHByX2Jhc2UpKSB7Cj4gKyAgICAgICAgICAgICAgIGludCBpOwo+ICsKPiArICAgICAgICAg
ICAgICAgZm9yIChpID0gMDsgaSA8IDM7IGkrKykgewo+ICsgICAgICAgICAgICAgICAgICAgICAg
IGlmIChkcHItPmNoW2ldLmJhc2VfcmVnKQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZGV2bV9pb3VubWFwKGRwci0+ZGV2LCBkcHItPmNoW2ldLmJhc2VfcmVnKTsKPiArICAgICAg
ICAgICAgICAgfQo+ICsKPiArICAgICAgICAgICAgICAgZGV2bV9rZnJlZShkcHItPmRldiwgZHBy
KTsKPiArCj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwo+ICsgICAgICAgfQo+ICsK
PiArICAgICAgIHJldHVybiAwOwo+ICt9Cj4gKwo+ICt2b2lkIGRjc3NfZHByX2V4aXQoc3RydWN0
IGRjc3NfZHByICpkcHIpCj4gK3sKPiArICAgICAgIGludCBjaF9ubzsKPiArCj4gKyAgICAgICAv
KiBzdG9wIERQUiBvbiBhbGwgY2hhbm5lbHMgKi8KPiArICAgICAgIGZvciAoY2hfbm8gPSAwOyBj
aF9ubyA8IDM7IGNoX25vKyspIHsKPiArICAgICAgICAgICAgICAgc3RydWN0IGRjc3NfZHByX2No
ICpjaCA9ICZkcHItPmNoW2NoX25vXTsKPiArCj4gKyAgICAgICAgICAgICAgIGRjc3Nfd3JpdGVs
KDAsIGNoLT5iYXNlX3JlZyArIERDU1NfRFBSX1NZU1RFTV9DVFJMMCk7Cj4gKwo+ICsgICAgICAg
ICAgICAgICBpZiAoY2gtPmJhc2VfcmVnKQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGRldm1f
aW91bm1hcChkcHItPmRldiwgY2gtPmJhc2VfcmVnKTsKPiArICAgICAgIH0KPiArCj4gKyAgICAg
ICBkZXZtX2tmcmVlKGRwci0+ZGV2LCBkcHIpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdTMyIGRjc3Nf
ZHByX3hfcGl4X3dpZGVfYWRqdXN0KHN0cnVjdCBkY3NzX2Rwcl9jaCAqY2gsIHUzMiBwaXhfd2lk
ZSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUzMiBwaXhfZm9ybWF0
KQo+ICt7Cj4gKyAgICAgICB1OCBwaXhfaW5fNjRieXRlX21hcFszXVs1XSA9IHsKPiArICAgICAg
ICAgICAgICAgLyogTElOLCBHUFVfU1RELCBHUFVfU1VQLCBWUFVfWVVWNDIwLCBWUFVfVlA5ICov
Cj4gKyAgICAgICAgICAgICAgIHsgICA2NCwgICAgICAgOCwgICAgICAgOCwgICAgICAgICAgOCwg
ICAgIDE2fSwgLyogUElYX1NJWkVfOCAgKi8KPiArICAgICAgICAgICAgICAgeyAgIDMyLCAgICAg
ICA4LCAgICAgICA4LCAgICAgICAgICA4LCAgICAgIDh9LCAvKiBQSVhfU0laRV8xNiAqLwo+ICsg
ICAgICAgICAgICAgICB7ICAgMTYsICAgICAgIDQsICAgICAgIDQsICAgICAgICAgIDgsICAgICAg
OH0sIC8qIFBJWF9TSVpFXzMyICovCj4gKyAgICAgICB9Owo+ICsgICAgICAgdTMyIG9mZnNldDsK
PiArICAgICAgIHUzMiBkaXZfNjRieXRlX21vZCwgcGl4X2luXzY0Ynl0ZTsKPiArCj4gKyAgICAg
ICBwaXhfaW5fNjRieXRlID0gcGl4X2luXzY0Ynl0ZV9tYXBbY2gtPnBpeF9zaXplXVtjaC0+dGls
ZV07Cj4gKwo+ICsgICAgICAgaWYgKHBpeF9mb3JtYXQgPT0gRFJNX0ZPUk1BVF9QMDEwKQo+ICsg
ICAgICAgICAgICAgICBwaXhfd2lkZSA9IHBpeF93aWRlICogMTAgLyA4Owo+ICsKPiArICAgICAg
IGRpdl82NGJ5dGVfbW9kID0gcGl4X3dpZGUgJSBwaXhfaW5fNjRieXRlOwo+ICsgICAgICAgb2Zm
c2V0ID0gKGRpdl82NGJ5dGVfbW9kID09IDApID8gMCA6IChwaXhfaW5fNjRieXRlIC0gZGl2XzY0
Ynl0ZV9tb2QpOwo+ICsKPiArICAgICAgIHJldHVybiBwaXhfd2lkZSArIG9mZnNldDsKPiArfQo+
ICsKPiArc3RhdGljIHUzMiBkY3NzX2Rwcl95X3BpeF9oaWdoX2FkanVzdChzdHJ1Y3QgZGNzc19k
cHJfY2ggKmNoLCB1MzIgcGl4X2hpZ2gsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB1MzIgcGl4X2Zvcm1hdCkKPiArewo+ICsgICAgICAgdTggbnVtX3Jvd3NfYnVmID0g
Y2gtPnJ0cmFtXzRsaW5lX2VuID8gNCA6IDg7Cj4gKyAgICAgICB1MzIgb2Zmc2V0LCBwaXhfeV9t
b2Q7Cj4gKwo+ICsgICAgICAgcGl4X3lfbW9kID0gcGl4X2hpZ2ggJSBudW1fcm93c19idWY7Cj4g
KyAgICAgICBvZmZzZXQgPSBwaXhfeV9tb2QgPyAobnVtX3Jvd3NfYnVmIC0gcGl4X3lfbW9kKSA6
IDA7Cj4gKwo+ICsgICAgICAgcmV0dXJuIHBpeF9oaWdoICsgb2Zmc2V0Owo+ICt9Cj4gKwo+ICt2
b2lkIGRjc3NfZHByX3NldF9yZXMoc3RydWN0IGRjc3NfZHByICpkcHIsIGludCBjaF9udW0sIHUz
MiB4cmVzLCB1MzIgeXJlcykKPiArewo+ICsgICAgICAgc3RydWN0IGRjc3NfZHByX2NoICpjaCA9
ICZkcHItPmNoW2NoX251bV07Cj4gKyAgICAgICB1MzIgcGl4X2Zvcm1hdCA9IGNoLT5mb3JtYXQu
Zm9ybWF0Owo+ICsgICAgICAgdTMyIGdhcCA9IERDU1NfRFBSX0ZSQU1FXzJQX0JBU0VfQUREUiAt
IERDU1NfRFBSX0ZSQU1FXzFQX0JBU0VfQUREUjsKPiArICAgICAgIGludCBwbGFuZSwgbWF4X3Bs
YW5lcyA9IDE7Cj4gKyAgICAgICB1MzIgcGl4X3hfd2lkZSwgcGl4X3lfaGlnaDsKPiArCj4gKyAg
ICAgICBpZiAocGl4X2Zvcm1hdCA9PSBEUk1fRk9STUFUX05WMTIgfHwKPiArICAgICAgICAgICBw
aXhfZm9ybWF0ID09IERSTV9GT1JNQVRfTlYyMSkKPiArICAgICAgICAgICAgICAgbWF4X3BsYW5l
cyA9IDI7Cj4gKwo+ICsgICAgICAgZm9yIChwbGFuZSA9IDA7IHBsYW5lIDwgbWF4X3BsYW5lczsg
cGxhbmUrKykgewo+ICsgICAgICAgICAgICAgICB5cmVzID0gcGxhbmUgPT0gMSA/IHlyZXMgPj4g
MSA6IHlyZXM7Cj4gKwo+ICsgICAgICAgICAgICAgICBwaXhfeF93aWRlID0gZGNzc19kcHJfeF9w
aXhfd2lkZV9hZGp1c3QoY2gsIHhyZXMsIHBpeF9mb3JtYXQpOwo+ICsgICAgICAgICAgICAgICBw
aXhfeV9oaWdoID0gZGNzc19kcHJfeV9waXhfaGlnaF9hZGp1c3QoY2gsIHlyZXMsIHBpeF9mb3Jt
YXQpOwo+ICsKPiArICAgICAgICAgICAgICAgaWYgKHBsYW5lID09IDApCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgY2gtPnBpdGNoID0gcGl4X3hfd2lkZTsKPiArCj4gKyAgICAgICAgICAgICAg
IGRjc3NfZHByX3dyaXRlKGNoLCBwaXhfeF93aWRlLAo+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBEQ1NTX0RQUl9GUkFNRV8xUF9QSVhfWF9DVFJMICsgcGxhbmUgKiBnYXApOwo+ICsg
ICAgICAgICAgICAgICBkY3NzX2Rwcl93cml0ZShjaCwgcGl4X3lfaGlnaCwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgRENTU19EUFJfRlJBTUVfMVBfUElYX1lfQ1RSTCArIHBsYW5l
ICogZ2FwKTsKPiArCj4gKyAgICAgICAgICAgICAgIGRjc3NfZHByX3dyaXRlKGNoLCAyLCBEQ1NT
X0RQUl9GUkFNRV8xUF9DVFJMMCArIHBsYW5lICogZ2FwKTsKPiArICAgICAgIH0KPiArfQo+ICsK
PiArdm9pZCBkY3NzX2Rwcl9hZGRyX3NldChzdHJ1Y3QgZGNzc19kcHIgKmRwciwgaW50IGNoX251
bSwgdTMyIGx1bWFfYmFzZV9hZGRyLAo+ICsgICAgICAgICAgICAgICAgICAgICAgdTMyIGNocm9t
YV9iYXNlX2FkZHIsIHUxNiBwaXRjaCkKPiArewo+ICsgICAgICAgc3RydWN0IGRjc3NfZHByX2No
ICpjaCA9ICZkcHItPmNoW2NoX251bV07Cj4gKwo+ICsgICAgICAgZGNzc19kcHJfd3JpdGUoY2gs
IGx1bWFfYmFzZV9hZGRyLCBEQ1NTX0RQUl9GUkFNRV8xUF9CQVNFX0FERFIpOwo+ICsKPiArICAg
ICAgIGRjc3NfZHByX3dyaXRlKGNoLCBjaHJvbWFfYmFzZV9hZGRyLCBEQ1NTX0RQUl9GUkFNRV8y
UF9CQVNFX0FERFIpOwo+ICsKPiArICAgICAgIGNoLT5mcmFtZV9jdHJsICY9IH5QSVRDSF9NQVNL
Owo+ICsgICAgICAgY2gtPmZyYW1lX2N0cmwgfD0gKCgodTMyKXBpdGNoIDw8IFBJVENIX1BPUykg
JiBQSVRDSF9NQVNLKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgZGNzc19kcHJfYXJnYl9jb21w
X3NlbChzdHJ1Y3QgZGNzc19kcHJfY2ggKmNoLCBpbnQgYV9zZWwsIGludCByX3NlbCwKPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBnX3NlbCwgaW50IGJfc2VsKQo+ICt7
Cj4gKyAgICAgICB1MzIgc2VsOwo+ICsKPiArICAgICAgIHNlbCA9ICgoYV9zZWwgPDwgQV9DT01Q
X1NFTF9QT1MpICYgQV9DT01QX1NFTF9NQVNLKSB8Cj4gKyAgICAgICAgICAgICAoKHJfc2VsIDw8
IFJfQ09NUF9TRUxfUE9TKSAmIFJfQ09NUF9TRUxfTUFTSykgfAo+ICsgICAgICAgICAgICAgKChn
X3NlbCA8PCBHX0NPTVBfU0VMX1BPUykgJiBHX0NPTVBfU0VMX01BU0spIHwKPiArICAgICAgICAg
ICAgICgoYl9zZWwgPDwgQl9DT01QX1NFTF9QT1MpICYgQl9DT01QX1NFTF9NQVNLKTsKPiArCj4g
KyAgICAgICBjaC0+bW9kZV9jdHJsICY9IH4oQV9DT01QX1NFTF9NQVNLIHwgUl9DT01QX1NFTF9N
QVNLIHwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICBHX0NPTVBfU0VMX01BU0sgfCBCX0NP
TVBfU0VMX01BU0spOwo+ICsgICAgICAgY2gtPm1vZGVfY3RybCB8PSBzZWw7Cj4gK30KPiArCj4g
K3N0YXRpYyB2b2lkIGRjc3NfZHByX3BpeF9zaXplX3NldChzdHJ1Y3QgZGNzc19kcHJfY2ggKmNo
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Zv
cm1hdF9pbmZvICpmb3JtYXQpCj4gK3sKPiArICAgICAgIHUzMiB2YWw7Cj4gKwo+ICsgICAgICAg
c3dpdGNoIChmb3JtYXQtPmZvcm1hdCkgewo+ICsgICAgICAgY2FzZSBEUk1fRk9STUFUX05WMTI6
Cj4gKyAgICAgICBjYXNlIERSTV9GT1JNQVRfTlYyMToKPiArICAgICAgICAgICAgICAgdmFsID0g
MDsKPiArICAgICAgICAgICAgICAgYnJlYWs7Cj4gKwo+ICsgICAgICAgY2FzZSBEUk1fRk9STUFU
X1VZVlk6Cj4gKyAgICAgICBjYXNlIERSTV9GT1JNQVRfVllVWToKPiArICAgICAgIGNhc2UgRFJN
X0ZPUk1BVF9ZVVlWOgo+ICsgICAgICAgY2FzZSBEUk1fRk9STUFUX1lWWVU6Cj4gKyAgICAgICAg
ICAgICAgIHZhbCA9IDE7Cj4gKyAgICAgICAgICAgICAgIGJyZWFrOwo+ICsKPiArICAgICAgIGRl
ZmF1bHQ6Cj4gKyAgICAgICAgICAgICAgIHZhbCA9IDI7Cj4gKyAgICAgICAgICAgICAgIGJyZWFr
Owo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGNoLT5waXhfc2l6ZSA9IHZhbDsKPiArCj4gKyAg
ICAgICBjaC0+bW9kZV9jdHJsICY9IH5QSVhfU0laRV9NQVNLOwo+ICsgICAgICAgY2gtPm1vZGVf
Y3RybCB8PSAoKHZhbCA8PCBQSVhfU0laRV9QT1MpICYgUElYX1NJWkVfTUFTSyk7Cj4gK30KPiAr
Cj4gK3N0YXRpYyB2b2lkIGRjc3NfZHByX3V2X3N3YXAoc3RydWN0IGRjc3NfZHByX2NoICpjaCwg
Ym9vbCBzd2FwKQo+ICt7Cj4gKyAgICAgICBjaC0+bW9kZV9jdHJsICY9IH5QSVhfVVZfU1dBUDsK
PiArICAgICAgIGNoLT5tb2RlX2N0cmwgfD0gKHN3YXAgPyBQSVhfVVZfU1dBUCA6IDApOwo+ICt9
Cj4gKwo+ICtzdGF0aWMgdm9pZCBkY3NzX2Rwcl95X3V2X3N3YXAoc3RydWN0IGRjc3NfZHByX2No
ICpjaCwgYm9vbCBzd2FwKQo+ICt7Cj4gKyAgICAgICBjaC0+bW9kZV9jdHJsICY9IH5QSVhfTFVN
QV9VVl9TV0FQOwo+ICsgICAgICAgY2gtPm1vZGVfY3RybCB8PSAoc3dhcCA/IFBJWF9MVU1BX1VW
X1NXQVAgOiAwKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgZGNzc19kcHJfMnBsYW5lX2VuKHN0
cnVjdCBkY3NzX2Rwcl9jaCAqY2gsIGJvb2wgZW4pCj4gK3sKPiArICAgICAgIGNoLT5tb2RlX2N0
cmwgJj0gfkNPTVBfMlBMQU5FX0VOOwo+ICsgICAgICAgY2gtPm1vZGVfY3RybCB8PSAoZW4gPyBD
T01QXzJQTEFORV9FTiA6IDApOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBkY3NzX2Rwcl95dXZf
ZW4oc3RydWN0IGRjc3NfZHByX2NoICpjaCwgYm9vbCBlbikKPiArewo+ICsgICAgICAgY2gtPm1v
ZGVfY3RybCAmPSB+WVVWX0VOOwo+ICsgICAgICAgY2gtPm1vZGVfY3RybCB8PSAoZW4gPyBZVVZf
RU4gOiAwKTsKPiArfQo+ICsKPiArdm9pZCBkY3NzX2Rwcl9lbmFibGUoc3RydWN0IGRjc3NfZHBy
ICpkcHIsIGludCBjaF9udW0sIGJvb2wgZW4pCj4gK3sKPiArICAgICAgIHN0cnVjdCBkY3NzX2Rw
cl9jaCAqY2ggPSAmZHByLT5jaFtjaF9udW1dOwo+ICsgICAgICAgdTMyIHN5c19jdHJsOwo+ICsK
PiArICAgICAgIHN5c19jdHJsID0gKGVuID8gUkVQRUFUX0VOIHwgUlVOX0VOIDogMCk7Cj4gKwo+
ICsgICAgICAgaWYgKGVuKSB7Cj4gKyAgICAgICAgICAgICAgIGRjc3NfZHByX3dyaXRlKGNoLCBj
aC0+bW9kZV9jdHJsLCBEQ1NTX0RQUl9NT0RFX0NUUkwwKTsKPiArICAgICAgICAgICAgICAgZGNz
c19kcHJfd3JpdGUoY2gsIGNoLT5mcmFtZV9jdHJsLCBEQ1NTX0RQUl9GUkFNRV9DVFJMMCk7Cj4g
KyAgICAgICAgICAgICAgIGRjc3NfZHByX3dyaXRlKGNoLCBjaC0+cnRyYW1fY3RybCwgRENTU19E
UFJfUlRSQU1fQ1RSTDApOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGlmIChjaC0+c3lzX2N0
cmwgIT0gc3lzX2N0cmwpCj4gKyAgICAgICAgICAgICAgIGNoLT5zeXNfY3RybF9jaGdkID0gdHJ1
ZTsKPiArCj4gKyAgICAgICBjaC0+c3lzX2N0cmwgPSBzeXNfY3RybDsKPiArfQo+ICsKPiArc3Ry
dWN0IHJnYl9jb21wX3NlbCB7Cj4gKyAgICAgICB1MzIgZHJtX2Zvcm1hdDsKPiArICAgICAgIGlu
dCBhX3NlbDsKPiArICAgICAgIGludCByX3NlbDsKPiArICAgICAgIGludCBnX3NlbDsKPiArICAg
ICAgIGludCBiX3NlbDsKPiArfTsKPiArCj4gK3N0YXRpYyBzdHJ1Y3QgcmdiX2NvbXBfc2VsIGNv
bXBfc2VsX21hcFtdID0gewo+ICsgICAgICAge0RSTV9GT1JNQVRfQVJHQjg4ODgsIDMsIDIsIDEs
IDB9LAo+ICsgICAgICAge0RSTV9GT1JNQVRfWFJHQjg4ODgsIDMsIDIsIDEsIDB9LAo+ICsgICAg
ICAge0RSTV9GT1JNQVRfQUJHUjg4ODgsIDMsIDAsIDEsIDJ9LAo+ICsgICAgICAge0RSTV9GT1JN
QVRfWEJHUjg4ODgsIDMsIDAsIDEsIDJ9LAo+ICsgICAgICAge0RSTV9GT1JNQVRfUkdCQTg4ODgs
IDAsIDMsIDIsIDF9LAo+ICsgICAgICAge0RSTV9GT1JNQVRfUkdCWDg4ODgsIDAsIDMsIDIsIDF9
LAo+ICsgICAgICAge0RSTV9GT1JNQVRfQkdSQTg4ODgsIDAsIDEsIDIsIDN9LAo+ICsgICAgICAg
e0RSTV9GT1JNQVRfQkdSWDg4ODgsIDAsIDEsIDIsIDN9LAo+ICt9Owo+ICsKPiArc3RhdGljIGlu
dCB0b19jb21wX3NlbCh1MzIgcGl4X2ZtdCwgaW50ICphX3NlbCwgaW50ICpyX3NlbCwgaW50ICpn
X3NlbCwKPiArICAgICAgICAgICAgICAgICAgICAgIGludCAqYl9zZWwpCj4gK3sKPiArICAgICAg
IGludCBpOwo+ICsKPiArICAgICAgIGZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGNvbXBfc2Vs
X21hcCk7IGkrKykgewo+ICsgICAgICAgICAgICAgICBpZiAoY29tcF9zZWxfbWFwW2ldLmRybV9m
b3JtYXQgPT0gcGl4X2ZtdCkgewo+ICsgICAgICAgICAgICAgICAgICAgICAgICphX3NlbCA9IGNv
bXBfc2VsX21hcFtpXS5hX3NlbDsKPiArICAgICAgICAgICAgICAgICAgICAgICAqcl9zZWwgPSBj
b21wX3NlbF9tYXBbaV0ucl9zZWw7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgKmdfc2VsID0g
Y29tcF9zZWxfbWFwW2ldLmdfc2VsOwo+ICsgICAgICAgICAgICAgICAgICAgICAgICpiX3NlbCA9
IGNvbXBfc2VsX21hcFtpXS5iX3NlbDsKPiArCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0
dXJuIDA7Cj4gKyAgICAgICAgICAgICAgIH0KPiArICAgICAgIH0KPiArCj4gKyAgICAgICByZXR1
cm4gLTE7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGRjc3NfZHByX3J0cmFtX3NldChzdHJ1Y3Qg
ZGNzc19kcHJfY2ggKmNoLCB1MzIgcGl4X2Zvcm1hdCkKPiArewo+ICsgICAgICAgdTMyIHZhbCwg
bWFzazsKPiArCj4gKyAgICAgICBzd2l0Y2ggKHBpeF9mb3JtYXQpIHsKPiArICAgICAgIGNhc2Ug
RFJNX0ZPUk1BVF9OVjIxOgo+ICsgICAgICAgY2FzZSBEUk1fRk9STUFUX05WMTI6Cj4gKyAgICAg
ICBjYXNlIERSTV9GT1JNQVRfUDAxMDoKPiArICAgICAgICAgICAgICAgY2gtPnJ0cmFtXzNidWZf
ZW4gPSB0cnVlOwo+ICsgICAgICAgICAgICAgICBjaC0+cnRyYW1fNGxpbmVfZW4gPSBmYWxzZTsK
PiArICAgICAgICAgICAgICAgYnJlYWs7Cj4gKwo+ICsgICAgICAgZGVmYXVsdDoKPiArICAgICAg
ICAgICAgICAgY2gtPnJ0cmFtXzNidWZfZW4gPSB0cnVlOwo+ICsgICAgICAgICAgICAgICBjaC0+
cnRyYW1fNGxpbmVfZW4gPSB0cnVlOwo+ICsgICAgICAgICAgICAgICBicmVhazsKPiArICAgICAg
IH0KPiArCj4gKyAgICAgICB2YWwgPSAoY2gtPnJ0cmFtXzRsaW5lX2VuID8gUlRSXzRMSU5FX0JV
Rl9FTiA6IDApOwo+ICsgICAgICAgdmFsIHw9IChjaC0+cnRyYW1fM2J1Zl9lbiA/IFJUUl8zQlVG
X0VOIDogMCk7Cj4gKyAgICAgICBtYXNrID0gUlRSXzRMSU5FX0JVRl9FTiB8IFJUUl8zQlVGX0VO
Owo+ICsKPiArICAgICAgIGNoLT5tb2RlX2N0cmwgJj0gfm1hc2s7Cj4gKyAgICAgICBjaC0+bW9k
ZV9jdHJsIHw9ICh2YWwgJiBtYXNrKTsKPiArCj4gKyAgICAgICB2YWwgPSAoY2gtPnJ0cmFtXzRs
aW5lX2VuID8gMCA6IE5VTV9ST1dTX0FDVElWRSk7Cj4gKyAgICAgICB2YWwgfD0gKDMgPDwgVEhS
RVNfTE9XX1BPUykgJiBUSFJFU19MT1dfTUFTSzsKPiArICAgICAgIHZhbCB8PSAoNCA8PCBUSFJF
U19ISUdIX1BPUykgJiBUSFJFU19ISUdIX01BU0s7Cj4gKyAgICAgICBtYXNrID0gVEhSRVNfTE9X
X01BU0sgfCBUSFJFU19ISUdIX01BU0sgfCBOVU1fUk9XU19BQ1RJVkU7Cj4gKwo+ICsgICAgICAg
Y2gtPnJ0cmFtX2N0cmwgJj0gfm1hc2s7Cj4gKyAgICAgICBjaC0+cnRyYW1fY3RybCB8PSAodmFs
ICYgbWFzayk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGRjc3NfZHByX3NldHVwX2NvbXBvbmVu
dHMoc3RydWN0IGRjc3NfZHByX2NoICpjaCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGNvbnN0IHN0cnVjdCBkcm1fZm9ybWF0X2luZm8gKmZvcm1hdCkKPiArewo+ICsg
ICAgICAgaW50IGFfc2VsLCByX3NlbCwgZ19zZWwsIGJfc2VsOwo+ICsgICAgICAgYm9vbCB1dl9z
d2FwLCB5X3V2X3N3YXA7Cj4gKwo+ICsgICAgICAgc3dpdGNoIChmb3JtYXQtPmZvcm1hdCkgewo+
ICsgICAgICAgY2FzZSBEUk1fRk9STUFUX1lWWVU6Cj4gKyAgICAgICAgICAgICAgIHV2X3N3YXAg
PSB0cnVlOwo+ICsgICAgICAgICAgICAgICB5X3V2X3N3YXAgPSB0cnVlOwo+ICsgICAgICAgICAg
ICAgICBicmVhazsKPiArCj4gKyAgICAgICBjYXNlIERSTV9GT1JNQVRfVllVWToKPiArICAgICAg
IGNhc2UgRFJNX0ZPUk1BVF9OVjIxOgo+ICsgICAgICAgICAgICAgICB1dl9zd2FwID0gdHJ1ZTsK
PiArICAgICAgICAgICAgICAgeV91dl9zd2FwID0gZmFsc2U7Cj4gKyAgICAgICAgICAgICAgIGJy
ZWFrOwo+ICsKPiArICAgICAgIGNhc2UgRFJNX0ZPUk1BVF9ZVVlWOgo+ICsgICAgICAgICAgICAg
ICB1dl9zd2FwID0gZmFsc2U7Cj4gKyAgICAgICAgICAgICAgIHlfdXZfc3dhcCA9IHRydWU7Cj4g
KyAgICAgICAgICAgICAgIGJyZWFrOwo+ICsKPiArICAgICAgIGRlZmF1bHQ6Cj4gKyAgICAgICAg
ICAgICAgIHV2X3N3YXAgPSBmYWxzZTsKPiArICAgICAgICAgICAgICAgeV91dl9zd2FwID0gZmFs
c2U7Cj4gKyAgICAgICAgICAgICAgIGJyZWFrOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGRj
c3NfZHByX3V2X3N3YXAoY2gsIHV2X3N3YXApOwo+ICsKPiArICAgICAgIGRjc3NfZHByX3lfdXZf
c3dhcChjaCwgeV91dl9zd2FwKTsKPiArCj4gKyAgICAgICBpZiAoIWZvcm1hdC0+aXNfeXV2KSB7
Cj4gKyAgICAgICAgICAgICAgIGlmICghdG9fY29tcF9zZWwoZm9ybWF0LT5mb3JtYXQsICZhX3Nl
bCwgJnJfc2VsLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZnX3NlbCwgJmJf
c2VsKSkgewo+ICsgICAgICAgICAgICAgICAgICAgICAgIGRjc3NfZHByX2FyZ2JfY29tcF9zZWwo
Y2gsIGFfc2VsLCByX3NlbCwgZ19zZWwsIGJfc2VsKTsKPiArICAgICAgICAgICAgICAgfSBlbHNl
IHsKPiArICAgICAgICAgICAgICAgICAgICAgICBkY3NzX2Rwcl9hcmdiX2NvbXBfc2VsKGNoLCAz
LCAyLCAxLCAwKTsKPiArICAgICAgICAgICAgICAgfQo+ICsgICAgICAgfSBlbHNlIHsKPiArICAg
ICAgICAgICAgICAgZGNzc19kcHJfYXJnYl9jb21wX3NlbChjaCwgMCwgMCwgMCwgMCk7Cj4gKyAg
ICAgICB9Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGRjc3NfZHByX3RpbGVfc2V0KHN0cnVjdCBk
Y3NzX2Rwcl9jaCAqY2gsIHVpbnQ2NF90IG1vZGlmaWVyKQo+ICt7Cj4gKyAgICAgICBzd2l0Y2gg
KGNoLT5jaF9udW0pIHsKPiArICAgICAgIGNhc2UgMDoKPiArICAgICAgICAgICAgICAgc3dpdGNo
IChtb2RpZmllcikgewo+ICsgICAgICAgICAgICAgICBjYXNlIERSTV9GT1JNQVRfTU9EX0xJTkVB
UjoKPiArICAgICAgICAgICAgICAgICAgICAgICBjaC0+dGlsZSA9IFRJTEVfTElORUFSOwo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwo+ICsgICAgICAgICAgICAgICBjYXNlIERSTV9G
T1JNQVRfTU9EX1ZJVkFOVEVfVElMRUQ6Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgY2gtPnRp
bGUgPSBUSUxFX0dQVV9TVEFOREFSRDsKPiArICAgICAgICAgICAgICAgICAgICAgICBicmVhazsK
PiArICAgICAgICAgICAgICAgY2FzZSBEUk1fRk9STUFUX01PRF9WSVZBTlRFX1NVUEVSX1RJTEVE
Ogo+ICsgICAgICAgICAgICAgICAgICAgICAgIGNoLT50aWxlID0gVElMRV9HUFVfU1VQRVI7Cj4g
KyAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Cj4gKyAgICAgICAgICAgICAgIGRlZmF1bHQ6
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgV0FSTl9PTigxKTsKPiArICAgICAgICAgICAgICAg
ICAgICAgICBicmVhazsKPiArICAgICAgICAgICAgICAgfQo+ICsgICAgICAgICAgICAgICBicmVh
azsKPiArICAgICAgIGNhc2UgMToKPiArICAgICAgIGNhc2UgMjoKPiArICAgICAgICAgICAgICAg
Y2gtPnRpbGUgPSBUSUxFX0xJTkVBUjsKPiArICAgICAgICAgICAgICAgYnJlYWs7Cj4gKyAgICAg
ICBkZWZhdWx0Ogo+ICsgICAgICAgICAgICAgICBXQVJOX09OKDEpOwo+ICsgICAgICAgICAgICAg
ICByZXR1cm47Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgY2gtPm1vZGVfY3RybCAmPSB+VElM
RV9UWVBFX01BU0s7Cj4gKyAgICAgICBjaC0+bW9kZV9jdHJsIHw9ICgoY2gtPnRpbGUgPDwgVElM
RV9UWVBFX1BPUykgJiBUSUxFX1RZUEVfTUFTSyk7Cj4gK30KPiArCj4gK3ZvaWQgZGNzc19kcHJf
Zm9ybWF0X3NldChzdHJ1Y3QgZGNzc19kcHIgKmRwciwgaW50IGNoX251bSwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IGRybV9mb3JtYXRfaW5mbyAqZm9ybWF0LCB1NjQg
bW9kaWZpZXIpCj4gK3sKPiArICAgICAgIHN0cnVjdCBkY3NzX2Rwcl9jaCAqY2ggPSAmZHByLT5j
aFtjaF9udW1dOwo+ICsKPiArICAgICAgIGNoLT5mb3JtYXQgPSAqZm9ybWF0Owo+ICsKPiArICAg
ICAgIGRjc3NfZHByX3l1dl9lbihjaCwgZm9ybWF0LT5pc195dXYpOwo+ICsKPiArICAgICAgIGRj
c3NfZHByX3BpeF9zaXplX3NldChjaCwgZm9ybWF0KTsKPiArCj4gKyAgICAgICBkY3NzX2Rwcl9z
ZXR1cF9jb21wb25lbnRzKGNoLCBmb3JtYXQpOwo+ICsKPiArICAgICAgIGRjc3NfZHByXzJwbGFu
ZV9lbihjaCwgZm9ybWF0LT5udW1fcGxhbmVzID09IDIpOwo+ICsKPiArICAgICAgIGRjc3NfZHBy
X3J0cmFtX3NldChjaCwgZm9ybWF0LT5mb3JtYXQpOwo+ICsKPiArICAgICAgIGRjc3NfZHByX3Rp
bGVfc2V0KGNoLCBtb2RpZmllcik7Cj4gK30KPiArCj4gKy8qIFRoaXMgZnVuY3Rpb24gd2lsbCBi
ZSBjYWxsZWQgZnJvbSBpbnRlcnJ1cHQgY29udGV4dC4gKi8KPiArdm9pZCBkY3NzX2Rwcl93cml0
ZV9zeXNjdHJsKHN0cnVjdCBkY3NzX2RwciAqZHByKQo+ICt7Cj4gKyAgICAgICBpbnQgY2hudW07
Cj4gKwo+ICsgICAgICAgZm9yIChjaG51bSA9IDA7IGNobnVtIDwgMzsgY2hudW0rKykgewo+ICsg
ICAgICAgICAgICAgICBzdHJ1Y3QgZGNzc19kcHJfY2ggKmNoID0gJmRwci0+Y2hbY2hudW1dOwo+
ICsKPiArICAgICAgICAgICAgICAgaWYgKGNoLT5zeXNfY3RybF9jaGdkKSB7Cj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgZGNzc19jdHhsZF93cml0ZV9pcnFzYWZlKGRwci0+Y3R4bGQsIGRwci0+
Y3R4X2lkLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBjaC0+c3lzX2N0cmwsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGNoLT5iYXNlX29mcyArCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIERDU1NfRFBSX1NZU1RFTV9DVFJMMCk7Cj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgY2gtPnN5c19jdHJsX2NoZ2QgPSBmYWxzZTsKPiArICAgICAgICAgICAgICAg
fQo+ICsgICAgICAgfQo+ICt9Cj4gKwo+ICt2b2lkIGRjc3NfZHByX3NldF9yb3RhdGlvbihzdHJ1
Y3QgZGNzc19kcHIgKmRwciwgaW50IGNoX251bSwgdTMyIHJvdGF0aW9uKQo+ICt7Cj4gKyAgICAg
ICBzdHJ1Y3QgZGNzc19kcHJfY2ggKmNoID0gJmRwci0+Y2hbY2hfbnVtXTsKPiArCj4gKyAgICAg
ICBjaC0+ZnJhbWVfY3RybCAmPSB+KEhGTElQX0VOIHwgVkZMSVBfRU4gfCBST1RfRU5DX01BU0sp
Owo+ICsKPiArICAgICAgIGNoLT5mcmFtZV9jdHJsIHw9IHJvdGF0aW9uICYgRFJNX01PREVfUkVG
TEVDVF9YID8gSEZMSVBfRU4gOiAwOwo+ICsgICAgICAgY2gtPmZyYW1lX2N0cmwgfD0gcm90YXRp
b24gJiBEUk1fTU9ERV9SRUZMRUNUX1kgPyBWRkxJUF9FTiA6IDA7Cj4gKwo+ICsgICAgICAgaWYg
KHJvdGF0aW9uICYgRFJNX01PREVfUk9UQVRFXzkwKQo+ICsgICAgICAgICAgICAgICBjaC0+ZnJh
bWVfY3RybCB8PSAxIDw8IFJPVF9FTkNfUE9TOwo+ICsgICAgICAgZWxzZSBpZiAocm90YXRpb24g
JiBEUk1fTU9ERV9ST1RBVEVfMTgwKQo+ICsgICAgICAgICAgICAgICBjaC0+ZnJhbWVfY3RybCB8
PSAyIDw8IFJPVF9FTkNfUE9TOwo+ICsgICAgICAgZWxzZSBpZiAocm90YXRpb24gJiBEUk1fTU9E
RV9ST1RBVEVfMjcwKQo+ICsgICAgICAgICAgICAgICBjaC0+ZnJhbWVfY3RybCB8PSAzIDw8IFJP
VF9FTkNfUE9TOwo+ICt9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pbXgvZGNzcy9k
Y3NzLWRydi5jIGIvZHJpdmVycy9ncHUvZHJtL2lteC9kY3NzL2Rjc3MtZHJ2LmMKPiBuZXcgZmls
ZSBtb2RlIDEwMDY0NAo+IGluZGV4IDAwMDAwMDAwLi43ZWExMzFkCj4gLS0tIC9kZXYvbnVsbAo+
ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pbXgvZGNzcy9kY3NzLWRydi5jCj4gQEAgLTAsMCArMSwx
ODIgQEAKPiArLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAKPiArLyoKPiArICog
Q29weXJpZ2h0IDIwMTkgTlhQLgo+ICsgKi8KPiArCj4gKyNpbmNsdWRlIDxsaW51eC9tb2R1bGUu
aD4KPiArI2luY2x1ZGUgPGxpbnV4L2tlcm5lbC5oPgo+ICsjaW5jbHVkZSA8bGludXgvcGxhdGZv
cm1fZGV2aWNlLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9jb21wb25lbnQuaD4KPiArI2luY2x1ZGUg
PGRybS9kcm1fb2YuaD4KPiArI2luY2x1ZGUgPGRybS9kcm1QLmg+Cj4gKwo+ICsjaW5jbHVkZSAi
ZGNzcy1kZXYuaCIKPiArI2luY2x1ZGUgImRjc3Mta21zLmgiCj4gKwo+ICtzdHJ1Y3QgZGNzc19k
cnYgewo+ICsgICAgICAgc3RydWN0IGRjc3NfZGV2ICpkY3NzOwo+ICsgICAgICAgc3RydWN0IGRj
c3Nfa21zX2RldiAqa21zOwo+ICsKPiArICAgICAgIGJvb2wgaXNfY29tcG9uZW50aXplZDsKPiAr
fTsKPiArCj4gK3N0cnVjdCBkY3NzX2RldiAqZGNzc19kcnZfZGV2X3RvX2Rjc3Moc3RydWN0IGRl
dmljZSAqZGV2KQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZGNzc19kcnYgKm1kcnYgPSBkZXZfZ2V0
X2RydmRhdGEoZGV2KTsKPiArCj4gKyAgICAgICByZXR1cm4gbWRydiA/IG1kcnYtPmRjc3MgOiBO
VUxMOwo+ICt9Cj4gKwo+ICtzdHJ1Y3QgZHJtX2RldmljZSAqZGNzc19kcnZfZGV2X3RvX2RybShz
dHJ1Y3QgZGV2aWNlICpkZXYpCj4gK3sKPiArICAgICAgIHN0cnVjdCBkY3NzX2RydiAqbWRydiA9
IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwo+ICsKPiArICAgICAgIHJldHVybiBtZHJ2ID8gJm1kcnYt
Pmttcy0+YmFzZSA6IE5VTEw7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgZGNzc19kcnZfaW5pdChz
dHJ1Y3QgZGV2aWNlICpkZXYsIGJvb2wgY29tcG9uZW50aXplZCkKPiArewo+ICsgICAgICAgc3Ry
dWN0IGRjc3NfZHJ2ICptZHJ2Owo+ICsgICAgICAgaW50IGVyciA9IDA7Cj4gKwo+ICsgICAgICAg
bWRydiA9IGRldm1fa3phbGxvYyhkZXYsIHNpemVvZigqbWRydiksIEdGUF9LRVJORUwpOwo+ICsg
ICAgICAgaWYgKCFtZHJ2KQo+ICsgICAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKPiArCj4g
KyAgICAgICBtZHJ2LT5pc19jb21wb25lbnRpemVkID0gY29tcG9uZW50aXplZDsKPiArCj4gKyAg
ICAgICBtZHJ2LT5kY3NzID0gZGNzc19kZXZfY3JlYXRlKGRldiwgY29tcG9uZW50aXplZCk7Cj4g
KyAgICAgICBpZiAoSVNfRVJSKG1kcnYtPmRjc3MpKSB7Cj4gKyAgICAgICAgICAgICAgIGVyciA9
IFBUUl9FUlIobWRydi0+ZGNzcyk7Cj4gKyAgICAgICAgICAgICAgIGdvdG8gZXJyOwo+ICsgICAg
ICAgfQo+ICsKPiArICAgICAgIGRldl9zZXRfZHJ2ZGF0YShkZXYsIG1kcnYpOwo+ICsKPiArICAg
ICAgIG1kcnYtPmttcyA9IGRjc3Nfa21zX2F0dGFjaChtZHJ2LT5kY3NzLCBjb21wb25lbnRpemVk
KTsKPiArICAgICAgIGlmIChJU19FUlIobWRydi0+a21zKSkgewo+ICsgICAgICAgICAgICAgICBl
cnIgPSBQVFJfRVJSKG1kcnYtPmttcyk7Cj4gKyAgICAgICAgICAgICAgIGdvdG8gZGNzc19zaHV0
b2ZmOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIHJldHVybiAwOwo+ICsKPiArZGNzc19zaHV0
b2ZmOgo+ICsgICAgICAgZGNzc19kZXZfZGVzdHJveShtZHJ2LT5kY3NzKTsKPiArCj4gKyAgICAg
ICBkZXZfc2V0X2RydmRhdGEoZGV2LCBOVUxMKTsKPiArCj4gK2VycjoKPiArICAgICAgIGRldm1f
a2ZyZWUoZGV2LCBtZHJ2KTsKPiArICAgICAgIHJldHVybiBlcnI7Cj4gK30KPiArCj4gK3N0YXRp
YyB2b2lkIGRjc3NfZHJ2X2RlaW5pdChzdHJ1Y3QgZGV2aWNlICpkZXYsIGJvb2wgY29tcG9uZW50
aXplZCkKPiArewo+ICsgICAgICAgc3RydWN0IGRjc3NfZHJ2ICptZHJ2ID0gZGV2X2dldF9kcnZk
YXRhKGRldik7Cj4gKwo+ICsgICAgICAgaWYgKCFtZHJ2KQo+ICsgICAgICAgICAgICAgICByZXR1
cm47Cj4gKwo+ICsgICAgICAgZGNzc19rbXNfZGV0YWNoKG1kcnYtPmttcywgY29tcG9uZW50aXpl
ZCk7Cj4gKyAgICAgICBkY3NzX2Rldl9kZXN0cm95KG1kcnYtPmRjc3MpOwo+ICsKPiArICAgICAg
IGRldl9zZXRfZHJ2ZGF0YShkZXYsIE5VTEwpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGRjc3Nf
ZHJ2X2JpbmQoc3RydWN0IGRldmljZSAqZGV2KQo+ICt7Cj4gKyAgICAgICByZXR1cm4gZGNzc19k
cnZfaW5pdChkZXYsIHRydWUpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBkY3NzX2Rydl91bmJp
bmQoc3RydWN0IGRldmljZSAqZGV2KQo+ICt7Cj4gKyAgICAgICByZXR1cm4gZGNzc19kcnZfZGVp
bml0KGRldiwgdHJ1ZSk7Cj4gK30KPiArCj4gK3N0YXRpYyBjb25zdCBzdHJ1Y3QgY29tcG9uZW50
X21hc3Rlcl9vcHMgZGNzc19tYXN0ZXJfb3BzID0gewo+ICsgICAgICAgLmJpbmQgICA9IGRjc3Nf
ZHJ2X2JpbmQsCj4gKyAgICAgICAudW5iaW5kID0gZGNzc19kcnZfdW5iaW5kLAo+ICt9Owo+ICsK
PiArc3RhdGljIGludCBjb21wYXJlX29mKHN0cnVjdCBkZXZpY2UgKmRldiwgdm9pZCAqZGF0YSkK
PiArewo+ICsgICAgICAgcmV0dXJuIGRldi0+b2Zfbm9kZSA9PSBkYXRhOwo+ICt9Cj4gKwo+ICtz
dGF0aWMgaW50IGRjc3NfZHJ2X3BsYXRmb3JtX3Byb2JlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2Ug
KnBkZXYpCj4gK3sKPiArICAgICAgIHN0cnVjdCBkZXZpY2UgKmRldiA9ICZwZGV2LT5kZXY7Cj4g
KyAgICAgICBzdHJ1Y3QgY29tcG9uZW50X21hdGNoICptYXRjaCA9IE5VTEw7Cj4gKyAgICAgICBz
dHJ1Y3QgZGV2aWNlX25vZGUgKnJlbW90ZTsKPiArCj4gKyAgICAgICBpZiAoIWRldi0+b2Zfbm9k
ZSkKPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9ERVY7Cj4gKwo+ICsgICAgICAgcmVtb3Rl
ID0gb2ZfZ3JhcGhfZ2V0X3JlbW90ZV9ub2RlKGRldi0+b2Zfbm9kZSwgMCwgMCk7Cj4gKyAgICAg
ICBpZiAoIXJlbW90ZSkKPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9ERVY7Cj4gKwo+ICsg
ICAgICAgaWYgKG9mX2RldmljZV9pc19jb21wYXRpYmxlKHJlbW90ZSwgImZzbCxpbXg4bXEtbnds
LWRzaSIpKSB7Cj4gKyAgICAgICAgICAgICAgIG9mX25vZGVfcHV0KHJlbW90ZSk7Cj4gKyAgICAg
ICAgICAgICAgIHJldHVybiBkY3NzX2Rydl9pbml0KGRldiwgZmFsc2UpOwo+ICsgICAgICAgfQo+
ICsKPiArICAgICAgIGRybV9vZl9jb21wb25lbnRfbWF0Y2hfYWRkKGRldiwgJm1hdGNoLCBjb21w
YXJlX29mLCByZW1vdGUpOwo+ICsgICAgICAgb2Zfbm9kZV9wdXQocmVtb3RlKTsKPiArCj4gKyAg
ICAgICByZXR1cm4gY29tcG9uZW50X21hc3Rlcl9hZGRfd2l0aF9tYXRjaChkZXYsICZkY3NzX21h
c3Rlcl9vcHMsIG1hdGNoKTsKPiArfQo+ICsKPiArc3RhdGljIGludCBkY3NzX2Rydl9wbGF0Zm9y
bV9yZW1vdmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKPiArewo+ICsgICAgICAgc3Ry
dWN0IGRjc3NfZHJ2ICptZHJ2ID0gZGV2X2dldF9kcnZkYXRhKCZwZGV2LT5kZXYpOwo+ICsKPiAr
ICAgICAgIGlmIChtZHJ2LT5pc19jb21wb25lbnRpemVkKQo+ICsgICAgICAgICAgICAgICBjb21w
b25lbnRfbWFzdGVyX2RlbCgmcGRldi0+ZGV2LCAmZGNzc19tYXN0ZXJfb3BzKTsKPiArICAgICAg
IGVsc2UKPiArICAgICAgICAgICAgICAgZGNzc19kcnZfZGVpbml0KCZwZGV2LT5kZXYsIGZhbHNl
KTsKPiArCj4gKyAgICAgICByZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIHN0cnVjdCBkY3Nz
X3R5cGVfZGF0YSBkY3NzX3R5cGVzW10gPSB7Cj4gKyAgICAgICBbRENTU19JTVg4TVFdID0gewo+
ICsgICAgICAgICAgICAgICAubmFtZSA9ICJEQ1NTX0lNWDhNUSIsCj4gKyAgICAgICAgICAgICAg
IC5ibGtjdGxfb2ZzID0gMHgyRjAwMCwKPiArICAgICAgICAgICAgICAgLmN0eGxkX29mcyA9IDB4
MjMwMDAsCj4gKyAgICAgICAgICAgICAgIC5kdGdfb2ZzID0gMHgyMDAwMCwKPiArICAgICAgICAg
ICAgICAgLnNjYWxlcl9vZnMgPSAweDFDMDAwLAo+ICsgICAgICAgICAgICAgICAuc3Nfb2ZzID0g
MHgxQjAwMCwKPiArICAgICAgICAgICAgICAgLmRwcl9vZnMgPSAweDE4MDAwLAo+ICsgICAgICAg
fSwKPiArfTsKPiArCj4gK3N0YXRpYyBjb25zdCBzdHJ1Y3Qgb2ZfZGV2aWNlX2lkIGRjc3Nfb2Zf
bWF0Y2hbXSA9IHsKPiArICAgICAgIHsgLmNvbXBhdGlibGUgPSAibnhwLGlteDhtcS1kY3NzIiwg
LmRhdGEgPSAmZGNzc190eXBlc1tEQ1NTX0lNWDhNUV0sIH0sCj4gKyAgICAgICB7fSwKPiArfTsK
PiArCj4gK01PRFVMRV9ERVZJQ0VfVEFCTEUob2YsIGRjc3Nfb2ZfbWF0Y2gpOwo+ICsKPiArc3Rh
dGljIGNvbnN0IHN0cnVjdCBkZXZfcG1fb3BzIGRjc3NfZGV2X3BtID0gewo+ICsgICAgICAgU0VU
X1NZU1RFTV9TTEVFUF9QTV9PUFMoZGNzc19kZXZfc3VzcGVuZCwgZGNzc19kZXZfcmVzdW1lKQo+
ICsgICAgICAgU0VUX1JVTlRJTUVfUE1fT1BTKGRjc3NfZGV2X3J1bnRpbWVfc3VzcGVuZCwKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICBkY3NzX2Rldl9ydW50aW1lX3Jlc3VtZSwgTlVMTCkK
PiArfTsKPiArCj4gK3N0YXRpYyBzdHJ1Y3QgcGxhdGZvcm1fZHJpdmVyIGRjc3NfcGxhdGZvcm1f
ZHJpdmVyID0gewo+ICsgICAgICAgLnByb2JlICA9IGRjc3NfZHJ2X3BsYXRmb3JtX3Byb2JlLAo+
ICsgICAgICAgLnJlbW92ZSA9IGRjc3NfZHJ2X3BsYXRmb3JtX3JlbW92ZSwKPiArICAgICAgIC5k
cml2ZXIgPSB7Cj4gKyAgICAgICAgICAgICAgIC5uYW1lID0gImlteC1kY3NzIiwKPiArICAgICAg
ICAgICAgICAgLm9mX21hdGNoX3RhYmxlID0gZGNzc19vZl9tYXRjaCwKPiArICAgICAgICAgICAg
ICAgLnBtID0gJmRjc3NfZGV2X3BtLAo+ICsgICAgICAgfSwKPiArfTsKPiArCj4gK21vZHVsZV9w
bGF0Zm9ybV9kcml2ZXIoZGNzc19wbGF0Zm9ybV9kcml2ZXIpOwo+ICsKPiArTU9EVUxFX0FVVEhP
UigiTGF1cmVudGl1IFBhbGN1IDxsYXVyZW50aXUucGFsY3VAbnhwLmNvbT4iKTsKPiArTU9EVUxF
X0RFU0NSSVBUSU9OKCJEQ1NTIGRyaXZlciBmb3IgaS5NWDhNUSIpOwo+ICtNT0RVTEVfTElDRU5T
RSgiR1BMIHYyIik7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pbXgvZGNzcy9kY3Nz
LWR0Zy5jIGIvZHJpdmVycy9ncHUvZHJtL2lteC9kY3NzL2Rjc3MtZHRnLmMKPiBuZXcgZmlsZSBt
b2RlIDEwMDY0NAo+IGluZGV4IDAwMDAwMDAwLi5jODNiM2JiCj4gLS0tIC9kZXYvbnVsbAo+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pbXgvZGNzcy9kY3NzLWR0Zy5jCj4gQEAgLTAsMCArMSw0Mzgg
QEAKPiArLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAKPiArLyoKPiArICogQ29w
eXJpZ2h0IDIwMTkgTlhQLgo+ICsgKi8KPiArCj4gKyNpbmNsdWRlIDxsaW51eC9jbGsuaD4KPiAr
I2luY2x1ZGUgPGxpbnV4L2RlbGF5Lmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9pbnRlcnJ1cHQuaD4K
PiArI2luY2x1ZGUgPGxpbnV4L29mLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9wbGF0Zm9ybV9kZXZp
Y2UuaD4KPiArCj4gKyNpbmNsdWRlICJkY3NzLWRldi5oIgo+ICsKPiArI2RlZmluZSBEQ1NTX0RU
R19UQ19DT05UUk9MX1NUQVRVUyAgICAgICAgICAgICAgICAgICAgIDB4MDAKPiArI2RlZmluZSAg
IENIM19FTiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJJVCgwKQo+ICsj
ZGVmaW5lICAgQ0gyX0VOICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQklU
KDEpCj4gKyNkZWZpbmUgICBDSDFfRU4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBCSVQoMikKPiArI2RlZmluZSAgIE9WTF9EQVRBX01PREUgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgQklUKDMpCj4gKyNkZWZpbmUgICBCTEVOREVSX1ZJREVPX0FM
UEhBX1NFTCAgICAgICAgICAgICAgICAgICAgICBCSVQoNykKPiArI2RlZmluZSAgIERUR19TVEFS
VCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJJVCg4KQo+ICsjZGVmaW5lICAg
REJZX01PREVfRU4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQklUKDkpCj4gKyNk
ZWZpbmUgICBDSDFfQUxQSEFfU0VMICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIEJJVCgxMCkKPiArI2RlZmluZSAgIENTU19QSVhfQ09NUF9TV0FQX1BPUyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgMTIKPiArI2RlZmluZSAgIENTU19QSVhfQ09NUF9TV0FQX01B
U0sgICAgICAgICAgICAgICAgICAgICAgIEdFTk1BU0soMTQsIDEyKQo+ICsjZGVmaW5lICAgREVG
QVVMVF9GR19BTFBIQV9QT1MgICAgICAgICAgICAgICAgICAgICAgICAgMjQKPiArI2RlZmluZSAg
IERFRkFVTFRfRkdfQUxQSEFfTUFTSyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR0VO
TUFTSygzMSwgMjQpCj4gKyNkZWZpbmUgRENTU19EVEdfVENfRFRHICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIDB4MDQKPiArI2RlZmluZSBEQ1NTX0RUR19UQ19ESVNQX1RP
UCAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MDgKPiArI2RlZmluZSBEQ1NTX0RUR19UQ19E
SVNQX0JPVCAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MEMKPiArI2RlZmluZSBEQ1NTX0RU
R19UQ19DSDFfVE9QICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MTAKPiArI2RlZmluZSBE
Q1NTX0RUR19UQ19DSDFfQk9UICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MTQKPiArI2Rl
ZmluZSBEQ1NTX0RUR19UQ19DSDJfVE9QICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MTgK
PiArI2RlZmluZSBEQ1NTX0RUR19UQ19DSDJfQk9UICAgICAgICAgICAgICAgICAgICAgICAgICAg
IDB4MUMKPiArI2RlZmluZSBEQ1NTX0RUR19UQ19DSDNfVE9QICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIDB4MjAKPiArI2RlZmluZSBEQ1NTX0RUR19UQ19DSDNfQk9UICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIDB4MjQKPiArI2RlZmluZSAgIFRDX1hfUE9TICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIDAKPiArI2RlZmluZSAgIFRDX1hfTUFTSyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIEdFTk1BU0soMTIsIDApCj4gKyNkZWZpbmUgICBUQ19ZX1BP
UyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAxNgo+ICsjZGVmaW5lICAgVENf
WV9NQVNLICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR0VOTUFTSygyOCwgMTYp
Cj4gKyNkZWZpbmUgRENTU19EVEdfVENfQ1RYTEQgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAweDI4Cj4gKyNkZWZpbmUgICBUQ19DVFhMRF9EQl9ZX1BPUyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAwCj4gKyNkZWZpbmUgICBUQ19DVFhMRF9EQl9ZX01BU0sgICAgICAgICAgICAgICAg
ICAgICAgICAgICBHRU5NQVNLKDEyLCAwKQo+ICsjZGVmaW5lICAgVENfQ1RYTERfU0JfWV9QT1Mg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgMTYKPiArI2RlZmluZSAgIFRDX0NUWExEX1NCX1lf
TUFTSyAgICAgICAgICAgICAgICAgICAgICAgICAgIEdFTk1BU0soMjgsIDE2KQo+ICsjZGVmaW5l
IERDU1NfRFRHX1RDX0NIMV9CS1JORCAgICAgICAgICAgICAgICAgICAgICAgICAgMHgyQwo+ICsj
ZGVmaW5lIERDU1NfRFRHX1RDX0NIMl9CS1JORCAgICAgICAgICAgICAgICAgICAgICAgICAgMHgz
MAo+ICsjZGVmaW5lICAgQktSTkRfUl9ZX0NPTVBfUE9TICAgICAgICAgICAgICAgICAgICAgICAg
ICAgMjAKPiArI2RlZmluZSAgIEJLUk5EX1JfWV9DT01QX01BU0sgICAgICAgICAgICAgICAgICAg
ICAgICAgIEdFTk1BU0soMjksIDIwKQo+ICsjZGVmaW5lICAgQktSTkRfR19VX0NPTVBfUE9TICAg
ICAgICAgICAgICAgICAgICAgICAgICAgMTAKPiArI2RlZmluZSAgIEJLUk5EX0dfVV9DT01QX01B
U0sgICAgICAgICAgICAgICAgICAgICAgICAgIEdFTk1BU0soMTksIDEwKQo+ICsjZGVmaW5lICAg
QktSTkRfQl9WX0NPTVBfUE9TICAgICAgICAgICAgICAgICAgICAgICAgICAgMAo+ICsjZGVmaW5l
ICAgQktSTkRfQl9WX0NPTVBfTUFTSyAgICAgICAgICAgICAgICAgICAgICAgICAgR0VOTUFTSyg5
LCAwKQo+ICsjZGVmaW5lIERDU1NfRFRHX0JMRU5ERVJfREJZX1JBTkdFSU5WICAgICAgICAgICAg
ICAgICAgMHgzOAo+ICsjZGVmaW5lIERDU1NfRFRHX0JMRU5ERVJfREJZX1JBTkdFTUlOICAgICAg
ICAgICAgICAgICAgMHgzQwo+ICsjZGVmaW5lIERDU1NfRFRHX0JMRU5ERVJfREJZX0JEUCAgICAg
ICAgICAgICAgICAgICAgICAgMHg0MAo+ICsjZGVmaW5lIERDU1NfRFRHX0JMRU5ERVJfQktSTkRf
SSAgICAgICAgICAgICAgICAgICAgICAgMHg0NAo+ICsjZGVmaW5lIERDU1NfRFRHX0JMRU5ERVJf
QktSTkRfUCAgICAgICAgICAgICAgICAgICAgICAgMHg0OAo+ICsjZGVmaW5lIERDU1NfRFRHX0JM
RU5ERVJfQktSTkRfVCAgICAgICAgICAgICAgICAgICAgICAgMHg0Qwo+ICsjZGVmaW5lIERDU1Nf
RFRHX0xJTkUwX0lOVCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg1MAo+ICsjZGVmaW5l
IERDU1NfRFRHX0xJTkUxX0lOVCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg1NAo+ICsj
ZGVmaW5lIERDU1NfRFRHX0JHX0FMUEhBX0RFRkFVTFQgICAgICAgICAgICAgICAgICAgICAgMHg1
OAo+ICsjZGVmaW5lIERDU1NfRFRHX0lOVF9TVEFUVVMgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgMHg1Qwo+ICsjZGVmaW5lIERDU1NfRFRHX0lOVF9DT05UUk9MICAgICAgICAgICAgICAgICAg
ICAgICAgICAgMHg2MAo+ICsjZGVmaW5lIERDU1NfRFRHX1RDX0NIM19CS1JORCAgICAgICAgICAg
ICAgICAgICAgICAgICAgMHg2NAo+ICsjZGVmaW5lIERDU1NfRFRHX0lOVF9NQVNLICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgMHg2OAo+ICsjZGVmaW5lICAgTElORTBfSVJRICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgQklUKDApCj4gKyNkZWZpbmUgICBMSU5FMV9JUlEg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCSVQoMSkKPiArI2RlZmluZSAgIExJ
TkUyX0lSUSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJJVCgyKQo+ICsjZGVm
aW5lICAgTElORTNfSVJRICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQklUKDMp
Cj4gKyNkZWZpbmUgRENTU19EVEdfTElORTJfSU5UICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAweDZDCj4gKyNkZWZpbmUgRENTU19EVEdfTElORTNfSU5UICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAweDcwCj4gKyNkZWZpbmUgRENTU19EVEdfREJZX09MICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIDB4NzQKPiArI2RlZmluZSBEQ1NTX0RUR19EQllfQkwgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg3OAo+ICsjZGVmaW5lIERDU1Nf
RFRHX0RCWV9FTCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDdDCj4g
Kwo+ICtzdHJ1Y3QgZGNzc19kdGcgewo+ICsgICAgICAgc3RydWN0IGRldmljZSAqZGV2Owo+ICsg
ICAgICAgc3RydWN0IGRjc3NfY3R4bGQgKmN0eGxkOwo+ICsgICAgICAgdm9pZCBfX2lvbWVtICpi
YXNlX3JlZzsKPiArICAgICAgIHUzMiBiYXNlX29mczsKPiArCj4gKyAgICAgICB1MzIgY3R4X2lk
Owo+ICsKPiArICAgICAgIGJvb2wgaW5fdXNlOwo+ICsKPiArICAgICAgIHUzMiBkaXNfdWxjX3g7
Cj4gKyAgICAgICB1MzIgZGlzX3VsY195Owo+ICsKPiArICAgICAgIHUzMiBjb250cm9sX3N0YXR1
czsKPiArICAgICAgIHUzMiBhbHBoYTsKPiArCj4gKyAgICAgICBpbnQgY3R4bGRfa2lja19pcnE7
Cj4gKyAgICAgICBib29sIGN0eGxkX2tpY2tfaXJxX2VuOwo+ICsKPiArICAgICAgIHN0cnVjdCBj
bGsgKnBpeF9jbGs7Cj4gKyAgICAgICBzdHJ1Y3QgY2xrICpwbGxfc3JjX2NsazsKPiArICAgICAg
IHN0cnVjdCBjbGsgKnBsbF9waHlfcmVmX2NsazsKPiArCj4gKyAgICAgICAvKgo+ICsgICAgICAg
ICogVGhpcyB3aWxsIGJlIHBhc3NlZCBvbiBieSBEUk0gQ1JUQyBzbyB0aGF0IHdlIGNhbiBzaWdu
YWwgd2hlbiBEVEcgaGFzCj4gKyAgICAgICAgKiBiZWVuIHN1Y2Nlc3NmdWxseSBzdG9wcGVkLiBP
dGhlcndpc2UsIGFueSBtb2Rlc2V0dGluZyB3aGlsZSBEVEcgaXMKPiArICAgICAgICAqIHN0aWxs
IE9OIG1heSByZXN1bHQgaW4gdW5wcmVkaWN0YWJsZSBiZWhhdmlvci4KPiArICAgICAgICAqLwo+
ICsgICAgICAgc3RydWN0IGNvbXBsZXRpb24gKmRpc19jb21wbGV0aW9uOwo+ICt9Owo+ICsKPiAr
c3RhdGljIHZvaWQgZGNzc19kdGdfd3JpdGUoc3RydWN0IGRjc3NfZHRnICpkdGcsIHUzMiB2YWws
IHUzMiBvZnMpCj4gK3sKPiArICAgICAgIGlmICghZHRnLT5pbl91c2UpCj4gKyAgICAgICAgICAg
ICAgIGRjc3Nfd3JpdGVsKHZhbCwgZHRnLT5iYXNlX3JlZyArIG9mcyk7Cj4gKwo+ICsgICAgICAg
ZGNzc19jdHhsZF93cml0ZShkdGctPmN0eGxkLCBkdGctPmN0eF9pZCwgdmFsLCBkdGctPmJhc2Vf
b2ZzICsgb2ZzKTsKPiArfQo+ICsKPiArc3RhdGljIGlycXJldHVybl90IGRjc3NfZHRnX2lycV9o
YW5kbGVyKGludCBpcnEsIHZvaWQgKmRhdGEpCj4gK3sKPiArICAgICAgIHN0cnVjdCBkY3NzX2R0
ZyAqZHRnID0gZGF0YTsKPiArICAgICAgIHUzMiBzdGF0dXM7Cj4gKwo+ICsgICAgICAgc3RhdHVz
ID0gZGNzc19yZWFkbChkdGctPmJhc2VfcmVnICsgRENTU19EVEdfSU5UX1NUQVRVUyk7Cj4gKwo+
ICsgICAgICAgaWYgKCEoc3RhdHVzICYgTElORTBfSVJRKSkKPiArICAgICAgICAgICAgICAgcmV0
dXJuIElSUV9IQU5ETEVEOwo+ICsKPiArICAgICAgIGRjc3NfY3R4bGRfa2ljayhkdGctPmN0eGxk
KTsKPiArCj4gKyAgICAgICBkY3NzX3dyaXRlbChzdGF0dXMgJiBMSU5FMF9JUlEsIGR0Zy0+YmFz
ZV9yZWcgKyBEQ1NTX0RUR19JTlRfQ09OVFJPTCk7Cj4gKwo+ICsgICAgICAgcmV0dXJuIElSUV9I
QU5ETEVEOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGRjc3NfZHRnX2lycV9jb25maWcoc3RydWN0
IGRjc3NfZHRnICpkdGcsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBw
bGF0Zm9ybV9kZXZpY2UgKnBkZXYpCj4gK3sKPiArICAgICAgIGludCByZXQ7Cj4gKwo+ICsgICAg
ICAgZHRnLT5jdHhsZF9raWNrX2lycSA9IHBsYXRmb3JtX2dldF9pcnFfYnluYW1lKHBkZXYsICJj
dHhsZF9raWNrIik7Cj4gKyAgICAgICBpZiAoZHRnLT5jdHhsZF9raWNrX2lycSA8IDApIHsKPiAr
ICAgICAgICAgICAgICAgZGV2X2VycihkdGctPmRldiwgImR0ZzogY2FuJ3QgZ2V0IGxpbmUyIGly
cSBudW1iZXJcbiIpOwo+ICsgICAgICAgICAgICAgICByZXR1cm4gZHRnLT5jdHhsZF9raWNrX2ly
cTsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICByZXQgPSBkZXZtX3JlcXVlc3RfaXJxKGR0Zy0+
ZGV2LCBkdGctPmN0eGxkX2tpY2tfaXJxLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBkY3NzX2R0Z19pcnFfaGFuZGxlciwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
SVJRRl9UUklHR0VSX0hJR0gsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkY3Nz
X2N0eGxkX2tpY2siLCBkdGcpOwo+ICsgICAgICAgaWYgKHJldCkgewo+ICsgICAgICAgICAgICAg
ICBkZXZfZXJyKGR0Zy0+ZGV2LCAiZHRnOiBpcnEgcmVxdWVzdCBmYWlsZWQuXG4iKTsKPiArICAg
ICAgICAgICAgICAgcmV0dXJuIHJldDsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICBkaXNhYmxl
X2lycShkdGctPmN0eGxkX2tpY2tfaXJxKTsKPiArCj4gKyAgICAgICBkdGctPmN0eGxkX2tpY2tf
aXJxX2VuID0gZmFsc2U7Cj4gKwo+ICsgICAgICAgZGNzc191cGRhdGUoTElORTBfSVJRLCBMSU5F
MF9JUlEsIGR0Zy0+YmFzZV9yZWcgKyBEQ1NTX0RUR19JTlRfTUFTSyk7Cj4gKwo+ICsgICAgICAg
cmV0dXJuIDA7Cj4gK30KPiArCj4gK2ludCBkY3NzX2R0Z19pbml0KHN0cnVjdCBkY3NzX2RldiAq
ZGNzcywgdW5zaWduZWQgbG9uZyBkdGdfYmFzZSkKPiArewo+ICsgICAgICAgaW50IHJldCA9IDA7
Cj4gKyAgICAgICBzdHJ1Y3QgZGNzc19kdGcgKmR0ZzsKPiArCj4gKyAgICAgICBkdGcgPSBkZXZt
X2t6YWxsb2MoZGNzcy0+ZGV2LCBzaXplb2YoKmR0ZyksIEdGUF9LRVJORUwpOwo+ICsgICAgICAg
aWYgKCFkdGcpCj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwo+ICsKPiArICAgICAg
IGRjc3MtPmR0ZyA9IGR0ZzsKPiArICAgICAgIGR0Zy0+ZGV2ID0gZGNzcy0+ZGV2Owo+ICsgICAg
ICAgZHRnLT5jdHhsZCA9IGRjc3MtPmN0eGxkOwo+ICsKPiArICAgICAgIGR0Zy0+YmFzZV9yZWcg
PSBkZXZtX2lvcmVtYXAoZGNzcy0+ZGV2LCBkdGdfYmFzZSwgU1pfNEspOwo+ICsgICAgICAgaWYg
KCFkdGctPmJhc2VfcmVnKSB7Cj4gKyAgICAgICAgICAgICAgIGRldl9lcnIoZGNzcy0+ZGV2LCAi
ZHRnOiB1bmFibGUgdG8gcmVtYXAgZHRnIGJhc2VcbiIpOwo+ICsgICAgICAgICAgICAgICByZXQg
PSAtRU5PTUVNOwo+ICsgICAgICAgICAgICAgICBnb3RvIGVycl9pb3JlbWFwOwo+ICsgICAgICAg
fQo+ICsKPiArICAgICAgIGR0Zy0+YmFzZV9vZnMgPSBkdGdfYmFzZTsKPiArICAgICAgIGR0Zy0+
Y3R4X2lkID0gQ1RYX0RCOwo+ICsKPiArICAgICAgIGR0Zy0+cGl4X2NsayA9IGRjc3MtPnBpeF9j
bGs7Cj4gKyAgICAgICBkdGctPnBsbF9zcmNfY2xrID0gZGNzcy0+cGxsX3NyY19jbGs7Cj4gKyAg
ICAgICBkdGctPnBsbF9waHlfcmVmX2NsayA9IGRjc3MtPnBsbF9waHlfcmVmX2NsazsKPiArCj4g
KyAgICAgICBkdGctPmFscGhhID0gMjU1Owo+ICsKPiArICAgICAgIGR0Zy0+Y29udHJvbF9zdGF0
dXMgfD0gT1ZMX0RBVEFfTU9ERSB8IEJMRU5ERVJfVklERU9fQUxQSEFfU0VMIHwKPiArICAgICAg
ICAgICAgICAgKChkdGctPmFscGhhIDw8IERFRkFVTFRfRkdfQUxQSEFfUE9TKSAmIERFRkFVTFRf
RkdfQUxQSEFfTUFTSyk7Cj4gKwo+ICsgICAgICAgcmV0ID0gZGNzc19kdGdfaXJxX2NvbmZpZyhk
dGcsIHRvX3BsYXRmb3JtX2RldmljZShkY3NzLT5kZXYpKTsKPiArICAgICAgIGlmIChyZXQpCj4g
KyAgICAgICAgICAgICAgIGdvdG8gZXJyX2lycTsKPiArCj4gKyAgICAgICByZXR1cm4gMDsKPiAr
Cj4gK2Vycl9pcnE6Cj4gKyAgICAgICBkZXZtX2lvdW5tYXAoZHRnLT5kZXYsIGR0Zy0+YmFzZV9y
ZWcpOwo+ICsKPiArZXJyX2lvcmVtYXA6Cj4gKyAgICAgICBkZXZtX2tmcmVlKGR0Zy0+ZGV2LCBk
dGcpOwo+ICsKPiArICAgICAgIHJldHVybiByZXQ7Cj4gK30KPiArCj4gK3ZvaWQgZGNzc19kdGdf
ZXhpdChzdHJ1Y3QgZGNzc19kdGcgKmR0ZykKPiArewo+ICsgICAgICAgLyogc3RvcCBEVEcgKi8K
PiArICAgICAgIGRjc3Nfd3JpdGVsKERUR19TVEFSVCwgZHRnLT5iYXNlX3JlZyArIERDU1NfRFRH
X1RDX0NPTlRST0xfU1RBVFVTKTsKPiArCj4gKyAgICAgICBkZXZtX2ZyZWVfaXJxKGR0Zy0+ZGV2
LCBkdGctPmN0eGxkX2tpY2tfaXJxLCBkdGcpOwo+ICsKPiArICAgICAgIGlmIChkdGctPmJhc2Vf
cmVnKQo+ICsgICAgICAgICAgICAgICBkZXZtX2lvdW5tYXAoZHRnLT5kZXYsIGR0Zy0+YmFzZV9y
ZWcpOwo+ICsKPiArICAgICAgIGRldm1fa2ZyZWUoZHRnLT5kZXYsIGR0Zyk7Cj4gK30KPiArCj4g
K3ZvaWQgZGNzc19kdGdfc3luY19zZXQoc3RydWN0IGRjc3NfZHRnICpkdGcsIHN0cnVjdCB2aWRl
b21vZGUgKnZtKQo+ICt7Cj4gKyAgICAgICB1MTYgZHRnX2xyY194LCBkdGdfbHJjX3k7Cj4gKyAg
ICAgICB1MTYgZGlzX3VsY194LCBkaXNfdWxjX3k7Cj4gKyAgICAgICB1MTYgZGlzX2xyY194LCBk
aXNfbHJjX3k7Cj4gKyAgICAgICB1MzIgc2JfY3R4bGRfdHJpZywgZGJfY3R4bGRfdHJpZzsKPiAr
ICAgICAgIHUzMiBwaXhjbG9jayA9IHZtLT5waXhlbGNsb2NrOwo+ICsgICAgICAgdTMyIGFjdHVh
bF9jbGs7Cj4gKwo+ICsgICAgICAgZHRnX2xyY194ID0gdm0tPmhmcm9udF9wb3JjaCArIHZtLT5o
YmFja19wb3JjaCArIHZtLT5oc3luY19sZW4gKwo+ICsgICAgICAgICAgICAgICAgICAgdm0tPmhh
Y3RpdmUgLSAxOwo+ICsgICAgICAgZHRnX2xyY195ID0gdm0tPnZmcm9udF9wb3JjaCArIHZtLT52
YmFja19wb3JjaCArIHZtLT52c3luY19sZW4gKwo+ICsgICAgICAgICAgICAgICAgICAgdm0tPnZh
Y3RpdmUgLSAxOwo+ICsgICAgICAgZGlzX3VsY194ID0gdm0tPmhzeW5jX2xlbiArIHZtLT5oYmFj
a19wb3JjaCAtIDE7Cj4gKyAgICAgICBkaXNfdWxjX3kgPSB2bS0+dnN5bmNfbGVuICsgdm0tPnZm
cm9udF9wb3JjaCArIHZtLT52YmFja19wb3JjaCAtIDE7Cj4gKyAgICAgICBkaXNfbHJjX3ggPSB2
bS0+aHN5bmNfbGVuICsgdm0tPmhiYWNrX3BvcmNoICsgdm0tPmhhY3RpdmUgLSAxOwo+ICsgICAg
ICAgZGlzX2xyY195ID0gdm0tPnZzeW5jX2xlbiArIHZtLT52ZnJvbnRfcG9yY2ggKyB2bS0+dmJh
Y2tfcG9yY2ggKwo+ICsgICAgICAgICAgICAgICAgICAgdm0tPnZhY3RpdmUgLSAxOwo+ICsKPiAr
ICAgICAgIGNsa19kaXNhYmxlX3VucHJlcGFyZShkdGctPnBpeF9jbGspOwo+ICsgICAgICAgY2xr
X3NldF9yYXRlKGR0Zy0+cGl4X2Nsaywgdm0tPnBpeGVsY2xvY2spOwo+ICsgICAgICAgY2xrX3By
ZXBhcmVfZW5hYmxlKGR0Zy0+cGl4X2Nsayk7Cj4gKwo+ICsgICAgICAgYWN0dWFsX2NsayA9IGNs
a19nZXRfcmF0ZShkdGctPnBpeF9jbGspOwo+ICsgICAgICAgaWYgKHBpeGNsb2NrICE9IGFjdHVh
bF9jbGspIHsKPiArICAgICAgICAgICAgICAgZGV2X2luZm8oZHRnLT5kZXYsCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICJQaXhlbCBjbG9jayBzZXQgdG8gJXUga0h6IGluc3RlYWQgb2YgJXUg
a0h6LlxuIiwKPiArICAgICAgICAgICAgICAgICAgICAgICAgKGFjdHVhbF9jbGsgLyAxMDAwKSwg
KHBpeGNsb2NrIC8gMTAwMCkpOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIG1zbGVlcCg1MCk7
Cj4gKwo+ICsgICAgICAgZGNzc19kdGdfd3JpdGUoZHRnLCAoKGR0Z19scmNfeSA8PCBUQ19ZX1BP
UykgfCBkdGdfbHJjX3gpLAo+ICsgICAgICAgICAgICAgICAgICAgICAgRENTU19EVEdfVENfRFRH
KTsKPiArICAgICAgIGRjc3NfZHRnX3dyaXRlKGR0ZywgKChkaXNfdWxjX3kgPDwgVENfWV9QT1Mp
IHwgZGlzX3VsY194KSwKPiArICAgICAgICAgICAgICAgICAgICAgIERDU1NfRFRHX1RDX0RJU1Bf
VE9QKTsKPiArICAgICAgIGRjc3NfZHRnX3dyaXRlKGR0ZywgKChkaXNfbHJjX3kgPDwgVENfWV9Q
T1MpIHwgZGlzX2xyY194KSwKPiArICAgICAgICAgICAgICAgICAgICAgIERDU1NfRFRHX1RDX0RJ
U1BfQk9UKTsKPiArCj4gKyAgICAgICBkdGctPmRpc191bGNfeCA9IGRpc191bGNfeDsKPiArICAg
ICAgIGR0Zy0+ZGlzX3VsY195ID0gZGlzX3VsY195Owo+ICsKPiArICAgICAgIHNiX2N0eGxkX3Ry
aWcgPSAoKDAgKiBkaXNfbHJjX3kgLyAxMDApIDw8IFRDX0NUWExEX1NCX1lfUE9TKSAmCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUQ19D
VFhMRF9TQl9ZX01BU0s7Cj4gKyAgICAgICBkYl9jdHhsZF90cmlnID0gKCg5OSAqIGRpc19scmNf
eSAvIDEwMCkgPDwgVENfQ1RYTERfREJfWV9QT1MpICYKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRDX0NUWExEX0RCX1lfTUFTSzsKPiAr
Cj4gKyAgICAgICBkY3NzX2R0Z193cml0ZShkdGcsIHNiX2N0eGxkX3RyaWcgfCBkYl9jdHhsZF90
cmlnLCBEQ1NTX0RUR19UQ19DVFhMRCk7Cj4gKwo+ICsgICAgICAgLyogdmJsYW5rIHRyaWdnZXIg
Ki8KPiArICAgICAgIGRjc3NfZHRnX3dyaXRlKGR0ZywgMCwgRENTU19EVEdfTElORTFfSU5UKTsK
PiArCj4gKyAgICAgICAvKiBDVFhMRCB0cmlnZ2VyICovCj4gKyAgICAgICBkY3NzX2R0Z193cml0
ZShkdGcsICgoOTAgKiBkaXNfbHJjX3kpIC8gMTAwKSA8PCAxNiwgRENTU19EVEdfTElORTBfSU5U
KTsKPiArfQo+ICsKPiArdm9pZCBkY3NzX2R0Z19wbGFuZV9wb3Nfc2V0KHN0cnVjdCBkY3NzX2R0
ZyAqZHRnLCBpbnQgY2hfbnVtLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgcHgs
IGludCBweSwgaW50IHB3LCBpbnQgcGgpCj4gK3sKPiArICAgICAgIHUxNiBwX3VsY194LCBwX3Vs
Y195Owo+ICsgICAgICAgdTE2IHBfbHJjX3gsIHBfbHJjX3k7Cj4gKwo+ICsgICAgICAgcF91bGNf
eCA9IGR0Zy0+ZGlzX3VsY194ICsgcHg7Cj4gKyAgICAgICBwX3VsY195ID0gZHRnLT5kaXNfdWxj
X3kgKyBweTsKPiArICAgICAgIHBfbHJjX3ggPSBwX3VsY194ICsgcHc7Cj4gKyAgICAgICBwX2xy
Y195ID0gcF91bGNfeSArIHBoOwo+ICsKPiArICAgICAgIGlmICghcHggJiYgIXB5ICYmICFwdyAm
JiAhcGgpIHsKPiArICAgICAgICAgICAgICAgZGNzc19kdGdfd3JpdGUoZHRnLCAwLCBEQ1NTX0RU
R19UQ19DSDFfVE9QICsgMHg4ICogY2hfbnVtKTsKPiArICAgICAgICAgICAgICAgZGNzc19kdGdf
d3JpdGUoZHRnLCAwLCBEQ1NTX0RUR19UQ19DSDFfQk9UICsgMHg4ICogY2hfbnVtKTsKPiArICAg
ICAgIH0gZWxzZSB7Cj4gKyAgICAgICAgICAgICAgIGRjc3NfZHRnX3dyaXRlKGR0ZywgKChwX3Vs
Y195IDw8IFRDX1lfUE9TKSB8IHBfdWxjX3gpLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBEQ1NTX0RUR19UQ19DSDFfVE9QICsgMHg4ICogY2hfbnVtKTsKPiArICAgICAgICAgICAg
ICAgZGNzc19kdGdfd3JpdGUoZHRnLCAoKHBfbHJjX3kgPDwgVENfWV9QT1MpIHwgcF9scmNfeCks
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERDU1NfRFRHX1RDX0NIMV9CT1QgKyAw
eDggKiBjaF9udW0pOwo+ICsgICAgICAgfQo+ICt9Cj4gKwo+ICtib29sIGRjc3NfZHRnX2dsb2Jh
bF9hbHBoYV9jaGFuZ2VkKHN0cnVjdCBkY3NzX2R0ZyAqZHRnLCBpbnQgY2hfbnVtLCBpbnQgYWxw
aGEpCj4gK3sKPiArICAgICAgIGlmIChjaF9udW0pCj4gKyAgICAgICAgICAgICAgIHJldHVybiBm
YWxzZTsKPiArCj4gKyAgICAgICByZXR1cm4gYWxwaGEgIT0gZHRnLT5hbHBoYTsKPiArfQo+ICsK
PiArdm9pZCBkY3NzX2R0Z19wbGFuZV9hbHBoYV9zZXQoc3RydWN0IGRjc3NfZHRnICpkdGcsIGlu
dCBjaF9udW0sCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IGRy
bV9mb3JtYXRfaW5mbyAqZm9ybWF0LCBpbnQgYWxwaGEpCj4gK3sKPiArICAgICAgIHUzMiBhbHBo
YV92YWw7Cj4gKwo+ICsgICAgICAgLyogd2UgY2FyZSBhYm91dCBhbHBoYSBvbmx5IHdoZW4gY2hh
bm5lbCAwIGlzIGNvbmNlcm5lZCAqLwo+ICsgICAgICAgaWYgKGNoX251bSkKPiArICAgICAgICAg
ICAgICAgcmV0dXJuOwo+ICsKPiArICAgICAgIGFscGhhX3ZhbCA9IChhbHBoYSA8PCBERUZBVUxU
X0ZHX0FMUEhBX1BPUykgJiBERUZBVUxUX0ZHX0FMUEhBX01BU0s7Cj4gKwo+ICsgICAgICAgLyoK
PiArICAgICAgICAqIFVzZSBnbG9iYWwgYWxwaGEgaWYgcGl4ZWwgZm9ybWF0IGRvZXMgbm90IGhh
dmUgYWxwaGEgY2hhbm5lbCBvciB0aGUKPiArICAgICAgICAqIHVzZXIgZXhwbGljaXRseSBjaG9z
ZSB0byB1c2UgZ2xvYmFsIGFscGhhIChpLmUuIGFscGhhIGlzIG5vdCBPUEFRVUUpLgo+ICsgICAg
ICAgICovCj4gKyAgICAgICBpZiAoIWZvcm1hdC0+aGFzX2FscGhhIHx8IGFscGhhICE9IDI1NSkg
ewo+ICsgICAgICAgICAgICAgICBkdGctPmNvbnRyb2xfc3RhdHVzICY9IH4oQ0gxX0FMUEhBX1NF
TCB8IERFRkFVTFRfRkdfQUxQSEFfTUFTSyk7Cj4gKyAgICAgICAgICAgICAgIGR0Zy0+Y29udHJv
bF9zdGF0dXMgfD0gYWxwaGFfdmFsOwo+ICsgICAgICAgfSBlbHNlIHsgLyogdXNlIHBlci1waXhl
bCBhbHBoYSBvdGhlcndpc2UgKi8KPiArICAgICAgICAgICAgICAgZHRnLT5jb250cm9sX3N0YXR1
cyB8PSBDSDFfQUxQSEFfU0VMOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGR0Zy0+YWxwaGEg
PSBhbHBoYTsKPiArfQo+ICsKPiArdm9pZCBkY3NzX2R0Z19jc3Nfc2V0KHN0cnVjdCBkY3NzX2R0
ZyAqZHRnKQo+ICt7Cj4gKyAgICAgICBkdGctPmNvbnRyb2xfc3RhdHVzIHw9Cj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgKDB4NSA8PCBDU1NfUElYX0NPTVBfU1dBUF9QT1MpICYgQ1NTX1BJWF9D
T01QX1NXQVBfTUFTSzsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgZGNzc19kdGdfZGlzYWJsZV9j
YWxsYmFjayh2b2lkICpkYXRhKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZGNzc19kdGcgKmR0ZyA9
IGRhdGE7Cj4gKwo+ICsgICAgICAgZHRnLT5jb250cm9sX3N0YXR1cyAmPSB+RFRHX1NUQVJUOwo+
ICsKPiArICAgICAgIGRjc3Nfd3JpdGVsKGR0Zy0+Y29udHJvbF9zdGF0dXMsCj4gKyAgICAgICAg
ICAgICAgICAgICBkdGctPmJhc2VfcmVnICsgRENTU19EVEdfVENfQ09OVFJPTF9TVEFUVVMpOwo+
ICsKPiArICAgICAgIGR0Zy0+aW5fdXNlID0gZmFsc2U7Cj4gKwo+ICsgICAgICAgY29tcGxldGUo
ZHRnLT5kaXNfY29tcGxldGlvbik7Cj4gK30KPiArCj4gK3ZvaWQgZGNzc19kdGdfZW5hYmxlKHN0
cnVjdCBkY3NzX2R0ZyAqZHRnLCBib29sIGVuLAo+ICsgICAgICAgICAgICAgICAgICAgIHN0cnVj
dCBjb21wbGV0aW9uICpkaXNfY29tcGxldGlvbikKPiArewo+ICsgICAgICAgaWYgKCFlbikgewo+
ICsgICAgICAgICAgICAgICBkdGctPmRpc19jb21wbGV0aW9uID0gZGlzX2NvbXBsZXRpb247Cj4g
KyAgICAgICAgICAgICAgIGRjc3NfY3R4bGRfcmVnaXN0ZXJfZHRnX2Rpc2FibGVfY2IoZHRnLT5j
dHhsZCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBkY3NzX2R0Z19kaXNhYmxlX2NhbGxiYWNrLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGR0Zyk7Cj4gKyAgICAgICAgICAgICAgIHJldHVybjsK
PiArICAgICAgIH0KPiArCj4gKyAgICAgICBkdGctPmRpc19jb21wbGV0aW9uID0gTlVMTDsKPiAr
Cj4gKyAgICAgICBkdGctPmNvbnRyb2xfc3RhdHVzIHw9IERUR19TVEFSVDsKPiArCj4gKyAgICAg
ICBkY3NzX2R0Z193cml0ZShkdGcsIGR0Zy0+Y29udHJvbF9zdGF0dXMsIERDU1NfRFRHX1RDX0NP
TlRST0xfU1RBVFVTKTsKPiArCj4gKyAgICAgICBkdGctPmluX3VzZSA9IHRydWU7Cj4gK30KPiAr
Cj4gK2Jvb2wgZGNzc19kdGdfaXNfZW5hYmxlZChzdHJ1Y3QgZGNzc19kdGcgKmR0ZykKPiArewo+
ICsgICAgICAgcmV0dXJuIGR0Zy0+aW5fdXNlOwo+ICt9Cj4gKwo+ICt2b2lkIGRjc3NfZHRnX2No
X2VuYWJsZShzdHJ1Y3QgZGNzc19kdGcgKmR0ZywgaW50IGNoX251bSwgYm9vbCBlbikKPiArewo+
ICsgICAgICAgdTMyIGNoX2VuX21hcFtdID0ge0NIMV9FTiwgQ0gyX0VOLCBDSDNfRU59Owo+ICsg
ICAgICAgdTMyIGNvbnRyb2xfc3RhdHVzOwo+ICsKPiArICAgICAgIGNvbnRyb2xfc3RhdHVzID0g
ZHRnLT5jb250cm9sX3N0YXR1cyAmIH5jaF9lbl9tYXBbY2hfbnVtXTsKPiArICAgICAgIGNvbnRy
b2xfc3RhdHVzIHw9IGVuID8gY2hfZW5fbWFwW2NoX251bV0gOiAwOwo+ICsKPiArICAgICAgIGlm
IChkdGctPmNvbnRyb2xfc3RhdHVzICE9IGNvbnRyb2xfc3RhdHVzKQo+ICsgICAgICAgICAgICAg
ICBkY3NzX2R0Z193cml0ZShkdGcsIGNvbnRyb2xfc3RhdHVzLCBEQ1NTX0RUR19UQ19DT05UUk9M
X1NUQVRVUyk7Cj4gKwo+ICsgICAgICAgZHRnLT5jb250cm9sX3N0YXR1cyA9IGNvbnRyb2xfc3Rh
dHVzOwo+ICt9Cj4gKwo+ICt2b2lkIGRjc3NfZHRnX3ZibGFua19pcnFfZW5hYmxlKHN0cnVjdCBk
Y3NzX2R0ZyAqZHRnLCBib29sIGVuKQo+ICt7Cj4gKyAgICAgICB1MzIgc3RhdHVzOwo+ICsKPiAr
ICAgICAgIGRjc3NfdXBkYXRlKExJTkUxX0lSUSwgTElORTFfSVJRLCBkdGctPmJhc2VfcmVnICsg
RENTU19EVEdfSU5UX01BU0spOwo+ICsKPiArICAgICAgIGlmIChlbikgewo+ICsgICAgICAgICAg
ICAgICBzdGF0dXMgPSBkY3NzX3JlYWRsKGR0Zy0+YmFzZV9yZWcgKyBEQ1NTX0RUR19JTlRfU1RB
VFVTKTsKPiArICAgICAgICAgICAgICAgZGNzc193cml0ZWwoc3RhdHVzICYgTElORTFfSVJRLAo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICBkdGctPmJhc2VfcmVnICsgRENTU19EVEdfSU5U
X0NPTlRST0wpOwo+ICsgICAgICAgfQo+ICt9Cj4gKwo+ICt2b2lkIGRjc3NfZHRnX2N0eGxkX2tp
Y2tfaXJxX2VuYWJsZShzdHJ1Y3QgZGNzc19kdGcgKmR0ZywgYm9vbCBlbikKPiArewo+ICsgICAg
ICAgdTMyIHN0YXR1czsKPiArCj4gKyAgICAgICBpZiAoZW4pIHsKPiArICAgICAgICAgICAgICAg
c3RhdHVzID0gZGNzc19yZWFkbChkdGctPmJhc2VfcmVnICsgRENTU19EVEdfSU5UX1NUQVRVUyk7
Cj4gKwo+ICsgICAgICAgICAgICAgICBpZiAoIWR0Zy0+Y3R4bGRfa2lja19pcnFfZW4pIHsKPiAr
ICAgICAgICAgICAgICAgICAgICAgICBkY3NzX3dyaXRlbChzdGF0dXMgJiBMSU5FMF9JUlEsCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHRnLT5iYXNlX3JlZyArIERDU1Nf
RFRHX0lOVF9DT05UUk9MKTsKPiArICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVfaXJxKGR0
Zy0+Y3R4bGRfa2lja19pcnEpOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIGR0Zy0+Y3R4bGRf
a2lja19pcnFfZW4gPSB0cnVlOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKPiAr
ICAgICAgICAgICAgICAgfQo+ICsKPiArICAgICAgICAgICAgICAgcmV0dXJuOwo+ICsgICAgICAg
fQo+ICsKPiArICAgICAgIGlmICghZHRnLT5jdHhsZF9raWNrX2lycV9lbikKPiArICAgICAgICAg
ICAgICAgcmV0dXJuOwo+ICsKPiArICAgICAgIGRpc2FibGVfaXJxX25vc3luYyhkdGctPmN0eGxk
X2tpY2tfaXJxKTsKPiArICAgICAgIGR0Zy0+Y3R4bGRfa2lja19pcnFfZW4gPSBmYWxzZTsKPiAr
fQo+ICsKPiArdm9pZCBkY3NzX2R0Z192YmxhbmtfaXJxX2NsZWFyKHN0cnVjdCBkY3NzX2R0ZyAq
ZHRnKQo+ICt7Cj4gKyAgICAgICBkY3NzX3VwZGF0ZShMSU5FMV9JUlEsIExJTkUxX0lSUSwgZHRn
LT5iYXNlX3JlZyArIERDU1NfRFRHX0lOVF9DT05UUk9MKTsKPiArfQo+ICsKPiArYm9vbCBkY3Nz
X2R0Z192YmxhbmtfaXJxX3ZhbGlkKHN0cnVjdCBkY3NzX2R0ZyAqZHRnKQo+ICt7Cj4gKyAgICAg
ICByZXR1cm4gISEoZGNzc19yZWFkbChkdGctPmJhc2VfcmVnICsgRENTU19EVEdfSU5UX1NUQVRV
UykgJiBMSU5FMV9JUlEpOwo+ICt9Cj4gKwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aW14L2Rjc3MvZGNzcy1rbXMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pbXgvZGNzcy9kY3NzLWttcy5j
Cj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRleCAwMDAwMDAwMC4uZDNiYzg4OQo+IC0tLSAv
ZGV2L251bGwKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaW14L2Rjc3MvZGNzcy1rbXMuYwo+IEBA
IC0wLDAgKzEsMzIxIEBACj4gKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCj4g
Ky8qCj4gKyAqIENvcHlyaWdodCAyMDE5IE5YUC4KPiArICovCj4gKwo+ICsjaW5jbHVkZSA8ZHJt
L2RybV9hdG9taWMuaD4KPiArI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljX2hlbHBlci5oPgo+ICsj
aW5jbHVkZSA8ZHJtL2RybV9mYl9oZWxwZXIuaD4KPiArI2luY2x1ZGUgPGRybS9kcm1fZ2VtX2Nt
YV9oZWxwZXIuaD4KPiArI2luY2x1ZGUgPGRybS9kcm1fZ2VtX2ZyYW1lYnVmZmVyX2hlbHBlci5o
Pgo+ICsjaW5jbHVkZSA8ZHJtL2RybV9vZi5oPgo+ICsjaW5jbHVkZSA8ZHJtL2RybV9wcm9iZV9o
ZWxwZXIuaD4KPiArI2luY2x1ZGUgPGRybS9kcm1QLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9jb21w
b25lbnQuaD4KPiArCj4gKyNpbmNsdWRlICJkY3NzLWRldi5oIgo+ICsjaW5jbHVkZSAiZGNzcy1r
bXMuaCIKPiArCj4gK0RFRklORV9EUk1fR0VNX0NNQV9GT1BTKGRjc3NfY21hX2ZvcHMpOwo+ICsK
PiArc3RydWN0IGRjc3NfZHJtX2NvbW1pdCB7Cj4gKyAgICAgICBzdHJ1Y3Qgd29ya19zdHJ1Y3Qg
d29yazsKPiArICAgICAgIHN0cnVjdCBkcm1fZGV2aWNlICpkcm07Cj4gKyAgICAgICBzdHJ1Y3Qg
ZHJtX2F0b21pY19zdGF0ZSAqc3RhdGU7Cj4gK307Cj4gKwo+ICtzdGF0aWMgdm9pZCBkY3NzX2Ry
bV9hdG9taWNfY29tbWl0X3RhaWwoc3RydWN0IGRjc3NfZHJtX2NvbW1pdCAqY29tbWl0KQo+ICt7
Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUgPSBjb21taXQtPnN0YXRl
Owo+ICsgICAgICAgc3RydWN0IGRybV9kZXZpY2UgKmRybSA9IGNvbW1pdC0+ZHJtOwo+ICsgICAg
ICAgc3RydWN0IGRjc3Nfa21zX2RldiAqa21zID0gY29udGFpbmVyX29mKGRybSwgc3RydWN0IGRj
c3Nfa21zX2RldiwgYmFzZSk7Cj4gKwo+ICsgICAgICAgZHJtX2F0b21pY19oZWxwZXJfd2FpdF9m
b3JfZmVuY2VzKGRybSwgc3RhdGUsIGZhbHNlKTsKPiArCj4gKyAgICAgICBkcm1fYXRvbWljX2hl
bHBlcl93YWl0X2Zvcl9kZXBlbmRlbmNpZXMoc3RhdGUpOwo+ICsKPiArICAgICAgIGRybV9hdG9t
aWNfaGVscGVyX2NvbW1pdF9tb2Rlc2V0X2Rpc2FibGVzKGRybSwgc3RhdGUpOwo+ICsKPiArICAg
ICAgIGRybV9hdG9taWNfaGVscGVyX2NvbW1pdF9tb2Rlc2V0X2VuYWJsZXMoZHJtLCBzdGF0ZSk7
Cj4gKwo+ICsgICAgICAgZHJtX2F0b21pY19oZWxwZXJfY29tbWl0X3BsYW5lcyhkcm0sIHN0YXRl
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEUk1fUExBTkVfQ09N
TUlUX0FDVElWRV9PTkxZKTsKPiArCj4gKyAgICAgICBkcm1fYXRvbWljX2hlbHBlcl9jb21taXRf
aHdfZG9uZShzdGF0ZSk7Cj4gKwo+ICsgICAgICAgZHJtX2F0b21pY19oZWxwZXJfd2FpdF9mb3Jf
dmJsYW5rcyhkcm0sIHN0YXRlKTsKPiArCj4gKyAgICAgICBkcm1fYXRvbWljX2hlbHBlcl9jbGVh
bnVwX3BsYW5lcyhkcm0sIHN0YXRlKTsKPiArCj4gKyAgICAgICBkcm1fYXRvbWljX2hlbHBlcl9j
b21taXRfY2xlYW51cF9kb25lKHN0YXRlKTsKPiArCj4gKyAgICAgICBkcm1fYXRvbWljX3N0YXRl
X3B1dChzdGF0ZSk7Cj4gKwo+ICsgICAgICAgc3Bpbl9sb2NrKCZrbXMtPmNvbW1pdC53YWl0Lmxv
Y2spOwo+ICsgICAgICAga21zLT5jb21taXQucGVuZGluZyA9IGZhbHNlOwo+ICsgICAgICAgd2Fr
ZV91cF9hbGxfbG9ja2VkKCZrbXMtPmNvbW1pdC53YWl0KTsKPiArICAgICAgIHNwaW5fdW5sb2Nr
KCZrbXMtPmNvbW1pdC53YWl0LmxvY2spOwo+ICsKPiArICAgICAgIGtmcmVlKGNvbW1pdCk7Cj4g
K30KPiArCj4gK3N0YXRpYyB2b2lkIGRjc3NfY29tbWl0X3dvcmsoc3RydWN0IHdvcmtfc3RydWN0
ICp3b3JrKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZGNzc19kcm1fY29tbWl0ICpjb21taXQgPSBj
b250YWluZXJfb2Yod29yaywKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzdHJ1Y3QgZGNzc19kcm1fY29tbWl0LAo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmspOwo+ICsKPiArICAg
ICAgIGRjc3NfZHJtX2F0b21pY19jb21taXRfdGFpbChjb21taXQpOwo+ICt9Cj4gKwo+ICtzdGF0
aWMgaW50IGRjc3NfZHJtX2F0b21pY19jb21taXQoc3RydWN0IGRybV9kZXZpY2UgKmRybSwKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGRybV9hdG9taWNfc3RhdGUg
KnN0YXRlLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sIG5vbmJsb2Nr
KQo+ICt7Cj4gKyAgICAgICBpbnQgcmV0Owo+ICsgICAgICAgc3RydWN0IGRjc3Nfa21zX2RldiAq
a21zID0gY29udGFpbmVyX29mKGRybSwgc3RydWN0IGRjc3Nfa21zX2RldiwgYmFzZSk7Cj4gKyAg
ICAgICBzdHJ1Y3QgZGNzc19kcm1fY29tbWl0ICpjb21taXQ7Cj4gKwo+ICsgICAgICAgaWYgKHN0
YXRlLT5hc3luY191cGRhdGUpIHsKPiArICAgICAgICAgICAgICAgcmV0ID0gZHJtX2F0b21pY19o
ZWxwZXJfcHJlcGFyZV9wbGFuZXMoZHJtLCBzdGF0ZSk7Cj4gKyAgICAgICAgICAgICAgIGlmIChy
ZXQpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKPiArCj4gKyAgICAgICAg
ICAgICAgIGRybV9hdG9taWNfaGVscGVyX2FzeW5jX2NvbW1pdChkcm0sIHN0YXRlKTsKPiArICAg
ICAgICAgICAgICAgZHJtX2F0b21pY19oZWxwZXJfY2xlYW51cF9wbGFuZXMoZHJtLCBzdGF0ZSk7
Cj4gKwo+ICsgICAgICAgICAgICAgICByZXR1cm4gMDsKPiArICAgICAgIH0KPiArCj4gKyAgICAg
ICBjb21taXQgPSBremFsbG9jKHNpemVvZigqY29tbWl0KSwgR0ZQX0tFUk5FTCk7Cj4gKyAgICAg
ICBpZiAoIWNvbW1pdCkKPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsg
ICAgICAgY29tbWl0LT5kcm0gPSBkcm07Cj4gKyAgICAgICBjb21taXQtPnN0YXRlID0gc3RhdGU7
Cj4gKwo+ICsgICAgICAgcmV0ID0gZHJtX2F0b21pY19oZWxwZXJfc2V0dXBfY29tbWl0KHN0YXRl
LCBub25ibG9jayk7Cj4gKyAgICAgICBpZiAocmV0KQo+ICsgICAgICAgICAgICAgICBnb3RvIGVy
cl9mcmVlOwo+ICsKPiArICAgICAgIElOSVRfV09SSygmY29tbWl0LT53b3JrLCBkY3NzX2NvbW1p
dF93b3JrKTsKPiArCj4gKyAgICAgICByZXQgPSBkcm1fYXRvbWljX2hlbHBlcl9wcmVwYXJlX3Bs
YW5lcyhkcm0sIHN0YXRlKTsKPiArICAgICAgIGlmIChyZXQpCj4gKyAgICAgICAgICAgICAgIGdv
dG8gZXJyX2ZyZWU7Cj4gKwo+ICsgICAgICAgaWYgKCFub25ibG9jaykgewo+ICsgICAgICAgICAg
ICAgICByZXQgPSBkcm1fYXRvbWljX2hlbHBlcl93YWl0X2Zvcl9mZW5jZXMoZHJtLCBzdGF0ZSwg
dHJ1ZSk7Cj4gKyAgICAgICAgICAgICAgIGlmIChyZXQpCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgZ290byBlcnI7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgc3Bpbl9sb2NrKCZrbXMtPmNv
bW1pdC53YWl0LmxvY2spOwo+ICsgICAgICAgcmV0ID0gd2FpdF9ldmVudF9pbnRlcnJ1cHRpYmxl
X2xvY2tlZChrbXMtPmNvbW1pdC53YWl0LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAha21zLT5jb21taXQucGVuZGluZyk7Cj4gKyAgICAgICBpZiAocmV0
ID09IDApCj4gKyAgICAgICAgICAgICAgIGttcy0+Y29tbWl0LnBlbmRpbmcgPSB0cnVlOwo+ICsg
ICAgICAgc3Bpbl91bmxvY2soJmttcy0+Y29tbWl0LndhaXQubG9jayk7Cj4gKwo+ICsgICAgICAg
aWYgKHJldCkKPiArICAgICAgICAgICAgICAgZ290byBlcnI7Cj4gKwo+ICsgICAgICAgcmV0ID0g
ZHJtX2F0b21pY19oZWxwZXJfc3dhcF9zdGF0ZShzdGF0ZSwgdHJ1ZSk7Cj4gKyAgICAgICBpZiAo
cmV0KQo+ICsgICAgICAgICAgICAgICBnb3RvIGVycjsKPiArCj4gKyAgICAgICBkcm1fYXRvbWlj
X3N0YXRlX2dldChzdGF0ZSk7Cj4gKyAgICAgICBpZiAobm9uYmxvY2spCj4gKyAgICAgICAgICAg
ICAgIHF1ZXVlX3dvcmsoa21zLT5jb21taXRfd3EsICZjb21taXQtPndvcmspOwo+ICsgICAgICAg
ZWxzZQo+ICsgICAgICAgICAgICAgICBkY3NzX2RybV9hdG9taWNfY29tbWl0X3RhaWwoY29tbWl0
KTsKPiArCj4gKyAgICAgICByZXR1cm4gMDsKPiArCj4gK2VycjoKPiArICAgICAgIGRybV9hdG9t
aWNfaGVscGVyX2NsZWFudXBfcGxhbmVzKGRybSwgc3RhdGUpOwo+ICsKPiArZXJyX2ZyZWU6Cj4g
KyAgICAgICBrZnJlZShjb21taXQpOwo+ICsgICAgICAgcmV0dXJuIHJldDsKPiArfQo+ICsKPiAr
Y29uc3Qgc3RydWN0IGRybV9tb2RlX2NvbmZpZ19mdW5jcyBkY3NzX2RybV9tb2RlX2NvbmZpZ19m
dW5jcyA9IHsKPiArICAgICAgIC5mYl9jcmVhdGUgPSBkcm1fZ2VtX2ZiX2NyZWF0ZSwKPiArICAg
ICAgIC5vdXRwdXRfcG9sbF9jaGFuZ2VkID0gZHJtX2ZiX2hlbHBlcl9vdXRwdXRfcG9sbF9jaGFu
Z2VkLAo+ICsgICAgICAgLmF0b21pY19jaGVjayA9IGRybV9hdG9taWNfaGVscGVyX2NoZWNrLAo+
ICsgICAgICAgLmF0b21pY19jb21taXQgPSBkY3NzX2RybV9hdG9taWNfY29tbWl0LAo+ICt9Owo+
ICsKPiArc3RhdGljIHN0cnVjdCBkcm1fZHJpdmVyIGRjc3Nfa21zX2RyaXZlciA9IHsKPiArICAg
ICAgIC5kcml2ZXJfZmVhdHVyZXMgICAgICAgID0gRFJJVkVSX01PREVTRVQgfCBEUklWRVJfR0VN
IHwgRFJJVkVSX0FUT01JQywKPiArICAgICAgIC5nZW1fZnJlZV9vYmplY3RfdW5sb2NrZWQgPSBk
cm1fZ2VtX2NtYV9mcmVlX29iamVjdCwKPiArICAgICAgIC5nZW1fdm1fb3BzICAgICAgICAgICAg
ID0gJmRybV9nZW1fY21hX3ZtX29wcywKPiArICAgICAgIC5kdW1iX2NyZWF0ZSAgICAgICAgICAg
ID0gZHJtX2dlbV9jbWFfZHVtYl9jcmVhdGUsCj4gKwo+ICsgICAgICAgLnByaW1lX2hhbmRsZV90
b19mZCAgICAgPSBkcm1fZ2VtX3ByaW1lX2hhbmRsZV90b19mZCwKPiArICAgICAgIC5wcmltZV9m
ZF90b19oYW5kbGUgICAgID0gZHJtX2dlbV9wcmltZV9mZF90b19oYW5kbGUsCj4gKyAgICAgICAu
Z2VtX3ByaW1lX2ltcG9ydCAgICAgICA9IGRybV9nZW1fcHJpbWVfaW1wb3J0LAo+ICsgICAgICAg
LmdlbV9wcmltZV9leHBvcnQgICAgICAgPSBkcm1fZ2VtX3ByaW1lX2V4cG9ydCwKPiArICAgICAg
IC5nZW1fcHJpbWVfZ2V0X3NnX3RhYmxlID0gZHJtX2dlbV9jbWFfcHJpbWVfZ2V0X3NnX3RhYmxl
LAo+ICsgICAgICAgLmdlbV9wcmltZV9pbXBvcnRfc2dfdGFibGUgPSBkcm1fZ2VtX2NtYV9wcmlt
ZV9pbXBvcnRfc2dfdGFibGUsCj4gKyAgICAgICAuZ2VtX3ByaW1lX3ZtYXAgICAgICAgICA9IGRy
bV9nZW1fY21hX3ByaW1lX3ZtYXAsCj4gKyAgICAgICAuZ2VtX3ByaW1lX3Z1bm1hcCAgICAgICA9
IGRybV9nZW1fY21hX3ByaW1lX3Z1bm1hcCwKPiArICAgICAgIC5nZW1fcHJpbWVfbW1hcCAgICAg
ICAgID0gZHJtX2dlbV9jbWFfcHJpbWVfbW1hcCwKPiArICAgICAgIC5mb3BzICAgICAgICAgICAg
ICAgICAgID0gJmRjc3NfY21hX2ZvcHMsCj4gKyAgICAgICAubmFtZSAgICAgICAgICAgICAgICAg
ICA9ICJpbXgtZGNzcyIsCj4gKyAgICAgICAuZGVzYyAgICAgICAgICAgICAgICAgICA9ICJpLk1Y
OE1RIERpc3BsYXkgU3Vic3lzdGVtIiwKPiArICAgICAgIC5kYXRlICAgICAgICAgICAgICAgICAg
ID0gIjIwMTkwOTE3IiwKPiArICAgICAgIC5tYWpvciAgICAgICAgICAgICAgICAgID0gMSwKPiAr
ICAgICAgIC5taW5vciAgICAgICAgICAgICAgICAgID0gMCwKPiArICAgICAgIC5wYXRjaGxldmVs
ICAgICAgICAgICAgID0gMCwKPiArfTsKPiArCj4gK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX21v
ZGVfY29uZmlnX2hlbHBlcl9mdW5jcyBkY3NzX21vZGVfY29uZmlnX2hlbHBlcnMgPSB7Cj4gKyAg
ICAgICAuYXRvbWljX2NvbW1pdF90YWlsID0gZHJtX2F0b21pY19oZWxwZXJfY29tbWl0X3RhaWxf
cnBtLAo+ICt9Owo+ICsKPiArc3RhdGljIHZvaWQgZGNzc19rbXNfbW9kZV9jb25maWdfaW5pdChz
dHJ1Y3QgZGNzc19rbXNfZGV2ICprbXMpCj4gK3sKPiArICAgICAgIHN0cnVjdCBkcm1fbW9kZV9j
b25maWcgKmNvbmZpZyA9ICZrbXMtPmJhc2UubW9kZV9jb25maWc7Cj4gKwo+ICsgICAgICAgZHJt
X21vZGVfY29uZmlnX2luaXQoJmttcy0+YmFzZSk7Cj4gKwo+ICsgICAgICAgY29uZmlnLT5taW5f
d2lkdGggPSAxOwo+ICsgICAgICAgY29uZmlnLT5taW5faGVpZ2h0ID0gMTsKPiArICAgICAgIGNv
bmZpZy0+bWF4X3dpZHRoID0gNDA5NjsKPiArICAgICAgIGNvbmZpZy0+bWF4X2hlaWdodCA9IDQw
OTY7Cj4gKyAgICAgICBjb25maWctPmFsbG93X2ZiX21vZGlmaWVycyA9IHRydWU7Cj4gKyAgICAg
ICBjb25maWctPm5vcm1hbGl6ZV96cG9zID0gdHJ1ZTsKPiArCj4gKyAgICAgICBjb25maWctPmZ1
bmNzID0gJmRjc3NfZHJtX21vZGVfY29uZmlnX2Z1bmNzOwo+ICsgICAgICAgY29uZmlnLT5oZWxw
ZXJfcHJpdmF0ZSA9ICZkY3NzX21vZGVfY29uZmlnX2hlbHBlcnM7Cj4gK30KPiArCj4gK3N0YXRp
YyBjb25zdCBzdHJ1Y3QgZHJtX2VuY29kZXJfZnVuY3MgZGNzc19rbXNfc2ltcGxlX2VuY29kZXJf
ZnVuY3MgPSB7Cj4gKyAgICAgICAuZGVzdHJveSA9IGRybV9lbmNvZGVyX2NsZWFudXAsCj4gK307
Cj4gKwo+ICtzdGF0aWMgaW50IGRjc3Nfa21zX3NldHVwX2VuY29kZXIoc3RydWN0IGRjc3Nfa21z
X2RldiAqa21zKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9ICZrbXMt
PmJhc2U7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIgPSAma21zLT5lbmNv
ZGVyOwo+ICsgICAgICAgc3RydWN0IGRybV9jcnRjICpjcnRjID0gKHN0cnVjdCBkcm1fY3J0YyAq
KSZrbXMtPmNydGM7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbDsKPiArICAgICAg
IHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2U7Cj4gKyAgICAgICBpbnQgcmV0Owo+ICsKPiArICAg
ICAgIHJldCA9IGRybV9vZl9maW5kX3BhbmVsX29yX2JyaWRnZShkZGV2LT5kZXYtPm9mX25vZGUs
IDAsIDAsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJnBhbmVs
LCAmYnJpZGdlKTsKPiArICAgICAgIGlmIChyZXQpCj4gKyAgICAgICAgICAgICAgIHJldHVybiBy
ZXQ7Cj4gKwo+ICsgICAgICAgaWYgKCFicmlkZ2UpIHsKPiArICAgICAgICAgICAgICAgZGV2X2Vy
cihkZGV2LT5kZXYsICJObyBicmlkZ2UgZm91bmQgJWQuXG4iLCByZXQpOwo+ICsgICAgICAgICAg
ICAgICByZXR1cm4gLUVOT0RFVjsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICBlbmNvZGVyLT5w
b3NzaWJsZV9jcnRjcyA9IGRybV9jcnRjX21hc2soY3J0Yyk7Cj4gKwo+ICsgICAgICAgcmV0ID0g
ZHJtX2VuY29kZXJfaW5pdCgma21zLT5iYXNlLCBlbmNvZGVyLAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAmZGNzc19rbXNfc2ltcGxlX2VuY29kZXJfZnVuY3MsCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIERSTV9NT0RFX0VOQ09ERVJfTk9ORSwgTlVMTCk7Cj4gKyAg
ICAgICBpZiAocmV0KSB7Cj4gKyAgICAgICAgICAgICAgIGRldl9lcnIoZGRldi0+ZGV2LCAiRmFp
bGVkIGluaXRpYWxpemluZyBlbmNvZGVyICVkLlxuIiwgcmV0KTsKPiArICAgICAgICAgICAgICAg
cmV0dXJuIHJldDsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICByZXR1cm4gZHJtX2JyaWRnZV9h
dHRhY2goZW5jb2RlciwgYnJpZGdlLCBOVUxMKTsKPiArfQo+ICsKPiArc3RydWN0IGRjc3Nfa21z
X2RldiAqZGNzc19rbXNfYXR0YWNoKHN0cnVjdCBkY3NzX2RldiAqZGNzcywgYm9vbCBjb21wb25l
bnRpemVkKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZGNzc19rbXNfZGV2ICprbXMgPSBremFsbG9j
KHNpemVvZigqa21zKSwgR0ZQX0tFUk5FTCk7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX2RldmljZSAq
ZHJtOwo+ICsgICAgICAgc3RydWN0IGRjc3NfY3J0YyAqY3J0YzsKPiArICAgICAgIGludCByZXQ7
Cj4gKwo+ICsgICAgICAgaWYgKCFrbXMpCj4gKyAgICAgICAgICAgICAgIHJldHVybiBFUlJfUFRS
KC1FTk9NRU0pOwo+ICsKPiArICAgICAgIGRybSA9ICZrbXMtPmJhc2U7Cj4gKyAgICAgICBjcnRj
ID0gJmttcy0+Y3J0YzsKPiArICAgICAgIHJldCA9IGRybV9kZXZfaW5pdChkcm0sICZkY3NzX2tt
c19kcml2ZXIsIGRjc3MtPmRldik7Cj4gKyAgICAgICBpZiAocmV0KQo+ICsgICAgICAgICAgICAg
ICBnb3RvIGZyZWVfa21zOwo+ICsKPiArICAgICAgIGRybS0+ZGV2X3ByaXZhdGUgPSBkY3NzOwo+
ICsKPiArICAgICAgIGRjc3Nfa21zX21vZGVfY29uZmlnX2luaXQoa21zKTsKPiArCj4gKyAgICAg
ICByZXQgPSBkcm1fdmJsYW5rX2luaXQoZHJtLCAxKTsKPiArICAgICAgIGlmIChyZXQpCj4gKyAg
ICAgICAgICAgICAgIGdvdG8gY2xlYW51cF9tb2RlX2NvbmZpZzsKPiArCj4gKyAgICAgICBkcm0t
PmlycV9lbmFibGVkID0gdHJ1ZTsKPiArCj4gKyAgICAgICByZXQgPSBkY3NzX2NydGNfaW5pdChj
cnRjLCBkcm0pOwo+ICsgICAgICAgaWYgKHJldCkKPiArICAgICAgICAgICAgICAgZ290byBjbGVh
bnVwX21vZGVfY29uZmlnOwo+ICsKPiArICAgICAgIGttcy0+Y29tbWl0X3dxID0gYWxsb2Nfb3Jk
ZXJlZF93b3JrcXVldWUoImRjc3Nfbm9uYmxvY2tfY29tbWl0X3dxIiwgMCk7Cj4gKyAgICAgICBp
ZiAoIWttcy0+Y29tbWl0X3dxKSB7Cj4gKyAgICAgICAgICAgICAgIHJldCA9IC1FTk9NRU07Cj4g
KyAgICAgICAgICAgICAgIGdvdG8gY2xlYW51cF9jcnRjOwo+ICsgICAgICAgfQo+ICsKPiArICAg
ICAgIGluaXRfd2FpdHF1ZXVlX2hlYWQoJmttcy0+Y29tbWl0LndhaXQpOwo+ICsKPiArICAgICAg
IGlmIChjb21wb25lbnRpemVkKQo+ICsgICAgICAgICAgICAgICByZXQgPSBjb21wb25lbnRfYmlu
ZF9hbGwoZGNzcy0+ZGV2LCBrbXMpOwo+ICsgICAgICAgZWxzZQo+ICsgICAgICAgICAgICAgICBy
ZXQgPSBkY3NzX2ttc19zZXR1cF9lbmNvZGVyKGttcyk7Cj4gKwo+ICsgICAgICAgaWYgKHJldCkK
PiArICAgICAgICAgICAgICAgZ290byBjbGVhbnVwX3dxOwo+ICsKPiArICAgICAgIGRybV9tb2Rl
X2NvbmZpZ19yZXNldChkcm0pOwo+ICsKPiArICAgICAgIGRybV9rbXNfaGVscGVyX3BvbGxfaW5p
dChkcm0pOwo+ICsKPiArICAgICAgIHJldCA9IGRybV9kZXZfcmVnaXN0ZXIoZHJtLCAwKTsKPiAr
ICAgICAgIGlmIChyZXQpCj4gKyAgICAgICAgICAgICAgIGdvdG8gY2xlYW51cF93cTsKPiArCj4g
KyAgICAgICBkcm1fZmJkZXZfZ2VuZXJpY19zZXR1cChkcm0sIDMyKTsKPiArCj4gKyAgICAgICBy
ZXR1cm4ga21zOwo+ICsKPiArY2xlYW51cF93cToKPiArICAgICAgIGRybV9rbXNfaGVscGVyX3Bv
bGxfZmluaShkcm0pOwo+ICsgICAgICAgZGVzdHJveV93b3JrcXVldWUoa21zLT5jb21taXRfd3Ep
Owo+ICsKPiArY2xlYW51cF9jcnRjOgo+ICsgICAgICAgZGNzc19jcnRjX2RlaW5pdChjcnRjLCBk
cm0pOwo+ICsKPiArY2xlYW51cF9tb2RlX2NvbmZpZzoKPiArICAgICAgIGRybV9tb2RlX2NvbmZp
Z19jbGVhbnVwKGRybSk7Cj4gKwo+ICtmcmVlX2ttczoKPiArICAgICAgIGtmcmVlKGttcyk7Cj4g
KyAgICAgICByZXR1cm4gRVJSX1BUUihyZXQpOwo+ICt9Cj4gKwo+ICt2b2lkIGRjc3Nfa21zX2Rl
dGFjaChzdHJ1Y3QgZGNzc19rbXNfZGV2ICprbXMsIGJvb2wgY29tcG9uZW50aXplZCkKPiArewo+
ICsgICAgICAgc3RydWN0IGRybV9kZXZpY2UgKmRybSA9ICZrbXMtPmJhc2U7Cj4gKyAgICAgICBz
dHJ1Y3QgZGNzc19kZXYgKmRjc3MgPSBkcm0tPmRldl9wcml2YXRlOwo+ICsKPiArICAgICAgIGRy
bV9kZXZfdW5yZWdpc3Rlcihkcm0pOwo+ICsgICAgICAgZHJtX2ttc19oZWxwZXJfcG9sbF9maW5p
KGRybSk7Cj4gKyAgICAgICBkcm1fYXRvbWljX2hlbHBlcl9zaHV0ZG93bihkcm0pOwo+ICsgICAg
ICAgZHJtX2NydGNfdmJsYW5rX29mZigma21zLT5jcnRjLmJhc2UpOwo+ICsgICAgICAgZHJtLT5p
cnFfZW5hYmxlZCA9IGZhbHNlOwo+ICsgICAgICAgZHJtX21vZGVfY29uZmlnX2NsZWFudXAoZHJt
KTsKPiArICAgICAgIGRlc3Ryb3lfd29ya3F1ZXVlKGttcy0+Y29tbWl0X3dxKTsKPiArICAgICAg
IGRjc3NfY3J0Y19kZWluaXQoJmttcy0+Y3J0YywgZHJtKTsKPiArICAgICAgIGlmIChjb21wb25l
bnRpemVkKQo+ICsgICAgICAgICAgICAgICBjb21wb25lbnRfdW5iaW5kX2FsbChkY3NzLT5kZXYs
IGRybSk7Cj4gKyAgICAgICBkcm0tPmRldl9wcml2YXRlID0gTlVMTDsKPiArICAgICAgIGRybV9k
ZXZfcHV0KGRybSk7Cj4gK30KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2lteC9kY3Nz
L2Rjc3Mta21zLmggYi9kcml2ZXJzL2dwdS9kcm0vaW14L2Rjc3MvZGNzcy1rbXMuaAo+IG5ldyBm
aWxlIG1vZGUgMTAwNjQ0Cj4gaW5kZXggMDAwMDAwMDAuLjYyOTcwMDUKPiAtLS0gL2Rldi9udWxs
Cj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2lteC9kY3NzL2Rjc3Mta21zLmgKPiBAQCAtMCwwICsx
LDUyIEBACj4gKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovCj4gKy8qCj4g
KyAqIENvcHlyaWdodCAyMDE5IE5YUC4KPiArICovCj4gKwo+ICsjaWZuZGVmIF9EQ1NTX0tNU19I
Xwo+ICsjZGVmaW5lIF9EQ1NTX0tNU19IXwo+ICsKPiArI2luY2x1ZGUgPGRybS9kcm1fZW5jb2Rl
ci5oPgo+ICsKPiArc3RydWN0IGRjc3NfcGxhbmUgewo+ICsgICAgICAgc3RydWN0IGRybV9wbGFu
ZSBiYXNlOwo+ICsKPiArICAgICAgIGludCBjaF9udW07Cj4gK307Cj4gKwo+ICtzdHJ1Y3QgZGNz
c19jcnRjIHsKPiArICAgICAgIHN0cnVjdCBkcm1fY3J0YyAgICAgICAgIGJhc2U7Cj4gKyAgICAg
ICBzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgICAqc3RhdGU7Cj4gKwo+ICsgICAgICAgc3RydWN0IGRj
c3NfcGxhbmUgICAgICAgKnBsYW5lWzNdOwo+ICsKPiArICAgICAgIGludCAgICAgICAgICAgICAg
ICAgICAgIGlycTsKPiArICAgICAgIGJvb2wgICAgICAgICAgICAgICAgICAgIGlycV9lbmFibGVk
Owo+ICsKPiArICAgICAgIHN0cnVjdCBjb21wbGV0aW9uIGVuX2NvbXBsZXRpb247Cj4gKyAgICAg
ICBzdHJ1Y3QgY29tcGxldGlvbiBkaXNfY29tcGxldGlvbjsKPiArfTsKPiArCj4gK3N0cnVjdCBj
b21taXQgewo+ICsgICAgICAgd2FpdF9xdWV1ZV9oZWFkX3Qgd2FpdDsKPiArICAgICAgIGJvb2wg
cGVuZGluZzsKPiArfTsKPiArCj4gK3N0cnVjdCBkY3NzX2ttc19kZXYgewo+ICsgICAgICAgc3Ry
dWN0IGRybV9kZXZpY2UgYmFzZTsKPiArICAgICAgIHN0cnVjdCBkY3NzX2NydGMgY3J0YzsKPiAr
ICAgICAgIHN0cnVjdCBkcm1fZW5jb2RlciBlbmNvZGVyOwo+ICsgICAgICAgc3RydWN0IHdvcmtx
dWV1ZV9zdHJ1Y3QgKmNvbW1pdF93cTsKPiArICAgICAgIHN0cnVjdCBjb21taXQgY29tbWl0Owo+
ICt9Owo+ICsKPiArc3RydWN0IGRjc3Nfa21zX2RldiAqZGNzc19rbXNfYXR0YWNoKHN0cnVjdCBk
Y3NzX2RldiAqZGNzcywgYm9vbCBjb21wb25lbnRpemVkKTsKPiArdm9pZCBkY3NzX2ttc19kZXRh
Y2goc3RydWN0IGRjc3Nfa21zX2RldiAqa21zLCBib29sIGNvbXBvbmVudGl6ZWQpOwo+ICtpbnQg
ZGNzc19jcnRjX2luaXQoc3RydWN0IGRjc3NfY3J0YyAqY3J0Yywgc3RydWN0IGRybV9kZXZpY2Ug
KmRybSk7Cj4gK3ZvaWQgZGNzc19jcnRjX2RlaW5pdChzdHJ1Y3QgZGNzc19jcnRjICpjcnRjLCBz
dHJ1Y3QgZHJtX2RldmljZSAqZHJtKTsKPiArc3RydWN0IGRjc3NfcGxhbmUgKmRjc3NfcGxhbmVf
aW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZHJtLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdW5zaWduZWQgaW50IHBvc3NpYmxlX2NydGNzLAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgZW51bSBkcm1fcGxhbmVfdHlwZSB0eXBlLAo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IHpwb3MpOwo+ICsKPiArI2VuZGlm
Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pbXgvZGNzcy9kY3NzLXBsYW5lLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaW14L2Rjc3MvZGNzcy1wbGFuZS5jCj4gbmV3IGZpbGUgbW9kZSAxMDA2
NDQKPiBpbmRleCAwMDAwMDAwMC4uY2IxOGMzZQo+IC0tLSAvZGV2L251bGwKPiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vaW14L2Rjc3MvZGNzcy1wbGFuZS5jCj4gQEAgLTAsMCArMSw0MTggQEAKPiAr
Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAKPiArLyoKPiArICogQ29weXJpZ2h0
IDIwMTkgTlhQLgo+ICsgKi8KPiArCj4gKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pYy5oPgo+ICsj
aW5jbHVkZSA8ZHJtL2RybV9hdG9taWNfaGVscGVyLmg+Cj4gKyNpbmNsdWRlIDxkcm0vZHJtX2Zi
X2NtYV9oZWxwZXIuaD4KPiArI2luY2x1ZGUgPGRybS9kcm1fZ2VtX2ZyYW1lYnVmZmVyX2hlbHBl
ci5oPgo+ICsjaW5jbHVkZSA8ZHJtL2RybV9nZW1fY21hX2hlbHBlci5oPgo+ICsKPiArI2luY2x1
ZGUgImRjc3MtZGV2LmgiCj4gKyNpbmNsdWRlICJkY3NzLWttcy5oIgo+ICsKPiArc3RhdGljIGNv
bnN0IHUzMiBkY3NzX2NvbW1vbl9mb3JtYXRzW10gPSB7Cj4gKyAgICAgICAvKiBSR0IgKi8KPiAr
ICAgICAgIERSTV9GT1JNQVRfQVJHQjg4ODgsCj4gKyAgICAgICBEUk1fRk9STUFUX1hSR0I4ODg4
LAo+ICsgICAgICAgRFJNX0ZPUk1BVF9BQkdSODg4OCwKPiArICAgICAgIERSTV9GT1JNQVRfWEJH
Ujg4ODgsCj4gKyAgICAgICBEUk1fRk9STUFUX1JHQkE4ODg4LAo+ICsgICAgICAgRFJNX0ZPUk1B
VF9SR0JYODg4OCwKPiArICAgICAgIERSTV9GT1JNQVRfQkdSQTg4ODgsCj4gKyAgICAgICBEUk1f
Rk9STUFUX0JHUlg4ODg4LAo+ICsgICAgICAgRFJNX0ZPUk1BVF9YUkdCMjEwMTAxMCwKPiArICAg
ICAgIERSTV9GT1JNQVRfWEJHUjIxMDEwMTAsCj4gKyAgICAgICBEUk1fRk9STUFUX1JHQlgxMDEw
MTAyLAo+ICsgICAgICAgRFJNX0ZPUk1BVF9CR1JYMTAxMDEwMiwKPiArICAgICAgIERSTV9GT1JN
QVRfQVJHQjIxMDEwMTAsCj4gKyAgICAgICBEUk1fRk9STUFUX0FCR1IyMTAxMDEwLAo+ICsgICAg
ICAgRFJNX0ZPUk1BVF9SR0JBMTAxMDEwMiwKPiArICAgICAgIERSTV9GT1JNQVRfQkdSQTEwMTAx
MDIsCj4gKwo+ICsgICAgICAgLyogWVVWNDQ0ICovCj4gKyAgICAgICBEUk1fRk9STUFUX0FZVVYs
Cj4gKwo+ICsgICAgICAgLyogWVVWNDIyICovCj4gKyAgICAgICBEUk1fRk9STUFUX1VZVlksCj4g
KyAgICAgICBEUk1fRk9STUFUX1ZZVVksCj4gKyAgICAgICBEUk1fRk9STUFUX1lVWVYsCj4gKyAg
ICAgICBEUk1fRk9STUFUX1lWWVUsCj4gKwo+ICsgICAgICAgLyogWVVWNDIwICovCj4gKyAgICAg
ICBEUk1fRk9STUFUX05WMTIsCj4gKyAgICAgICBEUk1fRk9STUFUX05WMjEsCj4gK307Cj4gKwo+
ICtzdGF0aWMgY29uc3QgdTY0IGRjc3NfdmlkZW9fZm9ybWF0X21vZGlmaWVyc1tdID0gewo+ICsg
ICAgICAgRFJNX0ZPUk1BVF9NT0RfTElORUFSLAo+ICsgICAgICAgRFJNX0ZPUk1BVF9NT0RfSU5W
QUxJRCwKPiArfTsKPiArCj4gK3N0YXRpYyBjb25zdCB1NjQgZGNzc19ncmFwaGljc19mb3JtYXRf
bW9kaWZpZXJzW10gPSB7Cj4gKyAgICAgICBEUk1fRk9STUFUX01PRF9WSVZBTlRFX1RJTEVELAo+
ICsgICAgICAgRFJNX0ZPUk1BVF9NT0RfVklWQU5URV9TVVBFUl9USUxFRCwKPiArICAgICAgIERS
TV9GT1JNQVRfTU9EX0xJTkVBUiwKPiArICAgICAgIERSTV9GT1JNQVRfTU9EX0lOVkFMSUQsCj4g
K307Cj4gKwo+ICtzdGF0aWMgaW5saW5lIHN0cnVjdCBkY3NzX3BsYW5lICp0b19kY3NzX3BsYW5l
KHN0cnVjdCBkcm1fcGxhbmUgKnApCj4gK3sKPiArICAgICAgIHJldHVybiBjb250YWluZXJfb2Yo
cCwgc3RydWN0IGRjc3NfcGxhbmUsIGJhc2UpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW5saW5lIGJv
b2wgZGNzc19wbGFuZV9mYl9pc19saW5lYXIoY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAq
ZmIpCj4gK3sKPiArICAgICAgIHJldHVybiAoKGZiLT5mbGFncyAmIERSTV9NT0RFX0ZCX01PRElG
SUVSUykgPT0gMCkgfHwKPiArICAgICAgICAgICAgICAoKGZiLT5mbGFncyAmIERSTV9NT0RFX0ZC
X01PRElGSUVSUykgIT0gMCAmJgo+ICsgICAgICAgICAgICAgICBmYi0+bW9kaWZpZXIgPT0gRFJN
X0ZPUk1BVF9NT0RfTElORUFSKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgZGNzc19wbGFuZV9k
ZXN0cm95KHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZGNz
c19wbGFuZSAqZGNzc19wbGFuZSA9IGNvbnRhaW5lcl9vZihwbGFuZSwgc3RydWN0IGRjc3NfcGxh
bmUsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBiYXNlKTsKPiArCj4gKyAgICAgICBkcm1fcGxhbmVfY2xlYW51cChwbGFuZSk7Cj4gKyAgICAg
ICBrZnJlZShkY3NzX3BsYW5lKTsKPiArfQo+ICsKPiArc3RhdGljIGJvb2wgZGNzc19wbGFuZV9m
b3JtYXRfbW9kX3N1cHBvcnRlZChzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUzMiBmb3JtYXQsCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1NjQgbW9kaWZpZXIpCj4gK3sKPiAr
ICAgICAgIHN3aXRjaCAocGxhbmUtPnR5cGUpIHsKPiArICAgICAgIGNhc2UgRFJNX1BMQU5FX1RZ
UEVfUFJJTUFSWToKPiArICAgICAgICAgICAgICAgc3dpdGNoIChmb3JtYXQpIHsKPiArICAgICAg
ICAgICAgICAgY2FzZSBEUk1fRk9STUFUX0FSR0I4ODg4Ogo+ICsgICAgICAgICAgICAgICBjYXNl
IERSTV9GT1JNQVRfWFJHQjg4ODg6Cj4gKyAgICAgICAgICAgICAgIGNhc2UgRFJNX0ZPUk1BVF9B
UkdCMjEwMTAxMDoKPiArICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9kaWZpZXIgPT0g
RFJNX0ZPUk1BVF9NT0RfTElORUFSIHx8Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IG1vZGlmaWVyID09IERSTV9GT1JNQVRfTU9EX1ZJVkFOVEVfVElMRUQgfHwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbW9kaWZpZXIgPT0gRFJNX0ZPUk1BVF9NT0RfVklWQU5URV9T
VVBFUl9USUxFRDsKPiArICAgICAgICAgICAgICAgZGVmYXVsdDoKPiArICAgICAgICAgICAgICAg
ICAgICAgICByZXR1cm4gbW9kaWZpZXIgPT0gRFJNX0ZPUk1BVF9NT0RfTElORUFSOwo+ICsgICAg
ICAgICAgICAgICB9Cj4gKyAgICAgICAgICAgICAgIGJyZWFrOwo+ICsgICAgICAgY2FzZSBEUk1f
UExBTkVfVFlQRV9PVkVSTEFZOgo+ICsgICAgICAgICAgICAgICByZXR1cm4gbW9kaWZpZXIgPT0g
RFJNX0ZPUk1BVF9NT0RfTElORUFSOwo+ICsgICAgICAgZGVmYXVsdDoKPiArICAgICAgICAgICAg
ICAgcmV0dXJuIGZhbHNlOwo+ICsgICAgICAgfQo+ICt9Cj4gKwo+ICtzdGF0aWMgY29uc3Qgc3Ry
dWN0IGRybV9wbGFuZV9mdW5jcyBkY3NzX3BsYW5lX2Z1bmNzID0gewo+ICsgICAgICAgLnVwZGF0
ZV9wbGFuZSAgICAgICAgICAgPSBkcm1fYXRvbWljX2hlbHBlcl91cGRhdGVfcGxhbmUsCj4gKyAg
ICAgICAuZGlzYWJsZV9wbGFuZSAgICAgICAgICA9IGRybV9hdG9taWNfaGVscGVyX2Rpc2FibGVf
cGxhbmUsCj4gKyAgICAgICAuZGVzdHJveSAgICAgICAgICAgICAgICA9IGRjc3NfcGxhbmVfZGVz
dHJveSwKPiArICAgICAgIC5yZXNldCAgICAgICAgICAgICAgICAgID0gZHJtX2F0b21pY19oZWxw
ZXJfcGxhbmVfcmVzZXQsCj4gKyAgICAgICAuYXRvbWljX2R1cGxpY2F0ZV9zdGF0ZSA9IGRybV9h
dG9taWNfaGVscGVyX3BsYW5lX2R1cGxpY2F0ZV9zdGF0ZSwKPiArICAgICAgIC5hdG9taWNfZGVz
dHJveV9zdGF0ZSAgID0gZHJtX2F0b21pY19oZWxwZXJfcGxhbmVfZGVzdHJveV9zdGF0ZSwKPiAr
ICAgICAgIC5mb3JtYXRfbW9kX3N1cHBvcnRlZCAgID0gZGNzc19wbGFuZV9mb3JtYXRfbW9kX3N1
cHBvcnRlZCwKPiArfTsKPiArCj4gK3N0YXRpYyBib29sIGRjc3NfcGxhbmVfY2FuX3JvdGF0ZShj
b25zdCBzdHJ1Y3QgZHJtX2Zvcm1hdF9pbmZvICpmb3JtYXQsCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGJvb2wgbW9kX3ByZXNlbnQsIHU2NCBtb2RpZmllciwKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IHJvdGF0aW9uKQo+ICt7Cj4g
KyAgICAgICBib29sIGxpbmVhcl9mb3JtYXQgPSAhbW9kX3ByZXNlbnQgfHwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIChtb2RfcHJlc2VudCAmJiBtb2RpZmllciA9PSBEUk1fRk9STUFU
X01PRF9MSU5FQVIpOwo+ICsgICAgICAgdTMyIHN1cHBvcnRlZF9yb3RhdGlvbiA9IERSTV9NT0RF
X1JPVEFURV8wOwo+ICsKPiArICAgICAgIGlmICghZm9ybWF0LT5pc195dXYgJiYgbGluZWFyX2Zv
cm1hdCkKPiArICAgICAgICAgICAgICAgc3VwcG9ydGVkX3JvdGF0aW9uID0gRFJNX01PREVfUk9U
QVRFXzAgfCBEUk1fTU9ERV9ST1RBVEVfMTgwIHwKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgRFJNX01PREVfUkVGTEVDVF9NQVNLOwo+ICsgICAgICAgZWxzZSBpZiAoIWZv
cm1hdC0+aXNfeXV2ICYmCj4gKyAgICAgICAgICAgICAgICBtb2RpZmllciA9PSBEUk1fRk9STUFU
X01PRF9WSVZBTlRFX1RJTEVEKQo+ICsgICAgICAgICAgICAgICBzdXBwb3J0ZWRfcm90YXRpb24g
PSBEUk1fTU9ERV9ST1RBVEVfTUFTSyB8Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIERSTV9NT0RFX1JFRkxFQ1RfTUFTSzsKPiArICAgICAgIGVsc2UgaWYgKGZvcm1hdC0+
aXNfeXV2ICYmIGxpbmVhcl9mb3JtYXQgJiYKPiArICAgICAgICAgICAgICAgIChmb3JtYXQtPmZv
cm1hdCA9PSBEUk1fRk9STUFUX05WMTIgfHwKPiArICAgICAgICAgICAgICAgICBmb3JtYXQtPmZv
cm1hdCA9PSBEUk1fRk9STUFUX05WMjEpKQo+ICsgICAgICAgICAgICAgICBzdXBwb3J0ZWRfcm90
YXRpb24gPSBEUk1fTU9ERV9ST1RBVEVfMCB8IERSTV9NT0RFX1JPVEFURV8xODAgfAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEUk1fTU9ERV9SRUZMRUNUX01BU0s7Cj4g
Kwo+ICsgICAgICAgcmV0dXJuICEhKHJvdGF0aW9uICYgc3VwcG9ydGVkX3JvdGF0aW9uKTsKPiAr
fQo+ICsKPiArc3RhdGljIGJvb2wgZGNzc19wbGFuZV9pc19zb3VyY2Vfc2l6ZV9hbGxvd2VkKHUx
NiBzcmNfdywgdTE2IHNyY19oLCB1MzIgcGl4X2ZtdCkKPiArewo+ICsgICAgICAgaWYgKHNyY193
IDwgNjQgJiYKPiArICAgICAgICAgICAocGl4X2ZtdCA9PSBEUk1fRk9STUFUX05WMTIgfHwgcGl4
X2ZtdCA9PSBEUk1fRk9STUFUX05WMjEpKQo+ICsgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7
Cj4gKyAgICAgICBlbHNlIGlmIChzcmNfdyA8IDMyICYmCj4gKyAgICAgICAgICAgICAgICAocGl4
X2ZtdCA9PSBEUk1fRk9STUFUX1VZVlkgfHwgcGl4X2ZtdCA9PSBEUk1fRk9STUFUX1ZZVVkgfHwK
PiArICAgICAgICAgICAgICAgICBwaXhfZm10ID09IERSTV9GT1JNQVRfWVVZViB8fCBwaXhfZm10
ID09IERSTV9GT1JNQVRfWVZZVSkpCj4gKyAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKPiAr
Cj4gKyAgICAgICByZXR1cm4gc3JjX3cgPj0gMTYgJiYgc3JjX2ggPj0gODsKPiArfQo+ICsKPiAr
c3RhdGljIGludCBkY3NzX3BsYW5lX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX3BsYW5lICpwbGFu
ZSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBkcm1fcGxhbmVf
c3RhdGUgKnN0YXRlKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZGNzc19wbGFuZSAqZGNzc19wbGFu
ZSA9IHRvX2Rjc3NfcGxhbmUocGxhbmUpOwo+ICsgICAgICAgc3RydWN0IGRjc3NfZGV2ICpkY3Nz
ID0gcGxhbmUtPmRldi0+ZGV2X3ByaXZhdGU7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX2ZyYW1lYnVm
ZmVyICpmYiA9IHN0YXRlLT5mYjsKPiArICAgICAgIGJvb2wgaXNfcHJpbWFyeV9wbGFuZSA9IHBs
YW5lLT50eXBlID09IERSTV9QTEFORV9UWVBFX1BSSU1BUlk7Cj4gKyAgICAgICBzdHJ1Y3QgZHJt
X2dlbV9jbWFfb2JqZWN0ICpjbWFfb2JqOwo+ICsgICAgICAgc3RydWN0IGRybV9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlOwo+ICsgICAgICAgaW50IGhkaXNwbGF5LCB2ZGlzcGxheTsKPiArICAgICAg
IGludCBtaW4sIG1heDsKPiArICAgICAgIGludCByZXQ7Cj4gKwo+ICsgICAgICAgaWYgKCFmYiB8
fCAhc3RhdGUtPmNydGMpCj4gKyAgICAgICAgICAgICAgIHJldHVybiAwOwo+ICsKPiArICAgICAg
IGNtYV9vYmogPSBkcm1fZmJfY21hX2dldF9nZW1fb2JqKGZiLCAwKTsKPiArICAgICAgIFdBUk5f
T04oIWNtYV9vYmopOwo+ICsKPiArICAgICAgIGNydGNfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9l
eGlzdGluZ19jcnRjX3N0YXRlKHN0YXRlLT5zdGF0ZSwKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLT5jcnRjKTsKPiArCj4gKyAg
ICAgICBoZGlzcGxheSA9IGNydGNfc3RhdGUtPmFkanVzdGVkX21vZGUuaGRpc3BsYXk7Cj4gKyAg
ICAgICB2ZGlzcGxheSA9IGNydGNfc3RhdGUtPmFkanVzdGVkX21vZGUudmRpc3BsYXk7Cj4gKwo+
ICsgICAgICAgaWYgKCFkY3NzX3BsYW5lX2lzX3NvdXJjZV9zaXplX2FsbG93ZWQoc3RhdGUtPnNy
Y193ID4+IDE2LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgc3RhdGUtPnNyY19oID4+IDE2LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgZmItPmZvcm1hdC0+Zm9ybWF0KSkgewo+ICsgICAgICAgICAgICAgICBE
Uk1fREVCVUdfS01TKCJTb3VyY2UgcGxhbmUgc2l6ZSBpcyBub3QgYWxsb3dlZCFcbiIpOwo+ICsg
ICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICBk
Y3NzX3NjYWxlcl9nZXRfbWluX21heF9yYXRpb3MoZGNzcy0+c2NhbGVyLCBkY3NzX3BsYW5lLT5j
aF9udW0sCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJm1pbiwgJm1h
eCk7Cj4gKwo+ICsgICAgICAgcmV0ID0gZHJtX2F0b21pY19oZWxwZXJfY2hlY2tfcGxhbmVfc3Rh
dGUoc3RhdGUsIGNydGNfc3RhdGUsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBtaW4sIG1heCwgIWlzX3ByaW1hcnlfcGxhbmUsCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSk7Cj4gKyAgICAg
ICBpZiAocmV0KQo+ICsgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+ICsKPiArICAgICAgIGlm
ICghc3RhdGUtPnZpc2libGUpCj4gKyAgICAgICAgICAgICAgIHJldHVybiAwOwo+ICsKPiArICAg
ICAgIGlmICghZGNzc19wbGFuZV9jYW5fcm90YXRlKGZiLT5mb3JtYXQsCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAhIShmYi0+ZmxhZ3MgJiBEUk1fTU9ERV9GQl9NT0RJRklF
UlMpLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmItPm1vZGlmaWVyLAo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUtPnJvdGF0aW9uKSkgewo+
ICsgICAgICAgICAgICAgICBEUk1fREVCVUdfS01TKCJyZXF1ZXN0ZWQgcm90YXRpb24gaXMgbm90
IGFsbG93ZWQhXG4iKTsKPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4gKyAgICAg
ICB9Cj4gKwo+ICsgICAgICAgaWYgKChzdGF0ZS0+Y3J0Y194IDwgMCB8fCBzdGF0ZS0+Y3J0Y195
IDwgMCB8fAo+ICsgICAgICAgICAgICBzdGF0ZS0+Y3J0Y194ICsgc3RhdGUtPmNydGNfdyA+IGhk
aXNwbGF5IHx8Cj4gKyAgICAgICAgICAgIHN0YXRlLT5jcnRjX3kgKyBzdGF0ZS0+Y3J0Y19oID4g
dmRpc3BsYXkpICYmCj4gKyAgICAgICAgICAgIWRjc3NfcGxhbmVfZmJfaXNfbGluZWFyKGZiKSkg
ewo+ICsgICAgICAgICAgICAgICBEUk1fREVCVUdfS01TKCJyZXF1ZXN0ZWQgY3JvcHBpbmcgb3Bl
cmF0aW9uIGlzIG5vdCBhbGxvd2VkIVxuIik7Cj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUlO
VkFMOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGlmICgoZmItPmZsYWdzICYgRFJNX01PREVf
RkJfTU9ESUZJRVJTKSAmJgo+ICsgICAgICAgICAgICFwbGFuZS0+ZnVuY3MtPmZvcm1hdF9tb2Rf
c3VwcG9ydGVkKHBsYW5lLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmItPmZv
cm1hdC0+Zm9ybWF0LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmItPm1vZGlm
aWVyKSkgewo+ICsgICAgICAgICAgICAgICBEUk1fREVCVUdfS01TKCJJbnZhbGlkIG1vZGlmaWVy
OiAlbGx4IiwgZmItPm1vZGlmaWVyKTsKPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7
Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyB2
b2lkIGRjc3NfcGxhbmVfYXRvbWljX3NldF9iYXNlKHN0cnVjdCBkY3NzX3BsYW5lICpkY3NzX3Bs
YW5lKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSA9ICZkY3NzX3BsYW5l
LT5iYXNlOwo+ICsgICAgICAgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqc3RhdGUgPSBwbGFuZS0+
c3RhdGU7Cj4gKyAgICAgICBzdHJ1Y3QgZGNzc19kZXYgKmRjc3MgPSBwbGFuZS0+ZGV2LT5kZXZf
cHJpdmF0ZTsKPiArICAgICAgIHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gc3RhdGUtPmZi
Owo+ICsgICAgICAgY29uc3Qgc3RydWN0IGRybV9mb3JtYXRfaW5mbyAqZm9ybWF0ID0gZmItPmZv
cm1hdDsKPiArICAgICAgIHN0cnVjdCBkcm1fZ2VtX2NtYV9vYmplY3QgKmNtYV9vYmogPSBkcm1f
ZmJfY21hX2dldF9nZW1fb2JqKGZiLCAwKTsKPiArICAgICAgIHVuc2lnbmVkIGxvbmcgcDFfYmEg
PSAwLCBwMl9iYSA9IDA7Cj4gKwo+ICsgICAgICAgaWYgKCFmb3JtYXQtPmlzX3l1diB8fAo+ICsg
ICAgICAgICAgIGZvcm1hdC0+Zm9ybWF0ID09IERSTV9GT1JNQVRfTlYxMiB8fAo+ICsgICAgICAg
ICAgIGZvcm1hdC0+Zm9ybWF0ID09IERSTV9GT1JNQVRfTlYyMSkKPiArICAgICAgICAgICAgICAg
cDFfYmEgPSBjbWFfb2JqLT5wYWRkciArIGZiLT5vZmZzZXRzWzBdICsKPiArICAgICAgICAgICAg
ICAgICAgICAgICBmYi0+cGl0Y2hlc1swXSAqIChzdGF0ZS0+c3JjLnkxID4+IDE2KSArCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgZm9ybWF0LT5jaGFyX3Blcl9ibG9ja1swXSAqIChzdGF0ZS0+
c3JjLngxID4+IDE2KTsKPiArICAgICAgIGVsc2UgaWYgKGZvcm1hdC0+Zm9ybWF0ID09IERSTV9G
T1JNQVRfVVlWWSB8fAo+ICsgICAgICAgICAgICAgICAgZm9ybWF0LT5mb3JtYXQgPT0gRFJNX0ZP
Uk1BVF9WWVVZIHx8Cj4gKyAgICAgICAgICAgICAgICBmb3JtYXQtPmZvcm1hdCA9PSBEUk1fRk9S
TUFUX1lVWVYgfHwKPiArICAgICAgICAgICAgICAgIGZvcm1hdC0+Zm9ybWF0ID09IERSTV9GT1JN
QVRfWVZZVSkKPiArICAgICAgICAgICAgICAgcDFfYmEgPSBjbWFfb2JqLT5wYWRkciArIGZiLT5v
ZmZzZXRzWzBdICsKPiArICAgICAgICAgICAgICAgICAgICAgICBmYi0+cGl0Y2hlc1swXSAqIChz
dGF0ZS0+c3JjLnkxID4+IDE2KSArCj4gKyAgICAgICAgICAgICAgICAgICAgICAgMiAqIGZvcm1h
dC0+Y2hhcl9wZXJfYmxvY2tbMF0gKiAoc3RhdGUtPnNyYy54MSA+PiAxNyk7Cj4gKwo+ICsgICAg
ICAgaWYgKGZvcm1hdC0+Zm9ybWF0ID09IERSTV9GT1JNQVRfTlYxMiB8fAo+ICsgICAgICAgICAg
IGZvcm1hdC0+Zm9ybWF0ID09IERSTV9GT1JNQVRfTlYyMSkKPiArICAgICAgICAgICAgICAgcDJf
YmEgPSBjbWFfb2JqLT5wYWRkciArIGZiLT5vZmZzZXRzWzFdICsKPiArICAgICAgICAgICAgICAg
ICAgICAgICAoKChmYi0+cGl0Y2hlc1sxXSA+PiAxKSAqIChzdGF0ZS0+c3JjLnkxID4+IDE3KSAr
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgKHN0YXRlLT5zcmMueDEgPj4gMTcpKSA8PCAxKTsK
PiArCj4gKyAgICAgICBkY3NzX2Rwcl9hZGRyX3NldChkY3NzLT5kcHIsIGRjc3NfcGxhbmUtPmNo
X251bSwgcDFfYmEsIHAyX2JhLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgZmItPnBpdGNo
ZXNbMF0pOwo+ICt9Cj4gKwo+ICtzdGF0aWMgYm9vbCBkY3NzX3BsYW5lX25lZWRzX3NldHVwKHN0
cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnN0YXRlLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqb2xkX3N0YXRlKQo+ICt7Cj4gKyAgICAg
ICBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHN0YXRlLT5mYjsKPiArICAgICAgIHN0cnVj
dCBkcm1fZnJhbWVidWZmZXIgKm9sZF9mYiA9IG9sZF9zdGF0ZS0+ZmI7Cj4gKwo+ICsgICAgICAg
cmV0dXJuIHN0YXRlLT5jcnRjX3ggIT0gb2xkX3N0YXRlLT5jcnRjX3ggfHwKPiArICAgICAgICAg
ICAgICBzdGF0ZS0+Y3J0Y195ICE9IG9sZF9zdGF0ZS0+Y3J0Y195IHx8Cj4gKyAgICAgICAgICAg
ICAgc3RhdGUtPmNydGNfdyAhPSBvbGRfc3RhdGUtPmNydGNfdyB8fAo+ICsgICAgICAgICAgICAg
IHN0YXRlLT5jcnRjX2ggIT0gb2xkX3N0YXRlLT5jcnRjX2ggfHwKPiArICAgICAgICAgICAgICBz
dGF0ZS0+c3JjX3ggICE9IG9sZF9zdGF0ZS0+c3JjX3ggIHx8Cj4gKyAgICAgICAgICAgICAgc3Rh
dGUtPnNyY195ICAhPSBvbGRfc3RhdGUtPnNyY195ICB8fAo+ICsgICAgICAgICAgICAgIHN0YXRl
LT5zcmNfdyAgIT0gb2xkX3N0YXRlLT5zcmNfdyAgfHwKPiArICAgICAgICAgICAgICBzdGF0ZS0+
c3JjX2ggICE9IG9sZF9zdGF0ZS0+c3JjX2ggIHx8Cj4gKyAgICAgICAgICAgICAgZmItPmZvcm1h
dC0+Zm9ybWF0ICE9IG9sZF9mYi0+Zm9ybWF0LT5mb3JtYXQgfHwKPiArICAgICAgICAgICAgICBm
Yi0+bW9kaWZpZXIgICE9IG9sZF9mYi0+bW9kaWZpZXIgfHwKPiArICAgICAgICAgICAgICBzdGF0
ZS0+cm90YXRpb24gIT0gb2xkX3N0YXRlLT5yb3RhdGlvbjsKPiArfQo+ICsKPiArc3RhdGljIHZv
aWQgZGNzc19wbGFuZV9hdG9taWNfdXBkYXRlKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLAo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRl
ICpvbGRfc3RhdGUpCj4gK3sKPiArICAgICAgIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnN0YXRl
ID0gcGxhbmUtPnN0YXRlOwo+ICsgICAgICAgc3RydWN0IGRjc3NfcGxhbmUgKmRjc3NfcGxhbmUg
PSB0b19kY3NzX3BsYW5lKHBsYW5lKTsKPiArICAgICAgIHN0cnVjdCBkY3NzX2RldiAqZGNzcyA9
IHBsYW5lLT5kZXYtPmRldl9wcml2YXRlOwo+ICsgICAgICAgc3RydWN0IGRybV9mcmFtZWJ1ZmZl
ciAqZmIgPSBzdGF0ZS0+ZmI7Cj4gKyAgICAgICB1MzIgcGl4ZWxfZm9ybWF0Owo+ICsgICAgICAg
c3RydWN0IGRybV9jcnRjX3N0YXRlICpjcnRjX3N0YXRlOwo+ICsgICAgICAgYm9vbCBtb2RpZmll
cnNfcHJlc2VudDsKPiArICAgICAgIHUzMiBzcmNfdywgc3JjX2gsIGRzdF93LCBkc3RfaDsKPiAr
ICAgICAgIHN0cnVjdCBkcm1fcmVjdCBzcmMsIGRzdDsKPiArICAgICAgIGJvb2wgZW5hYmxlID0g
dHJ1ZTsKPiArCj4gKyAgICAgICBpZiAoIWZiIHx8ICFzdGF0ZS0+Y3J0YyB8fCAhc3RhdGUtPnZp
c2libGUpCj4gKyAgICAgICAgICAgICAgIHJldHVybjsKPiArCj4gKyAgICAgICBwaXhlbF9mb3Jt
YXQgPSBzdGF0ZS0+ZmItPmZvcm1hdC0+Zm9ybWF0Owo+ICsgICAgICAgY3J0Y19zdGF0ZSA9IHN0
YXRlLT5jcnRjLT5zdGF0ZTsKPiArICAgICAgIG1vZGlmaWVyc19wcmVzZW50ID0gISEoZmItPmZs
YWdzICYgRFJNX01PREVfRkJfTU9ESUZJRVJTKTsKPiArCj4gKyAgICAgICBpZiAob2xkX3N0YXRl
LT5mYiAmJiAhZHJtX2F0b21pY19jcnRjX25lZWRzX21vZGVzZXQoY3J0Y19zdGF0ZSkgJiYKPiAr
ICAgICAgICAgICAhZGNzc19wbGFuZV9uZWVkc19zZXR1cChzdGF0ZSwgb2xkX3N0YXRlKSkgewo+
ICsgICAgICAgICAgICAgICBkY3NzX3BsYW5lX2F0b21pY19zZXRfYmFzZShkY3NzX3BsYW5lKTsK
PiArICAgICAgICAgICAgICAgcmV0dXJuOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIHNyYyA9
IHBsYW5lLT5zdGF0ZS0+c3JjOwo+ICsgICAgICAgZHN0ID0gcGxhbmUtPnN0YXRlLT5kc3Q7Cj4g
Kwo+ICsgICAgICAgLyoKPiArICAgICAgICAqIFRoZSB3aWR0aCBhbmQgaGVpZ2h0IGFmdGVyIGNs
aXBwaW5nLgo+ICsgICAgICAgICovCj4gKyAgICAgICBzcmNfdyA9IGRybV9yZWN0X3dpZHRoKCZz
cmMpID4+IDE2Owo+ICsgICAgICAgc3JjX2ggPSBkcm1fcmVjdF9oZWlnaHQoJnNyYykgPj4gMTY7
Cj4gKyAgICAgICBkc3RfdyA9IGRybV9yZWN0X3dpZHRoKCZkc3QpOwo+ICsgICAgICAgZHN0X2gg
PSBkcm1fcmVjdF9oZWlnaHQoJmRzdCk7Cj4gKwo+ICsgICAgICAgaWYgKHBsYW5lLT50eXBlID09
IERSTV9QTEFORV9UWVBFX09WRVJMQVkgJiYKPiArICAgICAgICAgICBtb2RpZmllcnNfcHJlc2Vu
dCAmJiBmYi0+bW9kaWZpZXIgPT0gRFJNX0ZPUk1BVF9NT0RfTElORUFSKQo+ICsgICAgICAgICAg
ICAgICBtb2RpZmllcnNfcHJlc2VudCA9IGZhbHNlOwo+ICsKPiArICAgICAgIGRjc3NfZHByX2Zv
cm1hdF9zZXQoZGNzcy0+ZHByLCBkY3NzX3BsYW5lLT5jaF9udW0sIHN0YXRlLT5mYi0+Zm9ybWF0
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllcnNfcHJlc2VudCA/IGZiLT5t
b2RpZmllciA6Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgRFJNX0ZPUk1BVF9NT0RfTElORUFSKTsKPiArICAgICAgIGRjc3NfZHByX3NldF9yZXMoZGNz
cy0+ZHByLCBkY3NzX3BsYW5lLT5jaF9udW0sIHNyY193LCBzcmNfaCk7Cj4gKyAgICAgICBkY3Nz
X2Rwcl9zZXRfcm90YXRpb24oZGNzcy0+ZHByLCBkY3NzX3BsYW5lLT5jaF9udW0sCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUtPnJvdGF0aW9uKTsKPiArCj4gKyAgICAgICBk
Y3NzX3BsYW5lX2F0b21pY19zZXRfYmFzZShkY3NzX3BsYW5lKTsKPiArCj4gKyAgICAgICBkY3Nz
X3NjYWxlcl9zZXR1cChkY3NzLT5zY2FsZXIsIGRjc3NfcGxhbmUtPmNoX251bSwKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgIHN0YXRlLT5mYi0+Zm9ybWF0LCBzcmNfdywgc3JjX2gsCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICBkc3RfdywgZHN0X2gsCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICBkcm1fbW9kZV92cmVmcmVzaCgmY3J0Y19zdGF0ZS0+bW9kZSkpOwo+ICsKPiArICAg
ICAgIGRjc3NfZHRnX3BsYW5lX3Bvc19zZXQoZGNzcy0+ZHRnLCBkY3NzX3BsYW5lLT5jaF9udW0s
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRzdC54MSwgZHN0LnkxLCBkc3Rfdywg
ZHN0X2gpOwo+ICsgICAgICAgZGNzc19kdGdfcGxhbmVfYWxwaGFfc2V0KGRjc3MtPmR0ZywgZGNz
c19wbGFuZS0+Y2hfbnVtLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZiLT5m
b3JtYXQsIHN0YXRlLT5hbHBoYSA+PiA4KTsKPiArCj4gKyAgICAgICBpZiAoIWRjc3NfcGxhbmUt
PmNoX251bSAmJiAoc3RhdGUtPmFscGhhID4+IDgpID09IDApCj4gKyAgICAgICAgICAgICAgIGVu
YWJsZSA9IGZhbHNlOwo+ICsKPiArICAgICAgIGRjc3NfZHByX2VuYWJsZShkY3NzLT5kcHIsIGRj
c3NfcGxhbmUtPmNoX251bSwgZW5hYmxlKTsKPiArICAgICAgIGRjc3Nfc2NhbGVyX2NoX2VuYWJs
ZShkY3NzLT5zY2FsZXIsIGRjc3NfcGxhbmUtPmNoX251bSwgZW5hYmxlKTsKPiArCj4gKyAgICAg
ICBpZiAoIWVuYWJsZSkKPiArICAgICAgICAgICAgICAgZGNzc19kdGdfcGxhbmVfcG9zX3NldChk
Y3NzLT5kdGcsIGRjc3NfcGxhbmUtPmNoX251bSwKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAwLCAwLCAwLCAwKTsKPiArCj4gKyAgICAgICBkY3NzX2R0Z19jaF9lbmFi
bGUoZGNzcy0+ZHRnLCBkY3NzX3BsYW5lLT5jaF9udW0sIGVuYWJsZSk7Cj4gK30KPiArCj4gK3N0
YXRpYyB2b2lkIGRjc3NfcGxhbmVfYXRvbWljX2Rpc2FibGUoc3RydWN0IGRybV9wbGFuZSAqcGxh
bmUsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgZHJtX3Bs
YW5lX3N0YXRlICpvbGRfc3RhdGUpCj4gK3sKPiArICAgICAgIHN0cnVjdCBkY3NzX3BsYW5lICpk
Y3NzX3BsYW5lID0gdG9fZGNzc19wbGFuZShwbGFuZSk7Cj4gKyAgICAgICBzdHJ1Y3QgZGNzc19k
ZXYgKmRjc3MgPSBwbGFuZS0+ZGV2LT5kZXZfcHJpdmF0ZTsKPiArCj4gKyAgICAgICBkY3NzX2Rw
cl9lbmFibGUoZGNzcy0+ZHByLCBkY3NzX3BsYW5lLT5jaF9udW0sIGZhbHNlKTsKPiArICAgICAg
IGRjc3Nfc2NhbGVyX2NoX2VuYWJsZShkY3NzLT5zY2FsZXIsIGRjc3NfcGxhbmUtPmNoX251bSwg
ZmFsc2UpOwo+ICsgICAgICAgZGNzc19kdGdfcGxhbmVfcG9zX3NldChkY3NzLT5kdGcsIGRjc3Nf
cGxhbmUtPmNoX251bSwgMCwgMCwgMCwgMCk7Cj4gKyAgICAgICBkY3NzX2R0Z19jaF9lbmFibGUo
ZGNzcy0+ZHRnLCBkY3NzX3BsYW5lLT5jaF9udW0sIGZhbHNlKTsKPiArfQo+ICsKPiArc3RhdGlj
IGNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfaGVscGVyX2Z1bmNzIGRjc3NfcGxhbmVfaGVscGVyX2Z1
bmNzID0gewo+ICsgICAgICAgLnByZXBhcmVfZmIgPSBkcm1fZ2VtX2ZiX3ByZXBhcmVfZmIsCj4g
KyAgICAgICAuYXRvbWljX2NoZWNrID0gZGNzc19wbGFuZV9hdG9taWNfY2hlY2ssCj4gKyAgICAg
ICAuYXRvbWljX3VwZGF0ZSA9IGRjc3NfcGxhbmVfYXRvbWljX3VwZGF0ZSwKPiArICAgICAgIC5h
dG9taWNfZGlzYWJsZSA9IGRjc3NfcGxhbmVfYXRvbWljX2Rpc2FibGUsCj4gK307Cj4gKwo+ICtz
dHJ1Y3QgZGNzc19wbGFuZSAqZGNzc19wbGFuZV9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkcm0s
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgcG9zc2li
bGVfY3J0Y3MsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtIGRybV9w
bGFuZV90eXBlIHR5cGUsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNp
Z25lZCBpbnQgenBvcykKPiArewo+ICsgICAgICAgc3RydWN0IGRjc3NfcGxhbmUgKmRjc3NfcGxh
bmU7Cj4gKyAgICAgICBjb25zdCB1NjQgKmZvcm1hdF9tb2RpZmllcnMgPSBkY3NzX3ZpZGVvX2Zv
cm1hdF9tb2RpZmllcnM7Cj4gKyAgICAgICBpbnQgcmV0Owo+ICsKPiArICAgICAgIGlmICh6cG9z
ID4gMikKPiArICAgICAgICAgICAgICAgcmV0dXJuIEVSUl9QVFIoLUVJTlZBTCk7Cj4gKwo+ICsg
ICAgICAgZGNzc19wbGFuZSA9IGt6YWxsb2Moc2l6ZW9mKCpkY3NzX3BsYW5lKSwgR0ZQX0tFUk5F
TCk7Cj4gKyAgICAgICBpZiAoIWRjc3NfcGxhbmUpIHsKPiArICAgICAgICAgICAgICAgRFJNX0VS
Uk9SKCJmYWlsZWQgdG8gYWxsb2NhdGUgcGxhbmVcbiIpOwo+ICsgICAgICAgICAgICAgICByZXR1
cm4gRVJSX1BUUigtRU5PTUVNKTsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICBpZiAodHlwZSA9
PSBEUk1fUExBTkVfVFlQRV9QUklNQVJZKQo+ICsgICAgICAgICAgICAgICBmb3JtYXRfbW9kaWZp
ZXJzID0gZGNzc19ncmFwaGljc19mb3JtYXRfbW9kaWZpZXJzOwo+ICsKPiArICAgICAgIHJldCA9
IGRybV91bml2ZXJzYWxfcGxhbmVfaW5pdChkcm0sICZkY3NzX3BsYW5lLT5iYXNlLCBwb3NzaWJs
ZV9jcnRjcywKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmZGNzc19w
bGFuZV9mdW5jcywgZGNzc19jb21tb25fZm9ybWF0cywKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBBUlJBWV9TSVpFKGRjc3NfY29tbW9uX2Zvcm1hdHMpLAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdF9tb2RpZmllcnMsIHR5cGUs
IE5VTEwpOwo+ICsgICAgICAgaWYgKHJldCkgewo+ICsgICAgICAgICAgICAgICBEUk1fRVJST1Io
ImZhaWxlZCB0byBpbml0aWFsaXplIHBsYW5lXG4iKTsKPiArICAgICAgICAgICAgICAga2ZyZWUo
ZGNzc19wbGFuZSk7Cj4gKyAgICAgICAgICAgICAgIHJldHVybiBFUlJfUFRSKHJldCk7Cj4gKyAg
ICAgICB9Cj4gKwo+ICsgICAgICAgZHJtX3BsYW5lX2hlbHBlcl9hZGQoJmRjc3NfcGxhbmUtPmJh
c2UsICZkY3NzX3BsYW5lX2hlbHBlcl9mdW5jcyk7Cj4gKwo+ICsgICAgICAgcmV0ID0gZHJtX3Bs
YW5lX2NyZWF0ZV96cG9zX2ltbXV0YWJsZV9wcm9wZXJ0eSgmZGNzc19wbGFuZS0+YmFzZSwgenBv
cyk7Cj4gKyAgICAgICBpZiAocmV0KQo+ICsgICAgICAgICAgICAgICByZXR1cm4gRVJSX1BUUihy
ZXQpOwo+ICsKPiArICAgICAgIGRybV9wbGFuZV9jcmVhdGVfcm90YXRpb25fcHJvcGVydHkoJmRj
c3NfcGxhbmUtPmJhc2UsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIERSTV9NT0RFX1JPVEFURV8wLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBEUk1fTU9ERV9ST1RBVEVfMCAgIHwKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgRFJNX01PREVfUk9UQVRFXzkwICB8Cj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERSTV9NT0RFX1JPVEFURV8xODAgfAo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEUk1fTU9ERV9ST1RBVEVf
MjcwIHwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRFJNX01P
REVfUkVGTEVDVF9YICB8Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIERSTV9NT0RFX1JFRkxFQ1RfWSk7Cj4gKwo+ICsgICAgICAgZGNzc19wbGFuZS0+Y2hfbnVt
ID0genBvczsKPiArCj4gKyAgICAgICByZXR1cm4gZGNzc19wbGFuZTsKPiArfQo+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaW14L2Rjc3MvZGNzcy1zY2FsZXIuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pbXgvZGNzcy9kY3NzLXNjYWxlci5jCj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRl
eCAwMDAwMDAwMC4uM2UzMTdmNAo+IC0tLSAvZGV2L251bGwKPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vaW14L2Rjc3MvZGNzcy1zY2FsZXIuYwo+IEBAIC0wLDAgKzEsODMwIEBACj4gKy8vIFNQRFgt
TGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCj4gKy8qCj4gKyAqIENvcHlyaWdodCAyMDE5IE5Y
UC4KPiArICoKPiArICogU2NhbGluZyBhbGdvcml0aG1zIHdlcmUgY29udHJpYnV0ZWQgYnkgRHp1
bmcgSG9hbmcgPGR6dW5nLmhvYW5nQG54cC5jb20+Cj4gKyAqLwo+ICsKPiArI2luY2x1ZGUgPGxp
bnV4L2RldmljZS5oPgo+ICsKPiArI2luY2x1ZGUgImRjc3MtZGV2LmgiCj4gKwo+ICsjZGVmaW5l
IERDU1NfU0NBTEVSX0NUUkwgICAgICAgICAgICAgICAgICAgICAgIDB4MDAKPiArI2RlZmluZSAg
IFNDQUxFUl9FTiAgICAgICAgICAgICAgICAgICAgICAgICAgICBCSVQoMCkKPiArI2RlZmluZSAg
IFJFUEVBVF9FTiAgICAgICAgICAgICAgICAgICAgICAgICAgICBCSVQoNCkKPiArI2RlZmluZSAg
IFNDQUxFMk1FTV9FTiAgICAgICAgICAgICAgICAgICAgICAgICBCSVQoOCkKPiArI2RlZmluZSAg
IE1FTTJPRklGT19FTiAgICAgICAgICAgICAgICAgICAgICAgICBCSVQoMTIpCj4gKyNkZWZpbmUg
RENTU19TQ0FMRVJfT0ZJRk9fQ1RSTCAgICAgICAgICAgICAgICAgMHgwNAo+ICsjZGVmaW5lICAg
T0ZJRk9fTE9XX1RIUkVTX1BPUyAgICAgICAgICAgICAgICAgIDAKPiArI2RlZmluZSAgIE9GSUZP
X0xPV19USFJFU19NQVNLICAgICAgICAgICAgICAgICBHRU5NQVNLKDksIDApCj4gKyNkZWZpbmUg
ICBPRklGT19ISUdIX1RIUkVTX1BPUyAgICAgICAgICAgICAgICAgMTYKPiArI2RlZmluZSAgIE9G
SUZPX0hJR0hfVEhSRVNfTUFTSyAgICAgICAgICAgICAgICAgICAgICAgIEdFTk1BU0soMjUsIDE2
KQo+ICsjZGVmaW5lICAgVU5ERVJSVU5fREVURUNUX0NMUiAgICAgICAgICAgICAgICAgIEJJVCgy
NikKPiArI2RlZmluZSAgIExPV19USFJFU19ERVRFQ1RfQ0xSICAgICAgICAgICAgICAgICBCSVQo
MjcpCj4gKyNkZWZpbmUgICBISUdIX1RIUkVTX0RFVEVDVF9DTFIgICAgICAgICAgICAgICAgICAg
ICAgICBCSVQoMjgpCj4gKyNkZWZpbmUgICBVTkRFUlJVTl9ERVRFQ1RfRU4gICAgICAgICAgICAg
ICAgICAgQklUKDI5KQo+ICsjZGVmaW5lICAgTE9XX1RIUkVTX0RFVEVDVF9FTiAgICAgICAgICAg
ICAgICAgIEJJVCgzMCkKPiArI2RlZmluZSAgIEhJR0hfVEhSRVNfREVURUNUX0VOICAgICAgICAg
ICAgICAgICBCSVQoMzEpCj4gKyNkZWZpbmUgRENTU19TQ0FMRVJfU0RBVEFfQ1RSTCAgICAgICAg
ICAgICAgICAgMHgwOAo+ICsjZGVmaW5lICAgWVVWX0VOICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIEJJVCgwKQo+ICsjZGVmaW5lICAgUlRSQU1fOExJTkVTICAgICAgICAgICAgICAgICAg
ICAgICAgIEJJVCgxKQo+ICsjZGVmaW5lICAgWV9VVl9CWVRFX1NXQVAgICAgICAgICAgICAgICAg
ICAgICAgIEJJVCg0KQo+ICsjZGVmaW5lICAgQTJSMTBHMTBCMTBfRk9STUFUX1BPUyAgICAgICAg
ICAgICAgIDgKPiArI2RlZmluZSAgIEEyUjEwRzEwQjEwX0ZPUk1BVF9NQVNLICAgICAgICAgICAg
ICBHRU5NQVNLKDExLCA4KQo+ICsjZGVmaW5lIERDU1NfU0NBTEVSX0JJVF9ERVBUSCAgICAgICAg
ICAgICAgICAgIDB4MEMKPiArI2RlZmluZSAgIExVTV9CSVRfREVQVEhfUE9TICAgICAgICAgICAg
ICAgICAgICAwCj4gKyNkZWZpbmUgICBMVU1fQklUX0RFUFRIX01BU0sgICAgICAgICAgICAgICAg
ICAgR0VOTUFTSygxLCAwKQo+ICsjZGVmaW5lICAgQ0hSX0JJVF9ERVBUSF9QT1MgICAgICAgICAg
ICAgICAgICAgIDQKPiArI2RlZmluZSAgIENIUl9CSVRfREVQVEhfTUFTSyAgICAgICAgICAgICAg
ICAgICBHRU5NQVNLKDUsIDQpCj4gKyNkZWZpbmUgRENTU19TQ0FMRVJfU1JDX0ZPUk1BVCAgICAg
ICAgICAgICAgICAgMHgxMAo+ICsjZGVmaW5lIERDU1NfU0NBTEVSX0RTVF9GT1JNQVQgICAgICAg
ICAgICAgICAgIDB4MTQKPiArI2RlZmluZSAgIEZPUk1BVF9NQVNLICAgICAgICAgICAgICAgICAg
ICAgICAgICBHRU5NQVNLKDEsIDApCj4gKyNkZWZpbmUgRENTU19TQ0FMRVJfU1JDX0xVTV9SRVMg
ICAgICAgICAgICAgICAgICAgICAgICAweDE4Cj4gKyNkZWZpbmUgRENTU19TQ0FMRVJfU1JDX0NI
Ul9SRVMgICAgICAgICAgICAgICAgICAgICAgICAweDFDCj4gKyNkZWZpbmUgRENTU19TQ0FMRVJf
RFNUX0xVTV9SRVMgICAgICAgICAgICAgICAgICAgICAgICAweDIwCj4gKyNkZWZpbmUgRENTU19T
Q0FMRVJfRFNUX0NIUl9SRVMgICAgICAgICAgICAgICAgICAgICAgICAweDI0Cj4gKyNkZWZpbmUg
ICBXSURUSF9QT1MgICAgICAgICAgICAgICAgICAgICAgICAgICAgMAo+ICsjZGVmaW5lICAgV0lE
VEhfTUFTSyAgICAgICAgICAgICAgICAgICAgICAgICAgIEdFTk1BU0soMTEsIDApCj4gKyNkZWZp
bmUgICBIRUlHSFRfUE9TICAgICAgICAgICAgICAgICAgICAgICAgICAgMTYKPiArI2RlZmluZSAg
IEhFSUdIVF9NQVNLICAgICAgICAgICAgICAgICAgICAgICAgICBHRU5NQVNLKDI3LCAxNikKPiAr
I2RlZmluZSBEQ1NTX1NDQUxFUl9WX0xVTV9TVEFSVCAgICAgICAgICAgICAgICAgICAgICAgIDB4
NDgKPiArI2RlZmluZSAgIFZfU1RBUlRfTUFTSyAgICAgICAgICAgICAgICAgICAgICAgICBHRU5N
QVNLKDE1LCAwKQo+ICsjZGVmaW5lIERDU1NfU0NBTEVSX1ZfTFVNX0lOQyAgICAgICAgICAgICAg
ICAgIDB4NEMKPiArI2RlZmluZSAgIFZfSU5DX01BU0sgICAgICAgICAgICAgICAgICAgICAgICAg
ICBHRU5NQVNLKDE1LCAwKQo+ICsjZGVmaW5lIERDU1NfU0NBTEVSX0hfTFVNX1NUQVJUICAgICAg
ICAgICAgICAgICAgICAgICAgMHg1MAo+ICsjZGVmaW5lICAgSF9TVEFSVF9NQVNLICAgICAgICAg
ICAgICAgICAgICAgICAgIEdFTk1BU0soMTgsIDApCj4gKyNkZWZpbmUgRENTU19TQ0FMRVJfSF9M
VU1fSU5DICAgICAgICAgICAgICAgICAgMHg1NAo+ICsjZGVmaW5lICAgSF9JTkNfTUFTSyAgICAg
ICAgICAgICAgICAgICAgICAgICAgIEdFTk1BU0soMTUsIDApCj4gKyNkZWZpbmUgRENTU19TQ0FM
RVJfVl9DSFJfU1RBUlQgICAgICAgICAgICAgICAgICAgICAgICAweDU4Cj4gKyNkZWZpbmUgRENT
U19TQ0FMRVJfVl9DSFJfSU5DICAgICAgICAgICAgICAgICAgMHg1Qwo+ICsjZGVmaW5lIERDU1Nf
U0NBTEVSX0hfQ0hSX1NUQVJUICAgICAgICAgICAgICAgICAgICAgICAgMHg2MAo+ICsjZGVmaW5l
IERDU1NfU0NBTEVSX0hfQ0hSX0lOQyAgICAgICAgICAgICAgICAgIDB4NjQKPiArI2RlZmluZSBE
Q1NTX1NDQUxFUl9DT0VGX1ZMVU0gICAgICAgICAgICAgICAgICAweDgwCj4gKyNkZWZpbmUgRENT
U19TQ0FMRVJfQ09FRl9ITFVNICAgICAgICAgICAgICAgICAgMHgxNDAKPiArI2RlZmluZSBEQ1NT
X1NDQUxFUl9DT0VGX1ZDSFIgICAgICAgICAgICAgICAgICAweDIwMAo+ICsjZGVmaW5lIERDU1Nf
U0NBTEVSX0NPRUZfSENIUiAgICAgICAgICAgICAgICAgIDB4MzAwCj4gKwo+ICtzdHJ1Y3QgZGNz
c19zY2FsZXJfY2ggewo+ICsgICAgICAgdm9pZCBfX2lvbWVtICpiYXNlX3JlZzsKPiArICAgICAg
IHUzMiBiYXNlX29mczsKPiArICAgICAgIHN0cnVjdCBkY3NzX3NjYWxlciAqc2NsOwo+ICsKPiAr
ICAgICAgIHUzMiBzZGF0YV9jdHJsOwo+ICsgICAgICAgdTMyIHNjYWxlcl9jdHJsOwo+ICsKPiAr
ICAgICAgIGJvb2wgc2NhbGVyX2N0cmxfY2hnZDsKPiArCj4gKyAgICAgICB1MzIgY192c3RhcnQ7
Cj4gKyAgICAgICB1MzIgY19oc3RhcnQ7Cj4gK307Cj4gKwo+ICtzdHJ1Y3QgZGNzc19zY2FsZXIg
ewo+ICsgICAgICAgc3RydWN0IGRldmljZSAqZGV2Owo+ICsKPiArICAgICAgIHN0cnVjdCBkY3Nz
X2N0eGxkICpjdHhsZDsKPiArICAgICAgIHUzMiBjdHhfaWQ7Cj4gKwo+ICsgICAgICAgc3RydWN0
IGRjc3Nfc2NhbGVyX2NoIGNoWzNdOwo+ICt9Owo+ICsKPiArLyogc2NhbGVyIGNvZWZmaWNpZW50
cyBnZW5lcmF0b3IgKi8KPiArI2RlZmluZSBQU0NfRlJBQ19CSVRTIDMwCj4gKyNkZWZpbmUgUFND
X0ZSQUNfU0NBTEUgQklUKFBTQ19GUkFDX0JJVFMpCj4gKyNkZWZpbmUgUFNDX0JJVFNfRk9SX1BI
QVNFIDQKPiArI2RlZmluZSBQU0NfTlVNX1BIQVNFUyAxNgo+ICsjZGVmaW5lIFBTQ19TVE9SRURf
UEhBU0VTIChQU0NfTlVNX1BIQVNFUyAvIDIgKyAxKQo+ICsjZGVmaW5lIFBTQ19OVU1fVEFQUyA3
Cj4gKyNkZWZpbmUgUFNDX05VTV9UQVBTX1JHQkEgNQo+ICsjZGVmaW5lIFBTQ19DT0VGRl9QUkVD
SVNJT04gMTAKPiArI2RlZmluZSBQU0NfUEhBU0VfRlJBQ1RJT05fQklUUyAxMwo+ICsjZGVmaW5l
IFBTQ19QSEFTRV9NQVNLIChQU0NfTlVNX1BIQVNFUyAtIDEpCj4gKyNkZWZpbmUgUFNDX1FfRlJB
Q1RJT04gMTkKPiArI2RlZmluZSBQU0NfUV9ST1VORF9PRkZTRVQgKDEgPDwgKFBTQ19RX0ZSQUNU
SU9OIC0gMSkpCj4gKwo+ICsvKioKPiArICogbXVsdF9xKCkgLSBQZXJmb3JtcyBmaXhlZC1wb2lu
dCBtdWx0aXBsaWNhdGlvbi4KPiArICogQEE6IG11bHRpcGxpZXIKPiArICogQEI6IG11bHRpcGxp
Y2FuZAo+ICsgKi8KPiArc3RhdGljIGludCBtdWx0X3EoaW50IEEsIGludCBCKQo+ICt7Cj4gKyAg
ICAgICBpbnQgcmVzdWx0Owo+ICsgICAgICAgczY0IHRlbXA7Cj4gKwo+ICsgICAgICAgdGVtcCA9
IChpbnQ2NF90KUEgKiAoaW50NjRfdClCOwo+ICsgICAgICAgdGVtcCArPSBQU0NfUV9ST1VORF9P
RkZTRVQ7Cj4gKyAgICAgICByZXN1bHQgPSAoaW50KSh0ZW1wID4+IFBTQ19RX0ZSQUNUSU9OKTsK
PiArICAgICAgIHJldHVybiByZXN1bHQ7Cj4gK30KPiArCj4gKy8qKgo+ICsgKiBkaXZfcSgpIC0g
UGVyZm9ybXMgZml4ZWQtcG9pbnQgZGl2aXNpb24uCj4gKyAqIEBBOiBkaXZpZGVuZAo+ICsgKiBA
QjogZGl2aXNvcgo+ICsgKi8KPiArc3RhdGljIGludCBkaXZfcShpbnQgQSwgaW50IEIpCj4gK3sK
PiArICAgICAgIGludCByZXN1bHQ7Cj4gKyAgICAgICBzNjQgdGVtcDsKPiArCj4gKyAgICAgICB0
ZW1wID0gKGludDY0X3QpQSA8PCBQU0NfUV9GUkFDVElPTjsKPiArICAgICAgIGlmICgodGVtcCA+
PSAwICYmIEIgPj0gMCkgfHwgKHRlbXAgPCAwICYmIEIgPCAwKSkKPiArICAgICAgICAgICAgICAg
dGVtcCArPSBCIC8gMjsKPiArICAgICAgIGVsc2UKPiArICAgICAgICAgICAgICAgdGVtcCAtPSBC
IC8gMjsKPiArCj4gKyAgICAgICByZXN1bHQgPSAoaW50KSh0ZW1wIC8gQik7Cj4gKyAgICAgICBy
ZXR1cm4gcmVzdWx0Owo+ICt9Cj4gKwo+ICsvKioKPiArICogZXhwX2FwcHJveF9xKCkgLSBDb21w
dXRlIGFwcHJveGltYXRpb24gdG8gZXhwKHgpIGZ1bmN0aW9uIHVzaW5nIFRheWxvcgo+ICsgKiAg
ICAgICAgICAgICAgICAgc2VyaWVzLgo+ICsgKiBAeDogZml4ZWQtcG9pbnQgYXJndW1lbnQgb2Yg
ZXhwIGZ1bmN0aW9uCj4gKyAqLwo+ICtzdGF0aWMgaW50IGV4cF9hcHByb3hfcShpbnQgeCkKPiAr
ewo+ICsgICAgICAgaW50IHN1bSA9IDEgPDwgUFNDX1FfRlJBQ1RJT047Cj4gKyAgICAgICBpbnQg
dGVybSA9IDEgPDwgUFNDX1FfRlJBQ1RJT047Cj4gKwo+ICsgICAgICAgdGVybSA9IG11bHRfcSh0
ZXJtLCBkaXZfcSh4LCAxIDw8IFBTQ19RX0ZSQUNUSU9OKSk7Cj4gKyAgICAgICBzdW0gKz0gdGVy
bTsKPiArICAgICAgIHRlcm0gPSBtdWx0X3EodGVybSwgZGl2X3EoeCwgMiA8PCBQU0NfUV9GUkFD
VElPTikpOwo+ICsgICAgICAgc3VtICs9IHRlcm07Cj4gKyAgICAgICB0ZXJtID0gbXVsdF9xKHRl
cm0sIGRpdl9xKHgsIDMgPDwgUFNDX1FfRlJBQ1RJT04pKTsKPiArICAgICAgIHN1bSArPSB0ZXJt
Owo+ICsgICAgICAgdGVybSA9IG11bHRfcSh0ZXJtLCBkaXZfcSh4LCA0IDw8IFBTQ19RX0ZSQUNU
SU9OKSk7Cj4gKyAgICAgICBzdW0gKz0gdGVybTsKPiArCj4gKyAgICAgICByZXR1cm4gc3VtOwo+
ICt9Cj4gKwo+ICsvKioKPiArICogZGNzc19zY2FsZXJfZ2F1c3NpYW5fZmlsdGVyKCkgLSBHZW5l
cmF0ZSBnYXVzc2lhbiBwcm90b3R5cGUgZmlsdGVyLgo+ICsgKiBAZmNfcTogZml4ZWQtcG9pbnQg
Y3V0b2ZmIGZyZXF1ZW5jeSBub3JtYWxpemVkIHRvIHJhbmdlIFswLCAxXQo+ICsgKiBAdXNlXzVf
dGFwczogaW5kaWNhdGVzIHdoZXRoZXIgdG8gdXNlIDUgdGFwcyBvciA3IHRhcHMKPiArICogQGNv
ZWY6IG91dHB1dCBmaWx0ZXIgY29lZmZpY2llbnRzCj4gKyAqLwo+ICtzdGF0aWMgdm9pZCBkY3Nz
X3NjYWxlcl9nYXVzc2lhbl9maWx0ZXIoaW50IGZjX3EsIGJvb2wgdXNlXzVfdGFwcywKPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCBwaGFzZTBfaWRlbnRpdHks
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBjb2VmW11bUFND
X05VTV9UQVBTXSkKPiArewo+ICsgICAgICAgaW50IHNpZ21hX3EsIGcwX3EsIGcxX3EsIGcyX3E7
Cj4gKyAgICAgICBpbnQgdGFwX2NudDEsIHRhcF9jbnQyLCB0YXBfaWR4LCBwaGFzZV9jbnQ7Cj4g
KyAgICAgICBpbnQgbWlkOwo+ICsgICAgICAgaW50IHBoYXNlOwo+ICsgICAgICAgaW50IGk7Cj4g
KyAgICAgICBpbnQgdGFwczsKPiArCj4gKyAgICAgICBpZiAodXNlXzVfdGFwcykKPiArICAgICAg
ICAgICAgICAgZm9yIChwaGFzZSA9IDA7IHBoYXNlIDwgUFNDX1NUT1JFRF9QSEFTRVM7IHBoYXNl
KyspIHsKPiArICAgICAgICAgICAgICAgICAgICAgICBjb2VmW3BoYXNlXVswXSA9IDA7Cj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgY29lZltwaGFzZV1bUFNDX05VTV9UQVBTIC0gMV0gPSAwOwo+
ICsgICAgICAgICAgICAgICB9Cj4gKwo+ICsgICAgICAgLyogc2VlZCBjb2VmZmljaWVudCBzY2Fu
bmVyICovCj4gKyAgICAgICB0YXBzID0gdXNlXzVfdGFwcyA/IFBTQ19OVU1fVEFQU19SR0JBIDog
UFNDX05VTV9UQVBTOwo+ICsgICAgICAgbWlkID0gKFBTQ19OVU1fUEhBU0VTICogdGFwcykgLyAy
IC0gMTsKPiArICAgICAgIHBoYXNlX2NudCA9IChQU0NfTlVNX1BIQVNFUyAqIChQU0NfTlVNX1RB
UFMgKyAxKSkgLyAyOwo+ICsgICAgICAgdGFwX2NudDEgPSAoUFNDX05VTV9QSEFTRVMgKiBQU0Nf
TlVNX1RBUFMpIC8gMjsKPiArICAgICAgIHRhcF9jbnQyID0gKFBTQ19OVU1fUEhBU0VTICogUFND
X05VTV9UQVBTKSAvIDI7Cj4gKwo+ICsgICAgICAgLyogc2VlZCBnYXVzc2lhbiBmaWx0ZXIgZ2Vu
ZXJhdG9yICovCj4gKyAgICAgICBzaWdtYV9xID0gZGl2X3EoUFNDX1FfUk9VTkRfT0ZGU0VULCBm
Y19xKTsKPiArICAgICAgIGcwX3EgPSAxIDw8IFBTQ19RX0ZSQUNUSU9OOwo+ICsgICAgICAgZzFf
cSA9IGV4cF9hcHByb3hfcShkaXZfcSgtUFNDX1FfUk9VTkRfT0ZGU0VULAo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBtdWx0X3Eoc2lnbWFfcSwgc2lnbWFfcSkpKTsKPiArICAg
ICAgIGcyX3EgPSBtdWx0X3EoZzFfcSwgZzFfcSk7Cj4gKyAgICAgICBjb2VmW3BoYXNlX2NudCAm
IFBTQ19QSEFTRV9NQVNLXVt0YXBfY250MSA+PiBQU0NfQklUU19GT1JfUEhBU0VdID0gZzBfcTsK
PiArCj4gKyAgICAgICBmb3IgKGkgPSAwOyBpIDwgbWlkOyBpKyspIHsKPiArICAgICAgICAgICAg
ICAgcGhhc2VfY250Kys7Cj4gKyAgICAgICAgICAgICAgIHRhcF9jbnQxLS07Cj4gKyAgICAgICAg
ICAgICAgIHRhcF9jbnQyKys7Cj4gKwo+ICsgICAgICAgICAgICAgICBnMF9xID0gbXVsdF9xKGcw
X3EsIGcxX3EpOwo+ICsgICAgICAgICAgICAgICBnMV9xID0gbXVsdF9xKGcxX3EsIGcyX3EpOwo+
ICsKPiArICAgICAgICAgICAgICAgaWYgKChwaGFzZV9jbnQgJiBQU0NfUEhBU0VfTUFTSykgPD0g
OCkgewo+ICsgICAgICAgICAgICAgICAgICAgICAgIHRhcF9pZHggPSB0YXBfY250MSA+PiBQU0Nf
QklUU19GT1JfUEhBU0U7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgY29lZltwaGFzZV9jbnQg
JiBQU0NfUEhBU0VfTUFTS11bdGFwX2lkeF0gPSBnMF9xOwo+ICsgICAgICAgICAgICAgICB9Cj4g
KyAgICAgICAgICAgICAgIGlmICgoKC1waGFzZV9jbnQpICYgUFNDX1BIQVNFX01BU0spIDw9IDgp
IHsKPiArICAgICAgICAgICAgICAgICAgICAgICB0YXBfaWR4ID0gdGFwX2NudDIgPj4gUFNDX0JJ
VFNfRk9SX1BIQVNFOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIGNvZWZbKC1waGFzZV9jbnQp
ICYgUFNDX1BIQVNFX01BU0tdW3RhcF9pZHhdID0gZzBfcTsKPiArICAgICAgICAgICAgICAgfQo+
ICsgICAgICAgfQo+ICsKPiArICAgICAgIHBoYXNlX2NudCsrOwo+ICsgICAgICAgdGFwX2NudDEt
LTsKPiArICAgICAgIGNvZWZbcGhhc2VfY250ICYgUFNDX1BIQVNFX01BU0tdW3RhcF9jbnQxID4+
IFBTQ19CSVRTX0ZPUl9QSEFTRV0gPSAwOwo+ICsKPiArICAgICAgIC8qIG92ZXJyaWRlIHBoYXNl
IDAgd2l0aCBpZGVudGl0eSBmaWx0ZXIgaWYgc3BlY2lmaWVkICovCj4gKyAgICAgICBpZiAocGhh
c2UwX2lkZW50aXR5KQo+ICsgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgUFNDX05VTV9U
QVBTOyBpKyspCj4gKyAgICAgICAgICAgICAgICAgICAgICAgY29lZlswXVtpXSA9IGkgPT0gKFBT
Q19OVU1fVEFQUyA+PiAxKSA/Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgKDEgPDwgUFNDX0NPRUZGX1BSRUNJU0lPTikgOiAwOwo+ICsKPiArICAgICAg
IC8qIG5vcm1hbGl6ZSBjb2VmICovCj4gKyAgICAgICBmb3IgKHBoYXNlID0gMDsgcGhhc2UgPCBQ
U0NfU1RPUkVEX1BIQVNFUzsgcGhhc2UrKykgewo+ICsgICAgICAgICAgICAgICBpbnQgc3VtID0g
MDsKPiArICAgICAgICAgICAgICAgczY0IGxsX3RlbXA7Cj4gKwo+ICsgICAgICAgICAgICAgICBm
b3IgKGkgPSAwOyBpIDwgUFNDX05VTV9UQVBTOyBpKyspCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgc3VtICs9IGNvZWZbcGhhc2VdW2ldOwo+ICsgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBp
IDwgUFNDX05VTV9UQVBTOyBpKyspIHsKPiArICAgICAgICAgICAgICAgICAgICAgICBsbF90ZW1w
ID0gY29lZltwaGFzZV1baV07Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgbGxfdGVtcCA8PD0g
UFNDX0NPRUZGX1BSRUNJU0lPTjsKPiArICAgICAgICAgICAgICAgICAgICAgICBsbF90ZW1wICs9
IHN1bSA+PiAxOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIGxsX3RlbXAgLz0gc3VtOwo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIGNvZWZbcGhhc2VdW2ldID0gKGludClsbF90ZW1wOwo+ICsg
ICAgICAgICAgICAgICB9Cj4gKyAgICAgICB9Cj4gK30KPiArCj4gKy8qKgo+ICsgKiBkY3NzX3Nj
YWxlcl9maWx0ZXJfZGVzaWduKCkgLSBDb21wdXRlIGZpbHRlciBjb2VmZmljaWVudHMgdXNpbmcK
PiArICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHYXVzc2lhbiBmaWx0ZXIuCj4gKyAq
IEBzcmNfbGVuZ3RoOiBsZW5ndGggb2YgaW5wdXQKPiArICogQGRzdF9sZW5ndGg6IGxlbmd0aCBv
ZiBvdXRwdXQKPiArICogQHVzZV81X3RhcHM6IDAgZm9yIDcgdGFwcyBwZXIgcGhhc2UsIDEgZm9y
IDUgdGFwcwo+ICsgKiBAY29lZjogb3V0cHV0IGNvZWZmaWNpZW50cwo+ICsgKi8KPiArc3RhdGlj
IHZvaWQgZGNzc19zY2FsZXJfZmlsdGVyX2Rlc2lnbihpbnQgc3JjX2xlbmd0aCwgaW50IGRzdF9s
ZW5ndGgsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sIHVzZV81
X3RhcHMsIGJvb2wgcGhhc2UwX2lkZW50aXR5LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgaW50IGNvZWZbXVtQU0NfTlVNX1RBUFNdKQo+ICt7Cj4gKyAgICAgICBpbnQg
ZmNfcTsKPiArCj4gKyAgICAgICAvKiBjb21wdXRlIGN1dG9mZiBmcmVxdWVuY3kgKi8KPiArICAg
ICAgIGlmIChkc3RfbGVuZ3RoID49IHNyY19sZW5ndGgpCj4gKyAgICAgICAgICAgICAgIGZjX3Eg
PSBkaXZfcSgxLCBQU0NfTlVNX1BIQVNFUyk7Cj4gKyAgICAgICBlbHNlCj4gKyAgICAgICAgICAg
ICAgIGZjX3EgPSBkaXZfcShkc3RfbGVuZ3RoLCBzcmNfbGVuZ3RoICogUFNDX05VTV9QSEFTRVMp
Owo+ICsKPiArICAgICAgIC8qIGNvbXB1dGUgZ2F1c3NpYW4gZmlsdGVyIGNvZWZmaWNpZW50cyAq
Lwo+ICsgICAgICAgZGNzc19zY2FsZXJfZ2F1c3NpYW5fZmlsdGVyKGZjX3EsIHVzZV81X3RhcHMs
IHBoYXNlMF9pZGVudGl0eSwgY29lZik7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGRjc3Nfc2Nh
bGVyX3dyaXRlKHN0cnVjdCBkY3NzX3NjYWxlcl9jaCAqY2gsIHUzMiB2YWwsIHUzMiBvZnMpCj4g
K3sKPiArICAgICAgIHN0cnVjdCBkY3NzX3NjYWxlciAqc2NsID0gY2gtPnNjbDsKPiArCj4gKyAg
ICAgICBkY3NzX2N0eGxkX3dyaXRlKHNjbC0+Y3R4bGQsIHNjbC0+Y3R4X2lkLCB2YWwsIGNoLT5i
YXNlX29mcyArIG9mcyk7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgZGNzc19zY2FsZXJfY2hfaW5p
dF9hbGwoc3RydWN0IGRjc3Nfc2NhbGVyICpzY2wsCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1bnNpZ25lZCBsb25nIHNjYWxlcl9iYXNlKQo+ICt7Cj4gKyAgICAgICBzdHJ1
Y3QgZGNzc19zY2FsZXJfY2ggKmNoOwo+ICsgICAgICAgaW50IGk7Cj4gKwo+ICsgICAgICAgZm9y
IChpID0gMDsgaSA8IDM7IGkrKykgewo+ICsgICAgICAgICAgICAgICBjaCA9ICZzY2wtPmNoW2ld
Owo+ICsKPiArICAgICAgICAgICAgICAgY2gtPmJhc2Vfb2ZzID0gc2NhbGVyX2Jhc2UgKyBpICog
MHg0MDA7Cj4gKwo+ICsgICAgICAgICAgICAgICBjaC0+YmFzZV9yZWcgPSBkZXZtX2lvcmVtYXAo
c2NsLT5kZXYsIGNoLT5iYXNlX29mcywgU1pfNEspOwo+ICsgICAgICAgICAgICAgICBpZiAoIWNo
LT5iYXNlX3JlZykgewo+ICsgICAgICAgICAgICAgICAgICAgICAgIGRldl9lcnIoc2NsLT5kZXYs
ICJzY2FsZXI6IHVuYWJsZSB0byByZW1hcCBjaCBiYXNlXG4iKTsKPiArICAgICAgICAgICAgICAg
ICAgICAgICByZXR1cm4gLUVOT01FTTsKPiArICAgICAgICAgICAgICAgfQo+ICsKPiArICAgICAg
ICAgICAgICAgY2gtPnNjbCA9IHNjbDsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICByZXR1cm4g
MDsKPiArfQo+ICsKPiAraW50IGRjc3Nfc2NhbGVyX2luaXQoc3RydWN0IGRjc3NfZGV2ICpkY3Nz
LCB1bnNpZ25lZCBsb25nIHNjYWxlcl9iYXNlKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZGNzc19z
Y2FsZXIgKnNjYWxlcjsKPiArCj4gKyAgICAgICBzY2FsZXIgPSBkZXZtX2t6YWxsb2MoZGNzcy0+
ZGV2LCBzaXplb2YoKnNjYWxlciksIEdGUF9LRVJORUwpOwo+ICsgICAgICAgaWYgKCFzY2FsZXIp
Cj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwo+ICsKPiArICAgICAgIGRjc3MtPnNj
YWxlciA9IHNjYWxlcjsKPiArICAgICAgIHNjYWxlci0+ZGV2ID0gZGNzcy0+ZGV2Owo+ICsgICAg
ICAgc2NhbGVyLT5jdHhsZCA9IGRjc3MtPmN0eGxkOwo+ICsgICAgICAgc2NhbGVyLT5jdHhfaWQg
PSBDVFhfU0JfSFA7Cj4gKwo+ICsgICAgICAgaWYgKGRjc3Nfc2NhbGVyX2NoX2luaXRfYWxsKHNj
YWxlciwgc2NhbGVyX2Jhc2UpKSB7Cj4gKyAgICAgICAgICAgICAgIGludCBpOwo+ICsKPiArICAg
ICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDM7IGkrKykgewo+ICsgICAgICAgICAgICAgICAg
ICAgICAgIGlmIChzY2FsZXItPmNoW2ldLmJhc2VfcmVnKQo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgZGV2bV9pb3VubWFwKHNjYWxlci0+ZGV2LAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlci0+Y2hbaV0uYmFzZV9yZWcpOwo+ICsg
ICAgICAgICAgICAgICB9Cj4gKwo+ICsgICAgICAgICAgICAgICBkZXZtX2tmcmVlKHNjYWxlci0+
ZGV2LCBzY2FsZXIpOwo+ICsKPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gKyAg
ICAgICB9Cj4gKwo+ICsgICAgICAgcmV0dXJuIDA7Cj4gK30KPiArCj4gK3ZvaWQgZGNzc19zY2Fs
ZXJfZXhpdChzdHJ1Y3QgZGNzc19zY2FsZXIgKnNjbCkKPiArewo+ICsgICAgICAgaW50IGNoX25v
Owo+ICsKPiArICAgICAgIGZvciAoY2hfbm8gPSAwOyBjaF9ubyA8IDM7IGNoX25vKyspIHsKPiAr
ICAgICAgICAgICAgICAgc3RydWN0IGRjc3Nfc2NhbGVyX2NoICpjaCA9ICZzY2wtPmNoW2NoX25v
XTsKPiArCj4gKyAgICAgICAgICAgICAgIGRjc3Nfd3JpdGVsKDAsIGNoLT5iYXNlX3JlZyArIERD
U1NfU0NBTEVSX0NUUkwpOwo+ICsKPiArICAgICAgICAgICAgICAgaWYgKGNoLT5iYXNlX3JlZykK
PiArICAgICAgICAgICAgICAgICAgICAgICBkZXZtX2lvdW5tYXAoc2NsLT5kZXYsIGNoLT5iYXNl
X3JlZyk7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgZGV2bV9rZnJlZShzY2wtPmRldiwgc2Ns
KTsKPiArfQo+ICsKPiArdm9pZCBkY3NzX3NjYWxlcl9jaF9lbmFibGUoc3RydWN0IGRjc3Nfc2Nh
bGVyICpzY2wsIGludCBjaF9udW0sIGJvb2wgZW4pCj4gK3sKPiArICAgICAgIHN0cnVjdCBkY3Nz
X3NjYWxlcl9jaCAqY2ggPSAmc2NsLT5jaFtjaF9udW1dOwo+ICsgICAgICAgdTMyIHNjYWxlcl9j
dHJsOwo+ICsKPiArICAgICAgIHNjYWxlcl9jdHJsID0gZW4gPyBTQ0FMRVJfRU4gfCBSRVBFQVRf
RU4gOiAwOwo+ICsKPiArICAgICAgIGlmIChlbikKPiArICAgICAgICAgICAgICAgZGNzc19zY2Fs
ZXJfd3JpdGUoY2gsIGNoLT5zZGF0YV9jdHJsLCBEQ1NTX1NDQUxFUl9TREFUQV9DVFJMKTsKPiAr
Cj4gKyAgICAgICBpZiAoY2gtPnNjYWxlcl9jdHJsICE9IHNjYWxlcl9jdHJsKQo+ICsgICAgICAg
ICAgICAgICBjaC0+c2NhbGVyX2N0cmxfY2hnZCA9IHRydWU7Cj4gKwo+ICsgICAgICAgY2gtPnNj
YWxlcl9jdHJsID0gc2NhbGVyX2N0cmw7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGRjc3Nfc2Nh
bGVyX3l1dl9lbmFibGUoc3RydWN0IGRjc3Nfc2NhbGVyX2NoICpjaCwgYm9vbCBlbikKPiArewo+
ICsgICAgICAgY2gtPnNkYXRhX2N0cmwgJj0gfllVVl9FTjsKPiArICAgICAgIGNoLT5zZGF0YV9j
dHJsIHw9IGVuID8gWVVWX0VOIDogMDsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgZGNzc19zY2Fs
ZXJfcnRyXzhsaW5lc19lbmFibGUoc3RydWN0IGRjc3Nfc2NhbGVyX2NoICpjaCwgYm9vbCBlbikK
PiArewo+ICsgICAgICAgY2gtPnNkYXRhX2N0cmwgJj0gflJUUkFNXzhMSU5FUzsKPiArICAgICAg
IGNoLT5zZGF0YV9jdHJsIHw9IGVuID8gUlRSQU1fOExJTkVTIDogMDsKPiArfQo+ICsKPiArc3Rh
dGljIHZvaWQgZGNzc19zY2FsZXJfYml0X2RlcHRoX3NldChzdHJ1Y3QgZGNzc19zY2FsZXJfY2gg
KmNoLCBpbnQgZGVwdGgpCj4gK3sKPiArICAgICAgIHUzMiB2YWw7Cj4gKwo+ICsgICAgICAgdmFs
ID0gZGVwdGggPT0gMzAgPyAyIDogMDsKPiArCj4gKyAgICAgICBkY3NzX3NjYWxlcl93cml0ZShj
aCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICgodmFsIDw8IENIUl9CSVRfREVQVEhfUE9T
KSAmIENIUl9CSVRfREVQVEhfTUFTSykgfAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgKCh2
YWwgPDwgTFVNX0JJVF9ERVBUSF9QT1MpICYgTFVNX0JJVF9ERVBUSF9NQVNLKSwKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgIERDU1NfU0NBTEVSX0JJVF9ERVBUSCk7Cj4gK30KPiArCj4gK2Vu
dW0gYnVmZmVyX2Zvcm1hdCB7Cj4gKyAgICAgICBCVUZfRk1UX1lVVjQyMCwKPiArICAgICAgIEJV
Rl9GTVRfWVVWNDIyLAo+ICsgICAgICAgQlVGX0ZNVF9BUkdCODg4OF9ZVVY0NDQsCj4gK307Cj4g
Kwo+ICtlbnVtIGNocm9tYV9sb2NhdGlvbiB7Cj4gKyAgICAgICBQU0NfTE9DX0hPUlpfMF9WRVJU
XzFfT1ZFUl80ID0gMCwKPiArICAgICAgIFBTQ19MT0NfSE9SWl8xX09WRVJfNF9WRVJUXzFfT1ZF
Ul80ID0gMSwKPiArICAgICAgIFBTQ19MT0NfSE9SWl8wX1ZFUlRfMCA9IDIsCj4gKyAgICAgICBQ
U0NfTE9DX0hPUlpfMV9PVkVSXzRfVkVSVF8wID0gMywKPiArICAgICAgIFBTQ19MT0NfSE9SWl8w
X1ZFUlRfMV9PVkVSXzIgPSA0LAo+ICsgICAgICAgUFNDX0xPQ19IT1JaXzFfT1ZFUl80X1ZFUlRf
MV9PVkVSXzIgPSA1Cj4gK307Cj4gKwo+ICtzdGF0aWMgdm9pZCBkY3NzX3NjYWxlcl9mb3JtYXRf
c2V0KHN0cnVjdCBkY3NzX3NjYWxlcl9jaCAqY2gsCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBlbnVtIGJ1ZmZlcl9mb3JtYXQgc3JjX2ZtdCwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGVudW0gYnVmZmVyX2Zvcm1hdCBkc3RfZm10KQo+ICt7Cj4gKyAg
ICAgICBkY3NzX3NjYWxlcl93cml0ZShjaCwgc3JjX2ZtdCwgRENTU19TQ0FMRVJfU1JDX0ZPUk1B
VCk7Cj4gKyAgICAgICBkY3NzX3NjYWxlcl93cml0ZShjaCwgZHN0X2ZtdCwgRENTU19TQ0FMRVJf
RFNUX0ZPUk1BVCk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGRjc3Nfc2NhbGVyX3Jlc19zZXQo
c3RydWN0IGRjc3Nfc2NhbGVyX2NoICpjaCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGludCBzcmNfeHJlcywgaW50IHNyY195cmVzLAo+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgaW50IGRzdF94cmVzLCBpbnQgZHN0X3lyZXMsCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1MzIgcGl4X2Zvcm1hdCwgZW51bSBidWZmZXJfZm9ybWF0IGRzdF9mb3Jt
YXQpCj4gK3sKPiArICAgICAgIHUzMiBsc3JjX3hyZXMsIGxzcmNfeXJlcywgY3NyY194cmVzLCBj
c3JjX3lyZXM7Cj4gKyAgICAgICB1MzIgbGRzdF94cmVzLCBsZHN0X3lyZXMsIGNkc3RfeHJlcywg
Y2RzdF95cmVzOwo+ICsgICAgICAgYm9vbCBzcmNfaXNfNDQ0ID0gdHJ1ZTsKPiArCj4gKyAgICAg
ICBsc3JjX3hyZXMgPSBzcmNfeHJlczsKPiArICAgICAgIGNzcmNfeHJlcyA9IHNyY194cmVzOwo+
ICsgICAgICAgbHNyY195cmVzID0gc3JjX3lyZXM7Cj4gKyAgICAgICBjc3JjX3lyZXMgPSBzcmNf
eXJlczsKPiArICAgICAgIGxkc3RfeHJlcyA9IGRzdF94cmVzOwo+ICsgICAgICAgY2RzdF94cmVz
ID0gZHN0X3hyZXM7Cj4gKyAgICAgICBsZHN0X3lyZXMgPSBkc3RfeXJlczsKPiArICAgICAgIGNk
c3RfeXJlcyA9IGRzdF95cmVzOwo+ICsKPiArICAgICAgIGlmIChwaXhfZm9ybWF0ID09IERSTV9G
T1JNQVRfVVlWWSB8fCBwaXhfZm9ybWF0ID09IERSTV9GT1JNQVRfVllVWSB8fAo+ICsgICAgICAg
ICAgIHBpeF9mb3JtYXQgPT0gRFJNX0ZPUk1BVF9ZVVlWIHx8IHBpeF9mb3JtYXQgPT0gRFJNX0ZP
Uk1BVF9ZVllVKSB7Cj4gKyAgICAgICAgICAgICAgIGNzcmNfeHJlcyA+Pj0gMTsKPiArICAgICAg
ICAgICAgICAgc3JjX2lzXzQ0NCA9IGZhbHNlOwo+ICsgICAgICAgfSBlbHNlIGlmIChwaXhfZm9y
bWF0ID09IERSTV9GT1JNQVRfTlYxMiB8fAo+ICsgICAgICAgICAgICAgICAgICBwaXhfZm9ybWF0
ID09IERSTV9GT1JNQVRfTlYyMSkgewo+ICsgICAgICAgICAgICAgICBjc3JjX3hyZXMgPj49IDE7
Cj4gKyAgICAgICAgICAgICAgIGNzcmNfeXJlcyA+Pj0gMTsKPiArICAgICAgICAgICAgICAgc3Jj
X2lzXzQ0NCA9IGZhbHNlOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGlmIChkc3RfZm9ybWF0
ID09IEJVRl9GTVRfWVVWNDIyKQo+ICsgICAgICAgICAgICAgICBjZHN0X3hyZXMgPj49IDE7Cj4g
Kwo+ICsgICAgICAgLyogZm9yIDQ6NDo0IHRvIDQ6MjoyIGNvbnZlcnNpb24sIHNvdXJjZSBoZWln
aHQgc2hvdWxkIGJlIDEgbGVzcyAqLwo+ICsgICAgICAgaWYgKHNyY19pc180NDQgJiYgZHN0X2Zv
cm1hdCA9PSBCVUZfRk1UX1lVVjQyMikgewo+ICsgICAgICAgICAgICAgICBsc3JjX3lyZXMtLTsK
PiArICAgICAgICAgICAgICAgY3NyY195cmVzLS07Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAg
ZGNzc19zY2FsZXJfd3JpdGUoY2gsICgoKGxzcmNfeXJlcyAtIDEpIDw8IEhFSUdIVF9QT1MpICYg
SEVJR0hUX01BU0spIHwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCgobHNyY194
cmVzIC0gMSkgPDwgV0lEVEhfUE9TKSAmIFdJRFRIX01BU0spLAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgRENTU19TQ0FMRVJfU1JDX0xVTV9SRVMpOwo+ICsgICAgICAgZGNzc19zY2FsZXJf
d3JpdGUoY2gsICgoKGNzcmNfeXJlcyAtIDEpIDw8IEhFSUdIVF9QT1MpICYgSEVJR0hUX01BU0sp
IHwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCgoY3NyY194cmVzIC0gMSkgPDwg
V0lEVEhfUE9TKSAmIFdJRFRIX01BU0spLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgRENT
U19TQ0FMRVJfU1JDX0NIUl9SRVMpOwo+ICsgICAgICAgZGNzc19zY2FsZXJfd3JpdGUoY2gsICgo
KGxkc3RfeXJlcyAtIDEpIDw8IEhFSUdIVF9QT1MpICYgSEVJR0hUX01BU0spIHwKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgKCgobGRzdF94cmVzIC0gMSkgPDwgV0lEVEhfUE9TKSAm
IFdJRFRIX01BU0spLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgRENTU19TQ0FMRVJfRFNU
X0xVTV9SRVMpOwo+ICsgICAgICAgZGNzc19zY2FsZXJfd3JpdGUoY2gsICgoKGNkc3RfeXJlcyAt
IDEpIDw8IEhFSUdIVF9QT1MpICYgSEVJR0hUX01BU0spIHwKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgKCgoY2RzdF94cmVzIC0gMSkgPDwgV0lEVEhfUE9TKSAmIFdJRFRIX01BU0sp
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgRENTU19TQ0FMRVJfRFNUX0NIUl9SRVMpOwo+
ICt9Cj4gKwo+ICsjZGVmaW5lIG1heF9kb3duc2NhbGUocmF0aW8pICAgICAgICAgICAoKHJhdGlv
KSA8PCAxNikKPiArI2RlZmluZSBtYXhfdXBzY2FsZShyYXRpbykgICAgICAgICAgICAgKCgxIDw8
IDE2KSAvIChyYXRpbykpCj4gKwo+ICtzdHJ1Y3QgZGNzc19zY2FsZXJfcmF0aW9zIHsKPiArICAg
ICAgIGludCBkb3duc2NhbGU7Cj4gKyAgICAgICBpbnQgdXBzY2FsZTsKPiArfTsKPiArCj4gK3N0
YXRpYyBjb25zdCBzdHJ1Y3QgZGNzc19zY2FsZXJfcmF0aW9zIGRjc3Nfc2NhbGVyX3JhdGlvc1td
ID0gewo+ICsgICAgICAge21heF9kb3duc2NhbGUoMyksIG1heF91cHNjYWxlKDgpfSwKPiArICAg
ICAgIHttYXhfZG93bnNjYWxlKDUpLCBtYXhfdXBzY2FsZSg4KX0sCj4gKyAgICAgICB7bWF4X2Rv
d25zY2FsZSg1KSwgbWF4X3Vwc2NhbGUoOCl9LAo+ICt9Owo+ICsKPiArc3RhdGljIHZvaWQgZGNz
c19zY2FsZXJfZnJhY3Rpb25zX3NldChzdHJ1Y3QgZGNzc19zY2FsZXJfY2ggKmNoLAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHNyY194cmVzLCBpbnQgc3JjX3ly
ZXMsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgZHN0X3hyZXMs
IGludCBkc3RfeXJlcywKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUz
MiBzcmNfZm9ybWF0LCB1MzIgZHN0X2Zvcm1hdCwKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGVudW0gY2hyb21hX2xvY2F0aW9uIHNyY19jaHJvbWFfbG9jKQo+ICt7Cj4g
KyAgICAgICBpbnQgc3JjX2NfeHJlcywgc3JjX2NfeXJlcywgZHN0X2NfeHJlcywgZHN0X2NfeXJl
czsKPiArICAgICAgIHUzMiBsX3ZpbmMsIGxfaGluYywgY192aW5jLCBjX2hpbmM7Cj4gKyAgICAg
ICB1MzIgY192c3RhcnQsIGNfaHN0YXJ0Owo+ICsKPiArICAgICAgIHNyY19jX3hyZXMgPSBzcmNf
eHJlczsKPiArICAgICAgIHNyY19jX3lyZXMgPSBzcmNfeXJlczsKPiArICAgICAgIGRzdF9jX3hy
ZXMgPSBkc3RfeHJlczsKPiArICAgICAgIGRzdF9jX3lyZXMgPSBkc3RfeXJlczsKPiArCj4gKyAg
ICAgICBjX3ZzdGFydCA9IDA7Cj4gKyAgICAgICBjX2hzdGFydCA9IDA7Cj4gKwo+ICsgICAgICAg
LyogYWRqdXN0bWVudHMgZm9yIHNvdXJjZSBjaHJvbWEgbG9jYXRpb24gKi8KPiArICAgICAgIGlm
IChzcmNfZm9ybWF0ID09IEJVRl9GTVRfWVVWNDIwKSB7Cj4gKyAgICAgICAgICAgICAgIC8qIHZl
cnRpY2FsIGlucHV0IGNocm9tYSBwb3NpdGlvbiBhZGp1c3RtZW50ICovCj4gKyAgICAgICAgICAg
ICAgIHN3aXRjaCAoc3JjX2Nocm9tYV9sb2MpIHsKPiArICAgICAgICAgICAgICAgY2FzZSBQU0Nf
TE9DX0hPUlpfMF9WRVJUXzFfT1ZFUl80Ogo+ICsgICAgICAgICAgICAgICBjYXNlIFBTQ19MT0Nf
SE9SWl8xX09WRVJfNF9WRVJUXzFfT1ZFUl80Ogo+ICsgICAgICAgICAgICAgICAgICAgICAgIC8q
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICogbW92ZSBjaHJvbWEgdXAgdG8gZmlyc3QgbHVt
YSBsaW5lCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICogKDEvNCBjaHJvbWEgaW5wdXQgbGlu
ZSBzcGFjaW5nKQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAqLwo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIGNfdnN0YXJ0IC09ICgxIDw8IChQU0NfUEhBU0VfRlJBQ1RJT05fQklUUyAtIDIp
KTsKPiArICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKPiArICAgICAgICAgICAgICAgY2Fz
ZSBQU0NfTE9DX0hPUlpfMF9WRVJUXzFfT1ZFUl8yOgo+ICsgICAgICAgICAgICAgICBjYXNlIFBT
Q19MT0NfSE9SWl8xX09WRVJfNF9WRVJUXzFfT1ZFUl8yOgo+ICsgICAgICAgICAgICAgICAgICAg
ICAgIC8qCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICogbW92ZSBjaHJvbWEgdXAgdG8gZmly
c3QgbHVtYSBsaW5lCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICogKDEvMiBjaHJvbWEgaW5w
dXQgbGluZSBzcGFjaW5nKQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAqLwo+ICsgICAgICAg
ICAgICAgICAgICAgICAgIGNfdnN0YXJ0IC09ICgxIDw8IChQU0NfUEhBU0VfRlJBQ1RJT05fQklU
UyAtIDEpKTsKPiArICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKPiArICAgICAgICAgICAg
ICAgZGVmYXVsdDoKPiArICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKPiArICAgICAgICAg
ICAgICAgfQo+ICsgICAgICAgICAgICAgICAvKiBob3Jpem9udGFsIGlucHV0IGNocm9tYSBwb3Np
dGlvbiBhZGp1c3RtZW50ICovCj4gKyAgICAgICAgICAgICAgIHN3aXRjaCAoc3JjX2Nocm9tYV9s
b2MpIHsKPiArICAgICAgICAgICAgICAgY2FzZSBQU0NfTE9DX0hPUlpfMV9PVkVSXzRfVkVSVF8x
X09WRVJfNDoKPiArICAgICAgICAgICAgICAgY2FzZSBQU0NfTE9DX0hPUlpfMV9PVkVSXzRfVkVS
VF8wOgo+ICsgICAgICAgICAgICAgICBjYXNlIFBTQ19MT0NfSE9SWl8xX09WRVJfNF9WRVJUXzFf
T1ZFUl8yOgo+ICsgICAgICAgICAgICAgICAgICAgICAgIC8qIG1vdmUgY2hyb21hIGxlZnQgMS80
IGNocm9tYSBpbnB1dCBzYW1wbGUgc3BhY2luZyAqLwo+ICsgICAgICAgICAgICAgICAgICAgICAg
IGNfaHN0YXJ0IC09ICgxIDw8IChQU0NfUEhBU0VfRlJBQ1RJT05fQklUUyAtIDIpKTsKPiArICAg
ICAgICAgICAgICAgICAgICAgICBicmVhazsKPiArICAgICAgICAgICAgICAgZGVmYXVsdDoKPiAr
ICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKPiArICAgICAgICAgICAgICAgfQo+ICsgICAg
ICAgfQo+ICsKPiArICAgICAgIC8qIGFkanVzdG1lbnRzIHRvIGNocm9tYSByZXNvbHV0aW9uICov
Cj4gKyAgICAgICBpZiAoc3JjX2Zvcm1hdCA9PSBCVUZfRk1UX1lVVjQyMCkgewo+ICsgICAgICAg
ICAgICAgICBzcmNfY194cmVzID4+PSAxOwo+ICsgICAgICAgICAgICAgICBzcmNfY195cmVzID4+
PSAxOwo+ICsgICAgICAgfSBlbHNlIGlmIChzcmNfZm9ybWF0ID09IEJVRl9GTVRfWVVWNDIyKSB7
Cj4gKyAgICAgICAgICAgICAgIHNyY19jX3hyZXMgPj49IDE7Cj4gKyAgICAgICB9Cj4gKwo+ICsg
ICAgICAgaWYgKGRzdF9mb3JtYXQgPT0gQlVGX0ZNVF9ZVVY0MjIpCj4gKyAgICAgICAgICAgICAg
IGRzdF9jX3hyZXMgPj49IDE7Cj4gKwo+ICsgICAgICAgbF92aW5jID0gKChzcmNfeXJlcyA8PCAx
MykgKyAoZHN0X3lyZXMgPj4gMSkpIC8gZHN0X3lyZXM7Cj4gKyAgICAgICBjX3ZpbmMgPSAoKHNy
Y19jX3lyZXMgPDwgMTMpICsgKGRzdF9jX3lyZXMgPj4gMSkpIC8gZHN0X2NfeXJlczsKPiArICAg
ICAgIGxfaGluYyA9ICgoc3JjX3hyZXMgPDwgMTMpICsgKGRzdF94cmVzID4+IDEpKSAvIGRzdF94
cmVzOwo+ICsgICAgICAgY19oaW5jID0gKChzcmNfY194cmVzIDw8IDEzKSArIChkc3RfY194cmVz
ID4+IDEpKSAvIGRzdF9jX3hyZXM7Cj4gKwo+ICsgICAgICAgLyogc2F2ZSBjaHJvbWEgc3RhcnQg
cGhhc2UgKi8KPiArICAgICAgIGNoLT5jX3ZzdGFydCA9IGNfdnN0YXJ0Owo+ICsgICAgICAgY2gt
PmNfaHN0YXJ0ID0gY19oc3RhcnQ7Cj4gKwo+ICsgICAgICAgZGNzc19zY2FsZXJfd3JpdGUoY2gs
IDAsIERDU1NfU0NBTEVSX1ZfTFVNX1NUQVJUKTsKPiArICAgICAgIGRjc3Nfc2NhbGVyX3dyaXRl
KGNoLCBsX3ZpbmMsIERDU1NfU0NBTEVSX1ZfTFVNX0lOQyk7Cj4gKwo+ICsgICAgICAgZGNzc19z
Y2FsZXJfd3JpdGUoY2gsIDAsIERDU1NfU0NBTEVSX0hfTFVNX1NUQVJUKTsKPiArICAgICAgIGRj
c3Nfc2NhbGVyX3dyaXRlKGNoLCBsX2hpbmMsIERDU1NfU0NBTEVSX0hfTFVNX0lOQyk7Cj4gKwo+
ICsgICAgICAgZGNzc19zY2FsZXJfd3JpdGUoY2gsIGNfdnN0YXJ0LCBEQ1NTX1NDQUxFUl9WX0NI
Ul9TVEFSVCk7Cj4gKyAgICAgICBkY3NzX3NjYWxlcl93cml0ZShjaCwgY192aW5jLCBEQ1NTX1ND
QUxFUl9WX0NIUl9JTkMpOwo+ICsKPiArICAgICAgIGRjc3Nfc2NhbGVyX3dyaXRlKGNoLCBjX2hz
dGFydCwgRENTU19TQ0FMRVJfSF9DSFJfU1RBUlQpOwo+ICsgICAgICAgZGNzc19zY2FsZXJfd3Jp
dGUoY2gsIGNfaGluYywgRENTU19TQ0FMRVJfSF9DSFJfSU5DKTsKPiArfQo+ICsKPiAraW50IGRj
c3Nfc2NhbGVyX2dldF9taW5fbWF4X3JhdGlvcyhzdHJ1Y3QgZGNzc19zY2FsZXIgKnNjbCwgaW50
IGNoX251bSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCAqbWluLCBp
bnQgKm1heCkKPiArewo+ICsgICAgICAgKm1pbiA9IGRjc3Nfc2NhbGVyX3JhdGlvc1tjaF9udW1d
LnVwc2NhbGU7Cj4gKyAgICAgICAqbWF4ID0gZGNzc19zY2FsZXJfcmF0aW9zW2NoX251bV0uZG93
bnNjYWxlOwo+ICsKPiArICAgICAgIHJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBk
Y3NzX3NjYWxlcl9wcm9ncmFtXzVfY29lZl9zZXQoc3RydWN0IGRjc3Nfc2NhbGVyX2NoICpjaCwK
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGJhc2VfYWRk
ciwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGNvZWZb
XVtQU0NfTlVNX1RBUFNdKQo+ICt7Cj4gKyAgICAgICBpbnQgaSwgcGhhc2U7Cj4gKwo+ICsgICAg
ICAgZm9yIChpID0gMDsgaSA8IFBTQ19TVE9SRURfUEhBU0VTOyBpKyspIHsKPiArICAgICAgICAg
ICAgICAgZGNzc19zY2FsZXJfd3JpdGUoY2gsICgoY29lZltpXVsxXSAmIDB4ZmZmKSA8PCAxNiB8
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGNvZWZbaV1bMl0gJiAw
eGZmZikgPDwgNCAgfAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChj
b2VmW2ldWzNdICYgMHhmMDApID4+IDgpLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBiYXNlX2FkZHIgKyBpICogc2l6ZW9mKHUzMikpOwo+ICsgICAgICAgICAgICAgICBkY3Nz
X3NjYWxlcl93cml0ZShjaCwgKChjb2VmW2ldWzNdICYgMHgwZmYpIDw8IDIwIHwKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoY29lZltpXVs0XSAmIDB4ZmZmKSA8PCA4
ICB8Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGNvZWZbaV1bNV0g
JiAweGZmMCkgPj4gNCksCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2Vf
YWRkciArIDB4NDAgKyBpICogc2l6ZW9mKHUzMikpOwo+ICsgICAgICAgICAgICAgICBkY3NzX3Nj
YWxlcl93cml0ZShjaCwgKChjb2VmW2ldWzVdICYgMHgwMGYpIDw8IDI0KSwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgYmFzZV9hZGRyICsgMHg4MCArIGkgKiBzaXplb2YodTMy
KSk7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgLyogcmV2ZXJzZSBib3RoIHBoYXNlIGFuZCB0
YXAgb3JkZXJpbmdzICovCj4gKyAgICAgICBmb3IgKHBoYXNlID0gKFBTQ19OVU1fUEhBU0VTID4+
IDEpIC0gMTsKPiArICAgICAgICAgICAgICAgICAgICAgICBpIDwgUFNDX05VTV9QSEFTRVM7IGkr
KywgcGhhc2UtLSkgewo+ICsgICAgICAgICAgICAgICBkY3NzX3NjYWxlcl93cml0ZShjaCwgKChj
b2VmW3BoYXNlXVs1XSAmIDB4ZmZmKSA8PCAxNiB8Cj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgKGNvZWZbcGhhc2VdWzRdICYgMHhmZmYpIDw8IDQgIHwKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoY29lZltwaGFzZV1bM10gJiAweGYwMCkg
Pj4gOCksCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VfYWRkciArIGkg
KiBzaXplb2YodTMyKSk7Cj4gKyAgICAgICAgICAgICAgIGRjc3Nfc2NhbGVyX3dyaXRlKGNoLCAo
KGNvZWZbcGhhc2VdWzNdICYgMHgwZmYpIDw8IDIwIHwKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAoY29lZltwaGFzZV1bMl0gJiAweGZmZikgPDwgOCAgfAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjb2VmW3BoYXNlXVsxXSAmIDB4ZmYw
KSA+PiA0KSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZV9hZGRyICsg
MHg0MCArIGkgKiBzaXplb2YodTMyKSk7Cj4gKyAgICAgICAgICAgICAgIGRjc3Nfc2NhbGVyX3dy
aXRlKGNoLCAoKGNvZWZbcGhhc2VdWzFdICYgMHgwMGYpIDw8IDI0KSwKPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgYmFzZV9hZGRyICsgMHg4MCArIGkgKiBzaXplb2YodTMyKSk7
Cj4gKyAgICAgICB9Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGRjc3Nfc2NhbGVyX3Byb2dyYW1f
N19jb2VmX3NldChzdHJ1Y3QgZGNzc19zY2FsZXJfY2ggKmNoLAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgYmFzZV9hZGRyLAo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgY29lZltdW1BTQ19OVU1fVEFQU10pCj4g
K3sKPiArICAgICAgIGludCBpLCBwaGFzZTsKPiArCj4gKyAgICAgICBmb3IgKGkgPSAwOyBpIDwg
UFNDX1NUT1JFRF9QSEFTRVM7IGkrKykgewo+ICsgICAgICAgICAgICAgICBkY3NzX3NjYWxlcl93
cml0ZShjaCwgKChjb2VmW2ldWzBdICYgMHhmZmYpIDw8IDE2IHwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAoY29lZltpXVsxXSAmIDB4ZmZmKSA8PCA0ICB8Cj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGNvZWZbaV1bMl0gJiAweGYwMCkg
Pj4gOCksCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VfYWRkciArIGkg
KiBzaXplb2YodTMyKSk7Cj4gKyAgICAgICAgICAgICAgIGRjc3Nfc2NhbGVyX3dyaXRlKGNoLCAo
KGNvZWZbaV1bMl0gJiAweDBmZikgPDwgMjAgfAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIChjb2VmW2ldWzNdICYgMHhmZmYpIDw8IDggIHwKPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAoY29lZltpXVs0XSAmIDB4ZmYwKSA+PiA0KSwKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZV9hZGRyICsgMHg0MCArIGkgKiBz
aXplb2YodTMyKSk7Cj4gKyAgICAgICAgICAgICAgIGRjc3Nfc2NhbGVyX3dyaXRlKGNoLCAoKGNv
ZWZbaV1bNF0gJiAweDAwZikgPDwgMjQgfAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIChjb2VmW2ldWzVdICYgMHhmZmYpIDw8IDEyIHwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAoY29lZltpXVs2XSAmIDB4ZmZmKSksCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VfYWRkciArIDB4ODAgKyBpICogc2l6ZW9mKHUz
MikpOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIC8qIHJldmVyc2UgYm90aCBwaGFzZSBhbmQg
dGFwIG9yZGVyaW5ncyAqLwo+ICsgICAgICAgZm9yIChwaGFzZSA9IChQU0NfTlVNX1BIQVNFUyA+
PiAxKSAtIDE7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgaSA8IFBTQ19OVU1fUEhBU0VTOyBp
KyssIHBoYXNlLS0pIHsKPiArICAgICAgICAgICAgICAgZGNzc19zY2FsZXJfd3JpdGUoY2gsICgo
Y29lZltwaGFzZV1bNl0gJiAweGZmZikgPDwgMTYgfAo+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIChjb2VmW3BoYXNlXVs1XSAmIDB4ZmZmKSA8PCA0ICB8Cj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGNvZWZbcGhhc2VdWzRdICYgMHhmMDAp
ID4+IDgpLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlX2FkZHIgKyBp
ICogc2l6ZW9mKHUzMikpOwo+ICsgICAgICAgICAgICAgICBkY3NzX3NjYWxlcl93cml0ZShjaCwg
KChjb2VmW3BoYXNlXVs0XSAmIDB4MGZmKSA8PCAyMCB8Cj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgKGNvZWZbcGhhc2VdWzNdICYgMHhmZmYpIDw8IDggIHwKPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoY29lZltwaGFzZV1bMl0gJiAweGZm
MCkgPj4gNCksCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VfYWRkciAr
IDB4NDAgKyBpICogc2l6ZW9mKHUzMikpOwo+ICsgICAgICAgICAgICAgICBkY3NzX3NjYWxlcl93
cml0ZShjaCwgKChjb2VmW3BoYXNlXVsyXSAmIDB4MDBmKSA8PCAyNCB8Cj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgKGNvZWZbcGhhc2VdWzFdICYgMHhmZmYpIDw8IDEy
IHwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoY29lZltwaGFzZV1b
MF0gJiAweGZmZikpLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlX2Fk
ZHIgKyAweDgwICsgaSAqIHNpemVvZih1MzIpKTsKPiArICAgICAgIH0KPiArfQo+ICsKPiArc3Rh
dGljIHZvaWQgZGNzc19zY2FsZXJfeXV2X2NvZWZfc2V0KHN0cnVjdCBkY3NzX3NjYWxlcl9jaCAq
Y2gsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudW0gYnVmZmVyX2Zv
cm1hdCBzcmNfZm9ybWF0LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBl
bnVtIGJ1ZmZlcl9mb3JtYXQgZHN0X2Zvcm1hdCwKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgYm9vbCB1c2VfNV90YXBzLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBpbnQgc3JjX3hyZXMsIGludCBzcmNfeXJlcywgaW50IGRzdF94cmVzLAo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgZHN0X3lyZXMpCj4gK3sKPiAr
ICAgICAgIGludCBjb2VmW1BTQ19TVE9SRURfUEhBU0VTXVtQU0NfTlVNX1RBUFNdOwo+ICsgICAg
ICAgYm9vbCBwcm9ncmFtXzVfdGFwcyA9IHVzZV81X3RhcHMgfHwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAoZHN0X2Zvcm1hdCA9PSBCVUZfRk1UX1lVVjQyMiAmJgo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBzcmNfZm9ybWF0ID09IEJVRl9GTVRfQVJHQjg4ODhfWVVW
NDQ0KTsKPiArCj4gKyAgICAgICAvKiBob3Jpem9udGFsIGx1bWEgKi8KPiArICAgICAgIGRjc3Nf
c2NhbGVyX2ZpbHRlcl9kZXNpZ24oc3JjX3hyZXMsIGRzdF94cmVzLCBmYWxzZSwKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjX3hyZXMgPT0gZHN0X3hyZXMsIGNvZWYpOwo+
ICsgICAgICAgZGNzc19zY2FsZXJfcHJvZ3JhbV83X2NvZWZfc2V0KGNoLCBEQ1NTX1NDQUxFUl9D
T0VGX0hMVU0sIGNvZWYpOwo+ICsKPiArICAgICAgIC8qIHZlcnRpY2FsIGx1bWEgKi8KPiArICAg
ICAgIGRjc3Nfc2NhbGVyX2ZpbHRlcl9kZXNpZ24oc3JjX3lyZXMsIGRzdF95cmVzLCBwcm9ncmFt
XzVfdGFwcywKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjX3lyZXMgPT0g
ZHN0X3lyZXMsIGNvZWYpOwo+ICsKPiArICAgICAgIGlmIChwcm9ncmFtXzVfdGFwcykKPiArICAg
ICAgICAgICAgICAgZGNzc19zY2FsZXJfcHJvZ3JhbV81X2NvZWZfc2V0KGNoLCBEQ1NTX1NDQUxF
Ul9DT0VGX1ZMVU0sIGNvZWYpOwo+ICsgICAgICAgZWxzZQo+ICsgICAgICAgICAgICAgICBkY3Nz
X3NjYWxlcl9wcm9ncmFtXzdfY29lZl9zZXQoY2gsIERDU1NfU0NBTEVSX0NPRUZfVkxVTSwgY29l
Zik7Cj4gKwo+ICsgICAgICAgLyogYWRqdXN0IGNocm9tYSByZXNvbHV0aW9uICovCj4gKyAgICAg
ICBpZiAoc3JjX2Zvcm1hdCAhPSBCVUZfRk1UX0FSR0I4ODg4X1lVVjQ0NCkKPiArICAgICAgICAg
ICAgICAgc3JjX3hyZXMgPj49IDE7Cj4gKyAgICAgICBpZiAoc3JjX2Zvcm1hdCA9PSBCVUZfRk1U
X1lVVjQyMCkKPiArICAgICAgICAgICAgICAgc3JjX3lyZXMgPj49IDE7Cj4gKyAgICAgICBpZiAo
ZHN0X2Zvcm1hdCAhPSBCVUZfRk1UX0FSR0I4ODg4X1lVVjQ0NCkKPiArICAgICAgICAgICAgICAg
ZHN0X3hyZXMgPj49IDE7Cj4gKyAgICAgICBpZiAoZHN0X2Zvcm1hdCA9PSBCVUZfRk1UX1lVVjQy
MCkgLyogc2hvdWxkIG5vdCBoYXBwZW4gKi8KPiArICAgICAgICAgICAgICAgZHN0X3lyZXMgPj49
IDE7Cj4gKwo+ICsgICAgICAgLyogaG9yaXpvbnRhbCBjaHJvbWEgKi8KPiArICAgICAgIGRjc3Nf
c2NhbGVyX2ZpbHRlcl9kZXNpZ24oc3JjX3hyZXMsIGRzdF94cmVzLCBmYWxzZSwKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgKHNyY194cmVzID09IGRzdF94cmVzKSAmJiAoY2gt
PmNfaHN0YXJ0ID09IDApLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2Vm
KTsKPiArCj4gKyAgICAgICBkY3NzX3NjYWxlcl9wcm9ncmFtXzdfY29lZl9zZXQoY2gsIERDU1Nf
U0NBTEVSX0NPRUZfSENIUiwgY29lZik7Cj4gKwo+ICsgICAgICAgLyogdmVydGljYWwgY2hyb21h
ICovCj4gKyAgICAgICBkY3NzX3NjYWxlcl9maWx0ZXJfZGVzaWduKHNyY195cmVzLCBkc3RfeXJl
cywgcHJvZ3JhbV81X3RhcHMsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChz
cmNfeXJlcyA9PSBkc3RfeXJlcykgJiYgKGNoLT5jX3ZzdGFydCA9PSAwKSwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY29lZik7Cj4gKyAgICAgICBpZiAocHJvZ3JhbV81X3Rh
cHMpCj4gKyAgICAgICAgICAgICAgIGRjc3Nfc2NhbGVyX3Byb2dyYW1fNV9jb2VmX3NldChjaCwg
RENTU19TQ0FMRVJfQ09FRl9WQ0hSLCBjb2VmKTsKPiArICAgICAgIGVsc2UKPiArICAgICAgICAg
ICAgICAgZGNzc19zY2FsZXJfcHJvZ3JhbV83X2NvZWZfc2V0KGNoLCBEQ1NTX1NDQUxFUl9DT0VG
X1ZDSFIsIGNvZWYpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBkY3NzX3NjYWxlcl9yZ2JfY29l
Zl9zZXQoc3RydWN0IGRjc3Nfc2NhbGVyX2NoICpjaCwKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgaW50IHNyY194cmVzLCBpbnQgc3JjX3lyZXMsIGludCBkc3RfeHJlcywK
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGRzdF95cmVzKQo+ICt7
Cj4gKyAgICAgICBpbnQgY29lZltQU0NfU1RPUkVEX1BIQVNFU11bUFNDX05VTV9UQVBTXTsKPiAr
Cj4gKyAgICAgICAvKiBob3Jpem9udGFsIFJHQiAqLwo+ICsgICAgICAgZGNzc19zY2FsZXJfZmls
dGVyX2Rlc2lnbihzcmNfeHJlcywgZHN0X3hyZXMsIGZhbHNlLAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzcmNfeHJlcyA9PSBkc3RfeHJlcywgY29lZik7Cj4gKyAgICAgICBk
Y3NzX3NjYWxlcl9wcm9ncmFtXzdfY29lZl9zZXQoY2gsIERDU1NfU0NBTEVSX0NPRUZfSExVTSwg
Y29lZik7Cj4gKwo+ICsgICAgICAgLyogdmVydGljYWwgUkdCICovCj4gKyAgICAgICBkY3NzX3Nj
YWxlcl9maWx0ZXJfZGVzaWduKHNyY195cmVzLCBkc3RfeXJlcywgZmFsc2UsCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHNyY195cmVzID09IGRzdF95cmVzLCBjb2VmKTsKPiAr
ICAgICAgIGRjc3Nfc2NhbGVyX3Byb2dyYW1fN19jb2VmX3NldChjaCwgRENTU19TQ0FMRVJfQ09F
Rl9WTFVNLCBjb2VmKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgZGNzc19zY2FsZXJfc2V0X3Jn
YjEwX29yZGVyKHN0cnVjdCBkY3NzX3NjYWxlcl9jaCAqY2gsCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCBkcm1fZm9ybWF0X2luZm8gKmZvcm1h
dCkKPiArewo+ICsgICAgICAgdTMyIGEycjEwZzEwYjEwX2Zvcm1hdDsKPiArCj4gKyAgICAgICBp
ZiAoZm9ybWF0LT5pc195dXYpCj4gKyAgICAgICAgICAgICAgIHJldHVybjsKPiArCj4gKyAgICAg
ICBjaC0+c2RhdGFfY3RybCAmPSB+QTJSMTBHMTBCMTBfRk9STUFUX01BU0s7Cj4gKwo+ICsgICAg
ICAgaWYgKGZvcm1hdC0+ZGVwdGggIT0gMzApCj4gKyAgICAgICAgICAgICAgIHJldHVybjsKPiAr
Cj4gKyAgICAgICBzd2l0Y2ggKGZvcm1hdC0+Zm9ybWF0KSB7Cj4gKyAgICAgICBjYXNlIERSTV9G
T1JNQVRfQVJHQjIxMDEwMTA6Cj4gKyAgICAgICBjYXNlIERSTV9GT1JNQVRfWFJHQjIxMDEwMTA6
Cj4gKyAgICAgICAgICAgICAgIGEycjEwZzEwYjEwX2Zvcm1hdCA9IDA7Cj4gKyAgICAgICAgICAg
ICAgIGJyZWFrOwo+ICsKPiArICAgICAgIGNhc2UgRFJNX0ZPUk1BVF9BQkdSMjEwMTAxMDoKPiAr
ICAgICAgIGNhc2UgRFJNX0ZPUk1BVF9YQkdSMjEwMTAxMDoKPiArICAgICAgICAgICAgICAgYTJy
MTBnMTBiMTBfZm9ybWF0ID0gNTsKPiArICAgICAgICAgICAgICAgYnJlYWs7Cj4gKwo+ICsgICAg
ICAgY2FzZSBEUk1fRk9STUFUX1JHQkExMDEwMTAyOgo+ICsgICAgICAgY2FzZSBEUk1fRk9STUFU
X1JHQlgxMDEwMTAyOgo+ICsgICAgICAgICAgICAgICBhMnIxMGcxMGIxMF9mb3JtYXQgPSA2Owo+
ICsgICAgICAgICAgICAgICBicmVhazsKPiArCj4gKyAgICAgICBjYXNlIERSTV9GT1JNQVRfQkdS
QTEwMTAxMDI6Cj4gKyAgICAgICBjYXNlIERSTV9GT1JNQVRfQkdSWDEwMTAxMDI6Cj4gKyAgICAg
ICAgICAgICAgIGEycjEwZzEwYjEwX2Zvcm1hdCA9IDExOwo+ICsgICAgICAgICAgICAgICBicmVh
azsKPiArCj4gKyAgICAgICBkZWZhdWx0Ogo+ICsgICAgICAgICAgICAgICBhMnIxMGcxMGIxMF9m
b3JtYXQgPSAwOwo+ICsgICAgICAgICAgICAgICBicmVhazsKPiArICAgICAgIH0KPiArCj4gKyAg
ICAgICBjaC0+c2RhdGFfY3RybCB8PSBhMnIxMGcxMGIxMF9mb3JtYXQgPDwgQTJSMTBHMTBCMTBf
Rk9STUFUX1BPUzsKPiArfQo+ICsKPiArdm9pZCBkY3NzX3NjYWxlcl9zZXR1cChzdHJ1Y3QgZGNz
c19zY2FsZXIgKnNjbCwgaW50IGNoX251bSwKPiArICAgICAgICAgICAgICAgICAgICAgIGNvbnN0
IHN0cnVjdCBkcm1fZm9ybWF0X2luZm8gKmZvcm1hdCwKPiArICAgICAgICAgICAgICAgICAgICAg
IGludCBzcmNfeHJlcywgaW50IHNyY195cmVzLCBpbnQgZHN0X3hyZXMsIGludCBkc3RfeXJlcywK
PiArICAgICAgICAgICAgICAgICAgICAgIHUzMiB2cmVmcmVzaF9oeikKPiArewo+ICsgICAgICAg
c3RydWN0IGRjc3Nfc2NhbGVyX2NoICpjaCA9ICZzY2wtPmNoW2NoX251bV07Cj4gKyAgICAgICB1
bnNpZ25lZCBpbnQgcGl4ZWxfZGVwdGggPSAwOwo+ICsgICAgICAgYm9vbCBydHJfOGxpbmVfZW4g
PSBmYWxzZTsKPiArICAgICAgIGJvb2wgdXNlXzVfdGFwcyA9IGZhbHNlOwo+ICsgICAgICAgZW51
bSBidWZmZXJfZm9ybWF0IHNyY19mb3JtYXQgPSBCVUZfRk1UX0FSR0I4ODg4X1lVVjQ0NDsKPiAr
ICAgICAgIGVudW0gYnVmZmVyX2Zvcm1hdCBkc3RfZm9ybWF0ID0gQlVGX0ZNVF9BUkdCODg4OF9Z
VVY0NDQ7Cj4gKyAgICAgICB1MzIgcGl4X2Zvcm1hdCA9IGZvcm1hdC0+Zm9ybWF0Owo+ICsKPiAr
ICAgICAgIGlmIChmb3JtYXQtPmlzX3l1dikgewo+ICsgICAgICAgICAgICAgICBkY3NzX3NjYWxl
cl95dXZfZW5hYmxlKGNoLCB0cnVlKTsKPiArCj4gKyAgICAgICAgICAgICAgIGlmIChwaXhfZm9y
bWF0ID09IERSTV9GT1JNQVRfTlYxMiB8fAo+ICsgICAgICAgICAgICAgICAgICAgcGl4X2Zvcm1h
dCA9PSBEUk1fRk9STUFUX05WMjEgfHwKPiArICAgICAgICAgICAgICAgICAgIHBpeF9mb3JtYXQg
PT0gRFJNX0ZPUk1BVF9QMDEwKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgcnRyXzhsaW5l
X2VuID0gdHJ1ZTsKPiArICAgICAgICAgICAgICAgICAgICAgICBzcmNfZm9ybWF0ID0gQlVGX0ZN
VF9ZVVY0MjA7Cj4gKyAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGl4X2Zvcm1hdCA9PSBEUk1f
Rk9STUFUX1VZVlkgfHwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICBwaXhfZm9ybWF0ID09
IERSTV9GT1JNQVRfVllVWSB8fAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgIHBpeF9mb3Jt
YXQgPT0gRFJNX0ZPUk1BVF9ZVVlWIHx8Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgcGl4
X2Zvcm1hdCA9PSBEUk1fRk9STUFUX1lWWVUpIHsKPiArICAgICAgICAgICAgICAgICAgICAgICBz
cmNfZm9ybWF0ID0gQlVGX0ZNVF9ZVVY0MjI7Cj4gKyAgICAgICAgICAgICAgIH0KPiArCj4gKyAg
ICAgICAgICAgICAgIHVzZV81X3RhcHMgPSAhcnRyXzhsaW5lX2VuOwo+ICsgICAgICAgICAgICAg
ICBpZiAocGl4X2Zvcm1hdCA9PSBEUk1fRk9STUFUX1AwMTApCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgcGl4ZWxfZGVwdGggPSAzMDsKPiArCj4gKyAgICAgICB9IGVsc2Ugewo+ICsgICAgICAg
ICAgICAgICBkY3NzX3NjYWxlcl95dXZfZW5hYmxlKGNoLCBmYWxzZSk7Cj4gKwo+ICsgICAgICAg
ICAgICAgICBwaXhlbF9kZXB0aCA9IGZvcm1hdC0+ZGVwdGg7Cj4gKyAgICAgICB9Cj4gKwo+ICsg
ICAgICAgZGNzc19zY2FsZXJfZnJhY3Rpb25zX3NldChjaCwgc3JjX3hyZXMsIHNyY195cmVzLCBk
c3RfeHJlcywKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHN0X3lyZXMsIHNy
Y19mb3JtYXQsIGRzdF9mb3JtYXQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFBTQ19MT0NfSE9SWl8wX1ZFUlRfMV9PVkVSXzQpOwo+ICsKPiArICAgICAgIGlmIChmb3JtYXQt
PmlzX3l1dikKPiArICAgICAgICAgICAgICAgZGNzc19zY2FsZXJfeXV2X2NvZWZfc2V0KGNoLCBz
cmNfZm9ybWF0LCBkc3RfZm9ybWF0LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdXNlXzVfdGFwcywgc3JjX3hyZXMsIHNyY195cmVzLAo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgZHN0X3hyZXMsIGRzdF95cmVzKTsKPiArICAgICAg
IGVsc2UKPiArICAgICAgICAgICAgICAgZGNzc19zY2FsZXJfcmdiX2NvZWZfc2V0KGNoLCBzcmNf
eHJlcywgc3JjX3lyZXMsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBkc3RfeHJlcywgZHN0X3lyZXMpOwo+ICsKPiArICAgICAgIGRjc3Nfc2NhbGVyX3J0cl84bGlu
ZXNfZW5hYmxlKGNoLCBydHJfOGxpbmVfZW4pOwo+ICsgICAgICAgZGNzc19zY2FsZXJfYml0X2Rl
cHRoX3NldChjaCwgcGl4ZWxfZGVwdGgpOwo+ICsgICAgICAgZGNzc19zY2FsZXJfc2V0X3JnYjEw
X29yZGVyKGNoLCBmb3JtYXQpOwo+ICsgICAgICAgZGNzc19zY2FsZXJfZm9ybWF0X3NldChjaCwg
c3JjX2Zvcm1hdCwgZHN0X2Zvcm1hdCk7Cj4gKyAgICAgICBkY3NzX3NjYWxlcl9yZXNfc2V0KGNo
LCBzcmNfeHJlcywgc3JjX3lyZXMsIGRzdF94cmVzLCBkc3RfeXJlcywKPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgcGl4X2Zvcm1hdCwgZHN0X2Zvcm1hdCk7Cj4gK30KPiArCj4gKy8qIFRo
aXMgZnVuY3Rpb24gd2lsbCBiZSBjYWxsZWQgZnJvbSBpbnRlcnJ1cHQgY29udGV4dC4gKi8KPiAr
dm9pZCBkY3NzX3NjYWxlcl93cml0ZV9zY2xjdHJsKHN0cnVjdCBkY3NzX3NjYWxlciAqc2NsKQo+
ICt7Cj4gKyAgICAgICBpbnQgY2hudW07Cj4gKwo+ICsgICAgICAgZm9yIChjaG51bSA9IDA7IGNo
bnVtIDwgMzsgY2hudW0rKykgewo+ICsgICAgICAgICAgICAgICBzdHJ1Y3QgZGNzc19zY2FsZXJf
Y2ggKmNoID0gJnNjbC0+Y2hbY2hudW1dOwo+ICsKPiArICAgICAgICAgICAgICAgaWYgKGNoLT5z
Y2FsZXJfY3RybF9jaGdkKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgZGNzc19jdHhsZF93
cml0ZV9pcnFzYWZlKHNjbC0+Y3R4bGQsIHNjbC0+Y3R4X2lkLAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaC0+c2NhbGVyX2N0cmwsCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoLT5iYXNlX29mcyAr
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERDU1Nf
U0NBTEVSX0NUUkwpOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIGNoLT5zY2FsZXJfY3RybF9j
aGdkID0gZmFsc2U7Cj4gKyAgICAgICAgICAgICAgIH0KPiArICAgICAgIH0KPiArfQo+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaW14L2Rjc3MvZGNzcy1zcy5jIGIvZHJpdmVycy9ncHUv
ZHJtL2lteC9kY3NzL2Rjc3Mtc3MuYwo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0Cj4gaW5kZXggMDAw
MDAwMDAuLjY1YTA1YzIKPiAtLS0gL2Rldi9udWxsCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2lt
eC9kY3NzL2Rjc3Mtc3MuYwo+IEBAIC0wLDAgKzEsMTc5IEBACj4gKy8vIFNQRFgtTGljZW5zZS1J
ZGVudGlmaWVyOiBHUEwtMi4wCj4gKy8qCj4gKyAqIENvcHlyaWdodCAyMDE5IE5YUC4KPiArICov
Cj4gKwo+ICsjaW5jbHVkZSA8bGludXgvZGV2aWNlLmg+Cj4gKwo+ICsjaW5jbHVkZSAiZGNzcy1k
ZXYuaCIKPiArCj4gKyNkZWZpbmUgRENTU19TU19TWVNfQ1RSTCAgICAgICAgICAgICAgICAgICAg
ICAgMHgwMAo+ICsjZGVmaW5lICAgUlVOX0VOICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IEJJVCgwKQo+ICsjZGVmaW5lIERDU1NfU1NfRElTUExBWSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgMHgxMAo+ICsjZGVmaW5lICAgTFJDX1hfUE9TICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIDAKPiArI2RlZmluZSAgIExSQ19YX01BU0sgICAgICAgICAgICAgICAgICAgICAgICAg
ICBHRU5NQVNLKDEyLCAwKQo+ICsjZGVmaW5lICAgTFJDX1lfUE9TICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIDE2Cj4gKyNkZWZpbmUgICBMUkNfWV9NQVNLICAgICAgICAgICAgICAgICAgICAg
ICAgICAgR0VOTUFTSygyOCwgMTYpCj4gKyNkZWZpbmUgRENTU19TU19IU1lOQyAgICAgICAgICAg
ICAgICAgICAgICAgICAgMHgyMAo+ICsjZGVmaW5lIERDU1NfU1NfVlNZTkMgICAgICAgICAgICAg
ICAgICAgICAgICAgIDB4MzAKPiArI2RlZmluZSAgIFNZTkNfU1RBUlRfUE9TICAgICAgICAgICAg
ICAgICAgICAgICAwCj4gKyNkZWZpbmUgICBTWU5DX1NUQVJUX01BU0sgICAgICAgICAgICAgICAg
ICAgICAgR0VOTUFTSygxMiwgMCkKPiArI2RlZmluZSAgIFNZTkNfRU5EX1BPUyAgICAgICAgICAg
ICAgICAgICAgICAgICAxNgo+ICsjZGVmaW5lICAgU1lOQ19FTkRfTUFTSyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgR0VOTUFTSygyOCwgMTYpCj4gKyNkZWZpbmUgICBTWU5DX1BPTCAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgQklUKDMxKQo+ICsjZGVmaW5lIERDU1NfU1NfREVf
VUxDICAgICAgICAgICAgICAgICAgICAgICAgIDB4NDAKPiArI2RlZmluZSAgIFVMQ19YX1BPUyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAwCj4gKyNkZWZpbmUgICBVTENfWF9NQVNLICAgICAg
ICAgICAgICAgICAgICAgICAgICAgR0VOTUFTSygxMiwgMCkKPiArI2RlZmluZSAgIFVMQ19ZX1BP
UyAgICAgICAgICAgICAgICAgICAgICAgICAgICAxNgo+ICsjZGVmaW5lICAgVUxDX1lfTUFTSyAg
ICAgICAgICAgICAgICAgICAgICAgICAgIEdFTk1BU0soMjgsIDE2KQo+ICsjZGVmaW5lICAgVUxD
X1BPTCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJJVCgzMSkKPiArI2RlZmluZSBEQ1NT
X1NTX0RFX0xSQyAgICAgICAgICAgICAgICAgICAgICAgICAweDUwCj4gKyNkZWZpbmUgRENTU19T
U19NT0RFICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg2MAo+ICsjZGVmaW5lICAgUElQRV9N
T0RFX1BPUyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMAo+ICsjZGVmaW5lICAgUElQ
RV9NT0RFX01BU0sgICAgICAgICAgICAgICAgICAgICAgIEdFTk1BU0soMSwgMCkKPiArI2RlZmlu
ZSBEQ1NTX1NTX0NPRUZGICAgICAgICAgICAgICAgICAgICAgICAgICAweDcwCj4gKyNkZWZpbmUg
ICBIT1JJWl9BX1BPUyAgICAgICAgICAgICAgICAgICAgICAgICAgMAo+ICsjZGVmaW5lICAgSE9S
SVpfQV9NQVNLICAgICAgICAgICAgICAgICAgICAgICAgIEdFTk1BU0soMywgMCkKPiArI2RlZmlu
ZSAgIEhPUklaX0JfUE9TICAgICAgICAgICAgICAgICAgICAgICAgICA0Cj4gKyNkZWZpbmUgICBI
T1JJWl9CX01BU0sgICAgICAgICAgICAgICAgICAgICAgICAgR0VOTUFTSyg3LCA0KQo+ICsjZGVm
aW5lICAgSE9SSVpfQ19QT1MgICAgICAgICAgICAgICAgICAgICAgICAgIDgKPiArI2RlZmluZSAg
IEhPUklaX0NfTUFTSyAgICAgICAgICAgICAgICAgICAgICAgICBHRU5NQVNLKDExLCA4KQo+ICsj
ZGVmaW5lICAgSE9SSVpfSF9OT1JNX1BPUyAgICAgICAgICAgICAgICAgICAgIDEyCj4gKyNkZWZp
bmUgICBIT1JJWl9IX05PUk1fTUFTSyAgICAgICAgICAgICAgICAgICAgR0VOTUFTSygxNCwgMTIp
Cj4gKyNkZWZpbmUgICBWRVJUX0FfUE9TICAgICAgICAgICAgICAgICAgICAgICAgICAgMTYKPiAr
I2RlZmluZSAgIFZFUlRfQV9NQVNLICAgICAgICAgICAgICAgICAgICAgICAgICBHRU5NQVNLKDE5
LCAxNikKPiArI2RlZmluZSAgIFZFUlRfQl9QT1MgICAgICAgICAgICAgICAgICAgICAgICAgICAy
MAo+ICsjZGVmaW5lICAgVkVSVF9CX01BU0sgICAgICAgICAgICAgICAgICAgICAgICAgIEdFTk1B
U0soMjMsIDIwKQo+ICsjZGVmaW5lICAgVkVSVF9DX1BPUyAgICAgICAgICAgICAgICAgICAgICAg
ICAgIDI0Cj4gKyNkZWZpbmUgICBWRVJUX0NfTUFTSyAgICAgICAgICAgICAgICAgICAgICAgICAg
R0VOTUFTSygyNywgMjQpCj4gKyNkZWZpbmUgICBWRVJUX0hfTk9STV9QT1MgICAgICAgICAgICAg
ICAgICAgICAgMjgKPiArI2RlZmluZSAgIFZFUlRfSF9OT1JNX01BU0sgICAgICAgICAgICAgICAg
ICAgICBHRU5NQVNLKDMwLCAyOCkKPiArI2RlZmluZSBEQ1NTX1NTX0NMSVBfQ0IgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIDB4ODAKPiArI2RlZmluZSBEQ1NTX1NTX0NMSVBfQ1IgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4OTAKPiArI2RlZmluZSAgIENMSVBfTUlOX1BP
UyAgICAgICAgICAgICAgICAgICAgICAgICAwCj4gKyNkZWZpbmUgICBDTElQX01JTl9NQVNLICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHRU5NQVNLKDksIDApCj4gKyNkZWZpbmUgICBD
TElQX01BWF9QT1MgICAgICAgICAgICAgICAgICAgICAgICAgMAo+ICsjZGVmaW5lICAgQ0xJUF9N
QVhfTUFTSyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR0VOTUFTSygyMywgMTYpCj4g
KyNkZWZpbmUgRENTU19TU19JTlRFUl9NT0RFICAgICAgICAgICAgICAgICAgICAgMHhBMAo+ICsj
ZGVmaW5lICAgSU5UX0VOICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJJVCgwKQo+ICsj
ZGVmaW5lICAgVlNZTkNfU0hJRlQgICAgICAgICAgICAgICAgICAgICAgICAgIEJJVCgxKQo+ICsK
PiArc3RydWN0IGRjc3Nfc3Mgewo+ICsgICAgICAgc3RydWN0IGRldmljZSAqZGV2Owo+ICsgICAg
ICAgdm9pZCBfX2lvbWVtICpiYXNlX3JlZzsKPiArICAgICAgIHUzMiBiYXNlX29mczsKPiArCj4g
KyAgICAgICBzdHJ1Y3QgZGNzc19jdHhsZCAqY3R4bGQ7Cj4gKyAgICAgICB1MzIgY3R4X2lkOwo+
ICsKPiArICAgICAgIGJvb2wgaW5fdXNlOwo+ICt9Owo+ICsKPiArc3RhdGljIHZvaWQgZGNzc19z
c193cml0ZShzdHJ1Y3QgZGNzc19zcyAqc3MsIHUzMiB2YWwsIHUzMiBvZnMpCj4gK3sKPiArICAg
ICAgIGlmICghc3MtPmluX3VzZSkKPiArICAgICAgICAgICAgICAgZGNzc193cml0ZWwodmFsLCBz
cy0+YmFzZV9yZWcgKyBvZnMpOwo+ICsKPiArICAgICAgIGRjc3NfY3R4bGRfd3JpdGUoc3MtPmN0
eGxkLCBzcy0+Y3R4X2lkLCB2YWwsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgIHNzLT5iYXNl
X29mcyArIG9mcyk7Cj4gK30KPiArCj4gK2ludCBkY3NzX3NzX2luaXQoc3RydWN0IGRjc3NfZGV2
ICpkY3NzLCB1bnNpZ25lZCBsb25nIHNzX2Jhc2UpCj4gK3sKPiArICAgICAgIHN0cnVjdCBkY3Nz
X3NzICpzczsKPiArCj4gKyAgICAgICBzcyA9IGRldm1fa3phbGxvYyhkY3NzLT5kZXYsIHNpemVv
Zigqc3MpLCBHRlBfS0VSTkVMKTsKPiArICAgICAgIGlmICghc3MpCj4gKyAgICAgICAgICAgICAg
IHJldHVybiAtRU5PTUVNOwo+ICsKPiArICAgICAgIGRjc3MtPnNzID0gc3M7Cj4gKyAgICAgICBz
cy0+ZGV2ID0gZGNzcy0+ZGV2Owo+ICsgICAgICAgc3MtPmN0eGxkID0gZGNzcy0+Y3R4bGQ7Cj4g
Kwo+ICsgICAgICAgc3MtPmJhc2VfcmVnID0gZGV2bV9pb3JlbWFwKGRjc3MtPmRldiwgc3NfYmFz
ZSwgU1pfNEspOwo+ICsgICAgICAgaWYgKCFzcy0+YmFzZV9yZWcpIHsKPiArICAgICAgICAgICAg
ICAgZGV2X2VycihkY3NzLT5kZXYsICJzczogdW5hYmxlIHRvIHJlbWFwIHNzIGJhc2VcbiIpOwo+
ICsgICAgICAgICAgICAgICBkZXZtX2tmcmVlKHNzLT5kZXYsIHNzKTsKPiArICAgICAgICAgICAg
ICAgcmV0dXJuIC1FTk9NRU07Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgc3MtPmJhc2Vfb2Zz
ID0gc3NfYmFzZTsKPiArICAgICAgIHNzLT5jdHhfaWQgPSBDVFhfU0JfSFA7Cj4gKwo+ICsgICAg
ICAgcmV0dXJuIDA7Cj4gK30KPiArCj4gK3ZvaWQgZGNzc19zc19leGl0KHN0cnVjdCBkY3NzX3Nz
ICpzcykKPiArewo+ICsgICAgICAgLyogc3RvcCBTUyAqLwo+ICsgICAgICAgZGNzc193cml0ZWwo
MCwgc3MtPmJhc2VfcmVnICsgRENTU19TU19TWVNfQ1RSTCk7Cj4gKwo+ICsgICAgICAgaWYgKHNz
LT5iYXNlX3JlZykKPiArICAgICAgICAgICAgICAgZGV2bV9pb3VubWFwKHNzLT5kZXYsIHNzLT5i
YXNlX3JlZyk7Cj4gKwo+ICsgICAgICAgZGV2bV9rZnJlZShzcy0+ZGV2LCBzcyk7Cj4gK30KPiAr
Cj4gK3ZvaWQgZGNzc19zc19zdWJzYW1fc2V0KHN0cnVjdCBkY3NzX3NzICpzcykKPiArewo+ICsg
ICAgICAgZGNzc19zc193cml0ZShzcywgMHg0MTYxNDE2MSwgRENTU19TU19DT0VGRik7Cj4gKyAg
ICAgICBkY3NzX3NzX3dyaXRlKHNzLCAwLCBEQ1NTX1NTX01PREUpOwo+ICsgICAgICAgZGNzc19z
c193cml0ZShzcywgMHgwM2ZmMDAwMCwgRENTU19TU19DTElQX0NCKTsKPiArICAgICAgIGRjc3Nf
c3Nfd3JpdGUoc3MsIDB4MDNmZjAwMDAsIERDU1NfU1NfQ0xJUF9DUik7Cj4gK30KPiArCj4gK3Zv
aWQgZGNzc19zc19zeW5jX3NldChzdHJ1Y3QgZGNzc19zcyAqc3MsIHN0cnVjdCB2aWRlb21vZGUg
KnZtLAo+ICsgICAgICAgICAgICAgICAgICAgICBib29sIHBoc3luYywgYm9vbCBwdnN5bmMpCj4g
K3sKPiArICAgICAgIHUxNiBscmNfeCwgbHJjX3k7Cj4gKyAgICAgICB1MTYgaHN5bmNfc3RhcnQs
IGhzeW5jX2VuZDsKPiArICAgICAgIHUxNiB2c3luY19zdGFydCwgdnN5bmNfZW5kOwo+ICsgICAg
ICAgdTE2IGRlX3VsY194LCBkZV91bGNfeTsKPiArICAgICAgIHUxNiBkZV9scmNfeCwgZGVfbHJj
X3k7Cj4gKwo+ICsgICAgICAgbHJjX3ggPSB2bS0+aGZyb250X3BvcmNoICsgdm0tPmhiYWNrX3Bv
cmNoICsgdm0tPmhzeW5jX2xlbiArCj4gKyAgICAgICAgICAgICAgIHZtLT5oYWN0aXZlIC0gMTsK
PiArICAgICAgIGxyY195ID0gdm0tPnZmcm9udF9wb3JjaCArIHZtLT52YmFja19wb3JjaCArIHZt
LT52c3luY19sZW4gKwo+ICsgICAgICAgICAgICAgICB2bS0+dmFjdGl2ZSAtIDE7Cj4gKwo+ICsg
ICAgICAgZGNzc19zc193cml0ZShzcywgKGxyY195IDw8IExSQ19ZX1BPUykgfCBscmNfeCwgRENT
U19TU19ESVNQTEFZKTsKPiArCj4gKyAgICAgICBoc3luY19zdGFydCA9IHZtLT5oZnJvbnRfcG9y
Y2ggKyB2bS0+aGJhY2tfcG9yY2ggKyB2bS0+aHN5bmNfbGVuICsKPiArICAgICAgICAgICAgICAg
ICAgICAgdm0tPmhhY3RpdmUgLSAxOwo+ICsgICAgICAgaHN5bmNfZW5kID0gdm0tPmhzeW5jX2xl
biAtIDE7Cj4gKwo+ICsgICAgICAgZGNzc19zc193cml0ZShzcywgKHBoc3luYyA/IFNZTkNfUE9M
IDogMCkgfAo+ICsgICAgICAgICAgICAgICAgICAgICAoKHUzMiloc3luY19lbmQgPDwgU1lOQ19F
TkRfUE9TKSB8IGhzeW5jX3N0YXJ0LAo+ICsgICAgICAgICAgICAgICAgICAgICBEQ1NTX1NTX0hT
WU5DKTsKPiArCj4gKyAgICAgICB2c3luY19zdGFydCA9IHZtLT52ZnJvbnRfcG9yY2ggLSAxOwo+
ICsgICAgICAgdnN5bmNfZW5kID0gdm0tPnZmcm9udF9wb3JjaCArIHZtLT52c3luY19sZW4gLSAx
Owo+ICsKPiArICAgICAgIGRjc3Nfc3Nfd3JpdGUoc3MsIChwdnN5bmMgPyBTWU5DX1BPTCA6IDAp
IHwKPiArICAgICAgICAgICAgICAgICAgICAgKCh1MzIpdnN5bmNfZW5kIDw8IFNZTkNfRU5EX1BP
UykgfCB2c3luY19zdGFydCwKPiArICAgICAgICAgICAgICAgICAgICAgRENTU19TU19WU1lOQyk7
Cj4gKwo+ICsgICAgICAgZGVfdWxjX3ggPSB2bS0+aHN5bmNfbGVuICsgdm0tPmhiYWNrX3BvcmNo
IC0gMTsKPiArICAgICAgIGRlX3VsY195ID0gdm0tPnZzeW5jX2xlbiArIHZtLT52ZnJvbnRfcG9y
Y2ggKyB2bS0+dmJhY2tfcG9yY2g7Cj4gKwo+ICsgICAgICAgZGNzc19zc193cml0ZShzcywgU1lO
Q19QT0wgfCAoKHUzMilkZV91bGNfeSA8PCBVTENfWV9QT1MpIHwgZGVfdWxjX3gsCj4gKyAgICAg
ICAgICAgICAgICAgICAgIERDU1NfU1NfREVfVUxDKTsKPiArCj4gKyAgICAgICBkZV9scmNfeCA9
IHZtLT5oc3luY19sZW4gKyB2bS0+aGJhY2tfcG9yY2ggKyB2bS0+aGFjdGl2ZSAtIDE7Cj4gKyAg
ICAgICBkZV9scmNfeSA9IHZtLT52c3luY19sZW4gKyB2bS0+dmZyb250X3BvcmNoICsgdm0tPnZi
YWNrX3BvcmNoICsKPiArICAgICAgICAgICAgICAgICAgdm0tPnZhY3RpdmUgLSAxOwo+ICsKPiAr
ICAgICAgIGRjc3Nfc3Nfd3JpdGUoc3MsIChkZV9scmNfeSA8PCBMUkNfWV9QT1MpIHwgZGVfbHJj
X3gsIERDU1NfU1NfREVfTFJDKTsKPiArfQo+ICsKPiArdm9pZCBkY3NzX3NzX2VuYWJsZShzdHJ1
Y3QgZGNzc19zcyAqc3MpCj4gK3sKPiArICAgICAgIGRjc3Nfc3Nfd3JpdGUoc3MsIFJVTl9FTiwg
RENTU19TU19TWVNfQ1RSTCk7Cj4gKyAgICAgICBzcy0+aW5fdXNlID0gdHJ1ZTsKPiArfQo+ICsK
PiArdm9pZCBkY3NzX3NzX2Rpc2FibGUoc3RydWN0IGRjc3Nfc3MgKnNzKQo+ICt7Cj4gKyAgICAg
ICBkY3NzX3NzX3dyaXRlKHNzLCAwLCBEQ1NTX1NTX1NZU19DVFJMKTsKPiArICAgICAgIHNzLT5p
bl91c2UgPSBmYWxzZTsKPiArfQoKPiAtLQo+IDIuNy40Cj4KPiBfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwo+IGRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKPiBk
cmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCj4gaHR0cHM6Ly9saXN0cy5mcmVlZGVza3Rv
cC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWwKX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxA
bGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxt
YW4vbGlzdGluZm8vZHJpLWRldmVs
