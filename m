Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 482BA59A48
	for <lists+dri-devel@lfdr.de>; Fri, 28 Jun 2019 14:14:07 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id DB7EB6E905;
	Fri, 28 Jun 2019 12:13:58 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5730D6E903
 for <dri-devel@lists.freedesktop.org>; Fri, 28 Jun 2019 12:13:51 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx04.intmail.prod.int.phx2.redhat.com
 [10.5.11.14])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 20DA883F42;
 Fri, 28 Jun 2019 12:13:47 +0000 (UTC)
Received: from sirius.home.kraxel.org (ovpn-116-96.ams2.redhat.com
 [10.36.116.96])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 04B555DD61;
 Fri, 28 Jun 2019 12:13:44 +0000 (UTC)
Received: by sirius.home.kraxel.org (Postfix, from userid 1000)
 id A83821753A; Fri, 28 Jun 2019 14:13:39 +0200 (CEST)
From: Gerd Hoffmann <kraxel@redhat.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v5 08/12] drm/virtio: rework virtio_gpu_execbuffer_ioctl
 fencing
Date: Fri, 28 Jun 2019 14:13:34 +0200
Message-Id: <20190628121338.24398-9-kraxel@redhat.com>
In-Reply-To: <20190628121338.24398-1-kraxel@redhat.com>
References: <20190628121338.24398-1-kraxel@redhat.com>
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.14
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.27]); Fri, 28 Jun 2019 12:13:50 +0000 (UTC)
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: David Airlie <airlied@linux.ie>, open list <linux-kernel@vger.kernel.org>,
 "open list:VIRTIO GPU DRIVER" <virtualization@lists.linux-foundation.org>,
 Gerd Hoffmann <kraxel@redhat.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VXNlIGdlbSByZXNlcnZhdGlvbiBoZWxwZXJzIGFuZCBkaXJlY3QgcmVzZXJ2YXRpb25fb2JqZWN0
XyogY2FsbHMKaW5zdGVhZCBvZiB0dG0uCgp2NTogZml4IGZlbmNpbmcgKENoaWEtSSBXdSkuCnYz
OiBBbHNvIGF0dGFjaCB0aGUgYXJyYXkgb2YgZ2VtIG9iamVjdHMgdG8gdGhlIHZpcnRpbyBjb21t
YW5kIGJ1ZmZlciwKc28gd2UgY2FuIGRyb3AgdGhlIG9iamVjdCByZWZlcmVuY2VzIGluIHRoZSBj
b21wbGV0aW9uIGNhbGxiYWNrLiAgTmVlZGVkCmJlY2F1c2UgdHRtIGZlbmNlIGhlbHBlcnMgZ3Jh
YiBhIHJlZmVyZW5jZSBmb3IgdXMsIGJ1dCBnZW0gaGVscGVycwpkb24ndC4KClNpZ25lZC1vZmYt
Ynk6IEdlcmQgSG9mZm1hbm4gPGtyYXhlbEByZWRoYXQuY29tPgpBY2tlZC1ieTogRGFuaWVsIFZl
dHRlciA8ZGFuaWVsLnZldHRlckBmZndsbC5jaD4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vdmlydGlv
L3ZpcnRncHVfZHJ2LmggICB8ICA2ICsrLQogZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1
X2lvY3RsLmMgfCA2MiArKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJt
L3ZpcnRpby92aXJ0Z3B1X3ZxLmMgICAgfCAxNyArKysrLS0tCiAzIGZpbGVzIGNoYW5nZWQsIDQz
IGluc2VydGlvbnMoKyksIDQyIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS92aXJ0aW8vdmlydGdwdV9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8vdmlydGdw
dV9kcnYuaAppbmRleCA5OGQ2NDY3ODlkMjMuLjM1NmQyNzEzMjM4OCAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92
aXJ0aW8vdmlydGdwdV9kcnYuaApAQCAtMTIwLDkgKzEyMCw5IEBAIHN0cnVjdCB2aXJ0aW9fZ3B1
X3ZidWZmZXIgewogCiAJY2hhciAqcmVzcF9idWY7CiAJaW50IHJlc3Bfc2l6ZTsKLQogCXZpcnRp
b19ncHVfcmVzcF9jYiByZXNwX2NiOwogCisJc3RydWN0IHZpcnRpb19ncHVfb2JqZWN0X2FycmF5
ICpvYmpzOwogCXN0cnVjdCBsaXN0X2hlYWQgbGlzdDsKIH07CiAKQEAgLTMxMSw3ICszMTEsOSBA
QCB2b2lkIHZpcnRpb19ncHVfY21kX2NvbnRleHRfZGV0YWNoX3Jlc291cmNlKHN0cnVjdCB2aXJ0
aW9fZ3B1X2RldmljZSAqdmdkZXYsCiAJCQkJCSAgICB1aW50MzJfdCByZXNvdXJjZV9pZCk7CiB2
b2lkIHZpcnRpb19ncHVfY21kX3N1Ym1pdChzdHJ1Y3QgdmlydGlvX2dwdV9kZXZpY2UgKnZnZGV2
LAogCQkJICAgdm9pZCAqZGF0YSwgdWludDMyX3QgZGF0YV9zaXplLAotCQkJICAgdWludDMyX3Qg
Y3R4X2lkLCBzdHJ1Y3QgdmlydGlvX2dwdV9mZW5jZSAqZmVuY2UpOworCQkJICAgdWludDMyX3Qg
Y3R4X2lkLAorCQkJICAgc3RydWN0IHZpcnRpb19ncHVfb2JqZWN0X2FycmF5ICpvYmpzLAorCQkJ
ICAgc3RydWN0IHZpcnRpb19ncHVfZmVuY2UgKmZlbmNlKTsKIHZvaWQgdmlydGlvX2dwdV9jbWRf
dHJhbnNmZXJfZnJvbV9ob3N0XzNkKHN0cnVjdCB2aXJ0aW9fZ3B1X2RldmljZSAqdmdkZXYsCiAJ
CQkJCSAgdWludDMyX3QgcmVzb3VyY2VfaWQsIHVpbnQzMl90IGN0eF9pZCwKIAkJCQkJICB1aW50
NjRfdCBvZmZzZXQsIHVpbnQzMl90IGxldmVsLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L3ZpcnRpby92aXJ0Z3B1X2lvY3RsLmMgYi9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVf
aW9jdGwuYwppbmRleCAwY2FmZjNmYTYyM2UuLmFlNjgzMGFhMzhjOSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X2lvY3RsLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L3ZpcnRpby92aXJ0Z3B1X2lvY3RsLmMKQEAgLTEwNSwxNCArMTA1LDExIEBAIHN0YXRpYyBpbnQg
dmlydGlvX2dwdV9leGVjYnVmZmVyX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQg
KmRhdGEsCiAJc3RydWN0IGRybV92aXJ0Z3B1X2V4ZWNidWZmZXIgKmV4YnVmID0gZGF0YTsKIAlz
dHJ1Y3QgdmlydGlvX2dwdV9kZXZpY2UgKnZnZGV2ID0gZGV2LT5kZXZfcHJpdmF0ZTsKIAlzdHJ1
Y3QgdmlydGlvX2dwdV9mcHJpdiAqdmZwcml2ID0gZHJtX2ZpbGUtPmRyaXZlcl9wcml2OwotCXN0
cnVjdCBkcm1fZ2VtX29iamVjdCAqZ29iajsKIAlzdHJ1Y3QgdmlydGlvX2dwdV9mZW5jZSAqb3V0
X2ZlbmNlOwotCXN0cnVjdCB2aXJ0aW9fZ3B1X29iamVjdCAqcW9iajsKIAlpbnQgcmV0OwogCXVp
bnQzMl90ICpib19oYW5kbGVzID0gTlVMTDsKIAl2b2lkIF9fdXNlciAqdXNlcl9ib19oYW5kbGVz
ID0gTlVMTDsKLQlzdHJ1Y3QgbGlzdF9oZWFkIHZhbGlkYXRlX2xpc3Q7Ci0Jc3RydWN0IHR0bV92
YWxpZGF0ZV9idWZmZXIgKmJ1Zmxpc3QgPSBOVUxMOworCXN0cnVjdCB2aXJ0aW9fZ3B1X29iamVj
dF9hcnJheSAqYnVmbGlzdCA9IE5VTEw7CiAJaW50IGk7CiAJc3RydWN0IHd3X2FjcXVpcmVfY3R4
IHRpY2tldDsKIAlzdHJ1Y3Qgc3luY19maWxlICpzeW5jX2ZpbGU7CkBAIC0xNTUsMTUgKzE1Miwx
MCBAQCBzdGF0aWMgaW50IHZpcnRpb19ncHVfZXhlY2J1ZmZlcl9pb2N0bChzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LCB2b2lkICpkYXRhLAogCQkJcmV0dXJuIG91dF9mZW5jZV9mZDsKIAl9CiAKLQlJ
TklUX0xJU1RfSEVBRCgmdmFsaWRhdGVfbGlzdCk7CiAJaWYgKGV4YnVmLT5udW1fYm9faGFuZGxl
cykgewotCiAJCWJvX2hhbmRsZXMgPSBrdm1hbGxvY19hcnJheShleGJ1Zi0+bnVtX2JvX2hhbmRs
ZXMsCi0JCQkJCSAgIHNpemVvZih1aW50MzJfdCksIEdGUF9LRVJORUwpOwotCQlidWZsaXN0ID0g
a3ZtYWxsb2NfYXJyYXkoZXhidWYtPm51bV9ib19oYW5kbGVzLAotCQkJCQkgICBzaXplb2Yoc3Ry
dWN0IHR0bV92YWxpZGF0ZV9idWZmZXIpLAotCQkJCQkgICBHRlBfS0VSTkVMIHwgX19HRlBfWkVS
Tyk7Ci0JCWlmICghYm9faGFuZGxlcyB8fCAhYnVmbGlzdCkgeworCQkJCQkgICAgc2l6ZW9mKHVp
bnQzMl90KSwgR0ZQX0tFUk5FTCk7CisJCWlmICghYm9faGFuZGxlcykgewogCQkJcmV0ID0gLUVO
T01FTTsKIAkJCWdvdG8gb3V0X3VudXNlZF9mZDsKIAkJfQpAQCAtMTc1LDI1ICsxNjcsMjIgQEAg
c3RhdGljIGludCB2aXJ0aW9fZ3B1X2V4ZWNidWZmZXJfaW9jdGwoc3RydWN0IGRybV9kZXZpY2Ug
KmRldiwgdm9pZCAqZGF0YSwKIAkJCWdvdG8gb3V0X3VudXNlZF9mZDsKIAkJfQogCi0JCWZvciAo
aSA9IDA7IGkgPCBleGJ1Zi0+bnVtX2JvX2hhbmRsZXM7IGkrKykgewotCQkJZ29iaiA9IGRybV9n
ZW1fb2JqZWN0X2xvb2t1cChkcm1fZmlsZSwgYm9faGFuZGxlc1tpXSk7Ci0JCQlpZiAoIWdvYmop
IHsKLQkJCQlyZXQgPSAtRU5PRU5UOwotCQkJCWdvdG8gb3V0X3VudXNlZF9mZDsKLQkJCX0KLQot
CQkJcW9iaiA9IGdlbV90b192aXJ0aW9fZ3B1X29iaihnb2JqKTsKLQkJCWJ1Zmxpc3RbaV0uYm8g
PSAmcW9iai0+dGJvOwotCi0JCQlsaXN0X2FkZCgmYnVmbGlzdFtpXS5oZWFkLCAmdmFsaWRhdGVf
bGlzdCk7CisJCWJ1Zmxpc3QgPSB2aXJ0aW9fZ3B1X2FycmF5X2Zyb21faGFuZGxlcyhkcm1fZmls
ZSwgYm9faGFuZGxlcywKKwkJCQkJCQlleGJ1Zi0+bnVtX2JvX2hhbmRsZXMpOworCQlpZiAoIWJ1
Zmxpc3QpIHsKKwkJCXJldCA9IC1FTk9FTlQ7CisJCQlnb3RvIG91dF91bnVzZWRfZmQ7CiAJCX0K
IAkJa3ZmcmVlKGJvX2hhbmRsZXMpOwogCQlib19oYW5kbGVzID0gTlVMTDsKIAl9CiAKLQlyZXQg
PSB2aXJ0aW9fZ3B1X29iamVjdF9saXN0X3ZhbGlkYXRlKCZ0aWNrZXQsICZ2YWxpZGF0ZV9saXN0
KTsKLQlpZiAocmV0KQotCQlnb3RvIG91dF9mcmVlOworCWlmIChidWZsaXN0KSB7CisJCXJldCA9
IGRybV9nZW1fbG9ja19yZXNlcnZhdGlvbnMoYnVmbGlzdC0+b2JqcywgYnVmbGlzdC0+bmVudHMs
CisJCQkJCQkmdGlja2V0KTsKKwkJaWYgKHJldCkKKwkJCWdvdG8gb3V0X3VudXNlZF9mZDsKKwl9
CiAKIAlidWYgPSBtZW1kdXBfdXNlcih1NjRfdG9fdXNlcl9wdHIoZXhidWYtPmNvbW1hbmQpLCBl
eGJ1Zi0+c2l6ZSk7CiAJaWYgKElTX0VSUihidWYpKSB7CkBAIC0yMTksMjUgKzIwOCwyOCBAQCBz
dGF0aWMgaW50IHZpcnRpb19ncHVfZXhlY2J1ZmZlcl9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2LCB2b2lkICpkYXRhLAogCQlmZF9pbnN0YWxsKG91dF9mZW5jZV9mZCwgc3luY19maWxlLT5m
aWxlKTsKIAl9CiAKKwlpZiAoYnVmbGlzdCkKKwkJZm9yIChpID0gMDsgaSA8IGV4YnVmLT5udW1f
Ym9faGFuZGxlczsgaSsrKQorCQkJcmVzZXJ2YXRpb25fb2JqZWN0X2FkZF9leGNsX2ZlbmNlKGJ1
Zmxpc3QtPm9ianNbaV0tPnJlc3YsCisJCQkJCQkJICAmb3V0X2ZlbmNlLT5mKTsKKwogCXZpcnRp
b19ncHVfY21kX3N1Ym1pdCh2Z2RldiwgYnVmLCBleGJ1Zi0+c2l6ZSwKLQkJCSAgICAgIHZmcHJp
di0+Y3R4X2lkLCBvdXRfZmVuY2UpOworCQkJICAgICAgdmZwcml2LT5jdHhfaWQsIGJ1Zmxpc3Qs
IG91dF9mZW5jZSk7CiAKLQl0dG1fZXVfZmVuY2VfYnVmZmVyX29iamVjdHMoJnRpY2tldCwgJnZh
bGlkYXRlX2xpc3QsICZvdXRfZmVuY2UtPmYpOwotCi0JLyogZmVuY2UgdGhlIGNvbW1hbmQgYm8g
Ki8KLQl2aXJ0aW9fZ3B1X3VucmVmX2xpc3QoJnZhbGlkYXRlX2xpc3QpOwotCWt2ZnJlZShidWZs
aXN0KTsKKwlpZiAoYnVmbGlzdCkKKwkJZHJtX2dlbV91bmxvY2tfcmVzZXJ2YXRpb25zKGJ1Zmxp
c3QtPm9ianMsIGJ1Zmxpc3QtPm5lbnRzLAorCQkJCQkgICAgJnRpY2tldCk7CiAJcmV0dXJuIDA7
CiAKIG91dF9tZW1kdXA6CiAJa2ZyZWUoYnVmKTsKIG91dF91bnJlc3Y6Ci0JdHRtX2V1X2JhY2tv
ZmZfcmVzZXJ2YXRpb24oJnRpY2tldCwgJnZhbGlkYXRlX2xpc3QpOwotb3V0X2ZyZWU6Ci0Jdmly
dGlvX2dwdV91bnJlZl9saXN0KCZ2YWxpZGF0ZV9saXN0KTsKKwlpZiAoYnVmbGlzdCkKKwkJZHJt
X2dlbV91bmxvY2tfcmVzZXJ2YXRpb25zKGJ1Zmxpc3QtPm9ianMsIGJ1Zmxpc3QtPm5lbnRzLCAm
dGlja2V0KTsKIG91dF91bnVzZWRfZmQ6CiAJa3ZmcmVlKGJvX2hhbmRsZXMpOwotCWt2ZnJlZShi
dWZsaXN0KTsKKwlpZiAoYnVmbGlzdCkKKwkJdmlydGlvX2dwdV9hcnJheV9wdXRfZnJlZShidWZs
aXN0KTsKIAogCWlmIChvdXRfZmVuY2VfZmQgPj0gMCkKIAkJcHV0X3VudXNlZF9mZChvdXRfZmVu
Y2VfZmQpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X3ZxLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfdnEuYwppbmRleCA2YzFhOTA3MTc1MzUu
LjBjODdjM2UwODZmOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1
X3ZxLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X3ZxLmMKQEAgLTE5MSw3
ICsxOTEsNyBAQCB2b2lkIHZpcnRpb19ncHVfZGVxdWV1ZV9jdHJsX2Z1bmMoc3RydWN0IHdvcmtf
c3RydWN0ICp3b3JrKQogCX0gd2hpbGUgKCF2aXJ0cXVldWVfZW5hYmxlX2NiKHZnZGV2LT5jdHJs
cS52cSkpOwogCXNwaW5fdW5sb2NrKCZ2Z2Rldi0+Y3RybHEucWxvY2spOwogCi0JbGlzdF9mb3Jf
ZWFjaF9lbnRyeV9zYWZlKGVudHJ5LCB0bXAsICZyZWNsYWltX2xpc3QsIGxpc3QpIHsKKwlsaXN0
X2Zvcl9lYWNoX2VudHJ5KGVudHJ5LCAmcmVjbGFpbV9saXN0LCBsaXN0KSB7CiAJCXJlc3AgPSAo
c3RydWN0IHZpcnRpb19ncHVfY3RybF9oZHIgKillbnRyeS0+cmVzcF9idWY7CiAKIAkJdHJhY2Vf
dmlydGlvX2dwdV9jbWRfcmVzcG9uc2UodmdkZXYtPmN0cmxxLnZxLCByZXNwKTsKQEAgLTIxOCwx
NCArMjE4LDE4IEBAIHZvaWQgdmlydGlvX2dwdV9kZXF1ZXVlX2N0cmxfZnVuYyhzdHJ1Y3Qgd29y
a19zdHJ1Y3QgKndvcmspCiAJCX0KIAkJaWYgKGVudHJ5LT5yZXNwX2NiKQogCQkJZW50cnktPnJl
c3BfY2IodmdkZXYsIGVudHJ5KTsKLQotCQlsaXN0X2RlbCgmZW50cnktPmxpc3QpOwotCQlmcmVl
X3ZidWYodmdkZXYsIGVudHJ5KTsKIAl9CiAJd2FrZV91cCgmdmdkZXYtPmN0cmxxLmFja19xdWV1
ZSk7CiAKIAlpZiAoZmVuY2VfaWQpCiAJCXZpcnRpb19ncHVfZmVuY2VfZXZlbnRfcHJvY2Vzcyh2
Z2RldiwgZmVuY2VfaWQpOworCisJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKGVudHJ5LCB0bXAs
ICZyZWNsYWltX2xpc3QsIGxpc3QpIHsKKwkJaWYgKGVudHJ5LT5vYmpzKQorCQkJdmlydGlvX2dw
dV9hcnJheV9wdXRfZnJlZShlbnRyeS0+b2Jqcyk7CisJCWxpc3RfZGVsKCZlbnRyeS0+bGlzdCk7
CisJCWZyZWVfdmJ1Zih2Z2RldiwgZW50cnkpOworCX0KIH0KIAogdm9pZCB2aXJ0aW9fZ3B1X2Rl
cXVldWVfY3Vyc29yX2Z1bmMoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQpAQCAtOTM5LDcgKzk0
Myw5IEBAIHZvaWQgdmlydGlvX2dwdV9jbWRfdHJhbnNmZXJfZnJvbV9ob3N0XzNkKHN0cnVjdCB2
aXJ0aW9fZ3B1X2RldmljZSAqdmdkZXYsCiAKIHZvaWQgdmlydGlvX2dwdV9jbWRfc3VibWl0KHN0
cnVjdCB2aXJ0aW9fZ3B1X2RldmljZSAqdmdkZXYsCiAJCQkgICB2b2lkICpkYXRhLCB1aW50MzJf
dCBkYXRhX3NpemUsCi0JCQkgICB1aW50MzJfdCBjdHhfaWQsIHN0cnVjdCB2aXJ0aW9fZ3B1X2Zl
bmNlICpmZW5jZSkKKwkJCSAgIHVpbnQzMl90IGN0eF9pZCwKKwkJCSAgIHN0cnVjdCB2aXJ0aW9f
Z3B1X29iamVjdF9hcnJheSAqb2JqcywKKwkJCSAgIHN0cnVjdCB2aXJ0aW9fZ3B1X2ZlbmNlICpm
ZW5jZSkKIHsKIAlzdHJ1Y3QgdmlydGlvX2dwdV9jbWRfc3VibWl0ICpjbWRfcDsKIAlzdHJ1Y3Qg
dmlydGlvX2dwdV92YnVmZmVyICp2YnVmOwpAQCAtOTQ5LDYgKzk1NSw3IEBAIHZvaWQgdmlydGlv
X2dwdV9jbWRfc3VibWl0KHN0cnVjdCB2aXJ0aW9fZ3B1X2RldmljZSAqdmdkZXYsCiAKIAl2YnVm
LT5kYXRhX2J1ZiA9IGRhdGE7CiAJdmJ1Zi0+ZGF0YV9zaXplID0gZGF0YV9zaXplOworCXZidWYt
Pm9ianMgPSBvYmpzOwogCiAJY21kX3AtPmhkci50eXBlID0gY3B1X3RvX2xlMzIoVklSVElPX0dQ
VV9DTURfU1VCTUlUXzNEKTsKIAljbWRfcC0+aGRyLmN0eF9pZCA9IGNwdV90b19sZTMyKGN0eF9p
ZCk7Ci0tIAoyLjE4LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9w
Lm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1k
ZXZlbA==
