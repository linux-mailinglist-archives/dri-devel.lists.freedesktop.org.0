Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id F396710E96D
	for <lists+dri-devel@lfdr.de>; Mon,  2 Dec 2019 12:16:16 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A07BA6E193;
	Mon,  2 Dec 2019 11:16:07 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0547E6E18E
 for <dri-devel@lists.freedesktop.org>; Mon,  2 Dec 2019 11:16:03 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 5472DB2AE;
 Mon,  2 Dec 2019 11:16:01 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: kraxel@redhat.com, airlied@redhat.com, daniel.vetter@ffwll.ch,
 yc_chen@aspeedtech.com, sam@ravnborg.org
Subject: [PATCH v3 2/7] drm/ast: Enable and disable screen in primary-plane
 functions
Date: Mon,  2 Dec 2019 12:15:52 +0100
Message-Id: <20191202111557.15176-3-tzimmermann@suse.de>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191202111557.15176-1-tzimmermann@suse.de>
References: <20191202111557.15176-1-tzimmermann@suse.de>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Zimmermann <tzimmermann@suse.de>, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RW5hYmxpbmcgYW5kIGRpc2FibGluZyB0aGUgc2NyZWVuIHVzZWQgdG8gYmUgZG9uZSBpbiB0aGUg
cmVnaXN0ZXIKaW5pdGlhbGl6YXRpb24gYW5kIHRoZSBEUE1TIGZ1bmN0aW9uLiBOb25lIG9mIHRo
ZXNlIHBsYWNlcyBpcyByZWxhdGVkCnRvIHRoZSBzY3JlZW4ncyBvdXRwdXQuCgpOb3cgdGhlIHBy
aW1hcnkgcGxhbmUncyB1cGRhdGUgYW5kIGRpc2FibGUgZnVuY3Rpb25zIGhhbmRsZSBzY3JlZW4K
ZGlzcGxheSBzdGF0ZS4gVGhlIHByaW1hcnkgcGxhbmUgY2FuIG5vdyBiZSBzd2l0Y2hlZCBvZmYg
d2l0aG91dApkaXNwbGF5aW5nIGdhcmJhZ2UuCgpTaWduZWQtb2ZmLWJ5OiBUaG9tYXMgWmltbWVy
bWFubiA8dHppbW1lcm1hbm5Ac3VzZS5kZT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vYXN0L2FzdF9t
b2RlLmMgfCAyOCArKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tCiAxIGZpbGUgY2hhbmdlZCwg
MTkgaW5zZXJ0aW9ucygrKSwgOSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vYXN0L2FzdF9tb2RlLmMgYi9kcml2ZXJzL2dwdS9kcm0vYXN0L2FzdF9tb2RlLmMKaW5k
ZXggMzNhY2E4MTdiNjg2Li41NDJjZjUyZGY5MGEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9hc3QvYXN0X21vZGUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYXN0L2FzdF9tb2RlLmMKQEAg
LTI3OCwxMiArMjc4LDExIEBAIHN0YXRpYyB2b2lkIGFzdF9zZXRfc3RkX3JlZyhzdHJ1Y3QgZHJt
X2NydGMgKmNydGMsIHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlCiAJanJlZyA9IHN0ZHRh
YmxlLT5taXNjOwogCWFzdF9pb193cml0ZTgoYXN0LCBBU1RfSU9fTUlTQ19QT1JUX1dSSVRFLCBq
cmVnKTsKIAotCS8qIFNldCBTRVEgKi8KKwkvKiBTZXQgU0VROyBleGNlcHQgU2NyZWVuIERpc2Fi
bGUgZmllbGQgKi8KIAlhc3Rfc2V0X2luZGV4X3JlZyhhc3QsIEFTVF9JT19TRVFfUE9SVCwgMHgw
MCwgMHgwMyk7Ci0JZm9yIChpID0gMDsgaSA8IDQ7IGkrKykgeworCWFzdF9zZXRfaW5kZXhfcmVn
X21hc2soYXN0LCBBU1RfSU9fU0VRX1BPUlQsIDB4MDEsIDB4ZGYsIHN0ZHRhYmxlLT5zZXFbMF0p
OworCWZvciAoaSA9IDE7IGkgPCA0OyBpKyspIHsKIAkJanJlZyA9IHN0ZHRhYmxlLT5zZXFbaV07
Ci0JCWlmICghaSkKLQkJCWpyZWcgfD0gMHgyMDsKIAkJYXN0X3NldF9pbmRleF9yZWcoYXN0LCBB
U1RfSU9fU0VRX1BPUlQsIChpICsgMSkgLCBqcmVnKTsKIAl9CiAKQEAgLTU2MiwxNCArNTYxLDEy
IEBAIGludCBhc3RfcHJpbWFyeV9wbGFuZV9oZWxwZXJfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1f
cGxhbmUgKnBsYW5lLAogdm9pZCBhc3RfcHJpbWFyeV9wbGFuZV9oZWxwZXJfYXRvbWljX3VwZGF0
ZShzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKIAkJCQkJICAgIHN0cnVjdCBkcm1fcGxhbmVfc3Rh
dGUgKm9sZF9zdGF0ZSkKIHsKKwlzdHJ1Y3QgYXN0X3ByaXZhdGUgKmFzdCA9IHBsYW5lLT5kZXYt
PmRldl9wcml2YXRlOwogCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnN0YXRlID0gcGxhbmUtPnN0
YXRlOwogCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9IHN0YXRlLT5jcnRjOwogCXN0cnVjdCBkcm1f
Z2VtX3ZyYW1fb2JqZWN0ICpnYm87CiAJczY0IGdwdV9hZGRyOwogCi0JaWYgKCFjcnRjIHx8ICFz
dGF0ZS0+ZmIpCi0JCXJldHVybjsKLQogCWdibyA9IGRybV9nZW1fdnJhbV9vZl9nZW0oc3RhdGUt
PmZiLT5vYmpbMF0pOwogCWdwdV9hZGRyID0gZHJtX2dlbV92cmFtX29mZnNldChnYm8pOwogCWlm
IChXQVJOX09OX09OQ0UoZ3B1X2FkZHIgPCAwKSkKQEAgLTU3Nyw2ICs1NzQsMTcgQEAgdm9pZCBh
c3RfcHJpbWFyeV9wbGFuZV9oZWxwZXJfYXRvbWljX3VwZGF0ZShzdHJ1Y3QgZHJtX3BsYW5lICpw
bGFuZSwKIAogCWFzdF9zZXRfb2Zmc2V0X3JlZyhjcnRjKTsKIAlhc3Rfc2V0X3N0YXJ0X2FkZHJl
c3NfY3J0MShjcnRjLCAodTMyKWdwdV9hZGRyKTsKKworCWFzdF9zZXRfaW5kZXhfcmVnX21hc2so
YXN0LCBBU1RfSU9fU0VRX1BPUlQsIDB4MSwgMHhkZiwgMHgwMCk7Cit9CisKK3N0YXRpYyB2b2lk
Cithc3RfcHJpbWFyeV9wbGFuZV9oZWxwZXJfYXRvbWljX2Rpc2FibGUoc3RydWN0IGRybV9wbGFu
ZSAqcGxhbmUsCisJCQkJCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9sZF9zdGF0ZSkKK3sKKwlz
dHJ1Y3QgYXN0X3ByaXZhdGUgKmFzdCA9IHBsYW5lLT5kZXYtPmRldl9wcml2YXRlOworCisJYXN0
X3NldF9pbmRleF9yZWdfbWFzayhhc3QsIEFTVF9JT19TRVFfUE9SVCwgMHgxLCAweGRmLCAweDIw
KTsKIH0KIAogc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfaGVscGVyX2Z1bmNzIGFzdF9w
cmltYXJ5X3BsYW5lX2hlbHBlcl9mdW5jcyA9IHsKQEAgLTU4NCw2ICs1OTIsNyBAQCBzdGF0aWMg
Y29uc3Qgc3RydWN0IGRybV9wbGFuZV9oZWxwZXJfZnVuY3MgYXN0X3ByaW1hcnlfcGxhbmVfaGVs
cGVyX2Z1bmNzID0gewogCS5jbGVhbnVwX2ZiID0gZHJtX2dlbV92cmFtX3BsYW5lX2hlbHBlcl9j
bGVhbnVwX2ZiLAogCS5hdG9taWNfY2hlY2sgPSBhc3RfcHJpbWFyeV9wbGFuZV9oZWxwZXJfYXRv
bWljX2NoZWNrLAogCS5hdG9taWNfdXBkYXRlID0gYXN0X3ByaW1hcnlfcGxhbmVfaGVscGVyX2F0
b21pY191cGRhdGUsCisJLmF0b21pY19kaXNhYmxlID0gYXN0X3ByaW1hcnlfcGxhbmVfaGVscGVy
X2F0b21pY19kaXNhYmxlLAogfTsKIAogc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfZnVu
Y3MgYXN0X3ByaW1hcnlfcGxhbmVfZnVuY3MgPSB7CkBAIC03MzYsMTEgKzc0NSwxMyBAQCBzdGF0
aWMgdm9pZCBhc3RfY3J0Y19kcG1zKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywgaW50IG1vZGUpCiAJ
aWYgKGFzdC0+Y2hpcCA9PSBBU1QxMTgwKQogCQlyZXR1cm47CiAKKwkvKiBUT0RPOiBNYXliZSBj
b250cm9sIGRpc3BsYXkgc2lnbmFsIGdlbmVyYXRpb24gd2l0aAorCSAqICAgICAgIFN5bmMgRW5h
YmxlIChiaXQgQ1IxNy43KS4KKwkgKi8KIAlzd2l0Y2ggKG1vZGUpIHsKIAljYXNlIERSTV9NT0RF
X0RQTVNfT046CiAJY2FzZSBEUk1fTU9ERV9EUE1TX1NUQU5EQlk6CiAJY2FzZSBEUk1fTU9ERV9E
UE1TX1NVU1BFTkQ6Ci0JCWFzdF9zZXRfaW5kZXhfcmVnX21hc2soYXN0LCBBU1RfSU9fU0VRX1BP
UlQsIDB4MSwgMHhkZiwgMCk7CiAJCWlmIChhc3QtPnR4X2NoaXBfdHlwZSA9PSBBU1RfVFhfRFA1
MDEpCiAJCQlhc3Rfc2V0X2RwNTAxX3ZpZGVvX291dHB1dChjcnRjLT5kZXYsIDEpOwogCQlhc3Rf
Y3J0Y19sb2FkX2x1dChjcnRjKTsKQEAgLTc0OCw3ICs3NTksNiBAQCBzdGF0aWMgdm9pZCBhc3Rf
Y3J0Y19kcG1zKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywgaW50IG1vZGUpCiAJY2FzZSBEUk1fTU9E
RV9EUE1TX09GRjoKIAkJaWYgKGFzdC0+dHhfY2hpcF90eXBlID09IEFTVF9UWF9EUDUwMSkKIAkJ
CWFzdF9zZXRfZHA1MDFfdmlkZW9fb3V0cHV0KGNydGMtPmRldiwgMCk7Ci0JCWFzdF9zZXRfaW5k
ZXhfcmVnX21hc2soYXN0LCBBU1RfSU9fU0VRX1BPUlQsIDB4MSwgMHhkZiwgMHgyMCk7CiAJCWJy
ZWFrOwogCX0KIH0KLS0gCjIuMjMuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGlu
Zm8vZHJpLWRldmVs
