Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 6B4853463E7
	for <lists+dri-devel@lfdr.de>; Tue, 23 Mar 2021 16:58:00 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0FDB16EC1E;
	Tue, 23 Mar 2021 15:57:45 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mblankhorst.nl (mblankhorst.nl [141.105.120.124])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A37AC6EC00
 for <dri-devel@lists.freedesktop.org>; Tue, 23 Mar 2021 15:57:42 +0000 (UTC)
From: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Subject: [PATCH v9 05/70] drm/i915: Ensure we hold the object mutex in pin
 correctly.
Date: Tue, 23 Mar 2021 16:49:54 +0100
Message-Id: <20210323155059.628690-6-maarten.lankhorst@linux.intel.com>
X-Mailer: git-send-email 2.31.0
In-Reply-To: <20210323155059.628690-1-maarten.lankhorst@linux.intel.com>
References: <20210323155059.628690-1-maarten.lankhorst@linux.intel.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: =?UTF-8?q?Thomas=20Hellstr=C3=B6m?= <thomas.hellstrom@linux.intel.com>,
 dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

Q3VycmVudGx5IHdlIGhhdmUgYSBsb3Qgb2YgcGxhY2VzIHdoZXJlIHdlIGhvbGQgdGhlIGdlbSBv
YmplY3QgbG9jaywKYnV0IGhhdmVuJ3QgeWV0IGJlZW4gY29udmVydGVkIHRvIHRoZSB3dyBkYW5j
ZS4gQ29tcGxhaW4gbG91ZGx5IGFib3V0CnRob3NlIHBsYWNlcy4KCmk5MTVfdm1hX3BpbiBzaG91
bGRuJ3QgaGF2ZSB0aGUgb2JqIGxvY2sgaGVsZCwgc28gd2UgY2FuIGRvIGEgd3cgZGFuY2UsCndo
aWxlIGk5MTVfdm1hX3Bpbl93dyBzaG91bGQuCgpTaWduZWQtb2ZmLWJ5OiBNYWFydGVuIExhbmto
b3JzdCA8bWFhcnRlbi5sYW5raG9yc3RAbGludXguaW50ZWwuY29tPgpSZXZpZXdlZC1ieTogVGhv
bWFzIEhlbGxzdHLDtm0gPHRob21hcy5oZWxsc3Ryb21AbGludXguaW50ZWwuY29tPiAjaXJjCi0t
LQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVuZGVyc3RhdGUuYyB8ICAyICstCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jICAgICAgICAgICAgIHwgMTEgKysrKysrKysr
Ky0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmggICAgICAgICAgICAgfCAgMyArKysK
IDMgZmlsZXMgY2hhbmdlZCwgMTQgaW5zZXJ0aW9ucygrKSwgMiBkZWxldGlvbnMoLSkKCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZW5kZXJzdGF0ZS5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVuZGVyc3RhdGUuYwppbmRleCAwZjdjMGExNDhi
ODAuLmIwM2UxOTdiMWQ5OSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfcmVuZGVyc3RhdGUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZW5k
ZXJzdGF0ZS5jCkBAIC0xNzYsNyArMTc2LDcgQEAgaW50IGludGVsX3JlbmRlcnN0YXRlX2luaXQo
c3RydWN0IGludGVsX3JlbmRlcnN0YXRlICpzbywKIAlpZiAoZXJyKQogCQlnb3RvIGVycl9jb250
ZXh0OwogCi0JZXJyID0gaTkxNV92bWFfcGluKHNvLT52bWEsIDAsIDAsIFBJTl9HTE9CQUwgfCBQ
SU5fSElHSCk7CisJZXJyID0gaTkxNV92bWFfcGluX3d3KHNvLT52bWEsICZzby0+d3csIDAsIDAs
IFBJTl9HTE9CQUwgfCBQSU5fSElHSCk7CiAJaWYgKGVycikKIAkJZ290byBlcnJfY29udGV4dDsK
IApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfdm1hLmMKaW5kZXggY2FhOWIwNDE2MTZiLi43MzEwODkzMDg2Zjcg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYwpAQCAtODY1LDYgKzg2NSw4IEBAIGludCBpOTE1X3Zt
YV9waW5fd3coc3RydWN0IGk5MTVfdm1hICp2bWEsIHN0cnVjdCBpOTE1X2dlbV93d19jdHggKnd3
LAogI2lmZGVmIENPTkZJR19QUk9WRV9MT0NLSU5HCiAJaWYgKGRlYnVnX2xvY2tzICYmIGxvY2tk
ZXBfaXNfaGVsZCgmdm1hLT52bS0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCkpCiAJCVdBUk5fT04o
IXd3KTsKKwlpZiAoZGVidWdfbG9ja3MgJiYgd3cgJiYgdm1hLT5yZXN2KQorCQlhc3NlcnRfdm1h
X2hlbGQodm1hKTsKICNlbmRpZgogCiAJQlVJTERfQlVHX09OKFBJTl9HTE9CQUwgIT0gSTkxNV9W
TUFfR0xPQkFMX0JJTkQpOwpAQCAtMTAyMCw4ICsxMDIyLDE1IEBAIGludCBpOTE1X2dndHRfcGlu
KHN0cnVjdCBpOTE1X3ZtYSAqdm1hLCBzdHJ1Y3QgaTkxNV9nZW1fd3dfY3R4ICp3dywKIAogCUdF
TV9CVUdfT04oIWk5MTVfdm1hX2lzX2dndHQodm1hKSk7CiAKKyNpZmRlZiBDT05GSUdfTE9DS0RF
UAorCVdBUk5fT04oIXd3ICYmIHZtYS0+cmVzdiAmJiBkbWFfcmVzdl9oZWxkKHZtYS0+cmVzdikp
OworI2VuZGlmCisKIAlkbyB7Ci0JCWVyciA9IGk5MTVfdm1hX3Bpbl93dyh2bWEsIHd3LCAwLCBh
bGlnbiwgZmxhZ3MgfCBQSU5fR0xPQkFMKTsKKwkJaWYgKHd3KQorCQkJZXJyID0gaTkxNV92bWFf
cGluX3d3KHZtYSwgd3csIDAsIGFsaWduLCBmbGFncyB8IFBJTl9HTE9CQUwpOworCQllbHNlCisJ
CQllcnIgPSBpOTE1X3ZtYV9waW4odm1hLCAwLCBhbGlnbiwgZmxhZ3MgfCBQSU5fR0xPQkFMKTsK
IAkJaWYgKGVyciAhPSAtRU5PU1BDKSB7CiAJCQlpZiAoIWVycikgewogCQkJCWVyciA9IGk5MTVf
dm1hX3dhaXRfZm9yX2JpbmQodm1hKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfdm1hLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5oCmluZGV4IGE2NGFk
YzhjODgzYi4uM2M5MTRjOWRlOWE5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3ZtYS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmgKQEAgLTI0Myw2
ICsyNDMsOSBAQCBpOTE1X3ZtYV9waW5fd3coc3RydWN0IGk5MTVfdm1hICp2bWEsIHN0cnVjdCBp
OTE1X2dlbV93d19jdHggKnd3LAogc3RhdGljIGlubGluZSBpbnQgX19tdXN0X2NoZWNrCiBpOTE1
X3ZtYV9waW4oc3RydWN0IGk5MTVfdm1hICp2bWEsIHU2NCBzaXplLCB1NjQgYWxpZ25tZW50LCB1
NjQgZmxhZ3MpCiB7CisjaWZkZWYgQ09ORklHX0xPQ0tERVAKKwlXQVJOX09OX09OQ0Uodm1hLT5y
ZXN2ICYmIGRtYV9yZXN2X2hlbGQodm1hLT5yZXN2KSk7CisjZW5kaWYKIAlyZXR1cm4gaTkxNV92
bWFfcGluX3d3KHZtYSwgTlVMTCwgc2l6ZSwgYWxpZ25tZW50LCBmbGFncyk7CiB9CiAKLS0gCjIu
MzEuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJp
LWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVsCg==
