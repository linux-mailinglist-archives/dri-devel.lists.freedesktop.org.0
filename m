Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id DA5F65D15C
	for <lists+dri-devel@lfdr.de>; Tue,  2 Jul 2019 16:18:39 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EDC2689EEB;
	Tue,  2 Jul 2019 14:18:36 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from metis.ext.pengutronix.de (metis.ext.pengutronix.de
 [IPv6:2001:67c:670:201:290:27ff:fe1d:cc33])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B60A289EA3
 for <dri-devel@lists.freedesktop.org>; Tue,  2 Jul 2019 14:18:35 +0000 (UTC)
Received: from dude02.hi.pengutronix.de ([2001:67c:670:100:1d::28]
 helo=dude02.pengutronix.de.)
 by metis.ext.pengutronix.de with esmtp (Exim 4.92)
 (envelope-from <l.stach@pengutronix.de>)
 id 1hiJc8-0002u9-Av; Tue, 02 Jul 2019 16:18:32 +0200
From: Lucas Stach <l.stach@pengutronix.de>
To: etnaviv@lists.freedesktop.org
Subject: [PATCH] drm/etnaviv: dump only failing submit
Date: Tue,  2 Jul 2019 16:18:30 +0200
Message-Id: <20190702141830.13580-1-l.stach@pengutronix.de>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
X-SA-Exim-Connect-IP: 2001:67c:670:100:1d::28
X-SA-Exim-Mail-From: l.stach@pengutronix.de
X-SA-Exim-Scanned: No (on metis.ext.pengutronix.de);
 SAEximRunCond expanded to false
X-PTX-Original-Recipient: dri-devel@lists.freedesktop.org
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: patchwork-lst@pengutronix.de, kernel@pengutronix.de,
 dri-devel@lists.freedesktop.org, Russell King <linux+etnaviv@armlinux.org.uk>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RHVlIHRvIHRoZSB0cmFja2luZyBwcm92aWRlZCBieSB0aGUgc2NoZWR1bGVyIHdlIGtub3cgZXhh
Y3RseSB3aGljaApzdWJtaXQgaXMgZmFpbGluZy4gT25seSBkdW1wIHRoaXMgc2luZ2xlIHN1Ym1p
dCBhbmQgdGhlIHJlcXVpcmVkCmF1eGlsaWFyeSBpbmZvcm1hdGlvbi4gVGhpcyBjdXRzIGRvd24g
dGhlIHNpemUgb2YgdGhlIGRldmNvcmVkdW1wcwpieSBvbmx5IGluY2x1ZGluZyByZWxldmFudCBp
bmZvcm1hdGlvbi4KClNpZ25lZC1vZmYtYnk6IEx1Y2FzIFN0YWNoIDxsLnN0YWNoQHBlbmd1dHJv
bml4LmRlPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZHVtcC5jICB8IDU3
ICsrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2
aXZfZHVtcC5oICB8ICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X3NjaGVk
LmMgfCAgMiArLQogMyBmaWxlcyBjaGFuZ2VkLCAyMiBpbnNlcnRpb25zKCspLCA0MSBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2R1bXAu
YyBiL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZHVtcC5jCmluZGV4IDUxNTUxNWVm
MjRmOS4uYmFiMDliYWUzNWQwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9l
dG5hdml2X2R1bXAuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2R1bXAu
YwpAQCAtOTEsOSArOTEsOSBAQCBzdGF0aWMgdm9pZCBldG5hdml2X2NvcmVfZHVtcF9yZWdpc3Rl
cnMoc3RydWN0IGNvcmVfZHVtcF9pdGVyYXRvciAqaXRlciwKIH0KIAogc3RhdGljIHZvaWQgZXRu
YXZpdl9jb3JlX2R1bXBfbW11KHN0cnVjdCBjb3JlX2R1bXBfaXRlcmF0b3IgKml0ZXIsCi0Jc3Ry
dWN0IGV0bmF2aXZfZ3B1ICpncHUsIHNpemVfdCBtbXVfc2l6ZSkKKwlzdHJ1Y3QgZXRuYXZpdl9p
b21tdSAqbW11LCBzaXplX3QgbW11X3NpemUpCiB7Ci0JZXRuYXZpdl9pb21tdV9kdW1wKGdwdS0+
bW11LCBpdGVyLT5kYXRhKTsKKwlldG5hdml2X2lvbW11X2R1bXAobW11LCBpdGVyLT5kYXRhKTsK
IAogCWV0bmF2aXZfY29yZV9kdW1wX2hlYWRlcihpdGVyLCBFVERVTVBfQlVGX01NVSwgaXRlci0+
ZGF0YSArIG1tdV9zaXplKTsKIH0KQEAgLTEwOCwxNyArMTA4LDE1IEBAIHN0YXRpYyB2b2lkIGV0
bmF2aXZfY29yZV9kdW1wX21lbShzdHJ1Y3QgY29yZV9kdW1wX2l0ZXJhdG9yICppdGVyLCB1MzIg
dHlwZSwKIAlldG5hdml2X2NvcmVfZHVtcF9oZWFkZXIoaXRlciwgdHlwZSwgaXRlci0+ZGF0YSAr
IHNpemUpOwogfQogCi12b2lkIGV0bmF2aXZfY29yZV9kdW1wKHN0cnVjdCBldG5hdml2X2dwdSAq
Z3B1KQordm9pZCBldG5hdml2X2NvcmVfZHVtcChzdHJ1Y3QgZXRuYXZpdl9nZW1fc3VibWl0ICpz
dWJtaXQpCiB7CisJc3RydWN0IGV0bmF2aXZfZ3B1ICpncHUgPSBzdWJtaXQtPmdwdTsKIAlzdHJ1
Y3QgY29yZV9kdW1wX2l0ZXJhdG9yIGl0ZXI7Ci0Jc3RydWN0IGV0bmF2aXZfdnJhbV9tYXBwaW5n
ICp2cmFtOwogCXN0cnVjdCBldG5hdml2X2dlbV9vYmplY3QgKm9iajsKLQlzdHJ1Y3QgZXRuYXZp
dl9nZW1fc3VibWl0ICpzdWJtaXQ7Ci0Jc3RydWN0IGRybV9zY2hlZF9qb2IgKnNfam9iOwogCXVu
c2lnbmVkIGludCBuX29iaiwgbl9ib21hcF9wYWdlczsKIAlzaXplX3QgZmlsZV9zaXplLCBtbXVf
c2l6ZTsKIAlfX2xlNjQgKmJvbWFwLCAqYm9tYXBfc3RhcnQ7Ci0JdW5zaWduZWQgbG9uZyBmbGFn
czsKKwlpbnQgaTsKIAogCS8qIE9ubHkgY2F0Y2ggdGhlIGZpcnN0IGV2ZW50LCBvciB3aGVuIG1h
bnVhbGx5IHJlLWFybWVkICovCiAJaWYgKCFldG5hdml2X2R1bXBfY29yZSkKQEAgLTEyOSwyOCAr
MTI3LDE2IEBAIHZvaWQgZXRuYXZpdl9jb3JlX2R1bXAoc3RydWN0IGV0bmF2aXZfZ3B1ICpncHUp
CiAKIAltbXVfc2l6ZSA9IGV0bmF2aXZfaW9tbXVfZHVtcF9zaXplKGdwdS0+bW11KTsKIAotCS8q
IFdlIGFsd2F5cyBkdW1wIHJlZ2lzdGVycywgbW11LCByaW5nIGFuZCBlbmQgbWFya2VyICovCi0J
bl9vYmogPSA0OworCS8qIFdlIGFsd2F5cyBkdW1wIHJlZ2lzdGVycywgbW11LCByaW5nLCBoYW5n
aW5nIGNtZGJ1ZiBhbmQgZW5kIG1hcmtlciAqLworCW5fb2JqID0gNTsKIAluX2JvbWFwX3BhZ2Vz
ID0gMDsKIAlmaWxlX3NpemUgPSBBUlJBWV9TSVpFKGV0bmF2aXZfZHVtcF9yZWdpc3RlcnMpICoK
IAkJCXNpemVvZihzdHJ1Y3QgZXRuYXZpdl9kdW1wX3JlZ2lzdGVycykgKwotCQkgICAgbW11X3Np
emUgKyBncHUtPmJ1ZmZlci5zaXplOwotCi0JLyogQWRkIGluIHRoZSBhY3RpdmUgY29tbWFuZCBi
dWZmZXJzICovCi0Jc3Bpbl9sb2NrX2lycXNhdmUoJmdwdS0+c2NoZWQuam9iX2xpc3RfbG9jaywg
ZmxhZ3MpOwotCWxpc3RfZm9yX2VhY2hfZW50cnkoc19qb2IsICZncHUtPnNjaGVkLnJpbmdfbWly
cm9yX2xpc3QsIG5vZGUpIHsKLQkJc3VibWl0ID0gdG9fZXRuYXZpdl9zdWJtaXQoc19qb2IpOwot
CQlmaWxlX3NpemUgKz0gc3VibWl0LT5jbWRidWYuc2l6ZTsKLQkJbl9vYmorKzsKLQl9Ci0Jc3Bp
bl91bmxvY2tfaXJxcmVzdG9yZSgmZ3B1LT5zY2hlZC5qb2JfbGlzdF9sb2NrLCBmbGFncyk7CisJ
CSAgICBtbXVfc2l6ZSArIGdwdS0+YnVmZmVyLnNpemUgKyBzdWJtaXQtPmNtZGJ1Zi5zaXplOwog
CiAJLyogQWRkIGluIHRoZSBhY3RpdmUgYnVmZmVyIG9iamVjdHMgKi8KLQlsaXN0X2Zvcl9lYWNo
X2VudHJ5KHZyYW0sICZncHUtPm1tdS0+bWFwcGluZ3MsIG1tdV9ub2RlKSB7Ci0JCWlmICghdnJh
bS0+dXNlKQotCQkJY29udGludWU7Ci0KLQkJb2JqID0gdnJhbS0+b2JqZWN0OworCWZvciAoaSA9
IDA7IGkgPCBzdWJtaXQtPm5yX2JvczsgaSsrKSB7CisJCW9iaiA9IHN1Ym1pdC0+Ym9zW2ldLm9i
ajsKIAkJZmlsZV9zaXplICs9IG9iai0+YmFzZS5zaXplOwogCQluX2JvbWFwX3BhZ2VzICs9IG9i
ai0+YmFzZS5zaXplID4+IFBBR0VfU0hJRlQ7CiAJCW5fb2JqKys7CkBAIC0xODEsMTkgKzE2Nywx
NSBAQCB2b2lkIGV0bmF2aXZfY29yZV9kdW1wKHN0cnVjdCBldG5hdml2X2dwdSAqZ3B1KQogCW1l
bXNldChpdGVyLmhkciwgMCwgaXRlci5kYXRhIC0gaXRlci5zdGFydCk7CiAKIAlldG5hdml2X2Nv
cmVfZHVtcF9yZWdpc3RlcnMoJml0ZXIsIGdwdSk7Ci0JZXRuYXZpdl9jb3JlX2R1bXBfbW11KCZp
dGVyLCBncHUsIG1tdV9zaXplKTsKKwlldG5hdml2X2NvcmVfZHVtcF9tbXUoJml0ZXIsIGdwdS0+
bW11LCBtbXVfc2l6ZSk7CisKIAlldG5hdml2X2NvcmVfZHVtcF9tZW0oJml0ZXIsIEVURFVNUF9C
VUZfUklORywgZ3B1LT5idWZmZXIudmFkZHIsCiAJCQkgICAgICBncHUtPmJ1ZmZlci5zaXplLAog
CQkJICAgICAgZXRuYXZpdl9jbWRidWZfZ2V0X3ZhKCZncHUtPmJ1ZmZlcikpOwogCi0Jc3Bpbl9s
b2NrX2lycXNhdmUoJmdwdS0+c2NoZWQuam9iX2xpc3RfbG9jaywgZmxhZ3MpOwotCWxpc3RfZm9y
X2VhY2hfZW50cnkoc19qb2IsICZncHUtPnNjaGVkLnJpbmdfbWlycm9yX2xpc3QsIG5vZGUpIHsK
LQkJc3VibWl0ID0gdG9fZXRuYXZpdl9zdWJtaXQoc19qb2IpOwotCQlldG5hdml2X2NvcmVfZHVt
cF9tZW0oJml0ZXIsIEVURFVNUF9CVUZfQ01ELAotCQkJCSAgICAgIHN1Ym1pdC0+Y21kYnVmLnZh
ZGRyLCBzdWJtaXQtPmNtZGJ1Zi5zaXplLAotCQkJCSAgICAgIGV0bmF2aXZfY21kYnVmX2dldF92
YSgmc3VibWl0LT5jbWRidWYpKTsKLQl9Ci0Jc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZ3B1LT5z
Y2hlZC5qb2JfbGlzdF9sb2NrLCBmbGFncyk7CisJZXRuYXZpdl9jb3JlX2R1bXBfbWVtKCZpdGVy
LCBFVERVTVBfQlVGX0NNRCwKKwkJCSAgICAgIHN1Ym1pdC0+Y21kYnVmLnZhZGRyLCBzdWJtaXQt
PmNtZGJ1Zi5zaXplLAorCQkJICAgICAgZXRuYXZpdl9jbWRidWZfZ2V0X3ZhKCZzdWJtaXQtPmNt
ZGJ1ZikpOwogCiAJLyogUmVzZXJ2ZSBzcGFjZSBmb3IgdGhlIGJvbWFwICovCiAJaWYgKG5fYm9t
YXBfcGFnZXMpIHsKQEAgLTIwNiwxNCArMTg4LDEzIEBAIHZvaWQgZXRuYXZpdl9jb3JlX2R1bXAo
c3RydWN0IGV0bmF2aXZfZ3B1ICpncHUpCiAJCWJvbWFwX3N0YXJ0ID0gYm9tYXAgPSBOVUxMOwog
CX0KIAotCWxpc3RfZm9yX2VhY2hfZW50cnkodnJhbSwgJmdwdS0+bW11LT5tYXBwaW5ncywgbW11
X25vZGUpIHsKKwlmb3IgKGkgPSAwOyBpIDwgc3VibWl0LT5ucl9ib3M7IGkrKykgeworCQlzdHJ1
Y3QgZXRuYXZpdl92cmFtX21hcHBpbmcgKnZyYW07CiAJCXN0cnVjdCBwYWdlICoqcGFnZXM7CiAJ
CXZvaWQgKnZhZGRyOwogCi0JCWlmICh2cmFtLT51c2UgPT0gMCkKLQkJCWNvbnRpbnVlOwotCi0J
CW9iaiA9IHZyYW0tPm9iamVjdDsKKwkJb2JqID0gc3VibWl0LT5ib3NbaV0ub2JqOworCQl2cmFt
ID0gc3VibWl0LT5ib3NbaV0ubWFwcGluZzsKIAogCQltdXRleF9sb2NrKCZvYmotPmxvY2spOwog
CQlwYWdlcyA9IGV0bmF2aXZfZ2VtX2dldF9wYWdlcyhvYmopOwpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9kdW1wLmggYi9kcml2ZXJzL2dwdS9kcm0vZXRuYXZp
di9ldG5hdml2X2R1bXAuaAppbmRleCAyZDkxNmMyNjY3ZWUuLmExMjVjNDZiODk1YiAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9kdW1wLmgKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9kdW1wLmgKQEAgLTM1LDggKzM1LDggQEAgc3RydWN0
IGV0bmF2aXZfZHVtcF9yZWdpc3RlcnMgewogfTsKIAogI2lmZGVmIF9fS0VSTkVMX18KLXN0cnVj
dCBldG5hdml2X2dwdTsKLXZvaWQgZXRuYXZpdl9jb3JlX2R1bXAoc3RydWN0IGV0bmF2aXZfZ3B1
ICpncHUpOworc3RydWN0IGV0bmF2aXZfZ2VtX3N1Ym1pdDsKK3ZvaWQgZXRuYXZpdl9jb3JlX2R1
bXAoc3RydWN0IGV0bmF2aXZfZ2VtX3N1Ym1pdCAqc3VibWl0KTsKICNlbmRpZgogCiAjZW5kaWYK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfc2NoZWQuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfc2NoZWQuYwppbmRleCA2ZDI0ZmVhMTc2NmIu
LmIyZTBhMzRiYjc5NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZp
dl9zY2hlZC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfc2NoZWQuYwpA
QCAtMTE1LDcgKzExNSw3IEBAIHN0YXRpYyB2b2lkIGV0bmF2aXZfc2NoZWRfdGltZWRvdXRfam9i
KHN0cnVjdCBkcm1fc2NoZWRfam9iICpzY2hlZF9qb2IpCiAJCWRybV9zY2hlZF9pbmNyZWFzZV9r
YXJtYShzY2hlZF9qb2IpOwogCiAJLyogZ2V0IHRoZSBHUFUgYmFjayBpbnRvIHRoZSBpbml0IHN0
YXRlICovCi0JZXRuYXZpdl9jb3JlX2R1bXAoZ3B1KTsKKwlldG5hdml2X2NvcmVfZHVtcChzdWJt
aXQpOwogCWV0bmF2aXZfZ3B1X3JlY292ZXJfaGFuZyhncHUpOwogCiAJZHJtX3NjaGVkX3Jlc3Vi
bWl0X2pvYnMoJmdwdS0+c2NoZWQpOwotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZl
bEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFp
bG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
