Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 2E52A1FC33
	for <lists+dri-devel@lfdr.de>; Wed, 15 May 2019 23:27:04 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 40D9689254;
	Wed, 15 May 2019 21:27:01 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mga18.intel.com (mga18.intel.com [134.134.136.126])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4312389240;
 Wed, 15 May 2019 21:26:59 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga007.jf.intel.com ([10.7.209.58])
 by orsmga106.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 15 May 2019 14:26:58 -0700
X-ExtLoop1: 1
Received: from brianwel-mobl1.amr.corp.intel.com (HELO [10.254.179.86])
 ([10.254.179.86])
 by orsmga007.jf.intel.com with ESMTP; 15 May 2019 14:26:57 -0700
From: "Welty, Brian" <brian.welty@intel.com>
Subject: Re: [RFC PATCH v2 4/5] drm, cgroup: Add total GEM buffer allocation
 limit
To: Kenny Ho <Kenny.Ho@amd.com>, y2kenny@gmail.com, cgroups@vger.kernel.org,
 dri-devel@lists.freedesktop.org, amd-gfx@lists.freedesktop.org,
 tj@kernel.org, sunnanyong@huawei.com, alexander.deucher@amd.com,
 =?UTF-8?Q?Christian_K=c3=b6nig?= <christian.koenig@amd.com>
References: <20181120185814.13362-1-Kenny.Ho@amd.com>
 <20190509210410.5471-1-Kenny.Ho@amd.com>
 <20190509210410.5471-5-Kenny.Ho@amd.com>
Message-ID: <d81e8f55-9602-818e-0f9c-1d9d150133b1@intel.com>
Date: Wed, 15 May 2019 14:26:57 -0700
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:60.0) Gecko/20100101
 Thunderbird/60.5.3
MIME-Version: 1.0
In-Reply-To: <20190509210410.5471-5-Kenny.Ho@amd.com>
Content-Language: en-US
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

Ck9uIDUvOS8yMDE5IDI6MDQgUE0sIEtlbm55IEhvIHdyb3RlOgo+IFRoZSBkcm0gcmVzb3VyY2Ug
YmVpbmcgbWVhc3VyZWQgYW5kIGxpbWl0ZWQgaGVyZSBpcyB0aGUgR0VNIGJ1ZmZlcgo+IG9iamVj
dHMuICBVc2VyIGFwcGxpY2F0aW9ucyBhbGxvY2F0ZSBhbmQgZnJlZSB0aGVzZSBidWZmZXJzLiAg
SW4KPiBhZGRpdGlvbiwgYSBwcm9jZXNzIGNhbiBhbGxvY2F0ZSBhIGJ1ZmZlciBhbmQgc2hhcmUg
aXQgd2l0aCBhbm90aGVyCj4gcHJvY2Vzcy4gIFRoZSBjb25zdW1lciBvZiBhIHNoYXJlZCBidWZm
ZXIgY2FuIGFsc28gb3V0bGl2ZSB0aGUKPiBhbGxvY2F0b3Igb2YgdGhlIGJ1ZmZlci4KPiAKPiBG
b3IgdGhlIHB1cnBvc2Ugb2YgY2dyb3VwIGFjY291bnRpbmcgYW5kIGxpbWl0aW5nLCBvd25lcnNo
aXAgb2YgdGhlCj4gYnVmZmVyIGlzIGRlZW1lZCB0byBiZSB0aGUgY2dyb3VwIGZvciB3aGljaCB0
aGUgYWxsb2NhdGluZyBwcm9jZXNzCj4gYmVsb25ncyB0by4gIFRoZXJlIGlzIG9uZSBsaW1pdCBw
ZXIgZHJtIGRldmljZS4KPiAKPiBJbiBvcmRlciB0byBwcmV2ZW50IHRoZSBidWZmZXIgb3V0bGl2
aW5nIHRoZSBjZ3JvdXAgdGhhdCBvd25zIGl0LCBhCj4gcHJvY2VzcyBpcyBwcmV2ZW50ZWQgZnJv
bSBpbXBvcnRpbmcgYnVmZmVycyB0aGF0IGFyZSBub3Qgb3duIGJ5IHRoZQo+IHByb2Nlc3MnIGNn
cm91cCBvciB0aGUgYW5jZXN0b3JzIG9mIHRoZSBwcm9jZXNzJyBjZ3JvdXAuCj4gCj4gRm9yIHRo
aXMgcmVzb3VyY2UsIHRoZSBjb250cm9sIGZpbGVzIGFyZSBwcmVmaXhlZCB3aXRoIGRybS5idWZm
ZXIudG90YWwuCgpPdmVyYWxsLCB0aGlzIGZyYW1ld29yayBsb29rcyB2ZXJ5IGdvb2QuCgpCdXQg
aXMgdGhpcyBhIHVzZWZ1bCByZXNvdXJjZSB0byB0cmFjaz8gICBTZWUgbXkgcXVlc3Rpb24gZG93
biBmdXJ0aGVyCmJlbG93IGluIHlvdXIgZHJtX2dlbV9wcml2YXRlX29iamVjdF9pbml0LgoKCj4g
Cj4gVGhlcmUgYXJlIGZvdXIgY29udHJvbCBmaWxlIHR5cGVzLAo+IHN0YXRzIChybykgLSBkaXNw
bGF5IGN1cnJlbnQgbWVhc3VyZWQgdmFsdWVzIGZvciBhIHJlc291cmNlCj4gbWF4IChydykgLSBs
aW1pdHMgZm9yIGEgcmVzb3VyY2UKPiBkZWZhdWx0IChybywgcm9vdCBjZ3JvdXAgb25seSkgLSBk
ZWZhdWx0IHZhbHVlcyBmb3IgYSByZXNvdXJjZQo+IGhlbHAgKHJvLCByb290IGNncm91cCBvbmx5
KSAtIGhlbHAgc3RyaW5nIGZvciBhIHJlc291cmNlCj4gCj4gRWFjaCBmaWxlIGlzIG11bHRpLWxp
bmVkIHdpdGggb25lIGVudHJ5L2xpbmUgcGVyIGRybSBkZXZpY2UuCgpNdWx0aS1saW5lIGlzIGNv
cnJlY3QgZm9yIG11bHRpcGxlIGRldmljZXMsIGJ1dCBJIGJlbGlldmUgeW91IG5lZWQKdG8gdXNl
IGEgS0VZIHRvIGRlbm90ZSBkZXZpY2UgZm9yIGJvdGggeW91ciBzZXQgYW5kIGdldCByb3V0aW5l
cy4KSSBkaWRuJ3Qgc2VlIHlvdXIgc2V0IGZ1bmN0aW9ucyByZWFkaW5nIGEga2V5LCBvciB0aGUg
Z2V0IGZ1bmN0aW9ucwpwcmludGluZyB0aGUga2V5IGluIG91dHB1dC4KY2dyb3Vwcy12MiBjb252
ZW50aW9ucyBtZW50aW9uIHVzaW5nIEtFWSBvZiBtYWpvcjptaW5vciwgYnV0IEkgdGhpbmsKeW91
IGNhbiB1c2UgZHJtX21pbm9yIGFzIGtleT8KCj4gCj4gVXNhZ2UgZXhhbXBsZXM6Cj4gLy8gc2V0
IGxpbWl0IGZvciBjYXJkMSB0byAxR0IKPiBzZWQgLWkgJzJzLy4qLzEwNzM3NDE4MjQvJyAvc3lz
L2ZzL2Nncm91cC88Y2dyb3VwPi9kcm0uYnVmZmVyLnRvdGFsLm1heAo+IAo+IC8vIHNldCBsaW1p
dCBmb3IgY2FyZDAgdG8gNTEyTUIKPiBzZWQgLWkgJzFzLy4qLzUzNjg3MDkxMi8nIC9zeXMvZnMv
Y2dyb3VwLzxjZ3JvdXA+L2RybS5idWZmZXIudG90YWwubWF4Cj4gCj4gQ2hhbmdlLUlkOiBJNGMy
NDlkMDZkNDVlYzcwOWQ2NDgxZDRjYmU4N2M1MTY4NTQ1YzVkMAo+IFNpZ25lZC1vZmYtYnk6IEtl
bm55IEhvIDxLZW5ueS5Ib0BhbWQuY29tPgo+IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9hbWRncHVfb2JqZWN0LmMgfCAgIDQgKwo+ICBkcml2ZXJzL2dwdS9kcm0vZHJtX2dlbS5j
ICAgICAgICAgICAgICAgICAgfCAgIDcgKwo+ICBkcml2ZXJzL2dwdS9kcm0vZHJtX3ByaW1lLmMg
ICAgICAgICAgICAgICAgfCAgIDkgKwo+ICBpbmNsdWRlL2RybS9kcm1fY2dyb3VwLmggICAgICAg
ICAgICAgICAgICAgfCAgMzQgKystCj4gIGluY2x1ZGUvZHJtL2RybV9nZW0uaCAgICAgICAgICAg
ICAgICAgICAgICB8ICAxMSArCj4gIGluY2x1ZGUvbGludXgvY2dyb3VwX2RybS5oICAgICAgICAg
ICAgICAgICB8ICAgMyArCj4gIGtlcm5lbC9jZ3JvdXAvZHJtLmMgICAgICAgICAgICAgICAgICAg
ICAgICB8IDI4MCArKysrKysrKysrKysrKysrKysrKysKPiAgNyBmaWxlcyBjaGFuZ2VkLCAzNDYg
aW5zZXJ0aW9ucygrKSwgMiBkZWxldGlvbnMoLSkKPiAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X29iamVjdC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X29iamVjdC5jCj4gaW5kZXggOTNiMmM1YTQ4YTcxLi5iNGMwNzhiN2FkNjMg
MTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X29iamVjdC5j
Cj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X29iamVjdC5jCj4gQEAg
LTM0LDYgKzM0LDcgQEAKPiAgI2luY2x1ZGUgPGRybS9kcm1QLmg+Cj4gICNpbmNsdWRlIDxkcm0v
YW1kZ3B1X2RybS5oPgo+ICAjaW5jbHVkZSA8ZHJtL2RybV9jYWNoZS5oPgo+ICsjaW5jbHVkZSA8
ZHJtL2RybV9jZ3JvdXAuaD4KPiAgI2luY2x1ZGUgImFtZGdwdS5oIgo+ICAjaW5jbHVkZSAiYW1k
Z3B1X3RyYWNlLmgiCj4gICNpbmNsdWRlICJhbWRncHVfYW1ka2ZkLmgiCj4gQEAgLTQ0Niw2ICs0
NDcsOSBAQCBzdGF0aWMgaW50IGFtZGdwdV9ib19kb19jcmVhdGUoc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYsCj4gIAlpZiAoIWFtZGdwdV9ib192YWxpZGF0ZV9zaXplKGFkZXYsIHNpemUsIGJw
LT5kb21haW4pKQo+ICAJCXJldHVybiAtRU5PTUVNOwo+ICAKPiArCWlmICghZHJtY2dycF9ib19j
YW5fYWxsb2NhdGUoY3VycmVudCwgYWRldi0+ZGRldiwgc2l6ZSkpCj4gKwkJcmV0dXJuIC1FTk9N
RU07Cj4gKwo+ICAJKmJvX3B0ciA9IE5VTEw7Cj4gIAo+ICAJYWNjX3NpemUgPSB0dG1fYm9fZG1h
X2FjY19zaXplKCZhZGV2LT5tbWFuLmJkZXYsIHNpemUsCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9kcm1fZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX2dlbS5jCj4gaW5kZXggNmE4
MGRiMDc3ZGM2Li5jYmQ0OWJmMzRkY2YgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2Ry
bV9nZW0uYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtLmMKPiBAQCAtMzcsMTAgKzM3
LDEyIEBACj4gICNpbmNsdWRlIDxsaW51eC9zaG1lbV9mcy5oPgo+ICAjaW5jbHVkZSA8bGludXgv
ZG1hLWJ1Zi5oPgo+ICAjaW5jbHVkZSA8bGludXgvbWVtX2VuY3J5cHQuaD4KPiArI2luY2x1ZGUg
PGxpbnV4L2Nncm91cF9kcm0uaD4KPiAgI2luY2x1ZGUgPGRybS9kcm1QLmg+Cj4gICNpbmNsdWRl
IDxkcm0vZHJtX3ZtYV9tYW5hZ2VyLmg+Cj4gICNpbmNsdWRlIDxkcm0vZHJtX2dlbS5oPgo+ICAj
aW5jbHVkZSA8ZHJtL2RybV9wcmludC5oPgo+ICsjaW5jbHVkZSA8ZHJtL2RybV9jZ3JvdXAuaD4K
PiAgI2luY2x1ZGUgImRybV9pbnRlcm5hbC5oIgo+ICAKPiAgLyoqIEBmaWxlIGRybV9nZW0uYwo+
IEBAIC0xNTQsNiArMTU2LDkgQEAgdm9pZCBkcm1fZ2VtX3ByaXZhdGVfb2JqZWN0X2luaXQoc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiwKPiAgCW9iai0+aGFuZGxlX2NvdW50ID0gMDsKPiAgCW9iai0+
c2l6ZSA9IHNpemU7Cj4gIAlkcm1fdm1hX25vZGVfcmVzZXQoJm9iai0+dm1hX25vZGUpOwo+ICsK
PiArCW9iai0+ZHJtY2dycCA9IGdldF9kcm1jZ3JwKGN1cnJlbnQpOwo+ICsJZHJtY2dycF9jaGdf
Ym9fYWxsb2Mob2JqLT5kcm1jZ3JwLCBkZXYsIHNpemUpOwoKCldoeSBkbyB0aGUgY2hhcmdpbmcg
aGVyZT8KVGhlcmUgaXMgbm8gYmFja2luZyBzdG9yZSB5ZXQgZm9yIHRoZSBidWZmZXIsIHNvIHRo
aXMgaXMgcmVhbGx5IHRyYWNraW5nIHNvbWV0aGluZyBha2luIHRvIGFsbG93ZWQgdmlydHVhbCBt
ZW1vcnkgZm9yIEdFTSBvYmplY3RzPwpJcyB0aGlzIHJlYWxseSB1c2VmdWwgZm9yIGFuIGFkbWlu
aXN0cmF0b3IgdG8gY29udHJvbD8KSXNuJ3QgdGhlIHJlc291cmNlIHdlIHdhbnQgdG8gY29udHJv
bCBhY3R1YWxseSB0aGUgcGh5c2ljYWwgYmFja2luZyBzdG9yZT8gCgoKPiAgfQo+ICBFWFBPUlRf
U1lNQk9MKGRybV9nZW1fcHJpdmF0ZV9vYmplY3RfaW5pdCk7Cj4gIAo+IEBAIC04MDQsNiArODA5
LDggQEAgZHJtX2dlbV9vYmplY3RfcmVsZWFzZShzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iaikK
PiAgCWlmIChvYmotPmZpbHApCj4gIAkJZnB1dChvYmotPmZpbHApOwo+ICAKPiArCWRybWNncnBf
dW5jaGdfYm9fYWxsb2Mob2JqLT5kcm1jZ3JwLCBvYmotPmRldiwgb2JqLT5zaXplKTsKPiArCj4g
IAlkcm1fZ2VtX2ZyZWVfbW1hcF9vZmZzZXQob2JqKTsKPiAgfQo+ICBFWFBPUlRfU1lNQk9MKGRy
bV9nZW1fb2JqZWN0X3JlbGVhc2UpOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vZHJt
X3ByaW1lLmMgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX3ByaW1lLmMKPiBpbmRleCAyMzFlM2Y2ZDVm
NDEuLmZhZWQ1NjExYTFjNiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vZHJtX3ByaW1l
LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX3ByaW1lLmMKPiBAQCAtMzIsNiArMzIsNyBA
QAo+ICAjaW5jbHVkZSA8ZHJtL2RybV9wcmltZS5oPgo+ICAjaW5jbHVkZSA8ZHJtL2RybV9nZW0u
aD4KPiAgI2luY2x1ZGUgPGRybS9kcm1QLmg+Cj4gKyNpbmNsdWRlIDxkcm0vZHJtX2Nncm91cC5o
Pgo+ICAKPiAgI2luY2x1ZGUgImRybV9pbnRlcm5hbC5oIgo+ICAKPiBAQCAtNzk0LDYgKzc5NSw3
IEBAIGludCBkcm1fZ2VtX3ByaW1lX2ZkX3RvX2hhbmRsZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
LAo+ICB7Cj4gIAlzdHJ1Y3QgZG1hX2J1ZiAqZG1hX2J1ZjsKPiAgCXN0cnVjdCBkcm1fZ2VtX29i
amVjdCAqb2JqOwo+ICsJc3RydWN0IGRybWNncnAgKmRybWNncnAgPSBnZXRfZHJtY2dycChjdXJy
ZW50KTsKPiAgCWludCByZXQ7Cj4gIAo+ICAJZG1hX2J1ZiA9IGRtYV9idWZfZ2V0KHByaW1lX2Zk
KTsKPiBAQCAtODE4LDYgKzgyMCwxMyBAQCBpbnQgZHJtX2dlbV9wcmltZV9mZF90b19oYW5kbGUo
c3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAgCQlnb3RvIG91dF91bmxvY2s7Cj4gIAl9Cj4gIAo+
ICsJLyogb25seSBhbGxvdyBibyBmcm9tIHRoZSBzYW1lIGNncm91cCBvciBpdHMgYW5jZXN0b3Ig
dG8gYmUgaW1wb3J0ZWQgKi8KPiArCWlmIChkcm1jZ3JwICE9IE5VTEwgJiYKPiArCQkJIWRybWNn
cnBfaXNfc2VsZl9vcl9hbmNlc3Rvcihkcm1jZ3JwLCBvYmotPmRybWNncnApKSB7Cj4gKwkJcmV0
ID0gLUVBQ0NFUzsKPiArCQlnb3RvIG91dF91bmxvY2s7Cj4gKwl9Cj4gKwo+ICAJaWYgKG9iai0+
ZG1hX2J1Zikgewo+ICAJCVdBUk5fT04ob2JqLT5kbWFfYnVmICE9IGRtYV9idWYpOwo+ICAJfSBl
bHNlIHsKPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0vZHJtX2Nncm91cC5oIGIvaW5jbHVkZS9k
cm0vZHJtX2Nncm91cC5oCj4gaW5kZXggZGRiOWVhYjY0MzYwLi44NzExYjdjNWY3YmYgMTAwNjQ0
Cj4gLS0tIGEvaW5jbHVkZS9kcm0vZHJtX2Nncm91cC5oCj4gKysrIGIvaW5jbHVkZS9kcm0vZHJt
X2Nncm91cC5oCj4gQEAgLTQsMTIgKzQsMjAgQEAKPiAgI2lmbmRlZiBfX0RSTV9DR1JPVVBfSF9f
Cj4gICNkZWZpbmUgX19EUk1fQ0dST1VQX0hfXwo+ICAKPiArI2luY2x1ZGUgPGxpbnV4L2Nncm91
cF9kcm0uaD4KPiArCj4gICNpZmRlZiBDT05GSUdfQ0dST1VQX0RSTQo+ICAKPiAgaW50IGRybWNn
cnBfcmVnaXN0ZXJfZGV2aWNlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXZpY2UpOwo+IC0KPiAgaW50
IGRybWNncnBfdW5yZWdpc3Rlcl9kZXZpY2Uoc3RydWN0IGRybV9kZXZpY2UgKmRldmljZSk7Cj4g
LQo+ICtib29sIGRybWNncnBfaXNfc2VsZl9vcl9hbmNlc3RvcihzdHJ1Y3QgZHJtY2dycCAqc2Vs
ZiwKPiArCQlzdHJ1Y3QgZHJtY2dycCAqcmVsYXRpdmUpOwo+ICt2b2lkIGRybWNncnBfY2hnX2Jv
X2FsbG9jKHN0cnVjdCBkcm1jZ3JwICpkcm1jZ3JwLCBzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+
ICsJCXNpemVfdCBzaXplKTsKPiArdm9pZCBkcm1jZ3JwX3VuY2hnX2JvX2FsbG9jKHN0cnVjdCBk
cm1jZ3JwICpkcm1jZ3JwLCBzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ICsJCXNpemVfdCBzaXpl
KTsKPiArYm9vbCBkcm1jZ3JwX2JvX2Nhbl9hbGxvY2F0ZShzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRh
c2ssIHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gKwkJc2l6ZV90IHNpemUpOwo+ICAjZWxzZQo+
ICBzdGF0aWMgaW5saW5lIGludCBkcm1jZ3JwX3JlZ2lzdGVyX2RldmljZShzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2aWNlKQo+ICB7Cj4gQEAgLTIwLDUgKzI4LDI3IEBAIHN0YXRpYyBpbmxpbmUgaW50
IGRybWNncnBfdW5yZWdpc3Rlcl9kZXZpY2Uoc3RydWN0IGRybV9kZXZpY2UgKmRldmljZSkKPiAg
ewo+ICAJcmV0dXJuIDA7Cj4gIH0KPiArCj4gK3N0YXRpYyBpbmxpbmUgYm9vbCBkcm1jZ3JwX2lz
X3NlbGZfb3JfYW5jZXN0b3Ioc3RydWN0IGRybWNncnAgKnNlbGYsCj4gKwkJc3RydWN0IGRybWNn
cnAgKnJlbGF0aXZlKQo+ICt7Cj4gKwlyZXR1cm4gZmFsc2U7Cj4gK30KPiArCj4gK3N0YXRpYyBp
bmxpbmUgdm9pZCBkcm1jZ3JwX2NoZ19ib19hbGxvYyhzdHJ1Y3QgZHJtY2dycCAqZHJtY2dycCwK
PiArCQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAlzaXplX3Qgc2l6ZSkKPiArewo+ICt9Cj4gKwo+
ICtzdGF0aWMgaW5saW5lIHZvaWQgZHJtY2dycF91bmNoZ19ib19hbGxvYyhzdHJ1Y3QgZHJtY2dy
cCAqZHJtY2dycCwKPiArCQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAlzaXplX3Qgc2l6ZSkKPiAr
ewo+ICt9Cj4gKwo+ICtzdGF0aWMgaW5saW5lIGJvb2wgZHJtY2dycF9ib19jYW5fYWxsb2NhdGUo
c3RydWN0IHRhc2tfc3RydWN0ICp0YXNrLAo+ICsJCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCXNp
emVfdCBzaXplKQo+ICt7Cj4gKwlyZXR1cm4gdHJ1ZTsKPiArfQo+ICAjZW5kaWYgLyogQ09ORklH
X0NHUk9VUF9EUk0gKi8KPiAgI2VuZGlmIC8qIF9fRFJNX0NHUk9VUF9IX18gKi8KPiBkaWZmIC0t
Z2l0IGEvaW5jbHVkZS9kcm0vZHJtX2dlbS5oIGIvaW5jbHVkZS9kcm0vZHJtX2dlbS5oCj4gaW5k
ZXggYzk1NzI3NDI1Mjg0Li4wMjg1NGM2NzRiNWMgMTAwNjQ0Cj4gLS0tIGEvaW5jbHVkZS9kcm0v
ZHJtX2dlbS5oCj4gKysrIGIvaW5jbHVkZS9kcm0vZHJtX2dlbS5oCj4gQEAgLTI3Miw2ICsyNzIs
MTcgQEAgc3RydWN0IGRybV9nZW1fb2JqZWN0IHsKPiAgCSAqCj4gIAkgKi8KPiAgCWNvbnN0IHN0
cnVjdCBkcm1fZ2VtX29iamVjdF9mdW5jcyAqZnVuY3M7Cj4gKwo+ICsJLyoqCj4gKwkgKiBAZHJt
Y2dycDoKPiArCSAqCj4gKwkgKiBEUk0gY2dyb3VwIHRoaXMgR0VNIG9iamVjdCBiZWxvbmdzIHRv
Lgo+ICsgICAgICAgICAqCj4gKyAgICAgICAgICogVGhpcyBpcyB1c2VkIHRvIHRyYWNrIGFuZCBs
aW1pdCB0aGUgYW1vdW50IG9mIEdFTSBvYmplY3RzIGEgdXNlcgo+ICsgICAgICAgICAqIGNhbiBh
bGxvY2F0ZS4gIFNpbmNlIEdFTSBvYmplY3RzIGNhbiBiZSBzaGFyZWQsIHRoaXMgaXMgYWxzbyB1
c2VkCj4gKyAgICAgICAgICogdG8gZW5zdXJlIEdFTSBvYmplY3RzIGFyZSBvbmx5IHNoYXJlZCB3
aXRoaW4gdGhlIHNhbWUgY2dyb3VwLgo+ICsJICovCj4gKwlzdHJ1Y3QgZHJtY2dycCAqZHJtY2dy
cDsKPiAgfTsKPiAgCj4gIC8qKgo+IGRpZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L2Nncm91cF9k
cm0uaCBiL2luY2x1ZGUvbGludXgvY2dyb3VwX2RybS5oCj4gaW5kZXggZDdjY2Y0MzRjYTZiLi5m
ZTE0YmE3YmIxY2YgMTAwNjQ0Cj4gLS0tIGEvaW5jbHVkZS9saW51eC9jZ3JvdXBfZHJtLmgKPiAr
KysgYi9pbmNsdWRlL2xpbnV4L2Nncm91cF9kcm0uaAo+IEBAIC0xNSw2ICsxNSw5IEBACj4gIAo+
ICBzdHJ1Y3QgZHJtY2dycF9kZXZpY2VfcmVzb3VyY2Ugewo+ICAJLyogZm9yIHBlciBkZXZpY2Ug
c3RhdHMgKi8KPiArCXM2NAkJCWJvX3N0YXRzX3RvdGFsX2FsbG9jYXRlZDsKPiArCj4gKwlzNjQJ
CQlib19saW1pdHNfdG90YWxfYWxsb2NhdGVkOwo+ICB9Owo+ICAKPiAgc3RydWN0IGRybWNncnAg
ewo+IGRpZmYgLS1naXQgYS9rZXJuZWwvY2dyb3VwL2RybS5jIGIva2VybmVsL2Nncm91cC9kcm0u
Ywo+IGluZGV4IGY5ZWY0YmYwNDJkOC4uYmMzYWJmZjA5MTEzIDEwMDY0NAo+IC0tLSBhL2tlcm5l
bC9jZ3JvdXAvZHJtLmMKPiArKysgYi9rZXJuZWwvY2dyb3VwL2RybS5jCj4gQEAgLTE1LDYgKzE1
LDIyIEBAIHN0YXRpYyBERUZJTkVfTVVURVgoZHJtY2dycF9tdXRleCk7Cj4gIHN0cnVjdCBkcm1j
Z3JwX2RldmljZSB7Cj4gIAlzdHJ1Y3QgZHJtX2RldmljZQkqZGV2Owo+ICAJc3RydWN0IG11dGV4
CQltdXRleDsKPiArCj4gKwlzNjQJCQlib19saW1pdHNfdG90YWxfYWxsb2NhdGVkX2RlZmF1bHQ7
Cj4gK307Cj4gKwo+ICsjZGVmaW5lIERSTUNHX0NURl9QUklWX1NJWkUgMwo+ICsjZGVmaW5lIERS
TUNHX0NURl9QUklWX01BU0sgR0VOTUFTSygoRFJNQ0dfQ1RGX1BSSVZfU0laRSAtIDEpLCAwKQo+
ICsKPiArZW51bSBkcm1jZ3JwX3Jlc190eXBlIHsKPiArCURSTUNHUlBfVFlQRV9CT19UT1RBTCwK
PiArfTsKPiArCj4gK2VudW0gZHJtY2dycF9maWxlX3R5cGUgewo+ICsJRFJNQ0dSUF9GVFlQRV9T
VEFUUywKPiArCURSTUNHUlBfRlRZUEVfTUFYLAo+ICsJRFJNQ0dSUF9GVFlQRV9ERUZBVUxULAo+
ICsJRFJNQ0dSUF9GVFlQRV9IRUxQLAo+ICB9Owo+ICAKPiAgLyogaW5kZXhlZCBieSBkcm1fbWlu
b3IgZm9yIGFjY2VzcyBzcGVlZCAqLwo+IEBAIC01Myw2ICs2OSwxMCBAQCBzdGF0aWMgaW5saW5l
IGludCBpbml0X2RybWNncnBfc2luZ2xlKHN0cnVjdCBkcm1jZ3JwICpkcm1jZ3JwLCBpbnQgaSkK
PiAgCX0KPiAgCj4gIAkvKiBzZXQgZGVmYXVsdHMgaGVyZSAqLwo+ICsJaWYgKGtub3duX2RybWNn
cnBfZGV2c1tpXSAhPSBOVUxMKSB7Cj4gKwkJZGRyLT5ib19saW1pdHNfdG90YWxfYWxsb2NhdGVk
ID0KPiArCQkgIGtub3duX2RybWNncnBfZGV2c1tpXS0+Ym9fbGltaXRzX3RvdGFsX2FsbG9jYXRl
ZF9kZWZhdWx0Owo+ICsJfQo+ICAKPiAgCXJldHVybiAwOwo+ICB9Cj4gQEAgLTk5LDcgKzExOSwx
ODcgQEAgZHJtY2dycF9jc3NfYWxsb2Moc3RydWN0IGNncm91cF9zdWJzeXNfc3RhdGUgKnBhcmVu
dF9jc3MpCj4gIAlyZXR1cm4gJmRybWNncnAtPmNzczsKPiAgfQo+ICAKPiArc3RhdGljIGlubGlu
ZSB2b2lkIGRybWNncnBfcHJpbnRfc3RhdHMoc3RydWN0IGRybWNncnBfZGV2aWNlX3Jlc291cmNl
ICpkZHIsCj4gKwkJc3RydWN0IHNlcV9maWxlICpzZiwgZW51bSBkcm1jZ3JwX3Jlc190eXBlIHR5
cGUpCj4gK3sKPiArCWlmIChkZHIgPT0gTlVMTCkgewo+ICsJCXNlcV9wdXRzKHNmLCAiXG4iKTsK
PiArCQlyZXR1cm47Cj4gKwl9Cj4gKwo+ICsJc3dpdGNoICh0eXBlKSB7Cj4gKwljYXNlIERSTUNH
UlBfVFlQRV9CT19UT1RBTDoKPiArCQlzZXFfcHJpbnRmKHNmLCAiJWxsZFxuIiwgZGRyLT5ib19z
dGF0c190b3RhbF9hbGxvY2F0ZWQpOwo+ICsJCWJyZWFrOwo+ICsJZGVmYXVsdDoKPiArCQlzZXFf
cHV0cyhzZiwgIlxuIik7Cj4gKwkJYnJlYWs7Cj4gKwl9Cj4gK30KPiArCj4gK3N0YXRpYyBpbmxp
bmUgdm9pZCBkcm1jZ3JwX3ByaW50X2xpbWl0cyhzdHJ1Y3QgZHJtY2dycF9kZXZpY2VfcmVzb3Vy
Y2UgKmRkciwKPiArCQlzdHJ1Y3Qgc2VxX2ZpbGUgKnNmLCBlbnVtIGRybWNncnBfcmVzX3R5cGUg
dHlwZSkKPiArewo+ICsJaWYgKGRkciA9PSBOVUxMKSB7Cj4gKwkJc2VxX3B1dHMoc2YsICJcbiIp
Owo+ICsJCXJldHVybjsKPiArCX0KPiArCj4gKwlzd2l0Y2ggKHR5cGUpIHsKPiArCWNhc2UgRFJN
Q0dSUF9UWVBFX0JPX1RPVEFMOgo+ICsJCXNlcV9wcmludGYoc2YsICIlbGxkXG4iLCBkZHItPmJv
X2xpbWl0c190b3RhbF9hbGxvY2F0ZWQpOwo+ICsJCWJyZWFrOwo+ICsJZGVmYXVsdDoKPiArCQlz
ZXFfcHV0cyhzZiwgIlxuIik7Cj4gKwkJYnJlYWs7Cj4gKwl9Cj4gK30KPiArCj4gK3N0YXRpYyBp
bmxpbmUgdm9pZCBkcm1jZ3JwX3ByaW50X2RlZmF1bHQoc3RydWN0IGRybWNncnBfZGV2aWNlICpk
ZGV2LAo+ICsJCXN0cnVjdCBzZXFfZmlsZSAqc2YsIGVudW0gZHJtY2dycF9yZXNfdHlwZSB0eXBl
KQo+ICt7Cj4gKwlpZiAoZGRldiA9PSBOVUxMKSB7Cj4gKwkJc2VxX3B1dHMoc2YsICJcbiIpOwo+
ICsJCXJldHVybjsKPiArCX0KPiArCj4gKwlzd2l0Y2ggKHR5cGUpIHsKPiArCWNhc2UgRFJNQ0dS
UF9UWVBFX0JPX1RPVEFMOgo+ICsJCXNlcV9wcmludGYoc2YsICIlbGxkXG4iLCBkZGV2LT5ib19s
aW1pdHNfdG90YWxfYWxsb2NhdGVkX2RlZmF1bHQpOwo+ICsJCWJyZWFrOwo+ICsJZGVmYXVsdDoK
PiArCQlzZXFfcHV0cyhzZiwgIlxuIik7Cj4gKwkJYnJlYWs7Cj4gKwl9Cj4gK30KPiArCj4gK3N0
YXRpYyBpbmxpbmUgdm9pZCBkcm1jZ3JwX3ByaW50X2hlbHAoaW50IGNhcmROdW0sIHN0cnVjdCBz
ZXFfZmlsZSAqc2YsCj4gKwkJZW51bSBkcm1jZ3JwX3Jlc190eXBlIHR5cGUpCj4gK3sKPiArCXN3
aXRjaCAodHlwZSkgewo+ICsJY2FzZSBEUk1DR1JQX1RZUEVfQk9fVE9UQUw6Cj4gKwkJc2VxX3By
aW50ZihzZiwKPiArCQkiVG90YWwgYW1vdW50IG9mIGJ1ZmZlciBhbGxvY2F0aW9uIGluIGJ5dGVz
IGZvciBjYXJkJWRcbiIsCj4gKwkJY2FyZE51bSk7Cj4gKwkJYnJlYWs7Cj4gKwlkZWZhdWx0Ogo+
ICsJCXNlcV9wdXRzKHNmLCAiXG4iKTsKPiArCQlicmVhazsKPiArCX0KPiArfQo+ICsKPiAraW50
IGRybWNncnBfYm9fc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKnNmLCB2b2lkICp2KQo+ICt7Cj4gKwlz
dHJ1Y3QgZHJtY2dycCAqZHJtY2dycCA9IGNzc19kcm1jZ3JwKHNlcV9jc3Moc2YpKTsKPiArCXN0
cnVjdCBkcm1jZ3JwX2RldmljZV9yZXNvdXJjZSAqZGRyID0gTlVMTDsKPiArCWVudW0gZHJtY2dy
cF9maWxlX3R5cGUgZl90eXBlID0gc2VxX2NmdChzZiktPgo+ICsJCXByaXZhdGUgJiBEUk1DR19D
VEZfUFJJVl9NQVNLOwo+ICsJZW51bSBkcm1jZ3JwX3Jlc190eXBlIHR5cGUgPSBzZXFfY2Z0KHNm
KS0+Cj4gKwkJcHJpdmF0ZSA+PiBEUk1DR19DVEZfUFJJVl9TSVpFOwo+ICsJc3RydWN0IGRybWNn
cnBfZGV2aWNlICpkZGV2Owo+ICsJaW50IGk7Cj4gKwo+ICsJZm9yIChpID0gMDsgaSA8PSBtYXhf
bWlub3I7IGkrKykgewo+ICsJCWRkciA9IGRybWNncnAtPmRldl9yZXNvdXJjZXNbaV07Cj4gKwkJ
ZGRldiA9IGtub3duX2RybWNncnBfZGV2c1tpXTsKPiArCj4gKwkJc3dpdGNoIChmX3R5cGUpIHsK
PiArCQljYXNlIERSTUNHUlBfRlRZUEVfU1RBVFM6Cj4gKwkJCWRybWNncnBfcHJpbnRfc3RhdHMo
ZGRyLCBzZiwgdHlwZSk7Cj4gKwkJCWJyZWFrOwo+ICsJCWNhc2UgRFJNQ0dSUF9GVFlQRV9NQVg6
Cj4gKwkJCWRybWNncnBfcHJpbnRfbGltaXRzKGRkciwgc2YsIHR5cGUpOwo+ICsJCQlicmVhazsK
PiArCQljYXNlIERSTUNHUlBfRlRZUEVfREVGQVVMVDoKPiArCQkJZHJtY2dycF9wcmludF9kZWZh
dWx0KGRkZXYsIHNmLCB0eXBlKTsKPiArCQkJYnJlYWs7Cj4gKwkJY2FzZSBEUk1DR1JQX0ZUWVBF
X0hFTFA6Cj4gKwkJCWRybWNncnBfcHJpbnRfaGVscChpLCBzZiwgdHlwZSk7Cj4gKwkJCWJyZWFr
Owo+ICsJCWRlZmF1bHQ6Cj4gKwkJCXNlcV9wdXRzKHNmLCAiXG4iKTsKPiArCQkJYnJlYWs7Cj4g
KwkJfQo+ICsJfQo+ICsKPiArCXJldHVybiAwOwo+ICt9Cj4gKwo+ICtzc2l6ZV90IGRybWNncnBf
Ym9fbGltaXRfd3JpdGUoc3RydWN0IGtlcm5mc19vcGVuX2ZpbGUgKm9mLCBjaGFyICpidWYsCj4g
KwkJc2l6ZV90IG5ieXRlcywgbG9mZl90IG9mZikKPiArewo+ICsJc3RydWN0IGRybWNncnAgKmRy
bWNncnAgPSBjc3NfZHJtY2dycChvZl9jc3Mob2YpKTsKPiArCWVudW0gZHJtY2dycF9yZXNfdHlw
ZSB0eXBlID0gb2ZfY2Z0KG9mKS0+cHJpdmF0ZSA+PiBEUk1DR19DVEZfUFJJVl9TSVpFOwo+ICsJ
Y2hhciAqY2Z0X25hbWUgPSBvZl9jZnQob2YpLT5uYW1lOwo+ICsJY2hhciAqbGltaXRzID0gc3Ry
c3RyaXAoYnVmKTsKPiArCXN0cnVjdCBkcm1jZ3JwX2RldmljZV9yZXNvdXJjZSAqZGRyOwo+ICsJ
Y2hhciAqc3ZhbDsKPiArCXM2NCB2YWw7Cj4gKwlpbnQgaSA9IDA7Cj4gKwlpbnQgcmM7Cj4gKwo+
ICsJd2hpbGUgKGkgPD0gbWF4X21pbm9yICYmIGxpbWl0cyAhPSBOVUxMKSB7Cj4gKwkJc3ZhbCA9
ICBzdHJzZXAoJmxpbWl0cywgIlxuIik7Cj4gKwkJcmMgPSBrc3RydG9sbChzdmFsLCAwLCAmdmFs
KTsKCklucHV0IHNob3VsZCBiZSAiS0VZIFZBTFVFIiwgc28gS0VZIHdpbGwgZGV0ZXJtaW5lIGRl
dmljZSB0byBhcHBseSB0aGlzIHRvLgpBbHNvLCBwZXIgY2dyb3Vwcy12MiBkb2N1bWVudGF0aW9u
IG9mIGxpbWl0cywgSSBiZWxpZXZlIG5lZWQgdG8gcGFyc2UgYW5kIGhhbmRsZSB0aGUgc3BlY2lh
bCAibWF4IiBpbnB1dCB2YWx1ZS4KCnBhcnNlX3Jlc291cmNlcygpIGluIHJkbWEgY29udHJvbGxl
ciBpcyBleGFtcGxlIGZvciBib3RoIG9mIGFib3ZlLgoKPiArCQlpZiAocmMpIHsKPiArCQkJcHJf
ZXJyKCJkcm1jZ3JwOiAlczogbWlub3IgJWQsIGVyciAlZC4gIiwKPiArCQkJCWNmdF9uYW1lLCBp
LCByYyk7Cj4gKwkJCXByX2NvbnRfY2dyb3VwX25hbWUoZHJtY2dycC0+Y3NzLmNncm91cCk7Cj4g
KwkJCXByX2NvbnQoIlxuIik7Cj4gKwkJfSBlbHNlIHsKPiArCQkJZGRyID0gZHJtY2dycC0+ZGV2
X3Jlc291cmNlc1tpXTsKPiArCQkJc3dpdGNoICh0eXBlKSB7Cj4gKwkJCWNhc2UgRFJNQ0dSUF9U
WVBFX0JPX1RPVEFMOgo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWwg
PCAwKSBjb250aW51ZTsKPiArCQkJCWRkci0+Ym9fbGltaXRzX3RvdGFsX2FsbG9jYXRlZCA9IHZh
bDsKPiArCQkJCWJyZWFrOwo+ICsJCQlkZWZhdWx0Ogo+ICsJCQkJYnJlYWs7Cj4gKwkJCX0KPiAr
CQl9Cj4gKwo+ICsJCWkrKzsKPiArCX0KPiArCj4gKwlpZiAoaSA8PSBtYXhfbWlub3IpIHsKPiAr
CQlwcl9lcnIoImRybWNncnA6ICVzOiBsZXNzIGVudHJpZXMgdGhhbiAjIG9mIGRybSBkZXZpY2Vz
LiAiLAo+ICsJCQkJY2Z0X25hbWUpOwo+ICsJCXByX2NvbnRfY2dyb3VwX25hbWUoZHJtY2dycC0+
Y3NzLmNncm91cCk7Cj4gKwkJcHJfY29udCgiXG4iKTsKPiArCX0KPiArCj4gKwlyZXR1cm4gbmJ5
dGVzOwo+ICt9Cj4gKwo+ICBzdHJ1Y3QgY2Z0eXBlIGZpbGVzW10gPSB7Cj4gKwl7Cj4gKwkJLm5h
bWUgPSAiYnVmZmVyLnRvdGFsLnN0YXRzIiwKPiArCQkuc2VxX3Nob3cgPSBkcm1jZ3JwX2JvX3No
b3csCj4gKwkJLnByaXZhdGUgPSAoRFJNQ0dSUF9UWVBFX0JPX1RPVEFMIDw8IERSTUNHX0NURl9Q
UklWX1NJWkUpIHwKPiArCQkJRFJNQ0dSUF9GVFlQRV9TVEFUUywKPiArCX0sCj4gKwl7Cj4gKwkJ
Lm5hbWUgPSAiYnVmZmVyLnRvdGFsLmRlZmF1bHQiLAo+ICsJCS5zZXFfc2hvdyA9IGRybWNncnBf
Ym9fc2hvdywKPiArCQkuZmxhZ3MgPSBDRlRZUEVfT05MWV9PTl9ST09ULAo+ICsJCS5wcml2YXRl
ID0gKERSTUNHUlBfVFlQRV9CT19UT1RBTCA8PCBEUk1DR19DVEZfUFJJVl9TSVpFKSB8Cj4gKwkJ
CURSTUNHUlBfRlRZUEVfREVGQVVMVCwKPiArCX0sCj4gKwl7Cj4gKwkJLm5hbWUgPSAiYnVmZmVy
LnRvdGFsLmhlbHAiLAo+ICsJCS5zZXFfc2hvdyA9IGRybWNncnBfYm9fc2hvdywKPiArCQkuZmxh
Z3MgPSBDRlRZUEVfT05MWV9PTl9ST09ULAo+ICsJCS5wcml2YXRlID0gKERSTUNHUlBfVFlQRV9C
T19UT1RBTCA8PCBEUk1DR19DVEZfUFJJVl9TSVpFKSB8Cj4gKwkJCURSTUNHUlBfRlRZUEVfSEVM
UCwKPiArCX0sCj4gKwl7Cj4gKwkJLm5hbWUgPSAiYnVmZmVyLnRvdGFsLm1heCIsCj4gKwkJLndy
aXRlID0gZHJtY2dycF9ib19saW1pdF93cml0ZSwKPiArCQkuc2VxX3Nob3cgPSBkcm1jZ3JwX2Jv
X3Nob3csCj4gKwkJLnByaXZhdGUgPSAoRFJNQ0dSUF9UWVBFX0JPX1RPVEFMIDw8IERSTUNHX0NU
Rl9QUklWX1NJWkUpIHwKPiArCQkJRFJNQ0dSUF9GVFlQRV9NQVgsCj4gKwl9LAo+ICAJeyB9CS8q
IHRlcm1pbmF0ZSAqLwo+ICB9Owo+ICAKPiBAQCAtMTIyLDYgKzMyMiw4IEBAIGludCBkcm1jZ3Jw
X3JlZ2lzdGVyX2RldmljZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAJCXJldHVybiAtRU5P
TUVNOwo+ICAKPiAgCWRkZXYtPmRldiA9IGRldjsKPiArCWRkZXYtPmJvX2xpbWl0c190b3RhbF9h
bGxvY2F0ZWRfZGVmYXVsdCA9IFM2NF9NQVg7Cj4gKwo+ICAJbXV0ZXhfaW5pdCgmZGRldi0+bXV0
ZXgpOwo+ICAKPiAgCW11dGV4X2xvY2soJmRybWNncnBfbXV0ZXgpOwo+IEBAIC0xNTYsMyArMzU4
LDgxIEBAIGludCBkcm1jZ3JwX3VucmVnaXN0ZXJfZGV2aWNlKHN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYpCj4gIAlyZXR1cm4gMDsKPiAgfQo+ICBFWFBPUlRfU1lNQk9MKGRybWNncnBfdW5yZWdpc3Rl
cl9kZXZpY2UpOwo+ICsKPiArYm9vbCBkcm1jZ3JwX2lzX3NlbGZfb3JfYW5jZXN0b3Ioc3RydWN0
IGRybWNncnAgKnNlbGYsIHN0cnVjdCBkcm1jZ3JwICpyZWxhdGl2ZSkKPiArewo+ICsJZm9yICg7
IHNlbGYgIT0gTlVMTDsgc2VsZiA9IHBhcmVudF9kcm1jZ3JwKHNlbGYpKQo+ICsJCWlmIChzZWxm
ID09IHJlbGF0aXZlKQo+ICsJCQlyZXR1cm4gdHJ1ZTsKPiArCj4gKwlyZXR1cm4gZmFsc2U7Cj4g
K30KPiArRVhQT1JUX1NZTUJPTChkcm1jZ3JwX2lzX3NlbGZfb3JfYW5jZXN0b3IpOwo+ICsKPiAr
Ym9vbCBkcm1jZ3JwX2JvX2Nhbl9hbGxvY2F0ZShzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2ssIHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gKwkJc2l6ZV90IHNpemUpCj4gK3sKPiArCXN0cnVjdCBk
cm1jZ3JwICpkcm1jZ3JwID0gZ2V0X2RybWNncnAodGFzayk7Cj4gKwlzdHJ1Y3QgZHJtY2dycF9k
ZXZpY2VfcmVzb3VyY2UgKmRkcjsKPiArCXN0cnVjdCBkcm1jZ3JwX2RldmljZV9yZXNvdXJjZSAq
ZDsKPiArCWludCBkZXZJZHggPSBkZXYtPnByaW1hcnktPmluZGV4Owo+ICsJYm9vbCByZXN1bHQg
PSB0cnVlOwo+ICsJczY0IGRlbHRhID0gMDsKPiArCj4gKwlpZiAoZHJtY2dycCA9PSBOVUxMIHx8
IGRybWNncnAgPT0gcm9vdF9kcm1jZ3JwKQo+ICsJCXJldHVybiB0cnVlOwo+ICsKPiArCWRkciA9
IGRybWNncnAtPmRldl9yZXNvdXJjZXNbZGV2SWR4XTsKPiArCW11dGV4X2xvY2soJmtub3duX2Ry
bWNncnBfZGV2c1tkZXZJZHhdLT5tdXRleCk7Cj4gKwlmb3IgKCA7IGRybWNncnAgIT0gcm9vdF9k
cm1jZ3JwOyBkcm1jZ3JwID0gcGFyZW50X2RybWNncnAoZHJtY2dycCkpIHsKPiArCQlkID0gZHJt
Y2dycC0+ZGV2X3Jlc291cmNlc1tkZXZJZHhdOwo+ICsJCWRlbHRhID0gZC0+Ym9fbGltaXRzX3Rv
dGFsX2FsbG9jYXRlZCAtCj4gKwkJCQlkLT5ib19zdGF0c190b3RhbF9hbGxvY2F0ZWQ7Cj4gKwo+
ICsJCWlmIChkZWx0YSA8PSAwIHx8IHNpemUgPiBkZWx0YSkgewo+ICsJCQlyZXN1bHQgPSBmYWxz
ZTsKPiArCQkJYnJlYWs7Cj4gKwkJfQo+ICsJfQo+ICsJbXV0ZXhfdW5sb2NrKCZrbm93bl9kcm1j
Z3JwX2RldnNbZGV2SWR4XS0+bXV0ZXgpOwo+ICsKPiArCXJldHVybiByZXN1bHQ7Cj4gK30KPiAr
RVhQT1JUX1NZTUJPTChkcm1jZ3JwX2JvX2Nhbl9hbGxvY2F0ZSk7Cj4gKwo+ICt2b2lkIGRybWNn
cnBfY2hnX2JvX2FsbG9jKHN0cnVjdCBkcm1jZ3JwICpkcm1jZ3JwLCBzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2LAo+ICsJCXNpemVfdCBzaXplKQoKU2hvdWxkbid0IHRoaXMgcmV0dXJuIGFuIGVycm9y
IGFuZCBiZSBpbXBsZW1lbnRlZCB3aXRoIHNhbWUgc2VtYW50aWNzIGFzIHRoZQp0cnlfY2hhcmdl
KCkgZnVuY3Rpb25zIG9mIG90aGVyIGNvbnRyb2xsZXJzPwpCZWxvdyB3aWxsIGFsbG93IHN0YXRz
X3RvdGFsX2FsbG9jYXRlZCB0byBvdmVycnVuIGxpbWl0c190b3RhbF9hbGxvY2F0ZWQuCgoKPiAr
ewo+ICsJc3RydWN0IGRybWNncnBfZGV2aWNlX3Jlc291cmNlICpkZHI7Cj4gKwlpbnQgZGV2SWR4
ID0gZGV2LT5wcmltYXJ5LT5pbmRleDsKPiArCj4gKwlpZiAoZHJtY2dycCA9PSBOVUxMIHx8IGtu
b3duX2RybWNncnBfZGV2c1tkZXZJZHhdID09IE5VTEwpCj4gKwkJcmV0dXJuOwo+ICsKPiArCW11
dGV4X2xvY2soJmtub3duX2RybWNncnBfZGV2c1tkZXZJZHhdLT5tdXRleCk7Cj4gKwlmb3IgKCA7
IGRybWNncnAgIT0gTlVMTDsgZHJtY2dycCA9IHBhcmVudF9kcm1jZ3JwKGRybWNncnApKSB7Cj4g
KwkJZGRyID0gZHJtY2dycC0+ZGV2X3Jlc291cmNlc1tkZXZJZHhdOwo+ICsKPiArCQlkZHItPmJv
X3N0YXRzX3RvdGFsX2FsbG9jYXRlZCArPSAoczY0KXNpemU7Cj4gKwl9Cj4gKwltdXRleF91bmxv
Y2soJmtub3duX2RybWNncnBfZGV2c1tkZXZJZHhdLT5tdXRleCk7Cj4gK30KPiArRVhQT1JUX1NZ
TUJPTChkcm1jZ3JwX2NoZ19ib19hbGxvYyk7Cj4gKwo+ICt2b2lkIGRybWNncnBfdW5jaGdfYm9f
YWxsb2Moc3RydWN0IGRybWNncnAgKmRybWNncnAsIHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4g
KwkJc2l6ZV90IHNpemUpCj4gK3sKPiArCXN0cnVjdCBkcm1jZ3JwX2RldmljZV9yZXNvdXJjZSAq
ZGRyOwo+ICsJaW50IGRldklkeCA9IGRldi0+cHJpbWFyeS0+aW5kZXg7Cj4gKwo+ICsJaWYgKGRy
bWNncnAgPT0gTlVMTCB8fCBrbm93bl9kcm1jZ3JwX2RldnNbZGV2SWR4XSA9PSBOVUxMKQo+ICsJ
CXJldHVybjsKPiArCj4gKwlkZHIgPSBkcm1jZ3JwLT5kZXZfcmVzb3VyY2VzW2RldklkeF07Cj4g
KwltdXRleF9sb2NrKCZrbm93bl9kcm1jZ3JwX2RldnNbZGV2SWR4XS0+bXV0ZXgpOwo+ICsJZm9y
ICggOyBkcm1jZ3JwICE9IE5VTEw7IGRybWNncnAgPSBwYXJlbnRfZHJtY2dycChkcm1jZ3JwKSkK
PiArCQlkcm1jZ3JwLT5kZXZfcmVzb3VyY2VzW2RldklkeF0tPmJvX3N0YXRzX3RvdGFsX2FsbG9j
YXRlZAo+ICsJCQktPSAoczY0KXNpemU7Cj4gKwltdXRleF91bmxvY2soJmtub3duX2RybWNncnBf
ZGV2c1tkZXZJZHhdLT5tdXRleCk7Cj4gK30KPiArRVhQT1JUX1NZTUJPTChkcm1jZ3JwX3VuY2hn
X2JvX2FsbG9jKTsKPiAKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Au
b3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRl
dmVs
