Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id D30F5F1B46
	for <lists+dri-devel@lfdr.de>; Wed,  6 Nov 2019 17:31:39 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 29FD46EDDA;
	Wed,  6 Nov 2019 16:31:37 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from bhuna.collabora.co.uk (bhuna.collabora.co.uk
 [IPv6:2a00:1098:0:82:1000:25:2eeb:e3e3])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4CCA66EDD9
 for <dri-devel@lists.freedesktop.org>; Wed,  6 Nov 2019 16:31:34 +0000 (UTC)
Received: from [127.0.0.1] (localhost [127.0.0.1])
 (Authenticated sender: aratiu) with ESMTPSA id BD61F28FDC5
From: Adrian Ratiu <adrian.ratiu@collabora.com>
To: linux-arm-kernel@lists.infradead.org,
 linux-stm32@st-md-mailman.stormreply.com,
 linux-rockchip@lists.infradead.org
Subject: [PATCH v2 3/4] drm: imx: Add i.MX 6 MIPI DSI host driver
Date: Wed,  6 Nov 2019 18:30:30 +0200
Message-Id: <20191106163031.808061-4-adrian.ratiu@collabora.com>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191106163031.808061-1-adrian.ratiu@collabora.com>
References: <20191106163031.808061-1-adrian.ratiu@collabora.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Neil Armstrong <narmstrong@baylibre.com>,
 Martyn Welch <martyn.welch@collabora.com>,
 Sjoerd Simons <sjoerd.simons@collabora.com>,
 Emil Velikov <emil.l.velikov@gmail.com>, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, kernel@collabora.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBhZGRzIHN1cHBvcnQgZm9yIHRoZSBTeW5vcHNpcyBEZXNpZ25XYXJlIE1JUEkgRFNJIHYx
LjAxIGhvc3QKY29udHJvbGxlciB3aGljaCBpcyBlbWJlZGRlZCBpbiBpLk1YIDYgU29Dcy4KCkJh
c2VkIG9uIGZvbGxvd2luZyBwYXRjaGVzLCBidXQgdXBkYXRlZC9leHRlbmRlZCB0byB3b3JrIHdp
dGggZXhpc3RpbmcKc3VwcG9ydCBmb3VuZCBpbiB0aGUga2VybmVsOgoKLSBkcm06IGlteDogU3Vw
cG9ydCBTeW5vcHN5cyBEZXNpZ25XYXJlIE1JUEkgRFNJIGhvc3QgY29udHJvbGxlcgogIFNpZ25l
ZC1vZmYtYnk6IExpdSBZaW5nIDxZaW5nLkxpdUBmcmVlc2NhbGUuY29tPgoKLSBBUk06IGR0c2k6
IGlteDZxZGw6IEFkZCBzdXBwb3J0IGZvciBNSVBJIERTSSBob3N0IGNvbnRyb2xsZXIKICBTaWdu
ZWQtb2ZmLWJ5OiBMaXUgWWluZyA8WWluZy5MaXVAZnJlZXNjYWxlLmNvbT4KClJldmlld2VkLWJ5
OiBOZWlsIEFybXN0cm9uZyA8bmFybXN0cm9uZ0BiYXlsaWJyZS5jb20+ClJldmlld2VkLWJ5OiBF
bWlsIFZlbGlrb3YgPGVtaWwubC52ZWxpa292QGdtYWlsLmNvbT4KU2lnbmVkLW9mZi1ieTogU2pv
ZXJkIFNpbW9ucyA8c2pvZXJkLnNpbW9uc0Bjb2xsYWJvcmEuY29tPgpTaWduZWQtb2ZmLWJ5OiBN
YXJ0eW4gV2VsY2ggPG1hcnR5bi53ZWxjaEBjb2xsYWJvcmEuY29tPgpTaWduZWQtb2ZmLWJ5OiBB
ZHJpYW4gUmF0aXUgPGFkcmlhbi5yYXRpdUBjb2xsYWJvcmEuY29tPgotLS0KIGRyaXZlcnMvZ3B1
L2RybS9icmlkZ2Uvc3lub3BzeXMvZHctbWlwaS1kc2kuYyB8IDE0NiArKysrKystCiBkcml2ZXJz
L2dwdS9kcm0vaW14L0tjb25maWcgICAgICAgICAgICAgICAgICAgfCAgIDcgKwogZHJpdmVycy9n
cHUvZHJtL2lteC9NYWtlZmlsZSAgICAgICAgICAgICAgICAgIHwgICAxICsKIGRyaXZlcnMvZ3B1
L2RybS9pbXgvZHdfbWlwaV9kc2ktaW14LmMgICAgICAgICB8IDM3OCArKysrKysrKysrKysrKysr
KysKIDQgZmlsZXMgY2hhbmdlZCwgNTIzIGluc2VydGlvbnMoKyksIDkgZGVsZXRpb25zKC0pCiBj
cmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2lteC9kd19taXBpX2RzaS1pbXguYwoK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2Uvc3lub3BzeXMvZHctbWlwaS1kc2ku
YyBiL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2Uvc3lub3BzeXMvZHctbWlwaS1kc2kuYwppbmRleCBh
MDYzNzMyOGZiYzEuLmQ4ODM2M2NjMjY4MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2Jy
aWRnZS9zeW5vcHN5cy9kdy1taXBpLWRzaS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2Uv
c3lub3BzeXMvZHctbWlwaS1kc2kuYwpAQCAtMzEsNiArMzEsOCBAQAogI2luY2x1ZGUgPGRybS9k
cm1fcHJvYmVfaGVscGVyLmg+CiAKICNkZWZpbmUgSFdWRVJfMTMxCQkJMHgzMTMzMzEwMAkvKiBJ
UCB2ZXJzaW9uIDEuMzEgKi8KKyNkZWZpbmUgSFdWRVJfMTMwCQkJMHgzMTMzMzAwMAkvKiBJUCB2
ZXJzaW9uIDEuMzAgKi8KKyNkZWZpbmUgSFdWRVJfMTAxCQkJMHgzMTMwMzAwMAkvKiBJUCB2ZXJz
aW9uIDEuMDEgKi8KIAogI2RlZmluZSBEU0lfVkVSU0lPTgkJCTB4MDAKICNkZWZpbmUgVkVSU0lP
TgkJCQlHRU5NQVNLKDMxLCA4KQpAQCAtOTksNiArMTAxLDI1IEBACiAjZGVmaW5lIERTSV9FRFBJ
X0NNRF9TSVpFCQkweDY0CiAKICNkZWZpbmUgRFNJX0NNRF9NT0RFX0NGRwkJMHg2OAorCisjZGVm
aW5lIERTSV9EUElfQ0ZHCQkJMHgwYworI2RlZmluZSBEU0lfVE1SX0xJTkVfQ0ZHCQkweDI4Cisj
ZGVmaW5lIERTSV9WVElNSU5HX0NGRwkJCTB4MmMKKyNkZWZpbmUgRFNJX1BIWV9UTVJfQ0ZHX1Yx
MDEJCTB4MzAKKyNkZWZpbmUgRFNJX1BIWV9JRl9DRkdfVjEwMQkJMHg1OAorI2RlZmluZSBEU0lf
UEhZX0lGX0NUUkwJCQkweDVjCisjZGVmaW5lIERTSV9QSFlfUlNUWl9WMTAxCQkweDU0CisjZGVm
aW5lIERTSV9QSFlfU1RBVFVTX1YxMDEJCTB4NjAKKyNkZWZpbmUgRFNJX1BIWV9UU1RfQ1RSTDBf
VjEwMQkJMHg2NAorI2RlZmluZSBEU0lfR0VOX0hEUl9WMTAxCQkweDM0CisjZGVmaW5lIERTSV9H
RU5fUExEX0RBVEFfVjEwMQkJMHgzOAorI2RlZmluZSBEU0lfQ01EX01PREVfQ0ZHX1YxMDEJCTB4
MjQKKyNkZWZpbmUgRFNJX0NNRF9QS1RfU1RBVFVTX1YxMDEJCTB4M2MKKyNkZWZpbmUgRFNJX1ZJ
RF9QS1RfQ0ZHCQkJMHgyMAorI2RlZmluZSBEU0lfVklEX01PREVfQ0ZHX1YxMDEJCTB4MWMKKyNk
ZWZpbmUgRFNJX1RPX0NOVF9DRkdfVjEwMQkJMHg0MAorI2RlZmluZSBEU0lfUENLSERMX0NGR19W
MTAxCQkweDE4CisKICNkZWZpbmUgTUFYX1JEX1BLVF9TSVpFX0xQCQlCSVQoMjQpCiAjZGVmaW5l
IERDU19MV19UWF9MUAkJCUJJVCgxOSkKICNkZWZpbmUgRENTX1NSXzBQX1RYX0xQCQkJQklUKDE4
KQpAQCAtMTI2LDYgKzE0NywzMyBAQAogCQkJCQkgR0VOX1NXXzFQX1RYX0xQIHwgXAogCQkJCQkg
R0VOX1NXXzBQX1RYX0xQKQogCisjZGVmaW5lIEVOX1RFQVJfRlhfVjEwMQkJCUJJVCgxNCkKKyNk
ZWZpbmUgRENTX0xXX1RYX0xQX1YxMDEJCUJJVCgxMikKKyNkZWZpbmUgR0VOX0xXX1RYX0xQX1Yx
MDEJCUJJVCgxMSkKKyNkZWZpbmUgTUFYX1JEX1BLVF9TSVpFX0xQX1YxMDEJCUJJVCgxMCkKKyNk
ZWZpbmUgRENTX1NXXzJQX1RYX0xQX1YxMDEJCUJJVCg5KQorI2RlZmluZSBEQ1NfU1dfMVBfVFhf
TFBfVjEwMQkJQklUKDgpCisjZGVmaW5lIERDU19TV18wUF9UWF9MUF9WMTAxCQlCSVQoNykKKyNk
ZWZpbmUgR0VOX1NSXzJQX1RYX0xQX1YxMDEJCUJJVCg2KQorI2RlZmluZSBHRU5fU1JfMVBfVFhf
TFBfVjEwMQkJQklUKDUpCisjZGVmaW5lIEdFTl9TUl8wUF9UWF9MUF9WMTAxCQlCSVQoNCkKKyNk
ZWZpbmUgR0VOX1NXXzJQX1RYX0xQX1YxMDEJCUJJVCgzKQorI2RlZmluZSBHRU5fU1dfMVBfVFhf
TFBfVjEwMQkJQklUKDIpCisjZGVmaW5lIEdFTl9TV18wUF9UWF9MUF9WMTAxCQlCSVQoMSkKKwor
I2RlZmluZSBDTURfTU9ERV9BTExfTFBfVjEwMQkJKERDU19MV19UWF9MUF9WMTAxIHwgXAorCQkJ
CQkgR0VOX0xXX1RYX0xQX1YxMDEgfCBcCisJCQkJCSBNQVhfUkRfUEtUX1NJWkVfTFBfVjEwMSB8
IFwKKwkJCQkJIERDU19TV18yUF9UWF9MUF9WMTAxIHwgXAorCQkJCQkgRENTX1NXXzFQX1RYX0xQ
X1YxMDEgfCBcCisJCQkJCSBEQ1NfU1dfMFBfVFhfTFBfVjEwMSB8IFwKKwkJCQkJIEdFTl9TUl8y
UF9UWF9MUF9WMTAxIHwgXAorCQkJCQkgR0VOX1NSXzFQX1RYX0xQX1YxMDEgfCBcCisJCQkJCSBH
RU5fU1JfMFBfVFhfTFBfVjEwMSB8IFwKKwkJCQkJIEdFTl9TV18yUF9UWF9MUF9WMTAxIHwgXAor
CQkJCQkgR0VOX1NXXzFQX1RYX0xQX1YxMDEgfCBcCisJCQkJCSBHRU5fU1dfMFBfVFhfTFBfVjEw
MSkKKwogI2RlZmluZSBEU0lfR0VOX0hEUgkJCTB4NmMKICNkZWZpbmUgRFNJX0dFTl9QTERfREFU
QQkJMHg3MAogCkBAIC0xNjQsNiArMjEyLDExIEBACiAjZGVmaW5lIERTSV9JTlRfTVNLMAkJCTB4
YzQKICNkZWZpbmUgRFNJX0lOVF9NU0sxCQkJMHhjOAogCisjZGVmaW5lIERTSV9FUlJPUl9TVDBf
VjEwMQkJMHg0NAorI2RlZmluZSBEU0lfRVJST1JfU1QxX1YxMDEJCTB4NDgKKyNkZWZpbmUgRFNJ
X0VSUk9SX01TSzBfVjEwMQkJMHg0YworI2RlZmluZSBEU0lfRVJST1JfTVNLMV9WMTAxCQkweDUw
CisKICNkZWZpbmUgRFNJX1BIWV9UTVJfUkRfQ0ZHCQkweGY0CiAKICNkZWZpbmUgUEhZX1NUQVRV
U19USU1FT1VUX1VTCQkxMDAwMApAQCAtMzU3LDYgKzQxMCw0OSBAQCBzdGF0aWMgc3RydWN0IGR3
X21pcGlfZHNpX3ZhcmlhbnQgZHdfbWlwaV9kc2lfdjEzMF92MTMxX2xheW91dCA9IHsKIAkuY2Zn
X2dlbl9wYXlsb2FkID0JCVJFR19GSUVMRChEU0lfR0VOX1BMRF9EQVRBLCAwLCAzMSksCiB9Owog
CitzdGF0aWMgc3RydWN0IGR3X21pcGlfZHNpX3ZhcmlhbnQgZHdfbWlwaV9kc2lfdjEwMV9sYXlv
dXQgPSB7CisJLmNmZ19kcGlfdmlkID0JCQlSRUdfRklFTEQoRFNJX0RQSV9DRkcsIDAsIDEpLAor
CS5jZmdfZHBpX2NvbG9yX2NvZGluZyA9CQlSRUdfRklFTEQoRFNJX0RQSV9DRkcsIDIsIDQpLAor
CS5jZmdfZHBpXzE4bG9vc2VseV9lbiA9CQlSRUdfRklFTEQoRFNJX0RQSV9DRkcsIDEwLCAxMCks
CisJLmNmZ19kcGlfdnN5bmNfYWN0aXZlX2xvdyA9CVJFR19GSUVMRChEU0lfRFBJX0NGRywgNiwg
NiksCisJLmNmZ19kcGlfaHN5bmNfYWN0aXZlX2xvdyA9CVJFR19GSUVMRChEU0lfRFBJX0NGRywg
NywgNyksCisJLmNmZ19jbWRfbW9kZV9lbiA9CQlSRUdfRklFTEQoRFNJX0NNRF9NT0RFX0NGR19W
MTAxLCAwLCAwKSwKKwkuY2ZnX2NtZF9tb2RlX2FsbF9scF9lbiA9CVJFR19GSUVMRChEU0lfQ01E
X01PREVfQ0ZHX1YxMDEsIDEsIDEyKSwKKwkuY2ZnX2NtZF9tb2RlX2Fja19ycXN0X2VuID0JUkVH
X0ZJRUxEKERTSV9DTURfTU9ERV9DRkdfVjEwMSwgMTMsIDEzKSwKKwkuY2ZnX2NtZF9wa3Rfc3Rh
dHVzID0JCVJFR19GSUVMRChEU0lfQ01EX1BLVF9TVEFUVVNfVjEwMSwgMCwgMTQpLAorCS5jZmdf
dmlkX21vZGVfZW4gPQkJUkVHX0ZJRUxEKERTSV9WSURfTU9ERV9DRkdfVjEwMSwgMCwgMCksCisJ
LmNmZ192aWRfbW9kZV90eXBlID0JCVJFR19GSUVMRChEU0lfVklEX01PREVfQ0ZHX1YxMDEsIDEs
IDIpLAorCS5jZmdfdmlkX21vZGVfbG93X3Bvd2VyID0JUkVHX0ZJRUxEKERTSV9WSURfTU9ERV9D
RkdfVjEwMSwgMywgOCksCisJLmNmZ192aWRfcGt0X3NpemUgPQkJUkVHX0ZJRUxEKERTSV9WSURf
UEtUX0NGRywgMCwgMTApLAorCS5jZmdfdmlkX2hzYV90aW1lID0JCVJFR19GSUVMRChEU0lfVE1S
X0xJTkVfQ0ZHLCAwLCA4KSwKKwkuY2ZnX3ZpZF9oYnBfdGltZSA9CQlSRUdfRklFTEQoRFNJX1RN
Ul9MSU5FX0NGRywgOSwgMTcpLAorCS5jZmdfdmlkX2hsaW5lX3RpbWUgPQkJUkVHX0ZJRUxEKERT
SV9UTVJfTElORV9DRkcsIDE4LCAzMSksCisJLmNmZ192aWRfdnNhX3RpbWUgPQkJUkVHX0ZJRUxE
KERTSV9WVElNSU5HX0NGRywgMCwgMyksCisJLmNmZ192aWRfdmJwX3RpbWUgPQkJUkVHX0ZJRUxE
KERTSV9WVElNSU5HX0NGRywgNCwgOSksCisJLmNmZ192aWRfdmZwX3RpbWUgPQkJUkVHX0ZJRUxE
KERTSV9WVElNSU5HX0NGRywgMTAsIDE1KSwKKwkuY2ZnX3ZpZF92YWN0aXZlX3RpbWUgPQkJUkVH
X0ZJRUxEKERTSV9WVElNSU5HX0NGRywgMTYsIDI2KSwKKwkuY2ZnX3BoeV90eHJlcXVlc3RjbGto
cyA9CVJFR19GSUVMRChEU0lfUEhZX0lGX0NUUkwsIDAsIDApLAorCS5jZmdfcGh5X2J0YV90aW1l
ID0JCVJFR19GSUVMRChEU0lfUEhZX1RNUl9DRkdfVjEwMSwgMCwgMTEpLAorCS5jZmdfcGh5X2xw
MmhzX3RpbWUgPQkJUkVHX0ZJRUxEKERTSV9QSFlfVE1SX0NGR19WMTAxLCAxMiwgMTkpLAorCS5j
ZmdfcGh5X2hzMmxwX3RpbWUgPQkJUkVHX0ZJRUxEKERTSV9QSFlfVE1SX0NGR19WMTAxLCAyMCwg
MjcpLAorCS5jZmdfcGh5X3Rlc3RjbHIgPQkJUkVHX0ZJRUxEKERTSV9QSFlfVFNUX0NUUkwwX1Yx
MDEsIDAsIDApLAorCS5jZmdfcGh5X3Vuc2h1dGRvd256ID0JCVJFR19GSUVMRChEU0lfUEhZX1JT
VFpfVjEwMSwgMCwgMCksCisJLmNmZ19waHlfdW5yc3R6ID0JCVJFR19GSUVMRChEU0lfUEhZX1JT
VFpfVjEwMSwgMSwgMSksCisJLmNmZ19waHlfZW5hYmxlY2xrID0JCVJFR19GSUVMRChEU0lfUEhZ
X1JTVFpfVjEwMSwgMiwgMiksCisJLmNmZ19waHlfbmxhbmVzID0JCVJFR19GSUVMRChEU0lfUEhZ
X0lGX0NGR19WMTAxLCAwLCAxKSwKKwkuY2ZnX3BoeV9zdG9wX3dhaXRfdGltZSA9CVJFR19GSUVM
RChEU0lfUEhZX0lGX0NGR19WMTAxLCAyLCA5KSwKKwkuY2ZnX3BoeV9zdGF0dXMgPQkJUkVHX0ZJ
RUxEKERTSV9QSFlfU1RBVFVTX1YxMDEsIDAsIDApLAorCS5jZmdfcGNraGRsX2NmZyA9CQlSRUdf
RklFTEQoRFNJX1BDS0hETF9DRkdfVjEwMSwgMCwgNCksCisJLmNmZ19oc3R4X3RpbWVvdXRfY291
bnRlciA9CVJFR19GSUVMRChEU0lfVE9fQ05UX0NGR19WMTAxLCAwLCAxNSksCisJLmNmZ19scHJ4
X3RpbWVvdXRfY291bnRlciA9CVJFR19GSUVMRChEU0lfVE9fQ05UX0NGR19WMTAxLCAxNiwgMzEp
LAorCS5jZmdfaW50X3N0YXQwID0JCVJFR19GSUVMRChEU0lfRVJST1JfU1QwX1YxMDEsIDAsIDIw
KSwKKwkuY2ZnX2ludF9zdGF0MSA9CQlSRUdfRklFTEQoRFNJX0VSUk9SX1NUMV9WMTAxLCAwLCAx
NyksCisJLmNmZ19pbnRfbWFzazAgPQkJUkVHX0ZJRUxEKERTSV9FUlJPUl9NU0swX1YxMDEsIDAs
IDIwKSwKKwkuY2ZnX2ludF9tYXNrMSA9CQlSRUdfRklFTEQoRFNJX0VSUk9SX01TSzFfVjEwMSwg
MCwgMTcpLAorCS5jZmdfZ2VuX2hkciA9CQkJUkVHX0ZJRUxEKERTSV9HRU5fSERSX1YxMDEsIDAs
IDMxKSwKKwkuY2ZnX2dlbl9wYXlsb2FkID0JCVJFR19GSUVMRChEU0lfR0VOX1BMRF9EQVRBX1Yx
MDEsIDAsIDMxKSwKK307CisKIC8qCiAgKiBDaGVjayBpZiBlaXRoZXIgYSBsaW5rIHRvIGEgbWFz
dGVyIG9yIHNsYXZlIGlzIHByZXNlbnQKICAqLwpAQCAtNDU5LDEyICs1NTUsMjEgQEAgc3RhdGlj
IHZvaWQgZHdfbWlwaV9tZXNzYWdlX2NvbmZpZyhzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSwKIAli
b29sIGxwbSA9IG1zZy0+ZmxhZ3MgJiBNSVBJX0RTSV9NU0dfVVNFX0xQTTsKIAl1MzIgY21kX21v
ZGVfbHAgPSAwOwogCisJc3dpdGNoIChkc2ktPmh3X3ZlcnNpb24pIHsKKwljYXNlIEhXVkVSXzEz
MDoKKwljYXNlIEhXVkVSXzEzMToKKwkJY21kX21vZGVfbHAgPSBDTURfTU9ERV9BTExfTFA7CisJ
CWJyZWFrOworCWNhc2UgSFdWRVJfMTAxOgorCQljbWRfbW9kZV9scCA9IENNRF9NT0RFX0FMTF9M
UF9WMTAxOworCQlicmVhazsKKwl9CisKIAlpZiAobXNnLT5mbGFncyAmIE1JUElfRFNJX01TR19S
RVFfQUNLKQogCQlyZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9jbWRfbW9kZV9hY2tfcnFz
dF9lbiwgMSk7CiAKIAlpZiAobHBtKQotCQlyZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9j
bWRfbW9kZV9hbGxfbHBfZW4sCi0JCQkJICAgQ01EX01PREVfQUxMX0xQKTsKKwkJcmVnbWFwX2Zp
ZWxkX3dyaXRlKGRzaS0+ZmllbGRfY21kX21vZGVfYWxsX2xwX2VuLCBjbWRfbW9kZV9scCk7CiAK
IAlyZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfdHhyZXF1ZXN0Y2xraHMsIGxwbSA/
IDAgOiAxKTsKIH0KQEAgLTYzNiw3ICs3NDEsNyBAQCBzdGF0aWMgdm9pZCBkd19taXBpX2RzaV92
aWRlb19tb2RlX2NvbmZpZyhzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSkKIAkJCQkgICBWSURfTU9E
RV9UWVBFX05PTl9CVVJTVF9TWU5DX0VWRU5UUyk7CiAKICNpZmRlZiBDT05GSUdfREVCVUdfRlMK
LQlpZiAoZHNpLT52cGcpIHsKKwlpZiAoZHNpLT5od192ZXJzaW9uID4gSFdWRVJfMTAxICYmIGRz
aS0+dnBnKSB7CiAJCXJlZ21hcF9maWVsZF93cml0ZShkc2ktPnJlZ3MsIGRzaS0+ZmllbGRfdmlk
X21vZGVfdnBnX2VuLCAxKTsKIAkJcmVnbWFwX2ZpZWxkX3dyaXRlKGRzaS0+cmVncywgZHNpLT5m
aWVsZF92aWRfbW9kZV92cGdfaG9yaXosCiAJCQkJICAgZHNpLT52cGdfaG9yaXpvbnRhbCA/IDEg
OiAwKTsKQEAgLTY1NCw5ICs3NTksMTUgQEAgc3RhdGljIHZvaWQgZHdfbWlwaV9kc2lfc2V0X21v
ZGUoc3RydWN0IGR3X21pcGlfZHNpICpkc2ksCiAKIAkJZHdfbWlwaV9kc2lfdmlkZW9fbW9kZV9j
b25maWcoZHNpKTsKIAorCQlpZiAoZHNpLT5od192ZXJzaW9uID09IEhXVkVSXzEwMSkKKwkJCXJl
Z21hcF9maWVsZF93cml0ZShkc2ktPmZpZWxkX3ZpZF9tb2RlX2VuLCAxKTsKKwogCQlyZWdtYXBf
ZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfdHhyZXF1ZXN0Y2xraHMsIDEpOwogCX0gZWxzZSB7
CiAJCXJlZ21hcF9maWVsZF93cml0ZShkc2ktPmZpZWxkX2NtZF9tb2RlX2VuLCAxKTsKKworCQlp
ZiAoZHNpLT5od192ZXJzaW9uID09IEhXVkVSXzEwMSkKKwkJCXJlZ21hcF9maWVsZF93cml0ZShk
c2ktPmZpZWxkX3ZpZF9tb2RlX2VuLCAwKTsKIAl9CiAKIAlyZWdtYXBfd3JpdGUoZHNpLT5yZWdz
LCBEU0lfUFdSX1VQLCBQT1dFUlVQKTsKQEAgLTg0MCw5ICs5NTEsMTEgQEAgc3RhdGljIHZvaWQg
ZHdfbWlwaV9kc2lfZHBoeV90aW1pbmdfY29uZmlnKHN0cnVjdCBkd19taXBpX2RzaSAqZHNpKQog
CXJlZ21hcF9maWVsZF93cml0ZShkc2ktPmZpZWxkX3BoeV9scDJoc190aW1lLCAweDQwKTsKIAly
ZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfaHMybHBfdGltZSwgMHg0MCk7CiAKLQly
ZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfbWF4X3JkX3RpbWUsIDEwMDAwKTsKLQly
ZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfY2xrbHAyaHNfdGltZSwgMHg0MCk7Ci0J
cmVnbWFwX2ZpZWxkX3dyaXRlKGRzaS0+ZmllbGRfcGh5X2Nsa2hzMmxwX3RpbWUsIDB4NDApOwor
CWlmIChkc2ktPmh3X3ZlcnNpb24gPiBIV1ZFUl8xMDEpIHsKKwkJcmVnbWFwX2ZpZWxkX3dyaXRl
KGRzaS0+ZmllbGRfcGh5X21heF9yZF90aW1lLCAxMDAwMCk7CisJCXJlZ21hcF9maWVsZF93cml0
ZShkc2ktPmZpZWxkX3BoeV9jbGtscDJoc190aW1lLCAweDQwKTsKKwkJcmVnbWFwX2ZpZWxkX3dy
aXRlKGRzaS0+ZmllbGRfcGh5X2Nsa2hzMmxwX3RpbWUsIDB4NDApOworCX0KIH0KIAogc3RhdGlj
IHZvaWQgZHdfbWlwaV9kc2lfZHBoeV9pbnRlcmZhY2VfY29uZmlnKHN0cnVjdCBkd19taXBpX2Rz
aSAqZHNpKQpAQCAtODYzLDcgKzk3Niw4IEBAIHN0YXRpYyB2b2lkIGR3X21pcGlfZHNpX2RwaHlf
aW5pdChzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSkKIAlyZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5m
aWVsZF9waHlfdW5yc3R6LCAwKTsKIAlyZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlf
dW5zaHV0ZG93bnosIDApOwogCi0JcmVnbWFwX2ZpZWxkX3dyaXRlKGRzaS0+ZmllbGRfcGh5X2Zv
cmNlcGxsLCAwKTsKKwlpZiAoZHNpLT5od192ZXJzaW9uID4gSFdWRVJfMTAxKQorCQlyZWdtYXBf
ZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfZm9yY2VwbGwsIDApOwogCiAJcmVnbWFwX2ZpZWxk
X3dyaXRlKGRzaS0+ZmllbGRfcGh5X3Rlc3RjbHIsIDApOwogCXJlZ21hcF9maWVsZF93cml0ZShk
c2ktPmZpZWxkX3BoeV90ZXN0Y2xyLCAxKTsKQEAgLTg3OSw3ICs5OTMsOCBAQCBzdGF0aWMgdm9p
ZCBkd19taXBpX2RzaV9kcGh5X2VuYWJsZShzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSkKIAlyZWdt
YXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfdW5yc3R6LCAxKTsKIAlyZWdtYXBfZmllbGRf
d3JpdGUoZHNpLT5maWVsZF9waHlfdW5zaHV0ZG93bnosIDEpOwogCi0JcmVnbWFwX2ZpZWxkX3dy
aXRlKGRzaS0+ZmllbGRfcGh5X2ZvcmNlcGxsLCAxKTsKKwlpZiAoZHNpLT5od192ZXJzaW9uID4g
SFdWRVJfMTAxKQorCQlyZWdtYXBfZmllbGRfd3JpdGUoZHNpLT5maWVsZF9waHlfZm9yY2VwbGws
IDEpOwogCiAJcmV0ID0gcmVnbWFwX2ZpZWxkX3JlYWRfcG9sbF90aW1lb3V0KGRzaS0+ZmllbGRf
cGh5X3N0YXR1cywKIAkJCQkJICAgICB2YWwsIHZhbCAmIFBIWV9MT0NLLApAQCAtMTEwNSw3ICsx
MjIwLDIwIEBAIHN0YXRpYyB2b2lkIGR3X21pcGlfZHNpX2dldF9od192ZXJzaW9uKHN0cnVjdCBk
d19taXBpX2RzaSAqZHNpKQogCiBzdGF0aWMgaW50IGR3X21pcGlfZHNpX3JlZ21hcF9maWVsZHNf
aW5pdChzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSkKIHsKLQljb25zdCBzdHJ1Y3QgZHdfbWlwaV9k
c2lfdmFyaWFudCAqdmFyaWFudCA9ICZkd19taXBpX2RzaV92MTMwX3YxMzFfbGF5b3V0OworCWNv
bnN0IHN0cnVjdCBkd19taXBpX2RzaV92YXJpYW50ICp2YXJpYW50OworCisJc3dpdGNoIChkc2kt
Pmh3X3ZlcnNpb24pIHsKKwljYXNlIEhXVkVSXzEzMDoKKwljYXNlIEhXVkVSXzEzMToKKwkJdmFy
aWFudCA9ICZkd19taXBpX2RzaV92MTMwX3YxMzFfbGF5b3V0OworCQlicmVhazsKKwljYXNlIEhX
VkVSXzEwMToKKwkJdmFyaWFudCA9ICZkd19taXBpX2RzaV92MTAxX2xheW91dDsKKwkJYnJlYWs7
CisJZGVmYXVsdDoKKwkJRFJNX0VSUk9SKCJVbnJlY29nbml6ZWQgRFNJIGhvc3QgY29udHJvbGxl
ciBIVyByZXZpc2lvblxuIik7CisJCXJldHVybiAtRU5PREVWOworCX0KIAogCUlOSVRfRklFTEQo
ZHBpXzE4bG9vc2VseV9lbik7CiAJSU5JVF9GSUVMRChkcGlfdmlkKTsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pbXgvS2NvbmZpZyBiL2RyaXZlcnMvZ3B1L2RybS9pbXgvS2NvbmZpZwpp
bmRleCAyMDdiZjc0MDlkZmIuLjM5Njc5M2ViZjU0MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2lteC9LY29uZmlnCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pbXgvS2NvbmZpZwpAQCAtMzks
MyArMzksMTAgQEAgY29uZmlnIERSTV9JTVhfSERNSQogCWRlcGVuZHMgb24gRFJNX0lNWAogCWhl
bHAKIAkgIENob29zZSB0aGlzIGlmIHlvdSB3YW50IHRvIHVzZSBIRE1JIG9uIGkuTVg2LgorCitj
b25maWcgRFJNX0lNWF9NSVBJX0RTSQorCXRyaXN0YXRlICJGcmVlc2NhbGUgaS5NWCBEUk0gTUlQ
SSBEU0kiCisJc2VsZWN0IERSTV9EV19NSVBJX0RTSQorCWRlcGVuZHMgb24gRFJNX0lNWAorCWhl
bHAKKwkgIENob29zZSB0aGlzIGlmIHlvdSB3YW50IHRvIHVzZSBNSVBJIERTSSBvbiBpLk1YNi4K
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pbXgvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9k
cm0vaW14L01ha2VmaWxlCmluZGV4IDIxY2RjYzJmYWFiYy4uNjU0M2E4MTM3NmVjIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaW14L01ha2VmaWxlCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
bXgvTWFrZWZpbGUKQEAgLTksMyArOSw0IEBAIG9iai0kKENPTkZJR19EUk1fSU1YX1RWRSkgKz0g
aW14LXR2ZS5vCiBvYmotJChDT05GSUdfRFJNX0lNWF9MREIpICs9IGlteC1sZGIubwogCiBvYmot
JChDT05GSUdfRFJNX0lNWF9IRE1JKSArPSBkd19oZG1pLWlteC5vCitvYmotJChDT05GSUdfRFJN
X0lNWF9NSVBJX0RTSSkgKz0gZHdfbWlwaV9kc2ktaW14Lm8KZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pbXgvZHdfbWlwaV9kc2ktaW14LmMgYi9kcml2ZXJzL2dwdS9kcm0vaW14L2R3X21p
cGlfZHNpLWlteC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uYWFi
YTdlODhjYWE4Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2lteC9kd19taXBp
X2RzaS1pbXguYwpAQCAtMCwwICsxLDM3OCBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6
IEdQTC0yLjArCisvKgorICogaS5NWCBkcm0gZHJpdmVyIC0gTUlQSSBEU0kgSG9zdCBDb250cm9s
bGVyCisgKgorICogQ29weXJpZ2h0IChDKSAyMDExLTIwMTUgRnJlZXNjYWxlIFNlbWljb25kdWN0
b3IsIEluYy4KKyAqLworCisjaW5jbHVkZSA8bGludXgvY2xrLmg+CisjaW5jbHVkZSA8bGludXgv
Y29tcG9uZW50Lmg+CisjaW5jbHVkZSA8bGludXgvbWZkL3N5c2Nvbi5oPgorI2luY2x1ZGUgPGxp
bnV4L21mZC9zeXNjb24vaW14NnEtaW9tdXhjLWdwci5oPgorI2luY2x1ZGUgPGxpbnV4L21vZHVs
ZS5oPgorI2luY2x1ZGUgPGxpbnV4L29mX2RldmljZS5oPgorI2luY2x1ZGUgPGxpbnV4L3JlZ21h
cC5oPgorI2luY2x1ZGUgPGxpbnV4L3ZpZGVvZGV2Mi5oPgorI2luY2x1ZGUgPGRybS9icmlkZ2Uv
ZHdfbWlwaV9kc2kuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2NydGNfaGVscGVyLmg+CisjaW5jbHVk
ZSA8ZHJtL2RybV9taXBpX2RzaS5oPgorI2luY2x1ZGUgPGRybS9kcm1fb2YuaD4KKyNpbmNsdWRl
IDxkcm0vZHJtX3ByaW50Lmg+CisKKyNpbmNsdWRlICJpbXgtZHJtLmgiCisKKyNkZWZpbmUgRFJJ
VkVSX05BTUUJImlteC1taXBpLWRzaSIKKworI2RlZmluZSBEU0lfUFdSX1VQCQkJMHgwNAorI2Rl
ZmluZSBSRVNFVAkJCQkwCisjZGVmaW5lIFBPV0VSVVAJCQkJQklUKDApCisKKyNkZWZpbmUgRFNJ
X1BIWV9JRl9DVFJMCQkJMHg1YworI2RlZmluZSBQSFlfSUZfQ1RSTF9SRVNFVAkJMHgwCisKKyNk
ZWZpbmUgRFNJX1BIWV9UU1RfQ1RSTDAJCTB4NjQKKyNkZWZpbmUgUEhZX1RFU1RDTEsJCQlCSVQo
MSkKKyNkZWZpbmUgUEhZX1VOVEVTVENMSwkJCTAKKyNkZWZpbmUgUEhZX1RFU1RDTFIJCQlCSVQo
MCkKKyNkZWZpbmUgUEhZX1VOVEVTVENMUgkJCTAKKworI2RlZmluZSBEU0lfUEhZX1RTVF9DVFJM
MQkJMHg2OAorI2RlZmluZSBQSFlfVEVTVEVOCQkJQklUKDE2KQorI2RlZmluZSBQSFlfVU5URVNU
RU4JCQkwCisjZGVmaW5lIFBIWV9URVNURE9VVChuKQkJCSgoKG4pICYgMHhmZikgPDwgOCkKKyNk
ZWZpbmUgUEhZX1RFU1RESU4obikJCQkoKChuKSAmIDB4ZmYpIDw8IDApCisKK3N0cnVjdCBpbXhf
bWlwaV9kc2kgeworCXN0cnVjdCBkcm1fZW5jb2RlciBlbmNvZGVyOworCXN0cnVjdCBkZXZpY2Ug
KmRldjsKKwlzdHJ1Y3QgcmVnbWFwICptdXhfc2VsOworCXN0cnVjdCBkd19taXBpX2RzaSAqbWlw
aV9kc2k7CisJc3RydWN0IGNsayAqcGxscmVmX2NsazsKKworCXN0cnVjdCByZWdtYXAgKnJlZ3M7
CisJdW5zaWduZWQgaW50IGxhbmVfbWJwczsKK307CisKK3N0cnVjdCBkcGh5X3BsbF90ZXN0ZGlu
X21hcCB7CisJdW5zaWduZWQgaW50IG1heF9tYnBzOworCXU4IHRlc3RkaW47Cit9OworCisvKiBU
aGUgdGFibGUgaXMgYmFzZWQgb24gMjdNSHogRFBIWSBwbGwgcmVmZXJlbmNlIGNsb2NrLiAqLwor
c3RhdGljIGNvbnN0IHN0cnVjdCBkcGh5X3BsbF90ZXN0ZGluX21hcCBkcHRkaW5fbWFwW10gPSB7
CisJezE2MCwgMHgwNH0sIHsxODAsIDB4MjR9LCB7MjAwLCAweDQ0fSwgezIxMCwgMHgwNn0sCisJ
ezI0MCwgMHgyNn0sIHsyNTAsIDB4NDZ9LCB7MjcwLCAweDA4fSwgezMwMCwgMHgyOH0sCisJezMz
MCwgMHg0OH0sIHszNjAsIDB4MmF9LCB7NDAwLCAweDRhfSwgezQ1MCwgMHgwY30sCisJezUwMCwg
MHgyY30sIHs1NTAsIDB4MGV9LCB7NjAwLCAweDJlfSwgezY1MCwgMHgxMH0sCisJezcwMCwgMHgz
MH0sIHs3NTAsIDB4MTJ9LCB7ODAwLCAweDMyfSwgezg1MCwgMHgxNH0sCisJezkwMCwgMHgzNH0s
IHs5NTAsIDB4NTR9LCB7MTAwMCwgMHg3NH0KK307CisKK3N0YXRpYyBpbmxpbmUgc3RydWN0IGlt
eF9taXBpX2RzaSAqZW5jX3RvX2RzaShzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuYykKK3sKKwlyZXR1
cm4gY29udGFpbmVyX29mKGVuYywgc3RydWN0IGlteF9taXBpX2RzaSwgZW5jb2Rlcik7Cit9CisK
K3N0YXRpYyB2b2lkIGlteF9taXBpX2RzaV9zZXRfaXB1X2RpX211eChzdHJ1Y3QgaW14X21pcGlf
ZHNpICpkc2ksIGludCBpcHVfZGkpCit7CisJcmVnbWFwX3VwZGF0ZV9iaXRzKGRzaS0+bXV4X3Nl
bCwgSU9NVVhDX0dQUjMsCisJCQkgICBJTVg2UV9HUFIzX01JUElfTVVYX0NUTF9NQVNLLAorCQkJ
ICAgaXB1X2RpIDw8IElNWDZRX0dQUjNfTUlQSV9NVVhfQ1RMX1NISUZUKTsKK30KKworc3RhdGlj
IGNvbnN0IHN0cnVjdCBkcm1fZW5jb2Rlcl9mdW5jcyBpbXhfbWlwaV9kc2lfZW5jb2Rlcl9mdW5j
cyA9IHsKKwkuZGVzdHJveSA9IGlteF9kcm1fZW5jb2Rlcl9kZXN0cm95LAorfTsKKworc3RhdGlj
IGJvb2wgaW14X21pcGlfZHNpX2VuY29kZXJfbW9kZV9maXh1cChzdHJ1Y3QgZHJtX2VuY29kZXIg
KmVuY29kZXIsCisJCQkJCSAgICBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSwK
KwkJCQkJICAgIHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGpfbW9kZSkKK3sKKwlyZXR1cm4g
dHJ1ZTsKK30KKworc3RhdGljIGludCBpbXhfbWlwaV9kc2lfZW5jb2Rlcl9hdG9taWNfY2hlY2so
c3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyLAorCQkJCQkgICAgIHN0cnVjdCBkcm1fY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSwKKwkJCQkJICAgICBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAq
Y29ubikKK3sKKwlzdHJ1Y3QgaW14X2NydGNfc3RhdGUgKmlteF9jcnRjX3N0YXRlID0gdG9faW14
X2NydGNfc3RhdGUoY3J0Y19zdGF0ZSk7CisKKwkvKiBUaGUgZm9sbG93aW5nIHZhbHVlcyBhcmUg
dGFrZW4gZnJvbSBkd19oZG1pX2lteF9hdG9taWNfY2hlY2sgKi8KKwlpbXhfY3J0Y19zdGF0ZS0+
YnVzX2Zvcm1hdCA9IE1FRElBX0JVU19GTVRfUkdCODg4XzFYMjQ7CisJaW14X2NydGNfc3RhdGUt
PmRpX2hzeW5jX3BpbiA9IDI7CisJaW14X2NydGNfc3RhdGUtPmRpX3ZzeW5jX3BpbiA9IDM7CisK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgaW14X21pcGlfZHNpX2VuY29kZXJfY29tbWl0
KHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcikKK3sKKwlzdHJ1Y3QgaW14X21pcGlfZHNpICpk
c2kgPSBlbmNfdG9fZHNpKGVuY29kZXIpOworCWludCBtdXggPSBkcm1fb2ZfZW5jb2Rlcl9hY3Rp
dmVfcG9ydF9pZChkc2ktPmRldi0+b2Zfbm9kZSwgZW5jb2Rlcik7CisKKwlpbXhfbWlwaV9kc2lf
c2V0X2lwdV9kaV9tdXgoZHNpLCBtdXgpOworfQorCitzdGF0aWMgdm9pZCBpbXhfbWlwaV9kc2lf
ZW5jb2Rlcl9kaXNhYmxlKHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcikKK3sKK30KKworc3Rh
dGljIGNvbnN0IHN0cnVjdCBkcm1fZW5jb2Rlcl9oZWxwZXJfZnVuY3MgaW14X21pcGlfZHNpX2Vu
Y29kZXJfaGVscGVycyA9IHsKKwkubW9kZV9maXh1cCA9IGlteF9taXBpX2RzaV9lbmNvZGVyX21v
ZGVfZml4dXAsCisJLmNvbW1pdCA9IGlteF9taXBpX2RzaV9lbmNvZGVyX2NvbW1pdCwKKwkuZGlz
YWJsZSA9IGlteF9taXBpX2RzaV9lbmNvZGVyX2Rpc2FibGUsCisJLmF0b21pY19jaGVjayA9IGlt
eF9taXBpX2RzaV9lbmNvZGVyX2F0b21pY19jaGVjaywKK307CisKK3N0YXRpYyBpbnQgaW14X21p
cGlfZHNpX3JlZ2lzdGVyKHN0cnVjdCBkcm1fZGV2aWNlICpkcm0sCisJCQkJIHN0cnVjdCBpbXhf
bWlwaV9kc2kgKmRzaSkKK3sKKwlpbnQgcmV0OworCisJcmV0ID0gaW14X2RybV9lbmNvZGVyX3Bh
cnNlX29mKGRybSwgJmRzaS0+ZW5jb2RlciwgZHNpLT5kZXYtPm9mX25vZGUpOworCWlmIChyZXQp
CisJCXJldHVybiByZXQ7CisKKwlkcm1fZW5jb2Rlcl9oZWxwZXJfYWRkKCZkc2ktPmVuY29kZXIs
CisJCQkgICAgICAgJmlteF9taXBpX2RzaV9lbmNvZGVyX2hlbHBlcnMpOworCWRybV9lbmNvZGVy
X2luaXQoZHJtLCAmZHNpLT5lbmNvZGVyLCAmaW14X21pcGlfZHNpX2VuY29kZXJfZnVuY3MsCisJ
CQkgRFJNX01PREVfRU5DT0RFUl9EU0ksIE5VTEwpOworCXJldHVybiAwOworfQorCitzdGF0aWMg
ZW51bSBkcm1fbW9kZV9zdGF0dXMgaW14X21pcGlfZHNpX21vZGVfdmFsaWQodm9pZCAqcHJpdl9k
YXRhLAorCQkJCQljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkKK3sKKwkvKgor
CSAqIFRoZSBWSURfUEtUX1NJWkUgZmllbGQgaW4gdGhlIERTSV9WSURfUEtUX0NGRworCSAqIHJl
Z2lzdGVyIGlzIDExLWJpdC4KKwkgKi8KKwlpZiAobW9kZS0+aGRpc3BsYXkgPiAweDdmZikKKwkJ
cmV0dXJuIE1PREVfQkFEX0hWQUxVRTsKKworCS8qCisJICogVGhlIFZfQUNUSVZFX0xJTkVTIGZp
ZWxkIGluIHRoZSBEU0lfVlRJTUlOR19DRkcKKwkgKiByZWdpc3RlciBpcyAxMS1iaXQuCisJICov
CisJaWYgKG1vZGUtPnZkaXNwbGF5ID4gMHg3ZmYpCisJCXJldHVybiBNT0RFX0JBRF9WVkFMVUU7
CisKKwlyZXR1cm4gTU9ERV9PSzsKK30KKworCitzdGF0aWMgdW5zaWduZWQgaW50IG1heF9tYnBz
X3RvX3Rlc3RkaW4odW5zaWduZWQgaW50IG1heF9tYnBzKQoreworCXVuc2lnbmVkIGludCBpOwor
CisJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoZHB0ZGluX21hcCk7IGkrKykKKwkJaWYgKGRw
dGRpbl9tYXBbaV0ubWF4X21icHMgPT0gbWF4X21icHMpCisJCQlyZXR1cm4gZHB0ZGluX21hcFtp
XS50ZXN0ZGluOworCisJcmV0dXJuIC1FSU5WQUw7Cit9CisKK3N0YXRpYyBpbnQgaW14X21pcGlf
ZHNpX3BoeV9pbml0KHZvaWQgKnByaXZfZGF0YSkKK3sKKwlzdHJ1Y3QgaW14X21pcGlfZHNpICpk
c2kgPSBwcml2X2RhdGE7CisJc3RydWN0IHJlZ21hcCAqcmVncyA9IGRzaS0+cmVnczsKKwlpbnQg
dGVzdGRpbjsKKworCXRlc3RkaW4gPSBtYXhfbWJwc190b190ZXN0ZGluKGRzaS0+bGFuZV9tYnBz
KTsKKwlpZiAodGVzdGRpbiA8IDApIHsKKwkJZGV2X2Vycihkc2ktPmRldiwKKwkJCSJmYWlsZWQg
dG8gZ2V0IHRlc3RkaW4gZm9yICVkbWJwcyBsYW5lIGNsb2NrXG4iLAorCQkJZHNpLT5sYW5lX21i
cHMpOworCQlyZXR1cm4gdGVzdGRpbjsKKwl9CisKKwlyZWdtYXBfd3JpdGUocmVncywgRFNJX1BI
WV9JRl9DVFJMLCBQSFlfSUZfQ1RSTF9SRVNFVCk7CisJcmVnbWFwX3dyaXRlKHJlZ3MsIERTSV9Q
V1JfVVAsIFBPV0VSVVApOworCisJcmVnbWFwX3dyaXRlKHJlZ3MsIERTSV9QSFlfVFNUX0NUUkww
LCBQSFlfVU5URVNUQ0xLIHwgUEhZX1VOVEVTVENMUik7CisJcmVnbWFwX3dyaXRlKHJlZ3MsIERT
SV9QSFlfVFNUX0NUUkwxLCBQSFlfVEVTVEVOIHwgUEhZX1RFU1RET1VUKDApIHwKKwkJICAgICBQ
SFlfVEVTVERJTigweDQ0KSk7CisJcmVnbWFwX3dyaXRlKHJlZ3MsIERTSV9QSFlfVFNUX0NUUkww
LCBQSFlfVEVTVENMSyB8IFBIWV9VTlRFU1RDTFIpOworCXJlZ21hcF93cml0ZShyZWdzLCBEU0lf
UEhZX1RTVF9DVFJMMCwgUEhZX1VOVEVTVENMSyB8IFBIWV9VTlRFU1RDTFIpOworCXJlZ21hcF93
cml0ZShyZWdzLCBEU0lfUEhZX1RTVF9DVFJMMSwgUEhZX1VOVEVTVEVOIHwgUEhZX1RFU1RET1VU
KDApIHwKKwkJICAgICBQSFlfVEVTVERJTih0ZXN0ZGluKSk7CisJcmVnbWFwX3dyaXRlKHJlZ3Ms
IERTSV9QSFlfVFNUX0NUUkwwLCBQSFlfVEVTVENMSyB8IFBIWV9VTlRFU1RDTFIpOworCXJlZ21h
cF93cml0ZShyZWdzLCBEU0lfUEhZX1RTVF9DVFJMMCwgUEhZX1VOVEVTVENMSyB8IFBIWV9VTlRF
U1RDTFIpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgaW14X21pcGlfZHNpX2dldF9s
YW5lX21icHModm9pZCAqcHJpdl9kYXRhLAorCQkJCSAgICAgIGNvbnN0IHN0cnVjdCBkcm1fZGlz
cGxheV9tb2RlICptb2RlLAorCQkJCSAgICAgIHVuc2lnbmVkIGxvbmcgbW9kZV9mbGFncywgdTMy
IGxhbmVzLAorCQkJCSAgICAgIHUzMiBmb3JtYXQsIHVuc2lnbmVkIGludCAqbGFuZV9tYnBzKQor
eworCXN0cnVjdCBpbXhfbWlwaV9kc2kgKmRzaSA9IHByaXZfZGF0YTsKKwlpbnQgYnBwOworCXVu
c2lnbmVkIGludCBpLCB0YXJnZXRfbWJwcywgbXBjbGs7CisJdW5zaWduZWQgbG9uZyBwbGxyZWY7
CisKKwlicHAgPSBtaXBpX2RzaV9waXhlbF9mb3JtYXRfdG9fYnBwKGZvcm1hdCk7CisJaWYgKGJw
cCA8IDApIHsKKwkJZGV2X2Vycihkc2ktPmRldiwgImZhaWxlZCB0byBnZXQgYnBwIGZvciBwaXhl
bCBmb3JtYXQgJWRcbiIsCisJCQlmb3JtYXQpOworCQlyZXR1cm4gYnBwOworCX0KKworCXBsbHJl
ZiA9IGNsa19nZXRfcmF0ZShkc2ktPnBsbHJlZl9jbGspOworCWlmIChwbGxyZWYgIT0gMjcwMDAw
MDApCisJCWRldl93YXJuKGRzaS0+ZGV2LCAiZXhwZWN0IDI3TUh6IERQSFkgcGxsIHJlZmVyZW5j
ZSBjbG9ja1xuIik7CisKKwltcGNsayA9IERJVl9ST1VORF9VUChtb2RlLT5jbG9jaywgTVNFQ19Q
RVJfU0VDKTsKKwlpZiAobXBjbGspIHsKKwkJLyogdGFrZSAxLzAuNyBibGFua2luZyBvdmVyaGVh
ZCBpbnRvIGNvbnNpZGVyYXRpb24gKi8KKwkJdGFyZ2V0X21icHMgPSAobXBjbGsgKiAoYnBwIC8g
bGFuZXMpICogMTApIC8gNzsKKwl9IGVsc2UgeworCQlkZXZfZGJnKGRzaS0+ZGV2LCAidXNlIGRl
ZmF1bHQgMUdicHMgRFBIWSBwbGwgY2xvY2tcbiIpOworCQl0YXJnZXRfbWJwcyA9IDEwMDA7CisJ
fQorCisJZGV2X2RiZyhkc2ktPmRldiwgInRhcmdldCBEUEhZIHBsbCBjbG9jayBmcmVxdWVuY3kg
aXMgJXVNYnBzXG4iLAorCQl0YXJnZXRfbWJwcyk7CisKKwlmb3IgKGkgPSAwOyBpIDwgQVJSQVlf
U0laRShkcHRkaW5fbWFwKTsgaSsrKSB7CisJCWlmICh0YXJnZXRfbWJwcyA8IGRwdGRpbl9tYXBb
aV0ubWF4X21icHMpIHsKKwkJCSpsYW5lX21icHMgPSBkcHRkaW5fbWFwW2ldLm1heF9tYnBzOwor
CQkJZHNpLT5sYW5lX21icHMgPSAqbGFuZV9tYnBzOworCQkJZGV2X2RiZyhkc2ktPmRldiwKKwkJ
CQkicmVhbCBEUEhZIHBsbCBjbG9jayBmcmVxdWVuY3kgaXMgJXVNYnBzXG4iLAorCQkJCSpsYW5l
X21icHMpOworCQkJcmV0dXJuIDA7CisJCX0KKwl9CisKKwlkZXZfZXJyKGRzaS0+ZGV2LCAiRFBI
WSBjbG9jayBmcmVxdWVuY3kgJXVNYnBzIGlzIG91dCBvZiByYW5nZVxuIiwKKwkJdGFyZ2V0X21i
cHMpOworCisJcmV0dXJuIC1FSU5WQUw7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHdfbWlw
aV9kc2lfcGh5X29wcyBkd19taXBpX2RzaV9zdG1fcGh5X29wcyA9IHsKKwkuaW5pdCA9IGlteF9t
aXBpX2RzaV9waHlfaW5pdCwKKwkuZ2V0X2xhbmVfbWJwcyA9IGlteF9taXBpX2RzaV9nZXRfbGFu
ZV9tYnBzLAorfTsKKworc3RhdGljIHN0cnVjdCBkd19taXBpX2RzaV9wbGF0X2RhdGEgaW14NnFf
bWlwaV9kc2lfZHJ2X2RhdGEgPSB7CisJLm1heF9kYXRhX2xhbmVzID0gMiwKKwkubW9kZV92YWxp
ZCA9IGlteF9taXBpX2RzaV9tb2RlX3ZhbGlkLAorCS5waHlfb3BzID0gJmR3X21pcGlfZHNpX3N0
bV9waHlfb3BzLAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBvZl9kZXZpY2VfaWQgaW14X2Rz
aV9kdF9pZHNbXSA9IHsKKwl7CisJCS5jb21wYXRpYmxlID0gImZzbCxpbXg2cS1taXBpLWRzaSIs
CisJCS5kYXRhID0gJmlteDZxX21pcGlfZHNpX2Rydl9kYXRhLAorCX0sCisJeyAvKiBzZW50aW5l
bCAqLyB9Cit9OworTU9EVUxFX0RFVklDRV9UQUJMRShvZiwgaW14X2RzaV9kdF9pZHMpOworCitz
dGF0aWMgaW50IGlteF9taXBpX2RzaV9iaW5kKHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRl
dmljZSAqbWFzdGVyLAorCQkJICAgICB2b2lkICpkYXRhKQoreworCXN0cnVjdCBpbXhfbWlwaV9k
c2kgKmRzaSA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOworCXN0cnVjdCBkcm1fZGV2aWNlICpkcm0g
PSBkYXRhOworCWludCByZXQ7CisKKwlyZXQgPSBpbXhfbWlwaV9kc2lfcmVnaXN0ZXIoZHJtLCBk
c2kpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwlyZXQgPSBkd19taXBpX2RzaV9iaW5k
KGRzaS0+bWlwaV9kc2ksICZkc2ktPmVuY29kZXIpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7
CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgaW14X21pcGlfZHNpX3VuYmluZChzdHJ1
Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBkZXZpY2UgKm1hc3RlciwKKwkJCQl2b2lkICpkYXRhKQor
eworCXN0cnVjdCBpbXhfbWlwaV9kc2kgKmRzaSA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOworCisJ
cmV0dXJuIGR3X21pcGlfZHNpX3VuYmluZChkc2ktPm1pcGlfZHNpKTsKK30KKworc3RhdGljIGNv
bnN0IHN0cnVjdCBjb21wb25lbnRfb3BzIGlteF9taXBpX2RzaV9vcHMgPSB7CisJLmJpbmQJPSBp
bXhfbWlwaV9kc2lfYmluZCwKKwkudW5iaW5kCT0gaW14X21pcGlfZHNpX3VuYmluZCwKK307CisK
K3N0YXRpYyBpbnQgaW14X21pcGlfZHNpX3Byb2JlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBk
ZXYpCit7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJnBkZXYtPmRldjsKKwljb25zdCBzdHJ1Y3Qg
b2ZfZGV2aWNlX2lkICpvZl9pZCA9IG9mX21hdGNoX2RldmljZShpbXhfZHNpX2R0X2lkcywgZGV2
KTsKKwljb25zdCBzdHJ1Y3QgZHdfbWlwaV9kc2lfcGxhdF9kYXRhICpwZGF0YSA9IG9mX2lkLT5k
YXRhOworCXN0cnVjdCBpbXhfbWlwaV9kc2kgKmRzaTsKKwlpbnQgcmV0OworCisJZHNpID0gZGV2
bV9remFsbG9jKGRldiwgc2l6ZW9mKCpkc2kpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWRzaSkKKwkJ
cmV0dXJuIC1FTk9NRU07CisKKwlkc2ktPmRldiA9IGRldjsKKworCWRzaS0+cGxscmVmX2NsayA9
IGRldm1fY2xrX2dldChkZXYsICJyZWYiKTsKKwlpZiAoSVNfRVJSKGRzaS0+cGxscmVmX2Nsaykp
IHsKKwkJcmV0ID0gUFRSX0VSUihkc2ktPnBsbHJlZl9jbGspOworCQlkZXZfZGJnKGRldiwgIiVz
OiBVbmFibGUgdG8gZ2V0IHBsbCByZWZlcmVuY2UgY2xvY2s6ICVkXG4iLAorCQkJX19mdW5jX18s
IHJldCk7CisJCXJldHVybiByZXQ7CisJfQorCisJcmV0ID0gY2xrX3ByZXBhcmVfZW5hYmxlKGRz
aS0+cGxscmVmX2Nsayk7CisJaWYgKHJldCkgeworCQlkZXZfZXJyKGRldiwgIiVzOiBGYWlsZWQg
dG8gZW5hYmxlIHBsbHJlZl9jbGtcbiIsIF9fZnVuY19fKTsKKwkJcmV0dXJuIHJldDsKKwl9CisK
Kwlkc2ktPm11eF9zZWwgPSBzeXNjb25fcmVnbWFwX2xvb2t1cF9ieV9waGFuZGxlKGRldi0+b2Zf
bm9kZSwgImdwciIpOworCWlmIChJU19FUlIoZHNpLT5tdXhfc2VsKSkgeworCQlyZXQgPSBQVFJf
RVJSKGRzaS0+bXV4X3NlbCk7CisJCWRldl9lcnIoZGV2LCAiJXM6IEZhaWxlZCB0byBnZXQgR1BS
IHJlZ21hcDogJWRcbiIsCisJCQlfX2Z1bmNfXywgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisK
KwlkZXZfc2V0X2RydmRhdGEoZGV2LCBkc2kpOworCisJaW14NnFfbWlwaV9kc2lfZHJ2X2RhdGEu
cHJpdl9kYXRhID0gZHNpOworCisJZHNpLT5taXBpX2RzaSA9IGR3X21pcGlfZHNpX3Byb2JlKHBk
ZXYsIHBkYXRhKTsKKwlpZiAoSVNfRVJSKGRzaS0+bWlwaV9kc2kpKSB7CisJCXJldCA9IFBUUl9F
UlIoZHNpLT5taXBpX2RzaSk7CisJCWRldl9kYmcoZGV2LCAiJXM6IFVuYWJsZSB0byBwcm9iZSBE
VyBEU0kgaG9zdCBkZXZpY2U6ICVkXG4iLAorCQkJX19mdW5jX18sIHJldCk7CisJCXJldHVybiAt
RU5PREVWOworCX0KKworCWRzaS0+cmVncyA9IHBkYXRhLT5yZWdzOworCisJcmV0dXJuIGNvbXBv
bmVudF9hZGQoJnBkZXYtPmRldiwgJmlteF9taXBpX2RzaV9vcHMpOworfQorCitzdGF0aWMgaW50
IGlteF9taXBpX2RzaV9yZW1vdmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKK3sKKwlj
b21wb25lbnRfZGVsKCZwZGV2LT5kZXYsICZpbXhfbWlwaV9kc2lfb3BzKTsKKwlyZXR1cm4gMDsK
K30KKworc3RhdGljIHN0cnVjdCBwbGF0Zm9ybV9kcml2ZXIgaW14X21pcGlfZHNpX2RyaXZlciA9
IHsKKwkucHJvYmUJCT0gaW14X21pcGlfZHNpX3Byb2JlLAorCS5yZW1vdmUJCT0gaW14X21pcGlf
ZHNpX3JlbW92ZSwKKwkuZHJpdmVyCQk9IHsKKwkJLm9mX21hdGNoX3RhYmxlID0gaW14X2RzaV9k
dF9pZHMsCisJCS5uYW1lCT0gRFJJVkVSX05BTUUsCisJfSwKK307Cittb2R1bGVfcGxhdGZvcm1f
ZHJpdmVyKGlteF9taXBpX2RzaV9kcml2ZXIpOworCitNT0RVTEVfREVTQ1JJUFRJT04oImkuTVgg
TUlQSSBEU0kgaG9zdCBjb250cm9sbGVyIGRyaXZlciIpOworTU9EVUxFX0FVVEhPUigiTGl1IFlp
bmcgPFlpbmcuTGl1QGZyZWVzY2FsZS5jb20+Iik7CitNT0RVTEVfTElDRU5TRSgiR1BMIik7CitN
T0RVTEVfQUxJQVMoInBsYXRmb3JtOiIgRFJJVkVSX05BTUUpOwotLSAKMi4yMy4wCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGlu
ZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
