Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id D5AE771296
	for <lists+dri-devel@lfdr.de>; Tue, 23 Jul 2019 09:16:21 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F18B26E0C2;
	Tue, 23 Jul 2019 07:15:43 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-pg1-x542.google.com (mail-pg1-x542.google.com
 [IPv6:2607:f8b0:4864:20::542])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E301789101
 for <dri-devel@lists.freedesktop.org>; Mon, 22 Jul 2019 22:34:20 +0000 (UTC)
Received: by mail-pg1-x542.google.com with SMTP id f20so9107970pgj.0
 for <dri-devel@lists.freedesktop.org>; Mon, 22 Jul 2019 15:34:20 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=Smy6CazaiFl/H6ExmdJz5h/Ca61boss3Hwy2iE3dK+Q=;
 b=db/2QbqQe8UIxiRX6cZaxI7lgGGnqSKQGssfc89WmMPTDu2z2dK1+PehyBAxFH+p8V
 oCb9Gamsw1L/OrZVoiNmfNx/uNQzWLtsVCDvIMld+iDD/tEqyfKYQIKS4E9UT/N3t4l8
 +7bcBkPw0bcDJNavfYccxwZ+Ps3kExE72qQol1z9gppY4+OgA9cyICior0yh6WvAFlrv
 mzSdY4txh7wJGboDc1oca78J+c6ISWfQoGPyU3M6FxLBhB1qRnbTp3oJg+2fafdeDtAw
 gEhBkAUSdC/evQW16Oir4RYuFSf6vBywKTiSDzVAl77h+JHVxbPfcNTDOz2VUIH39V1+
 W6RA==
X-Gm-Message-State: APjAAAVSpZI9PiXzMrUAtZVfHr0kVenM73hLuizdZ9NJeQM7gHEuaA2B
 Uwi6frhcN6oEDZhd0cJfRck=
X-Google-Smtp-Source: APXvYqz/H2LrvbsAG7WTQI6TytjdHd6yi9WvqhWVYARGR3hkdauf6CDVf8InQZb+IHek/f+tTcf/6A==
X-Received: by 2002:a62:1444:: with SMTP id 65mr2422112pfu.145.1563834860576; 
 Mon, 22 Jul 2019 15:34:20 -0700 (PDT)
Received: from blueforge.nvidia.com (searspoint.nvidia.com. [216.228.112.21])
 by smtp.gmail.com with ESMTPSA id
 r18sm30597570pfg.77.2019.07.22.15.34.19
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Mon, 22 Jul 2019 15:34:20 -0700 (PDT)
From: john.hubbard@gmail.com
X-Google-Original-From: jhubbard@nvidia.com
To: Andrew Morton <akpm@linux-foundation.org>
Subject: [PATCH 1/3] mm/gup: introduce __put_user_pages()
Date: Mon, 22 Jul 2019 15:34:13 -0700
Message-Id: <20190722223415.13269-2-jhubbard@nvidia.com>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20190722223415.13269-1-jhubbard@nvidia.com>
References: <20190722223415.13269-1-jhubbard@nvidia.com>
MIME-Version: 1.0
X-NVConfidentiality: public
X-Mailman-Approved-At: Tue, 23 Jul 2019 07:14:10 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=Smy6CazaiFl/H6ExmdJz5h/Ca61boss3Hwy2iE3dK+Q=;
 b=U6/9IuL/TDFPDdHP/xEXC6qMrm1JOrSFcurq01xiF+Ds4AZyxPEN0zUc6M5cA6Ac2S
 lkz9/GilaTPQsdifymQ/iRSnBB3jF8OL7EtArtnl3P24bowo3fJlj3rjN86K6voNS6GH
 Dqmbtb60GhmjYXSXo6GRkm723W8wBuMOSeua5HmsQ6B7GzeInFzsL3p7urhRUckE7nOz
 cZAS/lxZQg2opPLxvraqp1cJo6cbVXc0mSOp571t2fjxJq+aMSbg5Xu5EFd+E1lReoM9
 BS3AbtelcWJr2yfzvyHmXxv8QcBg7OH7i3yTert2ueqfUr/6ie3hJa/sawyB9+pwB1Ts
 W4KA==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Boaz Harrosh <boaz@plexistor.com>, Jan Kara <jack@suse.cz>,
 David Airlie <airlied@linux.ie>, Dave Chinner <david@fromorbit.com>,
 dri-devel@lists.freedesktop.org, linux-mm@kvack.org,
 Christoph Hellwig <hch@lst.de>, Sage Weil <sage@redhat.com>,
 Miklos Szeredi <miklos@szeredi.hu>, linux-rdma@vger.kernel.org,
 Matthew Wilcox <willy@infradead.org>, Jason Gunthorpe <jgg@ziepe.ca>,
 Johannes Thumshirn <jthumshirn@suse.de>, Ilya Dryomov <idryomov@gmail.com>,
 =?UTF-8?q?Bj=C3=B6rn=20T=C3=B6pel?= <bjorn.topel@intel.com>,
 John Hubbard <jhubbard@nvidia.com>,
 Santosh Shilimkar <santosh.shilimkar@oracle.com>,
 Ming Lei <ming.lei@redhat.com>,
 =?UTF-8?q?J=C3=A9r=C3=B4me=20Glisse?= <jglisse@redhat.com>,
 Alexander Viro <viro@zeniv.linux.org.uk>,
 Dan Williams <dan.j.williams@intel.com>,
 Magnus Karlsson <magnus.karlsson@intel.com>, Jens Axboe <axboe@kernel.dk>,
 netdev@vger.kernel.org, LKML <linux-kernel@vger.kernel.org>,
 Yan Zheng <zyan@redhat.com>, bpf@vger.kernel.org,
 "David S . Miller" <davem@davemloft.net>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogSm9obiBIdWJiYXJkIDxqaHViYmFyZEBudmlkaWEuY29tPgoKQWRkIGEgbW9yZSBjYXBh
YmxlIHZhcmlhdGlvbiBvZiBwdXRfdXNlcl9wYWdlcygpIHRvIHRoZQpBUEkgc2V0LCBhbmQgY2Fs
bCBpdCBmcm9tIHRoZSBzaW1wbGUgb25lcy4KClRoZSBuZXcgX19wdXRfdXNlcl9wYWdlcygpIHRh
a2VzIGFuIGVudW0gdGhhdCBoYW5kbGVzIHRoZSB2YXJpb3VzCmNvbWJpbmF0aW9ucyBvZiBuZWVk
aW5nIHRvIGNhbGwgc2V0X3BhZ2VfZGlydHkoKSBvcgpzZXRfcGFnZV9kaXJ0eV9sb2NrKCksIGJl
Zm9yZSBjYWxsaW5nIHB1dF91c2VyX3BhZ2UoKS4KCkNjOiBNYXR0aGV3IFdpbGNveCA8d2lsbHlA
aW5mcmFkZWFkLm9yZz4KQ2M6IEphbiBLYXJhIDxqYWNrQHN1c2UuY3o+CkNjOiBDaHJpc3RvcGgg
SGVsbHdpZyA8aGNoQGxzdC5kZT4KU2lnbmVkLW9mZi1ieTogSm9obiBIdWJiYXJkIDxqaHViYmFy
ZEBudmlkaWEuY29tPgotLS0KIGluY2x1ZGUvbGludXgvbW0uaCB8ICA1OCArKysrKysrKysrKysr
KysrKystCiBtbS9ndXAuYyAgICAgICAgICAgfCAxMzcgKysrKysrKysrKysrKysrKysrKysrKy0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAyIGZpbGVzIGNoYW5nZWQsIDEyNCBpbnNlcnRpb25zKCsp
LCA3MSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L21tLmggYi9pbmNs
dWRlL2xpbnV4L21tLmgKaW5kZXggMDMzNGNhOTdjNTg0Li43MjE4NTg1NjgxYjIgMTAwNjQ0Ci0t
LSBhL2luY2x1ZGUvbGludXgvbW0uaAorKysgYi9pbmNsdWRlL2xpbnV4L21tLmgKQEAgLTEwNTcs
OCArMTA1Nyw2MiBAQCBzdGF0aWMgaW5saW5lIHZvaWQgcHV0X3VzZXJfcGFnZShzdHJ1Y3QgcGFn
ZSAqcGFnZSkKIAlwdXRfcGFnZShwYWdlKTsKIH0KIAotdm9pZCBwdXRfdXNlcl9wYWdlc19kaXJ0
eShzdHJ1Y3QgcGFnZSAqKnBhZ2VzLCB1bnNpZ25lZCBsb25nIG5wYWdlcyk7Ci12b2lkIHB1dF91
c2VyX3BhZ2VzX2RpcnR5X2xvY2soc3RydWN0IHBhZ2UgKipwYWdlcywgdW5zaWduZWQgbG9uZyBu
cGFnZXMpOworZW51bSBwdXBfZmxhZ3NfdCB7CisJUFVQX0ZMQUdTX0NMRUFOCQk9IDAsCisJUFVQ
X0ZMQUdTX0RJUlRZCQk9IDEsCisJUFVQX0ZMQUdTX0xPQ0sJCT0gMiwKKwlQVVBfRkxBR1NfRElS
VFlfTE9DSwk9IDMsCit9OworCit2b2lkIF9fcHV0X3VzZXJfcGFnZXMoc3RydWN0IHBhZ2UgKipw
YWdlcywgdW5zaWduZWQgbG9uZyBucGFnZXMsCisJCSAgICAgIGVudW0gcHVwX2ZsYWdzX3QgZmxh
Z3MpOworCisvKioKKyAqIHB1dF91c2VyX3BhZ2VzX2RpcnR5KCkgLSByZWxlYXNlIGFuZCBkaXJ0
eSBhbiBhcnJheSBvZiBndXAtcGlubmVkIHBhZ2VzCisgKiBAcGFnZXM6ICBhcnJheSBvZiBwYWdl
cyB0byBiZSBtYXJrZWQgZGlydHkgYW5kIHJlbGVhc2VkLgorICogQG5wYWdlczogbnVtYmVyIG9m
IHBhZ2VzIGluIHRoZSBAcGFnZXMgYXJyYXkuCisgKgorICogImd1cC1waW5uZWQgcGFnZSIgcmVm
ZXJzIHRvIGEgcGFnZSB0aGF0IGhhcyBoYWQgb25lIG9mIHRoZSBnZXRfdXNlcl9wYWdlcygpCisg
KiB2YXJpYW50cyBjYWxsZWQgb24gdGhhdCBwYWdlLgorICoKKyAqIEZvciBlYWNoIHBhZ2UgaW4g
dGhlIEBwYWdlcyBhcnJheSwgbWFrZSB0aGF0IHBhZ2UgKG9yIGl0cyBoZWFkIHBhZ2UsIGlmIGEK
KyAqIGNvbXBvdW5kIHBhZ2UpIGRpcnR5LCBpZiBpdCB3YXMgcHJldmlvdXNseSBsaXN0ZWQgYXMg
Y2xlYW4uIFRoZW4sIHJlbGVhc2UKKyAqIHRoZSBwYWdlIHVzaW5nIHB1dF91c2VyX3BhZ2UoKS4K
KyAqCisgKiBQbGVhc2Ugc2VlIHRoZSBwdXRfdXNlcl9wYWdlKCkgZG9jdW1lbnRhdGlvbiBmb3Ig
ZGV0YWlscy4KKyAqCisgKiBzZXRfcGFnZV9kaXJ0eSgpLCB3aGljaCBkb2VzIG5vdCBsb2NrIHRo
ZSBwYWdlLCBpcyB1c2VkIGhlcmUuCisgKiBUaGVyZWZvcmUsIGl0IGlzIHRoZSBjYWxsZXIncyBy
ZXNwb25zaWJpbGl0eSB0byBlbnN1cmUgdGhhdCB0aGlzIGlzCisgKiBzYWZlLiBJZiBub3QsIHRo
ZW4gcHV0X3VzZXJfcGFnZXNfZGlydHlfbG9jaygpIHNob3VsZCBiZSBjYWxsZWQgaW5zdGVhZC4K
KyAqCisgKi8KK3N0YXRpYyBpbmxpbmUgdm9pZCBwdXRfdXNlcl9wYWdlc19kaXJ0eShzdHJ1Y3Qg
cGFnZSAqKnBhZ2VzLAorCQkJCQl1bnNpZ25lZCBsb25nIG5wYWdlcykKK3sKKwlfX3B1dF91c2Vy
X3BhZ2VzKHBhZ2VzLCBucGFnZXMsIFBVUF9GTEFHU19ESVJUWSk7Cit9CisKKy8qKgorICogcHV0
X3VzZXJfcGFnZXNfZGlydHlfbG9jaygpIC0gcmVsZWFzZSBhbmQgZGlydHkgYW4gYXJyYXkgb2Yg
Z3VwLXBpbm5lZCBwYWdlcworICogQHBhZ2VzOiAgYXJyYXkgb2YgcGFnZXMgdG8gYmUgbWFya2Vk
IGRpcnR5IGFuZCByZWxlYXNlZC4KKyAqIEBucGFnZXM6IG51bWJlciBvZiBwYWdlcyBpbiB0aGUg
QHBhZ2VzIGFycmF5LgorICoKKyAqIEZvciBlYWNoIHBhZ2UgaW4gdGhlIEBwYWdlcyBhcnJheSwg
bWFrZSB0aGF0IHBhZ2UgKG9yIGl0cyBoZWFkIHBhZ2UsIGlmIGEKKyAqIGNvbXBvdW5kIHBhZ2Up
IGRpcnR5LCBpZiBpdCB3YXMgcHJldmlvdXNseSBsaXN0ZWQgYXMgY2xlYW4uIFRoZW4sIHJlbGVh
c2UKKyAqIHRoZSBwYWdlIHVzaW5nIHB1dF91c2VyX3BhZ2UoKS4KKyAqCisgKiBQbGVhc2Ugc2Vl
IHRoZSBwdXRfdXNlcl9wYWdlKCkgZG9jdW1lbnRhdGlvbiBmb3IgZGV0YWlscy4KKyAqCisgKiBU
aGlzIGlzIGp1c3QgbGlrZSBwdXRfdXNlcl9wYWdlc19kaXJ0eSgpLCBleGNlcHQgdGhhdCBpdCBp
bnZva2VzCisgKiBzZXRfcGFnZV9kaXJ0eV9sb2NrKCksIGluc3RlYWQgb2Ygc2V0X3BhZ2VfZGly
dHkoKS4KKyAqCisgKi8KK3N0YXRpYyBpbmxpbmUgdm9pZCBwdXRfdXNlcl9wYWdlc19kaXJ0eV9s
b2NrKHN0cnVjdCBwYWdlICoqcGFnZXMsCisJCQkJCSAgICAgdW5zaWduZWQgbG9uZyBucGFnZXMp
Cit7CisJX19wdXRfdXNlcl9wYWdlcyhwYWdlcywgbnBhZ2VzLCBQVVBfRkxBR1NfRElSVFlfTE9D
Syk7Cit9CisKIHZvaWQgcHV0X3VzZXJfcGFnZXMoc3RydWN0IHBhZ2UgKipwYWdlcywgdW5zaWdu
ZWQgbG9uZyBucGFnZXMpOwogCiAjaWYgZGVmaW5lZChDT05GSUdfU1BBUlNFTUVNKSAmJiAhZGVm
aW5lZChDT05GSUdfU1BBUlNFTUVNX1ZNRU1NQVApCmRpZmYgLS1naXQgYS9tbS9ndXAuYyBiL21t
L2d1cC5jCmluZGV4IDk4ZjEzYWIzN2JhYy4uNjgzMWVmMDY0ZDc2IDEwMDY0NAotLS0gYS9tbS9n
dXAuYworKysgYi9tbS9ndXAuYwpAQCAtMjksODcgKzI5LDg2IEBAIHN0cnVjdCBmb2xsb3dfcGFn
ZV9jb250ZXh0IHsKIAl1bnNpZ25lZCBpbnQgcGFnZV9tYXNrOwogfTsKIAotdHlwZWRlZiBpbnQg
KCpzZXRfZGlydHlfZnVuY190KShzdHJ1Y3QgcGFnZSAqcGFnZSk7Ci0KLXN0YXRpYyB2b2lkIF9f
cHV0X3VzZXJfcGFnZXNfZGlydHkoc3RydWN0IHBhZ2UgKipwYWdlcywKLQkJCQkgICB1bnNpZ25l
ZCBsb25nIG5wYWdlcywKLQkJCQkgICBzZXRfZGlydHlfZnVuY190IHNkZikKLXsKLQl1bnNpZ25l
ZCBsb25nIGluZGV4OwotCi0JZm9yIChpbmRleCA9IDA7IGluZGV4IDwgbnBhZ2VzOyBpbmRleCsr
KSB7Ci0JCXN0cnVjdCBwYWdlICpwYWdlID0gY29tcG91bmRfaGVhZChwYWdlc1tpbmRleF0pOwot
Ci0JCS8qCi0JCSAqIENoZWNraW5nIFBhZ2VEaXJ0eSBhdCB0aGlzIHBvaW50IG1heSByYWNlIHdp
dGgKLQkJICogY2xlYXJfcGFnZV9kaXJ0eV9mb3JfaW8oKSwgYnV0IHRoYXQncyBPSy4gVHdvIGtl
eSBjYXNlczoKLQkJICoKLQkJICogMSkgVGhpcyBjb2RlIHNlZXMgdGhlIHBhZ2UgYXMgYWxyZWFk
eSBkaXJ0eSwgc28gaXQgc2tpcHMKLQkJICogdGhlIGNhbGwgdG8gc2RmKCkuIFRoYXQgY291bGQg
aGFwcGVuIGJlY2F1c2UKLQkJICogY2xlYXJfcGFnZV9kaXJ0eV9mb3JfaW8oKSBjYWxsZWQgcGFn
ZV9ta2NsZWFuKCksCi0JCSAqIGZvbGxvd2VkIGJ5IHNldF9wYWdlX2RpcnR5KCkuIEhvd2V2ZXIs
IG5vdyB0aGUgcGFnZSBpcwotCQkgKiBnb2luZyB0byBnZXQgd3JpdHRlbiBiYWNrLCB3aGljaCBt
ZWV0cyB0aGUgb3JpZ2luYWwKLQkJICogaW50ZW50aW9uIG9mIHNldHRpbmcgaXQgZGlydHksIHNv
IGFsbCBpcyB3ZWxsOgotCQkgKiBjbGVhcl9wYWdlX2RpcnR5X2Zvcl9pbygpIGdvZXMgb24gdG8g
Y2FsbAotCQkgKiBUZXN0Q2xlYXJQYWdlRGlydHkoKSwgYW5kIHdyaXRlIHRoZSBwYWdlIGJhY2su
Ci0JCSAqCi0JCSAqIDIpIFRoaXMgY29kZSBzZWVzIHRoZSBwYWdlIGFzIGNsZWFuLCBzbyBpdCBj
YWxscyBzZGYoKS4KLQkJICogVGhlIHBhZ2Ugc3RheXMgZGlydHksIGRlc3BpdGUgYmVpbmcgd3Jp
dHRlbiBiYWNrLCBzbyBpdAotCQkgKiBnZXRzIHdyaXR0ZW4gYmFjayBhZ2FpbiBpbiB0aGUgbmV4
dCB3cml0ZWJhY2sgY3ljbGUuCi0JCSAqIFRoaXMgaXMgaGFybWxlc3MuCi0JCSAqLwotCQlpZiAo
IVBhZ2VEaXJ0eShwYWdlKSkKLQkJCXNkZihwYWdlKTsKLQotCQlwdXRfdXNlcl9wYWdlKHBhZ2Up
OwotCX0KLX0KLQogLyoqCi0gKiBwdXRfdXNlcl9wYWdlc19kaXJ0eSgpIC0gcmVsZWFzZSBhbmQg
ZGlydHkgYW4gYXJyYXkgb2YgZ3VwLXBpbm5lZCBwYWdlcworICogX19wdXRfdXNlcl9wYWdlcygp
IC0gcmVsZWFzZSBhbiBhcnJheSBvZiBndXAtcGlubmVkIHBhZ2VzLgogICogQHBhZ2VzOiAgYXJy
YXkgb2YgcGFnZXMgdG8gYmUgbWFya2VkIGRpcnR5IGFuZCByZWxlYXNlZC4KICAqIEBucGFnZXM6
IG51bWJlciBvZiBwYWdlcyBpbiB0aGUgQHBhZ2VzIGFycmF5LgorICogQGZsYWdzOiBhZGRpdGlv
bmFsIGhpbnRzLCB0byBiZSBhcHBsaWVkIHRvIGVhY2ggcGFnZToKICAqCi0gKiAiZ3VwLXBpbm5l
ZCBwYWdlIiByZWZlcnMgdG8gYSBwYWdlIHRoYXQgaGFzIGhhZCBvbmUgb2YgdGhlIGdldF91c2Vy
X3BhZ2VzKCkKLSAqIHZhcmlhbnRzIGNhbGxlZCBvbiB0aGF0IHBhZ2UuCisgKglQVVBfRkxBR1Nf
Q0xFQU46IG5vIGFkZGl0aW9uYWwgc3RlcHMgcmVxdWlyZWQuIChDb25zaWRlciBjYWxsaW5nCisg
KgkJCSBwdXRfdXNlcl9wYWdlcygpIGRpcmVjdGx5LCBpbnN0ZWFkLikKICAqCi0gKiBGb3IgZWFj
aCBwYWdlIGluIHRoZSBAcGFnZXMgYXJyYXksIG1ha2UgdGhhdCBwYWdlIChvciBpdHMgaGVhZCBw
YWdlLCBpZiBhCi0gKiBjb21wb3VuZCBwYWdlKSBkaXJ0eSwgaWYgaXQgd2FzIHByZXZpb3VzbHkg
bGlzdGVkIGFzIGNsZWFuLiBUaGVuLCByZWxlYXNlCi0gKiB0aGUgcGFnZSB1c2luZyBwdXRfdXNl
cl9wYWdlKCkuCisgKglQVVBfRkxBR1NfRElSVFk6IENhbGwgc2V0X3BhZ2VfZGlydHkoKSBvbiB0
aGUgcGFnZSAoaWYgbm90IGFscmVhZHkKKyAqCQkJIGRpcnR5KS4KICAqCi0gKiBQbGVhc2Ugc2Vl
IHRoZSBwdXRfdXNlcl9wYWdlKCkgZG9jdW1lbnRhdGlvbiBmb3IgZGV0YWlscy4KKyAqICAgICAg
UFVQX0ZMQUdTX0xPQ0s6IG1lYW5pbmdsZXNzIGJ5IGl0c2VsZiwgYnV0IGluY2x1ZGVkIGluIG9y
ZGVyIHRvIHNob3cKKyAqCQkJdGhlIG51bWVyaWMgcmVsYXRpb25zaGlwIGJldHdlZW4gdGhlIGZs
YWdzLgogICoKLSAqIHNldF9wYWdlX2RpcnR5KCksIHdoaWNoIGRvZXMgbm90IGxvY2sgdGhlIHBh
Z2UsIGlzIHVzZWQgaGVyZS4KLSAqIFRoZXJlZm9yZSwgaXQgaXMgdGhlIGNhbGxlcidzIHJlc3Bv
bnNpYmlsaXR5IHRvIGVuc3VyZSB0aGF0IHRoaXMgaXMKLSAqIHNhZmUuIElmIG5vdCwgdGhlbiBw
dXRfdXNlcl9wYWdlc19kaXJ0eV9sb2NrKCkgc2hvdWxkIGJlIGNhbGxlZCBpbnN0ZWFkLgorICog
ICAgICBQVVBfRkxBR1NfRElSVFlfTE9DSzogQ2FsbCBzZXRfcGFnZV9kaXJ0eV9sb2NrKCkgb24g
dGhlIHBhZ2UgKGlmIG5vdAorICoJCQkgICAgICBhbHJlYWR5IGRpcnR5KS4KICAqCisgKiBGb3Ig
ZWFjaCBwYWdlIGluIHRoZSBAcGFnZXMgYXJyYXksIHJlbGVhc2UgdGhlIHBhZ2UgdXNpbmcgcHV0
X3VzZXJfcGFnZSgpLgogICovCi12b2lkIHB1dF91c2VyX3BhZ2VzX2RpcnR5KHN0cnVjdCBwYWdl
ICoqcGFnZXMsIHVuc2lnbmVkIGxvbmcgbnBhZ2VzKQordm9pZCBfX3B1dF91c2VyX3BhZ2VzKHN0
cnVjdCBwYWdlICoqcGFnZXMsIHVuc2lnbmVkIGxvbmcgbnBhZ2VzLAorCQkgICAgICBlbnVtIHB1
cF9mbGFnc190IGZsYWdzKQogewotCV9fcHV0X3VzZXJfcGFnZXNfZGlydHkocGFnZXMsIG5wYWdl
cywgc2V0X3BhZ2VfZGlydHkpOwotfQotRVhQT1JUX1NZTUJPTChwdXRfdXNlcl9wYWdlc19kaXJ0
eSk7CisJdW5zaWduZWQgbG9uZyBpbmRleDsKIAotLyoqCi0gKiBwdXRfdXNlcl9wYWdlc19kaXJ0
eV9sb2NrKCkgLSByZWxlYXNlIGFuZCBkaXJ0eSBhbiBhcnJheSBvZiBndXAtcGlubmVkIHBhZ2Vz
Ci0gKiBAcGFnZXM6ICBhcnJheSBvZiBwYWdlcyB0byBiZSBtYXJrZWQgZGlydHkgYW5kIHJlbGVh
c2VkLgotICogQG5wYWdlczogbnVtYmVyIG9mIHBhZ2VzIGluIHRoZSBAcGFnZXMgYXJyYXkuCi0g
KgotICogRm9yIGVhY2ggcGFnZSBpbiB0aGUgQHBhZ2VzIGFycmF5LCBtYWtlIHRoYXQgcGFnZSAo
b3IgaXRzIGhlYWQgcGFnZSwgaWYgYQotICogY29tcG91bmQgcGFnZSkgZGlydHksIGlmIGl0IHdh
cyBwcmV2aW91c2x5IGxpc3RlZCBhcyBjbGVhbi4gVGhlbiwgcmVsZWFzZQotICogdGhlIHBhZ2Ug
dXNpbmcgcHV0X3VzZXJfcGFnZSgpLgotICoKLSAqIFBsZWFzZSBzZWUgdGhlIHB1dF91c2VyX3Bh
Z2UoKSBkb2N1bWVudGF0aW9uIGZvciBkZXRhaWxzLgotICoKLSAqIFRoaXMgaXMganVzdCBsaWtl
IHB1dF91c2VyX3BhZ2VzX2RpcnR5KCksIGV4Y2VwdCB0aGF0IGl0IGludm9rZXMKLSAqIHNldF9w
YWdlX2RpcnR5X2xvY2soKSwgaW5zdGVhZCBvZiBzZXRfcGFnZV9kaXJ0eSgpLgotICoKLSAqLwot
dm9pZCBwdXRfdXNlcl9wYWdlc19kaXJ0eV9sb2NrKHN0cnVjdCBwYWdlICoqcGFnZXMsIHVuc2ln
bmVkIGxvbmcgbnBhZ2VzKQotewotCV9fcHV0X3VzZXJfcGFnZXNfZGlydHkocGFnZXMsIG5wYWdl
cywgc2V0X3BhZ2VfZGlydHlfbG9jayk7CisJLyoKKwkgKiBUT0RPOiB0aGlzIGNhbiBiZSBvcHRp
bWl6ZWQgZm9yIGh1Z2UgcGFnZXM6IGlmIGEgc2VyaWVzIG9mIHBhZ2VzIGlzCisJICogcGh5c2lj
YWxseSBjb250aWd1b3VzIGFuZCBwYXJ0IG9mIHRoZSBzYW1lIGNvbXBvdW5kIHBhZ2UsIHRoZW4g
YQorCSAqIHNpbmdsZSBvcGVyYXRpb24gdG8gdGhlIGhlYWQgcGFnZSBzaG91bGQgc3VmZmljZS4K
KwkgKi8KKworCWZvciAoaW5kZXggPSAwOyBpbmRleCA8IG5wYWdlczsgaW5kZXgrKykgeworCQlz
dHJ1Y3QgcGFnZSAqcGFnZSA9IGNvbXBvdW5kX2hlYWQocGFnZXNbaW5kZXhdKTsKKworCQlzd2l0
Y2ggKGZsYWdzKSB7CisJCWNhc2UgUFVQX0ZMQUdTX0NMRUFOOgorCQkJYnJlYWs7CisKKwkJY2Fz
ZSBQVVBfRkxBR1NfRElSVFk6CisJCQkvKgorCQkJICogQ2hlY2tpbmcgUGFnZURpcnR5IGF0IHRo
aXMgcG9pbnQgbWF5IHJhY2Ugd2l0aAorCQkJICogY2xlYXJfcGFnZV9kaXJ0eV9mb3JfaW8oKSwg
YnV0IHRoYXQncyBPSy4gVHdvIGtleQorCQkJICogY2FzZXM6CisJCQkgKgorCQkJICogMSkgVGhp
cyBjb2RlIHNlZXMgdGhlIHBhZ2UgYXMgYWxyZWFkeSBkaXJ0eSwgc28gaXQKKwkJCSAqIHNraXBz
IHRoZSBjYWxsIHRvIHNldF9wYWdlX2RpcnR5KCkuIFRoYXQgY291bGQgaGFwcGVuCisJCQkgKiBi
ZWNhdXNlIGNsZWFyX3BhZ2VfZGlydHlfZm9yX2lvKCkgY2FsbGVkCisJCQkgKiBwYWdlX21rY2xl
YW4oKSwgZm9sbG93ZWQgYnkgc2V0X3BhZ2VfZGlydHkoKS4KKwkJCSAqIEhvd2V2ZXIsIG5vdyB0
aGUgcGFnZSBpcyBnb2luZyB0byBnZXQgd3JpdHRlbiBiYWNrLAorCQkJICogd2hpY2ggbWVldHMg
dGhlIG9yaWdpbmFsIGludGVudGlvbiBvZiBzZXR0aW5nIGl0CisJCQkgKiBkaXJ0eSwgc28gYWxs
IGlzIHdlbGw6IGNsZWFyX3BhZ2VfZGlydHlfZm9yX2lvKCkgZ29lcworCQkJICogb24gdG8gY2Fs
bCBUZXN0Q2xlYXJQYWdlRGlydHkoKSwgYW5kIHdyaXRlIHRoZSBwYWdlCisJCQkgKiBiYWNrLgor
CQkJICoKKwkJCSAqIDIpIFRoaXMgY29kZSBzZWVzIHRoZSBwYWdlIGFzIGNsZWFuLCBzbyBpdCBj
YWxscworCQkJICogc2V0X3BhZ2VfZGlydHkoKS4gVGhlIHBhZ2Ugc3RheXMgZGlydHksIGRlc3Bp
dGUgYmVpbmcKKwkJCSAqIHdyaXR0ZW4gYmFjaywgc28gaXQgZ2V0cyB3cml0dGVuIGJhY2sgYWdh
aW4gaW4gdGhlCisJCQkgKiBuZXh0IHdyaXRlYmFjayBjeWNsZS4gVGhpcyBpcyBoYXJtbGVzcy4K
KwkJCSAqLworCQkJaWYgKCFQYWdlRGlydHkocGFnZSkpCisJCQkJc2V0X3BhZ2VfZGlydHkocGFn
ZSk7CisJCQlicmVhazsKKworCQljYXNlIFBVUF9GTEFHU19MT0NLOgorCQkJVk1fV0FSTl9PTl9P
TkNFKGZsYWdzID09IFBVUF9GTEFHU19MT0NLKTsKKwkJCS8qCisJCQkgKiBTaG91bGRuJ3QgaGFw
cGVuLCBidXQgdHJlYXQgaXQgYXMgX0RJUlRZX0xPQ0sgaWYKKwkJCSAqIGl0IGRvZXM6IGZhbGwg
dGhyb3VnaC4KKwkJCSAqLworCisJCWNhc2UgUFVQX0ZMQUdTX0RJUlRZX0xPQ0s6CisJCQkvKiBT
YW1lIGNvbW1lbnRzIGFzIGZvciBQVVBfRkxBR1NfRElSVFkgYXBwbHkgaGVyZS4gKi8KKwkJCWlm
ICghUGFnZURpcnR5KHBhZ2UpKQorCQkJCXNldF9wYWdlX2RpcnR5X2xvY2socGFnZSk7CisJCQli
cmVhazsKKwkJfTsKKwkJcHV0X3VzZXJfcGFnZShwYWdlKTsKKwl9CiB9Ci1FWFBPUlRfU1lNQk9M
KHB1dF91c2VyX3BhZ2VzX2RpcnR5X2xvY2spOworRVhQT1JUX1NZTUJPTChfX3B1dF91c2VyX3Bh
Z2VzKTsKIAogLyoqCiAgKiBwdXRfdXNlcl9wYWdlcygpIC0gcmVsZWFzZSBhbiBhcnJheSBvZiBn
dXAtcGlubmVkIHBhZ2VzLgotLSAKMi4yMi4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0
cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9s
aXN0aW5mby9kcmktZGV2ZWw=
