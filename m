Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id AA3321E47F
	for <lists+dri-devel@lfdr.de>; Wed, 15 May 2019 00:18:42 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id BC22389338;
	Tue, 14 May 2019 22:18:39 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-yb1-xb4a.google.com (mail-yb1-xb4a.google.com
 [IPv6:2607:f8b0:4864:20::b4a])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 96E1689338
 for <dri-devel@lists.freedesktop.org>; Tue, 14 May 2019 22:18:38 +0000 (UTC)
Received: by mail-yb1-xb4a.google.com with SMTP id x194so516325ybg.12
 for <dri-devel@lists.freedesktop.org>; Tue, 14 May 2019 15:18:38 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:date:in-reply-to:message-id:mime-version
 :references:subject:from:to:cc;
 bh=cYVYiRlOTl+HHTHC4VnotSZcOxpzrVA2zwYQx1TkL4M=;
 b=p2lLoLkA0YoQus6+prLk5QC+ntZuUb+wLftVHwCe1jwvBL9OaCO6vkTy8E7y1l+V6x
 EBfSS2PWs3Kcxl5vI6cAWv0YPdufLMlqK2B4VYwt/tfvGbHUFbnMx7+lSjwz7MEFh5JO
 Cz9+ACfG/+LwpD/q6n/KvA3rjFCxMPp6pQFSnm5MvfTcFrHDpb0ESSbL/cYt+MA4XsJQ
 pPIVzrneGrR2B6rEFq1AwG1OG8KAC+7pGyWqIIhW+luqqfrME1uiBkFvdxfgJei3jOi7
 mO6JnGm9N5aO4D5Y95MTL7Yfhio9JDrSQ3SbtzbbwDyYH4SW/77wToVZQs4W1ZxlBQa9
 n8Rw==
X-Gm-Message-State: APjAAAXb5TwsEaGgtvyk7v0X51hO8T5WX7N81C/QSB+L9iS6GZF5aNJO
 mjmqq0y0QbgsMdVChnN/P3fu32WXpc1HO4ATaSJ47Q==
X-Google-Smtp-Source: APXvYqzQ6dKuzahWylpitsM/95C+uvJi8W1WIQ4jGgq8U1/lvr0pPL58kmPdhaSXWdlNzcnwppp1Yj1xdH/Iqu8xgB3+Kw==
X-Received: by 2002:a81:5e0a:: with SMTP id s10mr19670374ywb.451.1557872317694; 
 Tue, 14 May 2019 15:18:37 -0700 (PDT)
Date: Tue, 14 May 2019 15:16:57 -0700
In-Reply-To: <20190514221711.248228-1-brendanhiggins@google.com>
Message-Id: <20190514221711.248228-5-brendanhiggins@google.com>
Mime-Version: 1.0
References: <20190514221711.248228-1-brendanhiggins@google.com>
X-Mailer: git-send-email 2.21.0.1020.gf2820cf01a-goog
Subject: [PATCH v4 04/18] kunit: test: add kunit_stream a std::stream like
 logger
From: Brendan Higgins <brendanhiggins@google.com>
To: frowand.list@gmail.com, gregkh@linuxfoundation.org, jpoimboe@redhat.com, 
 keescook@google.com, kieran.bingham@ideasonboard.com, mcgrof@kernel.org, 
 peterz@infradead.org, robh@kernel.org, sboyd@kernel.org, shuah@kernel.org, 
 tytso@mit.edu, yamada.masahiro@socionext.com
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=google.com; s=20161025;
 h=date:in-reply-to:message-id:mime-version:references:subject:from:to
 :cc;
 bh=cYVYiRlOTl+HHTHC4VnotSZcOxpzrVA2zwYQx1TkL4M=;
 b=dXBGU2hHcMiE4u+kb9J0rgbPRA4L+RwX45cYa7yjiJOCgqCswGeD1mKQmYJ6ivvUvL
 hz+pb6xz9vh3w43kb631cryEdSDHtIZVieHMMWphtl1A6rDk8I9nIBvYIT4ONVxPPTWS
 Rc44UOaIBM5/C2FXGtCr4x9wMlYwh+Lct8Lz2+R11hye7FDumEMyWFoGxyB6nxrP2S7P
 vw0ZSsMWkKNfPWQzwt+B1Vg+TV5xVPk6HFRUpomF6jcG65/n1SHgvaVqR5WhZ053WvLp
 ZPPCKOL/5LkzTvBnDk8o1F4CaDNZAyYrHp24c2sNqUDJUfyGmAqSLFIE+nPjO/grh5xe
 nj7A==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: pmladek@suse.com, linux-doc@vger.kernel.org, amir73il@gmail.com,
 Brendan Higgins <brendanhiggins@google.com>, dri-devel@lists.freedesktop.org,
 Alexander.Levin@microsoft.com, linux-kselftest@vger.kernel.org,
 linux-nvdimm@lists.01.org, khilman@baylibre.com, knut.omang@oracle.com,
 wfg@linux.intel.com, joel@jms.id.au, rientjes@google.com, jdike@addtoit.com,
 dan.carpenter@oracle.com, devicetree@vger.kernel.org,
 linux-kbuild@vger.kernel.org, Tim.Bird@sony.com, linux-um@lists.infradead.org,
 rostedt@goodmis.org, julia.lawall@lip6.fr, kunit-dev@googlegroups.com,
 richard@nod.at, rdunlap@infradead.org, linux-kernel@vger.kernel.org,
 mpe@ellerman.id.au, linux-fsdevel@vger.kernel.org, logang@deltatee.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QSBsb3Qgb2YgdGhlIGV4cGVjdGF0aW9uIGFuZCBhc3NlcnRpb24gaW5mcmFzdHJ1Y3R1cmUgcHJp
bnRzIG91dCBmYWlybHkKY29tcGxpY2F0ZWQgdGVzdCBmYWlsdXJlIG1lc3NhZ2VzLCBzbyBhZGQg
YSBDKysgc3R5bGUgbG9nIGxpYnJhcnkgZm9yCmZvciBsb2dnaW5nIHRlc3QgcmVzdWx0cy4KClNp
Z25lZC1vZmYtYnk6IEJyZW5kYW4gSGlnZ2lucyA8YnJlbmRhbmhpZ2dpbnNAZ29vZ2xlLmNvbT4K
UmV2aWV3ZWQtYnk6IEdyZWcgS3JvYWgtSGFydG1hbiA8Z3JlZ2toQGxpbnV4Zm91bmRhdGlvbi5v
cmc+ClJldmlld2VkLWJ5OiBMb2dhbiBHdW50aG9ycGUgPGxvZ2FuZ0BkZWx0YXRlZS5jb20+Ci0t
LQogaW5jbHVkZS9rdW5pdC9rdW5pdC1zdHJlYW0uaCB8ICA4NSArKysrKysrKysrKysrKysrKysr
KwogaW5jbHVkZS9rdW5pdC90ZXN0LmggICAgICAgICB8ICAgMyArCiBrdW5pdC9NYWtlZmlsZSAg
ICAgICAgICAgICAgIHwgICAzICstCiBrdW5pdC9rdW5pdC1zdHJlYW0uYyAgICAgICAgIHwgMTUy
ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiBrdW5pdC90ZXN0LmMgICAgICAg
ICAgICAgICAgIHwgICA3ICsrCiA1IGZpbGVzIGNoYW5nZWQsIDI0OSBpbnNlcnRpb25zKCspLCAx
IGRlbGV0aW9uKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgaW5jbHVkZS9rdW5pdC9rdW5pdC1zdHJl
YW0uaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGt1bml0L2t1bml0LXN0cmVhbS5jCgpkaWZmIC0tZ2l0
IGEvaW5jbHVkZS9rdW5pdC9rdW5pdC1zdHJlYW0uaCBiL2luY2x1ZGUva3VuaXQva3VuaXQtc3Ry
ZWFtLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwMC4uZDQ1N2E1NGZl
MDEwMAotLS0gL2Rldi9udWxsCisrKyBiL2luY2x1ZGUva3VuaXQva3VuaXQtc3RyZWFtLmgKQEAg
LTAsMCArMSw4NSBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAgKi8KKy8q
CisgKiBDKysgc3RyZWFtIHN0eWxlIHN0cmluZyBmb3JtYXR0ZXIgYW5kIHByaW50ZXIgdXNlZCBp
biBLVW5pdCBmb3Igb3V0cHV0dGluZworICogS1VuaXQgbWVzc2FnZXMuCisgKgorICogQ29weXJp
Z2h0IChDKSAyMDE5LCBHb29nbGUgTExDLgorICogQXV0aG9yOiBCcmVuZGFuIEhpZ2dpbnMgPGJy
ZW5kYW5oaWdnaW5zQGdvb2dsZS5jb20+CisgKi8KKworI2lmbmRlZiBfS1VOSVRfS1VOSVRfU1RS
RUFNX0gKKyNkZWZpbmUgX0tVTklUX0tVTklUX1NUUkVBTV9ICisKKyNpbmNsdWRlIDxsaW51eC90
eXBlcy5oPgorI2luY2x1ZGUgPGt1bml0L3N0cmluZy1zdHJlYW0uaD4KKworc3RydWN0IGt1bml0
OworCisvKioKKyAqIHN0cnVjdCBrdW5pdF9zdHJlYW0gLSBhIHN0ZDo6c3RyZWFtIHN0eWxlIHN0
cmluZyBidWlsZGVyLgorICoKKyAqIEEgc3RkOjpzdHJlYW0gc3R5bGUgc3RyaW5nIGJ1aWxkZXIu
IEFsbG93cyBtZXNzYWdlcyB0byBiZSBidWlsdCB1cCBhbmQKKyAqIHByaW50ZWQgYWxsIGF0IG9u
Y2UuCisgKi8KK3N0cnVjdCBrdW5pdF9zdHJlYW0geworCS8qIHByaXZhdGU6IGludGVybmFsIHVz
ZSBvbmx5LiAqLworCXN0cnVjdCBrdW5pdCAqdGVzdDsKKwlzcGlubG9ja190IGxvY2s7IC8qIEd1
YXJkcyBsZXZlbC4gKi8KKwljb25zdCBjaGFyICpsZXZlbDsKKwlzdHJ1Y3Qgc3RyaW5nX3N0cmVh
bSAqaW50ZXJuYWxfc3RyZWFtOworfTsKKworLyoqCisgKiBrdW5pdF9uZXdfc3RyZWFtKCkgLSBj
b25zdHJ1Y3RzIGEgbmV3ICZzdHJ1Y3Qga3VuaXRfc3RyZWFtLgorICogQHRlc3Q6IFRoZSB0ZXN0
IGNvbnRleHQgb2JqZWN0LgorICoKKyAqIENvbnN0cnVjdHMgYSBuZXcgdGVzdCBtYW5hZ2VkICZz
dHJ1Y3Qga3VuaXRfc3RyZWFtLgorICovCitzdHJ1Y3Qga3VuaXRfc3RyZWFtICprdW5pdF9uZXdf
c3RyZWFtKHN0cnVjdCBrdW5pdCAqdGVzdCk7CisKKy8qKgorICoga3VuaXRfc3RyZWFtX3NldF9s
ZXZlbCgpOiBzZXRzIHRoZSBsZXZlbCB0aGF0IHN0cmluZyBzaG91bGQgYmUgcHJpbnRlZCBhdC4K
KyAqIEB0aGlzOiB0aGUgc3RyZWFtIGJlaW5nIG9wZXJhdGVkIG9uLgorICogQGxldmVsOiB0aGUg
cHJpbnQgbGV2ZWwgdGhlIHN0cmVhbSBpcyBzZXQgdG8gb3V0cHV0IHRvLgorICoKKyAqIFNldHMg
dGhlIHByaW50IGxldmVsIGF0IHdoaWNoIHRoZSBzdHJlYW0gb3V0cHV0cy4KKyAqLwordm9pZCBr
dW5pdF9zdHJlYW1fc2V0X2xldmVsKHN0cnVjdCBrdW5pdF9zdHJlYW0gKnRoaXMsIGNvbnN0IGNo
YXIgKmxldmVsKTsKKworLyoqCisgKiBrdW5pdF9zdHJlYW1fYWRkKCk6IGFkZHMgdGhlIGZvcm1h
dHRlZCBpbnB1dCB0byB0aGUgaW50ZXJuYWwgYnVmZmVyLgorICogQHRoaXM6IHRoZSBzdHJlYW0g
YmVpbmcgb3BlcmF0ZWQgb24uCisgKiBAZm10OiBwcmludGYgc3R5bGUgZm9ybWF0IHN0cmluZyB0
byBhcHBlbmQgdG8gc3RyZWFtLgorICoKKyAqIEFwcGVuZHMgdGhlIGZvcm1hdHRlZCBzdHJpbmcs
IEBmbXQsIHRvIHRoZSBpbnRlcm5hbCBidWZmZXIuCisgKi8KK3ZvaWQgX19wcmludGYoMiwgMykg
a3VuaXRfc3RyZWFtX2FkZChzdHJ1Y3Qga3VuaXRfc3RyZWFtICp0aGlzLAorCQkJCSAgICAgY29u
c3QgY2hhciAqZm10LCAuLi4pOworCisvKioKKyAqIGt1bml0X3N0cmVhbV9hcHBlbmQoKTogYXBw
ZW5kcyB0aGUgY29udGVudHMgb2YgQG90aGVyIHRvIEB0aGlzLgorICogQHRoaXM6IHRoZSBzdHJl
YW0gdG8gd2hpY2ggQG90aGVyIGlzIGFwcGVuZGVkLgorICogQG90aGVyOiB0aGUgc3RyZWFtIHdo
b3NlIGNvbnRlbnRzIGFyZSBhcHBlbmRlZCB0byBAdGhpcy4KKyAqCisgKiBBcHBlbmRzIHRoZSBj
b250ZW50cyBvZiBAb3RoZXIgdG8gQHRoaXMuCisgKi8KK3ZvaWQga3VuaXRfc3RyZWFtX2FwcGVu
ZChzdHJ1Y3Qga3VuaXRfc3RyZWFtICp0aGlzLCBzdHJ1Y3Qga3VuaXRfc3RyZWFtICpvdGhlcik7
CisKKy8qKgorICoga3VuaXRfc3RyZWFtX2NvbW1pdCgpOiBwcmludHMgb3V0IHRoZSBpbnRlcm5h
bCBidWZmZXIgdG8gdGhlIHVzZXIuCisgKiBAdGhpczogdGhlIHN0cmVhbSBiZWluZyBvcGVyYXRl
ZCBvbi4KKyAqCisgKiBPdXRwdXRzIHRoZSBjb250ZW50cyBvZiB0aGUgaW50ZXJuYWwgYnVmZmVy
IGFzIGEga3VuaXRfcHJpbnRrIGZvcm1hdHRlZAorICogb3V0cHV0LgorICovCit2b2lkIGt1bml0
X3N0cmVhbV9jb21taXQoc3RydWN0IGt1bml0X3N0cmVhbSAqdGhpcyk7CisKKy8qKgorICoga3Vu
aXRfc3RyZWFtX2NsZWFyKCk6IGNsZWFycyB0aGUgaW50ZXJuYWwgYnVmZmVyLgorICogQHRoaXM6
IHRoZSBzdHJlYW0gYmVpbmcgb3BlcmF0ZWQgb24uCisgKgorICogQ2xlYXJzIHRoZSBjb250ZW50
cyBvZiB0aGUgaW50ZXJuYWwgYnVmZmVyLgorICovCit2b2lkIGt1bml0X3N0cmVhbV9jbGVhcihz
dHJ1Y3Qga3VuaXRfc3RyZWFtICp0aGlzKTsKKworI2VuZGlmIC8qIF9LVU5JVF9LVU5JVF9TVFJF
QU1fSCAqLwpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9rdW5pdC90ZXN0LmggYi9pbmNsdWRlL2t1bml0
L3Rlc3QuaAppbmRleCA1ZTg2ZDg4Y2Q1MzA1Li40YmM4Mzk4ODRhODNjIDEwMDY0NAotLS0gYS9p
bmNsdWRlL2t1bml0L3Rlc3QuaAorKysgYi9pbmNsdWRlL2t1bml0L3Rlc3QuaApAQCAtMTEsNiAr
MTEsNyBAQAogCiAjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KICNpbmNsdWRlIDxsaW51eC9zbGFi
Lmg+CisjaW5jbHVkZSA8a3VuaXQva3VuaXQtc3RyZWFtLmg+CiAKIHN0cnVjdCBrdW5pdF9yZXNv
dXJjZTsKIApAQCAtMTcyLDYgKzE3Myw4IEBAIHN0cnVjdCBrdW5pdCB7CiAKIHZvaWQga3VuaXRf
aW5pdF90ZXN0KHN0cnVjdCBrdW5pdCAqdGVzdCwgY29uc3QgY2hhciAqbmFtZSk7CiAKK3ZvaWQg
a3VuaXRfZmFpbChzdHJ1Y3Qga3VuaXQgKnRlc3QsIHN0cnVjdCBrdW5pdF9zdHJlYW0gKnN0cmVh
bSk7CisKIGludCBrdW5pdF9ydW5fdGVzdHMoc3RydWN0IGt1bml0X21vZHVsZSAqbW9kdWxlKTsK
IAogLyoqCmRpZmYgLS1naXQgYS9rdW5pdC9NYWtlZmlsZSBiL2t1bml0L01ha2VmaWxlCmluZGV4
IDI3NWI1NjVhMGU4MWYuLjZkZGM2MjJlZTZiMWMgMTAwNjQ0Ci0tLSBhL2t1bml0L01ha2VmaWxl
CisrKyBiL2t1bml0L01ha2VmaWxlCkBAIC0xLDIgKzEsMyBAQAogb2JqLSQoQ09ORklHX0tVTklU
KSArPQkJCXRlc3QubyBcCi0JCQkJCXN0cmluZy1zdHJlYW0ubworCQkJCQlzdHJpbmctc3RyZWFt
Lm8gXAorCQkJCQlrdW5pdC1zdHJlYW0ubwpkaWZmIC0tZ2l0IGEva3VuaXQva3VuaXQtc3RyZWFt
LmMgYi9rdW5pdC9rdW5pdC1zdHJlYW0uYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAw
MDAwMDAwMDAwLi4xODg0ZjFiNTUwODg4Ci0tLSAvZGV2L251bGwKKysrIGIva3VuaXQva3VuaXQt
c3RyZWFtLmMKQEAgLTAsMCArMSwxNTIgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBH
UEwtMi4wCisvKgorICogQysrIHN0cmVhbSBzdHlsZSBzdHJpbmcgZm9ybWF0dGVyIGFuZCBwcmlu
dGVyIHVzZWQgaW4gS1VuaXQgZm9yIG91dHB1dHRpbmcKKyAqIEtVbml0IG1lc3NhZ2VzLgorICoK
KyAqIENvcHlyaWdodCAoQykgMjAxOSwgR29vZ2xlIExMQy4KKyAqIEF1dGhvcjogQnJlbmRhbiBI
aWdnaW5zIDxicmVuZGFuaGlnZ2luc0Bnb29nbGUuY29tPgorICovCisKKyNpbmNsdWRlIDxrdW5p
dC90ZXN0Lmg+CisjaW5jbHVkZSA8a3VuaXQva3VuaXQtc3RyZWFtLmg+CisjaW5jbHVkZSA8a3Vu
aXQvc3RyaW5nLXN0cmVhbS5oPgorCitzdGF0aWMgY29uc3QgY2hhciAqa3VuaXRfc3RyZWFtX2dl
dF9sZXZlbChzdHJ1Y3Qga3VuaXRfc3RyZWFtICp0aGlzKQoreworCXVuc2lnbmVkIGxvbmcgZmxh
Z3M7CisJY29uc3QgY2hhciAqbGV2ZWw7CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmdGhpcy0+bG9j
aywgZmxhZ3MpOworCWxldmVsID0gdGhpcy0+bGV2ZWw7CisJc3Bpbl91bmxvY2tfaXJxcmVzdG9y
ZSgmdGhpcy0+bG9jaywgZmxhZ3MpOworCisJcmV0dXJuIGxldmVsOworfQorCit2b2lkIGt1bml0
X3N0cmVhbV9zZXRfbGV2ZWwoc3RydWN0IGt1bml0X3N0cmVhbSAqdGhpcywgY29uc3QgY2hhciAq
bGV2ZWwpCit7CisJdW5zaWduZWQgbG9uZyBmbGFnczsKKworCXNwaW5fbG9ja19pcnFzYXZlKCZ0
aGlzLT5sb2NrLCBmbGFncyk7CisJdGhpcy0+bGV2ZWwgPSBsZXZlbDsKKwlzcGluX3VubG9ja19p
cnFyZXN0b3JlKCZ0aGlzLT5sb2NrLCBmbGFncyk7Cit9CisKK3ZvaWQga3VuaXRfc3RyZWFtX2Fk
ZChzdHJ1Y3Qga3VuaXRfc3RyZWFtICp0aGlzLCBjb25zdCBjaGFyICpmbXQsIC4uLikKK3sKKwl2
YV9saXN0IGFyZ3M7CisJc3RydWN0IHN0cmluZ19zdHJlYW0gKnN0cmVhbSA9IHRoaXMtPmludGVy
bmFsX3N0cmVhbTsKKworCXZhX3N0YXJ0KGFyZ3MsIGZtdCk7CisKKwlpZiAoc3RyaW5nX3N0cmVh
bV92YWRkKHN0cmVhbSwgZm10LCBhcmdzKSA8IDApCisJCWt1bml0X2Vycih0aGlzLT50ZXN0LCAi
RmFpbGVkIHRvIGFsbG9jYXRlIGZyYWdtZW50OiAlc1xuIiwgZm10KTsKKworCXZhX2VuZChhcmdz
KTsKK30KKwordm9pZCBrdW5pdF9zdHJlYW1fYXBwZW5kKHN0cnVjdCBrdW5pdF9zdHJlYW0gKnRo
aXMsCisJCQkJc3RydWN0IGt1bml0X3N0cmVhbSAqb3RoZXIpCit7CisJc3RydWN0IHN0cmluZ19z
dHJlYW0gKm90aGVyX3N0cmVhbSA9IG90aGVyLT5pbnRlcm5hbF9zdHJlYW07CisJY29uc3QgY2hh
ciAqb3RoZXJfY29udGVudDsKKworCW90aGVyX2NvbnRlbnQgPSBzdHJpbmdfc3RyZWFtX2dldF9z
dHJpbmcob3RoZXJfc3RyZWFtKTsKKworCWlmICghb3RoZXJfY29udGVudCkgeworCQlrdW5pdF9l
cnIodGhpcy0+dGVzdCwKKwkJCSAgIkZhaWxlZCB0byBnZXQgc3RyaW5nIGZyb20gc2Vjb25kIGFy
Z3VtZW50IGZvciBhcHBlbmRpbmcuXG4iKTsKKwkJcmV0dXJuOworCX0KKworCWt1bml0X3N0cmVh
bV9hZGQodGhpcywgb3RoZXJfY29udGVudCk7Cit9CisKK3ZvaWQga3VuaXRfc3RyZWFtX2NsZWFy
KHN0cnVjdCBrdW5pdF9zdHJlYW0gKnRoaXMpCit7CisJc3RyaW5nX3N0cmVhbV9jbGVhcih0aGlz
LT5pbnRlcm5hbF9zdHJlYW0pOworfQorCit2b2lkIGt1bml0X3N0cmVhbV9jb21taXQoc3RydWN0
IGt1bml0X3N0cmVhbSAqdGhpcykKK3sKKwlzdHJ1Y3Qgc3RyaW5nX3N0cmVhbSAqc3RyZWFtID0g
dGhpcy0+aW50ZXJuYWxfc3RyZWFtOworCXN0cnVjdCBzdHJpbmdfc3RyZWFtX2ZyYWdtZW50ICpm
cmFnbWVudDsKKwljb25zdCBjaGFyICpsZXZlbDsKKwljaGFyICpidWY7CisKKwlsZXZlbCA9IGt1
bml0X3N0cmVhbV9nZXRfbGV2ZWwodGhpcyk7CisJaWYgKCFsZXZlbCkgeworCQlrdW5pdF9lcnIo
dGhpcy0+dGVzdCwKKwkJCSAgIlN0cmVhbSB3YXMgY29tbWl0dGVkIHdpdGhvdXQgYSBzcGVjaWZp
ZWQgbG9nIGxldmVsLlxuIik7CisJCWxldmVsID0gS0VSTl9FUlI7CisJCWt1bml0X3N0cmVhbV9z
ZXRfbGV2ZWwodGhpcywgbGV2ZWwpOworCX0KKworCWJ1ZiA9IHN0cmluZ19zdHJlYW1fZ2V0X3N0
cmluZyhzdHJlYW0pOworCWlmICghYnVmKSB7CisJCWt1bml0X2Vycih0aGlzLT50ZXN0LAorCQkJ
ICJDb3VsZCBub3QgYWxsb2NhdGUgYnVmZmVyLCBkdW1waW5nIHN0cmVhbTpcbiIpOworCQlsaXN0
X2Zvcl9lYWNoX2VudHJ5KGZyYWdtZW50LCAmc3RyZWFtLT5mcmFnbWVudHMsIG5vZGUpIHsKKwkJ
CWt1bml0X2Vycih0aGlzLT50ZXN0LCBmcmFnbWVudC0+ZnJhZ21lbnQpOworCQl9CisJCWt1bml0
X2Vycih0aGlzLT50ZXN0LCAiXG4iKTsKKwkJZ290byBjbGVhbnVwOworCX0KKworCWt1bml0X3By
aW50ayhsZXZlbCwgdGhpcy0+dGVzdCwgYnVmKTsKKwlrZnJlZShidWYpOworCitjbGVhbnVwOgor
CWt1bml0X3N0cmVhbV9jbGVhcih0aGlzKTsKK30KKworc3RhdGljIGludCBrdW5pdF9zdHJlYW1f
aW5pdChzdHJ1Y3Qga3VuaXRfcmVzb3VyY2UgKnJlcywgdm9pZCAqY29udGV4dCkKK3sKKwlzdHJ1
Y3Qga3VuaXQgKnRlc3QgPSBjb250ZXh0OworCXN0cnVjdCBrdW5pdF9zdHJlYW0gKnN0cmVhbTsK
KworCXN0cmVhbSA9IGt6YWxsb2Moc2l6ZW9mKCpzdHJlYW0pLCBHRlBfS0VSTkVMKTsKKwlpZiAo
IXN0cmVhbSkKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlyZXMtPmFsbG9jYXRpb24gPSBzdHJlYW07
CisJc3RyZWFtLT50ZXN0ID0gdGVzdDsKKwlzcGluX2xvY2tfaW5pdCgmc3RyZWFtLT5sb2NrKTsK
KwlzdHJlYW0tPmludGVybmFsX3N0cmVhbSA9IG5ld19zdHJpbmdfc3RyZWFtKCk7CisKKwlpZiAo
IXN0cmVhbS0+aW50ZXJuYWxfc3RyZWFtKSB7CisJCWtmcmVlKHN0cmVhbSk7CisJCXJldHVybiAt
RU5PTUVNOworCX0KKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBrdW5pdF9zdHJlYW1f
ZnJlZShzdHJ1Y3Qga3VuaXRfcmVzb3VyY2UgKnJlcykKK3sKKwlzdHJ1Y3Qga3VuaXRfc3RyZWFt
ICpzdHJlYW0gPSByZXMtPmFsbG9jYXRpb247CisKKwlpZiAoIXN0cmluZ19zdHJlYW1faXNfZW1w
dHkoc3RyZWFtLT5pbnRlcm5hbF9zdHJlYW0pKSB7CisJCWt1bml0X2VycihzdHJlYW0tPnRlc3Qs
CisJCQkgIkVuZCBvZiB0ZXN0IGNhc2UgcmVhY2hlZCB3aXRoIHVuY29tbWl0dGVkIHN0cmVhbSBl
bnRyaWVzLlxuIik7CisJCWt1bml0X3N0cmVhbV9jb21taXQoc3RyZWFtKTsKKwl9CisKKwlkZXN0
cm95X3N0cmluZ19zdHJlYW0oc3RyZWFtLT5pbnRlcm5hbF9zdHJlYW0pOworCWtmcmVlKHN0cmVh
bSk7Cit9CisKK3N0cnVjdCBrdW5pdF9zdHJlYW0gKmt1bml0X25ld19zdHJlYW0oc3RydWN0IGt1
bml0ICp0ZXN0KQoreworCXN0cnVjdCBrdW5pdF9yZXNvdXJjZSAqcmVzOworCisJcmVzID0ga3Vu
aXRfYWxsb2NfcmVzb3VyY2UodGVzdCwKKwkJCQkgICBrdW5pdF9zdHJlYW1faW5pdCwKKwkJCQkg
ICBrdW5pdF9zdHJlYW1fZnJlZSwKKwkJCQkgICB0ZXN0KTsKKworCWlmIChyZXMpCisJCXJldHVy
biByZXMtPmFsbG9jYXRpb247CisJZWxzZQorCQlyZXR1cm4gTlVMTDsKK30KZGlmZiAtLWdpdCBh
L2t1bml0L3Rlc3QuYyBiL2t1bml0L3Rlc3QuYwppbmRleCBhMTVlNmY4YzQxNTgyLi4wYmI2ZjUz
YTdmODdlIDEwMDY0NAotLS0gYS9rdW5pdC90ZXN0LmMKKysrIGIva3VuaXQvdGVzdC5jCkBAIC0x
MzgsNiArMTM4LDEzIEBAIHN0YXRpYyB2b2lkIGt1bml0X3ByaW50X3Rlc3RfY2FzZV9va19ub3Rf
b2soc3RydWN0IGt1bml0X2Nhc2UgKnRlc3RfY2FzZSwKIAkJCSAgICAgIHRlc3RfY2FzZS0+bmFt
ZSk7CiB9CiAKK3ZvaWQga3VuaXRfZmFpbChzdHJ1Y3Qga3VuaXQgKnRlc3QsIHN0cnVjdCBrdW5p
dF9zdHJlYW0gKnN0cmVhbSkKK3sKKwlrdW5pdF9zZXRfc3VjY2Vzcyh0ZXN0LCBmYWxzZSk7CisJ
a3VuaXRfc3RyZWFtX3NldF9sZXZlbChzdHJlYW0sIEtFUk5fRVJSKTsKKwlrdW5pdF9zdHJlYW1f
Y29tbWl0KHN0cmVhbSk7Cit9CisKIHZvaWQga3VuaXRfaW5pdF90ZXN0KHN0cnVjdCBrdW5pdCAq
dGVzdCwgY29uc3QgY2hhciAqbmFtZSkKIHsKIAlzcGluX2xvY2tfaW5pdCgmdGVzdC0+bG9jayk7
Ci0tIAoyLjIxLjAuMTAyMC5nZjI4MjBjZjAxYS1nb29nCgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZl
bEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFp
bG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
