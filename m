Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id DBEAD2B8D65
	for <lists+dri-devel@lfdr.de>; Thu, 19 Nov 2020 09:32:53 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 16A666E546;
	Thu, 19 Nov 2020 08:32:37 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from new1-smtp.messagingengine.com (new1-smtp.messagingengine.com
 [66.111.4.221])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3EC3489C86
 for <dri-devel@lists.freedesktop.org>; Wed, 18 Nov 2020 09:48:07 +0000 (UTC)
Received: from compute6.internal (compute6.nyi.internal [10.202.2.46])
 by mailnew.nyi.internal (Postfix) with ESMTP id 8086A580372;
 Wed, 18 Nov 2020 04:48:06 -0500 (EST)
Received: from mailfrontend1 ([10.202.2.162])
 by compute6.internal (MEProxy); Wed, 18 Nov 2020 04:48:06 -0500
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=cerno.tech; h=
 from:to:cc:subject:date:message-id:mime-version:content-type
 :content-transfer-encoding; s=fm1; bh=VFZlecY16rkKw84e1eHQr5Cx+E
 nLmGskZRvAVD3oImg=; b=hdQKunvm/+j5qz4XGFHgXcx2Rwwe3a3LDj3W6c8bmW
 AbRSnYfciOxnP+qRax73ekZOYFJCeD02Za/VIbVSfYtY/3GXEYvs9kb0qvs+wGql
 wWGSLKh6pjwG6lPoWpnWP+KsF4IV/+yOb0EPSeUfnf5VPj466Q9mNPWHQuA+Tqs4
 qjMRMzJZFQ/lBc0riIIOwHyB7fkpquwlJTd/3jflqe9Mfqb8bYQY2iJkMPG0Vy+T
 7en/zgzmRgeKHSsUCfO9D4Fcw+cLeAJ55KZtsHPl5U7wAqGFhraU9VTfSQ/1aDy5
 VOQ9UQ2lBnU1AqL92Df5k3Xr6anmf9XhctsX9J9GrjMw==
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=
 messagingengine.com; h=cc:content-transfer-encoding:content-type
 :date:from:message-id:mime-version:subject:to:x-me-proxy
 :x-me-proxy:x-me-sender:x-me-sender:x-sasl-enc; s=fm1; bh=VFZlec
 Y16rkKw84e1eHQr5Cx+EnLmGskZRvAVD3oImg=; b=GL76iQxleS7frXt9UyIgYQ
 gaXlZ8gxxHWHH3Twpqhx8ksvZbZyD/CfYKkIJxWYjqO1RdjXFv+bAulex+cqlN4+
 24Tw8hdxKz3B7j4VZIySgMAnBFSkKaKXNOcZ7t9DKf0HOP0Xsc67IZHq3gMu/PIM
 jObdjBwcgaPTJw0k1iirkqRBrrui5+jrqwX2O8wvLFIhhtls0MAwdpY3mFpK2zjA
 eSr5vyoWntAXfcsdY1QRTzUSDs7PAZ1IMUqotO4/0jWLu405Yiz5j7j9ueJgJKFH
 E+swZp5ljOC6/pKj5tKMOVjVGHpy3Pu2RTwSuqXpp1shbCkOGywiNQRDhl1nVKPg
 ==
X-ME-Sender: <xms:1O20X3tGwpjR29msKrmTikatldfKO5OLyOLnEeETZaLWdC_EcrB3TA>
 <xme:1O20X4egZIEblUsKC2FNvDE6fPBxHn06HyVZT-zHJcbzJipUuazqnznd_vF8Ysmyc
 3uU_vLwj0zM4z-Eub0>
X-ME-Proxy-Cause: gggruggvucftvghtrhhoucdtuddrgedujedrudefhedgtdelucetufdoteggodetrfdotf
 fvucfrrhhofhhilhgvmecuhfgrshhtofgrihhlpdfqfgfvpdfurfetoffkrfgpnffqhgen
 uceurghilhhouhhtmecufedttdenucesvcftvggtihhpihgvnhhtshculddquddttddmne
 cujfgurhephffvufffkffogggtgfesthekredtredtjeenucfhrhhomhepofgrgihimhgv
 ucftihhprghrugcuoehmrgigihhmvgestggvrhhnohdrthgvtghhqeenucggtffrrghtth
 gvrhhnpeehvdfgueejgfefhfelfeejtdetuddvffdttefggfeftdfgffekleefjedvgeei
 hfenucfkphepledtrdekledrieekrdejieenucevlhhushhtvghrufhiiigvpedtnecurf
 grrhgrmhepmhgrihhlfhhrohhmpehmrgigihhmvgestggvrhhnohdrthgvtghh
X-ME-Proxy: <xmx:1O20X6z75YWwOZY3IQIa-tqy--E1DMRhp8Er_EGqzJliyvNIbRr7rg>
 <xmx:1O20X2McfBLFgqw3Fy39vC_-fYEvgXZV5w39Bb3LYov7MMheKL0pvg>
 <xmx:1O20X3_M4KG-z7iUSGgO0wuTqEFkgarFvDgLcpM3zDqqFnq8Ay6Ynw>
 <xmx:1u20X7U7Pgzqo3P7LRO6DG-EFsqyXA_adR2xYA90Izv9-GNn20pMUQ>
Received: from localhost (lfbn-tou-1-1502-76.w90-89.abo.wanadoo.fr
 [90.89.68.76])
 by mail.messagingengine.com (Postfix) with ESMTPA id 8CCCD3280065;
 Wed, 18 Nov 2020 04:48:04 -0500 (EST)
From: Maxime Ripard <maxime@cerno.tech>
To: Daniel Vetter <daniel.vetter@intel.com>, David Airlie <airlied@linux.ie>,
 Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
 Thomas Zimmermann <tzimmermann@suse.de>, Maxime Ripard <maxime@cerno.tech>
Subject: [PATCH v2] drm: Pass the full state to connectors atomic functions
Date: Wed, 18 Nov 2020 10:47:58 +0100
Message-Id: <20201118094758.506730-1-maxime@cerno.tech>
X-Mailer: git-send-email 2.28.0
MIME-Version: 1.0
X-Mailman-Approved-At: Thu, 19 Nov 2020 08:31:38 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Haneen Mohammed <hamohammed.sa@gmail.com>,
 Rodrigo Siqueira <rodrigosiqueiramelo@gmail.com>, Leo Li <sunpeng.li@amd.com>,
 Melissa Wen <melissa.srw@gmail.com>, dri-devel@lists.freedesktop.org,
 Rodrigo Vivi <rodrigo.vivi@intel.com>,
 Alex Deucher <alexander.deucher@amd.com>,
 =?UTF-8?q?Christian=20K=C3=B6nig?= <christian.koenig@amd.com>,
 Ben Skeggs <bskeggs@redhat.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIGN1cnJlbnQgYXRvbWljIGhlbHBlcnMgaGF2ZSBlaXRoZXIgdGhlaXIgb2JqZWN0IHN0YXRl
IGJlaW5nIHBhc3NlZCBhcwphbiBhcmd1bWVudCBvciB0aGUgZnVsbCBhdG9taWMgc3RhdGUuCgpU
aGUgZm9ybWVyIGlzIHRoZSBwYXR0ZXJuIHRoYXQgd2FzIGRvbmUgYXQgZmlyc3QsIGJlZm9yZSBz
d2l0Y2hpbmcgdG8gdGhlCmxhdHRlciBmb3IgbmV3IGhvb2tzIG9yIHdoZW4gaXQgd2FzIG5lZWRl
ZC4KCk5vdyB0aGF0IHRoZSBDUlRDcyBoYXZlIGJlZW4gY29udmVydGVkLCBsZXQncyBtb3ZlIGZv
cndhcmQgd2l0aCB0aGUKY29ubmVjdG9ycyB0byBwcm92aWRlIGEgY29uc2lzdGVudCBpbnRlcmZh
Y2UuCgpUaGUgY29udmVyc2lvbiB3YXMgZG9uZSB1c2luZyB0aGUgY29jY2luZWxsZSBzY3JpcHQg
YmVsb3csIGFuZCBidWlsdCB0ZXN0ZWQKb24gYWxsIHRoZSBkcml2ZXJzLgoKQEAKaWRlbnRpZmll
ciBjb25uZWN0b3IsIGNvbm5lY3Rvcl9zdGF0ZTsKQEAKCiBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9o
ZWxwZXJfZnVuY3MgewoJLi4uCglzdHJ1Y3QgZHJtX2VuY29kZXIqICgqYXRvbWljX2Jlc3RfZW5j
b2Rlcikoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKLQkJCQkJCSAgIHN0cnVjdCBk
cm1fY29ubmVjdG9yX3N0YXRlICpjb25uZWN0b3Jfc3RhdGUpOworCQkJCQkJICAgc3RydWN0IGRy
bV9hdG9taWNfc3RhdGUgKnN0YXRlKTsKCS4uLgp9CgpAQAppZGVudGlmaWVyIGNvbm5lY3Rvciwg
Y29ubmVjdG9yX3N0YXRlOwpAQAoKIHN0cnVjdCBkcm1fY29ubmVjdG9yX2hlbHBlcl9mdW5jcyB7
CgkuLi4KCXZvaWQgKCphdG9taWNfY29tbWl0KShzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVj
dG9yLAotCQkJICAgICAgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5lY3Rvcl9zdGF0
ZSk7CisJCQkgICAgICBzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpOwoJLi4uCn0KCkBA
CnN0cnVjdCBkcm1fY29ubmVjdG9yX2hlbHBlcl9mdW5jcyAqRlVOQ1M7CmlkZW50aWZpZXIgc3Rh
dGU7CmlkZW50aWZpZXIgY29ubmVjdG9yLCBjb25uZWN0b3Jfc3RhdGU7CmlkZW50aWZpZXIgZjsK
QEAKCiBmKC4uLiwgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlLCAuLi4pCiB7Cgk8Ky4u
LgotCUZVTkNTLT5hdG9taWNfY29tbWl0KGNvbm5lY3RvciwgY29ubmVjdG9yX3N0YXRlKTsKKwlG
VU5DUy0+YXRvbWljX2NvbW1pdChjb25uZWN0b3IsIHN0YXRlKTsKCS4uLis+CiB9CgpAQApzdHJ1
Y3QgZHJtX2Nvbm5lY3Rvcl9oZWxwZXJfZnVuY3MgKkZVTkNTOwppZGVudGlmaWVyIHN0YXRlOwpp
ZGVudGlmaWVyIGNvbm5lY3RvciwgY29ubmVjdG9yX3N0YXRlOwppZGVudGlmaWVyIHZhciwgZjsK
QEAKCiBmKHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSwgLi4uKQogewoJPCsuLi4KLQl2
YXIgPSBGVU5DUy0+YXRvbWljX2Jlc3RfZW5jb2Rlcihjb25uZWN0b3IsIGNvbm5lY3Rvcl9zdGF0
ZSk7CisJdmFyID0gRlVOQ1MtPmF0b21pY19iZXN0X2VuY29kZXIoY29ubmVjdG9yLCBzdGF0ZSk7
CgkuLi4rPgogfQoKQCBjb25uZWN0b3JfYXRvbWljX2Z1bmMgQAppZGVudGlmaWVyIGhlbHBlcnM7
CmlkZW50aWZpZXIgZnVuYzsKQEAKCigKc3RhdGljIHN0cnVjdCBkcm1fY29ubmVjdG9yX2hlbHBl
cl9mdW5jcyBoZWxwZXJzID0gewoJLi4uLAoJLmF0b21pY19iZXN0X2VuY29kZXIgPSBmdW5jLAoJ
Li4uLAp9Owp8CnN0YXRpYyBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9oZWxwZXJfZnVuY3MgaGVscGVy
cyA9IHsKCS4uLiwKCS5hdG9taWNfY29tbWl0ID0gZnVuYywKCS4uLiwKfTsKKQoKQEAKaWRlbnRp
ZmllciBjb25uZWN0b3JfYXRvbWljX2Z1bmMuZnVuYzsKaWRlbnRpZmllciBjb25uZWN0b3I7CnN5
bWJvbCBzdGF0ZTsKQEAKCiBmdW5jKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCi0g
ICAgICBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqc3RhdGUKKyAgICAgIHN0cnVjdCBkcm1f
Y29ubmVjdG9yX3N0YXRlICpjb25uZWN0b3Jfc3RhdGUKICAgICAgKQogewoJLi4uCi0Jc3RhdGUK
Kwljb25uZWN0b3Jfc3RhdGUKIAkuLi4KIH0KCkAgaWdub3Jlc19zdGF0ZSBACmlkZW50aWZpZXIg
Y29ubmVjdG9yX2F0b21pY19mdW5jLmZ1bmM7CmlkZW50aWZpZXIgY29ubmVjdG9yLCBjb25uZWN0
b3Jfc3RhdGU7CkBACgogZnVuYyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAogICAg
ICBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubmVjdG9yX3N0YXRlKQp7CgkuLi4gd2hl
biAhPSBjb25uZWN0b3Jfc3RhdGUKfQoKQCBhZGRzX3N0YXRlIGRlcGVuZHMgb24gY29ubmVjdG9y
X2F0b21pY19mdW5jICYmICFpZ25vcmVzX3N0YXRlIEAKaWRlbnRpZmllciBjb25uZWN0b3JfYXRv
bWljX2Z1bmMuZnVuYzsKaWRlbnRpZmllciBjb25uZWN0b3IsIGNvbm5lY3Rvcl9zdGF0ZTsKQEAK
CiBmdW5jKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsIHN0cnVjdCBkcm1fY29ubmVj
dG9yX3N0YXRlICpjb25uZWN0b3Jfc3RhdGUpCiB7CisJc3RydWN0IGRybV9jb25uZWN0b3Jfc3Rh
dGUgKmNvbm5lY3Rvcl9zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X25ld19jb25uZWN0b3Jfc3RhdGUo
c3RhdGUsIGNvbm5lY3Rvcik7CgkuLi4KIH0KCkAgZGVwZW5kcyBvbiBjb25uZWN0b3JfYXRvbWlj
X2Z1bmMgQAppZGVudGlmaWVyIGNvbm5lY3Rvcl9hdG9taWNfZnVuYy5mdW5jOwppZGVudGlmaWVy
IGNvbm5lY3Rvcl9zdGF0ZTsKaWRlbnRpZmllciBjb25uZWN0b3I7CkBACgogZnVuYyhzdHJ1Y3Qg
ZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAotICAgICBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0
ZSAqY29ubmVjdG9yX3N0YXRlCisgICAgIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZQoJ
ICAgKQogeyAuLi4gfQoKQCBpbmNsdWRlIGRlcGVuZHMgb24gYWRkc19zdGF0ZSBACkBACgogI2lu
Y2x1ZGUgPGRybS9kcm1fYXRvbWljLmg+CgpAIG5vX2luY2x1ZGUgZGVwZW5kcyBvbiAhaW5jbHVk
ZSAmJiBhZGRzX3N0YXRlIEAKQEAKCisgI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljLmg+CiAgI2lu
Y2x1ZGUgPGRybS8uLi4+CgpDYzogTGVvIExpIDxzdW5wZW5nLmxpQGFtZC5jb20+CkNjOiBBbGV4
IERldWNoZXIgPGFsZXhhbmRlci5kZXVjaGVyQGFtZC5jb20+CkNjOiAiQ2hyaXN0aWFuIEvDtm5p
ZyIgPGNocmlzdGlhbi5rb2VuaWdAYW1kLmNvbT4KQ2M6IEphbmkgTmlrdWxhIDxqYW5pLm5pa3Vs
YUBsaW51eC5pbnRlbC5jb20+CkNjOiBKb29uYXMgTGFodGluZW4gPGpvb25hcy5sYWh0aW5lbkBs
aW51eC5pbnRlbC5jb20+CkNjOiBSb2RyaWdvIFZpdmkgPHJvZHJpZ28udml2aUBpbnRlbC5jb20+
CkNjOiBCZW4gU2tlZ2dzIDxic2tlZ2dzQHJlZGhhdC5jb20+CkNjOiBSb2RyaWdvIFNpcXVlaXJh
IDxyb2RyaWdvc2lxdWVpcmFtZWxvQGdtYWlsLmNvbT4KQ2M6IE1lbGlzc2EgV2VuIDxtZWxpc3Nh
LnNyd0BnbWFpbC5jb20+CkNjOiBIYW5lZW4gTW9oYW1tZWQgPGhhbW9oYW1tZWQuc2FAZ21haWwu
Y29tPgpBY2tlZC1ieTogVGhvbWFzIFppbW1lcm1hbm4gPHR6aW1tZXJtYW5uQHN1c2UuZGU+CkFj
a2VkLWJ5OiBIYXJyeSBXZW50bGFuZCA8aGFycnkud2VudGxhbmRAYW1kLmNvbT4KUmV2aWV3ZWQt
Ynk6IFJvZHJpZ28gU2lxdWVpcmEgPHJvZHJpZ29zaXF1ZWlyYW1lbG9AZ21haWwuY29tPgpTaWdu
ZWQtb2ZmLWJ5OiBNYXhpbWUgUmlwYXJkIDxtYXhpbWVAY2Vybm8udGVjaD4KCi0tLQoKQ2hhbmdl
cyBmcm9tIHYxOgogIC0gQWRkZWQgbWlzc2luZyBjb2NjaW5lbGxlIHNjcmlwdAotLS0KIC4uLi9k
cm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbV9tc3RfdHlwZXMuYyB8ICA1ICsrKyst
CiBkcml2ZXJzL2dwdS9kcm0vZHJtX2F0b21pY19oZWxwZXIuYyAgICAgICAgICAgICAgICAgfCAg
OCArKysrLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcF9tc3QuYyAg
ICAgICAgIHwgIDcgKysrKystLQogZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvZGlzcG52NTAvZGlz
cC5jICAgICAgICAgICAgIHwgIDUgKysrKy0KIGRyaXZlcnMvZ3B1L2RybS92YzQvdmM0X3R4cC5j
ICAgICAgICAgICAgICAgICAgICAgICB8ICA0ICsrKy0KIGRyaXZlcnMvZ3B1L2RybS92a21zL3Zr
bXNfd3JpdGViYWNrLmMgICAgICAgICAgICAgICB8ICA3ICsrKysrLS0KIGluY2x1ZGUvZHJtL2Ry
bV9tb2Rlc2V0X2hlbHBlcl92dGFibGVzLmggICAgICAgICAgICB8IDEzICsrKysrKy0tLS0tLS0K
IDcgZmlsZXMgY2hhbmdlZCwgMzEgaW5zZXJ0aW9ucygrKSwgMTggZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG1f
bXN0X3R5cGVzLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdw
dV9kbV9tc3RfdHlwZXMuYwppbmRleCA2Zjk3NWMxNjc3OWQuLjhhYjBiOTA2MGQyYiAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG1fbXN0
X3R5cGVzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRn
cHVfZG1fbXN0X3R5cGVzLmMKQEAgLTI0LDYgKzI0LDcgQEAKICAqLwogCiAjaW5jbHVkZSA8bGlu
dXgvdmVyc2lvbi5oPgorI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljLmg+CiAjaW5jbHVkZSA8ZHJt
L2RybV9hdG9taWNfaGVscGVyLmg+CiAjaW5jbHVkZSA8ZHJtL2RybV9kcF9tc3RfaGVscGVyLmg+
CiAjaW5jbHVkZSA8ZHJtL2RybV9kcF9oZWxwZXIuaD4KQEAgLTI1Miw4ICsyNTMsMTAgQEAgc3Rh
dGljIGludCBkbV9kcF9tc3RfZ2V0X21vZGVzKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0
b3IpCiAKIHN0YXRpYyBzdHJ1Y3QgZHJtX2VuY29kZXIgKgogZG1fbXN0X2F0b21pY19iZXN0X2Vu
Y29kZXIoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKLQkJCSAgIHN0cnVjdCBkcm1f
Y29ubmVjdG9yX3N0YXRlICpjb25uZWN0b3Jfc3RhdGUpCisJCQkgICBzdHJ1Y3QgZHJtX2F0b21p
Y19zdGF0ZSAqc3RhdGUpCiB7CisJc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5lY3Rv
cl9zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X25ld19jb25uZWN0b3Jfc3RhdGUoc3RhdGUsCisJCQkJ
CQkJCQkJCSBjb25uZWN0b3IpOwogCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjb25uZWN0b3It
PmRldjsKIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGRybV90b19hZGV2KGRldik7CiAJ
c3RydWN0IGFtZGdwdV9jcnRjICphY3J0YyA9IHRvX2FtZGdwdV9jcnRjKGNvbm5lY3Rvcl9zdGF0
ZS0+Y3J0Yyk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2F0b21pY19oZWxwZXIu
YyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fYXRvbWljX2hlbHBlci5jCmluZGV4IGRkZDBlMzIzOTE1
MC4uYmExNTA3MDM2ZjI2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2F0b21pY19o
ZWxwZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX2F0b21pY19oZWxwZXIuYwpAQCAtMTIy
LDcgKzEyMiw4IEBAIHN0YXRpYyBpbnQgaGFuZGxlX2NvbmZsaWN0aW5nX2VuY29kZXJzKHN0cnVj
dCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSwKIAkJCWNvbnRpbnVlOwogCiAJCWlmIChmdW5jcy0+
YXRvbWljX2Jlc3RfZW5jb2RlcikKLQkJCW5ld19lbmNvZGVyID0gZnVuY3MtPmF0b21pY19iZXN0
X2VuY29kZXIoY29ubmVjdG9yLCBuZXdfY29ubl9zdGF0ZSk7CisJCQluZXdfZW5jb2RlciA9IGZ1
bmNzLT5hdG9taWNfYmVzdF9lbmNvZGVyKGNvbm5lY3RvciwKKwkJCQkJCQkJIHN0YXRlKTsKIAkJ
ZWxzZSBpZiAoZnVuY3MtPmJlc3RfZW5jb2RlcikKIAkJCW5ld19lbmNvZGVyID0gZnVuY3MtPmJl
c3RfZW5jb2Rlcihjb25uZWN0b3IpOwogCQllbHNlCkBAIC0zNDUsOCArMzQ2LDcgQEAgdXBkYXRl
X2Nvbm5lY3Rvcl9yb3V0aW5nKHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSwKIAlmdW5j
cyA9IGNvbm5lY3Rvci0+aGVscGVyX3ByaXZhdGU7CiAKIAlpZiAoZnVuY3MtPmF0b21pY19iZXN0
X2VuY29kZXIpCi0JCW5ld19lbmNvZGVyID0gZnVuY3MtPmF0b21pY19iZXN0X2VuY29kZXIoY29u
bmVjdG9yLAotCQkJCQkJCSBuZXdfY29ubmVjdG9yX3N0YXRlKTsKKwkJbmV3X2VuY29kZXIgPSBm
dW5jcy0+YXRvbWljX2Jlc3RfZW5jb2Rlcihjb25uZWN0b3IsIHN0YXRlKTsKIAllbHNlIGlmIChm
dW5jcy0+YmVzdF9lbmNvZGVyKQogCQluZXdfZW5jb2RlciA9IGZ1bmNzLT5iZXN0X2VuY29kZXIo
Y29ubmVjdG9yKTsKIAllbHNlCkBAIC0xMzEzLDcgKzEzMTMsNyBAQCBzdGF0aWMgdm9pZCBkcm1f
YXRvbWljX2hlbHBlcl9jb21taXRfd3JpdGViYWNrcyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAog
CiAJCWlmIChuZXdfY29ubl9zdGF0ZS0+d3JpdGViYWNrX2pvYiAmJiBuZXdfY29ubl9zdGF0ZS0+
d3JpdGViYWNrX2pvYi0+ZmIpIHsKIAkJCVdBUk5fT04oY29ubmVjdG9yLT5jb25uZWN0b3JfdHlw
ZSAhPSBEUk1fTU9ERV9DT05ORUNUT1JfV1JJVEVCQUNLKTsKLQkJCWZ1bmNzLT5hdG9taWNfY29t
bWl0KGNvbm5lY3RvciwgbmV3X2Nvbm5fc3RhdGUpOworCQkJZnVuY3MtPmF0b21pY19jb21taXQo
Y29ubmVjdG9yLCBvbGRfc3RhdGUpOwogCQl9CiAJfQogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcF9tc3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZHBfbXN0LmMKaW5kZXggYzhmY2VjNGQwNzg4Li40ZjA1ZmZhM2U3NjEg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHBfbXN0LmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcF9tc3QuYwpAQCAtMjMs
NiArMjMsNyBAQAogICoKICAqLwogCisjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWMuaD4KICNpbmNs
dWRlIDxkcm0vZHJtX2F0b21pY19oZWxwZXIuaD4KICNpbmNsdWRlIDxkcm0vZHJtX2VkaWQuaD4K
ICNpbmNsdWRlIDxkcm0vZHJtX3Byb2JlX2hlbHBlci5oPgpAQCAtNzE5LDExICs3MjAsMTMgQEAg
aW50ZWxfZHBfbXN0X21vZGVfdmFsaWRfY3R4KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0
b3IsCiB9CiAKIHN0YXRpYyBzdHJ1Y3QgZHJtX2VuY29kZXIgKmludGVsX21zdF9hdG9taWNfYmVz
dF9lbmNvZGVyKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCi0JCQkJCQkJIHN0cnVj
dCBkcm1fY29ubmVjdG9yX3N0YXRlICpzdGF0ZSkKKwkJCQkJCQkgc3RydWN0IGRybV9hdG9taWNf
c3RhdGUgKnN0YXRlKQogeworCXN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uZWN0b3Jf
c3RhdGUgPSBkcm1fYXRvbWljX2dldF9uZXdfY29ubmVjdG9yX3N0YXRlKHN0YXRlLAorCQkJCQkJ
CQkJCQkgY29ubmVjdG9yKTsKIAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICppbnRlbF9jb25uZWN0
b3IgPSB0b19pbnRlbF9jb25uZWN0b3IoY29ubmVjdG9yKTsKIAlzdHJ1Y3QgaW50ZWxfZHAgKmlu
dGVsX2RwID0gaW50ZWxfY29ubmVjdG9yLT5tc3RfcG9ydDsKLQlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMoc3RhdGUtPmNydGMpOworCXN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjID0gdG9faW50ZWxfY3J0Yyhjb25uZWN0b3Jfc3RhdGUtPmNydGMpOwogCiAJcmV0dXJuICZp
bnRlbF9kcC0+bXN0X2VuY29kZXJzW2NydGMtPnBpcGVdLT5iYXNlLmJhc2U7CiB9CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9kaXNwbnY1MC9kaXNwLmMgYi9kcml2ZXJzL2dw
dS9kcm0vbm91dmVhdS9kaXNwbnY1MC9kaXNwLmMKaW5kZXggYjExMWZlMjRhMDZiLi45MTFjMmNi
ZTZhYTMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L2Rpc3BudjUwL2Rpc3Au
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9kaXNwbnY1MC9kaXNwLmMKQEAgLTMyLDYg
KzMyLDcgQEAKICNpbmNsdWRlIDxsaW51eC9oZG1pLmg+CiAjaW5jbHVkZSA8bGludXgvY29tcG9u
ZW50Lmg+CiAKKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pYy5oPgogI2luY2x1ZGUgPGRybS9kcm1f
YXRvbWljX2hlbHBlci5oPgogI2luY2x1ZGUgPGRybS9kcm1fZHBfaGVscGVyLmg+CiAjaW5jbHVk
ZSA8ZHJtL2RybV9lZGlkLmg+CkBAIC0xMTYxLDggKzExNjIsMTAgQEAgbnY1MF9tc3RvX25ldyhz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBzdHJ1Y3QgbnY1MF9oZWFkICpoZWFkLCBpbnQgaWQpCiAK
IHN0YXRpYyBzdHJ1Y3QgZHJtX2VuY29kZXIgKgogbnY1MF9tc3RjX2F0b21pY19iZXN0X2VuY29k
ZXIoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKLQkJCSAgICAgIHN0cnVjdCBkcm1f
Y29ubmVjdG9yX3N0YXRlICpjb25uZWN0b3Jfc3RhdGUpCisJCQkgICAgICBzdHJ1Y3QgZHJtX2F0
b21pY19zdGF0ZSAqc3RhdGUpCiB7CisJc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5l
Y3Rvcl9zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X25ld19jb25uZWN0b3Jfc3RhdGUoc3RhdGUsCisJ
CQkJCQkJCQkJCSBjb25uZWN0b3IpOwogCXN0cnVjdCBudjUwX21zdGMgKm1zdGMgPSBudjUwX21z
dGMoY29ubmVjdG9yKTsKIAlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSBjb25uZWN0b3Jfc3RhdGUt
PmNydGM7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92YzQvdmM0X3R4cC5jIGIvZHJp
dmVycy9ncHUvZHJtL3ZjNC92YzRfdHhwLmMKaW5kZXggMzQ2MTJlZGNhYmJkLi44YWE1MjIwODg1
ZjQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92YzQvdmM0X3R4cC5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS92YzQvdmM0X3R4cC5jCkBAIC0yNzMsOCArMjczLDEwIEBAIHN0YXRpYyBpbnQg
dmM0X3R4cF9jb25uZWN0b3JfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25u
LAogfQogCiBzdGF0aWMgdm9pZCB2YzRfdHhwX2Nvbm5lY3Rvcl9hdG9taWNfY29tbWl0KHN0cnVj
dCBkcm1fY29ubmVjdG9yICpjb25uLAotCQkJCQlzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAq
Y29ubl9zdGF0ZSkKKwkJCQkJc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQogeworCXN0
cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlID0gZHJtX2F0b21pY19nZXRfbmV3
X2Nvbm5lY3Rvcl9zdGF0ZShzdGF0ZSwKKwkJCQkJCQkJCQkgICAgY29ubik7CiAJc3RydWN0IHZj
NF90eHAgKnR4cCA9IGNvbm5lY3Rvcl90b192YzRfdHhwKGNvbm4pOwogCXN0cnVjdCBkcm1fZ2Vt
X2NtYV9vYmplY3QgKmdlbTsKIAlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZTsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92a21zL3ZrbXNfd3JpdGViYWNrLmMgYi9kcml2ZXJzL2dw
dS9kcm0vdmttcy92a21zX3dyaXRlYmFjay5jCmluZGV4IDY3ZjgwYWIxZTg1Zi4uNzhmZGMxZDU5
MTg2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdmttcy92a21zX3dyaXRlYmFjay5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS92a21zL3ZrbXNfd3JpdGViYWNrLmMKQEAgLTIsNiArMiw3IEBA
CiAKICNpbmNsdWRlIDxsaW51eC9kbWEtYnVmLW1hcC5oPgogCisjaW5jbHVkZSA8ZHJtL2RybV9h
dG9taWMuaD4KICNpbmNsdWRlIDxkcm0vZHJtX2ZvdXJjYy5oPgogI2luY2x1ZGUgPGRybS9kcm1f
d3JpdGViYWNrLmg+CiAjaW5jbHVkZSA8ZHJtL2RybV9wcm9iZV9oZWxwZXIuaD4KQEAgLTEwNSw4
ICsxMDYsMTAgQEAgc3RhdGljIHZvaWQgdmttc193Yl9jbGVhbnVwX2pvYihzdHJ1Y3QgZHJtX3dy
aXRlYmFja19jb25uZWN0b3IgKmNvbm5lY3RvciwKIH0KIAogc3RhdGljIHZvaWQgdmttc193Yl9h
dG9taWNfY29tbWl0KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uLAotCQkJCSAgc3RydWN0IGRy
bV9jb25uZWN0b3Jfc3RhdGUgKnN0YXRlKQorCQkJCSAgc3RydWN0IGRybV9hdG9taWNfc3RhdGUg
KnN0YXRlKQogeworCXN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uZWN0b3Jfc3RhdGUg
PSBkcm1fYXRvbWljX2dldF9uZXdfY29ubmVjdG9yX3N0YXRlKHN0YXRlLAorCQkJCQkJCQkJCQkg
Y29ubik7CiAJc3RydWN0IHZrbXNfZGV2aWNlICp2a21zZGV2ID0gZHJtX2RldmljZV90b192a21z
X2RldmljZShjb25uLT5kZXYpOwogCXN0cnVjdCB2a21zX291dHB1dCAqb3V0cHV0ID0gJnZrbXNk
ZXYtPm91dHB1dDsKIAlzdHJ1Y3QgZHJtX3dyaXRlYmFja19jb25uZWN0b3IgKndiX2Nvbm4gPSAm
b3V0cHV0LT53Yl9jb25uZWN0b3I7CkBAIC0xMjIsNyArMTI1LDcgQEAgc3RhdGljIHZvaWQgdmtt
c193Yl9hdG9taWNfY29tbWl0KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uLAogCWNydGNfc3Rh
dGUtPmFjdGl2ZV93cml0ZWJhY2sgPSBjb25uX3N0YXRlLT53cml0ZWJhY2tfam9iLT5wcml2Owog
CWNydGNfc3RhdGUtPndiX3BlbmRpbmcgPSB0cnVlOwogCXNwaW5fdW5sb2NrX2lycSgmb3V0cHV0
LT5jb21wb3Nlcl9sb2NrKTsKLQlkcm1fd3JpdGViYWNrX3F1ZXVlX2pvYih3Yl9jb25uLCBzdGF0
ZSk7CisJZHJtX3dyaXRlYmFja19xdWV1ZV9qb2Iod2JfY29ubiwgY29ubmVjdG9yX3N0YXRlKTsK
IH0KIAogc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX2hlbHBlcl9mdW5jcyB2a21z
X3diX2Nvbm5faGVscGVyX2Z1bmNzID0gewpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0vZHJtX21v
ZGVzZXRfaGVscGVyX3Z0YWJsZXMuaCBiL2luY2x1ZGUvZHJtL2RybV9tb2Rlc2V0X2hlbHBlcl92
dGFibGVzLmgKaW5kZXggZjJkZTA1MDA4NWJlLi4xNmZmM2ZhMTQ4ZjUgMTAwNjQ0Ci0tLSBhL2lu
Y2x1ZGUvZHJtL2RybV9tb2Rlc2V0X2hlbHBlcl92dGFibGVzLmgKKysrIGIvaW5jbHVkZS9kcm0v
ZHJtX21vZGVzZXRfaGVscGVyX3Z0YWJsZXMuaApAQCAtMTA0NCw5ICsxMDQ0LDggQEAgc3RydWN0
IGRybV9jb25uZWN0b3JfaGVscGVyX2Z1bmNzIHsKIAkgKiBOT1RFOgogCSAqCiAJICogVGhpcyBm
dW5jdGlvbiBpcyBjYWxsZWQgaW4gdGhlIGNoZWNrIHBoYXNlIG9mIGFuIGF0b21pYyB1cGRhdGUu
IFRoZQotCSAqIGRyaXZlciBpcyBub3QgYWxsb3dlZCB0byBjaGFuZ2UgYW55dGhpbmcgb3V0c2lk
ZSBvZiB0aGUgZnJlZS1zdGFuZGluZwotCSAqIHN0YXRlIG9iamVjdHMgcGFzc2VkLWluIG9yIGFz
c2VtYmxlZCBpbiB0aGUgb3ZlcmFsbCAmZHJtX2F0b21pY19zdGF0ZQotCSAqIHVwZGF0ZSB0cmFj
a2luZyBzdHJ1Y3R1cmUuCisJICogZHJpdmVyIGlzIG5vdCBhbGxvd2VkIHRvIGNoYW5nZSBhbnl0
aGluZyBvdXRzaWRlIG9mIHRoZQorCSAqICZkcm1fYXRvbWljX3N0YXRlIHVwZGF0ZSB0cmFja2lu
ZyBzdHJ1Y3R1cmUgcGFzc2VkIGluLgogCSAqCiAJICogUkVUVVJOUzoKIAkgKgpAQCAtMTA1Niw3
ICsxMDU1LDcgQEAgc3RydWN0IGRybV9jb25uZWN0b3JfaGVscGVyX2Z1bmNzIHsKIAkgKiBmb3Ig
dGhpcy4KIAkgKi8KIAlzdHJ1Y3QgZHJtX2VuY29kZXIgKigqYXRvbWljX2Jlc3RfZW5jb2Rlciko
c3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKLQkJCQkJCSAgIHN0cnVjdCBkcm1fY29u
bmVjdG9yX3N0YXRlICpjb25uZWN0b3Jfc3RhdGUpOworCQkJCQkJICAgc3RydWN0IGRybV9hdG9t
aWNfc3RhdGUgKnN0YXRlKTsKIAogCS8qKgogCSAqIEBhdG9taWNfY2hlY2s6CkBAIC0xMDk3LDE1
ICsxMDk2LDE1IEBAIHN0cnVjdCBkcm1fY29ubmVjdG9yX2hlbHBlcl9mdW5jcyB7CiAJICoKIAkg
KiBUaGlzIGhvb2sgaXMgdG8gYmUgdXNlZCBieSBkcml2ZXJzIGltcGxlbWVudGluZyB3cml0ZWJh
Y2sgY29ubmVjdG9ycwogCSAqIHRoYXQgbmVlZCBhIHBvaW50IHdoZW4gdG8gY29tbWl0IHRoZSB3
cml0ZWJhY2sgam9iIHRvIHRoZSBoYXJkd2FyZS4KLQkgKiBUaGUgd3JpdGViYWNrX2pvYiB0byBj
b21taXQgaXMgYXZhaWxhYmxlIGluCi0JICogJmRybV9jb25uZWN0b3Jfc3RhdGUud3JpdGViYWNr
X2pvYi4KKwkgKiBUaGUgd3JpdGViYWNrX2pvYiB0byBjb21taXQgaXMgYXZhaWxhYmxlIGluIHRo
ZSBuZXcgY29ubmVjdG9yIHN0YXRlLAorCSAqIGluICZkcm1fY29ubmVjdG9yX3N0YXRlLndyaXRl
YmFja19qb2IuCiAJICoKIAkgKiBUaGlzIGhvb2sgaXMgb3B0aW9uYWwuCiAJICoKIAkgKiBUaGlz
IGNhbGxiYWNrIGlzIHVzZWQgYnkgdGhlIGF0b21pYyBtb2Rlc2V0IGhlbHBlcnMuCiAJICovCiAJ
dm9pZCAoKmF0b21pY19jb21taXQpKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCi0J
CQkgICAgICBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqc3RhdGUpOworCQkJICAgICAgc3Ry
dWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKTsKIAogCS8qKgogCSAqIEBwcmVwYXJlX3dyaXRl
YmFja19qb2I6Ci0tIAoyLjI4LjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVk
ZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZv
L2RyaS1kZXZlbAo=
