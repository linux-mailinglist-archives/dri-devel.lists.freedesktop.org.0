Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id A551C24129C
	for <lists+dri-devel@lfdr.de>; Mon, 10 Aug 2020 23:54:26 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7AD776E1AA;
	Mon, 10 Aug 2020 21:54:24 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mga06.intel.com (mga06.intel.com [134.134.136.31])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5D2B06E169;
 Mon, 10 Aug 2020 21:54:23 +0000 (UTC)
IronPort-SDR: G99kkrd/mjb4bujdrweeNaHum78lmmCZI5F4jc4fpYxeqj6w5V/Xqibl4RvafdnkDKqRcHOiqZ
 JHU1JUmYs6Og==
X-IronPort-AV: E=McAfee;i="6000,8403,9709"; a="215141051"
X-IronPort-AV: E=Sophos;i="5.75,458,1589266800"; d="scan'208";a="215141051"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga002.fm.intel.com ([10.253.24.26])
 by orsmga104.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 10 Aug 2020 14:54:22 -0700
IronPort-SDR: ZVZmW+Aqz09aj5+l55t2nTDuMrCEn1SdwyTv39VfknkUM9P4JaBF7tn4gaJeedcPPr6EuwGexT
 9U5b8PW4yqeA==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.75,458,1589266800"; d="scan'208";a="326644115"
Received: from caezeany-mobl.amr.corp.intel.com (HELO
 achrisan-DESK2.amr.corp.intel.com) ([10.254.61.211])
 by fmsmga002.fm.intel.com with ESMTP; 10 Aug 2020 14:54:21 -0700
From: Anitha Chrisanthus <anitha.chrisanthus@intel.com>
To: dri-devel@lists.freedesktop.org, anitha.chrisanthus@intel.com,
 bob.j.paauwe@intel.com, edmund.j.dea@intel.com
Subject: [PATCH v6] drm/kmb: Add support for KeemBay Display
Date: Mon, 10 Aug 2020 14:53:38 -0700
Message-Id: <1597096418-28937-2-git-send-email-anitha.chrisanthus@intel.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1597096418-28937-1-git-send-email-anitha.chrisanthus@intel.com>
References: <1597096418-28937-1-git-send-email-anitha.chrisanthus@intel.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: daniel.vetter@intel.com, intel-gfx@lists.freedesktop.org, sam@ravnborg.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBpcyBhIGJhc2ljIEtNUyBhdG9taWMgbW9kZXNldHRpbmcgZGlzcGxheSBkcml2ZXIgZm9y
IEtlZW1CYXkgZmFtaWx5IG9mClNPQ3MuIERyaXZlciBoYXMgbm8gMkQgb3IgM0QgZ3JhcGhpY3Mu
SXQgY2FsbHMgaW50byB0aGUgQURWIGJyaWRnZQpkcml2ZXIgYXQgdGhlIGNvbm5lY3RvciBsZXZl
bC4KClNpbmdsZSBDUlRDIHdpdGggTENEIGNvbnRyb2xsZXItPm1pcGkgRFNJLT4gQURWIGJyaWRn
ZQoKT25seSAxMDgwcCByZXNvbHV0aW9uIGFuZCBzaW5nbGUgcGxhbmUgaXMgc3VwcG9ydGVkIGF0
IHRoaXMgdGltZS4KCnYyOiBtb3ZlZCBleHRlcm4gdG8gLmgsIHJlbW92ZWQgbGljZW5zZSB0ZXh0
CiAgICB1c2UgZHJtX2Rldl9pbml0LCB1cGNsYXNzZWQgZGV2X3ByaXZhdGUsIHJlbW92ZWQgSEFW
RV9JUlEuCgp2MzogU3F1YXNoZWQgYWxsIDU5IGNvbW1pdHMgdG8gb25lCgp2NDogcmV2aWV3IGNo
YW5nZXMgZnJvbSBTYW0gUmF2bmJvcmcKCXJlbmFtZWQgZGV2X3AgdG8ga21iCgltb3ZlZCBjbG9j
a3MgdW5kZXIga21iX2Nsb2NrLCBjb25zb2xpZGF0ZWQgY2xrIGluaXRpYWxpemF0aW9ucwoJdXNl
IGRybW0gZnVuY3Rpb25zCgl1c2UgRFJNX0dFTV9DTUFfRFJJVkVSX09QU19WTUFQCgp2NTogY29y
cmVjdGVkIHNwZWxsaW5ncwp2NjogY29ycmVjdGVkIGNoZWNrcGF0Y2ggd2FybmluZ3MKCkNjOiBT
YW0gUmF2bmJvcmcgPHNhbUByYXZuYm9yZy5vcmc+ClNpZ25lZC1vZmYtYnk6IEFuaXRoYSBDaHJp
c2FudGh1cyA8YW5pdGhhLmNocmlzYW50aHVzQGludGVsLmNvbT4KUmV2aWV3ZWQtYnk6IEJvYiBQ
YWF1d2UgPGJvYi5qLnBhYXV3ZUBpbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL0tjb25m
aWcgICAgICAgICB8ICAgIDIgKwogZHJpdmVycy9ncHUvZHJtL01ha2VmaWxlICAgICAgICB8ICAg
IDEgKwogZHJpdmVycy9ncHUvZHJtL2ttYi9LY29uZmlnICAgICB8ICAgMTMgKwogZHJpdmVycy9n
cHUvZHJtL2ttYi9NYWtlZmlsZSAgICB8ICAgIDIgKwogZHJpdmVycy9ncHUvZHJtL2ttYi9rbWJf
Y3J0Yy5jICB8ICAyMTcgKysrKysKIGRyaXZlcnMvZ3B1L2RybS9rbWIva21iX2NydGMuaCAgfCAg
IDM2ICsKIGRyaXZlcnMvZ3B1L2RybS9rbWIva21iX2Rydi5jICAgfCAgNzI1ICsrKysrKysrKysr
KysrKysKIGRyaXZlcnMvZ3B1L2RybS9rbWIva21iX2Rydi5oICAgfCAgMTcyICsrKysKIGRyaXZl
cnMvZ3B1L2RybS9rbWIva21iX2RzaS5jICAgfCAxODI4ICsrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKwogZHJpdmVycy9ncHUvZHJtL2ttYi9rbWJfZHNpLmggICB8ICAzNzAg
KysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9rbWIva21iX3BsYW5lLmMgfCAgNTE5ICsrKysrKysr
KysrCiBkcml2ZXJzL2dwdS9kcm0va21iL2ttYl9wbGFuZS5oIHwgIDEyNCArKysKIGRyaXZlcnMv
Z3B1L2RybS9rbWIva21iX3JlZ3MuaCAgfCAgNzQ4ICsrKysrKysrKysrKysrKysKIDEzIGZpbGVz
IGNoYW5nZWQsIDQ3NTcgaW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMv
Z3B1L2RybS9rbWIvS2NvbmZpZwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9r
bWIvTWFrZWZpbGUKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0va21iL2ttYl9j
cnRjLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0va21iL2ttYl9jcnRjLmgK
IGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0va21iL2ttYl9kcnYuYwogY3JlYXRl
IG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9rbWIva21iX2Rydi5oCiBjcmVhdGUgbW9kZSAx
MDA2NDQgZHJpdmVycy9ncHUvZHJtL2ttYi9rbWJfZHNpLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBk
cml2ZXJzL2dwdS9kcm0va21iL2ttYl9kc2kuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMv
Z3B1L2RybS9rbWIva21iX3BsYW5lLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9k
cm0va21iL2ttYl9wbGFuZS5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2tt
Yi9rbWJfcmVncy5oCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL0tjb25maWcgYi9kcml2
ZXJzL2dwdS9kcm0vS2NvbmZpZwppbmRleCAxNDdkNjFiLi45N2ExNjMxYiAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL0tjb25maWcKKysrIGIvZHJpdmVycy9ncHUvZHJtL0tjb25maWcKQEAg
LTI3NSw2ICsyNzUsOCBAQCBzb3VyY2UgImRyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L0tjb25maWci
CiAKIHNvdXJjZSAiZHJpdmVycy9ncHUvZHJtL2k5MTUvS2NvbmZpZyIKIAorc291cmNlICJkcml2
ZXJzL2dwdS9kcm0va21iL0tjb25maWciCisKIGNvbmZpZyBEUk1fVkdFTQogCXRyaXN0YXRlICJW
aXJ0dWFsIEdFTSBwcm92aWRlciIKIAlkZXBlbmRzIG9uIERSTQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL01ha2VmaWxlCmluZGV4IDJmMzE1
NzkuLjIxNDZmZjggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9NYWtlZmlsZQorKysgYi9k
cml2ZXJzL2dwdS9kcm0vTWFrZWZpbGUKQEAgLTcxLDYgKzcxLDcgQEAgb2JqLSQoQ09ORklHX0RS
TV9BTURHUFUpKz0gYW1kL2FtZGdwdS8KIG9iai0kKENPTkZJR19EUk1fTUdBKQkrPSBtZ2EvCiBv
YmotJChDT05GSUdfRFJNX0k4MTApCSs9IGk4MTAvCiBvYmotJChDT05GSUdfRFJNX0k5MTUpCSs9
IGk5MTUvCitvYmotJChDT05GSUdfRFJNX0tNQl9ESVNQTEFZKSAgKz0ga21iLwogb2JqLSQoQ09O
RklHX0RSTV9NR0FHMjAwKSArPSBtZ2FnMjAwLwogb2JqLSQoQ09ORklHX0RSTV9WM0QpICArPSB2
M2QvCiBvYmotJChDT05GSUdfRFJNX1ZDNCkgICs9IHZjNC8KZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9rbWIvS2NvbmZpZyBiL2RyaXZlcnMvZ3B1L2RybS9rbWIvS2NvbmZpZwpuZXcgZmls
ZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi5lMThiNzRjCi0tLSAvZGV2L251bGwKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2ttYi9LY29uZmlnCkBAIC0wLDAgKzEsMTMgQEAKK2NvbmZpZyBEUk1f
S01CX0RJU1BMQVkKKwl0cmlzdGF0ZSAiSU5URUwgS0VFTUJBWSBESVNQTEFZIgorCWRlcGVuZHMg
b24gRFJNICYmIE9GICYmIChBUk0gfHwgQVJNNjQpCisJZGVwZW5kcyBvbiBDT01NT05fQ0xLCisJ
c2VsZWN0IERSTV9LTVNfSEVMUEVSCisJc2VsZWN0IERSTV9LTVNfQ01BX0hFTFBFUgorCXNlbGVj
dCBEUk1fR0VNX0NNQV9IRUxQRVIKKwlzZWxlY3QgVklERU9NT0RFX0hFTFBFUlMKKwloZWxwCisJ
Q2hvb3NlIHRoaXMgb3B0aW9uIGlmIHlvdSBoYXZlIEludGVsJ3MgS2VlbUJheSBTT0Mgd2hpY2gg
aW50ZWdyYXRlcworCWFuIEFSTSBDb3J0ZXggQTUzIENQVSB3aXRoIGFuIEludGVsIE1vdmlkaXVz
IFZQVS4KKworCUlmIE0gaXMgc2VsZWN0ZWQgdGhlIG1vZHVsZSB3aWxsIGJlIGNhbGxlZCBrbWIt
ZHJtLgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2ttYi9NYWtlZmlsZSBiL2RyaXZlcnMv
Z3B1L2RybS9rbWIvTWFrZWZpbGUKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4u
NTI3ZDczNwotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9rbWIvTWFrZWZpbGUK
QEAgLTAsMCArMSwyIEBACitrbWItZHJtLXkgOj0ga21iX2NydGMubyBrbWJfZHJ2Lm8ga21iX3Bs
YW5lLm8ga21iX2RzaS5vCitvYmotJChDT05GSUdfRFJNX0tNQl9ESVNQTEFZKQkrPSBrbWItZHJt
Lm8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9rbWIva21iX2NydGMuYyBiL2RyaXZlcnMv
Z3B1L2RybS9rbWIva21iX2NydGMuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAw
Li5kZmI2OTQ2Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2ttYi9rbWJfY3J0
Yy5jCkBAIC0wLDAgKzEsMjE3IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIu
MC1vbmx5CisvKgorICogQ29weXJpZ2h0IMKpIDIwMTgtMjAyMCBJbnRlbCBDb3Jwb3JhdGlvbgor
ICovCisKKyNpbmNsdWRlIDxsaW51eC9jbGsuaD4KKyNpbmNsdWRlIDxsaW51eC9vZl9ncmFwaC5o
PgorI2luY2x1ZGUgPGxpbnV4L3BsYXRmb3JtX2RhdGEvc2ltcGxlZmIuaD4KKworI2luY2x1ZGUg
PHZpZGVvL3ZpZGVvbW9kZS5oPgorCisjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWMuaD4KKyNpbmNs
dWRlIDxkcm0vZHJtX2F0b21pY19oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2NydGMuaD4K
KyNpbmNsdWRlIDxkcm0vZHJtX2NydGNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9mYl9j
bWFfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9mYl9oZWxwZXIuaD4KKyNpbmNsdWRlIDxk
cm0vZHJtX2dlbV9jbWFfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9vZi5oPgorI2luY2x1
ZGUgPGRybS9kcm1fcGxhbmVfaGVscGVyLmg+CisKKyNpbmNsdWRlICJrbWJfY3J0Yy5oIgorI2lu
Y2x1ZGUgImttYl9kcnYuaCIKKyNpbmNsdWRlICJrbWJfcGxhbmUuaCIKKyNpbmNsdWRlICJrbWJf
cmVncy5oIgorI2luY2x1ZGUgImttYl9kc2kuaCIKKworc3RhdGljIHZvaWQga21iX2NydGNfY2xl
YW51cChzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCit7CisJZHJtX2NydGNfY2xlYW51cChjcnRjKTsK
K30KKworc3RhdGljIGludCBrbWJfY3J0Y19lbmFibGVfdmJsYW5rKHN0cnVjdCBkcm1fY3J0YyAq
Y3J0YykKK3sKKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+ZGV2OworCXN0cnVjdCBr
bWJfZHJtX3ByaXZhdGUgKmttYiA9IHRvX2ttYihkZXYpOworCisJLyogQ2xlYXIgaW50ZXJydXB0
ICovCisJa21iX3dyaXRlX2xjZChrbWIsIExDRF9JTlRfQ0xFQVIsIExDRF9JTlRfVkVSVF9DT01Q
KTsKKwkvKiBTZXQgd2hpY2ggaW50ZXJ2YWwgdG8gZ2VuZXJhdGUgdmVydGljYWwgaW50ZXJydXB0
ICovCisJa21iX3dyaXRlX2xjZChrbWIsIExDRF9WU1RBVFVTX0NPTVBBUkUsCisJCSAgICAgIExD
RF9WU1RBVFVTX0NPTVBBUkVfVlNZTkMpOworCS8qIEVuYWJsZSB2ZXJ0aWNhbCBpbnRlcnJ1cHQg
Ki8KKwlrbWJfc2V0X2JpdG1hc2tfbGNkKGttYiwgTENEX0lOVF9FTkFCTEUsCisJCQkgICAgTENE
X0lOVF9WRVJUX0NPTVApOworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBrbWJfY3J0Y19k
aXNhYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCit7CisJc3RydWN0IGRybV9kZXZp
Y2UgKmRldiA9IGNydGMtPmRldjsKKwlzdHJ1Y3Qga21iX2RybV9wcml2YXRlICprbWIgPSB0b19r
bWIoZGV2KTsKKworCS8qIENsZWFyIGludGVycnVwdCAqLworCWttYl93cml0ZV9sY2Qoa21iLCBM
Q0RfSU5UX0NMRUFSLCBMQ0RfSU5UX1ZFUlRfQ09NUCk7CisJLyogRGlzYWJsZSB2ZXJ0aWNhbCBp
bnRlcnJ1cHQgKi8KKwlrbWJfY2xyX2JpdG1hc2tfbGNkKGttYiwgTENEX0lOVF9FTkFCTEUsCisJ
CQkgICAgTENEX0lOVF9WRVJUX0NPTVApOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9j
cnRjX2Z1bmNzIGttYl9jcnRjX2Z1bmNzID0geworCS5kZXN0cm95ID0ga21iX2NydGNfY2xlYW51
cCwKKwkuc2V0X2NvbmZpZyA9IGRybV9hdG9taWNfaGVscGVyX3NldF9jb25maWcsCisJLnBhZ2Vf
ZmxpcCA9IGRybV9hdG9taWNfaGVscGVyX3BhZ2VfZmxpcCwKKwkucmVzZXQgPSBkcm1fYXRvbWlj
X2hlbHBlcl9jcnRjX3Jlc2V0LAorCS5hdG9taWNfZHVwbGljYXRlX3N0YXRlID0gZHJtX2F0b21p
Y19oZWxwZXJfY3J0Y19kdXBsaWNhdGVfc3RhdGUsCisJLmF0b21pY19kZXN0cm95X3N0YXRlID0g
ZHJtX2F0b21pY19oZWxwZXJfY3J0Y19kZXN0cm95X3N0YXRlLAorCS5lbmFibGVfdmJsYW5rID0g
a21iX2NydGNfZW5hYmxlX3ZibGFuaywKKwkuZGlzYWJsZV92YmxhbmsgPSBrbWJfY3J0Y19kaXNh
YmxlX3ZibGFuaywKK307CisKK3N0YXRpYyB2b2lkIGttYl9jcnRjX21vZGVfc2V0X25vZmIoc3Ry
dWN0IGRybV9jcnRjICpjcnRjKQoreworCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5k
ZXY7CisJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm0gPSAmY3J0Yy0+c3RhdGUtPmFkanVzdGVk
X21vZGU7CisJc3RydWN0IGttYl9jcnRjX3RpbWluZyB2bTsKKwlpbnQgdnN5bmNfc3RhcnRfb2Zm
c2V0OworCWludCB2c3luY19lbmRfb2Zmc2V0OworCXN0cnVjdCBrbWJfZHJtX3ByaXZhdGUgKmtt
YiA9IHRvX2ttYihkZXYpOworCXVuc2lnbmVkIGludCB2YWwgPSAwOworCisJLyogSW5pdGlhbGl6
ZSBtaXBpICovCisJa21iX2RzaV9od19pbml0KGRldiwgbSk7CisJZHJtX2luZm8oZGV2LAorCQkg
InZmcD0gJWQgdmJwPSAlZCB2c3ljX2xlbj0lZCBoZnA9JWQgaGJwPSVkIGhzeW5jX2xlbj0lZFxu
IiwKKwkJIG0tPmNydGNfdnN5bmNfc3RhcnQgLSBtLT5jcnRjX3ZkaXNwbGF5LAorCQkgbS0+Y3J0
Y192dG90YWwgLSBtLT5jcnRjX3ZzeW5jX2VuZCwKKwkJIG0tPmNydGNfdnN5bmNfZW5kIC0gbS0+
Y3J0Y192c3luY19zdGFydCwKKwkJIG0tPmNydGNfaHN5bmNfc3RhcnQgLSBtLT5jcnRjX2hkaXNw
bGF5LAorCQkgbS0+Y3J0Y19odG90YWwgLSBtLT5jcnRjX2hzeW5jX2VuZCwKKwkJIG0tPmNydGNf
aHN5bmNfZW5kIC0gbS0+Y3J0Y19oc3luY19zdGFydCk7CisJdmFsID0ga21iX3JlYWRfbGNkKGtt
YiwgTENEX0lOVF9FTkFCTEUpOworCWttYl9jbHJfYml0bWFza19sY2Qoa21iLCBMQ0RfSU5UX0VO
QUJMRSwgdmFsKTsKKwlrbWJfc2V0X2JpdG1hc2tfbGNkKGttYiwgTENEX0lOVF9DTEVBUiwgfjB4
MCk7CisJdm0udmZyb250X3BvcmNoID0gMjsKKwl2bS52YmFja19wb3JjaCA9IDI7CisJdm0udnN5
bmNfbGVuID0gODsKKwl2bS5oZnJvbnRfcG9yY2ggPSAwOworCXZtLmhiYWNrX3BvcmNoID0gMDsK
Kwl2bS5oc3luY19sZW4gPSAyODsKKworCXZzeW5jX3N0YXJ0X29mZnNldCA9ICBtLT5jcnRjX3Zz
eW5jX3N0YXJ0IC0gIG0tPmNydGNfaHN5bmNfc3RhcnQ7CisJdnN5bmNfZW5kX29mZnNldCA9ICBt
LT5jcnRjX3ZzeW5jX2VuZCAtIG0tPmNydGNfaHN5bmNfZW5kOworCisJZHJtX2RiZyhkZXYsICIl
cyA6ICVkYWN0aXZlIGhlaWdodD0gJWQgdmJwPSVkIHZmcD0lZCB2c3luYy13PSVkIGgtYWN0aXZl
PSVkIGgtYnA9JWQgaC1mcD0lZCBoeXNuYy1sPSVkIiwKKwkJX19mdW5jX18sIF9fTElORV9fLAor
CQkJbS0+Y3J0Y192ZGlzcGxheSwgdm0udmJhY2tfcG9yY2gsIHZtLnZmcm9udF9wb3JjaCwKKwkJ
CXZtLnZzeW5jX2xlbiwgbS0+Y3J0Y19oZGlzcGxheSwgdm0uaGJhY2tfcG9yY2gsCisJCQl2bS5o
ZnJvbnRfcG9yY2gsIHZtLmhzeW5jX2xlbik7CisJa21iX3dyaXRlX2xjZChrbWIsIExDRF9WX0FD
VElWRUhFSUdIVCwKKwkJICAgICAgbS0+Y3J0Y192ZGlzcGxheSAtIDEpOworCWttYl93cml0ZV9s
Y2Qoa21iLCBMQ0RfVl9CQUNLUE9SQ0gsIHZtLnZiYWNrX3BvcmNoKTsKKwlrbWJfd3JpdGVfbGNk
KGttYiwgTENEX1ZfRlJPTlRQT1JDSCwgdm0udmZyb250X3BvcmNoKTsKKwlrbWJfd3JpdGVfbGNk
KGttYiwgTENEX1ZTWU5DX1dJRFRILCB2bS52c3luY19sZW4gLSAxKTsKKwlrbWJfd3JpdGVfbGNk
KGttYiwgTENEX0hfQUNUSVZFV0lEVEgsCisJCSAgICAgIG0tPmNydGNfaGRpc3BsYXkgLSAxKTsK
KwlrbWJfd3JpdGVfbGNkKGttYiwgTENEX0hfQkFDS1BPUkNILCB2bS5oYmFja19wb3JjaCk7CisJ
a21iX3dyaXRlX2xjZChrbWIsIExDRF9IX0ZST05UUE9SQ0gsIHZtLmhmcm9udF9wb3JjaCk7CisJ
a21iX3dyaXRlX2xjZChrbWIsIExDRF9IU1lOQ19XSURUSCwgdm0uaHN5bmNfbGVuIC0gMSk7CisJ
LyogVGhpcyBpcyBoYXJkY29kZWQgYXMgMCBpbiB0aGUgTXlyaWFkeCBjb2RlICovCisJa21iX3dy
aXRlX2xjZChrbWIsIExDRF9WU1lOQ19TVEFSVCwgMCk7CisJa21iX3dyaXRlX2xjZChrbWIsIExD
RF9WU1lOQ19FTkQsIDApOworCS8qIEJhY2sgZ3JvdW5kIGNvbG9yICovCisJa21iX3dyaXRlX2xj
ZChrbWIsIExDRF9CR19DT0xPVVJfTFMsIDB4NCk7CisJaWYgKG0tPmZsYWdzID09IERSTV9NT0RF
X0ZMQUdfSU5URVJMQUNFKSB7CisJCWttYl93cml0ZV9sY2Qoa21iLAorCQkJICAgICAgTENEX1ZT
WU5DX1dJRFRIX0VWRU4sIHZtLnZzeW5jX2xlbiAtIDEpOworCQlrbWJfd3JpdGVfbGNkKGttYiwK
KwkJCSAgICAgIExDRF9WX0JBQ0tQT1JDSF9FVkVOLCB2bS52YmFja19wb3JjaCk7CisJCWttYl93
cml0ZV9sY2Qoa21iLAorCQkJICAgICAgTENEX1ZfRlJPTlRQT1JDSF9FVkVOLCB2bS52ZnJvbnRf
cG9yY2gpOworCQlrbWJfd3JpdGVfbGNkKGttYiwgTENEX1ZfQUNUSVZFSEVJR0hUX0VWRU4sCisJ
CQkgICAgICBtLT5jcnRjX3ZkaXNwbGF5IC0gMSk7CisJCS8qIFRoaXMgaXMgaGFyZGNvZGVkIGFz
IDEwIGluIHRoZSBNeXJpYWR4IGNvZGUgKi8KKwkJa21iX3dyaXRlX2xjZChrbWIsIExDRF9WU1lO
Q19TVEFSVF9FVkVOLCAxMCk7CisJCWttYl93cml0ZV9sY2Qoa21iLCBMQ0RfVlNZTkNfRU5EX0VW
RU4sIDEwKTsKKwl9CisJa21iX3dyaXRlX2xjZChrbWIsIExDRF9USU1JTkdfR0VOX1RSSUcsIEVO
QUJMRSk7CisJa21iX3NldF9iaXRtYXNrX2xjZChrbWIsIExDRF9DT05UUk9MLCBMQ0RfQ1RSTF9F
TkFCTEUpOworCWttYl9zZXRfYml0bWFza19sY2Qoa21iLCBMQ0RfSU5UX0VOQUJMRSwgdmFsKTsK
K30KKworc3RhdGljIHZvaWQga21iX2NydGNfYXRvbWljX2VuYWJsZShzdHJ1Y3QgZHJtX2NydGMg
KmNydGMsCisJCQkJICAgc3RydWN0IGRybV9jcnRjX3N0YXRlICpvbGRfc3RhdGUpCit7CisJc3Ry
dWN0IGttYl9kcm1fcHJpdmF0ZSAqbGNkID0gY3J0Y190b19rbWJfcHJpdihjcnRjKTsKKworCWNs
a19wcmVwYXJlX2VuYWJsZShsY2QtPmNsayk7CisJa21iX2NydGNfbW9kZV9zZXRfbm9mYihjcnRj
KTsKKwlkcm1fY3J0Y192Ymxhbmtfb24oY3J0Yyk7Cit9CisKK3N0YXRpYyB2b2lkIGttYl9jcnRj
X2F0b21pY19kaXNhYmxlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKKwkJCQkgICAgc3RydWN0IGRy
bV9jcnRjX3N0YXRlICpvbGRfc3RhdGUpCit7CisJc3RydWN0IGttYl9kcm1fcHJpdmF0ZSAqbGNk
ID0gY3J0Y190b19rbWJfcHJpdihjcnRjKTsKKworCS8qIEFsd2F5cyBkaXNhYmxlIHBsYW5lcyBv
biB0aGUgQ1JUQyB0aGF0IGlzIGJlaW5nIHR1cm5lZCBvZmYgKi8KKwlkcm1fYXRvbWljX2hlbHBl
cl9kaXNhYmxlX3BsYW5lc19vbl9jcnRjKG9sZF9zdGF0ZSwgZmFsc2UpOworCisJZHJtX2NydGNf
dmJsYW5rX29mZihjcnRjKTsKKwljbGtfZGlzYWJsZV91bnByZXBhcmUobGNkLT5jbGspOworfQor
CitzdGF0aWMgdm9pZCBrbWJfY3J0Y19hdG9taWNfYmVnaW4oc3RydWN0IGRybV9jcnRjICpjcnRj
LAorCQkJCSAgc3RydWN0IGRybV9jcnRjX3N0YXRlICpzdGF0ZSkKK3sKKwlzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2ID0gY3J0Yy0+ZGV2OworCXN0cnVjdCBrbWJfZHJtX3ByaXZhdGUgKmttYiA9IHRv
X2ttYihkZXYpOworCisJa21iX2Nscl9iaXRtYXNrX2xjZChrbWIsIExDRF9JTlRfRU5BQkxFLAor
CQkJICAgIExDRF9JTlRfVkVSVF9DT01QKTsKK30KKworc3RhdGljIHZvaWQga21iX2NydGNfYXRv
bWljX2ZsdXNoKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKKwkJCQkgIHN0cnVjdCBkcm1fY3J0Y19z
dGF0ZSAqc3RhdGUpCit7CisJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmRldjsKKwlz
dHJ1Y3Qga21iX2RybV9wcml2YXRlICprbWIgPSB0b19rbWIoZGV2KTsKKworCWttYl9zZXRfYml0
bWFza19sY2Qoa21iLCBMQ0RfSU5UX0VOQUJMRSwKKwkJCSAgICBMQ0RfSU5UX1ZFUlRfQ09NUCk7
CisKKwlzcGluX2xvY2tfaXJxKCZjcnRjLT5kZXYtPmV2ZW50X2xvY2spOworCWlmIChjcnRjLT5z
dGF0ZS0+ZXZlbnQpCisJCWRybV9jcnRjX3NlbmRfdmJsYW5rX2V2ZW50KGNydGMsIGNydGMtPnN0
YXRlLT5ldmVudCk7CisJY3J0Yy0+c3RhdGUtPmV2ZW50ID0gTlVMTDsKKwlzcGluX3VubG9ja19p
cnEoJmNydGMtPmRldi0+ZXZlbnRfbG9jayk7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJt
X2NydGNfaGVscGVyX2Z1bmNzIGttYl9jcnRjX2hlbHBlcl9mdW5jcyA9IHsKKwkuYXRvbWljX2Jl
Z2luID0ga21iX2NydGNfYXRvbWljX2JlZ2luLAorCS5hdG9taWNfZW5hYmxlID0ga21iX2NydGNf
YXRvbWljX2VuYWJsZSwKKwkuYXRvbWljX2Rpc2FibGUgPSBrbWJfY3J0Y19hdG9taWNfZGlzYWJs
ZSwKKwkuYXRvbWljX2ZsdXNoID0ga21iX2NydGNfYXRvbWljX2ZsdXNoLAorfTsKKworaW50IGtt
Yl9zZXR1cF9jcnRjKHN0cnVjdCBkcm1fZGV2aWNlICpkcm0pCit7CisJc3RydWN0IGttYl9kcm1f
cHJpdmF0ZSAqa21iID0gdG9fa21iKGRybSk7CisJc3RydWN0IGttYl9wbGFuZSAqcHJpbWFyeTsK
KwlpbnQgcmV0OworCisJcHJpbWFyeSA9IGttYl9wbGFuZV9pbml0KGRybSk7CisJaWYgKElTX0VS
UihwcmltYXJ5KSkKKwkJcmV0dXJuIFBUUl9FUlIocHJpbWFyeSk7CisKKwlyZXQgPSBkcm1fY3J0
Y19pbml0X3dpdGhfcGxhbmVzKGRybSwgJmttYi0+Y3J0YywgJnByaW1hcnktPmJhc2VfcGxhbmUs
CisJCQkJCU5VTEwsICZrbWJfY3J0Y19mdW5jcywgTlVMTCk7CisJaWYgKHJldCkgeworCQlrbWJf
cGxhbmVfZGVzdHJveSgmcHJpbWFyeS0+YmFzZV9wbGFuZSk7CisJCXJldHVybiByZXQ7CisJfQor
CisJZHJtX2NydGNfaGVscGVyX2FkZCgma21iLT5jcnRjLCAma21iX2NydGNfaGVscGVyX2Z1bmNz
KTsKKwlyZXR1cm4gMDsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9rbWIva21iX2Ny
dGMuaCBiL2RyaXZlcnMvZ3B1L2RybS9rbWIva21iX2NydGMuaApuZXcgZmlsZSBtb2RlIDEwMDY0
NAppbmRleCAwMDAwMDAwLi5kMzYzMDY2Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2ttYi9rbWJfY3J0Yy5oCkBAIC0wLDAgKzEsMzYgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVu
dGlmaWVyOiBHUEwtMi4wLW9ubHkKKyAqCisgKiBDb3B5cmlnaHQgwqkgMjAxOC0yMDIwIEludGVs
IENvcnBvcmF0aW9uCisgKi8KKworI2lmbmRlZiBfX0tNQl9DUlRDX0hfXworI2RlZmluZSBfX0tN
Ql9DUlRDX0hfXworCisjaW5jbHVkZSA8bGludXgvY2xrLmg+CisjaW5jbHVkZSA8bGludXgvb2Zf
Z3JhcGguaD4KKyNpbmNsdWRlIDxsaW51eC9wbGF0Zm9ybV9kYXRhL3NpbXBsZWZiLmg+CisjaW5j
bHVkZSA8dmlkZW8vdmlkZW9tb2RlLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9kZWJ1Z2ZzLmg+Cisj
aW5jbHVkZSA8ZHJtL2RybV9kZXZpY2UuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2Rydi5oPgorI2lu
Y2x1ZGUgPGRybS9kcm1fZmJfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9maWxlLmg+Cisj
aW5jbHVkZSA8ZHJtL2RybV9mb3VyY2MuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3ByaW50Lmg+Cisj
aW5jbHVkZSA8ZHJtL2RybV9wcm9iZV9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3ZibGFu
ay5oPgorI2luY2x1ZGUgPGxpbnV4L211dGV4Lmg+CisjaW5jbHVkZSA8bGludXgvcGxhdGZvcm1f
ZGV2aWNlLmg+CisjaW5jbHVkZSA8bGludXgvd2FpdC5oPgorI2luY2x1ZGUgImttYl9kcnYuaCIK
Kworc3RydWN0IGttYl9jcnRjX3RpbWluZyB7CisJdTMyIHZmcm9udF9wb3JjaDsKKwl1MzIgdmJh
Y2tfcG9yY2g7CisJdTMyIHZzeW5jX2xlbjsKKwl1MzIgaGZyb250X3BvcmNoOworCXUzMiBoYmFj
a19wb3JjaDsKKwl1MzIgaHN5bmNfbGVuOworfTsKKworI2VuZGlmIC8qIF9fS01CX0NSVENfSF9f
ICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0va21iL2ttYl9kcnYuYyBiL2RyaXZlcnMv
Z3B1L2RybS9rbWIva21iX2Rydi5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAu
LjI1NTA0OGYKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0va21iL2ttYl9kcnYu
YwpAQCAtMCwwICsxLDcyNSBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAt
b25seQorLyoKKyAqIENvcHlyaWdodCDCqSAyMDE4LTIwMjAgSW50ZWwgQ29ycG9yYXRpb24KKyAq
LworCisjaW5jbHVkZSA8bGludXgvY2xrLmg+CisjaW5jbHVkZSA8bGludXgvY29uc29sZS5oPgor
I2luY2x1ZGUgPGxpbnV4L2xpc3QuaD4KKyNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KKyNpbmNs
dWRlIDxsaW51eC9vZl9ncmFwaC5oPgorI2luY2x1ZGUgPGxpbnV4L29mX3Jlc2VydmVkX21lbS5o
PgorI2luY2x1ZGUgPGxpbnV4L3BtX3J1bnRpbWUuaD4KKyNpbmNsdWRlIDxsaW51eC9zcGlubG9j
ay5oPgorCisjaW5jbHVkZSA8ZHJtL2RybS5oPgorI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljLmg+
CisjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9j
cnRjLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9mYl9jbWFfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJt
L2RybV9mYl9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2dlbV9jbWFfaGVscGVyLmg+Cisj
aW5jbHVkZSA8ZHJtL2RybV9nZW1fZnJhbWVidWZmZXJfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJt
L2RybV9pb2N0bC5oPgorI2luY2x1ZGUgPGRybS9kcm1faXJxLmg+CisjaW5jbHVkZSA8ZHJtL2Ry
bV9vZi5oPgorI2luY2x1ZGUgPGRybS9kcm1fcHJvYmVfaGVscGVyLmg+CisKKyNpbmNsdWRlICJr
bWJfY3J0Yy5oIgorI2luY2x1ZGUgImttYl9kcnYuaCIKKyNpbmNsdWRlICJrbWJfZHNpLmgiCisj
aW5jbHVkZSAia21iX3BsYW5lLmgiCisjaW5jbHVkZSAia21iX3JlZ3MuaCIKKworLyogI2RlZmlu
ZSBERUJVRyAqLworCitpbnQga21iX3VuZGVyX2Zsb3cgPSAwLCBrbWJfZmx1c2hfZG9uZSA9IDAs
IGxheWVyX25vID0gMDsKK3N0YXRpYyBzdHJ1Y3Qga21iX2Nsb2NrIGttYl9jbGs7CisKK3N0YXRp
YyBzdHJ1Y3QgZHJtX2JyaWRnZSAqYWR2X2JyaWRnZTsKKworaW50IGttYl9kaXNwbGF5X2Nsa19l
bmFibGUoc3RydWN0IGttYl9kcm1fcHJpdmF0ZSAqa21iKQoreworCWludCByZXQgPSAwOworCisJ
cmV0ID0gY2xrX3ByZXBhcmVfZW5hYmxlKGttYl9jbGsuY2xrX2xjZCk7CisJaWYgKHJldCkgewor
CQlkcm1fZXJyKCZrbWItPmRybSwgIkZhaWxlZCB0byBlbmFibGUgTENEIGNsb2NrOiAlZFxuIiwg
cmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXQgPSBjbGtfcHJlcGFyZV9lbmFibGUoa21i
X2Nsay5jbGtfbWlwaSk7CisJaWYgKHJldCkgeworCQlkcm1fZXJyKCZrbWItPmRybSwgIkZhaWxl
ZCB0byBlbmFibGUgTUlQSSBjbG9jazogJWRcbiIsIHJldCk7CisJCXJldHVybiByZXQ7CisJfQor
CisJcmV0ID0gY2xrX3ByZXBhcmVfZW5hYmxlKGttYl9jbGsuY2xrX21pcGlfZWNmZyk7CisJaWYg
KHJldCkgeworCQlkcm1fZXJyKCZrbWItPmRybSwKKwkJCSJGYWlsZWQgdG8gZW5hYmxlIE1JUElf
RUNGRyBjbG9jazogJWRcbiIsIHJldCk7CisJCXJldHVybiByZXQ7CisJfQorCisJcmV0ID0gY2xr
X3ByZXBhcmVfZW5hYmxlKGttYl9jbGsuY2xrX21pcGlfY2ZnKTsKKwlpZiAocmV0KSB7CisJCWRy
bV9lcnIoJmttYi0+ZHJtLAorCQkJIkZhaWxlZCB0byBlbmFibGUgTUlQSV9DRkcgY2xvY2s6ICVk
XG4iLCByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKwlEUk1fSU5GTygiU1VDQ0VTUyA6IGVuYWJs
ZWQgTENEIE1JUEkgY2xvY2tzXG4iKTsKKwlyZXR1cm4gMDsKK30KKworaW50IGttYl9pbml0aWFs
aXplX2Nsb2NrcyhzdHJ1Y3Qga21iX2RybV9wcml2YXRlICprbWIsIHN0cnVjdCBkZXZpY2UgKmRl
dikKK3sKKwlzdHJ1Y3QgZGV2aWNlX25vZGUgKnZwdV9kZXY7CisJdW5zaWduZWQgbG9uZyBjbGs7
CisJaW50IHJldCA9IDA7CisKKwlrbWJfY2xrLmNsa19sY2QgPSBjbGtfZ2V0KGRldiwgImNsa19s
Y2QiKTsKKwlpZiAoSVNfRVJSKGttYl9jbGsuY2xrX2xjZCkpIHsKKwkJZHJtX2Vycigma21iLT5k
cm0sICJjbGtfZ2V0KCkgZmFpbGVkIGNsa19sY2RcbiIpOworCQlyZXR1cm4gUFRSX0VSUihrbWJf
Y2xrLmNsa19sY2QpOworCX0KKworCWttYl9jbGsuY2xrX21pcGkgPSBjbGtfZ2V0KGRldiwgImNs
a19taXBpIik7CisJaWYgKElTX0VSUihrbWJfY2xrLmNsa19taXBpKSkgeworCQlkcm1fZXJyKCZr
bWItPmRybSwgImNsa19nZXQoKSBmYWlsZWQgY2xrX21pcGlcbiIpOworCQlyZXR1cm4gUFRSX0VS
UihrbWJfY2xrLmNsa19taXBpKTsKKwl9CisKKwlrbWJfY2xrLmNsa19taXBpX2VjZmcgPSBjbGtf
Z2V0KGRldiwgImNsa19taXBpX2VjZmciKTsKKwlpZiAoSVNfRVJSKGttYl9jbGsuY2xrX21pcGlf
ZWNmZykpIHsKKwkJZHJtX2Vycigma21iLT5kcm0sICJjbGtfZ2V0KCkgZmFpbGVkIGNsa19taXBp
X2VjZmdcbiIpOworCQlyZXR1cm4gUFRSX0VSUihrbWJfY2xrLmNsa19taXBpX2VjZmcpOworCX0K
KworCWttYl9jbGsuY2xrX21pcGlfY2ZnID0gY2xrX2dldChkZXYsICJjbGtfbWlwaV9jZmciKTsK
KwlpZiAoSVNfRVJSKGttYl9jbGsuY2xrX21pcGlfY2ZnKSkgeworCQlkcm1fZXJyKCZrbWItPmRy
bSwgImNsa19nZXQoKSBmYWlsZWQgY2xrX21pcGlfY2ZnXG4iKTsKKwkJcmV0dXJuIFBUUl9FUlIo
a21iX2Nsay5jbGtfbWlwaV9jZmcpOworCX0KKwl2cHVfZGV2ID0gb2ZfZmluZF9ub2RlX2J5X3Bh
dGgoIi9zb2MvdnB1LWlwYyIpOworCWttYl9jbGsuY2xrX3BsbDAgPSBvZl9jbGtfZ2V0X2J5X25h
bWUodnB1X2RldiwgInBsbF8wX291dF8wIik7CisJaWYgKElTX0VSUihrbWJfY2xrLmNsa19wbGww
KSkgeworCQlkcm1fZXJyKCZrbWItPmRybSwgImNsa19nZXQoKSBmYWlsZWQgY2xrX3BsbDAgIik7
CisJCXJldHVybiBQVFJfRVJSKGttYl9jbGsuY2xrX3BsbDApOworCX0KKwlrbWItPnN5c19jbGtf
bWh6ID0gY2xrX2dldF9yYXRlKGttYl9jbGsuY2xrX3BsbDApIC8gMTAwMDAwMDsKKwlkcm1faW5m
bygma21iLT5kcm0sICJzeXN0ZW0gY2xrID0gJWQgTWh6Iiwga21iLT5zeXNfY2xrX21oeik7CisK
KwkvKiBTZXQgTENEIGNsb2NrIHRvIDIwMCBNaHogKi8KKwljbGtfc2V0X3JhdGUoa21iX2Nsay5j
bGtfbGNkLCBLTUJfTENEX0RFRkFVTFRfQ0xLKTsKKwlpZiAoY2xrX2dldF9yYXRlKGttYl9jbGsu
Y2xrX2xjZCkgIT0gS01CX0xDRF9ERUZBVUxUX0NMSykgeworCQlkcm1fZXJyKCZrbWItPmRybSwg
ImZhaWxlZCB0byBzZXQgdG8gY2xrX2xjZCB0byAlZFxuIiwKKwkJCUtNQl9MQ0RfREVGQVVMVF9D
TEspOworCQlyZXR1cm4gLTE7CisJfQorCWRybV9pbmZvKCZrbWItPmRybSwgImNsa19sY2QgPSAl
bGRcbiIsIGNsa19nZXRfcmF0ZShrbWJfY2xrLmNsa19sY2QpKTsKKworCS8qIFNldCBNSVBJIGNs
b2NrIHRvIDI0IE1oeiAqLworCWNsa19zZXRfcmF0ZShrbWJfY2xrLmNsa19taXBpLCBLTUJfTUlQ
SV9ERUZBVUxUX0NMSyk7CisJaWYgKGNsa19nZXRfcmF0ZShrbWJfY2xrLmNsa19taXBpKSAhPSBL
TUJfTUlQSV9ERUZBVUxUX0NMSykgeworCQlkcm1fZXJyKCZrbWItPmRybSwgImZhaWxlZCB0byBz
ZXQgdG8gY2xrX21pcGkgdG8gJWRcbiIsCisJCQlLTUJfTUlQSV9ERUZBVUxUX0NMSyk7CisJCXJl
dHVybiAtMTsKKwl9CisJZHJtX2luZm8oJmttYi0+ZHJtLCAiY2xrX21pcGkgPSAlbGRcbiIsIGNs
a19nZXRfcmF0ZShrbWJfY2xrLmNsa19taXBpKSk7CisKKwljbGsgPSBjbGtfZ2V0X3JhdGUoa21i
X2Nsay5jbGtfbWlwaV9lY2ZnKTsKKwlpZiAoY2xrICE9IEtNQl9NSVBJX0RFRkFVTFRfQ0ZHX0NM
SykgeworCQkvKiBTZXQgTUlQSV9FQ0ZHIGNsb2NrIHRvIDI0IE1oeiAqLworCQljbGtfc2V0X3Jh
dGUoa21iX2Nsay5jbGtfbWlwaV9lY2ZnLCBLTUJfTUlQSV9ERUZBVUxUX0NGR19DTEspOworCQlj
bGsgPSBjbGtfZ2V0X3JhdGUoa21iX2Nsay5jbGtfbWlwaV9lY2ZnKTsKKwkJaWYgKGNsayAhPSBL
TUJfTUlQSV9ERUZBVUxUX0NGR19DTEspIHsKKwkJCWRybV9lcnIoJmttYi0+ZHJtLAorCQkJCSJm
YWlsZWQgdG8gc2V0IHRvIGNsa19taXBpX2VjZmcgdG8gJWRcbiIsCisJCQkJIEtNQl9NSVBJX0RF
RkFVTFRfQ0ZHX0NMSyk7CisJCQlyZXR1cm4gLTE7CisJCX0KKworCQlkcm1faW5mbygma21iLT5k
cm0sICJjbGtfbWlwaV9lY2ZnIGFmdGVyIHNldCA9ICVsZFxuIiwgY2xrKTsKKwl9CisKKwljbGsg
PSBjbGtfZ2V0X3JhdGUoa21iX2Nsay5jbGtfbWlwaV9jZmcpOworCWlmIChjbGsgIT0gS01CX01J
UElfREVGQVVMVF9DRkdfQ0xLKSB7CisJCS8qIFNldCBNSVBJX0NGRyBjbG9jayB0byAyNCBNaHog
Ki8KKwkJY2xrX3NldF9yYXRlKGttYl9jbGsuY2xrX21pcGlfY2ZnLCAyNDAwMDAwMCk7CisJCWNs
ayA9IGNsa19nZXRfcmF0ZShrbWJfY2xrLmNsa19taXBpX2NmZyk7CisJCWlmIChjbGsgIT0gS01C
X01JUElfREVGQVVMVF9DRkdfQ0xLKSB7CisJCQlkcm1fZXJyKCZrbWItPmRybSwKKwkJCQkiZmFp
bGVkIHRvIHNldCBjbGtfbWlwaV9jZmcgdG8gJWRcbiIsCisJCQkJICBLTUJfTUlQSV9ERUZBVUxU
X0NGR19DTEspOworCQkJcmV0dXJuIC0xOworCQl9CisJCWRybV9pbmZvKCZrbWItPmRybSwKKwkJ
CSAiR2V0IGNsa19taXBpX2NmZyBhZnRlciBzZXQgPSAlbGRcbiIsIGNsayk7CisJfQorCisJcmV0
ID0ga21iX2Rpc3BsYXlfY2xrX2VuYWJsZShrbWIpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7
CisKKwkvKiBFbmFibGUgTVNTX0NBTV9DTEtfQ1RSTCBmb3IgTUlQSSBUWCBhbmQgTENEICovCisJ
a21iX3NldF9iaXRtYXNrX21zc2NhbShrbWIsIE1TU19DQU1fQ0xLX0NUUkwsIDB4MWZmZik7CisJ
a21iX3NldF9iaXRtYXNrX21zc2NhbShrbWIsIE1TU19DQU1fUlNUTl9DVFJMLCAweGZmZmZmZmZm
KTsKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBrbWJfZGlzcGxheV9jbGtfZGlzYWJsZSh2
b2lkKQoreworCWlmIChrbWJfY2xrLmNsa19sY2QpCisJCWNsa19kaXNhYmxlX3VucHJlcGFyZShr
bWJfY2xrLmNsa19sY2QpOworCWlmIChrbWJfY2xrLmNsa19taXBpKQorCQljbGtfZGlzYWJsZV91
bnByZXBhcmUoa21iX2Nsay5jbGtfbWlwaSk7CisJaWYgKGttYl9jbGsuY2xrX21pcGlfZWNmZykK
KwkJY2xrX2Rpc2FibGVfdW5wcmVwYXJlKGttYl9jbGsuY2xrX21pcGlfZWNmZyk7CisJaWYgKGtt
Yl9jbGsuY2xrX21pcGlfY2ZnKQorCQljbGtfZGlzYWJsZV91bnByZXBhcmUoa21iX2Nsay5jbGtf
bWlwaV9jZmcpOworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBfX2lvbWVtICprbWJfbWFw
X21taW8oc3RydWN0IGRldmljZSAqZGV2LCBjaGFyICpuYW1lKQoreworCXN0cnVjdCByZXNvdXJj
ZSAqcmVzOworCXN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYgPSB0b19wbGF0Zm9ybV9kZXZp
Y2UoZGV2KTsKKwl2b2lkIF9faW9tZW0gKm1lbTsKKworCXJlcyA9IHBsYXRmb3JtX2dldF9yZXNv
dXJjZV9ieW5hbWUocGRldiwgSU9SRVNPVVJDRV9NRU0sIG5hbWUpOworCWlmICghcmVzKSB7CisJ
CURSTV9FUlJPUigiZmFpbGVkIHRvIGdldCByZXNvdXJjZSBmb3IgJXNcbiIsIG5hbWUpOworCQly
ZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKKwl9CisJbWVtID0gZGV2bV9pb3JlbWFwX3Jlc291cmNl
KGRldiwgcmVzKTsKKwlpZiAoSVNfRVJSKG1lbSkpCisJCURSTV9FUlJPUigiZmFpbGVkIHRvIGlv
cmVtYXAgJXMgcmVnaXN0ZXJzXG4iLCBuYW1lKTsKKwlyZXR1cm4gbWVtOworfQorCitzdGF0aWMg
aW50IGttYl9sb2FkKHN0cnVjdCBkcm1fZGV2aWNlICpkcm0sIHVuc2lnbmVkIGxvbmcgZmxhZ3Mp
Cit7CisJc3RydWN0IGttYl9kcm1fcHJpdmF0ZSAqa21iID0gdG9fa21iKGRybSk7CisJc3RydWN0
IHBsYXRmb3JtX2RldmljZSAqcGRldiA9IHRvX3BsYXRmb3JtX2RldmljZShkcm0tPmRldik7CisJ
aW50IGlycV9sY2Q7CisJaW50IHJldCA9IDA7CisKKwkvKiBNYXAgTENEIE1NSU8gcmVnaXN0ZXJz
ICovCisJa21iLT5sY2RfbW1pbyA9IGttYl9tYXBfbW1pbyhkcm0tPmRldiwgImxjZF9yZWdzIik7
CisJaWYgKElTX0VSUihrbWItPmxjZF9tbWlvKSkgeworCQlkcm1fZXJyKCZrbWItPmRybSwgImZh
aWxlZCB0byBtYXAgTENEIHJlZ2lzdGVyc1xuIik7CisJCXJldHVybiAtRU5PTUVNOworCX0KKwor
CS8qIE1hcCBNSVBJIE1NSU8gcmVnaXN0ZXJzICovCisJa21iLT5taXBpX21taW8gPSBrbWJfbWFw
X21taW8oZHJtLT5kZXYsICJtaXBpX3JlZ3MiKTsKKwlpZiAoSVNfRVJSKGttYi0+bWlwaV9tbWlv
KSkgeworCQlkcm1fZXJyKCZrbWItPmRybSwgImZhaWxlZCB0byBtYXAgTUlQSSByZWdpc3RlcnNc
biIpOworCQlpb3VubWFwKGttYi0+bGNkX21taW8pOworCQlyZXR1cm4gLUVOT01FTTsKKwl9CisK
KwkvKiBUaGlzIGlzIG9ubHkgZm9yIE1JUElfVFhfTVNTX0xDRF9NSVBJX0NGRyBhbmQKKwkgKiBN
U1NfQ0FNX0NMS19DVFJMIHJlZ2lzdGVyCisJICovCisJa21iLT5tc3NjYW1fbW1pbyA9IGttYl9t
YXBfbW1pbyhkcm0tPmRldiwgIm1zc2NhbV9yZWdzIik7CisJaWYgKElTX0VSUihrbWItPm1zc2Nh
bV9tbWlvKSkgeworCQlkcm1fZXJyKCZrbWItPmRybSwgImZhaWxlZCB0byBtYXAgTVNTQ0FNIHJl
Z2lzdGVyc1xuIik7CisJCWlvdW5tYXAoa21iLT5sY2RfbW1pbyk7CisJCWlvdW5tYXAoa21iLT5t
aXBpX21taW8pOworCQlyZXR1cm4gLUVOT01FTTsKKwl9CisKKwlpZiAoSVNfRVJSKGttYi0+bXNz
Y2FtX21taW8pKSB7CisJCWRybV9lcnIoJmttYi0+ZHJtLCAiZmFpbGVkIHRvIG1hcCBNU1NDQU0g
cmVnaXN0ZXJzXG4iKTsKKwkJaW91bm1hcChrbWItPmxjZF9tbWlvKTsKKwkJaW91bm1hcChrbWIt
Pm1pcGlfbW1pbyk7CisJCXJldHVybiAtRU5PTUVNOworCX0KKwkvKiBFbmFibGUgZGlzcGxheSBj
bG9ja3MgKi8KKwlrbWJfaW5pdGlhbGl6ZV9jbG9ja3Moa21iLCAmcGRldi0+ZGV2KTsKKworCS8q
IFJlZ2lzdGVyIGlycXMgaGVyZSAtIHNlY3Rpb24gMTcuMyBpbiBkYXRhYm9vaworCSAqIGxpc3Rz
IExDRCBhdCA3OSBhbmQgODIgZm9yIE1JUEkgdW5kZXIgTVNTIENQVSAtCisJICogZmlybXdhcmUg
aGFzIHJlZGlyZWN0ZWQgNzkgdG8gQTUzIElSUSAzMworCSAqLworCisJLyogQWxsb2NhdGUgTENE
IGludGVycnVwdCByZXNvdXJjZXMsIGVuYWJsZSBpbnRlcnJ1cHQgbGluZSwKKwkgKiBhbmQgc2V0
dXAgSVJRIGhhbmRsaW5nCisJICovCisJaXJxX2xjZCA9IHBsYXRmb3JtX2dldF9pcnFfYnluYW1l
KHBkZXYsICJpcnFfbGNkIik7CisJaWYgKGlycV9sY2QgPCAwKSB7CisJCWRybV9lcnIoJmttYi0+
ZHJtLCAiaXJxX2xjZCBub3QgZm91bmQiKTsKKwkJZ290byBzZXR1cF9mYWlsOworCX0KKworCS8q
IEdldCB0aGUgb3B0aW9uYWwgZnJhbWVidWZmZXIgbWVtb3J5IHJlc291cmNlICovCisJcmV0ID0g
b2ZfcmVzZXJ2ZWRfbWVtX2RldmljZV9pbml0KGRybS0+ZGV2KTsKKwlpZiAocmV0ICYmIHJldCAh
PSAtRU5PREVWKQorCQlyZXR1cm4gcmV0OworCisJc3Bpbl9sb2NrX2luaXQoJmttYi0+aXJxX2xv
Y2spOworCisJcmV0ID0ga21iX3NldHVwX2NydGMoZHJtKTsKKwlpZiAocmV0IDwgMCkgeworCQlk
cm1fZXJyKCZrbWItPmRybSwgImZhaWxlZCB0byBjcmVhdGUgY3J0Y1xuIik7CisJCWdvdG8gc2V0
dXBfZmFpbDsKKwl9CisKKwkvKiBJbml0aWFsaXplIE1JUEkgRFNJICovCisJcmV0ID0ga21iX2Rz
aV9pbml0KGRybSwgYWR2X2JyaWRnZSk7CisJaWYgKHJldCkgeworCQlkcm1fZXJyKCZrbWItPmRy
bSwgImZhaWxlZCB0byBpbml0aWFsaXplIERTSVxuIik7CisJCWdvdG8gc2V0dXBfZmFpbDsKKwl9
CisKKwlyZXQgPSBkcm1faXJxX2luc3RhbGwoZHJtLCBpcnFfbGNkKTsKKwlpZiAocmV0IDwgMCkg
eworCQlkcm1fZXJyKCZrbWItPmRybSwgImZhaWxlZCB0byBpbnN0YWxsIElSUSBoYW5kbGVyXG4i
KTsKKwkJZ290byBpcnFfZmFpbDsKKwl9CisKKwlrbWItPmlycV9sY2QgPSBpcnFfbGNkOworCisJ
cmV0dXJuIDA7CisKKyBpcnFfZmFpbDoKKwlkcm1fY3J0Y19jbGVhbnVwKCZrbWItPmNydGMpOwor
IHNldHVwX2ZhaWw6CisJb2ZfcmVzZXJ2ZWRfbWVtX2RldmljZV9yZWxlYXNlKGRybS0+ZGV2KTsK
KworCXJldHVybiByZXQ7Cit9CisKK2ludCBrbWJfYXRvbWljX2hlbHBlcl9jaGVjayhzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2LAorCQkJICAgIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkK
K3sKKwlpZiAoIXN0YXRlKQorCQlyZXR1cm4gMDsKKworCXJldHVybiBkcm1fYXRvbWljX2hlbHBl
cl9jaGVjayhkZXYsIHN0YXRlKTsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fbW9kZV9j
b25maWdfZnVuY3Mga21iX21vZGVfY29uZmlnX2Z1bmNzID0geworCS5mYl9jcmVhdGUgPSBkcm1f
Z2VtX2ZiX2NyZWF0ZSwKKwkuYXRvbWljX2NoZWNrID0ga21iX2F0b21pY19oZWxwZXJfY2hlY2ss
CisJLmF0b21pY19jb21taXQgPSBkcm1fYXRvbWljX2hlbHBlcl9jb21taXQsCit9OworCitzdGF0
aWMgaW50IGttYl9zZXR1cF9tb2RlX2NvbmZpZyhzdHJ1Y3QgZHJtX2RldmljZSAqZHJtKQorewor
CWludCByZXQ7CisKKwlyZXQgPSBkcm1tX21vZGVfY29uZmlnX2luaXQoZHJtKTsKKwlpZiAocmV0
KQorCQlyZXR1cm4gcmV0OworCWRybS0+bW9kZV9jb25maWcubWluX3dpZHRoID0gS01CX01JTl9X
SURUSDsKKwlkcm0tPm1vZGVfY29uZmlnLm1pbl9oZWlnaHQgPSBLTUJfTUlOX0hFSUdIVDsKKwlk
cm0tPm1vZGVfY29uZmlnLm1heF93aWR0aCA9IEtNQl9NQVhfV0lEVEg7CisJZHJtLT5tb2RlX2Nv
bmZpZy5tYXhfaGVpZ2h0ID0gS01CX01BWF9IRUlHSFQ7CisJZHJtLT5tb2RlX2NvbmZpZy5mdW5j
cyA9ICZrbWJfbW9kZV9jb25maWdfZnVuY3M7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpcnFy
ZXR1cm5fdCBoYW5kbGVfbGNkX2lycShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQoreworCXVuc2ln
bmVkIGxvbmcgc3RhdHVzLCB2YWwsIHZhbDE7CisJaW50IHBsYW5lX2lkLCBkbWEwX3N0YXRlLCBk
bWExX3N0YXRlOworCXN0cnVjdCBrbWJfZHJtX3ByaXZhdGUgKmttYiA9IHRvX2ttYihkZXYpOwor
CisJc3RhdHVzID0ga21iX3JlYWRfbGNkKGttYiwgTENEX0lOVF9TVEFUVVMpOworCisJaWYgKHN0
YXR1cyAmIExDRF9JTlRfRU9GKSB7CisJCWttYl93cml0ZV9sY2Qoa21iLCBMQ0RfSU5UX0NMRUFS
LCBMQ0RfSU5UX0VPRik7CisKKwkJLyogV2hlbiBkaXNhYmxpbmcvZW5hYmxpbmcgTENEIGxheWVy
cywgdGhlIGNoYW5nZSB0YWtlcyBlZmZlY3QKKwkJICogaW1tZWRpYXRlbHkgYW5kIGRvZXMgbm90
IHdhaXQgZm9yIEVPRiAoZW5kIG9mIGZyYW1lKS4KKwkJICogV2hlbiBrbWJfcGxhbmVfYXRvbWlj
X2Rpc2FibGUgaXMgY2FsbGVkLCBtYXJrIHRoZSBwbGFuZSBhcworCQkgKiBkaXNhYmxlZCBidXQg
YWN0dWFsbHkgZGlzYWJsZSB0aGUgcGxhbmUgd2hlbiBFT0YgaXJxIGlzCisJCSAqIGJlaW5nIGhh
bmRsZWQuCisJCSAqLworCQlmb3IgKHBsYW5lX2lkID0gTEFZRVJfMDsKKwkJCQlwbGFuZV9pZCA8
IGttYi0+bl9sYXllcnM7IHBsYW5lX2lkKyspIHsKKwkJCWlmIChwbGFuZV9zdGF0dXNbcGxhbmVf
aWRdLmRpc2FibGUpIHsKKwkJCQlrbWJfY2xyX2JpdG1hc2tfbGNkKGttYiwKKwkJCQkJCSAgICBM
Q0RfTEFZRVJuX0RNQV9DRkcKKwkJCQkJCSAgICAocGxhbmVfaWQpLAorCQkJCQkJICAgIExDRF9E
TUFfTEFZRVJfRU5BQkxFKTsKKworCQkJCWttYl9jbHJfYml0bWFza19sY2Qoa21iLCBMQ0RfQ09O
VFJPTCwKKwkJCQkJCSAgICBwbGFuZV9zdGF0dXNbcGxhbmVfaWRdLmN0cmwpOworCisJCQkJcGxh
bmVfc3RhdHVzW3BsYW5lX2lkXS5kaXNhYmxlID0gZmFsc2U7CisJCQl9CisJCX0KKwkJaWYgKGtt
Yl91bmRlcl9mbG93KSB7CisJCQkvKiBETUEgUmVjb3ZlcnkgYWZ0ZXIgdW5kZXJmbG93ICovCisJ
CQlkbWEwX3N0YXRlID0gKGxheWVyX25vID09IDApID8KKwkJCSAgICBMQ0RfVklERU8wX0RNQTBf
U1RBVEUgOiBMQ0RfVklERU8xX0RNQTBfU1RBVEU7CisJCQlkbWExX3N0YXRlID0gKGxheWVyX25v
ID09IDApID8KKwkJCSAgICBMQ0RfVklERU8wX0RNQTFfU1RBVEUgOiBMQ0RfVklERU8xX0RNQTFf
U1RBVEU7CisKKwkJCWRvIHsKKwkJCQlrbWJfd3JpdGVfbGNkKGttYiwgTENEX0ZJRk9fRkxVU0gs
IDEpOworCQkJCXZhbCA9IGttYl9yZWFkX2xjZChrbWIsIGRtYTBfc3RhdGUpCisJCQkJICAgICYg
TENEX0RNQV9TVEFURV9BQ1RJVkU7CisJCQkJdmFsMSA9IGttYl9yZWFkX2xjZChrbWIsIGRtYTFf
c3RhdGUpCisJCQkJICAgICYgTENEX0RNQV9TVEFURV9BQ1RJVkU7CisJCQl9IHdoaWxlICgodmFs
IHx8IHZhbDEpKTsKKwkJCS8qIGRpc2FibGUgZG1hICovCisJCQlrbWJfY2xyX2JpdG1hc2tfbGNk
KGttYiwgTENEX0xBWUVSbl9ETUFfQ0ZHKGxheWVyX25vKSwKKwkJCQkJICAgIExDRF9ETUFfTEFZ
RVJfRU5BQkxFKTsKKwkJCWttYl93cml0ZV9sY2Qoa21iLCBMQ0RfRklGT19GTFVTSCwgMSk7CisJ
CQlrbWJfZmx1c2hfZG9uZSA9IDE7CisJCQlrbWJfdW5kZXJfZmxvdyA9IDA7CisJCX0KKwl9CisK
KwlpZiAoc3RhdHVzICYgTENEX0lOVF9MSU5FX0NNUCkgeworCQkvKiBjbGVhciBsaW5lIGNvbXBh
cmUgaW50ZXJydXB0ICovCisJCWttYl93cml0ZV9sY2Qoa21iLCBMQ0RfSU5UX0NMRUFSLCBMQ0Rf
SU5UX0xJTkVfQ01QKTsKKwl9CisKKwlpZiAoc3RhdHVzICYgTENEX0lOVF9WRVJUX0NPTVApIHsK
KwkJLyogUmVhZCBWU1RBVFVTICovCisJCXZhbCA9IGttYl9yZWFkX2xjZChrbWIsIExDRF9WU1RB
VFVTKTsKKwkJdmFsID0gKHZhbCAmIExDRF9WU1RBVFVTX1ZFUlRJQ0FMX1NUQVRVU19NQVNLKTsK
KwkJc3dpdGNoICh2YWwpIHsKKwkJY2FzZSBMQ0RfVlNUQVRVU19DT01QQVJFX1ZTWU5DOgorCQkJ
LyogQ2xlYXIgdmVydGljYWwgY29tcGFyZSBpbnRlcnJ1cHQgKi8KKwkJCWttYl93cml0ZV9sY2Qo
a21iLCBMQ0RfSU5UX0NMRUFSLCBMQ0RfSU5UX1ZFUlRfQ09NUCk7CisJCQlpZiAoa21iX2ZsdXNo
X2RvbmUpIHsKKwkJCQlrbWJfc2V0X2JpdG1hc2tfbGNkKGttYiwKKwkJCQkJCSAgICBMQ0RfTEFZ
RVJuX0RNQV9DRkcKKwkJCQkJCSAgICAobGF5ZXJfbm8pLAorCQkJCQkJICAgIExDRF9ETUFfTEFZ
RVJfRU5BQkxFKTsKKwkJCQlrbWJfZmx1c2hfZG9uZSA9IDA7CisJCQl9CisJCQlkcm1faGFuZGxl
X3ZibGFuayhkZXYsIDApOworCQkJYnJlYWs7CisJCWNhc2UgTENEX1ZTVEFUVVNfQ09NUEFSRV9C
QUNLUE9SQ0g6CisJCWNhc2UgTENEX1ZTVEFUVVNfQ09NUEFSRV9BQ1RJVkU6CisJCWNhc2UgTENE
X1ZTVEFUVVNfQ09NUEFSRV9GUk9OVF9QT1JDSDoKKwkJCWttYl93cml0ZV9sY2Qoa21iLCBMQ0Rf
SU5UX0NMRUFSLCBMQ0RfSU5UX1ZFUlRfQ09NUCk7CisJCQlicmVhazsKKwkJfQorCX0KKwlpZiAo
c3RhdHVzICYgTENEX0lOVF9ETUFfRVJSKSB7CisJCXZhbCA9CisJCSAgICAoc3RhdHVzICYgTENE
X0lOVF9ETUFfRVJSICYKKwkJICAgICBrbWJfcmVhZF9sY2Qoa21iLCBMQ0RfSU5UX0VOQUJMRSkp
OworCQkvKiBMQVlFUjAgLSBWTDAgKi8KKwkJaWYgKHZhbCAmIChMQVlFUjBfRE1BX0ZJRk9fVU5E
RVJGTE9XIHwKKwkJCSAgIExBWUVSMF9ETUFfQ0JfRklGT19VTkRFUkZMT1cgfAorCQkJICAgTEFZ
RVIwX0RNQV9DUl9GSUZPX1VOREVSRkxPVykpIHsKKwkJCWttYl91bmRlcl9mbG93Kys7CisJCQlk
cm1faW5mbygma21iLT5kcm0sCisJCQkJICIhTEFZRVIwOlZMMCBETUEgVU5ERVJGTE9XIHZhbCA9
IDB4JWx4LHVuZGVyX2Zsb3c9JWQiLAorCQkJICAgICB2YWwsIGttYl91bmRlcl9mbG93KTsKKwkJ
CS8qIGRpc2FibGUgdW5kZXJmbG93IGludGVycnVwdCAqLworCQkJa21iX2Nscl9iaXRtYXNrX2xj
ZChrbWIsIExDRF9JTlRfRU5BQkxFLAorCQkJCQkgICAgTEFZRVIwX0RNQV9GSUZPX1VOREVSRkxP
VyB8CisJCQkJCSAgICBMQVlFUjBfRE1BX0NCX0ZJRk9fVU5ERVJGTE9XIHwKKwkJCQkJICAgIExB
WUVSMF9ETUFfQ1JfRklGT19VTkRFUkZMT1cpOworCQkJa21iX3NldF9iaXRtYXNrX2xjZChrbWIs
IExDRF9JTlRfQ0xFQVIsCisJCQkJCSAgICBMQVlFUjBfRE1BX0NCX0ZJRk9fVU5ERVJGTE9XIHwK
KwkJCQkJICAgIExBWUVSMF9ETUFfRklGT19VTkRFUkZMT1cgfAorCQkJCQkgICAgTEFZRVIwX0RN
QV9DUl9GSUZPX1VOREVSRkxPVyk7CisJCQkvKiBkaXNhYmxlIGF1dG8gcmVzdGFydCBtb2RlICov
CisJCQlrbWJfY2xyX2JpdG1hc2tfbGNkKGttYiwgTENEX0xBWUVSbl9ETUFfQ0ZHKDApLAorCQkJ
CQkgICAgTENEX0RNQV9MQVlFUl9DT05UX1BJTkdfUE9OR19VUERBVEUpOworCQkJbGF5ZXJfbm8g
PSAwOworCQl9CisKKwkJaWYgKHZhbCAmIExBWUVSMF9ETUFfRklGT19PVkVSRkxPVykKKwkJCWRy
bV9pbmZvKCZrbWItPmRybSwKKwkJCQkgIkxBWUVSMDpWTDAgRE1BIE9WRVJGTE9XIHZhbCA9IDB4
JWx4IiwgdmFsKTsKKwkJaWYgKHZhbCAmIExBWUVSMF9ETUFfQ0JfRklGT19PVkVSRkxPVykKKwkJ
CWRybV9pbmZvKCZrbWItPmRybSwKKwkJCQkgIkxBWUVSMDpWTDAgRE1BIENCIE9WRVJGTE9XIHZh
bCA9IDB4JWx4IiwgdmFsKTsKKwkJaWYgKHZhbCAmIExBWUVSMF9ETUFfQ1JfRklGT19PVkVSRkxP
VykKKwkJCWRybV9pbmZvKCZrbWItPmRybSwKKwkJCQkgIkxBWUVSMDpWTDAgRE1BIENSIE9WRVJG
TE9XIHZhbCA9IDB4JWx4IiwgdmFsKTsKKworCQkvKiBMQVlFUjEgLSBWTDEgKi8KKwkJaWYgKHZh
bCAmIChMQVlFUjFfRE1BX0ZJRk9fVU5ERVJGTE9XIHwKKwkJCSAgIExBWUVSMV9ETUFfQ0JfRklG
T19VTkRFUkZMT1cgfAorCQkJICAgTEFZRVIxX0RNQV9DUl9GSUZPX1VOREVSRkxPVykpIHsKKwkJ
CWttYl91bmRlcl9mbG93Kys7CisJCQlkcm1faW5mbygma21iLT5kcm0sCisJCQkJICIhTEFZRVIx
OlZMMSBETUEgVU5ERVJGTE9XIHZhbCA9IDB4JWx4LCB1bmRlcl9mbG93PSVkIiwKKwkJCSAgICAg
dmFsLCBrbWJfdW5kZXJfZmxvdyk7CisJCQkvKiBkaXNhYmxlIHVuZGVyZmxvdyBpbnRlcnJ1cHQg
Ki8KKwkJCWttYl9jbHJfYml0bWFza19sY2Qoa21iLCBMQ0RfSU5UX0VOQUJMRSwKKwkJCQkJICAg
IExBWUVSMV9ETUFfRklGT19VTkRFUkZMT1cgfAorCQkJCQkgICAgTEFZRVIxX0RNQV9DQl9GSUZP
X1VOREVSRkxPVyB8CisJCQkJCSAgICBMQVlFUjFfRE1BX0NSX0ZJRk9fVU5ERVJGTE9XKTsKKwkJ
CWttYl9zZXRfYml0bWFza19sY2Qoa21iLCBMQ0RfSU5UX0NMRUFSLAorCQkJCQkgICAgTEFZRVIx
X0RNQV9DQl9GSUZPX1VOREVSRkxPVyB8CisJCQkJCSAgICBMQVlFUjFfRE1BX0ZJRk9fVU5ERVJG
TE9XIHwKKwkJCQkJICAgIExBWUVSMV9ETUFfQ1JfRklGT19VTkRFUkZMT1cpOworCQkJLyogZGlz
YWJsZSBhdXRvIHJlc3RhcnQgbW9kZSAqLworCQkJa21iX2Nscl9iaXRtYXNrX2xjZChrbWIsIExD
RF9MQVlFUm5fRE1BX0NGRygxKSwKKwkJCQkJICAgIExDRF9ETUFfTEFZRVJfQ09OVF9QSU5HX1BP
TkdfVVBEQVRFKTsKKwkJCWxheWVyX25vID0gMTsKKwkJfQorCisJCS8qIExBWUVSMSAtIFZMMSAq
LworCQlpZiAodmFsICYgTEFZRVIxX0RNQV9GSUZPX09WRVJGTE9XKQorCQkJZHJtX2luZm8oJmtt
Yi0+ZHJtLAorCQkJCSAiTEFZRVIxOlZMMSBETUEgT1ZFUkZMT1cgdmFsID0gMHglbHgiLCB2YWwp
OworCQlpZiAodmFsICYgTEFZRVIxX0RNQV9DQl9GSUZPX09WRVJGTE9XKQorCQkJZHJtX2luZm8o
JmttYi0+ZHJtLAorCQkJCSAiTEFZRVIxOlZMMSBETUEgQ0IgT1ZFUkZMT1cgdmFsID0gMHglbHgi
LCB2YWwpOworCQlpZiAodmFsICYgTEFZRVIxX0RNQV9DUl9GSUZPX09WRVJGTE9XKQorCQkJZHJt
X2luZm8oJmttYi0+ZHJtLAorCQkJCSAiTEFZRVIxOlZMMSBETUEgQ1IgT1ZFUkZMT1cgdmFsID0g
MHglbHgiLCB2YWwpOworCisJCS8qIExBWUVSMiAtIEdMMCAqLworCQlpZiAodmFsICYgTEFZRVIy
X0RNQV9GSUZPX1VOREVSRkxPVykKKwkJCWRybV9pbmZvKCZrbWItPmRybSwKKwkJCQkgIkxBWUVS
MjpHTDAgRE1BIFVOREVSRkxPVyB2YWwgPSAweCVseCIsIHZhbCk7CisJCWlmICh2YWwgJiBMQVlF
UjJfRE1BX0ZJRk9fT1ZFUkZMT1cpCisJCQlkcm1faW5mbygma21iLT5kcm0sCisJCQkJICJMQVlF
UjI6R0wwIERNQSBPVkVSRkxPVyB2YWwgPSAweCVseCIsIHZhbCk7CisKKwkJLyogTEFZRVIzIC0g
R0wxICovCisJCWlmICh2YWwgJiBMQVlFUjNfRE1BX0ZJRk9fVU5ERVJGTE9XKQorCQkJZHJtX2lu
Zm8oJmttYi0+ZHJtLAorCQkJCSAiTEFZRVIzOkdMMSBETUEgVU5ERVJGTE9XIHZhbCA9IDB4JWx4
IiwgdmFsKTsKKwkJaWYgKHZhbCAmIExBWUVSM19ETUFfRklGT19VTkRFUkZMT1cpCisJCQlkcm1f
aW5mbygma21iLT5kcm0sCisJCQkJICJMQVlFUjM6R0wxIERNQSBPVkVSRkxPVyB2YWwgPSAweCVs
eCIsIHZhbCk7CisJfQorCisJaWYgKHN0YXR1cyAmIExDRF9JTlRfTEFZRVIpIHsKKwkJLyogQ2xl
YXIgbGF5ZXIgaW50ZXJydXB0cyAqLworCQlrbWJfd3JpdGVfbGNkKGttYiwgTENEX0lOVF9DTEVB
UiwgTENEX0lOVF9MQVlFUik7CisJfQorCisJLyogQ2xlYXIgYWxsIGludGVycnVwdHMgKi8KKwlr
bWJfc2V0X2JpdG1hc2tfbGNkKGttYiwgTENEX0lOVF9DTEVBUiwgMSk7CisJcmV0dXJuIElSUV9I
QU5ETEVEOworfQorCisvKiBJUlEgaGFuZGxlciAqLworc3RhdGljIGlycXJldHVybl90IGttYl9p
c3IoaW50IGlycSwgdm9pZCAqYXJnKQoreworCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAoc3Ry
dWN0IGRybV9kZXZpY2UgKilhcmc7CisJaXJxcmV0dXJuX3QgcmV0ID0gSVJRX05PTkU7CisKKwly
ZXQgPSBoYW5kbGVfbGNkX2lycShkZXYpOworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyB2b2lk
IGttYl9pcnFfcmVzZXQoc3RydWN0IGRybV9kZXZpY2UgKmRybSkKK3sKKwlrbWJfd3JpdGVfbGNk
KHRvX2ttYihkcm0pLCBMQ0RfSU5UX0NMRUFSLCAweEZGRkYpOworCWttYl93cml0ZV9sY2QodG9f
a21iKGRybSksIExDRF9JTlRfRU5BQkxFLCAwKTsKK30KKworREVGSU5FX0RSTV9HRU1fQ01BX0ZP
UFMoZm9wcyk7CisKK3N0YXRpYyBzdHJ1Y3QgZHJtX2RyaXZlciBrbWJfZHJpdmVyID0geworCS5k
cml2ZXJfZmVhdHVyZXMgPSBEUklWRVJfR0VNIHwKKwkgICAgRFJJVkVSX01PREVTRVQgfCBEUklW
RVJfQVRPTUlDLAorCS5pcnFfaGFuZGxlciA9IGttYl9pc3IsCisJLmlycV9wcmVpbnN0YWxsID0g
a21iX2lycV9yZXNldCwKKwkuaXJxX3VuaW5zdGFsbCA9IGttYl9pcnFfcmVzZXQsCisJLyogR0VN
IE9wZXJhdGlvbnMgKi8KKwkuZm9wcyA9ICZmb3BzLAorCURSTV9HRU1fQ01BX0RSSVZFUl9PUFNf
Vk1BUCwKKwkubmFtZSA9ICJrbWItZHJtIiwKKwkuZGVzYyA9ICJLRUVNQkFZIERJU1BMQVkgRFJJ
VkVSICIsCisJLmRhdGUgPSAiMjAxOTAxMjIiLAorCS5tYWpvciA9IDEsCisJLm1pbm9yID0gMCwK
K307CisKK3N0YXRpYyB2b2lkIGttYl9kcm1fdW5sb2FkKHN0cnVjdCBkZXZpY2UgKmRldikKK3sK
KwlzdHJ1Y3QgZHJtX2RldmljZSAqZHJtID0gZGV2X2dldF9kcnZkYXRhKGRldik7CisJc3RydWN0
IGttYl9kcm1fcHJpdmF0ZSAqa21iID0gdG9fa21iKGRybSk7CisKKyNpZmRlZiBERUJVRworCWR1
bXBfc3RhY2soKTsKKyNlbmRpZgorCWRybV9kZXZfdW5yZWdpc3Rlcihkcm0pOworCWRybV9rbXNf
aGVscGVyX3BvbGxfZmluaShkcm0pOworCW9mX25vZGVfcHV0KGttYi0+Y3J0Yy5wb3J0KTsKKwlr
bWItPmNydGMucG9ydCA9IE5VTEw7CisJcG1fcnVudGltZV9nZXRfc3luYyhkcm0tPmRldik7CisJ
ZHJtX2lycV91bmluc3RhbGwoZHJtKTsKKwlwbV9ydW50aW1lX3B1dF9zeW5jKGRybS0+ZGV2KTsK
KwlwbV9ydW50aW1lX2Rpc2FibGUoZHJtLT5kZXYpOworCisJaWYgKGttYi0+bGNkX21taW8pIHsK
KwkJaW91bm1hcChrbWItPmxjZF9tbWlvKTsKKwkJcmVsZWFzZV9tZW1fcmVnaW9uKExDRF9CQVNF
X0FERFIsIExDRF9NTUlPX1NJWkUpOworCX0KKworCWlmIChrbWItPm1pcGlfbW1pbykgeworCQlp
b3VubWFwKGttYi0+bWlwaV9tbWlvKTsKKwkJcmVsZWFzZV9tZW1fcmVnaW9uKE1JUElfQkFTRV9B
RERSLCBNSVBJX01NSU9fU0laRSk7CisJfQorCisJaWYgKGttYi0+bXNzY2FtX21taW8pIHsKKwkJ
aW91bm1hcChrbWItPm1zc2NhbV9tbWlvKTsKKwkJcmVsZWFzZV9tZW1fcmVnaW9uKE1TU19DQU1f
QkFTRV9BRERSLCBNU1NfQ0FNX01NSU9fU0laRSk7CisJfQorCisJb2ZfcmVzZXJ2ZWRfbWVtX2Rl
dmljZV9yZWxlYXNlKGRybS0+ZGV2KTsKKwlkcm1fbW9kZV9jb25maWdfY2xlYW51cChkcm0pOwor
CisJLyogUmVsZWFzZSBjbGtzICovCisJa21iX2Rpc3BsYXlfY2xrX2Rpc2FibGUoKTsKKwljbGtf
cHV0KGttYl9jbGsuY2xrX2xjZCk7CisJY2xrX3B1dChrbWJfY2xrLmNsa19taXBpKTsKKworCWRl
dl9zZXRfZHJ2ZGF0YShkZXYsIE5VTEwpOworCisJLyogVW5yZWdpc3RlciBEU0kgaG9zdCAqLwor
CWttYl9kc2lfaG9zdF91bnJlZ2lzdGVyKCk7Cit9CisKK3N0YXRpYyBpbnQga21iX3Byb2JlKHN0
cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpCit7CisJc3RydWN0IGRldmljZSAqZGV2ID0gZ2V0
X2RldmljZSgmcGRldi0+ZGV2KTsKKwlzdHJ1Y3Qga21iX2RybV9wcml2YXRlICprbWI7CisJaW50
IHJldCA9IDA7CisKKwkvKiBUaGUgYnJpZGdlIChBRFYgNzUzNSkgd2lsbCByZXR1cm4gLUVQUk9C
RV9ERUZFUiB1bnRpbCBpdAorCSAqIGhhcyBhIG1pcGlfZHNpX2hvc3QgdG8gcmVnaXN0ZXIgaXRz
IGRldmljZSB0by4gU28sIHdlCisJICogZmlyc3QgcmVnaXN0ZXIgdGhlIERTSSBob3N0IGR1cmlu
ZyBwcm9iZSB0aW1lLCBhbmQgdGhlbiByZXR1cm4KKwkgKiAtRVBST0JFX0RFRkVSIHVudGlsIHRo
ZSBicmlkZ2UgaXMgbG9hZGVkLiBQcm9iZSB3aWxsIGJlIGNhbGxlZCBhZ2FpbgorCSAqICBhbmQg
dGhlbiB0aGUgcmVzdCBvZiB0aGUgZHJpdmVyIGluaXRpYWxpemF0aW9uIGNhbiBwcm9jZWVkCisJ
ICogIGFmdGVyd2FyZHMgYW5kIHRoZSBicmlkZ2UgY2FuIGJlIHN1Y2Nlc3NmdWxseSBhdHRhY2hl
ZC4KKwkgKi8KKwlhZHZfYnJpZGdlID0ga21iX2RzaV9ob3N0X2JyaWRnZV9pbml0KGRldik7CisK
KwlpZiAoYWR2X2JyaWRnZSA9PSBFUlJfUFRSKC1FUFJPQkVfREVGRVIpKSB7CisJCXJldHVybiAt
RVBST0JFX0RFRkVSOworCX0gZWxzZSBpZiAoSVNfRVJSKGFkdl9icmlkZ2UpKSB7CisJCURSTV9F
UlJPUigicHJvYmUgZmFpbGVkIHRvIGluaXRpYWxpemUgRFNJIGhvc3QgYnJpZGdlXG4iKTsKKwkJ
cmV0dXJuIFBUUl9FUlIoYWR2X2JyaWRnZSk7CisJfQorCisJLyogQ3JlYXRlIERSTSBkZXZpY2Ug
Ki8KKwlrbWIgPSBkZXZtX2RybV9kZXZfYWxsb2MoZGV2LCAma21iX2RyaXZlciwKKwkJCQkgc3Ry
dWN0IGttYl9kcm1fcHJpdmF0ZSwgZHJtKTsKKwlpZiAoSVNfRVJSKGttYikpCisJCXJldHVybiBQ
VFJfRVJSKGttYik7CisKKwlkZXZfc2V0X2RydmRhdGEoZGV2LCAma21iLT5kcm0pOworCisJcmV0
ID0ga21iX3NldHVwX21vZGVfY29uZmlnKCZrbWItPmRybSk7CisJaWYgKHJldCkKKwkJZ290byBl
cnJfZnJlZTsKKwlkZXZfc2V0X2RydmRhdGEoZGV2LCAma21iLT5kcm0pOworCisJLyogTG9hZCBk
cml2ZXIgKi8KKwlrbWItPm5fbGF5ZXJzID0gS01CX01BWF9QTEFORVM7CisJcmV0ID0ga21iX2xv
YWQoJmttYi0+ZHJtLCAwKTsKKwlpZiAocmV0ID09IC1FUFJPQkVfREVGRVIpIHsKKwkJZHJtX2lu
Zm8oJmttYi0+ZHJtLCAid2FpdCBmb3IgZXh0ZXJuYWwgYnJpZGdlIGRyaXZlciBEVFxuIik7CisJ
CXJldHVybiAtRVBST0JFX0RFRkVSOworCX0gZWxzZSBpZiAocmV0KSB7CisJCWdvdG8gZXJyX2Zy
ZWU7CisJfQorCisJLyogU2V0IHRoZSBDUlRDJ3MgcG9ydCBzbyB0aGF0IHRoZSBlbmNvZGVyIGNv
bXBvbmVudCBjYW4gZmluZCBpdCAqLworCWttYi0+Y3J0Yy5wb3J0ID0gb2ZfZ3JhcGhfZ2V0X3Bv
cnRfYnlfaWQoZGV2LT5vZl9ub2RlLCAwKTsKKwlyZXQgPSBkcm1fdmJsYW5rX2luaXQoJmttYi0+
ZHJtLCBrbWItPmRybS5tb2RlX2NvbmZpZy5udW1fY3J0Yyk7CisJZHJtX2luZm8oJmttYi0+ZHJt
LCAibW9kZV9jb25maWcubnVtX2NydGM9JWRcbiIsCisJCSBrbWItPmRybS5tb2RlX2NvbmZpZy5u
dW1fY3J0Yyk7CisJaWYgKHJldCA8IDApIHsKKwkJZHJtX2Vycigma21iLT5kcm0sICJmYWlsZWQg
dG8gaW5pdGlhbGl6ZSB2YmxhbmtcbiIpOworCQlnb3RvIGVycl92Ymxhbms7CisJfQorCisJZHJt
X21vZGVfY29uZmlnX3Jlc2V0KCZrbWItPmRybSk7CisJZHJtX2ttc19oZWxwZXJfcG9sbF9pbml0
KCZrbWItPmRybSk7CisKKwkvKiBSZWdpc3RlciBncmFwaGljcyBkZXZpY2Ugd2l0aCB0aGUga2Vy
bmVsICovCisJcmV0ID0gZHJtX2Rldl9yZWdpc3Rlcigma21iLT5kcm0sIDApOworCisJaWYgKHJl
dCkKKwkJZ290byBlcnJfcmVnaXN0ZXI7CisKKwlyZXR1cm4gMDsKKworIGVycl9yZWdpc3RlcjoK
Kwlkcm1fa21zX2hlbHBlcl9wb2xsX2ZpbmkoJmttYi0+ZHJtKTsKKyBlcnJfdmJsYW5rOgorCXBt
X3J1bnRpbWVfZGlzYWJsZShrbWItPmRybS5kZXYpOworIGVycl9mcmVlOgorCWRybV9tb2RlX2Nv
bmZpZ19jbGVhbnVwKCZrbWItPmRybSk7CisJZGV2X3NldF9kcnZkYXRhKGRldiwgTlVMTCk7CisJ
a21iX2RzaV9ob3N0X3VucmVnaXN0ZXIoKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBp
bnQga21iX3JlbW92ZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQoreworCWttYl9kcm1f
dW5sb2FkKCZwZGV2LT5kZXYpOworCXJldHVybiAwOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0
IG9mX2RldmljZV9pZCBrbWJfb2ZfbWF0Y2hbXSA9IHsKKwl7LmNvbXBhdGlibGUgPSAiaW50ZWws
a21iX2Rpc3BsYXkifSwKKwl7fSwKK307CisKK01PRFVMRV9ERVZJQ0VfVEFCTEUob2YsIGttYl9v
Zl9tYXRjaCk7CisKK3N0YXRpYyBpbnQgX19tYXliZV91bnVzZWQga21iX3BtX3N1c3BlbmQoc3Ry
dWN0IGRldmljZSAqZGV2KQoreworCXN0cnVjdCBkcm1fZGV2aWNlICpkcm0gPSBkZXZfZ2V0X2Ry
dmRhdGEoZGV2KTsKKwlzdHJ1Y3Qga21iX2RybV9wcml2YXRlICprbWIgPSBkcm0gPyB0b19rbWIo
ZHJtKSA6IE5VTEw7CisKKwlpZiAoIWttYikKKwkJcmV0dXJuIDA7CisKKwlkcm1fa21zX2hlbHBl
cl9wb2xsX2Rpc2FibGUoZHJtKTsKKworCWttYi0+c3RhdGUgPSBkcm1fYXRvbWljX2hlbHBlcl9z
dXNwZW5kKGRybSk7CisJaWYgKElTX0VSUihrbWItPnN0YXRlKSkgeworCQlkcm1fa21zX2hlbHBl
cl9wb2xsX2VuYWJsZShkcm0pOworCQlyZXR1cm4gUFRSX0VSUihrbWItPnN0YXRlKTsKKwl9CisK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBfX21heWJlX3VudXNlZCBrbWJfcG1fcmVzdW1l
KHN0cnVjdCBkZXZpY2UgKmRldikKK3sKKwlzdHJ1Y3QgZHJtX2RldmljZSAqZHJtID0gZGV2X2dl
dF9kcnZkYXRhKGRldik7CisJc3RydWN0IGttYl9kcm1fcHJpdmF0ZSAqa21iID0gZHJtID8gdG9f
a21iKGRybSkgOiBOVUxMOworCisJaWYgKCFrbWIpCisJCXJldHVybiAwOworCisJZHJtX2F0b21p
Y19oZWxwZXJfcmVzdW1lKGRybSwga21iLT5zdGF0ZSk7CisJZHJtX2ttc19oZWxwZXJfcG9sbF9l
bmFibGUoZHJtKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgU0lNUExFX0RFVl9QTV9PUFMo
a21iX3BtX29wcywga21iX3BtX3N1c3BlbmQsIGttYl9wbV9yZXN1bWUpOworCitzdGF0aWMgc3Ry
dWN0IHBsYXRmb3JtX2RyaXZlciBrbWJfcGxhdGZvcm1fZHJpdmVyID0geworCS5wcm9iZSA9IGtt
Yl9wcm9iZSwKKwkucmVtb3ZlID0ga21iX3JlbW92ZSwKKwkuZHJpdmVyID0geworCQkgICAubmFt
ZSA9ICJrbWItZHJtIiwKKwkJICAgLnBtID0gJmttYl9wbV9vcHMsCisJCSAgIC5vZl9tYXRjaF90
YWJsZSA9IGttYl9vZl9tYXRjaCwKKwkJICAgfSwKK307CisKK21vZHVsZV9wbGF0Zm9ybV9kcml2
ZXIoa21iX3BsYXRmb3JtX2RyaXZlcik7CisKK01PRFVMRV9BVVRIT1IoIkludGVsIENvcnBvcmF0
aW9uIik7CitNT0RVTEVfREVTQ1JJUFRJT04oIktlZW1iYXkgRGlzcGxheSBkcml2ZXIiKTsKK01P
RFVMRV9MSUNFTlNFKCJHUEwgdjIiKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9rbWIv
a21iX2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL2ttYi9rbWJfZHJ2LmgKbmV3IGZpbGUgbW9kZSAx
MDA2NDQKaW5kZXggMDAwMDAwMC4uMjJhMjkzZQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9rbWIva21iX2Rydi5oCkBAIC0wLDAgKzEsMTcyIEBACisvKiBTUERYLUxpY2Vuc2Ut
SWRlbnRpZmllcjogR1BMLTIuMC1vbmx5CisgKgorICogQ29weXJpZ2h0IMKpIDIwMTgtMjAyMCBJ
bnRlbCBDb3Jwb3JhdGlvbgorICovCisKKyNpZm5kZWYgX19LTUJfRFJWX0hfXworI2RlZmluZSBf
X0tNQl9EUlZfSF9fCisKKyNpbmNsdWRlICJrbWJfcmVncy5oIgorCisjZGVmaW5lIEtNQl9NQVhf
V0lEVEgJCQkxOTIwIC8qbWF4IHdpZHRoIGluIHBpeGVscyAqLworI2RlZmluZSBLTUJfTUFYX0hF
SUdIVAkJCTEwODAgLyptYXggaGVpZ2h0IGluIHBpeGVscyAqLworI2RlZmluZSBLTUJfTUlOX1dJ
RFRIICAgICAgICAgICAgICAgICAgIDE5MjAgLyptYXggd2lkdGggaW4gcGl4ZWxzICovCisjZGVm
aW5lIEtNQl9NSU5fSEVJR0hUICAgICAgICAgICAgICAgICAgMTA4MCAvKm1heCBoZWlnaHQgaW4g
cGl4ZWxzICovCisjZGVmaW5lIEtNQl9MQ0RfREVGQVVMVF9DTEsJCTIwMDAwMDAwMAorI2RlZmlu
ZSBLTUJfTUlQSV9ERUZBVUxUX0NMSwkJMjQwMDAwMDAKKyNkZWZpbmUgS01CX01JUElfREVGQVVM
VF9DRkdfQ0xLCTI0MDAwMDAwCisjZGVmaW5lIEtNQl9TWVNfQ0xLX01IWgkJCTUwMAorCisjZGVm
aW5lIGNydGNfdG9fa21iX3ByaXYoeCkJY29udGFpbmVyX29mKHgsIHN0cnVjdCBrbWJfZHJtX3By
aXZhdGUsIGNydGMpCisKKyNkZWZpbmUgSUNBTV9NTUlPCQkweDNiMTAwMDAwCisjZGVmaW5lIElD
QU1fTENEX09GRlNFVAkJMHgxMDgwCisjZGVmaW5lIElDQU1fTU1JT19TSVpFCQkweDIwMDAKK3N0
cnVjdCBrbWJfZHJtX3ByaXZhdGUgeworCXN0cnVjdCBkcm1fZGV2aWNlCQlkcm07CisJdm9pZCBf
X2lvbWVtCQkJKmxjZF9tbWlvOworCXZvaWQgX19pb21lbQkJCSptaXBpX21taW87CisJdm9pZCBf
X2lvbWVtCQkJKm1zc2NhbV9tbWlvOworCXVuc2lnbmVkIGNoYXIJCQluX2xheWVyczsKKwlzdHJ1
Y3QgY2xrCQkJKmNsazsKKwlzdHJ1Y3QgZHJtX2NydGMJCQljcnRjOworCXN0cnVjdCBrbWJfcGxh
bmUJCSpwbGFuZTsKKwlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZQkJKnN0YXRlOworCXNwaW5sb2Nr
X3QJCQlpcnFfbG9jazsKKwlpbnQJCQkJaXJxX2xjZDsKKwlpbnQJCQkJaXJxX21pcGk7CisJaW50
CQkJCXN5c19jbGtfbWh6OworCWRtYV9hZGRyX3QJCQlmYl9hZGRyOworfTsKKworc3RydWN0IGtt
Yl9jbG9jayB7CisJc3RydWN0IGNsayAqY2xrX2xjZDsKKwlzdHJ1Y3QgY2xrICpjbGtfbWlwaTsK
KwlzdHJ1Y3QgY2xrICpjbGtfbWlwaV9lY2ZnOworCXN0cnVjdCBjbGsgKmNsa19taXBpX2NmZzsK
KwlzdHJ1Y3QgY2xrICpjbGtfcGxsMDsKK307CisKK3N0YXRpYyBpbmxpbmUgc3RydWN0IGttYl9k
cm1fcHJpdmF0ZSAqdG9fa21iKGNvbnN0IHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCit7CisJcmV0
dXJuIGNvbnRhaW5lcl9vZihkZXYsIHN0cnVjdCBrbWJfZHJtX3ByaXZhdGUsIGRybSk7Cit9CisK
K3N0cnVjdCBibHRfbGF5ZXJfY29uZmlnIHsKKwl1bnNpZ25lZCBjaGFyIGxheWVyX2Zvcm1hdDsK
K307CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBrbWJfd3JpdGVfbGNkKHN0cnVjdCBrbWJfZHJtX3By
aXZhdGUgKmRldl9wLAorCQkJCSB1bnNpZ25lZCBpbnQgcmVnLCB1MzIgdmFsdWUpCit7CisJd3Jp
dGVsKHZhbHVlLCAoZGV2X3AtPmxjZF9tbWlvICsgcmVnKSk7Cit9CisKK3N0YXRpYyBpbmxpbmUg
dm9pZCBrbWJfd3JpdGVfbWlwaShzdHJ1Y3Qga21iX2RybV9wcml2YXRlICpkZXZfcCwKKwkJCQkg
IHVuc2lnbmVkIGludCByZWcsIHUzMiB2YWx1ZSkKK3sKKwl3cml0ZWwodmFsdWUsIChkZXZfcC0+
bWlwaV9tbWlvICsgcmVnKSk7Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBrbWJfd3JpdGVfbXNz
Y2FtKHN0cnVjdCBrbWJfZHJtX3ByaXZhdGUgKmRldl9wLAorCQkJCSAgICB1bnNpZ25lZCBpbnQg
cmVnLCB1MzIgdmFsdWUpCit7CisJd3JpdGVsKHZhbHVlLCAoZGV2X3AtPm1zc2NhbV9tbWlvICsg
cmVnKSk7Cit9CisKK3N0YXRpYyBpbmxpbmUgdTMyIGttYl9yZWFkX21zc2NhbShzdHJ1Y3Qga21i
X2RybV9wcml2YXRlICpkZXZfcCwKKwkJCQkgIHVuc2lnbmVkIGludCByZWcpCit7CisJcmV0dXJu
IHJlYWRsKGRldl9wLT5tc3NjYW1fbW1pbyArIHJlZyk7Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9p
ZCBrbWJfc2V0X2JpdG1hc2tfbXNzY2FtKHN0cnVjdCBrbWJfZHJtX3ByaXZhdGUgKmRldl9wLAor
CQkJCQkgIHVuc2lnbmVkIGludCByZWcsIHUzMiBtYXNrKQoreworCXUzMiByZWdfdmFsID0ga21i
X3JlYWRfbXNzY2FtKGRldl9wLCByZWcpOworCisJa21iX3dyaXRlX21zc2NhbShkZXZfcCwgcmVn
LCAocmVnX3ZhbCB8IG1hc2spKTsKK30KKworc3RhdGljIGlubGluZSB1MzIga21iX3JlYWRfbGNk
KHN0cnVjdCBrbWJfZHJtX3ByaXZhdGUgKmRldl9wLCB1bnNpZ25lZCBpbnQgcmVnKQoreworCXJl
dHVybiByZWFkbChkZXZfcC0+bGNkX21taW8gKyByZWcpOworfQorCitzdGF0aWMgaW5saW5lIHZv
aWQga21iX3NldF9iaXRtYXNrX2xjZChzdHJ1Y3Qga21iX2RybV9wcml2YXRlICpkZXZfcCwKKwkJ
CQkgICAgICAgdW5zaWduZWQgaW50IHJlZywgdTMyIG1hc2spCit7CisJdTMyIHJlZ192YWwgPSBr
bWJfcmVhZF9sY2QoZGV2X3AsIHJlZyk7CisKKwlrbWJfd3JpdGVfbGNkKGRldl9wLCByZWcsIChy
ZWdfdmFsIHwgbWFzaykpOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQga21iX2Nscl9iaXRtYXNr
X2xjZChzdHJ1Y3Qga21iX2RybV9wcml2YXRlICpkZXZfcCwKKwkJCQkgICAgICAgdW5zaWduZWQg
aW50IHJlZywgdTMyIG1hc2spCit7CisJdTMyIHJlZ192YWwgPSBrbWJfcmVhZF9sY2QoZGV2X3As
IHJlZyk7CisKKwlrbWJfd3JpdGVfbGNkKGRldl9wLCByZWcsIChyZWdfdmFsICYgKH5tYXNrKSkp
OworfQorCitzdGF0aWMgaW5saW5lIHUzMiBrbWJfcmVhZF9taXBpKHN0cnVjdCBrbWJfZHJtX3By
aXZhdGUgKmRldl9wLCB1bnNpZ25lZCBpbnQgcmVnKQoreworCXJldHVybiByZWFkbChkZXZfcC0+
bWlwaV9tbWlvICsgcmVnKTsKK30KKworc3RhdGljIGlubGluZSB2b2lkIGttYl93cml0ZV9iaXRz
X21pcGkoc3RydWN0IGttYl9kcm1fcHJpdmF0ZSAqZGV2X3AsCisJCQkJICAgICAgIHVuc2lnbmVk
IGludCByZWcsIHUzMiBvZmZzZXQsCisJCQkJICAgICAgIHUzMiBudW1fYml0cywgdTMyIHZhbHVl
KQoreworCXUzMiByZWdfdmFsID0ga21iX3JlYWRfbWlwaShkZXZfcCwgcmVnKTsKKwl1MzIgbWFz
ayA9ICgxIDw8IG51bV9iaXRzKSAtIDE7CisKKwl2YWx1ZSAmPSBtYXNrOworCW1hc2sgPDw9IG9m
ZnNldDsKKwlyZWdfdmFsICY9ICh+bWFzayk7CisJcmVnX3ZhbCB8PSAodmFsdWUgPDwgb2Zmc2V0
KTsKKyNpZmRlZiBERUJVRworCWlmIChyZWcgPT0gRFBIWV9GUkVRX0NUUkwwXzMgKyA0KSB7CisJ
CURSTV9JTkZPKCIlcyA6ICVkICByZWc9MHgleCBvZmZzZXQ9JWQgbnVtX2JpdHM9JWQgdmFsPTB4
JXhcbiIsCisJCQkgX19mdW5jX18sIF9fTElORV9fLCByZWcsIG9mZnNldCwgbnVtX2JpdHMsCisJ
CQkgcmVnX3ZhbCk7CisJfQorI2VuZGlmCisJa21iX3dyaXRlX21pcGkoZGV2X3AsIHJlZywgcmVn
X3ZhbCk7Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBrbWJfc2V0X2JpdF9taXBpKHN0cnVjdCBr
bWJfZHJtX3ByaXZhdGUgKmRldl9wLAorCQkJCSAgICB1bnNpZ25lZCBpbnQgcmVnLCB1MzIgb2Zm
c2V0KQoreworCXUzMiByZWdfdmFsID0ga21iX3JlYWRfbWlwaShkZXZfcCwgcmVnKTsKKworCWtt
Yl93cml0ZV9taXBpKGRldl9wLCByZWcsIHJlZ192YWwgfCAoMSA8PCBvZmZzZXQpKTsKK30KKwor
c3RhdGljIGlubGluZSB2b2lkIGttYl9jbHJfYml0X21pcGkoc3RydWN0IGttYl9kcm1fcHJpdmF0
ZSAqZGV2X3AsCisJCQkJICAgIHVuc2lnbmVkIGludCByZWcsIHUzMiBvZmZzZXQpCit7CisJdTMy
IHJlZ192YWwgPSBrbWJfcmVhZF9taXBpKGRldl9wLCByZWcpOworCisJa21iX3dyaXRlX21pcGko
ZGV2X3AsIHJlZywgcmVnX3ZhbCAmICh+KDEgPDwgb2Zmc2V0KSkpOworfQorCitzdGF0aWMgaW5s
aW5lIHZvaWQga21iX3NldF9iaXRtYXNrX21pcGkoc3RydWN0IGttYl9kcm1fcHJpdmF0ZSAqZGV2
X3AsCisJCQkJCXVuc2lnbmVkIGludCByZWcsIHUzMiBtYXNrKQoreworCXUzMiByZWdfdmFsID0g
a21iX3JlYWRfbWlwaShkZXZfcCwgcmVnKTsKKworCWttYl93cml0ZV9taXBpKGRldl9wLCByZWcs
IChyZWdfdmFsIHwgbWFzaykpOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQga21iX2Nscl9iaXRt
YXNrX21pcGkoc3RydWN0IGttYl9kcm1fcHJpdmF0ZSAqZGV2X3AsCisJCQkJCXVuc2lnbmVkIGlu
dCByZWcsIHUzMiBtYXNrKQoreworCXUzMiByZWdfdmFsID0ga21iX3JlYWRfbWlwaShkZXZfcCwg
cmVnKTsKKworCWttYl93cml0ZV9taXBpKGRldl9wLCByZWcsIChyZWdfdmFsICYgKH5tYXNrKSkp
OworfQorCitpbnQga21iX3NldHVwX2NydGMoc3RydWN0IGRybV9kZXZpY2UgKmRldik7Cit2b2lk
IGttYl9zZXRfc2Nhbm91dChzdHJ1Y3Qga21iX2RybV9wcml2YXRlICpsY2QpOworI2VuZGlmIC8q
IF9fS01CX0RSVl9IX18gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9rbWIva21iX2Rz
aS5jIGIvZHJpdmVycy9ncHUvZHJtL2ttYi9rbWJfZHNpLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQK
aW5kZXggMDAwMDAwMC4uMjE3NDVhZQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9rbWIva21iX2RzaS5jCkBAIC0wLDAgKzEsMTgyOCBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50
aWZpZXI6IEdQTC0yLjAtb25seQorLyoKKyAqIENvcHlyaWdodCDCqSAyMDE5LTIwMjAgSW50ZWwg
Q29ycG9yYXRpb24KKyAqLworCisjaW5jbHVkZSA8bGludXgvZGVsYXkuaD4KKyNpbmNsdWRlIDxs
aW51eC9ncGlvL2NvbnN1bWVyLmg+CisjaW5jbHVkZSA8bGludXgvc2xhYi5oPgorI2luY2x1ZGUg
PGxpbnV4L3NwaW5sb2NrLmg+CisKKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pY19oZWxwZXIuaD4K
KyNpbmNsdWRlIDxkcm0vZHJtX2JyaWRnZS5oPgorI2luY2x1ZGUgPGRybS9kcm1fY29ubmVjdG9y
Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV9jcnRjLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9jcnRjX2hl
bHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fZWRpZC5oPgorI2luY2x1ZGUgPGRybS9kcm1fbWlw
aV9kc2kuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3ByaW50Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV9w
cm9iZV9oZWxwZXIuaD4KKworI2luY2x1ZGUgImttYl9kcnYuaCIKKyNpbmNsdWRlICJrbWJfZHNp
LmgiCisjaW5jbHVkZSAia21iX3JlZ3MuaCIKKworc3RhdGljIGludCBod19pbml0aWFsaXplZDsK
Ky8qICNkZWZpbmUgTUlQSV9UWF9URVNUX1BBVFRFUk5fR0VORVJBVElPTiAqLworLyogI2RlZmlu
ZSBEUEhZX0dFVF9GU00gKi8KKy8qICNkZWZpbmUgRFBIWV9SRUFEX1RFU1RDT0RFICovCisKK3N0
YXRpYyBzdHJ1Y3QgbWlwaV9kc2lfaG9zdCAqZHNpX2hvc3Q7CitzdGF0aWMgc3RydWN0IG1pcGlf
ZHNpX2RldmljZSAqZHNpX2RldmljZTsKKworLyogRGVmYXVsdCBzZXR0aW5nIGlzIDEwODBwLCA0
IGxhbmVzICovCisjZGVmaW5lIElNR19IRUlHSFRfTElORVMgIDEwODAKKyNkZWZpbmUgSU1HX1dJ
RFRIX1BYICAgICAgMTkyMAorI2RlZmluZSBNSVBJX1RYX0FDVElWRV9MQU5FUyA0CisKK3N0cnVj
dCBtaXBpX3R4X2ZyYW1lX3NlY3Rpb25fY2ZnIG1pcGlfdHhfZnJhbWUwX3NlY3RfY2ZnID0gewor
CS53aWR0aF9waXhlbHMgPSBJTUdfV0lEVEhfUFgsCisJLmhlaWdodF9saW5lcyA9IElNR19IRUlH
SFRfTElORVMsCisJLmRhdGFfdHlwZSA9IERTSV9MUF9EVF9QUFNfUkdCODg4XzI0QiwKKwkuZGF0
YV9tb2RlID0gTUlQSV9EQVRBX01PREUxLAorCS5kbWFfcGFja2VkID0gMAorfTsKKworc3RydWN0
IG1pcGlfdHhfZnJhbWVfY2ZnIG1pcGl0eF9mcmFtZTBfY2ZnID0geworCS5zZWN0aW9uc1swXSA9
ICZtaXBpX3R4X2ZyYW1lMF9zZWN0X2NmZywKKwkuc2VjdGlvbnNbMV0gPSBOVUxMLAorCS5zZWN0
aW9uc1syXSA9IE5VTEwsCisJLnNlY3Rpb25zWzNdID0gTlVMTCwKKwkudnN5bmNfd2lkdGggPSA1
LAorCS52X2JhY2twb3JjaCA9IDM2LAorCS52X2Zyb250cG9yY2ggPSA0LAorCS5oc3luY193aWR0
aCA9IDQ0LAorCS5oX2JhY2twb3JjaCA9IDE0OCwKKwkuaF9mcm9udHBvcmNoID0gODgKK307CisK
K3N0cnVjdCBtaXBpX3R4X2RzaV9jZmcgbWlwaXR4X2RzaV9jZmcgPSB7CisJLmhmcF9ibGFua19l
biA9IDAsCisJLmVvdHBfZW4gPSAwLAorCS5scG1fbGFzdF92ZnBfbGluZSA9IDAsCisJLmxwbV9m
aXJzdF92c2FfbGluZSA9IDAsCisJLnN5bmNfcHVsc2VfZXZlbnRuID0gRFNJX1ZJREVPX01PREVf
Tk9fQlVSU1RfRVZFTlQsCisJLmhmcF9ibGFua2luZyA9IFNFTkRfQkxBTktfUEFDS0VULAorCS5o
YnBfYmxhbmtpbmcgPSBTRU5EX0JMQU5LX1BBQ0tFVCwKKwkuaHNhX2JsYW5raW5nID0gU0VORF9C
TEFOS19QQUNLRVQsCisJLnZfYmxhbmtpbmcgPSBTRU5EX0JMQU5LX1BBQ0tFVCwKK307CisKK3N0
cnVjdCBtaXBpX2N0cmxfY2ZnIG1pcGlfdHhfaW5pdF9jZmcgPSB7CisJLmluZGV4ID0gTUlQSV9D
VFJMNiwKKwkudHlwZSA9IE1JUElfRFNJLAorCS5kaXIgPSBNSVBJX1RYLAorCS5hY3RpdmVfbGFu
ZXMgPSBNSVBJX1RYX0FDVElWRV9MQU5FUywKKwkubGFuZV9yYXRlX21icHMgPSBNSVBJX1RYX0xB
TkVfREFUQV9SQVRFX01CUFMsCisJLnJlZl9jbGtfa2h6ID0gTUlQSV9UWF9SRUZfQ0xLX0tIWiwK
KwkuY2ZnX2Nsa19raHogPSBNSVBJX1RYX0NGR19DTEtfS0haLAorCS5kYXRhX2lmID0gTUlQSV9J
Rl9QQVJBTExFTCwKKwkudHhfY3RybF9jZmcgPSB7CisJCQkuZnJhbWVzWzBdID0gJm1pcGl0eF9m
cmFtZTBfY2ZnLAorCQkJLmZyYW1lc1sxXSA9IE5VTEwsCisJCQkuZnJhbWVzWzJdID0gTlVMTCwK
KwkJCS5mcmFtZXNbM10gPSBOVUxMLAorCQkJLnR4X2RzaV9jZmcgPSAmbWlwaXR4X2RzaV9jZmcs
CisJCQkubGluZV9zeW5jX3BrdF9lbiA9IDAsCisJCQkubGluZV9jb3VudGVyX2FjdGl2ZSA9IDAs
CisJCQkuZnJhbWVfY291bnRlcl9hY3RpdmUgPSAwLAorCQkJLnR4X2Fsd2F5c191c2VfaGFjdCA9
IDEsCisJCQkudHhfaGFjdF93YWl0X3N0b3AgPSAxLAorCQkJfQorfTsKKworc3RydWN0ICBtaXBp
X2hzX2ZyZXFfcmFuZ2VfY2ZnIHsKKwl1MTYgZGVmYXVsdF9iaXRfcmF0ZV9tYnBzOworCXU4IGhz
ZnJlcXJhbmdlX2NvZGU7Cit9OworCitzdHJ1Y3QgdmNvX3BhcmFtcyB7CisJdTMyIGZyZXE7CisJ
dTMyIHJhbmdlOworCXUzMiBkaXZpZGVyOworfTsKKworc3RhdGljIHN0cnVjdCB2Y29fcGFyYW1z
IHZjb190YWJsZVtdID0geworCXs1MiwgMHgzZiwgOH0sCisJezgwLCAweDM5LCA4fSwKKwl7MTA1
LCAweDJmLCA0fSwKKwl7MTYwLCAweDI5LCA0fSwKKwl7MjEwLCAweDFmLCAyfSwKKwl7MzIwLCAw
eDE5LCAyfSwKKwl7NDIwLCAweDBmLCAxfSwKKwl7NjMwLCAweDA5LCAxfSwKKwl7MTEwMCwgMHgw
MywgMX0sCisJezB4ZmZmZiwgMHgwMSwgMX0sCit9OworCitzdGF0aWMgc3RydWN0IG1pcGlfaHNf
ZnJlcV9yYW5nZV9jZmcKK21pcGlfaHNfZnJlcV9yYW5nZVtNSVBJX0RQSFlfREVGQVVMVF9CSVRf
UkFURVNdID0geworCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gODAsIC5oc2ZyZXFyYW5nZV9j
b2RlID0gMHgwMH0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSA5MCwgLmhzZnJlcXJhbmdl
X2NvZGUgPSAweDEwfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDEwMCwgLmhzZnJlcXJh
bmdlX2NvZGUgPSAweDIwfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDExMCwgLmhzZnJl
cXJhbmdlX2NvZGUgPSAweDMwfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDEyMCwgLmhz
ZnJlcXJhbmdlX2NvZGUgPSAweDAxfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDEzMCwg
LmhzZnJlcXJhbmdlX2NvZGUgPSAweDExfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDE0
MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDIxfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9
IDE1MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDMxfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJw
cyA9IDE2MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDAyfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVf
bWJwcyA9IDE3MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDEyfSwKKwl7LmRlZmF1bHRfYml0X3Jh
dGVfbWJwcyA9IDE4MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDIyfSwKKwl7LmRlZmF1bHRfYml0
X3JhdGVfbWJwcyA9IDE5MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDMyfSwKKwl7LmRlZmF1bHRf
Yml0X3JhdGVfbWJwcyA9IDIwNSwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDAzfSwKKwl7LmRlZmF1
bHRfYml0X3JhdGVfbWJwcyA9IDIyMCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDEzfSwKKwl7LmRl
ZmF1bHRfYml0X3JhdGVfbWJwcyA9IDIzNSwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDIzfSwKKwl7
LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDI1MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDMzfSwK
Kwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDI3NSwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDA0
fSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDMwMCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAw
eDE0fSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDMyNSwgLmhzZnJlcXJhbmdlX2NvZGUg
PSAweDI1fSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDM1MCwgLmhzZnJlcXJhbmdlX2Nv
ZGUgPSAweDM1fSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDQwMCwgLmhzZnJlcXJhbmdl
X2NvZGUgPSAweDA1fSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDQ1MCwgLmhzZnJlcXJh
bmdlX2NvZGUgPSAweDE2fSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDUwMCwgLmhzZnJl
cXJhbmdlX2NvZGUgPSAweDI2fSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDU1MCwgLmhz
ZnJlcXJhbmdlX2NvZGUgPSAweDM3fSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDYwMCwg
LmhzZnJlcXJhbmdlX2NvZGUgPSAweDA3fSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDY1
MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDE4fSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9
IDcwMCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDI4fSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJw
cyA9IDc1MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDM5fSwKKwl7LmRlZmF1bHRfYml0X3JhdGVf
bWJwcyA9IDgwMCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDA5fSwKKwl7LmRlZmF1bHRfYml0X3Jh
dGVfbWJwcyA9IDg1MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDE5fSwKKwl7LmRlZmF1bHRfYml0
X3JhdGVfbWJwcyA9IDkwMCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDI5fSwKKwl7LmRlZmF1bHRf
Yml0X3JhdGVfbWJwcyA9IDEwMDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgwQX0sCisJey5kZWZh
dWx0X2JpdF9yYXRlX21icHMgPSAxMDUwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MUF9LAorCXsu
ZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTEwMCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDJBfSwK
Kwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDExNTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgz
Qn0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxMjAwLCAuaHNmcmVxcmFuZ2VfY29kZSA9
IDB4MEJ9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTI1MCwgLmhzZnJlcXJhbmdlX2Nv
ZGUgPSAweDFCfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDEzMDAsIC5oc2ZyZXFyYW5n
ZV9jb2RlID0gMHgyQn0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxMzUwLCAuaHNmcmVx
cmFuZ2VfY29kZSA9IDB4M0N9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTQwMCwgLmhz
ZnJlcXJhbmdlX2NvZGUgPSAweDBDfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDE0NTAs
IC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgxQ30sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAx
NTAwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MkN9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBz
ID0gMTU1MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDNEfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVf
bWJwcyA9IDE2MDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgwRH0sCisJey5kZWZhdWx0X2JpdF9y
YXRlX21icHMgPSAxNjUwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MUR9LAorCXsuZGVmYXVsdF9i
aXRfcmF0ZV9tYnBzID0gMTcwMCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDJFfSwKKwl7LmRlZmF1
bHRfYml0X3JhdGVfbWJwcyA9IDE3NTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgzRX0sCisJey5k
ZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxODAwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MEV9LAor
CXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTg1MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDFF
fSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDE5MDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0g
MHgyRn0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxOTUwLCAuaHNmcmVxcmFuZ2VfY29k
ZSA9IDB4M0Z9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMjAwMCwgLmhzZnJlcXJhbmdl
X2NvZGUgPSAweDBGfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDIwNTAsIC5oc2ZyZXFy
YW5nZV9jb2RlID0gMHg0MH0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAyMTAwLCAuaHNm
cmVxcmFuZ2VfY29kZSA9IDB4NDF9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMjE1MCwg
LmhzZnJlcXJhbmdlX2NvZGUgPSAweDQyfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDIy
MDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHg0M30sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMg
PSAyMjUwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4NDR9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9t
YnBzID0gMjMwMCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDQ1fSwKKwl7LmRlZmF1bHRfYml0X3Jh
dGVfbWJwcyA9IDIzNTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHg0Nn0sCisJey5kZWZhdWx0X2Jp
dF9yYXRlX21icHMgPSAyNDAwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4NDd9LAorCXsuZGVmYXVs
dF9iaXRfcmF0ZV9tYnBzID0gMjQ1MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDQ4fSwKKwl7LmRl
ZmF1bHRfYml0X3JhdGVfbWJwcyA9IDI1MDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHg0OX0KK307
CisKK3VuaW9uIG1pcGlfaXJxX2NmZyBpbnRfY2ZnID0geworCS5pcnFfY2ZnLmZyYW1lX2RvbmUg
PSAxLAorCS5pcnFfY2ZnLmN0cmxfZXJyb3IgPSAxLAorfTsKKworc3RhdGljIGVudW0gZHJtX21v
ZGVfc3RhdHVzCitrbWJfZHNpX21vZGVfdmFsaWQoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5l
Y3RvciwKKwkJICAgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUpCit7CisJc3RydWN0IGRy
bV9kZXZpY2UgKmRldiA9IGNvbm5lY3Rvci0+ZGV2OworCXN0cnVjdCBkcm1fbW9kZV9jb25maWcg
Km1vZGVfY29uZmlnID0gJmRldi0+bW9kZV9jb25maWc7CisKKwlpZiAobW9kZS0+aGRpc3BsYXkg
PCBtb2RlX2NvbmZpZy0+bWluX3dpZHRoIHx8CisJICAgIG1vZGUtPmhkaXNwbGF5ID4gbW9kZV9j
b25maWctPm1heF93aWR0aCkKKwkJcmV0dXJuIE1PREVfQkFEX0hWQUxVRTsKKworCWlmIChtb2Rl
LT52ZGlzcGxheSA8IG1vZGVfY29uZmlnLT5taW5faGVpZ2h0IHx8CisJICAgIG1vZGUtPnZkaXNw
bGF5ID4gbW9kZV9jb25maWctPm1heF9oZWlnaHQpCisJCXJldHVybiBNT0RFX0JBRF9WVkFMVUU7
CisKKwlyZXR1cm4gTU9ERV9PSzsKK30KKworc3RhdGljIGludCBrbWJfZHNpX2dldF9tb2Rlcyhz
dHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQoreworCWludCBudW1fbW9kZXMgPSAwOwor
CisJbnVtX21vZGVzID0gZHJtX2FkZF9tb2Rlc19ub2VkaWQoY29ubmVjdG9yLAorCQkJCQkgY29u
bmVjdG9yLT5kZXYtPm1vZGVfY29uZmlnLm1heF93aWR0aCwKKwkJCSBjb25uZWN0b3ItPmRldi0+
bW9kZV9jb25maWcubWF4X2hlaWdodCk7CisKKwlEUk1fSU5GTygid2lkdGg9JWQgaGVpZ2h0PSVk
XG4iLAorCQkgY29ubmVjdG9yLT5kZXYtPm1vZGVfY29uZmlnLm1heF93aWR0aCwKKwkJIGNvbm5l
Y3Rvci0+ZGV2LT5tb2RlX2NvbmZpZy5tYXhfaGVpZ2h0KTsKKwlEUk1fSU5GTygibnVtIG1vZGVz
PSVkXG4iLCBudW1fbW9kZXMpOworCisJcmV0dXJuIG51bV9tb2RlczsKK30KKwordm9pZCBrbWJf
ZHNpX2hvc3RfdW5yZWdpc3Rlcih2b2lkKQoreworCW1pcGlfZHNpX2hvc3RfdW5yZWdpc3Rlcihk
c2lfaG9zdCk7CisJa2ZyZWUoZHNpX2hvc3QpOworfQorCitzdGF0aWMgdm9pZCBrbWJfZHNpX2Nv
bm5lY3Rvcl9kZXN0cm95KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCit7CisJc3Ry
dWN0IGttYl9jb25uZWN0b3IgKmttYl9jb25uZWN0b3IgPSB0b19rbWJfY29ubmVjdG9yKGNvbm5l
Y3Rvcik7CisKKwlkcm1fY29ubmVjdG9yX2NsZWFudXAoY29ubmVjdG9yKTsKKwlrZnJlZShrbWJf
Y29ubmVjdG9yKTsKK30KKworc3RhdGljIHZvaWQga21iX2RzaV9lbmNvZGVyX2Rlc3Ryb3koc3Ry
dWN0IGRybV9lbmNvZGVyICplbmNvZGVyKQoreworCXN0cnVjdCBrbWJfZHNpICprbWJfZHNpID0g
dG9fa21iX2RzaShlbmNvZGVyKTsKKworCWlmICgha21iX2RzaSkKKwkJcmV0dXJuOworCisJa2Zy
ZWUoa21iX2RzaS0+ZHNpX2hvc3QpOworCisJZHJtX2VuY29kZXJfY2xlYW51cChlbmNvZGVyKTsK
KworCWttYl9kc2lfY29ubmVjdG9yX2Rlc3Ryb3koJmttYl9kc2ktPmF0dGFjaGVkX2Nvbm5lY3Rv
ci0+YmFzZSk7CisKKwlrZnJlZShrbWJfZHNpKTsKKwlpZiAoIWRzaV9kZXZpY2UpCisJCWtmcmVl
KGRzaV9kZXZpY2UpOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9lbmNvZGVyX2Z1bmNz
IGttYl9kc2lfZnVuY3MgPSB7CisJLmRlc3Ryb3kgPSBrbWJfZHNpX2VuY29kZXJfZGVzdHJveSwK
K307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QKK2RybV9jb25uZWN0b3JfaGVscGVyX2Z1bmNzIGtt
Yl9kc2lfY29ubmVjdG9yX2hlbHBlcl9mdW5jcyA9IHsKKwkuZ2V0X21vZGVzID0ga21iX2RzaV9n
ZXRfbW9kZXMsCisJLm1vZGVfdmFsaWQgPSBrbWJfZHNpX21vZGVfdmFsaWQsCit9OworCitzdGF0
aWMgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3JfZnVuY3Mga21iX2RzaV9jb25uZWN0b3JfZnVu
Y3MgPSB7CisJLmRlc3Ryb3kgPSBrbWJfZHNpX2Nvbm5lY3Rvcl9kZXN0cm95LAorCS5maWxsX21v
ZGVzID0gZHJtX2hlbHBlcl9wcm9iZV9zaW5nbGVfY29ubmVjdG9yX21vZGVzLAorCS5yZXNldCA9
IGRybV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9yZXNldCwKKwkuYXRvbWljX2Rlc3Ryb3lfc3Rh
dGUgPSBkcm1fYXRvbWljX2hlbHBlcl9jb25uZWN0b3JfZGVzdHJveV9zdGF0ZSwKKwkuYXRvbWlj
X2R1cGxpY2F0ZV9zdGF0ZSA9IGRybV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9kdXBsaWNhdGVf
c3RhdGUsCit9OworCitzdGF0aWMgc3NpemVfdCBrbWJfZHNpX2hvc3RfdHJhbnNmZXIoc3RydWN0
IG1pcGlfZHNpX2hvc3QgKmhvc3QsCisJCQkJICAgICBjb25zdCBzdHJ1Y3QgbWlwaV9kc2lfbXNn
ICptc2cpCit7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQga21iX2RzaV9ob3N0X2F0dGFj
aChzdHJ1Y3QgbWlwaV9kc2lfaG9zdCAqaG9zdCwKKwkJCSAgICAgICBzdHJ1Y3QgbWlwaV9kc2lf
ZGV2aWNlICpkZXYpCit7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQga21iX2RzaV9ob3N0
X2RldGFjaChzdHJ1Y3QgbWlwaV9kc2lfaG9zdCAqaG9zdCwKKwkJCSAgICAgICBzdHJ1Y3QgbWlw
aV9kc2lfZGV2aWNlICpkZXYpCit7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1
Y3QgbWlwaV9kc2lfaG9zdF9vcHMga21iX2RzaV9ob3N0X29wcyA9IHsKKwkuYXR0YWNoID0ga21i
X2RzaV9ob3N0X2F0dGFjaCwKKwkuZGV0YWNoID0ga21iX2RzaV9ob3N0X2RldGFjaCwKKwkudHJh
bnNmZXIgPSBrbWJfZHNpX2hvc3RfdHJhbnNmZXIsCit9OworCitzdGF0aWMgc3RydWN0IGttYl9k
c2lfaG9zdCAqa21iX2RzaV9ob3N0X2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRybSwKKwkJCQkJ
ICAgICAgc3RydWN0IGttYl9kc2kgKmttYl9kc2kpCit7CisJc3RydWN0IGttYl9kc2lfaG9zdCAq
aG9zdDsKKworCWhvc3QgPSBremFsbG9jKHNpemVvZigqaG9zdCksIEdGUF9LRVJORUwpOworCWlm
ICghaG9zdCkKKwkJcmV0dXJuIE5VTEw7CisKKwlob3N0LT5iYXNlID0gZHNpX2hvc3Q7CisJaG9z
dC0+YmFzZS0+b3BzID0gJmttYl9kc2lfaG9zdF9vcHM7CisJaG9zdC0+a21iX2RzaSA9IGttYl9k
c2k7CisKKwlob3N0LT5iYXNlLT5kZXYgPSBkcm0tPmRldjsKKworCWRzaV9kZXZpY2UtPmhvc3Qg
PSBob3N0LT5iYXNlOworCWhvc3QtPmRldmljZSA9IGRzaV9kZXZpY2U7CisJcmV0dXJuIGhvc3Q7
Cit9CisKK3N0cnVjdCBkcm1fYnJpZGdlICprbWJfZHNpX2hvc3RfYnJpZGdlX2luaXQoc3RydWN0
IGRldmljZSAqZGV2KQoreworCXN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UgPSBOVUxMOworCXN0
cnVjdCBkZXZpY2Vfbm9kZSAqZW5jb2Rlcl9ub2RlOworCisJLyogQ3JlYXRlIGFuZCByZWdpc3Rl
ciBNSVBJIERTSSBob3N0ICovCisJaWYgKCFkc2lfaG9zdCkgeworCQlkc2lfaG9zdCA9IGt6YWxs
b2Moc2l6ZW9mKCpkc2lfaG9zdCksIEdGUF9LRVJORUwpOworCQlpZiAoIWRzaV9ob3N0KQorCQkJ
cmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7CisKKwkJZHNpX2hvc3QtPm9wcyA9ICZrbWJfZHNpX2hv
c3Rfb3BzOworCisJCWlmICghZHNpX2RldmljZSkgeworCQkJZHNpX2RldmljZSA9IGt6YWxsb2Mo
c2l6ZW9mKCpkc2lfZGV2aWNlKSwgR0ZQX0tFUk5FTCk7CisJCQlpZiAoIWRzaV9kZXZpY2UpIHsK
KwkJCQlrZnJlZShkc2lfaG9zdCk7CisJCQkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7CisJCQl9
CisJCX0KKworCQlkc2lfaG9zdC0+ZGV2ID0gZGV2OworCQltaXBpX2RzaV9ob3N0X3JlZ2lzdGVy
KGRzaV9ob3N0KTsKKwl9CisJLyogRmluZCBBRFY3NTM1IG5vZGUgYW5kIGluaXRpYWxpemUgaXQg
Ki8KKwllbmNvZGVyX25vZGUgPSBvZl9wYXJzZV9waGFuZGxlKGRldi0+b2Zfbm9kZSwgImVuY29k
ZXItc2xhdmUiLCAwKTsKKworCWlmICghZW5jb2Rlcl9ub2RlKSB7CisJCURSTV9FUlJPUigiRmFp
bGVkIHRvIGdldCBicmlkZ2UgaW5mbyBmcm9tIERUXG4iKTsKKwkJcmV0dXJuIEVSUl9QVFIoLUVJ
TlZBTCk7CisJfQorCisJLyogTG9jYXRlIGRybSBicmlkZ2UgZnJvbSB0aGUgaGRtaSBlbmNvZGVy
IERUIG5vZGUgKi8KKwlicmlkZ2UgPSBvZl9kcm1fZmluZF9icmlkZ2UoZW5jb2Rlcl9ub2RlKTsK
KwlvZl9ub2RlX3B1dChlbmNvZGVyX25vZGUpOworCWlmICghYnJpZGdlKSB7CisJCURSTV9JTkZP
KCJXYWl0IGZvciBleHRlcm5hbCBicmlkZ2UgZHJpdmVyIERUXG4iKTsKKwkJcmV0dXJuIEVSUl9Q
VFIoLUVQUk9CRV9ERUZFUik7CisJfQorCXJldHVybiBicmlkZ2U7Cit9CisKK3UzMiBtaXBpX2dl
dF9kYXRhdHlwZV9wYXJhbXModTMyIGRhdGFfdHlwZSwgdTMyIGRhdGFfbW9kZSwKKwkJCSAgICAg
c3RydWN0IG1pcGlfZGF0YV90eXBlX3BhcmFtcyAqcGFyYW1zKQoreworCXN0cnVjdCBtaXBpX2Rh
dGFfdHlwZV9wYXJhbXMgZGF0YV90eXBlX3BhcmFtOworCisJc3dpdGNoIChkYXRhX3R5cGUpIHsK
KwljYXNlIERTSV9MUF9EVF9QUFNfWUNCQ1I0MjBfMTJCOgorCQlkYXRhX3R5cGVfcGFyYW0uc2l6
ZV9jb25zdHJhaW50X3BpeGVscyA9IDI7CisJCWRhdGFfdHlwZV9wYXJhbS5zaXplX2NvbnN0cmFp
bnRfYnl0ZXMgPSAzOworCQlzd2l0Y2ggKGRhdGFfbW9kZSkgeworCQkJLyogQ2FzZSAwIG5vdCBz
dXBwb3J0ZWQgYWNjb3JkaW5nIHRvIE1ESyAqLworCQljYXNlIDE6CisJCWNhc2UgMjoKKwkJY2Fz
ZSAzOgorCQkJZGF0YV90eXBlX3BhcmFtLnBpeGVsc19wZXJfcGNsayA9IDI7CisJCQlkYXRhX3R5
cGVfcGFyYW0uYml0c19wZXJfcGNsayA9IDI0OworCQkJYnJlYWs7CisJCWRlZmF1bHQ6CisJCQlE
Uk1fRVJST1IoIkRTSTogSW52YWxpZCBkYXRhX21vZGUgJWRcbiIsIGRhdGFfbW9kZSk7CisJCQly
ZXR1cm4gLUVJTlZBTDsKKwkJfTsKKwkJYnJlYWs7CisJY2FzZSBEU0lfTFBfRFRfUFBTX1lDQkNS
NDIyXzE2QjoKKwkJZGF0YV90eXBlX3BhcmFtLnNpemVfY29uc3RyYWludF9waXhlbHMgPSAyOwor
CQlkYXRhX3R5cGVfcGFyYW0uc2l6ZV9jb25zdHJhaW50X2J5dGVzID0gNDsKKwkJc3dpdGNoIChk
YXRhX21vZGUpIHsKKwkJCS8qIENhc2UgMCBhbmQgMSBub3Qgc3VwcG9ydGVkIGFjY29yZGluZwor
CQkJICogdG8gTURLCisJCQkgKi8KKwkJY2FzZSAyOgorCQkJZGF0YV90eXBlX3BhcmFtLnBpeGVs
c19wZXJfcGNsayA9IDE7CisJCQlkYXRhX3R5cGVfcGFyYW0uYml0c19wZXJfcGNsayA9IDE2Owor
CQkJYnJlYWs7CisJCWNhc2UgMzoKKwkJCWRhdGFfdHlwZV9wYXJhbS5waXhlbHNfcGVyX3BjbGsg
PSAyOworCQkJZGF0YV90eXBlX3BhcmFtLmJpdHNfcGVyX3BjbGsgPSAzMjsKKwkJCWJyZWFrOwor
CQlkZWZhdWx0OgorCQkJRFJNX0VSUk9SKCJEU0k6IEludmFsaWQgZGF0YV9tb2RlICVkXG4iLCBk
YXRhX21vZGUpOworCQkJcmV0dXJuIC1FSU5WQUw7CisJCX07CisJCWJyZWFrOworCWNhc2UgRFNJ
X0xQX0RUX0xQUFNfWUNCQ1I0MjJfMjBCOgorCWNhc2UgRFNJX0xQX0RUX1BQU19ZQ0JDUjQyMl8y
NEI6CisJCWRhdGFfdHlwZV9wYXJhbS5zaXplX2NvbnN0cmFpbnRfcGl4ZWxzID0gMjsKKwkJZGF0
YV90eXBlX3BhcmFtLnNpemVfY29uc3RyYWludF9ieXRlcyA9IDY7CisJCXN3aXRjaCAoZGF0YV9t
b2RlKSB7CisJCQkvKiBDYXNlIDAgbm90IHN1cHBvcnRlZCBhY2NvcmRpbmcgdG8gTURLICovCisJ
CWNhc2UgMToKKwkJY2FzZSAyOgorCQljYXNlIDM6CisJCQlkYXRhX3R5cGVfcGFyYW0ucGl4ZWxz
X3Blcl9wY2xrID0gMTsKKwkJCWRhdGFfdHlwZV9wYXJhbS5iaXRzX3Blcl9wY2xrID0gMjQ7CisJ
CQlicmVhazsKKwkJZGVmYXVsdDoKKwkJCURSTV9FUlJPUigiRFNJOiBJbnZhbGlkIGRhdGFfbW9k
ZSAlZFxuIiwgZGF0YV9tb2RlKTsKKwkJCXJldHVybiAtRUlOVkFMOworCQl9OworCQlicmVhazsK
KwljYXNlIERTSV9MUF9EVF9QUFNfUkdCNTY1XzE2QjoKKwkJZGF0YV90eXBlX3BhcmFtLnNpemVf
Y29uc3RyYWludF9waXhlbHMgPSAxOworCQlkYXRhX3R5cGVfcGFyYW0uc2l6ZV9jb25zdHJhaW50
X2J5dGVzID0gMjsKKwkJc3dpdGNoIChkYXRhX21vZGUpIHsKKwkJY2FzZSAwOgorCQljYXNlIDE6
CisJCQlkYXRhX3R5cGVfcGFyYW0ucGl4ZWxzX3Blcl9wY2xrID0gMTsKKwkJCWRhdGFfdHlwZV9w
YXJhbS5iaXRzX3Blcl9wY2xrID0gMTY7CisJCQlicmVhazsKKwkJY2FzZSAyOgorCQljYXNlIDM6
CisJCQlkYXRhX3R5cGVfcGFyYW0ucGl4ZWxzX3Blcl9wY2xrID0gMjsKKwkJCWRhdGFfdHlwZV9w
YXJhbS5iaXRzX3Blcl9wY2xrID0gMzI7CisJCQlicmVhazsKKwkJZGVmYXVsdDoKKwkJCURSTV9F
UlJPUigiRFNJOiBJbnZhbGlkIGRhdGFfbW9kZSAlZFxuIiwgZGF0YV9tb2RlKTsKKwkJCXJldHVy
biAtRUlOVkFMOworCQl9OworCQlicmVhazsKKwljYXNlIERTSV9MUF9EVF9QUFNfUkdCNjY2XzE4
QjoKKwkJZGF0YV90eXBlX3BhcmFtLnNpemVfY29uc3RyYWludF9waXhlbHMgPSA0OworCQlkYXRh
X3R5cGVfcGFyYW0uc2l6ZV9jb25zdHJhaW50X2J5dGVzID0gOTsKKwkJZGF0YV90eXBlX3BhcmFt
LmJpdHNfcGVyX3BjbGsgPSAxODsKKwkJZGF0YV90eXBlX3BhcmFtLnBpeGVsc19wZXJfcGNsayA9
IDE7CisJCWJyZWFrOworCWNhc2UgRFNJX0xQX0RUX0xQUFNfUkdCNjY2XzE4QjoKKwljYXNlIERT
SV9MUF9EVF9QUFNfUkdCODg4XzI0QjoKKwkJZGF0YV90eXBlX3BhcmFtLnNpemVfY29uc3RyYWlu
dF9waXhlbHMgPSAxOworCQlkYXRhX3R5cGVfcGFyYW0uc2l6ZV9jb25zdHJhaW50X2J5dGVzID0g
MzsKKwkJZGF0YV90eXBlX3BhcmFtLmJpdHNfcGVyX3BjbGsgPSAyNDsKKwkJZGF0YV90eXBlX3Bh
cmFtLnBpeGVsc19wZXJfcGNsayA9IDE7CisJCWJyZWFrOworCWNhc2UgRFNJX0xQX0RUX1BQU19S
R0IxMDEwMTBfMzBCOgorCQlkYXRhX3R5cGVfcGFyYW0uc2l6ZV9jb25zdHJhaW50X3BpeGVscyA9
IDQ7CisJCWRhdGFfdHlwZV9wYXJhbS5zaXplX2NvbnN0cmFpbnRfYnl0ZXMgPSAxNTsKKwkJZGF0
YV90eXBlX3BhcmFtLmJpdHNfcGVyX3BjbGsgPSAzMDsKKwkJZGF0YV90eXBlX3BhcmFtLnBpeGVs
c19wZXJfcGNsayA9IDE7CisJCWJyZWFrOworCWRlZmF1bHQ6CisJCURSTV9FUlJPUigiRFNJOiBJ
bnZhbGlkIGRhdGFfdHlwZSAlZFxuIiwgZGF0YV90eXBlKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJ
fTsKKworCSpwYXJhbXMgPSBkYXRhX3R5cGVfcGFyYW07CisJcmV0dXJuIDA7Cit9CisKK3N0YXRp
YyB1MzIgY29tcHV0ZV93Yyh1MzIgd2lkdGhfcHgsIHU4IHNpemVfY29uc3RyX3AsIHU4IHNpemVf
Y29uc3RyX2IpCit7CisJLyogQ2FsY3VsYXRlIHRoZSB3b3JkIGNvdW50IGZvciBlYWNoIGxvbmcg
cGFja2V0ICovCisJcmV0dXJuICgoKHdpZHRoX3B4IC8gc2l6ZV9jb25zdHJfcCkgKiBzaXplX2Nv
bnN0cl9iKSAmIDB4ZmZmZik7Cit9CisKK3N0YXRpYyB1MzIgY29tcHV0ZV91bnBhY2tlZF9ieXRl
cyh1MzIgd2MsIHU4IGJpdHNfcGVyX3BjbGspCit7CisJLyogTnVtYmVyIG9mIFBDTEsgY3ljbGVz
IG5lZWRlZCB0byB0cmFuc2ZlciBhIGxpbmUKKwkgKiB3aXRoIGVhY2ggUENMSyBjeWNsZSwgNCBC
eXRlcyBhcmUgc2VudCB0aHJvdWdoIHRoZSBQUEwgbW9kdWxlCisJICovCisJcmV0dXJuICgod2Mg
KiA4KSAvIGJpdHNfcGVyX3BjbGspICogNDsKK30KKworc3RhdGljIHUzMiBtaXBpX3R4X2ZnX3Nl
Y3Rpb25fY2ZnX3JlZ3Moc3RydWN0IGttYl9kcm1fcHJpdmF0ZSAqa21iLAorCQkJCSAgICAgICB1
OCBmcmFtZV9pZCwgdTggc2VjdGlvbiwKKwkJCQkgICAgICAgdTMyIGhlaWdodF9saW5lcywgdTMy
IHVucGFja2VkX2J5dGVzLAorCQkJCSAgICAgICBzdHJ1Y3QgbWlwaV90eF9mcmFtZV9zZWN0X3Bo
Y2ZnICpwaF9jZmcpCit7CisJdTMyIGNmZyA9IDA7CisJdTMyIGN0cmxfbm8gPSBNSVBJX0NUUkw2
OworCXUzMiByZWdfYWRyOworCisJLyogRnJhbWUgc2VjdGlvbiBwYWNrZXQgaGVhZGVyICovCisJ
LyogV29yZCBjb3VudCBiaXRzIFsxNTowXSAqLworCWNmZyA9IChwaF9jZmctPndjICYgTUlQSV9U
WF9TRUNUX1dDX01BU0spIDw8IDA7CisKKwkvKiBEYXRhIHR5cGUgKGJpdHMgWzIxOjE2XSkgKi8K
KwljZmcgfD0gKChwaF9jZmctPmRhdGFfdHlwZSAmIE1JUElfVFhfU0VDVF9EVF9NQVNLKQorCQk8
PCBNSVBJX1RYX1NFQ1RfRFRfU0hJRlQpOworCisJLyogVmlydHVhbCBjaGFubmVsIChiaXRzIFsy
MzoyMl0pICovCisJY2ZnIHw9ICgocGhfY2ZnLT52Y2hhbm5lbCAmIE1JUElfVFhfU0VDVF9WQ19N
QVNLKQorCQk8PCBNSVBJX1RYX1NFQ1RfVkNfU0hJRlQpOworCisJLyogRGF0YSBtb2RlIChiaXRz
IFsyNDoyNV0pICovCisJY2ZnIHw9ICgocGhfY2ZnLT5kYXRhX21vZGUgJiBNSVBJX1RYX1NFQ1Rf
RE1fTUFTSykKKwkJPDwgTUlQSV9UWF9TRUNUX0RNX1NISUZUKTsKKwlpZiAocGhfY2ZnLT5kbWFf
cGFja2VkKQorCQljZmcgfD0gTUlQSV9UWF9TRUNUX0RNQV9QQUNLRUQ7CisKKwlkcm1fZGJnKCZr
bWItPmRybSwKKwkJImN0cmw9JWQgZnJhbWVfaWQ9JWQgc2VjdGlvbj0lZCBjZmc9JXggcGFja2Vk
PSVkXG4iLAorCQkgIGN0cmxfbm8sIGZyYW1lX2lkLCBzZWN0aW9uLCBjZmcsIHBoX2NmZy0+ZG1h
X3BhY2tlZCk7CisJa21iX3dyaXRlX21pcGkoa21iLAorCQkgICAgICAgKE1JUElfVFhtX0hTX0ZH
bl9TRUNUb19QSChjdHJsX25vLCBmcmFtZV9pZCwgc2VjdGlvbikpLAorCQkgICAgICAgY2ZnKTsK
KworCS8qIFVucGFja2VkIGJ5dGVzICovCisKKwkvKiBUaGVyZSBhcmUgNCBmcmFtZSBnZW5lcmF0
b3JzIGFuZCBlYWNoIGZnIGhhcyA0IHNlY3Rpb25zCisJICogVGhlcmUgYXJlIDIgcmVnaXN0ZXJz
IGZvciB1bnBhY2tlZCBieXRlcyAoIyBieXRlcyBlYWNoCisJICogc2VjdGlvbiBvY2N1cGllcyBp
biBtZW1vcnkpCisJICogUkVHX1VOUEFDS0VEX0JZVEVTMDogWzE1OjBdLUJZVEVTMCwgWzMxOjE2
XS1CWVRFUzEKKwkgKiBSRUdfVU5QQUNLRURfQllURVMxOiBbMTU6MF0tQllURVMyLCBbMzE6MTZd
LUJZVEVTMworCSAqLworCXJlZ19hZHIgPQorCSAgICBNSVBJX1RYbV9IU19GR25fU0VDVF9VTlBB
Q0tFRF9CWVRFUzAoY3RybF9ubywKKwkJCQkJCSBmcmFtZV9pZCkgKyAoc2VjdGlvbiAvIDIpICog
NDsKKwlrbWJfd3JpdGVfYml0c19taXBpKGttYiwgcmVnX2FkciwgKHNlY3Rpb24gJSAyKSAqIDE2
LCAxNiwKKwkJCSAgICB1bnBhY2tlZF9ieXRlcyk7CisJZHJtX2RiZygma21iLT5kcm0sCisJCSJ1
bnBhY2tlZF9ieXRlcyA9ICVkLCB3b3JkY291bnQgPSAlZFxuIiwgdW5wYWNrZWRfYnl0ZXMsCisJ
CSAgcGhfY2ZnLT53Yyk7CisKKwkvKiBMaW5lIGNvbmZpZyAqLworCXJlZ19hZHIgPSBNSVBJX1RY
bV9IU19GR25fU0VDVG9fTElORV9DRkcoY3RybF9ubywgZnJhbWVfaWQsIHNlY3Rpb24pOworCWtt
Yl93cml0ZV9taXBpKGttYiwgcmVnX2FkciwgaGVpZ2h0X2xpbmVzKTsKKwlyZXR1cm4gMDsKK30K
Kworc3RhdGljIHUzMiBtaXBpX3R4X2ZnX3NlY3Rpb25fY2ZnKHN0cnVjdCBrbWJfZHJtX3ByaXZh
dGUgKmttYiwKKwkJCQkgIHU4IGZyYW1lX2lkLCB1OCBzZWN0aW9uLAorCQkJCSAgc3RydWN0IG1p
cGlfdHhfZnJhbWVfc2VjdGlvbl9jZmcgKmZyYW1lX3NjZmcsCisJCQkJICB1MzIgKmJpdHNfcGVy
X3BjbGssIHUzMiAqd2MpCit7CisJdTMyIHJldCA9IDA7CisJdTMyIHVucGFja2VkX2J5dGVzOwor
CXN0cnVjdCBtaXBpX2RhdGFfdHlwZV9wYXJhbXMgZGF0YV90eXBlX3BhcmFtZXRlcnM7CisJc3Ry
dWN0IG1pcGlfdHhfZnJhbWVfc2VjdF9waGNmZyBwaF9jZmc7CisKKwlyZXQgPSBtaXBpX2dldF9k
YXRhdHlwZV9wYXJhbXMoZnJhbWVfc2NmZy0+ZGF0YV90eXBlLAorCQkJCSAgICAgICBmcmFtZV9z
Y2ZnLT5kYXRhX21vZGUsCisJCQkJICAgICAgICZkYXRhX3R5cGVfcGFyYW1ldGVycyk7CisJaWYg
KHJldCkKKwkJcmV0dXJuIHJldDsKKworCS8qIFBhY2tldCB3aWR0aCBoYXMgdG8gYmUgYSBtdWx0
aXBsZSBvZiB0aGUgbWluaW11bSBwYWNrZXQgd2lkdGgKKwkgKiAoaW4gcGl4ZWxzKSBzZXQgZm9y
IGVhY2ggZGF0YSB0eXBlCisJICovCisJaWYgKGZyYW1lX3NjZmctPndpZHRoX3BpeGVscyAlCisJ
ICAgIGRhdGFfdHlwZV9wYXJhbWV0ZXJzLnNpemVfY29uc3RyYWludF9waXhlbHMgIT0gMCkKKwkJ
cmV0dXJuIC1FSU5WQUw7CisKKwkqd2MgPSBjb21wdXRlX3djKGZyYW1lX3NjZmctPndpZHRoX3Bp
eGVscywKKwkJCSBkYXRhX3R5cGVfcGFyYW1ldGVycy5zaXplX2NvbnN0cmFpbnRfcGl4ZWxzLAor
CQkJIGRhdGFfdHlwZV9wYXJhbWV0ZXJzLnNpemVfY29uc3RyYWludF9ieXRlcyk7CisJdW5wYWNr
ZWRfYnl0ZXMgPSBjb21wdXRlX3VucGFja2VkX2J5dGVzKCp3YywKKwkJCQkJCWRhdGFfdHlwZV9w
YXJhbWV0ZXJzLmJpdHNfcGVyX3BjbGspOworCXBoX2NmZy53YyA9ICp3YzsKKwlwaF9jZmcuZGF0
YV9tb2RlID0gZnJhbWVfc2NmZy0+ZGF0YV9tb2RlOworCXBoX2NmZy5kYXRhX3R5cGUgPSBmcmFt
ZV9zY2ZnLT5kYXRhX3R5cGU7CisJcGhfY2ZnLmRtYV9wYWNrZWQgPSBmcmFtZV9zY2ZnLT5kbWFf
cGFja2VkOworCXBoX2NmZy52Y2hhbm5lbCA9IGZyYW1lX2lkOworCisJbWlwaV90eF9mZ19zZWN0
aW9uX2NmZ19yZWdzKGttYiwgZnJhbWVfaWQsIHNlY3Rpb24sCisJCQkJICAgIGZyYW1lX3NjZmct
PmhlaWdodF9saW5lcywKKwkJCQkgICAgdW5wYWNrZWRfYnl0ZXMsICZwaF9jZmcpOworCisJLyog
Q2FsbGVyIG5lZWRzIGJpdHNfcGVyX2NsayBmb3IgYWRkaXRpb25hbCBjYWx1Y2xhdGlvbnMgKi8K
KwkqYml0c19wZXJfcGNsayA9IGRhdGFfdHlwZV9wYXJhbWV0ZXJzLmJpdHNfcGVyX3BjbGs7CisK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgbWlwaV90eF9mZ19jZmdfcmVncyhzdHJ1Y3Qg
a21iX2RybV9wcml2YXRlICprbWIsIHU4IGZyYW1lX2dlbiwKKwkJCQlzdHJ1Y3QgbWlwaV90eF9m
cmFtZV90aW1pbmdfY2ZnICpmZ19jZmcpCit7CisJdTMyIHN5c2NsazsKKwl1MzIgcHBsX2xscF9y
YXRpbzsKKwl1MzIgY3RybF9ubyA9IE1JUElfQ1RSTDYsIHJlZ19hZHIsIHZhbCwgb2Zmc2V0Owor
CisJLyogNTAwIE1oeiBzeXN0ZW0gY2xvY2sgbWludXMgNTAgdG8gYWNjb3VudCBmb3IgdGhlIGRp
ZmZlcmVuY2UgaW4KKwkgKiBNSVBJIGNsb2NrIHNwZWVkIGluIFJUTCB0ZXN0cworCSAqLworCXN5
c2NsayA9IGttYi0+c3lzX2Nsa19taHogLSA1MDsKKworCS8qIFBQTC1QaXhlbCBQYWNraW5nIExh
eWVyLCBMTFAtTG93IExldmVsIFByb3RvY29sCisJICogRnJhbWUgZ2VuYXJ0b3IgdGltaW5nIHBh
cmFtZXRlcnMgYXJlIGNsb2NrZWQgb24gdGhlIHN5c3RlbSBjbG9jaywKKwkgKiB3aGVyZWFzIGFz
IHRoZSBlcXVpdmFsZW50IHBhcmFtZXRlcnMgaW4gdGhlIExMUCBibG9ja3MgYXJlIGNsb2NrZWQK
KwkgKiBvbiBMTFAgVHggY2xvY2sgZnJvbSB0aGUgRC1QSFkgLSBCWVRFIGNsb2NrCisJICovCisK
KwkvKiBNdWx0aXBseSBieSAxMDAwIHRvIG1haW50YWluIHByZWNpc2lvbiAqLworCXBwbF9sbHBf
cmF0aW8gPSAoKGZnX2NmZy0+YnBwIC8gOCkgKiBzeXNjbGsgKiAxMDAwKSAvCisJICAgICgoZmdf
Y2ZnLT5sYW5lX3JhdGVfbWJwcyAvIDgpICogZmdfY2ZnLT5hY3RpdmVfbGFuZXMpOworCisJZHJt
X2RiZygma21iLT5kcm0sICJwcGxfbGxwX3JhdGlvPSVkXG4iLCBwcGxfbGxwX3JhdGlvKTsKKwlk
cm1fZGJnKCZrbWItPmRybSwgImJwcD0lZCBzeXNjbGs9JWQgbGFuZS1yYXRlPSVkIGFjdGl2ZS1s
YW5lcz0lZFxuIiwKKwkJZmdfY2ZnLT5icHAsIHN5c2NsaywgZmdfY2ZnLT5sYW5lX3JhdGVfbWJw
cywKKwkJIGZnX2NmZy0+YWN0aXZlX2xhbmVzKTsKKworCS8qIEZyYW1lIGdlbmVyYXRvciBudW1i
ZXIgb2YgbGluZXMgKi8KKwlyZWdfYWRyID0gTUlQSV9UWG1fSFNfRkduX05VTV9MSU5FUyhjdHJs
X25vLCBmcmFtZV9nZW4pOworCWttYl93cml0ZV9taXBpKGttYiwgcmVnX2FkciwgZmdfY2ZnLT52
X2FjdGl2ZSk7CisKKwkvKiB2c3luYyB3aWR0aAorCSAqIFRoZXJlIGFyZSAyIHJlZ2lzdGVycyBm
b3IgdnN5bmMgd2lkdGggKFZTQSBpbiBsaW5lcyBmb3IKKwkgKiBjaGFubmVscyAwLTMpCisJICog
UkVHX1ZTWU5DX1dJRFRIMDogWzE1OjBdLVZTQSBmb3IgY2hhbm5lbDAsIFszMToxNl0tVlNBIGZv
ciBjaGFubmVsMQorCSAqIFJFR19WU1lOQ19XSURUSDE6IFsxNTowXS1WU0EgZm9yIGNoYW5uZWwy
LCBbMzE6MTZdLVZTQSBmb3IgY2hhbm5lbDMKKwkgKi8KKwlvZmZzZXQgPSAoZnJhbWVfZ2VuICUg
MikgKiAxNjsKKwlyZWdfYWRyID0gTUlQSV9UWG1fSFNfVlNZTkNfV0lEVEhuKGN0cmxfbm8sIGZy
YW1lX2dlbiAvIDIpOworCWttYl93cml0ZV9iaXRzX21pcGkoa21iLCByZWdfYWRyLCBvZmZzZXQs
IDE2LCBmZ19jZmctPnZzeW5jX3dpZHRoKTsKKworCS8qIHZlcnRpY2FsIGJhY2twb3JjaCAodmJw
KSAqLworCXJlZ19hZHIgPSBNSVBJX1RYbV9IU19WX0JBQ0tQT1JDSEVTbihjdHJsX25vLCBmcmFt
ZV9nZW4gLyAyKTsKKwlrbWJfd3JpdGVfYml0c19taXBpKGttYiwgcmVnX2Fkciwgb2Zmc2V0LCAx
NiwgZmdfY2ZnLT52X2JhY2twb3JjaCk7CisKKwkvKiB2ZXJ0aWNhbCBmcm9udHBvcmNoICh2ZnAp
ICovCisJcmVnX2FkciA9IE1JUElfVFhtX0hTX1ZfRlJPTlRQT1JDSEVTbihjdHJsX25vLCBmcmFt
ZV9nZW4gLyAyKTsKKwlrbWJfd3JpdGVfYml0c19taXBpKGttYiwgcmVnX2Fkciwgb2Zmc2V0LCAx
NiwgZmdfY2ZnLT52X2Zyb250cG9yY2gpOworCisJLyogdmVydGljYWwgYWN0aXZlICh2YWN0aXZl
KSAqLworCXJlZ19hZHIgPSBNSVBJX1RYbV9IU19WX0FDVElWRW4oY3RybF9ubywgZnJhbWVfZ2Vu
IC8gMik7CisJa21iX3dyaXRlX2JpdHNfbWlwaShrbWIsIHJlZ19hZHIsIG9mZnNldCwgMTYsIGZn
X2NmZy0+dl9hY3RpdmUpOworCisJLyogaHN5bmMgd2lkdGggKi8KKwlyZWdfYWRyID0gTUlQSV9U
WG1fSFNfSFNZTkNfV0lEVEhuKGN0cmxfbm8sIGZyYW1lX2dlbik7CisJa21iX3dyaXRlX21pcGko
a21iLCByZWdfYWRyLAorCQkgICAgICAgKGZnX2NmZy0+aHN5bmNfd2lkdGggKiBwcGxfbGxwX3Jh
dGlvKSAvIDEwMDApOworCisJLyogaG9yaXpvbnRhbCBiYWNrcG9yY2ggKGhicCkgKi8KKwlyZWdf
YWRyID0gTUlQSV9UWG1fSFNfSF9CQUNLUE9SQ0huKGN0cmxfbm8sIGZyYW1lX2dlbik7CisJa21i
X3dyaXRlX21pcGkoa21iLCByZWdfYWRyLAorCQkgICAgICAgKGZnX2NmZy0+aF9iYWNrcG9yY2gg
KiBwcGxfbGxwX3JhdGlvKSAvIDEwMDApOworCisJLyogaG9yaXpvbnRhbCBmcm9udHBvcmNoICho
ZnApICovCisJcmVnX2FkciA9IE1JUElfVFhtX0hTX0hfRlJPTlRQT1JDSG4oY3RybF9ubywgZnJh
bWVfZ2VuKTsKKwlrbWJfd3JpdGVfbWlwaShrbWIsIHJlZ19hZHIsCisJCSAgICAgICAoZmdfY2Zn
LT5oX2Zyb250cG9yY2ggKiBwcGxfbGxwX3JhdGlvKSAvIDEwMDApOworCisJLyogaG9yaXpvbnRh
bCBhY3RpdmUgKGhhKSAqLworCXJlZ19hZHIgPSBNSVBJX1RYbV9IU19IX0FDVElWRW4oY3RybF9u
bywgZnJhbWVfZ2VuKTsKKworCS8qIGNvbnZlcnQgaF9hY3RpdmUgd2hpY2ggaXMgd2MgaW4gYnl0
ZXMgdG8gY3ljbGVzICovCisJdmFsID0gKGZnX2NmZy0+aF9hY3RpdmUgKiBzeXNjbGsgKiAxMDAw
KSAvCisJICAgICgoZmdfY2ZnLT5sYW5lX3JhdGVfbWJwcyAvIDgpICogZmdfY2ZnLT5hY3RpdmVf
bGFuZXMpOworCXZhbCAvPSAxMDAwOworCWttYl93cml0ZV9taXBpKGttYiwgcmVnX2FkciwgdmFs
KTsKKworCS8qIGxscCBoc3luYyB3aWR0aCAqLworCXJlZ19hZHIgPSBNSVBJX1RYbV9IU19MTFBf
SFNZTkNfV0lEVEhuKGN0cmxfbm8sIGZyYW1lX2dlbik7CisJa21iX3dyaXRlX21pcGkoa21iLCBy
ZWdfYWRyLCBmZ19jZmctPmhzeW5jX3dpZHRoICogKGZnX2NmZy0+YnBwIC8gOCkpOworCisJLyog
bGxwIGggYmFja3BvcmNoICovCisJcmVnX2FkciA9IE1JUElfVFhtX0hTX0xMUF9IX0JBQ0tQT1JD
SG4oY3RybF9ubywgZnJhbWVfZ2VuKTsKKwlrbWJfd3JpdGVfbWlwaShrbWIsIHJlZ19hZHIsIGZn
X2NmZy0+aF9iYWNrcG9yY2ggKiAoZmdfY2ZnLT5icHAgLyA4KSk7CisKKwkvKiBsbHAgaCBmcm9u
dHBvcmNoICovCisJcmVnX2FkciA9IE1JUElfVFhtX0hTX0xMUF9IX0ZST05UUE9SQ0huKGN0cmxf
bm8sIGZyYW1lX2dlbik7CisJa21iX3dyaXRlX21pcGkoa21iLCByZWdfYWRyLAorCQkgICAgICAg
ZmdfY2ZnLT5oX2Zyb250cG9yY2ggKiAoZmdfY2ZnLT5icHAgLyA4KSk7Cit9CisKK3N0YXRpYyB2
b2lkIG1pcGlfdHhfZmdfY2ZnKHN0cnVjdCBrbWJfZHJtX3ByaXZhdGUgKmttYiwgdTggZnJhbWVf
Z2VuLAorCQkJICAgdTggYWN0aXZlX2xhbmVzLCB1MzIgYnBwLCB1MzIgd2MsCisJCQkgICB1MzIg
bGFuZV9yYXRlX21icHMsIHN0cnVjdCBtaXBpX3R4X2ZyYW1lX2NmZyAqZmdfY2ZnKQoreworCXUz
MiBpLCBmZ19udW1fbGluZXMgPSAwOworCXN0cnVjdCBtaXBpX3R4X2ZyYW1lX3RpbWluZ19jZmcg
ZmdfdF9jZmc7CisKKwkvKiBDYWxjdWxhdGUgdGhlIHRvdGFsIGZyYW1lIGdlbmVyYXRvciBudW1i
ZXIgb2YKKwkgKiBsaW5lcyBiYXNlZCBvbiBpdCdzIGFjdGl2ZSBzZWN0aW9ucworCSAqLworCWZv
ciAoaSA9IDA7IGkgPCBNSVBJX1RYX0ZSQU1FX0dFTl9TRUNUSU9OUzsgaSsrKSB7CisJCWlmIChm
Z19jZmctPnNlY3Rpb25zW2ldKQorCQkJZmdfbnVtX2xpbmVzICs9IGZnX2NmZy0+c2VjdGlvbnNb
aV0tPmhlaWdodF9saW5lczsKKwl9CisKKwlmZ190X2NmZy5icHAgPSBicHA7CisJZmdfdF9jZmcu
bGFuZV9yYXRlX21icHMgPSBsYW5lX3JhdGVfbWJwczsKKwlmZ190X2NmZy5oc3luY193aWR0aCA9
IGZnX2NmZy0+aHN5bmNfd2lkdGg7CisJZmdfdF9jZmcuaF9iYWNrcG9yY2ggPSBmZ19jZmctPmhf
YmFja3BvcmNoOworCWZnX3RfY2ZnLmhfZnJvbnRwb3JjaCA9IGZnX2NmZy0+aF9mcm9udHBvcmNo
OworCWZnX3RfY2ZnLmhfYWN0aXZlID0gd2M7CisJZmdfdF9jZmcudnN5bmNfd2lkdGggPSBmZ19j
ZmctPnZzeW5jX3dpZHRoOworCWZnX3RfY2ZnLnZfYmFja3BvcmNoID0gZmdfY2ZnLT52X2JhY2tw
b3JjaDsKKwlmZ190X2NmZy52X2Zyb250cG9yY2ggPSBmZ19jZmctPnZfZnJvbnRwb3JjaDsKKwlm
Z190X2NmZy52X2FjdGl2ZSA9IGZnX251bV9saW5lczsKKwlmZ190X2NmZy5hY3RpdmVfbGFuZXMg
PSBhY3RpdmVfbGFuZXM7CisKKwkvKiBBcHBseSBmcmFtZSBnZW5lcmF0b3IgdGltaW5nIHNldHRp
bmcgKi8KKwltaXBpX3R4X2ZnX2NmZ19yZWdzKGttYiwgZnJhbWVfZ2VuLCAmZmdfdF9jZmcpOwor
fQorCitzdGF0aWMgdm9pZCBtaXBpX3R4X211bHRpY2hhbm5lbF9maWZvX2NmZyhzdHJ1Y3Qga21i
X2RybV9wcml2YXRlICprbWIsCisJCQkJCSAgdTggYWN0aXZlX2xhbmVzLCB1OCB2Y2hhbm5lbF9p
ZCkKK3sKKwl1MzIgZmlmb19zaXplLCBmaWZvX3J0aHJlc2hvbGQ7CisJdTMyIGN0cmxfbm8gPSBN
SVBJX0NUUkw2OworCisJLyogQ2xlYXIgYWxsIG1jIGZpZm8gY2hhbm5lbCBzaXplcyBhbmQgdGhy
ZXNob2xkcyAqLworCWttYl93cml0ZV9taXBpKGttYiwgTUlQSV9UWF9IU19NQ19GSUZPX0NUUkxf
RU4sIDApOworCWttYl93cml0ZV9taXBpKGttYiwgTUlQSV9UWF9IU19NQ19GSUZPX0NIQU5fQUxM
T0MwLCAwKTsKKwlrbWJfd3JpdGVfbWlwaShrbWIsIE1JUElfVFhfSFNfTUNfRklGT19DSEFOX0FM
TE9DMSwgMCk7CisJa21iX3dyaXRlX21pcGkoa21iLCBNSVBJX1RYX0hTX01DX0ZJRk9fUlRIUkVT
SE9MRDAsIDApOworCWttYl93cml0ZV9taXBpKGttYiwgTUlQSV9UWF9IU19NQ19GSUZPX1JUSFJF
U0hPTEQxLCAwKTsKKworCWZpZm9fc2l6ZSA9ICgoYWN0aXZlX2xhbmVzID4gTUlQSV9EX0xBTkVT
X1BFUl9EUEhZKSA/CisJCSAgICAgTUlQSV9DVFJMXzRMQU5FX01BWF9NQ19GSUZPX0xPQyA6CisJ
CSAgICAgTUlQSV9DVFJMXzJMQU5FX01BWF9NQ19GSUZPX0xPQykgLSAxOworCisJLyogTUMgZmlm
byBzaXplIGZvciB2aXJ0dWFsIGNoYW5uZWxzIDAtMworCSAqIFJFR19NQ19GSUZPX0NIQU5fQUxM
T0MwOiBbODowXS1jaGFubmVsMCwgWzI0OjE2XS1jaGFubmVsMQorCSAqIFJFR19NQ19GSUZPX0NI
QU5fQUxMT0MxOiBbODowXS0yLCBbMjQ6MTZdLWNoYW5uZWwzCisJICovCisJU0VUX01DX0ZJRk9f
Q0hBTl9BTExPQyhrbWIsIGN0cmxfbm8sIHZjaGFubmVsX2lkLCBmaWZvX3NpemUpOworCisJLyog
U2V0IHRocmVzaG9sZCB0byBoYWxmIHRoZSBmaWZvIHNpemUsIGFjdHVhbCBzaXplPXNpemUqMTYg
Ki8KKwlmaWZvX3J0aHJlc2hvbGQgPSAoKGZpZm9fc2l6ZSkgKiA4KSAmIEJJVF9NQVNLXzE2Owor
CVNFVF9NQ19GSUZPX1JUSFJFU0hPTEQoa21iLCBjdHJsX25vLCB2Y2hhbm5lbF9pZCwgZmlmb19y
dGhyZXNob2xkKTsKKworCS8qIEVuYWJsZSB0aGUgTUMgRklGTyBjaGFubmVsIGNvcnJlc3BvbmRp
bmcgdG8gdGhlIFZpcnR1YWwgQ2hhbm5lbCAqLworCWttYl9zZXRfYml0X21pcGkoa21iLCBNSVBJ
X1RYbV9IU19NQ19GSUZPX0NUUkxfRU4oY3RybF9ubyksCisJCQkgdmNoYW5uZWxfaWQpOworfQor
CitzdGF0aWMgdm9pZCBtaXBpX3R4X2N0cmxfY2ZnKHN0cnVjdCBrbWJfZHJtX3ByaXZhdGUgKmtt
YiwgdTggZmdfaWQsCisJCQkgICAgIHN0cnVjdCBtaXBpX2N0cmxfY2ZnICpjdHJsX2NmZykKK3sK
Kwl1MzIgc3luY19jZmcgPSAwLCBjdHJsID0gMCwgZmdfZW47CisJdTMyIGN0cmxfbm8gPSBNSVBJ
X0NUUkw2OworCisJLyogTUlQSV9UWF9IU19TWU5DX0NGRyAqLworCWlmIChjdHJsX2NmZy0+dHhf
Y3RybF9jZmcubGluZV9zeW5jX3BrdF9lbikKKwkJc3luY19jZmcgfD0gTElORV9TWU5DX1BLVF9F
TkFCTEU7CisJaWYgKGN0cmxfY2ZnLT50eF9jdHJsX2NmZy5mcmFtZV9jb3VudGVyX2FjdGl2ZSkK
KwkJc3luY19jZmcgfD0gRlJBTUVfQ09VTlRFUl9BQ1RJVkU7CisJaWYgKGN0cmxfY2ZnLT50eF9j
dHJsX2NmZy5saW5lX2NvdW50ZXJfYWN0aXZlKQorCQlzeW5jX2NmZyB8PSBMSU5FX0NPVU5URVJf
QUNUSVZFOworCWlmIChjdHJsX2NmZy0+dHhfY3RybF9jZmcudHhfZHNpX2NmZy0+dl9ibGFua2lu
ZykKKwkJc3luY19jZmcgfD0gRFNJX1ZfQkxBTktJTkc7CisJaWYgKGN0cmxfY2ZnLT50eF9jdHJs
X2NmZy50eF9kc2lfY2ZnLT5oc2FfYmxhbmtpbmcpCisJCXN5bmNfY2ZnIHw9IERTSV9IU0FfQkxB
TktJTkc7CisJaWYgKGN0cmxfY2ZnLT50eF9jdHJsX2NmZy50eF9kc2lfY2ZnLT5oYnBfYmxhbmtp
bmcpCisJCXN5bmNfY2ZnIHw9IERTSV9IQlBfQkxBTktJTkc7CisJaWYgKGN0cmxfY2ZnLT50eF9j
dHJsX2NmZy50eF9kc2lfY2ZnLT5oZnBfYmxhbmtpbmcpCisJCXN5bmNfY2ZnIHw9IERTSV9IRlBf
QkxBTktJTkc7CisJaWYgKGN0cmxfY2ZnLT50eF9jdHJsX2NmZy50eF9kc2lfY2ZnLT5zeW5jX3B1
bHNlX2V2ZW50bikKKwkJc3luY19jZmcgfD0gRFNJX1NZTkNfUFVMU0VfRVZFTlROOworCWlmIChj
dHJsX2NmZy0+dHhfY3RybF9jZmcudHhfZHNpX2NmZy0+bHBtX2ZpcnN0X3ZzYV9saW5lKQorCQlz
eW5jX2NmZyB8PSBEU0lfTFBNX0ZJUlNUX1ZTQV9MSU5FOworCWlmIChjdHJsX2NmZy0+dHhfY3Ry
bF9jZmcudHhfZHNpX2NmZy0+bHBtX2xhc3RfdmZwX2xpbmUpCisJCXN5bmNfY2ZnIHw9IERTSV9M
UE1fTEFTVF9WRlBfTElORTsKKworCS8qIEVuYWJsZSBmcmFtZSBnZW5lcmF0b3IgKi8KKwlmZ19l
biA9IDEgPDwgZmdfaWQ7CisJc3luY19jZmcgfD0gRlJBTUVfR0VOX0VOKGZnX2VuKTsKKworCWlm
IChjdHJsX2NmZy0+dHhfY3RybF9jZmcudHhfYWx3YXlzX3VzZV9oYWN0KQorCQlzeW5jX2NmZyB8
PSBBTFdBWVNfVVNFX0hBQ1QoZmdfZW4pOworCWlmIChjdHJsX2NmZy0+dHhfY3RybF9jZmcudHhf
aGFjdF93YWl0X3N0b3ApCisJCXN5bmNfY2ZnIHw9IEhBQ1RfV0FJVF9TVE9QKGZnX2VuKTsKKwor
CWRybV9kYmcoJmttYi0+ZHJtLCAic3luY19jZmc9JWQgZmdfZW49JWRcbiIsIHN5bmNfY2ZnLCBm
Z19lbik7CisKKwkvKiBNSVBJX1RYX0hTX0NUUkwgKi8KKworCS8qIHR5cGU6RFNJLCBzb3VyY2U6
TENEICovCisJY3RybCA9IEhTX0NUUkxfRU4gfCBUWF9TT1VSQ0U7CisJY3RybCB8PSBMQ0RfVkMo
ZmdfaWQpOworCWN0cmwgfD0gQUNUSVZFX0xBTkVTKGN0cmxfY2ZnLT5hY3RpdmVfbGFuZXMgLSAx
KTsKKwlpZiAoY3RybF9jZmctPnR4X2N0cmxfY2ZnLnR4X2RzaV9jZmctPmVvdHBfZW4pCisJCWN0
cmwgfD0gRFNJX0VPVFBfRU47CisJaWYgKGN0cmxfY2ZnLT50eF9jdHJsX2NmZy50eF9kc2lfY2Zn
LT5oZnBfYmxhbmtfZW4pCisJCWN0cmwgfD0gRFNJX0NNRF9IRlBfRU47CisKKwkvKjY3IG5zIHN0
b3AgdGltZSAqLworCWN0cmwgfD0gSFNFWElUX0NOVCgweDQzKTsKKworCWttYl93cml0ZV9taXBp
KGttYiwgTUlQSV9UWG1fSFNfU1lOQ19DRkcoY3RybF9ubyksIHN5bmNfY2ZnKTsKKwlrbWJfd3Jp
dGVfbWlwaShrbWIsIE1JUElfVFhtX0hTX0NUUkwoY3RybF9ubyksIGN0cmwpOworfQorCisjaWZk
ZWYgTUlQSV9UWF9URVNUX1BBVFRFUk5fR0VORVJBVElPTgorc3RhdGljIHZvaWQgbWlwaV90eF9o
c190cF9nZW4oc3RydWN0IGttYl9kcm1fcHJpdmF0ZSAqa21iLCBpbnQgdmMsCisJCQkgICAgICBp
bnQgdHBfc2VsLCB1MzIgc3RyaXBlX3dpZHRoLCB1MzIgY29sb3IwLAorCQkJICAgICAgdTMyIGNv
bG9yMSwgdTMyIGN0cmxfbm8pCit7CisJaW50IHZhbCA9IDA7CisKKwkvKiBTZWxlY3QgdGVzdCBw
YXR0ZXJuIG1vZGUgb24gdGhlIHZpcnR1YWwgY2hhbm5lbCAqLworCXZhbCA9IFRQX1NFTF9WQ20o
dmMsIHRwX3NlbCk7CisKKwkvKiBDb25maWd1cmUgdGVzdCBwYXR0ZXJuIGNvbG9ycyAqLworCWtt
Yl93cml0ZV9taXBpKGttYiwgTUlQSV9UWG1fSFNfVEVTVF9QQVRfQ09MT1IwKGN0cmxfbm8pLCBj
b2xvcjApOworCWttYl93cml0ZV9taXBpKGttYiwgTUlQSV9UWG1fSFNfVEVTVF9QQVRfQ09MT1Ix
KGN0cmxfbm8pLCBjb2xvcjEpOworCisJLyogRW5hYmxlIHRlc3QgcGF0dGVybiBnZW5lcmF0aW9u
IG9uIHRoZSB2aXJ0dWFsIGNoYW5uZWwgKi8KKwl2YWwgfD0gVFBfRU5fVkNtKHZjKTsKKwlrbWJf
d3JpdGVfbWlwaShrbWIsIE1JUElfVFhtX0hTX1RFU1RfUEFUX0NUUkwoY3RybF9ubyksIHZhbCk7
Cit9CisjZW5kaWYKKworc3RhdGljIHUzMiBtaXBpX3R4X2luaXRfY250cmwoc3RydWN0IGttYl9k
cm1fcHJpdmF0ZSAqa21iLAorCQkJICAgICAgc3RydWN0IG1pcGlfY3RybF9jZmcgKmN0cmxfY2Zn
KQoreworCXUzMiByZXQgPSAwOworCXU4IGFjdGl2ZV92Y2hhbm5lbHMgPSAwOworCXU4IGZyYW1l
X2lkLCBzZWN0OworCXUzMiBiaXRzX3Blcl9wY2xrID0gMDsKKwl1MzIgd29yZF9jb3VudCA9IDA7
CisJc3RydWN0IG1pcGlfdHhfZnJhbWVfY2ZnICpmcmFtZTsKKworCS8qIFRoaXMgaXMgdGhlIG9y
ZGVyIHRvIGluaXRpYWxpemUgTUlQSSBUWDoKKwkgKiAxLiBzZXQgZnJhbWUgc2VjdGlvbiBwYXJh
bWV0ZXJzCisJICogMi4gc2V0IGZyYW1lIHNwZWNpZmljIHBhcmFtZXRlcnMKKwkgKiAzLiBjb25u
ZWN0IGxjZCB0byBtaXBpCisJICogNC4gbXVsdGkgY2hhbm5lbCBmaWZvIGNmZworCSAqIDUuIHNl
dCBtaXBpdHhjY3RybGNmZworCSAqLworCisJZm9yIChmcmFtZV9pZCA9IDA7IGZyYW1lX2lkIDwg
NDsgZnJhbWVfaWQrKykgeworCQlmcmFtZSA9IGN0cmxfY2ZnLT50eF9jdHJsX2NmZy5mcmFtZXNb
ZnJhbWVfaWRdOworCisJCS8qIEZpbmQgdmFsaWQgZnJhbWUsIGFzc3VtZSBvbmx5IG9uZSB2YWxp
ZCBmcmFtZSAqLworCQlpZiAoIWZyYW1lKQorCQkJY29udGludWU7CisKKwkJLyogRnJhbWUgU2Vj
dGlvbiBjb25maWd1cmF0aW9uICovCisJCS8qIFRPRE8gLSBhc3N1bWUgdGhlcmUgaXMgb25seSBv
bmUgdmFsaWQgc2VjdGlvbiBpbiBhIGZyYW1lLAorCQkgKiBzbyBiaXRzX3Blcl9wY2xrIGFuZCB3
b3JkX2NvdW50IGFyZSBvbmx5IHNldCBvbmNlCisJCSAqLworCQlmb3IgKHNlY3QgPSAwOyBzZWN0
IDwgTUlQSV9DVFJMX1ZJUlRVQUxfQ0hBTk5FTFM7IHNlY3QrKykgeworCQkJaWYgKCFmcmFtZS0+
c2VjdGlvbnNbc2VjdF0pCisJCQkJY29udGludWU7CisKKwkJCXJldCA9IG1pcGlfdHhfZmdfc2Vj
dGlvbl9jZmcoa21iLCBmcmFtZV9pZCwgc2VjdCwKKwkJCQkJCSAgICAgZnJhbWUtPnNlY3Rpb25z
W3NlY3RdLAorCQkJCQkJICAgICAmYml0c19wZXJfcGNsaywKKwkJCQkJCSAgICAgJndvcmRfY291
bnQpOworCQkJaWYgKHJldCkKKwkJCQlyZXR1cm4gcmV0OworCQl9CisKKwkJLyogU2V0IGZyYW1l
IHNwZWNpZmljIHBhcmFtZXRlcnMgKi8KKwkJbWlwaV90eF9mZ19jZmcoa21iLCBmcmFtZV9pZCwg
Y3RybF9jZmctPmFjdGl2ZV9sYW5lcywKKwkJCSAgICAgICBiaXRzX3Blcl9wY2xrLCB3b3JkX2Nv
dW50LAorCQkJICAgICAgIGN0cmxfY2ZnLT5sYW5lX3JhdGVfbWJwcywgZnJhbWUpOworCisJCWFj
dGl2ZV92Y2hhbm5lbHMrKzsKKworCQkvKiBTdG9wIGl0ZXJhdGluZyBhcyBvbmx5IG9uZSB2aXJ0
dWFsIGNoYW5uZWwKKwkJICogc2hhbGwgYmUgdXNlZCBmb3IgTENEIGNvbm5lY3Rpb24KKwkJICov
CisJCWJyZWFrOworCX0KKworCWlmIChhY3RpdmVfdmNoYW5uZWxzID09IDApCisJCXJldHVybiAt
RUlOVkFMOworCS8qIE11bHRpLUNoYW5uZWwgRklGTyBDb25maWd1cmF0aW9uICovCisJbWlwaV90
eF9tdWx0aWNoYW5uZWxfZmlmb19jZmcoa21iLCBjdHJsX2NmZy0+YWN0aXZlX2xhbmVzLCBmcmFt
ZV9pZCk7CisKKwkvKiBGcmFtZSBHZW5lcmF0b3IgRW5hYmxlICovCisJbWlwaV90eF9jdHJsX2Nm
ZyhrbWIsIGZyYW1lX2lkLCBjdHJsX2NmZyk7CisKKyNpZmRlZiBNSVBJX1RYX1RFU1RfUEFUVEVS
Tl9HRU5FUkFUSU9OCisJbWlwaV90eF9oc190cF9nZW4oa21iLCAwLCBNSVBJX1RYX0hTX1RQX1Zf
U1RSSVBFUywKKwkJCSAgMHg4LCAweGZmLCAweGZmMDAsIE1JUElfQ1RSTDYpOworI2VuZGlmCisK
Kwlkcm1fZGJnKCZrbWItPmRybSwgIklSUV9TVEFUVVMgPSAweCV4XG4iLAorCQlHRVRfTUlQSV9U
WF9IU19JUlFfU1RBVFVTKGttYiwgTUlQSV9DVFJMNikpOworCisJcmV0dXJuIHJldDsKK30KKwor
I2lmZGVmIERQSFlfUkVBRF9URVNUQ09ERQoraW50IGRwaHlfcmVhZF90ZXN0Y29kZShzdHJ1Y3Qg
a21iX2RybV9wcml2YXRlICprbWIsIGludCBkcGh5X3NlbCwKKwkJICAgICAgIGludCB0ZXN0X2Nv
ZGUpCit7CisJdTMyIHJlZ193cl9kYXRhOworCXUzMiByZWdfcmRfZGF0YTsKKwlpbnQgZGF0YTsK
KworCXJlZ193cl9kYXRhID0gZHBoeV9zZWw7CisJa21iX3dyaXRlX21pcGkoa21iLCBEUEhZX1RF
U1RfQ1RSTDEsIHJlZ193cl9kYXRhKTsKKworCWRhdGEgPSAwOworCXJlZ193cl9kYXRhID0gMDsK
KwlyZWdfcmRfZGF0YSA9IDA7CisKKwlpZiAoKChkcGh5X3NlbCA+PiAwICYgMHgxKSA9PSAxKSB8
ICgoZHBoeV9zZWwgPj4gNCAmIDB4MSkgPT0gMSkgfAorCSAgICAoKGRwaHlfc2VsID4+IDggJiAw
eDEpID09IDEpKQorCQlyZWdfd3JfZGF0YSB8PSBkYXRhIDw8IDA7CisJaWYgKCgoZHBoeV9zZWwg
Pj4gMSAmIDB4MSkgPT0gMSkgfCAoKGRwaHlfc2VsID4+IDUgJiAweDEpID09IDEpIHwKKwkgICAg
KChkcGh5X3NlbCA+PiA5ICYgMHgxKSA9PSAxKSkKKwkJcmVnX3dyX2RhdGEgfD0gZGF0YSA8PCA4
OworCWlmICgoKGRwaHlfc2VsID4+IDIgJiAweDEpID09IDEpIHwgKChkcGh5X3NlbCA+PiA2ICYg
MHgxKSA9PSAxKSB8CisJICAgICgoZHBoeV9zZWwgPj4gMTAgJiAweDEpID09IDEpKQorCQlyZWdf
d3JfZGF0YSB8PSBkYXRhIDw8IDE2OworCWlmICgoKGRwaHlfc2VsID4+IDMgJiAweDEpID09IDEp
IHwgKChkcGh5X3NlbCA+PiA3ICYgMHgxKSA9PSAxKSB8CisJICAgICgoZHBoeV9zZWwgPj4gMTEg
JiAweDEpID09IDEpKQorCQlyZWdfd3JfZGF0YSB8PSBkYXRhIDw8IDI0OworCisJaWYgKChkcGh5
X3NlbCA+PiAwICYgMHhmKSA+IDApCisJCWttYl93cml0ZV9taXBpKGttYiwgRFBIWV9URVNUX0RJ
TjBfMywgcmVnX3dyX2RhdGEpOworCWlmICgoZHBoeV9zZWwgPj4gNCAmIDB4ZikgPiAwKQorCQlr
bWJfd3JpdGVfbWlwaShrbWIsIERQSFlfVEVTVF9ESU40XzcsIHJlZ193cl9kYXRhKTsKKwlpZiAo
KGRwaHlfc2VsID4+IDggJiAweDMpID4gMCkKKwkJa21iX3dyaXRlX21pcGkoa21iLCBEUEhZX1RF
U1RfRElOOF85LCByZWdfd3JfZGF0YSk7CisKKwlyZWdfd3JfZGF0YSA9IDA7CisJcmVnX3dyX2Rh
dGEgPSAoZHBoeV9zZWwgfCBkcGh5X3NlbCA8PCAxMik7CisJa21iX3dyaXRlX21pcGkoa21iLCBE
UEhZX1RFU1RfQ1RSTDEsIHJlZ193cl9kYXRhKTsKKworCXJlZ193cl9kYXRhID0gMDsKKwlyZWdf
d3JfZGF0YSA9IGRwaHlfc2VsIDw8IDEyOworCWttYl93cml0ZV9taXBpKGttYiwgRFBIWV9URVNU
X0NUUkwxLCByZWdfd3JfZGF0YSk7CisKKwlyZWdfd3JfZGF0YSA9IDA7CisJa21iX3dyaXRlX21p
cGkoa21iLCBEUEhZX1RFU1RfQ1RSTDEsIHJlZ193cl9kYXRhKTsKKworCWRhdGEgPSB0ZXN0X2Nv
ZGUgPj4gOCAmIDB4ZjsKKwlyZWdfd3JfZGF0YSA9IDA7CisKKwlpZiAoKChkcGh5X3NlbCA+PiAw
ICYgMHgxKSA9PSAxKSB8ICgoZHBoeV9zZWwgPj4gNCAmIDB4MSkgPT0gMSkgfAorCSAgICAoKGRw
aHlfc2VsID4+IDggJiAweDEpID09IDEpKQorCQlyZWdfd3JfZGF0YSB8PSBkYXRhIDw8IDA7CisJ
aWYgKCgoZHBoeV9zZWwgPj4gMSAmIDB4MSkgPT0gMSkgfCAoKGRwaHlfc2VsID4+IDUgJiAweDEp
ID09IDEpIHwKKwkgICAgKChkcGh5X3NlbCA+PiA5ICYgMHgxKSA9PSAxKSkKKwkJcmVnX3dyX2Rh
dGEgfD0gZGF0YSA8PCA4OworCWlmICgoKGRwaHlfc2VsID4+IDIgJiAweDEpID09IDEpIHwgKChk
cGh5X3NlbCA+PiA2ICYgMHgxKSA9PSAxKSB8CisJICAgICgoZHBoeV9zZWwgPj4gMTAgJiAweDEp
ID09IDEpKQorCQlyZWdfd3JfZGF0YSB8PSBkYXRhIDw8IDE2OworCWlmICgoKGRwaHlfc2VsID4+
IDMgJiAweDEpID09IDEpIHwgKChkcGh5X3NlbCA+PiA3ICYgMHgxKSA9PSAxKSB8CisJICAgICgo
ZHBoeV9zZWwgPj4gMTEgJiAweDEpID09IDEpKQorCQlyZWdfd3JfZGF0YSB8PSBkYXRhIDw8IDI0
OworCisJaWYgKChkcGh5X3NlbCA+PiAwICYgMHhmKSA+IDApCisJCWttYl93cml0ZV9taXBpKGtt
YiwgRFBIWV9URVNUX0RJTjBfMywgcmVnX3dyX2RhdGEpOworCWlmICgoZHBoeV9zZWwgPj4gNCAm
IDB4ZikgPiAwKQorCQlrbWJfd3JpdGVfbWlwaShrbWIsIERQSFlfVEVTVF9ESU40XzcsIHJlZ193
cl9kYXRhKTsKKwlpZiAoKGRwaHlfc2VsID4+IDggJiAweDMpID4gMCkKKwkJa21iX3dyaXRlX21p
cGkoa21iLCBEUEhZX1RFU1RfRElOOF85LCByZWdfd3JfZGF0YSk7CisKKwlyZWdfd3JfZGF0YSA9
IDA7CisJcmVnX3dyX2RhdGEgPSBkcGh5X3NlbDsKKwlrbWJfd3JpdGVfbWlwaShrbWIsIERQSFlf
VEVTVF9DVFJMMSwgcmVnX3dyX2RhdGEpOworCisJZGF0YSA9IHRlc3RfY29kZSAmIDB4ZmY7CisJ
cmVnX3dyX2RhdGEgPSAwOworCisJaWYgKCgoZHBoeV9zZWwgPj4gMCAmIDB4MSkgPT0gMSkgfCAo
KGRwaHlfc2VsID4+IDQgJiAweDEpID09IDEpIHwKKwkgICAgKChkcGh5X3NlbCA+PiA4ICYgMHgx
KSA9PSAxKSkKKwkJcmVnX3dyX2RhdGEgfD0gZGF0YSA8PCAwOworCWlmICgoKGRwaHlfc2VsID4+
IDEgJiAweDEpID09IDEpIHwgKChkcGh5X3NlbCA+PiA1ICYgMHgxKSA9PSAxKSB8CisJICAgICgo
ZHBoeV9zZWwgPj4gOSAmIDB4MSkgPT0gMSkpCisJCXJlZ193cl9kYXRhIHw9IGRhdGEgPDwgODsK
KwlpZiAoKChkcGh5X3NlbCA+PiAyICYgMHgxKSA9PSAxKSB8ICgoZHBoeV9zZWwgPj4gNiAmIDB4
MSkgPT0gMSkgfAorCSAgICAoKGRwaHlfc2VsID4+IDEwICYgMHgxKSA9PSAxKSkKKwkJcmVnX3dy
X2RhdGEgfD0gZGF0YSA8PCAxNjsKKwlpZiAoKChkcGh5X3NlbCA+PiAzICYgMHgxKSA9PSAxKSB8
ICgoZHBoeV9zZWwgPj4gNyAmIDB4MSkgPT0gMSkgfAorCSAgICAoKGRwaHlfc2VsID4+IDExICYg
MHgxKSA9PSAxKSkKKwkJcmVnX3dyX2RhdGEgfD0gZGF0YSA8PCAyNDsKKworCWlmICgoZHBoeV9z
ZWwgPj4gMCAmIDB4ZikgPiAwKQorCQlrbWJfd3JpdGVfbWlwaShrbWIsIERQSFlfVEVTVF9ESU4w
XzMsIHJlZ193cl9kYXRhKTsKKwlpZiAoKGRwaHlfc2VsID4+IDQgJiAweGYpID4gMCkKKwkJa21i
X3dyaXRlX21pcGkoa21iLCBEUEhZX1RFU1RfRElONF83LCByZWdfd3JfZGF0YSk7CisJaWYgKChk
cGh5X3NlbCA+PiA4ICYgMHgzKSA+IDApCisJCWttYl93cml0ZV9taXBpKGttYiwgRFBIWV9URVNU
X0RJTjhfOSwgcmVnX3dyX2RhdGEpOworCisJcmVnX3dyX2RhdGEgPSAwOworCXJlZ193cl9kYXRh
ID0gKGRwaHlfc2VsIHwgZHBoeV9zZWwgPDwgMTIpOworCWttYl93cml0ZV9taXBpKGttYiwgRFBI
WV9URVNUX0NUUkwxLCByZWdfd3JfZGF0YSk7CisKKwlyZWdfd3JfZGF0YSA9IDA7CisJcmVnX3dy
X2RhdGEgPSBkcGh5X3NlbCA8PCAxMjsKKwlrbWJfd3JpdGVfbWlwaShrbWIsIERQSFlfVEVTVF9D
VFJMMSwgcmVnX3dyX2RhdGEpOworCisJcmVnX3dyX2RhdGEgPSAwOworCWttYl93cml0ZV9taXBp
KGttYiwgRFBIWV9URVNUX0NUUkwxLCByZWdfd3JfZGF0YSk7CisKKwlpZiAoKGRwaHlfc2VsID4+
IDAgJiAweGYpID4gMCkKKwkJcmVnX3JkX2RhdGEgPSBrbWJfcmVhZF9taXBpKGttYiwgRFBIWV9U
RVNUX0RPVUJUMF8zKTsKKwlpZiAoKGRwaHlfc2VsID4+IDQgJiAweGYpID4gMCkKKwkJcmVnX3Jk
X2RhdGEgPSBrbWJfcmVhZF9taXBpKGttYiwgRFBIWV9URVNUX0RPVUJUNF83KTsKKwlpZiAoKGRw
aHlfc2VsID4+IDggJiAweDMpID4gMCkKKwkJcmVnX3JkX2RhdGEgPSBrbWJfcmVhZF9taXBpKGtt
YiwgRFBIWV9URVNUX0RPVUJUOF85KTsKKworCWlmICgoKGRwaHlfc2VsID4+IDAgJiAweDEpID09
IDEpIHwgKChkcGh5X3NlbCA+PiA0ICYgMHgxKSA9PSAxKSB8CisJICAgICgoZHBoeV9zZWwgPj4g
OCAmIDB4MSkgPT0gMSkpCisJCWRhdGEgPSByZWdfcmRfZGF0YSA+PiAwOworCWlmICgoKGRwaHlf
c2VsID4+IDEgJiAweDEpID09IDEpIHwgKChkcGh5X3NlbCA+PiA1ICYgMHgxKSA9PSAxKSB8CisJ
ICAgICgoZHBoeV9zZWwgPj4gOSAmIDB4MSkgPT0gMSkpCisJCWRhdGEgPSByZWdfcmRfZGF0YSA+
PiA4OworCWlmICgoKGRwaHlfc2VsID4+IDIgJiAweDEpID09IDEpIHwgKChkcGh5X3NlbCA+PiA2
ICYgMHgxKSA9PSAxKSB8CisJICAgICgoZHBoeV9zZWwgPj4gMTAgJiAweDEpID09IDEpKQorCQlk
YXRhID0gcmVnX3JkX2RhdGEgPj4gMTY7CisJaWYgKCgoZHBoeV9zZWwgPj4gMyAmIDB4MSkgPT0g
MSkgfCAoKGRwaHlfc2VsID4+IDcgJiAweDEpID09IDEpIHwKKwkgICAgKChkcGh5X3NlbCA+PiAx
MSAmIDB4MSkgPT0gMSkpCisJCWRhdGEgPSByZWdfcmRfZGF0YSA+PiAyNDsKKworCXJldHVybiBk
YXRhOworfQorI2VuZGlmCisKK3N0YXRpYyB2b2lkIHRlc3RfbW9kZV9zZW5kKHN0cnVjdCBrbWJf
ZHJtX3ByaXZhdGUgKmttYiwgdTMyIGRwaHlfbm8sCisJCQkgICB1MzIgdGVzdF9jb2RlLCB1MzIg
dGVzdF9kYXRhKQoreworCWlmICh0ZXN0X2NvZGUgIT0gVEVTVF9DT0RFX0ZTTV9DT05UUk9MKQor
CQlkcm1fZGJnKCZrbWItPmRybSwKKwkJCSJ0ZXN0X2NvZGUgPSAlMDJ4LCB0ZXN0X2RhdGEgPSAl
MDh4XG4iLCB0ZXN0X2NvZGUsCisJCQkgdGVzdF9kYXRhKTsKKwkvKiBTdGVwcyB0byBzZW5kIHRl
c3QgY29kZToKKwkgKiAtIHNldCB0ZXN0Y2xrIEhJR0gKKwkgKiAtIHNldCB0ZXN0ZGluIHdpdGgg
dGVzdCBjb2RlCisJICogLSBzZXQgdGVzdGVuIEhJR0gKKwkgKiAtIHNldCB0ZXN0Y2xrIExPVwor
CSAqIC0gc2V0IHRlc3RlbiBMT1cKKwkgKi8KKworCS8qIFNldCB0ZXN0Y2xrIGhpZ2ggKi8KKwlT
RVRfRFBIWV9URVNUX0NUUkwxX0NMSyhrbWIsIGRwaHlfbm8pOworCisJLyogU2V0IHRlc3RkaW4g
Ki8KKwlTRVRfVEVTVF9ESU4wXzMoa21iLCBkcGh5X25vLCB0ZXN0X2NvZGUpOworCisJLyogU2V0
IHRlc3RlbiBoaWdoICovCisJU0VUX0RQSFlfVEVTVF9DVFJMMV9FTihrbWIsIGRwaHlfbm8pOwor
CisJLyogU2V0IHRlc3RjbGsgbG93ICovCisJQ0xSX0RQSFlfVEVTVF9DVFJMMV9DTEsoa21iLCBk
cGh5X25vKTsKKworCS8qIFNldCB0ZXN0ZW4gbG93ICovCisJQ0xSX0RQSFlfVEVTVF9DVFJMMV9F
TihrbWIsIGRwaHlfbm8pOworCisJaWYgKHRlc3RfY29kZSkgeworCQkvKiAgU3RlcHMgdG8gc2Vu
ZCB0ZXN0IGRhdGE6CisJCSAqIC0gc2V0IHRlc3RlbiBMT1cKKwkJICogLSBzZXQgdGVzdGNsayBM
T1cKKwkJICogLSBzZXQgdGVzdGRpbiB3aXRoIGRhdGEKKwkJICogLSBzZXQgdGVzdGNsayBISUdI
CisJCSAqLworCisJCS8qIFNldCB0ZXN0ZW4gbG93ICovCisJCUNMUl9EUEhZX1RFU1RfQ1RSTDFf
RU4oa21iLCBkcGh5X25vKTsKKworCQkvKiBTZXQgdGVzdGNsayBsb3cgKi8KKwkJQ0xSX0RQSFlf
VEVTVF9DVFJMMV9DTEsoa21iLCBkcGh5X25vKTsKKworCQkvKiBTZXQgZGF0YSBpbiB0ZXN0ZGlu
ICovCisJCWttYl93cml0ZV9taXBpKGttYiwKKwkJCSAgICAgICBEUEhZX1RFU1RfRElOMF8zICsg
KChkcGh5X25vIC8gMHg0KSAqIDB4NCksCisJCQkgICAgICAgdGVzdF9kYXRhIDw8ICgoZHBoeV9u
byAlIDQpICogOCkpOworCisJCS8qIFNldCB0ZXN0Y2xrIGhpZ2ggKi8KKwkJU0VUX0RQSFlfVEVT
VF9DVFJMMV9DTEsoa21iLCBkcGh5X25vKTsKKwl9Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZAor
CXNldF90ZXN0X21vZGVfc3JjX29zY19mcmVxX3RhcmdldF9sb3dfYml0cyhzdHJ1Y3Qga21iX2Ry
bV9wcml2YXRlICprbWIsCisJCQkJCQkgICB1MzIgZHBoeV9ubywKKwkJCQkJCSAgIHUzMiBmcmVx
KQoreworCS8qIFR5cGljYWwgcmlzZS9mYWxsIHRpbWU9MTY2LCByZWZlciBUYWJsZSAxMjA3IGRh
dGFib29rLAorCSAqIHNyX29zY19mcmVxX3RhcmdldFs3OjBdCisJICovCisJdGVzdF9tb2RlX3Nl
bmQoa21iLCBkcGh5X25vLCBURVNUX0NPREVfU0xFV19SQVRFX0RETF9DWUNMRVMsCisJCSAgICAg
ICAoZnJlcSAmIDB4N2YpKTsKK30KKworc3RhdGljIGlubGluZSB2b2lkCisJc2V0X3Rlc3RfbW9k
ZV9zcmNfb3NjX2ZyZXFfdGFyZ2V0X2hpX2JpdHMoc3RydWN0IGttYl9kcm1fcHJpdmF0ZSAqa21i
LAorCQkJCQkJICB1MzIgZHBoeV9ubywKKwkJCQkJCSAgdTMyIGZyZXEpCit7CisJdTMyIGRhdGE7
CisKKwkvKiBGbGFnIHRoaXMgYXMgaGlnaCBuaWJibGUgKi8KKwlkYXRhID0gKChmcmVxID4+IDYp
ICYgMHgxZikgfCAoMSA8PCA3KTsKKworCS8qIFR5cGljYWwgcmlzZS9mYWxsIHRpbWU9MTY2LCBy
ZWZlciBUYWJsZSAxMjA3IGRhdGFib29rLAorCSAqIHNyX29zY19mcmVxX3RhcmdldFsxMTo3XQor
CSAqLworCXRlc3RfbW9kZV9zZW5kKGttYiwgZHBoeV9ubywgVEVTVF9DT0RFX1NMRVdfUkFURV9E
RExfQ1lDTEVTLCBkYXRhKTsKK30KKworc3RhdGljIHZvaWQgbWlwaV90eF9nZXRfdmNvX3BhcmFt
cyhzdHJ1Y3QgdmNvX3BhcmFtcyAqdmNvKQoreworCWludCBpOworCisJZm9yIChpID0gMDsgaSA8
IEFSUkFZX1NJWkUodmNvX3RhYmxlKTsgaSsrKSB7CisJCWlmICh2Y28tPmZyZXEgPCB2Y29fdGFi
bGVbaV0uZnJlcSkgeworCQkJKnZjbyA9IHZjb190YWJsZVtpXTsKKwkJCXJldHVybjsKKwkJfQor
CX0KKworCVdBUk5fT05DRSgxLCAiSW52YWxpZCB2Y28gZnJlcSA9ICV1IGZvciBQTEwgc2V0dXBc
biIsIHZjby0+ZnJlcSk7Cit9CisKK3N0YXRpYyB2b2lkIG1pcGlfdHhfcGxsX3NldHVwKHN0cnVj
dCBrbWJfZHJtX3ByaXZhdGUgKmttYiwgdTMyIGRwaHlfbm8sCisJCQkgICAgICB1MzIgcmVmX2Ns
a19taHosIHUzMiB0YXJnZXRfZnJlcV9taHopCit7CisJdTMyIGJlc3RfbiA9IDAsIGJlc3RfbSA9
IDA7CisJdTMyIG4gPSAwLCBtID0gMCwgZGl2ID0gMCwgZGVsdGEsIGZyZXEgPSAwLCB0X2ZyZXE7
CisJdTMyIGJlc3RfZnJlcV9kZWx0YSA9IDMwMDA7CisKKwkvKiBwbGxfcmVmX2NsazogLSB2YWxp
ZCByYW5nZTogMn42NCBNSHo7IFR5cGljYWxseSAyNCBNSHoKKwkgKiBGdmNvOiAtIHZhbGlkIHJh
bmdlOiAzMjB+MTI1MCBNSHogKEdlbjMgRC1QSFkpCisJICogRm91dDogLSB2YWxpZCByYW5nZTog
NDB+MTI1MCBNSHogKEdlbjMgRC1QSFkpCisJICogbjogLSB2YWxpZCByYW5nZSBbMCAxNV0KKwkg
KiBOOiAtIE4gPSBuICsgMQorCSAqICAgICAgLXZhbGlkIHJhbmdlOiBbMSAxNl0KKwkgKiAgICAg
IC1jb25kaXRpb25zOiAtIChwbGxfcmVmX2NsayAvIE4pID49IDIgTUh6CisJICogICAgICAgICAg
ICAgIC0ocGxsX3JlZl9jbGsgLyBOKSA8PSA4IE1IegorCSAqIG06IHZhbGlkIHJhbmdlIFs2MiA2
MjNdCisJICogTTogLSBNID0gbSArIDIKKwkgKiAgICAgIC12YWxpZCByYW5nZSBbNjQgNjI1XQor
CSAqICAgICAgLUZ2Y28gPSAoTS9OKSAqIHBsbF9yZWZfY2xrCisJICovCisJc3RydWN0IHZjb19w
YXJhbXMgdmNvX3AgPSB7CisJCS5yYW5nZSA9IDAsCisJCS5kaXZpZGVyID0gMSwKKwl9OworCisJ
dmNvX3AuZnJlcSA9IHRhcmdldF9mcmVxX21oejsKKwltaXBpX3R4X2dldF92Y29fcGFyYW1zKCZ2
Y29fcCk7CisKKwkvKiBTZWFyY2ggcGxsIG4gcGFyYW1ldGVyICovCisJZm9yIChuID0gUExMX05f
TUlOOyBuIDw9IFBMTF9OX01BWDsgbisrKSB7CisJCS8qIENhbGN1bGF0ZSB0aGUgcGxsIGlucHV0
IGZyZXF1ZW5jeSBkaXZpc2lvbiByYXRpbworCQkgKiBtdWx0aXBseSBieSAxMDAwIGZvciBwcmVj
aXNpb24gLQorCQkgKiBubyBmbG9hdGluZyBwb2ludCwgYWRkIG4gZm9yIHJvdW5kaW5nCisJCSAq
LworCQlkaXYgPSAoKHJlZl9jbGtfbWh6ICogMTAwMCkgKyBuKSAvIChuICsgMSk7CisKKwkJLyog
Rm91bmQgYSB2YWxpZCBuIHBhcmFtZXRlciAqLworCQlpZiAoKGRpdiA8IDIwMDAgfHwgZGl2ID4g
ODAwMCkpCisJCQljb250aW51ZTsKKworCQkvKiBTZWFyY2ggcGxsIG0gcGFyYW1ldGVyICovCisJ
CWZvciAobSA9IFBMTF9NX01JTjsgbSA8PSBQTExfTV9NQVg7IG0rKykgeworCQkJLyogQ2FsY3Vs
YXRlIHRoZSBGdmNvKERQSFkgUExMIG91dHB1dCBmcmVxdWVuY3kpCisJCQkgKiB1c2luZyB0aGUg
Y3VycmVudCBuLG0gcGFyYW1zCisJCQkgKi8KKwkJCWZyZXEgPSBkaXYgKiAobSArIDIpOworCQkJ
ZnJlcSAvPSAxMDAwOworCisJCQkvKiBUcmltIHRoZSBwb3RlbnRpYWwgcGxsIGZyZXEgdG8gbWF4
IHN1cHBvcnRlZCAqLworCQkJaWYgKGZyZXEgPiBQTExfRlZDT19NQVgpCisJCQkJY29udGludWU7
CisKKwkJCWRlbHRhID0gYWJzKGZyZXEgLSB0YXJnZXRfZnJlcV9taHopOworCisJCQkvKiBTZWxl
Y3QgdGhlIGJlc3QgKGNsb3Nlc3QgdG8gdGFyZ2V0IHBsbCBmcmVxKQorCQkJICogbixtIHBhcmFt
ZXRlcnMgc28gZmFyCisJCQkgKi8KKwkJCWlmIChkZWx0YSA8IGJlc3RfZnJlcV9kZWx0YSkgewor
CQkJCWJlc3RfbiA9IG47CisJCQkJYmVzdF9tID0gbTsKKwkJCQliZXN0X2ZyZXFfZGVsdGEgPSBk
ZWx0YTsKKwkJCX0KKwkJfQorCX0KKworCS8qIFByb2dyYW0gdmNvX2NudHJsIHBhcmFtZXRlcgor
CSAqIFBMTF9WQ09fQ29udHJvbFs1OjBdID0gcGxsX3Zjb19jbnRybF9vdnIsCisJICogUExMX1ZD
T19Db250cm9sWzZdICAgPSBwbGxfdmNvX2NudHJsX292cl9lbgorCSAqLworCXRlc3RfbW9kZV9z
ZW5kKGttYiwgZHBoeV9ubywgVEVTVF9DT0RFX1BMTF9WQ09fQ1RSTCwgKHZjb19wLnJhbmdlCisJ
CQkJCQkJCXwgKDEgPDwgNikpKTsKKworCS8qIFByb2dyYW0gbSwgbiBwbGwgcGFyYW1ldGVycyAq
LworCWRybV9kYmcoJmttYi0+ZHJtLCAibSA9ICVkIG4gPSAlZFxuIiwgYmVzdF9tLCBiZXN0X24p
OworCisJLyogUExMX0lucHV0X0RpdmlkZXJfUmF0aW9bMzowXSA9IHBsbF9uX292ciAqLworCXRl
c3RfbW9kZV9zZW5kKGttYiwgZHBoeV9ubywgVEVTVF9DT0RFX1BMTF9JTlBVVF9ESVZJREVSLAor
CQkgICAgICAgKGJlc3RfbiAmIDB4MGYpKTsKKworCS8qIG0gLSBsb3cgbmliYmxlIFBMTF9Mb29w
X0RpdmlkZXJfUmF0aW9bNDowXQorCSAqIHBsbF9tX292cls0OjBdCisJICovCisJdGVzdF9tb2Rl
X3NlbmQoa21iLCBkcGh5X25vLCBURVNUX0NPREVfUExMX0ZFRURCQUNLX0RJVklERVIsCisJCSAg
ICAgICAoYmVzdF9tICYgMHgxZikpOworCisJLyogbSAtIGhpZ2ggbmliYmxlIFBMTF9Mb29wX0Rp
dmlkZXJfUmF0aW9bNDowXQorCSAqIHBsbF9tX292cls5OjVdCisJICovCisJdGVzdF9tb2RlX3Nl
bmQoa21iLCBkcGh5X25vLCBURVNUX0NPREVfUExMX0ZFRURCQUNLX0RJVklERVIsCisJCSAgICAg
ICAoKGJlc3RfbSA+PiA1KSAmIDB4MWYpIHwgUExMX0ZFRURCQUNLX0RJVklERVJfSElHSCk7CisK
KwkvKiBFbmFibGUgb3ZlcndyaXRlIG9mIG4sbSBwYXJhbWV0ZXJzIDpwbGxfbl9vdnJfZW4sIHBs
bF9tX292cl9lbiAqLworCXRlc3RfbW9kZV9zZW5kKGttYiwgZHBoeV9ubywgVEVTVF9DT0RFX1BM
TF9PVVRQVVRfQ0xLX1NFTCwKKwkJICAgICAgIChQTExfTl9PVlJfRU4gfCBQTExfTV9PVlJfRU4p
KTsKKworCS8qIFByb2dyYW0gQ2hhcmdlLVB1bXAgcGFyYW1ldGVycyAqLworCisJLyogcGxsX3By
b3BfY250cmwtZml4ZWQgdmFsdWVzIGZvciBwcm9wX2NudHJsIGZyb20gRFBIWSBkb2MgKi8KKwl0
X2ZyZXEgPSB0YXJnZXRfZnJlcV9taHogKiB2Y29fcC5kaXZpZGVyOworCXRlc3RfbW9kZV9zZW5k
KGttYiwgZHBoeV9ubywKKwkJICAgICAgIFRFU1RfQ09ERV9QTExfUFJPUE9SVElPTkFMX0NIQVJH
RV9QVU1QX0NUUkwsCisJCSAgICAgICAoKHRfZnJlcSA+IDExNTApID8gMHgwQyA6IDB4MEIpKTsK
KworCS8qIHBsbF9pbnRfY250cmwtZml4ZWQgdmFsdWUgZm9yIGludF9jbnRybCBmcm9tIERQSFkg
ZG9jICovCisJdGVzdF9tb2RlX3NlbmQoa21iLCBkcGh5X25vLCBURVNUX0NPREVfUExMX0lOVEVH
UkFMX0NIQVJHRV9QVU1QX0NUUkwsCisJCSAgICAgICAweDAwKTsKKworCS8qIHBsbF9nbXBfY250
cmwtZml4ZWQgdmFsdWUgZm9yIGdtcF9jbnRybCBmcm9tIERQSFkgZG9jaSAqLworCXRlc3RfbW9k
ZV9zZW5kKGttYiwgZHBoeV9ubywgVEVTVF9DT0RFX1BMTF9HTVBfQ1RSTCwgMHgxMCk7CisKKwkv
KiBwbGxfY3BiaWFzX2NudHJsLWZpeGVkIHZhbHVlIGZvciBjcGJpYXNfY250cmwgZnJvbSBEUEhZ
IGRvYyAqLworCXRlc3RfbW9kZV9zZW5kKGttYiwgZHBoeV9ubywgVEVTVF9DT0RFX1BMTF9DSEFS
R0VfUFVNUF9CSUFTLCAweDEwKTsKKworCS8qIHBsbF90aDEgLUxvY2sgRGV0ZWN0b3IgUGhhc2Ug
ZXJyb3IgdGhyZXNob2xkLAorCSAqIGRvY3VtZW50IGdpdmVzIGZpeGVkIHZhbHVlCisJICovCisJ
dGVzdF9tb2RlX3NlbmQoa21iLCBkcGh5X25vLCBURVNUX0NPREVfUExMX1BIQVNFX0VSUl9DVFJM
LCAweDAyKTsKKworCS8qIFBMTCBMb2NrIENvbmZpZ3VyYXRpb24gKi8KKworCS8qIHBsbF90aDIg
LSBMb2NrIEZpbHRlciBsZW5ndGgsIGRvY3VtZW50IGdpdmVzIGZpeGVkIHZhbHVlICovCisJdGVz
dF9tb2RlX3NlbmQoa21iLCBkcGh5X25vLCBURVNUX0NPREVfUExMX0xPQ0tfRklMVEVSLCAweDYw
KTsKKworCS8qIHBsbF90aDMtIFBMTCBVbmxvY2tpbmcgZmlsdGVyLCBkb2N1bWVudCBnaXZlcyBm
aXhlZCB2YWx1ZSAqLworCXRlc3RfbW9kZV9zZW5kKGttYiwgZHBoeV9ubywgVEVTVF9DT0RFX1BM
TF9VTkxPQ0tfRklMVEVSLCAweDAzKTsKKworCS8qIHBsbF9sb2NrX3NlbC1QTEwgTG9jayBEZXRl
Y3RvciBTZWxlY3Rpb24sCisJICogZG9jdW1lbnQgZ2l2ZXMgZml4ZWQgdmFsdWUKKwkgKi8KKwl0
ZXN0X21vZGVfc2VuZChrbWIsIGRwaHlfbm8sIFRFU1RfQ09ERV9QTExfTE9DS19ERVRFQ1RPUiwg
MHgwMik7Cit9CisKKyNpZmRlZiBEUEhZX0dFVF9GU00KK3N0YXRpYyB2b2lkIGRwaHlfZ2V0X2Zz
bShzdHJ1Y3Qga21iX2RybV9wcml2YXRlICprbWIsIHUzMiBkcGh5X25vKQoreworCXRlc3RfbW9k
ZV9zZW5kKGttYiwgZHBoeV9ubywgVEVTVF9DT0RFX0ZTTV9DT05UUk9MLCAweDgwKTsKKworCWRy
bV9kYmcoJmttYi0+ZHJtLCAiZHBoeSAlZCBmc21fc3RhdGUgPSAwJXhcbiIsIGRwaHlfbm8sCisJ
CWttYl9yZWFkX21pcGkoa21iLCBEUEhZX1RFU1RfRE9VQlQ0XzcpKTsKK30KKyNlbmRpZgorCitz
dGF0aWMgdm9pZCBkcGh5X2luaXRfc2VxdWVuY2Uoc3RydWN0IGttYl9kcm1fcHJpdmF0ZSAqa21i
LAorCQkJICAgICAgIHN0cnVjdCBtaXBpX2N0cmxfY2ZnICpjZmcsIHUzMiBkcGh5X25vLAorCQkJ
ICAgICAgIGludCBhY3RpdmVfbGFuZXMsIGVudW0gZHBoeV9tb2RlIG1vZGUpCit7CisJdTMyIHRl
c3RfY29kZSA9IDAsIHRlc3RfZGF0YSA9IDAsIHZhbDsKKwlpbnQgaSA9IDA7CisKKwlkcm1faW5m
bygma21iLT5kcm0sCisJCSAiZHBoeT0lZCBtb2RlPSVkIGFjdGl2ZV9sYW5lcz0lZFxuIiwgZHBo
eV9ubywgbW9kZSwKKwkJIGFjdGl2ZV9sYW5lcyk7CisJZHJtX2RiZygma21iLT5kcm0sICJNSVBJ
X0RQSFlfU1RBVDBfNF83ID0gMHgleClcbiIsCisJCWttYl9yZWFkX21pcGkoa21iLCBNSVBJX0RQ
SFlfU1RBVDRfNykpOworCisJLyogU2V0IEQtUEhZIGluIHNodXRkb3duIG1vZGUgKi8KKwkvKiBB
c3NlcnQgUlNUWiBzaWduYWwgKi8KKwlDTFJfRFBIWV9JTklUX0NUUkwwKGttYiwgZHBoeV9ubywg
UkVTRVRaKTsKKworCS8qIEFzc2VydCBTSFVURE9XTlogc2lnbmFsICovCisJQ0xSX0RQSFlfSU5J
VF9DVFJMMChrbWIsIGRwaHlfbm8sIFNIVVRET1dOWik7CisJdmFsID0ga21iX3JlYWRfbWlwaShr
bWIsIERQSFlfSU5JVF9DVFJMMCk7CisKKwlkcm1fZGJnKCZrbWItPmRybSwgIkRQSFlfSU5JVF9D
VFJMMCA9IDB4JXhcbiIsIHZhbCk7CisKKwkvKiBJbml0IEQtUEhZX24KKwkgKiBQdWxzZSB0ZXN0
Y2xlYXIgc2lnbmFsIHRvIG1ha2Ugc3VyZSB0aGUgZC1waHkgY29uZmlndXJhdGlvbgorCSAqIHN0
YXJ0cyBmcm9tIGEgY2xlYW4gYmFzZQorCSAqLworCUNMUl9EUEhZX1RFU1RfQ1RSTDAoa21iLCBk
cGh5X25vKTsKKwluZGVsYXkoMTUpOworCVNFVF9EUEhZX1RFU1RfQ1RSTDAoa21iLCBkcGh5X25v
KTsKKwluZGVsYXkoMTUpOworCUNMUl9EUEhZX1RFU1RfQ1RSTDAoa21iLCBkcGh5X25vKTsKKwlu
ZGVsYXkoMTUpOworCisJZHJtX2RiZygma21iLT5kcm0sICJEUEhZX1RFU1RfQ1RSTDA9MHgleFxu
IiwKKwkJa21iX3JlYWRfbWlwaShrbWIsIERQSFlfVEVTVF9DVFJMMCkpOworCisJLyogU2V0IG1h
c3Rlcm1hY3JvIGJpdCAtIE1hc3RlciBvciBzbGF2ZSBtb2RlICovCisJdGVzdF9jb2RlID0gVEVT
VF9DT0RFX01VTFRJUExFX1BIWV9DVFJMOworCisJLyogRFBIWSBoYXMgaXRzIG93biBjbG9jayBs
YW5lIGVuYWJsZWQgKG1hc3RlcikgKi8KKwlpZiAobW9kZSA9PSBNSVBJX0RQSFlfTUFTVEVSKQor
CQl0ZXN0X2RhdGEgPSAweDAxOworCWVsc2UKKwkJdGVzdF9kYXRhID0gMHgwMDsKKworCS8qIFNl
bmQgdGhlIHRlc3QgY29kZSBhbmQgZGF0YSAqLworCXRlc3RfbW9kZV9zZW5kKGttYiwgZHBoeV9u
bywgdGVzdF9jb2RlLCB0ZXN0X2RhdGEpOworCisJLyogU2V0IHRoZSBsYW5lIGRhdGEgcmF0ZSAq
LworCWZvciAoaSA9IDA7IGkgPCBNSVBJX0RQSFlfREVGQVVMVF9CSVRfUkFURVM7IGkrKykgewor
CQlpZiAobWlwaV9oc19mcmVxX3JhbmdlW2ldLmRlZmF1bHRfYml0X3JhdGVfbWJwcyA8CisJCSAg
ICBjZmctPmxhbmVfcmF0ZV9tYnBzKQorCQkJY29udGludWU7CisKKwkJLyogU2VuZCB0aGUgdGVz
dCBjb2RlIGFuZCBkYXRhICovCisJCS8qIGJpdFs2OjBdID0gaHNmcmVxcmFuZ2Vfb3ZyIGJpdFs3
XSA9IGhzZnJlcXJhbmdlX292cl9lbiAqLworCQl0ZXN0X2NvZGUgPSBURVNUX0NPREVfSFNfRlJF
UV9SQU5HRV9DRkc7CisJCXRlc3RfZGF0YSA9IChtaXBpX2hzX2ZyZXFfcmFuZ2VbaV0uaHNmcmVx
cmFuZ2VfY29kZSAmIDB4N2YpIHwKKwkJICAgICgxIDw8IDcpOworCQl0ZXN0X21vZGVfc2VuZChr
bWIsIGRwaHlfbm8sIHRlc3RfY29kZSwgdGVzdF9kYXRhKTsKKwkJYnJlYWs7CisJfQorCisJLyog
SGlnaC1TcGVlZCBUeCBTbGV3IFJhdGUgQ2FsaWJyYXRpb24KKwkgKiBCaXRSYXRlOiA+IDEuNSBH
YnBzICYmIDw9IDIuNSBHYnBzOiBzbGV3IHJhdGUgY29udHJvbCBPRkYKKwkgKi8KKwlpZiAoY2Zn
LT5sYW5lX3JhdGVfbWJwcyA+IDE1MDApIHsKKwkJLyogQnlwYXNzIHNsZXcgcmF0ZSBjYWxpYnJh
dGlvbiBhbGdvcml0aG0KKwkJICogYml0c1sxOjB9IHNyY2FsX2VuX292cl9lbiwgc3JjYWxfZW5f
b3ZyCisJCSAqLworCQl0ZXN0X2NvZGUgPSBURVNUX0NPREVfU0xFV19SQVRFX09WRVJSSURFX0NU
Ukw7CisJCXRlc3RfZGF0YSA9IDB4MDI7CisJCXRlc3RfbW9kZV9zZW5kKGttYiwgZHBoeV9ubywg
dGVzdF9jb2RlLCB0ZXN0X2RhdGEpOworCisJCS8qIERpc2FibGUgc2xldyByYXRlIGNhbGlicmF0
aW9uICovCisJCXRlc3RfY29kZSA9IFRFU1RfQ09ERV9TTEVXX1JBVEVfRERMX0xPT1BfQ1RSTDsK
KwkJdGVzdF9kYXRhID0gMHgwMDsKKwkJdGVzdF9tb2RlX3NlbmQoa21iLCBkcGh5X25vLCB0ZXN0
X2NvZGUsIHRlc3RfZGF0YSk7CisJfSBlbHNlIGlmIChjZmctPmxhbmVfcmF0ZV9tYnBzID4gMTAw
MCkgeworCQkvKiBCaXRSYXRlOiA+IDEgR2JwcyAmJiA8PSAxLjUgR2JwczogLSBzbGV3IHJhdGUg
Y29udHJvbCBPTgorCQkgKiB0eXBpY2FsIHJpc2UvZmFsbCB0aW1lczogMTY2IHBzCisJCSAqLwor
CisJCS8qIERvIG5vdCBieXBhc3Mgc2xldyByYXRlIGNhbGlicmF0aW9uIGFsZ29yaXRobQorCQkg
KiBiaXRzWzE6MH09c3JjYWxfZW5fb3ZyX2VuLCBzcmNhbF9lbl9vdnIsIGJpdFs2XT1zcl9yYW5n
ZQorCQkgKi8KKwkJdGVzdF9jb2RlID0gVEVTVF9DT0RFX1NMRVdfUkFURV9PVkVSUklERV9DVFJM
OworCQl0ZXN0X2RhdGEgPSAoMHgwMyB8ICgxIDw8IDYpKTsKKwkJdGVzdF9tb2RlX3NlbmQoa21i
LCBkcGh5X25vLCB0ZXN0X2NvZGUsIHRlc3RfZGF0YSk7CisKKwkJLyogRW5hYmxlIHNsZXcgcmF0
ZSBjYWxpYnJhdGlvbiAqLworCQl0ZXN0X2NvZGUgPSBURVNUX0NPREVfU0xFV19SQVRFX0RETF9M
T09QX0NUUkw7CisJCXRlc3RfZGF0YSA9IDB4MDE7CisJCXRlc3RfbW9kZV9zZW5kKGttYiwgZHBo
eV9ubywgdGVzdF9jb2RlLCB0ZXN0X2RhdGEpOworCisJCS8qIFNldCBzcl9vc2NfZnJlcV90YXJn
ZXRbNjowXSBsb3cgbmliYmxlCisJCSAqIHR5cGljYWwgcmlzZS9mYWxsIHRpbWU9MTY2LCByZWZl
ciBUYWJsZSAxMjA3IGRhdGFib29rCisJCSAqLworCQl0ZXN0X2NvZGUgPSBURVNUX0NPREVfU0xF
V19SQVRFX0RETF9DWUNMRVM7CisJCXRlc3RfZGF0YSA9ICgweDcyZiAmIDB4N2YpOworCQl0ZXN0
X21vZGVfc2VuZChrbWIsIGRwaHlfbm8sIHRlc3RfY29kZSwgdGVzdF9kYXRhKTsKKworCQkvKiBT
ZXQgc3Jfb3NjX2ZyZXFfdGFyZ2V0WzExOjddIGhpZ2ggbmliYmxlCisJCSAqIFR5cGljYWwgcmlz
ZS9mYWxsIHRpbWU9MTY2LCByZWZlciBUYWJsZSAxMjA3IGRhdGFib29rCisJCSAqLworCQl0ZXN0
X2NvZGUgPSBURVNUX0NPREVfU0xFV19SQVRFX0RETF9DWUNMRVM7CisJCXRlc3RfZGF0YSA9ICgo
MHg3MmYgPj4gNikgJiAweDFmKSB8ICgxIDw8IDcpOworCQl0ZXN0X21vZGVfc2VuZChrbWIsIGRw
aHlfbm8sIHRlc3RfY29kZSwgdGVzdF9kYXRhKTsKKwl9IGVsc2UgeworCQkvKiBsYW5lX3JhdGVf
bWJwcyA8PSAxMDAwIE1icHMKKwkJICogQml0UmF0ZTogIDw9IDEgR2JwczoKKwkJICogLSBzbGV3
IHJhdGUgY29udHJvbCBPTgorCQkgKiAtIHR5cGljYWwgcmlzZS9mYWxsIHRpbWVzOiAyMjUgcHMK
KwkJICovCisKKwkJLyogRG8gbm90IGJ5cGFzcyBzbGV3IHJhdGUgY2FsaWJyYXRpb24gYWxnb3Jp
dGhtICovCisJCXRlc3RfY29kZSA9IFRFU1RfQ09ERV9TTEVXX1JBVEVfT1ZFUlJJREVfQ1RSTDsK
KwkJdGVzdF9kYXRhID0gKDB4MDMgfCAoMSA8PCA2KSk7CisJCXRlc3RfbW9kZV9zZW5kKGttYiwg
ZHBoeV9ubywgdGVzdF9jb2RlLCB0ZXN0X2RhdGEpOworCisJCS8qIEVuYWJsZSBzbGV3IHJhdGUg
Y2FsaWJyYXRpb24gKi8KKwkJdGVzdF9jb2RlID0gVEVTVF9DT0RFX1NMRVdfUkFURV9ERExfTE9P
UF9DVFJMOworCQl0ZXN0X2RhdGEgPSAweDAxOworCQl0ZXN0X21vZGVfc2VuZChrbWIsIGRwaHlf
bm8sIHRlc3RfY29kZSwgdGVzdF9kYXRhKTsKKworCQkvKiBUeXBpY2FsIHJpc2UvZmFsbCB0aW1l
PTI1NSwgcmVmZXIgVGFibGUgMTIwNyBkYXRhYm9vayAqLworCQl0ZXN0X2NvZGUgPSBURVNUX0NP
REVfU0xFV19SQVRFX0RETF9DWUNMRVM7CisJCXRlc3RfZGF0YSA9ICgweDUyMyAmIDB4N2YpOwor
CQl0ZXN0X21vZGVfc2VuZChrbWIsIGRwaHlfbm8sIHRlc3RfY29kZSwgdGVzdF9kYXRhKTsKKwor
CQkvKiBTZXQgc3Jfb3NjX2ZyZXFfdGFyZ2V0WzExOjddIGhpZ2ggbmliYmxlICovCisJCXRlc3Rf
Y29kZSA9IFRFU1RfQ09ERV9TTEVXX1JBVEVfRERMX0NZQ0xFUzsKKwkJdGVzdF9kYXRhID0gKCgw
eDUyMyA+PiA2KSAmIDB4MWYpIHwgKDEgPDwgNyk7CisJCXRlc3RfbW9kZV9zZW5kKGttYiwgZHBo
eV9ubywgdGVzdF9jb2RlLCB0ZXN0X2RhdGEpOworCX0KKworCS8qIFNldCBjZmdjbGtmcmVxcmFu
Z2UgKi8KKwl2YWwgPSAoKChjZmctPmNmZ19jbGtfa2h6IC8gMTAwMCkgLSAxNykgKiA0KSAmIDB4
M2Y7CisJU0VUX0RQSFlfRlJFUV9DVFJMMF8zKGttYiwgZHBoeV9ubywgdmFsKTsKKworCWRybV9k
YmcoJmttYi0+ZHJtLCAiRFBIWV9GUkVRID0gMHgleFxuIiwKKwkJa21iX3JlYWRfbWlwaShrbWIs
IERQSFlfRlJFUV9DVFJMMF8zICsgNCkpOworCWRybV9kYmcoJmttYi0+ZHJtLCAiTUlQSV9EUEhZ
X1NUQVQwXzRfNyA9IDB4JXgpXG4iLAorCQlrbWJfcmVhZF9taXBpKGttYiwgTUlQSV9EUEhZX1NU
QVQ0XzcpKTsKKworCS8qIEVuYWJsZSBjb25maWcgY2xrIGZvciB0aGUgY29ycmVzcG9uZGluZyBk
LXBoeSAqLworCWttYl9zZXRfYml0X21pcGkoa21iLCBEUEhZX0NGR19DTEtfRU4sIGRwaHlfbm8p
OworCisJZHJtX2RiZygma21iLT5kcm0sICJEUEhZX0NGR19DTEtfRU4gPSAweCV4XG4iLAorCQlr
bWJfcmVhZF9taXBpKGttYiwgRFBIWV9DRkdfQ0xLX0VOKSk7CisKKwkvKiBQTEwgc2V0dXAgKi8K
KwlpZiAobW9kZSA9PSBNSVBJX0RQSFlfTUFTVEVSKSB7CisJCS8qIFNldCBQTEwgcmVndWxhdG9y
IGluIGJ5cGFzcyAqLworCQl0ZXN0X2NvZGUgPSBURVNUX0NPREVfUExMX0FOQUxPR19QUk9HOwor
CQl0ZXN0X2RhdGEgPSAweDAxOworCQl0ZXN0X21vZGVfc2VuZChrbWIsIGRwaHlfbm8sIHRlc3Rf
Y29kZSwgdGVzdF9kYXRhKTsKKworCQkvKiBQTEwgUGFyYW1ldGVycyBTZXR1cCAqLworCQltaXBp
X3R4X3BsbF9zZXR1cChrbWIsIGRwaHlfbm8sIGNmZy0+cmVmX2Nsa19raHogLyAxMDAwLAorCQkJ
CSAgY2ZnLT5sYW5lX3JhdGVfbWJwcyAvIDIpOworCisJCS8qIFNldCBjbGtzZWwgKi8KKwkJa21i
X3dyaXRlX2JpdHNfbWlwaShrbWIsIERQSFlfSU5JVF9DVFJMMSwKKwkJCQkgICAgUExMX0NMS1NF
TF8wLCAyLCAweDAxKTsKKworCQkvKiBTZXQgcGxsX3NoYWRvd19jb250cm9sICovCisJCWttYl9z
ZXRfYml0X21pcGkoa21iLCBEUEhZX0lOSVRfQ1RSTDEsIFBMTF9TSEFET1dfQ1RSTCk7CisKKwkJ
ZHJtX2RiZygma21iLT5kcm0sICJEUEhZX0lOSVRfQ1RSTDEgPSAweCV4XG4iLAorCQkJa21iX3Jl
YWRfbWlwaShrbWIsIERQSFlfSU5JVF9DVFJMMSkpOworCX0KKworCWRybV9kYmcoJmttYi0+ZHJt
LCAiTUlQSV9EUEhZX1NUQVQwXzRfNyA9IDB4JXgpXG4iLAorCQlrbWJfcmVhZF9taXBpKGttYiwg
TUlQSV9EUEhZX1NUQVQ0XzcpKTsKKworLy8jZGVmaW5lIE1JUElfVFhfRk9SQ0VfVk9ECisjaWZk
ZWYgTUlQSV9UWF9GT1JDRV9WT0QKKyNkZWZpbmUgTUlQSV9UWF9WT0RfTFZMCTQ1MAorI2RlZmlu
ZSBURVNUX0NPREVfQkFOREdBUCAweDI0CisJLyogU2V0IGJhbmRnYXAvVk9EIGxldmVsICovCisJ
c3dpdGNoIChNSVBJX1RYX1ZPRF9MVkwpIHsKKwljYXNlIDIwMDoKKwkJdGVzdF9kYXRhID0gMHgw
MDsKKwkJYnJlYWs7CisJY2FzZSAzMDA6CisJCXRlc3RfZGF0YSA9IDB4MjA7CisJCWJyZWFrOwor
CWNhc2UgMzUwOgorCQl0ZXN0X2RhdGEgPSAweDQwOworCQlicmVhazsKKwljYXNlIDQ1MDoKKwkJ
dGVzdF9kYXRhID0gMHg2MDsKKwkJYnJlYWs7CisJY2FzZSA0MDA6CisJZGVmYXVsdDoKKwkJdGVz
dF9kYXRhID0gMHg3MDsKKwkJYnJlYWs7CisJfQorCXRlc3RfbW9kZV9zZW5kKGttYiwgZHBoeV9u
bywgVEVTVF9DT0RFX0JBTkRHQVAsIHRlc3RfZGF0YSk7CisjZW5kaWYKKworCS8qIFNlbmQgTk9S
TUFMIE9QRVJBVElPTiB0ZXN0IGNvZGUgKi8KKwl0ZXN0X2NvZGUgPSAweDA7CisJdGVzdF9kYXRh
ID0gMHgwOworCXRlc3RfbW9kZV9zZW5kKGttYiwgZHBoeV9ubywgdGVzdF9jb2RlLCB0ZXN0X2Rh
dGEpOworCisJLyogQ29uZmlndXJlIEJBU0VESVIgZm9yIGRhdGEgbGFuZXMKKwkgKiBOT1RFOiBi
YXNlZGlyIG9ubHkgYXBwbGllcyB0byBMQU5FXzAgb2YgZWFjaCBELVBIWS4KKwkgKiBUaGUgb3Ro
ZXIgbGFuZXMga2VlcCB0aGVpciBkaXJlY3Rpb24gYmFzZWQgb24gdGhlIEQtUEhZIHR5cGUsCisJ
ICogZWl0aGVyIFJ4IG9yIFR4LgorCSAqIGJpdHNbNTowXSAgLSBCYXNlRGlyOiAxID0gUngKKwkg
KiBiaXRzWzk6Nl0gLSBCYXNlRGlyOiAwID0gVHgKKwkgKi8KKwlkcm1fZGJnKCZrbWItPmRybSwg
Ik1JUElfRFBIWV9TVEFUMF80XzcgPSAweCV4KVxuIiwKKwkJa21iX3JlYWRfbWlwaShrbWIsIE1J
UElfRFBIWV9TVEFUNF83KSk7CisKKwlrbWJfd3JpdGVfYml0c19taXBpKGttYiwgRFBIWV9JTklU
X0NUUkwyLCAwLCA5LCAweDAzZik7CisJbmRlbGF5KDE1KTsKKworCS8qIEVuYWJsZSBDTE9DSyBM
QU5FCisJICogQ2xvY2sgbGFuZSBzaG91bGQgYmUgZW5hYmxlZCByZWdhcmRsZXNzIG9mIHRoZSBk
aXJlY3Rpb24KKwkgKiBzZXQgZm9yIHRoZSBELVBIWSAoUngvVHgpCisJICovCisJa21iX3NldF9i
aXRfbWlwaShrbWIsIERQSFlfSU5JVF9DVFJMMiwgMTIgKyBkcGh5X25vKTsKKworCWRybV9kYmco
JmttYi0+ZHJtLCAiRFBIWV9JTklUX0NUUkwyID0gMHgleFxuIiwKKwkJa21iX3JlYWRfbWlwaShr
bWIsIERQSFlfSU5JVF9DVFJMMikpOworCisJLyogRW5hYmxlIERBVEEgTEFORVMgKi8KKwlrbWJf
d3JpdGVfYml0c19taXBpKGttYiwgRFBIWV9FTkFCTEUsIGRwaHlfbm8gKiAyLCAyLAorCQkJICAg
ICgoMSA8PCBhY3RpdmVfbGFuZXMpIC0gMSkpOworCisJZHJtX2RiZygma21iLT5kcm0sCisJCSJE
UEhZX0VOQUJMRSA9IDB4JXhcbiIsIGttYl9yZWFkX21pcGkoa21iLCBEUEhZX0VOQUJMRSkpOwor
CW5kZWxheSgxNSk7CisKKwkvKiBUYWtlIEQtUEhZIG91dCBvZiBzaHV0ZG93biBtb2RlICovCisJ
LyogRGVhc3NlcnQgU0hVVERPV05aIHNpZ25hbCAqLworCWRybV9kYmcoJmttYi0+ZHJtLCAiTUlQ
SV9EUEhZX1NUQVQwXzRfNyA9IDB4JXgpXG4iLAorCQlrbWJfcmVhZF9taXBpKGttYiwgTUlQSV9E
UEhZX1NUQVQ0XzcpKTsKKwlTRVRfRFBIWV9JTklUX0NUUkwwKGttYiwgZHBoeV9ubywgU0hVVERP
V05aKTsKKwluZGVsYXkoMTUpOworCisJLyogRGVhc3NlcnQgUlNUWiBzaWduYWwgKi8KKwlTRVRf
RFBIWV9JTklUX0NUUkwwKGttYiwgZHBoeV9ubywgUkVTRVRaKTsKKwlkcm1fZGJnKCZrbWItPmRy
bSwgIkRQSFlfSU5JVF9DVFJMMCA9IDB4JXhcbiIsCisJCWttYl9yZWFkX21pcGkoa21iLCBEUEhZ
X0lOSVRfQ1RSTDApKTsKK30KKworc3RhdGljIHZvaWQgZHBoeV93YWl0X2ZzbShzdHJ1Y3Qga21i
X2RybV9wcml2YXRlICprbWIsIHUzMiBkcGh5X25vLAorCQkJICBlbnVtIGRwaHlfdHhfZnNtIGZz
bV9zdGF0ZSkKK3sKKwllbnVtIGRwaHlfdHhfZnNtIHZhbCA9IERQSFlfVFhfUE9XRVJEV047CisJ
aW50IGkgPSAwOworCWludCBzdGF0dXMgPSAxOworCisJZG8geworCQl0ZXN0X21vZGVfc2VuZChr
bWIsIGRwaHlfbm8sIFRFU1RfQ09ERV9GU01fQ09OVFJPTCwgMHg4MCk7CisKKwkJdmFsID0gR0VU
X1RFU1RfRE9VVDRfNyhrbWIsIGRwaHlfbm8pOworCQlpKys7CisJCWlmIChpID4gVElNRU9VVCkg
eworCQkJc3RhdHVzID0gMDsKKwkJCWJyZWFrOworCQl9CisJfSB3aGlsZSAodmFsICE9IGZzbV9z
dGF0ZSk7CisKKwlkcm1fZGJnKCZrbWItPmRybSwgIiVzOiBkcGh5ICVkIHZhbCA9ICV4XG4iLCBf
X2Z1bmNfXywgZHBoeV9ubywgdmFsKTsKKwlkcm1faW5mbygma21iLT5kcm0sICIqKioqKioqKioq
IERQSFkgJWQgV0FJVF9GU00gJXMgKioqKioqKioqKlxuIiwKKwkJIGRwaHlfbm8sIHN0YXR1cyA/
ICJTVUNDRVNTIiA6ICJGQUlMRUQiKTsKK30KKworc3RhdGljIHZvaWQgd2FpdF9pbml0X2RvbmUo
c3RydWN0IGttYl9kcm1fcHJpdmF0ZSAqa21iLCB1MzIgZHBoeV9ubywKKwkJCSAgIHUzMiBhY3Rp
dmVfbGFuZXMpCit7CisJdTMyIHN0b3BzdGF0ZWRhdGEgPSAwOworCXUzMiBkYXRhX2xhbmVzID0g
KDEgPDwgYWN0aXZlX2xhbmVzKSAtIDE7CisJaW50IGkgPSAwLCB2YWw7CisJaW50IHN0YXR1cyA9
IDE7CisKKwlkcm1fZGJnKCZrbWItPmRybSwgImRwaHk9JWQgYWN0aXZlX2xhbmVzPSVkIGRhdGFf
bGFuZXM9JWRcbiIsIGRwaHlfbm8sCisJCWFjdGl2ZV9sYW5lcywgZGF0YV9sYW5lcyk7CisKKwlk
byB7CisJCXZhbCA9IGttYl9yZWFkX21pcGkoa21iLCBNSVBJX0RQSFlfU1RBVDRfNyk7CisJCXN0
b3BzdGF0ZWRhdGEgPSBHRVRfU1RPUFNUQVRFX0RBVEEoa21iLCBkcGh5X25vKSAmIGRhdGFfbGFu
ZXM7CisKKwkJLyogVE9ETy1uZWVkIHRvIGFkZCBhIHRpbWUgb3V0IGFuZCByZXR1cm4gZmFpbHVy
ZSAqLworCQlpKys7CisKKwkJaWYgKGkgPiBUSU1FT1VUKSB7CisJCQlzdGF0dXMgPSAwOworCisJ
CQlkcm1faW5mbygma21iLT5kcm0sCisJCQkJICIhIFdBSVRfSU5JVF9ET05FOiBUSU1JTkcgT1VU
IShlcnJfc3RhdD0lZCkiLAorCQkJCSBrbWJfcmVhZF9taXBpKGttYiwgTUlQSV9EUEhZX0VSUl9T
VEFUNl83KSk7CisJCQlkcm1fZGJnKCZrbWItPmRybSwKKwkJCQkiTUlQSV9EUEhZX1NUQVQwXzRf
NyA9IDB4JXgpXG4iLCB2YWwpOworCQkJZHJtX2RiZygma21iLT5kcm0sCisJCQkJInN0b3BkYXRh
ID0gMHgleCBkYXRhX2xhbmVzPTB4JXhcbiIsCisJCQkJIHN0b3BzdGF0ZWRhdGEsIGRhdGFfbGFu
ZXMpOworCisJCQlicmVhazsKKwkJfQorCisJCWlmIChpIDwgMykgeworCQkJZHJtX2RiZygma21i
LT5kcm0sCisJCQkJInN0b3BkYXRhID0gMHgleCBkYXRhX2xhbmVzPTB4JXhcbiIsCisJCQkJIHN0
b3BzdGF0ZWRhdGEsIGRhdGFfbGFuZXMpOworCQkJZHJtX2RiZygma21iLT5kcm0sCisJCQkJIk1J
UElfRFBIWV9TVEFUMF80XzcgPSAweCV4KVxuIiwgdmFsKTsKKwkJfQorCX0gd2hpbGUgKHN0b3Bz
dGF0ZWRhdGEgIT0gZGF0YV9sYW5lcyk7CisKKwlkcm1faW5mbygma21iLT5kcm0sICIqKioqKioq
KioqIERQSFkgJWQgSU5JVCAtICVzICoqKioqKioqKipcbiIsCisJCSBkcGh5X25vLCBzdGF0dXMg
PyAiU1VDQ0VTUyIgOiAiRkFJTEVEIik7Cit9CisKK3N0YXRpYyB2b2lkIHdhaXRfcGxsX2xvY2so
c3RydWN0IGttYl9kcm1fcHJpdmF0ZSAqa21iLCB1MzIgZHBoeV9ubykKK3sKKwlpbnQgaSA9IDA7
CisJaW50IHN0YXR1cyA9IDE7CisKKwlkbyB7CisJCS8qIFRPRE8tbmVlZCB0byBhZGQgYSB0aW1l
IG91dCBhbmQgcmV0dXJuIGZhaWx1cmUgKi8KKwkJaSsrOworCQlpZiAoaSA+IFRJTUVPVVQpIHsK
KwkJCXN0YXR1cyA9IDA7CisKKwkJCWRybV9pbmZvKCZrbWItPmRybSwgIiVzOiB0aW1pbmcgb3V0
IiwgX19mdW5jX18pOworCQkJZHJtX2RiZygma21iLT5kcm0sCisJCQkJIiVzIDogUExMX0xPQ0sg
PSAweCV4ICIsIF9fZnVuY19fLAorCQkJCWttYl9yZWFkX21pcGkoa21iLCBEUEhZX1BMTF9MT0NL
KSk7CisKKwkJCWJyZWFrOworCQl9CisKKwkJaWYgKChpICUgMTAwKSA9PSAwKQorCQkJZHJtX2Ri
Zygma21iLT5kcm0sCisJCQkJIiVzIDogUExMX0xPQ0sgPSAweCV4XG4iLCBfX2Z1bmNfXywKKwkJ
CQlrbWJfcmVhZF9taXBpKGttYiwgRFBIWV9QTExfTE9DSykpOworCX0gd2hpbGUgKCFHRVRfUExM
X0xPQ0soa21iLCBkcGh5X25vKSk7CisKKwlkcm1faW5mbygma21iLT5kcm0sICIqKioqKiBQTEwg
TG9ja2VkIGZvciBEUEhZICVkIC0gJXMgKioqKipcbiIsCisJCSBkcGh5X25vLCBzdGF0dXMgPyAi
U1VDQ0VTUyIgOiAiRkFJTEVEIik7Cit9CisKK3N0YXRpYyB1MzIgbWlwaV90eF9pbml0X2RwaHko
c3RydWN0IGttYl9kcm1fcHJpdmF0ZSAqa21iLAorCQkJICAgICBzdHJ1Y3QgbWlwaV9jdHJsX2Nm
ZyAqY2ZnKQoreworCXUzMiBkcGh5X25vID0gTUlQSV9EUEhZNjsKKworCWRybV9pbmZvKCZrbWIt
PmRybSwKKwkJICJhY3RpdmVfbGFuZXM9JWQgbGFuZV9yYXRlPSVkXG4iLCBjZmctPmFjdGl2ZV9s
YW5lcywKKwkJTUlQSV9UWF9MQU5FX0RBVEFfUkFURV9NQlBTKTsKKworCS8qIE11bHRpcGxlIEQt
UEhZcyBuZWVkZWQgKi8KKwlpZiAoY2ZnLT5hY3RpdmVfbGFuZXMgPiBNSVBJX0RQSFlfRF9MQU5F
UykgeworCQkvKgorCQkgKkluaXRpYWxpemF0aW9uIGZvciBUeCBhZ2dyZWdhdGlvbiBtb2RlIGlz
IGRvbmUgYWNjb3JkaW5nIHRvCisJCSAqYS4gc3RhcnQgaW5pdCBQSFkxCisJCSAqYi4gcG9sbCBm
b3IgUEhZMSBGU00gc3RhdGUgTE9DSworCQkgKiAgIGIxLiByZWcgYWRkciAweDAzWzM6MF0gLSBz
dGF0ZV9tYWluWzM6MF0gPT0gNSAoTE9DSykKKwkJICpjLiBwb2xsIGZvciBQSFkxIGNhbGlicmF0
aW9ucyBkb25lIDoKKwkJICogICBjMS4gdGVybWluYXRpb24gY2FsaWJyYXRpb24gbG93ZXIgc2Vj
dGlvbjogYWRkciAweDIyWzVdCisJCSAqICAgLSByZXNjYWxfZG9uZQorCQkgKiAgIGMyLiBzbGV3
cmF0ZSBjYWxpYnJhdGlvbiAoaWYgZGF0YSByYXRlIDwgPSAxNTAwIE1icHMpOgorCQkgKiAgICAg
YWRkciAweEE3WzM6Ml0gLSBzcmNhbF9kb25lLCBzcl9maW5pc2hlZAorCQkgKmQuIHN0YXJ0IGlu
aXQgUEhZMAorCQkgKmUuIHBvbGwgZm9yIFBIWTAgc3RvcHN0YXRlCisJCSAqZi4gcG9sbCBmb3Ig
UEhZMSBzdG9wc3RhdGUKKwkJICovCisJCS8qIFBIWSAjTisxICgnc2xhdmUnKSAqLworCisJCWRw
aHlfaW5pdF9zZXF1ZW5jZShrbWIsIGNmZywgZHBoeV9ubyArIDEsCisJCQkJICAgKGNmZy0+YWN0
aXZlX2xhbmVzIC0gTUlQSV9EUEhZX0RfTEFORVMpLAorCQkJCSAgIE1JUElfRFBIWV9TTEFWRSk7
CisJCWRwaHlfd2FpdF9mc20oa21iLCBkcGh5X25vICsgMSwgRFBIWV9UWF9MT0NLKTsKKworCQkv
KiBQSFkgI04gbWFzdGVyICovCisJCWRwaHlfaW5pdF9zZXF1ZW5jZShrbWIsIGNmZywgZHBoeV9u
bywgTUlQSV9EUEhZX0RfTEFORVMsCisJCQkJICAgTUlQSV9EUEhZX01BU1RFUik7CisKKwkJLyog
V2FpdCBmb3IgRFBIWSBpbml0IHRvIGNvbXBsZXRlICovCisJCXdhaXRfaW5pdF9kb25lKGttYiwg
ZHBoeV9ubywgTUlQSV9EUEhZX0RfTEFORVMpOworCQl3YWl0X2luaXRfZG9uZShrbWIsIGRwaHlf
bm8gKyAxLAorCQkJICAgICAgIGNmZy0+YWN0aXZlX2xhbmVzIC0gTUlQSV9EUEhZX0RfTEFORVMp
OworCQl3YWl0X3BsbF9sb2NrKGttYiwgZHBoeV9ubyk7CisJCXdhaXRfcGxsX2xvY2soa21iLCBk
cGh5X25vICsgMSk7CisJCWRwaHlfd2FpdF9mc20oa21iLCBkcGh5X25vLCBEUEhZX1RYX0lETEUp
OworCX0gZWxzZSB7CQkvKiBTaW5nbGUgRFBIWSAqLworCQlkcGh5X2luaXRfc2VxdWVuY2Uoa21i
LCBjZmcsIGRwaHlfbm8sIGNmZy0+YWN0aXZlX2xhbmVzLAorCQkJCSAgIE1JUElfRFBIWV9NQVNU
RVIpOworCQlkcGh5X3dhaXRfZnNtKGttYiwgZHBoeV9ubywgRFBIWV9UWF9JRExFKTsKKwkJd2Fp
dF9pbml0X2RvbmUoa21iLCBkcGh5X25vLCBjZmctPmFjdGl2ZV9sYW5lcyk7CisJCXdhaXRfcGxs
X2xvY2soa21iLCBkcGh5X25vKTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKwordm9pZCBjb25uZWN0
X2xjZF90b19taXBpKHN0cnVjdCBrbWJfZHJtX3ByaXZhdGUgKmttYikKK3sKKwkvKiBESVNBQkxF
IE1JUEktPkNJRiBDT05ORUNUSU9OICovCisJa21iX3dyaXRlX21zc2NhbShrbWIsIE1TU19NSVBJ
X0NJRl9DRkcsIDApOworCisJLyogRU5BQkxFIExDRC0+TUlQSSBDT05ORUNUSU9OICovCisJa21i
X3dyaXRlX21zc2NhbShrbWIsIE1TU19MQ0RfTUlQSV9DRkcsIDEpOworCisJLyogRElTQUJMRSBM
Q0QtPkNJRiBMT09QQkFDSyAqLworCWttYl93cml0ZV9tc3NjYW0oa21iLCBNU1NfTE9PUEJBQ0tf
Q0ZHLCAwKTsKK30KKworaW50IGttYl9kc2lfaHdfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
LCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkKK3sKKwlzdHJ1Y3Qga21iX2RybV9wcml2
YXRlICprbWIgPSB0b19rbWIoZGV2KTsKKwl1NjQgZGF0YV9yYXRlOworCisJbWlwaV90eF9pbml0
X2NmZy5hY3RpdmVfbGFuZXMgPSBNSVBJX1RYX0FDVElWRV9MQU5FUzsKKworCWlmIChtb2RlKSB7
CisJCW1pcGlfdHhfZnJhbWUwX3NlY3RfY2ZnLndpZHRoX3BpeGVscyA9IG1vZGUtPmNydGNfaGRp
c3BsYXk7CisJCW1pcGlfdHhfZnJhbWUwX3NlY3RfY2ZnLmhlaWdodF9saW5lcyA9IG1vZGUtPmNy
dGNfdmRpc3BsYXk7CisJCW1pcGl0eF9mcmFtZTBfY2ZnLnZzeW5jX3dpZHRoID0KKwkJICAgIG1v
ZGUtPmNydGNfdnN5bmNfZW5kIC0gbW9kZS0+Y3J0Y192c3luY19zdGFydDsKKwkJbWlwaXR4X2Zy
YW1lMF9jZmcudl9iYWNrcG9yY2ggPQorCQkgICAgbW9kZS0+Y3J0Y192dG90YWwgLSBtb2RlLT5j
cnRjX3ZzeW5jX2VuZDsKKwkJbWlwaXR4X2ZyYW1lMF9jZmcudl9mcm9udHBvcmNoID0KKwkJICAg
IG1vZGUtPmNydGNfdnN5bmNfc3RhcnQgLSBtb2RlLT5jcnRjX3ZkaXNwbGF5OworCQltaXBpdHhf
ZnJhbWUwX2NmZy5oc3luY193aWR0aCA9CisJCSAgICBtb2RlLT5jcnRjX2hzeW5jX2VuZCAtIG1v
ZGUtPmNydGNfaHN5bmNfc3RhcnQ7CisJCW1pcGl0eF9mcmFtZTBfY2ZnLmhfYmFja3BvcmNoID0K
KwkJICAgIG1vZGUtPmNydGNfaHRvdGFsIC0gbW9kZS0+Y3J0Y19oc3luY19lbmQ7CisJCW1pcGl0
eF9mcmFtZTBfY2ZnLmhfZnJvbnRwb3JjaCA9CisJCSAgICBtb2RlLT5jcnRjX2hzeW5jX3N0YXJ0
IC0gbW9kZS0+Y3J0Y19oZGlzcGxheTsKKworCQkvKiBMYW5lIHJhdGUgPSAodnRvdGFsKmh0b3Rh
bCpmcHMqYnBwKS80IC8gMTAwMDAwMAorCQkgKiB0byBjb252ZXJ0IHRvIE1icHMKKwkJICovCisJ
CWRhdGFfcmF0ZSA9ICgoKCh1MzIpbW9kZS0+Y3J0Y192dG90YWwgKgorCQkJCSh1MzIpbW9kZS0+
Y3J0Y19odG90YWwpICoKKwkJCQkodTMyKShkcm1fbW9kZV92cmVmcmVzaChtb2RlKSkgKgorCQkJ
ICAgICAgTUlQSV9UWF9CUFApIC8gbWlwaV90eF9pbml0X2NmZy5hY3RpdmVfbGFuZXMpIC8KKwkJ
ICAgIDEwMDAwMDA7CisKKwkJZHJtX2luZm8oJmttYi0+ZHJtLCAiaHRvdGFsPSVkIHZ0b3RhbD0l
ZCByZWZyZXNoPSVkXG4iLAorCQkJIG1vZGUtPmNydGNfaHRvdGFsLCBtb2RlLT5jcnRjX3Z0b3Rh
bCwKKwkJCSBkcm1fbW9kZV92cmVmcmVzaChtb2RlKSk7CisJCWRybV9pbmZvKCZrbWItPmRybSwg
ImRhdGFfcmF0ZT0ldSBhY3RpdmVfbGFuZXM9JWRcbiIsCisJCQkgKHUzMilkYXRhX3JhdGUsIG1p
cGlfdHhfaW5pdF9jZmcuYWN0aXZlX2xhbmVzKTsKKworCQkvKiBXaGVuIGxhdGUgcmF0ZSA8IDgw
MCwgbW9kZXNldCBmYWlscyB3aXRoIDQgbGFuZXMsCisJCSAqIHNvIHN3aXRjaCB0byAyIGxhbmVz
CisJCSAqLworCQlpZiAoZGF0YV9yYXRlIDwgODAwKSB7CisJCQltaXBpX3R4X2luaXRfY2ZnLmFj
dGl2ZV9sYW5lcyA9IDI7CisJCQltaXBpX3R4X2luaXRfY2ZnLmxhbmVfcmF0ZV9tYnBzID0gZGF0
YV9yYXRlICogMjsKKwkJfSBlbHNlIHsKKwkJCW1pcGlfdHhfaW5pdF9jZmcubGFuZV9yYXRlX21i
cHMgPSBkYXRhX3JhdGU7CisJCX0KKwkJZHJtX2luZm8oJmttYi0+ZHJtLAorCQkJICJsYW5lIHJh
dGU9JWRcbiIsIG1pcGlfdHhfaW5pdF9jZmcubGFuZV9yYXRlX21icHMpOworCQlkcm1fZGJnKCZr
bWItPmRybSwKKwkJCSJ2ZnA9ICVkIHZicD0gJWQgdnN5Y19sZW49JWQgaGZwPSVkIGhicD0lZCBo
c3luY19sZW49JWQgbGFuZS1yYXRlPSVkIiwKKwkJICAgICBtaXBpdHhfZnJhbWUwX2NmZy52X2Zy
b250cG9yY2gsCisJCSAgICAgbWlwaXR4X2ZyYW1lMF9jZmcudl9iYWNrcG9yY2gsCisJCSAgICAg
bWlwaXR4X2ZyYW1lMF9jZmcudnN5bmNfd2lkdGgsCisJCSAgICAgbWlwaXR4X2ZyYW1lMF9jZmcu
aF9mcm9udHBvcmNoLAorCQkgICAgIG1pcGl0eF9mcmFtZTBfY2ZnLmhfYmFja3BvcmNoLAorCQkg
ICAgIG1pcGl0eF9mcmFtZTBfY2ZnLmhzeW5jX3dpZHRoLAorCQkgICAgIG1pcGlfdHhfaW5pdF9j
ZmcubGFuZV9yYXRlX21icHMpOworCX0KKworCWlmIChod19pbml0aWFsaXplZCkKKwkJcmV0dXJu
IDA7CisKKwlrbWJfd3JpdGVfbWlwaShrbWIsIERQSFlfRU5BQkxFLCAwKTsKKwlrbWJfd3JpdGVf
bWlwaShrbWIsIERQSFlfSU5JVF9DVFJMMCwgMCk7CisJa21iX3dyaXRlX21pcGkoa21iLCBEUEhZ
X0lOSVRfQ1RSTDEsIDApOworCWttYl93cml0ZV9taXBpKGttYiwgRFBIWV9JTklUX0NUUkwyLCAw
KTsKKworCS8qIEluaXRpYWxpemUgbWlwaSBjb250cm9sbGVyICovCisJbWlwaV90eF9pbml0X2Nu
dHJsKGttYiwgJm1pcGlfdHhfaW5pdF9jZmcpOworCisJLyogRHBoeSBpbml0aWFsaXphdGlvbiAq
LworCW1pcGlfdHhfaW5pdF9kcGh5KGttYiwgJm1pcGlfdHhfaW5pdF9jZmcpOworCWRybV9kYmco
JmttYi0+ZHJtLCAiSVJRX1NUQVRVUyA9IDB4JXhcbiIsCisJCUdFVF9NSVBJX1RYX0hTX0lSUV9T
VEFUVVMoa21iLCBNSVBJX0NUUkw2KSk7CisKKwljb25uZWN0X2xjZF90b19taXBpKGttYik7CisK
KyNpZmRlZiBNSVBJX1RYX1RFU1RfUEFUVEVSTl9HRU5FUkFUSU9OCisJbWlwaV90eF9oc190cF9n
ZW4oa21iLCAwLCBNSVBJX1RYX0hTX1RQX1ZfU1RSSVBFUywKKwkJCSAgMHgxNSwgMHhmZiwgMHhm
ZjAwLCBNSVBJX0NUUkw2KTsKKworCWRybV9kYmcoJmttYi0+ZHJtLCAiSVJRX1NUQVRVUyA9IDB4
JXhcbiIsCisJCUdFVF9NSVBJX1RYX0hTX0lSUV9TVEFUVVMoa21iLCBNSVBJX0NUUkw2KSk7Cisj
ZW5kaWYgLy9NSVBJX1RYX1RFU1RfUEFUVEVSTl9HRU5FUkFUSU9OCisKKwlod19pbml0aWFsaXpl
ZCA9IHRydWU7CisKKwlkcm1fZGJnKCZrbWItPmRybSwgIk1JUElfVFhtX0hTX0NUUkwgPSAweCV4
XG4iLAorCQlrbWJfcmVhZF9taXBpKGttYiwgTUlQSV9UWG1fSFNfQ1RSTCg2KSkpOworCWRybV9k
YmcoJmttYi0+ZHJtLCAiTUlQSSBMT09QIEJBQ0sgPSAleFxuIiwKKwkJa21iX3JlYWRfbWlwaShr
bWIsIE1JUElfQ1RSTF9ESUdfTE9PUEJBQ0spKTsKKwlkcm1faW5mbygma21iLT5kcm0sICJtaXBp
IGh3X2luaXRpYWxpemVkID0gJWRcbiIsIGh3X2luaXRpYWxpemVkKTsKKworCXJldHVybiAwOwor
fQorCitpbnQga21iX2RzaV9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHN0cnVjdCBkcm1f
YnJpZGdlICpicmlkZ2UpCit7CisJc3RydWN0IGttYl9kc2kgKmttYl9kc2k7CisJc3RydWN0IGRy
bV9lbmNvZGVyICplbmNvZGVyOworCXN0cnVjdCBrbWJfY29ubmVjdG9yICprbWJfY29ubmVjdG9y
OworCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3I7CisJc3RydWN0IGttYl9kc2lfaG9z
dCAqaG9zdDsKKwlpbnQgcmV0ID0gMDsKKworCWttYl9kc2kgPSBremFsbG9jKHNpemVvZigqa21i
X2RzaSksIEdGUF9LRVJORUwpOworCWlmICgha21iX2RzaSkgeworCQlEUk1fRVJST1IoImZhaWxl
ZCB0byBhbGxvY2F0ZSBrbWJfZHNpXG4iKTsKKwkJcmV0dXJuIC1FTk9NRU07CisJfQorCisJa21i
X2Nvbm5lY3RvciA9IGt6YWxsb2Moc2l6ZW9mKCprbWJfY29ubmVjdG9yKSwgR0ZQX0tFUk5FTCk7
CisJaWYgKCFrbWJfY29ubmVjdG9yKSB7CisJCWtmcmVlKGttYl9kc2kpOworCQlEUk1fRVJST1Io
ImZhaWxlZCB0byBhbGxvY2F0ZSBrbWJfY29ubmVjdG9yXG4iKTsKKwkJcmV0dXJuIC1FTk9NRU07
CisJfQorCisJa21iX2RzaS0+YXR0YWNoZWRfY29ubmVjdG9yID0ga21iX2Nvbm5lY3RvcjsKKwor
CWhvc3QgPSBrbWJfZHNpX2hvc3RfaW5pdChkZXYsIGttYl9kc2kpOworCWlmICghaG9zdCkgewor
CQlEUk1fRVJST1IoIkZhaWxlZCB0byBhbGxvY2F0ZSBob3N0XG4iKTsKKwkJa2ZyZWUoa21iX2Rz
aSk7CisJCWtmcmVlKGttYl9jb25uZWN0b3IpOworCQlyZXR1cm4gLUVOT01FTTsKKwl9CisKKwlr
bWJfZHNpLT5kc2lfaG9zdCA9IGhvc3Q7CisJY29ubmVjdG9yID0gJmttYl9jb25uZWN0b3ItPmJh
c2U7CisJZW5jb2RlciA9ICZrbWJfZHNpLT5iYXNlOworCWVuY29kZXItPnBvc3NpYmxlX2NydGNz
ID0gMTsKKwllbmNvZGVyLT5wb3NzaWJsZV9jbG9uZXMgPSAwOworCisJZHJtX2VuY29kZXJfaW5p
dChkZXYsIGVuY29kZXIsICZrbWJfZHNpX2Z1bmNzLCBEUk1fTU9ERV9FTkNPREVSX0RTSSwKKwkJ
CSAiTUlQSS1EU0kiKTsKKworCWRybV9jb25uZWN0b3JfaW5pdChkZXYsIGNvbm5lY3RvciwgJmtt
Yl9kc2lfY29ubmVjdG9yX2Z1bmNzLAorCQkJICAgRFJNX01PREVfQ09OTkVDVE9SX0RTSSk7CisK
Kwlkcm1fY29ubmVjdG9yX2hlbHBlcl9hZGQoY29ubmVjdG9yLCAma21iX2RzaV9jb25uZWN0b3Jf
aGVscGVyX2Z1bmNzKTsKKworCWRybV9pbmZvKGRldiwgImNvbm5lY3RvciA9ICVzIGVuY29kZXIg
PSAlc1xuIiwgY29ubmVjdG9yLT5uYW1lLAorCQkgZW5jb2Rlci0+bmFtZSk7CisKKwlyZXQgPSBk
cm1fY29ubmVjdG9yX2F0dGFjaF9lbmNvZGVyKGNvbm5lY3RvciwgZW5jb2Rlcik7CisJZHJtX2lu
Zm8oZGV2LCAiY29ubmVjdG9yLT5lbmNvZGVyID0gMHglcCByZXQgPSAlZFxuIiwKKwkJIGNvbm5l
Y3Rvci0+ZW5jb2RlciwKKwkJIHJldCk7CisKKwkvKiBMaW5rIGRybV9icmlkZ2UgdG8gZW5jb2Rl
ciAqLworCXJldCA9IGRybV9icmlkZ2VfYXR0YWNoKGVuY29kZXIsIGJyaWRnZSwgTlVMTCwgMCk7
CisJaWYgKHJldCkgeworCQlEUk1fRVJST1IoImZhaWxlZCB0byBhdHRhY2ggYnJpZGdlIHRvIE1J
UElcbiIpOworCQlkcm1fZW5jb2Rlcl9jbGVhbnVwKGVuY29kZXIpOworCQlyZXR1cm4gcmV0Owor
CX0KKwlkcm1faW5mbyhkZXYsICJCcmlkZ2UgYXR0YWNoZWQgOiBTVUNDRVNTXG4iKTsKKwlyZXR1
cm4gMDsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9rbWIva21iX2RzaS5oIGIvZHJp
dmVycy9ncHUvZHJtL2ttYi9rbWJfZHNpLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAw
MDAwMC4uYzk4MDgyMwotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9rbWIva21i
X2RzaS5oCkBAIC0wLDAgKzEsMzcwIEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BM
LTIuMC1vbmx5CisgKgorICogQ29weXJpZ2h0IMKpIDIwMTktMjAyMCBJbnRlbCBDb3Jwb3JhdGlv
bgorICovCisKKyNpZm5kZWYgX19LTUJfRFNJX0hfXworI2RlZmluZSBfX0tNQl9EU0lfSF9fCisK
KyNpbmNsdWRlIDxkcm0vZHJtX2NydGMuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX21pcGlfZHNpLmg+
CisjaW5jbHVkZSA8ZHJtL2RybV9tb2Rlcy5oPgorI2luY2x1ZGUgImttYl9kcnYuaCIKKworLyog
TUlQSSBUWCBDRkcqLworI2RlZmluZSBNSVBJX1RYX0xBTkVfREFUQV9SQVRFX01CUFMgODkxCisj
ZGVmaW5lIE1JUElfVFhfUkVGX0NMS19LSFogICAgICAgICAyNDAwMAorI2RlZmluZSBNSVBJX1RY
X0NGR19DTEtfS0haICAgICAgICAgMjQwMDAKKyNkZWZpbmUgTUlQSV9UWF9CUFAJCSAgICAyNAor
CisvKiBEUEhZIFR4IHRlc3QgY29kZXMqLworI2RlZmluZSBURVNUX0NPREVfRlNNX0NPTlRST0wJ
CQkJMHgwMworI2RlZmluZSBURVNUX0NPREVfTVVMVElQTEVfUEhZX0NUUkwJCQkweDBDCisjZGVm
aW5lIFRFU1RfQ09ERV9QTExfUFJPUE9SVElPTkFMX0NIQVJHRV9QVU1QX0NUUkwJMHgwRQorI2Rl
ZmluZSBURVNUX0NPREVfUExMX0lOVEVHUkFMX0NIQVJHRV9QVU1QX0NUUkwJCTB4MEYKKyNkZWZp
bmUgVEVTVF9DT0RFX1BMTF9WQ09fQ1RSTAkJCQkweDEyCisjZGVmaW5lIFRFU1RfQ09ERV9QTExf
R01QX0NUUkwJCQkJMHgxMworI2RlZmluZSBURVNUX0NPREVfUExMX1BIQVNFX0VSUl9DVFJMCQkJ
MHgxNAorI2RlZmluZSBURVNUX0NPREVfUExMX0xPQ0tfRklMVEVSCQkJMHgxNQorI2RlZmluZSBU
RVNUX0NPREVfUExMX1VOTE9DS19GSUxURVIJCQkweDE2CisjZGVmaW5lIFRFU1RfQ09ERV9QTExf
SU5QVVRfRElWSURFUgkJCTB4MTcKKyNkZWZpbmUgVEVTVF9DT0RFX1BMTF9GRUVEQkFDS19ESVZJ
REVSCQkJMHgxOAorI2RlZmluZSAgIFBMTF9GRUVEQkFDS19ESVZJREVSX0hJR0gJCQlCSVQoNykK
KyNkZWZpbmUgVEVTVF9DT0RFX1BMTF9PVVRQVVRfQ0xLX1NFTAkJCTB4MTkKKyNkZWZpbmUgICBQ
TExfTl9PVlJfRU4JCQkJCUJJVCg0KQorI2RlZmluZSAgIFBMTF9NX09WUl9FTgkJCQkJQklUKDUp
CisjZGVmaW5lIFRFU1RfQ09ERV9WT0RfTEVWRUwJCQkJMHgyNAorI2RlZmluZSBURVNUX0NPREVf
UExMX0NIQVJHRV9QVU1QX0JJQVMJCQkweDFDCisjZGVmaW5lIFRFU1RfQ09ERV9QTExfTE9DS19E
RVRFQ1RPUgkJCTB4MUQKKyNkZWZpbmUgVEVTVF9DT0RFX0hTX0ZSRVFfUkFOR0VfQ0ZHCQkJMHg0
NAorI2RlZmluZSBURVNUX0NPREVfUExMX0FOQUxPR19QUk9HCQkJMHgxRgorI2RlZmluZSBURVNU
X0NPREVfU0xFV19SQVRFX09WRVJSSURFX0NUUkwJCTB4QTAKKyNkZWZpbmUgVEVTVF9DT0RFX1NM
RVdfUkFURV9ERExfTE9PUF9DVFJMCQkweEEzCisjZGVmaW5lIFRFU1RfQ09ERV9TTEVXX1JBVEVf
RERMX0NZQ0xFUwkJCTB4QTQKKworLyogRFBIWSBwYXJhbXMgKi8KKyNkZWZpbmUgUExMX05fTUlO
CTAKKyNkZWZpbmUgUExMX05fTUFYCTE1CisjZGVmaW5lIFBMTF9NX01JTgk2MgorI2RlZmluZSBQ
TExfTV9NQVgJNjIzCisjZGVmaW5lIFBMTF9GVkNPX01BWAkxMjUwCisKKyNkZWZpbmUgVElNRU9V
VAkJNjAwCisKKyNkZWZpbmUgTUlQSV9UWF9GUkFNRV9HRU4JCQkJNAorI2RlZmluZSBNSVBJX1RY
X0ZSQU1FX0dFTl9TRUNUSU9OUwkJCTQKKyNkZWZpbmUgTUlQSV9DVFJMX1ZJUlRVQUxfQ0hBTk5F
TFMJCQk0CisjZGVmaW5lIE1JUElfRF9MQU5FU19QRVJfRFBIWQkJCQkyCisjZGVmaW5lIE1JUElf
Q1RSTF8yTEFORV9NQVhfTUNfRklGT19MT0MJCQkyNTUKKyNkZWZpbmUgTUlQSV9DVFJMXzRMQU5F
X01BWF9NQ19GSUZPX0xPQwkJCTUxMQorLyogMiBEYXRhIExhbmVzIHBlciBELVBIWSAqLworI2Rl
ZmluZSBNSVBJX0RQSFlfRF9MQU5FUwkJCQkyCisjZGVmaW5lIE1JUElfRFBIWV9ERUZBVUxUX0JJ
VF9SQVRFUwkJCTYzCisKKyNkZWZpbmUgdG9fa21iX2Nvbm5lY3Rvcih4KSBjb250YWluZXJfb2Yo
eCwgc3RydWN0IGttYl9jb25uZWN0b3IsIGJhc2UpCisjZGVmaW5lIHRvX2ttYl9ob3N0KHgpIGNv
bnRhaW5lcl9vZih4LCBzdHJ1Y3Qga21iX2RzaV9ob3N0LCBiYXNlKQorI2RlZmluZSB0b19rbWJf
ZHNpKHgpIGNvbnRhaW5lcl9vZih4LCBzdHJ1Y3Qga21iX2RzaSwgYmFzZSkKKworc3RydWN0IGtt
Yl9jb25uZWN0b3I7CitzdHJ1Y3Qga21iX2RzaV9ob3N0OworCitzdHJ1Y3Qga21iX2RzaSB7CisJ
c3RydWN0IGRybV9lbmNvZGVyIGJhc2U7CisJc3RydWN0IGttYl9jb25uZWN0b3IgKmF0dGFjaGVk
X2Nvbm5lY3RvcjsKKwlzdHJ1Y3Qga21iX2RzaV9ob3N0ICpkc2lfaG9zdDsKKwlzdHJ1Y3QgZHJt
X2JyaWRnZSAqYnJpZGdlOworfTsKKworc3RydWN0IGttYl9kc2lfaG9zdCB7CisJc3RydWN0IG1p
cGlfZHNpX2hvc3QgKmJhc2U7CisJc3RydWN0IGttYl9kc2kgKmttYl9kc2k7CisJc3RydWN0IG1p
cGlfZHNpX2RldmljZSAqZGV2aWNlOworfTsKKworc3RydWN0IGttYl9jb25uZWN0b3IgeworCXN0
cnVjdCBkcm1fY29ubmVjdG9yIGJhc2U7CisJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyOwor
CXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICpmaXhlZF9tb2RlOworfTsKKworLyogRFBIWSBUeCB0
ZXN0IGNvZGVzICovCisKK2VudW0gbWlwaV9jdHJsX251bSB7CisJTUlQSV9DVFJMMCA9IDAsCisJ
TUlQSV9DVFJMMSwKKwlNSVBJX0NUUkwyLAorCU1JUElfQ1RSTDMsCisJTUlQSV9DVFJMNCwKKwlN
SVBJX0NUUkw1LAorCU1JUElfQ1RSTDYsCisJTUlQSV9DVFJMNywKKwlNSVBJX0NUUkw4LAorCU1J
UElfQ1RSTDksCisJTUlQSV9DVFJMX05BCit9OworCitlbnVtIG1pcGlfZHBoeV9udW0geworCU1J
UElfRFBIWTAgPSAwLAorCU1JUElfRFBIWTEsCisJTUlQSV9EUEhZMiwKKwlNSVBJX0RQSFkzLAor
CU1JUElfRFBIWTQsCisJTUlQSV9EUEhZNSwKKwlNSVBJX0RQSFk2LAorCU1JUElfRFBIWTcsCisJ
TUlQSV9EUEhZOCwKKwlNSVBJX0RQSFk5LAorCU1JUElfRFBIWV9OQQorfTsKKworZW51bSBtaXBp
X2RpciB7CisJTUlQSV9SWCwKKwlNSVBJX1RYCit9OworCitlbnVtIG1pcGlfY3RybF90eXBlIHsK
KwlNSVBJX0RTSSwKKwlNSVBJX0NTSQorfTsKKworZW51bSBtaXBpX2RhdGFfaWYgeworCU1JUElf
SUZfRE1BLAorCU1JUElfSUZfUEFSQUxMRUwKK307CisKK2VudW0gbWlwaV9kYXRhX21vZGUgewor
CU1JUElfREFUQV9NT0RFMCwKKwlNSVBJX0RBVEFfTU9ERTEsCisJTUlQSV9EQVRBX01PREUyLAor
CU1JUElfREFUQV9NT0RFMworfTsKKworZW51bSBtaXBpX2RzaV92aWRlb19tb2RlIHsKKwlEU0lf
VklERU9fTU9ERV9OT19CVVJTVF9QVUxTRSwKKwlEU0lfVklERU9fTU9ERV9OT19CVVJTVF9FVkVO
VCwKKwlEU0lfVklERU9fTU9ERV9CVVJTVAorfTsKKworZW51bSBtaXBpX2RzaV9ibGFua2luZ19t
b2RlIHsKKwlUUkFOU0lUSU9OX1RPX0xPV19QT1dFUiwKKwlTRU5EX0JMQU5LX1BBQ0tFVAorfTsK
KworZW51bSBtaXBpX2RzaV9lb3RwIHsKKwlEU0lfRU9UUF9ESVNBQkxFRCwKKwlEU0lfRU9UUF9F
TkFCTEVTCit9OworCitlbnVtIG1pcGlfZHNpX2RhdGFfdHlwZSB7CisJRFNJX1NQX0RUX1JFU0VS
VkVEXzAwID0gMHgwMCwKKwlEU0lfU1BfRFRfVlNZTkNfU1RBUlQgPSAweDAxLAorCURTSV9TUF9E
VF9DT0xPUl9NT0RFX09GRiA9IDB4MDIsCisJRFNJX1NQX0RUX0dFTkVSSUNfU0hPUlRfV1IgPSAw
eDAzLAorCURTSV9TUF9EVF9HRU5FUklDX1JEID0gMHgwNCwKKwlEU0lfU1BfRFRfRENTX1NIT1JU
X1dSID0gMHgwNSwKKwlEU0lfU1BfRFRfRENTX1JEID0gMHgwNiwKKwlEU0lfU1BfRFRfRU9UUCA9
IDB4MDgsCisJRFNJX0xQX0RUX05VTEwgPSAweDA5LAorCURTSV9MUF9EVF9SRVNFUlZFRF8wQSA9
IDB4MGEsCisJRFNJX0xQX0RUX1JFU0VSVkVEXzBCID0gMHgwYiwKKwlEU0lfTFBfRFRfTFBQU19Z
Q0JDUjQyMl8yMEIgPSAweDBjLAorCURTSV9MUF9EVF9QUFNfUkdCMTAxMDEwXzMwQiA9IDB4MGQs
CisJRFNJX0xQX0RUX1BQU19SR0I1NjVfMTZCID0gMHgwZSwKKwlEU0lfTFBfRFRfUkVTRVJWRURf
MEYgPSAweDBmLAorCisJRFNJX1NQX0RUX1JFU0VSVkVEXzEwID0gMHgxMCwKKwlEU0lfU1BfRFRf
VlNZTkNfRU5EID0gMHgxMSwKKwlEU0lfU1BfRFRfQ09MT1JfTU9ERV9PTiA9IDB4MTIsCisJRFNJ
X1NQX0RUX0dFTkVSSUNfU0hPUlRfV1JfMVBBUiA9IDB4MTMsCisJRFNJX1NQX0RUX0dFTkVSSUNf
UkRfMVBBUiA9IDB4MTQsCisJRFNJX1NQX0RUX0RDU19TSE9SVF9XUl8xUEFSID0gMHgxNSwKKwlE
U0lfU1BfRFRfUkVTRVJWRURfMTYgPSAweDE2LAorCURTSV9TUF9EVF9SRVNFUlZFRF8xNyA9IDB4
MTcsCisJRFNJX1NQX0RUX1JFU0VSVkVEXzE4ID0gMHgxOCwKKwlEU0lfTFBfRFRfQkxBTksgPSAw
eDE5LAorCURTSV9MUF9EVF9SRVNFUlZFRF8xQSA9IDB4MWEsCisJRFNJX0xQX0RUX1JFU0VSVkVE
XzFCID0gMHgxYiwKKwlEU0lfTFBfRFRfUFBTX1lDQkNSNDIyXzI0QiA9IDB4MWMsCisJRFNJX0xQ
X0RUX1BQU19SR0IxMjEyMTJfMzZCID0gMHgxZCwKKwlEU0lfTFBfRFRfUFBTX1JHQjY2Nl8xOEIg
PSAweDFlLAorCURTSV9MUF9EVF9SRVNFUlZFRF8xRiA9IDB4MWYsCisKKwlEU0lfU1BfRFRfUkVT
RVJWRURfMjAgPSAweDIwLAorCURTSV9TUF9EVF9IU1lOQ19TVEFSVCA9IDB4MjEsCisJRFNJX1NQ
X0RUX1NIVVRfRE9XTl9QRVJJUEhfQ01EID0gMHgyMiwKKwlEU0lfU1BfRFRfR0VORVJJQ19TSE9S
VF9XUl8yUEFSID0gMHgyMywKKwlEU0lfU1BfRFRfR0VORVJJQ19SRF8yUEFSID0gMHgyNCwKKwlE
U0lfU1BfRFRfUkVTRVJWRURfMjUgPSAweDI1LAorCURTSV9TUF9EVF9SRVNFUlZFRF8yNiA9IDB4
MjYsCisJRFNJX1NQX0RUX1JFU0VSVkVEXzI3ID0gMHgyNywKKwlEU0lfU1BfRFRfUkVTRVJWRURf
MjggPSAweDI4LAorCURTSV9MUF9EVF9HRU5FUklDX0xPTkdfV1IgPSAweDI5LAorCURTSV9MUF9E
VF9SRVNFUlZFRF8yQSA9IDB4MmEsCisJRFNJX0xQX0RUX1JFU0VSVkVEXzJCID0gMHgyYiwKKwlE
U0lfTFBfRFRfUFBTX1lDQkNSNDIyXzE2QiA9IDB4MmMsCisJRFNJX0xQX0RUX1JFU0VSVkVEXzJE
ID0gMHgyZCwKKwlEU0lfTFBfRFRfTFBQU19SR0I2NjZfMThCID0gMHgyZSwKKwlEU0lfTFBfRFRf
UkVTRVJWRURfMkYgPSAweDJmLAorCisJRFNJX1NQX0RUX1JFU0VSVkVEXzMwID0gMHgzMCwKKwlE
U0lfU1BfRFRfSFNZTkNfRU5EID0gMHgzMSwKKwlEU0lfU1BfRFRfVFVSTl9PTl9QRVJJUEhfQ01E
ID0gMHgzMiwKKwlEU0lfU1BfRFRfUkVTRVJWRURfMzMgPSAweDMzLAorCURTSV9TUF9EVF9SRVNF
UlZFRF8zNCA9IDB4MzQsCisJRFNJX1NQX0RUX1JFU0VSVkVEXzM1ID0gMHgzNSwKKwlEU0lfU1Bf
RFRfUkVTRVJWRURfMzYgPSAweDM2LAorCURTSV9TUF9EVF9TRVRfTUFYX1JFVFVSTl9QS1RfU0la
RSA9IDB4MzcsCisJRFNJX1NQX0RUX1JFU0VSVkVEXzM4ID0gMHgzOCwKKwlEU0lfTFBfRFRfRFND
X0xPTkdfV1IgPSAweDM5LAorCURTSV9MUF9EVF9SRVNFUlZFRF8zQSA9IDB4M2EsCisJRFNJX0xQ
X0RUX1JFU0VSVkVEXzNCID0gMHgzYiwKKwlEU0lfTFBfRFRfUkVTRVJWRURfM0MgPSAweDNjLAor
CURTSV9MUF9EVF9QUFNfWUNCQ1I0MjBfMTJCID0gMHgzZCwKKwlEU0lfTFBfRFRfUFBTX1JHQjg4
OF8yNEIgPSAweDNlLAorCURTSV9MUF9EVF9SRVNFUlZFRF8zRiA9IDB4M2YKK307CisKK2VudW0g
bWlwaV90eF9oc190cF9zZWwgeworCU1JUElfVFhfSFNfVFBfV0hPTEVfRlJBTUVfQ09MT1IwID0g
MCwKKwlNSVBJX1RYX0hTX1RQX1dIT0xFX0ZSQU1FX0NPTE9SMSwKKwlNSVBJX1RYX0hTX1RQX1Zf
U1RSSVBFUywKKwlNSVBJX1RYX0hTX1RQX0hfU1RSSVBFUywKK307CisKK2VudW0gZHBoeV9tb2Rl
IHsKKwlNSVBJX0RQSFlfU0xBVkUgPSAwLAorCU1JUElfRFBIWV9NQVNURVIKK307CisKK2VudW0g
ZHBoeV90eF9mc20geworCURQSFlfVFhfUE9XRVJEV04gPSAwLAorCURQSFlfVFhfQkdQT04sCisJ
RFBIWV9UWF9URVJNQ0FMLAorCURQSFlfVFhfVEVSTUNBTFVQLAorCURQSFlfVFhfT0ZGU0VUQ0FM
LAorCURQSFlfVFhfTE9DSywKKwlEUEhZX1RYX1NSQ0FMLAorCURQSFlfVFhfSURMRSwKKwlEUEhZ
X1RYX1VMUCwKKwlEUEhZX1RYX0xBTkVTVEFSVCwKKwlEUEhZX1RYX0NMS0FMSUdOLAorCURQSFlf
VFhfRERMVFVOTklORywKKwlEUEhZX1RYX1VMUF9GT1JDRV9QTEwsCisJRFBIWV9UWF9MT0NLX0xP
U1MKK307CisKK3N0cnVjdCBtaXBpX2RhdGFfdHlwZV9wYXJhbXMgeworCXU4IHNpemVfY29uc3Ry
YWludF9waXhlbHM7CisJdTggc2l6ZV9jb25zdHJhaW50X2J5dGVzOworCXU4IHBpeGVsc19wZXJf
cGNsazsKKwl1OCBiaXRzX3Blcl9wY2xrOworfTsKKworc3RydWN0IG1pcGlfdHhfZHNpX2NmZyB7
CisJdTggaGZwX2JsYW5rX2VuOwkvKmhvcml6b250YWwgZnJvbnQgcG9yY2ggYmxhbmtpbmcgZW5h
YmxlICovCisJdTggZW90cF9lbjsJLypFbmQgb2YgdHJhbnNtaXNzaW9uIHBhY2tldCBlbmFibGUg
Ki8KKwkvKmxhc3QgdmVydGljYWwgZnJvbnQgcG9yY2ggYmxhbmtpbmcgbW9kZSAqLworCXU4IGxw
bV9sYXN0X3ZmcF9saW5lOworCS8qZmlyc3QgdmVydGljYWwgc3luYyBhY3RpdmUgYmxhbmtpbmcg
bW9kZSAqLworCXU4IGxwbV9maXJzdF92c2FfbGluZTsKKwl1OCBzeW5jX3B1bHNlX2V2ZW50bjsJ
LypzeW5jIHR5cGUgKi8KKwl1OCBoZnBfYmxhbmtpbmc7CS8qaG9yaXpvbnRhbCBmcm9udCBwb3Jj
aCBibGFua2luZyBtb2RlICovCisJdTggaGJwX2JsYW5raW5nOwkvKmhvcml6b250YWwgYmFjayBw
b3JjaCBibGFua2luZyBtb2RlICovCisJdTggaHNhX2JsYW5raW5nOwkvKmhvcml6b250YWwgc3lu
YyBhY3RpdmUgYmxhbmtpbmcgbW9kZSAqLworCXU4IHZfYmxhbmtpbmc7CS8qdmVydGljYWwgdGlt
aW5nIGJsYW5raW5nIG1vZGUgKi8KK307CisKK3N0cnVjdCBtaXBpX3R4X2ZyYW1lX3NlY3Rpb25f
Y2ZnIHsKKwl1MzIgZG1hX3Zfc3RyaWRlOworCXUxNiBkbWFfdl9zY2FsZV9jZmc7CisJdTE2IHdp
ZHRoX3BpeGVsczsKKwl1MTYgaGVpZ2h0X2xpbmVzOworCXU4IGRtYV9wYWNrZWQ7CisJdTggYnBw
OworCXU4IGJwcF91bnBhY2tlZDsKKwl1OCBkbWFfaF9zdHJpZGU7CisJdTggZGF0YV90eXBlOwor
CXU4IGRhdGFfbW9kZTsKKwl1OCBkbWFfZmxpcF9yb3RhdGVfc2VsOworfTsKKworc3RydWN0IG1p
cGlfdHhfZnJhbWVfdGltaW5nX2NmZyB7CisJdTMyIGJwcDsKKwl1MzIgbGFuZV9yYXRlX21icHM7
CisJdTMyIGhzeW5jX3dpZHRoOworCXUzMiBoX2JhY2twb3JjaDsKKwl1MzIgaF9mcm9udHBvcmNo
OworCXUzMiBoX2FjdGl2ZTsKKwl1MTYgdnN5bmNfd2lkdGg7CisJdTE2IHZfYmFja3BvcmNoOwor
CXUxNiB2X2Zyb250cG9yY2g7CisJdTE2IHZfYWN0aXZlOworCXU4IGFjdGl2ZV9sYW5lczsKK307
CisKK3N0cnVjdCBtaXBpX3R4X2ZyYW1lX3NlY3RfcGhjZmcgeworCXUzMiB3YzsKKwllbnVtIG1p
cGlfZGF0YV9tb2RlIGRhdGFfbW9kZTsKKwllbnVtIG1pcGlfZHNpX2RhdGFfdHlwZSBkYXRhX3R5
cGU7CisJdTggdmNoYW5uZWw7CisJdTggZG1hX3BhY2tlZDsKK307CisKK3N0cnVjdCBtaXBpX3R4
X2ZyYW1lX2NmZyB7CisJc3RydWN0IG1pcGlfdHhfZnJhbWVfc2VjdGlvbl9jZmcgKnNlY3Rpb25z
W01JUElfVFhfRlJBTUVfR0VOX1NFQ1RJT05TXTsKKwl1MzIgaHN5bmNfd2lkdGg7CS8qaW4gcGl4
ZWxzICovCisJdTMyIGhfYmFja3BvcmNoOwkvKmluIHBpeGVscyAqLworCXUzMiBoX2Zyb250cG9y
Y2g7CS8qaW4gcGl4ZWxzICovCisJdTE2IHZzeW5jX3dpZHRoOwkvKmluIGxpbmVzICovCisJdTE2
IHZfYmFja3BvcmNoOwkvKmluIGxpbmVzICovCisJdTE2IHZfZnJvbnRwb3JjaDsJLyppbiBsaW5l
cyAqLworfTsKKworc3RydWN0IG1pcGlfdHhfY3RybF9jZmcgeworCXN0cnVjdCBtaXBpX3R4X2Zy
YW1lX2NmZyAqZnJhbWVzW01JUElfVFhfRlJBTUVfR0VOXTsKKwlzdHJ1Y3QgbWlwaV90eF9kc2lf
Y2ZnICp0eF9kc2lfY2ZnOworCXU4IGxpbmVfc3luY19wa3RfZW47CisJdTggbGluZV9jb3VudGVy
X2FjdGl2ZTsKKwl1OCBmcmFtZV9jb3VudGVyX2FjdGl2ZTsKKwl1OCB0eF9oc2Nsa2tpZGxlX2Nu
dDsKKwl1OCB0eF9oc2V4aXRfY250OworCXU4IHR4X2NyY19lbjsKKwl1OCB0eF9oYWN0X3dhaXRf
c3RvcDsKKwl1OCB0eF9hbHdheXNfdXNlX2hhY3Q7CisJdTggdHhfd2FpdF90cmlnOworCXU4IHR4
X3dhaXRfYWxsX3NlY3Q7Cit9OworCisvKmNvbmZpZ3VyYXRpb24gc3RydWN0dXJlIGZvciBNSVBJ
IGNvbnRyb2wgKi8KK3N0cnVjdCBtaXBpX2N0cmxfY2ZnIHsKKwkvKiBjb250cm9sbGVyIGluZGV4
IDogQ1RSTDYgZm9yIGNvbm5lY3RpbmcgdG8gTENEICovCisJdTggaW5kZXg7CisJdTggdHlwZTsJ
CS8qIGNvbnRyb2xsZXIgdHlwZSA6IE1JUElfRFNJICovCisJdTggZGlyOwkJLyogY29udHJvbGxl
ciBkaXJlY3Rpb24gOiBNSVBJX1RYICovCisJdTggYWN0aXZlX2xhbmVzOwkvKiAjIGFjdGl2ZSBs
YW5lcyBwZXIgY29udHJvbGxlciAyLzQgKi8KKwl1MzIgbGFuZV9yYXRlX21icHM7CS8qTUJQUyAq
LworCXUzMiByZWZfY2xrX2toejsKKwl1MzIgY2ZnX2Nsa19raHo7CisJdTMyIGRhdGFfaWY7CS8q
TUlQSV9JRl9ETUEgb3IgTUlQSV9JRl9QQVJBTExFTCAqLworCXN0cnVjdCBtaXBpX3R4X2N0cmxf
Y2ZnIHR4X2N0cmxfY2ZnOworfTsKKworLyogU3RydWN0dXJlIGZvciBzdG9yaW5nIHVzZXIgc3Bl
Y2lmaWVkIGludGVycnVwdHMgdGhhdCBhcmUgZW5hYmxlZCAqLwordW5pb24gbWlwaV9pcnFfY2Zn
IHsKKwl1OCB2YWx1ZTsKKwlzdHJ1Y3QgeworCQl1OCBsaW5lX2NvbXBhcmU6MTsKKwkJdTggZG1h
X2V2ZW50OjE7CisJCXU4IGZyYW1lX2RvbmU6MTsKKwkJdTggY3RybF9lcnJvcjoxOworCQl1OCBk
cGh5X2Vycm9yOjE7CisJfSBpcnFfY2ZnOworfTsKKworc3RydWN0IGRybV9icmlkZ2UgKmttYl9k
c2lfaG9zdF9icmlkZ2VfaW5pdChzdHJ1Y3QgZGV2aWNlICpkZXYpOworaW50IGttYl9kc2lfaW5p
dChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKTsKK3Zv
aWQga21iX3BsYW5lX2Rlc3Ryb3koc3RydWN0IGRybV9wbGFuZSAqcGxhbmUpOwordm9pZCBtaXBp
X3R4X2hhbmRsZV9pcnFzKHN0cnVjdCBrbWJfZHJtX3ByaXZhdGUgKmRldl9wKTsKK3ZvaWQga21i
X2RzaV9ob3N0X3VucmVnaXN0ZXIodm9pZCk7CitpbnQga21iX2RzaV9od19pbml0KHN0cnVjdCBk
cm1fZGV2aWNlICpkZXYsIHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlKTsKKyNlbmRpZiAv
KiBfX0tNQl9EU0lfSF9fICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0va21iL2ttYl9w
bGFuZS5jIGIvZHJpdmVycy9ncHUvZHJtL2ttYi9rbWJfcGxhbmUuYwpuZXcgZmlsZSBtb2RlIDEw
MDY0NAppbmRleCAwMDAwMDAwLi4zMWJjYmEwCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2ttYi9rbWJfcGxhbmUuYwpAQCAtMCwwICsxLDUxOSBAQAorLy8gU1BEWC1MaWNlbnNl
LUlkZW50aWZpZXI6IEdQTC0yLjAtb25seQorLyoKKyAqIENvcHlyaWdodCDCqSAyMDE4LTIwMjAg
SW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaW5jbHVkZSA8bGludXgvY2xrLmg+CisjaW5jbHVk
ZSA8bGludXgvb2ZfZ3JhcGguaD4KKyNpbmNsdWRlIDxsaW51eC9wbGF0Zm9ybV9kYXRhL3NpbXBs
ZWZiLmg+CisjaW5jbHVkZSA8dmlkZW8vdmlkZW9tb2RlLmg+CisKKyNpbmNsdWRlIDxkcm0vZHJt
X2F0b21pYy5oPgorI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljX2hlbHBlci5oPgorI2luY2x1ZGUg
PGRybS9kcm1fY3J0Yy5oPgorI2luY2x1ZGUgPGRybS9kcm1fY3J0Y19oZWxwZXIuaD4KKyNpbmNs
dWRlIDxkcm0vZHJtX2ZiX2NtYV9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2ZiX2hlbHBl
ci5oPgorI2luY2x1ZGUgPGRybS9kcm1fZ2VtX2NtYV9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0v
ZHJtX29mLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wbGFuZV9oZWxwZXIuaD4KKyNpbmNsdWRlIDxk
cm0vZHJtX21hbmFnZWQuaD4KKworI2luY2x1ZGUgImttYl9jcnRjLmgiCisjaW5jbHVkZSAia21i
X2Rydi5oIgorI2luY2x1ZGUgImttYl9wbGFuZS5oIgorI2luY2x1ZGUgImttYl9yZWdzLmgiCisK
K3N0cnVjdCBsYXllcl9zdGF0dXMgcGxhbmVfc3RhdHVzW0tNQl9NQVhfUExBTkVTXTsKK2NvbnN0
IHUzMiBsYXllcl9pcnFzW10gPSB7CisJTENEX0lOVF9WTDAsCisJTENEX0lOVF9WTDEsCisJTENE
X0lOVF9HTDAsCisJTENEX0lOVF9HTDEKK307CisKK3N0YXRpYyB1bnNpZ25lZCBpbnQgY2hlY2tf
cGl4ZWxfZm9ybWF0KHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLCB1MzIgZm9ybWF0KQoreworCWlu
dCBpOworCisJZm9yIChpID0gMDsgaSA8IHBsYW5lLT5mb3JtYXRfY291bnQ7IGkrKykgeworCQlp
ZiAocGxhbmUtPmZvcm1hdF90eXBlc1tpXSA9PSBmb3JtYXQpCisJCQlyZXR1cm4gMDsKKwl9CisJ
cmV0dXJuIC1FSU5WQUw7Cit9CisKK3N0YXRpYyBpbnQga21iX3BsYW5lX2F0b21pY19jaGVjayhz
dHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKKwkJCQkgIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnN0
YXRlKQoreworCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiOworCWludCByZXQ7CisKKwlmYiA9
IHN0YXRlLT5mYjsKKwlpZiAoIWZiIHx8ICFzdGF0ZS0+Y3J0YykKKwkJcmV0dXJuIDA7CisKKwly
ZXQgPSBjaGVja19waXhlbF9mb3JtYXQocGxhbmUsIGZiLT5mb3JtYXQtPmZvcm1hdCk7CisJaWYg
KHJldCkKKwkJcmV0dXJuIHJldDsKKworCWlmIChzdGF0ZS0+Y3J0Y193ID4gS01CX01BWF9XSURU
SCB8fCBzdGF0ZS0+Y3J0Y19oID4gS01CX01BWF9IRUlHSFQpCisJCXJldHVybiAtRUlOVkFMOwor
CWlmIChzdGF0ZS0+Y3J0Y193IDwgS01CX01JTl9XSURUSCB8fCBzdGF0ZS0+Y3J0Y19oIDwgS01C
X01JTl9IRUlHSFQpCisJCXJldHVybiAtRUlOVkFMOworCXJldHVybiAwOworfQorCitzdGF0aWMg
dm9pZCBrbWJfcGxhbmVfYXRvbWljX2Rpc2FibGUoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsCisJ
CQkJICAgICBzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpzdGF0ZSkKK3sKKwlzdHJ1Y3Qga21iX3Bs
YW5lICprbWJfcGxhbmUgPSB0b19rbWJfcGxhbmUocGxhbmUpOworCWludCBwbGFuZV9pZCA9IGtt
Yl9wbGFuZS0+aWQ7CisKKwlzd2l0Y2ggKHBsYW5lX2lkKSB7CisJY2FzZSBMQVlFUl8wOgorCQlw
bGFuZV9zdGF0dXNbcGxhbmVfaWRdLmN0cmwgPSBMQ0RfQ1RSTF9WTDFfRU5BQkxFOworCQlicmVh
azsKKwljYXNlIExBWUVSXzE6CisJCXBsYW5lX3N0YXR1c1twbGFuZV9pZF0uY3RybCA9IExDRF9D
VFJMX1ZMMl9FTkFCTEU7CisJCWJyZWFrOworCWNhc2UgTEFZRVJfMjoKKwkJcGxhbmVfc3RhdHVz
W3BsYW5lX2lkXS5jdHJsID0gTENEX0NUUkxfR0wxX0VOQUJMRTsKKwkJYnJlYWs7CisJY2FzZSBM
QVlFUl8zOgorCQlwbGFuZV9zdGF0dXNbcGxhbmVfaWRdLmN0cmwgPSBMQ0RfQ1RSTF9HTDJfRU5B
QkxFOworCQlicmVhazsKKwl9CisKKwlwbGFuZV9zdGF0dXNbcGxhbmVfaWRdLmRpc2FibGUgPSB0
cnVlOworfQorCit1bnNpZ25lZCBpbnQgc2V0X3BpeGVsX2Zvcm1hdCh1MzIgZm9ybWF0KQorewor
CXVuc2lnbmVkIGludCB2YWwgPSAwOworCisJc3dpdGNoIChmb3JtYXQpIHsKKwkJLyogcGxhbmFy
IGZvcm1hdHMgKi8KKwljYXNlIERSTV9GT1JNQVRfWVVWNDQ0OgorCQl2YWwgPSBMQ0RfTEFZRVJf
Rk9STUFUX1lDQkNSNDQ0UExBTiB8IExDRF9MQVlFUl9QTEFOQVJfU1RPUkFHRTsKKwkJYnJlYWs7
CisJY2FzZSBEUk1fRk9STUFUX1lWVTQ0NDoKKwkJdmFsID0gTENEX0xBWUVSX0ZPUk1BVF9ZQ0JD
UjQ0NFBMQU4gfCBMQ0RfTEFZRVJfUExBTkFSX1NUT1JBR0UKKwkJICAgIHwgTENEX0xBWUVSX0NS
Q0JfT1JERVI7CisJCWJyZWFrOworCWNhc2UgRFJNX0ZPUk1BVF9ZVVY0MjI6CisJCXZhbCA9IExD
RF9MQVlFUl9GT1JNQVRfWUNCQ1I0MjJQTEFOIHwgTENEX0xBWUVSX1BMQU5BUl9TVE9SQUdFOwor
CQlicmVhazsKKwljYXNlIERSTV9GT1JNQVRfWVZVNDIyOgorCQl2YWwgPSBMQ0RfTEFZRVJfRk9S
TUFUX1lDQkNSNDIyUExBTiB8IExDRF9MQVlFUl9QTEFOQVJfU1RPUkFHRQorCQkgICAgfCBMQ0Rf
TEFZRVJfQ1JDQl9PUkRFUjsKKwkJYnJlYWs7CisJY2FzZSBEUk1fRk9STUFUX1lVVjQyMDoKKwkJ
dmFsID0gTENEX0xBWUVSX0ZPUk1BVF9ZQ0JDUjQyMFBMQU4gfCBMQ0RfTEFZRVJfUExBTkFSX1NU
T1JBR0U7CisJCWJyZWFrOworCWNhc2UgRFJNX0ZPUk1BVF9ZVlU0MjA6CisJCXZhbCA9IExDRF9M
QVlFUl9GT1JNQVRfWUNCQ1I0MjBQTEFOIHwgTENEX0xBWUVSX1BMQU5BUl9TVE9SQUdFCisJCSAg
ICB8IExDRF9MQVlFUl9DUkNCX09SREVSOworCQlicmVhazsKKwljYXNlIERSTV9GT1JNQVRfTlYx
MjoKKwkJdmFsID0gTENEX0xBWUVSX0ZPUk1BVF9OVjEyIHwgTENEX0xBWUVSX1BMQU5BUl9TVE9S
QUdFOworCQlicmVhazsKKwljYXNlIERSTV9GT1JNQVRfTlYyMToKKwkJdmFsID0gTENEX0xBWUVS
X0ZPUk1BVF9OVjEyIHwgTENEX0xBWUVSX1BMQU5BUl9TVE9SQUdFCisJCSAgICB8IExDRF9MQVlF
Ul9DUkNCX09SREVSOworCQlicmVhazsKKwkJLyogcGFja2VkIGZvcm1hdHMgKi8KKwkJLyogbG9v
a3MgaHcgcmVxdWlyZXMgQiAmIEcgdG8gYmUgc3dhcHBlZCB3aGVuIFJHQiAqLworCWNhc2UgRFJN
X0ZPUk1BVF9SR0IzMzI6CisJCXZhbCA9IExDRF9MQVlFUl9GT1JNQVRfUkdCMzMyIHwgTENEX0xB
WUVSX0JHUl9PUkRFUjsKKwkJYnJlYWs7CisJY2FzZSBEUk1fRk9STUFUX1hCR1I0NDQ0OgorCQl2
YWwgPSBMQ0RfTEFZRVJfRk9STUFUX1JHQlg0NDQ0OworCQlicmVhazsKKwljYXNlIERSTV9GT1JN
QVRfQVJHQjQ0NDQ6CisJCXZhbCA9IExDRF9MQVlFUl9GT1JNQVRfUkdCQTQ0NDQgfCBMQ0RfTEFZ
RVJfQkdSX09SREVSOworCQlicmVhazsKKwljYXNlIERSTV9GT1JNQVRfQUJHUjQ0NDQ6CisJCXZh
bCA9IExDRF9MQVlFUl9GT1JNQVRfUkdCQTQ0NDQ7CisJCWJyZWFrOworCWNhc2UgRFJNX0ZPUk1B
VF9YUkdCMTU1NToKKwkJdmFsID0gTENEX0xBWUVSX0ZPUk1BVF9YUkdCMTU1NSB8IExDRF9MQVlF
Ul9CR1JfT1JERVI7CisJCWJyZWFrOworCWNhc2UgRFJNX0ZPUk1BVF9YQkdSMTU1NToKKwkJdmFs
ID0gTENEX0xBWUVSX0ZPUk1BVF9YUkdCMTU1NTsKKwkJYnJlYWs7CisJY2FzZSBEUk1fRk9STUFU
X0FSR0IxNTU1OgorCQl2YWwgPSBMQ0RfTEFZRVJfRk9STUFUX1JHQkExNTU1IHwgTENEX0xBWUVS
X0JHUl9PUkRFUjsKKwkJYnJlYWs7CisJY2FzZSBEUk1fRk9STUFUX0FCR1IxNTU1OgorCQl2YWwg
PSBMQ0RfTEFZRVJfRk9STUFUX1JHQkExNTU1OworCQlicmVhazsKKwljYXNlIERSTV9GT1JNQVRf
UkdCNTY1OgorCQl2YWwgPSBMQ0RfTEFZRVJfRk9STUFUX1JHQjU2NSB8IExDRF9MQVlFUl9CR1Jf
T1JERVI7CisJCWJyZWFrOworCWNhc2UgRFJNX0ZPUk1BVF9CR1I1NjU6CisJCXZhbCA9IExDRF9M
QVlFUl9GT1JNQVRfUkdCNTY1OworCQlicmVhazsKKwljYXNlIERSTV9GT1JNQVRfUkdCODg4Ogor
CQl2YWwgPSBMQ0RfTEFZRVJfRk9STUFUX1JHQjg4OCB8IExDRF9MQVlFUl9CR1JfT1JERVI7CisJ
CWJyZWFrOworCWNhc2UgRFJNX0ZPUk1BVF9CR1I4ODg6CisJCXZhbCA9IExDRF9MQVlFUl9GT1JN
QVRfUkdCODg4OworCQlicmVhazsKKwljYXNlIERSTV9GT1JNQVRfWFJHQjg4ODg6CisJCXZhbCA9
IExDRF9MQVlFUl9GT1JNQVRfUkdCWDg4ODggfCBMQ0RfTEFZRVJfQkdSX09SREVSOworCQlicmVh
azsKKwljYXNlIERSTV9GT1JNQVRfWEJHUjg4ODg6CisJCXZhbCA9IExDRF9MQVlFUl9GT1JNQVRf
UkdCWDg4ODg7CisJCWJyZWFrOworCWNhc2UgRFJNX0ZPUk1BVF9BUkdCODg4ODoKKwkJdmFsID0g
TENEX0xBWUVSX0ZPUk1BVF9SR0JBODg4OCB8IExDRF9MQVlFUl9CR1JfT1JERVI7CisJCWJyZWFr
OworCWNhc2UgRFJNX0ZPUk1BVF9BQkdSODg4ODoKKwkJdmFsID0gTENEX0xBWUVSX0ZPUk1BVF9S
R0JBODg4ODsKKwkJYnJlYWs7CisJfQorCURSTV9JTkZPX09OQ0UoIiVzIDogJWQgZm9ybWF0PTB4
JXggdmFsPTB4JXhcbiIsCisJCSAgICAgIF9fZnVuY19fLCBfX0xJTkVfXywgZm9ybWF0LCB2YWwp
OworCXJldHVybiB2YWw7Cit9CisKK3Vuc2lnbmVkIGludCBzZXRfYml0c19wZXJfcGl4ZWwoY29u
c3Qgc3RydWN0IGRybV9mb3JtYXRfaW5mbyAqZm9ybWF0KQoreworCXUzMiBicHAgPSAwOworCXVu
c2lnbmVkIGludCB2YWwgPSAwOworCisJaWYgKGZvcm1hdC0+bnVtX3BsYW5lcyA+IDEpIHsKKwkJ
dmFsID0gTENEX0xBWUVSXzhCUFA7CisJCXJldHVybiB2YWw7CisJfQorCisJYnBwICs9IDggKiBm
b3JtYXQtPmNwcFswXTsKKworCXN3aXRjaCAoYnBwKSB7CisJY2FzZSA4OgorCQl2YWwgPSBMQ0Rf
TEFZRVJfOEJQUDsKKwkJYnJlYWs7CisJY2FzZSAxNjoKKwkJdmFsID0gTENEX0xBWUVSXzE2QlBQ
OworCQlicmVhazsKKwljYXNlIDI0OgorCQl2YWwgPSBMQ0RfTEFZRVJfMjRCUFA7CisJCWJyZWFr
OworCWNhc2UgMzI6CisJCXZhbCA9IExDRF9MQVlFUl8zMkJQUDsKKwkJYnJlYWs7CisJfQorCisJ
RFJNX0RFQlVHKCJicHA9JWQgdmFsPTB4JXhcbiIsIGJwcCwgdmFsKTsKKwlyZXR1cm4gdmFsOwor
fQorCitzdGF0aWMgdm9pZCBjb25maWdfY3NjKHN0cnVjdCBrbWJfZHJtX3ByaXZhdGUgKmttYiwg
aW50IHBsYW5lX2lkKQoreworCS8qIFlVViB0byBSR0IgY29udmVyc2lvbiB1c2luZyB0aGUgZml4
ZWQgbWF0cml4IGNzY19jb2VmX2xjZCAqLworCWttYl93cml0ZV9sY2Qoa21iLCBMQ0RfTEFZRVJu
X0NTQ19DT0VGRjExKHBsYW5lX2lkKSwgY3NjX2NvZWZfbGNkWzBdKTsKKwlrbWJfd3JpdGVfbGNk
KGttYiwgTENEX0xBWUVSbl9DU0NfQ09FRkYxMihwbGFuZV9pZCksIGNzY19jb2VmX2xjZFsxXSk7
CisJa21iX3dyaXRlX2xjZChrbWIsIExDRF9MQVlFUm5fQ1NDX0NPRUZGMTMocGxhbmVfaWQpLCBj
c2NfY29lZl9sY2RbMl0pOworCWttYl93cml0ZV9sY2Qoa21iLCBMQ0RfTEFZRVJuX0NTQ19DT0VG
RjIxKHBsYW5lX2lkKSwgY3NjX2NvZWZfbGNkWzNdKTsKKwlrbWJfd3JpdGVfbGNkKGttYiwgTENE
X0xBWUVSbl9DU0NfQ09FRkYyMihwbGFuZV9pZCksIGNzY19jb2VmX2xjZFs0XSk7CisJa21iX3dy
aXRlX2xjZChrbWIsIExDRF9MQVlFUm5fQ1NDX0NPRUZGMjMocGxhbmVfaWQpLCBjc2NfY29lZl9s
Y2RbNV0pOworCWttYl93cml0ZV9sY2Qoa21iLCBMQ0RfTEFZRVJuX0NTQ19DT0VGRjMxKHBsYW5l
X2lkKSwgY3NjX2NvZWZfbGNkWzZdKTsKKwlrbWJfd3JpdGVfbGNkKGttYiwgTENEX0xBWUVSbl9D
U0NfQ09FRkYzMihwbGFuZV9pZCksIGNzY19jb2VmX2xjZFs3XSk7CisJa21iX3dyaXRlX2xjZChr
bWIsIExDRF9MQVlFUm5fQ1NDX0NPRUZGMzMocGxhbmVfaWQpLCBjc2NfY29lZl9sY2RbOF0pOwor
CWttYl93cml0ZV9sY2Qoa21iLCBMQ0RfTEFZRVJuX0NTQ19PRkYxKHBsYW5lX2lkKSwgY3NjX2Nv
ZWZfbGNkWzldKTsKKwlrbWJfd3JpdGVfbGNkKGttYiwgTENEX0xBWUVSbl9DU0NfT0ZGMihwbGFu
ZV9pZCksIGNzY19jb2VmX2xjZFsxMF0pOworCWttYl93cml0ZV9sY2Qoa21iLCBMQ0RfTEFZRVJu
X0NTQ19PRkYzKHBsYW5lX2lkKSwgY3NjX2NvZWZfbGNkWzExXSk7Cit9CisKK3N0YXRpYyB2b2lk
IGttYl9wbGFuZV9hdG9taWNfdXBkYXRlKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLAorCQkJCSAg
ICBzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpzdGF0ZSkKK3sKKwlzdHJ1Y3QgZHJtX2ZyYW1lYnVm
ZmVyICpmYjsKKwlzdHJ1Y3Qga21iX2RybV9wcml2YXRlICprbWI7CisJdW5zaWduZWQgaW50IHdp
ZHRoOworCXVuc2lnbmVkIGludCBoZWlnaHQ7CisJdW5zaWduZWQgaW50IGRtYV9sZW47CisJc3Ry
dWN0IGttYl9wbGFuZSAqa21iX3BsYW5lOworCXVuc2lnbmVkIGludCBkbWFfY2ZnOworCXVuc2ln
bmVkIGludCBjdHJsID0gMCwgdmFsID0gMCwgb3V0X2Zvcm1hdCA9IDA7CisJdW5zaWduZWQgaW50
IHNyY193LCBzcmNfaCwgY3J0Y194LCBjcnRjX3k7CisJdW5zaWduZWQgY2hhciBwbGFuZV9pZDsK
KwlpbnQgbnVtX3BsYW5lczsKKwlzdGF0aWMgZG1hX2FkZHJfdCBhZGRyW01BWF9TVUJfUExBTkVT
XSA9IHsgMCwgMCwgMCB9OworCisJaWYgKCFwbGFuZSB8fCAhcGxhbmUtPnN0YXRlIHx8ICFzdGF0
ZSkKKwkJcmV0dXJuOworCisJZmIgPSBwbGFuZS0+c3RhdGUtPmZiOworCWlmICghZmIpCisJCXJl
dHVybjsKKwludW1fcGxhbmVzID0gZmItPmZvcm1hdC0+bnVtX3BsYW5lczsKKwlrbWJfcGxhbmUg
PSB0b19rbWJfcGxhbmUocGxhbmUpOworCXBsYW5lX2lkID0ga21iX3BsYW5lLT5pZDsKKworCWtt
YiA9IHRvX2ttYihwbGFuZS0+ZGV2KTsKKworCWlmIChrbWJfdW5kZXJfZmxvdyB8fCBrbWJfZmx1
c2hfZG9uZSkgeworCQlkcm1fZGJnKCZrbWItPmRybSwgInBsYW5lX3VwZGF0ZTp1bmRlcmZsb3ch
ISEhIHJldHVybmluZyIpOworCQlyZXR1cm47CisJfQorCisJc3JjX3cgPSAocGxhbmUtPnN0YXRl
LT5zcmNfdyA+PiAxNik7CisJc3JjX2ggPSBwbGFuZS0+c3RhdGUtPnNyY19oID4+IDE2OworCWNy
dGNfeCA9IHBsYW5lLT5zdGF0ZS0+Y3J0Y194OworCWNydGNfeSA9IHBsYW5lLT5zdGF0ZS0+Y3J0
Y195OworCisJZHJtX2RiZygma21iLT5kcm0sCisJCSJzcmNfdz0lZCBzcmNfaD0lZCwgZmItPmZv
cm1hdC0+Zm9ybWF0PTB4JXggZmItPmZsYWdzPTB4JXhcbiIsCisJCSAgc3JjX3csIHNyY19oLCBm
Yi0+Zm9ybWF0LT5mb3JtYXQsIGZiLT5mbGFncyk7CisKKwl3aWR0aCA9IGZiLT53aWR0aDsKKwlo
ZWlnaHQgPSBmYi0+aGVpZ2h0OworCWRtYV9sZW4gPSAod2lkdGggKiBoZWlnaHQgKiBmYi0+Zm9y
bWF0LT5jcHBbMF0pOworCWRybV9kYmcoJmttYi0+ZHJtLCAiZG1hX2xlbj0lZCAiLCBkbWFfbGVu
KTsKKwlrbWJfd3JpdGVfbGNkKGttYiwgTENEX0xBWUVSbl9ETUFfTEVOKHBsYW5lX2lkKSwgZG1h
X2xlbik7CisJa21iX3dyaXRlX2xjZChrbWIsIExDRF9MQVlFUm5fRE1BX0xFTl9TSEFET1cocGxh
bmVfaWQpLCBkbWFfbGVuKTsKKwlrbWJfd3JpdGVfbGNkKGttYiwgTENEX0xBWUVSbl9ETUFfTElO
RV9WU1RSSURFKHBsYW5lX2lkKSwKKwkJICAgICAgZmItPnBpdGNoZXNbMF0pOworCWttYl93cml0
ZV9sY2Qoa21iLCBMQ0RfTEFZRVJuX0RNQV9MSU5FX1dJRFRIKHBsYW5lX2lkKSwKKwkJICAgICAg
KHdpZHRoICogZmItPmZvcm1hdC0+Y3BwWzBdKSk7CisKKwlhZGRyW1lfUExBTkVdID0gZHJtX2Zi
X2NtYV9nZXRfZ2VtX2FkZHIoZmIsIHBsYW5lLT5zdGF0ZSwgMCk7CisJa21iLT5mYl9hZGRyID0g
YWRkcltZX1BMQU5FXTsKKwlrbWJfd3JpdGVfbGNkKGttYiwgTENEX0xBWUVSbl9ETUFfU1RBUlRf
QUREUihwbGFuZV9pZCksCisJCSAgICAgIGFkZHJbWV9QTEFORV0gKyBmYi0+b2Zmc2V0c1swXSk7
CisJdmFsID0gc2V0X3BpeGVsX2Zvcm1hdChmYi0+Zm9ybWF0LT5mb3JtYXQpOworCXZhbCB8PSBz
ZXRfYml0c19wZXJfcGl4ZWwoZmItPmZvcm1hdCk7CisJLyogUHJvZ3JhbSBDYi9DciBmb3IgcGxh
bmFyIGZvcm1hdHMgKi8KKwlpZiAobnVtX3BsYW5lcyA+IDEpIHsKKwkJa21iX3dyaXRlX2xjZChr
bWIsIExDRF9MQVlFUm5fRE1BX0NCX0xJTkVfVlNUUklERShwbGFuZV9pZCksCisJCQkgICAgICB3
aWR0aCAqIGZiLT5mb3JtYXQtPmNwcFswXSk7CisJCWttYl93cml0ZV9sY2Qoa21iLCBMQ0RfTEFZ
RVJuX0RNQV9DQl9MSU5FX1dJRFRIKHBsYW5lX2lkKSwKKwkJCSAgICAgICh3aWR0aCAqIGZiLT5m
b3JtYXQtPmNwcFswXSkpOworCisJCWFkZHJbVV9QTEFORV0gPSBkcm1fZmJfY21hX2dldF9nZW1f
YWRkcihmYiwgcGxhbmUtPnN0YXRlLAorCQkJCQkJCVVfUExBTkUpOworCQkvKiBjaGVjayBpZiBD
Yi9DciBpcyBzd2FwcGVkKi8KKwkJaWYgKG51bV9wbGFuZXMgPT0gMyAmJiAodmFsICYgTENEX0xB
WUVSX0NSQ0JfT1JERVIpKQorCQkJa21iX3dyaXRlX2xjZChrbWIsCisJCQkJICAgICAgTENEX0xB
WUVSbl9ETUFfU1RBUlRfQ1JfQURSKHBsYW5lX2lkKSwKKwkJCQkJYWRkcltVX1BMQU5FXSk7CisJ
CWVsc2UKKwkJCWttYl93cml0ZV9sY2Qoa21iLAorCQkJCSAgICAgIExDRF9MQVlFUm5fRE1BX1NU
QVJUX0NCX0FEUihwbGFuZV9pZCksCisJCQkJCWFkZHJbVV9QTEFORV0pOworCisJCWlmIChudW1f
cGxhbmVzID09IDMpIHsKKwkJCWttYl93cml0ZV9sY2Qoa21iLAorCQkJCSAgICAgIExDRF9MQVlF
Um5fRE1BX0NSX0xJTkVfVlNUUklERShwbGFuZV9pZCksCisJCQkJICAgICAgKCh3aWR0aCkgKiBm
Yi0+Zm9ybWF0LT5jcHBbMF0pKTsKKworCQkJa21iX3dyaXRlX2xjZChrbWIsCisJCQkJICAgICAg
TENEX0xBWUVSbl9ETUFfQ1JfTElORV9XSURUSChwbGFuZV9pZCksCisJCQkJICAgICAgKCh3aWR0
aCkgKiBmYi0+Zm9ybWF0LT5jcHBbMF0pKTsKKworCQkJYWRkcltWX1BMQU5FXSA9IGRybV9mYl9j
bWFfZ2V0X2dlbV9hZGRyKGZiLAorCQkJCQkJCQlwbGFuZS0+c3RhdGUsCisJCQkJCQkJCVZfUExB
TkUpOworCisJCQkvKiBjaGVjayBpZiBDYi9DciBpcyBzd2FwcGVkKi8KKwkJCWlmICh2YWwgJiBM
Q0RfTEFZRVJfQ1JDQl9PUkRFUikKKwkJCQlrbWJfd3JpdGVfbGNkKGttYiwKKwkJCQkJICAgICAg
TENEX0xBWUVSbl9ETUFfU1RBUlRfQ0JfQURSKHBsYW5lX2lkKSwKKwkJCQkJICAgICAgYWRkcltW
X1BMQU5FXSk7CisJCQllbHNlCisJCQkJa21iX3dyaXRlX2xjZChrbWIsCisJCQkJCSAgICAgIExD
RF9MQVlFUm5fRE1BX1NUQVJUX0NSX0FEUihwbGFuZV9pZCksCisJCQkJCSAgICAgIGFkZHJbVl9Q
TEFORV0pOworCQl9CisJfQorCisJa21iX3dyaXRlX2xjZChrbWIsIExDRF9MQVlFUm5fV0lEVEgo
cGxhbmVfaWQpLCBzcmNfdyAtIDEpOworCWttYl93cml0ZV9sY2Qoa21iLCBMQ0RfTEFZRVJuX0hF
SUdIVChwbGFuZV9pZCksIHNyY19oIC0gMSk7CisJa21iX3dyaXRlX2xjZChrbWIsIExDRF9MQVlF
Um5fQ09MX1NUQVJUKHBsYW5lX2lkKSwgY3J0Y194KTsKKwlrbWJfd3JpdGVfbGNkKGttYiwgTENE
X0xBWUVSbl9ST1dfU1RBUlQocGxhbmVfaWQpLCBjcnRjX3kpOworCisJdmFsIHw9IExDRF9MQVlF
Ul9GSUZPXzEwMDsKKworCWlmICh2YWwgJiBMQ0RfTEFZRVJfUExBTkFSX1NUT1JBR0UpIHsKKwkJ
dmFsIHw9IExDRF9MQVlFUl9DU0NfRU47CisKKwkJLyogRW5hYmxlIENTQyBpZiBpbnB1dCBpcyBw
bGFuYXIgYW5kIG91dHB1dCBpcyBSR0IgKi8KKwkJY29uZmlnX2NzYyhrbWIsIHBsYW5lX2lkKTsK
Kwl9CisKKwlrbWJfd3JpdGVfbGNkKGttYiwgTENEX0xBWUVSbl9DRkcocGxhbmVfaWQpLCB2YWwp
OworCisJc3dpdGNoIChwbGFuZV9pZCkgeworCWNhc2UgTEFZRVJfMDoKKwkJY3RybCA9IExDRF9D
VFJMX1ZMMV9FTkFCTEU7CisJCWJyZWFrOworCWNhc2UgTEFZRVJfMToKKwkJY3RybCA9IExDRF9D
VFJMX1ZMMl9FTkFCTEU7CisJCWJyZWFrOworCWNhc2UgTEFZRVJfMjoKKwkJY3RybCA9IExDRF9D
VFJMX0dMMV9FTkFCTEU7CisJCWJyZWFrOworCWNhc2UgTEFZRVJfMzoKKwkJY3RybCA9IExDRF9D
VFJMX0dMMl9FTkFCTEU7CisJCWJyZWFrOworCX0KKworCWN0cmwgfD0gTENEX0NUUkxfUFJPR1JF
U1NJVkUgfCBMQ0RfQ1RSTF9USU1fR0VOX0VOQUJMRQorCSAgICB8IExDRF9DVFJMX0NPTlRJTlVP
VVMgfCBMQ0RfQ1RSTF9PVVRQVVRfRU5BQkxFRDsKKworCS8qIExDRCBpcyBjb25uZWN0ZWQgdG8g
TUlQSSBvbiBrbWIKKwkgKiBUaGVyZWZvcmUgdGhpcyBiaXQgaXMgcmVxdWlyZWQgZm9yIERTSSBU
eAorCSAqLworCWN0cmwgfD0gTENEX0NUUkxfVkhTWU5DX0lETEVfTFZMOworCisJa21iX3NldF9i
aXRtYXNrX2xjZChrbWIsIExDRF9DT05UUk9MLCBjdHJsKTsKKworCS8qIEZJWE1FIG5vIGRvYyBv
biBob3cgdG8gc2V0IG91dHB1dCBmb3JtYXQsdGhlc2UgdmFsdWVzIGFyZQorCSAqIHRha2VuIGZy
b20gdGhlIE15cmlhZHggdGVzdHMKKwkgKi8KKwlvdXRfZm9ybWF0IHw9IExDRF9PVVRGX0ZPUk1B
VF9SR0I4ODg7CisKKwkvKiBMZWF2ZSBSR0Igb3JkZXIsY29udmVyc2lvbiBtb2RlIGFuZCBjbGlw
IG1vZGUgdG8gZGVmYXVsdCAqLworCS8qIGRvIG5vdCBpbnRlcmxlYXZlIFJHQiBjaGFubmVscyBm
b3IgbWlwaSBUeCBjb21wYXRpYmlsaXR5ICovCisJb3V0X2Zvcm1hdCB8PSBMQ0RfT1VURl9NSVBJ
X1JHQl9NT0RFOworCWttYl93cml0ZV9sY2Qoa21iLCBMQ0RfT1VUX0ZPUk1BVF9DRkcsIG91dF9m
b3JtYXQpOworCisJZG1hX2NmZyA9IExDRF9ETUFfTEFZRVJfRU5BQkxFIHwgTENEX0RNQV9MQVlF
Ul9WU1RSSURFX0VOIHwKKwkgICAgTENEX0RNQV9MQVlFUl9DT05UX1VQREFURSB8IExDRF9ETUFf
TEFZRVJfQVhJX0JVUlNUXzE2OworCisJLyogRW5hYmxlIERNQSAqLworCWttYl93cml0ZV9sY2Qo
a21iLCBMQ0RfTEFZRVJuX0RNQV9DRkcocGxhbmVfaWQpLCBkbWFfY2ZnKTsKKwlkcm1fZGJnKCZr
bWItPmRybSwgImRtYV9jZmc9MHgleCBMQ0RfRE1BX0NGRz0weCV4XG4iLCBkbWFfY2ZnLAorCQlr
bWJfcmVhZF9sY2Qoa21iLCBMQ0RfTEFZRVJuX0RNQV9DRkcocGxhbmVfaWQpKSk7CisKKwlrbWJf
c2V0X2JpdG1hc2tfbGNkKGttYiwgTENEX0lOVF9DTEVBUiwgTENEX0lOVF9FT0YgfAorCQkJTENE
X0lOVF9ETUFfRVJSKTsKKwlrbWJfc2V0X2JpdG1hc2tfbGNkKGttYiwgTENEX0lOVF9FTkFCTEUs
IExDRF9JTlRfRU9GIHwKKwkJCUxDRF9JTlRfRE1BX0VSUik7Cit9CisKK3N0YXRpYyBjb25zdCBz
dHJ1Y3QgZHJtX3BsYW5lX2hlbHBlcl9mdW5jcyBrbWJfcGxhbmVfaGVscGVyX2Z1bmNzID0gewor
CS5hdG9taWNfY2hlY2sgPSBrbWJfcGxhbmVfYXRvbWljX2NoZWNrLAorCS5hdG9taWNfdXBkYXRl
ID0ga21iX3BsYW5lX2F0b21pY191cGRhdGUsCisJLmF0b21pY19kaXNhYmxlID0ga21iX3BsYW5l
X2F0b21pY19kaXNhYmxlCit9OworCit2b2lkIGttYl9wbGFuZV9kZXN0cm95KHN0cnVjdCBkcm1f
cGxhbmUgKnBsYW5lKQoreworCXN0cnVjdCBrbWJfcGxhbmUgKmttYl9wbGFuZSA9IHRvX2ttYl9w
bGFuZShwbGFuZSk7CisKKwlkcm1fcGxhbmVfY2xlYW51cChwbGFuZSk7CisJa2ZyZWUoa21iX3Bs
YW5lKTsKK30KKworc3RhdGljIHZvaWQga21iX2Rlc3Ryb3lfcGxhbmVfc3RhdGUoc3RydWN0IGRy
bV9wbGFuZSAqcGxhbmUsCisJCQkJICAgIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnN0YXRlKQor
eworCXN0cnVjdCBrbWJfcGxhbmVfc3RhdGUgKmttYl9zdGF0ZSA9IHRvX2ttYl9wbGFuZV9zdGF0
ZShzdGF0ZSk7CisKKwlfX2RybV9hdG9taWNfaGVscGVyX3BsYW5lX2Rlc3Ryb3lfc3RhdGUoc3Rh
dGUpOworCWtmcmVlKGttYl9zdGF0ZSk7Cit9CisKK3N0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKmtt
Yl9wbGFuZV9kdXBsaWNhdGVfc3RhdGUoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUpCit7CisJc3Ry
dWN0IGRybV9wbGFuZV9zdGF0ZSAqc3RhdGU7CisJc3RydWN0IGttYl9wbGFuZV9zdGF0ZSAqa21i
X3N0YXRlOworCisJa21iX3N0YXRlID0ga21lbWR1cChwbGFuZS0+c3RhdGUsIHNpemVvZigqa21i
X3N0YXRlKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFrbWJfc3RhdGUpCisJCXJldHVybiBOVUxMOwor
CisJc3RhdGUgPSAma21iX3N0YXRlLT5iYXNlX3BsYW5lX3N0YXRlOworCV9fZHJtX2F0b21pY19o
ZWxwZXJfcGxhbmVfZHVwbGljYXRlX3N0YXRlKHBsYW5lLCBzdGF0ZSk7CisKKwlyZXR1cm4gc3Rh
dGU7Cit9CisKK3N0YXRpYyB2b2lkIGttYl9wbGFuZV9yZXNldChzdHJ1Y3QgZHJtX3BsYW5lICpw
bGFuZSkKK3sKKwlzdHJ1Y3Qga21iX3BsYW5lX3N0YXRlICprbWJfc3RhdGUgPSB0b19rbWJfcGxh
bmVfc3RhdGUocGxhbmUtPnN0YXRlKTsKKworCWlmIChrbWJfc3RhdGUpCisJCV9fZHJtX2F0b21p
Y19oZWxwZXJfcGxhbmVfZGVzdHJveV9zdGF0ZQorCQkgICAgKCZrbWJfc3RhdGUtPmJhc2VfcGxh
bmVfc3RhdGUpOworCWtmcmVlKGttYl9zdGF0ZSk7CisKKwlwbGFuZS0+c3RhdGUgPSBOVUxMOwor
CWttYl9zdGF0ZSA9IGt6YWxsb2Moc2l6ZW9mKCprbWJfc3RhdGUpLCBHRlBfS0VSTkVMKTsKKwlp
ZiAoa21iX3N0YXRlKSB7CisJCWttYl9zdGF0ZS0+YmFzZV9wbGFuZV9zdGF0ZS5wbGFuZSA9IHBs
YW5lOworCQlrbWJfc3RhdGUtPmJhc2VfcGxhbmVfc3RhdGUucm90YXRpb24gPSBEUk1fTU9ERV9S
T1RBVEVfMDsKKwkJcGxhbmUtPnN0YXRlID0gJmttYl9zdGF0ZS0+YmFzZV9wbGFuZV9zdGF0ZTsK
KwkJa21iX3N0YXRlLT5ub19wbGFuZXMgPSBLTUJfTUFYX1BMQU5FUzsKKwl9Cit9CisKK3N0YXRp
YyBjb25zdCBzdHJ1Y3QgZHJtX3BsYW5lX2Z1bmNzIGttYl9wbGFuZV9mdW5jcyA9IHsKKwkudXBk
YXRlX3BsYW5lID0gZHJtX2F0b21pY19oZWxwZXJfdXBkYXRlX3BsYW5lLAorCS5kaXNhYmxlX3Bs
YW5lID0gZHJtX2F0b21pY19oZWxwZXJfZGlzYWJsZV9wbGFuZSwKKwkuZGVzdHJveSA9IGttYl9w
bGFuZV9kZXN0cm95LAorCS5yZXNldCA9IGttYl9wbGFuZV9yZXNldCwKKwkuYXRvbWljX2R1cGxp
Y2F0ZV9zdGF0ZSA9IGttYl9wbGFuZV9kdXBsaWNhdGVfc3RhdGUsCisJLmF0b21pY19kZXN0cm95
X3N0YXRlID0ga21iX2Rlc3Ryb3lfcGxhbmVfc3RhdGUsCit9OworCitzdHJ1Y3Qga21iX3BsYW5l
ICprbWJfcGxhbmVfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZHJtKQoreworCXN0cnVjdCBrbWJf
ZHJtX3ByaXZhdGUgKmxjZCA9IHRvX2ttYihkcm0pOworCXN0cnVjdCBrbWJfcGxhbmUgKnBsYW5l
ID0gTlVMTDsKKwlzdHJ1Y3Qga21iX3BsYW5lICpwcmltYXJ5ID0gTlVMTDsKKwlpbnQgaSA9IDA7
CisJaW50IHJldCA9IDA7CisJZW51bSBkcm1fcGxhbmVfdHlwZSBwbGFuZV90eXBlOworCWNvbnN0
IHUzMiAqcGxhbmVfZm9ybWF0czsKKwlpbnQgbnVtX3BsYW5lX2Zvcm1hdHM7CisKKwlmb3IgKGkg
PSAwOyBpIDwgbGNkLT5uX2xheWVyczsgaSsrKSB7CisJCXBsYW5lID0gZHJtbV9remFsbG9jKGRy
bSwgc2l6ZW9mKCpwbGFuZSksIEdGUF9LRVJORUwpOworCisJCWlmICghcGxhbmUpIHsKKwkJCWRy
bV9lcnIoZHJtLCAiRmFpbGVkIHRvIGFsbG9jYXRlIHBsYW5lXG4iKTsKKwkJCXJldHVybiBFUlJf
UFRSKC1FTk9NRU0pOworCQl9CisKKwkJcGxhbmVfdHlwZSA9IChpID09IDApID8gRFJNX1BMQU5F
X1RZUEVfUFJJTUFSWSA6CisJCSAgICBEUk1fUExBTkVfVFlQRV9PVkVSTEFZOworCQlpZiAoaSA8
IDIpIHsKKwkJCXBsYW5lX2Zvcm1hdHMgPSBrbWJfZm9ybWF0c192OworCQkJbnVtX3BsYW5lX2Zv
cm1hdHMgPSBBUlJBWV9TSVpFKGttYl9mb3JtYXRzX3YpOworCQl9IGVsc2UgeworCQkJcGxhbmVf
Zm9ybWF0cyA9IGttYl9mb3JtYXRzX2c7CisJCQludW1fcGxhbmVfZm9ybWF0cyA9IEFSUkFZX1NJ
WkUoa21iX2Zvcm1hdHNfZyk7CisJCX0KKworCQlyZXQgPSBkcm1fdW5pdmVyc2FsX3BsYW5lX2lu
aXQoZHJtLCAmcGxhbmUtPmJhc2VfcGxhbmUsCisJCQkJCSAgICAgICBQT1NTSUJMRV9DUlRDUywg
JmttYl9wbGFuZV9mdW5jcywKKwkJCQkJICAgICAgIHBsYW5lX2Zvcm1hdHMsIG51bV9wbGFuZV9m
b3JtYXRzLAorCQkJCQkgICAgICAgTlVMTCwgcGxhbmVfdHlwZSwgInBsYW5lICVkIiwgaSk7CisJ
CWlmIChyZXQgPCAwKSB7CisJCQlkcm1fZXJyKGRybSwgImRybV91bml2ZXJzYWxfcGxhbmVfaW5p
dCBmYWlsZWQgKHJldD0lZCkiLAorCQkJCXJldCk7CisJCQlnb3RvIGNsZWFudXA7CisJCX0KKwkJ
ZHJtX2RiZyhkcm0sICIlcyA6ICVkIGk9JWQgdHlwZT0lZCIsCisJCQlfX2Z1bmNfXywgX19MSU5F
X18sCisJCQkgIGksIHBsYW5lX3R5cGUpOworCQlkcm1fcGxhbmVfaGVscGVyX2FkZCgmcGxhbmUt
PmJhc2VfcGxhbmUsCisJCQkJICAgICAma21iX3BsYW5lX2hlbHBlcl9mdW5jcyk7CisJCWlmIChw
bGFuZV90eXBlID09IERSTV9QTEFORV9UWVBFX1BSSU1BUlkpIHsKKwkJCXByaW1hcnkgPSBwbGFu
ZTsKKwkJCWxjZC0+cGxhbmUgPSBwbGFuZTsKKwkJfQorCQlkcm1fZGJnKGRybSwgIiVzIDogJWQg
cHJpbWFyeT0lcFxuIiwgX19mdW5jX18sIF9fTElORV9fLAorCQkJJnByaW1hcnktPmJhc2VfcGxh
bmUpOworCQlwbGFuZS0+aWQgPSBpOworCX0KKworCXJldHVybiBwcmltYXJ5OworY2xlYW51cDoK
KwlrZnJlZShwbGFuZSk7CisJcmV0dXJuIEVSUl9QVFIocmV0KTsKK30KZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9rbWIva21iX3BsYW5lLmggYi9kcml2ZXJzL2dwdS9kcm0va21iL2ttYl9w
bGFuZS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjQ4ZjIzN2YKLS0tIC9k
ZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0va21iL2ttYl9wbGFuZS5oCkBAIC0wLDAgKzEs
MTI0IEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5CisgKgorICog
Q29weXJpZ2h0IMKpIDIwMTgtMjAyMCBJbnRlbCBDb3Jwb3JhdGlvbgorICovCisKKyNpZm5kZWYg
X19LTUJfUExBTkVfSF9fCisjZGVmaW5lIF9fS01CX1BMQU5FX0hfXworCisjaW5jbHVkZSAia21i
X2Rydi5oIgorCitleHRlcm4gaW50IGttYl91bmRlcl9mbG93OworZXh0ZXJuIGludCBrbWJfZmx1
c2hfZG9uZTsKKworI2RlZmluZSBMQ0RfSU5UX1ZMMF9FUlIgKChMQVlFUjBfRE1BX0ZJRk9fVU5E
RVJGTE9XKSB8IFwKKwkJCShMQVlFUjBfRE1BX0ZJRk9fT1ZFUkZMT1cpIHwgXAorCQkJKExBWUVS
MF9ETUFfQ0JfRklGT19PVkVSRkxPVykgfCBcCisJCQkoTEFZRVIwX0RNQV9DQl9GSUZPX1VOREVS
RkxPVykgfCBcCisJCQkoTEFZRVIwX0RNQV9DUl9GSUZPX09WRVJGTE9XKSB8IFwKKwkJCShMQVlF
UjBfRE1BX0NSX0ZJRk9fVU5ERVJGTE9XKSkKKworI2RlZmluZSBMQ0RfSU5UX1ZMMV9FUlIgKChM
QVlFUjFfRE1BX0ZJRk9fVU5ERVJGTE9XKSB8IFwKKwkJCShMQVlFUjFfRE1BX0ZJRk9fT1ZFUkZM
T1cpIHwgXAorCQkJKExBWUVSMV9ETUFfQ0JfRklGT19PVkVSRkxPVykgfCBcCisJCQkoTEFZRVIx
X0RNQV9DQl9GSUZPX1VOREVSRkxPVykgfCBcCisJCQkoTEFZRVIxX0RNQV9DUl9GSUZPX09WRVJG
TE9XKSB8IFwKKwkJCShMQVlFUjFfRE1BX0NSX0ZJRk9fVU5ERVJGTE9XKSkKKworI2RlZmluZSBM
Q0RfSU5UX0dMMF9FUlIgKExBWUVSMl9ETUFfRklGT19PVkVSRkxPVyB8IExBWUVSMl9ETUFfRklG
T19VTkRFUkZMT1cpCisjZGVmaW5lIExDRF9JTlRfR0wxX0VSUiAoTEFZRVIzX0RNQV9GSUZPX09W
RVJGTE9XIHwgTEFZRVIzX0RNQV9GSUZPX1VOREVSRkxPVykKKyNkZWZpbmUgTENEX0lOVF9WTDAg
KExBWUVSMF9ETUFfRE9ORSB8IExBWUVSMF9ETUFfSURMRSB8IExDRF9JTlRfVkwwX0VSUikKKyNk
ZWZpbmUgTENEX0lOVF9WTDEgKExBWUVSMV9ETUFfRE9ORSB8IExBWUVSMV9ETUFfSURMRSB8IExD
RF9JTlRfVkwxX0VSUikKKyNkZWZpbmUgTENEX0lOVF9HTDAgKExBWUVSMl9ETUFfRE9ORSB8IExB
WUVSMl9ETUFfSURMRSB8IExDRF9JTlRfR0wwX0VSUikKKyNkZWZpbmUgTENEX0lOVF9HTDEgKExB
WUVSM19ETUFfRE9ORSB8IExBWUVSM19ETUFfSURMRSB8IExDRF9JTlRfR0wxX0VSUikKKyNkZWZp
bmUgTENEX0lOVF9ETUFfRVJSIChMQ0RfSU5UX1ZMMF9FUlIgfCBMQ0RfSU5UX1ZMMV9FUlIgXAor
CQl8IExDRF9JTlRfR0wwX0VSUiB8IExDRF9JTlRfR0wxX0VSUikKKworI2RlZmluZSBQT1NTSUJM
RV9DUlRDUyAxCisjZGVmaW5lIElOSVRJQUxJWkVEIDEKKyNkZWZpbmUgdG9fa21iX3BsYW5lKHgp
IGNvbnRhaW5lcl9vZih4LCBzdHJ1Y3Qga21iX3BsYW5lLCBiYXNlX3BsYW5lKQorCisjZGVmaW5l
IHRvX2ttYl9wbGFuZV9zdGF0ZSh4KSBcCisJCWNvbnRhaW5lcl9vZih4LCBzdHJ1Y3Qga21iX3Bs
YW5lX3N0YXRlLCBiYXNlX3BsYW5lX3N0YXRlKQorCitlbnVtIGxheWVyX2lkIHsKKwlMQVlFUl8w
LAorCUxBWUVSXzEsCisJTEFZRVJfMiwKKwlMQVlFUl8zLAorLy8JS01CX01BWF9QTEFORVMsCit9
OworCisjZGVmaW5lIEtNQl9NQVhfUExBTkVTIDEKKworZW51bSBzdWJfcGxhbmVfaWQgeworCVlf
UExBTkUsCisJVV9QTEFORSwKKwlWX1BMQU5FLAorCU1BWF9TVUJfUExBTkVTLAorfTsKKworc3Ry
dWN0IGttYl9wbGFuZSB7CisJc3RydWN0IGRybV9wbGFuZSBiYXNlX3BsYW5lOworCXN0cnVjdCBr
bWJfZHJtX3ByaXZhdGUga21iX2RldjsKKwl1bnNpZ25lZCBjaGFyIGlkOworfTsKKworc3RydWN0
IGttYl9wbGFuZV9zdGF0ZSB7CisJc3RydWN0IGRybV9wbGFuZV9zdGF0ZSBiYXNlX3BsYW5lX3N0
YXRlOworCXVuc2lnbmVkIGNoYXIgbm9fcGxhbmVzOworfTsKKworLyogR3JhcGhpY3MgbGF5ZXIg
KGxheWVycyAyICYgMykgZm9ybWF0cywgb25seSBwYWNrZWQgZm9ybWF0cyAgYXJlIHN1cHBvcnRl
ZCAqLworc3RhdGljIGNvbnN0IHUzMiBrbWJfZm9ybWF0c19nW10gPSB7CisJRFJNX0ZPUk1BVF9S
R0IzMzIsCisJRFJNX0ZPUk1BVF9YUkdCNDQ0NCwgRFJNX0ZPUk1BVF9YQkdSNDQ0NCwKKwlEUk1f
Rk9STUFUX0FSR0I0NDQ0LCBEUk1fRk9STUFUX0FCR1I0NDQ0LAorCURSTV9GT1JNQVRfWFJHQjE1
NTUsIERSTV9GT1JNQVRfWEJHUjE1NTUsCisJRFJNX0ZPUk1BVF9BUkdCMTU1NSwgRFJNX0ZPUk1B
VF9BQkdSMTU1NSwKKwlEUk1fRk9STUFUX1JHQjU2NSwgRFJNX0ZPUk1BVF9CR1I1NjUsCisJRFJN
X0ZPUk1BVF9SR0I4ODgsIERSTV9GT1JNQVRfQkdSODg4LAorCURSTV9GT1JNQVRfWFJHQjg4ODgs
IERSTV9GT1JNQVRfWEJHUjg4ODgsCisJRFJNX0ZPUk1BVF9BUkdCODg4OCwgRFJNX0ZPUk1BVF9B
QkdSODg4OCwKK307CisKKyNkZWZpbmUgTUFYX0ZPUk1BVF9HCShBUlJBWV9TSVpFKGttYl9mb3Jt
YXRzX2cpKQorI2RlZmluZSBNQVhfRk9STUFUX1YJKEFSUkFZX1NJWkUoa21iX2Zvcm1hdHNfdikp
CisKKy8qIFZpZGVvIGxheWVyICggMCAmIDEpIGZvcm1hdHMsIHBhY2tlZCBhbmQgcGxhbmFyIGZv
cm1hdHMgYXJlIHN1cHBvcnRlZCAqLworc3RhdGljIGNvbnN0IHUzMiBrbWJfZm9ybWF0c192W10g
PSB7CisJLyogcGFja2VkIGZvcm1hdHMgKi8KKwlEUk1fRk9STUFUX1JHQjMzMiwKKwlEUk1fRk9S
TUFUX1hSR0I0NDQ0LCBEUk1fRk9STUFUX1hCR1I0NDQ0LAorCURSTV9GT1JNQVRfQVJHQjQ0NDQs
IERSTV9GT1JNQVRfQUJHUjQ0NDQsCisJRFJNX0ZPUk1BVF9YUkdCMTU1NSwgRFJNX0ZPUk1BVF9Y
QkdSMTU1NSwKKwlEUk1fRk9STUFUX0FSR0IxNTU1LCBEUk1fRk9STUFUX0FCR1IxNTU1LAorCURS
TV9GT1JNQVRfUkdCNTY1LCBEUk1fRk9STUFUX0JHUjU2NSwKKwlEUk1fRk9STUFUX1JHQjg4OCwg
RFJNX0ZPUk1BVF9CR1I4ODgsCisJRFJNX0ZPUk1BVF9YUkdCODg4OCwgRFJNX0ZPUk1BVF9YQkdS
ODg4OCwKKwlEUk1fRk9STUFUX0FSR0I4ODg4LCBEUk1fRk9STUFUX0FCR1I4ODg4LAorCS8qcGxh
bmFyIGZvcm1hdHMgKi8KKwlEUk1fRk9STUFUX1lVVjQyMCwgRFJNX0ZPUk1BVF9ZVlU0MjAsCisJ
RFJNX0ZPUk1BVF9ZVVY0MjIsIERSTV9GT1JNQVRfWVZVNDIyLAorCURSTV9GT1JNQVRfWVVWNDQ0
LCBEUk1fRk9STUFUX1lWVTQ0NCwKKwlEUk1fRk9STUFUX05WMTIsIERSTV9GT1JNQVRfTlYyMSwK
K307CisKKy8qIENvbnZlcnNpb24gKHl1di0+cmdiKSBtYXRyaXggZnJvbSBteXJpYWR4ICovCitz
dGF0aWMgY29uc3QgdTMyIGNzY19jb2VmX2xjZFtdID0geworCTEwMjQsIDAsIDE0MzYsCisJMTAy
NCwgLTM1MiwgLTczMSwKKwkxMDI0LCAxODE0LCAwLAorCS0xNzksIDEyNSwgLTIyNgorfTsKKwor
c3RydWN0IGxheWVyX3N0YXR1cyB7CisJYm9vbCBkaXNhYmxlOworCXUzMiBjdHJsOworfTsKKwor
ZXh0ZXJuIHN0cnVjdCBsYXllcl9zdGF0dXMgcGxhbmVfc3RhdHVzW0tNQl9NQVhfUExBTkVTXTsK
Kworc3RydWN0IGttYl9wbGFuZSAqa21iX3BsYW5lX2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRy
bSk7Cit2b2lkIGttYl9wbGFuZV9kZXN0cm95KHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lKTsKKyNl
bmRpZiAvKiBfX0tNQl9QTEFORV9IX18gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9r
bWIva21iX3JlZ3MuaCBiL2RyaXZlcnMvZ3B1L2RybS9rbWIva21iX3JlZ3MuaApuZXcgZmlsZSBt
b2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi5mNzk0YWMzCi0tLSAvZGV2L251bGwKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2ttYi9rbWJfcmVncy5oCkBAIC0wLDAgKzEsNzQ4IEBACisvKiBTUERYLUxp
Y2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5CisgKgorICogQ29weXJpZ2h0IMKpIDIwMTgt
MjAyMCBJbnRlbCBDb3Jwb3JhdGlvbgorICovCisKKyNpZm5kZWYgX19LTUJfUkVHU19IX18KKyNk
ZWZpbmUgX19LTUJfUkVHU19IX18KKworI2RlZmluZSBFTkFCTEUJCQkJCSAxCisjZGVmaW5lIERJ
U0FCTEUJCQkJCSAwCisvKmZyb20gRGF0YSBCb29rIHNlY3Rpb24gMTIuNS44LjEgcGFnZSA0MzIy
ICovCisjZGVmaW5lIENQUl9CQVNFX0FERFIgICAgICAgICAgICAgICAgICAgICAgICAgICAoMHgy
MDgxMDAwMCkKKyNkZWZpbmUgTUlQSV9CQVNFX0FERFIgICAgICAgICAgICAgICAgICAgICAgICAg
ICgweDIwOTAwMDAwKQorLypmcm9tIERhdGEgQm9vayBzZWN0aW9uIDEyLjExLjYuMSBwYWdlIDQ5
NzIgKi8KKyNkZWZpbmUgTENEX0JBU0VfQUREUiAgICAgICAgICAgICAgICAgICAgICAgICAgICgw
eDIwOTMwMDAwKQorI2RlZmluZSBNU1NfQ0FNX0JBU0VfQUREUgkJCShNSVBJX0JBU0VfQUREUiAr
IDB4MTAwMDApCisjZGVmaW5lIExDRF9NTUlPX1NJWkUJCQkJKDB4MzAwMCkKKyNkZWZpbmUgTUlQ
SV9NTUlPX1NJWkUJCQkJKDB4NDAwMCkKKyNkZWZpbmUgTVNTX0NBTV9NTUlPX1NJWkUJCQkoMHgz
MCkKKworLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKgorICoJCSAgIExDRCBjb250cm9sbGVyIGNvbnRyb2wg
cmVnaXN0ZXIgZGVmaW5lcworICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KKyNkZWZpbmUgTENEX0NPTlRS
T0wJCQkJKDB4NCAqIDB4MDAwKQorI2RlZmluZSBMQ0RfQ1RSTF9QUk9HUkVTU0lWRQkJCSAgKDAg
PDwgMCkKKyNkZWZpbmUgTENEX0NUUkxfSU5URVJMQUNFRAkJCSAgQklUKDApCisjZGVmaW5lIExD
RF9DVFJMX0VOQUJMRQkJCQkgIEJJVCgxKQorI2RlZmluZSBMQ0RfQ1RSTF9WTDFfRU5BQkxFCQkJ
ICBCSVQoMikKKyNkZWZpbmUgTENEX0NUUkxfVkwyX0VOQUJMRQkJCSAgQklUKDMpCisjZGVmaW5l
IExDRF9DVFJMX0dMMV9FTkFCTEUJCQkgIEJJVCg0KQorI2RlZmluZSBMQ0RfQ1RSTF9HTDJfRU5B
QkxFCQkJICBCSVQoNSkKKyNkZWZpbmUgTENEX0NUUkxfQUxQSEFfQkxFTkRfVkwxCQkgICgwIDw8
IDYpCisjZGVmaW5lIExDRF9DVFJMX0FMUEhBX0JMRU5EX1ZMMgkJICBCSVQoNikKKyNkZWZpbmUg
TENEX0NUUkxfQUxQSEFfQkxFTkRfR0wxCQkgICgyIDw8IDYpCisjZGVmaW5lIExDRF9DVFJMX0FM
UEhBX0JMRU5EX0dMMgkJICAoMyA8PCA2KQorI2RlZmluZSBMQ0RfQ1RSTF9BTFBIQV9UT1BfVkwx
CQkJICAoMCA8PCA4KQorI2RlZmluZSBMQ0RfQ1RSTF9BTFBIQV9UT1BfVkwyCQkJICBCSVQoOCkK
KyNkZWZpbmUgTENEX0NUUkxfQUxQSEFfVE9QX0dMMQkJCSAgKDIgPDwgOCkKKyNkZWZpbmUgTENE
X0NUUkxfQUxQSEFfVE9QX0dMMgkJCSAgKDMgPDwgOCkKKyNkZWZpbmUgTENEX0NUUkxfQUxQSEFf
TUlERExFX1ZMMQkJICAoMCA8PCAxMCkKKyNkZWZpbmUgTENEX0NUUkxfQUxQSEFfTUlERExFX1ZM
MgkJICBCSVQoMTApCisjZGVmaW5lIExDRF9DVFJMX0FMUEhBX01JRERMRV9HTDEJCSAgKDIgPDwg
MTApCisjZGVmaW5lIExDRF9DVFJMX0FMUEhBX01JRERMRV9HTDIJCSAgKDMgPDwgMTApCisjZGVm
aW5lIExDRF9DVFJMX0FMUEhBX0JPVFRPTV9WTDEJCSAgKDAgPDwgMTIpCisjZGVmaW5lIExDRF9D
VFJMX0FMUEhBX0JPVFRPTV9WTDIJCSAgQklUKDEyKQorI2RlZmluZSBMQ0RfQ1RSTF9BTFBIQV9C
T1RUT01fR0wxCQkgICgyIDw8IDEyKQorI2RlZmluZSBMQ0RfQ1RSTF9BTFBIQV9CT1RUT01fR0wy
CQkgICgzIDw8IDEyKQorI2RlZmluZSBMQ0RfQ1RSTF9USU1fR0VOX0VOQUJMRQkJCSAgQklUKDE0
KQorI2RlZmluZSBMQ0RfQ1RSTF9DT05USU5VT1VTCQkJICAoMCA8PCAxNSkKKyNkZWZpbmUgTENE
X0NUUkxfT05FX1NIT1QJCQkgIEJJVCgxNSkKKyNkZWZpbmUgTENEX0NUUkxfUFdNMF9FTgkJCSAg
QklUKDE2KQorI2RlZmluZSBMQ0RfQ1RSTF9QV00xX0VOCQkJICBCSVQoMTcpCisjZGVmaW5lIExD
RF9DVFJMX1BXTTJfRU4JCQkgIEJJVCgxOCkKKyNkZWZpbmUgTENEX0NUUkxfT1VUUFVUX0RJU0FC
TEVECQkgICgwIDw8IDE5KQorI2RlZmluZSBMQ0RfQ1RSTF9PVVRQVVRfRU5BQkxFRAkJCSAgQklU
KDE5KQorI2RlZmluZSBMQ0RfQ1RSTF9CUE9SQ0hfRU5BQkxFCQkJICBCSVQoMjEpCisjZGVmaW5l
IExDRF9DVFJMX0ZQT1JDSF9FTkFCTEUJCQkgIEJJVCgyMikKKyNkZWZpbmUgTENEX0NUUkxfUElQ
RUxJTkVfRE1BCQkJICBCSVQoMjgpCisjZGVmaW5lIExDRF9DVFJMX1ZIU1lOQ19JRExFX0xWTAkJ
ICBCSVQoMzEpCisKKy8qaW50ZXJydXB0cyAqLworI2RlZmluZSBMQ0RfSU5UX1NUQVRVUwkJCQko
MHg0ICogMHgwMDEpCisjZGVmaW5lIExDRF9JTlRfRU9GCQkJCSAgQklUKDApCisjZGVmaW5lIExD
RF9JTlRfTElORV9DTVAJCQkgIEJJVCgxKQorI2RlZmluZSBMQ0RfSU5UX1ZFUlRfQ09NUAkJCSAg
QklUKDIpCisjZGVmaW5lIExBWUVSMF9ETUFfRE9ORQkJCQkgIEJJVCgzKQorI2RlZmluZSBMQVlF
UjBfRE1BX0lETEUJCQkJICBCSVQoNCkKKyNkZWZpbmUgTEFZRVIwX0RNQV9GSUZPX09WRVJGTE9X
CQkgIEJJVCg1KQorI2RlZmluZSBMQVlFUjBfRE1BX0ZJRk9fVU5ERVJGTE9XCQkgIEJJVCg2KQor
I2RlZmluZSBMQVlFUjBfRE1BX0NCX0ZJRk9fT1ZFUkZMT1cJCSAgQklUKDcpCisjZGVmaW5lIExB
WUVSMF9ETUFfQ0JfRklGT19VTkRFUkZMT1cJCSAgQklUKDgpCisjZGVmaW5lIExBWUVSMF9ETUFf
Q1JfRklGT19PVkVSRkxPVwkJICBCSVQoOSkKKyNkZWZpbmUgTEFZRVIwX0RNQV9DUl9GSUZPX1VO
REVSRkxPVwkJICBCSVQoMTApCisjZGVmaW5lIExBWUVSMV9ETUFfRE9ORQkJCQkgIEJJVCgxMSkK
KyNkZWZpbmUgTEFZRVIxX0RNQV9JRExFCQkJCSAgQklUKDEyKQorI2RlZmluZSBMQVlFUjFfRE1B
X0ZJRk9fT1ZFUkZMT1cJCSAgQklUKDEzKQorI2RlZmluZSBMQVlFUjFfRE1BX0ZJRk9fVU5ERVJG
TE9XCQkgIEJJVCgxNCkKKyNkZWZpbmUgTEFZRVIxX0RNQV9DQl9GSUZPX09WRVJGTE9XCQkgIEJJ
VCgxNSkKKyNkZWZpbmUgTEFZRVIxX0RNQV9DQl9GSUZPX1VOREVSRkxPVwkJICBCSVQoMTYpCisj
ZGVmaW5lIExBWUVSMV9ETUFfQ1JfRklGT19PVkVSRkxPVwkJICBCSVQoMTcpCisjZGVmaW5lIExB
WUVSMV9ETUFfQ1JfRklGT19VTkRFUkZMT1cJCSAgQklUKDE4KQorI2RlZmluZSBMQVlFUjJfRE1B
X0RPTkUJCQkJICBCSVQoMTkpCisjZGVmaW5lIExBWUVSMl9ETUFfSURMRQkJCQkgIEJJVCgyMCkK
KyNkZWZpbmUgTEFZRVIyX0RNQV9GSUZPX09WRVJGTE9XCQkgIEJJVCgyMSkKKyNkZWZpbmUgTEFZ
RVIyX0RNQV9GSUZPX1VOREVSRkxPVwkJICBCSVQoMjIpCisjZGVmaW5lIExBWUVSM19ETUFfRE9O
RQkJCQkgIEJJVCgyMykKKyNkZWZpbmUgTEFZRVIzX0RNQV9JRExFCQkJCSAgQklUKDI0KQorI2Rl
ZmluZSBMQVlFUjNfRE1BX0ZJRk9fT1ZFUkZMT1cJCSAgQklUKDI1KQorI2RlZmluZSBMQVlFUjNf
RE1BX0ZJRk9fVU5ERVJGTE9XCQkgIEJJVCgyNikKKyNkZWZpbmUgTENEX0lOVF9MQVlFUgkJCQkg
ICgweDA3ZmZmZmY4KQorI2RlZmluZSBMQ0RfSU5UX0VOQUJMRQkJCQkoMHg0ICogMHgwMDIpCisj
ZGVmaW5lIExDRF9JTlRfQ0xFQVIJCQkJKDB4NCAqIDB4MDAzKQorI2RlZmluZSBMQ0RfTElORV9D
T1VOVAkJCQkoMHg0ICogMHgwMDQpCisjZGVmaW5lIExDRF9MSU5FX0NPTVBBUkUJCQkoMHg0ICog
MHgwMDUpCisjZGVmaW5lIExDRF9WU1RBVFVTCQkJCSgweDQgKiAweDAwNikKKworLypMQ0RfVlNU
QVRVU19DT01QQVJFIFZlcnRjYWwgaW50ZXJ2YWwgaW4gd2hpY2ggdG8gZ2VuZXJhdGUgdmVydGNh
bAorICogaW50ZXJ2YWwgaW50ZXJydXB0CisgKi8KKy8qIEJJVFMgMTMgYW5kIDE0ICovCisjZGVm
aW5lIExDRF9WU1RBVFVTX0NPTVBBUkUJCQkoMHg0ICogMHgwMDcpCisjZGVmaW5lIExDRF9WU1RB
VFVTX1ZFUlRJQ0FMX1NUQVRVU19NQVNLCSAgKDMgPDwgMTMpCisjZGVmaW5lIExDRF9WU1RBVFVT
X0NPTVBBUkVfVlNZTkMJCSAgKDAgPDwgMTMpCisjZGVmaW5lIExDRF9WU1RBVFVTX0NPTVBBUkVf
QkFDS1BPUkNICQkgIEJJVCgxMykKKyNkZWZpbmUgTENEX1ZTVEFUVVNfQ09NUEFSRV9BQ1RJVkUJ
CSAgKDIgPDwgMTMpCisjZGVmaW5lIExDRF9WU1RBVFVTX0NPTVBBUkVfRlJPTlRfUE9SQ0gJCSAg
KDMgPDwgMTMpCisKKyNkZWZpbmUgTENEX1NDUkVFTl9XSURUSAkJCSgweDQgKiAweDAwOCkKKyNk
ZWZpbmUgTENEX1NDUkVFTl9IRUlHSFQJCQkoMHg0ICogMHgwMDkpCisjZGVmaW5lIExDRF9GSUVM
RF9JTlRfQ0ZHCQkJKDB4NCAqIDB4MDBhKQorI2RlZmluZSBMQ0RfRklGT19GTFVTSAkJCQkoMHg0
ICogMHgwMGIpCisjZGVmaW5lIExDRF9CR19DT0xPVVJfTFMJCQkoMHg0ICogMHgwMGMpCisjZGVm
aW5lIExDRF9CR19DT0xPVVJfTVMJCQkoMHg0ICogMHgwMGQpCisjZGVmaW5lIExDRF9SQU1fQ0ZH
CQkJICAgICAgICAoMHg0ICogMHgwMGUpCisKKy8qKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCisgKgkJICAg
TENEIGNvbnRyb2xsZXIgTGF5ZXIgY29uZmlnIHJlZ2lzdGVyCisgKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KgorICovCisjZGVmaW5lIExDRF9MQVlFUjBfQ0ZHCQkgICAgICAgICgweDQgKiAweDEwMCkKKyNk
ZWZpbmUgTENEX0xBWUVSbl9DRkcoTikJCQkoTENEX0xBWUVSMF9DRkcgKyAoMHg0MDAgKiAoTikp
KQorI2RlZmluZSBMQ0RfTEFZRVJfU0NBTEVfSAkJCUJJVCgxKQorI2RlZmluZSBMQ0RfTEFZRVJf
U0NBTEVfVgkJCUJJVCgyKQorI2RlZmluZSBMQ0RfTEFZRVJfU0NBTEVfSF9WCQkJKExDRF9MQVlF
Ul9TQ0FMRV9IIHwgXAorCQkJCQkJICAgICAgTENEX0xBWUVSX1NDQUxFX1YpCisjZGVmaW5lIExD
RF9MQVlFUl9DU0NfRU4JCQlCSVQoMykKKyNkZWZpbmUgTENEX0xBWUVSX0FMUEhBX1NUQVRJQwkJ
CUJJVCg0KQorI2RlZmluZSBMQ0RfTEFZRVJfQUxQSEFfRU1CRUQJCQlCSVQoNSkKKyNkZWZpbmUg
TENEX0xBWUVSX0FMUEhBX0NPTUJJCQkJKExDRF9MQVlFUl9BTFBIQV9TVEFUSUMgfCBcCisJCQkJ
CQkgICAgICBMQ0RfTEFZRVJfQUxQSEFfRU1CRUQpCisvKiBSR0IgbXVsdGlwbGllZCB3aXRoIGFs
cGhhICovCisjZGVmaW5lIExDRF9MQVlFUl9BTFBIQV9QUkVNVUxUCQkJQklUKDYpCisjZGVmaW5l
IExDRF9MQVlFUl9JTlZFUlRfQ09MCQkJQklUKDcpCisjZGVmaW5lIExDRF9MQVlFUl9UUkFOU1BB
UkVOVF9FTgkJQklUKDgpCisjZGVmaW5lIExDRF9MQVlFUl9GT1JNQVRfWUNCQ1I0NDRQTEFOCQko
MCA8PCA5KQorI2RlZmluZSBMQ0RfTEFZRVJfRk9STUFUX1lDQkNSNDIyUExBTgkJQklUKDkpCisj
ZGVmaW5lIExDRF9MQVlFUl9GT1JNQVRfWUNCQ1I0MjBQTEFOCQkoMiA8PCA5KQorI2RlZmluZSBM
Q0RfTEFZRVJfRk9STUFUX1JHQjg4OFBMQU4JCSgzIDw8IDkpCisjZGVmaW5lIExDRF9MQVlFUl9G
T1JNQVRfWUNCQ1I0NDRMSU4JCSg0IDw8IDkpCisjZGVmaW5lIExDRF9MQVlFUl9GT1JNQVRfWUNC
Q1I0MjJMSU4JCSg1IDw8IDkpCisjZGVmaW5lIExDRF9MQVlFUl9GT1JNQVRfUkdCODg4CQkJKDYg
PDwgOSkKKyNkZWZpbmUgTENEX0xBWUVSX0ZPUk1BVF9SR0JBODg4OAkJKDcgPDwgOSkKKyNkZWZp
bmUgTENEX0xBWUVSX0ZPUk1BVF9SR0JYODg4OAkJKDggPDwgOSkKKyNkZWZpbmUgTENEX0xBWUVS
X0ZPUk1BVF9SR0I1NjUJCQkoOSA8PCA5KQorI2RlZmluZSBMQ0RfTEFZRVJfRk9STUFUX1JHQkEx
NTU1CQkoMHhhIDw8IDkpCisjZGVmaW5lIExDRF9MQVlFUl9GT1JNQVRfWFJHQjE1NTUJCSgweGIg
PDwgOSkKKyNkZWZpbmUgTENEX0xBWUVSX0ZPUk1BVF9SR0I0NDQJCQkoMHhjIDw8IDkpCisjZGVm
aW5lIExDRF9MQVlFUl9GT1JNQVRfUkdCQTQ0NDQJCSgweGQgPDwgOSkKKyNkZWZpbmUgTENEX0xB
WUVSX0ZPUk1BVF9SR0JYNDQ0NAkJKDB4ZSA8PCA5KQorI2RlZmluZSBMQ0RfTEFZRVJfRk9STUFU
X1JHQjMzMgkJCSgweGYgPDwgOSkKKyNkZWZpbmUgTENEX0xBWUVSX0ZPUk1BVF9SR0JBMzMyOAkJ
KDB4MTAgPDwgOSkKKyNkZWZpbmUgTENEX0xBWUVSX0ZPUk1BVF9SR0JYMzMyOAkJKDB4MTEgPDwg
OSkKKyNkZWZpbmUgTENEX0xBWUVSX0ZPUk1BVF9DTFVUCQkJKDB4MTIgPDwgOSkKKyNkZWZpbmUg
TENEX0xBWUVSX0ZPUk1BVF9OVjEyCQkJKDB4MWMgPDwgOSkKKyNkZWZpbmUgTENEX0xBWUVSX1BM
QU5BUl9TVE9SQUdFCQlCSVQoMTQpCisjZGVmaW5lIExDRF9MQVlFUl84QlBQCQkJCSgwIDw8IDE1
KQorI2RlZmluZSBMQ0RfTEFZRVJfMTZCUFAJCQkJQklUKDE1KQorI2RlZmluZSBMQ0RfTEFZRVJf
MjRCUFAJCQkJKDIgPDwgMTUpCisjZGVmaW5lIExDRF9MQVlFUl8zMkJQUAkJCQkoMyA8PCAxNSkK
KyNkZWZpbmUgTENEX0xBWUVSX1lfT1JERVIJCQlCSVQoMTcpCisjZGVmaW5lIExDRF9MQVlFUl9D
UkNCX09SREVSCQkJQklUKDE4KQorI2RlZmluZSBMQ0RfTEFZRVJfQkdSX09SREVSCQkJQklUKDE5
KQorI2RlZmluZSBMQ0RfTEFZRVJfTFVUXzJFTlQJCQkoMCA8PCAyMCkKKyNkZWZpbmUgTENEX0xB
WUVSX0xVVF80RU5UCQkJQklUKDIwKQorI2RlZmluZSBMQ0RfTEFZRVJfTFVUXzE2RU5UCQkJKDIg
PDwgMjApCisjZGVmaW5lIExDRF9MQVlFUl9OT19GTElQCQkJKDAgPDwgMjIpCisjZGVmaW5lIExD
RF9MQVlFUl9GTElQX1YJCQlCSVQoMjIpCisjZGVmaW5lIExDRF9MQVlFUl9GTElQX0gJCQkoMiA8
PCAyMikKKyNkZWZpbmUgTENEX0xBWUVSX1JPVF9SOTAJCQkoMyA8PCAyMikKKyNkZWZpbmUgTENE
X0xBWUVSX1JPVF9MOTAJCQkoNCA8PCAyMikKKyNkZWZpbmUgTENEX0xBWUVSX1JPVF8xODAJCQko
NSA8PCAyMikKKyNkZWZpbmUgTENEX0xBWUVSX0ZJRk9fMDAJCQkoMCA8PCAyNSkKKyNkZWZpbmUg
TENEX0xBWUVSX0ZJRk9fMjUJCQlCSVQoMjUpCisjZGVmaW5lIExDRF9MQVlFUl9GSUZPXzUwCQkJ
KDIgPDwgMjUpCisjZGVmaW5lIExDRF9MQVlFUl9GSUZPXzEwMAkJCSgzIDw8IDI1KQorI2RlZmlu
ZSBMQ0RfTEFZRVJfSU5URVJMRUFWRV9ESVMJCSgwIDw8IDI3KQorI2RlZmluZSBMQ0RfTEFZRVJf
SU5URVJMRUFWRV9WCQkJQklUKDI3KQorI2RlZmluZSBMQ0RfTEFZRVJfSU5URVJMRUFWRV9ICQkJ
KDIgPDwgMjcpCisjZGVmaW5lIExDRF9MQVlFUl9JTlRFUkxFQVZFX0NICQkJKDMgPDwgMjcpCisj
ZGVmaW5lIExDRF9MQVlFUl9JTlRFUkxFQVZFX1ZfU1VCCQkoNCA8PCAyNykKKyNkZWZpbmUgTENE
X0xBWUVSX0lOVEVSTEVBVkVfSF9TVUIJCSg1IDw8IDI3KQorI2RlZmluZSBMQ0RfTEFZRVJfSU5U
RVJMRUFWRV9DSF9TVUIJCSg2IDw8IDI3KQorI2RlZmluZSBMQ0RfTEFZRVJfSU5URVJfUE9TX0VW
RU4JCSgwIDw8IDMwKQorI2RlZmluZSBMQ0RfTEFZRVJfSU5URVJfUE9TX09ERAkJCUJJVCgzMCkK
KworI2RlZmluZSBMQ0RfTEFZRVIwX0NPTF9TVEFSVAkJKDB4NCAqIDB4MTAxKQorI2RlZmluZSBM
Q0RfTEFZRVJuX0NPTF9TVEFSVChOKQkJKExDRF9MQVlFUjBfQ09MX1NUQVJUICsgKDB4NDAwICog
KE4pKSkKKyNkZWZpbmUgTENEX0xBWUVSMF9ST1dfU1RBUlQJCSgweDQgKiAweDEwMikKKyNkZWZp
bmUgTENEX0xBWUVSbl9ST1dfU1RBUlQoTikJCShMQ0RfTEFZRVIwX1JPV19TVEFSVCArICgweDQw
MCAqIChOKSkpCisjZGVmaW5lIExDRF9MQVlFUjBfV0lEVEgJCSgweDQgKiAweDEwMykKKyNkZWZp
bmUgTENEX0xBWUVSbl9XSURUSChOKQkJKExDRF9MQVlFUjBfV0lEVEggKyAoMHg0MDAgKiAoTikp
KQorI2RlZmluZSBMQ0RfTEFZRVIwX0hFSUdIVAkJKDB4NCAqIDB4MTA0KQorI2RlZmluZSBMQ0Rf
TEFZRVJuX0hFSUdIVChOKQkJKExDRF9MQVlFUjBfSEVJR0hUICsgKDB4NDAwICogKE4pKSkKKyNk
ZWZpbmUgTENEX0xBWUVSMF9TQ0FMRV9DRkcJCSgweDQgKiAweDEwNSkKKyNkZWZpbmUgTENEX0xB
WUVSbl9TQ0FMRV9DRkcoTikJCShMQ0RfTEFZRVIwX1NDQUxFX0NGRyArICgweDQwMCAqIChOKSkp
CisjZGVmaW5lIExDRF9MQVlFUjBfQUxQSEEJCSgweDQgKiAweDEwNikKKyNkZWZpbmUgTENEX0xB
WUVSbl9BTFBIQShOKQkJKExDRF9MQVlFUjBfQUxQSEEgKyAoMHg0MDAgKiAoTikpKQorI2RlZmlu
ZSBMQ0RfTEFZRVIwX0lOVl9DT0xPVVJfTFMJKDB4NCAqIDB4MTA3KQorI2RlZmluZSBMQ0RfTEFZ
RVJuX0lOVl9DT0xPVVJfTFMoTikJKExDRF9MQVlFUjBfSU5WX0NPTE9VUl9MUyArIFwKKwkJCQkJ
KDB4NDAwICogKE4pKSkKKyNkZWZpbmUgTENEX0xBWUVSMF9JTlZfQ09MT1VSX01TCSgweDQgKiAw
eDEwOCkKKyNkZWZpbmUgTENEX0xBWUVSbl9JTlZfQ09MT1VSX01TKE4pCShMQ0RfTEFZRVIwX0lO
Vl9DT0xPVVJfTVMgKyBcCisJCQkJCSgweDQwMCAqIChOKSkpCisjZGVmaW5lIExDRF9MQVlFUjBf
VFJBTlNfQ09MT1VSX0xTCSgweDQgKiAweDEwOSkKKyNkZWZpbmUgTENEX0xBWUVSbl9UUkFOU19D
T0xPVVJfTFMoTikJKExDRF9MQVlFUjBfVFJBTlNfQ09MT1VSX0xTICsgXAorCQkJCQkoMHg0MDAg
KiAoTikpKQorI2RlZmluZSBMQ0RfTEFZRVIwX1RSQU5TX0NPTE9VUl9NUwkoMHg0ICogMHgxMGEp
CisjZGVmaW5lIExDRF9MQVlFUm5fVFJBTlNfQ09MT1VSX01TKE4pCShMQ0RfTEFZRVIwX1RSQU5T
X0NPTE9VUl9NUyArIFwKKwkJCQkJKDB4NDAwICogKE4pKSkKKyNkZWZpbmUgTENEX0xBWUVSMF9D
U0NfQ09FRkYxMQkJKDB4NCAqIDB4MTBiKQorI2RlZmluZSBMQ0RfTEFZRVJuX0NTQ19DT0VGRjEx
KE4pCShMQ0RfTEFZRVIwX0NTQ19DT0VGRjExICsgKDB4NDAwICogKE4pKSkKKyNkZWZpbmUgTENE
X0xBWUVSMF9DU0NfQ09FRkYxMgkJKDB4NCAqIDB4MTBjKQorI2RlZmluZSBMQ0RfTEFZRVJuX0NT
Q19DT0VGRjEyKE4pCShMQ0RfTEFZRVIwX0NTQ19DT0VGRjEyICsgKDB4NDAwICogKE4pKSkKKyNk
ZWZpbmUgTENEX0xBWUVSMF9DU0NfQ09FRkYxMwkJKDB4NCAqIDB4MTBkKQorI2RlZmluZSBMQ0Rf
TEFZRVJuX0NTQ19DT0VGRjEzKE4pCShMQ0RfTEFZRVIwX0NTQ19DT0VGRjEzICsgKDB4NDAwICog
KE4pKSkKKyNkZWZpbmUgTENEX0xBWUVSMF9DU0NfQ09FRkYyMQkJKDB4NCAqIDB4MTBlKQorI2Rl
ZmluZSBMQ0RfTEFZRVJuX0NTQ19DT0VGRjIxKE4pCShMQ0RfTEFZRVIwX0NTQ19DT0VGRjIxICsg
KDB4NDAwICogKE4pKSkKKyNkZWZpbmUgTENEX0xBWUVSMF9DU0NfQ09FRkYyMgkJKDB4NCAqIDB4
MTBmKQorI2RlZmluZSBMQ0RfTEFZRVJuX0NTQ19DT0VGRjIyKE4pCShMQ0RfTEFZRVIwX0NTQ19D
T0VGRjIyICsgKDB4NDAwICogKE4pKSkKKyNkZWZpbmUgTENEX0xBWUVSMF9DU0NfQ09FRkYyMwkJ
KDB4NCAqIDB4MTEwKQorI2RlZmluZSBMQ0RfTEFZRVJuX0NTQ19DT0VGRjIzKE4pCShMQ0RfTEFZ
RVIwX0NTQ19DT0VGRjIzICsgKDB4NDAwICogKE4pKSkKKyNkZWZpbmUgTENEX0xBWUVSMF9DU0Nf
Q09FRkYzMQkJKDB4NCAqIDB4MTExKQorI2RlZmluZSBMQ0RfTEFZRVJuX0NTQ19DT0VGRjMxKE4p
CShMQ0RfTEFZRVIwX0NTQ19DT0VGRjMxICsgKDB4NDAwICogKE4pKSkKKyNkZWZpbmUgTENEX0xB
WUVSMF9DU0NfQ09FRkYzMgkJKDB4NCAqIDB4MTEyKQorI2RlZmluZSBMQ0RfTEFZRVJuX0NTQ19D
T0VGRjMyKE4pCShMQ0RfTEFZRVIwX0NTQ19DT0VGRjMyICsgKDB4NDAwICogKE4pKSkKKyNkZWZp
bmUgTENEX0xBWUVSMF9DU0NfQ09FRkYzMwkJKDB4NCAqIDB4MTEzKQorI2RlZmluZSBMQ0RfTEFZ
RVJuX0NTQ19DT0VGRjMzKE4pCShMQ0RfTEFZRVIwX0NTQ19DT0VGRjMzICsgKDB4NDAwICogKE4p
KSkKKyNkZWZpbmUgTENEX0xBWUVSMF9DU0NfT0ZGMQkJKDB4NCAqIDB4MTE0KQorI2RlZmluZSBM
Q0RfTEFZRVJuX0NTQ19PRkYxKE4pCQkoTENEX0xBWUVSMF9DU0NfT0ZGMSArICgweDQwMCAqIChO
KSkpCisjZGVmaW5lIExDRF9MQVlFUjBfQ1NDX09GRjIJCSgweDQgKiAweDExNSkKKyNkZWZpbmUg
TENEX0xBWUVSbl9DU0NfT0ZGMihOKQkJKExDRF9MQVlFUjBfQ1NDX09GRjIgKyAoMHg0MDAgKiAo
TikpKQorI2RlZmluZSBMQ0RfTEFZRVIwX0NTQ19PRkYzCQkoMHg0ICogMHgxMTYpCisjZGVmaW5l
IExDRF9MQVlFUm5fQ1NDX09GRjMoTikJCShMQ0RfTEFZRVIwX0NTQ19PRkYzICsgKDB4NDAwICog
KE4pKSkKKworLyogIExDRCBjb250cm9sbGVyIExheWVyIERNQSBjb25maWcgcmVnaXN0ZXIgKi8K
KyNkZWZpbmUgTENEX0xBWUVSMF9ETUFfQ0ZHCQkJKDB4NCAqIDB4MTE3KQorI2RlZmluZSBMQ0Rf
TEFZRVJuX0RNQV9DRkcoTikJCQkoTENEX0xBWUVSMF9ETUFfQ0ZHICsgXAorCQkJCQkJKDB4NDAw
ICogKE4pKSkKKyNkZWZpbmUgTENEX0RNQV9MQVlFUl9FTkFCTEUJCQkgIEJJVCgwKQorI2RlZmlu
ZSBMQ0RfRE1BX0xBWUVSX1NUQVRVUwkJCSAgQklUKDEpCisjZGVmaW5lIExDRF9ETUFfTEFZRVJf
QVVUT19VUERBVEUJCSAgQklUKDIpCisjZGVmaW5lIExDRF9ETUFfTEFZRVJfQ09OVF9VUERBVEUJ
CSAgQklUKDMpCisjZGVmaW5lIExDRF9ETUFfTEFZRVJfQ09OVF9QSU5HX1BPTkdfVVBEQVRFCSAg
KExDRF9ETUFfTEFZRVJfQVVUT19VUERBVEUgXAorCQkJCQkJfCBMQ0RfRE1BX0xBWUVSX0NPTlRf
VVBEQVRFKQorI2RlZmluZSBMQ0RfRE1BX0xBWUVSX0ZJRk9fQURSX01PREUJCSAgQklUKDQpCisj
ZGVmaW5lIExDRF9ETUFfTEFZRVJfQVhJX0JVUlNUXzEJCSAgQklUKDUpCisjZGVmaW5lIExDRF9E
TUFfTEFZRVJfQVhJX0JVUlNUXzIJCSAgKDIgPDwgNSkKKyNkZWZpbmUgTENEX0RNQV9MQVlFUl9B
WElfQlVSU1RfMwkJICAoMyA8PCA1KQorI2RlZmluZSBMQ0RfRE1BX0xBWUVSX0FYSV9CVVJTVF80
CQkgICg0IDw8IDUpCisjZGVmaW5lIExDRF9ETUFfTEFZRVJfQVhJX0JVUlNUXzUJCSAgKDUgPDwg
NSkKKyNkZWZpbmUgTENEX0RNQV9MQVlFUl9BWElfQlVSU1RfNgkJICAoNiA8PCA1KQorI2RlZmlu
ZSBMQ0RfRE1BX0xBWUVSX0FYSV9CVVJTVF83CQkgICg3IDw8IDUpCisjZGVmaW5lIExDRF9ETUFf
TEFZRVJfQVhJX0JVUlNUXzgJCSAgKDggPDwgNSkKKyNkZWZpbmUgTENEX0RNQV9MQVlFUl9BWElf
QlVSU1RfOQkJICAoOSA8PCA1KQorI2RlZmluZSBMQ0RfRE1BX0xBWUVSX0FYSV9CVVJTVF8xMAkJ
ICAoMHhhIDw8IDUpCisjZGVmaW5lIExDRF9ETUFfTEFZRVJfQVhJX0JVUlNUXzExCQkgICgweGIg
PDwgNSkKKyNkZWZpbmUgTENEX0RNQV9MQVlFUl9BWElfQlVSU1RfMTIJCSAgKDB4YyA8PCA1KQor
I2RlZmluZSBMQ0RfRE1BX0xBWUVSX0FYSV9CVVJTVF8xMwkJICAoMHhkIDw8IDUpCisjZGVmaW5l
IExDRF9ETUFfTEFZRVJfQVhJX0JVUlNUXzE0CQkgICgweGUgPDwgNSkKKyNkZWZpbmUgTENEX0RN
QV9MQVlFUl9BWElfQlVSU1RfMTUJCSAgKDB4ZiA8PCA1KQorI2RlZmluZSBMQ0RfRE1BX0xBWUVS
X0FYSV9CVVJTVF8xNgkJICAoMHgxMCA8PCA1KQorI2RlZmluZSBMQ0RfRE1BX0xBWUVSX1ZTVFJJ
REVfRU4JCSAgQklUKDEwKQorCisjZGVmaW5lIExDRF9MQVlFUjBfRE1BX1NUQVJUX0FEUgkJKDB4
NCAqIDB4MTE4KQorI2RlZmluZSBMQ0RfTEFZRVJuX0RNQV9TVEFSVF9BRERSKE4pCQkoTENEX0xB
WUVSMF9ETUFfU1RBUlRfQURSIFwKKwkJCQkJCSsgKDB4NDAwICogKE4pKSkKKyNkZWZpbmUgTENE
X0xBWUVSMF9ETUFfU1RBUlRfU0hBRE9XCQkoMHg0ICogMHgxMTkpCisjZGVmaW5lIExDRF9MQVlF
Um5fRE1BX1NUQVJUX1NIQURPVyhOKQkJKExDRF9MQVlFUjBfRE1BX1NUQVJUX1NIQURPVyBcCisJ
CQkJCQkrICgweDQwMCAqIChOKSkpCisjZGVmaW5lIExDRF9MQVlFUjBfRE1BX0xFTgkJCSgweDQg
KiAweDExYSkKKyNkZWZpbmUgTENEX0xBWUVSbl9ETUFfTEVOKE4pCQkJKExDRF9MQVlFUjBfRE1B
X0xFTiArIFwKKwkJCQkJCSgweDQwMCAqIChOKSkpCisjZGVmaW5lIExDRF9MQVlFUjBfRE1BX0xF
Tl9TSEFET1cJCSgweDQgKiAweDExYikKKyNkZWZpbmUgTENEX0xBWUVSbl9ETUFfTEVOX1NIQURP
VyhOKQkJKExDRF9MQVlFUjBfRE1BX0xFTl9TSEFET1cgKyBcCisJCQkJCQkoMHg0MDAgKiAoTikp
KQorI2RlZmluZSBMQ0RfTEFZRVIwX0RNQV9TVEFUVVMJCQkoMHg0ICogMHgxMWMpCisjZGVmaW5l
IExDRF9MQVlFUm5fRE1BX1NUQVRVUyhOKQkJKExDRF9MQVlFUjBfRE1BX1NUQVRVUyArIFwKKwkJ
CQkJCSgweDQwMCAqIChOKSkpCisjZGVmaW5lIExDRF9MQVlFUjBfRE1BX0xJTkVfV0lEVEgJCSgw
eDQgKiAweDExZCkKKyNkZWZpbmUgTENEX0xBWUVSbl9ETUFfTElORV9XSURUSChOKQkJKExDRF9M
QVlFUjBfRE1BX0xJTkVfV0lEVEggKyBcCisJCQkJCQkoMHg0MDAgKiAoTikpKQorI2RlZmluZSBM
Q0RfTEFZRVIwX0RNQV9MSU5FX1ZTVFJJREUJCSgweDQgKiAweDExZSkKKyNkZWZpbmUgTENEX0xB
WUVSbl9ETUFfTElORV9WU1RSSURFKE4pCQkoTENEX0xBWUVSMF9ETUFfTElORV9WU1RSSURFICtc
CisJCQkJCQkoMHg0MDAgKiAoTikpKQorI2RlZmluZSBMQ0RfTEFZRVIwX0RNQV9GSUZPX1NUQVRV
UwkJKDB4NCAqIDB4MTFmKQorI2RlZmluZSBMQ0RfTEFZRVJuX0RNQV9GSUZPX1NUQVRVUyhOKQkJ
KExDRF9MQVlFUjBfRE1BX0ZJRk9fU1RBVFVTICsgXAorCQkJCQkJKDB4NDAwICogKE4pKSkKKyNk
ZWZpbmUgTENEX0xBWUVSMF9DRkcyCQkJCSgweDQgKiAweDEyMCkKKyNkZWZpbmUgTENEX0xBWUVS
bl9DRkcyKE4pCQkJKExDRF9MQVlFUjBfQ0ZHMiArICgweDQwMCAqIChOKSkpCisjZGVmaW5lIExD
RF9MQVlFUjBfRE1BX1NUQVJUX0NCX0FEUgkJKDB4NCAqIDB4NzAwKQorI2RlZmluZSBMQ0RfTEFZ
RVJuX0RNQV9TVEFSVF9DQl9BRFIoTikJCShMQ0RfTEFZRVIwX0RNQV9TVEFSVF9DQl9BRFIgKyBc
CisJCQkJCQkoMHgyMCAqIChOKSkpCisjZGVmaW5lIExDRF9MQVlFUjBfRE1BX1NUQVJUX0NCX1NI
QURPVwkJKDB4NCAqIDB4NzAxKQorI2RlZmluZSBMQ0RfTEFZRVJuX0RNQV9TVEFSVF9DQl9TSEFE
T1coTikJKExDRF9MQVlFUjBfRE1BX1NUQVJUX0NCX1NIQURPV1wKKwkJCQkJCSsgKDB4MjAgKiAo
TikpKQorI2RlZmluZSBMQ0RfTEFZRVIwX0RNQV9DQl9MSU5FX1dJRFRICQkoMHg0ICogMHg3MDIp
CisjZGVmaW5lIExDRF9MQVlFUm5fRE1BX0NCX0xJTkVfV0lEVEgoTikJCShMQ0RfTEFZRVIwX0RN
QV9DQl9MSU5FX1dJRFRIICtcCisJCQkJCQkoMHgyMCAqIChOKSkpCisjZGVmaW5lIExDRF9MQVlF
UjBfRE1BX0NCX0xJTkVfVlNUUklERQkJKDB4NCAqIDB4NzAzKQorI2RlZmluZSBMQ0RfTEFZRVJu
X0RNQV9DQl9MSU5FX1ZTVFJJREUoTikJKExDRF9MQVlFUjBfRE1BX0NCX0xJTkVfVlNUUklERVwK
KwkJCQkJCSsgKDB4MjAgKiAoTikpKQorI2RlZmluZSBMQ0RfTEFZRVIwX0RNQV9TVEFSVF9DUl9B
RFIJCSgweDQgKiAweDcwNCkKKyNkZWZpbmUgTENEX0xBWUVSbl9ETUFfU1RBUlRfQ1JfQURSKE4p
CQkoTENEX0xBWUVSMF9ETUFfU1RBUlRfQ1JfQURSICsgXAorCQkJCQkJKDB4MjAgKiAoTikpKQor
I2RlZmluZSBMQ0RfTEFZRVIwX0RNQV9TVEFSVF9DUl9TSEFET1cJCSgweDQgKiAweDcwNSkKKyNk
ZWZpbmUgTENEX0xBWUVSbl9ETUFfU1RBUlRfQ1JfU0hBRE9XKE4pCVwKKwkJCQkJCShMQ0RfTEFZ
RVIwX0RNQV9TVEFSVF9DUl9TSEFET1dcCisJCQkJCQkgKyAoMHgyMCAqIChOKSkpCisjZGVmaW5l
IExDRF9MQVlFUjBfRE1BX0NSX0xJTkVfV0lEVEgJCSgweDQgKiAweDcwNikKKyNkZWZpbmUgTENE
X0xBWUVSbl9ETUFfQ1JfTElORV9XSURUSChOKQkJKExDRF9MQVlFUjBfRE1BX0NSX0xJTkVfV0lE
VEggK1wKKwkJCQkJCSgweDIwICogKE4pKSkKKyNkZWZpbmUgTENEX0xBWUVSMF9ETUFfQ1JfTElO
RV9WU1RSSURFCQkoMHg0ICogMHg3MDcpCisjZGVmaW5lIExDRF9MQVlFUm5fRE1BX0NSX0xJTkVf
VlNUUklERShOKQkoTENEX0xBWUVSMF9ETUFfQ1JfTElORV9WU1RSSURFXAorCQkJCQkJKyAoMHgy
MCAqIChOKSkpCisjZGVmaW5lIExDRF9MQVlFUjFfRE1BX1NUQVJUX0NCX0FEUgkJKDB4NCAqIDB4
NzA4KQorI2RlZmluZSBMQ0RfTEFZRVIxX0RNQV9TVEFSVF9DQl9TSEFET1cJCSgweDQgKiAweDcw
OSkKKyNkZWZpbmUgTENEX0xBWUVSMV9ETUFfQ0JfTElORV9XSURUSAkJKDB4NCAqIDB4NzBhKQor
I2RlZmluZSBMQ0RfTEFZRVIxX0RNQV9DQl9MSU5FX1ZTVFJJREUJCSgweDQgKiAweDcwYikKKyNk
ZWZpbmUgTENEX0xBWUVSMV9ETUFfU1RBUlRfQ1JfQURSCQkoMHg0ICogMHg3MGMpCisjZGVmaW5l
IExDRF9MQVlFUjFfRE1BX1NUQVJUX0NSX1NIQURPVwkJKDB4NCAqIDB4NzBkKQorI2RlZmluZSBM
Q0RfTEFZRVIxX0RNQV9DUl9MSU5FX1dJRFRICQkoMHg0ICogMHg3MGUpCisjZGVmaW5lIExDRF9M
QVlFUjFfRE1BX0NSX0xJTkVfVlNUUklERQkJKDB4NCAqIDB4NzBmKQorCisvKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKgorICoJCSAgIExDRCBjb250cm9sbGVyIG91dHB1dCBmb3JtYXQgcmVnaXN0ZXIgZGVm
aW5lcworICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKiovCisjZGVmaW5lIExDRF9PVVRfRk9STUFUX0NGRwkJ
CSgweDQgKiAweDgwMCkKKyNkZWZpbmUgTENEX09VVEZfRk9STUFUX1JHQjEyMTIxMiAgICAgICAg
ICAgICAgICAgKDB4MDApCisjZGVmaW5lIExDRF9PVVRGX0ZPUk1BVF9SR0IxMDEwMTAgICAgICAg
ICAgICAgICAgICgweDAxKQorI2RlZmluZSBMQ0RfT1VURl9GT1JNQVRfUkdCODg4ICAgICAgICAg
ICAgICAgICAgICAoMHgwMikKKyNkZWZpbmUgTENEX09VVEZfRk9STUFUX1JHQjY2NiAgICAgICAg
ICAgICAgICAgICAgKDB4MDMpCisjZGVmaW5lIExDRF9PVVRGX0ZPUk1BVF9SR0I1NjUgICAgICAg
ICAgICAgICAgICAgICgweDA0KQorI2RlZmluZSBMQ0RfT1VURl9GT1JNQVRfUkdCNDQ0ICAgICAg
ICAgICAgICAgICAgICAoMHgwNSkKKyNkZWZpbmUgTENEX09VVEZfRk9STUFUX01SR0IxMjEyMTIg
ICAgICAgICAgICAgICAgKDB4MTApCisjZGVmaW5lIExDRF9PVVRGX0ZPUk1BVF9NUkdCMTAxMDEw
ICAgICAgICAgICAgICAgICgweDExKQorI2RlZmluZSBMQ0RfT1VURl9GT1JNQVRfTVJHQjg4OCAg
ICAgICAgICAgICAgICAgICAoMHgxMikKKyNkZWZpbmUgTENEX09VVEZfRk9STUFUX01SR0I2NjYg
ICAgICAgICAgICAgICAgICAgKDB4MTMpCisjZGVmaW5lIExDRF9PVVRGX0ZPUk1BVF9NUkdCNTY1
ICAgICAgICAgICAgICAgICAgICgweDE0KQorI2RlZmluZSBMQ0RfT1VURl9GT1JNQVRfWUNCQ1I0
MjBfOEJfTEVHQUNZICAgICAgICAoMHgwOCkKKyNkZWZpbmUgTENEX09VVEZfRk9STUFUX1lDQkNS
NDIwXzhCX0RDSSAgICAgICAgICAgKDB4MDkpCisjZGVmaW5lIExDRF9PVVRGX0ZPUk1BVF9ZQ0JD
UjQyMF84QiAgICAgICAgICAgICAgICgweDBBKQorI2RlZmluZSBMQ0RfT1VURl9GT1JNQVRfWUNC
Q1I0MjBfMTBCICAgICAgICAgICAgICAoMHgwQikKKyNkZWZpbmUgTENEX09VVEZfRk9STUFUX1lD
QkNSNDIwXzEyQiAgICAgICAgICAgICAgKDB4MEMpCisjZGVmaW5lIExDRF9PVVRGX0ZPUk1BVF9Z
Q0JDUjQyMl84QiAgICAgICAgICAgICAgICgweDBEKQorI2RlZmluZSBMQ0RfT1VURl9GT1JNQVRf
WUNCQ1I0MjJfMTBCICAgICAgICAgICAgICAoMHgwRSkKKyNkZWZpbmUgTENEX09VVEZfRk9STUFU
X1lDQkNSNDQ0ICAgICAgICAgICAgICAgICAgKDB4MEYpCisjZGVmaW5lIExDRF9PVVRGX0ZPUk1B
VF9NWUNCQ1I0MjBfOEJfTEVHQUNZICAgICAgICgweDE4KQorI2RlZmluZSBMQ0RfT1VURl9GT1JN
QVRfTVlDQkNSNDIwXzhCX0RDSSAgICAgICAgICAoMHgxOSkKKyNkZWZpbmUgTENEX09VVEZfRk9S
TUFUX01ZQ0JDUjQyMF84QiAgICAgICAgICAgICAgKDB4MUEpCisjZGVmaW5lIExDRF9PVVRGX0ZP
Uk1BVF9NWUNCQ1I0MjBfMTBCICAgICAgICAgICAgICgweDFCKQorI2RlZmluZSBMQ0RfT1VURl9G
T1JNQVRfTVlDQkNSNDIwXzEyQiAgICAgICAgICAgICAoMHgxQykKKyNkZWZpbmUgTENEX09VVEZf
Rk9STUFUX01ZQ0JDUjQyMl84QiAgICAgICAgICAgICAgKDB4MUQpCisjZGVmaW5lIExDRF9PVVRG
X0ZPUk1BVF9NWUNCQ1I0MjJfMTBCICAgICAgICAgICAgICgweDFFKQorI2RlZmluZSBMQ0RfT1VU
Rl9GT1JNQVRfTVlDQkNSNDQ0ICAgICAgICAgICAgICAgICAoMHgxRikKKyNkZWZpbmUgTENEX09V
VEZfQkdSX09SREVSCQkJICBCSVQoNSkKKyNkZWZpbmUgTENEX09VVEZfWV9PUkRFUgkJCSAgQklU
KDYpCisjZGVmaW5lIExDRF9PVVRGX0NSQ0JfT1JERVIJCQkgIEJJVCg3KQorI2RlZmluZSBMQ0Rf
T1VURl9TWU5DX01PREUJCQkgIEJJVCgxMSkKKyNkZWZpbmUgTENEX09VVEZfUkdCX0NPTlZfTU9E
RQkJCSAgQklUKDE0KQorI2RlZmluZSBMQ0RfT1VURl9NSVBJX1JHQl9NT0RFCQkJICBCSVQoMTgp
CisKKyNkZWZpbmUgTENEX0hTWU5DX1dJRFRICQkJCSgweDQgKiAweDgwMSkKKyNkZWZpbmUgTENE
X0hfQkFDS1BPUkNICQkJCSgweDQgKiAweDgwMikKKyNkZWZpbmUgTENEX0hfQUNUSVZFV0lEVEgJ
CQkoMHg0ICogMHg4MDMpCisjZGVmaW5lIExDRF9IX0ZST05UUE9SQ0gJCQkoMHg0ICogMHg4MDQp
CisjZGVmaW5lIExDRF9WU1lOQ19XSURUSAkJCQkoMHg0ICogMHg4MDUpCisjZGVmaW5lIExDRF9W
X0JBQ0tQT1JDSAkJCQkoMHg0ICogMHg4MDYpCisjZGVmaW5lIExDRF9WX0FDVElWRUhFSUdIVAkJ
CSgweDQgKiAweDgwNykKKyNkZWZpbmUgTENEX1ZfRlJPTlRQT1JDSAkJCSgweDQgKiAweDgwOCkK
KyNkZWZpbmUgTENEX1ZTWU5DX1NUQVJUCQkJCSgweDQgKiAweDgwOSkKKyNkZWZpbmUgTENEX1ZT
WU5DX0VORAkJCQkoMHg0ICogMHg4MGEpCisjZGVmaW5lIExDRF9WX0JBQ0tQT1JDSF9FVkVOCQkJ
KDB4NCAqIDB4ODBiKQorI2RlZmluZSBMQ0RfVlNZTkNfV0lEVEhfRVZFTgkJCSgweDQgKiAweDgw
YykKKyNkZWZpbmUgTENEX1ZfQUNUSVZFSEVJR0hUX0VWRU4JCQkoMHg0ICogMHg4MGQpCisjZGVm
aW5lIExDRF9WX0ZST05UUE9SQ0hfRVZFTgkJCSgweDQgKiAweDgwZSkKKyNkZWZpbmUgTENEX1ZT
WU5DX1NUQVJUX0VWRU4JCQkoMHg0ICogMHg4MGYpCisjZGVmaW5lIExDRF9WU1lOQ19FTkRfRVZF
TgkJCSgweDQgKiAweDgxMCkKKyNkZWZpbmUgTENEX1RJTUlOR19HRU5fVFJJRwkJCSgweDQgKiAw
eDgxMSkKKyNkZWZpbmUgTENEX1BXTTBfQ1RSTAkJCQkoMHg0ICogMHg4MTIpCisjZGVmaW5lIExD
RF9QV00wX1JQVF9MRUFESU4JCQkoMHg0ICogMHg4MTMpCisjZGVmaW5lIExDRF9QV00wX0hJR0hf
TE9XCQkJKDB4NCAqIDB4ODE0KQorI2RlZmluZSBMQ0RfUFdNMV9DVFJMCQkJCSgweDQgKiAweDgx
NSkKKyNkZWZpbmUgTENEX1BXTTFfUlBUX0xFQURJTgkJCSgweDQgKiAweDgxNikKKyNkZWZpbmUg
TENEX1BXTTFfSElHSF9MT1cJCQkoMHg0ICogMHg4MTcpCisjZGVmaW5lIExDRF9QV00yX0NUUkwJ
CQkJKDB4NCAqIDB4ODE4KQorI2RlZmluZSBMQ0RfUFdNMl9SUFRfTEVBRElOCQkJKDB4NCAqIDB4
ODE5KQorI2RlZmluZSBMQ0RfUFdNMl9ISUdIX0xPVwkJCSgweDQgKiAweDgxYSkKKyNkZWZpbmUg
TENEX1ZJREVPMF9ETUEwX0JZVEVTCQkJKDB4NCAqIDB4YjAwKQorI2RlZmluZSBMQ0RfVklERU8w
X0RNQTBfU1RBVEUJCQkoMHg0ICogMHhiMDEpCisjZGVmaW5lIExDRF9ETUFfU1RBVEVfQUNUSVZF
CQkJICBCSVQoMykKKyNkZWZpbmUgTENEX1ZJREVPMF9ETUExX0JZVEVTCQkJKDB4NCAqIDB4YjAy
KQorI2RlZmluZSBMQ0RfVklERU8wX0RNQTFfU1RBVEUJCQkoMHg0ICogMHhiMDMpCisjZGVmaW5l
IExDRF9WSURFTzBfRE1BMl9CWVRFUwkJCSgweDQgKiAweGIwNCkKKyNkZWZpbmUgTENEX1ZJREVP
MF9ETUEyX1NUQVRFCQkJKDB4NCAqIDB4YjA1KQorI2RlZmluZSBMQ0RfVklERU8xX0RNQTBfQllU
RVMJCQkoMHg0ICogMHhiMDYpCisjZGVmaW5lIExDRF9WSURFTzFfRE1BMF9TVEFURQkJCSgweDQg
KiAweGIwNykKKyNkZWZpbmUgTENEX1ZJREVPMV9ETUExX0JZVEVTCQkJKDB4NCAqIDB4YjA4KQor
I2RlZmluZSBMQ0RfVklERU8xX0RNQTFfU1RBVEUJCQkoMHg0ICogMHhiMDkpCisjZGVmaW5lIExD
RF9WSURFTzFfRE1BMl9CWVRFUwkJCSgweDQgKiAweGIwYSkKKyNkZWZpbmUgTENEX1ZJREVPMV9E
TUEyX1NUQVRFCQkJKDB4NCAqIDB4YjBiKQorI2RlZmluZSBMQ0RfR1JBUEhJQzBfRE1BX0JZVEVT
CQkJKDB4NCAqIDB4YjBjKQorI2RlZmluZSBMQ0RfR1JBUEhJQzBfRE1BX1NUQVRFCQkJKDB4NCAq
IDB4YjBkKQorI2RlZmluZSBMQ0RfR1JBUEhJQzFfRE1BX0JZVEVTCQkJKDB4NCAqIDB4YjBlKQor
I2RlZmluZSBMQ0RfR1JBUEhJQzFfRE1BX1NUQVRFCQkJKDB4NCAqIDB4YjBmKQorCisvKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqCisgKgkJICAgTUlQSSBjb250cm9sbGVyIGNvbnRyb2wgcmVnaXN0ZXIgZGVm
aW5lcworICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqaSoq
KioqKioqKioqKioqKioqKioqKioqKioqKiovCisjZGVmaW5lIE1JUEkwX0hTX0JBU0VfQUREUgkJ
CShNSVBJX0JBU0VfQUREUiArIDB4NDAwKQorI2RlZmluZSBIU19PRkZTRVQoTSkJCQkJKCgoTSkg
KyAxKSAqIDB4NDAwKQorCisjZGVmaW5lIE1JUElfVFhfSFNfQ1RSTAkJCQkoMHgwKQorI2RlZmlu
ZSAgIE1JUElfVFhtX0hTX0NUUkwoTSkJCQkoTUlQSV9UWF9IU19DVFJMICsgSFNfT0ZGU0VUKE0p
KQorI2RlZmluZSAgIEhTX0NUUkxfRU4JCQkJQklUKDApCisvKjE6Q1NJIDA6RFNJICovCisjZGVm
aW5lICAgSFNfQ1RSTF9DU0lEU0lOCQkJQklUKDIpCisvKjE6TENELCAwOkRNQSAqLworI2RlZmlu
ZSAgIFRYX1NPVVJDRQkJCQlCSVQoMykKKyNkZWZpbmUgICBBQ1RJVkVfTEFORVMobikJCQkoKG4p
IDw8IDQpCisjZGVmaW5lICAgTENEX1ZDKGNoKQkJCQkoKGNoKSA8PCA4KQorI2RlZmluZSAgIERT
SV9FT1RQX0VOCQkJCUJJVCgxMSkKKyNkZWZpbmUgICBEU0lfQ01EX0hGUF9FTgkJCUJJVCgxMikK
KyNkZWZpbmUgICBDUkNfRU4JCQkJQklUKDE0KQorI2RlZmluZSAgIEhTRVhJVF9DTlQobikJCQkJ
KChuKSA8PCAxNikKKyNkZWZpbmUgICBIU0NMS0lETEVfQ05UCQkJCUJJVCgyNCkKKyNkZWZpbmUg
TUlQSV9UWF9IU19TWU5DX0NGRwkJCSgweDgpCisjZGVmaW5lICAgTUlQSV9UWG1fSFNfU1lOQ19D
RkcoTSkJCShNSVBJX1RYX0hTX1NZTkNfQ0ZHIFwKKwkJCQkJCSsgSFNfT0ZGU0VUKE0pKQorI2Rl
ZmluZSAgIExJTkVfU1lOQ19QS1RfRU5BQkxFCQkJQklUKDApCisjZGVmaW5lICAgRlJBTUVfQ09V
TlRFUl9BQ1RJVkUJCQlCSVQoMSkKKyNkZWZpbmUgICBMSU5FX0NPVU5URVJfQUNUSVZFCQkJQklU
KDIpCisjZGVmaW5lICAgRFNJX1ZfQkxBTktJTkcJCQlCSVQoNCkKKyNkZWZpbmUgICBEU0lfSFNB
X0JMQU5LSU5HCQkJQklUKDUpCisjZGVmaW5lICAgRFNJX0hCUF9CTEFOS0lORwkJCUJJVCg2KQor
I2RlZmluZSAgIERTSV9IRlBfQkxBTktJTkcJCQlCSVQoNykKKyNkZWZpbmUgICBEU0lfU1lOQ19Q
VUxTRV9FVkVOVE4JCQlCSVQoOCkKKyNkZWZpbmUgICBEU0lfTFBNX0ZJUlNUX1ZTQV9MSU5FCQlC
SVQoOSkKKyNkZWZpbmUgICBEU0lfTFBNX0xBU1RfVkZQX0xJTkUJCQlCSVQoMTApCisjZGVmaW5l
ICAgV0FJVF9BTExfU0VDVAkJCQlCSVQoMTEpCisjZGVmaW5lICAgV0FJVF9UUklHX1BPUwkJCQlC
SVQoMTUpCisjZGVmaW5lICAgQUxXQVlTX1VTRV9IQUNUKGYpCQkJKChmKSA8PCAxOSkKKyNkZWZp
bmUgICBGUkFNRV9HRU5fRU4oZikJCQkoKGYpIDw8IDIzKQorI2RlZmluZSAgIEhBQ1RfV0FJVF9T
VE9QKGYpCQkJKChmKSA8PCAyOCkKKyNkZWZpbmUgTUlQSV9UWDBfSFNfRkcwX1NFQ1QwX1BICQko
MHg0MCkKKyNkZWZpbmUgICBNSVBJX1RYbV9IU19GR25fU0VDVG9fUEgoTSwgTiwgTykJKE1JUElf
VFgwX0hTX0ZHMF9TRUNUMF9QSCArIFwKKwkJCQkJCUhTX09GRlNFVChNKSArICgweDJDICogKE4p
KSBcCisJCQkJCQkrICg4ICogKE8pKSkKKyNkZWZpbmUgICBNSVBJX1RYX1NFQ1RfV0NfTUFTSwkJ
CSgweGZmZmYpCisjZGVmaW5lCSAgTUlQSV9UWF9TRUNUX1ZDX01BU0sJCQkoMykKKyNkZWZpbmUg
ICBNSVBJX1RYX1NFQ1RfVkNfU0hJRlQJCQkoMjIpCisjZGVmaW5lICAgTUlQSV9UWF9TRUNUX0RU
X01BU0sJCQkoMHgzZikKKyNkZWZpbmUgICBNSVBJX1RYX1NFQ1RfRFRfU0hJRlQJCQkoMTYpCisj
ZGVmaW5lICAgTUlQSV9UWF9TRUNUX0RNX01BU0sJCQkoMykKKyNkZWZpbmUgICBNSVBJX1RYX1NF
Q1RfRE1fU0hJRlQJCQkoMjQpCisjZGVmaW5lICAgTUlQSV9UWF9TRUNUX0RNQV9QQUNLRUQJCUJJ
VCgyNikKKyNkZWZpbmUgTUlQSV9UWF9IU19GRzBfU0VDVF9VTlBBQ0tFRF9CWVRFUzAJKDB4NjAp
CisjZGVmaW5lIE1JUElfVFhfSFNfRkcwX1NFQ1RfVU5QQUNLRURfQllURVMxCSgweDY0KQorI2Rl
ZmluZSAgIE1JUElfVFhtX0hTX0ZHbl9TRUNUX1VOUEFDS0VEX0JZVEVTMChNLCBOKQlcCisJCQkJ
CShNSVBJX1RYX0hTX0ZHMF9TRUNUX1VOUEFDS0VEX0JZVEVTMCBcCisJCQkJCSsgSFNfT0ZGU0VU
KE0pICsgKDB4MkMgKiAoTikpKQorI2RlZmluZSBNSVBJX1RYX0hTX0ZHMF9TRUNUMF9MSU5FX0NG
RwkJKDB4NDQpCisjZGVmaW5lICAgTUlQSV9UWG1fSFNfRkduX1NFQ1RvX0xJTkVfQ0ZHKE0sIE4s
IE8pCVwKKwkJCQkoTUlQSV9UWF9IU19GRzBfU0VDVDBfTElORV9DRkcgKyBIU19PRkZTRVQoTSkg
XAorCQkJCSsgKDB4MkMgKiAoTikpICsgKDggKiAoTykpKQorCisjZGVmaW5lIE1JUElfVFhfSFNf
RkcwX05VTV9MSU5FUwkJKDB4NjgpCisjZGVmaW5lICAgTUlQSV9UWG1fSFNfRkduX05VTV9MSU5F
UyhNLCBOKQlcCisJCQkJKE1JUElfVFhfSFNfRkcwX05VTV9MSU5FUyArIEhTX09GRlNFVChNKSBc
CisJCQkJKyAoMHgyQyAqIChOKSkpCisjZGVmaW5lIE1JUElfVFhfSFNfVlNZTkNfV0lEVEhTMAkJ
KDB4MTA0KQorI2RlZmluZSAgIE1JUElfVFhtX0hTX1ZTWU5DX1dJRFRIbihNLCBOKQkJXAorCQkJ
CShNSVBJX1RYX0hTX1ZTWU5DX1dJRFRIUzAgKyBIU19PRkZTRVQoTSkgXAorCQkJCSsgKDB4NCAq
IChOKSkpCisjZGVmaW5lIE1JUElfVFhfSFNfVl9CQUNLUE9SQ0hFUzAJCSgweDE2YykKKyNkZWZp
bmUgICBNSVBJX1RYbV9IU19WX0JBQ0tQT1JDSEVTbihNLCBOKQlcCisJCQkJKE1JUElfVFhfSFNf
Vl9CQUNLUE9SQ0hFUzAgKyBIU19PRkZTRVQoTSkgXAorCQkJCSsgKDB4NCAqIChOKSkpCisjZGVm
aW5lIE1JUElfVFhfSFNfVl9GUk9OVFBPUkNIRVMwCQkoMHgxNzQpCisjZGVmaW5lICAgTUlQSV9U
WG1fSFNfVl9GUk9OVFBPUkNIRVNuKE0sIE4pCVwKKwkJCQkoTUlQSV9UWF9IU19WX0ZST05UUE9S
Q0hFUzAgKyBIU19PRkZTRVQoTSkgXAorCQkJCSsgKDB4NCAqIChOKSkpCisjZGVmaW5lIE1JUElf
VFhfSFNfVl9BQ1RJVkUwCQkJKDB4MTdjKQorI2RlZmluZSAgIE1JUElfVFhtX0hTX1ZfQUNUSVZF
bihNLCBOKQkJXAorCQkJCShNSVBJX1RYX0hTX1ZfQUNUSVZFMCArIEhTX09GRlNFVChNKSBcCisJ
CQkJKyAoMHg0ICogKE4pKSkKKyNkZWZpbmUgTUlQSV9UWF9IU19IU1lOQ19XSURUSDAJCQkoMHgx
MGMpCisjZGVmaW5lICAgTUlQSV9UWG1fSFNfSFNZTkNfV0lEVEhuKE0sIE4pCQlcCisJCQkJKE1J
UElfVFhfSFNfSFNZTkNfV0lEVEgwICsgSFNfT0ZGU0VUKE0pIFwKKwkJCQkrICgweDQgKiAoTikp
KQorI2RlZmluZSBNSVBJX1RYX0hTX0hfQkFDS1BPUkNIMAkJCSgweDExYykKKyNkZWZpbmUgICBN
SVBJX1RYbV9IU19IX0JBQ0tQT1JDSG4oTSwgTikJCVwKKwkJCQkoTUlQSV9UWF9IU19IX0JBQ0tQ
T1JDSDAgKyBIU19PRkZTRVQoTSkgXAorCQkJCSsgKDB4NCAqIChOKSkpCisjZGVmaW5lIE1JUElf
VFhfSFNfSF9GUk9OVFBPUkNIMAkJKDB4MTJjKQorI2RlZmluZSAgIE1JUElfVFhtX0hTX0hfRlJP
TlRQT1JDSG4oTSwgTikJXAorCQkJCShNSVBJX1RYX0hTX0hfRlJPTlRQT1JDSDAgKyBIU19PRkZT
RVQoTSkgXAorCQkJCSsgKDB4NCAqIChOKSkpCisjZGVmaW5lIE1JUElfVFhfSFNfSF9BQ1RJVkUw
CQkJKDB4MTg0KQorI2RlZmluZSAgIE1JUElfVFhtX0hTX0hfQUNUSVZFbihNLCBOKQkJXAorCQkJ
CShNSVBJX1RYX0hTX0hfQUNUSVZFMCArIEhTX09GRlNFVChNKSBcCisJCQkJKyAoMHg0ICogKE4p
KSkKKyNkZWZpbmUgTUlQSV9UWF9IU19MTFBfSFNZTkNfV0lEVEgwCQkoMHgxM2MpCisjZGVmaW5l
ICAgTUlQSV9UWG1fSFNfTExQX0hTWU5DX1dJRFRIbihNLCBOKQlcCisJCQkJKE1JUElfVFhfSFNf
TExQX0hTWU5DX1dJRFRIMCArIEhTX09GRlNFVChNKSBcCisJCQkJKyAoMHg0ICogKE4pKSkKKyNk
ZWZpbmUgTUlQSV9UWF9IU19MTFBfSF9CQUNLUE9SQ0gwCQkoMHgxNGMpCisjZGVmaW5lICAgTUlQ
SV9UWG1fSFNfTExQX0hfQkFDS1BPUkNIbihNLCBOKQlcCisJCQkJKE1JUElfVFhfSFNfTExQX0hf
QkFDS1BPUkNIMCArIEhTX09GRlNFVChNKSBcCisJCQkJKyAoMHg0ICogKE4pKSkKKyNkZWZpbmUg
TUlQSV9UWF9IU19MTFBfSF9GUk9OVFBPUkNIMAkJKDB4MTVjKQorI2RlZmluZSAgIE1JUElfVFht
X0hTX0xMUF9IX0ZST05UUE9SQ0huKE0sIE4pCVwKKwkJCQkoTUlQSV9UWF9IU19MTFBfSF9GUk9O
VFBPUkNIMCArIEhTX09GRlNFVChNKSBcCisJCQkJKyAoMHg0ICogKE4pKSkKKworI2RlZmluZSBN
SVBJX1RYX0hTX01DX0ZJRk9fQ1RSTF9FTgkJKDB4MTk0KQorI2RlZmluZSAgIE1JUElfVFhtX0hT
X01DX0ZJRk9fQ1RSTF9FTihNKQlcCisJCQkJKE1JUElfVFhfSFNfTUNfRklGT19DVFJMX0VOICsg
SFNfT0ZGU0VUKE0pKQorCisjZGVmaW5lIE1JUElfVFhfSFNfTUNfRklGT19DSEFOX0FMTE9DMAkJ
KDB4MTk4KQorI2RlZmluZSBNSVBJX1RYX0hTX01DX0ZJRk9fQ0hBTl9BTExPQzEJCSgweDE5YykK
KyNkZWZpbmUgICBNSVBJX1RYbV9IU19NQ19GSUZPX0NIQU5fQUxMT0NuKE0sIE4pCVwKKwkJCShN
SVBJX1RYX0hTX01DX0ZJRk9fQ0hBTl9BTExPQzAgKyBIU19PRkZTRVQoTSkgXAorCQkJKyAoMHg0
ICogKE4pKSkKKyNkZWZpbmUgICBTRVRfTUNfRklGT19DSEFOX0FMTE9DKGRldiwgY3RybCwgdmMs
IHN6KQlcCisJCWttYl93cml0ZV9iaXRzX21pcGkoZGV2LCBcCisJCQkJTUlQSV9UWG1fSFNfTUNf
RklGT19DSEFOX0FMTE9DbihjdHJsLCBcCisJCQkJKHZjKSAvIDIpLCAoKHZjKSAlIDIpICogMTYs
IDE2LCBzeikKKyNkZWZpbmUgTUlQSV9UWF9IU19NQ19GSUZPX1JUSFJFU0hPTEQwCQkoMHgxYTAp
CisjZGVmaW5lIE1JUElfVFhfSFNfTUNfRklGT19SVEhSRVNIT0xEMQkJKDB4MWE0KQorI2RlZmlu
ZSAgIE1JUElfVFhtX0hTX01DX0ZJRk9fUlRIUkVTSE9MRG4oTSwgTikJXAorCQkJCShNSVBJX1RY
X0hTX01DX0ZJRk9fUlRIUkVTSE9MRDAgKyBIU19PRkZTRVQoTSkgXAorCQkJCSsgKDB4NCAqIChO
KSkpCisjZGVmaW5lICAgU0VUX01DX0ZJRk9fUlRIUkVTSE9MRChkZXYsIGN0cmwsIHZjLCB0aCkJ
XAorCWttYl93cml0ZV9iaXRzX21pcGkoZGV2LCBNSVBJX1RYbV9IU19NQ19GSUZPX1JUSFJFU0hP
TERuKGN0cmwsIFwKKwkJCQkodmMpIC8gMiksICgodmMpICUgMikgKiAxNiwgMTYsIHRoKQorI2Rl
ZmluZSBNSVBJX1RYX0hTX0RNQV9DRkcJCQkoMHgxYTgpCisjZGVmaW5lIE1JUElfVFhfSFNfRE1B
X1NUQVJUX0FEUl9DSEFOMAkJKDB4MWFjKQorI2RlZmluZSBNSVBJX1RYX0hTX0RNQV9MRU5fQ0hB
TjAJCSgweDFiNCkKKworLyogTUlQSSBJUlEgKi8KKyNkZWZpbmUgTUlQSV9DVFJMX0lSUV9TVEFU
VVMwCQkJCSgweDAwKQorI2RlZmluZSAgIE1JUElfRFBIWV9FUlJfSVJRCQkJCTEKKyNkZWZpbmUg
ICBNSVBJX0RQSFlfRVJSX01BU0sJCQkJMHg3RkUJLypiaXRzIDEtMTAgKi8KKyNkZWZpbmUgICBN
SVBJX0hTX0lSUQkJCQkJMTMKKy8qYml0cyAxMy0yMiAqLworI2RlZmluZSAgIE1JUElfSFNfSVJR
X01BU0sJCQkJMHg3RkUwMDAKKyNkZWZpbmUgICBNSVBJX0xQX0VWRU5UX0lSUQkJCQkyNQorI2Rl
ZmluZSAgIE1JUElfR0VUX0lSUV9TVEFUMChkZXYpCQlrbWJfcmVhZF9taXBpKGRldiwgXAorCQkJ
CQkJTUlQSV9DVFJMX0lSUV9TVEFUVVMwKQorI2RlZmluZSBNSVBJX0NUUkxfSVJRX1NUQVRVUzEJ
CQkJKDB4MDQpCisjZGVmaW5lICAgTUlQSV9IU19SWF9FVkVOVF9JUlEJCQkJMAorI2RlZmluZSAg
IE1JUElfR0VUX0lSUV9TVEFUMShkZXYpCQlrbWJfcmVhZF9taXBpKGRldiwgXAorCQkJCQkJTUlQ
SV9DVFJMX0lSUV9TVEFUVVMxKQorI2RlZmluZSBNSVBJX0NUUkxfSVJRX0VOQUJMRTAJCQkJKDB4
MDgpCisjZGVmaW5lICAgU0VUX01JUElfQ1RSTF9JUlFfRU5BQkxFMChkZXYsIE0sIE4pCWttYl9z
ZXRfYml0X21pcGkoZGV2LCBcCisJCQkJCQlNSVBJX0NUUkxfSVJRX0VOQUJMRTAsIFwKKwkJCQkJ
CShNKSArIChOKSkKKyNkZWZpbmUgICBNSVBJX0dFVF9JUlFfRU5BQkxFRDAoZGV2KQkJa21iX3Jl
YWRfbWlwaShkZXYsIFwKKwkJCQkJCU1JUElfQ1RSTF9JUlFfRU5BQkxFMCkKKyNkZWZpbmUgTUlQ
SV9DVFJMX0lSUV9FTkFCTEUxCQkJCSgweDBjKQorI2RlZmluZSAgIE1JUElfR0VUX0lSUV9FTkFC
TEVEMShkZXYpCQlrbWJfcmVhZF9taXBpKGRldiwgXAorCQkJCQkJTUlQSV9DVFJMX0lSUV9FTkFC
TEUxKQorI2RlZmluZSBNSVBJX0NUUkxfSVJRX0NMRUFSMAkJCQkoMHgwMTApCisjZGVmaW5lICAg
U0VUX01JUElfQ1RSTF9JUlFfQ0xFQVIwKGRldiwgTSwgTikJCVwKKwkJa21iX3NldF9iaXRfbWlw
aShkZXYsIE1JUElfQ1RSTF9JUlFfQ0xFQVIwLCAoTSkgKyAoTikpCisjZGVmaW5lIE1JUElfQ1RS
TF9JUlFfQ0xFQVIxCQkJCSgweDAxNCkKKyNkZWZpbmUgICBTRVRfTUlQSV9DVFJMX0lSUV9DTEVB
UjEoZGV2LCBNLCBOKQkJXAorCQlrbWJfc2V0X2JpdF9taXBpKGRldiwgTUlQSV9DVFJMX0lSUV9D
TEVBUjEsIChNKSArIChOKSkKKyNkZWZpbmUgTUlQSV9DVFJMX0RJR19MT09QQkFDSwkJCQkoMHgw
MTgpCisjZGVmaW5lIE1JUElfVFhfSFNfSVJRX1NUQVRVUwkJCQkoMHgwMWMpCisjZGVmaW5lICAg
TUlQSV9UWF9IU19JUlFfU1RBVFVTbShNKQkJKE1JUElfVFhfSFNfSVJRX1NUQVRVUyArIFwKKwkJ
CQkJCUhTX09GRlNFVChNKSkKKyNkZWZpbmUgICBHRVRfTUlQSV9UWF9IU19JUlFfU1RBVFVTKGRl
diwgTSkJa21iX3JlYWRfbWlwaShkZXYsIFwKKwkJCQkJCU1JUElfVFhfSFNfSVJRX1NUQVRVU20o
TSkpCisjZGVmaW5lICAgTUlQSV9UWF9IU19JUlFfTElORV9DT01QQVJFCQkJQklUKDEpCisjZGVm
aW5lICAgTUlQSV9UWF9IU19JUlFfRlJBTUVfRE9ORV8wCQkJQklUKDIpCisjZGVmaW5lICAgTUlQ
SV9UWF9IU19JUlFfRlJBTUVfRE9ORV8xCQkJQklUKDMpCisjZGVmaW5lICAgTUlQSV9UWF9IU19J
UlFfRlJBTUVfRE9ORV8yCQkJQklUKDQpCisjZGVmaW5lICAgTUlQSV9UWF9IU19JUlFfRlJBTUVf
RE9ORV8zCQkJQklUKDUpCisjZGVmaW5lICAgTUlQSV9UWF9IU19JUlFfRE1BX0RPTkVfMAkJCUJJ
VCg2KQorI2RlZmluZSAgIE1JUElfVFhfSFNfSVJRX0RNQV9JRExFXzAJCQlCSVQoNykKKyNkZWZp
bmUgICBNSVBJX1RYX0hTX0lSUV9ETUFfRE9ORV8xCQkJQklUKDgpCisjZGVmaW5lICAgTUlQSV9U
WF9IU19JUlFfRE1BX0lETEVfMQkJCUJJVCg5KQorI2RlZmluZSAgIE1JUElfVFhfSFNfSVJRX0RN
QV9ET05FXzIJCQlCSVQoMTApCisjZGVmaW5lICAgTUlQSV9UWF9IU19JUlFfRE1BX0lETEVfMgkJ
CUJJVCgxMSkKKyNkZWZpbmUgICBNSVBJX1RYX0hTX0lSUV9ETUFfRE9ORV8zCQkJQklUKDEyKQor
I2RlZmluZSAgIE1JUElfVFhfSFNfSVJRX0RNQV9JRExFXzMJCQlCSVQoMTMpCisjZGVmaW5lICAg
TUlQSV9UWF9IU19JUlFfTUNfRklGT19VTkRFUkZMT1cJCUJJVCgxNCkKKyNkZWZpbmUgICBNSVBJ
X1RYX0hTX0lSUV9NQ19GSUZPX09WRVJGTE9XCQlCSVQoMTUpCisjZGVmaW5lICAgTUlQSV9UWF9I
U19JUlFfTExQX0ZJRk9fRU1QVFkJCQlCSVQoMTYpCisjZGVmaW5lICAgTUlQSV9UWF9IU19JUlFf
TExQX1JFUVVFU1RfUVVFVUVfRlVMTAkJQklUKDE3KQorI2RlZmluZSAgIE1JUElfVFhfSFNfSVJR
X0xMUF9SRVFVRVNUX1FVRVVFX0VSUk9SCUJJVCgxOCkKKyNkZWZpbmUgICBNSVBJX1RYX0hTX0lS
UV9MTFBfV09SRF9DT1VOVF9FUlJPUgkJQklUKDIwKQorI2RlZmluZSAgIE1JUElfVFhfSFNfSVJR
X0ZSQU1FX0RPTkUJCQlcCisJCQkJKE1JUElfVFhfSFNfSVJRX0ZSQU1FX0RPTkVfMCB8IFwKKwkJ
CQlNSVBJX1RYX0hTX0lSUV9GUkFNRV9ET05FXzEgfCBcCisJCQkJTUlQSV9UWF9IU19JUlFfRlJB
TUVfRE9ORV8yIHwgXAorCQkJCU1JUElfVFhfSFNfSVJRX0ZSQU1FX0RPTkVfMykKKworI2RlZmlu
ZSBNSVBJX1RYX0hTX0lSUV9ETUFfRE9ORQkJCQlcCisJCQkJKE1JUElfVFhfSFNfSVJRX0RNQV9E
T05FXzAgfCBcCisJCQkJTUlQSV9UWF9IU19JUlFfRE1BX0RPTkVfMSB8IFwKKwkJCQlNSVBJX1RY
X0hTX0lSUV9ETUFfRE9ORV8yIHwgXAorCQkJCU1JUElfVFhfSFNfSVJRX0RNQV9ET05FXzMpCisK
KyNkZWZpbmUgTUlQSV9UWF9IU19JUlFfRE1BX0lETEUJCQkJXAorCQkJCShNSVBJX1RYX0hTX0lS
UV9ETUFfSURMRV8wIHwgXAorCQkJCU1JUElfVFhfSFNfSVJRX0RNQV9JRExFXzEgfCBcCisJCQkJ
TUlQSV9UWF9IU19JUlFfRE1BX0lETEVfMiB8IFwKKwkJCQlNSVBJX1RYX0hTX0lSUV9ETUFfSURM
RV8zKQorCisjZGVmaW5lIE1JUElfVFhfSFNfSVJRX0VSUk9SCQkJCVwKKwkJCQkoTUlQSV9UWF9I
U19JUlFfTUNfRklGT19VTkRFUkZMT1cgfCBcCisJCQkJTUlQSV9UWF9IU19JUlFfTUNfRklGT19P
VkVSRkxPVyB8IFwKKwkJCQlNSVBJX1RYX0hTX0lSUV9MTFBfRklGT19FTVBUWSB8IFwKKwkJCQlN
SVBJX1RYX0hTX0lSUV9MTFBfUkVRVUVTVF9RVUVVRV9GVUxMIHwgXAorCQkJCU1JUElfVFhfSFNf
SVJRX0xMUF9SRVFVRVNUX1FVRVVFX0VSUk9SIHwgXAorCQkJCU1JUElfVFhfSFNfSVJRX0xMUF9X
T1JEX0NPVU5UX0VSUk9SKQorCisjZGVmaW5lIE1JUElfVFhfSFNfSVJRX0FMTAkJCQlcCisJCQkJ
KE1JUElfVFhfSFNfSVJRX0ZSQU1FX0RPTkUgfCBcCisJCQkJTUlQSV9UWF9IU19JUlFfRE1BX0RP
TkUgfCBcCisJCQkJTUlQSV9UWF9IU19JUlFfRE1BX0lETEUgfCBcCisJCQkJTUlQSV9UWF9IU19J
UlFfTElORV9DT01QQVJFIHwgXAorCQkJCU1JUElfVFhfSFNfSVJRX0VSUk9SKQorCisjZGVmaW5l
IE1JUElfVFhfSFNfSVJRX0VOQUJMRQkJCQkoMHgwMjApCisjZGVmaW5lICAgU0VUX0hTX0lSUV9F
TkFCTEUoZGV2LCBNLCB2YWwpCWttYl9zZXRfYml0bWFza19taXBpKGRldiwgXAorCQkJCQkJTUlQ
SV9UWF9IU19JUlFfRU5BQkxFIFwKKwkJCQkJCSsgSFNfT0ZGU0VUKE0pLCB2YWwpCisjZGVmaW5l
ICAgQ0xSX0hTX0lSUV9FTkFCTEUoZGV2LCBNLCB2YWwpCWttYl9jbHJfYml0bWFza19taXBpKGRl
diwgXAorCQkJCQkJTUlQSV9UWF9IU19JUlFfRU5BQkxFIFwKKwkJCQkJCSsgSFNfT0ZGU0VUKE0p
LCB2YWwpCisjZGVmaW5lCSAgR0VUX0hTX0lSUV9FTkFCTEUoZGV2LCBNKQkJa21iX3JlYWRfbWlw
aShkZXYsIFwKKwkJCQkJCU1JUElfVFhfSFNfSVJRX0VOQUJMRSBcCisJCQkJCQkrIEhTX09GRlNF
VChNKSkKKyNkZWZpbmUgTUlQSV9UWF9IU19JUlFfQ0xFQVIJCQkJKDB4MDI0KQorI2RlZmluZSAg
IFNFVF9NSVBJX1RYX0hTX0lSUV9DTEVBUihkZXYsIE0sIHZhbCkJCVwKKwkJCWttYl9zZXRfYml0
bWFza19taXBpKGRldiwgXAorCQkJTUlQSV9UWF9IU19JUlFfQ0xFQVIgXAorCQkJKyBIU19PRkZT
RVQoTSksIHZhbCkKKworLyogTUlQSSBUZXN0IFBhdHRlcm4gR2VuZXJhdGlvbiAqLworI2RlZmlu
ZSBNSVBJX1RYX0hTX1RFU1RfUEFUX0NUUkwJCQkoMHgyMzApCisjZGVmaW5lICAgTUlQSV9UWG1f
SFNfVEVTVF9QQVRfQ1RSTChNKQkJCVwKKwkJCQkoTUlQSV9UWF9IU19URVNUX1BBVF9DVFJMICsg
SFNfT0ZGU0VUKE0pKQorI2RlZmluZSAgIFRQX0VOX1ZDbShNKQkJCQkJKDEgPDwgKChNKSAqIDB4
MDQpKQorI2RlZmluZSAgIFRQX1NFTF9WQ20oTSwgTikJCQkJXAorCQkJCSgoTikgPDwgKCgoTSkg
KiAweDA0KSArIDEpKQorI2RlZmluZSAgIFRQX1NUUklQRV9XSURUSChNKQkJCQkoKE0pIDw8IDE2
KQorI2RlZmluZSBNSVBJX1RYX0hTX1RFU1RfUEFUX0NPTE9SMAkJCSgweDIzNCkKKyNkZWZpbmUg
ICBNSVBJX1RYbV9IU19URVNUX1BBVF9DT0xPUjAoTSkJCVwKKwkJCQkoTUlQSV9UWF9IU19URVNU
X1BBVF9DT0xPUjAgKyBIU19PRkZTRVQoTSkpCisjZGVmaW5lIE1JUElfVFhfSFNfVEVTVF9QQVRf
Q09MT1IxCQkJKDB4MjM4KQorI2RlZmluZSAgIE1JUElfVFhtX0hTX1RFU1RfUEFUX0NPTE9SMShN
KQkJXAorCQkJCShNSVBJX1RYX0hTX1RFU1RfUEFUX0NPTE9SMSArIEhTX09GRlNFVChNKSkKKwor
LyogRC1QSFkgcmVncyAqLworI2RlZmluZSBEUEhZX0VOQUJMRQkJCQkoMHgxMDApCisjZGVmaW5l
IERQSFlfSU5JVF9DVFJMMAkJCQkoMHgxMDQpCisjZGVmaW5lICAgU0hVVERPV05aCQkJCTAKKyNk
ZWZpbmUgICBSRVNFVFoJCQkJMTIKKyNkZWZpbmUgRFBIWV9JTklUX0NUUkwxCQkJCSgweDEwOCkK
KyNkZWZpbmUgICBQTExfQ0xLU0VMXzAJCQkJMTgKKyNkZWZpbmUgICBQTExfU0hBRE9XX0NUUkwJ
CQkxNgorI2RlZmluZSBEUEhZX0lOSVRfQ1RSTDIJCQkJKDB4MTBjKQorI2RlZmluZSAgIFNFVF9E
UEhZX0lOSVRfQ1RSTDAoZGV2LCBkcGh5LCBvZmZzZXQpCVwKKwkJCWttYl9zZXRfYml0X21pcGko
ZGV2LCBEUEhZX0lOSVRfQ1RSTDAsIFwKKwkJCQkJKChkcGh5KSArIChvZmZzZXQpKSkKKyNkZWZp
bmUgICBDTFJfRFBIWV9JTklUX0NUUkwwKGRldiwgZHBoeSwgb2Zmc2V0KQlcCisJCQlrbWJfY2xy
X2JpdF9taXBpKGRldiwgRFBIWV9JTklUX0NUUkwwLCBcCisJCQkJCSgoZHBoeSkgKyAob2Zmc2V0
KSkpCisjZGVmaW5lIERQSFlfSU5JVF9DVFJMMgkJCQkoMHgxMGMpCisjZGVmaW5lIERQSFlfUExM
X09CUzAJCQkJKDB4MTEwKQorI2RlZmluZSBEUEhZX1BMTF9PQlMxCQkJCSgweDExNCkKKyNkZWZp
bmUgRFBIWV9QTExfT0JTMgkJCQkoMHgxMTgpCisjZGVmaW5lIERQSFlfRlJFUV9DVFJMMF8zCQkJ
KDB4MTFjKQorI2RlZmluZSBEUEhZX0ZSRVFfQ1RSTDRfNwkJCSgweDEyMCkKKyNkZWZpbmUgICBT
RVRfRFBIWV9GUkVRX0NUUkwwXzMoZGV2LCBkcGh5LCB2YWwpCVwKKwkJCWttYl93cml0ZV9iaXRz
X21pcGkoZGV2LCBEUEhZX0ZSRVFfQ1RSTDBfMyBcCisJCQkrICgoKGRwaHkpIC8gNCkgKiA0KSwg
KGRwaHkgJSA0KSAqIDgsIDYsIHZhbCkKKworI2RlZmluZSBEUEhZX0ZPUkNFX0NUUkwwCQkJKDB4
MTI4KQorI2RlZmluZSBEUEhZX0ZPUkNFX0NUUkwxCQkJKDB4MTJDKQorI2RlZmluZSBNSVBJX0RQ
SFlfU1RBVDBfMwkJCSgweDEzNCkKKyNkZWZpbmUgTUlQSV9EUEhZX1NUQVQ0XzcJCQkoMHgxMzgp
CisjZGVmaW5lCSAgR0VUX1NUT1BTVEFURV9EQVRBKGRldiwgZHBoeSkJCVwKKwkJCSgoKGttYl9y
ZWFkX21pcGkoZGV2LCBNSVBJX0RQSFlfU1RBVDBfMyArIFwKKwkJCQkJICgoZHBoeSkgLyA0KSAq
IDQpKSA+PiBcCisJCQkJCSAoKChkcGh5ICUgNCkgKiA4KSArIDQpKSAmIDB4MDMpCisKKyNkZWZp
bmUgTUlQSV9EUEhZX0VSUl9TVEFUNl83CQkJKDB4MTRDKQorCisjZGVmaW5lIERQSFlfVEVTVF9D
VFJMMAkJCQkoMHgxNTQpCisjZGVmaW5lICAgU0VUX0RQSFlfVEVTVF9DVFJMMChkZXYsIGRwaHkp
CQlcCisJCQlrbWJfc2V0X2JpdF9taXBpKGRldiwgRFBIWV9URVNUX0NUUkwwLCAoZHBoeSkpCisj
ZGVmaW5lICAgQ0xSX0RQSFlfVEVTVF9DVFJMMChkZXYsIGRwaHkpCQlcCisJCQlrbWJfY2xyX2Jp
dF9taXBpKGRldiwgRFBIWV9URVNUX0NUUkwwLCBcCisJCQkJCQkoZHBoeSkpCisjZGVmaW5lIERQ
SFlfVEVTVF9DVFJMMQkJCQkoMHgxNTgpCisjZGVmaW5lICAgU0VUX0RQSFlfVEVTVF9DVFJMMV9D
TEsoZGV2LCBkcGh5KQlcCisJCQlrbWJfc2V0X2JpdF9taXBpKGRldiwgRFBIWV9URVNUX0NUUkwx
LCAoZHBoeSkpCisjZGVmaW5lICAgQ0xSX0RQSFlfVEVTVF9DVFJMMV9DTEsoZGV2LCBkcGh5KQlc
CisJCQlrbWJfY2xyX2JpdF9taXBpKGRldiwgRFBIWV9URVNUX0NUUkwxLCAoZHBoeSkpCisjZGVm
aW5lICAgU0VUX0RQSFlfVEVTVF9DVFJMMV9FTihkZXYsIGRwaHkpCVwKKwkJCWttYl9zZXRfYml0
X21pcGkoZGV2LCBEUEhZX1RFU1RfQ1RSTDEsICgoZHBoeSkgKyAxMikpCisjZGVmaW5lICAgQ0xS
X0RQSFlfVEVTVF9DVFJMMV9FTihkZXYsIGRwaHkpCVwKKwkJCWttYl9jbHJfYml0X21pcGkoZGV2
LCBEUEhZX1RFU1RfQ1RSTDEsICgoZHBoeSkgKyAxMikpCisjZGVmaW5lIERQSFlfVEVTVF9ESU4w
XzMJCQkoMHgxNWMpCisjZGVmaW5lICAgU0VUX1RFU1RfRElOMF8zKGRldiwgZHBoeSwgdmFsKQkJ
XAorCQkJa21iX3dyaXRlX21pcGkoZGV2LCBEUEhZX1RFU1RfRElOMF8zICsgXAorCQkJNCwgKCh2
YWwpIDw8ICgoKGRwaHkpICUgNCkgKiA4KSkpCisjZGVmaW5lIERQSFlfVEVTVF9ET1VUMF8zCQkJ
KDB4MTY4KQorI2RlZmluZSAgIEdFVF9URVNUX0RPVVQwXzMoZGV2LCBkcGh5KQkJXAorCQkJKGtt
Yl9yZWFkX21pcGkoZGV2LCBEUEhZX1RFU1RfRE9VVDBfMykgXAorCQkJPj4gKCgoZHBoeSkgJSA0
KSAqIDgpICYgMHhmZikKKyNkZWZpbmUgRFBIWV9URVNUX0RPVVQ0XzcJCQkoMHgxNkMpCisjZGVm
aW5lICAgR0VUX1RFU1RfRE9VVDRfNyhkZXYsIGRwaHkpCQlcCisJCQkoa21iX3JlYWRfbWlwaShk
ZXYsIERQSFlfVEVTVF9ET1VUNF83KSBcCisJCQk+PiAoKChkcGh5KSAlIDQpICogOCkgJiAweGZm
KQorI2RlZmluZSBEUEhZX1RFU1RfRE9VVDhfOQkJCSgweDE3MCkKKyNkZWZpbmUgRFBIWV9URVNU
X0RJTjRfNwkJCSgweDE2MCkKKyNkZWZpbmUgRFBIWV9URVNUX0RJTjhfOQkJCSgweDE2NCkKKyNk
ZWZpbmUgRFBIWV9QTExfTE9DSwkJCQkoMHgxODgpCisjZGVmaW5lICAgR0VUX1BMTF9MT0NLKGRl
diwgZHBoeSkJCVwKKwkJCShrbWJfcmVhZF9taXBpKGRldiwgRFBIWV9QTExfTE9DSykgXAorCQkJ
JiAoMSA8PCAoKGRwaHkpIC0gTUlQSV9EUEhZNikpKQorI2RlZmluZSBEUEhZX0NGR19DTEtfRU4J
CQkJKDB4MThjKQorCisjZGVmaW5lIE1TU19NSVBJX0NJRl9DRkcJCQkoMHgwMCkKKyNkZWZpbmUg
TVNTX0xDRF9NSVBJX0NGRwkJCSgweDA0KQorI2RlZmluZSBNU1NfQ0FNX0NMS19DVFJMCQkJKDB4
MTApCisjZGVmaW5lIE1TU19MT09QQkFDS19DRkcJCQkoMHgwQykKKyNkZWZpbmUgICBMQ0QJCQkJ
CUJJVCgxKQorI2RlZmluZSAgIE1JUElfQ09NTU9OCQkJCUJJVCgyKQorI2RlZmluZSAgIE1JUElf
VFgwCQkJCUJJVCg5KQorI2RlZmluZSBNU1NfQ0FNX1JTVE5fQ1RSTAkJCSgweDE0KQorI2RlZmlu
ZSBNU1NfQ0FNX1JTVE5fU0VUCQkJKDB4MjApCisjZGVmaW5lIE1TU19DQU1fUlNUTl9DTFIJCQko
MHgyNCkKKworI2RlZmluZSBNU1NDUFVfQ1BSX0NMS19FTgkJCSgweDApCisjZGVmaW5lIE1TU0NQ
VV9DUFJfUlNUX0VOCQkJKDB4MTApCisjZGVmaW5lIEJJVF9NQVNLXzE2CQkJCSgweGZmZmYpCisv
KmljYW0gbGNkIHFvcyAqLworI2RlZmluZSBMQ0RfUU9TX1BSSU9SSVRZCQkJKDB4OCkKKyNkZWZp
bmUgTENEX1FPU19NT0RFCQkJCSgweEMpCisjZGVmaW5lIExDRF9RT1NfQlcJCQkJKDB4MTApCisj
ZW5kaWYgLyogX19LTUJfUkVHU19IX18gKi8KLS0gCjIuNy40CgpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1k
ZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcv
bWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWwK
