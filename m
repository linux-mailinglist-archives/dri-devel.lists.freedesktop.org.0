Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 38F8157CA2
	for <lists+dri-devel@lfdr.de>; Thu, 27 Jun 2019 09:01:24 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4E8566E5BC;
	Thu, 27 Jun 2019 07:01:20 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mga02.intel.com (mga02.intel.com [134.134.136.20])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0DFB06E5B7;
 Thu, 27 Jun 2019 07:01:18 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga006.jf.intel.com ([10.7.209.51])
 by orsmga101.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 27 Jun 2019 00:01:17 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,422,1557212400"; d="scan'208";a="167333022"
Received: from slisovsk-lenovo-ideapad-720s-13ikb.fi.intel.com
 ([10.237.66.154])
 by orsmga006.jf.intel.com with ESMTP; 27 Jun 2019 00:01:14 -0700
From: Stanislav Lisovskiy <stanislav.lisovskiy@intel.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v1 2/3] drm: Introduce change counter to drm_connector
Date: Thu, 27 Jun 2019 10:00:16 +0300
Message-Id: <20190627070016.7047-3-stanislav.lisovskiy@intel.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190627070016.7047-1-stanislav.lisovskiy@intel.com>
References: <20190627070016.7047-1-stanislav.lisovskiy@intel.com>
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: daniel.vetter@ffwll.ch, intel-gfx@lists.freedesktop.org,
 martin.peres@intel.com, Stanislav.Lisovskiy@intel.com, jani.saarinen@intel.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBjb3VudGVyIHdpbGwgYmUgdXNlZCBieSBkcm1faGVscGVyX3Byb2JlX2RldGVjdCBjYWxs
ZXIgdG8gZGV0ZXJtaW5lCmlmIHNvbWV0aGluZyBlbHNlIGhhZCBjaGFuZ2VkIGV4Y2VwdCBjb25u
ZWN0aW9uIHN0YXR1cywKbGlrZSBmb3IgZXhhbXBsZSBlZGlkLiBIYXJkd2FyZSBzcGVjaWZpYyBk
cml2ZXJzIGFyZSByZXNwb25zaWJsZQpmb3IgdXBkYXRpbmcgdGhpcyBjb3VudGVyIHdoZW4gc29t
ZSBjaGFuZ2UgaXMgZGV0ZWN0ZWQgdG8gbm90aWZ5CnRoZSBkcm0gcGFydCwgd2hpY2ggY2FuIHRy
aWdnZXIgZm9yIGV4YW1wbGUgaG90cGx1ZyBldmVudC4KCkN1cnJlbnRseSB0aGVyZSBpcyBubyB3
YXkgdG8gcHJvcGFnYXRlIHRoYXQgdG8gYSBjYWxsaW5nIGxheWVyLAphcyB3ZSBzZW5kIG9ubHkg
Y29ubmVjdGlvbl9zdGF0dXMgdXBkYXRlLCBob3dldmVyIGFzIHdlIHNlZSB3aXRoCmVkaWQgdGhl
IGNoYW5nZXMgY2FuIGJlIGJyb2FkZXIuCgpCdWd6aWxsYTogaHR0cHM6Ly9idWdzLmZyZWVkZXNr
dG9wLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTA1NTQwClNpZ25lZC1vZmYtYnk6IFN0YW5pc2xhdiBM
aXNvdnNraXkgPHN0YW5pc2xhdi5saXNvdnNraXlAaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1
L2RybS9kcm1fY29ubmVjdG9yLmMgICAgfCAgMSArCiBkcml2ZXJzL2dwdS9kcm0vZHJtX3Byb2Jl
X2hlbHBlci5jIHwgMjkgKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0KIGluY2x1ZGUvZHJt
L2RybV9jb25uZWN0b3IuaCAgICAgICAgfCAgMiArKwogMyBmaWxlcyBjaGFuZ2VkLCAzMCBpbnNl
cnRpb25zKCspLCAyIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9k
cm1fY29ubmVjdG9yLmMgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX2Nvbm5lY3Rvci5jCmluZGV4IDNj
Y2RjZjNkZmNkZS4uNTMxOTgzNzA3ZDdmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vZHJt
X2Nvbm5lY3Rvci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fY29ubmVjdG9yLmMKQEAgLTI0
NSw2ICsyNDUsNyBAQCBpbnQgZHJtX2Nvbm5lY3Rvcl9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYsCiAJSU5JVF9MSVNUX0hFQUQoJmNvbm5lY3Rvci0+bW9kZXMpOwogCW11dGV4X2luaXQoJmNv
bm5lY3Rvci0+bXV0ZXgpOwogCWNvbm5lY3Rvci0+ZWRpZF9ibG9iX3B0ciA9IE5VTEw7CisJY29u
bmVjdG9yLT5jaGFuZ2VfY291bnRlciA9IDA7CiAJY29ubmVjdG9yLT50aWxlX2Jsb2JfcHRyID0g
TlVMTDsKIAljb25uZWN0b3ItPnN0YXR1cyA9IGNvbm5lY3Rvcl9zdGF0dXNfdW5rbm93bjsKIAlj
b25uZWN0b3ItPmRpc3BsYXlfaW5mby5wYW5lbF9vcmllbnRhdGlvbiA9CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vZHJtX3Byb2JlX2hlbHBlci5jIGIvZHJpdmVycy9ncHUvZHJtL2RybV9w
cm9iZV9oZWxwZXIuYwppbmRleCBlZjJjNDY4MjA1YTIuLmU4ZjQxZmEzMzZjMyAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2RybV9wcm9iZV9oZWxwZXIuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vZHJtX3Byb2JlX2hlbHBlci5jCkBAIC03NzYsNiArNzc2LDcgQEAgYm9vbCBkcm1faGVscGVy
X2hwZF9pcnFfZXZlbnQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKIAlzdHJ1Y3QgZHJtX2Nvbm5l
Y3Rvcl9saXN0X2l0ZXIgY29ubl9pdGVyOwogCWVudW0gZHJtX2Nvbm5lY3Rvcl9zdGF0dXMgb2xk
X3N0YXR1czsKIAlib29sIGNoYW5nZWQgPSBmYWxzZTsKKwl1aW50NjRfdCBvbGRfY2hhbmdlX2Nv
dW50ZXI7CiAKIAlpZiAoIWRldi0+bW9kZV9jb25maWcucG9sbF9lbmFibGVkKQogCQlyZXR1cm4g
ZmFsc2U7CkBAIC03ODksMjAgKzc5MCw0NCBAQCBib29sIGRybV9oZWxwZXJfaHBkX2lycV9ldmVu
dChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQogCiAJCW9sZF9zdGF0dXMgPSBjb25uZWN0b3ItPnN0
YXR1czsKIAorCQlvbGRfY2hhbmdlX2NvdW50ZXIgPSBjb25uZWN0b3ItPmNoYW5nZV9jb3VudGVy
OworCisJCURSTV9ERUJVR19LTVMoIltDT05ORUNUT1I6JWQ6JXNdIE9sZCBjaGFuZ2UgY291bnRl
ciAlbGx1XG4iLCBjb25uZWN0b3ItPmJhc2UuaWQsCisJCQkgICAgICBjb25uZWN0b3ItPm5hbWUs
CisJCQkgICAgICBvbGRfY2hhbmdlX2NvdW50ZXIpOworCiAJCWNvbm5lY3Rvci0+c3RhdHVzID0g
ZHJtX2hlbHBlcl9wcm9iZV9kZXRlY3QoY29ubmVjdG9yLCBOVUxMLCBmYWxzZSk7CiAJCURSTV9E
RUJVR19LTVMoIltDT05ORUNUT1I6JWQ6JXNdIHN0YXR1cyB1cGRhdGVkIGZyb20gJXMgdG8gJXNc
biIsCiAJCQkgICAgICBjb25uZWN0b3ItPmJhc2UuaWQsCiAJCQkgICAgICBjb25uZWN0b3ItPm5h
bWUsCiAJCQkgICAgICBkcm1fZ2V0X2Nvbm5lY3Rvcl9zdGF0dXNfbmFtZShvbGRfc3RhdHVzKSwK
IAkJCSAgICAgIGRybV9nZXRfY29ubmVjdG9yX3N0YXR1c19uYW1lKGNvbm5lY3Rvci0+c3RhdHVz
KSk7Ci0JCWlmIChvbGRfc3RhdHVzICE9IGNvbm5lY3Rvci0+c3RhdHVzKQorCisJCURSTV9ERUJV
R19LTVMoIltDT05ORUNUT1I6JWQ6JXNdIE5ldyBjaGFuZ2UgY291bnRlciAlbGx1XG4iLAorCQkJ
ICAgICAgY29ubmVjdG9yLT5iYXNlLmlkLAorCQkJICAgICAgY29ubmVjdG9yLT5uYW1lLAorCQkJ
ICAgICAgY29ubmVjdG9yLT5jaGFuZ2VfY291bnRlcik7CisKKwkJaWYgKG9sZF9zdGF0dXMgIT0g
Y29ubmVjdG9yLT5zdGF0dXMpIHsKIAkJCWNoYW5nZWQgPSB0cnVlOworCQl9CisKKwkJLyogQ2hl
Y2sgY2hhbmdpbmcgb2YgZWRpZCB3aGVuIGEgY29ubmVjdG9yIHN0YXR1cyBzdGlsbCByZW1haW5z
CisJCSAqIGFzICJjb25uZWN0b3Jfc3RhdHVzX2Nvbm5lY3RlZCIuCisJCSAqLworCQlpZiAoY29u
bmVjdG9yLT5zdGF0dXMgPT0gY29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQgJiYKKwkJICAgIG9s
ZF9zdGF0dXMgPT0gY29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQgJiYKKwkJICAgIG9sZF9jaGFu
Z2VfY291bnRlciAhPSBjb25uZWN0b3ItPmNoYW5nZV9jb3VudGVyKSB7CisJCQljaGFuZ2VkID0g
dHJ1ZTsKKwkJfQogCX0KIAlkcm1fY29ubmVjdG9yX2xpc3RfaXRlcl9lbmQoJmNvbm5faXRlcik7
CiAJbXV0ZXhfdW5sb2NrKCZkZXYtPm1vZGVfY29uZmlnLm11dGV4KTsKIAotCWlmIChjaGFuZ2Vk
KQorCWlmIChjaGFuZ2VkKSB7CiAJCWRybV9rbXNfaGVscGVyX2hvdHBsdWdfZXZlbnQoZGV2KTsK
KwkJRFJNX0RFQlVHX0tNUygiU2VudCBob3RwbHVnIGV2ZW50XG4iKTsKKwl9CiAKIAlyZXR1cm4g
Y2hhbmdlZDsKIH0KZGlmZiAtLWdpdCBhL2luY2x1ZGUvZHJtL2RybV9jb25uZWN0b3IuaCBiL2lu
Y2x1ZGUvZHJtL2RybV9jb25uZWN0b3IuaAppbmRleCBjNmY4NDg2ZDhiOGYuLmZlYWE0ZWI2NzNm
NiAxMDA2NDQKLS0tIGEvaW5jbHVkZS9kcm0vZHJtX2Nvbm5lY3Rvci5oCisrKyBiL2luY2x1ZGUv
ZHJtL2RybV9jb25uZWN0b3IuaApAQCAtMTE1NSw2ICsxMTU1LDggQEAgc3RydWN0IGRybV9jb25u
ZWN0b3IgewogCS8qKiBAb3ZlcnJpZGVfZWRpZDogaGFzIHRoZSBFRElEIGJlZW4gb3ZlcndyaXR0
ZW4gdGhyb3VnaCBkZWJ1Z2ZzIGZvciB0ZXN0aW5nPyAqLwogCWJvb2wgb3ZlcnJpZGVfZWRpZDsK
IAorCXVpbnQ2NF90IGNoYW5nZV9jb3VudGVyOworCiAjZGVmaW5lIERSTV9DT05ORUNUT1JfTUFY
X0VOQ09ERVIgMwogCS8qKgogCSAqIEBlbmNvZGVyX2lkczogVmFsaWQgZW5jb2RlcnMgZm9yIHRo
aXMgY29ubmVjdG9yLiBQbGVhc2Ugb25seSB1c2UKLS0gCjIuMTcuMQoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApk
cmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Au
b3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
