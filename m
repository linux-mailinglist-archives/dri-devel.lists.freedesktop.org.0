Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 49AD3E4D11
	for <lists+dri-devel@lfdr.de>; Fri, 25 Oct 2019 15:57:38 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6EF706EA4A;
	Fri, 25 Oct 2019 13:57:36 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail.kernel.org (mail.kernel.org [198.145.29.99])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 490536EA4A;
 Fri, 25 Oct 2019 13:57:33 +0000 (UTC)
Received: from sasha-vm.mshome.net (c-73-47-72-35.hsd1.nh.comcast.net
 [73.47.72.35])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id 35487222C2;
 Fri, 25 Oct 2019 13:57:32 +0000 (UTC)
From: Sasha Levin <sashal@kernel.org>
To: linux-kernel@vger.kernel.org,
	stable@vger.kernel.org
Subject: [PATCH AUTOSEL 4.14 11/25] drm/msm: Use the correct dma_sync calls in
 msm_gem
Date: Fri, 25 Oct 2019 09:56:59 -0400
Message-Id: <20191025135715.25468-11-sashal@kernel.org>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20191025135715.25468-1-sashal@kernel.org>
References: <20191025135715.25468-1-sashal@kernel.org>
MIME-Version: 1.0
X-stable: review
X-Patchwork-Hint: Ignore
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=kernel.org; s=default; t=1572011853;
 bh=LjaXfOzXjbGolgL5lavCG74WEHxzKaRoSBWdDKMWtVk=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=0ih27qVApl+ccaZv/TklXD0Uk0csf2d1FPpVoTbPLXw6hn4JlGLSHOWjk+L/9ybmS
 KIfInF3ulY6s6oSKB4l/NndSHqubd3Yb0AVt9OwY+OxIZejYokCEhExL7jOay3CXCN
 jhOa6erAmybIbAudFHgcnTEe7Fa00w8SWF82s8+8=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Rob Clark <robdclark@chromium.org>, Sasha Levin <sashal@kernel.org>,
 Stephan Gerhold <stephan@gerhold.net>, linux-arm-msm@vger.kernel.org,
 dri-devel@lists.freedesktop.org, Sean Paul <seanpaul@chromium.org>,
 freedreno@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogUm9iIENsYXJrIDxyb2JkY2xhcmtAY2hyb21pdW0ub3JnPgoKWyBVcHN0cmVhbSBjb21t
aXQgM2RlNDMzYzViMzhhZjQ5YTVmYzc2MDI3MjFlMmFiNWQzOWYxZTY5YyBdCgpbc3ViamVjdCB3
YXM6IGRybS9tc206IHNoYWtlIGZpc3QgYW5ncmlseSBhdCBkbWEtbWFwcGluZ10KClNvLCB1c2lu
ZyBkbWFfc3luY18qIGZvciBvdXIgY2FjaGUgbmVlZHMgd29ya3Mgb3V0IHcvIGRtYSBpb21tdSBv
cHMsIGJ1dAppdCBmYWxscyBhcHBhcnQgd2l0aCBkbWEgZGlyZWN0IG9wcy4gIFRoZSBwcm9ibGVt
IGlzIHRoYXQsIGRlcGVuZGluZyBvbgpkaXNwbGF5IGdlbmVyYXRpb24sIHdlIGNhbiBoYXZlIGVp
dGhlciBzZXQgb2YgZG1hIG9wcyAobWRwNCBhbmQgZHB1IGhhdmUKaW9tbXUgd2lyZWQgdG8gbWRz
cyBub2RlLCB3aGljaCBtYXBzIHRvIHRvcGxldmVsIGRybSBkZXZpY2UsIGJ1dCBtZHA1CmhhcyBp
b21tdSB3aXJlZCB1cCB0byB0aGUgbWRwIHN1Yi1ub2RlIHdpdGhpbiBtZHNzKS4KCkZpeGVzIHRo
aXMgc3BsYXQgb24gbWRwNSBkZXZpY2VzOgoKICAgVW5hYmxlIHRvIGhhbmRsZSBrZXJuZWwgcGFn
aW5nIHJlcXVlc3QgYXQgdmlydHVhbCBhZGRyZXNzIGZmZmZmZmZmODAwMDAwMDAKICAgTWVtIGFi
b3J0IGluZm86CiAgICAgRVNSID0gMHg5NjAwMDE0NAogICAgIEV4Y2VwdGlvbiBjbGFzcyA9IERB
QlQgKGN1cnJlbnQgRUwpLCBJTCA9IDMyIGJpdHMKICAgICBTRVQgPSAwLCBGblYgPSAwCiAgICAg
RUEgPSAwLCBTMVBUVyA9IDAKICAgRGF0YSBhYm9ydCBpbmZvOgogICAgIElTViA9IDAsIElTUyA9
IDB4MDAwMDAxNDQKICAgICBDTSA9IDEsIFduUiA9IDEKICAgc3dhcHBlciBwZ3RhYmxlOiA0ayBw
YWdlcywgNDgtYml0IFZBcywgcGdkcD0wMDAwMDAwMDgxMGU0MDAwCiAgIFtmZmZmZmZmZjgwMDAw
MDAwXSBwZ2Q9MDAwMDAwMDAwMDAwMDAwMAogICBJbnRlcm5hbCBlcnJvcjogT29wczogOTYwMDAx
NDQgWyMxXSBTTVAKICAgTW9kdWxlcyBsaW5rZWQgaW46IGJ0cWNvbXNtZCBidHFjYSBibHVldG9v
dGggY2ZnODAyMTEgZWNkaF9nZW5lcmljIGVjYyByZmtpbGwgbGliYXJjNCBwYW5lbF9zaW1wbGUg
bXNtIHdjbnNzX2N0cmwgcXJ0cl9zbWQgZHJtX2ttc19oZWxwZXIgdmVudXNfZW5jIHZlbnVzX2Rl
YyB2aWRlb2J1ZjJfZG1hX3NnIHZpZGVvYnVmMl9tZW1vcHMgZHJtIHZlbnVzX2NvcmUgaXB2NiBx
cnRyIHFjb21fd2Nuc3NfcGlsIHY0bDJfbWVtMm1lbSBxY29tX3N5c21vbiB2aWRlb2J1ZjJfdjRs
MiBxbWlfaGVscGVycyB2aWRlb2J1ZjJfY29tbW9uIGNyY3QxMGRpZl9jZSBtZHRfbG9hZGVyIHFj
b21fY29tbW9uIHZpZGVvZGV2IHFjb21fZ2xpbmtfc21lbSByZW1vdGVwcm9jIGJtYzE1MF9hY2Nl
bF9pMmMgYm1jMTUwX21hZ25faTJjIGJtYzE1MF9hY2NlbF9jb3JlIGJtYzE1MF9tYWduIHNuZF9z
b2NfbHBhc3NfYXBxODAxNiBzbmRfc29jX21zbTg5MTZfYW5hbG9nIG1tczExNCBtYyBuZl9kZWZy
YWdfaXB2NiBzbmRfc29jX2xwYXNzX2NwdSBzbmRfc29jX2FwcTgwMTZfc2JjIGluZHVzdHJpYWxp
b190cmlnZ2VyZWRfYnVmZmVyIGtmaWZvX2J1ZiBzbmRfc29jX2xwYXNzX3BsYXRmb3JtIHNuZF9z
b2NfbXNtODkxNl9kaWdpdGFsIGRybV9wYW5lbF9vcmllbnRhdGlvbl9xdWlya3MKICAgQ1BVOiAy
IFBJRDogMzMgQ29tbToga3dvcmtlci8yOjEgTm90IHRhaW50ZWQgNS4zLjAtcmMyICMxCiAgIEhh
cmR3YXJlIG5hbWU6IFNhbXN1bmcgR2FsYXh5IEE1VSAoRVVSKSAoRFQpCiAgIFdvcmtxdWV1ZTog
ZXZlbnRzIGRlZmVycmVkX3Byb2JlX3dvcmtfZnVuYwogICBwc3RhdGU6IDgwMDAwMDA1IChOemN2
IGRhaWYgLVBBTiAtVUFPKQogICBwYyA6IF9fY2xlYW5fZGNhY2hlX2FyZWFfcG9jKzB4MjAvMHgz
OAogICBsciA6IGFyY2hfc3luY19kbWFfZm9yX2RldmljZSsweDI4LzB4MzAKICAgc3AgOiBmZmZm
MDAwMDExNTczNmEwCiAgIHgyOTogZmZmZjAwMDAxMTU3MzZhMCB4Mjg6IDAwMDAwMDAwMDAwMDAw
MDEKICAgeDI3OiBmZmZmODAwMDc0ODMwODAwIHgyNjogZmZmZjAwMDAxMTQ3ODAwMAogICB4MjU6
IDAwMDAwMDAwMDAwMDAwMDAgeDI0OiAwMDAwMDAwMDAwMDAwMDAxCiAgIHgyMzogZmZmZjAwMDAx
MTQ3OGE5OCB4MjI6IGZmZmY4MDAwMDlmZDFjMTAKICAgeDIxOiAwMDAwMDAwMDAwMDAwMDAxIHgy
MDogZmZmZjgwMDA3NWFkMGEwMAogICB4MTk6IDAwMDAwMDAwMDAwMDAwMDAgeDE4OiBmZmZmMDAw
MDExMmIyMDAwCiAgIHgxNzogMDAwMDAwMDAwMDAwMDAwMCB4MTY6IDAwMDAwMDAwMDAwMDAwMDAK
ICAgeDE1OiAwMDAwMDAwMGZmZmZmZmYwIHgxNDogZmZmZjAwMDAxMTQ1NWQ3MAogICB4MTM6IDAw
MDAwMDAwMDAwMDAwMDAgeDEyOiAwMDAwMDAwMDAwMDAwMDI4CiAgIHgxMTogMDAwMDAwMDAwMDAw
MDAwMSB4MTA6IGZmZmYwMDAwMTEwNmMwMDAKICAgeDkgOiBmZmZmN2UwMDAxZDZiMzgwIHg4IDog
MDAwMDAwMDAwMDAwMTAwMAogICB4NyA6IGZmZmY3ZTAwMDFkNmIzODAgeDYgOiBmZmZmN2UwMDAx
ZDZiMzgyCiAgIHg1IDogMDAwMDAwMDAwMDAwMDAwMCB4NCA6IDAwMDAwMDAwMDAwMDEwMDAKICAg
eDMgOiAwMDAwMDAwMDAwMDAwMDNmIHgyIDogMDAwMDAwMDAwMDAwMDA0MAogICB4MSA6IGZmZmZm
ZmZmODAwMDEwMDAgeDAgOiBmZmZmZmZmZjgwMDAwMDAwCiAgIENhbGwgdHJhY2U6CiAgICBfX2Ns
ZWFuX2RjYWNoZV9hcmVhX3BvYysweDIwLzB4MzgKICAgIGRtYV9kaXJlY3Rfc3luY19zZ19mb3Jf
ZGV2aWNlKzB4YjgvMHhlOAogICAgZ2V0X3BhZ2VzKzB4MjJjLzB4MjUwIFttc21dCiAgICBtc21f
Z2VtX2dldF9hbmRfcGluX2lvdmErMHhkYy8weDE2OCBbbXNtXQogICAgLi4uCgpGaXhlcyB0aGUg
Y29tYmluYXRpb24gb2YgdHdvIHBhdGNoZXM6CgpGaXhlczogMDAzNmJjNzNjY2JlIChkcm0vbXNt
OiBzdG9wIGFidXNpbmcgZG1hX21hcC91bm1hcCBmb3IgY2FjaGUpCkZpeGVzOiA0NDlmYTU0ZDY4
MTUgKGRtYS1kaXJlY3Q6IGNvcnJlY3QgdGhlIHBoeXNpY2FsIGFkZHIgaW4gZG1hX2RpcmVjdF9z
eW5jX3NnX2Zvcl9jcHUvZGV2aWNlKQpUZXN0ZWQtYnk6IFN0ZXBoYW4gR2VyaG9sZCA8c3RlcGhh
bkBnZXJob2xkLm5ldD4KU2lnbmVkLW9mZi1ieTogUm9iIENsYXJrIDxyb2JkY2xhcmtAY2hyb21p
dW0ub3JnPgpbc2VhbnBhdWwgY2hhbmdlZCBzdWJqZWN0IHRvIHNvbWV0aGluZyBtb3JlIGRlc3Jp
cHRpdmVdClNpZ25lZC1vZmYtYnk6IFNlYW4gUGF1bCA8c2VhbnBhdWxAY2hyb21pdW0ub3JnPgpM
aW5rOiBodHRwczovL3BhdGNod29yay5mcmVlZGVza3RvcC5vcmcvcGF0Y2gvbXNnaWQvMjAxOTA3
MzAyMTQ2MzMuMTc4MjAtMS1yb2JkY2xhcmtAZ21haWwuY29tClNpZ25lZC1vZmYtYnk6IFNhc2hh
IExldmluIDxzYXNoYWxAa2VybmVsLm9yZz4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vbXNtL21zbV9n
ZW0uYyB8IDQ3ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystLS0tCiAxIGZpbGUgY2hh
bmdlZCwgNDIgaW5zZXJ0aW9ucygrKSwgNSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vbXNtL21zbV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vbXNtX2dlbS5j
CmluZGV4IDNhOTFjY2Q5MmM0NzMuLjMwMGM0NjI0YWE2YzAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9tc20vbXNtX2dlbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vbXNtX2dlbS5j
CkBAIC00Myw2ICs0Myw0NiBAQCBzdGF0aWMgYm9vbCB1c2VfcGFnZXMoc3RydWN0IGRybV9nZW1f
b2JqZWN0ICpvYmopCiAJcmV0dXJuICFtc21fb2JqLT52cmFtX25vZGU7CiB9CiAKKy8qCisgKiBD
YWNoZSBzeW5jLi4gdGhpcyBpcyBhIGJpdCBvdmVyLWNvbXBsaWNhdGVkLCB0byBmaXQgZG1hLW1h
cHBpbmcKKyAqIEFQSS4gIFJlYWxseSBHUFUgY2FjaGUgaXMgb3V0IG9mIHNjb3BlIGhlcmUgKGhh
bmRsZWQgb24gY21kc3RyZWFtKQorICogYW5kIGFsbCB3ZSBuZWVkIHRvIGRvIGlzIGludmFsaWRh
dGUgbmV3bHkgYWxsb2NhdGVkIHBhZ2VzIGJlZm9yZQorICogbWFwcGluZyB0byBDUFUgYXMgdW5j
YWNoZWQvd3JpdGVjb21iaW5lLgorICoKKyAqIE9uIHRvcCBvZiB0aGlzLCB3ZSBoYXZlIHRoZSBh
ZGRlZCBoZWFkYWNoZSwgdGhhdCBkZXBlbmRpbmcgb24KKyAqIGRpc3BsYXkgZ2VuZXJhdGlvbiwg
dGhlIGRpc3BsYXkncyBpb21tdSBtYXkgYmUgd2lyZWQgdXAgdG8gZWl0aGVyCisgKiB0aGUgdG9w
bGV2ZWwgZHJtIGRldmljZSAobWRzcyksIG9yIHRvIHRoZSBtZHAgc3ViLW5vZGUsIG1lYW5pbmcK
KyAqIHRoYXQgaGVyZSB3ZSBlaXRoZXIgaGF2ZSBkbWEtZGlyZWN0IG9yIGlvbW11IG9wcy4KKyAq
CisgKiBMZXQgdGhpcyBiZSBhIGNhdXRpb25hcnkgdGFpbCBvZiBhYnN0cmFjdGlvbiBnb25lIHdy
b25nLgorICovCisKK3N0YXRpYyB2b2lkIHN5bmNfZm9yX2RldmljZShzdHJ1Y3QgbXNtX2dlbV9v
YmplY3QgKm1zbV9vYmopCit7CisJc3RydWN0IGRldmljZSAqZGV2ID0gbXNtX29iai0+YmFzZS5k
ZXYtPmRldjsKKworCWlmIChnZXRfZG1hX29wcyhkZXYpKSB7CisJCWRtYV9zeW5jX3NnX2Zvcl9k
ZXZpY2UoZGV2LCBtc21fb2JqLT5zZ3QtPnNnbCwKKwkJCW1zbV9vYmotPnNndC0+bmVudHMsIERN
QV9CSURJUkVDVElPTkFMKTsKKwl9IGVsc2UgeworCQlkbWFfbWFwX3NnKGRldiwgbXNtX29iai0+
c2d0LT5zZ2wsCisJCQltc21fb2JqLT5zZ3QtPm5lbnRzLCBETUFfQklESVJFQ1RJT05BTCk7CisJ
fQorfQorCitzdGF0aWMgdm9pZCBzeW5jX2Zvcl9jcHUoc3RydWN0IG1zbV9nZW1fb2JqZWN0ICpt
c21fb2JqKQoreworCXN0cnVjdCBkZXZpY2UgKmRldiA9IG1zbV9vYmotPmJhc2UuZGV2LT5kZXY7
CisKKwlpZiAoZ2V0X2RtYV9vcHMoZGV2KSkgeworCQlkbWFfc3luY19zZ19mb3JfY3B1KGRldiwg
bXNtX29iai0+c2d0LT5zZ2wsCisJCQltc21fb2JqLT5zZ3QtPm5lbnRzLCBETUFfQklESVJFQ1RJ
T05BTCk7CisJfSBlbHNlIHsKKwkJZG1hX3VubWFwX3NnKGRldiwgbXNtX29iai0+c2d0LT5zZ2ws
CisJCQltc21fb2JqLT5zZ3QtPm5lbnRzLCBETUFfQklESVJFQ1RJT05BTCk7CisJfQorfQorCiAv
KiBhbGxvY2F0ZSBwYWdlcyBmcm9tIFZSQU0gY2FydmVvdXQsIHVzZWQgd2hlbiBubyBJT01NVTog
Ki8KIHN0YXRpYyBzdHJ1Y3QgcGFnZSAqKmdldF9wYWdlc192cmFtKHN0cnVjdCBkcm1fZ2VtX29i
amVjdCAqb2JqLCBpbnQgbnBhZ2VzKQogewpAQCAtMTA4LDggKzE0OCw3IEBAIHN0YXRpYyBzdHJ1
Y3QgcGFnZSAqKmdldF9wYWdlcyhzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iaikKIAkJICogYmVj
YXVzZSBkaXNwbGF5IGNvbnRyb2xsZXIsIEdQVSwgZXRjLiBhcmUgbm90IGNvaGVyZW50OgogCQkg
Ki8KIAkJaWYgKG1zbV9vYmotPmZsYWdzICYgKE1TTV9CT19XQ3xNU01fQk9fVU5DQUNIRUQpKQot
CQkJZG1hX3N5bmNfc2dfZm9yX2RldmljZShkZXYtPmRldiwgbXNtX29iai0+c2d0LT5zZ2wsCi0J
CQkJCW1zbV9vYmotPnNndC0+bmVudHMsIERNQV9CSURJUkVDVElPTkFMKTsKKwkJCXN5bmNfZm9y
X2RldmljZShtc21fb2JqKTsKIAl9CiAKIAlyZXR1cm4gbXNtX29iai0+cGFnZXM7CkBAIC0xMzgs
OSArMTc3LDcgQEAgc3RhdGljIHZvaWQgcHV0X3BhZ2VzKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAq
b2JqKQogCQkJICogR1BVLCBldGMuIGFyZSBub3QgY29oZXJlbnQ6CiAJCQkgKi8KIAkJCWlmICht
c21fb2JqLT5mbGFncyAmIChNU01fQk9fV0N8TVNNX0JPX1VOQ0FDSEVEKSkKLQkJCQlkbWFfc3lu
Y19zZ19mb3JfY3B1KG9iai0+ZGV2LT5kZXYsIG1zbV9vYmotPnNndC0+c2dsLAotCQkJCQkgICAg
IG1zbV9vYmotPnNndC0+bmVudHMsCi0JCQkJCSAgICAgRE1BX0JJRElSRUNUSU9OQUwpOworCQkJ
CXN5bmNfZm9yX2NwdShtc21fb2JqKTsKIAogCQkJc2dfZnJlZV90YWJsZShtc21fb2JqLT5zZ3Qp
OwogCQkJa2ZyZWUobXNtX29iai0+c2d0KTsKLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmkt
ZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
L21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
