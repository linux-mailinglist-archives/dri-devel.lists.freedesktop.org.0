Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 543CDA327E
	for <lists+dri-devel@lfdr.de>; Fri, 30 Aug 2019 10:31:39 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 77F036E2C4;
	Fri, 30 Aug 2019 08:31:16 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from inva020.nxp.com (inva020.nxp.com [92.121.34.13])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 84C076E0A0
 for <dri-devel@lists.freedesktop.org>; Thu, 29 Aug 2019 11:30:30 +0000 (UTC)
Received: from inva020.nxp.com (localhost [127.0.0.1])
 by inva020.eu-rdc02.nxp.com (Postfix) with ESMTP id 3CEE91A0149;
 Thu, 29 Aug 2019 13:30:29 +0200 (CEST)
Received: from inva024.eu-rdc02.nxp.com (inva024.eu-rdc02.nxp.com
 [134.27.226.22])
 by inva020.eu-rdc02.nxp.com (Postfix) with ESMTP id 38FC11A0010;
 Thu, 29 Aug 2019 13:30:29 +0200 (CEST)
Received: from fsr-ub1664-120.ea.freescale.net
 (fsr-ub1664-120.ea.freescale.net [10.171.82.81])
 by inva024.eu-rdc02.nxp.com (Postfix) with ESMTP id 48E9720613;
 Thu, 29 Aug 2019 13:30:28 +0200 (CEST)
From: Robert Chiras <robert.chiras@nxp.com>
To: =?UTF-8?q?Guido=20G=C3=BCnther?= <agx@sigxcpu.org>,
 Marek Vasut <marex@denx.de>, Stefan Agner <stefan@agner.ch>,
 David Airlie <airlied@linux.ie>, Daniel Vetter <daniel@ffwll.ch>,
 Rob Herring <robh+dt@kernel.org>, Mark Rutland <mark.rutland@arm.com>,
 Shawn Guo <shawnguo@kernel.org>, Sascha Hauer <s.hauer@pengutronix.de>,
 Fabio Estevam <festevam@gmail.com>
Subject: [PATCH v4 13/14] drm/mxsfb: Add support for horizontal stride
Date: Thu, 29 Aug 2019 14:30:14 +0300
Message-Id: <1567078215-31601-14-git-send-email-robert.chiras@nxp.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1567078215-31601-1-git-send-email-robert.chiras@nxp.com>
References: <1567078215-31601-1-git-send-email-robert.chiras@nxp.com>
MIME-Version: 1.0
X-Virus-Scanned: ClamAV using ClamSMTP
X-Mailman-Approved-At: Fri, 30 Aug 2019 08:29:17 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: devicetree@vger.kernel.org, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, NXP Linux Team <linux-imx@nxp.com>,
 Pengutronix Kernel Team <kernel@pengutronix.de>,
 linux-arm-kernel@lists.infradead.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QmVzaWRlcyB0aGUgZUxDRElGIGJsb2NrLCB0aGVyZSBpcyBhbm90aGVyIElQIGJsb2NrLCB1c2Vk
IGluIHRoZSBwYXN0CmZvciBFUERDIHBhbmVscy4gU2luY2UgdGhlIGlNWC44bXEgZG9lc24ndCBo
YXZlIGFuIEVQREMgY29ubmVjdG9yLCB0aGlzCmJsb2NrIGlzIG5vdCBkb2N1bWVudGVkLCBidXQg
d2UgY2FuIHVzZSBpdCB0byBkbyBhZGRpdGlvbmFsIG9wZXJhdGlvbnMKb24gdGhlIGZyYW1lIGJ1
ZmZlci4KSW4gdGhpcyBjYXNlLCB3ZSBjYW4gdXNlIHRoZSBwaWdlb24gcmVnaXN0ZXJzIGZyb20g
dGhpcyBJUCBibG9jayBpbgpvcmRlciB0byBkbyBob3Jpem9udGFsIGNyb3Agb24gdGhlIGZyYW1l
IGJ1ZmZlciBwcm9jZXNzZWQgYnkgdGhlIGVMQ0RJRgpibG9jay4KClNpZ25lZC1vZmYtYnk6IFJv
YmVydCBDaGlyYXMgPHJvYmVydC5jaGlyYXNAbnhwLmNvbT4KVGVzdGVkLWJ5OiBHdWlkbyBHw7xu
dGhlciA8YWd4QHNpZ3hjcHUub3JnPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9teHNmYi9teHNmYl9j
cnRjLmMgfCA3OSArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystLQogZHJpdmVy
cy9ncHUvZHJtL214c2ZiL214c2ZiX2Rydi5jICB8ICAxICsKIGRyaXZlcnMvZ3B1L2RybS9teHNm
Yi9teHNmYl9yZWdzLmggfCAxNiArKysrKysrKwogMyBmaWxlcyBjaGFuZ2VkLCA5MiBpbnNlcnRp
b25zKCspLCA0IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9teHNm
Yi9teHNmYl9jcnRjLmMgYi9kcml2ZXJzL2dwdS9kcm0vbXhzZmIvbXhzZmJfY3J0Yy5jCmluZGV4
IGExMmY1M2QuLjMxNzU3NWUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9teHNmYi9teHNm
Yl9jcnRjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX2NydGMuYwpAQCAtMTUs
NiArMTUsNyBAQAogCiAjaW5jbHVkZSA8dmlkZW8vdmlkZW9tb2RlLmg+CiAKKyNpbmNsdWRlIDxk
cm0vZHJtX2F0b21pYy5oPgogI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljX2hlbHBlci5oPgogI2lu
Y2x1ZGUgPGRybS9kcm1fY3J0Yy5oPgogI2luY2x1ZGUgPGRybS9kcm1fZmJfY21hX2hlbHBlci5o
PgpAQCAtNDM1LDEzICs0MzYsNjYgQEAgdm9pZCBteHNmYl9jcnRjX2Rpc2FibGUoc3RydWN0IG14
c2ZiX2RybV9wcml2YXRlICpteHNmYikKIAljbGtfZGlzYWJsZV91bnByZXBhcmUobXhzZmItPmNs
a19heGkpOwogfQogCit2b2lkIG14c2ZiX3NldF9mYl9oY3JvcChzdHJ1Y3QgbXhzZmJfZHJtX3By
aXZhdGUgKm14c2ZiLCB1MzIgc3JjX3csIHUzMiBmYl93KQoreworCXUzMiBtYXNrX2NudCwgaHRv
dGFsLCBoY291bnQ7CisJdTMyIHZkY3RybDIsIHZkY3RybDMsIHZkY3RybDQsIHRyYW5zZmVyX2Nv
dW50OworCXUzMiBwaWdlb25fMTJfMCwgcGlnZW9uXzEyXzEsIHBpZ2Vvbl8xMl8yOworCisJaWYg
KHNyY193ID09IGZiX3cpIHsKKwkJd3JpdGVsKDB4MCwgbXhzZmItPmJhc2UgKyBIV19FUERDX1BJ
R0VPTl8xMl8wKTsKKwkJd3JpdGVsKDB4MCwgbXhzZmItPmJhc2UgKyBIV19FUERDX1BJR0VPTl8x
Ml8xKTsKKworCQlyZXR1cm47CisJfQorCisJdHJhbnNmZXJfY291bnQgPSByZWFkbChteHNmYi0+
YmFzZSArIExDRENfVjRfVFJBTlNGRVJfQ09VTlQpOworCWhjb3VudCA9IFRSQU5TRkVSX0NPVU5U
X0dFVF9IQ09VTlQodHJhbnNmZXJfY291bnQpOworCisJdHJhbnNmZXJfY291bnQgJj0gflRSQU5T
RkVSX0NPVU5UX1NFVF9IQ09VTlQoMHhmZmZmKTsKKwl0cmFuc2Zlcl9jb3VudCB8PSBUUkFOU0ZF
Ul9DT1VOVF9TRVRfSENPVU5UKGZiX3cpOworCXdyaXRlbCh0cmFuc2Zlcl9jb3VudCwgbXhzZmIt
PmJhc2UgKyBMQ0RDX1Y0X1RSQU5TRkVSX0NPVU5UKTsKKworCXZkY3RybDIgPSByZWFkbChteHNm
Yi0+YmFzZSArIExDRENfVkRDVFJMMik7CisJaHRvdGFsICA9IFZEQ1RSTDJfR0VUX0hTWU5DX1BF
UklPRCh2ZGN0cmwyKTsKKwlodG90YWwgICs9IGZiX3cgLSBoY291bnQ7CisJdmRjdHJsMiAmPSB+
VkRDVFJMMl9TRVRfSFNZTkNfUEVSSU9EKDB4M2ZmZmYpOworCXZkY3RybDIgfD0gVkRDVFJMMl9T
RVRfSFNZTkNfUEVSSU9EKGh0b3RhbCk7CisJd3JpdGVsKHZkY3RybDIsIG14c2ZiLT5iYXNlICsg
TENEQ19WRENUUkwyKTsKKworCXZkY3RybDQgPSByZWFkbChteHNmYi0+YmFzZSArIExDRENfVkRD
VFJMNCk7CisJdmRjdHJsNCAmPSB+U0VUX0RPVENMS19IX1ZBTElEX0RBVEFfQ05UKDB4M2ZmZmYp
OworCXZkY3RybDQgfD0gU0VUX0RPVENMS19IX1ZBTElEX0RBVEFfQ05UKGZiX3cpOworCXdyaXRl
bCh2ZGN0cmw0LCBteHNmYi0+YmFzZSArIExDRENfVkRDVFJMNCk7CisKKwkvKiBjb25maWd1cmUg
cmVsYXRlZCBwaWdlb24gcmVnaXN0ZXJzICovCisJdmRjdHJsMyAgPSByZWFkbChteHNmYi0+YmFz
ZSArIExDRENfVkRDVFJMMyk7CisJbWFza19jbnQgPSBHRVRfSE9SX1dBSVRfQ05UKHZkY3RybDMp
IC0gNTsKKworCXBpZ2Vvbl8xMl8wID0gUElHRU9OXzEyXzBfU0VUX1NUQVRFX01BU0soMHgyNCkJ
CXwKKwkJICAgICAgUElHRU9OXzEyXzBfU0VUX01BU0tfQ05UKG1hc2tfY250KQl8CisJCSAgICAg
IFBJR0VPTl8xMl8wX1NFVF9NQVNLX0NOVF9TRUwoMHg2KQkJfAorCQkgICAgICBQSUdFT05fMTJf
MF9QT0xfQUNUSVZFX0xPVwkJfAorCQkgICAgICBQSUdFT05fMTJfMF9FTjsKKwl3cml0ZWwocGln
ZW9uXzEyXzAsIG14c2ZiLT5iYXNlICsgSFdfRVBEQ19QSUdFT05fMTJfMCk7CisKKwlwaWdlb25f
MTJfMSA9IFBJR0VPTl8xMl8xX1NFVF9DTFJfQ05UKHNyY193KSB8CisJCSAgICAgIFBJR0VPTl8x
Ml8xX1NFVF9TRVRfQ05UKDB4MCk7CisJd3JpdGVsKHBpZ2Vvbl8xMl8xLCBteHNmYi0+YmFzZSAr
IEhXX0VQRENfUElHRU9OXzEyXzEpOworCisJcGlnZW9uXzEyXzIgPSAweDA7CisJd3JpdGVsKHBp
Z2Vvbl8xMl8yLCBteHNmYi0+YmFzZSArIEhXX0VQRENfUElHRU9OXzEyXzIpOworfQorCiB2b2lk
IG14c2ZiX3BsYW5lX2F0b21pY191cGRhdGUoc3RydWN0IG14c2ZiX2RybV9wcml2YXRlICpteHNm
YiwKIAkJCSAgICAgICBzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpzdGF0ZSkKIHsKIAlzdHJ1Y3Qg
ZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGUgKnBpcGUgPSAmbXhzZmItPnBpcGU7CiAJc3RydWN0IGRy
bV9jcnRjICpjcnRjID0gJnBpcGUtPmNydGM7CisJc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqbmV3
X3N0YXRlID0gcGlwZS0+cGxhbmUuc3RhdGU7CisJc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIg
PSBwaXBlLT5wbGFuZS5zdGF0ZS0+ZmI7CiAJc3RydWN0IGRybV9wZW5kaW5nX3ZibGFua19ldmVu
dCAqZXZlbnQ7Ci0JZG1hX2FkZHJfdCBwYWRkcjsKKwl1MzIgZmJfYWRkciwgc3JjX29mZiwgc3Jj
X3csIHN0cmlkZSwgY3BwID0gMDsKIAogCXNwaW5fbG9ja19pcnEoJmNydGMtPmRldi0+ZXZlbnRf
bG9jayk7CiAJZXZlbnQgPSBjcnRjLT5zdGF0ZS0+ZXZlbnQ7CkBAIC00NTYsMTAgKzUxMCwyNyBA
QCB2b2lkIG14c2ZiX3BsYW5lX2F0b21pY191cGRhdGUoc3RydWN0IG14c2ZiX2RybV9wcml2YXRl
ICpteHNmYiwKIAl9CiAJc3Bpbl91bmxvY2tfaXJxKCZjcnRjLT5kZXYtPmV2ZW50X2xvY2spOwog
Ci0JcGFkZHIgPSBteHNmYl9nZXRfZmJfcGFkZHIobXhzZmIpOwotCWlmIChwYWRkcikgeworCWlm
ICghZmIpCisJCXJldHVybjsKKworCWZiX2FkZHIgPSBteHNmYl9nZXRfZmJfcGFkZHIobXhzZmIp
OworCWlmIChteHNmYi0+ZGV2ZGF0YS0+aXB2ZXJzaW9uID49IDQpIHsKKwkJY3BwID0gZmItPmZv
cm1hdC0+Y3BwWzBdOworCQlzcmNfb2ZmID0gKG5ld19zdGF0ZS0+c3JjX3kgPj4gMTYpICogZmIt
PnBpdGNoZXNbMF0gKworCQkJICAobmV3X3N0YXRlLT5zcmNfeCA+PiAxNikgKiBjcHA7CisJCWZi
X2FkZHIgKz0gZmItPm9mZnNldHNbMF0gKyBzcmNfb2ZmOworCX0KKworCWlmIChmYl9hZGRyKSB7
CiAJCWNsa19wcmVwYXJlX2VuYWJsZShteHNmYi0+Y2xrX2F4aSk7Ci0JCXdyaXRlbChwYWRkciwg
bXhzZmItPmJhc2UgKyBteHNmYi0+ZGV2ZGF0YS0+bmV4dF9idWYpOworCQl3cml0ZWwoZmJfYWRk
ciwgbXhzZmItPmJhc2UgKyBteHNmYi0+ZGV2ZGF0YS0+bmV4dF9idWYpOwogCQljbGtfZGlzYWJs
ZV91bnByZXBhcmUobXhzZmItPmNsa19heGkpOwogCX0KKworCWlmIChteHNmYi0+ZGV2ZGF0YS0+
aXB2ZXJzaW9uID49IDQgJiYKKwkgICAgdW5saWtlbHkoZHJtX2F0b21pY19jcnRjX25lZWRzX21v
ZGVzZXQobmV3X3N0YXRlLT5jcnRjLT5zdGF0ZSkpKSB7CisJCXN0cmlkZSA9IERJVl9ST1VORF9V
UChmYi0+cGl0Y2hlc1swXSwgY3BwKTsKKwkJc3JjX3cgPSBuZXdfc3RhdGUtPnNyY193ID4+IDE2
OworCQlteHNmYl9zZXRfZmJfaGNyb3AobXhzZmIsIHNyY193LCBzdHJpZGUpOworCX0KIH0KZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9teHNmYi9teHNmYl9kcnYuYyBiL2RyaXZlcnMvZ3B1
L2RybS9teHNmYi9teHNmYl9kcnYuYwppbmRleCA4ODhiNTIwLi4wNmQzYmYwIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vbXhzZmIvbXhzZmJfZHJ2LmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L214c2ZiL214c2ZiX2Rydi5jCkBAIC0xMzMsNiArMTMzLDcgQEAgc3RhdGljIGludCBteHNmYl9h
dG9taWNfaGVscGVyX2NoZWNrKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJCWlmIChvbGRfYnBw
ICE9IG5ld19icHApCiAJCQluZXdfc3RhdGUtPm1vZGVfY2hhbmdlZCA9IHRydWU7CiAJfQorCiAJ
cmV0dXJuIHJldDsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2Zi
X3JlZ3MuaCBiL2RyaXZlcnMvZ3B1L2RybS9teHNmYi9teHNmYl9yZWdzLmgKaW5kZXggMGY2M2Jh
MS4uZGYzMjc5YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX3JlZ3Mu
aAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbXhzZmIvbXhzZmJfcmVncy5oCkBAIC0xNDUsNiArMTQ1
LDIyIEBACiAjZGVmaW5lIERFQlVHMF9IU1lOQwkJCUJJVCgyNikKICNkZWZpbmUgREVCVUcwX1ZT
WU5DCQkJQklUKDI1KQogCisvKiBwaWdlb24gcmVnaXN0ZXJzIGZvciBjcm9wICovCisjZGVmaW5l
IEhXX0VQRENfUElHRU9OXzEyXzAJCTB4YjAwCisjZGVmaW5lIEhXX0VQRENfUElHRU9OXzEyXzEJ
CTB4YjEwCisjZGVmaW5lIEhXX0VQRENfUElHRU9OXzEyXzIJCTB4YjIwCisKKyNkZWZpbmUgUElH
RU9OXzEyXzBfU0VUX1NUQVRFX01BU0soeCkJUkVHX1BVVCgoeCksIDMxLCAyNCkKKyNkZWZpbmUg
UElHRU9OXzEyXzBfU0VUX01BU0tfQ05UKHgpCVJFR19QVVQoKHgpLCAyMywgMTIpCisjZGVmaW5l
IFBJR0VPTl8xMl8wX1NFVF9NQVNLX0NOVF9TRUwoeCkJUkVHX1BVVCgoeCksIDExLCAgOCkKKyNk
ZWZpbmUgUElHRU9OXzEyXzBfU0VUX09GRlNFVCh4KQlSRUdfUFVUKCh4KSwgIDcsICA0KQorI2Rl
ZmluZSBQSUdFT05fMTJfMF9TRVRfSU5DX1NFTCh4KQlSRUdfUFVUKCh4KSwgIDMsICAyKQorI2Rl
ZmluZSBQSUdFT05fMTJfMF9QT0xfQUNUSVZFX0xPVwlCSVQoMSkKKyNkZWZpbmUgUElHRU9OXzEy
XzBfRU4JCQlCSVQoMCkKKworI2RlZmluZSBQSUdFT05fMTJfMV9TRVRfQ0xSX0NOVCh4KQlSRUdf
UFVUKCh4KSwgMzEsIDE2KQorI2RlZmluZSBQSUdFT05fMTJfMV9TRVRfU0VUX0NOVCh4KQlSRUdf
UFVUKCh4KSwgMTUsICAwKQorCiAjZGVmaW5lIE1YU0ZCX01JTl9YUkVTCQkJMTIwCiAjZGVmaW5l
IE1YU0ZCX01JTl9ZUkVTCQkJMTIwCiAjZGVmaW5lIE1YU0ZCX01BWF9YUkVTCQkJMHhmZmZmCi0t
IAoyLjcuNAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18K
ZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0
dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
