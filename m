Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1221A2D1600
	for <lists+dri-devel@lfdr.de>; Mon,  7 Dec 2020 17:33:10 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 5F55A6E854;
	Mon,  7 Dec 2020 16:33:05 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ej1-x644.google.com (mail-ej1-x644.google.com
 [IPv6:2a00:1450:4864:20::644])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BD4066E89A
 for <dri-devel@lists.freedesktop.org>; Mon,  7 Dec 2020 16:33:03 +0000 (UTC)
Received: by mail-ej1-x644.google.com with SMTP id a16so20372498ejj.5
 for <dri-devel@lists.freedesktop.org>; Mon, 07 Dec 2020 08:33:03 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=Clcw/pKKDt4uvnij1weknvpz7V0FrtQ53kgv47xUPv0=;
 b=M2Ffz4YVXw9E2/sB8Sa0qGnndfT42/MFV44Zxhcyjond4A4w7K7fVgQN+44ELD/d65
 4jaJfkuPjYcFZAMJja5wMubop8qHRw8OqGhJywRZTwcJ0E7tNx0D/KBESz3bcQDqr/0i
 d/or6EOB5mnUwBm/RnUsPnKP4dMSKh3f1P32mAAVcM+Gh/u0HNFcLFKnUaA4UFg/+pGm
 5dgZL2HnGLbdBVzkUpauOa4pJs/85HIpIW7Zwz1tEZjOBaFg9gCRmJmLnoJNtGc7Uhk0
 x3y+iWMwzldakwL/NXwXV8/xLr6cB3UUw5K4ZUmRLpSZfI5xaxbvrgasN/HXqVywXX6X
 ph6A==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=Clcw/pKKDt4uvnij1weknvpz7V0FrtQ53kgv47xUPv0=;
 b=OsE7gN6MNDl/Fbl7Pa9nwyOQTBn7GIT5xxFaCIa+wz4QKZ0konmmtRrqCF86KbKa7L
 7zjjb5gLgVPYW+/yPJZtQtHyor+8EMC5jwXED/1vV3ta3q7KEIKm/KZJoyApsYC1nkv6
 Ion0DDelByVmw9cWDCSGxFsbDzNBtLJSUK9wM77CjWNUBeCyWKnAPKjgjRRhysUYG0mE
 eTkS7D5M81yluW+E28gH0BqNXjfB9GQq08genlG5nY3eOBuQKeqTj8FZ3zKE05AjphVJ
 VLO2y8cbQ9fJVG7zTONeQ6EXgHu21cXumuSvqM1lrLfi7qA+qWYNFFewoZ6fGiyObCiZ
 wmUw==
X-Gm-Message-State: AOAM530tRlXP79KLn5svxvW+zZLbzWsuQ/rrbDgEsmMBkpSnrwTFFgzg
 XdiHNLmTn6n2BVedfZfgQCw=
X-Google-Smtp-Source: ABdhPJyji+woWZsl9p5cAb+nQuhyepRsdgBJm3BTsyQS1zSTS2hx5FRR1KuVJ4A6H97aP+HH6ToS2A==
X-Received: by 2002:a17:906:8152:: with SMTP id
 z18mr20431282ejw.317.1607358782116; 
 Mon, 07 Dec 2020 08:33:02 -0800 (PST)
Received: from abel.fritz.box ([2a02:908:1252:fb60:8fd2:1844:1651:983f])
 by smtp.gmail.com with ESMTPSA id c14sm14047498edy.56.2020.12.07.08.33.00
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 07 Dec 2020 08:33:01 -0800 (PST)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: airlied@gmail.com,
	dri-devel@lists.freedesktop.org,
	ray.huang@amd.com
Subject: [PATCH] drm/ttm: cleanup BO size handling
Date: Mon,  7 Dec 2020 17:33:00 +0100
Message-Id: <20201207163300.183853-1-christian.koenig@amd.com>
X-Mailer: git-send-email 2.25.1
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QmFzZWQgb24gYW4gaWRlYSBmcm9tIERhdmUsIGJ1dCBjbGVhbmVkIHVwIGEgYml0LgoKV2UgaGFk
IG11bHRpcGxlIGZpZWxkcyBmb3IgZXNzZW50aWFsbHkgdGhlIHNhbWUgdGhpbmcuCgpOb3cgYm8t
PnNpemUgaXMgdGhlIG9yaWdpbmFsIHNpemUgb2YgdGhlIEJPIGluIGFyYml0cmFyeQp1bml0cywg
dXN1YWxseSBieXRlcy4KCmJvLT5tZW0ubnVtX3BhZ2VzIGlzIHRoZSBzaXplIGluIG51bWJlciBv
ZiBwYWdlcyBpbiB0aGUKcmVzb3VyY2UgZG9tYWluIG9mIGJvLT5tZW0ubWVtX3R5cGUuCgpTaWdu
ZWQtb2ZmLWJ5OiBDaHJpc3RpYW4gS8O2bmlnIDxjaHJpc3RpYW4ua29lbmlnQGFtZC5jb20+Ci0t
LQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RtYV9idWYuYyAgIHwgIDIgKy0K
IGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nbWMuYyAgICAgICB8ICAyICstCiBk
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfb2JqZWN0LmMgICAgfCAgMiArLQogZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X29iamVjdC5oICAgIHwgIDQgKy0tCiBkcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHJhY2UuaCAgICAgfCAgMiArLQogZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jICAgICAgIHwgIDYgKystLQogZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvbWVzX3YxMF8xLmMgICAgICAgIHwgIDIgKy0KIGRyaXZlcnMv
Z3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfYm8uYyAgICAgICAgICB8IDEwICsrKy0tLQogZHJpdmVy
cy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9kaXNwbGF5LmMgICAgIHwgIDggKystLS0KIGRyaXZl
cnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfcHJpbWUuYyAgICAgICB8ICA0ICstLQogZHJpdmVy
cy9ncHUvZHJtL25vdXZlYXUvbnYxN19mZW5jZS5jICAgICAgICAgIHwgIDIgKy0KIGRyaXZlcnMv
Z3B1L2RybS9ub3V2ZWF1L252NTBfZmVuY2UuYyAgICAgICAgICB8ICAyICstCiBkcml2ZXJzL2dw
dS9kcm0vcXhsL3F4bF9vYmplY3QuaCAgICAgICAgICAgICAgfCAgMiArLQogZHJpdmVycy9ncHUv
ZHJtL3JhZGVvbi9yYWRlb25fY3MuYyAgICAgICAgICAgIHwgIDMgKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9yYWRlb24vcmFkZW9uX29iamVjdC5jICAgICAgICB8IDEzICsrKystLS0tCiBkcml2ZXJzL2dw
dS9kcm0vcmFkZW9uL3JhZGVvbl9vYmplY3QuaCAgICAgICAgfCAgNCArLS0KIGRyaXZlcnMvZ3B1
L2RybS9yYWRlb24vcmFkZW9uX3ByaW1lLmMgICAgICAgICB8ICA0ICstLQogZHJpdmVycy9ncHUv
ZHJtL3JhZGVvbi9yYWRlb25fdHJhY2UuaCAgICAgICAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9yYWRlb24vcmFkZW9uX3R0bS5jICAgICAgICAgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0v
dHRtL3R0bV9iby5jICAgICAgICAgICAgICAgICAgfCAzMyArKysrKystLS0tLS0tLS0tLS0tCiBk
cml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGlsLmMgICAgICAgICAgICAgfCAxMSArKystLS0t
CiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib192bS5jICAgICAgICAgICAgICAgfCAgNiArKy0t
CiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV90dC5jICAgICAgICAgICAgICAgICAgfCAgMiArLQog
ZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfYmxpdC5jICAgICAgICAgIHwgIDQgKy0tCiBk
cml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9iby5jICAgICAgICAgICAgfCAgNiArKy0tCiBk
cml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9jb3RhYmxlLmMgICAgICAgfCAgMiArLQogZHJp
dmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfZXhlY2J1Zi5jICAgICAgIHwgIDQgKy0tCiBkcml2
ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9nbXJpZF9tYW5hZ2VyLmMgfCAgNSArKy0KIGRyaXZl
cnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2ttcy5jICAgICAgICAgICB8ICAyICstCiBkcml2ZXJz
L2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9wYWdlX2RpcnR5LmMgICAgfCAgOCArKy0tLQogZHJpdmVy
cy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfcmVzb3VyY2UuYyAgICAgIHwgIDIgKy0KIGRyaXZlcnMv
Z3B1L2RybS92bXdnZngvdm13Z2Z4X3NoYWRlci5jICAgICAgICB8ICAzICstCiBkcml2ZXJzL2dw
dS9kcm0vdm13Z2Z4L3Ztd2dmeF9zdGR1LmMgICAgICAgICAgfCAgNCArLS0KIGRyaXZlcnMvZ3B1
L2RybS92bXdnZngvdm13Z2Z4X3N1cmZhY2UuYyAgICAgICB8ICA3ICsrLS0KIGluY2x1ZGUvZHJt
L3R0bS90dG1fYm9fYXBpLmggICAgICAgICAgICAgICAgICB8ICA2ICsrLS0KIGluY2x1ZGUvZHJt
L3R0bS90dG1fcmVzb3VyY2UuaCAgICAgICAgICAgICAgICB8ICAxIC0KIDM2IGZpbGVzIGNoYW5n
ZWQsIDgyIGluc2VydGlvbnMoKyksIDEwMCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZG1hX2J1Zi5jIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X2RtYV9idWYuYwppbmRleCBlNTkxOWVmY2E4NzAuLmM0YzkzZjE5
ZDI3MyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RtYV9i
dWYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZG1hX2J1Zi5jCkBA
IC0yNjksNyArMjY5LDcgQEAgc3RhdGljIHN0cnVjdCBzZ190YWJsZSAqYW1kZ3B1X2RtYV9idWZf
bWFwKHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFjaCwKIAljYXNlIFRUTV9QTF9UVDoK
IAkJc2d0ID0gZHJtX3ByaW1lX3BhZ2VzX3RvX3NnKG9iai0+ZGV2LAogCQkJCQkgICAgYm8tPnRi
by50dG0tPnBhZ2VzLAotCQkJCQkgICAgYm8tPnRiby5udW1fcGFnZXMpOworCQkJCQkgICAgYm8t
PnRiby50dG0tPm51bV9wYWdlcyk7CiAJCWlmIChJU19FUlIoc2d0KSkKIAkJCXJldHVybiBzZ3Q7
CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nbWMuYyBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nbWMuYwppbmRleCAwNTZjYjg3ZDA5
ZWEuLjUyYmNkMWI1NTgyZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X2dtYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nbWMu
YwpAQCAtMTIxLDcgKzEyMSw3IEBAIHVpbnQ2NF90IGFtZGdwdV9nbWNfYWdwX2FkZHIoc3RydWN0
IHR0bV9idWZmZXJfb2JqZWN0ICpibykKIHsKIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9
IGFtZGdwdV90dG1fYWRldihiby0+YmRldik7CiAKLQlpZiAoYm8tPm51bV9wYWdlcyAhPSAxIHx8
IGJvLT50dG0tPmNhY2hpbmcgPT0gdHRtX2NhY2hlZCkKKwlpZiAoYm8tPnR0bS0+bnVtX3BhZ2Vz
ICE9IDEgfHwgYm8tPnR0bS0+Y2FjaGluZyA9PSB0dG1fY2FjaGVkKQogCQlyZXR1cm4gQU1ER1BV
X0JPX0lOVkFMSURfT0ZGU0VUOwogCiAJaWYgKGJvLT50dG0tPmRtYV9hZGRyZXNzWzBdICsgUEFH
RV9TSVpFID49IGFkZXYtPmdtYy5hZ3Bfc2l6ZSkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV9vYmplY3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdV9vYmplY3QuYwppbmRleCBjNmM5NzIzZDNkOGEuLjM4MWVjYzQ3ODhkNSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X29iamVjdC5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9vYmplY3QuYwpAQCAtNzg3LDcgKzc4Nyw3
IEBAIGludCBhbWRncHVfYm9fa21hcChzdHJ1Y3QgYW1kZ3B1X2JvICpibywgdm9pZCAqKnB0cikK
IAlpZiAociA8IDApCiAJCXJldHVybiByOwogCi0JciA9IHR0bV9ib19rbWFwKCZiby0+dGJvLCAw
LCBiby0+dGJvLm51bV9wYWdlcywgJmJvLT5rbWFwKTsKKwlyID0gdHRtX2JvX2ttYXAoJmJvLT50
Ym8sIDAsIGJvLT50Ym8ubWVtLm51bV9wYWdlcywgJmJvLT5rbWFwKTsKIAlpZiAocikKIAkJcmV0
dXJuIHI7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9v
YmplY3QuaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9vYmplY3QuaAppbmRl
eCBlZDQ3Y2JhYzRmNzUuLjE3NmVkMzYxNTE1MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X29iamVjdC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV9vYmplY3QuaApAQCAtMTc0LDEyICsxNzQsMTIgQEAgc3RhdGljIGlubGluZSB2
b2lkIGFtZGdwdV9ib191bnJlc2VydmUoc3RydWN0IGFtZGdwdV9ibyAqYm8pCiAKIHN0YXRpYyBp
bmxpbmUgdW5zaWduZWQgbG9uZyBhbWRncHVfYm9fc2l6ZShzdHJ1Y3QgYW1kZ3B1X2JvICpibykK
IHsKLQlyZXR1cm4gYm8tPnRiby5udW1fcGFnZXMgPDwgUEFHRV9TSElGVDsKKwlyZXR1cm4gYm8t
PnRiby5zaXplOwogfQogCiBzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGFtZGdwdV9ib19uZ3B1X3Bh
Z2VzKHN0cnVjdCBhbWRncHVfYm8gKmJvKQogewotCXJldHVybiAoYm8tPnRiby5udW1fcGFnZXMg
PDwgUEFHRV9TSElGVCkgLyBBTURHUFVfR1BVX1BBR0VfU0laRTsKKwlyZXR1cm4gYm8tPnRiby5z
aXplIC8gQU1ER1BVX0dQVV9QQUdFX1NJWkU7CiB9CiAKIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQg
YW1kZ3B1X2JvX2dwdV9wYWdlX2FsaWdubWVudChzdHJ1Y3QgYW1kZ3B1X2JvICpibykKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90cmFjZS5oIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3RyYWNlLmgKaW5kZXggZWU5NDgwZDE0Y2JjLi4y
MDcxNWRkYmI3NDYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV90cmFjZS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90cmFjZS5o
CkBAIC0xMjcsNyArMTI3LDcgQEAgVFJBQ0VfRVZFTlQoYW1kZ3B1X2JvX2NyZWF0ZSwKIAogCSAg
ICBUUF9mYXN0X2Fzc2lnbigKIAkJCSAgIF9fZW50cnktPmJvID0gYm87Ci0JCQkgICBfX2VudHJ5
LT5wYWdlcyA9IGJvLT50Ym8ubnVtX3BhZ2VzOworCQkJICAgX19lbnRyeS0+cGFnZXMgPSBiby0+
dGJvLm1lbS5udW1fcGFnZXM7CiAJCQkgICBfX2VudHJ5LT50eXBlID0gYm8tPnRiby5tZW0ubWVt
X3R5cGU7CiAJCQkgICBfX2VudHJ5LT5wcmVmZXIgPSBiby0+cHJlZmVycmVkX2RvbWFpbnM7CiAJ
CQkgICBfX2VudHJ5LT5hbGxvdyA9IGJvLT5hbGxvd2VkX2RvbWFpbnM7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmMgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfdHRtLmMKaW5kZXggZWM5M2Q0ZmRhYmJkLi5kZmI0MTIyYjRmZjMg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmMKQEAgLTYzNiw3ICs2MzYs
NyBAQCBzdGF0aWMgaW50IGFtZGdwdV9ib19tb3ZlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAq
Ym8sIGJvb2wgZXZpY3QsCiAKIG91dDoKIAkvKiB1cGRhdGUgc3RhdGlzdGljcyAqLwotCWF0b21p
YzY0X2FkZCgodTY0KWJvLT5udW1fcGFnZXMgPDwgUEFHRV9TSElGVCwgJmFkZXYtPm51bV9ieXRl
c19tb3ZlZCk7CisJYXRvbWljNjRfYWRkKGJvLT5zaXplLCAmYWRldi0+bnVtX2J5dGVzX21vdmVk
KTsKIAlhbWRncHVfYm9fbW92ZV9ub3RpZnkoYm8sIGV2aWN0LCBuZXdfbWVtKTsKIAlyZXR1cm4g
MDsKIH0KQEAgLTIxMzEsNyArMjEzMSw3IEBAIGludCBhbWRncHVfZmlsbF9idWZmZXIoc3RydWN0
IGFtZGdwdV9ibyAqYm8sCiAJCQlyZXR1cm4gcjsKIAl9CiAKLQludW1fcGFnZXMgPSBiby0+dGJv
Lm51bV9wYWdlczsKKwludW1fcGFnZXMgPSBiby0+dGJvLm1lbS5udW1fcGFnZXM7CiAJbW1fbm9k
ZSA9IGJvLT50Ym8ubWVtLm1tX25vZGU7CiAJbnVtX2xvb3BzID0gMDsKIAl3aGlsZSAobnVtX3Bh
Z2VzKSB7CkBAIC0yMTYxLDcgKzIxNjEsNyBAQCBpbnQgYW1kZ3B1X2ZpbGxfYnVmZmVyKHN0cnVj
dCBhbWRncHVfYm8gKmJvLAogCQl9CiAJfQogCi0JbnVtX3BhZ2VzID0gYm8tPnRiby5udW1fcGFn
ZXM7CisJbnVtX3BhZ2VzID0gYm8tPnRiby5tZW0ubnVtX3BhZ2VzOwogCW1tX25vZGUgPSBiby0+
dGJvLm1lbS5tbV9ub2RlOwogCiAJd2hpbGUgKG51bV9wYWdlcykgewpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbWVzX3YxMF8xLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9tZXNfdjEwXzEuYwppbmRleCA5ODVlNDU0NDYzZTEuLjljNTlmM2IyMjlmYSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbWVzX3YxMF8xLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbWVzX3YxMF8xLmMKQEAgLTU1NCw3ICs1NTQsNyBAQCBz
dGF0aWMgaW50IG1lc192MTBfMV9hbGxvY2F0ZV9lb3BfYnVmKHN0cnVjdCBhbWRncHVfZGV2aWNl
ICphZGV2KQogCQlyZXR1cm4gcjsKIAl9CiAKLQltZW1zZXQoZW9wLCAwLCBhZGV2LT5tZXMuZW9w
X2dwdV9vYmotPnRiby5tZW0uc2l6ZSk7CisJbWVtc2V0KGVvcCwgMCwgYWRldi0+bWVzLmVvcF9n
cHVfb2JqLT50Ym8uc2l6ZSk7CiAKIAlhbWRncHVfYm9fa3VubWFwKGFkZXYtPm1lcy5lb3BfZ3B1
X29iaik7CiAJYW1kZ3B1X2JvX3VucmVzZXJ2ZShhZGV2LT5tZXMuZW9wX2dwdV9vYmopOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9iby5jIGIvZHJpdmVycy9n
cHUvZHJtL25vdXZlYXUvbm91dmVhdV9iby5jCmluZGV4IGJjNTQyYWM0YzRiNi4uZjhjNTEyOTFl
OWM0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2JvLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9iby5jCkBAIC00NzMsMTAgKzQ3Mywx
MCBAQCBub3V2ZWF1X2JvX3BpbihzdHJ1Y3Qgbm91dmVhdV9ibyAqbnZibywgdWludDMyX3QgZG9t
YWluLCBib29sIGNvbnRpZykKIAogCXN3aXRjaCAoYm8tPm1lbS5tZW1fdHlwZSkgewogCWNhc2Ug
VFRNX1BMX1ZSQU06Ci0JCWRybS0+Z2VtLnZyYW1fYXZhaWxhYmxlIC09IGJvLT5tZW0uc2l6ZTsK
KwkJZHJtLT5nZW0udnJhbV9hdmFpbGFibGUgLT0gYm8tPnNpemU7CiAJCWJyZWFrOwogCWNhc2Ug
VFRNX1BMX1RUOgotCQlkcm0tPmdlbS5nYXJ0X2F2YWlsYWJsZSAtPSBiby0+bWVtLnNpemU7CisJ
CWRybS0+Z2VtLmdhcnRfYXZhaWxhYmxlIC09IGJvLT5zaXplOwogCQlicmVhazsKIAlkZWZhdWx0
OgogCQlicmVhazsKQEAgLTUwNCwxMCArNTA0LDEwIEBAIG5vdXZlYXVfYm9fdW5waW4oc3RydWN0
IG5vdXZlYXVfYm8gKm52Ym8pCiAJaWYgKCFudmJvLT5iby5waW5fY291bnQpIHsKIAkJc3dpdGNo
IChiby0+bWVtLm1lbV90eXBlKSB7CiAJCWNhc2UgVFRNX1BMX1ZSQU06Ci0JCQlkcm0tPmdlbS52
cmFtX2F2YWlsYWJsZSArPSBiby0+bWVtLnNpemU7CisJCQlkcm0tPmdlbS52cmFtX2F2YWlsYWJs
ZSArPSBiby0+c2l6ZTsKIAkJCWJyZWFrOwogCQljYXNlIFRUTV9QTF9UVDoKLQkJCWRybS0+Z2Vt
LmdhcnRfYXZhaWxhYmxlICs9IGJvLT5tZW0uc2l6ZTsKKwkJCWRybS0+Z2VtLmdhcnRfYXZhaWxh
YmxlICs9IGJvLT5zaXplOwogCQkJYnJlYWs7CiAJCWRlZmF1bHQ6CiAJCQlicmVhazsKQEAgLTkx
Myw3ICs5MTMsNyBAQCBub3V2ZWF1X2JvX3ZtX2JpbmQoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0
ICpibywgc3RydWN0IHR0bV9yZXNvdXJjZSAqbmV3X3JlZywKIAkJcmV0dXJuIDA7CiAKIAlpZiAo
ZHJtLT5jbGllbnQuZGV2aWNlLmluZm8uZmFtaWx5ID49IE5WX0RFVklDRV9JTkZPX1YwX0NFTFNJ
VVMpIHsKLQkJKm5ld190aWxlID0gbnYxMF9ib19zZXRfdGlsaW5nKGRldiwgb2Zmc2V0LCBuZXdf
cmVnLT5zaXplLAorCQkqbmV3X3RpbGUgPSBudjEwX2JvX3NldF90aWxpbmcoZGV2LCBvZmZzZXQs
IGJvLT5zaXplLAogCQkJCQkgICAgICAgbnZiby0+bW9kZSwgbnZiby0+emV0YSk7CiAJfQogCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2Rpc3BsYXkuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfZGlzcGxheS5jCmluZGV4IGJjZWI0OGEyZGZj
YS4uMGY3ODA0ODM5YjVmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2
ZWF1X2Rpc3BsYXkuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2Rpc3Bs
YXkuYwpAQCAtMjg2LDExICsyODYsMTEgQEAgbm91dmVhdV9jaGVja19ibF9zaXplKHN0cnVjdCBu
b3V2ZWF1X2RybSAqZHJtLCBzdHJ1Y3Qgbm91dmVhdV9ibyAqbnZibywKIAogCWJsX3NpemUgPSBi
dyAqIGJoICogKDEgPDwgdGlsZV9tb2RlKSAqIGdvYl9zaXplOwogCi0JRFJNX0RFQlVHX0tNUygi
b2Zmc2V0PSV1IHN0cmlkZT0ldSBoPSV1IHRpbGVfbW9kZT0weCUwMnggYnc9JXUgYmg9JXUgZ29i
X3NpemU9JXUgYmxfc2l6ZT0lbGx1IHNpemU9JWx1XG4iLAorCURSTV9ERUJVR19LTVMoIm9mZnNl
dD0ldSBzdHJpZGU9JXUgaD0ldSB0aWxlX21vZGU9MHglMDJ4IGJ3PSV1IGJoPSV1IGdvYl9zaXpl
PSV1IGJsX3NpemU9JWxsdSBzaXplPSVMdVxuIiwKIAkJICAgICAgb2Zmc2V0LCBzdHJpZGUsIGgs
IHRpbGVfbW9kZSwgYncsIGJoLCBnb2Jfc2l6ZSwgYmxfc2l6ZSwKLQkJICAgICAgbnZiby0+Ym8u
bWVtLnNpemUpOworCQkgICAgICBudmJvLT5iby5zaXplKTsKIAotCWlmIChibF9zaXplICsgb2Zm
c2V0ID4gbnZiby0+Ym8ubWVtLnNpemUpCisJaWYgKGJsX3NpemUgKyBvZmZzZXQgPiBudmJvLT5i
by5zaXplKQogCQlyZXR1cm4gLUVSQU5HRTsKIAogCXJldHVybiAwOwpAQCAtMzYzLDcgKzM2Myw3
IEBAIG5vdXZlYXVfZnJhbWVidWZmZXJfbmV3KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJCX0g
ZWxzZSB7CiAJCQl1aW50MzJfdCBzaXplID0gbW9kZV9jbWQtPnBpdGNoZXNbaV0gKiBoZWlnaHQ7
CiAKLQkJCWlmIChzaXplICsgbW9kZV9jbWQtPm9mZnNldHNbaV0gPiBudmJvLT5iby5tZW0uc2l6
ZSkKKwkJCWlmIChzaXplICsgbW9kZV9jbWQtPm9mZnNldHNbaV0gPiBudmJvLT5iby5zaXplKQog
CQkJCXJldHVybiAtRVJBTkdFOwogCQl9CiAJfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L25vdXZlYXUvbm91dmVhdV9wcmltZS5jIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVh
dV9wcmltZS5jCmluZGV4IDJmMTZiNTI0OTI4My4uMzQ3NDg4Njg1Zjc0IDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X3ByaW1lLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL25vdXZlYXUvbm91dmVhdV9wcmltZS5jCkBAIC0zMCw5ICszMCw5IEBACiBzdHJ1Y3Qgc2df
dGFibGUgKm5vdXZlYXVfZ2VtX3ByaW1lX2dldF9zZ190YWJsZShzdHJ1Y3QgZHJtX2dlbV9vYmpl
Y3QgKm9iaikKIHsKIAlzdHJ1Y3Qgbm91dmVhdV9ibyAqbnZibyA9IG5vdXZlYXVfZ2VtX29iamVj
dChvYmopOwotCWludCBucGFnZXMgPSBudmJvLT5iby5udW1fcGFnZXM7CiAKLQlyZXR1cm4gZHJt
X3ByaW1lX3BhZ2VzX3RvX3NnKG9iai0+ZGV2LCBudmJvLT5iby50dG0tPnBhZ2VzLCBucGFnZXMp
OworCXJldHVybiBkcm1fcHJpbWVfcGFnZXNfdG9fc2cob2JqLT5kZXYsIG52Ym8tPmJvLnR0bS0+
cGFnZXMsCisJCQkJICAgICBudmJvLT5iby50dG0tPm51bV9wYWdlcyk7CiB9CiAKIHN0cnVjdCBk
cm1fZ2VtX29iamVjdCAqbm91dmVhdV9nZW1fcHJpbWVfaW1wb3J0X3NnX3RhYmxlKHN0cnVjdCBk
cm1fZGV2aWNlICpkZXYsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9udjE3
X2ZlbmNlLmMgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9udjE3X2ZlbmNlLmMKaW5kZXggMTI1
M2ZkZWM3MTJkLi5iZjMyNDdkNjI3YjEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2
ZWF1L252MTdfZmVuY2UuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9udjE3X2ZlbmNl
LmMKQEAgLTgwLDcgKzgwLDcgQEAgbnYxN19mZW5jZV9jb250ZXh0X25ldyhzdHJ1Y3Qgbm91dmVh
dV9jaGFubmVsICpjaGFuKQogCXN0cnVjdCBudjEwX2ZlbmNlX2NoYW4gKmZjdHg7CiAJc3RydWN0
IHR0bV9yZXNvdXJjZSAqcmVnID0gJnByaXYtPmJvLT5iby5tZW07CiAJdTMyIHN0YXJ0ID0gcmVn
LT5zdGFydCAqIFBBR0VfU0laRTsKLQl1MzIgbGltaXQgPSBzdGFydCArIHJlZy0+c2l6ZSAtIDE7
CisJdTMyIGxpbWl0ID0gc3RhcnQgKyBwcml2LT5iby0+Ym8uc2l6ZSAtIDE7CiAJaW50IHJldCA9
IDA7CiAKIAlmY3R4ID0gY2hhbi0+ZmVuY2UgPSBremFsbG9jKHNpemVvZigqZmN0eCksIEdGUF9L
RVJORUwpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbnY1MF9mZW5jZS5j
IGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbnY1MF9mZW5jZS5jCmluZGV4IDQ0NzIzOGUzY2Jl
Ny4uMWM4OTcwMmZiYmE1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9udjUw
X2ZlbmNlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbnY1MF9mZW5jZS5jCkBAIC0z
OSw3ICszOSw3IEBAIG52NTBfZmVuY2VfY29udGV4dF9uZXcoc3RydWN0IG5vdXZlYXVfY2hhbm5l
bCAqY2hhbikKIAlzdHJ1Y3QgbnYxMF9mZW5jZV9jaGFuICpmY3R4OwogCXN0cnVjdCB0dG1fcmVz
b3VyY2UgKnJlZyA9ICZwcml2LT5iby0+Ym8ubWVtOwogCXUzMiBzdGFydCA9IHJlZy0+c3RhcnQg
KiBQQUdFX1NJWkU7Ci0JdTMyIGxpbWl0ID0gc3RhcnQgKyByZWctPnNpemUgLSAxOworCXUzMiBs
aW1pdCA9IHN0YXJ0ICsgcHJpdi0+Ym8tPmJvLnNpemUgLSAxOwogCWludCByZXQ7CiAKIAlmY3R4
ID0gY2hhbi0+ZmVuY2UgPSBremFsbG9jKHNpemVvZigqZmN0eCksIEdGUF9LRVJORUwpOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3F4bC9xeGxfb2JqZWN0LmggYi9kcml2ZXJzL2dwdS9k
cm0vcXhsL3F4bF9vYmplY3QuaAppbmRleCBlYmYyNGM5ZDJiZjIuLmJlNGQ5NWVkODI5OCAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3F4bC9xeGxfb2JqZWN0LmgKKysrIGIvZHJpdmVycy9n
cHUvZHJtL3F4bC9xeGxfb2JqZWN0LmgKQEAgLTUwLDcgKzUwLDcgQEAgc3RhdGljIGlubGluZSB2
b2lkIHF4bF9ib191bnJlc2VydmUoc3RydWN0IHF4bF9ibyAqYm8pCiAKIHN0YXRpYyBpbmxpbmUg
dW5zaWduZWQgbG9uZyBxeGxfYm9fc2l6ZShzdHJ1Y3QgcXhsX2JvICpibykKIHsKLQlyZXR1cm4g
Ym8tPnRiby5udW1fcGFnZXMgPDwgUEFHRV9TSElGVDsKKwlyZXR1cm4gYm8tPnRiby5zaXplOwog
fQogCiBzdGF0aWMgaW5saW5lIHU2NCBxeGxfYm9fbW1hcF9vZmZzZXQoc3RydWN0IHF4bF9ibyAq
Ym8pCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9jcy5jIGIvZHJp
dmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fY3MuYwppbmRleCAyMWNlMmY5NTAyYzAuLjRmMzVj
MzI5NTdiZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fY3MuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9jcy5jCkBAIC00MDEsNyArNDAxLDgg
QEAgc3RhdGljIGludCBjbXBfc2l6ZV9zbWFsbGVyX2ZpcnN0KHZvaWQgKnByaXYsIHN0cnVjdCBs
aXN0X2hlYWQgKmEsCiAJc3RydWN0IHJhZGVvbl9ib19saXN0ICpsYiA9IGxpc3RfZW50cnkoYiwg
c3RydWN0IHJhZGVvbl9ib19saXN0LCB0di5oZWFkKTsKIAogCS8qIFNvcnQgQSBiZWZvcmUgQiBp
ZiBBIGlzIHNtYWxsZXIuICovCi0JcmV0dXJuIChpbnQpbGEtPnJvYmotPnRiby5udW1fcGFnZXMg
LSAoaW50KWxiLT5yb2JqLT50Ym8ubnVtX3BhZ2VzOworCXJldHVybiAoaW50KWxhLT5yb2JqLT50
Ym8ubWVtLm51bV9wYWdlcyAtCisJCShpbnQpbGItPnJvYmotPnRiby5tZW0ubnVtX3BhZ2VzOwog
fQogCiAvKioKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX29iamVj
dC5jIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fb2JqZWN0LmMKaW5kZXggYWI4MWUz
NWNiMDYwLi43ODUyOTJmYzhjZmYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24v
cmFkZW9uX29iamVjdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX29iamVj
dC5jCkBAIC01NCwyMCArNTQsMTkgQEAgc3RhdGljIHZvaWQgcmFkZW9uX3VwZGF0ZV9tZW1vcnlf
dXNhZ2Uoc3RydWN0IHJhZGVvbl9ibyAqYm8sCiAJCQkJICAgICAgIHVuc2lnbmVkIG1lbV90eXBl
LCBpbnQgc2lnbikKIHsKIAlzdHJ1Y3QgcmFkZW9uX2RldmljZSAqcmRldiA9IGJvLT5yZGV2Owot
CXU2NCBzaXplID0gKHU2NCliby0+dGJvLm51bV9wYWdlcyA8PCBQQUdFX1NISUZUOwogCiAJc3dp
dGNoIChtZW1fdHlwZSkgewogCWNhc2UgVFRNX1BMX1RUOgogCQlpZiAoc2lnbiA+IDApCi0JCQlh
dG9taWM2NF9hZGQoc2l6ZSwgJnJkZXYtPmd0dF91c2FnZSk7CisJCQlhdG9taWM2NF9hZGQoYm8t
PnRiby5zaXplLCAmcmRldi0+Z3R0X3VzYWdlKTsKIAkJZWxzZQotCQkJYXRvbWljNjRfc3ViKHNp
emUsICZyZGV2LT5ndHRfdXNhZ2UpOworCQkJYXRvbWljNjRfc3ViKGJvLT50Ym8uc2l6ZSwgJnJk
ZXYtPmd0dF91c2FnZSk7CiAJCWJyZWFrOwogCWNhc2UgVFRNX1BMX1ZSQU06CiAJCWlmIChzaWdu
ID4gMCkKLQkJCWF0b21pYzY0X2FkZChzaXplLCAmcmRldi0+dnJhbV91c2FnZSk7CisJCQlhdG9t
aWM2NF9hZGQoYm8tPnRiby5zaXplLCAmcmRldi0+dnJhbV91c2FnZSk7CiAJCWVsc2UKLQkJCWF0
b21pYzY0X3N1YihzaXplLCAmcmRldi0+dnJhbV91c2FnZSk7CisJCQlhdG9taWM2NF9zdWIoYm8t
PnRiby5zaXplLCAmcmRldi0+dnJhbV91c2FnZSk7CiAJCWJyZWFrOwogCX0KIH0KQEAgLTI1Niw3
ICsyNTUsNyBAQCBpbnQgcmFkZW9uX2JvX2ttYXAoc3RydWN0IHJhZGVvbl9ibyAqYm8sIHZvaWQg
KipwdHIpCiAJCX0KIAkJcmV0dXJuIDA7CiAJfQotCXIgPSB0dG1fYm9fa21hcCgmYm8tPnRibywg
MCwgYm8tPnRiby5udW1fcGFnZXMsICZiby0+a21hcCk7CisJciA9IHR0bV9ib19rbWFwKCZiby0+
dGJvLCAwLCBiby0+dGJvLm1lbS5udW1fcGFnZXMsICZiby0+a21hcCk7CiAJaWYgKHIpIHsKIAkJ
cmV0dXJuIHI7CiAJfQpAQCAtNjEwLDcgKzYwOSw3IEBAIGludCByYWRlb25fYm9fZ2V0X3N1cmZh
Y2VfcmVnKHN0cnVjdCByYWRlb25fYm8gKmJvKQogb3V0OgogCXJhZGVvbl9zZXRfc3VyZmFjZV9y
ZWcocmRldiwgaSwgYm8tPnRpbGluZ19mbGFncywgYm8tPnBpdGNoLAogCQkJICAgICAgIGJvLT50
Ym8ubWVtLnN0YXJ0IDw8IFBBR0VfU0hJRlQsCi0JCQkgICAgICAgYm8tPnRiby5udW1fcGFnZXMg
PDwgUEFHRV9TSElGVCk7CisJCQkgICAgICAgYm8tPnRiby5zaXplKTsKIAlyZXR1cm4gMDsKIH0K
IApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fb2JqZWN0LmggYi9k
cml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9vYmplY3QuaAppbmRleCBkNjA2ZTlhOTM1ZTMu
LjYzODIxZDJkMmMwNyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25f
b2JqZWN0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fb2JqZWN0LmgKQEAg
LTEwOSwxMiArMTA5LDEyIEBAIHN0YXRpYyBpbmxpbmUgdTY0IHJhZGVvbl9ib19ncHVfb2Zmc2V0
KHN0cnVjdCByYWRlb25fYm8gKmJvKQogCiBzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGxvbmcgcmFk
ZW9uX2JvX3NpemUoc3RydWN0IHJhZGVvbl9ibyAqYm8pCiB7Ci0JcmV0dXJuIGJvLT50Ym8ubnVt
X3BhZ2VzIDw8IFBBR0VfU0hJRlQ7CisJcmV0dXJuIGJvLT50Ym8uc2l6ZTsKIH0KIAogc3RhdGlj
IGlubGluZSB1bnNpZ25lZCByYWRlb25fYm9fbmdwdV9wYWdlcyhzdHJ1Y3QgcmFkZW9uX2JvICpi
bykKIHsKLQlyZXR1cm4gKGJvLT50Ym8ubnVtX3BhZ2VzIDw8IFBBR0VfU0hJRlQpIC8gUkFERU9O
X0dQVV9QQUdFX1NJWkU7CisJcmV0dXJuIGJvLT50Ym8uc2l6ZSAvIFJBREVPTl9HUFVfUEFHRV9T
SVpFOwogfQogCiBzdGF0aWMgaW5saW5lIHVuc2lnbmVkIHJhZGVvbl9ib19ncHVfcGFnZV9hbGln
bm1lbnQoc3RydWN0IHJhZGVvbl9ibyAqYm8pCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
cmFkZW9uL3JhZGVvbl9wcmltZS5jIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fcHJp
bWUuYwppbmRleCAwODhkMzlhNTFjMGQuLjBhMDlkYmFiYTI4OSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fcHJpbWUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vcmFk
ZW9uL3JhZGVvbl9wcmltZS5jCkBAIC0zNCw5ICszNCw5IEBACiBzdHJ1Y3Qgc2dfdGFibGUgKnJh
ZGVvbl9nZW1fcHJpbWVfZ2V0X3NnX3RhYmxlKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqKQog
ewogCXN0cnVjdCByYWRlb25fYm8gKmJvID0gZ2VtX3RvX3JhZGVvbl9ibyhvYmopOwotCWludCBu
cGFnZXMgPSBiby0+dGJvLm51bV9wYWdlczsKIAotCXJldHVybiBkcm1fcHJpbWVfcGFnZXNfdG9f
c2cob2JqLT5kZXYsIGJvLT50Ym8udHRtLT5wYWdlcywgbnBhZ2VzKTsKKwlyZXR1cm4gZHJtX3By
aW1lX3BhZ2VzX3RvX3NnKG9iai0+ZGV2LCBiby0+dGJvLnR0bS0+cGFnZXMsCisJCQkJICAgICBi
by0+dGJvLnR0bS0+bnVtX3BhZ2VzKTsKIH0KIAogc3RydWN0IGRybV9nZW1fb2JqZWN0ICpyYWRl
b25fZ2VtX3ByaW1lX2ltcG9ydF9zZ190YWJsZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LApkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fdHJhY2UuaCBiL2RyaXZlcnMv
Z3B1L2RybS9yYWRlb24vcmFkZW9uX3RyYWNlLmgKaW5kZXggYzkzZjNhYjNjNGUzLi4xNzI5Y2I5
YTk1YzUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX3RyYWNlLmgK
KysrIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fdHJhY2UuaApAQCAtMjIsNyArMjIs
NyBAQCBUUkFDRV9FVkVOVChyYWRlb25fYm9fY3JlYXRlLAogCiAJICAgIFRQX2Zhc3RfYXNzaWdu
KAogCQkJICAgX19lbnRyeS0+Ym8gPSBibzsKLQkJCSAgIF9fZW50cnktPnBhZ2VzID0gYm8tPnRi
by5udW1fcGFnZXM7CisJCQkgICBfX2VudHJ5LT5wYWdlcyA9IGJvLT50Ym8ubWVtLm51bV9wYWdl
czsKIAkJCSAgICksCiAJICAgIFRQX3ByaW50aygiYm89JXAsIHBhZ2VzPSV1IiwgX19lbnRyeS0+
Ym8sIF9fZW50cnktPnBhZ2VzKQogKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yYWRl
b24vcmFkZW9uX3R0bS5jIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fdHRtLmMKaW5k
ZXggYTM0MzJjNjM0M2JhLi41MWFkNWVjY2Q4NDQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9yYWRlb24vcmFkZW9uX3R0bS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9u
X3R0bS5jCkBAIC0yNzQsNyArMjc0LDcgQEAgc3RhdGljIGludCByYWRlb25fYm9fbW92ZShzdHJ1
Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLCBib29sIGV2aWN0LAogCiBvdXQ6CiAJLyogdXBkYXRl
IHN0YXRpc3RpY3MgKi8KLQlhdG9taWM2NF9hZGQoKHU2NCliby0+bnVtX3BhZ2VzIDw8IFBBR0Vf
U0hJRlQsICZyZGV2LT5udW1fYnl0ZXNfbW92ZWQpOworCWF0b21pYzY0X2FkZChiby0+c2l6ZSwg
JnJkZXYtPm51bV9ieXRlc19tb3ZlZCk7CiAJcmFkZW9uX2JvX21vdmVfbm90aWZ5KGJvLCBldmlj
dCwgbmV3X21lbSk7CiAJcmV0dXJuIDA7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
dHRtL3R0bV9iby5jIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm8uYwppbmRleCAwMmNjNWQy
NDdjMGQuLjFjYjMyNjA1NmU5MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1f
Ym8uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5jCkBAIC03Miw5ICs3Miw5IEBA
IHN0YXRpYyB2b2lkIHR0bV9ib19tZW1fc3BhY2VfZGVidWcoc3RydWN0IHR0bV9idWZmZXJfb2Jq
ZWN0ICpibywKIAlzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbjsKIAlpbnQgaSwgbWVt
X3R5cGU7CiAKLQlkcm1fcHJpbnRmKCZwLCAiTm8gc3BhY2UgZm9yICVwICglbHUgcGFnZXMsICVs
dUssICVsdU0pXG4iLAotCQkgICBibywgYm8tPm1lbS5udW1fcGFnZXMsIGJvLT5tZW0uc2l6ZSA+
PiAxMCwKLQkJICAgYm8tPm1lbS5zaXplID4+IDIwKTsKKwlkcm1fcHJpbnRmKCZwLCAiTm8gc3Bh
Y2UgZm9yICVwICglbHUgcGFnZXMsICVMdUssICVMdU0pXG4iLAorCQkgICBibywgYm8tPm1lbS5u
dW1fcGFnZXMsIGJvLT5zaXplID4+IDEwLAorCQkgICBiby0+c2l6ZSA+PiAyMCk7CiAJZm9yIChp
ID0gMDsgaSA8IHBsYWNlbWVudC0+bnVtX3BsYWNlbWVudDsgaSsrKSB7CiAJCW1lbV90eXBlID0g
cGxhY2VtZW50LT5wbGFjZW1lbnRbaV0ubWVtX3R5cGU7CiAJCWRybV9wcmludGYoJnAsICIgIHBs
YWNlbWVudFslZF09MHglMDhYICglZClcbiIsCkBAIC0yNjgsNyArMjY4LDcgQEAgc3RhdGljIGlu
dCB0dG1fYm9faGFuZGxlX21vdmVfbWVtKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJ
CWdvdG8gb3V0X2VycjsKIAl9CiAKLQljdHgtPmJ5dGVzX21vdmVkICs9IGJvLT5udW1fcGFnZXMg
PDwgUEFHRV9TSElGVDsKKwljdHgtPmJ5dGVzX21vdmVkICs9IGJvLT5zaXplOwogCXJldHVybiAw
OwogCiBvdXRfZXJyOgpAQCAtOTg1LDggKzk4NSw3IEBAIHN0YXRpYyBpbnQgdHRtX2JvX21vdmVf
YnVmZmVyKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAKIAltZW1zZXQoJmhvcCwgMCwg
c2l6ZW9mKGhvcCkpOwogCi0JbWVtLm51bV9wYWdlcyA9IGJvLT5udW1fcGFnZXM7Ci0JbWVtLnNp
emUgPSBtZW0ubnVtX3BhZ2VzIDw8IFBBR0VfU0hJRlQ7CisJbWVtLm51bV9wYWdlcyA9IFBBR0Vf
QUxJR04oYm8tPnNpemUpID4+IFBBR0VfU0hJRlQ7CiAJbWVtLnBhZ2VfYWxpZ25tZW50ID0gYm8t
Pm1lbS5wYWdlX2FsaWdubWVudDsKIAltZW0uYnVzLm9mZnNldCA9IDA7CiAJbWVtLmJ1cy5hZGRy
ID0gTlVMTDsKQEAgLTExMDIsNyArMTEwMSw3IEBAIEVYUE9SVF9TWU1CT0wodHRtX2JvX3ZhbGlk
YXRlKTsKIAogaW50IHR0bV9ib19pbml0X3Jlc2VydmVkKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpi
ZGV2LAogCQkJIHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCi0JCQkgdW5zaWduZWQgbG9u
ZyBzaXplLAorCQkJIHVpbnQ2NF90IHNpemUsCiAJCQkgZW51bSB0dG1fYm9fdHlwZSB0eXBlLAog
CQkJIHN0cnVjdCB0dG1fcGxhY2VtZW50ICpwbGFjZW1lbnQsCiAJCQkgdWludDMyX3QgcGFnZV9h
bGlnbm1lbnQsCkBAIC0xMTEzLDkgKzExMTIsOCBAQCBpbnQgdHRtX2JvX2luaXRfcmVzZXJ2ZWQo
c3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCiAJCQkgdm9pZCAoKmRlc3Ryb3kpIChzdHJ1Y3Qg
dHRtX2J1ZmZlcl9vYmplY3QgKikpCiB7CiAJc3RydWN0IHR0bV9tZW1fZ2xvYmFsICptZW1fZ2xv
YiA9ICZ0dG1fbWVtX2dsb2I7Ci0JaW50IHJldCA9IDA7Ci0JdW5zaWduZWQgbG9uZyBudW1fcGFn
ZXM7CiAJYm9vbCBsb2NrZWQ7CisJaW50IHJldCA9IDA7CiAKIAlyZXQgPSB0dG1fbWVtX2dsb2Jh
bF9hbGxvYyhtZW1fZ2xvYiwgYWNjX3NpemUsIGN0eCk7CiAJaWYgKHJldCkgewpAQCAtMTEyNywx
NiArMTEyNSw2IEBAIGludCB0dG1fYm9faW5pdF9yZXNlcnZlZChzdHJ1Y3QgdHRtX2JvX2Rldmlj
ZSAqYmRldiwKIAkJcmV0dXJuIC1FTk9NRU07CiAJfQogCi0JbnVtX3BhZ2VzID0gKHNpemUgKyBQ
QUdFX1NJWkUgLSAxKSA+PiBQQUdFX1NISUZUOwotCWlmIChudW1fcGFnZXMgPT0gMCkgewotCQlw
cl9lcnIoIklsbGVnYWwgYnVmZmVyIG9iamVjdCBzaXplXG4iKTsKLQkJaWYgKGRlc3Ryb3kpCi0J
CQkoKmRlc3Ryb3kpKGJvKTsKLQkJZWxzZQotCQkJa2ZyZWUoYm8pOwotCQl0dG1fbWVtX2dsb2Jh
bF9mcmVlKG1lbV9nbG9iLCBhY2Nfc2l6ZSk7Ci0JCXJldHVybiAtRUlOVkFMOwotCX0KIAliby0+
ZGVzdHJveSA9IGRlc3Ryb3kgPyBkZXN0cm95IDogdHRtX2JvX2RlZmF1bHRfZGVzdHJveTsKIAog
CWtyZWZfaW5pdCgmYm8tPmtyZWYpOwpAQCAtMTE0NSwxMCArMTEzMyw5IEBAIGludCB0dG1fYm9f
aW5pdF9yZXNlcnZlZChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKIAlJTklUX0xJU1RfSEVB
RCgmYm8tPnN3YXApOwogCWJvLT5iZGV2ID0gYmRldjsKIAliby0+dHlwZSA9IHR5cGU7Ci0JYm8t
Pm51bV9wYWdlcyA9IG51bV9wYWdlczsKLQliby0+bWVtLnNpemUgPSBudW1fcGFnZXMgPDwgUEFH
RV9TSElGVDsKKwliby0+c2l6ZSA9IHNpemU7CiAJYm8tPm1lbS5tZW1fdHlwZSA9IFRUTV9QTF9T
WVNURU07Ci0JYm8tPm1lbS5udW1fcGFnZXMgPSBiby0+bnVtX3BhZ2VzOworCWJvLT5tZW0ubnVt
X3BhZ2VzID0gUEFHRV9BTElHTihzaXplKSA+PiBQQUdFX1NISUZUOwogCWJvLT5tZW0ubW1fbm9k
ZSA9IE5VTEw7CiAJYm8tPm1lbS5wYWdlX2FsaWdubWVudCA9IHBhZ2VfYWxpZ25tZW50OwogCWJv
LT5tZW0uYnVzLm9mZnNldCA9IDA7CkBAIC0xMjEwLDcgKzExOTcsNyBAQCBFWFBPUlRfU1lNQk9M
KHR0bV9ib19pbml0X3Jlc2VydmVkKTsKIAogaW50IHR0bV9ib19pbml0KHN0cnVjdCB0dG1fYm9f
ZGV2aWNlICpiZGV2LAogCQlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAotCQl1bnNpZ25l
ZCBsb25nIHNpemUsCisJCXVpbnQ2NF90IHNpemUsCiAJCWVudW0gdHRtX2JvX3R5cGUgdHlwZSwK
IAkJc3RydWN0IHR0bV9wbGFjZW1lbnQgKnBsYWNlbWVudCwKIAkJdWludDMyX3QgcGFnZV9hbGln
bm1lbnQsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGlsLmMgYi9k
cml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGlsLmMKaW5kZXggNWJiYzEzMzlkMjhlLi42NzU4
ZTUxMTVhZTUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3V0aWwuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGlsLmMKQEAgLTQzMSw5ICs0MzEsOSBA
QCBpbnQgdHRtX2JvX2ttYXAoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAogCW1hcC0+
dmlydHVhbCA9IE5VTEw7CiAJbWFwLT5ibyA9IGJvOwotCWlmIChudW1fcGFnZXMgPiBiby0+bnVt
X3BhZ2VzKQorCWlmIChudW1fcGFnZXMgPiBiby0+bWVtLm51bV9wYWdlcykKIAkJcmV0dXJuIC1F
SU5WQUw7Ci0JaWYgKHN0YXJ0X3BhZ2UgPiBiby0+bnVtX3BhZ2VzKQorCWlmICgoc3RhcnRfcGFn
ZSArIG51bV9wYWdlcykgPiBiby0+bWVtLm51bV9wYWdlcykKIAkJcmV0dXJuIC1FSU5WQUw7CiAK
IAlyZXQgPSB0dG1fbWVtX2lvX3Jlc2VydmUoYm8tPmJkZXYsICZiby0+bWVtKTsKQEAgLTQ4NSwx
NCArNDg1LDEzIEBAIGludCB0dG1fYm9fdm1hcChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJv
LCBzdHJ1Y3QgZG1hX2J1Zl9tYXAgKm1hcCkKIAogCWlmIChtZW0tPmJ1cy5pc19pb21lbSkgewog
CQl2b2lkIF9faW9tZW0gKnZhZGRyX2lvbWVtOwotCQlzaXplX3Qgc2l6ZSA9IGJvLT5udW1fcGFn
ZXMgPDwgUEFHRV9TSElGVDsKIAogCQlpZiAobWVtLT5idXMuYWRkcikKIAkJCXZhZGRyX2lvbWVt
ID0gKHZvaWQgX19pb21lbSAqKW1lbS0+YnVzLmFkZHI7CiAJCWVsc2UgaWYgKG1lbS0+YnVzLmNh
Y2hpbmcgPT0gdHRtX3dyaXRlX2NvbWJpbmVkKQotCQkJdmFkZHJfaW9tZW0gPSBpb3JlbWFwX3dj
KG1lbS0+YnVzLm9mZnNldCwgc2l6ZSk7CisJCQl2YWRkcl9pb21lbSA9IGlvcmVtYXBfd2MobWVt
LT5idXMub2Zmc2V0LCBiby0+c2l6ZSk7CiAJCWVsc2UKLQkJCXZhZGRyX2lvbWVtID0gaW9yZW1h
cChtZW0tPmJ1cy5vZmZzZXQsIHNpemUpOworCQkJdmFkZHJfaW9tZW0gPSBpb3JlbWFwKG1lbS0+
YnVzLm9mZnNldCwgYm8tPnNpemUpOwogCiAJCWlmICghdmFkZHJfaW9tZW0pCiAJCQlyZXR1cm4g
LUVOT01FTTsKQEAgLTUxNyw3ICs1MTYsNyBAQCBpbnQgdHRtX2JvX3ZtYXAoc3RydWN0IHR0bV9i
dWZmZXJfb2JqZWN0ICpibywgc3RydWN0IGRtYV9idWZfbWFwICptYXApCiAJCSAqIG9yIHRvIG1h
a2UgdGhlIGJ1ZmZlciBvYmplY3QgbG9vayBjb250aWd1b3VzLgogCQkgKi8KIAkJcHJvdCA9IHR0
bV9pb19wcm90KGJvLCBtZW0sIFBBR0VfS0VSTkVMKTsKLQkJdmFkZHIgPSB2bWFwKHR0bS0+cGFn
ZXMsIGJvLT5udW1fcGFnZXMsIDAsIHByb3QpOworCQl2YWRkciA9IHZtYXAodHRtLT5wYWdlcywg
dHRtLT5udW1fcGFnZXMsIDAsIHByb3QpOwogCQlpZiAoIXZhZGRyKQogCQkJcmV0dXJuIC1FTk9N
RU07CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3ZtLmMgYi9kcml2
ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib192bS5jCmluZGV4IDE0NGE0OTQwYjZiNi4uNmRjOTZjZjY2
NzQ0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib192bS5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3ZtLmMKQEAgLTE5OCw3ICsxOTgsNyBAQCBzdGF0aWMg
dm1fZmF1bHRfdCB0dG1fYm9fdm1faW5zZXJ0X2h1Z2Uoc3RydWN0IHZtX2ZhdWx0ICp2bWYsCiAK
IAkvKiBGYXVsdCBzaG91bGQgbm90IGNyb3NzIGJvIGJvdW5kYXJ5LiAqLwogCXBhZ2Vfb2Zmc2V0
ICY9IH4oZmF1bHRfcGFnZV9zaXplIC0gMSk7Ci0JaWYgKHBhZ2Vfb2Zmc2V0ICsgZmF1bHRfcGFn
ZV9zaXplID4gYm8tPm51bV9wYWdlcykKKwlpZiAocGFnZV9vZmZzZXQgKyBmYXVsdF9wYWdlX3Np
emUgPiBiby0+bWVtLm51bV9wYWdlcykKIAkJZ290byBvdXRfZmFsbGJhY2s7CiAKIAlpZiAoYm8t
Pm1lbS5idXMuaXNfaW9tZW0pCkBAIC0zMDYsNyArMzA2LDcgQEAgdm1fZmF1bHRfdCB0dG1fYm9f
dm1fZmF1bHRfcmVzZXJ2ZWQoc3RydWN0IHZtX2ZhdWx0ICp2bWYsCiAJcGFnZV9sYXN0ID0gdm1h
X3BhZ2VzKHZtYSkgKyB2bWEtPnZtX3Bnb2ZmIC0KIAkJZHJtX3ZtYV9ub2RlX3N0YXJ0KCZiby0+
YmFzZS52bWFfbm9kZSk7CiAKLQlpZiAodW5saWtlbHkocGFnZV9vZmZzZXQgPj0gYm8tPm51bV9w
YWdlcykpCisJaWYgKHVubGlrZWx5KHBhZ2Vfb2Zmc2V0ID49IGJvLT5tZW0ubnVtX3BhZ2VzKSkK
IAkJcmV0dXJuIFZNX0ZBVUxUX1NJR0JVUzsKIAogCXByb3QgPSB0dG1faW9fcHJvdChibywgJmJv
LT5tZW0sIHByb3QpOwpAQCAtNDY5LDcgKzQ2OSw3IEBAIGludCB0dG1fYm9fdm1fYWNjZXNzKHN0
cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hLCB1bnNpZ25lZCBsb25nIGFkZHIsCiAJCSA8PCBQQUdF
X1NISUZUKTsKIAlpbnQgcmV0OwogCi0JaWYgKGxlbiA8IDEgfHwgKG9mZnNldCArIGxlbikgPj4g
UEFHRV9TSElGVCA+IGJvLT5udW1fcGFnZXMpCisJaWYgKGxlbiA8IDEgfHwgKG9mZnNldCArIGxl
bikgPj4gUEFHRV9TSElGVCA+IGJvLT5tZW0ubnVtX3BhZ2VzKQogCQlyZXR1cm4gLUVJTzsKIAog
CXJldCA9IHR0bV9ib19yZXNlcnZlKGJvLCB0cnVlLCBmYWxzZSwgTlVMTCk7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV90dC5jIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1f
dHQuYwppbmRleCA3N2JhNzg0NDI1ZGQuLmM1Yzk3M2ZhMDczNiAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL3R0bS90dG1fdHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV90dC5j
CkBAIC0xMjksNyArMTI5LDcgQEAgc3RhdGljIHZvaWQgdHRtX3R0X2luaXRfZmllbGRzKHN0cnVj
dCB0dG1fdHQgKnR0bSwKIAkJCSAgICAgICB1aW50MzJfdCBwYWdlX2ZsYWdzLAogCQkJICAgICAg
IGVudW0gdHRtX2NhY2hpbmcgY2FjaGluZykKIHsKLQl0dG0tPm51bV9wYWdlcyA9IGJvLT5udW1f
cGFnZXM7CisJdHRtLT5udW1fcGFnZXMgPSBQQUdFX0FMSUdOKGJvLT5zaXplKSA+PiBQQUdFX1NI
SUZUOwogCXR0bS0+Y2FjaGluZyA9IHR0bV9jYWNoZWQ7CiAJdHRtLT5wYWdlX2ZsYWdzID0gcGFn
ZV9mbGFnczsKIAl0dG0tPmRtYV9hZGRyZXNzID0gTlVMTDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS92bXdnZngvdm13Z2Z4X2JsaXQuYyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13
Z2Z4X2JsaXQuYwppbmRleCBmMjE4ODFlMDg3ZGIuLjlmMjc3OWRkY2YwOCAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfYmxpdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS92bXdnZngvdm13Z2Z4X2JsaXQuYwpAQCAtNDgyLDggKzQ4Miw4IEBAIGludCB2bXdfYm9fY3B1
X2JsaXQoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpkc3QsCiAJZC5zcmNfYWRkciA9IE5VTEw7
CiAJZC5kc3RfcGFnZXMgPSBkc3QtPnR0bS0+cGFnZXM7CiAJZC5zcmNfcGFnZXMgPSBzcmMtPnR0
bS0+cGFnZXM7Ci0JZC5kc3RfbnVtX3BhZ2VzID0gZHN0LT5udW1fcGFnZXM7Ci0JZC5zcmNfbnVt
X3BhZ2VzID0gc3JjLT5udW1fcGFnZXM7CisJZC5kc3RfbnVtX3BhZ2VzID0gZHN0LT5tZW0ubnVt
X3BhZ2VzOworCWQuc3JjX251bV9wYWdlcyA9IHNyYy0+bWVtLm51bV9wYWdlczsKIAlkLmRzdF9w
cm90ID0gdHRtX2lvX3Byb3QoZHN0LCAmZHN0LT5tZW0sIFBBR0VfS0VSTkVMKTsKIAlkLnNyY19w
cm90ID0gdHRtX2lvX3Byb3Qoc3JjLCAmc3JjLT5tZW0sIFBBR0VfS0VSTkVMKTsKIAlkLmRpZmYg
PSBkaWZmOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfYm8uYyBi
L2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2JvLmMKaW5kZXggMjYzZDc2YWU0M2YwLi42
M2RiYzQ0ZWViZTAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2Jv
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfYm8uYwpAQCAtMjIzLDcgKzIy
Myw3IEBAIGludCB2bXdfYm9fcGluX2luX3N0YXJ0X29mX3ZyYW0oc3RydWN0IHZtd19wcml2YXRl
ICpkZXZfcHJpdiwKIAl1aW50MzJfdCBuZXdfZmxhZ3M7CiAKIAlwbGFjZSA9IHZtd192cmFtX3Bs
YWNlbWVudC5wbGFjZW1lbnRbMF07Ci0JcGxhY2UubHBmbiA9IGJvLT5udW1fcGFnZXM7CisJcGxh
Y2UubHBmbiA9IGJvLT5tZW0ubnVtX3BhZ2VzOwogCXBsYWNlbWVudC5udW1fcGxhY2VtZW50ID0g
MTsKIAlwbGFjZW1lbnQucGxhY2VtZW50ID0gJnBsYWNlOwogCXBsYWNlbWVudC5udW1fYnVzeV9w
bGFjZW1lbnQgPSAxOwpAQCAtMjQ0LDcgKzI0NCw3IEBAIGludCB2bXdfYm9fcGluX2luX3N0YXJ0
X29mX3ZyYW0oc3RydWN0IHZtd19wcml2YXRlICpkZXZfcHJpdiwKIAkgKiB0aGF0IHNpdHVhdGlv
bi4KIAkgKi8KIAlpZiAoYm8tPm1lbS5tZW1fdHlwZSA9PSBUVE1fUExfVlJBTSAmJgotCSAgICBi
by0+bWVtLnN0YXJ0IDwgYm8tPm51bV9wYWdlcyAmJgorCSAgICBiby0+bWVtLnN0YXJ0IDwgYm8t
Pm1lbS5udW1fcGFnZXMgJiYKIAkgICAgYm8tPm1lbS5zdGFydCA+IDAgJiYKIAkgICAgYnVmLT5i
YXNlLnBpbl9jb3VudCA9PSAwKSB7CiAJCWN0eC5pbnRlcnJ1cHRpYmxlID0gZmFsc2U7CkBAIC0z
OTEsNyArMzkxLDcgQEAgdm9pZCAqdm13X2JvX21hcF9hbmRfY2FjaGUoc3RydWN0IHZtd19idWZm
ZXJfb2JqZWN0ICp2Ym8pCiAJaWYgKHZpcnR1YWwpCiAJCXJldHVybiB2aXJ0dWFsOwogCi0JcmV0
ID0gdHRtX2JvX2ttYXAoYm8sIDAsIGJvLT5udW1fcGFnZXMsICZ2Ym8tPm1hcCk7CisJcmV0ID0g
dHRtX2JvX2ttYXAoYm8sIDAsIGJvLT5tZW0ubnVtX3BhZ2VzLCAmdmJvLT5tYXApOwogCWlmIChy
ZXQpCiAJCURSTV9FUlJPUigiQnVmZmVyIG9iamVjdCBtYXAgZmFpbGVkOiAlZC5cbiIsIHJldCk7
CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2NvdGFibGUuYyBi
L2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2NvdGFibGUuYwppbmRleCA5ODRkODg4NDM1
N2QuLmEwNzdlNDIwZDJmZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdn
ZnhfY290YWJsZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2NvdGFibGUu
YwpAQCAtNDMwLDcgKzQzMCw3IEBAIHN0YXRpYyBpbnQgdm13X2NvdGFibGVfcmVzaXplKHN0cnVj
dCB2bXdfcmVzb3VyY2UgKnJlcywgc2l6ZV90IG5ld19zaXplKQogCSAqIERvIGEgcGFnZSBieSBw
YWdlIGNvcHkgb2YgQ09UYWJsZXMuIFRoaXMgZWxpbWluYXRlcyBzbG93IHZtYXAoKXMuCiAJICog
VGhpcyBzaG91bGQgcmVhbGx5IGJlIGEgVFRNIHV0aWxpdHkuCiAJICovCi0JZm9yIChpID0gMDsg
aSA8IG9sZF9iby0+bnVtX3BhZ2VzOyArK2kpIHsKKwlmb3IgKGkgPSAwOyBpIDwgb2xkX2JvLT5t
ZW0ubnVtX3BhZ2VzOyArK2kpIHsKIAkJYm9vbCBkdW1teTsKIAogCQlyZXQgPSB0dG1fYm9fa21h
cChvbGRfYm8sIGksIDEsICZvbGRfbWFwKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92
bXdnZngvdm13Z2Z4X2V4ZWNidWYuYyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2V4
ZWNidWYuYwppbmRleCBlNjdlMmU4ZjZlNmYuLjcyYmQ2ZDk0MWQyNCAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfZXhlY2J1Zi5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS92bXdnZngvdm13Z2Z4X2V4ZWNidWYuYwpAQCAtMTA0Miw3ICsxMDQyLDcgQEAgc3RhdGljIGlu
dCB2bXdfcXVlcnlfYm9fc3dpdGNoX3ByZXBhcmUoc3RydWN0IHZtd19wcml2YXRlICpkZXZfcHJp
diwKIAogCWlmICh1bmxpa2VseShuZXdfcXVlcnlfYm8gIT0gc3dfY29udGV4dC0+Y3VyX3F1ZXJ5
X2JvKSkgewogCi0JCWlmICh1bmxpa2VseShuZXdfcXVlcnlfYm8tPmJhc2UubnVtX3BhZ2VzID4g
NCkpIHsKKwkJaWYgKHVubGlrZWx5KG5ld19xdWVyeV9iby0+YmFzZS5tZW0ubnVtX3BhZ2VzID4g
NCkpIHsKIAkJCVZNV19ERUJVR19VU0VSKCJRdWVyeSBidWZmZXIgdG9vIGxhcmdlLlxuIik7CiAJ
CQlyZXR1cm4gLUVJTlZBTDsKIAkJfQpAQCAtMTU0MSw3ICsxNTQxLDcgQEAgc3RhdGljIGludCB2
bXdfY21kX2RtYShzdHJ1Y3Qgdm13X3ByaXZhdGUgKmRldl9wcml2LAogCQlyZXR1cm4gcmV0Owog
CiAJLyogTWFrZSBzdXJlIERNQSBkb2Vzbid0IGNyb3NzIEJPIGJvdW5kYXJpZXMuICovCi0JYm9f
c2l6ZSA9IHZtd19iby0+YmFzZS5udW1fcGFnZXMgKiBQQUdFX1NJWkU7CisJYm9fc2l6ZSA9IHZt
d19iby0+YmFzZS5zaXplOwogCWlmICh1bmxpa2VseShjbWQtPmJvZHkuZ3Vlc3QucHRyLm9mZnNl
dCA+IGJvX3NpemUpKSB7CiAJCVZNV19ERUJVR19VU0VSKCJJbnZhbGlkIERNQSBvZmZzZXQuXG4i
KTsKIAkJcmV0dXJuIC1FSU5WQUw7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4
L3Ztd2dmeF9nbXJpZF9tYW5hZ2VyLmMgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9n
bXJpZF9tYW5hZ2VyLmMKaW5kZXggOGZlMjZlMzJmOTIwLi4xNzc0OTYwZDFiODkgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2dtcmlkX21hbmFnZXIuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9nbXJpZF9tYW5hZ2VyLmMKQEAgLTY0LDIwICs2
NCwxOSBAQCBzdGF0aWMgaW50IHZtd19nbXJpZF9tYW5fZ2V0X25vZGUoc3RydWN0IHR0bV9yZXNv
dXJjZV9tYW5hZ2VyICptYW4sCiAJc3Bpbl9sb2NrKCZnbWFuLT5sb2NrKTsKIAogCWlmIChnbWFu
LT5tYXhfZ21yX3BhZ2VzID4gMCkgewotCQlnbWFuLT51c2VkX2dtcl9wYWdlcyArPSBiby0+bnVt
X3BhZ2VzOworCQlnbWFuLT51c2VkX2dtcl9wYWdlcyArPSBtZW0tPm51bV9wYWdlczsKIAkJaWYg
KHVubGlrZWx5KGdtYW4tPnVzZWRfZ21yX3BhZ2VzID4gZ21hbi0+bWF4X2dtcl9wYWdlcykpCiAJ
CQlnb3RvIG5vc3BhY2U7CiAJfQogCiAJbWVtLT5tbV9ub2RlID0gZ21hbjsKIAltZW0tPnN0YXJ0
ID0gaWQ7Ci0JbWVtLT5udW1fcGFnZXMgPSBiby0+bnVtX3BhZ2VzOwogCiAJc3Bpbl91bmxvY2so
JmdtYW4tPmxvY2spOwogCXJldHVybiAwOwogCiBub3NwYWNlOgotCWdtYW4tPnVzZWRfZ21yX3Bh
Z2VzIC09IGJvLT5udW1fcGFnZXM7CisJZ21hbi0+dXNlZF9nbXJfcGFnZXMgLT0gbWVtLT5udW1f
cGFnZXM7CiAJc3Bpbl91bmxvY2soJmdtYW4tPmxvY2spOwogCWlkYV9mcmVlKCZnbWFuLT5nbXJf
aWRhLCBpZCk7CiAJcmV0dXJuIC1FTk9TUEM7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
dm13Z2Z4L3Ztd2dmeF9rbXMuYyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2ttcy5j
CmluZGV4IGJjNjdmMmI5MzBlMS4uMzQ3YWZmNjIwMWY2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vdm13Z2Z4L3Ztd2dmeF9rbXMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Zt
d2dmeF9rbXMuYwpAQCAtMTIyMCw3ICsxMjIwLDcgQEAgc3RhdGljIGludCB2bXdfa21zX25ld19m
cmFtZWJ1ZmZlcl9ibyhzdHJ1Y3Qgdm13X3ByaXZhdGUgKmRldl9wcml2LAogCWludCByZXQ7CiAK
IAlyZXF1ZXN0ZWRfc2l6ZSA9IG1vZGVfY21kLT5oZWlnaHQgKiBtb2RlX2NtZC0+cGl0Y2hlc1sw
XTsKLQlpZiAodW5saWtlbHkocmVxdWVzdGVkX3NpemUgPiBiby0+YmFzZS5udW1fcGFnZXMgKiBQ
QUdFX1NJWkUpKSB7CisJaWYgKHVubGlrZWx5KHJlcXVlc3RlZF9zaXplID4gYm8tPmJhc2Uuc2l6
ZSkpIHsKIAkJRFJNX0VSUk9SKCJTY3JlZW4gYnVmZmVyIG9iamVjdCBzaXplIGlzIHRvbyBzbWFs
bCAiCiAJCQkgICJmb3IgcmVxdWVzdGVkIG1vZGUuXG4iKTsKIAkJcmV0dXJuIC1FSU5WQUw7CmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9wYWdlX2RpcnR5LmMgYi9k
cml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9wYWdlX2RpcnR5LmMKaW5kZXggMGI3NmIzZDE3
ZDRjLi4wYTkwMGFmYzY2ZmYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13
Z2Z4X3BhZ2VfZGlydHkuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9wYWdl
X2RpcnR5LmMKQEAgLTIzMiw3ICsyMzIsNyBAQCB2b2lkIHZtd19ib19kaXJ0eV91bm1hcChzdHJ1
Y3Qgdm13X2J1ZmZlcl9vYmplY3QgKnZibywKIGludCB2bXdfYm9fZGlydHlfYWRkKHN0cnVjdCB2
bXdfYnVmZmVyX29iamVjdCAqdmJvKQogewogCXN0cnVjdCB2bXdfYm9fZGlydHkgKmRpcnR5ID0g
dmJvLT5kaXJ0eTsKLQlwZ29mZl90IG51bV9wYWdlcyA9IHZiby0+YmFzZS5udW1fcGFnZXM7CisJ
cGdvZmZfdCBudW1fcGFnZXMgPSB2Ym8tPmJhc2UubWVtLm51bV9wYWdlczsKIAlzaXplX3Qgc2l6
ZSwgYWNjX3NpemU7CiAJaW50IHJldDsKIAlzdGF0aWMgc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4
IGN0eCA9IHsKQEAgLTQxMyw3ICs0MTMsNyBAQCB2bV9mYXVsdF90IHZtd19ib192bV9ta3dyaXRl
KHN0cnVjdCB2bV9mYXVsdCAqdm1mKQogCQlyZXR1cm4gcmV0OwogCiAJcGFnZV9vZmZzZXQgPSB2
bWYtPnBnb2ZmIC0gZHJtX3ZtYV9ub2RlX3N0YXJ0KCZiby0+YmFzZS52bWFfbm9kZSk7Ci0JaWYg
KHVubGlrZWx5KHBhZ2Vfb2Zmc2V0ID49IGJvLT5udW1fcGFnZXMpKSB7CisJaWYgKHVubGlrZWx5
KHBhZ2Vfb2Zmc2V0ID49IGJvLT5tZW0ubnVtX3BhZ2VzKSkgewogCQlyZXQgPSBWTV9GQVVMVF9T
SUdCVVM7CiAJCWdvdG8gb3V0X3VubG9jazsKIAl9CkBAIC00NTYsNyArNDU2LDcgQEAgdm1fZmF1
bHRfdCB2bXdfYm9fdm1fZmF1bHQoc3RydWN0IHZtX2ZhdWx0ICp2bWYpCiAKIAkJcGFnZV9vZmZz
ZXQgPSB2bWYtPnBnb2ZmIC0KIAkJCWRybV92bWFfbm9kZV9zdGFydCgmYm8tPmJhc2Uudm1hX25v
ZGUpOwotCQlpZiAocGFnZV9vZmZzZXQgPj0gYm8tPm51bV9wYWdlcyB8fAorCQlpZiAocGFnZV9v
ZmZzZXQgPj0gYm8tPm1lbS5udW1fcGFnZXMgfHwKIAkJICAgIHZtd19yZXNvdXJjZXNfY2xlYW4o
dmJvLCBwYWdlX29mZnNldCwKIAkJCQkJcGFnZV9vZmZzZXQgKyBQQUdFX1NJWkUsCiAJCQkJCSZh
bGxvd2VkX3ByZWZhdWx0KSkgewpAQCAtNTMxLDcgKzUzMSw3IEBAIHZtX2ZhdWx0X3Qgdm13X2Jv
X3ZtX2h1Z2VfZmF1bHQoc3RydWN0IHZtX2ZhdWx0ICp2bWYsCiAKIAkJcGFnZV9vZmZzZXQgPSB2
bWYtPnBnb2ZmIC0KIAkJCWRybV92bWFfbm9kZV9zdGFydCgmYm8tPmJhc2Uudm1hX25vZGUpOwot
CQlpZiAocGFnZV9vZmZzZXQgPj0gYm8tPm51bV9wYWdlcyB8fAorCQlpZiAocGFnZV9vZmZzZXQg
Pj0gYm8tPm1lbS5udW1fcGFnZXMgfHwKIAkJICAgIHZtd19yZXNvdXJjZXNfY2xlYW4odmJvLCBw
YWdlX29mZnNldCwKIAkJCQkJcGFnZV9vZmZzZXQgKyBQQUdFX1NJWkUsCiAJCQkJCSZhbGxvd2Vk
X3ByZWZhdWx0KSkgewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhf
cmVzb3VyY2UuYyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3Jlc291cmNlLmMKaW5k
ZXggMDBiNTM1ODMxYTdhLi44NGVkODM3NmNkODEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS92bXdnZngvdm13Z2Z4X3Jlc291cmNlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92
bXdnZnhfcmVzb3VyY2UuYwpAQCAtMzYwLDcgKzM2MCw3IEBAIHN0YXRpYyBpbnQgdm13X3Jlc291
cmNlX2J1Zl9hbGxvYyhzdHJ1Y3Qgdm13X3Jlc291cmNlICpyZXMsCiAJaW50IHJldDsKIAogCWlm
IChsaWtlbHkocmVzLT5iYWNrdXApKSB7Ci0JCUJVR19PTihyZXMtPmJhY2t1cC0+YmFzZS5udW1f
cGFnZXMgKiBQQUdFX1NJWkUgPCBzaXplKTsKKwkJQlVHX09OKHJlcy0+YmFja3VwLT5iYXNlLnNp
emUgPCBzaXplKTsKIAkJcmV0dXJuIDA7CiAJfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vdm13Z2Z4L3Ztd2dmeF9zaGFkZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4
X3NoYWRlci5jCmluZGV4IGYzMjhhYTU4MzlhMi4uYzcyMjBhNzcwYmM1IDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9zaGFkZXIuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vdm13Z2Z4L3Ztd2dmeF9zaGFkZXIuYwpAQCAtODU2LDggKzg1Niw3IEBAIHN0YXRpYyBpbnQg
dm13X3NoYWRlcl9kZWZpbmUoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgc3RydWN0IGRybV9maWxl
ICpmaWxlX3ByaXYsCiAJCQlyZXR1cm4gcmV0OwogCQl9CiAKLQkJaWYgKCh1NjQpYnVmZmVyLT5i
YXNlLm51bV9wYWdlcyAqIFBBR0VfU0laRSA8Ci0JCSAgICAodTY0KXNpemUgKyAodTY0KW9mZnNl
dCkgeworCQlpZiAoKHU2NClidWZmZXItPmJhc2Uuc2l6ZSA8ICh1NjQpc2l6ZSArICh1NjQpb2Zm
c2V0KSB7CiAJCQlWTVdfREVCVUdfVVNFUigiSWxsZWdhbCBidWZmZXItIG9yIHNoYWRlciBzaXpl
LlxuIik7CiAJCQlyZXQgPSAtRUlOVkFMOwogCQkJZ290byBvdXRfYmFkX2FyZzsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3N0ZHUuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS92bXdnZngvdm13Z2Z4X3N0ZHUuYwppbmRleCA1YjA0ZWMwNDdlZjMuLjM2MmExMjdiMjRiYiAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfc3RkdS5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3N0ZHUuYwpAQCAtNTEyLDcgKzUxMiw3IEBAIHN0
YXRpYyB2b2lkIHZtd19zdGR1X2JvX2ZpZm9fY29tbWl0KHN0cnVjdCB2bXdfa21zX2RpcnR5ICpk
aXJ0eSkKIAljbWQtPmJvZHkuaG9zdC5taXBtYXAgPSAwOwogCWNtZC0+Ym9keS50cmFuc2ZlciA9
IGRkaXJ0eS0+dHJhbnNmZXI7CiAJc3VmZml4LT5zdWZmaXhTaXplID0gc2l6ZW9mKCpzdWZmaXgp
OwotCXN1ZmZpeC0+bWF4aW11bU9mZnNldCA9IGRkaXJ0eS0+YnVmLT5iYXNlLm51bV9wYWdlcyAq
IFBBR0VfU0laRTsKKwlzdWZmaXgtPm1heGltdW1PZmZzZXQgPSBkZGlydHktPmJ1Zi0+YmFzZS5z
aXplOwogCiAJaWYgKGRkaXJ0eS0+dHJhbnNmZXIgPT0gU1ZHQTNEX1dSSVRFX0hPU1RfVlJBTSkg
ewogCQlibGl0X3NpemUgKz0gc2l6ZW9mKHN0cnVjdCB2bXdfc3RkdV91cGRhdGUpOwpAQCAtMTIz
OCw3ICsxMjM4LDcgQEAgc3RhdGljIHVpbnQzMl90IHZtd19zdGR1X2JvX3BvcHVsYXRlX3VwZGF0
ZShzdHJ1Y3Qgdm13X2R1X3VwZGF0ZV9wbGFuZSAgKnVwZGF0ZSwKIAl2ZmJibyA9IGNvbnRhaW5l
cl9vZih1cGRhdGUtPnZmYiwgdHlwZW9mKCp2ZmJibyksIGJhc2UpOwogCiAJc3VmZml4LT5zdWZm
aXhTaXplID0gc2l6ZW9mKCpzdWZmaXgpOwotCXN1ZmZpeC0+bWF4aW11bU9mZnNldCA9IHZmYmJv
LT5idWZmZXItPmJhc2UubnVtX3BhZ2VzICogUEFHRV9TSVpFOworCXN1ZmZpeC0+bWF4aW11bU9m
ZnNldCA9IHZmYmJvLT5idWZmZXItPmJhc2Uuc2l6ZTsKIAogCXZtd19zdGR1X3BvcHVsYXRlX3Vw
ZGF0ZSgmc3VmZml4WzFdLCBzdGR1LT5iYXNlLnVuaXQsIGJiLT54MSwgYmItPngyLAogCQkJCSBi
Yi0+eTEsIGJiLT55Mik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dm
eF9zdXJmYWNlLmMgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9zdXJmYWNlLmMKaW5k
ZXggMzkxNGJmZWUwNTMzLi42YTAyYmFkODQxNmIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS92bXdnZngvdm13Z2Z4X3N1cmZhY2UuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Zt
d2dmeF9zdXJmYWNlLmMKQEAgLTE1NTAsOCArMTU1MCw3IEBAIHZtd19nYl9zdXJmYWNlX2RlZmlu
ZV9pbnRlcm5hbChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogCQkJCQkgJnJlcy0+YmFja3VwLAog
CQkJCQkgJnVzZXJfc3JmLT5iYWNrdXBfYmFzZSk7CiAJCWlmIChyZXQgPT0gMCkgewotCQkJaWYg
KHJlcy0+YmFja3VwLT5iYXNlLm51bV9wYWdlcyAqIFBBR0VfU0laRSA8Ci0JCQkgICAgcmVzLT5i
YWNrdXBfc2l6ZSkgeworCQkJaWYgKHJlcy0+YmFja3VwLT5iYXNlLnNpemUgPCByZXMtPmJhY2t1
cF9zaXplKSB7CiAJCQkJVk1XX0RFQlVHX1VTRVIoIlN1cmZhY2UgYmFja3VwIGJ1ZmZlciB0b28g
c21hbGwuXG4iKTsKIAkJCQl2bXdfYm9fdW5yZWZlcmVuY2UoJnJlcy0+YmFja3VwKTsKIAkJCQly
ZXQgPSAtRUlOVkFMOwpAQCAtMTYxNCw3ICsxNjEzLDcgQEAgdm13X2diX3N1cmZhY2VfZGVmaW5l
X2ludGVybmFsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJaWYgKHJlcy0+YmFja3VwKSB7CiAJ
CXJlcC0+YnVmZmVyX21hcF9oYW5kbGUgPQogCQkJZHJtX3ZtYV9ub2RlX29mZnNldF9hZGRyKCZy
ZXMtPmJhY2t1cC0+YmFzZS5iYXNlLnZtYV9ub2RlKTsKLQkJcmVwLT5idWZmZXJfc2l6ZSA9IHJl
cy0+YmFja3VwLT5iYXNlLm51bV9wYWdlcyAqIFBBR0VfU0laRTsKKwkJcmVwLT5idWZmZXJfc2l6
ZSA9IHJlcy0+YmFja3VwLT5iYXNlLnNpemU7CiAJCXJlcC0+YnVmZmVyX2hhbmRsZSA9IGJhY2t1
cF9oYW5kbGU7CiAJfSBlbHNlIHsKIAkJcmVwLT5idWZmZXJfbWFwX2hhbmRsZSA9IDA7CkBAIC0x
NjkyLDcgKzE2OTEsNyBAQCB2bXdfZ2Jfc3VyZmFjZV9yZWZlcmVuY2VfaW50ZXJuYWwoc3RydWN0
IGRybV9kZXZpY2UgKmRldiwKIAlyZXAtPmNyZXAuYnVmZmVyX2hhbmRsZSA9IGJhY2t1cF9oYW5k
bGU7CiAJcmVwLT5jcmVwLmJ1ZmZlcl9tYXBfaGFuZGxlID0KIAkJZHJtX3ZtYV9ub2RlX29mZnNl
dF9hZGRyKCZzcmYtPnJlcy5iYWNrdXAtPmJhc2UuYmFzZS52bWFfbm9kZSk7Ci0JcmVwLT5jcmVw
LmJ1ZmZlcl9zaXplID0gc3JmLT5yZXMuYmFja3VwLT5iYXNlLm51bV9wYWdlcyAqIFBBR0VfU0la
RTsKKwlyZXAtPmNyZXAuYnVmZmVyX3NpemUgPSBzcmYtPnJlcy5iYWNrdXAtPmJhc2Uuc2l6ZTsK
IAogCXJlcC0+Y3JlcS52ZXJzaW9uID0gZHJtX3Ztd19nYl9zdXJmYWNlX3YxOwogCXJlcC0+Y3Jl
cS5zdmdhM2RfZmxhZ3NfdXBwZXJfMzJfYml0cyA9CmRpZmYgLS1naXQgYS9pbmNsdWRlL2RybS90
dG0vdHRtX2JvX2FwaS5oIGIvaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19hcGkuaAppbmRleCA3OWI5
MzY3ZTBmZmQuLjAzNjc1Y2U3YWIzYyAxMDA2NDQKLS0tIGEvaW5jbHVkZS9kcm0vdHRtL3R0bV9i
b19hcGkuaAorKysgYi9pbmNsdWRlL2RybS90dG0vdHRtX2JvX2FwaS5oCkBAIC0xMjUsNyArMTI1
LDcgQEAgc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0IHsKIAlzdHJ1Y3QgdHRtX2JvX2RldmljZSAq
YmRldjsKIAllbnVtIHR0bV9ib190eXBlIHR5cGU7CiAJdm9pZCAoKmRlc3Ryb3kpIChzdHJ1Y3Qg
dHRtX2J1ZmZlcl9vYmplY3QgKik7Ci0JdW5zaWduZWQgbG9uZyBudW1fcGFnZXM7CisJdWludDY0
X3Qgc2l6ZTsKIAlzaXplX3QgYWNjX3NpemU7CiAKIAkvKioKQEAgLTM5Nyw3ICszOTcsNyBAQCBz
aXplX3QgdHRtX2JvX2RtYV9hY2Nfc2l6ZShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKIAog
aW50IHR0bV9ib19pbml0X3Jlc2VydmVkKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAogCQkJ
IHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCi0JCQkgdW5zaWduZWQgbG9uZyBzaXplLAor
CQkJIHVpbnQ2NF90IHNpemUsCiAJCQkgZW51bSB0dG1fYm9fdHlwZSB0eXBlLAogCQkJIHN0cnVj
dCB0dG1fcGxhY2VtZW50ICpwbGFjZW1lbnQsCiAJCQkgdWludDMyX3QgcGFnZV9hbGlnbm1lbnQs
CkBAIC00NDUsNyArNDQ1LDcgQEAgaW50IHR0bV9ib19pbml0X3Jlc2VydmVkKHN0cnVjdCB0dG1f
Ym9fZGV2aWNlICpiZGV2LAogICogLUVSRVNUQVJUU1lTOiBJbnRlcnJ1cHRlZCBieSBzaWduYWwg
d2hpbGUgc2xlZXBpbmcgd2FpdGluZyBmb3IgcmVzb3VyY2VzLgogICovCiBpbnQgdHRtX2JvX2lu
aXQoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAq
Ym8sCi0JCXVuc2lnbmVkIGxvbmcgc2l6ZSwgZW51bSB0dG1fYm9fdHlwZSB0eXBlLAorCQl1aW50
NjRfdCBzaXplLCBlbnVtIHR0bV9ib190eXBlIHR5cGUsCiAJCXN0cnVjdCB0dG1fcGxhY2VtZW50
ICpwbGFjZW1lbnQsCiAJCXVpbnQzMl90IHBhZ2VfYWxpZ25tZW50LCBib29sIGludGVycnVidGli
bGUsIHNpemVfdCBhY2Nfc2l6ZSwKIAkJc3RydWN0IHNnX3RhYmxlICpzZywgc3RydWN0IGRtYV9y
ZXN2ICpyZXN2LApkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0vdHRtL3R0bV9yZXNvdXJjZS5oIGIv
aW5jbHVkZS9kcm0vdHRtL3R0bV9yZXNvdXJjZS5oCmluZGV4IGY0OGE3MGQzOWFjNS4uYWQ2ZGE5
OTc3MGU5IDEwMDY0NAotLS0gYS9pbmNsdWRlL2RybS90dG0vdHRtX3Jlc291cmNlLmgKKysrIGIv
aW5jbHVkZS9kcm0vdHRtL3R0bV9yZXNvdXJjZS5oCkBAIC0xNzEsNyArMTcxLDYgQEAgc3RydWN0
IHR0bV9idXNfcGxhY2VtZW50IHsKIHN0cnVjdCB0dG1fcmVzb3VyY2UgewogCXZvaWQgKm1tX25v
ZGU7CiAJdW5zaWduZWQgbG9uZyBzdGFydDsKLQl1bnNpZ25lZCBsb25nIHNpemU7CiAJdW5zaWdu
ZWQgbG9uZyBudW1fcGFnZXM7CiAJdWludDMyX3QgcGFnZV9hbGlnbm1lbnQ7CiAJdWludDMyX3Qg
bWVtX3R5cGU7Ci0tIAoyLjI1LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVk
ZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZv
L2RyaS1kZXZlbAo=
