Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 3004BF07D1
	for <lists+dri-devel@lfdr.de>; Tue,  5 Nov 2019 22:10:58 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A13276E9D9;
	Tue,  5 Nov 2019 21:10:55 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-yb1-xb42.google.com (mail-yb1-xb42.google.com
 [IPv6:2607:f8b0:4864:20::b42])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 474196E9D9
 for <dri-devel@lists.freedesktop.org>; Tue,  5 Nov 2019 21:10:53 +0000 (UTC)
Received: by mail-yb1-xb42.google.com with SMTP id x14so4825052ybq.12
 for <dri-devel@lists.freedesktop.org>; Tue, 05 Nov 2019 13:10:53 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=Ta1Xwfa+QeAgFSaukNPJQ5uJyx0Z9KTcb0vCHsmGyFQ=;
 b=ulHQ/ThhzE98kgWt7gK/Q6Wr5PDBePhGWHVUm1nIuMR37Zb0v4ZPxjwHmZeUNF064A
 Lm4HYfuw9qsI7GXpEh04hkjTTTDunMdFAnXYd8jCN5H7n/V2AJF8SMeg18vpfNzAp/BV
 ria6mxukaeoS+YWfLsipjgDdZH5noHObSyA6UcxlqzmVZAknPEs0er7hRM0KfjGY8zWI
 d8wuE8B+WsScV2AIevmexq3eWnZxszDRn/vy4qUzFyHdmsZXVuUNTyx7H6V3XuGFcDQt
 cFDqVeMLNr/Wc5JV/XJDt9h27lDouN2IzxyRoTfvo2PCMjR8oWMIWD93xrLlQzZTjPj5
 dlag==
X-Gm-Message-State: APjAAAVb9UrFAJDpcC/cGWoaAvrq2OJP2qvwH1wYhWGSYBcvhGnkKj5y
 TLuNHi6IlBek8uDbYlM+tbw3RJQ8ED8=
X-Google-Smtp-Source: APXvYqylGH6ZNkY6K1tLbHFtvCxKxcHMgw9PDG6CbQLvQSvJUEARUn/PSgkolxKP8MpBrxfh0FKWzw==
X-Received: by 2002:a25:cc84:: with SMTP id
 l126mr28076860ybf.249.1572988252193; 
 Tue, 05 Nov 2019 13:10:52 -0800 (PST)
Received: from rosewood.cam.corp.google.com
 ([2620:0:1013:11:89c6:2139:5435:371d])
 by smtp.gmail.com with ESMTPSA id j66sm1815216ywb.101.2019.11.05.13.10.51
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 05 Nov 2019 13:10:51 -0800 (PST)
From: Sean Paul <sean@poorly.run>
To: dri-devel@lists.freedesktop.org,
	linux-mediatek@lists.infradead.org
Subject: [PATCH v2 2/7] drm/mediatek: Add helper to get component for a plane
Date: Tue,  5 Nov 2019 16:10:19 -0500
Message-Id: <20191105211034.123937-3-sean@poorly.run>
X-Mailer: git-send-email 2.24.0.rc1.363.gb1bccd3e3d-goog
In-Reply-To: <20191105211034.123937-1-sean@poorly.run>
References: <20191105211034.123937-1-sean@poorly.run>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=poorly.run; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=Ta1Xwfa+QeAgFSaukNPJQ5uJyx0Z9KTcb0vCHsmGyFQ=;
 b=XA/fs7qgEdfJZML+yaAQj0RuclIsRF7Ra54ebOTOISjSJsvFenImCTBE6H+Tya5FKp
 YlAwTnFfG8ezZMDaqA0HJZikqdEHYac7VFwjzlzBpKZ4sG3lqdDZqtpWWJiMkD/T6x3X
 EFSD8vOEyexf+Odjr1tXCZa9CX35E54Jm5ooFUlPNOVyFOSa9IljuapxUFX2L2ySKvlw
 8AZp/urnvC+xMC+E0XaBzF2do4tcNa1YV+RS2fyLicN1Biz6DJQ019Cj8AHzPAnMGFeS
 PGwJf4Rmu/viUbcl2eIoqpebK0yG/Xg5GgEryWs7INnvw46teyCbUNsZuZj8S1dKmTSD
 MCsQ==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: dcastagna@chromium.org, matthias.bgg@gmail.com, mcasas@chromium.org,
 Sean Paul <seanpaul@chromium.org>, frkoenig@chromium.org,
 linux-arm-kernel@lists.infradead.org, markyacoub@google.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogU2VhbiBQYXVsIDxzZWFucGF1bEBjaHJvbWl1bS5vcmc+CgpJbnN0ZWFkIG9mIGhhcmQt
Y29kaW5nIHdoaWNoIGNvbXBvbmVudHMgaGF2ZSBwbGFuZXMsIGFkZCBhIGhlbHBlcgpmdW5jdGlv
biB0byB3YWxrIHRoZSBjb21wb25lbnRzIGFuZCBtYXAgYSBwbGFuZSBpbmRleCB0byBhIGNvbXBv
bmVudApsYXllci4KClNpZ25lZC1vZmYtYnk6IFNlYW4gUGF1bCA8c2VhbnBhdWxAY2hyb21pdW0u
b3JnPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2NydGMuYyB8IDU2ICsr
KysrKysrKysrKysrKy0tLS0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCAzNCBpbnNlcnRpb25zKCsp
LCAyMiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsv
bXRrX2RybV9jcnRjLmMgYi9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9jcnRjLmMK
aW5kZXggN2QwZjUwZGE4ZTQwLi5jY2YzOTVmMTdhOTkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9tZWRpYXRlay9tdGtfZHJtX2NydGMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0
ZWsvbXRrX2RybV9jcnRjLmMKQEAgLTIwNyw2ICsyMDcsMjggQEAgc3RhdGljIHZvaWQgbXRrX2Ny
dGNfZGRwX2Nsa19kaXNhYmxlKHN0cnVjdCBtdGtfZHJtX2NydGMgKm10a19jcnRjKQogCQljbGtf
ZGlzYWJsZV91bnByZXBhcmUobXRrX2NydGMtPmRkcF9jb21wW2ldLT5jbGspOwogfQogCitzdGF0
aWMKK3N0cnVjdCBtdGtfZGRwX2NvbXAgKm10a19kcm1fZGRwX2NvbXBfZm9yX3BsYW5lKHN0cnVj
dCBkcm1fY3J0YyAqY3J0YywKKwkJCQkJCXN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLAorCQkJCQkJ
dW5zaWduZWQgaW50ICpsb2NhbF9sYXllcikKK3sKKwlzdHJ1Y3QgbXRrX2RybV9jcnRjICptdGtf
Y3J0YyA9IHRvX210a19jcnRjKGNydGMpOworCXN0cnVjdCBtdGtfZGRwX2NvbXAgKmNvbXA7CisJ
aW50IGksIGNvdW50ID0gMDsKKworCWZvciAoaSA9IDA7IGkgPCBtdGtfY3J0Yy0+ZGRwX2NvbXBf
bnI7IGkrKykgeworCQljb21wID0gbXRrX2NydGMtPmRkcF9jb21wW2ldOworCQlpZiAocGxhbmUt
PmluZGV4IDwgKGNvdW50ICsgbXRrX2RkcF9jb21wX2xheWVyX25yKGNvbXApKSkgeworCQkJKmxv
Y2FsX2xheWVyID0gcGxhbmUtPmluZGV4IC0gY291bnQ7CisJCQlyZXR1cm4gY29tcDsKKwkJfQor
CQljb3VudCArPSBtdGtfZGRwX2NvbXBfbGF5ZXJfbnIoY29tcCk7CisJfQorCisJV0FSTigxLCAi
RmFpbGVkIHRvIGZpbmQgY29tcG9uZW50IGZvciBwbGFuZSAlZFxuIiwgcGxhbmUtPmluZGV4KTsK
KwlyZXR1cm4gTlVMTDsKK30KKwogc3RhdGljIGludCBtdGtfY3J0Y19kZHBfaHdfaW5pdChzdHJ1
Y3QgbXRrX2RybV9jcnRjICptdGtfY3J0YykKIHsKIAlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSAm
bXRrX2NydGMtPmJhc2U7CkBAIC0yODMsMTkgKzMwNSwxMiBAQCBzdGF0aWMgaW50IG10a19jcnRj
X2RkcF9od19pbml0KHN0cnVjdCBtdGtfZHJtX2NydGMgKm10a19jcnRjKQogCWZvciAoaSA9IDA7
IGkgPCBtdGtfY3J0Yy0+bGF5ZXJfbnI7IGkrKykgewogCQlzdHJ1Y3QgZHJtX3BsYW5lICpwbGFu
ZSA9ICZtdGtfY3J0Yy0+cGxhbmVzW2ldOwogCQlzdHJ1Y3QgbXRrX3BsYW5lX3N0YXRlICpwbGFu
ZV9zdGF0ZTsKLQkJc3RydWN0IG10a19kZHBfY29tcCAqY29tcCA9IG10a19jcnRjLT5kZHBfY29t
cFswXTsKLQkJdW5zaWduZWQgaW50IGNvbXBfbGF5ZXJfbnIgPSBtdGtfZGRwX2NvbXBfbGF5ZXJf
bnIoY29tcCk7CisJCXN0cnVjdCBtdGtfZGRwX2NvbXAgKmNvbXA7CiAJCXVuc2lnbmVkIGludCBs
b2NhbF9sYXllcjsKIAogCQlwbGFuZV9zdGF0ZSA9IHRvX210a19wbGFuZV9zdGF0ZShwbGFuZS0+
c3RhdGUpOwotCi0JCWlmIChpID49IGNvbXBfbGF5ZXJfbnIpIHsKLQkJCWNvbXAgPSBtdGtfY3J0
Yy0+ZGRwX2NvbXBbMV07Ci0JCQlsb2NhbF9sYXllciA9IGkgLSBjb21wX2xheWVyX25yOwotCQl9
IGVsc2UKLQkJCWxvY2FsX2xheWVyID0gaTsKLQkJbXRrX2RkcF9jb21wX2xheWVyX2NvbmZpZyhj
b21wLCBsb2NhbF9sYXllciwKLQkJCQkJICBwbGFuZV9zdGF0ZSk7CisJCWNvbXAgPSBtdGtfZHJt
X2RkcF9jb21wX2Zvcl9wbGFuZShjcnRjLCBwbGFuZSwgJmxvY2FsX2xheWVyKTsKKwkJbXRrX2Rk
cF9jb21wX2xheWVyX2NvbmZpZyhjb21wLCBsb2NhbF9sYXllciwgcGxhbmVfc3RhdGUpOwogCX0K
IAogCXJldHVybiAwOwpAQCAtMzQzLDcgKzM1OCw2IEBAIHN0YXRpYyB2b2lkIG10a19jcnRjX2Rk
cF9jb25maWcoc3RydWN0IGRybV9jcnRjICpjcnRjKQogCXN0cnVjdCBtdGtfY3J0Y19zdGF0ZSAq
c3RhdGUgPSB0b19tdGtfY3J0Y19zdGF0ZShtdGtfY3J0Yy0+YmFzZS5zdGF0ZSk7CiAJc3RydWN0
IG10a19kZHBfY29tcCAqY29tcCA9IG10a19jcnRjLT5kZHBfY29tcFswXTsKIAl1bnNpZ25lZCBp
bnQgaTsKLQl1bnNpZ25lZCBpbnQgY29tcF9sYXllcl9uciA9IG10a19kZHBfY29tcF9sYXllcl9u
cihjb21wKTsKIAl1bnNpZ25lZCBpbnQgbG9jYWxfbGF5ZXI7CiAKIAkvKgpAQCAtMzY2LDE3ICsz
ODAsMTUgQEAgc3RhdGljIHZvaWQgbXRrX2NydGNfZGRwX2NvbmZpZyhzdHJ1Y3QgZHJtX2NydGMg
KmNydGMpCiAKIAkJCXBsYW5lX3N0YXRlID0gdG9fbXRrX3BsYW5lX3N0YXRlKHBsYW5lLT5zdGF0
ZSk7CiAKLQkJCWlmIChwbGFuZV9zdGF0ZS0+cGVuZGluZy5jb25maWcpIHsKLQkJCQlpZiAoaSA+
PSBjb21wX2xheWVyX25yKSB7Ci0JCQkJCWNvbXAgPSBtdGtfY3J0Yy0+ZGRwX2NvbXBbMV07Ci0J
CQkJCWxvY2FsX2xheWVyID0gaSAtIGNvbXBfbGF5ZXJfbnI7Ci0JCQkJfSBlbHNlCi0JCQkJCWxv
Y2FsX2xheWVyID0gaTsKLQotCQkJCW10a19kZHBfY29tcF9sYXllcl9jb25maWcoY29tcCwgbG9j
YWxfbGF5ZXIsCi0JCQkJCQkJICBwbGFuZV9zdGF0ZSk7Ci0JCQkJcGxhbmVfc3RhdGUtPnBlbmRp
bmcuY29uZmlnID0gZmFsc2U7Ci0JCQl9CisJCQlpZiAoIXBsYW5lX3N0YXRlLT5wZW5kaW5nLmNv
bmZpZykKKwkJCQljb250aW51ZTsKKworCQkJY29tcCA9IG10a19kcm1fZGRwX2NvbXBfZm9yX3Bs
YW5lKGNydGMsIHBsYW5lLAorCQkJCQkJCSAgJmxvY2FsX2xheWVyKTsKKworCQkJbXRrX2RkcF9j
b21wX2xheWVyX2NvbmZpZyhjb21wLCBsb2NhbF9sYXllciwKKwkJCQkJCSAgcGxhbmVfc3RhdGUp
OworCQkJcGxhbmVfc3RhdGUtPnBlbmRpbmcuY29uZmlnID0gZmFsc2U7CiAJCX0KIAkJbXRrX2Ny
dGMtPnBlbmRpbmdfcGxhbmVzID0gZmFsc2U7CiAJfQotLSAKU2VhbiBQYXVsLCBTb2Z0d2FyZSBF
bmdpbmVlciwgR29vZ2xlIC8gQ2hyb21pdW0gT1MKCl9fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxp
c3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFu
L2xpc3RpbmZvL2RyaS1kZXZlbA==
