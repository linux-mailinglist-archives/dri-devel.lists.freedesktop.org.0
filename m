Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 567955E616
	for <lists+dri-devel@lfdr.de>; Wed,  3 Jul 2019 16:08:11 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 230516E146;
	Wed,  3 Jul 2019 14:08:08 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from smtp.domeneshop.no (smtp.domeneshop.no
 [IPv6:2a01:5b40:0:3005::1])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0D8C8899C7
 for <dri-devel@lists.freedesktop.org>; Wed,  3 Jul 2019 14:08:06 +0000 (UTC)
Received: from 211.81-166-168.customer.lyse.net ([81.166.168.211]:61524
 helo=[192.168.10.173])
 by smtp.domeneshop.no with esmtpsa (TLS1.2:ECDHE_RSA_AES_128_GCM_SHA256:128)
 (Exim 4.84_2) (envelope-from <noralf@tronnes.org>)
 id 1hifvZ-0005MZ-0z; Wed, 03 Jul 2019 16:08:05 +0200
Subject: Re: [PATCH 1/5] drm/client: Support unmapping of DRM client buffers
To: Thomas Zimmermann <tzimmermann@suse.de>, airlied@redhat.com,
 daniel@ffwll.ch, kraxel@redhat.com, maarten.lankhorst@linux.intel.com,
 maxime.ripard@bootlin.com, sean@poorly.run, sam@ravnborg.org,
 yc_chen@aspeedtech.com
References: <20190703083302.2609-1-tzimmermann@suse.de>
 <20190703083302.2609-2-tzimmermann@suse.de>
From: =?UTF-8?Q?Noralf_Tr=c3=b8nnes?= <noralf@tronnes.org>
Message-ID: <458e7d7d-3aa5-5d45-6c5c-62fadd9e4e91@tronnes.org>
Date: Wed, 3 Jul 2019 16:07:57 +0200
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:60.0) Gecko/20100101
 Thunderbird/60.7.2
MIME-Version: 1.0
In-Reply-To: <20190703083302.2609-2-tzimmermann@suse.de>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; d=tronnes.org; s=ds201810; 
 h=Content-Transfer-Encoding:Content-Type:In-Reply-To:MIME-Version:Date:Message-ID:From:References:Cc:To:Subject;
 bh=BRg7PnID/9yWmnCWfjnnheL6LDhHWiZ5hA/sa7gOus8=; 
 b=d0in+u4h42Zz7T6UpvJI0fgJWEuxAeZfY0IJefqEo62zRVjsYpot/GpE15phZPplO2O42KIRofP5WqPtLkHH3P2Bpie+koSDvp0C566ymeijlvkFilDVaykl1UINhtF9UijRGb2bN/d4WqDJe5EsIiUyLR3W62Y9CNzFokIFx0lXFtW7lqSjbRNqnTfbOZlwp7ABPjueFKXKLzeTkHvp28X+6DYB5zJfQ8tyFzptllydwLTZe3DH6MPlPPH10OcJNGqxCddHzd881UVospTETVazICnXUrJgK3uZxRbt5CvpvANmMJH3K+LSpDQG37hYhxSkg0qNAzmDfXXX+P6SpQ==;
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: dri-devel@lists.freedesktop.org, virtualization@lists.linux-foundation.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

CgpEZW4gMDMuMDcuMjAxOSAxMC4zMiwgc2tyZXYgVGhvbWFzIFppbW1lcm1hbm46Cj4gRFJNIGNs
aWVudHMsIHN1Y2ggYXMgdGhlIGZiZGV2IGVtdWxhdGlvbiwgaGF2ZSB0aGVpciBidWZmZXIgb2Jq
ZWN0cwo+IG1hcHBlZCBieSBkZWZhdWx0LiBNYXBwaW5nIGEgYnVmZmVyIGltcGxpY2l0bHkgcHJl
dmVudHMgaXRzIHJlbG9jYXRpb24uCj4gSGVuY2UsIHRoZSBidWZmZXIgbWF5IHBlcm1hbmVudGx5
IGNvbnN1bWUgdmlkZW8gbWVtb3J5IHdoaWxlIGl0J3MKPiBhbGxvY2F0ZWQuIFRoaXMgaXMgYSBw
cm9ibGVtIGZvciBkcml2ZXJzIG9mIGxvdy1tZW1vcnkgZGV2aWNlcywgc3VjaCBhcwo+IGFzdCwg
bWdhZzIwMCBvciBvbGRlciBmcmFtZWJ1ZmZlciBoYXJkd2FyZSwgd2hpY2ggd2lsbCB0aGVuIG5v
dCBoYXZlCj4gZW5vdWdoIG1lbW9yeSB0byBkaXNwbGF5IG90aGVyIGNvbnRlbnQgKGUuZy4sIFgx
MSkuCj4gCj4gVGhpcyBwYXRjaCBpbnRyb2R1Y2VzIGRybV9jbGllbnRfYnVmZmVyX3ZtYXAoKSBh
bmQgX3Z1bm1hcCgpLiBJbnRlcm5hbAo+IERSTSBjbGllbnRzIGNhbiB1c2UgdGhlc2UgZnVuY3Rp
b25zIHRvIHVubWFwIGFuZCByZW1hcCBidWZmZXIgb2JqZWN0cwo+IGFzIG5lZWRlZC4KPiAKPiBU
aGVyZSdzIG5vIHJlZmVyZW5jZSBjb3VudGluZyBmb3Igdm1hcCBvcGVyYXRpb25zLiBDYWxsZXJz
IGFyZSBleHBlY3RlZAo+IHRvIGVpdGhlciBrZWVwIGJ1ZmZlcnMgbWFwcGVkIChhcyBpdCBpcyBu
b3cpLCBvciBjYWxsIHZtYXAgYW5kIHZ1bm1hcAo+IGluIHBhaXJzIGFyb3VuZCBjb2RlIHRoYXQg
YWNjZXNzZXMgdGhlIG1hcHBlZCBtZW1vcnkuCj4gCj4gU2lnbmVkLW9mZi1ieTogVGhvbWFzIFpp
bW1lcm1hbm4gPHR6aW1tZXJtYW5uQHN1c2UuZGU+Cj4gLS0tCj4gIGRyaXZlcnMvZ3B1L2RybS9k
cm1fY2xpZW50LmMgfCA3MSArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0KPiAg
aW5jbHVkZS9kcm0vZHJtX2NsaWVudC5oICAgICB8ICAzICsrCj4gIDIgZmlsZXMgY2hhbmdlZCwg
NjQgaW5zZXJ0aW9ucygrKSwgMTAgZGVsZXRpb25zKC0pCj4gCj4gZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9kcm1fY2xpZW50LmMgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX2NsaWVudC5jCj4g
aW5kZXggNDEwNTcyZjE0MjU3Li5kMDQ2NjBjNDQ3MGEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2RybV9jbGllbnQuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fY2xpZW50LmMK
PiBAQCAtMjM1LDcgKzIzNSw4IEBAIHN0YXRpYyB2b2lkIGRybV9jbGllbnRfYnVmZmVyX2RlbGV0
ZShzdHJ1Y3QgZHJtX2NsaWVudF9idWZmZXIgKmJ1ZmZlcikKPiAgewo+ICAJc3RydWN0IGRybV9k
ZXZpY2UgKmRldiA9IGJ1ZmZlci0+Y2xpZW50LT5kZXY7Cj4gIAo+IC0JZHJtX2dlbV92dW5tYXAo
YnVmZmVyLT5nZW0sIGJ1ZmZlci0+dmFkZHIpOwo+ICsJaWYgKGJ1ZmZlci0+dmFkZHIpCgpObyBu
ZWVkIGZvciB0aGlzLCBkcm1fZ2VtX3Z1bm1hcCgpIGhhcyBhIE5VTEwgY2hlY2suCgo+ICsJCWRy
bV9nZW1fdnVubWFwKGJ1ZmZlci0+Z2VtLCBidWZmZXItPnZhZGRyKTsKPiAgCj4gIAlpZiAoYnVm
ZmVyLT5nZW0pCj4gIAkJZHJtX2dlbV9vYmplY3RfcHV0X3VubG9ja2VkKGJ1ZmZlci0+Z2VtKTsK
PiBAQCAtMjgxLDYgKzI4Miw0MyBAQCBkcm1fY2xpZW50X2J1ZmZlcl9jcmVhdGUoc3RydWN0IGRy
bV9jbGllbnRfZGV2ICpjbGllbnQsIHUzMiB3aWR0aCwgdTMyIGhlaWdodCwgdQo+ICAKPiAgCWJ1
ZmZlci0+Z2VtID0gb2JqOwo+ICAKPiArCXZhZGRyID0gZHJtX2NsaWVudF9idWZmZXJfdm1hcChi
dWZmZXIpOwoKSSB0aGluayB3ZSBzaG91bGQgY2hhbmdlIHRoaXMgYW5kIF9ub3RfIHZtYXAgb24g
YnVmZmVyIGNyZWF0aW9uLgpFdmVudHVhbGx5IHdlJ2xsIGdldCBib290c3BsYXNoIGFuZCBjb25z
b2xlIGNsaWVudHMgYW5kIHRoZXkgd2lsbCBhbHNvCmhhdmUgdG8gZGVhbCB3aXRoIHRoZXNlIGxv
dyBtZW1vcnkgZGV2aWNlcy4gQUZBSUNTIHRoZSBvbmx5IGNsaWVudCB0aGF0CndpbGwgbmVlZCBh
IHZpcnR1YWwgYWRkcmVzcyBhdCBhbGwgdGltZXMgaXMgdGhlIGZiZGV2IGNsaWVudCB3aGVuIGl0
CmRvZXNuJ3QgdXNlIGEgc2hhZG93IGJ1ZmZlci4KCj4gKwlpZiAoSVNfRVJSKHZhZGRyKSkgewo+
ICsJCXJldCA9IFBUUl9FUlIodmFkZHIpOwo+ICsJCWdvdG8gZXJyX2RlbGV0ZTsKPiArCX0KPiAr
Cj4gKwlyZXR1cm4gYnVmZmVyOwo+ICsKPiArZXJyX2RlbGV0ZToKPiArCWRybV9jbGllbnRfYnVm
ZmVyX2RlbGV0ZShidWZmZXIpOwo+ICsKPiArCXJldHVybiBFUlJfUFRSKHJldCk7Cj4gK30KPiAr
Cj4gKy8qKgo+ICsgKiBkcm1fY2xpZW50X2J1ZmZlcl92bWFwIC0gTWFwIERSTSBjbGllbnQgYnVm
ZmVyIGludG8gYWRkcmVzcyBzcGFjZQo+ICsgKiBAYnVmZmVyOiBEUk0gY2xpZW50IGJ1ZmZlcgo+
ICsgKgo+ICsgKiBUaGlzIGZ1bmN0aW9uIG1hcHMgYSBjbGllbnQgYnVmZmVyIGludG8ga2VybmVs
IGFkZHJlc3Mgc3BhY2UuIElmIHRoZQo+ICsgKiBidWZmZXIgaXMgYWxyZWFkeSBtYXBwZWQsIGl0
IHJldHVybnMgdGhlIG1hcHBpbmcncyBhZGRyZXNzLgo+ICsgKgo+ICsgKiBDbGllbnQgYnVmZmVy
IG1hcHBpbmdzIGFyZSBub3QgcmVmJ2NvdW50ZWQuIEVhY2ggY2FsbCB0bwo+ICsgKiBkcm1fY2xp
ZW50X2J1ZmZlcl92bWFwKCkgc2hvdWxkIGJlIGZvbGxvd2VkIGJ5IGEgY2FsbCB0bwo+ICsgKiBk
cm1fY2xpZW50X2J1ZmZlcl92dW5tYXAoKTsgb3IgdGhlIGNsaWVudCBidWZmZXIgc2hvdWxkIGJl
IG1hcHBlZAo+ICsgKiB0aHJvdWdob3V0IGl0cyBsaWZldGltZS4gVGhlIGxhdHRlciBpcyB0aGUg
ZGVmYXVsdC4KPiArICoKPiArICogUmV0dXJuczoKPiArICoJVGhlIG1hcHBlZCBtZW1vcnkncyBh
ZGRyZXNzCj4gKyAqLwo+ICt2b2lkICoKPiArZHJtX2NsaWVudF9idWZmZXJfdm1hcChzdHJ1Y3Qg
ZHJtX2NsaWVudF9idWZmZXIgKmJ1ZmZlcikKPiArewo+ICsJdm9pZCAqdmFkZHI7Cj4gKwo+ICsJ
aWYgKGJ1ZmZlci0+dmFkZHIpCj4gKwkJcmV0dXJuIGJ1ZmZlci0+dmFkZHI7Cj4gKwo+ICAJLyoK
PiAgCSAqIEZJWE1FOiBUaGUgZGVwZW5kZW5jeSBvbiBHRU0gaGVyZSBpc24ndCByZXF1aXJlZCwg
d2UgY291bGQKPiAgCSAqIGNvbnZlcnQgdGhlIGRyaXZlciBoYW5kbGUgdG8gYSBkbWEtYnVmIGlu
c3RlYWQgYW5kIHVzZSB0aGUKPiBAQCAtMjg5LDIxICszMjcsMzQgQEAgZHJtX2NsaWVudF9idWZm
ZXJfY3JlYXRlKHN0cnVjdCBkcm1fY2xpZW50X2RldiAqY2xpZW50LCB1MzIgd2lkdGgsIHUzMiBo
ZWlnaHQsIHUKPiAgCSAqIGZkX2luc3RhbGwgc3RlcCBvdXQgb2YgdGhlIGRyaXZlciBiYWNrZW5k
IGhvb2tzLCB0byBtYWtlIHRoYXQKPiAgCSAqIGZpbmFsIHN0ZXAgb3B0aW9uYWwgZm9yIGludGVy
bmFsIHVzZXJzLgo+ICAJICovCj4gLQl2YWRkciA9IGRybV9nZW1fdm1hcChvYmopOwo+IC0JaWYg
KElTX0VSUih2YWRkcikpIHsKPiAtCQlyZXQgPSBQVFJfRVJSKHZhZGRyKTsKPiAtCQlnb3RvIGVy
cl9kZWxldGU7Cj4gLQl9Cj4gKwl2YWRkciA9IGRybV9nZW1fdm1hcChidWZmZXItPmdlbSk7Cj4g
KwlpZiAoSVNfRVJSKHZhZGRyKSkKPiArCQlyZXR1cm4gdmFkZHI7Cj4gIAo+ICAJYnVmZmVyLT52
YWRkciA9IHZhZGRyOwo+ICAKPiAtCXJldHVybiBidWZmZXI7Cj4gKwlyZXR1cm4gdmFkZHI7Cj4g
K30KPiArRVhQT1JUX1NZTUJPTChkcm1fY2xpZW50X2J1ZmZlcl92bWFwKTsKPiAgCj4gLWVycl9k
ZWxldGU6Cj4gLQlkcm1fY2xpZW50X2J1ZmZlcl9kZWxldGUoYnVmZmVyKTsKPiArLyoqCj4gKyAq
IGRybV9jbGllbnRfYnVmZmVyX3Z1bm1hcCAtIFVubWFwIERSTSBjbGllbnQgYnVmZmVyCj4gKyAq
IEBidWZmZXI6IERSTSBjbGllbnQgYnVmZmVyCj4gKyAqCj4gKyAqIFRoaXMgZnVuY3Rpb24gcmVt
b3ZlcyBhIGNsaWVudCBidWZmZXIncyBtZW1vcnkgbW1hcHBpbmcuIFRoaXMKPiArICogZnVuY3Rp
b24gaXMgb25seSByZXF1aXJlZCBieSBjbGllbnRzIHRoYXQgbWFuYWdlIHRoZWlyIGJ1ZmZlcnMK
PiArICogYnkgdGhlbXNlbHZlcy4gQnkgZGVmYXVsdCwgRFJNIGNsaWVudCBidWZmZXJzIGFyZSBt
YXBwZWQgdGhyb3VnaG91dAo+ICsgKiB0aGVpciBlbnRpcmUgbGlmZXRpbWUuCj4gKyAqLwo+ICt2
b2lkIGRybV9jbGllbnRfYnVmZmVyX3Z1bm1hcChzdHJ1Y3QgZHJtX2NsaWVudF9idWZmZXIgKmJ1
ZmZlcikKPiArewo+ICsJaWYgKCFidWZmZXItPnZhZGRyKQoKTm8gbmVlZCBmb3IgYSBOVUxMIGNo
ZWNrIGhlcmUgZWl0aGVyLgoKTm9yYWxmLgoKPiArCQlyZXR1cm47Cj4gIAo+IC0JcmV0dXJuIEVS
Ul9QVFIocmV0KTsKPiArCWRybV9nZW1fdnVubWFwKGJ1ZmZlci0+Z2VtLCBidWZmZXItPnZhZGRy
KTsKPiArCWJ1ZmZlci0+dmFkZHIgPSBOVUxMOwo+ICB9Cj4gK0VYUE9SVF9TWU1CT0woZHJtX2Ns
aWVudF9idWZmZXJfdnVubWFwKTsKPiAgCj4gIHN0YXRpYyB2b2lkIGRybV9jbGllbnRfYnVmZmVy
X3JtZmIoc3RydWN0IGRybV9jbGllbnRfYnVmZmVyICpidWZmZXIpCj4gIHsKPiBkaWZmIC0tZ2l0
IGEvaW5jbHVkZS9kcm0vZHJtX2NsaWVudC5oIGIvaW5jbHVkZS9kcm0vZHJtX2NsaWVudC5oCj4g
aW5kZXggNzJkNTFkMWU5ZGQ5Li5lMWRiMWQ5ZGEwYmYgMTAwNjQ0Cj4gLS0tIGEvaW5jbHVkZS9k
cm0vZHJtX2NsaWVudC5oCj4gKysrIGIvaW5jbHVkZS9kcm0vZHJtX2NsaWVudC5oCj4gQEAgLTE0
OSw2ICsxNDksOSBAQCBzdHJ1Y3QgZHJtX2NsaWVudF9idWZmZXIgewo+ICBzdHJ1Y3QgZHJtX2Ns
aWVudF9idWZmZXIgKgo+ICBkcm1fY2xpZW50X2ZyYW1lYnVmZmVyX2NyZWF0ZShzdHJ1Y3QgZHJt
X2NsaWVudF9kZXYgKmNsaWVudCwgdTMyIHdpZHRoLCB1MzIgaGVpZ2h0LCB1MzIgZm9ybWF0KTsK
PiAgdm9pZCBkcm1fY2xpZW50X2ZyYW1lYnVmZmVyX2RlbGV0ZShzdHJ1Y3QgZHJtX2NsaWVudF9i
dWZmZXIgKmJ1ZmZlcik7Cj4gK3ZvaWQgKgo+ICtkcm1fY2xpZW50X2J1ZmZlcl92bWFwKHN0cnVj
dCBkcm1fY2xpZW50X2J1ZmZlciAqYnVmZmVyKTsKPiArdm9pZCBkcm1fY2xpZW50X2J1ZmZlcl92
dW5tYXAoc3RydWN0IGRybV9jbGllbnRfYnVmZmVyICpidWZmZXIpOwo+ICAKPiAgaW50IGRybV9j
bGllbnRfbW9kZXNldF9jcmVhdGUoc3RydWN0IGRybV9jbGllbnRfZGV2ICpjbGllbnQpOwo+ICB2
b2lkIGRybV9jbGllbnRfbW9kZXNldF9mcmVlKHN0cnVjdCBkcm1fY2xpZW50X2RldiAqY2xpZW50
KTsKPiAKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJp
LWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
