Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id CF2865B31B
	for <lists+dri-devel@lfdr.de>; Mon,  1 Jul 2019 05:24:44 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B860589715;
	Mon,  1 Jul 2019 03:24:42 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-qt1-x844.google.com (mail-qt1-x844.google.com
 [IPv6:2607:f8b0:4864:20::844])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1F13189715
 for <dri-devel@lists.freedesktop.org>; Mon,  1 Jul 2019 03:24:41 +0000 (UTC)
Received: by mail-qt1-x844.google.com with SMTP id m29so13190727qtu.1
 for <dri-devel@lists.freedesktop.org>; Sun, 30 Jun 2019 20:24:41 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:date:from:to:cc:subject:message-id:references
 :mime-version:content-disposition:in-reply-to:user-agent;
 bh=TBkGIpZDTRWUqhge/wC7uC1qGZRr0i17gzx2p4IYZwY=;
 b=JOlIihjTYEzvbxntgIUjkpsgPnF4LSVHQrX9qp+NCOCuKiF0Fon47qJN/lHQa6eERk
 WHgHBDSoHRESm+7XVT1zSRbE3FhNosxCJ9STO6Lc6wHt9f/zjdh6tBFM1J3ZPzyL/HQI
 88HfUfjo36sPk1HX/KhAApy6PUjUxVtkzSXNieCIxsribofUFU5UHhJe7CqnHqBNpLBb
 29wE+Qx83uzeSVqUXHJw2ek4DrpPCu2AsJ3sUEqv0wYxw6gZklCCd6LWAAaQTy5Y8I9Q
 bvvy7Bchz7kuNX+dVbgX7f6v5DIdQiERMiTHGIOJEj7dp16CTcO+uTRnnqU0XwF/fVhw
 Kw/w==
X-Gm-Message-State: APjAAAWZUtAd0wLydk4VR6Z2QD9Zu0kChvFc8iUOUlS0nLCxDd3jBqBb
 nzFTjZaEytcEvf0OvpTm+wQ=
X-Google-Smtp-Source: APXvYqzTygIW3Zvf1UugDAWJd6BU2aigSwWo22zGT0E2LGG8WIzpV5rgihga//zrTeHm6VlkC7OdVw==
X-Received: by 2002:ad4:5283:: with SMTP id v3mr19343701qvr.207.1561951480157; 
 Sun, 30 Jun 2019 20:24:40 -0700 (PDT)
Received: from smtp.gmail.com ([187.121.151.22])
 by smtp.gmail.com with ESMTPSA id g53sm5172840qtk.65.2019.06.30.20.24.37
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Sun, 30 Jun 2019 20:24:39 -0700 (PDT)
Date: Mon, 1 Jul 2019 00:24:35 -0300
From: Rodrigo Siqueira <rodrigosiqueiramelo@gmail.com>
To: Daniel Vetter <daniel@ffwll.ch>, Haneen Mohammed <hamohammed.sa@gmail.com>,
 David Airlie <airlied@linux.ie>, Simon Ser <contact@emersion.fr>
Subject: [PATCH 2/2] drm/vkms: Introduce configfs for enabling/disabling
 connectors
Message-ID: <b7a3fbf4ddab54965bf2dc3c0aab843e2f66dd10.1561950553.git.rodrigosiqueiramelo@gmail.com>
References: <cover.1561950553.git.rodrigosiqueiramelo@gmail.com>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <cover.1561950553.git.rodrigosiqueiramelo@gmail.com>
User-Agent: NeoMutt/20180716
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=date:from:to:cc:subject:message-id:references:mime-version
 :content-disposition:in-reply-to:user-agent;
 bh=TBkGIpZDTRWUqhge/wC7uC1qGZRr0i17gzx2p4IYZwY=;
 b=JzzYNO6MunIO3mqHv0ndJxirDJcdQSSuFy9YMsqQ/p0d88m+Jx3kE6huuOS0bPQqCK
 Tc0oTqzZ8bf/By2K9MFrBZ4119RgZRvIPe7Ynk9jq/wNgYeV3SqqM14z+BjeqbEnqOCL
 DiAHD3aLJVxmRdzSVdvMFPJKaPWRtgQyaNELNte+fDfGr+V0+i2PgnNHqde7GMykF0J5
 QFrp3oh/qCy30tElf9dXyswsUbOyZyP4AIRtLx89hgBtsfbOjLubvZhTdRw+LZICHJpY
 B+pWWQol1kQbuVNsgEE1S72iMIqqeT4U8pIy7nZiXRcN7q8UOLg9E8HtfzyboaFuIzSP
 vCDw==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBwYXRjaCBpbnRyb2R1Y2VzIGFuIGltcGxlbWVudGF0aW9uIG9mIHZrbXMgc3Vic3lzdGVt
cyB0aHJvdWdoCmNvbmZpZ2ZzOyB3ZSB3YW50IHRvIGJlIGFibGUgdG8gcmVjb25maWd1cmUgdmtt
cyBpbnN0YW5jZSB3aXRob3V0IGhhdmluZwp0byByZWxvYWQgdGhlIG1vZHVsZS4gVGhpcyBjb21t
aXQgYWRkcyB0aGUgcHJpbWFyeSBzdXBwb3J0IGZvciBjb25maWdmcwpieSBhbGxvd2luZyB2a21z
IHRvIGV4cG9zZSB0aGUgYWJpbGl0eSB0byBlbmFibGUvZGlzYWJsZSBpdHMgY29ubmVjdG9ycy4K
ClNpZ25lZC1vZmYtYnk6IFJvZHJpZ28gU2lxdWVpcmEgPHJvZHJpZ29zaXF1ZWlyYW1lbG9AZ21h
aWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS92a21zL01ha2VmaWxlICAgICAgICB8ICAgMyAr
LQogZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19jb25maWdmcy5jIHwgMjI5ICsrKysrKysrKysr
KysrKysrKysrKysrKysrKwogZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19kcnYuYyAgICAgIHwg
ICA2ICsKIGRyaXZlcnMvZ3B1L2RybS92a21zL3ZrbXNfZHJ2LmggICAgICB8ICAxMiArKwogNCBm
aWxlcyBjaGFuZ2VkLCAyNDkgaW5zZXJ0aW9ucygrKSwgMSBkZWxldGlvbigtKQogY3JlYXRlIG1v
ZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS92a21zL3ZrbXNfY29uZmlnZnMuYwoKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS92a21zL01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL3ZrbXMv
TWFrZWZpbGUKaW5kZXggMzMzZDNjZWFkMGUzLi5mOTBjMDE2Y2Q5ZmUgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS92a21zL01ha2VmaWxlCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92a21zL01h
a2VmaWxlCkBAIC02LDYgKzYsNyBAQCB2a21zLXkgOj0gXAogCXZrbXNfY3J0Yy5vIFwKIAl2a21z
X2dlbS5vIFwKIAl2a21zX2NvbXBvc2VyLm8gXAotCXZrbXNfd3JpdGViYWNrLm8KKwl2a21zX3dy
aXRlYmFjay5vIFwKKwl2a21zX2NvbmZpZ2ZzLm8KIAogb2JqLSQoQ09ORklHX0RSTV9WS01TKSAr
PSB2a21zLm8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92a21zL3ZrbXNfY29uZmlnZnMu
YyBiL2RyaXZlcnMvZ3B1L2RybS92a21zL3ZrbXNfY29uZmlnZnMuYwpuZXcgZmlsZSBtb2RlIDEw
MDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjVkMWEzMDUxN2NjYQotLS0gL2Rldi9udWxsCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS92a21zL3ZrbXNfY29uZmlnZnMuYwpAQCAtMCwwICsxLDIyOSBAQAor
Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjArCisKKyNpbmNsdWRlICJ2a21zX2Ry
di5oIgorCitzdGF0aWMgc3RydWN0IGNvbmZpZ19ncm91cCAqY29ubmVjdG9yX2dyb3VwOworc3Rh
dGljIHN0cnVjdCB2a21zX2RldmljZSAqdmttc19kZXZpY2U7CisKK3N0YXRpYyBjaGFyICphdmFp
bGFibGVfY29ubmVjdG9yc1tdID0geworCSJWaXJ0dWFsIiwKKwkiV3JpdGViYWNrIiwKK307CisK
K3N0cnVjdCBjb25uZWN0b3JzX2ZzIHsKKwlzdHJ1Y3QgY29uZmlnX2l0ZW0gaXRlbTsKKwlib29s
IGVuYWJsZTsKK307CisKK3N0YXRpYyBpbnQgZW5hYmxlX2Nvbm5lY3Rvcihjb25zdCBjaGFyICpu
YW1lKQoreworCWludCByZXQgPSAwOworCisJaWYgKCFzdHJjbXAobmFtZSwgIldyaXRlYmFjayIp
KQorCQlyZXQgPSBlbmFibGVfd3JpdGViYWNrX2Nvbm5lY3Rvcih2a21zX2RldmljZSk7CisJZWxz
ZSBpZiAoIXN0cmNtcChuYW1lLCAiVmlydHVhbCIpKQorCQlyZXQgPSBlbmFibGVfdmlydHVhbF9j
b25uZWN0b3Iodmttc19kZXZpY2UpOworCisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCWRy
bV9tb2RlX2NvbmZpZ19yZXNldCgmdmttc19kZXZpY2UtPmRybSk7CisJcmV0dXJuIDA7Cit9CisK
K3N0YXRpYyB2b2lkIGRpc2FibGVfY29ubmVjdG9yKGNvbnN0IGNoYXIgKm5hbWUpCit7CisJaWYg
KCFzdHJjbXAobmFtZSwgIldyaXRlYmFjayIpKQorCQlkaXNhYmxlX3dyaXRlYmFja19jb25uZWN0
b3Iodmttc19kZXZpY2UpOworCWVsc2UgaWYgKCFzdHJjbXAobmFtZSwgIlZpcnR1YWwiKSkKKwkJ
ZGlzYWJsZV92aXJ0dWFsX2Nvbm5lY3Rvcih2a21zX2RldmljZSk7Cit9CisKK3N0YXRpYyBpbmxp
bmUgc3RydWN0IGNvbm5lY3RvcnNfZnMgKnRvX2Nvbm5faXRlbShzdHJ1Y3QgY29uZmlnX2l0ZW0g
Kml0ZW0pCit7CisJcmV0dXJuIGl0ZW0gPyBjb250YWluZXJfb2YoaXRlbSwgc3RydWN0IGNvbm5l
Y3RvcnNfZnMsIGl0ZW0pIDogTlVMTDsKK30KKworc3RhdGljIHNzaXplX3QgY29ubl9mc19lbmFi
bGVfc2hvdyhzdHJ1Y3QgY29uZmlnX2l0ZW0gKml0ZW0sIGNoYXIgKnBhZ2UpCit7CisJc3RydWN0
IGNvbm5lY3RvcnNfZnMgKmNvbm5faXRlbSA9IHRvX2Nvbm5faXRlbShpdGVtKTsKKworCXJldHVy
biBzcHJpbnRmKHBhZ2UsICIlZFxuIiwgY29ubl9pdGVtLT5lbmFibGUpOworfQorCitzdGF0aWMg
c3NpemVfdCBjb25uX2ZzX2VuYWJsZV9zdG9yZShzdHJ1Y3QgY29uZmlnX2l0ZW0gKml0ZW0sCisJ
CQkJICAgIGNvbnN0IGNoYXIgKnBhZ2UsIHNpemVfdCBjb3VudCkKK3sKKwlzdHJ1Y3QgY29ubmVj
dG9yc19mcyAqY29ubl9pdGVtID0gdG9fY29ubl9pdGVtKGl0ZW0pOworCWNoYXIgKnAgPSAoY2hh
ciAqKXBhZ2U7CisJdW5zaWduZWQgaW50IGVuYWJsZTsKKwlpbnQgcmV0OworCisJcmV0ID0ga3N0
cnRvdWludChwLCAxMCwgJmVuYWJsZSk7CisJaWYgKHJldCkKKwkJcmV0dXJuIC1FSU5WQUw7CisK
KwlpZiAoZW5hYmxlID4gMSkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlpZiAoZW5hYmxlID09IGNv
bm5faXRlbS0+ZW5hYmxlKQorCQlyZXR1cm4gY291bnQ7CisKKwlpZiAoZW5hYmxlKSB7CisJCXJl
dCA9IGVuYWJsZV9jb25uZWN0b3IoaXRlbS0+Y2lfbmFtZSk7CisJCWlmIChyZXQpCisJCQlyZXR1
cm4gcmV0OworCX0gZWxzZSB7CisJCWRpc2FibGVfY29ubmVjdG9yKGl0ZW0tPmNpX25hbWUpOwor
CX0KKworCWNvbm5faXRlbS0+ZW5hYmxlID0gZW5hYmxlID8gdHJ1ZSA6IGZhbHNlOworCXJldHVy
biBjb3VudDsKK30KKworQ09ORklHRlNfQVRUUihjb25uX2ZzXywgZW5hYmxlKTsKKworc3RhdGlj
IHN0cnVjdCBjb25maWdmc19hdHRyaWJ1dGUgKmNvbm5lY3RvcnNfZnNfYXR0cnNbXSA9IHsKKwkm
Y29ubl9mc19hdHRyX2VuYWJsZSwKKwlOVUxMLAorfTsKKworc3RhdGljIHZvaWQgY29ubmVjdG9y
c19mc19yZWxlYXNlKHN0cnVjdCBjb25maWdfaXRlbSAqaXRlbSkKK3sKKwlrZnJlZSh0b19jb25u
X2l0ZW0oaXRlbSkpOworfQorCitzdGF0aWMgc3RydWN0IGNvbmZpZ2ZzX2l0ZW1fb3BlcmF0aW9u
cyBjb25uZWN0b3JzX2ZzX29wcyA9IHsKKwkucmVsZWFzZSA9IGNvbm5lY3RvcnNfZnNfcmVsZWFz
ZSwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgY29uZmlnX2l0ZW1fdHlwZSBjb25uZWN0b3Jz
X2ZzX3R5cGUgPSB7CisJLmN0X2l0ZW1fb3BzCT0gJmNvbm5lY3RvcnNfZnNfb3BzLAorCS5jdF9h
dHRycwk9IGNvbm5lY3RvcnNfZnNfYXR0cnMsCisJLmN0X293bmVyCT0gVEhJU19NT0RVTEUsCit9
OworCitzdGF0aWMgc3RydWN0IGNvbmZpZ19pdGVtICptYWtlX2Nvbm5lY3Rvcl9pdGVtKHN0cnVj
dCBjb25maWdfZ3JvdXAgKmdyb3VwLAorCQkJCQkgICAgICAgY29uc3QgY2hhciAqbmFtZSkKK3sK
KwlzdHJ1Y3QgY29ubmVjdG9yc19mcyAqY29ubl9pdGVtOworCWludCBpLCByZXQsIHRvdGFsX2Nv
bm4gPSBBUlJBWV9TSVpFKGF2YWlsYWJsZV9jb25uZWN0b3JzKTsKKworCWZvciAoaSA9IDA7IGkg
PCB0b3RhbF9jb25uOyBpKyspCisJCWlmICghc3RyY21wKG5hbWUsIGF2YWlsYWJsZV9jb25uZWN0
b3JzW2ldKSkKKwkJCWJyZWFrOworCisJaWYgKGkgPT0gdG90YWxfY29ubikKKwkJcmV0dXJuIEVS
Ul9QVFIoLUVJTlZBTCk7CisKKwlyZXQgPSBlbmFibGVfY29ubmVjdG9yKG5hbWUpOworCWlmIChy
ZXQpCisJCXJldHVybiBFUlJfUFRSKHJldCk7CisKKwljb25uX2l0ZW0gPSBremFsbG9jKHNpemVv
ZigqY29ubl9pdGVtKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFjb25uX2l0ZW0pCisJCXJldHVybiBF
UlJfUFRSKC1FTk9NRU0pOworCisJY29uZmlnX2l0ZW1faW5pdF90eXBlX25hbWUoJmNvbm5faXRl
bS0+aXRlbSwgbmFtZSwKKwkJCQkgICAmY29ubmVjdG9yc19mc190eXBlKTsKKworCWNvbm5faXRl
bS0+ZW5hYmxlID0gdHJ1ZTsKKworCXJldHVybiAmY29ubl9pdGVtLT5pdGVtOworfQorCitzdGF0
aWMgdm9pZCBkcm9wX2Nvbm5lY3Rvcl9pdGVtKHN0cnVjdCBjb25maWdfZ3JvdXAgKmdyb3VwLAor
CQkJCXN0cnVjdCBjb25maWdfaXRlbSAqaXRlbSkKK3sKKwljaGFyICpuYW1lID0gaXRlbS0+Y2lf
bmFtZTsKKworCWRpc2FibGVfY29ubmVjdG9yKG5hbWUpOworCisJY29uZmlnX2l0ZW1fcHV0KGl0
ZW0pOworfQorCitzdGF0aWMgc3RydWN0IGNvbmZpZ2ZzX2dyb3VwX29wZXJhdGlvbnMgY29ubmVj
dG9yX2dyb3VwX29wcyA9IHsKKwkubWFrZV9pdGVtCT0gbWFrZV9jb25uZWN0b3JfaXRlbSwKKwku
ZHJvcF9pdGVtCT0gZHJvcF9jb25uZWN0b3JfaXRlbSwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1
Y3QgY29uZmlnX2l0ZW1fdHlwZSBjb25uZWN0b3JfdHlwZSA9IHsKKwkuY3RfZ3JvdXBfb3BzCT0g
JmNvbm5lY3Rvcl9ncm91cF9vcHMsCisJLmN0X293bmVyCT0gVEhJU19NT0RVTEUsCit9OworCitz
dGF0aWMgY29uc3Qgc3RydWN0IGNvbmZpZ19pdGVtX3R5cGUgdmttc19zdWJzeXN0ZW1fdHlwZSA9
IHsKKwkuY3Rfb3duZXIJPSBUSElTX01PRFVMRSwKK307CisKK3N0YXRpYyBzdHJ1Y3QgY29uZmln
ZnNfc3Vic3lzdGVtIHZrbXNfc3Vic3lzdGVtID0geworCS5zdV9ncm91cCA9IHsKKwkJLmNnX2l0
ZW0gPSB7CisJCQkuY2lfbmFtZWJ1ZiA9ICJ2a21zIiwKKwkJCS5jaV90eXBlID0gJnZrbXNfc3Vi
c3lzdGVtX3R5cGUsCisJCX0sCisJfSwKKwkuc3VfbXV0ZXggPSBfX01VVEVYX0lOSVRJQUxJWkVS
KHZrbXNfc3Vic3lzdGVtLnN1X211dGV4KSwKK307CisKK3N0YXRpYyB2b2lkIGluaXRfZGVmYXVs
dF9jb25uX2NvbmZpZ2ZzKHN0cnVjdCBjb25maWdfZ3JvdXAgKnJvb3QpCit7CisJc3RydWN0IHZr
bXNfY29uZmlnX3N0YXRlICpjb25maWdfc3RhdGUgPSAmdmttc19kZXZpY2UtPmNvbmZpZ19zdGF0
ZTsKKwlpbnQgaSwgcmV0OworCisJY29ubmVjdG9yX2dyb3VwID0gY29uZmlnZnNfcmVnaXN0ZXJf
ZGVmYXVsdF9ncm91cChyb290LCAiY29ubmVjdG9ycyIsCisJCQkJCQkJICAmY29ubmVjdG9yX3R5
cGUpOworCWlmIChJU19FUlIoY29ubmVjdG9yX2dyb3VwKSkgeworCQlyZXQgPSBQVFJfRVJSKGNv
bm5lY3Rvcl9ncm91cCk7CisJCXByX2VycigiRXJyb3IgJWQgd2hpbGUgcmVnaXN0ZXJpbmcgZnVu
Y3Rpb25zIGdyb3VwXG4iLCByZXQpOworCQlyZXR1cm47CisJfQorCisJZm9yIChpID0gMDsgaSA8
IEFSUkFZX1NJWkUoYXZhaWxhYmxlX2Nvbm5lY3RvcnMpOyBpKyspIHsKKwkJc3RydWN0IGNvbmZp
Z19ncm91cCAqZ3JvdXAgPSBjb25maWdfc3RhdGUtPmNvbm5lY3RvcnNbaV07CisKKwkJaWYgKCFz
dHJjbXAoYXZhaWxhYmxlX2Nvbm5lY3RvcnNbaV0sICJXcml0ZWJhY2siKSAmJgorCQkgICAgIWVu
YWJsZV93cml0ZWJhY2spCisJCQljb250aW51ZTsKKworCQlncm91cCA9IGNvbmZpZ2ZzX3JlZ2lz
dGVyX2RlZmF1bHRfZ3JvdXAoY29ubmVjdG9yX2dyb3VwLAorCQkJCQkJCWF2YWlsYWJsZV9jb25u
ZWN0b3JzW2ldLAorCQkJCQkJCSZjb25uZWN0b3JzX2ZzX3R5cGUpOworCQlpZiAoSVNfRVJSKGNv
bm5lY3Rvcl9ncm91cCkpIHsKKwkJCXJldCA9IFBUUl9FUlIoY29uZmlnX3N0YXRlLT5jb25uZWN0
b3JzW2ldKTsKKwkJCURSTV9FUlJPUigiRXJyb3IgJWQgd2hpbGUgdHJ5aW5nIHRvIHJlZ2lzdGVy
ICVzXG4iLAorCQkJCSAgcmV0LCBhdmFpbGFibGVfY29ubmVjdG9yc1tpXSk7CisJCQljb250aW51
ZTsKKwkJfQorCisJCXRvX2Nvbm5faXRlbSgmZ3JvdXAtPmNnX2l0ZW0pLT5lbmFibGUgPSB0cnVl
OworCX0KK30KKworaW50IHZrbXNfY29uZmlnZnNfaW5pdChzdHJ1Y3Qgdmttc19kZXZpY2UgKnZr
bXNkZXYpCit7CisJc3RydWN0IGNvbmZpZ19ncm91cCAqcm9vdCA9ICZ2a21zX3N1YnN5c3RlbS5z
dV9ncm91cDsKKwlpbnQgcmV0OworCisJdmttc19kZXZpY2UgPSB2a21zZGV2OworCisJY29uZmln
X2dyb3VwX2luaXQocm9vdCk7CisJcmV0ID0gY29uZmlnZnNfcmVnaXN0ZXJfc3Vic3lzdGVtKCZ2
a21zX3N1YnN5c3RlbSk7CisJaWYgKHJldCkgeworCQlwcl9lcnIoIkVycm9yICVkIHdoaWxlIHJl
Z2lzdGVyaW5nIHN1YnN5c3RlbSAlc1xuIiwgcmV0LAorCQkgICAgICAgcm9vdC0+Y2dfaXRlbS5j
aV9uYW1lYnVmKTsKKwkJZ290byBlcnI7CisJfQorCisJaW5pdF9kZWZhdWx0X2Nvbm5fY29uZmln
ZnMocm9vdCk7CisKKwlyZXR1cm4gMDsKKworZXJyOgorCXJldHVybiByZXQ7Cit9CisKK3ZvaWQg
dmttc19jb25maWdmc19leGl0KHZvaWQpCit7CisJY29uZmlnZnNfdW5yZWdpc3Rlcl9zdWJzeXN0
ZW0oJnZrbXNfc3Vic3lzdGVtKTsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92a21z
L3ZrbXNfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vdmttcy92a21zX2Rydi5jCmluZGV4IDE1MmQ3
ZGUyNGE3Ni4uYTkzMGE1YTUyY2U0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdmttcy92
a21zX2Rydi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92a21zL3ZrbXNfZHJ2LmMKQEAgLTE2Niw2
ICsxNjYsMTAgQEAgc3RhdGljIGludCBfX2luaXQgdmttc19pbml0KHZvaWQpCiAJaWYgKHJldCkK
IAkJZ290byBvdXRfZmluaTsKIAorCXJldCA9IHZrbXNfY29uZmlnZnNfaW5pdCh2a21zX2Rldmlj
ZSk7CisJaWYgKHJldCkKKwkJRFJNX0VSUk9SKCJDb3VsZCBub3QgaW5pdGlhbGl6ZSBjb25maWdm
cyIpOworCiAJcmV0ID0gZHJtX2Rldl9yZWdpc3Rlcigmdmttc19kZXZpY2UtPmRybSwgMCk7CiAJ
aWYgKHJldCkKIAkJZ290byBvdXRfZmluaTsKQEAgLTE5NCw2ICsxOTgsOCBAQCBzdGF0aWMgdm9p
ZCBfX2V4aXQgdmttc19leGl0KHZvaWQpCiAJZHJtX2Rldl9wdXQoJnZrbXNfZGV2aWNlLT5kcm0p
OwogCiAJa2ZyZWUodmttc19kZXZpY2UpOworCisJdmttc19jb25maWdmc19leGl0KCk7CiB9CiAK
IG1vZHVsZV9pbml0KHZrbXNfaW5pdCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdmtt
cy92a21zX2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19kcnYuaAppbmRleCBhMWNh
NWM2NTgzNTUuLmM4MTFiYzE5MjYwNiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3ZrbXMv
dmttc19kcnYuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vdmttcy92a21zX2Rydi5oCkBAIC05LDYg
KzksNyBAQAogI2luY2x1ZGUgPGRybS9kcm1fZW5jb2Rlci5oPgogI2luY2x1ZGUgPGRybS9kcm1f
d3JpdGViYWNrLmg+CiAjaW5jbHVkZSA8bGludXgvaHJ0aW1lci5oPgorI2luY2x1ZGUgPGxpbnV4
L2NvbmZpZ2ZzLmg+CiAKICNkZWZpbmUgWFJFU19NSU4gICAgMjAKICNkZWZpbmUgWVJFU19NSU4g
ICAgMjAKQEAgLTgzLDEwICs4NCwxNyBAQCBzdHJ1Y3Qgdmttc19vdXRwdXQgewogCXNwaW5sb2Nr
X3QgY29tcG9zZXJfbG9jazsKIH07CiAKKyNkZWZpbmUgTUFYX0NPTk5fQ09ORklHRlMgMTAKKwor
c3RydWN0IHZrbXNfY29uZmlnX3N0YXRlIHsKKwlzdHJ1Y3QgY29uZmlnX2dyb3VwICpjb25uZWN0
b3JzW01BWF9DT05OX0NPTkZJR0ZTXTsKK307CisKIHN0cnVjdCB2a21zX2RldmljZSB7CiAJc3Ry
dWN0IGRybV9kZXZpY2UgZHJtOwogCXN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBsYXRmb3JtOwog
CXN0cnVjdCB2a21zX291dHB1dCBvdXRwdXQ7CisJc3RydWN0IHZrbXNfY29uZmlnX3N0YXRlIGNv
bmZpZ19zdGF0ZTsKIH07CiAKIHN0cnVjdCB2a21zX2dlbV9vYmplY3QgewpAQCAtMTYwLDQgKzE2
OCw4IEBAIHZvaWQgZGlzYWJsZV92aXJ0dWFsX2Nvbm5lY3RvcihzdHJ1Y3Qgdmttc19kZXZpY2Ug
KnZrbXNkZXYpOwogaW50IGVuYWJsZV93cml0ZWJhY2tfY29ubmVjdG9yKHN0cnVjdCB2a21zX2Rl
dmljZSAqdmttc2Rldik7CiB2b2lkIGRpc2FibGVfd3JpdGViYWNrX2Nvbm5lY3RvcihzdHJ1Y3Qg
dmttc19kZXZpY2UgKmNvbm5lY3Rvcik7CiAKKy8qIENvbmZpZ2ZzICovCitpbnQgdmttc19jb25m
aWdmc19pbml0KHN0cnVjdCB2a21zX2RldmljZSAqdmttc2Rldik7Cit2b2lkIHZrbXNfY29uZmln
ZnNfZXhpdCh2b2lkKTsKKwogI2VuZGlmIC8qIF9WS01TX0RSVl9IXyAqLwotLSAKMi4yMS4wCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBt
YWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3Rz
LmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
