Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 2313BBE949
	for <lists+dri-devel@lfdr.de>; Thu, 26 Sep 2019 01:56:19 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1F5D46EEF7;
	Wed, 25 Sep 2019 23:56:09 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from perceval.ideasonboard.com (perceval.ideasonboard.com
 [213.167.242.64])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 773B06E069
 for <dri-devel@lists.freedesktop.org>; Wed, 25 Sep 2019 23:56:04 +0000 (UTC)
Received: from pendragon.bb.dnainternet.fi (81-175-216-236.bb.dnainternet.fi
 [81.175.216.236])
 by perceval.ideasonboard.com (Postfix) with ESMTPSA id EB7F79BF;
 Thu, 26 Sep 2019 01:56:01 +0200 (CEST)
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v9 2/4] drm: xlnx: DRM/KMS driver for Xilinx ZynqMP
 DisplayPort Subsystem
Date: Thu, 26 Sep 2019 02:55:42 +0300
Message-Id: <20190925235544.11524-3-laurent.pinchart@ideasonboard.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190925235544.11524-1-laurent.pinchart@ideasonboard.com>
References: <20190925235544.11524-1-laurent.pinchart@ideasonboard.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=ideasonboard.com; s=mail; t=1569455762;
 bh=waEI9hFHyfPwRv8r6zTAQYEzAMZq+MthpbQPiCHgSFY=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=HF74/gOYom80d5/19A8ONeZhN4J8Q1O2szquXzHsF651X4iYsDbHiuL1Bgwk1dmC9
 uPXluakRBduBEcLKPHELJoLIcxJpUrG1/A1wbRREXFliyEe7P0wDjp2ygcGbS4gdVT
 SPc9mQE+nhrBxkwf0J3z0i9+7blAniycuEnlKTmw=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Michal Simek <michal.simek@xilinx.com>, Hyun Kwon <hyun.kwon@xilinx.com>,
 Satish Kumar Nagireddy <SATISHNA@xilinx.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogSHl1biBLd29uIDxoeXVuLmt3b25AeGlsaW54LmNvbT4KClRoZSBYaWxpbnggWnlucU1Q
IFNvQyBoYXMgYSBoYXJkZW5lZCBkaXNwbGF5IHBpcGVsaW5lIG5hbWVkIERpc3BsYXlQb3J0ClN1
YnN5c3RlbS4gSXQgaW5jbHVkZXMgYSBidWZmZXIgbWFuYWdlciwgYSB2aWRlbyBwaXBlbGluZSBy
ZW5kZXJlcgooYmxlbmRlciksIGFuIGF1ZGlvIG1peGVyIGFuZCBhIERpc3BsYXlQb3J0IHNvdXJj
ZSBjb250cm9sbGVyCih0cmFuc21pdHRlcikuIFRoZSBETUEgZW5naW5lIHRoZSBwcm92aWRlIGRh
dGEgdG8gdGhlIGJ1ZmZlciBtYW5hZ2VyLCBhcwp3ZWxsIGFzIHRoZSBEaXNwbGF5UG9ydCBQSFlz
IHRoYXQgZHJpdmUgdGhlIGxhbmVzLCBhcmUgZXh0ZXJuYWwgdG8gdGhlCnN1YnN5c3RlbSBhbmQg
aW50ZXJmYWNlZCB1c2luZyB0aGUgRE1BIGVuZ2luZSBhbmQgUEhZIEFQSXMgcmVzcGVjdGl2ZWx5
LgoKVGhpcyBkcml2ZXIgc3VwcG9ydHMgdGhlIERpc3BsYXlQb3J0IFN1YnN5c3RlbSBhbmQgaW1w
bGVtZW50cwoKLSBUd28gcGxhbmVzLCBmb3IgZ3JhcGhpY3MgYW5kIHZpZGVvCi0gT25lIENSVEMg
dGhhdCBzdXBwb3J0cyBhbHBoYSBibGVuZGluZwotIE9uZSBlbmNvZGVyIGZvciB0aGUgRGlzcGxh
eVBvcnQgdHJhbnNtaXR0ZXIKLSBPbmUgY29ubmVjdG9yIGZvciBhbiBleHRlcm5hbCBtb25pdG9y
CgpJdCBjdXJyZW50bHkgZG9lc24ndCBzdXBwb3J0CgotIENvbG9yIGtleWluZwotIFRlc3QgcGF0
dGVybiBnZW5lcmF0aW9uCi0gQXVkaW8KLSBMaXZlIGlucHV0IGZyb20gdGhlIFByb2dyYW1tYWJs
ZSBMb2dpYyAoRlBHQSkKLSBPdXRwdXQgdG8gdGhlIFByb2dyYW1tYWJsZSBMb2dpYyAoRlBHQSkK
ClNpZ25lZC1vZmYtYnk6IEh5dW4gS3dvbiA8aHl1bi5rd29uQHhpbGlueC5jb20+ClNpZ25lZC1v
ZmYtYnk6IExhdXJlbnQgUGluY2hhcnQgPGxhdXJlbnQucGluY2hhcnRAaWRlYXNvbmJvYXJkLmNv
bT4KLS0tCk5vdGFibGUgY2hhbmdlcyBzaW5jZSB2ODoKCi0gUmViYXNlIG9uIHRvcCBvZiB2NS4z
IGFuZCB1cGRhdGUgdG8gQVBJIGNoYW5nZXMKLSBDbGVhbnVwICNpbmNsdWRlIHN0YXRlbWVudHMK
LSBVc2UgdGhlIG1vZGUgY29uZmlnIHN1c3BlbmQvcmVzdW1lIGhlbHBlcnMKLSBSZW1vdmUgdW51
c2VkIGNvZGUgKG1hY3JvcywgZmllbGRzLCBmdW5jdGlvbnMsIC4uLikKLSBTb3J0IGhlYWRlcnMg
YW5kIGZvcndhcmQgZGVjbGFyYXRpb25zIGFscGhhYmV0aWNhbGx5Ci0gVXNlIG1vcmUgc3RhbmRh
cmQgRFJNL0tNUyBoZWxwZXJzIChzdXNwZW5kL3Jlc3VtZSwgZmJkZXYsCiAgREVGSU5FX0RSTV9H
RU1fQ01BX0ZPUFMpCi0gRHJvcCBzdXBwb3J0IGZvciBoYWxmLWltcGxlbWVudGVkIG9yIHVuc3Vw
cG9ydGVkIGZlYXR1cmVzIChzb3VuZCBEVAogIGJpbmRpbmdzIHBhcnNpbmcsIGludGVyZmFjZSB3
aXRoIFBMKQotIFJlbW92ZSB0aGUgeGxueCBkcm0gaGVscGVycwotIFJlbW92ZSBzb21lIG1vZHVs
ZSBwYXJhbWV0ZXJzCi0gUmVvcmdhbml6ZSBjb2RlIGluIHNlY3Rpb25zLCB3aXRoIGJldHRlciBz
ZXBhcmF0aW9uIG9mIG9wZXJhdGlvbnMKLSBCZXR0ZXIgc2VwYXJhdGlvbiBvZiB0aGUgZW5jb2Rl
ciBmcm9tIHRoZSBDUlRDCi0gRHJvcCB0aGUgY29tcG9uZW50IGZyYW1ld29yawotIFZhcmlvdXMg
a2VybmVsZG9jIHJld29ya3MsIHdpdGggcmVuYW1lcyBvZiBzdHJ1Y3R1cmVzLCBmaWVsZHMgYW5k
CiAgZnVuY3Rpb25zCi0gRml4IHZibGFuayBhbmQgcGFnZSBmbGlwIGV2ZW50IGhhbmRsaW5nCi0g
UmVtb3ZlIGhhY2sgdG8gZGlzYWJsZSBjbG9ja3MgYXQgc3RhcnR1cAotIFVwZGF0ZSBjb3B5cmln
aHQgaGVhZGVycwotIE1vdmUgY2hlY2tzIGZyb20gYXRvbWljIGNvbW1pdCB0aW1lIHRvIGF0b21p
YyBjaGVjayB0aW1lCi0gUmVtb3ZlIHBhcnRpYWwgc3VwcG9ydCBmb3IgdGhlIFRQRwotIFJlbW92
ZSBwYXJ0aWFsIHN1cHBvcnQgZm9yIGxpdmUgaW5wdXRzCi0gUmVtb3ZlIGFzeW5jIHVwZGF0ZSBz
dXBwb3J0Ci0gQ2xlYW4gdXAgRFAgVFggaW5pdGlhbGlzYXRpb24gYW5kIGNsZWFudXAKLS0tCiBN
QUlOVEFJTkVSUyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICA5ICsKIGRyaXZlcnMv
Z3B1L2RybS9LY29uZmlnICAgICAgICAgICAgICAgICB8ICAgIDIgKwogZHJpdmVycy9ncHUvZHJt
L01ha2VmaWxlICAgICAgICAgICAgICAgIHwgICAgMSArCiBkcml2ZXJzL2dwdS9kcm0veGxueC9L
Y29uZmlnICAgICAgICAgICAgfCAgIDEzICsKIGRyaXZlcnMvZ3B1L2RybS94bG54L01ha2VmaWxl
ICAgICAgICAgICB8ICAgIDIgKwogZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rpc3AuYyAg
ICAgIHwgMTY3OCArKysrKysrKysrKysrKysrKysrKysrKwogZHJpdmVycy9ncHUvZHJtL3hsbngv
enlucW1wX2Rpc3AuaCAgICAgIHwgICA0MyArCiBkcml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBf
ZGlzcF9yZWdzLmggfCAgMjAxICsrKwogZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2RwLmMg
ICAgICAgIHwgMTY3NyArKysrKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0veGxu
eC96eW5xbXBfZHAuaCAgICAgICAgfCAgIDI5ICsKIGRyaXZlcnMvZ3B1L2RybS94bG54L3p5bnFt
cF9kcHN1Yi5jICAgICB8ICAzMzEgKysrKysKIGRyaXZlcnMvZ3B1L2RybS94bG54L3p5bnFtcF9k
cHN1Yi5oICAgICB8ICAgNDggKwogMTIgZmlsZXMgY2hhbmdlZCwgNDAzNCBpbnNlcnRpb25zKCsp
CiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL3hsbngvS2NvbmZpZwogY3JlYXRl
IG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS94bG54L01ha2VmaWxlCiBjcmVhdGUgbW9kZSAx
MDA2NDQgZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rpc3AuYwogY3JlYXRlIG1vZGUgMTAw
NjQ0IGRyaXZlcnMvZ3B1L2RybS94bG54L3p5bnFtcF9kaXNwLmgKIGNyZWF0ZSBtb2RlIDEwMDY0
NCBkcml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZGlzcF9yZWdzLmgKIGNyZWF0ZSBtb2RlIDEw
MDY0NCBkcml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZHAuYwogY3JlYXRlIG1vZGUgMTAwNjQ0
IGRyaXZlcnMvZ3B1L2RybS94bG54L3p5bnFtcF9kcC5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJp
dmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rwc3ViLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2
ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZHBzdWIuaAoKZGlmZiAtLWdpdCBhL01BSU5UQUlORVJT
IGIvTUFJTlRBSU5FUlMKaW5kZXggMzBmM2IyZjhiNzVhLi4zMzYxZDI5YWQwMjcgMTAwNjQ0Ci0t
LSBhL01BSU5UQUlORVJTCisrKyBiL01BSU5UQUlORVJTCkBAIC01NTA2LDYgKzU1MDYsMTUgQEAg
RjoJZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvCiBGOglpbmNsdWRlL3VhcGkvZHJtL2V0bmF2aXZf
ZHJtLmgKIEY6CURvY3VtZW50YXRpb24vZGV2aWNldHJlZS9iaW5kaW5ncy9kaXNwbGF5L2V0bmF2
aXYvCiAKK0RSTSBEUklWRVJTIEZPUiBYSUxJTlgKK006CUh5dW4gS3dvbiA8aHl1bi5rd29uQHhp
bGlueC5jb20+CitNOglMYXVyZW50IFBpbmNoYXJ0IDxsYXVyZW50LnBpbmNoYXJ0QGlkZWFzb25i
b2FyZC5jb20+CitMOglkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCitTOglNYWludGFp
bmVkCitGOglkcml2ZXJzL2dwdS9kcm0veGxueC8KK0Y6CURvY3VtZW50YXRpb24vZGV2aWNldHJl
ZS9iaW5kaW5ncy9kaXNwbGF5L3hsbngvCitUOglnaXQgZ2l0Oi8vYW5vbmdpdC5mcmVlZGVza3Rv
cC5vcmcvZHJtL2RybS1taXNjCisKIERSTSBEUklWRVJTIEZPUiBaVEUgWlgKIE06CVNoYXduIEd1
byA8c2hhd25ndW9Aa2VybmVsLm9yZz4KIEw6CWRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5v
cmcKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9LY29uZmlnIGIvZHJpdmVycy9ncHUvZHJt
L0tjb25maWcKaW5kZXggM2M4ODQyMGUzNDk3Li4yOWYzNWZjNzFiMDEgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9LY29uZmlnCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9LY29uZmlnCkBAIC0z
NTQsNiArMzU0LDggQEAgc291cmNlICJkcml2ZXJzL2dwdS9kcm0vYXNwZWVkL0tjb25maWciCiAK
IHNvdXJjZSAiZHJpdmVycy9ncHUvZHJtL21jZGUvS2NvbmZpZyIKIAorc291cmNlICJkcml2ZXJz
L2dwdS9kcm0veGxueC9LY29uZmlnIgorCiAjIEtlZXAgbGVnYWN5IGRyaXZlcnMgbGFzdAogCiBt
ZW51Y29uZmlnIERSTV9MRUdBQ1kKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9NYWtlZmls
ZSBiL2RyaXZlcnMvZ3B1L2RybS9NYWtlZmlsZQppbmRleCA5ZjBkMmVlMzU3OTQuLmViOTFjZmRh
YzEzYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL01ha2VmaWxlCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9NYWtlZmlsZQpAQCAtMTIwLDMgKzEyMCw0IEBAIG9iai0kKENPTkZJR19EUk1fTElN
QSkgICs9IGxpbWEvCiBvYmotJChDT05GSUdfRFJNX1BBTkZST1NUKSArPSBwYW5mcm9zdC8KIG9i
ai0kKENPTkZJR19EUk1fQVNQRUVEX0dGWCkgKz0gYXNwZWVkLwogb2JqLSQoQ09ORklHX0RSTV9N
Q0RFKSArPSBtY2RlLworb2JqLXkJCQkrPSB4bG54LwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL3hsbngvS2NvbmZpZyBiL2RyaXZlcnMvZ3B1L2RybS94bG54L0tjb25maWcKbmV3IGZpbGUg
bW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5hYTZjZDg4OWJkMTEKLS0tIC9kZXYvbnVs
bAorKysgYi9kcml2ZXJzL2dwdS9kcm0veGxueC9LY29uZmlnCkBAIC0wLDAgKzEsMTMgQEAKK2Nv
bmZpZyBEUk1fWllOUU1QX0RQU1VCCisJdHJpc3RhdGUgIlp5bnFNUCBEaXNwbGF5UG9ydCBDb250
cm9sbGVyIERyaXZlciIKKwlkZXBlbmRzIG9uIEFSQ0hfWllOUU1QIHx8IENPTVBJTEVfVEVTVAor
CWRlcGVuZHMgb24gQ09NTU9OX0NMSyAmJiBEUk0gJiYgT0YKKwlzZWxlY3QgRE1BX0VOR0lORQor
CXNlbGVjdCBEUk1fR0VNX0NNQV9IRUxQRVIKKwlzZWxlY3QgRFJNX0tNU19DTUFfSEVMUEVSCisJ
c2VsZWN0IERSTV9LTVNfSEVMUEVSCisJc2VsZWN0IEdFTkVSSUNfUEhZCisJaGVscAorCSAgVGhp
cyBpcyBhIERSTS9LTVMgZHJpdmVyIGZvciBaeW5xTVAgRGlzcGxheVBvcnQgY29udHJvbGxlci4g
Q2hvb3NlCisJICB0aGlzIG9wdGlvbiBpZiB5b3UgaGF2ZSBhIFhpbGlueCBaeW5xTVAgU29DIHdp
dGggRGlzcGxheVBvcnQKKwkgIHN1YnN5c3RlbS4KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS94bG54L01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL3hsbngvTWFrZWZpbGUKbmV3IGZpbGUg
bW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4yYjg0NGM2MGE4MGEKLS0tIC9kZXYvbnVs
bAorKysgYi9kcml2ZXJzL2dwdS9kcm0veGxueC9NYWtlZmlsZQpAQCAtMCwwICsxLDIgQEAKK3p5
bnFtcC1kcHN1Yi1vYmpzICs9IHp5bnFtcF9kaXNwLm8genlucW1wX2Rwc3ViLm8genlucW1wX2Rw
Lm8KK29iai0kKENPTkZJR19EUk1fWllOUU1QX0RQU1VCKSArPSB6eW5xbXAtZHBzdWIubwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rpc3AuYyBiL2RyaXZlcnMvZ3B1
L2RybS94bG54L3p5bnFtcF9kaXNwLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MDAwMDAwLi5kMmVhYjk4MTNjYjcKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
eGxueC96eW5xbXBfZGlzcC5jCkBAIC0wLDAgKzEsMTY3OCBAQAorLy8gU1BEWC1MaWNlbnNlLUlk
ZW50aWZpZXI6IEdQTC0yLjAKKy8qCisgKiBaeW5xTVAgRGlzcGxheSBDb250cm9sbGVyIERyaXZl
cgorICoKKyAqIENvcHlyaWdodCAoQykgMjAxNyAtIDIwMTkgWGlsaW54LCBJbmMuCisgKgorICog
QXV0aG9yczoKKyAqIC0gSHl1biBXb28gS3dvbiA8aHl1bi5rd29uQHhpbGlueC5jb20+CisgKiAt
IExhdXJlbnQgUGluY2hhcnQgPGxhdXJlbnQucGluY2hhcnRAaWRlYXNvbmJvYXJkLmNvbT4KKyAq
LworCisjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWMuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21p
Y19oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pY191YXBpLmg+CisjaW5jbHVkZSA8
ZHJtL2RybV9jcnRjLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9kZXZpY2UuaD4KKyNpbmNsdWRlIDxk
cm0vZHJtX2ZiX2NtYV9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2ZvdXJjYy5oPgorI2lu
Y2x1ZGUgPGRybS9kcm1fZnJhbWVidWZmZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3BsYW5lLmg+
CisjaW5jbHVkZSA8ZHJtL2RybV9wbGFuZV9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3Zi
bGFuay5oPgorCisjaW5jbHVkZSA8bGludXgvY2xrLmg+CisjaW5jbHVkZSA8bGludXgvZGVsYXku
aD4KKyNpbmNsdWRlIDxsaW51eC9kbWEtbWFwcGluZy5oPgorI2luY2x1ZGUgPGxpbnV4L2RtYWVu
Z2luZS5oPgorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgorI2luY2x1ZGUgPGxpbnV4L29mLmg+
CisjaW5jbHVkZSA8bGludXgvb2ZfZG1hLmg+CisjaW5jbHVkZSA8bGludXgvcGxhdGZvcm1fZGV2
aWNlLmg+CisjaW5jbHVkZSA8bGludXgvcG1fcnVudGltZS5oPgorI2luY2x1ZGUgPGxpbnV4L3Nw
aW5sb2NrLmg+CisKKyNpbmNsdWRlICJ6eW5xbXBfZGlzcC5oIgorI2luY2x1ZGUgInp5bnFtcF9k
aXNwX3JlZ3MuaCIKKyNpbmNsdWRlICJ6eW5xbXBfZHAuaCIKKyNpbmNsdWRlICJ6eW5xbXBfZHBz
dWIuaCIKKworLyoKKyAqIE92ZXJ2aWV3CisgKiAtLS0tLS0tLQorICoKKyAqIFRoZSBkaXNwbGF5
IGNvbnRyb2xsZXIgcGFydCBvZiBaeW5xTVAgRFAgc3Vic3lzdGVtLCBtYWRlIG9mIHRoZSBBdWRp
by9WaWRlbworICogQnVmZmVyIE1hbmFnZXIsIHRoZSBWaWRlbyBSZW5kZXJpbmcgUGlwZWxpbmUg
KGJsZW5kZXIpIGFuZCB0aGUgQXVkaW8gTWl4ZXIuCisgKgorICogICAgICAgICAgICAgICstLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0r
CisgKiArLS0tLS0tLS0rICAgfCArLS0tLS0tLS0tLS0tLS0tLSsgICAgICstLS0tLS0tLS0tLSsg
ICAgICAgICAgICAgICAgICAgICAgIHwKKyAqIHwgRFBETUEgIHwgLS0tPnwgICAgICAgICAgICAg
ICAgfCAtLT4gfCAgIFZpZGVvICAgfCBWaWRlbyArLS0tLS0tLS0tLS0tLSsgfAorICogfCA0eCB2
aWQgfCAgIHwgfCAgICAgICAgICAgICAgICB8ICAgICB8IFJlbmRlcmluZyB8IC0rLS0+IHwgICAg
ICAgICAgICAgfCB8ICAgKy0tLS0tLSsKKyAqIHwgMnggYXVkIHwgICB8IHwgIEF1ZGlvL1ZpZGVv
ICAgfCAtLT4gfCBQaXBlbGluZSAgfCAgfCAgICB8IERpc3BsYXlQb3J0IHwtLS0+IHwgUEhZMCB8
CisgKiArLS0tLS0tLS0rICAgfCB8IEJ1ZmZlciBNYW5hZ2VyIHwgICAgICstLS0tLS0tLS0tLSsg
IHwgICAgfCAgIFNvdXJjZSAgICB8IHwgICArLS0tLS0tKworICogICAgICAgICAgICAgIHwgfCAg
ICBhbmQgU1RDICAgICB8ICAgICArLS0tLS0tLS0tLS0rICB8ICAgIHwgQ29udHJvbGxlciAgfCB8
ICAgKy0tLS0tLSsKKyAqIExpdmUgVmlkZW8gLS0tPnwgICAgICAgICAgICAgICAgfCAtLT4gfCAg
IEF1ZGlvICAgfCBBdWRpbyB8ICAgICAgICAgICAgIHwtLS0+IHwgUEhZMSB8CisgKiAgICAgICAg
ICAgICAgfCB8ICAgICAgICAgICAgICAgIHwgICAgIHwgICBNaXhlciAgIHwgLS0rLT4gfCAgICAg
ICAgICAgICB8IHwgICArLS0tLS0tKworICogTGl2ZSBBdWRpbyAtLS0+fCAgICAgICAgICAgICAg
ICB8IC0tPiB8ICAgICAgICAgICB8ICB8fCAgICstLS0tLS0tLS0tLS0tKyB8CisgKiAgICAgICAg
ICAgICAgfCArLS0tLS0tLS0tLS0tLS0tLSsgICAgICstLS0tLS0tLS0tLSsgIHx8ICAgICAgICAg
ICAgICAgICAgIHwKKyAqICAgICAgICAgICAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tfHwtLS0tLS0tLS0tLS0tLS0tLS0tKworICogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2dgorICogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCbGVuZGVkIFZpZGVvIGFuZAorICogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNaXhlZCBBdWRpbyB0
byBQTAorICoKKyAqIE9ubHkgbm9uLWxpdmUgaW5wdXQgZnJvbSB0aGUgRFBETUEgYW5kIG91dHB1
dCB0byB0aGUgRGlzcGxheVBvcnQgU291cmNlCisgKiBDb250cm9sbGVyIGFyZSBjdXJyZW50bHkg
c3VwcG9ydGVkLiBJbnRlcmZhY2Ugd2l0aCB0aGUgcHJvZ3JhbW1hYmxlIGxvZ2ljCisgKiBmb3Ig
bGl2ZSBzdHJlYW1zIGlzIG5vdCBpbXBsZW1lbnRlZC4KKyAqCisgKiBUaGUgZGlzcGxheSBjb250
cm9sbGVyIGNvZGUgY3JlYXRlcyBwbGFuZXMgZm9yIHRoZSBEUERNQSB2aWRlbyBhbmQgZ3JhcGhp
Y3MKKyAqIGxheWVycywgYW5kIGEgQ1JUQyBmb3IgdGhlIFZpZGVvIFJlbmRlcmluZyBQaXBlbGlu
ZS4KKyAqCisgKiBpbnRlcmZhY2UgaW50byB0aG9zZSAzIGJsb2Nrcy4gSW4gaGlnaCBsZXZlbCwg
dGhlIGRyaXZlciBpcyBsYXllcmVkCisgKiBpbiB0aGUgZm9sbG93aW5nIHdheToKKyAqCisgKiB6
eW5xbXBfZGlzcF9jcnRjICYgenlucW1wX2Rpc3BfcGxhbmUKKyAqIHwtPnp5bnFtcF9kaXNwCisg
Kgl8LT56eW5xbXBfZGlzcF9hdWQKKyAqCXwtPnp5bnFtcF9kaXNwX2JsZW5kCisgKgl8LT56eW5x
bXBfZGlzcF9hdmJ1ZgorICovCisKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX05VTV9WSURf
R0ZYX0JVRkZFUlMJCTQKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX05VTV9CVUZGRVJTCQkJ
NgorCisjZGVmaW5lIFpZTlFNUF9ESVNQX05VTV9MQVlFUlMJCQkJMgorI2RlZmluZSBaWU5RTVBf
RElTUF9NQVhfTlVNX1NVQl9QTEFORVMJCQkzCisKKy8qKgorICogc3RydWN0IHp5bnFtcF9kaXNw
X2Zvcm1hdCAtIERpc3BsYXkgc3Vic3lzdGVtIGZvcm1hdCBpbmZvcm1hdGlvbgorICogQGRybV9m
bXQ6IERSTSBmb3JtYXQgKDRDQykKKyAqIEBidWZfZm10OiBBViBidWZmZXIgZm9ybWF0CisgKiBA
YnVzX2ZtdDogTWVkaWEgYnVzIGZvcm1hdHMgKGxpdmUgZm9ybWF0cykKKyAqIEBzd2FwOiBGbGFn
IHRvIHN3YXAgUiAmIEIgZm9yIFJHQiBmb3JtYXRzLCBhbmQgVSAmIFYgZm9yIFlVViBmb3JtYXRz
CisgKiBAc2Y6IFNjYWxpbmcgZmFjdG9ycyBmb3IgY29sb3IgY29tcG9uZW50cworICovCitzdHJ1
Y3QgenlucW1wX2Rpc3BfZm9ybWF0IHsKKwl1MzIgZHJtX2ZtdDsKKwl1MzIgYnVmX2ZtdDsKKwl1
MzIgYnVzX2ZtdDsKKwlib29sIHN3YXA7CisJY29uc3QgdTMyICpzZjsKK307CisKKy8qKgorICog
ZW51bSB6eW5xbXBfZGlzcF9pZCAtIExheWVyIGlkZW50aWZpZXIKKyAqIEBaWU5RTVBfRElTUF9M
QVlFUl9WSUQ6IFZpZGVvIGxheWVyCisgKiBAWllOUU1QX0RJU1BfTEFZRVJfR0ZYOiBHcmFwaGlj
cyBsYXllcgorICovCitlbnVtIHp5bnFtcF9kaXNwX2xheWVyX2lkIHsKKwlaWU5RTVBfRElTUF9M
QVlFUl9WSUQsCisJWllOUU1QX0RJU1BfTEFZRVJfR0ZYCit9OworCisvKioKKyAqIGVudW0genlu
cW1wX2Rpc3BfbGF5ZXJfbW9kZSAtIExheWVyIG1vZGUKKyAqIEBaWU5RTVBfRElTUF9MQVlFUl9O
T05MSVZFOiBub24tbGl2ZSAobWVtb3J5KSBtb2RlCisgKiBAWllOUU1QX0RJU1BfTEFZRVJfTElW
RTogbGl2ZSAoc3RyZWFtKSBtb2RlCisgKi8KK2VudW0genlucW1wX2Rpc3BfbGF5ZXJfbW9kZSB7
CisJWllOUU1QX0RJU1BfTEFZRVJfTk9OTElWRSwKKwlaWU5RTVBfRElTUF9MQVlFUl9MSVZFCit9
OworCisvKioKKyAqIHN0cnVjdCB6eW5xbXBfZGlzcF9sYXllcl9kbWEgLSBETUEgY2hhbm5lbCBm
b3Igb25lIGRhdGEgcGxhbmUgb2YgYSBsYXllcgorICogQGNoYW46IERNQSBjaGFubmVsCisgKiBA
eHQ6IEludGVybGVhdmVkIERNQSBkZXNjcmlwdG9yIHRlbXBsYXRlCisgKiBAc2dsOiBEYXRhIGNo
dW5rIGZvciBkbWFfaW50ZXJsZWF2ZWRfdGVtcGxhdGUKKyAqLworc3RydWN0IHp5bnFtcF9kaXNw
X2xheWVyX2RtYSB7CisJc3RydWN0IGRtYV9jaGFuICpjaGFuOworCXN0cnVjdCBkbWFfaW50ZXJs
ZWF2ZWRfdGVtcGxhdGUgeHQ7CisJc3RydWN0IGRhdGFfY2h1bmsgc2dsOworfTsKKworLyoqCisg
KiBzdHJ1Y3QgenlucW1wX2Rpc3BfbGF5ZXJfaW5mbyAtIFN0YXRpYyBsYXllciBpbmZvcm1hdGlv
bgorICogQGZvcm1hdHM6IEFycmF5IG9mIHN1cHBvcnRlZCBmb3JtYXRzCisgKiBAbnVtX2Zvcm1h
dHM6IE51bWJlciBvZiBmb3JtYXRzIGluIEBmb3JtYXRzIGFycmF5CisgKiBAbnVtX2NoYW5uZWxz
OiBOdW1iZXIgb2YgRE1BIGNoYW5uZWxzCisgKi8KK3N0cnVjdCB6eW5xbXBfZGlzcF9sYXllcl9p
bmZvIHsKKwljb25zdCBzdHJ1Y3QgenlucW1wX2Rpc3BfZm9ybWF0ICpmb3JtYXRzOworCXVuc2ln
bmVkIGludCBudW1fZm9ybWF0czsKKwl1bnNpZ25lZCBpbnQgbnVtX2NoYW5uZWxzOworfTsKKwor
LyoqCisgKiBzdHJ1Y3QgenlucW1wX2Rpc3BfbGF5ZXIgLSBEaXNwbGF5IGxheWVyIChEUk0gcGxh
bmUpCisgKiBAcGxhbmU6IERSTSBwbGFuZQorICogQGlkOiBMYXllciBJRAorICogQGRpc3A6IEJh
Y2sgcG9pbnRlciB0byBzdHJ1Y3QgenlucW1wX2Rpc3AKKyAqIEBpbmZvOiBTdGF0aWMgbGF5ZXIg
aW5mb3JtYXRpb24KKyAqIEBkbWFzOiBETUEgY2hhbm5lbHMKKyAqIEBkaXNwX2ZtdDogQ3VycmVu
dCBmb3JtYXQgaW5mb3JtYXRpb24KKyAqIEBkcm1fZm10OiBDdXJyZW50IERSTSBmb3JtYXQgaW5m
b3JtYXRpb24KKyAqIEBtb2RlOiBDdXJyZW50IG9wZXJhdGlvbiBtb2RlCisgKi8KK3N0cnVjdCB6
eW5xbXBfZGlzcF9sYXllciB7CisJc3RydWN0IGRybV9wbGFuZSBwbGFuZTsKKwllbnVtIHp5bnFt
cF9kaXNwX2xheWVyX2lkIGlkOworCXN0cnVjdCB6eW5xbXBfZGlzcCAqZGlzcDsKKwljb25zdCBz
dHJ1Y3QgenlucW1wX2Rpc3BfbGF5ZXJfaW5mbyAqaW5mbzsKKworCXN0cnVjdCB6eW5xbXBfZGlz
cF9sYXllcl9kbWEgZG1hc1taWU5RTVBfRElTUF9NQVhfTlVNX1NVQl9QTEFORVNdOworCisJY29u
c3Qgc3RydWN0IHp5bnFtcF9kaXNwX2Zvcm1hdCAqZGlzcF9mbXQ7CisJY29uc3Qgc3RydWN0IGRy
bV9mb3JtYXRfaW5mbyAqZHJtX2ZtdDsKKwllbnVtIHp5bnFtcF9kaXNwX2xheWVyX21vZGUgbW9k
ZTsKK307CisKKy8qKgorICogc3RydWN0IHp5bnFtcF9kaXNwX2JsZW5kIC0gQmxlbmRlcgorICog
QGJhc2U6IFJlZ2lzdGVycyBJL08gYmFzZSBhZGRyZXNzCisgKi8KK3N0cnVjdCB6eW5xbXBfZGlz
cF9ibGVuZCB7CisJdm9pZCBfX2lvbWVtICpiYXNlOworfTsKKworLyoqCisgKiBzdHJ1Y3Qgenlu
cW1wX2Rpc3BfYXZidWYgLSBBdWRpby92aWRlbyBidWZmZXIgbWFuYWdlcgorICogQGJhc2U6IFJl
Z2lzdGVycyBJL08gYmFzZSBhZGRyZXNzCisgKi8KK3N0cnVjdCB6eW5xbXBfZGlzcF9hdmJ1ZiB7
CisJdm9pZCBfX2lvbWVtICpiYXNlOworfTsKKworLyoqCisgKiBzdHJ1Y3QgenlucW1wX2Rpc3Bf
YXVkaW8gLSBBdWRpbyBtaXhlcgorICogQGJhc2U6IFJlZ2lzdGVycyBJL08gYmFzZSBhZGRyZXNz
CisgKiBAX3BzX2NsazogQXVkaW8gY2xvY2sgZnJvbSBQUworICogQF9wbF9jbGs6IEF1ZGlvIGNs
b2NrIGZyb20gUEwKKyAqIEBjbGs6IEF1ZGlvIGNsb2NrCisgKi8KK3N0cnVjdCB6eW5xbXBfZGlz
cF9hdWRpbyB7CisJdm9pZCBfX2lvbWVtICpiYXNlOworCXN0cnVjdCBjbGsgKl9wc19jbGs7CisJ
c3RydWN0IGNsayAqX3BsX2NsazsKKwlzdHJ1Y3QgY2xrICpjbGs7Cit9OworCisvKioKKyAqIHN0
cnVjdCB6eW5xbXBfZGlzcCAtIERpc3BsYXkgY29udHJvbGxlcgorICogQGRldjogRGV2aWNlIHN0
cnVjdHVyZQorICogQGRybTogRFJNIGNvcmUKKyAqIEBkcHN1YjogRGlzcGxheSBzdWJzeXN0ZW0K
KyAqIEBjcnRjOiBEUk0gQ1JUQworICogQGJsZW5kOiBCbGVuZGVyICh2aWRlbyByZW5kZXJpbmcg
cGlwZWxpbmUpCisgKiBAYXZidWY6IEF1ZGlvL3ZpZGVvIGJ1ZmZlciBtYW5hZ2VyCisgKiBAYXVk
aW86IEF1ZGlvIG1peGVyCisgKiBAbGF5ZXJzOiBMYXllcnMgKHBsYW5lcykKKyAqIEBldmVudDog
UGVuZGluZyB2YmxhbmsgZXZlbnQgcmVxdWVzdAorICogQF9wc19wY2xrOiBQaXhlbCBjbG9jayBm
cm9tIFBTCisgKiBAX3BsX3BjbGs6IFBpeGVsIGNsb2NrIGZyb20gUEwKKyAqIEBwY2xrOiBQaXhl
bCBjbG9jaworICovCitzdHJ1Y3QgenlucW1wX2Rpc3AgeworCXN0cnVjdCBkZXZpY2UgKmRldjsK
KwlzdHJ1Y3QgZHJtX2RldmljZSAqZHJtOworCXN0cnVjdCB6eW5xbXBfZHBzdWIgKmRwc3ViOwor
CisJc3RydWN0IGRybV9jcnRjIGNydGM7CisKKwlzdHJ1Y3QgenlucW1wX2Rpc3BfYmxlbmQgYmxl
bmQ7CisJc3RydWN0IHp5bnFtcF9kaXNwX2F2YnVmIGF2YnVmOworCXN0cnVjdCB6eW5xbXBfZGlz
cF9hdWRpbyBhdWRpbzsKKworCXN0cnVjdCB6eW5xbXBfZGlzcF9sYXllciBsYXllcnNbWllOUU1Q
X0RJU1BfTlVNX0xBWUVSU107CisKKwlzdHJ1Y3QgZHJtX3BlbmRpbmdfdmJsYW5rX2V2ZW50ICpl
dmVudDsKKworCS8qIERvbid0IG9wZXJhdGUgZGlyZWN0bHkgb24gX3BzXyAqLworCXN0cnVjdCBj
bGsgKl9wc19wY2xrOworCXN0cnVjdCBjbGsgKl9wbF9wY2xrOworCXN0cnVjdCBjbGsgKnBjbGs7
Cit9OworCisvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICogQXVkaW8vVmlkZW8gQnVmZmVyIE1h
bmFnZXIKKyAqLworCitzdGF0aWMgY29uc3QgdTMyIHNjYWxpbmdfZmFjdG9yc180NDRbXSA9IHsK
KwlaWU5RTVBfRElTUF9BVl9CVUZfNEJJVF9TRiwKKwlaWU5RTVBfRElTUF9BVl9CVUZfNEJJVF9T
RiwKKwlaWU5RTVBfRElTUF9BVl9CVUZfNEJJVF9TRiwKK307CisKK3N0YXRpYyBjb25zdCB1MzIg
c2NhbGluZ19mYWN0b3JzXzU1NVtdID0geworCVpZTlFNUF9ESVNQX0FWX0JVRl81QklUX1NGLAor
CVpZTlFNUF9ESVNQX0FWX0JVRl81QklUX1NGLAorCVpZTlFNUF9ESVNQX0FWX0JVRl81QklUX1NG
LAorfTsKKworc3RhdGljIGNvbnN0IHUzMiBzY2FsaW5nX2ZhY3RvcnNfNTY1W10gPSB7CisJWllO
UU1QX0RJU1BfQVZfQlVGXzVCSVRfU0YsCisJWllOUU1QX0RJU1BfQVZfQlVGXzZCSVRfU0YsCisJ
WllOUU1QX0RJU1BfQVZfQlVGXzVCSVRfU0YsCit9OworCitzdGF0aWMgY29uc3QgdTMyIHNjYWxp
bmdfZmFjdG9yc182NjZbXSA9IHsKKwlaWU5RTVBfRElTUF9BVl9CVUZfNkJJVF9TRiwKKwlaWU5R
TVBfRElTUF9BVl9CVUZfNkJJVF9TRiwKKwlaWU5RTVBfRElTUF9BVl9CVUZfNkJJVF9TRiwKK307
CisKK3N0YXRpYyBjb25zdCB1MzIgc2NhbGluZ19mYWN0b3JzXzg4OFtdID0geworCVpZTlFNUF9E
SVNQX0FWX0JVRl84QklUX1NGLAorCVpZTlFNUF9ESVNQX0FWX0JVRl84QklUX1NGLAorCVpZTlFN
UF9ESVNQX0FWX0JVRl84QklUX1NGLAorfTsKKworc3RhdGljIGNvbnN0IHUzMiBzY2FsaW5nX2Zh
Y3RvcnNfMTAxMDEwW10gPSB7CisJWllOUU1QX0RJU1BfQVZfQlVGXzEwQklUX1NGLAorCVpZTlFN
UF9ESVNQX0FWX0JVRl8xMEJJVF9TRiwKKwlaWU5RTVBfRElTUF9BVl9CVUZfMTBCSVRfU0YsCit9
OworCisvKiBMaXN0IG9mIHZpZGVvIGxheWVyIGZvcm1hdHMgKi8KK3N0YXRpYyBjb25zdCBzdHJ1
Y3QgenlucW1wX2Rpc3BfZm9ybWF0IGF2YnVmX3ZpZF9mbXRzW10gPSB7CisJeworCQkuZHJtX2Zt
dAk9IERSTV9GT1JNQVRfVllVWSwKKwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1U
X05MX1ZJRF9WWVVZLAorCQkuc3dhcAkJPSB0cnVlLAorCQkuc2YJCT0gc2NhbGluZ19mYWN0b3Jz
Xzg4OCwKKwl9LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9VWVZZLAorCQkuYnVmX2ZtdAk9
IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1ZZVVksCisJCS5zd2FwCQk9IGZhbHNlLAor
CQkuc2YJCT0gc2NhbGluZ19mYWN0b3JzXzg4OCwKKwl9LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZP
Uk1BVF9ZVVlWLAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1lV
WVYsCisJCS5zd2FwCQk9IGZhbHNlLAorCQkuc2YJCT0gc2NhbGluZ19mYWN0b3JzXzg4OCwKKwl9
LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9ZVllVLAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9E
SVNQX0FWX0JVRl9GTVRfTkxfVklEX1lVWVYsCisJCS5zd2FwCQk9IHRydWUsCisJCS5zZgkJPSBz
Y2FsaW5nX2ZhY3RvcnNfODg4LAorCX0sIHsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFUX1lVVjQy
MiwKKwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9ZVjE2LAorCQku
c3dhcAkJPSBmYWxzZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc184ODgsCisJfSwgeworCQku
ZHJtX2ZtdAk9IERSTV9GT1JNQVRfWVZVNDIyLAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FW
X0JVRl9GTVRfTkxfVklEX1lWMTYsCisJCS5zd2FwCQk9IHRydWUsCisJCS5zZgkJPSBzY2FsaW5n
X2ZhY3RvcnNfODg4LAorCX0sIHsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFUX1lVVjQ0NCwKKwkJ
LmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9ZVjI0LAorCQkuc3dhcAkJ
PSBmYWxzZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc184ODgsCisJfSwgeworCQkuZHJtX2Zt
dAk9IERSTV9GT1JNQVRfWVZVNDQ0LAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9G
TVRfTkxfVklEX1lWMjQsCisJCS5zd2FwCQk9IHRydWUsCisJCS5zZgkJPSBzY2FsaW5nX2ZhY3Rv
cnNfODg4LAorCX0sIHsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFUX05WMTYsCisJCS5idWZfZm10
CT0gWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVYxNkNJLAorCQkuc3dhcAkJPSBmYWxz
ZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc184ODgsCisJfSwgeworCQkuZHJtX2ZtdAk9IERS
TV9GT1JNQVRfTlY2MSwKKwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJ
RF9ZVjE2Q0ksCisJCS5zd2FwCQk9IHRydWUsCisJCS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNfODg4
LAorCX0sIHsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFUX0JHUjg4OCwKKwkJLmJ1Zl9mbXQJPSBa
WU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9SR0I4ODgsCisJCS5zd2FwCQk9IGZhbHNlLAor
CQkuc2YJCT0gc2NhbGluZ19mYWN0b3JzXzg4OCwKKwl9LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZP
Uk1BVF9SR0I4ODgsCisJCS5idWZfZm10CT0gWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURf
UkdCODg4LAorCQkuc3dhcAkJPSB0cnVlLAorCQkuc2YJCT0gc2NhbGluZ19mYWN0b3JzXzg4OCwK
Kwl9LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9YQkdSODg4OCwKKwkJLmJ1Zl9mbXQJPSBa
WU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9SR0JBODg4MCwKKwkJLnN3YXAJCT0gZmFsc2Us
CisJCS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNfODg4LAorCX0sIHsKKwkJLmRybV9mbXQJPSBEUk1f
Rk9STUFUX1hSR0I4ODg4LAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxf
VklEX1JHQkE4ODgwLAorCQkuc3dhcAkJPSB0cnVlLAorCQkuc2YJCT0gc2NhbGluZ19mYWN0b3Jz
Xzg4OCwKKwl9LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9YQkdSMjEwMTAxMCwKKwkJLmJ1
Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9SR0I4ODhfMTAsCisJCS5zd2Fw
CQk9IGZhbHNlLAorCQkuc2YJCT0gc2NhbGluZ19mYWN0b3JzXzEwMTAxMCwKKwl9LCB7CisJCS5k
cm1fZm10CT0gRFJNX0ZPUk1BVF9YUkdCMjEwMTAxMCwKKwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElT
UF9BVl9CVUZfRk1UX05MX1ZJRF9SR0I4ODhfMTAsCisJCS5zd2FwCQk9IHRydWUsCisJCS5zZgkJ
PSBzY2FsaW5nX2ZhY3RvcnNfMTAxMDEwLAorCX0sIHsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFU
X1lVVjQyMCwKKwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9ZVjE2
XzQyMCwKKwkJLnN3YXAJCT0gZmFsc2UsCisJCS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNfODg4LAor
CX0sIHsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFUX1lWVTQyMCwKKwkJLmJ1Zl9mbXQJPSBaWU5R
TVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9ZVjE2XzQyMCwKKwkJLnN3YXAJCT0gdHJ1ZSwKKwkJ
LnNmCQk9IHNjYWxpbmdfZmFjdG9yc184ODgsCisJfSwgeworCQkuZHJtX2ZtdAk9IERSTV9GT1JN
QVRfTlYxMiwKKwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9ZVjE2
Q0lfNDIwLAorCQkuc3dhcAkJPSBmYWxzZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc184ODgs
CisJfSwgeworCQkuZHJtX2ZtdAk9IERSTV9GT1JNQVRfTlYyMSwKKwkJLmJ1Zl9mbXQJPSBaWU5R
TVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9ZVjE2Q0lfNDIwLAorCQkuc3dhcAkJPSB0cnVlLAor
CQkuc2YJCT0gc2NhbGluZ19mYWN0b3JzXzg4OCwKKwl9LAorfTsKKworLyogTGlzdCBvZiBncmFw
aGljcyBsYXllciBmb3JtYXRzICovCitzdGF0aWMgY29uc3Qgc3RydWN0IHp5bnFtcF9kaXNwX2Zv
cm1hdCBhdmJ1Zl9nZnhfZm10c1tdID0geworCXsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFUX0FC
R1I4ODg4LAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfR0ZYX1JHQkE4
ODg4LAorCQkuc3dhcAkJPSBmYWxzZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc184ODgsCisJ
fSwgeworCQkuZHJtX2ZtdAk9IERSTV9GT1JNQVRfQVJHQjg4ODgsCisJCS5idWZfZm10CT0gWllO
UU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9HRlhfUkdCQTg4ODgsCisJCS5zd2FwCQk9IHRydWUsCisJ
CS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNfODg4LAorCX0sIHsKKwkJLmRybV9mbXQJPSBEUk1fRk9S
TUFUX1JHQkE4ODg4LAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfR0ZY
X0FCR1I4ODg4LAorCQkuc3dhcAkJPSBmYWxzZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc184
ODgsCisJfSwgeworCQkuZHJtX2ZtdAk9IERSTV9GT1JNQVRfQkdSQTg4ODgsCisJCS5idWZfZm10
CT0gWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9HRlhfQUJHUjg4ODgsCisJCS5zd2FwCQk9IHRy
dWUsCisJCS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNfODg4LAorCX0sIHsKKwkJLmRybV9mbXQJPSBE
Uk1fRk9STUFUX0JHUjg4OCwKKwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05M
X0dGWF9SR0I4ODgsCisJCS5zd2FwCQk9IGZhbHNlLAorCQkuc2YJCT0gc2NhbGluZ19mYWN0b3Jz
Xzg4OCwKKwl9LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9SR0I4ODgsCisJCS5idWZfZm10
CT0gWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9HRlhfQkdSODg4LAorCQkuc3dhcAkJPSBmYWxz
ZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc184ODgsCisJfSwgeworCQkuZHJtX2ZtdAk9IERS
TV9GT1JNQVRfUkdCQTU1NTEsCisJCS5idWZfZm10CT0gWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9O
TF9HRlhfUkdCQTU1NTEsCisJCS5zd2FwCQk9IGZhbHNlLAorCQkuc2YJCT0gc2NhbGluZ19mYWN0
b3JzXzU1NSwKKwl9LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9CR1JBNTU1MSwKKwkJLmJ1
Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX0dGWF9SR0JBNTU1MSwKKwkJLnN3YXAJ
CT0gdHJ1ZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc181NTUsCisJfSwgeworCQkuZHJtX2Zt
dAk9IERSTV9GT1JNQVRfUkdCQTQ0NDQsCisJCS5idWZfZm10CT0gWllOUU1QX0RJU1BfQVZfQlVG
X0ZNVF9OTF9HRlhfUkdCQTQ0NDQsCisJCS5zd2FwCQk9IGZhbHNlLAorCQkuc2YJCT0gc2NhbGlu
Z19mYWN0b3JzXzQ0NCwKKwl9LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9CR1JBNDQ0NCwK
KwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX0dGWF9SR0JBNDQ0NCwKKwkJ
LnN3YXAJCT0gdHJ1ZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc180NDQsCisJfSwgeworCQku
ZHJtX2ZtdAk9IERSTV9GT1JNQVRfUkdCNTY1LAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FW
X0JVRl9GTVRfTkxfR0ZYX1JHQjU2NSwKKwkJLnN3YXAJCT0gZmFsc2UsCisJCS5zZgkJPSBzY2Fs
aW5nX2ZhY3RvcnNfNTY1LAorCX0sIHsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFUX0JHUjU2NSwK
KwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX0dGWF9SR0I1NjUsCisJCS5z
d2FwCQk9IHRydWUsCisJCS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNfNTY1LAorCX0sCit9OworCitz
dGF0aWMgdTMyIHp5bnFtcF9kaXNwX2F2YnVmX3JlYWQoc3RydWN0IHp5bnFtcF9kaXNwX2F2YnVm
ICphdmJ1ZiwgaW50IHJlZykKK3sKKwlyZXR1cm4gcmVhZGwoYXZidWYtPmJhc2UgKyByZWcpOwor
fQorCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9hdmJ1Zl93cml0ZShzdHJ1Y3QgenlucW1wX2Rp
c3BfYXZidWYgKmF2YnVmLAorCQkJCSAgICBpbnQgcmVnLCB1MzIgdmFsKQoreworCXdyaXRlbCh2
YWwsIGF2YnVmLT5iYXNlICsgcmVnKTsKK30KKworLyoqCisgKiB6eW5xbXBfZGlzcF9hdmJ1Zl9z
ZXRfZm9ybWF0IC0gU2V0IHRoZSBpbnB1dCBmb3JtYXQgZm9yIGEgbGF5ZXIKKyAqIEBhdmJ1Zjog
QXVkaW8vdmlkZW8gYnVmZmVyIG1hbmFnZXIKKyAqIEBsYXllcjogVGhlIGxheWVyIElECisgKiBA
Zm10OiBUaGUgZm9ybWF0IGluZm9ybWF0aW9uCisgKgorICogU2V0IHRoZSB2aWRlbyBidWZmZXIg
bWFuYWdlciBmb3JtYXQgZm9yIEBsYXllciB0byBAZm10LgorICovCitzdGF0aWMgdm9pZCB6eW5x
bXBfZGlzcF9hdmJ1Zl9zZXRfZm9ybWF0KHN0cnVjdCB6eW5xbXBfZGlzcF9hdmJ1ZiAqYXZidWYs
CisJCQkJCSBlbnVtIHp5bnFtcF9kaXNwX2xheWVyX2lkIGxheWVyLAorCQkJCQkgY29uc3Qgc3Ry
dWN0IHp5bnFtcF9kaXNwX2Zvcm1hdCAqZm10KQoreworCXVuc2lnbmVkIGludCBpOworCXUzMiB2
YWw7CisKKwl2YWwgPSB6eW5xbXBfZGlzcF9hdmJ1Zl9yZWFkKGF2YnVmLCBaWU5RTVBfRElTUF9B
Vl9CVUZfRk1UKTsKKwl2YWwgJj0gbGF5ZXIgPT0gWllOUU1QX0RJU1BfTEFZRVJfVklECisJICAg
ID8gflpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX01BU0sKKwkgICAgOiB+WllOUU1QX0RJ
U1BfQVZfQlVGX0ZNVF9OTF9HRlhfTUFTSzsKKwl2YWwgfD0gZm10LT5idWZfZm10OworCXp5bnFt
cF9kaXNwX2F2YnVmX3dyaXRlKGF2YnVmLCBaWU5RTVBfRElTUF9BVl9CVUZfRk1ULCB2YWwpOwor
CisJZm9yIChpID0gMDsgaSA8IFpZTlFNUF9ESVNQX0FWX0JVRl9OVU1fU0Y7IGkrKykgeworCQl1
bnNpZ25lZCBpbnQgcmVnID0gbGF5ZXIgPT0gWllOUU1QX0RJU1BfTEFZRVJfVklECisJCQkJID8g
WllOUU1QX0RJU1BfQVZfQlVGX1ZJRF9DT01QX1NGKGkpCisJCQkJIDogWllOUU1QX0RJU1BfQVZf
QlVGX0dGWF9DT01QX1NGKGkpOworCisJCXp5bnFtcF9kaXNwX2F2YnVmX3dyaXRlKGF2YnVmLCBy
ZWcsIGZtdC0+c2ZbaV0pOworCX0KK30KKworLyoqCisgKiB6eW5xbXBfZGlzcF9hdmJ1Zl9zZXRf
Y2xvY2tzX3NvdXJjZXMgLSBTZXQgdGhlIGNsb2NrcyBzb3VyY2VzCisgKiBAYXZidWY6IEF1ZGlv
L3ZpZGVvIGJ1ZmZlciBtYW5hZ2VyCisgKiBAdmlkZW9fZnJvbV9wczogVHJ1ZSBpZiB0aGUgdmlk
ZW8gY2xvY2sgb3JpZ2luYXRlcyBmcm9tIHRoZSBQUworICogQGF1ZGlvX2Zyb21fcHM6IFRydWUg
aWYgdGhlIGF1ZGlvIGNsb2NrIG9yaWdpbmF0ZXMgZnJvbSB0aGUgUFMKKyAqIEB0aW1pbmdzX2lu
dGVybmFsOiBUcnVlIGlmIHZpZGVvIHRpbWluZ3MgYXJlIGdlbmVyYXRlZCBpbnRlcm5hbGx5Cisg
KgorICogU2V0IHRoZSBzb3VyY2UgZm9yIHRoZSB2aWRlbyBhbmQgYXVkaW8gY2xvY2tzLCBhcyB3
ZWxsIGFzIGZvciB0aGUgdmlkZW8KKyAqIHRpbWluZ3MuIENsb2NrcyBjYW4gb3JpZ2luYXRlIGZy
b20gdGhlIFBTIG9yIFBMLCBhbmQgdGltaW5ncyBjYW4gYmUKKyAqIGdlbmVyYXRlZCBpbnRlcm5h
bGx5IG9yIGV4dGVybmFsbHkuCisgKi8KK3N0YXRpYyB2b2lkCit6eW5xbXBfZGlzcF9hdmJ1Zl9z
ZXRfY2xvY2tzX3NvdXJjZXMoc3RydWN0IHp5bnFtcF9kaXNwX2F2YnVmICphdmJ1ZiwKKwkJCQkg
ICAgIGJvb2wgdmlkZW9fZnJvbV9wcywgYm9vbCBhdWRpb19mcm9tX3BzLAorCQkJCSAgICAgYm9v
bCB0aW1pbmdzX2ludGVybmFsKQoreworCXUzMiB2YWwgPSAwOworCisJaWYgKHZpZGVvX2Zyb21f
cHMpCisJCXZhbCB8PSBaWU5RTVBfRElTUF9BVl9CVUZfQ0xLX1NSQ19WSURfRlJPTV9QUzsKKwlp
ZiAoYXVkaW9fZnJvbV9wcykKKwkJdmFsIHw9IFpZTlFNUF9ESVNQX0FWX0JVRl9DTEtfU1JDX0FV
RF9GUk9NX1BTOworCWlmICh0aW1pbmdzX2ludGVybmFsKQorCQl2YWwgfD0gWllOUU1QX0RJU1Bf
QVZfQlVGX0NMS19TUkNfVklEX0lOVEVSTkFMX1RJTUlORzsKKworCXp5bnFtcF9kaXNwX2F2YnVm
X3dyaXRlKGF2YnVmLCBaWU5RTVBfRElTUF9BVl9CVUZfQ0xLX1NSQywgdmFsKTsKK30KKworLyoq
CisgKiB6eW5xbXBfZGlzcF9hdmJ1Zl9lbmFibGVfY2hhbm5lbHMgLSBFbmFibGUgYnVmZmVyIGNo
YW5uZWxzCisgKiBAYXZidWY6IEF1ZGlvL3ZpZGVvIGJ1ZmZlciBtYW5hZ2VyCisgKgorICogRW5h
YmxlIGFsbCAodmlkZW8gYW5kIGF1ZGlvKSBidWZmZXIgY2hhbm5lbHMuCisgKi8KK3N0YXRpYyB2
b2lkIHp5bnFtcF9kaXNwX2F2YnVmX2VuYWJsZV9jaGFubmVscyhzdHJ1Y3QgenlucW1wX2Rpc3Bf
YXZidWYgKmF2YnVmKQoreworCXVuc2lnbmVkIGludCBpOworCXUzMiB2YWw7CisKKwl2YWwgPSBa
WU5RTVBfRElTUF9BVl9CVUZfQ0hCVUZfRU4KKwkgICAgfCAoWllOUU1QX0RJU1BfQVZfQlVGX0NI
QlVGX0JVUlNUX0xFTl9NQVggPDwKKwkgICAgICAgWllOUU1QX0RJU1BfQVZfQlVGX0NIQlVGX0JV
UlNUX0xFTl9TSElGVCk7CisKKwlmb3IgKGkgPSAwOyBpIDwgWllOUU1QX0RJU1BfQVZfQlVGX05V
TV9WSURfR0ZYX0JVRkZFUlM7IGkrKykKKwkJenlucW1wX2Rpc3BfYXZidWZfd3JpdGUoYXZidWYs
IFpZTlFNUF9ESVNQX0FWX0JVRl9DSEJVRihpKSwKKwkJCQkJdmFsKTsKKworCXZhbCA9IFpZTlFN
UF9ESVNQX0FWX0JVRl9DSEJVRl9FTgorCSAgICB8IChaWU5RTVBfRElTUF9BVl9CVUZfQ0hCVUZf
QlVSU1RfTEVOX0FVRF9NQVggPDwKKwkgICAgICAgWllOUU1QX0RJU1BfQVZfQlVGX0NIQlVGX0JV
UlNUX0xFTl9TSElGVCk7CisKKwlmb3IgKDsgaSA8IFpZTlFNUF9ESVNQX0FWX0JVRl9OVU1fQlVG
RkVSUzsgaSsrKQorCQl6eW5xbXBfZGlzcF9hdmJ1Zl93cml0ZShhdmJ1ZiwgWllOUU1QX0RJU1Bf
QVZfQlVGX0NIQlVGKGkpLAorCQkJCQl2YWwpOworfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2F2
YnVmX2Rpc2FibGVfY2hhbm5lbHMgLSBEaXNhYmxlIGJ1ZmZlciBjaGFubmVscworICogQGF2YnVm
OiBBdWRpby92aWRlbyBidWZmZXIgbWFuYWdlcgorICoKKyAqIERpc2FibGUgYWxsICh2aWRlbyBh
bmQgYXVkaW8pIGJ1ZmZlciBjaGFubmVscy4KKyAqLworc3RhdGljIHZvaWQgenlucW1wX2Rpc3Bf
YXZidWZfZGlzYWJsZV9jaGFubmVscyhzdHJ1Y3QgenlucW1wX2Rpc3BfYXZidWYgKmF2YnVmKQor
eworCXVuc2lnbmVkIGludCBpOworCisJZm9yIChpID0gMDsgaSA8IFpZTlFNUF9ESVNQX0FWX0JV
Rl9OVU1fQlVGRkVSUzsgaSsrKQorCQl6eW5xbXBfZGlzcF9hdmJ1Zl93cml0ZShhdmJ1ZiwgWllO
UU1QX0RJU1BfQVZfQlVGX0NIQlVGKGkpLAorCQkJCQlaWU5RTVBfRElTUF9BVl9CVUZfQ0hCVUZf
RkxVU0gpOworfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2F2YnVmX2VuYWJsZV9hdWRpbyAtIEVu
YWJsZSBhdWRpbworICogQGF2YnVmOiBBdWRpby92aWRlbyBidWZmZXIgbWFuYWdlcgorICoKKyAq
IEVuYWJsZSBhbGwgYXVkaW8gYnVmZmVycyB3aXRoIGEgbm9uLWxpdmUgKG1lbW9yeSkgc291cmNl
LgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9hdmJ1Zl9lbmFibGVfYXVkaW8oc3RydWN0
IHp5bnFtcF9kaXNwX2F2YnVmICphdmJ1ZikKK3sKKwl1MzIgdmFsOworCisJdmFsID0genlucW1w
X2Rpc3BfYXZidWZfcmVhZChhdmJ1ZiwgWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVCk7CisJdmFs
ICY9IH5aWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVUX0FVRDFfTUFTSzsKKwl2YWwgfD0gWllOUU1Q
X0RJU1BfQVZfQlVGX09VVFBVVF9BVUQxX01FTTsKKwl2YWwgfD0gWllOUU1QX0RJU1BfQVZfQlVG
X09VVFBVVF9BVUQyX0VOOworCXp5bnFtcF9kaXNwX2F2YnVmX3dyaXRlKGF2YnVmLCBaWU5RTVBf
RElTUF9BVl9CVUZfT1VUUFVULCB2YWwpOworfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2F2YnVm
X2Rpc2FibGVfYXVkaW8gLSBEaXNhYmxlIGF1ZGlvCisgKiBAYXZidWY6IEF1ZGlvL3ZpZGVvIGJ1
ZmZlciBtYW5hZ2VyCisgKgorICogRGlzYWJsZSBhbGwgYXVkaW8gYnVmZmVycy4KKyAqLworc3Rh
dGljIHZvaWQgenlucW1wX2Rpc3BfYXZidWZfZGlzYWJsZV9hdWRpbyhzdHJ1Y3QgenlucW1wX2Rp
c3BfYXZidWYgKmF2YnVmKQoreworCXUzMiB2YWw7CisKKwl2YWwgPSB6eW5xbXBfZGlzcF9hdmJ1
Zl9yZWFkKGF2YnVmLCBaWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVUKTsKKwl2YWwgJj0gflpZTlFN
UF9ESVNQX0FWX0JVRl9PVVRQVVRfQVVEMV9NQVNLOworCXZhbCB8PSBaWU5RTVBfRElTUF9BVl9C
VUZfT1VUUFVUX0FVRDFfRElTQUJMRTsKKwl2YWwgJj0gflpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQ
VVRfQVVEMl9FTjsKKwl6eW5xbXBfZGlzcF9hdmJ1Zl93cml0ZShhdmJ1ZiwgWllOUU1QX0RJU1Bf
QVZfQlVGX09VVFBVVCwgdmFsKTsKK30KKworLyoqCisgKiB6eW5xbXBfZGlzcF9hdmJ1Zl9lbmFi
bGVfdmlkZW8gLSBFbmFibGUgYSB2aWRlbyBsYXllcgorICogQGF2YnVmOiBBdWRpby92aWRlbyBi
dWZmZXIgbWFuYWdlcgorICogQGxheWVyOiBUaGUgbGF5ZXIgSUQKKyAqIEBtb2RlOiBPcGVyYXRp
bmcgbW9kZSBvZiBsYXllcgorICoKKyAqIEVuYWJsZSB0aGUgdmlkZW8vZ3JhcGhpY3MgYnVmZmVy
IGZvciBAbGF5ZXIuCisgKi8KK3N0YXRpYyB2b2lkIHp5bnFtcF9kaXNwX2F2YnVmX2VuYWJsZV92
aWRlbyhzdHJ1Y3QgenlucW1wX2Rpc3BfYXZidWYgKmF2YnVmLAorCQkJCQkgICBlbnVtIHp5bnFt
cF9kaXNwX2xheWVyX2lkIGxheWVyLAorCQkJCQkgICBlbnVtIHp5bnFtcF9kaXNwX2xheWVyX21v
ZGUgbW9kZSkKK3sKKwl1MzIgdmFsOworCisJdmFsID0genlucW1wX2Rpc3BfYXZidWZfcmVhZChh
dmJ1ZiwgWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVCk7CisJaWYgKGxheWVyID09IFpZTlFNUF9E
SVNQX0xBWUVSX1ZJRCkgeworCQl2YWwgJj0gflpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfVklE
MV9NQVNLOworCQlpZiAobW9kZSA9PSBaWU5RTVBfRElTUF9MQVlFUl9OT05MSVZFKQorCQkJdmFs
IHw9IFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfVklEMV9NRU07CisJCWVsc2UKKwkJCXZhbCB8
PSBaWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVUX1ZJRDFfTElWRTsKKwl9IGVsc2UgeworCQl2YWwg
Jj0gflpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfVklEMl9NQVNLOworCQl2YWwgfD0gWllOUU1Q
X0RJU1BfQVZfQlVGX09VVFBVVF9WSUQyX01FTTsKKwkJaWYgKG1vZGUgPT0gWllOUU1QX0RJU1Bf
TEFZRVJfTk9OTElWRSkKKwkJCXZhbCB8PSBaWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVUX1ZJRDJf
TUVNOworCQllbHNlCisJCQl2YWwgfD0gWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9WSUQyX0xJ
VkU7CisJfQorCXp5bnFtcF9kaXNwX2F2YnVmX3dyaXRlKGF2YnVmLCBaWU5RTVBfRElTUF9BVl9C
VUZfT1VUUFVULCB2YWwpOworfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2F2YnVmX2Rpc2FibGVf
dmlkZW8gLSBEaXNhYmxlIGEgdmlkZW8gbGF5ZXIKKyAqIEBhdmJ1ZjogQXVkaW8vdmlkZW8gYnVm
ZmVyIG1hbmFnZXIKKyAqIEBsYXllcjogVGhlIGxheWVyIElECisgKgorICogRGlzYWJsZSB0aGUg
dmlkZW8vZ3JhcGhpY3MgYnVmZmVyIGZvciBAbGF5ZXIuCisgKi8KK3N0YXRpYyB2b2lkIHp5bnFt
cF9kaXNwX2F2YnVmX2Rpc2FibGVfdmlkZW8oc3RydWN0IHp5bnFtcF9kaXNwX2F2YnVmICphdmJ1
ZiwKKwkJCQkJICAgIGVudW0genlucW1wX2Rpc3BfbGF5ZXJfaWQgbGF5ZXIpCit7CisJdTMyIHZh
bDsKKworCXZhbCA9IHp5bnFtcF9kaXNwX2F2YnVmX3JlYWQoYXZidWYsIFpZTlFNUF9ESVNQX0FW
X0JVRl9PVVRQVVQpOworCWlmIChsYXllciA9PSBaWU5RTVBfRElTUF9MQVlFUl9WSUQpIHsKKwkJ
dmFsICY9IH5aWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVUX1ZJRDFfTUFTSzsKKwkJdmFsIHw9IFpZ
TlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfVklEMV9OT05FOworCX0gZWxzZSB7CisJCXZhbCAmPSB+
WllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9WSUQyX01BU0s7CisJCXZhbCB8PSBaWU5RTVBfRElT
UF9BVl9CVUZfT1VUUFVUX1ZJRDJfRElTQUJMRTsKKwl9CisJenlucW1wX2Rpc3BfYXZidWZfd3Jp
dGUoYXZidWYsIFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVQsIHZhbCk7Cit9CisKKy8qKgorICog
enlucW1wX2Rpc3BfYXZidWZfZW5hYmxlIC0gRW5hYmxlIHRoZSB2aWRlbyBwaXBlCisgKiBAYXZi
dWY6IEF1ZGlvL3ZpZGVvIGJ1ZmZlciBtYW5hZ2VyCisgKgorICogRGUtYXNzZXJ0IHRoZSB2aWRl
byBwaXBlIHJlc2V0LgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9hdmJ1Zl9lbmFibGUo
c3RydWN0IHp5bnFtcF9kaXNwX2F2YnVmICphdmJ1ZikKK3sKKwl6eW5xbXBfZGlzcF9hdmJ1Zl93
cml0ZShhdmJ1ZiwgWllOUU1QX0RJU1BfQVZfQlVGX1NSU1RfUkVHLCAwKTsKK30KKworLyoqCisg
KiB6eW5xbXBfZGlzcF9hdmJ1Zl9kaXNhYmxlIC0gRGlzYWJsZSB0aGUgdmlkZW8gcGlwZQorICog
QGF2YnVmOiBBdWRpby92aWRlbyBidWZmZXIgbWFuYWdlcgorICoKKyAqIEFzc2VydCB0aGUgdmlk
ZW8gcGlwZSByZXNldC4KKyAqLworc3RhdGljIHZvaWQgenlucW1wX2Rpc3BfYXZidWZfZGlzYWJs
ZShzdHJ1Y3QgenlucW1wX2Rpc3BfYXZidWYgKmF2YnVmKQoreworCXp5bnFtcF9kaXNwX2F2YnVm
X3dyaXRlKGF2YnVmLCBaWU5RTVBfRElTUF9BVl9CVUZfU1JTVF9SRUcsCisJCQkJWllOUU1QX0RJ
U1BfQVZfQlVGX1NSU1RfUkVHX1ZJRF9SU1QpOworfQorCisvKiAtLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LQorICogQmxlbmRlciAoVmlkZW8gUGlwZWxpbmUpCisgKi8KKworc3RhdGljIHZvaWQgenlucW1w
X2Rpc3BfYmxlbmRfd3JpdGUoc3RydWN0IHp5bnFtcF9kaXNwX2JsZW5kICpibGVuZCwKKwkJCQkg
ICAgaW50IHJlZywgdTMyIHZhbCkKK3sKKwl3cml0ZWwodmFsLCBibGVuZC0+YmFzZSArIHJlZyk7
Cit9CisKKy8qCisgKiBDb2xvcnNwYWNlIGNvbnZlcnNpb24gbWF0cmljZXMuCisgKgorICogSGFy
ZGNvZGUgUkdCIDwtPiBZVVYgY29udmVyc2lvbiB0byBmdWxsLXJhbmdlIFNEVFYgZm9yIG5vdy4K
KyAqLworc3RhdGljIGNvbnN0IHUxNiBjc2NfemVyb19tYXRyaXhbXSA9IHsKKwkweDAsICAgIDB4
MCwgICAgMHgwLAorCTB4MCwgICAgMHgwLCAgICAweDAsCisJMHgwLCAgICAweDAsICAgIDB4MAor
fTsKKworc3RhdGljIGNvbnN0IHUxNiBjc2NfaWRlbnRpdHlfbWF0cml4W10gPSB7CisJMHgxMDAw
LCAweDAsICAgIDB4MCwKKwkweDAsICAgIDB4MTAwMCwgMHgwLAorCTB4MCwgICAgMHgwLCAgICAw
eDEwMDAKK307CisKK3N0YXRpYyBjb25zdCB1MzIgY3NjX3plcm9fb2Zmc2V0c1tdID0geworCTAs
IDAsIDAKK307CisKK3N0YXRpYyBjb25zdCB1MTYgY3NjX3JnYl90b19zZHR2X21hdHJpeFtdID0g
eworCTB4NGM5LCAgMHg4NjQsICAweDFkMywKKwkweDdkNGQsIDB4N2FiMywgMHg4MDAsCisJMHg4
MDAsICAweDc5NGQsIDB4N2ViMworfTsKKworc3RhdGljIGNvbnN0IHUzMiBjc2NfcmdiX3RvX3Nk
dHZfb2Zmc2V0c1tdID0geworCTB4MCwgMHg4MDAwMDAwLCAweDgwMDAwMDAKK307CisKK3N0YXRp
YyBjb25zdCB1MTYgY3NjX3NkdHZfdG9fcmdiX21hdHJpeFtdID0geworCTB4MTAwMCwgMHgxNjZm
LCAweDAsCisJMHgxMDAwLCAweDc0ODMsIDB4N2E3ZiwKKwkweDEwMDAsIDB4MCwgICAgMHgxYzVh
Cit9OworCitzdGF0aWMgY29uc3QgdTMyIGNzY19zZHR2X3RvX3JnYl9vZmZzZXRzW10gPSB7CisJ
MHgwLCAweDE4MDAsIDB4MTgwMAorfTsKKworLyoqCisgKiB6eW5xbXBfZGlzcF9ibGVuZF9zZXRf
b3V0cHV0X2Zvcm1hdCAtIFNldCB0aGUgb3V0cHV0IGZvcm1hdCBvZiB0aGUgYmxlbmRlcgorICog
QGJsZW5kOiBCbGVuZGVyIG9iamVjdAorICogQGZvcm1hdDogT3V0cHV0IGZvcm1hdAorICoKKyAq
IFNldCB0aGUgb3V0cHV0IGZvcm1hdCBvZiB0aGUgYmxlbmRlciB0byBAZm9ybWF0LgorICovCitz
dGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9ibGVuZF9zZXRfb3V0cHV0X2Zvcm1hdChzdHJ1Y3Qgenlu
cW1wX2Rpc3BfYmxlbmQgKmJsZW5kLAorCQkJCQkJZW51bSB6eW5xbXBfZHBzdWJfZm9ybWF0IGZv
cm1hdCkKK3sKKwlzdGF0aWMgY29uc3QgdW5zaWduZWQgaW50IGJsZW5kX291dHB1dF9mbXRzW10g
PSB7CisJCVtaWU5RTVBfRFBTVUJfRk9STUFUX1JHQl0gPSBaWU5RTVBfRElTUF9WX0JMRU5EX09V
VFBVVF9WSURfRk1UX1JHQiwKKwkJW1pZTlFNUF9EUFNVQl9GT1JNQVRfWUNSQ0I0NDRdID0gWllO
UU1QX0RJU1BfVl9CTEVORF9PVVRQVVRfVklEX0ZNVF9ZQ0JDUjQ0NCwKKwkJW1pZTlFNUF9EUFNV
Ql9GT1JNQVRfWUNSQ0I0MjJdID0gWllOUU1QX0RJU1BfVl9CTEVORF9PVVRQVVRfVklEX0ZNVF9Z
Q0JDUjQyMgorCQkJCQkgICAgICAgfCBaWU5RTVBfRElTUF9WX0JMRU5EX09VVFBVVF9WSURfRk1U
X0VOX0RPV05TQU1QTEUsCisJCVtaWU5RTVBfRFBTVUJfRk9STUFUX1lPTkxZXSA9IFpZTlFNUF9E
SVNQX1ZfQkxFTkRfT1VUUFVUX1ZJRF9GTVRfWU9OTFksCisJfTsKKworCXUzMiBmbXQgPSBibGVu
ZF9vdXRwdXRfZm10c1tmb3JtYXRdOworCWNvbnN0IHUxNiAqY29lZmZzOworCWNvbnN0IHUzMiAq
b2Zmc2V0czsKKwl1bnNpZ25lZCBpbnQgaTsKKworCXp5bnFtcF9kaXNwX2JsZW5kX3dyaXRlKGJs
ZW5kLCBaWU5RTVBfRElTUF9WX0JMRU5EX09VVFBVVF9WSURfRk1ULCBmbXQpOworCWlmIChmbXQg
PT0gWllOUU1QX0RJU1BfVl9CTEVORF9PVVRQVVRfVklEX0ZNVF9SR0IpIHsKKwkJY29lZmZzID0g
Y3NjX2lkZW50aXR5X21hdHJpeDsKKwkJb2Zmc2V0cyA9IGNzY196ZXJvX29mZnNldHM7CisJfSBl
bHNlIHsKKwkJY29lZmZzID0gY3NjX3JnYl90b19zZHR2X21hdHJpeDsKKwkJb2Zmc2V0cyA9IGNz
Y19yZ2JfdG9fc2R0dl9vZmZzZXRzOworCX0KKworCWZvciAoaSA9IDA7IGkgPCBaWU5RTVBfRElT
UF9WX0JMRU5EX05VTV9DT0VGRjsgaSsrKQorCQl6eW5xbXBfZGlzcF9ibGVuZF93cml0ZShibGVu
ZCwKKwkJCQkJWllOUU1QX0RJU1BfVl9CTEVORF9SR0IyWUNCQ1JfQ09FRkYoaSksCisJCQkJCWNv
ZWZmc1tpXSk7CisKKwlmb3IgKGkgPSAwOyBpIDwgWllOUU1QX0RJU1BfVl9CTEVORF9OVU1fT0ZG
U0VUOyBpKyspCisJCXp5bnFtcF9kaXNwX2JsZW5kX3dyaXRlKGJsZW5kLAorCQkJCQlaWU5RTVBf
RElTUF9WX0JMRU5EX09VVENTQ19PRkZTRVQoaSksCisJCQkJCW9mZnNldHNbaV0pOworfQorCisv
KioKKyAqIHp5bnFtcF9kaXNwX2JsZW5kX3NldF9iZ19jb2xvciAtIFNldCB0aGUgYmFja2dyb3Vu
ZCBjb2xvcgorICogQGJsZW5kOiBCbGVuZGVyIG9iamVjdAorICogQHJjcjogUmVkL0NyIGNvbG9y
IGNvbXBvbmVudAorICogQGd5OiBHcmVlbi9ZIGNvbG9yIGNvbXBvbmVudAorICogQGJjYjogQmx1
ZS9DYiBjb2xvciBjb21wb25lbnQKKyAqCisgKiBTZXQgdGhlIGJhY2tncm91bmQgY29sb3IgdG8g
KEByY3IsIEBneSwgQGJjYiksIGNvcnJlc3BvbmRpbmcgdG8gdGhlIFIsIEcgYW5kCisgKiBCIG9y
IENyLCBZIGFuZCBDYiBjb21wb25lbnRzIHJlc3BlY3RpdmVseSBkZXBlbmRpbmcgb24gdGhlIHNl
bGVjdGVkIG91dHB1dAorICogZm9ybWF0LgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9i
bGVuZF9zZXRfYmdfY29sb3Ioc3RydWN0IHp5bnFtcF9kaXNwX2JsZW5kICpibGVuZCwKKwkJCQkJ
ICAgdTMyIHJjciwgdTMyIGd5LCB1MzIgYmNiKQoreworCXp5bnFtcF9kaXNwX2JsZW5kX3dyaXRl
KGJsZW5kLCBaWU5RTVBfRElTUF9WX0JMRU5EX0JHX0NMUl8wLCByY3IpOworCXp5bnFtcF9kaXNw
X2JsZW5kX3dyaXRlKGJsZW5kLCBaWU5RTVBfRElTUF9WX0JMRU5EX0JHX0NMUl8xLCBneSk7CisJ
enlucW1wX2Rpc3BfYmxlbmRfd3JpdGUoYmxlbmQsIFpZTlFNUF9ESVNQX1ZfQkxFTkRfQkdfQ0xS
XzIsIGJjYik7Cit9CisKKy8qKgorICogenlucW1wX2Rpc3BfYmxlbmRfc2V0X2dsb2JhbF9hbHBo
YSAtIENvbmZpZ3VyZSBnbG9iYWwgYWxwaGEgYmxlbmRpbmcKKyAqIEBibGVuZDogQmxlbmRlciBv
YmplY3QKKyAqIEBlbmFibGU6IFRydWUgdG8gZW5hYmxlIGdsb2JhbCBhbHBoYSBibGVuZGluZwor
ICogQGFscGhhOiBHbG9iYWwgYWxwaGEgdmFsdWUgKGlnbm9yZWQgaWYgQGVuYWJsZWQgaXMgZmFs
c2UpCisgKi8KK3N0YXRpYyB2b2lkIHp5bnFtcF9kaXNwX2JsZW5kX3NldF9nbG9iYWxfYWxwaGEo
c3RydWN0IHp5bnFtcF9kaXNwX2JsZW5kICpibGVuZCwKKwkJCQkJICAgICAgIGJvb2wgZW5hYmxl
LCB1MzIgYWxwaGEpCit7CisJenlucW1wX2Rpc3BfYmxlbmRfd3JpdGUoYmxlbmQsIFpZTlFNUF9E
SVNQX1ZfQkxFTkRfU0VUX0dMT0JBTF9BTFBIQSwKKwkJCQlaWU5RTVBfRElTUF9WX0JMRU5EX1NF
VF9HTE9CQUxfQUxQSEFfVkFMVUUoYWxwaGEpIHwKKwkJCQkoZW5hYmxlID8gWllOUU1QX0RJU1Bf
Vl9CTEVORF9TRVRfR0xPQkFMX0FMUEhBX0VOIDogMCkpOworfQorCisvKioKKyAqIHp5bnFtcF9k
aXNwX2JsZW5kX2xheWVyX3NldF9jc2MgLSBDb25maWd1cmUgY29sb3JzcGFjZSBjb252ZXJzaW9u
IGZvciBsYXllcgorICogQGJsZW5kOiBCbGVuZGVyIG9iamVjdAorICogQGxheWVyOiBUaGUgbGF5
ZXIKKyAqIEBjb2VmZnM6IENvbG9yc3BhY2UgY29udmVyc2lvbiBtYXRyaXgKKyAqIEBvZmZzZXRz
OiBDb2xvcnNwYWNlIGNvbnZlcnNpb24gb2Zmc2V0cworICoKKyAqIENvbmZpZ3VyZSB0aGUgaW5w
dXQgY29sb3JzcGFjZSBjb252ZXJzaW9uIG1hdHJpeCBhbmQgb2Zmc2V0cyBmb3IgdGhlIEBsYXll
ci4KKyAqIENvbHVtbnMgb2YgdGhlIG1hdHJpeCBhcmUgYXV0b21hdGljYWxseSBzd2FwcGVkIGJh
c2VkIG9uIHRoZSBpbnB1dCBmb3JtYXQgdG8KKyAqIGhhbmRsZSBSR0IgYW5kIFlDckNiIGNvbXBv
bmVudHMgcGVybXV0YXRpb25zLgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9ibGVuZF9s
YXllcl9zZXRfY3NjKHN0cnVjdCB6eW5xbXBfZGlzcF9ibGVuZCAqYmxlbmQsCisJCQkJCSAgICBz
dHJ1Y3QgenlucW1wX2Rpc3BfbGF5ZXIgKmxheWVyLAorCQkJCQkgICAgY29uc3QgdTE2ICpjb2Vm
ZnMsCisJCQkJCSAgICBjb25zdCB1MzIgKm9mZnNldHMpCit7CisJdW5zaWduZWQgaW50IHN3YXBb
M10gPSB7IDAsIDEsIDIgfTsKKwl1bnNpZ25lZCBpbnQgcmVnOworCXVuc2lnbmVkIGludCBpOwor
CisJaWYgKGxheWVyLT5kaXNwX2ZtdC0+c3dhcCkgeworCQlpZiAobGF5ZXItPmRybV9mbXQtPmlz
X3l1dikgeworCQkJLyogU3dhcCBVIGFuZCBWLiAqLworCQkJc3dhcFsxXSA9IDI7CisJCQlzd2Fw
WzJdID0gMTsKKwkJfSBlbHNlIHsKKwkJCS8qIFN3YXAgUiBhbmQgQi4gKi8KKwkJCXN3YXBbMF0g
PSAyOworCQkJc3dhcFsyXSA9IDA7CisJCX0KKwl9CisKKwlpZiAobGF5ZXItPmlkID09IFpZTlFN
UF9ESVNQX0xBWUVSX1ZJRCkKKwkJcmVnID0gWllOUU1QX0RJU1BfVl9CTEVORF9JTjFDU0NfQ09F
RkYoMCk7CisJZWxzZQorCQlyZWcgPSBaWU5RTVBfRElTUF9WX0JMRU5EX0lOMkNTQ19DT0VGRigw
KTsKKworCWZvciAoaSA9IDA7IGkgPCBaWU5RTVBfRElTUF9WX0JMRU5EX05VTV9DT0VGRjsgaSAr
PSAzLCByZWcgKz0gMTIpIHsKKwkJenlucW1wX2Rpc3BfYmxlbmRfd3JpdGUoYmxlbmQsIHJlZyAr
IDAsIGNvZWZmc1tpICsgc3dhcFswXV0pOworCQl6eW5xbXBfZGlzcF9ibGVuZF93cml0ZShibGVu
ZCwgcmVnICsgNCwgY29lZmZzW2kgKyBzd2FwWzFdXSk7CisJCXp5bnFtcF9kaXNwX2JsZW5kX3dy
aXRlKGJsZW5kLCByZWcgKyA4LCBjb2VmZnNbaSArIHN3YXBbMl1dKTsKKwl9CisKKwlpZiAobGF5
ZXItPmlkID09IFpZTlFNUF9ESVNQX0xBWUVSX1ZJRCkKKwkJcmVnID0gWllOUU1QX0RJU1BfVl9C
TEVORF9JTjFDU0NfT0ZGU0VUKDApOworCWVsc2UKKwkJcmVnID0gWllOUU1QX0RJU1BfVl9CTEVO
RF9JTjJDU0NfT0ZGU0VUKDApOworCisJZm9yIChpID0gMDsgaSA8IFpZTlFNUF9ESVNQX1ZfQkxF
TkRfTlVNX09GRlNFVDsgaSsrKQorCQl6eW5xbXBfZGlzcF9ibGVuZF93cml0ZShibGVuZCwgcmVn
ICsgaSAqIDQsIG9mZnNldHNbaV0pOworfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2JsZW5kX2xh
eWVyX2VuYWJsZSAtIEVuYWJsZSBhIGxheWVyCisgKiBAYmxlbmQ6IEJsZW5kZXIgb2JqZWN0Cisg
KiBAbGF5ZXI6IFRoZSBsYXllcgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9ibGVuZF9s
YXllcl9lbmFibGUoc3RydWN0IHp5bnFtcF9kaXNwX2JsZW5kICpibGVuZCwKKwkJCQkJICAgc3Ry
dWN0IHp5bnFtcF9kaXNwX2xheWVyICpsYXllcikKK3sKKwljb25zdCB1MTYgKmNvZWZmczsKKwlj
b25zdCB1MzIgKm9mZnNldHM7CisJdTMyIHZhbDsKKworCXZhbCA9IChsYXllci0+ZHJtX2ZtdC0+
aXNfeXV2ID8KKwkgICAgICAgMCA6IFpZTlFNUF9ESVNQX1ZfQkxFTkRfTEFZRVJfQ09OVFJPTF9S
R0IpCisJICAgIHwgKGxheWVyLT5kcm1fZm10LT5oc3ViID4gMSA/CisJICAgICAgIFpZTlFNUF9E
SVNQX1ZfQkxFTkRfTEFZRVJfQ09OVFJPTF9FTl9VUyA6IDApOworCisJenlucW1wX2Rpc3BfYmxl
bmRfd3JpdGUoYmxlbmQsCisJCQkJWllOUU1QX0RJU1BfVl9CTEVORF9MQVlFUl9DT05UUk9MKGxh
eWVyLT5pZCksCisJCQkJdmFsKTsKKworCWlmIChsYXllci0+ZHJtX2ZtdC0+aXNfeXV2KSB7CisJ
CWNvZWZmcyA9IGNzY19zZHR2X3RvX3JnYl9tYXRyaXg7CisJCW9mZnNldHMgPSBjc2Nfc2R0dl90
b19yZ2Jfb2Zmc2V0czsKKwl9IGVsc2UgeworCQljb2VmZnMgPSBjc2NfaWRlbnRpdHlfbWF0cml4
OworCQlvZmZzZXRzID0gY3NjX3plcm9fb2Zmc2V0czsKKwl9CisKKwl6eW5xbXBfZGlzcF9ibGVu
ZF9sYXllcl9zZXRfY3NjKGJsZW5kLCBsYXllciwgY29lZmZzLCBvZmZzZXRzKTsKK30KKworLyoq
CisgKiB6eW5xbXBfZGlzcF9ibGVuZF9sYXllcl9kaXNhYmxlIC0gRGlzYWJsZSBhIGxheWVyCisg
KiBAYmxlbmQ6IEJsZW5kZXIgb2JqZWN0CisgKiBAbGF5ZXI6IFRoZSBsYXllcgorICovCitzdGF0
aWMgdm9pZCB6eW5xbXBfZGlzcF9ibGVuZF9sYXllcl9kaXNhYmxlKHN0cnVjdCB6eW5xbXBfZGlz
cF9ibGVuZCAqYmxlbmQsCisJCQkJCSAgICBzdHJ1Y3QgenlucW1wX2Rpc3BfbGF5ZXIgKmxheWVy
KQoreworCXp5bnFtcF9kaXNwX2JsZW5kX3dyaXRlKGJsZW5kLAorCQkJCVpZTlFNUF9ESVNQX1Zf
QkxFTkRfTEFZRVJfQ09OVFJPTChsYXllci0+aWQpLAorCQkJCTApOworCisJenlucW1wX2Rpc3Bf
YmxlbmRfbGF5ZXJfc2V0X2NzYyhibGVuZCwgbGF5ZXIsIGNzY196ZXJvX21hdHJpeCwKKwkJCQkJ
Y3NjX3plcm9fb2Zmc2V0cyk7Cit9CisKKy8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisgKiBBdWRp
byBNaXhlcgorICovCisKK3N0YXRpYyB2b2lkIHp5bnFtcF9kaXNwX2F1ZGlvX3dyaXRlKHN0cnVj
dCB6eW5xbXBfZGlzcF9hdWRpbyAqYXVkaW8sCisJCQkJICBpbnQgcmVnLCB1MzIgdmFsKQorewor
CXdyaXRlbCh2YWwsIGF1ZGlvLT5iYXNlICsgcmVnKTsKK30KKworLyoqCisgKiB6eW5xbXBfZGlz
cF9hdWRpb19lbmFibGUgLSBFbmFibGUgdGhlIGF1ZGlvIG1peGVyCisgKiBAYXVkaW86IEF1ZGlv
IG1peGVyCisgKgorICogRW5hYmxlIHRoZSBhdWRpbyBtaXhlciBieSBkZS1hc3NlcnRpbmcgdGhl
IHNvZnQgcmVzZXQuIFRoZSBhdWRpbyBzdGF0ZSBpcyBzZXQgdG8KKyAqIGRlZmF1bHQgdmFsdWVz
IGJ5IHRoZSByZXNldCwgc2V0IHRoZSBkZWZhdWx0IG1peGVyIHZvbHVtZSBleHBsaWNpdGx5Lgor
ICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9hdWRpb19lbmFibGUoc3RydWN0IHp5bnFtcF9k
aXNwX2F1ZGlvICphdWRpbykKK3sKKwkvKiBDbGVhciB0aGUgYXVkaW8gc29mdCByZXNldCByZWdp
c3RlciBhcyBpdCdzIGFuIG5vbi1yZXNldCBmbG9wLiAqLworCXp5bnFtcF9kaXNwX2F1ZGlvX3dy
aXRlKGF1ZGlvLCBaWU5RTVBfRElTUF9BVURfU09GVF9SRVNFVCwgMCk7CisJenlucW1wX2Rpc3Bf
YXVkaW9fd3JpdGUoYXVkaW8sIFpZTlFNUF9ESVNQX0FVRF9NSVhFUl9WT0xVTUUsCisJCQkJWllO
UU1QX0RJU1BfQVVEX01JWEVSX1ZPTFVNRV9OT19TQ0FMRSk7Cit9CisKKy8qKgorICogenlucW1w
X2Rpc3BfYXVkaW9fZGlzYWJsZSAtIERpc2FibGUgdGhlIGF1ZGlvIG1peGVyCisgKiBAYXVkaW86
IEF1ZGlvIG1peGVyCisgKgorICogRGlzYWJsZSB0aGUgYXVkaW8gbWl4ZXIgYnkgYXNzZXJ0aW5n
IGl0cyBzb2Z0IHJlc2V0LgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9hdWRpb19kaXNh
YmxlKHN0cnVjdCB6eW5xbXBfZGlzcF9hdWRpbyAqYXVkaW8pCit7CisJenlucW1wX2Rpc3BfYXVk
aW9fd3JpdGUoYXVkaW8sIFpZTlFNUF9ESVNQX0FVRF9TT0ZUX1JFU0VULAorCQkJCVpZTlFNUF9E
SVNQX0FVRF9TT0ZUX1JFU0VUX0FVRF9TUlNUKTsKK30KKworc3RhdGljIHZvaWQgenlucW1wX2Rp
c3BfYXVkaW9faW5pdChzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkJIHN0cnVjdCB6eW5xbXBfZGlz
cF9hdWRpbyAqYXVkaW8pCit7CisJLyogVHJ5IHRoZSBsaXZlIFBMIGF1ZGlvIGNsb2NrLiAqLwor
CWF1ZGlvLT5fcGxfY2xrID0gZGV2bV9jbGtfZ2V0KGRldiwgImRwX2xpdmVfYXVkaW9fYWNsayIp
OworCWlmICghSVNfRVJSKGF1ZGlvLT5fcGxfY2xrKSkgeworCQlhdWRpby0+Y2xrID0gYXVkaW8t
Pl9wbF9jbGs7CisJCXJldHVybjsKKwl9CisKKwkvKiBJZiB0aGUgbGl2ZSBQTCBhdWRpbyBjbG9j
ayBpcyBub3QgdmFsaWQsIGZhbGwgYmFjayB0byBQUyBjbG9jay4gKi8KKwlhdWRpby0+X3BzX2Ns
ayA9IGRldm1fY2xrX2dldChkZXYsICJkcF9hdWRfY2xrIik7CisJaWYgKCFJU19FUlIoYXVkaW8t
Pl9wc19jbGspKSB7CisJCWF1ZGlvLT5jbGsgPSBhdWRpby0+X3BzX2NsazsKKwkJcmV0dXJuOwor
CX0KKworCWRldl9lcnIoZGV2LCAiYXVkaW8gZGlzYWJsZWQgZHVlIHRvIG1pc3NpbmcgY2xvY2tc
biIpOworfQorCisvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICogWnlucU1QIERpc3BsYXkgZXh0
ZXJuYWwgZnVuY3Rpb25zIGZvciB6eW5xbXBfZHAKKyAqLworCisvKioKKyAqIHp5bnFtcF9kaXNw
X2hhbmRsZV92YmxhbmsgLSBIYW5kbGUgdGhlIHZibGFuayBldmVudAorICogQGRpc3A6IERpc3Bs
YXkgY29udHJvbGxlcgorICoKKyAqIFRoaXMgZnVuY3Rpb24gaGFuZGxlcyB0aGUgdmJsYW5rIGlu
dGVycnVwdCwgYW5kIHNlbmRzIGFuIGV2ZW50IHRvCisgKiBDUlRDIG9iamVjdC4gVGhpcyB3aWxs
IGJlIGNhbGxlZCBieSB0aGUgRFAgdmJsYW5rIGludGVycnVwdCBoYW5kbGVyLgorICovCit2b2lk
IHp5bnFtcF9kaXNwX2hhbmRsZV92Ymxhbmsoc3RydWN0IHp5bnFtcF9kaXNwICpkaXNwKQorewor
CXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9ICZkaXNwLT5jcnRjOworCisJZHJtX2NydGNfaGFuZGxl
X3ZibGFuayhjcnRjKTsKK30KKworLyoqCisgKiB6eW5xbXBfZGlzcF9hdWRpb19lbmFibGVkIC0g
SWYgdGhlIGF1ZGlvIGlzIGVuYWJsZWQKKyAqIEBkaXNwOiBEaXNwbGF5IGNvbnRyb2xsZXIKKyAq
CisgKiBSZXR1cm4gaWYgdGhlIGF1ZGlvIGlzIGVuYWJsZWQgZGVwZW5kaW5nIG9uIHRoZSBhdWRp
byBjbG9jay4KKyAqCisgKiBSZXR1cm46IHRydWUgaWYgYXVkaW8gaXMgZW5hYmxlZCwgb3IgZmFs
c2UuCisgKi8KK2Jvb2wgenlucW1wX2Rpc3BfYXVkaW9fZW5hYmxlZChzdHJ1Y3QgenlucW1wX2Rp
c3AgKmRpc3ApCit7CisJcmV0dXJuICEhZGlzcC0+YXVkaW8uY2xrOworfQorCisvKioKKyAqIHp5
bnFtcF9kaXNwX2dldF9hdWRpb19jbGtfcmF0ZSAtIEdldCB0aGUgY3VycmVudCBhdWRpbyBjbG9j
ayByYXRlCisgKiBAZGlzcDogRGlzcGxheSBjb250cm9sbGVyCisgKgorICogUmV0dXJuOiB0aGUg
Y3VycmVudCBhdWRpbyBjbG9jayByYXRlLgorICovCit1bnNpZ25lZCBpbnQgenlucW1wX2Rpc3Bf
Z2V0X2F1ZGlvX2Nsa19yYXRlKHN0cnVjdCB6eW5xbXBfZGlzcCAqZGlzcCkKK3sKKwlpZiAoenlu
cW1wX2Rpc3BfYXVkaW9fZW5hYmxlZChkaXNwKSkKKwkJcmV0dXJuIDA7CisJcmV0dXJuIGNsa19n
ZXRfcmF0ZShkaXNwLT5hdWRpby5jbGspOworfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2dldF9j
cnRjX21hc2sgLSBSZXR1cm4gdGhlIENSVEMgYml0IG1hc2sKKyAqIEBkaXNwOiBEaXNwbGF5IGNv
bnRyb2xsZXIKKyAqCisgKiBSZXR1cm46IHRoZSBjcnRjIG1hc2sgb2YgdGhlIHp5cW5tcF9kaXNw
IENSVEMuCisgKi8KK3VpbnQzMl90IHp5bnFtcF9kaXNwX2dldF9jcnRjX21hc2soc3RydWN0IHp5
bnFtcF9kaXNwICpkaXNwKQoreworCXJldHVybiBkcm1fY3J0Y19tYXNrKCZkaXNwLT5jcnRjKTsK
K30KKworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqIFp5bnFNUCBEaXNwbGF5IExheWVyICYg
RFJNIFBsYW5lCisgKi8KKworLyoqCisgKiB6eW5xbXBfZGlzcF9sYXllcl9maW5kX2Zvcm1hdCAt
IEZpbmQgZm9ybWF0IGluZm9ybWF0aW9uIGZvciBhIERSTSBmb3JtYXQKKyAqIEBsYXllcjogVGhl
IGxheWVyCisgKiBAZHJtX2ZtdDogRFJNIGZvcm1hdCB0byBzZWFyY2gKKyAqCisgKiBTZWFyY2gg
ZGlzcGxheSBzdWJzeXN0ZW0gZm9ybWF0IGluZm9ybWF0aW9uIGNvcnJlc3BvbmRpbmcgdG8gdGhl
IGdpdmVuIERSTQorICogZm9ybWF0IEBkcm1fZm10IGZvciB0aGUgQGxheWVyLCBhbmQgcmV0dXJu
IGEgcG9pbnRlciB0byB0aGUgZm9ybWF0CisgKiBkZXNjcmlwdG9yLgorICoKKyAqIFJldHVybjog
QSBwb2ludGVyIHRvIHRoZSBmb3JtYXQgZGVzY3JpcHRvciBpZiBmb3VuZCwgTlVMTCBvdGhlcndp
c2UKKyAqLworc3RhdGljIGNvbnN0IHN0cnVjdCB6eW5xbXBfZGlzcF9mb3JtYXQgKgorenlucW1w
X2Rpc3BfbGF5ZXJfZmluZF9mb3JtYXQoc3RydWN0IHp5bnFtcF9kaXNwX2xheWVyICpsYXllciwK
KwkJCSAgICAgIHUzMiBkcm1fZm10KQoreworCXVuc2lnbmVkIGludCBpOworCisJZm9yIChpID0g
MDsgaSA8IGxheWVyLT5pbmZvLT5udW1fZm9ybWF0czsgaSsrKSB7CisJCWlmIChsYXllci0+aW5m
by0+Zm9ybWF0c1tpXS5kcm1fZm10ID09IGRybV9mbXQpCisJCQlyZXR1cm4gJmxheWVyLT5pbmZv
LT5mb3JtYXRzW2ldOworCX0KKworCXJldHVybiBOVUxMOworfQorCisvKioKKyAqIHp5bnFtcF9k
aXNwX2xheWVyX2VuYWJsZSAtIEVuYWJsZSBhIGxheWVyCisgKiBAbGF5ZXI6IFRoZSBsYXllcgor
ICoKKyAqIEVuYWJsZSB0aGUgQGxheWVyIGluIHRoZSBhdWRpby92aWRlbyBidWZmZXIgbWFuYWdl
ciBhbmQgdGhlIGJsZW5kZXIuIERNQQorICogY2hhbm5lbHMgYXJlIHN0YXJ0ZWQgc2VwYXJhdGVs
eSBieSB6eW5xbXBfZGlzcF9sYXllcl91cGRhdGUoKS4KKyAqLworc3RhdGljIHZvaWQgenlucW1w
X2Rpc3BfbGF5ZXJfZW5hYmxlKHN0cnVjdCB6eW5xbXBfZGlzcF9sYXllciAqbGF5ZXIpCit7CisJ
enlucW1wX2Rpc3BfYXZidWZfZW5hYmxlX3ZpZGVvKCZsYXllci0+ZGlzcC0+YXZidWYsIGxheWVy
LT5pZCwKKwkJCQkgICAgICAgWllOUU1QX0RJU1BfTEFZRVJfTk9OTElWRSk7CisJenlucW1wX2Rp
c3BfYmxlbmRfbGF5ZXJfZW5hYmxlKCZsYXllci0+ZGlzcC0+YmxlbmQsIGxheWVyKTsKKworCWxh
eWVyLT5tb2RlID0gWllOUU1QX0RJU1BfTEFZRVJfTk9OTElWRTsKK30KKworLyoqCisgKiB6eW5x
bXBfZGlzcF9sYXllcl9kaXNhYmxlIC0gRGlzYWJsZSB0aGUgbGF5ZXIKKyAqIEBsYXllcjogVGhl
IGxheWVyCisgKgorICogRGlzYWJsZSB0aGUgbGF5ZXIgYnkgc3RvcHBpbmcgaXRzIERNQSBjaGFu
bmVscyBhbmQgZGlzYWJsaW5nIGl0IGluIHRoZQorICogYXVkaW8vdmlkZW8gYnVmZmVyIG1hbmFn
ZXIgYW5kIHRoZSBibGVuZGVyLgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9sYXllcl9k
aXNhYmxlKHN0cnVjdCB6eW5xbXBfZGlzcF9sYXllciAqbGF5ZXIpCit7CisJdW5zaWduZWQgaW50
IGk7CisKKwlmb3IgKGkgPSAwOyBpIDwgbGF5ZXItPmRybV9mbXQtPm51bV9wbGFuZXM7IGkrKykK
KwkJZG1hZW5naW5lX3Rlcm1pbmF0ZV9zeW5jKGxheWVyLT5kbWFzW2ldLmNoYW4pOworCisJenlu
cW1wX2Rpc3BfYXZidWZfZGlzYWJsZV92aWRlbygmbGF5ZXItPmRpc3AtPmF2YnVmLCBsYXllci0+
aWQpOworCXp5bnFtcF9kaXNwX2JsZW5kX2xheWVyX2Rpc2FibGUoJmxheWVyLT5kaXNwLT5ibGVu
ZCwgbGF5ZXIpOworfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2xheWVyX3NldF9mb3JtYXQgLSBT
ZXQgdGhlIGxheWVyIGZvcm1hdAorICogQGxheWVyOiBUaGUgbGF5ZXIKKyAqIEBzdGF0ZTogVGhl
IHBsYW5lIHN0YXRlCisgKgorICogU2V0IHRoZSBmb3JtYXQgZm9yIEBsYXllciBiYXNlZCBvbiBA
c3RhdGUtPmZiLT5mb3JtYXQuIFRoZSBsYXllciBtdXN0IGJlCisgKiBkaXNhYmxlZC4KKyAqLwor
c3RhdGljIHZvaWQgenlucW1wX2Rpc3BfbGF5ZXJfc2V0X2Zvcm1hdChzdHJ1Y3QgenlucW1wX2Rp
c3BfbGF5ZXIgKmxheWVyLAorCQkJCQkgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqc3RhdGUpCit7
CisJY29uc3Qgc3RydWN0IGRybV9mb3JtYXRfaW5mbyAqaW5mbyA9IHN0YXRlLT5mYi0+Zm9ybWF0
OworCisJbGF5ZXItPmRpc3BfZm10ID0genlucW1wX2Rpc3BfbGF5ZXJfZmluZF9mb3JtYXQobGF5
ZXIsIGluZm8tPmZvcm1hdCk7CisJbGF5ZXItPmRybV9mbXQgPSBpbmZvOworCisJenlucW1wX2Rp
c3BfYXZidWZfc2V0X2Zvcm1hdCgmbGF5ZXItPmRpc3AtPmF2YnVmLCBsYXllci0+aWQsCisJCQkJ
ICAgICBsYXllci0+ZGlzcF9mbXQpOworfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2xheWVyX3Vw
ZGF0ZSAtIFVwZGF0ZSB0aGUgbGF5ZXIgZnJhbWVidWZmZXIKKyAqIEBsYXllcjogVGhlIGxheWVy
CisgKiBAc3RhdGU6IFRoZSBwbGFuZSBzdGF0ZQorICoKKyAqIFVwZGF0ZSB0aGUgZnJhbWVidWZm
ZXIgZm9yIHRoZSBsYXllciBieSBpc3N1aW5nIGEgbmV3IERNQSBlbmdpbmUgdHJhbnNhY3Rpb24K
KyAqIGZvciB0aGUgbmV3IGZyYW1lYnVmZmVyLgorICoKKyAqIFJldHVybjogMCBvbiBzdWNjZXNz
LCBvciB0aGUgRE1BIGRlc2NyaXB0b3IgZmFpbHVyZSBlcnJvciBvdGhlcndpc2UKKyAqLworc3Rh
dGljIGludCB6eW5xbXBfZGlzcF9sYXllcl91cGRhdGUoc3RydWN0IHp5bnFtcF9kaXNwX2xheWVy
ICpsYXllciwKKwkJCQkgICAgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqc3RhdGUpCit7CisJY29u
c3Qgc3RydWN0IGRybV9mb3JtYXRfaW5mbyAqaW5mbyA9IGxheWVyLT5kcm1fZm10OworCXVuc2ln
bmVkIGludCBpOworCisJZm9yIChpID0gMDsgaSA8IGxheWVyLT5kcm1fZm10LT5udW1fcGxhbmVz
OyBpKyspIHsKKwkJdW5zaWduZWQgaW50IHdpZHRoID0gc3RhdGUtPmNydGNfdyAvIChpID8gaW5m
by0+aHN1YiA6IDEpOworCQl1bnNpZ25lZCBpbnQgaGVpZ2h0ID0gc3RhdGUtPmNydGNfaCAvIChp
ID8gaW5mby0+dnN1YiA6IDEpOworCQlzdHJ1Y3QgenlucW1wX2Rpc3BfbGF5ZXJfZG1hICpkbWEg
PSAmbGF5ZXItPmRtYXNbaV07CisJCXN0cnVjdCBkbWFfYXN5bmNfdHhfZGVzY3JpcHRvciAqZGVz
YzsKKwkJZG1hX2FkZHJfdCBwYWRkcjsKKworCQlwYWRkciA9IGRybV9mYl9jbWFfZ2V0X2dlbV9h
ZGRyKHN0YXRlLT5mYiwgc3RhdGUsIGkpOworCisJCWRtYS0+eHQubnVtZiA9IGhlaWdodDsKKwkJ
ZG1hLT5zZ2wuc2l6ZSA9IHdpZHRoICogaW5mby0+Y3BwW2ldOworCQlkbWEtPnNnbC5pY2cgPSBz
dGF0ZS0+ZmItPnBpdGNoZXNbaV0gLSBkbWEtPnNnbC5zaXplOworCQlkbWEtPnh0LnNyY19zdGFy
dCA9IHBhZGRyOworCQlkbWEtPnh0LmZyYW1lX3NpemUgPSAxOworCQlkbWEtPnh0LmRpciA9IERN
QV9NRU1fVE9fREVWOworCQlkbWEtPnh0LnNyY19zZ2wgPSB0cnVlOworCQlkbWEtPnh0LmRzdF9z
Z2wgPSBmYWxzZTsKKworCQlkZXNjID0gZG1hZW5naW5lX3ByZXBfaW50ZXJsZWF2ZWRfZG1hKGRt
YS0+Y2hhbiwgJmRtYS0+eHQsCisJCQkJCQkgICAgICBETUFfQ1RSTF9BQ0sgfAorCQkJCQkJICAg
ICAgRE1BX1BSRVBfSU5URVJSVVBUKTsKKwkJaWYgKCFkZXNjKSB7CisJCQlkZXZfZXJyKGxheWVy
LT5kaXNwLT5kZXYsCisJCQkJImZhaWxlZCB0byBwcmVwYXJlIERNQSBkZXNjcmlwdG9yXG4iKTsK
KwkJCXJldHVybiAtRU5PTUVNOworCQl9CisKKwkJZG1hZW5naW5lX3N1Ym1pdChkZXNjKTsKKwkJ
ZG1hX2FzeW5jX2lzc3VlX3BlbmRpbmcoZG1hLT5jaGFuKTsKKwl9CisKKwlyZXR1cm4gMDsKK30K
Kworc3RhdGljIGlubGluZSBzdHJ1Y3QgenlucW1wX2Rpc3BfbGF5ZXIgKnBsYW5lX3RvX2xheWVy
KHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lKQoreworCXJldHVybiBjb250YWluZXJfb2YocGxhbmUs
IHN0cnVjdCB6eW5xbXBfZGlzcF9sYXllciwgcGxhbmUpOworfQorCitzdGF0aWMgaW50Cit6eW5x
bXBfZGlzcF9wbGFuZV9hdG9taWNfY2hlY2soc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsCisJCQkg
ICAgICAgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqc3RhdGUpCit7CisJc3RydWN0IGRybV9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlOworCisJaWYgKCFzdGF0ZS0+Y3J0YykKKwkJcmV0dXJuIDA7CisK
KwljcnRjX3N0YXRlID0gZHJtX2F0b21pY19nZXRfY3J0Y19zdGF0ZShzdGF0ZS0+c3RhdGUsIHN0
YXRlLT5jcnRjKTsKKwlpZiAoSVNfRVJSKGNydGNfc3RhdGUpKQorCQlyZXR1cm4gUFRSX0VSUihj
cnRjX3N0YXRlKTsKKworCXJldHVybiBkcm1fYXRvbWljX2hlbHBlcl9jaGVja19wbGFuZV9zdGF0
ZShzdGF0ZSwgY3J0Y19zdGF0ZSwKKwkJCQkJCSAgIERSTV9QTEFORV9IRUxQRVJfTk9fU0NBTElO
RywKKwkJCQkJCSAgIERSTV9QTEFORV9IRUxQRVJfTk9fU0NBTElORywKKwkJCQkJCSAgIGZhbHNl
LCBmYWxzZSk7Cit9CisKK3N0YXRpYyB2b2lkCit6eW5xbXBfZGlzcF9wbGFuZV9hdG9taWNfZGlz
YWJsZShzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKKwkJCQkgc3RydWN0IGRybV9wbGFuZV9zdGF0
ZSAqb2xkX3N0YXRlKQoreworCXN0cnVjdCB6eW5xbXBfZGlzcF9sYXllciAqbGF5ZXIgPSBwbGFu
ZV90b19sYXllcihwbGFuZSk7CisKKwl6eW5xbXBfZGlzcF9sYXllcl9kaXNhYmxlKGxheWVyKTsK
K30KKworc3RhdGljIHZvaWQKK3p5bnFtcF9kaXNwX3BsYW5lX2F0b21pY191cGRhdGUoc3RydWN0
IGRybV9wbGFuZSAqcGxhbmUsCisJCQkJc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqb2xkX3N0YXRl
KQoreworCXN0cnVjdCB6eW5xbXBfZGlzcF9sYXllciAqbGF5ZXIgPSBwbGFuZV90b19sYXllcihw
bGFuZSk7CisJYm9vbCBmb3JtYXRfY2hhbmdlZCA9IGZhbHNlOworCisJaWYgKCFvbGRfc3RhdGUt
PmZiIHx8CisJICAgIG9sZF9zdGF0ZS0+ZmItPmZvcm1hdC0+Zm9ybWF0ICE9IHBsYW5lLT5zdGF0
ZS0+ZmItPmZvcm1hdC0+Zm9ybWF0KQorCQlmb3JtYXRfY2hhbmdlZCA9IHRydWU7CisKKwkvKgor
CSAqIElmIHRoZSBmb3JtYXQgaGFzIGNoYW5nZWQgKGluY2x1ZGluZyBnb2luZyBmcm9tIGEgcHJl
dmlvdXNseQorCSAqIGRpc2FibGVkIHN0YXRlIHRvIGFueSBmb3JtYXQpLCByZWNvbmZpZ3VyZSB0
aGUgZm9ybWF0LiBEaXNhYmxlIHRoZQorCSAqIHBsYW5lIGZpcnN0IGlmIG5lZWRlZC4KKwkgKi8K
KwlpZiAoZm9ybWF0X2NoYW5nZWQpIHsKKwkJaWYgKG9sZF9zdGF0ZS0+ZmIpCisJCQl6eW5xbXBf
ZGlzcF9sYXllcl9kaXNhYmxlKGxheWVyKTsKKworCQl6eW5xbXBfZGlzcF9sYXllcl9zZXRfZm9y
bWF0KGxheWVyLCBwbGFuZS0+c3RhdGUpOworCX0KKworCXp5bnFtcF9kaXNwX2xheWVyX3VwZGF0
ZShsYXllciwgcGxhbmUtPnN0YXRlKTsKKworCS8qIEVuYWJsZSBvciByZS1lbmFibGUgdGhlIHBs
YW5lIGlzIHRoZSBmb3JtYXQgaGFzIGNoYW5nZWQuICovCisJaWYgKGZvcm1hdF9jaGFuZ2VkKQor
CQl6eW5xbXBfZGlzcF9sYXllcl9lbmFibGUobGF5ZXIpOworfQorCitzdGF0aWMgY29uc3Qgc3Ry
dWN0IGRybV9wbGFuZV9oZWxwZXJfZnVuY3MgenlucW1wX2Rpc3BfcGxhbmVfaGVscGVyX2Z1bmNz
ID0geworCS5hdG9taWNfY2hlY2sJCT0genlucW1wX2Rpc3BfcGxhbmVfYXRvbWljX2NoZWNrLAor
CS5hdG9taWNfdXBkYXRlCQk9IHp5bnFtcF9kaXNwX3BsYW5lX2F0b21pY191cGRhdGUsCisJLmF0
b21pY19kaXNhYmxlCQk9IHp5bnFtcF9kaXNwX3BsYW5lX2F0b21pY19kaXNhYmxlLAorfTsKKwor
c3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfZnVuY3MgenlucW1wX2Rpc3BfcGxhbmVfZnVu
Y3MgPSB7CisJLnVwZGF0ZV9wbGFuZQkJPSBkcm1fYXRvbWljX2hlbHBlcl91cGRhdGVfcGxhbmUs
CisJLmRpc2FibGVfcGxhbmUJCT0gZHJtX2F0b21pY19oZWxwZXJfZGlzYWJsZV9wbGFuZSwKKwku
ZGVzdHJveQkJPSBkcm1fcGxhbmVfY2xlYW51cCwKKwkucmVzZXQJCQk9IGRybV9hdG9taWNfaGVs
cGVyX3BsYW5lX3Jlc2V0LAorCS5hdG9taWNfZHVwbGljYXRlX3N0YXRlCT0gZHJtX2F0b21pY19o
ZWxwZXJfcGxhbmVfZHVwbGljYXRlX3N0YXRlLAorCS5hdG9taWNfZGVzdHJveV9zdGF0ZQk9IGRy
bV9hdG9taWNfaGVscGVyX3BsYW5lX2Rlc3Ryb3lfc3RhdGUsCit9OworCitzdGF0aWMgaW50IHp5
bnFtcF9kaXNwX2NyZWF0ZV9wbGFuZXMoc3RydWN0IHp5bnFtcF9kaXNwICpkaXNwKQoreworCXVu
c2lnbmVkIGludCBpLCBqOworCWludCByZXQ7CisKKwlmb3IgKGkgPSAwOyBpIDwgWllOUU1QX0RJ
U1BfTlVNX0xBWUVSUzsgaSsrKSB7CisJCXN0cnVjdCB6eW5xbXBfZGlzcF9sYXllciAqbGF5ZXIg
PSAmZGlzcC0+bGF5ZXJzW2ldOworCQllbnVtIGRybV9wbGFuZV90eXBlIHR5cGU7CisJCXUzMiAq
ZHJtX2Zvcm1hdHM7CisKKwkJZHJtX2Zvcm1hdHMgPSBkZXZtX2tjYWxsb2MoZGlzcC0+ZGV2LCBz
aXplb2YoKmRybV9mb3JtYXRzKSwKKwkJCQkJICAgbGF5ZXItPmluZm8tPm51bV9mb3JtYXRzLAor
CQkJCQkgICBHRlBfS0VSTkVMKTsKKwkJaWYgKCFkcm1fZm9ybWF0cykKKwkJCXJldHVybiAtRU5P
TUVNOworCisJCWZvciAoaiA9IDA7IGogPCBsYXllci0+aW5mby0+bnVtX2Zvcm1hdHM7ICsraikK
KwkJCWRybV9mb3JtYXRzW2pdID0gbGF5ZXItPmluZm8tPmZvcm1hdHNbal0uZHJtX2ZtdDsKKwor
CQkvKiBHcmFwaGljcyBsYXllciBpcyBwcmltYXJ5LCBhbmQgdmlkZW8gbGF5ZXIgaXMgb3Zlcmxh
eS4gKi8KKwkJdHlwZSA9IGkgPT0gWllOUU1QX0RJU1BfTEFZRVJfR0ZYCisJCSAgICAgPyBEUk1f
UExBTkVfVFlQRV9QUklNQVJZIDogRFJNX1BMQU5FX1RZUEVfT1ZFUkxBWTsKKwkJcmV0ID0gZHJt
X3VuaXZlcnNhbF9wbGFuZV9pbml0KGRpc3AtPmRybSwgJmxheWVyLT5wbGFuZSwgMCwKKwkJCQkJ
ICAgICAgICZ6eW5xbXBfZGlzcF9wbGFuZV9mdW5jcywKKwkJCQkJICAgICAgIGRybV9mb3JtYXRz
LAorCQkJCQkgICAgICAgbGF5ZXItPmluZm8tPm51bV9mb3JtYXRzLAorCQkJCQkgICAgICAgTlVM
TCwgdHlwZSwgTlVMTCk7CisJCWlmIChyZXQpCisJCQlyZXR1cm4gcmV0OworCisJCWRybV9wbGFu
ZV9oZWxwZXJfYWRkKCZsYXllci0+cGxhbmUsCisJCQkJICAgICAmenlucW1wX2Rpc3BfcGxhbmVf
aGVscGVyX2Z1bmNzKTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworLyoqCisgKiB6eW5xbXBfZGlz
cF9sYXllcl9yZWxlYXNlX2RtYSAtIFJlbGVhc2UgRE1BIGNoYW5uZWxzIGZvciBhIGxheWVyCisg
KiBAZGlzcDogRGlzcGxheSBjb250cm9sbGVyCisgKiBAbGF5ZXI6IFRoZSBsYXllcgorICoKKyAq
IFJlbGVhc2UgdGhlIERNQSBjaGFubmVscyBhc3NvY2lhdGVkIHdpdGggQGxheWVyLgorICovCitz
dGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9sYXllcl9yZWxlYXNlX2RtYShzdHJ1Y3QgenlucW1wX2Rp
c3AgKmRpc3AsCisJCQkJCSAgc3RydWN0IHp5bnFtcF9kaXNwX2xheWVyICpsYXllcikKK3sKKwl1
bnNpZ25lZCBpbnQgaTsKKworCWZvciAoaSA9IDA7IGkgPCBsYXllci0+aW5mby0+bnVtX2NoYW5u
ZWxzOyBpKyspIHsKKwkJc3RydWN0IHp5bnFtcF9kaXNwX2xheWVyX2RtYSAqZG1hID0gJmxheWVy
LT5kbWFzW2ldOworCisJCWlmICghZG1hKQorCQkJY29udGludWU7CisKKwkJLyogTWFrZSBzdXJl
IHRoZSBjaGFubmVsIGlzIHRlcm1pbmF0ZWQgYmVmb3JlIHJlbGVhc2UuICovCisJCWRtYWVuZ2lu
ZV90ZXJtaW5hdGVfYWxsKGRtYS0+Y2hhbik7CisJCWRtYV9yZWxlYXNlX2NoYW5uZWwoZG1hLT5j
aGFuKTsKKwl9Cit9CisKKy8qKgorICogenlucW1wX2Rpc3BfZGVzdHJveV9sYXllcnMgLSBEZXN0
cm95IGFsbCBsYXllcnMKKyAqIEBkaXNwOiBEaXNwbGF5IGNvbnRyb2xsZXIKKyAqLworc3RhdGlj
IHZvaWQgenlucW1wX2Rpc3BfZGVzdHJveV9sYXllcnMoc3RydWN0IHp5bnFtcF9kaXNwICpkaXNw
KQoreworCXVuc2lnbmVkIGludCBpOworCisJZm9yIChpID0gMDsgaSA8IFpZTlFNUF9ESVNQX05V
TV9MQVlFUlM7IGkrKykKKwkJenlucW1wX2Rpc3BfbGF5ZXJfcmVsZWFzZV9kbWEoZGlzcCwgJmRp
c3AtPmxheWVyc1tpXSk7Cit9CisKKy8qKgorICogenlucW1wX2Rpc3BfbGF5ZXJfcmVxdWVzdF9k
bWEgLSBSZXF1ZXN0IERNQSBjaGFubmVscyBmb3IgYSBsYXllcgorICogQGRpc3A6IERpc3BsYXkg
Y29udHJvbGxlcgorICogQGxheWVyOiBUaGUgbGF5ZXIKKyAqCisgKiBSZXF1ZXN0IGFsbCBETUEg
ZW5naW5lIGNoYW5uZWxzIG5lZWRlZCBieSBAbGF5ZXIuCisgKgorICogUmV0dXJuOiAwIG9uIHN1
Y2Nlc3MsIG9yIHRoZSBETUEgY2hhbm5lbCByZXF1ZXN0IGVycm9yIG90aGVyd2lzZQorICovCitz
dGF0aWMgaW50IHp5bnFtcF9kaXNwX2xheWVyX3JlcXVlc3RfZG1hKHN0cnVjdCB6eW5xbXBfZGlz
cCAqZGlzcCwKKwkJCQkJIHN0cnVjdCB6eW5xbXBfZGlzcF9sYXllciAqbGF5ZXIpCit7CisJc3Rh
dGljIGNvbnN0IGNoYXIgKiBjb25zdCBkbWFfbmFtZXNbXSA9IHsgInZpZCIsICJnZngiIH07CisJ
dW5zaWduZWQgaW50IGk7CisJaW50IHJldDsKKworCWZvciAoaSA9IDA7IGkgPCBsYXllci0+aW5m
by0+bnVtX2NoYW5uZWxzOyBpKyspIHsKKwkJc3RydWN0IHp5bnFtcF9kaXNwX2xheWVyX2RtYSAq
ZG1hID0gJmxheWVyLT5kbWFzW2ldOworCQljaGFyIGRtYV9jaGFubmVsX25hbWVbMTZdOworCisJ
CXNucHJpbnRmKGRtYV9jaGFubmVsX25hbWUsIHNpemVvZihkbWFfY2hhbm5lbF9uYW1lKSwKKwkJ
CSAiJXMldSIsIGRtYV9uYW1lc1tsYXllci0+aWRdLCBpKTsKKwkJZG1hLT5jaGFuID0gb2ZfZG1h
X3JlcXVlc3Rfc2xhdmVfY2hhbm5lbChkaXNwLT5kZXYtPm9mX25vZGUsCisJCQkJCQkJIGRtYV9j
aGFubmVsX25hbWUpOworCQlpZiAoSVNfRVJSKGRtYS0+Y2hhbikpIHsKKwkJCWRldl9lcnIoZGlz
cC0+ZGV2LCAiZmFpbGVkIHRvIHJlcXVlc3QgZG1hIGNoYW5uZWxcbiIpOworCQkJcmV0ID0gUFRS
X0VSUihkbWEtPmNoYW4pOworCQkJZG1hLT5jaGFuID0gTlVMTDsKKwkJCXJldHVybiByZXQ7CisJ
CX0KKwl9CisKKwlyZXR1cm4gMDsKK30KKworLyoqCisgKiB6eW5xbXBfZGlzcF9jcmVhdGVfbGF5
ZXJzIC0gQ3JlYXRlIGFsbCBsYXllcnMKKyAqIEBkaXNwOiBEaXNwbGF5IGNvbnRyb2xsZXIKKyAq
CisgKiBSZXR1cm46IDAgb24gc3VjY2Vzcywgb3IgdGhlIERNQSBjaGFubmVsIHJlcXVlc3QgZXJy
b3Igb3RoZXJ3aXNlCisgKi8KK3N0YXRpYyBpbnQgenlucW1wX2Rpc3BfY3JlYXRlX2xheWVycyhz
dHJ1Y3QgenlucW1wX2Rpc3AgKmRpc3ApCit7CisJc3RhdGljIGNvbnN0IHN0cnVjdCB6eW5xbXBf
ZGlzcF9sYXllcl9pbmZvIGxheWVyX2luZm9bXSA9IHsKKwkJW1pZTlFNUF9ESVNQX0xBWUVSX1ZJ
RF0gPSB7CisJCQkuZm9ybWF0cyA9IGF2YnVmX3ZpZF9mbXRzLAorCQkJLm51bV9mb3JtYXRzID0g
QVJSQVlfU0laRShhdmJ1Zl92aWRfZm10cyksCisJCQkubnVtX2NoYW5uZWxzID0gMywKKwkJfSwK
KwkJW1pZTlFNUF9ESVNQX0xBWUVSX0dGWF0gPSB7CisJCQkuZm9ybWF0cyA9IGF2YnVmX2dmeF9m
bXRzLAorCQkJLm51bV9mb3JtYXRzID0gQVJSQVlfU0laRShhdmJ1Zl9nZnhfZm10cyksCisJCQku
bnVtX2NoYW5uZWxzID0gMSwKKwkJfSwKKwl9OworCisJdW5zaWduZWQgaW50IGk7CisJaW50IHJl
dDsKKworCWZvciAoaSA9IDA7IGkgPCBaWU5RTVBfRElTUF9OVU1fTEFZRVJTOyBpKyspIHsKKwkJ
c3RydWN0IHp5bnFtcF9kaXNwX2xheWVyICpsYXllciA9ICZkaXNwLT5sYXllcnNbaV07CisKKwkJ
bGF5ZXItPmlkID0gaTsKKwkJbGF5ZXItPmRpc3AgPSBkaXNwOworCQlsYXllci0+aW5mbyA9ICZs
YXllcl9pbmZvW2ldOworCisJCXJldCA9IHp5bnFtcF9kaXNwX2xheWVyX3JlcXVlc3RfZG1hKGRp
c3AsIGxheWVyKTsKKwkJaWYgKHJldCkKKwkJCWdvdG8gZXJyOworCX0KKworCXJldHVybiAwOwor
CitlcnI6CisJenlucW1wX2Rpc3BfZGVzdHJveV9sYXllcnMoZGlzcCk7CisJcmV0dXJuIHJldDsK
K30KKworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqIFp5bnFNUCBEaXNwbGF5ICYgRFJNIENS
VEMKKyAqLworCisvKioKKyAqIHp5bnFtcF9kaXNwX2VuYWJsZSAtIEVuYWJsZSB0aGUgZGlzcGxh
eSBjb250cm9sbGVyCisgKiBAZGlzcDogRGlzcGxheSBjb250cm9sbGVyCisgKi8KK3N0YXRpYyB2
b2lkIHp5bnFtcF9kaXNwX2VuYWJsZShzdHJ1Y3QgenlucW1wX2Rpc3AgKmRpc3ApCit7CisJenlu
cW1wX2Rpc3BfYXZidWZfZW5hYmxlKCZkaXNwLT5hdmJ1Zik7CisJLyogQ2hvb3NlIGNsb2NrIHNv
dXJjZSBiYXNlZCBvbiB0aGUgRFQgY2xvY2sgaGFuZGxlLiAqLworCXp5bnFtcF9kaXNwX2F2YnVm
X3NldF9jbG9ja3Nfc291cmNlcygmZGlzcC0+YXZidWYsICEhZGlzcC0+X3BzX3BjbGssCisJCQkJ
CSAgICAgISFkaXNwLT5hdWRpby5fcHNfY2xrLCB0cnVlKTsKKwl6eW5xbXBfZGlzcF9hdmJ1Zl9l
bmFibGVfY2hhbm5lbHMoJmRpc3AtPmF2YnVmKTsKKwl6eW5xbXBfZGlzcF9hdmJ1Zl9lbmFibGVf
YXVkaW8oJmRpc3AtPmF2YnVmKTsKKworCXp5bnFtcF9kaXNwX2F1ZGlvX2VuYWJsZSgmZGlzcC0+
YXVkaW8pOworfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2Rpc2FibGUgLSBEaXNhYmxlIHRoZSBk
aXNwbGF5IGNvbnRyb2xsZXIKKyAqIEBkaXNwOiBEaXNwbGF5IGNvbnRyb2xsZXIKKyAqLworc3Rh
dGljIHZvaWQgenlucW1wX2Rpc3BfZGlzYWJsZShzdHJ1Y3QgenlucW1wX2Rpc3AgKmRpc3ApCit7
CisJc3RydWN0IGRybV9jcnRjICpjcnRjID0gJmRpc3AtPmNydGM7CisKKwl6eW5xbXBfZGlzcF9h
dWRpb19kaXNhYmxlKCZkaXNwLT5hdWRpbyk7CisKKwl6eW5xbXBfZGlzcF9hdmJ1Zl9kaXNhYmxl
X2F1ZGlvKCZkaXNwLT5hdmJ1Zik7CisJenlucW1wX2Rpc3BfYXZidWZfZGlzYWJsZV9jaGFubmVs
cygmZGlzcC0+YXZidWYpOworCXp5bnFtcF9kaXNwX2F2YnVmX2Rpc2FibGUoJmRpc3AtPmF2YnVm
KTsKKworCS8qIE1hcmsgdGhlIGZsaXAgaXMgZG9uZSBhcyBjcnRjIGlzIGRpc2FibGVkIGFueXdh
eSAqLworCWlmIChjcnRjLT5zdGF0ZS0+ZXZlbnQpIHsKKwkJY29tcGxldGVfYWxsKGNydGMtPnN0
YXRlLT5ldmVudC0+YmFzZS5jb21wbGV0aW9uKTsKKwkJY3J0Yy0+c3RhdGUtPmV2ZW50ID0gTlVM
TDsKKwl9Cit9CisKK3N0YXRpYyBpbmxpbmUgc3RydWN0IHp5bnFtcF9kaXNwICpjcnRjX3RvX2Rp
c3Aoc3RydWN0IGRybV9jcnRjICpjcnRjKQoreworCXJldHVybiBjb250YWluZXJfb2YoY3J0Yywg
c3RydWN0IHp5bnFtcF9kaXNwLCBjcnRjKTsKK30KKworc3RhdGljIGludCB6eW5xbXBfZGlzcF9j
cnRjX3NldHVwX2Nsb2NrKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKKwkJCQkJc3RydWN0IGRybV9k
aXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUpCit7CisJc3RydWN0IHp5bnFtcF9kaXNwICpkaXNw
ID0gY3J0Y190b19kaXNwKGNydGMpOworCXVuc2lnbmVkIGxvbmcgbW9kZV9jbG9jayA9IGFkanVz
dGVkX21vZGUtPmNsb2NrICogMTAwMDsKKwl1bnNpZ25lZCBsb25nIHJhdGU7CisJbG9uZyBkaWZm
OworCWludCByZXQ7CisKKwlyZXQgPSBjbGtfc2V0X3JhdGUoZGlzcC0+cGNsaywgbW9kZV9jbG9j
ayk7CisJaWYgKHJldCkgeworCQlkZXZfZXJyKGRpc3AtPmRldiwgImZhaWxlZCB0byBzZXQgYSBw
aXhlbCBjbG9ja1xuIik7CisJCXJldHVybiByZXQ7CisJfQorCisJcmF0ZSA9IGNsa19nZXRfcmF0
ZShkaXNwLT5wY2xrKTsKKwlkaWZmID0gcmF0ZSAtIG1vZGVfY2xvY2s7CisJaWYgKGFicyhkaWZm
KSA+IG1vZGVfY2xvY2sgLyAyMCkKKwkJZGV2X2luZm8oZGlzcC0+ZGV2LAorCQkJICJyZXF1ZXN0
ZWQgcGl4ZWwgcmF0ZTogJWx1IGFjdHVhbCByYXRlOiAlbHVcbiIsCisJCQkgbW9kZV9jbG9jaywg
cmF0ZSk7CisJZWxzZQorCQlkZXZfZGJnKGRpc3AtPmRldiwKKwkJCSJyZXF1ZXN0ZWQgcGl4ZWwg
cmF0ZTogJWx1IGFjdHVhbCByYXRlOiAlbHVcbiIsCisJCQltb2RlX2Nsb2NrLCByYXRlKTsKKwor
CXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZAorenlucW1wX2Rpc3BfY3J0Y19hdG9taWNfZW5h
YmxlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKKwkJCSAgICAgICBzdHJ1Y3QgZHJtX2NydGNfc3Rh
dGUgKm9sZF9jcnRjX3N0YXRlKQoreworCXN0cnVjdCB6eW5xbXBfZGlzcCAqZGlzcCA9IGNydGNf
dG9fZGlzcChjcnRjKTsKKwlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9
ICZjcnRjLT5zdGF0ZS0+YWRqdXN0ZWRfbW9kZTsKKwlpbnQgcmV0LCB2cmVmcmVzaDsKKworCXp5
bnFtcF9kaXNwX2NydGNfc2V0dXBfY2xvY2soY3J0YywgYWRqdXN0ZWRfbW9kZSk7CisKKwlwbV9y
dW50aW1lX2dldF9zeW5jKGRpc3AtPmRldik7CisJcmV0ID0gY2xrX3ByZXBhcmVfZW5hYmxlKGRp
c3AtPnBjbGspOworCWlmIChyZXQpIHsKKwkJZGV2X2VycihkaXNwLT5kZXYsICJmYWlsZWQgdG8g
ZW5hYmxlIGEgcGl4ZWwgY2xvY2tcbiIpOworCQlwbV9ydW50aW1lX3B1dF9zeW5jKGRpc3AtPmRl
dik7CisJCXJldHVybjsKKwl9CisKKwl6eW5xbXBfZGlzcF9ibGVuZF9zZXRfb3V0cHV0X2Zvcm1h
dCgmZGlzcC0+YmxlbmQsCisJCQkJCSAgICBaWU5RTVBfRFBTVUJfRk9STUFUX1JHQik7CisJenlu
cW1wX2Rpc3BfYmxlbmRfc2V0X2JnX2NvbG9yKCZkaXNwLT5ibGVuZCwgMCwgMCwgMCk7CisJenlu
cW1wX2Rpc3BfYmxlbmRfc2V0X2dsb2JhbF9hbHBoYSgmZGlzcC0+YmxlbmQsIGZhbHNlLCAwKTsK
KworCXp5bnFtcF9kaXNwX2VuYWJsZShkaXNwKTsKKworCS8qIERlbGF5IG9mIDMgdmJsYW5rIGlu
dGVydmFscyBmb3IgdGltaW5nIGdlbiB0byBiZSBzdGFibGUgKi8KKwl2cmVmcmVzaCA9IChhZGp1
c3RlZF9tb2RlLT5jbG9jayAqIDEwMDApIC8KKwkJICAgKGFkanVzdGVkX21vZGUtPnZ0b3RhbCAq
IGFkanVzdGVkX21vZGUtPmh0b3RhbCk7CisJbXNsZWVwKDMgKiAxMDAwIC8gdnJlZnJlc2gpOwor
fQorCitzdGF0aWMgdm9pZAorenlucW1wX2Rpc3BfY3J0Y19hdG9taWNfZGlzYWJsZShzdHJ1Y3Qg
ZHJtX2NydGMgKmNydGMsCisJCQkJc3RydWN0IGRybV9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0
ZSkKK3sKKwlzdHJ1Y3QgenlucW1wX2Rpc3AgKmRpc3AgPSBjcnRjX3RvX2Rpc3AoY3J0Yyk7CisK
Kwl6eW5xbXBfZGlzcF9wbGFuZV9hdG9taWNfZGlzYWJsZShjcnRjLT5wcmltYXJ5LCBOVUxMKTsK
Kwl6eW5xbXBfZGlzcF9kaXNhYmxlKGRpc3ApOworCisJZHJtX2NydGNfdmJsYW5rX29mZigmZGlz
cC0+Y3J0Yyk7CisKKwljbGtfZGlzYWJsZV91bnByZXBhcmUoZGlzcC0+cGNsayk7CisJcG1fcnVu
dGltZV9wdXRfc3luYyhkaXNwLT5kZXYpOworfQorCitzdGF0aWMgaW50IHp5bnFtcF9kaXNwX2Ny
dGNfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKKwkJCQkJIHN0cnVjdCBkcm1f
Y3J0Y19zdGF0ZSAqc3RhdGUpCit7CisJcmV0dXJuIGRybV9hdG9taWNfYWRkX2FmZmVjdGVkX3Bs
YW5lcyhzdGF0ZS0+c3RhdGUsIGNydGMpOworfQorCitzdGF0aWMgdm9pZAorenlucW1wX2Rpc3Bf
Y3J0Y19hdG9taWNfYmVnaW4oc3RydWN0IGRybV9jcnRjICpjcnRjLAorCQkJICAgICAgc3RydWN0
IGRybV9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKK3sKKwlkcm1fY3J0Y192Ymxhbmtfb24o
Y3J0Yyk7Cit9CisKK3N0YXRpYyB2b2lkCit6eW5xbXBfZGlzcF9jcnRjX2F0b21pY19mbHVzaChz
dHJ1Y3QgZHJtX2NydGMgKmNydGMsCisJCQkgICAgICBzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKm9s
ZF9jcnRjX3N0YXRlKQoreworCWlmIChjcnRjLT5zdGF0ZS0+ZXZlbnQpIHsKKwkJc3RydWN0IGRy
bV9wZW5kaW5nX3ZibGFua19ldmVudCAqZXZlbnQ7CisKKwkJLyogQ29uc3VtZSB0aGUgZmxpcF9k
b25lIGV2ZW50IGZyb20gYXRvbWljIGhlbHBlci4gKi8KKwkJZXZlbnQgPSBjcnRjLT5zdGF0ZS0+
ZXZlbnQ7CisJCWNydGMtPnN0YXRlLT5ldmVudCA9IE5VTEw7CisKKwkJZXZlbnQtPnBpcGUgPSBk
cm1fY3J0Y19pbmRleChjcnRjKTsKKworCQlXQVJOX09OKGRybV9jcnRjX3ZibGFua19nZXQoY3J0
YykgIT0gMCk7CisKKwkJc3Bpbl9sb2NrX2lycSgmY3J0Yy0+ZGV2LT5ldmVudF9sb2NrKTsKKwkJ
ZHJtX2NydGNfYXJtX3ZibGFua19ldmVudChjcnRjLCBldmVudCk7CisJCXNwaW5fdW5sb2NrX2ly
cSgmY3J0Yy0+ZGV2LT5ldmVudF9sb2NrKTsKKwl9Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3Qg
ZHJtX2NydGNfaGVscGVyX2Z1bmNzIHp5bnFtcF9kaXNwX2NydGNfaGVscGVyX2Z1bmNzID0gewor
CS5hdG9taWNfZW5hYmxlCT0genlucW1wX2Rpc3BfY3J0Y19hdG9taWNfZW5hYmxlLAorCS5hdG9t
aWNfZGlzYWJsZQk9IHp5bnFtcF9kaXNwX2NydGNfYXRvbWljX2Rpc2FibGUsCisJLmF0b21pY19j
aGVjawk9IHp5bnFtcF9kaXNwX2NydGNfYXRvbWljX2NoZWNrLAorCS5hdG9taWNfYmVnaW4JPSB6
eW5xbXBfZGlzcF9jcnRjX2F0b21pY19iZWdpbiwKKwkuYXRvbWljX2ZsdXNoCT0genlucW1wX2Rp
c3BfY3J0Y19hdG9taWNfZmx1c2gsCit9OworCitzdGF0aWMgaW50IHp5bnFtcF9kaXNwX2NydGNf
ZW5hYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCit7CisJc3RydWN0IHp5bnFtcF9k
aXNwICpkaXNwID0gY3J0Y190b19kaXNwKGNydGMpOworCisJenlucW1wX2RwX2VuYWJsZV92Ymxh
bmsoZGlzcC0+ZHBzdWItPmRwKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCB6eW5x
bXBfZGlzcF9jcnRjX2Rpc2FibGVfdmJsYW5rKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykKK3sKKwlz
dHJ1Y3QgenlucW1wX2Rpc3AgKmRpc3AgPSBjcnRjX3RvX2Rpc3AoY3J0Yyk7CisKKwl6eW5xbXBf
ZHBfZGlzYWJsZV92YmxhbmsoZGlzcC0+ZHBzdWItPmRwKTsKK30KKworc3RhdGljIGNvbnN0IHN0
cnVjdCBkcm1fY3J0Y19mdW5jcyB6eW5xbXBfZGlzcF9jcnRjX2Z1bmNzID0geworCS5kZXN0cm95
CQk9IGRybV9jcnRjX2NsZWFudXAsCisJLnNldF9jb25maWcJCT0gZHJtX2F0b21pY19oZWxwZXJf
c2V0X2NvbmZpZywKKwkucGFnZV9mbGlwCQk9IGRybV9hdG9taWNfaGVscGVyX3BhZ2VfZmxpcCwK
KwkucmVzZXQJCQk9IGRybV9hdG9taWNfaGVscGVyX2NydGNfcmVzZXQsCisJLmF0b21pY19kdXBs
aWNhdGVfc3RhdGUJPSBkcm1fYXRvbWljX2hlbHBlcl9jcnRjX2R1cGxpY2F0ZV9zdGF0ZSwKKwku
YXRvbWljX2Rlc3Ryb3lfc3RhdGUJPSBkcm1fYXRvbWljX2hlbHBlcl9jcnRjX2Rlc3Ryb3lfc3Rh
dGUsCisJLmVuYWJsZV92YmxhbmsJCT0genlucW1wX2Rpc3BfY3J0Y19lbmFibGVfdmJsYW5rLAor
CS5kaXNhYmxlX3ZibGFuawkJPSB6eW5xbXBfZGlzcF9jcnRjX2Rpc2FibGVfdmJsYW5rLAorfTsK
Kworc3RhdGljIGludCB6eW5xbXBfZGlzcF9jcmVhdGVfY3J0YyhzdHJ1Y3QgenlucW1wX2Rpc3Ag
KmRpc3ApCit7CisJc3RydWN0IGRybV9wbGFuZSAqcGxhbmUgPSAmZGlzcC0+bGF5ZXJzW1pZTlFN
UF9ESVNQX0xBWUVSX0dGWF0ucGxhbmU7CisJaW50IHJldDsKKworCXJldCA9IGRybV9jcnRjX2lu
aXRfd2l0aF9wbGFuZXMoZGlzcC0+ZHJtLCAmZGlzcC0+Y3J0YywgcGxhbmUsCisJCQkJCU5VTEws
ICZ6eW5xbXBfZGlzcF9jcnRjX2Z1bmNzLCBOVUxMKTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0dXJu
IHJldDsKKworCWRybV9jcnRjX2hlbHBlcl9hZGQoJmRpc3AtPmNydGMsICZ6eW5xbXBfZGlzcF9j
cnRjX2hlbHBlcl9mdW5jcyk7CisKKwkvKiBTdGFydCB3aXRoIHZlcnRpY2FsIGJsYW5raW5nIGlu
dGVycnVwdCByZXBvcnRpbmcgZGlzYWJsZWQuICovCisJZHJtX2NydGNfdmJsYW5rX29mZigmZGlz
cC0+Y3J0Yyk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgenlucW1wX2Rpc3BfbWFw
X2NydGNfdG9fcGxhbmUoc3RydWN0IHp5bnFtcF9kaXNwICpkaXNwKQoreworCXUzMiBwb3NzaWJs
ZV9jcnRjcyA9IGRybV9jcnRjX21hc2soJmRpc3AtPmNydGMpOworCXVuc2lnbmVkIGludCBpOwor
CisJZm9yIChpID0gMDsgaSA8IFpZTlFNUF9ESVNQX05VTV9MQVlFUlM7IGkrKykKKwkJZGlzcC0+
bGF5ZXJzW2ldLnBsYW5lLnBvc3NpYmxlX2NydGNzID0gcG9zc2libGVfY3J0Y3M7Cit9CisKKy8q
IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tCisgKiBJbml0aWFsaXphdGlvbiAmIENsZWFudXAKKyAqLwor
CitpbnQgenlucW1wX2Rpc3BfaW5pdChzdHJ1Y3QgenlucW1wX2Rwc3ViICpkcHN1Yiwgc3RydWN0
IGRybV9kZXZpY2UgKmRybSkKK3sKKwlzdHJ1Y3QgenlucW1wX2Rpc3AgKmRpc3AgPSBkcHN1Yi0+
ZGlzcDsKKwlpbnQgcmV0OworCisJZGlzcC0+ZHJtID0gZHJtOworCisJcmV0ID0genlucW1wX2Rp
c3BfY3JlYXRlX3BsYW5lcyhkaXNwKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJcmV0
ID0genlucW1wX2Rpc3BfY3JlYXRlX2NydGMoZGlzcCk7CisJaWYgKHJldCA8IDApCisJCXJldHVy
biByZXQ7CisKKwl6eW5xbXBfZGlzcF9tYXBfY3J0Y190b19wbGFuZShkaXNwKTsKKworCXJldHVy
biAwOworfQorCitpbnQgenlucW1wX2Rpc3BfcHJvYmUoc3RydWN0IHp5bnFtcF9kcHN1YiAqZHBz
dWIsIHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpCit7CisJc3RydWN0IHp5bnFtcF9kaXNw
ICpkaXNwOworCXN0cnVjdCB6eW5xbXBfZGlzcF9sYXllciAqbGF5ZXI7CisJc3RydWN0IHJlc291
cmNlICpyZXM7CisJaW50IHJldDsKKworCWRpc3AgPSBkZXZtX2t6YWxsb2MoJnBkZXYtPmRldiwg
c2l6ZW9mKCpkaXNwKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFkaXNwKQorCQlyZXR1cm4gLUVOT01F
TTsKKwlkaXNwLT5kZXYgPSAmcGRldi0+ZGV2OworCisJcmVzID0gcGxhdGZvcm1fZ2V0X3Jlc291
cmNlX2J5bmFtZShwZGV2LCBJT1JFU09VUkNFX01FTSwgImJsZW5kIik7CisJZGlzcC0+YmxlbmQu
YmFzZSA9IGRldm1faW9yZW1hcF9yZXNvdXJjZSgmcGRldi0+ZGV2LCByZXMpOworCWlmIChJU19F
UlIoZGlzcC0+YmxlbmQuYmFzZSkpCisJCXJldHVybiBQVFJfRVJSKGRpc3AtPmJsZW5kLmJhc2Up
OworCisJcmVzID0gcGxhdGZvcm1fZ2V0X3Jlc291cmNlX2J5bmFtZShwZGV2LCBJT1JFU09VUkNF
X01FTSwgImF2X2J1ZiIpOworCWRpc3AtPmF2YnVmLmJhc2UgPSBkZXZtX2lvcmVtYXBfcmVzb3Vy
Y2UoJnBkZXYtPmRldiwgcmVzKTsKKwlpZiAoSVNfRVJSKGRpc3AtPmF2YnVmLmJhc2UpKQorCQly
ZXR1cm4gUFRSX0VSUihkaXNwLT5hdmJ1Zi5iYXNlKTsKKworCXJlcyA9IHBsYXRmb3JtX2dldF9y
ZXNvdXJjZV9ieW5hbWUocGRldiwgSU9SRVNPVVJDRV9NRU0sICJhdWQiKTsKKwlkaXNwLT5hdWRp
by5iYXNlID0gZGV2bV9pb3JlbWFwX3Jlc291cmNlKCZwZGV2LT5kZXYsIHJlcyk7CisJaWYgKElT
X0VSUihkaXNwLT5hdWRpby5iYXNlKSkKKwkJcmV0dXJuIFBUUl9FUlIoZGlzcC0+YXVkaW8uYmFz
ZSk7CisKKwlkcHN1Yi0+ZGlzcCA9IGRpc3A7CisJZGlzcC0+ZHBzdWIgPSBkcHN1YjsKKworCS8q
IFRyeSB0aGUgbGl2ZSBQTCB2aWRlbyBjbG9jayAqLworCWRpc3AtPl9wbF9wY2xrID0gZGV2bV9j
bGtfZ2V0KGRpc3AtPmRldiwgImRwX2xpdmVfdmlkZW9faW5fY2xrIik7CisJaWYgKCFJU19FUlIo
ZGlzcC0+X3BsX3BjbGspKQorCQlkaXNwLT5wY2xrID0gZGlzcC0+X3BsX3BjbGs7CisJZWxzZSBp
ZiAoUFRSX0VSUihkaXNwLT5fcGxfcGNsaykgPT0gLUVQUk9CRV9ERUZFUikKKwkJcmV0dXJuIFBU
Ul9FUlIoZGlzcC0+X3BsX3BjbGspOworCisJLyogSWYgdGhlIGxpdmUgUEwgdmlkZW8gY2xvY2sg
aXMgbm90IHZhbGlkLCBmYWxsIGJhY2sgdG8gUFMgY2xvY2sgKi8KKwlpZiAoIWRpc3AtPnBjbGsp
IHsKKwkJZGlzcC0+X3BzX3BjbGsgPSBkZXZtX2Nsa19nZXQoZGlzcC0+ZGV2LCAiZHBfdnRjX3Bp
eGVsX2Nsa19pbiIpOworCQlpZiAoSVNfRVJSKGRpc3AtPl9wc19wY2xrKSkgeworCQkJZGV2X2Vy
cihkaXNwLT5kZXYsICJmYWlsZWQgdG8gaW5pdCBhbnkgdmlkZW8gY2xvY2tcbiIpOworCQkJcmV0
dXJuIFBUUl9FUlIoZGlzcC0+X3BzX3BjbGspOworCQl9CisJCWRpc3AtPnBjbGsgPSBkaXNwLT5f
cHNfcGNsazsKKwl9CisKKwl6eW5xbXBfZGlzcF9hdWRpb19pbml0KGRpc3AtPmRldiwgJmRpc3At
PmF1ZGlvKTsKKworCXJldCA9IHp5bnFtcF9kaXNwX2NyZWF0ZV9sYXllcnMoZGlzcCk7CisJaWYg
KHJldCkKKwkJcmV0dXJuIHJldDsKKworCWxheWVyID0gJmRpc3AtPmxheWVyc1taWU5RTVBfRElT
UF9MQVlFUl9WSURdOworCWRwc3ViLT5hbGlnbiA9IDEgPDwgbGF5ZXItPmRtYXNbMF0uY2hhbi0+
ZGV2aWNlLT5jb3B5X2FsaWduOworCisJcmV0dXJuIDA7Cit9CisKK3ZvaWQgenlucW1wX2Rpc3Bf
cmVtb3ZlKHN0cnVjdCB6eW5xbXBfZHBzdWIgKmRwc3ViKQoreworCXN0cnVjdCB6eW5xbXBfZGlz
cCAqZGlzcCA9IGRwc3ViLT5kaXNwOworCisJenlucW1wX2Rpc3BfZGVzdHJveV9sYXllcnMoZGlz
cCk7CisJZHBzdWItPmRpc3AgPSBOVUxMOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L3hsbngvenlucW1wX2Rpc3AuaCBiL2RyaXZlcnMvZ3B1L2RybS94bG54L3p5bnFtcF9kaXNwLmgK
bmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi45M2FkMzZhZDdlZjMKLS0t
IC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZGlzcC5oCkBAIC0w
LDAgKzEsNDMgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovCisvKgor
ICogWnlucU1QIERpc3BsYXkgRHJpdmVyCisgKgorICogQ29weXJpZ2h0IChDKSAyMDE3IC0gMjAx
OSBYaWxpbngsIEluYy4KKyAqCisgKiBBdXRob3JzOgorICogLSBIeXVuIFdvbyBLd29uIDxoeXVu
Lmt3b25AeGlsaW54LmNvbT4KKyAqIC0gTGF1cmVudCBQaW5jaGFydCA8bGF1cmVudC5waW5jaGFy
dEBpZGVhc29uYm9hcmQuY29tPgorICovCisKKyNpZm5kZWYgX1pZTlFNUF9ESVNQX0hfCisjZGVm
aW5lIF9aWU5RTVBfRElTUF9IXworCisjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KKworLyoKKyAq
IDM4NDB4MjE2MCBpcyBhZHZlcnRpc2VkIGFzIHRoZSBtYXhpbXVtIHJlc29sdXRpb24sIGJ1dCBh
bG1vc3QgYW55CisgKiByZXNvbHV0aW9ucyB1bmRlciBhIDMwME1oeiBwaXhlbCByYXRlIHdvdWxk
IHdvcmsuIFBpY2sgNDA5Nng0MDk2LgorICovCisjZGVmaW5lIFpZTlFNUF9ESVNQX01BWF9XSURU
SAkJCQk0MDk2CisjZGVmaW5lIFpZTlFNUF9ESVNQX01BWF9IRUlHSFQJCQkJNDA5NgorCisvKiBU
aGUgRFBETUEgaXMgbGltaXRlZCB0byA0NCBiaXQgYWRkcmVzc2luZy4gKi8KKyNkZWZpbmUgWllO
UU1QX0RJU1BfTUFYX0RNQV9CSVQJCQkJNDQKKworc3RydWN0IGRldmljZTsKK3N0cnVjdCBkcm1f
ZGV2aWNlOworc3RydWN0IHBsYXRmb3JtX2RldmljZTsKK3N0cnVjdCB6eW5xbXBfZGlzcDsKK3N0
cnVjdCB6eW5xbXBfZHBzdWI7CisKK3ZvaWQgenlucW1wX2Rpc3BfaGFuZGxlX3ZibGFuayhzdHJ1
Y3QgenlucW1wX2Rpc3AgKmRpc3ApOworYm9vbCB6eW5xbXBfZGlzcF9hdWRpb19lbmFibGVkKHN0
cnVjdCB6eW5xbXBfZGlzcCAqZGlzcCk7Cit1bnNpZ25lZCBpbnQgenlucW1wX2Rpc3BfZ2V0X2F1
ZGlvX2Nsa19yYXRlKHN0cnVjdCB6eW5xbXBfZGlzcCAqZGlzcCk7Cit1aW50MzJfdCB6eW5xbXBf
ZGlzcF9nZXRfY3J0Y19tYXNrKHN0cnVjdCB6eW5xbXBfZGlzcCAqZGlzcCk7CisKK2ludCB6eW5x
bXBfZGlzcF9pbml0KHN0cnVjdCB6eW5xbXBfZHBzdWIgKmRwc3ViLCBzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZHJtKTsKKworaW50IHp5bnFtcF9kaXNwX3Byb2JlKHN0cnVjdCB6eW5xbXBfZHBzdWIgKmRw
c3ViLCBzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KTsKK3ZvaWQgenlucW1wX2Rpc3BfcmVt
b3ZlKHN0cnVjdCB6eW5xbXBfZHBzdWIgKmRwc3ViKTsKKworI2VuZGlmIC8qIF9aWU5RTVBfRElT
UF9IXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rpc3BfcmVn
cy5oIGIvZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rpc3BfcmVncy5oCm5ldyBmaWxlIG1v
ZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uYzkyZTJjMmJkMjJlCi0tLSAvZGV2L251bGwK
KysrIGIvZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rpc3BfcmVncy5oCkBAIC0wLDAgKzEs
MjAxIEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCAqLworLyoKKyAqIFp5
bnFNUCBEaXNwbGF5IENvbnRyb2xsZXIgRHJpdmVyIC0gUmVnaXN0ZXIgRGVmaW5pdGlvbnMKKyAq
CisgKiBDb3B5cmlnaHQgKEMpIDIwMTcgLSAyMDE5IFhpbGlueCwgSW5jLgorICoKKyAqIEF1dGhv
cnM6CisgKiAtIEh5dW4gV29vIEt3b24gPGh5dW4ua3dvbkB4aWxpbnguY29tPgorICogLSBMYXVy
ZW50IFBpbmNoYXJ0IDxsYXVyZW50LnBpbmNoYXJ0QGlkZWFzb25ib2FyZC5jb20+CisgKi8KKwor
I2lmbmRlZiBfWllOUU1QX0RJU1BfUkVHU19IXworI2RlZmluZSBfWllOUU1QX0RJU1BfUkVHU19I
XworCisjaW5jbHVkZSA8bGludXgvYml0cy5oPgorCisvKiBCbGVuZGVyIHJlZ2lzdGVycyAqLwor
I2RlZmluZSBaWU5RTVBfRElTUF9WX0JMRU5EX0JHX0NMUl8wCQkJMHgwCisjZGVmaW5lIFpZTlFN
UF9ESVNQX1ZfQkxFTkRfQkdfQ0xSXzEJCQkweDQKKyNkZWZpbmUgWllOUU1QX0RJU1BfVl9CTEVO
RF9CR19DTFJfMgkJCTB4OAorI2RlZmluZSBaWU5RTVBfRElTUF9WX0JMRU5EX0JHX01BWAkJCTB4
ZmZmCisjZGVmaW5lIFpZTlFNUF9ESVNQX1ZfQkxFTkRfU0VUX0dMT0JBTF9BTFBIQQkJMHhjCisj
ZGVmaW5lIFpZTlFNUF9ESVNQX1ZfQkxFTkRfU0VUX0dMT0JBTF9BTFBIQV9WQUxVRShuKQkoKG4p
IDw8IDEpCisjZGVmaW5lIFpZTlFNUF9ESVNQX1ZfQkxFTkRfU0VUX0dMT0JBTF9BTFBIQV9FTgkJ
QklUKDApCisjZGVmaW5lIFpZTlFNUF9ESVNQX1ZfQkxFTkRfT1VUUFVUX1ZJRF9GTVQJCTB4MTQK
KyNkZWZpbmUgWllOUU1QX0RJU1BfVl9CTEVORF9PVVRQVVRfVklEX0ZNVF9SR0IJCTB4MAorI2Rl
ZmluZSBaWU5RTVBfRElTUF9WX0JMRU5EX09VVFBVVF9WSURfRk1UX1lDQkNSNDQ0CTB4MQorI2Rl
ZmluZSBaWU5RTVBfRElTUF9WX0JMRU5EX09VVFBVVF9WSURfRk1UX1lDQkNSNDIyCTB4MgorI2Rl
ZmluZSBaWU5RTVBfRElTUF9WX0JMRU5EX09VVFBVVF9WSURfRk1UX1lPTkxZCTB4MworI2RlZmlu
ZSBaWU5RTVBfRElTUF9WX0JMRU5EX09VVFBVVF9WSURfRk1UX1hWWUNDCTB4NAorI2RlZmluZSBa
WU5RTVBfRElTUF9WX0JMRU5EX09VVFBVVF9WSURfRk1UX0VOX0RPV05TQU1QTEUJQklUKDQpCisj
ZGVmaW5lIFpZTlFNUF9ESVNQX1ZfQkxFTkRfTEFZRVJfQ09OVFJPTChuKQkJKDB4MTggKyAoKG4p
ICogNCkpCisjZGVmaW5lIFpZTlFNUF9ESVNQX1ZfQkxFTkRfTEFZRVJfQ09OVFJPTF9FTl9VUwkJ
QklUKDApCisjZGVmaW5lIFpZTlFNUF9ESVNQX1ZfQkxFTkRfTEFZRVJfQ09OVFJPTF9SR0IJCUJJ
VCgxKQorI2RlZmluZSBaWU5RTVBfRElTUF9WX0JMRU5EX0xBWUVSX0NPTlRST0xfQllQQVNTCUJJ
VCg4KQorI2RlZmluZSBaWU5RTVBfRElTUF9WX0JMRU5EX05VTV9DT0VGRgkJCTkKKyNkZWZpbmUg
WllOUU1QX0RJU1BfVl9CTEVORF9OVU1fT0ZGU0VUCQkJMworI2RlZmluZSBaWU5RTVBfRElTUF9W
X0JMRU5EX1JHQjJZQ0JDUl9DT0VGRihuKQkJKDB4MjAgKyAoKG4pICogNCkpCisjZGVmaW5lIFpZ
TlFNUF9ESVNQX1ZfQkxFTkRfSU4xQ1NDX0NPRUZGKG4pCQkoMHg0NCArICgobikgKiA0KSkKKyNk
ZWZpbmUgWllOUU1QX0RJU1BfVl9CTEVORF9JTjFDU0NfT0ZGU0VUKG4pCQkoMHg2OCArICgobikg
KiA0KSkKKyNkZWZpbmUgWllOUU1QX0RJU1BfVl9CTEVORF9PVVRDU0NfT0ZGU0VUKG4pCQkoMHg3
NCArICgobikgKiA0KSkKKyNkZWZpbmUgWllOUU1QX0RJU1BfVl9CTEVORF9JTjJDU0NfQ09FRkYo
bikJCSgweDgwICsgKChuKSAqIDQpKQorI2RlZmluZSBaWU5RTVBfRElTUF9WX0JMRU5EX0lOMkNT
Q19PRkZTRVQobikJCSgweGE0ICsgKChuKSAqIDQpKQorI2RlZmluZSBaWU5RTVBfRElTUF9WX0JM
RU5EX0NIUk9NQV9LRVlfRU5BQkxFCQkweDFkMAorI2RlZmluZSBaWU5RTVBfRElTUF9WX0JMRU5E
X0NIUk9NQV9LRVlfQ09NUDEJCTB4MWQ0CisjZGVmaW5lIFpZTlFNUF9ESVNQX1ZfQkxFTkRfQ0hS
T01BX0tFWV9DT01QMgkJMHgxZDgKKyNkZWZpbmUgWllOUU1QX0RJU1BfVl9CTEVORF9DSFJPTUFf
S0VZX0NPTVAzCQkweDFkYworCisvKiBBViBidWZmZXIgbWFuYWdlciByZWdpc3RlcnMgKi8KKyNk
ZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVAkJCQkweDAKKyNkZWZpbmUgWllOUU1QX0RJU1Bf
QVZfQlVGX0ZNVF9OTF9WSURfU0hJRlQJCTAKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZN
VF9OTF9WSURfTUFTSwkJKDB4MWYgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZN
VF9OTF9WSURfVVlWWQkJKDAgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9O
TF9WSURfVllVWQkJKDEgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9W
SURfWVZZVQkJKDIgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURf
WVVZVgkJKDMgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVYx
NgkJKDQgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVYyNAkJ
KDUgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVYxNkNJCQko
NiA8PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9NT05PCQkoNyA8
PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9ZVjE2Q0kyCQkoOCA8
PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9ZVVY0NDQJCSg5IDw8
IDApCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1JHQjg4OAkJKDEwIDw8
IDApCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1JHQkE4ODgwCQkoMTEg
PDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfUkdCODg4XzEwCQko
MTIgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVVWNDQ0XzEw
CQkoMTMgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVYxNkNJ
Ml8xMAkoMTQgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVYx
NkNJXzEwCQkoMTUgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURf
WVYxNl8xMAkJKDE2IDw8IDApCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklE
X1lWMjRfMTAJCSgxNyA8PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJ
RF9ZT05MWV8xMAkJKDE4IDw8IDApCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxf
VklEX1lWMTZfNDIwCQkoMTkgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9O
TF9WSURfWVYxNkNJXzQyMAkoMjAgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZN
VF9OTF9WSURfWVYxNkNJMl80MjAJKDIxIDw8IDApCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JV
Rl9GTVRfTkxfVklEX1lWMTZfNDIwXzEwCSgyMiA8PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9B
Vl9CVUZfRk1UX05MX1ZJRF9ZVjE2Q0lfNDIwXzEwCSgyMyA8PCAwKQorI2RlZmluZSBaWU5RTVBf
RElTUF9BVl9CVUZfRk1UX05MX1ZJRF9ZVjE2Q0kyXzQyMF8xMAkoMjQgPDwgMCkKKyNkZWZpbmUg
WllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9HRlhfU0hJRlQJCTgKKyNkZWZpbmUgWllOUU1QX0RJ
U1BfQVZfQlVGX0ZNVF9OTF9HRlhfTUFTSwkJKDB4ZiA8PCA4KQorI2RlZmluZSBaWU5RTVBfRElT
UF9BVl9CVUZfRk1UX05MX0dGWF9SR0JBODg4OAkJKDAgPDwgOCkKKyNkZWZpbmUgWllOUU1QX0RJ
U1BfQVZfQlVGX0ZNVF9OTF9HRlhfQUJHUjg4ODgJCSgxIDw8IDgpCisjZGVmaW5lIFpZTlFNUF9E
SVNQX0FWX0JVRl9GTVRfTkxfR0ZYX1JHQjg4OAkJKDIgPDwgOCkKKyNkZWZpbmUgWllOUU1QX0RJ
U1BfQVZfQlVGX0ZNVF9OTF9HRlhfQkdSODg4CQkoMyA8PCA4KQorI2RlZmluZSBaWU5RTVBfRElT
UF9BVl9CVUZfRk1UX05MX0dGWF9SR0JBNTU1MQkJKDQgPDwgOCkKKyNkZWZpbmUgWllOUU1QX0RJ
U1BfQVZfQlVGX0ZNVF9OTF9HRlhfUkdCQTQ0NDQJCSg1IDw8IDgpCisjZGVmaW5lIFpZTlFNUF9E
SVNQX0FWX0JVRl9GTVRfTkxfR0ZYX1JHQjU2NQkJKDYgPDwgOCkKKyNkZWZpbmUgWllOUU1QX0RJ
U1BfQVZfQlVGX0ZNVF9OTF9HRlhfOEJQUAkJKDcgPDwgOCkKKyNkZWZpbmUgWllOUU1QX0RJU1Bf
QVZfQlVGX0ZNVF9OTF9HRlhfNEJQUAkJKDggPDwgOCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZf
QlVGX0ZNVF9OTF9HRlhfMkJQUAkJKDkgPDwgOCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVG
X0ZNVF9OTF9HRlhfMUJQUAkJKDEwIDw8IDgpCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9O
T05fTElWRV9MQVRFTkNZCQkweDgKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0NIQlVGKG4p
CQkJKDB4MTAgKyAoKG4pICogNCkpCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9DSEJVRl9F
TgkJCUJJVCgwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfQ0hCVUZfRkxVU0gJCQlCSVQo
MSkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0NIQlVGX0JVUlNUX0xFTl9TSElGVAkyCisj
ZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9DSEJVRl9CVVJTVF9MRU5fTUFTSwkJKDB4ZiA8PCAy
KQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfQ0hCVUZfQlVSU1RfTEVOX01BWAkJMHhmCisj
ZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9DSEJVRl9CVVJTVF9MRU5fQVVEX01BWAkweDMKKyNk
ZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX1NUQVRVUwkJCTB4MjgKKyNkZWZpbmUgWllOUU1QX0RJ
U1BfQVZfQlVGX1NUQ19DVFJMCQkJMHgyYworI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfU1RD
X0NUUkxfRU4JCQlCSVQoMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX1NUQ19DVFJMX0VW
RU5UX1NISUZUCQkxCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9TVENfQ1RSTF9FVkVOVF9F
WF9WU1lOQwkwCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9TVENfQ1RSTF9FVkVOVF9FWF9W
SUQJMQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfU1RDX0NUUkxfRVZFTlRfRVhfQVVECTIK
KyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX1NUQ19DVFJMX0VWRU5UX0lOVF9WU1lOQwkzCisj
ZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9TVENfSU5JVF9WQUxVRTAJCTB4MzAKKyNkZWZpbmUg
WllOUU1QX0RJU1BfQVZfQlVGX1NUQ19JTklUX1ZBTFVFMQkJMHgzNAorI2RlZmluZSBaWU5RTVBf
RElTUF9BVl9CVUZfU1RDX0FESgkJCTB4MzgKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX1NU
Q19WSURfVlNZTkNfVFMwCQkweDNjCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9TVENfVklE
X1ZTWU5DX1RTMQkJMHg0MAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfU1RDX0VYVF9WU1lO
Q19UUzAJCTB4NDQKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX1NUQ19FWFRfVlNZTkNfVFMx
CQkweDQ4CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9TVENfQ1VTVE9NX0VWRU5UX1RTMAkJ
MHg0YworI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfU1RDX0NVU1RPTV9FVkVOVF9UUzEJCTB4
NTAKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX1NUQ19DVVNUT01fRVZFTlQyX1RTMAkweDU0
CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9TVENfQ1VTVE9NX0VWRU5UMl9UUzEJMHg1OAor
I2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfU1RDX1NOQVBTSE9UMAkJMHg2MAorI2RlZmluZSBa
WU5RTVBfRElTUF9BVl9CVUZfU1RDX1NOQVBTSE9UMQkJMHg2NAorI2RlZmluZSBaWU5RTVBfRElT
UF9BVl9CVUZfT1VUUFVUCQkJMHg3MAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVU
X1ZJRDFfU0hJRlQJCTAKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9WSUQxX01B
U0sJCSgweDMgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9WSUQxX0xJ
VkUJCSgwIDw8IDApCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfVklEMV9NRU0J
CSgxIDw8IDApCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfVklEMV9QQVRURVJO
CQkoMiA8PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVUX1ZJRDFfTk9ORQkJ
KDMgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9WSUQyX1NISUZUCQky
CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfVklEMl9NQVNLCQkoMHgzIDw8IDIp
CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfVklEMl9ESVNBQkxFCQkoMCA8PCAy
KQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVUX1ZJRDJfTUVNCQkoMSA8PCAyKQor
I2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVUX1ZJRDJfTElWRQkJKDIgPDwgMikKKyNk
ZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9WSUQyX05PTkUJCSgzIDw8IDIpCisjZGVm
aW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfQVVEMV9TSElGVAkJNAorI2RlZmluZSBaWU5R
TVBfRElTUF9BVl9CVUZfT1VUUFVUX0FVRDFfTUFTSwkJKDB4MyA8PCA0KQorI2RlZmluZSBaWU5R
TVBfRElTUF9BVl9CVUZfT1VUUFVUX0FVRDFfUEwJCSgwIDw8IDQpCisjZGVmaW5lIFpZTlFNUF9E
SVNQX0FWX0JVRl9PVVRQVVRfQVVEMV9NRU0JCSgxIDw8IDQpCisjZGVmaW5lIFpZTlFNUF9ESVNQ
X0FWX0JVRl9PVVRQVVRfQVVEMV9QQVRURVJOCQkoMiA8PCA0KQorI2RlZmluZSBaWU5RTVBfRElT
UF9BVl9CVUZfT1VUUFVUX0FVRDFfRElTQUJMRQkJKDMgPDwgNCkKKyNkZWZpbmUgWllOUU1QX0RJ
U1BfQVZfQlVGX09VVFBVVF9BVUQyX0VOCQlCSVQoNikKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZf
QlVGX0hDT1VOVF9WQ09VTlRfSU5UMAkJMHg3NAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZf
SENPVU5UX1ZDT1VOVF9JTlQxCQkweDc4CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9QQVRU
RVJOX0dFTl9TRUxFQ1QJCTB4MTAwCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9DTEtfU1JD
CQkJMHgxMjAKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0NMS19TUkNfVklEX0ZST01fUFMJ
CUJJVCgwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfQ0xLX1NSQ19BVURfRlJPTV9QUwkJ
QklUKDEpCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9DTEtfU1JDX1ZJRF9JTlRFUk5BTF9U
SU1JTkcJQklUKDIpCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9TUlNUX1JFRwkJCTB4MTI0
CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9TUlNUX1JFR19WSURfUlNUCQlCSVQoMSkKKyNk
ZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0FVRElPX0NIX0NPTkZJRwkJMHgxMmMKKyNkZWZpbmUg
WllOUU1QX0RJU1BfQVZfQlVGX0dGWF9DT01QX1NGKG4pCQkoMHgyMDAgKyAoKG4pICogNCkpCisj
ZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9WSURfQ09NUF9TRihuKQkJKDB4MjBjICsgKChuKSAq
IDQpKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfTElWRF9WSURfQ09NUF9TRihuKQkJKDB4
MjE4ICsgKChuKSAqIDQpKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfTElWRV9WSURfQ09O
RklHCQkweDIyNAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfTElWRF9HRlhfQ09NUF9TRihu
KQkJKDB4MjI4ICsgKChuKSAqIDQpKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfTElWRV9H
RlhfQ09ORklHCQkweDIzNAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfNEJJVF9TRgkJCTB4
MTExMTEKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGXzVCSVRfU0YJCQkweDEwODQyCisjZGVm
aW5lIFpZTlFNUF9ESVNQX0FWX0JVRl82QklUX1NGCQkJMHgxMDQxMAorI2RlZmluZSBaWU5RTVBf
RElTUF9BVl9CVUZfOEJJVF9TRgkJCTB4MTAxMDEKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVG
XzEwQklUX1NGCQkJMHgxMDA0MAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfTlVMTF9TRgkJ
CTAKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX05VTV9TRgkJCTMKKyNkZWZpbmUgWllOUU1Q
X0RJU1BfQVZfQlVGX0xJVkVfQ09ORklHX0JQQ182CQkweDAKKyNkZWZpbmUgWllOUU1QX0RJU1Bf
QVZfQlVGX0xJVkVfQ09ORklHX0JQQ184CQkweDEKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVG
X0xJVkVfQ09ORklHX0JQQ18xMAkJMHgyCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9MSVZF
X0NPTkZJR19CUENfMTIJCTB4MworI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfTElWRV9DT05G
SUdfQlBDX01BU0sJCUdFTk1BU0soMiwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0xJ
VkVfQ09ORklHX0ZNVF9SR0IJCTB4MAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfTElWRV9D
T05GSUdfRk1UX1lVVjQ0NAkweDEKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0xJVkVfQ09O
RklHX0ZNVF9ZVVY0MjIJMHgyCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9MSVZFX0NPTkZJ
R19GTVRfWU9OTFkJMHgzCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9MSVZFX0NPTkZJR19G
TVRfTUFTSwkJR0VOTUFTSyg1LCA0KQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfTElWRV9D
T05GSUdfQ0JfRklSU1QJCUJJVCg4KQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfUEFMRVRU
RV9NRU1PUlkJCTB4NDAwCisKKy8qIEF1ZGlvIHJlZ2lzdGVycyAqLworI2RlZmluZSBaWU5RTVBf
RElTUF9BVURfTUlYRVJfVk9MVU1FCQkJMHgwCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FVRF9NSVhF
Ul9WT0xVTUVfTk9fU0NBTEUJCTB4MjAwMDIwMDAKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVVEX01J
WEVSX01FVEFfREFUQQkJCTB4NAorI2RlZmluZSBaWU5RTVBfRElTUF9BVURfQ0hfU1RBVFVTMAkJ
CTB4OAorI2RlZmluZSBaWU5RTVBfRElTUF9BVURfQ0hfU1RBVFVTMQkJCTB4YworI2RlZmluZSBa
WU5RTVBfRElTUF9BVURfQ0hfU1RBVFVTMgkJCTB4MTAKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVVE
X0NIX1NUQVRVUzMJCQkweDE0CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FVRF9DSF9TVEFUVVM0CQkJ
MHgxOAorI2RlZmluZSBaWU5RTVBfRElTUF9BVURfQ0hfU1RBVFVTNQkJCTB4MWMKKyNkZWZpbmUg
WllOUU1QX0RJU1BfQVVEX0NIX0FfREFUQTAJCQkweDIwCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FV
RF9DSF9BX0RBVEExCQkJMHgyNAorI2RlZmluZSBaWU5RTVBfRElTUF9BVURfQ0hfQV9EQVRBMgkJ
CTB4MjgKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVVEX0NIX0FfREFUQTMJCQkweDJjCisjZGVmaW5l
IFpZTlFNUF9ESVNQX0FVRF9DSF9BX0RBVEE0CQkJMHgzMAorI2RlZmluZSBaWU5RTVBfRElTUF9B
VURfQ0hfQV9EQVRBNQkJCTB4MzQKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVVEX0NIX0JfREFUQTAJ
CQkweDM4CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FVRF9DSF9CX0RBVEExCQkJMHgzYworI2RlZmlu
ZSBaWU5RTVBfRElTUF9BVURfQ0hfQl9EQVRBMgkJCTB4NDAKKyNkZWZpbmUgWllOUU1QX0RJU1Bf
QVVEX0NIX0JfREFUQTMJCQkweDQ0CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FVRF9DSF9CX0RBVEE0
CQkJMHg0OAorI2RlZmluZSBaWU5RTVBfRElTUF9BVURfQ0hfQl9EQVRBNQkJCTB4NGMKKyNkZWZp
bmUgWllOUU1QX0RJU1BfQVVEX1NPRlRfUkVTRVQJCQkweGMwMAorI2RlZmluZSBaWU5RTVBfRElT
UF9BVURfU09GVF9SRVNFVF9BVURfU1JTVAkJQklUKDApCisKKyNlbmRpZiAvKiBfWllOUU1QX0RJ
U1BfUkVHU19IXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rw
LmMgYi9kcml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZHAuYwpuZXcgZmlsZSBtb2RlIDEwMDY0
NAppbmRleCAwMDAwMDAwMDAwMDAuLmEzOTk3NTE4NTU4NAotLS0gL2Rldi9udWxsCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS94bG54L3p5bnFtcF9kcC5jCkBAIC0wLDAgKzEsMTY3NyBAQAorLy8gU1BE
WC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAKKy8qCisgKiBaeW5xTVAgRGlzcGxheVBvcnQg
RHJpdmVyCisgKgorICogQ29weXJpZ2h0IChDKSAyMDE3IC0gMjAxOSBYaWxpbngsIEluYy4KKyAq
CisgKiBBdXRob3JzOgorICogLSBIeXVuIFdvbyBLd29uIDxoeXVuLmt3b25AeGlsaW54LmNvbT4K
KyAqIC0gTGF1cmVudCBQaW5jaGFydCA8bGF1cmVudC5waW5jaGFydEBpZGVhc29uYm9hcmQuY29t
PgorICovCisKKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pY19oZWxwZXIuaD4KKyNpbmNsdWRlIDxk
cm0vZHJtX2Nvbm5lY3Rvci5oPgorI2luY2x1ZGUgPGRybS9kcm1fY3J0Yy5oPgorI2luY2x1ZGUg
PGRybS9kcm1fZGV2aWNlLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9kcF9oZWxwZXIuaD4KKyNpbmNs
dWRlIDxkcm0vZHJtX2VkaWQuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2VuY29kZXIuaD4KKyNpbmNs
dWRlIDxkcm0vZHJtX21vZGVzLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9vZi5oPgorI2luY2x1ZGUg
PGRybS9kcm1fcHJvYmVfaGVscGVyLmg+CisKKyNpbmNsdWRlIDxsaW51eC9jbGsuaD4KKyNpbmNs
dWRlIDxsaW51eC9kZWxheS5oPgorI2luY2x1ZGUgPGxpbnV4L2RldmljZS5oPgorI2luY2x1ZGUg
PGxpbnV4L21vZHVsZS5oPgorI2luY2x1ZGUgPGxpbnV4L3BsYXRmb3JtX2RldmljZS5oPgorI2lu
Y2x1ZGUgPGxpbnV4L3BtX3J1bnRpbWUuaD4KKyNpbmNsdWRlIDxsaW51eC9waHkvcGh5Lmg+CisK
KyNpbmNsdWRlICJ6eW5xbXBfZGlzcC5oIgorI2luY2x1ZGUgInp5bnFtcF9kcC5oIgorI2luY2x1
ZGUgInp5bnFtcF9kcHN1Yi5oIgorCitzdGF0aWMgdWludCB6eW5xbXBfZHBfYXV4X3RpbWVvdXRf
bXMgPSA1MDsKK21vZHVsZV9wYXJhbV9uYW1lZChhdXhfdGltZW91dF9tcywgenlucW1wX2RwX2F1
eF90aW1lb3V0X21zLCB1aW50LCAwNDQ0KTsKK01PRFVMRV9QQVJNX0RFU0MoYXV4X3RpbWVvdXRf
bXMsICJEUCBhdXggdGltZW91dCB2YWx1ZSBpbiBtc2VjIChkZWZhdWx0OiA1MCkiKTsKKworLyoK
KyAqIFNvbWUgc2luayByZXF1aXJlcyBhIGRlbGF5IGFmdGVyIHBvd2VyIG9uIHJlcXVlc3QKKyAq
Lworc3RhdGljIHVpbnQgenlucW1wX2RwX3Bvd2VyX29uX2RlbGF5X21zID0gNDsKK21vZHVsZV9w
YXJhbV9uYW1lZChwb3dlcl9vbl9kZWxheV9tcywgenlucW1wX2RwX3Bvd2VyX29uX2RlbGF5X21z
LCB1aW50LCAwNDQ0KTsKK01PRFVMRV9QQVJNX0RFU0MoYXV4X3RpbWVvdXRfbXMsICJEUCBwb3dl
ciBvbiBkZWxheSBpbiBtc2VjIChkZWZhdWx0OiA0KSIpOworCisvKiBMaW5rIGNvbmZpZ3VyYXRp
b24gcmVnaXN0ZXJzICovCisjZGVmaW5lIFpZTlFNUF9EUF9MSU5LX0JXX1NFVAkJCQkweDAKKyNk
ZWZpbmUgWllOUU1QX0RQX0xBTkVfQ09VTlRfU0VUCQkJMHg0CisjZGVmaW5lIFpZTlFNUF9EUF9F
TkhBTkNFRF9GUkFNRV9FTgkJCTB4OAorI2RlZmluZSBaWU5RTVBfRFBfVFJBSU5JTkdfUEFUVEVS
Tl9TRVQJCQkweGMKKyNkZWZpbmUgWllOUU1QX0RQX1NDUkFNQkxJTkdfRElTQUJMRQkJCTB4MTQK
KyNkZWZpbmUgWllOUU1QX0RQX0RPV05TUFJFQURfQ1RMCQkJMHgxOAorI2RlZmluZSBaWU5RTVBf
RFBfU09GVFdBUkVfUkVTRVQJCQkweDFjCisjZGVmaW5lIFpZTlFNUF9EUF9TT0ZUV0FSRV9SRVNF
VF9TVFJFQU0xCQlCSVQoMCkKKyNkZWZpbmUgWllOUU1QX0RQX1NPRlRXQVJFX1JFU0VUX1NUUkVB
TTIJCUJJVCgxKQorI2RlZmluZSBaWU5RTVBfRFBfU09GVFdBUkVfUkVTRVRfU1RSRUFNMwkJQklU
KDIpCisjZGVmaW5lIFpZTlFNUF9EUF9TT0ZUV0FSRV9SRVNFVF9TVFJFQU00CQlCSVQoMykKKyNk
ZWZpbmUgWllOUU1QX0RQX1NPRlRXQVJFX1JFU0VUX0FVWAkJCUJJVCg3KQorI2RlZmluZSBaWU5R
TVBfRFBfU09GVFdBUkVfUkVTRVRfQUxMCQkJKFpZTlFNUF9EUF9TT0ZUV0FSRV9SRVNFVF9TVFJF
QU0xIHwgXAorCQkJCQkJCSBaWU5RTVBfRFBfU09GVFdBUkVfUkVTRVRfU1RSRUFNMiB8IFwKKwkJ
CQkJCQkgWllOUU1QX0RQX1NPRlRXQVJFX1JFU0VUX1NUUkVBTTMgfCBcCisJCQkJCQkJIFpZTlFN
UF9EUF9TT0ZUV0FSRV9SRVNFVF9TVFJFQU00IHwgXAorCQkJCQkJCSBaWU5RTVBfRFBfU09GVFdB
UkVfUkVTRVRfQVVYKQorCisvKiBDb3JlIGVuYWJsZSByZWdpc3RlcnMgKi8KKyNkZWZpbmUgWllO
UU1QX0RQX1RSQU5TTUlUVEVSX0VOQUJMRQkJCTB4ODAKKyNkZWZpbmUgWllOUU1QX0RQX01BSU5f
U1RSRUFNX0VOQUJMRQkJCTB4ODQKKyNkZWZpbmUgWllOUU1QX0RQX0ZPUkNFX1NDUkFNQkxFUl9S
RVNFVAkJCTB4YzAKKyNkZWZpbmUgWllOUU1QX0RQX1ZFUlNJT04JCQkJMHhmOAorI2RlZmluZSBa
WU5RTVBfRFBfVkVSU0lPTl9NQUpPUl9NQVNLCQkJR0VOTUFTSygzMSwgMjQpCisjZGVmaW5lIFpZ
TlFNUF9EUF9WRVJTSU9OX01BSk9SX1NISUZUCQkJMjQKKyNkZWZpbmUgWllOUU1QX0RQX1ZFUlNJ
T05fTUlOT1JfTUFTSwkJCUdFTk1BU0soMjMsIDE2KQorI2RlZmluZSBaWU5RTVBfRFBfVkVSU0lP
Tl9NSU5PUl9TSElGVAkJCTE2CisjZGVmaW5lIFpZTlFNUF9EUF9WRVJTSU9OX1JFVklTSU9OX01B
U0sJCQlHRU5NQVNLKDE1LCAxMikKKyNkZWZpbmUgWllOUU1QX0RQX1ZFUlNJT05fUkVWSVNJT05f
U0hJRlQJCTEyCisjZGVmaW5lIFpZTlFNUF9EUF9WRVJTSU9OX1BBVENIX01BU0sJCQlHRU5NQVNL
KDExLCA4KQorI2RlZmluZSBaWU5RTVBfRFBfVkVSU0lPTl9QQVRDSF9TSElGVAkJCTgKKyNkZWZp
bmUgWllOUU1QX0RQX1ZFUlNJT05fSU5URVJOQUxfTUFTSwkJCUdFTk1BU0soNywgMCkKKyNkZWZp
bmUgWllOUU1QX0RQX1ZFUlNJT05fSU5URVJOQUxfU0hJRlQJCTAKKworLyogQ29yZSBJRCByZWdp
c3RlcnMgKi8KKyNkZWZpbmUgWllOUU1QX0RQX0NPUkVfSUQJCQkJMHhmYworI2RlZmluZSBaWU5R
TVBfRFBfQ09SRV9JRF9NQUpPUl9NQVNLCQkJR0VOTUFTSygzMSwgMjQpCisjZGVmaW5lIFpZTlFN
UF9EUF9DT1JFX0lEX01BSk9SX1NISUZUCQkJMjQKKyNkZWZpbmUgWllOUU1QX0RQX0NPUkVfSURf
TUlOT1JfTUFTSwkJCUdFTk1BU0soMjMsIDE2KQorI2RlZmluZSBaWU5RTVBfRFBfQ09SRV9JRF9N
SU5PUl9TSElGVAkJCTE2CisjZGVmaW5lIFpZTlFNUF9EUF9DT1JFX0lEX1JFVklTSU9OX01BU0sJ
CQlHRU5NQVNLKDE1LCA4KQorI2RlZmluZSBaWU5RTVBfRFBfQ09SRV9JRF9SRVZJU0lPTl9TSElG
VAkJOAorI2RlZmluZSBaWU5RTVBfRFBfQ09SRV9JRF9ESVJFQ1RJT04JCQlHRU5NQVNLKDEpCisK
Ky8qIEFVWCBjaGFubmVsIGludGVyZmFjZSByZWdpc3RlcnMgKi8KKyNkZWZpbmUgWllOUU1QX0RQ
X0FVWF9DT01NQU5ECQkJCTB4MTAwCisjZGVmaW5lIFpZTlFNUF9EUF9BVVhfQ09NTUFORF9DTURf
U0hJRlQJCQk4CisjZGVmaW5lIFpZTlFNUF9EUF9BVVhfQ09NTUFORF9BRERSRVNTX09OTFkJCUJJ
VCgxMikKKyNkZWZpbmUgWllOUU1QX0RQX0FVWF9DT01NQU5EX0JZVEVTX1NISUZUCQkwCisjZGVm
aW5lIFpZTlFNUF9EUF9BVVhfV1JJVEVfRklGTwkJCTB4MTA0CisjZGVmaW5lIFpZTlFNUF9EUF9B
VVhfQUREUkVTUwkJCQkweDEwOAorI2RlZmluZSBaWU5RTVBfRFBfQVVYX0NMS19ESVZJREVSCQkJ
MHgxMGMKKyNkZWZpbmUgWllOUU1QX0RQX0FVWF9DTEtfRElWSURFUl9BVVhfRklMVEVSX1NISUZU
CTgKKyNkZWZpbmUgWllOUU1QX0RQX0lOVEVSUlVQVF9TSUdOQUxfU1RBVEUJCTB4MTMwCisjZGVm
aW5lIFpZTlFNUF9EUF9JTlRFUlJVUFRfU0lHTkFMX1NUQVRFX0hQRAkJQklUKDApCisjZGVmaW5l
IFpZTlFNUF9EUF9JTlRFUlJVUFRfU0lHTkFMX1NUQVRFX1JFUVVFU1QJQklUKDEpCisjZGVmaW5l
IFpZTlFNUF9EUF9JTlRFUlJVUFRfU0lHTkFMX1NUQVRFX1JFUExZCQlCSVQoMikKKyNkZWZpbmUg
WllOUU1QX0RQX0lOVEVSUlVQVF9TSUdOQUxfU1RBVEVfUkVQTFlfVElNRU9VVAlCSVQoMykKKyNk
ZWZpbmUgWllOUU1QX0RQX0FVWF9SRVBMWV9EQVRBCQkJMHgxMzQKKyNkZWZpbmUgWllOUU1QX0RQ
X0FVWF9SRVBMWV9DT0RFCQkJMHgxMzgKKyNkZWZpbmUgWllOUU1QX0RQX0FVWF9SRVBMWV9DT0RF
X0FVWF9BQ0sJCSgwKQorI2RlZmluZSBaWU5RTVBfRFBfQVVYX1JFUExZX0NPREVfQVVYX05BQ0sJ
CUJJVCgwKQorI2RlZmluZSBaWU5RTVBfRFBfQVVYX1JFUExZX0NPREVfQVVYX0RFRkVSCQlCSVQo
MSkKKyNkZWZpbmUgWllOUU1QX0RQX0FVWF9SRVBMWV9DT0RFX0kyQ19BQ0sJCSgwKQorI2RlZmlu
ZSBaWU5RTVBfRFBfQVVYX1JFUExZX0NPREVfSTJDX05BQ0sJCUJJVCgyKQorI2RlZmluZSBaWU5R
TVBfRFBfQVVYX1JFUExZX0NPREVfSTJDX0RFRkVSCQlCSVQoMykKKyNkZWZpbmUgWllOUU1QX0RQ
X0FVWF9SRVBMWV9DT1VOVAkJCTB4MTNjCisjZGVmaW5lIFpZTlFNUF9EUF9SRVBMWV9EQVRBX0NP
VU5UCQkJMHgxNDgKKyNkZWZpbmUgWllOUU1QX0RQX1JFUExZX0RBVEFfQ09VTlRfTUFTSwkJCTB4
ZmYKKyNkZWZpbmUgWllOUU1QX0RQX0lOVF9TVEFUVVMJCQkJMHgzYTAKKyNkZWZpbmUgWllOUU1Q
X0RQX0lOVF9NQVNLCQkJCTB4M2E0CisjZGVmaW5lIFpZTlFNUF9EUF9JTlRfRU4JCQkJMHgzYTgK
KyNkZWZpbmUgWllOUU1QX0RQX0lOVF9EUwkJCQkweDNhYworI2RlZmluZSBaWU5RTVBfRFBfSU5U
X0hQRF9JUlEJCQkJQklUKDApCisjZGVmaW5lIFpZTlFNUF9EUF9JTlRfSFBEX0VWRU5UCQkJCUJJ
VCgxKQorI2RlZmluZSBaWU5RTVBfRFBfSU5UX1JFUExZX1JFQ0VJVkVECQkJQklUKDIpCisjZGVm
aW5lIFpZTlFNUF9EUF9JTlRfUkVQTFlfVElNRU9VVAkJCUJJVCgzKQorI2RlZmluZSBaWU5RTVBf
RFBfSU5UX0hQRF9QVUxTRV9ERVQJCQlCSVQoNCkKKyNkZWZpbmUgWllOUU1QX0RQX0lOVF9FWFRf
UEtUX1RYRAkJCUJJVCg1KQorI2RlZmluZSBaWU5RTVBfRFBfSU5UX0xJVl9BQlVGX1VORFJGTFcJ
CQlCSVQoMTIpCisjZGVmaW5lIFpZTlFNUF9EUF9JTlRfVkJMQU5LX1NUQVJUCQkJQklUKDEzKQor
I2RlZmluZSBaWU5RTVBfRFBfSU5UX1BJWEVMMV9NQVRDSAkJCUJJVCgxNCkKKyNkZWZpbmUgWllO
UU1QX0RQX0lOVF9QSVhFTDBfTUFUQ0gJCQlCSVQoMTUpCisjZGVmaW5lIFpZTlFNUF9EUF9JTlRf
Q0hCVUZfVU5ERVJGTFdfTUFTSwkJMHgzZjAwMDAKKyNkZWZpbmUgWllOUU1QX0RQX0lOVF9DSEJV
Rl9PVkVSRkxXX01BU0sJCTB4ZmMwMDAwMAorI2RlZmluZSBaWU5RTVBfRFBfSU5UX0NVU1RfVFNf
MgkJCQlCSVQoMjgpCisjZGVmaW5lIFpZTlFNUF9EUF9JTlRfQ1VTVF9UUwkJCQlCSVQoMjkpCisj
ZGVmaW5lIFpZTlFNUF9EUF9JTlRfRVhUX1ZTWU5DX1RTCQkJQklUKDMwKQorI2RlZmluZSBaWU5R
TVBfRFBfSU5UX1ZTWU5DX1RTCQkJCUJJVCgzMSkKKyNkZWZpbmUgWllOUU1QX0RQX0lOVF9BTEwJ
CQkJKFpZTlFNUF9EUF9JTlRfSFBEX0lSUSB8IFwKKwkJCQkJCQkgWllOUU1QX0RQX0lOVF9IUERf
RVZFTlQgfCBcCisJCQkJCQkJIFpZTlFNUF9EUF9JTlRfQ0hCVUZfVU5ERVJGTFdfTUFTSyB8IFwK
KwkJCQkJCQkgWllOUU1QX0RQX0lOVF9DSEJVRl9PVkVSRkxXX01BU0spCisKKy8qIE1haW4gc3Ry
ZWFtIGF0dHJpYnV0ZSByZWdpc3RlcnMgKi8KKyNkZWZpbmUgWllOUU1QX0RQX01BSU5fU1RSRUFN
X0hUT1RBTAkJCTB4MTgwCisjZGVmaW5lIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9WVE9UQUwJCQkw
eDE4NAorI2RlZmluZSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fUE9MQVJJVFkJCQkweDE4OAorI2Rl
ZmluZSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fUE9MQVJJVFlfSFNZTkNfU0hJRlQJMAorI2RlZmlu
ZSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fUE9MQVJJVFlfVlNZTkNfU0hJRlQJMQorI2RlZmluZSBa
WU5RTVBfRFBfTUFJTl9TVFJFQU1fSFNXSURUSAkJCTB4MThjCisjZGVmaW5lIFpZTlFNUF9EUF9N
QUlOX1NUUkVBTV9WU1dJRFRICQkJMHgxOTAKKyNkZWZpbmUgWllOUU1QX0RQX01BSU5fU1RSRUFN
X0hSRVMJCQkweDE5NAorI2RlZmluZSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fVlJFUwkJCTB4MTk4
CisjZGVmaW5lIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9IU1RBUlQJCQkweDE5YworI2RlZmluZSBa
WU5RTVBfRFBfTUFJTl9TVFJFQU1fVlNUQVJUCQkJMHgxYTAKKyNkZWZpbmUgWllOUU1QX0RQX01B
SU5fU1RSRUFNX01JU0MwCQkJMHgxYTQKKyNkZWZpbmUgWllOUU1QX0RQX01BSU5fU1RSRUFNX01J
U0MwX1NZTkNfTE9DSwkJQklUKDApCisjZGVmaW5lIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9NSVND
MF9DT01QX0ZPUk1BVF9SR0IJKDAgPDwgMSkKKyNkZWZpbmUgWllOUU1QX0RQX01BSU5fU1RSRUFN
X01JU0MwX0NPTVBfRk9STUFUX1lDUkNCXzQyMgkoNSA8PCAxKQorI2RlZmluZSBaWU5RTVBfRFBf
TUFJTl9TVFJFQU1fTUlTQzBfQ09NUF9GT1JNQVRfWUNSQ0JfNDQ0CSg2IDw8IDEpCisjZGVmaW5l
IFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9NSVNDMF9DT01QX0ZPUk1BVF9NQVNLCSg3IDw8IDEpCisj
ZGVmaW5lIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9NSVNDMF9EWU5BTUlDX1JBTkdFCUJJVCgzKQor
I2RlZmluZSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fTUlTQzBfWUNCQ1JfQ09MUgkJQklUKDQpCisj
ZGVmaW5lIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9NSVNDMF9CUENfNgkJKDAgPDwgNSkKKyNkZWZp
bmUgWllOUU1QX0RQX01BSU5fU1RSRUFNX01JU0MwX0JQQ184CQkoMSA8PCA1KQorI2RlZmluZSBa
WU5RTVBfRFBfTUFJTl9TVFJFQU1fTUlTQzBfQlBDXzEwCQkoMiA8PCA1KQorI2RlZmluZSBaWU5R
TVBfRFBfTUFJTl9TVFJFQU1fTUlTQzBfQlBDXzEyCQkoMyA8PCA1KQorI2RlZmluZSBaWU5RTVBf
RFBfTUFJTl9TVFJFQU1fTUlTQzBfQlBDXzE2CQkoNCA8PCA1KQorI2RlZmluZSBaWU5RTVBfRFBf
TUFJTl9TVFJFQU1fTUlTQzBfQlBDX01BU0sJCSg3IDw8IDUpCisjZGVmaW5lIFpZTlFNUF9EUF9N
QUlOX1NUUkVBTV9NSVNDMQkJCTB4MWE4CisjZGVmaW5lIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9N
SVNDMV9ZX09OTFlfRU4JCUJJVCg3KQorI2RlZmluZSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fTV9W
SUQJCQkweDFhYworI2RlZmluZSBaWU5RTVBfRFBfTVNBX1RSQU5TRkVSX1VOSVRfU0laRQkJMHgx
YjAKKyNkZWZpbmUgWllOUU1QX0RQX01TQV9UUkFOU0ZFUl9VTklUX1NJWkVfVFVfU0laRV9ERUYJ
NjQKKyNkZWZpbmUgWllOUU1QX0RQX01BSU5fU1RSRUFNX05fVklECQkJMHgxYjQKKyNkZWZpbmUg
WllOUU1QX0RQX1VTRVJfUElYX1dJRFRICQkJMHgxYjgKKyNkZWZpbmUgWllOUU1QX0RQX1VTRVJf
REFUQV9DT1VOVF9QRVJfTEFORQkJMHgxYmMKKyNkZWZpbmUgWllOUU1QX0RQX01JTl9CWVRFU19Q
RVJfVFUJCQkweDFjNAorI2RlZmluZSBaWU5RTVBfRFBfRlJBQ19CWVRFU19QRVJfVFUJCQkweDFj
OAorI2RlZmluZSBaWU5RTVBfRFBfSU5JVF9XQUlUCQkJCTB4MWNjCisKKy8qIFBIWSBjb25maWd1
cmF0aW9uIGFuZCBzdGF0dXMgcmVnaXN0ZXJzICovCisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfUkVT
RVQJCQkJMHgyMDAKKyNkZWZpbmUgWllOUU1QX0RQX1BIWV9SRVNFVF9QSFlfUkVTRVQJCQlCSVQo
MCkKKyNkZWZpbmUgWllOUU1QX0RQX1BIWV9SRVNFVF9HVFRYX1JFU0VUCQkJQklUKDEpCisjZGVm
aW5lIFpZTlFNUF9EUF9QSFlfUkVTRVRfUEhZX1BNQV9SRVNFVAkJQklUKDgpCisjZGVmaW5lIFpZ
TlFNUF9EUF9QSFlfUkVTRVRfUEhZX1BDU19SRVNFVAkJQklUKDkpCisjZGVmaW5lIFpZTlFNUF9E
UF9QSFlfUkVTRVRfQUxMX1JFU0VUCQkJKFpZTlFNUF9EUF9QSFlfUkVTRVRfUEhZX1JFU0VUIHwg
XAorCQkJCQkJCSBaWU5RTVBfRFBfUEhZX1JFU0VUX0dUVFhfUkVTRVQgfCBcCisJCQkJCQkJIFpZ
TlFNUF9EUF9QSFlfUkVTRVRfUEhZX1BNQV9SRVNFVCB8IFwKKwkJCQkJCQkgWllOUU1QX0RQX1BI
WV9SRVNFVF9QSFlfUENTX1JFU0VUKQorI2RlZmluZSBaWU5RTVBfRFBfUEhZX1BSRUVNUEhBU0lT
X0xBTkVfMAkJMHgyMTAKKyNkZWZpbmUgWllOUU1QX0RQX1BIWV9QUkVFTVBIQVNJU19MQU5FXzEJ
CTB4MjE0CisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfUFJFRU1QSEFTSVNfTEFORV8yCQkweDIxOAor
I2RlZmluZSBaWU5RTVBfRFBfUEhZX1BSRUVNUEhBU0lTX0xBTkVfMwkJMHgyMWMKKyNkZWZpbmUg
WllOUU1QX0RQX1BIWV9WT0xUQUdFX0RJRkZfTEFORV8wCQkweDIyMAorI2RlZmluZSBaWU5RTVBf
RFBfUEhZX1ZPTFRBR0VfRElGRl9MQU5FXzEJCTB4MjI0CisjZGVmaW5lIFpZTlFNUF9EUF9QSFlf
Vk9MVEFHRV9ESUZGX0xBTkVfMgkJMHgyMjgKKyNkZWZpbmUgWllOUU1QX0RQX1BIWV9WT0xUQUdF
X0RJRkZfTEFORV8zCQkweDIyYworI2RlZmluZSBaWU5RTVBfRFBfUEhZX0NMT0NLX1NFTEVDVAkJ
CTB4MjM0CisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfQ0xPQ0tfU0VMRUNUXzFfNjJHCQkweDEKKyNk
ZWZpbmUgWllOUU1QX0RQX1BIWV9DTE9DS19TRUxFQ1RfMl83MEcJCTB4MworI2RlZmluZSBaWU5R
TVBfRFBfUEhZX0NMT0NLX1NFTEVDVF81XzQwRwkJMHg1CisjZGVmaW5lIFpZTlFNUF9EUF9UWF9Q
SFlfUE9XRVJfRE9XTgkJCTB4MjM4CisjZGVmaW5lIFpZTlFNUF9EUF9UWF9QSFlfUE9XRVJfRE9X
Tl9MQU5FXzAJCUJJVCgwKQorI2RlZmluZSBaWU5RTVBfRFBfVFhfUEhZX1BPV0VSX0RPV05fTEFO
RV8xCQlCSVQoMSkKKyNkZWZpbmUgWllOUU1QX0RQX1RYX1BIWV9QT1dFUl9ET1dOX0xBTkVfMgkJ
QklUKDIpCisjZGVmaW5lIFpZTlFNUF9EUF9UWF9QSFlfUE9XRVJfRE9XTl9MQU5FXzMJCUJJVCgz
KQorI2RlZmluZSBaWU5RTVBfRFBfVFhfUEhZX1BPV0VSX0RPV05fQUxMCQkJMHhmCisjZGVmaW5l
IFpZTlFNUF9EUF9QSFlfUFJFQ1VSU09SX0xBTkVfMAkJCTB4MjNjCisjZGVmaW5lIFpZTlFNUF9E
UF9QSFlfUFJFQ1VSU09SX0xBTkVfMQkJCTB4MjQwCisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfUFJF
Q1VSU09SX0xBTkVfMgkJCTB4MjQ0CisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfUFJFQ1VSU09SX0xB
TkVfMwkJCTB4MjQ4CisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfUE9TVENVUlNPUl9MQU5FXzAJCQkw
eDI0YworI2RlZmluZSBaWU5RTVBfRFBfUEhZX1BPU1RDVVJTT1JfTEFORV8xCQkJMHgyNTAKKyNk
ZWZpbmUgWllOUU1QX0RQX1BIWV9QT1NUQ1VSU09SX0xBTkVfMgkJCTB4MjU0CisjZGVmaW5lIFpZ
TlFNUF9EUF9QSFlfUE9TVENVUlNPUl9MQU5FXzMJCQkweDI1OAorI2RlZmluZSBaWU5RTVBfRFBf
U1VCX1RYX1BIWV9QUkVDVVJTT1JfTEFORV8wCQkweDI0YworI2RlZmluZSBaWU5RTVBfRFBfU1VC
X1RYX1BIWV9QUkVDVVJTT1JfTEFORV8xCQkweDI1MAorI2RlZmluZSBaWU5RTVBfRFBfUEhZX1NU
QVRVUwkJCQkweDI4MAorI2RlZmluZSBaWU5RTVBfRFBfUEhZX1NUQVRVU19QTExfTE9DS0VEX1NI
SUZUCQk0CisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfU1RBVFVTX0ZQR0FfUExMX0xPQ0tFRAkJQklU
KDYpCisKKy8qIEF1ZGlvIHJlZ2lzdGVycyAqLworI2RlZmluZSBaWU5RTVBfRFBfVFhfQVVESU9f
Q09OVFJPTAkJCTB4MzAwCisjZGVmaW5lIFpZTlFNUF9EUF9UWF9BVURJT19DSEFOTkVMUwkJCTB4
MzA0CisjZGVmaW5lIFpZTlFNUF9EUF9UWF9BVURJT19JTkZPX0RBVEEJCQkweDMwOAorI2RlZmlu
ZSBaWU5RTVBfRFBfVFhfTV9BVUQJCQkJMHgzMjgKKyNkZWZpbmUgWllOUU1QX0RQX1RYX05fQVVE
CQkJCTB4MzJjCisjZGVmaW5lIFpZTlFNUF9EUF9UWF9BVURJT19FWFRfREFUQQkJCTB4MzMwCisK
KyNkZWZpbmUgWllOUU1QX0RQX01BWF9MQU5FUwkJCQkyCisjZGVmaW5lIFpZTlFNUF9NQVhfRlJF
UQkJCQkJMzAwMDAwMAorCisjZGVmaW5lIERQX1JFRFVDRURfQklUX1JBVEUJCQkJMTYyMDAwCisj
ZGVmaW5lIERQX0hJR0hfQklUX1JBVEUJCQkJMjcwMDAwCisjZGVmaW5lIERQX0hJR0hfQklUX1JB
VEUyCQkJCTU0MDAwMAorI2RlZmluZSBEUF9NQVhfVFJBSU5JTkdfVFJJRVMJCQkJNQorI2RlZmlu
ZSBEUF9WMV8yCQkJCQkJMHgxMgorCisvKioKKyAqIHN0cnVjdCB6eW5xbXBfZHBfbGlua19jb25m
aWcgLSBDb21tb24gbGluayBjb25maWcgYmV0d2VlbiBzb3VyY2UgYW5kIHNpbmsKKyAqIEBtYXhf
cmF0ZTogbWF4aW11bSBsaW5rIHJhdGUKKyAqIEBtYXhfbGFuZXM6IG1heGltdW0gbnVtYmVyIG9m
IGxhbmVzCisgKi8KK3N0cnVjdCB6eW5xbXBfZHBfbGlua19jb25maWcgeworCWludCBtYXhfcmF0
ZTsKKwl1OCBtYXhfbGFuZXM7Cit9OworCisvKioKKyAqIHN0cnVjdCB6eW5xbXBfZHBfbW9kZSAt
IENvbmZpZ3VyZWQgbW9kZSBvZiBEaXNwbGF5UG9ydAorICogQGJ3X2NvZGU6IGNvZGUgZm9yIGJh
bmR3aWR0aChsaW5rIHJhdGUpCisgKiBAbGFuZV9jbnQ6IG51bWJlciBvZiBsYW5lcworICogQHBj
bG9jazogcGl4ZWwgY2xvY2sgZnJlcXVlbmN5IG9mIGN1cnJlbnQgbW9kZQorICogQGZtdDogZm9y
bWF0IGlkZW50aWZpZXIgc3RyaW5nCisgKi8KK3N0cnVjdCB6eW5xbXBfZHBfbW9kZSB7CisJdTgg
YndfY29kZTsKKwl1OCBsYW5lX2NudDsKKwlpbnQgcGNsb2NrOworCWNvbnN0IGNoYXIgKmZtdDsK
K307CisKKy8qKgorICogc3RydWN0IHp5bnFtcF9kcF9jb25maWcgLSBDb25maWd1cmF0aW9uIG9m
IERpc3BsYXlQb3J0IGZyb20gRFRTCisgKiBAbWlzYzA6IG1pc2MwIGNvbmZpZ3VyYXRpb24gKHBl
ciBEUCB2MS4yIHNwZWMpCisgKiBAbWlzYzE6IG1pc2MxIGNvbmZpZ3VyYXRpb24gKHBlciBEUCB2
MS4yIHNwZWMpCisgKiBAYnBwOiBiaXRzIHBlciBwaXhlbAorICovCitzdHJ1Y3QgenlucW1wX2Rw
X2NvbmZpZyB7CisJdTggbWlzYzA7CisJdTggbWlzYzE7CisJdTggYnBwOworfTsKKworLyoqCisg
KiBzdHJ1Y3QgenlucW1wX2RwIC0gWGlsaW54IERpc3BsYXlQb3J0IGNvcmUKKyAqIEBlbmNvZGVy
OiB0aGUgZHJtIGVuY29kZXIgc3RydWN0dXJlCisgKiBAY29ubmVjdG9yOiB0aGUgZHJtIGNvbm5l
Y3RvciBzdHJ1Y3R1cmUKKyAqIEBkZXY6IGRldmljZSBzdHJ1Y3R1cmUKKyAqIEBkcHN1YjogRGlz
cGxheSBzdWJzeXN0ZW0KKyAqIEBkcm06IERSTSBjb3JlCisgKiBAaW9tZW06IGRldmljZSBJL08g
bWVtb3J5IGZvciByZWdpc3RlciBhY2Nlc3MKKyAqIEBpcnE6IGlycQorICogQGNvbmZpZzogSVAg
Y29yZSBjb25maWd1cmF0aW9uIGZyb20gRFRTCisgKiBAYXV4OiBhdXggY2hhbm5lbAorICogQHBo
eTogUEhZIGhhbmRsZXMgZm9yIERQIGxhbmVzCisgKiBAbnVtX2xhbmVzOiBudW1iZXIgb2YgZW5h
YmxlZCBwaHkgbGFuZXMKKyAqIEBocGRfd29yazogaG90IHBsdWcgZGV0ZWN0aW9uIHdvcmtlcgor
ICogQHN0YXR1czogY29ubmVjdGlvbiBzdGF0dXMKKyAqIEBlbmFibGVkOiBmbGFnIHRvIGluZGlj
YXRlIGlmIHRoZSBkZXZpY2UgaXMgZW5hYmxlZAorICogQGRwY2Q6IERQIGNvbmZpZ3VyYXRpb24g
ZGF0YSBmcm9tIGN1cnJlbnRseSBjb25uZWN0ZWQgc2luayBkZXZpY2UKKyAqIEBsaW5rX2NvbmZp
ZzogY29tbW9uIGxpbmsgY29uZmlndXJhdGlvbiBiZXR3ZWVuIElQIGNvcmUgYW5kIHNpbmsgZGV2
aWNlCisgKiBAbW9kZTogY3VycmVudCBtb2RlIGJldHdlZW4gSVAgY29yZSBhbmQgc2luayBkZXZp
Y2UKKyAqIEB0cmFpbl9zZXQ6IHNldCBvZiB0cmFpbmluZyBkYXRhCisgKi8KK3N0cnVjdCB6eW5x
bXBfZHAgeworCXN0cnVjdCBkcm1fZW5jb2RlciBlbmNvZGVyOworCXN0cnVjdCBkcm1fY29ubmVj
dG9yIGNvbm5lY3RvcjsKKwlzdHJ1Y3QgZGV2aWNlICpkZXY7CisJc3RydWN0IHp5bnFtcF9kcHN1
YiAqZHBzdWI7CisJc3RydWN0IGRybV9kZXZpY2UgKmRybTsKKwl2b2lkIF9faW9tZW0gKmlvbWVt
OworCWludCBpcnE7CisKKwlzdHJ1Y3QgenlucW1wX2RwX2NvbmZpZyBjb25maWc7CisJc3RydWN0
IGRybV9kcF9hdXggYXV4OworCXN0cnVjdCBwaHkgKnBoeVtaWU5RTVBfRFBfTUFYX0xBTkVTXTsK
Kwl1OCBudW1fbGFuZXM7CisJc3RydWN0IGRlbGF5ZWRfd29yayBocGRfd29yazsKKwllbnVtIGRy
bV9jb25uZWN0b3Jfc3RhdHVzIHN0YXR1czsKKwlib29sIGVuYWJsZWQ7CisKKwl1OCBkcGNkW0RQ
X1JFQ0VJVkVSX0NBUF9TSVpFXTsKKwlzdHJ1Y3QgenlucW1wX2RwX2xpbmtfY29uZmlnIGxpbmtf
Y29uZmlnOworCXN0cnVjdCB6eW5xbXBfZHBfbW9kZSBtb2RlOworCXU4IHRyYWluX3NldFtaWU5R
TVBfRFBfTUFYX0xBTkVTXTsKK307CisKK3N0YXRpYyBpbmxpbmUgc3RydWN0IHp5bnFtcF9kcCAq
ZW5jb2Rlcl90b19kcChzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIpCit7CisJcmV0dXJuIGNv
bnRhaW5lcl9vZihlbmNvZGVyLCBzdHJ1Y3QgenlucW1wX2RwLCBlbmNvZGVyKTsKK30KKworc3Rh
dGljIGlubGluZSBzdHJ1Y3QgenlucW1wX2RwICpjb25uZWN0b3JfdG9fZHAoc3RydWN0IGRybV9j
b25uZWN0b3IgKmNvbm5lY3RvcikKK3sKKwlyZXR1cm4gY29udGFpbmVyX29mKGNvbm5lY3Rvciwg
c3RydWN0IHp5bnFtcF9kcCwgY29ubmVjdG9yKTsKK30KKworc3RhdGljIHZvaWQgenlucW1wX2Rw
X3dyaXRlKHN0cnVjdCB6eW5xbXBfZHAgKmRwLCBpbnQgb2Zmc2V0LCB1MzIgdmFsKQoreworCXdy
aXRlbCh2YWwsIGRwLT5pb21lbSArIG9mZnNldCk7Cit9CisKK3N0YXRpYyB1MzIgenlucW1wX2Rw
X3JlYWQoc3RydWN0IHp5bnFtcF9kcCAqZHAsIGludCBvZmZzZXQpCit7CisJcmV0dXJuIHJlYWRs
KGRwLT5pb21lbSArIG9mZnNldCk7Cit9CisKK3N0YXRpYyB2b2lkIHp5bnFtcF9kcF9jbHIoc3Ry
dWN0IHp5bnFtcF9kcCAqZHAsIGludCBvZmZzZXQsIHUzMiBjbHIpCit7CisJenlucW1wX2RwX3dy
aXRlKGRwLCBvZmZzZXQsIHp5bnFtcF9kcF9yZWFkKGRwLCBvZmZzZXQpICYgfmNscik7Cit9CisK
K3N0YXRpYyB2b2lkIHp5bnFtcF9kcF9zZXQoc3RydWN0IHp5bnFtcF9kcCAqZHAsIGludCBvZmZz
ZXQsIHUzMiBzZXQpCit7CisJenlucW1wX2RwX3dyaXRlKGRwLCBvZmZzZXQsIHp5bnFtcF9kcF9y
ZWFkKGRwLCBvZmZzZXQpIHwgc2V0KTsKK30KKworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAq
IFBIWSBIYW5kbGluZworICovCisKKy8qKgorICogenlucW1wX2RwX3BoeV9pbml0IC0gSW5pdGlh
bGl6ZSB0aGUgcGh5CisgKiBAZHA6IERpc3BsYXlQb3J0IElQIGNvcmUgc3RydWN0dXJlCisgKgor
ICogSW5pdGlhbGl6ZSB0aGUgcGh5LgorICoKKyAqIFJldHVybjogMCBpZiB0aGUgcGh5IGluc3Rh
bmNlcyBhcmUgaW5pdGlhbGl6ZWQgY29ycmVjdGx5LCBvciB0aGUgZXJyb3IgY29kZQorICogcmV0
dXJuZWQgZnJvbSB0aGUgY2FsbGVlIGZ1bmN0aW9ucy4KKyAqLworc3RhdGljIGludCB6eW5xbXBf
ZHBfcGh5X2luaXQoc3RydWN0IHp5bnFtcF9kcCAqZHApCit7CisJdW5zaWduZWQgaW50IGk7CisJ
aW50IHJldDsKKworCWZvciAoaSA9IDA7IGkgPCBkcC0+bnVtX2xhbmVzOyBpKyspIHsKKwkJcmV0
ID0gcGh5X2luaXQoZHAtPnBoeVtpXSk7CisJCWlmIChyZXQpIHsKKwkJCWRldl9lcnIoZHAtPmRl
diwgImZhaWxlZCB0byBpbml0IHBoeSBsYW5lICVkXG4iLCBpKTsKKwkJCXJldHVybiByZXQ7CisJ
CX0KKwl9CisKKwl6eW5xbXBfZHBfY2xyKGRwLCBaWU5RTVBfRFBfUEhZX1JFU0VULCBaWU5RTVBf
RFBfUEhZX1JFU0VUX0FMTF9SRVNFVCk7CisKKwlyZXR1cm4gMDsKK30KKworLyoqCisgKiB6eW5x
bXBfZHBfcGh5X2V4aXQgLSBFeGl0IHRoZSBwaHkKKyAqIEBkcDogRGlzcGxheVBvcnQgSVAgY29y
ZSBzdHJ1Y3R1cmUKKyAqCisgKiBFeGl0IHRoZSBwaHkuCisgKi8KK3N0YXRpYyB2b2lkIHp5bnFt
cF9kcF9waHlfZXhpdChzdHJ1Y3QgenlucW1wX2RwICpkcCkKK3sKKwl1bnNpZ25lZCBpbnQgaTsK
KwlpbnQgcmV0OworCisJZm9yIChpID0gMDsgaSA8IGRwLT5udW1fbGFuZXM7IGkrKykgeworCQly
ZXQgPSBwaHlfZXhpdChkcC0+cGh5W2ldKTsKKwkJaWYgKHJldCkKKwkJCWRldl9lcnIoZHAtPmRl
diwgImZhaWxlZCB0byBleGl0IHBoeSglZCkgJWRcbiIsIGksIHJldCk7CisJfQorfQorCisvKioK
KyAqIHp5bnFtcF9kcF9waHlfcHJvYmUgLSBQcm9iZSB0aGUgUEhZcworICogQGRwOiBEaXNwbGF5
UG9ydCBJUCBjb3JlIHN0cnVjdHVyZQorICoKKyAqIFByb2JlIFBIWXMgZm9yIGFsbCBsYW5lcy4g
TGVzcyBQSFlzIG1heSBiZSBhdmFpbGFibGUgdGhhbiB0aGUgbnVtYmVyIG9mCisgKiBsYW5lcywg
d2hpY2ggaXMgbm90IGNvbnNpZGVyZWQgYW4gZXJyb3IgYXMgbG9uZyBhcyBhdCBsZWFzdCBvbmUg
UEhZIGlzCisgKiBmb3VuZC4gVGhlIGNhbGxlciBjYW4gY2hlY2sgZHAtPm51bV9sYW5lcyB0byBj
aGVjayBob3cgbWFueSBQSFlzIHdlcmUgZm91bmQuCisgKgorICogUmV0dXJuOgorICogKiAwCQkJ
CS0gU3VjY2VzcworICogKiAtRU5YSU8JCQktIE5vIFBIWSBmb3VuZAorICogKiAtRVBST0JFX0RF
RkVSCQktIFByb2JlIGRlZmVycmFsIHJlcXVlc3RlZAorICogKiBPdGhlciBuZWdhdGl2ZSB2YWx1
ZQktIFBIWSByZXRyaWV2YWwgZmFpbHVyZQorICovCitzdGF0aWMgaW50IHp5bnFtcF9kcF9waHlf
cHJvYmUoc3RydWN0IHp5bnFtcF9kcCAqZHApCit7CisJdW5zaWduZWQgaW50IGk7CisKKwlmb3Ig
KGkgPSAwOyBpIDwgWllOUU1QX0RQX01BWF9MQU5FUzsgaSsrKSB7CisJCWNoYXIgcGh5X25hbWVb
MTZdOworCQlzdHJ1Y3QgcGh5ICpwaHk7CisKKwkJc25wcmludGYocGh5X25hbWUsIHNpemVvZihw
aHlfbmFtZSksICJkcC1waHklZCIsIGkpOworCQlwaHkgPSBkZXZtX3BoeV9nZXQoZHAtPmRldiwg
cGh5X25hbWUpOworCisJCWlmIChJU19FUlIocGh5KSkgeworCQkJc3dpdGNoIChQVFJfRVJSKHBo
eSkpIHsKKwkJCWNhc2UgLUVOT0RFVjoKKwkJCQlpZiAoZHAtPm51bV9sYW5lcykKKwkJCQkJcmV0
dXJuIDA7CisKKwkJCQlkZXZfZXJyKGRwLT5kZXYsICJubyBQSFkgZm91bmRcbiIpOworCQkJCXJl
dHVybiAtRU5YSU87CisKKwkJCWNhc2UgLUVQUk9CRV9ERUZFUjoKKwkJCQlyZXR1cm4gLUVQUk9C
RV9ERUZFUjsKKworCQkJZGVmYXVsdDoKKwkJCQlkZXZfZXJyKGRwLT5kZXYsICJmYWlsZWQgdG8g
Z2V0IFBIWSBsYW5lICV1XG4iLAorCQkJCQlpKTsKKwkJCQlyZXR1cm4gUFRSX0VSUihwaHkpOwor
CQkJfQorCQl9CisKKwkJZHAtPnBoeVtpXSA9IHBoeTsKKwkJZHAtPm51bV9sYW5lcysrOworCX0K
KworCXJldHVybiAwOworfQorCisvKioKKyAqIHp5bnFtcF9kcF9waHlfcmVhZHkgLSBDaGVjayBp
ZiBQSFkgaXMgcmVhZHkKKyAqIEBkcDogRGlzcGxheVBvcnQgSVAgY29yZSBzdHJ1Y3R1cmUKKyAq
CisgKiBDaGVjayBpZiBQSFkgaXMgcmVhZHkuIElmIFBIWSBpcyBub3QgcmVhZHksIHdhaXQgMW1z
IHRvIGNoZWNrIGZvciAxMDAgdGltZXMuCisgKiBUaGlzIGFtb3VudCBvZiBkZWxheSB3YXMgc3Vn
Z2VzdGVkIGJ5IElQIGRlc2lnbmVyLgorICoKKyAqIFJldHVybjogMCBpZiBQSFkgaXMgcmVhZHks
IG9yIC1FTk9ERVYgaWYgUEhZIGlzIG5vdCByZWFkeS4KKyAqLworc3RhdGljIGludCB6eW5xbXBf
ZHBfcGh5X3JlYWR5KHN0cnVjdCB6eW5xbXBfZHAgKmRwKQoreworCXUzMiBpLCByZWcsIHJlYWR5
OworCisJcmVhZHkgPSAoMSA8PCBkcC0+bnVtX2xhbmVzKSAtIDE7CisKKwkvKiBXYWl0IGZvciAx
MDAgKiAxbXMuIFRoaXMgc2hvdWxkIGJlIGVub3VnaCB0aW1lIGZvciBQSFkgdG8gYmUgcmVhZHkg
Ki8KKwlmb3IgKGkgPSAwOyA7IGkrKykgeworCQlyZWcgPSB6eW5xbXBfZHBfcmVhZChkcCwgWllO
UU1QX0RQX1BIWV9TVEFUVVMpOworCQlpZiAoKHJlZyAmIHJlYWR5KSA9PSByZWFkeSkKKwkJCXJl
dHVybiAwOworCisJCWlmIChpID09IDEwMCkgeworCQkJZGV2X2VycihkcC0+ZGV2LCAiUEhZIGlz
bid0IHJlYWR5XG4iKTsKKwkJCXJldHVybiAtRU5PREVWOworCQl9CisKKwkJdXNsZWVwX3Jhbmdl
KDEwMDAsIDExMDApOworCX0KKworCXJldHVybiAwOworfQorCisvKiAtLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLQorICogRGlzcGxheVBvcnQgTGluayBUcmFpbmluZworICovCisKKy8qKgorICogenlucW1w
X2RwX21heF9yYXRlIC0gQ2FsY3VsYXRlIGFuZCByZXR1cm4gYXZhaWxhYmxlIG1heCBwaXhlbCBj
bG9jaworICogQGxpbmtfcmF0ZTogbGluayByYXRlIChLaWxvLWJ5dGVzIC8gc2VjKQorICogQGxh
bmVfbnVtOiBudW1iZXIgb2YgbGFuZXMKKyAqIEBicHA6IGJpdHMgcGVyIHBpeGVsCisgKgorICog
UmV0dXJuOiBtYXggcGl4ZWwgY2xvY2sgKEtIeikgc3VwcG9ydGVkIGJ5IGN1cnJlbnQgbGluayBj
b25maWcuCisgKi8KK3N0YXRpYyBpbmxpbmUgaW50IHp5bnFtcF9kcF9tYXhfcmF0ZShpbnQgbGlu
a19yYXRlLCB1OCBsYW5lX251bSwgdTggYnBwKQoreworCXJldHVybiBsaW5rX3JhdGUgKiBsYW5l
X251bSAqIDggLyBicHA7Cit9CisKKy8qKgorICogenlucW1wX2RwX21vZGVfY29uZmlndXJlIC0g
Q29uZmlndXJlIHRoZSBsaW5rIHZhbHVlcworICogQGRwOiBEaXNwbGF5UG9ydCBJUCBjb3JlIHN0
cnVjdHVyZQorICogQHBjbG9jazogcGl4ZWwgY2xvY2sgZm9yIHJlcXVlc3RlZCBkaXNwbGF5IG1v
ZGUKKyAqIEBjdXJyZW50X2J3OiBjdXJyZW50IGxpbmsgcmF0ZQorICoKKyAqIEZpbmQgdGhlIGxp
bmsgY29uZmlndXJhdGlvbiB2YWx1ZXMsIHJhdGUgYW5kIGxhbmUgY291bnQgZm9yIHJlcXVlc3Rl
ZCBwaXhlbAorICogY2xvY2sgQHBjbG9jay4gVGhlIEBwY2xvY2sgaXMgc3RvcmVkIGluIHRoZSBt
b2RlIHRvIGJlIHVzZWQgaW4gb3RoZXIKKyAqIGZ1bmN0aW9ucyBsYXRlci4gVGhlIHJldHVybmVk
IHJhdGUgaXMgZG93bnNoaWZ0ZWQgZnJvbSB0aGUgY3VycmVudCByYXRlCisgKiBAY3VycmVudF9i
dy4KKyAqCisgKiBSZXR1cm46IEN1cnJlbnQgbGluayByYXRlIGNvZGUsIG9yIC1FSU5WQUwuCisg
Ki8KK3N0YXRpYyBpbnQgenlucW1wX2RwX21vZGVfY29uZmlndXJlKHN0cnVjdCB6eW5xbXBfZHAg
KmRwLCBpbnQgcGNsb2NrLAorCQkJCSAgICB1OCBjdXJyZW50X2J3KQoreworCWludCBtYXhfcmF0
ZSA9IGRwLT5saW5rX2NvbmZpZy5tYXhfcmF0ZTsKKwl1OCBid3NbM10gPSB7IERQX0xJTktfQldf
MV82MiwgRFBfTElOS19CV18yXzcsIERQX0xJTktfQldfNV80IH07CisJdTggbWF4X2xhbmVzID0g
ZHAtPmxpbmtfY29uZmlnLm1heF9sYW5lczsKKwl1OCBtYXhfbGlua19yYXRlX2NvZGUgPSBkcm1f
ZHBfbGlua19yYXRlX3RvX2J3X2NvZGUobWF4X3JhdGUpOworCXU4IGJwcCA9IGRwLT5jb25maWcu
YnBwOworCXU4IGxhbmVfY250OworCXM4IGk7CisKKwlpZiAoY3VycmVudF9idyA9PSBEUF9MSU5L
X0JXXzFfNjIpIHsKKwkJZGV2X2VycihkcC0+ZGV2LCAiY2FuJ3QgZG93bnNoaWZ0LiBhbHJlYWR5
IGxvd2VzdCBsaW5rIHJhdGVcbiIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlmb3IgKGkg
PSBBUlJBWV9TSVpFKGJ3cykgLSAxOyBpID49IDA7IGktLSkgeworCQlpZiAoY3VycmVudF9idyAm
JiBid3NbaV0gPj0gY3VycmVudF9idykKKwkJCWNvbnRpbnVlOworCisJCWlmIChid3NbaV0gPD0g
bWF4X2xpbmtfcmF0ZV9jb2RlKQorCQkJYnJlYWs7CisJfQorCisJZm9yIChsYW5lX2NudCA9IDE7
IGxhbmVfY250IDw9IG1heF9sYW5lczsgbGFuZV9jbnQgPDw9IDEpIHsKKwkJaW50IGJ3OworCQl1
MzIgcmF0ZTsKKworCQlidyA9IGRybV9kcF9id19jb2RlX3RvX2xpbmtfcmF0ZShid3NbaV0pOwor
CQlyYXRlID0genlucW1wX2RwX21heF9yYXRlKGJ3LCBsYW5lX2NudCwgYnBwKTsKKwkJaWYgKHBj
bG9jayA8PSByYXRlKSB7CisJCQlkcC0+bW9kZS5id19jb2RlID0gYndzW2ldOworCQkJZHAtPm1v
ZGUubGFuZV9jbnQgPSBsYW5lX2NudDsKKwkJCWRwLT5tb2RlLnBjbG9jayA9IHBjbG9jazsKKwkJ
CXJldHVybiBkcC0+bW9kZS5id19jb2RlOworCQl9CisJfQorCisJZGV2X2VycihkcC0+ZGV2LCAi
ZmFpbGVkIHRvIGNvbmZpZ3VyZSBsaW5rIHZhbHVlc1xuIik7CisKKwlyZXR1cm4gLUVJTlZBTDsK
K30KKworLyoqCisgKiB6eW5xbXBfZHBfYWRqdXN0X3RyYWluIC0gQWRqdXN0IHRyYWluIHZhbHVl
cworICogQGRwOiBEaXNwbGF5UG9ydCBJUCBjb3JlIHN0cnVjdHVyZQorICogQGxpbmtfc3RhdHVz
OiBsaW5rIHN0YXR1cyBmcm9tIHNpbmsgd2hpY2ggY29udGFpbnMgcmVxdWVzdGVkIHRyYWluaW5n
IHZhbHVlcworICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZHBfYWRqdXN0X3RyYWluKHN0cnVjdCB6
eW5xbXBfZHAgKmRwLAorCQkJCSAgIHU4IGxpbmtfc3RhdHVzW0RQX0xJTktfU1RBVFVTX1NJWkVd
KQoreworCXU4ICp0cmFpbl9zZXQgPSBkcC0+dHJhaW5fc2V0OworCXU4IHZvbHRhZ2UgPSAwLCBw
cmVlbXBoYXNpcyA9IDA7CisJdTggaTsKKworCWZvciAoaSA9IDA7IGkgPCBkcC0+bW9kZS5sYW5l
X2NudDsgaSsrKSB7CisJCXU4IHYgPSBkcm1fZHBfZ2V0X2FkanVzdF9yZXF1ZXN0X3ZvbHRhZ2Uo
bGlua19zdGF0dXMsIGkpOworCQl1OCBwID0gZHJtX2RwX2dldF9hZGp1c3RfcmVxdWVzdF9wcmVf
ZW1waGFzaXMobGlua19zdGF0dXMsIGkpOworCisJCWlmICh2ID4gdm9sdGFnZSkKKwkJCXZvbHRh
Z2UgPSB2OworCisJCWlmIChwID4gcHJlZW1waGFzaXMpCisJCQlwcmVlbXBoYXNpcyA9IHA7CisJ
fQorCisJaWYgKHZvbHRhZ2UgPj0gRFBfVFJBSU5fVk9MVEFHRV9TV0lOR19MRVZFTF8zKQorCQl2
b2x0YWdlIHw9IERQX1RSQUlOX01BWF9TV0lOR19SRUFDSEVEOworCisJaWYgKHByZWVtcGhhc2lz
ID49IERQX1RSQUlOX1BSRV9FTVBIX0xFVkVMXzIpCisJCXByZWVtcGhhc2lzIHw9IERQX1RSQUlO
X01BWF9QUkVfRU1QSEFTSVNfUkVBQ0hFRDsKKworCWZvciAoaSA9IDA7IGkgPCBkcC0+bW9kZS5s
YW5lX2NudDsgaSsrKQorCQl0cmFpbl9zZXRbaV0gPSB2b2x0YWdlIHwgcHJlZW1waGFzaXM7Cit9
CisKKy8qKgorICogenlucW1wX2RwX3VwZGF0ZV92c19lbXBoIC0gVXBkYXRlIHRoZSB0cmFpbmlu
ZyB2YWx1ZXMKKyAqIEBkcDogRGlzcGxheVBvcnQgSVAgY29yZSBzdHJ1Y3R1cmUKKyAqCisgKiBV
cGRhdGUgdGhlIHRyYWluaW5nIHZhbHVlcyBiYXNlZCBvbiB0aGUgcmVxdWVzdCBmcm9tIHNpbmsu
IFRoZSBtYXBwZWQgdmFsdWVzCisgKiBhcmUgcHJlZGVmaW5lZCwgYW5kIHZhbHVlcyh2cywgcGUs
IHBjKSBhcmUgZnJvbSB0aGUgZGV2aWNlIG1hbnVhbC4KKyAqCisgKiBSZXR1cm46IDAgaWYgdnMg
YW5kIGVtcGggYXJlIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5LCBvciB0aGUgZXJyb3IgY29kZSByZXR1
cm5lZAorICogYnkgZHJtX2RwX2RwY2Rfd3JpdGUoKS4KKyAqLworc3RhdGljIGludCB6eW5xbXBf
ZHBfdXBkYXRlX3ZzX2VtcGgoc3RydWN0IHp5bnFtcF9kcCAqZHApCit7CisJdTggKnRyYWluX3Nl
dCA9IGRwLT50cmFpbl9zZXQ7CisJdTggaSwgdl9sZXZlbCwgcF9sZXZlbDsKKwlpbnQgcmV0Owor
CisJcmV0ID0gZHJtX2RwX2RwY2Rfd3JpdGUoJmRwLT5hdXgsIERQX1RSQUlOSU5HX0xBTkUwX1NF
VCwgdHJhaW5fc2V0LAorCQkJCWRwLT5tb2RlLmxhbmVfY250KTsKKwlpZiAocmV0IDwgMCkKKwkJ
cmV0dXJuIHJldDsKKworCWZvciAoaSA9IDA7IGkgPCBkcC0+bW9kZS5sYW5lX2NudDsgaSsrKSB7
CisJCXUzMiByZWcgPSBaWU5RTVBfRFBfU1VCX1RYX1BIWV9QUkVDVVJTT1JfTEFORV8wICsgaSAq
IDQ7CisKKwkJdl9sZXZlbCA9ICh0cmFpbl9zZXRbaV0gJiBEUF9UUkFJTl9WT0xUQUdFX1NXSU5H
X01BU0spID4+CisJCQkgIERQX1RSQUlOX1ZPTFRBR0VfU1dJTkdfU0hJRlQ7CisJCXBfbGV2ZWwg
PSAodHJhaW5fc2V0W2ldICYgRFBfVFJBSU5fUFJFX0VNUEhBU0lTX01BU0spID4+CisJCQkgIERQ
X1RSQUlOX1BSRV9FTVBIQVNJU19TSElGVDsKKworCQl6eW5xbXBfZHBfd3JpdGUoZHAsIHJlZywg
MHgyKTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworLyoqCisgKiB6eW5xbXBfZHBfbGlua190cmFp
bl9jciAtIFRyYWluIGNsb2NrIHJlY292ZXJ5CisgKiBAZHA6IERpc3BsYXlQb3J0IElQIGNvcmUg
c3RydWN0dXJlCisgKgorICogUmV0dXJuOiAwIGlmIGNsb2NrIHJlY292ZXJ5IHRyYWluIGlzIGRv
bmUgc3VjY2Vzc2Z1bGx5LCBvciBjb3JyZXNwb25kaW5nCisgKiBlcnJvciBjb2RlLgorICovCitz
dGF0aWMgaW50IHp5bnFtcF9kcF9saW5rX3RyYWluX2NyKHN0cnVjdCB6eW5xbXBfZHAgKmRwKQor
eworCXU4IGxpbmtfc3RhdHVzW0RQX0xJTktfU1RBVFVTX1NJWkVdOworCXU4IGxhbmVfY250ID0g
ZHAtPm1vZGUubGFuZV9jbnQ7CisJdTggdnMgPSAwLCB0cmllcyA9IDA7CisJdTE2IG1heF90cmll
cywgaTsKKwlib29sIGNyX2RvbmU7CisJaW50IHJldDsKKworCXp5bnFtcF9kcF93cml0ZShkcCwg
WllOUU1QX0RQX1RSQUlOSU5HX1BBVFRFUk5fU0VULAorCQkJRFBfVFJBSU5JTkdfUEFUVEVSTl8x
KTsKKwlyZXQgPSBkcm1fZHBfZHBjZF93cml0ZWIoJmRwLT5hdXgsIERQX1RSQUlOSU5HX1BBVFRF
Uk5fU0VULAorCQkJCSBEUF9UUkFJTklOR19QQVRURVJOXzEgfAorCQkJCSBEUF9MSU5LX1NDUkFN
QkxJTkdfRElTQUJMRSk7CisJaWYgKHJldCA8IDApCisJCXJldHVybiByZXQ7CisKKwkvKgorCSAq
IDI1NiBsb29wcyBzaG91bGQgYmUgbWF4aW11bSBpdGVyYXRpb25zIGZvciA0IGxhbmVzIGFuZCA0
IHZhbHVlcy4KKwkgKiBTbywgVGhpcyBsb29wIHNob3VsZCBleGl0IGJlZm9yZSA1MTIgaXRlcmF0
aW9ucworCSAqLworCWZvciAobWF4X3RyaWVzID0gMDsgbWF4X3RyaWVzIDwgNTEyOyBtYXhfdHJp
ZXMrKykgeworCQlyZXQgPSB6eW5xbXBfZHBfdXBkYXRlX3ZzX2VtcGgoZHApOworCQlpZiAocmV0
KQorCQkJcmV0dXJuIHJldDsKKworCQlkcm1fZHBfbGlua190cmFpbl9jbG9ja19yZWNvdmVyeV9k
ZWxheShkcC0+ZHBjZCk7CisJCXJldCA9IGRybV9kcF9kcGNkX3JlYWRfbGlua19zdGF0dXMoJmRw
LT5hdXgsIGxpbmtfc3RhdHVzKTsKKwkJaWYgKHJldCA8IDApCisJCQlyZXR1cm4gcmV0OworCisJ
CWNyX2RvbmUgPSBkcm1fZHBfY2xvY2tfcmVjb3Zlcnlfb2sobGlua19zdGF0dXMsIGxhbmVfY250
KTsKKwkJaWYgKGNyX2RvbmUpCisJCQlicmVhazsKKworCQlmb3IgKGkgPSAwOyBpIDwgbGFuZV9j
bnQ7IGkrKykKKwkJCWlmICghKGRwLT50cmFpbl9zZXRbaV0gJiBEUF9UUkFJTl9NQVhfU1dJTkdf
UkVBQ0hFRCkpCisJCQkJYnJlYWs7CisJCWlmIChpID09IGxhbmVfY250KQorCQkJYnJlYWs7CisK
KwkJaWYgKChkcC0+dHJhaW5fc2V0WzBdICYgRFBfVFJBSU5fVk9MVEFHRV9TV0lOR19NQVNLKSA9
PSB2cykKKwkJCXRyaWVzKys7CisJCWVsc2UKKwkJCXRyaWVzID0gMDsKKworCQlpZiAodHJpZXMg
PT0gRFBfTUFYX1RSQUlOSU5HX1RSSUVTKQorCQkJYnJlYWs7CisKKwkJdnMgPSBkcC0+dHJhaW5f
c2V0WzBdICYgRFBfVFJBSU5fVk9MVEFHRV9TV0lOR19NQVNLOworCQl6eW5xbXBfZHBfYWRqdXN0
X3RyYWluKGRwLCBsaW5rX3N0YXR1cyk7CisJfQorCisJaWYgKCFjcl9kb25lKQorCQlyZXR1cm4g
LUVJTzsKKworCXJldHVybiAwOworfQorCisvKioKKyAqIHp5bnFtcF9kcF9saW5rX3RyYWluX2Nl
IC0gVHJhaW4gY2hhbm5lbCBlcXVhbGl6YXRpb24KKyAqIEBkcDogRGlzcGxheVBvcnQgSVAgY29y
ZSBzdHJ1Y3R1cmUKKyAqCisgKiBSZXR1cm46IDAgaWYgY2hhbm5lbCBlcXVhbGl6YXRpb24gdHJh
aW4gaXMgZG9uZSBzdWNjZXNzZnVsbHksIG9yCisgKiBjb3JyZXNwb25kaW5nIGVycm9yIGNvZGUu
CisgKi8KK3N0YXRpYyBpbnQgenlucW1wX2RwX2xpbmtfdHJhaW5fY2Uoc3RydWN0IHp5bnFtcF9k
cCAqZHApCit7CisJdTggbGlua19zdGF0dXNbRFBfTElOS19TVEFUVVNfU0laRV07CisJdTggbGFu
ZV9jbnQgPSBkcC0+bW9kZS5sYW5lX2NudDsKKwl1MzIgcGF0LCB0cmllczsKKwlpbnQgcmV0Owor
CWJvb2wgY2VfZG9uZTsKKworCWlmIChkcC0+ZHBjZFtEUF9EUENEX1JFVl0gPj0gRFBfVjFfMiAm
JgorCSAgICBkcC0+ZHBjZFtEUF9NQVhfTEFORV9DT1VOVF0gJiBEUF9UUFMzX1NVUFBPUlRFRCkK
KwkJcGF0ID0gRFBfVFJBSU5JTkdfUEFUVEVSTl8zOworCWVsc2UKKwkJcGF0ID0gRFBfVFJBSU5J
TkdfUEFUVEVSTl8yOworCisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfVFJBSU5JTkdf
UEFUVEVSTl9TRVQsIHBhdCk7CisJcmV0ID0gZHJtX2RwX2RwY2Rfd3JpdGViKCZkcC0+YXV4LCBE
UF9UUkFJTklOR19QQVRURVJOX1NFVCwKKwkJCQkgcGF0IHwgRFBfTElOS19TQ1JBTUJMSU5HX0RJ
U0FCTEUpOworCWlmIChyZXQgPCAwKQorCQlyZXR1cm4gcmV0OworCisJZm9yICh0cmllcyA9IDA7
IHRyaWVzIDwgRFBfTUFYX1RSQUlOSU5HX1RSSUVTOyB0cmllcysrKSB7CisJCXJldCA9IHp5bnFt
cF9kcF91cGRhdGVfdnNfZW1waChkcCk7CisJCWlmIChyZXQpCisJCQlyZXR1cm4gcmV0OworCisJ
CWRybV9kcF9saW5rX3RyYWluX2NoYW5uZWxfZXFfZGVsYXkoZHAtPmRwY2QpOworCQlyZXQgPSBk
cm1fZHBfZHBjZF9yZWFkX2xpbmtfc3RhdHVzKCZkcC0+YXV4LCBsaW5rX3N0YXR1cyk7CisJCWlm
IChyZXQgPCAwKQorCQkJcmV0dXJuIHJldDsKKworCQljZV9kb25lID0gZHJtX2RwX2NoYW5uZWxf
ZXFfb2sobGlua19zdGF0dXMsIGxhbmVfY250KTsKKwkJaWYgKGNlX2RvbmUpCisJCQlicmVhazsK
KworCQl6eW5xbXBfZHBfYWRqdXN0X3RyYWluKGRwLCBsaW5rX3N0YXR1cyk7CisJfQorCisJaWYg
KCFjZV9kb25lKQorCQlyZXR1cm4gLUVJTzsKKworCXJldHVybiAwOworfQorCisvKioKKyAqIHp5
bnFtcF9kcF9saW5rX3RyYWluIC0gVHJhaW4gdGhlIGxpbmsKKyAqIEBkcDogRGlzcGxheVBvcnQg
SVAgY29yZSBzdHJ1Y3R1cmUKKyAqCisgKiBSZXR1cm46IDAgaWYgYWxsIHRyYWlucyBhcmUgZG9u
ZSBzdWNjZXNzZnVsbHksIG9yIGNvcnJlc3BvbmRpbmcgZXJyb3IgY29kZS4KKyAqLworc3RhdGlj
IGludCB6eW5xbXBfZHBfdHJhaW4oc3RydWN0IHp5bnFtcF9kcCAqZHApCit7CisJdTMyIHJlZzsK
Kwl1OCBid19jb2RlID0gZHAtPm1vZGUuYndfY29kZTsKKwl1OCBsYW5lX2NudCA9IGRwLT5tb2Rl
LmxhbmVfY250OworCXU4IGF1eF9sYW5lX2NudCA9IGxhbmVfY250OworCWJvb2wgZW5oYW5jZWQ7
CisJaW50IHJldDsKKworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX0xBTkVfQ09VTlRf
U0VULCBsYW5lX2NudCk7CisJZW5oYW5jZWQgPSBkcm1fZHBfZW5oYW5jZWRfZnJhbWVfY2FwKGRw
LT5kcGNkKTsKKwlpZiAoZW5oYW5jZWQpIHsKKwkJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBf
RFBfRU5IQU5DRURfRlJBTUVfRU4sIDEpOworCQlhdXhfbGFuZV9jbnQgfD0gRFBfTEFORV9DT1VO
VF9FTkhBTkNFRF9GUkFNRV9FTjsKKwl9CisKKwlpZiAoZHAtPmRwY2RbM10gJiAweDEpIHsKKwkJ
enlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfRE9XTlNQUkVBRF9DVEwsIDEpOworCQlkcm1f
ZHBfZHBjZF93cml0ZWIoJmRwLT5hdXgsIERQX0RPV05TUFJFQURfQ1RSTCwKKwkJCQkgICBEUF9T
UFJFQURfQU1QXzBfNSk7CisJfSBlbHNlIHsKKwkJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBf
RFBfRE9XTlNQUkVBRF9DVEwsIDApOworCQlkcm1fZHBfZHBjZF93cml0ZWIoJmRwLT5hdXgsIERQ
X0RPV05TUFJFQURfQ1RSTCwgMCk7CisJfQorCisJcmV0ID0gZHJtX2RwX2RwY2Rfd3JpdGViKCZk
cC0+YXV4LCBEUF9MQU5FX0NPVU5UX1NFVCwgYXV4X2xhbmVfY250KTsKKwlpZiAocmV0IDwgMCkg
eworCQlkZXZfZXJyKGRwLT5kZXYsICJmYWlsZWQgdG8gc2V0IGxhbmUgY291bnRcbiIpOworCQly
ZXR1cm4gcmV0OworCX0KKworCXJldCA9IGRybV9kcF9kcGNkX3dyaXRlYigmZHAtPmF1eCwgRFBf
TUFJTl9MSU5LX0NIQU5ORUxfQ09ESU5HX1NFVCwKKwkJCQkgRFBfU0VUX0FOU0lfOEIxMEIpOwor
CWlmIChyZXQgPCAwKSB7CisJCWRldl9lcnIoZHAtPmRldiwgImZhaWxlZCB0byBzZXQgQU5TSSA4
Qi8xMEIgZW5jb2RpbmdcbiIpOworCQlyZXR1cm4gcmV0OworCX0KKworCXJldCA9IGRybV9kcF9k
cGNkX3dyaXRlYigmZHAtPmF1eCwgRFBfTElOS19CV19TRVQsIGJ3X2NvZGUpOworCWlmIChyZXQg
PCAwKSB7CisJCWRldl9lcnIoZHAtPmRldiwgImZhaWxlZCB0byBzZXQgRFAgYmFuZHdpZHRoXG4i
KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9M
SU5LX0JXX1NFVCwgYndfY29kZSk7CisJc3dpdGNoIChid19jb2RlKSB7CisJY2FzZSBEUF9MSU5L
X0JXXzFfNjI6CisJCXJlZyA9IFpZTlFNUF9EUF9QSFlfQ0xPQ0tfU0VMRUNUXzFfNjJHOworCQli
cmVhazsKKwljYXNlIERQX0xJTktfQldfMl83OgorCQlyZWcgPSBaWU5RTVBfRFBfUEhZX0NMT0NL
X1NFTEVDVF8yXzcwRzsKKwkJYnJlYWs7CisJY2FzZSBEUF9MSU5LX0JXXzVfNDoKKwlkZWZhdWx0
OgorCQlyZWcgPSBaWU5RTVBfRFBfUEhZX0NMT0NLX1NFTEVDVF81XzQwRzsKKwkJYnJlYWs7CisJ
fQorCisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfUEhZX0NMT0NLX1NFTEVDVCwgcmVn
KTsKKwlyZXQgPSB6eW5xbXBfZHBfcGh5X3JlYWR5KGRwKTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0
dXJuIHJldDsKKworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX1NDUkFNQkxJTkdfRElT
QUJMRSwgMSk7CisJbWVtc2V0KGRwLT50cmFpbl9zZXQsIDAsIDQpOworCXJldCA9IHp5bnFtcF9k
cF9saW5rX3RyYWluX2NyKGRwKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJcmV0ID0g
enlucW1wX2RwX2xpbmtfdHJhaW5fY2UoZHApOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisK
KwlyZXQgPSBkcm1fZHBfZHBjZF93cml0ZWIoJmRwLT5hdXgsIERQX1RSQUlOSU5HX1BBVFRFUk5f
U0VULAorCQkJCSBEUF9UUkFJTklOR19QQVRURVJOX0RJU0FCTEUpOworCWlmIChyZXQgPCAwKSB7
CisJCWRldl9lcnIoZHAtPmRldiwgImZhaWxlZCB0byBkaXNhYmxlIHRyYWluaW5nIHBhdHRlcm5c
biIpOworCQlyZXR1cm4gcmV0OworCX0KKwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9U
UkFJTklOR19QQVRURVJOX1NFVCwKKwkJCURQX1RSQUlOSU5HX1BBVFRFUk5fRElTQUJMRSk7CisK
Kwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9TQ1JBTUJMSU5HX0RJU0FCTEUsIDApOwor
CisJcmV0dXJuIDA7Cit9CisKKy8qKgorICogenlucW1wX2RwX3RyYWluX2xvb3AgLSBEb3duc2hp
ZnQgdGhlIGxpbmsgcmF0ZSBkdXJpbmcgdHJhaW5pbmcKKyAqIEBkcDogRGlzcGxheVBvcnQgSVAg
Y29yZSBzdHJ1Y3R1cmUKKyAqCisgKiBUcmFpbiB0aGUgbGluayBieSBkb3duc2hpZnRpbmcgdGhl
IGxpbmsgcmF0ZSBpZiB0cmFpbmluZyBpcyBub3Qgc3VjY2Vzc2Z1bC4KKyAqLworc3RhdGljIHZv
aWQgenlucW1wX2RwX3RyYWluX2xvb3Aoc3RydWN0IHp5bnFtcF9kcCAqZHApCit7CisJc3RydWN0
IHp5bnFtcF9kcF9tb2RlICptb2RlID0gJmRwLT5tb2RlOworCXU4IGJ3ID0gbW9kZS0+YndfY29k
ZTsKKwlpbnQgcmV0OworCisJZG8geworCQlpZiAoZHAtPnN0YXR1cyA9PSBjb25uZWN0b3Jfc3Rh
dHVzX2Rpc2Nvbm5lY3RlZCB8fAorCQkgICAgIWRwLT5lbmFibGVkKQorCQkJcmV0dXJuOworCisJ
CXJldCA9IHp5bnFtcF9kcF90cmFpbihkcCk7CisJCWlmICghcmV0KQorCQkJcmV0dXJuOworCisJ
CXJldCA9IHp5bnFtcF9kcF9tb2RlX2NvbmZpZ3VyZShkcCwgbW9kZS0+cGNsb2NrLCBidyk7CisJ
CWlmIChyZXQgPCAwKQorCQkJZ290byBlcnJfb3V0OworCisJCWJ3ID0gcmV0OworCX0gd2hpbGUg
KGJ3ID49IERQX0xJTktfQldfMV82Mik7CisKK2Vycl9vdXQ6CisJZGV2X2VycihkcC0+ZGV2LCAi
ZmFpbGVkIHRvIHRyYWluIHRoZSBEUCBsaW5rXG4iKTsKK30KKworLyogLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0KKyAqIERpc3BsYXlQb3J0IEFVWAorICovCisKKyNkZWZpbmUgQVVYX1JFQURfQklUCTB4
MQorCisvKioKKyAqIHp5bnFtcF9kcF9hdXhfY21kX3N1Ym1pdCAtIFN1Ym1pdCBhdXggY29tbWFu
ZAorICogQGRwOiBEaXNwbGF5UG9ydCBJUCBjb3JlIHN0cnVjdHVyZQorICogQGNtZDogYXV4IGNv
bW1hbmQKKyAqIEBhZGRyOiBhdXggYWRkcmVzcworICogQGJ1ZjogYnVmZmVyIGZvciBjb21tYW5k
IGRhdGEKKyAqIEBieXRlczogbnVtYmVyIG9mIGJ5dGVzIGZvciBAYnVmCisgKiBAcmVwbHk6IHJl
cGx5IGNvZGUgdG8gYmUgcmV0dXJuZWQKKyAqCisgKiBTdWJtaXQgYW4gYXV4IGNvbW1hbmQuIEFs
bCBhdXggcmVsYXRlZCBjb21tYW5kcywgbmF0aXZlIG9yIGkyYyBhdXgKKyAqIHJlYWQvd3JpdGUs
IGFyZSBzdWJtaXR0ZWQgdGhyb3VnaCB0aGlzIGZ1bmN0aW9uLiBUaGUgZnVuY3Rpb24gaXMgbWFw
cGVkIHRvCisgKiB0aGUgdHJhbnNmZXIgZnVuY3Rpb24gb2Ygc3RydWN0IGRybV9kcF9hdXguIFRo
aXMgZnVuY3Rpb24gaW52b2x2ZXMgaW4KKyAqIG11bHRpcGxlIHJlZ2lzdGVyIHJlYWRzL3dyaXRl
cywgdGh1cyBzeW5jaHJvbml6YXRpb24gaXMgbmVlZGVkLCBhbmQgaXQgaXMKKyAqIGRvbmUgYnkg
ZHJtX2RwX2hlbHBlciB1c2luZyBAaHdfbXV0ZXguIFRoZSBjYWxsaW5nIHRocmVhZCBnb2VzIGlu
dG8gc2xlZXAKKyAqIGlmIHRoZXJlJ3Mgbm8gaW1tZWRpYXRlIHJlcGx5IHRvIHRoZSBjb21tYW5k
IHN1Ym1pc3Npb24uIFRoZSByZXBseSBjb2RlIGlzCisgKiByZXR1cm5lZCBhdCBAcmVwbHkgaWYg
QHJlcGx5ICE9IE5VTEwuCisgKgorICogUmV0dXJuOiAwIGlmIHRoZSBjb21tYW5kIGlzIHN1Ym1p
dHRlZCBwcm9wZXJseSwgb3IgY29ycmVzcG9uZGluZyBlcnJvciBjb2RlOgorICogLUVCVVNZIHdo
ZW4gdGhlcmUgaXMgYW55IHJlcXVlc3QgYWxyZWFkeSBiZWluZyBwcm9jZXNzZWQKKyAqIC1FVElN
RURPVVQgd2hlbiByZWNlaXZpbmcgcmVwbHkgaXMgdGltZWQgb3V0CisgKiAtRUlPIHdoZW4gcmVj
ZWl2ZWQgYnl0ZXMgYXJlIGxlc3MgdGhhbiByZXF1ZXN0ZWQKKyAqLworc3RhdGljIGludCB6eW5x
bXBfZHBfYXV4X2NtZF9zdWJtaXQoc3RydWN0IHp5bnFtcF9kcCAqZHAsIHUzMiBjbWQsIHUxNiBh
ZGRyLAorCQkJCSAgICB1OCAqYnVmLCB1OCBieXRlcywgdTggKnJlcGx5KQoreworCWJvb2wgaXNf
cmVhZCA9IChjbWQgJiBBVVhfUkVBRF9CSVQpID8gdHJ1ZSA6IGZhbHNlOworCXUzMiByZWcsIGk7
CisKKwlyZWcgPSB6eW5xbXBfZHBfcmVhZChkcCwgWllOUU1QX0RQX0lOVEVSUlVQVF9TSUdOQUxf
U1RBVEUpOworCWlmIChyZWcgJiBaWU5RTVBfRFBfSU5URVJSVVBUX1NJR05BTF9TVEFURV9SRVFV
RVNUKQorCQlyZXR1cm4gLUVCVVNZOworCisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBf
QVVYX0FERFJFU1MsIGFkZHIpOworCWlmICghaXNfcmVhZCkKKwkJZm9yIChpID0gMDsgaSA8IGJ5
dGVzOyBpKyspCisJCQl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9BVVhfV1JJVEVfRklG
TywKKwkJCQkJYnVmW2ldKTsKKworCXJlZyA9IGNtZCA8PCBaWU5RTVBfRFBfQVVYX0NPTU1BTkRf
Q01EX1NISUZUOworCWlmICghYnVmIHx8ICFieXRlcykKKwkJcmVnIHw9IFpZTlFNUF9EUF9BVVhf
Q09NTUFORF9BRERSRVNTX09OTFk7CisJZWxzZQorCQlyZWcgfD0gKGJ5dGVzIC0gMSkgPDwgWllO
UU1QX0RQX0FVWF9DT01NQU5EX0JZVEVTX1NISUZUOworCXp5bnFtcF9kcF93cml0ZShkcCwgWllO
UU1QX0RQX0FVWF9DT01NQU5ELCByZWcpOworCisJLyogV2FpdCBmb3IgcmVwbHkgdG8gYmUgZGVs
aXZlcmVkIHVwdG8gMm1zICovCisJZm9yIChpID0gMDsgOyBpKyspIHsKKwkJcmVnID0genlucW1w
X2RwX3JlYWQoZHAsIFpZTlFNUF9EUF9JTlRFUlJVUFRfU0lHTkFMX1NUQVRFKTsKKwkJaWYgKHJl
ZyAmIFpZTlFNUF9EUF9JTlRFUlJVUFRfU0lHTkFMX1NUQVRFX1JFUExZKQorCQkJYnJlYWs7CisK
KwkJaWYgKHJlZyAmIFpZTlFNUF9EUF9JTlRFUlJVUFRfU0lHTkFMX1NUQVRFX1JFUExZX1RJTUVP
VVQgfHwKKwkJICAgIGkgPT0gMikKKwkJCXJldHVybiAtRVRJTUVET1VUOworCisJCXVzbGVlcF9y
YW5nZSgxMDAwLCAxMTAwKTsKKwl9CisKKwlyZWcgPSB6eW5xbXBfZHBfcmVhZChkcCwgWllOUU1Q
X0RQX0FVWF9SRVBMWV9DT0RFKTsKKwlpZiAocmVwbHkpCisJCSpyZXBseSA9IHJlZzsKKworCWlm
IChpc19yZWFkICYmCisJICAgIChyZWcgPT0gWllOUU1QX0RQX0FVWF9SRVBMWV9DT0RFX0FVWF9B
Q0sgfHwKKwkgICAgIHJlZyA9PSBaWU5RTVBfRFBfQVVYX1JFUExZX0NPREVfSTJDX0FDSykpIHsK
KwkJcmVnID0genlucW1wX2RwX3JlYWQoZHAsIFpZTlFNUF9EUF9SRVBMWV9EQVRBX0NPVU5UKTsK
KwkJaWYgKChyZWcgJiBaWU5RTVBfRFBfUkVQTFlfREFUQV9DT1VOVF9NQVNLKSAhPSBieXRlcykK
KwkJCXJldHVybiAtRUlPOworCisJCWZvciAoaSA9IDA7IGkgPCBieXRlczsgaSsrKQorCQkJYnVm
W2ldID0genlucW1wX2RwX3JlYWQoZHAsIFpZTlFNUF9EUF9BVVhfUkVQTFlfREFUQSk7CisJfQor
CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBzc2l6ZV90Cit6eW5xbXBfZHBfYXV4X3RyYW5zZmVy
KHN0cnVjdCBkcm1fZHBfYXV4ICphdXgsIHN0cnVjdCBkcm1fZHBfYXV4X21zZyAqbXNnKQorewor
CXN0cnVjdCB6eW5xbXBfZHAgKmRwID0gY29udGFpbmVyX29mKGF1eCwgc3RydWN0IHp5bnFtcF9k
cCwgYXV4KTsKKwlpbnQgcmV0OworCXVuc2lnbmVkIGludCBpLCBpdGVyOworCisJLyogTnVtYmVy
IG9mIGxvb3BzID0gdGltZW91dCBpbiBtc2VjIC8gYXV4IGRlbGF5ICg0MDAgdXNlYykgKi8KKwlp
dGVyID0genlucW1wX2RwX2F1eF90aW1lb3V0X21zICogMTAwMCAvIDQwMDsKKwlpdGVyID0gaXRl
ciA/IGl0ZXIgOiAxOworCisJZm9yIChpID0gMDsgaSA8IGl0ZXI7IGkrKykgeworCQlyZXQgPSB6
eW5xbXBfZHBfYXV4X2NtZF9zdWJtaXQoZHAsIG1zZy0+cmVxdWVzdCwgbXNnLT5hZGRyZXNzLAor
CQkJCQkgICAgICAgbXNnLT5idWZmZXIsIG1zZy0+c2l6ZSwKKwkJCQkJICAgICAgICZtc2ctPnJl
cGx5KTsKKwkJaWYgKCFyZXQpIHsKKwkJCWRldl9kYmcoZHAtPmRldiwgImF1eCAlZCByZXRyaWVz
XG4iLCBpKTsKKwkJCXJldHVybiBtc2ctPnNpemU7CisJCX0KKworCQlpZiAoZHAtPnN0YXR1cyA9
PSBjb25uZWN0b3Jfc3RhdHVzX2Rpc2Nvbm5lY3RlZCkgeworCQkJZGV2X2RiZyhkcC0+ZGV2LCAi
bm8gY29ubmVjdGVkIGF1eCBkZXZpY2VcbiIpOworCQkJcmV0dXJuIC1FTk9ERVY7CisJCX0KKwor
CQl1c2xlZXBfcmFuZ2UoNDAwLCA1MDApOworCX0KKworCWRldl9kYmcoZHAtPmRldiwgImZhaWxl
ZCB0byBkbyBhdXggdHJhbnNmZXIgKCVkKVxuIiwgcmV0KTsKKworCXJldHVybiByZXQ7Cit9CisK
Ky8qKgorICogenlucW1wX2RwX2F1eF9pbml0IC0gSW5pdGlhbGl6ZSBhbmQgcmVnaXN0ZXIgdGhl
IERQIEFVWAorICogQGRwOiBEaXNwbGF5UG9ydCBJUCBjb3JlIHN0cnVjdHVyZQorICoKKyAqIFBy
b2dyYW0gdGhlIEFVWCBjbG9jayBkaXZpZGVyIGFuZCBmaWx0ZXIgYW5kIHJlZ2lzdGVyIHRoZSBE
UCBBVVggYWRhcHRlci4KKyAqCisgKiBSZXR1cm46IDAgb24gc3VjY2VzcywgZXJyb3IgdmFsdWUg
b3RoZXJ3aXNlCisgKi8KK3N0YXRpYyBpbnQgenlucW1wX2RwX2F1eF9pbml0KHN0cnVjdCB6eW5x
bXBfZHAgKmRwKQoreworCXVuc2lnbmVkIGxvbmcgcmF0ZTsKKwl1bnNpZ25lZCBpbnQgdzsKKwor
CS8qCisJICogVGhlIEFVWF9TSUdOQUxfV0lEVEhfRklMVEVSIGlzIHRoZSBudW1iZXIgb2YgQVhJ
IGNsb2NrIGN5Y2xlcworCSAqIGNvcnJlc3BvbmRpbmcgdG8gdGhlIEFVWCBwdWxzZS4gQWxsb3dh
YmxlIHZhbHVlcyBhcmUgOCwgMTYsIDI0LCAzMiwKKwkgKiA0MCBhbmQgNDguIFRoZSBBVVggcHVs
c2Ugd2lkdGggbXVzdCBiZSBiZXR3ZWVuIDAuNMK1cyBhbmQgMC42wrVzLAorCSAqIGNvbXB1dGUg
dGhlIHcgLyA4IHZhbHVlIGNvcnJlc3BvbmRpbmcgdG8gMC40wrVzIHJvdW5kZWQgdXAsIGFuZCBt
YWtlCisJICogc3VyZSBpdCBzdGF5cyBiZWxvdyAwLjbCtXMgYW5kIHdpdGhpbiB0aGUgYWxsb3dh
YmxlIHZhbHVlcy4KKwkgKi8KKwlyYXRlID0gY2xrX2dldF9yYXRlKGRwLT5kcHN1Yi0+YXBiX2Ns
ayk7CisJdyA9IERJVl9ST1VORF9VUCg0ICogcmF0ZSwgMTAwMCAqIDEwMDAgKiAxMCAqIDgpICog
ODsKKwlpZiAodyA+IDYgKiByYXRlIC8gKDEwMDAgKiAxMDAwICogMTApIHx8IHcgPiA0OCkgewor
CQlkZXZfZXJyKGRwLT5kZXYsICJhY2xrIGZyZXF1ZW5jeSB0b28gaGlnaFxuIik7CisJCXJldHVy
biAtRUlOVkFMOworCX0KKworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX0FVWF9DTEtf
RElWSURFUiwKKwkJCSh3IDw8IFpZTlFNUF9EUF9BVVhfQ0xLX0RJVklERVJfQVVYX0ZJTFRFUl9T
SElGVCkgfAorCQkJKHJhdGUgLyAoMTAwMCAqIDEwMDApKSk7CisKKwlkcC0+YXV4Lm5hbWUgPSAi
WnlucU1QIERQIEFVWCI7CisJZHAtPmF1eC5kZXYgPSBkcC0+ZGV2OworCWRwLT5hdXgudHJhbnNm
ZXIgPSB6eW5xbXBfZHBfYXV4X3RyYW5zZmVyOworCisJcmV0dXJuIGRybV9kcF9hdXhfcmVnaXN0
ZXIoJmRwLT5hdXgpOworfQorCisvKioKKyAqIHp5bnFtcF9kcF9hdXhfY2xlYW51cCAtIENsZWFu
dXAgdGhlIERQIEFVWAorICogQGRwOiBEaXNwbGF5UG9ydCBJUCBjb3JlIHN0cnVjdHVyZQorICoK
KyAqIFVucmVnaXN0ZXIgdGhlIERQIEFVWCBhZGFwdGVyLgorICovCitzdGF0aWMgdm9pZCB6eW5x
bXBfZHBfYXV4X2NsZWFudXAoc3RydWN0IHp5bnFtcF9kcCAqZHApCit7CisJZHJtX2RwX2F1eF91
bnJlZ2lzdGVyKCZkcC0+YXV4KTsKK30KKworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqIERp
c3BsYXlQb3J0IEdlbmVyaWMgU3VwcG9ydAorICovCisKKy8qKgorICogenlucW1wX2RwX3VwZGF0
ZV9taXNjIC0gV3JpdGUgdGhlIG1pc2MgcmVnaXN0ZXJzCisgKiBAZHA6IERpc3BsYXlQb3J0IElQ
IGNvcmUgc3RydWN0dXJlCisgKgorICogVGhlIG1pc2MgcmVnaXN0ZXIgdmFsdWVzIGFyZSBzdG9y
ZWQgaW4gdGhlIHN0cnVjdHVyZSwgYW5kIHRoaXMKKyAqIGZ1bmN0aW9uIGFwcGxpZXMgdGhlIHZh
bHVlcyBpbnRvIHRoZSByZWdpc3RlcnMuCisgKi8KK3N0YXRpYyB2b2lkIHp5bnFtcF9kcF91cGRh
dGVfbWlzYyhzdHJ1Y3QgenlucW1wX2RwICpkcCkKK3sKKwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZ
TlFNUF9EUF9NQUlOX1NUUkVBTV9NSVNDMCwgZHAtPmNvbmZpZy5taXNjMCk7CisJenlucW1wX2Rw
X3dyaXRlKGRwLCBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fTUlTQzEsIGRwLT5jb25maWcubWlzYzEp
OworfQorCisvKioKKyAqIHp5bnFtcF9kcF9zZXRfZm9ybWF0IC0gU2V0IHRoZSBpbnB1dCBmb3Jt
YXQKKyAqIEBkcDogRGlzcGxheVBvcnQgSVAgY29yZSBzdHJ1Y3R1cmUKKyAqIEBmb3JtYXQ6IGlu
cHV0IGZvcm1hdAorICogQGJwYzogYml0cyBwZXIgY29tcG9uZW50CisgKgorICogVXBkYXRlIG1p
c2MgcmVnaXN0ZXIgdmFsdWVzIGJhc2VkIG9uIGlucHV0IEBmb3JtYXQgYW5kIEBicGMuCisgKgor
ICogUmV0dXJuOiAwIG9uIHN1Y2Nlc3MsIG9yIC1FSU5WQUwuCisgKi8KK3N0YXRpYyBpbnQgenlu
cW1wX2RwX3NldF9mb3JtYXQoc3RydWN0IHp5bnFtcF9kcCAqZHAsCisJCQkJZW51bSB6eW5xbXBf
ZHBzdWJfZm9ybWF0IGZvcm1hdCwKKwkJCQl1bnNpZ25lZCBpbnQgYnBjKQoreworCXN0YXRpYyBj
b25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfaW5mbyAqZGlzcGxheTsKKwlzdHJ1Y3QgenlucW1wX2Rw
X2NvbmZpZyAqY29uZmlnID0gJmRwLT5jb25maWc7CisJdW5zaWduZWQgaW50IG51bV9jb2xvcnM7
CisKKwljb25maWctPm1pc2MwICY9IH5aWU5RTVBfRFBfTUFJTl9TVFJFQU1fTUlTQzBfQ09NUF9G
T1JNQVRfTUFTSzsKKwljb25maWctPm1pc2MxICY9IH5aWU5RTVBfRFBfTUFJTl9TVFJFQU1fTUlT
QzFfWV9PTkxZX0VOOworCisJc3dpdGNoIChmb3JtYXQpIHsKKwljYXNlIFpZTlFNUF9EUFNVQl9G
T1JNQVRfUkdCOgorCQljb25maWctPm1pc2MwIHw9IFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9NSVND
MF9DT01QX0ZPUk1BVF9SR0I7CisJCW51bV9jb2xvcnMgPSAzOworCQlicmVhazsKKworCWNhc2Ug
WllOUU1QX0RQU1VCX0ZPUk1BVF9ZQ1JDQjQ0NDoKKwkJY29uZmlnLT5taXNjMCB8PSBaWU5RTVBf
RFBfTUFJTl9TVFJFQU1fTUlTQzBfQ09NUF9GT1JNQVRfWUNSQ0JfNDQ0OworCQludW1fY29sb3Jz
ID0gMzsKKwkJYnJlYWs7CisKKwljYXNlIFpZTlFNUF9EUFNVQl9GT1JNQVRfWUNSQ0I0MjI6CisJ
CWNvbmZpZy0+bWlzYzAgfD0gWllOUU1QX0RQX01BSU5fU1RSRUFNX01JU0MwX0NPTVBfRk9STUFU
X1lDUkNCXzQyMjsKKwkJbnVtX2NvbG9ycyA9IDI7CisJCWJyZWFrOworCisJY2FzZSBaWU5RTVBf
RFBTVUJfRk9STUFUX1lPTkxZOgorCQljb25maWctPm1pc2MxIHw9IFpZTlFNUF9EUF9NQUlOX1NU
UkVBTV9NSVNDMV9ZX09OTFlfRU47CisJCW51bV9jb2xvcnMgPSAxOworCQlicmVhazsKKworCWRl
ZmF1bHQ6CisJCWRldl9lcnIoZHAtPmRldiwgIkludmFsaWQgY29sb3JtZXRyeSBpbiBEVFxuIik7
CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCWRpc3BsYXkgPSAmZHAtPmNvbm5lY3Rvci5kaXNw
bGF5X2luZm87CisJaWYgKGRpc3BsYXktPmJwYyAmJiBicGMgPiBkaXNwbGF5LT5icGMpIHsKKwkJ
ZGV2X3dhcm4oZHAtPmRldiwKKwkJCSAiZG93bmdyYWRpbmcgcmVxdWVzdGVkICV1YnBjIHRvIGRp
c3BsYXkgbGltaXQgJXVicGNcbiIsCisJCQkgYnBjLCBkaXNwbGF5LT5icGMpOworCQlicGMgPSBk
aXNwbGF5LT5icGM7CisJfQorCisJY29uZmlnLT5taXNjMCAmPSB+WllOUU1QX0RQX01BSU5fU1RS
RUFNX01JU0MwX0JQQ19NQVNLOworCisJc3dpdGNoIChicGMpIHsKKwljYXNlIDY6CisJCWNvbmZp
Zy0+bWlzYzAgfD0gWllOUU1QX0RQX01BSU5fU1RSRUFNX01JU0MwX0JQQ182OworCQlicmVhazsK
KwljYXNlIDg6CisJCWNvbmZpZy0+bWlzYzAgfD0gWllOUU1QX0RQX01BSU5fU1RSRUFNX01JU0Mw
X0JQQ184OworCQlicmVhazsKKwljYXNlIDEwOgorCQljb25maWctPm1pc2MwIHw9IFpZTlFNUF9E
UF9NQUlOX1NUUkVBTV9NSVNDMF9CUENfMTA7CisJCWJyZWFrOworCWNhc2UgMTI6CisJCWNvbmZp
Zy0+bWlzYzAgfD0gWllOUU1QX0RQX01BSU5fU1RSRUFNX01JU0MwX0JQQ18xMjsKKwkJYnJlYWs7
CisJY2FzZSAxNjoKKwkJY29uZmlnLT5taXNjMCB8PSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fTUlT
QzBfQlBDXzE2OworCQlicmVhazsKKwlkZWZhdWx0OgorCQlkZXZfd2FybihkcC0+ZGV2LCAiTm90
IHN1cHBvcnRlZCBicGMgKCV1KS4gZmFsbCBiYWNrIHRvIDhicGNcbiIsCisJCQkgYnBjKTsKKwkJ
Y29uZmlnLT5taXNjMCB8PSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fTUlTQzBfQlBDXzg7CisJCWJw
YyA9IDg7CisJCWJyZWFrOworCX0KKworCS8qIFVwZGF0ZSB0aGUgY3VycmVudCBicHAgYmFzZWQg
b24gdGhlIGZvcm1hdC4gKi8KKwljb25maWctPmJwcCA9IGJwYyAqIG51bV9jb2xvcnM7CisKKwly
ZXR1cm4gMDsKK30KKworLyoqCisgKiB6eW5xbXBfZHBfZW5jb2Rlcl9tb2RlX3NldF90cmFuc2Zl
cl91bml0IC0gU2V0IHRoZSB0cmFuc2ZlciB1bml0IHZhbHVlcworICogQGRwOiBEaXNwbGF5UG9y
dCBJUCBjb3JlIHN0cnVjdHVyZQorICogQG1vZGU6IHJlcXVlc3RlZCBkaXNwbGF5IG1vZGUKKyAq
CisgKiBTZXQgdGhlIHRyYW5zZmVyIHVuaXQsIGFuZCBjYWxjdWxhdGUgYWxsIHRyYW5zZmVyIHVu
aXQgc2l6ZSByZWxhdGVkIHZhbHVlcy4KKyAqIENhbGN1bGF0aW9uIGlzIGJhc2VkIG9uIERQIGFu
ZCBJUCBjb3JlIHNwZWNpZmljYXRpb24uCisgKi8KK3N0YXRpYyB2b2lkCit6eW5xbXBfZHBfZW5j
b2Rlcl9tb2RlX3NldF90cmFuc2Zlcl91bml0KHN0cnVjdCB6eW5xbXBfZHAgKmRwLAorCQkJCQkg
c3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUpCit7CisJdTMyIHR1ID0gWllOUU1QX0RQX01T
QV9UUkFOU0ZFUl9VTklUX1NJWkVfVFVfU0laRV9ERUY7CisJdTMyIGJ3LCB2aWRfa2J5dGVzLCBh
dmdfYnl0ZXNfcGVyX3R1LCBpbml0X3dhaXQ7CisKKwkvKiBVc2UgdGhlIG1heCB0cmFuc2ZlciB1
bml0IHNpemUgKGRlZmF1bHQpICovCisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfTVNB
X1RSQU5TRkVSX1VOSVRfU0laRSwgdHUpOworCisJdmlkX2tieXRlcyA9IG1vZGUtPmNsb2NrICog
KGRwLT5jb25maWcuYnBwIC8gOCk7CisJYncgPSBkcm1fZHBfYndfY29kZV90b19saW5rX3JhdGUo
ZHAtPm1vZGUuYndfY29kZSk7CisJYXZnX2J5dGVzX3Blcl90dSA9IHZpZF9rYnl0ZXMgKiB0dSAv
IChkcC0+bW9kZS5sYW5lX2NudCAqIGJ3IC8gMTAwMCk7CisJenlucW1wX2RwX3dyaXRlKGRwLCBa
WU5RTVBfRFBfTUlOX0JZVEVTX1BFUl9UVSwKKwkJCWF2Z19ieXRlc19wZXJfdHUgLyAxMDAwKTsK
Kwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9GUkFDX0JZVEVTX1BFUl9UVSwKKwkJCWF2
Z19ieXRlc19wZXJfdHUgJSAxMDAwKTsKKworCS8qIENvbmZpZ3VyZSB0aGUgaW5pdGlhbCB3YWl0
IGN5Y2xlIGJhc2VkIG9uIHRyYW5zZmVyIHVuaXQgc2l6ZSAqLworCWlmICh0dSA8IChhdmdfYnl0
ZXNfcGVyX3R1IC8gMTAwMCkpCisJCWluaXRfd2FpdCA9IDA7CisJZWxzZSBpZiAoKGF2Z19ieXRl
c19wZXJfdHUgLyAxMDAwKSA8PSA0KQorCQlpbml0X3dhaXQgPSB0dTsKKwllbHNlCisJCWluaXRf
d2FpdCA9IHR1IC0gYXZnX2J5dGVzX3Blcl90dSAvIDEwMDA7CisKKwl6eW5xbXBfZHBfd3JpdGUo
ZHAsIFpZTlFNUF9EUF9JTklUX1dBSVQsIGluaXRfd2FpdCk7Cit9CisKKy8qKgorICogenlucW1w
X2RwX2VuY29kZXJfbW9kZV9zZXRfc3RyZWFtIC0gQ29uZmlndXJlIHRoZSBtYWluIHN0cmVhbQor
ICogQGRwOiBEaXNwbGF5UG9ydCBJUCBjb3JlIHN0cnVjdHVyZQorICogQG1vZGU6IHJlcXVlc3Rl
ZCBkaXNwbGF5IG1vZGUKKyAqCisgKiBDb25maWd1cmUgdGhlIG1haW4gc3RyZWFtIGJhc2VkIG9u
IHRoZSByZXF1ZXN0ZWQgbW9kZSBAbW9kZS4gQ2FsY3VsYXRpb24gaXMKKyAqIGJhc2VkIG9uIElQ
IGNvcmUgc3BlY2lmaWNhdGlvbi4KKyAqLworc3RhdGljIHZvaWQgenlucW1wX2RwX2VuY29kZXJf
bW9kZV9zZXRfc3RyZWFtKHN0cnVjdCB6eW5xbXBfZHAgKmRwLAorCQkJCQkgICAgICBjb25zdCBz
dHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkKK3sKKwl1OCBsYW5lX2NudCA9IGRwLT5tb2Rl
LmxhbmVfY250OworCXUzMiByZWcsIHdwbDsKKwl1bnNpZ25lZCBpbnQgcmF0ZTsKKworCXp5bnFt
cF9kcF93cml0ZShkcCwgWllOUU1QX0RQX01BSU5fU1RSRUFNX0hUT1RBTCwgbW9kZS0+aHRvdGFs
KTsKKwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9WVE9UQUwsIG1v
ZGUtPnZ0b3RhbCk7CisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfTUFJTl9TVFJFQU1f
UE9MQVJJVFksCisJCQkoISEobW9kZS0+ZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX1BWU1lOQykgPDwK
KwkJCSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fUE9MQVJJVFlfVlNZTkNfU0hJRlQpIHwKKwkJCSgh
IShtb2RlLT5mbGFncyAmIERSTV9NT0RFX0ZMQUdfUEhTWU5DKSA8PAorCQkJIFpZTlFNUF9EUF9N
QUlOX1NUUkVBTV9QT0xBUklUWV9IU1lOQ19TSElGVCkpOworCXp5bnFtcF9kcF93cml0ZShkcCwg
WllOUU1QX0RQX01BSU5fU1RSRUFNX0hTV0lEVEgsCisJCQltb2RlLT5oc3luY19lbmQgLSBtb2Rl
LT5oc3luY19zdGFydCk7CisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfTUFJTl9TVFJF
QU1fVlNXSURUSCwKKwkJCW1vZGUtPnZzeW5jX2VuZCAtIG1vZGUtPnZzeW5jX3N0YXJ0KTsKKwl6
eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9IUkVTLCBtb2RlLT5oZGlz
cGxheSk7CisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fVlJFUywg
bW9kZS0+dmRpc3BsYXkpOworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX01BSU5fU1RS
RUFNX0hTVEFSVCwKKwkJCW1vZGUtPmh0b3RhbCAtIG1vZGUtPmhzeW5jX3N0YXJ0KTsKKwl6eW5x
bXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9WU1RBUlQsCisJCQltb2RlLT52
dG90YWwgLSBtb2RlLT52c3luY19zdGFydCk7CisKKwkvKiBJbiBzeW5jaHJvbm91cyBtb2RlLCBz
ZXQgdGhlIGRpdmllcnMgKi8KKwlpZiAoZHAtPmNvbmZpZy5taXNjMCAmIFpZTlFNUF9EUF9NQUlO
X1NUUkVBTV9NSVNDMF9TWU5DX0xPQ0spIHsKKwkJcmVnID0gZHJtX2RwX2J3X2NvZGVfdG9fbGlu
a19yYXRlKGRwLT5tb2RlLmJ3X2NvZGUpOworCQl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9E
UF9NQUlOX1NUUkVBTV9OX1ZJRCwgcmVnKTsKKwkJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBf
RFBfTUFJTl9TVFJFQU1fTV9WSUQsIG1vZGUtPmNsb2NrKTsKKwkJcmF0ZSA9IHp5bnFtcF9kaXNw
X2dldF9hdWRpb19jbGtfcmF0ZShkcC0+ZHBzdWItPmRpc3ApOworCQlpZiAocmF0ZSkgeworCQkJ
ZGV2X2RiZyhkcC0+ZGV2LCAiQXVkaW8gcmF0ZTogJWRcbiIsIHJhdGUgLyA1MTIpOworCQkJenlu
cW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfVFhfTl9BVUQsIHJlZyk7CisJCQl6eW5xbXBfZHBf
d3JpdGUoZHAsIFpZTlFNUF9EUF9UWF9NX0FVRCwgcmF0ZSAvIDEwMDApOworCQl9CisJfQorCisJ
LyogT25seSAyIGNoYW5uZWwgYXVkaW8gaXMgc3VwcG9ydGVkIG5vdyAqLworCWlmICh6eW5xbXBf
ZGlzcF9hdWRpb19lbmFibGVkKGRwLT5kcHN1Yi0+ZGlzcCkpCisJCXp5bnFtcF9kcF93cml0ZShk
cCwgWllOUU1QX0RQX1RYX0FVRElPX0NIQU5ORUxTLCAxKTsKKworCXp5bnFtcF9kcF93cml0ZShk
cCwgWllOUU1QX0RQX1VTRVJfUElYX1dJRFRILCAxKTsKKworCS8qIFRyYW5zbGF0ZSB0byB0aGUg
bmF0aXZlIDE2IGJpdCBkYXRhcGF0aCBiYXNlZCBvbiBJUCBjb3JlIHNwZWMgKi8KKwl3cGwgPSAo
bW9kZS0+aGRpc3BsYXkgKiBkcC0+Y29uZmlnLmJwcCArIDE1KSAvIDE2OworCXJlZyA9IHdwbCAr
IHdwbCAlIGxhbmVfY250IC0gbGFuZV9jbnQ7CisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBf
RFBfVVNFUl9EQVRBX0NPVU5UX1BFUl9MQU5FLCByZWcpOworfQorCisvKiAtLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLQorICogRFJNIENvbm5lY3RvcgorICovCisKK3N0YXRpYyBlbnVtIGRybV9jb25uZWN0
b3Jfc3RhdHVzCit6eW5xbXBfZHBfY29ubmVjdG9yX2RldGVjdChzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
ciAqY29ubmVjdG9yLCBib29sIGZvcmNlKQoreworCXN0cnVjdCB6eW5xbXBfZHAgKmRwID0gY29u
bmVjdG9yX3RvX2RwKGNvbm5lY3Rvcik7CisJc3RydWN0IHp5bnFtcF9kcF9saW5rX2NvbmZpZyAq
bGlua19jb25maWcgPSAmZHAtPmxpbmtfY29uZmlnOworCXUzMiBzdGF0ZSwgaTsKKwlpbnQgcmV0
OworCisJLyoKKwkgKiBUaGlzIGlzIGZyb20gaGV1cmlzdGljLiBJdCB0YWtlcyBzb21lIGRlbGF5
IChleCwgMTAwIH4gNTAwIG1zZWMpIHRvCisJICogZ2V0IHRoZSBIUEQgc2lnbmFsIHdpdGggc29t
ZSBtb25pdG9ycy4KKwkgKi8KKwlmb3IgKGkgPSAwOyBpIDwgMTA7IGkrKykgeworCQlzdGF0ZSA9
IHp5bnFtcF9kcF9yZWFkKGRwLCBaWU5RTVBfRFBfSU5URVJSVVBUX1NJR05BTF9TVEFURSk7CisJ
CWlmIChzdGF0ZSAmIFpZTlFNUF9EUF9JTlRFUlJVUFRfU0lHTkFMX1NUQVRFX0hQRCkKKwkJCWJy
ZWFrOworCQltc2xlZXAoMTAwKTsKKwl9CisKKwlpZiAoc3RhdGUgJiBaWU5RTVBfRFBfSU5URVJS
VVBUX1NJR05BTF9TVEFURV9IUEQpIHsKKwkJcmV0ID0gZHJtX2RwX2RwY2RfcmVhZCgmZHAtPmF1
eCwgMHgwLCBkcC0+ZHBjZCwKKwkJCQkgICAgICAgc2l6ZW9mKGRwLT5kcGNkKSk7CisJCWlmIChy
ZXQgPCAwKSB7CisJCQlkZXZfZGJnKGRwLT5kZXYsICJEUENEIHJlYWQgZmFpbGVzIik7CisJCQln
b3RvIGRpc2Nvbm5lY3RlZDsKKwkJfQorCisJCWxpbmtfY29uZmlnLT5tYXhfcmF0ZSA9IG1pbl90
KGludCwKKwkJCQkJICAgICAgZHJtX2RwX21heF9saW5rX3JhdGUoZHAtPmRwY2QpLAorCQkJCQkg
ICAgICBEUF9ISUdIX0JJVF9SQVRFMik7CisJCWxpbmtfY29uZmlnLT5tYXhfbGFuZXMgPSBtaW5f
dCh1OCwKKwkJCQkJICAgICAgIGRybV9kcF9tYXhfbGFuZV9jb3VudChkcC0+ZHBjZCksCisJCQkJ
CSAgICAgICBkcC0+bnVtX2xhbmVzKTsKKworCQlkcC0+c3RhdHVzID0gY29ubmVjdG9yX3N0YXR1
c19jb25uZWN0ZWQ7CisJCXJldHVybiBjb25uZWN0b3Jfc3RhdHVzX2Nvbm5lY3RlZDsKKwl9CisK
K2Rpc2Nvbm5lY3RlZDoKKwlkcC0+c3RhdHVzID0gY29ubmVjdG9yX3N0YXR1c19kaXNjb25uZWN0
ZWQ7CisJcmV0dXJuIGNvbm5lY3Rvcl9zdGF0dXNfZGlzY29ubmVjdGVkOworfQorCitzdGF0aWMg
aW50IHp5bnFtcF9kcF9jb25uZWN0b3JfZ2V0X21vZGVzKHN0cnVjdCBkcm1fY29ubmVjdG9yICpj
b25uZWN0b3IpCit7CisJc3RydWN0IHp5bnFtcF9kcCAqZHAgPSBjb25uZWN0b3JfdG9fZHAoY29u
bmVjdG9yKTsKKwlzdHJ1Y3QgZWRpZCAqZWRpZDsKKwlpbnQgcmV0OworCisJZWRpZCA9IGRybV9n
ZXRfZWRpZChjb25uZWN0b3IsICZkcC0+YXV4LmRkYyk7CisJaWYgKCFlZGlkKQorCQlyZXR1cm4g
MDsKKworCWRybV9jb25uZWN0b3JfdXBkYXRlX2VkaWRfcHJvcGVydHkoY29ubmVjdG9yLCBlZGlk
KTsKKwlyZXQgPSBkcm1fYWRkX2VkaWRfbW9kZXMoY29ubmVjdG9yLCBlZGlkKTsKKwlrZnJlZShl
ZGlkKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgZHJtX2VuY29kZXIgKgor
enlucW1wX2RwX2Nvbm5lY3Rvcl9iZXN0X2VuY29kZXIoc3RydWN0IGRybV9jb25uZWN0b3IgKmNv
bm5lY3RvcikKK3sKKwlzdHJ1Y3QgenlucW1wX2RwICpkcCA9IGNvbm5lY3Rvcl90b19kcChjb25u
ZWN0b3IpOworCisJcmV0dXJuICZkcC0+ZW5jb2RlcjsKK30KKworc3RhdGljIGludCB6eW5xbXBf
ZHBfY29ubmVjdG9yX21vZGVfdmFsaWQoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwK
KwkJCQkJICBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkKK3sKKwlzdHJ1Y3QgenlucW1w
X2RwICpkcCA9IGNvbm5lY3Rvcl90b19kcChjb25uZWN0b3IpOworCXU4IG1heF9sYW5lcyA9IGRw
LT5saW5rX2NvbmZpZy5tYXhfbGFuZXM7CisJdTggYnBwID0gZHAtPmNvbmZpZy5icHA7CisJaW50
IG1heF9yYXRlID0gZHAtPmxpbmtfY29uZmlnLm1heF9yYXRlOworCWludCByYXRlOworCisJaWYg
KG1vZGUtPmNsb2NrID4gWllOUU1QX01BWF9GUkVRKSB7CisJCWRldl9kYmcoZHAtPmRldiwgImZp
bHRlcmVkIHRoZSBtb2RlLCAlcyxmb3IgaGlnaCBwaXhlbCByYXRlXG4iLAorCQkJbW9kZS0+bmFt
ZSk7CisJCWRybV9tb2RlX2RlYnVnX3ByaW50bW9kZWxpbmUobW9kZSk7CisJCXJldHVybiBNT0RF
X0NMT0NLX0hJR0g7CisJfQorCisJLyogQ2hlY2sgd2l0aCBsaW5rIHJhdGUgYW5kIGxhbmUgY291
bnQgKi8KKwlyYXRlID0genlucW1wX2RwX21heF9yYXRlKG1heF9yYXRlLCBtYXhfbGFuZXMsIGJw
cCk7CisJaWYgKG1vZGUtPmNsb2NrID4gcmF0ZSkgeworCQlkZXZfZGJnKGRwLT5kZXYsICJmaWx0
ZXJlZCB0aGUgbW9kZSwgJXMsZm9yIGhpZ2ggcGl4ZWwgcmF0ZVxuIiwKKwkJCW1vZGUtPm5hbWUp
OworCQlkcm1fbW9kZV9kZWJ1Z19wcmludG1vZGVsaW5lKG1vZGUpOworCQlyZXR1cm4gTU9ERV9D
TE9DS19ISUdIOworCX0KKworCXJldHVybiBNT0RFX09LOworfQorCitzdGF0aWMgY29uc3Qgc3Ry
dWN0IGRybV9jb25uZWN0b3JfZnVuY3MgenlucW1wX2RwX2Nvbm5lY3Rvcl9mdW5jcyA9IHsKKwku
ZGV0ZWN0CQkJPSB6eW5xbXBfZHBfY29ubmVjdG9yX2RldGVjdCwKKwkuZmlsbF9tb2RlcwkJPSBk
cm1faGVscGVyX3Byb2JlX3NpbmdsZV9jb25uZWN0b3JfbW9kZXMsCisJLmRlc3Ryb3kJCT0gZHJt
X2Nvbm5lY3Rvcl9jbGVhbnVwLAorCS5hdG9taWNfZHVwbGljYXRlX3N0YXRlCT0gZHJtX2F0b21p
Y19oZWxwZXJfY29ubmVjdG9yX2R1cGxpY2F0ZV9zdGF0ZSwKKwkuYXRvbWljX2Rlc3Ryb3lfc3Rh
dGUJPSBkcm1fYXRvbWljX2hlbHBlcl9jb25uZWN0b3JfZGVzdHJveV9zdGF0ZSwKKwkucmVzZXQJ
CQk9IGRybV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9yZXNldCwKK307CisKK3N0YXRpYyBjb25z
dCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9oZWxwZXJfZnVuY3MKK3p5bnFtcF9kcF9jb25uZWN0b3Jf
aGVscGVyX2Z1bmNzID0geworCS5nZXRfbW9kZXMJPSB6eW5xbXBfZHBfY29ubmVjdG9yX2dldF9t
b2RlcywKKwkuYmVzdF9lbmNvZGVyCT0genlucW1wX2RwX2Nvbm5lY3Rvcl9iZXN0X2VuY29kZXIs
CisJLm1vZGVfdmFsaWQJPSB6eW5xbXBfZHBfY29ubmVjdG9yX21vZGVfdmFsaWQsCit9OworCisv
KiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICogRFJNIEVuY29kZXIKKyAqLworCitzdGF0aWMgdm9p
ZCB6eW5xbXBfZHBfZW5jb2Rlcl9lbmFibGUoc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyKQor
eworCXN0cnVjdCB6eW5xbXBfZHAgKmRwID0gZW5jb2Rlcl90b19kcChlbmNvZGVyKTsKKwl1bnNp
Z25lZCBpbnQgaTsKKwlpbnQgcmV0ID0gMDsKKworCXBtX3J1bnRpbWVfZ2V0X3N5bmMoZHAtPmRl
dik7CisJZHAtPmVuYWJsZWQgPSB0cnVlOworCXp5bnFtcF9kcF91cGRhdGVfbWlzYyhkcCk7CisJ
aWYgKHp5bnFtcF9kaXNwX2F1ZGlvX2VuYWJsZWQoZHAtPmRwc3ViLT5kaXNwKSkKKwkJenlucW1w
X2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfVFhfQVVESU9fQ09OVFJPTCwgMSk7CisJenlucW1wX2Rw
X3dyaXRlKGRwLCBaWU5RTVBfRFBfVFhfUEhZX1BPV0VSX0RPV04sIDApOworCWlmIChkcC0+c3Rh
dHVzID09IGNvbm5lY3Rvcl9zdGF0dXNfY29ubmVjdGVkKSB7CisJCWZvciAoaSA9IDA7IGkgPCAz
OyBpKyspIHsKKwkJCXJldCA9IGRybV9kcF9kcGNkX3dyaXRlYigmZHAtPmF1eCwgRFBfU0VUX1BP
V0VSLAorCQkJCQkJIERQX1NFVF9QT1dFUl9EMCk7CisJCQlpZiAocmV0ID09IDEpCisJCQkJYnJl
YWs7CisJCQl1c2xlZXBfcmFuZ2UoMzAwLCA1MDApOworCQl9CisJCS8qIFNvbWUgbW9uaXRvcnMg
dGFrZSB0aW1lIHRvIHdha2UgdXAgcHJvcGVybHkgKi8KKwkJbXNsZWVwKHp5bnFtcF9kcF9wb3dl
cl9vbl9kZWxheV9tcyk7CisJfQorCWlmIChyZXQgIT0gMSkKKwkJZGV2X2RiZyhkcC0+ZGV2LCAi
RFAgYXV4IGZhaWxlZFxuIik7CisJZWxzZQorCQl6eW5xbXBfZHBfdHJhaW5fbG9vcChkcCk7CisJ
enlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfU09GVFdBUkVfUkVTRVQsCisJCQlaWU5RTVBf
RFBfU09GVFdBUkVfUkVTRVRfQUxMKTsKKwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9N
QUlOX1NUUkVBTV9FTkFCTEUsIDEpOworfQorCitzdGF0aWMgdm9pZCB6eW5xbXBfZHBfZW5jb2Rl
cl9kaXNhYmxlKHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcikKK3sKKwlzdHJ1Y3QgenlucW1w
X2RwICpkcCA9IGVuY29kZXJfdG9fZHAoZW5jb2Rlcik7CisKKwlkcC0+ZW5hYmxlZCA9IGZhbHNl
OworCWNhbmNlbF9kZWxheWVkX3dvcmsoJmRwLT5ocGRfd29yayk7CisJenlucW1wX2RwX3dyaXRl
KGRwLCBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fRU5BQkxFLCAwKTsKKwlkcm1fZHBfZHBjZF93cml0
ZWIoJmRwLT5hdXgsIERQX1NFVF9QT1dFUiwgRFBfU0VUX1BPV0VSX0QzKTsKKwl6eW5xbXBfZHBf
d3JpdGUoZHAsIFpZTlFNUF9EUF9UWF9QSFlfUE9XRVJfRE9XTiwKKwkJCVpZTlFNUF9EUF9UWF9Q
SFlfUE9XRVJfRE9XTl9BTEwpOworCWlmICh6eW5xbXBfZGlzcF9hdWRpb19lbmFibGVkKGRwLT5k
cHN1Yi0+ZGlzcCkpCisJCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX1RYX0FVRElPX0NP
TlRST0wsIDApOworCXBtX3J1bnRpbWVfcHV0X3N5bmMoZHAtPmRldik7Cit9CisKK3N0YXRpYyB2
b2lkCit6eW5xbXBfZHBfZW5jb2Rlcl9hdG9taWNfbW9kZV9zZXQoc3RydWN0IGRybV9lbmNvZGVy
ICplbmNvZGVyLAorCQkJCSAgc3RydWN0IGRybV9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAorCQkJ
CSAgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5lY3Rvcl9zdGF0ZSkKK3sKKwlzdHJ1
Y3QgenlucW1wX2RwICpkcCA9IGVuY29kZXJfdG9fZHAoZW5jb2Rlcik7CisJc3RydWN0IGRybV9k
aXNwbGF5X21vZGUgKm1vZGUgPSAmY3J0Y19zdGF0ZS0+bW9kZTsKKwlzdHJ1Y3QgZHJtX2Rpc3Bs
YXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZjcnRjX3N0YXRlLT5hZGp1c3RlZF9tb2RlOworCXU4
IG1heF9sYW5lcyA9IGRwLT5saW5rX2NvbmZpZy5tYXhfbGFuZXM7CisJdTggYnBwID0gZHAtPmNv
bmZpZy5icHA7CisJaW50IHJhdGUsIG1heF9yYXRlID0gZHAtPmxpbmtfY29uZmlnLm1heF9yYXRl
OworCWludCByZXQ7CisKKwl6eW5xbXBfZHBfc2V0X2Zvcm1hdChkcCwgWllOUU1QX0RQU1VCX0ZP
Uk1BVF9SR0IsIDgpOworCisJLyogQ2hlY2sgYWdhaW4gYXMgYnBwIG9yIGZvcm1hdCBtaWdodCBo
YXZlIGJlZW4gY2hhZ25lZCAqLworCXJhdGUgPSB6eW5xbXBfZHBfbWF4X3JhdGUobWF4X3JhdGUs
IG1heF9sYW5lcywgYnBwKTsKKwlpZiAobW9kZS0+Y2xvY2sgPiByYXRlKSB7CisJCWRldl9lcnIo
ZHAtPmRldiwgInRoZSBtb2RlLCAlcyxoYXMgdG9vIGhpZ2ggcGl4ZWwgcmF0ZVxuIiwKKwkJCW1v
ZGUtPm5hbWUpOworCQlkcm1fbW9kZV9kZWJ1Z19wcmludG1vZGVsaW5lKG1vZGUpOworCX0KKwor
CXJldCA9IHp5bnFtcF9kcF9tb2RlX2NvbmZpZ3VyZShkcCwgYWRqdXN0ZWRfbW9kZS0+Y2xvY2ss
IDApOworCWlmIChyZXQgPCAwKQorCQlyZXR1cm47CisKKwl6eW5xbXBfZHBfZW5jb2Rlcl9tb2Rl
X3NldF90cmFuc2Zlcl91bml0KGRwLCBhZGp1c3RlZF9tb2RlKTsKKwl6eW5xbXBfZHBfZW5jb2Rl
cl9tb2RlX3NldF9zdHJlYW0oZHAsIGFkanVzdGVkX21vZGUpOworfQorCisjZGVmaW5lIFpZTlFN
UF9EUF9NSU5fSF9CQUNLUE9SQ0gJMjAKKworc3RhdGljIGludAorenlucW1wX2RwX2VuY29kZXJf
YXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlciwKKwkJCSAgICAgICBzdHJ1
Y3QgZHJtX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCisJCQkgICAgICAgc3RydWN0IGRybV9jb25u
ZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCit7CisJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1v
ZGUgPSAmY3J0Y19zdGF0ZS0+bW9kZTsKKwlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0
ZWRfbW9kZSA9ICZjcnRjX3N0YXRlLT5hZGp1c3RlZF9tb2RlOworCWludCBkaWZmID0gbW9kZS0+
aHRvdGFsIC0gbW9kZS0+aHN5bmNfZW5kOworCisJLyoKKwkgKiBaeW5xTVAgRFAgcmVxdWlyZXMg
aG9yaXpvbnRhbCBiYWNrcG9yY2ggdG8gYmUgZ3JlYXRlciB0aGFuIDEyLgorCSAqIFRoaXMgbGlt
aXRhdGlvbiBtYXkgbm90IGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgc2luayBkZXZpY2UuCisJICov
CisJaWYgKGRpZmYgPCBaWU5RTVBfRFBfTUlOX0hfQkFDS1BPUkNIKSB7CisJCWludCB2cmVmcmVz
aCA9IChhZGp1c3RlZF9tb2RlLT5jbG9jayAqIDEwMDApIC8KKwkJCSAgICAgICAoYWRqdXN0ZWRf
bW9kZS0+dnRvdGFsICogYWRqdXN0ZWRfbW9kZS0+aHRvdGFsKTsKKworCQlkZXZfZGJnKGVuY29k
ZXItPmRldi0+ZGV2LCAiaGJhY2twb3JjaCBhZGp1c3RlZDogJWQgdG8gJWQiLAorCQkJZGlmZiwg
WllOUU1QX0RQX01JTl9IX0JBQ0tQT1JDSCAtIGRpZmYpOworCQlkaWZmID0gWllOUU1QX0RQX01J
Tl9IX0JBQ0tQT1JDSCAtIGRpZmY7CisJCWFkanVzdGVkX21vZGUtPmh0b3RhbCArPSBkaWZmOwor
CQlhZGp1c3RlZF9tb2RlLT5jbG9jayA9IGFkanVzdGVkX21vZGUtPnZ0b3RhbCAqCisJCQkJICAg
ICAgIGFkanVzdGVkX21vZGUtPmh0b3RhbCAqIHZyZWZyZXNoIC8gMTAwMDsKKwl9CisKKwlyZXR1
cm4gMDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZW5jb2Rlcl9mdW5jcyB6eW5xbXBf
ZHBfZW5jb2Rlcl9mdW5jcyA9IHsKKwkuZGVzdHJveQkJPSBkcm1fZW5jb2Rlcl9jbGVhbnVwLAor
fTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZW5jb2Rlcl9oZWxwZXJfZnVuY3MgenlucW1w
X2RwX2VuY29kZXJfaGVscGVyX2Z1bmNzID0geworCS5lbmFibGUJCQk9IHp5bnFtcF9kcF9lbmNv
ZGVyX2VuYWJsZSwKKwkuZGlzYWJsZQkJPSB6eW5xbXBfZHBfZW5jb2Rlcl9kaXNhYmxlLAorCS5h
dG9taWNfbW9kZV9zZXQJPSB6eW5xbXBfZHBfZW5jb2Rlcl9hdG9taWNfbW9kZV9zZXQsCisJLmF0
b21pY19jaGVjawkJPSB6eW5xbXBfZHBfZW5jb2Rlcl9hdG9taWNfY2hlY2ssCit9OworCisvKiAt
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLQorICogSW50ZXJydXB0IEhhbmRsaW5nCisgKi8KKworLyoqCisg
KiB6eW5xbXBfZHBfZW5hYmxlX3ZibGFuayAtIEVuYWJsZSB2YmxhbmsKKyAqIEBkcDogRGlzcGxh
eVBvcnQgSVAgY29yZSBzdHJ1Y3R1cmUKKyAqCisgKiBFbmFibGUgdmJsYW5rIGludGVycnVwdAor
ICovCit2b2lkIHp5bnFtcF9kcF9lbmFibGVfdmJsYW5rKHN0cnVjdCB6eW5xbXBfZHAgKmRwKQor
eworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX0lOVF9FTiwgWllOUU1QX0RQX0lOVF9W
QkxBTktfU1RBUlQpOworfQorCisvKioKKyAqIHp5bnFtcF9kcF9kaXNhYmxlX3ZibGFuayAtIERp
c2FibGUgdmJsYW5rCisgKiBAZHA6IERpc3BsYXlQb3J0IElQIGNvcmUgc3RydWN0dXJlCisgKgor
ICogRGlzYWJsZSB2YmxhbmsgaW50ZXJydXB0CisgKi8KK3ZvaWQgenlucW1wX2RwX2Rpc2FibGVf
dmJsYW5rKHN0cnVjdCB6eW5xbXBfZHAgKmRwKQoreworCXp5bnFtcF9kcF93cml0ZShkcCwgWllO
UU1QX0RQX0lOVF9EUywgWllOUU1QX0RQX0lOVF9WQkxBTktfU1RBUlQpOworfQorCitzdGF0aWMg
dm9pZCB6eW5xbXBfZHBfaHBkX3dvcmtfZnVuYyhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCit7
CisJc3RydWN0IHp5bnFtcF9kcCAqZHA7CisKKwlkcCA9IGNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1
Y3QgenlucW1wX2RwLCBocGRfd29yay53b3JrKTsKKworCWlmIChkcC0+ZHJtKQorCQlkcm1faGVs
cGVyX2hwZF9pcnFfZXZlbnQoZHAtPmRybSk7Cit9CisKK3N0YXRpYyBpcnFyZXR1cm5fdCB6eW5x
bXBfZHBfaXJxX2hhbmRsZXIoaW50IGlycSwgdm9pZCAqZGF0YSkKK3sKKwlzdHJ1Y3QgenlucW1w
X2RwICpkcCA9IChzdHJ1Y3QgenlucW1wX2RwICopZGF0YTsKKwl1MzIgc3RhdHVzLCBtYXNrOwor
CisJc3RhdHVzID0genlucW1wX2RwX3JlYWQoZHAsIFpZTlFNUF9EUF9JTlRfU1RBVFVTKTsKKwlt
YXNrID0genlucW1wX2RwX3JlYWQoZHAsIFpZTlFNUF9EUF9JTlRfTUFTSyk7CisJaWYgKCEoc3Rh
dHVzICYgfm1hc2spKQorCQlyZXR1cm4gSVJRX05PTkU7CisKKwkvKiBkYmcgZm9yIGRpYWdub3N0
aWMsIGJ1dCBub3QgbXVjaCB0aGF0IHRoZSBkcml2ZXIgY2FuIGRvICovCisJaWYgKHN0YXR1cyAm
IFpZTlFNUF9EUF9JTlRfQ0hCVUZfVU5ERVJGTFdfTUFTSykKKwkJZGV2X2RiZ19yYXRlbGltaXRl
ZChkcC0+ZGV2LCAidW5kZXJmbG93IGludGVycnVwdFxuIik7CisJaWYgKHN0YXR1cyAmIFpZTlFN
UF9EUF9JTlRfQ0hCVUZfT1ZFUkZMV19NQVNLKQorCQlkZXZfZGJnX3JhdGVsaW1pdGVkKGRwLT5k
ZXYsICJvdmVyZmxvdyBpbnRlcnJ1cHRcbiIpOworCisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5R
TVBfRFBfSU5UX1NUQVRVUywgc3RhdHVzKTsKKworCWlmIChzdGF0dXMgJiBaWU5RTVBfRFBfSU5U
X1ZCTEFOS19TVEFSVCkKKwkJenlucW1wX2Rpc3BfaGFuZGxlX3ZibGFuayhkcC0+ZHBzdWItPmRp
c3ApOworCisJaWYgKHN0YXR1cyAmIFpZTlFNUF9EUF9JTlRfSFBEX0VWRU5UKQorCQlzY2hlZHVs
ZV9kZWxheWVkX3dvcmsoJmRwLT5ocGRfd29yaywgMCk7CisKKwlpZiAoc3RhdHVzICYgWllOUU1Q
X0RQX0lOVF9IUERfSVJRKSB7CisJCWludCByZXQ7CisJCXU4IHN0YXR1c1tEUF9MSU5LX1NUQVRV
U19TSVpFICsgMl07CisKKwkJcmV0ID0gZHJtX2RwX2RwY2RfcmVhZCgmZHAtPmF1eCwgRFBfU0lO
S19DT1VOVCwgc3RhdHVzLAorCQkJCSAgICAgICBEUF9MSU5LX1NUQVRVU19TSVpFICsgMik7CisJ
CWlmIChyZXQgPCAwKQorCQkJZ290byBoYW5kbGVkOworCisJCWlmIChzdGF0dXNbNF0gJiBEUF9M
SU5LX1NUQVRVU19VUERBVEVEIHx8CisJCSAgICAhZHJtX2RwX2Nsb2NrX3JlY292ZXJ5X29rKCZz
dGF0dXNbMl0sIGRwLT5tb2RlLmxhbmVfY250KSB8fAorCQkgICAgIWRybV9kcF9jaGFubmVsX2Vx
X29rKCZzdGF0dXNbMl0sIGRwLT5tb2RlLmxhbmVfY250KSkgeworCQkJenlucW1wX2RwX3RyYWlu
X2xvb3AoZHApOworCQl9CisJfQorCitoYW5kbGVkOgorCXJldHVybiBJUlFfSEFORExFRDsKK30K
KworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqIEluaXRpYWxpemF0aW9uICYgQ2xlYW51cAor
ICovCisKK2ludCB6eW5xbXBfZHBfaW5pdChzdHJ1Y3QgenlucW1wX2Rwc3ViICpkcHN1Yiwgc3Ry
dWN0IGRybV9kZXZpY2UgKmRybSkKK3sKKwlzdHJ1Y3QgenlucW1wX2RwICpkcCA9IGRwc3ViLT5k
cDsKKwlzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIgPSAmZHAtPmVuY29kZXI7CisJc3RydWN0
IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciA9ICZkcC0+Y29ubmVjdG9yOworCWludCByZXQ7CisK
KwlkcC0+ZHJtID0gZHJtOworCWRwLT5jb25maWcubWlzYzAgJj0gflpZTlFNUF9EUF9NQUlOX1NU
UkVBTV9NSVNDMF9TWU5DX0xPQ0s7CisJenlucW1wX2RwX3NldF9mb3JtYXQoZHAsIFpZTlFNUF9E
UFNVQl9GT1JNQVRfUkdCLCA4KTsKKworCS8qIENyZWF0ZSB0aGUgRFJNIGVuY29kZXIgYW5kIGNv
bm5lY3Rvci4gKi8KKwllbmNvZGVyLT5wb3NzaWJsZV9jcnRjcyB8PSB6eW5xbXBfZGlzcF9nZXRf
Y3J0Y19tYXNrKGRwc3ViLT5kaXNwKTsKKwlkcm1fZW5jb2Rlcl9pbml0KGRybSwgZW5jb2Rlciwg
Jnp5bnFtcF9kcF9lbmNvZGVyX2Z1bmNzLAorCQkJIERSTV9NT0RFX0VOQ09ERVJfVE1EUywgTlVM
TCk7CisJZHJtX2VuY29kZXJfaGVscGVyX2FkZChlbmNvZGVyLCAmenlucW1wX2RwX2VuY29kZXJf
aGVscGVyX2Z1bmNzKTsKKworCWNvbm5lY3Rvci0+cG9sbGVkID0gRFJNX0NPTk5FQ1RPUl9QT0xM
X0hQRDsKKwlyZXQgPSBkcm1fY29ubmVjdG9yX2luaXQoZW5jb2Rlci0+ZGV2LCBjb25uZWN0b3Is
CisJCQkJICZ6eW5xbXBfZHBfY29ubmVjdG9yX2Z1bmNzLAorCQkJCSBEUk1fTU9ERV9DT05ORUNU
T1JfRGlzcGxheVBvcnQpOworCWlmIChyZXQpIHsKKwkJZGV2X2VycihkcC0+ZGV2LCAiZmFpbGVk
IHRvIGNyZWF0ZSB0aGUgRFJNIGNvbm5lY3RvclxuIik7CisJCXJldHVybiByZXQ7CisJfQorCisJ
ZHJtX2Nvbm5lY3Rvcl9oZWxwZXJfYWRkKGNvbm5lY3RvciwgJnp5bnFtcF9kcF9jb25uZWN0b3Jf
aGVscGVyX2Z1bmNzKTsKKwlkcm1fY29ubmVjdG9yX3JlZ2lzdGVyKGNvbm5lY3Rvcik7CisJZHJt
X2Nvbm5lY3Rvcl9hdHRhY2hfZW5jb2Rlcihjb25uZWN0b3IsIGVuY29kZXIpOworCisJLyogSW5p
dGlhbGl6ZSBhbmQgcmVnaXN0ZXIgdGhlIEFVWCBhZGFwdGVyLiAqLworCXJldCA9IHp5bnFtcF9k
cF9hdXhfaW5pdChkcCk7CisJaWYgKHJldCkgeworCQlkZXZfZXJyKGRwLT5kZXYsICJmYWlsZWQg
dG8gaW5pdGlhbGl6ZSBEUCBhdXhcbiIpOworCQlyZXR1cm4gcmV0OworCX0KKworCS8qIE5vdyB0
aGF0IGluaXRpYWxpc2F0aW9uIGlzIGNvbXBsZXRlLCBlbmFibGUgaW50ZXJydXB0cy4gKi8KKwl6
eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9JTlRfRU4sIFpZTlFNUF9EUF9JTlRfQUxMKTsK
KworCXJldHVybiAwOworfQorCit2b2lkIHp5bnFtcF9kcF9jbGVhbnVwKHN0cnVjdCB6eW5xbXBf
ZHBzdWIgKmRwc3ViKQoreworCXN0cnVjdCB6eW5xbXBfZHAgKmRwID0gZHBzdWItPmRwOworCisJ
enlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfSU5UX0RTLCBaWU5RTVBfRFBfSU5UX0FMTCk7
CisJZGlzYWJsZV9pcnEoZHAtPmlycSk7CisKKwljYW5jZWxfZGVsYXllZF93b3JrX3N5bmMoJmRw
LT5ocGRfd29yayk7CisJenlucW1wX2RwX2F1eF9jbGVhbnVwKGRwKTsKK30KKworaW50IHp5bnFt
cF9kcF9wcm9iZShzdHJ1Y3QgenlucW1wX2Rwc3ViICpkcHN1Yiwgc3RydWN0IHBsYXRmb3JtX2Rl
dmljZSAqcGRldikKK3sKKwlzdHJ1Y3QgenlucW1wX2RwICpkcDsKKwlzdHJ1Y3QgcmVzb3VyY2Ug
KnJlczsKKwlpbnQgcmV0OworCisJZHAgPSBkZXZtX2t6YWxsb2MoJnBkZXYtPmRldiwgc2l6ZW9m
KCpkcCksIEdGUF9LRVJORUwpOworCWlmICghZHApCisJCXJldHVybiAtRU5PTUVNOworCisJZHAt
PmRldiA9ICZwZGV2LT5kZXY7CisJZHAtPmRwc3ViID0gZHBzdWI7CisJZHAtPnN0YXR1cyA9IGNv
bm5lY3Rvcl9zdGF0dXNfZGlzY29ubmVjdGVkOworCisJSU5JVF9ERUxBWUVEX1dPUksoJmRwLT5o
cGRfd29yaywgenlucW1wX2RwX2hwZF93b3JrX2Z1bmMpOworCisJLyogQWNxdWlyZSBhbGwgcmVz
b3VyY2VzIChJT01FTSwgSVJRIGFuZCBQSFlzKS4gKi8KKwlyZXMgPSBwbGF0Zm9ybV9nZXRfcmVz
b3VyY2VfYnluYW1lKHBkZXYsIElPUkVTT1VSQ0VfTUVNLCAiZHAiKTsKKwlkcC0+aW9tZW0gPSBk
ZXZtX2lvcmVtYXBfcmVzb3VyY2UoZHAtPmRldiwgcmVzKTsKKwlpZiAoSVNfRVJSKGRwLT5pb21l
bSkpCisJCXJldHVybiBQVFJfRVJSKGRwLT5pb21lbSk7CisKKwlkcC0+aXJxID0gcGxhdGZvcm1f
Z2V0X2lycShwZGV2LCAwKTsKKwlpZiAoZHAtPmlycSA8IDApCisJCXJldHVybiBkcC0+aXJxOwor
CisJcmV0ID0genlucW1wX2RwX3BoeV9wcm9iZShkcCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJl
dDsKKworCS8qIEluaXRpYWxpemUgdGhlIGhhcmR3YXJlLiAqLworCXp5bnFtcF9kcF93cml0ZShk
cCwgWllOUU1QX0RQX1RYX1BIWV9QT1dFUl9ET1dOLAorCQkJWllOUU1QX0RQX1RYX1BIWV9QT1dF
Ul9ET1dOX0FMTCk7CisJenlucW1wX2RwX3NldChkcCwgWllOUU1QX0RQX1BIWV9SRVNFVCwgWllO
UU1QX0RQX1BIWV9SRVNFVF9BTExfUkVTRVQpOworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1Q
X0RQX0ZPUkNFX1NDUkFNQkxFUl9SRVNFVCwgMSk7CisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5R
TVBfRFBfVFJBTlNNSVRURVJfRU5BQkxFLCAwKTsKKwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFN
UF9EUF9JTlRfRFMsIDB4ZmZmZmZmZmYpOworCisJcmV0ID0genlucW1wX2RwX3BoeV9pbml0KGRw
KTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5R
TVBfRFBfVFJBTlNNSVRURVJfRU5BQkxFLCAxKTsKKworCS8qCisJICogTm93IHRoYXQgdGhlIGhh
cmR3YXJlIGlzIGluaXRpYWxpemVkIGFuZCB3b24ndCBnZW5lcmF0ZSBzcHVyaW91cworCSAqIGlu
dGVycnVwdHMsIHJlcXVlc3QgdGhlIElSUS4KKwkgKi8KKwlyZXQgPSBkZXZtX3JlcXVlc3RfdGhy
ZWFkZWRfaXJxKGRwLT5kZXYsIGRwLT5pcnEsIE5VTEwsCisJCQkJCXp5bnFtcF9kcF9pcnFfaGFu
ZGxlciwgSVJRRl9PTkVTSE9ULAorCQkJCQlkZXZfbmFtZShkcC0+ZGV2KSwgZHApOworCWlmIChy
ZXQgPCAwKQorCQlnb3RvIGVycm9yX3BoeTsKKworCWRwc3ViLT5kcCA9IGRwOworCisJZGV2X2Ri
ZyhkcC0+ZGV2LCAiWnlucU1QIERpc3BsYXlQb3J0IFR4IHByb2JlZCB3aXRoICV1IGxhbmVzXG4i
LAorCQlkcC0+bnVtX2xhbmVzKTsKKworCXJldHVybiAwOworCitlcnJvcl9waHk6CisJenlucW1w
X2RwX3BoeV9leGl0KGRwKTsKKwlyZXR1cm4gcmV0OworfQorCit2b2lkIHp5bnFtcF9kcF9yZW1v
dmUoc3RydWN0IHp5bnFtcF9kcHN1YiAqZHBzdWIpCit7CisJc3RydWN0IHp5bnFtcF9kcCAqZHAg
PSBkcHN1Yi0+ZHA7CisKKwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9UUkFOU01JVFRF
Ul9FTkFCTEUsIDApOworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX0lOVF9EUywgMHhm
ZmZmZmZmZik7CisKKwl6eW5xbXBfZHBfcGh5X2V4aXQoZHApOworCWRwc3ViLT5kcCA9IE5VTEw7
Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZHAuaCBiL2RyaXZl
cnMvZ3B1L2RybS94bG54L3p5bnFtcF9kcC5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAw
MDAwMDAwMDAwMC4uNWU3NThkMmI3NmIwCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL3hsbngvenlucW1wX2RwLmgKQEAgLTAsMCArMSwyOSBAQAorLyogU1BEWC1MaWNlbnNlLUlk
ZW50aWZpZXI6IEdQTC0yLjAgKi8KKy8qCisgKiBaeW5xTVAgRGlzcGxheVBvcnQgRHJpdmVyCisg
KgorICogQ29weXJpZ2h0IChDKSAyMDE3IC0gMjAxOSBYaWxpbngsIEluYy4KKyAqCisgKiBBdXRo
b3JzOgorICogLSBIeXVuIFdvbyBLd29uIDxoeXVuLmt3b25AeGlsaW54LmNvbT4KKyAqIC0gTGF1
cmVudCBQaW5jaGFydCA8bGF1cmVudC5waW5jaGFydEBpZGVhc29uYm9hcmQuY29tPgorICovCisK
KyNpZm5kZWYgX1pZTlFNUF9EUF9IXworI2RlZmluZSBfWllOUU1QX0RQX0hfCisKK3N0cnVjdCBk
cm1fZGV2aWNlOworc3RydWN0IHBsYXRmb3JtX2RldmljZTsKK3N0cnVjdCB6eW5xbXBfZHA7Citz
dHJ1Y3QgenlucW1wX2Rwc3ViOworCit2b2lkIHp5bnFtcF9kcF9lbmFibGVfdmJsYW5rKHN0cnVj
dCB6eW5xbXBfZHAgKmRwKTsKK3ZvaWQgenlucW1wX2RwX2Rpc2FibGVfdmJsYW5rKHN0cnVjdCB6
eW5xbXBfZHAgKmRwKTsKKworaW50IHp5bnFtcF9kcF9pbml0KHN0cnVjdCB6eW5xbXBfZHBzdWIg
KmRwc3ViLCBzdHJ1Y3QgZHJtX2RldmljZSAqZHJtKTsKK3ZvaWQgenlucW1wX2RwX2NsZWFudXAo
c3RydWN0IHp5bnFtcF9kcHN1YiAqZHBzdWIpOworCitpbnQgenlucW1wX2RwX3Byb2JlKHN0cnVj
dCB6eW5xbXBfZHBzdWIgKmRwc3ViLCBzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KTsKK3Zv
aWQgenlucW1wX2RwX3JlbW92ZShzdHJ1Y3QgenlucW1wX2Rwc3ViICpkcHN1Yik7CisKKyNlbmRp
ZiAvKiBfWllOUU1QX0RQX0hfICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0veGxueC96
eW5xbXBfZHBzdWIuYyBiL2RyaXZlcnMvZ3B1L2RybS94bG54L3p5bnFtcF9kcHN1Yi5jCm5ldyBm
aWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uNmMwN2M4YTBjMWY4Ci0tLSAvZGV2
L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rwc3ViLmMKQEAgLTAsMCAr
MSwzMzEgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisvKgorICogWnlu
cU1QIERpc3BsYXlQb3J0IFN1YnN5c3RlbSBEcml2ZXIKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIw
MTcgLSAyMDE5IFhpbGlueCwgSW5jLgorICoKKyAqIEF1dGhvcnM6CisgKiAtIEh5dW4gV29vIEt3
b24gPGh5dW4ua3dvbkB4aWxpbnguY29tPgorICogLSBMYXVyZW50IFBpbmNoYXJ0IDxsYXVyZW50
LnBpbmNoYXJ0QGlkZWFzb25ib2FyZC5jb20+CisgKi8KKworI2luY2x1ZGUgPGxpbnV4L2Nsay5o
PgorI2luY2x1ZGUgPGxpbnV4L2RtYS1tYXBwaW5nLmg+CisjaW5jbHVkZSA8bGludXgvbW9kdWxl
Lmg+CisjaW5jbHVkZSA8bGludXgvb2ZfcmVzZXJ2ZWRfbWVtLmg+CisjaW5jbHVkZSA8bGludXgv
cGxhdGZvcm1fZGV2aWNlLmg+CisjaW5jbHVkZSA8bGludXgvcG1fcnVudGltZS5oPgorCisjaW5j
bHVkZSA8ZHJtL2RybV9hdG9taWNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9kZXZpY2Uu
aD4KKyNpbmNsdWRlIDxkcm0vZHJtX2Rydi5oPgorI2luY2x1ZGUgPGRybS9kcm1fZmJfaGVscGVy
Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV9mb3VyY2MuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2dlbV9j
bWFfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9nZW1fZnJhbWVidWZmZXJfaGVscGVyLmg+
CisjaW5jbHVkZSA8ZHJtL2RybV9tb2RlX2NvbmZpZy5oPgorI2luY2x1ZGUgPGRybS9kcm1fcHJv
YmVfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV92YmxhbmsuaD4KKworI2luY2x1ZGUgInp5
bnFtcF9kaXNwLmgiCisjaW5jbHVkZSAienlucW1wX2RwLmgiCisjaW5jbHVkZSAienlucW1wX2Rw
c3ViLmgiCisKKy8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisgKiBEdW1iIEJ1ZmZlciAmIEZyYW1l
YnVmZmVyIEFsbG9jYXRpb24KKyAqLworCitzdGF0aWMgaW50IHp5bnFtcF9kcHN1Yl9kdW1iX2Ny
ZWF0ZShzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdiwKKwkJCQkgICAgc3RydWN0IGRybV9kZXZp
Y2UgKmRybSwKKwkJCQkgICAgc3RydWN0IGRybV9tb2RlX2NyZWF0ZV9kdW1iICphcmdzKQorewor
CXN0cnVjdCB6eW5xbXBfZHBzdWIgKmRwc3ViID0gZHJtLT5kZXZfcHJpdmF0ZTsKKwl1bnNpZ25l
ZCBpbnQgcGl0Y2ggPSBESVZfUk9VTkRfVVAoYXJncy0+d2lkdGggKiBhcmdzLT5icHAsIDgpOwor
CisJLyogRW5mb3JjZSB0aGUgYWxpZ25tZW50IGNvbnN0cmFpbnRzIG9mIHRoZSBETUEgZW5naW5l
LiAqLworCWFyZ3MtPnBpdGNoID0gQUxJR04ocGl0Y2gsIGRwc3ViLT5hbGlnbik7CisKKwlyZXR1
cm4gZHJtX2dlbV9jbWFfZHVtYl9jcmVhdGVfaW50ZXJuYWwoZmlsZV9wcml2LCBkcm0sIGFyZ3Mp
OworfQorCitzdGF0aWMgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqCit6eW5xbXBfZHBzdWJfZmJf
Y3JlYXRlKHN0cnVjdCBkcm1fZGV2aWNlICpkcm0sIHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wcml2
LAorCQkgICAgICAgY29uc3Qgc3RydWN0IGRybV9tb2RlX2ZiX2NtZDIgKm1vZGVfY21kKQorewor
CXN0cnVjdCB6eW5xbXBfZHBzdWIgKmRwc3ViID0gZHJtLT5kZXZfcHJpdmF0ZTsKKwlzdHJ1Y3Qg
ZHJtX21vZGVfZmJfY21kMiBjbWQgPSAqbW9kZV9jbWQ7CisJdW5zaWduZWQgaW50IGk7CisKKwkv
KiBFbmZvcmNlIHRoZSBhbGlnbm1lbnQgY29uc3RyYWludHMgb2YgdGhlIERNQSBlbmdpbmUuICov
CisJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoY21kLnBpdGNoZXMpOyArK2kpCisJCWNtZC5w
aXRjaGVzW2ldID0gQUxJR04oY21kLnBpdGNoZXNbaV0sIGRwc3ViLT5hbGlnbik7CisKKwlyZXR1
cm4gZHJtX2dlbV9mYl9jcmVhdGUoZHJtLCBmaWxlX3ByaXYsICZjbWQpOworfQorCitzdGF0aWMg
Y29uc3Qgc3RydWN0IGRybV9tb2RlX2NvbmZpZ19mdW5jcyB6eW5xbXBfZHBzdWJfbW9kZV9jb25m
aWdfZnVuY3MgPSB7CisJLmZiX2NyZWF0ZQkJPSB6eW5xbXBfZHBzdWJfZmJfY3JlYXRlLAorCS5h
dG9taWNfY2hlY2sJCT0gZHJtX2F0b21pY19oZWxwZXJfY2hlY2ssCisJLmF0b21pY19jb21taXQJ
CT0gZHJtX2F0b21pY19oZWxwZXJfY29tbWl0LAorfTsKKworLyogLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0KKyAqIERSTS9LTVMgRHJpdmVyCisgKi8KKworREVGSU5FX0RSTV9HRU1fQ01BX0ZPUFMoenlu
cW1wX2Rwc3ViX2RybV9mb3BzKTsKKworc3RhdGljIHN0cnVjdCBkcm1fZHJpdmVyIHp5bnFtcF9k
cHN1Yl9kcm1fZHJpdmVyID0geworCS5kcml2ZXJfZmVhdHVyZXMJCT0gRFJJVkVSX01PREVTRVQg
fCBEUklWRVJfR0VNIHwKKwkJCQkJICBEUklWRVJfQVRPTUlDIHwgRFJJVkVSX1BSSU1FLAorCisJ
LnByaW1lX2hhbmRsZV90b19mZAkJPSBkcm1fZ2VtX3ByaW1lX2hhbmRsZV90b19mZCwKKwkucHJp
bWVfZmRfdG9faGFuZGxlCQk9IGRybV9nZW1fcHJpbWVfZmRfdG9faGFuZGxlLAorCS5nZW1fcHJp
bWVfZXhwb3J0CQk9IGRybV9nZW1fcHJpbWVfZXhwb3J0LAorCS5nZW1fcHJpbWVfaW1wb3J0CQk9
IGRybV9nZW1fcHJpbWVfaW1wb3J0LAorCS5nZW1fcHJpbWVfZ2V0X3NnX3RhYmxlCQk9IGRybV9n
ZW1fY21hX3ByaW1lX2dldF9zZ190YWJsZSwKKwkuZ2VtX3ByaW1lX2ltcG9ydF9zZ190YWJsZQk9
IGRybV9nZW1fY21hX3ByaW1lX2ltcG9ydF9zZ190YWJsZSwKKwkuZ2VtX3ByaW1lX3ZtYXAJCQk9
IGRybV9nZW1fY21hX3ByaW1lX3ZtYXAsCisJLmdlbV9wcmltZV92dW5tYXAJCT0gZHJtX2dlbV9j
bWFfcHJpbWVfdnVubWFwLAorCS5nZW1fcHJpbWVfbW1hcAkJCT0gZHJtX2dlbV9jbWFfcHJpbWVf
bW1hcCwKKwkuZ2VtX2ZyZWVfb2JqZWN0X3VubG9ja2VkCT0gZHJtX2dlbV9jbWFfZnJlZV9vYmpl
Y3QsCisJLmdlbV92bV9vcHMJCQk9ICZkcm1fZ2VtX2NtYV92bV9vcHMsCisJLmR1bWJfY3JlYXRl
CQkJPSB6eW5xbXBfZHBzdWJfZHVtYl9jcmVhdGUsCisJLmR1bWJfZGVzdHJveQkJCT0gZHJtX2dl
bV9kdW1iX2Rlc3Ryb3ksCisKKwkuZm9wcwkJCQk9ICZ6eW5xbXBfZHBzdWJfZHJtX2ZvcHMsCisK
KwkubmFtZQkJCQk9ICJ6eW5xbXAtZHBzdWIiLAorCS5kZXNjCQkJCT0gIlhpbGlueCBEaXNwbGF5
UG9ydCBTdWJzeXN0ZW0gRHJpdmVyIiwKKwkuZGF0ZQkJCQk9ICIyMDEzMDUwOSIsCisJLm1ham9y
CQkJCT0gMSwKKwkubWlub3IJCQkJPSAwLAorfTsKKworc3RhdGljIHZvaWQgenlucW1wX2Rwc3Vi
X2RybV9jbGVhbnVwKHN0cnVjdCB6eW5xbXBfZHBzdWIgKmRwc3ViKQoreworCXN0cnVjdCBkcm1f
ZGV2aWNlICpkcm0gPSBkcHN1Yi0+ZHJtOworCisJZHJtX2Rldl91bnJlZ2lzdGVyKGRybSk7CisK
Kwl6eW5xbXBfZHBfY2xlYW51cChkcHN1Yik7CisKKwlkcm1fa21zX2hlbHBlcl9wb2xsX2Zpbmko
ZHJtKTsKKwlkcm1fbW9kZV9jb25maWdfY2xlYW51cChkcm0pOworCisJZHJtX2Rldl9wdXQoZHJt
KTsKK30KKworc3RhdGljIGludCB6eW5xbXBfZHBzdWJfZHJtX2luaXQoc3RydWN0IHp5bnFtcF9k
cHN1YiAqZHBzdWIpCit7CisJc3RydWN0IGRybV9kZXZpY2UgKmRybTsKKwlpbnQgcmV0OworCisJ
ZHJtID0gZHJtX2Rldl9hbGxvYygmenlucW1wX2Rwc3ViX2RybV9kcml2ZXIsIGRwc3ViLT5kZXYp
OworCWlmIChJU19FUlIoZHJtKSkKKwkJcmV0dXJuIFBUUl9FUlIoZHJtKTsKKworCWRwc3ViLT5k
cm0gPSBkcm07CisJZHJtLT5kZXZfcHJpdmF0ZSA9IGRwc3ViOworCisJLyogSW5pdGlhbGl6ZSBt
b2RlIGNvbmZpZywgdmJsYW5rIGFuZCB0aGUgS01TIHBvbGwgaGVscGVyLiAqLworCWRybV9tb2Rl
X2NvbmZpZ19pbml0KGRybSk7CisKKwlkcm0tPm1vZGVfY29uZmlnLmZ1bmNzID0gJnp5bnFtcF9k
cHN1Yl9tb2RlX2NvbmZpZ19mdW5jczsKKwlkcm0tPm1vZGVfY29uZmlnLm1pbl93aWR0aCA9IDA7
CisJZHJtLT5tb2RlX2NvbmZpZy5taW5faGVpZ2h0ID0gMDsKKwlkcm0tPm1vZGVfY29uZmlnLm1h
eF93aWR0aCA9IFpZTlFNUF9ESVNQX01BWF9XSURUSDsKKwlkcm0tPm1vZGVfY29uZmlnLm1heF9o
ZWlnaHQgPSBaWU5RTVBfRElTUF9NQVhfSEVJR0hUOworCisJcmV0ID0gZHJtX3ZibGFua19pbml0
KGRybSwgMSk7CisJaWYgKHJldCkKKwkJZ290byBlcnJfbW9kZV9jb25maWdfY2xlYW51cDsKKwor
CWRybS0+aXJxX2VuYWJsZWQgPSAxOworCisJZHJtX2ttc19oZWxwZXJfcG9sbF9pbml0KGRybSk7
CisKKwkvKgorCSAqIEluaXRpYWxpemUgdGhlIERJU1AgYW5kIERQIGNvbXBvbmVudHMuIFRoaXMg
d2lsbCBjcmVhdGVzIHBsYW5lcywKKwkgKiBDUlRDLCBlbmNvZGVyIGFuZCBjb25uZWN0b3IuIFRo
ZSBESVNQIHNob3VsZCBiZSBpbml0aWFsaXplZCBmaXJzdCBhcworCSAqIHRoZSBEUCBlbmNvZGVy
IG5lZWRzIHRoZSBDUlRDLgorCSAqLworCXJldCA9IHp5bnFtcF9kaXNwX2luaXQoZHBzdWIsIGRy
bSk7CisJaWYgKHJldCkKKwkJZ290byBlcnJfcG9sbF9maW5pOworCisJcmV0ID0genlucW1wX2Rw
X2luaXQoZHBzdWIsIGRybSk7CisJaWYgKHJldCkKKwkJZ290byBlcnJfcG9sbF9maW5pOworCisJ
ZG1hX3NldF9tYXNrKGRwc3ViLT5kZXYsIERNQV9CSVRfTUFTSyhaWU5RTVBfRElTUF9NQVhfRE1B
X0JJVCkpOworCisJLyogUmVzZXQgYWxsIGNvbXBvbmVudHMgYW5kIHJlZ2lzdGVyIHRoZSBEUk0g
ZGV2aWNlLiAqLworCWRybV9tb2RlX2NvbmZpZ19yZXNldChkcm0pOworCisJcmV0ID0gZHJtX2Rl
dl9yZWdpc3Rlcihkcm0sIDApOworCWlmIChyZXQgPCAwKQorCQlnb3RvIGVycl9kcF9jbGVhbnVw
OworCisJLyoKKwkgKiBJbml0aWFsaXplIGZiZGV2IGdlbmVyaWMgZW11bGF0aW9uLiBGYWlsdXJl
cyBhcmUgbm90IGZhdGFsIGFzIHRoZQorCSAqIERSTS9LTVMgZGV2aWNlIGlzIHN0aWxsIHVzYWJs
ZSB3aXRob3V0IGVtdWxhdGlvbiBzdXBwb3J0LgorCSAqLworCXJldCA9IGRybV9mYmRldl9nZW5l
cmljX3NldHVwKGRybSwgMjQpOworCWlmIChyZXQgPCAwKQorCQlkZXZfZXJyKGRwc3ViLT5kZXYs
ICJGYWlsZWQgdG8gaW5pdGlhbGl6ZSBmYmRldiBlbXVsYXRpb25cbiIpOworCisJcmV0dXJuIDA7
CisKK2Vycl9kcF9jbGVhbnVwOgorCXp5bnFtcF9kcF9jbGVhbnVwKGRwc3ViKTsKK2Vycl9wb2xs
X2Zpbmk6CisJZHJtX2ttc19oZWxwZXJfcG9sbF9maW5pKGRybSk7CitlcnJfbW9kZV9jb25maWdf
Y2xlYW51cDoKKwlkcm1fbW9kZV9jb25maWdfY2xlYW51cChkcm0pOworCWRybV9kZXZfcHV0KGRy
bSk7CisJcmV0dXJuIHJldDsKK30KKworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqIFBvd2Vy
IE1hbmFnZW1lbnQKKyAqLworCitzdGF0aWMgaW50IF9fbWF5YmVfdW51c2VkIHp5bnFtcF9kcHN1
Yl9zdXNwZW5kKHN0cnVjdCBkZXZpY2UgKmRldikKK3sKKwlzdHJ1Y3QgenlucW1wX2Rwc3ViICpk
cHN1YiA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOworCisJcmV0dXJuIGRybV9tb2RlX2NvbmZpZ19o
ZWxwZXJfc3VzcGVuZChkcHN1Yi0+ZHJtKTsKK30KKworc3RhdGljIGludCBfX21heWJlX3VudXNl
ZCB6eW5xbXBfZHBzdWJfcmVzdW1lKHN0cnVjdCBkZXZpY2UgKmRldikKK3sKKwlzdHJ1Y3Qgenlu
cW1wX2Rwc3ViICpkcHN1YiA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOworCisJcmV0dXJuIGRybV9t
b2RlX2NvbmZpZ19oZWxwZXJfcmVzdW1lKGRwc3ViLT5kcm0pOworfQorCitzdGF0aWMgY29uc3Qg
c3RydWN0IGRldl9wbV9vcHMgenlucW1wX2Rwc3ViX3BtX29wcyA9IHsKKwlTRVRfU1lTVEVNX1NM
RUVQX1BNX09QUyh6eW5xbXBfZHBzdWJfc3VzcGVuZCwgenlucW1wX2Rwc3ViX3Jlc3VtZSkKK307
CisKKy8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisgKiBQcm9iZSAmIFJlbW92ZQorICovCisKK3N0
YXRpYyBpbnQgenlucW1wX2Rwc3ViX2luaXRfY2xvY2tzKHN0cnVjdCB6eW5xbXBfZHBzdWIgKmRw
c3ViKQoreworCWludCByZXQ7CisKKwlkcHN1Yi0+YXBiX2NsayA9IGRldm1fY2xrX2dldChkcHN1
Yi0+ZGV2LCAiZHBfYXBiX2NsayIpOworCWlmIChJU19FUlIoZHBzdWItPmFwYl9jbGspKQorCQly
ZXR1cm4gUFRSX0VSUihkcHN1Yi0+YXBiX2Nsayk7CisKKwlyZXQgPSBjbGtfcHJlcGFyZV9lbmFi
bGUoZHBzdWItPmFwYl9jbGspOworCWlmIChyZXQpIHsKKwkJZGV2X2VycihkcHN1Yi0+ZGV2LCAi
ZmFpbGVkIHRvIGVuYWJsZSB0aGUgQVBCIGNsb2NrXG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCB6eW5xbXBfZHBzdWJfcHJvYmUoc3RydWN0IHBs
YXRmb3JtX2RldmljZSAqcGRldikKK3sKKwlzdHJ1Y3QgenlucW1wX2Rwc3ViICpkcHN1YjsKKwlp
bnQgcmV0OworCisJZHBzdWIgPSBkZXZtX2t6YWxsb2MoJnBkZXYtPmRldiwgc2l6ZW9mKCpkcHN1
YiksIEdGUF9LRVJORUwpOworCWlmICghZHBzdWIpCisJCXJldHVybiAtRU5PTUVNOworCisJZHBz
dWItPmRldiA9ICZwZGV2LT5kZXY7CisJcGxhdGZvcm1fc2V0X2RydmRhdGEocGRldiwgZHBzdWIp
OworCisJLyogVHJ5IHRoZSByZXNlcnZlZCBtZW1vcnkuIFByb2NlZWQgaWYgdGhlcmUncyBub25l
LiAqLworCW9mX3Jlc2VydmVkX21lbV9kZXZpY2VfaW5pdCgmcGRldi0+ZGV2KTsKKworCXJldCA9
IHp5bnFtcF9kcHN1Yl9pbml0X2Nsb2NrcyhkcHN1Yik7CisJaWYgKHJldCA8IDApCisJCWdvdG8g
ZXJyX21lbTsKKworCXBtX3J1bnRpbWVfZW5hYmxlKCZwZGV2LT5kZXYpOworCisJLyoKKwkgKiBE
UCBzaG91bGQgYmUgcHJvYmVkIGZpcnN0IHNvIHRoYXQgdGhlIHp5bnFtcF9kaXNwIGNhbiBzZXQg
dGhlIG91dHB1dAorCSAqIGZvcm1hdCBhY2NvcmRpbmdseS4KKwkgKi8KKwlyZXQgPSB6eW5xbXBf
ZHBfcHJvYmUoZHBzdWIsIHBkZXYpOworCWlmIChyZXQpCisJCWdvdG8gZXJyX3BtOworCisJcmV0
ID0genlucW1wX2Rpc3BfcHJvYmUoZHBzdWIsIHBkZXYpOworCWlmIChyZXQpCisJCWdvdG8gZXJy
X2RwOworCisJcmV0ID0genlucW1wX2Rwc3ViX2RybV9pbml0KGRwc3ViKTsKKwlpZiAocmV0KQor
CQlnb3RvIGVycl9kaXNwOworCisJZGV2X2luZm8oJnBkZXYtPmRldiwgIlp5bnFNUCBEaXNwbGF5
UG9ydCBTdWJzeXN0ZW0gZHJpdmVyIHByb2JlZCIpOworCisJcmV0dXJuIDA7CisKK2Vycl9kaXNw
OgorCXp5bnFtcF9kaXNwX3JlbW92ZShkcHN1Yik7CitlcnJfZHA6CisJenlucW1wX2RwX3JlbW92
ZShkcHN1Yik7CitlcnJfcG06CisJcG1fcnVudGltZV9kaXNhYmxlKCZwZGV2LT5kZXYpOworCWNs
a19kaXNhYmxlX3VucHJlcGFyZShkcHN1Yi0+YXBiX2Nsayk7CitlcnJfbWVtOgorCW9mX3Jlc2Vy
dmVkX21lbV9kZXZpY2VfcmVsZWFzZSgmcGRldi0+ZGV2KTsKKwlyZXR1cm4gcmV0OworfQorCitz
dGF0aWMgaW50IHp5bnFtcF9kcHN1Yl9yZW1vdmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRl
dikKK3sKKwlzdHJ1Y3QgenlucW1wX2Rwc3ViICpkcHN1YiA9IHBsYXRmb3JtX2dldF9kcnZkYXRh
KHBkZXYpOworCisJenlucW1wX2Rwc3ViX2RybV9jbGVhbnVwKGRwc3ViKTsKKworCXp5bnFtcF9k
aXNwX3JlbW92ZShkcHN1Yik7CisJenlucW1wX2RwX3JlbW92ZShkcHN1Yik7CisKKwlwbV9ydW50
aW1lX2Rpc2FibGUoJnBkZXYtPmRldik7CisJY2xrX2Rpc2FibGVfdW5wcmVwYXJlKGRwc3ViLT5h
cGJfY2xrKTsKKwlvZl9yZXNlcnZlZF9tZW1fZGV2aWNlX3JlbGVhc2UoJnBkZXYtPmRldik7CisK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgenlucW1wX2Rwc3ViX3NodXRkb3duKHN0cnVj
dCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpCit7CisJc3RydWN0IHp5bnFtcF9kcHN1YiAqZHBzdWIg
PSBwbGF0Zm9ybV9nZXRfZHJ2ZGF0YShwZGV2KTsKKworCWRybV9hdG9taWNfaGVscGVyX3NodXRk
b3duKGRwc3ViLT5kcm0pOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IG9mX2RldmljZV9pZCB6
eW5xbXBfZHBzdWJfb2ZfbWF0Y2hbXSA9IHsKKwl7IC5jb21wYXRpYmxlID0gInhsbngsenlucW1w
LWRwc3ViLTEuNyIsIH0sCisJeyAvKiBlbmQgb2YgdGFibGUgKi8gfSwKK307CitNT0RVTEVfREVW
SUNFX1RBQkxFKG9mLCB6eW5xbXBfZHBzdWJfb2ZfbWF0Y2gpOworCitzdGF0aWMgc3RydWN0IHBs
YXRmb3JtX2RyaXZlciB6eW5xbXBfZHBzdWJfZHJpdmVyID0geworCS5wcm9iZQkJCT0genlucW1w
X2Rwc3ViX3Byb2JlLAorCS5yZW1vdmUJCQk9IHp5bnFtcF9kcHN1Yl9yZW1vdmUsCisJLnNodXRk
b3duCQk9IHp5bnFtcF9kcHN1Yl9zaHV0ZG93biwKKwkuZHJpdmVyCQkJPSB7CisJCS5vd25lcgkJ
PSBUSElTX01PRFVMRSwKKwkJLm5hbWUJCT0gInp5bnFtcC1kaXNwbGF5IiwKKwkJLnBtCQk9ICZ6
eW5xbXBfZHBzdWJfcG1fb3BzLAorCQkub2ZfbWF0Y2hfdGFibGUJPSB6eW5xbXBfZHBzdWJfb2Zf
bWF0Y2gsCisJfSwKK307CisKK21vZHVsZV9wbGF0Zm9ybV9kcml2ZXIoenlucW1wX2Rwc3ViX2Ry
aXZlcik7CisKK01PRFVMRV9BVVRIT1IoIlhpbGlueCwgSW5jLiIpOworTU9EVUxFX0RFU0NSSVBU
SU9OKCJaeW5xTVAgRFAgU3Vic3lzdGVtIERyaXZlciIpOworTU9EVUxFX0xJQ0VOU0UoIkdQTCB2
MiIpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rwc3ViLmggYi9k
cml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZHBzdWIuaApuZXcgZmlsZSBtb2RlIDEwMDY0NApp
bmRleCAwMDAwMDAwMDAwMDAuLmQ0ZTA2MTNkMmY4MgotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS94bG54L3p5bnFtcF9kcHN1Yi5oCkBAIC0wLDAgKzEsNDggQEAKKy8qIFNQRFgt
TGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovCisvKgorICogWnlucU1QIERQU1VCIFN1YnN5
c3RlbSBEcml2ZXIKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMTcgLSAyMDE5IFhpbGlueCwgSW5j
LgorICoKKyAqIEF1dGhvcnM6CisgKiAtIEh5dW4gV29vIEt3b24gPGh5dW4ua3dvbkB4aWxpbngu
Y29tPgorICogLSBMYXVyZW50IFBpbmNoYXJ0IDxsYXVyZW50LnBpbmNoYXJ0QGlkZWFzb25ib2Fy
ZC5jb20+CisgKi8KKworI2lmbmRlZiBfWllOUU1QX0RQU1VCX0hfCisjZGVmaW5lIF9aWU5RTVBf
RFBTVUJfSF8KKworc3RydWN0IGNsazsKK3N0cnVjdCBkZXZpY2U7CitzdHJ1Y3QgZHJtX2Rldmlj
ZTsKK3N0cnVjdCB6eW5xbXBfZGlzcDsKK3N0cnVjdCB6eW5xbXBfZHA7CisKK2VudW0genlucW1w
X2Rwc3ViX2Zvcm1hdCB7CisJWllOUU1QX0RQU1VCX0ZPUk1BVF9SR0IsCisJWllOUU1QX0RQU1VC
X0ZPUk1BVF9ZQ1JDQjQ0NCwKKwlaWU5RTVBfRFBTVUJfRk9STUFUX1lDUkNCNDIyLAorCVpZTlFN
UF9EUFNVQl9GT1JNQVRfWU9OTFksCit9OworCisvKioKKyAqIHN0cnVjdCB6eW5xbXBfZHBzdWIg
LSBaeW5xTVAgRGlzcGxheVBvcnQgU3Vic3lzdGVtCisgKiBAZHJtOiBUaGUgRFJNL0tNUyBkZXZp
Y2UKKyAqIEBkZXY6IFRoZSBwaHlzaWNhbCBkZXZpY2UKKyAqIEBkaXNwOiBUaGUgZGlzcGxheSBj
b250cm9sbGVyCisgKiBAZHA6IFRoZSBEaXNwbGF5UG9ydCBjb250cm9sbGVyCisgKiBAYWxpZ246
IEJ1ZmZlciBwaXRjaCBhbGlnbm1lbnQgY29uc3RyYWludCAobXVzdCBiZSBhIHBvd2VyIG9mIDIp
CisgKi8KK3N0cnVjdCB6eW5xbXBfZHBzdWIgeworCXN0cnVjdCBkcm1fZGV2aWNlICpkcm07CisJ
c3RydWN0IGRldmljZSAqZGV2OworCisJc3RydWN0IGNsayAqYXBiX2NsazsKKworCXN0cnVjdCB6
eW5xbXBfZGlzcCAqZGlzcDsKKwlzdHJ1Y3QgenlucW1wX2RwICpkcDsKKworCXVuc2lnbmVkIGlu
dCBhbGlnbjsKK307CisKKyNlbmRpZiAvKiBfWllOUU1QX0RQU1VCX0hfICovCi0tIApSZWdhcmRz
LAoKTGF1cmVudCBQaW5jaGFydAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRl
c2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8v
ZHJpLWRldmVs
