Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 09A83EAC2F
	for <lists+dri-devel@lfdr.de>; Thu, 31 Oct 2019 10:05:11 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E2F366EDD7;
	Thu, 31 Oct 2019 09:04:23 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from relmlie6.idc.renesas.com (relmlor2.renesas.com
 [210.160.252.172])
 by gabe.freedesktop.org (Postfix) with ESMTP id B15936E9FA
 for <dri-devel@lists.freedesktop.org>; Wed, 30 Oct 2019 13:48:48 +0000 (UTC)
X-IronPort-AV: E=Sophos;i="5.68,247,1569250800"; d="scan'208";a="30206758"
Received: from unknown (HELO relmlir5.idc.renesas.com) ([10.200.68.151])
 by relmlie6.idc.renesas.com with ESMTP; 30 Oct 2019 22:43:45 +0900
Received: from fabrizio-dev.ree.adwin.renesas.com (unknown [10.226.36.196])
 by relmlir5.idc.renesas.com (Postfix) with ESMTP id 93974400CA10;
 Wed, 30 Oct 2019 22:43:41 +0900 (JST)
From: Fabrizio Castro <fabrizio.castro@bp.renesas.com>
To: David Airlie <airlied@linux.ie>, Daniel Vetter <daniel@ffwll.ch>,
 Rob Herring <robh+dt@kernel.org>, Mark Rutland <mark.rutland@arm.com>,
 Andrzej Hajda <a.hajda@samsung.com>
Subject: [PATCH 1/4] drm/bridge: Repurpose lvds-encoder.c
Date: Wed, 30 Oct 2019 13:43:31 +0000
Message-Id: <1572443014-17335-2-git-send-email-fabrizio.castro@bp.renesas.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1572443014-17335-1-git-send-email-fabrizio.castro@bp.renesas.com>
References: <1572443014-17335-1-git-send-email-fabrizio.castro@bp.renesas.com>
X-Mailman-Approved-At: Thu, 31 Oct 2019 09:04:21 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Fabrizio Castro <fabrizio.castro@bp.renesas.com>,
 devicetree@vger.kernel.org, Chris Paterson <Chris.Paterson2@renesas.com>,
 Geert Uytterhoeven <geert+renesas@glider.be>,
 Kieran Bingham <kieran.bingham+renesas@ideasonboard.com>,
 Magnus Damm <magnus.damm@gmail.com>, dri-devel@lists.freedesktop.org,
 Biju Das <biju.das@bp.renesas.com>, linux-renesas-soc@vger.kernel.org,
 Simon Horman <horms@verge.net.au>, Jacopo Mondi <jacopo+renesas@jmondi.org>,
 Laurent Pinchart <laurent.pinchart@ideasonboard.com>,
 Peter Rosin <peda@axentia.se>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

bHZkcy1lbmNvZGVyLmMgaW1wbGVtZW50YXRpb24gaXMgYWxzbyBzdWl0YWJsZSBmb3IgTFZEUyBk
ZWNvZGVycywKbm90IGp1c3QgTFZEUyBlbmNvZGVycy4KSW5zdGVhZCBvZiBjcmVhdGluZyBhIG5l
dyBkcml2ZXIgZm9yIGFkZHJlc3Npbmcgc3VwcG9ydCBmb3IKdHJhbnNwYXJlbnQgTFZEUyBkZWNv
ZGVycywgcmVwdXJwb3NlIGx2ZHMtZW5jb2Rlci5jIGZvciB0aGUgZ3JlYXRlcgpnb29kLgoKU2ln
bmVkLW9mZi1ieTogRmFicml6aW8gQ2FzdHJvIDxmYWJyaXppby5jYXN0cm9AYnAucmVuZXNhcy5j
b20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9LY29uZmlnICAgICAgICB8ICAgOCArLQog
ZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9NYWtlZmlsZSAgICAgICB8ICAgMiArLQogZHJpdmVycy9n
cHUvZHJtL2JyaWRnZS9sdmRzLWNvZGVjLmMgICB8IDE2OSArKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2x2ZHMtZW5jb2Rlci5jIHwgMTU1
IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIDQgZmlsZXMgY2hhbmdlZCwgMTc0IGlu
c2VydGlvbnMoKyksIDE2MCBkZWxldGlvbnMoLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJz
L2dwdS9kcm0vYnJpZGdlL2x2ZHMtY29kZWMuYwogZGVsZXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMv
Z3B1L2RybS9icmlkZ2UvbHZkcy1lbmNvZGVyLmMKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vYnJpZGdlL0tjb25maWcgYi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL0tjb25maWcKaW5kZXgg
MzQzNjI5Ny4uOWU3NWNhNGUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvS2Nv
bmZpZworKysgYi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL0tjb25maWcKQEAgLTQ1LDE0ICs0NSwx
NCBAQCBjb25maWcgRFJNX0RVTUJfVkdBX0RBQwogCSAgU3VwcG9ydCBmb3Igbm9uLXByb2dyYW1t
YWJsZSBSR0IgdG8gVkdBIERBQyBicmlkZ2VzLCBzdWNoIGFzIEFESQogCSAgQURWNzEyMywgVEkg
VEhTODEzNCBhbmQgVEhTODEzNSBvciBwYXNzaXZlIHJlc2lzdG9yIGxhZGRlciBEQUNzLgogCi1j
b25maWcgRFJNX0xWRFNfRU5DT0RFUgotCXRyaXN0YXRlICJUcmFuc3BhcmVudCBwYXJhbGxlbCB0
byBMVkRTIGVuY29kZXIgc3VwcG9ydCIKK2NvbmZpZyBEUk1fTFZEU19DT0RFQworCXRyaXN0YXRl
ICJUcmFuc3BhcmVudCBMVkRTIGVuY29kZXJzIGFuZCBkZWNvZGVycyBzdXBwb3J0IgogCWRlcGVu
ZHMgb24gT0YKIAlzZWxlY3QgRFJNX0tNU19IRUxQRVIKIAlzZWxlY3QgRFJNX1BBTkVMX0JSSURH
RQogCWhlbHAKLQkgIFN1cHBvcnQgZm9yIHRyYW5zcGFyZW50IHBhcmFsbGVsIHRvIExWRFMgZW5j
b2RlcnMgdGhhdCBkb24ndCByZXF1aXJlCi0JICBhbnkgY29uZmlndXJhdGlvbi4KKwkgIFN1cHBv
cnQgZm9yIHRyYW5zcGFyZW50IExWRFMgZW5jb2RlcnMgYW5kIExWRFMgZGVjb2RlcnMgdGhhdCBk
b24ndAorCSAgcmVxdWlyZSBhbnkgY29uZmlndXJhdGlvbi4KIAogY29uZmlnIERSTV9NRUdBQ0hJ
UFNfU1REUFhYWFhfR0VfQjg1MFYzX0ZXCiAJdHJpc3RhdGUgIk1lZ2FDaGlwcyBzdGRwNDAyOC1n
ZS1iODUwdjMtZncgYW5kIHN0ZHAyNjkwLWdlLWI4NTB2My1mdyIKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9icmlkZ2UvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL01ha2Vm
aWxlCmluZGV4IDQ5MzRmY2YuLjhhOTE3OGEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9i
cmlkZ2UvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9NYWtlZmlsZQpAQCAt
Miw3ICsyLDcgQEAKIG9iai0kKENPTkZJR19EUk1fQU5BTE9HSVhfQU5YNzhYWCkgKz0gYW5hbG9n
aXgtYW54Nzh4eC5vCiBvYmotJChDT05GSUdfRFJNX0NETlNfRFNJKSArPSBjZG5zLWRzaS5vCiBv
YmotJChDT05GSUdfRFJNX0RVTUJfVkdBX0RBQykgKz0gZHVtYi12Z2EtZGFjLm8KLW9iai0kKENP
TkZJR19EUk1fTFZEU19FTkNPREVSKSArPSBsdmRzLWVuY29kZXIubworb2JqLSQoQ09ORklHX0RS
TV9MVkRTX0NPREVDKSArPSBsdmRzLWNvZGVjLm8KIG9iai0kKENPTkZJR19EUk1fTUVHQUNISVBT
X1NURFBYWFhYX0dFX0I4NTBWM19GVykgKz0gbWVnYWNoaXBzLXN0ZHB4eHh4LWdlLWI4NTB2My1m
dy5vCiBvYmotJChDT05GSUdfRFJNX05YUF9QVE4zNDYwKSArPSBueHAtcHRuMzQ2MC5vCiBvYmot
JChDT05GSUdfRFJNX1BBUkFERV9QUzg2MjIpICs9IHBhcmFkZS1wczg2MjIubwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9sdmRzLWNvZGVjLmMgYi9kcml2ZXJzL2dwdS9kcm0v
YnJpZGdlL2x2ZHMtY29kZWMuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi44
YTE5NzljCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9sdmRzLWNv
ZGVjLmMKQEAgLTAsMCArMSwxNjkgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwt
Mi4wLW9yLWxhdGVyCisvKgorICogQ29weXJpZ2h0IChDKSAyMDE2IExhdXJlbnQgUGluY2hhcnQg
PGxhdXJlbnQucGluY2hhcnRAaWRlYXNvbmJvYXJkLmNvbT4KKyAqLworCisjaW5jbHVkZSA8bGlu
dXgvZ3Bpby9jb25zdW1lci5oPgorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgorI2luY2x1ZGUg
PGxpbnV4L29mLmg+CisjaW5jbHVkZSA8bGludXgvb2ZfZGV2aWNlLmg+CisjaW5jbHVkZSA8bGlu
dXgvb2ZfZ3JhcGguaD4KKyNpbmNsdWRlIDxsaW51eC9wbGF0Zm9ybV9kZXZpY2UuaD4KKworI2lu
Y2x1ZGUgPGRybS9kcm1fYnJpZGdlLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wYW5lbC5oPgorCitz
dHJ1Y3QgbHZkc19jb2RlYyB7CisJc3RydWN0IGRybV9icmlkZ2UgYnJpZGdlOworCXN0cnVjdCBk
cm1fYnJpZGdlICpwYW5lbF9icmlkZ2U7CisJc3RydWN0IGdwaW9fZGVzYyAqcG93ZXJkb3duX2dw
aW87CisJdTMyIGNvbm5lY3Rvcl90eXBlOworfTsKKworc3RhdGljIGludCBsdmRzX2NvZGVjX2F0
dGFjaChzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQoreworCXN0cnVjdCBsdmRzX2NvZGVjICps
dmRzX2NvZGVjID0gY29udGFpbmVyX29mKGJyaWRnZSwKKwkJCQkJCQkgc3RydWN0IGx2ZHNfY29k
ZWMsCisJCQkJCQkJIGJyaWRnZSk7CisKKwlyZXR1cm4gZHJtX2JyaWRnZV9hdHRhY2goYnJpZGdl
LT5lbmNvZGVyLCBsdmRzX2NvZGVjLT5wYW5lbF9icmlkZ2UsCisJCQkJIGJyaWRnZSk7Cit9CisK
K3N0YXRpYyB2b2lkIGx2ZHNfY29kZWNfZW5hYmxlKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2Up
Cit7CisJc3RydWN0IGx2ZHNfY29kZWMgKmx2ZHNfY29kZWMgPSBjb250YWluZXJfb2YoYnJpZGdl
LAorCQkJCQkJCSBzdHJ1Y3QgbHZkc19jb2RlYywKKwkJCQkJCQkgYnJpZGdlKTsKKworCWlmIChs
dmRzX2NvZGVjLT5wb3dlcmRvd25fZ3BpbykKKwkJZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKGx2
ZHNfY29kZWMtPnBvd2VyZG93bl9ncGlvLCAwKTsKK30KKworc3RhdGljIHZvaWQgbHZkc19jb2Rl
Y19kaXNhYmxlKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UpCit7CisJc3RydWN0IGx2ZHNfY29k
ZWMgKmx2ZHNfY29kZWMgPSBjb250YWluZXJfb2YoYnJpZGdlLAorCQkJCQkJCSBzdHJ1Y3QgbHZk
c19jb2RlYywKKwkJCQkJCQkgYnJpZGdlKTsKKworCWlmIChsdmRzX2NvZGVjLT5wb3dlcmRvd25f
Z3BpbykKKwkJZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKGx2ZHNfY29kZWMtPnBvd2VyZG93bl9n
cGlvLCAxKTsKK30KKworc3RhdGljIHN0cnVjdCBkcm1fYnJpZGdlX2Z1bmNzIGZ1bmNzID0gewor
CS5hdHRhY2ggPSBsdmRzX2NvZGVjX2F0dGFjaCwKKwkuZW5hYmxlID0gbHZkc19jb2RlY19lbmFi
bGUsCisJLmRpc2FibGUgPSBsdmRzX2NvZGVjX2Rpc2FibGUsCit9OworCitzdGF0aWMgaW50IGx2
ZHNfY29kZWNfcHJvYmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKK3sKKwlzdHJ1Y3Qg
ZGV2aWNlICpkZXYgPSAmcGRldi0+ZGV2OworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqcG9ydDsKKwlz
dHJ1Y3QgZGV2aWNlX25vZGUgKmVuZHBvaW50OworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqcGFuZWxf
bm9kZTsKKwlzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbDsKKwlzdHJ1Y3QgbHZkc19jb2RlYyAqbHZk
c19jb2RlYzsKKworCWx2ZHNfY29kZWMgPSBkZXZtX2t6YWxsb2MoZGV2LCBzaXplb2YoKmx2ZHNf
Y29kZWMpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWx2ZHNfY29kZWMpCisJCXJldHVybiAtRU5PTUVN
OworCisJbHZkc19jb2RlYy0+Y29ubmVjdG9yX3R5cGUgPSAodTMyKQorCQlvZl9kZXZpY2VfZ2V0
X21hdGNoX2RhdGEoJnBkZXYtPmRldik7CisJbHZkc19jb2RlYy0+cG93ZXJkb3duX2dwaW8gPSBk
ZXZtX2dwaW9kX2dldF9vcHRpb25hbChkZXYsICJwb3dlcmRvd24iLAorCQkJCQkJCSAgICAgICBH
UElPRF9PVVRfSElHSCk7CisJaWYgKElTX0VSUihsdmRzX2NvZGVjLT5wb3dlcmRvd25fZ3Bpbykp
IHsKKwkJaW50IGVyciA9IFBUUl9FUlIobHZkc19jb2RlYy0+cG93ZXJkb3duX2dwaW8pOworCisJ
CWlmIChlcnIgIT0gLUVQUk9CRV9ERUZFUikKKwkJCWRldl9lcnIoZGV2LCAicG93ZXJkb3duIEdQ
SU8gZmFpbHVyZTogJWRcbiIsIGVycik7CisJCXJldHVybiBlcnI7CisJfQorCisJLyogTG9jYXRl
IHRoZSBwYW5lbCBEVCBub2RlLiAqLworCXBvcnQgPSBvZl9ncmFwaF9nZXRfcG9ydF9ieV9pZChk
ZXYtPm9mX25vZGUsIDEpOworCWlmICghcG9ydCkgeworCQlkZXZfZGJnKGRldiwgInBvcnQgMSBu
b3QgZm91bmRcbiIpOworCQlyZXR1cm4gLUVOWElPOworCX0KKworCWVuZHBvaW50ID0gb2ZfZ2V0
X2NoaWxkX2J5X25hbWUocG9ydCwgImVuZHBvaW50Iik7CisJb2Zfbm9kZV9wdXQocG9ydCk7CisJ
aWYgKCFlbmRwb2ludCkgeworCQlkZXZfZGJnKGRldiwgIm5vIGVuZHBvaW50IGZvciBwb3J0IDFc
biIpOworCQlyZXR1cm4gLUVOWElPOworCX0KKworCXBhbmVsX25vZGUgPSBvZl9ncmFwaF9nZXRf
cmVtb3RlX3BvcnRfcGFyZW50KGVuZHBvaW50KTsKKwlvZl9ub2RlX3B1dChlbmRwb2ludCk7CisJ
aWYgKCFwYW5lbF9ub2RlKSB7CisJCWRldl9kYmcoZGV2LCAibm8gcmVtb3RlIGVuZHBvaW50IGZv
ciBwb3J0IDFcbiIpOworCQlyZXR1cm4gLUVOWElPOworCX0KKworCXBhbmVsID0gb2ZfZHJtX2Zp
bmRfcGFuZWwocGFuZWxfbm9kZSk7CisJb2Zfbm9kZV9wdXQocGFuZWxfbm9kZSk7CisJaWYgKElT
X0VSUihwYW5lbCkpIHsKKwkJZGV2X2RiZyhkZXYsICJwYW5lbCBub3QgZm91bmQsIGRlZmVycmlu
ZyBwcm9iZVxuIik7CisJCXJldHVybiBQVFJfRVJSKHBhbmVsKTsKKwl9CisKKwlsdmRzX2NvZGVj
LT5wYW5lbF9icmlkZ2UgPQorCQlkZXZtX2RybV9wYW5lbF9icmlkZ2VfYWRkX3R5cGVkKGRldiwg
cGFuZWwsCisJCQkJCQlsdmRzX2NvZGVjLT5jb25uZWN0b3JfdHlwZSk7CisJaWYgKElTX0VSUihs
dmRzX2NvZGVjLT5wYW5lbF9icmlkZ2UpKQorCQlyZXR1cm4gUFRSX0VSUihsdmRzX2NvZGVjLT5w
YW5lbF9icmlkZ2UpOworCisJLyogVGhlIHBhbmVsX2JyaWRnZSBicmlkZ2UgaXMgYXR0YWNoZWQg
dG8gdGhlIHBhbmVsJ3Mgb2Zfbm9kZSwKKwkgKiBidXQgd2UgbmVlZCBhIGJyaWRnZSBhdHRhY2hl
ZCB0byBvdXIgb2Zfbm9kZSBmb3Igb3VyIHVzZXIKKwkgKiB0byBsb29rIHVwLgorCSAqLworCWx2
ZHNfY29kZWMtPmJyaWRnZS5vZl9ub2RlID0gZGV2LT5vZl9ub2RlOworCWx2ZHNfY29kZWMtPmJy
aWRnZS5mdW5jcyA9ICZmdW5jczsKKwlkcm1fYnJpZGdlX2FkZCgmbHZkc19jb2RlYy0+YnJpZGdl
KTsKKworCXBsYXRmb3JtX3NldF9kcnZkYXRhKHBkZXYsIGx2ZHNfY29kZWMpOworCisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyBpbnQgbHZkc19jb2RlY19yZW1vdmUoc3RydWN0IHBsYXRmb3JtX2Rl
dmljZSAqcGRldikKK3sKKwlzdHJ1Y3QgbHZkc19jb2RlYyAqbHZkc19jb2RlYyA9IHBsYXRmb3Jt
X2dldF9kcnZkYXRhKHBkZXYpOworCisJZHJtX2JyaWRnZV9yZW1vdmUoJmx2ZHNfY29kZWMtPmJy
aWRnZSk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBvZl9kZXZpY2Vf
aWQgbHZkc19jb2RlY19tYXRjaFtdID0geworCXsKKwkJLmNvbXBhdGlibGUgPSAibHZkcy1lbmNv
ZGVyIiwKKwkJLmRhdGEgPSAodm9pZCAqKURSTV9NT0RFX0NPTk5FQ1RPUl9MVkRTCisJfSwKKwl7
CisJCS5jb21wYXRpYmxlID0gInRoaW5lLHRoYzYzbHZkbTgzZCIsCisJCS5kYXRhID0gKHZvaWQg
KilEUk1fTU9ERV9DT05ORUNUT1JfTFZEUywKKwl9LAorCXsKKwkJLmNvbXBhdGlibGUgPSAibHZk
cy1kZWNvZGVyIiwKKwkJLmRhdGEgPSAodm9pZCAqKURSTV9NT0RFX0NPTk5FQ1RPUl9Vbmtub3du
LAorCX0sCisJe30sCit9OworTU9EVUxFX0RFVklDRV9UQUJMRShvZiwgbHZkc19jb2RlY19tYXRj
aCk7CisKK3N0YXRpYyBzdHJ1Y3QgcGxhdGZvcm1fZHJpdmVyIGx2ZHNfY29kZWNfZHJpdmVyID0g
eworCS5wcm9iZQk9IGx2ZHNfY29kZWNfcHJvYmUsCisJLnJlbW92ZQk9IGx2ZHNfY29kZWNfcmVt
b3ZlLAorCS5kcml2ZXIJCT0geworCQkubmFtZQkJPSAibHZkcy1jb2RlYyIsCisJCS5vZl9tYXRj
aF90YWJsZQk9IGx2ZHNfY29kZWNfbWF0Y2gsCisJfSwKK307Cittb2R1bGVfcGxhdGZvcm1fZHJp
dmVyKGx2ZHNfY29kZWNfZHJpdmVyKTsKKworTU9EVUxFX0FVVEhPUigiTGF1cmVudCBQaW5jaGFy
dCA8bGF1cmVudC5waW5jaGFydEBpZGVhc29uYm9hcmQuY29tPiIpOworTU9EVUxFX0RFU0NSSVBU
SU9OKCJEcml2ZXIgZm9yIHRyYW5zcGFyZW50IExWRFMgZW5jb2RlcnMgYW5kIExWRFMgZGVjb2Rl
cnMiKTsKK01PRFVMRV9MSUNFTlNFKCJHUEwiKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9icmlkZ2UvbHZkcy1lbmNvZGVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2x2ZHMtZW5j
b2Rlci5jCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCBlMjEzMmE4Li4wMDAwMDAwCi0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvbHZkcy1lbmNvZGVyLmMKKysrIC9kZXYvbnVsbApA
QCAtMSwxNTUgKzAsMCBAQAotLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb3It
bGF0ZXIKLS8qCi0gKiBDb3B5cmlnaHQgKEMpIDIwMTYgTGF1cmVudCBQaW5jaGFydCA8bGF1cmVu
dC5waW5jaGFydEBpZGVhc29uYm9hcmQuY29tPgotICovCi0KLSNpbmNsdWRlIDxsaW51eC9ncGlv
L2NvbnN1bWVyLmg+Ci0jaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+Ci0jaW5jbHVkZSA8bGludXgv
b2YuaD4KLSNpbmNsdWRlIDxsaW51eC9vZl9ncmFwaC5oPgotI2luY2x1ZGUgPGxpbnV4L3BsYXRm
b3JtX2RldmljZS5oPgotCi0jaW5jbHVkZSA8ZHJtL2RybV9icmlkZ2UuaD4KLSNpbmNsdWRlIDxk
cm0vZHJtX3BhbmVsLmg+Ci0KLXN0cnVjdCBsdmRzX2VuY29kZXIgewotCXN0cnVjdCBkcm1fYnJp
ZGdlIGJyaWRnZTsKLQlzdHJ1Y3QgZHJtX2JyaWRnZSAqcGFuZWxfYnJpZGdlOwotCXN0cnVjdCBn
cGlvX2Rlc2MgKnBvd2VyZG93bl9ncGlvOwotfTsKLQotc3RhdGljIGludCBsdmRzX2VuY29kZXJf
YXR0YWNoKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UpCi17Ci0Jc3RydWN0IGx2ZHNfZW5jb2Rl
ciAqbHZkc19lbmNvZGVyID0gY29udGFpbmVyX29mKGJyaWRnZSwKLQkJCQkJCQkgc3RydWN0IGx2
ZHNfZW5jb2RlciwKLQkJCQkJCQkgYnJpZGdlKTsKLQotCXJldHVybiBkcm1fYnJpZGdlX2F0dGFj
aChicmlkZ2UtPmVuY29kZXIsIGx2ZHNfZW5jb2Rlci0+cGFuZWxfYnJpZGdlLAotCQkJCSBicmlk
Z2UpOwotfQotCi1zdGF0aWMgdm9pZCBsdmRzX2VuY29kZXJfZW5hYmxlKHN0cnVjdCBkcm1fYnJp
ZGdlICpicmlkZ2UpCi17Ci0Jc3RydWN0IGx2ZHNfZW5jb2RlciAqbHZkc19lbmNvZGVyID0gY29u
dGFpbmVyX29mKGJyaWRnZSwKLQkJCQkJCQkgc3RydWN0IGx2ZHNfZW5jb2RlciwKLQkJCQkJCQkg
YnJpZGdlKTsKLQotCWlmIChsdmRzX2VuY29kZXItPnBvd2VyZG93bl9ncGlvKQotCQlncGlvZF9z
ZXRfdmFsdWVfY2Fuc2xlZXAobHZkc19lbmNvZGVyLT5wb3dlcmRvd25fZ3BpbywgMCk7Ci19Ci0K
LXN0YXRpYyB2b2lkIGx2ZHNfZW5jb2Rlcl9kaXNhYmxlKHN0cnVjdCBkcm1fYnJpZGdlICpicmlk
Z2UpCi17Ci0Jc3RydWN0IGx2ZHNfZW5jb2RlciAqbHZkc19lbmNvZGVyID0gY29udGFpbmVyX29m
KGJyaWRnZSwKLQkJCQkJCQkgc3RydWN0IGx2ZHNfZW5jb2RlciwKLQkJCQkJCQkgYnJpZGdlKTsK
LQotCWlmIChsdmRzX2VuY29kZXItPnBvd2VyZG93bl9ncGlvKQotCQlncGlvZF9zZXRfdmFsdWVf
Y2Fuc2xlZXAobHZkc19lbmNvZGVyLT5wb3dlcmRvd25fZ3BpbywgMSk7Ci19Ci0KLXN0YXRpYyBz
dHJ1Y3QgZHJtX2JyaWRnZV9mdW5jcyBmdW5jcyA9IHsKLQkuYXR0YWNoID0gbHZkc19lbmNvZGVy
X2F0dGFjaCwKLQkuZW5hYmxlID0gbHZkc19lbmNvZGVyX2VuYWJsZSwKLQkuZGlzYWJsZSA9IGx2
ZHNfZW5jb2Rlcl9kaXNhYmxlLAotfTsKLQotc3RhdGljIGludCBsdmRzX2VuY29kZXJfcHJvYmUo
c3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKLXsKLQlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAm
cGRldi0+ZGV2OwotCXN0cnVjdCBkZXZpY2Vfbm9kZSAqcG9ydDsKLQlzdHJ1Y3QgZGV2aWNlX25v
ZGUgKmVuZHBvaW50OwotCXN0cnVjdCBkZXZpY2Vfbm9kZSAqcGFuZWxfbm9kZTsKLQlzdHJ1Y3Qg
ZHJtX3BhbmVsICpwYW5lbDsKLQlzdHJ1Y3QgbHZkc19lbmNvZGVyICpsdmRzX2VuY29kZXI7Ci0K
LQlsdmRzX2VuY29kZXIgPSBkZXZtX2t6YWxsb2MoZGV2LCBzaXplb2YoKmx2ZHNfZW5jb2Rlciks
IEdGUF9LRVJORUwpOwotCWlmICghbHZkc19lbmNvZGVyKQotCQlyZXR1cm4gLUVOT01FTTsKLQot
CWx2ZHNfZW5jb2Rlci0+cG93ZXJkb3duX2dwaW8gPSBkZXZtX2dwaW9kX2dldF9vcHRpb25hbChk
ZXYsICJwb3dlcmRvd24iLAotCQkJCQkJCSAgICAgICBHUElPRF9PVVRfSElHSCk7Ci0JaWYgKElT
X0VSUihsdmRzX2VuY29kZXItPnBvd2VyZG93bl9ncGlvKSkgewotCQlpbnQgZXJyID0gUFRSX0VS
UihsdmRzX2VuY29kZXItPnBvd2VyZG93bl9ncGlvKTsKLQotCQlpZiAoZXJyICE9IC1FUFJPQkVf
REVGRVIpCi0JCQlkZXZfZXJyKGRldiwgInBvd2VyZG93biBHUElPIGZhaWx1cmU6ICVkXG4iLCBl
cnIpOwotCQlyZXR1cm4gZXJyOwotCX0KLQotCS8qIExvY2F0ZSB0aGUgcGFuZWwgRFQgbm9kZS4g
Ki8KLQlwb3J0ID0gb2ZfZ3JhcGhfZ2V0X3BvcnRfYnlfaWQoZGV2LT5vZl9ub2RlLCAxKTsKLQlp
ZiAoIXBvcnQpIHsKLQkJZGV2X2RiZyhkZXYsICJwb3J0IDEgbm90IGZvdW5kXG4iKTsKLQkJcmV0
dXJuIC1FTlhJTzsKLQl9Ci0KLQllbmRwb2ludCA9IG9mX2dldF9jaGlsZF9ieV9uYW1lKHBvcnQs
ICJlbmRwb2ludCIpOwotCW9mX25vZGVfcHV0KHBvcnQpOwotCWlmICghZW5kcG9pbnQpIHsKLQkJ
ZGV2X2RiZyhkZXYsICJubyBlbmRwb2ludCBmb3IgcG9ydCAxXG4iKTsKLQkJcmV0dXJuIC1FTlhJ
TzsKLQl9Ci0KLQlwYW5lbF9ub2RlID0gb2ZfZ3JhcGhfZ2V0X3JlbW90ZV9wb3J0X3BhcmVudChl
bmRwb2ludCk7Ci0Jb2Zfbm9kZV9wdXQoZW5kcG9pbnQpOwotCWlmICghcGFuZWxfbm9kZSkgewot
CQlkZXZfZGJnKGRldiwgIm5vIHJlbW90ZSBlbmRwb2ludCBmb3IgcG9ydCAxXG4iKTsKLQkJcmV0
dXJuIC1FTlhJTzsKLQl9Ci0KLQlwYW5lbCA9IG9mX2RybV9maW5kX3BhbmVsKHBhbmVsX25vZGUp
OwotCW9mX25vZGVfcHV0KHBhbmVsX25vZGUpOwotCWlmIChJU19FUlIocGFuZWwpKSB7Ci0JCWRl
dl9kYmcoZGV2LCAicGFuZWwgbm90IGZvdW5kLCBkZWZlcnJpbmcgcHJvYmVcbiIpOwotCQlyZXR1
cm4gUFRSX0VSUihwYW5lbCk7Ci0JfQotCi0JbHZkc19lbmNvZGVyLT5wYW5lbF9icmlkZ2UgPQot
CQlkZXZtX2RybV9wYW5lbF9icmlkZ2VfYWRkX3R5cGVkKGRldiwgcGFuZWwsCi0JCQkJCQlEUk1f
TU9ERV9DT05ORUNUT1JfTFZEUyk7Ci0JaWYgKElTX0VSUihsdmRzX2VuY29kZXItPnBhbmVsX2Jy
aWRnZSkpCi0JCXJldHVybiBQVFJfRVJSKGx2ZHNfZW5jb2Rlci0+cGFuZWxfYnJpZGdlKTsKLQot
CS8qIFRoZSBwYW5lbF9icmlkZ2UgYnJpZGdlIGlzIGF0dGFjaGVkIHRvIHRoZSBwYW5lbCdzIG9m
X25vZGUsCi0JICogYnV0IHdlIG5lZWQgYSBicmlkZ2UgYXR0YWNoZWQgdG8gb3VyIG9mX25vZGUg
Zm9yIG91ciB1c2VyCi0JICogdG8gbG9vayB1cC4KLQkgKi8KLQlsdmRzX2VuY29kZXItPmJyaWRn
ZS5vZl9ub2RlID0gZGV2LT5vZl9ub2RlOwotCWx2ZHNfZW5jb2Rlci0+YnJpZGdlLmZ1bmNzID0g
JmZ1bmNzOwotCWRybV9icmlkZ2VfYWRkKCZsdmRzX2VuY29kZXItPmJyaWRnZSk7Ci0KLQlwbGF0
Zm9ybV9zZXRfZHJ2ZGF0YShwZGV2LCBsdmRzX2VuY29kZXIpOwotCi0JcmV0dXJuIDA7Ci19Ci0K
LXN0YXRpYyBpbnQgbHZkc19lbmNvZGVyX3JlbW92ZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpw
ZGV2KQotewotCXN0cnVjdCBsdmRzX2VuY29kZXIgKmx2ZHNfZW5jb2RlciA9IHBsYXRmb3JtX2dl
dF9kcnZkYXRhKHBkZXYpOwotCi0JZHJtX2JyaWRnZV9yZW1vdmUoJmx2ZHNfZW5jb2Rlci0+YnJp
ZGdlKTsKLQotCXJldHVybiAwOwotfQotCi1zdGF0aWMgY29uc3Qgc3RydWN0IG9mX2RldmljZV9p
ZCBsdmRzX2VuY29kZXJfbWF0Y2hbXSA9IHsKLQl7IC5jb21wYXRpYmxlID0gImx2ZHMtZW5jb2Rl
ciIgfSwKLQl7IC5jb21wYXRpYmxlID0gInRoaW5lLHRoYzYzbHZkbTgzZCIgfSwKLQl7fSwKLX07
Ci1NT0RVTEVfREVWSUNFX1RBQkxFKG9mLCBsdmRzX2VuY29kZXJfbWF0Y2gpOwotCi1zdGF0aWMg
c3RydWN0IHBsYXRmb3JtX2RyaXZlciBsdmRzX2VuY29kZXJfZHJpdmVyID0gewotCS5wcm9iZQk9
IGx2ZHNfZW5jb2Rlcl9wcm9iZSwKLQkucmVtb3ZlCT0gbHZkc19lbmNvZGVyX3JlbW92ZSwKLQku
ZHJpdmVyCQk9IHsKLQkJLm5hbWUJCT0gImx2ZHMtZW5jb2RlciIsCi0JCS5vZl9tYXRjaF90YWJs
ZQk9IGx2ZHNfZW5jb2Rlcl9tYXRjaCwKLQl9LAotfTsKLW1vZHVsZV9wbGF0Zm9ybV9kcml2ZXIo
bHZkc19lbmNvZGVyX2RyaXZlcik7Ci0KLU1PRFVMRV9BVVRIT1IoIkxhdXJlbnQgUGluY2hhcnQg
PGxhdXJlbnQucGluY2hhcnRAaWRlYXNvbmJvYXJkLmNvbT4iKTsKLU1PRFVMRV9ERVNDUklQVElP
TigiVHJhbnNwYXJlbnQgcGFyYWxsZWwgdG8gTFZEUyBlbmNvZGVyIik7Ci1NT0RVTEVfTElDRU5T
RSgiR1BMIik7Ci0tIAoyLjcuNAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRl
c2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8v
ZHJpLWRldmVs
