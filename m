Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 5C30E5B11D
	for <lists+dri-devel@lfdr.de>; Sun, 30 Jun 2019 20:23:06 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id BBA9589C48;
	Sun, 30 Jun 2019 18:23:03 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-io1-xd43.google.com (mail-io1-xd43.google.com
 [IPv6:2607:f8b0:4864:20::d43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 23F0289C48
 for <dri-devel@lists.freedesktop.org>; Sun, 30 Jun 2019 18:23:02 +0000 (UTC)
Received: by mail-io1-xd43.google.com with SMTP id k20so23536471ios.10
 for <dri-devel@lists.freedesktop.org>; Sun, 30 Jun 2019 11:23:02 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=thtzmkw13aDuZDygR3uiUylpyUs6othiMlPhmCe3nAU=;
 b=Be13xZiQhmwn3Ypmctf8x3Eay+z/bUc8gjCcf8hZRa3zd0NjKdHxWRiuCeLGNa6kMR
 VADlU7EtAKWdRlqQ8tUookUbdRGvejDh7nnWDBhpkDVWLCXTlX27l4rdoV1EvvwiQCs1
 cgdtVdYb49pNfyuSdyecfZkt4uh0v+1Gy+Xc9Mr6sXN8WA01haeC6HJsdYtoOsmfQvsU
 x4nOOjH3+TloUn7WzjY8mg8/hOac/GtaYLvpvXlLlBSKwNq1YsM/nLGRsdvlxWqGYO2o
 jfh5rum2R/iuRhpkSbnMTZyFiLrPuGg6UUQHzaA7FzvY0ZHH+7D8yxtSOuCqdDLr43XE
 Ng5w==
X-Gm-Message-State: APjAAAUl2xADqhgBYIrcebPIhEZ/J67KLoyiRa2SU02o9nI/gOtc7gRb
 u18wwG8mweo2GIptWVtPUww98lvaHaS0usMLvk4=
X-Google-Smtp-Source: APXvYqyjDNYRK/s9/BxWAEOavJrJdn2pveXoixy7KR63PBJct6zgL0JmPikVQ1pnvsc/XbBtBVyLkxFPxtoujjrrQEc=
X-Received: by 2002:a5d:8e08:: with SMTP id e8mr23366852iod.139.1561918981319; 
 Sun, 30 Jun 2019 11:23:01 -0700 (PDT)
MIME-Version: 1.0
References: <20190628121338.24398-1-kraxel@redhat.com>
 <20190628121338.24398-10-kraxel@redhat.com>
In-Reply-To: <20190628121338.24398-10-kraxel@redhat.com>
From: Chia-I Wu <olvaffe@gmail.com>
Date: Sun, 30 Jun 2019 11:22:50 -0700
Message-ID: <CAPaKu7T0fv08oVbyYLcpaHomB0w-ZbF4mKGsgt7ObziQxk3YNQ@mail.gmail.com>
Subject: Re: [PATCH v5 09/12] drm/virtio: rework virtio_gpu_object_create
 fencing
To: Gerd Hoffmann <kraxel@redhat.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=thtzmkw13aDuZDygR3uiUylpyUs6othiMlPhmCe3nAU=;
 b=fCcbdXH9WO0fjnsX0cG4kMxd8kDGj9eP4YcIaQOOKv5Ozt5PxyEJ9hoY9qtJPyIvE0
 aZjGB9sWgGskqozbUzllzSvwa4DUEZLCWfymAoZMXW2ouFATq/2lTaFbIw7kLnFhnpzk
 V9eRCBawjO47dljbxZq0vbv0t5s10P1Xhiw0f0HHRnE43pz0VKOxNMhuA8RpUF0SOI37
 BjLZZcA99lc7C28BqRbFsGFeev9Rth5p3LfoH3pCa5upP52BFN7ysvpHqepK11WoY1TK
 IA6BA6Z6j+rjISDK5SQXLv9EQs/k7R6DulDG3DB+p39SUif2IV8lM6wvCOuJvO5PDl6x
 juhg==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: David Airlie <airlied@linux.ie>, open list <linux-kernel@vger.kernel.org>,
 ML dri-devel <dri-devel@lists.freedesktop.org>,
 "open list:VIRTIO GPU DRIVER" <virtualization@lists.linux-foundation.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gRnJpLCBKdW4gMjgsIDIwMTkgYXQgNToxMyBBTSBHZXJkIEhvZmZtYW5uIDxrcmF4ZWxAcmVk
aGF0LmNvbT4gd3JvdGU6Cj4KPiBVc2UgZ2VtIHJlc2VydmF0aW9uIGhlbHBlcnMgYW5kIGRpcmVj
dCByZXNlcnZhdGlvbl9vYmplY3RfKiBjYWxscwo+IGluc3RlYWQgb2YgdHRtLgo+Cj4gdjU6IGZp
eCBmZW5jaW5nIChDaGlhLUkgV3UpLgo+IHYzOiBEdWUgdG8gdXNpbmcgdGhlIGdlbSByZXNlcnZh
dGlvbiBvYmplY3QgaXQgaXMgaW5pdGlhbGl6ZWQgYW5kIHJlYWR5Cj4gZm9yIHVzZSBiZWZvcmUg
Y2FsbGluZyB0dG1fYm9faW5pdCwgc28gd2UgY2FuIGFsc28gZHJvcCB0aGUgdHJpY2t5IGZlbmNl
Cj4gbG9naWMgd2hpY2ggY2hlY2tzIHdoZW5ldmVyIHRoZSBjb21tYW5kIGlzIGluIGZsaWdodCBz
dGlsbC4gIFdlIGNhbgo+IHNpbXBseSBmZW5jZSBvdXIgb2JqZWN0IGJlZm9yZSBzdWJtaXR0aW5n
IHRoZSB2aXJ0aW8gY29tbWFuZCBhbmQgYmUgZG9uZQo+IHdpdGggaXQuCj4KPiBTaWduZWQtb2Zm
LWJ5OiBHZXJkIEhvZmZtYW5uIDxrcmF4ZWxAcmVkaGF0LmNvbT4KPiBBY2tlZC1ieTogRGFuaWVs
IFZldHRlciA8ZGFuaWVsLnZldHRlckBmZndsbC5jaD4KPiAtLS0KPiAgZHJpdmVycy9ncHUvZHJt
L3ZpcnRpby92aXJ0Z3B1X2Rydi5oICAgIHwgIDIgKwo+ICBkcml2ZXJzL2dwdS9kcm0vdmlydGlv
L3ZpcnRncHVfb2JqZWN0LmMgfCA1NSArKysrKysrKysrLS0tLS0tLS0tLS0tLS0tCj4gIGRyaXZl
cnMvZ3B1L2RybS92aXJ0aW8vdmlydGdwdV92cS5jICAgICB8ICA0ICsrCj4gIDMgZmlsZXMgY2hh
bmdlZCwgMjcgaW5zZXJ0aW9ucygrKSwgMzQgZGVsZXRpb25zKC0pCj4KPiBkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL3Zp
cnRpby92aXJ0Z3B1X2Rydi5oCj4gaW5kZXggMzU2ZDI3MTMyMzg4Li5jNGIyNjZiNmY3MzEgMTAw
NjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X2Rydi5oCj4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X2Rydi5oCj4gQEAgLTI2Nyw2ICsyNjcsNyBA
QCB2b2lkIHZpcnRpb19ncHVfZnJlZV92YnVmcyhzdHJ1Y3QgdmlydGlvX2dwdV9kZXZpY2UgKnZn
ZGV2KTsKPiAgdm9pZCB2aXJ0aW9fZ3B1X2NtZF9jcmVhdGVfcmVzb3VyY2Uoc3RydWN0IHZpcnRp
b19ncHVfZGV2aWNlICp2Z2RldiwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBzdHJ1Y3QgdmlydGlvX2dwdV9vYmplY3QgKmJvLAo+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHN0cnVjdCB2aXJ0aW9fZ3B1X29iamVjdF9wYXJhbXMgKnBhcmFtcywKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdmlydGlvX2dwdV9vYmpl
Y3RfYXJyYXkgKm9ianMsCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ry
dWN0IHZpcnRpb19ncHVfZmVuY2UgKmZlbmNlKTsKPiAgdm9pZCB2aXJ0aW9fZ3B1X2NtZF91bnJl
Zl9yZXNvdXJjZShzdHJ1Y3QgdmlydGlvX2dwdV9kZXZpY2UgKnZnZGV2LAo+ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgcmVzb3VyY2VfaWQpOwo+IEBAIC0zMjks
NiArMzMwLDcgQEAgdm9pZAo+ICB2aXJ0aW9fZ3B1X2NtZF9yZXNvdXJjZV9jcmVhdGVfM2Qoc3Ry
dWN0IHZpcnRpb19ncHVfZGV2aWNlICp2Z2RldiwKPiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgc3RydWN0IHZpcnRpb19ncHVfb2JqZWN0ICpibywKPiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IHZpcnRpb19ncHVfb2JqZWN0X3BhcmFtcyAqcGFyYW1z
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdmlydGlvX2dwdV9v
YmplY3RfYXJyYXkgKm9ianMsCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0
cnVjdCB2aXJ0aW9fZ3B1X2ZlbmNlICpmZW5jZSk7Cj4gIHZvaWQgdmlydGlvX2dwdV9jdHJsX2Fj
ayhzdHJ1Y3QgdmlydHF1ZXVlICp2cSk7Cj4gIHZvaWQgdmlydGlvX2dwdV9jdXJzb3JfYWNrKHN0
cnVjdCB2aXJ0cXVldWUgKnZxKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZpcnRp
by92aXJ0Z3B1X29iamVjdC5jIGIvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X29iamVj
dC5jCj4gaW5kZXggODJiZmJmOTgzZmQyLi5mYTBlYTIyYzY4YjAgMTAwNjQ0Cj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X29iamVjdC5jCj4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL3ZpcnRpby92aXJ0Z3B1X29iamVjdC5jCj4gQEAgLTk3LDcgKzk3LDkgQEAgaW50IHZpcnRp
b19ncHVfb2JqZWN0X2NyZWF0ZShzdHJ1Y3QgdmlydGlvX2dwdV9kZXZpY2UgKnZnZGV2LAo+ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHZpcnRpb19ncHVfb2JqZWN0ICoqYm9f
cHRyLAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHZpcnRpb19ncHVfZmVu
Y2UgKmZlbmNlKQo+ICB7Cj4gKyAgICAgICBzdHJ1Y3QgdmlydGlvX2dwdV9vYmplY3RfYXJyYXkg
Km9ianMgPSBOVUxMOwo+ICAgICAgICAgc3RydWN0IHZpcnRpb19ncHVfb2JqZWN0ICpibzsKPiAr
ICAgICAgIHN0cnVjdCB3d19hY3F1aXJlX2N0eCB0aWNrZXQ7Cj4gICAgICAgICBzaXplX3QgYWNj
X3NpemU7Cj4gICAgICAgICBpbnQgcmV0Owo+Cj4gQEAgLTEyMywxMiArMTI1LDI5IEBAIGludCB2
aXJ0aW9fZ3B1X29iamVjdF9jcmVhdGUoc3RydWN0IHZpcnRpb19ncHVfZGV2aWNlICp2Z2RldiwK
PiAgICAgICAgIH0KPiAgICAgICAgIGJvLT5kdW1iID0gcGFyYW1zLT5kdW1iOwo+Cj4gKyAgICAg
ICBpZiAoZmVuY2UpIHsKPiArICAgICAgICAgICAgICAgb2JqcyA9IHZpcnRpb19ncHVfYXJyYXlf
YWxsb2MoMSk7Cj4gKyAgICAgICAgICAgICAgIG9ianMtPm9ianNbMF0gPSAmYm8tPmdlbV9iYXNl
Owo+ICsgICAgICAgICAgICAgICBkcm1fZ2VtX29iamVjdF9nZXQob2Jqcy0+b2Jqc1swXSk7Cj4g
Kwo+ICsgICAgICAgICAgICAgICByZXQgPSBkcm1fZ2VtX2xvY2tfcmVzZXJ2YXRpb25zKG9ianMt
Pm9ianMsIG9ianMtPm5lbnRzLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICZ0aWNrZXQpOwpXZSBjYW4gdXNlIHZpcnRpb19ncHVfb2JqZWN0X3Jlc2Vy
dmUgd2hlbiB0aGVyZSBpcyBvbmx5IG9uZSBvYmplY3QuCgo+ICsgICAgICAgICAgICAgICBpZiAo
cmV0ID09IDApCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmVzZXJ2YXRpb25fb2JqZWN0X2Fk
ZF9leGNsX2ZlbmNlKG9ianMtPm9ianNbMF0tPnJlc3YsCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZmZW5jZS0+Zik7ClNpbWlsYXIg
dG8gaW4gZXhlY2J1ZmZlciwgdGhpcyBtaWdodCBuZWVkIHRvIGJlIG1vdmVkIHRvIGFmdGVyCnZp
cnRpb19ncHVfY21kX3Jlc291cmNlX2NyZWF0ZV8qLgo+ICsgICAgICAgfQo+ICsKPiAgICAgICAg
IGlmIChwYXJhbXMtPnZpcmdsKSB7Cj4gLSAgICAgICAgICAgICAgIHZpcnRpb19ncHVfY21kX3Jl
c291cmNlX2NyZWF0ZV8zZCh2Z2RldiwgYm8sIHBhcmFtcywgZmVuY2UpOwo+ICsgICAgICAgICAg
ICAgICB2aXJ0aW9fZ3B1X2NtZF9yZXNvdXJjZV9jcmVhdGVfM2QodmdkZXYsIGJvLCBwYXJhbXMs
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmpz
LCBmZW5jZSk7Cj4gICAgICAgICB9IGVsc2Ugewo+IC0gICAgICAgICAgICAgICB2aXJ0aW9fZ3B1
X2NtZF9jcmVhdGVfcmVzb3VyY2UodmdkZXYsIGJvLCBwYXJhbXMsIGZlbmNlKTsKPiArICAgICAg
ICAgICAgICAgdmlydGlvX2dwdV9jbWRfY3JlYXRlX3Jlc291cmNlKHZnZGV2LCBibywgcGFyYW1z
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Jqcywg
ZmVuY2UpOwo+ICAgICAgICAgfQo+Cj4gKyAgICAgICBpZiAoZmVuY2UpCj4gKyAgICAgICAgICAg
ICAgIGRybV9nZW1fdW5sb2NrX3Jlc2VydmF0aW9ucyhvYmpzLT5vYmpzLCBvYmpzLT5uZW50cywg
JnRpY2tldCk7Cm9ianMgbWlnaHQgaGF2ZSBiZWVuIGZyZWVkLgo+ICsKPiAgICAgICAgIHZpcnRp
b19ncHVfaW5pdF90dG1fcGxhY2VtZW50KGJvKTsKPiAgICAgICAgIHJldCA9IHR0bV9ib19pbml0
KCZ2Z2Rldi0+bW1hbi5iZGV2LCAmYm8tPnRibywgcGFyYW1zLT5zaXplLAo+ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdHRtX2JvX3R5cGVfZGV2aWNlLCAmYm8tPnBsYWNlbWVudCwgMCwKPiBA
QCAtMTM5LDM4ICsxNTgsNiBAQCBpbnQgdmlydGlvX2dwdV9vYmplY3RfY3JlYXRlKHN0cnVjdCB2
aXJ0aW9fZ3B1X2RldmljZSAqdmdkZXYsCj4gICAgICAgICBpZiAocmV0ICE9IDApCj4gICAgICAg
ICAgICAgICAgIHJldHVybiByZXQ7Cj4KPiAtICAgICAgIGlmIChmZW5jZSkgewo+IC0gICAgICAg
ICAgICAgICBzdHJ1Y3QgdmlydGlvX2dwdV9mZW5jZV9kcml2ZXIgKmRydiA9ICZ2Z2Rldi0+ZmVu
Y2VfZHJ2Owo+IC0gICAgICAgICAgICAgICBzdHJ1Y3QgbGlzdF9oZWFkIHZhbGlkYXRlX2xpc3Q7
Cj4gLSAgICAgICAgICAgICAgIHN0cnVjdCB0dG1fdmFsaWRhdGVfYnVmZmVyIG1haW5idWY7Cj4g
LSAgICAgICAgICAgICAgIHN0cnVjdCB3d19hY3F1aXJlX2N0eCB0aWNrZXQ7Cj4gLSAgICAgICAg
ICAgICAgIHVuc2lnbmVkIGxvbmcgaXJxX2ZsYWdzOwo+IC0gICAgICAgICAgICAgICBib29sIHNp
Z25hbGVkOwo+IC0KPiAtICAgICAgICAgICAgICAgSU5JVF9MSVNUX0hFQUQoJnZhbGlkYXRlX2xp
c3QpOwo+IC0gICAgICAgICAgICAgICBtZW1zZXQoJm1haW5idWYsIDAsIHNpemVvZihzdHJ1Y3Qg
dHRtX3ZhbGlkYXRlX2J1ZmZlcikpOwo+IC0KPiAtICAgICAgICAgICAgICAgLyogdXNlIGEgZ2Vt
IHJlZmVyZW5jZSBzaW5jZSB1bnJlZiBsaXN0IHVuZG9lcyB0aGVtICovCj4gLSAgICAgICAgICAg
ICAgIGRybV9nZW1fb2JqZWN0X2dldCgmYm8tPmdlbV9iYXNlKTsKPiAtICAgICAgICAgICAgICAg
bWFpbmJ1Zi5ibyA9ICZiby0+dGJvOwo+IC0gICAgICAgICAgICAgICBsaXN0X2FkZCgmbWFpbmJ1
Zi5oZWFkLCAmdmFsaWRhdGVfbGlzdCk7Cj4gLQo+IC0gICAgICAgICAgICAgICByZXQgPSB2aXJ0
aW9fZ3B1X29iamVjdF9saXN0X3ZhbGlkYXRlKCZ0aWNrZXQsICZ2YWxpZGF0ZV9saXN0KTsKPiAt
ICAgICAgICAgICAgICAgaWYgKHJldCA9PSAwKSB7Cj4gLSAgICAgICAgICAgICAgICAgICAgICAg
c3Bpbl9sb2NrX2lycXNhdmUoJmRydi0+bG9jaywgaXJxX2ZsYWdzKTsKPiAtICAgICAgICAgICAg
ICAgICAgICAgICBzaWduYWxlZCA9IHZpcnRpb19mZW5jZV9zaWduYWxlZCgmZmVuY2UtPmYpOwo+
IC0gICAgICAgICAgICAgICAgICAgICAgIGlmICghc2lnbmFsZWQpCj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAvKiB2aXJ0aW8gY3JlYXRlIGNvbW1hbmQgc3RpbGwgaW4gZmxpZ2h0
ICovCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0dG1fZXVfZmVuY2VfYnVmZmVy
X29iamVjdHMoJnRpY2tldCwgJnZhbGlkYXRlX2xpc3QsCj4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmZlbmNlLT5mKTsKPiAtICAg
ICAgICAgICAgICAgICAgICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZkcnYtPmxvY2ssIGly
cV9mbGFncyk7Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNpZ25hbGVkKQo+IC0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogdmlydGlvIGNyZWF0ZSBjb21tYW5kIGZpbmlz
aGVkICovCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0dG1fZXVfYmFja29mZl9y
ZXNlcnZhdGlvbigmdGlja2V0LCAmdmFsaWRhdGVfbGlzdCk7Cj4gLSAgICAgICAgICAgICAgIH0K
PiAtICAgICAgICAgICAgICAgdmlydGlvX2dwdV91bnJlZl9saXN0KCZ2YWxpZGF0ZV9saXN0KTsK
PiAtICAgICAgIH0KPiAtCj4gICAgICAgICAqYm9fcHRyID0gYm87Cj4gICAgICAgICByZXR1cm4g
MDsKPiAgfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfdnEu
YyBiL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8vdmlydGdwdV92cS5jCj4gaW5kZXggMGM4N2MzZTA4
NmY4Li4wYTczNWU1MWE4MDMgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92
aXJ0Z3B1X3ZxLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfdnEuYwo+
IEBAIC0zOTEsNiArMzkxLDcgQEAgc3RhdGljIGludCB2aXJ0aW9fZ3B1X3F1ZXVlX2N1cnNvcihz
dHJ1Y3QgdmlydGlvX2dwdV9kZXZpY2UgKnZnZGV2LAo+ICB2b2lkIHZpcnRpb19ncHVfY21kX2Ny
ZWF0ZV9yZXNvdXJjZShzdHJ1Y3QgdmlydGlvX2dwdV9kZXZpY2UgKnZnZGV2LAo+ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB2aXJ0aW9fZ3B1X29iamVjdCAqYm8s
Cj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHZpcnRpb19ncHVf
b2JqZWN0X3BhcmFtcyAqcGFyYW1zLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHN0cnVjdCB2aXJ0aW9fZ3B1X29iamVjdF9hcnJheSAqb2JqcywKPiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdmlydGlvX2dwdV9mZW5jZSAqZmVuY2UpCj4g
IHsKPiAgICAgICAgIHN0cnVjdCB2aXJ0aW9fZ3B1X3Jlc291cmNlX2NyZWF0ZV8yZCAqY21kX3A7
Cj4gQEAgLTM5OCw2ICszOTksNyBAQCB2b2lkIHZpcnRpb19ncHVfY21kX2NyZWF0ZV9yZXNvdXJj
ZShzdHJ1Y3QgdmlydGlvX2dwdV9kZXZpY2UgKnZnZGV2LAo+Cj4gICAgICAgICBjbWRfcCA9IHZp
cnRpb19ncHVfYWxsb2NfY21kKHZnZGV2LCAmdmJ1Ziwgc2l6ZW9mKCpjbWRfcCkpOwo+ICAgICAg
ICAgbWVtc2V0KGNtZF9wLCAwLCBzaXplb2YoKmNtZF9wKSk7Cj4gKyAgICAgICB2YnVmLT5vYmpz
ID0gb2JqczsKPgo+ICAgICAgICAgY21kX3AtPmhkci50eXBlID0gY3B1X3RvX2xlMzIoVklSVElP
X0dQVV9DTURfUkVTT1VSQ0VfQ1JFQVRFXzJEKTsKPiAgICAgICAgIGNtZF9wLT5yZXNvdXJjZV9p
ZCA9IGNwdV90b19sZTMyKGJvLT5od19yZXNfaGFuZGxlKTsKPiBAQCAtODY0LDYgKzg2Niw3IEBA
IHZvaWQKPiAgdmlydGlvX2dwdV9jbWRfcmVzb3VyY2VfY3JlYXRlXzNkKHN0cnVjdCB2aXJ0aW9f
Z3B1X2RldmljZSAqdmdkZXYsCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0
cnVjdCB2aXJ0aW9fZ3B1X29iamVjdCAqYm8sCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHN0cnVjdCB2aXJ0aW9fZ3B1X29iamVjdF9wYXJhbXMgKnBhcmFtcywKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHZpcnRpb19ncHVfb2JqZWN0X2FycmF5
ICpvYmpzLAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdmlydGlv
X2dwdV9mZW5jZSAqZmVuY2UpCj4gIHsKPiAgICAgICAgIHN0cnVjdCB2aXJ0aW9fZ3B1X3Jlc291
cmNlX2NyZWF0ZV8zZCAqY21kX3A7Cj4gQEAgLTg3MSw2ICs4NzQsNyBAQCB2aXJ0aW9fZ3B1X2Nt
ZF9yZXNvdXJjZV9jcmVhdGVfM2Qoc3RydWN0IHZpcnRpb19ncHVfZGV2aWNlICp2Z2RldiwKPgo+
ICAgICAgICAgY21kX3AgPSB2aXJ0aW9fZ3B1X2FsbG9jX2NtZCh2Z2RldiwgJnZidWYsIHNpemVv
ZigqY21kX3ApKTsKPiAgICAgICAgIG1lbXNldChjbWRfcCwgMCwgc2l6ZW9mKCpjbWRfcCkpOwo+
ICsgICAgICAgdmJ1Zi0+b2JqcyA9IG9ianM7Cj4KPiAgICAgICAgIGNtZF9wLT5oZHIudHlwZSA9
IGNwdV90b19sZTMyKFZJUlRJT19HUFVfQ01EX1JFU09VUkNFX0NSRUFURV8zRCk7Cj4gICAgICAg
ICBjbWRfcC0+cmVzb3VyY2VfaWQgPSBjcHVfdG9fbGUzMihiby0+aHdfcmVzX2hhbmRsZSk7Cj4g
LS0KPiAyLjE4LjEKPgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5v
cmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2
ZWw=
