Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 58F89A7575
	for <lists+dri-devel@lfdr.de>; Tue,  3 Sep 2019 22:49:03 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 160A389C49;
	Tue,  3 Sep 2019 20:48:46 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 624D789C3F;
 Tue,  3 Sep 2019 20:48:41 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx07.intmail.prod.int.phx2.redhat.com
 [10.5.11.22])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 82C9A7BDA5;
 Tue,  3 Sep 2019 20:48:40 +0000 (UTC)
Received: from malachite.bss.redhat.com (dhcp-10-20-1-34.bss.redhat.com
 [10.20.1.34])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 400791001956;
 Tue,  3 Sep 2019 20:48:39 +0000 (UTC)
From: Lyude Paul <lyude@redhat.com>
To: dri-devel@lists.freedesktop.org, nouveau@lists.freedesktop.org,
 amd-gfx@lists.freedesktop.org
Subject: [PATCH v2 21/27] drm/dp_mst: Don't forget to update port->input in
 drm_dp_mst_handle_conn_stat()
Date: Tue,  3 Sep 2019 16:45:59 -0400
Message-Id: <20190903204645.25487-22-lyude@redhat.com>
In-Reply-To: <20190903204645.25487-1-lyude@redhat.com>
References: <20190903204645.25487-1-lyude@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.22
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.26]); Tue, 03 Sep 2019 20:48:40 +0000 (UTC)
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Sean Paul <sean@poorly.run>, David Airlie <airlied@linux.ie>,
 Daniel Vetter <daniel.vetter@ffwll.ch>, linux-kernel@vger.kernel.org,
 Maxime Ripard <mripard@kernel.org>, Juston Li <juston.li@intel.com>,
 Harry Wentland <hwentlan@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBwcm9iYWJseSBoYXNuJ3QgY2F1c2VkIGFueSBwcm9ibGVtcyB1cCB1bnRpbCBub3cgc2lu
Y2UgaXQncwpwcm9iYWJseSBuZWFybHkgaW1wb3NzaWJsZSB0byBlbmNvdW50ZXIgdGhpcyBpbiB0
aGUgd2lsZCwgaG93ZXZlciBpZiB3ZQp3ZXJlIHRvIHJlY2VpdmUgYSBjb25uZWN0aW9uIHN0YXR1
cyBub3RpZmljYXRpb24gZnJvbSB0aGUgTVNUIGh1YiBhZnRlcgpyZXN1bWUgd2hpbGUgd2UncmUg
aW4gdGhlIG1pZGRsZSBvZiByZXByb2JpbmcgdGhlIGxpbmsgYWRkcmVzc2VzIGZvciBhCnRvcG9s
b2d5IHRoZW4gdGhlcmUncyBhIG11Y2ggbGFyZ2VyIGNoYW5jZSB0aGF0IGEgcG9ydCBjb3VsZCBo
YXZlCmNoYW5nZWQgZnJvbSBiZWluZyBhbiBvdXRwdXQgcG9ydCB0byBpbnB1dCBwb3J0IChvciB2
aWNlIHZlcnNhKS4gSWYgd2UKZm9yZ2V0IHRvIHVwZGF0ZSB0aGlzIGJpdCBvZiBpbmZvcm1hdGlv
biwgd2UnbGwgcG90ZW50aWFsbHkgaWdub3JlIGEKdmFsaWQgUERUIGNoYW5nZSBvbiBhIGRvd25z
dHJlYW0gcG9ydCBiZWNhdXNlIHdlIHRoaW5rIGl0J3MgYW4gaW5wdXQKcG9ydC4KClNvLCBtYWtl
IHN1cmUgd2UgcmVhZCB0aGUgaW5wdXRfcG9ydCBmaWVsZCBpbiBjb25uZWN0aW9uIHN0YXR1cwpu
b3RpZmljYXRpb25zIGluIGRybV9kcF9tc3RfaGFuZGxlX2Nvbm5fc3RhdCgpIHRvIHByZXZlbnQg
dGhpcyBmcm9tCmhhcHBlbmluZyBvbmNlIHdlJ3ZlIGltcGxlbWVudGVkIHN1c3BlbmQvcmVzdW1l
IHJlcHJvYmluZy4KCkNjOiBKdXN0b24gTGkgPGp1c3Rvbi5saUBpbnRlbC5jb20+CkNjOiBJbXJl
IERlYWsgPGltcmUuZGVha0BpbnRlbC5jb20+CkNjOiBWaWxsZSBTeXJqw6Rsw6QgPHZpbGxlLnN5
cmphbGFAbGludXguaW50ZWwuY29tPgpDYzogSGFycnkgV2VudGxhbmQgPGh3ZW50bGFuQGFtZC5j
b20+CkNjOiBEYW5pZWwgVmV0dGVyIDxkYW5pZWwudmV0dGVyQGZmd2xsLmNoPgpTaWduZWQtb2Zm
LWJ5OiBMeXVkZSBQYXVsIDxseXVkZUByZWRoYXQuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9k
cm1fZHBfbXN0X3RvcG9sb2d5LmMgfCA1MSArKysrKysrKysrKysrKysrKysrLS0tLS0tLS0KIDEg
ZmlsZSBjaGFuZ2VkLCAzNyBpbnNlcnRpb25zKCspLCAxNCBkZWxldGlvbnMoLSkKCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2RwX21zdF90b3BvbG9neS5jIGIvZHJpdmVycy9ncHUv
ZHJtL2RybV9kcF9tc3RfdG9wb2xvZ3kuYwppbmRleCAyNTk2MzRjNWQ2ZGMuLmU0MDdhYmExZmJk
MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2RybV9kcF9tc3RfdG9wb2xvZ3kuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vZHJtX2RwX21zdF90b3BvbG9neS5jCkBAIC0yMDc4LDE4ICsyMDc4
LDIzIEBAIHN0YXRpYyB2b2lkCiBkcm1fZHBfbXN0X2hhbmRsZV9jb25uX3N0YXQoc3RydWN0IGRy
bV9kcF9tc3RfYnJhbmNoICptc3RiLAogCQkJICAgIHN0cnVjdCBkcm1fZHBfY29ubmVjdGlvbl9z
dGF0dXNfbm90aWZ5ICpjb25uX3N0YXQpCiB7Ci0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IG1z
dGItPm1nci0+ZGV2OworCXN0cnVjdCBkcm1fZHBfbXN0X3RvcG9sb2d5X21nciAqbWdyID0gbXN0
Yi0+bWdyOworCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBtZ3ItPmRldjsKIAlzdHJ1Y3QgZHJt
X2RwX21zdF9wb3J0ICpwb3J0OwotCWludCBvbGRfZGRwczsKLQlib29sIGRvd29yayA9IGZhbHNl
OworCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3JfdG9fZGVzdHJveSA9IE5VTEw7CisJ
aW50IG9sZF9kZHBzLCByZXQ7CisJdTggbmV3X3BkdDsKKwlib29sIGRvd29yayA9IGZhbHNlLCBj
cmVhdGVfY29ubmVjdG9yID0gZmFsc2U7CiAKIAlwb3J0ID0gZHJtX2RwX2dldF9wb3J0KG1zdGIs
IGNvbm5fc3RhdC0+cG9ydF9udW1iZXIpOwogCWlmICghcG9ydCkKIAkJcmV0dXJuOwogCisJbXV0
ZXhfbG9jaygmcG9ydC0+bG9jayk7CiAJZHJtX21vZGVzZXRfbG9jaygmZGV2LT5tb2RlX2NvbmZp
Zy5jb25uZWN0aW9uX211dGV4LCBOVUxMKTsKIAogCW9sZF9kZHBzID0gcG9ydC0+ZGRwczsKKwlw
b3J0LT5pbnB1dCA9IGNvbm5fc3RhdC0+aW5wdXRfcG9ydDsKIAlwb3J0LT5tY3MgPSBjb25uX3N0
YXQtPm1lc3NhZ2VfY2FwYWJpbGl0eV9zdGF0dXM7CiAJcG9ydC0+bGRwcyA9IGNvbm5fc3RhdC0+
bGVnYWN5X2RldmljZV9wbHVnX3N0YXR1czsKIAlwb3J0LT5kZHBzID0gY29ubl9zdGF0LT5kaXNw
bGF5cG9ydF9kZXZpY2VfcGx1Z19zdGF0dXM7CkBAIC0yMTAyLDIzICsyMTA3LDQxIEBAIGRybV9k
cF9tc3RfaGFuZGxlX2Nvbm5fc3RhdChzdHJ1Y3QgZHJtX2RwX21zdF9icmFuY2ggKm1zdGIsCiAJ
CX0KIAl9CiAKLQlpZiAoIXBvcnQtPmlucHV0KSB7Ci0JCWludCByZXQgPSBkcm1fZHBfcG9ydF9z
ZXRfcGR0KHBvcnQsCi0JCQkJCSAgICAgIGNvbm5fc3RhdC0+cGVlcl9kZXZpY2VfdHlwZSk7Ci0J
CWlmIChyZXQgPT0gMSkgewotCQkJZG93b3JrID0gdHJ1ZTsKLQkJfSBlbHNlIGlmIChyZXQgPCAw
KSB7Ci0JCQlEUk1fRVJST1IoIkZhaWxlZCB0byBjaGFuZ2UgUERUIGZvciBwb3J0ICVwOiAlZFxu
IiwKLQkJCQkgIHBvcnQsIHJldCk7Ci0JCQlkb3dvcmsgPSBmYWxzZTsKLQkJfQorCW5ld19wZHQg
PSBwb3J0LT5pbnB1dCA/IERQX1BFRVJfREVWSUNFX05PTkUgOiBjb25uX3N0YXQtPnBlZXJfZGV2
aWNlX3R5cGU7CisKKwlyZXQgPSBkcm1fZHBfcG9ydF9zZXRfcGR0KHBvcnQsIG5ld19wZHQpOwor
CWlmIChyZXQgPT0gMSkgeworCQlkb3dvcmsgPSB0cnVlOworCX0gZWxzZSBpZiAocmV0IDwgMCkg
eworCQlEUk1fRVJST1IoIkZhaWxlZCB0byBjaGFuZ2UgUERUIGZvciBwb3J0ICVwOiAlZFxuIiwK
KwkJCSAgcG9ydCwgcmV0KTsKKwkJZG93b3JrID0gZmFsc2U7CisJfQorCisJLyoKKwkgKiBXZSB1
bnNldCBwb3J0LT5jb25uZWN0b3IgYmVmb3JlIGRyb3BwaW5nIGNvbm5lY3Rpb25fbXV0ZXggc28g
dGhhdAorCSAqIHRoZXJlJ3Mgbm8gY2hhbmNlIGFueSBvZiB0aGUgYXRvbWljIE1TVCBoZWxwZXJz
IGNhbiBhY2NpZGVudGFsbHkKKwkgKiBhc3NvY2lhdGUgYSB0by1iZS1kZXN0cm95ZWQgY29ubmVj
dG9yIHdpdGggYSBwb3J0LgorCSAqLworCWlmIChwb3J0LT5jb25uZWN0b3IgJiYgcG9ydC0+aW5w
dXQpIHsKKwkJY29ubmVjdG9yX3RvX2Rlc3Ryb3kgPSBwb3J0LT5jb25uZWN0b3I7CisJCXBvcnQt
PmNvbm5lY3RvciA9IE5VTEw7CisJfSBlbHNlIGlmICghcG9ydC0+Y29ubmVjdG9yICYmICFwb3J0
LT5pbnB1dCkgeworCQljcmVhdGVfY29ubmVjdG9yID0gdHJ1ZTsKIAl9CiAKIAlkcm1fbW9kZXNl
dF91bmxvY2soJmRldi0+bW9kZV9jb25maWcuY29ubmVjdGlvbl9tdXRleCk7CisKKwlpZiAoY29u
bmVjdG9yX3RvX2Rlc3Ryb3kpCisJCW1nci0+Y2JzLT5kZXN0cm95X2Nvbm5lY3RvcihtZ3IsIGNv
bm5lY3Rvcl90b19kZXN0cm95KTsKKwllbHNlIGlmIChjcmVhdGVfY29ubmVjdG9yKQorCQlkcm1f
ZHBfbXN0X3BvcnRfYWRkX2Nvbm5lY3Rvcihtc3RiLCBwb3J0KTsKKworCW11dGV4X3VubG9jaygm
cG9ydC0+bG9jayk7CisKIAlkcm1fZHBfbXN0X3RvcG9sb2d5X3B1dF9wb3J0KHBvcnQpOwogCWlm
IChkb3dvcmspCiAJCXF1ZXVlX3dvcmsoc3lzdGVtX2xvbmdfd3EsICZtc3RiLT5tZ3ItPndvcmsp
OwotCiB9CiAKIHN0YXRpYyBzdHJ1Y3QgZHJtX2RwX21zdF9icmFuY2ggKmRybV9kcF9nZXRfbXN0
X2JyYW5jaF9kZXZpY2Uoc3RydWN0IGRybV9kcF9tc3RfdG9wb2xvZ3lfbWdyICptZ3IsCi0tIAoy
LjIxLjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRy
aS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRw
czovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
