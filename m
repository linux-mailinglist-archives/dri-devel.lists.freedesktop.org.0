Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 48EB5F94B8
	for <lists+dri-devel@lfdr.de>; Tue, 12 Nov 2019 16:51:44 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6D6DA6EB66;
	Tue, 12 Nov 2019 15:51:41 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-qt1-x843.google.com (mail-qt1-x843.google.com
 [IPv6:2607:f8b0:4864:20::843])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6D7506EB66
 for <dri-devel@lists.freedesktop.org>; Tue, 12 Nov 2019 15:51:39 +0000 (UTC)
Received: by mail-qt1-x843.google.com with SMTP id o49so20235332qta.7
 for <dri-devel@lists.freedesktop.org>; Tue, 12 Nov 2019 07:51:39 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=JRkRZ7G9FEZbsuWYChLlwVfTl2uGOJSYFakfp3EaVJw=;
 b=LJKCM9Da0PEbwJC7qGegUHABxyPkFUta4kWkaU6GtpHJGsfS6oZqiJr3CIh9zreZHi
 f+rBsE/VMpcEWeftMzcYURfefHOXC+y1PbWT1knRLsSMAfwZVpBH9fmuHT4W758RvmxS
 IsL7f8BUSvcATTYQWQsHlU6NFBPUGqoG6nsX6hVOJwRfdXUSsBLY0I6nyUpmQSm45WhH
 eCZGCC8AkmQgHDt93BpNi0cKUUm0Dhl9gjBQ+q4dPpUqz/8X23gE6DjI1Q6o0/OEZ/eP
 M+gJgsrcdPDhqgsoIu9DWrBLEt6s74O6rMEDxl6gKwlUcSfDFwftxdK2H7rcR2bsdvBJ
 MZDg==
X-Gm-Message-State: APjAAAV4oLDR/0ACGAIqWve+Py+Jdd5cF4iWWLZMcvaKOZqkeDzBRqH6
 oufKQsZkV/dVBK7ueEqeQGeb4Dj2LVKFoPWN+UU=
X-Google-Smtp-Source: APXvYqw+pxUFTSyPILdszSIQZPHKTYgSQB4MBTgxCQZbMJ+mVpWZFt1CtOHmmuuGCJHpgxn3ylDrB73u58dQBgYPRec=
X-Received: by 2002:ac8:1494:: with SMTP id l20mr12163363qtj.356.1573573898357; 
 Tue, 12 Nov 2019 07:51:38 -0800 (PST)
MIME-Version: 1.0
References: <20191104173737.142558-1-robdclark@gmail.com>
 <20191104173737.142558-2-robdclark@gmail.com>
In-Reply-To: <20191104173737.142558-2-robdclark@gmail.com>
From: Enric Balletbo Serra <eballetbo@gmail.com>
Date: Tue, 12 Nov 2019 16:51:27 +0100
Message-ID: <CAFqH_52nFGmG-sMb03ByGSJGckT1D_TKWuy1DpkJt2usxHWHpA@mail.gmail.com>
Subject: Re: [PATCH 2/2 v2] drm/atomic: clear new_state pointers at hw_done
To: Rob Clark <robdclark@gmail.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=JRkRZ7G9FEZbsuWYChLlwVfTl2uGOJSYFakfp3EaVJw=;
 b=ujxa9jop550A/2di5rDoAoni3YLc8CaCGYZHLGIB6xDMKJ3j78Nn+UztcwrzgAdH1g
 zi37QlndiYuKmfPRgUX6pt/MHTgljgzl22nvRyThTcIm5zgMLSYbr44bmpgZw4ctebSU
 NC7zqIMewvyvxtzhrNUtQ+EwdW+FkQaeAfAjuCGQhOpSNv6r5an73gn0Y9Twzo5QNizC
 3F2ng5hbwmgJCD+p7dkxRVC21a0oelu6eXg0rLeaCHYW9K/Tv+NcKDaCkf0et8cG+Xzp
 PUI7WPhXsbD6V2wzCkT9JXEWp1LEmS7mUvMPb9XpoRdw8yNfPri8dAINPu2wNro9LpQ5
 pNxA==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Rob Clark <robdclark@chromium.org>, David Airlie <airlied@linux.ie>,
 open list <linux-kernel@vger.kernel.org>,
 dri-devel <dri-devel@lists.freedesktop.org>, Sean Paul <seanpaul@chromium.org>,
 Sean Paul <sean@poorly.run>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SGkgUm9iLAoKTWlzc2F0Z2UgZGUgUm9iIENsYXJrIDxyb2JkY2xhcmtAZ21haWwuY29tPiBkZWwg
ZGlhIGRsLiwgNCBkZSBub3YuCjIwMTkgYSBsZXMgMTg6NDI6Cj4KPiBGcm9tOiBSb2IgQ2xhcmsg
PHJvYmRjbGFya0BjaHJvbWl1bS5vcmc+Cj4KPiBUaGUgbmV3IHN0YXRlIHNob3VsZCBub3QgYmUg
YWNjZXNzZWQgYWZ0ZXIgdGhpcyBwb2ludC4gIENsZWFyIHRoZQo+IHBvaW50ZXJzIHRvIG1ha2Ug
dGhhdCBleHBsaWNpdC4KPgo+IFNpZ25lZC1vZmYtYnk6IFJvYiBDbGFyayA8cm9iZGNsYXJrQGNo
cm9taXVtLm9yZz4KCldoaWxlIGxvb2tpbmcgdG8gYW5vdGhlciBpc3N1ZSBJIGFwcGxpZWQgdGhp
cyBwYXRjaCBvbiB0b3Agb2YgNS40LXJjNwphbmQgbXkgZGlzcGxheSBzdG9wcGVkIHdvcmtpbmcu
IFRoZSBzeXN0ZW0gZ2V0cyBzdHVjayB3aXRoIHRoZQptZXNzYWdlcyBiZWxvdwoKLi4uClsgICAx
Ny41NTg2ODldIHJvY2tjaGlwLXZvcCBmZjhmMDAwMC52b3A6IEFkZGluZyB0byBpb21tdSBncm91
cCAxClsgICAxNy41NjYwMTRdIHJrMzM5OS1ncnUtc291bmQgc291bmQ6IEFTb0M6IGZhaWxlZCB0
byBpbml0IGxpbmsgRFA6IC01MTcKWyAgIDE3LjU2NzYxOF0gcm9ja2NoaXAtdm9wIGZmOTAwMDAw
LnZvcDogQWRkaW5nIHRvIGlvbW11IGdyb3VwIDIKWyAgIDE3LjU4MDY3MV0gcmszMzk5LWdydS1z
b3VuZCBzb3VuZDogQVNvQzogZmFpbGVkIHRvIGluaXQgbGluayBEUDogLTUxNwpbICAgMTcuNTg1
OTk2XSByb2NrY2hpcC1kcm0gZGlzcGxheS1zdWJzeXN0ZW06IGJvdW5kIGZmOGYwMDAwLnZvcCAo
b3BzCnZvcF9jb21wb25lbnRfb3BzIFtyb2NrY2hpcGRybV0pClsgICAxNy41ODkyOTRdIHJrMzM5
OS1ncnUtc291bmQgc291bmQ6IEFTb0M6IGZhaWxlZCB0byBpbml0IGxpbmsgRFA6IC01MTcKWyAg
IDE3LjU5OTg5OV0gcm9ja2NoaXAtZHJtIGRpc3BsYXktc3Vic3lzdGVtOiBib3VuZCBmZjkwMDAw
MC52b3AgKG9wcwp2b3BfY29tcG9uZW50X29wcyBbcm9ja2NoaXBkcm1dKQpbICAgMTcuNjE1ODQ2
XSByb2NrY2hpcC1kcCBmZjk3MDAwMC5lZHA6IG5vIERQIHBoeSBjb25maWd1cmVkClsgICAxNy42
MjI0OTVdIHJvY2tjaGlwLWRybSBkaXNwbGF5LXN1YnN5c3RlbTogYm91bmQgZmY5NzAwMDAuZWRw
IChvcHMKcm9ja2NoaXBfZHBfY29tcG9uZW50X29wcyBbcm9ja2NoaXBkcm1dKQpbICAgMTcuNjMz
Njg4XSByb2NrY2hpcC1kcm0gZGlzcGxheS1zdWJzeXN0ZW06IGJvdW5kIGZlYzAwMDAwLmRwIChv
cHMKY2RuX2RwX2NvbXBvbmVudF9vcHMgW3JvY2tjaGlwZHJtXSkKWyAgIDE3LjY0NDE0MV0gW2Ry
bV0gU3VwcG9ydHMgdmJsYW5rIHRpbWVzdGFtcCBjYWNoaW5nIFJldiAyICgyMS4xMC4yMDEzKS4K
WyAgIDE3LjY1MTU0OF0gW2RybV0gTm8gZHJpdmVyIHN1cHBvcnQgZm9yIHZibGFuayB0aW1lc3Rh
bXAgcXVlcnkuCgpOb3QgcmVhbGx5IHVzZWZ1bCBpbmZvcm1hdGlvbiBhdCB0aGlzIHBvaW50LCBi
dXQgSSBhbSB3b25kZXJpbmcgaWYKY291bGQgYmUgdGhhdCB0aGUgcm9ja2NoaXAgZHJpdmVyIGlz
IGRvaW5nIHNvbWV0aGluZyB3cm9uZyBtb3JlIHRoYW4KdGhpcyBwYXRjaCBpcyB3cm9uZz8KClRo
YW5rcywKIEVucmljCgo+IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vZHJtX2F0b21pY19oZWxwZXIu
YyB8IDMwICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrCj4gIDEgZmlsZSBjaGFuZ2VkLCAz
MCBpbnNlcnRpb25zKCspCj4KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2RybV9hdG9t
aWNfaGVscGVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX2F0b21pY19oZWxwZXIuYwo+IGluZGV4
IDY0ODQ5NGM4MTNlNS4uYWVjOTc1OWQ5ZGYyIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9kcm1fYXRvbWljX2hlbHBlci5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2RybV9hdG9taWNf
aGVscGVyLmMKPiBAQCAtMjI0NiwxMiArMjI0Niw0MiBAQCBFWFBPUlRfU1lNQk9MKGRybV9hdG9t
aWNfaGVscGVyX2Zha2VfdmJsYW5rKTsKPiAgICovCj4gIHZvaWQgZHJtX2F0b21pY19oZWxwZXJf
Y29tbWl0X2h3X2RvbmUoc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKm9sZF9zdGF0ZSkKPiAgewo+
ICsgICAgICAgc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcjsKPiArICAgICAgIHN0cnVj
dCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSwgKm5ld19jb25uX3N0YXRlOwo+
ICAgICAgICAgc3RydWN0IGRybV9jcnRjICpjcnRjOwo+ICAgICAgICAgc3RydWN0IGRybV9jcnRj
X3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwgKm5ld19jcnRjX3N0YXRlOwo+ICsgICAgICAgc3RydWN0
IGRybV9wbGFuZSAqcGxhbmU7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpvbGRf
cGxhbmVfc3RhdGUsICpuZXdfcGxhbmVfc3RhdGU7Cj4gICAgICAgICBzdHJ1Y3QgZHJtX2NydGNf
Y29tbWl0ICpjb21taXQ7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX3ByaXZhdGVfb2JqICpvYmo7Cj4g
KyAgICAgICBzdHJ1Y3QgZHJtX3ByaXZhdGVfc3RhdGUgKm9sZF9vYmpfc3RhdGUsICpuZXdfb2Jq
X3N0YXRlOwo+ICAgICAgICAgaW50IGk7Cj4KPiArICAgICAgIC8qCj4gKyAgICAgICAgKiBBZnRl
ciB0aGlzIHBvaW50LCBkcml2ZXJzIHNob3VsZCBub3QgYWNjZXNzIHRoZSBwZXJtYW5lbnQgbW9k
ZXNldAo+ICsgICAgICAgICogc3RhdGUsIHNvIHdlIGFsc28gY2xlYXIgdGhlIG5ld19zdGF0ZSBw
b2ludGVycyB0byBtYWtlIHRoaXMKPiArICAgICAgICAqIHJlc3RyaWN0aW9uIGV4cGxpY2l0Lgo+
ICsgICAgICAgICoKPiArICAgICAgICAqIEZvciB0aGUgQ1JUQyBzdGF0ZSwgd2UgZG8gdGhpcyBp
biB0aGUgc2FtZSBsb29wIHdoZXJlIHdlIHNpZ25hbAo+ICsgICAgICAgICogaHdfZG9uZSwgc2lu
Y2Ugd2Ugc3RpbGwgbmVlZCB0byBuZXdfY3J0Y19zdGF0ZSB0byBmaXNoIG91dCB0aGUKPiArICAg
ICAgICAqIGNvbW1pdC4KPiArICAgICAgICAqLwo+ICsKPiArICAgICAgIGZvcl9lYWNoX29sZG5l
d19jb25uZWN0b3JfaW5fc3RhdGUob2xkX3N0YXRlLCBjb25uZWN0b3IsIG9sZF9jb25uX3N0YXRl
LCBuZXdfY29ubl9zdGF0ZSwgaSkgewo+ICsgICAgICAgICAgICAgICBvbGRfc3RhdGUtPmNvbm5l
Y3RvcnNbaV0ubmV3X3N0YXRlID0gTlVMTDsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICBmb3Jf
ZWFjaF9vbGRuZXdfcGxhbmVfaW5fc3RhdGUob2xkX3N0YXRlLCBwbGFuZSwgb2xkX3BsYW5lX3N0
YXRlLCBuZXdfcGxhbmVfc3RhdGUsIGkpIHsKPiArICAgICAgICAgICAgICAgb2xkX3N0YXRlLT5w
bGFuZXNbaV0ubmV3X3N0YXRlID0gTlVMTDsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICBmb3Jf
ZWFjaF9vbGRuZXdfcHJpdmF0ZV9vYmpfaW5fc3RhdGUob2xkX3N0YXRlLCBvYmosIG9sZF9vYmpf
c3RhdGUsIG5ld19vYmpfc3RhdGUsIGkpIHsKPiArICAgICAgICAgICAgICAgb2xkX3N0YXRlLT5w
cml2YXRlX29ianNbaV0ubmV3X3N0YXRlID0gTlVMTDsKPiArICAgICAgIH0KPiArCj4gICAgICAg
ICBmb3JfZWFjaF9vbGRuZXdfY3J0Y19pbl9zdGF0ZShvbGRfc3RhdGUsIGNydGMsIG9sZF9jcnRj
X3N0YXRlLCBuZXdfY3J0Y19zdGF0ZSwgaSkgewo+ICsgICAgICAgICAgICAgICBvbGRfc3RhdGUt
PmNydGNzW2ldLm5ld19zdGF0ZSA9IE5VTEw7Cj4gKwo+ICAgICAgICAgICAgICAgICBjb21taXQg
PSBuZXdfY3J0Y19zdGF0ZS0+Y29tbWl0Owo+ICAgICAgICAgICAgICAgICBpZiAoIWNvbW1pdCkK
PiAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKPiAtLQo+IDIuMjMuMAo+Cj4gX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KPiBkcmktZGV2ZWwg
bWFpbGluZyBsaXN0Cj4gZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwo+IGh0dHBzOi8v
bGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVsCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5n
IGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVk
ZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
