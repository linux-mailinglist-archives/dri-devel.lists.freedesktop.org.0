Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 27D1610F97B
	for <lists+dri-devel@lfdr.de>; Tue,  3 Dec 2019 09:06:01 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 60F7A6E423;
	Tue,  3 Dec 2019 08:05:33 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
X-Greylist: delayed 336 seconds by postgrey-1.36 at gabe;
 Mon, 02 Dec 2019 13:54:34 UTC
Received: from a27-56.smtp-out.us-west-2.amazonses.com
 (a27-56.smtp-out.us-west-2.amazonses.com [54.240.27.56])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 797EF6E1DE;
 Mon,  2 Dec 2019 13:54:34 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on
 aws-us-west-2-caf-mail-1.web.codeaurora.org
X-Spam-Level: 
X-Spam-Status: No, score=-1.0 required=2.0 tests=ALL_TRUSTED,SPF_NONE,
 URIBL_BLOCKED autolearn=unavailable autolearn_force=no version=3.4.0
DMARC-Filter: OpenDMARC Filter v1.3.2 smtp.codeaurora.org 9B7B8C41635
From: Chandan Uddaraju <chandanu@codeaurora.org>
To: freedreno@lists.freedesktop.org, linux-arm-msm@vger.kernel.org,
 devicetree@vger.kernel.org, seanpaul@chromium.org
Subject: [DPU PATCH v3 3/5] drm/msm/dp: add displayPort driver support
Date: Mon, 2 Dec 2019 13:48:57 +0000
Message-ID: <0101016ec6df0e54-2af1f4a6-8f72-4799-89e0-0ff87b514eb2-000000@us-west-2.amazonses.com>
X-Mailer: git-send-email 1.9.1
In-Reply-To: <1575294437-6129-1-git-send-email-chandanu@codeaurora.org>
References: <1575294437-6129-1-git-send-email-chandanu@codeaurora.org>
X-SES-Outgoing: 2019.12.02-54.240.27.56
Feedback-ID: 1.us-west-2.CZuq2qbDmUIuT3qdvXlRHZZCpfZqZ4GtG9v3VKgRyF0=:AmazonSES
X-Mailman-Approved-At: Tue, 03 Dec 2019 08:05:18 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/simple; 
 s=zsmsymrwgfyinv5wlfyidntwsjeeldzt; d=codeaurora.org; t=1575294537;
 h=From:To:Cc:Subject:Date:Message-Id:In-Reply-To:References;
 bh=QujDmcEjWJVo+fUaGhCedDttf04qNgqiwp4FUzKIr1o=;
 b=OnYcyUqvLd029fUjjTpDQMIJH0ioO1vm9YEnzuoq4oe4sjF+d8lOr1qQdgtGwvC5
 bWkfNjYZlTMQLVJ0AgvUqvdfag1ZARt+6uJ6w2gTKZHWdQOrTl6nZSGEQduRrRSJ1Ew
 vxkJf8WmrtxjrVd3vQ1JfQWcZvfOiXMWFaQoBZBA=
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/simple; 
 s=gdwg2y3kokkkj5a55z2ilkup5wp5hhxx; d=amazonses.com; t=1575294537;
 h=From:To:Cc:Subject:Date:Message-Id:In-Reply-To:References:Feedback-ID;
 bh=QujDmcEjWJVo+fUaGhCedDttf04qNgqiwp4FUzKIr1o=;
 b=Eazi72vSBFtDZYxlJ1+tTH8de73nGxyq3hophl5DfV0ABDpj1c/rkJ/scxYuotbz
 8nGDLS2VsncLO7pu3/ZlhyuvCG0PTSZwmvQJpiZ72WbOWz4lz2d2Prq0aAkXRS37+08
 DCiuzB2xMUcLA67FDMJQH5uo6IwjBLl+EX7G9IKc=
X-Mailman-Original-Authentication-Results: aws-us-west-2-caf-mail-1.web.codeaurora.org;
 dmarc=none (p=none dis=none) header.from=codeaurora.org
X-Mailman-Original-Authentication-Results: aws-us-west-2-caf-mail-1.web.codeaurora.org;
 spf=none smtp.mailfrom=chandanu@codeaurora.org
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: abhinavk@codeaurora.org, hoegsberg@google.com,
 dri-devel@lists.freedesktop.org, Chandan Uddaraju <chandanu@codeaurora.org>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIHRoZSBuZWVkZWQgZGlzcGxheVBvcnQgZmlsZXMgdG8gZW5hYmxlIERQIGRyaXZlcgpvbiBt
c20gdGFyZ2V0LgoKImRwX2Rpc3BsYXkiIG1vZHVsZSBpcyB0aGUgbWFpbiBtb2R1bGUgdGhhdCBj
YWxscyBpbnRvCm90aGVyIHN1Yi1tb2R1bGVzLiAiZHBfZHJtIiBmaWxlIHJlcHJlc2VudHMgdGhl
IGludGVyZmFjZQpiZXR3ZWVuIERSTSBmcmFtZXdvcmsgYW5kIERQIGRyaXZlci4KCmNoYW5nZXMg
aW4gdjI6Ci0tIFVwZGF0ZSBjb3B5cmlnaHQgbWFya2luZ3Mgb24gYWxsIHJlbGV2YW50IGZpbGVz
LgotLSBDaGFuZ2UgcHJfZXJyKCkgdG8gRFJNX0VSUk9SKCkKLS0gVXNlIEFQSXMgZGlyZWN0bHkg
aW5zdGVhZCBvZiBmdW5jdGlvbiBwb2ludGVycy4KLS0gVXNlIGRybV9kaXNwbGF5X21vZGUgc3Ry
dWN0dXJlIHRvIHN0b3JlIGxpbmsgcGFyYW1ldGVycyBpbiB0aGUgZHJpdmVyLgotLSBVc2UgbWFj
cm9zIGZvciByZWdpc3RlciBkZWZpbml0aW9ucyBpbnN0ZWFkIG9mIGhhcmRjb2RlZCB2YWx1ZXMu
Ci0tIFJlcGxhY2Ugd3JpdGVsX3JlbGF4ZWQvcmVhZGxfcmVsYXhlZCB3aXRoIHdyaXRlbC9yZWFk
bAogICBhbmQgcmVtb3ZlIG1lbW9yeSBiYXJyaWVycy4KLS0gUmVtb3ZlIHVubmVjZXNzYXJ5IE5V
TEwgY2hlY2tzLgotLSBVc2UgZHJtIGhlbHBlciBmdW5jdGlvbnMgZm9yIGRwY2QgcmVhZC93cml0
ZS4KLS0gVXNlIERSTV9ERUJVR19EUCBmb3IgZGVidWcgbXNncy4KCmNoYW5nZXMgaW4gVjM6Ci0t
IFJlbW92ZWQgY2hhbmdlcyBpbiBkcHVfaW9fdXRpbC5bY2hdCi0tIEFkZGVkIGxvY2tpbmcgYXJv
dW5kICJpc19jb25uZWN0ZWQiIGZsYWcgYW5kIHJlbW92ZWQgYXRvbWljX3NldCgpCi0tIFJlbW92
ZWQgdGhlIGFyZ3VtZW50IHZhbGlkYXRpb24gY2hlY2tzIGluIGFsbCB0aGUgc3RhdGljIGZ1bmN0
aW9ucwogICBleGNlcHQgaW5pdGlhbGl6YXRpb24gZnVuY3Rpb25zIGFuZCBmZXcgQVBJIGNhbGxz
IGFjcm9zcyBtc20vZHAgZmlsZXMKLS0gUmVtb3ZlZCBoYXJkY29kZWQgdmFsdWVzIGZvciByZWdp
c3RlciByZWFkcy93cml0ZXMKLS0gUmVtb3ZlZCB2cmVnIHJlbGF0ZWQgZ2VuZXJpYyBzdHJ1Y3R1
cmVzLgotLSBBZGRlZCByZXR1cm4gdmFsdWVzIHdoZXJlIGV2ZXIgbmVjZXNzYXJ5LgotLSBVcGRh
dGVkIGRwX2N0cmxfb24gZnVuY3Rpb24uCi0tIENhbGxpbmcgdGhlIGN0cmwgc3BlY2lmaWMgY2F0
YWxvZyBmdW5jdGlvbnMgZGlyZWN0bHkgaW5zdGVhZCBvZgogICBmdW5jdGlvbiBwb2ludGVycy4K
LS0gQWRkZWQgc2VwZXJhdGUgY2hhbmdlIHRoYXQgYWRkcyBzdGFuZGFyZCB2YWx1ZSBpbiBkcm1f
ZHBfaGVscGVyIGZpbGUuCi0tIEFkZGVkIHNlcGFyYXRlIGNoYW5nZSBpbiB0aGlzIGxpc3QgdGhh
dCBpcyB1c2VkIHRvIGluaXRpYWxpemUKICAgZGlzcGxheXBvcnQgaW4gRFBVIGRyaXZlci4KLS0g
QWRkZWQgY2hhbmdlIHRvIHVzZSBkcm1fZHBfZ2V0X2FkanVzdF9yZXF1ZXN0X3ZvbHRhZ2UoKSBm
dW5jdGlvbi4KClNpZ25lZC1vZmYtYnk6IENoYW5kYW4gVWRkYXJhanUgPGNoYW5kYW51QGNvZGVh
dXJvcmEub3JnPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9tc20vS2NvbmZpZyAgICAgICAgICAgICAg
ICAgfCAgICA5ICsKIGRyaXZlcnMvZ3B1L2RybS9tc20vTWFrZWZpbGUgICAgICAgICAgICAgICAg
fCAgIDEzICsKIGRyaXZlcnMvZ3B1L2RybS9tc20vZGlzcC9kcHUxL2RwdV9lbmNvZGVyLmMgfCAg
IDIwICsKIGRyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfYXV4LmMgICAgICAgICAgICAgfCAgNTQ4
ICsrKysrKysrKwogZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9hdXguaCAgICAgICAgICAgICB8
ICAgMzcgKwogZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9jYXRhbG9nLmMgICAgICAgICB8ICA4
NDEgKysrKysrKysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfY2F0YWxvZy5oICAg
ICAgICAgfCAgIDg0ICsrCiBkcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX2N0cmwuYyAgICAgICAg
ICAgIHwgMTU5MCArKysrKysrKysrKysrKysrKysrKysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9t
c20vZHAvZHBfY3RybC5oICAgICAgICAgICAgfCAgIDM0ICsKIGRyaXZlcnMvZ3B1L2RybS9tc20v
ZHAvZHBfZGlzcGxheS5jICAgICAgICAgfCAgOTQ5ICsrKysrKysrKysrKysrKysKIGRyaXZlcnMv
Z3B1L2RybS9tc20vZHAvZHBfZGlzcGxheS5oICAgICAgICAgfCAgIDI5ICsKIGRyaXZlcnMvZ3B1
L2RybS9tc20vZHAvZHBfZHJtLmMgICAgICAgICAgICAgfCAgMTczICsrKwogZHJpdmVycy9ncHUv
ZHJtL21zbS9kcC9kcF9kcm0uaCAgICAgICAgICAgICB8ICAgMjAgKwogZHJpdmVycy9ncHUvZHJt
L21zbS9kcC9kcF9leHRjb24uYyAgICAgICAgICB8ICAyMTYgKysrKwogZHJpdmVycy9ncHUvZHJt
L21zbS9kcC9kcF9leHRjb24uaCAgICAgICAgICB8ICAgODQgKysKIGRyaXZlcnMvZ3B1L2RybS9t
c20vZHAvZHBfbGluay5jICAgICAgICAgICAgfCAxMTg1ICsrKysrKysrKysrKysrKysrKysrCiBk
cml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX2xpbmsuaCAgICAgICAgICAgIHwgIDEzMiArKysKIGRy
aXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfcGFuZWwuYyAgICAgICAgICAgfCAgNDUwICsrKysrKysr
CiBkcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX3BhbmVsLmggICAgICAgICAgIHwgICA5MiArKwog
ZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9wYXJzZXIuYyAgICAgICAgICB8ICA0OTYgKysrKysr
KysrCiBkcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX3BhcnNlci5oICAgICAgICAgIHwgIDIyMiAr
KysrCiBkcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX3Bvd2VyLmMgICAgICAgICAgIHwgIDU1OCAr
KysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX3Bvd2VyLmggICAgICAgICAgIHwg
ICA1MiArCiBkcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX3JlZy5oICAgICAgICAgICAgIHwgIDQ4
OCArKysrKysrKwogZHJpdmVycy9ncHUvZHJtL21zbS9tc21fZHJ2LmMgICAgICAgICAgICAgICB8
ICAgIDIgKwogZHJpdmVycy9ncHUvZHJtL21zbS9tc21fZHJ2LmggICAgICAgICAgICAgICB8ICAg
NDIgKwogMjYgZmlsZXMgY2hhbmdlZCwgODM2NiBpbnNlcnRpb25zKCspCiBjcmVhdGUgbW9kZSAx
MDA2NDQgZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9hdXguYwogY3JlYXRlIG1vZGUgMTAwNjQ0
IGRyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfYXV4LmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2
ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX2NhdGFsb2cuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZl
cnMvZ3B1L2RybS9tc20vZHAvZHBfY2F0YWxvZy5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVy
cy9ncHUvZHJtL21zbS9kcC9kcF9jdHJsLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dw
dS9kcm0vbXNtL2RwL2RwX2N0cmwuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2Ry
bS9tc20vZHAvZHBfZGlzcGxheS5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJt
L21zbS9kcC9kcF9kaXNwbGF5LmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0v
bXNtL2RwL2RwX2RybS5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL21zbS9k
cC9kcF9kcm0uaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBf
ZXh0Y29uLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX2V4
dGNvbi5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9saW5r
LmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX2xpbmsuaAog
Y3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfcGFuZWwuYwogY3Jl
YXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfcGFuZWwuaAogY3JlYXRl
IG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfcGFyc2VyLmMKIGNyZWF0ZSBt
b2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX3BhcnNlci5oCiBjcmVhdGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9wb3dlci5jCiBjcmVhdGUgbW9kZSAx
MDA2NDQgZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9wb3dlci5oCiBjcmVhdGUgbW9kZSAxMDA2
NDQgZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9yZWcuaAoKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9tc20vS2NvbmZpZyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vS2NvbmZpZwppbmRleCA2
ZGVhYTdkLi43OTQ2Y2IxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbXNtL0tjb25maWcK
KysrIGIvZHJpdmVycy9ncHUvZHJtL21zbS9LY29uZmlnCkBAIC01Nyw2ICs1NywxNSBAQCBjb25m
aWcgRFJNX01TTV9IRE1JX0hEQ1AKIAloZWxwCiAJICBDaG9vc2UgdGhpcyBvcHRpb24gdG8gZW5h
YmxlIEhEQ1Agc3RhdGUgbWFjaGluZQogCitjb25maWcgRFJNX01TTV9EUAorCWJvb2wgIkVuYWJs
ZSBEUCBzdXBwb3J0IGluIE1TTSBEUk0gZHJpdmVyIgorCWRlcGVuZHMgb24gRFJNX01TTQorCWRl
ZmF1bHQgbgorCWhlbHAKKwkgIENvbXBpbGUgaW4gc3VwcG9ydCBmb3IgRFAgZHJpdmVyIGluIG1z
bSBkcm0gZHJpdmVyLiBEUCBleHRlcm5hbAorCSAgZGlzcGxheSBzdXBwb3J0IGlzIGVuYWJsZWQg
dGhyb3VnaCB0aGlzIGNvbmZpZyBvcHRpb24uIEl0IGNhbgorCSAgYmUgcHJpbWFyeSBvciBzZWNv
bmRhcnkgZGlzcGxheSBvbiBkZXZpY2UuCisKIGNvbmZpZyBEUk1fTVNNX0RTSQogCWJvb2wgIkVu
YWJsZSBEU0kgc3VwcG9ydCBpbiBNU00gRFJNIGRyaXZlciIKIAlkZXBlbmRzIG9uIERSTV9NU00K
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9tc20vTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9k
cm0vbXNtL01ha2VmaWxlCmluZGV4IDE1NzljZjAuLjU5MzlmNDEgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9tc20vTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL21zbS9NYWtlZmls
ZQpAQCAtMiw2ICsyLDcgQEAKIGNjZmxhZ3MteSA6PSAtSSAkKHNyY3RyZWUpLyQoc3JjKQogY2Nm
bGFncy15ICs9IC1JICQoc3JjdHJlZSkvJChzcmMpL2Rpc3AvZHB1MQogY2NmbGFncy0kKENPTkZJ
R19EUk1fTVNNX0RTSSkgKz0gLUkgJChzcmN0cmVlKS8kKHNyYykvZHNpCitjY2ZsYWdzLSQoQ09O
RklHX0RSTV9NU01fRFApICs9IC1JICQoc3JjdHJlZSkvJChzcmMpL2RwCiAKIG1zbS15IDo9IFwK
IAlhZHJlbm8vYWRyZW5vX2RldmljZS5vIFwKQEAgLTk2LDggKzk3LDIwIEBAIG1zbS15IDo9IFwK
IAogbXNtLSQoQ09ORklHX0RFQlVHX0ZTKSArPSBhZHJlbm8vYTV4eF9kZWJ1Z2ZzLm8KIAorCiBt
c20tJChDT05GSUdfRFJNX01TTV9HUFVfU1RBVEUpCSs9IGFkcmVuby9hNnh4X2dwdV9zdGF0ZS5v
CiAKK21zbS0kKENPTkZJR19EUk1fTVNNX0RQKSs9IGRwL2RwX2F1eC5vIFwKKwlkcC9kcF9jYXRh
bG9nLm8gXAorCWRwL2RwX2N0cmwubyBcCisJZHAvZHBfZGlzcGxheS5vIFwKKwlkcC9kcF9kcm0u
byBcCisJZHAvZHBfZXh0Y29uLm8gXAorCWRwL2RwX2xpbmsubyBcCisJZHAvZHBfcGFuZWwubyBc
CisJZHAvZHBfcGFyc2VyLm8gXAorCWRwL2RwX3Bvd2VyLm8KKwogbXNtLSQoQ09ORklHX0RSTV9G
QkRFVl9FTVVMQVRJT04pICs9IG1zbV9mYmRldi5vCiBtc20tJChDT05GSUdfQ09NTU9OX0NMSykg
Kz0gZGlzcC9tZHA0L21kcDRfbHZkc19wbGwubwogbXNtLSQoQ09ORklHX0NPTU1PTl9DTEspICs9
IGhkbWkvaGRtaV9wbGxfODk2MC5vCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbXNtL2Rp
c3AvZHB1MS9kcHVfZW5jb2Rlci5jIGIvZHJpdmVycy9ncHUvZHJtL21zbS9kaXNwL2RwdTEvZHB1
X2VuY29kZXIuYwppbmRleCBmOTZlMTQyLi4yOWFjN2QzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vbXNtL2Rpc3AvZHB1MS9kcHVfZW5jb2Rlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9t
c20vZGlzcC9kcHUxL2RwdV9lbmNvZGVyLmMKQEAgLTk2Nyw2ICs5NjcsOSBAQCBzdGF0aWMgdm9p
ZCBkcHVfZW5jb2Rlcl92aXJ0X21vZGVfc2V0KHN0cnVjdCBkcm1fZW5jb2RlciAqZHJtX2VuYywK
IAogCXRyYWNlX2RwdV9lbmNfbW9kZV9zZXQoRFJNSUQoZHJtX2VuYykpOwogCisJaWYgKGRybV9l
bmMtPmVuY29kZXJfdHlwZSA9PSBEUk1fTU9ERV9FTkNPREVSX1RNRFMgJiYgcHJpdi0+ZHApCisJ
CW1zbV9kcF9kaXNwbGF5X21vZGVfc2V0KHByaXYtPmRwLCBkcm1fZW5jLCBtb2RlLCBhZGpfbW9k
ZSk7CisKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5KGNvbm5faXRlciwgY29ubmVjdG9yX2xpc3QsIGhl
YWQpCiAJCWlmIChjb25uX2l0ZXItPmVuY29kZXIgPT0gZHJtX2VuYykKIAkJCWNvbm4gPSBjb25u
X2l0ZXI7CkBAIC0xMTMzLDYgKzExMzYsNyBAQCBzdGF0aWMgdm9pZCBkcHVfZW5jb2Rlcl92aXJ0
X2VuYWJsZShzdHJ1Y3QgZHJtX2VuY29kZXIgKmRybV9lbmMpCiB7CiAJc3RydWN0IGRwdV9lbmNv
ZGVyX3ZpcnQgKmRwdV9lbmMgPSBOVUxMOwogCWludCByZXQgPSAwOworCXN0cnVjdCBtc21fZHJt
X3ByaXZhdGUgKnByaXY7CiAJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmN1cl9tb2RlID0gTlVM
TDsKIAogCWlmICghZHJtX2VuYykgewpAQCAtMTE0Myw2ICsxMTQ3LDcgQEAgc3RhdGljIHZvaWQg
ZHB1X2VuY29kZXJfdmlydF9lbmFibGUoc3RydWN0IGRybV9lbmNvZGVyICpkcm1fZW5jKQogCiAJ
bXV0ZXhfbG9jaygmZHB1X2VuYy0+ZW5jX2xvY2spOwogCWN1cl9tb2RlID0gJmRwdV9lbmMtPmJh
c2UuY3J0Yy0+c3RhdGUtPmFkanVzdGVkX21vZGU7CisJcHJpdiA9IGRybV9lbmMtPmRldi0+ZGV2
X3ByaXZhdGU7CiAKIAl0cmFjZV9kcHVfZW5jX2VuYWJsZShEUk1JRChkcm1fZW5jKSwgY3VyX21v
ZGUtPmhkaXNwbGF5LAogCQkJICAgICBjdXJfbW9kZS0+dmRpc3BsYXkpOwpAQCAtMTE2Myw2ICsx
MTY4LDE1IEBAIHN0YXRpYyB2b2lkIGRwdV9lbmNvZGVyX3ZpcnRfZW5hYmxlKHN0cnVjdCBkcm1f
ZW5jb2RlciAqZHJtX2VuYykKIAogCV9kcHVfZW5jb2Rlcl92aXJ0X2VuYWJsZV9oZWxwZXIoZHJt
X2VuYyk7CiAKKwlpZiAoZHJtX2VuYy0+ZW5jb2Rlcl90eXBlID09IERSTV9NT0RFX0VOQ09ERVJf
VE1EUyAmJiBwcml2LT5kcCkgeworCQlyZXQgPSBtc21fZHBfZGlzcGxheV9lbmFibGUocHJpdi0+
ZHAsCisJCQkJCQlkcm1fZW5jKTsKKwkJaWYgKHJldCkgeworCQkJRFBVX0VSUk9SX0VOQyhkcHVf
ZW5jLCAiZHAgZGlzcGxheSBlbmFibGUgZmFpbGVkOiAlZFxuIiwKKwkJCQlyZXQpOworCQkJZ290
byBvdXQ7CisJCX0KKwl9CiAJZHB1X2VuYy0+ZW5hYmxlZCA9IHRydWU7CiAKIG91dDoKQEAgLTEx
OTMsNiArMTIwNywxMiBAQCBzdGF0aWMgdm9pZCBkcHVfZW5jb2Rlcl92aXJ0X2Rpc2FibGUoc3Ry
dWN0IGRybV9lbmNvZGVyICpkcm1fZW5jKQogCXByaXYgPSBkcm1fZW5jLT5kZXYtPmRldl9wcml2
YXRlOwogCWRwdV9rbXMgPSB0b19kcHVfa21zKHByaXYtPmttcyk7CiAKKwlpZiAoZHJtX2VuYy0+
ZW5jb2Rlcl90eXBlID09IERSTV9NT0RFX0VOQ09ERVJfVE1EUyAmJiBwcml2LT5kcCkgeworCQlp
ZiAobXNtX2RwX2Rpc3BsYXlfZGlzYWJsZShwcml2LT5kcCwgZHJtX2VuYykpIHsKKwkJCURQVV9F
UlJPUl9FTkMoZHB1X2VuYywgImRwIGRpc3BsYXkgZGlzYWJsZSBmYWlsZWRcbiIpOworCQkJcmV0
dXJuOworCQkgIH0KKwl9CiAJdHJhY2VfZHB1X2VuY19kaXNhYmxlKERSTUlEKGRybV9lbmMpKTsK
IAogCS8qIHdhaXQgZm9yIGlkbGUgKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9tc20v
ZHAvZHBfYXV4LmMgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX2F1eC5jCm5ldyBmaWxlIG1v
ZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLmE2YmI1MmEKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2
ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX2F1eC5jCkBAIC0wLDAgKzEsNTQ4IEBACisvLyBTUERYLUxp
Y2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5CisvKgorICogQ29weXJpZ2h0IChjKSAyMDEy
LTIwMTksIFRoZSBMaW51eCBGb3VuZGF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLgorICovCisK
KyNkZWZpbmUgcHJfZm10KGZtdCkJIltkcm0tZHBdICVzOiAiIGZtdCwgX19mdW5jX18KKworI2lu
Y2x1ZGUgPGxpbnV4L2RlbGF5Lmg+CisKKyNpbmNsdWRlICJkcF9yZWcuaCIKKyNpbmNsdWRlICJk
cF9hdXguaCIKKworI2RlZmluZSBEUF9BVVhfRU5VTV9TVFIoeCkJCSN4CisKK3N0cnVjdCBkcF9h
dXhfcHJpdmF0ZSB7CisJc3RydWN0IGRldmljZSAqZGV2OworCXN0cnVjdCBkcF9hdXggZHBfYXV4
OworCXN0cnVjdCBkcF9jYXRhbG9nICpjYXRhbG9nOworCisJc3RydWN0IG11dGV4IG11dGV4Owor
CXN0cnVjdCBjb21wbGV0aW9uIGNvbXA7CisKKwl1MzIgYXV4X2Vycm9yX251bTsKKwl1MzIgcmV0
cnlfY250OworCWJvb2wgY21kX2J1c3k7CisJYm9vbCBuYXRpdmU7CisJYm9vbCByZWFkOworCWJv
b2wgbm9fc2VuZF9hZGRyOworCWJvb2wgbm9fc2VuZF9zdG9wOworCXUzMiBvZmZzZXQ7CisJdTMy
IHNlZ21lbnQ7CisJdTMyIGlzcjsKKworCXN0cnVjdCBkcm1fZHBfYXV4IGRybV9hdXg7Cit9Owor
CitzdGF0aWMgY2hhciAqZHBfYXV4X2dldF9lcnJvcih1MzIgYXV4X2Vycm9yKQoreworCXN3aXRj
aCAoYXV4X2Vycm9yKSB7CisJY2FzZSBEUF9BVVhfRVJSX05PTkU6CisJCXJldHVybiBEUF9BVVhf
RU5VTV9TVFIoRFBfQVVYX0VSUl9OT05FKTsKKwljYXNlIERQX0FVWF9FUlJfQUREUjoKKwkJcmV0
dXJuIERQX0FVWF9FTlVNX1NUUihEUF9BVVhfRVJSX0FERFIpOworCWNhc2UgRFBfQVVYX0VSUl9U
T1VUOgorCQlyZXR1cm4gRFBfQVVYX0VOVU1fU1RSKERQX0FVWF9FUlJfVE9VVCk7CisJY2FzZSBE
UF9BVVhfRVJSX05BQ0s6CisJCXJldHVybiBEUF9BVVhfRU5VTV9TVFIoRFBfQVVYX0VSUl9OQUNL
KTsKKwljYXNlIERQX0FVWF9FUlJfREVGRVI6CisJCXJldHVybiBEUF9BVVhfRU5VTV9TVFIoRFBf
QVVYX0VSUl9ERUZFUik7CisJY2FzZSBEUF9BVVhfRVJSX05BQ0tfREVGRVI6CisJCXJldHVybiBE
UF9BVVhfRU5VTV9TVFIoRFBfQVVYX0VSUl9OQUNLX0RFRkVSKTsKKwlkZWZhdWx0OgorCQlyZXR1
cm4gInVua25vd24iOworCX0KK30KKworc3RhdGljIHUzMiBkcF9hdXhfd3JpdGUoc3RydWN0IGRw
X2F1eF9wcml2YXRlICphdXgsCisJCQlzdHJ1Y3QgZHJtX2RwX2F1eF9tc2cgKm1zZykKK3sKKwl1
MzIgZGF0YVs0XSwgcmVnLCBsZW47CisJdTggKm1zZ2RhdGEgPSBtc2ctPmJ1ZmZlcjsKKwlpbnQg
Y29uc3QgYXV4X2NtZF9maWZvX2xlbiA9IDEyODsKKwlpbnQgaSA9IDA7CisKKwlpZiAoYXV4LT5y
ZWFkKQorCQlsZW4gPSA0OworCWVsc2UKKwkJbGVuID0gbXNnLT5zaXplICsgNDsKKworCS8qCisJ
ICogY21kIGZpZm8gb25seSBoYXMgZGVwdGggb2YgMTQ0IGJ5dGVzCisJICogbGltaXQgYnVmIGxl
bmd0aCB0byAxMjggYnl0ZXMgaGVyZQorCSAqLworCWlmIChsZW4gPiBhdXhfY21kX2ZpZm9fbGVu
KSB7CisJCURSTV9FUlJPUigiYnVmIGxlbiBlcnJvclxuIik7CisJCXJldHVybiAwOworCX0KKwor
CS8qIFBhY2sgY21kIGFuZCB3cml0ZSB0byBIVyAqLworCWRhdGFbMF0gPSAobXNnLT5hZGRyZXNz
ID4+IDE2KSAmIDB4ZjsgLyogYWRkclsxOToxNl0gKi8KKwlpZiAoYXV4LT5yZWFkKQorCQlkYXRh
WzBdIHw9ICBCSVQoNCk7IC8qIFIvVyAqLworCisJZGF0YVsxXSA9IChtc2ctPmFkZHJlc3MgPj4g
OCkgJiAweGZmOwkvKiBhZGRyWzE1OjhdICovCisJZGF0YVsyXSA9IG1zZy0+YWRkcmVzcyAmIDB4
ZmY7CQkvKiBhZGRyWzc6MF0gKi8KKwlkYXRhWzNdID0gKG1zZy0+c2l6ZSAtIDEpICYgMHhmZjsJ
LyogbGVuWzc6MF0gKi8KKworCWZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykgeworCQlyZWcgPSAo
aSA8IDQpID8gZGF0YVtpXSA6IG1zZ2RhdGFbaSAtIDRdOworCQkvKiBpbmRleCA9IDAsIHdyaXRl
ICovCisJCXJlZyA9ICgoKHJlZykgPDwgRFBfQVVYX0RBVEFfT0ZGU0VUKQorCQkgICAgICAgJiBE
UF9BVVhfREFUQV9NQVNLKSB8IERQX0FVWF9EQVRBX1dSSVRFOworCQlpZiAoaSA9PSAwKQorCQkJ
cmVnIHw9IERQX0FVWF9EQVRBX0lOREVYX1dSSVRFOworCQlhdXgtPmNhdGFsb2ctPmF1eF9kYXRh
ID0gcmVnOworCQlkcF9jYXRhbG9nX2F1eF93cml0ZV9kYXRhKGF1eC0+Y2F0YWxvZyk7CisJfQor
CisJZHBfY2F0YWxvZ19hdXhfY2xlYXJfdHJhbnMoYXV4LT5jYXRhbG9nLCBmYWxzZSk7CisKKwly
ZWcgPSAwOyAvKiBUcmFuc2FjdGlvbiBudW1iZXIgPT0gMSAqLworCWlmICghYXV4LT5uYXRpdmUp
IHsgLyogaTJjICovCisJCXJlZyB8PSBEUF9BVVhfVFJBTlNfQ1RSTF9JMkM7CisKKwkJaWYgKGF1
eC0+bm9fc2VuZF9hZGRyKQorCQkJcmVnIHw9IERQX0FVWF9UUkFOU19DVFJMX05PX1NFTkRfQURE
UjsKKworCQlpZiAoYXV4LT5ub19zZW5kX3N0b3ApCisJCQlyZWcgfD0gRFBfQVVYX1RSQU5TX0NU
UkxfTk9fU0VORF9TVE9QOworCX0KKworCXJlZyB8PSBEUF9BVVhfVFJBTlNfQ1RSTF9HTzsKKwlh
dXgtPmNhdGFsb2ctPmF1eF9kYXRhID0gcmVnOworCWRwX2NhdGFsb2dfYXV4X3dyaXRlX3RyYW5z
KGF1eC0+Y2F0YWxvZyk7CisKKwlyZXR1cm4gbGVuOworfQorCitzdGF0aWMgaW50IGRwX2F1eF9j
bWRfZmlmb190eChzdHJ1Y3QgZHBfYXV4X3ByaXZhdGUgKmF1eCwKKwkJCSAgICAgIHN0cnVjdCBk
cm1fZHBfYXV4X21zZyAqbXNnKQoreworCXUzMiByZXQgPSAwLCBsZW4gPSAwLCB0aW1lb3V0Owor
CWludCBjb25zdCBhdXhfdGltZW91dF9tcyA9IEhaLzQ7CisKKwlyZWluaXRfY29tcGxldGlvbigm
YXV4LT5jb21wKTsKKworCWxlbiA9IGRwX2F1eF93cml0ZShhdXgsIG1zZyk7CisJaWYgKGxlbiA9
PSAwKSB7CisJCURSTV9FUlJPUigiRFAgQVVYIHdyaXRlIGZhaWxlZFxuIik7CisJCXJldHVybiAt
RUlOVkFMOworCX0KKworCXRpbWVvdXQgPSB3YWl0X2Zvcl9jb21wbGV0aW9uX3RpbWVvdXQoJmF1
eC0+Y29tcCwgYXV4X3RpbWVvdXRfbXMpOworCWlmICghdGltZW91dCkgeworCQlEUk1fRVJST1Io
ImF1eCAlcyB0aW1lb3V0XG4iLCAoYXV4LT5yZWFkID8gInJlYWQiIDogIndyaXRlIikpOworCQly
ZXR1cm4gLUVUSU1FRE9VVDsKKwl9CisKKwlpZiAoYXV4LT5hdXhfZXJyb3JfbnVtID09IERQX0FV
WF9FUlJfTk9ORSkgeworCQlyZXQgPSBsZW47CisJfSBlbHNlIHsKKwkJRFJNX0VSUk9SX1JBVEVM
SU1JVEVEKCJhdXggZXJyOiAlc1xuIiwKKwkJCWRwX2F1eF9nZXRfZXJyb3IoYXV4LT5hdXhfZXJy
b3JfbnVtKSk7CisKKwkJcmV0ID0gLUVJTlZBTDsKKwl9CisKKwlyZXR1cm4gcmV0OworfQorCitz
dGF0aWMgdm9pZCBkcF9hdXhfY21kX2ZpZm9fcngoc3RydWN0IGRwX2F1eF9wcml2YXRlICphdXgs
CisJCXN0cnVjdCBkcm1fZHBfYXV4X21zZyAqbXNnKQoreworCXUzMiBkYXRhOworCXU4ICpkcDsK
Kwl1MzIgaSwgYWN0dWFsX2k7CisJdTMyIGxlbiA9IG1zZy0+c2l6ZTsKKworCWRwX2NhdGFsb2df
YXV4X2NsZWFyX3RyYW5zKGF1eC0+Y2F0YWxvZywgdHJ1ZSk7CisKKwlkYXRhID0gMDsKKwlkYXRh
IHw9IERQX0FVWF9EQVRBX0lOREVYX1dSSVRFOyAvKiBJTkRFWF9XUklURSAqLworCWRhdGEgfD0g
RFBfQVVYX0RBVEFfUkVBRDsgIC8qIHJlYWQgKi8KKworCWF1eC0+Y2F0YWxvZy0+YXV4X2RhdGEg
PSBkYXRhOworCWRwX2NhdGFsb2dfYXV4X3dyaXRlX2RhdGEoYXV4LT5jYXRhbG9nKTsKKworCWRw
ID0gbXNnLT5idWZmZXI7CisKKwkvKiBkaXNjYXJkIGZpcnN0IGJ5dGUgKi8KKwlkYXRhID0gZHBf
Y2F0YWxvZ19hdXhfcmVhZF9kYXRhKGF1eC0+Y2F0YWxvZyk7CisKKwlmb3IgKGkgPSAwOyBpIDwg
bGVuOyBpKyspIHsKKwkJZGF0YSA9IGRwX2NhdGFsb2dfYXV4X3JlYWRfZGF0YShhdXgtPmNhdGFs
b2cpOworCQkqZHArKyA9ICh1OCkoKGRhdGEgPj4gRFBfQVVYX0RBVEFfT0ZGU0VUKSAmIDB4ZmYp
OworCisJCWFjdHVhbF9pID0gKGRhdGEgPj4gRFBfQVVYX0RBVEFfSU5ERVhfT0ZGU0VUKSAmIDB4
RkY7CisJCWlmIChpICE9IGFjdHVhbF9pKQorCQkJcHJfd2FybigiSW5kZXggbWlzbWF0Y2g6IGV4
cGVjdGVkICVkLCBmb3VuZCAlZFxuIiwKKwkJCQlpLCBhY3R1YWxfaSk7CisJfQorfQorCitzdGF0
aWMgdm9pZCBkcF9hdXhfbmF0aXZlX2hhbmRsZXIoc3RydWN0IGRwX2F1eF9wcml2YXRlICphdXgp
Cit7CisJdTMyIGlzciA9IGF1eC0+aXNyOworCisJaWYgKGlzciAmIERQX0lOVFJfQVVYX0kyQ19E
T05FKQorCQlhdXgtPmF1eF9lcnJvcl9udW0gPSBEUF9BVVhfRVJSX05PTkU7CisJZWxzZSBpZiAo
aXNyICYgRFBfSU5UUl9XUk9OR19BRERSKQorCQlhdXgtPmF1eF9lcnJvcl9udW0gPSBEUF9BVVhf
RVJSX0FERFI7CisJZWxzZSBpZiAoaXNyICYgRFBfSU5UUl9USU1FT1VUKQorCQlhdXgtPmF1eF9l
cnJvcl9udW0gPSBEUF9BVVhfRVJSX1RPVVQ7CisJaWYgKGlzciAmIERQX0lOVFJfTkFDS19ERUZF
UikKKwkJYXV4LT5hdXhfZXJyb3JfbnVtID0gRFBfQVVYX0VSUl9OQUNLOworCisJY29tcGxldGUo
JmF1eC0+Y29tcCk7Cit9CisKK3N0YXRpYyB2b2lkIGRwX2F1eF9pMmNfaGFuZGxlcihzdHJ1Y3Qg
ZHBfYXV4X3ByaXZhdGUgKmF1eCkKK3sKKwl1MzIgaXNyID0gYXV4LT5pc3I7CisKKwlpZiAoaXNy
ICYgRFBfSU5UUl9BVVhfSTJDX0RPTkUpIHsKKwkJaWYgKGlzciAmIChEUF9JTlRSX0kyQ19OQUNL
IHwgRFBfSU5UUl9JMkNfREVGRVIpKQorCQkJYXV4LT5hdXhfZXJyb3JfbnVtID0gRFBfQVVYX0VS
Ul9OQUNLOworCQllbHNlCisJCQlhdXgtPmF1eF9lcnJvcl9udW0gPSBEUF9BVVhfRVJSX05PTkU7
CisJfSBlbHNlIHsKKwkJaWYgKGlzciAmIERQX0lOVFJfV1JPTkdfQUREUikKKwkJCWF1eC0+YXV4
X2Vycm9yX251bSA9IERQX0FVWF9FUlJfQUREUjsKKwkJZWxzZSBpZiAoaXNyICYgRFBfSU5UUl9U
SU1FT1VUKQorCQkJYXV4LT5hdXhfZXJyb3JfbnVtID0gRFBfQVVYX0VSUl9UT1VUOworCQlpZiAo
aXNyICYgRFBfSU5UUl9OQUNLX0RFRkVSKQorCQkJYXV4LT5hdXhfZXJyb3JfbnVtID0gRFBfQVVY
X0VSUl9OQUNLX0RFRkVSOworCQlpZiAoaXNyICYgRFBfSU5UUl9JMkNfTkFDSykKKwkJCWF1eC0+
YXV4X2Vycm9yX251bSA9IERQX0FVWF9FUlJfTkFDSzsKKwkJaWYgKGlzciAmIERQX0lOVFJfSTJD
X0RFRkVSKQorCQkJYXV4LT5hdXhfZXJyb3JfbnVtID0gRFBfQVVYX0VSUl9ERUZFUjsKKwl9CisK
Kwljb21wbGV0ZSgmYXV4LT5jb21wKTsKK30KKworc3RhdGljIHZvaWQgZHBfYXV4X3VwZGF0ZV9v
ZmZzZXRfYW5kX3NlZ21lbnQoc3RydWN0IGRwX2F1eF9wcml2YXRlICphdXgsCisJCQkJCSAgICAg
c3RydWN0IGRybV9kcF9hdXhfbXNnICppbnB1dF9tc2cpCit7CisJdTMyIGNvbnN0IGVkaWRfYWRk
cmVzcyA9IDB4NTA7CisJdTMyIGNvbnN0IHNlZ21lbnRfYWRkcmVzcyA9IDB4MzA7CisJYm9vbCBp
MmNfcmVhZCA9IGlucHV0X21zZy0+cmVxdWVzdCAmCisJCShEUF9BVVhfSTJDX1JFQUQgJiBEUF9B
VVhfTkFUSVZFX1JFQUQpOworCXU4ICpkYXRhID0gTlVMTDsKKworCWlmIChhdXgtPm5hdGl2ZSB8
fCBpMmNfcmVhZCB8fCAoKGlucHV0X21zZy0+YWRkcmVzcyAhPSBlZGlkX2FkZHJlc3MpICYmCisJ
CShpbnB1dF9tc2ctPmFkZHJlc3MgIT0gc2VnbWVudF9hZGRyZXNzKSkpCisJCXJldHVybjsKKwor
CisJZGF0YSA9IGlucHV0X21zZy0+YnVmZmVyOworCWlmIChpbnB1dF9tc2ctPmFkZHJlc3MgPT0g
c2VnbWVudF9hZGRyZXNzKQorCQlhdXgtPnNlZ21lbnQgPSAqZGF0YTsKKwllbHNlCisJCWF1eC0+
b2Zmc2V0ID0gKmRhdGE7Cit9CisKKy8qKgorICogZHBfYXV4X3RyYW5zZmVyX2hlbHBlcigpIC0g
aGVscGVyIGZ1bmN0aW9uIGZvciBFRElEIHJlYWQgdHJhbnNhY3Rpb25zCisgKgorICogQGF1eDog
RFAgQVVYIHByaXZhdGUgc3RydWN0dXJlCisgKiBAaW5wdXRfbXNnOiBpbnB1dCBtZXNzYWdlIGZy
b20gRFJNIHVwc3RyZWFtIEFQSXMKKyAqCisgKiByZXR1cm46IHZvaWQKKyAqCisgKiBUaGlzIGhl
bHBlciBmdW5jdGlvbiBpcyB1c2VkIHRvIGZpeCBFRElEIHJlYWRzIGZvciBub24tY29tcGxpYW50
CisgKiBzaW5rcyB0aGF0IGRvIG5vdCBoYW5kbGUgdGhlIGkyYyBtaWRkbGUtb2YtdHJhbnNhY3Rp
b24gZmxhZyBjb3JyZWN0bHkuCisgKi8KK3N0YXRpYyB2b2lkIGRwX2F1eF90cmFuc2Zlcl9oZWxw
ZXIoc3RydWN0IGRwX2F1eF9wcml2YXRlICphdXgsCisJCQkJICAgc3RydWN0IGRybV9kcF9hdXhf
bXNnICppbnB1dF9tc2cpCit7CisJc3RydWN0IGRybV9kcF9hdXhfbXNnIGhlbHBlcl9tc2c7CisJ
dTMyIGNvbnN0IG1lc3NhZ2Vfc2l6ZSA9IDB4MTA7CisJdTMyIGNvbnN0IHNlZ21lbnRfYWRkcmVz
cyA9IDB4MzA7CisJYm9vbCBpMmNfbW90ID0gaW5wdXRfbXNnLT5yZXF1ZXN0ICYgRFBfQVVYX0ky
Q19NT1Q7CisJYm9vbCBpMmNfcmVhZCA9IGlucHV0X21zZy0+cmVxdWVzdCAmCisJCShEUF9BVVhf
STJDX1JFQUQgJiBEUF9BVVhfTkFUSVZFX1JFQUQpOworCisJaWYgKCFpMmNfbW90IHx8ICFpMmNf
cmVhZCB8fCAoaW5wdXRfbXNnLT5zaXplID09IDApKQorCQlyZXR1cm47CisKKwlhdXgtPnJlYWQg
PSBmYWxzZTsKKwlhdXgtPmNtZF9idXN5ID0gdHJ1ZTsKKwlhdXgtPm5vX3NlbmRfYWRkciA9IHRy
dWU7CisJYXV4LT5ub19zZW5kX3N0b3AgPSB0cnVlOworCisJLyoKKwkgKiBTZW5kIHRoZSBzZWdt
ZW50IGFkZHJlc3MgZm9yIGV2ZXJ5IGkyYyByZWFkIGluIHdoaWNoIHRoZQorCSAqIG1pZGRsZS1v
Zi10cmFuYWN0aW9uIGZsYWcgaXMgc2V0LiBUaGlzIGlzIHJlcXVpcmVkIHRvIHN1cHBvcnQgRURJ
RAorCSAqIHJlYWRzIG9mIG1vcmUgdGhhbiAyIGJsb2NrcyBhcyB0aGUgc2VnbWVudCBhZGRyZXNz
IGlzIHJlc2V0IHRvIDAKKwkgKiBzaW5jZSB3ZSBhcmUgb3ZlcnJpZGluZyB0aGUgbWlkZGxlLW9m
LXRyYW5zYWN0aW9uIGZsYWcgZm9yIHJlYWQKKwkgKiB0cmFuc2FjdGlvbnMuCisJICovCisJbWVt
c2V0KCZoZWxwZXJfbXNnLCAwLCBzaXplb2YoaGVscGVyX21zZykpOworCWhlbHBlcl9tc2cuYWRk
cmVzcyA9IHNlZ21lbnRfYWRkcmVzczsKKwloZWxwZXJfbXNnLmJ1ZmZlciA9ICZhdXgtPnNlZ21l
bnQ7CisJaGVscGVyX21zZy5zaXplID0gMTsKKwlkcF9hdXhfY21kX2ZpZm9fdHgoYXV4LCAmaGVs
cGVyX21zZyk7CisKKwkvKgorCSAqIFNlbmQgdGhlIG9mZnNldCBhZGRyZXNzIGZvciBldmVyeSBp
MmMgcmVhZCBpbiB3aGljaCB0aGUKKwkgKiBtaWRkbGUtb2YtdHJhbnNhY3Rpb24gZmxhZyBpcyBz
ZXQuIFRoaXMgd2lsbCBlbnN1cmUgdGhhdCB0aGUgc2luaworCSAqIHdpbGwgdXBkYXRlIGl0cyBy
ZWFkIHBvaW50ZXIgYW5kIHJldHVybiB0aGUgY29ycmVjdCBwb3J0aW9uIG9mIHRoZQorCSAqIEVE
SUQgYnVmZmVyIGluIHRoZSBzdWJzZXF1ZW50IGkyYyByZWFkIHRyYXNudGlvbiB0cmlnZ2VyZWQg
aW4gdGhlCisJICogbmF0aXZlIEFVWCB0cmFuc2ZlciBmdW5jdGlvbi4KKwkgKi8KKwltZW1zZXQo
JmhlbHBlcl9tc2csIDAsIHNpemVvZihoZWxwZXJfbXNnKSk7CisJaGVscGVyX21zZy5hZGRyZXNz
ID0gaW5wdXRfbXNnLT5hZGRyZXNzOworCWhlbHBlcl9tc2cuYnVmZmVyID0gJmF1eC0+b2Zmc2V0
OworCWhlbHBlcl9tc2cuc2l6ZSA9IDE7CisJZHBfYXV4X2NtZF9maWZvX3R4KGF1eCwgJmhlbHBl
cl9tc2cpOworCWF1eC0+b2Zmc2V0ICs9IG1lc3NhZ2Vfc2l6ZTsKKworCWlmIChhdXgtPm9mZnNl
dCA9PSAweDgwIHx8IGF1eC0+b2Zmc2V0ID09IDB4MTAwKQorCQlhdXgtPnNlZ21lbnQgPSAweDA7
IC8qIHJlc2V0IHNlZ21lbnQgYXQgZW5kIG9mIGJsb2NrICovCit9CisKKy8qCisgKiBUaGlzIGZ1
bmN0aW9uIGRvZXMgdGhlIHJlYWwgam9iIHRvIHByb2Nlc3MgYW4gQVVYIHRyYW5zYWN0aW9uLgor
ICogSXQgd2lsbCBjYWxsIGF1eF9yZXNldCgpIGZ1bmN0aW9uIHRvIHJlc2V0IHRoZSBBVVggY2hh
bm5lbCwKKyAqIGlmIHRoZSB3YWl0aW5nIGlzIHRpbWVvdXQuCisgKi8KK3N0YXRpYyBzc2l6ZV90
IGRwX2F1eF90cmFuc2ZlcihzdHJ1Y3QgZHJtX2RwX2F1eCAqZHJtX2F1eCwKKwkJCSAgICAgICBz
dHJ1Y3QgZHJtX2RwX2F1eF9tc2cgKm1zZykKK3sKKwlzc2l6ZV90IHJldDsKKwlpbnQgY29uc3Qg
YXV4X2NtZF9uYXRpdmVfbWF4ID0gMTY7CisJaW50IGNvbnN0IGF1eF9jbWRfaTJjX21heCA9IDEy
ODsKKwlpbnQgY29uc3QgcmV0cnlfY291bnQgPSA1OworCXN0cnVjdCBkcF9hdXhfcHJpdmF0ZSAq
YXV4ID0gY29udGFpbmVyX29mKGRybV9hdXgsCisJCXN0cnVjdCBkcF9hdXhfcHJpdmF0ZSwgZHJt
X2F1eCk7CisKKwltdXRleF9sb2NrKCZhdXgtPm11dGV4KTsKKworCWF1eC0+bmF0aXZlID0gbXNn
LT5yZXF1ZXN0ICYgKERQX0FVWF9OQVRJVkVfV1JJVEUgJiBEUF9BVVhfTkFUSVZFX1JFQUQpOwor
CisJLyogSWdub3JlIGFkZHJlc3Mgb25seSBtZXNzYWdlICovCisJaWYgKChtc2ctPnNpemUgPT0g
MCkgfHwgKG1zZy0+YnVmZmVyID09IE5VTEwpKSB7CisJCW1zZy0+cmVwbHkgPSBhdXgtPm5hdGl2
ZSA/CisJCQlEUF9BVVhfTkFUSVZFX1JFUExZX0FDSyA6IERQX0FVWF9JMkNfUkVQTFlfQUNLOwor
CQlyZXQgPSBtc2ctPnNpemU7CisJCWdvdG8gdW5sb2NrX2V4aXQ7CisJfQorCisJLyogbXNnIHNh
bml0eSBjaGVjayAqLworCWlmICgoYXV4LT5uYXRpdmUgJiYgKG1zZy0+c2l6ZSA+IGF1eF9jbWRf
bmF0aXZlX21heCkpIHx8CisJCShtc2ctPnNpemUgPiBhdXhfY21kX2kyY19tYXgpKSB7CisJCURS
TV9FUlJPUigiJXM6IGludmFsaWQgbXNnOiBzaXplKCV6dSksIHJlcXVlc3QoJXgpXG4iLAorCQkJ
X19mdW5jX18sIG1zZy0+c2l6ZSwgbXNnLT5yZXF1ZXN0KTsKKwkJcmV0ID0gLUVJTlZBTDsKKwkJ
Z290byB1bmxvY2tfZXhpdDsKKwl9CisKKwlkcF9hdXhfdXBkYXRlX29mZnNldF9hbmRfc2VnbWVu
dChhdXgsIG1zZyk7CisJZHBfYXV4X3RyYW5zZmVyX2hlbHBlcihhdXgsIG1zZyk7CisKKwlhdXgt
PnJlYWQgPSBtc2ctPnJlcXVlc3QgJiAoRFBfQVVYX0kyQ19SRUFEICYgRFBfQVVYX05BVElWRV9S
RUFEKTsKKwlhdXgtPmNtZF9idXN5ID0gdHJ1ZTsKKworCWlmIChhdXgtPnJlYWQpIHsKKwkJYXV4
LT5ub19zZW5kX2FkZHIgPSB0cnVlOworCQlhdXgtPm5vX3NlbmRfc3RvcCA9IGZhbHNlOworCX0g
ZWxzZSB7CisJCWF1eC0+bm9fc2VuZF9hZGRyID0gdHJ1ZTsKKwkJYXV4LT5ub19zZW5kX3N0b3Ag
PSB0cnVlOworCX0KKworCXJldCA9IGRwX2F1eF9jbWRfZmlmb190eChhdXgsIG1zZyk7CisJaWYg
KChyZXQgPCAwKSAmJiBhdXgtPm5hdGl2ZSkgeworCQlhdXgtPnJldHJ5X2NudCsrOworCQlpZiAo
IShhdXgtPnJldHJ5X2NudCAlIHJldHJ5X2NvdW50KSkKKwkJCWRwX2NhdGFsb2dfYXV4X3VwZGF0
ZV9jZmcoYXV4LT5jYXRhbG9nLAorCQkJCWF1eC0+ZHBfYXV4LmNmZywgUEhZX0FVWF9DRkcxKTsK
KwkJZHBfY2F0YWxvZ19hdXhfcmVzZXQoYXV4LT5jYXRhbG9nKTsKKwkJZ290byB1bmxvY2tfZXhp
dDsKKwl9IGVsc2UgaWYgKHJldCA8IDApIHsKKwkJZ290byB1bmxvY2tfZXhpdDsKKwl9CisKKwlp
ZiAoYXV4LT5hdXhfZXJyb3JfbnVtID09IERQX0FVWF9FUlJfTk9ORSkgeworCQlpZiAoYXV4LT5y
ZWFkKQorCQkJZHBfYXV4X2NtZF9maWZvX3J4KGF1eCwgbXNnKTsKKworCQltc2ctPnJlcGx5ID0g
YXV4LT5uYXRpdmUgPworCQkJRFBfQVVYX05BVElWRV9SRVBMWV9BQ0sgOiBEUF9BVVhfSTJDX1JF
UExZX0FDSzsKKwl9IGVsc2UgeworCQkvKiBSZXBseSBkZWZlciB0byByZXRyeSAqLworCQltc2ct
PnJlcGx5ID0gYXV4LT5uYXRpdmUgPworCQkJRFBfQVVYX05BVElWRV9SRVBMWV9ERUZFUiA6IERQ
X0FVWF9JMkNfUkVQTFlfREVGRVI7CisJfQorCisJLyogUmV0dXJuIHJlcXVlc3RlZCBzaXplIGZv
ciBzdWNjZXNzIG9yIHJldHJ5ICovCisJcmV0ID0gbXNnLT5zaXplOworCWF1eC0+cmV0cnlfY250
ID0gMDsKKwordW5sb2NrX2V4aXQ6CisJYXV4LT5jbWRfYnVzeSA9IGZhbHNlOworCW11dGV4X3Vu
bG9jaygmYXV4LT5tdXRleCk7CisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIHZvaWQgZHBfYXV4
X3Jlc2V0X3BoeV9jb25maWdfaW5kaWNlcyhzdHJ1Y3QgZHBfYXV4X2NmZyAqYXV4X2NmZykKK3sK
KwlpbnQgaSA9IDA7CisKKwlmb3IgKGkgPSAwOyBpIDwgUEhZX0FVWF9DRkdfTUFYOyBpKyspCisJ
CWF1eF9jZmdbaV0uY3VycmVudF9pbmRleCA9IDA7Cit9CisKK3ZvaWQgZHBfYXV4X2lzcihzdHJ1
Y3QgZHBfYXV4ICpkcF9hdXgpCit7CisJc3RydWN0IGRwX2F1eF9wcml2YXRlICphdXg7CisKKwlp
ZiAoIWRwX2F1eCkgeworCQlEUk1fRVJST1IoImludmFsaWQgaW5wdXRcbiIpOworCQlyZXR1cm47
CisJfQorCisJYXV4ID0gY29udGFpbmVyX29mKGRwX2F1eCwgc3RydWN0IGRwX2F1eF9wcml2YXRl
LCBkcF9hdXgpOworCisJYXV4LT5pc3IgPSBkcF9jYXRhbG9nX2F1eF9nZXRfaXJxKGF1eC0+Y2F0
YWxvZyk7CisKKwlpZiAoIWF1eC0+Y21kX2J1c3kpCisJCXJldHVybjsKKworCWlmIChhdXgtPm5h
dGl2ZSkKKwkJZHBfYXV4X25hdGl2ZV9oYW5kbGVyKGF1eCk7CisJZWxzZQorCQlkcF9hdXhfaTJj
X2hhbmRsZXIoYXV4KTsKK30KKwordm9pZCBkcF9hdXhfcmVjb25maWcoc3RydWN0IGRwX2F1eCAq
ZHBfYXV4KQoreworCXN0cnVjdCBkcF9hdXhfcHJpdmF0ZSAqYXV4OworCisJYXV4ID0gY29udGFp
bmVyX29mKGRwX2F1eCwgc3RydWN0IGRwX2F1eF9wcml2YXRlLCBkcF9hdXgpOworCisJZHBfY2F0
YWxvZ19hdXhfdXBkYXRlX2NmZyhhdXgtPmNhdGFsb2csCisJCQlkcF9hdXgtPmNmZywgUEhZX0FV
WF9DRkcxKTsKKwlkcF9jYXRhbG9nX2F1eF9yZXNldChhdXgtPmNhdGFsb2cpOworfQorCit2b2lk
IGRwX2F1eF9pbml0KHN0cnVjdCBkcF9hdXggKmRwX2F1eCwgc3RydWN0IGRwX2F1eF9jZmcgKmF1
eF9jZmcpCit7CisJc3RydWN0IGRwX2F1eF9wcml2YXRlICphdXg7CisKKwlpZiAoIWRwX2F1eCB8
fCAhYXV4X2NmZykgeworCQlEUk1fRVJST1IoImludmFsaWQgaW5wdXRcbiIpOworCQlyZXR1cm47
CisJfQorCisJYXV4ID0gY29udGFpbmVyX29mKGRwX2F1eCwgc3RydWN0IGRwX2F1eF9wcml2YXRl
LCBkcF9hdXgpOworCisJZHBfYXV4X3Jlc2V0X3BoeV9jb25maWdfaW5kaWNlcyhhdXhfY2ZnKTsK
KwlkcF9jYXRhbG9nX2F1eF9zZXR1cChhdXgtPmNhdGFsb2csIGF1eF9jZmcpOworCWRwX2NhdGFs
b2dfYXV4X3Jlc2V0KGF1eC0+Y2F0YWxvZyk7CisJZHBfY2F0YWxvZ19hdXhfZW5hYmxlKGF1eC0+
Y2F0YWxvZywgdHJ1ZSk7CisJYXV4LT5yZXRyeV9jbnQgPSAwOworfQorCit2b2lkIGRwX2F1eF9k
ZWluaXQoc3RydWN0IGRwX2F1eCAqZHBfYXV4KQoreworCXN0cnVjdCBkcF9hdXhfcHJpdmF0ZSAq
YXV4OworCisJaWYgKCFkcF9hdXgpIHsKKwkJRFJNX0VSUk9SKCJpbnZhbGlkIGlucHV0XG4iKTsK
KwkJcmV0dXJuOworCX0KKworCWF1eCA9IGNvbnRhaW5lcl9vZihkcF9hdXgsIHN0cnVjdCBkcF9h
dXhfcHJpdmF0ZSwgZHBfYXV4KTsKKworCWRwX2NhdGFsb2dfYXV4X2VuYWJsZShhdXgtPmNhdGFs
b2csIGZhbHNlKTsKK30KKworaW50IGRwX2F1eF9yZWdpc3RlcihzdHJ1Y3QgZHBfYXV4ICpkcF9h
dXgpCit7CisJc3RydWN0IGRwX2F1eF9wcml2YXRlICphdXg7CisJaW50IHJldCA9IDA7CisKKwlp
ZiAoIWRwX2F1eCkgeworCQlEUk1fRVJST1IoImludmFsaWQgaW5wdXRcbiIpOworCQlyZXQgPSAt
RUlOVkFMOworCQlnb3RvIGV4aXQ7CisJfQorCisJYXV4ID0gY29udGFpbmVyX29mKGRwX2F1eCwg
c3RydWN0IGRwX2F1eF9wcml2YXRlLCBkcF9hdXgpOworCisJYXV4LT5kcm1fYXV4Lm5hbWUgPSAi
ZHB1X2RwX2F1eCI7CisJYXV4LT5kcm1fYXV4LmRldiA9IGF1eC0+ZGV2OworCWF1eC0+ZHJtX2F1
eC50cmFuc2ZlciA9IGRwX2F1eF90cmFuc2ZlcjsKKwlyZXQgPSBkcm1fZHBfYXV4X3JlZ2lzdGVy
KCZhdXgtPmRybV9hdXgpOworCWlmIChyZXQpIHsKKwkJRFJNX0VSUk9SKCIlczogZmFpbGVkIHRv
IHJlZ2lzdGVyIGRybSBhdXg6ICVkXG4iLCBfX2Z1bmNfXywgcmV0KTsKKwkJZ290byBleGl0Owor
CX0KKwlkcF9hdXgtPmRybV9hdXggPSAmYXV4LT5kcm1fYXV4OworZXhpdDoKKwlyZXR1cm4gcmV0
OworfQorCit2b2lkIGRwX2F1eF91bnJlZ2lzdGVyKHN0cnVjdCBkcF9hdXggKmRwX2F1eCkKK3sK
KwlzdHJ1Y3QgZHBfYXV4X3ByaXZhdGUgKmF1eDsKKworCWlmICghZHBfYXV4KSB7CisJCURSTV9F
UlJPUigiaW52YWxpZCBpbnB1dFxuIik7CisJCXJldHVybjsKKwl9CisKKwlhdXggPSBjb250YWlu
ZXJfb2YoZHBfYXV4LCBzdHJ1Y3QgZHBfYXV4X3ByaXZhdGUsIGRwX2F1eCk7CisJZHJtX2RwX2F1
eF91bnJlZ2lzdGVyKCZhdXgtPmRybV9hdXgpOworfQorCitzdHJ1Y3QgZHBfYXV4ICpkcF9hdXhf
Z2V0KHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRwX2NhdGFsb2cgKmNhdGFsb2csCisJCQkg
IHN0cnVjdCBkcF9hdXhfY2ZnICphdXhfY2ZnKQoreworCWludCByYyA9IDA7CisJc3RydWN0IGRw
X2F1eF9wcml2YXRlICphdXg7CisJc3RydWN0IGRwX2F1eCAqZHBfYXV4OworCisJaWYgKCFjYXRh
bG9nIHx8ICFhdXhfY2ZnKSB7CisJCURSTV9FUlJPUigiaW52YWxpZCBpbnB1dFxuIik7CisJCXJj
ID0gLUVOT0RFVjsKKwkJZ290byBlcnJvcjsKKwl9CisKKwlhdXggPSBkZXZtX2t6YWxsb2MoZGV2
LCBzaXplb2YoKmF1eCksIEdGUF9LRVJORUwpOworCWlmICghYXV4KSB7CisJCXJjID0gLUVOT01F
TTsKKwkJZ290byBlcnJvcjsKKwl9CisKKwlpbml0X2NvbXBsZXRpb24oJmF1eC0+Y29tcCk7CisJ
YXV4LT5jbWRfYnVzeSA9IGZhbHNlOworCW11dGV4X2luaXQoJmF1eC0+bXV0ZXgpOworCisJYXV4
LT5kZXYgPSBkZXY7CisJYXV4LT5jYXRhbG9nID0gY2F0YWxvZzsKKwlhdXgtPmRwX2F1eC5jZmcg
PSBhdXhfY2ZnOworCWRwX2F1eCA9ICZhdXgtPmRwX2F1eDsKKwlhdXgtPnJldHJ5X2NudCA9IDA7
CisKKwlyZXR1cm4gZHBfYXV4OworZXJyb3I6CisJcmV0dXJuIEVSUl9QVFIocmMpOworfQorCit2
b2lkIGRwX2F1eF9wdXQoc3RydWN0IGRwX2F1eCAqZHBfYXV4KQoreworCXN0cnVjdCBkcF9hdXhf
cHJpdmF0ZSAqYXV4OworCisJaWYgKCFkcF9hdXgpCisJCXJldHVybjsKKworCWF1eCA9IGNvbnRh
aW5lcl9vZihkcF9hdXgsIHN0cnVjdCBkcF9hdXhfcHJpdmF0ZSwgZHBfYXV4KTsKKworCW11dGV4
X2Rlc3Ryb3koJmF1eC0+bXV0ZXgpOworCisJZGV2bV9rZnJlZShhdXgtPmRldiwgYXV4KTsKK30K
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfYXV4LmggYi9kcml2ZXJzL2dw
dS9kcm0vbXNtL2RwL2RwX2F1eC5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAu
LjhjZTIyMjEKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX2F1
eC5oCkBAIC0wLDAgKzEsMzcgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4w
LW9ubHkgKi8KKy8qCisgKiBDb3B5cmlnaHQgKGMpIDIwMTItMjAxOSwgVGhlIExpbnV4IEZvdW5k
YXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuCisgKi8KKworI2lmbmRlZiBfRFBfQVVYX0hfCisj
ZGVmaW5lIF9EUF9BVVhfSF8KKworI2luY2x1ZGUgImRwX2NhdGFsb2cuaCIKKyNpbmNsdWRlIDxk
cm0vZHJtX2RwX2hlbHBlci5oPgorCitlbnVtIGRwX2F1eF9lcnJvciB7CisJRFBfQVVYX0VSUl9O
T05FCT0gMCwKKwlEUF9BVVhfRVJSX0FERFIJPSAtMSwKKwlEUF9BVVhfRVJSX1RPVVQJPSAtMiwK
KwlEUF9BVVhfRVJSX05BQ0sJPSAtMywKKwlEUF9BVVhfRVJSX0RFRkVSCT0gLTQsCisJRFBfQVVY
X0VSUl9OQUNLX0RFRkVSCT0gLTUsCit9OworCitzdHJ1Y3QgZHBfYXV4IHsKKwlzdHJ1Y3QgZHJt
X2RwX2F1eCAqZHJtX2F1eDsKKwlzdHJ1Y3QgZHBfYXV4X2NmZyAqY2ZnOworfTsKKworaW50IGRw
X2F1eF9yZWdpc3RlcihzdHJ1Y3QgZHBfYXV4ICphdXgpOwordm9pZCBkcF9hdXhfdW5yZWdpc3Rl
cihzdHJ1Y3QgZHBfYXV4ICphdXgpOwordm9pZCBkcF9hdXhfaXNyKHN0cnVjdCBkcF9hdXggKmF1
eCk7Cit2b2lkIGRwX2F1eF9pbml0KHN0cnVjdCBkcF9hdXggKmF1eCwgc3RydWN0IGRwX2F1eF9j
ZmcgKmF1eF9jZmcpOwordm9pZCBkcF9hdXhfZGVpbml0KHN0cnVjdCBkcF9hdXggKmF1eCk7Cit2
b2lkIGRwX2F1eF9yZWNvbmZpZyhzdHJ1Y3QgZHBfYXV4ICphdXgpOworCitzdHJ1Y3QgZHBfYXV4
ICpkcF9hdXhfZ2V0KHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRwX2NhdGFsb2cgKmNhdGFs
b2csCisJCQkgIHN0cnVjdCBkcF9hdXhfY2ZnICphdXhfY2ZnKTsKK3ZvaWQgZHBfYXV4X3B1dChz
dHJ1Y3QgZHBfYXV4ICphdXgpOworCisjZW5kaWYgLypfX0RQX0FVWF9IXyovCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX2NhdGFsb2cuYyBiL2RyaXZlcnMvZ3B1L2RybS9t
c20vZHAvZHBfY2F0YWxvZy5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjUx
ZTIxYmIKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX2NhdGFs
b2cuYwpAQCAtMCwwICsxLDg0MSBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0y
LjAtb25seQorLyoKKyAqIENvcHlyaWdodCAoYykgMjAxNy0yMDE5LCBUaGUgTGludXggRm91bmRh
dGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KKyAqLworCisjZGVmaW5lIHByX2ZtdChmbXQpCSJb
ZHJtLWRwXSAlczogIiBmbXQsIF9fZnVuY19fCisKKyNpbmNsdWRlIDxsaW51eC9kZWxheS5oPgor
I2luY2x1ZGUgPGxpbnV4L2lvcG9sbC5oPgorI2luY2x1ZGUgPGRybS9kcm1fZHBfaGVscGVyLmg+
CisKKyNpbmNsdWRlICJkcF9jYXRhbG9nLmgiCisjaW5jbHVkZSAiZHBfcmVnLmgiCisKKyNkZWZp
bmUgUE9MTElOR19TTEVFUF9VUwkJCTEwMDAKKyNkZWZpbmUgUE9MTElOR19USU1FT1VUX1VTCQkJ
MTAwMDAKKworI2RlZmluZSBSRUZUSU1FUl9ERUZBVUxUX1ZBTFVFCQkJMHgyMDAwMAorI2RlZmlu
ZSBTQ1JBTUJMRVJfUkVTRVRfQ09VTlRfVkFMVUUJCTB4RkMKKworI2RlZmluZSBEUF9JTlRFUlJV
UFRfU1RBVFVTX0FDS19TSElGVAkxCisjZGVmaW5lIERQX0lOVEVSUlVQVF9TVEFUVVNfTUFTS19T
SElGVAkyCisKKyNkZWZpbmUgRFBfSU5URVJSVVBUX1NUQVRVUzEgXAorCShEUF9JTlRSX0FVWF9J
MkNfRE9ORXwgXAorCURQX0lOVFJfV1JPTkdfQUREUiB8IERQX0lOVFJfVElNRU9VVCB8IFwKKwlE
UF9JTlRSX05BQ0tfREVGRVIgfCBEUF9JTlRSX1dST05HX0RBVEFfQ05UIHwgXAorCURQX0lOVFJf
STJDX05BQ0sgfCBEUF9JTlRSX0kyQ19ERUZFUiB8IFwKKwlEUF9JTlRSX1BMTF9VTkxPQ0tFRCB8
IERQX0lOVFJfQVVYX0VSUk9SKQorCisjZGVmaW5lIERQX0lOVEVSUlVQVF9TVEFUVVMxX0FDSyAo
RFBfSU5URVJSVVBUX1NUQVRVUzEgPDwgRFBfSU5URVJSVVBUX1NUQVRVU19BQ0tfU0hJRlQpCisj
ZGVmaW5lIERQX0lOVEVSUlVQVF9TVEFUVVMxX01BU0sgKERQX0lOVEVSUlVQVF9TVEFUVVMxIDw8
IERQX0lOVEVSUlVQVF9TVEFUVVNfTUFTS19TSElGVCkKKworI2RlZmluZSBEUF9JTlRFUlJVUFRf
U1RBVFVTMiBcCisJKERQX0lOVFJfUkVBRFlfRk9SX1ZJREVPIHwgRFBfSU5UUl9JRExFX1BBVFRF
Uk5fU0VOVCB8IFwKKwlEUF9JTlRSX0ZSQU1FX0VORCB8IERQX0lOVFJfQ1JDX1VQREFURUQpCisK
KyNkZWZpbmUgRFBfSU5URVJSVVBUX1NUQVRVUzJfQUNLIChEUF9JTlRFUlJVUFRfU1RBVFVTMiA8
PCBEUF9JTlRFUlJVUFRfU1RBVFVTX0FDS19TSElGVCkKKyNkZWZpbmUgRFBfSU5URVJSVVBUX1NU
QVRVUzJfTUFTSyAoRFBfSU5URVJSVVBUX1NUQVRVUzIgPDwgRFBfSU5URVJSVVBUX1NUQVRVU19N
QVNLX1NISUZUKQorCitzdGF0aWMgdTggY29uc3Qgdm1fcHJlX2VtcGhhc2lzWzRdWzRdID0gewor
CXsweDAwLCAweDBCLCAweDEyLCAweEZGfSwgICAgICAgLyogcGUwLCAwIGRiICovCisJezB4MDAs
IDB4MEEsIDB4MTIsIDB4RkZ9LCAgICAgICAvKiBwZTEsIDMuNSBkYiAqLworCXsweDAwLCAweDBD
LCAweEZGLCAweEZGfSwgICAgICAgLyogcGUyLCA2LjAgZGIgKi8KKwl7MHhGRiwgMHhGRiwgMHhG
RiwgMHhGRn0gICAgICAgIC8qIHBlMywgOS41IGRiICovCit9OworCisvKiB2b2x0YWdlIHN3aW5n
LCAwLjJ2IGFuZCAxLjB2IGFyZSBub3Qgc3VwcG9ydCAqLworc3RhdGljIHU4IGNvbnN0IHZtX3Zv
bHRhZ2Vfc3dpbmdbNF1bNF0gPSB7CisJezB4MDcsIDB4MEYsIDB4MTQsIDB4RkZ9LCAvKiBzdzAs
IDAuNHYgICovCisJezB4MTEsIDB4MUQsIDB4MUYsIDB4RkZ9LCAvKiBzdzEsIDAuNiB2ICovCisJ
ezB4MTgsIDB4MUYsIDB4RkYsIDB4RkZ9LCAvKiBzdzEsIDAuOCB2ICovCisJezB4RkYsIDB4RkYs
IDB4RkYsIDB4RkZ9ICAvKiBzdzEsIDEuMiB2LCBvcHRpb25hbCAqLworfTsKKworc3RydWN0IGRw
X2NhdGFsb2dfcHJpdmF0ZSB7CisJc3RydWN0IGRldmljZSAqZGV2OworCXN0cnVjdCBkcF9pbyAq
aW87CisJc3RydWN0IGRwX2NhdGFsb2cgZHBfY2F0YWxvZzsKK307CisKK3N0YXRpYyBpbmxpbmUg
dTMyIGRwX3JlYWRfYXV4KHN0cnVjdCBkcF9jYXRhbG9nX3ByaXZhdGUgKmNhdGFsb2csIHUzMiBv
ZmZzZXQpCit7CisJcmV0dXJuIHJlYWRsX3JlbGF4ZWQoY2F0YWxvZy0+aW8tPmRwX2F1eC5iYXNl
ICsgb2Zmc2V0KTsKK30KKworc3RhdGljIGlubGluZSB2b2lkIGRwX3dyaXRlX2F1eChzdHJ1Y3Qg
ZHBfY2F0YWxvZ19wcml2YXRlICpjYXRhbG9nLAorCQkJICAgICAgIHUzMiBvZmZzZXQsIHUzMiBk
YXRhKQoreworCS8qCisJICogVG8gbWFrZSBzdXJlIGF1eCByZWcgd3JpdGVzIGhhcHBlbnMgYmVm
b3JlIGFueSBvdGhlciBvcGVyYXRpb24sCisJICogdGhpcyBmdW5jdGlvbiB1c2VzIHdyaXRlbCgp
IGluc3RyZWFkIG9mIHdyaXRlbF9yZWxheGVkKCkKKwkgKi8KKwl3cml0ZWwoZGF0YSwgY2F0YWxv
Zy0+aW8tPmRwX2F1eC5iYXNlICsgb2Zmc2V0KTsKK30KKworc3RhdGljIGlubGluZSB1MzIgZHBf
cmVhZF9haGIoc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0ZSAqY2F0YWxvZywgdTMyIG9mZnNldCkK
K3sKKwlyZXR1cm4gcmVhZGxfcmVsYXhlZChjYXRhbG9nLT5pby0+ZHBfYWhiLmJhc2UgKyBvZmZz
ZXQpOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQgZHBfd3JpdGVfYWhiKHN0cnVjdCBkcF9jYXRh
bG9nX3ByaXZhdGUgKmNhdGFsb2csCisJCQkgICAgICAgdTMyIG9mZnNldCwgdTMyIGRhdGEpCit7
CisJLyoKKwkgKiBUbyBtYWtlIHN1cmUgcGh5IHJlZyB3cml0ZXMgaGFwcGVucyBiZWZvcmUgYW55
IG90aGVyIG9wZXJhdGlvbiwKKwkgKiB0aGlzIGZ1bmN0aW9uIHVzZXMgd3JpdGVsKCkgaW5zdHJl
YWQgb2Ygd3JpdGVsX3JlbGF4ZWQoKQorCSAqLworCXdyaXRlbChkYXRhLCBjYXRhbG9nLT5pby0+
ZHBfYWhiLmJhc2UgKyBvZmZzZXQpOworfQorCitzdGF0aWMgaW5saW5lIHUzMiBkcF9yZWFkX2Nj
KHN0cnVjdCBkcF9jYXRhbG9nX3ByaXZhdGUgKmNhdGFsb2csIHUzMiBvZmZzZXQpCit7CisJcmV0
dXJuIHJlYWRsX3JlbGF4ZWQoY2F0YWxvZy0+aW8tPmRwX2NjX2lvLmJhc2UgKyBvZmZzZXQpOwor
fQorCitzdGF0aWMgaW5saW5lIHZvaWQgZHBfd3JpdGVfcGh5KHN0cnVjdCBkcF9jYXRhbG9nX3By
aXZhdGUgKmNhdGFsb2csCisJCQkgICAgICAgdTMyIG9mZnNldCwgdTMyIGRhdGEpCit7CisJLyoK
KwkgKiBUbyBtYWtlIHN1cmUgcGh5IHJlZyB3cml0ZXMgaGFwcGVucyBiZWZvcmUgYW55IG90aGVy
IG9wZXJhdGlvbiwKKwkgKiB0aGlzIGZ1bmN0aW9uIHVzZXMgd3JpdGVsKCkgaW5zdHJlYWQgb2Yg
d3JpdGVsX3JlbGF4ZWQoKQorCSAqLworCXdyaXRlbChkYXRhLCBjYXRhbG9nLT5pby0+cGh5X2lv
LmJhc2UgKyBvZmZzZXQpOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQgZHBfd3JpdGVfcGxsKHN0
cnVjdCBkcF9jYXRhbG9nX3ByaXZhdGUgKmNhdGFsb2csCisJCQkgICAgICAgdTMyIG9mZnNldCwg
dTMyIGRhdGEpCit7CisJd3JpdGVsX3JlbGF4ZWQoZGF0YSwgY2F0YWxvZy0+aW8tPmRwX3BsbF9p
by5iYXNlICsgb2Zmc2V0KTsKK30KKworc3RhdGljIGlubGluZSB2b2lkIGRwX3dyaXRlX2xuX3R4
MChzdHJ1Y3QgZHBfY2F0YWxvZ19wcml2YXRlICpjYXRhbG9nLAorCQkJICAgICAgIHUzMiBvZmZz
ZXQsIHUzMiBkYXRhKQoreworCXdyaXRlbF9yZWxheGVkKGRhdGEsIGNhdGFsb2ctPmlvLT5sbl90
eDBfaW8uYmFzZSArIG9mZnNldCk7Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBkcF93cml0ZV9s
bl90eDEoc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0ZSAqY2F0YWxvZywKKwkJCSAgICAgICB1MzIg
b2Zmc2V0LCB1MzIgZGF0YSkKK3sKKwl3cml0ZWxfcmVsYXhlZChkYXRhLCBjYXRhbG9nLT5pby0+
bG5fdHgxX2lvLmJhc2UgKyBvZmZzZXQpOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQgZHBfd3Jp
dGVfdXNiX2NtKHN0cnVjdCBkcF9jYXRhbG9nX3ByaXZhdGUgKmNhdGFsb2csCisJCQkgICAgICAg
dTMyIG9mZnNldCwgdTMyIGRhdGEpCit7CisJLyoKKwkgKiBUbyBtYWtlIHN1cmUgdXNiIHJlZyB3
cml0ZXMgaGFwcGVucyBiZWZvcmUgYW55IG90aGVyIG9wZXJhdGlvbiwKKwkgKiB0aGlzIGZ1bmN0
aW9uIHVzZXMgd3JpdGVsKCkgaW5zdHJlYWQgb2Ygd3JpdGVsX3JlbGF4ZWQoKQorCSAqLworCXdy
aXRlbChkYXRhLCBjYXRhbG9nLT5pby0+dXNiM19kcF9jb20uYmFzZSArIG9mZnNldCk7Cit9CisK
K3N0YXRpYyBpbmxpbmUgdm9pZCBkcF93cml0ZV9wMChzdHJ1Y3QgZHBfY2F0YWxvZ19wcml2YXRl
ICpjYXRhbG9nLAorCQkJICAgICAgIHUzMiBvZmZzZXQsIHUzMiBkYXRhKQoreworCS8qCisJICog
VG8gbWFrZSBzdXJlIGludGVyZmFjZSByZWcgd3JpdGVzIGhhcHBlbnMgYmVmb3JlIGFueSBvdGhl
ciBvcGVyYXRpb24sCisJICogdGhpcyBmdW5jdGlvbiB1c2VzIHdyaXRlbCgpIGluc3RyZWFkIG9m
IHdyaXRlbF9yZWxheGVkKCkKKwkgKi8KKwl3cml0ZWwoZGF0YSwgY2F0YWxvZy0+aW8tPmRwX3Aw
LmJhc2UgKyBvZmZzZXQpOworfQorCitzdGF0aWMgaW5saW5lIHUzMiBkcF9yZWFkX2xpbmsoc3Ry
dWN0IGRwX2NhdGFsb2dfcHJpdmF0ZSAqY2F0YWxvZywgdTMyIG9mZnNldCkKK3sKKwlyZXR1cm4g
cmVhZGxfcmVsYXhlZChjYXRhbG9nLT5pby0+ZHBfbGluay5iYXNlICsgb2Zmc2V0KTsKK30KKwor
c3RhdGljIGlubGluZSB2b2lkIGRwX3dyaXRlX2xpbmsoc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0
ZSAqY2F0YWxvZywKKwkJCSAgICAgICB1MzIgb2Zmc2V0LCB1MzIgZGF0YSkKK3sKKwkvKgorCSAq
IFRvIG1ha2Ugc3VyZSBsaW5rIHJlZyB3cml0ZXMgaGFwcGVucyBiZWZvcmUgYW55IG90aGVyIG9w
ZXJhdGlvbiwKKwkgKiB0aGlzIGZ1bmN0aW9uIHVzZXMgd3JpdGVsKCkgaW5zdHJlYWQgb2Ygd3Jp
dGVsX3JlbGF4ZWQoKQorCSAqLworCXdyaXRlbChkYXRhLCBjYXRhbG9nLT5pby0+ZHBfbGluay5i
YXNlICsgb2Zmc2V0KTsKK30KKworLyogYXV4IHJlbGF0ZWQgY2F0YWxvZyBmdW5jdGlvbnMgKi8K
K3UzMiBkcF9jYXRhbG9nX2F1eF9yZWFkX2RhdGEoc3RydWN0IGRwX2NhdGFsb2cgKmRwX2NhdGFs
b2cpCit7CisJc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0ZSAqY2F0YWxvZyA9IGNvbnRhaW5lcl9v
ZihkcF9jYXRhbG9nLAorCQkJCXN0cnVjdCBkcF9jYXRhbG9nX3ByaXZhdGUsIGRwX2NhdGFsb2cp
OworCisJcmV0dXJuIGRwX3JlYWRfYXV4KGNhdGFsb2csIFJFR19EUF9BVVhfREFUQSk7Cit9CisK
K2ludCBkcF9jYXRhbG9nX2F1eF93cml0ZV9kYXRhKHN0cnVjdCBkcF9jYXRhbG9nICpkcF9jYXRh
bG9nKQoreworCWludCByYyA9IDA7CisJc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0ZSAqY2F0YWxv
ZyA9IGNvbnRhaW5lcl9vZihkcF9jYXRhbG9nLAorCQkJCXN0cnVjdCBkcF9jYXRhbG9nX3ByaXZh
dGUsIGRwX2NhdGFsb2cpOworCisJZHBfd3JpdGVfYXV4KGNhdGFsb2csIFJFR19EUF9BVVhfREFU
QSwgZHBfY2F0YWxvZy0+YXV4X2RhdGEpOworCXJldHVybiByYzsKK30KKworaW50IGRwX2NhdGFs
b2dfYXV4X3dyaXRlX3RyYW5zKHN0cnVjdCBkcF9jYXRhbG9nICpkcF9jYXRhbG9nKQoreworCWlu
dCByYyA9IDA7CisJc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0ZSAqY2F0YWxvZyA9IGNvbnRhaW5l
cl9vZihkcF9jYXRhbG9nLAorCQkJCXN0cnVjdCBkcF9jYXRhbG9nX3ByaXZhdGUsIGRwX2NhdGFs
b2cpOworCisJZHBfd3JpdGVfYXV4KGNhdGFsb2csIFJFR19EUF9BVVhfVFJBTlNfQ1RSTCwgZHBf
Y2F0YWxvZy0+YXV4X2RhdGEpOworCXJldHVybiByYzsKK30KKworaW50IGRwX2NhdGFsb2dfYXV4
X2NsZWFyX3RyYW5zKHN0cnVjdCBkcF9jYXRhbG9nICpkcF9jYXRhbG9nLCBib29sIHJlYWQpCit7
CisJaW50IHJjID0gMDsKKwl1MzIgZGF0YSA9IDA7CisJc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0
ZSAqY2F0YWxvZyA9IGNvbnRhaW5lcl9vZihkcF9jYXRhbG9nLAorCQkJCXN0cnVjdCBkcF9jYXRh
bG9nX3ByaXZhdGUsIGRwX2NhdGFsb2cpOworCisJaWYgKHJlYWQpIHsKKwkJZGF0YSA9IGRwX3Jl
YWRfYXV4KGNhdGFsb2csIFJFR19EUF9BVVhfVFJBTlNfQ1RSTCk7CisJCWRhdGEgJj0gfkRQX0FV
WF9UUkFOU19DVFJMX0dPOworCQlkcF93cml0ZV9hdXgoY2F0YWxvZywgUkVHX0RQX0FVWF9UUkFO
U19DVFJMLCBkYXRhKTsKKwl9IGVsc2UgeworCQlkcF93cml0ZV9hdXgoY2F0YWxvZywgUkVHX0RQ
X0FVWF9UUkFOU19DVFJMLCAwKTsKKwl9CisJcmV0dXJuIHJjOworfQorCit2b2lkIGRwX2NhdGFs
b2dfYXV4X3Jlc2V0KHN0cnVjdCBkcF9jYXRhbG9nICpkcF9jYXRhbG9nKQoreworCXUzMiBhdXhf
Y3RybDsKKwlzdHJ1Y3QgZHBfY2F0YWxvZ19wcml2YXRlICpjYXRhbG9nID0gY29udGFpbmVyX29m
KGRwX2NhdGFsb2csCisJCQkJc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0ZSwgZHBfY2F0YWxvZyk7
CisKKwlhdXhfY3RybCA9IGRwX3JlYWRfYXV4KGNhdGFsb2csIFJFR19EUF9BVVhfQ1RSTCk7CisK
KwlhdXhfY3RybCB8PSBEUF9BVVhfQ1RSTF9SRVNFVDsKKwlkcF93cml0ZV9hdXgoY2F0YWxvZywg
UkVHX0RQX0FVWF9DVFJMLCBhdXhfY3RybCk7CisJdXNsZWVwX3JhbmdlKDEwMDAsIDExMDApOyAv
KiBoL3cgcmVjb21tZW5kZWQgZGVsYXkgKi8KKworCWF1eF9jdHJsICY9IH5EUF9BVVhfQ1RSTF9S
RVNFVDsKKwlkcF93cml0ZV9hdXgoY2F0YWxvZywgUkVHX0RQX0FVWF9DVFJMLCBhdXhfY3RybCk7
Cit9CisKK3ZvaWQgZHBfY2F0YWxvZ19hdXhfZW5hYmxlKHN0cnVjdCBkcF9jYXRhbG9nICpkcF9j
YXRhbG9nLCBib29sIGVuYWJsZSkKK3sKKwl1MzIgYXV4X2N0cmw7CisJc3RydWN0IGRwX2NhdGFs
b2dfcHJpdmF0ZSAqY2F0YWxvZyA9IGNvbnRhaW5lcl9vZihkcF9jYXRhbG9nLAorCQkJCXN0cnVj
dCBkcF9jYXRhbG9nX3ByaXZhdGUsIGRwX2NhdGFsb2cpOworCisJYXV4X2N0cmwgPSBkcF9yZWFk
X2F1eChjYXRhbG9nLCBSRUdfRFBfQVVYX0NUUkwpOworCisJaWYgKGVuYWJsZSkgeworCQlkcF93
cml0ZV9hdXgoY2F0YWxvZywgUkVHX0RQX1RJTUVPVVRfQ09VTlQsIDB4ZmZmZik7CisJCWRwX3dy
aXRlX2F1eChjYXRhbG9nLCBSRUdfRFBfQVVYX0xJTUlUUywgMHhmZmZmKTsKKwkJYXV4X2N0cmwg
fD0gRFBfQVVYX0NUUkxfRU5BQkxFOworCX0gZWxzZSB7CisJCWF1eF9jdHJsICY9IH5EUF9BVVhf
Q1RSTF9FTkFCTEU7CisJfQorCisJZHBfd3JpdGVfYXV4KGNhdGFsb2csIFJFR19EUF9BVVhfQ1RS
TCwgYXV4X2N0cmwpOworfQorCit2b2lkIGRwX2NhdGFsb2dfYXV4X3VwZGF0ZV9jZmcoc3RydWN0
IGRwX2NhdGFsb2cgKmRwX2NhdGFsb2csCisJCXN0cnVjdCBkcF9hdXhfY2ZnICpjZmcsIGVudW0g
ZHBfcGh5X2F1eF9jb25maWdfdHlwZSB0eXBlKQoreworCXN0cnVjdCBkcF9jYXRhbG9nX3ByaXZh
dGUgKmNhdGFsb2cgPSBjb250YWluZXJfb2YoZHBfY2F0YWxvZywKKwkJCQlzdHJ1Y3QgZHBfY2F0
YWxvZ19wcml2YXRlLCBkcF9jYXRhbG9nKTsKKwl1MzIgbmV3X2luZGV4ID0gMCwgY3VycmVudF9p
bmRleCA9IDA7CisKKwlpZiAodHlwZSA+PSBQSFlfQVVYX0NGR19NQVgpIHsKKwkJRFJNX0VSUk9S
KCJpbnZhbGlkIGlucHV0XG4iKTsKKwkJcmV0dXJuOworCX0KKworCWN1cnJlbnRfaW5kZXggPSBj
ZmdbdHlwZV0uY3VycmVudF9pbmRleDsKKwluZXdfaW5kZXggPSAoY3VycmVudF9pbmRleCArIDEp
ICUgY2ZnW3R5cGVdLmNmZ19jbnQ7CisJRFJNX0RFQlVHX0RQKCJVcGRhdGluZyAlcyBmcm9tIDB4
JTA4eCB0byAweCUwOHhcbiIsCisJCWRwX3BoeV9hdXhfY29uZmlnX3R5cGVfdG9fc3RyaW5nKHR5
cGUpLAorCWNmZ1t0eXBlXS5sdXRbY3VycmVudF9pbmRleF0sIGNmZ1t0eXBlXS5sdXRbbmV3X2lu
ZGV4XSk7CisKKwlkcF93cml0ZV9waHkoY2F0YWxvZywgY2ZnW3R5cGVdLm9mZnNldCwKKwkJCWNm
Z1t0eXBlXS5sdXRbbmV3X2luZGV4XSk7CisJY2ZnW3R5cGVdLmN1cnJlbnRfaW5kZXggPSBuZXdf
aW5kZXg7Cit9CisKK3ZvaWQgZHBfY2F0YWxvZ19hdXhfc2V0dXAoc3RydWN0IGRwX2NhdGFsb2cg
KmRwX2NhdGFsb2csCisJCXN0cnVjdCBkcF9hdXhfY2ZnICpjZmcpCit7CisJc3RydWN0IGRwX2Nh
dGFsb2dfcHJpdmF0ZSAqY2F0YWxvZyA9IGNvbnRhaW5lcl9vZihkcF9jYXRhbG9nLAorCQkJCXN0
cnVjdCBkcF9jYXRhbG9nX3ByaXZhdGUsIGRwX2NhdGFsb2cpOworCWludCBpID0gMDsKKworCWRw
X3dyaXRlX3BoeShjYXRhbG9nLCBSRUdfRFBfUEhZX1BEX0NUTCwgRFBfUEhZX1BEX0NUTF9QV1JE
TiB8CisJCURQX1BIWV9QRF9DVExfQVVYX1BXUkROIHwgRFBfUEhZX1BEX0NUTF9QTExfUFdSRE4g
fAorCQlEUF9QSFlfUERfQ1RMX0RQX0NMQU1QX0VOKTsKKworCS8qIFR1cm4gb24gQklBUyBjdXJy
ZW50IGZvciBQSFkvUExMICovCisJZHBfd3JpdGVfcGxsKGNhdGFsb2csCisJCVFTRVJERVNfQ09N
X0JJQVNfRU5fQ0xLQlVGTFJfRU4sIFFTRVJERVNfQ09NX0JJQVNfRU4gfAorCQlRU0VSREVTX0NP
TV9CSUFTX0VOX01VWCB8IFFTRVJERVNfQ09NX0NMS0JVRl9MX0VOIHwKKwkJUVNFUkRFU19DT01f
RU5fU1lTQ0xLX1RYX1NFTCk7CisKKwkvKiBEUCBBVVggQ0ZHIHJlZ2lzdGVyIHByb2dyYW1taW5n
ICovCisJZm9yIChpID0gMDsgaSA8IFBIWV9BVVhfQ0ZHX01BWDsgaSsrKSB7CisJCURSTV9ERUJV
R19EUCgiJXM6IG9mZnNldD0weCUwOHgsIHZhbHVlPTB4JTA4eFxuIiwKKwkJCWRwX3BoeV9hdXhf
Y29uZmlnX3R5cGVfdG9fc3RyaW5nKGkpLAorCQkJY2ZnW2ldLm9mZnNldCwgY2ZnW2ldLmx1dFtj
ZmdbaV0uY3VycmVudF9pbmRleF0pOworCQlkcF93cml0ZV9waHkoY2F0YWxvZywgY2ZnW2ldLm9m
ZnNldCwKKwkJCWNmZ1tpXS5sdXRbY2ZnW2ldLmN1cnJlbnRfaW5kZXhdKTsKKwl9CisKKwlkcF93
cml0ZV9waHkoY2F0YWxvZywgUkVHX0RQX1BIWV9BVVhfSU5URVJSVVBUX01BU0ssIFBIWV9BVVhf
U1RPUF9FUlJfTUFTSyB8CisJCQlQSFlfQVVYX0RFQ19FUlJfTUFTSyB8IFBIWV9BVVhfU1lOQ19F
UlJfTUFTSyB8CisJCQlQSFlfQVVYX0FMSUdOX0VSUl9NQVNLIHwgUEhZX0FVWF9SRVFfRVJSX01B
U0spOworfQorCitpbnQgZHBfY2F0YWxvZ19hdXhfZ2V0X2lycShzdHJ1Y3QgZHBfY2F0YWxvZyAq
ZHBfY2F0YWxvZykKK3sKKwlzdHJ1Y3QgZHBfY2F0YWxvZ19wcml2YXRlICpjYXRhbG9nID0gY29u
dGFpbmVyX29mKGRwX2NhdGFsb2csCisJCQkJc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0ZSwgZHBf
Y2F0YWxvZyk7CisJdTMyIGludHIsIGludHJfYWNrOworCisJaW50ciA9IGRwX3JlYWRfYWhiKGNh
dGFsb2csIFJFR19EUF9JTlRSX1NUQVRVUyk7CisJaW50ciAmPSB+RFBfSU5URVJSVVBUX1NUQVRV
UzFfTUFTSzsKKwlpbnRyX2FjayA9IChpbnRyICYgRFBfSU5URVJSVVBUX1NUQVRVUzEpIDw8IERQ
X0lOVEVSUlVQVF9TVEFUVVNfQUNLX1NISUZUOworCWRwX3dyaXRlX2FoYihjYXRhbG9nLCBSRUdf
RFBfSU5UUl9TVEFUVVMsIGludHJfYWNrIHwgRFBfSU5URVJSVVBUX1NUQVRVUzFfTUFTSyk7CisK
KwlyZXR1cm4gaW50cjsKKworfQorCisvKiBjb250cm9sbGVyIHJlbGF0ZWQgY2F0YWxvZyBmdW5j
dGlvbnMgKi8KK3ZvaWQgZHBfY2F0YWxvZ19jdHJsX3VwZGF0ZV90cmFuc2Zlcl91bml0KHN0cnVj
dCBkcF9jYXRhbG9nICpkcF9jYXRhbG9nLAorCQkJCXUzMiBkcF90dSwgdTMyIHZhbGlkX2JvdW5k
YXJ5LCB1MzIgdmFsaWRfYm91bmRhcnkyKQoreworCXN0cnVjdCBkcF9jYXRhbG9nX3ByaXZhdGUg
KmNhdGFsb2cgPSBjb250YWluZXJfb2YoZHBfY2F0YWxvZywKKwkJCQlzdHJ1Y3QgZHBfY2F0YWxv
Z19wcml2YXRlLCBkcF9jYXRhbG9nKTsKKworCWRwX3dyaXRlX2xpbmsoY2F0YWxvZywgUkVHX0RQ
X1ZBTElEX0JPVU5EQVJZLCB2YWxpZF9ib3VuZGFyeSk7CisJZHBfd3JpdGVfbGluayhjYXRhbG9n
LCBSRUdfRFBfVFUsIGRwX3R1KTsKKwlkcF93cml0ZV9saW5rKGNhdGFsb2csIFJFR19EUF9WQUxJ
RF9CT1VOREFSWV8yLCB2YWxpZF9ib3VuZGFyeTIpOworfQorCit2b2lkIGRwX2NhdGFsb2dfY3Ry
bF9zdGF0ZV9jdHJsKHN0cnVjdCBkcF9jYXRhbG9nICpkcF9jYXRhbG9nLCB1MzIgc3RhdGUpCit7
CisJc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0ZSAqY2F0YWxvZyA9IGNvbnRhaW5lcl9vZihkcF9j
YXRhbG9nLAorCQkJCXN0cnVjdCBkcF9jYXRhbG9nX3ByaXZhdGUsIGRwX2NhdGFsb2cpOworCisJ
ZHBfd3JpdGVfbGluayhjYXRhbG9nLCBSRUdfRFBfU1RBVEVfQ1RSTCwgc3RhdGUpOworfQorCit2
b2lkIGRwX2NhdGFsb2dfY3RybF9jb25maWdfY3RybChzdHJ1Y3QgZHBfY2F0YWxvZyAqZHBfY2F0
YWxvZywgdTMyIGNmZykKK3sKKwlzdHJ1Y3QgZHBfY2F0YWxvZ19wcml2YXRlICpjYXRhbG9nID0g
Y29udGFpbmVyX29mKGRwX2NhdGFsb2csCisJCQkJc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0ZSwg
ZHBfY2F0YWxvZyk7CisKKwlEUk1fREVCVUdfRFAoIkRQX0NPTkZJR1VSQVRJT05fQ1RSTD0weCV4
XG4iLCBjZmcpOworCisJZHBfd3JpdGVfbGluayhjYXRhbG9nLCBSRUdfRFBfQ09ORklHVVJBVElP
Tl9DVFJMLCBjZmcpOworfQorCit2b2lkIGRwX2NhdGFsb2dfY3RybF9sYW5lX21hcHBpbmcoc3Ry
dWN0IGRwX2NhdGFsb2cgKmRwX2NhdGFsb2cpCit7CisJc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0
ZSAqY2F0YWxvZyA9IGNvbnRhaW5lcl9vZihkcF9jYXRhbG9nLAorCQkJCXN0cnVjdCBkcF9jYXRh
bG9nX3ByaXZhdGUsIGRwX2NhdGFsb2cpOworCXUzMiBsbl8wID0gMCwgbG5fMSA9IDEsIGxuXzIg
PSAyLCBsbl8zID0gMzsgLyogT25lLXRvLU9uZSBtYXBwaW5nICovCisJdTMyIGxuX21hcHBpbmc7
CisKKwlsbl9tYXBwaW5nID0gbG5fMCA8PCBMQU5FMF9NQVBQSU5HX1NISUZUOworCWxuX21hcHBp
bmcgfD0gbG5fMSA8PCBMQU5FMV9NQVBQSU5HX1NISUZUOworCWxuX21hcHBpbmcgfD0gbG5fMiA8
PCBMQU5FMl9NQVBQSU5HX1NISUZUOworCWxuX21hcHBpbmcgfD0gbG5fMyA8PCBMQU5FM19NQVBQ
SU5HX1NISUZUOworCisJZHBfd3JpdGVfbGluayhjYXRhbG9nLCBSRUdfRFBfTE9HSUNBTDJQSFlT
SUNBTF9MQU5FX01BUFBJTkcsIGxuX21hcHBpbmcpOworfQorCit2b2lkIGRwX2NhdGFsb2dfY3Ry
bF9tYWlubGlua19jdHJsKHN0cnVjdCBkcF9jYXRhbG9nICpkcF9jYXRhbG9nLAorCQkJCQkJYm9v
bCBlbmFibGUpCit7CisJdTMyIG1haW5saW5rX2N0cmw7CisJc3RydWN0IGRwX2NhdGFsb2dfcHJp
dmF0ZSAqY2F0YWxvZyA9IGNvbnRhaW5lcl9vZihkcF9jYXRhbG9nLAorCQkJCXN0cnVjdCBkcF9j
YXRhbG9nX3ByaXZhdGUsIGRwX2NhdGFsb2cpOworCisJaWYgKGVuYWJsZSkgeworCQkvKgorCQkq
IFRvIG1ha2Ugc3VyZSBsaW5rIHJlZyB3cml0ZXMgaGFwcGVucyBiZWZvcmUgYW55IG90aGVyIG9w
ZXJhdGlvbiwKKwkJKiBkcF93cml0ZV9saW5rKCkgZnVuY3Rpb24gdXNlcyB3cml0ZWwoKSBpbnN0
cmVhZCBvZiB3cml0ZWxfcmVsYXhlZCgpCisJCSovCisJCWRwX3dyaXRlX2xpbmsoY2F0YWxvZywg
UkVHX0RQX01BSU5MSU5LX0NUUkwsIERQX01BSU5MSU5LX0ZCX0JPVU5EQVJZX1NFTCk7CisJCWRw
X3dyaXRlX2xpbmsoY2F0YWxvZywgUkVHX0RQX01BSU5MSU5LX0NUUkwsCisJCQkJCURQX01BSU5M
SU5LX0ZCX0JPVU5EQVJZX1NFTCB8IERQX01BSU5MSU5LX0NUUkxfUkVTRVQpOworCQlkcF93cml0
ZV9saW5rKGNhdGFsb2csIFJFR19EUF9NQUlOTElOS19DVFJMLCBEUF9NQUlOTElOS19GQl9CT1VO
REFSWV9TRUwpOworCQlkcF93cml0ZV9saW5rKGNhdGFsb2csIFJFR19EUF9NQUlOTElOS19DVFJM
LAorCQkJCQlEUF9NQUlOTElOS19GQl9CT1VOREFSWV9TRUwgfCBEUF9NQUlOTElOS19DVFJMX0VO
QUJMRSk7CisJfSBlbHNlIHsKKwkJbWFpbmxpbmtfY3RybCA9IGRwX3JlYWRfbGluayhjYXRhbG9n
LCBSRUdfRFBfTUFJTkxJTktfQ1RSTCk7CisJCW1haW5saW5rX2N0cmwgJj0gfkRQX01BSU5MSU5L
X0NUUkxfRU5BQkxFOworCQlkcF93cml0ZV9saW5rKGNhdGFsb2csIFJFR19EUF9NQUlOTElOS19D
VFJMLCBtYWlubGlua19jdHJsKTsKKwl9Cit9CisKK3ZvaWQgZHBfY2F0YWxvZ19jdHJsX2NvbmZp
Z19taXNjKHN0cnVjdCBkcF9jYXRhbG9nICpkcF9jYXRhbG9nLAorCQkJCQl1MzIgY29sb3JpbWV0
cnlfY2ZnLCB1MzIgdGVzdF9iaXRzX2RlcHRoKQoreworCXUzMiBtaXNjX3ZhbDsKKwlzdHJ1Y3Qg
ZHBfY2F0YWxvZ19wcml2YXRlICpjYXRhbG9nID0gY29udGFpbmVyX29mKGRwX2NhdGFsb2csCisJ
CQkJc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0ZSwgZHBfY2F0YWxvZyk7CisKKwltaXNjX3ZhbCA9
IGRwX3JlYWRfbGluayhjYXRhbG9nLCBSRUdfRFBfTUlTQzFfTUlTQzApOworCW1pc2NfdmFsIHw9
IGNvbG9yaW1ldHJ5X2NmZyA8PCBEUF9NSVNDMF9DT0xPUklNRVRSWV9DRkdfU0hJRlQ7CisJbWlz
Y192YWwgfD0gdGVzdF9iaXRzX2RlcHRoIDw8IERQX01JU0MwX1RFU1RfQklUU19ERVBUSF9TSElG
VDsKKwkvKiBDb25maWd1cmUgY2xvY2sgdG8gc3luY2hyb25vdXMgbW9kZSAqLworCW1pc2NfdmFs
IHw9IERQX01JU0MwX1NZTkNIUk9OT1VTX0NMSzsKKworCURSTV9ERUJVR19EUCgibWlzYyBzZXR0
aW5ncyA9IDB4JXhcbiIsIG1pc2NfdmFsKTsKKwlkcF93cml0ZV9saW5rKGNhdGFsb2csIFJFR19E
UF9NSVNDMV9NSVNDMCwgbWlzY192YWwpOworfQorCit2b2lkIGRwX2NhdGFsb2dfY3RybF9jb25m
aWdfbXNhKHN0cnVjdCBkcF9jYXRhbG9nICpkcF9jYXRhbG9nLAorCQkJCQl1MzIgcmF0ZSwgdTMy
IHN0cmVhbV9yYXRlX2toeiwKKwkJCQkJYm9vbCBmaXhlZF9udmlkKQoreworCXUzMiBwaXhlbF9t
LCBwaXhlbF9uOworCXUzMiBtdmlkLCBudmlkOworCXU2NCBtdmlkX2NhbGM7CisJc3RydWN0IGRw
X2NhdGFsb2dfcHJpdmF0ZSAqY2F0YWxvZyA9IGNvbnRhaW5lcl9vZihkcF9jYXRhbG9nLAorCQkJ
CXN0cnVjdCBkcF9jYXRhbG9nX3ByaXZhdGUsIGRwX2NhdGFsb2cpOworCisJaWYgKGZpeGVkX252
aWQpIHsKKwkJbnZpZCA9IERQX0xJTktfQ09OU1RBTlRfTl9WQUxVRTsKKwkJRFJNX0RFQlVHX0RQ
KCJ1c2UgZml4ZWQgTlZJRD0weCV4XG4iLCBudmlkKTsKKworCQkvKgorCQkgKiBGb3IgaW50ZXJt
ZWRpYXRlIHJlc3VsdHMsIHVzZSA2NCBiaXQgYXJpdGhtZXRpYyB0byBhdm9pZAorCQkgKiBsb3Nz
IG9mIHByZWNpc2lvbi4KKwkJICovCisJCW12aWRfY2FsYyA9ICh1NjQpIHN0cmVhbV9yYXRlX2to
eiAqIG52aWQ7CisJCW12aWRfY2FsYyA9IGRpdl91NjQobXZpZF9jYWxjLCByYXRlKTsKKworCQkv
KgorCQkgKiB0cnVuY2F0ZSBiYWNrIHRvIDMyIGJpdHMgYXMgdGhpcyBmaW5hbCBkaXZpZGVkIHZh
bHVlIHdpbGwKKwkJICogYWx3YXlzIGJlIHdpdGhpbiB0aGUgcmFuZ2Ugb2YgYSAzMiBiaXQgdW5z
aWduZWQgaW50LgorCQkgKi8KKwkJbXZpZCA9ICh1MzIpIG12aWRfY2FsYzsKKwkJRFJNX0RFQlVH
X0RQKCJsaW5rIHJhdGU9JWRrYnBzLCBzdHJlYW1fcmF0ZV9raHo9JXVLaHoiLAorCQkJcmF0ZSwg
c3RyZWFtX3JhdGVfa2h6KTsKKwl9IGVsc2UgeworCQlwaXhlbF9tID0gZHBfcmVhZF9jYyhjYXRh
bG9nLCBNTVNTX0RQX1BJWEVMX00pOworCQlwaXhlbF9uID0gZHBfcmVhZF9jYyhjYXRhbG9nLCBN
TVNTX0RQX1BJWEVMX04pOworCQlEUk1fREVCVUdfRFAoInBpeGVsX209MHgleCwgcGl4ZWxfbj0w
eCV4XG4iLCBwaXhlbF9tLCBwaXhlbF9uKTsKKworCQltdmlkID0gKHBpeGVsX20gJiAweEZGRkYp
ICogNTsKKwkJbnZpZCA9ICgweEZGRkYgJiAofnBpeGVsX24pKSArIChwaXhlbF9tICYgMHhGRkZG
KTsKKworCQlEUk1fREVCVUdfRFAoInJhdGUgPSAlZFxuIiwgcmF0ZSk7CisKKwkJc3dpdGNoIChk
cm1fZHBfbGlua19yYXRlX3RvX2J3X2NvZGUocmF0ZSkpIHsKKwkJY2FzZSBEUF9MSU5LX0JXXzVf
NDoKKwkJCW52aWQgKj0gMjsKKwkJCWJyZWFrOworCQljYXNlIERQX0xJTktfQldfOF8xOgorCQkJ
bnZpZCAqPSAzOworCQkJYnJlYWs7CisJCWRlZmF1bHQ6CisJCQlicmVhazsKKwkJfQorCX0KKwor
CURSTV9ERUJVR19EUCgibXZpZD0weCV4LCBudmlkPTB4JXhcbiIsIG12aWQsIG52aWQpOworCWRw
X3dyaXRlX2xpbmsoY2F0YWxvZywgUkVHX0RQX1NPRlRXQVJFX01WSUQsIG12aWQpOworCWRwX3dy
aXRlX2xpbmsoY2F0YWxvZywgUkVHX0RQX1NPRlRXQVJFX05WSUQsIG52aWQpOworfQorCitpbnQg
ZHBfY2F0YWxvZ19jdHJsX3NldF9wYXR0ZXJuKHN0cnVjdCBkcF9jYXRhbG9nICpkcF9jYXRhbG9n
LAorCQkJCQl1MzIgcGF0dGVybikKK3sKKwlpbnQgYml0LCByZXQ7CisJdTMyIGRhdGE7CisJc3Ry
dWN0IGRwX2NhdGFsb2dfcHJpdmF0ZSAqY2F0YWxvZyA9IGNvbnRhaW5lcl9vZihkcF9jYXRhbG9n
LAorCQkJCXN0cnVjdCBkcF9jYXRhbG9nX3ByaXZhdGUsIGRwX2NhdGFsb2cpOworCisJYml0ID0g
QklUKHBhdHRlcm4gLSAxKTsKKwlEUk1fREVCVUdfRFAoImh3OiBiaXQ9JWQgdHJhaW49JWRcbiIs
IGJpdCwgcGF0dGVybik7CisJZHBfd3JpdGVfbGluayhjYXRhbG9nLCBSRUdfRFBfU1RBVEVfQ1RS
TCwgYml0KTsKKworCWJpdCA9IEJJVChwYXR0ZXJuIC0gMSkgPDwgRFBfTUFJTkxJTktfUkVBRFlf
TElOS19UUkFJTklOR19TSElGVDsKKworCS8qIFBvbGwgZm9yIG1haW5saW5rIHJlYWR5IHN0YXR1
cyAqLworCXJldCA9IHJlYWR4X3BvbGxfdGltZW91dChyZWFkbCwgY2F0YWxvZy0+aW8tPmRwX2xp
bmsuYmFzZSArIFJFR19EUF9NQUlOTElOS19SRUFEWSwKKwkJCQkgZGF0YSwgZGF0YSAmIGJpdCwK
KwkJCQkgUE9MTElOR19TTEVFUF9VUywgUE9MTElOR19USU1FT1VUX1VTKTsKKwlpZiAocmV0IDwg
MCkgeworCQlEUk1fRVJST1IoInNldCBwYXR0ZXJuIGZvciBsaW5rX3RyYWluPSVkIGZhaWxlZFxu
IiwgcGF0dGVybik7CisJCXJldHVybiByZXQ7CisJfQorCXJldHVybiAwOworfQorCit2b2lkIGRw
X2NhdGFsb2dfY3RybF91c2JfcmVzZXQoc3RydWN0IGRwX2NhdGFsb2cgKmRwX2NhdGFsb2csIGJv
b2wgZmxpcCkKK3sKKwlzdHJ1Y3QgZHBfY2F0YWxvZ19wcml2YXRlICpjYXRhbG9nID0gY29udGFp
bmVyX29mKGRwX2NhdGFsb2csCisJCQkJc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0ZSwgZHBfY2F0
YWxvZyk7CisJdTMyIHR5cGVjX2N0cmw7CisKKwlkcF93cml0ZV91c2JfY20oY2F0YWxvZywgUkVH
X1VTQjNfRFBfQ09NX1JFU0VUX09WUkRfQ1RSTCwKKwkJCVVTQjNfRFBfQ09NX09WUkRfQ1RSTF9T
V19EUFBIWV9SRVNFVF9NVVggfAorCQkJVVNCM19EUF9DT01fT1ZSRF9DVFJMX1NXX1VTQjNQSFlf
UkVTRVRfTVVYKTsKKwlkcF93cml0ZV91c2JfY20oY2F0YWxvZywgUkVHX1VTQjNfRFBfQ09NX1BI
WV9NT0RFX0NUUkwsCisJCQkJCQlVU0IzX0RQX0NPTV9QSFlfTU9ERV9EUCk7CisJZHBfd3JpdGVf
dXNiX2NtKGNhdGFsb2csIFJFR19VU0IzX0RQX0NPTV9TV19SRVNFVCwKKwkJCQkJCVVTQjNfRFBf
Q09NX1NXX1JFU0VUX1NFVCk7CisKKwkvKiBEZWZhdWx0IGNvbmZpZ3VyYXRpb24gaS5lIENDMSAq
LworCXR5cGVjX2N0cmwgPSBVU0IzX0RQX0NPTV9UWVBFQ19DVFJMX1BPUlRTRUxfTVVYOworCWlm
IChmbGlwKQorCQl0eXBlY19jdHJsIHw9IFVTQjNfRFBfQ09NX1RZUEVDX0NUUkxfUE9SVFNFTDsK
KworCWRwX3dyaXRlX3VzYl9jbShjYXRhbG9nLCBSRUdfVVNCM19EUF9DT01fVFlQRUNfQ1RSTCwg
dHlwZWNfY3RybCk7CisKKwlkcF93cml0ZV91c2JfY20oY2F0YWxvZywgUkVHX1VTQjNfRFBfQ09N
X1NXSV9DVFJMLCAweDAwKTsKKwlkcF93cml0ZV91c2JfY20oY2F0YWxvZywgUkVHX1VTQjNfRFBf
Q09NX1NXX1JFU0VULCAweDAwKTsKKworCWRwX3dyaXRlX3VzYl9jbShjYXRhbG9nLCBSRUdfVVNC
M19EUF9DT01fUE9XRVJfRE9XTl9DVFJMLAorCQkJCQkJVVNCM19EUF9DT01fUE9XRVJfRE9XTl9D
VFJMX1NXX1BXUkROKTsKKwlkcF93cml0ZV91c2JfY20oY2F0YWxvZywgUkVHX1VTQjNfRFBfQ09N
X1JFU0VUX09WUkRfQ1RSTCwgMHgwMCk7CisKK30KKwordm9pZCBkcF9jYXRhbG9nX2N0cmxfcmVz
ZXQoc3RydWN0IGRwX2NhdGFsb2cgKmRwX2NhdGFsb2cpCit7CisJdTMyIHN3X3Jlc2V0OworCXN0
cnVjdCBkcF9jYXRhbG9nX3ByaXZhdGUgKmNhdGFsb2cgPSBjb250YWluZXJfb2YoZHBfY2F0YWxv
ZywKKwkJCQlzdHJ1Y3QgZHBfY2F0YWxvZ19wcml2YXRlLCBkcF9jYXRhbG9nKTsKKwl2b2lkIF9f
aW9tZW0gKmJhc2U7CisKKwliYXNlID0gY2F0YWxvZy0+aW8tPmRwX2FoYi5iYXNlOworCisJc3df
cmVzZXQgPSBkcF9yZWFkX2FoYihjYXRhbG9nLCBSRUdfRFBfU1dfUkVTRVQpOworCisJc3dfcmVz
ZXQgfD0gRFBfU1dfUkVTRVQ7CisJZHBfd3JpdGVfYWhiKGNhdGFsb2csIFJFR19EUF9TV19SRVNF
VCwgc3dfcmVzZXQpOworCXVzbGVlcF9yYW5nZSgxMDAwLCAxMTAwKTsgLyogaC93IHJlY29tbWVu
ZGVkIGRlbGF5ICovCisKKwlzd19yZXNldCAmPSB+RFBfU1dfUkVTRVQ7CisJZHBfd3JpdGVfYWhi
KGNhdGFsb2csIFJFR19EUF9TV19SRVNFVCwgc3dfcmVzZXQpOworfQorCitib29sIGRwX2NhdGFs
b2dfY3RybF9tYWlubGlua19yZWFkeShzdHJ1Y3QgZHBfY2F0YWxvZyAqZHBfY2F0YWxvZykKK3sK
Kwl1MzIgZGF0YTsKKwlpbnQgcmV0OworCXN0cnVjdCBkcF9jYXRhbG9nX3ByaXZhdGUgKmNhdGFs
b2cgPSBjb250YWluZXJfb2YoZHBfY2F0YWxvZywKKwkJCQlzdHJ1Y3QgZHBfY2F0YWxvZ19wcml2
YXRlLCBkcF9jYXRhbG9nKTsKKworCS8qIFBvbGwgZm9yIG1haW5saW5rIHJlYWR5IHN0YXR1cyAq
LworCXJldCA9IHJlYWR4X3BvbGxfdGltZW91dChyZWFkbCwKKwkJCQkgY2F0YWxvZy0+aW8tPmRw
X2xpbmsuYmFzZSArIFJFR19EUF9NQUlOTElOS19SRUFEWSwKKwkJCQkgZGF0YSwgZGF0YSAmIERQ
X01BSU5MSU5LX1JFQURZX0ZPUl9WSURFTywKKwkJCQkgUE9MTElOR19TTEVFUF9VUywgUE9MTElO
R19USU1FT1VUX1VTKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fRVJST1IoIm1haW5saW5rIG5v
dCByZWFkeVxuIik7CisJCXJldHVybiBmYWxzZTsKKwl9CisKKwlyZXR1cm4gdHJ1ZTsKK30KKwor
dm9pZCBkcF9jYXRhbG9nX2N0cmxfZW5hYmxlX2lycShzdHJ1Y3QgZHBfY2F0YWxvZyAqZHBfY2F0
YWxvZywKKwkJCQkJCWJvb2wgZW5hYmxlKQoreworCXN0cnVjdCBkcF9jYXRhbG9nX3ByaXZhdGUg
KmNhdGFsb2cgPSBjb250YWluZXJfb2YoZHBfY2F0YWxvZywKKwkJCQlzdHJ1Y3QgZHBfY2F0YWxv
Z19wcml2YXRlLCBkcF9jYXRhbG9nKTsKKwl2b2lkIF9faW9tZW0gKmJhc2U7CisKKwliYXNlID0g
Y2F0YWxvZy0+aW8tPmRwX2FoYi5iYXNlOworCisJaWYgKGVuYWJsZSkgeworCQlkcF93cml0ZV9h
aGIoY2F0YWxvZywgUkVHX0RQX0lOVFJfU1RBVFVTLCBEUF9JTlRFUlJVUFRfU1RBVFVTMV9NQVNL
KTsKKwkJZHBfd3JpdGVfYWhiKGNhdGFsb2csIFJFR19EUF9JTlRSX1NUQVRVUzIsIERQX0lOVEVS
UlVQVF9TVEFUVVMyX01BU0spOworCX0gZWxzZSB7CisJCWRwX3dyaXRlX2FoYihjYXRhbG9nLCBS
RUdfRFBfSU5UUl9TVEFUVVMsIDB4MDApOworCQlkcF93cml0ZV9haGIoY2F0YWxvZywgUkVHX0RQ
X0lOVFJfU1RBVFVTMiwgMHgwMCk7CisJfQorfQorCit2b2lkIGRwX2NhdGFsb2dfY3RybF9ocGRf
Y29uZmlnKHN0cnVjdCBkcF9jYXRhbG9nICpkcF9jYXRhbG9nLCBib29sIGVuKQoreworCXN0cnVj
dCBkcF9jYXRhbG9nX3ByaXZhdGUgKmNhdGFsb2cgPSBjb250YWluZXJfb2YoZHBfY2F0YWxvZywK
KwkJCQlzdHJ1Y3QgZHBfY2F0YWxvZ19wcml2YXRlLCBkcF9jYXRhbG9nKTsKKworCWlmIChlbikg
eworCQl1MzIgcmVmdGltZXIgPSBkcF9yZWFkX2F1eChjYXRhbG9nLCBSRUdfRFBfRFBfSFBEX1JF
RlRJTUVSKTsKKworCQlkcF93cml0ZV9hdXgoY2F0YWxvZywgUkVHX0RQX0RQX0hQRF9JTlRfQUNL
LAorCQkJCURQX0RQX0hQRF9QTFVHX0lOVF9BQ0sgfCBEUF9EUF9JUlFfSFBEX0lOVF9BQ0sgfAor
CQkJCURQX0RQX0hQRF9SRVBMVUdfSU5UX0FDSyB8IERQX0RQX0hQRF9VTlBMVUdfSU5UX0FDSyk7
CisJCWRwX3dyaXRlX2F1eChjYXRhbG9nLCBSRUdfRFBfRFBfSFBEX0lOVF9NQVNLLAorCQkJCURQ
X0RQX0hQRF9QTFVHX0lOVF9NQVNLIHwgRFBfRFBfSVJRX0hQRF9JTlRfTUFTSyB8CisJCQkJRFBf
RFBfSFBEX1JFUExVR19JTlRfTUFTSyB8IERQX0RQX0hQRF9VTlBMVUdfSU5UX01BU0spOworCisJ
CS8qIENvbmZpZ3VyZSBSRUZUSU1FUiAqLworCQlyZWZ0aW1lciB8PSBSRUZUSU1FUl9ERUZBVUxU
X1ZBTFVFOworCQlkcF93cml0ZV9hdXgoY2F0YWxvZywgUkVHX0RQX0RQX0hQRF9SRUZUSU1FUiwg
cmVmdGltZXIpOworCQkvKiBFbmFibGUgSFBEICovCisJCWRwX3dyaXRlX2F1eChjYXRhbG9nLCBS
RUdfRFBfRFBfSFBEX0NUUkwsIERQX0RQX0hQRF9DVFJMX0hQRF9FTik7CisJfSBlbHNlIHsKKwkJ
LyogRGlzYWJsZSBIUEQgKi8KKwkJZHBfd3JpdGVfYXV4KGNhdGFsb2csIFJFR19EUF9EUF9IUERf
Q1RSTCwgMHgwKTsKKwl9Cit9CisKK2ludCBkcF9jYXRhbG9nX2N0cmxfZ2V0X2ludGVycnVwdChz
dHJ1Y3QgZHBfY2F0YWxvZyAqZHBfY2F0YWxvZykKK3sKKwlzdHJ1Y3QgZHBfY2F0YWxvZ19wcml2
YXRlICpjYXRhbG9nID0gY29udGFpbmVyX29mKGRwX2NhdGFsb2csCisJCQkJc3RydWN0IGRwX2Nh
dGFsb2dfcHJpdmF0ZSwgZHBfY2F0YWxvZyk7CisJdTMyIGludHIsIGludHJfYWNrOworCisJaW50
ciA9IGRwX3JlYWRfYWhiKGNhdGFsb2csIFJFR19EUF9JTlRSX1NUQVRVUzIpOworCWludHIgJj0g
fkRQX0lOVEVSUlVQVF9TVEFUVVMyX01BU0s7CisJaW50cl9hY2sgPSAoaW50ciAmIERQX0lOVEVS
UlVQVF9TVEFUVVMyKSA8PCBEUF9JTlRFUlJVUFRfU1RBVFVTX0FDS19TSElGVDsKKwlkcF93cml0
ZV9haGIoY2F0YWxvZywgUkVHX0RQX0lOVFJfU1RBVFVTMiwgaW50cl9hY2sgfCBEUF9JTlRFUlJV
UFRfU1RBVFVTMl9NQVNLKTsKKworCXJldHVybiBpbnRyOworfQorCit2b2lkIGRwX2NhdGFsb2df
Y3RybF9waHlfcmVzZXQoc3RydWN0IGRwX2NhdGFsb2cgKmRwX2NhdGFsb2cpCit7CisJc3RydWN0
IGRwX2NhdGFsb2dfcHJpdmF0ZSAqY2F0YWxvZyA9IGNvbnRhaW5lcl9vZihkcF9jYXRhbG9nLAor
CQkJCXN0cnVjdCBkcF9jYXRhbG9nX3ByaXZhdGUsIGRwX2NhdGFsb2cpOworCisJZHBfd3JpdGVf
YWhiKGNhdGFsb2csIFJFR19EUF9QSFlfQ1RSTCwKKwkJCURQX1BIWV9DVFJMX1NXX1JFU0VUX1BM
TCB8IERQX1BIWV9DVFJMX1NXX1JFU0VUKTsKKwl1c2xlZXBfcmFuZ2UoMTAwMCwgMTEwMCk7IC8q
IGgvdyByZWNvbW1lbmRlZCBkZWxheSAqLworCWRwX3dyaXRlX2FoYihjYXRhbG9nLCBSRUdfRFBf
UEhZX0NUUkwsIDB4MCk7Cit9CisKK3ZvaWQgZHBfY2F0YWxvZ19jdHJsX3BoeV9sYW5lX2NmZyhz
dHJ1Y3QgZHBfY2F0YWxvZyAqZHBfY2F0YWxvZywKKwkJYm9vbCBmbGlwcGVkLCB1OCBsbl9jbnQp
Cit7CisJdTMyIGluZm87CisJc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0ZSAqY2F0YWxvZyA9IGNv
bnRhaW5lcl9vZihkcF9jYXRhbG9nLAorCQkJCXN0cnVjdCBkcF9jYXRhbG9nX3ByaXZhdGUsIGRw
X2NhdGFsb2cpOworCXU4IG9yaWVudGF0aW9uID0gQklUKCEhZmxpcHBlZCk7CisKKwlpbmZvID0g
bG5fY250ICYgRFBfUEhZX1NQQVJFMF9NQVNLOworCWluZm8gfD0gKG9yaWVudGF0aW9uICYgRFBf
UEhZX1NQQVJFMF9NQVNLKSA8PCBEUF9QSFlfU1BBUkUwX09SSUVOVEFUSU9OX0lORk9fU0hJRlQ7
CisJRFJNX0RFQlVHX0RQKCJTaGFyZWQgSW5mbyA9IDB4JXhcbiIsIGluZm8pOworCisJZHBfd3Jp
dGVfcGh5KGNhdGFsb2csIFJFR19EUF9QSFlfU1BBUkUwLCBpbmZvKTsKK30KKworaW50IGRwX2Nh
dGFsb2dfY3RybF91cGRhdGVfdnhfcHgoc3RydWN0IGRwX2NhdGFsb2cgKmRwX2NhdGFsb2csCisJ
CXU4IHZfbGV2ZWwsIHU4IHBfbGV2ZWwpCit7CisJc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0ZSAq
Y2F0YWxvZyA9IGNvbnRhaW5lcl9vZihkcF9jYXRhbG9nLAorCQkJCXN0cnVjdCBkcF9jYXRhbG9n
X3ByaXZhdGUsIGRwX2NhdGFsb2cpOworCXU4IHZvbHRhZ2Vfc3dpbmdfY2ZnLCBwcmVfZW1waGFz
aXNfY2ZnOworCisJRFJNX0RFQlVHX0RQKCJodzogdj0lZCBwPSVkXG4iLCB2X2xldmVsLCBwX2xl
dmVsKTsKKworCXZvbHRhZ2Vfc3dpbmdfY2ZnID0gdm1fdm9sdGFnZV9zd2luZ1t2X2xldmVsXVtw
X2xldmVsXTsKKwlwcmVfZW1waGFzaXNfY2ZnID0gdm1fcHJlX2VtcGhhc2lzW3ZfbGV2ZWxdW3Bf
bGV2ZWxdOworCisJaWYgKHZvbHRhZ2Vfc3dpbmdfY2ZnID09IDB4RkYgJiYgcHJlX2VtcGhhc2lz
X2NmZyA9PSAweEZGKSB7CisJCURSTV9FUlJPUigiaW52YWxpZCB2eCAoMHgleD0weCV4KSwgcHgg
KDB4JXg9MHgleFxuIiwKKwkJCXZfbGV2ZWwsIHZvbHRhZ2Vfc3dpbmdfY2ZnLCBwX2xldmVsLCBw
cmVfZW1waGFzaXNfY2ZnKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJLyogRW5hYmxlIE1V
WCB0byB1c2UgQ3Vyc29yIHZhbHVlcyBmcm9tIHRoZXNlIHJlZ2lzdGVycyAqLworCXZvbHRhZ2Vf
c3dpbmdfY2ZnIHw9IERQX1BIWV9UWG5fVFhfRFJWX0xWTF9NVVhfRU47CisJcHJlX2VtcGhhc2lz
X2NmZyB8PSBEUF9QSFlfVFhuX1RYX0VNUF9QT1NUMV9MVkxfTVVYX0VOOworCisJLyogQ29uZmln
dXJlIGhvc3QgYW5kIHBhbmVsIG9ubHkgaWYgYm90aCB2YWx1ZXMgYXJlIGFsbG93ZWQgKi8KKwlk
cF93cml0ZV9sbl90eDAoY2F0YWxvZywgUkVHX0RQX1BIWV9UWG5fVFhfRFJWX0xWTCwgdm9sdGFn
ZV9zd2luZ19jZmcpOworCWRwX3dyaXRlX2xuX3R4MShjYXRhbG9nLCBSRUdfRFBfUEhZX1RYbl9U
WF9EUlZfTFZMLCB2b2x0YWdlX3N3aW5nX2NmZyk7CisJZHBfd3JpdGVfbG5fdHgwKGNhdGFsb2cs
IFJFR19EUF9QSFlfVFhuX1RYX0VNUF9QT1NUMV9MVkwsIHByZV9lbXBoYXNpc19jZmcpOworCWRw
X3dyaXRlX2xuX3R4MShjYXRhbG9nLCBSRUdfRFBfUEhZX1RYbl9UWF9FTVBfUE9TVDFfTFZMLCBw
cmVfZW1waGFzaXNfY2ZnKTsKKwlEUk1fREVCVUdfRFAoImh3OiB2eF92YWx1ZT0weCV4IHB4X3Zh
bHVlPTB4JXhcbiIsCisJCQl2b2x0YWdlX3N3aW5nX2NmZywgcHJlX2VtcGhhc2lzX2NmZyk7CisK
KwlyZXR1cm4gMDsKK30KKwordm9pZCBkcF9jYXRhbG9nX2N0cmxfc2VuZF9waHlfcGF0dGVybihz
dHJ1Y3QgZHBfY2F0YWxvZyAqZHBfY2F0YWxvZywKKwkJCXUzMiBwYXR0ZXJuKQoreworCXN0cnVj
dCBkcF9jYXRhbG9nX3ByaXZhdGUgKmNhdGFsb2cgPSBjb250YWluZXJfb2YoZHBfY2F0YWxvZywK
KwkJCQlzdHJ1Y3QgZHBfY2F0YWxvZ19wcml2YXRlLCBkcF9jYXRhbG9nKTsKKwl1MzIgdmFsdWUg
PSAweDA7CisKKwkvKiBNYWtlIHN1cmUgdG8gY2xlYXIgdGhlIGN1cnJlbnQgcGF0dGVybiBiZWZv
cmUgc3RhcnRpbmcgYSBuZXcgb25lICovCisJZHBfd3JpdGVfbGluayhjYXRhbG9nLCBSRUdfRFBf
U1RBVEVfQ1RSTCwgMHgwKTsKKworCXN3aXRjaCAocGF0dGVybikgeworCWNhc2UgRFBfTElOS19R
VUFMX1BBVFRFUk5fRDEwXzI6CisJCWRwX3dyaXRlX2xpbmsoY2F0YWxvZywgUkVHX0RQX1NUQVRF
X0NUUkwsIERQX1NUQVRFX0NUUkxfTElOS19UUkFJTklOR19QQVRURVJOMSk7CisJCXJldHVybjsK
KwljYXNlIERQX0xJTktfUVVBTF9QQVRURVJOX1BSQlM3OgorCQlkcF93cml0ZV9saW5rKGNhdGFs
b2csIFJFR19EUF9TVEFURV9DVFJMLCBEUF9TVEFURV9DVFJMX0xJTktfUFJCUzcpOworCQlyZXR1
cm47CisJY2FzZSBEUF9MSU5LX1FVQUxfUEFUVEVSTl84MEJJVF9DVVNUT006CisJCWRwX3dyaXRl
X2xpbmsoY2F0YWxvZywgUkVHX0RQX1NUQVRFX0NUUkwsIERQX1NUQVRFX0NUUkxfTElOS19URVNU
X0NVU1RPTV9QQVRURVJOKTsKKwkJLyogMDAxMTExMTAwMDAwMTExMTEwMDAwMDExMTExMDAwMDAg
Ki8KKwkJZHBfd3JpdGVfbGluayhjYXRhbG9nLCBSRUdfRFBfVEVTVF84MEJJVF9DVVNUT01fUEFU
VEVSTl9SRUcwLCAweDNFMEY4M0UwKTsKKwkJLyogMDAwMDExMTExMDAwMDAxMTExMTAwMDAwMTEx
MTEwMDAgKi8KKwkJZHBfd3JpdGVfbGluayhjYXRhbG9nLCBSRUdfRFBfVEVTVF84MEJJVF9DVVNU
T01fUEFUVEVSTl9SRUcxLCAweDBGODNFMEY4KTsKKwkJLyogMTExMTEwMDAwMDExMTExMCAqLwor
CQlkcF93cml0ZV9saW5rKGNhdGFsb2csIFJFR19EUF9URVNUXzgwQklUX0NVU1RPTV9QQVRURVJO
X1JFRzIsIDB4MDAwMEY4M0UpOworCQlyZXR1cm47CisJY2FzZSBEUF9MSU5LX1FVQUxfUEFUVEVS
Tl9IQlIyX0VZRToKKwljYXNlIERQX0xJTktfUVVBTF9QQVRURVJOX0VSUk9SX1JBVEU6CisJCXZh
bHVlICY9IH5EUF9IQlIyX0VSTV9QQVRURVJOOworCQlpZiAocGF0dGVybiA9PSBEUF9MSU5LX1FV
QUxfUEFUVEVSTl9IQlIyX0VZRSkKKwkJCXZhbHVlID0gRFBfSEJSMl9FUk1fUEFUVEVSTjsKKwkJ
ZHBfd3JpdGVfbGluayhjYXRhbG9nLCBSRUdfRFBfSEJSMl9DT01QTElBTkNFX1NDUkFNQkxFUl9S
RVNFVCwgdmFsdWUpOworCQl2YWx1ZSB8PSBTQ1JBTUJMRVJfUkVTRVRfQ09VTlRfVkFMVUU7CisJ
CWRwX3dyaXRlX2xpbmsoY2F0YWxvZywgUkVHX0RQX0hCUjJfQ09NUExJQU5DRV9TQ1JBTUJMRVJf
UkVTRVQsIHZhbHVlKTsKKwkJZHBfd3JpdGVfbGluayhjYXRhbG9nLCBSRUdfRFBfTUFJTkxJTktf
TEVWRUxTLCBEUF9NQUlOTElOS19TQUZFX1RPX0VYSVRfTEVWRUxfMik7CisJCWRwX3dyaXRlX2xp
bmsoY2F0YWxvZywgUkVHX0RQX1NUQVRFX0NUUkwsIERQX1NUQVRFX0NUUkxfTElOS19TWU1CT0xf
RVJSX01FQVNVUkUpOworCQlyZXR1cm47CisJZGVmYXVsdDoKKwkJRFJNX0RFQlVHX0RQKCJObyB2
YWxpZCB0ZXN0IHBhdHRlcm4gcmVxdWVzdGVkOiAweCV4XG4iLCBwYXR0ZXJuKTsKKwkJcmV0dXJu
OworCX0KK30KKwordTMyIGRwX2NhdGFsb2dfY3RybF9yZWFkX3BoeV9wYXR0ZXJuKHN0cnVjdCBk
cF9jYXRhbG9nICpkcF9jYXRhbG9nKQoreworCXN0cnVjdCBkcF9jYXRhbG9nX3ByaXZhdGUgKmNh
dGFsb2cgPSBjb250YWluZXJfb2YoZHBfY2F0YWxvZywKKwkJCQlzdHJ1Y3QgZHBfY2F0YWxvZ19w
cml2YXRlLCBkcF9jYXRhbG9nKTsKKworCXJldHVybiBkcF9yZWFkX2xpbmsoY2F0YWxvZywgUkVH
X0RQX01BSU5MSU5LX1JFQURZKTsKK30KKworLyogcGFuZWwgcmVsYXRlZCBjYXRhbG9nIGZ1bmN0
aW9ucyAqLworaW50IGRwX2NhdGFsb2dfcGFuZWxfdGltaW5nX2NmZyhzdHJ1Y3QgZHBfY2F0YWxv
ZyAqZHBfY2F0YWxvZykKK3sKKwlzdHJ1Y3QgZHBfY2F0YWxvZ19wcml2YXRlICpjYXRhbG9nID0g
Y29udGFpbmVyX29mKGRwX2NhdGFsb2csCisJCQkJc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0ZSwg
ZHBfY2F0YWxvZyk7CisKKwlkcF93cml0ZV9saW5rKGNhdGFsb2csIFJFR19EUF9UT1RBTF9IT1Jf
VkVSLCBkcF9jYXRhbG9nLT50b3RhbCk7CisJZHBfd3JpdGVfbGluayhjYXRhbG9nLCBSRUdfRFBf
U1RBUlRfSE9SX1ZFUl9GUk9NX1NZTkMsIGRwX2NhdGFsb2ctPnN5bmNfc3RhcnQpOworCWRwX3dy
aXRlX2xpbmsoY2F0YWxvZywgUkVHX0RQX0hTWU5DX1ZTWU5DX1dJRFRIX1BPTEFSSVRZLCBkcF9j
YXRhbG9nLT53aWR0aF9ibGFua2luZyk7CisJZHBfd3JpdGVfbGluayhjYXRhbG9nLCBSRUdfRFBf
QUNUSVZFX0hPUl9WRVIsIGRwX2NhdGFsb2ctPmRwX2FjdGl2ZSk7CisJcmV0dXJuIDA7Cit9CisK
K3ZvaWQgZHBfY2F0YWxvZ19wYW5lbF90cGdfZW5hYmxlKHN0cnVjdCBkcF9jYXRhbG9nICpkcF9j
YXRhbG9nLAorCQkJCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICpkcm1fbW9kZSkKK3sKKwlzdHJ1
Y3QgZHBfY2F0YWxvZ19wcml2YXRlICpjYXRhbG9nID0gY29udGFpbmVyX29mKGRwX2NhdGFsb2cs
CisJCQkJc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0ZSwgZHBfY2F0YWxvZyk7CisJdTMyIGhzeW5j
X3BlcmlvZCwgdnN5bmNfcGVyaW9kOworCXUzMiBkaXNwbGF5X3Zfc3RhcnQsIGRpc3BsYXlfdl9l
bmQ7CisJdTMyIGhzeW5jX3N0YXJ0X3gsIGhzeW5jX2VuZF94OworCXUzMiB2X3N5bmNfd2lkdGg7
CisJdTMyIGhzeW5jX2N0bDsKKwl1MzIgZGlzcGxheV9oY3RsOworCisJLyogVFBHIGNvbmZpZyBw
YXJhbWV0ZXJzKi8KKwloc3luY19wZXJpb2QgPSBkcm1fbW9kZS0+aHRvdGFsOworCXZzeW5jX3Bl
cmlvZCA9IGRybV9tb2RlLT52dG90YWw7CisKKwlkaXNwbGF5X3Zfc3RhcnQgPSAoKGRybV9tb2Rl
LT52dG90YWwgLSBkcm1fbW9kZS0+dnN5bmNfc3RhcnQpICoKKwkJCQkJaHN5bmNfcGVyaW9kKTsK
KwlkaXNwbGF5X3ZfZW5kID0gKCh2c3luY19wZXJpb2QgLSBkcm1fbW9kZS0+dnN5bmNfc3RhcnQg
LQorCQkJCQlkcm1fbW9kZS0+dmRpc3BsYXkpICogaHN5bmNfcGVyaW9kKSAtIDE7CisKKwlkaXNw
bGF5X3Zfc3RhcnQgKz0gZHJtX21vZGUtPmh0b3RhbCAtIGRybV9tb2RlLT5oc3luY19zdGFydDsK
KwlkaXNwbGF5X3ZfZW5kIC09IGRybV9tb2RlLT5oc3luY19zdGFydCAtIGRybV9tb2RlLT5oZGlz
cGxheTsKKworCWhzeW5jX3N0YXJ0X3ggPSBkcm1fbW9kZS0+aHRvdGFsIC0gZHJtX21vZGUtPmhz
eW5jX3N0YXJ0OworCWhzeW5jX2VuZF94ID0gaHN5bmNfcGVyaW9kIC0gZHJtX21vZGUtPmhzeW5j
X3N0YXJ0IC0KKwkJCQkJZHJtX21vZGUtPmhkaXNwbGF5IC0gMTsKKworCXZfc3luY193aWR0aCA9
IGRybV9tb2RlLT52c3luY19lbmQgLSBkcm1fbW9kZS0+dnN5bmNfc3RhcnQ7CisKKwloc3luY19j
dGwgPSAoaHN5bmNfcGVyaW9kIDw8IDE2KSB8CisJCQkoZHJtX21vZGUtPmhzeW5jX2VuZCAtIGRy
bV9tb2RlLT5oc3luY19zdGFydCk7CisJZGlzcGxheV9oY3RsID0gKGhzeW5jX2VuZF94IDw8IDE2
KSB8IGhzeW5jX3N0YXJ0X3g7CisKKworCWRwX3dyaXRlX3AwKGNhdGFsb2csIE1NU1NfRFBfSU5U
Rl9DT05GSUcsIDB4MCk7CisJZHBfd3JpdGVfcDAoY2F0YWxvZywgTU1TU19EUF9JTlRGX0hTWU5D
X0NUTCwgaHN5bmNfY3RsKTsKKwlkcF93cml0ZV9wMChjYXRhbG9nLCBNTVNTX0RQX0lOVEZfVlNZ
TkNfUEVSSU9EX0YwLCB2c3luY19wZXJpb2QgKgorCQkJaHN5bmNfcGVyaW9kKTsKKwlkcF93cml0
ZV9wMChjYXRhbG9nLCBNTVNTX0RQX0lOVEZfVlNZTkNfUFVMU0VfV0lEVEhfRjAsIHZfc3luY193
aWR0aCAqCisJCQloc3luY19wZXJpb2QpOworCWRwX3dyaXRlX3AwKGNhdGFsb2csIE1NU1NfRFBf
SU5URl9WU1lOQ19QRVJJT0RfRjEsIDApOworCWRwX3dyaXRlX3AwKGNhdGFsb2csIE1NU1NfRFBf
SU5URl9WU1lOQ19QVUxTRV9XSURUSF9GMSwgMCk7CisJZHBfd3JpdGVfcDAoY2F0YWxvZywgTU1T
U19EUF9JTlRGX0RJU1BMQVlfSENUTCwgZGlzcGxheV9oY3RsKTsKKwlkcF93cml0ZV9wMChjYXRh
bG9nLCBNTVNTX0RQX0lOVEZfQUNUSVZFX0hDVEwsIDApOworCWRwX3dyaXRlX3AwKGNhdGFsb2cs
IE1NU1NfSU5URl9ESVNQTEFZX1ZfU1RBUlRfRjAsIGRpc3BsYXlfdl9zdGFydCk7CisJZHBfd3Jp
dGVfcDAoY2F0YWxvZywgTU1TU19EUF9JTlRGX0RJU1BMQVlfVl9FTkRfRjAsIGRpc3BsYXlfdl9l
bmQpOworCWRwX3dyaXRlX3AwKGNhdGFsb2csIE1NU1NfSU5URl9ESVNQTEFZX1ZfU1RBUlRfRjEs
IDApOworCWRwX3dyaXRlX3AwKGNhdGFsb2csIE1NU1NfRFBfSU5URl9ESVNQTEFZX1ZfRU5EX0Yx
LCAwKTsKKwlkcF93cml0ZV9wMChjYXRhbG9nLCBNTVNTX0RQX0lOVEZfQUNUSVZFX1ZfU1RBUlRf
RjAsIDApOworCWRwX3dyaXRlX3AwKGNhdGFsb2csIE1NU1NfRFBfSU5URl9BQ1RJVkVfVl9FTkRf
RjAsIDApOworCWRwX3dyaXRlX3AwKGNhdGFsb2csIE1NU1NfRFBfSU5URl9BQ1RJVkVfVl9TVEFS
VF9GMSwgMCk7CisJZHBfd3JpdGVfcDAoY2F0YWxvZywgTU1TU19EUF9JTlRGX0FDVElWRV9WX0VO
RF9GMSwgMCk7CisJZHBfd3JpdGVfcDAoY2F0YWxvZywgTU1TU19EUF9JTlRGX1BPTEFSSVRZX0NU
TCwgMCk7CisKKwlkcF93cml0ZV9wMChjYXRhbG9nLCBNTVNTX0RQX1RQR19NQUlOX0NPTlRST0ws
IERQX1RQR19DSEVDS0VSRURfUkVDVF9QQVRURVJOKTsKKwlkcF93cml0ZV9wMChjYXRhbG9nLCBN
TVNTX0RQX1RQR19WSURFT19DT05GSUcsCisJCQkJCURQX1RQR19WSURFT19DT05GSUdfQlBQXzhC
SVQgfAorCQkJCQlEUF9UUEdfVklERU9fQ09ORklHX1JHQik7CisJZHBfd3JpdGVfcDAoY2F0YWxv
ZywgTU1TU19EUF9CSVNUX0VOQUJMRSwgRFBfQklTVF9FTkFCTEVfRFBCSVNUX0VOKTsKKwlkcF93
cml0ZV9wMChjYXRhbG9nLCBNTVNTX0RQX1RJTUlOR19FTkdJTkVfRU4sIERQX1RJTUlOR19FTkdJ
TkVfRU5fRU4pOworCURSTV9ERUJVR19EUCgiJXM6IGVuYWJsZWQgdHBnXG4iLCBfX2Z1bmNfXyk7
Cit9CisKK3ZvaWQgZHBfY2F0YWxvZ19wYW5lbF90cGdfZGlzYWJsZShzdHJ1Y3QgZHBfY2F0YWxv
ZyAqZHBfY2F0YWxvZykKK3sKKwlzdHJ1Y3QgZHBfY2F0YWxvZ19wcml2YXRlICpjYXRhbG9nID0g
Y29udGFpbmVyX29mKGRwX2NhdGFsb2csCisJCQkJc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0ZSwg
ZHBfY2F0YWxvZyk7CisKKwlkcF93cml0ZV9wMChjYXRhbG9nLCBNTVNTX0RQX1RQR19NQUlOX0NP
TlRST0wsIDB4MCk7CisJZHBfd3JpdGVfcDAoY2F0YWxvZywgTU1TU19EUF9CSVNUX0VOQUJMRSwg
MHgwKTsKKwlkcF93cml0ZV9wMChjYXRhbG9nLCBNTVNTX0RQX1RJTUlOR19FTkdJTkVfRU4sIDB4
MCk7CisJcmV0dXJuOworfQorCitzdHJ1Y3QgZHBfY2F0YWxvZyAqZHBfY2F0YWxvZ19nZXQoc3Ry
dWN0IGRldmljZSAqZGV2LCBzdHJ1Y3QgZHBfaW8gKmlvKQoreworCWludCByYyA9IDA7CisJc3Ry
dWN0IGRwX2NhdGFsb2cgKmRwX2NhdGFsb2c7CisJc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0ZSAq
Y2F0YWxvZzsKKworCWlmICghaW8pIHsKKwkJRFJNX0VSUk9SKCJpbnZhbGlkIGlucHV0XG4iKTsK
KwkJcmMgPSAtRUlOVkFMOworCQlnb3RvIGVycm9yOworCX0KKworCWNhdGFsb2cgID0gZGV2bV9r
emFsbG9jKGRldiwgc2l6ZW9mKCpjYXRhbG9nKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFjYXRhbG9n
KSB7CisJCXJjID0gLUVOT01FTTsKKwkJZ290byBlcnJvcjsKKwl9CisKKwljYXRhbG9nLT5kZXYg
PSBkZXY7CisJY2F0YWxvZy0+aW8gPSBpbzsKKworCWRwX2NhdGFsb2cgPSAmY2F0YWxvZy0+ZHBf
Y2F0YWxvZzsKKworCXJldHVybiBkcF9jYXRhbG9nOworZXJyb3I6CisJcmV0dXJuIEVSUl9QVFIo
cmMpOworfQorCit2b2lkIGRwX2NhdGFsb2dfcHV0KHN0cnVjdCBkcF9jYXRhbG9nICpkcF9jYXRh
bG9nKQoreworCXN0cnVjdCBkcF9jYXRhbG9nX3ByaXZhdGUgKmNhdGFsb2c7CisKKwlpZiAoIWRw
X2NhdGFsb2cpCisJCXJldHVybjsKKworCWNhdGFsb2cgPSBjb250YWluZXJfb2YoZHBfY2F0YWxv
Zywgc3RydWN0IGRwX2NhdGFsb2dfcHJpdmF0ZSwKKwkJCQlkcF9jYXRhbG9nKTsKKworCWRldm1f
a2ZyZWUoY2F0YWxvZy0+ZGV2LCBjYXRhbG9nKTsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9tc20vZHAvZHBfY2F0YWxvZy5oIGIvZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9jYXRh
bG9nLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uNTFjODJkZAotLS0gL2Rl
di9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfY2F0YWxvZy5oCkBAIC0wLDAg
KzEsODQgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkgKi8KKy8q
CisgKiBDb3B5cmlnaHQgKGMpIDIwMTctMjAxOSwgVGhlIExpbnV4IEZvdW5kYXRpb24uIEFsbCBy
aWdodHMgcmVzZXJ2ZWQuCisgKi8KKworI2lmbmRlZiBfRFBfQ0FUQUxPR19IXworI2RlZmluZSBf
RFBfQ0FUQUxPR19IXworCisjaW5jbHVkZSAiZHBfcGFyc2VyLmgiCisKKy8qIGludGVycnVwdHMg
Ki8KKyNkZWZpbmUgRFBfSU5UUl9IUEQJCUJJVCgwKQorI2RlZmluZSBEUF9JTlRSX0FVWF9JMkNf
RE9ORQlCSVQoMykKKyNkZWZpbmUgRFBfSU5UUl9XUk9OR19BRERSCUJJVCg2KQorI2RlZmluZSBE
UF9JTlRSX1RJTUVPVVQJCUJJVCg5KQorI2RlZmluZSBEUF9JTlRSX05BQ0tfREVGRVIJQklUKDEy
KQorI2RlZmluZSBEUF9JTlRSX1dST05HX0RBVEFfQ05UCUJJVCgxNSkKKyNkZWZpbmUgRFBfSU5U
Ul9JMkNfTkFDSwlCSVQoMTgpCisjZGVmaW5lIERQX0lOVFJfSTJDX0RFRkVSCUJJVCgyMSkKKyNk
ZWZpbmUgRFBfSU5UUl9QTExfVU5MT0NLRUQJQklUKDI0KQorI2RlZmluZSBEUF9JTlRSX0FVWF9F
UlJPUglCSVQoMjcpCisKKyNkZWZpbmUgRFBfSU5UUl9SRUFEWV9GT1JfVklERU8JCUJJVCgwKQor
I2RlZmluZSBEUF9JTlRSX0lETEVfUEFUVEVSTl9TRU5UCUJJVCgzKQorI2RlZmluZSBEUF9JTlRS
X0ZSQU1FX0VORAkJQklUKDYpCisjZGVmaW5lIERQX0lOVFJfQ1JDX1VQREFURUQJCUJJVCg5KQor
CitzdHJ1Y3QgZHBfY2F0YWxvZyB7CisJdTMyIGF1eF9kYXRhOworCXUzMiB0b3RhbDsKKwl1MzIg
c3luY19zdGFydDsKKwl1MzIgd2lkdGhfYmxhbmtpbmc7CisJdTMyIGRwX2FjdGl2ZTsKK307CisK
Ky8qIEFVWCBBUElzICovCit1MzIgZHBfY2F0YWxvZ19hdXhfcmVhZF9kYXRhKHN0cnVjdCBkcF9j
YXRhbG9nICpkcF9jYXRhbG9nKTsKK2ludCBkcF9jYXRhbG9nX2F1eF93cml0ZV9kYXRhKHN0cnVj
dCBkcF9jYXRhbG9nICpkcF9jYXRhbG9nKTsKK2ludCBkcF9jYXRhbG9nX2F1eF93cml0ZV90cmFu
cyhzdHJ1Y3QgZHBfY2F0YWxvZyAqZHBfY2F0YWxvZyk7CitpbnQgZHBfY2F0YWxvZ19hdXhfY2xl
YXJfdHJhbnMoc3RydWN0IGRwX2NhdGFsb2cgKmRwX2NhdGFsb2csIGJvb2wgcmVhZCk7Cit2b2lk
IGRwX2NhdGFsb2dfYXV4X3Jlc2V0KHN0cnVjdCBkcF9jYXRhbG9nICpkcF9jYXRhbG9nKTsKK3Zv
aWQgZHBfY2F0YWxvZ19hdXhfZW5hYmxlKHN0cnVjdCBkcF9jYXRhbG9nICpkcF9jYXRhbG9nLCBi
b29sIGVuYWJsZSk7Cit2b2lkIGRwX2NhdGFsb2dfYXV4X3VwZGF0ZV9jZmcoc3RydWN0IGRwX2Nh
dGFsb2cgKmRwX2NhdGFsb2csCisJCQlzdHJ1Y3QgZHBfYXV4X2NmZyAqY2ZnLCBlbnVtIGRwX3Bo
eV9hdXhfY29uZmlnX3R5cGUgdHlwZSk7Cit2b2lkIGRwX2NhdGFsb2dfYXV4X3NldHVwKHN0cnVj
dCBkcF9jYXRhbG9nICpkcF9jYXRhbG9nLAorCQkJc3RydWN0IGRwX2F1eF9jZmcgKmF1eF9jZmcp
OworaW50IGRwX2NhdGFsb2dfYXV4X2dldF9pcnEoc3RydWN0IGRwX2NhdGFsb2cgKmRwX2NhdGFs
b2cpOworCisvKiBEUCBDb250cm9sbGVyIEFQSXMgKi8KK3ZvaWQgZHBfY2F0YWxvZ19jdHJsX3N0
YXRlX2N0cmwoc3RydWN0IGRwX2NhdGFsb2cgKmRwX2NhdGFsb2csIHUzMiBzdGF0ZSk7Cit2b2lk
IGRwX2NhdGFsb2dfY3RybF9jb25maWdfY3RybChzdHJ1Y3QgZHBfY2F0YWxvZyAqZHBfY2F0YWxv
ZywgdTMyIGNvbmZpZyk7Cit2b2lkIGRwX2NhdGFsb2dfY3RybF9sYW5lX21hcHBpbmcoc3RydWN0
IGRwX2NhdGFsb2cgKmRwX2NhdGFsb2cpOwordm9pZCBkcF9jYXRhbG9nX2N0cmxfbWFpbmxpbmtf
Y3RybChzdHJ1Y3QgZHBfY2F0YWxvZyAqZHBfY2F0YWxvZywgYm9vbCBlbmFibGUpOwordm9pZCBk
cF9jYXRhbG9nX2N0cmxfY29uZmlnX21pc2Moc3RydWN0IGRwX2NhdGFsb2cgKmRwX2NhdGFsb2cs
IHUzMiBjYywgdTMyIHRiKTsKK3ZvaWQgZHBfY2F0YWxvZ19jdHJsX2NvbmZpZ19tc2Eoc3RydWN0
IGRwX2NhdGFsb2cgKmRwX2NhdGFsb2csIHUzMiByYXRlLAorCQkJCXUzMiBzdHJlYW1fcmF0ZV9r
aHosIGJvb2wgZml4ZWRfbnZpZCk7CitpbnQgZHBfY2F0YWxvZ19jdHJsX3NldF9wYXR0ZXJuKHN0
cnVjdCBkcF9jYXRhbG9nICpkcF9jYXRhbG9nLCB1MzIgcGF0dGVybik7Cit2b2lkIGRwX2NhdGFs
b2dfY3RybF9yZXNldChzdHJ1Y3QgZHBfY2F0YWxvZyAqZHBfY2F0YWxvZyk7Cit2b2lkIGRwX2Nh
dGFsb2dfY3RybF91c2JfcmVzZXQoc3RydWN0IGRwX2NhdGFsb2cgKmRwX2NhdGFsb2csIGJvb2wg
ZmxpcCk7Citib29sIGRwX2NhdGFsb2dfY3RybF9tYWlubGlua19yZWFkeShzdHJ1Y3QgZHBfY2F0
YWxvZyAqZHBfY2F0YWxvZyk7Cit2b2lkIGRwX2NhdGFsb2dfY3RybF9lbmFibGVfaXJxKHN0cnVj
dCBkcF9jYXRhbG9nICpkcF9jYXRhbG9nLCBib29sIGVuYWJsZSk7Cit2b2lkIGRwX2NhdGFsb2df
Y3RybF9ocGRfY29uZmlnKHN0cnVjdCBkcF9jYXRhbG9nICpkcF9jYXRhbG9nLCBib29sIGVuYWJs
ZSk7Cit2b2lkIGRwX2NhdGFsb2dfY3RybF9waHlfcmVzZXQoc3RydWN0IGRwX2NhdGFsb2cgKmRw
X2NhdGFsb2cpOwordm9pZCBkcF9jYXRhbG9nX2N0cmxfcGh5X2xhbmVfY2ZnKHN0cnVjdCBkcF9j
YXRhbG9nICpkcF9jYXRhbG9nLCBib29sIGZsaXBwZWQsCisJCQkJdTggbGFuZV9jbnQpOworaW50
IGRwX2NhdGFsb2dfY3RybF91cGRhdGVfdnhfcHgoc3RydWN0IGRwX2NhdGFsb2cgKmRwX2NhdGFs
b2csIHU4IHZfbGV2ZWwsCisJCQkJdTggcF9sZXZlbCk7CitpbnQgZHBfY2F0YWxvZ19jdHJsX2dl
dF9pbnRlcnJ1cHQoc3RydWN0IGRwX2NhdGFsb2cgKmRwX2NhdGFsb2cpOwordm9pZCBkcF9jYXRh
bG9nX2N0cmxfdXBkYXRlX3RyYW5zZmVyX3VuaXQoc3RydWN0IGRwX2NhdGFsb2cgKmRwX2NhdGFs
b2csCisJCQkJdTMyIGRwX3R1LCB1MzIgdmFsaWRfYm91bmRhcnksIHUzMiB2YWxpZF9ib3VuZGFy
eTIpOwordm9pZCBkcF9jYXRhbG9nX2N0cmxfc2VuZF9waHlfcGF0dGVybihzdHJ1Y3QgZHBfY2F0
YWxvZyAqZHBfY2F0YWxvZywKKwkJCQl1MzIgcGF0dGVybik7Cit1MzIgZHBfY2F0YWxvZ19jdHJs
X3JlYWRfcGh5X3BhdHRlcm4oc3RydWN0IGRwX2NhdGFsb2cgKmRwX2NhdGFsb2cpOworCisvKiBE
UCBQYW5lbCBBUElzICovCitpbnQgZHBfY2F0YWxvZ19wYW5lbF90aW1pbmdfY2ZnKHN0cnVjdCBk
cF9jYXRhbG9nICpkcF9jYXRhbG9nKTsKK3ZvaWQgZHBfY2F0YWxvZ19wYW5lbF90cGdfZW5hYmxl
KHN0cnVjdCBkcF9jYXRhbG9nICpkcF9jYXRhbG9nLAorCQkJCXN0cnVjdCBkcm1fZGlzcGxheV9t
b2RlICpkcm1fbW9kZSk7Cit2b2lkIGRwX2NhdGFsb2dfcGFuZWxfdHBnX2Rpc2FibGUoc3RydWN0
IGRwX2NhdGFsb2cgKmRwX2NhdGFsb2cpOworCitzdHJ1Y3QgZHBfY2F0YWxvZyAqZHBfY2F0YWxv
Z19nZXQoc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1Y3QgZHBfaW8gKmlvKTsKK3ZvaWQgZHBfY2F0
YWxvZ19wdXQoc3RydWN0IGRwX2NhdGFsb2cgKmNhdGFsb2cpOworCisjZW5kaWYgLyogX0RQX0NB
VEFMT0dfSF8gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfY3RybC5j
IGIvZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9jdHJsLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQK
aW5kZXggMDAwMDAwMC4uYTQ1NzVlYQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9tc20vZHAvZHBfY3RybC5jCkBAIC0wLDAgKzEsMTU5MCBAQAorLy8gU1BEWC1MaWNlbnNlLUlk
ZW50aWZpZXI6IEdQTC0yLjAtb25seQorLyoKKyAqIENvcHlyaWdodCAoYykgMjAxMi0yMDE5LCBU
aGUgTGludXggRm91bmRhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KKyAqLworCisjZGVmaW5l
IHByX2ZtdChmbXQpCSJbZHJtLWRwXSAlczogIiBmbXQsIF9fZnVuY19fCisKKyNpbmNsdWRlIDxs
aW51eC90eXBlcy5oPgorI2luY2x1ZGUgPGxpbnV4L2NvbXBsZXRpb24uaD4KKyNpbmNsdWRlIDxs
aW51eC9kZWxheS5oPgorI2luY2x1ZGUgPGRybS9kcm1fZml4ZWQuaD4KKworI2luY2x1ZGUgImRw
X3JlZy5oIgorI2luY2x1ZGUgImRwX2N0cmwuaCIKKworI2RlZmluZSBEUF9LSFpfVE9fSFogMTAw
MAorI2RlZmluZSBJRExFX1BBVFRFUk5fQ09NUExFVElPTl9USU1FT1VUX0pJRkZJRVMJKDMwICog
SFogLyAxMDAwKSAvKiAzMCBtcyAqLworI2RlZmluZSBXQUlUX0ZPUl9WSURFT19SRUFEWV9USU1F
T1VUX0pJRkZJRVMgKEhaIC8gMikKKworI2RlZmluZSBEUF9DVFJMX0lOVFJfUkVBRFlfRk9SX1ZJ
REVPICAgICBCSVQoMCkKKyNkZWZpbmUgRFBfQ1RSTF9JTlRSX0lETEVfUEFUVEVSTl9TRU5UICBC
SVQoMykKKworI2RlZmluZSBNUl9MSU5LX1RSQUlOSU5HMSAgMHg4CisjZGVmaW5lIE1SX0xJTktf
U1lNQk9MX0VSTSAweDgwCisjZGVmaW5lIE1SX0xJTktfUFJCUzcgMHgxMDAKKyNkZWZpbmUgTVJf
TElOS19DVVNUT004MCAweDIwMAorCitzdHJ1Y3QgZHBfdHVfY2FsY19pbnB1dCB7CisJdTY0IGxj
bGs7ICAgICAgICAvKiAxNjIsIDI3MCwgNTQwIGFuZCA4MTAgKi8KKwl1NjQgcGNsa19raHo7ICAg
IC8qIGluIEtIeiAqLworCXU2NCBoYWN0aXZlOyAgICAgLyogYWN0aXZlIGgtd2lkdGggKi8KKwl1
NjQgaHBvcmNoOyAgICAgIC8qIGJwICsgZnAgKyBwdWxzZSAqLworCWludCBubGFuZXM7ICAgICAg
Lyogbm8ub2YubGFuZXMgKi8KKwlpbnQgYnBwOyAgICAgICAgIC8qIGJpdHMgKi8KKwlpbnQgcGl4
ZWxfZW5jOyAgIC8qIDQ0NCwgNDIwLCA0MjIgKi8KKwlpbnQgZHNjX2VuOyAgICAgLyogZHNjIG9u
L29mZiAqLworCWludCBhc3luY19lbjsgICAvKiBhc3luYyBtb2RlICovCit9OworCitzdHJ1Y3Qg
ZHBfdmNfdHVfbWFwcGluZ190YWJsZSB7CisJdTggdmFsaWRfYm91bmRhcnlfbGluazsKKwl1MTYg
ZGVsYXlfc3RhcnRfbGluazsKKwlib29sIGJvdW5kYXJ5X21vZGVyYXRpb25fZW47CisJdTggdmFs
aWRfbG93ZXJfYm91bmRhcnlfbGluazsKKwl1OCB1cHBlcl9ib3VuZGFyeV9jb3VudDsKKwl1OCBs
b3dlcl9ib3VuZGFyeV9jb3VudDsKKwl1OCB0dV9zaXplX21pbnVzMTsKK307CisKK3N0cnVjdCBk
cF9jdHJsX3ByaXZhdGUgeworCXN0cnVjdCBkcF9jdHJsIGRwX2N0cmw7CisKKwlzdHJ1Y3QgZGV2
aWNlICpkZXY7CisJc3RydWN0IGRwX2F1eCAqYXV4OworCXN0cnVjdCBkcF9wYW5lbCAqcGFuZWw7
CisJc3RydWN0IGRwX2xpbmsgKmxpbms7CisJc3RydWN0IGRwX3Bvd2VyICpwb3dlcjsKKwlzdHJ1
Y3QgZHBfcGFyc2VyICpwYXJzZXI7CisJc3RydWN0IGRwX2NhdGFsb2cgKmNhdGFsb2c7CisKKwlz
dHJ1Y3QgY29tcGxldGlvbiBpZGxlX2NvbXA7CisJc3RydWN0IG11dGV4IHB1c2hfaWRsZV9tdXRl
eDsKKwlzdHJ1Y3QgY29tcGxldGlvbiB2aWRlb19jb21wOworfTsKKwordm9pZCBkcF9jdHJsX3B1
c2hfaWRsZShzdHJ1Y3QgZHBfY3RybCAqZHBfY3RybCkKK3sKKwlzdHJ1Y3QgZHBfY3RybF9wcml2
YXRlICpjdHJsOworCisJY3RybCA9IGNvbnRhaW5lcl9vZihkcF9jdHJsLCBzdHJ1Y3QgZHBfY3Ry
bF9wcml2YXRlLCBkcF9jdHJsKTsKKworCW11dGV4X2xvY2soJmN0cmwtPnB1c2hfaWRsZV9tdXRl
eCk7CisKKwlyZWluaXRfY29tcGxldGlvbigmY3RybC0+aWRsZV9jb21wKTsKKwlkcF9jYXRhbG9n
X2N0cmxfc3RhdGVfY3RybChjdHJsLT5jYXRhbG9nLCBEUF9TVEFURV9DVFJMX1BVU0hfSURMRSk7
CisKKwlpZiAoIXdhaXRfZm9yX2NvbXBsZXRpb25fdGltZW91dCgmY3RybC0+aWRsZV9jb21wLAor
CQkJSURMRV9QQVRURVJOX0NPTVBMRVRJT05fVElNRU9VVF9KSUZGSUVTKSkKKwkJcHJfd2Fybigi
UFVTSF9JRExFIHBhdHRlcm4gdGltZWRvdXRcbiIpOworCisJbXV0ZXhfdW5sb2NrKCZjdHJsLT5w
dXNoX2lkbGVfbXV0ZXgpOworCXByX2RlYnVnKCJtYWlubGluayBvZmYgZG9uZVxuIik7Cit9CisK
K3N0YXRpYyB2b2lkIGRwX2N0cmxfY29uZmlnX2N0cmwoc3RydWN0IGRwX2N0cmxfcHJpdmF0ZSAq
Y3RybCkKK3sKKwl1MzIgY29uZmlnID0gMCwgdGJkOworCXU4ICpkcGNkID0gY3RybC0+cGFuZWwt
PmRwY2Q7CisKKwkvKiBEZWZhdWx0LT4gTFNDTEsgRElWOiAxLzQgTENMSyAgKi8KKwljb25maWcg
fD0gKDIgPDwgRFBfQ09ORklHVVJBVElPTl9DVFJMX0xTQ0xLX0RJVl9TSElGVCk7CisKKwkvKiBT
Y3JhbWJsZXIgcmVzZXQgZW5hYmxlICovCisJaWYgKGRwY2RbRFBfRURQX0NPTkZJR1VSQVRJT05f
Q0FQXSAmIERQX0FMVEVSTkFURV9TQ1JBTUJMRVJfUkVTRVRfQ0FQKQorCQljb25maWcgfD0gRFBf
Q09ORklHVVJBVElPTl9DVFJMX0FTU1I7CisKKwl0YmQgPSBkcF9saW5rX2dldF90ZXN0X2JpdHNf
ZGVwdGgoY3RybC0+bGluaywKKwkJCWN0cmwtPnBhbmVsLT5kcF9tb2RlLmJwcCk7CisKKwlpZiAo
dGJkID09IERQX1RFU1RfQklUX0RFUFRIX1VOS05PV04pIHsKKwkJcHJfZGVidWcoIkJJVF9ERVBU
SCBub3Qgc2V0LiBDb25maWd1cmUgZGVmYXVsdFxuIik7CisJCXRiZCA9IERQX1RFU1RfQklUX0RF
UFRIXzg7CisJfQorCisJY29uZmlnIHw9IHRiZCA8PCBEUF9DT05GSUdVUkFUSU9OX0NUUkxfQlBD
X1NISUZUOworCisJLyogTnVtIG9mIExhbmVzICovCisJY29uZmlnIHw9ICgoY3RybC0+bGluay0+
bGlua19wYXJhbXMubnVtX2xhbmVzIC0gMSkKKwkJCTw8IERQX0NPTkZJR1VSQVRJT05fQ1RSTF9O
VU1fT0ZfTEFORVNfU0hJRlQpOworCisJaWYgKGRybV9kcF9lbmhhbmNlZF9mcmFtZV9jYXAoZHBj
ZCkpCisJCWNvbmZpZyB8PSBEUF9DT05GSUdVUkFUSU9OX0NUUkxfRU5IQU5DRURfRlJBTUlORzsK
KworCWNvbmZpZyB8PSBEUF9DT05GSUdVUkFUSU9OX0NUUkxfUF9JTlRFUkxBQ0VEOyAvKiBwcm9n
cmVzc2l2ZSB2aWRlbyAqLworCisJLyogc3luYyBjbG9jayAmIHN0YXRpYyBNdmlkICovCisJY29u
ZmlnIHw9IERQX0NPTkZJR1VSQVRJT05fQ1RSTF9TVEFUSUNfRFlOQU1JQ19DTjsKKwljb25maWcg
fD0gRFBfQ09ORklHVVJBVElPTl9DVFJMX1NZTkNfQVNZTkNfQ0xLOworCisJZHBfY2F0YWxvZ19j
dHJsX2NvbmZpZ19jdHJsKGN0cmwtPmNhdGFsb2csIGNvbmZpZyk7Cit9CisKKy8qKgorICogZHBf
Y3RybF9jb25maWd1cmVfc291cmNlX3BhcmFtcygpIC0gY29uZmlndXJlcyBEUCB0cmFuc21pdHRl
ciBzb3VyY2UgcGFyYW1zCisgKiBAY3RybDogRGlzcGxheSBQb3J0IERyaXZlciBkYXRhCisgKgor
ICogQ29uZmlndXJlcyB0aGUgRFAgdHJhbnNtaXR0ZXIgc291cmNlIHBhcmFtcyBpbmNsdWRpbmcg
ZGV0YWlscyBzdWNoIGFzIGxhbmUKKyAqIGNvbmZpZ3VyYXRpb24sIG91dHB1dCBmb3JtYXQgYW5k
IHNpbmsvcGFuZWwgdGltaW5nIGluZm9ybWF0aW9uLgorICovCitzdGF0aWMgdm9pZCBkcF9jdHJs
X2NvbmZpZ3VyZV9zb3VyY2VfcGFyYW1zKHN0cnVjdCBkcF9jdHJsX3ByaXZhdGUgKmN0cmwpCit7
CisJdTMyIGNjLCB0YjsKKworCWRwX2NhdGFsb2dfY3RybF9sYW5lX21hcHBpbmcoY3RybC0+Y2F0
YWxvZyk7CisJZHBfY2F0YWxvZ19jdHJsX21haW5saW5rX2N0cmwoY3RybC0+Y2F0YWxvZywgdHJ1
ZSk7CisKKwlkcF9jdHJsX2NvbmZpZ19jdHJsKGN0cmwpOworCisJdGIgPSBkcF9saW5rX2dldF90
ZXN0X2JpdHNfZGVwdGgoY3RybC0+bGluaywKKwkJY3RybC0+cGFuZWwtPmRwX21vZGUuYnBwKTsK
KwljYyA9IGRwX2xpbmtfZ2V0X2NvbG9yaW1ldHJ5X2NvbmZpZyhjdHJsLT5saW5rKTsKKwlkcF9j
YXRhbG9nX2N0cmxfY29uZmlnX21pc2MoY3RybC0+Y2F0YWxvZywgY2MsIHRiKTsKKwlkcF9wYW5l
bF90aW1pbmdfY2ZnKGN0cmwtPnBhbmVsKTsKK30KKworLyoKKyAqIFRoZSBzdHJ1Y3R1cmUgYW5k
IGZldyBmdW5jdGlvbnMgcHJlc2VudCBiZWxvdyBhcmUgSVAvSGFyZHdhcmUKKyAqIHNwZWNpZmlj
IGltcGxlbWVudGF0aW9uLiBNb3N0IG9mIHRoZSBpbXBsZW1lbnRhdGlvbiB3aWxsIG5vdAorICog
aGF2ZSBjb2RpbmcgY29tbWVudHMKKyAqLworc3RydWN0IHR1X2FsZ29fZGF0YSB7CisJczY0IGxj
bGtfZnA7CisJczY0IHBjbGtfZnA7CisJczY0IGx3aWR0aDsKKwlzNjQgaGJwX3JlbGF0aXZlX3Rv
X3BjbGs7CisJaW50IG5sYW5lczsKKwlpbnQgYnBwOworCWludCBwaXhlbEVuYzsKKwlpbnQgZHNj
X2VuOworCWludCBhc3luY19lbjsKKwlpbnQgYnBjOworCisJdWludCBkZWxheV9zdGFydF9saW5r
X2V4dHJhX3BpeGNsazsKKwlpbnQgZXh0cmFfYnVmZmVyX21hcmdpbjsKKwlzNjQgcmF0aW9fZnA7
CisJczY0IG9yaWdpbmFsX3JhdGlvX2ZwOworCisJczY0IGVycl9mcDsKKwlzNjQgbl9lcnJfZnA7
CisJczY0IG5fbl9lcnJfZnA7CisJaW50IHR1X3NpemU7CisJaW50IHR1X3NpemVfZGVzaXJlZDsK
KwlpbnQgdHVfc2l6ZV9taW51czE7CisKKwlpbnQgdmFsaWRfYm91bmRhcnlfbGluazsKKwlzNjQg
cmVzdWx0aW5nX3ZhbGlkX2ZwOworCXM2NCB0b3RhbF92YWxpZF9mcDsKKwlzNjQgZWZmZWN0aXZl
X3ZhbGlkX2ZwOworCXM2NCBlZmZlY3RpdmVfdmFsaWRfcmVjb3JkZWRfZnA7CisJaW50IG5fdHVz
OworCWludCBuX3R1c19wZXJfbGFuZTsKKwlpbnQgcGFpcmVkX3R1czsKKwlpbnQgcmVtYWluZGVy
X3R1czsKKwlpbnQgcmVtYWluZGVyX3R1c191cHBlcjsKKwlpbnQgcmVtYWluZGVyX3R1c19sb3dl
cjsKKwlpbnQgZXh0cmFfYnl0ZXM7CisJaW50IGZpbGxlcl9zaXplOworCWludCBkZWxheV9zdGFy
dF9saW5rOworCisJaW50IGV4dHJhX3BjbGtfY3ljbGVzOworCWludCBleHRyYV9wY2xrX2N5Y2xl
c19pbl9saW5rX2NsazsKKwlzNjQgcmF0aW9fYnlfdHVfZnA7CisJczY0IGF2ZXJhZ2VfdmFsaWQy
X2ZwOworCWludCBuZXdfdmFsaWRfYm91bmRhcnlfbGluazsKKwlpbnQgcmVtYWluZGVyX3N5bWJv
bHNfZXhpc3Q7CisJaW50IG5fc3ltYm9sczsKKwlzNjQgbl9yZW1haW5kZXJfc3ltYm9sc19wZXJf
bGFuZV9mcDsKKwlzNjQgbGFzdF9wYXJ0aWFsX3R1X2ZwOworCXM2NCBUVV9yYXRpb19lcnJfZnA7
CisKKwlpbnQgbl90dXNfaW5jbF9sYXN0X2luY29tcGxldGVfdHU7CisJaW50IGV4dHJhX3BjbGtf
Y3ljbGVzX3RtcDsKKwlpbnQgZXh0cmFfcGNsa19jeWNsZXNfaW5fbGlua19jbGtfdG1wOworCWlu
dCBleHRyYV9yZXF1aXJlZF9ieXRlc19uZXdfdG1wOworCWludCBmaWxsZXJfc2l6ZV90bXA7CisJ
aW50IGxvd2VyX2ZpbGxlcl9zaXplX3RtcDsKKwlpbnQgZGVsYXlfc3RhcnRfbGlua190bXA7CisK
Kwlib29sIGJvdW5kYXJ5X21vZGVyYXRpb25fZW47CisJaW50IGJvdW5kYXJ5X21vZF9sb3dlcl9l
cnI7CisJaW50IHVwcGVyX2JvdW5kYXJ5X2NvdW50OworCWludCBsb3dlcl9ib3VuZGFyeV9jb3Vu
dDsKKwlpbnQgaV91cHBlcl9ib3VuZGFyeV9jb3VudDsKKwlpbnQgaV9sb3dlcl9ib3VuZGFyeV9j
b3VudDsKKwlpbnQgdmFsaWRfbG93ZXJfYm91bmRhcnlfbGluazsKKwlpbnQgZXZlbl9kaXN0cmli
dXRpb25fQkY7CisJaW50IGV2ZW5fZGlzdHJpYnV0aW9uX2xlZ2FjeTsKKwlpbnQgZXZlbl9kaXN0
cmlidXRpb247CisJaW50IG1pbl9oYmxhbmtfdmlvbGF0ZWQ7CisJczY0IGRlbGF5X3N0YXJ0X3Rp
bWVfZnA7CisJczY0IGhicF90aW1lX2ZwOworCXM2NCBoYWN0aXZlX3RpbWVfZnA7CisJczY0IGRp
ZmZfYWJzX2ZwOworCisJczY0IHJhdGlvOworfTsKKworc3RhdGljIGludCBfdHVfcGFyYW1fY29t
cGFyZShzNjQgYSwgczY0IGIpCit7CisJdTMyIGFfaW50LCBhX2ZyYWM7CisJdTMyIGJfaW50LCBi
X2ZyYWM7CisKKwlpZiAoYSA9PSBiKQorCQlyZXR1cm4gMDsKKworCWFfaW50ID0gKGEgPj4gMzIp
ICYgMHg3RkZGRkZGRjsKKwlhX2ZyYWMgPSBhICYgMHhGRkZGRkZGRjsKKworCWJfaW50ID0gKGIg
Pj4gMzIpICYgMHg3RkZGRkZGRjsKKwliX2ZyYWMgPSBiICYgMHhGRkZGRkZGRjsKKworCWlmIChh
X2ludCA+IGJfaW50KQorCQlyZXR1cm4gMTsKKwllbHNlIGlmIChhX2ludCA8IGJfaW50KQorCQly
ZXR1cm4gMjsKKwllbHNlIGlmIChhX2ZyYWMgPiBiX2ZyYWMpCisJCXJldHVybiAxOworCWVsc2UK
KwkJcmV0dXJuIDI7Cit9CisKK3N0YXRpYyB2b2lkIF90dV92YWxpZF9ib3VuZGFyeV9jYWxjKHN0
cnVjdCB0dV9hbGdvX2RhdGEgKnR1KQoreworCXM2NCB0ZW1wMV9mcCwgdGVtcDJfZnAsIHRlbXAs
IHRlbXAxLCB0ZW1wMjsKKwlpbnQgY29tcGFyZV9yZXN1bHRfMSwgY29tcGFyZV9yZXN1bHRfMiwg
Y29tcGFyZV9yZXN1bHRfMzsKKworCXRlbXAxX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbih0
dS0+dHVfc2l6ZSwgMSk7CisJdGVtcDJfZnAgPSBkcm1fZml4cF9tdWwodHUtPnJhdGlvX2ZwLCB0
ZW1wMV9mcCk7CisKKwl0dS0+bmV3X3ZhbGlkX2JvdW5kYXJ5X2xpbmsgPSBkcm1fZml4cDJpbnRf
Y2VpbCh0ZW1wMl9mcCk7CisKKwl0ZW1wID0gKHR1LT5pX3VwcGVyX2JvdW5kYXJ5X2NvdW50ICoK
KwkJCQl0dS0+bmV3X3ZhbGlkX2JvdW5kYXJ5X2xpbmsgKworCQkJCXR1LT5pX2xvd2VyX2JvdW5k
YXJ5X2NvdW50ICoKKwkJCQkodHUtPm5ld192YWxpZF9ib3VuZGFyeV9saW5rLTEpKTsKKwl0dS0+
YXZlcmFnZV92YWxpZDJfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHRlbXAsCisJCQkJCSh0
dS0+aV91cHBlcl9ib3VuZGFyeV9jb3VudCArCisJCQkJCXR1LT5pX2xvd2VyX2JvdW5kYXJ5X2Nv
dW50KSk7CisKKwl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24odHUtPmJwcCwgOCk7
CisJdGVtcDJfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHR1LT5sd2lkdGgsIDEpOworCXRl
bXAxX2ZwID0gZHJtX2ZpeHBfbXVsKHRlbXAyX2ZwLCB0ZW1wMV9mcCk7CisJdGVtcDJfZnAgPSBk
cm1fZml4cF9kaXYodGVtcDFfZnAsIHR1LT5hdmVyYWdlX3ZhbGlkMl9mcCk7CisJdHUtPm5fdHVz
ID0gZHJtX2ZpeHAyaW50KHRlbXAyX2ZwKTsKKworCXRlbXAxX2ZwID0gZHJtX2ZpeHBfZnJvbV9m
cmFjdGlvbih0dS0+bl90dXMsIDEpOworCXRlbXAyX2ZwID0gZHJtX2ZpeHBfbXVsKHRlbXAxX2Zw
LCB0dS0+YXZlcmFnZV92YWxpZDJfZnApOworCXRlbXAxX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFj
dGlvbih0dS0+bl9zeW1ib2xzLCAxKTsKKwl0ZW1wMl9mcCA9IHRlbXAxX2ZwIC0gdGVtcDJfZnA7
CisJdGVtcDFfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHR1LT5ubGFuZXMsIDEpOworCXRl
bXAyX2ZwID0gZHJtX2ZpeHBfZGl2KHRlbXAyX2ZwLCB0ZW1wMV9mcCk7CisJdHUtPm5fcmVtYWlu
ZGVyX3N5bWJvbHNfcGVyX2xhbmVfZnAgPSB0ZW1wMl9mcDsKKworCXRlbXAxX2ZwID0gZHJtX2Zp
eHBfZnJvbV9mcmFjdGlvbih0dS0+dHVfc2l6ZSwgMSk7CisJdHUtPmxhc3RfcGFydGlhbF90dV9m
cCA9CisJCQlkcm1fZml4cF9kaXYodHUtPm5fcmVtYWluZGVyX3N5bWJvbHNfcGVyX2xhbmVfZnAs
CisJCQkJCXRlbXAxX2ZwKTsKKworCWlmICh0dS0+bl9yZW1haW5kZXJfc3ltYm9sc19wZXJfbGFu
ZV9mcCAhPSAwKQorCQl0dS0+cmVtYWluZGVyX3N5bWJvbHNfZXhpc3QgPSAxOworCWVsc2UKKwkJ
dHUtPnJlbWFpbmRlcl9zeW1ib2xzX2V4aXN0ID0gMDsKKworCXRlbXAxX2ZwID0gZHJtX2ZpeHBf
ZnJvbV9mcmFjdGlvbih0dS0+bl90dXMsIHR1LT5ubGFuZXMpOworCXR1LT5uX3R1c19wZXJfbGFu
ZSA9IGRybV9maXhwMmludCh0ZW1wMV9mcCk7CisKKwl0dS0+cGFpcmVkX3R1cyA9IChpbnQpKCh0
dS0+bl90dXNfcGVyX2xhbmUpIC8KKwkJCQkJKHR1LT5pX3VwcGVyX2JvdW5kYXJ5X2NvdW50ICsK
KwkJCQkJIHR1LT5pX2xvd2VyX2JvdW5kYXJ5X2NvdW50KSk7CisKKwl0dS0+cmVtYWluZGVyX3R1
cyA9IHR1LT5uX3R1c19wZXJfbGFuZSAtIHR1LT5wYWlyZWRfdHVzICoKKwkJCQkJCSh0dS0+aV91
cHBlcl9ib3VuZGFyeV9jb3VudCArCisJCQkJCQl0dS0+aV9sb3dlcl9ib3VuZGFyeV9jb3VudCk7
CisKKwlpZiAoKHR1LT5yZW1haW5kZXJfdHVzIC0gdHUtPmlfdXBwZXJfYm91bmRhcnlfY291bnQp
ID4gMCkgeworCQl0dS0+cmVtYWluZGVyX3R1c191cHBlciA9IHR1LT5pX3VwcGVyX2JvdW5kYXJ5
X2NvdW50OworCQl0dS0+cmVtYWluZGVyX3R1c19sb3dlciA9IHR1LT5yZW1haW5kZXJfdHVzIC0K
KwkJCQkJCXR1LT5pX3VwcGVyX2JvdW5kYXJ5X2NvdW50OworCX0gZWxzZSB7CisJCXR1LT5yZW1h
aW5kZXJfdHVzX3VwcGVyID0gdHUtPnJlbWFpbmRlcl90dXM7CisJCXR1LT5yZW1haW5kZXJfdHVz
X2xvd2VyID0gMDsKKwl9CisKKwl0ZW1wID0gdHUtPnBhaXJlZF90dXMgKiAodHUtPmlfdXBwZXJf
Ym91bmRhcnlfY291bnQgKgorCQkJCXR1LT5uZXdfdmFsaWRfYm91bmRhcnlfbGluayArCisJCQkJ
dHUtPmlfbG93ZXJfYm91bmRhcnlfY291bnQgKgorCQkJCSh0dS0+bmV3X3ZhbGlkX2JvdW5kYXJ5
X2xpbmsgLSAxKSkgKworCQkJCSh0dS0+cmVtYWluZGVyX3R1c191cHBlciAqCisJCQkJIHR1LT5u
ZXdfdmFsaWRfYm91bmRhcnlfbGluaykgKworCQkJCSh0dS0+cmVtYWluZGVyX3R1c19sb3dlciAq
CisJCQkJKHR1LT5uZXdfdmFsaWRfYm91bmRhcnlfbGluayAtIDEpKTsKKwl0dS0+dG90YWxfdmFs
aWRfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHRlbXAsIDEpOworCisJaWYgKHR1LT5yZW1h
aW5kZXJfc3ltYm9sc19leGlzdCkgeworCQl0ZW1wMV9mcCA9IHR1LT50b3RhbF92YWxpZF9mcCAr
CisJCQkJdHUtPm5fcmVtYWluZGVyX3N5bWJvbHNfcGVyX2xhbmVfZnA7CisJCXRlbXAyX2ZwID0g
ZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbih0dS0+bl90dXNfcGVyX2xhbmUsIDEpOworCQl0ZW1wMl9m
cCA9IHRlbXAyX2ZwICsgdHUtPmxhc3RfcGFydGlhbF90dV9mcDsKKwkJdGVtcDFfZnAgPSBkcm1f
Zml4cF9kaXYodGVtcDFfZnAsIHRlbXAyX2ZwKTsKKwl9IGVsc2UgeworCQl0ZW1wMl9mcCA9IGRy
bV9maXhwX2Zyb21fZnJhY3Rpb24odHUtPm5fdHVzX3Blcl9sYW5lLCAxKTsKKwkJdGVtcDFfZnAg
PSBkcm1fZml4cF9kaXYodHUtPnRvdGFsX3ZhbGlkX2ZwLCB0ZW1wMl9mcCk7CisJfQorCXR1LT5l
ZmZlY3RpdmVfdmFsaWRfZnAgPSB0ZW1wMV9mcDsKKworCXRlbXAxX2ZwID0gZHJtX2ZpeHBfZnJv
bV9mcmFjdGlvbih0dS0+dHVfc2l6ZSwgMSk7CisJdGVtcDJfZnAgPSBkcm1fZml4cF9tdWwodHUt
PnJhdGlvX2ZwLCB0ZW1wMV9mcCk7CisJdHUtPm5fbl9lcnJfZnAgPSB0dS0+ZWZmZWN0aXZlX3Zh
bGlkX2ZwIC0gdGVtcDJfZnA7CisKKwl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24o
dHUtPnR1X3NpemUsIDEpOworCXRlbXAyX2ZwID0gZHJtX2ZpeHBfbXVsKHR1LT5yYXRpb19mcCwg
dGVtcDFfZnApOworCXR1LT5uX2Vycl9mcCA9IHR1LT5hdmVyYWdlX3ZhbGlkMl9mcCAtIHRlbXAy
X2ZwOworCisJdHUtPmV2ZW5fZGlzdHJpYnV0aW9uID0gdHUtPm5fdHVzICUgdHUtPm5sYW5lcyA9
PSAwID8gMSA6IDA7CisKKwl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24odHUtPmJw
cCwgOCk7CisJdGVtcDJfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHR1LT5sd2lkdGgsIDEp
OworCXRlbXAxX2ZwID0gZHJtX2ZpeHBfbXVsKHRlbXAyX2ZwLCB0ZW1wMV9mcCk7CisJdGVtcDJf
ZnAgPSBkcm1fZml4cF9kaXYodGVtcDFfZnAsIHR1LT5hdmVyYWdlX3ZhbGlkMl9mcCk7CisKKwlp
ZiAodGVtcDJfZnApCisJCXR1LT5uX3R1c19pbmNsX2xhc3RfaW5jb21wbGV0ZV90dSA9IGRybV9m
aXhwMmludF9jZWlsKHRlbXAyX2ZwKTsKKwllbHNlCisJCXR1LT5uX3R1c19pbmNsX2xhc3RfaW5j
b21wbGV0ZV90dSA9IDA7CisKKwl0ZW1wMSA9IDA7CisJdGVtcDFfZnAgPSBkcm1fZml4cF9mcm9t
X2ZyYWN0aW9uKHR1LT50dV9zaXplLCAxKTsKKwl0ZW1wMl9mcCA9IGRybV9maXhwX211bCh0dS0+
b3JpZ2luYWxfcmF0aW9fZnAsIHRlbXAxX2ZwKTsKKwl0ZW1wMV9mcCA9IHR1LT5hdmVyYWdlX3Zh
bGlkMl9mcCAtIHRlbXAyX2ZwOworCXRlbXAyX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbih0
dS0+bl90dXNfaW5jbF9sYXN0X2luY29tcGxldGVfdHUsIDEpOworCXRlbXAxX2ZwID0gZHJtX2Zp
eHBfbXVsKHRlbXAyX2ZwLCB0ZW1wMV9mcCk7CisKKwlpZiAodGVtcDFfZnApCisJCXRlbXAxID0g
ZHJtX2ZpeHAyaW50X2NlaWwodGVtcDFfZnApOworCisJdGVtcCA9IHR1LT5pX3VwcGVyX2JvdW5k
YXJ5X2NvdW50ICogdHUtPm5sYW5lczsKKwl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rp
b24odHUtPnR1X3NpemUsIDEpOworCXRlbXAyX2ZwID0gZHJtX2ZpeHBfbXVsKHR1LT5vcmlnaW5h
bF9yYXRpb19mcCwgdGVtcDFfZnApOworCXRlbXAxX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlv
bih0dS0+bmV3X3ZhbGlkX2JvdW5kYXJ5X2xpbmssIDEpOworCXRlbXAyX2ZwID0gdGVtcDFfZnAg
LSB0ZW1wMl9mcDsKKwl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24odGVtcCwgMSk7
CisJdGVtcDJfZnAgPSBkcm1fZml4cF9tdWwodGVtcDFfZnAsIHRlbXAyX2ZwKTsKKworCWlmICh0
ZW1wMl9mcCkKKwkJdGVtcDIgPSBkcm1fZml4cDJpbnRfY2VpbCh0ZW1wMl9mcCk7CisJZWxzZQor
CQl0ZW1wMiA9IDA7CisJdHUtPmV4dHJhX3JlcXVpcmVkX2J5dGVzX25ld190bXAgPSAoaW50KSh0
ZW1wMSArIHRlbXAyKTsKKworCXRlbXAxX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbig4LCB0
dS0+YnBwKTsKKwl0ZW1wMl9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24oCisJdHUtPmV4dHJh
X3JlcXVpcmVkX2J5dGVzX25ld190bXAsIDEpOworCXRlbXAxX2ZwID0gZHJtX2ZpeHBfbXVsKHRl
bXAyX2ZwLCB0ZW1wMV9mcCk7CisKKwlpZiAodGVtcDFfZnApCisJCXR1LT5leHRyYV9wY2xrX2N5
Y2xlc190bXAgPSBkcm1fZml4cDJpbnRfY2VpbCh0ZW1wMV9mcCk7CisJZWxzZQorCQl0dS0+ZXh0
cmFfcGNsa19jeWNsZXNfdG1wID0gMDsKKworCXRlbXAxX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFj
dGlvbih0dS0+ZXh0cmFfcGNsa19jeWNsZXNfdG1wLCAxKTsKKwl0ZW1wMl9mcCA9IGRybV9maXhw
X2Rpdih0dS0+bGNsa19mcCwgdHUtPnBjbGtfZnApOworCXRlbXAxX2ZwID0gZHJtX2ZpeHBfbXVs
KHRlbXAxX2ZwLCB0ZW1wMl9mcCk7CisKKwlpZiAodGVtcDFfZnApCisJCXR1LT5leHRyYV9wY2xr
X2N5Y2xlc19pbl9saW5rX2Nsa190bXAgPQorCQkJCQkJZHJtX2ZpeHAyaW50X2NlaWwodGVtcDFf
ZnApOworCWVsc2UKKwkJdHUtPmV4dHJhX3BjbGtfY3ljbGVzX2luX2xpbmtfY2xrX3RtcCA9IDA7
CisKKwl0dS0+ZmlsbGVyX3NpemVfdG1wID0gdHUtPnR1X3NpemUgLSB0dS0+bmV3X3ZhbGlkX2Jv
dW5kYXJ5X2xpbms7CisKKwl0dS0+bG93ZXJfZmlsbGVyX3NpemVfdG1wID0gdHUtPmZpbGxlcl9z
aXplX3RtcCArIDE7CisKKwl0dS0+ZGVsYXlfc3RhcnRfbGlua190bXAgPSB0dS0+ZXh0cmFfcGNs
a19jeWNsZXNfaW5fbGlua19jbGtfdG1wICsKKwkJCQkJdHUtPmxvd2VyX2ZpbGxlcl9zaXplX3Rt
cCArCisJCQkJCXR1LT5leHRyYV9idWZmZXJfbWFyZ2luOworCisJdGVtcDFfZnAgPSBkcm1fZml4
cF9mcm9tX2ZyYWN0aW9uKHR1LT5kZWxheV9zdGFydF9saW5rX3RtcCwgMSk7CisJdHUtPmRlbGF5
X3N0YXJ0X3RpbWVfZnAgPSBkcm1fZml4cF9kaXYodGVtcDFfZnAsIHR1LT5sY2xrX2ZwKTsKKwor
CWNvbXBhcmVfcmVzdWx0XzEgPSBfdHVfcGFyYW1fY29tcGFyZSh0dS0+bl9uX2Vycl9mcCwgdHUt
PmRpZmZfYWJzX2ZwKTsKKwlpZiAoY29tcGFyZV9yZXN1bHRfMSA9PSAyKQorCQljb21wYXJlX3Jl
c3VsdF8xID0gMTsKKwllbHNlCisJCWNvbXBhcmVfcmVzdWx0XzEgPSAwOworCisJY29tcGFyZV9y
ZXN1bHRfMiA9IF90dV9wYXJhbV9jb21wYXJlKHR1LT5uX25fZXJyX2ZwLCB0dS0+ZXJyX2ZwKTsK
KwlpZiAoY29tcGFyZV9yZXN1bHRfMiA9PSAyKQorCQljb21wYXJlX3Jlc3VsdF8yID0gMTsKKwll
bHNlCisJCWNvbXBhcmVfcmVzdWx0XzIgPSAwOworCisJY29tcGFyZV9yZXN1bHRfMyA9IF90dV9w
YXJhbV9jb21wYXJlKHR1LT5oYnBfdGltZV9mcCwKKwkJCQkJdHUtPmRlbGF5X3N0YXJ0X3RpbWVf
ZnApOworCWlmIChjb21wYXJlX3Jlc3VsdF8zID09IDIpCisJCWNvbXBhcmVfcmVzdWx0XzMgPSAw
OworCWVsc2UKKwkJY29tcGFyZV9yZXN1bHRfMyA9IDE7CisKKwlpZiAoKCh0dS0+ZXZlbl9kaXN0
cmlidXRpb24gPT0gMSkgfHwKKwkJCSgodHUtPmV2ZW5fZGlzdHJpYnV0aW9uX0JGID09IDApICYm
CisJCQkodHUtPmV2ZW5fZGlzdHJpYnV0aW9uX2xlZ2FjeSA9PSAwKSkpICYmCisJCQl0dS0+bl9l
cnJfZnAgPj0gMCAmJiB0dS0+bl9uX2Vycl9mcCA+PSAwICYmCisJCQljb21wYXJlX3Jlc3VsdF8y
ICYmCisJCQkoY29tcGFyZV9yZXN1bHRfMSB8fCAodHUtPm1pbl9oYmxhbmtfdmlvbGF0ZWQgPT0g
MSkpICYmCisJCQkodHUtPm5ld192YWxpZF9ib3VuZGFyeV9saW5rIC0gMSkgPiAwICYmCisJCQlj
b21wYXJlX3Jlc3VsdF8zICYmCisJCQkodHUtPmRlbGF5X3N0YXJ0X2xpbmtfdG1wIDw9IDEwMjMp
KSB7CisJCXR1LT51cHBlcl9ib3VuZGFyeV9jb3VudCA9IHR1LT5pX3VwcGVyX2JvdW5kYXJ5X2Nv
dW50OworCQl0dS0+bG93ZXJfYm91bmRhcnlfY291bnQgPSB0dS0+aV9sb3dlcl9ib3VuZGFyeV9j
b3VudDsKKwkJdHUtPmVycl9mcCA9IHR1LT5uX25fZXJyX2ZwOworCQl0dS0+Ym91bmRhcnlfbW9k
ZXJhdGlvbl9lbiA9IHRydWU7CisJCXR1LT50dV9zaXplX2Rlc2lyZWQgPSB0dS0+dHVfc2l6ZTsK
KwkJdHUtPnZhbGlkX2JvdW5kYXJ5X2xpbmsgPSB0dS0+bmV3X3ZhbGlkX2JvdW5kYXJ5X2xpbms7
CisJCXR1LT5lZmZlY3RpdmVfdmFsaWRfcmVjb3JkZWRfZnAgPSB0dS0+ZWZmZWN0aXZlX3ZhbGlk
X2ZwOworCQl0dS0+ZXZlbl9kaXN0cmlidXRpb25fQkYgPSAxOworCQl0dS0+ZGVsYXlfc3RhcnRf
bGluayA9IHR1LT5kZWxheV9zdGFydF9saW5rX3RtcDsKKwl9IGVsc2UgaWYgKHR1LT5ib3VuZGFy
eV9tb2RfbG93ZXJfZXJyID09IDApIHsKKwkJY29tcGFyZV9yZXN1bHRfMSA9IF90dV9wYXJhbV9j
b21wYXJlKHR1LT5uX25fZXJyX2ZwLAorCQkJCQkJCXR1LT5kaWZmX2Fic19mcCk7CisJCWlmIChj
b21wYXJlX3Jlc3VsdF8xID09IDIpCisJCQl0dS0+Ym91bmRhcnlfbW9kX2xvd2VyX2VyciA9IDE7
CisJfQorfQorCitzdGF0aWMgdm9pZCBfZHBfY3RybF9jYWxjX3R1KHN0cnVjdCBkcF90dV9jYWxj
X2lucHV0ICppbiwKKwkJCQkgICBzdHJ1Y3QgZHBfdmNfdHVfbWFwcGluZ190YWJsZSAqdHVfdGFi
bGUpCit7CisJc3RydWN0IHR1X2FsZ29fZGF0YSB0dTsKKwlpbnQgY29tcGFyZV9yZXN1bHRfMSwg
Y29tcGFyZV9yZXN1bHRfMjsKKwl1NjQgdGVtcCA9IDA7CisJczY0IHRlbXBfZnAgPSAwLCB0ZW1w
MV9mcCA9IDAsIHRlbXAyX2ZwID0gMDsKKworCXM2NCBMQ0xLX0ZBU1RfU0tFV19mcCA9IGRybV9m
aXhwX2Zyb21fZnJhY3Rpb24oNiwgMTAwMDApOyAvKiAwLjAwMDYgKi8KKwlzNjQgY29uc3RfcDQ5
X2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbig0OSwgMTAwKTsgLyogMC40OSAqLworCXM2NCBj
b25zdF9wNTZfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKDU2LCAxMDApOyAvKiAwLjU2ICov
CisJczY0IFJBVElPX1NDQUxFX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbigxMDAxLCAxMDAw
KTsKKworCXU4IERQX0JSVVRFX0ZPUkNFID0gMTsKKwlzNjQgQlJVVEVfRk9SQ0VfVEhSRVNIT0xE
X2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbigxLCAxMCk7IC8qIDAuMSAqLworCXVpbnQgRVhU
UkFfUElYQ0xLX0NZQ0xFX0RFTEFZID0gNDsKKwl1aW50IEhCTEFOS19NQVJHSU4gPSA0OworCisJ
bWVtc2V0KCZ0dSwgMCwgc2l6ZW9mKHR1KSk7CisKKwl0dS5sY2xrX2ZwICAgICAgICAgICAgICA9
IGRybV9maXhwX2Zyb21fZnJhY3Rpb24oaW4tPmxjbGssIDEpOworCXR1LnBjbGtfZnAgICAgICAg
ICAgICAgID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbihpbi0+cGNsa19raHosIDEwMDApOworCXR1
Lmx3aWR0aCAgICAgICAgICAgICAgID0gaW4tPmhhY3RpdmU7CisJdHUuaGJwX3JlbGF0aXZlX3Rv
X3BjbGsgPSBpbi0+aHBvcmNoOworCXR1Lm5sYW5lcyAgICAgICAgICAgICAgID0gaW4tPm5sYW5l
czsKKwl0dS5icHAgICAgICAgICAgICAgICAgICA9IGluLT5icHA7CisJdHUucGl4ZWxFbmMgICAg
ICAgICAgICAgPSBpbi0+cGl4ZWxfZW5jOworCXR1LmRzY19lbiAgICAgICAgICAgICAgID0gaW4t
PmRzY19lbjsKKwl0dS5hc3luY19lbiAgICAgICAgICAgICA9IGluLT5hc3luY19lbjsKKworCXR1
LmVycl9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24oMTAwMCwgMSk7IC8qIDEwMDAgKi8KKwor
CWlmICh0dS5waXhlbEVuYyA9PSA0MjApIHsKKwkJdGVtcF9mcCA9IGRybV9maXhwX2Zyb21fZnJh
Y3Rpb24oMiwgMSk7CisJCXR1LnBjbGtfZnAgPSBkcm1fZml4cF9kaXYodHUucGNsa19mcCwgdGVt
cF9mcCk7CisJCXR1Lmx3aWR0aCAvPSAyOworCQl0dS5oYnBfcmVsYXRpdmVfdG9fcGNsayAvPSAy
OworCX0KKworCWlmICh0dS5waXhlbEVuYyA9PSA0MjIpIHsKKwkJc3dpdGNoICh0dS5icHApIHsK
KwkJY2FzZSAyNDoKKwkJCXR1LmJwcCA9IDE2OworCQkJdHUuYnBjID0gODsKKwkJCWJyZWFrOwor
CQljYXNlIDMwOgorCQkJdHUuYnBwID0gMjA7CisJCQl0dS5icGMgPSAxMDsKKwkJCWJyZWFrOwor
CQlkZWZhdWx0OgorCQkJdHUuYnBwID0gMTY7CisJCQl0dS5icGMgPSA4OworCQkJYnJlYWs7CisJ
CX0KKwl9IGVsc2UgeworCQl0dS5icGMgPSB0dS5icHAvMzsKKwl9CisKKwl0ZW1wMV9mcCA9IGRy
bV9maXhwX2Zyb21fZnJhY3Rpb24oNCwgMSk7CisJdGVtcDJfZnAgPSBkcm1fZml4cF9tdWwodGVt
cDFfZnAsIHR1LmxjbGtfZnApOworCXRlbXBfZnAgPSBkcm1fZml4cF9kaXYodGVtcDJfZnAsIHR1
LnBjbGtfZnApOworCXR1LmV4dHJhX2J1ZmZlcl9tYXJnaW4gPSBkcm1fZml4cDJpbnRfY2VpbCh0
ZW1wX2ZwKTsKKworCXRlbXAxX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbih0dS5icHAsIDgp
OworCXRlbXAyX2ZwID0gZHJtX2ZpeHBfbXVsKHR1LnBjbGtfZnAsIHRlbXAxX2ZwKTsKKwl0ZW1w
MV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24odHUubmxhbmVzLCAxKTsKKwl0ZW1wMl9mcCA9
IGRybV9maXhwX2Rpdih0ZW1wMl9mcCwgdGVtcDFfZnApOworCXR1LnJhdGlvX2ZwID0gZHJtX2Zp
eHBfZGl2KHRlbXAyX2ZwLCB0dS5sY2xrX2ZwKTsKKworCXR1Lm9yaWdpbmFsX3JhdGlvX2ZwID0g
dHUucmF0aW9fZnA7CisJdHUuYm91bmRhcnlfbW9kZXJhdGlvbl9lbiA9IGZhbHNlOworCXR1LnVw
cGVyX2JvdW5kYXJ5X2NvdW50ID0gMDsKKwl0dS5sb3dlcl9ib3VuZGFyeV9jb3VudCA9IDA7CisJ
dHUuaV91cHBlcl9ib3VuZGFyeV9jb3VudCA9IDA7CisJdHUuaV9sb3dlcl9ib3VuZGFyeV9jb3Vu
dCA9IDA7CisJdHUudmFsaWRfbG93ZXJfYm91bmRhcnlfbGluayA9IDA7CisJdHUuZXZlbl9kaXN0
cmlidXRpb25fQkYgPSAwOworCXR1LmV2ZW5fZGlzdHJpYnV0aW9uX2xlZ2FjeSA9IDA7CisJdHUu
ZXZlbl9kaXN0cmlidXRpb24gPSAwOworCXR1LmRlbGF5X3N0YXJ0X3RpbWVfZnAgPSAwOworCisJ
dHUuZXJyX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbigxMDAwLCAxKTsKKwl0dS5uX2Vycl9m
cCA9IDA7CisJdHUubl9uX2Vycl9mcCA9IDA7CisKKwl0dS5yYXRpbyA9IGRybV9maXhwMmludCh0
dS5yYXRpb19mcCk7CisJaWYgKCgoKHUzMil0dS5sd2lkdGggJSB0dS5ubGFuZXMpICE9IDApICYm
CisJCQkhdHUucmF0aW8gJiYgdHUuZHNjX2VuID09IDApIHsKKwkJdHUucmF0aW9fZnAgPSBkcm1f
Zml4cF9tdWwodHUucmF0aW9fZnAsIFJBVElPX1NDQUxFX2ZwKTsKKwkJdHUucmF0aW8gPSBkcm1f
Zml4cDJpbnQodHUucmF0aW9fZnApOworCQlpZiAodHUucmF0aW8pCisJCQl0dS5yYXRpb19mcCA9
IGRybV9maXhwX2Zyb21fZnJhY3Rpb24oMSwgMSk7CisJfQorCisJaWYgKHR1LnJhdGlvID4gMSkK
KwkJdHUucmF0aW8gPSAxOworCisJaWYgKHR1LnJhdGlvID09IDEpCisJCWdvdG8gdHVfc2l6ZV9j
YWxjOworCisJY29tcGFyZV9yZXN1bHRfMSA9IF90dV9wYXJhbV9jb21wYXJlKHR1LnJhdGlvX2Zw
LCBjb25zdF9wNDlfZnApOworCWlmICghY29tcGFyZV9yZXN1bHRfMSB8fCBjb21wYXJlX3Jlc3Vs
dF8xID09IDEpCisJCWNvbXBhcmVfcmVzdWx0XzEgPSAxOworCWVsc2UKKwkJY29tcGFyZV9yZXN1
bHRfMSA9IDA7CisKKwljb21wYXJlX3Jlc3VsdF8yID0gX3R1X3BhcmFtX2NvbXBhcmUodHUucmF0
aW9fZnAsIGNvbnN0X3A1Nl9mcCk7CisJaWYgKCFjb21wYXJlX3Jlc3VsdF8yIHx8IGNvbXBhcmVf
cmVzdWx0XzIgPT0gMikKKwkJY29tcGFyZV9yZXN1bHRfMiA9IDE7CisJZWxzZQorCQljb21wYXJl
X3Jlc3VsdF8yID0gMDsKKworCWlmICh0dS5kc2NfZW4gJiYgY29tcGFyZV9yZXN1bHRfMSAmJiBj
b21wYXJlX3Jlc3VsdF8yKSB7CisJCUhCTEFOS19NQVJHSU4gKz0gNDsKKwkJRFJNX0RFQlVHX0RQ
KCJJbmZvOiBpbmNyZWFzZSBIQkxBTktfTUFSR0lOIHRvICVkXG4iLCBIQkxBTktfTUFSR0lOKTsK
Kwl9CisKK3R1X3NpemVfY2FsYzoKKwlmb3IgKHR1LnR1X3NpemUgPSAzMjsgdHUudHVfc2l6ZSA8
PSA2NDsgdHUudHVfc2l6ZSsrKSB7CisJCXRlbXAxX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlv
bih0dS50dV9zaXplLCAxKTsKKwkJdGVtcDJfZnAgPSBkcm1fZml4cF9tdWwodHUucmF0aW9fZnAs
IHRlbXAxX2ZwKTsKKwkJdGVtcCA9IGRybV9maXhwMmludF9jZWlsKHRlbXAyX2ZwKTsKKwkJdGVt
cDFfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHRlbXAsIDEpOworCQl0dS5uX2Vycl9mcCA9
IHRlbXAxX2ZwIC0gdGVtcDJfZnA7CisKKwkJaWYgKHR1Lm5fZXJyX2ZwIDwgdHUuZXJyX2ZwKSB7
CisJCQl0dS5lcnJfZnAgPSB0dS5uX2Vycl9mcDsKKwkJCXR1LnR1X3NpemVfZGVzaXJlZCA9IHR1
LnR1X3NpemU7CisJCX0KKwl9CisKKwl0dS50dV9zaXplX21pbnVzMSA9IHR1LnR1X3NpemVfZGVz
aXJlZCAtIDE7CisKKwl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24odHUudHVfc2l6
ZV9kZXNpcmVkLCAxKTsKKwl0ZW1wMl9mcCA9IGRybV9maXhwX211bCh0dS5yYXRpb19mcCwgdGVt
cDFfZnApOworCXR1LnZhbGlkX2JvdW5kYXJ5X2xpbmsgPSBkcm1fZml4cDJpbnRfY2VpbCh0ZW1w
Ml9mcCk7CisKKwl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24odHUuYnBwLCA4KTsK
Kwl0ZW1wMl9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24odHUubHdpZHRoLCAxKTsKKwl0ZW1w
Ml9mcCA9IGRybV9maXhwX211bCh0ZW1wMl9mcCwgdGVtcDFfZnApOworCisJdGVtcDFfZnAgPSBk
cm1fZml4cF9mcm9tX2ZyYWN0aW9uKHR1LnZhbGlkX2JvdW5kYXJ5X2xpbmssIDEpOworCXRlbXAy
X2ZwID0gZHJtX2ZpeHBfZGl2KHRlbXAyX2ZwLCB0ZW1wMV9mcCk7CisJdHUubl90dXMgPSBkcm1f
Zml4cDJpbnQodGVtcDJfZnApOworCisJdHUuZXZlbl9kaXN0cmlidXRpb25fbGVnYWN5ID0gdHUu
bl90dXMgJSB0dS5ubGFuZXMgPT0gMCA/IDEgOiAwOworCURSTV9ERUJVR19EUCgiSW5mbzogbl9z
eW0gPSAlZCwgbnVtX29mX3R1cyA9ICVkXG4iLAorCQl0dS52YWxpZF9ib3VuZGFyeV9saW5rLCB0
dS5uX3R1cyk7CisKKwl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24odHUudHVfc2l6
ZV9kZXNpcmVkLCAxKTsKKwl0ZW1wMl9mcCA9IGRybV9maXhwX211bCh0dS5vcmlnaW5hbF9yYXRp
b19mcCwgdGVtcDFfZnApOworCXRlbXAxX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbih0dS52
YWxpZF9ib3VuZGFyeV9saW5rLCAxKTsKKwl0ZW1wMl9mcCA9IHRlbXAxX2ZwIC0gdGVtcDJfZnA7
CisJdGVtcDFfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHR1Lm5fdHVzICsgMSwgMSk7CisJ
dGVtcDJfZnAgPSBkcm1fZml4cF9tdWwodGVtcDFfZnAsIHRlbXAyX2ZwKTsKKworCXRlbXAgPSBk
cm1fZml4cDJpbnQodGVtcDJfZnApOworCWlmICh0ZW1wICYmIHRlbXAyX2ZwKQorCQl0dS5leHRy
YV9ieXRlcyA9IGRybV9maXhwMmludF9jZWlsKHRlbXAyX2ZwKTsKKwllbHNlCisJCXR1LmV4dHJh
X2J5dGVzID0gMDsKKworCXRlbXAxX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbih0dS5leHRy
YV9ieXRlcywgMSk7CisJdGVtcDJfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKDgsIHR1LmJw
cCk7CisJdGVtcDFfZnAgPSBkcm1fZml4cF9tdWwodGVtcDFfZnAsIHRlbXAyX2ZwKTsKKworCXRl
bXAgPSBkcm1fZml4cDJpbnQodGVtcDFfZnApOworCWlmICh0ZW1wICYmIHRlbXAxX2ZwKQorCQl0
dS5leHRyYV9wY2xrX2N5Y2xlcyA9IGRybV9maXhwMmludF9jZWlsKHRlbXAxX2ZwKTsKKwllbHNl
CisJCXR1LmV4dHJhX3BjbGtfY3ljbGVzID0gMDsKKworCXRlbXAxX2ZwID0gZHJtX2ZpeHBfZGl2
KHR1LmxjbGtfZnAsIHR1LnBjbGtfZnApOworCXRlbXAyX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFj
dGlvbih0dS5leHRyYV9wY2xrX2N5Y2xlcywgMSk7CisJdGVtcDFfZnAgPSBkcm1fZml4cF9tdWwo
dGVtcDJfZnAsIHRlbXAxX2ZwKTsKKworCXRlbXAgPSBkcm1fZml4cDJpbnQodGVtcDFfZnApOwor
CWlmICh0ZW1wICYmIHRlbXAxX2ZwKQorCQl0dS5leHRyYV9wY2xrX2N5Y2xlc19pbl9saW5rX2Ns
ayA9IGRybV9maXhwMmludF9jZWlsKHRlbXAxX2ZwKTsKKwllbHNlCisJCXR1LmV4dHJhX3BjbGtf
Y3ljbGVzX2luX2xpbmtfY2xrID0gMDsKKworCXR1LmZpbGxlcl9zaXplID0gdHUudHVfc2l6ZV9k
ZXNpcmVkIC0gdHUudmFsaWRfYm91bmRhcnlfbGluazsKKworCXRlbXAxX2ZwID0gZHJtX2ZpeHBf
ZnJvbV9mcmFjdGlvbih0dS50dV9zaXplX2Rlc2lyZWQsIDEpOworCXR1LnJhdGlvX2J5X3R1X2Zw
ID0gZHJtX2ZpeHBfbXVsKHR1LnJhdGlvX2ZwLCB0ZW1wMV9mcCk7CisKKwl0dS5kZWxheV9zdGFy
dF9saW5rID0gdHUuZXh0cmFfcGNsa19jeWNsZXNfaW5fbGlua19jbGsgKworCQkJCXR1LmZpbGxl
cl9zaXplICsgdHUuZXh0cmFfYnVmZmVyX21hcmdpbjsKKworCXR1LnJlc3VsdGluZ192YWxpZF9m
cCA9CisJCQlkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHR1LnZhbGlkX2JvdW5kYXJ5X2xpbmssIDEp
OworCisJdGVtcDFfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHR1LnR1X3NpemVfZGVzaXJl
ZCwgMSk7CisJdGVtcDJfZnAgPSBkcm1fZml4cF9kaXYodHUucmVzdWx0aW5nX3ZhbGlkX2ZwLCB0
ZW1wMV9mcCk7CisJdHUuVFVfcmF0aW9fZXJyX2ZwID0gdGVtcDJfZnAgLSB0dS5vcmlnaW5hbF9y
YXRpb19mcDsKKworCXRlbXAxX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbigKKwkJCSh0dS5o
YnBfcmVsYXRpdmVfdG9fcGNsayAtIEhCTEFOS19NQVJHSU4pLCAxKTsKKwl0dS5oYnBfdGltZV9m
cCA9IGRybV9maXhwX2Rpdih0ZW1wMV9mcCwgdHUucGNsa19mcCk7CisKKwl0ZW1wMV9mcCA9IGRy
bV9maXhwX2Zyb21fZnJhY3Rpb24odHUuZGVsYXlfc3RhcnRfbGluaywgMSk7CisJdHUuZGVsYXlf
c3RhcnRfdGltZV9mcCA9IGRybV9maXhwX2Rpdih0ZW1wMV9mcCwgdHUubGNsa19mcCk7CisKKwlj
b21wYXJlX3Jlc3VsdF8xID0gX3R1X3BhcmFtX2NvbXBhcmUodHUuaGJwX3RpbWVfZnAsCisJCQkJ
CXR1LmRlbGF5X3N0YXJ0X3RpbWVfZnApOworCWlmIChjb21wYXJlX3Jlc3VsdF8xID09IDIpIC8q
IGlmIChoYnBfdGltZV9mcCA8IGRlbGF5X3N0YXJ0X3RpbWVfZnApICovCisJCXR1Lm1pbl9oYmxh
bmtfdmlvbGF0ZWQgPSAxOworCisJdGVtcDFfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHR1
Lmx3aWR0aCwgMSk7CisJdHUuaGFjdGl2ZV90aW1lX2ZwID0gZHJtX2ZpeHBfZGl2KHRlbXAxX2Zw
LCB0dS5wY2xrX2ZwKTsKKworCWNvbXBhcmVfcmVzdWx0XzIgPSBfdHVfcGFyYW1fY29tcGFyZSh0
dS5oYWN0aXZlX3RpbWVfZnAsCisJCQkJCQl0dS5kZWxheV9zdGFydF90aW1lX2ZwKTsKKwlpZiAo
Y29tcGFyZV9yZXN1bHRfMiA9PSAyKQorCQl0dS5taW5faGJsYW5rX3Zpb2xhdGVkID0gMTsKKwor
CXR1LmRlbGF5X3N0YXJ0X3RpbWVfZnAgPSAwOworCisJLyogYnJ1dGUgZm9yY2UgKi8KKworCXR1
LmRlbGF5X3N0YXJ0X2xpbmtfZXh0cmFfcGl4Y2xrID0gRVhUUkFfUElYQ0xLX0NZQ0xFX0RFTEFZ
OworCXR1LmRpZmZfYWJzX2ZwID0gdHUucmVzdWx0aW5nX3ZhbGlkX2ZwIC0gdHUucmF0aW9fYnlf
dHVfZnA7CisKKwl0ZW1wID0gZHJtX2ZpeHAyaW50KHR1LmRpZmZfYWJzX2ZwKTsKKwlpZiAoIXRl
bXAgJiYgdHUuZGlmZl9hYnNfZnAgPD0gMHhmZmZmKQorCQl0dS5kaWZmX2Fic19mcCA9IDA7CisK
KwkvKiBpZihkaWZmX2FicyA8IDApIGRpZmZfYWJzICo9IC0xICovCisJaWYgKHR1LmRpZmZfYWJz
X2ZwIDwgMCkKKwkJdHUuZGlmZl9hYnNfZnAgPSBkcm1fZml4cF9tdWwodHUuZGlmZl9hYnNfZnAs
IC0xKTsKKworCXR1LmJvdW5kYXJ5X21vZF9sb3dlcl9lcnIgPSAwOworCWlmICgodHUuZGlmZl9h
YnNfZnAgIT0gMCAmJgorCQkJKCh0dS5kaWZmX2Fic19mcCA+IEJSVVRFX0ZPUkNFX1RIUkVTSE9M
RF9mcCkgfHwKKwkJCSAodHUuZXZlbl9kaXN0cmlidXRpb25fbGVnYWN5ID09IDApIHx8CisJCQkg
KERQX0JSVVRFX0ZPUkNFID09IDEpKSkgfHwKKwkJCSh0dS5taW5faGJsYW5rX3Zpb2xhdGVkID09
IDEpKSB7CisJCWRvIHsKKwkJCXR1LmVycl9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24oMTAw
MCwgMSk7CisKKwkJCXRlbXAxX2ZwID0gZHJtX2ZpeHBfZGl2KHR1LmxjbGtfZnAsIHR1LnBjbGtf
ZnApOworCQkJdGVtcDJfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKAorCQkJCQl0dS5kZWxh
eV9zdGFydF9saW5rX2V4dHJhX3BpeGNsaywgMSk7CisJCQl0ZW1wMV9mcCA9IGRybV9maXhwX211
bCh0ZW1wMl9mcCwgdGVtcDFfZnApOworCisJCQlpZiAodGVtcDFfZnApCisJCQkJdHUuZXh0cmFf
YnVmZmVyX21hcmdpbiA9CisJCQkJCWRybV9maXhwMmludF9jZWlsKHRlbXAxX2ZwKTsKKwkJCWVs
c2UKKwkJCQl0dS5leHRyYV9idWZmZXJfbWFyZ2luID0gMDsKKworCQkJdGVtcDFfZnAgPSBkcm1f
Zml4cF9mcm9tX2ZyYWN0aW9uKHR1LmJwcCwgOCk7CisJCQl0ZW1wMl9mcCA9IGRybV9maXhwX2Zy
b21fZnJhY3Rpb24odHUubHdpZHRoLCAxKTsKKwkJCXRlbXAxX2ZwID0gZHJtX2ZpeHBfbXVsKHRl
bXAyX2ZwLCB0ZW1wMV9mcCk7CisKKwkJCWlmICh0ZW1wMV9mcCkKKwkJCQl0dS5uX3N5bWJvbHMg
PSBkcm1fZml4cDJpbnRfY2VpbCh0ZW1wMV9mcCk7CisJCQllbHNlCisJCQkJdHUubl9zeW1ib2xz
ID0gMDsKKworCQkJZm9yICh0dS50dV9zaXplID0gMzI7IHR1LnR1X3NpemUgPD0gNjQ7IHR1LnR1
X3NpemUrKykgeworCQkJCWZvciAodHUuaV91cHBlcl9ib3VuZGFyeV9jb3VudCA9IDE7CisJCQkJ
CXR1LmlfdXBwZXJfYm91bmRhcnlfY291bnQgPD0gMTU7CisJCQkJCXR1LmlfdXBwZXJfYm91bmRh
cnlfY291bnQrKykgeworCQkJCQlmb3IgKHR1LmlfbG93ZXJfYm91bmRhcnlfY291bnQgPSAxOwor
CQkJCQkJdHUuaV9sb3dlcl9ib3VuZGFyeV9jb3VudCA8PSAxNTsKKwkJCQkJCXR1LmlfbG93ZXJf
Ym91bmRhcnlfY291bnQrKykgeworCQkJCQkJX3R1X3ZhbGlkX2JvdW5kYXJ5X2NhbGMoJnR1KTsK
KwkJCQkJfQorCQkJCX0KKwkJCX0KKwkJCXR1LmRlbGF5X3N0YXJ0X2xpbmtfZXh0cmFfcGl4Y2xr
LS07CisJCX0gd2hpbGUgKHR1LmJvdW5kYXJ5X21vZGVyYXRpb25fZW4gIT0gdHJ1ZSAmJgorCQkJ
dHUuYm91bmRhcnlfbW9kX2xvd2VyX2VyciA9PSAxICYmCisJCQl0dS5kZWxheV9zdGFydF9saW5r
X2V4dHJhX3BpeGNsayAhPSAwKTsKKworCQlpZiAodHUuYm91bmRhcnlfbW9kZXJhdGlvbl9lbiA9
PSB0cnVlKSB7CisJCQl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24oCisJCQkJCSh0
dS51cHBlcl9ib3VuZGFyeV9jb3VudCAqCisJCQkJCXR1LnZhbGlkX2JvdW5kYXJ5X2xpbmsgKwor
CQkJCQl0dS5sb3dlcl9ib3VuZGFyeV9jb3VudCAqCisJCQkJCSh0dS52YWxpZF9ib3VuZGFyeV9s
aW5rIC0gMSkpLCAxKTsKKwkJCXRlbXAyX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbigKKwkJ
CQkJKHR1LnVwcGVyX2JvdW5kYXJ5X2NvdW50ICsKKwkJCQkJdHUubG93ZXJfYm91bmRhcnlfY291
bnQpLCAxKTsKKwkJCXR1LnJlc3VsdGluZ192YWxpZF9mcCA9CisJCQkJCWRybV9maXhwX2Rpdih0
ZW1wMV9mcCwgdGVtcDJfZnApOworCisJCQl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rp
b24oCisJCQkJCXR1LnR1X3NpemVfZGVzaXJlZCwgMSk7CisJCQl0dS5yYXRpb19ieV90dV9mcCA9
CisJCQkJZHJtX2ZpeHBfbXVsKHR1Lm9yaWdpbmFsX3JhdGlvX2ZwLCB0ZW1wMV9mcCk7CisKKwkJ
CXR1LnZhbGlkX2xvd2VyX2JvdW5kYXJ5X2xpbmsgPQorCQkJCXR1LnZhbGlkX2JvdW5kYXJ5X2xp
bmsgLSAxOworCisJCQl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24odHUuYnBwLCA4
KTsKKwkJCXRlbXAyX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbih0dS5sd2lkdGgsIDEpOwor
CQkJdGVtcDFfZnAgPSBkcm1fZml4cF9tdWwodGVtcDJfZnAsIHRlbXAxX2ZwKTsKKwkJCXRlbXAy
X2ZwID0gZHJtX2ZpeHBfZGl2KHRlbXAxX2ZwLAorCQkJCQkJdHUucmVzdWx0aW5nX3ZhbGlkX2Zw
KTsKKwkJCXR1Lm5fdHVzID0gZHJtX2ZpeHAyaW50KHRlbXAyX2ZwKTsKKworCQkJdHUudHVfc2l6
ZV9taW51czEgPSB0dS50dV9zaXplX2Rlc2lyZWQgLSAxOworCQkJdHUuZXZlbl9kaXN0cmlidXRp
b25fQkYgPSAxOworCisJCQl0ZW1wMV9mcCA9CisJCQkJZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbih0
dS50dV9zaXplX2Rlc2lyZWQsIDEpOworCQkJdGVtcDJfZnAgPQorCQkJCWRybV9maXhwX2Rpdih0
dS5yZXN1bHRpbmdfdmFsaWRfZnAsIHRlbXAxX2ZwKTsKKwkJCXR1LlRVX3JhdGlvX2Vycl9mcCA9
IHRlbXAyX2ZwIC0gdHUub3JpZ2luYWxfcmF0aW9fZnA7CisJCX0KKwl9CisKKwl0ZW1wMV9mcCA9
IGRybV9maXhwX2Zyb21fZnJhY3Rpb24odHUubHdpZHRoLCAxKTsKKwl0ZW1wMl9mcCA9IGRybV9m
aXhwX211bChMQ0xLX0ZBU1RfU0tFV19mcCwgdGVtcDFfZnApOworCisJaWYgKHRlbXAyX2ZwKQor
CQl0ZW1wID0gZHJtX2ZpeHAyaW50X2NlaWwodGVtcDJfZnApOworCWVsc2UKKwkJdGVtcCA9IDA7
CisKKwl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24odHUubmxhbmVzLCAxKTsKKwl0
ZW1wMl9mcCA9IGRybV9maXhwX211bCh0dS5vcmlnaW5hbF9yYXRpb19mcCwgdGVtcDFfZnApOwor
CXRlbXAxX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbih0dS5icHAsIDgpOworCXRlbXAyX2Zw
ID0gZHJtX2ZpeHBfZGl2KHRlbXAxX2ZwLCB0ZW1wMl9mcCk7CisJdGVtcDFfZnAgPSBkcm1fZml4
cF9mcm9tX2ZyYWN0aW9uKHRlbXAsIDEpOworCXRlbXAyX2ZwID0gZHJtX2ZpeHBfbXVsKHRlbXAx
X2ZwLCB0ZW1wMl9mcCk7CisJdGVtcCA9IGRybV9maXhwMmludCh0ZW1wMl9mcCk7CisKKwlpZiAo
dHUuYXN5bmNfZW4pCisJCXR1LmRlbGF5X3N0YXJ0X2xpbmsgKz0gKGludCl0ZW1wOworCisJdGVt
cDFfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHR1LmRlbGF5X3N0YXJ0X2xpbmssIDEpOwor
CXR1LmRlbGF5X3N0YXJ0X3RpbWVfZnAgPSBkcm1fZml4cF9kaXYodGVtcDFfZnAsIHR1LmxjbGtf
ZnApOworCisJLyogT1VUUFVUUyAqLworCXR1X3RhYmxlLT52YWxpZF9ib3VuZGFyeV9saW5rICAg
ICAgID0gdHUudmFsaWRfYm91bmRhcnlfbGluazsKKwl0dV90YWJsZS0+ZGVsYXlfc3RhcnRfbGlu
ayAgICAgICAgICA9IHR1LmRlbGF5X3N0YXJ0X2xpbms7CisJdHVfdGFibGUtPmJvdW5kYXJ5X21v
ZGVyYXRpb25fZW4gICAgPSB0dS5ib3VuZGFyeV9tb2RlcmF0aW9uX2VuOworCXR1X3RhYmxlLT52
YWxpZF9sb3dlcl9ib3VuZGFyeV9saW5rID0gdHUudmFsaWRfbG93ZXJfYm91bmRhcnlfbGluazsK
Kwl0dV90YWJsZS0+dXBwZXJfYm91bmRhcnlfY291bnQgICAgICA9IHR1LnVwcGVyX2JvdW5kYXJ5
X2NvdW50OworCXR1X3RhYmxlLT5sb3dlcl9ib3VuZGFyeV9jb3VudCAgICAgID0gdHUubG93ZXJf
Ym91bmRhcnlfY291bnQ7CisJdHVfdGFibGUtPnR1X3NpemVfbWludXMxICAgICAgICAgICAgPSB0
dS50dV9zaXplX21pbnVzMTsKKworCURSTV9ERUJVR19EUCgiVFU6IHZhbGlkX2JvdW5kYXJ5X2xp
bms6ICVkXG4iLCB0dV90YWJsZS0+dmFsaWRfYm91bmRhcnlfbGluayk7CisJRFJNX0RFQlVHX0RQ
KCJUVTogZGVsYXlfc3RhcnRfbGluazogJWRcbiIsIHR1X3RhYmxlLT5kZWxheV9zdGFydF9saW5r
KTsKKwlEUk1fREVCVUdfRFAoIlRVOiBib3VuZGFyeV9tb2RlcmF0aW9uX2VuOiAlZFxuIiwKKwkJ
CXR1X3RhYmxlLT5ib3VuZGFyeV9tb2RlcmF0aW9uX2VuKTsKKwlEUk1fREVCVUdfRFAoIlRVOiB2
YWxpZF9sb3dlcl9ib3VuZGFyeV9saW5rOiAlZFxuIiwKKwkJCXR1X3RhYmxlLT52YWxpZF9sb3dl
cl9ib3VuZGFyeV9saW5rKTsKKwlEUk1fREVCVUdfRFAoIlRVOiB1cHBlcl9ib3VuZGFyeV9jb3Vu
dDogJWRcbiIsCisJCQl0dV90YWJsZS0+dXBwZXJfYm91bmRhcnlfY291bnQpOworCURSTV9ERUJV
R19EUCgiVFU6IGxvd2VyX2JvdW5kYXJ5X2NvdW50OiAlZFxuIiwKKwkJCXR1X3RhYmxlLT5sb3dl
cl9ib3VuZGFyeV9jb3VudCk7CisJRFJNX0RFQlVHX0RQKCJUVTogdHVfc2l6ZV9taW51czE6ICVk
XG4iLCB0dV90YWJsZS0+dHVfc2l6ZV9taW51czEpOworfQorCitzdGF0aWMgdm9pZCBkcF9jdHJs
X2NhbGNfdHVfcGFyYW1ldGVycyhzdHJ1Y3QgZHBfY3RybF9wcml2YXRlICpjdHJsLAorCQlzdHJ1
Y3QgZHBfdmNfdHVfbWFwcGluZ190YWJsZSAqdHVfdGFibGUpCit7CisJc3RydWN0IGRwX3R1X2Nh
bGNfaW5wdXQgaW47CisJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmRybV9tb2RlOworCisJZHJt
X21vZGUgPSAmY3RybC0+cGFuZWwtPmRwX21vZGUuZHJtX21vZGU7CisKKwlpbi5sY2xrID0gY3Ry
bC0+bGluay0+bGlua19wYXJhbXMucmF0ZSAvIDEwMDA7CisJaW4ucGNsa19raHogPSBkcm1fbW9k
ZS0+Y2xvY2s7CisJaW4uaGFjdGl2ZSA9IGRybV9tb2RlLT5oZGlzcGxheTsKKwlpbi5ocG9yY2gg
PSBkcm1fbW9kZS0+aHRvdGFsIC0gZHJtX21vZGUtPmhkaXNwbGF5OworCWluLm5sYW5lcyA9IGN0
cmwtPmxpbmstPmxpbmtfcGFyYW1zLm51bV9sYW5lczsKKwlpbi5icHAgPSBjdHJsLT5wYW5lbC0+
ZHBfbW9kZS5icHA7CisJaW4ucGl4ZWxfZW5jID0gNDQ0OworCWluLmRzY19lbiA9IDA7CisJaW4u
YXN5bmNfZW4gPSAwOworCisJX2RwX2N0cmxfY2FsY190dSgmaW4sIHR1X3RhYmxlKTsKK30KKwor
c3RhdGljIHZvaWQgZHBfY3RybF9zZXR1cF90cl91bml0KHN0cnVjdCBkcF9jdHJsX3ByaXZhdGUg
KmN0cmwpCit7CisJdTMyIGRwX3R1ID0gMHgwOworCXUzMiB2YWxpZF9ib3VuZGFyeSA9IDB4MDsK
Kwl1MzIgdmFsaWRfYm91bmRhcnkyID0gMHgwOworCXN0cnVjdCBkcF92Y190dV9tYXBwaW5nX3Rh
YmxlIHR1X2NhbGNfdGFibGU7CisKKwlkcF9jdHJsX2NhbGNfdHVfcGFyYW1ldGVycyhjdHJsLCAm
dHVfY2FsY190YWJsZSk7CisKKwlkcF90dSB8PSB0dV9jYWxjX3RhYmxlLnR1X3NpemVfbWludXMx
OworCXZhbGlkX2JvdW5kYXJ5IHw9IHR1X2NhbGNfdGFibGUudmFsaWRfYm91bmRhcnlfbGluazsK
Kwl2YWxpZF9ib3VuZGFyeSB8PSAodHVfY2FsY190YWJsZS5kZWxheV9zdGFydF9saW5rIDw8IDE2
KTsKKworCXZhbGlkX2JvdW5kYXJ5MiB8PSAodHVfY2FsY190YWJsZS52YWxpZF9sb3dlcl9ib3Vu
ZGFyeV9saW5rIDw8IDEpOworCXZhbGlkX2JvdW5kYXJ5MiB8PSAodHVfY2FsY190YWJsZS51cHBl
cl9ib3VuZGFyeV9jb3VudCA8PCAxNik7CisJdmFsaWRfYm91bmRhcnkyIHw9ICh0dV9jYWxjX3Rh
YmxlLmxvd2VyX2JvdW5kYXJ5X2NvdW50IDw8IDIwKTsKKworCWlmICh0dV9jYWxjX3RhYmxlLmJv
dW5kYXJ5X21vZGVyYXRpb25fZW4pCisJCXZhbGlkX2JvdW5kYXJ5MiB8PSBCSVQoMCk7CisKKwlw
cl9kZWJ1ZygiZHBfdHU9MHgleCwgdmFsaWRfYm91bmRhcnk9MHgleCwgdmFsaWRfYm91bmRhcnky
PTB4JXhcbiIsCisJCQlkcF90dSwgdmFsaWRfYm91bmRhcnksIHZhbGlkX2JvdW5kYXJ5Mik7CisK
KwlkcF9jYXRhbG9nX2N0cmxfdXBkYXRlX3RyYW5zZmVyX3VuaXQoY3RybC0+Y2F0YWxvZywKKwkJ
CQlkcF90dSwgdmFsaWRfYm91bmRhcnksIHZhbGlkX2JvdW5kYXJ5Mik7Cit9CisKK3N0YXRpYyBp
bnQgZHBfY3RybF93YWl0NHZpZGVvX3JlYWR5KHN0cnVjdCBkcF9jdHJsX3ByaXZhdGUgKmN0cmwp
Cit7CisJaW50IHJldCA9IDA7CisKKwlpZiAoIXdhaXRfZm9yX2NvbXBsZXRpb25fdGltZW91dCgm
Y3RybC0+dmlkZW9fY29tcCwKKwkJCQlXQUlUX0ZPUl9WSURFT19SRUFEWV9USU1FT1VUX0pJRkZJ
RVMpKSB7CisJCURSTV9FUlJPUigiTGluayBUcmFpbiB0aW1lZG91dFxuIik7CisJCXJldCA9IC1F
VElNRURPVVQ7CisJfQorCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgZHBfY3RybF91cGRh
dGVfdnhfcHgoc3RydWN0IGRwX2N0cmxfcHJpdmF0ZSAqY3RybCkKK3sKKwlzdHJ1Y3QgZHBfbGlu
ayAqbGluayA9IGN0cmwtPmxpbms7CisJaW50IHJldCA9IDAsIGxhbmUsIGxhbmVfY250OworCXU4
IGJ1Zls0XTsKKwl1MzIgbWF4X2xldmVsX3JlYWNoZWQgPSAwOworCXUzMiB2b2x0YWdlX3N3aW5n
X2xldmVsID0gbGluay0+cGh5X3BhcmFtcy52X2xldmVsOworCXUzMiBwcmVfZW1waGFzaXNfbGV2
ZWwgPSBsaW5rLT5waHlfcGFyYW1zLnBfbGV2ZWw7CisKKwlyZXQgPSBkcF9jYXRhbG9nX2N0cmxf
dXBkYXRlX3Z4X3B4KGN0cmwtPmNhdGFsb2csCisJCXZvbHRhZ2Vfc3dpbmdfbGV2ZWwsIHByZV9l
bXBoYXNpc19sZXZlbCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCWlmICh2b2x0YWdl
X3N3aW5nX2xldmVsID4gRFBfVFJBSU5fVk9MVEFHRV9TV0lOR19NQVgpIHsKKwkJRFJNX0RFQlVH
X0RQKCJtYXguIHZvbHRhZ2Ugc3dpbmcgbGV2ZWwgcmVhY2hlZCAlZFxuIiwKKwkJCQl2b2x0YWdl
X3N3aW5nX2xldmVsKTsKKwkJbWF4X2xldmVsX3JlYWNoZWQgfD0gRFBfVFJBSU5fTUFYX1NXSU5H
X1JFQUNIRUQ7CisJfQorCisJaWYgKHByZV9lbXBoYXNpc19sZXZlbCA9PSBEUF9UUkFJTl9QUkVf
RU1QSEFTSVNfTUFYKSB7CisJCURSTV9ERUJVR19EUCgibWF4LiBwcmUtZW1waGFzaXMgbGV2ZWwg
cmVhY2hlZCAlZFxuIiwKKwkJCQlwcmVfZW1waGFzaXNfbGV2ZWwpOworCQltYXhfbGV2ZWxfcmVh
Y2hlZCAgfD0gRFBfVFJBSU5fTUFYX1BSRV9FTVBIQVNJU19SRUFDSEVEOworCX0KKworCXByZV9l
bXBoYXNpc19sZXZlbCA8PD0gRFBfVFJBSU5fUFJFX0VNUEhBU0lTX1NISUZUOworCisJbGFuZV9j
bnQgPSBjdHJsLT5saW5rLT5saW5rX3BhcmFtcy5udW1fbGFuZXM7CisJZm9yIChsYW5lID0gMDsg
bGFuZSA8IGxhbmVfY250OyBsYW5lKyspCisJCWJ1ZltsYW5lXSA9IHZvbHRhZ2Vfc3dpbmdfbGV2
ZWwgfCBwcmVfZW1waGFzaXNfbGV2ZWwgfCBtYXhfbGV2ZWxfcmVhY2hlZDsKKworCURSTV9ERUJV
R19EUCgic2luazogcHx2PTB4JXhcbiIsIHZvbHRhZ2Vfc3dpbmdfbGV2ZWwgfCBwcmVfZW1waGFz
aXNfbGV2ZWwpOworCXJldCA9IGRybV9kcF9kcGNkX3dyaXRlKGN0cmwtPmF1eC0+ZHJtX2F1eCwg
RFBfVFJBSU5JTkdfTEFORTBfU0VULCBidWYsIGxhbmVfY250KTsKKwlpZiAocmV0ID09IGxhbmVf
Y250KQorCQlyZXQgPSAwOworCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGJvb2wgZHBfY3Ry
bF90cmFpbl9wYXR0ZXJuX3NldChzdHJ1Y3QgZHBfY3RybF9wcml2YXRlICpjdHJsLAorCQl1OCBw
YXR0ZXJuKQoreworCXU4IGJ1ZjsKKwlpbnQgcmV0ID0gMDsKKworCURSTV9ERUJVR19EUCgic2lu
azogcGF0dGVybj0leFxuIiwgcGF0dGVybik7CisKKwlidWYgPSBwYXR0ZXJuOworCXJldCA9IGRy
bV9kcF9kcGNkX3dyaXRlYihjdHJsLT5hdXgtPmRybV9hdXgsIERQX1RSQUlOSU5HX1BBVFRFUk5f
U0VULCBidWYpOworCXJldHVybiByZXQgPT0gMTsKK30KKworc3RhdGljIGludCBkcF9jdHJsX3Jl
YWRfbGlua19zdGF0dXMoc3RydWN0IGRwX2N0cmxfcHJpdmF0ZSAqY3RybCwKKwkJCQkgICAgdTgg
Kmxpbmtfc3RhdHVzKQoreworCWludCBsZW4gPSAwOworCXUzMiBjb25zdCBvZmZzZXQgPSBEUF9M
QU5FX0FMSUdOX1NUQVRVU19VUERBVEVEIC0gRFBfTEFORTBfMV9TVEFUVVM7CisJdTMyIGxpbmtf
c3RhdHVzX3JlYWRfbWF4X3JldHJpZXMgPSAxMDA7CisKKwl3aGlsZSAoLS1saW5rX3N0YXR1c19y
ZWFkX21heF9yZXRyaWVzKSB7CisJCWxlbiA9IGRybV9kcF9kcGNkX3JlYWRfbGlua19zdGF0dXMo
Y3RybC0+YXV4LT5kcm1fYXV4LAorCQkJbGlua19zdGF0dXMpOworCQlpZiAobGVuICE9IERQX0xJ
TktfU1RBVFVTX1NJWkUpIHsKKwkJCURSTV9FUlJPUigiRFAgbGluayBzdGF0dXMgcmVhZCBmYWls
ZWQsIGVycjogJWRcbiIsIGxlbik7CisJCQlyZXR1cm4gbGVuOworCQl9CisKKwkJaWYgKCEobGlu
a19zdGF0dXNbb2Zmc2V0XSAmIERQX0xJTktfU1RBVFVTX1VQREFURUQpKQorCQkJcmV0dXJuIDA7
CisJfQorCisJcmV0dXJuIC1FVElNRURPVVQ7Cit9CisKK3N0YXRpYyBpbnQgZHBfY3RybF9saW5r
X3RyYWluXzEoc3RydWN0IGRwX2N0cmxfcHJpdmF0ZSAqY3RybCkKK3sKKwlpbnQgdHJpZXMsIG9s
ZF92X2xldmVsLCByZXQgPSAwOworCXU4IGxpbmtfc3RhdHVzW0RQX0xJTktfU1RBVFVTX1NJWkVd
OworCWludCBjb25zdCBtYXhpbXVtX3JldHJpZXMgPSA1OworCisJZHBfY2F0YWxvZ19jdHJsX3N0
YXRlX2N0cmwoY3RybC0+Y2F0YWxvZywgMCk7CisKKwlyZXQgPSBkcF9jYXRhbG9nX2N0cmxfc2V0
X3BhdHRlcm4oY3RybC0+Y2F0YWxvZywgRFBfVFJBSU5JTkdfUEFUVEVSTl8xKTsKKwlpZiAocmV0
KQorCQlyZXR1cm4gcmV0OworCWRwX2N0cmxfdHJhaW5fcGF0dGVybl9zZXQoY3RybCwgRFBfVFJB
SU5JTkdfUEFUVEVSTl8xIHwKKwkJRFBfTElOS19TQ1JBTUJMSU5HX0RJU0FCTEUpOworCXJldCA9
IGRwX2N0cmxfdXBkYXRlX3Z4X3B4KGN0cmwpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisK
Kwl0cmllcyA9IDA7CisJb2xkX3ZfbGV2ZWwgPSBjdHJsLT5saW5rLT5waHlfcGFyYW1zLnZfbGV2
ZWw7CisJZm9yICh0cmllcyA9IDA7IHRyaWVzIDwgbWF4aW11bV9yZXRyaWVzOyB0cmllcysrKSB7
CisJCWRybV9kcF9saW5rX3RyYWluX2Nsb2NrX3JlY292ZXJ5X2RlbGF5KGN0cmwtPnBhbmVsLT5k
cGNkKTsKKworCQlyZXQgPSBkcF9jdHJsX3JlYWRfbGlua19zdGF0dXMoY3RybCwgbGlua19zdGF0
dXMpOworCQlpZiAocmV0KQorCQkJcmV0dXJuIHJldDsKKworCQlpZiAoZHJtX2RwX2Nsb2NrX3Jl
Y292ZXJ5X29rKGxpbmtfc3RhdHVzLAorCQkJY3RybC0+bGluay0+bGlua19wYXJhbXMubnVtX2xh
bmVzKSkgeworCQkJcmV0dXJuIHJldDsKKwkJfQorCisJCWlmIChjdHJsLT5saW5rLT5waHlfcGFy
YW1zLnZfbGV2ZWwgPiBEUF9UUkFJTl9WT0xUQUdFX1NXSU5HX01BWCkgeworCQkJRFJNX0VSUk9S
X1JBVEVMSU1JVEVEKCJtYXggdl9sZXZlbCByZWFjaGVkXG4iKTsKKwkJCXJldHVybiAtRUFHQUlO
OworCQl9CisKKwkJaWYgKG9sZF92X2xldmVsICE9IGN0cmwtPmxpbmstPnBoeV9wYXJhbXMudl9s
ZXZlbCkgeworCQkJdHJpZXMgPSAwOworCQkJb2xkX3ZfbGV2ZWwgPSBjdHJsLT5saW5rLT5waHlf
cGFyYW1zLnZfbGV2ZWw7CisJCX0KKworCQlEUk1fREVCVUdfRFAoImNsb2NrIHJlY292ZXJ5IG5v
dCBkb25lLCBhZGp1c3RpbmcgdnggcHhcbiIpOworCisJCWRwX2xpbmtfYWRqdXN0X2xldmVscyhj
dHJsLT5saW5rLCBsaW5rX3N0YXR1cyk7CisJCXJldCA9IGRwX2N0cmxfdXBkYXRlX3Z4X3B4KGN0
cmwpOworCQlpZiAocmV0KQorCQkJcmV0dXJuIHJldDsKKwl9CisKKwlEUk1fRVJST1IoIm1heCB0
cmllcyByZWFjaGVkXG4iKTsKKwlyZXR1cm4gLUVUSU1FRE9VVDsKK30KKworc3RhdGljIGludCBk
cF9jdHJsX2xpbmtfcmF0ZV9kb3duX3NoaWZ0KHN0cnVjdCBkcF9jdHJsX3ByaXZhdGUgKmN0cmwp
Cit7CisJaW50IHJldCA9IDA7CisKKwlzd2l0Y2ggKGN0cmwtPmxpbmstPmxpbmtfcGFyYW1zLnJh
dGUpIHsKKwljYXNlIDgxMDAwMDoKKwkJY3RybC0+bGluay0+bGlua19wYXJhbXMucmF0ZSA9IDU0
MDAwMDsKKwkJYnJlYWs7CisJY2FzZSA1NDAwMDA6CisJCWN0cmwtPmxpbmstPmxpbmtfcGFyYW1z
LnJhdGUgPSAyNzAwMDA7CisJCWJyZWFrOworCWNhc2UgMjcwMDAwOgorCWNhc2UgMTYyMDAwOgor
CWRlZmF1bHQ6CisJCWN0cmwtPmxpbmstPmxpbmtfcGFyYW1zLnJhdGUgPSAxNjIwMDA7CisJCWJy
ZWFrOworCX07CisKKwlEUk1fREVCVUdfRFAoIm5ldyByYXRlPTB4JXhcbiIsIGN0cmwtPmxpbmst
PmxpbmtfcGFyYW1zLnJhdGUpOworCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIHZvaWQgZHBf
Y3RybF9jbGVhcl90cmFpbmluZ19wYXR0ZXJuKHN0cnVjdCBkcF9jdHJsX3ByaXZhdGUgKmN0cmwp
Cit7CisJZHBfY3RybF90cmFpbl9wYXR0ZXJuX3NldChjdHJsLCBEUF9UUkFJTklOR19QQVRURVJO
X0RJU0FCTEUpOworCWRybV9kcF9saW5rX3RyYWluX2NoYW5uZWxfZXFfZGVsYXkoY3RybC0+cGFu
ZWwtPmRwY2QpOworfQorCitzdGF0aWMgaW50IGRwX2N0cmxfbGlua190cmFpbmluZ18yKHN0cnVj
dCBkcF9jdHJsX3ByaXZhdGUgKmN0cmwpCit7CisJaW50IHRyaWVzID0gMCwgcmV0ID0gMDsKKwlj
aGFyIHBhdHRlcm47CisJaW50IGNvbnN0IG1heGltdW1fcmV0cmllcyA9IDU7CisJdTggbGlua19z
dGF0dXNbRFBfTElOS19TVEFUVVNfU0laRV07CisKKwlkcF9jYXRhbG9nX2N0cmxfc3RhdGVfY3Ry
bChjdHJsLT5jYXRhbG9nLCAwKTsKKworCWlmIChkcm1fZHBfdHBzM19zdXBwb3J0ZWQoY3RybC0+
cGFuZWwtPmRwY2QpKQorCQlwYXR0ZXJuID0gRFBfVFJBSU5JTkdfUEFUVEVSTl8zOworCWVsc2UK
KwkJcGF0dGVybiA9IERQX1RSQUlOSU5HX1BBVFRFUk5fMjsKKworCXJldCA9IGRwX2N0cmxfdXBk
YXRlX3Z4X3B4KGN0cmwpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwlyZXQgPSBkcF9j
YXRhbG9nX2N0cmxfc2V0X3BhdHRlcm4oY3RybC0+Y2F0YWxvZywgcGF0dGVybik7CisJaWYgKHJl
dCkKKwkJcmV0dXJuIHJldDsKKworCWRwX2N0cmxfdHJhaW5fcGF0dGVybl9zZXQoY3RybCwgcGF0
dGVybiB8IERQX1JFQ09WRVJFRF9DTE9DS19PVVRfRU4pOworCisJZm9yICh0cmllcyA9IDA7IHRy
aWVzIDw9IG1heGltdW1fcmV0cmllczsgdHJpZXMrKykgeworCQlkcm1fZHBfbGlua190cmFpbl9j
aGFubmVsX2VxX2RlbGF5KGN0cmwtPnBhbmVsLT5kcGNkKTsKKworCQlyZXQgPSBkcF9jdHJsX3Jl
YWRfbGlua19zdGF0dXMoY3RybCwgbGlua19zdGF0dXMpOworCQlpZiAocmV0KQorCQkJcmV0dXJu
IHJldDsKKworCQlpZiAoZHJtX2RwX2NoYW5uZWxfZXFfb2sobGlua19zdGF0dXMsCisJCQljdHJs
LT5saW5rLT5saW5rX3BhcmFtcy5udW1fbGFuZXMpKQorCQkJcmV0dXJuIHJldDsKKworCQlkcF9s
aW5rX2FkanVzdF9sZXZlbHMoY3RybC0+bGluaywgbGlua19zdGF0dXMpOworCQlyZXQgPSBkcF9j
dHJsX3VwZGF0ZV92eF9weChjdHJsKTsKKwkJaWYgKHJldCkKKwkJCXJldHVybiByZXQ7CisKKwl9
CisKKwlyZXR1cm4gLUVUSU1FRE9VVDsKK30KKworc3RhdGljIGludCBkcF9jdHJsX2xpbmtfdHJh
aW4oc3RydWN0IGRwX2N0cmxfcHJpdmF0ZSAqY3RybCkKK3sKKwlpbnQgcmV0ID0gMDsKKwl1OCBl
bmNvZGluZyA9IERQX1NFVF9BTlNJXzhCMTBCOworCXN0cnVjdCBkcm1fZHBfbGluayBsaW5rX2lu
Zm8gPSB7MH07CisKKwljdHJsLT5saW5rLT5waHlfcGFyYW1zLnBfbGV2ZWwgPSAwOworCWN0cmwt
PmxpbmstPnBoeV9wYXJhbXMudl9sZXZlbCA9IDA7CisKKwlkcF9jdHJsX2NvbmZpZ19jdHJsKGN0
cmwpOworCisJcmV0ID0gZHJtX2RwX2xpbmtfcHJvYmUoY3RybC0+YXV4LT5kcm1fYXV4LCAmbGlu
a19pbmZvKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fRVJST1IoImZhaWxlZCB0byByZXRyaWV2
ZSBsaW5rIGNhcGFiaWxpdGllcy4gcmV0PSVkXG4iLCByZXQpOworCQlkcF9jYXRhbG9nX2N0cmxf
c3RhdGVfY3RybChjdHJsLT5jYXRhbG9nLCAwKTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlkcm1f
ZHBfbGlua19jb25maWd1cmUoY3RybC0+YXV4LT5kcm1fYXV4LCAmbGlua19pbmZvKTsKKwlkcm1f
ZHBfZHBjZF93cml0ZShjdHJsLT5hdXgtPmRybV9hdXgsIERQX01BSU5fTElOS19DSEFOTkVMX0NP
RElOR19TRVQsCisJCQkJJmVuY29kaW5nLCAxKTsKKworCXJldCA9IGRwX2N0cmxfbGlua190cmFp
bl8xKGN0cmwpOworCWlmIChyZXQpIHsKKwkJRFJNX0VSUk9SKCJsaW5rIHRyYWluaW5nICMxIGZh
aWxlZC4gcmV0PSVkXG4iLCByZXQpOworCQlnb3RvIGVuZDsKKwl9CisKKwkvKiBwcmludCBzdWNj
ZXNzIGluZm8gYXMgdGhpcyBpcyBhIHJlc3VsdCBvZiB1c2VyIGluaXRpYXRlZCBhY3Rpb24gKi8K
KwlEUk1fREVCVUdfRFAoImxpbmsgdHJhaW5pbmcgIzEgc3VjY2Vzc2Z1bFxuIik7CisKKwlyZXQg
PSBkcF9jdHJsX2xpbmtfdHJhaW5pbmdfMihjdHJsKTsKKwlpZiAocmV0KSB7CisJCURSTV9FUlJP
UigibGluayB0cmFpbmluZyAjMiBmYWlsZWQuIHJldD0lZFxuIiwgcmV0KTsKKwkJZ290byBlbmQ7
CisJfQorCisJLyogcHJpbnQgc3VjY2VzcyBpbmZvIGFzIHRoaXMgaXMgYSByZXN1bHQgb2YgdXNl
ciBpbml0aWF0ZWQgYWN0aW9uICovCisJRFJNX0RFQlVHX0RQKCJsaW5rIHRyYWluaW5nICMyIHN1
Y2Nlc3NmdWxcbiIpOworCitlbmQ6CisJZHBfY2F0YWxvZ19jdHJsX3N0YXRlX2N0cmwoY3RybC0+
Y2F0YWxvZywgMCk7CisKKwlkcF9jdHJsX2NsZWFyX3RyYWluaW5nX3BhdHRlcm4oY3RybCk7CisJ
cmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBkcF9jdHJsX3NldHVwX21haW5fbGluayhzdHJ1
Y3QgZHBfY3RybF9wcml2YXRlICpjdHJsLCBib29sIHRyYWluKQoreworCWJvb2wgbWFpbmxpbmtf
cmVhZHkgPSBmYWxzZTsKKwlpbnQgcmV0ID0gMDsKKworCWRwX2NhdGFsb2dfY3RybF9tYWlubGlu
a19jdHJsKGN0cmwtPmNhdGFsb2csIHRydWUpOworCisJcmV0ID0gZHBfbGlua19wc21fY29uZmln
KGN0cmwtPmxpbmssICZjdHJsLT5wYW5lbC0+bGlua19pbmZvLCBmYWxzZSk7CisJaWYgKHJldCkK
KwkJcmV0dXJuIHJldDsKKworCWlmIChjdHJsLT5saW5rLT5zaW5rX3JlcXVlc3QgJiBEUF9URVNU
X0xJTktfUEhZX1RFU1RfUEFUVEVSTikKKwkJcmV0dXJuIHJldDsKKworCWlmICh0cmFpbikgewor
CQkvKgorCQkgKiBBcyBwYXJ0IG9mIHByZXZpb3VzIGNhbGxzLCBEUCBjb250cm9sbGVyIHN0YXRl
IG1pZ2h0IGhhdmUKKwkJICogdHJhbnNpdGlvbmVkIHRvIFBVU0hfSURMRS4gSW4gb3JkZXIgdG8g
c3RhcnQgdHJhbnNtaXR0aW5nIGEgbGluaworCQkgKiB0cmFpbmluZyBwYXR0ZXJuLCB3ZSBoYXZl
IHRvIGZpcnN0IGRvIGEgRFAgc29mdHdhcmUgcmVzZXQuCisJCSAqLworCQlkcF9jYXRhbG9nX2N0
cmxfcmVzZXQoY3RybC0+Y2F0YWxvZyk7CisKKwkJcmV0ID0gZHBfY3RybF9saW5rX3RyYWluKGN0
cmwpOworCQlpZiAocmV0KQorCQkJcmV0dXJuIHJldDsKKwl9CisKKwkvKgorCSAqIFNldCB1cCB0
cmFuc2ZlciB1bml0IHZhbHVlcyBhbmQgc2V0IGNvbnRyb2xsZXIgc3RhdGUgdG8gc2VuZAorCSAq
IHZpZGVvLgorCSAqLworCWRwX2N0cmxfc2V0dXBfdHJfdW5pdChjdHJsKTsKKwlkcF9jYXRhbG9n
X2N0cmxfc3RhdGVfY3RybChjdHJsLT5jYXRhbG9nLCBEUF9TVEFURV9DVFJMX1NFTkRfVklERU8p
OworCisJcmV0ID0gZHBfY3RybF93YWl0NHZpZGVvX3JlYWR5KGN0cmwpOworCWlmIChyZXQpCisJ
CXJldHVybiByZXQ7CisKKwltYWlubGlua19yZWFkeSA9IGRwX2NhdGFsb2dfY3RybF9tYWlubGlu
a19yZWFkeShjdHJsLT5jYXRhbG9nKTsKKwlEUk1fREVCVUdfRFAoIm1haW5saW5rICVzXG4iLCBt
YWlubGlua19yZWFkeSA/ICJSRUFEWSIgOiAiTk9UIFJFQURZIik7CisJcmV0dXJuIHJldDsKK30K
Kworc3RhdGljIHZvaWQgZHBfY3RybF9zZXRfY2xvY2tfcmF0ZShzdHJ1Y3QgZHBfY3RybF9wcml2
YXRlICpjdHJsLAorCQkJCSAgIGNoYXIgKm5hbWUsIHUzMiByYXRlKQoreworCXUzMiBudW0gPSBj
dHJsLT5wYXJzZXItPm1wW0RQX0NUUkxfUE1dLm51bV9jbGs7CisJc3RydWN0IGRzc19jbGsgKmNm
ZyA9IGN0cmwtPnBhcnNlci0+bXBbRFBfQ1RSTF9QTV0uY2xrX2NvbmZpZzsKKworCXdoaWxlIChu
dW0gJiYgc3RyY21wKGNmZy0+Y2xrX25hbWUsIG5hbWUpKSB7CisJCW51bS0tOworCQljZmcrKzsK
Kwl9CisKKwlEUk1fREVCVUdfRFAoInNldHRpbmcgcmF0ZT0lZCBvbiBjbGs9JXNcbiIsIHJhdGUs
IG5hbWUpOworCisJaWYgKG51bSkKKwkJY2ZnLT5yYXRlID0gcmF0ZTsKKwllbHNlCisJCURSTV9F
UlJPUigiJXMgY2xvY2sgY291bGQgbm90IGJlIHNldCB3aXRoIHJhdGUgJWRcbiIsIG5hbWUsIHJh
dGUpOworfQorCitzdGF0aWMgaW50IGRwX2N0cmxfZW5hYmxlX21haW5saW5rX2Nsb2NrcyhzdHJ1
Y3QgZHBfY3RybF9wcml2YXRlICpjdHJsKQoreworCWludCByZXQgPSAwOworCisJZHBfcG93ZXJf
c2V0X2xpbmtfY2xrX3BhcmVudChjdHJsLT5wb3dlcik7CisJZHBfcG93ZXJfc2V0X3BpeGVsX2Ns
a19wYXJlbnQoY3RybC0+cG93ZXIpOworCisJZHBfY3RybF9zZXRfY2xvY2tfcmF0ZShjdHJsLCAi
Y3RybF9saW5rX2NsayIsIGN0cmwtPmxpbmstPmxpbmtfcGFyYW1zLnJhdGUpOworCisJZHBfY3Ry
bF9zZXRfY2xvY2tfcmF0ZShjdHJsLCAiY3RybF9waXhlbF9jbGsiLCBjdHJsLT5kcF9jdHJsLnBp
eGVsX3JhdGUpOworCisJcmV0ID0gZHBfcG93ZXJfY2xrX2VuYWJsZShjdHJsLT5wb3dlciwgRFBf
Q1RSTF9QTSwgdHJ1ZSk7CisJaWYgKHJldCkKKwkJRFJNX0VSUk9SKCJVbmFibGVkIHRvIHN0YXJ0
IGxpbmsgY2xvY2tzLiByZXQ9JWRcbiIsIHJldCk7CisKKwlyZXR1cm4gcmV0OworfQorCitpbnQg
ZHBfY3RybF9ob3N0X2luaXQoc3RydWN0IGRwX2N0cmwgKmRwX2N0cmwsIGJvb2wgZmxpcCkKK3sK
KwlzdHJ1Y3QgZHBfY3RybF9wcml2YXRlICpjdHJsOworCisJaWYgKCFkcF9jdHJsKSB7CisJCURS
TV9FUlJPUigiSW52YWxpZCBpbnB1dCBkYXRhXG4iKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQor
CisJY3RybCA9IGNvbnRhaW5lcl9vZihkcF9jdHJsLCBzdHJ1Y3QgZHBfY3RybF9wcml2YXRlLCBk
cF9jdHJsKTsKKworCWN0cmwtPmRwX2N0cmwub3JpZW50YXRpb24gPSBmbGlwOworCisJZHBfY2F0
YWxvZ19jdHJsX3VzYl9yZXNldChjdHJsLT5jYXRhbG9nLCBmbGlwKTsKKwlkcF9jYXRhbG9nX2N0
cmxfcGh5X3Jlc2V0KGN0cmwtPmNhdGFsb2cpOworCWRwX2NhdGFsb2dfY3RybF9lbmFibGVfaXJx
KGN0cmwtPmNhdGFsb2csIHRydWUpOworCisJcmV0dXJuIDA7Cit9CisKKy8qKgorICogZHBfY3Ry
bF9ob3N0X2RlaW5pdCgpIC0gVW5pbml0aWFsaXplIERQIGNvbnRyb2xsZXIKKyAqIEBjdHJsOiBE
aXNwbGF5IFBvcnQgRHJpdmVyIGRhdGEKKyAqCisgKiBQZXJmb3JtIHJlcXVpcmVkIHN0ZXBzIHRv
IHVuaW5pdGlhbGl6ZSBEUCBjb250cm9sbGVyCisgKiBhbmQgaXRzIHJlc291cmNlcy4KKyAqLwor
dm9pZCBkcF9jdHJsX2hvc3RfZGVpbml0KHN0cnVjdCBkcF9jdHJsICpkcF9jdHJsKQoreworCXN0
cnVjdCBkcF9jdHJsX3ByaXZhdGUgKmN0cmw7CisKKwlpZiAoIWRwX2N0cmwpIHsKKwkJRFJNX0VS
Uk9SKCJJbnZhbGlkIGlucHV0IGRhdGFcbiIpOworCQlyZXR1cm47CisJfQorCisJY3RybCA9IGNv
bnRhaW5lcl9vZihkcF9jdHJsLCBzdHJ1Y3QgZHBfY3RybF9wcml2YXRlLCBkcF9jdHJsKTsKKwor
CWRwX2NhdGFsb2dfY3RybF9lbmFibGVfaXJxKGN0cmwtPmNhdGFsb2csIGZhbHNlKTsKKworCURS
TV9ERUJVR19EUCgiSG9zdCBkZWluaXRpYWxpemVkIHN1Y2Nlc3NmdWxseVxuIik7Cit9CisKK3N0
YXRpYyBib29sIGRwX2N0cmxfdXNlX2ZpeGVkX252aWQoc3RydWN0IGRwX2N0cmxfcHJpdmF0ZSAq
Y3RybCkKK3sKKwl1OCAqZHBjZCA9IGN0cmwtPnBhbmVsLT5kcGNkOworCisJLyoKKwkgKiBGb3Ig
YmV0dGVyIGludGVyb3AgZXhwZXJpZW5jZSwgdXNlZCBhIGZpeGVkIE5WSUQ9MHg4MDAwCisJICog
d2hlbmV2ZXIgY29ubmVjdGVkIHRvIGEgVkdBIGRvbmdsZSBkb3duc3RyZWFtLgorCSAqLworCWlm
IChkcm1fZHBfaXNfYnJhbmNoKGRwY2QpKQorCQlyZXR1cm4gKGRybV9kcF9oYXNfcXVpcmsoJmN0
cmwtPnBhbmVsLT5kZXNjLAorCQkJCURQX0RQQ0RfUVVJUktfQ09OU1RBTlRfTikpOworCisJcmV0
dXJuIGZhbHNlOworfQorCitzdGF0aWMgaW50IGRwX2N0cmxfcmVpbml0aWFsaXplX21haW5saW5r
KHN0cnVjdCBkcF9jdHJsX3ByaXZhdGUgKmN0cmwpCit7CisJaW50IHJldCA9IDA7CisKKwlkcF9j
YXRhbG9nX2N0cmxfbWFpbmxpbmtfY3RybChjdHJsLT5jYXRhbG9nLCBmYWxzZSk7CisJZHBfY2F0
YWxvZ19jdHJsX3BoeV9sYW5lX2NmZyhjdHJsLT5jYXRhbG9nLAorCQljdHJsLT5kcF9jdHJsLm9y
aWVudGF0aW9uLCBjdHJsLT5saW5rLT5saW5rX3BhcmFtcy5udW1fbGFuZXMpOworCS8qCisJICog
RGlzYWJsZSBhbmQgcmUtZW5hYmxlIHRoZSBtYWlubGluayBjbG9jayBzaW5jZSB0aGUKKwkgKiBs
aW5rIGNsb2NrIG1pZ2h0IGhhdmUgYmVlbiBhZGp1c3RlZCBhcyBwYXJ0IG9mIHRoZQorCSAqIGxp
bmsgbWFpbnRlbmFuY2UuCisJICovCisJcmV0ID0gZHBfcG93ZXJfY2xrX2VuYWJsZShjdHJsLT5w
b3dlciwgRFBfQ1RSTF9QTSwgZmFsc2UpOworCWlmIChyZXQpIHsKKwkJRFJNX0VSUk9SKCJGYWls
ZWQgdG8gZGlzYWJsZSBjbG9ja3MuIHJldD0lZFxuIiwgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9
CisJLyogaHcgcmVjb21tZW5kZWQgZGVsYXkgYmVmb3JlIHJlLWVuYWJsaW5nIGNsb2NrcyAqLwor
CW1zbGVlcCgyMCk7CisKKwlyZXQgPSBkcF9jdHJsX2VuYWJsZV9tYWlubGlua19jbG9ja3MoY3Ry
bCk7CisJaWYgKHJldCkgeworCQlEUk1fRVJST1IoIkZhaWxlZCB0byBlbmFibGUgbWFpbmxpbmsg
Y2xrcy4gcmV0PSVkXG4iLCByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKworCWRwX2N0cmxfY29u
ZmlndXJlX3NvdXJjZV9wYXJhbXMoY3RybCk7CisJZHBfY2F0YWxvZ19jdHJsX2NvbmZpZ19tc2Eo
Y3RybC0+Y2F0YWxvZywKKwkJY3RybC0+bGluay0+bGlua19wYXJhbXMucmF0ZSwKKwkJY3RybC0+
ZHBfY3RybC5waXhlbF9yYXRlLCBkcF9jdHJsX3VzZV9maXhlZF9udmlkKGN0cmwpKTsKKwlyZWlu
aXRfY29tcGxldGlvbigmY3RybC0+aWRsZV9jb21wKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0
YXRpYyBpbnQgZHBfY3RybF9saW5rX21haW50ZW5hbmNlKHN0cnVjdCBkcF9jdHJsX3ByaXZhdGUg
KmN0cmwpCit7CisJaW50IHJldCA9IDA7CisJaW50IHRyaWVzLCBtYXhfdHJpZXMgPSAxMDsKKwor
CWRwX2N0cmxfcHVzaF9pZGxlKCZjdHJsLT5kcF9jdHJsKTsKKwlkcF9jYXRhbG9nX2N0cmxfcmVz
ZXQoY3RybC0+Y2F0YWxvZyk7CisKKwljdHJsLT5kcF9jdHJsLnBpeGVsX3JhdGUgPSBjdHJsLT5w
YW5lbC0+ZHBfbW9kZS5kcm1fbW9kZS5jbG9jazsKKworCWZvciAodHJpZXMgPSAwOyB0cmllcyA8
IG1heF90cmllczsgdHJpZXMrKykgeworCQlyZXQgPSBkcF9jdHJsX3JlaW5pdGlhbGl6ZV9tYWlu
bGluayhjdHJsKTsKKwkJaWYgKHJldCkgeworCQkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gcmVpbml0
aWFsaXplIG1haW5saW5rLiByZXQ9JWRcbiIsIHJldCk7CisJCQlicmVhazsKKwkJfQorCisJCXJl
dCA9IGRwX2N0cmxfc2V0dXBfbWFpbl9saW5rKGN0cmwsIHRydWUpOworCQlpZiAocmV0ID09IC1F
QUdBSU4pIC8qIHRyeSB3aXRoIGxvd2VyIGxpbmsgcmF0ZSAqLworCQkJZHBfY3RybF9saW5rX3Jh
dGVfZG93bl9zaGlmdChjdHJsKTsKKwl9CisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBk
cF9jdHJsX3Byb2Nlc3NfcGh5X3Rlc3RfcmVxdWVzdChzdHJ1Y3QgZHBfY3RybF9wcml2YXRlICpj
dHJsKQoreworCWludCByZXQgPSAwOworCisJaWYgKCFjdHJsLT5saW5rLT5waHlfcGFyYW1zLnBo
eV90ZXN0X3BhdHRlcm5fc2VsKSB7CisJCURSTV9ERUJVR19EUCgibm8gdGVzdCBwYXR0ZXJuIHNl
bGVjdGVkIGJ5IHNpbmtcbiIpOworCQlyZXR1cm4gcmV0OworCX0KKworCWRwX2N0cmxfcHVzaF9p
ZGxlKCZjdHJsLT5kcF9jdHJsKTsKKwkvKgorCSAqIFRoZSBnbG9iYWwgcmVzZXQgd2lsbCBuZWVk
IERQIGxpbmsgcmVsYXRlZCBjbG9ja3MgdG8gYmUKKwkgKiBydW5uaW5nLiBBZGQgdGhlIGdsb2Jh
bCByZXNldCBqdXN0IGJlZm9yZSBkaXNhYmxpbmcgdGhlCisJICogbGluayBjbG9ja3MgYW5kIGNv
cmUgY2xvY2tzLgorCSAqLworCWRwX2NhdGFsb2dfY3RybF9yZXNldChjdHJsLT5jYXRhbG9nKTsK
KwlyZXQgPSBkcF9jdHJsX29mZigmY3RybC0+ZHBfY3RybCk7CisJaWYgKHJldCkgeworCQlEUk1f
RVJST1IoImZhaWxlZCB0byBkaXNhYmxlIERQIGNvbnRyb2xsZXJcbiIpOworCQlyZXR1cm4gcmV0
OworCX0KKworCXJldCA9IGRwX2N0cmxfb24oJmN0cmwtPmRwX2N0cmwpOworCWlmIChyZXQpCisJ
CURSTV9FUlJPUigiZmFpbGVkIHRvIGVuYWJsZSBEUCBjb250cm9sbGVyXG4iKTsKKworCXJldHVy
biByZXQ7Cit9CisKK3N0YXRpYyBib29sIGRwX2N0cmxfc2VuZF9waHlfdGVzdF9wYXR0ZXJuKHN0
cnVjdCBkcF9jdHJsX3ByaXZhdGUgKmN0cmwpCit7CisJYm9vbCBzdWNjZXNzID0gZmFsc2U7CisJ
dTMyIHBhdHRlcm5fc2VudCA9IDB4MDsKKwl1MzIgcGF0dGVybl9yZXF1ZXN0ZWQgPSBjdHJsLT5s
aW5rLT5waHlfcGFyYW1zLnBoeV90ZXN0X3BhdHRlcm5fc2VsOworCisJRFJNX0RFQlVHX0RQKCJy
ZXF1ZXN0OiAweCV4XG4iLCBwYXR0ZXJuX3JlcXVlc3RlZCk7CisKKwlpZiAoZHBfY2F0YWxvZ19j
dHJsX3VwZGF0ZV92eF9weChjdHJsLT5jYXRhbG9nLAorCQkJY3RybC0+bGluay0+cGh5X3BhcmFt
cy52X2xldmVsLAorCQkJY3RybC0+bGluay0+cGh5X3BhcmFtcy5wX2xldmVsKSkgeworCQlEUk1f
RVJST1IoIkZhaWxlZCB0byBzZXQgdi9wIGxldmVsc1xuIik7CisJCXJldHVybiBmYWxzZTsKKwl9
CisJZHBfY2F0YWxvZ19jdHJsX3NlbmRfcGh5X3BhdHRlcm4oY3RybC0+Y2F0YWxvZywgcGF0dGVy
bl9yZXF1ZXN0ZWQpOworCWRwX2xpbmtfc2VuZF90ZXN0X3Jlc3BvbnNlKGN0cmwtPmxpbmspOwor
CisJcGF0dGVybl9zZW50ID0gZHBfY2F0YWxvZ19jdHJsX3JlYWRfcGh5X3BhdHRlcm4oY3RybC0+
Y2F0YWxvZyk7CisKKwlzd2l0Y2ggKHBhdHRlcm5fc2VudCkgeworCWNhc2UgTVJfTElOS19UUkFJ
TklORzE6CisJCXN1Y2Nlc3MgPSBwYXR0ZXJuX3JlcXVlc3RlZCA9PQorCQkJCURQX0xJTktfUVVB
TF9QQVRURVJOX0QxMF8yOworCQlicmVhazsKKwljYXNlIE1SX0xJTktfU1lNQk9MX0VSTToKKwkJ
c3VjY2VzcyA9IChwYXR0ZXJuX3JlcXVlc3RlZCA9PQorCQkJCURQX0xJTktfUVVBTF9QQVRURVJO
X0VSUk9SX1JBVEUpCisJCQl8fCAocGF0dGVybl9yZXF1ZXN0ZWQgPT0KKwkJCQlEUF9MSU5LX1FV
QUxfUEFUVEVSTl9IQlIyX0VZRSk7CisJCWJyZWFrOworCWNhc2UgTVJfTElOS19QUkJTNzoKKwkJ
c3VjY2VzcyA9IHBhdHRlcm5fcmVxdWVzdGVkID09IERQX0xJTktfUVVBTF9QQVRURVJOX1BSQlM3
OworCQlicmVhazsKKwljYXNlIE1SX0xJTktfQ1VTVE9NODA6CisJCXN1Y2Nlc3MgPSBwYXR0ZXJu
X3JlcXVlc3RlZCA9PQorCQkJCURQX0xJTktfUVVBTF9QQVRURVJOXzgwQklUX0NVU1RPTTsKKwkJ
YnJlYWs7CisJZGVmYXVsdDoKKwkJc3VjY2VzcyA9IGZhbHNlOworCX0KKworCURSTV9ERUJVR19E
UCgiJXM6IHRlc3QtPjB4JXhcbiIsIHN1Y2Nlc3MgPyAic3VjY2VzcyIgOiAiZmFpbGVkIiwKKwkJ
CQkJCXBhdHRlcm5fcmVxdWVzdGVkKTsKKwlyZXR1cm4gc3VjY2VzczsKK30KKwordm9pZCBkcF9j
dHJsX2hhbmRsZV9zaW5rX3JlcXVlc3Qoc3RydWN0IGRwX2N0cmwgKmRwX2N0cmwpCit7CisJc3Ry
dWN0IGRwX2N0cmxfcHJpdmF0ZSAqY3RybDsKKwl1MzIgc2lua19yZXF1ZXN0ID0gMHgwOworCisJ
aWYgKCFkcF9jdHJsKSB7CisJCURSTV9FUlJPUigiaW52YWxpZCBpbnB1dFxuIik7CisJCXJldHVy
bjsKKwl9CisKKwljdHJsID0gY29udGFpbmVyX29mKGRwX2N0cmwsIHN0cnVjdCBkcF9jdHJsX3By
aXZhdGUsIGRwX2N0cmwpOworCXNpbmtfcmVxdWVzdCA9IGN0cmwtPmxpbmstPnNpbmtfcmVxdWVz
dDsKKworCWlmIChzaW5rX3JlcXVlc3QgJiBEUF9URVNUX0xJTktfUEhZX1RFU1RfUEFUVEVSTikg
eworCQlEUk1fREVCVUdfRFAoIlBIWV9URVNUX1BBVFRFUk4gcmVxdWVzdFxuIik7CisJCWlmIChk
cF9jdHJsX3Byb2Nlc3NfcGh5X3Rlc3RfcmVxdWVzdChjdHJsKSkgeworCQkJRFJNX0VSUk9SKCJw
cm9jZXNzIHBoeV90ZXN0X3JlcSBmYWlsZWRcbiIpOworCQkJcmV0dXJuOworCQl9CisJfQorCisJ
aWYgKHNpbmtfcmVxdWVzdCAmIERQX0xJTktfU1RBVFVTX1VQREFURUQpCisJCWlmIChkcF9jdHJs
X2xpbmtfbWFpbnRlbmFuY2UoY3RybCkpIHsKKwkJCURSTV9FUlJPUigibGlua19tYWludGVuYW5j
ZSBmYWlsZWQ6IFNUQVRVU19VUERBVEVEXG4iKTsKKwkJCXJldHVybjsKKwkJfQorCisKKwlpZiAo
c2lua19yZXF1ZXN0ICYgRFBfVEVTVF9MSU5LX1RSQUlOSU5HKSB7CisJCWRwX2xpbmtfc2VuZF90
ZXN0X3Jlc3BvbnNlKGN0cmwtPmxpbmspOworCQlpZiAoZHBfY3RybF9saW5rX21haW50ZW5hbmNl
KGN0cmwpKSB7CisJCQlEUk1fRVJST1IoImxpbmtfbWFpbnRlbmFuY2UgZmFpbGVkOiBURVNUX0xJ
TktfVFJBSU5JTkdcbiIpOworCQkJcmV0dXJuOworCQl9CisJfQorfQorCitpbnQgZHBfY3RybF9v
bihzdHJ1Y3QgZHBfY3RybCAqZHBfY3RybCkKK3sKKwlpbnQgcmMgPSAwOworCXN0cnVjdCBkcF9j
dHJsX3ByaXZhdGUgKmN0cmw7CisJdTMyIHJhdGUgPSAwOworCXUzMiBsaW5rX3RyYWluX21heF9y
ZXRyaWVzID0gMTA7CisJdTMyIGNvbnN0IHBoeV9jdHNfcGl4ZWxfY2xrX2toeiA9IDE0ODUwMDsK
KworCWlmICghZHBfY3RybCkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwljdHJsID0gY29udGFpbmVy
X29mKGRwX2N0cmwsIHN0cnVjdCBkcF9jdHJsX3ByaXZhdGUsIGRwX2N0cmwpOworCisJcmF0ZSA9
IGN0cmwtPnBhbmVsLT5saW5rX2luZm8ucmF0ZTsKKworCWRwX3Bvd2VyX2Nsa19lbmFibGUoY3Ry
bC0+cG93ZXIsIERQX0NPUkVfUE0sIHRydWUpOworCWRwX2NhdGFsb2dfY3RybF9ocGRfY29uZmln
KGN0cmwtPmNhdGFsb2csIHRydWUpOworCisJaWYgKGN0cmwtPmxpbmstPnNpbmtfcmVxdWVzdCAm
IERQX1RFU1RfTElOS19QSFlfVEVTVF9QQVRURVJOKSB7CisJCURSTV9ERUJVR19EUCgidXNpbmcg
cGh5IHRlc3QgbGluayBwYXJhbWV0ZXJzXG4iKTsKKwkJaWYgKCFjdHJsLT5wYW5lbC0+ZHBfbW9k
ZS5kcm1fbW9kZS5jbG9jaykKKwkJCWN0cmwtPmRwX2N0cmwucGl4ZWxfcmF0ZSA9IHBoeV9jdHNf
cGl4ZWxfY2xrX2toejsKKwl9IGVsc2UgeworCQljdHJsLT5saW5rLT5saW5rX3BhcmFtcy5yYXRl
ID0gcmF0ZTsKKwkJY3RybC0+bGluay0+bGlua19wYXJhbXMubnVtX2xhbmVzID0KKwkJCWN0cmwt
PnBhbmVsLT5saW5rX2luZm8ubnVtX2xhbmVzOworCQljdHJsLT5kcF9jdHJsLnBpeGVsX3JhdGUg
PSBjdHJsLT5wYW5lbC0+ZHBfbW9kZS5kcm1fbW9kZS5jbG9jazsKKwl9CisKKwlEUk1fREVCVUdf
RFAoInJhdGU9JWQsIG51bV9sYW5lcz0lZCwgcGl4ZWxfcmF0ZT0lZFxuIiwKKwkJY3RybC0+bGlu
ay0+bGlua19wYXJhbXMucmF0ZSwKKwkJY3RybC0+bGluay0+bGlua19wYXJhbXMubnVtX2xhbmVz
LCBjdHJsLT5kcF9jdHJsLnBpeGVsX3JhdGUpOworCisJZHBfY2F0YWxvZ19jdHJsX3BoeV9sYW5l
X2NmZyhjdHJsLT5jYXRhbG9nLAorCQkJY3RybC0+ZHBfY3RybC5vcmllbnRhdGlvbiwgY3RybC0+
bGluay0+bGlua19wYXJhbXMubnVtX2xhbmVzKTsKKworCXJjID0gZHBfY3RybF9lbmFibGVfbWFp
bmxpbmtfY2xvY2tzKGN0cmwpOworCWlmIChyYykKKwkJcmV0dXJuIHJjOworCisJd2hpbGUgKC0t
bGlua190cmFpbl9tYXhfcmV0cmllcyAmJiAhYXRvbWljX3JlYWQoJmN0cmwtPmRwX2N0cmwuYWJv
cnRlZCkpIHsKKwkJcmMgPSBkcF9jdHJsX3JlaW5pdGlhbGl6ZV9tYWlubGluayhjdHJsKTsKKwkJ
aWYgKHJjKSB7CisJCQlEUk1fRVJST1IoIkZhaWxlZCB0byByZWluaXRpYWxpemUgbWFpbmxpbmsu
IHJjPSVkXG4iLCByYyk7CisJCQlicmVhazsKKwkJfQorCQlyYyA9IGRwX2N0cmxfc2V0dXBfbWFp
bl9saW5rKGN0cmwsIHRydWUpOworCQlpZiAoIXJjKQorCQkJYnJlYWs7CisJCS8qIHRyeSB3aXRo
IGxvd2VyIGxpbmsgcmF0ZSAqLworCQlkcF9jdHJsX2xpbmtfcmF0ZV9kb3duX3NoaWZ0KGN0cmwp
OworCX0KKworCWlmIChjdHJsLT5saW5rLT5zaW5rX3JlcXVlc3QgJiBEUF9URVNUX0xJTktfUEhZ
X1RFU1RfUEFUVEVSTikKKwkJZHBfY3RybF9zZW5kX3BoeV90ZXN0X3BhdHRlcm4oY3RybCk7CisK
KwlyZXR1cm4gcmM7Cit9CisKK2ludCBkcF9jdHJsX29mZihzdHJ1Y3QgZHBfY3RybCAqZHBfY3Ry
bCkKK3sKKwlzdHJ1Y3QgZHBfY3RybF9wcml2YXRlICpjdHJsOworCWludCByZXQgPSAwOworCisJ
aWYgKCFkcF9jdHJsKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCWN0cmwgPSBjb250YWluZXJfb2Yo
ZHBfY3RybCwgc3RydWN0IGRwX2N0cmxfcHJpdmF0ZSwgZHBfY3RybCk7CisKKwlkcF9jYXRhbG9n
X2N0cmxfbWFpbmxpbmtfY3RybChjdHJsLT5jYXRhbG9nLCBmYWxzZSk7CisJZHBfY2F0YWxvZ19j
dHJsX3Jlc2V0KGN0cmwtPmNhdGFsb2cpOworCXJldCA9IGRwX3Bvd2VyX2Nsa19lbmFibGUoY3Ry
bC0+cG93ZXIsIERQX0NUUkxfUE0sIGZhbHNlKTsKKwlpZiAocmV0KSB7CisJCURSTV9FUlJPUigi
RmFpbGVkIHRvIGRpc2FibGUgY2xvY2tzLiByZXQ9JWRcbiIsIHJldCk7CisJCXJldHVybiByZXQ7
CisJfQorCisJRFJNX0RFQlVHX0RQKCJEUCBvZmYgZG9uZVxuIik7CisJcmV0dXJuIHJldDsKK30K
Kwordm9pZCBkcF9jdHJsX2lzcihzdHJ1Y3QgZHBfY3RybCAqZHBfY3RybCkKK3sKKwlzdHJ1Y3Qg
ZHBfY3RybF9wcml2YXRlICpjdHJsOworCXUzMiBpc3I7CisKKwlpZiAoIWRwX2N0cmwpCisJCXJl
dHVybjsKKworCWN0cmwgPSBjb250YWluZXJfb2YoZHBfY3RybCwgc3RydWN0IGRwX2N0cmxfcHJp
dmF0ZSwgZHBfY3RybCk7CisKKwlpc3IgPSBkcF9jYXRhbG9nX2N0cmxfZ2V0X2ludGVycnVwdChj
dHJsLT5jYXRhbG9nKTsKKworCWlmIChpc3IgJiBEUF9DVFJMX0lOVFJfUkVBRFlfRk9SX1ZJREVP
KSB7CisJCURSTV9ERUJVR19EUCgiZHBfdmlkZW9fcmVhZHlcbiIpOworCQljb21wbGV0ZSgmY3Ry
bC0+dmlkZW9fY29tcCk7CisJfQorCisJaWYgKGlzciAmIERQX0NUUkxfSU5UUl9JRExFX1BBVFRF
Uk5fU0VOVCkgeworCQlEUk1fREVCVUdfRFAoImlkbGVfcGF0dGVybnNfc2VudFxuIik7CisJCWNv
bXBsZXRlKCZjdHJsLT5pZGxlX2NvbXApOworCX0KK30KKworc3RydWN0IGRwX2N0cmwgKmRwX2N0
cmxfZ2V0KHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRwX2xpbmsgKmxpbmssIHN0cnVjdCBk
cF9wYW5lbCAqcGFuZWwsCisJCQlzdHJ1Y3QgZHBfYXV4ICphdXgsIHN0cnVjdCBkcF9wb3dlciAq
cG93ZXIsIHN0cnVjdCBkcF9jYXRhbG9nICpjYXRhbG9nLAorCQkJc3RydWN0IGRwX3BhcnNlciAq
cGFyc2VyKQoreworCWludCByYyA9IDA7CisJc3RydWN0IGRwX2N0cmxfcHJpdmF0ZSAqY3RybDsK
KwlzdHJ1Y3QgZHBfY3RybCAqZHBfY3RybDsKKworCWlmICghZGV2IHx8ICFwYW5lbCB8fCAhYXV4
IHx8CisJICAgICFsaW5rIHx8ICFjYXRhbG9nKSB7CisJCURSTV9FUlJPUigiaW52YWxpZCBpbnB1
dFxuIik7CisJCXJjID0gLUVJTlZBTDsKKwkJZ290byBlcnJvcjsKKwl9CisKKwljdHJsID0gZGV2
bV9remFsbG9jKGRldiwgc2l6ZW9mKCpjdHJsKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFjdHJsKSB7
CisJCXJjID0gLUVOT01FTTsKKwkJZ290byBlcnJvcjsKKwl9CisKKwlpbml0X2NvbXBsZXRpb24o
JmN0cmwtPmlkbGVfY29tcCk7CisJaW5pdF9jb21wbGV0aW9uKCZjdHJsLT52aWRlb19jb21wKTsK
KwltdXRleF9pbml0KCZjdHJsLT5wdXNoX2lkbGVfbXV0ZXgpOworCisJLyogaW4gcGFyYW1ldGVy
cyAqLworCWN0cmwtPnBhcnNlciAgID0gcGFyc2VyOworCWN0cmwtPnBhbmVsICAgID0gcGFuZWw7
CisJY3RybC0+cG93ZXIgICAgPSBwb3dlcjsKKwljdHJsLT5hdXggICAgICA9IGF1eDsKKwljdHJs
LT5saW5rICAgICA9IGxpbms7CisJY3RybC0+Y2F0YWxvZyAgPSBjYXRhbG9nOworCWN0cmwtPmRl
diAgICAgID0gZGV2OworCisJZHBfY3RybCA9ICZjdHJsLT5kcF9jdHJsOworCisJcmV0dXJuIGRw
X2N0cmw7CitlcnJvcjoKKwlyZXR1cm4gRVJSX1BUUihyYyk7Cit9CisKK3ZvaWQgZHBfY3RybF9w
dXQoc3RydWN0IGRwX2N0cmwgKmRwX2N0cmwpCit7CisJc3RydWN0IGRwX2N0cmxfcHJpdmF0ZSAq
Y3RybDsKKworCWlmICghZHBfY3RybCkKKwkJcmV0dXJuOworCisJY3RybCA9IGNvbnRhaW5lcl9v
ZihkcF9jdHJsLCBzdHJ1Y3QgZHBfY3RybF9wcml2YXRlLCBkcF9jdHJsKTsKKworCW11dGV4X2Rl
c3Ryb3koJmN0cmwtPnB1c2hfaWRsZV9tdXRleCk7CisKKwlkZXZtX2tmcmVlKGN0cmwtPmRldiwg
Y3RybCk7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX2N0cmwuaCBi
L2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfY3RybC5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0Cmlu
ZGV4IDAwMDAwMDAuLjk5YWI0YjIKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
bXNtL2RwL2RwX2N0cmwuaApAQCAtMCwwICsxLDM0IEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRp
ZmllcjogR1BMLTIuMC1vbmx5ICovCisvKgorICogQ29weXJpZ2h0IChjKSAyMDEyLTIwMTksIFRo
ZSBMaW51eCBGb3VuZGF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLgorICovCisKKyNpZm5kZWYg
X0RQX0NUUkxfSF8KKyNkZWZpbmUgX0RQX0NUUkxfSF8KKworI2luY2x1ZGUgImRwX2F1eC5oIgor
I2luY2x1ZGUgImRwX3BhbmVsLmgiCisjaW5jbHVkZSAiZHBfbGluay5oIgorI2luY2x1ZGUgImRw
X3BhcnNlci5oIgorI2luY2x1ZGUgImRwX3Bvd2VyLmgiCisjaW5jbHVkZSAiZHBfY2F0YWxvZy5o
IgorCitzdHJ1Y3QgZHBfY3RybCB7CisJYm9vbCBvcmllbnRhdGlvbjsKKwlhdG9taWNfdCBhYm9y
dGVkOworCXUzMiBwaXhlbF9yYXRlOworfTsKKworaW50IGRwX2N0cmxfaG9zdF9pbml0KHN0cnVj
dCBkcF9jdHJsICpkcF9jdHJsLCBib29sIGZsaXApOwordm9pZCBkcF9jdHJsX2hvc3RfZGVpbml0
KHN0cnVjdCBkcF9jdHJsICpkcF9jdHJsKTsKK2ludCBkcF9jdHJsX29uKHN0cnVjdCBkcF9jdHJs
ICpkcF9jdHJsKTsKK2ludCBkcF9jdHJsX29mZihzdHJ1Y3QgZHBfY3RybCAqZHBfY3RybCk7Cit2
b2lkIGRwX2N0cmxfcHVzaF9pZGxlKHN0cnVjdCBkcF9jdHJsICpkcF9jdHJsKTsKK3ZvaWQgZHBf
Y3RybF9pc3Ioc3RydWN0IGRwX2N0cmwgKmRwX2N0cmwpOwordm9pZCBkcF9jdHJsX2hhbmRsZV9z
aW5rX3JlcXVlc3Qoc3RydWN0IGRwX2N0cmwgKmRwX2N0cmwpOworc3RydWN0IGRwX2N0cmwgKmRw
X2N0cmxfZ2V0KHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRwX2xpbmsgKmxpbmssIHN0cnVj
dCBkcF9wYW5lbCAqcGFuZWwsCisJCQlzdHJ1Y3QgZHBfYXV4ICphdXgsIHN0cnVjdCBkcF9wb3dl
ciAqcG93ZXIsIHN0cnVjdCBkcF9jYXRhbG9nICpjYXRhbG9nLAorCQkJc3RydWN0IGRwX3BhcnNl
ciAqcGFyc2VyKTsKK3ZvaWQgZHBfY3RybF9wdXQoc3RydWN0IGRwX2N0cmwgKmRwX2N0cmwpOwor
CisjZW5kaWYgLyogX0RQX0NUUkxfSF8gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9t
c20vZHAvZHBfZGlzcGxheS5jIGIvZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9kaXNwbGF5LmMK
bmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uYTg5MzU0MgotLS0gL2Rldi9udWxs
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfZGlzcGxheS5jCkBAIC0wLDAgKzEsOTQ5
IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5CisvKgorICogQ29w
eXJpZ2h0IChjKSAyMDE3LTIwMTksIFRoZSBMaW51eCBGb3VuZGF0aW9uLiBBbGwgcmlnaHRzIHJl
c2VydmVkLgorICovCisKKyNkZWZpbmUgcHJfZm10KGZtdCkJIltkcm0tZHBdICVzOiAiIGZtdCwg
X19mdW5jX18KKworI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgorI2luY2x1ZGUgPGxpbnV4L3Ns
YWIuaD4KKyNpbmNsdWRlIDxsaW51eC91YWNjZXNzLmg+CisjaW5jbHVkZSA8bGludXgvZGVidWdm
cy5oPgorI2luY2x1ZGUgPGxpbnV4L2NvbXBvbmVudC5oPgorI2luY2x1ZGUgPGxpbnV4L29mX2ly
cS5oPgorCisjaW5jbHVkZSAibXNtX2Rydi5oIgorI2luY2x1ZGUgIm1zbV9rbXMuaCIKKyNpbmNs
dWRlICJkcF9leHRjb24uaCIKKyNpbmNsdWRlICJkcF9wYXJzZXIuaCIKKyNpbmNsdWRlICJkcF9w
b3dlci5oIgorI2luY2x1ZGUgImRwX2NhdGFsb2cuaCIKKyNpbmNsdWRlICJkcF9hdXguaCIKKyNp
bmNsdWRlICJkcF9saW5rLmgiCisjaW5jbHVkZSAiZHBfcGFuZWwuaCIKKyNpbmNsdWRlICJkcF9j
dHJsLmgiCisjaW5jbHVkZSAiZHBfZGlzcGxheS5oIgorI2luY2x1ZGUgImRwX2RybS5oIgorCitz
dGF0aWMgc3RydWN0IG1zbV9kcCAqZ19kcF9kaXNwbGF5OworI2RlZmluZSBIUERfU1RSSU5HX1NJ
WkUgMzAKKworc3RydWN0IGRwX2Rpc3BsYXlfcHJpdmF0ZSB7CisJY2hhciAqbmFtZTsKKwlpbnQg
aXJxOworCisJLyogc3RhdGUgdmFyaWFibGVzICovCisJYm9vbCBjb3JlX2luaXRpYWxpemVkOwor
CWJvb2wgcG93ZXJfb247CisJYm9vbCBocGRfaXJxX29uOworCWJvb2wgYXVkaW9fc3VwcG9ydGVk
OworCisJc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldjsKKwlzdHJ1Y3QgZGVudHJ5ICpyb290
OworCXN0cnVjdCBjb21wbGV0aW9uIG5vdGlmaWNhdGlvbl9jb21wOworCisJc3RydWN0IGRwX3Vz
YnBkICAgKnVzYnBkOworCXN0cnVjdCBkcF9wYXJzZXIgICpwYXJzZXI7CisJc3RydWN0IGRwX3Bv
d2VyICAgKnBvd2VyOworCXN0cnVjdCBkcF9jYXRhbG9nICpjYXRhbG9nOworCXN0cnVjdCBkcF9h
dXggICAgICphdXg7CisJc3RydWN0IGRwX2xpbmsgICAgKmxpbms7CisJc3RydWN0IGRwX3BhbmVs
ICAgKnBhbmVsOworCXN0cnVjdCBkcF9jdHJsICAgICpjdHJsOworCisJc3RydWN0IGRwX3VzYnBk
X2NiIHVzYnBkX2NiOworCXN0cnVjdCBkcF9kaXNwbGF5X21vZGUgZHBfbW9kZTsKKwlzdHJ1Y3Qg
bXNtX2RwIGRwX2Rpc3BsYXk7Cit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IG9mX2RldmljZV9p
ZCBkcF9kdF9tYXRjaFtdID0geworCXsuY29tcGF0aWJsZSA9ICJxY29tLGRwLWRpc3BsYXkifSwK
Kwl7fQorfTsKKworc3RhdGljIGlycXJldHVybl90IGRwX2Rpc3BsYXlfaXJxKGludCBpcnEsIHZv
aWQgKmRldl9pZCkKK3sKKwlzdHJ1Y3QgZHBfZGlzcGxheV9wcml2YXRlICpkcCA9IGRldl9pZDsK
KworCWlmICghZHApIHsKKwkJRFJNX0VSUk9SKCJpbnZhbGlkIGRhdGFcbiIpOworCQlyZXR1cm4g
SVJRX05PTkU7CisJfQorCisJLyogRFAgY29udHJvbGxlciBpc3IgKi8KKwlkcF9jdHJsX2lzcihk
cC0+Y3RybCk7CisKKwkvKiBEUCBhdXggaXNyICovCisJZHBfYXV4X2lzcihkcC0+YXV4KTsKKwor
CXJldHVybiBJUlFfSEFORExFRDsKK30KKworc3RhdGljIGludCBkcF9kaXNwbGF5X2JpbmQoc3Ry
dWN0IGRldmljZSAqZGV2LCBzdHJ1Y3QgZGV2aWNlICptYXN0ZXIsCisJCQkgICB2b2lkICpkYXRh
KQoreworCWludCByYyA9IDA7CisJc3RydWN0IGRwX2Rpc3BsYXlfcHJpdmF0ZSAqZHA7CisJc3Ry
dWN0IGRybV9kZXZpY2UgKmRybTsKKwlzdHJ1Y3QgbXNtX2RybV9wcml2YXRlICpwcml2OworCXN0
cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYgPSB0b19wbGF0Zm9ybV9kZXZpY2UoZGV2KTsKKwor
CWlmICghZGV2IHx8ICFwZGV2IHx8ICFtYXN0ZXIpIHsKKwkJRFJNX0VSUk9SKCJpbnZhbGlkIHBh
cmFtKHMpLCBkZXYgJXBLLCBwZGV2ICVwSywgbWFzdGVyICVwS1xuIiwKKwkJCQlkZXYsIHBkZXYs
IG1hc3Rlcik7CisJCXJjID0gLUVJTlZBTDsKKwkJZ290byBlbmQ7CisJfQorCisJZHJtID0gZGV2
X2dldF9kcnZkYXRhKG1hc3Rlcik7CisJZHAgPSBwbGF0Zm9ybV9nZXRfZHJ2ZGF0YShwZGV2KTsK
KwlpZiAoIWRybSB8fCAhZHApIHsKKwkJRFJNX0VSUk9SKCJpbnZhbGlkIHBhcmFtKHMpLCBkcm0g
JXBLLCBkcCAlcEtcbiIsCisJCQkJZHJtLCBkcCk7CisJCXJjID0gLUVJTlZBTDsKKwkJZ290byBl
bmQ7CisJfQorCisJZHAtPmRwX2Rpc3BsYXkuZHJtX2RldiA9IGRybTsKKwlwcml2ID0gZHJtLT5k
ZXZfcHJpdmF0ZTsKKwlwcml2LT5kcCA9ICYoZHAtPmRwX2Rpc3BsYXkpOworCisJcmMgPSBkcC0+
cGFyc2VyLT5wYXJzZShkcC0+cGFyc2VyKTsKKwlpZiAocmMpIHsKKwkJRFJNX0VSUk9SKCJkZXZp
Y2UgdHJlZSBwYXJzaW5nIGZhaWxlZFxuIik7CisJCWdvdG8gZW5kOworCX0KKworCXJjID0gZHBf
YXV4X3JlZ2lzdGVyKGRwLT5hdXgpOworCWlmIChyYykgeworCQlEUk1fRVJST1IoIkRSTSBEUCBB
VVggcmVnaXN0ZXIgZmFpbGVkXG4iKTsKKwkJZ290byBlbmQ7CisJfQorCisJcmMgPSBkcF9wb3dl
cl9jbGllbnRfaW5pdChkcC0+cG93ZXIpOworCWlmIChyYykgeworCQlEUk1fRVJST1IoIlBvd2Vy
IGNsaWVudCBjcmVhdGUgZmFpbGVkXG4iKTsKKwkJZ290byBlbmQ7CisJfQorCitlbmQ6CisJcmV0
dXJuIHJjOworfQorCitzdGF0aWMgdm9pZCBkcF9kaXNwbGF5X3VuYmluZChzdHJ1Y3QgZGV2aWNl
ICpkZXYsIHN0cnVjdCBkZXZpY2UgKm1hc3RlciwKKwkJCSAgICAgIHZvaWQgKmRhdGEpCit7CisJ
c3RydWN0IGRwX2Rpc3BsYXlfcHJpdmF0ZSAqZHA7CisJc3RydWN0IHBsYXRmb3JtX2RldmljZSAq
cGRldiA9IHRvX3BsYXRmb3JtX2RldmljZShkZXYpOworCXN0cnVjdCBkcm1fZGV2aWNlICpkcm0g
PSBkZXZfZ2V0X2RydmRhdGEobWFzdGVyKTsKKwlzdHJ1Y3QgbXNtX2RybV9wcml2YXRlICpwcml2
ID0gZHJtLT5kZXZfcHJpdmF0ZTsKKworCWlmICghZGV2IHx8ICFwZGV2KSB7CisJCURSTV9FUlJP
UigiaW52YWxpZCBwYXJhbShzKVxuIik7CisJCXJldHVybjsKKwl9CisKKwlkcCA9IHBsYXRmb3Jt
X2dldF9kcnZkYXRhKHBkZXYpOworCWlmICghZHApIHsKKwkJRFJNX0VSUk9SKCJJbnZhbGlkIHBh
cmFtc1xuIik7CisJCXJldHVybjsKKwl9CisKKwkodm9pZClkcF9wb3dlcl9jbGllbnRfZGVpbml0
KGRwLT5wb3dlcik7CisJKHZvaWQpZHBfYXV4X3VucmVnaXN0ZXIoZHAtPmF1eCk7CisJcHJpdi0+
ZHAgPSBOVUxMOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGNvbXBvbmVudF9vcHMgZHBfZGlz
cGxheV9jb21wX29wcyA9IHsKKwkuYmluZCA9IGRwX2Rpc3BsYXlfYmluZCwKKwkudW5iaW5kID0g
ZHBfZGlzcGxheV91bmJpbmQsCit9OworCitzdGF0aWMgYm9vbCBkcF9kaXNwbGF5X2lzX2RzX2Jy
aWRnZShzdHJ1Y3QgZHBfcGFuZWwgKnBhbmVsKQoreworCXJldHVybiAocGFuZWwtPmRwY2RbRFBf
RE9XTlNUUkVBTVBPUlRfUFJFU0VOVF0gJgorCQlEUF9EV05fU1RSTV9QT1JUX1BSRVNFTlQpOwor
fQorCitzdGF0aWMgYm9vbCBkcF9kaXNwbGF5X2lzX3NpbmtfY291bnRfemVybyhzdHJ1Y3QgZHBf
ZGlzcGxheV9wcml2YXRlICpkcCkKK3sKKwlyZXR1cm4gZHBfZGlzcGxheV9pc19kc19icmlkZ2Uo
ZHAtPnBhbmVsKSAmJgorCQkoZHAtPmxpbmstPnNpbmtfY291bnQgPT0gMCk7Cit9CisKK3N0YXRp
YyB2b2lkIGRwX2Rpc3BsYXlfc2VuZF9ocGRfZXZlbnQoc3RydWN0IG1zbV9kcCAqZHBfZGlzcGxh
eSkKK3sKKwlzdHJ1Y3QgZHBfZGlzcGxheV9wcml2YXRlICpkcDsKKwlzdHJ1Y3QgZHJtX2Nvbm5l
Y3RvciAqY29ubmVjdG9yOworCisJZHAgPSBjb250YWluZXJfb2YoZHBfZGlzcGxheSwgc3RydWN0
IGRwX2Rpc3BsYXlfcHJpdmF0ZSwgZHBfZGlzcGxheSk7CisKKwljb25uZWN0b3IgPSBkcC0+ZHBf
ZGlzcGxheS5jb25uZWN0b3I7CisJZHJtX2hlbHBlcl9ocGRfaXJxX2V2ZW50KGNvbm5lY3Rvci0+
ZGV2KTsKK30KKworc3RhdGljIGludCBkcF9kaXNwbGF5X3NlbmRfaHBkX25vdGlmaWNhdGlvbihz
dHJ1Y3QgZHBfZGlzcGxheV9wcml2YXRlICpkcCwKKwkJCQkJICAgIGJvb2wgaHBkKQoreworCXN0
YXRpYyBib29sIGVuY29kZXJfbW9kZV9zZXQgPSBmYWxzZTsKKwlzdHJ1Y3QgbXNtX2RybV9wcml2
YXRlICpwcml2ID0gZHAtPmRwX2Rpc3BsYXkuZHJtX2Rldi0+ZGV2X3ByaXZhdGU7CisJc3RydWN0
IG1zbV9rbXMgKmttcyA9IHByaXYtPmttczsKKworCW11dGV4X2xvY2soJmRwLT5kcF9kaXNwbGF5
LmNvbm5lY3RfbXV0ZXgpOworCWlmICgoaHBkICYmIGRwLT5kcF9kaXNwbGF5LmlzX2Nvbm5lY3Rl
ZCkgfHwKKwkJCSghaHBkICYmICFkcC0+ZHBfZGlzcGxheS5pc19jb25uZWN0ZWQpKSB7CisJCURS
TV9ERUJVR19EUCgiSFBEIGFscmVhZHkgJXNcbiIsIChocGQgPyAib24iIDogIm9mZiIpKTsKKwkJ
bXV0ZXhfdW5sb2NrKCZkcC0+ZHBfZGlzcGxheS5jb25uZWN0X211dGV4KTsKKwkJcmV0dXJuIDA7
CisJfQorCisJLyogcmVzZXQgdmlkZW8gcGF0dGVybiBmbGFnIG9uIGRpc2Nvbm5lY3QgKi8KKwlp
ZiAoIWhwZCkKKwkJZHAtPnBhbmVsLT52aWRlb190ZXN0ID0gZmFsc2U7CisKKwlkcC0+ZHBfZGlz
cGxheS5pc19jb25uZWN0ZWQgPSBocGQ7CisJcmVpbml0X2NvbXBsZXRpb24oJmRwLT5ub3RpZmlj
YXRpb25fY29tcCk7CisKKwlpZiAoZHAtPmRwX2Rpc3BsYXkuaXNfY29ubmVjdGVkICYmIGRwLT5k
cF9kaXNwbGF5LmVuY29kZXIKKwkJCQkmJiAhZW5jb2Rlcl9tb2RlX3NldAorCQkJCSYmIGttcy0+
ZnVuY3MtPnNldF9lbmNvZGVyX21vZGUpIHsKKwkJa21zLT5mdW5jcy0+c2V0X2VuY29kZXJfbW9k
ZShrbXMsCisJCQkJZHAtPmRwX2Rpc3BsYXkuZW5jb2RlciwgZmFsc2UpOworCQlEUk1fREVCVUdf
RFAoInNldF9lbmNvZGVyX21vZGUoKSBDb21wbGV0ZWRcbiIpOworCQllbmNvZGVyX21vZGVfc2V0
ID0gdHJ1ZTsKKwl9CisKKwlkcF9kaXNwbGF5X3NlbmRfaHBkX2V2ZW50KCZkcC0+ZHBfZGlzcGxh
eSk7CisKKwlpZiAoIXdhaXRfZm9yX2NvbXBsZXRpb25fdGltZW91dCgmZHAtPm5vdGlmaWNhdGlv
bl9jb21wLCBIWiAqIDIpKSB7CisJCXByX3dhcm4oIiVzIHRpbWVvdXRcbiIsIGhwZCA/ICJjb25u
ZWN0IiA6ICJkaXNjb25uZWN0Iik7CisJCW11dGV4X3VubG9jaygmZHAtPmRwX2Rpc3BsYXkuY29u
bmVjdF9tdXRleCk7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCW11dGV4X3VubG9jaygmZHAt
PmRwX2Rpc3BsYXkuY29ubmVjdF9tdXRleCk7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQg
ZHBfZGlzcGxheV9wcm9jZXNzX2hwZF9oaWdoKHN0cnVjdCBkcF9kaXNwbGF5X3ByaXZhdGUgKmRw
KQoreworCWludCByYyA9IDA7CisJc3RydWN0IGVkaWQgKmVkaWQ7CisKKwlkcF9hdXhfaW5pdChk
cC0+YXV4LCBkcC0+cGFyc2VyLT5hdXhfY2ZnKTsKKworCWlmIChkcC0+bGluay0+cHNtX2VuYWJs
ZWQpCisJCWdvdG8gbm90aWZ5OworCisJcmMgPSBkcF9wYW5lbF9yZWFkX3NpbmtfY2FwcyhkcC0+
cGFuZWwsIGRwLT5kcF9kaXNwbGF5LmNvbm5lY3Rvcik7CisJaWYgKHJjKQorCQlnb3RvIG5vdGlm
eTsKKworCWRwX2xpbmtfcHJvY2Vzc19yZXF1ZXN0KGRwLT5saW5rKTsKKworCWlmIChkcF9kaXNw
bGF5X2lzX3NpbmtfY291bnRfemVybyhkcCkpIHsKKwkJRFJNX0RFQlVHX0RQKCJubyBkb3duc3Ry
ZWFtIGRldmljZXMgY29ubmVjdGVkXG4iKTsKKwkJcmMgPSAtRUlOVkFMOworCQlnb3RvIGVuZDsK
Kwl9CisKKwllZGlkID0gZHAtPnBhbmVsLT5lZGlkOworCisJZHAtPmF1ZGlvX3N1cHBvcnRlZCA9
IGRybV9kZXRlY3RfbW9uaXRvcl9hdWRpbyhlZGlkKTsKKworCWRwX3BhbmVsX2hhbmRsZV9zaW5r
X3JlcXVlc3QoZHAtPnBhbmVsKTsKKworCWRwLT5kcF9kaXNwbGF5Lm1heF9wY2xrX2toeiA9IGRw
LT5wYXJzZXItPm1heF9wY2xrX2toejsKK25vdGlmeToKKwlkcF9kaXNwbGF5X3NlbmRfaHBkX25v
dGlmaWNhdGlvbihkcCwgdHJ1ZSk7CisKK2VuZDoKKwlyZXR1cm4gcmM7Cit9CisKK3N0YXRpYyB2
b2lkIGRwX2Rpc3BsYXlfaG9zdF9pbml0KHN0cnVjdCBkcF9kaXNwbGF5X3ByaXZhdGUgKmRwKQor
eworCWJvb2wgZmxpcCA9IGZhbHNlOworCisJaWYgKGRwLT5jb3JlX2luaXRpYWxpemVkKSB7CisJ
CURSTV9ERUJVR19EUCgiRFAgY29yZSBhbHJlYWR5IGluaXRpYWxpemVkXG4iKTsKKwkJcmV0dXJu
OworCX0KKworCWlmIChkcC0+dXNicGQtPm9yaWVudGF0aW9uID09IE9SSUVOVEFUSU9OX0NDMikK
KwkJZmxpcCA9IHRydWU7CisKKwlkcF9wb3dlcl9pbml0KGRwLT5wb3dlciwgZmxpcCk7CisJZHBf
Y3RybF9ob3N0X2luaXQoZHAtPmN0cmwsIGZsaXApOworCWVuYWJsZV9pcnEoZHAtPmlycSk7CisJ
ZHAtPmNvcmVfaW5pdGlhbGl6ZWQgPSB0cnVlOworfQorCitzdGF0aWMgdm9pZCBkcF9kaXNwbGF5
X2hvc3RfZGVpbml0KHN0cnVjdCBkcF9kaXNwbGF5X3ByaXZhdGUgKmRwKQoreworCWlmICghZHAt
PmNvcmVfaW5pdGlhbGl6ZWQpIHsKKwkJRFJNX0RFQlVHX0RQKCJEUCBjb3JlIGFscmVhZHkgb2Zm
XG4iKTsKKwkJcmV0dXJuOworCX0KKworCWRwX2N0cmxfaG9zdF9kZWluaXQoZHAtPmN0cmwpOwor
CWRwX2F1eF9kZWluaXQoZHAtPmF1eCk7CisJZHBfcG93ZXJfZGVpbml0KGRwLT5wb3dlcik7CisJ
ZGlzYWJsZV9pcnEoZHAtPmlycSk7CisJZHAtPmNvcmVfaW5pdGlhbGl6ZWQgPSBmYWxzZTsKK30K
Kworc3RhdGljIHZvaWQgZHBfZGlzcGxheV9wcm9jZXNzX2hwZF9sb3coc3RydWN0IGRwX2Rpc3Bs
YXlfcHJpdmF0ZSAqZHApCit7CisJZHBfZGlzcGxheV9zZW5kX2hwZF9ub3RpZmljYXRpb24oZHAs
IGZhbHNlKTsKKworCWRwX2F1eF9kZWluaXQoZHAtPmF1eCk7Cit9CisKK3N0YXRpYyBpbnQgZHBf
ZGlzcGxheV91c2JwZF9jb25maWd1cmVfY2Ioc3RydWN0IGRldmljZSAqZGV2KQoreworCWludCBy
YyA9IDA7CisJc3RydWN0IGRwX2Rpc3BsYXlfcHJpdmF0ZSAqZHA7CisKKwlpZiAoIWRldikgewor
CQlEUk1fRVJST1IoImludmFsaWQgZGV2XG4iKTsKKwkJcmMgPSAtRUlOVkFMOworCQlnb3RvIGVu
ZDsKKwl9CisKKwlkcCA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOworCWlmICghZHApIHsKKwkJRFJN
X0VSUk9SKCJubyBkcml2ZXIgZGF0YSBmb3VuZFxuIik7CisJCXJjID0gLUVOT0RFVjsKKwkJZ290
byBlbmQ7CisJfQorCisJZHBfZGlzcGxheV9ob3N0X2luaXQoZHApOworCisJaWYgKGRwLT51c2Jw
ZC0+aHBkX2hpZ2gpCisJCWRwX2Rpc3BsYXlfcHJvY2Vzc19ocGRfaGlnaChkcCk7CitlbmQ6CisJ
cmV0dXJuIHJjOworfQorCitzdGF0aWMgdm9pZCBkcF9kaXNwbGF5X2NsZWFuKHN0cnVjdCBkcF9k
aXNwbGF5X3ByaXZhdGUgKmRwKQoreworCWRwX2N0cmxfcHVzaF9pZGxlKGRwLT5jdHJsKTsKKwlk
cF9jdHJsX29mZihkcC0+Y3RybCk7Cit9CisKK3N0YXRpYyBpbnQgZHBfZGlzcGxheV91c2JwZF9k
aXNjb25uZWN0X2NiKHN0cnVjdCBkZXZpY2UgKmRldikKK3sKKwlpbnQgcmMgPSAwOworCXN0cnVj
dCBkcF9kaXNwbGF5X3ByaXZhdGUgKmRwOworCisJaWYgKCFkZXYpIHsKKwkJRFJNX0VSUk9SKCJp
bnZhbGlkIGRldlxuIik7CisJCXJjID0gLUVJTlZBTDsKKwkJZ290byBlbmQ7CisJfQorCisJZHAg
PSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKKwlpZiAoIWRwKSB7CisJCURSTV9FUlJPUigibm8gZHJp
dmVyIGRhdGEgZm91bmRcbiIpOworCQlyYyA9IC1FTk9ERVY7CisJCWdvdG8gZW5kOworCX0KKwor
CXJjID0gZHBfZGlzcGxheV9zZW5kX2hwZF9ub3RpZmljYXRpb24oZHAsIGZhbHNlKTsKKworCS8q
IGlmIGNhYmxlIGlzIGRpc2Nvbm5lY3RlZCwgcmVzZXQgcHNtX2VuYWJsZWQgZmxhZyAqLworCWlm
ICghZHAtPnVzYnBkLT5hbHRfbW9kZV9jZmdfZG9uZSkKKwkJZHAtPmxpbmstPnBzbV9lbmFibGVk
ID0gZmFsc2U7CisKKwlpZiAoKHJjIDwgMCkgJiYgZHAtPnBvd2VyX29uKQorCQlkcF9kaXNwbGF5
X2NsZWFuKGRwKTsKKworCWRwX2Rpc3BsYXlfaG9zdF9kZWluaXQoZHApOworZW5kOgorCXJldHVy
biByYzsKK30KKworc3RhdGljIHZvaWQgZHBfZGlzcGxheV9oYW5kbGVfdmlkZW9fcmVxdWVzdChz
dHJ1Y3QgZHBfZGlzcGxheV9wcml2YXRlICpkcCkKK3sKKwlpZiAoZHAtPmxpbmstPnNpbmtfcmVx
dWVzdCAmIERQX1RFU1RfTElOS19WSURFT19QQVRURVJOKSB7CisJCS8qIGZvcmNlIGRpc2Nvbm5l
Y3QgZm9sbG93ZWQgYnkgY29ubmVjdCAqLworCQlkcC0+dXNicGQtPmNvbm5lY3QoZHAtPnVzYnBk
LCBmYWxzZSk7CisJCWRwLT5wYW5lbC0+dmlkZW9fdGVzdCA9IHRydWU7CisJCWRwLT51c2JwZC0+
Y29ubmVjdChkcC0+dXNicGQsIHRydWUpOworCQlkcF9saW5rX3NlbmRfdGVzdF9yZXNwb25zZShk
cC0+bGluayk7CisJfQorfQorCitzdGF0aWMgaW50IGRwX2Rpc3BsYXlfaGFuZGxlX2hwZF9pcnEo
c3RydWN0IGRwX2Rpc3BsYXlfcHJpdmF0ZSAqZHApCit7CisJaWYgKGRwLT5saW5rLT5zaW5rX3Jl
cXVlc3QgJiBEU19QT1JUX1NUQVRVU19DSEFOR0VEKSB7CisJCWRwX2Rpc3BsYXlfc2VuZF9ocGRf
bm90aWZpY2F0aW9uKGRwLCBmYWxzZSk7CisKKwkJaWYgKGRwX2Rpc3BsYXlfaXNfc2lua19jb3Vu
dF96ZXJvKGRwKSkgeworCQkJRFJNX0RFQlVHX0RQKCJzaW5rIGNvdW50IGlzIHplcm8sIG5vdGhp
bmcgdG8gZG9cbiIpOworCQkJcmV0dXJuIDA7CisJCX0KKworCQlyZXR1cm4gZHBfZGlzcGxheV9w
cm9jZXNzX2hwZF9oaWdoKGRwKTsKKwl9CisKKwlkcF9jdHJsX2hhbmRsZV9zaW5rX3JlcXVlc3Qo
ZHAtPmN0cmwpOworCisJZHBfZGlzcGxheV9oYW5kbGVfdmlkZW9fcmVxdWVzdChkcCk7CisKKwly
ZXR1cm4gMDsKK30KKworc3RhdGljIGludCBkcF9kaXNwbGF5X3VzYnBkX2F0dGVudGlvbl9jYihz
dHJ1Y3QgZGV2aWNlICpkZXYpCit7CisJaW50IHJjID0gMDsKKwlzdHJ1Y3QgZHBfZGlzcGxheV9w
cml2YXRlICpkcDsKKworCWlmICghZGV2KSB7CisJCURSTV9FUlJPUigiaW52YWxpZCBkZXZcbiIp
OworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlkcCA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwor
CWlmICghZHApIHsKKwkJRFJNX0VSUk9SKCJubyBkcml2ZXIgZGF0YSBmb3VuZFxuIik7CisJCXJl
dHVybiAtRU5PREVWOworCX0KKworCWlmIChkcC0+dXNicGQtPmhwZF9pcnEpIHsKKwkJZHAtPmhw
ZF9pcnFfb24gPSB0cnVlOworCisJCXJjID0gZHBfbGlua19wcm9jZXNzX3JlcXVlc3QoZHAtPmxp
bmspOworCQkvKiBjaGVjayBmb3IgYW55IHRlc3QgcmVxdWVzdCBpc3N1ZWQgYnkgc2luayAqLwor
CQlpZiAoIXJjKQorCQkJZHBfZGlzcGxheV9oYW5kbGVfaHBkX2lycShkcCk7CisKKwkJZHAtPmhw
ZF9pcnFfb24gPSBmYWxzZTsKKwkJZ290byBlbmQ7CisJfQorCisJaWYgKCFkcC0+dXNicGQtPmhw
ZF9oaWdoKSB7CisJCWRwX2Rpc3BsYXlfcHJvY2Vzc19ocGRfbG93KGRwKTsKKwkJZ290byBlbmQ7
CisJfQorCisJaWYgKGRwLT51c2JwZC0+YWx0X21vZGVfY2ZnX2RvbmUpCisJCWRwX2Rpc3BsYXlf
cHJvY2Vzc19ocGRfaGlnaChkcCk7CitlbmQ6CisJcmV0dXJuIHJjOworfQorCitzdGF0aWMgdm9p
ZCBkcF9kaXNwbGF5X2RlaW5pdF9zdWJfbW9kdWxlcyhzdHJ1Y3QgZHBfZGlzcGxheV9wcml2YXRl
ICpkcCkKK3sKKwlkcF9jdHJsX3B1dChkcC0+Y3RybCk7CisJZHBfbGlua19wdXQoZHAtPmxpbmsp
OworCWRwX3BhbmVsX3B1dChkcC0+cGFuZWwpOworCWRwX2F1eF9wdXQoZHAtPmF1eCk7CisJZHBf
cG93ZXJfcHV0KGRwLT5wb3dlcik7CisJZHBfY2F0YWxvZ19wdXQoZHAtPmNhdGFsb2cpOworCWRw
X3BhcnNlcl9wdXQoZHAtPnBhcnNlcik7Cit9CisKK3N0YXRpYyBpbnQgZHBfaW5pdF9zdWJfbW9k
dWxlcyhzdHJ1Y3QgZHBfZGlzcGxheV9wcml2YXRlICpkcCkKK3sKKwlpbnQgcmMgPSAwOworCXN0
cnVjdCBkZXZpY2UgKmRldiA9ICZkcC0+cGRldi0+ZGV2OworCXN0cnVjdCBkcF91c2JwZF9jYiAq
Y2IgPSAmZHAtPnVzYnBkX2NiOworCXN0cnVjdCBkcF9wYW5lbF9pbiBwYW5lbF9pbiA9IHsKKwkJ
LmRldiA9IGRldiwKKwl9OworCisJLyogQ2FsbGJhY2sgQVBJcyB1c2VkIGZvciBjYWJsZSBzdGF0
dXMgY2hhbmdlIGV2ZW50ICovCisJY2ItPmNvbmZpZ3VyZSAgPSBkcF9kaXNwbGF5X3VzYnBkX2Nv
bmZpZ3VyZV9jYjsKKwljYi0+ZGlzY29ubmVjdCA9IGRwX2Rpc3BsYXlfdXNicGRfZGlzY29ubmVj
dF9jYjsKKwljYi0+YXR0ZW50aW9uICA9IGRwX2Rpc3BsYXlfdXNicGRfYXR0ZW50aW9uX2NiOwor
CisJZHAtPnBhcnNlciA9IGRwX3BhcnNlcl9nZXQoZHAtPnBkZXYpOworCWlmIChJU19FUlIoZHAt
PnBhcnNlcikpIHsKKwkJcmMgPSBQVFJfRVJSKGRwLT5wYXJzZXIpOworCQlEUk1fRVJST1IoImZh
aWxlZCB0byBpbml0aWFsaXplIHBhcnNlciwgcmMgPSAlZFxuIiwgcmMpOworCQlkcC0+cGFyc2Vy
ID0gTlVMTDsKKwkJZ290byBlcnJvcl9wYXJzZXI7CisJfQorCisJZHAtPmNhdGFsb2cgPSBkcF9j
YXRhbG9nX2dldChkZXYsICZkcC0+cGFyc2VyLT5pbyk7CisJaWYgKElTX0VSUihkcC0+Y2F0YWxv
ZykpIHsKKwkJcmMgPSBQVFJfRVJSKGRwLT5jYXRhbG9nKTsKKwkJRFJNX0VSUk9SKCJmYWlsZWQg
dG8gaW5pdGlhbGl6ZSBjYXRhbG9nLCByYyA9ICVkXG4iLCByYyk7CisJCWRwLT5jYXRhbG9nID0g
TlVMTDsKKwkJZ290byBlcnJvcl9jYXRhbG9nOworCX0KKworCWRwLT5wb3dlciA9IGRwX3Bvd2Vy
X2dldChkcC0+cGFyc2VyKTsKKwlpZiAoSVNfRVJSKGRwLT5wb3dlcikpIHsKKwkJcmMgPSBQVFJf
RVJSKGRwLT5wb3dlcik7CisJCURSTV9FUlJPUigiZmFpbGVkIHRvIGluaXRpYWxpemUgcG93ZXIs
IHJjID0gJWRcbiIsIHJjKTsKKwkJZHAtPnBvd2VyID0gTlVMTDsKKwkJZ290byBlcnJvcl9wb3dl
cjsKKwl9CisKKwlkcC0+YXV4ID0gZHBfYXV4X2dldChkZXYsIGRwLT5jYXRhbG9nLCBkcC0+cGFy
c2VyLT5hdXhfY2ZnKTsKKwlpZiAoSVNfRVJSKGRwLT5hdXgpKSB7CisJCXJjID0gUFRSX0VSUihk
cC0+YXV4KTsKKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gaW5pdGlhbGl6ZSBhdXgsIHJjID0gJWRc
biIsIHJjKTsKKwkJZHAtPmF1eCA9IE5VTEw7CisJCWdvdG8gZXJyb3JfYXV4OworCX0KKworCWRw
LT5saW5rID0gZHBfbGlua19nZXQoZGV2LCBkcC0+YXV4KTsKKwlpZiAoSVNfRVJSKGRwLT5saW5r
KSkgeworCQlyYyA9IFBUUl9FUlIoZHAtPmxpbmspOworCQlEUk1fRVJST1IoImZhaWxlZCB0byBp
bml0aWFsaXplIGxpbmssIHJjID0gJWRcbiIsIHJjKTsKKwkJZHAtPmxpbmsgPSBOVUxMOworCQln
b3RvIGVycm9yX2xpbms7CisJfQorCisJcGFuZWxfaW4uYXV4ID0gZHAtPmF1eDsKKwlwYW5lbF9p
bi5jYXRhbG9nID0gZHAtPmNhdGFsb2c7CisJcGFuZWxfaW4ubGluayA9IGRwLT5saW5rOworCisJ
ZHAtPnBhbmVsID0gZHBfcGFuZWxfZ2V0KCZwYW5lbF9pbik7CisJaWYgKElTX0VSUihkcC0+cGFu
ZWwpKSB7CisJCXJjID0gUFRSX0VSUihkcC0+cGFuZWwpOworCQlEUk1fRVJST1IoImZhaWxlZCB0
byBpbml0aWFsaXplIHBhbmVsLCByYyA9ICVkXG4iLCByYyk7CisJCWRwLT5wYW5lbCA9IE5VTEw7
CisJCWdvdG8gZXJyb3JfcGFuZWw7CisJfQorCisJZHAtPmN0cmwgPSBkcF9jdHJsX2dldChkZXYs
IGRwLT5saW5rLCBkcC0+cGFuZWwsIGRwLT5hdXgsCisJCQkgICAgICAgZHAtPnBvd2VyLCBkcC0+
Y2F0YWxvZywgZHAtPnBhcnNlcik7CisJaWYgKElTX0VSUihkcC0+Y3RybCkpIHsKKwkJcmMgPSBQ
VFJfRVJSKGRwLT5jdHJsKTsKKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gaW5pdGlhbGl6ZSBjdHJs
LCByYyA9ICVkXG4iLCByYyk7CisJCWRwLT5jdHJsID0gTlVMTDsKKwkJZ290byBlcnJvcl9jdHJs
OworCX0KKworCXJldHVybiByYzsKK2Vycm9yX2N0cmw6CisJZHBfcGFuZWxfcHV0KGRwLT5wYW5l
bCk7CitlcnJvcl9wYW5lbDoKKwlkcF9saW5rX3B1dChkcC0+bGluayk7CitlcnJvcl9saW5rOgor
CWRwX2F1eF9wdXQoZHAtPmF1eCk7CitlcnJvcl9hdXg6CisJZHBfcG93ZXJfcHV0KGRwLT5wb3dl
cik7CitlcnJvcl9wb3dlcjoKKwlkcF9jYXRhbG9nX3B1dChkcC0+Y2F0YWxvZyk7CitlcnJvcl9j
YXRhbG9nOgorCWRwX3BhcnNlcl9wdXQoZHAtPnBhcnNlcik7CitlcnJvcl9wYXJzZXI6CisJcmV0
dXJuIHJjOworfQorCitzdGF0aWMgaW50IGRwX2Rpc3BsYXlfc2V0X21vZGUoc3RydWN0IG1zbV9k
cCAqZHBfZGlzcGxheSwKKwkJCSAgICAgICBzdHJ1Y3QgZHBfZGlzcGxheV9tb2RlICptb2RlKQor
eworCWludCByYyA9IDA7CisJc3RydWN0IGRwX2Rpc3BsYXlfcHJpdmF0ZSAqZHA7CisKKwlkcCA9
IGNvbnRhaW5lcl9vZihkcF9kaXNwbGF5LCBzdHJ1Y3QgZHBfZGlzcGxheV9wcml2YXRlLCBkcF9k
aXNwbGF5KTsKKworCWRwLT5wYW5lbC0+ZHBfbW9kZS5kcm1fbW9kZSA9IG1vZGUtPmRybV9tb2Rl
OworCWRwLT5wYW5lbC0+ZHBfbW9kZS5icHAgPSBtb2RlLT5icHA7CisJZHAtPnBhbmVsLT5kcF9t
b2RlLmNhcGFiaWxpdGllcyA9IG1vZGUtPmNhcGFiaWxpdGllczsKKwlkcF9wYW5lbF9pbml0X3Bh
bmVsX2luZm8oZHAtPnBhbmVsKTsKKwlyZXR1cm4gcmM7Cit9CisKK3N0YXRpYyBpbnQgZHBfZGlz
cGxheV9wcmVwYXJlKHN0cnVjdCBtc21fZHAgKmRwKQoreworCXJldHVybiAwOworfQorCitzdGF0
aWMgaW50IGRwX2Rpc3BsYXlfZW5hYmxlKHN0cnVjdCBtc21fZHAgKmRwX2Rpc3BsYXkpCit7CisJ
aW50IHJjID0gMDsKKwlzdHJ1Y3QgZHBfZGlzcGxheV9wcml2YXRlICpkcDsKKworCWRwID0gY29u
dGFpbmVyX29mKGRwX2Rpc3BsYXksIHN0cnVjdCBkcF9kaXNwbGF5X3ByaXZhdGUsIGRwX2Rpc3Bs
YXkpOworCisJaWYgKGRwLT5wb3dlcl9vbikgeworCQlEUk1fREVCVUdfRFAoIkxpbmsgYWxyZWFk
eSBzZXR1cCwgcmV0dXJuXG4iKTsKKwkJcmV0dXJuIDA7CisJfQorCisJZHBfYXV4X2luaXQoZHAt
PmF1eCwgZHAtPnBhcnNlci0+YXV4X2NmZyk7CisKKwlyYyA9IGRwX2N0cmxfb24oZHAtPmN0cmwp
OworCWlmICghcmMpCisJCWRwLT5wb3dlcl9vbiA9IHRydWU7CisKKwlyZXR1cm4gcmM7Cit9CisK
K3N0YXRpYyBpbnQgZHBfZGlzcGxheV9wb3N0X2VuYWJsZShzdHJ1Y3QgbXNtX2RwICpkcF9kaXNw
bGF5KQoreworCWludCByYyA9IDA7CisJc3RydWN0IGRwX2Rpc3BsYXlfcHJpdmF0ZSAqZHA7CisK
KwlkcCA9IGNvbnRhaW5lcl9vZihkcF9kaXNwbGF5LCBzdHJ1Y3QgZHBfZGlzcGxheV9wcml2YXRl
LCBkcF9kaXNwbGF5KTsKKworCWNvbXBsZXRlX2FsbCgmZHAtPm5vdGlmaWNhdGlvbl9jb21wKTsK
KwlyZXR1cm4gcmM7Cit9CisKK3N0YXRpYyBpbnQgZHBfZGlzcGxheV9wcmVfZGlzYWJsZShzdHJ1
Y3QgbXNtX2RwICpkcF9kaXNwbGF5KQoreworCWludCByYyA9IDA7CisJc3RydWN0IGRwX2Rpc3Bs
YXlfcHJpdmF0ZSAqZHA7CisKKwlkcCA9IGNvbnRhaW5lcl9vZihkcF9kaXNwbGF5LCBzdHJ1Y3Qg
ZHBfZGlzcGxheV9wcml2YXRlLCBkcF9kaXNwbGF5KTsKKworCWlmIChkcC0+dXNicGQtPmFsdF9t
b2RlX2NmZ19kb25lKQorCQlkcF9saW5rX3BzbV9jb25maWcoZHAtPmxpbmssICZkcC0+cGFuZWwt
PmxpbmtfaW5mbywgdHJ1ZSk7CisKKwlkcF9jdHJsX3B1c2hfaWRsZShkcC0+Y3RybCk7CisJcmV0
dXJuIHJjOworfQorCitzdGF0aWMgaW50IGRwX2Rpc3BsYXlfZGlzYWJsZShzdHJ1Y3QgbXNtX2Rw
ICpkcF9kaXNwbGF5KQoreworCWludCByYyA9IDA7CisJc3RydWN0IGRwX2Rpc3BsYXlfcHJpdmF0
ZSAqZHA7CisKKwlkcCA9IGNvbnRhaW5lcl9vZihkcF9kaXNwbGF5LCBzdHJ1Y3QgZHBfZGlzcGxh
eV9wcml2YXRlLCBkcF9kaXNwbGF5KTsKKworCWlmICghZHAtPnBvd2VyX29uIHx8ICFkcC0+Y29y
ZV9pbml0aWFsaXplZCkKKwkJZ290byBlcnJvcjsKKworCWRwX2N0cmxfb2ZmKGRwLT5jdHJsKTsK
KworCWRwLT5wb3dlcl9vbiA9IGZhbHNlOworCisJY29tcGxldGVfYWxsKCZkcC0+bm90aWZpY2F0
aW9uX2NvbXApOworZXJyb3I6CisJcmV0dXJuIHJjOworfQorCitpbnQgZHBfZGlzcGxheV9yZXF1
ZXN0X2lycShzdHJ1Y3QgbXNtX2RwICpkcF9kaXNwbGF5KQoreworCWludCByYyA9IDA7CisJc3Ry
dWN0IGRwX2Rpc3BsYXlfcHJpdmF0ZSAqZHA7CisKKwlpZiAoIWRwX2Rpc3BsYXkpIHsKKwkJRFJN
X0VSUk9SKCJpbnZhbGlkIGlucHV0XG4iKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJZHAg
PSBjb250YWluZXJfb2YoZHBfZGlzcGxheSwgc3RydWN0IGRwX2Rpc3BsYXlfcHJpdmF0ZSwgZHBf
ZGlzcGxheSk7CisKKwlkcC0+aXJxID0gaXJxX29mX3BhcnNlX2FuZF9tYXAoZHAtPnBkZXYtPmRl
di5vZl9ub2RlLCAwKTsKKwlpZiAoZHAtPmlycSA8IDApIHsKKwkJcmMgPSBkcC0+aXJxOworCQlE
Uk1fRVJST1IoImZhaWxlZCB0byBnZXQgaXJxOiAlZFxuIiwgcmMpOworCQlyZXR1cm4gcmM7CisJ
fQorCisJcmMgPSBkZXZtX3JlcXVlc3RfaXJxKCZkcC0+cGRldi0+ZGV2LCBkcC0+aXJxLCBkcF9k
aXNwbGF5X2lycSwKKwkJSVJRRl9UUklHR0VSX0hJR0gsICJkcF9kaXNwbGF5X2lzciIsIGRwKTsK
KwlpZiAocmMgPCAwKSB7CisJCURSTV9FUlJPUigiZmFpbGVkIHRvIHJlcXVlc3QgSVJRJXU6ICVk
XG4iLAorCQkJCWRwLT5pcnEsIHJjKTsKKwkJcmV0dXJuIHJjOworCX0KKwlkaXNhYmxlX2lycShk
cC0+aXJxKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGRwX2Rpc3BsYXlfdW5wcmVw
YXJlKHN0cnVjdCBtc21fZHAgKmRwKQoreworCXJldHVybiAwOworfQorCitpbnQgZHBfZGlzcGxh
eV92YWxpZGF0ZV9tb2RlKHN0cnVjdCBtc21fZHAgKmRwLCB1MzIgbW9kZV9wY2xrX2toeikKK3sK
Kwljb25zdCB1MzIgbnVtX2NvbXBvbmVudHMgPSAzLCBkZWZhdWx0X2JwcCA9IDI0OworCXN0cnVj
dCBkcF9kaXNwbGF5X3ByaXZhdGUgKmRwX2Rpc3BsYXk7CisJc3RydWN0IGRybV9kcF9saW5rICps
aW5rX2luZm87CisJdTMyIG1vZGVfcmF0ZV9raHogPSAwLCBzdXBwb3J0ZWRfcmF0ZV9raHogPSAw
LCBtb2RlX2JwcCA9IDA7CisKKwlpZiAoIWRwIHx8ICFtb2RlX3BjbGtfa2h6IHx8ICFkcC0+Y29u
bmVjdG9yKSB7CisJCURSTV9FUlJPUigiaW52YWxpZCBwYXJhbXNcbiIpOworCQlyZXR1cm4gLUVJ
TlZBTDsKKwl9CisKKwlkcF9kaXNwbGF5ID0gY29udGFpbmVyX29mKGRwLCBzdHJ1Y3QgZHBfZGlz
cGxheV9wcml2YXRlLCBkcF9kaXNwbGF5KTsKKwlsaW5rX2luZm8gPSAmZHBfZGlzcGxheS0+cGFu
ZWwtPmxpbmtfaW5mbzsKKworCW1vZGVfYnBwID0gZHAtPmNvbm5lY3Rvci0+ZGlzcGxheV9pbmZv
LmJwYyAqIG51bV9jb21wb25lbnRzOworCWlmICghbW9kZV9icHApCisJCW1vZGVfYnBwID0gZGVm
YXVsdF9icHA7CisKKwltb2RlX2JwcCA9IGRwX3BhbmVsX2dldF9tb2RlX2JwcChkcF9kaXNwbGF5
LT5wYW5lbCwKKwkJCW1vZGVfYnBwLCBtb2RlX3BjbGtfa2h6KTsKKworCW1vZGVfcmF0ZV9raHog
PSBtb2RlX3BjbGtfa2h6ICogbW9kZV9icHA7CisJc3VwcG9ydGVkX3JhdGVfa2h6ID0gbGlua19p
bmZvLT5udW1fbGFuZXMgKiBsaW5rX2luZm8tPnJhdGUgKiA4OworCisJaWYgKG1vZGVfcmF0ZV9r
aHogPiBzdXBwb3J0ZWRfcmF0ZV9raHopCisJCXJldHVybiBNT0RFX0JBRDsKKworCXJldHVybiBN
T0RFX09LOworfQorCitpbnQgZHBfZGlzcGxheV9nZXRfbW9kZXMoc3RydWN0IG1zbV9kcCAqZHAs
CisJCQkJc3RydWN0IGRwX2Rpc3BsYXlfbW9kZSAqZHBfbW9kZSkKK3sKKwlzdHJ1Y3QgZHBfZGlz
cGxheV9wcml2YXRlICpkcF9kaXNwbGF5OworCWludCByZXQgPSAwOworCisJaWYgKCFkcCkgewor
CQlEUk1fRVJST1IoImludmFsaWQgcGFyYW1zXG4iKTsKKwkJcmV0dXJuIDA7CisJfQorCisJZHBf
ZGlzcGxheSA9IGNvbnRhaW5lcl9vZihkcCwgc3RydWN0IGRwX2Rpc3BsYXlfcHJpdmF0ZSwgZHBf
ZGlzcGxheSk7CisKKwlyZXQgPSBkcF9wYW5lbF9nZXRfbW9kZXMoZHBfZGlzcGxheS0+cGFuZWws
CisJCWRwLT5jb25uZWN0b3IsIGRwX21vZGUpOworCWlmIChkcF9tb2RlLT5kcm1fbW9kZS5jbG9j
aykKKwkJZHAtPm1heF9wY2xrX2toeiA9IGRwX21vZGUtPmRybV9tb2RlLmNsb2NrOworCXJldHVy
biByZXQ7Cit9CisKK2Jvb2wgZHBfZGlzcGxheV9jaGVja192aWRlb190ZXN0KHN0cnVjdCBtc21f
ZHAgKmRwKQoreworCXN0cnVjdCBkcF9kaXNwbGF5X3ByaXZhdGUgKmRwX2Rpc3BsYXk7CisKKwlp
ZiAoIWRwKSB7CisJCURSTV9FUlJPUigiaW52YWxpZCBwYXJhbXNcbiIpOworCQlyZXR1cm4gZmFs
c2U7CisJfQorCisJZHBfZGlzcGxheSA9IGNvbnRhaW5lcl9vZihkcCwgc3RydWN0IGRwX2Rpc3Bs
YXlfcHJpdmF0ZSwgZHBfZGlzcGxheSk7CisKKwlpZiAoZHBfZGlzcGxheS0+cGFuZWwtPnZpZGVv
X3Rlc3QpCisJCXJldHVybiB0cnVlOworCisJcmV0dXJuIGZhbHNlOworfQorCitpbnQgZHBfZGlz
cGxheV9nZXRfdGVzdF9icHAoc3RydWN0IG1zbV9kcCAqZHApCit7CisJc3RydWN0IGRwX2Rpc3Bs
YXlfcHJpdmF0ZSAqZHBfZGlzcGxheTsKKworCWlmICghZHApIHsKKwkJRFJNX0VSUk9SKCJpbnZh
bGlkIHBhcmFtc1xuIik7CisJCXJldHVybiAwOworCX0KKworCWRwX2Rpc3BsYXkgPSBjb250YWlu
ZXJfb2YoZHAsIHN0cnVjdCBkcF9kaXNwbGF5X3ByaXZhdGUsIGRwX2Rpc3BsYXkpOworCisJcmV0
dXJuIGRwX2xpbmtfYml0X2RlcHRoX3RvX2JwcCgKKwkJZHBfZGlzcGxheS0+bGluay0+dGVzdF92
aWRlby50ZXN0X2JpdF9kZXB0aCk7Cit9CisKK3N0YXRpYyBpbnQgZHBfZGlzcGxheV9wcm9iZShz
dHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQoreworCWludCByYyA9IDA7CisJc3RydWN0IGRw
X2Rpc3BsYXlfcHJpdmF0ZSAqZHA7CisKKwlpZiAoIXBkZXYgfHwgIXBkZXYtPmRldi5vZl9ub2Rl
KSB7CisJCURSTV9FUlJPUigicGRldiBub3QgZm91bmRcbiIpOworCQlyZXR1cm4gLUVOT0RFVjsK
Kwl9CisKKwlkcCA9IGRldm1fa3phbGxvYygmcGRldi0+ZGV2LCBzaXplb2YoKmRwKSwgR0ZQX0tF
Uk5FTCk7CisJaWYgKCFkcCkKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlpbml0X2NvbXBsZXRpb24o
JmRwLT5ub3RpZmljYXRpb25fY29tcCk7CisKKwlkcC0+cGRldiA9IHBkZXY7CisJZHAtPm5hbWUg
PSAiZHJtX2RwIjsKKworCXJjID0gZHBfaW5pdF9zdWJfbW9kdWxlcyhkcCk7CisJaWYgKHJjKSB7
CisJCURSTV9FUlJPUigiaW5pdCBzdWIgbW9kdWxlIGZhaWxlZFxuIik7CisJCWRldm1fa2ZyZWUo
JnBkZXYtPmRldiwgZHApOworCQlyZXR1cm4gLUVQUk9CRV9ERUZFUjsKKwl9CisKKwlwbGF0Zm9y
bV9zZXRfZHJ2ZGF0YShwZGV2LCBkcCk7CisKKwltdXRleF9pbml0KCZkcC0+ZHBfZGlzcGxheS5j
b25uZWN0X211dGV4KTsKKwlnX2RwX2Rpc3BsYXkgPSAmZHAtPmRwX2Rpc3BsYXk7CisKKwlyYyA9
IGNvbXBvbmVudF9hZGQoJnBkZXYtPmRldiwgJmRwX2Rpc3BsYXlfY29tcF9vcHMpOworCWlmIChy
YykgeworCQlEUk1fRVJST1IoImNvbXBvbmVudCBhZGQgZmFpbGVkLCByYz0lZFxuIiwgcmMpOwor
CQlkcF9kaXNwbGF5X2RlaW5pdF9zdWJfbW9kdWxlcyhkcCk7CisJCWRldm1fa2ZyZWUoJnBkZXYt
PmRldiwgZHApOworCX0KKworCXJldHVybiByYzsKK30KKworc3RhdGljIGludCBkcF9kaXNwbGF5
X3JlbW92ZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQoreworCXN0cnVjdCBkcF9kaXNw
bGF5X3ByaXZhdGUgKmRwOworCisJaWYgKCFwZGV2KQorCQlyZXR1cm4gLUVJTlZBTDsKKworCWRw
ID0gcGxhdGZvcm1fZ2V0X2RydmRhdGEocGRldik7CisKKwlkcF9kaXNwbGF5X2RlaW5pdF9zdWJf
bW9kdWxlcyhkcCk7CisKKwlwbGF0Zm9ybV9zZXRfZHJ2ZGF0YShwZGV2LCBOVUxMKTsKKwlkZXZt
X2tmcmVlKCZwZGV2LT5kZXYsIGRwKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgc3RydWN0
IHBsYXRmb3JtX2RyaXZlciBkcF9kaXNwbGF5X2RyaXZlciA9IHsKKwkucHJvYmUgID0gZHBfZGlz
cGxheV9wcm9iZSwKKwkucmVtb3ZlID0gZHBfZGlzcGxheV9yZW1vdmUsCisJLmRyaXZlciA9IHsK
KwkJLm5hbWUgPSAibXNtLWRwLWRpc3BsYXkiLAorCQkub2ZfbWF0Y2hfdGFibGUgPSBkcF9kdF9t
YXRjaCwKKwl9LAorfTsKKworaW50IF9faW5pdCBtc21fZHBfcmVnaXN0ZXIodm9pZCkKK3sKKwlp
bnQgcmV0OworCisJcmV0ID0gcGxhdGZvcm1fZHJpdmVyX3JlZ2lzdGVyKCZkcF9kaXNwbGF5X2Ry
aXZlcik7CisJaWYgKHJldCkgeworCQlEUk1fRVJST1IoImRyaXZlciByZWdpc3RlciBmYWlsZWQi
KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXR1cm4gcmV0OworfQorCit2b2lkIF9fZXhpdCBt
c21fZHBfdW5yZWdpc3Rlcih2b2lkKQoreworCXBsYXRmb3JtX2RyaXZlcl91bnJlZ2lzdGVyKCZk
cF9kaXNwbGF5X2RyaXZlcik7Cit9CisKK2ludCBtc21fZHBfbW9kZXNldF9pbml0KHN0cnVjdCBt
c21fZHAgKmRwX2Rpc3BsYXksIHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCisJCQlzdHJ1Y3QgZHJt
X2VuY29kZXIgKmVuY29kZXIpCit7CisJc3RydWN0IG1zbV9kcm1fcHJpdmF0ZSAqcHJpdjsKKwlp
bnQgcmV0OworCisJaWYgKFdBUk5fT04oIWVuY29kZXIpIHx8IFdBUk5fT04oIWRwX2Rpc3BsYXkp
IHx8IFdBUk5fT04oIWRldikpCisJCXJldHVybiAtRUlOVkFMOworCisJcHJpdiA9IGRldi0+ZGV2
X3ByaXZhdGU7CisJZHBfZGlzcGxheS0+ZHJtX2RldiA9IGRldjsKKworCXJldCA9IGRwX2Rpc3Bs
YXlfcmVxdWVzdF9pcnEoZHBfZGlzcGxheSk7CisJaWYgKHJldCkgeworCQlEUk1fRVJST1IoInJl
cXVlc3RfaXJxIGZhaWxlZCwgcmV0PSVkXG4iLCByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKwor
CWRwX2Rpc3BsYXktPmVuY29kZXIgPSBlbmNvZGVyOworCisJZHBfZGlzcGxheS0+Y29ubmVjdG9y
ID0gZHBfZHJtX2Nvbm5lY3Rvcl9pbml0KGRwX2Rpc3BsYXkpOworCWlmIChJU19FUlIoZHBfZGlz
cGxheS0+Y29ubmVjdG9yKSkgeworCQlyZXQgPSBQVFJfRVJSKGRwX2Rpc3BsYXktPmNvbm5lY3Rv
cik7CisJCURSTV9ERVZfRVJST1IoZGV2LT5kZXYsCisJCQkiZmFpbGVkIHRvIGNyZWF0ZSBkcCBj
b25uZWN0b3I6ICVkXG4iLCByZXQpOworCQlkcF9kaXNwbGF5LT5jb25uZWN0b3IgPSBOVUxMOwor
CQlyZXR1cm4gcmV0OworCX0KKworCXByaXYtPmNvbm5lY3RvcnNbcHJpdi0+bnVtX2Nvbm5lY3Rv
cnMrK10gPSBkcF9kaXNwbGF5LT5jb25uZWN0b3I7CisJcmV0dXJuIDA7Cit9CisKK2ludCBtc21f
ZHBfZGlzcGxheV9lbmFibGUoc3RydWN0IG1zbV9kcCAqZHAsIHN0cnVjdCBkcm1fZW5jb2RlciAq
ZW5jb2RlcikKK3sKKwlpbnQgcmMgPSAwOworCXN0cnVjdCBkcF9kaXNwbGF5X3ByaXZhdGUgKmRw
X2Rpc3BsYXk7CisKKwlkcF9kaXNwbGF5ID0gY29udGFpbmVyX29mKGRwLCBzdHJ1Y3QgZHBfZGlz
cGxheV9wcml2YXRlLCBkcF9kaXNwbGF5KTsKKwlpZiAoIWRwX2Rpc3BsYXktPmRwX21vZGUuZHJt
X21vZGUuY2xvY2spIHsKKwkJRFJNX0VSUk9SKCJpbnZhbGlkIHBhcmFtc1xuIik7CisJCXJldHVy
biAtRUlOVkFMOworCX0KKworCXJjID0gZHBfZGlzcGxheV9zZXRfbW9kZShkcCwgJmRwX2Rpc3Bs
YXktPmRwX21vZGUpOworCWlmIChyYykgeworCQlEUk1fRVJST1IoIkZhaWxlZCB0byBwZXJmb3Jt
IGEgbW9kZSBzZXQsIHJjPSVkXG4iLCByYyk7CisJCXJldHVybiByYzsKKwl9CisKKwlyYyA9IGRw
X2Rpc3BsYXlfcHJlcGFyZShkcCk7CisJaWYgKHJjKSB7CisJCURSTV9FUlJPUigiRFAgZGlzcGxh
eSBwcmVwYXJlIGZhaWxlZCwgcmM9JWRcbiIsIHJjKTsKKwkJcmV0dXJuIHJjOworCX0KKworCXJj
ID0gZHBfZGlzcGxheV9lbmFibGUoZHApOworCWlmIChyYykgeworCQlEUk1fRVJST1IoIkRQIGRp
c3BsYXkgZW5hYmxlIGZhaWxlZCwgcmM9JWRcbiIsIHJjKTsKKwkJZHBfZGlzcGxheV91bnByZXBh
cmUoZHApOworCQlyZXR1cm4gcmM7CisJfQorCisJcmMgPSBkcF9kaXNwbGF5X3Bvc3RfZW5hYmxl
KGRwKTsKKwlpZiAocmMpIHsKKwkJRFJNX0VSUk9SKCJEUCBkaXNwbGF5IHBvc3QgZW5hYmxlIGZh
aWxlZCwgcmM9JWRcbiIsIHJjKTsKKwkJZHBfZGlzcGxheV9kaXNhYmxlKGRwKTsKKwkJZHBfZGlz
cGxheV91bnByZXBhcmUoZHApOworCX0KKwlyZXR1cm4gcmM7Cit9CisKK2ludCBtc21fZHBfZGlz
cGxheV9kaXNhYmxlKHN0cnVjdCBtc21fZHAgKmRwLCBzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29k
ZXIpCit7CisJaW50IHJjID0gMDsKKworCXJjID0gZHBfZGlzcGxheV9wcmVfZGlzYWJsZShkcCk7
CisJaWYgKHJjKSB7CisJCURSTV9FUlJPUigiRFAgZGlzcGxheSBwcmUgZGlzYWJsZSBmYWlsZWQs
IHJjPSVkXG4iLCByYyk7CisJCXJldHVybiByYzsKKwl9CisKKwlyYyA9IGRwX2Rpc3BsYXlfZGlz
YWJsZShkcCk7CisJaWYgKHJjKSB7CisJCURSTV9FUlJPUigiRFAgZGlzcGxheSBkaXNhYmxlIGZh
aWxlZCwgcmM9JWRcbiIsIHJjKTsKKwkJcmV0dXJuIHJjOworCX0KKworCXJjID0gZHBfZGlzcGxh
eV91bnByZXBhcmUoZHApOworCWlmIChyYykgeworCQlEUk1fRVJST1IoIkRQIGRpc3BsYXkgdW5w
cmVwYXJlIGZhaWxlZCwgcmM9JWRcbiIsIHJjKTsKKwl9CisJcmV0dXJuIHJjOworfQorCit2b2lk
IG1zbV9kcF9kaXNwbGF5X21vZGVfc2V0KHN0cnVjdCBtc21fZHAgKmRwLCBzdHJ1Y3QgZHJtX2Vu
Y29kZXIgKmVuY29kZXIsCisJCQkJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUsCisJCQkJ
c3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUpCit7CisJc3RydWN0IGRwX2Rp
c3BsYXlfcHJpdmF0ZSAqZHBfZGlzcGxheTsKKworCWRwX2Rpc3BsYXkgPSBjb250YWluZXJfb2Yo
ZHAsIHN0cnVjdCBkcF9kaXNwbGF5X3ByaXZhdGUsIGRwX2Rpc3BsYXkpOworCisJbWVtc2V0KCZk
cF9kaXNwbGF5LT5kcF9tb2RlLCAweDAsIHNpemVvZihzdHJ1Y3QgZHBfZGlzcGxheV9tb2RlKSk7
CisKKwlpZiAoZHBfZGlzcGxheV9jaGVja192aWRlb190ZXN0KGRwKSkKKwkJZHBfZGlzcGxheS0+
ZHBfbW9kZS5icHAgPSBkcF9kaXNwbGF5X2dldF90ZXN0X2JwcChkcCk7CisJZWxzZSAvKiBEZWZh
dWx0IG51bV9jb21wb25lbnRzIHBlciBwaXhlbCA9IDMgKi8KKwkJZHBfZGlzcGxheS0+ZHBfbW9k
ZS5icHAgPSBkcC0+Y29ubmVjdG9yLT5kaXNwbGF5X2luZm8uYnBjICogMzsKKworCWlmICghZHBf
ZGlzcGxheS0+ZHBfbW9kZS5icHApCisJCWRwX2Rpc3BsYXktPmRwX21vZGUuYnBwID0gMjQ7IC8q
IERlZmF1bHQgYnBwICovCisKKwlkcm1fbW9kZV9jb3B5KCZkcF9kaXNwbGF5LT5kcF9tb2RlLmRy
bV9tb2RlLCBhZGp1c3RlZF9tb2RlKTsKKworCWRwX2Rpc3BsYXktPmRwX21vZGUudl9hY3RpdmVf
bG93ID0KKwkJISEoZHBfZGlzcGxheS0+ZHBfbW9kZS5kcm1fbW9kZS5mbGFncyAmIERSTV9NT0RF
X0ZMQUdfTlZTWU5DKTsKKworCWRwX2Rpc3BsYXktPmRwX21vZGUuaF9hY3RpdmVfbG93ID0KKwkJ
ISEoZHBfZGlzcGxheS0+ZHBfbW9kZS5kcm1fbW9kZS5mbGFncyAmIERSTV9NT0RFX0ZMQUdfTkhT
WU5DKTsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfZGlzcGxheS5o
IGIvZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9kaXNwbGF5LmgKbmV3IGZpbGUgbW9kZSAxMDA2
NDQKaW5kZXggMDAwMDAwMC4uYzkxNjQwOAotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9tc20vZHAvZHBfZGlzcGxheS5oCkBAIC0wLDAgKzEsMjkgQEAKKy8qIFNQRFgtTGljZW5z
ZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkgKi8KKy8qCisgKiBDb3B5cmlnaHQgKGMpIDIwMTct
MjAxOSwgVGhlIExpbnV4IEZvdW5kYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuCisgKi8KKwor
I2lmbmRlZiBfRFBfRElTUExBWV9IXworI2RlZmluZSBfRFBfRElTUExBWV9IXworCisjaW5jbHVk
ZSA8ZHJtL2RybVAuaD4KKworI2luY2x1ZGUgImRwX3BhbmVsLmgiCisKK3N0cnVjdCBtc21fZHAg
eworCXN0cnVjdCBkcm1fZGV2aWNlICpkcm1fZGV2OworCXN0cnVjdCBkcm1fY29ubmVjdG9yICpj
b25uZWN0b3I7CisJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyOworCWJvb2wgaXNfY29ubmVj
dGVkOworCXN0cnVjdCBtdXRleCBjb25uZWN0X211dGV4OworCXUzMiBtYXhfcGNsa19raHo7Cit9
OworCitpbnQgZHBfZGlzcGxheV92YWxpZGF0ZV9tb2RlKHN0cnVjdCBtc21fZHAgKmRwX2Rpc3Bs
YXksIHUzMiBtb2RlX3BjbGtfa2h6KTsKK2ludCBkcF9kaXNwbGF5X2dldF9tb2RlcyhzdHJ1Y3Qg
bXNtX2RwICpkcF9kaXNwbGF5LAorCQlzdHJ1Y3QgZHBfZGlzcGxheV9tb2RlICpkcF9tb2RlKTsK
K2ludCBkcF9kaXNwbGF5X3JlcXVlc3RfaXJxKHN0cnVjdCBtc21fZHAgKmRwX2Rpc3BsYXkpOwor
Ym9vbCBkcF9kaXNwbGF5X2NoZWNrX3ZpZGVvX3Rlc3Qoc3RydWN0IG1zbV9kcCAqZHBfZGlzcGxh
eSk7CitpbnQgZHBfZGlzcGxheV9nZXRfdGVzdF9icHAoc3RydWN0IG1zbV9kcCAqZHBfZGlzcGxh
eSk7CisKKyNlbmRpZiAvKiBfRFBfRElTUExBWV9IXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL21zbS9kcC9kcF9kcm0uYyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfZHJtLmMK
bmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uYTcyYjBiYgotLS0gL2Rldi9udWxs
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfZHJtLmMKQEAgLTAsMCArMSwxNzMgQEAK
Ky8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkKKy8qCisgKiBDb3B5cmln
aHQgKGMpIDIwMTctMjAxOSwgVGhlIExpbnV4IEZvdW5kYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2
ZWQuCisgKi8KKworI2RlZmluZSBwcl9mbXQoZm10KQkiW2RybS1kcF06ICVzOiAiIGZtdCwgX19m
dW5jX18KKworI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljX2hlbHBlci5oPgorI2luY2x1ZGUgPGRy
bS9kcm1fYXRvbWljLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9jcnRjLmg+CisKKyNpbmNsdWRlICJt
c21fZHJ2LmgiCisjaW5jbHVkZSAibXNtX2ttcy5oIgorI2luY2x1ZGUgImRwX2RybS5oIgorCitz
dHJ1Y3QgZHBfY29ubmVjdG9yIHsKKwlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciBiYXNlOworCXN0cnVj
dCBtc21fZHAgKmRwX2Rpc3BsYXk7Cit9OworI2RlZmluZSB0b19kcF9jb25uZWN0b3IoeCkgY29u
dGFpbmVyX29mKHgsIHN0cnVjdCBkcF9jb25uZWN0b3IsIGJhc2UpCisKKy8qKgorICogZHBfY29u
bmVjdG9yX2RldGVjdCAtIGNhbGxiYWNrIHRvIGRldGVybWluZSBpZiBjb25uZWN0b3IgaXMgY29u
bmVjdGVkCisgKiBAY29ubmVjdG9yOiBQb2ludGVyIHRvIGRybSBjb25uZWN0b3Igc3RydWN0dXJl
CisgKiBAZm9yY2U6IEZvcmNlIGRldGVjdCBzZXR0aW5nIGZyb20gZHJtIGZyYW1ld29yaworICog
UmV0dXJuczogQ29ubmVjdG9yICdpcyBjb25uZWN0ZWQnIHN0YXR1cworICovCitzdGF0aWMgZW51
bSBkcm1fY29ubmVjdG9yX3N0YXR1cyBkcF9jb25uZWN0b3JfZGV0ZWN0KHN0cnVjdCBkcm1fY29u
bmVjdG9yICpjb25uLAorCQlib29sIGZvcmNlKQoreworCXN0cnVjdCBtc21fZHAgKmRwOworCisJ
ZHAgPSB0b19kcF9jb25uZWN0b3IoY29ubiktPmRwX2Rpc3BsYXk7CisKKwlEUk1fREVCVUdfRFAo
ImlzX2Nvbm5lY3RlZCA9ICVzXG4iLAorCQkoZHAtPmlzX2Nvbm5lY3RlZCkgPyAidHJ1ZSIgOiAi
ZmFsc2UiKTsKKworCXJldHVybiAoZHAtPmlzX2Nvbm5lY3RlZCkgPyBjb25uZWN0b3Jfc3RhdHVz
X2Nvbm5lY3RlZCA6CisJCQkJCWNvbm5lY3Rvcl9zdGF0dXNfZGlzY29ubmVjdGVkOworfQorCisv
KioKKyAqIGRwX2Nvbm5lY3Rvcl9nZXRfbW9kZXMgLSBjYWxsYmFjayB0byBhZGQgZHJtIG1vZGVz
IHZpYSBkcm1fbW9kZV9wcm9iZWRfYWRkKCkKKyAqIEBjb25uZWN0b3I6IFBvaW50ZXIgdG8gZHJt
IGNvbm5lY3RvciBzdHJ1Y3R1cmUKKyAqIFJldHVybnM6IE51bWJlciBvZiBtb2RlcyBhZGRlZAor
ICovCitzdGF0aWMgaW50IGRwX2Nvbm5lY3Rvcl9nZXRfbW9kZXMoc3RydWN0IGRybV9jb25uZWN0
b3IgKmNvbm5lY3RvcikKK3sKKwlpbnQgcmMgPSAwOworCXN0cnVjdCBtc21fZHAgKmRwOworCXN0
cnVjdCBkcF9kaXNwbGF5X21vZGUgKmRwX21vZGUgPSBOVUxMOworCXN0cnVjdCBkcm1fZGlzcGxh
eV9tb2RlICptLCBkcm1fbW9kZTsKKworCWlmICghY29ubmVjdG9yKQorCQlyZXR1cm4gMDsKKwor
CWRwID0gdG9fZHBfY29ubmVjdG9yKGNvbm5lY3RvciktPmRwX2Rpc3BsYXk7CisKKwlkcF9tb2Rl
ID0ga3phbGxvYyhzaXplb2YoKmRwX21vZGUpLCAgR0ZQX0tFUk5FTCk7CisJaWYgKCFkcF9tb2Rl
KQorCQlyZXR1cm4gMDsKKworCW11dGV4X2xvY2soJmRwLT5jb25uZWN0X211dGV4KTsKKwkvKiBw
bHVnZ2FibGUgY2FzZSBhc3N1bWVzIEVESUQgaXMgcmVhZCB3aGVuIEhQRCAqLworCWlmIChkcC0+
aXNfY29ubmVjdGVkKSB7CisJCS8qCisJCSAqVGhlIGdldF9tb2RlcygpIGZ1bmN0aW9uIG1pZ2h0
IHJldHVybiBvbmUgbW9kZSB0aGF0IGlzIHN0b3JlZAorCQkgKiBpbiBkcF9tb2RlIHdoZW4gY29t
cGxpYW5jZSB0ZXN0IGlzIGluIHByb2dyZXNzLiBJZiBub3QsIHRoZQorCQkgKiByZXR1cm4gdmFs
dWUgaXMgZXF1YWwgdG8gdGhlIHRvdGFsIG51bWJlciBvZiBtb2RlcyBzdXBwb3J0ZWQKKwkJICog
YnkgdGhlIHNpbmsKKwkJICovCisJCXJjID0gZHBfZGlzcGxheV9nZXRfbW9kZXMoZHAsIGRwX21v
ZGUpOworCQlpZiAocmMgPD0gMCkgeworCQkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gZ2V0IERQIHNp
bmsgbW9kZXMsIHJjPSVkXG4iLCByYyk7CisJCQltdXRleF91bmxvY2soJmRwLT5jb25uZWN0X211
dGV4KTsKKwkJCXJldHVybiByYzsKKwkJfQorCQlpZiAoZHBfbW9kZS0+ZHJtX21vZGUuY2xvY2sp
IHsgLyogdmFsaWQgRFAgbW9kZSAqLworCQkJbWVtc2V0KCZkcm1fbW9kZSwgMHgwLCBzaXplb2Yo
ZHJtX21vZGUpKTsKKwkJCWRybV9tb2RlX2NvcHkoJmRybV9tb2RlLCAmZHBfbW9kZS0+ZHJtX21v
ZGUpOworCQkJbSA9IGRybV9tb2RlX2R1cGxpY2F0ZShjb25uZWN0b3ItPmRldiwgJmRybV9tb2Rl
KTsKKwkJCWlmICghbSkgeworCQkJCURSTV9FUlJPUigiZmFpbGVkIHRvIGFkZCBtb2RlICV1eCV1
XG4iLAorCQkJCSAgICAgICBkcm1fbW9kZS5oZGlzcGxheSwKKwkJCQkgICAgICAgZHJtX21vZGUu
dmRpc3BsYXkpOworCQkJCWtmcmVlKGRwX21vZGUpOworCQkJCW11dGV4X3VubG9jaygmZHAtPmNv
bm5lY3RfbXV0ZXgpOworCQkJCXJldHVybiAwOworCQkJfQorCQkJZHJtX21vZGVfcHJvYmVkX2Fk
ZChjb25uZWN0b3IsIG0pOworCQl9CisJfSBlbHNlIHsKKwkJRFJNX0RFQlVHX0RQKCJObyBzaW5r
IGNvbm5lY3RlZFxuIik7CisJfQorCW11dGV4X3VubG9jaygmZHAtPmNvbm5lY3RfbXV0ZXgpOwor
CWtmcmVlKGRwX21vZGUpOworCXJldHVybiByYzsKK30KKworLyoqCisgKiBkcF9jb25uZWN0b3Jf
bW9kZV92YWxpZCAtIGNhbGxiYWNrIHRvIGRldGVybWluZSBpZiBzcGVjaWZpZWQgbW9kZSBpcyB2
YWxpZAorICogQGNvbm5lY3RvcjogUG9pbnRlciB0byBkcm0gY29ubmVjdG9yIHN0cnVjdHVyZQor
ICogQG1vZGU6IFBvaW50ZXIgdG8gZHJtIG1vZGUgc3RydWN0dXJlCisgKiBSZXR1cm5zOiBWYWxp
ZGl0eSBzdGF0dXMgZm9yIHNwZWNpZmllZCBtb2RlCisgKi8KK3N0YXRpYyBlbnVtIGRybV9tb2Rl
X3N0YXR1cyBkcF9jb25uZWN0b3JfbW9kZV92YWxpZChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29u
bmVjdG9yLAorCQlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkKK3sKKwlzdHJ1Y3QgbXNt
X2RwICpkcF9kaXNwOworCisJaWYgKCFtb2RlIHx8ICFjb25uZWN0b3IpIHsKKwkJRFJNX0VSUk9S
KCJpbnZhbGlkIHBhcmFtc1xuIik7CisJCXJldHVybiBNT0RFX0VSUk9SOworCX0KKworCWRwX2Rp
c3AgPSB0b19kcF9jb25uZWN0b3IoY29ubmVjdG9yKS0+ZHBfZGlzcGxheTsKKworCW1vZGUtPnZy
ZWZyZXNoID0gZHJtX21vZGVfdnJlZnJlc2gobW9kZSk7CisKKwlpZiAoKGRwX2Rpc3AtPm1heF9w
Y2xrX2toeiA8PSAwKSB8fAorCQkJKGRwX2Rpc3AtPm1heF9wY2xrX2toeiA+IERQX01BWF9QSVhF
TF9DTEtfS0haKSB8fAorCQkJKG1vZGUtPmNsb2NrID4gZHBfZGlzcC0+bWF4X3BjbGtfa2h6KSkK
KwkJcmV0dXJuIE1PREVfQkFEOworCisJcmV0dXJuIGRwX2Rpc3BsYXlfdmFsaWRhdGVfbW9kZShk
cF9kaXNwLCBtb2RlLT5jbG9jayk7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5l
Y3Rvcl9mdW5jcyBkcF9jb25uZWN0b3JfZnVuY3MgPSB7CisJLmRldGVjdCA9IGRwX2Nvbm5lY3Rv
cl9kZXRlY3QsCisJLmZpbGxfbW9kZXMgPSBkcm1faGVscGVyX3Byb2JlX3NpbmdsZV9jb25uZWN0
b3JfbW9kZXMsCisJLmRlc3Ryb3kgPSBkcm1fY29ubmVjdG9yX2NsZWFudXAsCisJLnJlc2V0ID0g
ZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX3Jlc2V0LAorCS5hdG9taWNfZHVwbGljYXRlX3N0
YXRlID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2R1cGxpY2F0ZV9zdGF0ZSwKKwkuYXRv
bWljX2Rlc3Ryb3lfc3RhdGUgPSBkcm1fYXRvbWljX2hlbHBlcl9jb25uZWN0b3JfZGVzdHJveV9z
dGF0ZSwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9oZWxwZXJfZnVu
Y3MgZHBfY29ubmVjdG9yX2hlbHBlcl9mdW5jcyA9IHsKKwkuZ2V0X21vZGVzID0gZHBfY29ubmVj
dG9yX2dldF9tb2RlcywKKwkubW9kZV92YWxpZCA9IGRwX2Nvbm5lY3Rvcl9tb2RlX3ZhbGlkLAor
fTsKKworLyogY29ubmVjdG9yIGluaXRpYWxpemF0aW9uICovCitzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
ciAqZHBfZHJtX2Nvbm5lY3Rvcl9pbml0KHN0cnVjdCBtc21fZHAgKmRwX2Rpc3BsYXkpCit7CisJ
c3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciA9IE5VTEw7CisJc3RydWN0IGRwX2Nvbm5l
Y3RvciAqZHBfY29ubmVjdG9yOworCWludCByZXQ7CisKKwlkcF9jb25uZWN0b3IgPSBkZXZtX2t6
YWxsb2MoZHBfZGlzcGxheS0+ZHJtX2Rldi0+ZGV2LCBzaXplb2YoKmRwX2Nvbm5lY3RvciksCisJ
CQkJICAgIEdGUF9LRVJORUwpOworCWlmICghZHBfY29ubmVjdG9yKQorCQlyZXR1cm4gRVJSX1BU
UigtRU5PTUVNKTsKKworCWRwX2Nvbm5lY3Rvci0+ZHBfZGlzcGxheSA9IGRwX2Rpc3BsYXk7CisK
Kwljb25uZWN0b3IgPSAmZHBfY29ubmVjdG9yLT5iYXNlOworCisJcmV0ID0gZHJtX2Nvbm5lY3Rv
cl9pbml0KGRwX2Rpc3BsYXktPmRybV9kZXYsIGNvbm5lY3RvciwgJmRwX2Nvbm5lY3Rvcl9mdW5j
cywKKwkJCURSTV9NT0RFX0NPTk5FQ1RPUl9EaXNwbGF5UG9ydCk7CisJaWYgKHJldCkKKwkJcmV0
dXJuIEVSUl9QVFIocmV0KTsKKworCWRybV9jb25uZWN0b3JfaGVscGVyX2FkZChjb25uZWN0b3Is
ICZkcF9jb25uZWN0b3JfaGVscGVyX2Z1bmNzKTsKKworCS8qCisJICogRW5hYmxlIEhQRCB0byBs
ZXQgaHBkIGV2ZW50IGlzIGhhbmRsZWQgd2hlbiBjYWJsZSBpcyBhdHRhY2hlZCB0byB0aGUgaG9z
dC4KKwkgKi8KKwljb25uZWN0b3ItPnBvbGxlZCA9IERSTV9DT05ORUNUT1JfUE9MTF9IUEQ7CisK
Kwlkcm1fY29ubmVjdG9yX2F0dGFjaF9lbmNvZGVyKGNvbm5lY3RvciwgZHBfZGlzcGxheS0+ZW5j
b2Rlcik7CisKKwlyZXR1cm4gY29ubmVjdG9yOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL21zbS9kcC9kcF9kcm0uaCBiL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfZHJtLmgKbmV3
IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uY2Y0NzJjNQotLS0gL2Rldi9udWxsCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfZHJtLmgKQEAgLTAsMCArMSwyMCBAQAorLyog
U1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seSAqLworLyoKKyAqIENvcHlyaWdo
dCAoYykgMjAxNy0yMDE5LCBUaGUgTGludXggRm91bmRhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZl
ZC4KKyAqLworCisjaWZuZGVmIF9EUF9EUk1fSF8KKyNkZWZpbmUgX0RQX0RSTV9IXworCisjaW5j
bHVkZSA8bGludXgvdHlwZXMuaD4KKyNpbmNsdWRlIDxkcm0vZHJtUC5oPgorI2luY2x1ZGUgPGRy
bS9kcm1fY3J0Yy5oPgorI2luY2x1ZGUgPGRybS9kcm1fY3J0Y19oZWxwZXIuaD4KKworI2luY2x1
ZGUgIm1zbV9kcnYuaCIKKyNpbmNsdWRlICJkcF9kaXNwbGF5LmgiCisKK3N0cnVjdCBkcm1fY29u
bmVjdG9yICpkcF9kcm1fY29ubmVjdG9yX2luaXQoc3RydWN0IG1zbV9kcCAqZHBfZGlzcGxheSk7
CisKKyNlbmRpZiAvKiBfRFBfRFJNX0hfICovCisKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9tc20vZHAvZHBfZXh0Y29uLmMgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX2V4dGNvbi5j
Cm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjBmYjM0ZWYKLS0tIC9kZXYvbnVs
bAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX2V4dGNvbi5jCkBAIC0wLDAgKzEsMjE2
IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5CisvKgorICogQ29w
eXJpZ2h0IChjKSAyMDEyLTIwMTksIFRoZSBMaW51eCBGb3VuZGF0aW9uLiBBbGwgcmlnaHRzIHJl
c2VydmVkLgorICovCisKKyNkZWZpbmUgcHJfZm10KGZtdCkJIltkcm0tZHBdICVzOiAiIGZtdCwg
X19mdW5jX18KKworI2luY2x1ZGUgPGxpbnV4L3NsYWIuaD4KKyNpbmNsdWRlIDxsaW51eC9kZXZp
Y2UuaD4KKyNpbmNsdWRlIDxsaW51eC9leHRjb24uaD4KKyNpbmNsdWRlIDxkcm0vZHJtUC5oPgor
CisjaW5jbHVkZSAiZHBfZXh0Y29uLmgiCisKKy8qIERQIHNwZWNpZmljIFZETSBjb21tYW5kcyAq
LworI2RlZmluZSBEUF9VU0JQRF9WRE1fU1RBVFVTCTB4MTAKKyNkZWZpbmUgRFBfVVNCUERfVkRN
X0NPTkZJR1VSRQkweDExCisKKy8qIFVTQlBELVR5cGVDIHNwZWNpZmljIE1hY3JvcyAqLworI2Rl
ZmluZSBWRE1fVkVSU0lPTgkJMHgwCisjZGVmaW5lIFVTQl9DX0RQX1NJRAkJMHhGRjAxCisKK3N0
cnVjdCBkcF9leHRjb25fcHJpdmF0ZSB7CisJdTMyIHZkbzsKKwlzdHJ1Y3QgZGV2aWNlICpkZXY7
CisJc3RydWN0IG5vdGlmaWVyX2Jsb2NrIGV4dGNvbl9uYjsKKwlzdHJ1Y3QgZXh0Y29uX2RldiAq
ZXh0Y29uOworCXN0cnVjdCB3b3JrcXVldWVfc3RydWN0ICpleHRjb25fd3E7CisJc3RydWN0IHdv
cmtfc3RydWN0IGV2ZW50X3dvcms7CisJc3RydWN0IHVzYnBkICpwZDsKKwlzdHJ1Y3QgZHBfdXNi
cGRfY2IgKmRwX2NiOworCXN0cnVjdCBkcF91c2JwZCBkcF91c2JwZDsKK307CisKK3N0YXRpYyBp
bnQgZHBfZXh0Y29uX2Nvbm5lY3Qoc3RydWN0IGRwX3VzYnBkICpkcF91c2JwZCwgYm9vbCBocGQp
Cit7CisJaW50IHJjID0gMDsKKwlzdHJ1Y3QgZHBfZXh0Y29uX3ByaXZhdGUgKmV4dGNvbl9wcml2
OworCisJZXh0Y29uX3ByaXYgPSBjb250YWluZXJfb2YoZHBfdXNicGQsIHN0cnVjdCBkcF9leHRj
b25fcHJpdmF0ZSwgZHBfdXNicGQpOworCisJZHBfdXNicGQtPmhwZF9oaWdoID0gaHBkOworCisJ
aWYgKCFleHRjb25fcHJpdi0+ZHBfY2IgJiYgIWV4dGNvbl9wcml2LT5kcF9jYi0+Y29uZmlndXJl
CisJCQkJJiYgIWV4dGNvbl9wcml2LT5kcF9jYi0+ZGlzY29ubmVjdCkgeworCQlEUk1fRVJST1Io
ImV4dGNvbiBkcF9jYiBub3QgaW5pdGlhbGl6ZWRcbiIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9
CisJaWYgKGhwZCkKKwkJZXh0Y29uX3ByaXYtPmRwX2NiLT5jb25maWd1cmUoZXh0Y29uX3ByaXYt
PmRldik7CisJZWxzZQorCQlleHRjb25fcHJpdi0+ZHBfY2ItPmRpc2Nvbm5lY3QoZXh0Y29uX3By
aXYtPmRldik7CisKKwlyZXR1cm4gcmM7Cit9CisKK3N0YXRpYyB2b2lkIGRwX2V4dGNvbl9ldmVu
dF93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKK3sKKwlzdHJ1Y3QgZHBfZXh0Y29uX3By
aXZhdGUgKmV4dGNvbl9wcml2OworCWludCBkcF9zdGF0ZSwgcmV0OworCXVuaW9uIGV4dGNvbl9w
cm9wZXJ0eV92YWx1ZSBwcm9wZXJ0eTsKKworCWV4dGNvbl9wcml2ID0gY29udGFpbmVyX29mKHdv
cmssCisJCQlzdHJ1Y3QgZHBfZXh0Y29uX3ByaXZhdGUsIGV2ZW50X3dvcmspOworCisJaWYgKCFl
eHRjb25fcHJpdiB8fCAhZXh0Y29uX3ByaXYtPmV4dGNvbikgeworCQlEUk1fRVJST1IoIkludmFs
aWQgZXh0Y29uIGRldmljZSBoYW5kbGVyXG4iKTsKKwkJcmV0dXJuOworCX0KKworCWRwX3N0YXRl
ID0gZXh0Y29uX2dldF9zdGF0ZShleHRjb25fcHJpdi0+ZXh0Y29uLCBFWFRDT05fRElTUF9EUCk7
CisKKwlpZiAoZHBfc3RhdGUgPiAwKSB7CisJCXJldCA9IGV4dGNvbl9nZXRfcHJvcGVydHkoZXh0
Y29uX3ByaXYtPmV4dGNvbiwKKwkJCQkJRVhUQ09OX0RJU1BfRFAsCisJCQkJCUVYVENPTl9QUk9Q
X1VTQl9UWVBFQ19QT0xBUklUWSwKKwkJCQkJJnByb3BlcnR5KTsKKwkJaWYgKHJldCkgeworCQkJ
RFJNX0VSUk9SKCJHZXQgUG9sYXJpdHkgcHJvcGVydHkgZmFpbGVkXG4iKTsKKwkJCXJldHVybjsK
KwkJfQorCQlleHRjb25fcHJpdi0+ZHBfdXNicGQub3JpZW50YXRpb24gPQorCQkJKHByb3BlcnR5
LmludHZhbCkgPyBPUklFTlRBVElPTl9DQzIgOiBPUklFTlRBVElPTl9DQzE7CisKKwkJZXh0Y29u
X2dldF9wcm9wZXJ0eShleHRjb25fcHJpdi0+ZXh0Y29uLAorCQkJCQlFWFRDT05fRElTUF9EUCwK
KwkJCQkJRVhUQ09OX1BST1BfVVNCX1NTLAorCQkJCQkmcHJvcGVydHkpOworCQlleHRjb25fcHJp
di0+ZHBfdXNicGQubXVsdGlfZnVuYyA9CisJCQkJKChwcm9wZXJ0eS5pbnR2YWwpID8gdHJ1ZSA6
IGZhbHNlKTsKKworCQlyZXQgPSBkcF9leHRjb25fY29ubmVjdCgmZXh0Y29uX3ByaXYtPmRwX3Vz
YnBkLCB0cnVlKTsKKwkJaWYgKHJldCkgeworCQkJRFJNX0VSUk9SKCJleHRjb25fY29ubmVjdC0+
dHJ1ZSBmYWlsZWRcbiIpOworCQkJcmV0dXJuOworCQl9CisJfSBlbHNlIHsKKwkJcmV0ID0gZHBf
ZXh0Y29uX2Nvbm5lY3QoJmV4dGNvbl9wcml2LT5kcF91c2JwZCwgZmFsc2UpOworCQlpZiAocmV0
KSB7CisJCQlEUk1fRVJST1IoImV4dGNvbl9jb25uZWN0LT5mYWxzZSBmYWlsZWRcbiIpOworCQkJ
cmV0dXJuOworCQl9CisJfQorfQorCitzdGF0aWMgaW50IGRwX2V4dGNvbl9ldmVudF9ub3RpZnko
c3RydWN0IG5vdGlmaWVyX2Jsb2NrICpuYiwKKwkJCQkgIHVuc2lnbmVkIGxvbmcgZXZlbnQsIHZv
aWQgKnByaXYpCit7CisJc3RydWN0IGRwX2V4dGNvbl9wcml2YXRlICpleHRjb25fcHJpdjsKKwor
CWV4dGNvbl9wcml2ID0gY29udGFpbmVyX29mKG5iLCBzdHJ1Y3QgZHBfZXh0Y29uX3ByaXZhdGUs
CisJCQkJCQlleHRjb25fbmIpOworCisJcXVldWVfd29yayhleHRjb25fcHJpdi0+ZXh0Y29uX3dx
LCAmZXh0Y29uX3ByaXYtPmV2ZW50X3dvcmspOworCXJldHVybiBOT1RJRllfRE9ORTsKK30KKwor
aW50IGRwX2V4dGNvbl9yZWdpc3RlcihzdHJ1Y3QgZHBfdXNicGQgKmRwX3VzYnBkKQoreworCXN0
cnVjdCBkcF9leHRjb25fcHJpdmF0ZSAqZXh0Y29uX3ByaXY7CisJaW50IHJldCA9IDA7CisKKwlp
ZiAoIWRwX3VzYnBkKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCWV4dGNvbl9wcml2ID0gY29udGFp
bmVyX29mKGRwX3VzYnBkLCBzdHJ1Y3QgZHBfZXh0Y29uX3ByaXZhdGUsIGRwX3VzYnBkKTsKKwor
CWV4dGNvbl9wcml2LT5leHRjb25fbmIubm90aWZpZXJfY2FsbCA9IGRwX2V4dGNvbl9ldmVudF9u
b3RpZnk7CisJcmV0ID0gZGV2bV9leHRjb25fcmVnaXN0ZXJfbm90aWZpZXIoZXh0Y29uX3ByaXYt
PmRldiwgZXh0Y29uX3ByaXYtPmV4dGNvbiwKKwkJCQkJICAgIEVYVENPTl9ESVNQX0RQLAorCQkJ
CQkgICAgJmV4dGNvbl9wcml2LT5leHRjb25fbmIpOworCWlmIChyZXQpIHsKKwkJRFJNX0RFVl9F
UlJPUihleHRjb25fcHJpdi0+ZGV2LAorCQkJInJlZ2lzdGVyIEVYVENPTl9ESVNQX0RQIG5vdGlm
aWVyIGVyclxuIik7CisJCXJldCA9IC1FSU5WQUw7CisJCXJldHVybiByZXQ7CisJfQorCisJZXh0
Y29uX3ByaXYtPmV4dGNvbl93cSA9IGNyZWF0ZV9zaW5nbGV0aHJlYWRfd29ya3F1ZXVlKCJkcm1f
ZHBfZXh0Y29uIik7CisJaWYgKElTX0VSUl9PUl9OVUxMKGV4dGNvbl9wcml2LT5leHRjb25fd3Ep
KSB7CisJCURSTV9FUlJPUigiRmFpbGVkIHRvIGNyZWF0ZSB3b3JrcXVldWVcbiIpOworCQlkcF9l
eHRjb25fdW5yZWdpc3RlcihkcF91c2JwZCk7CisJCXJldHVybiAtRVBFUk07CisJfQorCisJSU5J
VF9XT1JLKCZleHRjb25fcHJpdi0+ZXZlbnRfd29yaywgZHBfZXh0Y29uX2V2ZW50X3dvcmspOwor
CXJldHVybiByZXQ7Cit9CisKK3ZvaWQgZHBfZXh0Y29uX3VucmVnaXN0ZXIoc3RydWN0IGRwX3Vz
YnBkICpkcF91c2JwZCkKK3sKKwlzdHJ1Y3QgZHBfZXh0Y29uX3ByaXZhdGUgKmV4dGNvbl9wcml2
OworCisJaWYgKCFkcF91c2JwZCkgeworCQlEUk1fRVJST1IoIkludmFsaWQgaW5wdXRcbiIpOwor
CQlyZXR1cm47CisJfQorCisJZXh0Y29uX3ByaXYgPSBjb250YWluZXJfb2YoZHBfdXNicGQsIHN0
cnVjdCBkcF9leHRjb25fcHJpdmF0ZSwgZHBfdXNicGQpOworCisJZGV2bV9leHRjb25fdW5yZWdp
c3Rlcl9ub3RpZmllcihleHRjb25fcHJpdi0+ZGV2LCBleHRjb25fcHJpdi0+ZXh0Y29uLAorCQkJ
CQkgICAgRVhUQ09OX0RJU1BfRFAsCisJCQkJCSAgICAmZXh0Y29uX3ByaXYtPmV4dGNvbl9uYik7
CisKKwlpZiAoZXh0Y29uX3ByaXYtPmV4dGNvbl93cSkKKwkJZGVzdHJveV93b3JrcXVldWUoZXh0
Y29uX3ByaXYtPmV4dGNvbl93cSk7CisKKwlyZXR1cm47Cit9CisKK3N0cnVjdCBkcF91c2JwZCAq
ZHBfZXh0Y29uX2dldChzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBkcF91c2JwZF9jYiAqY2Ip
Cit7CisJaW50IHJjID0gMDsKKwlzdHJ1Y3QgZHBfZXh0Y29uX3ByaXZhdGUgKmRwX2V4dGNvbjsK
KwlzdHJ1Y3QgZHBfdXNicGQgKmRwX3VzYnBkOworCisJaWYgKCFjYikgeworCQlEUk1fRVJST1Io
ImludmFsaWQgY2IgZGF0YVxuIik7CisJCXJjID0gLUVJTlZBTDsKKwkJcmV0dXJuIEVSUl9QVFIo
cmMpOworCX0KKworCWRwX2V4dGNvbiA9IGRldm1fa3phbGxvYyhkZXYsIHNpemVvZigqZHBfZXh0
Y29uKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFkcF9leHRjb24pIHsKKwkJcmMgPSAtRU5PTUVNOwor
CQlyZXR1cm4gRVJSX1BUUihyYyk7CisJfQorCisJZHBfZXh0Y29uLT5leHRjb24gPSBleHRjb25f
Z2V0X2VkZXZfYnlfcGhhbmRsZShkZXYsIDApOworCWlmICghZHBfZXh0Y29uLT5leHRjb24pIHsK
KwkJRFJNX0VSUk9SKCJpbnZhbGlkIGV4dGNvbiBkYXRhXG4iKTsKKwkJcmMgPSAtRUlOVkFMOwor
CQlkZXZtX2tmcmVlKGRldiwgZHBfZXh0Y29uKTsKKwkJcmV0dXJuIEVSUl9QVFIocmMpOworICAg
ICAgICB9CisKKwlkcF9leHRjb24tPmRldiA9IGRldjsKKwlkcF9leHRjb24tPmRwX2NiID0gY2I7
CisKKwlkcF9leHRjb24tPmRwX3VzYnBkLmNvbm5lY3QgPSBkcF9leHRjb25fY29ubmVjdDsKKwlk
cF91c2JwZCA9ICZkcF9leHRjb24tPmRwX3VzYnBkOworCisJcmV0dXJuIGRwX3VzYnBkOworfQor
Cit2b2lkIGRwX2V4dGNvbl9wdXQoc3RydWN0IGRwX3VzYnBkICpkcF91c2JwZCkKK3sKKwlzdHJ1
Y3QgZHBfZXh0Y29uX3ByaXZhdGUgKmV4dGNvbjsKKworCWlmICghZHBfdXNicGQpCisJCXJldHVy
bjsKKworCWV4dGNvbiA9IGNvbnRhaW5lcl9vZihkcF91c2JwZCwgc3RydWN0IGRwX2V4dGNvbl9w
cml2YXRlLCBkcF91c2JwZCk7CisKKwlkZXZtX2tmcmVlKGV4dGNvbi0+ZGV2LCBleHRjb24pOwor
fQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9leHRjb24uaCBiL2RyaXZl
cnMvZ3B1L2RybS9tc20vZHAvZHBfZXh0Y29uLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXgg
MDAwMDAwMC4uYzZjMzA1MQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9tc20v
ZHAvZHBfZXh0Y29uLmgKQEAgLTAsMCArMSw4NCBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IEdQTC0yLjAtb25seSAqLworLyoKKyAqIENvcHlyaWdodCAoYykgMjAxMi0yMDE5LCBUaGUg
TGludXggRm91bmRhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KKyAqLworCisjaWZuZGVmIF9E
UF9FWFRDT05fSF8KKyNkZWZpbmUgX0RQX0VYVENPTl9IXworCisvLyNpbmNsdWRlIDxsaW51eC91
c2IvdXNicGQuaD4KKworI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CisjaW5jbHVkZSA8bGludXgv
ZGV2aWNlLmg+CisKK2VudW0gcGx1Z19vcmllbnRhdGlvbiB7CisJT1JJRU5UQVRJT05fTk9ORSwK
KwlPUklFTlRBVElPTl9DQzEsCisJT1JJRU5UQVRJT05fQ0MyLAorfTsKKworLyoqCisgKiBzdHJ1
Y3QgZHBfdXNicGQgLSBEaXNwbGF5UG9ydCBzdGF0dXMKKyAqCisgKiBAb3JpZW50YXRpb246IHBs
dWcgb3JpZW50YXRpb24gY29uZmlndXJhdGlvbgorICogQGxvd19wb3dfc3Q6IGxvdyBwb3dlciBz
dGF0ZQorICogQGFkYXB0b3JfZHBfZW46IGFkYXB0b3IgZnVuY3Rpb25hbGl0eSBlbmFibGVkCisg
KiBAbXVsdGlfZnVuYzogbXVsdGktZnVuY3Rpb24gcHJlZmVycmVkCisgKiBAdXNiX2NvbmZpZ19y
ZXE6IHJlcXVlc3QgdG8gc3dpdGNoIHRvIHVzYgorICogQGV4aXRfZHBfbW9kZTogcmVxdWVzdCBl
eGl0IGZyb20gZGlzcGxheXBvcnQgbW9kZQorICogQGhwZF9oaWdoOiBIb3QgUGx1ZyBEZXRlY3Qg
c2lnbmFsIGlzIGhpZ2guCisgKiBAaHBkX2lycTogQ2hhbmdlIGluIHRoZSBzdGF0dXMgc2luY2Ug
bGFzdCBtZXNzYWdlCisgKiBAYWx0X21vZGVfY2ZnX2RvbmU6IGJvb2wgdG8gc3BlY2lmeSBhbHQg
bW9kZSBzdGF0dXMKKyAqIEBkZWJ1Z19lbjogYm9vbCB0byBzcGVjaWZ5IGRlYnVnIG1vZGUKKyAq
IEBjb25uZWN0OiBzaW11bGF0ZSBkaXNjb25uZWN0IG9yIGNvbm5lY3QgZm9yIGRlYnVnIG1vZGUK
KyAqLworc3RydWN0IGRwX3VzYnBkIHsKKwllbnVtIHBsdWdfb3JpZW50YXRpb24gb3JpZW50YXRp
b247CisJYm9vbCBsb3dfcG93X3N0OworCWJvb2wgYWRhcHRvcl9kcF9lbjsKKwlib29sIG11bHRp
X2Z1bmM7CisJYm9vbCB1c2JfY29uZmlnX3JlcTsKKwlib29sIGV4aXRfZHBfbW9kZTsKKwlib29s
IGhwZF9oaWdoOworCWJvb2wgaHBkX2lycTsKKwlib29sIGFsdF9tb2RlX2NmZ19kb25lOworCWJv
b2wgZGVidWdfZW47CisKKwlpbnQgKCpjb25uZWN0KShzdHJ1Y3QgZHBfdXNicGQgKmRwX3VzYnBk
LCBib29sIGhwZCk7Cit9OworCisvKioKKyAqIHN0cnVjdCBkcF91c2JwZF9jYiAtIGNhbGxiYWNr
IGZ1bmN0aW9ucyBwcm92aWRlZCBieSB0aGUgY2xpZW50CisgKgorICogQGNvbmZpZ3VyZTogY2Fs
bGVkIGJ5IHVzYnBkIG1vZHVsZSB3aGVuIFBEIGNvbW11bmljYXRpb24gaGFzCisgKiBiZWVuIGNv
bXBsZXRlZCBhbmQgdGhlIHVzYiBwZXJpcGhlcmFsIGhhcyBiZWVuIGNvbmZpZ3VyZWQgb24KKyAq
IGRwIG1vZGUuCisgKiBAZGlzY29ubmVjdDogbm90aWZ5IHRoZSBjYWJsZSBkaXNjb25uZWN0IGlz
c3VlZCBieSB1c2IuCisgKiBAYXR0ZW50aW9uOiBub3RpZnkgYW55IGF0dGVudGlvbiBtZXNzYWdl
IGlzc3VlZCBieSB1c2IuCisgKi8KK3N0cnVjdCBkcF91c2JwZF9jYiB7CisJaW50ICgqY29uZmln
dXJlKShzdHJ1Y3QgZGV2aWNlICpkZXYpOworCWludCAoKmRpc2Nvbm5lY3QpKHN0cnVjdCBkZXZp
Y2UgKmRldik7CisJaW50ICgqYXR0ZW50aW9uKShzdHJ1Y3QgZGV2aWNlICpkZXYpOworfTsKKwor
LyoqCisgKiBkcF9leHRjb25fZ2V0KCkgLSBzZXR1cCB1c2JwZCBtb2R1bGUKKyAqCisgKiBAZGV2
OiBkZXZpY2UgaW5zdGFuY2Ugb2YgdGhlIGNhbGxlcgorICogQGNiOiBzdHJ1Y3QgY29udGFpbmlu
ZyBjYWxsYmFjayBmdW5jdGlvbiBwb2ludGVycy4KKyAqCisgKiBUaGlzIGZ1bmN0aW9uIGFsbG93
cyB0aGUgY2xpZW50IHRvIGluaXRpYWxpemUgdGhlIHVzYnBkCisgKiBtb2R1bGUuIFRoZSBtb2R1
bGUgd2lsbCBjb21tdW5pY2F0ZSB3aXRoIHVzYiBkcml2ZXIgYW5kCisgKiBoYW5kbGVzIHRoZSBw
b3dlciBkZWxpdmVyeSAoUEQpIGNvbW11bmljYXRpb24gd2l0aCB0aGUKKyAqIHNpbmsvdXNiIGRl
dmljZS4gVGhpcyBtb2R1bGUgd2lsbCBub3RpZnkgdGhlIGNsaWVudCB1c2luZworICogdGhlIGNh
bGxiYWNrIGZ1bmN0aW9ucyBhYm91dCB0aGUgY29ubmVjdGlvbiBhbmQgc3RhdHVzLgorICovCitz
dHJ1Y3QgZHBfdXNicGQgKmRwX2V4dGNvbl9nZXQoc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1Y3Qg
ZHBfdXNicGRfY2IgKmNiKTsKKwordm9pZCBkcF9leHRjb25fcHV0KHN0cnVjdCBkcF91c2JwZCAq
cGQpOworCitpbnQgZHBfZXh0Y29uX3JlZ2lzdGVyKHN0cnVjdCBkcF91c2JwZCAqZHBfdXNicGQp
Owordm9pZCBkcF9leHRjb25fdW5yZWdpc3RlcihzdHJ1Y3QgZHBfdXNicGQgKmRwX3VzYnBkKTsK
KworI2VuZGlmIC8qIF9EUF9FWFRDT05fSF8gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9tc20vZHAvZHBfbGluay5jIGIvZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9saW5rLmMKbmV3
IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uOWY1YjdiYzgKLS0tIC9kZXYvbnVsbAor
KysgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX2xpbmsuYwpAQCAtMCwwICsxLDExODUgQEAK
Ky8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkKKy8qCisgKiBDb3B5cmln
aHQgKGMpIDIwMTItMjAxOSwgVGhlIExpbnV4IEZvdW5kYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2
ZWQuCisgKi8KKworI2RlZmluZSBwcl9mbXQoZm10KQkiW2RybS1kcF0gJXM6ICIgZm10LCBfX2Z1
bmNfXworCisjaW5jbHVkZSAiZHBfbGluay5oIgorI2luY2x1ZGUgImRwX3BhbmVsLmgiCisKKyNk
ZWZpbmUgRFBfVEVTVF9SRVFVRVNUX01BU0sJCTB4N0YKKworZW51bSBhdWRpb19zYW1wbGVfcmF0
ZSB7CisJQVVESU9fU0FNUExFX1JBVEVfMzJfS0haCT0gMHgwMCwKKwlBVURJT19TQU1QTEVfUkFU
RV80NF8xX0tIWgk9IDB4MDEsCisJQVVESU9fU0FNUExFX1JBVEVfNDhfS0haCT0gMHgwMiwKKwlB
VURJT19TQU1QTEVfUkFURV84OF8yX0tIWgk9IDB4MDMsCisJQVVESU9fU0FNUExFX1JBVEVfOTZf
S0haCT0gMHgwNCwKKwlBVURJT19TQU1QTEVfUkFURV8xNzZfNF9LSFoJPSAweDA1LAorCUFVRElP
X1NBTVBMRV9SQVRFXzE5Ml9LSFoJPSAweDA2LAorfTsKKworZW51bSBhdWRpb19wYXR0ZXJuX3R5
cGUgeworCUFVRElPX1RFU1RfUEFUVEVSTl9PUEVSQVRPUl9ERUZJTkVECT0gMHgwMCwKKwlBVURJ
T19URVNUX1BBVFRFUk5fU0FXVE9PVEgJCT0gMHgwMSwKK307CisKK3N0cnVjdCBkcF9saW5rX3Jl
cXVlc3QgeworCXUzMiB0ZXN0X3JlcXVlc3RlZDsKKwl1MzIgdGVzdF9saW5rX3JhdGU7CisJdTMy
IHRlc3RfbGFuZV9jb3VudDsKK307CisKK3N0cnVjdCBkcF9saW5rX3ByaXZhdGUgeworCXUzMiBw
cmV2X3NpbmtfY291bnQ7CisJc3RydWN0IGRldmljZSAqZGV2OworCXN0cnVjdCBkcF9hdXggKmF1
eDsKKwlzdHJ1Y3QgZHBfbGluayBkcF9saW5rOworCisJc3RydWN0IGRwX2xpbmtfcmVxdWVzdCBy
ZXF1ZXN0OworCXN0cnVjdCBtdXRleCB0ZXN0X3Jlc3BvbnNlX211dGV4OworCXN0cnVjdCBtdXRl
eCBwc21fbXV0ZXg7CisJdTggbGlua19zdGF0dXNbRFBfTElOS19TVEFUVVNfU0laRV07Cit9Owor
CitzdGF0aWMgaW50IGRwX2xpbmtfZ2V0X3BlcmlvZChzdHJ1Y3QgZHBfbGlua19wcml2YXRlICps
aW5rLCBpbnQgY29uc3QgYWRkcikKK3sKKwlpbnQgcmV0ID0gMDsKKwl1OCBkYXRhOworCXUzMiBj
b25zdCBtYXhfYXVkaW9fcGVyaW9kID0gMHhBOworCisJLyogVEVTVF9BVURJT19QRVJJT0RfQ0hf
WFggKi8KKwlpZiAoZHJtX2RwX2RwY2RfcmVhZGIobGluay0+YXV4LT5kcm1fYXV4LCBhZGRyLCAm
ZGF0YSkgPCAwKSB7CisJCURSTV9FUlJPUigiZmFpbGVkIHRvIHJlYWQgdGVzdF9hdWRpb19wZXJp
b2QgKDB4JXgpXG4iLCBhZGRyKTsKKwkJcmV0ID0gLUVJTlZBTDsKKwkJZ290byBleGl0OworCX0K
KworCS8qIFBlcmlvZCAtIEJpdHMgMzowICovCisJZGF0YSA9IGRhdGEgJiAweEY7CisJaWYgKChp
bnQpZGF0YSA+IG1heF9hdWRpb19wZXJpb2QpIHsKKwkJRFJNX0VSUk9SKCJpbnZhbGlkIHRlc3Rf
YXVkaW9fcGVyaW9kX2NoXzEgPSAweCV4XG4iLCBkYXRhKTsKKwkJcmV0ID0gLUVJTlZBTDsKKwkJ
Z290byBleGl0OworCX0KKworCXJldCA9IGRhdGE7CitleGl0OgorCXJldHVybiByZXQ7Cit9CisK
K3N0YXRpYyBpbnQgZHBfbGlua19wYXJzZV9hdWRpb19jaGFubmVsX3BlcmlvZChzdHJ1Y3QgZHBf
bGlua19wcml2YXRlICpsaW5rKQoreworCWludCByZXQgPSAwOworCXN0cnVjdCBkcF9saW5rX3Rl
c3RfYXVkaW8gKnJlcSA9ICZsaW5rLT5kcF9saW5rLnRlc3RfYXVkaW87CisKKwlyZXQgPSBkcF9s
aW5rX2dldF9wZXJpb2QobGluaywgRFBfVEVTVF9BVURJT19QRVJJT0RfQ0gxKTsKKwlpZiAocmV0
ID09IC1FSU5WQUwpCisJCWdvdG8gZXhpdDsKKworCXJlcS0+dGVzdF9hdWRpb19wZXJpb2RfY2hf
MSA9IHJldDsKKwlEUk1fREVCVUdfRFAoInRlc3RfYXVkaW9fcGVyaW9kX2NoXzEgPSAweCV4XG4i
LCByZXQpOworCisJcmV0ID0gZHBfbGlua19nZXRfcGVyaW9kKGxpbmssIERQX1RFU1RfQVVESU9f
UEVSSU9EX0NIMik7CisJaWYgKHJldCA9PSAtRUlOVkFMKQorCQlnb3RvIGV4aXQ7CisKKwlyZXEt
PnRlc3RfYXVkaW9fcGVyaW9kX2NoXzIgPSByZXQ7CisJRFJNX0RFQlVHX0RQKCJ0ZXN0X2F1ZGlv
X3BlcmlvZF9jaF8yID0gMHgleFxuIiwgcmV0KTsKKworCS8qIFRFU1RfQVVESU9fUEVSSU9EX0NI
XzMgKEJ5dGUgMHgyNzUpICovCisJcmV0ID0gZHBfbGlua19nZXRfcGVyaW9kKGxpbmssIERQX1RF
U1RfQVVESU9fUEVSSU9EX0NIMyk7CisJaWYgKHJldCA9PSAtRUlOVkFMKQorCQlnb3RvIGV4aXQ7
CisKKwlyZXEtPnRlc3RfYXVkaW9fcGVyaW9kX2NoXzMgPSByZXQ7CisJRFJNX0RFQlVHX0RQKCJ0
ZXN0X2F1ZGlvX3BlcmlvZF9jaF8zID0gMHgleFxuIiwgcmV0KTsKKworCXJldCA9IGRwX2xpbmtf
Z2V0X3BlcmlvZChsaW5rLCBEUF9URVNUX0FVRElPX1BFUklPRF9DSDQpOworCWlmIChyZXQgPT0g
LUVJTlZBTCkKKwkJZ290byBleGl0OworCisJcmVxLT50ZXN0X2F1ZGlvX3BlcmlvZF9jaF80ID0g
cmV0OworCURSTV9ERUJVR19EUCgidGVzdF9hdWRpb19wZXJpb2RfY2hfNCA9IDB4JXhcbiIsIHJl
dCk7CisKKwlyZXQgPSBkcF9saW5rX2dldF9wZXJpb2QobGluaywgRFBfVEVTVF9BVURJT19QRVJJ
T0RfQ0g1KTsKKwlpZiAocmV0ID09IC1FSU5WQUwpCisJCWdvdG8gZXhpdDsKKworCXJlcS0+dGVz
dF9hdWRpb19wZXJpb2RfY2hfNSA9IHJldDsKKwlEUk1fREVCVUdfRFAoInRlc3RfYXVkaW9fcGVy
aW9kX2NoXzUgPSAweCV4XG4iLCByZXQpOworCisJcmV0ID0gZHBfbGlua19nZXRfcGVyaW9kKGxp
bmssIERQX1RFU1RfQVVESU9fUEVSSU9EX0NINik7CisJaWYgKHJldCA9PSAtRUlOVkFMKQorCQln
b3RvIGV4aXQ7CisKKwlyZXEtPnRlc3RfYXVkaW9fcGVyaW9kX2NoXzYgPSByZXQ7CisJRFJNX0RF
QlVHX0RQKCJ0ZXN0X2F1ZGlvX3BlcmlvZF9jaF82ID0gMHgleFxuIiwgcmV0KTsKKworCXJldCA9
IGRwX2xpbmtfZ2V0X3BlcmlvZChsaW5rLCBEUF9URVNUX0FVRElPX1BFUklPRF9DSDcpOworCWlm
IChyZXQgPT0gLUVJTlZBTCkKKwkJZ290byBleGl0OworCisJcmVxLT50ZXN0X2F1ZGlvX3Blcmlv
ZF9jaF83ID0gcmV0OworCURSTV9ERUJVR19EUCgidGVzdF9hdWRpb19wZXJpb2RfY2hfNyA9IDB4
JXhcbiIsIHJldCk7CisKKwlyZXQgPSBkcF9saW5rX2dldF9wZXJpb2QobGluaywgRFBfVEVTVF9B
VURJT19QRVJJT0RfQ0g4KTsKKwlpZiAocmV0ID09IC1FSU5WQUwpCisJCWdvdG8gZXhpdDsKKwor
CXJlcS0+dGVzdF9hdWRpb19wZXJpb2RfY2hfOCA9IHJldDsKKwlEUk1fREVCVUdfRFAoInRlc3Rf
YXVkaW9fcGVyaW9kX2NoXzggPSAweCV4XG4iLCByZXQpOworZXhpdDoKKwlyZXR1cm4gcmV0Owor
fQorCitzdGF0aWMgaW50IGRwX2xpbmtfcGFyc2VfYXVkaW9fcGF0dGVybl90eXBlKHN0cnVjdCBk
cF9saW5rX3ByaXZhdGUgKmxpbmspCit7CisJaW50IHJldCA9IDA7CisJdTggZGF0YTsKKwlzc2l6
ZV90IHJsZW47CisJaW50IGNvbnN0IG1heF9hdWRpb19wYXR0ZXJuX3R5cGUgPSAweDE7CisKKwly
bGVuID0gZHJtX2RwX2RwY2RfcmVhZGIobGluay0+YXV4LT5kcm1fYXV4LAorCQkJCURQX1RFU1Rf
QVVESU9fUEFUVEVSTl9UWVBFLCAmZGF0YSk7CisJaWYgKHJsZW4gPCAwKSB7CisJCURSTV9FUlJP
UigiZmFpbGVkIHRvIHJlYWQgbGluayBhdWRpbyBtb2RlLiBybGVuPSV6ZFxuIiwgcmxlbik7CisJ
CXJldHVybiBybGVuOworCX0KKworCS8qIEF1ZGlvIFBhdHRlcm4gVHlwZSAtIEJpdHMgNzowICov
CisJaWYgKChpbnQpZGF0YSA+IG1heF9hdWRpb19wYXR0ZXJuX3R5cGUpIHsKKwkJRFJNX0VSUk9S
KCJpbnZhbGlkIGF1ZGlvIHBhdHRlcm4gdHlwZSA9IDB4JXhcbiIsIGRhdGEpOworCQlyZXQgPSAt
RUlOVkFMOworCQlnb3RvIGV4aXQ7CisJfQorCisJbGluay0+ZHBfbGluay50ZXN0X2F1ZGlvLnRl
c3RfYXVkaW9fcGF0dGVybl90eXBlID0gZGF0YTsKKwlEUk1fREVCVUdfRFAoImF1ZGlvIHBhdHRl
cm4gdHlwZSA9IDB4JXhcbiIsIGRhdGEpOworZXhpdDoKKwlyZXR1cm4gcmV0OworfQorCitzdGF0
aWMgaW50IGRwX2xpbmtfcGFyc2VfYXVkaW9fbW9kZShzdHJ1Y3QgZHBfbGlua19wcml2YXRlICps
aW5rKQoreworCWludCByZXQgPSAwOworCXU4IGRhdGE7CisJc3NpemVfdCBybGVuOworCWludCBj
b25zdCBtYXhfYXVkaW9fc2FtcGxpbmdfcmF0ZSA9IDB4NjsKKwlpbnQgY29uc3QgbWF4X2F1ZGlv
X2NoYW5uZWxfY291bnQgPSAweDg7CisJaW50IHNhbXBsaW5nX3JhdGUgPSAweDA7CisJaW50IGNo
YW5uZWxfY291bnQgPSAweDA7CisKKwlybGVuID0gZHJtX2RwX2RwY2RfcmVhZGIobGluay0+YXV4
LT5kcm1fYXV4LCBEUF9URVNUX0FVRElPX01PREUsICZkYXRhKTsKKwlpZiAocmxlbiA8IDApIHsK
KwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gcmVhZCBsaW5rIGF1ZGlvIG1vZGUuIHJsZW49JXpkXG4i
LCBybGVuKTsKKwkJcmV0dXJuIHJsZW47CisJfQorCisJLyogU2FtcGxpbmcgUmF0ZSAtIEJpdHMg
MzowICovCisJc2FtcGxpbmdfcmF0ZSA9IGRhdGEgJiAweEY7CisJaWYgKHNhbXBsaW5nX3JhdGUg
PiBtYXhfYXVkaW9fc2FtcGxpbmdfcmF0ZSkgeworCQlEUk1fRVJST1IoInNhbXBsaW5nIHJhdGUg
KDB4JXgpIGdyZWF0ZXIgdGhhbiBtYXggKDB4JXgpXG4iLAorCQkJCXNhbXBsaW5nX3JhdGUsIG1h
eF9hdWRpb19zYW1wbGluZ19yYXRlKTsKKwkJcmV0ID0gLUVJTlZBTDsKKwkJZ290byBleGl0Owor
CX0KKworCS8qIENoYW5uZWwgQ291bnQgLSBCaXRzIDc6NCAqLworCWNoYW5uZWxfY291bnQgPSAo
KGRhdGEgJiAweEYwKSA+PiA0KSArIDE7CisJaWYgKGNoYW5uZWxfY291bnQgPiBtYXhfYXVkaW9f
Y2hhbm5lbF9jb3VudCkgeworCQlEUk1fRVJST1IoImNoYW5uZWxfY291bnQgKDB4JXgpIGdyZWF0
ZXIgdGhhbiBtYXggKDB4JXgpXG4iLAorCQkJCWNoYW5uZWxfY291bnQsIG1heF9hdWRpb19jaGFu
bmVsX2NvdW50KTsKKwkJcmV0ID0gLUVJTlZBTDsKKwkJZ290byBleGl0OworCX0KKworCWxpbmst
PmRwX2xpbmsudGVzdF9hdWRpby50ZXN0X2F1ZGlvX3NhbXBsaW5nX3JhdGUgPSBzYW1wbGluZ19y
YXRlOworCWxpbmstPmRwX2xpbmsudGVzdF9hdWRpby50ZXN0X2F1ZGlvX2NoYW5uZWxfY291bnQg
PSBjaGFubmVsX2NvdW50OworCURSTV9ERUJVR19EUCgic2FtcGxpbmdfcmF0ZSA9IDB4JXgsIGNo
YW5uZWxfY291bnQgPSAweCV4XG4iLAorCQkJCQlzYW1wbGluZ19yYXRlLCBjaGFubmVsX2NvdW50
KTsKK2V4aXQ6CisJcmV0dXJuIHJldDsKK30KKworLyoqCisgKiBkcF9wYXJzZV9hdWRpb19wYXR0
ZXJuX3BhcmFtcygpIC0gcGFyc2VzIGF1ZGlvIHBhdHRlcm4gcGFyYW1ldGVycyBmcm9tIERQQ0QK
KyAqIEBsaW5rOiBEaXNwbGF5IFBvcnQgRHJpdmVyIGRhdGEKKyAqCisgKiBSZXR1cm5zIDAgaWYg
aXQgc3VjY2Vzc2Z1bGx5IHBhcnNlcyB0aGUgYXVkaW8gbGluayBwYXR0ZXJuIHBhcmFtZXRlcnMu
CisgKi8KK3N0YXRpYyBpbnQgZHBfbGlua19wYXJzZV9hdWRpb19wYXR0ZXJuX3BhcmFtcyhzdHJ1
Y3QgZHBfbGlua19wcml2YXRlICpsaW5rKQoreworCWludCByZXQgPSAwOworCisJcmV0ID0gZHBf
bGlua19wYXJzZV9hdWRpb19tb2RlKGxpbmspOworCWlmIChyZXQpCisJCWdvdG8gZXhpdDsKKwor
CXJldCA9IGRwX2xpbmtfcGFyc2VfYXVkaW9fcGF0dGVybl90eXBlKGxpbmspOworCWlmIChyZXQp
CisJCWdvdG8gZXhpdDsKKworCXJldCA9IGRwX2xpbmtfcGFyc2VfYXVkaW9fY2hhbm5lbF9wZXJp
b2QobGluayk7CisKK2V4aXQ6CisJcmV0dXJuIHJldDsKK30KKworLyoqCisgKiBkcF9saW5rX2lz
X3ZpZGVvX3BhdHRlcm5fdmFsaWQoKSAtIHZhbGlkYXRlcyB0aGUgdmlkZW8gcGF0dGVybgorICog
QHBhdHRlcm46IHZpZGVvIHBhdHRlcm4gcmVxdWVzdGVkIGJ5IHRoZSBzaW5rCisgKgorICogUmV0
dXJucyB0cnVlIGlmIHRoZSByZXF1ZXN0ZWQgdmlkZW8gcGF0dGVybiBpcyBzdXBwb3J0ZWQuCisg
Ki8KK3N0YXRpYyBib29sIGRwX2xpbmtfaXNfdmlkZW9fcGF0dGVybl92YWxpZCh1MzIgcGF0dGVy
bikKK3sKKwlzd2l0Y2ggKHBhdHRlcm4pIHsKKwljYXNlIERQX05PX1RFU1RfUEFUVEVSTjoKKwlj
YXNlIERQX0NPTE9SX1JBTVA6CisJY2FzZSBEUF9CTEFDS19BTkRfV0hJVEVfVkVSVElDQUxfTElO
RVM6CisJY2FzZSBEUF9DT0xPUl9TUVVBUkU6CisJCXJldHVybiB0cnVlOworCWRlZmF1bHQ6CisJ
CXJldHVybiBmYWxzZTsKKwl9Cit9CisKKy8qKgorICogZHBfbGlua19pc19iaXRfZGVwdGhfdmFs
aWQoKSAtIHZhbGlkYXRlcyB0aGUgYml0IGRlcHRoIHJlcXVlc3RlZAorICogQGJpdF9kZXB0aDog
Yml0IGRlcHRoIHJlcXVlc3RlZCBieSB0aGUgc2luaworICoKKyAqIFJldHVybnMgdHJ1ZSBpZiB0
aGUgcmVxdWVzdGVkIGJpdCBkZXB0aCBpcyBzdXBwb3J0ZWQuCisgKi8KK3N0YXRpYyBib29sIGRw
X2xpbmtfaXNfYml0X2RlcHRoX3ZhbGlkKHUzMiB0YmQpCit7CisJLyogRFBfVEVTVF9WSURFT19Q
QVRURVJOX05PTkUgaXMgdHJlYXRlZCBhcyBpbnZhbGlkICovCisJc3dpdGNoICh0YmQpIHsKKwlj
YXNlIERQX1RFU1RfQklUX0RFUFRIXzY6CisJY2FzZSBEUF9URVNUX0JJVF9ERVBUSF84OgorCWNh
c2UgRFBfVEVTVF9CSVRfREVQVEhfMTA6CisJCXJldHVybiB0cnVlOworCWRlZmF1bHQ6CisJCXJl
dHVybiBmYWxzZTsKKwl9Cit9CisKK3N0YXRpYyBpbnQgZHBfbGlua19wYXJzZV90aW1pbmdfcGFy
YW1zMShzdHJ1Y3QgZHBfbGlua19wcml2YXRlICpsaW5rLAorCQkJCQlpbnQgYWRkciwgaW50IGxl
biwgdTMyICp2YWwpCit7CisJdTggYnBbMl07CisJaW50IHJsZW47CisKKwlpZiAobGVuICE9IDIp
CisJCXJldHVybiAtRUlOVkFMOworCisJLyogUmVhZCB0aGUgcmVxdWVzdGVkIHZpZGVvIGxpbmsg
cGF0dGVybiAoQnl0ZSAweDIyMSkuICovCisJcmxlbiA9IGRybV9kcF9kcGNkX3JlYWQobGluay0+
YXV4LT5kcm1fYXV4LCBhZGRyLCBicCwgbGVuKTsKKwlpZiAocmxlbiA8IGxlbikgeworCQlEUk1f
RVJST1IoImZhaWxlZCB0byByZWFkIDB4JXhcbiIsIGFkZHIpOworCQlyZXR1cm4gLUVJTlZBTDsK
Kwl9CisKKwkqdmFsID0gYnBbMV0gfCAoYnBbMF0gPDwgOCk7CisKKwlyZXR1cm4gMDsKK30KKwor
c3RhdGljIGludCBkcF9saW5rX3BhcnNlX3RpbWluZ19wYXJhbXMyKHN0cnVjdCBkcF9saW5rX3By
aXZhdGUgKmxpbmssCisJCQkJCWludCBhZGRyLCBpbnQgbGVuLAorCQkJCQl1MzIgKnZhbDEsIHUz
MiAqdmFsMikKK3sKKwl1OCBicFsyXTsKKwlpbnQgcmxlbjsKKworCWlmIChsZW4gIT0gMikKKwkJ
cmV0dXJuIC1FSU5WQUw7CisKKwkvKiBSZWFkIHRoZSByZXF1ZXN0ZWQgdmlkZW8gbGluayBwYXR0
ZXJuIChCeXRlIDB4MjIxKS4gKi8KKwlybGVuID0gZHJtX2RwX2RwY2RfcmVhZChsaW5rLT5hdXgt
PmRybV9hdXgsIGFkZHIsIGJwLCBsZW4pOworCWlmIChybGVuIDwgbGVuKSB7CisJCURSTV9FUlJP
UigiZmFpbGVkIHRvIHJlYWQgMHgleFxuIiwgYWRkcik7CisJCXJldHVybiAtRUlOVkFMOworCX0K
KworCSp2YWwxID0gKGJwWzBdICYgQklUKDcpKSA+PiA3OworCSp2YWwyID0gYnBbMV0gfCAoKGJw
WzBdICYgMHg3RikgPDwgOCk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBkcF9saW5r
X3BhcnNlX3RpbWluZ19wYXJhbXMzKHN0cnVjdCBkcF9saW5rX3ByaXZhdGUgKmxpbmssCisJCQkJ
CWludCBhZGRyLCB1MzIgKnZhbCkKK3sKKwl1OCBicDsKKwl1MzIgbGVuID0gMTsKKwlpbnQgcmxl
bjsKKworCXJsZW4gPSBkcm1fZHBfZHBjZF9yZWFkKGxpbmstPmF1eC0+ZHJtX2F1eCwgYWRkciwg
JmJwLCBsZW4pOworCWlmIChybGVuIDwgMSkgeworCQlEUk1fRVJST1IoImZhaWxlZCB0byByZWFk
IDB4JXhcbiIsIGFkZHIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisJKnZhbCA9IGJwOworCisJ
cmV0dXJuIDA7Cit9CisKKy8qKgorICogZHBfcGFyc2VfdmlkZW9fcGF0dGVybl9wYXJhbXMoKSAt
IHBhcnNlcyB2aWRlbyBwYXR0ZXJuIHBhcmFtZXRlcnMgZnJvbSBEUENECisgKiBAbGluazogRGlz
cGxheSBQb3J0IERyaXZlciBkYXRhCisgKgorICogUmV0dXJucyAwIGlmIGl0IHN1Y2Nlc3NmdWxs
eSBwYXJzZXMgdGhlIHZpZGVvIGxpbmsgcGF0dGVybiBhbmQgdGhlIGxpbmsKKyAqIGJpdCBkZXB0
aCByZXF1ZXN0ZWQgYnkgdGhlIHNpbmsgYW5kLCBhbmQgaWYgdGhlIHZhbHVlcyBwYXJzZWQgYXJl
IHZhbGlkLgorICovCitzdGF0aWMgaW50IGRwX2xpbmtfcGFyc2VfdmlkZW9fcGF0dGVybl9wYXJh
bXMoc3RydWN0IGRwX2xpbmtfcHJpdmF0ZSAqbGluaykKK3sKKwlpbnQgcmV0ID0gMDsKKwlzc2l6
ZV90IHJsZW47CisJdTggYnA7CisKKwlybGVuID0gZHJtX2RwX2RwY2RfcmVhZGIobGluay0+YXV4
LT5kcm1fYXV4LCBEUF9URVNUX1BBVFRFUk4sICZicCk7CisJaWYgKHJsZW4gPCAwKSB7CisJCURS
TV9FUlJPUigiZmFpbGVkIHRvIHJlYWQgbGluayB2aWRlbyBwYXR0ZXJuLiBybGVuPSV6ZFxuIiwg
cmxlbik7CisJCXJldHVybiBybGVuOworCX0KKworCWlmICghZHBfbGlua19pc192aWRlb19wYXR0
ZXJuX3ZhbGlkKGJwKSkgeworCQlEUk1fRVJST1IoImludmFsaWQgbGluayB2aWRlbyBwYXR0ZXJu
ID0gMHgleFxuIiwgYnApOworCQlyZXQgPSAtRUlOVkFMOworCQlyZXR1cm4gcmV0OworCX0KKwor
CWxpbmstPmRwX2xpbmsudGVzdF92aWRlby50ZXN0X3ZpZGVvX3BhdHRlcm4gPSBicDsKKworCS8q
IFJlYWQgdGhlIHJlcXVlc3RlZCBjb2xvciBiaXQgZGVwdGggYW5kIGR5bmFtaWMgcmFuZ2UgKEJ5
dGUgMHgyMzIpICovCisJcmxlbiA9IGRybV9kcF9kcGNkX3JlYWRiKGxpbmstPmF1eC0+ZHJtX2F1
eCwgRFBfVEVTVF9NSVNDMCwgJmJwKTsKKwlpZiAocmxlbiA8IDApIHsKKwkJRFJNX0VSUk9SKCJm
YWlsZWQgdG8gcmVhZCBsaW5rIGJpdCBkZXB0aC4gcmxlbj0lemRcbiIsIHJsZW4pOworCQlyZXR1
cm4gcmxlbjsKKwl9CisKKwkvKiBEeW5hbWljIFJhbmdlICovCisJbGluay0+ZHBfbGluay50ZXN0
X3ZpZGVvLnRlc3RfZHluX3JhbmdlID0gKGJwICYgRFBfVEVTVF9EWU5BTUlDX1JBTkdFX0NFQSk7
CisKKwkvKiBDb2xvciBiaXQgZGVwdGggKi8KKwlicCAmPSBEUF9URVNUX0JJVF9ERVBUSF9NQVNL
OworCWlmICghZHBfbGlua19pc19iaXRfZGVwdGhfdmFsaWQoYnApKSB7CisJCURSTV9FUlJPUigi
aW52YWxpZCBsaW5rIGJpdCBkZXB0aCA9IDB4JXhcbiIsIGJwKTsKKwkJcmV0ID0gLUVJTlZBTDsK
KwkJcmV0dXJuIHJldDsKKwl9CisKKwlsaW5rLT5kcF9saW5rLnRlc3RfdmlkZW8udGVzdF9iaXRf
ZGVwdGggPSBicDsKKworCS8qIHJlc29sdXRpb24gdGltaW5nIHBhcmFtcyAqLworCXJldCA9IGRw
X2xpbmtfcGFyc2VfdGltaW5nX3BhcmFtczEobGluaywgRFBfVEVTVF9IX1RPVEFMX0hJLCAyLAor
CQkJJmxpbmstPmRwX2xpbmsudGVzdF92aWRlby50ZXN0X2hfdG90YWwpOworCWlmIChyZXQpIHsK
KwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gcGFyc2UgdGVzdF9oX3RvdGFsIChEUF9URVNUX0hfVE9U
QUxfSEkpXG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXQgPSBkcF9saW5rX3BhcnNlX3Rp
bWluZ19wYXJhbXMxKGxpbmssIERQX1RFU1RfVl9UT1RBTF9ISSwgMiwKKwkJCSZsaW5rLT5kcF9s
aW5rLnRlc3RfdmlkZW8udGVzdF92X3RvdGFsKTsKKwlpZiAocmV0KSB7CisJCURSTV9FUlJPUigi
ZmFpbGVkIHRvIHBhcnNlIHRlc3Rfdl90b3RhbCAoRFBfVEVTVF9WX1RPVEFMX0hJKVxuIik7CisJ
CXJldHVybiByZXQ7CisJfQorCisJcmV0ID0gZHBfbGlua19wYXJzZV90aW1pbmdfcGFyYW1zMShs
aW5rLCBEUF9URVNUX0hfU1RBUlRfSEksIDIsCisJCQkmbGluay0+ZHBfbGluay50ZXN0X3ZpZGVv
LnRlc3RfaF9zdGFydCk7CisJaWYgKHJldCkgeworCQlEUk1fRVJST1IoImZhaWxlZCB0byBwYXJz
ZSB0ZXN0X2hfc3RhcnQgKERQX1RFU1RfSF9TVEFSVF9ISSlcbiIpOworCQlyZXR1cm4gcmV0Owor
CX0KKworCXJldCA9IGRwX2xpbmtfcGFyc2VfdGltaW5nX3BhcmFtczEobGluaywgRFBfVEVTVF9W
X1NUQVJUX0hJLCAyLAorCQkJJmxpbmstPmRwX2xpbmsudGVzdF92aWRlby50ZXN0X3Zfc3RhcnQp
OworCWlmIChyZXQpIHsKKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gcGFyc2UgdGVzdF92X3N0YXJ0
IChEUF9URVNUX1ZfU1RBUlRfSEkpXG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXQgPSBk
cF9saW5rX3BhcnNlX3RpbWluZ19wYXJhbXMyKGxpbmssIERQX1RFU1RfSFNZTkNfSEksIDIsCisJ
CQkmbGluay0+ZHBfbGluay50ZXN0X3ZpZGVvLnRlc3RfaHN5bmNfcG9sLAorCQkJJmxpbmstPmRw
X2xpbmsudGVzdF92aWRlby50ZXN0X2hzeW5jX3dpZHRoKTsKKwlpZiAocmV0KSB7CisJCURSTV9F
UlJPUigiZmFpbGVkIHRvIHBhcnNlIChEUF9URVNUX0hTWU5DX0hJKVxuIik7CisJCXJldHVybiBy
ZXQ7CisJfQorCisJcmV0ID0gZHBfbGlua19wYXJzZV90aW1pbmdfcGFyYW1zMihsaW5rLCBEUF9U
RVNUX1ZTWU5DX0hJLCAyLAorCQkJJmxpbmstPmRwX2xpbmsudGVzdF92aWRlby50ZXN0X3ZzeW5j
X3BvbCwKKwkJCSZsaW5rLT5kcF9saW5rLnRlc3RfdmlkZW8udGVzdF92c3luY193aWR0aCk7CisJ
aWYgKHJldCkgeworCQlEUk1fRVJST1IoImZhaWxlZCB0byBwYXJzZSAoRFBfVEVTVF9WU1lOQ19I
SSlcbiIpOworCQlyZXR1cm4gcmV0OworCX0KKworCXJldCA9IGRwX2xpbmtfcGFyc2VfdGltaW5n
X3BhcmFtczEobGluaywgRFBfVEVTVF9IX1dJRFRIX0hJLCAyLAorCQkJJmxpbmstPmRwX2xpbmsu
dGVzdF92aWRlby50ZXN0X2hfd2lkdGgpOworCWlmIChyZXQpIHsKKwkJRFJNX0VSUk9SKCJmYWls
ZWQgdG8gcGFyc2UgdGVzdF9oX3dpZHRoIChEUF9URVNUX0hfV0lEVEhfSEkpXG4iKTsKKwkJcmV0
dXJuIHJldDsKKwl9CisKKwlyZXQgPSBkcF9saW5rX3BhcnNlX3RpbWluZ19wYXJhbXMxKGxpbmss
IERQX1RFU1RfVl9IRUlHSFRfSEksIDIsCisJCQkmbGluay0+ZHBfbGluay50ZXN0X3ZpZGVvLnRl
c3Rfdl9oZWlnaHQpOworCWlmIChyZXQpIHsKKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gcGFyc2Ug
dGVzdF92X2hlaWdodCAoRFBfVEVTVF9WX0hFSUdIVF9ISSlcbiIpOworCQlyZXR1cm4gcmV0Owor
CX0KKworCXJldCA9IGRwX2xpbmtfcGFyc2VfdGltaW5nX3BhcmFtczMobGluaywgRFBfVEVTVF9N
SVNDMSwKKwkJJmxpbmstPmRwX2xpbmsudGVzdF92aWRlby50ZXN0X3JyX2QpOworCWxpbmstPmRw
X2xpbmsudGVzdF92aWRlby50ZXN0X3JyX2QgJj0gRFBfVEVTVF9SRUZSRVNIX0RFTk9NSU5BVE9S
OworCWlmIChyZXQpIHsKKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gcGFyc2UgdGVzdF9ycl9kIChE
UF9URVNUX01JU0MxKVxuIik7CisJCXJldHVybiByZXQ7CisJfQorCisJcmV0ID0gZHBfbGlua19w
YXJzZV90aW1pbmdfcGFyYW1zMyhsaW5rLCBEUF9URVNUX1JFRlJFU0hfUkFURV9OVU1FUkFUT1Is
CisJCSZsaW5rLT5kcF9saW5rLnRlc3RfdmlkZW8udGVzdF9ycl9uKTsKKwlpZiAocmV0KSB7CisJ
CURSTV9FUlJPUigiZmFpbGVkIHRvIHBhcnNlIHRlc3RfcnJfbiAoRFBfVEVTVF9SRUZSRVNIX1JB
VEVfTlVNRVJBVE9SKVxuIik7CisJCXJldHVybiByZXQ7CisJfQorCisJRFJNX0RFQlVHX0RQKCJs
aW5rIHZpZGVvIHBhdHRlcm4gPSAweCV4XG4iIFwKKwkJImxpbmsgZHluYW1pYyByYW5nZSA9IDB4
JXhcbiIgXAorCQkibGluayBiaXQgZGVwdGggPSAweCV4XG4iIFwKKwkJIlRFU1RfSF9UT1RBTCA9
ICVkLCBURVNUX1ZfVE9UQUwgPSAlZFxuIiBcCisJCSJURVNUX0hfU1RBUlQgPSAlZCwgVEVTVF9W
X1NUQVJUID0gJWRcbiIgXAorCQkiVEVTVF9IU1lOQ19QT0wgPSAlZFxuIiBcCisJCSJURVNUX0hT
WU5DX1dJRFRIID0gJWRcbiIgXAorCQkiVEVTVF9WU1lOQ19QT0wgPSAlZFxuIiBcCisJCSJURVNU
X1ZTWU5DX1dJRFRIID0gJWRcbiIgXAorCQkiVEVTVF9IX1dJRFRIID0gJWRcbiIgXAorCQkiVEVT
VF9WX0hFSUdIVCA9ICVkXG4iIFwKKwkJIlRFU1RfUkVGUkVTSF9ERU5PTUlOQVRPUiA9ICVkXG4i
IFwKKwkJICJURVNUX1JFRlJFU0hfTlVNRVJBVE9SID0gJWRcbiIsCisJCWxpbmstPmRwX2xpbmsu
dGVzdF92aWRlby50ZXN0X3ZpZGVvX3BhdHRlcm4sCisJCWxpbmstPmRwX2xpbmsudGVzdF92aWRl
by50ZXN0X2R5bl9yYW5nZSwKKwkJbGluay0+ZHBfbGluay50ZXN0X3ZpZGVvLnRlc3RfYml0X2Rl
cHRoLAorCQlsaW5rLT5kcF9saW5rLnRlc3RfdmlkZW8udGVzdF9oX3RvdGFsLAorCQlsaW5rLT5k
cF9saW5rLnRlc3RfdmlkZW8udGVzdF92X3RvdGFsLAorCQlsaW5rLT5kcF9saW5rLnRlc3Rfdmlk
ZW8udGVzdF9oX3N0YXJ0LAorCQlsaW5rLT5kcF9saW5rLnRlc3RfdmlkZW8udGVzdF92X3N0YXJ0
LAorCQlsaW5rLT5kcF9saW5rLnRlc3RfdmlkZW8udGVzdF9oc3luY19wb2wsCisJCWxpbmstPmRw
X2xpbmsudGVzdF92aWRlby50ZXN0X2hzeW5jX3dpZHRoLAorCQlsaW5rLT5kcF9saW5rLnRlc3Rf
dmlkZW8udGVzdF92c3luY19wb2wsCisJCWxpbmstPmRwX2xpbmsudGVzdF92aWRlby50ZXN0X3Zz
eW5jX3dpZHRoLAorCQlsaW5rLT5kcF9saW5rLnRlc3RfdmlkZW8udGVzdF9oX3dpZHRoLAorCQls
aW5rLT5kcF9saW5rLnRlc3RfdmlkZW8udGVzdF92X2hlaWdodCwKKwkJbGluay0+ZHBfbGluay50
ZXN0X3ZpZGVvLnRlc3RfcnJfZCwKKwkJbGluay0+ZHBfbGluay50ZXN0X3ZpZGVvLnRlc3RfcnJf
bik7CisKKwlyZXR1cm4gcmV0OworfQorCisvKioKKyAqIGRwX2xpbmtfcGFyc2VfbGlua190cmFp
bmluZ19wYXJhbXMoKSAtIHBhcnNlcyBsaW5rIHRyYWluaW5nIHBhcmFtZXRlcnMgZnJvbQorICog
RFBDRAorICogQGxpbms6IERpc3BsYXkgUG9ydCBEcml2ZXIgZGF0YQorICoKKyAqIFJldHVybnMg
MCBpZiBpdCBzdWNjZXNzZnVsbHkgcGFyc2VzIHRoZSBsaW5rIHJhdGUgKEJ5dGUgMHgyMTkpIGFu
ZCBsYW5lCisgKiBjb3VudCAoQnl0ZSAweDIyMCksIGFuZCBpZiB0aGVzZSB2YWx1ZXMgcGFyc2Ug
YXJlIHZhbGlkLgorICovCitzdGF0aWMgaW50IGRwX2xpbmtfcGFyc2VfbGlua190cmFpbmluZ19w
YXJhbXMoc3RydWN0IGRwX2xpbmtfcHJpdmF0ZSAqbGluaykKK3sKKwl1OCBicDsKKwlzc2l6ZV90
IHJsZW47CisKKwlybGVuID0gZHJtX2RwX2RwY2RfcmVhZGIobGluay0+YXV4LT5kcm1fYXV4LCBE
UF9URVNUX0xJTktfUkFURSwJJmJwKTsKKwlpZiAocmxlbiA8IDApIHsKKwkJRFJNX0VSUk9SKCJm
YWlsZWQgdG8gcmVhZCBsaW5rIHJhdGUuIHJsZW49JXpkXG4iLCBybGVuKTsKKwkJcmV0dXJuIHJs
ZW47CisJfQorCisJaWYgKCFpc19saW5rX3JhdGVfdmFsaWQoYnApKSB7CisJCURSTV9FUlJPUigi
aW52YWxpZCBsaW5rIHJhdGUgPSAweCV4XG4iLCBicCk7CisJCXJldHVybiAtRUlOVkFMOworCX0K
KworCWxpbmstPnJlcXVlc3QudGVzdF9saW5rX3JhdGUgPSBicDsKKwlEUk1fREVCVUdfRFAoImxp
bmsgcmF0ZSA9IDB4JXhcbiIsIGxpbmstPnJlcXVlc3QudGVzdF9saW5rX3JhdGUpOworCisJcmxl
biA9IGRybV9kcF9kcGNkX3JlYWRiKGxpbmstPmF1eC0+ZHJtX2F1eCwgRFBfVEVTVF9MQU5FX0NP
VU5ULCAmYnApOworCWlmIChybGVuIDwgMCkgeworCQlEUk1fRVJST1IoImZhaWxlZCB0byByZWFk
IGxhbmUgY291bnQuIHJsZW49JXpkXG4iLCBybGVuKTsKKwkJcmV0dXJuIHJsZW47CisJfQorCWJw
ICY9IERQX01BWF9MQU5FX0NPVU5UX01BU0s7CisKKwlpZiAoIWlzX2xhbmVfY291bnRfdmFsaWQo
YnApKSB7CisJCURSTV9FUlJPUigiaW52YWxpZCBsYW5lIGNvdW50ID0gMHgleFxuIiwgYnApOwor
CQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlsaW5rLT5yZXF1ZXN0LnRlc3RfbGFuZV9jb3VudCA9
IGJwOworCURSTV9ERUJVR19EUCgibGFuZSBjb3VudCA9IDB4JXhcbiIsIGxpbmstPnJlcXVlc3Qu
dGVzdF9sYW5lX2NvdW50KTsKKwlyZXR1cm4gMDsKK30KKworLyoqCisgKiBkcF9wYXJzZV9waHlf
dGVzdF9wYXJhbXMoKSAtIHBhcnNlcyB0aGUgcGh5IGxpbmsgcGFyYW1ldGVycworICogQGxpbms6
IERpc3BsYXkgUG9ydCBEcml2ZXIgZGF0YQorICoKKyAqIFBhcnNlcyB0aGUgRFBDRCAoQnl0ZSAw
eDI0OCkgZm9yIHRoZSBEUCBQSFkgbGluayBwYXR0ZXJuIHRoYXQgaXMgYmVpbmcKKyAqIHJlcXVl
c3RlZC4KKyAqLworc3RhdGljIGludCBkcF9saW5rX3BhcnNlX3BoeV90ZXN0X3BhcmFtcyhzdHJ1
Y3QgZHBfbGlua19wcml2YXRlICpsaW5rKQoreworCXU4IGRhdGE7CisJc3NpemVfdCBybGVuOwor
CisJcmxlbiA9IGRybV9kcF9kcGNkX3JlYWRiKGxpbmstPmF1eC0+ZHJtX2F1eCwgRFBfVEVTVF9Q
SFlfUEFUVEVSTiwgJmRhdGEpOworCWlmIChybGVuIDwgMCkgeworCQlEUk1fRVJST1IoImZhaWxl
ZCB0byByZWFkIHBoeSBsaW5rIHBhdHRlcm4uIHJsZW49JXpkXG4iLCBybGVuKTsKKwkJcmV0dXJu
IHJsZW47CisJfQorCisJbGluay0+ZHBfbGluay5waHlfcGFyYW1zLnBoeV90ZXN0X3BhdHRlcm5f
c2VsID0gZGF0YTsKKworCURSTV9ERUJVR19EUCgicGh5X3Rlc3RfcGF0dGVybl9zZWwgPSAweCV4
XG4iLCBkYXRhKTsKKworCXN3aXRjaCAoZGF0YSkgeworCWNhc2UgRFBfTElOS19RVUFMX1BBVFRF
Uk5fRElTQUJMRToKKwljYXNlIERQX0xJTktfUVVBTF9QQVRURVJOX0QxMF8yOgorCWNhc2UgRFBf
TElOS19RVUFMX1BBVFRFUk5fRVJST1JfUkFURToKKwljYXNlIERQX0xJTktfUVVBTF9QQVRURVJO
X1BSQlM3OgorCWNhc2UgRFBfTElOS19RVUFMX1BBVFRFUk5fODBCSVRfQ1VTVE9NOgorCWNhc2Ug
RFBfTElOS19RVUFMX1BBVFRFUk5fSEJSMl9FWUU6CisJCXJldHVybiAwOworCWRlZmF1bHQ6CisJ
CXJldHVybiAtRUlOVkFMOworCX0KK30KKworLyoqCisgKiBkcF9saW5rX2lzX3ZpZGVvX2F1ZGlv
X3Rlc3RfcmVxdWVzdGVkKCkgLSBjaGVja3MgZm9yIGF1ZGlvL3ZpZGVvIGxpbmsgcmVxdWVzdAor
ICogQGxpbms6IGxpbmsgcmVxdWVzdGVkIGJ5IHRoZSBzaW5rCisgKgorICogUmV0dXJucyB0cnVl
IGlmIHRoZSByZXF1ZXN0ZWQgbGluayBpcyBhIHBlcm1pdHRlZCBhdWRpby92aWRlbyBsaW5rLgor
ICovCitzdGF0aWMgYm9vbCBkcF9saW5rX2lzX3ZpZGVvX2F1ZGlvX3Rlc3RfcmVxdWVzdGVkKHUz
MiBsaW5rKQoreworCXU4IHZpZGVvX2F1ZGlvX3Rlc3QgPSAoRFBfVEVTVF9MSU5LX1ZJREVPX1BB
VFRFUk4gfAorCQkJCURQX1RFU1RfTElOS19BVURJT19QQVRURVJOIHwKKwkJCQlEUF9URVNUX0xJ
TktfQVVESU9fRElTQUJMRURfVklERU8pOworCisJcmV0dXJuICgobGluayAmIHZpZGVvX2F1ZGlv
X3Rlc3QpICYmCisJCSEobGluayAmIH52aWRlb19hdWRpb190ZXN0KSk7Cit9CisKKy8qKgorICog
ZHBfbGlua19wYXJzZV9yZXF1ZXN0KCkgLSBwYXJzZXMgbGluayByZXF1ZXN0IHBhcmFtZXRlcnMg
ZnJvbSBzaW5rCisgKiBAbGluazogRGlzcGxheSBQb3J0IERyaXZlciBkYXRhCisgKgorICogUGFy
c2VzIHRoZSBEUENEIHRvIGNoZWNrIGlmIGFuIGF1dG9tYXRlZCBsaW5rIGlzIHJlcXVlc3RlZCAo
Qnl0ZSAweDIwMSksCisgKiBhbmQgd2hhdCB0eXBlIG9mIGxpbmsgYXV0b21hdGlvbiBpcyBiZWlu
ZyByZXF1ZXN0ZWQgKEJ5dGUgMHgyMTgpLgorICovCitzdGF0aWMgaW50IGRwX2xpbmtfcGFyc2Vf
cmVxdWVzdChzdHJ1Y3QgZHBfbGlua19wcml2YXRlICpsaW5rKQoreworCWludCByZXQgPSAwOwor
CXU4IGRhdGE7CisJc3NpemVfdCBybGVuOworCisJLyoqCisJICogUmVhZCB0aGUgZGV2aWNlIHNl
cnZpY2UgSVJRIHZlY3RvciAoQnl0ZSAweDIwMSkgdG8gZGV0ZXJtaW5lCisJICogd2hldGhlciBh
biBhdXRvbWF0ZWQgbGluayBoYXMgYmVlbiByZXF1ZXN0ZWQgYnkgdGhlIHNpbmsuCisJICovCisJ
cmxlbiA9IGRybV9kcF9kcGNkX3JlYWRiKGxpbmstPmF1eC0+ZHJtX2F1eCwKKwkJCQlEUF9ERVZJ
Q0VfU0VSVklDRV9JUlFfVkVDVE9SLCAmZGF0YSk7CisJaWYgKHJsZW4gPCAwKSB7CisJCURSTV9F
UlJPUigiYXV4IHJlYWQgZmFpbGVkLiBybGVuPSV6ZFxuIiwgcmxlbik7CisJCXJldHVybiBybGVu
OworCX0KKworCURSTV9ERUJVR19EUCgiZGV2aWNlIHNlcnZpY2UgaXJxIHZlY3RvciA9IDB4JXhc
biIsIGRhdGEpOworCisJaWYgKCEoZGF0YSAmIERQX0FVVE9NQVRFRF9URVNUX1JFUVVFU1QpKSB7
CisJCURSTV9ERUJVR19EUCgibm8gdGVzdCByZXF1ZXN0ZWRcbiIpOworCQlyZXR1cm4gMDsKKwl9
CisKKwkvKioKKwkgKiBSZWFkIHRoZSBsaW5rIHJlcXVlc3QgYnl0ZSAoQnl0ZSAweDIxOCkgdG8g
ZGV0ZXJtaW5lIHdoYXQgdHlwZQorCSAqIG9mIGF1dG9tYXRlZCBsaW5rIGhhcyBiZWVuIHJlcXVl
c3RlZCBieSB0aGUgc2luay4KKwkgKi8KKwlybGVuID0gZHJtX2RwX2RwY2RfcmVhZGIobGluay0+
YXV4LT5kcm1fYXV4LCBEUF9URVNUX1JFUVVFU1QsICZkYXRhKTsKKwlpZiAocmxlbiA8IDApIHsK
KwkJRFJNX0VSUk9SKCJhdXggcmVhZCBmYWlsZWQuIHJsZW49JXpkXG4iLCBybGVuKTsKKwkJcmV0
dXJuIHJsZW47CisJfQorCisJaWYgKCFkYXRhIHx8IChkYXRhID09IERQX1RFU1RfTElOS19GQVVY
X1BBVFRFUk4pKSB7CisJCURSTV9ERUJVR19EUCgibGluayAweCV4IG5vdCBzdXBwb3J0ZWRcbiIs
IGRhdGEpOworCQlnb3RvIGVuZDsKKwl9CisKKwlEUk1fREVCVUdfRFAoIlRlc3Q6KDB4JXgpIHJl
cXVlc3RlZFxuIiwgZGF0YSk7CisJbGluay0+cmVxdWVzdC50ZXN0X3JlcXVlc3RlZCA9IGRhdGE7
CisKKwlpZiAobGluay0+cmVxdWVzdC50ZXN0X3JlcXVlc3RlZCA9PSBEUF9URVNUX0xJTktfUEhZ
X1RFU1RfUEFUVEVSTikgeworCQlyZXQgPSBkcF9saW5rX3BhcnNlX3BoeV90ZXN0X3BhcmFtcyhs
aW5rKTsKKwkJaWYgKHJldCkKKwkJCWdvdG8gZW5kOworCQlyZXQgPSBkcF9saW5rX3BhcnNlX2xp
bmtfdHJhaW5pbmdfcGFyYW1zKGxpbmspOworCQlpZiAocmV0KQorCQkJZ290byBlbmQ7CisJfQor
CisJaWYgKGxpbmstPnJlcXVlc3QudGVzdF9yZXF1ZXN0ZWQgPT0gRFBfVEVTVF9MSU5LX1RSQUlO
SU5HKSB7CisJCXJldCA9IGRwX2xpbmtfcGFyc2VfbGlua190cmFpbmluZ19wYXJhbXMobGluayk7
CisJCWlmIChyZXQpCisJCQlnb3RvIGVuZDsKKwl9CisKKwlpZiAoZHBfbGlua19pc192aWRlb19h
dWRpb190ZXN0X3JlcXVlc3RlZCgKKwkJCWxpbmstPnJlcXVlc3QudGVzdF9yZXF1ZXN0ZWQpKSB7
CisJCXJldCA9IGRwX2xpbmtfcGFyc2VfdmlkZW9fcGF0dGVybl9wYXJhbXMobGluayk7CisJCWlm
IChyZXQpCisJCQlnb3RvIGVuZDsKKworCQlyZXQgPSBkcF9saW5rX3BhcnNlX2F1ZGlvX3BhdHRl
cm5fcGFyYW1zKGxpbmspOworCX0KK2VuZDoKKwkvKgorCSAqIFNlbmQgYSBEUF9URVNUX0FDSyBp
ZiBhbGwgbGluayBwYXJhbWV0ZXJzIGFyZSB2YWxpZCwgb3RoZXJ3aXNlIHNlbmQKKwkgKiBhIERQ
X1RFU1RfTkFLLgorCSAqLworCWlmIChyZXQpIHsKKwkJbGluay0+ZHBfbGluay50ZXN0X3Jlc3Bv
bnNlID0gRFBfVEVTVF9OQUs7CisJfSBlbHNlIHsKKwkJaWYgKGxpbmstPnJlcXVlc3QudGVzdF9y
ZXF1ZXN0ZWQgIT0gRFBfVEVTVF9MSU5LX0VESURfUkVBRCkKKwkJCWxpbmstPmRwX2xpbmsudGVz
dF9yZXNwb25zZSA9IERQX1RFU1RfQUNLOworCQllbHNlCisJCQlsaW5rLT5kcF9saW5rLnRlc3Rf
cmVzcG9uc2UgPQorCQkJCURQX1RFU1RfRURJRF9DSEVDS1NVTV9XUklURTsKKwl9CisKKwlyZXR1
cm4gcmV0OworfQorCisvKioKKyAqIGRwX2xpbmtfcGFyc2Vfc2lua19jb3VudCgpIC0gcGFyc2Vz
IHRoZSBzaW5rIGNvdW50CisgKgorICogUGFyc2VzIHRoZSBEUENEIHRvIGNoZWNrIGlmIHRoZXJl
IGlzIGFuIHVwZGF0ZSB0byB0aGUgc2luayBjb3VudAorICogKEJ5dGUgMHgyMDApLCBhbmQgd2hl
dGhlciBhbGwgdGhlIHNpbmsgZGV2aWNlcyBjb25uZWN0ZWQgaGF2ZSBDb250ZW50CisgKiBQcm90
ZWN0aW9uIGVuYWJsZWQuCisgKi8KK3N0YXRpYyBpbnQgZHBfbGlua19wYXJzZV9zaW5rX2NvdW50
KHN0cnVjdCBkcF9saW5rICpkcF9saW5rKQoreworCXNzaXplX3QgcmxlbjsKKwlib29sIGNwX3Jl
YWR5OworCisJc3RydWN0IGRwX2xpbmtfcHJpdmF0ZSAqbGluayA9IGNvbnRhaW5lcl9vZihkcF9s
aW5rLAorCQkJc3RydWN0IGRwX2xpbmtfcHJpdmF0ZSwgZHBfbGluayk7CisKKwlybGVuID0gZHJt
X2RwX2RwY2RfcmVhZGIobGluay0+YXV4LT5kcm1fYXV4LCBEUF9TSU5LX0NPVU5ULAorCQkJCSAm
bGluay0+ZHBfbGluay5zaW5rX2NvdW50KTsKKwlpZiAocmxlbiA8IDApIHsKKwkJRFJNX0VSUk9S
KCJzaW5rIGNvdW50IHJlYWQgZmFpbGVkLiBybGVuPSV6ZFxuIiwgcmxlbik7CisJCXJldHVybiBy
bGVuOworCX0KKworCWNwX3JlYWR5ID0gbGluay0+ZHBfbGluay5zaW5rX2NvdW50ICYgRFBfU0lO
S19DUF9SRUFEWTsKKworCWxpbmstPmRwX2xpbmsuc2lua19jb3VudCA9CisJCURQX0dFVF9TSU5L
X0NPVU5UKGxpbmstPmRwX2xpbmsuc2lua19jb3VudCk7CisKKwlEUk1fREVCVUdfRFAoInNpbmtf
Y291bnQgPSAweCV4LCBjcF9yZWFkeSA9IDB4JXhcbiIsCisJCWxpbmstPmRwX2xpbmsuc2lua19j
b3VudCwgY3BfcmVhZHkpOworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBkcF9saW5rX3Bh
cnNlX3Npbmtfc3RhdHVzX2ZpZWxkKHN0cnVjdCBkcF9saW5rX3ByaXZhdGUgKmxpbmspCit7CisJ
aW50IGxlbiA9IDA7CisKKwlsaW5rLT5wcmV2X3NpbmtfY291bnQgPSBsaW5rLT5kcF9saW5rLnNp
bmtfY291bnQ7CisJZHBfbGlua19wYXJzZV9zaW5rX2NvdW50KCZsaW5rLT5kcF9saW5rKTsKKwor
CWxlbiA9IGRybV9kcF9kcGNkX3JlYWRfbGlua19zdGF0dXMobGluay0+YXV4LT5kcm1fYXV4LAor
CQlsaW5rLT5saW5rX3N0YXR1cyk7CisJaWYgKGxlbiA8IERQX0xJTktfU1RBVFVTX1NJWkUpCisJ
CURSTV9FUlJPUigiRFAgbGluayBzdGF0dXMgcmVhZCBmYWlsZWRcbiIpOworCWRwX2xpbmtfcGFy
c2VfcmVxdWVzdChsaW5rKTsKK30KKworLyoqCisgKiBkcF9saW5rX3Byb2Nlc3NfbGlua190cmFp
bmluZ19yZXF1ZXN0KCkgLSBwcm9jZXNzZXMgbmV3IHRyYWluaW5nIHJlcXVlc3RzCisgKiBAbGlu
azogRGlzcGxheSBQb3J0IGxpbmsgZGF0YQorICoKKyAqIFRoaXMgZnVuY3Rpb24gd2lsbCBoYW5k
bGUgbmV3IGxpbmsgdHJhaW5pbmcgcmVxdWVzdHMgdGhhdCBhcmUgaW5pdGlhdGVkIGJ5CisgKiB0
aGUgc2luay4gSW4gcGFydGljdWxhciwgaXQgd2lsbCB1cGRhdGUgdGhlIHJlcXVlc3RlZCBsYW5l
IGNvdW50IGFuZCBsaW5rCisgKiBsaW5rIHJhdGUsIGFuZCB0aGVuIHRyaWdnZXIgdGhlIGxpbmsg
cmV0cmFpbmluZyBwcm9jZWR1cmUuCisgKgorICogVGhlIGZ1bmN0aW9uIHdpbGwgcmV0dXJuIDAg
aWYgYSBsaW5rIHRyYWluaW5nIHJlcXVlc3QgaGFzIGJlZW4gcHJvY2Vzc2VkLAorICogb3RoZXJ3
aXNlIGl0IHdpbGwgcmV0dXJuIC1FSU5WQUwuCisgKi8KK3N0YXRpYyBpbnQgZHBfbGlua19wcm9j
ZXNzX2xpbmtfdHJhaW5pbmdfcmVxdWVzdChzdHJ1Y3QgZHBfbGlua19wcml2YXRlICpsaW5rKQor
eworCWlmIChsaW5rLT5yZXF1ZXN0LnRlc3RfcmVxdWVzdGVkICE9IERQX1RFU1RfTElOS19UUkFJ
TklORykKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlEUk1fREVCVUdfRFAoIlRlc3Q6MHgleCBsaW5r
IHJhdGUgPSAweCV4LCBsYW5lIGNvdW50ID0gMHgleFxuIiwKKwkJCURQX1RFU1RfTElOS19UUkFJ
TklORywKKwkJCWxpbmstPnJlcXVlc3QudGVzdF9saW5rX3JhdGUsCisJCQlsaW5rLT5yZXF1ZXN0
LnRlc3RfbGFuZV9jb3VudCk7CisKKwlsaW5rLT5kcF9saW5rLmxpbmtfcGFyYW1zLm51bV9sYW5l
cyA9IGxpbmstPnJlcXVlc3QudGVzdF9sYW5lX2NvdW50OworCWxpbmstPmRwX2xpbmsubGlua19w
YXJhbXMucmF0ZSA9IGxpbmstPnJlcXVlc3QudGVzdF9saW5rX3JhdGU7CisKKwlyZXR1cm4gMDsK
K30KKworYm9vbCBkcF9saW5rX3NlbmRfdGVzdF9yZXNwb25zZShzdHJ1Y3QgZHBfbGluayAqZHBf
bGluaykKK3sKKwlzdHJ1Y3QgZHBfbGlua19wcml2YXRlICpsaW5rID0gTlVMTDsKKwlpbnQgcmV0
ID0gMDsKKworCWlmICghZHBfbGluaykgeworCQlEUk1fRVJST1IoImludmFsaWQgaW5wdXRcbiIp
OworCQlyZXR1cm4gZmFsc2U7CisJfQorCisJbGluayA9IGNvbnRhaW5lcl9vZihkcF9saW5rLCBz
dHJ1Y3QgZHBfbGlua19wcml2YXRlLCBkcF9saW5rKTsKKworCW11dGV4X2xvY2soJmxpbmstPnRl
c3RfcmVzcG9uc2VfbXV0ZXgpOworCXJldCA9IGRybV9kcF9kcGNkX3dyaXRlYihsaW5rLT5hdXgt
PmRybV9hdXgsIERQX1RFU1RfUkVTUE9OU0UsCisJCQlkcF9saW5rLT50ZXN0X3Jlc3BvbnNlKTsK
KwltdXRleF91bmxvY2soJmxpbmstPnRlc3RfcmVzcG9uc2VfbXV0ZXgpOworCisJcmV0dXJuIHJl
dCA9PSAxOworfQorCitpbnQgZHBfbGlua19wc21fY29uZmlnKHN0cnVjdCBkcF9saW5rICpkcF9s
aW5rLAorCQkJICAgICAgc3RydWN0IGRybV9kcF9saW5rICpsaW5rX2luZm8sIGJvb2wgZW5hYmxl
KQoreworCXN0cnVjdCBkcF9saW5rX3ByaXZhdGUgKmxpbmsgPSBOVUxMOworCWludCByZXQgPSAw
OworCisJaWYgKCFkcF9saW5rKSB7CisJCURSTV9FUlJPUigiaW52YWxpZCBwYXJhbXNcbiIpOwor
CQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlsaW5rID0gY29udGFpbmVyX29mKGRwX2xpbmssIHN0
cnVjdCBkcF9saW5rX3ByaXZhdGUsIGRwX2xpbmspOworCisJbXV0ZXhfbG9jaygmbGluay0+cHNt
X211dGV4KTsKKwlpZiAoZW5hYmxlKQorCQlyZXQgPSBkcm1fZHBfbGlua19wb3dlcl9kb3duKGxp
bmstPmF1eC0+ZHJtX2F1eCwgbGlua19pbmZvKTsKKwllbHNlCisJCXJldCA9IGRybV9kcF9saW5r
X3Bvd2VyX3VwKGxpbmstPmF1eC0+ZHJtX2F1eCwgbGlua19pbmZvKTsKKworCWlmIChyZXQpCisJ
CURSTV9FUlJPUigiRmFpbGVkIHRvICVzIGxvdyBwb3dlciBtb2RlXG4iLCBlbmFibGUgPyAiZW50
ZXIiIDogImV4aXQiKTsKKwllbHNlCisJCWRwX2xpbmstPnBzbV9lbmFibGVkID0gZW5hYmxlOwor
CisJbXV0ZXhfdW5sb2NrKCZsaW5rLT5wc21fbXV0ZXgpOworCXJldHVybiByZXQ7Cit9CisKK2Jv
b2wgZHBfbGlua19zZW5kX2VkaWRfY2hlY2tzdW0oc3RydWN0IGRwX2xpbmsgKmRwX2xpbmssIHU4
IGNoZWNrc3VtKQoreworCXN0cnVjdCBkcF9saW5rX3ByaXZhdGUgKmxpbmsgPSBOVUxMOworCWlu
dCByZXQgPSAwOworCisJaWYgKCFkcF9saW5rKSB7CisJCURSTV9FUlJPUigiaW52YWxpZCBpbnB1
dFxuIik7CisJCXJldHVybiBmYWxzZTsKKwl9CisKKwlsaW5rID0gY29udGFpbmVyX29mKGRwX2xp
bmssIHN0cnVjdCBkcF9saW5rX3ByaXZhdGUsIGRwX2xpbmspOworCisJcmV0ID0gZHJtX2RwX2Rw
Y2Rfd3JpdGViKGxpbmstPmF1eC0+ZHJtX2F1eCwgRFBfVEVTVF9FRElEX0NIRUNLU1VNLCBjaGVj
a3N1bSk7CisJcmV0dXJuIHJldCA9PSAxOworfQorCitzdGF0aWMgaW50IGRwX2xpbmtfcGFyc2Vf
dnhfcHgoc3RydWN0IGRwX2xpbmtfcHJpdmF0ZSAqbGluaykKK3sKKwlpbnQgcmV0ID0gMDsKKwor
CURSTV9ERUJVR19EUCgidng6IDA9JWQsIDE9JWQsIDI9JWQsIDM9JWRcbiIsCisJCWRybV9kcF9n
ZXRfYWRqdXN0X3JlcXVlc3Rfdm9sdGFnZShsaW5rLT5saW5rX3N0YXR1cywgMCksCisJCWRybV9k
cF9nZXRfYWRqdXN0X3JlcXVlc3Rfdm9sdGFnZShsaW5rLT5saW5rX3N0YXR1cywgMSksCisJCWRy
bV9kcF9nZXRfYWRqdXN0X3JlcXVlc3Rfdm9sdGFnZShsaW5rLT5saW5rX3N0YXR1cywgMiksCisJ
CWRybV9kcF9nZXRfYWRqdXN0X3JlcXVlc3Rfdm9sdGFnZShsaW5rLT5saW5rX3N0YXR1cywgMykp
OworCisJRFJNX0RFQlVHX0RQKCJweDogMD0lZCwgMT0lZCwgMj0lZCwgMz0lZFxuIiwKKwkJZHJt
X2RwX2dldF9hZGp1c3RfcmVxdWVzdF9wcmVfZW1waGFzaXMobGluay0+bGlua19zdGF0dXMsIDAp
LAorCQlkcm1fZHBfZ2V0X2FkanVzdF9yZXF1ZXN0X3ByZV9lbXBoYXNpcyhsaW5rLT5saW5rX3N0
YXR1cywgMSksCisJCWRybV9kcF9nZXRfYWRqdXN0X3JlcXVlc3RfcHJlX2VtcGhhc2lzKGxpbmst
Pmxpbmtfc3RhdHVzLCAyKSwKKwkJZHJtX2RwX2dldF9hZGp1c3RfcmVxdWVzdF9wcmVfZW1waGFz
aXMobGluay0+bGlua19zdGF0dXMsIDMpKTsKKworCS8qKgorCSAqIFVwZGF0ZSB0aGUgdm9sdGFn
ZSBhbmQgcHJlLWVtcGhhc2lzIGxldmVscyBhcyBwZXIgRFBDRCByZXF1ZXN0CisJICogdmVjdG9y
LgorCSAqLworCURSTV9ERUJVR19EUCgiQ3VycmVudDogdl9sZXZlbCA9IDB4JXgsIHBfbGV2ZWwg
PSAweCV4XG4iLAorCQkJbGluay0+ZHBfbGluay5waHlfcGFyYW1zLnZfbGV2ZWwsCisJCQlsaW5r
LT5kcF9saW5rLnBoeV9wYXJhbXMucF9sZXZlbCk7CisJbGluay0+ZHBfbGluay5waHlfcGFyYW1z
LnZfbGV2ZWwgPQorCQlkcm1fZHBfZ2V0X2FkanVzdF9yZXF1ZXN0X3ZvbHRhZ2UobGluay0+bGlu
a19zdGF0dXMsIDApOworCWxpbmstPmRwX2xpbmsucGh5X3BhcmFtcy5wX2xldmVsID0KKwkJZHJt
X2RwX2dldF9hZGp1c3RfcmVxdWVzdF9wcmVfZW1waGFzaXMobGluay0+bGlua19zdGF0dXMsIDAp
OworCURSTV9ERUJVR19EUCgiUmVxdWVzdGVkOiB2X2xldmVsID0gMHgleCwgcF9sZXZlbCA9IDB4
JXhcbiIsCisJCQlsaW5rLT5kcF9saW5rLnBoeV9wYXJhbXMudl9sZXZlbCwKKwkJCWxpbmstPmRw
X2xpbmsucGh5X3BhcmFtcy5wX2xldmVsKTsKKworCXJldHVybiByZXQ7Cit9CisKKy8qKgorICog
ZHBfbGlua19wcm9jZXNzX3BoeV90ZXN0X3BhdHRlcm5fcmVxdWVzdCgpIC0gcHJvY2VzcyBuZXcg
cGh5IGxpbmsgcmVxdWVzdHMKKyAqIEBsaW5rOiBEaXNwbGF5IFBvcnQgRHJpdmVyIGRhdGEKKyAq
CisgKiBUaGlzIGZ1bmN0aW9uIHdpbGwgaGFuZGxlIG5ldyBwaHkgbGluayBwYXR0ZXJuIHJlcXVl
c3RzIHRoYXQgYXJlIGluaXRpYXRlZAorICogYnkgdGhlIHNpbmsuIFRoZSBmdW5jdGlvbiB3aWxs
IHJldHVybiAwIGlmIGEgcGh5IGxpbmsgcGF0dGVybiBoYXMgYmVlbgorICogcHJvY2Vzc2VkLCBv
dGhlcndpc2UgaXQgd2lsbCByZXR1cm4gLUVJTlZBTC4KKyAqLworc3RhdGljIGludCBkcF9saW5r
X3Byb2Nlc3NfcGh5X3Rlc3RfcGF0dGVybl9yZXF1ZXN0KAorCQlzdHJ1Y3QgZHBfbGlua19wcml2
YXRlICpsaW5rKQoreworCWludCByZXQgPSAwOworCisJaWYgKCEobGluay0+cmVxdWVzdC50ZXN0
X3JlcXVlc3RlZCAmIERQX1RFU1RfTElOS19QSFlfVEVTVF9QQVRURVJOKSkgeworCQlEUk1fREVC
VUdfRFAoIm5vIHBoeSB0ZXN0XG4iKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJaWYgKCFp
c19saW5rX3JhdGVfdmFsaWQobGluay0+cmVxdWVzdC50ZXN0X2xpbmtfcmF0ZSkgfHwKKwkJIWlz
X2xhbmVfY291bnRfdmFsaWQobGluay0+cmVxdWVzdC50ZXN0X2xhbmVfY291bnQpKSB7CisJCURS
TV9FUlJPUigiSW52YWxpZCBwYXJhbXM6IGxpbmsgcmF0ZSA9IDB4JXgsIGxhbmUgY291bnQgPSAw
eCV4XG4iLAorCQkJbGluay0+cmVxdWVzdC50ZXN0X2xpbmtfcmF0ZSwgbGluay0+cmVxdWVzdC50
ZXN0X2xhbmVfY291bnQpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlEUk1fREVCVUdfRFAo
IkN1cnJlbnQ6IHJhdGUgPSAweCV4LCBsYW5lIGNvdW50ID0gMHgleFxuIiwKKwkJCWxpbmstPmRw
X2xpbmsubGlua19wYXJhbXMucmF0ZSwKKwkJCWxpbmstPmRwX2xpbmsubGlua19wYXJhbXMubnVt
X2xhbmVzKTsKKworCURSTV9ERUJVR19EUCgiUmVxdWVzdGVkOiByYXRlID0gMHgleCwgbGFuZSBj
b3VudCA9IDB4JXhcbiIsCisJCQlsaW5rLT5yZXF1ZXN0LnRlc3RfbGlua19yYXRlLCBsaW5rLT5y
ZXF1ZXN0LnRlc3RfbGFuZV9jb3VudCk7CisKKwlsaW5rLT5kcF9saW5rLmxpbmtfcGFyYW1zLm51
bV9sYW5lcyA9IGxpbmstPnJlcXVlc3QudGVzdF9sYW5lX2NvdW50OworCWxpbmstPmRwX2xpbmsu
bGlua19wYXJhbXMucmF0ZSA9IGxpbmstPnJlcXVlc3QudGVzdF9saW5rX3JhdGU7CisKKwlyZXQg
PSBkcF9saW5rX3BhcnNlX3Z4X3B4KGxpbmspOworCWlmIChyZXQpCisJCSAgRFJNX0VSUk9SKCJw
YXJzZV92eF9weCBmYWlsZWQuIHJldD0lZFxuIiwgcmV0KTsKKworCXJldHVybiByZXQ7Cit9CisK
K3N0YXRpYyB1OCBnZXRfbGlua19zdGF0dXMoY29uc3QgdTggbGlua19zdGF0dXNbRFBfTElOS19T
VEFUVVNfU0laRV0sIGludCByKQoreworCXJldHVybiBsaW5rX3N0YXR1c1tyIC0gRFBfTEFORTBf
MV9TVEFUVVNdOworfQorCisvKioKKyAqIGRwX2xpbmtfcHJvY2Vzc19saW5rX3N0YXR1c191cGRh
dGUoKSAtIHByb2Nlc3NlcyBsaW5rIHN0YXR1cyB1cGRhdGVzCisgKiBAbGluazogRGlzcGxheSBQ
b3J0IGxpbmsgbW9kdWxlIGRhdGEKKyAqCisgKiBUaGlzIGZ1bmN0aW9uIHdpbGwgY2hlY2sgZm9y
IGNoYW5nZXMgaW4gdGhlIGxpbmsgc3RhdHVzLCBlLmcuIGNsb2NrCisgKiByZWNvdmVyeSBkb25l
IG9uIGFsbCBsYW5lcywgYW5kIHRyaWdnZXIgbGluayB0cmFpbmluZyBpZiB0aGVyZSBpcyBhCisg
KiBmYWlsdXJlL2Vycm9yIG9uIHRoZSBsaW5rLgorICoKKyAqIFRoZSBmdW5jdGlvbiB3aWxsIHJl
dHVybiAwIGlmIHRoZSBhIGxpbmsgc3RhdHVzIHVwZGF0ZSBoYXMgYmVlbiBwcm9jZXNzZWQsCisg
KiBvdGhlcndpc2UgaXQgd2lsbCByZXR1cm4gLUVJTlZBTC4KKyAqLworc3RhdGljIGludCBkcF9s
aW5rX3Byb2Nlc3NfbGlua19zdGF0dXNfdXBkYXRlKHN0cnVjdCBkcF9saW5rX3ByaXZhdGUgKmxp
bmspCit7CisJaWYgKCEoZ2V0X2xpbmtfc3RhdHVzKGxpbmstPmxpbmtfc3RhdHVzLCBEUF9MQU5F
X0FMSUdOX1NUQVRVU19VUERBVEVEKSAmCisJCQkJCQkJRFBfTElOS19TVEFUVVNfVVBEQVRFRCkg
fHwKKwkJCShkcm1fZHBfY2xvY2tfcmVjb3Zlcnlfb2sobGluay0+bGlua19zdGF0dXMsCisJCQkJ
CWxpbmstPmRwX2xpbmsubGlua19wYXJhbXMubnVtX2xhbmVzKSAmJgorCQkJZHJtX2RwX2NoYW5u
ZWxfZXFfb2sobGluay0+bGlua19zdGF0dXMsCisJCQkJCWxpbmstPmRwX2xpbmsubGlua19wYXJh
bXMubnVtX2xhbmVzKSkpCisJCXJldHVybiAtRUlOVkFMOworCisJRFJNX0RFQlVHX0RQKCJjaGFu
bmVsX2VxX2RvbmUgPSAlZCwgY2xvY2tfcmVjb3ZlcnlfZG9uZSA9ICVkXG4iLAorCQkJZHJtX2Rw
X2Nsb2NrX3JlY292ZXJ5X29rKGxpbmstPmxpbmtfc3RhdHVzLAorCQkJbGluay0+ZHBfbGluay5s
aW5rX3BhcmFtcy5udW1fbGFuZXMpLAorCQkJZHJtX2RwX2Nsb2NrX3JlY292ZXJ5X29rKGxpbmst
Pmxpbmtfc3RhdHVzLAorCQkJbGluay0+ZHBfbGluay5saW5rX3BhcmFtcy5udW1fbGFuZXMpKTsK
KworCXJldHVybiAwOworfQorCisvKioKKyAqIGRwX2xpbmtfcHJvY2Vzc19kb3duc3RyZWFtX3Bv
cnRfc3RhdHVzX2NoYW5nZSgpIC0gcHJvY2VzcyBwb3J0IHN0YXR1cyBjaGFuZ2VzCisgKiBAbGlu
azogRGlzcGxheSBQb3J0IERyaXZlciBkYXRhCisgKgorICogVGhpcyBmdW5jdGlvbiB3aWxsIGhh
bmRsZSBkb3duc3RyZWFtIHBvcnQgdXBkYXRlcyB0aGF0IGFyZSBpbml0aWF0ZWQgYnkKKyAqIHRo
ZSBzaW5rLiBJZiB0aGUgZG93bnN0cmVhbSBwb3J0IHN0YXR1cyBoYXMgY2hhbmdlZCwgdGhlIEVE
SUQgaXMgcmVhZCB2aWEKKyAqIEFVWC4KKyAqCisgKiBUaGUgZnVuY3Rpb24gd2lsbCByZXR1cm4g
MCBpZiBhIGRvd25zdHJlYW0gcG9ydCB1cGRhdGUgaGFzIGJlZW4KKyAqIHByb2Nlc3NlZCwgb3Ro
ZXJ3aXNlIGl0IHdpbGwgcmV0dXJuIC1FSU5WQUwuCisgKi8KK3N0YXRpYyBpbnQgZHBfbGlua19w
cm9jZXNzX2RzX3BvcnRfc3RhdHVzX2NoYW5nZShzdHJ1Y3QgZHBfbGlua19wcml2YXRlICpsaW5r
KQoreworCWlmIChnZXRfbGlua19zdGF0dXMobGluay0+bGlua19zdGF0dXMsIERQX0xBTkVfQUxJ
R05fU1RBVFVTX1VQREFURUQpICYKKwkJCQkJRFBfRE9XTlNUUkVBTV9QT1JUX1NUQVRVU19DSEFO
R0VEKQorCQlnb3RvIHJlc2V0OworCisJaWYgKGxpbmstPnByZXZfc2lua19jb3VudCA9PSBsaW5r
LT5kcF9saW5rLnNpbmtfY291bnQpCisJCXJldHVybiAtRUlOVkFMOworCityZXNldDoKKwkvKiBy
ZXNldCBwcmV2X3NpbmtfY291bnQgKi8KKwlsaW5rLT5wcmV2X3NpbmtfY291bnQgPSBsaW5rLT5k
cF9saW5rLnNpbmtfY291bnQ7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGJvb2wgZHBfbGlu
a19pc192aWRlb19wYXR0ZXJuX3JlcXVlc3RlZChzdHJ1Y3QgZHBfbGlua19wcml2YXRlICpsaW5r
KQoreworCXJldHVybiAobGluay0+cmVxdWVzdC50ZXN0X3JlcXVlc3RlZCAmIERQX1RFU1RfTElO
S19WSURFT19QQVRURVJOKQorCQkmJiAhKGxpbmstPnJlcXVlc3QudGVzdF9yZXF1ZXN0ZWQgJgor
CQlEUF9URVNUX0xJTktfQVVESU9fRElTQUJMRURfVklERU8pOworfQorCitzdGF0aWMgYm9vbCBk
cF9saW5rX2lzX2F1ZGlvX3BhdHRlcm5fcmVxdWVzdGVkKHN0cnVjdCBkcF9saW5rX3ByaXZhdGUg
KmxpbmspCit7CisJcmV0dXJuIChsaW5rLT5yZXF1ZXN0LnRlc3RfcmVxdWVzdGVkICYgRFBfVEVT
VF9MSU5LX0FVRElPX1BBVFRFUk4pOworfQorCitzdGF0aWMgdm9pZCBkcF9saW5rX3Jlc2V0X2Rh
dGEoc3RydWN0IGRwX2xpbmtfcHJpdmF0ZSAqbGluaykKK3sKKwlsaW5rLT5yZXF1ZXN0ID0gKGNv
bnN0IHN0cnVjdCBkcF9saW5rX3JlcXVlc3QpeyAwIH07CisJbGluay0+ZHBfbGluay50ZXN0X3Zp
ZGVvID0gKGNvbnN0IHN0cnVjdCBkcF9saW5rX3Rlc3RfdmlkZW8peyAwIH07CisJbGluay0+ZHBf
bGluay50ZXN0X3ZpZGVvLnRlc3RfYml0X2RlcHRoID0gRFBfVEVTVF9CSVRfREVQVEhfVU5LTk9X
TjsKKwlsaW5rLT5kcF9saW5rLnRlc3RfYXVkaW8gPSAoY29uc3Qgc3RydWN0IGRwX2xpbmtfdGVz
dF9hdWRpbyl7IDAgfTsKKwlsaW5rLT5kcF9saW5rLnBoeV9wYXJhbXMucGh5X3Rlc3RfcGF0dGVy
bl9zZWwgPSAwOworCWxpbmstPmRwX2xpbmsuc2lua19yZXF1ZXN0ID0gMDsKKwlsaW5rLT5kcF9s
aW5rLnRlc3RfcmVzcG9uc2UgPSAwOworfQorCisvKioKKyAqIGRwX2xpbmtfcHJvY2Vzc19yZXF1
ZXN0KCkgLSBoYW5kbGUgSFBEIElSUSB0cmFuc2l0aW9uIHRvIEhJR0gKKyAqIEBsaW5rOiBwb2lu
dGVyIHRvIGxpbmsgbW9kdWxlIGRhdGEKKyAqCisgKiBUaGlzIGZ1bmN0aW9uIHdpbGwgaGFuZGxl
IHRoZSBIUEQgSVJRIHN0YXRlIHRyYW5zaXRpb25zIGZyb20gTE9XIHRvIEhJR0gKKyAqIChpbmNs
dWRpbmcgY2FzZXMgd2hlbiB0aGVyZSBhcmUgYmFjayB0byBiYWNrIEhQRCBJUlEgSElHSCkgaW5k
aWNhdGluZworICogdGhlIHN0YXJ0IG9mIGEgbmV3IGxpbmsgdHJhaW5pbmcgcmVxdWVzdCBvciBz
aW5rIHN0YXR1cyB1cGRhdGUuCisgKi8KK2ludCBkcF9saW5rX3Byb2Nlc3NfcmVxdWVzdChzdHJ1
Y3QgZHBfbGluayAqZHBfbGluaykKK3sKKwlpbnQgcmV0ID0gMDsKKwlzdHJ1Y3QgZHBfbGlua19w
cml2YXRlICpsaW5rOworCisJaWYgKCFkcF9saW5rKSB7CisJCURSTV9FUlJPUigiaW52YWxpZCBp
bnB1dFxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCWxpbmsgPSBjb250YWluZXJfb2Yo
ZHBfbGluaywgc3RydWN0IGRwX2xpbmtfcHJpdmF0ZSwgZHBfbGluayk7CisKKwltdXRleF9sb2Nr
KCZsaW5rLT50ZXN0X3Jlc3BvbnNlX211dGV4KTsKKwlkcF9saW5rX3Jlc2V0X2RhdGEobGluayk7
CisKKwlkcF9saW5rX3BhcnNlX3Npbmtfc3RhdHVzX2ZpZWxkKGxpbmspOworCW11dGV4X3VubG9j
aygmbGluay0+dGVzdF9yZXNwb25zZV9tdXRleCk7CisKKwlpZiAobGluay0+cmVxdWVzdC50ZXN0
X3JlcXVlc3RlZCA9PSBEUF9URVNUX0xJTktfRURJRF9SRUFEKSB7CisJCWRwX2xpbmstPnNpbmtf
cmVxdWVzdCB8PSBEUF9URVNUX0xJTktfRURJRF9SRUFEOworCQlyZXR1cm4gcmV0OworCX0KKwor
CXJldCA9IGRwX2xpbmtfcHJvY2Vzc19kc19wb3J0X3N0YXR1c19jaGFuZ2UobGluayk7CisJaWYg
KCFyZXQpIHsKKwkJZHBfbGluay0+c2lua19yZXF1ZXN0IHw9IERTX1BPUlRfU1RBVFVTX0NIQU5H
RUQ7CisJCXJldHVybiByZXQ7CisJfQorCisJcmV0ID0gZHBfbGlua19wcm9jZXNzX2xpbmtfdHJh
aW5pbmdfcmVxdWVzdChsaW5rKTsKKwlpZiAoIXJldCkgeworCQlkcF9saW5rLT5zaW5rX3JlcXVl
c3QgfD0gRFBfVEVTVF9MSU5LX1RSQUlOSU5HOworCQlyZXR1cm4gcmV0OworCX0KKworCXJldCA9
IGRwX2xpbmtfcHJvY2Vzc19waHlfdGVzdF9wYXR0ZXJuX3JlcXVlc3QobGluayk7CisJaWYgKCFy
ZXQpIHsKKwkJZHBfbGluay0+c2lua19yZXF1ZXN0IHw9IERQX1RFU1RfTElOS19QSFlfVEVTVF9Q
QVRURVJOOworCQlyZXR1cm4gcmV0OworCX0KKworCXJldCA9IGRwX2xpbmtfcHJvY2Vzc19saW5r
X3N0YXR1c191cGRhdGUobGluayk7CisJaWYgKCFyZXQpIHsKKwkJZHBfbGluay0+c2lua19yZXF1
ZXN0IHw9IERQX0xJTktfU1RBVFVTX1VQREFURUQ7CisJCXJldHVybiByZXQ7CisJfQorCisJaWYg
KGRwX2xpbmtfaXNfdmlkZW9fcGF0dGVybl9yZXF1ZXN0ZWQobGluaykpIHsKKwkJZHBfbGluay0+
c2lua19yZXF1ZXN0IHw9IERQX1RFU1RfTElOS19WSURFT19QQVRURVJOOworCQlyZXR1cm4gLUVJ
TlZBTDsKKwl9CisKKwlpZiAoZHBfbGlua19pc19hdWRpb19wYXR0ZXJuX3JlcXVlc3RlZChsaW5r
KSkgeworCQlkcF9saW5rLT5zaW5rX3JlcXVlc3QgfD0gRFBfVEVTVF9MSU5LX0FVRElPX1BBVFRF
Uk47CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCXJldHVybiByZXQ7Cit9CisKK2ludCBkcF9s
aW5rX2dldF9jb2xvcmltZXRyeV9jb25maWcoc3RydWN0IGRwX2xpbmsgKmRwX2xpbmspCit7CisJ
dTMyIGNjOworCXN0cnVjdCBkcF9saW5rX3ByaXZhdGUgKmxpbms7CisKKwlpZiAoIWRwX2xpbmsp
IHsKKwkJRFJNX0VSUk9SKCJpbnZhbGlkIGlucHV0XG4iKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJ
fQorCisJbGluayA9IGNvbnRhaW5lcl9vZihkcF9saW5rLCBzdHJ1Y3QgZHBfbGlua19wcml2YXRl
LCBkcF9saW5rKTsKKworCS8qCisJICogVW5sZXNzIGEgdmlkZW8gcGF0dGVybiBDVFMgdGVzdCBp
cyBvbmdvaW5nLCB1c2UgUkdCX1ZFU0EKKwkgKiBPbmx5IFJHQl9WRVNBIGFuZCBSR0JfQ0VBIHN1
cHBvcnRlZCBmb3Igbm93CisJICovCisJaWYgKGRwX2xpbmtfaXNfdmlkZW9fcGF0dGVybl9yZXF1
ZXN0ZWQobGluaykpCisJCWNjID0gbGluay0+ZHBfbGluay50ZXN0X3ZpZGVvLnRlc3RfZHluX3Jh
bmdlOworCWVsc2UKKwkJY2MgPSBEUF9URVNUX0RZTkFNSUNfUkFOR0VfVkVTQTsKKworCXJldHVy
biBjYzsKK30KKworaW50IGRwX2xpbmtfYWRqdXN0X2xldmVscyhzdHJ1Y3QgZHBfbGluayAqZHBf
bGluaywgdTggKmxpbmtfc3RhdHVzKQoreworCWludCBpOworCWludCB2X21heCA9IDAsIHBfbWF4
ID0gMDsKKwlzdHJ1Y3QgZHBfbGlua19wcml2YXRlICpsaW5rOworCisJaWYgKCFkcF9saW5rKSB7
CisJCURSTV9FUlJPUigiaW52YWxpZCBpbnB1dFxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0K
KworCWxpbmsgPSBjb250YWluZXJfb2YoZHBfbGluaywgc3RydWN0IGRwX2xpbmtfcHJpdmF0ZSwg
ZHBfbGluayk7CisKKwkvKiB1c2UgdGhlIG1heCBsZXZlbCBhY3Jvc3MgbGFuZXMgKi8KKwlmb3Ig
KGkgPSAwOyBpIDwgZHBfbGluay0+bGlua19wYXJhbXMubnVtX2xhbmVzOyBpKyspIHsKKwkJdTgg
ZGF0YV92ID0gZHJtX2RwX2dldF9hZGp1c3RfcmVxdWVzdF92b2x0YWdlKGxpbmtfc3RhdHVzLCBp
KTsKKwkJdTggZGF0YV9wID0gZHJtX2RwX2dldF9hZGp1c3RfcmVxdWVzdF9wcmVfZW1waGFzaXMo
bGlua19zdGF0dXMsIGkpOworCQlEUk1fREVCVUdfRFAoImxhbmU9JWQgcmVxX3ZvbHRhZ2Vfc3dp
bmc9JWQgcmVxX3ByZV9lbXBoYXNpcz0lZFxuIiwKKwkJCQkJCQlpLCBkYXRhX3YsIGRhdGFfcCk7
CisJCWlmICh2X21heCA8IGRhdGFfdikKKwkJCXZfbWF4ID0gZGF0YV92OworCQlpZiAocF9tYXgg
PCBkYXRhX3ApCisJCQlwX21heCA9IGRhdGFfcDsKKwl9CisKKwlkcF9saW5rLT5waHlfcGFyYW1z
LnZfbGV2ZWwgPSB2X21heCA+PiBEUF9UUkFJTl9WT0xUQUdFX1NXSU5HX1NISUZUOworCWRwX2xp
bmstPnBoeV9wYXJhbXMucF9sZXZlbCA9IHBfbWF4ID4+IERQX1RSQUlOX1BSRV9FTVBIQVNJU19T
SElGVDsKKworCS8qKgorCSAqIEFkanVzdCB0aGUgdm9sdGFnZSBzd2luZyBhbmQgcHJlLWVtcGhh
c2lzIGxldmVsIGNvbWJpbmF0aW9uIHRvIHdpdGhpbgorCSAqIHRoZSBhbGxvd2FibGUgcmFuZ2Uu
CisJICovCisJaWYgKGRwX2xpbmstPnBoeV9wYXJhbXMudl9sZXZlbCA+IERQX1RSQUlOX1ZPTFRB
R0VfU1dJTkdfTUFYKSB7CisJCURSTV9ERUJVR19EUCgiUmVxdWVzdGVkIHZTd2luZ0xldmVsPSVk
LCBjaGFuZ2UgdG8gJWRcbiIsCisJCQlkcF9saW5rLT5waHlfcGFyYW1zLnZfbGV2ZWwsIERQX1RS
QUlOX1ZPTFRBR0VfU1dJTkdfTUFYKTsKKwkJZHBfbGluay0+cGh5X3BhcmFtcy52X2xldmVsID0g
RFBfVFJBSU5fVk9MVEFHRV9TV0lOR19NQVg7CisJfQorCisJaWYgKGRwX2xpbmstPnBoeV9wYXJh
bXMucF9sZXZlbCA+IERQX1RSQUlOX1BSRV9FTVBIQVNJU19NQVgpIHsKKwkJRFJNX0RFQlVHX0RQ
KCJSZXF1ZXN0ZWQgcHJlRW1waGFzaXNMZXZlbD0lZCwgY2hhbmdlIHRvICVkXG4iLAorCQkJZHBf
bGluay0+cGh5X3BhcmFtcy5wX2xldmVsLCBEUF9UUkFJTl9QUkVfRU1QSEFTSVNfTUFYKTsKKwkJ
ZHBfbGluay0+cGh5X3BhcmFtcy5wX2xldmVsID0gRFBfVFJBSU5fUFJFX0VNUEhBU0lTX01BWDsK
Kwl9CisKKwlpZiAoKGRwX2xpbmstPnBoeV9wYXJhbXMucF9sZXZlbCA+IERQX1RSQUlOX1BSRV9F
TVBIQVNJU19MVkxfMSkKKwkJJiYgKGRwX2xpbmstPnBoeV9wYXJhbXMudl9sZXZlbCA9PSBEUF9U
UkFJTl9WT0xUQUdFX1NXSU5HX0xWTF8yKSkgeworCQlEUk1fREVCVUdfRFAoIlJlcXVlc3RlZCBw
cmVFbXBoYXNpc0xldmVsPSVkLCBjaGFuZ2UgdG8gJWRcbiIsCisJCQlkcF9saW5rLT5waHlfcGFy
YW1zLnBfbGV2ZWwsCisJCQlEUF9UUkFJTl9QUkVfRU1QSEFTSVNfTFZMXzEpOworCQlkcF9saW5r
LT5waHlfcGFyYW1zLnBfbGV2ZWwgPSBEUF9UUkFJTl9QUkVfRU1QSEFTSVNfTFZMXzE7CisJfQor
CisJRFJNX0RFQlVHX0RQKCJhZGp1c3RlZDogdl9sZXZlbD0lZCwgcF9sZXZlbD0lZFxuIiwKKwkJ
ZHBfbGluay0+cGh5X3BhcmFtcy52X2xldmVsLCBkcF9saW5rLT5waHlfcGFyYW1zLnBfbGV2ZWwp
OworCisJcmV0dXJuIDA7Cit9CisKK3UzMiBkcF9saW5rX2dldF90ZXN0X2JpdHNfZGVwdGgoc3Ry
dWN0IGRwX2xpbmsgKmRwX2xpbmssIHUzMiBicHApCit7CisJdTMyIHRiZDsKKworCS8qCisJICog
RmV3IHNpbXBsaXN0aWMgcnVsZXMgYW5kIGFzc3VtcHRpb25zIG1hZGUgaGVyZToKKwkgKiAgICAx
LiBUZXN0IGJpdCBkZXB0aCBpcyBiaXQgZGVwdGggcGVyIGNvbG9yIGNvbXBvbmVudAorCSAqICAg
IDIuIEFzc3VtZSAzIGNvbG9yIGNvbXBvbmVudHMKKwkgKi8KKwlzd2l0Y2ggKGJwcCkgeworCWNh
c2UgMTg6CisJCXRiZCA9IERQX1RFU1RfQklUX0RFUFRIXzY7CisJCWJyZWFrOworCWNhc2UgMjQ6
CisJCXRiZCA9IERQX1RFU1RfQklUX0RFUFRIXzg7CisJCWJyZWFrOworCWNhc2UgMzA6CisJCXRi
ZCA9IERQX1RFU1RfQklUX0RFUFRIXzEwOworCQlicmVhazsKKwlkZWZhdWx0OgorCQl0YmQgPSBE
UF9URVNUX0JJVF9ERVBUSF9VTktOT1dOOworCQlicmVhazsKKwl9CisKKwlpZiAodGJkICE9IERQ
X1RFU1RfQklUX0RFUFRIX1VOS05PV04pCisJCXRiZCA9ICh0YmQgPj4gRFBfVEVTVF9CSVRfREVQ
VEhfU0hJRlQpOworCisJcmV0dXJuIHRiZDsKK30KKworc3RydWN0IGRwX2xpbmsgKmRwX2xpbmtf
Z2V0KHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRwX2F1eCAqYXV4KQoreworCWludCByYyA9
IDA7CisJc3RydWN0IGRwX2xpbmtfcHJpdmF0ZSAqbGluazsKKwlzdHJ1Y3QgZHBfbGluayAqZHBf
bGluazsKKworCWlmICghZGV2IHx8ICFhdXgpIHsKKwkJRFJNX0VSUk9SKCJpbnZhbGlkIGlucHV0
XG4iKTsKKwkJcmMgPSAtRUlOVkFMOworCQlnb3RvIGVycm9yOworCX0KKworCWxpbmsgPSBkZXZt
X2t6YWxsb2MoZGV2LCBzaXplb2YoKmxpbmspLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWxpbmspIHsK
KwkJcmMgPSAtRUlOVkFMOworCQlnb3RvIGVycm9yOworCX0KKworCWxpbmstPmRldiAgID0gZGV2
OworCWxpbmstPmF1eCAgID0gYXV4OworCisJbXV0ZXhfaW5pdCgmbGluay0+dGVzdF9yZXNwb25z
ZV9tdXRleCk7CisJbXV0ZXhfaW5pdCgmbGluay0+cHNtX211dGV4KTsKKwlkcF9saW5rID0gJmxp
bmstPmRwX2xpbms7CisKKwlyZXR1cm4gZHBfbGluazsKK2Vycm9yOgorCXJldHVybiBFUlJfUFRS
KHJjKTsKK30KKwordm9pZCBkcF9saW5rX3B1dChzdHJ1Y3QgZHBfbGluayAqZHBfbGluaykKK3sK
KwlzdHJ1Y3QgZHBfbGlua19wcml2YXRlICpsaW5rOworCisJaWYgKCFkcF9saW5rKQorCQlyZXR1
cm47CisKKwlsaW5rID0gY29udGFpbmVyX29mKGRwX2xpbmssIHN0cnVjdCBkcF9saW5rX3ByaXZh
dGUsIGRwX2xpbmspOworCisJZGV2bV9rZnJlZShsaW5rLT5kZXYsIGxpbmspOworfQpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9saW5rLmggYi9kcml2ZXJzL2dwdS9kcm0v
bXNtL2RwL2RwX2xpbmsuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi42MDc5
MDRiCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9saW5rLmgK
QEAgLTAsMCArMSwxMzIgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9u
bHkgKi8KKy8qCisgKiBDb3B5cmlnaHQgKGMpIDIwMTItMjAxOSwgVGhlIExpbnV4IEZvdW5kYXRp
b24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuCisgKi8KKworI2lmbmRlZiBfRFBfTElOS19IXworI2Rl
ZmluZSBfRFBfTElOS19IXworCisjaW5jbHVkZSAiZHBfYXV4LmgiCisKKyNkZWZpbmUgRFNfUE9S
VF9TVEFUVVNfQ0hBTkdFRCAweDIwMAorI2RlZmluZSBEUF9URVNUX0JJVF9ERVBUSF9VTktOT1dO
IDB4RkZGRkZGRkYKKworZW51bSBkcF9saW5rX3ZvbHRhZ2VfbGV2ZWwgeworCURQX1RSQUlOX1ZP
TFRBR0VfU1dJTkdfTFZMXzAJPSAwLAorCURQX1RSQUlOX1ZPTFRBR0VfU1dJTkdfTFZMXzEJPSAx
LAorCURQX1RSQUlOX1ZPTFRBR0VfU1dJTkdfTFZMXzIJPSAyLAorCURQX1RSQUlOX1ZPTFRBR0Vf
U1dJTkdfTUFYCT0gRFBfVFJBSU5fVk9MVEFHRV9TV0lOR19MVkxfMiwKK307CisKK2VudW0gZHBf
bGlua19wcmVlbWFwaGFzaXNfbGV2ZWwgeworCURQX1RSQUlOX1BSRV9FTVBIQVNJU19MVkxfMAk9
IDAsCisJRFBfVFJBSU5fUFJFX0VNUEhBU0lTX0xWTF8xCT0gMSwKKwlEUF9UUkFJTl9QUkVfRU1Q
SEFTSVNfTFZMXzIJPSAyLAorCURQX1RSQUlOX1BSRV9FTVBIQVNJU19NQVgJPSBEUF9UUkFJTl9Q
UkVfRU1QSEFTSVNfTFZMXzIsCit9OworCitzdHJ1Y3QgZHBfbGlua190ZXN0X3ZpZGVvIHsKKwl1
MzIgdGVzdF92aWRlb19wYXR0ZXJuOworCXUzMiB0ZXN0X2JpdF9kZXB0aDsKKwl1MzIgdGVzdF9k
eW5fcmFuZ2U7CisJdTMyIHRlc3RfaF90b3RhbDsKKwl1MzIgdGVzdF92X3RvdGFsOworCXUzMiB0
ZXN0X2hfc3RhcnQ7CisJdTMyIHRlc3Rfdl9zdGFydDsKKwl1MzIgdGVzdF9oc3luY19wb2w7CisJ
dTMyIHRlc3RfaHN5bmNfd2lkdGg7CisJdTMyIHRlc3RfdnN5bmNfcG9sOworCXUzMiB0ZXN0X3Zz
eW5jX3dpZHRoOworCXUzMiB0ZXN0X2hfd2lkdGg7CisJdTMyIHRlc3Rfdl9oZWlnaHQ7CisJdTMy
IHRlc3RfcnJfZDsKKwl1MzIgdGVzdF9ycl9uOworfTsKKworc3RydWN0IGRwX2xpbmtfdGVzdF9h
dWRpbyB7CisJdTMyIHRlc3RfYXVkaW9fc2FtcGxpbmdfcmF0ZTsKKwl1MzIgdGVzdF9hdWRpb19j
aGFubmVsX2NvdW50OworCXUzMiB0ZXN0X2F1ZGlvX3BhdHRlcm5fdHlwZTsKKwl1MzIgdGVzdF9h
dWRpb19wZXJpb2RfY2hfMTsKKwl1MzIgdGVzdF9hdWRpb19wZXJpb2RfY2hfMjsKKwl1MzIgdGVz
dF9hdWRpb19wZXJpb2RfY2hfMzsKKwl1MzIgdGVzdF9hdWRpb19wZXJpb2RfY2hfNDsKKwl1MzIg
dGVzdF9hdWRpb19wZXJpb2RfY2hfNTsKKwl1MzIgdGVzdF9hdWRpb19wZXJpb2RfY2hfNjsKKwl1
MzIgdGVzdF9hdWRpb19wZXJpb2RfY2hfNzsKKwl1MzIgdGVzdF9hdWRpb19wZXJpb2RfY2hfODsK
K307CisKK3N0cnVjdCBkcF9saW5rX3BoeV9wYXJhbXMgeworCXUzMiBwaHlfdGVzdF9wYXR0ZXJu
X3NlbDsKKwl1OCB2X2xldmVsOworCXU4IHBfbGV2ZWw7Cit9OworCitzdHJ1Y3QgZHBfbGluayB7
CisJdTMyIHNpbmtfcmVxdWVzdDsKKwl1MzIgdGVzdF9yZXNwb25zZTsKKwlib29sIHBzbV9lbmFi
bGVkOworCisJdTggc2lua19jb3VudDsKKwlzdHJ1Y3QgZHBfbGlua190ZXN0X3ZpZGVvIHRlc3Rf
dmlkZW87CisJc3RydWN0IGRwX2xpbmtfdGVzdF9hdWRpbyB0ZXN0X2F1ZGlvOworCXN0cnVjdCBk
cF9saW5rX3BoeV9wYXJhbXMgcGh5X3BhcmFtczsKKwlzdHJ1Y3QgZHJtX2RwX2xpbmsgbGlua19w
YXJhbXM7Cit9OworCisvKioKKyAqIG1kc3NfZHBfdGVzdF9iaXRfZGVwdGhfdG9fYnBwKCkgLSBj
b252ZXJ0IHRlc3QgYml0IGRlcHRoIHRvIGJwcAorICogQHRiZDogdGVzdCBiaXQgZGVwdGgKKyAq
CisgKiBSZXR1cm5zIHRoZSBiaXRzIHBlciBwaXhlbCAoYnBwKSB0byBiZSB1c2VkIGNvcnJlc3Bv
bmRpbmcgdG8gdGhlCisgKiBnaXQgYml0IGRlcHRoIHZhbHVlLiBUaGlzIGZ1bmN0aW9uIGFzc3Vt
ZXMgdGhhdCBiaXQgZGVwdGggaGFzCisgKiBhbHJlYWR5IGJlZW4gdmFsaWRhdGVkLgorICovCitz
dGF0aWMgaW5saW5lIHUzMiBkcF9saW5rX2JpdF9kZXB0aF90b19icHAodTMyIHRiZCkKK3sKKwkv
KgorCSAqIEZldyBzaW1wbGlzdGljIHJ1bGVzIGFuZCBhc3N1bXB0aW9ucyBtYWRlIGhlcmU6CisJ
ICogICAgMS4gQml0IGRlcHRoIGlzIHBlciBjb2xvciBjb21wb25lbnQKKwkgKiAgICAyLiBJZiBi
aXQgZGVwdGggaXMgdW5rbm93biByZXR1cm4gMAorCSAqICAgIDMuIEFzc3VtZSAzIGNvbG9yIGNv
bXBvbmVudHMKKwkgKi8KKwlzd2l0Y2ggKHRiZCkgeworCWNhc2UgRFBfVEVTVF9CSVRfREVQVEhf
NjoKKwkJcmV0dXJuIDE4OworCWNhc2UgRFBfVEVTVF9CSVRfREVQVEhfODoKKwkJcmV0dXJuIDI0
OworCWNhc2UgRFBfVEVTVF9CSVRfREVQVEhfMTA6CisJCXJldHVybiAzMDsKKwljYXNlIERQX1RF
U1RfQklUX0RFUFRIX1VOS05PV046CisJZGVmYXVsdDoKKwkJcmV0dXJuIDA7CisJfQorfQorCit1
MzIgZHBfbGlua19nZXRfdGVzdF9iaXRzX2RlcHRoKHN0cnVjdCBkcF9saW5rICpkcF9saW5rLCB1
MzIgYnBwKTsKK2ludCBkcF9saW5rX3Byb2Nlc3NfcmVxdWVzdChzdHJ1Y3QgZHBfbGluayAqZHBf
bGluayk7CitpbnQgZHBfbGlua19nZXRfY29sb3JpbWV0cnlfY29uZmlnKHN0cnVjdCBkcF9saW5r
ICpkcF9saW5rKTsKK2ludCBkcF9saW5rX2FkanVzdF9sZXZlbHMoc3RydWN0IGRwX2xpbmsgKmRw
X2xpbmssIHU4ICpsaW5rX3N0YXR1cyk7Citib29sIGRwX2xpbmtfc2VuZF90ZXN0X3Jlc3BvbnNl
KHN0cnVjdCBkcF9saW5rICpkcF9saW5rKTsKK2ludCBkcF9saW5rX3BzbV9jb25maWcoc3RydWN0
IGRwX2xpbmsgKmRwX2xpbmssCisJCXN0cnVjdCBkcm1fZHBfbGluayAqbGlua19pbmZvLCBib29s
IGVuYWJsZSk7Citib29sIGRwX2xpbmtfc2VuZF9lZGlkX2NoZWNrc3VtKHN0cnVjdCBkcF9saW5r
ICpkcF9saW5rLCB1OCBjaGVja3N1bSk7CisKKy8qKgorICogZHBfbGlua19nZXQoKSAtIGdldCB0
aGUgZnVuY3Rpb25hbGl0aWVzIG9mIGRwIHRlc3QgbW9kdWxlCisgKgorICoKKyAqIHJldHVybjog
YSBwb2ludGVyIHRvIGRwX2xpbmsgc3RydWN0CisgKi8KK3N0cnVjdCBkcF9saW5rICpkcF9saW5r
X2dldChzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBkcF9hdXggKmF1eCk7CisKKy8qKgorICog
ZHBfbGlua19wdXQoKSAtIHJlbGVhc2VzIHRoZSBkcCB0ZXN0IG1vZHVsZSdzIHJlc291cmNlcwor
ICoKKyAqIEBkcF9saW5rOiBhbiBpbnN0YW5jZSBvZiBkcF9saW5rIG1vZHVsZQorICoKKyAqLwor
dm9pZCBkcF9saW5rX3B1dChzdHJ1Y3QgZHBfbGluayAqZHBfbGluayk7CisKKyNlbmRpZiAvKiBf
RFBfTElOS19IXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9wYW5l
bC5jIGIvZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9wYW5lbC5jCm5ldyBmaWxlIG1vZGUgMTAw
NjQ0CmluZGV4IDAwMDAwMDAuLmEzMTUwZjQKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dw
dS9kcm0vbXNtL2RwL2RwX3BhbmVsLmMKQEAgLTAsMCArMSw0NTAgQEAKKy8vIFNQRFgtTGljZW5z
ZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkKKy8qCisgKiBDb3B5cmlnaHQgKGMpIDIwMTItMjAx
OSwgVGhlIExpbnV4IEZvdW5kYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuCisgKi8KKworI2Rl
ZmluZSBwcl9mbXQoZm10KQkiW2RybS1kcF0gJXM6ICIgZm10LCBfX2Z1bmNfXworCisjaW5jbHVk
ZSAiZHBfcGFuZWwuaCIKKworI2luY2x1ZGUgPGRybS9kcm1fY29ubmVjdG9yLmg+CisjaW5jbHVk
ZSA8ZHJtL2RybV9lZGlkLmg+CisKKyNkZWZpbmUgRFBfTUFYX0RTX1BPUlRfQ09VTlQgMQorCitz
dHJ1Y3QgZHBfcGFuZWxfcHJpdmF0ZSB7CisJc3RydWN0IGRldmljZSAqZGV2OworCXN0cnVjdCBk
cF9wYW5lbCBkcF9wYW5lbDsKKwlzdHJ1Y3QgZHBfYXV4ICphdXg7CisJc3RydWN0IGRwX2xpbmsg
Kmxpbms7CisJc3RydWN0IGRwX2NhdGFsb2cgKmNhdGFsb2c7CisJYm9vbCBwYW5lbF9vbjsKKwli
b29sIGF1eF9jZmdfdXBkYXRlX2RvbmU7Cit9OworCitzdGF0aWMgaW50IGRwX3BhbmVsX3JlYWRf
ZHBjZChzdHJ1Y3QgZHBfcGFuZWwgKmRwX3BhbmVsKQoreworCWludCByYyA9IDA7CisJc2l6ZV90
IHJsZW47CisJc3RydWN0IGRwX3BhbmVsX3ByaXZhdGUgKnBhbmVsOworCXN0cnVjdCBkcm1fZHBf
bGluayAqbGlua19pbmZvOworCXU4ICpkcGNkLCBtYWpvciA9IDAsIG1pbm9yID0gMDsKKwl1MzIg
ZGZwX2NvdW50ID0gMDsKKworCWRwY2QgPSBkcF9wYW5lbC0+ZHBjZDsKKworCXBhbmVsID0gY29u
dGFpbmVyX29mKGRwX3BhbmVsLCBzdHJ1Y3QgZHBfcGFuZWxfcHJpdmF0ZSwgZHBfcGFuZWwpOwor
CWxpbmtfaW5mbyA9ICZkcF9wYW5lbC0+bGlua19pbmZvOworCXJjID0gZHJtX2RwX2xpbmtfcHJv
YmUocGFuZWwtPmF1eC0+ZHJtX2F1eCwgbGlua19pbmZvKTsKKwlpZiAocmMgPCAwKSB7CisJCURS
TV9FUlJPUigiZHJtX2RwX2xpbmtfcHJvYmUgY2FsbCBmYWlsZWQ6IHJjPSVkXG4iLCByYyk7CisJ
CXJldHVybiByYzsKKwl9CisJbWFqb3IgPSAobGlua19pbmZvLT5yZXZpc2lvbiA+PiA0KSAmIDB4
MGY7CisJbWlub3IgPSBsaW5rX2luZm8tPnJldmlzaW9uICYgMHgwZjsKKwlEUk1fREVCVUdfRFAo
InZlcnNpb246ICVkLiVkXG4iLCBtYWpvciwgbWlub3IpOworCURSTV9ERUJVR19EUCgibGlua19y
YXRlPSVkXG4iLCBsaW5rX2luZm8tPnJhdGUpOworCURSTV9ERUJVR19EUCgibGFuZV9jb3VudD0l
ZFxuIiwgbGlua19pbmZvLT5udW1fbGFuZXMpOworCisJcmxlbiA9IGRybV9kcF9kcGNkX3JlYWQo
cGFuZWwtPmF1eC0+ZHJtX2F1eCwgRFBfRFBDRF9SRVYsCisJCWRwY2QsIChEUF9SRUNFSVZFUl9D
QVBfU0laRSArIDEpKTsKKwlpZiAocmxlbiA8IDApIHsKKwkJRFJNX0VSUk9SKCJkcGNkIHJlYWQg
ZmFpbGVkLCBybGVuPSV6ZFxuIiwgcmxlbik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCWRm
cF9jb3VudCA9IGRwY2RbRFBfRE9XTl9TVFJFQU1fUE9SVF9DT1VOVF0gJgorCQkJCQkJRFBfRE9X
Tl9TVFJFQU1fUE9SVF9DT1VOVDsKKwlpZiAoZGZwX2NvdW50ID4gRFBfTUFYX0RTX1BPUlRfQ09V
TlQpIHsKKwkJRFJNX0VSUk9SKCJEUyBwb3J0IGNvdW50ICVkIGdyZWF0ZXIgdGhhdCBtYXggKCVk
KSBzdXBwb3J0ZWRcbiIsCisJCQlkZnBfY291bnQsIERQX01BWF9EU19QT1JUX0NPVU5UKTsKKwkJ
cmV0dXJuIC1FSU5WQUw7CisJfQorCXJldHVybiByYzsKK30KKworc3RhdGljIHUzMiBkcF9wYW5l
bF9nZXRfc3VwcG9ydGVkX2JwcChzdHJ1Y3QgZHBfcGFuZWwgKmRwX3BhbmVsLAorCQl1MzIgbW9k
ZV9lZGlkX2JwcCwgdTMyIG1vZGVfcGNsa19raHopCit7CisJc3RydWN0IGRybV9kcF9saW5rICps
aW5rX2luZm87CisJY29uc3QgdTMyIG1heF9zdXBwb3J0ZWRfYnBwID0gMzAsIG1pbl9zdXBwb3J0
ZWRfYnBwID0gMTg7CisJdTMyIGJwcCA9IDAsIGRhdGFfcmF0ZV9raHogPSAwOworCisJYnBwID0g
bWluX3QodTMyLCBtb2RlX2VkaWRfYnBwLCBtYXhfc3VwcG9ydGVkX2JwcCk7CisKKwlsaW5rX2lu
Zm8gPSAmZHBfcGFuZWwtPmxpbmtfaW5mbzsKKwlkYXRhX3JhdGVfa2h6ID0gbGlua19pbmZvLT5u
dW1fbGFuZXMgKiBsaW5rX2luZm8tPnJhdGUgKiA4OworCisJd2hpbGUgKGJwcCA+IG1pbl9zdXBw
b3J0ZWRfYnBwKSB7CisJCWlmIChtb2RlX3BjbGtfa2h6ICogYnBwIDw9IGRhdGFfcmF0ZV9raHop
CisJCQlicmVhazsKKwkJYnBwIC09IDY7CisJfQorCisJcmV0dXJuIGJwcDsKK30KKworc3RhdGlj
IHZvaWQgZHBfcGFuZWxfc2V0X3Rlc3RfbW9kZShzdHJ1Y3QgZHBfcGFuZWxfcHJpdmF0ZSAqcGFu
ZWwsCisJCXN0cnVjdCBkcF9kaXNwbGF5X21vZGUgKm1vZGUpCit7CisJc3RydWN0IGRybV9kaXNw
bGF5X21vZGUgKmRybV9tb2RlID0gTlVMTDsKKwlzdHJ1Y3QgZHBfbGlua190ZXN0X3ZpZGVvICp0
ZXN0X2luZm8gPSBOVUxMOworCisJZHJtX21vZGUgPSAmbW9kZS0+ZHJtX21vZGU7CisJdGVzdF9p
bmZvID0gJnBhbmVsLT5saW5rLT50ZXN0X3ZpZGVvOworCisJZHJtX21vZGUtPmhkaXNwbGF5ID0g
dGVzdF9pbmZvLT50ZXN0X2hfd2lkdGg7CisJZHJtX21vZGUtPmhzeW5jX3N0YXJ0ID0gZHJtX21v
ZGUtPmhkaXNwbGF5ICsgdGVzdF9pbmZvLT50ZXN0X2hfdG90YWwgLQorCQkJKHRlc3RfaW5mby0+
dGVzdF9oX3N0YXJ0ICsgdGVzdF9pbmZvLT50ZXN0X2hfd2lkdGgpOworCWRybV9tb2RlLT5oc3lu
Y19lbmQgPSBkcm1fbW9kZS0+aHN5bmNfc3RhcnQgKyB0ZXN0X2luZm8tPnRlc3RfaHN5bmNfd2lk
dGg7CisJZHJtX21vZGUtPmh0b3RhbCA9IGRybV9tb2RlLT5oc3luY19lbmQgKyB0ZXN0X2luZm8t
PnRlc3RfaF9zdGFydCAtCisJCQkJCQl0ZXN0X2luZm8tPnRlc3RfaHN5bmNfd2lkdGg7CisKKwlk
cm1fbW9kZS0+dmRpc3BsYXkgPSB0ZXN0X2luZm8tPnRlc3Rfdl9oZWlnaHQ7CisJZHJtX21vZGUt
PnZzeW5jX3N0YXJ0ID0gZHJtX21vZGUtPnZkaXNwbGF5ICsgdGVzdF9pbmZvLT50ZXN0X3ZfdG90
YWwgLQorCQkJKHRlc3RfaW5mby0+dGVzdF92X3N0YXJ0ICsgdGVzdF9pbmZvLT50ZXN0X3ZfaGVp
Z2h0KTsKKwlkcm1fbW9kZS0+dnN5bmNfZW5kID0gZHJtX21vZGUtPnZzeW5jX3N0YXJ0ICsgdGVz
dF9pbmZvLT50ZXN0X3ZzeW5jX3dpZHRoOworCWRybV9tb2RlLT52dG90YWwgPSBkcm1fbW9kZS0+
dnN5bmNfZW5kICsgdGVzdF9pbmZvLT50ZXN0X3Zfc3RhcnQgLQorCQkJCQkJdGVzdF9pbmZvLT50
ZXN0X3ZzeW5jX3dpZHRoOworCisJZHJtX21vZGUtPnZyZWZyZXNoID0gdGVzdF9pbmZvLT50ZXN0
X3JyX247CisJZHJtX21vZGUtPmNsb2NrID0gdGVzdF9pbmZvLT50ZXN0X2hfdG90YWwgKgorCQl0
ZXN0X2luZm8tPnRlc3Rfdl90b3RhbCAqIGRybV9tb2RlLT52cmVmcmVzaDsKKworCWRybV9tb2Rl
LT50eXBlID0gMHg0ODsKKwlkcm1fbW9kZV9zZXRfbmFtZShkcm1fbW9kZSk7CisKKwlpZiAodGVz
dF9pbmZvLT50ZXN0X3JyX2QgPT0gMCkKKwkJZHJtX21vZGUtPmNsb2NrIC89IDEwMDA7CisJZWxz
ZQorCQlkcm1fbW9kZS0+Y2xvY2sgLz0gMTAwMTsKKworCWlmICh0ZXN0X2luZm8tPnRlc3RfaF93
aWR0aCA9PSA2NDApCisJCWRybV9tb2RlLT5jbG9jayA9IDI1MTcwOworfQorCitzdGF0aWMgaW50
IGRwX3BhbmVsX3VwZGF0ZV9tb2RlcyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAor
CXN0cnVjdCBlZGlkICplZGlkKQoreworCWludCByYyA9IDA7CisKKwlpZiAoZWRpZCkgeworCQly
YyA9IGRybV9jb25uZWN0b3JfdXBkYXRlX2VkaWRfcHJvcGVydHkoY29ubmVjdG9yLCBlZGlkKTsK
KwkJaWYgKHJjKSB7CisJCQlEUk1fRVJST1IoImZhaWxlZCB0byB1cGRhdGUgZWRpZCBwcm9wZXJ0
eSAlZFxuIiwgcmMpOworCQkJcmV0dXJuIHJjOworCQl9CisJCXJjID0gZHJtX2FkZF9lZGlkX21v
ZGVzKGNvbm5lY3RvciwgZWRpZCk7CisJCURSTV9ERUJVR19EUCgiJXMgLSIsIF9fZnVuY19fKTsK
KwkJcmV0dXJuIHJjOworCX0KKworCXJjID0gZHJtX2Nvbm5lY3Rvcl91cGRhdGVfZWRpZF9wcm9w
ZXJ0eShjb25uZWN0b3IsIE5VTEwpOworCWlmIChyYykKKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8g
dXBkYXRlIGVkaWQgcHJvcGVydHkgJWRcbiIsIHJjKTsKKworCXJldHVybiByYzsKK30KKworaW50
IGRwX3BhbmVsX3JlYWRfc2lua19jYXBzKHN0cnVjdCBkcF9wYW5lbCAqZHBfcGFuZWwsCisJc3Ry
dWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKK3sKKwlpbnQgcmMgPSAwLCBid19jb2RlOwor
CXN0cnVjdCBkcF9wYW5lbF9wcml2YXRlICpwYW5lbDsKKworCWlmICghZHBfcGFuZWwgfHwgIWNv
bm5lY3RvcikgeworCQlEUk1fRVJST1IoImludmFsaWQgaW5wdXRcbiIpOworCQlyZXR1cm4gLUVJ
TlZBTDsKKwl9CisKKwlwYW5lbCA9IGNvbnRhaW5lcl9vZihkcF9wYW5lbCwgc3RydWN0IGRwX3Bh
bmVsX3ByaXZhdGUsIGRwX3BhbmVsKTsKKworCXJjID0gZHBfcGFuZWxfcmVhZF9kcGNkKGRwX3Bh
bmVsKTsKKwlid19jb2RlID0gZHJtX2RwX2xpbmtfcmF0ZV90b19id19jb2RlKGRwX3BhbmVsLT5s
aW5rX2luZm8ucmF0ZSk7CisJaWYgKHJjIHx8ICFpc19saW5rX3JhdGVfdmFsaWQoYndfY29kZSkg
fHwKKwkJCSFpc19sYW5lX2NvdW50X3ZhbGlkKGRwX3BhbmVsLT5saW5rX2luZm8ubnVtX2xhbmVz
KSB8fAorCQkJKGJ3X2NvZGUgPiBkcF9wYW5lbC0+bWF4X2J3X2NvZGUpKSB7CisJCURSTV9FUlJP
UigicmVhZCBkcGNkIGZhaWxlZCAlZFxuIiwgcmMpOworCQlyZXR1cm4gcmM7CisJfQorCXJjID0g
ZHJtX2RwX3JlYWRfZGVzYyhwYW5lbC0+YXV4LT5kcm1fYXV4LCAmZHBfcGFuZWwtPmRlc2MsCisJ
CQkgICAgICBkcm1fZHBfaXNfYnJhbmNoKGRwX3BhbmVsLT5kcGNkKSk7CisJaWYgKHJjKSB7CisJ
CURSTV9FUlJPUigicmVhZCBzaW5rL2JyYW5jaCBkZXNjcmlwdG9yIGZhaWxlZCAlZFxuIiwgcmMp
OworCQlyZXR1cm4gcmM7CisJfQorCisKKwlrZnJlZShkcF9wYW5lbC0+ZWRpZCk7CisJZHBfcGFu
ZWwtPmVkaWQgPSBkcm1fZ2V0X2VkaWQoY29ubmVjdG9yLAorCQkJCQkgICAgICAmcGFuZWwtPmF1
eC0+ZHJtX2F1eC0+ZGRjKTsKKwlpZiAoIWRwX3BhbmVsLT5lZGlkKSB7CisJCURSTV9FUlJPUigi
cGFuZWwgZWRpZCByZWFkIGZhaWxlZFxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCWlm
IChwYW5lbC0+YXV4X2NmZ191cGRhdGVfZG9uZSkgeworCQlEUk1fREVCVUdfRFAoInJlYWQgRFBD
RCB3aXRoIHVwZGF0ZWQgQVVYIGNvbmZpZ1xuIik7CisJCXJjID0gZHBfcGFuZWxfcmVhZF9kcGNk
KGRwX3BhbmVsKTsKKwkJYndfY29kZSA9IGRybV9kcF9saW5rX3JhdGVfdG9fYndfY29kZShkcF9w
YW5lbC0+bGlua19pbmZvLnJhdGUpOworCQlpZiAocmMgfHwgIWlzX2xpbmtfcmF0ZV92YWxpZChi
d19jb2RlKSB8fAorCQkJCSFpc19sYW5lX2NvdW50X3ZhbGlkKGRwX3BhbmVsLT5saW5rX2luZm8u
bnVtX2xhbmVzKSB8fAorCQkJCShid19jb2RlID4gZHBfcGFuZWwtPm1heF9id19jb2RlKSkgewor
CQkJRFJNX0VSUk9SKCJyZWFkIGRwY2QgZmFpbGVkICVkXG4iLCByYyk7CisJCQlyZXR1cm4gcmM7
CisJCX0KKwkJcGFuZWwtPmF1eF9jZmdfdXBkYXRlX2RvbmUgPSBmYWxzZTsKKwl9CisKKwlyZXR1
cm4gMDsKK30KKwordTMyIGRwX3BhbmVsX2dldF9tb2RlX2JwcChzdHJ1Y3QgZHBfcGFuZWwgKmRw
X3BhbmVsLAorCQl1MzIgbW9kZV9lZGlkX2JwcCwgdTMyIG1vZGVfcGNsa19raHopCit7CisJc3Ry
dWN0IGRwX3BhbmVsX3ByaXZhdGUgKnBhbmVsOworCXUzMiBicHAgPSBtb2RlX2VkaWRfYnBwOwor
CisJaWYgKCFkcF9wYW5lbCB8fCAhbW9kZV9lZGlkX2JwcCB8fCAhbW9kZV9wY2xrX2toeikgewor
CQlEUk1fRVJST1IoImludmFsaWQgaW5wdXRcbiIpOworCQlyZXR1cm4gMDsKKwl9CisKKwlwYW5l
bCA9IGNvbnRhaW5lcl9vZihkcF9wYW5lbCwgc3RydWN0IGRwX3BhbmVsX3ByaXZhdGUsIGRwX3Bh
bmVsKTsKKworCWlmIChkcF9wYW5lbC0+dmlkZW9fdGVzdCkKKwkJYnBwID0gZHBfbGlua19iaXRf
ZGVwdGhfdG9fYnBwKAorCQkJCXBhbmVsLT5saW5rLT50ZXN0X3ZpZGVvLnRlc3RfYml0X2RlcHRo
KTsKKwllbHNlCisJCWJwcCA9IGRwX3BhbmVsX2dldF9zdXBwb3J0ZWRfYnBwKGRwX3BhbmVsLCBt
b2RlX2VkaWRfYnBwLAorCQkJCW1vZGVfcGNsa19raHopOworCisJcmV0dXJuIGJwcDsKK30KKwor
aW50IGRwX3BhbmVsX2dldF9tb2RlcyhzdHJ1Y3QgZHBfcGFuZWwgKmRwX3BhbmVsLAorCXN0cnVj
dCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsIHN0cnVjdCBkcF9kaXNwbGF5X21vZGUgKm1vZGUp
Cit7CisJc3RydWN0IGRwX3BhbmVsX3ByaXZhdGUgKnBhbmVsOworCisJaWYgKCFkcF9wYW5lbCkg
eworCQlEUk1fRVJST1IoImludmFsaWQgaW5wdXRcbiIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9
CisKKwlwYW5lbCA9IGNvbnRhaW5lcl9vZihkcF9wYW5lbCwgc3RydWN0IGRwX3BhbmVsX3ByaXZh
dGUsIGRwX3BhbmVsKTsKKworCWlmIChkcF9wYW5lbC0+dmlkZW9fdGVzdCkgeworCQlkcF9wYW5l
bF9zZXRfdGVzdF9tb2RlKHBhbmVsLCBtb2RlKTsKKwkJcmV0dXJuIDE7CisJfSBlbHNlIGlmIChk
cF9wYW5lbC0+ZWRpZCkgeworCQlyZXR1cm4gZHBfcGFuZWxfdXBkYXRlX21vZGVzKGNvbm5lY3Rv
ciwgZHBfcGFuZWwtPmVkaWQpOworCX0KKworCXJldHVybiAwOworfQorCit1OCBkcF9wYW5lbF9n
ZXRfZWRpZF9jaGVja3N1bShzdHJ1Y3QgZWRpZCAqZWRpZCkKK3sKKwlzdHJ1Y3QgZWRpZCAqbGFz
dF9ibG9jazsKKwl1OCAqcmF3X2VkaWQ7CisJYm9vbCBpc19lZGlkX2NvcnJ1cHQ7CisKKwlpZiAo
IWVkaWQpIHsKKwkJRFJNX0VSUk9SKCJpbnZhbGlkIGVkaWQgaW5wdXRcbiIpOworCQlyZXR1cm4g
MDsKKwl9CisKKwlyYXdfZWRpZCA9ICh1OCAqKWVkaWQ7CisJcmF3X2VkaWQgKz0gKGVkaWQtPmV4
dGVuc2lvbnMgKiBFRElEX0xFTkdUSCk7CisJbGFzdF9ibG9jayA9IChzdHJ1Y3QgZWRpZCAqKXJh
d19lZGlkOworCisJLyogYmxvY2sgdHlwZSBleHRlbnNpb24gKi8KKwlkcm1fZWRpZF9ibG9ja192
YWxpZChyYXdfZWRpZCwgMSwgZmFsc2UsICZpc19lZGlkX2NvcnJ1cHQpOworCWlmICghaXNfZWRp
ZF9jb3JydXB0KQorCQlyZXR1cm4gbGFzdF9ibG9jay0+Y2hlY2tzdW07CisKKwlEUk1fRVJST1Io
IkludmFsaWQgYmxvY2ssIG5vIGNoZWNrc3VtXG4iKTsKKwlyZXR1cm4gMDsKK30KKwordm9pZCBk
cF9wYW5lbF9oYW5kbGVfc2lua19yZXF1ZXN0KHN0cnVjdCBkcF9wYW5lbCAqZHBfcGFuZWwpCit7
CisJc3RydWN0IGRwX3BhbmVsX3ByaXZhdGUgKnBhbmVsOworCisJaWYgKCFkcF9wYW5lbCkgewor
CQlEUk1fRVJST1IoImludmFsaWQgaW5wdXRcbiIpOworCQlyZXR1cm47CisJfQorCisJcGFuZWwg
PSBjb250YWluZXJfb2YoZHBfcGFuZWwsIHN0cnVjdCBkcF9wYW5lbF9wcml2YXRlLCBkcF9wYW5l
bCk7CisKKwlpZiAocGFuZWwtPmxpbmstPnNpbmtfcmVxdWVzdCAmIERQX1RFU1RfTElOS19FRElE
X1JFQUQpIHsKKwkJdTggY2hlY2tzdW0gPSBkcF9wYW5lbF9nZXRfZWRpZF9jaGVja3N1bShkcF9w
YW5lbC0+ZWRpZCk7CisKKwkJZHBfbGlua19zZW5kX2VkaWRfY2hlY2tzdW0ocGFuZWwtPmxpbmss
IGNoZWNrc3VtKTsKKwkJZHBfbGlua19zZW5kX3Rlc3RfcmVzcG9uc2UocGFuZWwtPmxpbmspOwor
CX0KK30KKwordm9pZCBkcF9wYW5lbF90cGdfY29uZmlnKHN0cnVjdCBkcF9wYW5lbCAqZHBfcGFu
ZWwsIGJvb2wgZW5hYmxlKQoreworCXN0cnVjdCBkcF9jYXRhbG9nICpjYXRhbG9nOworCXN0cnVj
dCBkcF9wYW5lbF9wcml2YXRlICpwYW5lbDsKKworCWlmICghZHBfcGFuZWwpIHsKKwkJRFJNX0VS
Uk9SKCJpbnZhbGlkIGlucHV0XG4iKTsKKwkJcmV0dXJuOworCX0KKworCXBhbmVsID0gY29udGFp
bmVyX29mKGRwX3BhbmVsLCBzdHJ1Y3QgZHBfcGFuZWxfcHJpdmF0ZSwgZHBfcGFuZWwpOworCWNh
dGFsb2cgPSBwYW5lbC0+Y2F0YWxvZzsKKworCWlmICghcGFuZWwtPnBhbmVsX29uKSB7CisJCURS
TV9ERUJVR19EUCgiRFAgcGFuZWwgbm90IGVuYWJsZWQsIGhhbmRsZSBUUEcgb24gbmV4dCBwYW5l
bCBvblxuIik7CisJCXJldHVybjsKKwl9CisKKwlpZiAoIWVuYWJsZSkgeworCQlkcF9jYXRhbG9n
X3BhbmVsX3RwZ19kaXNhYmxlKGNhdGFsb2cpOworCQlyZXR1cm47CisJfQorCisJRFJNX0RFQlVH
X0RQKCIlczogY2FsbGluZyBjYXRhbG9nIHRwZ19lbmFibGVcbiIsIF9fZnVuY19fKTsKKwlkcF9j
YXRhbG9nX3BhbmVsX3RwZ19lbmFibGUoY2F0YWxvZywgJnBhbmVsLT5kcF9wYW5lbC5kcF9tb2Rl
LmRybV9tb2RlKTsKK30KKworaW50IGRwX3BhbmVsX3RpbWluZ19jZmcoc3RydWN0IGRwX3BhbmVs
ICpkcF9wYW5lbCkKK3sKKwlpbnQgcmMgPSAwOworCXUzMiBkYXRhLCB0b3RhbF92ZXIsIHRvdGFs
X2hvcjsKKwlzdHJ1Y3QgZHBfY2F0YWxvZyAqY2F0YWxvZzsKKwlzdHJ1Y3QgZHBfcGFuZWxfcHJp
dmF0ZSAqcGFuZWw7CisJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmRybV9tb2RlOworCisJcGFu
ZWwgPSBjb250YWluZXJfb2YoZHBfcGFuZWwsIHN0cnVjdCBkcF9wYW5lbF9wcml2YXRlLCBkcF9w
YW5lbCk7CisJY2F0YWxvZyA9IHBhbmVsLT5jYXRhbG9nOworCWRybV9tb2RlID0gJnBhbmVsLT5k
cF9wYW5lbC5kcF9tb2RlLmRybV9tb2RlOworCisJRFJNX0RFQlVHX0RQKCJ3aWR0aD0lZCBocG9y
Y2g9ICVkICVkICVkXG4iLAorCQlkcm1fbW9kZS0+aGRpc3BsYXksIGRybV9tb2RlLT5odG90YWwg
LSBkcm1fbW9kZS0+aHN5bmNfZW5kLAorCQlkcm1fbW9kZS0+aHN5bmNfc3RhcnQgLSBkcm1fbW9k
ZS0+aGRpc3BsYXksCisJCWRybV9tb2RlLT5oc3luY19lbmQgLSBkcm1fbW9kZS0+aHN5bmNfc3Rh
cnQpOworCisJRFJNX0RFQlVHX0RQKCJoZWlnaHQ9JWQgdnBvcmNoPSAlZCAlZCAlZFxuIiwKKwkJ
ZHJtX21vZGUtPnZkaXNwbGF5LCBkcm1fbW9kZS0+dnRvdGFsIC0gZHJtX21vZGUtPnZzeW5jX2Vu
ZCwKKwkJZHJtX21vZGUtPnZzeW5jX3N0YXJ0IC0gZHJtX21vZGUtPnZkaXNwbGF5LAorCQlkcm1f
bW9kZS0+dnN5bmNfZW5kIC0gZHJtX21vZGUtPnZzeW5jX3N0YXJ0KTsKKworCXRvdGFsX2hvciA9
IGRybV9tb2RlLT5odG90YWw7CisKKwl0b3RhbF92ZXIgPSBkcm1fbW9kZS0+dnRvdGFsOworCisJ
ZGF0YSA9IHRvdGFsX3ZlcjsKKwlkYXRhIDw8PSAxNjsKKwlkYXRhIHw9IHRvdGFsX2hvcjsKKwor
CWNhdGFsb2ctPnRvdGFsID0gZGF0YTsKKworCWRhdGEgPSAoZHJtX21vZGUtPnZ0b3RhbCAtIGRy
bV9tb2RlLT52c3luY19zdGFydCk7CisJZGF0YSA8PD0gMTY7CisJZGF0YSB8PSAoZHJtX21vZGUt
Pmh0b3RhbCAtIGRybV9tb2RlLT5oc3luY19zdGFydCk7CisKKwljYXRhbG9nLT5zeW5jX3N0YXJ0
ID0gZGF0YTsKKworCWRhdGEgPSBkcm1fbW9kZS0+dnN5bmNfZW5kIC0gZHJtX21vZGUtPnZzeW5j
X3N0YXJ0OworCWRhdGEgPDw9IDE2OworCWRhdGEgfD0gKHBhbmVsLT5kcF9wYW5lbC5kcF9tb2Rl
LnZfYWN0aXZlX2xvdyA8PCAzMSk7CisJZGF0YSB8PSBkcm1fbW9kZS0+aHN5bmNfZW5kIC0gZHJt
X21vZGUtPmhzeW5jX3N0YXJ0OworCWRhdGEgfD0gKHBhbmVsLT5kcF9wYW5lbC5kcF9tb2RlLmhf
YWN0aXZlX2xvdyA8PCAxNSk7CisKKwljYXRhbG9nLT53aWR0aF9ibGFua2luZyA9IGRhdGE7CisK
KwlkYXRhID0gZHJtX21vZGUtPnZkaXNwbGF5OworCWRhdGEgPDw9IDE2OworCWRhdGEgfD0gZHJt
X21vZGUtPmhkaXNwbGF5OworCisJY2F0YWxvZy0+ZHBfYWN0aXZlID0gZGF0YTsKKworCWRwX2Nh
dGFsb2dfcGFuZWxfdGltaW5nX2NmZyhjYXRhbG9nKTsKKwlwYW5lbC0+cGFuZWxfb24gPSB0cnVl
OworCisJcmV0dXJuIHJjOworfQorCitpbnQgZHBfcGFuZWxfaW5pdF9wYW5lbF9pbmZvKHN0cnVj
dCBkcF9wYW5lbCAqZHBfcGFuZWwpCit7CisJaW50IHJjID0gMDsKKwlzdHJ1Y3QgZHJtX2Rpc3Bs
YXlfbW9kZSAqZHJtX21vZGU7CisKKwlkcm1fbW9kZSA9ICZkcF9wYW5lbC0+ZHBfbW9kZS5kcm1f
bW9kZTsKKworCS8qCisJICogcHJpbnQgcmVzb2x1dGlvbiBpbmZvIGFzIHRoaXMgaXMgYSByZXN1
bHQKKwkgKiBvZiB1c2VyIGluaXRpYXRlZCBhY3Rpb24gb2YgY2FibGUgY29ubmVjdGlvbgorCSAq
LworCURSTV9ERUJVR19EUCgiU0VUIE5FVyBSRVNPTFVUSU9OOlxuIik7CisJRFJNX0RFQlVHX0RQ
KCIlZHglZEAlZGZwc1xuIiwgZHJtX21vZGUtPmhkaXNwbGF5LAorCQlkcm1fbW9kZS0+dmRpc3Bs
YXksIGRybV9tb2RlLT52cmVmcmVzaCk7CisJRFJNX0RFQlVHX0RQKCJoX3BvcmNoZXMoYmFja3xm
cm9udHx3aWR0aCkgPSAoJWR8JWR8JWQpXG4iLAorCQkJZHJtX21vZGUtPmh0b3RhbCAtIGRybV9t
b2RlLT5oc3luY19lbmQsCisJCQlkcm1fbW9kZS0+aHN5bmNfc3RhcnQgLSBkcm1fbW9kZS0+aGRp
c3BsYXksCisJCQlkcm1fbW9kZS0+aHN5bmNfZW5kIC0gZHJtX21vZGUtPmhzeW5jX3N0YXJ0KTsK
KwlEUk1fREVCVUdfRFAoInZfcG9yY2hlcyhiYWNrfGZyb250fHdpZHRoKSA9ICglZHwlZHwlZClc
biIsCisJCQlkcm1fbW9kZS0+dnRvdGFsIC0gZHJtX21vZGUtPnZzeW5jX2VuZCwKKwkJCWRybV9t
b2RlLT52c3luY19zdGFydCAtIGRybV9tb2RlLT52ZGlzcGxheSwKKwkJCWRybV9tb2RlLT52c3lu
Y19lbmQgLSBkcm1fbW9kZS0+dnN5bmNfc3RhcnQpOworCURSTV9ERUJVR19EUCgicGl4ZWwgY2xv
Y2sgKEtIeik9KCVkKVxuIiwgZHJtX21vZGUtPmNsb2NrKTsKKwlEUk1fREVCVUdfRFAoImJwcCA9
ICVkXG4iLCBkcF9wYW5lbC0+ZHBfbW9kZS5icHApOworCisJZHBfcGFuZWwtPmRwX21vZGUuYnBw
ID0gbWF4X3QodTMyLCAxOCwgbWluX3QodTMyLCBkcF9wYW5lbC0+ZHBfbW9kZS5icHAsIDMwKSk7
CisJRFJNX0RFQlVHX0RQKCJ1cGRhdGVkIGJwcCA9ICVkXG4iLCBkcF9wYW5lbC0+ZHBfbW9kZS5i
cHApOworCisJcmV0dXJuIHJjOworfQorCitzdHJ1Y3QgZHBfcGFuZWwgKmRwX3BhbmVsX2dldChz
dHJ1Y3QgZHBfcGFuZWxfaW4gKmluKQoreworCWludCByYyA9IDA7CisJc3RydWN0IGRwX3BhbmVs
X3ByaXZhdGUgKnBhbmVsOworCXN0cnVjdCBkcF9wYW5lbCAqZHBfcGFuZWw7CisKKwlpZiAoIWlu
LT5kZXYgfHwgIWluLT5jYXRhbG9nIHx8ICFpbi0+YXV4IHx8ICFpbi0+bGluaykgeworCQlEUk1f
RVJST1IoImludmFsaWQgaW5wdXRcbiIpOworCQlyYyA9IC1FSU5WQUw7CisJCWdvdG8gZXJyb3I7
CisJfQorCisJcGFuZWwgPSBkZXZtX2t6YWxsb2MoaW4tPmRldiwgc2l6ZW9mKCpwYW5lbCksIEdG
UF9LRVJORUwpOworCWlmICghcGFuZWwpIHsKKwkJcmMgPSAtRU5PTUVNOworCQlnb3RvIGVycm9y
OworCX0KKworCXBhbmVsLT5kZXYgPSBpbi0+ZGV2OworCXBhbmVsLT5hdXggPSBpbi0+YXV4Owor
CXBhbmVsLT5jYXRhbG9nID0gaW4tPmNhdGFsb2c7CisJcGFuZWwtPmxpbmsgPSBpbi0+bGluazsK
KworCWRwX3BhbmVsID0gJnBhbmVsLT5kcF9wYW5lbDsKKwlkcF9wYW5lbC0+bWF4X2J3X2NvZGUg
PSBEUF9MSU5LX0JXXzhfMTsKKwlwYW5lbC0+YXV4X2NmZ191cGRhdGVfZG9uZSA9IGZhbHNlOwor
CisJcmV0dXJuIGRwX3BhbmVsOworZXJyb3I6CisJcmV0dXJuIEVSUl9QVFIocmMpOworfQorCit2
b2lkIGRwX3BhbmVsX3B1dChzdHJ1Y3QgZHBfcGFuZWwgKmRwX3BhbmVsKQoreworCXN0cnVjdCBk
cF9wYW5lbF9wcml2YXRlICpwYW5lbDsKKworCWlmICghZHBfcGFuZWwpCisJCXJldHVybjsKKwor
CXBhbmVsID0gY29udGFpbmVyX29mKGRwX3BhbmVsLCBzdHJ1Y3QgZHBfcGFuZWxfcHJpdmF0ZSwg
ZHBfcGFuZWwpOworCisJa2ZyZWUoZHBfcGFuZWwtPmVkaWQpOworCWRwX3BhbmVsLT5lZGlkID0g
TlVMTDsKKwlkZXZtX2tmcmVlKHBhbmVsLT5kZXYsIHBhbmVsKTsKK30KZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfcGFuZWwuaCBiL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAv
ZHBfcGFuZWwuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi42OGM1NjUwCi0t
LSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9wYW5lbC5oCkBAIC0w
LDAgKzEsOTIgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkgKi8K
Ky8qCisgKiBDb3B5cmlnaHQgKGMpIDIwMTItMjAxOSwgVGhlIExpbnV4IEZvdW5kYXRpb24uIEFs
bCByaWdodHMgcmVzZXJ2ZWQuCisgKi8KKworI2lmbmRlZiBfRFBfUEFORUxfSF8KKyNkZWZpbmUg
X0RQX1BBTkVMX0hfCisKKyNpbmNsdWRlIDxkcm0vbXNtX2RybS5oPgorCisjaW5jbHVkZSAiZHBf
YXV4LmgiCisjaW5jbHVkZSAiZHBfbGluay5oIgorI2luY2x1ZGUgImRwX2V4dGNvbi5oIgorCitz
dHJ1Y3QgZWRpZDsKKworI2RlZmluZSBEUF9NQVhfRE9XTlNUUkVBTV9QT1JUUyAweDEwCisKK3N0
cnVjdCBkcF9kaXNwbGF5X21vZGUgeworCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlIGRybV9tb2Rl
OworCXUzMiBjYXBhYmlsaXRpZXM7CisJdTMyIGJwcDsKKwl1MzIgaF9hY3RpdmVfbG93OworCXUz
MiB2X2FjdGl2ZV9sb3c7Cit9OworCitzdHJ1Y3QgZHBfcGFuZWxfaW4geworCXN0cnVjdCBkZXZp
Y2UgKmRldjsKKwlzdHJ1Y3QgZHBfYXV4ICphdXg7CisJc3RydWN0IGRwX2xpbmsgKmxpbms7CisJ
c3RydWN0IGRwX2NhdGFsb2cgKmNhdGFsb2c7Cit9OworCitzdHJ1Y3QgZHBfcGFuZWwgeworCS8q
IGRwY2QgcmF3IGRhdGEgKi8KKwl1OCBkcGNkW0RQX1JFQ0VJVkVSX0NBUF9TSVpFICsgMV07CisK
KwlzdHJ1Y3QgZHJtX2RwX2xpbmsgbGlua19pbmZvOworCXN0cnVjdCBkcm1fZHBfZGVzYyBkZXNj
OworCXN0cnVjdCBlZGlkICplZGlkOworCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3I7
CisJc3RydWN0IGRwX2Rpc3BsYXlfbW9kZSBkcF9tb2RlOworCWJvb2wgdmlkZW9fdGVzdDsKKwor
CXUzMiB2aWM7CisJdTMyIG1heF9wY2xrX2toejsKKworCXUzMiBtYXhfYndfY29kZTsKK307CisK
K2ludCBkcF9wYW5lbF9pbml0X3BhbmVsX2luZm8oc3RydWN0IGRwX3BhbmVsICpkcF9wYW5lbCk7
CitpbnQgZHBfcGFuZWxfZGVpbml0KHN0cnVjdCBkcF9wYW5lbCAqZHBfcGFuZWwpOworaW50IGRw
X3BhbmVsX3RpbWluZ19jZmcoc3RydWN0IGRwX3BhbmVsICpkcF9wYW5lbCk7CitpbnQgZHBfcGFu
ZWxfcmVhZF9zaW5rX2NhcHMoc3RydWN0IGRwX3BhbmVsICpkcF9wYW5lbCwKKwkJc3RydWN0IGRy
bV9jb25uZWN0b3IgKmNvbm5lY3Rvcik7Cit1MzIgZHBfcGFuZWxfZ2V0X21vZGVfYnBwKHN0cnVj
dCBkcF9wYW5lbCAqZHBfcGFuZWwsIHUzMiBtb2RlX21heF9icHAsCisJCQl1MzIgbW9kZV9wY2xr
X2toeik7CitpbnQgZHBfcGFuZWxfZ2V0X21vZGVzKHN0cnVjdCBkcF9wYW5lbCAqZHBfcGFuZWws
CisJCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsIHN0cnVjdCBkcF9kaXNwbGF5X21v
ZGUgKm1vZGUpOwordm9pZCBkcF9wYW5lbF9oYW5kbGVfc2lua19yZXF1ZXN0KHN0cnVjdCBkcF9w
YW5lbCAqZHBfcGFuZWwpOwordm9pZCBkcF9wYW5lbF90cGdfY29uZmlnKHN0cnVjdCBkcF9wYW5l
bCAqZHBfcGFuZWwsIGJvb2wgZW5hYmxlKTsKKworLyoqCisgKiBpc19saW5rX3JhdGVfdmFsaWQo
KSAtIHZhbGlkYXRlcyB0aGUgbGluayByYXRlCisgKiBAbGFuZV9yYXRlOiBsaW5rIHJhdGUgcmVx
dWVzdGVkIGJ5IHRoZSBzaW5rCisgKgorICogUmV0dXJucyB0cnVlIGlmIHRoZSByZXF1ZXN0ZWQg
bGluayByYXRlIGlzIHN1cHBvcnRlZC4KKyAqLworc3RhdGljIGlubGluZSBib29sIGlzX2xpbmtf
cmF0ZV92YWxpZCh1MzIgYndfY29kZSkKK3sKKwlyZXR1cm4gKGJ3X2NvZGUgPT0gRFBfTElOS19C
V18xXzYyIHx8CisJCWJ3X2NvZGUgPT0gRFBfTElOS19CV18yXzcgfHwKKwkJYndfY29kZSA9PSBE
UF9MSU5LX0JXXzVfNCB8fAorCQlid19jb2RlID09IERQX0xJTktfQldfOF8xKTsKK30KKworLyoq
CisgKiBkcF9saW5rX2lzX2xhbmVfY291bnRfdmFsaWQoKSAtIHZhbGlkYXRlcyB0aGUgbGFuZSBj
b3VudAorICogQGxhbmVfY291bnQ6IGxhbmUgY291bnQgcmVxdWVzdGVkIGJ5IHRoZSBzaW5rCisg
KgorICogUmV0dXJucyB0cnVlIGlmIHRoZSByZXF1ZXN0ZWQgbGFuZSBjb3VudCBpcyBzdXBwb3J0
ZWQuCisgKi8KK3N0YXRpYyBpbmxpbmUgYm9vbCBpc19sYW5lX2NvdW50X3ZhbGlkKHUzMiBsYW5l
X2NvdW50KQoreworCXJldHVybiAobGFuZV9jb3VudCA9PSAxIHx8CisJCWxhbmVfY291bnQgPT0g
MiB8fAorCQlsYW5lX2NvdW50ID09IDQpOworfQorCitzdHJ1Y3QgZHBfcGFuZWwgKmRwX3BhbmVs
X2dldChzdHJ1Y3QgZHBfcGFuZWxfaW4gKmluKTsKK3ZvaWQgZHBfcGFuZWxfcHV0KHN0cnVjdCBk
cF9wYW5lbCAqZHBfcGFuZWwpOworI2VuZGlmIC8qIF9EUF9QQU5FTF9IXyAqLwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9wYXJzZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9t
c20vZHAvZHBfcGFyc2VyLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uM2Zh
MmExZgotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfcGFyc2Vy
LmMKQEAgLTAsMCArMSw0OTYgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4w
LW9ubHkKKy8qCisgKiBDb3B5cmlnaHQgKGMpIDIwMTItMjAxOSwgVGhlIExpbnV4IEZvdW5kYXRp
b24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuCisgKi8KKworI2RlZmluZSBwcl9mbXQoZm10KQkiW2Ry
bS1kcF0gJXM6ICIgZm10LCBfX2Z1bmNfXworCisjaW5jbHVkZSA8bGludXgvb2ZfZ3Bpby5oPgor
CisjaW5jbHVkZSAiZHBfcGFyc2VyLmgiCisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHBfcmVndWxh
dG9yX2NmZyBzZG04NDVfZHBfcmVnX2NmZyA9IHsKKwkubnVtID0gMiwKKwkucmVncyA9IHsKKwkJ
eyJ2ZGRhLTFwMiIsIDIxODAwLCA0IH0sCS8qIDEuMiBWICovCisJCXsidmRkYS0wcDkiLCAzNjAw
MCwgMzIgfSwJLyogMC45IFYgKi8KKwl9LAorfTsKKworc3RhdGljIGludCBtc21fZHNzX2lvcmVt
YXBfYnluYW1lKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYsCisJCQkgICBzdHJ1Y3QgZHNz
X2lvX2RhdGEgKmlvX2RhdGEsIGNvbnN0IGNoYXIgKm5hbWUpCit7CisJc3RydWN0IHJlc291cmNl
ICpyZXMgPSBOVUxMOworCisJaWYgKCFpb19kYXRhKSB7CisJCURSTV9FUlJPUigiJXBTLT4lczog
aW52YWxpZCBpbnB1dFxuIiwKKwkJCV9fYnVpbHRpbl9yZXR1cm5fYWRkcmVzcygwKSwgX19mdW5j
X18pOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlyZXMgPSBwbGF0Zm9ybV9nZXRfcmVzb3Vy
Y2VfYnluYW1lKHBkZXYsIElPUkVTT1VSQ0VfTUVNLCBuYW1lKTsKKwlpZiAoIXJlcykgeworCQlE
Uk1fRVJST1IoIiVwUy0+JXM6ICclcycgbXNtX2Rzc19nZXRfcmVzX2J5bmFtZSBmYWlsZWRcbiIs
CisJCQlfX2J1aWx0aW5fcmV0dXJuX2FkZHJlc3MoMCksIF9fZnVuY19fLCBuYW1lKTsKKwkJcmV0
dXJuIC1FTk9ERVY7CisJfQorCisJaW9fZGF0YS0+bGVuID0gKHUzMilyZXNvdXJjZV9zaXplKHJl
cyk7CisJaW9fZGF0YS0+YmFzZSA9IGlvcmVtYXAocmVzLT5zdGFydCwgaW9fZGF0YS0+bGVuKTsK
KwlpZiAoIWlvX2RhdGEtPmJhc2UpIHsKKwkJRFJNX0VSUk9SKCIlcFMtPiVzOiAnJXMnIGlvcmVt
YXAgZmFpbGVkXG4iLAorCQkJX19idWlsdGluX3JldHVybl9hZGRyZXNzKDApLCBfX2Z1bmNfXywg
bmFtZSk7CisJCXJldHVybiAtRUlPOworCX0KKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9p
ZCBtc21fZHNzX2lvdW5tYXAoc3RydWN0IGRzc19pb19kYXRhICppb19kYXRhKQoreworCWlmICgh
aW9fZGF0YSkgeworCQlEUk1fRVJST1IoIiVwUy0+JXM6IGludmFsaWQgaW5wdXRcbiIsCisJCQlf
X2J1aWx0aW5fcmV0dXJuX2FkZHJlc3MoMCksIF9fZnVuY19fKTsKKwkJcmV0dXJuOworCX0KKwor
CWlmIChpb19kYXRhLT5iYXNlKSB7CisJCWlvdW5tYXAoaW9fZGF0YS0+YmFzZSk7CisJCWlvX2Rh
dGEtPmJhc2UgPSBOVUxMOworCX0KKwlpb19kYXRhLT5sZW4gPSAwOworfQorCitzdGF0aWMgdm9p
ZCBkcF9wYXJzZXJfdW5tYXBfaW9fcmVzb3VyY2VzKHN0cnVjdCBkcF9wYXJzZXIgKnBhcnNlcikK
K3sKKwlzdHJ1Y3QgZHBfaW8gKmlvID0gJnBhcnNlci0+aW87CisKKwltc21fZHNzX2lvdW5tYXAo
JmlvLT5kcF9haGIpOworCW1zbV9kc3NfaW91bm1hcCgmaW8tPmRwX2F1eCk7CisJbXNtX2Rzc19p
b3VubWFwKCZpby0+ZHBfbGluayk7CisJbXNtX2Rzc19pb3VubWFwKCZpby0+ZHBfcDApOworCW1z
bV9kc3NfaW91bm1hcCgmaW8tPnBoeV9pbyk7CisJbXNtX2Rzc19pb3VubWFwKCZpby0+bG5fdHgw
X2lvKTsKKwltc21fZHNzX2lvdW5tYXAoJmlvLT5sbl90eDBfaW8pOworCW1zbV9kc3NfaW91bm1h
cCgmaW8tPmRwX3BsbF9pbyk7CisJbXNtX2Rzc19pb3VubWFwKCZpby0+ZHBfY2NfaW8pOworCW1z
bV9kc3NfaW91bm1hcCgmaW8tPnVzYjNfZHBfY29tKTsKKwltc21fZHNzX2lvdW5tYXAoJmlvLT5x
ZnByb21faW8pOworfQorCitzdGF0aWMgaW50IGRwX3BhcnNlcl9jdHJsX3JlcyhzdHJ1Y3QgZHBf
cGFyc2VyICpwYXJzZXIpCit7CisJaW50IHJjID0gMDsKKwl1MzIgaW5kZXg7CisJc3RydWN0IHBs
YXRmb3JtX2RldmljZSAqcGRldiA9IHBhcnNlci0+cGRldjsKKwlzdHJ1Y3QgZGV2aWNlX25vZGUg
Km9mX25vZGUgPSBwYXJzZXItPnBkZXYtPmRldi5vZl9ub2RlOworCXN0cnVjdCBkcF9pbyAqaW8g
PSAmcGFyc2VyLT5pbzsKKworCXJjID0gb2ZfcHJvcGVydHlfcmVhZF91MzIob2Zfbm9kZSwgImNl
bGwtaW5kZXgiLCAmaW5kZXgpOworCWlmIChyYykgeworCQlEUk1fRVJST1IoImNlbGwtaW5kZXgg
bm90IHNwZWNpZmllZCwgcmM9JWRcbiIsIHJjKTsKKwkJcmV0dXJuIHJjOworCX0KKworCXJjID0g
bXNtX2Rzc19pb3JlbWFwX2J5bmFtZShwZGV2LCAmaW8tPmRwX2FoYiwgImRwX2FoYiIpOworCWlm
IChyYykgeworCQlEUk1fRVJST1IoInVuYWJsZSB0byByZW1hcCBkcCBpbyByZXNvdXJjZXMsIHJj
PSVkXG4iLCByYyk7CisJCWdvdG8gZXJyOworCX0KKworCXJjID0gbXNtX2Rzc19pb3JlbWFwX2J5
bmFtZShwZGV2LCAmaW8tPmRwX2F1eCwgImRwX2F1eCIpOworCWlmIChyYykgeworCQlEUk1fRVJS
T1IoInVuYWJsZSB0byByZW1hcCBkcCBpbyByZXNvdXJjZXMsIHJjPSVkXG4iLCByYyk7CisJCWdv
dG8gZXJyOworCX0KKworCXJjID0gbXNtX2Rzc19pb3JlbWFwX2J5bmFtZShwZGV2LCAmaW8tPmRw
X2xpbmssICJkcF9saW5rIik7CisJaWYgKHJjKSB7CisJCURSTV9FUlJPUigidW5hYmxlIHRvIHJl
bWFwIGRwIGlvIHJlc291cmNlcywgcmM9JWRcbiIsIHJjKTsKKwkJZ290byBlcnI7CisJfQorCisJ
cmMgPSBtc21fZHNzX2lvcmVtYXBfYnluYW1lKHBkZXYsICZpby0+ZHBfcDAsICJkcF9wMCIpOwor
CWlmIChyYykgeworCQlEUk1fRVJST1IoInVuYWJsZSB0byByZW1hcCBkcCBpbyByZXNvdXJjZXMs
IHJjPSVkXG4iLCByYyk7CisJCWdvdG8gZXJyOworCX0KKworCXJjID0gbXNtX2Rzc19pb3JlbWFw
X2J5bmFtZShwZGV2LCAmaW8tPnBoeV9pbywgImRwX3BoeSIpOworCWlmIChyYykgeworCQlEUk1f
RVJST1IoInVuYWJsZSB0byByZW1hcCBkcCBQSFkgcmVzb3VyY2VzLCByYz0lZFxuIiwgcmMpOwor
CQlnb3RvIGVycjsKKwl9CisKKwlyYyA9IG1zbV9kc3NfaW9yZW1hcF9ieW5hbWUocGRldiwgJmlv
LT5sbl90eDBfaW8sICJkcF9sbl90eDAiKTsKKwlpZiAocmMpIHsKKwkJRFJNX0VSUk9SKCJ1bmFi
bGUgdG8gcmVtYXAgZHAgVFgwIHJlc291cmNlcywgcmM9JWRcbiIsIHJjKTsKKwkJZ290byBlcnI7
CisJfQorCisJcmMgPSBtc21fZHNzX2lvcmVtYXBfYnluYW1lKHBkZXYsICZpby0+bG5fdHgxX2lv
LCAiZHBfbG5fdHgxIik7CisJaWYgKHJjKSB7CisJCURSTV9FUlJPUigidW5hYmxlIHRvIHJlbWFw
IGRwIFRYMSByZXNvdXJjZXMsIHJjPSVkXG4iLCByYyk7CisJCWdvdG8gZXJyOworCX0KKworCXJj
ID0gbXNtX2Rzc19pb3JlbWFwX2J5bmFtZShwZGV2LCAmaW8tPmRwX3BsbF9pbywgImRwX3BsbCIp
OworCWlmIChyYykgeworCQlEUk1fRVJST1IoInVuYWJsZSB0byByZW1hcCBEUCBQTEwgcmVzb3Vy
Y2VzLCByYz0lZFxuIiwgcmMpOworCQlnb3RvIGVycjsKKwl9CisKKwlyYyA9IG1zbV9kc3NfaW9y
ZW1hcF9ieW5hbWUocGRldiwgJmlvLT51c2IzX2RwX2NvbSwgInVzYjNfZHBfY29tIik7CisJaWYg
KHJjKSB7CisJCURSTV9FUlJPUigidW5hYmxlIHRvIHJlbWFwIFVTQjMgRFAgY29tIHJlc291cmNl
cywgcmM9JWRcbiIsIHJjKTsKKwkJZ290byBlcnI7CisJfQorCisJcmMgPSBtc21fZHNzX2lvcmVt
YXBfYnluYW1lKHBkZXYsICZpby0+ZHBfY2NfaW8sICJkcF9tbXNzX2NjIik7CisJaWYgKHJjKSB7
CisJCURSTV9FUlJPUigidW5hYmxlIHRvIHJlbWFwIGRwIE1NU1NfQ0MgcmVzb3VyY2VzXG4iKTsK
KwkJZ290byBlcnI7CisJfQorCisJaWYgKG1zbV9kc3NfaW9yZW1hcF9ieW5hbWUocGRldiwgJmlv
LT5xZnByb21faW8sICJxZnByb21fcGh5c2ljYWwiKSkKKwkJcHJfd2FybigidW5hYmxlIHRvIHJl
bWFwIGRwIHFmcHJvbSByZXNvdXJjZXNcbiIpOworCisJcmV0dXJuIDA7CitlcnI6CisJZHBfcGFy
c2VyX3VubWFwX2lvX3Jlc291cmNlcyhwYXJzZXIpOworCXJldHVybiByYzsKK30KKworc3RhdGlj
IGNvbnN0IGNoYXIgKmRwX2dldF9waHlfYXV4X2NvbmZpZ19wcm9wZXJ0eSh1MzIgY2ZnX3R5cGUp
Cit7CisJc3dpdGNoIChjZmdfdHlwZSkgeworCWNhc2UgUEhZX0FVWF9DRkcwOgorCQlyZXR1cm4g
InFjb20sYXV4LWNmZzAtc2V0dGluZ3MiOworCWNhc2UgUEhZX0FVWF9DRkcxOgorCQlyZXR1cm4g
InFjb20sYXV4LWNmZzEtc2V0dGluZ3MiOworCWNhc2UgUEhZX0FVWF9DRkcyOgorCQlyZXR1cm4g
InFjb20sYXV4LWNmZzItc2V0dGluZ3MiOworCWNhc2UgUEhZX0FVWF9DRkczOgorCQlyZXR1cm4g
InFjb20sYXV4LWNmZzMtc2V0dGluZ3MiOworCWNhc2UgUEhZX0FVWF9DRkc0OgorCQlyZXR1cm4g
InFjb20sYXV4LWNmZzQtc2V0dGluZ3MiOworCWNhc2UgUEhZX0FVWF9DRkc1OgorCQlyZXR1cm4g
InFjb20sYXV4LWNmZzUtc2V0dGluZ3MiOworCWNhc2UgUEhZX0FVWF9DRkc2OgorCQlyZXR1cm4g
InFjb20sYXV4LWNmZzYtc2V0dGluZ3MiOworCWNhc2UgUEhZX0FVWF9DRkc3OgorCQlyZXR1cm4g
InFjb20sYXV4LWNmZzctc2V0dGluZ3MiOworCWNhc2UgUEhZX0FVWF9DRkc4OgorCQlyZXR1cm4g
InFjb20sYXV4LWNmZzgtc2V0dGluZ3MiOworCWNhc2UgUEhZX0FVWF9DRkc5OgorCQlyZXR1cm4g
InFjb20sYXV4LWNmZzktc2V0dGluZ3MiOworCWRlZmF1bHQ6CisJCXJldHVybiAidW5rbm93biI7
CisJfQorfQorCitzdGF0aWMgaW50IGRwX3BhcnNlcl9hdXgoc3RydWN0IGRwX3BhcnNlciAqcGFy
c2VyKQoreworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqb2Zfbm9kZSA9IHBhcnNlci0+cGRldi0+ZGV2
Lm9mX25vZGU7CisJaW50IGxlbiA9IDAsIGkgPSAwLCBqID0gMCwgY29uZmlnX2NvdW50ID0gMDsK
Kwljb25zdCBjaGFyICpkYXRhOworCisJZm9yIChpID0gMDsgaSA8IFBIWV9BVVhfQ0ZHX01BWDsg
aSsrKSB7CisJCWNvbnN0IGNoYXIgKnByb3BlcnR5ID0gZHBfZ2V0X3BoeV9hdXhfY29uZmlnX3By
b3BlcnR5KGkpOworCisJCWRhdGEgPSBvZl9nZXRfcHJvcGVydHkob2Zfbm9kZSwgcHJvcGVydHks
ICZsZW4pOworCQlpZiAoIWRhdGEpIHsKKwkJCURSTV9FUlJPUigiVW5hYmxlIHRvIHJlYWQgJXNc
biIsIHByb3BlcnR5KTsKKwkJCWdvdG8gZXJyb3I7CisJCX0KKworCQljb25maWdfY291bnQgPSBs
ZW4gLSAxOworCQlpZiAoY29uZmlnX2NvdW50IDwgMSB8fCAvKiBtaW5pbXVtIGNvbmZpZyBjb3Vu
dCA9IDEgKi8KKwkJCWNvbmZpZ19jb3VudCA+IERQX0FVWF9DRkdfTUFYX1ZBTFVFX0NOVCkgewor
CQkJRFJNX0VSUk9SKCJJbnZhbGlkIGNvbmZpZyBjb3VudCAoJWQpIGNvbmZpZ3MgZm9yICVzXG4i
LAorCQkJCQljb25maWdfY291bnQsIHByb3BlcnR5KTsKKwkJCWdvdG8gZXJyb3I7CisJCX0KKwor
CQlwYXJzZXItPmF1eF9jZmdbaV0ub2Zmc2V0ID0gZGF0YVswXTsKKwkJcGFyc2VyLT5hdXhfY2Zn
W2ldLmNmZ19jbnQgPSBjb25maWdfY291bnQ7CisJCURSTV9ERUJVR19EUCgiJXMgb2Zmc2V0PTB4
JXgsIGNmZ19jbnQ9JWRcbiIsCisJCQkJcHJvcGVydHksCisJCQkJcGFyc2VyLT5hdXhfY2ZnW2ld
Lm9mZnNldCwKKwkJCQlwYXJzZXItPmF1eF9jZmdbaV0uY2ZnX2NudCk7CisJCWZvciAoaiA9IDE7
IGogPCBsZW47IGorKykgeworCQkJcGFyc2VyLT5hdXhfY2ZnW2ldLmx1dFtqIC0gMV0gPSBkYXRh
W2pdOworCQkJRFJNX0RFQlVHX0RQKCIlcyBsdXRbJWRdPTB4JXhcbiIsCisJCQkJCXByb3BlcnR5
LAorCQkJCQlpLAorCQkJCQlwYXJzZXItPmF1eF9jZmdbaV0ubHV0W2ogLSAxXSk7CisJCX0KKwl9
CisJCXJldHVybiAwOworCitlcnJvcjoKKwlmb3IgKGkgPSAwOyBpIDwgUEhZX0FVWF9DRkdfTUFY
OyBpKyspIHsKKwkJcGFyc2VyLT5hdXhfY2ZnW2ldID0gKGNvbnN0IHN0cnVjdCBkcF9hdXhfY2Zn
KXsgMCB9OworCX0KKwlyZXR1cm4gLUVJTlZBTDsKK30KKworc3RhdGljIGludCBkcF9wYXJzZXJf
bWlzYyhzdHJ1Y3QgZHBfcGFyc2VyICpwYXJzZXIpCit7CisJaW50IHJjID0gMDsKKwlzdHJ1Y3Qg
ZGV2aWNlX25vZGUgKm9mX25vZGUgPSBwYXJzZXItPnBkZXYtPmRldi5vZl9ub2RlOworCisJcmMg
PSBvZl9wcm9wZXJ0eV9yZWFkX3UzMihvZl9ub2RlLAorCQkicWNvbSxtYXgtcGNsay1mcmVxdWVu
Y3kta2h6IiwgJnBhcnNlci0+bWF4X3BjbGtfa2h6KTsKKwlpZiAocmMpCisJCXBhcnNlci0+bWF4
X3BjbGtfa2h6ID0gRFBfTUFYX1BJWEVMX0NMS19LSFo7CisKKwlyZXR1cm4gMDsKK30KKworc3Rh
dGljIGludCBkcF9wYXJzZXJfcGluY3RybChzdHJ1Y3QgZHBfcGFyc2VyICpwYXJzZXIpCit7CisJ
c3RydWN0IGRwX3BpbmN0cmwgKnBpbmN0cmwgPSAmcGFyc2VyLT5waW5jdHJsOworCisJcGluY3Ry
bC0+cGluID0gZGV2bV9waW5jdHJsX2dldCgmcGFyc2VyLT5wZGV2LT5kZXYpOworCisJaWYgKElT
X0VSUl9PUl9OVUxMKHBpbmN0cmwtPnBpbikpIHsKKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gZ2V0
IHBpbmN0cmwsIHJjPSVkXG4iLAorCQkJCQlQVFJfRVJSX09SX1pFUk8ocGluY3RybC0+cGluKSk7
CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCXBpbmN0cmwtPnN0YXRlX2FjdGl2ZSA9IHBpbmN0
cmxfbG9va3VwX3N0YXRlKHBpbmN0cmwtPnBpbiwKKwkJCQkJIm1kc3NfZHBfYWN0aXZlIik7CisJ
aWYgKElTX0VSUl9PUl9OVUxMKHBpbmN0cmwtPnN0YXRlX2FjdGl2ZSkpIHsKKwkJRFJNX0VSUk9S
KCJmYWlsZWQgdG8gZ2V0IHBpbmN0cmwgYWN0aXZlIHN0YXRlLCAlZFxuIiwKKwkJCVBUUl9FUlJf
T1JfWkVSTyhwaW5jdHJsLT5zdGF0ZV9hY3RpdmUpKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQor
CisJcGluY3RybC0+c3RhdGVfc3VzcGVuZCA9IHBpbmN0cmxfbG9va3VwX3N0YXRlKHBpbmN0cmwt
PnBpbiwKKwkJCQkJIm1kc3NfZHBfc2xlZXAiKTsKKwlpZiAoSVNfRVJSX09SX05VTEwocGluY3Ry
bC0+c3RhdGVfc3VzcGVuZCkpIHsKKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gZ2V0IHBpbmN0cmwg
c3VzcGVuZCBzdGF0ZSwgJWRcbiIsCisJCQlQVFJfRVJSX09SX1pFUk8ocGluY3RybC0+c3RhdGVf
c3VzcGVuZCkpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3Rh
dGljIGludCBkcF9wYXJzZXJfZ3BpbyhzdHJ1Y3QgZHBfcGFyc2VyICpwYXJzZXIpCit7CisJc3Ry
dWN0IGRldmljZSAqZGV2ID0gJnBhcnNlci0+cGRldi0+ZGV2OworCXN0cnVjdCBkZXZpY2Vfbm9k
ZSAqb2Zfbm9kZSA9IGRldi0+b2Zfbm9kZTsKKworCXBhcnNlci0+dXNicGx1Z19jY19ncGlvID0g
b2ZfZ2V0X25hbWVkX2dwaW8ob2Zfbm9kZSwgInFjb20sdXNicGx1Zy1jYy1ncGlvIiwgMCk7CisJ
aWYgKCFncGlvX2lzX3ZhbGlkKHBhcnNlci0+dXNicGx1Z19jY19ncGlvKSkgeworCQkJRFJNX0VS
Uk9SKCJ1c2JwbHVnLWNjLWdwaW8gbm90IHNwZWNpZmllZFxuIik7CisJCQlyZXR1cm4gLUVJTlZB
TDsKKwl9CisKKwlwYXJzZXItPmF1eF9lbl9ncGlvID0gb2ZfZ2V0X25hbWVkX2dwaW8ob2Zfbm9k
ZSwgInFjb20sYXV4LWVuLWdwaW8iLCAwKTsKKwlpZiAoIWdwaW9faXNfdmFsaWQocGFyc2VyLT5h
dXhfZW5fZ3BpbykpIHsKKwkJCURSTV9FUlJPUigiYXV4LWVuLWdwaW8gbm90IHNwZWNpZmllZFxu
Iik7CisJCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlwYXJzZXItPmF1eF9zZWxfZ3BpbyA9IG9m
X2dldF9uYW1lZF9ncGlvKG9mX25vZGUsICJxY29tLGF1eC1zZWwtZ3BpbyIsIDApOworCWlmICgh
Z3Bpb19pc192YWxpZChwYXJzZXItPmF1eF9zZWxfZ3BpbykpIHsKKwkJCURSTV9FUlJPUigiYXV4
LXNlbC1ncGlvIG5vdCBzcGVjaWZpZWRcbiIpOworCQkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJ
cmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbmxpbmUgYm9vbCBkcF9wYXJzZXJfY2hlY2tfcHJlZml4
KGNvbnN0IGNoYXIgKmNsa19wcmVmaXgsIGNvbnN0IGNoYXIgKmNsa19uYW1lKQoreworCXJldHVy
biAhc3RybmNtcChjbGtfcHJlZml4LCBjbGtfbmFtZSwgc3RybGVuKGNsa19wcmVmaXgpKTsKK30K
Kworc3RhdGljIGludCBkcF9wYXJzZXJfaW5pdF9jbGtfZGF0YShzdHJ1Y3QgZHBfcGFyc2VyICpw
YXJzZXIpCit7CisJaW50IG51bV9jbGsgPSAwLCBpID0gMCwgcmMgPSAwOworCWludCBjb3JlX2Ns
a19jb3VudCA9IDAsIGN0cmxfY2xrX2NvdW50ID0gMDsKKwljb25zdCBjaGFyICpjbGtfbmFtZTsK
KwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmcGFyc2VyLT5wZGV2LT5kZXY7CisJc3RydWN0IGRzc19t
b2R1bGVfcG93ZXIgKmNvcmVfcG93ZXIgPSAmcGFyc2VyLT5tcFtEUF9DT1JFX1BNXTsKKwlzdHJ1
Y3QgZHNzX21vZHVsZV9wb3dlciAqY3RybF9wb3dlciA9ICZwYXJzZXItPm1wW0RQX0NUUkxfUE1d
OworCisJbnVtX2NsayA9IG9mX3Byb3BlcnR5X2NvdW50X3N0cmluZ3MoZGV2LT5vZl9ub2RlLCAi
Y2xvY2stbmFtZXMiKTsKKwlpZiAobnVtX2NsayA8PSAwKSB7CisJCURSTV9FUlJPUigibm8gY2xv
Y2tzIGFyZSBkZWZpbmVkXG4iKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJZm9yIChpID0g
MDsgaSA8IG51bV9jbGs7IGkrKykgeworCQlyYyA9IG9mX3Byb3BlcnR5X3JlYWRfc3RyaW5nX2lu
ZGV4KGRldi0+b2Zfbm9kZSwKKwkJCQkiY2xvY2stbmFtZXMiLCBpLCAmY2xrX25hbWUpOworCQlp
ZiAocmMpIHsKKwkJCURSTV9FUlJPUigiZXJyb3IgcmVhZGluZyBjbG9jay1uYW1lcyAlZFxuIiwg
cmMpOworCQkJcmV0dXJuIHJjOworCQl9CisKKwkJaWYgKGRwX3BhcnNlcl9jaGVja19wcmVmaXgo
ImNvcmUiLCBjbGtfbmFtZSkpCisJCQljb3JlX2Nsa19jb3VudCsrOworCisJCWlmIChkcF9wYXJz
ZXJfY2hlY2tfcHJlZml4KCJjdHJsIiwgY2xrX25hbWUpKQorCQkJY3RybF9jbGtfY291bnQrKzsK
Kwl9CisKKwkvKiBJbml0aWFsaXplIHRoZSBDT1JFIHBvd2VyIG1vZHVsZSAqLworCWlmIChjb3Jl
X2Nsa19jb3VudCA9PSAwKSB7CisJCURSTV9FUlJPUigibm8gY29yZSBjbG9ja3MgYXJlIGRlZmlu
ZWRcbiIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwljb3JlX3Bvd2VyLT5udW1fY2xrID0g
Y29yZV9jbGtfY291bnQ7CisJY29yZV9wb3dlci0+Y2xrX2NvbmZpZyA9IGRldm1fa3phbGxvYyhk
ZXYsCisJCQlzaXplb2Yoc3RydWN0IGRzc19jbGspICogY29yZV9wb3dlci0+bnVtX2NsaywKKwkJ
CUdGUF9LRVJORUwpOworCWlmICghY29yZV9wb3dlci0+Y2xrX2NvbmZpZykgeworCQlyZXR1cm4g
LUVJTlZBTDsKKwl9CisKKwkvKiBJbml0aWFsaXplIHRoZSBDVFJMIHBvd2VyIG1vZHVsZSAqLwor
CWlmIChjdHJsX2Nsa19jb3VudCA9PSAwKSB7CisJCURSTV9FUlJPUigibm8gY3RybCBjbG9ja3Mg
YXJlIGRlZmluZWRcbiIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwljdHJsX3Bvd2VyLT5u
dW1fY2xrID0gY3RybF9jbGtfY291bnQ7CisJY3RybF9wb3dlci0+Y2xrX2NvbmZpZyA9IGRldm1f
a3phbGxvYyhkZXYsCisJCQlzaXplb2Yoc3RydWN0IGRzc19jbGspICogY3RybF9wb3dlci0+bnVt
X2NsaywKKwkJCUdGUF9LRVJORUwpOworCWlmICghY3RybF9wb3dlci0+Y2xrX2NvbmZpZykgewor
CQljdHJsX3Bvd2VyLT5udW1fY2xrID0gMDsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJcmV0
dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgZHBfcGFyc2VyX2Nsb2NrKHN0cnVjdCBkcF9wYXJzZXIg
KnBhcnNlcikKK3sKKwlpbnQgcmMgPSAwLCBpID0gMDsKKwlpbnQgbnVtX2NsayA9IDA7CisJaW50
IGNvcmVfY2xrX2luZGV4ID0gMCwgY3RybF9jbGtfaW5kZXggPSAwOworCWludCBjb3JlX2Nsa19j
b3VudCA9IDAsIGN0cmxfY2xrX2NvdW50ID0gMDsKKwljb25zdCBjaGFyICpjbGtfbmFtZTsKKwlz
dHJ1Y3QgZGV2aWNlICpkZXYgPSAmcGFyc2VyLT5wZGV2LT5kZXY7CisJc3RydWN0IGRzc19tb2R1
bGVfcG93ZXIgKmNvcmVfcG93ZXIgPSAmcGFyc2VyLT5tcFtEUF9DT1JFX1BNXTsKKwlzdHJ1Y3Qg
ZHNzX21vZHVsZV9wb3dlciAqY3RybF9wb3dlciA9ICZwYXJzZXItPm1wW0RQX0NUUkxfUE1dOwor
CisJY29yZV9wb3dlciA9ICZwYXJzZXItPm1wW0RQX0NPUkVfUE1dOworCWN0cmxfcG93ZXIgPSAm
cGFyc2VyLT5tcFtEUF9DVFJMX1BNXTsKKworCXJjID0gIGRwX3BhcnNlcl9pbml0X2Nsa19kYXRh
KHBhcnNlcik7CisJaWYgKHJjKSB7CisJCURSTV9FUlJPUigiZmFpbGVkIHRvIGluaXRpYWxpemUg
cG93ZXIgZGF0YSAlZFxuIiwgcmMpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwljb3JlX2Ns
a19jb3VudCA9IGNvcmVfcG93ZXItPm51bV9jbGs7CisJY3RybF9jbGtfY291bnQgPSBjdHJsX3Bv
d2VyLT5udW1fY2xrOworCisJbnVtX2NsayA9IGNvcmVfY2xrX2NvdW50ICsgY3RybF9jbGtfY291
bnQ7CisKKwlmb3IgKGkgPSAwOyBpIDwgbnVtX2NsazsgaSsrKSB7CisJCXJjID0gb2ZfcHJvcGVy
dHlfcmVhZF9zdHJpbmdfaW5kZXgoZGV2LT5vZl9ub2RlLCAiY2xvY2stbmFtZXMiLAorCQkJCWks
ICZjbGtfbmFtZSk7CisJCWlmIChyYykgeworCQkJIERSTV9FUlJPUigiZXJyb3IgcmVhZGluZyBj
bG9jay1uYW1lcyAlZFxuIiwgcmMpOworCQkJcmV0dXJuIHJjOworCQl9CisJCWlmIChkcF9wYXJz
ZXJfY2hlY2tfcHJlZml4KCJjb3JlIiwgY2xrX25hbWUpICYmCisJCQkJY29yZV9jbGtfaW5kZXgg
PCBjb3JlX2Nsa19jb3VudCkgeworCQkJc3RydWN0IGRzc19jbGsgKmNsayA9CisJCQkJJmNvcmVf
cG93ZXItPmNsa19jb25maWdbY29yZV9jbGtfaW5kZXhdOworCQkJc3RybGNweShjbGstPmNsa19u
YW1lLCBjbGtfbmFtZSwgc2l6ZW9mKGNsay0+Y2xrX25hbWUpKTsKKwkJCWNsay0+dHlwZSA9IERT
U19DTEtfQUhCOworCQkJY29yZV9jbGtfaW5kZXgrKzsKKwkJfSBlbHNlIGlmIChkcF9wYXJzZXJf
Y2hlY2tfcHJlZml4KCJjdHJsIiwgY2xrX25hbWUpICYmCisJCQkgICBjdHJsX2Nsa19pbmRleCA8
IGN0cmxfY2xrX2NvdW50KSB7CisJCQlzdHJ1Y3QgZHNzX2NsayAqY2xrID0KKwkJCQkmY3RybF9w
b3dlci0+Y2xrX2NvbmZpZ1tjdHJsX2Nsa19pbmRleF07CisJCQlzdHJsY3B5KGNsay0+Y2xrX25h
bWUsIGNsa19uYW1lLCBzaXplb2YoY2xrLT5jbGtfbmFtZSkpOworCQkJY3RybF9jbGtfaW5kZXgr
KzsKKworCQkJaWYgKCFzdHJuY21wKGNsa19uYW1lLCAiY3RybF9saW5rX2NsayIsIHN0cmxlbigi
Y3RybF9saW5rX2NsayIpKSB8fAorCQkJICAhc3RybmNtcChjbGtfbmFtZSwgImN0cmxfcGl4ZWxf
Y2xrIiwgc3RybGVuKCJjdHJsX3BpeGVsX2NsayIpKSkKKwkJCQljbGstPnR5cGUgPSBEU1NfQ0xL
X1BDTEs7CisJCQllbHNlCisJCQkJY2xrLT50eXBlID0gRFNTX0NMS19BSEI7CisJCX0KKwl9CisK
KwlEUk1fREVCVUdfRFAoImNsb2NrIHBhcnNpbmcgc3VjY2Vzc2Z1bFxuIik7CisKKwlyZXR1cm4g
MDsKK30KKworc3RhdGljIGludCBkcF9wYXJzZXJfcGFyc2Uoc3RydWN0IGRwX3BhcnNlciAqcGFy
c2VyKQoreworCWludCByYyA9IDA7CisKKwlpZiAoIXBhcnNlcikgeworCQlEUk1fRVJST1IoImlu
dmFsaWQgaW5wdXRcbiIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwkvKiBEZWZhdWx0OiBX
ZSBhc3N1bWUgdGhhdCBQSFkgaXMgc2hhcmVkIGJldHdlZW4gVVNCIGFuZCBEUCAoQ29tYm8gcGh5
KSAqLworCXBhcnNlci0+Y29tYm9fcGh5X2VuID0gdHJ1ZTsKKworCXJjID0gZHBfcGFyc2VyX2N0
cmxfcmVzKHBhcnNlcik7CisJaWYgKHJjKQorCQlyZXR1cm4gcmM7CisKKwlyYyA9IGRwX3BhcnNl
cl9hdXgocGFyc2VyKTsKKwlpZiAocmMpCisJCXJldHVybiByYzsKKworCXJjID0gZHBfcGFyc2Vy
X21pc2MocGFyc2VyKTsKKwlpZiAocmMpCisJCXJldHVybiByYzsKKworCXJjID0gZHBfcGFyc2Vy
X2Nsb2NrKHBhcnNlcik7CisJaWYgKHJjKQorCQlyZXR1cm4gcmM7CisKKwkvKiBNYXAgdGhlIGNv
cnJlc3BvbmRpbmcgcmVndWxhdG9yIGluZm9ybWF0aW9uIGFjY29yZGluZyB0bworCSAqIHZlcnNp
b24uIEN1cnJlbnRseSwgc2luY2Ugd2Ugb25seSBoYXZlIG9uZSBzdXBwb3J0ZWQgcGxhdGZvcm0s
CisJICogbWFwcGluZyB0aGUgcmVndWxhdG9yIGRpcmVjdGx5LgorCSAqLworCXBhcnNlci0+cmVn
dWxhdG9yX2NmZyA9ICZzZG04NDVfZHBfcmVnX2NmZzsKKworCXJjID0gZHBfcGFyc2VyX2dwaW8o
cGFyc2VyKTsKKwlpZiAocmMpIHsKKwkJRFJNX0VSUk9SKCJ1bmFibGUgdG8gcGFyc2UgR1BJT3Mu
IEFzc3VtaW5nIENvbWJvLVBoeSBpcyBkaXNhYmxlZFxuIik7CisJCXBhcnNlci0+Y29tYm9fcGh5
X2VuID0gZmFsc2U7CisJCXJldHVybiByYzsKKwl9CisKKwlyYyA9IGRwX3BhcnNlcl9waW5jdHJs
KHBhcnNlcik7CisJcmV0dXJuIHJjOworfQorCitzdHJ1Y3QgZHBfcGFyc2VyICpkcF9wYXJzZXJf
Z2V0KHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpCit7CisJc3RydWN0IGRwX3BhcnNlciAq
cGFyc2VyOworCisJcGFyc2VyID0gZGV2bV9remFsbG9jKCZwZGV2LT5kZXYsIHNpemVvZigqcGFy
c2VyKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFwYXJzZXIpCisJCXJldHVybiBFUlJfUFRSKC1FTk9N
RU0pOworCisJcGFyc2VyLT5wYXJzZSA9IGRwX3BhcnNlcl9wYXJzZTsKKwlwYXJzZXItPnBkZXYg
PSBwZGV2OworCisJcmV0dXJuIHBhcnNlcjsKK30KKwordm9pZCBkcF9wYXJzZXJfcHV0KHN0cnVj
dCBkcF9wYXJzZXIgKnBhcnNlcikKK3sKKworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L21zbS9kcC9kcF9wYXJzZXIuaCBiL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfcGFyc2VyLmgK
bmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uYjYwNmI0MAotLS0gL2Rldi9udWxs
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfcGFyc2VyLmgKQEAgLTAsMCArMSwyMjIg
QEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkgKi8KKy8qCisgKiBD
b3B5cmlnaHQgKGMpIDIwMTItMjAxOSwgVGhlIExpbnV4IEZvdW5kYXRpb24uIEFsbCByaWdodHMg
cmVzZXJ2ZWQuCisgKi8KKworI2lmbmRlZiBfRFBfUEFSU0VSX0hfCisjZGVmaW5lIF9EUF9QQVJT
RVJfSF8KKworI2RlZmluZSBEUF9MQUJFTCAiTURTUyBEUCBESVNQTEFZIgorI2RlZmluZSBBVVhf
Q0ZHX0xFTgkxMAorI2RlZmluZSBEUF9NQVhfUElYRUxfQ0xLX0tIWgk2NzUwMDAKKworZW51bSBk
cF9wbV90eXBlIHsKKwlEUF9DT1JFX1BNLAorCURQX0NUUkxfUE0sCisJRFBfUEhZX1BNLAorCURQ
X01BWF9QTQorfTsKKworc3RydWN0IGRzc19pb19kYXRhIHsKKwl1MzIgbGVuOworCXZvaWQgX19p
b21lbSAqYmFzZTsKK307CisKK3N0YXRpYyBpbmxpbmUgY29uc3QgY2hhciAqZHBfcGFyc2VyX3Bt
X25hbWUoZW51bSBkcF9wbV90eXBlIG1vZHVsZSkKK3sKKwlzd2l0Y2ggKG1vZHVsZSkgeworCWNh
c2UgRFBfQ09SRV9QTToJcmV0dXJuICJEUF9DT1JFX1BNIjsKKwljYXNlIERQX0NUUkxfUE06CXJl
dHVybiAiRFBfQ1RSTF9QTSI7CisJY2FzZSBEUF9QSFlfUE06CQlyZXR1cm4gIkRQX1BIWV9QTSI7
CisJZGVmYXVsdDoJCXJldHVybiAiPz8/IjsKKwl9Cit9CisKKy8qKgorICogc3RydWN0IGRwX2Rp
c3BsYXlfZGF0YSAgLSBkaXNwbGF5IHJlbGF0ZWQgZGV2aWNlIHRyZWUgZGF0YS4KKyAqCisgKiBA
Y3RybF9ub2RlOiByZWZlcmVjZSB0byBjb250cm9sbGVyIGRldmljZQorICogQHBoeV9ub2RlOiAg
cmVmZXJlbmNlIHRvIHBoeSBkZXZpY2UKKyAqIEBpc19hY3RpdmU6IGlzIHRoZSBjb250cm9sbGVy
IGN1cnJlbnRseSBhY3RpdmUKKyAqIEBuYW1lOiBuYW1lIG9mIHRoZSBkaXNwbGF5CisgKiBAZGlz
cGxheV90eXBlOiB0eXBlIG9mIHRoZSBkaXNwbGF5CisgKi8KK3N0cnVjdCBkcF9kaXNwbGF5X2Rh
dGEgeworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqY3RybF9ub2RlOworCXN0cnVjdCBkZXZpY2Vfbm9k
ZSAqcGh5X25vZGU7CisJYm9vbCBpc19hY3RpdmU7CisJY29uc3QgY2hhciAqbmFtZTsKKwljb25z
dCBjaGFyICpkaXNwbGF5X3R5cGU7Cit9OworCisvKioKKyAqIHN0cnVjdCBkcF9jdHJsX3Jlc291
cmNlIC0gY29udHJvbGxlcidzIElPIHJlbGF0ZWQgZGF0YQorICoKKyAqIEBkcF9haGI6IGNvbnRy
b2xsZXIncyBhaGIgbWFwcGVkIG1lbW9yeSBhZGRyZXNzCisgKiBAZHBfYXV4OiBjb250cm9sbGVy
J3MgYXV4IG1hcHBlZCBtZW1vcnkgYWRkcmVzcworICogQGRwX2xpbms6IGNvbnRyb2xsZXIncyBs
aW5rIG1hcHBlZCBtZW1vcnkgYWRkcmVzcworICogQGRwX3AwOiBjb250cm9sbGVyJ3MgcDAgbWFw
cGVkIG1lbW9yeSBhZGRyZXNzCisgKiBAcGh5X2lvOiBwaHkncyBtYXBwZWQgbWVtb3J5IGFkZHJl
c3MKKyAqIEBsbl90eDBfaW86IFVTQi1EUCBsYW5lIFRYMCdzIG1hcHBlZCBtZW1vcnkgYWRkcmVz
cworICogQGxuX3R4MV9pbzogVVNCLURQIGxhbmUgVFgxJ3MgbWFwcGVkIG1lbW9yeSBhZGRyZXNz
CisgKiBAZHBfY2NfaW86IERQIGNjJ3MgbWFwcGVkIG1lbW9yeSBhZGRyZXNzCisgKiBAcWZwcm9t
X2lvOiBxZnByb20ncyBtYXBwZWQgbWVtb3J5IGFkZHJlc3MKKyAqIEBkcF9wbGxfaW86IERQIFBM
TCBtYXBwZWQgbWVtb3J5IGFkZHJlc3MKKyAqIEB1c2IzX2RwX2NvbTogVVNCMyBEUCBQSFkgY29t
Ym8gbWFwcGVkIG1lbW9yeSBhZGRyZXNzCisgKi8KK3N0cnVjdCBkcF9pbyB7CisJc3RydWN0IGRz
c19pb19kYXRhIGN0cmxfaW87CisJc3RydWN0IGRzc19pb19kYXRhIGRwX2FoYjsKKwlzdHJ1Y3Qg
ZHNzX2lvX2RhdGEgZHBfYXV4OworCXN0cnVjdCBkc3NfaW9fZGF0YSBkcF9saW5rOworCXN0cnVj
dCBkc3NfaW9fZGF0YSBkcF9wMDsKKwlzdHJ1Y3QgZHNzX2lvX2RhdGEgcGh5X2lvOworCXN0cnVj
dCBkc3NfaW9fZGF0YSBsbl90eDBfaW87CisJc3RydWN0IGRzc19pb19kYXRhIGxuX3R4MV9pbzsK
KwlzdHJ1Y3QgZHNzX2lvX2RhdGEgZHBfY2NfaW87CisJc3RydWN0IGRzc19pb19kYXRhIHFmcHJv
bV9pbzsKKwlzdHJ1Y3QgZHNzX2lvX2RhdGEgZHBfcGxsX2lvOworCXN0cnVjdCBkc3NfaW9fZGF0
YSB1c2IzX2RwX2NvbTsKK307CisKKy8qKgorICogc3RydWN0IGRwX3BpbmN0cmwgLSBEUCdzIHBp
biBjb250cm9sCisgKgorICogQHBpbjogcGluLWNvbnRyb2xsZXIncyBpbnN0YW5jZQorICogQHN0
YXRlX2FjdGl2ZTogYWN0aXZlIHN0YXRlIHBpbiBjb250cm9sCisgKiBAc3RhdGVfaHBkX2FjdGl2
ZTogaHBkIGFjdGl2ZSBzdGF0ZSBwaW4gY29udHJvbAorICogQHN0YXRlX3N1c3BlbmQ6IHN1c3Bl
bmQgc3RhdGUgcGluIGNvbnRyb2wKKyAqLworc3RydWN0IGRwX3BpbmN0cmwgeworCXN0cnVjdCBw
aW5jdHJsICpwaW47CisJc3RydWN0IHBpbmN0cmxfc3RhdGUgKnN0YXRlX2FjdGl2ZTsKKwlzdHJ1
Y3QgcGluY3RybF9zdGF0ZSAqc3RhdGVfaHBkX2FjdGl2ZTsKKwlzdHJ1Y3QgcGluY3RybF9zdGF0
ZSAqc3RhdGVfc3VzcGVuZDsKK307CisKKyNkZWZpbmUgRFBfRU5VTV9TVFIoeCkJI3gKKyNkZWZp
bmUgRFBfQVVYX0NGR19NQVhfVkFMVUVfQ05UIDMKKy8qKgorICogc3RydWN0IGRwX2F1eF9jZmcg
LSBEUCdzIEFVWCBjb25maWd1cmF0aW9uIHNldHRpbmdzCisgKgorICogQGNmZ19jbnQ6IGNvdW50
IG9mIHRoZSBjb25maWd1cmFibGUgc2V0dGluZ3MgZm9yIHRoZSBBVVggcmVnaXN0ZXIKKyAqIEBj
dXJyZW50X2luZGV4OiBjdXJyZW50IGluZGV4IG9mIHRoZSBBVVggY29uZmlnIGx1dAorICogQG9m
ZnNldDogcmVnaXN0ZXIgb2Zmc2V0IG9mIHRoZSBBVVggY29uZmlnIHJlZ2lzdGVyCisgKiBAbHV0
OiBsb29rIHVwIHRhYmxlIGZvciB0aGUgQVVYIGNvbmZpZyB2YWx1ZXMgZm9yIHRoaXMgcmVnaXN0
ZXIKKyAqLworc3RydWN0IGRwX2F1eF9jZmcgeworCXUzMiBjZmdfY250OworCXUzMiBjdXJyZW50
X2luZGV4OworCXUzMiBvZmZzZXQ7CisJdTMyIGx1dFtEUF9BVVhfQ0ZHX01BWF9WQUxVRV9DTlRd
OworfTsKKworLyogUEhZIEFVWCBjb25maWcgcmVnaXN0ZXJzICovCitlbnVtIGRwX3BoeV9hdXhf
Y29uZmlnX3R5cGUgeworCVBIWV9BVVhfQ0ZHMCwKKwlQSFlfQVVYX0NGRzEsCisJUEhZX0FVWF9D
RkcyLAorCVBIWV9BVVhfQ0ZHMywKKwlQSFlfQVVYX0NGRzQsCisJUEhZX0FVWF9DRkc1LAorCVBI
WV9BVVhfQ0ZHNiwKKwlQSFlfQVVYX0NGRzcsCisJUEhZX0FVWF9DRkc4LAorCVBIWV9BVVhfQ0ZH
OSwKKwlQSFlfQVVYX0NGR19NQVgsCit9OworCisjZGVmaW5lIERQX0RFVl9SRUdVTEFUT1JfTUFY
CTQKKworLyogUmVndWxhdG9ycyBmb3IgRFAgZGV2aWNlcyAqLworc3RydWN0IGRwX3JlZ19lbnRy
eSB7CisJY2hhciBuYW1lWzMyXTsKKwlpbnQgZW5hYmxlX2xvYWQ7CisJaW50IGRpc2FibGVfbG9h
ZDsKK307CisKK3N0cnVjdCBkcF9yZWd1bGF0b3JfY2ZnIHsKKwlpbnQgbnVtOworCXN0cnVjdCBk
cF9yZWdfZW50cnkgcmVnc1tEUF9ERVZfUkVHVUxBVE9SX01BWF07Cit9OworCisKK3N0YXRpYyBp
bmxpbmUgY2hhciAqZHBfcGh5X2F1eF9jb25maWdfdHlwZV90b19zdHJpbmcodTMyIGNmZ190eXBl
KQoreworCXN3aXRjaCAoY2ZnX3R5cGUpIHsKKwljYXNlIFBIWV9BVVhfQ0ZHMDoKKwkJcmV0dXJu
IERQX0VOVU1fU1RSKFBIWV9BVVhfQ0ZHMCk7CisJY2FzZSBQSFlfQVVYX0NGRzE6CisJCXJldHVy
biBEUF9FTlVNX1NUUihQSFlfQVVYX0NGRzEpOworCWNhc2UgUEhZX0FVWF9DRkcyOgorCQlyZXR1
cm4gRFBfRU5VTV9TVFIoUEhZX0FVWF9DRkcyKTsKKwljYXNlIFBIWV9BVVhfQ0ZHMzoKKwkJcmV0
dXJuIERQX0VOVU1fU1RSKFBIWV9BVVhfQ0ZHMyk7CisJY2FzZSBQSFlfQVVYX0NGRzQ6CisJCXJl
dHVybiBEUF9FTlVNX1NUUihQSFlfQVVYX0NGRzQpOworCWNhc2UgUEhZX0FVWF9DRkc1OgorCQly
ZXR1cm4gRFBfRU5VTV9TVFIoUEhZX0FVWF9DRkc1KTsKKwljYXNlIFBIWV9BVVhfQ0ZHNjoKKwkJ
cmV0dXJuIERQX0VOVU1fU1RSKFBIWV9BVVhfQ0ZHNik7CisJY2FzZSBQSFlfQVVYX0NGRzc6CisJ
CXJldHVybiBEUF9FTlVNX1NUUihQSFlfQVVYX0NGRzcpOworCWNhc2UgUEhZX0FVWF9DRkc4Ogor
CQlyZXR1cm4gRFBfRU5VTV9TVFIoUEhZX0FVWF9DRkc4KTsKKwljYXNlIFBIWV9BVVhfQ0ZHOToK
KwkJcmV0dXJuIERQX0VOVU1fU1RSKFBIWV9BVVhfQ0ZHOSk7CisJZGVmYXVsdDoKKwkJcmV0dXJu
ICJ1bmtub3duIjsKKwl9Cit9CisKKy8qKgorICogc3RydWN0IGRwX3BhcnNlciAtIERQIHBhcnNl
cidzIGRhdGEgZXhwb3NlZCB0byBjbGllbnRzCisgKgorICogQHBkZXY6IHBsYXRmb3JtIGRhdGEg
b2YgdGhlIGNsaWVudAorICogQG1wOiBncGlvLCByZWd1bGF0b3IgYW5kIGNsb2NrIHJlbGF0ZWQg
ZGF0YQorICogQHBpbmN0cmw6IHBpbi1jb250cm9sIHJlbGF0ZWQgZGF0YQorICogQGF1eF9lbl9n
cGlvOiBHUElPIHRvIGNvbnRyb2wgQVVYIGRhdGEgd2hlbiB1c2luZyBjb21ibyBQSFkKKyAqIEBh
dXhfc2VsX2dwaW86IEdQSU8gdG8gY29udHJvbCBwbHVnIG9yaWVudGF0aW9uIHdoZW4gdXNpbmcg
Y29tYm8gUEhZCisgKiBAdXNicGx1Z19jY19ncGlvOiBHUElPIHRvIHJvdXRlIERQL1VTQiBsYW5l
cyB3aGVuIHVzaW5nIGNvbWJvIFBIWQorICogQGNvbWJvX3BoeV9lbjogQm9vbGVhbiB0byBjaGVj
ayB3aGV0aGVyIGNvbWJvIFBIWSBpcyB1c2VkCisgKiBAZGlzcF9kYXRhOiBjb250cm9sbGVyJ3Mg
ZGlzcGxheSByZWxhdGVkIGRhdGEKKyAqIEBwYXJzZTogZnVuY3Rpb24gdG8gYmUgY2FsbGVkIGJ5
IGNsaWVudCB0byBwYXJzZSBkZXZpY2UgdHJlZS4KKyAqLworc3RydWN0IGRwX3BhcnNlciB7CisJ
c3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldjsKKwlzdHJ1Y3QgZHNzX21vZHVsZV9wb3dlciBt
cFtEUF9NQVhfUE1dOworCXN0cnVjdCBkcF9waW5jdHJsIHBpbmN0cmw7CisJdW5zaWduZWQgaW50
IGF1eF9lbl9ncGlvOworCXVuc2lnbmVkIGludCBhdXhfc2VsX2dwaW87CisJdW5zaWduZWQgaW50
IHVzYnBsdWdfY2NfZ3BpbzsKKwlib29sIGNvbWJvX3BoeV9lbjsKKwlzdHJ1Y3QgZHBfaW8gaW87
CisJc3RydWN0IGRwX2Rpc3BsYXlfZGF0YSBkaXNwX2RhdGE7CisJY29uc3Qgc3RydWN0IGRwX3Jl
Z3VsYXRvcl9jZmcgKnJlZ3VsYXRvcl9jZmc7CisJdTggbF9tYXBbNF07CisJc3RydWN0IGRwX2F1
eF9jZmcgYXV4X2NmZ1tBVVhfQ0ZHX0xFTl07CisJdTMyIG1heF9wY2xrX2toejsKKworCWludCAo
KnBhcnNlKShzdHJ1Y3QgZHBfcGFyc2VyICpwYXJzZXIpOworfTsKKworLyoqCisgKiBkcF9wYXJz
ZXJfZ2V0KCkgLSBnZXQgdGhlIERQJ3MgZGV2aWNlIHRyZWUgcGFyc2VyIG1vZHVsZQorICoKKyAq
IEBwZGV2OiBwbGF0Zm9ybSBkYXRhIG9mIHRoZSBjbGllbnQKKyAqIHJldHVybjogcG9pbnRlciB0
byBkcF9wYXJzZXIgc3RydWN0dXJlLgorICoKKyAqIFRoaXMgZnVuY3Rpb24gcHJvdmlkZXMgY2xp
ZW50IGNhcGFiaWxpdHkgdG8gcGFyc2UgdGhlCisgKiBkZXZpY2UgdHJlZSBhbmQgcG9wdWxhdGUg
dGhlIGRhdGEgc3RydWN0dXJlcy4gVGhlIGRhdGEKKyAqIHJlbGF0ZWQgdG8gY2xvY2ssIHJlZ3Vs
YXRvcnMsIHBpbi1jb250cm9sIGFuZCBvdGhlcgorICogY2FuIGJlIHBhcnNlZCB1c2luZyB0aGlz
IG1vZHVsZS4KKyAqLworc3RydWN0IGRwX3BhcnNlciAqZHBfcGFyc2VyX2dldChzdHJ1Y3QgcGxh
dGZvcm1fZGV2aWNlICpwZGV2KTsKKworLyoqCisgKiBkcF9wYXJzZXJfcHV0KCkgLSBjbGVhbnMg
dGhlIGRwX3BhcnNlciBtb2R1bGUKKyAqCisgKiBAcGFyc2VyOiBwb2ludGVyIHRvIHRoZSBwYXJz
ZXIncyBkYXRhLgorICovCit2b2lkIGRwX3BhcnNlcl9wdXQoc3RydWN0IGRwX3BhcnNlciAqcGFy
c2VyKTsKKyNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9wb3dl
ci5jIGIvZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9wb3dlci5jCm5ldyBmaWxlIG1vZGUgMTAw
NjQ0CmluZGV4IDAwMDAwMDAuLjNmYTRjOWIKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dw
dS9kcm0vbXNtL2RwL2RwX3Bvd2VyLmMKQEAgLTAsMCArMSw1NTggQEAKKy8vIFNQRFgtTGljZW5z
ZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkKKy8qCisgKiBDb3B5cmlnaHQgKGMpIDIwMTItMjAx
OSwgVGhlIExpbnV4IEZvdW5kYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuCisgKi8KKworI2Rl
ZmluZSBwcl9mbXQoZm10KQkiW2RybS1kcF0gJXM6ICIgZm10LCBfX2Z1bmNfXworCisjaW5jbHVk
ZSA8bGludXgvY2xrLmg+CisjaW5jbHVkZSA8bGludXgvcmVndWxhdG9yL2NvbnN1bWVyLmg+Cisj
aW5jbHVkZSA8bGludXgvb2ZfZ3Bpby5oPgorI2luY2x1ZGUgImRwX3Bvd2VyLmgiCisKK3N0cnVj
dCBkcF9wb3dlcl9wcml2YXRlIHsKKwlzdHJ1Y3QgZHBfcGFyc2VyICpwYXJzZXI7CisJc3RydWN0
IHBsYXRmb3JtX2RldmljZSAqcGRldjsKKwlzdHJ1Y3QgY2xrICpwaXhlbF9jbGtfcmNnOworCXN0
cnVjdCBjbGsgKmxpbmtfY2xrX3NyYzsKKwlzdHJ1Y3QgY2xrICpwaXhlbF9wcm92aWRlcjsKKwlz
dHJ1Y3QgY2xrICpsaW5rX3Byb3ZpZGVyOworCXN0cnVjdCByZWd1bGF0b3JfYnVsa19kYXRhIHN1
cHBsaWVzW0RQX0RFVl9SRUdVTEFUT1JfTUFYXTsKKworCXN0cnVjdCBkcF9wb3dlciBkcF9wb3dl
cjsKK307CisKK3N0YXRpYyB2b2lkIGRwX3Bvd2VyX3JlZ3VsYXRvcl9kaXNhYmxlKHN0cnVjdCBk
cF9wb3dlcl9wcml2YXRlICpwb3dlcikKK3sKKwlzdHJ1Y3QgcmVndWxhdG9yX2J1bGtfZGF0YSAq
cyA9IHBvd2VyLT5zdXBwbGllczsKKwljb25zdCBzdHJ1Y3QgZHBfcmVnX2VudHJ5ICpyZWdzID0g
cG93ZXItPnBhcnNlci0+cmVndWxhdG9yX2NmZy0+cmVnczsKKwlpbnQgbnVtID0gcG93ZXItPnBh
cnNlci0+cmVndWxhdG9yX2NmZy0+bnVtOworCWludCBpOworCisJREJHKCIiKTsKKwlmb3IgKGkg
PSBudW0gLSAxOyBpID49IDA7IGktLSkKKwkJaWYgKHJlZ3NbaV0uZGlzYWJsZV9sb2FkID49IDAp
CisJCQlyZWd1bGF0b3Jfc2V0X2xvYWQoc1tpXS5jb25zdW1lciwKKwkJCQkJICAgcmVnc1tpXS5k
aXNhYmxlX2xvYWQpOworCisJcmVndWxhdG9yX2J1bGtfZGlzYWJsZShudW0sIHMpOworfQorCitz
dGF0aWMgaW50IGRwX3Bvd2VyX3JlZ3VsYXRvcl9lbmFibGUoc3RydWN0IGRwX3Bvd2VyX3ByaXZh
dGUgKnBvd2VyKQoreworCXN0cnVjdCByZWd1bGF0b3JfYnVsa19kYXRhICpzID0gcG93ZXItPnN1
cHBsaWVzOworCWNvbnN0IHN0cnVjdCBkcF9yZWdfZW50cnkgKnJlZ3MgPSBwb3dlci0+cGFyc2Vy
LT5yZWd1bGF0b3JfY2ZnLT5yZWdzOworCWludCBudW0gPSBwb3dlci0+cGFyc2VyLT5yZWd1bGF0
b3JfY2ZnLT5udW07CisJaW50IHJldCwgaTsKKworCURCRygiIik7CisJZm9yIChpID0gMDsgaSA8
IG51bTsgaSsrKSB7CisJCWlmIChyZWdzW2ldLmVuYWJsZV9sb2FkID49IDApIHsKKwkJCXJldCA9
IHJlZ3VsYXRvcl9zZXRfbG9hZChzW2ldLmNvbnN1bWVyLAorCQkJCQkJIHJlZ3NbaV0uZW5hYmxl
X2xvYWQpOworCQkJaWYgKHJldCA8IDApIHsKKwkJCQlwcl9lcnIoInJlZ3VsYXRvciAlZCBzZXQg
b3AgbW9kZSBmYWlsZWQsICVkXG4iLAorCQkJCQlpLCByZXQpOworCQkJCWdvdG8gZmFpbDsKKwkJ
CX0KKwkJfQorCX0KKworCXJldCA9IHJlZ3VsYXRvcl9idWxrX2VuYWJsZShudW0sIHMpOworCWlm
IChyZXQgPCAwKSB7CisJCXByX2VycigicmVndWxhdG9yIGVuYWJsZSBmYWlsZWQsICVkXG4iLCBy
ZXQpOworCQlnb3RvIGZhaWw7CisJfQorCisJcmV0dXJuIDA7CisKK2ZhaWw6CisJZm9yIChpLS07
IGkgPj0gMDsgaS0tKQorCQlyZWd1bGF0b3Jfc2V0X2xvYWQoc1tpXS5jb25zdW1lciwgcmVnc1tp
XS5kaXNhYmxlX2xvYWQpOworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgZHBfcG93ZXJf
cmVndWxhdG9yX2luaXQoc3RydWN0IGRwX3Bvd2VyX3ByaXZhdGUgKnBvd2VyKQoreworCXN0cnVj
dCByZWd1bGF0b3JfYnVsa19kYXRhICpzID0gcG93ZXItPnN1cHBsaWVzOworCWNvbnN0IHN0cnVj
dCBkcF9yZWdfZW50cnkgKnJlZ3MgPSBwb3dlci0+cGFyc2VyLT5yZWd1bGF0b3JfY2ZnLT5yZWdz
OworCXN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYgPSBwb3dlci0+cGRldjsKKwlpbnQgbnVt
ID0gcG93ZXItPnBhcnNlci0+cmVndWxhdG9yX2NmZy0+bnVtOworCWludCBpLCByZXQ7CisKKwlm
b3IgKGkgPSAwOyBpIDwgbnVtOyBpKyspCisJCXNbaV0uc3VwcGx5ID0gcmVnc1tpXS5uYW1lOwor
CisJcmV0ID0gZGV2bV9yZWd1bGF0b3JfYnVsa19nZXQoJnBkZXYtPmRldiwgbnVtLCBzKTsKKwlp
ZiAocmV0IDwgMCkgeworCQlwcl9lcnIoIiVzOiBmYWlsZWQgdG8gaW5pdCByZWd1bGF0b3IsIHJl
dD0lZFxuIiwKKwkJCQkJCV9fZnVuY19fLCByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKworCXJl
dHVybiAwOworfQorCitzdGF0aWMgaW50IGRwX3Bvd2VyX3BpbmN0cmxfc2V0KHN0cnVjdCBkcF9w
b3dlcl9wcml2YXRlICpwb3dlciwgYm9vbCBhY3RpdmUpCit7CisJaW50IHJjID0gLUVGQVVMVDsK
KwlzdHJ1Y3QgcGluY3RybF9zdGF0ZSAqcGluX3N0YXRlOworCXN0cnVjdCBkcF9wYXJzZXIgKnBh
cnNlciA9IHBvd2VyLT5wYXJzZXI7CisKKwlpZiAoIXBhcnNlci0+Y29tYm9fcGh5X2VuKQorCQly
ZXR1cm4gMDsKKworCXBpbl9zdGF0ZSA9IGFjdGl2ZSA/IHBhcnNlci0+cGluY3RybC5zdGF0ZV9h
Y3RpdmUKKwkJCQk6IHBhcnNlci0+cGluY3RybC5zdGF0ZV9zdXNwZW5kOworCisJcmMgPSBwaW5j
dHJsX3NlbGVjdF9zdGF0ZShwYXJzZXItPnBpbmN0cmwucGluLCBwaW5fc3RhdGUpOworCWlmIChy
YykgeworCQlEUk1fRVJST1IoImNhbiBub3Qgc2V0ICVzIHBpbnNcbiIsCisJCQlhY3RpdmUgPyAi
ZHBfYWN0aXZlIiA6ICJkcF9zbGVlcCIpOworCQlyZXR1cm4gcmM7CisJfQorCisJcmV0dXJuIDA7
Cit9CisKK3N0YXRpYyBpbnQgZHBfcG93ZXJfY2xrX2luaXQoc3RydWN0IGRwX3Bvd2VyX3ByaXZh
dGUgKnBvd2VyKQoreworCWludCByYyA9IDA7CisJc3RydWN0IGRzc19tb2R1bGVfcG93ZXIgKmNv
cmUsICpjdHJsOworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZwb3dlci0+cGRldi0+ZGV2OworCisJ
Y29yZSA9ICZwb3dlci0+cGFyc2VyLT5tcFtEUF9DT1JFX1BNXTsKKwljdHJsID0gJnBvd2VyLT5w
YXJzZXItPm1wW0RQX0NUUkxfUE1dOworCisJaWYgKHBvd2VyLT5wYXJzZXItPnBsbCAmJiBwb3dl
ci0+cGFyc2VyLT5wbGwtPmdldF9wcm92aWRlcikgeworCQlyYyA9IHBvd2VyLT5wYXJzZXItPnBs
bC0+Z2V0X3Byb3ZpZGVyKHBvd2VyLT5wYXJzZXItPnBsbCwKKwkJCQkmcG93ZXItPmxpbmtfcHJv
dmlkZXIsICZwb3dlci0+cGl4ZWxfcHJvdmlkZXIpOworCQlpZiAocmMpIHsKKwkJCXByX2luZm8o
IiVzOiBjYW4ndCBnZXQgcHJvdmlkZXIgZnJvbSBwbGwsIGRvbid0IHNldCBwYXJlbnRcbiIsCisJ
CQkJX19mdW5jX18pOworCQkJcmV0dXJuIDA7CisJCX0KKwl9CisKKwlyYyA9IG1zbV9kc3NfZ2V0
X2NsayhkZXYsIGNvcmUtPmNsa19jb25maWcsIGNvcmUtPm51bV9jbGspOworCWlmIChyYykgewor
CQlEUk1fRVJST1IoImZhaWxlZCB0byBnZXQgJXMgY2xrLiBlcnI9JWRcbiIsCisJCQlkcF9wYXJz
ZXJfcG1fbmFtZShEUF9DT1JFX1BNKSwgcmMpOworCQlyZXR1cm4gcmM7CisJfQorCisJcmMgPSBt
c21fZHNzX2dldF9jbGsoZGV2LCBjdHJsLT5jbGtfY29uZmlnLCBjdHJsLT5udW1fY2xrKTsKKwlp
ZiAocmMpIHsKKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gZ2V0ICVzIGNsay4gZXJyPSVkXG4iLAor
CQkJZHBfcGFyc2VyX3BtX25hbWUoRFBfQ1RSTF9QTSksIHJjKTsKKwkJbXNtX2Rzc19wdXRfY2xr
KGNvcmUtPmNsa19jb25maWcsIGNvcmUtPm51bV9jbGspOworCQlyZXR1cm4gLUVOT0RFVjsKKwl9
CisKKwlwb3dlci0+cGl4ZWxfY2xrX3JjZyA9IGRldm1fY2xrX2dldChkZXYsICJwaXhlbF9jbGtf
cmNnIik7CisJaWYgKElTX0VSUihwb3dlci0+cGl4ZWxfY2xrX3JjZykpIHsKKwkJRFJNX0RFQlVH
X0RQKCJVbmFibGUgdG8gZ2V0IERQIHBpeGVsIGNsayBSQ0dcbiIpOworCQlwb3dlci0+cGl4ZWxf
Y2xrX3JjZyA9IE5VTEw7CisJCW1zbV9kc3NfcHV0X2Nsayhjb3JlLT5jbGtfY29uZmlnLCBjb3Jl
LT5udW1fY2xrKTsKKwkJcmV0dXJuIC1FTk9ERVY7CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3N0
YXRpYyBpbnQgZHBfcG93ZXJfY2xrX2RlaW5pdChzdHJ1Y3QgZHBfcG93ZXJfcHJpdmF0ZSAqcG93
ZXIpCit7CisJc3RydWN0IGRzc19tb2R1bGVfcG93ZXIgKmNvcmUsICpjdHJsOworCisJY29yZSA9
ICZwb3dlci0+cGFyc2VyLT5tcFtEUF9DT1JFX1BNXTsKKwljdHJsID0gJnBvd2VyLT5wYXJzZXIt
Pm1wW0RQX0NUUkxfUE1dOworCisJaWYgKCFjb3JlIHx8ICFjdHJsKSB7CisJCURSTV9FUlJPUigi
aW52YWxpZCBwb3dlcl9kYXRhXG4iKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJbXNtX2Rz
c19wdXRfY2xrKGN0cmwtPmNsa19jb25maWcsIGN0cmwtPm51bV9jbGspOworCW1zbV9kc3NfcHV0
X2Nsayhjb3JlLT5jbGtfY29uZmlnLCBjb3JlLT5udW1fY2xrKTsKKwlyZXR1cm4gMDsKK30KKwor
c3RhdGljIGludCBkcF9wb3dlcl9jbGtfc2V0X3JhdGUoc3RydWN0IGRwX3Bvd2VyX3ByaXZhdGUg
KnBvd2VyLAorCQllbnVtIGRwX3BtX3R5cGUgbW9kdWxlLCBib29sIGVuYWJsZSkKK3sKKwlpbnQg
cmMgPSAwOworCXN0cnVjdCBkc3NfbW9kdWxlX3Bvd2VyICptcCA9ICZwb3dlci0+cGFyc2VyLT5t
cFttb2R1bGVdOworCisJaWYgKGVuYWJsZSkgeworCQlyYyA9IG1zbV9kc3NfY2xrX3NldF9yYXRl
KG1wLT5jbGtfY29uZmlnLCBtcC0+bnVtX2Nsayk7CisJCWlmIChyYykgeworCQkJRFJNX0VSUk9S
KCJmYWlsZWQgdG8gc2V0IGNsa3MgcmF0ZS5cbiIpOworCQkJcmV0dXJuIHJjOworCQl9CisJfQor
CisJcmMgPSBtc21fZHNzX2VuYWJsZV9jbGsobXAtPmNsa19jb25maWcsIG1wLT5udW1fY2xrLCBl
bmFibGUpOworCWlmIChyYykgeworCQlEUk1fRVJST1IoImZhaWxlZCB0byAlZCBjbGtzLCBlcnI6
ICVkXG4iLCBlbmFibGUsIHJjKTsKKwkJcmV0dXJuIHJjOworCX0KKworCXJldHVybiAwOworfQor
CitpbnQgZHBfcG93ZXJfY2xrX2VuYWJsZShzdHJ1Y3QgZHBfcG93ZXIgKmRwX3Bvd2VyLAorCQll
bnVtIGRwX3BtX3R5cGUgcG1fdHlwZSwgYm9vbCBlbmFibGUpCit7CisJaW50IHJjID0gMDsKKwlz
dHJ1Y3QgZHNzX21vZHVsZV9wb3dlciAqbXA7CisJc3RydWN0IGRwX3Bvd2VyX3ByaXZhdGUgKnBv
d2VyOworCisJcG93ZXIgPSBjb250YWluZXJfb2YoZHBfcG93ZXIsIHN0cnVjdCBkcF9wb3dlcl9w
cml2YXRlLCBkcF9wb3dlcik7CisJbXAgPSAmcG93ZXItPnBhcnNlci0+bXBbcG1fdHlwZV07CisK
KwlpZiAocG1fdHlwZSAhPSBEUF9DT1JFX1BNICYmIHBtX3R5cGUgIT0gRFBfQ1RSTF9QTSkgewor
CQlEUk1fRVJST1IoInVuc3VwcG9ydGVkIHBvd2VyIG1vZHVsZTogJXNcbiIsCisJCQkJZHBfcGFy
c2VyX3BtX25hbWUocG1fdHlwZSkpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlpZiAoZW5h
YmxlKSB7CisJCWlmIChwbV90eXBlID09IERQX0NPUkVfUE0gJiYgZHBfcG93ZXItPmNvcmVfY2xr
c19vbikgeworCQkJRFJNX0RFQlVHX0RQKCJjb3JlIGNsa3MgYWxyZWFkeSBlbmFibGVkXG4iKTsK
KwkJCXJldHVybiAwOworCQl9CisKKwkJaWYgKHBtX3R5cGUgPT0gRFBfQ1RSTF9QTSAmJiBkcF9w
b3dlci0+bGlua19jbGtzX29uKSB7CisJCQlEUk1fREVCVUdfRFAoImxpbmtzIGNsa3MgYWxyZWFk
eSBlbmFibGVkXG4iKTsKKwkJCXJldHVybiAwOworCQl9CisKKwkJaWYgKChwbV90eXBlID09IERQ
X0NUUkxfUE0pICYmICghZHBfcG93ZXItPmNvcmVfY2xrc19vbikpIHsKKwkJCURSTV9ERUJVR19E
UCgiTmVlZCB0byBlbmFibGUgY29yZSBjbGtzIGJlZm9yZSBsaW5rIGNsa3NcbiIpOworCisJCQly
YyA9IGRwX3Bvd2VyX2Nsa19zZXRfcmF0ZShwb3dlciwgRFBfQ09SRV9QTSwgZW5hYmxlKTsKKwkJ
CWlmIChyYykgeworCQkJCURSTV9FUlJPUigiZmFpbGVkIHRvIGVuYWJsZSBjbGtzOiAlcy4gZXJy
PSVkXG4iLAorCQkJCQlkcF9wYXJzZXJfcG1fbmFtZShEUF9DT1JFX1BNKSwgcmMpOworCQkJCXJl
dHVybiByYzsKKwkJCX0KKwkJCWRwX3Bvd2VyLT5jb3JlX2Nsa3Nfb24gPSB0cnVlOworCQl9CisJ
fQorCisJcmMgPSBkcF9wb3dlcl9jbGtfc2V0X3JhdGUocG93ZXIsIHBtX3R5cGUsIGVuYWJsZSk7
CisJaWYgKHJjKSB7CisJCURSTV9FUlJPUigiZmFpbGVkIHRvICclcycgY2xrcyBmb3I6ICVzLiBl
cnI9JWRcbiIsCisJCQllbmFibGUgPyAiZW5hYmxlIiA6ICJkaXNhYmxlIiwKKwkJCWRwX3BhcnNl
cl9wbV9uYW1lKHBtX3R5cGUpLCByYyk7CisJCQlyZXR1cm4gcmM7CisJfQorCisJaWYgKHBtX3R5
cGUgPT0gRFBfQ09SRV9QTSkKKwkJZHBfcG93ZXItPmNvcmVfY2xrc19vbiA9IGVuYWJsZTsKKwll
bHNlCisJCWRwX3Bvd2VyLT5saW5rX2Nsa3Nfb24gPSBlbmFibGU7CisKKwlEUk1fREVCVUdfRFAo
IiVzIGNsb2NrcyBmb3IgJXNcbiIsCisJCQllbmFibGUgPyAiZW5hYmxlIiA6ICJkaXNhYmxlIiwK
KwkJCWRwX3BhcnNlcl9wbV9uYW1lKHBtX3R5cGUpKTsKKwlEUk1fREVCVUdfRFAoImxpbmtfY2xr
czolcyBjb3JlX2Nsa3M6JXNcbiIsCisJCWRwX3Bvd2VyLT5saW5rX2Nsa3Nfb24gPyAib24iIDog
Im9mZiIsCisJCWRwX3Bvd2VyLT5jb3JlX2Nsa3Nfb24gPyAib24iIDogIm9mZiIpOworCisJcmV0
dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgZHBfcG93ZXJfcmVxdWVzdF9ncGlvcyhzdHJ1Y3QgZHBf
cG93ZXJfcHJpdmF0ZSAqcG93ZXIpCit7CisJaW50IHJjID0gMDsKKwlzdHJ1Y3QgZGV2aWNlICpk
ZXYgPSAmcG93ZXItPnBkZXYtPmRldjsKKwlzdHJ1Y3QgZHBfcGFyc2VyICpwYXJzZXIgPSBwb3dl
ci0+cGFyc2VyOworCisJaWYgKGdwaW9faXNfdmFsaWQocGFyc2VyLT5hdXhfZW5fZ3BpbykpIHsK
KwkJcmMgPSBkZXZtX2dwaW9fcmVxdWVzdChkZXYsIHBhcnNlci0+YXV4X2VuX2dwaW8sICJhdXhf
ZW5hYmxlIik7CisJCWlmIChyYykgeworCQkJRFJNX0VSUk9SKCJyZXF1ZXN0IGF1eF9lbmFibGUg
Z3BpbyBmYWlsZWQsIHJjPSVkXG4iLCByYyk7CisJCQlyZXR1cm4gcmM7CisJCX0KKwl9CisJaWYg
KGdwaW9faXNfdmFsaWQocGFyc2VyLT5hdXhfc2VsX2dwaW8pKSB7CisJCXJjID0gZGV2bV9ncGlv
X3JlcXVlc3QoZGV2LCBwYXJzZXItPmF1eF9zZWxfZ3BpbywgImF1eF9zZWwiKTsKKwkJaWYgKHJj
KSB7CisJCQlEUk1fRVJST1IoInJlcXVlc3QgYXV4X3NlbCBncGlvIGZhaWxlZCwgcmM9JWRcbiIs
IHJjKTsKKwkJCXJldHVybiByYzsKKwkJfQorCX0KKwlpZiAoZ3Bpb19pc192YWxpZChwYXJzZXIt
PnVzYnBsdWdfY2NfZ3BpbykpIHsKKwkJcmMgPSBkZXZtX2dwaW9fcmVxdWVzdChkZXYsIHBhcnNl
ci0+dXNicGx1Z19jY19ncGlvLCAidXNicGx1Z19jYyIpOworCQlpZiAocmMpIHsKKwkJCURSTV9F
UlJPUigicmVxdWVzdCB1c2JwbHVnX2NjIGdwaW8gZmFpbGVkLCByYz0lZFxuIiwgcmMpOworCQkJ
cmV0dXJuIHJjOworCQl9CisJfQorCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBkcF9wb3dl
cl9zZXRfZ3BpbyhzdHJ1Y3QgZHBfcG93ZXJfcHJpdmF0ZSAqcG93ZXIsIGJvb2wgZmxpcCkKK3sK
KwlzdHJ1Y3QgZHBfcGFyc2VyICpwYXJzZXIgPSBwb3dlci0+cGFyc2VyOworCisJaWYgKGdwaW9f
aXNfdmFsaWQocGFyc2VyLT5hdXhfc2VsX2dwaW8pKQorCQlncGlvX2RpcmVjdGlvbl9vdXRwdXQo
cGFyc2VyLT5hdXhfc2VsX2dwaW8sIGZsaXApOworCisJaWYgKGdwaW9faXNfdmFsaWQocGFyc2Vy
LT5hdXhfZW5fZ3BpbykpCisJCWdwaW9fZGlyZWN0aW9uX291dHB1dChwYXJzZXItPmF1eF9lbl9n
cGlvLCAwKTsKKworCWlmIChncGlvX2lzX3ZhbGlkKHBhcnNlci0+dXNicGx1Z19jY19ncGlvKSkK
KwkJZ3Bpb19zZXRfdmFsdWUocGFyc2VyLT51c2JwbHVnX2NjX2dwaW8sIDApOworfQorCitzdGF0
aWMgaW50IGRwX3Bvd2VyX2NvbmZpZ19ncGlvcyhzdHJ1Y3QgZHBfcG93ZXJfcHJpdmF0ZSAqcG93
ZXIsIGJvb2wgZmxpcCkKK3sKKwlpbnQgcmMgPSAwOworCXN0cnVjdCBkcF9wYXJzZXIgKnBhcnNl
ciA9IHBvd2VyLT5wYXJzZXI7CisKKwlpZiAoIXBhcnNlci0+Y29tYm9fcGh5X2VuKQorCQlyZXR1
cm4gcmM7CisKKwlyYyA9IGRwX3Bvd2VyX3JlcXVlc3RfZ3Bpb3MocG93ZXIpOworCWlmIChyYykg
eworCQlEUk1fRVJST1IoImdwaW8gcmVxdWVzdCBmYWlsZWRcbiIpOworCQlyZXR1cm4gcmM7CisJ
fQorCisJZHBfcG93ZXJfc2V0X2dwaW8ocG93ZXIsIGZsaXApOworCXJldHVybiAwOworfQorCitz
dGF0aWMgdm9pZCBkcF9wb3dlcl9kaXNhYmxlX2dwaW9zKHN0cnVjdCBkcF9wb3dlcl9wcml2YXRl
ICpwb3dlcikKK3sKKwlzdHJ1Y3QgZHBfcGFyc2VyICpwYXJzZXIgPSBwb3dlci0+cGFyc2VyOwor
CisJaWYgKCFwYXJzZXItPmNvbWJvX3BoeV9lbikKKwkJcmV0dXJuOworCisJZ3Bpb19zZXRfdmFs
dWUocGFyc2VyLT5hdXhfc2VsX2dwaW8sIDApOworCWdwaW9fc2V0X3ZhbHVlKHBhcnNlci0+YXV4
X2VuX2dwaW8sIDApOworCWdwaW9fc2V0X3ZhbHVlKHBhcnNlci0+dXNicGx1Z19jY19ncGlvLCAw
KTsKKwlncGlvX2ZyZWUocGFyc2VyLT5hdXhfc2VsX2dwaW8pOworCWdwaW9fZnJlZShwYXJzZXIt
PmF1eF9lbl9ncGlvKTsKKwlncGlvX2ZyZWUocGFyc2VyLT51c2JwbHVnX2NjX2dwaW8pOworfQor
CitpbnQgZHBfcG93ZXJfY2xpZW50X2luaXQoc3RydWN0IGRwX3Bvd2VyICpkcF9wb3dlcikKK3sK
KwlpbnQgcmMgPSAwOworCXN0cnVjdCBkcF9wb3dlcl9wcml2YXRlICpwb3dlcjsKKworCWlmICgh
ZHBfcG93ZXIpIHsKKwkJRFJNX0VSUk9SKCJpbnZhbGlkIHBvd2VyIGRhdGFcbiIpOworCQlyZXR1
cm4gLUVJTlZBTDsKKwl9CisKKwlwb3dlciA9IGNvbnRhaW5lcl9vZihkcF9wb3dlciwgc3RydWN0
IGRwX3Bvd2VyX3ByaXZhdGUsIGRwX3Bvd2VyKTsKKworCXBtX3J1bnRpbWVfZW5hYmxlKCZwb3dl
ci0+cGRldi0+ZGV2KTsKKworCXJjID0gZHBfcG93ZXJfcmVndWxhdG9yX2luaXQocG93ZXIpOwor
CWlmIChyYykgeworCQlEUk1fRVJST1IoImZhaWxlZCB0byBpbml0IHJlZ3VsYXRvcnMgJWRcbiIs
IHJjKTsKKwkJZ290byBlcnJvcjsKKwl9CisKKwlyYyA9IGRwX3Bvd2VyX2Nsa19pbml0KHBvd2Vy
KTsKKwlpZiAocmMpIHsKKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gaW5pdCBjbG9ja3MgJWRcbiIs
IHJjKTsKKwkJZ290byBlcnJvcjsKKwl9CisJcmV0dXJuIDA7CisKK2Vycm9yOgorCXBtX3J1bnRp
bWVfZGlzYWJsZSgmcG93ZXItPnBkZXYtPmRldik7CisJcmV0dXJuIHJjOworfQorCit2b2lkIGRw
X3Bvd2VyX2NsaWVudF9kZWluaXQoc3RydWN0IGRwX3Bvd2VyICpkcF9wb3dlcikKK3sKKwlzdHJ1
Y3QgZHBfcG93ZXJfcHJpdmF0ZSAqcG93ZXI7CisKKwlpZiAoIWRwX3Bvd2VyKSB7CisJCURSTV9F
UlJPUigiaW52YWxpZCBwb3dlciBkYXRhXG4iKTsKKwkJcmV0dXJuOworCX0KKworCXBvd2VyID0g
Y29udGFpbmVyX29mKGRwX3Bvd2VyLCBzdHJ1Y3QgZHBfcG93ZXJfcHJpdmF0ZSwgZHBfcG93ZXIp
OworCisJZHBfcG93ZXJfY2xrX2RlaW5pdChwb3dlcik7CisJcG1fcnVudGltZV9kaXNhYmxlKCZw
b3dlci0+cGRldi0+ZGV2KTsKKworfQorCitpbnQgZHBfcG93ZXJfc2V0X2xpbmtfY2xrX3BhcmVu
dChzdHJ1Y3QgZHBfcG93ZXIgKmRwX3Bvd2VyKQoreworCWludCByYyA9IDA7CisJc3RydWN0IGRw
X3Bvd2VyX3ByaXZhdGUgKnBvd2VyOworCXUzMiBudW07CisJc3RydWN0IGRzc19jbGsgKmNmZzsK
KwljaGFyICpuYW1lID0gImN0cmxfbGlua19jbGsiOworCisJaWYgKCFkcF9wb3dlcikgeworCQlE
Uk1fRVJST1IoImludmFsaWQgcG93ZXIgZGF0YVxuIik7CisJCXJjID0gLUVJTlZBTDsKKwkJZ290
byBleGl0OworCX0KKworCXBvd2VyID0gY29udGFpbmVyX29mKGRwX3Bvd2VyLCBzdHJ1Y3QgZHBf
cG93ZXJfcHJpdmF0ZSwgZHBfcG93ZXIpOworCisJbnVtID0gcG93ZXItPnBhcnNlci0+bXBbRFBf
Q1RSTF9QTV0ubnVtX2NsazsKKwljZmcgPSBwb3dlci0+cGFyc2VyLT5tcFtEUF9DVFJMX1BNXS5j
bGtfY29uZmlnOworCisJd2hpbGUgKG51bSAmJiBzdHJjbXAoY2ZnLT5jbGtfbmFtZSwgbmFtZSkp
IHsKKwkJbnVtLS07CisJCWNmZysrOworCX0KKworCWlmIChudW0gJiYgcG93ZXItPmxpbmtfcHJv
dmlkZXIpIHsKKwkJcG93ZXItPmxpbmtfY2xrX3NyYyA9IGNsa19nZXRfcGFyZW50KGNmZy0+Y2xr
KTsKKwkJCWlmIChwb3dlci0+bGlua19jbGtfc3JjKSB7CisJCQkJY2xrX3NldF9wYXJlbnQocG93
ZXItPmxpbmtfY2xrX3NyYywgcG93ZXItPmxpbmtfcHJvdmlkZXIpOworCQkJCURSTV9ERUJVR19E
UCgiJXM6IGlzIHRoZSBwYXJlbnQgb2YgY2xrPSVzXG4iLAorCQkJCQkJX19jbGtfZ2V0X25hbWUo
cG93ZXItPmxpbmtfcHJvdmlkZXIpLAorCQkJCQkJX19jbGtfZ2V0X25hbWUocG93ZXItPmxpbmtf
Y2xrX3NyYykpOworCQkJfSBlbHNlIHsKKwkJCQlEUk1fRVJST1IoImNvdWxkbid0IGdldCBwYXJl
bnQgZm9yIGNsaz0lc1xuIiwgbmFtZSk7CisJCQkJcmMgPSAtRUlOVkFMOworCQkJfQorCX0gZWxz
ZSB7CisJCURSTV9FUlJPUigiJXMgY2xvY2sgY291bGQgbm90IGJlIHNldCBwYXJlbnRcbiIsIG5h
bWUpOworCQlyYyA9IC1FSU5WQUw7CisJfQorZXhpdDoKKwlyZXR1cm4gcmM7Cit9CisKK2ludCBk
cF9wb3dlcl9zZXRfcGl4ZWxfY2xrX3BhcmVudChzdHJ1Y3QgZHBfcG93ZXIgKmRwX3Bvd2VyKQor
eworCWludCByYyA9IDA7CisJc3RydWN0IGRwX3Bvd2VyX3ByaXZhdGUgKnBvd2VyOworCisJcG93
ZXIgPSBjb250YWluZXJfb2YoZHBfcG93ZXIsIHN0cnVjdCBkcF9wb3dlcl9wcml2YXRlLCBkcF9w
b3dlcik7CisKKwlpZiAocG93ZXItPnBpeGVsX2Nsa19yY2cgJiYgcG93ZXItPnBpeGVsX3Byb3Zp
ZGVyKSB7CisJCXJjID0gY2xrX3NldF9wYXJlbnQocG93ZXItPnBpeGVsX2Nsa19yY2csIHBvd2Vy
LT5waXhlbF9wcm92aWRlcik7CisJCWlmIChyYykgeworCQkJRFJNX0VSUk9SKCJmYWlsZWQgdG8g
c2V0IHBhcmVudCBjbGsgc3JjLCAlZFxuIiwgcmMpOworCQkJcmV0dXJuIHJjOworCQl9CisJCURS
TV9ERUJVR19EUCgiJXM6IGlzIHRoZSBwYXJlbnQgb2YgY2xrPSVzXG4iLAorCQkJCQlfX2Nsa19n
ZXRfbmFtZShwb3dlci0+cGl4ZWxfcHJvdmlkZXIpLAorCQkJCQlfX2Nsa19nZXRfbmFtZShwb3dl
ci0+cGl4ZWxfY2xrX3JjZykpOworCX0KKworCXJldHVybiAwOworfQorCitpbnQgZHBfcG93ZXJf
aW5pdChzdHJ1Y3QgZHBfcG93ZXIgKmRwX3Bvd2VyLCBib29sIGZsaXApCit7CisJaW50IHJjID0g
MDsKKwlzdHJ1Y3QgZHBfcG93ZXJfcHJpdmF0ZSAqcG93ZXI7CisKKwlpZiAoIWRwX3Bvd2VyKSB7
CisJCURSTV9FUlJPUigiaW52YWxpZCBwb3dlciBkYXRhXG4iKTsKKwkJcmMgPSAtRUlOVkFMOwor
CQlnb3RvIGV4aXQ7CisJfQorCisJcG93ZXIgPSBjb250YWluZXJfb2YoZHBfcG93ZXIsIHN0cnVj
dCBkcF9wb3dlcl9wcml2YXRlLCBkcF9wb3dlcik7CisKKwlwbV9ydW50aW1lX2dldF9zeW5jKCZw
b3dlci0+cGRldi0+ZGV2KTsKKwlyYyA9IGRwX3Bvd2VyX3JlZ3VsYXRvcl9lbmFibGUocG93ZXIp
OworCWlmIChyYykgeworCQlEUk1fRVJST1IoImZhaWxlZCB0byBlbmFibGUgcmVndWxhdG9ycywg
JWRcbiIsIHJjKTsKKwkJZ290byBleGl0OworCX0KKworCXJjID0gZHBfcG93ZXJfcGluY3RybF9z
ZXQocG93ZXIsIHRydWUpOworCWlmIChyYykgeworCQlEUk1fRVJST1IoImZhaWxlZCB0byBzZXQg
cGluY3RybCBzdGF0ZSwgJWRcbiIsIHJjKTsKKwkJZ290byBlcnJfcGluY3RybDsKKwl9CisKKwly
YyA9IGRwX3Bvd2VyX2NvbmZpZ19ncGlvcyhwb3dlciwgZmxpcCk7CisJaWYgKHJjKSB7CisJCURS
TV9FUlJPUigiZmFpbGVkIHRvIGVuYWJsZSBncGlvcywgJWRcbiIsIHJjKTsKKwkJZ290byBlcnJf
Z3BpbzsKKwl9CisKKwlyYyA9IGRwX3Bvd2VyX2Nsa19lbmFibGUoZHBfcG93ZXIsIERQX0NPUkVf
UE0sIHRydWUpOworCWlmIChyYykgeworCQlEUk1fRVJST1IoImZhaWxlZCB0byBlbmFibGUgRFAg
Y29yZSBjbG9ja3MsICVkXG4iLCByYyk7CisJCWdvdG8gZXJyX2NsazsKKwl9CisKKwlyZXR1cm4g
MDsKKworZXJyX2NsazoKKwlkcF9wb3dlcl9kaXNhYmxlX2dwaW9zKHBvd2VyKTsKK2Vycl9ncGlv
OgorCWRwX3Bvd2VyX3BpbmN0cmxfc2V0KHBvd2VyLCBmYWxzZSk7CitlcnJfcGluY3RybDoKKwlk
cF9wb3dlcl9yZWd1bGF0b3JfZGlzYWJsZShwb3dlcik7CitleGl0OgorCXBtX3J1bnRpbWVfcHV0
X3N5bmMoJnBvd2VyLT5wZGV2LT5kZXYpOworCXJldHVybiByYzsKK30KKworaW50IGRwX3Bvd2Vy
X2RlaW5pdChzdHJ1Y3QgZHBfcG93ZXIgKmRwX3Bvd2VyKQoreworCXN0cnVjdCBkcF9wb3dlcl9w
cml2YXRlICpwb3dlcjsKKworCXBvd2VyID0gY29udGFpbmVyX29mKGRwX3Bvd2VyLCBzdHJ1Y3Qg
ZHBfcG93ZXJfcHJpdmF0ZSwgZHBfcG93ZXIpOworCisJZHBfcG93ZXJfY2xrX2VuYWJsZShkcF9w
b3dlciwgRFBfQ09SRV9QTSwgZmFsc2UpOworCWRwX3Bvd2VyX2Rpc2FibGVfZ3Bpb3MocG93ZXIp
OworCWRwX3Bvd2VyX3BpbmN0cmxfc2V0KHBvd2VyLCBmYWxzZSk7CisJZHBfcG93ZXJfcmVndWxh
dG9yX2Rpc2FibGUocG93ZXIpOworCXBtX3J1bnRpbWVfcHV0X3N5bmMoJnBvd2VyLT5wZGV2LT5k
ZXYpOworCXJldHVybiAwOworfQorCitzdHJ1Y3QgZHBfcG93ZXIgKmRwX3Bvd2VyX2dldChzdHJ1
Y3QgZHBfcGFyc2VyICpwYXJzZXIpCit7CisJaW50IHJjID0gMDsKKwlzdHJ1Y3QgZHBfcG93ZXJf
cHJpdmF0ZSAqcG93ZXI7CisJc3RydWN0IGRwX3Bvd2VyICpkcF9wb3dlcjsKKworCWlmICghcGFy
c2VyKSB7CisJCURSTV9FUlJPUigiaW52YWxpZCBpbnB1dFxuIik7CisJCXJjID0gLUVJTlZBTDsK
KwkJZ290byBlcnJvcjsKKwl9CisKKwlwb3dlciA9IGRldm1fa3phbGxvYygmcGFyc2VyLT5wZGV2
LT5kZXYsIHNpemVvZigqcG93ZXIpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIXBvd2VyKSB7CisJCXJj
ID0gLUVOT01FTTsKKwkJZ290byBlcnJvcjsKKwl9CisKKwlwb3dlci0+cGFyc2VyID0gcGFyc2Vy
OworCXBvd2VyLT5wZGV2ID0gcGFyc2VyLT5wZGV2OworCisJZHBfcG93ZXIgPSAmcG93ZXItPmRw
X3Bvd2VyOworCisJcmV0dXJuIGRwX3Bvd2VyOworZXJyb3I6CisJcmV0dXJuIEVSUl9QVFIocmMp
OworfQorCit2b2lkIGRwX3Bvd2VyX3B1dChzdHJ1Y3QgZHBfcG93ZXIgKmRwX3Bvd2VyKQorewor
CXN0cnVjdCBkcF9wb3dlcl9wcml2YXRlICpwb3dlciA9IE5VTEw7CisKKwlpZiAoIWRwX3Bvd2Vy
KQorCQlyZXR1cm47CisKKwlwb3dlciA9IGNvbnRhaW5lcl9vZihkcF9wb3dlciwgc3RydWN0IGRw
X3Bvd2VyX3ByaXZhdGUsIGRwX3Bvd2VyKTsKKworCWRldm1fa2ZyZWUoJnBvd2VyLT5wZGV2LT5k
ZXYsIHBvd2VyKTsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfcG93
ZXIuaCBiL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfcG93ZXIuaApuZXcgZmlsZSBtb2RlIDEw
MDY0NAppbmRleCAwMDAwMDAwLi40MGQ3ZTczCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9n
cHUvZHJtL21zbS9kcC9kcF9wb3dlci5oCkBAIC0wLDAgKzEsNTIgQEAKKy8qIFNQRFgtTGljZW5z
ZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkgKi8KKy8qCisgKiBDb3B5cmlnaHQgKGMpIDIwMTIt
MjAxOSwgVGhlIExpbnV4IEZvdW5kYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuCisgKi8KKwor
I2lmbmRlZiBfRFBfUE9XRVJfSF8KKyNkZWZpbmUgX0RQX1BPV0VSX0hfCisKKyNpbmNsdWRlICJk
cF9wYXJzZXIuaCIKKworLyoqCisgKiBzcnVjdCBkcF9wb3dlciAtIERpc3BsYXlQb3J0J3MgcG93
ZXIgcmVsYXRlZCBkYXRhCisgKgorICogQGluaXQ6IGluaXRpYWxpemVzIHRoZSByZWd1bGF0b3Jz
L2NvcmUgY2xvY2tzL0dQSU9zL3BpbmN0cmwKKyAqIEBkZWluaXQ6IHR1cm5zIG9mZiB0aGUgcmVn
dWxhdG9ycy9jb3JlIGNsb2Nrcy9HUElPcy9waW5jdHJsCisgKiBAY2xrX2VuYWJsZTogZW5hYmxl
L2Rpc2FibGUgdGhlIERQIGNsb2NrcworICogQHNldF9saW5rX2Nsa19wYXJlbnQ6IHNldCB0aGUg
cGFyZW50IG9mIERQIGxpbmsgY2xvY2sKKyAqIEBzZXRfcGl4ZWxfY2xrX3BhcmVudDogc2V0IHRo
ZSBwYXJlbnQgb2YgRFAgcGl4ZWwgY2xvY2sKKyAqLworc3RydWN0IGRwX3Bvd2VyIHsKKwlib29s
IGNvcmVfY2xrc19vbjsKKwlib29sIGxpbmtfY2xrc19vbjsKK307CisKK2ludCBkcF9wb3dlcl9p
bml0KHN0cnVjdCBkcF9wb3dlciAqcG93ZXIsIGJvb2wgZmxpcCk7CitpbnQgZHBfcG93ZXJfZGVp
bml0KHN0cnVjdCBkcF9wb3dlciAqcG93ZXIpOworaW50IGRwX3Bvd2VyX2Nsa19lbmFibGUoc3Ry
dWN0IGRwX3Bvd2VyICpwb3dlciwgZW51bSBkcF9wbV90eXBlIHBtX3R5cGUsCisJCQkJYm9vbCBl
bmFibGUpOworaW50IGRwX3Bvd2VyX3NldF9saW5rX2Nsa19wYXJlbnQoc3RydWN0IGRwX3Bvd2Vy
ICpwb3dlcik7CitpbnQgZHBfcG93ZXJfc2V0X3BpeGVsX2Nsa19wYXJlbnQoc3RydWN0IGRwX3Bv
d2VyICpwb3dlcik7CitpbnQgZHBfcG93ZXJfY2xpZW50X2luaXQoc3RydWN0IGRwX3Bvd2VyICpw
b3dlcik7Cit2b2lkIGRwX3Bvd2VyX2NsaWVudF9kZWluaXQoc3RydWN0IGRwX3Bvd2VyICpwb3dl
cik7CisKKy8qKgorICogZHBfcG93ZXJfZ2V0KCkgLSBjb25maWd1cmUgYW5kIGdldCB0aGUgRGlz
cGxheVBvcnQgcG93ZXIgbW9kdWxlIGRhdGEKKyAqCisgKiBAcGFyc2VyOiBpbnN0YW5jZSBvZiBw
YXJzZXIgbW9kdWxlCisgKiByZXR1cm46IHBvaW50ZXIgdG8gYWxsb2NhdGVkIHBvd2VyIG1vZHVs
ZSBkYXRhCisgKgorICogVGhpcyBBUEkgd2lsbCBjb25maWd1cmUgdGhlIERpc3BsYXlQb3J0J3Mg
cG93ZXIgbW9kdWxlIGFuZCBwcm92aWRlcworICogbWV0aG9kcyB0byBiZSBjYWxsZWQgYnkgdGhl
IGNsaWVudCB0byBjb25maWd1cmUgdGhlIHBvd2VyIHJlbGF0ZWQKKyAqIG1vZHVlbGVzLgorICov
CitzdHJ1Y3QgZHBfcG93ZXIgKmRwX3Bvd2VyX2dldChzdHJ1Y3QgZHBfcGFyc2VyICpwYXJzZXIp
OworCisvKioKKyAqIGRwX3Bvd2VyX3B1dCgpIC0gcmVsZWFzZSB0aGUgcG93ZXIgcmVsYXRlZCBy
ZXNvdXJjZXMKKyAqCisgKiBAcG93ZXI6IHBvaW50ZXIgdG8gdGhlIHBvd2VyIG1vZHVsZSdzIGRh
dGEKKyAqLwordm9pZCBkcF9wb3dlcl9wdXQoc3RydWN0IGRwX3Bvd2VyICpwb3dlcik7CisjZW5k
aWYgLyogX0RQX1BPV0VSX0hfICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbXNtL2Rw
L2RwX3JlZy5oIGIvZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9yZWcuaApuZXcgZmlsZSBtb2Rl
IDEwMDY0NAppbmRleCAwMDAwMDAwLi41NDY4ZjdiCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL21zbS9kcC9kcF9yZWcuaApAQCAtMCwwICsxLDQ4OCBAQAorLyogU1BEWC1MaWNl
bnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seSAqLworLyoKKyAqIENvcHlyaWdodCAoYykgMjAx
Ny0yMDE5LCBUaGUgTGludXggRm91bmRhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KKyAqLwor
CisjaWZuZGVmIF9EUF9SRUdfSF8KKyNkZWZpbmUgX0RQX1JFR19IXworCisvKiBEUF9UWCBSZWdp
c3RlcnMgKi8KKyNkZWZpbmUgUkVHX0RQX0hXX1ZFUlNJT04JCQkoMHgwMDAwMDAwMCkKKworI2Rl
ZmluZSBSRUdfRFBfU1dfUkVTRVQJCQkJKDB4MDAwMDAwMTApCisjZGVmaW5lIERQX1NXX1JFU0VU
CQkJCSgweDAwMDAwMDAxKQorCisjZGVmaW5lIFJFR19EUF9QSFlfQ1RSTAkJCQkoMHgwMDAwMDAx
NCkKKyNkZWZpbmUgRFBfUEhZX0NUUkxfU1dfUkVTRVRfUExMCQkoMHgwMDAwMDAwMSkKKyNkZWZp
bmUgRFBfUEhZX0NUUkxfU1dfUkVTRVQJCQkoMHgwMDAwMDAwNCkKKworI2RlZmluZSBSRUdfRFBf
Q0xLX0NUUkwJCQkJKDB4MDAwMDAwMTgpCisjZGVmaW5lIFJFR19EUF9DTEtfQUNUSVZFCQkJKDB4
MDAwMDAwMUMpCisjZGVmaW5lIFJFR19EUF9JTlRSX1NUQVRVUwkJCSgweDAwMDAwMDIwKQorI2Rl
ZmluZSBSRUdfRFBfSU5UUl9TVEFUVVMyCQkJKDB4MDAwMDAwMjQpCisjZGVmaW5lIFJFR19EUF9J
TlRSX1NUQVRVUzMJCQkoMHgwMDAwMDAyOCkKKworI2RlZmluZSBSRUdfRFBfRFBfSFBEX0NUUkwJ
CQkoMHgwMDAwMDAwMCkKKyNkZWZpbmUgRFBfRFBfSFBEX0NUUkxfSFBEX0VOCQkJKDB4MDAwMDAw
MDEpCisKKyNkZWZpbmUgUkVHX0RQX0RQX0hQRF9JTlRfU1RBVFVTCQkoMHgwMDAwMDAwNCkKKwor
I2RlZmluZSBSRUdfRFBfRFBfSFBEX0lOVF9BQ0sJCQkoMHgwMDAwMDAwOCkKKyNkZWZpbmUgRFBf
RFBfSFBEX1BMVUdfSU5UX0FDSwkJCSgweDAwMDAwMDAxKQorI2RlZmluZSBEUF9EUF9JUlFfSFBE
X0lOVF9BQ0sJCQkoMHgwMDAwMDAwMikKKyNkZWZpbmUgRFBfRFBfSFBEX1JFUExVR19JTlRfQUNL
CQkoMHgwMDAwMDAwNCkKKyNkZWZpbmUgRFBfRFBfSFBEX1VOUExVR19JTlRfQUNLCQkoMHgwMDAw
MDAwOCkKKworI2RlZmluZSBSRUdfRFBfRFBfSFBEX0lOVF9NQVNLCQkJKDB4MDAwMDAwMEMpCisj
ZGVmaW5lIERQX0RQX0hQRF9QTFVHX0lOVF9NQVNLCQkJKDB4MDAwMDAwMDEpCisjZGVmaW5lIERQ
X0RQX0lSUV9IUERfSU5UX01BU0sJCQkoMHgwMDAwMDAwMikKKyNkZWZpbmUgRFBfRFBfSFBEX1JF
UExVR19JTlRfTUFTSwkJKDB4MDAwMDAwMDQpCisjZGVmaW5lIERQX0RQX0hQRF9VTlBMVUdfSU5U
X01BU0sJCSgweDAwMDAwMDA4KQorCisjZGVmaW5lIFJFR19EUF9EUF9IUERfUkVGVElNRVIJCQko
MHgwMDAwMDAxOCkKKyNkZWZpbmUgUkVHX0RQX0RQX0hQRF9FVkVOVF9USU1FXzAJCSgweDAwMDAw
MDFDKQorI2RlZmluZSBSRUdfRFBfRFBfSFBEX0VWRU5UX1RJTUVfMQkJKDB4MDAwMDAwMjApCisK
KyNkZWZpbmUgUkVHX0RQX0FVWF9DVFJMCQkJCSgweDAwMDAwMDMwKQorI2RlZmluZSBEUF9BVVhf
Q1RSTF9FTkFCTEUJCQkoMHgwMDAwMDAwMSkKKyNkZWZpbmUgRFBfQVVYX0NUUkxfUkVTRVQJCQko
MHgwMDAwMDAwMikKKworI2RlZmluZSBSRUdfRFBfQVVYX0RBVEEJCQkJKDB4MDAwMDAwMzQpCisj
ZGVmaW5lIERQX0FVWF9EQVRBX1JFQUQJCQkoMHgwMDAwMDAwMSkKKyNkZWZpbmUgRFBfQVVYX0RB
VEFfV1JJVEUJCQkoMHgwMDAwMDAwMCkKKyNkZWZpbmUgRFBfQVVYX0RBVEFfT0ZGU0VUCQkJKDB4
MDAwMDAwMDgpCisjZGVmaW5lIERQX0FVWF9EQVRBX0lOREVYX09GRlNFVAkJKDB4MDAwMDAwMTAp
CisjZGVmaW5lIERQX0FVWF9EQVRBX01BU0sJCQkoMHgwMDAwZmYwMCkKKyNkZWZpbmUgRFBfQVVY
X0RBVEFfSU5ERVhfV1JJVEUJCQkoMHg4MDAwMDAwMCkKKworI2RlZmluZSBSRUdfRFBfQVVYX1RS
QU5TX0NUUkwJCQkoMHgwMDAwMDAzOCkKKyNkZWZpbmUgRFBfQVVYX1RSQU5TX0NUUkxfSTJDCQkJ
KDB4MDAwMDAxMDApCisjZGVmaW5lIERQX0FVWF9UUkFOU19DVFJMX0dPCQkJKDB4MDAwMDAyMDAp
CisjZGVmaW5lIERQX0FVWF9UUkFOU19DVFJMX05PX1NFTkRfQUREUgkJKDB4MDAwMDA0MDApCisj
ZGVmaW5lIERQX0FVWF9UUkFOU19DVFJMX05PX1NFTkRfU1RPUAkJKDB4MDAwMDA4MDApCisKKyNk
ZWZpbmUgUkVHX0RQX1RJTUVPVVRfQ09VTlQJCQkoMHgwMDAwMDAzQykKKyNkZWZpbmUgUkVHX0RQ
X0FVWF9MSU1JVFMJCQkoMHgwMDAwMDA0MCkKKyNkZWZpbmUgUkVHX0RQX0FVWF9TVEFUVVMJCQko
MHgwMDAwMDA0NCkKKworI2RlZmluZSBEUF9EUENEX0NQX0lSUQkJCQkoMHgyMDEpCisjZGVmaW5l
IERQX0RQQ0RfUlhTVEFUVVMJCQkoMHg2OTQ5MykKKworI2RlZmluZSBEUF9JTlRFUlJVUFRfVFJB
TlNfTlVNCQkJKDB4MDAwMDAwQTApCisKKyNkZWZpbmUgUkVHX0RQX01BSU5MSU5LX0NUUkwJCQko
MHgwMDAwMDAwMCkKKyNkZWZpbmUgRFBfTUFJTkxJTktfQ1RSTF9FTkFCTEUJCQkoMHgwMDAwMDAw
MSkKKyNkZWZpbmUgRFBfTUFJTkxJTktfQ1RSTF9SRVNFVAkJCSgweDAwMDAwMDAyKQorI2RlZmlu
ZSBEUF9NQUlOTElOS19GQl9CT1VOREFSWV9TRUwJCSgweDAyMDAwMDAwKQorCisjZGVmaW5lIFJF
R19EUF9TVEFURV9DVFJMCQkJKDB4MDAwMDAwMDQpCisjZGVmaW5lIERQX1NUQVRFX0NUUkxfTElO
S19UUkFJTklOR19QQVRURVJOMQkoMHgwMDAwMDAwMSkKKyNkZWZpbmUgRFBfU1RBVEVfQ1RSTF9M
SU5LX1RSQUlOSU5HX1BBVFRFUk4yCSgweDAwMDAwMDAyKQorI2RlZmluZSBEUF9TVEFURV9DVFJM
X0xJTktfVFJBSU5JTkdfUEFUVEVSTjMJKDB4MDAwMDAwMDQpCisjZGVmaW5lIERQX1NUQVRFX0NU
UkxfTElOS19UUkFJTklOR19QQVRURVJONAkoMHgwMDAwMDAwOCkKKyNkZWZpbmUgRFBfU1RBVEVf
Q1RSTF9MSU5LX1NZTUJPTF9FUlJfTUVBU1VSRQkoMHgwMDAwMDAxMCkKKyNkZWZpbmUgRFBfU1RB
VEVfQ1RSTF9MSU5LX1BSQlM3CQkoMHgwMDAwMDAyMCkKKyNkZWZpbmUgRFBfU1RBVEVfQ1RSTF9M
SU5LX1RFU1RfQ1VTVE9NX1BBVFRFUk4JKDB4MDAwMDAwNDApCisjZGVmaW5lIERQX1NUQVRFX0NU
UkxfU0VORF9WSURFTwkJKDB4MDAwMDAwODApCisjZGVmaW5lIERQX1NUQVRFX0NUUkxfUFVTSF9J
RExFIAkJKDB4MDAwMDAxMDApCisKKyNkZWZpbmUgUkVHX0RQX0NPTkZJR1VSQVRJT05fQ1RSTAkJ
KDB4MDAwMDAwMDgpCisjZGVmaW5lIERQX0NPTkZJR1VSQVRJT05fQ1RSTF9TWU5DX0FTWU5DX0NM
SwkoMHgwMDAwMDAwMSkKKyNkZWZpbmUgRFBfQ09ORklHVVJBVElPTl9DVFJMX1NUQVRJQ19EWU5B
TUlDX0NOICgweDAwMDAwMDAyKQorI2RlZmluZSBEUF9DT05GSUdVUkFUSU9OX0NUUkxfUF9JTlRF
UkxBQ0VECSgweDAwMDAwMDA0KQorI2RlZmluZSBEUF9DT05GSUdVUkFUSU9OX0NUUkxfSU5URVJM
QUNFRF9CVEYJKDB4MDAwMDAwMDgpCisjZGVmaW5lIERQX0NPTkZJR1VSQVRJT05fQ1RSTF9OVU1f
T0ZfTEFORVMJKDB4MDAwMDAwMTApCisjZGVmaW5lIERQX0NPTkZJR1VSQVRJT05fQ1RSTF9FTkhB
TkNFRF9GUkFNSU5HCSgweDAwMDAwMDQwKQorI2RlZmluZSBEUF9DT05GSUdVUkFUSU9OX0NUUkxf
U0VORF9WU0MJCSgweDAwMDAwMDgwKQorI2RlZmluZSBEUF9DT05GSUdVUkFUSU9OX0NUUkxfQlBD
CQkoMHgwMDAwMDEwMCkKKyNkZWZpbmUgRFBfQ09ORklHVVJBVElPTl9DVFJMX0FTU1IJCSgweDAw
MDAwNDAwKQorI2RlZmluZSBEUF9DT05GSUdVUkFUSU9OX0NUUkxfUkdCX1lVVgkJKDB4MDAwMDA4
MDApCisjZGVmaW5lIERQX0NPTkZJR1VSQVRJT05fQ1RSTF9MU0NMS19ESVYJCSgweDAwMDAyMDAw
KQorI2RlZmluZSBEUF9DT05GSUdVUkFUSU9OX0NUUkxfTlVNX09GX0xBTkVTX1NISUZUICAgICAg
KDB4MDQpCisjZGVmaW5lIERQX0NPTkZJR1VSQVRJT05fQ1RSTF9CUENfU0hJRlQgCSAgICAgICgw
eDA4KQorI2RlZmluZSBEUF9DT05GSUdVUkFUSU9OX0NUUkxfTFNDTEtfRElWX1NISUZUCSAgICAg
ICgweDBEKQorCisjZGVmaW5lIFJFR19EUF9TT0ZUV0FSRV9NVklECQkJKDB4MDAwMDAwMTApCisj
ZGVmaW5lIFJFR19EUF9TT0ZUV0FSRV9OVklECQkJKDB4MDAwMDAwMTgpCisjZGVmaW5lIFJFR19E
UF9UT1RBTF9IT1JfVkVSCQkJKDB4MDAwMDAwMUMpCisjZGVmaW5lIFJFR19EUF9TVEFSVF9IT1Jf
VkVSX0ZST01fU1lOQwkJKDB4MDAwMDAwMjApCisjZGVmaW5lIFJFR19EUF9IU1lOQ19WU1lOQ19X
SURUSF9QT0xBUklUWQkoMHgwMDAwMDAyNCkKKyNkZWZpbmUgUkVHX0RQX0FDVElWRV9IT1JfVkVS
CQkJKDB4MDAwMDAwMjgpCisKKyNkZWZpbmUgUkVHX0RQX01JU0MxX01JU0MwCQkJKDB4MDAwMDAw
MkMpCisjZGVmaW5lIERQX01JU0MwX1NZTkNIUk9OT1VTX0NMSwkJKDB4MDAwMDAwMDEpCisjZGVm
aW5lIERQX01JU0MwX0NPTE9SSU1FVFJZX0NGR19TSElGVAkJKDB4MDAwMDAwMDEpCisjZGVmaW5l
IERQX01JU0MwX1RFU1RfQklUU19ERVBUSF9TSElGVAkJKDB4MDAwMDAwMDUpCisKKyNkZWZpbmUg
UkVHX0RQX1ZBTElEX0JPVU5EQVJZCQkJKDB4MDAwMDAwMzApCisjZGVmaW5lIFJFR19EUF9WQUxJ
RF9CT1VOREFSWV8yCQkJKDB4MDAwMDAwMzQpCisKKyNkZWZpbmUgUkVHX0RQX0xPR0lDQUwyUEhZ
U0lDQUxfTEFORV9NQVBQSU5HCSgweDAwMDAwMDM4KQorI2RlZmluZSBMQU5FMF9NQVBQSU5HX1NI
SUZUCQkJKDB4MDAwMDAwMDApCisjZGVmaW5lIExBTkUxX01BUFBJTkdfU0hJRlQJCQkoMHgwMDAw
MDAwMikKKyNkZWZpbmUgTEFORTJfTUFQUElOR19TSElGVAkJCSgweDAwMDAwMDA0KQorI2RlZmlu
ZSBMQU5FM19NQVBQSU5HX1NISUZUCQkJKDB4MDAwMDAwMDYpCisKKyNkZWZpbmUgUkVHX0RQX01B
SU5MSU5LX1JFQURZCQkJKDB4MDAwMDAwNDApCisjZGVmaW5lIERQX01BSU5MSU5LX1JFQURZX0ZP
Ul9WSURFTwkJKDB4MDAwMDAwMDEpCisjZGVmaW5lIERQX01BSU5MSU5LX1JFQURZX0xJTktfVFJB
SU5JTkdfU0hJRlQJKDB4MDAwMDAwMDMpCisKKyNkZWZpbmUgUkVHX0RQX01BSU5MSU5LX0xFVkVM
UwkJCSgweDAwMDAwMDQ0KQorI2RlZmluZSBEUF9NQUlOTElOS19TQUZFX1RPX0VYSVRfTEVWRUxf
MgkoMHgwMDAwMDAwMikKKworCisjZGVmaW5lIFJFR19EUF9UVQkJCQkoMHgwMDAwMDA0QykKKwor
I2RlZmluZSBSRUdfRFBfSEJSMl9DT01QTElBTkNFX1NDUkFNQkxFUl9SRVNFVAkoMHgwMDAwMDA1
NCkKKyNkZWZpbmUgRFBfSEJSMl9FUk1fUEFUVEVSTgkJCSgweDAwMDEwMDAwKQorCisjZGVmaW5l
IFJFR19EUF9URVNUXzgwQklUX0NVU1RPTV9QQVRURVJOX1JFRzAJKDB4MDAwMDAwQzApCisjZGVm
aW5lIFJFR19EUF9URVNUXzgwQklUX0NVU1RPTV9QQVRURVJOX1JFRzEJKDB4MDAwMDAwQzQpCisj
ZGVmaW5lIFJFR19EUF9URVNUXzgwQklUX0NVU1RPTV9QQVRURVJOX1JFRzIJKDB4MDAwMDAwQzgp
CisKKyNkZWZpbmUgTU1TU19EUF9NSVNDMV9NSVNDMAkJCSgweDAwMDAwMDJDKQorI2RlZmluZSBN
TVNTX0RQX0FVRElPX1RJTUlOR19HRU4JCSgweDAwMDAwMDgwKQorI2RlZmluZSBNTVNTX0RQX0FV
RElPX1RJTUlOR19SQlJfMzIJCSgweDAwMDAwMDg0KQorI2RlZmluZSBNTVNTX0RQX0FVRElPX1RJ
TUlOR19IQlJfMzIJCSgweDAwMDAwMDg4KQorI2RlZmluZSBNTVNTX0RQX0FVRElPX1RJTUlOR19S
QlJfNDQJCSgweDAwMDAwMDhDKQorI2RlZmluZSBNTVNTX0RQX0FVRElPX1RJTUlOR19IQlJfNDQJ
CSgweDAwMDAwMDkwKQorI2RlZmluZSBNTVNTX0RQX0FVRElPX1RJTUlOR19SQlJfNDgJCSgweDAw
MDAwMDk0KQorI2RlZmluZSBNTVNTX0RQX0FVRElPX1RJTUlOR19IQlJfNDgJCSgweDAwMDAwMDk4
KQorCisjZGVmaW5lIE1NU1NfRFBfUFNSX0NSQ19SRwkJCSgweDAwMDAwMTU0KQorI2RlZmluZSBN
TVNTX0RQX1BTUl9DUkNfQgkJCSgweDAwMDAwMTU4KQorCisjZGVmaW5lIFJFR19EUF9DT01QUkVT
U0lPTl9NT0RFX0NUUkwJCSgweDAwMDAwMTgwKQorCisjZGVmaW5lIE1NU1NfRFBfQVVESU9fQ0ZH
CQkJKDB4MDAwMDAyMDApCisjZGVmaW5lIE1NU1NfRFBfQVVESU9fU1RBVFVTCQkJKDB4MDAwMDAy
MDQpCisjZGVmaW5lIE1NU1NfRFBfQVVESU9fUEtUX0NUUkwJCQkoMHgwMDAwMDIwOCkKKyNkZWZp
bmUgTU1TU19EUF9BVURJT19QS1RfQ1RSTDIJCQkoMHgwMDAwMDIwQykKKyNkZWZpbmUgTU1TU19E
UF9BVURJT19BQ1JfQ1RSTAkJCSgweDAwMDAwMjEwKQorI2RlZmluZSBNTVNTX0RQX0FVRElPX0NU
UkxfUkVTRVQJCSgweDAwMDAwMjE0KQorCisjZGVmaW5lIE1NU1NfRFBfU0RQX0NGRwkJCQkoMHgw
MDAwMDIyOCkKKyNkZWZpbmUgTU1TU19EUF9TRFBfQ0ZHMgkJCSgweDAwMDAwMjJDKQorI2RlZmlu
ZSBNTVNTX0RQX0FVRElPX1RJTUVTVEFNUF8wCQkoMHgwMDAwMDIzMCkKKyNkZWZpbmUgTU1TU19E
UF9BVURJT19USU1FU1RBTVBfMQkJKDB4MDAwMDAyMzQpCisKKyNkZWZpbmUgTU1TU19EUF9BVURJ
T19TVFJFQU1fMAkJCSgweDAwMDAwMjQwKQorI2RlZmluZSBNTVNTX0RQX0FVRElPX1NUUkVBTV8x
CQkJKDB4MDAwMDAyNDQpCisKKyNkZWZpbmUgTU1TU19EUF9FWFRFTlNJT05fMAkJCSgweDAwMDAw
MjUwKQorI2RlZmluZSBNTVNTX0RQX0VYVEVOU0lPTl8xCQkJKDB4MDAwMDAyNTQpCisjZGVmaW5l
IE1NU1NfRFBfRVhURU5TSU9OXzIJCQkoMHgwMDAwMDI1OCkKKyNkZWZpbmUgTU1TU19EUF9FWFRF
TlNJT05fMwkJCSgweDAwMDAwMjVDKQorI2RlZmluZSBNTVNTX0RQX0VYVEVOU0lPTl80CQkJKDB4
MDAwMDAyNjApCisjZGVmaW5lIE1NU1NfRFBfRVhURU5TSU9OXzUJCQkoMHgwMDAwMDI2NCkKKyNk
ZWZpbmUgTU1TU19EUF9FWFRFTlNJT05fNgkJCSgweDAwMDAwMjY4KQorI2RlZmluZSBNTVNTX0RQ
X0VYVEVOU0lPTl83CQkJKDB4MDAwMDAyNkMpCisjZGVmaW5lIE1NU1NfRFBfRVhURU5TSU9OXzgJ
CQkoMHgwMDAwMDI3MCkKKyNkZWZpbmUgTU1TU19EUF9FWFRFTlNJT05fOQkJCSgweDAwMDAwMjc0
KQorI2RlZmluZSBNTVNTX0RQX0FVRElPX0NPUFlNQU5BR0VNRU5UXzAJCSgweDAwMDAwMjc4KQor
I2RlZmluZSBNTVNTX0RQX0FVRElPX0NPUFlNQU5BR0VNRU5UXzEJCSgweDAwMDAwMjdDKQorI2Rl
ZmluZSBNTVNTX0RQX0FVRElPX0NPUFlNQU5BR0VNRU5UXzIJCSgweDAwMDAwMjgwKQorI2RlZmlu
ZSBNTVNTX0RQX0FVRElPX0NPUFlNQU5BR0VNRU5UXzMJCSgweDAwMDAwMjg0KQorI2RlZmluZSBN
TVNTX0RQX0FVRElPX0NPUFlNQU5BR0VNRU5UXzQJCSgweDAwMDAwMjg4KQorI2RlZmluZSBNTVNT
X0RQX0FVRElPX0NPUFlNQU5BR0VNRU5UXzUJCSgweDAwMDAwMjhDKQorI2RlZmluZSBNTVNTX0RQ
X0FVRElPX0lTUkNfMAkJCSgweDAwMDAwMjkwKQorI2RlZmluZSBNTVNTX0RQX0FVRElPX0lTUkNf
MQkJCSgweDAwMDAwMjk0KQorI2RlZmluZSBNTVNTX0RQX0FVRElPX0lTUkNfMgkJCSgweDAwMDAw
Mjk4KQorI2RlZmluZSBNTVNTX0RQX0FVRElPX0lTUkNfMwkJCSgweDAwMDAwMjlDKQorI2RlZmlu
ZSBNTVNTX0RQX0FVRElPX0lTUkNfNAkJCSgweDAwMDAwMkEwKQorI2RlZmluZSBNTVNTX0RQX0FV
RElPX0lTUkNfNQkJCSgweDAwMDAwMkE0KQorI2RlZmluZSBNTVNTX0RQX0FVRElPX0lORk9GUkFN
RV8wCQkoMHgwMDAwMDJBOCkKKyNkZWZpbmUgTU1TU19EUF9BVURJT19JTkZPRlJBTUVfMQkJKDB4
MDAwMDAyQUMpCisjZGVmaW5lIE1NU1NfRFBfQVVESU9fSU5GT0ZSQU1FXzIJCSgweDAwMDAwMkIw
KQorCisjZGVmaW5lIE1NU1NfRFBfR0VORVJJQzBfMAkJCSgweDAwMDAwMzAwKQorI2RlZmluZSBN
TVNTX0RQX0dFTkVSSUMwXzEJCQkoMHgwMDAwMDMwNCkKKyNkZWZpbmUgTU1TU19EUF9HRU5FUklD
MF8yCQkJKDB4MDAwMDAzMDgpCisjZGVmaW5lIE1NU1NfRFBfR0VORVJJQzBfMwkJCSgweDAwMDAw
MzBDKQorI2RlZmluZSBNTVNTX0RQX0dFTkVSSUMwXzQJCQkoMHgwMDAwMDMxMCkKKyNkZWZpbmUg
TU1TU19EUF9HRU5FUklDMF81CQkJKDB4MDAwMDAzMTQpCisjZGVmaW5lIE1NU1NfRFBfR0VORVJJ
QzBfNgkJCSgweDAwMDAwMzE4KQorI2RlZmluZSBNTVNTX0RQX0dFTkVSSUMwXzcJCQkoMHgwMDAw
MDMxQykKKyNkZWZpbmUgTU1TU19EUF9HRU5FUklDMF84CQkJKDB4MDAwMDAzMjApCisjZGVmaW5l
IE1NU1NfRFBfR0VORVJJQzBfOQkJCSgweDAwMDAwMzI0KQorI2RlZmluZSBNTVNTX0RQX0dFTkVS
SUMxXzAJCQkoMHgwMDAwMDMyOCkKKyNkZWZpbmUgTU1TU19EUF9HRU5FUklDMV8xCQkJKDB4MDAw
MDAzMkMpCisjZGVmaW5lIE1NU1NfRFBfR0VORVJJQzFfMgkJCSgweDAwMDAwMzMwKQorI2RlZmlu
ZSBNTVNTX0RQX0dFTkVSSUMxXzMJCQkoMHgwMDAwMDMzNCkKKyNkZWZpbmUgTU1TU19EUF9HRU5F
UklDMV80CQkJKDB4MDAwMDAzMzgpCisjZGVmaW5lIE1NU1NfRFBfR0VORVJJQzFfNQkJCSgweDAw
MDAwMzNDKQorI2RlZmluZSBNTVNTX0RQX0dFTkVSSUMxXzYJCQkoMHgwMDAwMDM0MCkKKyNkZWZp
bmUgTU1TU19EUF9HRU5FUklDMV83CQkJKDB4MDAwMDAzNDQpCisjZGVmaW5lIE1NU1NfRFBfR0VO
RVJJQzFfOAkJCSgweDAwMDAwMzQ4KQorI2RlZmluZSBNTVNTX0RQX0dFTkVSSUMxXzkJCQkoMHgw
MDAwMDM0QykKKworI2RlZmluZSBNTVNTX0RQX1ZTQ0VYVF8wCQkJKDB4MDAwMDAyRDApCisjZGVm
aW5lIE1NU1NfRFBfVlNDRVhUXzEJCQkoMHgwMDAwMDJENCkKKyNkZWZpbmUgTU1TU19EUF9WU0NF
WFRfMgkJCSgweDAwMDAwMkQ4KQorI2RlZmluZSBNTVNTX0RQX1ZTQ0VYVF8zCQkJKDB4MDAwMDAy
REMpCisjZGVmaW5lIE1NU1NfRFBfVlNDRVhUXzQJCQkoMHgwMDAwMDJFMCkKKyNkZWZpbmUgTU1T
U19EUF9WU0NFWFRfNQkJCSgweDAwMDAwMkU0KQorI2RlZmluZSBNTVNTX0RQX1ZTQ0VYVF82CQkJ
KDB4MDAwMDAyRTgpCisjZGVmaW5lIE1NU1NfRFBfVlNDRVhUXzcJCQkoMHgwMDAwMDJFQykKKyNk
ZWZpbmUgTU1TU19EUF9WU0NFWFRfOAkJCSgweDAwMDAwMkYwKQorI2RlZmluZSBNTVNTX0RQX1ZT
Q0VYVF85CQkJKDB4MDAwMDAyRjQpCisKKyNkZWZpbmUgTU1TU19EUF9CSVNUX0VOQUJMRQkJCSgw
eDAwMDAwMDAwKQorI2RlZmluZSBEUF9CSVNUX0VOQUJMRV9EUEJJU1RfRU4JCSgweDAwMDAwMDAx
KQorCisjZGVmaW5lIE1NU1NfRFBfVElNSU5HX0VOR0lORV9FTgkJKDB4MDAwMDAwMTApCisjZGVm
aW5lIERQX1RJTUlOR19FTkdJTkVfRU5fRU4JCQkoMHgwMDAwMDAwMSkKKworI2RlZmluZSBNTVNT
X0RQX0lOVEZfQ09ORklHCQkJKDB4MDAwMDAwMTQpCisjZGVmaW5lIE1NU1NfRFBfSU5URl9IU1lO
Q19DVEwJCQkoMHgwMDAwMDAxOCkKKyNkZWZpbmUgTU1TU19EUF9JTlRGX1ZTWU5DX1BFUklPRF9G
MAkJKDB4MDAwMDAwMUMpCisjZGVmaW5lIE1NU1NfRFBfSU5URl9WU1lOQ19QRVJJT0RfRjEJCSgw
eDAwMDAwMDIwKQorI2RlZmluZSBNTVNTX0RQX0lOVEZfVlNZTkNfUFVMU0VfV0lEVEhfRjAJKDB4
MDAwMDAwMjQpCisjZGVmaW5lIE1NU1NfRFBfSU5URl9WU1lOQ19QVUxTRV9XSURUSF9GMQkoMHgw
MDAwMDAyOCkKKyNkZWZpbmUgTU1TU19JTlRGX0RJU1BMQVlfVl9TVEFSVF9GMAkJKDB4MDAwMDAw
MkMpCisjZGVmaW5lIE1NU1NfSU5URl9ESVNQTEFZX1ZfU1RBUlRfRjEJCSgweDAwMDAwMDMwKQor
I2RlZmluZSBNTVNTX0RQX0lOVEZfRElTUExBWV9WX0VORF9GMAkJKDB4MDAwMDAwMzQpCisjZGVm
aW5lIE1NU1NfRFBfSU5URl9ESVNQTEFZX1ZfRU5EX0YxCQkoMHgwMDAwMDAzOCkKKyNkZWZpbmUg
TU1TU19EUF9JTlRGX0FDVElWRV9WX1NUQVJUX0YwCQkoMHgwMDAwMDAzQykKKyNkZWZpbmUgTU1T
U19EUF9JTlRGX0FDVElWRV9WX1NUQVJUX0YxCQkoMHgwMDAwMDA0MCkKKyNkZWZpbmUgTU1TU19E
UF9JTlRGX0FDVElWRV9WX0VORF9GMAkJKDB4MDAwMDAwNDQpCisjZGVmaW5lIE1NU1NfRFBfSU5U
Rl9BQ1RJVkVfVl9FTkRfRjEJCSgweDAwMDAwMDQ4KQorI2RlZmluZSBNTVNTX0RQX0lOVEZfRElT
UExBWV9IQ1RMCQkoMHgwMDAwMDA0QykKKyNkZWZpbmUgTU1TU19EUF9JTlRGX0FDVElWRV9IQ1RM
CQkoMHgwMDAwMDA1MCkKKyNkZWZpbmUgTU1TU19EUF9JTlRGX1BPTEFSSVRZX0NUTAkJKDB4MDAw
MDAwNTgpCisKKyNkZWZpbmUgTU1TU19EUF9UUEdfTUFJTl9DT05UUk9MCQkoMHgwMDAwMDA2MCkK
KyNkZWZpbmUgRFBfVFBHX0NIRUNLRVJFRF9SRUNUX1BBVFRFUk4JCSgweDAwMDAwMTAwKQorCisj
ZGVmaW5lIE1NU1NfRFBfVFBHX1ZJREVPX0NPTkZJRwkJKDB4MDAwMDAwNjQpCisjZGVmaW5lIERQ
X1RQR19WSURFT19DT05GSUdfQlBQXzhCSVQJCSgweDAwMDAwMDAxKQorI2RlZmluZSBEUF9UUEdf
VklERU9fQ09ORklHX1JHQgkJCSgweDAwMDAwMDA0KQorCisjZGVmaW5lIE1NU1NfRFBfQVNZTkNf
RklGT19DT05GSUcJCSgweDAwMDAwMDg4KQorCisvKkRQIFBIWSBSZWdpc3RlciBvZmZzZXRzICov
CisjZGVmaW5lIFJFR19EUF9QSFlfUkVWSVNJT05fSUQwICAgICAgICAgICAgICAgICAoMHgwMDAw
MDAwMCkKKyNkZWZpbmUgUkVHX0RQX1BIWV9SRVZJU0lPTl9JRDEgICAgICAgICAgICAgICAgICgw
eDAwMDAwMDA0KQorI2RlZmluZSBSRUdfRFBfUEhZX1JFVklTSU9OX0lEMiAgICAgICAgICAgICAg
ICAgKDB4MDAwMDAwMDgpCisjZGVmaW5lIFJFR19EUF9QSFlfUkVWSVNJT05fSUQzICAgICAgICAg
ICAgICAgICAoMHgwMDAwMDAwQykKKworI2RlZmluZSBSRUdfRFBfUEhZX0NGRyAgICAgICAgICAg
ICAgICAgICAgICAgICAgKDB4MDAwMDAwMTApCisKKyNkZWZpbmUgUkVHX0RQX1BIWV9QRF9DVEwg
ICAgICAgICAgICAgICAgICAgICAgICgweDAwMDAwMDE4KQorI2RlZmluZSBEUF9QSFlfUERfQ1RM
X1BXUkROICAgICAgICAgICAgICAgICAgICAgKDB4MDAwMDAwMDEpCisjZGVmaW5lIERQX1BIWV9Q
RF9DVExfUFNSX1BXUkROCQkJKDB4MDAwMDAwMDIpCisjZGVmaW5lIERQX1BIWV9QRF9DVExfQVVY
X1BXUkROCQkJKDB4MDAwMDAwMDQpCisjZGVmaW5lIERQX1BIWV9QRF9DVExfTEFORV8wXzFfUFdS
RE4JCSgweDAwMDAwMDA4KQorI2RlZmluZSBEUF9QSFlfUERfQ1RMX0xBTkVfMl8zX1BXUkROCQko
MHgwMDAwMDAxMCkKKyNkZWZpbmUgRFBfUEhZX1BEX0NUTF9QTExfUFdSRE4JCQkoMHgwMDAwMDAy
MCkKKyNkZWZpbmUgRFBfUEhZX1BEX0NUTF9EUF9DTEFNUF9FTgkJKDB4MDAwMDAwNDApCisKKyNk
ZWZpbmUgUkVHX0RQX1BIWV9NT0RFICAgICAgICAgICAgICAgICAgICAgICAgICgweDAwMDAwMDFD
KQorCisjZGVmaW5lIFJFR19EUF9QSFlfQVVYX0NGRzAgICAgICAgICAgICAgICAgICAgICAoMHgw
MDAwMDAyMCkKKyNkZWZpbmUgUkVHX0RQX1BIWV9BVVhfQ0ZHMSAgICAgICAgICAgICAgICAgICAg
ICgweDAwMDAwMDI0KQorI2RlZmluZSBSRUdfRFBfUEhZX0FVWF9DRkcyICAgICAgICAgICAgICAg
ICAgICAgKDB4MDAwMDAwMjgpCisjZGVmaW5lIFJFR19EUF9QSFlfQVVYX0NGRzMgICAgICAgICAg
ICAgICAgICAgICAoMHgwMDAwMDAyQykKKyNkZWZpbmUgUkVHX0RQX1BIWV9BVVhfQ0ZHNCAgICAg
ICAgICAgICAgICAgICAgICgweDAwMDAwMDMwKQorI2RlZmluZSBSRUdfRFBfUEhZX0FVWF9DRkc1
ICAgICAgICAgICAgICAgICAgICAgKDB4MDAwMDAwMzQpCisjZGVmaW5lIFJFR19EUF9QSFlfQVVY
X0NGRzYgICAgICAgICAgICAgICAgICAgICAoMHgwMDAwMDAzOCkKKyNkZWZpbmUgUkVHX0RQX1BI
WV9BVVhfQ0ZHNyAgICAgICAgICAgICAgICAgICAgICgweDAwMDAwMDNDKQorI2RlZmluZSBSRUdf
RFBfUEhZX0FVWF9DRkc4ICAgICAgICAgICAgICAgICAgICAgKDB4MDAwMDAwNDApCisjZGVmaW5l
IFJFR19EUF9QSFlfQVVYX0NGRzkgICAgICAgICAgICAgICAgICAgICAoMHgwMDAwMDA0NCkKKwor
I2RlZmluZSBSRUdfRFBfUEhZX0FVWF9JTlRFUlJVUFRfTUFTSyAgICAgICAgICAgKDB4MDAwMDAw
NDgpCisjZGVmaW5lIFBIWV9BVVhfU1RPUF9FUlJfTUFTSyAgICAgICAgICAgICAgICAgICAoMHgw
MDAwMDAwMSkKKyNkZWZpbmUgUEhZX0FVWF9ERUNfRVJSX01BU0sgICAgICAgICAgICAgICAgICAg
ICgweDAwMDAwMDAyKQorI2RlZmluZSBQSFlfQVVYX1NZTkNfRVJSX01BU0sgICAgICAgICAgICAg
ICAgICAgKDB4MDAwMDAwMDQpCisjZGVmaW5lIFBIWV9BVVhfQUxJR05fRVJSX01BU0sgICAgICAg
ICAgICAgICAgICAoMHgwMDAwMDAwOCkKKyNkZWZpbmUgUEhZX0FVWF9SRVFfRVJSX01BU0sgICAg
ICAgICAgICAgICAgICAgICgweDAwMDAwMDEwKQorCisKKyNkZWZpbmUgUkVHX0RQX1BIWV9BVVhf
SU5URVJSVVBUX0NMRUFSICAgICAgICAgICgweDAwMDAwMDRDKQorI2RlZmluZSBSRUdfRFBfUEhZ
X0FVWF9CSVNUX0NGRwkJCSgweDAwMDAwMDUwKQorCisjZGVmaW5lIFJFR19EUF9QSFlfVkNPX0RJ
VgkJCTB4MDA2NAorI2RlZmluZSBSRUdfRFBfUEhZX1RYMF9UWDFfTEFORV9DVEwJCTB4MDA2Qwor
I2RlZmluZSBSRUdfRFBfUEhZX1RYMl9UWDNfTEFORV9DVEwJCTB4MDA4OAorCisjZGVmaW5lIFJF
R19EUF9QSFlfU1BBUkUwCQkJKDB4MDBBQykKKyNkZWZpbmUgRFBfUEhZX1NQQVJFMF9NQVNLCQkJ
KDB4MDAwRikKKyNkZWZpbmUgRFBfUEhZX1NQQVJFMF9PUklFTlRBVElPTl9JTkZPX1NISUZUCSgw
eDAwMDQpOworCisjZGVmaW5lIFJFR19EUF9QSFlfU1RBVFVTCQkJKDB4MDBDMCkKKworLyogVHgg
cmVnaXN0ZXJzICovCisjZGVmaW5lIFJFR19EUF9QSFlfVFhuX0JJU1RfTU9ERV9MQU5FTk8JCTB4
MDAwMAorI2RlZmluZSBSRUdfRFBfUEhZX1RYbl9DTEtCVUZfRU5BQkxFCQkweDAwMDgKKworI2Rl
ZmluZSBSRUdfRFBfUEhZX1RYbl9UWF9FTVBfUE9TVDFfTFZMCQkweDAwMEMKKyNkZWZpbmUgRFBf
UEhZX1RYbl9UWF9FTVBfUE9TVDFfTFZMX01BU0sJMHgwMDFGCisjZGVmaW5lIERQX1BIWV9UWG5f
VFhfRU1QX1BPU1QxX0xWTF9NVVhfRU4JMHgwMDIwCisKKyNkZWZpbmUgUkVHX0RQX1BIWV9UWG5f
VFhfRFJWX0xWTAkJMHgwMDFDCisjZGVmaW5lIERQX1BIWV9UWG5fVFhfRFJWX0xWTF9NQVNLCQkw
eDAwMUYKKyNkZWZpbmUgRFBfUEhZX1RYbl9UWF9EUlZfTFZMX01VWF9FTgkJMHgwMDIwCisKKyNk
ZWZpbmUgUkVHX0RQX1BIWV9UWG5fUkVTRVRfVFNZTkNfRU4JCTB4MDAyNAorI2RlZmluZSBSRUdf
RFBfUEhZX1RYbl9QUkVfU1RBTExfTERPX0JPT1NUX0VOCTB4MDAyOAorI2RlZmluZSBSRUdfRFBf
UEhZX1RYbl9UWF9CQU5ECQkJMHgwMDJDCisjZGVmaW5lIFJFR19EUF9QSFlfVFhuX1NMRVdfQ05U
TAkJMHgwMDMwCisjZGVmaW5lIFJFR19EUF9QSFlfVFhuX0lOVEVSRkFDRV9TRUxFQ1QJCTB4MDAz
NAorCisjZGVmaW5lIFJFR19EUF9QSFlfVFhuX1JFU19DT0RFX0xBTkVfVFgJCTB4MDAzQworI2Rl
ZmluZSBSRUdfRFBfUEhZX1RYbl9SRVNfQ09ERV9MQU5FX1JYCQkweDAwNDAKKyNkZWZpbmUgUkVH
X0RQX1BIWV9UWG5fUkVTX0NPREVfTEFORV9PRkZTRVRfVFgJMHgwMDQ0CisjZGVmaW5lIFJFR19E
UF9QSFlfVFhuX1JFU19DT0RFX0xBTkVfT0ZGU0VUX1JYCTB4MDA0OAorCisjZGVmaW5lIFJFR19E
UF9QSFlfVFhuX0RFQlVHX0JVU19TRUwJCTB4MDA1OAorI2RlZmluZSBSRUdfRFBfUEhZX1RYbl9U
UkFOU0NFSVZFUl9CSUFTX0VOCTB4MDA1QworI2RlZmluZSBSRUdfRFBfUEhZX1RYbl9ISUdIWl9E
UlZSX0VOCQkweDAwNjAKKyNkZWZpbmUgUkVHX0RQX1BIWV9UWG5fVFhfUE9MX0lOVgkJMHgwMDY0
CisjZGVmaW5lIFJFR19EUF9QSFlfVFhuX1BBUlJBVEVfUkVDX0RFVEVDVF9JRExFX0VOIDB4MDA2
OAorCisjZGVmaW5lIFJFR19EUF9QSFlfVFhuX0xBTkVfTU9ERV8xCQkweDAwOEMKKworI2RlZmlu
ZSBSRUdfRFBfUEhZX1RYbl9UUkFOX0RSVlJfRU1QX0VOCQkweDAwQzAKKyNkZWZpbmUgUkVHX0RQ
X1BIWV9UWG5fVFhfSU5URVJGQUNFX01PREUJMHgwMEM0CisKKyNkZWZpbmUgUkVHX0RQX1BIWV9U
WG5fVk1PREVfQ1RSTDEJCTB4MDBGMAorCisvKiBQTEwgcmVnaXN0ZXIgb2Zmc2V0ICovCisjZGVm
aW5lIFFTRVJERVNfQ09NX0FUQl9TRUwxCQkJMHgwMDAwCisjZGVmaW5lIFFTRVJERVNfQ09NX0FU
Ql9TRUwyCQkJMHgwMDA0CisjZGVmaW5lIFFTRVJERVNfQ09NX0ZSRVFfVVBEQVRFCQkJMHgwMDA4
CisjZGVmaW5lIFFTRVJERVNfQ09NX0JHX1RJTUVSCQkJMHgwMDBDCisjZGVmaW5lIFFTRVJERVNf
Q09NX1NTQ19FTl9DRU5URVIJCTB4MDAxMAorI2RlZmluZSBRU0VSREVTX0NPTV9TU0NfQURKX1BF
UjEJCTB4MDAxNAorI2RlZmluZSBRU0VSREVTX0NPTV9TU0NfQURKX1BFUjIJCTB4MDAxOAorI2Rl
ZmluZSBRU0VSREVTX0NPTV9TU0NfUEVSMQkJCTB4MDAxQworI2RlZmluZSBRU0VSREVTX0NPTV9T
U0NfUEVSMgkJCTB4MDAyMAorI2RlZmluZSBRU0VSREVTX0NPTV9TU0NfU1RFUF9TSVpFMQkJMHgw
MDI0CisjZGVmaW5lIFFTRVJERVNfQ09NX1NTQ19TVEVQX1NJWkUyCQkweDAwMjgKKyNkZWZpbmUg
UVNFUkRFU19DT01fUE9TVF9ESVYJCQkweDAwMkMKKyNkZWZpbmUgUVNFUkRFU19DT01fUE9TVF9E
SVZfTVVYCQkweDAwMzAKKworI2RlZmluZSBRU0VSREVTX0NPTV9CSUFTX0VOX0NMS0JVRkxSX0VO
CQkweDAwMzQKKyNkZWZpbmUgUVNFUkRFU19DT01fQklBU19FTgkJCTB4MDAwMQorI2RlZmluZSBR
U0VSREVTX0NPTV9CSUFTX0VOX01VWAkJCTB4MDAwMgorI2RlZmluZSBRU0VSREVTX0NPTV9DTEtC
VUZfUl9FTgkJCTB4MDAwNAorI2RlZmluZSBRU0VSREVTX0NPTV9DTEtCVUZfTF9FTgkJCTB4MDAw
OAorI2RlZmluZSBRU0VSREVTX0NPTV9FTl9TWVNDTEtfVFhfU0VMCQkweDAwMTAKKyNkZWZpbmUg
UVNFUkRFU19DT01fQ0xLQlVGX1JYX0RSSVZFX0wJCTB4MDAyMAorI2RlZmluZSBRU0VSREVTX0NP
TV9DTEtCVUZfUlhfRFJJVkVfUgkJMHgwMDQwCisKKyNkZWZpbmUgUVNFUkRFU19DT01fQ0xLX0VO
QUJMRTEJCQkweDAwMzgKKyNkZWZpbmUgUVNFUkRFU19DT01fU1lTX0NMS19DVFJMCQkweDAwM0MK
KyNkZWZpbmUgUVNFUkRFU19DT01fU1lTQ0xLX0JVRl9FTkFCTEUJCTB4MDA0MAorI2RlZmluZSBR
U0VSREVTX0NPTV9QTExfRU4JCQkweDAwNDQKKyNkZWZpbmUgUVNFUkRFU19DT01fUExMX0lWQ08J
CQkweDAwNDgKKyNkZWZpbmUgUVNFUkRFU19DT01fQ01OX0lFVFJJTQkJCTB4MDA0QworI2RlZmlu
ZSBRU0VSREVTX0NPTV9DTU5fSVBUUklNCQkJMHgwMDUwCisKKyNkZWZpbmUgUVNFUkRFU19DT01f
Q1BfQ1RSTF9NT0RFMAkJMHgwMDYwCisjZGVmaW5lIFFTRVJERVNfQ09NX0NQX0NUUkxfTU9ERTEJ
CTB4MDA2NAorI2RlZmluZSBRU0VSREVTX0NPTV9QTExfUkNUUkxfTU9ERTAJCTB4MDA2OAorI2Rl
ZmluZSBRU0VSREVTX0NPTV9QTExfUkNUUkxfTU9ERTEJCTB4MDA2QworI2RlZmluZSBRU0VSREVT
X0NPTV9QTExfQ0NUUkxfTU9ERTAJCTB4MDA3MAorI2RlZmluZSBRU0VSREVTX0NPTV9QTExfQ0NU
UkxfTU9ERTEJCTB4MDA3NAorI2RlZmluZSBRU0VSREVTX0NPTV9QTExfQ05UUkwJCQkweDAwNzgK
KyNkZWZpbmUgUVNFUkRFU19DT01fQklBU19FTl9DVFJMX0JZX1BTTQkJMHgwMDdDCisjZGVmaW5l
IFFTRVJERVNfQ09NX1NZU0NMS19FTl9TRUwJCTB4MDA4MAorI2RlZmluZSBRU0VSREVTX0NPTV9D
TUxfU1lTQ0xLX1NFTAkJMHgwMDg0CisjZGVmaW5lIFFTRVJERVNfQ09NX1JFU0VUU01fQ05UUkwJ
CTB4MDA4OAorI2RlZmluZSBRU0VSREVTX0NPTV9SRVNFVFNNX0NOVFJMMgkJMHgwMDhDCisjZGVm
aW5lIFFTRVJERVNfQ09NX0xPQ0tfQ01QX0VOCQkJMHgwMDkwCisjZGVmaW5lIFFTRVJERVNfQ09N
X0xPQ0tfQ01QX0NGRwkJMHgwMDk0CisjZGVmaW5lIFFTRVJERVNfQ09NX0xPQ0tfQ01QMV9NT0RF
MAkJMHgwMDk4CisjZGVmaW5lIFFTRVJERVNfQ09NX0xPQ0tfQ01QMl9NT0RFMAkJMHgwMDlDCisj
ZGVmaW5lIFFTRVJERVNfQ09NX0xPQ0tfQ01QM19NT0RFMAkJMHgwMEEwCisKKyNkZWZpbmUgUVNF
UkRFU19DT01fREVDX1NUQVJUX01PREUwCQkweDAwQjAKKyNkZWZpbmUgUVNFUkRFU19DT01fREVD
X1NUQVJUX01PREUxCQkweDAwQjQKKyNkZWZpbmUgUVNFUkRFU19DT01fRElWX0ZSQUNfU1RBUlQx
X01PREUwCTB4MDBCOAorI2RlZmluZSBRU0VSREVTX0NPTV9ESVZfRlJBQ19TVEFSVDJfTU9ERTAJ
MHgwMEJDCisjZGVmaW5lIFFTRVJERVNfQ09NX0RJVl9GUkFDX1NUQVJUM19NT0RFMAkweDAwQzAK
KyNkZWZpbmUgUVNFUkRFU19DT01fRElWX0ZSQUNfU1RBUlQxX01PREUxCTB4MDBDNAorI2RlZmlu
ZSBRU0VSREVTX0NPTV9ESVZfRlJBQ19TVEFSVDJfTU9ERTEJMHgwMEM4CisjZGVmaW5lIFFTRVJE
RVNfQ09NX0RJVl9GUkFDX1NUQVJUM19NT0RFMQkweDAwQ0MKKyNkZWZpbmUgUVNFUkRFU19DT01f
SU5URUdMT09QX0lOSVRWQUwJCTB4MDBEMAorI2RlZmluZSBRU0VSREVTX0NPTV9JTlRFR0xPT1Bf
RU4JCTB4MDBENAorI2RlZmluZSBRU0VSREVTX0NPTV9JTlRFR0xPT1BfR0FJTjBfTU9ERTAJMHgw
MEQ4CisjZGVmaW5lIFFTRVJERVNfQ09NX0lOVEVHTE9PUF9HQUlOMV9NT0RFMAkweDAwREMKKyNk
ZWZpbmUgUVNFUkRFU19DT01fSU5URUdMT09QX0dBSU4wX01PREUxCTB4MDBFMAorI2RlZmluZSBR
U0VSREVTX0NPTV9JTlRFR0xPT1BfR0FJTjFfTU9ERTEJMHgwMEU0CisjZGVmaW5lIFFTRVJERVNf
Q09NX1ZDT0NBTF9ERUFETUFOX0NUUkwJCTB4MDBFOAorI2RlZmluZSBRU0VSREVTX0NPTV9WQ09f
VFVORV9DVFJMCQkweDAwRUMKKyNkZWZpbmUgUVNFUkRFU19DT01fVkNPX1RVTkVfTUFQCQkweDAw
RjAKKworI2RlZmluZSBRU0VSREVTX0NPTV9DTU5fU1RBVFVTCQkJMHgwMTI0CisjZGVmaW5lIFFT
RVJERVNfQ09NX1JFU0VUX1NNX1NUQVRVUwkJMHgwMTI4CisKKyNkZWZpbmUgUVNFUkRFU19DT01f
Q0xLX1NFTAkJCTB4MDEzOAorI2RlZmluZSBRU0VSREVTX0NPTV9IU0NMS19TRUwJCQkweDAxM0MK
KworI2RlZmluZSBRU0VSREVTX0NPTV9DT1JFQ0xLX0RJVl9NT0RFMAkJMHgwMTQ4CisKKyNkZWZp
bmUgUVNFUkRFU19DT01fU1dfUkVTRVQJCQkweDAxNTAKKyNkZWZpbmUgUVNFUkRFU19DT01fQ09S
RV9DTEtfRU4JCQkweDAxNTQKKyNkZWZpbmUgUVNFUkRFU19DT01fQ19SRUFEWV9TVEFUVVMJCTB4
MDE1OAorI2RlZmluZSBRU0VSREVTX0NPTV9DTU5fQ09ORklHCQkJMHgwMTVDCisKKyNkZWZpbmUg
UVNFUkRFU19DT01fU1ZTX01PREVfQ0xLX1NFTAkJMHgwMTY0CisKKy8qIERQIE1NU1NfQ0MgcmVn
aXN0ZXJzICovCisjZGVmaW5lIE1NU1NfRFBfTElOS19DTURfUkNHUgkJCSgweDAxMzgpCisjZGVm
aW5lIE1NU1NfRFBfTElOS19DRkdfUkNHUgkJCSgweDAxM0MpCisjZGVmaW5lIE1NU1NfRFBfUElY
RUxfTQkJCQkoMHgwMTc0KQorI2RlZmluZSBNTVNTX0RQX1BJWEVMX04JCQkJKDB4MDE3OCkKKwor
LyogRFAgSERDUCAxLjMgcmVnaXN0ZXJzICovCisjZGVmaW5lIERQX0hEQ1BfQ1RSTCAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgKDB4MEEwKQorI2RlZmluZSBEUF9IRENQX1NUQVRV
UyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICgweDBBNCkKKyNkZWZpbmUgRFBfSERD
UF9TV19VUFBFUl9BS1NWICAgICAgICAgICAgICAgICAgICAgICAgICAoMHgwOTgpCisjZGVmaW5l
IERQX0hEQ1BfU1dfTE9XRVJfQUtTViAgICAgICAgICAgICAgICAgICAgICAgICAgKDB4MDlDKQor
I2RlZmluZSBEUF9IRENQX0VOVFJPUFlfQ1RSTDAgICAgICAgICAgICAgICAgICAgICAgICAgICgw
eDM1MCkKKyNkZWZpbmUgRFBfSERDUF9FTlRST1BZX0NUUkwxICAgICAgICAgICAgICAgICAgICAg
ICAgICAoMHgzNUMpCisjZGVmaW5lIERQX0hEQ1BfU0hBX1NUQVRVUyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgKDB4MEM4KQorI2RlZmluZSBEUF9IRENQX1JDVlBPUlRfREFUQTJfMCAgICAg
ICAgICAgICAgICAgICAgICAgICgweDBCMCkKKyNkZWZpbmUgRFBfSERDUF9SQ1ZQT1JUX0RBVEEz
ICAgICAgICAgICAgICAgICAgICAgICAgICAoMHgwQTQpCisjZGVmaW5lIERQX0hEQ1BfUkNWUE9S
VF9EQVRBNCAgICAgICAgICAgICAgICAgICAgICAgICAgKDB4MEE4KQorI2RlZmluZSBEUF9IRENQ
X1JDVlBPUlRfREFUQTUgICAgICAgICAgICAgICAgICAgICAgICAgICgweDBDMCkKKyNkZWZpbmUg
RFBfSERDUF9SQ1ZQT1JUX0RBVEE2ICAgICAgICAgICAgICAgICAgICAgICAgICAoMHgwQzQpCisK
KyNkZWZpbmUgSERDUF9TRUNfRFBfVFpfSFZfSExPU19IRENQX1NIQV9DVFJMICAgICAgICAgICAo
MHgwMjQpCisjZGVmaW5lIEhEQ1BfU0VDX0RQX1RaX0hWX0hMT1NfSERDUF9TSEFfREFUQSAgICAg
ICAgICAgKDB4MDI4KQorI2RlZmluZSBIRENQX1NFQ19EUF9UWl9IVl9ITE9TX0hEQ1BfUkNWUE9S
VF9EQVRBMCAgICAgICgweDAwNCkKKyNkZWZpbmUgSERDUF9TRUNfRFBfVFpfSFZfSExPU19IRENQ
X1JDVlBPUlRfREFUQTEgICAgICAoMHgwMDgpCisjZGVmaW5lIEhEQ1BfU0VDX0RQX1RaX0hWX0hM
T1NfSERDUF9SQ1ZQT1JUX0RBVEE3ICAgICAgKDB4MDBDKQorI2RlZmluZSBIRENQX1NFQ19EUF9U
Wl9IVl9ITE9TX0hEQ1BfUkNWUE9SVF9EQVRBOCAgICAgICgweDAxMCkKKyNkZWZpbmUgSERDUF9T
RUNfRFBfVFpfSFZfSExPU19IRENQX1JDVlBPUlRfREFUQTkgICAgICAoMHgwMTQpCisjZGVmaW5l
IEhEQ1BfU0VDX0RQX1RaX0hWX0hMT1NfSERDUF9SQ1ZQT1JUX0RBVEExMCAgICAgKDB4MDE4KQor
I2RlZmluZSBIRENQX1NFQ19EUF9UWl9IVl9ITE9TX0hEQ1BfUkNWUE9SVF9EQVRBMTEgICAgICgw
eDAxQykKKyNkZWZpbmUgSERDUF9TRUNfRFBfVFpfSFZfSExPU19IRENQX1JDVlBPUlRfREFUQTEy
ICAgICAoMHgwMjApCisKKy8qIFVTQjMgRFAgQ09NIHJlZ2lzdGVycyAqLworI2RlZmluZSBSRUdf
VVNCM19EUF9DT01fUkVTRVRfT1ZSRF9DVFJMCQkJKDB4MUMpCisjZGVmaW5lIFVTQjNfRFBfQ09N
X09WUkRfQ1RSTF9TV19EUFBIWV9SRVNFVAkJKDB4MDEpCisjZGVmaW5lIFVTQjNfRFBfQ09NX09W
UkRfQ1RSTF9TV19EUFBIWV9SRVNFVF9NVVgJKDB4MDIpCisjZGVmaW5lIFVTQjNfRFBfQ09NX09W
UkRfQ1RSTF9TV19VU0IzUEhZX1JFU0VUCQkoMHgwNCkKKyNkZWZpbmUgVVNCM19EUF9DT01fT1ZS
RF9DVFJMX1NXX1VTQjNQSFlfUkVTRVRfTVVYCSgweDA4KQorCisjZGVmaW5lIFJFR19VU0IzX0RQ
X0NPTV9QSFlfTU9ERV9DVFJMCQkJKDB4MDApCisjZGVmaW5lIFVTQjNfRFBfQ09NX1BIWV9NT0RF
X0RQCQkJCSgweDAyKQorCisjZGVmaW5lIFJFR19VU0IzX0RQX0NPTV9TV19SRVNFVAkJCSgweDA0
KQorI2RlZmluZSBVU0IzX0RQX0NPTV9TV19SRVNFVF9TRVQJCQkoMHgwMSkKKworI2RlZmluZSBS
RUdfVVNCM19EUF9DT01fVFlQRUNfQ1RSTAkJCSgweDEwKQorI2RlZmluZSBVU0IzX0RQX0NPTV9U
WVBFQ19DVFJMX1BPUlRTRUwJCQkoMHgwMSkKKyNkZWZpbmUgVVNCM19EUF9DT01fVFlQRUNfQ1RS
TF9QT1JUU0VMX01VWAkJKDB4MDIpCisKKyNkZWZpbmUgUkVHX1VTQjNfRFBfQ09NX1NXSV9DVFJM
CQkJKDB4MGMpCisKKyNkZWZpbmUgUkVHX1VTQjNfRFBfQ09NX1BPV0VSX0RPV05fQ1RSTAkJCSgw
eDA4KQorI2RlZmluZSBVU0IzX0RQX0NPTV9QT1dFUl9ET1dOX0NUUkxfU1dfUFdSRE4JCSgweDAx
KQorCisKKworI2VuZGlmIC8qIF9EUF9SRUdfSF8gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9tc20vbXNtX2Rydi5jIGIvZHJpdmVycy9ncHUvZHJtL21zbS9tc21fZHJ2LmMKaW5kZXgg
Yzg0ZjBhOC4uZTVlOTNlMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL21zbS9tc21fZHJ2
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL21zbS9tc21fZHJ2LmMKQEAgLTEzNDIsNiArMTM0Miw3
IEBAIHN0YXRpYyBpbnQgX19pbml0IG1zbV9kcm1fcmVnaXN0ZXIodm9pZCkKIAltc21fZHNpX3Jl
Z2lzdGVyKCk7CiAJbXNtX2VkcF9yZWdpc3RlcigpOwogCW1zbV9oZG1pX3JlZ2lzdGVyKCk7CisJ
bXNtX2RwX3JlZ2lzdGVyKCk7CiAJYWRyZW5vX3JlZ2lzdGVyKCk7CiAJcmV0dXJuIHBsYXRmb3Jt
X2RyaXZlcl9yZWdpc3RlcigmbXNtX3BsYXRmb3JtX2RyaXZlcik7CiB9CkBAIC0xMzUwLDYgKzEz
NTEsNyBAQCBzdGF0aWMgdm9pZCBfX2V4aXQgbXNtX2RybV91bnJlZ2lzdGVyKHZvaWQpCiB7CiAJ
REJHKCJmaW5pIik7CiAJcGxhdGZvcm1fZHJpdmVyX3VucmVnaXN0ZXIoJm1zbV9wbGF0Zm9ybV9k
cml2ZXIpOworCW1zbV9kcF91bnJlZ2lzdGVyKCk7CiAJbXNtX2hkbWlfdW5yZWdpc3RlcigpOwog
CWFkcmVub191bnJlZ2lzdGVyKCk7CiAJbXNtX2VkcF91bnJlZ2lzdGVyKCk7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vbXNtL21zbV9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9tc20vbXNt
X2Rydi5oCmluZGV4IDcxNTQ3ZTcuLjhiMDY4ZWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9tc20vbXNtX2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vbXNtX2Rydi5oCkBAIC0x
NTksNiArMTU5LDggQEAgc3RydWN0IG1zbV9kcm1fcHJpdmF0ZSB7CiAJLyogRFNJIGlzIHNoYXJl
ZCBieSBtZHA0IGFuZCBtZHA1ICovCiAJc3RydWN0IG1zbV9kc2kgKmRzaVsyXTsKIAorCXN0cnVj
dCBtc21fZHAgKmRwOworCiAJLyogd2hlbiB3ZSBoYXZlIG1vcmUgdGhhbiBvbmUgJ21zbV9ncHUn
IHRoZXNlIG5lZWQgdG8gYmUgYW4gYXJyYXk6ICovCiAJc3RydWN0IG1zbV9ncHUgKmdwdTsKIAlz
dHJ1Y3QgbXNtX2ZpbGVfcHJpdmF0ZSAqbGFzdGN0eDsKQEAgLTM3NSw2ICszNzcsNDYgQEAgc3Rh
dGljIGlubGluZSBpbnQgbXNtX2RzaV9tb2Rlc2V0X2luaXQoc3RydWN0IG1zbV9kc2kgKm1zbV9k
c2ksCiB9CiAjZW5kaWYKIAorI2lmZGVmIENPTkZJR19EUk1fTVNNX0RQCitpbnQgX19pbml0IG1z
bV9kcF9yZWdpc3Rlcih2b2lkKTsKK3ZvaWQgX19leGl0IG1zbV9kcF91bnJlZ2lzdGVyKHZvaWQp
OworaW50IG1zbV9kcF9tb2Rlc2V0X2luaXQoc3RydWN0IG1zbV9kcCAqZHBfZGlzcGxheSwgc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiwKKwkJCSBzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIpOwor
aW50IG1zbV9kcF9kaXNwbGF5X2VuYWJsZShzdHJ1Y3QgbXNtX2RwICpkcCwgc3RydWN0IGRybV9l
bmNvZGVyICplbmNvZGVyKTsKK2ludCBtc21fZHBfZGlzcGxheV9kaXNhYmxlKHN0cnVjdCBtc21f
ZHAgKmRwLCBzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIpOwordm9pZCBtc21fZHBfZGlzcGxh
eV9tb2RlX3NldChzdHJ1Y3QgbXNtX2RwICpkcCwgc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVy
LAorCQkJCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlLAorCQkJCXN0cnVjdCBkcm1fZGlz
cGxheV9tb2RlICphZGp1c3RlZF9tb2RlKTsKKworI2Vsc2UKK3N0YXRpYyBpbmxpbmUgaW50IF9f
aW5pdCBtc21fZHBfcmVnaXN0ZXIodm9pZCkKK3sKKwlyZXR1cm4gLUVJTlZBTDsKK30KK3N0YXRp
YyBpbmxpbmUgdm9pZCBfX2V4aXQgbXNtX2RwX3VucmVnaXN0ZXIodm9pZCkKK3sKK30KK3N0YXRp
YyBpbmxpbmUgaW50IG1zbV9kcF9tb2Rlc2V0X2luaXQoc3RydWN0IG1zbV9kcCAqZHBfZGlzcGxh
eSwKKwkJCQkgICAgICAgc3RydWN0IGRybV9kZXZpY2UgKmRldiwKKwkJCQkgICAgICAgc3RydWN0
IGRybV9lbmNvZGVyICplbmNvZGVyKQoreworCXJldHVybiAtRUlOVkFMOworfQorc3RhdGljIGlu
bGluZSBpbnQgbXNtX2RwX2Rpc3BsYXlfZW5hYmxlKHN0cnVjdCBtc21fZHAgKmRwLCBzdHJ1Y3Qg
ZHJtX2VuY29kZXIgKmVuY29kZXIpCit7CisJcmV0dXJuIC1FSU5WQUw7Cit9CitzdGF0aWMgaW5s
aW5lIGludCBtc21fZHBfZGlzcGxheV9kaXNhYmxlKHN0cnVjdCBtc21fZHAgKmRwLCBzdHJ1Y3Qg
ZHJtX2VuY29kZXIgKmVuY29kZXIpCit7CisJcmV0dXJuIC1FSU5WQUw7Cit9CitzdGF0aWMgaW5s
aW5lIHZvaWQgbXNtX2RwX2Rpc3BsYXlfbW9kZV9zZXQoc3RydWN0IG1zbV9kcCAqZHAsIHN0cnVj
dCBkcm1fZW5jb2RlciAqZW5jb2RlciwKKwkJCQlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9k
ZSwKKwkJCQlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSkKK3sKK30KKyNl
bmRpZgorCiB2b2lkIF9faW5pdCBtc21fbWRwX3JlZ2lzdGVyKHZvaWQpOwogdm9pZCBfX2V4aXQg
bXNtX21kcF91bnJlZ2lzdGVyKHZvaWQpOwogdm9pZCBfX2luaXQgbXNtX2RwdV9yZWdpc3Rlcih2
b2lkKTsKLS0gClRoZSBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRlciwgSW5jLiBpcyBhIG1lbWJl
ciBvZiB0aGUgQ29kZSBBdXJvcmEgRm9ydW0sCmEgTGludXggRm91bmRhdGlvbiBDb2xsYWJvcmF0
aXZlIFByb2plY3QKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9y
ZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZl
bA==
