Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id B635651BAB
	for <lists+dri-devel@lfdr.de>; Mon, 24 Jun 2019 21:49:35 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 03BA589A7A;
	Mon, 24 Jun 2019 19:49:32 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-pg1-x541.google.com (mail-pg1-x541.google.com
 [IPv6:2607:f8b0:4864:20::541])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5949E8984D
 for <dri-devel@lists.freedesktop.org>; Mon, 24 Jun 2019 19:49:21 +0000 (UTC)
Received: by mail-pg1-x541.google.com with SMTP id z75so5059365pgz.5
 for <dri-devel@lists.freedesktop.org>; Mon, 24 Jun 2019 12:49:21 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references;
 bh=oWVUodEWikobPmP2NxI6TMAts5qOQ2aR1KHWV1qmHaY=;
 b=cOyQeSWoW7fxdVfBJhMv2eBPELNoh5NiS75gq9FH6K8ZTVR94xYDPyLEPdHUKR9vDV
 inPJ0T0iRhf+GL4tNHMdDRGWXw2DPpv+9Ts7lZG8aZKHBtxJfBkDBLfzDkL6d9mQAD/8
 bT9Rxbdv5SAgt3m6MIpJ/lyXr3+r56iZ8ZfAOtwfVbOgY9eFxLn161kUfvG33LDP7zFL
 nbZZDRvQzJK9CWnMGT8N1zhbEV8gUxIxcWmis/ufumppYKXxshhEQjAsviCTWaIAccr4
 ePojSqLf/4UcCYWKjpXq+BQBRreMfATWRHZpvLzeYZnhwFTtnWhgmICPSe7RoNoeN9ea
 UK4A==
X-Gm-Message-State: APjAAAUWTSAx61lVqtM10O4a0yZ5oRbqByzigbgvlvLw5LspZ7an3Sv4
 9DEwFpRmWdkiRzAbEBkbdYpZ1Q==
X-Google-Smtp-Source: APXvYqxsUnp1BDfjcABrnn89z0dnV99eBZbZu9ehmgAAHGJhsqkMLcsGy8DN97NIAl5/baVeTn3Rcg==
X-Received: by 2002:a17:90a:3210:: with SMTP id
 k16mr25862830pjb.13.1561405760500; 
 Mon, 24 Jun 2019 12:49:20 -0700 (PDT)
Received: from localhost.localdomain ([2601:1c2:680:1319:692:26ff:feda:3a81])
 by smtp.gmail.com with ESMTPSA id
 v3sm7957031pfm.188.2019.06.24.12.49.18
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Mon, 24 Jun 2019 12:49:19 -0700 (PDT)
From: John Stultz <john.stultz@linaro.org>
To: lkml <linux-kernel@vger.kernel.org>
Subject: [PATCH v6 3/5] dma-buf: heaps: Add system heap to dmabuf heaps
Date: Mon, 24 Jun 2019 19:49:06 +0000
Message-Id: <20190624194908.121273-4-john.stultz@linaro.org>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190624194908.121273-1-john.stultz@linaro.org>
References: <20190624194908.121273-1-john.stultz@linaro.org>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=linaro.org; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references;
 bh=oWVUodEWikobPmP2NxI6TMAts5qOQ2aR1KHWV1qmHaY=;
 b=OMGVGMdG7FI2WEBe6paPJXvzmL9umAeCrvt+690kiATXRKWLJnY0k3dSzGGezlHsaL
 bmlZw4HZwdAw0eQzp+j63SuqCnqzbQW33LtTrRK0CgvIZrzprXcVkL/Gb28w4lvE3wwr
 unVuDRKjhwJ9RjnOyrxE0AAHhwC6uOh/FkA9J9BoroM39Uy4s6JwOZ9HOHX5nnnBjKuF
 iyvP82d1AnDoWWAujZJftmexWhbA9zR+QbgWdTtVy6k4cJa5DUm6TSso60NQcsnf+mDH
 01K/2riu7EZaFbuXbGKZfMaGuUK8UPeAUjO80EonhjSnTeGJ+TAigZTr8J20Giaf5xW7
 5CoQ==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Yudongbin <yudongbin@hisilicon.com>, Sudipto Paul <Sudipto.Paul@arm.com>,
 Xu YiPing <xuyiping@hisilicon.com>,
 Vincent Donnefort <Vincent.Donnefort@arm.com>,
 "Chenfeng \(puck\)" <puck.chen@hisilicon.com>, dri-devel@lists.freedesktop.org,
 Chenbo Feng <fengc@google.com>, Alistair Strachan <astrachan@google.com>,
 Liam Mark <lmark@codeaurora.org>, Christoph Hellwig <hch@infradead.org>,
 "Xiaqing \(A\)" <saberlily.xia@hisilicon.com>, "Andrew F . Davis" <afd@ti.com>,
 Pratik Patel <pratikp@codeaurora.org>, butao <butao@hisilicon.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBwYXRjaCBhZGRzIHN5c3RlbSBoZWFwIHRvIHRoZSBkbWEtYnVmIGhlYXBzIGZyYW1ld29y
ay4KClRoaXMgYWxsb3dzIGFwcGxpY2F0aW9ucyB0byBnZXQgYSBwYWdlLWFsbG9jYXRvciBiYWNr
ZWQgZG1hLWJ1Zgpmb3Igbm9uLWNvbnRpZ3VvdXMgbWVtb3J5LgoKVGhpcyBjb2RlIGlzIGFuIGV2
b2x1dGlvbiBvZiB0aGUgQW5kcm9pZCBJT04gaW1wbGVtZW50YXRpb24sIHNvCnRoYW5rcyB0byBp
dHMgb3JpZ2luYWwgYXV0aG9ycyBhbmQgbWFpbnRhaW50ZXJzOgogIFJlYmVjY2EgU2NodWx0eiBa
YXZpbiwgQ29saW4gQ3Jvc3MsIExhdXJhIEFiYm90dCwgYW5kIG90aGVycyEKCkNjOiBMYXVyYSBB
YmJvdHQgPGxhYmJvdHRAcmVkaGF0LmNvbT4KQ2M6IEJlbmphbWluIEdhaWduYXJkIDxiZW5qYW1p
bi5nYWlnbmFyZEBsaW5hcm8ub3JnPgpDYzogU3VtaXQgU2Vtd2FsIDxzdW1pdC5zZW13YWxAbGlu
YXJvLm9yZz4KQ2M6IExpYW0gTWFyayA8bG1hcmtAY29kZWF1cm9yYS5vcmc+CkNjOiBQcmF0aWsg
UGF0ZWwgPHByYXRpa3BAY29kZWF1cm9yYS5vcmc+CkNjOiBCcmlhbiBTdGFya2V5IDxCcmlhbi5T
dGFya2V5QGFybS5jb20+CkNjOiBWaW5jZW50IERvbm5lZm9ydCA8VmluY2VudC5Eb25uZWZvcnRA
YXJtLmNvbT4KQ2M6IFN1ZGlwdG8gUGF1bCA8U3VkaXB0by5QYXVsQGFybS5jb20+CkNjOiBBbmRy
ZXcgRi4gRGF2aXMgPGFmZEB0aS5jb20+CkNjOiBYdSBZaVBpbmcgPHh1eWlwaW5nQGhpc2lsaWNv
bi5jb20+CkNjOiAiQ2hlbmZlbmcgKHB1Y2spIiA8cHVjay5jaGVuQGhpc2lsaWNvbi5jb20+CkNj
OiBidXRhbyA8YnV0YW9AaGlzaWxpY29uLmNvbT4KQ2M6ICJYaWFxaW5nIChBKSIgPHNhYmVybGls
eS54aWFAaGlzaWxpY29uLmNvbT4KQ2M6IFl1ZG9uZ2JpbiA8eXVkb25nYmluQGhpc2lsaWNvbi5j
b20+CkNjOiBDaHJpc3RvcGggSGVsbHdpZyA8aGNoQGluZnJhZGVhZC5vcmc+CkNjOiBDaGVuYm8g
RmVuZyA8ZmVuZ2NAZ29vZ2xlLmNvbT4KQ2M6IEFsaXN0YWlyIFN0cmFjaGFuIDxhc3RyYWNoYW5A
Z29vZ2xlLmNvbT4KQ2M6IGRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKUmV2aWV3ZWQt
Ynk6IEJlbmphbWluIEdhaWduYXJkIDxiZW5qYW1pbi5nYWlnbmFyZEBsaW5hcm8ub3JnPgpTaWdu
ZWQtb2ZmLWJ5OiBKb2huIFN0dWx0eiA8am9obi5zdHVsdHpAbGluYXJvLm9yZz4KQ2hhbmdlLUlk
OiBJNGRjNWZmNTRjY2IxZjdjYTNhYzg2NzU2NjExMTRjYTMzODEzNjU0YgotLS0KdjI6CiogU3dp
dGNoIGFsbG9jYXRlIHRvIHJldHVybiBkbWFidWYgZmQKKiBTaW1wbGlmeSBpbml0IGNvZGUKKiBD
aGVja3BhdGNoIGZpeHVwcwoqIERyb3BlZCBkZWFkIHN5c3RlbS1jb250aWcgY29kZQp2MzoKKiBX
aGl0ZXNwYWNlIGZpeHVwcyBmcm9tIEJlbmphbWluCiogTWFrZSBzdXJlIHdlJ3JlIHplcm9pbmcg
dGhlIGFsbG9jYXRlZCBwYWdlcyAoZnJvbSBMaWFtKQoqIFVzZSBQQUdFX0FMSUdOKCkgY29uc2lz
dGVudGx5IChzdWdnZXN0ZWQgYnkgQnJpYW4pCiogRm9sZCBpbiBuZXcgcmVnaXN0cmF0aW9uIHN0
eWxlIGZyb20gQW5kcmV3CiogQXZvaWQgbmVlZGxlc3MgZHluYW1pYyBhbGxvY2F0aW9uIG9mIHN5
c19oZWFwIChzdWdnZXN0ZWQgYnkKICBDaHJpc3RvcGgpCiogTWlub3IgY2xlYW51cHMKKiBGb2xk
ZWQgaW4gY2hhbmdlcyBmcm9tIEFuZHJldyB0byB1c2Ugc2ltcGxpZmllZCBwYWdlIGxpc3QKICBm
cm9tIHRoZSBoZWFwIGhlbHBlcnMKdjQ6CiogT3B0aW1pemF0aW9uIHRvIGFsbG9jYXRlIHBhZ2Vz
IGluIGNodW5rcywgc2ltaWxhciB0byBvbGQKICBwYWdlcG9vbCBjb2RlCiogVXNlIGZkX2ZsYWdz
IHdoZW4gY3JlYXRpbmcgZG1hYnVmIGZkIChTdWdnZXN0ZWQgYnkgQmVuamFtaW4pCnY1OgoqIEJh
Y2sgb3V0IGxhcmdlIG9yZGVyIHBhZ2UgYWxsb2NhdGlvbnMgKHdhcyBsZWFraW5nIG1lbW9yeSwK
ICBhcyB0aGUgcGFnZSBhcnJheSBkaWRuJ3QgcHJvcGVybHkgdHJhY2sgb3JkZXIgc2l6ZSkKdjY6
CiogTWlub3Igd2hpdGVzcGFjZSBjaGFuZ2Ugc3VnZ2VzdGVkIGJ5IEJyaWFuCiogUmVtb3ZlIHVu
dXNlZCB2YXJpYWJsZQotLS0KIGRyaXZlcnMvZG1hLWJ1Zi9LY29uZmlnICAgICAgICAgICAgIHwg
ICAyICsKIGRyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9LY29uZmlnICAgICAgIHwgICA2ICsrCiBkcml2
ZXJzL2RtYS1idWYvaGVhcHMvTWFrZWZpbGUgICAgICB8ICAgMSArCiBkcml2ZXJzL2RtYS1idWYv
aGVhcHMvc3lzdGVtX2hlYXAuYyB8IDEyMSArKysrKysrKysrKysrKysrKysrKysrKysrKysrCiA0
IGZpbGVzIGNoYW5nZWQsIDEzMCBpbnNlcnRpb25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJp
dmVycy9kbWEtYnVmL2hlYXBzL0tjb25maWcKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2Rt
YS1idWYvaGVhcHMvc3lzdGVtX2hlYXAuYwoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZG1hLWJ1Zi9L
Y29uZmlnIGIvZHJpdmVycy9kbWEtYnVmL0tjb25maWcKaW5kZXggOWI5M2Y4NmY1OTdjLi40MzRj
ZmU2NDZkYWQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9LY29uZmlnCisrKyBiL2RyaXZl
cnMvZG1hLWJ1Zi9LY29uZmlnCkBAIC00Nyw0ICs0Nyw2IEBAIG1lbnVjb25maWcgRE1BQlVGX0hF
QVBTCiAJICB0aGlzIGFsbG93cyB1c2Vyc3BhY2UgdG8gYWxsb2NhdGUgZG1hLWJ1ZnMgdGhhdCBj
YW4gYmUgc2hhcmVkIGJldHdlZW4KIAkgIGRyaXZlcnMuCiAKK3NvdXJjZSAiZHJpdmVycy9kbWEt
YnVmL2hlYXBzL0tjb25maWciCisKIGVuZG1lbnUKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZG1hLWJ1
Zi9oZWFwcy9LY29uZmlnIGIvZHJpdmVycy9kbWEtYnVmL2hlYXBzL0tjb25maWcKbmV3IGZpbGUg
bW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4yMDUwNTI3NDQxNjkKLS0tIC9kZXYvbnVs
bAorKysgYi9kcml2ZXJzL2RtYS1idWYvaGVhcHMvS2NvbmZpZwpAQCAtMCwwICsxLDYgQEAKK2Nv
bmZpZyBETUFCVUZfSEVBUFNfU1lTVEVNCisJYm9vbCAiRE1BLUJVRiBTeXN0ZW0gSGVhcCIKKwlk
ZXBlbmRzIG9uIERNQUJVRl9IRUFQUworCWhlbHAKKwkgIENob29zZSB0aGlzIG9wdGlvbiB0byBl
bmFibGUgdGhlIHN5c3RlbSBkbWFidWYgaGVhcC4gVGhlIHN5c3RlbSBoZWFwCisJICBpcyBiYWNr
ZWQgYnkgcGFnZXMgZnJvbSB0aGUgYnVkZHkgYWxsb2NhdG9yLiBJZiBpbiBkb3VidCwgc2F5IFku
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2RtYS1idWYvaGVhcHMvTWFrZWZpbGUgYi9kcml2ZXJzL2Rt
YS1idWYvaGVhcHMvTWFrZWZpbGUKaW5kZXggZGU0OTg5ODExMmRiLi5kMTgwOGVjYTI1ODEgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2Rt
YS1idWYvaGVhcHMvTWFrZWZpbGUKQEAgLTEsMiArMSwzIEBACiAjIFNQRFgtTGljZW5zZS1JZGVu
dGlmaWVyOiBHUEwtMi4wCiBvYmoteQkJCQkJKz0gaGVhcC1oZWxwZXJzLm8KK29iai0kKENPTkZJ
R19ETUFCVUZfSEVBUFNfU1lTVEVNKQkrPSBzeXN0ZW1faGVhcC5vCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2RtYS1idWYvaGVhcHMvc3lzdGVtX2hlYXAuYyBiL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9z
eXN0ZW1faGVhcC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uNmEx
NjgwNjE4MWMyCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9kbWEtYnVmL2hlYXBzL3N5c3Rl
bV9oZWFwLmMKQEAgLTAsMCArMSwxMjEgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBH
UEwtMi4wCisvKgorICogRE1BQlVGIFN5c3RlbSBoZWFwIGV4cG9ydGVyCisgKgorICogQ29weXJp
Z2h0IChDKSAyMDExIEdvb2dsZSwgSW5jLgorICogQ29weXJpZ2h0IChDKSAyMDE5IExpbmFybyBM
dGQuCisgKi8KKworI2luY2x1ZGUgPGFzbS9wYWdlLmg+CisjaW5jbHVkZSA8bGludXgvZG1hLWJ1
Zi5oPgorI2luY2x1ZGUgPGxpbnV4L2RtYS1tYXBwaW5nLmg+CisjaW5jbHVkZSA8bGludXgvZG1h
LWhlYXAuaD4KKyNpbmNsdWRlIDxsaW51eC9lcnIuaD4KKyNpbmNsdWRlIDxsaW51eC9oaWdobWVt
Lmg+CisjaW5jbHVkZSA8bGludXgvbW0uaD4KKyNpbmNsdWRlIDxsaW51eC9zY2F0dGVybGlzdC5o
PgorI2luY2x1ZGUgPGxpbnV4L3NsYWIuaD4KKworI2luY2x1ZGUgImhlYXAtaGVscGVycy5oIgor
CitzdHJ1Y3Qgc3lzdGVtX2hlYXAgeworCXN0cnVjdCBkbWFfaGVhcCAqaGVhcDsKK30gc3lzX2hl
YXA7CisKK3N0YXRpYyB2b2lkIHN5c3RlbV9oZWFwX2ZyZWUoc3RydWN0IGhlYXBfaGVscGVyX2J1
ZmZlciAqYnVmZmVyKQoreworCXBnb2ZmX3QgcGc7CisKKwlmb3IgKHBnID0gMDsgcGcgPCBidWZm
ZXItPnBhZ2Vjb3VudDsgcGcrKykKKwkJX19mcmVlX3BhZ2UoYnVmZmVyLT5wYWdlc1twZ10pOwor
CWtmcmVlKGJ1ZmZlci0+cGFnZXMpOworCWtmcmVlKGJ1ZmZlcik7Cit9CisKK3N0YXRpYyBpbnQg
c3lzdGVtX2hlYXBfYWxsb2NhdGUoc3RydWN0IGRtYV9oZWFwICpoZWFwLAorCQkJCXVuc2lnbmVk
IGxvbmcgbGVuLAorCQkJCXVuc2lnbmVkIGxvbmcgZmRfZmxhZ3MsCisJCQkJdW5zaWduZWQgbG9u
ZyBoZWFwX2ZsYWdzKQoreworCXN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKmhlbHBlcl9idWZm
ZXI7CisJREVGSU5FX0RNQV9CVUZfRVhQT1JUX0lORk8oZXhwX2luZm8pOworCXN0cnVjdCBkbWFf
YnVmICpkbWFidWY7CisJaW50IHJldCA9IC1FTk9NRU07CisJcGdvZmZfdCBwZzsKKworCWhlbHBl
cl9idWZmZXIgPSBremFsbG9jKHNpemVvZigqaGVscGVyX2J1ZmZlciksIEdGUF9LRVJORUwpOwor
CWlmICghaGVscGVyX2J1ZmZlcikKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlJTklUX0hFQVBfSEVM
UEVSX0JVRkZFUihoZWxwZXJfYnVmZmVyLCBzeXN0ZW1faGVhcF9mcmVlKTsKKwloZWxwZXJfYnVm
ZmVyLT5oZWFwX2J1ZmZlci5mbGFncyA9IGhlYXBfZmxhZ3M7CisJaGVscGVyX2J1ZmZlci0+aGVh
cF9idWZmZXIuaGVhcCA9IGhlYXA7CisJaGVscGVyX2J1ZmZlci0+aGVhcF9idWZmZXIuc2l6ZSA9
IGxlbjsKKworCWhlbHBlcl9idWZmZXItPnBhZ2Vjb3VudCA9IGxlbiAvIFBBR0VfU0laRTsKKwlo
ZWxwZXJfYnVmZmVyLT5wYWdlcyA9IGttYWxsb2NfYXJyYXkoaGVscGVyX2J1ZmZlci0+cGFnZWNv
dW50LAorCQkJCQkgICAgIHNpemVvZigqaGVscGVyX2J1ZmZlci0+cGFnZXMpLAorCQkJCQkgICAg
IEdGUF9LRVJORUwpOworCWlmICghaGVscGVyX2J1ZmZlci0+cGFnZXMpIHsKKwkJcmV0ID0gLUVO
T01FTTsKKwkJZ290byBlcnIwOworCX0KKworCWZvciAocGcgPSAwOyBwZyA8IGhlbHBlcl9idWZm
ZXItPnBhZ2Vjb3VudDsgcGcrKykgeworCQloZWxwZXJfYnVmZmVyLT5wYWdlc1twZ10gPSBhbGxv
Y19wYWdlKEdGUF9LRVJORUwgfCBfX0dGUF9aRVJPKTsKKwkJaWYgKCFoZWxwZXJfYnVmZmVyLT5w
YWdlc1twZ10pCisJCQlnb3RvIGVycjE7CisJfQorCisJLyogY3JlYXRlIHRoZSBkbWFidWYgKi8K
KwlleHBfaW5mby5vcHMgPSAmaGVhcF9oZWxwZXJfb3BzOworCWV4cF9pbmZvLnNpemUgPSBsZW47
CisJZXhwX2luZm8uZmxhZ3MgPSBmZF9mbGFnczsKKwlleHBfaW5mby5wcml2ID0gJmhlbHBlcl9i
dWZmZXItPmhlYXBfYnVmZmVyOworCWRtYWJ1ZiA9IGRtYV9idWZfZXhwb3J0KCZleHBfaW5mbyk7
CisJaWYgKElTX0VSUihkbWFidWYpKSB7CisJCXJldCA9IFBUUl9FUlIoZG1hYnVmKTsKKwkJZ290
byBlcnIxOworCX0KKworCWhlbHBlcl9idWZmZXItPmhlYXBfYnVmZmVyLmRtYWJ1ZiA9IGRtYWJ1
ZjsKKworCXJldCA9IGRtYV9idWZfZmQoZG1hYnVmLCBmZF9mbGFncyk7CisJaWYgKHJldCA8IDAp
IHsKKwkJZG1hX2J1Zl9wdXQoZG1hYnVmKTsKKwkJLyoganVzdCByZXR1cm4sIGFzIHB1dCB3aWxs
IGNhbGwgcmVsZWFzZSBhbmQgdGhhdCB3aWxsIGZyZWUgKi8KKwkJcmV0dXJuIHJldDsKKwl9CisK
KwlyZXR1cm4gcmV0OworCitlcnIxOgorCXdoaWxlIChwZyA+IDApCisJCV9fZnJlZV9wYWdlKGhl
bHBlcl9idWZmZXItPnBhZ2VzWy0tcGddKTsKKwlrZnJlZShoZWxwZXJfYnVmZmVyLT5wYWdlcyk7
CitlcnIwOgorCWtmcmVlKGhlbHBlcl9idWZmZXIpOworCisJcmV0dXJuIC1FTk9NRU07Cit9CisK
K3N0YXRpYyBzdHJ1Y3QgZG1hX2hlYXBfb3BzIHN5c3RlbV9oZWFwX29wcyA9IHsKKwkuYWxsb2Nh
dGUgPSBzeXN0ZW1faGVhcF9hbGxvY2F0ZSwKK307CisKK3N0YXRpYyBpbnQgc3lzdGVtX2hlYXBf
Y3JlYXRlKHZvaWQpCit7CisJc3RydWN0IGRtYV9oZWFwX2V4cG9ydF9pbmZvIGV4cF9pbmZvOwor
CWludCByZXQgPSAwOworCisJZXhwX2luZm8ubmFtZSA9ICJzeXN0ZW1faGVhcCI7CisJZXhwX2lu
Zm8ub3BzID0gJnN5c3RlbV9oZWFwX29wczsKKwlleHBfaW5mby5wcml2ID0gJnN5c19oZWFwOwor
CisJc3lzX2hlYXAuaGVhcCA9IGRtYV9oZWFwX2FkZCgmZXhwX2luZm8pOworCWlmIChJU19FUlIo
c3lzX2hlYXAuaGVhcCkpCisJCXJldCA9IFBUUl9FUlIoc3lzX2hlYXAuaGVhcCk7CisKKwlyZXR1
cm4gcmV0OworfQorZGV2aWNlX2luaXRjYWxsKHN5c3RlbV9oZWFwX2NyZWF0ZSk7Ci0tIAoyLjE3
LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1k
ZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczov
L2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
