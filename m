Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 6991192114
	for <lists+dri-devel@lfdr.de>; Mon, 19 Aug 2019 12:15:18 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E4723899D6;
	Mon, 19 Aug 2019 10:14:50 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from NAM03-CO1-obe.outbound.protection.outlook.com
 (mail-eopbgr790091.outbound.protection.outlook.com [40.107.79.91])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BD1236E04A
 for <dri-devel@lists.freedesktop.org>; Sun, 18 Aug 2019 22:41:15 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=SFtzanRSoILM+jcYWaI4Z98Kz0xc3acHIgMevFpTaaw2ziWEiZAqvJ9xOc/4zwebCJrmHte+Swrx1XMzYbkA1LMaposJJQpLnOeBhH2HYQ4TcFn31Uuu/Yer14pNr5fCC1PQFzlQv7qWZ2DuHQKSbax3zE4AO4g1jbsyMtSw/A3mtX8uS636UwkrvYdvoDmHegP6sJ0iV+gi9xM3g8Az48G/NTR9HgpW9FwFnsN3QKT21nJNE18IBedfzkpPc0OttPOBw3Eh3Hkw3YZgVNRKZljeQxc8hfIdcTruShNDauRz36CFhynTPeOhpVZNH4PX01Q7OUMs7w7i4aPX1NopvA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=AsJq5xbgoT8uxXmenQxkLM8x80sy+eJUDGFaKsdH00I=;
 b=lvzB5/eBxD8HebSi2rPbsbtjHY0YEHgK8GfZ5FW7j8DFG8ogTI4EprtKhyTWgQCAQIW65Nb3UTItkj0TPAH+6s7POTISZ8Y9+pBee8ZzH9mwpb0egWPuj2EewRZb+9awJ4nfW/KvfuldHhdkY5Tcrh4RF0iGqs7uui30gQR58aAgmyQ+sjYoN4Ii+qX3B+eTzPK3lFBA6IWrMhiSvux+HxUHqaISg2I4ZD7gAmqJeQbpWHXg5wjTfb6w0stypKaa+x4S9awRhYJtEagsjQWc+I3fjCs9S93VLrIwz/te/3PqcR9ORft5Pkbm9f6HGZdmGVjf6NOfaoD35CXK8f2IEQ==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=microsoft.com; dmarc=pass action=none
 header.from=microsoft.com; dkim=pass header.d=microsoft.com; arc=none
Received: from DM5PR21MB0137.namprd21.prod.outlook.com (10.173.173.12) by
 DM5PR21MB0172.namprd21.prod.outlook.com (10.173.173.135) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2220.0; Sun, 18 Aug 2019 22:41:13 +0000
Received: from DM5PR21MB0137.namprd21.prod.outlook.com
 ([fe80::8985:a319:f21:530e]) by DM5PR21MB0137.namprd21.prod.outlook.com
 ([fe80::c437:6219:efcc:fb8a%8]) with mapi id 15.20.2220.000; Sun, 18 Aug 2019
 22:41:13 +0000
From: Michael Kelley <mikelley@microsoft.com>
To: Wei Hu <weh@microsoft.com>, "rdunlap@infradead.org"
 <rdunlap@infradead.org>, "shc_work@mail.ru" <shc_work@mail.ru>,
 "gregkh@linuxfoundation.org" <gregkh@linuxfoundation.org>,
 "lee.jones@linaro.org" <lee.jones@linaro.org>,
 "alexandre.belloni@bootlin.com" <alexandre.belloni@bootlin.com>,
 "baijiaju1990@gmail.com" <baijiaju1990@gmail.com>,
 "fthain@telegraphics.com.au" <fthain@telegraphics.com.au>, "info@metux.net"
 <info@metux.net>, "linux-hyperv@vger.kernel.org"
 <linux-hyperv@vger.kernel.org>, "dri-devel@lists.freedesktop.org"
 <dri-devel@lists.freedesktop.org>, "linux-fbdev@vger.kernel.org"
 <linux-fbdev@vger.kernel.org>, "linux-kernel@vger.kernel.org"
 <linux-kernel@vger.kernel.org>, "sashal@kernel.org" <sashal@kernel.org>,
 Stephen Hemminger <sthemmin@microsoft.com>, Haiyang Zhang
 <haiyangz@microsoft.com>, KY Srinivasan <kys@microsoft.com>, Dexuan Cui
 <decui@microsoft.com>, Iouri Tarassov <iourit@microsoft.com>
Subject: RE: [PATCH] video: hyperv: hyperv_fb: Support deferred IO for Hyper-V
 frame buffer driver
Thread-Topic: [PATCH] video: hyperv: hyperv_fb: Support deferred IO for
 Hyper-V frame buffer driver
Thread-Index: AQHVUcL5xwYcgiTbLE2rph4+nLCFt6cBbYBA
Date: Sun, 18 Aug 2019 22:41:13 +0000
Message-ID: <DM5PR21MB0137E0BB19D8A0E6385BB316D7A90@DM5PR21MB0137.namprd21.prod.outlook.com>
References: <20190813103548.2008-1-weh@microsoft.com>
In-Reply-To: <20190813103548.2008-1-weh@microsoft.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
msip_labels: MSIP_Label_f42aa342-8706-4288-bd11-ebb85995028c_Enabled=True;
 MSIP_Label_f42aa342-8706-4288-bd11-ebb85995028c_SiteId=72f988bf-86f1-41af-91ab-2d7cd011db47;
 MSIP_Label_f42aa342-8706-4288-bd11-ebb85995028c_Owner=mikelley@ntdev.microsoft.com;
 MSIP_Label_f42aa342-8706-4288-bd11-ebb85995028c_SetDate=2019-08-18T22:41:11.4651147Z;
 MSIP_Label_f42aa342-8706-4288-bd11-ebb85995028c_Name=General;
 MSIP_Label_f42aa342-8706-4288-bd11-ebb85995028c_Application=Microsoft Azure
 Information Protection;
 MSIP_Label_f42aa342-8706-4288-bd11-ebb85995028c_ActionId=ccd13015-0c82-412f-bb9a-41c31ca9a93d;
 MSIP_Label_f42aa342-8706-4288-bd11-ebb85995028c_Extended_MSFT_Method=Automatic
x-originating-ip: [24.22.167.197]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 51b8772e-56ff-4c8e-3457-08d7242d2ca4
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600158)(711020)(4605104)(1401327)(4618075)(2017052603328)(7193020);
 SRVR:DM5PR21MB0172; 
x-ms-traffictypediagnostic: DM5PR21MB0172:|DM5PR21MB0172:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <DM5PR21MB017270C6619E7E72FEFF9778D7A90@DM5PR21MB0172.namprd21.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:773;
x-forefront-prvs: 01334458E5
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10019020)(4636009)(39860400002)(376002)(346002)(136003)(396003)(366004)(189003)(199004)(30864003)(486006)(446003)(25786009)(52536014)(7736002)(1511001)(2906002)(8936002)(3846002)(476003)(229853002)(6246003)(8676002)(1250700005)(53946003)(6116002)(305945005)(5660300002)(81156014)(6436002)(81166006)(76116006)(2501003)(74316002)(11346002)(33656002)(6636002)(8990500004)(10290500003)(22452003)(316002)(7416002)(110136005)(76176011)(7696005)(66066001)(186003)(99286004)(14444005)(86362001)(256004)(478600001)(66446008)(14454004)(26005)(64756008)(9686003)(71200400001)(71190400001)(66556008)(66476007)(55016002)(53936002)(66946007)(6506007)(2201001)(10090500001)(102836004)(921003)(1121003);
 DIR:OUT; SFP:1102; SCL:1; SRVR:DM5PR21MB0172;
 H:DM5PR21MB0137.namprd21.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; MX:1; A:1; 
received-spf: None (protection.outlook.com: microsoft.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: 1qFOZYtl/r6lJSjyXtT84HZDLLuZxXG8vVpTCW32BkLlSvBUoVYzl3fV3Cb0l73mP+JhJU+FhxwxtrREzJsCjFzn326ImwuHPIudIJdi4qOJbjXozGmUcxLQInCunrXBJWeF5CmbFPv2REmK+P35gdU8y0WMEYwnFunvlAv3idacWtb2IJQ9VoPM+N4C+Ys2K6G3cC/WgLQ/JwDi/iVZQPixT94nWxnAXS2B+qbQZsFrsgp+/Bmc8SXMaHRWgff5lM3yEh686QeuZ8rzzMK1jXi4QtSsLbV6gUTLklWX0iM2lXAh17IPDOuqMnirzaIFSDGdqfEpiVg7nWPVer+cBe8T5L4tFR9/5/dsPbXOICpJM2waxw5rhWKMwVqStSHlFKfFgJsuIaq8xYdFl0lElDLeC4PaarN6TujAyLy5HDU=
MIME-Version: 1.0
X-OriginatorOrg: microsoft.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 51b8772e-56ff-4c8e-3457-08d7242d2ca4
X-MS-Exchange-CrossTenant-originalarrivaltime: 18 Aug 2019 22:41:13.5182 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 72f988bf-86f1-41af-91ab-2d7cd011db47
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: iUiet0Lb/XIPFVLnBBggGKsdtnXQRZ2oiV2eqqKdVM8oESv//QlR9Pijcn77dMNevdftzR5KcIV6D63AbznifluNqkKiKPFl/OXnyID6BCQ=
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM5PR21MB0172
X-Mailman-Approved-At: Mon, 19 Aug 2019 10:14:48 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=microsoft.com; s=selector1;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=AsJq5xbgoT8uxXmenQxkLM8x80sy+eJUDGFaKsdH00I=;
 b=A5eRq1r50ZmaLTiNbaR+h5/rY7vfKcvP/1jMwf4sSOSodutZBAjmv1vJWyO+W/zlTMSZsUl78KHDCcyhd6WKJWveH7EuQCRUf4h9mDKQbpW1xHOYXoWuRlXUGFuPvvGksU0rq3T4lWL143yOWOkcq9Denwqk44mYjWEseRjnMro=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=mikelley@microsoft.com; 
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogV2VpIEh1IDx3ZWhAbWljcm9zb2Z0LmNvbT4gU2VudDogVHVlc2RheSwgQXVndXN0IDEz
LCAyMDE5IDM6MzcgQU0KPiAKPiBXaXRob3V0IGRlZmVycmVkIElPIHN1cHBvcnQsIGh5cGVydl9m
YiBkcml2ZXIgaW5mb3JtcyB0aGUgaG9zdCB0byByZWZyZXNoCj4gdGhlIGVudGlyZSBndWVzdCBm
cmFtZSBidWZmZXIgYXQgZml4ZWQgcmF0ZSwgZS5nLiBhdCAyMEh6LCBubyBtYXR0ZXIgdGhlcmUK
PiBpcyBzY3JlZW4gdXBkYXRlIG9yIG5vdC4gVGhpcyBwYXRjaCBzdXBwb3J0cyBkZWZlcmVkIElP
IGZvciBzY3JlZW5zIGluCgpzL2RlZmVyZWQvZGVmZXJyZWQvCgo+IGdyYXBoaWMgbW9kZSBhbmQg
YWxzbyBlbmFibGVzIHRoZSBmcmFtbWUgYnVmZmVyIG9uLWRlbWFuZCByZWZyZXNoLiBUaGUKCnMv
Z3JhcGhpYy9ncmFwaGljcy8Kcy9mcmFtbWUvZnJhbWUvCgo+IGhpZ2hlc3QgcmVmcmVzaCByYXRl
IGlzIHN0aWxsIHNldCBhdCAyMEh6Lgo+IAo+IER1ZSB0byBsaW1pdGF0aW9uIG9uIEh5cGVyLVYg
aG9zdCwgd2Uga2VlcCBhIHNoYWRvdyBjb3B5IG9mIGZyYW1lIGJ1ZmZlcgoKSSB0aGluayBpdCBt
aWdodCBiZSB3b3J0aHdoaWxlIHRvIGV4cGxhaW4gZXhhY3RseSB3aGF0IHRoZSBpc3N1ZSBpcyBz
byB0aGF0CnRoZXJlJ3MgYSByZWNvcmQga2VwdC4KCj4gaW4gdGhlIGd1ZXN0LiBUaGlzIG1lYW5z
IG9uZSBtb3JlIGNvcHkgb2YgdGhlIGRpcnR5IHJlY3RhbmdsZSBpbnNpZGUKPiBndWVzdCB3aGVu
IGRvaW5nIHRoZSBvbi1kZW1hbmQgcmVmcmVzaC4gVGhpcyBjYW4gYmUgb3B0aW1pemVkIGluIHRo
ZQo+IGZ1dHVyZSB3aXRoIGhlbHAgZnJvbSBob3N0LiBGb3Igbm93IHRoZSBob3N0IHBlcmZvcm1h
bmNlIGdhaW4gZnJvbSBkZWZlcnJlZAo+IElPIG91dHdlaWdocyB0aGUgc2hhZG93IGNvcHkgaW1w
YWN0IGluIHRoZSBndWVzdC4KPiAKPiBTaWduZWQtb2ZmLWJ5OiBXZWkgSHUgPHdlaEBtaWNyb3Nv
ZnQuY29tPgo+IC0tLQo+ICBkcml2ZXJzL3ZpZGVvL2ZiZGV2L0tjb25maWcgICAgIHwgICAxICsK
PiAgZHJpdmVycy92aWRlby9mYmRldi9oeXBlcnZfZmIuYyB8IDIxNyArKysrKysrKysrKysrKysr
KysrKysrKysrKysrKy0tLQo+ICAyIGZpbGVzIGNoYW5nZWQsIDE5OCBpbnNlcnRpb25zKCspLCAy
MCBkZWxldGlvbnMoLSkKPiAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy92aWRlby9mYmRldi9LY29u
ZmlnIGIvZHJpdmVycy92aWRlby9mYmRldi9LY29uZmlnCj4gaW5kZXggMWIyZjVmMzFmYjZmLi5l
NzgxZjg5YTE4MjQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy92aWRlby9mYmRldi9LY29uZmlnCj4g
KysrIGIvZHJpdmVycy92aWRlby9mYmRldi9LY29uZmlnCj4gQEAgLTIyNDEsNiArMjI0MSw3IEBA
IGNvbmZpZyBGQl9IWVBFUlYKPiAgCXNlbGVjdCBGQl9DRkJfRklMTFJFQ1QKPiAgCXNlbGVjdCBG
Ql9DRkJfQ09QWUFSRUEKPiAgCXNlbGVjdCBGQl9DRkJfSU1BR0VCTElUCj4gKwlzZWxlY3QgRkJf
REVGRVJSRURfSU8KPiAgCWhlbHAKPiAgCSAgVGhpcyBmcmFtZWJ1ZmZlciBkcml2ZXIgc3VwcG9y
dHMgTWljcm9zb2Z0IEh5cGVyLVYgU3ludGhldGljIFZpZGVvLgo+IAo+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL3ZpZGVvL2ZiZGV2L2h5cGVydl9mYi5jIGIvZHJpdmVycy92aWRlby9mYmRldi9oeXBl
cnZfZmIuYwo+IGluZGV4IDEwNDJmMzMxMWZhMi4uODUxOThhNmVhOGU3IDEwMDY0NAo+IC0tLSBh
L2RyaXZlcnMvdmlkZW8vZmJkZXYvaHlwZXJ2X2ZiLmMKPiArKysgYi9kcml2ZXJzL3ZpZGVvL2Zi
ZGV2L2h5cGVydl9mYi5jCj4gQEAgLTIzMyw2ICsyMzMsNyBAQCBzdHJ1Y3Qgc3ludGh2aWRfbXNn
IHsKPiAgI2RlZmluZSBSSU5HX0JVRlNJWkUgKDI1NiAqIDEwMjQpCj4gICNkZWZpbmUgVlNQX1RJ
TUVPVVQgKDEwICogSFopCj4gICNkZWZpbmUgSFZGQl9VUERBVEVfREVMQVkgKEhaIC8gMjApCj4g
KyNkZWZpbmUgSFZGQl9PTkRFTUFORF9USFJPVFRMRSAoSFogLyAyMCkKPiAKPiAgc3RydWN0IGh2
ZmJfcGFyIHsKPiAgCXN0cnVjdCBmYl9pbmZvICppbmZvOwo+IEBAIC0yNTIsNiArMjUzLDE3IEBA
IHN0cnVjdCBodmZiX3BhciB7Cj4gIAlib29sIHN5bmNocm9ub3VzX2ZiOwo+IAo+ICAJc3RydWN0
IG5vdGlmaWVyX2Jsb2NrIGh2ZmJfcGFuaWNfbmI7Cj4gKwo+ICsJLyogTWVtb3J5IGZvciBkZWZl
cnJlZCBJTyBhbmQgZnJhbWUgYnVmZmVyIGl0c2VsZiAqLwo+ICsJdW5zaWduZWQgY2hhciAqZGlv
X3ZwOwo+ICsJdW5zaWduZWQgY2hhciAqbW1pb192cDsKPiArCXVuc2lnbmVkIGxvbmcgbW1pb19w
cDsKPiArCXNwaW5sb2NrX3QgZG9jb3B5X2xvY2s7IC8qIExvY2sgdG8gcHJvdGVjdCBtZW1vcnkg
Y29weSAqLwo+ICsKPiArCS8qIERpcnR5IHJlY3RhbmdsZSwgcHJvdGVjdGVkIGJ5IGRlbGF5ZWRf
cmVmcmVzaF9sb2NrICovCj4gKwlpbnQgeDEsIHkxLCB4MiwgeTI7Cj4gKwlib29sIGRlbGF5ZWRf
cmVmcmVzaDsKPiArCXNwaW5sb2NrX3QgZGVsYXllZF9yZWZyZXNoX2xvY2s7Cj4gIH07Cj4gCj4g
IHN0YXRpYyB1aW50IHNjcmVlbl93aWR0aCA9IEhWRkJfV0lEVEg7Cj4gQEAgLTI2MCw2ICsyNzIs
NyBAQCBzdGF0aWMgdWludCBzY3JlZW5fd2lkdGhfbWF4ID0gSFZGQl9XSURUSDsKPiAgc3RhdGlj
IHVpbnQgc2NyZWVuX2hlaWdodF9tYXggPSBIVkZCX0hFSUdIVDsKPiAgc3RhdGljIHVpbnQgc2Ny
ZWVuX2RlcHRoOwo+ICBzdGF0aWMgdWludCBzY3JlZW5fZmJfc2l6ZTsKPiArc3RhdGljIHVpbnQg
ZGlvX2ZiX3NpemU7IC8qIEZCIHNpemUgZm9yIGRlZmVycmVkIElPICovCj4gCj4gIC8qIFNlbmQg
bWVzc2FnZSB0byBIeXBlci1WIGhvc3QgKi8KPiAgc3RhdGljIGlubGluZSBpbnQgc3ludGh2aWRf
c2VuZChzdHJ1Y3QgaHZfZGV2aWNlICpoZGV2LAo+IEBAIC0zNDYsMjggKzM1OSw4OCBAQCBzdGF0
aWMgaW50IHN5bnRodmlkX3NlbmRfcHRyKHN0cnVjdCBodl9kZXZpY2UgKmhkZXYpCj4gIH0KPiAK
PiAgLyogU2VuZCB1cGRhdGVkIHNjcmVlbiBhcmVhIChkaXJ0eSByZWN0YW5nbGUpIGxvY2F0aW9u
IHRvIGhvc3QgKi8KPiAtc3RhdGljIGludCBzeW50aHZpZF91cGRhdGUoc3RydWN0IGZiX2luZm8g
KmluZm8pCj4gK3N0YXRpYyBpbnQKPiArc3ludGh2aWRfdXBkYXRlKHN0cnVjdCBmYl9pbmZvICpp
bmZvLCBpbnQgeDEsIGludCB5MSwgaW50IHgyLCBpbnQgeTIpCj4gIHsKPiAgCXN0cnVjdCBodl9k
ZXZpY2UgKmhkZXYgPSBkZXZpY2VfdG9faHZfZGV2aWNlKGluZm8tPmRldmljZSk7Cj4gIAlzdHJ1
Y3Qgc3ludGh2aWRfbXNnIG1zZzsKPiAKPiAgCW1lbXNldCgmbXNnLCAwLCBzaXplb2Yoc3RydWN0
IHN5bnRodmlkX21zZykpOwo+ICsJaWYgKHgyID09IElOVF9NQVgpCj4gKwkJeDIgPSBpbmZvLT52
YXIueHJlczsKPiArCWlmICh5MiA9PSBJTlRfTUFYKQo+ICsJCXkyID0gaW5mby0+dmFyLnlyZXM7
Cj4gCj4gIAltc2cudmlkX2hkci50eXBlID0gU1lOVEhWSURfRElSVDsKPiAgCW1zZy52aWRfaGRy
LnNpemUgPSBzaXplb2Yoc3RydWN0IHN5bnRodmlkX21zZ19oZHIpICsKPiAgCQlzaXplb2Yoc3Ry
dWN0IHN5bnRodmlkX2RpcnQpOwo+ICAJbXNnLmRpcnQudmlkZW9fb3V0cHV0ID0gMDsKPiAgCW1z
Zy5kaXJ0LmRpcnRfY291bnQgPSAxOwo+IC0JbXNnLmRpcnQucmVjdFswXS54MSA9IDA7Cj4gLQlt
c2cuZGlydC5yZWN0WzBdLnkxID0gMDsKPiAtCW1zZy5kaXJ0LnJlY3RbMF0ueDIgPSBpbmZvLT52
YXIueHJlczsKPiAtCW1zZy5kaXJ0LnJlY3RbMF0ueTIgPSBpbmZvLT52YXIueXJlczsKPiArCW1z
Zy5kaXJ0LnJlY3RbMF0ueDEgPSAoeDEgPCAwIHx8IHgxID4geDIpID8gMCA6IHgxOwo+ICsJbXNn
LmRpcnQucmVjdFswXS55MSA9ICh5MiA8IDAgfHwgeTEgPiB5MikgPyAwIDogeTE7CgpUaGlzIHNo
b3VsZCBiZToKCgltc2cuZGlydC5yZWN0WzBdLnkxID0gKHkxIDwgMCB8fCB5MSA+IHkyKSA/IDAg
OiB5MTsKCkFsc28sIHRocm91Z2hvdXQgdGhlIGNvZGUsIEkgZG9uJ3QgdGhpbmsgdGhlcmUgYXJl
IGFueSBwbGFjZXMgd2hlcmUKeCBvciB5IGNvb3JkaW5hdGUgdmFsdWVzIGFyZSBldmVyIG5lZ2F0
aXZlLiAgSU5UX01BWCBvciAwIGlzIHVzZWQgYXMgdGhlCnNlbnRpbmVsIHZhbHVlIGluZGljYXRp
bmcgIm5vdCBzZXQiLiAgU28gY2FuIGFsbCB0aGUgdGVzdHMgZm9yIGxlc3MgdGhhbiAwCm5vdyBi
ZSBlbGltaW5hdGVkLCBib3RoIGluIHRoaXMgZnVuY3Rpb24gYW5kIGluIG90aGVyIGZ1bmN0aW9u
cz8KCj4gKwltc2cuZGlydC5yZWN0WzBdLngyID0KPiArCQkoeDIgPCB4MSB8fCB4MiA+IGluZm8t
PnZhci54cmVzKSA/IGluZm8tPnZhci54cmVzIDogeDI7Cj4gKwltc2cuZGlydC5yZWN0WzBdLnky
ID0KPiArCQkoeTIgPCB5MSB8fCB5MiA+IGluZm8tPnZhci55cmVzKSA/IGluZm8tPnZhci55cmVz
IDogeTI7CgpIb3cgZXhhY3RseSBpcyB0aGUgZGlydHkgcmVjdGFuZ2xlIHNwZWNpZmllZCB0byBI
eXBlci1WPyAgU3VwcG9zZSB0aGUgZnJhbWUKYnVmZmVyIHJlc29sdXRpb24gaXMgMTAweDIwMC4g
IElmIHlvdSB3YW50IHRvIHNwZWNpZnkgdGhlIGVudGlyZSByZWN0YW5nbGUsIHRoZQpmaXJzdCBj
b29yZGluYXRlIGlzICgwLCAwKS4gIEJ1dCB3aGF0IGlzIHRoZSBzZWNvbmQgY29vcmRpbmF0ZT8g
IFNob3VsZCBpdCBiZQooOTksIDE5OSkgb3IgKDEwMCwgMjAwKT8gIFRoZSBhYm92ZSBjb2RlIChh
bmQgb3JpZ2luYWwgY29kZSkgaW1wbGllcyBpdApzaG91bGQgc3BlY2lmaWVkIGFzICgxMDAsIDIw
MCksIHdoaWNoIGlzIGFjdHVhbGx5IGEgcG9pbnQgb3V0c2lkZSB0aGUKbWF4aW11bSByZXNvbHV0
aW9uLCB3aGljaCBpcyBjb3VudGVyLWludHVpdGl2ZSBhbmQgbWFrZXMgbWUgd29uZGVyCmlmIHRo
ZSBjb2RlIGlzIGNvcnJlY3QuCgo+IAo+ICAJc3ludGh2aWRfc2VuZChoZGV2LCAmbXNnKTsKPiAK
PiAgCXJldHVybiAwOwo+ICB9Cj4gCj4gK3N0YXRpYyB2b2lkIGh2ZmJfZG9jb3B5KHN0cnVjdCBo
dmZiX3BhciAqcGFyLAo+ICsJCQl1bnNpZ25lZCBsb25nIG9mZnNldCwKPiArCQkJdW5zaWduZWQg
bG9uZyBzaXplKQo+ICt7Cj4gKwlpZiAoIXBhciB8fCAhcGFyLT5tbWlvX3ZwIHx8ICFwYXItPmRp
b192cCB8fCAhcGFyLT5mYl9yZWFkeSB8fAo+ICsJICAgIHNpemUgPT0gMCB8fCBvZmZzZXQgPj0g
ZGlvX2ZiX3NpemUpCj4gKwkJcmV0dXJuOwo+ICsKPiArCWlmIChvZmZzZXQgKyBzaXplID4gZGlv
X2ZiX3NpemUpCj4gKwkJc2l6ZSA9IGRpb19mYl9zaXplIC0gb2Zmc2V0Owo+ICsKPiArCW1lbWNw
eShwYXItPm1taW9fdnAgKyBvZmZzZXQsIHBhci0+ZGlvX3ZwICsgb2Zmc2V0LCBzaXplKTsKPiAr
fQo+ICsKPiArLyogRGVmZXJyZWQgSU8gY2FsbGJhY2sgKi8KPiArc3RhdGljIHZvaWQgc3ludGh2
aWRfZGVmZXJyZWRfaW8oc3RydWN0IGZiX2luZm8gKnAsCj4gKwkJCQkgc3RydWN0IGxpc3RfaGVh
ZCAqcGFnZWxpc3QpCj4gK3sKPiArCXN0cnVjdCBodmZiX3BhciAqcGFyID0gcC0+cGFyOwo+ICsJ
c3RydWN0IHBhZ2UgKnBhZ2U7Cj4gKwl1bnNpZ25lZCBsb25nIHN0YXJ0LCBlbmQ7Cj4gKwlpbnQg
eTEsIHkyLCBtaW55LCBtYXh5Owo+ICsJdW5zaWduZWQgbG9uZyBmbGFnczsKPiArCj4gKwltaW55
ID0gSU5UX01BWDsKPiArCW1heHkgPSAwOwo+ICsKPiArCWxpc3RfZm9yX2VhY2hfZW50cnkocGFn
ZSwgcGFnZWxpc3QsIGxydSkgewo+ICsJCXN0YXJ0ID0gcGFnZS0+aW5kZXggPDwgUEFHRV9TSElG
VDsKPiArCQllbmQgPSBzdGFydCArIFBBR0VfU0laRSAtIDE7Cj4gKwkJeTEgPSBzdGFydCAvIHAt
PmZpeC5saW5lX2xlbmd0aDsKPiArCQl5MiA9IGVuZCAvIHAtPmZpeC5saW5lX2xlbmd0aDsKClRo
ZSBhYm92ZSBkaXZpc2lvbiByb3VuZHMgZG93biBiZWNhdXNlIGFueSByZW1haW5kZXIgaXMgZGlz
Y2FyZGVkLiAgSQp3b25kZXJlZCB3aGV0aGVyIHJvdW5kaW5nIGRvd24gaXMgY29ycmVjdCwgd2hp
Y2ggZ290IG1lIHRvIHRoaW5raW5nCmFib3V0IGhvdyB0aGUgZGlydHkgcmVjdGFuZ2xlIGlzIHNw
ZWNpZmllZC4gIElzIHkyIHRoZSBpbmRleCBvZiB0aGUgbGFzdApkaXJ0eSByb3c/ICBJZiBzbywg
dGhhdCdzIG5vdCBjb25zaXN0ZW50IHdpdGggdGhlIGNvZGUgaW4gc3ludGh2aWRfdXBkYXRlKCks
CndoaWNoIG1pZ2h0IGNob29zZSB2YXIueXJlcyBhcyB5MiwgYW5kIHRoYXQncyB0aGUgaW5kZXgg
b2YgYSByb3cgb3V0c2lkZQpvZiB0aGUgZnJhbWUgYnVmZmVyLgoKPiArCQlpZiAoeTIgPiBwLT52
YXIueXJlcykKPiArCQkJeTIgPSBwLT52YXIueXJlczsKPiArCQltaW55ID0gbWluX3QoaW50LCBt
aW55LCB5MSk7Cj4gKwkJbWF4eSA9IG1heF90KGludCwgbWF4eSwgeTIpOwo+ICsKPiArCQkvKiBD
b3B5IGZyb20gZGlvIHNwYWNlIHRvIG1taW8gYWRkcmVzcyAqLwo+ICsJCWlmIChwYXItPmZiX3Jl
YWR5KSB7Cj4gKwkJCXNwaW5fbG9ja19pcnFzYXZlKCZwYXItPmRvY29weV9sb2NrLCBmbGFncyk7
Cj4gKwkJCWh2ZmJfZG9jb3B5KHBhciwgc3RhcnQsIFBBR0VfU0laRSk7Cj4gKwkJCXNwaW5fdW5s
b2NrX2lycXJlc3RvcmUoJnBhci0+ZG9jb3B5X2xvY2ssIGZsYWdzKTsKPiArCQl9Cj4gKwl9Cj4g
Kwo+ICsJaWYgKHBhci0+ZmJfcmVhZHkpCj4gKwkJc3ludGh2aWRfdXBkYXRlKHAsIDAsIG1pbnks
IHAtPnZhci54cmVzLCBtYXh5KTsKPiArfQo+ICsKPiArc3RhdGljIHN0cnVjdCBmYl9kZWZlcnJl
ZF9pbyBzeW50aHZpZF9kZWZpbyA9IHsKPiArCS5kZWxheQkJPSBIWiAvIDIwLAo+ICsJLmRlZmVy
cmVkX2lvCT0gc3ludGh2aWRfZGVmZXJyZWRfaW8sCj4gK307Cj4gCj4gIC8qCj4gICAqIEFjdGlv
bnMgb24gcmVjZWl2ZWQgbWVzc2FnZXMgZnJvbSBob3N0Ogo+IEBAIC01OTcsNyArNjcwLDcgQEAg
c3RhdGljIGludCBzeW50aHZpZF9zZW5kX2NvbmZpZyhzdHJ1Y3QgaHZfZGV2aWNlICpoZGV2KQo+
ICAJbXNnLT52aWRfaGRyLnR5cGUgPSBTWU5USFZJRF9WUkFNX0xPQ0FUSU9OOwo+ICAJbXNnLT52
aWRfaGRyLnNpemUgPSBzaXplb2Yoc3RydWN0IHN5bnRodmlkX21zZ19oZHIpICsKPiAgCQlzaXpl
b2Yoc3RydWN0IHN5bnRodmlkX3ZyYW1fbG9jYXRpb24pOwo+IC0JbXNnLT52cmFtLnVzZXJfY3R4
ID0gbXNnLT52cmFtLnZyYW1fZ3BhID0gaW5mby0+Zml4LnNtZW1fc3RhcnQ7Cj4gKwltc2ctPnZy
YW0udXNlcl9jdHggPSBtc2ctPnZyYW0udnJhbV9ncGEgPSBwYXItPm1taW9fcHA7Cj4gIAltc2ct
PnZyYW0uaXNfdnJhbV9ncGFfc3BlY2lmaWVkID0gMTsKPiAgCXN5bnRodmlkX3NlbmQoaGRldiwg
bXNnKTsKPiAKPiBAQCAtNjA3LDcgKzY4MCw3IEBAIHN0YXRpYyBpbnQgc3ludGh2aWRfc2VuZF9j
b25maWcoc3RydWN0IGh2X2RldmljZSAqaGRldikKPiAgCQlyZXQgPSAtRVRJTUVET1VUOwo+ICAJ
CWdvdG8gb3V0Owo+ICAJfQo+IC0JaWYgKG1zZy0+dnJhbV9hY2sudXNlcl9jdHggIT0gaW5mby0+
Zml4LnNtZW1fc3RhcnQpIHsKPiArCWlmIChtc2ctPnZyYW1fYWNrLnVzZXJfY3R4ICE9IHBhci0+
bW1pb19wcCkgewo+ICAJCXByX2VycigiVW5hYmxlIHRvIHNldCBWUkFNIGxvY2F0aW9uXG4iKTsK
PiAgCQlyZXQgPSAtRU5PREVWOwo+ICAJCWdvdG8gb3V0Owo+IEBAIC02MjQsMTkgKzY5Nyw4NSBA
QCBzdGF0aWMgaW50IHN5bnRodmlkX3NlbmRfY29uZmlnKHN0cnVjdCBodl9kZXZpY2UgKmhkZXYp
Cj4gCj4gIC8qCj4gICAqIERlbGF5ZWQgd29yayBjYWxsYmFjazoKPiAtICogSXQgaXMgY2FsbGVk
IGF0IEhWRkJfVVBEQVRFX0RFTEFZIG9yIGxvbmdlciB0aW1lIGludGVydmFsIHRvIHByb2Nlc3MK
PiAtICogc2NyZWVuIHVwZGF0ZXMuIEl0IGlzIHJlLXNjaGVkdWxlZCBpZiBmdXJ0aGVyIHVwZGF0
ZSBpcyBuZWNlc3NhcnkuCj4gKyAqIEl0IGlzIHNjaGVkdWxlZCB0byBjYWxsIHdoZW5ldmVyIHVw
ZGF0ZSByZXF1ZXN0IGlzIHJlY2VpdmVkIGFuZCBpdCBoYXMKPiArICogbm90IGJlZW4gY2FsbGVk
IGluIGxhc3QgSFZGQl9PTkRFTUFORF9USFJPVFRMRSB0aW1lIGludGVydmFsLgo+ICAgKi8KPiAg
c3RhdGljIHZvaWQgaHZmYl91cGRhdGVfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKncpCj4gIHsK
PiAgCXN0cnVjdCBodmZiX3BhciAqcGFyID0gY29udGFpbmVyX29mKHcsIHN0cnVjdCBodmZiX3Bh
ciwgZHdvcmsud29yayk7Cj4gIAlzdHJ1Y3QgZmJfaW5mbyAqaW5mbyA9IHBhci0+aW5mbzsKPiAr
CXVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gKwlpbnQgeDEsIHgyLCB5MSwgeTI7Cj4gKwlpbnQgajsK
PiArCj4gKwl4MSA9IHkxID0gMDsKPiArCXgyID0geTIgPSBJTlRfTUFYOwoKVGhlIGFib3ZlIHR3
byBsaW5lcyBzZWVtIHN1cGVyZmx1b3VzIHNpbmNlIGFsbCBmb3VyIHZhbHVlcwphcmUgdW5jb25k
aXRpb25hbGx5IHNldCBiZWxvdyB3aGVuIHN0b3JpbmcgdGhlIGRpcnR5CnJlY3RhbmdsZSB0byBs
b2NhbCB2YXJpYWJsZXMuCgo+ICsKPiArCXNwaW5fbG9ja19pcnFzYXZlKCZwYXItPmRlbGF5ZWRf
cmVmcmVzaF9sb2NrLCBmbGFncyk7Cj4gKwkvKiBSZXNldCB0aGUgcmVxdWVzdCBmbGFnICovCj4g
KwlwYXItPmRlbGF5ZWRfcmVmcmVzaCA9IGZhbHNlOwo+ICsKPiArCS8qIFN0b3JlIHRoZSBkaXJ0
eSByZWN0YW5nbGUgdG8gbG9jYWwgdmFyaWFibGVzICovCj4gKwl4MSA9IHBhci0+eDE7Cj4gKwl4
MiA9IHBhci0+eDI7Cj4gKwl5MSA9IHBhci0+eTE7Cj4gKwl5MiA9IHBhci0+eTI7Cj4gKwo+ICsJ
LyogQ2xlYXIgZGlydHkgcmVjdGFuZ2xlICovCj4gKwlwYXItPngxID0gcGFyLT55MSA9IElOVF9N
QVg7Cj4gKwlwYXItPngyID0gcGFyLT55MiA9IDA7Cj4gCj4gKwlzcGluX3VubG9ja19pcnFyZXN0
b3JlKCZwYXItPmRlbGF5ZWRfcmVmcmVzaF9sb2NrLCBmbGFncyk7Cj4gKwo+ICsJaWYgKHgxIDwg
MCB8fCB4MSA+IGluZm8tPnZhci54cmVzIHx8IHgyIDwgMCB8fAo+ICsJICAgIHgyID4gaW5mby0+
dmFyLnhyZXMgfHwgeTEgPCAwIHx8IHkxID4gaW5mby0+dmFyLnlyZXMgfHwKPiArCSAgICB5MiA8
IDAgfHwgeTIgPiBpbmZvLT52YXIueXJlcykKPiArCQlyZXR1cm47Cj4gKwo+ICsJLyogQ29weSB0
aGUgZGlydHkgcmVjdGFuZ2xlIHRvIGZyYW1lIGJ1ZmZlciBtZW1vcnkgKi8KPiArCXNwaW5fbG9j
a19pcnFzYXZlKCZwYXItPmRvY29weV9sb2NrLCBmbGFncyk7Cj4gKwlmb3IgKGogPSB5MTsgaiA8
PSB5MiAmJiB4MSA8IHgyOyBqKyspIHsKCngxIDwgeDIgZG9lc24ndCBzZWVtIHRvIGJlIG5lZWRl
ZCBhcyBhIGxvb3AgY29udHJvbCB0ZXN0IGFzCm5laXRoZXIgdmFsdWUgaXMgY2hhbmdlZCBpbiB0
aGUgbG9vcC4KCj4gKwkJaWYgKGogPT0gaW5mby0+dmFyLnlyZXMpCj4gKwkJCWJyZWFrOwo+ICsJ
CWh2ZmJfZG9jb3B5KHBhciwKPiArCQkJICAgIGogKiBpbmZvLT5maXgubGluZV9sZW5ndGggKwo+
ICsJCQkgICAgKHgxICogc2NyZWVuX2RlcHRoIC8gOCksCj4gKwkJCSAgICAoeDIgLSB4MSArIDEp
ICogc2NyZWVuX2RlcHRoIC8gOCk7CgpXaGV0aGVyIHRoZSArMSBpcyBuZWVkZWQgYWJvdmUgZ2V0
cyBiYWNrIHRvIHRoZSBxdWVzdGlvbiBJCnJhaXNlZCBlYXJsaWVyIGFib3V0IGhvdyB0byBpbnRl
cnByZXQgdGhlIGNvb3JkaW5hdGVzIC0tIHdoZXRoZXIKdGhlICh4MiwgeTIpIGNvb3JkaW5hdGUg
aXMganVzdCBvdXRzaWRlIHRoZSBkaXJ0eSByZWN0YW5nbGUgb3IKanVzdCBpbnNpZGUgdGhlIGRp
cnR5IHJlY3RhbmdsZS4gIE1vc3Qgb2YgdGhlIGNvZGUgc2VlbXMgdG8gdHJlYXQKaXQgYXMgYmVp
bmcganVzdCBvdXRzaWRlIHRoZSBkaXJ0eSByZWN0YW5nbGUsIGluIHdoaWNoIGNhc2UgdGhlICsx
CnNob3VsZCBub3QgYmUgdXNlZC4KCj4gKwl9Cj4gKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZw
YXItPmRvY29weV9sb2NrLCBmbGFncyk7Cj4gKwo+ICsJLyogUmVmcmVzaCAqLwo+ICAJaWYgKHBh
ci0+ZmJfcmVhZHkpCj4gLQkJc3ludGh2aWRfdXBkYXRlKGluZm8pOwo+ICsJCXN5bnRodmlkX3Vw
ZGF0ZShpbmZvLCB4MSwgeTEsIHgyLCB5Mik7Cj4gK30KPiArCj4gKy8qCj4gKyAqIENvbnRyb2wg
dGhlIG9uLWRlbWFuZCByZWZyZXNoIGZyZXF1ZW5jeS4gSXQgc2NoZWR1bGVzIGEgZGVsYXllZAo+
ICsgKiBzY3JlZW4gdXBkYXRlIGlmIGl0IGhhcyBub3QgeWV0Lgo+ICsgKi8KPiArc3RhdGljIHZv
aWQgaHZmYl9vbmRlbWFuZF9yZWZyZXNoX3Rocm90dGxlKHN0cnVjdCBodmZiX3BhciAqcGFyLAo+
ICsJCQkJCSAgIGludCB4MSwgaW50IHkxLCBpbnQgdywgaW50IGgpCj4gK3sKPiArCXVuc2lnbmVk
IGxvbmcgZmxhZ3M7Cj4gKwlpbnQgeDIgPSB4MSArIHc7Cj4gKwlpbnQgeTIgPSB5MSArIGg7Cj4g
Kwo+ICsJc3Bpbl9sb2NrX2lycXNhdmUoJnBhci0+ZGVsYXllZF9yZWZyZXNoX2xvY2ssIGZsYWdz
KTsKPiArCj4gKwkvKiBNZXJnZSBkaXJ0eSByZWN0YW5nbGUgKi8KPiArCXBhci0+eDEgPSBtaW5f
dChpbnQsIHBhci0+eDEsIHgxKTsKPiArCXBhci0+eTEgPSBtaW5fdChpbnQsIHBhci0+eTEsIHkx
KTsKPiArCXBhci0+eDIgPSBtYXhfdChpbnQsIHBhci0+eDIsIHgyKTsKPiArCXBhci0+eTIgPSBt
YXhfdChpbnQsIHBhci0+eTIsIHkyKTsKPiArCj4gKwkvKiBTY2hlZHVsZSBhIGRlbGF5ZWQgc2Ny
ZWVuIHVwZGF0ZSBpZiBub3QgeWV0ICovCj4gKwlpZiAocGFyLT5kZWxheWVkX3JlZnJlc2ggPT0g
ZmFsc2UpIHsKPiArCQlzY2hlZHVsZV9kZWxheWVkX3dvcmsoJnBhci0+ZHdvcmssCj4gKwkJCQkg
ICAgICBIVkZCX09OREVNQU5EX1RIUk9UVExFKTsKPiArCQlwYXItPmRlbGF5ZWRfcmVmcmVzaCA9
IHRydWU7Cj4gKwl9Cj4gCj4gLQlpZiAocGFyLT51cGRhdGUpCj4gLQkJc2NoZWR1bGVfZGVsYXll
ZF93b3JrKCZwYXItPmR3b3JrLCBIVkZCX1VQREFURV9ERUxBWSk7Cj4gKwlzcGluX3VubG9ja19p
cnFyZXN0b3JlKCZwYXItPmRlbGF5ZWRfcmVmcmVzaF9sb2NrLCBmbGFncyk7Cj4gIH0KPiAKPiAg
c3RhdGljIGludCBodmZiX29uX3BhbmljKHN0cnVjdCBub3RpZmllcl9ibG9jayAqbmIsCj4gQEAg
LTY0OCw3ICs3ODcsOCBAQCBzdGF0aWMgaW50IGh2ZmJfb25fcGFuaWMoc3RydWN0IG5vdGlmaWVy
X2Jsb2NrICpuYiwKPiAgCXBhciA9IGNvbnRhaW5lcl9vZihuYiwgc3RydWN0IGh2ZmJfcGFyLCBo
dmZiX3BhbmljX25iKTsKPiAgCXBhci0+c3luY2hyb25vdXNfZmIgPSB0cnVlOwo+ICAJaW5mbyA9
IHBhci0+aW5mbzsKPiAtCXN5bnRodmlkX3VwZGF0ZShpbmZvKTsKPiArCWh2ZmJfZG9jb3B5KHBh
ciwgMCwgZGlvX2ZiX3NpemUpOwo+ICsJc3ludGh2aWRfdXBkYXRlKGluZm8sIDAsIDAsIElOVF9N
QVgsIElOVF9NQVgpOwo+IAo+ICAJcmV0dXJuIE5PVElGWV9ET05FOwo+ICB9Cj4gQEAgLTcwOSw3
ICs4NDksMTAgQEAgc3RhdGljIHZvaWQgaHZmYl9jZmJfZmlsbHJlY3Qoc3RydWN0IGZiX2luZm8g
KnAsCj4gCj4gIAljZmJfZmlsbHJlY3QocCwgcmVjdCk7Cj4gIAlpZiAocGFyLT5zeW5jaHJvbm91
c19mYikKPiAtCQlzeW50aHZpZF91cGRhdGUocCk7Cj4gKwkJc3ludGh2aWRfdXBkYXRlKHAsIDAs
IDAsIElOVF9NQVgsIElOVF9NQVgpOwo+ICsJZWxzZQo+ICsJCWh2ZmJfb25kZW1hbmRfcmVmcmVz
aF90aHJvdHRsZShwYXIsIHJlY3QtPmR4LCByZWN0LT5keSwKPiArCQkJCQkgICAgICAgcmVjdC0+
d2lkdGgsIHJlY3QtPmhlaWdodCk7Cj4gIH0KPiAKPiAgc3RhdGljIHZvaWQgaHZmYl9jZmJfY29w
eWFyZWEoc3RydWN0IGZiX2luZm8gKnAsCj4gQEAgLTcxOSw3ICs4NjIsMTAgQEAgc3RhdGljIHZv
aWQgaHZmYl9jZmJfY29weWFyZWEoc3RydWN0IGZiX2luZm8gKnAsCj4gCj4gIAljZmJfY29weWFy
ZWEocCwgYXJlYSk7Cj4gIAlpZiAocGFyLT5zeW5jaHJvbm91c19mYikKPiAtCQlzeW50aHZpZF91
cGRhdGUocCk7Cj4gKwkJc3ludGh2aWRfdXBkYXRlKHAsIDAsIDAsIElOVF9NQVgsIElOVF9NQVgp
Owo+ICsJZWxzZQo+ICsJCWh2ZmJfb25kZW1hbmRfcmVmcmVzaF90aHJvdHRsZShwYXIsIGFyZWEt
PmR4LCBhcmVhLT5keSwKPiArCQkJCQkgICAgICAgYXJlYS0+d2lkdGgsIGFyZWEtPmhlaWdodCk7
Cj4gIH0KPiAKPiAgc3RhdGljIHZvaWQgaHZmYl9jZmJfaW1hZ2VibGl0KHN0cnVjdCBmYl9pbmZv
ICpwLAo+IEBAIC03MjksNyArODc1LDEwIEBAIHN0YXRpYyB2b2lkIGh2ZmJfY2ZiX2ltYWdlYmxp
dChzdHJ1Y3QgZmJfaW5mbyAqcCwKPiAKPiAgCWNmYl9pbWFnZWJsaXQocCwgaW1hZ2UpOwo+ICAJ
aWYgKHBhci0+c3luY2hyb25vdXNfZmIpCj4gLQkJc3ludGh2aWRfdXBkYXRlKHApOwo+ICsJCXN5
bnRodmlkX3VwZGF0ZShwLCAwLCAwLCBJTlRfTUFYLCBJTlRfTUFYKTsKPiArCWVsc2UKPiArCQlo
dmZiX29uZGVtYW5kX3JlZnJlc2hfdGhyb3R0bGUocGFyLCBpbWFnZS0+ZHgsIGltYWdlLT5keSwK
PiArCQkJCQkgICAgICAgaW1hZ2UtPndpZHRoLCBpbWFnZS0+aGVpZ2h0KTsKPiAgfQo+IAo+ICBz
dGF0aWMgc3RydWN0IGZiX29wcyBodmZiX29wcyA9IHsKPiBAQCAtNzg4LDYgKzkzNyw5IEBAIHN0
YXRpYyBpbnQgaHZmYl9nZXRtZW0oc3RydWN0IGh2X2RldmljZSAqaGRldiwgc3RydWN0IGZiX2lu
Zm8KPiAqaW5mbykKPiAgCXJlc291cmNlX3NpemVfdCBwb3Rfc3RhcnQsIHBvdF9lbmQ7Cj4gIAlp
bnQgcmV0Owo+IAo+ICsJZGlvX2ZiX3NpemUgPQo+ICsJCXNjcmVlbl93aWR0aCAqIHNjcmVlbl9o
ZWlnaHQgKiBzY3JlZW5fZGVwdGggLyA4Owo+ICsKPiAgCWlmIChnZW4ydm0pIHsKPiAgCQlwb3Rf
c3RhcnQgPSAwOwo+ICAJCXBvdF9lbmQgPSAtMTsKPiBAQCAtODIyLDkgKzk3NCwxNSBAQCBzdGF0
aWMgaW50IGh2ZmJfZ2V0bWVtKHN0cnVjdCBodl9kZXZpY2UgKmhkZXYsIHN0cnVjdCBmYl9pbmZv
Cj4gKmluZm8pCj4gIAlpZiAoIWZiX3ZpcnQpCj4gIAkJZ290byBlcnIyOwo+IAo+ICsJLyogQWxs
b2NhdGUgbWVtb3J5IGZvciBkZWZlcnJlZCBJTyAqLwo+ICsJcGFyLT5kaW9fdnAgPSB2emFsbG9j
KCgoZGlvX2ZiX3NpemUgPj4gUEFHRV9TSElGVCkgKyAxKQo+ICsJCQkJIDw8IFBBR0VfU0hJRlQp
OwoKSSdkIHN1Z2dlc3QgdXNpbmcgdGhlIHJvdW5kX3VwKCkgZnVuY3Rpb24gc28gdGhhdCB3aGF0
IHlvdSBhcmUgZG9pbmcKaXMgZXhwbGljaXQuCgo+ICsJaWYgKHBhci0+ZGlvX3ZwID09IE5VTEwp
Cj4gKwkJZ290byBlcnIzOwo+ICsKPiAgCWluZm8tPmFwZXJ0dXJlcyA9IGFsbG9jX2FwZXJ0dXJl
cygxKTsKPiAgCWlmICghaW5mby0+YXBlcnR1cmVzKQo+IC0JCWdvdG8gZXJyMzsKPiArCQlnb3Rv
IGVycjQ7Cj4gCj4gIAlpZiAoZ2VuMnZtKSB7Cj4gIAkJaW5mby0+YXBlcnR1cmVzLT5yYW5nZXNb
MF0uYmFzZSA9IHNjcmVlbl9pbmZvLmxmYl9iYXNlOwo+IEBAIC04MzYsMTYgKzk5NCwyMyBAQCBz
dGF0aWMgaW50IGh2ZmJfZ2V0bWVtKHN0cnVjdCBodl9kZXZpY2UgKmhkZXYsIHN0cnVjdCBmYl9p
bmZvCj4gKmluZm8pCj4gIAkJaW5mby0+YXBlcnR1cmVzLT5yYW5nZXNbMF0uc2l6ZSA9IHBjaV9y
ZXNvdXJjZV9sZW4ocGRldiwgMCk7Cj4gIAl9Cj4gCj4gKwkvKiBQaHlzaWNhbCBhZGRyZXNzIG9m
IEZCIGRldmljZSAqLwo+ICsJcGFyLT5tbWlvX3BwID0gcGFyLT5tZW0tPnN0YXJ0Owo+ICsJLyog
VmlydHVhbCBhZGRyZXNzIG9mIEZCIGRldmljZSAqLwo+ICsJcGFyLT5tbWlvX3ZwID0gKHVuc2ln
bmVkIGNoYXIgKikgZmJfdmlydDsKPiArCj4gIAlpbmZvLT5maXguc21lbV9zdGFydCA9IHBhci0+
bWVtLT5zdGFydDsKPiAtCWluZm8tPmZpeC5zbWVtX2xlbiA9IHNjcmVlbl9mYl9zaXplOwo+IC0J
aW5mby0+c2NyZWVuX2Jhc2UgPSBmYl92aXJ0Owo+IC0JaW5mby0+c2NyZWVuX3NpemUgPSBzY3Jl
ZW5fZmJfc2l6ZTsKPiArCWluZm8tPmZpeC5zbWVtX2xlbiA9IGRpb19mYl9zaXplOwo+ICsJaW5m
by0+c2NyZWVuX2Jhc2UgPSBwYXItPmRpb192cDsKPiArCWluZm8tPnNjcmVlbl9zaXplID0gZGlv
X2ZiX3NpemU7Cj4gCj4gIAlpZiAoIWdlbjJ2bSkKPiAgCQlwY2lfZGV2X3B1dChwZGV2KTsKPiAK
PiAgCXJldHVybiAwOwo+IAo+ICtlcnI0Ogo+ICsJdmZyZWUocGFyLT5kaW9fdnApOwo+ICBlcnIz
Ogo+ICAJaW91bm1hcChmYl92aXJ0KTsKPiAgZXJyMjoKPiBAQCAtODYzLDYgKzEwMjgsNyBAQCBz
dGF0aWMgdm9pZCBodmZiX3B1dG1lbShzdHJ1Y3QgZmJfaW5mbyAqaW5mbykKPiAgewo+ICAJc3Ry
dWN0IGh2ZmJfcGFyICpwYXIgPSBpbmZvLT5wYXI7Cj4gCj4gKwl2ZnJlZShwYXItPmRpb192cCk7
Cj4gIAlpb3VubWFwKGluZm8tPnNjcmVlbl9iYXNlKTsKPiAgCXZtYnVzX2ZyZWVfbW1pbyhwYXIt
Pm1lbS0+c3RhcnQsIHNjcmVlbl9mYl9zaXplKTsKPiAgCXBhci0+bWVtID0gTlVMTDsKPiBAQCAt
ODg4LDYgKzEwNTQsMTIgQEAgc3RhdGljIGludCBodmZiX3Byb2JlKHN0cnVjdCBodl9kZXZpY2Ug
KmhkZXYsCj4gIAlpbml0X2NvbXBsZXRpb24oJnBhci0+d2FpdCk7Cj4gIAlJTklUX0RFTEFZRURf
V09SSygmcGFyLT5kd29yaywgaHZmYl91cGRhdGVfd29yayk7Cj4gCj4gKwlwYXItPmRlbGF5ZWRf
cmVmcmVzaCA9IGZhbHNlOwo+ICsJc3Bpbl9sb2NrX2luaXQoJnBhci0+ZGVsYXllZF9yZWZyZXNo
X2xvY2spOwo+ICsJc3Bpbl9sb2NrX2luaXQoJnBhci0+ZG9jb3B5X2xvY2spOwo+ICsJcGFyLT54
MSA9IHBhci0+eTEgPSBJTlRfTUFYOwo+ICsJcGFyLT54MiA9IHBhci0+eTIgPSAwOwo+ICsKPiAg
CS8qIENvbm5lY3QgdG8gVlNQICovCj4gIAlodl9zZXRfZHJ2ZGF0YShoZGV2LCBpbmZvKTsKPiAg
CXJldCA9IHN5bnRodmlkX2Nvbm5lY3RfdnNwKGhkZXYpOwo+IEBAIC05MzksNiArMTExMSwxMCBA
QCBzdGF0aWMgaW50IGh2ZmJfcHJvYmUoc3RydWN0IGh2X2RldmljZSAqaGRldiwKPiAgCWluZm8t
PmZib3BzID0gJmh2ZmJfb3BzOwo+ICAJaW5mby0+cHNldWRvX3BhbGV0dGUgPSBwYXItPnBzZXVk
b19wYWxldHRlOwo+IAo+ICsJLyogSW5pdGlhbGl6ZSBkZWZlcnJlZCBJTyAqLwo+ICsJaW5mby0+
ZmJkZWZpbyA9ICZzeW50aHZpZF9kZWZpbzsKPiArCWZiX2RlZmVycmVkX2lvX2luaXQoaW5mbyk7
Cj4gKwo+ICAJLyogU2VuZCBjb25maWcgdG8gaG9zdCAqLwo+ICAJcmV0ID0gc3ludGh2aWRfc2Vu
ZF9jb25maWcoaGRldik7Cj4gIAlpZiAocmV0KQo+IEBAIC05NjAsNiArMTEzNiw3IEBAIHN0YXRp
YyBpbnQgaHZmYl9wcm9iZShzdHJ1Y3QgaHZfZGV2aWNlICpoZGV2LAo+ICAJcmV0dXJuIDA7Cj4g
Cj4gIGVycm9yOgo+ICsJZmJfZGVmZXJyZWRfaW9fY2xlYW51cChpbmZvKTsKPiAgCWh2ZmJfcHV0
bWVtKGluZm8pOwo+ICBlcnJvcjI6Cj4gIAl2bWJ1c19jbG9zZShoZGV2LT5jaGFubmVsKTsKPiAt
LQo+IDIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
Cmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
