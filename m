Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 82A6349D6C
	for <lists+dri-devel@lfdr.de>; Tue, 18 Jun 2019 11:34:05 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8B55F6E123;
	Tue, 18 Jun 2019 09:34:02 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x541.google.com (mail-ed1-x541.google.com
 [IPv6:2a00:1450:4864:20::541])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 327D96E123
 for <dri-devel@lists.freedesktop.org>; Tue, 18 Jun 2019 09:34:01 +0000 (UTC)
Received: by mail-ed1-x541.google.com with SMTP id m10so20724031edv.6
 for <dri-devel@lists.freedesktop.org>; Tue, 18 Jun 2019 02:34:01 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:sender:date:from:to:cc:subject:message-id
 :mail-followup-to:references:mime-version:content-disposition
 :in-reply-to:user-agent;
 bh=UFE9xhhCoOsngkjBhCT7Ii+xz3vRhHv8f7WS1OkDF98=;
 b=foAueA5vs/RWImkkLm7xoQQ+G1qohUJe9kNX5idVfRhjU7YF1HM1VlhaDRGOFurZTQ
 I00bFJn4KfYyg+sf1/W/OYlMUW+3GI8lCLJw5vcpCZwVfTfnRJcSvyUeOuxJcaRZ2gfg
 fxTpwwbawTwnGUsuPV1rNADrXsWBpcIVwuLAAaUYCrT/e8+eJ0YfoQ0X27I/JmfR67jX
 /UzeMgqjdt0zvbmJ3jAcpcg6dsOE3WqW/F8PHykWjPXcdyidyHyh3e163asnDewgofMx
 DVJv5iv4GtktxjF4x2BlFy5rpb9lqi+6bgK2g1WPd7dskSOCdbjyDpIy/jJXP92iMk62
 /+qg==
X-Gm-Message-State: APjAAAVG6NQMZvy5V8sOBJ8k3YI6li8wHzL7P7fd8lptODtgd0kd0gwe
 H4y/E2IG43vDm9oM30nfBedylQ==
X-Google-Smtp-Source: APXvYqwNa+sNXzD0TimWqJsAd4mUtXeERJ4OMwICCs6PAeYWcSvksJqqWfsoXmYTd3ouXGX/SiSPtQ==
X-Received: by 2002:a50:b561:: with SMTP id z30mr69670464edd.87.1560850439862; 
 Tue, 18 Jun 2019 02:33:59 -0700 (PDT)
Received: from phenom.ffwll.local ([2a02:168:569e:0:3106:d637:d723:e855])
 by smtp.gmail.com with ESMTPSA id 34sm4616040eds.5.2019.06.18.02.33.58
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Tue, 18 Jun 2019 02:33:58 -0700 (PDT)
Date: Tue, 18 Jun 2019 11:33:56 +0200
From: Daniel Vetter <daniel@ffwll.ch>
To: Rodrigo Siqueira <rodrigosiqueiramelo@gmail.com>
Subject: Re: [PATCH V2 5/5] drm/vkms: Add support for writeback
Message-ID: <20190618093356.GR12905@phenom.ffwll.local>
Mail-Followup-To: Rodrigo Siqueira <rodrigosiqueiramelo@gmail.com>,
 Brian Starkey <brian.starkey@arm.com>,
 Liviu Dudau <liviu.dudau@arm.com>,
 Haneen Mohammed <hamohammed.sa@gmail.com>,
 Simon Ser <contact@emersion.fr>, dri-devel@lists.freedesktop.org,
 linux-kernel@vger.kernel.org
References: <cover.1560820888.git.rodrigosiqueiramelo@gmail.com>
 <4787369d4927fa709da050e7481e48102842fd97.1560820888.git.rodrigosiqueiramelo@gmail.com>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <4787369d4927fa709da050e7481e48102842fd97.1560820888.git.rodrigosiqueiramelo@gmail.com>
X-Operating-System: Linux phenom 4.19.0-5-amd64 
User-Agent: Mutt/1.10.1 (2018-07-13)
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ffwll.ch; s=google;
 h=sender:date:from:to:cc:subject:message-id:mail-followup-to
 :references:mime-version:content-disposition:in-reply-to:user-agent;
 bh=UFE9xhhCoOsngkjBhCT7Ii+xz3vRhHv8f7WS1OkDF98=;
 b=HXO7QkTVKrpBkqtwsuJ0SQwlPP5sO0QkOBYCbAk6D+C/FsJw8kut07i5qN9a/sshC0
 RZuJfRPfaLkQM7sQ25lG/Y2bKRntSCKmMn1129Yt0mIr438Ydbp4wprftJiFV0mwyAC2
 35nQQxZ1ukvSp5SrTRFaQXXMYG1gyd28yQc04=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Haneen Mohammed <hamohammed.sa@gmail.com>, Simon Ser <contact@emersion.fr>,
 Liviu Dudau <liviu.dudau@arm.com>, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gTW9uLCBKdW4gMTcsIDIwMTkgYXQgMTE6NDU6NTVQTSAtMDMwMCwgUm9kcmlnbyBTaXF1ZWly
YSB3cm90ZToKPiBUaGlzIHBhdGNoIGltcGxlbWVudHMgdGhlIG5lY2Vzc2FyeSBmdW5jdGlvbnMg
dG8gYWRkIHdyaXRlYmFjayBzdXBwb3J0Cj4gZm9yIHZrbXMuIFRoaXMgZmVhdHVyZSBpcyB1c2Vm
dWwgZm9yIHRlc3RpbmcgY29tcG9zaXRvcnMgaWYgeW91IGRvbid0Cj4gaGF2ZSBoYXJkd2FyZSB3
aXRoIHdyaXRlYmFjayBzdXBwb3J0Lgo+IAo+IENoYW5nZSBpbiBWMjoKPiAtIFJld29yayBzaWdu
YWwgY29tcGxldGlvbiAoQnJpYW4pCj4gLSBJbnRlZ3JhdGVzIHdyaXRlYmFjayB3aXRoIGFjdGl2
ZV9wbGFuZXMgKERhbmllbCkKPiAtIENvbXBvc2UgY3Vyc29yIChEYW5pZWwpCgpOb3QgcXVpdGUg
d2hhdCBJIGhhZCBpbiBtaW5kIC4uLiBteSBpZGVhIHdhcyB0byByZXVzZSB0aGUgY3JjIHdvcmtl
cgooaGVuY2UgcmVuYW1pbmcgYWxsIHRoYXQgc3R1ZmYgdG8gdmttc19jb21wb3NlcikuIFRoZSBw
cm9ibGVtIGhlcmUgaXMgdGhhdApub3cgd2UgaGF2ZSB0aGUgYmxlbmQvY29tcG9zZSBjb2RlIGR1
cGxpY2F0ZWQsIGF0IGxlYXN0IHBhcnRzIG9mIGl0LiBQbHVzCmlmIHlvdSBlbmFibGUgYm90aCBj
cmMgYW5kIHdyaXRlYmFjaywgdGhlbiB3ZSBjb21wb3NlIDJ4LCB3aGljaCBpcyBhIGJpdAp0b28g
bXVjaC4KClJvdWdoIHNrZXRjaCBvZiBhbiBpbXBsZW1lbnRhdGlvbjoKCi0gYWRkIHdyaXRlYmFj
a19wZW5kaW5nLCBsaWtlIHdlIGhhdmUgY3JjX3BlbmRpbmcgYWxyZWFkeS4gRGlmZmVyZW5jZSBp
cwogIHRoYXQgd3JpdGViYWNrIGlzIG9uZS1zaG90LCBpLmUuIHNldCBpdCBpbiBhdG9taWNfY2hl
Y2sgc29tZXdoZXJlLCBjbGVhcgogIGl0IGluIHRoZSBjcmNfd29ya2VyICh3ZWxsLCBjb21wb3Nl
cl93b3JrZXIgbm93KS4gdmJsYW5rIGhydGltZXIgd2lsbAogIG5vdCByZS1lbmFibGUgdGhhdCBv
bmUgKHVubGlrZSBjcmNfcGVuZGluZykuCgotIGluIHRoZSBjcmMgd29ya2VyLCBpZiB3cml0ZWJh
Y2tfcGVuZGluZyBpcyBzZXQsIHRoZW4gY29tcG9zZSBldmVyeXRoaW5nCiAgaW50byB0aGUgd3Jp
dGViYWNrIGJ1ZmZlciBpbnN0ZWFkIG9mIGludG8gb3VyIHByaXZhdGUgY3JjIGJ1ZmZlci4gRXhj
ZXB0CiAgdGhhdCB3ZSB1c2UgZGlmZmVyZW50IG1lbW9yeSwgY3JjIGNvbXB1dGF0aW9uIHdpbGwg
YmUgZG9uZSBleGFjdGx5IHRoZQogIHNhbWUuIEZvciBzdWJzZXF1ZW50IGZyYW1lcyB3aXRoIHRo
ZSBzYW1lIGNydGNfc3RhdGUgd2Ugd2lsbCBhZ2FpbiB1c2UKICB0aGUgbm9ybWFsIGNyYyBidWZm
ZXIgdG8gY29tcG9zZSAmIGNvbXB1dGUgdGhlIGNyYy4KClRoZSBiZW5lZml0IGhlcmUgaXMgdGhh
dCB3ZSdsbCBvbmx5IGhhdmUgb25lIHBsYWNlIGluIHZrbXMgdGhhdCBkb2VzCmNvbXBvc2luZywg
c28gaWYgd2UgYWRkIGxvdHMgbW9yZSBmZWF0dXJlcyBpbiB0aGUgZnV0dXJlLCBpdCdsbCBiZSBt
dWNoCmVhc2llciB0byBtYWludGFpbi4gQWxzbyBzaW5jZSB0aGlzIGd1YXJhbnRlZXMgdGhhdCB0
aGUgY3JjIHdpbGwgbWF0Y2gKZXhhY3RseSB3aGF0IHdlJ3ZlIHdyaXR0ZW4gYmFjaywgd2UgY2Fu
IHVzZSB0aGUgY3JjIHRvIGhlbHAgdmFsaWRhdGUgb3VyCndyaXRlYmFjayBjb2RlLgoKQ2hlZXJz
LCBEYW5pZWwKCj4gCj4gU2lnbmVkLW9mZi1ieTogUm9kcmlnbyBTaXF1ZWlyYSA8cm9kcmlnb3Np
cXVlaXJhbWVsb0BnbWFpbC5jb20+Cj4gLS0tCj4gIGRyaXZlcnMvZ3B1L2RybS92a21zL01ha2Vm
aWxlICAgICAgICAgfCAgIDMgKy0KPiAgZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19kcnYuYyAg
ICAgICB8ICAgNyArKwo+ICBkcml2ZXJzL2dwdS9kcm0vdmttcy92a21zX2Rydi5oICAgICAgIHwg
ICA2ICsKPiAgZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19vdXRwdXQuYyAgICB8ICAgNiArCj4g
IGRyaXZlcnMvZ3B1L2RybS92a21zL3ZrbXNfd3JpdGViYWNrLmMgfCAxNjYgKysrKysrKysrKysr
KysrKysrKysrKysrKysKPiAgNSBmaWxlcyBjaGFuZ2VkLCAxODcgaW5zZXJ0aW9ucygrKSwgMSBk
ZWxldGlvbigtKQo+ICBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmtt
c193cml0ZWJhY2suYwo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdmttcy9NYWtl
ZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS92a21zL01ha2VmaWxlCj4gaW5kZXggYjRjMDQwODU0YmQ2
Li4wOTFlNmZhNjQzZDEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL3ZrbXMvTWFrZWZp
bGUKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vdmttcy9NYWtlZmlsZQo+IEBAIC02LDYgKzYsNyBA
QCB2a21zLXkgOj0gXAo+ICAJdmttc19jcnRjLm8gXAo+ICAJdmttc19nZW0ubyBcCj4gIAl2a21z
X2NvbXBvc2VyLm8gXAo+IC0Jdmttc19jcmMubwo+ICsJdmttc19jcmMubyBcCj4gKwl2a21zX3dy
aXRlYmFjay5vCj4gIAo+ICBvYmotJChDT05GSUdfRFJNX1ZLTVMpICs9IHZrbXMubwo+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdmttcy92a21zX2Rydi5jIGIvZHJpdmVycy9ncHUvZHJt
L3ZrbXMvdmttc19kcnYuYwo+IGluZGV4IDk2NmIzZDY1MzE4OS4uZDg3MDc3OWFiZjlkIDEwMDY0
NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS92a21zL3ZrbXNfZHJ2LmMKPiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vdmttcy92a21zX2Rydi5jCj4gQEAgLTMwLDYgKzMwLDEwIEBAIGJvb2wgZW5hYmxl
X2N1cnNvcjsKPiAgbW9kdWxlX3BhcmFtX25hbWVkKGVuYWJsZV9jdXJzb3IsIGVuYWJsZV9jdXJz
b3IsIGJvb2wsIDA0NDQpOwo+ICBNT0RVTEVfUEFSTV9ERVNDKGVuYWJsZV9jdXJzb3IsICJFbmFi
bGUvRGlzYWJsZSBjdXJzb3Igc3VwcG9ydCIpOwo+ICAKPiArYm9vbCBlbmFibGVfd3JpdGViYWNr
Owo+ICttb2R1bGVfcGFyYW1fbmFtZWQoZW5hYmxlX3dyaXRlYmFjaywgZW5hYmxlX3dyaXRlYmFj
aywgYm9vbCwgMDQ0NCk7Cj4gK01PRFVMRV9QQVJNX0RFU0MoZW5hYmxlX3dyaXRlYmFjaywgIkVu
YWJsZS9EaXNhYmxlIHdyaXRlYmFjayBjb25uZWN0b3IiKTsKPiArCj4gIHN0YXRpYyBjb25zdCBz
dHJ1Y3QgZmlsZV9vcGVyYXRpb25zIHZrbXNfZHJpdmVyX2ZvcHMgPSB7Cj4gIAkub3duZXIJCT0g
VEhJU19NT0RVTEUsCj4gIAkub3BlbgkJPSBkcm1fb3BlbiwKPiBAQCAtMTU4LDYgKzE2Miw5IEBA
IHN0YXRpYyBpbnQgX19pbml0IHZrbXNfaW5pdCh2b2lkKQo+ICAJCWdvdG8gb3V0X2Zpbmk7Cj4g
IAl9Cj4gIAo+ICsJaWYgKGVuYWJsZV93cml0ZWJhY2spCj4gKwkJRFJNX0lORk8oIldyaXRlYmFj
ayBjb25uZWN0b3IgZW5hYmxlZCIpOwo+ICsKPiAgCXJldCA9IHZrbXNfbW9kZXNldF9pbml0KHZr
bXNfZGV2aWNlKTsKPiAgCWlmIChyZXQpCj4gIAkJZ290byBvdXRfZmluaTsKPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS92a21z
L3ZrbXNfZHJ2LmgKPiBpbmRleCBhZDYzZGJlNWU5OTQuLmJmM2ZhNzM3YjNkNyAxMDA2NDQKPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vdmttcy92a21zX2Rydi5oCj4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL3ZrbXMvdmttc19kcnYuaAo+IEBAIC03LDYgKzcsNyBAQAo+ICAjaW5jbHVkZSA8ZHJtL2Ry
bS5oPgo+ICAjaW5jbHVkZSA8ZHJtL2RybV9nZW0uaD4KPiAgI2luY2x1ZGUgPGRybS9kcm1fZW5j
b2Rlci5oPgo+ICsjaW5jbHVkZSA8ZHJtL2RybV93cml0ZWJhY2suaD4KPiAgI2luY2x1ZGUgPGxp
bnV4L2hydGltZXIuaD4KPiAgCj4gICNkZWZpbmUgWFJFU19NSU4gICAgMjAKPiBAQCAtMTksNiAr
MjAsNyBAQAo+ICAjZGVmaW5lIFlSRVNfTUFYICA4MTkyCj4gIAo+ICBleHRlcm4gYm9vbCBlbmFi
bGVfY3Vyc29yOwo+ICtleHRlcm4gYm9vbCBlbmFibGVfd3JpdGViYWNrOwo+ICAKPiAgc3RydWN0
IHZrbXNfZGF0YSB7Cj4gIAlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyIGZiOwo+IEBAIC02Myw2ICs2
NSw3IEBAIHN0cnVjdCB2a21zX291dHB1dCB7Cj4gIAlzdHJ1Y3QgZHJtX2NydGMgY3J0YzsKPiAg
CXN0cnVjdCBkcm1fZW5jb2RlciBlbmNvZGVyOwo+ICAJc3RydWN0IGRybV9jb25uZWN0b3IgY29u
bmVjdG9yOwo+ICsJc3RydWN0IGRybV93cml0ZWJhY2tfY29ubmVjdG9yIHdiX2Nvbm5lY3RvcjsK
PiAgCXN0cnVjdCBocnRpbWVyIHZibGFua19ocnRpbWVyOwo+ICAJa3RpbWVfdCBwZXJpb2RfbnM7
Cj4gIAlzdHJ1Y3QgZHJtX3BlbmRpbmdfdmJsYW5rX2V2ZW50ICpldmVudDsKPiBAQCAtMTQzLDQg
KzE0Niw3IEBAIGludCB2a21zX3ZlcmlmeV9jcmNfc291cmNlKHN0cnVjdCBkcm1fY3J0YyAqY3J0
YywgY29uc3QgY2hhciAqc291cmNlX25hbWUsCj4gIAkJCSAgIHNpemVfdCAqdmFsdWVzX2NudCk7
Cj4gIHZvaWQgdmttc19jcmNfd29ya19oYW5kbGUoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKTsK
PiAgCj4gKy8qIFdyaXRlYmFjayAqLwo+ICtpbnQgZW5hYmxlX3dyaXRlYmFja19jb25uZWN0b3Io
c3RydWN0IHZrbXNfZGV2aWNlICp2a21zZGV2KTsKPiArCj4gICNlbmRpZiAvKiBfVktNU19EUlZf
SF8gKi8KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19vdXRwdXQuYyBi
L2RyaXZlcnMvZ3B1L2RybS92a21zL3ZrbXNfb3V0cHV0LmMKPiBpbmRleCBmYjE5NDFhNjUyMmMu
LjNiMDkzYWU4ZjM3MyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vdmttcy92a21zX291
dHB1dC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc19vdXRwdXQuYwo+IEBAIC04
NCw2ICs4NCwxMiBAQCBpbnQgdmttc19vdXRwdXRfaW5pdChzdHJ1Y3Qgdmttc19kZXZpY2UgKnZr
bXNkZXYsIGludCBpbmRleCkKPiAgCQlnb3RvIGVycl9hdHRhY2g7Cj4gIAl9Cj4gIAo+ICsJaWYg
KGVuYWJsZV93cml0ZWJhY2spIHsKPiArCQlyZXQgPSBlbmFibGVfd3JpdGViYWNrX2Nvbm5lY3Rv
cih2a21zZGV2KTsKPiArCQlpZiAocmV0KQo+ICsJCQlEUk1fRVJST1IoIkZhaWxlZCB0byBpbml0
IHdyaXRlYmFjayBjb25uZWN0b3JcbiIpOwo+ICsJfQo+ICsKPiAgCWRybV9tb2RlX2NvbmZpZ19y
ZXNldChkZXYpOwo+ICAKPiAgCXJldHVybiAwOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vdmttcy92a21zX3dyaXRlYmFjay5jIGIvZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmttc193cml0
ZWJhY2suYwo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0Cj4gaW5kZXggMDAwMDAwMDAwMDAwLi41NjYz
MmViMzkzY2IKPiAtLS0gL2Rldi9udWxsCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3ZrbXMvdmtt
c193cml0ZWJhY2suYwo+IEBAIC0wLDAgKzEsMTY2IEBACj4gKy8vIFNQRFgtTGljZW5zZS1JZGVu
dGlmaWVyOiBHUEwtMi4wKwo+ICsKPiArI2luY2x1ZGUgInZrbXNfZHJ2LmgiCj4gKyNpbmNsdWRl
ICJ2a21zX2NvbXBvc2VyLmgiCj4gKyNpbmNsdWRlIDxkcm0vZHJtX3dyaXRlYmFjay5oPgo+ICsj
aW5jbHVkZSA8ZHJtL2RybV9wcm9iZV9oZWxwZXIuaD4KPiArI2luY2x1ZGUgPGRybS9kcm1fYXRv
bWljX2hlbHBlci5oPgo+ICsjaW5jbHVkZSA8ZHJtL2RybV9nZW1fZnJhbWVidWZmZXJfaGVscGVy
Lmg+Cj4gKwo+ICtzdGF0aWMgY29uc3QgdTMyIHZrbXNfd2JfZm9ybWF0c1tdID0gewo+ICsJRFJN
X0ZPUk1BVF9YUkdCODg4OCwKPiArfTsKPiArCj4gK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Nv
bm5lY3Rvcl9mdW5jcyB2a21zX3diX2Nvbm5lY3Rvcl9mdW5jcyA9IHsKPiArCS5maWxsX21vZGVz
ID0gZHJtX2hlbHBlcl9wcm9iZV9zaW5nbGVfY29ubmVjdG9yX21vZGVzLAo+ICsJLmRlc3Ryb3kg
PSBkcm1fY29ubmVjdG9yX2NsZWFudXAsCj4gKwkucmVzZXQgPSBkcm1fYXRvbWljX2hlbHBlcl9j
b25uZWN0b3JfcmVzZXQsCj4gKwkuYXRvbWljX2R1cGxpY2F0ZV9zdGF0ZSA9IGRybV9hdG9taWNf
aGVscGVyX2Nvbm5lY3Rvcl9kdXBsaWNhdGVfc3RhdGUsCj4gKwkuYXRvbWljX2Rlc3Ryb3lfc3Rh
dGUgPSBkcm1fYXRvbWljX2hlbHBlcl9jb25uZWN0b3JfZGVzdHJveV9zdGF0ZSwKPiArfTsKPiAr
Cj4gK3N0YXRpYyBpbnQgdmttc193Yl9lbmNvZGVyX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX2Vu
Y29kZXIgKmVuY29kZXIsCj4gKwkJCQkJc3RydWN0IGRybV9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
LAo+ICsJCQkJCXN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ICt7Cj4g
KwlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYjsKPiArCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxh
eV9tb2RlICptb2RlID0gJmNydGNfc3RhdGUtPm1vZGU7Cj4gKwo+ICsJaWYgKCFjb25uX3N0YXRl
LT53cml0ZWJhY2tfam9iIHx8ICFjb25uX3N0YXRlLT53cml0ZWJhY2tfam9iLT5mYikKPiArCQly
ZXR1cm4gMDsKPiArCj4gKwlmYiA9IGNvbm5fc3RhdGUtPndyaXRlYmFja19qb2ItPmZiOwo+ICsJ
aWYgKGZiLT53aWR0aCAhPSBtb2RlLT5oZGlzcGxheSB8fCBmYi0+aGVpZ2h0ICE9IG1vZGUtPnZk
aXNwbGF5KSB7Cj4gKwkJRFJNX0RFQlVHX0tNUygiSW52YWxpZCBmcmFtZWJ1ZmZlciBzaXplICV1
eCV1XG4iLAo+ICsJCQkgICAgICBmYi0+d2lkdGgsIGZiLT5oZWlnaHQpOwo+ICsJCXJldHVybiAt
RUlOVkFMOwo+ICsJfQo+ICsKPiArCWlmIChmYi0+Zm9ybWF0LT5mb3JtYXQgIT0gRFJNX0ZPUk1B
VF9YUkdCODg4OCkgewo+ICsJCXN0cnVjdCBkcm1fZm9ybWF0X25hbWVfYnVmIGZvcm1hdF9uYW1l
Owo+ICsKPiArCQlEUk1fREVCVUdfS01TKCJJbnZhbGlkIHBpeGVsIGZvcm1hdCAlc1xuIiwKPiAr
CQkJICAgICAgZHJtX2dldF9mb3JtYXRfbmFtZShmYi0+Zm9ybWF0LT5mb3JtYXQsCj4gKwkJCQkJ
CSAgJmZvcm1hdF9uYW1lKSk7Cj4gKwkJcmV0dXJuIC1FSU5WQUw7Cj4gKwl9Cj4gKwo+ICsJcmV0
dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2VuY29kZXJfaGVscGVy
X2Z1bmNzIHZrbXNfd2JfZW5jb2Rlcl9oZWxwZXJfZnVuY3MgPSB7Cj4gKwkuYXRvbWljX2NoZWNr
ID0gdmttc193Yl9lbmNvZGVyX2F0b21pY19jaGVjaywKPiArfTsKPiArCj4gK3N0YXRpYyBpbnQg
dmttc193Yl9jb25uZWN0b3JfZ2V0X21vZGVzKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0
b3IpCj4gK3sKPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjb25uZWN0b3ItPmRldjsKPiAr
Cj4gKwlyZXR1cm4gZHJtX2FkZF9tb2Rlc19ub2VkaWQoY29ubmVjdG9yLCBkZXYtPm1vZGVfY29u
ZmlnLm1heF93aWR0aCwKPiArCQkJCSAgICBkZXYtPm1vZGVfY29uZmlnLm1heF9oZWlnaHQpOwo+
ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHZrbXNfd2JfcHJlcGFyZV9qb2Ioc3RydWN0IGRybV93cml0
ZWJhY2tfY29ubmVjdG9yICp3Yl9jb25uZWN0b3IsCj4gKwkJCSAgICAgICBzdHJ1Y3QgZHJtX3dy
aXRlYmFja19qb2IgKmpvYikKPiArewo+ICsJc3RydWN0IHZrbXNfZ2VtX29iamVjdCAqdmttc19v
Ymo7Cj4gKwlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdlbV9vYmo7Cj4gKwlpbnQgcmV0Owo+ICsK
PiArCWlmICgham9iLT5mYikKPiArCQlyZXR1cm4gMDsKPiArCj4gKwlnZW1fb2JqID0gZHJtX2dl
bV9mYl9nZXRfb2JqKGpvYi0+ZmIsIDApOwo+ICsJcmV0ID0gdmttc19nZW1fdm1hcChnZW1fb2Jq
KTsKPiArCWlmIChyZXQpIHsKPiArCQlEUk1fRVJST1IoInZtYXAgZmFpbGVkOiAlZFxuIiwgcmV0
KTsKPiArCQlyZXR1cm4gcmV0Owo+ICsJfQo+ICsKPiArCXZrbXNfb2JqID0gZHJtX2dlbV90b192
a21zX2dlbShnZW1fb2JqKTsKPiArCWpvYi0+cHJpdiA9IHZrbXNfb2JqLT52YWRkcjsKPiArCj4g
KwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgdmttc193Yl9jbGVhbnVwX2pvYihz
dHJ1Y3QgZHJtX3dyaXRlYmFja19jb25uZWN0b3IgKmNvbm5lY3RvciwKPiArCQkJCXN0cnVjdCBk
cm1fd3JpdGViYWNrX2pvYiAqam9iKQo+ICt7Cj4gKwlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdl
bV9vYmo7Cj4gKwo+ICsJaWYgKCFqb2ItPmZiKQo+ICsJCXJldHVybjsKPiArCj4gKwlnZW1fb2Jq
ID0gZHJtX2dlbV9mYl9nZXRfb2JqKGpvYi0+ZmIsIDApOwo+ICsJdmttc19nZW1fdnVubWFwKGdl
bV9vYmopOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCB2a21zX3diX2F0b21pY19jb21taXQoc3Ry
dWN0IGRybV9jb25uZWN0b3IgKmNvbm4sCj4gKwkJCQkgIHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0
YXRlICpzdGF0ZSkKPiArewo+ICsJc3RydWN0IHZrbXNfZGV2aWNlICp2a21zZGV2ID0gZHJtX2Rl
dmljZV90b192a21zX2RldmljZShjb25uLT5kZXYpOwo+ICsJc3RydWN0IHZrbXNfb3V0cHV0ICpv
dXRwdXQgPSAmdmttc2Rldi0+b3V0cHV0Owo+ICsJc3RydWN0IHZrbXNfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSA9IG91dHB1dC0+Y3JjX3N0YXRlOwo+ICsJc3RydWN0IGRybV93cml0ZWJhY2tfY29u
bmVjdG9yICp3Yl9jb25uID0gJm91dHB1dC0+d2JfY29ubmVjdG9yOwo+ICsJc3RydWN0IGRybV9j
b25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUgPSB3Yl9jb25uLT5iYXNlLnN0YXRlOwo+ICsJdm9p
ZCAqcHJpdl9kYXRhID0gY29ubl9zdGF0ZS0+d3JpdGViYWNrX2pvYi0+cHJpdjsKPiArCXN0cnVj
dCB2a21zX2RhdGEgKnByaW1hcnlfZGF0YSA9IE5VTEw7Cj4gKwlzdHJ1Y3Qgdmttc19kYXRhICpj
dXJzb3JfZGF0YSA9IE5VTEw7Cj4gKwlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IE5VTEw7
Cj4gKwlzdHJ1Y3Qgdmttc19nZW1fb2JqZWN0ICp2a21zX29iajsKPiArCXN0cnVjdCBkcm1fZ2Vt
X29iamVjdCAqZ2VtX29iajsKPiArCj4gKwlpZiAoIWNvbm5fc3RhdGUpCj4gKwkJcmV0dXJuOwo+
ICsKPiArCWlmICghY29ubl9zdGF0ZS0+d3JpdGViYWNrX2pvYiB8fCAhY29ubl9zdGF0ZS0+d3Jp
dGViYWNrX2pvYi0+ZmIpIHsKPiArCQlEUk1fREVCVUdfRFJJVkVSKCJEaXNhYmxlIHdyaXRlYmFj
a1xuIik7Cj4gKwkJcmV0dXJuOwo+ICsJfQo+ICsKPiArCWlmIChjcnRjX3N0YXRlLT5udW1fYWN0
aXZlX3BsYW5lcyA+PSAxKQo+ICsJCXByaW1hcnlfZGF0YSA9IGNydGNfc3RhdGUtPmFjdGl2ZV9w
bGFuZXNbMF0tPmRhdGE7Cj4gKwo+ICsJaWYgKGNydGNfc3RhdGUtPm51bV9hY3RpdmVfcGxhbmVz
ID09IDIpCj4gKwkJY3Vyc29yX2RhdGEgPSBjcnRjX3N0YXRlLT5hY3RpdmVfcGxhbmVzWzFdLT5k
YXRhOwo+ICsKPiArCWlmICghcHJpbWFyeV9kYXRhKQo+ICsJCXJldHVybjsKPiArCj4gKwlmYiA9
ICZwcmltYXJ5X2RhdGEtPmZiOwo+ICsJZ2VtX29iaiA9IGRybV9nZW1fZmJfZ2V0X29iaihmYiwg
MCk7Cj4gKwl2a21zX29iaiA9IGRybV9nZW1fdG9fdmttc19nZW0oZ2VtX29iaik7Cj4gKwo+ICsJ
aWYgKCF2a21zX29iai0+dmFkZHIgfHwgIXByaXZfZGF0YSkKPiArCQlyZXR1cm47Cj4gKwo+ICsJ
ZHJtX3dyaXRlYmFja19xdWV1ZV9qb2Iod2JfY29ubiwgc3RhdGUpOwo+ICsKPiArCW1lbWNweShw
cml2X2RhdGEsIHZrbXNfb2JqLT52YWRkciwgdmttc19vYmotPmdlbS5zaXplKTsKPiArCWlmIChj
dXJzb3JfZGF0YSkKPiArCQljb21wb3NlX2N1cnNvcihjdXJzb3JfZGF0YSwgcHJpbWFyeV9kYXRh
LCBwcml2X2RhdGEpOwo+ICsKPiArCWRybV93cml0ZWJhY2tfc2lnbmFsX2NvbXBsZXRpb24od2Jf
Y29ubiwgMCk7Cj4gK30KPiArCj4gK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9o
ZWxwZXJfZnVuY3Mgdmttc193Yl9jb25uX2hlbHBlcl9mdW5jcyA9IHsKPiArCS5nZXRfbW9kZXMg
PSB2a21zX3diX2Nvbm5lY3Rvcl9nZXRfbW9kZXMsCj4gKwkucHJlcGFyZV93cml0ZWJhY2tfam9i
ID0gdmttc193Yl9wcmVwYXJlX2pvYiwKPiArCS5jbGVhbnVwX3dyaXRlYmFja19qb2IgPSB2a21z
X3diX2NsZWFudXBfam9iLAo+ICsJLmF0b21pY19jb21taXQgPSB2a21zX3diX2F0b21pY19jb21t
aXQsCj4gK307Cj4gKwo+ICtpbnQgZW5hYmxlX3dyaXRlYmFja19jb25uZWN0b3Ioc3RydWN0IHZr
bXNfZGV2aWNlICp2a21zZGV2KQo+ICt7Cj4gKwlzdHJ1Y3QgZHJtX3dyaXRlYmFja19jb25uZWN0
b3IgKndiID0gJnZrbXNkZXYtPm91dHB1dC53Yl9jb25uZWN0b3I7Cj4gKwo+ICsJdmttc2Rldi0+
b3V0cHV0LndiX2Nvbm5lY3Rvci5lbmNvZGVyLnBvc3NpYmxlX2NydGNzID0gMTsKPiArCWRybV9j
b25uZWN0b3JfaGVscGVyX2FkZCgmd2ItPmJhc2UsICZ2a21zX3diX2Nvbm5faGVscGVyX2Z1bmNz
KTsKPiArCj4gKwlyZXR1cm4gZHJtX3dyaXRlYmFja19jb25uZWN0b3JfaW5pdCgmdmttc2Rldi0+
ZHJtLCB3YiwKPiArCQkJCQkgICAgJnZrbXNfd2JfY29ubmVjdG9yX2Z1bmNzLAo+ICsJCQkJCSAg
ICAmdmttc193Yl9lbmNvZGVyX2hlbHBlcl9mdW5jcywKPiArCQkJCQkgICAgdmttc193Yl9mb3Jt
YXRzLAo+ICsJCQkJCSAgICBBUlJBWV9TSVpFKHZrbXNfd2JfZm9ybWF0cykpOwo+ICt9Cj4gKwo+
IC0tIAo+IDIuMjEuMAoKLS0gCkRhbmllbCBWZXR0ZXIKU29mdHdhcmUgRW5naW5lZXIsIEludGVs
IENvcnBvcmF0aW9uCmh0dHA6Ly9ibG9nLmZmd2xsLmNoCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVs
QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWls
bWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
