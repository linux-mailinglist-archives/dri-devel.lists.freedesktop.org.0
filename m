Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id BE22142A21
	for <lists+dri-devel@lfdr.de>; Wed, 12 Jun 2019 17:00:27 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7B65E8968D;
	Wed, 12 Jun 2019 15:00:25 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x541.google.com (mail-ed1-x541.google.com
 [IPv6:2a00:1450:4864:20::541])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 67CAF89690
 for <dri-devel@lists.freedesktop.org>; Wed, 12 Jun 2019 15:00:24 +0000 (UTC)
Received: by mail-ed1-x541.google.com with SMTP id m10so26238814edv.6
 for <dri-devel@lists.freedesktop.org>; Wed, 12 Jun 2019 08:00:24 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:sender:date:from:to:cc:subject:message-id
 :references:mime-version:content-disposition:in-reply-to:user-agent;
 bh=m5rGTA3Kx1eANv3bS0z+hqMu4BATVT5bDMg5yv+uU18=;
 b=l65AGFoVPAWpfeLXuIBktmEwpN5JUFszS4Q7CyuoP6LaNCDg2JHB3huaswzywqLWaG
 8KcjYURYX44YxVz3m79s+UxSSk40Jz1GcnbrkqInR1paJTu2Cucgr4S3fEKy7AJh3wSu
 G0WKn0uwSgRq8oXJ27Nvez+QGjOEjErAvNOCAb3jweBo6oN7BtyY9dJ3rmTdMgrc0vZy
 2OG1SCtBU3BqoiTMgRzk9aX4bbMfrUfCUES/fjqrVwx7DNfS6eWCQiX/Ki58O2NsXicB
 O991qWLpMnUBWvlS+Lk/FVBEMNzE0okDmmMkv93Yx4E3lHBWEB88s0LIKZO2qZdTp/jK
 HwCw==
X-Gm-Message-State: APjAAAX6IkhBdwSPdpZzn8cn6vqKqHCNikk4A5CVItC7h4QUSU66eMCU
 5USzvxZoiRzZ0L35Q0qrqFBNpg==
X-Google-Smtp-Source: APXvYqy3BHELFs7XTuEr26ZSBqPIJgMD9RFHAarIlIV9nX1fkVwyJ4Z6rUBpVUG+HQ5y8fPjmta/4w==
X-Received: by 2002:a17:906:6013:: with SMTP id
 o19mr31073055ejj.294.1560351622808; 
 Wed, 12 Jun 2019 08:00:22 -0700 (PDT)
Received: from phenom.ffwll.local ([2a02:168:569e:0:3106:d637:d723:e855])
 by smtp.gmail.com with ESMTPSA id s16sm26271eji.27.2019.06.12.08.00.21
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Wed, 12 Jun 2019 08:00:21 -0700 (PDT)
Date: Wed, 12 Jun 2019 17:00:19 +0200
From: Daniel Vetter <daniel@ffwll.ch>
To: Tomeu Vizoso <tomeu@tomeuvizoso.net>
Subject: Re: [RFC PATCH] drm/panfrost: Add support for mapping BOs on GPU
 page faults
Message-ID: <20190612150019.GR2458@phenom.ffwll.local>
References: <20190610170440.28525-1-robh@kernel.org>
 <CAAObsKAvmtHSja+-XW5aWHiBNiKdanjN1OHKZTpx1O9v__E_Dw@mail.gmail.com>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <CAAObsKAvmtHSja+-XW5aWHiBNiKdanjN1OHKZTpx1O9v__E_Dw@mail.gmail.com>
X-Operating-System: Linux phenom 4.14.0-3-amd64 
User-Agent: Mutt/1.10.1 (2018-07-13)
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ffwll.ch; s=google;
 h=sender:date:from:to:cc:subject:message-id:references:mime-version
 :content-disposition:in-reply-to:user-agent;
 bh=m5rGTA3Kx1eANv3bS0z+hqMu4BATVT5bDMg5yv+uU18=;
 b=TjGmFsk3zg985oParPIqU9DNApYKutAFlwZz7S4L2eaRzw2BKazlfgNzv9V9ixY6pQ
 bMMhMsOdQ9qx0qzX9/sHitAf3+fr1npoQQRhw9VMGx4pgEOkPikue5YPFPMlVRnRL+mM
 vROxrNJcM8uh3KCm/ud37sJ0ty+RflpRno0mw=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: dri-devel <dri-devel@lists.freedesktop.org>,
 Steven Price <steven.price@arm.com>,
 Boris Brezillon <boris.brezillon@collabora.com>,
 Robin Murphy <robin.murphy@arm.com>, Alyssa Rosenzweig <alyssa@rosenzweig.io>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gV2VkLCBKdW4gMTIsIDIwMTkgYXQgMDI6NTQ6NTZQTSArMDIwMCwgVG9tZXUgVml6b3NvIHdy
b3RlOgo+IE9uIE1vbiwgMTAgSnVuIDIwMTkgYXQgMTk6MDYsIFJvYiBIZXJyaW5nIDxyb2JoQGtl
cm5lbC5vcmc+IHdyb3RlOgo+ID4KPiA+IFRoZSBtaWRnYXJkL2JpZnJvc3QgR1BVcyBuZWVkIHRv
IGFsbG9jYXRlIEdQVSBtZW1vcnkgd2hpY2ggaXMgYWxsb2NhdGVkCj4gPiBvbiBHUFUgcGFnZSBm
YXVsdHMgYW5kIG5vdCBwaW5uZWQgaW4gbWVtb3J5LiBUaGUgdmVuZG9yIGRyaXZlciBjYWxscwo+
ID4gdGhpcyBmdW5jdGlvbmFsaXR5IEdST1dfT05fR1BGLgo+ID4KPiA+IFRoaXMgaW1wbGVtZW50
YXRpb24gYXNzdW1lcyB0aGF0IEJPcyBhbGxvY2F0ZWQgd2l0aCB0aGUKPiA+IFBBTkZST1NUX0JP
X05PTUFQIGZsYWcgYXJlIG5ldmVyIG1tYXBwZWQgb3IgZXhwb3J0ZWQuIEJvdGggb2YgdGhvc2Ug
bWF5Cj4gPiBhY3R1YWxseSB3b3JrLCBidXQgSSdtIHVuc3VyZSBpZiB0aGVyZSdzIHNvbWUgaW50
ZXJhY3Rpb24gdGhlcmUuIEl0Cj4gPiB3b3VsZCBjYXVzZSB0aGUgd2hvbGUgb2JqZWN0IHRvIGJl
IHBpbm5lZCBpbiBtZW1vcnkgd2hpY2ggd291bGQgZGVmZWF0Cj4gPiB0aGUgcG9pbnQgb2YgdGhp
cy4KPiA+Cj4gPiBJc3N1ZXMvcXVlc3Rpb25zL3Rob3VnaHRzOgo+ID4KPiA+IFdoYXQncyB0aGUg
ZGlmZmVyZW5jZSBiZXR3ZWVuIGlfbWFwcGluZyBhbmQgZl9tYXBwaW5nPwo+ID4KPiA+IFdoYXQg
a2luZCBvZiBjbGVhbi11cCBvbiBjbG9zZSBpcyBuZWVkZWQ/IEJhc2VkIG9uIHZnZW0gZmF1bHRz
LCB0aGVyZQo+ID4gZG9lc24ndCBzZWVtIHRvIGJlIGFueSByZWZjb3VudGluZy4gQXNzdW1lIHVz
ZXJzcGFjZSBpcyByZXNwb25zaWJsZSBmb3IKPiA+IG5vdCBmcmVlaW5nIHRoZSBCTyB3aGlsZSBh
IHBhZ2UgZmF1bHQgY2FuIG9jY3VyPwoKVGhpcyByZWFsbHkgc2hvdWxkbid0IGV2ZXIgYmUgcG9z
c2libGUsICJyZWx5IG9uIHVzZXJzcGFjZSB0byBub3Qgb29wcyB0aGUKa2VybmVsIiBpcyBob3cg
ZHJpMSB3b3JrZWQgOi0pCj4gCj4gQXJlbid0IHdlIHRha2luZyBhIHJlZmVyZW5jZSBvbiBhbGwg
Qk9zIHRoYXQgYSBqb2IgcmVsYXRlcyB0byBhbmQKPiB1bnJlZmVyZW5jaW5nIHRoZW0gb25jZSB0
aGUgam9iIGlzIGRvbmU/IEkgd291bGQgdGhpbmsgdGhhdCB0aGF0J3MKPiBlbm91Z2gsIG9yIGFt
IEkgbWlzc2luZyBzb21ldGhpbmc/CgpZdXAsIHRoaXMgaXMgaG93IHRoaXMgaXMgc3VwcG9zZWQg
dG8gd29yay4KLURhbmllbAoKPiAKPiA+IFdoYXQgYWJvdXQgZXZpY3Rpb25zPyBOZWVkIHRvIGNh
bGwgbWFwcGluZ19zZXRfdW5ldmljdGFibGUoKT8gTWF5YmUgd2UKPiA+IHdhbnQgdGhlc2UgcGFn
ZXMgdG8gYmUgc3dhcHBhYmxlLCBidXQgdGhlbiB3ZSBuZWVkIHNvbWUgbm90aWZpY2F0aW9uIHRv
Cj4gPiB1bm1hcCB0aGVtLgo+IAo+IEknbSBub3Qgc3VyZSB0aGVyZSdzIG11Y2ggcG9pbnQgaW4g
c3dhcHBpbmcgb3V0IHBhZ2VzIHdpdGggbGlmZXRpbWVzCj4gb2YgYSBmZXcgbWlsbGlzZWNvbmRz
Lgo+IAo+ID4gTm8gbmVlZCBmb3IgcnVudGltZSBQTSwgYmVjYXVzZSBmYXVsdHMgc2hvdWxkIG9u
bHkgb2NjdXIgZHVyaW5nIGpvYgo+ID4gc3VibWl0Pwo+IAo+IE1ha2VzIHNlbnNlIHRvIG1lLgo+
IAo+ID4gTmVlZCB0byBmYXVsdCBpbiAyTUIgc2VjdGlvbnMgd2hlbiBwb3NzaWJsZS4gSXQgc2Vl
bXMgdGhpcyBoYXMgdG8gYmUKPiA+IGRvbmUgYnkgZ2V0dGluZyBhbiBhcnJheSBvZiBzdHJ1Y3Qg
cGFnZXMgYW5kIHRoZW4gY29udmVydGluZyB0byBhCj4gPiBzY2F0dGVybGlzdC4gTm90IHN1cmUg
aWYgdGhlcmUgaXMgYSBiZXR0ZXIgd2F5IHRvIGRvIHRoYXQuIFRoZXJlJ3MgYWxzbwo+ID4gc29t
ZSBlcnJhdGEgb24gVDYwNCBuZWVkaW5nIHRvIGZhdWx0IGluIGF0IGxlYXN0IDggcGFnZXMgYXQg
YSB0aW1lIHdoaWNoCj4gPiBpc24ndCBoYW5kbGVkLgo+IAo+IFRoZSBvbGQgR1BVcyB3aWxsIGJl
IHRoZSBtb3N0IGludGVyZXN0aW5nIHRvIHN1cHBvcnQuLi4KPiAKPiBXaWxsIGdpdmUgdGhpcyBw
YXRjaCBzb21lIHRlc3RpbmcgdG9tb3Jyb3cuCj4gCj4gVGhhbmtzLAo+IAo+IFRvbWV1Cj4gCj4g
PiBDYzogUm9iaW4gTXVycGh5IDxyb2Jpbi5tdXJwaHlAYXJtLmNvbT4KPiA+IENjOiBTdGV2ZW4g
UHJpY2UgPHN0ZXZlbi5wcmljZUBhcm0uY29tPgo+ID4gQ2M6IEFseXNzYSBSb3Nlbnp3ZWlnIDxh
bHlzc2FAcm9zZW56d2VpZy5pbz4KPiA+IENjOiBUb21ldSBWaXpvc28gPHRvbWV1QHRvbWV1dml6
b3NvLm5ldD4KPiA+IFNpZ25lZC1vZmYtYnk6IFJvYiBIZXJyaW5nIDxyb2JoQGtlcm5lbC5vcmc+
Cj4gPiAtLS0KPiA+Cj4gPiAgZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L1RPRE8gICAgICAgICAg
IHwgIDIgLQo+ID4gIGRyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9kcnYuYyB8IDIy
ICsrKysrLS0KPiA+ICBkcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZ2VtLmMgfCAg
MyArLQo+ID4gIGRyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9nZW0uaCB8ICA4ICsr
Kwo+ID4gIGRyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9tbXUuYyB8IDc2ICsrKysr
KysrKysrKysrKysrKysrKysrLS0KPiA+ICBpbmNsdWRlL3VhcGkvZHJtL3BhbmZyb3N0X2RybS5o
ICAgICAgICAgfCAgMiArCj4gPiAgNiBmaWxlcyBjaGFuZ2VkLCAxMDAgaW5zZXJ0aW9ucygrKSwg
MTMgZGVsZXRpb25zKC0pCj4gPgo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9wYW5m
cm9zdC9UT0RPIGIvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L1RPRE8KPiA+IGluZGV4IGMyZTQ0
YWRkMzdkOC4uNjQxMjliZjczOTMzIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Bh
bmZyb3N0L1RPRE8KPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9UT0RPCj4gPiBA
QCAtMTQsOCArMTQsNiBAQAo+ID4gICAgVGhlIGhhcmQgcGFydCBpcyBoYW5kbGluZyB3aGVuIG1v
cmUgYWRkcmVzcyBzcGFjZXMgYXJlIG5lZWRlZCB0aGFuIHdoYXQKPiA+ICAgIHRoZSBoL3cgcHJv
dmlkZXMuCj4gPgo+ID4gLS0gU3VwcG9ydCBwaW5uaW5nIHBhZ2VzIG9uIGRlbWFuZCAoR1BVIHBh
Z2UgZmF1bHRzKS4KPiA+IC0KPiA+ICAtIFN1cHBvcnQgdXNlcnNwYWNlIGNvbnRyb2xsZWQgR1BV
IHZpcnR1YWwgYWRkcmVzc2VzLiBOZWVkZWQgZm9yIFZ1bGthbi4gKFRvbWV1KQo+ID4KPiA+ICAt
IFN1cHBvcnQgZm9yIG1hZHZpc2UgYW5kIGEgc2hyaW5rZXIuCj4gPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2Rydi5jIGIvZHJpdmVycy9ncHUvZHJtL3Bh
bmZyb3N0L3BhbmZyb3N0X2Rydi5jCj4gPiBpbmRleCBkMTFlMjI4MWRkZTYuLmYwOGQ0MWQ1MTg2
YSAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9kcnYu
Ywo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2Rydi5jCj4gPiBA
QCAtNDQsOSArNDQsMTEgQEAgc3RhdGljIGludCBwYW5mcm9zdF9pb2N0bF9jcmVhdGVfYm8oc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKPiA+ICB7Cj4gPiAgICAgICAgIGludCBy
ZXQ7Cj4gPiAgICAgICAgIHN0cnVjdCBkcm1fZ2VtX3NobWVtX29iamVjdCAqc2htZW07Cj4gPiAr
ICAgICAgIHN0cnVjdCBwYW5mcm9zdF9nZW1fb2JqZWN0ICpibzsKPiA+ICAgICAgICAgc3RydWN0
IGRybV9wYW5mcm9zdF9jcmVhdGVfYm8gKmFyZ3MgPSBkYXRhOwo+ID4KPiA+IC0gICAgICAgaWYg
KCFhcmdzLT5zaXplIHx8IGFyZ3MtPmZsYWdzIHx8IGFyZ3MtPnBhZCkKPiA+ICsgICAgICAgaWYg
KCFhcmdzLT5zaXplIHx8IGFyZ3MtPnBhZCB8fAo+ID4gKyAgICAgICAgICAgKGFyZ3MtPmZsYWdz
ICYgflBBTkZST1NUX0JPX05PTUFQKSkKPiA+ICAgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZB
TDsKPiA+Cj4gPiAgICAgICAgIHNobWVtID0gZHJtX2dlbV9zaG1lbV9jcmVhdGVfd2l0aF9oYW5k
bGUoZmlsZSwgZGV2LCBhcmdzLT5zaXplLAo+ID4gQEAgLTU0LDExICs1NiwxNiBAQCBzdGF0aWMg
aW50IHBhbmZyb3N0X2lvY3RsX2NyZWF0ZV9ibyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lk
ICpkYXRhLAo+ID4gICAgICAgICBpZiAoSVNfRVJSKHNobWVtKSkKPiA+ICAgICAgICAgICAgICAg
ICByZXR1cm4gUFRSX0VSUihzaG1lbSk7Cj4gPgo+ID4gLSAgICAgICByZXQgPSBwYW5mcm9zdF9t
bXVfbWFwKHRvX3BhbmZyb3N0X2JvKCZzaG1lbS0+YmFzZSkpOwo+ID4gLSAgICAgICBpZiAocmV0
KQo+ID4gLSAgICAgICAgICAgICAgIGdvdG8gZXJyX2ZyZWU7Cj4gPiArICAgICAgIGJvID0gdG9f
cGFuZnJvc3RfYm8oJnNobWVtLT5iYXNlKTsKPiA+Cj4gPiAtICAgICAgIGFyZ3MtPm9mZnNldCA9
IHRvX3BhbmZyb3N0X2JvKCZzaG1lbS0+YmFzZSktPm5vZGUuc3RhcnQgPDwgUEFHRV9TSElGVDsK
PiA+ICsgICAgICAgaWYgKCEoYXJncy0+ZmxhZ3MgJiBQQU5GUk9TVF9CT19OT01BUCkpIHsKPiA+
ICsgICAgICAgICAgICAgICByZXQgPSBwYW5mcm9zdF9tbXVfbWFwKGJvKTsKPiA+ICsgICAgICAg
ICAgICAgICBpZiAocmV0KQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgZ290byBlcnJfZnJl
ZTsKPiA+ICsgICAgICAgfSBlbHNlCj4gPiArICAgICAgICAgICAgICAgYm8tPm5vX21hcCA9IDE7
Cj4gPiArCj4gPiArICAgICAgIGFyZ3MtPm9mZnNldCA9IGJvLT5ub2RlLnN0YXJ0IDw8IFBBR0Vf
U0hJRlQ7Cj4gPgo+ID4gICAgICAgICByZXR1cm4gMDsKPiA+Cj4gPiBAQCAtMjY5LDYgKzI3Niwx
MSBAQCBzdGF0aWMgaW50IHBhbmZyb3N0X2lvY3RsX21tYXBfYm8oc3RydWN0IGRybV9kZXZpY2Ug
KmRldiwgdm9pZCAqZGF0YSwKPiA+ICAgICAgICAgICAgICAgICByZXR1cm4gLUVOT0VOVDsKPiA+
ICAgICAgICAgfQo+ID4KPiA+ICsgICAgICAgaWYgKHRvX3BhbmZyb3N0X2JvKGdlbV9vYmopLT5u
b19tYXApIHsKPiA+ICsgICAgICAgICAgICAgICBEUk1fREVCVUcoIkNhbid0IG1tYXAgJ25vX21h
cCcgR0VNIEJPICVkXG4iLCBhcmdzLT5oYW5kbGUpOwo+ID4gKyAgICAgICAgICAgICAgIHJldHVy
biAtRUlOVkFMOwo+ID4gKyAgICAgICB9Cj4gPiArCj4gPiAgICAgICAgIHJldCA9IGRybV9nZW1f
Y3JlYXRlX21tYXBfb2Zmc2V0KGdlbV9vYmopOwo+ID4gICAgICAgICBpZiAocmV0ID09IDApCj4g
PiAgICAgICAgICAgICAgICAgYXJncy0+b2Zmc2V0ID0gZHJtX3ZtYV9ub2RlX29mZnNldF9hZGRy
KCZnZW1fb2JqLT52bWFfbm9kZSk7Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Bh
bmZyb3N0L3BhbmZyb3N0X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0
X2dlbS5jCj4gPiBpbmRleCA4ODY4NzVhZTMxZDMuLmVkMGI0Zjc5NjEwYSAxMDA2NDQKPiA+IC0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9nZW0uYwo+ID4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2dlbS5jCj4gPiBAQCAtMTksNyArMTksOCBA
QCBzdGF0aWMgdm9pZCBwYW5mcm9zdF9nZW1fZnJlZV9vYmplY3Qoc3RydWN0IGRybV9nZW1fb2Jq
ZWN0ICpvYmopCj4gPiAgICAgICAgIHN0cnVjdCBwYW5mcm9zdF9nZW1fb2JqZWN0ICpibyA9IHRv
X3BhbmZyb3N0X2JvKG9iaik7Cj4gPiAgICAgICAgIHN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBm
ZGV2ID0gb2JqLT5kZXYtPmRldl9wcml2YXRlOwo+ID4KPiA+IC0gICAgICAgcGFuZnJvc3RfbW11
X3VubWFwKGJvKTsKPiA+ICsgICAgICAgaWYgKCFiby0+bm9fbWFwKQo+ID4gKyAgICAgICAgICAg
ICAgIHBhbmZyb3N0X21tdV91bm1hcChibyk7Cj4gPgo+ID4gICAgICAgICBzcGluX2xvY2soJnBm
ZGV2LT5tbV9sb2NrKTsKPiA+ICAgICAgICAgZHJtX21tX3JlbW92ZV9ub2RlKCZiby0+bm9kZSk7
Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2dlbS5o
IGIvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2dlbS5oCj4gPiBpbmRleCAwNDUw
MDBlYjVmY2YuLmFhMjEwZDdjYmYzZiAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9w
YW5mcm9zdC9wYW5mcm9zdF9nZW0uaAo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0
L3BhbmZyb3N0X2dlbS5oCj4gPiBAQCAtMTEsNiArMTEsNyBAQCBzdHJ1Y3QgcGFuZnJvc3RfZ2Vt
X29iamVjdCB7Cj4gPiAgICAgICAgIHN0cnVjdCBkcm1fZ2VtX3NobWVtX29iamVjdCBiYXNlOwo+
ID4KPiA+ICAgICAgICAgc3RydWN0IGRybV9tbV9ub2RlIG5vZGU7Cj4gPiArICAgICAgIHVuc2ln
bmVkIG5vX21hcDogMTsKPiA+ICB9Owo+ID4KPiA+ICBzdGF0aWMgaW5saW5lCj4gPiBAQCAtMTks
NiArMjAsMTMgQEAgc3RydWN0ICBwYW5mcm9zdF9nZW1fb2JqZWN0ICp0b19wYW5mcm9zdF9ibyhz
dHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iaikKPiA+ICAgICAgICAgcmV0dXJuIGNvbnRhaW5lcl9v
Zih0b19kcm1fZ2VtX3NobWVtX29iaihvYmopLCBzdHJ1Y3QgcGFuZnJvc3RfZ2VtX29iamVjdCwg
YmFzZSk7Cj4gPiAgfQo+ID4KPiA+ICtzdGF0aWMgaW5saW5lCj4gPiArc3RydWN0ICBwYW5mcm9z
dF9nZW1fb2JqZWN0ICpkcm1fbW1fbm9kZV90b19wYW5mcm9zdF9ibyhzdHJ1Y3QgZHJtX21tX25v
ZGUgKm5vZGUpCj4gPiArewo+ID4gKyAgICAgICByZXR1cm4gY29udGFpbmVyX29mKG5vZGUsIHN0
cnVjdCBwYW5mcm9zdF9nZW1fb2JqZWN0LCBub2RlKTsKPiA+ICt9Cj4gPiArCj4gPiArCj4gPiAg
c3RydWN0IGRybV9nZW1fb2JqZWN0ICpwYW5mcm9zdF9nZW1fY3JlYXRlX29iamVjdChzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2LCBzaXplX3Qgc2l6ZSk7Cj4gPgo+ID4gIHN0cnVjdCBkcm1fZ2VtX29i
amVjdCAqCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0
X21tdS5jIGIvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X21tdS5jCj4gPiBpbmRl
eCA0MWQxODRmYWIwN2YuLjVhMzY0OTVhMzhmMyAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9tbXUuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3Bh
bmZyb3N0L3BhbmZyb3N0X21tdS5jCj4gPiBAQCAtMyw2ICszLDcgQEAKPiA+ICAvKiBDb3B5cmln
aHQgKEMpIDIwMTkgQXJtIEx0ZC4gKi8KPiA+ICAjaW5jbHVkZSA8bGludXgvYml0ZmllbGQuaD4K
PiA+ICAjaW5jbHVkZSA8bGludXgvZGVsYXkuaD4KPiA+ICsjaW5jbHVkZSA8bGludXgvZG1hLW1h
cHBpbmcuaD4KPiA+ICAjaW5jbHVkZSA8bGludXgvaW50ZXJydXB0Lmg+Cj4gPiAgI2luY2x1ZGUg
PGxpbnV4L2lvLmg+Cj4gPiAgI2luY2x1ZGUgPGxpbnV4L2lvcG9sbC5oPgo+ID4gQEAgLTEwLDYg
KzExLDcgQEAKPiA+ICAjaW5jbHVkZSA8bGludXgvaW9tbXUuaD4KPiA+ICAjaW5jbHVkZSA8bGlu
dXgvcGxhdGZvcm1fZGV2aWNlLmg+Cj4gPiAgI2luY2x1ZGUgPGxpbnV4L3BtX3J1bnRpbWUuaD4K
PiA+ICsjaW5jbHVkZSA8bGludXgvc2htZW1fZnMuaD4KPiA+ICAjaW5jbHVkZSA8bGludXgvc2l6
ZXMuaD4KPiA+Cj4gPiAgI2luY2x1ZGUgInBhbmZyb3N0X2RldmljZS5oIgo+ID4gQEAgLTI3Nyw2
ICsyNzksNjAgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBpb21tdV9nYXRoZXJfb3BzIG1tdV90bGJf
b3BzID0gewo+ID4gICAgICAgICAudGxiX3N5bmMgICAgICAgPSBtbXVfdGxiX3N5bmNfY29udGV4
dCwKPiA+ICB9Owo+ID4KPiA+ICtzdGF0aWMgc3RydWN0IGRybV9tbV9ub2RlICphZGRyX3RvX2Ry
bV9tbV9ub2RlKHN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2LCBpbnQgYXMsIHU2NCBhZGRy
KQo+ID4gK3sKPiA+ICsgICAgICAgc3RydWN0IGRybV9tbV9ub2RlICpub2RlOwo+ID4gKyAgICAg
ICB1NjQgb2Zmc2V0ID0gYWRkciA+PiBQQUdFX1NISUZUOwo+ID4gKwo+ID4gKyAgICAgICBkcm1f
bW1fZm9yX2VhY2hfbm9kZShub2RlLCAmcGZkZXYtPm1tKSB7Cj4gPiArICAgICAgICAgICAgICAg
aWYgKG9mZnNldCA+PSBub2RlLT5zdGFydCAmJiBvZmZzZXQgPCAobm9kZS0+c3RhcnQgKyBub2Rl
LT5zaXplKSkKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBub2RlOwo+ID4gKyAg
ICAgICB9Cj4gPiArICAgICAgIHJldHVybiBOVUxMOwo+ID4gK30KPiA+ICsKPiA+ICtpbnQgcGFu
ZnJvc3RfbW11X21hcF9mYXVsdF9hZGRyKHN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2LCBp
bnQgYXMsIHU2NCBhZGRyKQo+ID4gK3sKPiA+ICsgICAgICAgc3RydWN0IHBhZ2UgKnBhZ2U7Cj4g
PiArICAgICAgIGRtYV9hZGRyX3QgZG1hX2FkZHI7Cj4gPiArICAgICAgIHN0cnVjdCBkcm1fbW1f
bm9kZSAqbm9kZTsKPiA+ICsgICAgICAgc3RydWN0IHBhbmZyb3N0X2dlbV9vYmplY3QgKmJvOwo+
ID4gKyAgICAgICBzdHJ1Y3QgaW9fcGd0YWJsZV9vcHMgKm9wcyA9IHBmZGV2LT5tbXUtPnBndGJs
X29wczsKPiA+ICsgICAgICAgcGdvZmZfdCBwYWdlX29mZnNldCA9IGFkZHIgPj4gUEFHRV9TSElG
VDsKPiA+ICsKPiA+ICsgICAgICAgYWRkciAmPSBQQUdFX01BU0s7Cj4gPiArCj4gPiArICAgICAg
IG5vZGUgPSBhZGRyX3RvX2RybV9tbV9ub2RlKHBmZGV2LCBhcywgYWRkcik7Cj4gPiArICAgICAg
IGlmICghbm9kZSkKPiA+ICsgICAgICAgICAgICAgICByZXR1cm4gLUVOT0VOVDsKPiA+ICsKPiA+
ICsgICAgICAgcGFnZV9vZmZzZXQgLT0gbm9kZS0+c3RhcnQ7Cj4gPiArICAgICAgIGJvID0gZHJt
X21tX25vZGVfdG9fcGFuZnJvc3RfYm8obm9kZSk7Cj4gPiArICAgICAgIGlmIChXQVJOX09OKCFi
by0+bm9fbWFwKSkKPiA+ICsgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKPiA+ICsKPiA+
ICsgICAgICAgZGV2X2luZm8ocGZkZXYtPmRldiwgIm1hcHBpbmcgcGFnZSBmYXVsdCBAICVsbHgi
LCBhZGRyKTsKPiA+ICsKPiA+ICsgICAgICAgcGFnZSA9IHNobWVtX3JlYWRfbWFwcGluZ19wYWdl
KGJvLT5iYXNlLmJhc2UuZmlscC0+Zl9tYXBwaW5nLAo+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgcGFnZV9vZmZzZXQpOwo+ID4gKyAgICAgICBpZiAoSVNfRVJSKHBh
Z2UpKQo+ID4gKyAgICAgICAgICAgICAgIHJldHVybiBQVFJfRVJSKHBhZ2UpOwo+ID4gKwo+ID4g
KyAgICAgICBkbWFfYWRkciA9IGRtYV9tYXBfcGFnZShwZmRldi0+ZGV2LCBwYWdlLCAwLCBQQUdF
X1NJWkUsIERNQV9CSURJUkVDVElPTkFMKTsKPiA+ICsKPiA+ICsgICAgICAgbXV0ZXhfbG9jaygm
cGZkZXYtPm1tdS0+bG9jayk7Cj4gPiArCj4gPiArICAgICAgIG9wcy0+bWFwKG9wcywgYWRkciwg
ZG1hX2FkZHIsIFBBR0VfU0laRSwgSU9NTVVfV1JJVEUgfCBJT01NVV9SRUFEKTsKPiA+ICsKPiA+
ICsgICAgICAgbW11X3dyaXRlKHBmZGV2LCBNTVVfSU5UX0NMRUFSLCBCSVQoYXMpKTsKPiA+ICsK
PiA+ICsgICAgICAgbW11X2h3X2RvX29wZXJhdGlvbihwZmRldiwgYXMsIGFkZHIsIFBBR0VfU0la
RSwgQVNfQ09NTUFORF9GTFVTSF9QVCk7Cj4gPiArCj4gPiArICAgICAgIG11dGV4X3VubG9jaygm
cGZkZXYtPm1tdS0+bG9jayk7Cj4gPiArCj4gPiArICAgICAgIHJldHVybiAwOwo+ID4gK30KPiA+
ICsKPiA+ICBzdGF0aWMgY29uc3QgY2hhciAqYWNjZXNzX3R5cGVfbmFtZShzdHJ1Y3QgcGFuZnJv
c3RfZGV2aWNlICpwZmRldiwKPiA+ICAgICAgICAgICAgICAgICB1MzIgZmF1bHRfc3RhdHVzKQo+
ID4gIHsKPiA+IEBAIC0zMDIsMTMgKzM1OCwxMSBAQCBzdGF0aWMgaXJxcmV0dXJuX3QgcGFuZnJv
c3RfbW11X2lycV9oYW5kbGVyKGludCBpcnEsIHZvaWQgKmRhdGEpCj4gPiAgewo+ID4gICAgICAg
ICBzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldiA9IGRhdGE7Cj4gPiAgICAgICAgIHUzMiBz
dGF0dXMgPSBtbXVfcmVhZChwZmRldiwgTU1VX0lOVF9TVEFUKTsKPiA+IC0gICAgICAgaW50IGk7
Cj4gPiArICAgICAgIGludCBpLCByZXQ7Cj4gPgo+ID4gICAgICAgICBpZiAoIXN0YXR1cykKPiA+
ICAgICAgICAgICAgICAgICByZXR1cm4gSVJRX05PTkU7Cj4gPgo+ID4gLSAgICAgICBkZXZfZXJy
KHBmZGV2LT5kZXYsICJtbXUgaXJxIHN0YXR1cz0leFxuIiwgc3RhdHVzKTsKPiA+IC0KPiA+ICAg
ICAgICAgZm9yIChpID0gMDsgc3RhdHVzOyBpKyspIHsKPiA+ICAgICAgICAgICAgICAgICB1MzIg
bWFzayA9IEJJVChpKSB8IEJJVChpICsgMTYpOwo+ID4gICAgICAgICAgICAgICAgIHU2NCBhZGRy
Owo+ID4gQEAgLTMyOSw2ICszODMsMTcgQEAgc3RhdGljIGlycXJldHVybl90IHBhbmZyb3N0X21t
dV9pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICpkYXRhKQo+ID4gICAgICAgICAgICAgICAgIGFj
Y2Vzc190eXBlID0gKGZhdWx0X3N0YXR1cyA+PiA4KSAmIDB4MzsKPiA+ICAgICAgICAgICAgICAg
ICBzb3VyY2VfaWQgPSAoZmF1bHRfc3RhdHVzID4+IDE2KTsKPiA+Cj4gPiArICAgICAgICAgICAg
ICAgLyogUGFnZSBmYXVsdCBvbmx5ICovCj4gPiArICAgICAgICAgICAgICAgaWYgKChzdGF0dXMg
JiBtYXNrKSA9PSBCSVQoaSkpIHsKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIFdBUk5fT04o
ZXhjZXB0aW9uX3R5cGUgPCAweEMxIHx8IGV4Y2VwdGlvbl90eXBlID4gMHhDNCk7Cj4gPiArCj4g
PiArICAgICAgICAgICAgICAgICAgICAgICByZXQgPSBwYW5mcm9zdF9tbXVfbWFwX2ZhdWx0X2Fk
ZHIocGZkZXYsIGksIGFkZHIpOwo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXQp
IHsKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzICY9IH5tYXNrOwo+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgIH0KPiA+ICsgICAgICAgICAgICAgICB9Cj4gPiArCj4gPiAgICAgICAg
ICAgICAgICAgLyogdGVybWluYWwgZmF1bHQsIHByaW50IGluZm8gYWJvdXQgdGhlIGZhdWx0ICov
Cj4gPiAgICAgICAgICAgICAgICAgZGV2X2VycihwZmRldi0+ZGV2LAo+ID4gICAgICAgICAgICAg
ICAgICAgICAgICAgIlVuaGFuZGxlZCBQYWdlIGZhdWx0IGluIEFTJWQgYXQgVkEgMHglMDE2bGxY
XG4iCj4gPiBAQCAtMzcwLDggKzQzNSw5IEBAIGludCBwYW5mcm9zdF9tbXVfaW5pdChzdHJ1Y3Qg
cGFuZnJvc3RfZGV2aWNlICpwZmRldikKPiA+ICAgICAgICAgaWYgKGlycSA8PSAwKQo+ID4gICAg
ICAgICAgICAgICAgIHJldHVybiAtRU5PREVWOwo+ID4KPiA+IC0gICAgICAgZXJyID0gZGV2bV9y
ZXF1ZXN0X2lycShwZmRldi0+ZGV2LCBpcnEsIHBhbmZyb3N0X21tdV9pcnFfaGFuZGxlciwKPiA+
IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJUlFGX1NIQVJFRCwgIm1tdSIsIHBmZGV2
KTsKPiA+ICsgICAgICAgZXJyID0gZGV2bV9yZXF1ZXN0X3RocmVhZGVkX2lycShwZmRldi0+ZGV2
LCBpcnEsIE5VTEwsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
cGFuZnJvc3RfbW11X2lycV9oYW5kbGVyLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIElSUUZfT05FU0hPVCwgIm1tdSIsIHBmZGV2KTsKPiA+Cj4gPiAgICAgICAg
IGlmIChlcnIpIHsKPiA+ICAgICAgICAgICAgICAgICBkZXZfZXJyKHBmZGV2LT5kZXYsICJmYWls
ZWQgdG8gcmVxdWVzdCBtbXUgaXJxIik7Cj4gPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2Ry
bS9wYW5mcm9zdF9kcm0uaCBiL2luY2x1ZGUvdWFwaS9kcm0vcGFuZnJvc3RfZHJtLmgKPiA+IGlu
ZGV4IGE1MmUwMjgzYjkwZC4uNmQ4M2JhYTBlNGMxIDEwMDY0NAo+ID4gLS0tIGEvaW5jbHVkZS91
YXBpL2RybS9wYW5mcm9zdF9kcm0uaAo+ID4gKysrIGIvaW5jbHVkZS91YXBpL2RybS9wYW5mcm9z
dF9kcm0uaAo+ID4gQEAgLTcxLDYgKzcxLDggQEAgc3RydWN0IGRybV9wYW5mcm9zdF93YWl0X2Jv
IHsKPiA+ICAgICAgICAgX19zNjQgdGltZW91dF9uczsgICAgICAgLyogYWJzb2x1dGUgKi8KPiA+
ICB9Owo+ID4KPiA+ICsjZGVmaW5lIFBBTkZST1NUX0JPX05PTUFQICAgICAgMQo+ID4gKwo+ID4g
IC8qKgo+ID4gICAqIHN0cnVjdCBkcm1fcGFuZnJvc3RfY3JlYXRlX2JvIC0gaW9jdGwgYXJndW1l
bnQgZm9yIGNyZWF0aW5nIFBhbmZyb3N0IEJPcy4KPiA+ICAgKgo+ID4gLS0KPiA+IDIuMjAuMQo+
ID4KPiBfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwo+IGRy
aS1kZXZlbCBtYWlsaW5nIGxpc3QKPiBkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCj4g
aHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWwK
Ci0tIApEYW5pZWwgVmV0dGVyClNvZnR3YXJlIEVuZ2luZWVyLCBJbnRlbCBDb3Jwb3JhdGlvbgpo
dHRwOi8vYmxvZy5mZndsbC5jaApfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVz
a3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9k
cmktZGV2ZWw=
