Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id E12CA245EFE
	for <lists+dri-devel@lfdr.de>; Mon, 17 Aug 2020 10:14:55 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 419A66E4FB;
	Mon, 17 Aug 2020 08:14:49 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from honk.sigxcpu.org (honk.sigxcpu.org [24.134.29.49])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 266C46E4FB
 for <dri-devel@lists.freedesktop.org>; Mon, 17 Aug 2020 08:14:48 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by honk.sigxcpu.org (Postfix) with ESMTP id A749BFB04;
 Mon, 17 Aug 2020 10:14:44 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at honk.sigxcpu.org
Received: from honk.sigxcpu.org ([127.0.0.1])
 by localhost (honk.sigxcpu.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id cukZlZatac4c; Mon, 17 Aug 2020 10:14:40 +0200 (CEST)
Received: by bogon.sigxcpu.org (Postfix, from userid 1000)
 id 6E542457CD; Mon, 17 Aug 2020 10:14:36 +0200 (CEST)
From: =?UTF-8?q?Guido=20G=C3=BCnther?= <agx@sigxcpu.org>
To: Thierry Reding <thierry.reding@gmail.com>, Sam Ravnborg <sam@ravnborg.org>,
 David Airlie <airlied@linux.ie>, Daniel Vetter <daniel@ffwll.ch>,
 Rob Herring <robh+dt@kernel.org>, Arnd Bergmann <arnd@arndb.de>,
 Linus Walleij <linus.walleij@linaro.org>,
 Heiko Stuebner <heiko.stuebner@theobroma-systems.com>,
 Daniel Palmer <daniel@0x0f.com>, Lubomir Rintel <lkundrak@v3.sk>,
 Mark Brown <broonie@kernel.org>,
 Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>,
 allen <allen.chen@ite.com.tw>,
 Mauro Carvalho Chehab <mchehab+huawei@kernel.org>,
 "David S. Miller" <davem@davemloft.net>, dri-devel@lists.freedesktop.org,
 devicetree@vger.kernel.org, linux-kernel@vger.kernel.org
Subject: [PATCH v3 3/3] drm/panel: Add panel driver for the Mantix
 MLAF057WE51-X DSI panel
Date: Mon, 17 Aug 2020 10:14:36 +0200
Message-Id: <118c6e03dd0ff6e86e495579102cbf7d0cfca6f4.1597652012.git.agx@sigxcpu.org>
X-Mailer: git-send-email 2.26.2
In-Reply-To: <cover.1597652012.git.agx@sigxcpu.org>
References: <cover.1597652012.git.agx@sigxcpu.org>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIHBhbmVsIHVzZXMgYSBGb2NhbHRlY2ggRlQ4MDA2cCwgdGhlIHRvdWNoIHBhcnQgaXMgaGFu
ZGxlZCBieSB0aGUKYWxyZWFkeSBleGlzdGluZyBlZHQtZnQ1eDA2LgoKU2lnbmVkLW9mZi1ieTog
R3VpZG8gR8O8bnRoZXIgPGFneEBzaWd4Y3B1Lm9yZz4KUmV2aWV3ZWQtYnk6IFNhbSBSYXZuYm9y
ZyA8c2FtQHJhdm5ib3JnLm9yZz4KLS0tCiBNQUlOVEFJTkVSUyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgfCAgIDcgKwogZHJpdmVycy9ncHUvZHJtL3BhbmVsL0tjb25maWcgICAg
ICAgICAgICAgICAgIHwgIDExICsKIGRyaXZlcnMvZ3B1L2RybS9wYW5lbC9NYWtlZmlsZSAgICAg
ICAgICAgICAgICB8ICAgMSArCiAuLi4vZ3B1L2RybS9wYW5lbC9wYW5lbC1tYW50aXgtbWxhZjA1
N3dlNTEuYyAgfCAzMjggKysrKysrKysrKysrKysrKysrCiA0IGZpbGVzIGNoYW5nZWQsIDM0NyBp
bnNlcnRpb25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL3BhbmVsL3Bh
bmVsLW1hbnRpeC1tbGFmMDU3d2U1MS5jCgpkaWZmIC0tZ2l0IGEvTUFJTlRBSU5FUlMgYi9NQUlO
VEFJTkVSUwppbmRleCA4M2JhN2I2MjY1MWY3Li43ZGZlNGNjM2Q0ZWM4IDEwMDY0NAotLS0gYS9N
QUlOVEFJTkVSUworKysgYi9NQUlOVEFJTkVSUwpAQCAtNTQ3NCw2ICs1NDc0LDEzIEBAIFM6CU1h
aW50YWluZWQKIEY6CWRyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1sdmRzLmMKIEY6CURvY3Vt
ZW50YXRpb24vZGV2aWNldHJlZS9iaW5kaW5ncy9kaXNwbGF5L3BhbmVsL2x2ZHMueWFtbAogCitE
Uk0gRFJJVkVSIEZPUiBNQU5USVggTUxBRjA1N1dFNTEgUEFORUxTCitNOglHdWlkbyBHw7xudGhl
ciA8YWd4QHNpZ3hjcHUub3JnPgorUjoJUHVyaXNtIEtlcm5lbCBUZWFtIDxrZXJuZWxAcHVyaS5z
bT4KK1M6CU1haW50YWluZWQKK0Y6CURvY3VtZW50YXRpb24vZGV2aWNldHJlZS9iaW5kaW5ncy9k
aXNwbGF5L3BhbmVsL21hbnRpeCxtbGFmMDU3d2U1MS14LnlhbWwKK0Y6CWRyaXZlcnMvZ3B1L2Ry
bS9wYW5lbC9wYW5lbC1tYW50aXgtbWxhZjA1N3dlNTEuYworCiBEUk0gRFJJVkVSIEZPUiBNQVRS
T1ggRzIwMC9HNDAwIEdSQVBISUNTIENBUkRTCiBTOglPcnBoYW4gLyBPYnNvbGV0ZQogRjoJZHJp
dmVycy9ncHUvZHJtL21nYS8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9LY29u
ZmlnIGIvZHJpdmVycy9ncHUvZHJtL3BhbmVsL0tjb25maWcKaW5kZXggZGUyZjJhNDUyYmU1NS4u
OGQ5N2QwN2M1ODcxMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3BhbmVsL0tjb25maWcK
KysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmVsL0tjb25maWcKQEAgLTIxNyw2ICsyMTcsMTcgQEAg
Y29uZmlnIERSTV9QQU5FTF9OT1ZBVEVLX05UMzkwMTYKIAkgIFNheSBZIGhlcmUgaWYgeW91IHdh
bnQgdG8gZW5hYmxlIHN1cHBvcnQgZm9yIHRoZSBwYW5lbHMgYnVpbHQKIAkgIGFyb3VuZCB0aGUg
Tm92YXRlayBOVDM5MDE2IGRpc3BsYXkgY29udHJvbGxlci4KIAorY29uZmlnIERSTV9QQU5FTF9N
QU5USVhfTUxBRjA1N1dFNTEKKwl0cmlzdGF0ZSAiTWFudGl4IE1MQUYwNTdXRTUxLVggTUlQSS1E
U0kgTENEIHBhbmVsIgorCWRlcGVuZHMgb24gT0YKKwlkZXBlbmRzIG9uIERSTV9NSVBJX0RTSQor
CWRlcGVuZHMgb24gQkFDS0xJR0hUX0NMQVNTX0RFVklDRQorCWhlbHAKKwkgIFNheSBZIGhlcmUg
aWYgeW91IHdhbnQgdG8gZW5hYmxlIHN1cHBvcnQgZm9yIHRoZSBNYW50aXgKKwkgIE1MQUYwNTdX
RTUxLVggTUlQSSBEU0kgcGFuZWwgYXMgZS5nLiB1c2VkIGluIHRoZSBMaWJyZW0gNS4gSXQKKwkg
IGhhcyBhIHJlc29sdXRpb24gb2YgNzIweDE0NDAgcGl4ZWxzLCBhIGJ1aWx0IGluIGJhY2tsaWdo
dCBhbmQgdG91Y2gKKwkgIGNvbnRyb2xsZXIuCisKIGNvbmZpZyBEUk1fUEFORUxfT0xJTUVYX0xD
RF9PTElOVVhJTk8KIAl0cmlzdGF0ZSAiT2xpbWV4IExDRC1PTGludVhpbm8gcGFuZWwiCiAJZGVw
ZW5kcyBvbiBPRgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmVsL01ha2VmaWxlIGIv
ZHJpdmVycy9ncHUvZHJtL3BhbmVsL01ha2VmaWxlCmluZGV4IGU0NWNlYWM2Mjg2ZmQuLjE1YTRl
Nzc1Mjk1MTQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9NYWtlZmlsZQorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvTWFrZWZpbGUKQEAgLTIwLDYgKzIwLDcgQEAgb2JqLSQo
Q09ORklHX0RSTV9QQU5FTF9MR19MRzQ1NzMpICs9IHBhbmVsLWxnLWxnNDU3My5vCiBvYmotJChD
T05GSUdfRFJNX1BBTkVMX05FQ19OTDgwNDhITDExKSArPSBwYW5lbC1uZWMtbmw4MDQ4aGwxMS5v
CiBvYmotJChDT05GSUdfRFJNX1BBTkVMX05PVkFURUtfTlQzNTUxMCkgKz0gcGFuZWwtbm92YXRl
ay1udDM1NTEwLm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfTk9WQVRFS19OVDM5MDE2KSArPSBw
YW5lbC1ub3ZhdGVrLW50MzkwMTYubworb2JqLSQoQ09ORklHX0RSTV9QQU5FTF9NQU5USVhfTUxB
RjA1N1dFNTEpICs9IHBhbmVsLW1hbnRpeC1tbGFmMDU3d2U1MS5vCiBvYmotJChDT05GSUdfRFJN
X1BBTkVMX09MSU1FWF9MQ0RfT0xJTlVYSU5PKSArPSBwYW5lbC1vbGltZXgtbGNkLW9saW51eGlu
by5vCiBvYmotJChDT05GSUdfRFJNX1BBTkVMX09SSVNFVEVDSF9PVE04MDA5QSkgKz0gcGFuZWwt
b3Jpc2V0ZWNoLW90bTgwMDlhLm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfT1NEX09TRDEwMVQy
NTg3XzUzVFMpICs9IHBhbmVsLW9zZC1vc2QxMDF0MjU4Ny01M3RzLm8KZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1tYW50aXgtbWxhZjA1N3dlNTEuYyBiL2RyaXZlcnMv
Z3B1L2RybS9wYW5lbC9wYW5lbC1tYW50aXgtbWxhZjA1N3dlNTEuYwpuZXcgZmlsZSBtb2RlIDEw
MDY0NAppbmRleCAwMDAwMDAwMDAwMDAwLi4zNDgyZTI4ZTMwZmM5Ci0tLSAvZGV2L251bGwKKysr
IGIvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLW1hbnRpeC1tbGFmMDU3d2U1MS5jCkBAIC0w
LDAgKzEsMzI4IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAorLyoKKyAq
IE1hbnRpeCBNTEFGMDU3V0U1MSA1LjciIE1JUEktRFNJIHBhbmVsIGRyaXZlcgorICoKKyAqIENv
cHlyaWdodCAoQykgUHVyaXNtIFNQQyAyMDIwCisgKi8KKworI2luY2x1ZGUgPGxpbnV4L2JhY2ts
aWdodC5oPgorI2luY2x1ZGUgPGxpbnV4L2RlbGF5Lmg+CisjaW5jbHVkZSA8bGludXgvZ3Bpby9j
b25zdW1lci5oPgorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgorI2luY2x1ZGUgPGxpbnV4L3Jl
Z3VsYXRvci9jb25zdW1lci5oPgorCisjaW5jbHVkZSA8dmlkZW8vbWlwaV9kaXNwbGF5Lmg+CisK
KyNpbmNsdWRlIDxkcm0vZHJtX21pcGlfZHNpLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9tb2Rlcy5o
PgorI2luY2x1ZGUgPGRybS9kcm1fcGFuZWwuaD4KKworI2RlZmluZSBEUlZfTkFNRSAicGFuZWwt
bWFudGl4LW1sYWYwNTd3ZTUxIgorCisvKiBNYW51ZmFjdHVyZXIgc3BlY2lmaWMgQ29tbWFuZHMg
c2VuZCB2aWEgRFNJICovCisjZGVmaW5lIE1BTlRJWF9DTURfT1RQX1NUT1BfUkVMT0FEX01JUEkg
MHg0MQorI2RlZmluZSBNQU5USVhfQ01EX0lOVF9DQU5DRUwgICAgICAgICAgIDB4NEMKKworc3Ry
dWN0IG1hbnRpeCB7CisJc3RydWN0IGRldmljZSAqZGV2OworCXN0cnVjdCBkcm1fcGFuZWwgcGFu
ZWw7CisJc3RydWN0IGdwaW9fZGVzYyAqcmVzZXRfZ3BpbzsKKworCXN0cnVjdCByZWd1bGF0b3Ig
KmF2ZGQ7CisJc3RydWN0IHJlZ3VsYXRvciAqYXZlZTsKKwlzdHJ1Y3QgcmVndWxhdG9yICp2ZGRp
OworfTsKKworc3RhdGljIGlubGluZSBzdHJ1Y3QgbWFudGl4ICpwYW5lbF90b19tYW50aXgoc3Ry
dWN0IGRybV9wYW5lbCAqcGFuZWwpCit7CisJcmV0dXJuIGNvbnRhaW5lcl9vZihwYW5lbCwgc3Ry
dWN0IG1hbnRpeCwgcGFuZWwpOworfQorCisjZGVmaW5lIGRzaV9nZW5lcmljX3dyaXRlX3NlcShk
c2ksIHNlcS4uLikgZG8gewkJCQlcCisJCXN0YXRpYyBjb25zdCB1OCBkW10gPSB7IHNlcSB9OwkJ
CQlcCisJCWludCByZXQ7CQkJCQkJXAorCQlyZXQgPSBtaXBpX2RzaV9nZW5lcmljX3dyaXRlKGRz
aSwgZCwgQVJSQVlfU0laRShkKSk7CVwKKwkJaWYgKHJldCA8IDApCQkJCQkJXAorCQkJcmV0dXJu
IHJldDsJCQkJCVwKKwl9IHdoaWxlICgwKQorCitzdGF0aWMgaW50IG1hbnRpeF9pbml0X3NlcXVl
bmNlKHN0cnVjdCBtYW50aXggKmN0eCkKK3sKKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kg
PSB0b19taXBpX2RzaV9kZXZpY2UoY3R4LT5kZXYpOworCXN0cnVjdCBkZXZpY2UgKmRldiA9IGN0
eC0+ZGV2OworCisJLyoKKwkgKiBJbml0IHNlcXVlbmNlIHdhcyBzdXBwbGllZCBieSB0aGUgcGFu
ZWwgdmVuZG9yLgorCSAqLworCWRzaV9nZW5lcmljX3dyaXRlX3NlcShkc2ksIE1BTlRJWF9DTURf
T1RQX1NUT1BfUkVMT0FEX01JUEksIDB4NUEpOworCisJZHNpX2dlbmVyaWNfd3JpdGVfc2VxKGRz
aSwgTUFOVElYX0NNRF9JTlRfQ0FOQ0VMLCAweDAzKTsKKwlkc2lfZ2VuZXJpY193cml0ZV9zZXEo
ZHNpLCBNQU5USVhfQ01EX09UUF9TVE9QX1JFTE9BRF9NSVBJLCAweDVBLCAweDAzKTsKKwlkc2lf
Z2VuZXJpY193cml0ZV9zZXEoZHNpLCAweDgwLCAweEE5LCAweDAwKTsKKworCWRzaV9nZW5lcmlj
X3dyaXRlX3NlcShkc2ksIE1BTlRJWF9DTURfT1RQX1NUT1BfUkVMT0FEX01JUEksIDB4NUEsIDB4
MDkpOworCWRzaV9nZW5lcmljX3dyaXRlX3NlcShkc2ksIDB4ODAsIDB4NjQsIDB4MDAsIDB4NjQs
IDB4MDAsIDB4MDApOworCW1zbGVlcCgyMCk7CisKKwlkZXZfZGJnKGRldiwgIlBhbmVsIGluaXQg
c2VxdWVuY2UgZG9uZVxuIik7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgbWFudGl4X2Vu
YWJsZShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKK3sKKwlzdHJ1Y3QgbWFudGl4ICpjdHggPSBw
YW5lbF90b19tYW50aXgocGFuZWwpOworCXN0cnVjdCBkZXZpY2UgKmRldiA9IGN0eC0+ZGV2Owor
CXN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSA9IHRvX21pcGlfZHNpX2RldmljZShkZXYpOwor
CWludCByZXQ7CisKKwlyZXQgPSBtYW50aXhfaW5pdF9zZXF1ZW5jZShjdHgpOworCWlmIChyZXQg
PCAwKSB7CisJCWRldl9lcnIoY3R4LT5kZXYsICJQYW5lbCBpbml0IHNlcXVlbmNlIGZhaWxlZDog
JWRcbiIsIHJldCk7CisJCXJldHVybiByZXQ7CisJfQorCisJcmV0ID0gbWlwaV9kc2lfZGNzX2V4
aXRfc2xlZXBfbW9kZShkc2kpOworCWlmIChyZXQgPCAwKSB7CisJCWRldl9lcnIoZGV2LCAiRmFp
bGVkIHRvIGV4aXQgc2xlZXAgbW9kZVxuIik7CisJCXJldHVybiByZXQ7CisJfQorCW1zbGVlcCgy
MCk7CisKKwlyZXQgPSBtaXBpX2RzaV9kY3Nfc2V0X2Rpc3BsYXlfb24oZHNpKTsKKwlpZiAocmV0
KQorCQlyZXR1cm4gcmV0OworCXVzbGVlcF9yYW5nZSgxMDAwMCwgMTIwMDApOworCisJcmV0ID0g
bWlwaV9kc2lfdHVybl9vbl9wZXJpcGhlcmFsKGRzaSk7CisJaWYgKHJldCA8IDApIHsKKwkJZGV2
X2VycihkZXYsICJGYWlsZWQgdG8gdHVybiBvbiBwZXJpcGhlcmFsXG4iKTsKKwkJcmV0dXJuIHJl
dDsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBtYW50aXhfZGlzYWJsZShzdHJ1
Y3QgZHJtX3BhbmVsICpwYW5lbCkKK3sKKwlzdHJ1Y3QgbWFudGl4ICpjdHggPSBwYW5lbF90b19t
YW50aXgocGFuZWwpOworCXN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSA9IHRvX21pcGlfZHNp
X2RldmljZShjdHgtPmRldik7CisJaW50IHJldDsKKworCXJldCA9IG1pcGlfZHNpX2Rjc19zZXRf
ZGlzcGxheV9vZmYoZHNpKTsKKwlpZiAocmV0IDwgMCkKKwkJZGV2X2VycihjdHgtPmRldiwgIkZh
aWxlZCB0byB0dXJuIG9mZiB0aGUgZGlzcGxheTogJWRcbiIsIHJldCk7CisKKwlyZXQgPSBtaXBp
X2RzaV9kY3NfZW50ZXJfc2xlZXBfbW9kZShkc2kpOworCWlmIChyZXQgPCAwKQorCQlkZXZfZXJy
KGN0eC0+ZGV2LCAiRmFpbGVkIHRvIGVudGVyIHNsZWVwIG1vZGU6ICVkXG4iLCByZXQpOworCisK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBtYW50aXhfdW5wcmVwYXJlKHN0cnVjdCBkcm1f
cGFuZWwgKnBhbmVsKQoreworCXN0cnVjdCBtYW50aXggKmN0eCA9IHBhbmVsX3RvX21hbnRpeChw
YW5lbCk7CisKKwlyZWd1bGF0b3JfZGlzYWJsZShjdHgtPmF2ZWUpOworCXJlZ3VsYXRvcl9kaXNh
YmxlKGN0eC0+YXZkZCk7CisJLyogVDExICovCisJdXNsZWVwX3JhbmdlKDUwMDAsIDYwMDApOwor
CXJlZ3VsYXRvcl9kaXNhYmxlKGN0eC0+dmRkaSk7CisJLyogVDE0ICovCisJbXNsZWVwKDUwKTsK
KworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IG1hbnRpeF9wcmVwYXJlKHN0cnVjdCBkcm1f
cGFuZWwgKnBhbmVsKQoreworCXN0cnVjdCBtYW50aXggKmN0eCA9IHBhbmVsX3RvX21hbnRpeChw
YW5lbCk7CisJaW50IHJldDsKKworCS8qIEZvY2FsdGVjaCBGVDgwMDZQLCBzZWN0aW9uIDcuMy4x
IGFuZCA3LjMuNCAqLworCWRldl9kYmcoY3R4LT5kZXYsICJSZXNldHRpbmcgdGhlIHBhbmVsXG4i
KTsKKwlyZXQgPSByZWd1bGF0b3JfZW5hYmxlKGN0eC0+dmRkaSk7CisJaWYgKHJldCA8IDApIHsK
KwkJZGV2X2VycihjdHgtPmRldiwgIkZhaWxlZCB0byBlbmFibGUgdmRkaSBzdXBwbHk6ICVkXG4i
LCByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKworCS8qIFQxICsgVDIgKi8KKwl1c2xlZXBfcmFu
Z2UoODAwMCwgMTAwMDApOworCisJcmV0ID0gcmVndWxhdG9yX2VuYWJsZShjdHgtPmF2ZGQpOwor
CWlmIChyZXQgPCAwKSB7CisJCWRldl9lcnIoY3R4LT5kZXYsICJGYWlsZWQgdG8gZW5hYmxlIGF2
ZGQgc3VwcGx5OiAlZFxuIiwgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwkvKiBUMmQgKi8K
Kwl1c2xlZXBfcmFuZ2UoMzUwMCwgNDAwMCk7CisJcmV0ID0gcmVndWxhdG9yX2VuYWJsZShjdHgt
PmF2ZWUpOworCWlmIChyZXQgPCAwKSB7CisJCWRldl9lcnIoY3R4LT5kZXYsICJGYWlsZWQgdG8g
ZW5hYmxlIGF2ZWUgc3VwcGx5OiAlZFxuIiwgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwkv
KiBUMytUNSAqLworCXVzbGVlcF9yYW5nZSgxMDAwMCwgMTIwMDApOworCisJZ3Bpb2Rfc2V0X3Zh
bHVlX2NhbnNsZWVwKGN0eC0+cmVzZXRfZ3BpbywgMSk7CisJdXNsZWVwX3JhbmdlKDUxNTAsIDcw
MDApOworCisJZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKGN0eC0+cmVzZXRfZ3BpbywgMCk7CisK
KwkvKiBUNiAqLworCW1zbGVlcCg1MCk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0
IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlIGRlZmF1bHRfbW9kZSA9IHsKKwkuaGRpc3BsYXkgICAg
PSA3MjAsCisJLmhzeW5jX3N0YXJ0ID0gNzIwICsgNDUsCisJLmhzeW5jX2VuZCAgID0gNzIwICsg
NDUgKyAxNCwKKwkuaHRvdGFsCSAgICAgPSA3MjAgKyA0NSArIDE0ICsgMjUsCisJLnZkaXNwbGF5
ICAgID0gMTQ0MCwKKwkudnN5bmNfc3RhcnQgPSAxNDQwICsgMTMwLAorCS52c3luY19lbmQgICA9
IDE0NDAgKyAxMzAgKyA4LAorCS52dG90YWwJICAgICA9IDE0NDAgKyAxMzAgKyA4ICsgMTA2LAor
CS5jbG9jawkgICAgID0gODUyOTgsCisJLmZsYWdzCSAgICAgPSBEUk1fTU9ERV9GTEFHX05IU1lO
QyB8IERSTV9NT0RFX0ZMQUdfTlZTWU5DLAorCS53aWR0aF9tbSAgICA9IDY1LAorCS5oZWlnaHRf
bW0gICA9IDEzMCwKK307CisKK3N0YXRpYyBpbnQgbWFudGl4X2dldF9tb2RlcyhzdHJ1Y3QgZHJt
X3BhbmVsICpwYW5lbCwKKwkJCSAgICBzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQor
eworCXN0cnVjdCBtYW50aXggKmN0eCA9IHBhbmVsX3RvX21hbnRpeChwYW5lbCk7CisJc3RydWN0
IGRybV9kaXNwbGF5X21vZGUgKm1vZGU7CisKKwltb2RlID0gZHJtX21vZGVfZHVwbGljYXRlKGNv
bm5lY3Rvci0+ZGV2LCAmZGVmYXVsdF9tb2RlKTsKKwlpZiAoIW1vZGUpIHsKKwkJZGV2X2Vycihj
dHgtPmRldiwgIkZhaWxlZCB0byBhZGQgbW9kZSAldXgldUAldVxuIiwKKwkJCWRlZmF1bHRfbW9k
ZS5oZGlzcGxheSwgZGVmYXVsdF9tb2RlLnZkaXNwbGF5LAorCQkJZHJtX21vZGVfdnJlZnJlc2go
bW9kZSkpOworCQlyZXR1cm4gLUVOT01FTTsKKwl9CisKKwlkcm1fbW9kZV9zZXRfbmFtZShtb2Rl
KTsKKworCW1vZGUtPnR5cGUgPSBEUk1fTU9ERV9UWVBFX0RSSVZFUiB8IERSTV9NT0RFX1RZUEVf
UFJFRkVSUkVEOworCWNvbm5lY3Rvci0+ZGlzcGxheV9pbmZvLndpZHRoX21tID0gbW9kZS0+d2lk
dGhfbW07CisJY29ubmVjdG9yLT5kaXNwbGF5X2luZm8uaGVpZ2h0X21tID0gbW9kZS0+aGVpZ2h0
X21tOworCWRybV9tb2RlX3Byb2JlZF9hZGQoY29ubmVjdG9yLCBtb2RlKTsKKworCXJldHVybiAx
OworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9wYW5lbF9mdW5jcyBtYW50aXhfZHJtX2Z1
bmNzID0geworCS5kaXNhYmxlICAgPSBtYW50aXhfZGlzYWJsZSwKKwkudW5wcmVwYXJlID0gbWFu
dGl4X3VucHJlcGFyZSwKKwkucHJlcGFyZSAgID0gbWFudGl4X3ByZXBhcmUsCisJLmVuYWJsZQkg
ICA9IG1hbnRpeF9lbmFibGUsCisJLmdldF9tb2RlcyA9IG1hbnRpeF9nZXRfbW9kZXMsCit9Owor
CitzdGF0aWMgaW50IG1hbnRpeF9wcm9iZShzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kpCit7
CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmRzaS0+ZGV2OworCXN0cnVjdCBtYW50aXggKmN0eDsK
KwlpbnQgcmV0OworCisJY3R4ID0gZGV2bV9remFsbG9jKGRldiwgc2l6ZW9mKCpjdHgpLCBHRlBf
S0VSTkVMKTsKKwlpZiAoIWN0eCkKKwkJcmV0dXJuIC1FTk9NRU07CisKKwljdHgtPnJlc2V0X2dw
aW8gPSBkZXZtX2dwaW9kX2dldChkZXYsICJyZXNldCIsIEdQSU9EX09VVF9MT1cpOworCWlmIChJ
U19FUlIoY3R4LT5yZXNldF9ncGlvKSkgeworCQlkZXZfZXJyKGRldiwgImNhbm5vdCBnZXQgcmVz
ZXQgZ3Bpb1xuIik7CisJCXJldHVybiBQVFJfRVJSKGN0eC0+cmVzZXRfZ3Bpbyk7CisJfQorCisJ
bWlwaV9kc2lfc2V0X2RydmRhdGEoZHNpLCBjdHgpOworCWN0eC0+ZGV2ID0gZGV2OworCisJZHNp
LT5sYW5lcyA9IDQ7CisJZHNpLT5mb3JtYXQgPSBNSVBJX0RTSV9GTVRfUkdCODg4OworCWRzaS0+
bW9kZV9mbGFncyA9IE1JUElfRFNJX01PREVfVklERU8gfAorCQlNSVBJX0RTSV9NT0RFX1ZJREVP
X0JVUlNUIHwgTUlQSV9EU0lfTU9ERV9WSURFT19TWU5DX1BVTFNFOworCisJY3R4LT5hdmRkID0g
ZGV2bV9yZWd1bGF0b3JfZ2V0KGRldiwgImF2ZGQiKTsKKwlpZiAoSVNfRVJSKGN0eC0+YXZkZCkp
CisJCXJldHVybiBkZXZfZXJyX3Byb2JlKGRldiwgUFRSX0VSUihjdHgtPmF2ZGQpLCAiRmFpbGVk
IHRvIHJlcXVlc3QgYXZkZCByZWd1bGF0b3JcbiIpOworCisJY3R4LT5hdmVlID0gZGV2bV9yZWd1
bGF0b3JfZ2V0KGRldiwgImF2ZWUiKTsKKwlpZiAoSVNfRVJSKGN0eC0+YXZlZSkpCisJCXJldHVy
biBkZXZfZXJyX3Byb2JlKGRldiwgUFRSX0VSUihjdHgtPmF2ZWUpLCAiRmFpbGVkIHRvIHJlcXVl
c3QgYXZlZSByZWd1bGF0b3JcbiIpOworCisJY3R4LT52ZGRpID0gZGV2bV9yZWd1bGF0b3JfZ2V0
KGRldiwgInZkZGkiKTsKKwlpZiAoSVNfRVJSKGN0eC0+dmRkaSkpCisJCXJldHVybiBkZXZfZXJy
X3Byb2JlKGRldiwgUFRSX0VSUihjdHgtPnZkZGkpLCAiRmFpbGVkIHRvIHJlcXVlc3QgdmRkaSBy
ZWd1bGF0b3JcbiIpOworCisJZHJtX3BhbmVsX2luaXQoJmN0eC0+cGFuZWwsIGRldiwgJm1hbnRp
eF9kcm1fZnVuY3MsCisJCSAgICAgICBEUk1fTU9ERV9DT05ORUNUT1JfRFNJKTsKKworCXJldCA9
IGRybV9wYW5lbF9vZl9iYWNrbGlnaHQoJmN0eC0+cGFuZWwpOworCWlmIChyZXQpCisJCXJldHVy
biByZXQ7CisKKwlkcm1fcGFuZWxfYWRkKCZjdHgtPnBhbmVsKTsKKworCXJldCA9IG1pcGlfZHNp
X2F0dGFjaChkc2kpOworCWlmIChyZXQgPCAwKSB7CisJCWRldl9lcnIoZGV2LCAibWlwaV9kc2lf
YXR0YWNoIGZhaWxlZCAoJWQpLiBJcyBob3N0IHJlYWR5P1xuIiwgcmV0KTsKKwkJZHJtX3BhbmVs
X3JlbW92ZSgmY3R4LT5wYW5lbCk7CisJCXJldHVybiByZXQ7CisJfQorCisJZGV2X2luZm8oZGV2
LCAiJXV4JXVAJXUgJXVicHAgZHNpICV1ZGwgLSByZWFkeVxuIiwKKwkJIGRlZmF1bHRfbW9kZS5o
ZGlzcGxheSwgZGVmYXVsdF9tb2RlLnZkaXNwbGF5LAorCQkgZHJtX21vZGVfdnJlZnJlc2goJmRl
ZmF1bHRfbW9kZSksCisJCSBtaXBpX2RzaV9waXhlbF9mb3JtYXRfdG9fYnBwKGRzaS0+Zm9ybWF0
KSwgZHNpLT5sYW5lcyk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgbWFudGl4X3No
dXRkb3duKHN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSkKK3sKKwlzdHJ1Y3QgbWFudGl4ICpj
dHggPSBtaXBpX2RzaV9nZXRfZHJ2ZGF0YShkc2kpOworCisJZHJtX3BhbmVsX3VucHJlcGFyZSgm
Y3R4LT5wYW5lbCk7CisJZHJtX3BhbmVsX2Rpc2FibGUoJmN0eC0+cGFuZWwpOworfQorCitzdGF0
aWMgaW50IG1hbnRpeF9yZW1vdmUoc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpKQoreworCXN0
cnVjdCBtYW50aXggKmN0eCA9IG1pcGlfZHNpX2dldF9kcnZkYXRhKGRzaSk7CisKKwltYW50aXhf
c2h1dGRvd24oZHNpKTsKKworCW1pcGlfZHNpX2RldGFjaChkc2kpOworCWRybV9wYW5lbF9yZW1v
dmUoJmN0eC0+cGFuZWwpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3Qg
b2ZfZGV2aWNlX2lkIG1hbnRpeF9vZl9tYXRjaFtdID0geworCXsgLmNvbXBhdGlibGUgPSAibWFu
dGl4LG1sYWYwNTd3ZTUxLXgiIH0sCisJeyAvKiBzZW50aW5lbCAqLyB9Cit9OworTU9EVUxFX0RF
VklDRV9UQUJMRShvZiwgbWFudGl4X29mX21hdGNoKTsKKworc3RhdGljIHN0cnVjdCBtaXBpX2Rz
aV9kcml2ZXIgbWFudGl4X2RyaXZlciA9IHsKKwkucHJvYmUJPSBtYW50aXhfcHJvYmUsCisJLnJl
bW92ZSA9IG1hbnRpeF9yZW1vdmUsCisJLnNodXRkb3duID0gbWFudGl4X3NodXRkb3duLAorCS5k
cml2ZXIgPSB7CisJCS5uYW1lID0gRFJWX05BTUUsCisJCS5vZl9tYXRjaF90YWJsZSA9IG1hbnRp
eF9vZl9tYXRjaCwKKwl9LAorfTsKK21vZHVsZV9taXBpX2RzaV9kcml2ZXIobWFudGl4X2RyaXZl
cik7CisKK01PRFVMRV9BVVRIT1IoIkd1aWRvIEfDvG50aGVyIDxhZ3hAc2lneGNwdS5vcmc+Iik7
CitNT0RVTEVfREVTQ1JJUFRJT04oIkRSTSBkcml2ZXIgZm9yIE1hbnRpeCBNTEFGMDU3V0U1MS1Y
IE1JUEkgRFNJIHBhbmVsIik7CitNT0RVTEVfTElDRU5TRSgiR1BMIHYyIik7Ci0tIAoyLjI2LjIK
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZl
bCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xp
c3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbAo=
