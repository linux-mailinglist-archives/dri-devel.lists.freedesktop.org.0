Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 0B473207003
	for <lists+dri-devel@lfdr.de>; Wed, 24 Jun 2020 11:29:21 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 20D756EABA;
	Wed, 24 Jun 2020 09:29:19 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-wr1-x443.google.com (mail-wr1-x443.google.com
 [IPv6:2a00:1450:4864:20::443])
 by gabe.freedesktop.org (Postfix) with ESMTPS id EF5306EABA
 for <dri-devel@lists.freedesktop.org>; Wed, 24 Jun 2020 09:29:17 +0000 (UTC)
Received: by mail-wr1-x443.google.com with SMTP id v3so1584901wrc.1
 for <dri-devel@lists.freedesktop.org>; Wed, 24 Jun 2020 02:29:17 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=ffwll.ch; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=W0wVhEMhWH3hYon0OeouApnRcgkILMJ/Xt7oWX7gLsg=;
 b=OarMyjw89XIpDvY/QrTzsO6Ols2ILfTaOBq04SQiR+FuIsZe012LrnZ7cB4zo7Vdxw
 mQrHMwiF33CoS+wnoev+YLG6RDjnn2k2B+S00boaApeE/hk1EY3pTXyPCTpC4VkZJi9h
 JHGgzLTawQgb5CcaWIZu3lOSxK1uE6W8rGlRo=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=W0wVhEMhWH3hYon0OeouApnRcgkILMJ/Xt7oWX7gLsg=;
 b=Pux9gXVq+BgqdVFuaQHUOeZ6ti3MG3Jem+WVPHgO2lf5zYWXCwSANjBuqQZ0y9uw01
 1VEa3o+Yc6FrgbS64o0B9ICgpsPs3CFMEzEIHcrTh1TJ/nuj2zNR8GAfJPjKjuYHre5t
 X8z70vGjjLxhjgrwIWetvXI3m+rEJi7esXbDPJFwV3Zf021BpReIaqjT2zylH/e4v92m
 K+Jpnnc9SyJO2HYwV5mk5osC3sL8jMCiyYqYIH3kjWtc1xXc+KjneoRHABEDNLQ+zuxF
 xDG4AcyHH8F65/P3G8mfkLO06NW82NpwsMkPtu7MTH6jTB1s/iaBPjIkgxLOGxhbneEn
 e4iQ==
X-Gm-Message-State: AOAM530K8puM80eCwanp43FHe1axQgffk8ahnWRre0gPogWReKt5jNVM
 Bc6zmjZ1pybw5DbF8DQpVa5pRtntR+o=
X-Google-Smtp-Source: ABdhPJzW8mAFVy2khktm0xHnYGgLgpNPmVkDKLcdGO6ITsJNOwZiUyPwYV1adoRJGMo/aW8PBK8RYQ==
X-Received: by 2002:adf:a34d:: with SMTP id d13mr28876302wrb.270.1592990956247; 
 Wed, 24 Jun 2020 02:29:16 -0700 (PDT)
Received: from phenom.ffwll.local ([2a02:168:57f4:0:efd0:b9e5:5ae6:c2fa])
 by smtp.gmail.com with ESMTPSA id l190sm7212565wml.12.2020.06.24.02.29.14
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Wed, 24 Jun 2020 02:29:15 -0700 (PDT)
From: Daniel Vetter <daniel.vetter@ffwll.ch>
To: DRI Development <dri-devel@lists.freedesktop.org>
Subject: [PATCH] drm/fb-helper: Fix vt restore
Date: Wed, 24 Jun 2020 11:29:10 +0200
Message-Id: <20200624092910.3280448-1-daniel.vetter@ffwll.ch>
X-Mailer: git-send-email 2.27.0
In-Reply-To: <20200623155456.3092836-1-daniel.vetter@ffwll.ch>
References: <20200623155456.3092836-1-daniel.vetter@ffwll.ch>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: linux-fbdev@vger.kernel.org,
 Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>,
 David Airlie <airlied@linux.ie>, Daniel Vetter <daniel.vetter@ffwll.ch>,
 =?UTF-8?q?Michel=20D=C3=A4nzer?= <michel@daenzer.net>, shlomo@fastmail.com,
 Geert Uytterhoeven <geert@linux-m68k.org>, stable@vger.kernel.org,
 Thomas Zimmermann <tzimmermann@suse.de>,
 Daniel Vetter <daniel.vetter@intel.com>,
 Nathan Chancellor <natechancellor@gmail.com>, Peter Rosin <peda@axentia.se>,
 Qiujun Huang <hqjagain@gmail.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW4gdGhlIHBhc3Qgd2UgaGFkIGEgcGlsZSBvZiBoYWNrcyB0byBvcmNoZXN0cmF0ZSBhY2Nlc3Mg
YmV0d2VlbiBmYmRldgplbXVsYXRpb24gYW5kIG5hdGl2ZSBrbXMgY2xpZW50cy4gV2UndmUgdHJp
ZWQgdG8gc3RyZWFtbGluZSB0aGlzLCBieQphbHdheXMgcHJlZmVycmluZyB0aGUga21zIHNpZGUg
YWJvdmUgZmJkZXYgY2FsbHMgd2hlbiBhIGRybSBtYXN0ZXIKZXhpc3RzLCBiZWNhdXNlIGRybSBt
YXN0ZXIgY29udHJvbHMgYWNjZXNzIHRvIHRoZSBkaXNwbGF5IHJlc291cmNlcy4KClVuZm9ydHVu
YXRlbHkgdGhpcyBicmVha3MgZXhpc3RpbmcgdXNlcnNwYWNlLCBzcGVjaWZpY2FsbHkgWG9yZy4g
V2hlbgpleGl0aW5nIFhvcmcgZmlyc3QgcmVzdG9yZXMgdGhlIGNvbnNvbGUgdG8gdGV4dCBtb2Rl
IHVzaW5nIHRoZSBLRFNFVAppb2N0bCBvbiB0aGUgdnQuIFRoaXMgZG9lcyBub3RoaW5nLCBiZWNh
dXNlIGEgZHJtIG1hc3RlciBpcyBzdGlsbAphcm91bmQuIFRoZW4gaXQgZHJvcHMgdGhlIGRybSBt
YXN0ZXIgc3RhdHVzLCB3aGljaCBhZ2FpbiBkb2VzIG5vdGhpbmcsCmJlY2F1c2UgbG9naW5kIGlz
IGtlZXBpbmcgYWRkaXRpb25hbCBkcm0gZmQgb3BlbiB0byBiZSBhYmxlIHRvCm9yY2hlc3RyYXRl
IHZ0IHN3aXRjaGVzLiBJbiB0aGUgcGFzdCB0aGlzIGlzIHRoZSBwb2ludCB3aGVyZSBmYmRldiB3
YXMKcmVzdG9yZWQsIGFzIHBhcnQgb2YgdGhlIC0+bGFzdGNsb3NlIGhvb2sgb24gdGhlIGRybSBz
aWRlLgoKTm93IHRvIGZpeCB0aGlzIHJlZ3Jlc3Npb24gd2UgZG9uJ3Qgd2FudCB0byBnbyBiYWNr
IHRvIGxldHRpbmcgZmJkZXYKcmVzdG9yZSB0aGluZ3Mgd2hlbmV2ZXIgaXQgZmVlbHMgbGlrZSwg
b3IgdG8gdGhlIHBpbGUgb2YgaGFja3Mgd2UndmUKaGFkIGJlZm9yZS4gSW5zdGVhZCB0cnkgYW5k
IGdvIHdpdGggYSBtaW5pbWFsIGV4Y2VwdGlvbiB0byBtYWtlIHRoZQpLRFNFVCBjYXNlIHdvcmsg
YWdhaW4sIGFuZCBub3RoaW5nIGVsc2UuCgpUaGlzIG1lYW5zIHRoYXQgaWYgdXNlcnNwYWNlIGRv
ZXMgYSBLRFNFVCBjYWxsIHdoZW4gc3dpdGNoaW5nIGJldHdlZW4KZ3JhcGhpY2FsIGNvbXBvc2l0
b3JzLCB0aGVyZSB3aWxsIGJlIHNvbWUgZmxpY2tlcmluZyB3aXRoIGZiY29uCnNob3dpbmcgdXAg
Zm9yIGEgYml0LiBCdXQgYSkgdGhhdCdzIG5vdCBhIHJlZ3Jlc3Npb24gYW5kIGIpIHVzZXJzcGFj
ZQpjYW4gZml4IGl0IGJ5IGltcHJvdmluZyB0aGUgdnQgc3dpdGNoaW5nIGRhbmNlIC0gbG9naW5k
IHNob3VsZCBoYXZlCmFsbCB0aGUgaW5mb3JtYXRpb24gaXQgbmVlZHMuCgpXaGlsZSBwb25kZXJp
bmcgYWxsIHRoaXMgSSdtIGFsc28gd29uZGVyaW5nIHdoZXRlciB3ZSBzaG91bGQgaGF2ZSBhClNX
SVRDSF9NQVNURVIgaW9jdGwgdG8gYWxsb3cgcmFjZS1mcmVlIG1hc3RlciBzdGF0dXMgaGFuZG92
ZXIuIEJ1dAp0aGF0J3MgZm9yIGFub3RoZXIgZGF5LgoKdjI6IFNvbWVob3cgZm9yZ290IHRvIGNj
IGFsbCB0aGUgZmJkZXYgcGVvcGxlLgoKQnVnemlsbGE6IGh0dHBzOi8vYnVnemlsbGEua2VybmVs
Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MjA4MTc5CkNjOiBzaGxvbW9AZmFzdG1haWwuY29tClJlcG9y
dGVkLWFuZC1UZXN0ZWQtYnk6IHNobG9tb0BmYXN0bWFpbC5jb20KQ2M6IE1pY2hlbCBEw6RuemVy
IDxtaWNoZWxAZGFlbnplci5uZXQ+CkZpeGVzOiA2NDkxNGRhMjRlYTkgKCJkcm0vZmJkZXYtaGVs
cGVyOiBkb24ndCBmb3JjZSByZXN0b3JlcyIpCkNjOiBOb3JhbGYgVHLDuG5uZXMgPG5vcmFsZkB0
cm9ubmVzLm9yZz4KQ2M6IFRob21hcyBaaW1tZXJtYW5uIDx0emltbWVybWFubkBzdXNlLmRlPgpD
YzogRGFuaWVsIFZldHRlciA8ZGFuaWVsLnZldHRlckBpbnRlbC5jb20+CkNjOiBNYWFydGVuIExh
bmtob3JzdCA8bWFhcnRlbi5sYW5raG9yc3RAbGludXguaW50ZWwuY29tPgpDYzogTWF4aW1lIFJp
cGFyZCA8bXJpcGFyZEBrZXJuZWwub3JnPgpDYzogRGF2aWQgQWlybGllIDxhaXJsaWVkQGxpbnV4
LmllPgpDYzogRGFuaWVsIFZldHRlciA8ZGFuaWVsQGZmd2xsLmNoPgpDYzogZHJpLWRldmVsQGxp
c3RzLmZyZWVkZXNrdG9wLm9yZwpDYzogPHN0YWJsZUB2Z2VyLmtlcm5lbC5vcmc+ICMgdjUuNysK
Q2M6IEJhcnRsb21pZWogWm9sbmllcmtpZXdpY3ogPGIuem9sbmllcmtpZUBzYW1zdW5nLmNvbT4K
Q2M6IEdlZXJ0IFV5dHRlcmhvZXZlbiA8Z2VlcnRAbGludXgtbTY4ay5vcmc+CkNjOiBOYXRoYW4g
Q2hhbmNlbGxvciA8bmF0ZWNoYW5jZWxsb3JAZ21haWwuY29tPgpDYzogUWl1anVuIEh1YW5nIDxo
cWphZ2FpbkBnbWFpbC5jb20+CkNjOiBQZXRlciBSb3NpbiA8cGVkYUBheGVudGlhLnNlPgpDYzog
bGludXgtZmJkZXZAdmdlci5rZXJuZWwub3JnClNpZ25lZC1vZmYtYnk6IERhbmllbCBWZXR0ZXIg
PGRhbmllbC52ZXR0ZXJAaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9kcm1fZmJfaGVs
cGVyLmMgIHwgNjMgKysrKysrKysrKysrKysrKysrKysrKysrKy0tLS0tLS0KIGRyaXZlcnMvdmlk
ZW8vZmJkZXYvY29yZS9mYmNvbi5jIHwgIDMgKy0KIGluY2x1ZGUvdWFwaS9saW51eC9mYi5oICAg
ICAgICAgIHwgIDEgKwogMyBmaWxlcyBjaGFuZ2VkLCA1MiBpbnNlcnRpb25zKCspLCAxNSBkZWxl
dGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2ZiX2hlbHBlci5jIGIv
ZHJpdmVycy9ncHUvZHJtL2RybV9mYl9oZWxwZXIuYwppbmRleCAxNzBhYTc2ODkxMTAuLmFlNjli
ZjhlOWJjYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2RybV9mYl9oZWxwZXIuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vZHJtX2ZiX2hlbHBlci5jCkBAIC0yMjcsMTggKzIyNyw5IEBAIGlu
dCBkcm1fZmJfaGVscGVyX2RlYnVnX2xlYXZlKHN0cnVjdCBmYl9pbmZvICppbmZvKQogfQogRVhQ
T1JUX1NZTUJPTChkcm1fZmJfaGVscGVyX2RlYnVnX2xlYXZlKTsKIAotLyoqCi0gKiBkcm1fZmJf
aGVscGVyX3Jlc3RvcmVfZmJkZXZfbW9kZV91bmxvY2tlZCAtIHJlc3RvcmUgZmJkZXYgY29uZmln
dXJhdGlvbgotICogQGZiX2hlbHBlcjogZHJpdmVyLWFsbG9jYXRlZCBmYmRldiBoZWxwZXIsIGNh
biBiZSBOVUxMCi0gKgotICogVGhpcyBzaG91bGQgYmUgY2FsbGVkIGZyb20gZHJpdmVyJ3MgZHJt
ICZkcm1fZHJpdmVyLmxhc3RjbG9zZSBjYWxsYmFjawotICogd2hlbiBpbXBsZW1lbnRpbmcgYW4g
ZmJjb24gb24gdG9wIG9mIGttcyB1c2luZyB0aGlzIGhlbHBlci4gVGhpcyBlbnN1cmVzIHRoYXQK
LSAqIHRoZSB1c2VyIGlzbid0IGdyZWV0ZWQgd2l0aCBhIGJsYWNrIHNjcmVlbiB3aGVuIGUuZy4g
WCBkaWVzLgotICoKLSAqIFJFVFVSTlM6Ci0gKiBaZXJvIGlmIGV2ZXJ5dGhpbmcgd2VudCBvaywg
bmVnYXRpdmUgZXJyb3IgY29kZSBvdGhlcndpc2UuCi0gKi8KLWludCBkcm1fZmJfaGVscGVyX3Jl
c3RvcmVfZmJkZXZfbW9kZV91bmxvY2tlZChzdHJ1Y3QgZHJtX2ZiX2hlbHBlciAqZmJfaGVscGVy
KQorc3RhdGljIGludAorX19kcm1fZmJfaGVscGVyX3Jlc3RvcmVfZmJkZXZfbW9kZV91bmxvY2tl
ZChzdHJ1Y3QgZHJtX2ZiX2hlbHBlciAqZmJfaGVscGVyLAorCQkJCQkgICAgYm9vbCBmb3JjZSkK
IHsKIAlib29sIGRvX2RlbGF5ZWQ7CiAJaW50IHJldDsKQEAgLTI1MCw3ICsyNDEsMTYgQEAgaW50
IGRybV9mYl9oZWxwZXJfcmVzdG9yZV9mYmRldl9tb2RlX3VubG9ja2VkKHN0cnVjdCBkcm1fZmJf
aGVscGVyICpmYl9oZWxwZXIpCiAJCXJldHVybiAwOwogCiAJbXV0ZXhfbG9jaygmZmJfaGVscGVy
LT5sb2NrKTsKLQlyZXQgPSBkcm1fY2xpZW50X21vZGVzZXRfY29tbWl0KCZmYl9oZWxwZXItPmNs
aWVudCk7CisJaWYgKGZvcmNlKSB7CisJCS8qCisJCSAqIFllcyB0aGlzIGlzIHRoZSBfbG9ja2Vk
IHZlcnNpb24gd2hpY2ggZXhwZWN0cyB0aGUgbWFzdGVyIGxvY2sKKwkJICogdG8gYmUgaGVsZC4g
QnV0IGZvciBmb3JjZWQgcmVzdG9yZXMgd2UncmUgaW50ZW50aW9uYWxseQorCQkgKiByYWNpbmcg
aGVyZSwgc2VlIGRybV9mYl9oZWxwZXJfc2V0X3BhcigpLgorCQkgKi8KKwkJcmV0ID0gZHJtX2Ns
aWVudF9tb2Rlc2V0X2NvbW1pdF9sb2NrZWQoJmZiX2hlbHBlci0+Y2xpZW50KTsKKwl9IGVsc2Ug
eworCQlyZXQgPSBkcm1fY2xpZW50X21vZGVzZXRfY29tbWl0KCZmYl9oZWxwZXItPmNsaWVudCk7
CisJfQogCiAJZG9fZGVsYXllZCA9IGZiX2hlbHBlci0+ZGVsYXllZF9ob3RwbHVnOwogCWlmIChk
b19kZWxheWVkKQpAQCAtMjYyLDYgKzI2MiwyMiBAQCBpbnQgZHJtX2ZiX2hlbHBlcl9yZXN0b3Jl
X2ZiZGV2X21vZGVfdW5sb2NrZWQoc3RydWN0IGRybV9mYl9oZWxwZXIgKmZiX2hlbHBlcikKIAog
CXJldHVybiByZXQ7CiB9CisKKy8qKgorICogZHJtX2ZiX2hlbHBlcl9yZXN0b3JlX2ZiZGV2X21v
ZGVfdW5sb2NrZWQgLSByZXN0b3JlIGZiZGV2IGNvbmZpZ3VyYXRpb24KKyAqIEBmYl9oZWxwZXI6
IGRyaXZlci1hbGxvY2F0ZWQgZmJkZXYgaGVscGVyLCBjYW4gYmUgTlVMTAorICoKKyAqIFRoaXMg
c2hvdWxkIGJlIGNhbGxlZCBmcm9tIGRyaXZlcidzIGRybSAmZHJtX2RyaXZlci5sYXN0Y2xvc2Ug
Y2FsbGJhY2sKKyAqIHdoZW4gaW1wbGVtZW50aW5nIGFuIGZiY29uIG9uIHRvcCBvZiBrbXMgdXNp
bmcgdGhpcyBoZWxwZXIuIFRoaXMgZW5zdXJlcyB0aGF0CisgKiB0aGUgdXNlciBpc24ndCBncmVl
dGVkIHdpdGggYSBibGFjayBzY3JlZW4gd2hlbiBlLmcuIFggZGllcy4KKyAqCisgKiBSRVRVUk5T
OgorICogWmVybyBpZiBldmVyeXRoaW5nIHdlbnQgb2ssIG5lZ2F0aXZlIGVycm9yIGNvZGUgb3Ro
ZXJ3aXNlLgorICovCitpbnQgZHJtX2ZiX2hlbHBlcl9yZXN0b3JlX2ZiZGV2X21vZGVfdW5sb2Nr
ZWQoc3RydWN0IGRybV9mYl9oZWxwZXIgKmZiX2hlbHBlcikKK3sKKwlyZXR1cm4gX19kcm1fZmJf
aGVscGVyX3Jlc3RvcmVfZmJkZXZfbW9kZV91bmxvY2tlZChmYl9oZWxwZXIsIGZhbHNlKTsKK30K
IEVYUE9SVF9TWU1CT0woZHJtX2ZiX2hlbHBlcl9yZXN0b3JlX2ZiZGV2X21vZGVfdW5sb2NrZWQp
OwogCiAjaWZkZWYgQ09ORklHX01BR0lDX1NZU1JRCkBAIC0xMzE4LDYgKzEzMzQsNyBAQCBpbnQg
ZHJtX2ZiX2hlbHBlcl9zZXRfcGFyKHN0cnVjdCBmYl9pbmZvICppbmZvKQogewogCXN0cnVjdCBk
cm1fZmJfaGVscGVyICpmYl9oZWxwZXIgPSBpbmZvLT5wYXI7CiAJc3RydWN0IGZiX3Zhcl9zY3Jl
ZW5pbmZvICp2YXIgPSAmaW5mby0+dmFyOworCWJvb2wgZm9yY2U7CiAKIAlpZiAob29wc19pbl9w
cm9ncmVzcykKIAkJcmV0dXJuIC1FQlVTWTsKQEAgLTEzMjcsNyArMTM0NCwyNSBAQCBpbnQgZHJt
X2ZiX2hlbHBlcl9zZXRfcGFyKHN0cnVjdCBmYl9pbmZvICppbmZvKQogCQlyZXR1cm4gLUVJTlZB
TDsKIAl9CiAKLQlkcm1fZmJfaGVscGVyX3Jlc3RvcmVfZmJkZXZfbW9kZV91bmxvY2tlZChmYl9o
ZWxwZXIpOworCS8qCisJICogTm9ybWFsbHkgd2Ugd2FudCB0byBtYWtlIHN1cmUgdGhhdCBhIGtt
cyBtYXN0ZXIgdGFrZXMKKwkgKiBwcmVjZWRlbmNlIG92ZXIgZmJkZXYsIHRvIGF2b2lkIGZiZGV2
IGZsaWNrZXJpbmcgYW5kCisJICogb2NjYXNpb25hbGx5IHN0ZWFsaW5nIHRoZSBkaXNwbGF5IHN0
YXR1cy4gQnV0IFhvcmcgZmlyc3Qgc2V0cworCSAqIHRoZSB2dCBiYWNrIHRvIHRleHQgbW9kZSB1
c2luZyB0aGUgS0RTRVQgSU9DVEwgd2l0aCBLRF9URVhULAorCSAqIGFuZCBvbmx5IGFmdGVyIHRo
YXQgZHJvcHMgdGhlIG1hc3RlciBzdGF0dXMgd2hlbiBleGl0aW5nLgorCSAqCisJICogSW4gdGhl
IHBhc3QgdGhpcyB3YXMgY2F1Z2h0IGJ5IGRybV9mYl9oZWxwZXJfbGFzdGNsb3NlKCksIGJ1dAor
CSAqIG9uIG1vZGVybiBzeXN0ZW1zIHdoZXJlIGxvZ2luZCBhbHdheXMga2VlcHMgYSBkcm0gZmQg
b3BlbiB0bworCSAqIG9yY2hlc3RyYXRlIHRoZSB2dCBzd2l0Y2hpbmcsIHRoaXMgZG9lc24ndCB3
b3JrLgorCSAqCisJICogVG8gbm8gYnJlYWsgdGhlIHVzZXJzcGFjZSBBQkkgd2UgaGF2ZSB0aGlz
IHNwZWNpYWwgY2FzZSBoZXJlLAorCSAqIHdoaWNoIGlzIG9ubHkgdXNlZCBmb3IgdGhlIGFib3Zl
IGNhc2UuIEV2ZXJ5dGhpbmcgZWxzZSB1c2VzCisJICogdGhlIG5vcm1hbCBjb21taXQgZnVuY3Rp
b24sIHdoaWNoIGVuc3VyZXMgdGhhdCB3ZSBuZXZlciBzdGVhbAorCSAqIHRoZSBkaXNwbGF5IGZy
b20gYW4gYWN0aXZlIGRybSBtYXN0ZXIuCisJICovCisJZm9yY2UgPSB2YXItPmFjdGl2YXRlICYg
RkJfQUNUSVZBVEVfS0RfVEVYVDsKKworCV9fZHJtX2ZiX2hlbHBlcl9yZXN0b3JlX2ZiZGV2X21v
ZGVfdW5sb2NrZWQoZmJfaGVscGVyLCBmb3JjZSk7CiAKIAlyZXR1cm4gMDsKIH0KZGlmZiAtLWdp
dCBhL2RyaXZlcnMvdmlkZW8vZmJkZXYvY29yZS9mYmNvbi5jIGIvZHJpdmVycy92aWRlby9mYmRl
di9jb3JlL2ZiY29uLmMKaW5kZXggOWQyOGE4ZTMzMjhmLi5lMmE0OTBjNWFlMDggMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvdmlkZW8vZmJkZXYvY29yZS9mYmNvbi5jCisrKyBiL2RyaXZlcnMvdmlkZW8v
ZmJkZXYvY29yZS9mYmNvbi5jCkBAIC0yNDAyLDcgKzI0MDIsOCBAQCBzdGF0aWMgaW50IGZiY29u
X2JsYW5rKHN0cnVjdCB2Y19kYXRhICp2YywgaW50IGJsYW5rLCBpbnQgbW9kZV9zd2l0Y2gpCiAJ
CW9wcy0+Z3JhcGhpY3MgPSAxOwogCiAJCWlmICghYmxhbmspIHsKLQkJCXZhci5hY3RpdmF0ZSA9
IEZCX0FDVElWQVRFX05PVyB8IEZCX0FDVElWQVRFX0ZPUkNFOworCQkJdmFyLmFjdGl2YXRlID0g
RkJfQUNUSVZBVEVfTk9XIHwgRkJfQUNUSVZBVEVfRk9SQ0UgfAorCQkJCUZCX0FDVElWQVRFX0tE
X1RFWFQ7CiAJCQlmYl9zZXRfdmFyKGluZm8sICZ2YXIpOwogCQkJb3BzLT5ncmFwaGljcyA9IDA7
CiAJCQlvcHMtPnZhciA9IGluZm8tPnZhcjsKZGlmZiAtLWdpdCBhL2luY2x1ZGUvdWFwaS9saW51
eC9mYi5oIGIvaW5jbHVkZS91YXBpL2xpbnV4L2ZiLmgKaW5kZXggYjZhYWM3ZWUxZjY3Li40YzE0
ZThiZTcyNjcgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvdWFwaS9saW51eC9mYi5oCisrKyBiL2luY2x1
ZGUvdWFwaS9saW51eC9mYi5oCkBAIC0yMDUsNiArMjA1LDcgQEAgc3RydWN0IGZiX2JpdGZpZWxk
IHsKICNkZWZpbmUgRkJfQUNUSVZBVEVfQUxMCSAgICAgICA2NAkvKiBjaGFuZ2UgYWxsIFZDcyBv
biB0aGlzIGZiCSovCiAjZGVmaW5lIEZCX0FDVElWQVRFX0ZPUkNFICAgICAxMjgJLyogZm9yY2Ug
YXBwbHkgZXZlbiB3aGVuIG5vIGNoYW5nZSovCiAjZGVmaW5lIEZCX0FDVElWQVRFX0lOVl9NT0RF
ICAyNTYgICAgICAgLyogaW52YWxpZGF0ZSB2aWRlb21vZGUgKi8KKyNkZWZpbmUgRkJfQUNUSVZB
VEVfS0RfVEVYVCAgIDUxMiAgICAgICAvKiBmb3IgS0RTRVQgdnQgaW9jdGwgKi8KIAogI2RlZmlu
ZSBGQl9BQ0NFTEZfVEVYVAkJMQkvKiAoT0JTT0xFVEUpIHNlZSBmYl9pbmZvLmZsYWdzIGFuZCB2
Y19tb2RlICovCiAKLS0gCjIuMjcuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGlu
Zm8vZHJpLWRldmVsCg==
