Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 3BB29FF903
	for <lists+dri-devel@lfdr.de>; Sun, 17 Nov 2019 12:45:01 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0F24B6E312;
	Sun, 17 Nov 2019 11:44:41 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from bhuna.collabora.co.uk (bhuna.collabora.co.uk
 [IPv6:2a00:1098:0:82:1000:25:2eeb:e3e3])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8A5816E279
 for <dri-devel@lists.freedesktop.org>; Sun, 17 Nov 2019 07:11:02 +0000 (UTC)
Received: from [127.0.0.1] (localhost [127.0.0.1]) (Authenticated sender: sre)
 with ESMTPSA id 08EDE28FC58
Received: by earth.universe (Postfix, from userid 1000)
 id 3A37E3C0CAB; Sun, 17 Nov 2019 03:41:40 +0100 (CET)
From: Sebastian Reichel <sebastian.reichel@collabora.com>
To: Sebastian Reichel <sre@kernel.org>,
 Laurent Pinchart <laurent.pinchart@ideasonboard.com>,
 Tomi Valkeinen <tomi.valkeinen@ti.com>
Subject: [RFCv1 31/42] drm/omap: dsi: Reverse direction of the DSS device
 enable/disable operations
Date: Sun, 17 Nov 2019 03:40:17 +0100
Message-Id: <20191117024028.2233-32-sebastian.reichel@collabora.com>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191117024028.2233-1-sebastian.reichel@collabora.com>
References: <20191117024028.2233-1-sebastian.reichel@collabora.com>
MIME-Version: 1.0
X-Mailman-Approved-At: Sun, 17 Nov 2019 11:44:18 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: kernel@collabora.com, Tony Lindgren <tony@atomide.com>,
 "H. Nikolaus Schaller" <hns@goldelico.com>, Merlijn Wajer <merlijn@wizzup.org>,
 Sebastian Reichel <sebastian.reichel@collabora.com>,
 dri-devel@lists.freedesktop.org, linux-omap@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

Q29tcGxldGUgdGhlIGRpcmVjdGlvbiByZXZlcnNhbCBvZiB0aGUgRFNTIGRldmljZSBlbmFibGUv
ZGlzYWJsZQpvcGVyYXRpb25zIHN0YXJ0ZWQgYnkgMTliNDIwMGQ4ZjRiICgiZHJtL29tYXA6IFJl
dmVyc2UgZGlyZWN0aW9uCm9mIHRoZSBEU1MgZGV2aWNlIGVuYWJsZS9kaXNhYmxlIG9wZXJhdGlv
bnMiKS4KClRoaXMgZWZmZWN0aXZlbHkgZHJvcHMgdGhlIHJlcXVpcmVtZW50IG9mIGNhbGxpbmcg
RFNTIHNwZWNpZmljCmNvZGUgZnJvbSB0aGUgRFNJIHBhbmVsIGRyaXZlciBtb3ZpbmcgaXQgYSBi
aXQgZnVydGhlciB0byBhCnN0YW5kYXJkIGRybV9wYW5lbCBkcml2ZXIuCgpTaWduZWQtb2ZmLWJ5
OiBTZWJhc3RpYW4gUmVpY2hlbCA8c2ViYXN0aWFuLnJlaWNoZWxAY29sbGFib3JhLmNvbT4KLS0t
CiAuLi4vZ3B1L2RybS9vbWFwZHJtL2Rpc3BsYXlzL3BhbmVsLWRzaS1jbS5jICAgfCA3NSArKysr
KysrKysrLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vb21hcGRybS9vbWFwX2VuY29kZXIuYyAg
ICAgICAgfCAyMCArKy0tLQogMiBmaWxlcyBjaGFuZ2VkLCA0NCBpbnNlcnRpb25zKCspLCA1MSBk
ZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kaXNwbGF5
cy9wYW5lbC1kc2ktY20uYyBiL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL2Rpc3BsYXlzL3BhbmVs
LWRzaS1jbS5jCmluZGV4IDliZmMyNjJmNWM1YS4uMTgwMjBhYzQzYTgzIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vb21hcGRybS9kaXNwbGF5cy9wYW5lbC1kc2ktY20uYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vb21hcGRybS9kaXNwbGF5cy9wYW5lbC1kc2ktY20uYwpAQCAtMjg4LDI3ICsy
ODgsNiBAQCBzdGF0aWMgaW50IGRzaWNtX3Bvd2VyX29uKHN0cnVjdCBwYW5lbF9kcnZfZGF0YSAq
ZGRhdGEpCiAJc3RydWN0IG9tYXBfZHNzX2RldmljZSAqc3JjID0gZGRhdGEtPnNyYzsKIAl1OCBp
ZDEsIGlkMiwgaWQzOwogCWludCByOwotCXN0cnVjdCBvbWFwX2Rzc19kc2lfY29uZmlnIGRzaV9j
b25maWcgPSB7Ci0JCS52bSA9ICZkZGF0YS0+dm0sCi0JCS5oc19jbGtfbWluID0gMTUwMDAwMDAw
LAotCQkuaHNfY2xrX21heCA9IDMwMDAwMDAwMCwKLQkJLmxwX2Nsa19taW4gPSA3MDAwMDAwLAot
CQkubHBfY2xrX21heCA9IDEwMDAwMDAwLAotCX07Ci0KLQlyID0gcmVndWxhdG9yX2J1bGtfZW5h
YmxlKERDU19SRUdVTEFUT1JfU1VQUExZX05VTSwgZGRhdGEtPnN1cHBsaWVzKTsKLQlpZiAocikg
ewotCQlkZXZfZXJyKCZkZGF0YS0+ZHNpLT5kZXYsICJmYWlsZWQgdG8gZW5hYmxlIHN1cHBsaWVz
OiAlZFxuIiwgcik7Ci0JCXJldHVybiByOwotCX0KLQotCXIgPSBzcmMtPm9wcy0+ZHNpLnNldF9j
b25maWcoc3JjLCAmZHNpX2NvbmZpZyk7Ci0JaWYgKHIpIHsKLQkJZGV2X2VycigmZGRhdGEtPmRz
aS0+ZGV2LCAiZmFpbGVkIHRvIGNvbmZpZ3VyZSBEU0lcbiIpOwotCQlnb3RvIGVycl9yZWd1bGF0
b3JzOwotCX0KLQotCXNyYy0+b3BzLT5lbmFibGUoc3JjKTsKIAogCWRzaWNtX2h3X3Jlc2V0KGRk
YXRhKTsKIApAQCAtMzYzLDEyICszNDIsNiBAQCBzdGF0aWMgaW50IGRzaWNtX3Bvd2VyX29uKHN0
cnVjdCBwYW5lbF9kcnZfZGF0YSAqZGRhdGEpCiAKIAlkc2ljbV9od19yZXNldChkZGF0YSk7CiAK
LQlzcmMtPm9wcy0+ZGlzYWJsZShzcmMpOwotZXJyX3JlZ3VsYXRvcnM6Ci0JciA9IHJlZ3VsYXRv
cl9idWxrX2Rpc2FibGUoRENTX1JFR1VMQVRPUl9TVVBQTFlfTlVNLCBkZGF0YS0+c3VwcGxpZXMp
OwotCWlmIChyKQotCQlkZXZfZXJyKCZkZGF0YS0+ZHNpLT5kZXYsICJmYWlsZWQgdG8gZGlzYWJs
ZSBzdXBwbGllczogJWRcbiIsIHIpOwotCiAJcmV0dXJuIHI7CiB9CiAKQEAgLTM3Nyw2ICszNTAs
OCBAQCBzdGF0aWMgdm9pZCBkc2ljbV9wb3dlcl9vZmYoc3RydWN0IHBhbmVsX2Rydl9kYXRhICpk
ZGF0YSkKIAlzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpzcmMgPSBkZGF0YS0+c3JjOwogCWludCBy
OwogCisJZGRhdGEtPmVuYWJsZWQgPSAwOworCiAJc3JjLT5vcHMtPmRzaS5kaXNhYmxlX3ZpZGVv
X291dHB1dChzcmMsIGRkYXRhLT5kc2ktPmNoYW5uZWwpOwogCiAJciA9IG1pcGlfZHNpX2Rjc19z
ZXRfZGlzcGxheV9vZmYoZGRhdGEtPmRzaSk7CkBAIC0zODgsMTQgKzM2Myw2IEBAIHN0YXRpYyB2
b2lkIGRzaWNtX3Bvd2VyX29mZihzdHJ1Y3QgcGFuZWxfZHJ2X2RhdGEgKmRkYXRhKQogCQkJCSJl
cnJvciBkaXNhYmxpbmcgcGFuZWwsIGlzc3VpbmcgSFcgcmVzZXRcbiIpOwogCQlkc2ljbV9od19y
ZXNldChkZGF0YSk7CiAJfQotCi0Jc3JjLT5vcHMtPmRpc2FibGUoc3JjKTsKLQotCXIgPSByZWd1
bGF0b3JfYnVsa19kaXNhYmxlKERDU19SRUdVTEFUT1JfU1VQUExZX05VTSwgZGRhdGEtPnN1cHBs
aWVzKTsKLQlpZiAocikKLQkJZGV2X2VycigmZGRhdGEtPmRzaS0+ZGV2LCAiZmFpbGVkIHRvIGRp
c2FibGUgc3VwcGxpZXM6ICVkXG4iLCByKTsKLQotCWRkYXRhLT5lbmFibGVkID0gMDsKIH0KIAog
c3RhdGljIGludCBkc2ljbV9jb25uZWN0KHN0cnVjdCBvbWFwX2Rzc19kZXZpY2UgKnNyYywKQEAg
LTQxNSw2ICszODIsMzAgQEAgc3RhdGljIHZvaWQgZHNpY21fZGlzY29ubmVjdChzdHJ1Y3Qgb21h
cF9kc3NfZGV2aWNlICpzcmMsCiAJZGRhdGEtPnNyYyA9IE5VTEw7CiB9CiAKK3N0YXRpYyB2b2lk
IGRzaWNtX3ByZV9lbmFibGUoc3RydWN0IG9tYXBfZHNzX2RldmljZSAqZHNzZGV2KQoreworCXN0
cnVjdCBwYW5lbF9kcnZfZGF0YSAqZGRhdGEgPSB0b19wYW5lbF9kYXRhKGRzc2Rldik7CisJc3Ry
dWN0IG9tYXBfZHNzX2RldmljZSAqc3JjID0gZGRhdGEtPnNyYzsKKwlpbnQgcjsKKwlzdHJ1Y3Qg
b21hcF9kc3NfZHNpX2NvbmZpZyBkc2lfY29uZmlnID0geworCQkudm0gPSAmZGRhdGEtPnZtLAor
CQkuaHNfY2xrX21pbiA9IDE1MDAwMDAwMCwKKwkJLmhzX2Nsa19tYXggPSAzMDAwMDAwMDAsCisJ
CS5scF9jbGtfbWluID0gNzAwMDAwMCwKKwkJLmxwX2Nsa19tYXggPSAxMDAwMDAwMCwKKwl9Owor
CisJciA9IHJlZ3VsYXRvcl9idWxrX2VuYWJsZShEQ1NfUkVHVUxBVE9SX1NVUFBMWV9OVU0sIGRk
YXRhLT5zdXBwbGllcyk7CisJaWYgKHIpIHsKKwkJZGV2X2VycigmZGRhdGEtPmRzaS0+ZGV2LCAi
ZmFpbGVkIHRvIGVuYWJsZSBzdXBwbGllczogJWRcbiIsIHIpOworCX0KKworCXIgPSBzcmMtPm9w
cy0+ZHNpLnNldF9jb25maWcoc3JjLCAmZHNpX2NvbmZpZyk7CisJaWYgKHIpIHsKKwkJZGV2X2Vy
cigmZGRhdGEtPmRzaS0+ZGV2LCAiZmFpbGVkIHRvIGNvbmZpZ3VyZSBEU0lcbiIpOworCX0KK30K
Kwogc3RhdGljIHZvaWQgZHNpY21fZW5hYmxlKHN0cnVjdCBvbWFwX2Rzc19kZXZpY2UgKmRzc2Rl
dikKIHsKIAlzdHJ1Y3QgcGFuZWxfZHJ2X2RhdGEgKmRkYXRhID0gdG9fcGFuZWxfZGF0YShkc3Nk
ZXYpOwpAQCAtNDQ5LDYgKzQ0MCwxNiBAQCBzdGF0aWMgdm9pZCBkc2ljbV9kaXNhYmxlKHN0cnVj
dCBvbWFwX2Rzc19kZXZpY2UgKmRzc2RldikKIAltdXRleF91bmxvY2soJmRkYXRhLT5sb2NrKTsK
IH0KIAorc3RhdGljIHZvaWQgZHNpY21fcG9zdF9kaXNhYmxlKHN0cnVjdCBvbWFwX2Rzc19kZXZp
Y2UgKmRzc2RldikKK3sKKwlzdHJ1Y3QgcGFuZWxfZHJ2X2RhdGEgKmRkYXRhID0gdG9fcGFuZWxf
ZGF0YShkc3NkZXYpOworCWludCByOworCisJciA9IHJlZ3VsYXRvcl9idWxrX2Rpc2FibGUoRENT
X1JFR1VMQVRPUl9TVVBQTFlfTlVNLCBkZGF0YS0+c3VwcGxpZXMpOworCWlmIChyKQorCQlkZXZf
ZXJyKCZkZGF0YS0+ZHNpLT5kZXYsICJmYWlsZWQgdG8gZGlzYWJsZSBzdXBwbGllczogJWRcbiIs
IHIpOworfQorCiBzdGF0aWMgaW50IF9kc2ljbV9lbmFibGVfdGUoc3RydWN0IHBhbmVsX2Rydl9k
YXRhICpkZGF0YSwgYm9vbCBlbmFibGUpCiB7CiAJc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNp
ID0gZGRhdGEtPmRzaTsKQEAgLTUwMiw4ICs1MDMsMTAgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBv
bWFwX2Rzc19kZXZpY2Vfb3BzIGRzaWNtX29wcyA9IHsKIAkuY29ubmVjdAk9IGRzaWNtX2Nvbm5l
Y3QsCiAJLmRpc2Nvbm5lY3QJPSBkc2ljbV9kaXNjb25uZWN0LAogCisJLnByZV9lbmFibGUJPSBk
c2ljbV9wcmVfZW5hYmxlLAogCS5lbmFibGUJCT0gZHNpY21fZW5hYmxlLAogCS5kaXNhYmxlCT0g
ZHNpY21fZGlzYWJsZSwKKwkucG9zdF9kaXNhYmxlCT0gZHNpY21fcG9zdF9kaXNhYmxlLAogCiAJ
LmdldF9tb2Rlcwk9IGRzaWNtX2dldF9tb2RlcywKIAkuY2hlY2tfdGltaW5ncwk9IGRzaWNtX2No
ZWNrX3RpbWluZ3MsCkBAIC02NjYsOCArNjY5LDYgQEAgc3RhdGljIGludCBfX2V4aXQgZHNpY21f
cmVtb3ZlKHN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSkKIAogCW9tYXBkc3NfZGV2aWNlX3Vu
cmVnaXN0ZXIoZHNzZGV2KTsKIAotCWlmIChvbWFwZHNzX2RldmljZV9pc19lbmFibGVkKGRzc2Rl
dikpCi0JCWRzaWNtX2Rpc2FibGUoZHNzZGV2KTsKIAlvbWFwZHNzX2RldmljZV9kaXNjb25uZWN0
KGRkYXRhLT5zcmMsIGRzc2Rldik7CiAKIAlzeXNmc19yZW1vdmVfZ3JvdXAoJmRzaS0+ZGV2Lmtv
YmosICZkc2ljbV9hdHRyX2dyb3VwKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9vbWFw
ZHJtL29tYXBfZW5jb2Rlci5jIGIvZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vb21hcF9lbmNvZGVy
LmMKaW5kZXggMjRiYmU5ZjJhMzJlLi45OGY0ZGY0OGExZjMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9vbWFwZHJtL29tYXBfZW5jb2Rlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9vbWFw
ZHJtL29tYXBfZW5jb2Rlci5jCkBAIC0xNzEsMTQgKzE3MSwxMCBAQCBzdGF0aWMgdm9pZCBvbWFw
X2VuY29kZXJfZGlzYWJsZShzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIpCiAJb21hcGRzc19k
ZXZpY2VfZGlzYWJsZShkc3NkZXYtPm5leHQpOwogCiAJLyoKLQkgKiBEaXNhYmxlIHRoZSBpbnRl
cm5hbCBlbmNvZGVyLiBUaGlzIHdpbGwgZGlzYWJsZSB0aGUgRFNTIG91dHB1dC4gVGhlCi0JICog
RFNJIGlzIHRyZWF0ZWQgYXMgYW4gZXhjZXB0aW9uIGFzIERTSSBwaXBlbGluZXMgc3RpbGwgdXNl
IHRoZSBsZWdhY3kKLQkgKiBmbG93IHdoZXJlIHRoZSBwaXBlbGluZSBvdXRwdXQgY29udHJvbHMg
dGhlIGVuY29kZXIuCisJICogRGlzYWJsZSB0aGUgaW50ZXJuYWwgZW5jb2Rlci4gVGhpcyB3aWxs
IGRpc2FibGUgdGhlIERTUyBvdXRwdXQuCiAJICovCi0JaWYgKGRzc2Rldi0+dHlwZSAhPSBPTUFQ
X0RJU1BMQVlfVFlQRV9EU0kpIHsKLQkJZHNzZGV2LT5vcHMtPmRpc2FibGUoZHNzZGV2KTsKLQkJ
ZHNzZGV2LT5zdGF0ZSA9IE9NQVBfRFNTX0RJU1BMQVlfRElTQUJMRUQ7Ci0JfQorCWRzc2Rldi0+
b3BzLT5kaXNhYmxlKGRzc2Rldik7CisJZHNzZGV2LT5zdGF0ZSA9IE9NQVBfRFNTX0RJU1BMQVlf
RElTQUJMRUQ7CiAKIAkvKgogCSAqIFBlcmZvcm0gdGhlIHBvc3QtZGlzYWJsZSBvcGVyYXRpb25z
IG9uIHRoZSBjaGFpbiBvZiBleHRlcm5hbCBkZXZpY2VzCkBAIC0xOTksMTQgKzE5NSwxMCBAQCBz
dGF0aWMgdm9pZCBvbWFwX2VuY29kZXJfZW5hYmxlKHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2Rl
cikKIAlvbWFwZHNzX2RldmljZV9wcmVfZW5hYmxlKGRzc2Rldi0+bmV4dCk7CiAKIAkvKgotCSAq
IEVuYWJsZSB0aGUgaW50ZXJuYWwgZW5jb2Rlci4gVGhpcyB3aWxsIGVuYWJsZSB0aGUgRFNTIG91
dHB1dC4gVGhlCi0JICogRFNJIGlzIHRyZWF0ZWQgYXMgYW4gZXhjZXB0aW9uIGFzIERTSSBwaXBl
bGluZXMgc3RpbGwgdXNlIHRoZSBsZWdhY3kKLQkgKiBmbG93IHdoZXJlIHRoZSBwaXBlbGluZSBv
dXRwdXQgY29udHJvbHMgdGhlIGVuY29kZXIuCisJICogRW5hYmxlIHRoZSBpbnRlcm5hbCBlbmNv
ZGVyLiBUaGlzIHdpbGwgZW5hYmxlIHRoZSBEU1Mgb3V0cHV0LgogCSAqLwotCWlmIChkc3NkZXYt
PnR5cGUgIT0gT01BUF9ESVNQTEFZX1RZUEVfRFNJKSB7Ci0JCWRzc2Rldi0+b3BzLT5lbmFibGUo
ZHNzZGV2KTsKLQkJZHNzZGV2LT5zdGF0ZSA9IE9NQVBfRFNTX0RJU1BMQVlfQUNUSVZFOwotCX0K
Kwlkc3NkZXYtPm9wcy0+ZW5hYmxlKGRzc2Rldik7CisJZHNzZGV2LT5zdGF0ZSA9IE9NQVBfRFNT
X0RJU1BMQVlfQUNUSVZFOwogCiAJLyoKIAkgKiBFbmFibGUgdGhlIGNoYWluIG9mIGV4dGVybmFs
IGRldmljZXMsIHN0YXJ0aW5nIGF0IHRoZSBvbmUgYXQgdGhlCi0tIAoyLjI0LjAKCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5n
IGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVk
ZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
