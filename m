Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 018E71F1848
	for <lists+dri-devel@lfdr.de>; Mon,  8 Jun 2020 13:55:41 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0C0E289B78;
	Mon,  8 Jun 2020 11:55:39 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from bhuna.collabora.co.uk (bhuna.collabora.co.uk [46.235.227.227])
 by gabe.freedesktop.org (Postfix) with ESMTPS id DDC4B89B78
 for <dri-devel@lists.freedesktop.org>; Mon,  8 Jun 2020 11:55:37 +0000 (UTC)
Received: from [127.0.0.1] (localhost [127.0.0.1])
 (Authenticated sender: tomeu) with ESMTPSA id 7573F2A164C
Subject: Re: [PATCH 08/15] drm/panfrost: move devfreq_init()/fini() in device
To: =?UTF-8?B?Q2zDqW1lbnQgUMOpcm9u?= <peron.clem@gmail.com>,
 Steven Price <steven.price@arm.com>
References: <20200510165538.19720-1-peron.clem@gmail.com>
 <20200510165538.19720-9-peron.clem@gmail.com>
 <3ca4dd51-d868-0d6a-d4ca-37af572190bd@arm.com>
 <CAJiuCceH-wOHc7wEEtmd+CC==QgqK1nOG6YB389Gs=+0t8i=wg@mail.gmail.com>
From: Tomeu Vizoso <tomeu.vizoso@collabora.com>
Message-ID: <8cdb1fdc-fc40-7880-8fd1-bed2bfdb16a6@collabora.com>
Date: Mon, 8 Jun 2020 13:55:32 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.2.2
MIME-Version: 1.0
In-Reply-To: <CAJiuCceH-wOHc7wEEtmd+CC==QgqK1nOG6YB389Gs=+0t8i=wg@mail.gmail.com>
Content-Language: en-US
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Nishanth Menon <nm@ti.com>, Stephen Boyd <sboyd@kernel.org>,
 Viresh Kumar <vireshk@kernel.org>, dri-devel <dri-devel@lists.freedesktop.org>,
 linux-kernel <linux-kernel@vger.kernel.org>, Chen-Yu Tsai <wens@csie.org>,
 Alyssa Rosenzweig <alyssa.rosenzweig@collabora.com>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gNS8yOS8yMCAyOjM4IFBNLCBDbMOpbWVudCBQw6lyb24gd3JvdGU6Cj4gSGkgU3RldmVuCj4g
Cj4gT24gVGh1LCAyOCBNYXkgMjAyMCBhdCAxNToyMiwgU3RldmVuIFByaWNlIDxzdGV2ZW4ucHJp
Y2VAYXJtLmNvbT4gd3JvdGU6Cj4+Cj4+IE9uIDEwLzA1LzIwMjAgMTc6NTUsIENsw6ltZW50IFDD
qXJvbiB3cm90ZToKPj4+IExhdGVyIHdlIHdpbGwgaW50cm9kdWNlIGRldmZyZXEgcHJvYmluZyBy
ZWd1bGF0b3IgaWYgdGhleQo+Pj4gYXJlIHByZXNlbnQuIEFzIHJlZ3VsYXRvciBzaG91bGQgYmUg
cHJvYmUgb25seSBvbmUgdGltZSB3ZQo+Pj4gbmVlZCB0byBnZXQgdGhpcyBsb2dpYyBpbiB0aGUg
ZGV2aWNlX2luaXQoKS4KPj4+Cj4+PiBwYW5mcm9zdF9kZXZpY2UgaXMgYWxyZWFkeSB0YWtpbmcg
Y2FyZSBvZiBkZXZmcmVxX3Jlc3VtZSgpCj4+PiBhbmQgZGV2ZnJlcV9zdXNwZW5kKCksIHNvIGl0
J3Mgbm90IHRvdGFsbHkgaWxsb2dpYyB0byBtb3ZlCj4+PiB0aGUgZGV2ZnJlcV9pbml0KCkgYW5k
IGRldmZyZXFfZmluaSgpIGhlcmUuCj4+Pgo+Pj4gU2lnbmVkLW9mZi1ieTogQ2zDqW1lbnQgUMOp
cm9uIDxwZXJvbi5jbGVtQGdtYWlsLmNvbT4KPj4+IC0tLQo+Pj4gICAgZHJpdmVycy9ncHUvZHJt
L3BhbmZyb3N0L3BhbmZyb3N0X2RldmljZS5jIHwgMzcgKysrKysrKysrKysrKystLS0tLS0tLQo+
Pj4gICAgZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2Rydi5jICAgIHwgMTUgKyst
LS0tLS0tCj4+PiAgICAyIGZpbGVzIGNoYW5nZWQsIDI1IGluc2VydGlvbnMoKyksIDI3IGRlbGV0
aW9ucygtKQo+Pj4KPj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFu
ZnJvc3RfZGV2aWNlLmMgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZGV2aWNl
LmMKPj4+IGluZGV4IDgxMzZiYWJkM2JhOS4uZjQ4MDEyNzIwNWQ2IDEwMDY0NAo+Pj4gLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2RldmljZS5jCj4+PiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZGV2aWNlLmMKPj4+IEBAIC0yMTIsNTkgKzIx
Miw2NyBAQCBpbnQgcGFuZnJvc3RfZGV2aWNlX2luaXQoc3RydWN0IHBhbmZyb3N0X2RldmljZSAq
cGZkZXYpCj4+PiAgICAgICAgICAgICAgICByZXR1cm4gZXJyOwo+Pj4gICAgICAgIH0KPj4+Cj4+
PiArICAgICBlcnIgPSBwYW5mcm9zdF9kZXZmcmVxX2luaXQocGZkZXYpOwo+Pj4gKyAgICAgaWYg
KGVycikgewo+Pj4gKyAgICAgICAgICAgICBkZXZfZXJyKHBmZGV2LT5kZXYsICJkZXZmcmVxIGlu
aXQgZmFpbGVkICVkXG4iLCBlcnIpOwo+Pj4gKyAgICAgICAgICAgICBnb3RvIGVycl9vdXQwOwo+
Pj4gKyAgICAgfQo+Pj4gKwo+Pj4gICAgICAgIGVyciA9IHBhbmZyb3N0X3JlZ3VsYXRvcl9pbml0
KHBmZGV2KTsKPj4+ICAgICAgICBpZiAoZXJyKSB7Cj4+PiAgICAgICAgICAgICAgICBkZXZfZXJy
KHBmZGV2LT5kZXYsICJyZWd1bGF0b3IgaW5pdCBmYWlsZWQgJWRcbiIsIGVycik7Cj4+PiAtICAg
ICAgICAgICAgIGdvdG8gZXJyX291dDA7Cj4+PiArICAgICAgICAgICAgIGdvdG8gZXJyX291dDE7
Cj4+Cj4+IE5JVDogUmF0aGVyIHRoYW4ganVzdCByZW51bWJlcmluZyB0aGVzZSBjYW4gd2UgZ2l2
ZSB0aGVtIHNlbnNpYmxlIG5hbWVzCj4+IHNvIHdlIGRvbid0IGhhdmUgdGhpcyBzb3J0IG9mIHJl
ZmFjdG9yaW5nIGluIGZ1dHVyZT8KPiAKPiBBZ3JlZSwgSSB3aWxsIGNoYW5nZSB0aGF0IGluIHYy
CgpGV0lXLCB0aGVyZSdzIGEgc2Vuc2libGUgYXBwcm9hY2ggZGVzY3JpYmVkIGluIApEb2N1bWVu
dGF0aW9uL3Byb2Nlc3MvY29kaW5nLXN0eWxlLnJzdCAoIjcpIENlbnRyYWxpemVkIGV4aXRpbmcg
b2YgCmZ1bmN0aW9ucyIpLgoKUmVnYXJkcywKClRvbWV1Cgo+IAo+Pgo+Pj4gICAgICAgIH0KPj4+
Cj4+PiAgICAgICAgZXJyID0gcGFuZnJvc3RfcmVzZXRfaW5pdChwZmRldik7Cj4+PiAgICAgICAg
aWYgKGVycikgewo+Pj4gICAgICAgICAgICAgICAgZGV2X2VycihwZmRldi0+ZGV2LCAicmVzZXQg
aW5pdCBmYWlsZWQgJWRcbiIsIGVycik7Cj4+PiAtICAgICAgICAgICAgIGdvdG8gZXJyX291dDE7
Cj4+PiArICAgICAgICAgICAgIGdvdG8gZXJyX291dDI7Cj4+PiAgICAgICAgfQo+Pj4KPj4+ICAg
ICAgICBlcnIgPSBwYW5mcm9zdF9wbV9kb21haW5faW5pdChwZmRldik7Cj4+PiAgICAgICAgaWYg
KGVycikKPj4+IC0gICAgICAgICAgICAgZ290byBlcnJfb3V0MjsKPj4+ICsgICAgICAgICAgICAg
Z290byBlcnJfb3V0MzsKPj4+Cj4+PiAgICAgICAgcmVzID0gcGxhdGZvcm1fZ2V0X3Jlc291cmNl
KHBmZGV2LT5wZGV2LCBJT1JFU09VUkNFX01FTSwgMCk7Cj4+PiAgICAgICAgcGZkZXYtPmlvbWVt
ID0gZGV2bV9pb3JlbWFwX3Jlc291cmNlKHBmZGV2LT5kZXYsIHJlcyk7Cj4+PiAgICAgICAgaWYg
KElTX0VSUihwZmRldi0+aW9tZW0pKSB7Cj4+PiAgICAgICAgICAgICAgICBkZXZfZXJyKHBmZGV2
LT5kZXYsICJmYWlsZWQgdG8gaW9yZW1hcCBpb21lbVxuIik7Cj4+PiAgICAgICAgICAgICAgICBl
cnIgPSBQVFJfRVJSKHBmZGV2LT5pb21lbSk7Cj4+PiAtICAgICAgICAgICAgIGdvdG8gZXJyX291
dDM7Cj4+PiArICAgICAgICAgICAgIGdvdG8gZXJyX291dDQ7Cj4+PiAgICAgICAgfQo+Pj4KPj4+
ICAgICAgICBlcnIgPSBwYW5mcm9zdF9ncHVfaW5pdChwZmRldik7Cj4+PiAgICAgICAgaWYgKGVy
cikKPj4+IC0gICAgICAgICAgICAgZ290byBlcnJfb3V0MzsKPj4+ICsgICAgICAgICAgICAgZ290
byBlcnJfb3V0NDsKPj4+Cj4+PiAgICAgICAgZXJyID0gcGFuZnJvc3RfbW11X2luaXQocGZkZXYp
Owo+Pj4gICAgICAgIGlmIChlcnIpCj4+PiAtICAgICAgICAgICAgIGdvdG8gZXJyX291dDQ7Cj4+
PiArICAgICAgICAgICAgIGdvdG8gZXJyX291dDU7Cj4+Pgo+Pj4gICAgICAgIGVyciA9IHBhbmZy
b3N0X2pvYl9pbml0KHBmZGV2KTsKPj4+ICAgICAgICBpZiAoZXJyKQo+Pj4gLSAgICAgICAgICAg
ICBnb3RvIGVycl9vdXQ1Owo+Pj4gKyAgICAgICAgICAgICBnb3RvIGVycl9vdXQ2Owo+Pj4KPj4+
ICAgICAgICBlcnIgPSBwYW5mcm9zdF9wZXJmY250X2luaXQocGZkZXYpOwo+Pj4gICAgICAgIGlm
IChlcnIpCj4+PiAtICAgICAgICAgICAgIGdvdG8gZXJyX291dDY7Cj4+PiArICAgICAgICAgICAg
IGdvdG8gZXJyX291dDc7Cj4+Pgo+Pj4gICAgICAgIHJldHVybiAwOwo+Pj4gLWVycl9vdXQ2Ogo+
Pj4gK2Vycl9vdXQ3Ogo+Pj4gICAgICAgIHBhbmZyb3N0X2pvYl9maW5pKHBmZGV2KTsKPj4+IC1l
cnJfb3V0NToKPj4+ICtlcnJfb3V0NjoKPj4+ICAgICAgICBwYW5mcm9zdF9tbXVfZmluaShwZmRl
dik7Cj4+PiAtZXJyX291dDQ6Cj4+PiArZXJyX291dDU6Cj4+PiAgICAgICAgcGFuZnJvc3RfZ3B1
X2ZpbmkocGZkZXYpOwo+Pj4gLWVycl9vdXQzOgo+Pj4gK2Vycl9vdXQ0Ogo+Pj4gICAgICAgIHBh
bmZyb3N0X3BtX2RvbWFpbl9maW5pKHBmZGV2KTsKPj4+IC1lcnJfb3V0MjoKPj4+ICtlcnJfb3V0
MzoKPj4+ICAgICAgICBwYW5mcm9zdF9yZXNldF9maW5pKHBmZGV2KTsKPj4+IC1lcnJfb3V0MToK
Pj4+ICtlcnJfb3V0MjoKPj4+ICAgICAgICBwYW5mcm9zdF9yZWd1bGF0b3JfZmluaShwZmRldik7
Cj4+PiArZXJyX291dDE6Cj4+PiArICAgICBwYW5mcm9zdF9kZXZmcmVxX2ZpbmkocGZkZXYpOwo+
Pj4gICAgZXJyX291dDA6Cj4+PiAgICAgICAgcGFuZnJvc3RfY2xrX2ZpbmkocGZkZXYpOwo+Pj4g
ICAgICAgIHJldHVybiBlcnI7Cj4+PiBAQCAtMjc4LDYgKzI4Niw3IEBAIHZvaWQgcGFuZnJvc3Rf
ZGV2aWNlX2Zpbmkoc3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYpCj4+PiAgICAgICAgcGFu
ZnJvc3RfZ3B1X2ZpbmkocGZkZXYpOwo+Pj4gICAgICAgIHBhbmZyb3N0X3BtX2RvbWFpbl9maW5p
KHBmZGV2KTsKPj4+ICAgICAgICBwYW5mcm9zdF9yZXNldF9maW5pKHBmZGV2KTsKPj4+ICsgICAg
IHBhbmZyb3N0X2RldmZyZXFfZmluaShwZmRldik7Cj4+PiAgICAgICAgcGFuZnJvc3RfcmVndWxh
dG9yX2ZpbmkocGZkZXYpOwo+Pj4gICAgICAgIHBhbmZyb3N0X2Nsa19maW5pKHBmZGV2KTsKPj4+
ICAgIH0KPj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3Rf
ZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZHJ2LmMKPj4+IGluZGV4
IDg4MmZlY2MzM2ZkYi4uNGRkYTY4Njg5MDE1IDEwMDY0NAo+Pj4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2Rydi5jCj4+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vcGFu
ZnJvc3QvcGFuZnJvc3RfZHJ2LmMKPj4+IEBAIC0xNCw3ICsxNCw2IEBACj4+PiAgICAjaW5jbHVk
ZSA8ZHJtL2RybV91dGlscy5oPgo+Pj4KPj4+ICAgICNpbmNsdWRlICJwYW5mcm9zdF9kZXZpY2Uu
aCIKPj4+IC0jaW5jbHVkZSAicGFuZnJvc3RfZGV2ZnJlcS5oIgo+Pj4gICAgI2luY2x1ZGUgInBh
bmZyb3N0X2dlbS5oIgo+Pj4gICAgI2luY2x1ZGUgInBhbmZyb3N0X21tdS5oIgo+Pj4gICAgI2lu
Y2x1ZGUgInBhbmZyb3N0X2pvYi5oIgo+Pj4gQEAgLTYwNiwxMyArNjA1LDYgQEAgc3RhdGljIGlu
dCBwYW5mcm9zdF9wcm9iZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQo+Pj4gICAgICAg
ICAgICAgICAgZ290byBlcnJfb3V0MDsKPj4+ICAgICAgICB9Cj4+Pgo+Pj4gLSAgICAgZXJyID0g
cGFuZnJvc3RfZGV2ZnJlcV9pbml0KHBmZGV2KTsKPj4+IC0gICAgIGlmIChlcnIpIHsKPj4+IC0g
ICAgICAgICAgICAgaWYgKGVyciAhPSAtRVBST0JFX0RFRkVSKQo+Pj4gLSAgICAgICAgICAgICAg
ICAgICAgIGRldl9lcnIoJnBkZXYtPmRldiwgIkZhdGFsIGVycm9yIGR1cmluZyBkZXZmcmVxIGlu
aXRcbiIpOwo+Pgo+PiBZb3Ugc2VlbSB0byBoYXZlIGxvc3QgdGhlIGNoZWNrIGZvciBFUFJPQkVf
REVGRVIgZHVyaW5nIHRoZSBtb3ZlLgo+IAo+IENvcnJlY3QsIHNvcnJ5IGZvciB0aGF0LCBJIHdp
bGwgZml4IGl0IGluIHYyLgo+IAo+IFRoYW5rcyBmb3IgeW91ciByZXZpZXcsCj4gQ2xlbWVudAo+
IAo+Pgo+Pj4gLSAgICAgICAgICAgICBnb3RvIGVycl9vdXQxOwo+Pj4gLSAgICAgfQo+Pj4gLQo+
Pj4gICAgICAgIHBtX3J1bnRpbWVfc2V0X2FjdGl2ZShwZmRldi0+ZGV2KTsKPj4+ICAgICAgICBw
bV9ydW50aW1lX21hcmtfbGFzdF9idXN5KHBmZGV2LT5kZXYpOwo+Pj4gICAgICAgIHBtX3J1bnRp
bWVfZW5hYmxlKHBmZGV2LT5kZXYpOwo+Pj4gQEAgLTYyNSwxNiArNjE3LDE0IEBAIHN0YXRpYyBp
bnQgcGFuZnJvc3RfcHJvYmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKPj4+ICAgICAg
ICAgKi8KPj4+ICAgICAgICBlcnIgPSBkcm1fZGV2X3JlZ2lzdGVyKGRkZXYsIDApOwo+Pj4gICAg
ICAgIGlmIChlcnIgPCAwKQo+Pj4gLSAgICAgICAgICAgICBnb3RvIGVycl9vdXQyOwo+Pj4gKyAg
ICAgICAgICAgICBnb3RvIGVycl9vdXQxOwo+Pj4KPj4+ICAgICAgICBwYW5mcm9zdF9nZW1fc2hy
aW5rZXJfaW5pdChkZGV2KTsKPj4+Cj4+PiAgICAgICAgcmV0dXJuIDA7Cj4+Pgo+Pj4gLWVycl9v
dXQyOgo+Pj4gLSAgICAgcG1fcnVudGltZV9kaXNhYmxlKHBmZGV2LT5kZXYpOwo+Pj4gLSAgICAg
cGFuZnJvc3RfZGV2ZnJlcV9maW5pKHBmZGV2KTsKPj4+ICAgIGVycl9vdXQxOgo+Pj4gKyAgICAg
cG1fcnVudGltZV9kaXNhYmxlKHBmZGV2LT5kZXYpOwo+Pj4gICAgICAgIHBhbmZyb3N0X2Rldmlj
ZV9maW5pKHBmZGV2KTsKPj4+ICAgIGVycl9vdXQwOgo+Pj4gICAgICAgIGRybV9kZXZfcHV0KGRk
ZXYpOwo+Pj4gQEAgLTY1MCw3ICs2NDAsNiBAQCBzdGF0aWMgaW50IHBhbmZyb3N0X3JlbW92ZShz
dHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQo+Pj4gICAgICAgIHBhbmZyb3N0X2dlbV9zaHJp
bmtlcl9jbGVhbnVwKGRkZXYpOwo+Pj4KPj4+ICAgICAgICBwbV9ydW50aW1lX2dldF9zeW5jKHBm
ZGV2LT5kZXYpOwo+Pj4gLSAgICAgcGFuZnJvc3RfZGV2ZnJlcV9maW5pKHBmZGV2KTsKPj4+ICAg
ICAgICBwYW5mcm9zdF9kZXZpY2VfZmluaShwZmRldik7Cj4+PiAgICAgICAgcG1fcnVudGltZV9w
dXRfc3luY19zdXNwZW5kKHBmZGV2LT5kZXYpOwo+Pj4gICAgICAgIHBtX3J1bnRpbWVfZGlzYWJs
ZShwZmRldi0+ZGV2KTsKPj4+Cj4+Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVk
ZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZv
L2RyaS1kZXZlbAo=
