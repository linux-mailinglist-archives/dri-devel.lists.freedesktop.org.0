Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 9A6F6262EF
	for <lists+dri-devel@lfdr.de>; Wed, 22 May 2019 13:28:54 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6940589991;
	Wed, 22 May 2019 11:28:52 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ot1-x344.google.com (mail-ot1-x344.google.com
 [IPv6:2607:f8b0:4864:20::344])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8391E898CE
 for <dri-devel@lists.freedesktop.org>; Wed, 22 May 2019 11:28:51 +0000 (UTC)
Received: by mail-ot1-x344.google.com with SMTP id 66so1744422otq.0
 for <dri-devel@lists.freedesktop.org>; Wed, 22 May 2019 04:28:51 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc:content-transfer-encoding;
 bh=7JsXve/OVyi2syait6wCOUiga50nR+kwiXWswPUIZpo=;
 b=PzoxSc35xW2mKPmYvMQ9SEj+dExyUHev7pmUWCk3kv9JwHd1EMWQ0JpQv7qpaHIhUw
 ZwywDL/0luRYyN2jvL62CWpoUtOeJqejUWv6n2/Srk3vUX7/HBenp34bNy+8sE95YjYk
 TPQlJD/5P/1YzmciM67UdgFcLMyeH33DdUIZk6VHOLz1qzYA898SIUfWLhSuPtPT+etC
 BYX+0hJLY5dKqTEZaj/TSkuyw24t0u407nXtEODC0L2umu2AqNCacD0Vnt8087QhuvnP
 Rd6LisC2kGrHp5KvttPC00r8ON1Ma8jXysoOAFajTOIIDowQOgOUONerN9qCzAdvRiac
 i/Pg==
X-Gm-Message-State: APjAAAVfVMebDJEN20Y1QQFWJpbX7I14AN8H5IkNFCLKy2GgRlz32Q2m
 kejyRvQmcPCuFDa80uMHaUsoykrx0CUR/axAZlJOAw==
X-Google-Smtp-Source: APXvYqxX0C2yoSrFK1huVIAFyTGghXeDCmLzOVvCViAVGQx4e36jDYJro7V22+LOQBnbzzR/whLbxVcyCL13ltniWD0=
X-Received: by 2002:a9d:7414:: with SMTP id n20mr4785046otk.106.1558524530672; 
 Wed, 22 May 2019 04:28:50 -0700 (PDT)
MIME-Version: 1.0
References: <20190515143831.1639-1-christian.koenig@amd.com>
In-Reply-To: <20190515143831.1639-1-christian.koenig@amd.com>
From: Daniel Vetter <daniel@ffwll.ch>
Date: Wed, 22 May 2019 13:28:39 +0200
Message-ID: <CAKMK7uEtNcK-BxKTYufDfDqan781HGcqg1HaqSAp2V+B4erN4Q@mail.gmail.com>
Subject: Re: [PATCH 1/6] dma-buf: add dynamic DMA-buf handling v8
To: =?UTF-8?Q?Christian_K=C3=B6nig?= <ckoenig.leichtzumerken@gmail.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ffwll.ch; s=google;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc:content-transfer-encoding;
 bh=7JsXve/OVyi2syait6wCOUiga50nR+kwiXWswPUIZpo=;
 b=DRk1RpVt9CyAsw/9N0EbYa0X3dLSo1LdYn5X8dd0ufpxuzEfka9AYIcDxTYaIxFzKV
 pbxFMOb0+ejfInRlaEsi8mjaG4Il35MvMcU6fTrQZYyxwI6j6PsPfCskQSQXYePVFvWk
 EGN+vPFapprXFxNJ07nMOpFKQqOG9B+LAF6I8=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: dri-devel <dri-devel@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gV2VkLCBNYXkgMTUsIDIwMTkgYXQgNDozOCBQTSBDaHJpc3RpYW4gS8O2bmlnCjxja29lbmln
LmxlaWNodHp1bWVya2VuQGdtYWlsLmNvbT4gd3JvdGU6Cj4KPiBPbiB0aGUgZXhwb3J0ZXIgc2lk
ZSB3ZSBhZGQgb3B0aW9uYWwgZXhwbGljaXQgcGlubmluZyBjYWxsYmFja3MuIElmIHRob3NlCj4g
Y2FsbGJhY2tzIGFyZSBpbXBsZW1lbnRlZCB0aGUgZnJhbWV3b3JrIG5vIGxvbmdlciBjYWNoZXMg
c2cgdGFibGVzIGFuZCB0aGUKPiBtYXAvdW5tYXAgY2FsbGJhY2tzIGFyZSBhbHdheXMgY2FsbGVk
IHdpdGggdGhlIGxvY2sgb2YgdGhlIHJlc2VydmF0aW9uIG9iamVjdAo+IGhlbGQuCj4KPiBPbiB0
aGUgaW1wb3J0ZXIgc2lkZSB3ZSBhZGQgYW4gb3B0aW9uYWwgaW52YWxpZGF0ZSBjYWxsYmFjay4g
VGhpcyBjYWxsYmFjayBpcwo+IHVzZWQgYnkgdGhlIGV4cG9ydGVyIHRvIGluZm9ybSB0aGUgaW1w
b3J0ZXJzIHRoYXQgdGhlaXIgbWFwcGluZ3Mgc2hvdWxkIGJlCj4gZGVzdHJveWVkIGFzIHNvb24g
YXMgcG9zc2libGUuCj4KPiBUaGlzIGFsbG93cyB0aGUgZXhwb3J0ZXIgdG8gcHJvdmlkZSB0aGUg
bWFwcGluZ3Mgd2l0aG91dCB0aGUgbmVlZCB0byBwaW4KPiB0aGUgYmFja2luZyBzdG9yZS4KPgo+
IHYyOiBkb24ndCB0cnkgdG8gaW52YWxpZGF0ZSBtYXBwaW5ncyB3aGVuIHRoZSBjYWxsYmFjayBp
cyBOVUxMLAo+ICAgICBsb2NrIHRoZSByZXNlcnZhdGlvbiBvYmogd2hpbGUgdXNpbmcgdGhlIGF0
dGFjaG1lbnRzLAo+ICAgICBhZGQgaGVscGVyIHRvIHNldCB0aGUgY2FsbGJhY2sKPiB2MzogbW92
ZSBmbGFnIGZvciBpbnZhbGlkYXRpb24gc3VwcG9ydCBpbnRvIHRoZSBETUEtYnVmLAo+ICAgICB1
c2UgbmV3IGF0dGFjaF9pbmZvIHN0cnVjdHVyZSB0byBzZXQgdGhlIGNhbGxiYWNrCj4gdjQ6IHVz
ZSBpbXBvcnRlcl9wcml2IGZpZWxkIGluc3RlYWQgb2YgbWFuZ2xpbmcgZXhwb3J0ZXIgcHJpdi4K
PiB2NTogZHJvcCBpbnZhbGlkYXRpb25fc3VwcG9ydGVkIGZsYWcKPiB2Njogc3F1YXNoIHRvZ2V0
aGVyIHdpdGggcGluL3VucGluIGNoYW5nZXMKPiB2NzogcGluL3VucGluIHRha2VzIGFuIGF0dGFj
aG1lbnQgbm93Cj4gdjg6IG51a2UgZG1hX2J1Zl9hdHRhY2htZW50XyhtYXB8dW5tYXApX2xvY2tl
ZCwKPiAgICAgZXZlcnl0aGluZyBpcyBub3cgaGFuZGxlZCBiYWNrd2FyZCBjb21wYXRpYmxlCj4K
PiBTaWduZWQtb2ZmLWJ5OiBDaHJpc3RpYW4gS8O2bmlnIDxjaHJpc3RpYW4ua29lbmlnQGFtZC5j
b20+Cj4gLS0tCj4gIGRyaXZlcnMvZG1hLWJ1Zi9kbWEtYnVmLmMgfCAxNTcgKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrLS0KPiAgaW5jbHVkZS9saW51eC9kbWEtYnVmLmggICB8
IDEwOSArKysrKysrKysrKysrKysrKysrKysrKystLQo+ICAyIGZpbGVzIGNoYW5nZWQsIDI1MyBp
bnNlcnRpb25zKCspLCAxMyBkZWxldGlvbnMoLSkKPgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2Rt
YS1idWYvZG1hLWJ1Zi5jIGIvZHJpdmVycy9kbWEtYnVmL2RtYS1idWYuYwo+IGluZGV4IGEyZDM0
YzZiODBhNS4uODUwMjZkOWU5NzhkIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9kbWEt
YnVmLmMKPiArKysgYi9kcml2ZXJzL2RtYS1idWYvZG1hLWJ1Zi5jCj4gQEAgLTQwOSw2ICs0MDks
OSBAQCBzdHJ1Y3QgZG1hX2J1ZiAqZG1hX2J1Zl9leHBvcnQoY29uc3Qgc3RydWN0IGRtYV9idWZf
ZXhwb3J0X2luZm8gKmV4cF9pbmZvKQo+ICAgICAgICAgICAgICAgICByZXR1cm4gRVJSX1BUUigt
RUlOVkFMKTsKPiAgICAgICAgIH0KPgo+ICsgICAgICAgaWYgKFdBUk5fT04oZXhwX2luZm8tPm9w
cy0+Y2FjaGVfc2d0X21hcHBpbmcgJiYgZXhwX2luZm8tPm9wcy0+cGluKSkKPiArICAgICAgICAg
ICAgICAgcmV0dXJuIEVSUl9QVFIoLUVJTlZBTCk7Cj4gKwo+ICAgICAgICAgaWYgKCF0cnlfbW9k
dWxlX2dldChleHBfaW5mby0+b3duZXIpKQo+ICAgICAgICAgICAgICAgICByZXR1cm4gRVJSX1BU
UigtRU5PRU5UKTsKPgo+IEBAIC01MzAsMTAgKzUzMywxMiBAQCB2b2lkIGRtYV9idWZfcHV0KHN0
cnVjdCBkbWFfYnVmICpkbWFidWYpCj4gIEVYUE9SVF9TWU1CT0xfR1BMKGRtYV9idWZfcHV0KTsK
Pgo+ICAvKioKPiAtICogZG1hX2J1Zl9hdHRhY2ggLSBBZGQgdGhlIGRldmljZSB0byBkbWFfYnVm
J3MgYXR0YWNobWVudHMgbGlzdDsgb3B0aW9uYWxseSwKPiArICogZG1hX2J1Zl9keW5hbWljX2F0
dGFjaCAtIEFkZCB0aGUgZGV2aWNlIHRvIGRtYV9idWYncyBhdHRhY2htZW50cyBsaXN0OyBvcHRp
b25hbGx5LAo+ICAgKiBjYWxscyBhdHRhY2goKSBvZiBkbWFfYnVmX29wcyB0byBhbGxvdyBkZXZp
Y2Utc3BlY2lmaWMgYXR0YWNoIGZ1bmN0aW9uYWxpdHkKPiAtICogQGRtYWJ1ZjogICAgW2luXSAg
ICBidWZmZXIgdG8gYXR0YWNoIGRldmljZSB0by4KPiAtICogQGRldjogICAgICAgW2luXSAgICBk
ZXZpY2UgdG8gYmUgYXR0YWNoZWQuCj4gKyAqIEBkbWFidWY6ICAgICAgICAgICAgW2luXSAgICBi
dWZmZXIgdG8gYXR0YWNoIGRldmljZSB0by4KPiArICogQGRldjogICAgICAgICAgICAgICBbaW5d
ICAgIGRldmljZSB0byBiZSBhdHRhY2hlZC4KPiArICogQGltcG9ydGVyX29wcyAgICAgICBbaW5d
ICAgIGltcG9ydGVyIG9wZXJhdGlvbnMgZm9yIHRoZSBhdHRhY2htZW50Cj4gKyAqIEBpbXBvcnRl
cl9wcml2ICAgICAgW2luXSAgICBpbXBvcnRlciBwcml2YXRlIHBvaW50ZXIgZm9yIHRoZSBhdHRh
Y2htZW50Cj4gICAqCj4gICAqIFJldHVybnMgc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCBwb2lu
dGVyIGZvciB0aGlzIGF0dGFjaG1lbnQuIEF0dGFjaG1lbnRzCj4gICAqIG11c3QgYmUgY2xlYW5l
ZCB1cCBieSBjYWxsaW5nIGRtYV9idWZfZGV0YWNoKCkuCj4gQEAgLTU0Nyw4ICs1NTIsMTAgQEAg
RVhQT1JUX1NZTUJPTF9HUEwoZG1hX2J1Zl9wdXQpOwo+ICAgKiBhY2Nlc3NpYmxlIHRvIEBkZXYs
IGFuZCBjYW5ub3QgYmUgbW92ZWQgdG8gYSBtb3JlIHN1aXRhYmxlIHBsYWNlLiBUaGlzIGlzCj4g
ICAqIGluZGljYXRlZCB3aXRoIHRoZSBlcnJvciBjb2RlIC1FQlVTWS4KPiAgICovCj4gLXN0cnVj
dCBkbWFfYnVmX2F0dGFjaG1lbnQgKmRtYV9idWZfYXR0YWNoKHN0cnVjdCBkbWFfYnVmICpkbWFi
dWYsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGRl
dmljZSAqZGV2KQo+ICtzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICoKPiArZG1hX2J1Zl9keW5h
bWljX2F0dGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmLCBzdHJ1Y3QgZGV2aWNlICpkZXYsCj4g
KyAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2hfb3BzICpp
bXBvcnRlcl9vcHMsCj4gKyAgICAgICAgICAgICAgICAgICAgICB2b2lkICppbXBvcnRlcl9wcml2
KQo+ICB7Cj4gICAgICAgICBzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICphdHRhY2g7Cj4gICAg
ICAgICBpbnQgcmV0Owo+IEBAIC01NjIsNiArNTY5LDggQEAgc3RydWN0IGRtYV9idWZfYXR0YWNo
bWVudCAqZG1hX2J1Zl9hdHRhY2goc3RydWN0IGRtYV9idWYgKmRtYWJ1ZiwKPgo+ICAgICAgICAg
YXR0YWNoLT5kZXYgPSBkZXY7Cj4gICAgICAgICBhdHRhY2gtPmRtYWJ1ZiA9IGRtYWJ1ZjsKPiAr
ICAgICAgIGF0dGFjaC0+aW1wb3J0ZXJfb3BzID0gaW1wb3J0ZXJfb3BzOwo+ICsgICAgICAgYXR0
YWNoLT5pbXBvcnRlcl9wcml2ID0gaW1wb3J0ZXJfcHJpdjsKPgo+ICAgICAgICAgbXV0ZXhfbG9j
aygmZG1hYnVmLT5sb2NrKTsKPgo+IEBAIC01NzAsMTAgKzU3OSwzMSBAQCBzdHJ1Y3QgZG1hX2J1
Zl9hdHRhY2htZW50ICpkbWFfYnVmX2F0dGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmLAo+ICAg
ICAgICAgICAgICAgICBpZiAocmV0KQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gZXJy
X2F0dGFjaDsKPiAgICAgICAgIH0KPiArICAgICAgIHJlc2VydmF0aW9uX29iamVjdF9sb2NrKGRt
YWJ1Zi0+cmVzdiwgTlVMTCk7Cj4gICAgICAgICBsaXN0X2FkZCgmYXR0YWNoLT5ub2RlLCAmZG1h
YnVmLT5hdHRhY2htZW50cyk7Cj4gKyAgICAgICByZXNlcnZhdGlvbl9vYmplY3RfdW5sb2NrKGRt
YWJ1Zi0+cmVzdik7Cj4KPiAgICAgICAgIG11dGV4X3VubG9jaygmZG1hYnVmLT5sb2NrKTsKPgo+
ICsgICAgICAgLyogV2hlbiB0aGUgaW1wb3J0ZXIgaXMgZHluYW1pYyBidXQgdGhlIGV4cG9ydGVy
IGlzbid0IHdlIG5lZWQgdG8gY2FjaGUKPiArICAgICAgICAqIHRoZSBtYXBwaW5nIG9yIG90aGVy
d2lzZSB3b3VsZCBydW4gaW50byBpc3N1ZXMgd2l0aCB0aGUgcmVzZXJ2YXRpb24KPiArICAgICAg
ICAqIG9iamVjdCBsb2NrLgo+ICsgICAgICAgICovCj4gKyAgICAgICBpZiAoZG1hX2J1Zl9hdHRh
Y2htZW50X2lzX2R5bmFtaWMoYXR0YWNoKSAmJgo+ICsgICAgICAgICAgICFkbWFfYnVmX2lzX2R5
bmFtaWMoZG1hYnVmKSkgewo+ICsgICAgICAgICAgICAgICBzdHJ1Y3Qgc2dfdGFibGUgKnNndDsK
PiArCj4gKyAgICAgICAgICAgICAgIHNndCA9IGRtYWJ1Zi0+b3BzLT5tYXBfZG1hX2J1ZihhdHRh
Y2gsIERNQV9CSURJUkVDVElPTkFMKTsKPiArICAgICAgICAgICAgICAgaWYgKCFzZ3QpCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgc2d0ID0gRVJSX1BUUigtRU5PTUVNKTsKPiArICAgICAgICAg
ICAgICAgaWYgKElTX0VSUihzZ3QpKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgZG1hX2J1
Zl9kZXRhY2goZG1hYnVmLCBhdHRhY2gpOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIHJldHVy
biBFUlJfQ0FTVChzZ3QpOwo+ICsgICAgICAgICAgICAgICB9Cj4gKyAgICAgICAgICAgICAgIGF0
dGFjaC0+c2d0ID0gc2d0Owo+ICsgICAgICAgICAgICAgICBhdHRhY2gtPmRpciA9IERNQV9CSURJ
UkVDVElPTkFMOwo+ICsgICAgICAgfQo+ICsKPiAgICAgICAgIHJldHVybiBhdHRhY2g7Cj4KPiAg
ZXJyX2F0dGFjaDoKPiBAQCAtNTgxLDYgKzYxMSwyMSBAQCBzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2ht
ZW50ICpkbWFfYnVmX2F0dGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmLAo+ICAgICAgICAgbXV0
ZXhfdW5sb2NrKCZkbWFidWYtPmxvY2spOwo+ICAgICAgICAgcmV0dXJuIEVSUl9QVFIocmV0KTsK
PiAgfQo+ICtFWFBPUlRfU1lNQk9MX0dQTChkbWFfYnVmX2R5bmFtaWNfYXR0YWNoKTsKPiArCj4g
Ky8qKgo+ICsgKiBkbWFfYnVmX2F0dGFjaCAtIFdyYXBwZXIgZm9yIGRtYV9idWZfZHluYW1pY19h
dHRhY2gKPiArICogQGRtYWJ1ZjogICAgW2luXSAgICBidWZmZXIgdG8gYXR0YWNoIGRldmljZSB0
by4KPiArICogQGRldjogICAgICAgW2luXSAgICBkZXZpY2UgdG8gYmUgYXR0YWNoZWQuCj4gKyAq
Cj4gKyAqIFdyYXBwZXIgdG8gY2FsbCBkbWFfYnVmX2R5bmFtaWNfYXR0YWNoKCkgZm9yIGRyaXZl
cnMgd2hpY2ggc3RpbGwgdXNlIGEgc3RhdGljCj4gKyAqIG1hcHBpbmcuCj4gKyAqLwo+ICtzdHJ1
Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICpkbWFfYnVmX2F0dGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZG1h
YnVmLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBk
ZXZpY2UgKmRldikKPiArewo+ICsgICAgICAgcmV0dXJuIGRtYV9idWZfZHluYW1pY19hdHRhY2go
ZG1hYnVmLCBkZXYsIE5VTEwsIE5VTEwpOwo+ICt9Cj4gIEVYUE9SVF9TWU1CT0xfR1BMKGRtYV9i
dWZfYXR0YWNoKTsKPgo+ICAvKioKPiBAQCAtNjAwLDcgKzY0NSw5IEBAIHZvaWQgZG1hX2J1Zl9k
ZXRhY2goc3RydWN0IGRtYV9idWYgKmRtYWJ1Ziwgc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCAq
YXR0YWNoKQo+ICAgICAgICAgICAgICAgICBkbWFidWYtPm9wcy0+dW5tYXBfZG1hX2J1ZihhdHRh
Y2gsIGF0dGFjaC0+c2d0LCBhdHRhY2gtPmRpcik7Cj4KPiAgICAgICAgIG11dGV4X2xvY2soJmRt
YWJ1Zi0+bG9jayk7Cj4gKyAgICAgICByZXNlcnZhdGlvbl9vYmplY3RfbG9jayhkbWFidWYtPnJl
c3YsIE5VTEwpOwo+ICAgICAgICAgbGlzdF9kZWwoJmF0dGFjaC0+bm9kZSk7Cj4gKyAgICAgICBy
ZXNlcnZhdGlvbl9vYmplY3RfdW5sb2NrKGRtYWJ1Zi0+cmVzdik7Cj4gICAgICAgICBpZiAoZG1h
YnVmLT5vcHMtPmRldGFjaCkKPiAgICAgICAgICAgICAgICAgZG1hYnVmLT5vcHMtPmRldGFjaChk
bWFidWYsIGF0dGFjaCk7Cj4KPiBAQCAtNjA5LDYgKzY1Niw0NCBAQCB2b2lkIGRtYV9idWZfZGV0
YWNoKHN0cnVjdCBkbWFfYnVmICpkbWFidWYsIHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0
dGFjaCkKPiAgfQo+ICBFWFBPUlRfU1lNQk9MX0dQTChkbWFfYnVmX2RldGFjaCk7Cj4KPiArLyoq
Cj4gKyAqIGRtYV9idWZfcGluIC0gTG9jayBkb3duIHRoZSBETUEtYnVmCj4gKyAqCj4gKyAqIEBh
dHRhY2g6ICAgIFtpbl0gICAgYXR0YWNobWVudCB3aGljaCBzaG91bGQgYmUgcGlubmVkCj4gKyAq
Cj4gKyAqIFJldHVybnM6Cj4gKyAqIDAgb24gc3VjY2VzcywgbmVnYXRpdmUgZXJyb3IgY29kZSBv
biBmYWlsdXJlLgo+ICsgKi8KPiAraW50IGRtYV9idWZfcGluKHN0cnVjdCBkbWFfYnVmX2F0dGFj
aG1lbnQgKmF0dGFjaCkKPiArewo+ICsgICAgICAgc3RydWN0IGRtYV9idWYgKmRtYWJ1ZiA9IGF0
dGFjaC0+ZG1hYnVmOwo+ICsgICAgICAgaW50IHJldCA9IDA7Cj4gKwo+ICsgICAgICAgcmVzZXJ2
YXRpb25fb2JqZWN0X2Fzc2VydF9oZWxkKGRtYWJ1Zi0+cmVzdik7Cj4gKwo+ICsgICAgICAgaWYg
KGRtYWJ1Zi0+b3BzLT5waW4pCj4gKyAgICAgICAgICAgICAgIHJldCA9IGRtYWJ1Zi0+b3BzLT5w
aW4oYXR0YWNoKTsKPiArCj4gKyAgICAgICByZXR1cm4gcmV0Owo+ICt9Cj4gK0VYUE9SVF9TWU1C
T0xfR1BMKGRtYV9idWZfcGluKTsKPiArCj4gKy8qKgo+ICsgKiBkbWFfYnVmX3VucGluIC0gUmVt
b3ZlIGxvY2sgZnJvbSBETUEtYnVmCj4gKyAqCj4gKyAqIEBhdHRhY2g6ICAgIFtpbl0gICAgYXR0
YWNobWVudCB3aGljaCBzaG91bGQgYmUgdW5waW5uZWQKPiArICovCj4gK3ZvaWQgZG1hX2J1Zl91
bnBpbihzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICphdHRhY2gpCj4gK3sKPiArICAgICAgIHN0
cnVjdCBkbWFfYnVmICpkbWFidWYgPSBhdHRhY2gtPmRtYWJ1ZjsKPiArCj4gKyAgICAgICByZXNl
cnZhdGlvbl9vYmplY3RfYXNzZXJ0X2hlbGQoZG1hYnVmLT5yZXN2KTsKPiArCj4gKyAgICAgICBp
ZiAoZG1hYnVmLT5vcHMtPnVucGluKQo+ICsgICAgICAgICAgICAgICBkbWFidWYtPm9wcy0+dW5w
aW4oYXR0YWNoKTsKPiArfQo+ICtFWFBPUlRfU1lNQk9MX0dQTChkbWFfYnVmX3VucGluKTsKPiAr
Cj4gIC8qKgo+ICAgKiBkbWFfYnVmX21hcF9hdHRhY2htZW50IC0gUmV0dXJucyB0aGUgc2NhdHRl
cmxpc3QgdGFibGUgb2YgdGhlIGF0dGFjaG1lbnQ7Cj4gICAqIG1hcHBlZCBpbnRvIF9kZXZpY2Vf
IGFkZHJlc3Mgc3BhY2UuIElzIGEgd3JhcHBlciBmb3IgbWFwX2RtYV9idWYoKSBvZiB0aGUKPiBA
QCAtNjI4LDYgKzcxMyw3IEBAIHN0cnVjdCBzZ190YWJsZSAqZG1hX2J1Zl9tYXBfYXR0YWNobWVu
dChzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICphdHRhY2gsCj4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGVudW0gZG1hX2RhdGFfZGlyZWN0aW9uIGRpcmVjdGlvbikK
PiAgewo+ICAgICAgICAgc3RydWN0IHNnX3RhYmxlICpzZ190YWJsZTsKPiArICAgICAgIGludCBy
Owo+Cj4gICAgICAgICBtaWdodF9zbGVlcCgpOwo+Cj4gQEAgLTY0NiwxMCArNzMyLDM4IEBAIHN0
cnVjdCBzZ190YWJsZSAqZG1hX2J1Zl9tYXBfYXR0YWNobWVudChzdHJ1Y3QgZG1hX2J1Zl9hdHRh
Y2htZW50ICphdHRhY2gsCj4gICAgICAgICAgICAgICAgIHJldHVybiBhdHRhY2gtPnNndDsKPiAg
ICAgICAgIH0KPgo+ICsgICAgICAgaWYgKGRtYV9idWZfYXR0YWNobWVudF9pc19keW5hbWljKGF0
dGFjaCkpIHsKPiArICAgICAgICAgICAgICAgcmVzZXJ2YXRpb25fb2JqZWN0X2Fzc2VydF9oZWxk
KGF0dGFjaC0+ZG1hYnVmLT5yZXN2KTsKPiArCj4gKyAgICAgICAgICAgICAgIC8qCj4gKyAgICAg
ICAgICAgICAgICAqIE1hcHBpbmcgYSBETUEtYnVmIGNhbiB0cmlnZ2VyIGl0cyBpbnZhbGlkYXRp
b24sIHByZXZlbnQKPiArICAgICAgICAgICAgICAgICogc2VuZGluZyB0aGlzIGV2ZW50IHRvIHRo
ZSBjYWxsZXIgYnkgdGVtcG9yYXJ5IHJlbW92aW5nCj4gKyAgICAgICAgICAgICAgICAqIHRoaXMg
YXR0YWNobWVudCBmcm9tIHRoZSBsaXN0Lgo+ICsgICAgICAgICAgICAgICAgKi8KPiArICAgICAg
ICAgICAgICAgbGlzdF9kZWwoJmF0dGFjaC0+bm9kZSk7CgpEaWQgeW91IHNlZSBteSByZXBseSBp
biBhbiBlYXJsaWVyIHZlcnNpb24gYWJvdXQgbWFwIHZzLiBpbnZhbGlkYXRlLAphbmQgc29tZSBp
ZGVhcyBmb3IgcmVzb2x2aW5nIHRoYXQ/IEkgc3RpbGwgZG9uJ3QgcmVhbGx5IGxpa2UgdGhpcyBo
YWNrCmhlcmUuCi1EYW5pZWwKCj4gKwo+ICsgICAgICAgfSBlbHNlIGlmIChkbWFfYnVmX2lzX2R5
bmFtaWMoYXR0YWNoLT5kbWFidWYpKSB7Cj4gKyAgICAgICAgICAgICAgIHJlc2VydmF0aW9uX29i
amVjdF9sb2NrKGF0dGFjaC0+ZG1hYnVmLT5yZXN2LCBOVUxMKTsKPiArICAgICAgICAgICAgICAg
ciA9IGRtYV9idWZfcGluKGF0dGFjaCk7Cj4gKyAgICAgICAgICAgICAgIGlmIChyKSB7Cj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgcmVzZXJ2YXRpb25fb2JqZWN0X3VubG9jayhhdHRhY2gtPmRt
YWJ1Zi0+cmVzdik7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEVSUl9QVFIocik7
Cj4gKyAgICAgICAgICAgICAgIH0KPiArICAgICAgIH0KPiArCj4gICAgICAgICBzZ190YWJsZSA9
IGF0dGFjaC0+ZG1hYnVmLT5vcHMtPm1hcF9kbWFfYnVmKGF0dGFjaCwgZGlyZWN0aW9uKTsKPiAg
ICAgICAgIGlmICghc2dfdGFibGUpCj4gICAgICAgICAgICAgICAgIHNnX3RhYmxlID0gRVJSX1BU
UigtRU5PTUVNKTsKPgo+ICsgICAgICAgaWYgKGRtYV9idWZfYXR0YWNobWVudF9pc19keW5hbWlj
KGF0dGFjaCkpIHsKPiArICAgICAgICAgICAgICAgbGlzdF9hZGQoJmF0dGFjaC0+bm9kZSwgJmF0
dGFjaC0+ZG1hYnVmLT5hdHRhY2htZW50cyk7Cj4gKwo+ICsgICAgICAgfSBlbHNlIGlmIChkbWFf
YnVmX2lzX2R5bmFtaWMoYXR0YWNoLT5kbWFidWYpKSB7Cj4gKyAgICAgICAgICAgICAgIGlmIChJ
U19FUlIoc2dfdGFibGUpKQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGRtYV9idWZfdW5waW4o
YXR0YWNoKTsKPiArICAgICAgICAgICAgICAgcmVzZXJ2YXRpb25fb2JqZWN0X3VubG9jayhhdHRh
Y2gtPmRtYWJ1Zi0+cmVzdik7Cj4gKyAgICAgICB9Cj4gKwo+ICAgICAgICAgaWYgKCFJU19FUlIo
c2dfdGFibGUpICYmIGF0dGFjaC0+ZG1hYnVmLT5vcHMtPmNhY2hlX3NndF9tYXBwaW5nKSB7Cj4g
ICAgICAgICAgICAgICAgIGF0dGFjaC0+c2d0ID0gc2dfdGFibGU7Cj4gICAgICAgICAgICAgICAg
IGF0dGFjaC0+ZGlyID0gZGlyZWN0aW9uOwo+IEBAIC02ODEsMTAgKzc5NSw0MSBAQCB2b2lkIGRt
YV9idWZfdW5tYXBfYXR0YWNobWVudChzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICphdHRhY2gs
Cj4gICAgICAgICBpZiAoYXR0YWNoLT5zZ3QgPT0gc2dfdGFibGUpCj4gICAgICAgICAgICAgICAg
IHJldHVybjsKPgo+ICsgICAgICAgaWYgKGRtYV9idWZfYXR0YWNobWVudF9pc19keW5hbWljKGF0
dGFjaCkpCj4gKyAgICAgICAgICAgICAgIHJlc2VydmF0aW9uX29iamVjdF9hc3NlcnRfaGVsZChh
dHRhY2gtPmRtYWJ1Zi0+cmVzdik7Cj4gKyAgICAgICBlbHNlIGlmIChkbWFfYnVmX2lzX2R5bmFt
aWMoYXR0YWNoLT5kbWFidWYpKQo+ICsgICAgICAgICAgICAgICByZXNlcnZhdGlvbl9vYmplY3Rf
bG9jayhhdHRhY2gtPmRtYWJ1Zi0+cmVzdiwgTlVMTCk7Cj4gKwo+ICAgICAgICAgYXR0YWNoLT5k
bWFidWYtPm9wcy0+dW5tYXBfZG1hX2J1ZihhdHRhY2gsIHNnX3RhYmxlLCBkaXJlY3Rpb24pOwo+
ICsKPiArICAgICAgIGlmIChkbWFfYnVmX2lzX2R5bmFtaWMoYXR0YWNoLT5kbWFidWYpICYmCj4g
KyAgICAgICAgICAgIWRtYV9idWZfYXR0YWNobWVudF9pc19keW5hbWljKGF0dGFjaCkpIHsKPiAr
ICAgICAgICAgICAgICAgZG1hX2J1Zl91bnBpbihhdHRhY2gpOwo+ICsgICAgICAgICAgICAgICBy
ZXNlcnZhdGlvbl9vYmplY3RfdW5sb2NrKGF0dGFjaC0+ZG1hYnVmLT5yZXN2KTsKPiArICAgICAg
IH0KPiAgfQo+ICBFWFBPUlRfU1lNQk9MX0dQTChkbWFfYnVmX3VubWFwX2F0dGFjaG1lbnQpOwo+
Cj4gKy8qKgo+ICsgKiBkbWFfYnVmX2ludmFsaWRhdGVfbWFwcGluZ3MgLSBpbnZhbGlkYXRlIGFs
bCBtYXBwaW5ncyBvZiB0aGlzIGRtYV9idWYKPiArICoKPiArICogQGRtYWJ1ZjogICAgW2luXSAg
ICBidWZmZXIgd2hpY2ggbWFwcGluZ3Mgc2hvdWxkIGJlIGludmFsaWRhdGVkCj4gKyAqCj4gKyAq
IEluZm9ybXMgYWxsIGF0dGFjaG1lbnN0IHRoYXQgdGhleSBuZWVkIHRvIGRlc3Ryb3kgYW5kIHJl
Y3JlYXRlZCBhbGwgdGhlaXIKPiArICogbWFwcGluZ3MuCj4gKyAqLwo+ICt2b2lkIGRtYV9idWZf
aW52YWxpZGF0ZV9tYXBwaW5ncyhzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmKQo+ICt7Cj4gKyAgICAg
ICBzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICphdHRhY2g7Cj4gKwo+ICsgICAgICAgcmVzZXJ2
YXRpb25fb2JqZWN0X2Fzc2VydF9oZWxkKGRtYWJ1Zi0+cmVzdik7Cj4gKwo+ICsgICAgICAgbGlz
dF9mb3JfZWFjaF9lbnRyeShhdHRhY2gsICZkbWFidWYtPmF0dGFjaG1lbnRzLCBub2RlKQo+ICsg
ICAgICAgICAgICAgICBpZiAoYXR0YWNoLT5pbXBvcnRlcl9vcHMgJiYgYXR0YWNoLT5pbXBvcnRl
cl9vcHMtPmludmFsaWRhdGUpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgYXR0YWNoLT5pbXBv
cnRlcl9vcHMtPmludmFsaWRhdGUoYXR0YWNoKTsKPiArfQo+ICtFWFBPUlRfU1lNQk9MX0dQTChk
bWFfYnVmX2ludmFsaWRhdGVfbWFwcGluZ3MpOwo+ICsKPiAgLyoqCj4gICAqIERPQzogY3B1IGFj
Y2Vzcwo+ICAgKgo+IEBAIC0xMDk3LDEwICsxMjQyLDEyIEBAIHN0YXRpYyBpbnQgZG1hX2J1Zl9k
ZWJ1Z19zaG93KHN0cnVjdCBzZXFfZmlsZSAqcywgdm9pZCAqdW51c2VkKQo+ICAgICAgICAgICAg
ICAgICBzZXFfcHV0cyhzLCAiXHRBdHRhY2hlZCBEZXZpY2VzOlxuIik7Cj4gICAgICAgICAgICAg
ICAgIGF0dGFjaF9jb3VudCA9IDA7Cj4KPiArICAgICAgICAgICAgICAgcmVzZXJ2YXRpb25fb2Jq
ZWN0X2xvY2soYnVmX29iai0+cmVzdiwgTlVMTCk7Cj4gICAgICAgICAgICAgICAgIGxpc3RfZm9y
X2VhY2hfZW50cnkoYXR0YWNoX29iaiwgJmJ1Zl9vYmotPmF0dGFjaG1lbnRzLCBub2RlKSB7Cj4g
ICAgICAgICAgICAgICAgICAgICAgICAgc2VxX3ByaW50ZihzLCAiXHQlc1xuIiwgZGV2X25hbWUo
YXR0YWNoX29iai0+ZGV2KSk7Cj4gICAgICAgICAgICAgICAgICAgICAgICAgYXR0YWNoX2NvdW50
Kys7Cj4gICAgICAgICAgICAgICAgIH0KPiArICAgICAgICAgICAgICAgcmVzZXJ2YXRpb25fb2Jq
ZWN0X3VubG9jayhidWZfb2JqLT5yZXN2KTsKPgo+ICAgICAgICAgICAgICAgICBzZXFfcHJpbnRm
KHMsICJUb3RhbCAlZCBkZXZpY2VzIGF0dGFjaGVkXG5cbiIsCj4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBhdHRhY2hfY291bnQpOwo+IGRpZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4
L2RtYS1idWYuaCBiL2luY2x1ZGUvbGludXgvZG1hLWJ1Zi5oCj4gaW5kZXggNDViOTc2N2U2N2Vj
Li41MzA5ZjFjZWFlZmUgMTAwNjQ0Cj4gLS0tIGEvaW5jbHVkZS9saW51eC9kbWEtYnVmLmgKPiAr
KysgYi9pbmNsdWRlL2xpbnV4L2RtYS1idWYuaAo+IEBAIC05OSwxNCArOTksNDAgQEAgc3RydWN0
IGRtYV9idWZfb3BzIHsKPiAgICAgICAgICAqLwo+ICAgICAgICAgdm9pZCAoKmRldGFjaCkoc3Ry
dWN0IGRtYV9idWYgKiwgc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCAqKTsKPgo+ICsgICAgICAg
LyoqCj4gKyAgICAgICAgKiBAcGluOgo+ICsgICAgICAgICoKPiArICAgICAgICAqIFRoaXMgaXMg
Y2FsbGVkIGJ5IGRtYV9idWZfcGluIGFuZCBsZXRzIHRoZSBleHBvcnRlciBrbm93IHRoYXQgdGhl
Cj4gKyAgICAgICAgKiBETUEtYnVmIGNhbid0IGJlIG1vdmVkIGFueSBtb3JlLgo+ICsgICAgICAg
ICoKPiArICAgICAgICAqIFRoaXMgaXMgY2FsbGVkIHdpdGggdGhlIGRtYWJ1Zi0+cmVzdiBvYmpl
Y3QgbG9ja2VkLgo+ICsgICAgICAgICoKPiArICAgICAgICAqIFRoaXMgY2FsbGJhY2sgaXMgb3B0
aW9uYWwuCj4gKyAgICAgICAgKgo+ICsgICAgICAgICogUmV0dXJuczoKPiArICAgICAgICAqCj4g
KyAgICAgICAgKiAwIG9uIHN1Y2Nlc3MsIG5lZ2F0aXZlIGVycm9yIGNvZGUgb24gZmFpbHVyZS4K
PiArICAgICAgICAqLwo+ICsgICAgICAgaW50ICgqcGluKShzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2ht
ZW50ICopOwo+ICsKPiArICAgICAgIC8qKgo+ICsgICAgICAgICogQHVucGluOgo+ICsgICAgICAg
ICoKPiArICAgICAgICAqIFRoaXMgaXMgY2FsbGVkIGJ5IGRtYV9idWZfdW5waW4gYW5kIGxldHMg
dGhlIGV4cG9ydGVyIGtub3cgdGhhdCB0aGUKPiArICAgICAgICAqIERNQS1idWYgY2FuIGJlIG1v
dmVkIGFnYWluLgo+ICsgICAgICAgICoKPiArICAgICAgICAqIFRoaXMgaXMgY2FsbGVkIHdpdGgg
dGhlIGRtYWJ1Zi0+cmVzdiBvYmplY3QgbG9ja2VkLgo+ICsgICAgICAgICoKPiArICAgICAgICAq
IFRoaXMgY2FsbGJhY2sgaXMgb3B0aW9uYWwuCj4gKyAgICAgICAgKi8KPiArICAgICAgIHZvaWQg
KCp1bnBpbikoc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCAqKTsKPiArCj4gICAgICAgICAvKioK
PiAgICAgICAgICAqIEBtYXBfZG1hX2J1ZjoKPiAgICAgICAgICAqCj4gICAgICAgICAgKiBUaGlz
IGlzIGNhbGxlZCBieSBkbWFfYnVmX21hcF9hdHRhY2htZW50KCkgYW5kIGlzIHVzZWQgdG8gbWFw
IGEKPiAgICAgICAgICAqIHNoYXJlZCAmZG1hX2J1ZiBpbnRvIGRldmljZSBhZGRyZXNzIHNwYWNl
LCBhbmQgaXQgaXMgbWFuZGF0b3J5LiBJdAo+IC0gICAgICAgICogY2FuIG9ubHkgYmUgY2FsbGVk
IGlmIEBhdHRhY2ggaGFzIGJlZW4gY2FsbGVkIHN1Y2Nlc3NmdWxseS4gVGhpcwo+IC0gICAgICAg
ICogZXNzZW50aWFsbHkgcGlucyB0aGUgRE1BIGJ1ZmZlciBpbnRvIHBsYWNlLCBhbmQgaXQgY2Fu
bm90IGJlIG1vdmVkCj4gLSAgICAgICAgKiBhbnkgbW9yZQo+ICsgICAgICAgICogY2FuIG9ubHkg
YmUgY2FsbGVkIGlmIEBhdHRhY2ggaGFzIGJlZW4gY2FsbGVkIHN1Y2Nlc3NmdWxseS4KPiAgICAg
ICAgICAqCj4gICAgICAgICAgKiBUaGlzIGNhbGwgbWF5IHNsZWVwLCBlLmcuIHdoZW4gdGhlIGJh
Y2tpbmcgc3RvcmFnZSBmaXJzdCBuZWVkcyB0byBiZQo+ICAgICAgICAgICogYWxsb2NhdGVkLCBv
ciBtb3ZlZCB0byBhIGxvY2F0aW9uIHN1aXRhYmxlIGZvciBhbGwgY3VycmVudGx5IGF0dGFjaGVk
Cj4gQEAgLTEyNyw2ICsxNTMsOSBAQCBzdHJ1Y3QgZG1hX2J1Zl9vcHMgewo+ICAgICAgICAgICog
YW55IG90aGVyIGtpbmQgb2Ygc2hhcmluZyB0aGF0IHRoZSBleHBvcnRlciBtaWdodCB3aXNoIHRv
IG1ha2UKPiAgICAgICAgICAqIGF2YWlsYWJsZSB0byBidWZmZXItdXNlcnMuCj4gICAgICAgICAg
Kgo+ICsgICAgICAgICogVGhpcyBpcyBhbHdheXMgY2FsbGVkIHdpdGggdGhlIGRtYWJ1Zi0+cmVz
diBvYmplY3QgbG9ja2VkIHdoZW4KPiArICAgICAgICAqIHRoZSBwaW4vdW5waW4gY2FsbGJhY2tz
IGFyZSBpbXBsZW1lbnRlZC4KPiArICAgICAgICAqCj4gICAgICAgICAgKiBSZXR1cm5zOgo+ICAg
ICAgICAgICoKPiAgICAgICAgICAqIEEgJnNnX3RhYmxlIHNjYXR0ZXIgbGlzdCBvZiBvciB0aGUg
YmFja2luZyBzdG9yYWdlIG9mIHRoZSBETUEgYnVmZmVyLAo+IEBAIC0xNDQsOSArMTczLDYgQEAg
c3RydWN0IGRtYV9idWZfb3BzIHsKPiAgICAgICAgICAqCj4gICAgICAgICAgKiBUaGlzIGlzIGNh
bGxlZCBieSBkbWFfYnVmX3VubWFwX2F0dGFjaG1lbnQoKSBhbmQgc2hvdWxkIHVubWFwIGFuZAo+
ICAgICAgICAgICogcmVsZWFzZSB0aGUgJnNnX3RhYmxlIGFsbG9jYXRlZCBpbiBAbWFwX2RtYV9i
dWYsIGFuZCBpdCBpcyBtYW5kYXRvcnkuCj4gLSAgICAgICAgKiBJdCBzaG91bGQgYWxzbyB1bnBp
biB0aGUgYmFja2luZyBzdG9yYWdlIGlmIHRoaXMgaXMgdGhlIGxhc3QgbWFwcGluZwo+IC0gICAg
ICAgICogb2YgdGhlIERNQSBidWZmZXIsIGl0IHRoZSBleHBvcnRlciBzdXBwb3J0cyBiYWNraW5n
IHN0b3JhZ2UKPiAtICAgICAgICAqIG1pZ3JhdGlvbi4KPiAgICAgICAgICAqLwo+ICAgICAgICAg
dm9pZCAoKnVubWFwX2RtYV9idWYpKHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKiwKPiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2dfdGFibGUgKiwKPiBAQCAtMzExLDYg
KzMzNywzNSBAQCBzdHJ1Y3QgZG1hX2J1ZiB7Cj4gICAgICAgICB9IGNiX2V4Y2wsIGNiX3NoYXJl
ZDsKPiAgfTsKPgo+ICsvKioKPiArICogc3RydWN0IGRtYV9idWZfYXR0YWNoX29wcyAtIGltcG9y
dGVyIG9wZXJhdGlvbnMgZm9yIGFuIGF0dGFjaG1lbnQKPiArICogQGludmFsaWRhdGU6IFtvcHRp
b25hbF0gaW52YWxpZGF0ZSBhbGwgbWFwcGluZ3MgbWFkZSB1c2luZyB0aGlzIGF0dGFjaG1lbnQu
Cj4gKyAqCj4gKyAqIEF0dGFjaG1lbnQgb3BlcmF0aW9ucyBpbXBsZW1lbnRlZCBieSB0aGUgaW1w
b3J0ZXIuCj4gKyAqLwo+ICtzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2hfb3BzIHsKPiArICAgICAgIC8q
Kgo+ICsgICAgICAgICogQGludmFsaWRhdGU6Cj4gKyAgICAgICAgKgo+ICsgICAgICAgICogSWYg
dGhlIGludmFsaWRhdGUgY2FsbGJhY2sgaXMgcHJvdmlkZWQgdGhlIGZyYW1ld29yayBjYW4gYXZv
aWQKPiArICAgICAgICAqIHBpbm5pbmcgdGhlIGJhY2tpbmcgc3RvcmUgd2hpbGUgbWFwcGluZ3Mg
ZXhpc3RzLgo+ICsgICAgICAgICoKPiArICAgICAgICAqIFRoaXMgY2FsbGJhY2sgaXMgY2FsbGVk
IHdpdGggdGhlIGxvY2sgb2YgdGhlIHJlc2VydmF0aW9uIG9iamVjdAo+ICsgICAgICAgICogYXNz
b2NpYXRlZCB3aXRoIHRoZSBkbWFfYnVmIGhlbGQgYW5kIHRoZSBtYXBwaW5nIGZ1bmN0aW9uIG11
c3QgYmUKPiArICAgICAgICAqIGNhbGxlZCB3aXRoIHRoaXMgbG9jayBoZWxkIGFzIHdlbGwuIFRo
aXMgbWFrZXMgc3VyZSB0aGF0IG5vIG1hcHBpbmcKPiArICAgICAgICAqIGlzIGNyZWF0ZWQgY29u
Y3VycmVudGx5IHdpdGggYW4gb25nb2luZyBpbnZhbGlkYXRpb24uCj4gKyAgICAgICAgKgo+ICsg
ICAgICAgICogQWZ0ZXIgdGhlIGNhbGxiYWNrIGFsbCBleGlzdGluZyBtYXBwaW5ncyBhcmUgc3Rp
bGwgdmFsaWQgdW50aWwgYWxsCj4gKyAgICAgICAgKiBmZW5jZXMgaW4gdGhlIGRtYV9idWZzIHJl
c2VydmF0aW9uIG9iamVjdCBhcmUgc2lnbmFsZWQuIEFmdGVyIGdldHRpbmcgYW4KPiArICAgICAg
ICAqIGludmFsaWRhdGlvbiBjYWxsYmFjayBhbGwgbWFwcGluZ3Mgc2hvdWxkIGJlIGRlc3Ryb3ll
ZCBieSB0aGUgaW1wb3J0ZXIgdXNpbmcKPiArICAgICAgICAqIHRoZSBub3JtYWwgZG1hX2J1Zl91
bm1hcF9hdHRhY2htZW50KCkgZnVuY3Rpb24gYXMgc29vbiBhcyBwb3NzaWJsZS4KPiArICAgICAg
ICAqCj4gKyAgICAgICAgKiBOZXcgbWFwcGluZ3MgY2FuIGJlIGNyZWF0ZWQgaW1tZWRpYXRlbHks
IGJ1dCBjYW4ndCBiZSB1c2VkIGJlZm9yZSB0aGUKPiArICAgICAgICAqIGV4Y2x1c2l2ZSBmZW5j
ZSBpbiB0aGUgZG1hX2J1ZnMgcmVzZXJ2YXRpb24gb2JqZWN0IGlzIHNpZ25hbGVkLgo+ICsgICAg
ICAgICovCj4gKyAgICAgICB2b2lkICgqaW52YWxpZGF0ZSkoc3RydWN0IGRtYV9idWZfYXR0YWNo
bWVudCAqYXR0YWNoKTsKPiArfTsKPiArCj4gIC8qKgo+ICAgKiBzdHJ1Y3QgZG1hX2J1Zl9hdHRh
Y2htZW50IC0gaG9sZHMgZGV2aWNlLWJ1ZmZlciBhdHRhY2htZW50IGRhdGEKPiAgICogQGRtYWJ1
ZjogYnVmZmVyIGZvciB0aGlzIGF0dGFjaG1lbnQuCj4gQEAgLTMxOSw2ICszNzQsOCBAQCBzdHJ1
Y3QgZG1hX2J1ZiB7Cj4gICAqIEBzZ3Q6IGNhY2hlZCBtYXBwaW5nLgo+ICAgKiBAZGlyOiBkaXJl
Y3Rpb24gb2YgY2FjaGVkIG1hcHBpbmcuCj4gICAqIEBwcml2OiBleHBvcnRlciBzcGVjaWZpYyBh
dHRhY2htZW50IGRhdGEuCj4gKyAqIEBpbXBvcnRlcl9vcHM6IGltcG9ydGVyIG9wZXJhdGlvbnMg
Zm9yIHRoaXMgYXR0YWNobWVudC4KPiArICogQGltcG9ydGVyX3ByaXY6IGltcG9ydGVyIHNwZWNp
ZmljIGF0dGFjaG1lbnQgZGF0YS4KPiAgICoKPiAgICogVGhpcyBzdHJ1Y3R1cmUgaG9sZHMgdGhl
IGF0dGFjaG1lbnQgaW5mb3JtYXRpb24gYmV0d2VlbiB0aGUgZG1hX2J1ZiBidWZmZXIKPiAgICog
YW5kIGl0cyB1c2VyIGRldmljZShzKS4gVGhlIGxpc3QgY29udGFpbnMgb25lIGF0dGFjaG1lbnQg
c3RydWN0IHBlciBkZXZpY2UKPiBAQCAtMzM2LDYgKzM5Myw5IEBAIHN0cnVjdCBkbWFfYnVmX2F0
dGFjaG1lbnQgewo+ICAgICAgICAgc3RydWN0IHNnX3RhYmxlICpzZ3Q7Cj4gICAgICAgICBlbnVt
IGRtYV9kYXRhX2RpcmVjdGlvbiBkaXI7Cj4gICAgICAgICB2b2lkICpwcml2Owo+ICsKPiArICAg
ICAgIGNvbnN0IHN0cnVjdCBkbWFfYnVmX2F0dGFjaF9vcHMgKmltcG9ydGVyX29wczsKPiArICAg
ICAgIHZvaWQgKmltcG9ydGVyX3ByaXY7Cj4gIH07Cj4KPiAgLyoqCj4gQEAgLTM4NiwxMCArNDQ2
LDQyIEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBnZXRfZG1hX2J1ZihzdHJ1Y3QgZG1hX2J1ZiAqZG1h
YnVmKQo+ICAgICAgICAgZ2V0X2ZpbGUoZG1hYnVmLT5maWxlKTsKPiAgfQo+Cj4gKy8qKgo+ICsg
KiBkbWFfYnVmX2lzX2R5bmFtaWMgLSBjaGVjayBpZiBhIERNQS1idWYgdXNlcyBkeW5hbWljIG1h
cHBpbmdzLgo+ICsgKiBAZG1hYnVmOiB0aGUgRE1BLWJ1ZiB0byBjaGVjawo+ICsgKgo+ICsgKiBS
ZXR1cm5zIHRydWUgaWYgYSBETUEtYnVmIGV4cG9ydGVyIHdhbnRzIHRvIGNyZWF0ZSBkeW5hbWlj
IHNnIHRhYmxlIG1hcHBpbmdzCj4gKyAqIGZvciBlYWNoIGF0dGFjaG1lbnQuIEZhbHNlIGlmIG9u
bHkgYSBzaW5nbGUgc3RhdGljIHNnIHRhYmxlIHNob3VsZCBiZSB1c2VkLgo+ICsgKi8KPiArc3Rh
dGljIGlubGluZSBib29sIGRtYV9idWZfaXNfZHluYW1pYyhzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVm
KQo+ICt7Cj4gKyAgICAgICByZXR1cm4gISFkbWFidWYtPm9wcy0+cGluOwo+ICt9Cj4gKwo+ICsv
KioKPiArICogZG1hX2J1Zl9hdHRhY2htZW50X2lzX2R5bmFtaWMgLSBjaGVjayBpZiBhIERNQS1i
dWYgYXR0YWNobWVudCB1c2VzIGR5bmFtaWMKPiArICogbWFwcGluc2cKPiArICogQGF0dGFjaDog
dGhlIERNQS1idWYgYXR0YWNobWVudCB0byBjaGVjawo+ICsgKgo+ICsgKiBSZXR1cm5zIHRydWUg
aWYgYSBETUEtYnVmIGltcG9ydGVyIHdhbnRzIHRvIHVzZSBkeW5hbWljIHNnIHRhYmxlIG1hcHBp
bmdzIGFuZAo+ICsgKiBjYWxscyB0aGUgbWFwL3VubWFwIGZ1bmN0aW9ucyB3aXRoIHRoZSByZXNl
cnZhdGlvbiBvYmplY3QgbG9ja2VkLgo+ICsgKi8KPiArc3RhdGljIGlubGluZSBib29sCj4gK2Rt
YV9idWZfYXR0YWNobWVudF9pc19keW5hbWljKHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0
dGFjaCkKPiArewo+ICsgICAgICAgcmV0dXJuIGF0dGFjaC0+aW1wb3J0ZXJfb3BzICYmIGF0dGFj
aC0+aW1wb3J0ZXJfb3BzLT5pbnZhbGlkYXRlOwo+ICt9Cj4gKwo+ICBzdHJ1Y3QgZG1hX2J1Zl9h
dHRhY2htZW50ICpkbWFfYnVmX2F0dGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmLAo+IC0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0
IGRldmljZSAqZGV2KTsKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBzdHJ1Y3QgZGV2aWNlICpkZXYpOwo+ICtzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICoKPiAr
ZG1hX2J1Zl9keW5hbWljX2F0dGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmLCBzdHJ1Y3QgZGV2
aWNlICpkZXYsCj4gKyAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgZG1hX2J1Zl9h
dHRhY2hfb3BzICppbXBvcnRlcl9vcHMsCj4gKyAgICAgICAgICAgICAgICAgICAgICB2b2lkICpp
bXBvcnRlcl9wcml2KTsKPiAgdm9pZCBkbWFfYnVmX2RldGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZG1h
YnVmLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGRtYV9idWZfYXR0
YWNobWVudCAqZG1hYnVmX2F0dGFjaCk7Cj4gKyAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgZG1h
X2J1Zl9hdHRhY2htZW50ICphdHRhY2gpOwo+ICtpbnQgZG1hX2J1Zl9waW4oc3RydWN0IGRtYV9i
dWZfYXR0YWNobWVudCAqYXR0YWNoKTsKPiArdm9pZCBkbWFfYnVmX3VucGluKHN0cnVjdCBkbWFf
YnVmX2F0dGFjaG1lbnQgKmF0dGFjaCk7Cj4KPiAgc3RydWN0IGRtYV9idWYgKmRtYV9idWZfZXhw
b3J0KGNvbnN0IHN0cnVjdCBkbWFfYnVmX2V4cG9ydF9pbmZvICpleHBfaW5mbyk7Cj4KPiBAQCAt
NDAxLDYgKzQ5Myw3IEBAIHN0cnVjdCBzZ190YWJsZSAqZG1hX2J1Zl9tYXBfYXR0YWNobWVudChz
dHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICosCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGVudW0gZG1hX2RhdGFfZGlyZWN0aW9uKTsKPiAgdm9pZCBkbWFfYnVmX3Vu
bWFwX2F0dGFjaG1lbnQoc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCAqLCBzdHJ1Y3Qgc2dfdGFi
bGUgKiwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudW0gZG1hX2RhdGFfZGly
ZWN0aW9uKTsKPiArdm9pZCBkbWFfYnVmX2ludmFsaWRhdGVfbWFwcGluZ3Moc3RydWN0IGRtYV9i
dWYgKmRtYV9idWYpOwo+ICBpbnQgZG1hX2J1Zl9iZWdpbl9jcHVfYWNjZXNzKHN0cnVjdCBkbWFf
YnVmICpkbWFfYnVmLAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW51bSBkbWFfZGF0
YV9kaXJlY3Rpb24gZGlyKTsKPiAgaW50IGRtYV9idWZfZW5kX2NwdV9hY2Nlc3Moc3RydWN0IGRt
YV9idWYgKmRtYV9idWYsCj4gLS0KPiAyLjE3LjEKPgoKCi0tIApEYW5pZWwgVmV0dGVyClNvZnR3
YXJlIEVuZ2luZWVyLCBJbnRlbCBDb3Jwb3JhdGlvbgorNDEgKDApIDc5IDM2NSA1NyA0OCAtIGh0
dHA6Ly9ibG9nLmZmd2xsLmNoCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNr
dG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2Ry
aS1kZXZlbA==
