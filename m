Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 86989578EF
	for <lists+dri-devel@lfdr.de>; Thu, 27 Jun 2019 03:33:13 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8CFC56E57E;
	Thu, 27 Jun 2019 01:33:10 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-io1-xd44.google.com (mail-io1-xd44.google.com
 [IPv6:2607:f8b0:4864:20::d44])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B719B6E57E
 for <dri-devel@lists.freedesktop.org>; Thu, 27 Jun 2019 01:33:09 +0000 (UTC)
Received: by mail-io1-xd44.google.com with SMTP id n5so1076942ioc.7
 for <dri-devel@lists.freedesktop.org>; Wed, 26 Jun 2019 18:33:09 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=eZogRr2EBu+1m923ifEoDqvQCpyj7+EI0wqHn3aRB44=;
 b=UhKKA/vC1zPn8qvLmkEwOa8Bwdp5lFl995yaWMXC9U9wFU3siXhghDazRsNrfmLTT/
 0A/6eL7Cz7soGjh9gaUVEqTHdyCvyqH+Xp0UKtpZg8bMJqBJK+VBEpH2nQAHuAu4m4ko
 ilBko5DqgLUduvrdmxxFKnIyscLdMFF+8IjNNzuG1HGSQSosNfh4Kkzy2XMOk8CMs/dV
 MxciZMfNHri0X74MVs3z9nwQPAGB5xxoESc+XQXS5YfjtNfDpxWRtAEtjX+KKVkgDDPq
 g0/Mhb7fPsJagFA75Q4A04p396Y6ILfAZUO9TixRl0JV1aHrEkEnhIiYJyCwChNHpuAI
 eMSg==
X-Gm-Message-State: APjAAAWdYfuReXB1DlPDVG4lvETmSqusxdsV56g/IpQxh0fUgx63Qwj4
 81Bc7q9k7DDCvZocrMgGJOEHwUjm5bB2wIxCS+uQHnu4
X-Google-Smtp-Source: APXvYqzXlkQi43eEmZx4veNTJdbtZaN7YI/bz8RMmLtiro9vL8rNPdnc0Z+aO0Vl7GivKmo8XkncLttYWM7k5u/owfA=
X-Received: by 2002:a05:6602:104:: with SMTP id
 s4mr1515842iot.200.1561599188807; 
 Wed, 26 Jun 2019 18:33:08 -0700 (PDT)
MIME-Version: 1.0
References: <20190620060726.926-1-kraxel@redhat.com>
 <20190620060726.926-9-kraxel@redhat.com>
In-Reply-To: <20190620060726.926-9-kraxel@redhat.com>
From: Chia-I Wu <olvaffe@gmail.com>
Date: Wed, 26 Jun 2019 18:32:57 -0700
Message-ID: <CAPaKu7QjuKMJfhTVOzBsUb8cT9cGgesG_-skQeBO8hL8UqcAzw@mail.gmail.com>
Subject: Re: [PATCH v4 08/12] drm/virtio: rework virtio_gpu_execbuffer_ioctl
 fencing
To: Gerd Hoffmann <kraxel@redhat.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=eZogRr2EBu+1m923ifEoDqvQCpyj7+EI0wqHn3aRB44=;
 b=cKGxxlrP+ukoth4289HEWH7g9Ws3BMTPxYjebaKo0dY1w2lBNYYa2MBC0kxcaUhM7m
 RKq2bLZHCWXGYVmaxQju0LpWt4taKscNRB/xRspide7269gs1sfkvvI5+1NoovIfrX7T
 2kBZnXsVbx9IbKbJYnZIlrYq9EJwiiRh78i+djCESrvTEvhQCNrjVsVkeaz5cBvNmiXZ
 wPOzQaxshY2diBQQCyxfDCpAtepal5pdOrrMrRlVyw9iRwc3gRqVVb92mdiaPQgrlNyo
 SQtwlScIEOP+kj3VoaZXi+viTUHuEU0KClbyyrW9q7P5Y1ZG5HB2EcYCT5F5Wee19Z9B
 JGWA==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: David Airlie <airlied@linux.ie>, open list <linux-kernel@vger.kernel.org>,
 ML dri-devel <dri-devel@lists.freedesktop.org>,
 "open list:VIRTIO GPU DRIVER" <virtualization@lists.linux-foundation.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gV2VkLCBKdW4gMTksIDIwMTkgYXQgMTE6MDggUE0gR2VyZCBIb2ZmbWFubiA8a3JheGVsQHJl
ZGhhdC5jb20+IHdyb3RlOgo+Cj4gVXNlIGdlbSByZXNlcnZhdGlvbiBoZWxwZXJzIGFuZCBkaXJl
Y3QgcmVzZXJ2YXRpb25fb2JqZWN0XyogY2FsbHMKPiBpbnN0ZWFkIG9mIHR0bS4KPgo+IHYzOiBB
bHNvIGF0dGFjaCB0aGUgYXJyYXkgb2YgZ2VtIG9iamVjdHMgdG8gdGhlIHZpcnRpbyBjb21tYW5k
IGJ1ZmZlciwKPiBzbyB3ZSBjYW4gZHJvcCB0aGUgb2JqZWN0IHJlZmVyZW5jZXMgaW4gdGhlIGNv
bXBsZXRpb24gY2FsbGJhY2suICBOZWVkZWQKPiBiZWNhdXNlIHR0bSBmZW5jZSBoZWxwZXJzIGdy
YWIgYSByZWZlcmVuY2UgZm9yIHVzLCBidXQgZ2VtIGhlbHBlcnMKPiBkb24ndC4KPgo+IFNpZ25l
ZC1vZmYtYnk6IEdlcmQgSG9mZm1hbm4gPGtyYXhlbEByZWRoYXQuY29tPgo+IEFja2VkLWJ5OiBE
YW5pZWwgVmV0dGVyIDxkYW5pZWwudmV0dGVyQGZmd2xsLmNoPgo+IC0tLQo+ICBkcml2ZXJzL2dw
dS9kcm0vdmlydGlvL3ZpcnRncHVfZHJ2LmggICB8ICA1ICsrLQo+ICBkcml2ZXJzL2dwdS9kcm0v
dmlydGlvL3ZpcnRncHVfaW9jdGwuYyB8IDYyICsrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tCj4g
IGRyaXZlcnMvZ3B1L2RybS92aXJ0aW8vdmlydGdwdV92cS5jICAgIHwgMTYgKysrKy0tLQo+ICAz
IGZpbGVzIGNoYW5nZWQsIDQwIGluc2VydGlvbnMoKyksIDQzIGRlbGV0aW9ucygtKQo+Cj4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8vdmlydGdwdV9kcnYuaCBiL2RyaXZlcnMv
Z3B1L2RybS92aXJ0aW8vdmlydGdwdV9kcnYuaAo+IGluZGV4IDk4ZDY0Njc4OWQyMy4uNjVmNWNl
NDFjMzQxIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8vdmlydGdwdV9kcnYu
aAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8vdmlydGdwdV9kcnYuaAo+IEBAIC0xMjAs
OSArMTIwLDkgQEAgc3RydWN0IHZpcnRpb19ncHVfdmJ1ZmZlciB7Cj4KPiAgICAgICAgIGNoYXIg
KnJlc3BfYnVmOwo+ICAgICAgICAgaW50IHJlc3Bfc2l6ZTsKPiAtCj4gICAgICAgICB2aXJ0aW9f
Z3B1X3Jlc3BfY2IgcmVzcF9jYjsKPgo+ICsgICAgICAgc3RydWN0IHZpcnRpb19ncHVfb2JqZWN0
X2FycmF5ICpvYmpzOwpUaGlzIGNhbiB1c2UgYSBjb21tZW50IChlLmcuLCBvYmplY3RzIHJlZmVy
ZW5jZWQgYnkgdGhlIHZidWZmZXIpCj4gICAgICAgICBzdHJ1Y3QgbGlzdF9oZWFkIGxpc3Q7Cj4g
IH07Cj4KPiBAQCAtMzExLDcgKzMxMSw4IEBAIHZvaWQgdmlydGlvX2dwdV9jbWRfY29udGV4dF9k
ZXRhY2hfcmVzb3VyY2Uoc3RydWN0IHZpcnRpb19ncHVfZGV2aWNlICp2Z2RldiwKPiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHJlc291cmNlX2lk
KTsKPiAgdm9pZCB2aXJ0aW9fZ3B1X2NtZF9zdWJtaXQoc3RydWN0IHZpcnRpb19ncHVfZGV2aWNl
ICp2Z2RldiwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICpkYXRhLCB1aW50MzJf
dCBkYXRhX3NpemUsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgY3R4X2lk
LCBzdHJ1Y3QgdmlydGlvX2dwdV9mZW5jZSAqZmVuY2UpOwo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgIHVpbnQzMl90IGN0eF9pZCwgc3RydWN0IHZpcnRpb19ncHVfZmVuY2UgKmZlbmNlLAo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB2aXJ0aW9fZ3B1X29iamVjdF9hcnJh
eSAqb2Jqcyk7CkNhbiB3ZSBrZWVwIGZlbmNlLCB3aGljaCBpcyB1cGRhdGVkLCBhcyB0aGUgbGFz
dCBwYXJhbWV0ZXI/Cj4gIHZvaWQgdmlydGlvX2dwdV9jbWRfdHJhbnNmZXJfZnJvbV9ob3N0XzNk
KHN0cnVjdCB2aXJ0aW9fZ3B1X2RldmljZSAqdmdkZXYsCj4gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgcmVzb3VyY2VfaWQsIHVpbnQzMl90IGN0eF9p
ZCwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50NjRfdCBv
ZmZzZXQsIHVpbnQzMl90IGxldmVsLAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdmly
dGlvL3ZpcnRncHVfaW9jdGwuYyBiL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8vdmlydGdwdV9pb2N0
bC5jCj4gaW5kZXggNWNmZmQyZTU0YzA0Li5jMzkwMWMzOTdiOGEgMTAwNjQ0Cj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X2lvY3RsLmMKPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vdmlydGlvL3ZpcnRncHVfaW9jdGwuYwo+IEBAIC0xMDUsMTQgKzEwNSwxMSBAQCBzdGF0aWMg
aW50IHZpcnRpb19ncHVfZXhlY2J1ZmZlcl9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2
b2lkICpkYXRhLAo+ICAgICAgICAgc3RydWN0IGRybV92aXJ0Z3B1X2V4ZWNidWZmZXIgKmV4YnVm
ID0gZGF0YTsKPiAgICAgICAgIHN0cnVjdCB2aXJ0aW9fZ3B1X2RldmljZSAqdmdkZXYgPSBkZXYt
PmRldl9wcml2YXRlOwo+ICAgICAgICAgc3RydWN0IHZpcnRpb19ncHVfZnByaXYgKnZmcHJpdiA9
IGRybV9maWxlLT5kcml2ZXJfcHJpdjsKPiAtICAgICAgIHN0cnVjdCBkcm1fZ2VtX29iamVjdCAq
Z29iajsKPiAgICAgICAgIHN0cnVjdCB2aXJ0aW9fZ3B1X2ZlbmNlICpvdXRfZmVuY2U7Cj4gLSAg
ICAgICBzdHJ1Y3QgdmlydGlvX2dwdV9vYmplY3QgKnFvYmo7Cj4gICAgICAgICBpbnQgcmV0Owo+
ICAgICAgICAgdWludDMyX3QgKmJvX2hhbmRsZXMgPSBOVUxMOwo+ICAgICAgICAgdm9pZCBfX3Vz
ZXIgKnVzZXJfYm9faGFuZGxlcyA9IE5VTEw7Cj4gLSAgICAgICBzdHJ1Y3QgbGlzdF9oZWFkIHZh
bGlkYXRlX2xpc3Q7Cj4gLSAgICAgICBzdHJ1Y3QgdHRtX3ZhbGlkYXRlX2J1ZmZlciAqYnVmbGlz
dCA9IE5VTEw7Cj4gKyAgICAgICBzdHJ1Y3QgdmlydGlvX2dwdV9vYmplY3RfYXJyYXkgKmJ1Zmxp
c3QgPSBOVUxMOwo+ICAgICAgICAgaW50IGk7Cj4gICAgICAgICBzdHJ1Y3Qgd3dfYWNxdWlyZV9j
dHggdGlja2V0Owo+ICAgICAgICAgc3RydWN0IHN5bmNfZmlsZSAqc3luY19maWxlOwo+IEBAIC0x
NTUsMTUgKzE1MiwxMCBAQCBzdGF0aWMgaW50IHZpcnRpb19ncHVfZXhlY2J1ZmZlcl9pb2N0bChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ICAgICAgICAgICAgICAgICAgICAg
ICAgIHJldHVybiBvdXRfZmVuY2VfZmQ7Cj4gICAgICAgICB9Cj4KPiAtICAgICAgIElOSVRfTElT
VF9IRUFEKCZ2YWxpZGF0ZV9saXN0KTsKPiAgICAgICAgIGlmIChleGJ1Zi0+bnVtX2JvX2hhbmRs
ZXMpIHsKPiAtCj4gICAgICAgICAgICAgICAgIGJvX2hhbmRsZXMgPSBrdm1hbGxvY19hcnJheShl
eGJ1Zi0+bnVtX2JvX2hhbmRsZXMsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHNpemVvZih1aW50MzJfdCksIEdGUF9LRVJORUwpOwo+IC0gICAgICAgICAgICAg
ICBidWZsaXN0ID0ga3ZtYWxsb2NfYXJyYXkoZXhidWYtPm51bV9ib19oYW5kbGVzLAo+IC0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplb2Yoc3RydWN0IHR0bV92
YWxpZGF0ZV9idWZmZXIpLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBHRlBfS0VSTkVMIHwgX19HRlBfWkVSTyk7Cj4gLSAgICAgICAgICAgICAgIGlmICghYm9f
aGFuZGxlcyB8fCAhYnVmbGlzdCkgewo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc2l6ZW9mKHVpbnQzMl90KSwgR0ZQX0tFUk5FTCk7Cj4gKyAgICAgICAgICAg
ICAgIGlmICghYm9faGFuZGxlcykgewo+ICAgICAgICAgICAgICAgICAgICAgICAgIHJldCA9IC1F
Tk9NRU07Cj4gICAgICAgICAgICAgICAgICAgICAgICAgZ290byBvdXRfdW51c2VkX2ZkOwo+ICAg
ICAgICAgICAgICAgICB9Cj4gQEAgLTE3NSwyNSArMTY3LDIyIEBAIHN0YXRpYyBpbnQgdmlydGlv
X2dwdV9leGVjYnVmZmVyX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEs
Cj4gICAgICAgICAgICAgICAgICAgICAgICAgZ290byBvdXRfdW51c2VkX2ZkOwo+ICAgICAgICAg
ICAgICAgICB9Cj4KPiAtICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGV4YnVmLT5udW1f
Ym9faGFuZGxlczsgaSsrKSB7Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgZ29iaiA9IGRybV9n
ZW1fb2JqZWN0X2xvb2t1cChkcm1fZmlsZSwgYm9faGFuZGxlc1tpXSk7Cj4gLSAgICAgICAgICAg
ICAgICAgICAgICAgaWYgKCFnb2JqKSB7Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICByZXQgPSAtRU5PRU5UOwo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ290byBv
dXRfdW51c2VkX2ZkOwo+IC0gICAgICAgICAgICAgICAgICAgICAgIH0KPiAtCj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgcW9iaiA9IGdlbV90b192aXJ0aW9fZ3B1X29iaihnb2JqKTsKPiAtICAg
ICAgICAgICAgICAgICAgICAgICBidWZsaXN0W2ldLmJvID0gJnFvYmotPnRibzsKPiAtCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgbGlzdF9hZGQoJmJ1Zmxpc3RbaV0uaGVhZCwgJnZhbGlkYXRl
X2xpc3QpOwo+ICsgICAgICAgICAgICAgICBidWZsaXN0ID0gdmlydGlvX2dwdV9hcnJheV9mcm9t
X2hhbmRsZXMoZHJtX2ZpbGUsIGJvX2hhbmRsZXMsCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGJ1Zi0+bnVtX2JvX2hhbmRsZXMpOwo+
ICsgICAgICAgICAgICAgICBpZiAoIWJ1Zmxpc3QpIHsKPiArICAgICAgICAgICAgICAgICAgICAg
ICByZXQgPSAtRU5PRU5UOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0X3VudXNl
ZF9mZDsKPiAgICAgICAgICAgICAgICAgfQo+ICAgICAgICAgICAgICAgICBrdmZyZWUoYm9faGFu
ZGxlcyk7Cj4gICAgICAgICAgICAgICAgIGJvX2hhbmRsZXMgPSBOVUxMOwo+ICAgICAgICAgfQo+
Cj4gLSAgICAgICByZXQgPSB2aXJ0aW9fZ3B1X29iamVjdF9saXN0X3ZhbGlkYXRlKCZ0aWNrZXQs
ICZ2YWxpZGF0ZV9saXN0KTsKPiAtICAgICAgIGlmIChyZXQpCj4gLSAgICAgICAgICAgICAgIGdv
dG8gb3V0X2ZyZWU7Cj4gKyAgICAgICBpZiAoYnVmbGlzdCkgewo+ICsgICAgICAgICAgICAgICBy
ZXQgPSBkcm1fZ2VtX2xvY2tfcmVzZXJ2YXRpb25zKGJ1Zmxpc3QtPm9ianMsIGJ1Zmxpc3QtPm5l
bnRzLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZ0
aWNrZXQpOwo+ICsgICAgICAgICAgICAgICBpZiAocmV0KQo+ICsgICAgICAgICAgICAgICAgICAg
ICAgIGdvdG8gb3V0X3VudXNlZF9mZDsKPiArICAgICAgIH0KPgo+ICAgICAgICAgYnVmID0gbWVt
ZHVwX3VzZXIodTY0X3RvX3VzZXJfcHRyKGV4YnVmLT5jb21tYW5kKSwgZXhidWYtPnNpemUpOwo+
ICAgICAgICAgaWYgKElTX0VSUihidWYpKSB7Cj4gQEAgLTIxOSwyNSArMjA4LDI2IEBAIHN0YXRp
YyBpbnQgdmlydGlvX2dwdV9leGVjYnVmZmVyX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYs
IHZvaWQgKmRhdGEsCj4gICAgICAgICAgICAgICAgIGZkX2luc3RhbGwob3V0X2ZlbmNlX2ZkLCBz
eW5jX2ZpbGUtPmZpbGUpOwo+ICAgICAgICAgfQo+Cj4gKyAgICAgICBpZiAoYnVmbGlzdCkgewo+
ICsgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZXhidWYtPm51bV9ib19oYW5kbGVzOyBp
KyspCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmVzZXJ2YXRpb25fb2JqZWN0X2FkZF9leGNs
X2ZlbmNlKGJ1Zmxpc3QtPm9ianNbaV0tPnJlc3YsCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZvdXRfZmVuY2UtPmYpOwo+ICsgICAg
ICAgICAgICAgICBkcm1fZ2VtX3VubG9ja19yZXNlcnZhdGlvbnMoYnVmbGlzdC0+b2JqcywgYnVm
bGlzdC0+bmVudHMsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAmdGlja2V0KTsKPiArICAgICAgIH0KV2UgdXNlZCB0byB1bmxvY2sgYWZ0ZXIgdmlydGlvX2dw
dV9jbWRfc3VibWl0LgoKSSBndWVzcywgdGhlIGZlbmNlIGlzIGNvbnNpZGVyZWQgc2lnbmFsZWQg
KGJlY2F1c2UgaXRzIHNlcW5vIGlzIHN0aWxsCjApIHVudGlsIGFmdGVyIHZpcnRpb19ncHVfY21k
X3N1Ym1pdC4gIFdlIHByb2JhYmx5IGRvbid0IHdhbnQgb3RoZXIKcHJvY2Vzc2VzIHRvIHNlZSB0
aGUgc2VtaS1pbml0aWFsaXplZCBmZW5jZS4KCgo+ICsKPiAgICAgICAgIHZpcnRpb19ncHVfY21k
X3N1Ym1pdCh2Z2RldiwgYnVmLCBleGJ1Zi0+c2l6ZSwKPiAtICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB2ZnByaXYtPmN0eF9pZCwgb3V0X2ZlbmNlKTsKPiAtCj4gLSAgICAgICB0dG1fZXVf
ZmVuY2VfYnVmZmVyX29iamVjdHMoJnRpY2tldCwgJnZhbGlkYXRlX2xpc3QsICZvdXRfZmVuY2Ut
PmYpOwo+IC0KPiAtICAgICAgIC8qIGZlbmNlIHRoZSBjb21tYW5kIGJvICovCj4gLSAgICAgICB2
aXJ0aW9fZ3B1X3VucmVmX2xpc3QoJnZhbGlkYXRlX2xpc3QpOwo+IC0gICAgICAga3ZmcmVlKGJ1
Zmxpc3QpOwo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZmcHJpdi0+Y3R4X2lkLCBv
dXRfZmVuY2UsIGJ1Zmxpc3QpOwo+ICAgICAgICAgcmV0dXJuIDA7Cj4KPiAgb3V0X21lbWR1cDoK
PiAgICAgICAgIGtmcmVlKGJ1Zik7Cj4gIG91dF91bnJlc3Y6Cj4gLSAgICAgICB0dG1fZXVfYmFj
a29mZl9yZXNlcnZhdGlvbigmdGlja2V0LCAmdmFsaWRhdGVfbGlzdCk7Cj4gLW91dF9mcmVlOgo+
IC0gICAgICAgdmlydGlvX2dwdV91bnJlZl9saXN0KCZ2YWxpZGF0ZV9saXN0KTsKS2VlcGluZyBv
dXRfZnJlZSB0byBmcmVlIGJ1Zmxpc3Qgc2VlbXMganVzdCBmaW5lLgo+ICsgICAgICAgZHJtX2dl
bV91bmxvY2tfcmVzZXJ2YXRpb25zKGJ1Zmxpc3QtPm9ianMsIGJ1Zmxpc3QtPm5lbnRzLCAmdGlj
a2V0KTsKPiAgb3V0X3VudXNlZF9mZDoKPiAgICAgICAgIGt2ZnJlZShib19oYW5kbGVzKTsKPiAt
ICAgICAgIGt2ZnJlZShidWZsaXN0KTsKPiArICAgICAgIGlmIChidWZsaXN0KQo+ICsgICAgICAg
ICAgICAgICB2aXJ0aW9fZ3B1X2FycmF5X3B1dF9mcmVlKGJ1Zmxpc3QpOwo+Cj4gICAgICAgICBp
ZiAob3V0X2ZlbmNlX2ZkID49IDApCj4gICAgICAgICAgICAgICAgIHB1dF91bnVzZWRfZmQob3V0
X2ZlbmNlX2ZkKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1
X3ZxLmMgYi9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfdnEuYwo+IGluZGV4IDZjMWE5
MDcxNzUzNS4uZGMyYzJjMDAzMjAwIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS92aXJ0
aW8vdmlydGdwdV92cS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X3Zx
LmMKPiBAQCAtMTkxLDcgKzE5MSw3IEBAIHZvaWQgdmlydGlvX2dwdV9kZXF1ZXVlX2N0cmxfZnVu
YyhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gICAgICAgICB9IHdoaWxlICghdmlydHF1ZXVl
X2VuYWJsZV9jYih2Z2Rldi0+Y3RybHEudnEpKTsKPiAgICAgICAgIHNwaW5fdW5sb2NrKCZ2Z2Rl
di0+Y3RybHEucWxvY2spOwo+Cj4gLSAgICAgICBsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUoZW50
cnksIHRtcCwgJnJlY2xhaW1fbGlzdCwgbGlzdCkgewo+ICsgICAgICAgbGlzdF9mb3JfZWFjaF9l
bnRyeShlbnRyeSwgJnJlY2xhaW1fbGlzdCwgbGlzdCkgewo+ICAgICAgICAgICAgICAgICByZXNw
ID0gKHN0cnVjdCB2aXJ0aW9fZ3B1X2N0cmxfaGRyICopZW50cnktPnJlc3BfYnVmOwo+Cj4gICAg
ICAgICAgICAgICAgIHRyYWNlX3ZpcnRpb19ncHVfY21kX3Jlc3BvbnNlKHZnZGV2LT5jdHJscS52
cSwgcmVzcCk7Cj4gQEAgLTIxOCwxNCArMjE4LDE4IEBAIHZvaWQgdmlydGlvX2dwdV9kZXF1ZXVl
X2N0cmxfZnVuYyhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gICAgICAgICAgICAgICAgIH0K
PiAgICAgICAgICAgICAgICAgaWYgKGVudHJ5LT5yZXNwX2NiKQo+ICAgICAgICAgICAgICAgICAg
ICAgICAgIGVudHJ5LT5yZXNwX2NiKHZnZGV2LCBlbnRyeSk7Cj4gLQo+IC0gICAgICAgICAgICAg
ICBsaXN0X2RlbCgmZW50cnktPmxpc3QpOwo+IC0gICAgICAgICAgICAgICBmcmVlX3ZidWYodmdk
ZXYsIGVudHJ5KTsKPiAgICAgICAgIH0KPiAgICAgICAgIHdha2VfdXAoJnZnZGV2LT5jdHJscS5h
Y2tfcXVldWUpOwo+Cj4gICAgICAgICBpZiAoZmVuY2VfaWQpCj4gICAgICAgICAgICAgICAgIHZp
cnRpb19ncHVfZmVuY2VfZXZlbnRfcHJvY2Vzcyh2Z2RldiwgZmVuY2VfaWQpOwo+ICsKPiArICAg
ICAgIGxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShlbnRyeSwgdG1wLCAmcmVjbGFpbV9saXN0LCBs
aXN0KSB7Cj4gKyAgICAgICAgICAgICAgIGlmIChlbnRyeS0+b2JqcykKPiArICAgICAgICAgICAg
ICAgICAgICAgICB2aXJ0aW9fZ3B1X2FycmF5X3B1dF9mcmVlKGVudHJ5LT5vYmpzKTsKPiArICAg
ICAgICAgICAgICAgbGlzdF9kZWwoJmVudHJ5LT5saXN0KTsKV2UgYXJlIGNsZWFyaW5nIHRoZSBs
aXN0LiAgSSBndWVzcyBsaXN0X2RlbCBpcyBub3QgbmVlZGVkLgo+ICsgICAgICAgICAgICAgICBm
cmVlX3ZidWYodmdkZXYsIGVudHJ5KTsKPiArICAgICAgIH0KPiAgfQo+Cj4gIHZvaWQgdmlydGlv
X2dwdV9kZXF1ZXVlX2N1cnNvcl9mdW5jKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiBAQCAt
OTM5LDcgKzk0Myw4IEBAIHZvaWQgdmlydGlvX2dwdV9jbWRfdHJhbnNmZXJfZnJvbV9ob3N0XzNk
KHN0cnVjdCB2aXJ0aW9fZ3B1X2RldmljZSAqdmdkZXYsCj4KPiAgdm9pZCB2aXJ0aW9fZ3B1X2Nt
ZF9zdWJtaXQoc3RydWN0IHZpcnRpb19ncHVfZGV2aWNlICp2Z2RldiwKPiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB2b2lkICpkYXRhLCB1aW50MzJfdCBkYXRhX3NpemUsCj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgdWludDMyX3QgY3R4X2lkLCBzdHJ1Y3QgdmlydGlvX2dwdV9mZW5j
ZSAqZmVuY2UpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgY3R4X2lkLCBz
dHJ1Y3QgdmlydGlvX2dwdV9mZW5jZSAqZmVuY2UsCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgc3RydWN0IHZpcnRpb19ncHVfb2JqZWN0X2FycmF5ICpvYmpzKQo+ICB7Cj4gICAgICAgICBz
dHJ1Y3QgdmlydGlvX2dwdV9jbWRfc3VibWl0ICpjbWRfcDsKPiAgICAgICAgIHN0cnVjdCB2aXJ0
aW9fZ3B1X3ZidWZmZXIgKnZidWY7Cj4gQEAgLTk0OSw2ICs5NTQsNyBAQCB2b2lkIHZpcnRpb19n
cHVfY21kX3N1Ym1pdChzdHJ1Y3QgdmlydGlvX2dwdV9kZXZpY2UgKnZnZGV2LAo+Cj4gICAgICAg
ICB2YnVmLT5kYXRhX2J1ZiA9IGRhdGE7Cj4gICAgICAgICB2YnVmLT5kYXRhX3NpemUgPSBkYXRh
X3NpemU7Cj4gKyAgICAgICB2YnVmLT5vYmpzID0gb2JqczsKPgo+ICAgICAgICAgY21kX3AtPmhk
ci50eXBlID0gY3B1X3RvX2xlMzIoVklSVElPX0dQVV9DTURfU1VCTUlUXzNEKTsKPiAgICAgICAg
IGNtZF9wLT5oZHIuY3R4X2lkID0gY3B1X3RvX2xlMzIoY3R4X2lkKTsKPiAtLQo+IDIuMTguMQo+
Cj4gX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KPiBkcmkt
ZGV2ZWwgbWFpbGluZyBsaXN0Cj4gZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwo+IGh0
dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVsCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBt
YWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3Rz
LmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
