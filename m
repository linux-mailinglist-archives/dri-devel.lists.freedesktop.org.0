Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id A2C2EF3155
	for <lists+dri-devel@lfdr.de>; Thu,  7 Nov 2019 15:24:36 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9109E6F6B3;
	Thu,  7 Nov 2019 14:24:33 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mga12.intel.com (mga12.intel.com [192.55.52.136])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7831D6F6B4;
 Thu,  7 Nov 2019 14:24:31 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga008.jf.intel.com ([10.7.209.65])
 by fmsmga106.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 07 Nov 2019 06:24:31 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.68,278,1569308400"; d="scan'208";a="196568087"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.174])
 by orsmga008.jf.intel.com with SMTP; 07 Nov 2019 06:24:28 -0800
Received: by stinkbox (sSMTP sendmail emulation);
 Thu, 07 Nov 2019 16:24:27 +0200
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Subject: [PATCH 4/5] drm/i915: Introduce intel_crtc_state_reset()
Date: Thu,  7 Nov 2019 16:24:16 +0200
Message-Id: <20191107142417.11107-4-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191107142417.11107-1-ville.syrjala@linux.intel.com>
References: <20191107142417.11107-1-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KCldl
IGhhdmUgYSBmZXcgcGxhY2VzIHdoZXJlIHdlIHdhbnQgdG8gcmVzZXQgYSBjcnRjIHN0YXRlIHRv
IGl0cwpkZWZhdWx0IHZhbHVlcy4gTGV0J3MgYWRkIGEgaGVscGVyIGZvciB0aGF0LiBXZSdsbCBu
ZWVkIHRoZSBuZXcKX19kcm1fYXRvbWljX2hlbHBlcl9jcnRjX3N0YXRlX3Jlc2V0KCkgaGVscGVy
IGZvciB0aGlzIHRvIGFsbG93CnVzIHRvIGp1c3QgcmVzZXQgdGhlIHN0YXRlIGl0c2VsZiB3aXRo
b3V0IGNsb2JiZXJpbmcgdGhlCmNydGMtPnN0YXRlIHBvaW50ZXIuCgpBbmQgd2hpbGUgYXQgaXQg
bGV0J3MgemVybyBvdXQgdGhlIHdob2xlIHRoaW5nLCBleGNlcHQgYSBmZXcKY2hvaWNlIG1lbWJl
ciB3aGljaCB3ZSdsbCBtYXJrIGFzICJpbnZhbGlkIi4gQW5kIHRoYW5rcyB0byB0aGlzCndlIGNh
biBub3cgbnVrZSBpbnRlbF9jcnRjX2luaXRfc2NhbGVycygpLgoKU2lnbmVkLW9mZi1ieTogVmls
bGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KLS0tCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyB8IDQ3ICsrKysrKysrKy0tLS0t
LS0tLS0tCiAxIGZpbGUgY2hhbmdlZCwgMjIgaW5zZXJ0aW9ucygrKSwgMjUgZGVsZXRpb25zKC0p
CgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwppbmRleCBl
NjI5MTg0MTA1M2YuLmZkNDEyMDUzM2MzZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kaXNwbGF5LmMKQEAgLTE2NCw3ICsxNjQsNiBAQCBzdGF0aWMgdm9pZCB2bHZf
cHJlcGFyZV9wbGwoc3RydWN0IGludGVsX2NydGMgKmNydGMsCiAJCQkgICAgY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKTsKIHN0YXRpYyB2b2lkIGNodl9wcmVwYXJl
X3BsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKIAkJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpOwotc3RhdGljIHZvaWQgaW50ZWxfY3J0Y19pbml0X3Nj
YWxlcnMoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpOwogc3RhdGljIHZvaWQg
c2t5bGFrZV9wZml0X2VuYWJsZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSk7CiBzdGF0aWMgdm9pZCBpcm9ubGFrZV9wZml0X2Rpc2FibGUoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlKTsKIHN0YXRpYyB2b2lkIGlyb25sYWtlX3Bm
aXRfZW5hYmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKTsKQEAg
LTEwNjU1LDggKzEwNjU0LDYgQEAgc3RhdGljIGJvb2wgaGFzd2VsbF9nZXRfcGlwZV9jb25maWco
c3RydWN0IGludGVsX2NydGMgKmNydGMsCiAJdTY0IHBvd2VyX2RvbWFpbl9tYXNrOwogCWJvb2wg
YWN0aXZlOwogCi0JaW50ZWxfY3J0Y19pbml0X3NjYWxlcnMocGlwZV9jb25maWcpOwotCiAJcGlw
ZV9jb25maWctPm1hc3Rlcl90cmFuc2NvZGVyID0gSU5WQUxJRF9UUkFOU0NPREVSOwogCiAJcG93
ZXJfZG9tYWluID0gUE9XRVJfRE9NQUlOX1BJUEUoY3J0Yy0+cGlwZSk7CkBAIC0xMTcwNCw2ICsx
MTcwMSwyMCBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9wY2hfY2xvY2tfZ2V0KHN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjLAogCQkJCQkgJnBpcGVfY29uZmlnLT5mZGlfbV9uKTsKIH0KIAorc3RhdGlj
IHZvaWQgaW50ZWxfY3J0Y19zdGF0ZV9yZXNldChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSwKKwkJCQkgICBzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKK3sKKwltZW1zZXQoY3J0
Y19zdGF0ZSwgMCwgc2l6ZW9mKCpjcnRjX3N0YXRlKSk7CisKKwlfX2RybV9hdG9taWNfaGVscGVy
X2NydGNfc3RhdGVfcmVzZXQoJmNydGNfc3RhdGUtPnVhcGksICZjcnRjLT5iYXNlKTsKKworCWNy
dGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyID0gSU5WQUxJRF9UUkFOU0NPREVSOworCWNydGNfc3Rh
dGUtPm1hc3Rlcl90cmFuc2NvZGVyID0gSU5WQUxJRF9UUkFOU0NPREVSOworCWNydGNfc3RhdGUt
Pmhzd193b3JrYXJvdW5kX3BpcGUgPSBJTlZBTElEX1BJUEU7CisJY3J0Y19zdGF0ZS0+b3V0cHV0
X2Zvcm1hdCA9IElOVEVMX09VVFBVVF9GT1JNQVRfSU5WQUxJRDsKKwljcnRjX3N0YXRlLT5zY2Fs
ZXJfc3RhdGUuc2NhbGVyX2lkID0gLTE7Cit9CisKIC8qIFJldHVybnMgdGhlIGN1cnJlbnRseSBw
cm9ncmFtbWVkIG1vZGUgb2YgdGhlIGdpdmVuIGVuY29kZXIuICovCiBzdHJ1Y3QgZHJtX2Rpc3Bs
YXlfbW9kZSAqCiBpbnRlbF9lbmNvZGVyX2N1cnJlbnRfbW9kZShzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlcikKQEAgLTExNzI5LDcgKzExNzQwLDcgQEAgaW50ZWxfZW5jb2Rlcl9jdXJyZW50
X21vZGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCiAJCXJldHVybiBOVUxMOwogCX0K
IAotCWNydGNfc3RhdGUtPnVhcGkuY3J0YyA9ICZjcnRjLT5iYXNlOworCWludGVsX2NydGNfc3Rh
dGVfcmVzZXQoY3J0Y19zdGF0ZSwgY3J0Yyk7CiAKIAlpZiAoIWRldl9wcml2LT5kaXNwbGF5Lmdl
dF9waXBlX2NvbmZpZyhjcnRjLCBjcnRjX3N0YXRlKSkgewogCQlrZnJlZShjcnRjX3N0YXRlKTsK
QEAgLTEzNTc3LDE4ICsxMzU4OCwxNCBAQCB2ZXJpZnlfY3J0Y19zdGF0ZShzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YywKIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7CiAJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwogCXN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOwotCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBl
X2NvbmZpZzsKLQlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGU7CisJc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKnBpcGVfY29uZmlnID0gb2xkX2NydGNfc3RhdGU7CisJc3RydWN0IGRybV9h
dG9taWNfc3RhdGUgKnN0YXRlID0gb2xkX2NydGNfc3RhdGUtPnVhcGkuc3RhdGU7CiAJYm9vbCBh
Y3RpdmU7CiAKLQlzdGF0ZSA9IG9sZF9jcnRjX3N0YXRlLT51YXBpLnN0YXRlOwogCV9fZHJtX2F0
b21pY19oZWxwZXJfY3J0Y19kZXN0cm95X3N0YXRlKCZvbGRfY3J0Y19zdGF0ZS0+dWFwaSk7CiAJ
aW50ZWxfY3J0Y19mcmVlX2h3X3N0YXRlKG9sZF9jcnRjX3N0YXRlKTsKLQotCXBpcGVfY29uZmln
ID0gb2xkX2NydGNfc3RhdGU7Ci0JbWVtc2V0KHBpcGVfY29uZmlnLCAwLCBzaXplb2YoKnBpcGVf
Y29uZmlnKSk7Ci0JcGlwZV9jb25maWctPnVhcGkuY3J0YyA9ICZjcnRjLT5iYXNlOwotCXBpcGVf
Y29uZmlnLT51YXBpLnN0YXRlID0gc3RhdGU7CisJaW50ZWxfY3J0Y19zdGF0ZV9yZXNldChvbGRf
Y3J0Y19zdGF0ZSwgY3J0Yyk7CisJb2xkX2NydGNfc3RhdGUtPnVhcGkuc3RhdGUgPSBzdGF0ZTsK
IAogCURSTV9ERUJVR19LTVMoIltDUlRDOiVkOiVzXVxuIiwgY3J0Yy0+YmFzZS5iYXNlLmlkLCBj
cnRjLT5iYXNlLm5hbWUpOwogCkBAIC0xNTc0NSwxNSArMTU3NTIsNiBAQCBpbnRlbF9jdXJzb3Jf
cGxhbmVfY3JlYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAlyZXR1cm4g
RVJSX1BUUihyZXQpOwogfQogCi1zdGF0aWMgdm9pZCBpbnRlbF9jcnRjX2luaXRfc2NhbGVycyhz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKLXsKLQlzdHJ1Y3QgaW50ZWxfY3J0
Y19zY2FsZXJfc3RhdGUgKnNjYWxlcl9zdGF0ZSA9Ci0JCSZjcnRjX3N0YXRlLT5zY2FsZXJfc3Rh
dGU7Ci0KLQltZW1zZXQoc2NhbGVyX3N0YXRlLCAwLCBzaXplb2YoKnNjYWxlcl9zdGF0ZSkpOwot
CXNjYWxlcl9zdGF0ZS0+c2NhbGVyX2lkID0gLTE7Ci19Ci0KICNkZWZpbmUgSU5URUxfQ1JUQ19G
VU5DUyBcCiAJLmdhbW1hX3NldCA9IGRybV9hdG9taWNfaGVscGVyX2xlZ2FjeV9nYW1tYV9zZXQs
IFwKIAkuc2V0X2NvbmZpZyA9IGRybV9hdG9taWNfaGVscGVyX3NldF9jb25maWcsIFwKQEAgLTE1
ODM2LDkgKzE1ODM0LDkgQEAgc3RhdGljIHN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjX2Fs
bG9jKHZvaWQpCiAJCXJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwogCX0KIAotCV9fZHJtX2F0b21p
Y19oZWxwZXJfY3J0Y19yZXNldCgmY3J0Yy0+YmFzZSwgJmNydGNfc3RhdGUtPnVhcGkpOwotCWlu
dGVsX2NydGNfaW5pdF9zY2FsZXJzKGNydGNfc3RhdGUpOworCWludGVsX2NydGNfc3RhdGVfcmVz
ZXQoY3J0Y19zdGF0ZSwgY3J0Yyk7CiAKKwljcnRjLT5iYXNlLnN0YXRlID0gJmNydGNfc3RhdGUt
PnVhcGk7CiAJY3J0Yy0+Y29uZmlnID0gY3J0Y19zdGF0ZTsKIAogCXJldHVybiBjcnRjOwpAQCAt
MTc0MTQsOCArMTc0MTIsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9tb2Rlc2V0X3JlYWRvdXRfaHdf
c3RhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRldikKIAogCQlfX2RybV9hdG9taWNfaGVscGVyX2Ny
dGNfZGVzdHJveV9zdGF0ZSgmY3J0Y19zdGF0ZS0+dWFwaSk7CiAJCWludGVsX2NydGNfZnJlZV9o
d19zdGF0ZShjcnRjX3N0YXRlKTsKLQkJbWVtc2V0KGNydGNfc3RhdGUsIDAsIHNpemVvZigqY3J0
Y19zdGF0ZSkpOwotCQlfX2RybV9hdG9taWNfaGVscGVyX2NydGNfcmVzZXQoJmNydGMtPmJhc2Us
ICZjcnRjX3N0YXRlLT51YXBpKTsKKwkJaW50ZWxfY3J0Y19zdGF0ZV9yZXNldChjcnRjX3N0YXRl
LCBjcnRjKTsKIAogCQljcnRjX3N0YXRlLT5ody5hY3RpdmUgPSBjcnRjX3N0YXRlLT5ody5lbmFi
bGUgPQogCQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X3BpcGVfY29uZmlnKGNydGMsIGNydGNfc3Rh
dGUpOwotLSAKMi4yMy4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3Rv
cC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmkt
ZGV2ZWw=
