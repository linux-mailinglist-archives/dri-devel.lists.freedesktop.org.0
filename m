Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 922552B42B
	for <lists+dri-devel@lfdr.de>; Mon, 27 May 2019 14:05:05 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 02AC189C1C;
	Mon, 27 May 2019 12:04:45 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from bhuna.collabora.co.uk (bhuna.collabora.co.uk
 [IPv6:2a00:1098:0:82:1000:25:2eeb:e3e3])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9B7AB89F77
 for <dri-devel@lists.freedesktop.org>; Thu, 23 May 2019 20:08:14 +0000 (UTC)
Received: from [127.0.0.1] (localhost [127.0.0.1]) (Authenticated sender: sre)
 with ESMTPSA id 79706283EAD
From: Sebastian Reichel <sebastian.reichel@collabora.com>
To: Sebastian Reichel <sre@kernel.org>, Tomi Valkeinen <tomi.valkeinen@ti.com>,
 Tony Lindgren <tony@atomide.com>, Pavel Machek <pavel@ucw.cz>,
 Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Subject: [PATCHv6 3/4] drm/omap: add framedone interrupt support
Date: Thu, 23 May 2019 22:07:55 +0200
Message-Id: <20190523200756.25314-4-sebastian.reichel@collabora.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190523200756.25314-1-sebastian.reichel@collabora.com>
References: <20190523200756.25314-1-sebastian.reichel@collabora.com>
MIME-Version: 1.0
X-Mailman-Approved-At: Mon, 27 May 2019 12:03:54 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: kernel@collabora.com, "H. Nikolaus Schaller" <hns@goldelico.com>,
 linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org,
 Sebastian Reichel <sebastian.reichel@collabora.com>,
 linux-omap@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBwcmVwYXJlcyBmcmFtZWRvbmUgaW50ZXJydXB0IGhhbmRsaW5nIGZvcgptYW51YWwgZGlz
cGxheSB1cGRhdGUgc3VwcG9ydC4KCkFja2VkLWJ5OiBQYXZlbCBNYWNoZWsgPHBhdmVsQHVjdy5j
ej4KVGVzdGVkLWJ5OiBUb255IExpbmRncmVuIDx0b255QGF0b21pZGUuY29tPgpUZXN0ZWQtYnk6
IFBhdmVsIE1hY2hlayA8cGF2ZWxAdWN3LmN6PgpTaWduZWQtb2ZmLWJ5OiBTZWJhc3RpYW4gUmVp
Y2hlbCA8c2ViYXN0aWFuLnJlaWNoZWxAY29sbGFib3JhLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9k
cm0vb21hcGRybS9vbWFwX2NydGMuYyB8IDUwICsrKysrKysrKysrKysrKysrKysrKysrKysrKysr
CiBkcml2ZXJzL2dwdS9kcm0vb21hcGRybS9vbWFwX2NydGMuaCB8ICAxICsKIGRyaXZlcnMvZ3B1
L2RybS9vbWFwZHJtL29tYXBfaXJxLmMgIHwgMjUgKysrKysrKysrKysrKysrCiBkcml2ZXJzL2dw
dS9kcm0vb21hcGRybS9vbWFwX2lycS5oICB8ICAxICsKIDQgZmlsZXMgY2hhbmdlZCwgNzcgaW5z
ZXJ0aW9ucygrKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL29tYXBfY3J0
Yy5jIGIvZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vb21hcF9jcnRjLmMKaW5kZXggODY4MjdhMDYx
YjBiLi42ODY5NzgyMGQxODkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL29t
YXBfY3J0Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL29tYXBfY3J0Yy5jCkBAIC01
MSw2ICs1MSw5IEBAIHN0cnVjdCBvbWFwX2NydGMgewogCWJvb2wgcGVuZGluZzsKIAl3YWl0X3F1
ZXVlX2hlYWRfdCBwZW5kaW5nX3dhaXQ7CiAJc3RydWN0IGRybV9wZW5kaW5nX3ZibGFua19ldmVu
dCAqZXZlbnQ7CisKKwl2b2lkICgqZnJhbWVkb25lX2hhbmRsZXIpKHZvaWQgKik7CisJdm9pZCAq
ZnJhbWVkb25lX2hhbmRsZXJfZGF0YTsKIH07CiAKIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCkBA
IC0yMzAsNiArMjMzLDE4IEBAIHN0YXRpYyBpbnQgb21hcF9jcnRjX2Rzc19yZWdpc3Rlcl9mcmFt
ZWRvbmUoCiAJCXN0cnVjdCBvbWFwX2RybV9wcml2YXRlICpwcml2LCBlbnVtIG9tYXBfY2hhbm5l
bCBjaGFubmVsLAogCQl2b2lkICgqaGFuZGxlcikodm9pZCAqKSwgdm9pZCAqZGF0YSkKIHsKKwlz
dHJ1Y3QgZHJtX2NydGMgKmNydGMgPSBwcml2LT5jaGFubmVsc1tjaGFubmVsXS0+Y3J0YzsKKwlz
dHJ1Y3Qgb21hcF9jcnRjICpvbWFwX2NydGMgPSB0b19vbWFwX2NydGMoY3J0Yyk7CisJc3RydWN0
IGRybV9kZXZpY2UgKmRldiA9IG9tYXBfY3J0Yy0+YmFzZS5kZXY7CisKKwlpZiAob21hcF9jcnRj
LT5mcmFtZWRvbmVfaGFuZGxlcikKKwkJcmV0dXJuIC1FQlVTWTsKKworCWRldl9kYmcoZGV2LT5k
ZXYsICJyZWdpc3RlciBmcmFtZWRvbmUgJXMiLCBvbWFwX2NydGMtPm5hbWUpOworCisJb21hcF9j
cnRjLT5mcmFtZWRvbmVfaGFuZGxlciA9IGhhbmRsZXI7CisJb21hcF9jcnRjLT5mcmFtZWRvbmVf
aGFuZGxlcl9kYXRhID0gZGF0YTsKKwogCXJldHVybiAwOwogfQogCkBAIC0yMzcsNiArMjUyLDE3
IEBAIHN0YXRpYyB2b2lkIG9tYXBfY3J0Y19kc3NfdW5yZWdpc3Rlcl9mcmFtZWRvbmUoCiAJCXN0
cnVjdCBvbWFwX2RybV9wcml2YXRlICpwcml2LCBlbnVtIG9tYXBfY2hhbm5lbCBjaGFubmVsLAog
CQl2b2lkICgqaGFuZGxlcikodm9pZCAqKSwgdm9pZCAqZGF0YSkKIHsKKwlzdHJ1Y3QgZHJtX2Ny
dGMgKmNydGMgPSBwcml2LT5jaGFubmVsc1tjaGFubmVsXS0+Y3J0YzsKKwlzdHJ1Y3Qgb21hcF9j
cnRjICpvbWFwX2NydGMgPSB0b19vbWFwX2NydGMoY3J0Yyk7CisJc3RydWN0IGRybV9kZXZpY2Ug
KmRldiA9IG9tYXBfY3J0Yy0+YmFzZS5kZXY7CisKKwlkZXZfZGJnKGRldi0+ZGV2LCAidW5yZWdp
c3RlciBmcmFtZWRvbmUgJXMiLCBvbWFwX2NydGMtPm5hbWUpOworCisJV0FSTl9PTihvbWFwX2Ny
dGMtPmZyYW1lZG9uZV9oYW5kbGVyICE9IGhhbmRsZXIpOworCVdBUk5fT04ob21hcF9jcnRjLT5m
cmFtZWRvbmVfaGFuZGxlcl9kYXRhICE9IGRhdGEpOworCisJb21hcF9jcnRjLT5mcmFtZWRvbmVf
aGFuZGxlciA9IE5VTEw7CisJb21hcF9jcnRjLT5mcmFtZWRvbmVfaGFuZGxlcl9kYXRhID0gTlVM
TDsKIH0KIAogc3RhdGljIGNvbnN0IHN0cnVjdCBkc3NfbWdyX29wcyBtZ3Jfb3BzID0gewpAQCAt
MzAyLDYgKzMyOCwzMCBAQCB2b2lkIG9tYXBfY3J0Y192YmxhbmtfaXJxKHN0cnVjdCBkcm1fY3J0
YyAqY3J0YykKIAlEQkcoIiVzOiBhcHBseSBkb25lIiwgb21hcF9jcnRjLT5uYW1lKTsKIH0KIAor
dm9pZCBvbWFwX2NydGNfZnJhbWVkb25lX2lycShzdHJ1Y3QgZHJtX2NydGMgKmNydGMsIHVpbnQz
Ml90IGlycXN0YXR1cykKK3sKKwlzdHJ1Y3Qgb21hcF9jcnRjICpvbWFwX2NydGMgPSB0b19vbWFw
X2NydGMoY3J0Yyk7CisKKwlpZiAoIW9tYXBfY3J0Yy0+ZnJhbWVkb25lX2hhbmRsZXIpIHsKKwkJ
ZGV2X3dhcm4ob21hcF9jcnRjLT5iYXNlLmRldi0+ZGV2LCAibm8gZnJhbWVkb25lIGhhbmRsZXI/
Iik7CisJCXJldHVybjsKKwl9CisKKwlvbWFwX2NydGMtPmZyYW1lZG9uZV9oYW5kbGVyKG9tYXBf
Y3J0Yy0+ZnJhbWVkb25lX2hhbmRsZXJfZGF0YSk7CisKKwlzcGluX2xvY2soJmNydGMtPmRldi0+
ZXZlbnRfbG9jayk7CisJLyogU2VuZCB0aGUgdmJsYW5rIGV2ZW50IGlmIG9uZSBoYXMgYmVlbiBy
ZXF1ZXN0ZWQuICovCisJaWYgKG9tYXBfY3J0Yy0+ZXZlbnQpIHsKKwkJZHJtX2NydGNfc2VuZF92
YmxhbmtfZXZlbnQoY3J0Yywgb21hcF9jcnRjLT5ldmVudCk7CisJCW9tYXBfY3J0Yy0+ZXZlbnQg
PSBOVUxMOworCX0KKwlvbWFwX2NydGMtPnBlbmRpbmcgPSBmYWxzZTsKKwlzcGluX3VubG9jaygm
Y3J0Yy0+ZGV2LT5ldmVudF9sb2NrKTsKKworCS8qIFdha2UgdXAgb21hcF9hdG9taWNfY29tcGxl
dGUuICovCisJd2FrZV91cCgmb21hcF9jcnRjLT5wZW5kaW5nX3dhaXQpOworfQorCiBzdGF0aWMg
dm9pZCBvbWFwX2NydGNfd3JpdGVfY3J0Y19wcm9wZXJ0aWVzKHN0cnVjdCBkcm1fY3J0YyAqY3J0
YykKIHsKIAlzdHJ1Y3Qgb21hcF9kcm1fcHJpdmF0ZSAqcHJpdiA9IGNydGMtPmRldi0+ZGV2X3By
aXZhdGU7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9vbWFwX2NydGMuaCBi
L2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL29tYXBfY3J0Yy5oCmluZGV4IGQ5ZGU0MzdiYTlkZC4u
ZDMzYmJiN2E0ZjkwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9vbWFwX2Ny
dGMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9vbWFwX2NydGMuaApAQCAtNDEsNSAr
NDEsNiBAQCBzdHJ1Y3QgZHJtX2NydGMgKm9tYXBfY3J0Y19pbml0KHN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYsCiBpbnQgb21hcF9jcnRjX3dhaXRfcGVuZGluZyhzdHJ1Y3QgZHJtX2NydGMgKmNydGMp
Owogdm9pZCBvbWFwX2NydGNfZXJyb3JfaXJxKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywgdTMyIGly
cXN0YXR1cyk7CiB2b2lkIG9tYXBfY3J0Y192YmxhbmtfaXJxKHN0cnVjdCBkcm1fY3J0YyAqY3J0
Yyk7Cit2b2lkIG9tYXBfY3J0Y19mcmFtZWRvbmVfaXJxKHN0cnVjdCBkcm1fY3J0YyAqY3J0Yywg
dWludDMyX3QgaXJxc3RhdHVzKTsKIAogI2VuZGlmIC8qIF9fT01BUERSTV9DUlRDX0hfXyAqLwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vb21hcF9pcnEuYyBiL2RyaXZlcnMv
Z3B1L2RybS9vbWFwZHJtL29tYXBfaXJxLmMKaW5kZXggMzI5YWQyNmQ2ZDUwLi4wMWRkYTg0Y2Ey
ZWUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL29tYXBfaXJxLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vb21hcF9pcnEuYwpAQCAtODUsNiArODUsMjggQEAgaW50
IG9tYXBfaXJxX3dhaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgc3RydWN0IG9tYXBfaXJxX3dh
aXQgKndhaXQsCiAJcmV0dXJuIHJldCA9PSAwID8gLTEgOiAwOwogfQogCitpbnQgb21hcF9pcnFf
ZW5hYmxlX2ZyYW1lZG9uZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMsIGJvb2wgZW5hYmxlKQorewor
CXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5kZXY7CisJc3RydWN0IG9tYXBfZHJtX3By
aXZhdGUgKnByaXYgPSBkZXYtPmRldl9wcml2YXRlOworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisJ
ZW51bSBvbWFwX2NoYW5uZWwgY2hhbm5lbCA9IG9tYXBfY3J0Y19jaGFubmVsKGNydGMpOworCWlu
dCBmcmFtZWRvbmVfaXJxID0KKwkJcHJpdi0+ZGlzcGNfb3BzLT5tZ3JfZ2V0X2ZyYW1lZG9uZV9p
cnEocHJpdi0+ZGlzcGMsIGNoYW5uZWwpOworCisJREJHKCJkZXY9JXAsIGNydGM9JXUsIGVuYWJs
ZT0lZCIsIGRldiwgY2hhbm5lbCwgZW5hYmxlKTsKKworCXNwaW5fbG9ja19pcnFzYXZlKCZwcml2
LT53YWl0X2xvY2ssIGZsYWdzKTsKKwlpZiAoZW5hYmxlKQorCQlwcml2LT5pcnFfbWFzayB8PSBm
cmFtZWRvbmVfaXJxOworCWVsc2UKKwkJcHJpdi0+aXJxX21hc2sgJj0gfmZyYW1lZG9uZV9pcnE7
CisJb21hcF9pcnFfdXBkYXRlKGRldik7CisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmcHJpdi0+
d2FpdF9sb2NrLCBmbGFncyk7CisKKwlyZXR1cm4gMDsKK30KKwogLyoqCiAgKiBlbmFibGVfdmJs
YW5rIC0gZW5hYmxlIHZibGFuayBpbnRlcnJ1cHQgZXZlbnRzCiAgKiBAZGV2OiBEUk0gZGV2aWNl
CkBAIC0yMTcsNiArMjM5LDkgQEAgc3RhdGljIGlycXJldHVybl90IG9tYXBfaXJxX2hhbmRsZXIo
aW50IGlycSwgdm9pZCAqYXJnKQogCiAJCWlmIChpcnFzdGF0dXMgJiBwcml2LT5kaXNwY19vcHMt
Pm1ncl9nZXRfc3luY19sb3N0X2lycShwcml2LT5kaXNwYywgY2hhbm5lbCkpCiAJCQlvbWFwX2Ny
dGNfZXJyb3JfaXJxKGNydGMsIGlycXN0YXR1cyk7CisKKwkJaWYgKGlycXN0YXR1cyAmIHByaXYt
PmRpc3BjX29wcy0+bWdyX2dldF9mcmFtZWRvbmVfaXJxKHByaXYtPmRpc3BjLCBjaGFubmVsKSkK
KwkJCW9tYXBfY3J0Y19mcmFtZWRvbmVfaXJxKGNydGMsIGlycXN0YXR1cyk7CiAJfQogCiAJb21h
cF9pcnFfb2NwX2Vycm9yX2hhbmRsZXIoZGV2LCBpcnFzdGF0dXMpOwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL29tYXBkcm0vb21hcF9pcnEuaCBiL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJt
L29tYXBfaXJxLmgKaW5kZXggOWQ1NDQxNDY4ZWNhLi4wMmFiYjRlZDk4MTMgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL29tYXBfaXJxLmgKKysrIGIvZHJpdmVycy9ncHUvZHJt
L29tYXBkcm0vb21hcF9pcnEuaApAQCAtMjcsNiArMjcsNyBAQCBzdHJ1Y3QgZHJtX2RldmljZTsK
IHN0cnVjdCBvbWFwX2lycV93YWl0OwogCiBpbnQgb21hcF9pcnFfZW5hYmxlX3ZibGFuayhzdHJ1
Y3QgZHJtX2NydGMgKmNydGMpOworaW50IG9tYXBfaXJxX2VuYWJsZV9mcmFtZWRvbmUoc3RydWN0
IGRybV9jcnRjICpjcnRjLCBib29sIGVuYWJsZSk7CiB2b2lkIG9tYXBfaXJxX2Rpc2FibGVfdmJs
YW5rKHN0cnVjdCBkcm1fY3J0YyAqY3J0Yyk7CiB2b2lkIG9tYXBfZHJtX2lycV91bmluc3RhbGwo
c3RydWN0IGRybV9kZXZpY2UgKmRldik7CiBpbnQgb21hcF9kcm1faXJxX2luc3RhbGwoc3RydWN0
IGRybV9kZXZpY2UgKmRldik7Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxp
c3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFu
L2xpc3RpbmZvL2RyaS1kZXZlbA==
