Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 73D7961CEA
	for <lists+dri-devel@lfdr.de>; Mon,  8 Jul 2019 12:27:25 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id AF66089C6A;
	Mon,  8 Jul 2019 10:27:18 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from lelv0142.ext.ti.com (lelv0142.ext.ti.com [198.47.23.249])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7624D89C63
 for <dri-devel@lists.freedesktop.org>; Mon,  8 Jul 2019 10:27:17 +0000 (UTC)
Received: from fllv0035.itg.ti.com ([10.64.41.0])
 by lelv0142.ext.ti.com (8.15.2/8.15.2) with ESMTP id x68ARCKE001167;
 Mon, 8 Jul 2019 05:27:12 -0500
Received: from DLEE114.ent.ti.com (dlee114.ent.ti.com [157.170.170.25])
 by fllv0035.itg.ti.com (8.15.2/8.15.2) with ESMTPS id x68ARCXK067712
 (version=TLSv1.2 cipher=AES256-GCM-SHA384 bits=256 verify=FAIL);
 Mon, 8 Jul 2019 05:27:12 -0500
Received: from DLEE103.ent.ti.com (157.170.170.33) by DLEE114.ent.ti.com
 (157.170.170.25) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P256) id 15.1.1713.5; Mon, 8 Jul
 2019 05:27:12 -0500
Received: from fllv0040.itg.ti.com (10.64.41.20) by DLEE103.ent.ti.com
 (157.170.170.33) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P256) id 15.1.1713.5 via
 Frontend Transport; Mon, 8 Jul 2019 05:27:12 -0500
Received: from localhost (ileax41-snat.itg.ti.com [10.172.224.153])
 by fllv0040.itg.ti.com (8.15.2/8.15.2) with ESMTP id x68ARBBD074756;
 Mon, 8 Jul 2019 05:27:11 -0500
From: Jean-Jacques Hiblot <jjhiblot@ti.com>
To: <jacek.anaszewski@gmail.com>, <pavel@ucw.cz>, <robh+dt@kernel.org>,
 <mark.rutland@arm.com>, <lee.jones@linaro.org>,
 <daniel.thompson@linaro.org>, <jingoohan1@gmail.com>
Subject: [PATCH v2 4/4] backlight: add led-backlight driver
Date: Mon, 8 Jul 2019 12:27:00 +0200
Message-ID: <20190708102700.23138-5-jjhiblot@ti.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190708102700.23138-1-jjhiblot@ti.com>
References: <20190708102700.23138-1-jjhiblot@ti.com>
MIME-Version: 1.0
X-EXCLAIMER-MD-CONFIG: e1e8a2fd-e40a-4ac6-ac9b-f7e9cc9ee180
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ti.com; s=ti-com-17Q1; t=1562581632;
 bh=rsEOI56jQUV/QiIXLNiFABw3GYyB7YCOM03aYJBNebY=;
 h=From:To:CC:Subject:Date:In-Reply-To:References;
 b=IwE43AKX9lENFZKxTVI+asaWNv6oN5tvkv2zblXfDyurPb5Tzh3BpD8bm72fZGhTA
 b7TCwgR/y86wDVYE5di5om/pudSqGB+SaA+JteRViAeFwpCWlW2Z70SBVy26MJmpo4
 osKDYo9MlhIMMDpeEOJ+g5zEt0nn1hNjHfjvKCbQ=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org,
 tomi.valkeinen@ti.com, dmurphy@ti.com, Jean-Jacques Hiblot <jjhiblot@ti.com>,
 linux-leds@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogVG9taSBWYWxrZWluZW4gPHRvbWkudmFsa2VpbmVuQHRpLmNvbT4KClRoaXMgcGF0Y2gg
YWRkcyBhIGxlZC1iYWNrbGlnaHQgZHJpdmVyIChsZWRfYmwpLCB3aGljaCBpcyBzaW1pbGFyIHRv
CnB3bV9ibCBleGNlcHQgdGhlIGRyaXZlciB1c2VzIGEgTEVEIGNsYXNzIGRyaXZlciB0byBhZGp1
c3QgdGhlCmJyaWdodG5lc3MgaW4gdGhlIEhXLiBNdWx0aXBsZSBMRURzIGNhbiBiZSB1c2VkIGZv
ciBhIHNpbmdsZSBiYWNrbGlnaHQuCgpTaWduZWQtb2ZmLWJ5OiBUb21pIFZhbGtlaW5lbiA8dG9t
aS52YWxrZWluZW5AdGkuY29tPgpTaWduZWQtb2ZmLWJ5OiBKZWFuLUphY3F1ZXMgSGlibG90IDxq
amhpYmxvdEB0aS5jb20+Ci0tLQogZHJpdmVycy92aWRlby9iYWNrbGlnaHQvS2NvbmZpZyAgfCAg
IDcgKwogZHJpdmVycy92aWRlby9iYWNrbGlnaHQvTWFrZWZpbGUgfCAgIDEgKwogZHJpdmVycy92
aWRlby9iYWNrbGlnaHQvbGVkX2JsLmMgfCAyMzUgKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKwogMyBmaWxlcyBjaGFuZ2VkLCAyNDMgaW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAw
NjQ0IGRyaXZlcnMvdmlkZW8vYmFja2xpZ2h0L2xlZF9ibC5jCgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy92aWRlby9iYWNrbGlnaHQvS2NvbmZpZyBiL2RyaXZlcnMvdmlkZW8vYmFja2xpZ2h0L0tjb25m
aWcKaW5kZXggOGIwODFkNjE3NzNlLi41ODVhMTc4NzYxOGMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
dmlkZW8vYmFja2xpZ2h0L0tjb25maWcKKysrIGIvZHJpdmVycy92aWRlby9iYWNrbGlnaHQvS2Nv
bmZpZwpAQCAtNDU4LDYgKzQ1OCwxMyBAQCBjb25maWcgQkFDS0xJR0hUX1JBVkVfU1AKIAloZWxw
CiAJICBTdXBwb3J0IGZvciBiYWNrbGlnaHQgY29udHJvbCBvbiBSQVZFIFNQIGRldmljZS4KIAor
Y29uZmlnIEJBQ0tMSUdIVF9MRUQKKwl0cmlzdGF0ZSAiR2VuZXJpYyBMRUQgYmFzZWQgQmFja2xp
Z2h0IERyaXZlciIKKwlkZXBlbmRzIG9uIExFRFNfQ0xBU1MgJiYgT0YKKwloZWxwCisJICBJZiB5
b3UgaGF2ZSBhIExDRCBiYWNrbGlnaHQgYWRqdXN0YWJsZSBieSBMRUQgY2xhc3MgZHJpdmVyLCBz
YXkgWQorCSAgdG8gZW5hYmxlIHRoaXMgZHJpdmVyLgorCiBlbmRpZiAjIEJBQ0tMSUdIVF9DTEFT
U19ERVZJQ0UKIAogZW5kbWVudQpkaWZmIC0tZ2l0IGEvZHJpdmVycy92aWRlby9iYWNrbGlnaHQv
TWFrZWZpbGUgYi9kcml2ZXJzL3ZpZGVvL2JhY2tsaWdodC9NYWtlZmlsZQppbmRleCA2M2M1MDdj
MDc0MzcuLjJhNjc2NDI5NjZhNSAxMDA2NDQKLS0tIGEvZHJpdmVycy92aWRlby9iYWNrbGlnaHQv
TWFrZWZpbGUKKysrIGIvZHJpdmVycy92aWRlby9iYWNrbGlnaHQvTWFrZWZpbGUKQEAgLTU3LDMg
KzU3LDQgQEAgb2JqLSQoQ09ORklHX0JBQ0tMSUdIVF9UUFM2NTIxNykJKz0gdHBzNjUyMTdfYmwu
bwogb2JqLSQoQ09ORklHX0JBQ0tMSUdIVF9XTTgzMVgpCQkrPSB3bTgzMXhfYmwubwogb2JqLSQo
Q09ORklHX0JBQ0tMSUdIVF9BUkNYQ05OKSAJKz0gYXJjeGNubl9ibC5vCiBvYmotJChDT05GSUdf
QkFDS0xJR0hUX1JBVkVfU1ApCQkrPSByYXZlLXNwLWJhY2tsaWdodC5vCitvYmotJChDT05GSUdf
QkFDS0xJR0hUX0xFRCkJCSs9IGxlZF9ibC5vCmRpZmYgLS1naXQgYS9kcml2ZXJzL3ZpZGVvL2Jh
Y2tsaWdodC9sZWRfYmwuYyBiL2RyaXZlcnMvdmlkZW8vYmFja2xpZ2h0L2xlZF9ibC5jCm5ldyBm
aWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uNzY0NDI3N2NmZGJiCi0tLSAvZGV2
L251bGwKKysrIGIvZHJpdmVycy92aWRlby9iYWNrbGlnaHQvbGVkX2JsLmMKQEAgLTAsMCArMSwy
MzUgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisvKgorICogQ29weXJp
Z2h0IChDKSAyMDE1LTIwMTkgVGV4YXMgSW5zdHJ1bWVudHMgSW5jb3Jwb3JhdGVkIC0gIGh0dHA6
Ly93d3cudGkuY29tLworICogQXV0aG9yOiBUb21pIFZhbGtlaW5lbiA8dG9taS52YWxrZWluZW5A
dGkuY29tPgorICoKKyAqIEJhc2VkIG9uIHB3bV9ibC5jCisgKi8KKworI2luY2x1ZGUgPGxpbnV4
L2JhY2tsaWdodC5oPgorI2luY2x1ZGUgPGxpbnV4L2dwaW8vY29uc3VtZXIuaD4KKyNpbmNsdWRl
IDxsaW51eC9sZWRzLmg+CisjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+CisjaW5jbHVkZSA8bGlu
dXgvcGxhdGZvcm1fZGV2aWNlLmg+CisjaW5jbHVkZSA8bGludXgvc2xhYi5oPgorCisjZGVmaW5l
IEJLTF9GVUxMX0JSSUdIVE5FU1MgMjU1CisKK3N0cnVjdCBsZWRfYmxfZGF0YSB7CisJc3RydWN0
IGRldmljZQkJKmRldjsKKwlzdHJ1Y3QgYmFja2xpZ2h0X2RldmljZQkqYmxfZGV2OworCXN0cnVj
dCBsZWRfY2xhc3NkZXYJKipsZWRzOworCWJvb2wJCQllbmFibGVkOworCWludAkJCW5iX2xlZHM7
CisJdW5zaWduZWQgaW50CQkqbGV2ZWxzOworCXVuc2lnbmVkIGludAkJZGVmYXVsdF9icmlnaHRu
ZXNzOworCXVuc2lnbmVkIGludAkJbWF4X2JyaWdodG5lc3M7Cit9OworCitzdGF0aWMgaW50IHRv
X2xlZF9icmlnaHRuZXNzKHN0cnVjdCBsZWRfY2xhc3NkZXYgKmxlZCwgaW50IHZhbHVlKQorewor
CXJldHVybiAodmFsdWUgKiBsZWQtPm1heF9icmlnaHRuZXNzKSAvIEJLTF9GVUxMX0JSSUdIVE5F
U1M7Cit9CisKK3N0YXRpYyB2b2lkIGxlZF9ibF9zZXRfYnJpZ2h0bmVzcyhzdHJ1Y3QgbGVkX2Js
X2RhdGEgKnByaXYsIGludCBsZXZlbCkKK3sKKwlpbnQgaTsKKwlpbnQgYmtsX2JyaWdodG5lc3M7
CisKKwlpZiAocHJpdi0+bGV2ZWxzKQorCQlia2xfYnJpZ2h0bmVzcyA9IHByaXYtPmxldmVsc1ts
ZXZlbF07CisJZWxzZQorCQlia2xfYnJpZ2h0bmVzcyA9IGxldmVsOworCisJZm9yIChpID0gMDsg
aSA8IHByaXYtPm5iX2xlZHM7IGkrKykgeworCQlpbnQgbGVkX2JyaWdodG5lc3M7CisJCXN0cnVj
dCBsZWRfY2xhc3NkZXYgKmxlZCA9IHByaXYtPmxlZHNbaV07CisKKwkJbGVkX2JyaWdodG5lc3Mg
PSB0b19sZWRfYnJpZ2h0bmVzcyhsZWQsIGJrbF9icmlnaHRuZXNzKTsKKwkJbGVkX3NldF9icmln
aHRuZXNzKGxlZCwgbGVkX2JyaWdodG5lc3MpOworCX0KKworCXByaXYtPmVuYWJsZWQgPSB0cnVl
OworfQorCitzdGF0aWMgdm9pZCBsZWRfYmxfcG93ZXJfb2ZmKHN0cnVjdCBsZWRfYmxfZGF0YSAq
cHJpdikKK3sKKwlpbnQgaTsKKworCWlmICghcHJpdi0+ZW5hYmxlZCkKKwkJcmV0dXJuOworCisJ
Zm9yIChpID0gMDsgaSA8IHByaXYtPm5iX2xlZHM7IGkrKykKKwkJbGVkX3NldF9icmlnaHRuZXNz
KHByaXYtPmxlZHNbaV0sIExFRF9PRkYpOworCisJcHJpdi0+ZW5hYmxlZCA9IGZhbHNlOworfQor
CitzdGF0aWMgaW50IGxlZF9ibF91cGRhdGVfc3RhdHVzKHN0cnVjdCBiYWNrbGlnaHRfZGV2aWNl
ICpibCkKK3sKKwlzdHJ1Y3QgbGVkX2JsX2RhdGEgKnByaXYgPSBibF9nZXRfZGF0YShibCk7CisJ
aW50IGJyaWdodG5lc3MgPSBibC0+cHJvcHMuYnJpZ2h0bmVzczsKKworCWlmIChibC0+cHJvcHMu
cG93ZXIgIT0gRkJfQkxBTktfVU5CTEFOSyB8fAorCSAgICBibC0+cHJvcHMuZmJfYmxhbmsgIT0g
RkJfQkxBTktfVU5CTEFOSyB8fAorCSAgICBibC0+cHJvcHMuc3RhdGUgJiBCTF9DT1JFX0ZCQkxB
TkspCisJCWJyaWdodG5lc3MgPSAwOworCisJaWYgKGJyaWdodG5lc3MgPiAwKQorCQlsZWRfYmxf
c2V0X2JyaWdodG5lc3MocHJpdiwgYnJpZ2h0bmVzcyk7CisJZWxzZQorCQlsZWRfYmxfcG93ZXJf
b2ZmKHByaXYpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgYmFja2xp
Z2h0X29wcyBsZWRfYmxfb3BzID0geworCS51cGRhdGVfc3RhdHVzCT0gbGVkX2JsX3VwZGF0ZV9z
dGF0dXMsCit9OworCitzdGF0aWMgaW50IGxlZF9ibF9wYXJzZV9kdChzdHJ1Y3QgZGV2aWNlICpk
ZXYsCisJCQkgICBzdHJ1Y3QgbGVkX2JsX2RhdGEgKnByaXYpCit7CisJc3RydWN0IGRldmljZV9u
b2RlICpub2RlID0gZGV2LT5vZl9ub2RlOworCWludCBudW1fbGV2ZWxzOworCXUzMiAqbGV2ZWxz
ID0gTlVMTDsKKwl1MzIgdmFsdWU7CisJaW50IHJldDsKKwlib29sIHVzZV9kZWZhdWx0X2xldmVs
cyA9IGZhbHNlOworCisJaWYgKCFub2RlKQorCQlyZXR1cm4gLUVOT0RFVjsKKworCW51bV9sZXZl
bHMgPSBvZl9wcm9wZXJ0eV9jb3VudF91MzJfZWxlbXMobm9kZSwgImJyaWdodG5lc3MtbGV2ZWxz
Iik7CisJaWYgKG51bV9sZXZlbHMgPCAwKSB7CisJCWRldl93YXJuKGRldiwgImNhbid0IGdldCBi
cmlnaHRuZXNzLWxldmVscy4gdXNpbmcgZGVmYXVsdCBsZXZlbHNcbiIpOworCQl1c2VfZGVmYXVs
dF9sZXZlbHMgPSB0cnVlOworCQludW1fbGV2ZWxzID0gQktMX0ZVTExfQlJJR0hUTkVTUyArIDE7
CisJfQorCisJaWYgKCF1c2VfZGVmYXVsdF9sZXZlbHMpIHsKKwkJbGV2ZWxzID0gZGV2bV9remFs
bG9jKGRldiwgc2l6ZW9mKHUzMikgKiBudW1fbGV2ZWxzLAorCQkJCSAgICAgIEdGUF9LRVJORUwp
OworCQlpZiAoIWxldmVscykKKwkJCXJldHVybiAtRU5PTUVNOworCisJCXJldCA9IG9mX3Byb3Bl
cnR5X3JlYWRfdTMyX2FycmF5KG5vZGUsICJicmlnaHRuZXNzLWxldmVscyIsCisJCQkJCQlsZXZl
bHMsCisJCQkJCQludW1fbGV2ZWxzKTsKKwkJaWYgKHJldCA8IDApCisJCQlyZXR1cm4gcmV0Owor
CX0KKworCXJldCA9IG9mX3Byb3BlcnR5X3JlYWRfdTMyKG5vZGUsICJkZWZhdWx0LWJyaWdodG5l
c3MtbGV2ZWwiLCAmdmFsdWUpOworCWlmIChyZXQgPCAwKQorCQl2YWx1ZSA9IG51bV9sZXZlbHMg
LyAyOworCisJaWYgKHZhbHVlID49IG51bV9sZXZlbHMpIHsKKwkJZGV2X3dhcm4oZGV2LCAiaW52
YWxpZCBkZWZhdWx0LWJyaWdodG5lc3MtbGV2ZWwuIHVzaW5nIGRlZmF1bHRcbiIpOworCQl2YWx1
ZSA9IG51bV9sZXZlbHMgLyAyOworCX0KKworCXJldCA9IG9mX2NvdW50X3BoYW5kbGVfd2l0aF9h
cmdzKG5vZGUsICJsZWRzIiwgTlVMTCk7CisJaWYgKHJldCA8IDApIHsKKwkJZGV2X2VycihkZXYs
ICJ1bmFibGUgdG8gZ2V0IGxlZCBjb3VudFxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKwor
CXByaXYtPm5iX2xlZHMgPSByZXQ7CisJaWYgKHByaXYtPm5iX2xlZHMgPCAxKSB7CisJCWRldl9l
cnIoZGV2LCAiQXQgbGVhc3Qgb25lIExFRCBtdXN0IGJlIHNwZWNpZmllZCFcbiIpOworCQlyZXR1
cm4gLUVJTlZBTDsKKwl9CisKKwlwcml2LT5sZXZlbHMgPSBsZXZlbHM7CisJcHJpdi0+bWF4X2Jy
aWdodG5lc3MgPSBudW1fbGV2ZWxzIC0gMTsKKwlwcml2LT5kZWZhdWx0X2JyaWdodG5lc3MgPSB2
YWx1ZTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGxlZF9ibF9wcm9iZShzdHJ1Y3Qg
cGxhdGZvcm1fZGV2aWNlICpwZGV2KQoreworCXN0cnVjdCBiYWNrbGlnaHRfcHJvcGVydGllcyBw
cm9wczsKKwlzdHJ1Y3QgbGVkX2JsX2RhdGEgKnByaXY7CisJaW50IHJldDsKKwlpbnQgaTsKKwor
CXByaXYgPSBkZXZtX2t6YWxsb2MoJnBkZXYtPmRldiwgc2l6ZW9mKCpwcml2KSwgR0ZQX0tFUk5F
TCk7CisJaWYgKCFwcml2KQorCQlyZXR1cm4gLUVOT01FTTsKKworCXBsYXRmb3JtX3NldF9kcnZk
YXRhKHBkZXYsIHByaXYpOworCisJcHJpdi0+ZGV2ID0gJnBkZXYtPmRldjsKKworCXJldCA9IGxl
ZF9ibF9wYXJzZV9kdCgmcGRldi0+ZGV2LCBwcml2KTsKKwlpZiAocmV0IDwgMCkgeworCQlkZXZf
ZXJyKCZwZGV2LT5kZXYsICJmYWlsZWQgdG8gcGFyc2UgRFQgZGF0YVxuIik7CisJCXJldHVybiBy
ZXQ7CisJfQorCXByaXYtPmxlZHMgPSBkZXZtX2t6YWxsb2MoJnBkZXYtPmRldiwKKwkJCQkgIHNp
emVvZihzdHJ1Y3QgbGVkX2NsYXNzZGV2ICopICogcHJpdi0+bmJfbGVkcywKKwkJCQkgIEdGUF9L
RVJORUwpOworCWlmICghcHJpdi0+bGVkcykKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlmb3IgKGkg
PSAwOyBpIDwgcHJpdi0+bmJfbGVkczsgaSsrKSB7CisJCXByaXYtPmxlZHNbaV0gPSBkZXZtX2xl
ZF9nZXQoJnBkZXYtPmRldiwgaSk7CisJCWlmIChJU19FUlIocHJpdi0+bGVkc1tpXSkpCisJCQly
ZXR1cm4gUFRSX0VSUihwcml2LT5sZWRzW2ldKTsKKwl9CisKKwltZW1zZXQoJnByb3BzLCAwLCBz
aXplb2Yoc3RydWN0IGJhY2tsaWdodF9wcm9wZXJ0aWVzKSk7CisJcHJvcHMudHlwZSA9IEJBQ0tM
SUdIVF9SQVc7CisJcHJvcHMubWF4X2JyaWdodG5lc3MgPSBwcml2LT5tYXhfYnJpZ2h0bmVzczsK
Kwlwcml2LT5ibF9kZXYgPSBiYWNrbGlnaHRfZGV2aWNlX3JlZ2lzdGVyKGRldl9uYW1lKCZwZGV2
LT5kZXYpLAorCQkJJnBkZXYtPmRldiwgcHJpdiwgJmxlZF9ibF9vcHMsICZwcm9wcyk7CisJaWYg
KElTX0VSUihwcml2LT5ibF9kZXYpKSB7CisJCWRldl9lcnIoJnBkZXYtPmRldiwgImZhaWxlZCB0
byByZWdpc3RlciBiYWNrbGlnaHRcbiIpOworCQlyZXQgPSBQVFJfRVJSKHByaXYtPmJsX2Rldik7
CisJCWdvdG8gZXJyOworCX0KKworCXByaXYtPmJsX2Rldi0+cHJvcHMuYnJpZ2h0bmVzcyA9IHBy
aXYtPmRlZmF1bHRfYnJpZ2h0bmVzczsKKwliYWNrbGlnaHRfdXBkYXRlX3N0YXR1cyhwcml2LT5i
bF9kZXYpOworCisJcmV0dXJuIDA7CisKK2VycjoKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMg
aW50IGxlZF9ibF9yZW1vdmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKK3sKKwlzdHJ1
Y3QgbGVkX2JsX2RhdGEgKnByaXYgPSBwbGF0Zm9ybV9nZXRfZHJ2ZGF0YShwZGV2KTsKKwlzdHJ1
Y3QgYmFja2xpZ2h0X2RldmljZSAqYmwgPSBwcml2LT5ibF9kZXY7CisKKwliYWNrbGlnaHRfZGV2
aWNlX3VucmVnaXN0ZXIoYmwpOworCisJbGVkX2JsX3Bvd2VyX29mZihwcml2KTsKKworCXJldHVy
biAwOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IG9mX2RldmljZV9pZCBsZWRfYmxfb2ZfbWF0
Y2hbXSA9IHsKKwl7IC5jb21wYXRpYmxlID0gImxlZC1iYWNrbGlnaHQiIH0sCisJeyB9Cit9Owor
CitNT0RVTEVfREVWSUNFX1RBQkxFKG9mLCBsZWRfYmxfb2ZfbWF0Y2gpOworCitzdGF0aWMgc3Ry
dWN0IHBsYXRmb3JtX2RyaXZlciBsZWRfYmxfZHJpdmVyID0geworCS5kcml2ZXIJCT0geworCQku
bmFtZQkJPSAibGVkLWJhY2tsaWdodCIsCisJCS5vZl9tYXRjaF90YWJsZQk9IG9mX21hdGNoX3B0
cihsZWRfYmxfb2ZfbWF0Y2gpLAorCX0sCisJLnByb2JlCQk9IGxlZF9ibF9wcm9iZSwKKwkucmVt
b3ZlCQk9IGxlZF9ibF9yZW1vdmUsCit9OworCittb2R1bGVfcGxhdGZvcm1fZHJpdmVyKGxlZF9i
bF9kcml2ZXIpOworCitNT0RVTEVfREVTQ1JJUFRJT04oIkxFRCBiYXNlZCBCYWNrbGlnaHQgRHJp
dmVyIik7CitNT0RVTEVfTElDRU5TRSgiR1BMIik7CitNT0RVTEVfQUxJQVMoInBsYXRmb3JtOmxl
ZC1iYWNrbGlnaHQiKTsKLS0gCjIuMTcuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlz
dGluZm8vZHJpLWRldmVs
