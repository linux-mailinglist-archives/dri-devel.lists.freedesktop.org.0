Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id D0C3A38DBC
	for <lists+dri-devel@lfdr.de>; Fri,  7 Jun 2019 16:48:06 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C19B689C96;
	Fri,  7 Jun 2019 14:48:03 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-wr1-x441.google.com (mail-wr1-x441.google.com
 [IPv6:2a00:1450:4864:20::441])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BD82F89C96
 for <dri-devel@lists.freedesktop.org>; Fri,  7 Jun 2019 14:48:01 +0000 (UTC)
Received: by mail-wr1-x441.google.com with SMTP id n4so2470208wrs.3
 for <dri-devel@lists.freedesktop.org>; Fri, 07 Jun 2019 07:48:01 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=g+8MQqoazuC9inUlQVppbCokxOgFYaxlV+7D7so8aNM=;
 b=COf4ZNePNXvH9oauOd9xKR5CgsDsH5TOIme9CRK3BahyGWX5RUEp0bvyJkzM9Q9azL
 jRO3ohE48ZKiDTwqXbPzy3ZDS7kuxWoN8L/oudkWiuDq8f++lxXXpO4OSP1Q2lI2PiTr
 2A5CT7RLwf2TztuvRwsjr2u0iEvCJ9n2lEnI5LRUpOUARgddSyJLV8hYMYy+OfdqQJCO
 sUwRhmefcmjYJ3VshmE9oS8TfFB7O2HXqYLG1JONGXjcI2jisWFrx+whtupk2l7iZZ2y
 HF4+3FJV1VBmSO5n49dKE1IHHHA9EptJaGfaJYU3NBSl0/juAkY/BLowRJYL4/cr7jRx
 /aqQ==
X-Gm-Message-State: APjAAAV+yJTayd+An674XdNaNzuSvSh91bpm7ChEU2OnH0u7mLKRg/aA
 L/lJ+1Tejv5VKQ4viUpcXe4=
X-Google-Smtp-Source: APXvYqxMN9VoHMe6GvGDaaqX/DlwT2LQDNPYuOBSQnrA50sXqmGHEetUlm2T5ffGSIcA4puK0ieodg==
X-Received: by 2002:a5d:5152:: with SMTP id u18mr1061516wrt.319.1559918880317; 
 Fri, 07 Jun 2019 07:48:00 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:c5a0:21d3:d7e7:98b7])
 by smtp.gmail.com with ESMTPSA id 34sm2780039wre.32.2019.06.07.07.47.59
 (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
 Fri, 07 Jun 2019 07:47:59 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: linux-graphics-maintainer@vmware.com, thellstrom@vmware.com,
 dri-devel@lists.freedesktop.org
Subject: [PATCH] drm/ttm: move cpu_writers handling into vmwgfx
Date: Fri,  7 Jun 2019 16:47:58 +0200
Message-Id: <20190607144758.60076-1-christian.koenig@amd.com>
X-Mailer: git-send-email 2.17.1
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=g+8MQqoazuC9inUlQVppbCokxOgFYaxlV+7D7so8aNM=;
 b=f0xzUofOcSP96J4IdNmyviSXaf3H3TvWN6TN0aaQhdoOjZXRurYQyH8mvUMEB6GmZL
 QhbcobyATucFuAPEdHVpPGTqqjGEa319wN80aeE5Fwlkv4dSnf4slirYmtoXdCSn779g
 XHJ1sTNjRHn5zDwSW/3qe+RQA2m86yU6t/cY/pQygmDBhJzPvJrTUO3WYef7xasiOA9V
 Zqhe42LXcmBwlNLo4mQDa+ypK5+41/fDS9sj7HCr11eQUVplO/i3VKJoKuht681h30MY
 VXLqsqF+L2NrQt0GmWdcWFc3F2o6qhTIMiEqplD003N0OBXQktlSUV08zaReNOi45nbm
 xQwQ==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBmZWF0dXJlIGlzIG9ubHkgdXNlZCBieSB2bXdnZnggYW5kIHN1cGVyZmxvdXMgZm9yIGV2
ZXJ5Ym9keSBlbHNlLgoKU2lnbmVkLW9mZi1ieTogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0aWFu
LmtvZW5pZ0BhbWQuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvLmMgICAgICAg
ICAgICAgfCAyNyAtLS0tLS0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2Jv
X3V0aWwuYyAgICAgICAgfCAgMSAtCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9leGVjYnVmX3V0
aWwuYyAgIHwgIDcgKy0tLS0KIGRyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2JvLmMgICAg
ICAgfCAzNSArKysrKysrKysrKysrKysrKysrKy0tLS0KIGRyaXZlcnMvZ3B1L2RybS92bXdnZngv
dm13Z2Z4X2Rydi5oICAgICAgfCAgMiArKwogZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhf
ZXhlY2J1Zi5jICB8ICA4ICsrKysrKwogZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfcmVz
b3VyY2UuYyB8ICA0ICsrKwogaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19hcGkuaCAgICAgICAgICAg
ICB8IDMxIC0tLS0tLS0tLS0tLS0tLS0tLS0tLQogOCBmaWxlcyBjaGFuZ2VkLCA0NSBpbnNlcnRp
b25zKCspLCA3MCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdHRt
L3R0bV9iby5jIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm8uYwppbmRleCBjN2RlNjY3ZDQ4
MmEuLjRlYzA1NWZmZDZhNyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm8u
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5jCkBAIC0xNTMsNyArMTUzLDYgQEAg
c3RhdGljIHZvaWQgdHRtX2JvX3JlbGVhc2VfbGlzdChzdHJ1Y3Qga3JlZiAqbGlzdF9rcmVmKQog
CiAJQlVHX09OKGtyZWZfcmVhZCgmYm8tPmxpc3Rfa3JlZikpOwogCUJVR19PTihrcmVmX3JlYWQo
JmJvLT5rcmVmKSk7Ci0JQlVHX09OKGF0b21pY19yZWFkKCZiby0+Y3B1X3dyaXRlcnMpKTsKIAlC
VUdfT04oYm8tPm1lbS5tbV9ub2RlICE9IE5VTEwpOwogCUJVR19PTighbGlzdF9lbXB0eSgmYm8t
PmxydSkpOwogCUJVR19PTighbGlzdF9lbXB0eSgmYm8tPmRkZXN0cm95KSk7CkBAIC0xMzA4LDcg
KzEzMDcsNiBAQCBpbnQgdHRtX2JvX2luaXRfcmVzZXJ2ZWQoc3RydWN0IHR0bV9ib19kZXZpY2Ug
KmJkZXYsCiAKIAlrcmVmX2luaXQoJmJvLT5rcmVmKTsKIAlrcmVmX2luaXQoJmJvLT5saXN0X2ty
ZWYpOwotCWF0b21pY19zZXQoJmJvLT5jcHVfd3JpdGVycywgMCk7CiAJSU5JVF9MSVNUX0hFQUQo
JmJvLT5scnUpOwogCUlOSVRfTElTVF9IRUFEKCZiby0+ZGRlc3Ryb3kpOwogCUlOSVRfTElTVF9I
RUFEKCZiby0+c3dhcCk7CkBAIC0xODE0LDMxICsxODEyLDYgQEAgaW50IHR0bV9ib193YWl0KHN0
cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiB9CiBFWFBPUlRfU1lNQk9MKHR0bV9ib193YWl0
KTsKIAotaW50IHR0bV9ib19zeW5jY3B1X3dyaXRlX2dyYWIoc3RydWN0IHR0bV9idWZmZXJfb2Jq
ZWN0ICpibywgYm9vbCBub193YWl0KQotewotCWludCByZXQgPSAwOwotCi0JLyoKLQkgKiBVc2lu
ZyB0dG1fYm9fcmVzZXJ2ZSBtYWtlcyBzdXJlIHRoZSBscnUgbGlzdHMgYXJlIHVwZGF0ZWQuCi0J
ICovCi0KLQlyZXQgPSB0dG1fYm9fcmVzZXJ2ZShibywgdHJ1ZSwgbm9fd2FpdCwgTlVMTCk7Ci0J
aWYgKHVubGlrZWx5KHJldCAhPSAwKSkKLQkJcmV0dXJuIHJldDsKLQlyZXQgPSB0dG1fYm9fd2Fp
dChibywgdHJ1ZSwgbm9fd2FpdCk7Ci0JaWYgKGxpa2VseShyZXQgPT0gMCkpCi0JCWF0b21pY19p
bmMoJmJvLT5jcHVfd3JpdGVycyk7Ci0JdHRtX2JvX3VucmVzZXJ2ZShibyk7Ci0JcmV0dXJuIHJl
dDsKLX0KLUVYUE9SVF9TWU1CT0wodHRtX2JvX3N5bmNjcHVfd3JpdGVfZ3JhYik7Ci0KLXZvaWQg
dHRtX2JvX3N5bmNjcHVfd3JpdGVfcmVsZWFzZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJv
KQotewotCWF0b21pY19kZWMoJmJvLT5jcHVfd3JpdGVycyk7Ci19Ci1FWFBPUlRfU1lNQk9MKHR0
bV9ib19zeW5jY3B1X3dyaXRlX3JlbGVhc2UpOwotCiAvKioKICAqIEEgYnVmZmVyIG9iamVjdCBz
aHJpbmsgbWV0aG9kIHRoYXQgdHJpZXMgdG8gc3dhcCBvdXQgdGhlIGZpcnN0CiAgKiBidWZmZXIg
b2JqZWN0IG9uIHRoZSBib19nbG9iYWw6OnN3YXBfbHJ1IGxpc3QuCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGlsLmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9i
b191dGlsLmMKaW5kZXggODk1ZDc3ZDc5OWU0Li42ZjQzZjFmMGRlN2MgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3V0aWwuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdHRt
L3R0bV9ib191dGlsLmMKQEAgLTUxMSw3ICs1MTEsNiBAQCBzdGF0aWMgaW50IHR0bV9idWZmZXJf
b2JqZWN0X3RyYW5zZmVyKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJbXV0ZXhfaW5p
dCgmZmJvLT5iYXNlLnd1X211dGV4KTsKIAlmYm8tPmJhc2UubW92aW5nID0gTlVMTDsKIAlkcm1f
dm1hX25vZGVfcmVzZXQoJmZiby0+YmFzZS52bWFfbm9kZSk7Ci0JYXRvbWljX3NldCgmZmJvLT5i
YXNlLmNwdV93cml0ZXJzLCAwKTsKIAogCWtyZWZfaW5pdCgmZmJvLT5iYXNlLmxpc3Rfa3JlZik7
CiAJa3JlZl9pbml0KCZmYm8tPmJhc2Uua3JlZik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vdHRtL3R0bV9leGVjYnVmX3V0aWwuYyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2V4ZWNi
dWZfdXRpbC5jCmluZGV4IDk1N2VjMzc1YTRiYS4uODBmYTUyYjM2ZDVjIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9leGVjYnVmX3V0aWwuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vdHRtL3R0bV9leGVjYnVmX3V0aWwuYwpAQCAtMTEzLDEyICsxMTMsNyBAQCBpbnQgdHRtX2V1
X3Jlc2VydmVfYnVmZmVycyhzdHJ1Y3Qgd3dfYWNxdWlyZV9jdHggKnRpY2tldCwKIAkJc3RydWN0
IHR0bV9idWZmZXJfb2JqZWN0ICpibyA9IGVudHJ5LT5ibzsKIAogCQlyZXQgPSBfX3R0bV9ib19y
ZXNlcnZlKGJvLCBpbnRyLCAodGlja2V0ID09IE5VTEwpLCB0aWNrZXQpOwotCQlpZiAoIXJldCAm
JiB1bmxpa2VseShhdG9taWNfcmVhZCgmYm8tPmNwdV93cml0ZXJzKSA+IDApKSB7Ci0JCQlyZXNl
cnZhdGlvbl9vYmplY3RfdW5sb2NrKGJvLT5yZXN2KTsKLQotCQkJcmV0ID0gLUVCVVNZOwotCi0J
CX0gZWxzZSBpZiAocmV0ID09IC1FQUxSRUFEWSAmJiBkdXBzKSB7CisJCWlmIChyZXQgPT0gLUVB
TFJFQURZICYmIGR1cHMpIHsKIAkJCXN0cnVjdCB0dG1fdmFsaWRhdGVfYnVmZmVyICpzYWZlID0g
ZW50cnk7CiAJCQllbnRyeSA9IGxpc3RfcHJldl9lbnRyeShlbnRyeSwgaGVhZCk7CiAJCQlsaXN0
X2RlbCgmc2FmZS0+aGVhZCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Zt
d2dmeF9iby5jIGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfYm8uYwppbmRleCA1ZDVj
MmJjZTAxZjMuLjQ1Nzg2MWM1MDQ3ZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dm
eC92bXdnZnhfYm8uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9iby5jCkBA
IC01NjUsNyArNTY1LDcgQEAgc3RhdGljIHZvaWQgdm13X3VzZXJfYm9fcmVmX29ial9yZWxlYXNl
KHN0cnVjdCB0dG1fYmFzZV9vYmplY3QgKmJhc2UsCiAKIAlzd2l0Y2ggKHJlZl90eXBlKSB7CiAJ
Y2FzZSBUVE1fUkVGX1NZTkNDUFVfV1JJVEU6Ci0JCXR0bV9ib19zeW5jY3B1X3dyaXRlX3JlbGVh
c2UoJnVzZXJfYm8tPnZiby5iYXNlKTsKKwkJYXRvbWljX2RlYygmdXNlcl9iby0+dmJvLmNwdV93
cml0ZXJzKTsKIAkJYnJlYWs7CiAJZGVmYXVsdDoKIAkJV0FSTl9PTkNFKHRydWUsICJVbmRlZmlu
ZWQgYnVmZmVyIG9iamVjdCByZWZlcmVuY2UgcmVsZWFzZS5cbiIpOwpAQCAtNjgxLDEyICs2ODEs
MTIgQEAgc3RhdGljIGludCB2bXdfdXNlcl9ib19zeW5jY3B1X2dyYWIoc3RydWN0IHZtd191c2Vy
X2J1ZmZlcl9vYmplY3QgKnVzZXJfYm8sCiAJCQkJICAgIHN0cnVjdCB0dG1fb2JqZWN0X2ZpbGUg
KnRmaWxlLAogCQkJCSAgICB1aW50MzJfdCBmbGFncykKIHsKKwlib29sIG5vbmJsb2NrID0gISEo
ZmxhZ3MgJiBkcm1fdm13X3N5bmNjcHVfZG9udGJsb2NrKTsKIAlzdHJ1Y3QgdHRtX2J1ZmZlcl9v
YmplY3QgKmJvID0gJnVzZXJfYm8tPnZiby5iYXNlOwogCWJvb2wgZXhpc3RlZDsKIAlpbnQgcmV0
OwogCiAJaWYgKGZsYWdzICYgZHJtX3Ztd19zeW5jY3B1X2FsbG93X2NzKSB7Ci0JCWJvb2wgbm9u
YmxvY2sgPSAhIShmbGFncyAmIGRybV92bXdfc3luY2NwdV9kb250YmxvY2spOwogCQlsb25nIGxy
ZXQ7CiAKIAkJbHJldCA9IHJlc2VydmF0aW9uX29iamVjdF93YWl0X3RpbWVvdXRfcmN1CkBAIC02
OTksMTUgKzY5OSwyMCBAQCBzdGF0aWMgaW50IHZtd191c2VyX2JvX3N5bmNjcHVfZ3JhYihzdHJ1
Y3Qgdm13X3VzZXJfYnVmZmVyX29iamVjdCAqdXNlcl9ibywKIAkJcmV0dXJuIDA7CiAJfQogCi0J
cmV0ID0gdHRtX2JvX3N5bmNjcHVfd3JpdGVfZ3JhYgotCQkoYm8sICEhKGZsYWdzICYgZHJtX3Zt
d19zeW5jY3B1X2RvbnRibG9jaykpOworCXJldCA9IHR0bV9ib19yZXNlcnZlKGJvLCB0cnVlLCBu
b25ibG9jaywgTlVMTCk7CisJaWYgKHVubGlrZWx5KHJldCAhPSAwKSkKKwkJcmV0dXJuIHJldDsK
KwlyZXQgPSB0dG1fYm9fd2FpdChibywgdHJ1ZSwgbm9uYmxvY2spOworCWlmIChsaWtlbHkocmV0
ID09IDApKQorCQlhdG9taWNfaW5jKCZ1c2VyX2JvLT52Ym8uY3B1X3dyaXRlcnMpOworCXR0bV9i
b191bnJlc2VydmUoYm8pOwogCWlmICh1bmxpa2VseShyZXQgIT0gMCkpCiAJCXJldHVybiByZXQ7
CiAKIAlyZXQgPSB0dG1fcmVmX29iamVjdF9hZGQodGZpbGUsICZ1c2VyX2JvLT5wcmltZS5iYXNl
LAogCQkJCSBUVE1fUkVGX1NZTkNDUFVfV1JJVEUsICZleGlzdGVkLCBmYWxzZSk7CiAJaWYgKHJl
dCAhPSAwIHx8IGV4aXN0ZWQpCi0JCXR0bV9ib19zeW5jY3B1X3dyaXRlX3JlbGVhc2UoJnVzZXJf
Ym8tPnZiby5iYXNlKTsKKwkJYXRvbWljX2RlYygmdXNlcl9iby0+dmJvLmNwdV93cml0ZXJzKTsK
IAogCXJldHVybiByZXQ7CiB9CkBAIC03MzEsNiArNzM2LDI2IEBAIHN0YXRpYyBpbnQgdm13X3Vz
ZXJfYm9fc3luY2NwdV9yZWxlYXNlKHVpbnQzMl90IGhhbmRsZSwKIAlyZXR1cm4gMDsKIH0KIAor
LyoqCisgKiB2bXdfdXNlcl9ib192ZXJpZnlfc3luY2NwdSAtIFZlcmlmeSBpZiBncmFiIGZvciBD
UFUgYWNjZXNzIGV4aXN0cworICoKKyAqIEBsaXN0OiBsaXN0IG9mIHR0bV92YWxpZGF0ZV9idWZm
ZXIgb2JqZWN0cworICoKKyAqIFJldHVybjoKKyAqIC1FQlVTWSBpZiBhIENQVSBncmFiIGlzIGZv
dW5kLCAwIG90aGVyd2lzZS4KKyAqLworaW50IHZtd191c2VyX2JvX3ZlcmlmeV9zeW5jY3B1KHN0
cnVjdCBsaXN0X2hlYWQgKmxpc3QpCit7CisJc3RydWN0IHR0bV92YWxpZGF0ZV9idWZmZXIgKmVu
dHJ5OworCisJbGlzdF9mb3JfZWFjaF9lbnRyeShlbnRyeSwgbGlzdCwgaGVhZCkgeworCQlzdHJ1
Y3Qgdm13X2J1ZmZlcl9vYmplY3QgKmJvID0gdm13X2J1ZmZlcl9vYmplY3QoZW50cnktPmJvKTsK
KworICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseShhdG9taWNfcmVhZCgmYm8tPmNwdV93cml0
ZXJzKSA+IDApKQorCQkJcmV0dXJuIC1FQlVTWTsKKwl9CisJcmV0dXJuIDA7Cit9CiAKIC8qKgog
ICogdm13X3VzZXJfYm9fc3luY2NwdV9pb2N0bCAtIGlvY3RsIGZ1bmN0aW9uIGltcGxlbWVudGlu
ZyB0aGUgc3luY2NwdQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhf
ZHJ2LmggYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9kcnYuaAppbmRleCA5Njk4M2M0
N2ZiNDAuLmIzOTg4Yzk1N2YwZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92
bXdnZnhfZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfZHJ2LmgKQEAg
LTkwLDYgKzkwLDcgQEAgc3RydWN0IHZtd19idWZmZXJfb2JqZWN0IHsKIAlzdHJ1Y3QgdHRtX2J1
ZmZlcl9vYmplY3QgYmFzZTsKIAlzdHJ1Y3QgbGlzdF9oZWFkIHJlc19saXN0OwogCXMzMiBwaW5f
Y291bnQ7CisJYXRvbWljX3QgY3B1X3dyaXRlcnM7CiAJLyogTm90IHJlZi1jb3VudGVkLiAgUHJv
dGVjdGVkIGJ5IGJpbmRpbmdfbXV0ZXggKi8KIAlzdHJ1Y3Qgdm13X3Jlc291cmNlICpkeF9xdWVy
eV9jdHg7CiAJLyogUHJvdGVjdGVkIGJ5IHJlc2VydmF0aW9uICovCkBAIC03NDksNiArNzUwLDcg
QEAgZXh0ZXJuIGludCB2bXdfYm9faW5pdChzdHJ1Y3Qgdm13X3ByaXZhdGUgKmRldl9wcml2LAog
CQkgICAgICAgdm9pZCAoKmJvX2ZyZWUpKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8pKTsK
IGV4dGVybiBpbnQgdm13X3VzZXJfYm9fdmVyaWZ5X2FjY2VzcyhzdHJ1Y3QgdHRtX2J1ZmZlcl9v
YmplY3QgKmJvLAogCQkJCSAgICAgc3RydWN0IHR0bV9vYmplY3RfZmlsZSAqdGZpbGUpOworZXh0
ZXJuIGludCB2bXdfdXNlcl9ib192ZXJpZnlfc3luY2NwdShzdHJ1Y3QgbGlzdF9oZWFkICpsaXN0
KTsKIGV4dGVybiBpbnQgdm13X3VzZXJfYm9fYWxsb2Moc3RydWN0IHZtd19wcml2YXRlICpkZXZf
cHJpdiwKIAkJCSAgICAgc3RydWN0IHR0bV9vYmplY3RfZmlsZSAqdGZpbGUsCiAJCQkgICAgIHVp
bnQzMl90IHNpemUsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9l
eGVjYnVmLmMgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9leGVjYnVmLmMKaW5kZXgg
MmZmN2JhMDRkOGM4Li4yNzEyMTdmNmUzYTMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92
bXdnZngvdm13Z2Z4X2V4ZWNidWYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dm
eF9leGVjYnVmLmMKQEAgLTM3MTksNiArMzcxOSwxMCBAQCBpbnQgdm13X2V4ZWNidWZfcHJvY2Vz
cyhzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdiwKIAlpZiAodW5saWtlbHkocmV0ICE9IDApKQog
CQlnb3RvIG91dF9lcnJfbm9yZXM7CiAKKwlyZXQgPSB2bXdfdXNlcl9ib192ZXJpZnlfc3luY2Nw
dSgmdmFsX2N0eC5ib19saXN0KTsKKwlpZiAodW5saWtlbHkocmV0ICE9IDApKQorCQlnb3RvIG91
dF9lcnI7CisKIAlyZXQgPSB2bXdfdmFsaWRhdGlvbl9ib192YWxpZGF0ZSgmdmFsX2N0eCwgdHJ1
ZSk7CiAJaWYgKHVubGlrZWx5KHJldCAhPSAwKSkKIAkJZ290byBvdXRfZXJyOwpAQCAtMzkxOCw2
ICszOTIyLDEwIEBAIHZvaWQgX192bXdfZXhlY2J1Zl9yZWxlYXNlX3Bpbm5lZF9ibyhzdHJ1Y3Qg
dm13X3ByaXZhdGUgKmRldl9wcml2LAogCWlmIChyZXQpCiAJCWdvdG8gb3V0X25vX3Jlc2VydmU7
CiAKKwlyZXQgPSB2bXdfdXNlcl9ib192ZXJpZnlfc3luY2NwdSgmdmFsX2N0eC5ib19saXN0KTsK
KwlpZiAodW5saWtlbHkocmV0ICE9IDApKQorCQlnb3RvIG91dF9ub19lbWl0OworCiAJaWYgKGRl
dl9wcml2LT5xdWVyeV9jaWRfdmFsaWQpIHsKIAkJQlVHX09OKGZlbmNlICE9IE5VTEwpOwogCQly
ZXQgPSB2bXdfZmlmb19lbWl0X2R1bW15X3F1ZXJ5KGRldl9wcml2LCBkZXZfcHJpdi0+cXVlcnlf
Y2lkKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3Jlc291cmNl
LmMgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9yZXNvdXJjZS5jCmluZGV4IDFkMzhh
OGIyZjJlYy4uYzU1ZGE2ZjBmZjAzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4
L3Ztd2dmeF9yZXNvdXJjZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3Jl
c291cmNlLmMKQEAgLTQ2OSw2ICs0NjksMTAgQEAgdm13X3Jlc291cmNlX2NoZWNrX2J1ZmZlcihz
dHJ1Y3Qgd3dfYWNxdWlyZV9jdHggKnRpY2tldCwKIAlpZiAodW5saWtlbHkocmV0ICE9IDApKQog
CQlnb3RvIG91dF9ub19yZXNlcnZlOwogCisJcmV0ID0gdm13X3VzZXJfYm9fdmVyaWZ5X3N5bmNj
cHUoJnZhbF9saXN0KTsKKwlpZiAodW5saWtlbHkocmV0ICE9IDApKQorCQlnb3RvIG91dF9ub192
YWxpZGF0ZTsKKwogCWlmIChyZXMtPmZ1bmMtPm5lZWRzX2JhY2t1cCAmJiBsaXN0X2VtcHR5KCZy
ZXMtPm1vYl9oZWFkKSkKIAkJcmV0dXJuIDA7CiAKZGlmZiAtLWdpdCBhL2luY2x1ZGUvZHJtL3R0
bS90dG1fYm9fYXBpLmggYi9pbmNsdWRlL2RybS90dG0vdHRtX2JvX2FwaS5oCmluZGV4IDQ5ZDlj
ZGZjNThmMi4uZTM1OGU5NjVkNGMwIDEwMDY0NAotLS0gYS9pbmNsdWRlL2RybS90dG0vdHRtX2Jv
X2FwaS5oCisrKyBiL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmgKQEAgLTE0NSw3ICsxNDUs
NiBAQCBzdHJ1Y3QgdHRtX3R0OwogICogaG9sZHMgYSBwb2ludGVyIHRvIGEgcGVyc2lzdGVudCBz
aG1lbSBvYmplY3QuCiAgKiBAdHRtOiBUVE0gc3RydWN0dXJlIGhvbGRpbmcgc3lzdGVtIHBhZ2Vz
LgogICogQGV2aWN0ZWQ6IFdoZXRoZXIgdGhlIG9iamVjdCB3YXMgZXZpY3RlZCB3aXRob3V0IHVz
ZXItc3BhY2Uga25vd2luZy4KLSAqIEBjcHVfd3JpdGVzOiBGb3Igc3luY2hyb25pemF0aW9uLiBO
dW1iZXIgb2YgY3B1IHdyaXRlcnMuCiAgKiBAbHJ1OiBMaXN0IGhlYWQgZm9yIHRoZSBscnUgbGlz
dC4KICAqIEBkZGVzdHJveTogTGlzdCBoZWFkIGZvciB0aGUgZGVsYXllZCBkZXN0cm95IGxpc3Qu
CiAgKiBAc3dhcDogTGlzdCBoZWFkIGZvciBzd2FwIExSVSBsaXN0LgpAQCAtMTk1LDExICsxOTQs
NiBAQCBzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgewogCXN0cnVjdCB0dG1fdHQgKnR0bTsKIAli
b29sIGV2aWN0ZWQ7CiAKLQkvKioKLQkgKiBNZW1iZXJzIHByb3RlY3RlZCBieSB0aGUgYm86OnJl
c2VydmVkIGxvY2sgb25seSB3aGVuIHdyaXR0ZW4gdG8uCi0JICovCi0KLQlhdG9taWNfdCBjcHVf
d3JpdGVyczsKIAogCS8qKgogCSAqIE1lbWJlcnMgcHJvdGVjdGVkIGJ5IHRoZSBiZGV2OjpscnVf
bG9jay4KQEAgLTQ0MywzMSArNDM3LDYgQEAgdm9pZCB0dG1fYm9fdW5sb2NrX2RlbGF5ZWRfd29y
a3F1ZXVlKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LCBpbnQgcmVzY2hlZCk7CiBib29sIHR0
bV9ib19ldmljdGlvbl92YWx1YWJsZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQkJ
ICAgICAgY29uc3Qgc3RydWN0IHR0bV9wbGFjZSAqcGxhY2UpOwogCi0vKioKLSAqIHR0bV9ib19z
eW5jY3B1X3dyaXRlX2dyYWIKLSAqCi0gKiBAYm86IFRoZSBidWZmZXIgb2JqZWN0OgotICogQG5v
X3dhaXQ6IFJldHVybiBpbW1lZGlhdGVseSBpZiBidWZmZXIgaXMgYnVzeS4KLSAqCi0gKiBTeW5j
aHJvbml6ZXMgYSBidWZmZXIgb2JqZWN0IGZvciBDUFUgUlcgYWNjZXNzLiBUaGlzIG1lYW5zCi0g
KiBjb21tYW5kIHN1Ym1pc3Npb24gdGhhdCBhZmZlY3RzIHRoZSBidWZmZXIgd2lsbCByZXR1cm4g
LUVCVVNZCi0gKiB1bnRpbCB0dG1fYm9fc3luY2NwdV93cml0ZV9yZWxlYXNlIGlzIGNhbGxlZC4K
LSAqCi0gKiBSZXR1cm5zCi0gKiAtRUJVU1kgaWYgdGhlIGJ1ZmZlciBpcyBidXN5IGFuZCBub193
YWl0IGlzIHRydWUuCi0gKiAtRVJFU1RBUlRTWVMgaWYgaW50ZXJydXB0ZWQgYnkgYSBzaWduYWwu
Ci0gKi8KLWludCB0dG1fYm9fc3luY2NwdV93cml0ZV9ncmFiKHN0cnVjdCB0dG1fYnVmZmVyX29i
amVjdCAqYm8sIGJvb2wgbm9fd2FpdCk7Ci0KLS8qKgotICogdHRtX2JvX3N5bmNjcHVfd3JpdGVf
cmVsZWFzZToKLSAqCi0gKiBAYm8gOiBUaGUgYnVmZmVyIG9iamVjdC4KLSAqCi0gKiBSZWxlYXNl
cyBhIHN5bmNjcHUgbG9jay4KLSAqLwotdm9pZCB0dG1fYm9fc3luY2NwdV93cml0ZV9yZWxlYXNl
KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8pOwotCiAvKioKICAqIHR0bV9ib19hY2Nfc2l6
ZQogICoKLS0gCjIuMTcuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0
b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJp
LWRldmVs
