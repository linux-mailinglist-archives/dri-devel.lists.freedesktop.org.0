Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 7DF691079D7
	for <lists+dri-devel@lfdr.de>; Fri, 22 Nov 2019 22:09:48 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 89EA36F593;
	Fri, 22 Nov 2019 21:09:18 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mga07.intel.com (mga07.intel.com [134.134.136.100])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 833986F57D;
 Fri, 22 Nov 2019 21:09:02 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga007.fm.intel.com ([10.253.24.52])
 by orsmga105.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 22 Nov 2019 13:09:01 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.69,231,1571727600"; d="scan'208";a="205575875"
Received: from nvishwa1-desk.sc.intel.com ([10.3.160.185])
 by fmsmga007.fm.intel.com with ESMTP; 22 Nov 2019 13:09:00 -0800
From: Niranjana Vishwanathapura <niranjana.vishwanathapura@intel.com>
To: intel-gfx@lists.freedesktop.org
Subject: [RFC 12/13] drm/i915/svm: Add support to en/disable SVM
Date: Fri, 22 Nov 2019 12:57:33 -0800
Message-Id: <20191122205734.15925-13-niranjana.vishwanathapura@intel.com>
X-Mailer: git-send-email 2.21.0.rc0.32.g243a4c7e27
In-Reply-To: <20191122205734.15925-1-niranjana.vishwanathapura@intel.com>
References: <20191122205734.15925-1-niranjana.vishwanathapura@intel.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: sanjay.k.kumar@intel.com, sudeep.dutt@intel.com,
 dri-devel@lists.freedesktop.org, dave.hansen@intel.com, jglisse@redhat.com,
 jon.bloomfield@intel.com, daniel.vetter@intel.com, dan.j.williams@intel.com,
 ira.weiny@intel.com, jgg@mellanox.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIFNWTSBhcyBhIGNhcGFiaWxpdHkgYW5kIGFsbG93IHVzZXIgdG8gZW5hYmxlL2Rpc2FibGUg
U1ZNCmZ1bmN0aW9uYWxpdHkgb24gYSBwZXIgY29udGV4dCBiYXNpcy4KCkNjOiBKb29uYXMgTGFo
dGluZW4gPGpvb25hcy5sYWh0aW5lbkBsaW51eC5pbnRlbC5jb20+CkNjOiBKb24gQmxvb21maWVs
ZCA8am9uLmJsb29tZmllbGRAaW50ZWwuY29tPgpDYzogRGFuaWVsIFZldHRlciA8ZGFuaWVsLnZl
dHRlckBpbnRlbC5jb20+CkNjOiBTdWRlZXAgRHV0dCA8c3VkZWVwLmR1dHRAaW50ZWwuY29tPgpT
aWduZWQtb2ZmLWJ5OiBOaXJhbmphbmEgVmlzaHdhbmF0aGFwdXJhIDxuaXJhbmphbmEudmlzaHdh
bmF0aGFwdXJhQGludGVsLmNvbT4KU2lnbmVkLW9mZi1ieTogVmVua2F0YSBTYW5kZWVwIERoYW5h
bGFrb3RhIDx2ZW5rYXRhLnMuZGhhbmFsYWtvdGFAaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMgICB8IDk1ICsrKysrKysrKysrKysrKysr
Ky0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmggICB8ICAyICsK
IC4uLi9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaCB8ICAxICsKIC4u
Li9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyAgICB8ICA2ICsrCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMgICAgfCAxMSArKysKIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgICAgICAgICAgICAgICB8ICA0ICstCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oICAgICAgICAgICAgICAgfCAxMCArKwogZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9nZXRwYXJhbS5jICAgICAgICAgIHwgIDMgKwogOCBmaWxlcyBjaGFu
Z2VkLCAxMjggaW5zZXJ0aW9ucygrKSwgNCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYwppbmRleCA0NjkyNjQ3OGVkMmUuLmJjNmNiZjNi
M2Q5NyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRl
eHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCkBA
IC03Niw2ICs3Niw3IEBACiAKICNpbmNsdWRlICJpOTE1X2dlbV9jb250ZXh0LmgiCiAjaW5jbHVk
ZSAiaTkxNV9nbG9iYWxzLmgiCisjaW5jbHVkZSAiaTkxNV9zdm0uaCIKICNpbmNsdWRlICJpOTE1
X3RyYWNlLmgiCiAjaW5jbHVkZSAiaTkxNV91c2VyX2V4dGVuc2lvbnMuaCIKICNpbmNsdWRlICJp
OTE1X2dlbV9pb2N0bHMuaCIKQEAgLTk2NSw2ICs5NjYsNzggQEAgaW50IGk5MTVfZ2VtX3ZtX2Rl
c3Ryb3lfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIAlyZXR1cm4g
MDsKIH0KIAorc3RhdGljIGludCBpOTE1X2dlbV92bV9zZXRwYXJhbV9pb2N0bChzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAorCQkJCSAgICAgIHN0cnVjdCBkcm1fZmlsZSAqZmls
ZSkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfZmlsZV9wcml2YXRlICpmaWxlX3ByaXYgPSBmaWxlLT5k
cml2ZXJfcHJpdjsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX3ZtX3BhcmFtICphcmdzID0gZGF0YTsK
KwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsKKwlpbnQgZXJyID0gMDsKKwl1MzIgaWQ7
CisKKwlpZCA9IGFyZ3MtPnZtX2lkOworCWlmICghaWQpCisJCXJldHVybiAtRU5PRU5UOworCisJ
ZXJyID0gbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKCZmaWxlX3ByaXYtPnZtX2lkcl9sb2NrKTsK
KwlpZiAoZXJyKQorCQlyZXR1cm4gZXJyOworCisJdm0gPSBpZHJfZmluZCgmZmlsZV9wcml2LT52
bV9pZHIsIGlkKTsKKworCW11dGV4X3VubG9jaygmZmlsZV9wcml2LT52bV9pZHJfbG9jayk7CisJ
aWYgKCF2bSkKKwkJcmV0dXJuIC1FTk9FTlQ7CisKKwlzd2l0Y2ggKGxvd2VyXzMyX2JpdHMoYXJn
cy0+cGFyYW0pKSB7CisJY2FzZSBJOTE1X0dFTV9WTV9QQVJBTV9TVk06CisJCS8qIEZJWE1FOiBF
bnN1cmUgcHBndHQgaXMgZW1wdHkgYmVmb3JlIHN3aXRjaGluZyAqLworCQlpZiAoIWk5MTVfaGFz
X3N2bShmaWxlX3ByaXYtPmRldl9wcml2KSkKKwkJCWVyciA9IC1FTk9UU1VQUDsKKwkJZWxzZSBp
ZiAoYXJncy0+dmFsdWUpCisJCQllcnIgPSBpOTE1X3N2bV9iaW5kX21tKHZtKTsKKwkJZWxzZQor
CQkJaTkxNV9zdm1fdW5iaW5kX21tKHZtKTsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJZXJyID0g
LUVJTlZBTDsKKwl9CisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIGludCBpOTE1X2dlbV92bV9n
ZXRwYXJhbV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAorCQkJCSAg
ICAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfZmlsZV9wcml2
YXRlICpmaWxlX3ByaXYgPSBmaWxlLT5kcml2ZXJfcHJpdjsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X3ZtX3BhcmFtICphcmdzID0gZGF0YTsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsK
KwlpbnQgZXJyID0gMDsKKwl1MzIgaWQ7CisKKwlpZCA9IGFyZ3MtPnZtX2lkOworCWlmICghaWQp
CisJCXJldHVybiAtRU5PRU5UOworCisJZXJyID0gbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKCZm
aWxlX3ByaXYtPnZtX2lkcl9sb2NrKTsKKwlpZiAoZXJyKQorCQlyZXR1cm4gZXJyOworCisJdm0g
PSBpZHJfZmluZCgmZmlsZV9wcml2LT52bV9pZHIsIGlkKTsKKworCW11dGV4X3VubG9jaygmZmls
ZV9wcml2LT52bV9pZHJfbG9jayk7CisJaWYgKCF2bSkKKwkJcmV0dXJuIC1FTk9FTlQ7CisKKwlz
d2l0Y2ggKGxvd2VyXzMyX2JpdHMoYXJncy0+cGFyYW0pKSB7CisJY2FzZSBJOTE1X0dFTV9WTV9Q
QVJBTV9TVk06CisJCWFyZ3MtPnZhbHVlID0gaTkxNV92bV9pc19zdm1fZW5hYmxlZCh2bSk7CisJ
CWJyZWFrOworCWRlZmF1bHQ6CisJCWVyciA9IC1FSU5WQUw7CisJfQorCXJldHVybiBlcnI7Cit9
CisKIHN0cnVjdCBjb250ZXh0X2JhcnJpZXJfdGFzayB7CiAJc3RydWN0IGk5MTVfYWN0aXZlIGJh
c2U7CiAJdm9pZCAoKnRhc2spKHZvaWQgKmRhdGEpOwpAQCAtMjM3OSw2ICsyNDUyLDIxIEBAIGlu
dCBpOTE1X2dlbV9jb250ZXh0X2dldHBhcmFtX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYs
IHZvaWQgKmRhdGEsCiAJcmV0dXJuIHJldDsKIH0KIAoraW50IGk5MTVfZ2VtX2dldHBhcmFtX2lv
Y3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCisJCQkgICAgc3RydWN0IGRy
bV9maWxlICpmaWxlKQoreworCXN0cnVjdCBkcm1faTkxNV9nZW1fY29udGV4dF9wYXJhbSAqYXJn
cyA9IGRhdGE7CisJdTMyIGNsYXNzID0gdXBwZXJfMzJfYml0cyhhcmdzLT5wYXJhbSk7CisKKwlz
d2l0Y2ggKGNsYXNzKSB7CisJY2FzZSAwOgorCQlyZXR1cm4gaTkxNV9nZW1fY29udGV4dF9nZXRw
YXJhbV9pb2N0bChkZXYsIGRhdGEsIGZpbGUpOworCWNhc2UgMjoKKwkJcmV0dXJuIGk5MTVfZ2Vt
X3ZtX2dldHBhcmFtX2lvY3RsKGRldiwgZGF0YSwgZmlsZSk7CisJfQorCXJldHVybiAtRUlOVkFM
OworfQorCiBpbnQgaTkxNV9nZW1fY29udGV4dF9zZXRwYXJhbV9pb2N0bChzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LCB2b2lkICpkYXRhLAogCQkJCSAgICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCiB7
CkBAIC0yNDAxLDE0ICsyNDg5LDE1IEBAIGludCBpOTE1X2dlbV9zZXRwYXJhbV9pb2N0bChzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCQkJICAgIHN0cnVjdCBkcm1fZmlsZSAq
ZmlsZSkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2NvbnRleHRfcGFyYW0gKmFyZ3MgPSBkYXRh
OwotCXUzMiBvYmplY3RfY2xhc3MgPSB1cHBlcl8zMl9iaXRzKGFyZ3MtPnBhcmFtKTsKKwl1MzIg
Y2xhc3MgPSB1cHBlcl8zMl9iaXRzKGFyZ3MtPnBhcmFtKTsKIAotCXN3aXRjaCAob2JqZWN0X2Ns
YXNzKSB7CisJc3dpdGNoIChjbGFzcykgewogCWNhc2UgMDoKIAkJcmV0dXJuIGk5MTVfZ2VtX2Nv
bnRleHRfc2V0cGFyYW1faW9jdGwoZGV2LCBkYXRhLCBmaWxlKTsKIAljYXNlIDE6CiAJCXJldHVy
biBpOTE1X2dlbV9vYmplY3Rfc2V0cGFyYW1faW9jdGwoZGV2LCBkYXRhLCBmaWxlKTsKLQorCWNh
c2UgMjoKKwkJcmV0dXJuIGk5MTVfZ2VtX3ZtX3NldHBhcmFtX2lvY3RsKGRldiwgZGF0YSwgZmls
ZSk7CiAJfQogCXJldHVybiAtRUlOVkFMOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9jb250ZXh0LmgKaW5kZXggMGIxNzYzNmNmZWEyLi41OWVlZGI5ZThhZTUgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmgKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaApAQCAtMTc1LDYgKzE3
NSw4IEBAIGludCBpOTE1X2dlbV9jb250ZXh0X2dldHBhcmFtX2lvY3RsKHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAJCQkJICAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wcml2
KTsKIGludCBpOTE1X2dlbV9jb250ZXh0X3NldHBhcmFtX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYsIHZvaWQgKmRhdGEsCiAJCQkJICAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wcml2KTsK
K2ludCBpOTE1X2dlbV9nZXRwYXJhbV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lk
ICpkYXRhLAorCQkJICAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSk7CiBpbnQgaTkxNV9nZW1fc2V0
cGFyYW1faW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIAkJCSAgICBz
dHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpOwogaW50IGk5MTVfZ2VtX2NvbnRleHRfcmVzZXRfc3RhdHNf
aW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0X3R5cGVzLmggYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dF90eXBlcy5oCmluZGV4IGMwNjBiYzQy
OGY0OS4uZWVmZDJlZTY0YzNmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fY29udGV4dF90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9jb250ZXh0X3R5cGVzLmgKQEAgLTEyOSw2ICsxMjksNyBAQCBzdHJ1Y3QgaTkxNV9n
ZW1fY29udGV4dCB7CiAjZGVmaW5lIFVDT05URVhUX0JBTk5BQkxFCQkyCiAjZGVmaW5lIFVDT05U
RVhUX1JFQ09WRVJBQkxFCQkzCiAjZGVmaW5lIFVDT05URVhUX1BFUlNJU1RFTkNFCQk0CisjZGVm
aW5lIFVDT05URVhUX1NWTV9FTkFCTEVECQk1CiAKIAkvKioKIAkgKiBAZmxhZ3M6IHNtYWxsIHNl
dCBvZiBib29sZWFucwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX2V4ZWNidWZmZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVj
YnVmZmVyLmMKaW5kZXggOWQ0M2FlNmQ2NDNhLi5jYmNmYmY4NmVhNjEgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYwpAQCAtMjUsNiArMjUsNyBA
QAogI2luY2x1ZGUgImk5MTVfZ2VtX2NsZmx1c2guaCIKICNpbmNsdWRlICJpOTE1X2dlbV9jb250
ZXh0LmgiCiAjaW5jbHVkZSAiaTkxNV9nZW1faW9jdGxzLmgiCisjaW5jbHVkZSAiaTkxNV9zdm0u
aCIKICNpbmNsdWRlICJpOTE1X3RyYWNlLmgiCiAKIGVudW0gewpAQCAtNDQ0LDYgKzQ0NSwxMSBA
QCBlYl92YWxpZGF0ZV92bWEoc3RydWN0IGk5MTVfZXhlY2J1ZmZlciAqZWIsCiAJaWYgKHVubGlr
ZWx5KGVudHJ5LT5hbGlnbm1lbnQgJiYgIWlzX3Bvd2VyX29mXzIoZW50cnktPmFsaWdubWVudCkp
KQogCQlyZXR1cm4gLUVJTlZBTDsKIAorCS8qIE9ubHkgYWxsb3cgdXNlciBQSU5ORUQgYWRkcmVz
c2VzIGZvciBTVk0gZW5hYmxlZCBjb250ZXh0cyAqLworCWlmICh1bmxpa2VseShpOTE1X3ZtX2lz
X3N2bV9lbmFibGVkKGViLT5nZW1fY29udGV4dC0+dm0pICYmCisJCSAgICAgIShlbnRyeS0+Zmxh
Z3MgJiBFWEVDX09CSkVDVF9QSU5ORUQpKSkKKwkJcmV0dXJuIC1FSU5WQUw7CisKIAkvKgogCSAq
IE9mZnNldCBjYW4gYmUgdXNlZCBhcyBpbnB1dCAoRVhFQ19PQkpFQ1RfUElOTkVEKSwgcmVqZWN0
CiAJICogYW55IG5vbi1wYWdlLWFsaWduZWQgb3Igbm9uLWNhbm9uaWNhbCBhZGRyZXNzZXMuCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMKaW5kZXggZGQ4OGZhODdi
N2ZlLi45M2Q4YWVmMjJiOTIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9vYmplY3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
b2JqZWN0LmMKQEAgLTM0LDYgKzM0LDcgQEAKICNpbmNsdWRlICJpOTE1X2dlbV9vYmplY3RfYmx0
LmgiCiAjaW5jbHVkZSAiaTkxNV9nZW1fcmVnaW9uLmgiCiAjaW5jbHVkZSAiaTkxNV9nbG9iYWxz
LmgiCisjaW5jbHVkZSAiaTkxNV9zdm0uaCIKICNpbmNsdWRlICJpOTE1X3RyYWNlLmgiCiAKIHN0
YXRpYyBzdHJ1Y3QgaTkxNV9nbG9iYWxfb2JqZWN0IHsKQEAgLTQ4Myw2ICs0ODQsMTYgQEAgaW50
IF9faW5pdCBpOTE1X2dsb2JhbF9vYmplY3RzX2luaXQodm9pZCkKIGJvb2wKIGk5MTVfZ2VtX29i
amVjdF9zdm1fbWFwcGVkKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiB7CisJc3Ry
dWN0IGk5MTVfdm1hICp2bWE7CisKKwlzcGluX2xvY2soJm9iai0+dm1hLmxvY2spOworCWxpc3Rf
Zm9yX2VhY2hfZW50cnkodm1hLCAmb2JqLT52bWEubGlzdCwgb2JqX2xpbmspCisJCWlmIChpOTE1
X3ZtX2lzX3N2bV9lbmFibGVkKHZtYS0+dm0pKSB7CisJCQlzcGluX3VubG9jaygmb2JqLT52bWEu
bG9jayk7CisJCQlyZXR1cm4gdHJ1ZTsKKwkJfQorCisJc3Bpbl91bmxvY2soJm9iai0+dm1hLmxv
Y2spOwogCXJldHVybiBmYWxzZTsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9kcnYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKaW5kZXggNzQw
YjRiOWQzOWE4Li5mNzg5MTJmZmEwM2QgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZHJ2LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYwpAQCAtMjY5
OSw2ICsyNjk5LDggQEAgc3RhdGljIGludCBpOTE1X2JpbmRfaW9jdGwoc3RydWN0IGRybV9kZXZp
Y2UgKmRldiwgdm9pZCAqZGF0YSwKIAl2bSA9IGk5MTVfZ2VtX2FkZHJlc3Nfc3BhY2VfbG9va3Vw
KGZpbGUtPmRyaXZlcl9wcml2LCBhcmdzLT52bV9pZCk7CiAJaWYgKHVubGlrZWx5KCF2bSkpCiAJ
CXJldHVybiAtRU5PRU5UOworCWlmICh1bmxpa2VseSghaTkxNV92bV9pc19zdm1fZW5hYmxlZCh2
bSkpKQorCQlyZXR1cm4gLUVOT1RTVVBQOwogCiAJc3dpdGNoIChhcmdzLT50eXBlKSB7CiAJY2Fz
ZSBJOTE1X0JJTkRfU1ZNX0JVRkZFUjoKQEAgLTI3NjIsNyArMjc2NCw3IEBAIHN0YXRpYyBjb25z
dCBzdHJ1Y3QgZHJtX2lvY3RsX2Rlc2MgaTkxNV9pb2N0bHNbXSA9IHsKIAlEUk1fSU9DVExfREVG
X0RSVihJOTE1X1JFR19SRUFELCBpOTE1X3JlZ19yZWFkX2lvY3RsLCBEUk1fUkVOREVSX0FMTE9X
KSwKIAlEUk1fSU9DVExfREVGX0RSVihJOTE1X0dFVF9SRVNFVF9TVEFUUywgaTkxNV9nZW1fY29u
dGV4dF9yZXNldF9zdGF0c19pb2N0bCwgRFJNX1JFTkRFUl9BTExPVyksCiAJRFJNX0lPQ1RMX0RF
Rl9EUlYoSTkxNV9HRU1fVVNFUlBUUiwgaTkxNV9nZW1fdXNlcnB0cl9pb2N0bCwgRFJNX1JFTkRF
Ul9BTExPVyksCi0JRFJNX0lPQ1RMX0RFRl9EUlYoSTkxNV9HRU1fQ09OVEVYVF9HRVRQQVJBTSwg
aTkxNV9nZW1fY29udGV4dF9nZXRwYXJhbV9pb2N0bCwgRFJNX1JFTkRFUl9BTExPVyksCisJRFJN
X0lPQ1RMX0RFRl9EUlYoSTkxNV9HRU1fQ09OVEVYVF9HRVRQQVJBTSwgaTkxNV9nZW1fZ2V0cGFy
YW1faW9jdGwsIERSTV9SRU5ERVJfQUxMT1cpLAogCURSTV9JT0NUTF9ERUZfRFJWKEk5MTVfR0VN
X0NPTlRFWFRfU0VUUEFSQU0sIGk5MTVfZ2VtX3NldHBhcmFtX2lvY3RsLCBEUk1fUkVOREVSX0FM
TE9XKSwKIAlEUk1fSU9DVExfREVGX0RSVihJOTE1X1BFUkZfT1BFTiwgaTkxNV9wZXJmX29wZW5f
aW9jdGwsIERSTV9SRU5ERVJfQUxMT1cpLAogCURSTV9JT0NUTF9ERUZfRFJWKEk5MTVfUEVSRl9B
RERfQ09ORklHLCBpOTE1X3BlcmZfYWRkX2NvbmZpZ19pb2N0bCwgRFJNX1JFTkRFUl9BTExPVyks
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9kcnYuaAppbmRleCBmNzA1MWU2ZGY2NTYuLjJlYTlkNmFjOTc0MyAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAorKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCkBAIC0zOCw2ICszOCw3IEBACiAjaW5jbHVkZSA8bGlu
dXgvaTJjLWFsZ28tYml0Lmg+CiAjaW5jbHVkZSA8bGludXgvYmFja2xpZ2h0Lmg+CiAjaW5jbHVk
ZSA8bGludXgvaGFzaC5oPgorI2luY2x1ZGUgPGxpbnV4L2htbS5oPgogI2luY2x1ZGUgPGxpbnV4
L2ludGVsLWlvbW11Lmg+CiAjaW5jbHVkZSA8bGludXgva3JlZi5oPgogI2luY2x1ZGUgPGxpbnV4
L21tX3R5cGVzLmg+CkBAIC0xNzM1LDYgKzE3MzYsMTUgQEAgSVNfU1VCUExBVEZPUk0oY29uc3Qg
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAvKiBPbmx5IHZhbGlkIHdoZW4gSEFTX0RJ
U1BMQVkoKSBpcyB0cnVlICovCiAjZGVmaW5lIElOVEVMX0RJU1BMQVlfRU5BQkxFRChkZXZfcHJp
dikgKFdBUk5fT04oIUhBU19ESVNQTEFZKGRldl9wcml2KSksICFpOTE1X21vZHBhcmFtcy5kaXNh
YmxlX2Rpc3BsYXkpCiAKK3N0YXRpYyBpbmxpbmUgYm9vbCBpOTE1X2hhc19zdm0oc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQoreworI2lmZGVmIENPTkZJR19EUk1fSTkxNV9TVk0K
KwlyZXR1cm4gSU5URUxfR0VOKGRldl9wcml2KSA+PSA4OworI2Vsc2UKKwlyZXR1cm4gZmFsc2U7
CisjZW5kaWYKK30KKwogc3RhdGljIGlubGluZSBib29sIGludGVsX3Z0ZF9hY3RpdmUodm9pZCkK
IHsKICNpZmRlZiBDT05GSUdfSU5URUxfSU9NTVUKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZ2V0cGFyYW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2V0cGFy
YW0uYwppbmRleCBjZjhhOGMzZWYwNDcuLjMwMjNiN2I0MGY2NiAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9nZXRwYXJhbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZ2V0cGFyYW0uYwpAQCAtMTYwLDYgKzE2MCw5IEBAIGludCBpOTE1X2dldHBhcmFtX2lv
Y3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAJY2FzZSBJOTE1X1BBUkFN
X1BFUkZfUkVWSVNJT046CiAJCXZhbHVlID0gaTkxNV9wZXJmX2lvY3RsX3ZlcnNpb24oKTsKIAkJ
YnJlYWs7CisJY2FzZSBJOTE1X1BBUkFNX0hBU19TVk06CisJCXZhbHVlID0gaTkxNV9oYXNfc3Zt
KGk5MTUpOworCQlicmVhazsKIAlkZWZhdWx0OgogCQlEUk1fREVCVUcoIlVua25vd24gcGFyYW1l
dGVyICVkXG4iLCBwYXJhbS0+cGFyYW0pOwogCQlyZXR1cm4gLUVJTlZBTDsKLS0gCjIuMjEuMC5y
YzAuMzIuZzI0M2E0YzdlMjcKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNr
dG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2Ry
aS1kZXZlbA==
