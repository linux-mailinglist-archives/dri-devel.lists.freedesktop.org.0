Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id CA80373318
	for <lists+dri-devel@lfdr.de>; Wed, 24 Jul 2019 17:52:42 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3304E6E5DE;
	Wed, 24 Jul 2019 15:52:40 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from honk.sigxcpu.org (honk.sigxcpu.org [24.134.29.49])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 77F486E5E1
 for <dri-devel@lists.freedesktop.org>; Wed, 24 Jul 2019 15:52:38 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by honk.sigxcpu.org (Postfix) with ESMTP id 24627FB07;
 Wed, 24 Jul 2019 17:52:37 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at honk.sigxcpu.org
Received: from honk.sigxcpu.org ([127.0.0.1])
 by localhost (honk.sigxcpu.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id KKtyjt1LKN-F; Wed, 24 Jul 2019 17:52:30 +0200 (CEST)
Received: by bogon.sigxcpu.org (Postfix, from userid 1000)
 id 173364341C; Wed, 24 Jul 2019 17:52:27 +0200 (CEST)
From: =?UTF-8?q?Guido=20G=C3=BCnther?= <agx@sigxcpu.org>
To: David Airlie <airlied@linux.ie>, Daniel Vetter <daniel@ffwll.ch>,
 Rob Herring <robh+dt@kernel.org>, Mark Rutland <mark.rutland@arm.com>,
 Shawn Guo <shawnguo@kernel.org>, Sascha Hauer <s.hauer@pengutronix.de>,
 Pengutronix Kernel Team <kernel@pengutronix.de>,
 Fabio Estevam <festevam@gmail.com>, NXP Linux Team <linux-imx@nxp.com>,
 Andrzej Hajda <a.hajda@samsung.com>,
 Neil Armstrong <narmstrong@baylibre.com>,
 Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
 Jonas Karlman <jonas@kwiboo.se>, Jernej Skrabec <jernej.skrabec@siol.net>,
 Lee Jones <lee.jones@linaro.org>,
 =?UTF-8?q?Guido=20G=C3=BCnther?= <agx@sigxcpu.org>,
 dri-devel@lists.freedesktop.org, devicetree@vger.kernel.org,
 linux-arm-kernel@lists.infradead.org, linux-kernel@vger.kernel.org,
 Robert Chiras <robert.chiras@nxp.com>
Subject: [PATCH 3/3] drm/bridge: Add NWL MIPI DSI host controller support
Date: Wed, 24 Jul 2019 17:52:26 +0200
Message-Id: <3158f4f8c97c21f98c394e5631d74bc60d796522.1563983037.git.agx@sigxcpu.org>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <cover.1563983037.git.agx@sigxcpu.org>
References: <cover.1563983037.git.agx@sigxcpu.org>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBhZGRzIGluaXRpYWwgc3VwcG9ydCBmb3IgdGhlIE5XTCBNSVBJIERTSSBIb3N0IGNvbnRy
b2xsZXIgZm91bmQgb24KaS5NWDggU29Dcy4KCkl0IGFkZHMgc3VwcG9ydCBmb3IgdGhlIGkuTVg4
TVEgYnV0IHRoZSBzYW1lIElQIGNhbiBiZSBmb3VuZCBvbgplLmcuIHRoZSBpLk1YOFFYUC4KCkl0
IGhhcyBiZWVuIHRlc3RlZCBvbiB0aGUgTGlicmVtIDUgZGV2a2l0IHVzaW5nIG14c2ZiLgoKU2ln
bmVkLW9mZi1ieTogR3VpZG8gR8O8bnRoZXIgPGFneEBzaWd4Y3B1Lm9yZz4KQ28tZGV2ZWxvcGVk
LWJ5OiBSb2JlcnQgQ2hpcmFzIDxyb2JlcnQuY2hpcmFzQG54cC5jb20+Ci0tLQogZHJpdmVycy9n
cHUvZHJtL2JyaWRnZS9LY29uZmlnICAgICAgICAgICB8ICAgMiArCiBkcml2ZXJzL2dwdS9kcm0v
YnJpZGdlL01ha2VmaWxlICAgICAgICAgIHwgICAxICsKIGRyaXZlcnMvZ3B1L2RybS9icmlkZ2Uv
aW14LW53bC9LY29uZmlnICAgfCAgMTUgKwogZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9pbXgtbnds
L01ha2VmaWxlICB8ICAgMiArCiBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2lteC1ud2wvbndsLWRy
di5jIHwgNTI5ICsrKysrKysrKysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9icmlkZ2UvaW14LW53
bC9ud2wtZHJ2LmggfCAgNzIgKysrCiBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2lteC1ud2wvbnds
LWRzaS5jIHwgNzQ1ICsrKysrKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vYnJp
ZGdlL2lteC1ud2wvbndsLWRzaS5oIHwgMTExICsrKysKIDggZmlsZXMgY2hhbmdlZCwgMTQ3NyBp
bnNlcnRpb25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9p
bXgtbndsL0tjb25maWcKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vYnJpZGdl
L2lteC1ud2wvTWFrZWZpbGUKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vYnJp
ZGdlL2lteC1ud2wvbndsLWRydi5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJt
L2JyaWRnZS9pbXgtbndsL253bC1kcnYuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1
L2RybS9icmlkZ2UvaW14LW53bC9ud2wtZHNpLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJz
L2dwdS9kcm0vYnJpZGdlL2lteC1ud2wvbndsLWRzaS5oCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2JyaWRnZS9LY29uZmlnIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9LY29uZmlnCmlu
ZGV4IGE2ZWVjOTA4YzQzZS4uMzhjMzE0NWE3ZTU3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vYnJpZGdlL0tjb25maWcKKysrIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9LY29uZmlnCkBA
IC0xNTIsNiArMTUyLDggQEAgc291cmNlICJkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4
L0tjb25maWciCiAKIHNvdXJjZSAiZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hZHY3NTExL0tjb25m
aWciCiAKK3NvdXJjZSAiZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9pbXgtbndsL0tjb25maWciCisK
IHNvdXJjZSAiZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9zeW5vcHN5cy9LY29uZmlnIgogCiBlbmRt
ZW51CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL01ha2VmaWxlIGIvZHJpdmVy
cy9ncHUvZHJtL2JyaWRnZS9NYWtlZmlsZQppbmRleCA0OTM0ZmNmNWE2ZjguLjkwNGE5ZWIzYTIw
YSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9NYWtlZmlsZQorKysgYi9kcml2
ZXJzL2dwdS9kcm0vYnJpZGdlL01ha2VmaWxlCkBAIC0xNiw0ICsxNiw1IEBAIG9iai0kKENPTkZJ
R19EUk1fQU5BTE9HSVhfRFApICs9IGFuYWxvZ2l4Lwogb2JqLSQoQ09ORklHX0RSTV9JMkNfQURW
NzUxMSkgKz0gYWR2NzUxMS8KIG9iai0kKENPTkZJR19EUk1fVElfU042NURTSTg2KSArPSB0aS1z
bjY1ZHNpODYubwogb2JqLSQoQ09ORklHX0RSTV9USV9URlA0MTApICs9IHRpLXRmcDQxMC5vCitv
YmoteSArPSBpbXgtbndsLwogb2JqLXkgKz0gc3lub3BzeXMvCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vYnJpZGdlL2lteC1ud2wvS2NvbmZpZyBiL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2Uv
aW14LW53bC9LY29uZmlnCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4u
ODIyZGJhMWIzODBhCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9p
bXgtbndsL0tjb25maWcKQEAgLTAsMCArMSwxNSBAQAorY29uZmlnIERSTV9JTVhfTldMX0RTSQor
CXRyaXN0YXRlICJTdXBwb3J0IGZvciBOb3J0aHdlc3QgTG9naWMgTUlQSSBEU0kgSG9zdCBjb250
cm9sbGVyIgorCWRlcGVuZHMgb24gRFJNICYmIChBUkNIX01YQyB8fCBBUkNIX01VTFRJUExBVEZP
Uk0gfHwgQ09NUElMRV9URVNUKQorCWRlcGVuZHMgb24gQ09NTU9OX0NMSworCWRlcGVuZHMgb24g
T0YgJiYgSEFTX0lPTUVNCisJc2VsZWN0IERSTV9LTVNfSEVMUEVSCisJc2VsZWN0IERSTV9NSVBJ
X0RTSQorCXNlbGVjdCBEUk1fUEFORUxfQlJJREdFCisJc2VsZWN0IEdFTkVSSUNfUEhZX01JUElf
RFBIWQorCXNlbGVjdCBNRkRfU1lTQ09OCisJc2VsZWN0IFJFR01BUF9NTUlPCisJaGVscAorCSAg
VGhpcyBlbmFibGVzIHRoZSBOb3J0aHdlc3QgTG9naWMgTUlQSSBEU0kgSG9zdCBjb250cm9sbGVy
IGFzCisJICBmb3VuZCBvbiBOWFAncyBpLk1YOCBQcm9jZXNzb3JzLgorCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vYnJpZGdlL2lteC1ud2wvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0v
YnJpZGdlL2lteC1ud2wvTWFrZWZpbGUKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MDAwMDAwLi45ZmE2MzQ4M2RhNWIKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
YnJpZGdlL2lteC1ud2wvTWFrZWZpbGUKQEAgLTAsMCArMSwyIEBACitpbXgtbndsLW9ianMgOj0g
bndsLWRydi5vIG53bC1kc2kubworb2JqLSQoQ09ORklHX0RSTV9JTVhfTldMX0RTSSkgKz0gaW14
LW53bC5vCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2lteC1ud2wvbndsLWRy
di5jIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9pbXgtbndsL253bC1kcnYuYwpuZXcgZmlsZSBt
b2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjQ1MWY4ZjA2N2M2ZgotLS0gL2Rldi9udWxs
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvaW14LW53bC9ud2wtZHJ2LmMKQEAgLTAsMCAr
MSw1MjkgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wKworLyoKKyAqIGku
TVg4IE5XTCBNSVBJIERTSSBob3N0IGRyaXZlcgorICoKKyAqIENvcHlyaWdodCAoQykgMjAxNyBO
WFAKKyAqIENvcHlyaWdodCAoQykgMjAxOSBQdXJpc20gU1BDCisgKi8KKworI2luY2x1ZGUgPGRy
bS9kcm1fYXRvbWljX2hlbHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fb2YuaD4KKyNpbmNsdWRl
IDxkcm0vZHJtX3BhbmVsLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wcmludC5oPgorI2luY2x1ZGUg
PGRybS9kcm1fcHJvYmVfaGVscGVyLmg+CisjaW5jbHVkZSA8bGludXgvY2xrLXByb3ZpZGVyLmg+
CisjaW5jbHVkZSA8bGludXgvY2xrLmg+CisjaW5jbHVkZSA8bGludXgvY29tcG9uZW50Lmg+Cisj
aW5jbHVkZSA8bGludXgvZ3Bpby9jb25zdW1lci5oPgorI2luY2x1ZGUgPGxpbnV4L2lycS5oPgor
I2luY2x1ZGUgPGxpbnV4L21mZC9zeXNjb24uaD4KKyNpbmNsdWRlIDxsaW51eC9tZmQvc3lzY29u
L2lteDhtcS1pb211eGMtZ3ByLmg+CisjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+CisjaW5jbHVk
ZSA8bGludXgvb2YuaD4KKyNpbmNsdWRlIDxsaW51eC9vZl9wbGF0Zm9ybS5oPgorI2luY2x1ZGUg
PGxpbnV4L3BoeS9waHkuaD4KKyNpbmNsdWRlIDxsaW51eC9yZWdtYXAuaD4KKyNpbmNsdWRlIDxs
aW51eC9zeXNfc29jLmg+CisjaW5jbHVkZSA8dmlkZW8vdmlkZW9tb2RlLmg+CisKKyNpbmNsdWRl
ICJud2wtZHJ2LmgiCisjaW5jbHVkZSAibndsLWRzaS5oIgorCisjZGVmaW5lIERSVl9OQU1FICJp
bXgtbndsLWRzaSIKKworLyogOE1RIFNSQyBzcGVjaWZpYyByZWdpc3RlcnMgKi8KKyNkZWZpbmUg
U1JDX01JUElQSFlfUkNSCTB4MjgKKyNkZWZpbmUgUkVTRVRfQllURV9OCUJJVCgxKQorI2RlZmlu
ZSBSRVNFVF9OCQlCSVQoMikKKyNkZWZpbmUgRFBJX1JFU0VUX04JQklUKDMpCisjZGVmaW5lIEVT
Q19SRVNFVF9OCUJJVCg0KQorI2RlZmluZSBQQ0xLX1JFU0VUX04JQklUKDUpCisKKy8qIFBvc3Np
YmxlIGNsb2NrcyAqLworI2RlZmluZSBDTEtfUElYRUwJInBpeGVsIgorI2RlZmluZSBDTEtfQ09S
RQkiY29yZSIKKyNkZWZpbmUgQ0xLX0JZUEFTUwkiYnlwYXNzIgorCitlbnVtIGlteF9leHRfcmVn
cyB7CisJSU1YX1JFR19DU1IgPSBCSVQoMSksCisJSU1YX1JFR19TUkMgPSBCSVQoMiksCisJSU1Y
X1JFR19HUFIgPSBCSVQoMyksCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IHJlZ21hcF9jb25m
aWcgbndsX2RzaV9yZWdtYXBfY29uZmlnID0geworCS5yZWdfYml0cyA9IDE2LAorCS52YWxfYml0
cyA9IDMyLAorCS5yZWdfc3RyaWRlID0gNCwKKwkubWF4X3JlZ2lzdGVyID0gSVJRX01BU0syLAor
CS5uYW1lID0gRFJWX05BTUUsCit9OworCitzdHJ1Y3QgaW14X253bF9wbGF0Zm9ybV9kYXRhIHsK
KwlpbnQgKCpwb3dlcm9uKShzdHJ1Y3QgaW14X253bF9kc2kgKmRzaSk7CisJaW50ICgqcG93ZXJv
ZmYpKHN0cnVjdCBpbXhfbndsX2RzaSAqZHNpKTsKKwl1MzIgZXh0X3JlZ3M7IC8qIHJlcXVpcmVk
IGV4dGVybmFsIHJlZ2lzdGVycyAqLworCXN0cnVjdCBpbXhfbndsX2Nsa19jb25maWcgY2xrX2Nv
bmZpZ1tOV0xfTUFYX1BMQVRGT1JNX0NMT0NLU107Cit9OworCitzdGF0aWMgaW5saW5lIHN0cnVj
dCBpbXhfbndsX2RzaSAqYnJpZGdlX3RvX2RzaShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQor
eworCXJldHVybiBjb250YWluZXJfb2YoYnJpZGdlLCBzdHJ1Y3QgaW14X253bF9kc2ksIGJyaWRn
ZSk7Cit9CisKK3N0YXRpYyB2b2lkIGlteF9ud2xfZHNpX3NldF9jbG9ja3Moc3RydWN0IGlteF9u
d2xfZHNpICpkc2ksIGJvb2wgZW5hYmxlKQoreworCXN0cnVjdCBkZXZpY2UgKmRldiA9IGRzaS0+
ZGV2OworCWNvbnN0IGNoYXIgKmlkOworCXN0cnVjdCBjbGsgKmNsazsKKwl1bnNpZ25lZCBsb25n
IG5ld19yYXRlLCBjdXJfcmF0ZTsKKwlib29sIGVuYWJsZWQ7CisJc2l6ZV90IGk7CisJaW50IHJl
dDsKKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIiVzYWJsaW5nIHBsYXRmb3JtIGNsb2Nr
cyIsCisJCQkgICAgIGVuYWJsZSA/ICJlbiIgOiAiZGlzIik7CisJZm9yIChpID0gMDsgaSA8IEFS
UkFZX1NJWkUoZHNpLT5wZGF0YS0+Y2xrX2NvbmZpZyk7IGkrKykgeworCQlpZiAoIWRzaS0+Y2xr
X2NvbmZpZ1tpXS5wcmVzZW50KQorCQkJY29udGludWU7CisJCWlkID0gZHNpLT5jbGtfY29uZmln
W2ldLmlkOworCQljbGsgPSBkc2ktPmNsa19jb25maWdbaV0uY2xrOworCQluZXdfcmF0ZSA9IGRz
aS0+Y2xrX2NvbmZpZ1tpXS5yYXRlOworCQljdXJfcmF0ZSA9IGNsa19nZXRfcmF0ZShjbGspOwor
CQllbmFibGVkID0gZHNpLT5jbGtfY29uZmlnW2ldLmVuYWJsZWQ7CisKKwkJLyogQllQQVNTIGNs
ayBtdXN0IGhhdmUgdGhlIHNhbWUgcmF0ZSBhcyBQSFlfUkVGIGNsayAqLworCQlpZiAoIXN0cmNt
cChpZCwgQ0xLX0JZUEFTUykpCisJCQluZXdfcmF0ZSA9IGNsa19nZXRfcmF0ZShkc2ktPnBoeV9y
ZWZfY2xrKTsKKworCQlpZiAoZW5hYmxlKSB7CisJCQlpZiAoZW5hYmxlZCAmJiBuZXdfcmF0ZSAh
PSBjdXJfcmF0ZSkKKwkJCQljbGtfZGlzYWJsZV91bnByZXBhcmUoY2xrKTsKKwkJCWVsc2UgaWYg
KGVuYWJsZWQgJiYgbmV3X3JhdGUgPT0gY3VyX3JhdGUpCisJCQkJY29udGludWU7CisJCQlpZiAo
bmV3X3JhdGUgPiAwKQorCQkJCWNsa19zZXRfcmF0ZShjbGssIG5ld19yYXRlKTsKKwkJCXJldCA9
IGNsa19wcmVwYXJlX2VuYWJsZShjbGspOworCQkJaWYgKHJldCA8IDApIHsKKwkJCQlEUk1fREVW
X0VSUk9SKGRldiwgIkZhaWxlZCB0byBlbmFibGUgY2xvY2sgJXMiLAorCQkJCQkgICAgICBpZCk7
CisJCQl9CisJCQlkc2ktPmNsa19jb25maWdbaV0uZW5hYmxlZCA9IHRydWU7CisJCQljdXJfcmF0
ZSA9IGNsa19nZXRfcmF0ZShjbGspOworCQkJRFJNX0RFVl9ERUJVR19EUklWRVIoCisJCQkJZGV2
LCAiRW5hYmxlZCAlcyBjbGsgKHJhdGU6IHJlcT0lbHUgYWN0PSVsdSlcbiIsCisJCQkJaWQsIG5l
d19yYXRlLCBjdXJfcmF0ZSk7CisJCX0gZWxzZSBpZiAoZW5hYmxlZCkgeworCQkJY2xrX2Rpc2Fi
bGVfdW5wcmVwYXJlKGNsayk7CisJCQlkc2ktPmNsa19jb25maWdbaV0uZW5hYmxlZCA9IGZhbHNl
OworCQkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiRGlzYWJsZWQgJXMgY2xrXG4iLCBpZCk7
CisJCX0KKwl9Cit9CisKK3N0YXRpYyB2b2lkIGlteF9ud2xfZHNpX2VuYWJsZShzdHJ1Y3QgaW14
X253bF9kc2kgKmRzaSkKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSBkc2ktPmRldjsKKwlpbnQg
cmV0OworCisJaW14X253bF9kc2lfc2V0X2Nsb2Nrcyhkc2ksIHRydWUpOworCisJcmV0ID0gZHNp
LT5wZGF0YS0+cG93ZXJvbihkc2kpOworCWlmIChyZXQgPCAwKQorCQlEUk1fREVWX0VSUk9SKGRl
diwgIkZhaWxlZCB0byBwb3dlciBvbiBEU0kgKCVkKVxuIiwgcmV0KTsKK30KKworc3RhdGljIHZv
aWQgaW14X253bF9kc2lfZGlzYWJsZShzdHJ1Y3QgaW14X253bF9kc2kgKmRzaSkKK3sKKwlzdHJ1
Y3QgZGV2aWNlICpkZXYgPSBkc2ktPmRldjsKKworCWlmIChkc2ktPmRwbXNfbW9kZSAhPSBEUk1f
TU9ERV9EUE1TX09OKQorCQlyZXR1cm47CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJE
aXNhYmxpbmcgZW5jb2RlciIpOworCWRzaS0+cGRhdGEtPnBvd2Vyb2ZmKGRzaSk7CisJaW14X253
bF9kc2lfc2V0X2Nsb2Nrcyhkc2ksIGZhbHNlKTsKK30KKworc3RhdGljIHZvaWQgaW14X253bF9z
ZWxlY3RfaW5wdXRfc291cmNlKHN0cnVjdCBpbXhfbndsX2RzaSAqZHNpKQoreworCXN0cnVjdCBk
ZXZpY2Vfbm9kZSAqcmVtb3RlOworCXUzMiBtdXhfdmFsID0gSU1YOE1RX0dQUjEzX01JUElfTVVY
X1NFTDsKKworCXJlbW90ZSA9IG9mX2dyYXBoX2dldF9yZW1vdGVfbm9kZShkc2ktPmRldi0+b2Zf
bm9kZSwgMCwgMCk7CisJaWYgKHN0cmNtcChyZW1vdGUtPm5hbWUsICJsY2RpZiIpID09IDApCisJ
CW11eF92YWwgPSAwOworCisJRFJNX0RFVl9JTkZPKGRzaS0+ZGV2LCAiVXNpbmcgJXMgYXMgaW5w
dXQgc291cmNlXG4iLAorCQkgICAgIChtdXhfdmFsKSA/ICJEQ1NTIiA6ICJMQ0RJRiIpOworCXJl
Z21hcF91cGRhdGVfYml0cyhkc2ktPm11eF9zZWwsIElPTVVYQ19HUFIxMywKKwkJCSAgIElNWDhN
UV9HUFIxM19NSVBJX01VWF9TRUwsIG11eF92YWwpOworCW9mX25vZGVfcHV0KHJlbW90ZSk7Cit9
CisKK3N0YXRpYyB2b2lkIGlteF9ud2xfZHNpX2JyaWRnZV9kaXNhYmxlKHN0cnVjdCBkcm1fYnJp
ZGdlICpicmlkZ2UpCit7CisJc3RydWN0IGlteF9ud2xfZHNpICpkc2kgPSBicmlkZ2VfdG9fZHNp
KGJyaWRnZSk7CisKKwlpZiAoZHNpLT5kcG1zX21vZGUgIT0gRFJNX01PREVfRFBNU19PTikKKwkJ
cmV0dXJuOworCisJbndsX2RzaV9kaXNhYmxlKGRzaSk7CisJaW14X253bF9kc2lfZGlzYWJsZShk
c2kpOworCXBtX3J1bnRpbWVfcHV0X3N5bmMoZHNpLT5kZXYpOworCWRzaS0+ZHBtc19tb2RlID0g
RFJNX01PREVfRFBNU19PRkY7Cit9CisKK3N0YXRpYyBib29sCitpbXhfbndsX2RzaV9icmlkZ2Vf
bW9kZV9maXh1cChzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAorCQkJICAgICAgY29uc3Qgc3Ry
dWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUsCisJCQkgICAgICBzdHJ1Y3QgZHJtX2Rpc3BsYXlf
bW9kZSAqYWRqdXN0ZWRfbW9kZSkKK3sKKwlzdHJ1Y3QgaW14X253bF9kc2kgKmRzaSA9IGJyaWRn
ZV90b19kc2koYnJpZGdlKTsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSBkc2ktPmRldjsKKwl1bmlv
biBwaHlfY29uZmlndXJlX29wdHMgbmV3X2NmZzsKKwl1bnNpZ25lZCBsb25nIHBoeV9yZWZfcmF0
ZTsKKwlpbnQgcmV0OworCisJcmV0ID0gbndsX2RzaV9nZXRfZHBoeV9wYXJhbXMoZHNpLCBhZGp1
c3RlZF9tb2RlLCAmbmV3X2NmZyk7CisJaWYgKHJldCA8IDApCisJCXJldHVybiByZXQ7CisKKwkv
KgorCSAqIElmIGhzIGNsb2NrIGlzIHVuY2hhbmdlZCwgd2UncmUgYWxsIGdvb2QgLSBhbGwgcGFy
YW1ldGVycyBhcmUKKwkgKiBkZXJpdmVkIGZyb20gaXQgYXRtLgorCSAqLworCWlmIChuZXdfY2Zn
Lm1pcGlfZHBoeS5oc19jbGtfcmF0ZSA9PSBkc2ktPnBoeV9jZmcubWlwaV9kcGh5LmhzX2Nsa19y
YXRlKQorCQlyZXR1cm4gdHJ1ZTsKKworCXBoeV9yZWZfcmF0ZSA9IGNsa19nZXRfcmF0ZShkc2kt
PnBoeV9yZWZfY2xrKTsKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJQSFkgYXQgcmVmIHJh
dGU6ICVsdVxuIiwgcGh5X3JlZl9yYXRlKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VS
Uk9SKGRzaS0+ZGV2LAorCQkJICAgICAgIkNhbm5vdCBzZXR1cCBQSFkgZm9yIG1vZGU6ICV1eCV1
IEAlZCBIelxuIiwKKwkJCSAgICAgIGFkanVzdGVkX21vZGUtPmhkaXNwbGF5LCBhZGp1c3RlZF9t
b2RlLT52ZGlzcGxheSwKKwkJCSAgICAgIGFkanVzdGVkX21vZGUtPmNsb2NrKTsKKwkJRFJNX0RF
Vl9FUlJPUihkc2ktPmRldiwgIlBIWSByZWYgY2xrOiAlbHUsIGJpdCBjbGs6ICVsdVxuIiwKKwkJ
CSAgICAgIHBoeV9yZWZfcmF0ZSwgbmV3X2NmZy5taXBpX2RwaHkuaHNfY2xrX3JhdGUpOworCX0g
ZWxzZSB7CisJCS8qIFNhdmUgdGhlIG5ldyBkZXNpcmVkIHBoeSBjb25maWcgKi8KKwkJbWVtY3B5
KCZkc2ktPnBoeV9jZmcsICZuZXdfY2ZnLCBzaXplb2YobmV3X2NmZykpOworCX0KKworCS8qIExD
RElGICsgTldMIG5lZWRzIGFjdGl2ZSBoaWdoIHN5bmMgKi8KKwlhZGp1c3RlZF9tb2RlLT5mbGFn
cyB8PSAoRFJNX01PREVfRkxBR19QSFNZTkMgfCBEUk1fTU9ERV9GTEFHX1BWU1lOQyk7CisJYWRq
dXN0ZWRfbW9kZS0+ZmxhZ3MgJj0gfihEUk1fTU9ERV9GTEFHX05IU1lOQyB8IERSTV9NT0RFX0ZM
QUdfTlZTWU5DKTsKKworCWRybV9kaXNwbGF5X21vZGVfdG9fdmlkZW9tb2RlKGFkanVzdGVkX21v
ZGUsICZkc2ktPnZtKTsKKwlkcm1fbW9kZV9kZWJ1Z19wcmludG1vZGVsaW5lKGFkanVzdGVkX21v
ZGUpOworCisJcmV0dXJuIHJldCA9PSAwOworfQorCitzdGF0aWMgZW51bSBkcm1fbW9kZV9zdGF0
dXMKK2lteF9ud2xfZHNpX2JyaWRnZV9tb2RlX3ZhbGlkKHN0cnVjdCBkcm1fYnJpZGdlICpicmlk
Z2UsCisJCQkgICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkKK3sKKwlz
dHJ1Y3QgaW14X253bF9kc2kgKmRzaSA9IGJyaWRnZV90b19kc2koYnJpZGdlKTsKKwlpbnQgYnBw
ID0gbWlwaV9kc2lfcGl4ZWxfZm9ybWF0X3RvX2JwcChkc2ktPmZvcm1hdCk7CisKKwlpZiAoYnBw
IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGRzaS0+ZGV2LCAiSW52YWxpZCBwaXhlbCBmb3JtYXQ6
ICVkXG4iLAorCQkJICAgICAgZHNpLT5mb3JtYXQpOworCQlyZXR1cm4gTU9ERV9CQUQ7CisJfQor
CisJcmV0dXJuIE1PREVfT0s7Cit9CisKK3N0YXRpYyB2b2lkIGlteF9ud2xfZHNpX2JyaWRnZV9w
cmVfZW5hYmxlKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UpCit7CisJc3RydWN0IGlteF9ud2xf
ZHNpICpkc2kgPSBicmlkZ2VfdG9fZHNpKGJyaWRnZSk7CisKKwlpZiAoZHNpLT5kcG1zX21vZGUg
PT0gRFJNX01PREVfRFBNU19PTikKKwkJcmV0dXJuOworCisJaW14X253bF9zZWxlY3RfaW5wdXRf
c291cmNlKGRzaSk7CisJcG1fcnVudGltZV9nZXRfc3luYyhkc2ktPmRldik7CisJaW14X253bF9k
c2lfZW5hYmxlKGRzaSk7CisJbndsX2RzaV9lbmFibGUoZHNpKTsKKwlkc2ktPmRwbXNfbW9kZSA9
IERSTV9NT0RFX0RQTVNfT047Cit9CisKK3N0YXRpYyBpbnQgaW14X253bF9kc2lfYnJpZGdlX2F0
dGFjaChzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQoreworCXN0cnVjdCBpbXhfbndsX2RzaSAq
ZHNpID0gYnJpZGdlLT5kcml2ZXJfcHJpdmF0ZTsKKwlzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29k
ZXIgPSBicmlkZ2UtPmVuY29kZXI7CisKKwlpZiAoIWVuY29kZXIpIHsKKwkJRFJNX0RFVl9FUlJP
Uihkc2ktPmRldiwgIlBhcmVudCBlbmNvZGVyIG9iamVjdCBub3QgZm91bmRcbiIpOworCQlyZXR1
cm4gLUVOT0RFVjsKKwl9CisKKwkvKiBTZXQgdGhlIGVuY29kZXIgdHlwZSBhcyBjYWxsZXIgZG9l
cyBub3Qga25vdyBpdCAqLworCWJyaWRnZS0+ZW5jb2Rlci0+ZW5jb2Rlcl90eXBlID0gRFJNX01P
REVfRU5DT0RFUl9EU0k7CisKKwkvKiBBdHRhY2ggdGhlIHBhbmVsLWJyaWRnZSB0byB0aGUgZHNp
IGJyaWRnZSAqLworCXJldHVybiBkcm1fYnJpZGdlX2F0dGFjaChicmlkZ2UtPmVuY29kZXIsIGRz
aS0+cGFuZWxfYnJpZGdlLCBicmlkZ2UpOworfQorCitzdGF0aWMgdm9pZCBpbXhfbndsX2RzaV9i
cmlkZ2VfZGV0YWNoKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UpCit7CisJc3RydWN0IGlteF9u
d2xfZHNpICpkc2kgPSBicmlkZ2UtPmRyaXZlcl9wcml2YXRlOworCisJZHJtX29mX3BhbmVsX2Jy
aWRnZV9yZW1vdmUoZHNpLT5kZXYtPm9mX25vZGUsIDEsIDApOworfQorCisvKiBzZWUgZHctbWlw
aS1kc2kuYyAqLworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fYnJpZGdlX2Z1bmNzIGlteF9ud2xf
ZHNpX2JyaWRnZV9mdW5jcyA9IHsKKwkucHJlX2VuYWJsZQk9IGlteF9ud2xfZHNpX2JyaWRnZV9w
cmVfZW5hYmxlLAorCS5kaXNhYmxlICAgID0gaW14X253bF9kc2lfYnJpZGdlX2Rpc2FibGUsCisJ
Lm1vZGVfZml4dXAgPSBpbXhfbndsX2RzaV9icmlkZ2VfbW9kZV9maXh1cCwKKwkubW9kZV92YWxp
ZCA9IGlteF9ud2xfZHNpX2JyaWRnZV9tb2RlX3ZhbGlkLAorCS5hdHRhY2gJICAgID0gaW14X253
bF9kc2lfYnJpZGdlX2F0dGFjaCwKKwkuZGV0YWNoCSAgICA9IGlteF9ud2xfZHNpX2JyaWRnZV9k
ZXRhY2gsCit9OworCitzdGF0aWMgaW50IGlteF9ud2xfZHNpX3BhcnNlX2R0KHN0cnVjdCBpbXhf
bndsX2RzaSAqZHNpKQoreworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqbnAgPSBkc2ktPmRldi0+b2Zf
bm9kZTsKKwlzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2ID0gdG9fcGxhdGZvcm1fZGV2aWNl
KGRzaS0+ZGV2KTsKKwlzdHJ1Y3QgcmVzb3VyY2UgKnJlczsKKwlzdHJ1Y3QgY2xrICpjbGs7CisJ
Y29uc3QgY2hhciAqY2xrX2lkOworCXZvaWQgX19pb21lbSAqYmFzZTsKKwlpbnQgaSwgcmV0Owor
CisJZHNpLT5waHkgPSBkZXZtX3BoeV9nZXQoZHNpLT5kZXYsICJkcGh5Iik7CisJaWYgKElTX0VS
Uihkc2ktPnBoeSkpIHsKKwkJcmV0ID0gUFRSX0VSUihkc2ktPnBoeSk7CisJCWRldl9lcnIoZHNp
LT5kZXYsICJDb3VsZCBub3QgZ2V0IFBIWSAoJWQpXG4iLCByZXQpOworCQlyZXR1cm4gcmV0Owor
CX0KKworCS8qIFBsYXRmb3JtIGRlcGVuZGVudCBjbG9ja3MgKi8KKwltZW1jcHkoZHNpLT5jbGtf
Y29uZmlnLCBkc2ktPnBkYXRhLT5jbGtfY29uZmlnLAorCSAgICAgICBzaXplb2YoZHNpLT5wZGF0
YS0+Y2xrX2NvbmZpZykpOworCisJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoZHNpLT5wZGF0
YS0+Y2xrX2NvbmZpZyk7IGkrKykgeworCQlpZiAoIWRzaS0+Y2xrX2NvbmZpZ1tpXS5wcmVzZW50
KQorCQkJY29udGludWU7CisKKwkJY2xrX2lkID0gZHNpLT5jbGtfY29uZmlnW2ldLmlkOworCQlj
bGsgPSBkZXZtX2Nsa19nZXQoZHNpLT5kZXYsIGNsa19pZCk7CisJCWlmIChJU19FUlIoY2xrKSkg
eworCQkJcmV0ID0gUFRSX0VSUihjbGspOworCQkJZGV2X2Vycihkc2ktPmRldiwgIkZhaWxlZCB0
byBnZXQgJXMgY2xvY2sgKCVkKVxuIiwKKwkJCQljbGtfaWQsIHJldCk7CisJCQlyZXR1cm4gcmV0
OworCQl9CisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRzaS0+ZGV2LCAiU2V0dXAgY2xrICVzIChy
YXRlOiAlbHUpXG4iLAorCQkJCSAgICAgY2xrX2lkLCBjbGtfZ2V0X3JhdGUoY2xrKSk7CisJCWRz
aS0+Y2xrX2NvbmZpZ1tpXS5jbGsgPSBjbGs7CisJfQorCisJLyogRFNJIGNsb2NrcyAqLworCWNs
ayA9IGRldm1fY2xrX2dldChkc2ktPmRldiwgInBoeV9yZWYiKTsKKwlpZiAoSVNfRVJSKGNsaykp
IHsKKwkJcmV0ID0gUFRSX0VSUihjbGspOworCQlkZXZfZXJyKGRzaS0+ZGV2LCAiRmFpbGVkIHRv
IGdldCBwaHlfcmVmIGNsb2NrOiAlZFxuIiwgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisJZHNp
LT5waHlfcmVmX2NsayA9IGNsazsKKworCWNsayA9IGRldm1fY2xrX2dldChkc2ktPmRldiwgInJ4
X2VzYyIpOworCWlmIChJU19FUlIoY2xrKSkgeworCQlyZXQgPSBQVFJfRVJSKGNsayk7CisJCWRl
dl9lcnIoZHNpLT5kZXYsICJGYWlsZWQgdG8gZ2V0IHJ4X2VzYyBjbG9jazogJWRcbiIsIHJldCk7
CisJCXJldHVybiByZXQ7CisJfQorCWRzaS0+cnhfZXNjX2NsayA9IGNsazsKKworCWNsayA9IGRl
dm1fY2xrX2dldChkc2ktPmRldiwgInR4X2VzYyIpOworCWlmIChJU19FUlIoY2xrKSkgeworCQly
ZXQgPSBQVFJfRVJSKGNsayk7CisJCWRldl9lcnIoZHNpLT5kZXYsICJGYWlsZWQgdG8gZ2V0IHR4
X2VzYyBjbG9jazogJWRcbiIsIHJldCk7CisJCXJldHVybiByZXQ7CisJfQorCWRzaS0+dHhfZXNj
X2NsayA9IGNsazsKKworCWRzaS0+Y3NyID0gc3lzY29uX3JlZ21hcF9sb29rdXBfYnlfcGhhbmRs
ZShucCwgImNzciIpOworCWlmIChJU19FUlIoZHNpLT5jc3IpICYmIGRzaS0+cGRhdGEtPmV4dF9y
ZWdzICYgSU1YX1JFR19DU1IpIHsKKwkJcmV0ID0gUFRSX0VSUihkc2ktPmNzcik7CisJCURSTV9E
RVZfRVJST1IoZHNpLT5kZXYsICJGYWlsZWQgdG8gZ2V0IENTUiByZWdtYXA6ICVkXG4iLAorCQkJ
ICAgICAgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisJZHNpLT5yZXNldCA9IHN5c2Nvbl9yZWdt
YXBfbG9va3VwX2J5X3BoYW5kbGUobnAsICJzcmMiKTsKKwlpZiAoSVNfRVJSKGRzaS0+cmVzZXQp
ICYmIChkc2ktPnBkYXRhLT5leHRfcmVncyAmIElNWF9SRUdfU1JDKSkgeworCQlyZXQgPSBQVFJf
RVJSKGRzaS0+cmVzZXQpOworCQlEUk1fREVWX0VSUk9SKGRzaS0+ZGV2LCAiRmFpbGVkIHRvIGdl
dCBTUkMgcmVnbWFwOiAlZFxuIiwKKwkJCSAgICAgIHJldCk7CisJCXJldHVybiByZXQ7CisJfQor
CWRzaS0+bXV4X3NlbCA9IHN5c2Nvbl9yZWdtYXBfbG9va3VwX2J5X3BoYW5kbGUobnAsICJtdXgt
c2VsIik7CisJaWYgKElTX0VSUihkc2ktPm11eF9zZWwpICYmIChkc2ktPnBkYXRhLT5leHRfcmVn
cyAmIElNWF9SRUdfR1BSKSkgeworCQlyZXQgPSBQVFJfRVJSKGRzaS0+bXV4X3NlbCk7CisJCURS
TV9ERVZfRVJST1IoZHNpLT5kZXYsICJGYWlsZWQgdG8gZ2V0IEdQUiByZWdtYXA6ICVkXG4iLAor
CQkJICAgICAgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXMgPSBwbGF0Zm9ybV9nZXRf
cmVzb3VyY2UocGRldiwgSU9SRVNPVVJDRV9NRU0sIDApOworCWJhc2UgPSBkZXZtX2lvcmVtYXBf
cmVzb3VyY2UoZHNpLT5kZXYsIHJlcyk7CisJaWYgKElTX0VSUihiYXNlKSkKKwkJcmV0dXJuIFBU
Ul9FUlIoYmFzZSk7CisKKwlkc2ktPnJlZ21hcCA9CisJCWRldm1fcmVnbWFwX2luaXRfbW1pbyhk
c2ktPmRldiwgYmFzZSwgJm53bF9kc2lfcmVnbWFwX2NvbmZpZyk7CisJaWYgKElTX0VSUihkc2kt
PnJlZ21hcCkpIHsKKwkJcmV0ID0gUFRSX0VSUihkc2ktPnJlZ21hcCk7CisJCURSTV9ERVZfRVJS
T1IoZHNpLT5kZXYsCisJCQkgICAgICAiRmFpbGVkIHRvIGNyZWF0ZSBOV0wgRFNJIHJlZ21hcDog
JWRcbiIsIHJldCk7CisJCXJldHVybiByZXQ7CisJfQorCisJZHNpLT5pcnEgPSBwbGF0Zm9ybV9n
ZXRfaXJxKHBkZXYsIDApOworCWlmIChkc2ktPmlycSA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihk
c2ktPmRldiwgIkZhaWxlZCB0byBnZXQgZGV2aWNlIElSUTogJWRcbiIsCisJCQkgICAgICBkc2kt
PmlycSk7CisJCXJldHVybiBkc2ktPmlycTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGlj
IGludCBpbXg4bXFfZHNpX3Bvd2Vyb24oc3RydWN0IGlteF9ud2xfZHNpICpkc2kpCit7CisJLyog
b3RoZXJ3aXNlIHRoZSBkaXNwbGF5IHN0YXlzIGJsYW5rICovCisJdXNsZWVwX3JhbmdlKDIwMCwg
MzAwKTsKKworCXJlZ21hcF91cGRhdGVfYml0cyhkc2ktPnJlc2V0LCBTUkNfTUlQSVBIWV9SQ1Is
IFBDTEtfUkVTRVRfTiwKKwkJCSAgIFBDTEtfUkVTRVRfTik7CisJcmVnbWFwX3VwZGF0ZV9iaXRz
KGRzaS0+cmVzZXQsIFNSQ19NSVBJUEhZX1JDUiwgRVNDX1JFU0VUX04sCisJCQkgICBFU0NfUkVT
RVRfTik7CisJcmVnbWFwX3VwZGF0ZV9iaXRzKGRzaS0+cmVzZXQsIFNSQ19NSVBJUEhZX1JDUiwg
UkVTRVRfQllURV9OLAorCQkJICAgUkVTRVRfQllURV9OKTsKKwlyZWdtYXBfdXBkYXRlX2JpdHMo
ZHNpLT5yZXNldCwgU1JDX01JUElQSFlfUkNSLCBEUElfUkVTRVRfTiwKKwkJCSAgIERQSV9SRVNF
VF9OKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGlteDhtcV9kc2lfcG93ZXJvZmYo
c3RydWN0IGlteF9ud2xfZHNpICpkc2kpCit7CisJaWYgKFVTRV9TUkNfUkVTRVRfUVVJUksoZHNp
LT5xdWlya3MpKQorCQlyZXR1cm4gMDsKKworCXJlZ21hcF91cGRhdGVfYml0cyhkc2ktPnJlc2V0
LCBTUkNfTUlQSVBIWV9SQ1IsIFBDTEtfUkVTRVRfTiwgMCk7CisJcmVnbWFwX3VwZGF0ZV9iaXRz
KGRzaS0+cmVzZXQsIFNSQ19NSVBJUEhZX1JDUiwgRVNDX1JFU0VUX04sIDApOworCXJlZ21hcF91
cGRhdGVfYml0cyhkc2ktPnJlc2V0LCBTUkNfTUlQSVBIWV9SQ1IsIFJFU0VUX0JZVEVfTiwgMCk7
CisJcmVnbWFwX3VwZGF0ZV9iaXRzKGRzaS0+cmVzZXQsIFNSQ19NSVBJUEhZX1JDUiwgRFBJX1JF
U0VUX04sIDApOworCXJldHVybiAwOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9icmlk
Z2VfdGltaW5ncyBpbXhfbndsX3RpbWluZ3MgPSB7CisJLmlucHV0X2J1c19mbGFncyA9IERSTV9C
VVNfRkxBR19ERV9MT1csCit9OworCitzdGF0aWMgc3RydWN0IGlteF9ud2xfcGxhdGZvcm1fZGF0
YSBpbXg4bXFfZGV2ID0geworCS5wb3dlcm9uID0gJmlteDhtcV9kc2lfcG93ZXJvbiwKKwkucG93
ZXJvZmYgPSAmaW14OG1xX2RzaV9wb3dlcm9mZiwKKwkuY2xrX2NvbmZpZyA9IHsKKwkJeyAuaWQg
PSBDTEtfQ09SRSwgICAucHJlc2VudCA9IHRydWUgfSwKKwkJeyAuaWQgPSBDTEtfUElYRUwsICAu
cHJlc2VudCA9IGZhbHNlIH0sCisJCXsgLmlkID0gQ0xLX0JZUEFTUywgLnByZXNlbnQgPSBmYWxz
ZSB9LAorCX0sCisJLmV4dF9yZWdzID0gSU1YX1JFR19TUkMgfCBJTVhfUkVHX0dQUiwKK307CisK
K3N0YXRpYyBjb25zdCBzdHJ1Y3Qgb2ZfZGV2aWNlX2lkIGlteF9ud2xfZHNpX2R0X2lkc1tdID0g
eworCXsgLmNvbXBhdGlibGUgPSAiZnNsLGlteDhtcS1ud2wtZHNpIiwgLmRhdGEgPSAmaW14OG1x
X2RldiwgfSwKKwl7IC8qIHNlbnRpbmVsICovIH0KK307CitNT0RVTEVfREVWSUNFX1RBQkxFKG9m
LCBpbXhfbndsX2RzaV9kdF9pZHMpOworCitzdGF0aWMgY29uc3Qgc3RydWN0IHNvY19kZXZpY2Vf
YXR0cmlidXRlIGlteF9ud2xfcXVpcmtzX21hdGNoW10gPSB7CisJeyAuc29jX2lkID0gImkuTVg4
TVEiLCAucmV2aXNpb24gPSAiMi4wIiwKKwkgIC5kYXRhID0gKHZvaWQgKikoRTExNDE4X0hTX01P
REVfUVVJUksgfCBTUkNfUkVTRVRfUVVJUkspIH0sCisJeyAvKiBzZW50aW5lbC4gKi8gfSwKK307
CisKK3N0YXRpYyBpbnQgaW14X253bF9kc2lfcHJvYmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAq
cGRldikKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmcGRldi0+ZGV2OworCWNvbnN0IHN0cnVj
dCBvZl9kZXZpY2VfaWQgKm9mX2lkID0KKwkJb2ZfbWF0Y2hfZGV2aWNlKGlteF9ud2xfZHNpX2R0
X2lkcywgZGV2KTsKKwljb25zdCBzdHJ1Y3QgaW14X253bF9wbGF0Zm9ybV9kYXRhICpwZGF0YSA9
IG9mX2lkLT5kYXRhOworCWNvbnN0IHN0cnVjdCBzb2NfZGV2aWNlX2F0dHJpYnV0ZSAqYXR0cjsK
KwlzdHJ1Y3QgaW14X253bF9kc2kgKmRzaTsKKwlpbnQgcmV0OworCisJZHNpID0gZGV2bV9remFs
bG9jKGRldiwgc2l6ZW9mKCpkc2kpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWRzaSkKKwkJcmV0dXJu
IC1FTk9NRU07CisKKwlkc2ktPmRldiA9IGRldjsKKwlkc2ktPnBkYXRhID0gcGRhdGE7CisJZHNp
LT5kcG1zX21vZGUgPSBEUk1fTU9ERV9EUE1TX09GRjsKKworCXJldCA9IGlteF9ud2xfZHNpX3Bh
cnNlX2R0KGRzaSk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCXJldCA9IGRldm1fcmVx
dWVzdF9pcnEoZGV2LCBkc2ktPmlycSwgbndsX2RzaV9pcnFfaGFuZGxlciwgMCwKKwkJCSAgICAg
ICBkZXZfbmFtZShkZXYpLCBkc2kpOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9ERVZfRVJST1Io
ZGV2LCAiRmFpbGVkIHRvIHJlcXVlc3QgSVJROiAlZCAoJWQpXG4iLCBkc2ktPmlycSwKKwkJCSAg
ICAgIHJldCk7CisJCXJldHVybiByZXQ7CisJfQorCisJZHNpLT5kc2lfaG9zdC5vcHMgPSAmbnds
X2RzaV9ob3N0X29wczsKKwlkc2ktPmRzaV9ob3N0LmRldiA9IGRldjsKKwlyZXQgPSBtaXBpX2Rz
aV9ob3N0X3JlZ2lzdGVyKCZkc2ktPmRzaV9ob3N0KTsKKwlpZiAocmV0KSB7CisJCURSTV9ERVZf
RVJST1IoZGV2LCAiRmFpbGVkIHRvIHJlZ2lzdGVyIE1JUEkgaG9zdDogJWRcbiIsIHJldCk7CisJ
CWdvdG8gZXJyX2NsZWFudXA7CisJfQorCisJYXR0ciA9IHNvY19kZXZpY2VfbWF0Y2goaW14X253
bF9xdWlya3NfbWF0Y2gpOworCWlmIChhdHRyKQorCQlkc2ktPnF1aXJrcyA9ICh1aW50cHRyX3Qp
YXR0ci0+ZGF0YTsKKworCWRzaS0+YnJpZGdlLmRyaXZlcl9wcml2YXRlID0gZHNpOworCWRzaS0+
YnJpZGdlLmZ1bmNzID0gJmlteF9ud2xfZHNpX2JyaWRnZV9mdW5jczsKKwlkc2ktPmJyaWRnZS5v
Zl9ub2RlID0gZGV2LT5vZl9ub2RlOworCWRzaS0+YnJpZGdlLnRpbWluZ3MgPSAmaW14X253bF90
aW1pbmdzOworCisJZHJtX2JyaWRnZV9hZGQoJmRzaS0+YnJpZGdlKTsKKworCWRldl9zZXRfZHJ2
ZGF0YShkZXYsIGRzaSk7CisJcG1fcnVudGltZV9lbmFibGUoZGV2KTsKKwlyZXR1cm4gMDsKKwor
ZXJyX2NsZWFudXA6CisJZGV2bV9mcmVlX2lycShkZXYsIGRzaS0+aXJxLCBkc2kpOworCXJldHVy
biByZXQ7Cit9CisKK3N0YXRpYyBpbnQgaW14X253bF9kc2lfcmVtb3ZlKHN0cnVjdCBwbGF0Zm9y
bV9kZXZpY2UgKnBkZXYpCit7CisJcG1fcnVudGltZV9kaXNhYmxlKCZwZGV2LT5kZXYpOworCXJl
dHVybiAwOworfQorCitzdGF0aWMgc3RydWN0IHBsYXRmb3JtX2RyaXZlciBpbXhfbndsX2RzaV9k
cml2ZXIgPSB7CisJLnByb2JlCQk9IGlteF9ud2xfZHNpX3Byb2JlLAorCS5yZW1vdmUJCT0gaW14
X253bF9kc2lfcmVtb3ZlLAorCS5kcml2ZXIJCT0geworCQkub2ZfbWF0Y2hfdGFibGUgPSBpbXhf
bndsX2RzaV9kdF9pZHMsCisJCS5uYW1lCT0gRFJWX05BTUUsCisJfSwKK307CisKK21vZHVsZV9w
bGF0Zm9ybV9kcml2ZXIoaW14X253bF9kc2lfZHJpdmVyKTsKKworTU9EVUxFX0FVVEhPUigiTlhQ
IFNlbWljb25kdWN0b3IiKTsKK01PRFVMRV9BVVRIT1IoIlB1cmlzbSBTUEMiKTsKK01PRFVMRV9E
RVNDUklQVElPTigiaS5NWDggTm9ydGh3ZXN0IExvZ2ljIE1JUEktRFNJIGRyaXZlciIpOworTU9E
VUxFX0xJQ0VOU0UoIkdQTCIpOyAvKiBHUEx2MiBvciBsYXRlciAqLwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2JyaWRnZS9pbXgtbndsL253bC1kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9i
cmlkZ2UvaW14LW53bC9ud2wtZHJ2LmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MDAwMDAwLi5hMWUzMGM1OGI2MjcKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
YnJpZGdlL2lteC1ud2wvbndsLWRydi5oCkBAIC0wLDAgKzEsNzIgQEAKKy8qIFNQRFgtTGljZW5z
ZS1JZGVudGlmaWVyOiBHUEwtMi4wKyAqLworLyoKKyAqIGkuTVg4IE5XTCBNSVBJIERTSSBob3N0
IGRyaXZlcgorICoKKyAqIENvcHlyaWdodCAoQykgMjAxNyBOWFAKKyAqIENvcHlyaWdodCAoQykg
MjAxOSBQdXJpc20gU1BDCisgKi8KKworI2lmbmRlZiBfX05XTF9EUlZfSF9fCisjZGVmaW5lIF9f
TldMX0RSVl9IX18KKworI2luY2x1ZGUgPGRybS9kcm1fbWlwaV9kc2kuaD4KKyNpbmNsdWRlIDxs
aW51eC9waHkvcGh5Lmg+CisKK3N0cnVjdCBpbXhfbndsX3BsYXRmb3JtX2RhdGE7CisKKy8qIGku
TVg4IE5XTCBxdWlya3MgKi8KKy8qIGkuTVg4TVEgZXJyYXRhIEUxMTQxOCAqLworI2RlZmluZSBF
MTE0MThfSFNfTU9ERV9RVUlSSwkgICAgQklUKDApCisjZGVmaW5lIFVTRV9FMTE0MThfSFNfTU9E
RV9RVUlSSyh4KSAoKHgpICYgRTExNDE4X0hTX01PREVfUVVJUkspCisKKy8qIFNraXAgRFNJIGJp
dHMgaW4gU1JDIG9uIGRpc2FibGUgdG8gYXZvaWQgYmxhbmsgZGlzcGxheSBvbiBlbmFibGUgKi8K
KyNkZWZpbmUgU1JDX1JFU0VUX1FVSVJLCQkgICAgQklUKDEpCisjZGVmaW5lIFVTRV9TUkNfUkVT
RVRfUVVJUksoeCkJICAgICgoeCkgJiBTUkNfUkVTRVRfUVVJUkspCisKKyNkZWZpbmUgTldMX01B
WF9QTEFURk9STV9DTE9DS1MgMworc3RydWN0IGlteF9ud2xfY2xrX2NvbmZpZyB7CisJY29uc3Qg
Y2hhciAqaWQ7CisJc3RydWN0IGNsayAqY2xrOworCWJvb2wgcHJlc2VudDsKKwlib29sIGVuYWJs
ZWQ7CisJdTMyIHJhdGU7Cit9OworCitzdHJ1Y3QgaW14X253bF9kc2kgeworCXN0cnVjdCBkcm1f
YnJpZGdlIGJyaWRnZTsKKwlzdHJ1Y3QgbWlwaV9kc2lfaG9zdCBkc2lfaG9zdDsKKwlzdHJ1Y3Qg
ZHJtX2JyaWRnZSAqcGFuZWxfYnJpZGdlOworCXN0cnVjdCBkZXZpY2UgKmRldjsKKwlzdHJ1Y3Qg
cGh5ICpwaHk7CisJdW5pb24gcGh5X2NvbmZpZ3VyZV9vcHRzIHBoeV9jZmc7CisJdW5zaWduZWQg
aW50IHF1aXJrczsKKworCXN0cnVjdCByZWdtYXAgKnJlZ21hcDsKKwlpbnQgaXJxOworCisJLyog
RXh0ZXJuYWwgcmVnaXN0ZXJzICovCisJc3RydWN0IHJlZ21hcCAqY3NyOworCXN0cnVjdCByZWdt
YXAgKm11eF9zZWw7CisJc3RydWN0IHJlZ21hcCAqcmVzZXQ7CisKKwkvKiBQbGF0Zm9ybSBkZXBl
bmRlbnQgY2xvY2tzICovCisJc3RydWN0IGlteF9ud2xfY2xrX2NvbmZpZyBjbGtfY29uZmlnWzNd
OworCS8qIERTSSBjbG9ja3MgKi8KKwlzdHJ1Y3QgY2xrICpwaHlfcmVmX2NsazsKKwlzdHJ1Y3Qg
Y2xrICpyeF9lc2NfY2xrOworCXN0cnVjdCBjbGsgKnR4X2VzY19jbGs7CisKKwkvKiBkc2kgbGFu
ZXMgKi8KKwl1MzIgbGFuZXM7CisJZW51bSBtaXBpX2RzaV9waXhlbF9mb3JtYXQgZm9ybWF0Owor
CXN0cnVjdCB2aWRlb21vZGUgdm07CisJdW5zaWduZWQgbG9uZyBkc2lfbW9kZV9mbGFnczsKKwor
CWludCBkcG1zX21vZGU7CisKKwlzdHJ1Y3QgbWlwaV9kc2lfdHJhbnNmZXIgKnhmZXI7CisKKwlj
b25zdCBzdHJ1Y3QgaW14X253bF9wbGF0Zm9ybV9kYXRhICpwZGF0YTsKK307CisKKyNlbmRpZiAv
KiBfX05XTF9EUlZfSF9fICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2lt
eC1ud2wvbndsLWRzaS5jIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9pbXgtbndsL253bC1kc2ku
YwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjBlMTQ2M2FmMTYyZgot
LS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvaW14LW53bC9ud2wtZHNp
LmMKQEAgLTAsMCArMSw3NDUgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4w
KworLyoKKyAqIE5XTCBEU0kgaG9zdCBkcml2ZXIKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMTcg
TlhQCisgKiBDb3B5cmlnaHQgKEMpIDIwMTkgUHVyaXNtIFNQQworICovCisKKyNpbmNsdWRlIDxh
c20vdW5hbGlnbmVkLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWNfaGVscGVyLmg+CisjaW5j
bHVkZSA8ZHJtL2RybV9jcnRjX2hlbHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fb2YuaD4KKyNp
bmNsdWRlIDxkcm0vZHJtX3BhbmVsLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wcmludC5oPgorI2lu
Y2x1ZGUgPGxpbnV4L2Nsay5oPgorI2luY2x1ZGUgPGxpbnV4L2lycS5oPgorI2luY2x1ZGUgPGxp
bnV4L3JlZ21hcC5oPgorI2luY2x1ZGUgPHZpZGVvL21pcGlfZGlzcGxheS5oPgorI2luY2x1ZGUg
PHZpZGVvL3ZpZGVvbW9kZS5oPgorCisjaW5jbHVkZSAibndsLWRydi5oIgorI2luY2x1ZGUgIm53
bC1kc2kuaCIKKworI2RlZmluZSBNSVBJX0ZJRk9fVElNRU9VVCBtc2Vjc190b19qaWZmaWVzKDUw
MCkKKworLyogUEtUIHJlZyBiaXQgbWFuaXB1bGF0aW9uICovCisjZGVmaW5lIFJFR19NQVNLKGUs
IHMpICgoKDEgPDwgKChlKSAtIChzKSArIDEpKSAtIDEpIDw8IChzKSkKKyNkZWZpbmUgUkVHX1BV
VCh4LCBlLCBzKSAoKCh4KSA8PCAocykpICYgUkVHX01BU0soZSwgcykpCisjZGVmaW5lIFJFR19H
RVQoeCwgZSwgcykgKCgoeCkgJiBSRUdfTUFTSyhlLCBzKSkgPj4gKHMpKQorCisvKgorICogUEtU
X0NPTlRST0wgZm9ybWF0OgorICogWzE1OiAwXSAtIHdvcmQgY291bnQKKyAqIFsxNzoxNl0gLSB2
aXJ0dWFsIGNoYW5uZWwKKyAqIFsyMzoxOF0gLSBkYXRhIHR5cGUKKyAqIFsyNF0JICAgLSBMUCBv
ciBIUyBzZWxlY3QgKDAgLSBMUCwgMSAtIEhTKQorICogWzI1XQkgICAtIHBlcmZvcm0gQlRBIGFm
dGVyIHBhY2tldCBpcyBzZW50CisgKiBbMjZdCSAgIC0gcGVyZm9ybSBCVEEgb25seSwgbm8gcGFj
a2V0IHR4CisgKi8KKyNkZWZpbmUgV0MoeCkJCVJFR19QVVQoKHgpLCAxNSwgIDApCisjZGVmaW5l
IFRYX1ZDKHgpCVJFR19QVVQoKHgpLCAxNywgMTYpCisjZGVmaW5lIFRYX0RUKHgpCVJFR19QVVQo
KHgpLCAyMywgMTgpCisjZGVmaW5lIEhTX1NFTCh4KQlSRUdfUFVUKCh4KSwgMjQsIDI0KQorI2Rl
ZmluZSBCVEFfVFgoeCkJUkVHX1BVVCgoeCksIDI1LCAyNSkKKyNkZWZpbmUgQlRBX05PX1RYKHgp
CVJFR19QVVQoKHgpLCAyNiwgMjYpCisKKy8qCisgKiBSWF9QS1RfSEVBREVSIGZvcm1hdDoKKyAq
IFsxNTogMF0gLSB3b3JkIGNvdW50CisgKiBbMjE6MTZdIC0gZGF0YSB0eXBlCisgKiBbMjM6MjJd
IC0gdmlydHVhbCBjaGFubmVsCisgKi8KKyNkZWZpbmUgUlhfRFQoeCkgUkVHX0dFVCgoeCksIDIx
LCAxNikKKyNkZWZpbmUgUlhfVkMoeCkgUkVHX0dFVCgoeCksIDIzLCAyMikKKworLyoKKyAqIERT
SSBWaWRlbyBtb2RlCisgKi8KKyNkZWZpbmUgVklERU9fTU9ERV9CVVJTVF9NT0RFX1dJVEhfU1lO
Q19QVUxTRVMJCTAKKyNkZWZpbmUgVklERU9fTU9ERV9OT05fQlVSU1RfTU9ERV9XSVRIX1NZTkNf
RVZFTlRTCUJJVCgwKQorI2RlZmluZSBWSURFT19NT0RFX0JVUlNUX01PREUJCQkJQklUKDEpCisK
Ky8qCisgKiBEUEkgY29sb3IgY29kaW5nCisgKi8KKyNkZWZpbmUgRFBJXzE2X0JJVF81NjVfUEFD
S0VECTAKKyNkZWZpbmUgRFBJXzE2X0JJVF81NjVfQUxJR05FRAkxCisjZGVmaW5lIERQSV8xNl9C
SVRfNTY1X1NISUZURUQJMgorI2RlZmluZSBEUElfMThfQklUX1BBQ0tFRAkzCisjZGVmaW5lIERQ
SV8xOF9CSVRfQUxJR05FRAk0CisjZGVmaW5lIERQSV8yNF9CSVQJCTUKKworLyoKKyAqIERQSSBQ
aXhlbCBmb3JtYXQKKyAqLworI2RlZmluZSBQSVhFTF9GT1JNQVRfMTYgIDAKKyNkZWZpbmUgUElY
RUxfRk9STUFUXzE4ICBCSVQoMCkKKyNkZWZpbmUgUElYRUxfRk9STUFUXzE4TCBCSVQoMSkKKyNk
ZWZpbmUgUElYRUxfRk9STUFUXzI0ICAoQklUKDApIHwgQklUKDEpKQorCitlbnVtIHRyYW5zZmVy
X2RpcmVjdGlvbiB7IERTSV9QQUNLRVRfU0VORCwgRFNJX1BBQ0tFVF9SRUNFSVZFIH07CisKK3N0
cnVjdCBtaXBpX2RzaV90cmFuc2ZlciB7CisJY29uc3Qgc3RydWN0IG1pcGlfZHNpX21zZyAqbXNn
OworCXN0cnVjdCBtaXBpX2RzaV9wYWNrZXQgcGFja2V0OworCXN0cnVjdCBjb21wbGV0aW9uIGNv
bXBsZXRlZDsKKworCWludCBzdGF0dXM7IC8qIHN0YXR1cyBvZiB0cmFuc21pc3Npb24gKi8KKwll
bnVtIHRyYW5zZmVyX2RpcmVjdGlvbiBkaXJlY3Rpb247CisJYm9vbCBuZWVkX2J0YTsKKwl1OCBj
bWQ7CisJdTE2IHJ4X3dvcmRfY291bnQ7CisJc2l6ZV90IHR4X2xlbjsgLyogYnl0ZXMgc2VudCAq
LworCXNpemVfdCByeF9sZW47IC8qIGJ5dGVzIHJlY2VpdmVkICovCit9OworCitzdGF0aWMgaW5s
aW5lIGludCBud2xfZHNpX3dyaXRlKHN0cnVjdCBpbXhfbndsX2RzaSAqZHNpLCB1bnNpZ25lZCBp
bnQgcmVnLAorCQkJCXUzMiB2YWwpCit7CisJaW50IHJldDsKKworCXJldCA9IHJlZ21hcF93cml0
ZShkc2ktPnJlZ21hcCwgcmVnLCB2YWwpOworCWlmIChyZXQgPCAwKQorCQlEUk1fREVWX0VSUk9S
KGRzaS0+ZGV2LAorCQkJICAgICAgIkZhaWxlZCB0byB3cml0ZSBOV0wgRFNJIHJlZyAweCV4OiAl
ZFxuIiwgcmVnLAorCQkJICAgICAgcmV0KTsKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW5s
aW5lIHUzMiBud2xfZHNpX3JlYWQoc3RydWN0IGlteF9ud2xfZHNpICpkc2ksIHUzMiByZWcpCit7
CisJdW5zaWduZWQgaW50IHZhbDsKKwlpbnQgcmV0OworCisJcmV0ID0gcmVnbWFwX3JlYWQoZHNp
LT5yZWdtYXAsIHJlZywgJnZhbCk7CisJaWYgKHJldCA8IDApCisJCURSTV9ERVZfRVJST1IoZHNp
LT5kZXYsICJGYWlsZWQgdG8gcmVhZCBOV0wgRFNJIHJlZyAweCV4OiAlZFxuIiwKKwkJCSAgICAg
IHJlZywgcmV0KTsKKworCXJldHVybiB2YWw7Cit9CisKK3N0YXRpYyB1MzIgbndsX2RzaV9nZXRf
ZHBpX3BpeGVsX2Zvcm1hdChlbnVtIG1pcGlfZHNpX3BpeGVsX2Zvcm1hdCBmb3JtYXQpCit7CisJ
c3dpdGNoIChmb3JtYXQpIHsKKwljYXNlIE1JUElfRFNJX0ZNVF9SR0I1NjU6CisJCXJldHVybiBQ
SVhFTF9GT1JNQVRfMTY7CisJY2FzZSBNSVBJX0RTSV9GTVRfUkdCNjY2OgorCQlyZXR1cm4gUElY
RUxfRk9STUFUXzE4TDsKKwljYXNlIE1JUElfRFNJX0ZNVF9SR0I2NjZfUEFDS0VEOgorCQlyZXR1
cm4gUElYRUxfRk9STUFUXzE4OworCWNhc2UgTUlQSV9EU0lfRk1UX1JHQjg4ODoKKwkJcmV0dXJu
IFBJWEVMX0ZPUk1BVF8yNDsKKwlkZWZhdWx0OgorCQlyZXR1cm4gLUVJTlZBTDsKKwl9Cit9CisK
K2ludCBud2xfZHNpX2dldF9kcGh5X3BhcmFtcyhzdHJ1Y3QgaW14X253bF9kc2kgKmRzaSwKKwkJ
CSAgICBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSwKKwkJCSAgICB1bmlvbiBw
aHlfY29uZmlndXJlX29wdHMgKnBoeV9vcHRzKQoreworCXVuc2lnbmVkIGxvbmcgcmF0ZTsKKwor
CWlmIChkc2ktPmxhbmVzIDwgMSB8fCBkc2ktPmxhbmVzID4gNCkKKwkJcmV0dXJuIC1FSU5WQUw7
CisKKwkvKgorCSAqIFNvIGZhciB0aGUgRFBIWSBzcGVjIG1pbmltYWwgdGltaW5ncyB3b3JrIGZv
ciBib3RoIG1peGVsCisJICogZHBoeSBhbmQgbndsIGRzaSBob3N0CisJICovCisJcGh5X21pcGlf
ZHBoeV9nZXRfZGVmYXVsdF9jb25maWcoCisJCW1vZGUtPmNydGNfY2xvY2sgKiAxMDAwLAorCQlt
aXBpX2RzaV9waXhlbF9mb3JtYXRfdG9fYnBwKGRzaS0+Zm9ybWF0KSwgZHNpLT5sYW5lcywKKwkJ
JnBoeV9vcHRzLT5taXBpX2RwaHkpOworCXJhdGUgPSBjbGtfZ2V0X3JhdGUoZHNpLT50eF9lc2Nf
Y2xrKTsKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkc2ktPmRldiwgIkxQIGNsayBpcyBAJWx1IEh6
XG4iLCByYXRlKTsKKwlwaHlfb3B0cy0+bWlwaV9kcGh5LmxwX2Nsa19yYXRlID0gcmF0ZTsKKwor
CXJldHVybiAwOworfQorRVhQT1JUX1NZTUJPTF9HUEwobndsX2RzaV9nZXRfZHBoeV9wYXJhbXMp
OworCisjZGVmaW5lIFBTRUNfUEVSX1NFQyAxMDAwMDAwMDAwMDAwTEwKKy8qCisgKiBwczJiYyAt
IFBpY29zZWNvbmRzIHRvIGJ5dGUgY2xvY2sgY3ljbGVzCisgKi8KK3N0YXRpYyB1MzIgcHMyYmMo
c3RydWN0IGlteF9ud2xfZHNpICpkc2ksIHVuc2lnbmVkIGxvbmcgbG9uZyBwcykKK3sKKwlpbnQg
YnBwID0gbWlwaV9kc2lfcGl4ZWxfZm9ybWF0X3RvX2JwcChkc2ktPmZvcm1hdCk7CisKKwlyZXR1
cm4gRElWX1JPVU5EX1VQKHBzICogZHNpLT52bS5waXhlbGNsb2NrICogYnBwLAorCQkJICAgIGRz
aS0+bGFuZXMgKiA4ICogUFNFQ19QRVJfU0VDKTsKK30KKworLyoqCisgKiB1aTJiYyAtIFVJIHRp
bWUgcGVyaW9kcyB0byBieXRlIGNsb2NrIGN5Y2xlcworICovCitzdGF0aWMgdTMyIHVpMmJjKHN0
cnVjdCBpbXhfbndsX2RzaSAqZHNpLCB1bnNpZ25lZCBsb25nIGxvbmcgdWkpCit7CisJaW50IGJw
cCA9IG1pcGlfZHNpX3BpeGVsX2Zvcm1hdF90b19icHAoZHNpLT5mb3JtYXQpOworCisJcmV0dXJu
IERJVl9ST1VORF9VUCh1aSAqIGRzaS0+bGFuZXMsIGRzaS0+dm0ucGl4ZWxjbG9jayAqIGJwcCk7
Cit9CisKKyNkZWZpbmUgVVNFQ19QRVJfU0VDIDEwMDAwMDBMCisvKgorICogdXMyYmMgLSBtaWNy
byBzZWNvbmRzIHRvIGxwIGNsb2NrIGN5Y2xlcworICovCitzdGF0aWMgdTMyIHVzMmxwKHUzMiBs
cF9jbGtfcmF0ZSwgdW5zaWduZWQgbG9uZyB1cykKK3sKKwlyZXR1cm4gRElWX1JPVU5EX1VQKHVz
ICogbHBfY2xrX3JhdGUsIFVTRUNfUEVSX1NFQyk7Cit9CisKK3N0YXRpYyBpbnQgbndsX2RzaV9j
b25maWdfaG9zdChzdHJ1Y3QgaW14X253bF9kc2kgKmRzaSkKK3sKKwl1MzIgY3ljbGVzOworCXN0
cnVjdCBwaHlfY29uZmlndXJlX29wdHNfbWlwaV9kcGh5ICpjZmcgPSAmZHNpLT5waHlfY2ZnLm1p
cGlfZHBoeTsKKworCWlmIChkc2ktPmxhbmVzIDwgMSB8fCBkc2ktPmxhbmVzID4gNCkKKwkJcmV0
dXJuIC1FSU5WQUw7CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkc2ktPmRldiwgIkRTSSBMYW5l
cyAlZFxuIiwgZHNpLT5sYW5lcyk7CisJbndsX2RzaV93cml0ZShkc2ksIENGR19OVU1fTEFORVMs
IGRzaS0+bGFuZXMgLSAxKTsKKworCWlmIChkc2ktPmRzaV9tb2RlX2ZsYWdzICYgTUlQSV9EU0lf
Q0xPQ0tfTk9OX0NPTlRJTlVPVVMpIHsKKwkJbndsX2RzaV93cml0ZShkc2ksIENGR19OT05DT05U
SU5VT1VTX0NMSywgMHgwMSk7CisJCW53bF9kc2lfd3JpdGUoZHNpLCBDRkdfQVVUT0lOU0VSVF9F
T1RQLCAweDAxKTsKKwl9IGVsc2UgeworCQlud2xfZHNpX3dyaXRlKGRzaSwgQ0ZHX05PTkNPTlRJ
TlVPVVNfQ0xLLCAweDAwKTsKKwkJbndsX2RzaV93cml0ZShkc2ksIENGR19BVVRPSU5TRVJUX0VP
VFAsIDB4MDApOworCX0KKworCS8qIHZhbHVlcyBpbiBieXRlIGNsb2NrIGN5Y2xlcyAqLworCWN5
Y2xlcyA9IHVpMmJjKGRzaSwgY2ZnLT5jbGtfcHJlKTsKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihk
c2ktPmRldiwgImNmZ190X3ByZTogMHgleFxuIiwgY3ljbGVzKTsKKwlud2xfZHNpX3dyaXRlKGRz
aSwgQ0ZHX1RfUFJFLCBjeWNsZXMpOworCWN5Y2xlcyA9IHBzMmJjKGRzaSwgY2ZnLT5scHggKyBj
ZmctPmNsa19wcmVwYXJlICsgY2ZnLT5jbGtfemVybyk7CisJRFJNX0RFVl9ERUJVR19EUklWRVIo
ZHNpLT5kZXYsICJjZmdfdHhfZ2FwIChwcmUpOiAweCV4XG4iLCBjeWNsZXMpOworCWN5Y2xlcyAr
PSB1aTJiYyhkc2ksIGNmZy0+Y2xrX3ByZSk7CisJRFJNX0RFVl9ERUJVR19EUklWRVIoZHNpLT5k
ZXYsICJjZmdfdHhfZ2FwOiAweCV4XG4iLCBjeWNsZXMpOworCW53bF9kc2lfd3JpdGUoZHNpLCBD
RkdfVF9QT1NULCBjeWNsZXMpOworCWN5Y2xlcyA9IHBzMmJjKGRzaSwgY2ZnLT5oc19leGl0KTsK
KwlEUk1fREVWX0RFQlVHX0RSSVZFUihkc2ktPmRldiwgImNmZ190eF9nYXA6IDB4JXhcbiIsIGN5
Y2xlcyk7CisJbndsX2RzaV93cml0ZShkc2ksIENGR19UWF9HQVAsIGN5Y2xlcyk7CisKKwlud2xf
ZHNpX3dyaXRlKGRzaSwgQ0ZHX0VYVFJBX0NNRFNfQUZURVJfRU9UUCwgMHgwMSk7CisJbndsX2Rz
aV93cml0ZShkc2ksIENGR19IVFhfVE9fQ09VTlQsIDB4MDApOworCW53bF9kc2lfd3JpdGUoZHNp
LCBDRkdfTFJYX0hfVE9fQ09VTlQsIDB4MDApOworCW53bF9kc2lfd3JpdGUoZHNpLCBDRkdfQlRB
X0hfVE9fQ09VTlQsIDB4MDApOworCS8qIEluIExQIGNsb2NrIGN5Y2xlcyAqLworCWN5Y2xlcyA9
IHVzMmxwKGNmZy0+bHBfY2xrX3JhdGUsIGNmZy0+d2FrZXVwKTsKKwlEUk1fREVWX0RFQlVHX0RS
SVZFUihkc2ktPmRldiwgImNmZ190d2FrZXVwOiAweCV4XG4iLCBjeWNsZXMpOworCW53bF9kc2lf
d3JpdGUoZHNpLCBDRkdfVFdBS0VVUCwgY3ljbGVzKTsKKworCXJldHVybiAwOworfQorCitzdGF0
aWMgaW50IG53bF9kc2lfY29uZmlnX2RwaShzdHJ1Y3QgaW14X253bF9kc2kgKmRzaSkKK3sKKwlz
dHJ1Y3QgdmlkZW9tb2RlICp2bSA9ICZkc2ktPnZtOworCXUzMiBjb2xvcl9mb3JtYXQsIG1vZGU7
CisJYm9vbCBidXJzdF9tb2RlOworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZHNpLT5kZXYsICJo
ZnJvbnRfcG9yY2ggPSAlZFxuIiwgdm0tPmhmcm9udF9wb3JjaCk7CisJRFJNX0RFVl9ERUJVR19E
UklWRVIoZHNpLT5kZXYsICJoYmFja19wb3JjaCA9ICVkXG4iLCB2bS0+aGJhY2tfcG9yY2gpOwor
CURSTV9ERVZfREVCVUdfRFJJVkVSKGRzaS0+ZGV2LCAiaHN5bmNfbGVuID0gJWRcbiIsIHZtLT5o
c3luY19sZW4pOworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRzaS0+ZGV2LCAiaGFjdGl2ZSA9ICVk
XG4iLCB2bS0+aGFjdGl2ZSk7CisJRFJNX0RFVl9ERUJVR19EUklWRVIoZHNpLT5kZXYsICJ2ZnJv
bnRfcG9yY2ggPSAlZFxuIiwgdm0tPnZmcm9udF9wb3JjaCk7CisJRFJNX0RFVl9ERUJVR19EUklW
RVIoZHNpLT5kZXYsICJ2YmFja19wb3JjaCA9ICVkXG4iLCB2bS0+dmJhY2tfcG9yY2gpOworCURS
TV9ERVZfREVCVUdfRFJJVkVSKGRzaS0+ZGV2LCAidnN5bmNfbGVuID0gJWRcbiIsIHZtLT52c3lu
Y19sZW4pOworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRzaS0+ZGV2LCAidmFjdGl2ZSA9ICVkXG4i
LCB2bS0+dmFjdGl2ZSk7CisJRFJNX0RFVl9ERUJVR19EUklWRVIoZHNpLT5kZXYsICJjbG9jayA9
ICVsdSBrSHpcbiIsCisJCQkgICAgIHZtLT5waXhlbGNsb2NrIC8gMTAwMCk7CisKKwljb2xvcl9m
b3JtYXQgPSBud2xfZHNpX2dldF9kcGlfcGl4ZWxfZm9ybWF0KGRzaS0+Zm9ybWF0KTsKKwlpZiAo
Y29sb3JfZm9ybWF0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGRzaS0+ZGV2LCAiSW52YWxpZCBj
b2xvciBmb3JtYXQgMHgleFxuIiwKKwkJCSAgICAgIGRzaS0+Zm9ybWF0KTsKKwkJcmV0dXJuIGNv
bG9yX2Zvcm1hdDsKKwl9CisJRFJNX0RFVl9ERUJVR19EUklWRVIoZHNpLT5kZXYsICJwaXhlbCBm
bXQgPSAlZFxuIiwgZHNpLT5mb3JtYXQpOworCisJbndsX2RzaV93cml0ZShkc2ksIElOVEVSRkFD
RV9DT0xPUl9DT0RJTkcsIERQSV8yNF9CSVQpOworCW53bF9kc2lfd3JpdGUoZHNpLCBQSVhFTF9G
T1JNQVQsIGNvbG9yX2Zvcm1hdCk7CisJLyoKKwkgKiBBZGp1c3RpbmcgaW5wdXQgcG9sYXJpdHkg
YmFzZWQgb24gdGhlIHZpZGVvIG1vZGUgcmVzdWx0cyBpbgorCSAqIGEgYmxhY2sgc2NyZWVuIHNv
IGFsd2F5cyBwaWNrIGFjdGl2ZSBsb3c6CisJICovCisJbndsX2RzaV93cml0ZShkc2ksIFZTWU5D
X1BPTEFSSVRZLCBWU1lOQ19QT0xBUklUWV9BQ1RJVkVfTE9XKTsKKwlud2xfZHNpX3dyaXRlKGRz
aSwgSFNZTkNfUE9MQVJJVFksIEhTWU5DX1BPTEFSSVRZX0FDVElWRV9MT1cpOworCisJYnVyc3Rf
bW9kZSA9IChkc2ktPmRzaV9tb2RlX2ZsYWdzICYgTUlQSV9EU0lfTU9ERV9WSURFT19CVVJTVCkg
JiYKKwkJICAgICAhKGRzaS0+ZHNpX21vZGVfZmxhZ3MgJiBNSVBJX0RTSV9NT0RFX1ZJREVPX1NZ
TkNfUFVMU0UpOworCisJaWYgKGJ1cnN0X21vZGUpIHsKKwkJbndsX2RzaV93cml0ZShkc2ksIFZJ
REVPX01PREUsIFZJREVPX01PREVfQlVSU1RfTU9ERSk7CisJCW53bF9kc2lfd3JpdGUoZHNpLCBQ
SVhFTF9GSUZPX1NFTkRfTEVWRUwsIDI1Nik7CisJfSBlbHNlIHsKKwkJbW9kZSA9ICgoZHNpLT5k
c2lfbW9kZV9mbGFncyAmIE1JUElfRFNJX01PREVfVklERU9fU1lOQ19QVUxTRSkgPworCQkJCVZJ
REVPX01PREVfQlVSU1RfTU9ERV9XSVRIX1NZTkNfUFVMU0VTIDoKKwkJCQlWSURFT19NT0RFX05P
Tl9CVVJTVF9NT0RFX1dJVEhfU1lOQ19FVkVOVFMpOworCQlud2xfZHNpX3dyaXRlKGRzaSwgVklE
RU9fTU9ERSwgbW9kZSk7CisJCW53bF9kc2lfd3JpdGUoZHNpLCBQSVhFTF9GSUZPX1NFTkRfTEVW
RUwsIHZtLT5oYWN0aXZlKTsKKwl9CisKKwlud2xfZHNpX3dyaXRlKGRzaSwgSEZQLCB2bS0+aGZy
b250X3BvcmNoKTsKKwlud2xfZHNpX3dyaXRlKGRzaSwgSEJQLCB2bS0+aGJhY2tfcG9yY2gpOwor
CW53bF9kc2lfd3JpdGUoZHNpLCBIU0EsIHZtLT5oc3luY19sZW4pOworCisJbndsX2RzaV93cml0
ZShkc2ksIEVOQUJMRV9NVUxUX1BLVFMsIDB4MCk7CisJbndsX2RzaV93cml0ZShkc2ksIEJMTFBf
TU9ERSwgMHgxKTsKKwlud2xfZHNpX3dyaXRlKGRzaSwgRU5BQkxFX01VTFRfUEtUUywgMHgwKTsK
Kwlud2xfZHNpX3dyaXRlKGRzaSwgVVNFX05VTExfUEtUX0JMTFAsIDB4MCk7CisJbndsX2RzaV93
cml0ZShkc2ksIFZDLCAweDApOworCisJbndsX2RzaV93cml0ZShkc2ksIFBJWEVMX1BBWUxPQURf
U0laRSwgdm0tPmhhY3RpdmUpOworCW53bF9kc2lfd3JpdGUoZHNpLCBWQUNUSVZFLCB2bS0+dmFj
dGl2ZSAtIDEpOworCW53bF9kc2lfd3JpdGUoZHNpLCBWQlAsIHZtLT52YmFja19wb3JjaCk7CisJ
bndsX2RzaV93cml0ZShkc2ksIFZGUCwgdm0tPnZmcm9udF9wb3JjaCk7CisKKwlyZXR1cm4gMDsK
K30KKworc3RhdGljIGludCBud2xfZHNpX2VuYWJsZV90eF9jbG9jayhzdHJ1Y3QgaW14X253bF9k
c2kgKmRzaSkKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSBkc2ktPmRldjsKKwlpbnQgcmV0Owor
CisJcmV0ID0gY2xrX3ByZXBhcmVfZW5hYmxlKGRzaS0+dHhfZXNjX2Nsayk7CisJaWYgKHJldCA8
IDApIHsKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8gZW5hYmxlIHR4X2VzYyBjbGs6
ICVkXG4iLCByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKworCURSTV9ERVZfREVCVUdfRFJJVkVS
KGRldiwgIkVuYWJsZWQgdHhfZXNjIGNsayBAJWx1IEh6XG4iLAorCQkJICAgICBjbGtfZ2V0X3Jh
dGUoZHNpLT50eF9lc2NfY2xrKSk7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgbndsX2Rz
aV9lbmFibGVfcnhfY2xvY2soc3RydWN0IGlteF9ud2xfZHNpICpkc2kpCit7CisJc3RydWN0IGRl
dmljZSAqZGV2ID0gZHNpLT5kZXY7CisJaW50IHJldDsKKworCXJldCA9IGNsa19wcmVwYXJlX2Vu
YWJsZShkc2ktPnJ4X2VzY19jbGspOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9ERVZfRVJST1Io
ZGV2LCAiRmFpbGVkIHRvIGVuYWJsZSByeF9lc2MgY2xrOiAlZFxuIiwgcmV0KTsKKwkJcmV0dXJu
IHJldDsKKwl9CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJFbmFibGVkIHJ4X2VzYyBj
bGsgQCVsdSBIelxuIiwKKwkJCSAgICAgY2xrX2dldF9yYXRlKGRzaS0+cnhfZXNjX2NsaykpOwor
CXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBud2xfZHNpX2luaXRfaW50ZXJydXB0cyhzdHJ1
Y3QgaW14X253bF9kc2kgKmRzaSkKK3sKKwl1MzIgaXJxX2VuYWJsZTsKKworCW53bF9kc2lfd3Jp
dGUoZHNpLCBJUlFfTUFTSywgMHhmZmZmZmZmZik7CisJbndsX2RzaV93cml0ZShkc2ksIElSUV9N
QVNLMiwgMHg3KTsKKworCWlycV9lbmFibGUgPSB+KHUzMikoVFhfUEtUX0RPTkVfTUFTSyB8IFJY
X1BLVF9IRFJfUkNWRF9NQVNLIHwKKwkJCSAgICBUWF9GSUZPX09WRkxXX01BU0sgfCBIU19UWF9U
SU1FT1VUX01BU0spOworCisJbndsX2RzaV93cml0ZShkc2ksIElSUV9NQVNLLCBpcnFfZW5hYmxl
KTsKK30KKworc3RhdGljIGludCBud2xfZHNpX2hvc3RfYXR0YWNoKHN0cnVjdCBtaXBpX2RzaV9o
b3N0ICpkc2lfaG9zdCwKKwkJCSAgICAgICBzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkZXZpY2Up
Cit7CisJc3RydWN0IGlteF9ud2xfZHNpICpkc2kgPQorCQljb250YWluZXJfb2YoZHNpX2hvc3Qs
IHN0cnVjdCBpbXhfbndsX2RzaSwgZHNpX2hvc3QpOworCXN0cnVjdCBkZXZpY2UgKmRldiA9IGRz
aS0+ZGV2OworCXN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2U7CisJc3RydWN0IGRybV9wYW5lbCAq
cGFuZWw7CisJaW50IHJldDsKKworCURSTV9ERVZfSU5GTyhkZXYsICJsYW5lcz0ldSwgZm9ybWF0
PTB4JXggZmxhZ3M9MHglbHhcbiIsIGRldmljZS0+bGFuZXMsCisJCSAgICAgZGV2aWNlLT5mb3Jt
YXQsIGRldmljZS0+bW9kZV9mbGFncyk7CisKKwlpZiAoZGV2aWNlLT5sYW5lcyA8IDEgfHwgZGV2
aWNlLT5sYW5lcyA+IDQpCisJCXJldHVybiAtRUlOVkFMOworCisJZHNpLT5sYW5lcyA9IGRldmlj
ZS0+bGFuZXM7CisJZHNpLT5mb3JtYXQgPSBkZXZpY2UtPmZvcm1hdDsKKwlkc2ktPmRzaV9tb2Rl
X2ZsYWdzID0gZGV2aWNlLT5tb2RlX2ZsYWdzOworCisJcmV0ID0gZHJtX29mX2ZpbmRfcGFuZWxf
b3JfYnJpZGdlKGRzaS0+ZGV2LT5vZl9ub2RlLCAxLCAwLCAmcGFuZWwsCisJCQkJCSAgJmJyaWRn
ZSk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCWlmIChwYW5lbCkgeworCQlicmlkZ2Ug
PSBkcm1fcGFuZWxfYnJpZGdlX2FkZChwYW5lbCwgRFJNX01PREVfQ09OTkVDVE9SX0RTSSk7CisJ
CWlmIChJU19FUlIoYnJpZGdlKSkKKwkJCXJldHVybiBQVFJfRVJSKGJyaWRnZSk7CisJfQorCisJ
ZHNpLT5wYW5lbF9icmlkZ2UgPSBicmlkZ2U7CisJZHJtX2JyaWRnZV9hZGQoJmRzaS0+YnJpZGdl
KTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IG53bF9kc2lfaG9zdF9kZXRhY2goc3Ry
dWN0IG1pcGlfZHNpX2hvc3QgKmRzaV9ob3N0LAorCQkJICAgICAgIHN0cnVjdCBtaXBpX2RzaV9k
ZXZpY2UgKmRldmljZSkKK3sKKwlzdHJ1Y3QgaW14X253bF9kc2kgKmRzaSA9CisJCWNvbnRhaW5l
cl9vZihkc2lfaG9zdCwgc3RydWN0IGlteF9ud2xfZHNpLCBkc2lfaG9zdCk7CisKKwlkcm1fb2Zf
cGFuZWxfYnJpZGdlX3JlbW92ZShkc2ktPmRldi0+b2Zfbm9kZSwgMSwgMCk7CisJZHJtX2JyaWRn
ZV9yZW1vdmUoJmRzaS0+YnJpZGdlKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgYm9vbCBu
d2xfZHNpX3JlYWRfcGFja2V0KHN0cnVjdCBpbXhfbndsX2RzaSAqZHNpLCB1MzIgc3RhdHVzKQor
eworCXN0cnVjdCBkZXZpY2UgKmRldiA9IGRzaS0+ZGV2OworCXN0cnVjdCBtaXBpX2RzaV90cmFu
c2ZlciAqeGZlciA9IGRzaS0+eGZlcjsKKwl1OCAqcGF5bG9hZCA9IHhmZXItPm1zZy0+cnhfYnVm
OworCXUzMiB2YWw7CisJdTE2IHdvcmRfY291bnQ7CisJdTggY2hhbm5lbDsKKwl1OCBkYXRhX3R5
cGU7CisKKwl4ZmVyLT5zdGF0dXMgPSAwOworCisJaWYgKHhmZXItPnJ4X3dvcmRfY291bnQgPT0g
MCkgeworCQlpZiAoIShzdGF0dXMgJiBSWF9QS1RfSERSX1JDVkQpKQorCQkJcmV0dXJuIGZhbHNl
OworCQkvKiBHZXQgdGhlIFJYIGhlYWRlciBhbmQgcGFyc2UgaXQgKi8KKwkJdmFsID0gbndsX2Rz
aV9yZWFkKGRzaSwgUlhfUEtUX0hFQURFUik7CisJCXdvcmRfY291bnQgPSBXQyh2YWwpOworCQlj
aGFubmVsID0gUlhfVkModmFsKTsKKwkJZGF0YV90eXBlID0gUlhfRFQodmFsKTsKKworCQlpZiAo
Y2hhbm5lbCAhPSB4ZmVyLT5tc2ctPmNoYW5uZWwpIHsKKwkJCURSTV9ERVZfRVJST1IoZGV2LAor
CQkJCSAgICAgICJbJTAyWF0gQ2hhbm5lbCBtaXNtYXRjaCAoJXUgIT0gJXUpXG4iLAorCQkJCSAg
ICAgIHhmZXItPmNtZCwgY2hhbm5lbCwgeGZlci0+bXNnLT5jaGFubmVsKTsKKwkJCXJldHVybiB0
cnVlOworCQl9CisKKwkJc3dpdGNoIChkYXRhX3R5cGUpIHsKKwkJY2FzZSBNSVBJX0RTSV9SWF9H
RU5FUklDX1NIT1JUX1JFQURfUkVTUE9OU0VfMkJZVEU6CisJCQkvKiBGYWxsIHRocm91Z2ggKi8K
KwkJY2FzZSBNSVBJX0RTSV9SWF9EQ1NfU0hPUlRfUkVBRF9SRVNQT05TRV8yQllURToKKwkJCWlm
ICh4ZmVyLT5tc2ctPnJ4X2xlbiA+IDEpIHsKKwkJCQkvKiByZWFkIHNlY29uZCBieXRlICovCisJ
CQkJcGF5bG9hZFsxXSA9IHdvcmRfY291bnQgPj4gODsKKwkJCQkrK3hmZXItPnJ4X2xlbjsKKwkJ
CX0KKwkJCS8qIEZhbGwgdGhyb3VnaCAqLworCQljYXNlIE1JUElfRFNJX1JYX0dFTkVSSUNfU0hP
UlRfUkVBRF9SRVNQT05TRV8xQllURToKKwkJCS8qIEZhbGwgdGhyb3VnaCAqLworCQljYXNlIE1J
UElfRFNJX1JYX0RDU19TSE9SVF9SRUFEX1JFU1BPTlNFXzFCWVRFOgorCQkJaWYgKHhmZXItPm1z
Zy0+cnhfbGVuID4gMCkgeworCQkJCS8qIHJlYWQgZmlyc3QgYnl0ZSAqLworCQkJCXBheWxvYWRb
MF0gPSB3b3JkX2NvdW50ICYgMHhmZjsKKwkJCQkrK3hmZXItPnJ4X2xlbjsKKwkJCX0KKwkJCXhm
ZXItPnN0YXR1cyA9IHhmZXItPnJ4X2xlbjsKKwkJCXJldHVybiB0cnVlOworCQljYXNlIE1JUElf
RFNJX1JYX0FDS05PV0xFREdFX0FORF9FUlJPUl9SRVBPUlQ6CisJCQl3b3JkX2NvdW50ICY9IDB4
ZmY7CisJCQlEUk1fREVWX0VSUk9SKGRldiwgIlslMDJYXSBEU0kgZXJyb3IgcmVwb3J0OiAweCUw
MnhcbiIsCisJCQkJICAgICAgeGZlci0+Y21kLCB3b3JkX2NvdW50KTsKKwkJCXhmZXItPnN0YXR1
cyA9IC1FUFJPVE87CisJCQlyZXR1cm4gdHJ1ZTsKKwkJfQorCisJCWlmICh3b3JkX2NvdW50ID4g
eGZlci0+bXNnLT5yeF9sZW4pIHsKKwkJCURSTV9ERVZfRVJST1IoCisJCQkJZGV2LAorCQkJCSJb
JTAyWF0gUmVjZWl2ZSBidWZmZXIgdG9vIHNtYWxsOiAlbHUgKDwgJXUpXG4iLAorCQkJCXhmZXIt
PmNtZCwgeGZlci0+bXNnLT5yeF9sZW4sIHdvcmRfY291bnQpOworCQkJcmV0dXJuIHRydWU7CisJ
CX0KKworCQl4ZmVyLT5yeF93b3JkX2NvdW50ID0gd29yZF9jb3VudDsKKwl9IGVsc2UgeworCQkv
KiBTZXQgd29yZF9jb3VudCBmcm9tIHByZXZpb3VzIGhlYWRlciByZWFkICovCisJCXdvcmRfY291
bnQgPSB4ZmVyLT5yeF93b3JkX2NvdW50OworCX0KKworCS8qIElmIFJYIHBheWxvYWQgaXMgbm90
IHlldCByZWNlaXZlZCwgd2FpdCBmb3IgaXQgKi8KKwlpZiAoIShzdGF0dXMgJiBSWF9QS1RfUEFZ
TE9BRF9EQVRBX1JDVkQpKQorCQlyZXR1cm4gZmFsc2U7CisKKwkvKiBSZWFkIHRoZSBSWCBwYXls
b2FkICovCisJd2hpbGUgKHdvcmRfY291bnQgPj0gNCkgeworCQl2YWwgPSBud2xfZHNpX3JlYWQo
ZHNpLCBSWF9QQVlMT0FEKTsKKwkJcGF5bG9hZFswXSA9ICh2YWwgPj4gMCkgJiAweGZmOworCQlw
YXlsb2FkWzFdID0gKHZhbCA+PiA4KSAmIDB4ZmY7CisJCXBheWxvYWRbMl0gPSAodmFsID4+IDE2
KSAmIDB4ZmY7CisJCXBheWxvYWRbM10gPSAodmFsID4+IDI0KSAmIDB4ZmY7CisJCXBheWxvYWQg
Kz0gNDsKKwkJeGZlci0+cnhfbGVuICs9IDQ7CisJCXdvcmRfY291bnQgLT0gNDsKKwl9CisKKwlp
ZiAod29yZF9jb3VudCA+IDApIHsKKwkJdmFsID0gbndsX2RzaV9yZWFkKGRzaSwgUlhfUEFZTE9B
RCk7CisJCXN3aXRjaCAod29yZF9jb3VudCkgeworCQljYXNlIDM6CisJCQlwYXlsb2FkWzJdID0g
KHZhbCA+PiAxNikgJiAweGZmOworCQkJKyt4ZmVyLT5yeF9sZW47CisJCQkvKiBGYWxsIHRocm91
Z2ggKi8KKwkJY2FzZSAyOgorCQkJcGF5bG9hZFsxXSA9ICh2YWwgPj4gOCkgJiAweGZmOworCQkJ
Kyt4ZmVyLT5yeF9sZW47CisJCQkvKiBGYWxsIHRocm91Z2ggKi8KKwkJY2FzZSAxOgorCQkJcGF5
bG9hZFswXSA9ICh2YWwgPj4gMCkgJiAweGZmOworCQkJKyt4ZmVyLT5yeF9sZW47CisJCQlicmVh
azsKKwkJfQorCX0KKworCXhmZXItPnN0YXR1cyA9IHhmZXItPnJ4X2xlbjsKKworCXJldHVybiB0
cnVlOworfQorCitzdGF0aWMgdm9pZCBud2xfZHNpX2ZpbmlzaF90cmFuc21pc3Npb24oc3RydWN0
IGlteF9ud2xfZHNpICpkc2ksIHUzMiBzdGF0dXMpCit7CisJc3RydWN0IG1pcGlfZHNpX3RyYW5z
ZmVyICp4ZmVyID0gZHNpLT54ZmVyOworCWJvb2wgZW5kX3BhY2tldCA9IGZhbHNlOworCisJaWYg
KCF4ZmVyKQorCQlyZXR1cm47CisKKwlpZiAoc3RhdHVzICYgVFhfRklGT19PVkZMVykgeworCQlE
Uk1fREVWX0VSUk9SX1JBVEVMSU1JVEVEKGRzaS0+ZGV2LCAidHggZmlmbyBvdmVyZmxvd1xuIik7
CisJCXJldHVybjsKKwl9CisKKwlpZiAoc3RhdHVzICYgSFNfVFhfVElNRU9VVCkgeworCQlEUk1f
REVWX0VSUk9SX1JBVEVMSU1JVEVEKGRzaS0+ZGV2LCAiSFMgdHggdGltZW91dFxuIik7CisJCXJl
dHVybjsKKwl9CisKKwlpZiAoeGZlci0+ZGlyZWN0aW9uID09IERTSV9QQUNLRVRfU0VORCAmJiBz
dGF0dXMgJiBUWF9QS1RfRE9ORSkgeworCQl4ZmVyLT5zdGF0dXMgPSB4ZmVyLT50eF9sZW47CisJ
CWVuZF9wYWNrZXQgPSB0cnVlOworCX0gZWxzZSBpZiAoc3RhdHVzICYgRFBIWV9ESVJFQ1RJT04g
JiYKKwkJICAgKChzdGF0dXMgJiAoUlhfUEtUX0hEUl9SQ1ZEIHwgUlhfUEtUX1BBWUxPQURfREFU
QV9SQ1ZEKSkpKSB7CisJCWVuZF9wYWNrZXQgPSBud2xfZHNpX3JlYWRfcGFja2V0KGRzaSwgc3Rh
dHVzKTsKKwl9CisKKwlpZiAoZW5kX3BhY2tldCkKKwkJY29tcGxldGUoJnhmZXItPmNvbXBsZXRl
ZCk7Cit9CisKK3N0YXRpYyB2b2lkIG53bF9kc2lfYmVnaW5fdHJhbnNtaXNzaW9uKHN0cnVjdCBp
bXhfbndsX2RzaSAqZHNpKQoreworCXN0cnVjdCBtaXBpX2RzaV90cmFuc2ZlciAqeGZlciA9IGRz
aS0+eGZlcjsKKwlzdHJ1Y3QgbWlwaV9kc2lfcGFja2V0ICpwa3QgPSAmeGZlci0+cGFja2V0Owor
CWNvbnN0IHU4ICpwYXlsb2FkOworCXNpemVfdCBsZW5ndGg7CisJdTE2IHdvcmRfY291bnQ7CisJ
dTggaHNfbW9kZTsKKwl1MzIgdmFsOworCXUzMiBoc193b3JrYXJvdW5kID0gMDsKKworCS8qIFNl
bmQgdGhlIHBheWxvYWQsIGlmIGFueSAqLworCWxlbmd0aCA9IHBrdC0+cGF5bG9hZF9sZW5ndGg7
CisJcGF5bG9hZCA9IHBrdC0+cGF5bG9hZDsKKworCXdoaWxlIChsZW5ndGggPj0gNCkgeworCQl2
YWwgPSBnZXRfdW5hbGlnbmVkX2xlMzIocGF5bG9hZCk7CisJCWhzX3dvcmthcm91bmQgfD0gISh2
YWwgJiAweEZGRkYwMCk7CisJCW53bF9kc2lfd3JpdGUoZHNpLCBUWF9QQVlMT0FELCB2YWwpOwor
CQlwYXlsb2FkICs9IDQ7CisJCWxlbmd0aCAtPSA0OworCX0KKwkvKiBTZW5kIHRoZSByZXN0IG9m
IHRoZSBwYXlsb2FkICovCisJdmFsID0gMDsKKwlzd2l0Y2ggKGxlbmd0aCkgeworCWNhc2UgMzoK
KwkJdmFsIHw9IHBheWxvYWRbMl0gPDwgMTY7CisJCS8qIEZhbGwgdGhyb3VnaCAqLworCWNhc2Ug
MjoKKwkJdmFsIHw9IHBheWxvYWRbMV0gPDwgODsKKwkJaHNfd29ya2Fyb3VuZCB8PSAhKHZhbCAm
IDB4RkZGRjAwKTsKKwkJLyogRmFsbCB0aHJvdWdoICovCisJY2FzZSAxOgorCQl2YWwgfD0gcGF5
bG9hZFswXTsKKwkJbndsX2RzaV93cml0ZShkc2ksIFRYX1BBWUxPQUQsIHZhbCk7CisJCWJyZWFr
OworCX0KKwl4ZmVyLT50eF9sZW4gPSBwa3QtPnBheWxvYWRfbGVuZ3RoOworCisJLyoKKwkgKiBT
ZW5kIHRoZSBoZWFkZXIKKwkgKiBoZWFkZXJbMF0gPSBWaXJ0dWFsIENoYW5uZWwgKyBEYXRhIFR5
cGUKKwkgKiBoZWFkZXJbMV0gPSBXb3JkIENvdW50IExTQiAoTFApIG9yIGZpcnN0IHBhcmFtIChT
UCkKKwkgKiBoZWFkZXJbMl0gPSBXb3JkIENvdW50IE1TQiAoTFApIG9yIHNlY29uZCBwYXJhbSAo
U1ApCisJICovCisJd29yZF9jb3VudCA9IHBrdC0+aGVhZGVyWzFdIHwgKHBrdC0+aGVhZGVyWzJd
IDw8IDgpOworCWlmICgoaHNfd29ya2Fyb3VuZCAmJiBVU0VfRTExNDE4X0hTX01PREVfUVVJUkso
ZHNpLT5xdWlya3MpKSkgeworCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkc2ktPmRldiwKKwkJCQkg
ICAgICJVc2luZyBocyBtb2RlIHdvcmthcm91bmQgZm9yIGNtZCAweCV4XG4iLAorCQkJCSAgICAg
eGZlci0+Y21kKTsKKwkJaHNfbW9kZSA9IDE7CisJfSBlbHNlIHsKKwkJaHNfbW9kZSA9ICh4ZmVy
LT5tc2ctPmZsYWdzICYgTUlQSV9EU0lfTVNHX1VTRV9MUE0pID8gMCA6IDE7CisJfQorCXZhbCA9
IFdDKHdvcmRfY291bnQpIHwKKwkJVFhfVkMoeGZlci0+bXNnLT5jaGFubmVsKSB8CisJCVRYX0RU
KHhmZXItPm1zZy0+dHlwZSkgfAorCQlIU19TRUwoaHNfbW9kZSkgfAorCQlCVEFfVFgoeGZlci0+
bmVlZF9idGEpOworCW53bF9kc2lfd3JpdGUoZHNpLCBQS1RfQ09OVFJPTCwgdmFsKTsKKworCS8q
IFNlbmQgcGFja2V0IGNvbW1hbmQgKi8KKwlud2xfZHNpX3dyaXRlKGRzaSwgU0VORF9QQUNLRVQs
IDB4MSk7Cit9CisKK3N0YXRpYyBzc2l6ZV90IG53bF9kc2lfaG9zdF90cmFuc2ZlcihzdHJ1Y3Qg
bWlwaV9kc2lfaG9zdCAqZHNpX2hvc3QsCisJCQkJICAgICBjb25zdCBzdHJ1Y3QgbWlwaV9kc2lf
bXNnICptc2cpCit7CisJc3RydWN0IGlteF9ud2xfZHNpICpkc2kgPQorCQljb250YWluZXJfb2Yo
ZHNpX2hvc3QsIHN0cnVjdCBpbXhfbndsX2RzaSwgZHNpX2hvc3QpOworCXN0cnVjdCBtaXBpX2Rz
aV90cmFuc2ZlciB4ZmVyOworCXNzaXplX3QgcmV0ID0gMDsKKworCS8qIENyZWF0ZSBwYWNrZXQg
dG8gYmUgc2VudCAqLworCWRzaS0+eGZlciA9ICZ4ZmVyOworCXJldCA9IG1pcGlfZHNpX2NyZWF0
ZV9wYWNrZXQoJnhmZXIucGFja2V0LCBtc2cpOworCWlmIChyZXQgPCAwKSB7CisJCWRzaS0+eGZl
ciA9IE5VTEw7CisJCXJldHVybiByZXQ7CisJfQorCisJaWYgKChtc2ctPnR5cGUgJiBNSVBJX0RT
SV9HRU5FUklDX1JFQURfUkVRVUVTVF8wX1BBUkFNIHx8CisJICAgICBtc2ctPnR5cGUgJiBNSVBJ
X0RTSV9HRU5FUklDX1JFQURfUkVRVUVTVF8xX1BBUkFNIHx8CisJICAgICBtc2ctPnR5cGUgJiBN
SVBJX0RTSV9HRU5FUklDX1JFQURfUkVRVUVTVF8yX1BBUkFNIHx8CisJICAgICBtc2ctPnR5cGUg
JiBNSVBJX0RTSV9EQ1NfUkVBRCkgJiYKKwkgICAgbXNnLT5yeF9sZW4gPiAwICYmIG1zZy0+cnhf
YnVmICE9IE5VTEwpCisJCXhmZXIuZGlyZWN0aW9uID0gRFNJX1BBQ0tFVF9SRUNFSVZFOworCWVs
c2UKKwkJeGZlci5kaXJlY3Rpb24gPSBEU0lfUEFDS0VUX1NFTkQ7CisKKwl4ZmVyLm5lZWRfYnRh
ID0gKHhmZXIuZGlyZWN0aW9uID09IERTSV9QQUNLRVRfUkVDRUlWRSk7CisJeGZlci5uZWVkX2J0
YSB8PSAobXNnLT5mbGFncyAmIE1JUElfRFNJX01TR19SRVFfQUNLKSA/IDEgOiAwOworCXhmZXIu
bXNnID0gbXNnOworCXhmZXIuc3RhdHVzID0gLUVUSU1FRE9VVDsKKwl4ZmVyLnJ4X3dvcmRfY291
bnQgPSAwOworCXhmZXIucnhfbGVuID0gMDsKKwl4ZmVyLmNtZCA9IDB4MDA7CisJaWYgKG1zZy0+
dHhfbGVuID4gMCkKKwkJeGZlci5jbWQgPSAoKHU4ICopKG1zZy0+dHhfYnVmKSlbMF07CisJaW5p
dF9jb21wbGV0aW9uKCZ4ZmVyLmNvbXBsZXRlZCk7CisKKwlud2xfZHNpX2VuYWJsZV9yeF9jbG9j
ayhkc2kpOworCisJLyogSW5pdGlhdGUgdGhlIERTSSBwYWNrZXQgdHJhbnNtaXNpb24gKi8KKwlu
d2xfZHNpX2JlZ2luX3RyYW5zbWlzc2lvbihkc2kpOworCisJaWYgKCF3YWl0X2Zvcl9jb21wbGV0
aW9uX3RpbWVvdXQoJnhmZXIuY29tcGxldGVkLCBNSVBJX0ZJRk9fVElNRU9VVCkpIHsKKwkJRFJN
X0RFVl9FUlJPUihkc2lfaG9zdC0+ZGV2LCAiWyUwMlhdIERTSSB0cmFuc2ZlciB0aW1lZCBvdXRc
biIsCisJCQkgICAgICB4ZmVyLmNtZCk7CisJCXJldCA9IC1FVElNRURPVVQ7CisJfSBlbHNlIHsK
KwkJcmV0ID0geGZlci5zdGF0dXM7CisJfQorCisJY2xrX2Rpc2FibGVfdW5wcmVwYXJlKGRzaS0+
cnhfZXNjX2Nsayk7CisKKwlyZXR1cm4gcmV0OworfQorCitjb25zdCBzdHJ1Y3QgbWlwaV9kc2lf
aG9zdF9vcHMgbndsX2RzaV9ob3N0X29wcyA9IHsKKwkuYXR0YWNoID0gbndsX2RzaV9ob3N0X2F0
dGFjaCwKKwkuZGV0YWNoID0gbndsX2RzaV9ob3N0X2RldGFjaCwKKwkudHJhbnNmZXIgPSBud2xf
ZHNpX2hvc3RfdHJhbnNmZXIsCit9OworCitpcnFyZXR1cm5fdCBud2xfZHNpX2lycV9oYW5kbGVy
KGludCBpcnEsIHZvaWQgKmRhdGEpCit7CisJdTMyIGlycV9zdGF0dXM7CisJc3RydWN0IGlteF9u
d2xfZHNpICpkc2kgPSBkYXRhOworCisJaXJxX3N0YXR1cyA9IG53bF9kc2lfcmVhZChkc2ksIElS
UV9TVEFUVVMpOworCisJaWYgKGlycV9zdGF0dXMgJiBUWF9QS1RfRE9ORSB8fCBpcnFfc3RhdHVz
ICYgUlhfUEtUX0hEUl9SQ1ZEIHx8CisJICAgIGlycV9zdGF0dXMgJiBSWF9QS1RfUEFZTE9BRF9E
QVRBX1JDVkQpCisJCW53bF9kc2lfZmluaXNoX3RyYW5zbWlzc2lvbihkc2ksIGlycV9zdGF0dXMp
OworCisJcmV0dXJuIElSUV9IQU5ETEVEOworfQorRVhQT1JUX1NZTUJPTF9HUEwobndsX2RzaV9p
cnFfaGFuZGxlcik7CisKK2ludCBud2xfZHNpX2VuYWJsZShzdHJ1Y3QgaW14X253bF9kc2kgKmRz
aSkKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSBkc2ktPmRldjsKKwl1bmlvbiBwaHlfY29uZmln
dXJlX29wdHMgKnBoeV9jZmcgPSAmZHNpLT5waHlfY2ZnOworCWludCByZXQ7CisKKwlpZiAoIWRz
aS0+bGFuZXMpIHsKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJOZWVkIERTSSBsYW5lczogJWRcbiIs
IGRzaS0+bGFuZXMpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlyZXQgPSBwaHlfaW5pdChk
c2ktPnBoeSk7CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQg
dG8gaW5pdCBEU0kgcGh5OiAlZFxuIiwgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXQg
PSBwaHlfY29uZmlndXJlKGRzaS0+cGh5LCBwaHlfY2ZnKTsKKwlpZiAocmV0IDwgMCkgeworCQlE
Uk1fREVWX0VSUk9SKGRldiwgIkZhaWxlZCB0byBjb25maWd1cmUgRFNJIHBoeTogJWRcbiIsIHJl
dCk7CisJCXJldHVybiByZXQ7CisJfQorCisJcmV0ID0gbndsX2RzaV9lbmFibGVfdHhfY2xvY2so
ZHNpKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGRldiwgIkZhaWxlZCB0byBl
bmFibGUgdHggY2xvY2s6ICVkXG4iLCByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKworCXJldCA9
IG53bF9kc2lfY29uZmlnX2hvc3QoZHNpKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VS
Uk9SKGRldiwgIkZhaWxlZCB0byBzZXQgdXAgRFNJOiAlZCIsIHJldCk7CisJCXJldHVybiByZXQ7
CisJfQorCisJcmV0ID0gbndsX2RzaV9jb25maWdfZHBpKGRzaSk7CisJaWYgKHJldCA8IDApIHsK
KwkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8gc2V0IHVwIERQSTogJWQiLCByZXQpOwor
CQlyZXR1cm4gcmV0OworCX0KKworCXJldCA9IHBoeV9wb3dlcl9vbihkc2ktPnBoeSk7CisJaWYg
KHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8gcG93ZXIgb24gRFBI
WSAoJWQpXG4iLCByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKworCW53bF9kc2lfaW5pdF9pbnRl
cnJ1cHRzKGRzaSk7CisKKwlyZXR1cm4gMDsKK30KK0VYUE9SVF9TWU1CT0xfR1BMKG53bF9kc2lf
ZW5hYmxlKTsKKworaW50IG53bF9kc2lfZGlzYWJsZShzdHJ1Y3QgaW14X253bF9kc2kgKmRzaSkK
K3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSBkc2ktPmRldjsKKworCURSTV9ERVZfREVCVUdfRFJJ
VkVSKGRldiwgIkRpc2FibGluZyBjbG9ja3MgYW5kIHBoeVxuIik7CisKKwlwaHlfcG93ZXJfb2Zm
KGRzaS0+cGh5KTsKKwlwaHlfZXhpdChkc2ktPnBoeSk7CisKKwkvKiBEaXNhYmxpbmcgdGhlIGNs
b2NrIGJlZm9yZSB0aGUgcGh5IGJyZWFrcyBlbmFibGluZyBkc2kgYWdhaW4gKi8KKwljbGtfZGlz
YWJsZV91bnByZXBhcmUoZHNpLT50eF9lc2NfY2xrKTsKKworCXJldHVybiAwOworfQorRVhQT1JU
X1NZTUJPTF9HUEwobndsX2RzaV9kaXNhYmxlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9icmlkZ2UvaW14LW53bC9ud2wtZHNpLmggYi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2lteC1u
d2wvbndsLWRzaS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uN2Jj
ZjgwNDg0M2UyCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9pbXgt
bndsL253bC1kc2kuaApAQCAtMCwwICsxLDExMSBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IEdQTC0yLjArICovCisvKgorICogaS5NWDggTldMIE1JUEkgRFNJIGhvc3QgZHJpdmVyCisg
KgorICogQ29weXJpZ2h0IChDKSAyMDE3IE5YUAorICogQ29weXJpZ2h0IChDKSAyMDE5IFB1cmlz
bSBTUEMKKyAqLworI2lmbmRlZiBfX05XTF9EU0lfSF9fCisjZGVmaW5lIF9fTldMX0RTSV9IX18K
KworI2luY2x1ZGUgPGRybS9kcm1fbWlwaV9kc2kuaD4KKworLyogRFNJIEhPU1QgcmVnaXN0ZXJz
ICovCisjZGVmaW5lIENGR19OVU1fTEFORVMJCQkweDAKKyNkZWZpbmUgQ0ZHX05PTkNPTlRJTlVP
VVNfQ0xLCQkweDQKKyNkZWZpbmUgQ0ZHX1RfUFJFCQkJMHg4CisjZGVmaW5lIENGR19UX1BPU1QJ
CQkweGMKKyNkZWZpbmUgQ0ZHX1RYX0dBUAkJCTB4MTAKKyNkZWZpbmUgQ0ZHX0FVVE9JTlNFUlRf
RU9UUAkJMHgxNAorI2RlZmluZSBDRkdfRVhUUkFfQ01EU19BRlRFUl9FT1RQCTB4MTgKKyNkZWZp
bmUgQ0ZHX0hUWF9UT19DT1VOVAkJMHgxYworI2RlZmluZSBDRkdfTFJYX0hfVE9fQ09VTlQJCTB4
MjAKKyNkZWZpbmUgQ0ZHX0JUQV9IX1RPX0NPVU5UCQkweDI0CisjZGVmaW5lIENGR19UV0FLRVVQ
CQkJMHgyOAorI2RlZmluZSBDRkdfU1RBVFVTX09VVAkJCTB4MmMKKyNkZWZpbmUgUlhfRVJST1Jf
U1RBVFVTCQkJMHgzMAorCisvKiBEU0kgRFBJIHJlZ2lzdGVycyAqLworI2RlZmluZSBQSVhFTF9Q
QVlMT0FEX1NJWkUJCTB4MjAwCisjZGVmaW5lIFBJWEVMX0ZJRk9fU0VORF9MRVZFTAkJMHgyMDQK
KyNkZWZpbmUgSU5URVJGQUNFX0NPTE9SX0NPRElORwkJMHgyMDgKKyNkZWZpbmUgUElYRUxfRk9S
TUFUCQkJMHgyMGMKKyNkZWZpbmUgVlNZTkNfUE9MQVJJVFkJCQkweDIxMAorI2RlZmluZSBWU1lO
Q19QT0xBUklUWV9BQ1RJVkVfTE9XCTAKKyNkZWZpbmUgVlNZTkNfUE9MQVJJVFlfQUNUSVZFX0hJ
R0gJQklUKDEpCisKKyNkZWZpbmUgSFNZTkNfUE9MQVJJVFkJCQkweDIxNAorI2RlZmluZSBIU1lO
Q19QT0xBUklUWV9BQ1RJVkVfTE9XCTAKKyNkZWZpbmUgSFNZTkNfUE9MQVJJVFlfQUNUSVZFX0hJ
R0gJQklUKDEpCisKKyNkZWZpbmUgVklERU9fTU9ERQkJCTB4MjE4CisjZGVmaW5lIEhGUAkJCQkw
eDIxYworI2RlZmluZSBIQlAJCQkJMHgyMjAKKyNkZWZpbmUgSFNBCQkJCTB4MjI0CisjZGVmaW5l
IEVOQUJMRV9NVUxUX1BLVFMJCTB4MjI4CisjZGVmaW5lIFZCUAkJCQkweDIyYworI2RlZmluZSBW
RlAJCQkJMHgyMzAKKyNkZWZpbmUgQkxMUF9NT0RFCQkJMHgyMzQKKyNkZWZpbmUgVVNFX05VTExf
UEtUX0JMTFAJCTB4MjM4CisjZGVmaW5lIFZBQ1RJVkUJCQkJMHgyM2MKKyNkZWZpbmUgVkMJCQkJ
MHgyNDAKKworLyogRFNJIEFQQiBQS1QgY29udHJvbCAqLworI2RlZmluZSBUWF9QQVlMT0FECQkJ
MHgyODAKKyNkZWZpbmUgUEtUX0NPTlRST0wJCQkweDI4NAorI2RlZmluZSBTRU5EX1BBQ0tFVAkJ
CTB4Mjg4CisjZGVmaW5lIFBLVF9TVEFUVVMJCQkweDI4YworI2RlZmluZSBQS1RfRklGT19XUl9M
RVZFTAkJMHgyOTAKKyNkZWZpbmUgUEtUX0ZJRk9fUkRfTEVWRUwJCTB4Mjk0CisjZGVmaW5lIFJY
X1BBWUxPQUQJCQkweDI5OAorI2RlZmluZSBSWF9QS1RfSEVBREVSCQkJMHgyOWMKKworLyogRFNJ
IElSUSBoYW5kbGluZyAqLworI2RlZmluZSBJUlFfU1RBVFVTCQkJMHgyYTAKKyNkZWZpbmUgU01f
Tk9UX0lETEUJCQlCSVQoMCkKKyNkZWZpbmUgVFhfUEtUX0RPTkUJCQlCSVQoMSkKKyNkZWZpbmUg
RFBIWV9ESVJFQ1RJT04JCQlCSVQoMikKKyNkZWZpbmUgVFhfRklGT19PVkZMVwkJCUJJVCgzKQor
I2RlZmluZSBUWF9GSUZPX1VERkxXCQkJQklUKDQpCisjZGVmaW5lIFJYX0ZJRk9fT1ZGTFcJCQlC
SVQoNSkKKyNkZWZpbmUgUlhfRklGT19VREZMVwkJCUJJVCg2KQorI2RlZmluZSBSWF9QS1RfSERS
X1JDVkQJCQlCSVQoNykKKyNkZWZpbmUgUlhfUEtUX1BBWUxPQURfREFUQV9SQ1ZECUJJVCg4KQor
I2RlZmluZSBCVEFfVElNRU9VVAkJCUJJVCgyOSkKKyNkZWZpbmUgTFBfUlhfVElNRU9VVAkJCUJJ
VCgzMCkKKyNkZWZpbmUgSFNfVFhfVElNRU9VVAkJCUJJVCgzMSkKKworI2RlZmluZSBJUlFfU1RB
VFVTMgkJCTB4MmE0CisjZGVmaW5lIFNJTkdMRV9CSVRfRUNDX0VSUgkJQklUKDApCisjZGVmaW5l
IE1VTFRJX0JJVF9FQ0NfRVJSCQlCSVQoMSkKKyNkZWZpbmUgQ1JDX0VSUgkJCQlCSVQoMikKKwor
I2RlZmluZSBJUlFfTUFTSwkJCTB4MmE4CisjZGVmaW5lIFNNX05PVF9JRExFX01BU0sJCUJJVCgw
KQorI2RlZmluZSBUWF9QS1RfRE9ORV9NQVNLCQlCSVQoMSkKKyNkZWZpbmUgRFBIWV9ESVJFQ1RJ
T05fTUFTSwkJQklUKDIpCisjZGVmaW5lIFRYX0ZJRk9fT1ZGTFdfTUFTSwkJQklUKDMpCisjZGVm
aW5lIFRYX0ZJRk9fVURGTFdfTUFTSwkJQklUKDQpCisjZGVmaW5lIFJYX0ZJRk9fT1ZGTFdfTUFT
SwkJQklUKDUpCisjZGVmaW5lIFJYX0ZJRk9fVURGTFdfTUFTSwkJQklUKDYpCisjZGVmaW5lIFJY
X1BLVF9IRFJfUkNWRF9NQVNLCQlCSVQoNykKKyNkZWZpbmUgUlhfUEtUX1BBWUxPQURfREFUQV9S
Q1ZEX01BU0sJQklUKDgpCisjZGVmaW5lIEJUQV9USU1FT1VUX01BU0sJCUJJVCgyOSkKKyNkZWZp
bmUgTFBfUlhfVElNRU9VVF9NQVNLCQlCSVQoMzApCisjZGVmaW5lIEhTX1RYX1RJTUVPVVRfTUFT
SwkJQklUKDMxKQorCisjZGVmaW5lIElSUV9NQVNLMgkJCTB4MmFjCisjZGVmaW5lIFNJTkdMRV9C
SVRfRUNDX0VSUl9NQVNLCQlCSVQoMCkKKyNkZWZpbmUgTVVMVElfQklUX0VDQ19FUlJfTUFTSwkJ
QklUKDEpCisjZGVmaW5lIENSQ19FUlJfTUFTSwkJCUJJVCgyKQorCitleHRlcm4gY29uc3Qgc3Ry
dWN0IG1pcGlfZHNpX2hvc3Rfb3BzIG53bF9kc2lfaG9zdF9vcHM7CisKK2lycXJldHVybl90IG53
bF9kc2lfaXJxX2hhbmRsZXIoaW50IGlycSwgdm9pZCAqZGF0YSk7CitpbnQgbndsX2RzaV9lbmFi
bGUoc3RydWN0IGlteF9ud2xfZHNpICpkc2kpOworaW50IG53bF9kc2lfZGlzYWJsZShzdHJ1Y3Qg
aW14X253bF9kc2kgKmRzaSk7CitpbnQgbndsX2RzaV9nZXRfZHBoeV9wYXJhbXMoc3RydWN0IGlt
eF9ud2xfZHNpICpkc2ksCisJCQkgICAgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1v
ZGUsCisJCQkgICAgdW5pb24gcGh5X2NvbmZpZ3VyZV9vcHRzICpwaHlfb3B0cyk7CisKKyNlbmRp
ZiAvKiBfX05XTF9EU0lfSF9fICovCi0tIAoyLjIwLjEKCgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZl
bEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFp
bG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
