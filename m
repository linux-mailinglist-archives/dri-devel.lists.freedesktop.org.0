Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id CDD18D62BA
	for <lists+dri-devel@lfdr.de>; Mon, 14 Oct 2019 14:38:52 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 776DD6E2AF;
	Mon, 14 Oct 2019 12:38:48 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-wm1-x343.google.com (mail-wm1-x343.google.com
 [IPv6:2a00:1450:4864:20::343])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 731F46E29D
 for <dri-devel@lists.freedesktop.org>; Mon, 14 Oct 2019 12:38:39 +0000 (UTC)
Received: by mail-wm1-x343.google.com with SMTP id 3so16601582wmi.3
 for <dri-devel@lists.freedesktop.org>; Mon, 14 Oct 2019 05:38:39 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=EiSsjXYdZZOyYEr4Sge65wETKP2xlBLGlhOiCPBSXkE=;
 b=EUE1oUKroK0+JXg/ivCoj+xlAMY04vBm8pyg/LsHcahrD5kJUFTIfIt003VLZpPcO/
 mxaa/H68+KgFYWtwhCzxwtG91ORTNSicKrRrQ1xK7TSpLOb4TwfgDEoumc/aYdJ01SpB
 RpHRodLC6MspBTN6i/5oStUnro8pvYD7FtXjWxmC970/WOE+pE6PR8vleT/DQn2l2oiC
 vrjw2+JwU6cZn+t84+zVxwC9pKLWcaDULvhSmZkDx5Ke4Y0MXWyCmHBen0LCVggZ9NUN
 8yiXEBkujWRCfKidvqkLt20wNKiV/GFN6RvlDJRAjTU1JQ6MprIRFMnUI0yO30Zm0Waf
 ppHg==
X-Gm-Message-State: APjAAAUn4IKAWrsEvu01Z5CWqsYCRrhNUR3TJPLYxT2pfdASM9UeZOem
 aKq1Fv1xQafuP49At5KjNgZqxurpRewMpg==
X-Google-Smtp-Source: APXvYqzQsEvFHjzDzBZg9POutNu7rB/rrGxvWic5J6WlC0lB4yoepYEDP1Wv+bO14FoAwTG3v7zvaQ==
X-Received: by 2002:a05:600c:2308:: with SMTP id
 8mr14332978wmo.73.1571056716969; 
 Mon, 14 Oct 2019 05:38:36 -0700 (PDT)
Received: from bender.baylibre.local
 (lmontsouris-657-1-212-31.w90-63.abo.wanadoo.fr. [90.63.244.31])
 by smtp.gmail.com with ESMTPSA id 3sm19171203wmo.22.2019.10.14.05.38.35
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 14 Oct 2019 05:38:35 -0700 (PDT)
From: Neil Armstrong <narmstrong@baylibre.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v2 7/7] drm/meson: crtc: add OSD1 plane AFBC commit
Date: Mon, 14 Oct 2019 14:38:26 +0200
Message-Id: <20191014123826.27629-8-narmstrong@baylibre.com>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20191014123826.27629-1-narmstrong@baylibre.com>
References: <20191014123826.27629-1-narmstrong@baylibre.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=baylibre-com.20150623.gappssmtp.com; s=20150623;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=EiSsjXYdZZOyYEr4Sge65wETKP2xlBLGlhOiCPBSXkE=;
 b=RnrWUEFN8vlpvLRfCehFrxjuaM3ZPHu283UjOXmJxLbT1c8e8xMrzbwKmim6fENpYj
 dTuRcMey7nMCXj3OUJneBs0DWVuZFw4EQXcPj40zn+DHdsMHNHCFKIVIvkuXNMAubGTj
 UEDWW8Q6PmJtaQBK+rkcLks46jxJyiA0euIKb2QShBqK7KiFwBDxNeKaywxhWRCXZvuo
 +4oKJXllMlVPe1FU26JJnKQ71pKGKGC3TW8Fzb0GYbA7NhK0+/YCdzhImKBod+LUHyM+
 4CuY+nEX456JhK4nYKgoSzdlSI6Hk6DNIjnnGYH0vGnRtVsB4tf71iTpA3pvA4a9ggVP
 nwsg==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Neil Armstrong <narmstrong@baylibre.com>, khilman@baylibre.com,
 linux-amlogic@lists.infradead.org, ayan.halder@arm.com,
 linux-arm-kernel@lists.infradead.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RmluYWxseSwgc2V0dXAgdGhlIFZJVSByZWdpc3RlcnMgYW5kIHN0YXJ0IHRoZSBBRkJDIGRlY29k
ZXIgYXQgZWFjaAp2c3luYyBJUlEgdG8gc3VwcG9ydCBkaXNwbGF5aW5nIEFGQkMgZW5jb2RlZCBi
dWZmZXJzIG9uIEFtbG9naWMgR1hNCmFuZCBHMTJBIFNvQ3MuCgpTaW5jZSB0aGUgRFJNIGNvcmUg
d2lsbCBzdG9wIHRoZSB2c3luYyBJUlEgYWZ0ZXIgYSBmZXcgaW50ZXJydXB0cywKd2UgbmVlZCB0
byBrZWVwIHRoZSBJUlEgZW5hYmxlZCB3aGlsZSB1c2luZyB0aGUgQUZCQyBkZWNvZGVyLgoKU2ln
bmVkLW9mZi1ieTogTmVpbCBBcm1zdHJvbmcgPG5hcm1zdHJvbmdAYmF5bGlicmUuY29tPgotLS0K
IGRyaXZlcnMvZ3B1L2RybS9tZXNvbi9tZXNvbl9jcnRjLmMgfCA3OSArKysrKysrKysrKysrKysr
KysrKysrKysrKysrLS0KIDEgZmlsZSBjaGFuZ2VkLCA3NCBpbnNlcnRpb25zKCspLCA1IGRlbGV0
aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9tZXNvbi9tZXNvbl9jcnRjLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vbWVzb24vbWVzb25fY3J0Yy5jCmluZGV4IGQ0NzhmYTIzMjk1MS4u
ZDI4ZWZkMGRiZjExIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbWVzb24vbWVzb25fY3J0
Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9tZXNvbi9tZXNvbl9jcnRjLmMKQEAgLTI0LDYgKzI0
LDcgQEAKICNpbmNsdWRlICJtZXNvbl92ZW5jLmgiCiAjaW5jbHVkZSAibWVzb25fdml1LmgiCiAj
aW5jbHVkZSAibWVzb25fdnBwLmgiCisjaW5jbHVkZSAibWVzb25fb3NkX2FmYmNkLmgiCiAKICNk
ZWZpbmUgTUVTT05fRzEyQV9WSVVfT0ZGU0VUCTB4NWVjMAogCkBAIC0zNSw3ICszNiwxMSBAQCBz
dHJ1Y3QgbWVzb25fY3J0YyB7CiAJc3RydWN0IG1lc29uX2RybSAqcHJpdjsKIAl2b2lkICgqZW5h
YmxlX29zZDEpKHN0cnVjdCBtZXNvbl9kcm0gKnByaXYpOwogCXZvaWQgKCplbmFibGVfdmQxKShz
dHJ1Y3QgbWVzb25fZHJtICpwcml2KTsKKwl2b2lkICgqZW5hYmxlX29zZDFfYWZiYykoc3RydWN0
IG1lc29uX2RybSAqcHJpdik7CisJdm9pZCAoKmRpc2FibGVfb3NkMV9hZmJjKShzdHJ1Y3QgbWVz
b25fZHJtICpwcml2KTsKIAl1bnNpZ25lZCBpbnQgdml1X29mZnNldDsKKwlib29sIHZzeW5jX2Zv
cmNlZDsKKwlib29sIHZzeW5jX2Rpc2FibGVkOwogfTsKICNkZWZpbmUgdG9fbWVzb25fY3J0Yyh4
KSBjb250YWluZXJfb2YoeCwgc3RydWN0IG1lc29uX2NydGMsIGJhc2UpCiAKQEAgLTQ2LDYgKzUx
LDcgQEAgc3RhdGljIGludCBtZXNvbl9jcnRjX2VuYWJsZV92Ymxhbmsoc3RydWN0IGRybV9jcnRj
ICpjcnRjKQogCXN0cnVjdCBtZXNvbl9jcnRjICptZXNvbl9jcnRjID0gdG9fbWVzb25fY3J0Yyhj
cnRjKTsKIAlzdHJ1Y3QgbWVzb25fZHJtICpwcml2ID0gbWVzb25fY3J0Yy0+cHJpdjsKIAorCW1l
c29uX2NydGMtPnZzeW5jX2Rpc2FibGVkID0gZmFsc2U7CiAJbWVzb25fdmVuY19lbmFibGVfdnN5
bmMocHJpdik7CiAKIAlyZXR1cm4gMDsKQEAgLTU2LDcgKzYyLDEwIEBAIHN0YXRpYyB2b2lkIG1l
c29uX2NydGNfZGlzYWJsZV92Ymxhbmsoc3RydWN0IGRybV9jcnRjICpjcnRjKQogCXN0cnVjdCBt
ZXNvbl9jcnRjICptZXNvbl9jcnRjID0gdG9fbWVzb25fY3J0YyhjcnRjKTsKIAlzdHJ1Y3QgbWVz
b25fZHJtICpwcml2ID0gbWVzb25fY3J0Yy0+cHJpdjsKIAotCW1lc29uX3ZlbmNfZGlzYWJsZV92
c3luYyhwcml2KTsKKwlpZiAoIW1lc29uX2NydGMtPnZzeW5jX2ZvcmNlZCkgeworCQltZXNvbl9j
cnRjLT52c3luY19kaXNhYmxlZCA9IHRydWU7CisJCW1lc29uX3ZlbmNfZGlzYWJsZV92c3luYyhw
cml2KTsKKwl9CiB9CiAKIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2NydGNfZnVuY3MgbWVzb25f
Y3J0Y19mdW5jcyA9IHsKQEAgLTIzNiw2ICsyNDUsMjYgQEAgc3RhdGljIHZvaWQgbWVzb25fY3J0
Y19lbmFibGVfb3NkMShzdHJ1Y3QgbWVzb25fZHJtICpwcml2KQogCQkJICAgIHByaXYtPmlvX2Jh
c2UgKyBfUkVHKFZQUF9NSVNDKSk7CiB9CiAKK3N0YXRpYyB2b2lkIG1lc29uX2NydGNfZzEyYV9l
bmFibGVfb3NkMV9hZmJjKHN0cnVjdCBtZXNvbl9kcm0gKnByaXYpCit7CisJd3JpdGVsX3JlbGF4
ZWQocHJpdi0+dml1Lm9zZDFfYmxrMl9jZmc0LAorCQkgICAgICAgcHJpdi0+aW9fYmFzZSArIF9S
RUcoVklVX09TRDFfQkxLMl9DRkdfVzQpKTsKKworCXdyaXRlbF9iaXRzX3JlbGF4ZWQoT1NEX01F
TV9MSU5FQVJfQUREUiwgT1NEX01FTV9MSU5FQVJfQUREUiwKKwkJCSAgICBwcml2LT5pb19iYXNl
ICsgX1JFRyhWSVVfT1NEMV9DVFJMX1NUQVQpKTsKKworCXdyaXRlbF9yZWxheGVkKHByaXYtPnZp
dS5vc2QxX2JsazFfY2ZnNCwKKwkJICAgICAgIHByaXYtPmlvX2Jhc2UgKyBfUkVHKFZJVV9PU0Qx
X0JMSzFfQ0ZHX1c0KSk7CisKKwltZXNvbl92aXVfZzEyYV9lbmFibGVfb3NkMV9hZmJjKHByaXYp
OworCisJd3JpdGVsX2JpdHNfcmVsYXhlZChPU0RfTUVNX0xJTkVBUl9BRERSLCBPU0RfTUVNX0xJ
TkVBUl9BRERSLAorCQkJICAgIHByaXYtPmlvX2Jhc2UgKyBfUkVHKFZJVV9PU0QxX0NUUkxfU1RB
VCkpOworCisJd3JpdGVsX2JpdHNfcmVsYXhlZChPU0RfTUFMSV9TUkNfRU4sIE9TRF9NQUxJX1NS
Q19FTiwKKwkJCSAgICBwcml2LT5pb19iYXNlICsgX1JFRyhWSVVfT1NEMV9CTEswX0NGR19XMCkp
OworfQorCiBzdGF0aWMgdm9pZCBtZXNvbl9nMTJhX2NydGNfZW5hYmxlX29zZDEoc3RydWN0IG1l
c29uX2RybSAqcHJpdikKIHsKIAl3cml0ZWxfcmVsYXhlZChwcml2LT52aXUub3NkX2JsZW5kX2Rp
bjBfc2NvcGVfaCwKQEAgLTI5Myw2ICszMjIsMTkgQEAgdm9pZCBtZXNvbl9jcnRjX2lycShzdHJ1
Y3QgbWVzb25fZHJtICpwcml2KQogCQkJCXByaXYtPmlvX2Jhc2UgKyBfUkVHKFZJVV9PU0QxX0JM
SzBfQ0ZHX1czKSk7CiAJCXdyaXRlbF9yZWxheGVkKHByaXYtPnZpdS5vc2QxX2JsazBfY2ZnWzRd
LAogCQkJCXByaXYtPmlvX2Jhc2UgKyBfUkVHKFZJVV9PU0QxX0JMSzBfQ0ZHX1c0KSk7CisKKwkJ
aWYgKHByaXYtPnZpdS5vc2QxX2FmYmNkKSB7CisJCQlpZiAobWVzb25fY3J0Yy0+ZW5hYmxlX29z
ZDFfYWZiYykKKwkJCQltZXNvbl9jcnRjLT5lbmFibGVfb3NkMV9hZmJjKHByaXYpOworCQl9IGVs
c2UgeworCQkJaWYgKG1lc29uX2NydGMtPmRpc2FibGVfb3NkMV9hZmJjKQorCQkJCW1lc29uX2Ny
dGMtPmRpc2FibGVfb3NkMV9hZmJjKHByaXYpOworCQkJaWYgKHByaXYtPmFmYmNkLm9wcykgewor
CQkJCXByaXYtPmFmYmNkLm9wcy0+cmVzZXQocHJpdik7CisJCQkJcHJpdi0+YWZiY2Qub3BzLT5k
aXNhYmxlKHByaXYpOworCQkJfQorCQl9CisKIAkJd3JpdGVsX3JlbGF4ZWQocHJpdi0+dml1Lm9z
ZF9zY19jdHJsMCwKIAkJCQlwcml2LT5pb19iYXNlICsgX1JFRyhWUFBfT1NEX1NDX0NUUkwwKSk7
CiAJCXdyaXRlbF9yZWxheGVkKHByaXYtPnZpdS5vc2Rfc2NfaV93aF9tMSwKQEAgLTMxNCwxNSAr
MzU2LDIzIEBAIHZvaWQgbWVzb25fY3J0Y19pcnEoc3RydWN0IG1lc29uX2RybSAqcHJpdikKIAkJ
d3JpdGVsX3JlbGF4ZWQocHJpdi0+dml1Lm9zZF9zY192X2N0cmwwLAogCQkJCXByaXYtPmlvX2Jh
c2UgKyBfUkVHKFZQUF9PU0RfVlNDX0NUUkwwKSk7CiAKLQkJbWVzb25fY2FudmFzX2NvbmZpZyhw
cml2LT5jYW52YXMsIHByaXYtPmNhbnZhc19pZF9vc2QxLAotCQkJCXByaXYtPnZpdS5vc2QxX2Fk
ZHIsIHByaXYtPnZpdS5vc2QxX3N0cmlkZSwKLQkJCQlwcml2LT52aXUub3NkMV9oZWlnaHQsIE1F
U09OX0NBTlZBU19XUkFQX05PTkUsCi0JCQkJTUVTT05fQ0FOVkFTX0JMS01PREVfTElORUFSLCAw
KTsKKwkJaWYgKCFwcml2LT52aXUub3NkMV9hZmJjZCkKKwkJCW1lc29uX2NhbnZhc19jb25maWco
cHJpdi0+Y2FudmFzLCBwcml2LT5jYW52YXNfaWRfb3NkMSwKKwkJCQkJICAgIHByaXYtPnZpdS5v
c2QxX2FkZHIsCisJCQkJCSAgICBwcml2LT52aXUub3NkMV9zdHJpZGUsCisJCQkJCSAgICBwcml2
LT52aXUub3NkMV9oZWlnaHQsCisJCQkJCSAgICBNRVNPTl9DQU5WQVNfV1JBUF9OT05FLAorCQkJ
CQkgICAgTUVTT05fQ0FOVkFTX0JMS01PREVfTElORUFSLCAwKTsKIAogCQkvKiBFbmFibGUgT1NE
MSAqLwogCQlpZiAobWVzb25fY3J0Yy0+ZW5hYmxlX29zZDEpCiAJCQltZXNvbl9jcnRjLT5lbmFi
bGVfb3NkMShwcml2KTsKIAorCQlpZiAocHJpdi0+dml1Lm9zZDFfYWZiY2QpCisJCQltZXNvbl9j
cnRjLT52c3luY19mb3JjZWQgPSB0cnVlOworCQllbHNlCisJCQltZXNvbl9jcnRjLT52c3luY19m
b3JjZWQgPSBmYWxzZTsKKwogCQlwcml2LT52aXUub3NkMV9jb21taXQgPSBmYWxzZTsKIAl9CiAK
QEAgLTU0NSw2ICs1OTUsMTUgQEAgdm9pZCBtZXNvbl9jcnRjX2lycShzdHJ1Y3QgbWVzb25fZHJt
ICpwcml2KQogCQlwcml2LT52aXUudmQxX2NvbW1pdCA9IGZhbHNlOwogCX0KIAorCWlmIChtZXNv
bl9jcnRjLT52c3luY19mb3JjZWQgJiYgcHJpdi0+dml1Lm9zZDFfYWZiY2QpIHsKKwkJcHJpdi0+
YWZiY2Qub3BzLT5yZXNldChwcml2KTsKKwkJcHJpdi0+YWZiY2Qub3BzLT5zZXR1cChwcml2KTsK
KwkJcHJpdi0+YWZiY2Qub3BzLT5lbmFibGUocHJpdik7CisJfQorCisJaWYgKG1lc29uX2NydGMt
PnZzeW5jX2Rpc2FibGVkKQorCQlyZXR1cm47CisKIAlkcm1fY3J0Y19oYW5kbGVfdmJsYW5rKHBy
aXYtPmNydGMpOwogCiAJc3Bpbl9sb2NrX2lycXNhdmUoJnByaXYtPmRybS0+ZXZlbnRfbG9jaywg
ZmxhZ3MpOwpAQCAtNTgxLDEwICs2NDAsMjAgQEAgaW50IG1lc29uX2NydGNfY3JlYXRlKHN0cnVj
dCBtZXNvbl9kcm0gKnByaXYpCiAJCW1lc29uX2NydGMtPmVuYWJsZV9vc2QxID0gbWVzb25fZzEy
YV9jcnRjX2VuYWJsZV9vc2QxOwogCQltZXNvbl9jcnRjLT5lbmFibGVfdmQxID0gbWVzb25fZzEy
YV9jcnRjX2VuYWJsZV92ZDE7CiAJCW1lc29uX2NydGMtPnZpdV9vZmZzZXQgPSBNRVNPTl9HMTJB
X1ZJVV9PRkZTRVQ7CisJCW1lc29uX2NydGMtPmVuYWJsZV9vc2QxX2FmYmMgPQorCQkJCQltZXNv
bl9jcnRjX2cxMmFfZW5hYmxlX29zZDFfYWZiYzsKKwkJbWVzb25fY3J0Yy0+ZGlzYWJsZV9vc2Qx
X2FmYmMgPQorCQkJCQltZXNvbl92aXVfZzEyYV9kaXNhYmxlX29zZDFfYWZiYzsKIAkJZHJtX2Ny
dGNfaGVscGVyX2FkZChjcnRjLCAmbWVzb25fZzEyYV9jcnRjX2hlbHBlcl9mdW5jcyk7CiAJfSBl
bHNlIHsKIAkJbWVzb25fY3J0Yy0+ZW5hYmxlX29zZDEgPSBtZXNvbl9jcnRjX2VuYWJsZV9vc2Qx
OwogCQltZXNvbl9jcnRjLT5lbmFibGVfdmQxID0gbWVzb25fY3J0Y19lbmFibGVfdmQxOworCQlp
ZiAobWVzb25fdnB1X2lzX2NvbXBhdGlibGUocHJpdiwgVlBVX0NPTVBBVElCTEVfR1hNKSkgewor
CQkJbWVzb25fY3J0Yy0+ZW5hYmxlX29zZDFfYWZiYyA9CisJCQkJCW1lc29uX3ZpdV9neG1fZW5h
YmxlX29zZDFfYWZiYzsKKwkJCW1lc29uX2NydGMtPmRpc2FibGVfb3NkMV9hZmJjID0KKwkJCQkJ
bWVzb25fdml1X2d4bV9kaXNhYmxlX29zZDFfYWZiYzsKKwkJfQogCQlkcm1fY3J0Y19oZWxwZXJf
YWRkKGNydGMsICZtZXNvbl9jcnRjX2hlbHBlcl9mdW5jcyk7CiAJfQogCi0tIAoyLjIyLjAKCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBt
YWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3Rz
LmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
