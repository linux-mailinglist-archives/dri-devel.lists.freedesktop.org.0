Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id E721757F2C
	for <lists+dri-devel@lfdr.de>; Thu, 27 Jun 2019 11:22:27 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 265596E838;
	Thu, 27 Jun 2019 09:22:24 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x543.google.com (mail-ed1-x543.google.com
 [IPv6:2a00:1450:4864:20::543])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 337E96E838
 for <dri-devel@lists.freedesktop.org>; Thu, 27 Jun 2019 09:22:23 +0000 (UTC)
Received: by mail-ed1-x543.google.com with SMTP id k8so6380978eds.7
 for <dri-devel@lists.freedesktop.org>; Thu, 27 Jun 2019 02:22:23 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:sender:date:from:to:cc:subject:message-id
 :references:mime-version:content-disposition:in-reply-to:user-agent;
 bh=W1VyEWelcKzfJIC5kPqQ6AXBeo82tyom3uADEJcmG+s=;
 b=djyF4/sSSAadkC6ByWqHWXqZ/skmdjJrRdf4Qu6fWbYf850/ARmMAnhH637lLDP1T/
 nk2sf/dPyjYApl/rUudDwPx1SeKPM8WFRrCpTfDvXzQmCYUZ4PPiL2s2roJs5nkc/AHb
 O0m4kWcZ4haMG6LyGijTg6XsANCd600ZNxbAMEcn0I7bumUhWYygmBjilxGWbT808wkT
 DXiQzGgwoXNc2tDZ/KbrbYY7dOm03H0fqL/GNlkhWGc7nfLWI07lC5oSt3F3jJCP7Uvw
 FkDTYrzIe9Z6oQ5A/AR9uqH3go1FpVj8a0Ek+XUPcOx8Xd4AkIP4aMrLabXckkQ6cSKg
 lr1A==
X-Gm-Message-State: APjAAAXIZkNbWPiD5XNMFqodU8lPT/Qs6oi4qNUwo86QXzsz5dS+GpYK
 yTt20AbfRyG+laSTqcA0JonDSQ==
X-Google-Smtp-Source: APXvYqz9i5COW9KBCtvl5yTj91PoEez8O+6aWXMpEHFBAesnMwLBmJLBosxZlKnm3XlN54gvtIgipQ==
X-Received: by 2002:a17:906:264a:: with SMTP id
 i10mr2137316ejc.10.1561627341780; 
 Thu, 27 Jun 2019 02:22:21 -0700 (PDT)
Received: from phenom.ffwll.local ([2a02:168:569e:0:3106:d637:d723:e855])
 by smtp.gmail.com with ESMTPSA id h10sm545043ede.93.2019.06.27.02.22.20
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Thu, 27 Jun 2019 02:22:21 -0700 (PDT)
Date: Thu, 27 Jun 2019 11:22:18 +0200
From: Daniel Vetter <daniel@ffwll.ch>
To: Thomas Zimmermann <tzimmermann@suse.de>
Subject: Re: [PATCH] drm/mgag200: Replace struct mga_framebuffer with GEM
 framebuffer helpers
Message-ID: <20190627092218.GJ12905@phenom.ffwll.local>
References: <20190627080909.30471-1-tzimmermann@suse.de>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <20190627080909.30471-1-tzimmermann@suse.de>
X-Operating-System: Linux phenom 4.19.0-5-amd64 
User-Agent: Mutt/1.10.1 (2018-07-13)
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ffwll.ch; s=google;
 h=sender:date:from:to:cc:subject:message-id:references:mime-version
 :content-disposition:in-reply-to:user-agent;
 bh=W1VyEWelcKzfJIC5kPqQ6AXBeo82tyom3uADEJcmG+s=;
 b=V56eDmtq/3ipizBptcOLzmV8H/7SzE/Csj50u9kYu/jFd1obFVD3WJZJum05vBIy0B
 YD/8MsgC8uhwO9cjDUaYE1WA1m6SWNIVGJVXgOlaV1YxAX49YlDquF1birMMnFN+G217
 96eUDMjDM8sA093Ju0I6NEtizuubUIiI/x1FA=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: maxime.ripard@bootlin.com, sam@ravnborg.org,
 dri-devel@lists.freedesktop.org, kraxel@redhat.com, airlied@redhat.com,
 sean@poorly.run
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gVGh1LCBKdW4gMjcsIDIwMTkgYXQgMTA6MDk6MDlBTSArMDIwMCwgVGhvbWFzIFppbW1lcm1h
bm4gd3JvdGU6Cj4gVGhlIG1nYWcyMDAgZHJpdmVyJ3Mgc3RydWN0IG1nYV9mcmFtZWJ1ZmZlciBp
cyBhIGJ1ZmZlciBvYmplY3Qgd2l0aCBHRU0KPiBpbnRlcmZhY2UuIFRoZXJlIGFyZSBhbHJlYWR5
IEdFTSBmcmFtZWJ1ZmZlciBoZWxwZXJzIHRoYXQgaW1wbGVtZW50IHRoZQo+IHNhbWUgZnVuY3Rp
b25hbGl0eS4gQ29udmVydCBtZ2FnMjAwIHRvIHRoZXNlLgo+IAo+IFNpZ25lZC1vZmYtYnk6IFRo
b21hcyBaaW1tZXJtYW5uIDx0emltbWVybWFubkBzdXNlLmRlPgo+IC0tLQo+ICBkcml2ZXJzL2dw
dS9kcm0vbWdhZzIwMC9tZ2FnMjAwX2Rydi5oICB8IDEzIC0tLS0tLQo+ICBkcml2ZXJzL2dwdS9k
cm0vbWdhZzIwMC9tZ2FnMjAwX2ZiLmMgICB8IDQxICsrKysrKystLS0tLS0tLS0tCj4gIGRyaXZl
cnMvZ3B1L2RybS9tZ2FnMjAwL21nYWcyMDBfbWFpbi5jIHwgNjEgKy0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0KPiAgZHJpdmVycy9ncHUvZHJtL21nYWcyMDAvbWdhZzIwMF9tb2RlLmMgfCAyMiAr
KysrLS0tLS0tCj4gIDQgZmlsZXMgY2hhbmdlZCwgMjYgaW5zZXJ0aW9ucygrKSwgMTExIGRlbGV0
aW9ucygtKQo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbWdhZzIwMC9tZ2FnMjAw
X2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL21nYWcyMDAvbWdhZzIwMF9kcnYuaAo+IGluZGV4IGM0
NzY3MWNlNmM0OC4uMzY4NjI4MjRiNTY3IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9t
Z2FnMjAwL21nYWcyMDBfZHJ2LmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vbWdhZzIwMC9tZ2Fn
MjAwX2Rydi5oCj4gQEAgLTEwMCwxNiArMTAwLDkgQEAKPiAgI2RlZmluZSB0b19tZ2FfY3J0Yyh4
KSBjb250YWluZXJfb2YoeCwgc3RydWN0IG1nYV9jcnRjLCBiYXNlKQo+ICAjZGVmaW5lIHRvX21n
YV9lbmNvZGVyKHgpIGNvbnRhaW5lcl9vZih4LCBzdHJ1Y3QgbWdhX2VuY29kZXIsIGJhc2UpCj4g
ICNkZWZpbmUgdG9fbWdhX2Nvbm5lY3Rvcih4KSBjb250YWluZXJfb2YoeCwgc3RydWN0IG1nYV9j
b25uZWN0b3IsIGJhc2UpCj4gLSNkZWZpbmUgdG9fbWdhX2ZyYW1lYnVmZmVyKHgpIGNvbnRhaW5l
cl9vZih4LCBzdHJ1Y3QgbWdhX2ZyYW1lYnVmZmVyLCBiYXNlKQo+IC0KPiAtc3RydWN0IG1nYV9m
cmFtZWJ1ZmZlciB7Cj4gLQlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyIGJhc2U7Cj4gLQlzdHJ1Y3Qg
ZHJtX2dlbV9vYmplY3QgKm9iajsKClllYWggd2UgbW92ZWQgdGhlIG9iaiBwb2ludGVyIHRvIGRy
bV9mYiBhIGxvbmcgdGltZSBhZ28uIEFsdGhvdWdoIGFmdGVyCm1nYTIwMGcgd2FzIG1lcmdlZC4K
CkFja2VkLWJ5OiBEYW5pZWwgVmV0dGVyIDxkYW5pZWwudmV0dGVyQGZmd2xsLmNoPgo+IC19Owo+
ICAKPiAgc3RydWN0IG1nYV9mYmRldiB7Cj4gIAlzdHJ1Y3QgZHJtX2ZiX2hlbHBlciBoZWxwZXI7
IC8qIG11c3QgYmUgZmlyc3QgKi8KPiAtCXN0cnVjdCBtZ2FfZnJhbWVidWZmZXIgbWZiOwo+ICAJ
dm9pZCAqc3lzcmFtOwo+ICAJaW50IHNpemU7Cj4gIAlpbnQgeDEsIHkxLCB4MiwgeTI7IC8qIGRp
cnR5IHJlY3QgKi8KPiBAQCAtMjE1LDEyICsyMDgsNiBAQCBpbnQgbWdhZzIwMF9mYmRldl9pbml0
KHN0cnVjdCBtZ2FfZGV2aWNlICptZGV2KTsKPiAgdm9pZCBtZ2FnMjAwX2ZiZGV2X2Zpbmkoc3Ry
dWN0IG1nYV9kZXZpY2UgKm1kZXYpOwo+ICAKPiAgCQkJCS8qIG1nYWcyMDBfbWFpbi5jICovCj4g
LWludCBtZ2FnMjAwX2ZyYW1lYnVmZmVyX2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAt
CQkJICAgICBzdHJ1Y3QgbWdhX2ZyYW1lYnVmZmVyICptZmIsCj4gLQkJCSAgICAgY29uc3Qgc3Ry
dWN0IGRybV9tb2RlX2ZiX2NtZDIgKm1vZGVfY21kLAo+IC0JCQkgICAgIHN0cnVjdCBkcm1fZ2Vt
X29iamVjdCAqb2JqKTsKPiAtCj4gLQo+ICBpbnQgbWdhZzIwMF9kcml2ZXJfbG9hZChzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2LCB1bnNpZ25lZCBsb25nIGZsYWdzKTsKPiAgdm9pZCBtZ2FnMjAwX2Ry
aXZlcl91bmxvYWQoc3RydWN0IGRybV9kZXZpY2UgKmRldik7Cj4gIGludCBtZ2FnMjAwX2dlbV9j
cmVhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL21nYWcyMDAvbWdhZzIwMF9mYi5jIGIvZHJpdmVycy9ncHUvZHJtL21nYWcyMDAvbWdhZzIw
MF9mYi5jCj4gaW5kZXggOGFkYjMzMjI4NzMyLi5lMDJkNTQ3OWVhNDYgMTAwNjQ0Cj4gLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL21nYWcyMDAvbWdhZzIwMF9mYi5jCj4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL21nYWcyMDAvbWdhZzIwMF9mYi5jCj4gQEAgLTExLDYgKzExLDcgQEAKPiAgI2luY2x1ZGUg
PGRybS9kcm1QLmg+Cj4gICNpbmNsdWRlIDxkcm0vZHJtX3V0aWwuaD4KPiAgI2luY2x1ZGUgPGRy
bS9kcm1fZmJfaGVscGVyLmg+Cj4gKyNpbmNsdWRlIDxkcm0vZHJtX2dlbV9mcmFtZWJ1ZmZlcl9o
ZWxwZXIuaD4KPiAgI2luY2x1ZGUgPGRybS9kcm1fY3J0Y19oZWxwZXIuaD4KPiAgCj4gICNpbmNs
dWRlICJtZ2FnMjAwX2Rydi5oIgo+IEBAIC0xOSwxOSArMjAsMTggQEAgc3RhdGljIHZvaWQgbWdh
X2RpcnR5X3VwZGF0ZShzdHJ1Y3QgbWdhX2ZiZGV2ICptZmJkZXYsCj4gIAkJCSAgICAgaW50IHgs
IGludCB5LCBpbnQgd2lkdGgsIGludCBoZWlnaHQpCj4gIHsKPiAgCWludCBpOwo+IC0Jc3RydWN0
IGRybV9nZW1fb2JqZWN0ICpvYmo7Cj4gIAlzdHJ1Y3QgZHJtX2dlbV92cmFtX29iamVjdCAqZ2Jv
Owo+ICAJaW50IHNyY19vZmZzZXQsIGRzdF9vZmZzZXQ7Cj4gLQlpbnQgYnBwID0gbWZiZGV2LT5t
ZmIuYmFzZS5mb3JtYXQtPmNwcFswXTsKPiAgCWludCByZXQ7Cj4gIAl1OCAqZHN0Owo+ICAJYm9v
bCB1bm1hcCA9IGZhbHNlOwo+ICAJYm9vbCBzdG9yZV9mb3JfbGF0ZXIgPSBmYWxzZTsKPiAgCWlu
dCB4MiwgeTI7Cj4gIAl1bnNpZ25lZCBsb25nIGZsYWdzOwo+ICsJc3RydWN0IGRybV9mcmFtZWJ1
ZmZlciAqZmIgPSBtZmJkZXYtPmhlbHBlci5mYjsKPiArCWludCBicHAgPSBmYi0+Zm9ybWF0LT5j
cHBbMF07Cj4gIAo+IC0Jb2JqID0gbWZiZGV2LT5tZmIub2JqOwo+IC0JZ2JvID0gZHJtX2dlbV92
cmFtX29mX2dlbShvYmopOwo+ICsJZ2JvID0gZHJtX2dlbV92cmFtX29mX2dlbShmYi0+b2JqWzBd
KTsKPiAgCj4gIAlpZiAoZHJtX2Nhbl9zbGVlcCgpKSB7Cj4gIAkJLyogV2UgcGluIHRoZSBCTyBz
byBpdCB3b24ndCBiZSBtb3ZlZCBkdXJpbmcgdGhlCj4gQEAgLTg5LDggKzg5LDcgQEAgc3RhdGlj
IHZvaWQgbWdhX2RpcnR5X3VwZGF0ZShzdHJ1Y3QgbWdhX2ZiZGV2ICptZmJkZXYsCj4gIAo+ICAJ
Zm9yIChpID0geTsgaSA8PSB5MjsgaSsrKSB7Cj4gIAkJLyogYXNzdW1lIGVxdWFsIHN0cmlkZSBm
b3Igbm93ICovCj4gLQkJc3JjX29mZnNldCA9IGRzdF9vZmZzZXQgPQo+IC0JCQlpICogbWZiZGV2
LT5tZmIuYmFzZS5waXRjaGVzWzBdICsgKHggKiBicHApOwo+ICsJCXNyY19vZmZzZXQgPSBkc3Rf
b2Zmc2V0ID0gaSAqIGZiLT5waXRjaGVzWzBdICsgKHggKiBicHApOwo+ICAJCW1lbWNweV90b2lv
KGRzdCArIGRzdF9vZmZzZXQsIG1mYmRldi0+c3lzcmFtICsgc3JjX29mZnNldCwKPiAgCQkJICAg
ICh4MiAtIHggKyAxKSAqIGJwcCk7Cj4gIAl9Cj4gQEAgLTE5MiwyNCArMTkxLDI0IEBAIHN0YXRp
YyBpbnQgbWdhZzIwMGZiX2NyZWF0ZShzdHJ1Y3QgZHJtX2ZiX2hlbHBlciAqaGVscGVyLAo+ICAJ
c3lzcmFtID0gdm1hbGxvYyhzaXplKTsKPiAgCWlmICghc3lzcmFtKSB7Cj4gIAkJcmV0ID0gLUVO
T01FTTsKPiAtCQlnb3RvIGVycl9zeXNyYW07Cj4gKwkJZ290byBlcnJfZHJtX2dlbV9vYmplY3Rf
cHV0X3VubG9ja2VkOwo+ICAJfQo+ICAKPiAgCWluZm8gPSBkcm1fZmJfaGVscGVyX2FsbG9jX2Zi
aShoZWxwZXIpOwo+ICAJaWYgKElTX0VSUihpbmZvKSkgewo+ICAJCXJldCA9IFBUUl9FUlIoaW5m
byk7Cj4gLQkJZ290byBlcnJfYWxsb2NfZmJpOwo+ICsJCWdvdG8gZXJyX3ZmcmVlOwo+ICAJfQo+
ICAKPiAtCXJldCA9IG1nYWcyMDBfZnJhbWVidWZmZXJfaW5pdChkZXYsICZtZmJkZXYtPm1mYiwg
Jm1vZGVfY21kLCBnb2JqKTsKPiAtCWlmIChyZXQpCj4gLQkJZ290byBlcnJfYWxsb2NfZmJpOwo+
ICsJZmIgPSBkcm1fZ2VtX2ZiZGV2X2ZiX2NyZWF0ZShkZXYsIHNpemVzLCAwLCBnb2JqLCBOVUxM
KTsKPiArCWlmIChJU19FUlIoZmIpKSB7Cj4gKwkJcmV0ID0gUFRSX0VSUihmYik7Cj4gKwkJZ290
byBlcnJfdmZyZWU7Cj4gKwl9Cj4gIAo+ICAJbWZiZGV2LT5zeXNyYW0gPSBzeXNyYW07Cj4gIAlt
ZmJkZXYtPnNpemUgPSBzaXplOwo+ICAKPiAtCWZiID0gJm1mYmRldi0+bWZiLmJhc2U7Cj4gLQo+
ICAJLyogc2V0dXAgaGVscGVyICovCj4gIAltZmJkZXYtPmhlbHBlci5mYiA9IGZiOwo+ICAKPiBA
QCAtMjMwLDI5ICsyMjksMjEgQEAgc3RhdGljIGludCBtZ2FnMjAwZmJfY3JlYXRlKHN0cnVjdCBk
cm1fZmJfaGVscGVyICpoZWxwZXIsCj4gIAo+ICAJcmV0dXJuIDA7Cj4gIAo+IC1lcnJfYWxsb2Nf
ZmJpOgo+ICtlcnJfdmZyZWU6Cj4gIAl2ZnJlZShzeXNyYW0pOwo+IC1lcnJfc3lzcmFtOgo+ICtl
cnJfZHJtX2dlbV9vYmplY3RfcHV0X3VubG9ja2VkOgo+ICAJZHJtX2dlbV9vYmplY3RfcHV0X3Vu
bG9ja2VkKGdvYmopOwo+IC0KPiAgCXJldHVybiByZXQ7Cj4gIH0KPiAgCj4gIHN0YXRpYyBpbnQg
bWdhX2ZiZGV2X2Rlc3Ryb3koc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAgCQkJCXN0cnVjdCBt
Z2FfZmJkZXYgKm1mYmRldikKPiAgewo+IC0Jc3RydWN0IG1nYV9mcmFtZWJ1ZmZlciAqbWZiID0g
Jm1mYmRldi0+bWZiOwo+IC0KPiAgCWRybV9mYl9oZWxwZXJfdW5yZWdpc3Rlcl9mYmkoJm1mYmRl
di0+aGVscGVyKTsKPiAtCj4gLQlpZiAobWZiLT5vYmopIHsKPiAtCQlkcm1fZ2VtX29iamVjdF9w
dXRfdW5sb2NrZWQobWZiLT5vYmopOwo+IC0JCW1mYi0+b2JqID0gTlVMTDsKPiAtCX0KPiAgCWRy
bV9mYl9oZWxwZXJfZmluaSgmbWZiZGV2LT5oZWxwZXIpOwo+ICsJZHJtX2ZyYW1lYnVmZmVyX3B1
dChtZmJkZXYtPmhlbHBlci5mYik7Cj4gKwo+ICAJdmZyZWUobWZiZGV2LT5zeXNyYW0pOwo+IC0J
ZHJtX2ZyYW1lYnVmZmVyX3VucmVnaXN0ZXJfcHJpdmF0ZSgmbWZiLT5iYXNlKTsKPiAtCWRybV9m
cmFtZWJ1ZmZlcl9jbGVhbnVwKCZtZmItPmJhc2UpOwo+ICAKPiAgCXJldHVybiAwOwo+ICB9Cj4g
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9tZ2FnMjAwL21nYWcyMDBfbWFpbi5jIGIvZHJp
dmVycy9ncHUvZHJtL21nYWcyMDAvbWdhZzIwMF9tYWluLmMKPiBpbmRleCBkZDYxY2NjNWFmNWMu
LjQ5MzZmYjhiNjhlZCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vbWdhZzIwMC9tZ2Fn
MjAwX21haW4uYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9tZ2FnMjAwL21nYWcyMDBfbWFpbi5j
Cj4gQEAgLTksNjggKzksMTEgQEAKPiAgICovCj4gICNpbmNsdWRlIDxkcm0vZHJtUC5oPgo+ICAj
aW5jbHVkZSA8ZHJtL2RybV9jcnRjX2hlbHBlci5oPgo+ICsjaW5jbHVkZSA8ZHJtL2RybV9nZW1f
ZnJhbWVidWZmZXJfaGVscGVyLmg+Cj4gICNpbmNsdWRlICJtZ2FnMjAwX2Rydi5oIgo+ICAKPiAt
c3RhdGljIHZvaWQgbWdhX3VzZXJfZnJhbWVidWZmZXJfZGVzdHJveShzdHJ1Y3QgZHJtX2ZyYW1l
YnVmZmVyICpmYikKPiAtewo+IC0Jc3RydWN0IG1nYV9mcmFtZWJ1ZmZlciAqbWdhX2ZiID0gdG9f
bWdhX2ZyYW1lYnVmZmVyKGZiKTsKPiAtCj4gLQlkcm1fZ2VtX29iamVjdF9wdXRfdW5sb2NrZWQo
bWdhX2ZiLT5vYmopOwo+IC0JZHJtX2ZyYW1lYnVmZmVyX2NsZWFudXAoZmIpOwo+IC0Ja2ZyZWUo
ZmIpOwo+IC19Cj4gLQo+IC1zdGF0aWMgY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlcl9mdW5j
cyBtZ2FfZmJfZnVuY3MgPSB7Cj4gLQkuZGVzdHJveSA9IG1nYV91c2VyX2ZyYW1lYnVmZmVyX2Rl
c3Ryb3ksCj4gLX07Cj4gLQo+IC1pbnQgbWdhZzIwMF9mcmFtZWJ1ZmZlcl9pbml0KHN0cnVjdCBk
cm1fZGV2aWNlICpkZXYsCj4gLQkJCSAgICAgc3RydWN0IG1nYV9mcmFtZWJ1ZmZlciAqZ2ZiLAo+
IC0JCQkgICAgIGNvbnN0IHN0cnVjdCBkcm1fbW9kZV9mYl9jbWQyICptb2RlX2NtZCwKPiAtCQkJ
ICAgICBzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iaikKPiAtewo+IC0JaW50IHJldDsKPiAtCj4g
LQlkcm1faGVscGVyX21vZGVfZmlsbF9mYl9zdHJ1Y3QoZGV2LCAmZ2ZiLT5iYXNlLCBtb2RlX2Nt
ZCk7Cj4gLQlnZmItPm9iaiA9IG9iajsKPiAtCXJldCA9IGRybV9mcmFtZWJ1ZmZlcl9pbml0KGRl
diwgJmdmYi0+YmFzZSwgJm1nYV9mYl9mdW5jcyk7Cj4gLQlpZiAocmV0KSB7Cj4gLQkJRFJNX0VS
Uk9SKCJkcm1fZnJhbWVidWZmZXJfaW5pdCBmYWlsZWQ6ICVkXG4iLCByZXQpOwo+IC0JCXJldHVy
biByZXQ7Cj4gLQl9Cj4gLQlyZXR1cm4gMDsKPiAtfQo+IC0KPiAtc3RhdGljIHN0cnVjdCBkcm1f
ZnJhbWVidWZmZXIgKgo+IC1tZ2FnMjAwX3VzZXJfZnJhbWVidWZmZXJfY3JlYXRlKHN0cnVjdCBk
cm1fZGV2aWNlICpkZXYsCj4gLQkJCQlzdHJ1Y3QgZHJtX2ZpbGUgKmZpbHAsCj4gLQkJCQljb25z
dCBzdHJ1Y3QgZHJtX21vZGVfZmJfY21kMiAqbW9kZV9jbWQpCj4gLXsKPiAtCXN0cnVjdCBkcm1f
Z2VtX29iamVjdCAqb2JqOwo+IC0Jc3RydWN0IG1nYV9mcmFtZWJ1ZmZlciAqbWdhX2ZiOwo+IC0J
aW50IHJldDsKPiAtCj4gLQlvYmogPSBkcm1fZ2VtX29iamVjdF9sb29rdXAoZmlscCwgbW9kZV9j
bWQtPmhhbmRsZXNbMF0pOwo+IC0JaWYgKG9iaiA9PSBOVUxMKQo+IC0JCXJldHVybiBFUlJfUFRS
KC1FTk9FTlQpOwo+IC0KPiAtCW1nYV9mYiA9IGt6YWxsb2Moc2l6ZW9mKCptZ2FfZmIpLCBHRlBf
S0VSTkVMKTsKPiAtCWlmICghbWdhX2ZiKSB7Cj4gLQkJZHJtX2dlbV9vYmplY3RfcHV0X3VubG9j
a2VkKG9iaik7Cj4gLQkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7Cj4gLQl9Cj4gLQo+IC0JcmV0
ID0gbWdhZzIwMF9mcmFtZWJ1ZmZlcl9pbml0KGRldiwgbWdhX2ZiLCBtb2RlX2NtZCwgb2JqKTsK
PiAtCWlmIChyZXQpIHsKPiAtCQlkcm1fZ2VtX29iamVjdF9wdXRfdW5sb2NrZWQob2JqKTsKPiAt
CQlrZnJlZShtZ2FfZmIpOwo+IC0JCXJldHVybiBFUlJfUFRSKHJldCk7Cj4gLQl9Cj4gLQlyZXR1
cm4gJm1nYV9mYi0+YmFzZTsKPiAtfQo+IC0KPiAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fbW9k
ZV9jb25maWdfZnVuY3MgbWdhX21vZGVfZnVuY3MgPSB7Cj4gLQkuZmJfY3JlYXRlID0gbWdhZzIw
MF91c2VyX2ZyYW1lYnVmZmVyX2NyZWF0ZSwKPiArCS5mYl9jcmVhdGUgPSBkcm1fZ2VtX2ZiX2Ny
ZWF0ZQo+ICB9Owo+ICAKPiAgc3RhdGljIGludCBtZ2FfcHJvYmVfdnJhbShzdHJ1Y3QgbWdhX2Rl
dmljZSAqbWRldiwgdm9pZCBfX2lvbWVtICptZW0pCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9tZ2FnMjAwL21nYWcyMDBfbW9kZS5jIGIvZHJpdmVycy9ncHUvZHJtL21nYWcyMDAvbWdh
ZzIwMF9tb2RlLmMKPiBpbmRleCBhMjUwNTQwMTVlOGMuLjVlMzgyYmY3ZmMxZSAxMDA2NDQKPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vbWdhZzIwMC9tZ2FnMjAwX21vZGUuYwo+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9tZ2FnMjAwL21nYWcyMDBfbW9kZS5jCj4gQEAgLTg2MCwyNyArODYwLDIxIEBA
IHN0YXRpYyBpbnQgbWdhX2NydGNfZG9fc2V0X2Jhc2Uoc3RydWN0IGRybV9jcnRjICpjcnRjLAo+
ICAJCQkJaW50IHgsIGludCB5LCBpbnQgYXRvbWljKQo+ICB7Cj4gIAlzdHJ1Y3QgbWdhX2Rldmlj
ZSAqbWRldiA9IGNydGMtPmRldi0+ZGV2X3ByaXZhdGU7Cj4gLQlzdHJ1Y3QgZHJtX2dlbV9vYmpl
Y3QgKm9iajsKPiAtCXN0cnVjdCBtZ2FfZnJhbWVidWZmZXIgKm1nYV9mYjsKPiAgCXN0cnVjdCBk
cm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm87Cj4gIAlpbnQgcmV0Owo+ICAJczY0IGdwdV9hZGRyOwo+
ICAJdm9pZCAqYmFzZTsKPiAgCj4gIAlpZiAoIWF0b21pYyAmJiBmYikgewo+IC0JCW1nYV9mYiA9
IHRvX21nYV9mcmFtZWJ1ZmZlcihmYik7Cj4gLQkJb2JqID0gbWdhX2ZiLT5vYmo7Cj4gLQkJZ2Jv
ID0gZHJtX2dlbV92cmFtX29mX2dlbShvYmopOwo+ICsJCWdibyA9IGRybV9nZW1fdnJhbV9vZl9n
ZW0oZmItPm9ialswXSk7Cj4gIAo+ICAJCS8qIHVubWFwIGlmIGNvbnNvbGUgKi8KPiAtCQlpZiAo
Jm1kZXYtPm1mYmRldi0+bWZiID09IG1nYV9mYikKPiArCQlpZiAobWRldi0+bWZiZGV2LT5oZWxw
ZXIuZmIgPT0gZmIpCj4gIAkJCWRybV9nZW1fdnJhbV9rdW5tYXAoZ2JvKTsKPiAgCQlkcm1fZ2Vt
X3ZyYW1fdW5waW4oZ2JvKTsKPiAgCX0KPiAgCj4gLQltZ2FfZmIgPSB0b19tZ2FfZnJhbWVidWZm
ZXIoY3J0Yy0+cHJpbWFyeS0+ZmIpOwo+IC0Jb2JqID0gbWdhX2ZiLT5vYmo7Cj4gLQlnYm8gPSBk
cm1fZ2VtX3ZyYW1fb2ZfZ2VtKG9iaik7Cj4gKwlnYm8gPSBkcm1fZ2VtX3ZyYW1fb2ZfZ2VtKGNy
dGMtPnByaW1hcnktPmZiLT5vYmpbMF0pOwo+ICAKPiAgCXJldCA9IGRybV9nZW1fdnJhbV9waW4o
Z2JvLCBEUk1fR0VNX1ZSQU1fUExfRkxBR19WUkFNKTsKPiAgCWlmIChyZXQpCj4gQEAgLTg5MSw3
ICs4ODUsNyBAQCBzdGF0aWMgaW50IG1nYV9jcnRjX2RvX3NldF9iYXNlKHN0cnVjdCBkcm1fY3J0
YyAqY3J0YywKPiAgCQlnb3RvIGVycl9kcm1fZ2VtX3ZyYW1fdW5waW47Cj4gIAl9Cj4gIAo+IC0J
aWYgKCZtZGV2LT5tZmJkZXYtPm1mYiA9PSBtZ2FfZmIpIHsKPiArCWlmIChtZGV2LT5tZmJkZXYt
PmhlbHBlci5mYiA9PSBjcnRjLT5wcmltYXJ5LT5mYikgewo+ICAJCS8qIGlmIHB1c2hpbmcgY29u
c29sZSBpbiBrbWFwIGl0ICovCj4gIAkJYmFzZSA9IGRybV9nZW1fdnJhbV9rbWFwKGdibywgdHJ1
ZSwgTlVMTCk7Cj4gIAkJaWYgKElTX0VSUihiYXNlKSkgewo+IEBAIC0xNDI0LDEyICsxNDE4LDEy
IEBAIHN0YXRpYyB2b2lkIG1nYV9jcnRjX2Rpc2FibGUoc3RydWN0IGRybV9jcnRjICpjcnRjKQo+
ICAJbWdhX2NydGNfZHBtcyhjcnRjLCBEUk1fTU9ERV9EUE1TX09GRik7Cj4gIAlpZiAoY3J0Yy0+
cHJpbWFyeS0+ZmIpIHsKPiAgCQlzdHJ1Y3QgbWdhX2RldmljZSAqbWRldiA9IGNydGMtPmRldi0+
ZGV2X3ByaXZhdGU7Cj4gLQkJc3RydWN0IG1nYV9mcmFtZWJ1ZmZlciAqbWdhX2ZiID0gdG9fbWdh
X2ZyYW1lYnVmZmVyKGNydGMtPnByaW1hcnktPmZiKTsKPiAtCQlzdHJ1Y3QgZHJtX2dlbV9vYmpl
Y3QgKm9iaiA9IG1nYV9mYi0+b2JqOwo+IC0JCXN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpn
Ym8gPSBkcm1fZ2VtX3ZyYW1fb2ZfZ2VtKG9iaik7Cj4gKwkJc3RydWN0IGRybV9mcmFtZWJ1ZmZl
ciAqZmIgPSBjcnRjLT5wcmltYXJ5LT5mYjsKPiArCQlzdHJ1Y3QgZHJtX2dlbV92cmFtX29iamVj
dCAqZ2JvID0KPiArCQkJZHJtX2dlbV92cmFtX29mX2dlbShmYi0+b2JqWzBdKTsKPiAgCj4gIAkJ
LyogdW5tYXAgaWYgY29uc29sZSAqLwo+IC0JCWlmICgmbWRldi0+bWZiZGV2LT5tZmIgPT0gbWdh
X2ZiKQo+ICsJCWlmIChtZGV2LT5tZmJkZXYtPmhlbHBlci5mYiA9PSBmYikKPiAgCQkJZHJtX2dl
bV92cmFtX2t1bm1hcChnYm8pOwo+ICAJCWRybV9nZW1fdnJhbV91bnBpbihnYm8pOwo+ICAJfQo+
IC0tIAo+IDIuMjEuMAo+IAoKLS0gCkRhbmllbCBWZXR0ZXIKU29mdHdhcmUgRW5naW5lZXIsIElu
dGVsIENvcnBvcmF0aW9uCmh0dHA6Ly9ibG9nLmZmd2xsLmNoCl9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRl
dmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9t
YWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
