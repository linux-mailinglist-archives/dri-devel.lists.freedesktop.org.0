Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 0CA95C002D
	for <lists+dri-devel@lfdr.de>; Fri, 27 Sep 2019 09:41:28 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7CCC16EE8D;
	Fri, 27 Sep 2019 07:41:11 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from Galois.linutronix.de (Galois.linutronix.de
 [IPv6:2a0a:51c0:0:12e:550::1])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 54C306ECD2;
 Thu, 26 Sep 2019 10:56:57 +0000 (UTC)
Received: from localhost ([127.0.0.1] helo=flow.W.breakpoint.cc)
 by Galois.linutronix.de with esmtp (Exim 4.80)
 (envelope-from <bigeasy@linutronix.de>)
 id 1iDRS6-0004T8-CU; Thu, 26 Sep 2019 12:56:50 +0200
From: Sebastian Andrzej Siewior <bigeasy@linutronix.de>
To: intel-gfx@lists.freedesktop.org
Subject: [PATCH 1/2] drm/i915: Don't disable interrupts for
 intel_engine_breadcrumbs_irq()
Date: Thu, 26 Sep 2019 12:56:43 +0200
Message-Id: <20190926105644.16703-2-bigeasy@linutronix.de>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190926105644.16703-1-bigeasy@linutronix.de>
References: <20190926105644.16703-1-bigeasy@linutronix.de>
MIME-Version: 1.0
X-Mailman-Approved-At: Fri, 27 Sep 2019 07:40:57 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: David Airlie <airlied@linux.ie>,
 Sebastian Andrzej Siewior <bigeasy@linutronix.de>,
 Clark Williams <williams@redhat.com>, dri-devel@lists.freedesktop.org,
 Rodrigo Vivi <rodrigo.vivi@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIGZ1bmN0aW9uIGludGVsX2VuZ2luZV9icmVhZGNydW1ic19pcnEoKSBpcyBhbHdheXMgaW52
b2tlZCBmcm9tIGFuIGludGVycnVwdApoYW5kbGVyIGFuZCBmb3IgdGhhdCByZWFzb24gaXQgaW52
b2tlcyAoYXMgYW4gb3B0aW1pc2F0aW9uKSBvbmx5IHNwaW5fbG9jaygpCmZvciBsb2NraW5nIGFz
c3VtaW5nIHRoYXQgdGhlIGludGVycnVwdHMgYXJlIGFscmVhZHkgZGlzYWJsZWQuIFRoZQpmdW5j
dGlvbiBpbnRlbF9lbmdpbmVfc2lnbmFsX2JyZWFkY3J1bWJzKCkgaXMgcHJvdmlkZWQgdG8gZGlz
YWJsZQppbnRlcnJ1cHRzIHdoaWxlIHRoZSBmb3JtZXIgZnVuY3Rpb24gaXMgaW52b2tlZCBzbyB0
aGF0IGFzc3VtcHRpb24gaXMKYWxzbyB0cnVlIGZvciBjYWxsZXJzIGZyb20gcHJlZW1wdGlibGUg
Y29udGV4dC4KCk9uIFBSRUVNUFRfUlQgbG9jYWxfaXJxX2Rpc2FibGUoKSByZWFsbHkgZGlzYWJs
ZXMgaW50ZXJydXB0cyBhbmQgdGhpcwpmb3JiaWRzIHRvIGludm9rZSBzcGluX2xvY2soKSB3aGlj
aCBiZWNvbWVzIGEgc2xlZXBpbmcgc3BpbmxvY2suCgpUaGlzIGlzIGFsc28gcHJvYmxlbWF0aWMg
d2l0aCBgdGhyZWFkaXJxcycgaW4gY29uanVuY3Rpb24gd2l0aAppcnFfd29yay4gV2l0aCBmb3Jj
ZSB0aHJlYWRpbmcgdGhlIGludGVycnVwdCBoYW5kbGVyLCB0aGUgaGFuZGxlciBpcwppbnZva2Vk
IHdpdGggZGlzYWJsZWQgQkggYnV0IHdpdGggaW50ZXJydXB0cyBlbmFibGVkLiBUaGlzIGlzIG9r
YXkgYW5kCnRoZSBsb2NrIGl0c2VsZiBpcyBuZXZlciBhY3F1aXJlZCBpbiBJUlEgY29udGV4dC4g
VGhpcyBjaGFuZ2VzIHdpdGgKaXJxX3dvcmsgKHNpZ25hbF9pcnFfd29yaygpKSB3aGljaCBfc3Rp
bGxfIGludm9rZXMKaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJzX2lycSgpIGZyb20gSVJRIGNvbnRl
eHQuIExvY2tkZXAgc2hvdWxkIHNlZSB0aGlzCmFuZCBjb21wbGFpbi4KCkFjcXVpcmUgdGhlIGxv
Y2tzIGluIGludGVsX2VuZ2luZV9icmVhZGNydW1ic19pcnEoKSB3aXRoIF9pcnFzYXZlKCkKc3Vm
Zml4IGFuZCBsZXQgYWxsIGNhbGxlcnMgaW52b2tlIGludGVsX2VuZ2luZV9icmVhZGNydW1ic19p
cnEoKQpkaXJlY3RseSBpbnN0ZWFkIHVzaW5nIGludGVsX2VuZ2luZV9zaWduYWxfYnJlYWRjcnVt
YnMoKS4KClJlcG9ydGVkLWJ5OiBDbGFyayBXaWxsaWFtcyA8d2lsbGlhbXNAcmVkaGF0LmNvbT4K
U2lnbmVkLW9mZi1ieTogU2ViYXN0aWFuIEFuZHJ6ZWogU2lld2lvciA8YmlnZWFzeUBsaW51dHJv
bml4LmRlPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2JyZWFkY3J1bWJzLmMg
fCAxNiArKysrKy0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdp
bmUuaCAgICAgIHwgIDEgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfaGFuZ2NoZWNr
LmMgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jICAgICAg
IHwgIDIgKy0KIDQgZmlsZXMgY2hhbmdlZCwgNyBpbnNlcnRpb25zKCspLCAxNCBkZWxldGlvbnMo
LSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9icmVhZGNydW1i
cy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfYnJlYWRjcnVtYnMuYwppbmRleCAw
OWM2OGRkYTIwOTg4Li5mNzUwMzc1MDU2ZGU0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9icmVhZGNydW1icy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2JyZWFkY3J1bWJzLmMKQEAgLTEzNCw5ICsxMzQsMTAgQEAgdm9pZCBpbnRlbF9lbmdp
bmVfYnJlYWRjcnVtYnNfaXJxKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAljb25z
dCBrdGltZV90IHRpbWVzdGFtcCA9IGt0aW1lX2dldCgpOwogCXN0cnVjdCBpbnRlbF9jb250ZXh0
ICpjZSwgKmNuOwogCXN0cnVjdCBsaXN0X2hlYWQgKnBvcywgKm5leHQ7CisJdW5zaWduZWQgbG9u
ZyBmbGFnczsKIAlMSVNUX0hFQUQoc2lnbmFsKTsKIAotCXNwaW5fbG9jaygmYi0+aXJxX2xvY2sp
OworCXNwaW5fbG9ja19pcnFzYXZlKCZiLT5pcnFfbG9jaywgZmxhZ3MpOwogCiAJaWYgKGItPmly
cV9hcm1lZCAmJiBsaXN0X2VtcHR5KCZiLT5zaWduYWxlcnMpKQogCQlfX2ludGVsX2JyZWFkY3J1
bWJzX2Rpc2FybV9pcnEoYik7CkBAIC0xODIsMzAgKzE4MywyMyBAQCB2b2lkIGludGVsX2VuZ2lu
ZV9icmVhZGNydW1ic19pcnEoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQl9CiAJ
fQogCi0Jc3Bpbl91bmxvY2soJmItPmlycV9sb2NrKTsKKwlzcGluX3VubG9ja19pcnFyZXN0b3Jl
KCZiLT5pcnFfbG9jaywgZmxhZ3MpOwogCiAJbGlzdF9mb3JfZWFjaF9zYWZlKHBvcywgbmV4dCwg
JnNpZ25hbCkgewogCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSA9CiAJCQlsaXN0X2VudHJ5KHBv
cywgdHlwZW9mKCpycSksIHNpZ25hbF9saW5rKTsKIAkJc3RydWN0IGxpc3RfaGVhZCBjYl9saXN0
OwogCi0JCXNwaW5fbG9jaygmcnEtPmxvY2spOworCQlzcGluX2xvY2tfaXJxc2F2ZSgmcnEtPmxv
Y2ssIGZsYWdzKTsKIAkJbGlzdF9yZXBsYWNlKCZycS0+ZmVuY2UuY2JfbGlzdCwgJmNiX2xpc3Qp
OwogCQlfX2RtYV9mZW5jZV9zaWduYWxfX3RpbWVzdGFtcCgmcnEtPmZlbmNlLCB0aW1lc3RhbXAp
OwogCQlfX2RtYV9mZW5jZV9zaWduYWxfX25vdGlmeSgmcnEtPmZlbmNlLCAmY2JfbGlzdCk7Ci0J
CXNwaW5fdW5sb2NrKCZycS0+bG9jayk7CisJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnJxLT5s
b2NrLCBmbGFncyk7CiAKIAkJaTkxNV9yZXF1ZXN0X3B1dChycSk7CiAJfQogfQogCi12b2lkIGlu
dGVsX2VuZ2luZV9zaWduYWxfYnJlYWRjcnVtYnMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lKQotewotCWxvY2FsX2lycV9kaXNhYmxlKCk7Ci0JaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJz
X2lycShlbmdpbmUpOwotCWxvY2FsX2lycV9lbmFibGUoKTsKLX0KLQogc3RhdGljIHZvaWQgc2ln
bmFsX2lycV93b3JrKHN0cnVjdCBpcnFfd29yayAqd29yaykKIHsKIAlzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmUgPQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZW5naW5lLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaAppbmRl
eCBkM2M2OTkzZjRmNDZmLi5jOWU4YzhjY2JkNDdmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9lbmdpbmUuaApAQCAtMzM1LDcgKzMzNSw2IEBAIHZvaWQgaW50ZWxfZW5naW5lX2luaXRf
ZXhlY2xpc3RzKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7CiB2b2lkIGludGVsX2Vu
Z2luZV9pbml0X2JyZWFkY3J1bWJzKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7CiB2
b2lkIGludGVsX2VuZ2luZV9maW5pX2JyZWFkY3J1bWJzKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSk7CiAKLXZvaWQgaW50ZWxfZW5naW5lX3NpZ25hbF9icmVhZGNydW1icyhzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUpOwogdm9pZCBpbnRlbF9lbmdpbmVfZGlzYXJtX2JyZWFk
Y3J1bWJzKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7CiAKIHN0YXRpYyBpbmxpbmUg
dm9pZApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfaGFuZ2NoZWNr
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hlY2suYwppbmRleCAwNWQw
NDJjZGVmZTI0Li43Y2E2N2FhYzI3ZDRkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9oYW5nY2hlY2suYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9oYW5nY2hlY2suYwpAQCAtMjgzLDcgKzI4Myw3IEBAIHN0YXRpYyB2b2lkIGhhbmdjaGVja19l
bGFwc2VkKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKIAlmb3JfZWFjaF9lbmdpbmUoZW5naW5l
LCBndC0+aTkxNSwgaWQpIHsKIAkJc3RydWN0IGhhbmdjaGVjayBoYzsKIAotCQlpbnRlbF9lbmdp
bmVfc2lnbmFsX2JyZWFkY3J1bWJzKGVuZ2luZSk7CisJCWludGVsX2VuZ2luZV9icmVhZGNydW1i
c19pcnEoZW5naW5lKTsKIAogCQloYW5nY2hlY2tfbG9hZF9zYW1wbGUoZW5naW5lLCAmaGMpOwog
CQloYW5nY2hlY2tfYWNjdW11bGF0ZV9zYW1wbGUoZW5naW5lLCAmaGMpOwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX3Jlc2V0LmMKaW5kZXggYjlkODRkNTJlOTg2NC4uMWQ1NDk3YTU4ZWViMSAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCkBAIC02OTcsNyArNjk3LDcgQEAg
c3RhdGljIHZvaWQgcmVzZXRfZmluaXNoX2VuZ2luZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUpCiAJZW5naW5lLT5yZXNldC5maW5pc2goZW5naW5lKTsKIAlpbnRlbF91bmNvcmVfZm9y
Y2V3YWtlX3B1dChlbmdpbmUtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7CiAKLQlpbnRlbF9lbmdp
bmVfc2lnbmFsX2JyZWFkY3J1bWJzKGVuZ2luZSk7CisJaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJz
X2lycShlbmdpbmUpOwogfQogCiBzdGF0aWMgdm9pZCByZXNldF9maW5pc2goc3RydWN0IGludGVs
X2d0ICpndCwgaW50ZWxfZW5naW5lX21hc2tfdCBhd2FrZSkKLS0gCjIuMjMuMAoKX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcg
bGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRl
c2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
