Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 3A10133C121
	for <lists+dri-devel@lfdr.de>; Mon, 15 Mar 2021 17:04:33 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B4D3489F92;
	Mon, 15 Mar 2021 16:04:27 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ej1-x62c.google.com (mail-ej1-x62c.google.com
 [IPv6:2a00:1450:4864:20::62c])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0CBD289F92
 for <dri-devel@lists.freedesktop.org>; Mon, 15 Mar 2021 16:04:26 +0000 (UTC)
Received: by mail-ej1-x62c.google.com with SMTP id ox4so51527097ejb.11
 for <dri-devel@lists.freedesktop.org>; Mon, 15 Mar 2021 09:04:26 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=LIin5wjnSTXRPAT3zB4ZM4KQkf5kTKrGdbYNl6taIkE=;
 b=ocLHlF8D7s/EexNyBfFRbGoUAy3J0Vkq3YhJalpn0z5Am+vGeiOmEMMNHJGFD+y+W8
 srBRK+Vsi0K95QQIzioSMlUKOYuWH3UFrXw3Y7vCFj5SUnRL+FsuDlx5AGLgXTZ7AH/L
 2Y7KXQDfcGzu7MksfY2bduRuK8owTctoZOO+iG8OntDyti/8iQB97y0x5EukL9Fa1juE
 T+YnMabUR0bJxIz6uc4h+ODZtZMsevSVL5PqcS72PusvEq+OCPuvb8rcJHuKy3fJHBxN
 Owa2QdYz1E6GhLaOhLkPtM3cEq02Hs01hF6EzKbPK4WtB1E/urjOjytihrYyEcEVyxPO
 mydA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=LIin5wjnSTXRPAT3zB4ZM4KQkf5kTKrGdbYNl6taIkE=;
 b=EMmMsOn8+i8usDp6d+Sd2F2tAYqJWrTQnf3z9pLYxIc5DGU3/zWu1jZcJA6fa/tPDH
 ZYCOy8CRJ2zG/OGlqlmsoCsNHCtDlKatdQZKTnr/mNEbNhNQHOWjE4hvxO8zf8a1grp1
 /34pNgHbrKsdVVABys6LzOr5wW9Al/6Knae9jcpABdzRQqch2OfSYFkXIwJUfiFpx8T2
 JN5ibNJmwU7BBgrKeX4WnHm5ECm8S/a4QNuJ6iJp4FuQOM+GGPdQL4G+YD1YGuVvVXKu
 RiP0tkp6Vsa12ZIu4lEqLB1eexYP1WOCArNuYnuH51lILNCROpxb+xYMf0SBgH66ozVG
 pJhQ==
X-Gm-Message-State: AOAM530ijLNuxc/Zawu/j4PIH/Gs5j2iTl5FYP+O/ifo2Xl53y0MMaQY
 tzOrALaJ/DVkVMSiV6r84C35K9VGSjc=
X-Google-Smtp-Source: ABdhPJw2d/dWX9l52v3eHk8Xcz9NAestnultEbnfQnW0YiFsajFIcdUCcQKTcLenFPN56L1ak6YsxA==
X-Received: by 2002:a17:907:a04f:: with SMTP id
 gz15mr24284305ejc.293.1615824264770; 
 Mon, 15 Mar 2021 09:04:24 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:dffe:4819:8ad9:f8bd])
 by smtp.gmail.com with ESMTPSA id lx6sm7626936ejb.64.2021.03.15.09.04.24
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 15 Mar 2021 09:04:24 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 2/3] drm/ttm: remove swap LRU v2
Date: Mon, 15 Mar 2021 17:04:21 +0100
Message-Id: <20210315160422.152528-2-christian.koenig@amd.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20210315160422.152528-1-christian.koenig@amd.com>
References: <20210315160422.152528-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: ray.huang@amd.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW5zdGVhZCBldmljdCByb3VuZCByb2JpbiBmcm9tIGVhY2ggZGV2aWNlcyBTWVNURU0gYW5kIFRU
IGRvbWFpbi4KCnYyOiByZW9yZGVyIG51bV9wYWdlcyBhY2Nlc3MgcmVwb3J0ZWQgYnkgRGFuJ3Mg
c2NyaXB0CgpTaWduZWQtb2ZmLWJ5OiBDaHJpc3RpYW4gS8O2bmlnIDxjaHJpc3RpYW4ua29lbmln
QGFtZC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm8uYyAgICAgICAgfCAzMyAr
Ky0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGlsLmMgICB8ICAx
IC0KIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2RldmljZS5jICAgIHwgNjAgKysrKysrKysrKysr
KysrKysrKysrLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2Rydi5jIHwg
IDIgKy0KIGluY2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmggICAgICAgIHwgIDEgLQogaW5jbHVk
ZS9kcm0vdHRtL3R0bV9ib19kcml2ZXIuaCAgICAgfCAgMSAtCiBpbmNsdWRlL2RybS90dG0vdHRt
X2RldmljZS5oICAgICAgICB8ICA3ICstLS0KIDcgZmlsZXMgY2hhbmdlZCwgNTIgaW5zZXJ0aW9u
cygrKSwgNTMgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3R0bS90
dG1fYm8uYyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvLmMKaW5kZXggNTZkMmUzOGFmMjcz
Li5hMWJlODhiZTM1N2IgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm8uYwpAQCAtNzMsNyArNzMsNiBAQCBzdGF0
aWMgdm9pZCB0dG1fYm9fZGVsX2Zyb21fbHJ1KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8p
CiB7CiAJc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYgPSBiby0+YmRldjsKIAotCWxpc3RfZGVsX2lu
aXQoJmJvLT5zd2FwKTsKIAlsaXN0X2RlbF9pbml0KCZiby0+bHJ1KTsKIAogCWlmIChiZGV2LT5m
dW5jcy0+ZGVsX2Zyb21fbHJ1X25vdGlmeSkKQEAgLTEwNCwxNiArMTAzLDYgQEAgdm9pZCB0dG1f
Ym9fbW92ZV90b19scnVfdGFpbChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCiAJbWFu
ID0gdHRtX21hbmFnZXJfdHlwZShiZGV2LCBtZW0tPm1lbV90eXBlKTsKIAlsaXN0X21vdmVfdGFp
bCgmYm8tPmxydSwgJm1hbi0+bHJ1W2JvLT5wcmlvcml0eV0pOwotCWlmIChtYW4tPnVzZV90dCAm
JiBiby0+dHRtICYmCi0JICAgICEoYm8tPnR0bS0+cGFnZV9mbGFncyAmIChUVE1fUEFHRV9GTEFH
X1NHIHwKLQkJCQkgICAgIFRUTV9QQUdFX0ZMQUdfU1dBUFBFRCkpKSB7Ci0JCXN0cnVjdCBsaXN0
X2hlYWQgKnN3YXA7Ci0KLQkJc3dhcCA9ICZ0dG1fZ2xvYi5zd2FwX2xydVtiby0+cHJpb3JpdHld
OwotCQlsaXN0X21vdmVfdGFpbCgmYm8tPnN3YXAsIHN3YXApOwotCX0gZWxzZSB7Ci0JCWxpc3Rf
ZGVsX2luaXQoJmJvLT5zd2FwKTsKLQl9CiAKIAlpZiAoYmRldi0+ZnVuY3MtPmRlbF9mcm9tX2xy
dV9ub3RpZnkpCiAJCWJkZXYtPmZ1bmNzLT5kZWxfZnJvbV9scnVfbm90aWZ5KGJvKTsKQEAgLTEy
OCw5ICsxMTcsNiBAQCB2b2lkIHR0bV9ib19tb3ZlX3RvX2xydV90YWlsKHN0cnVjdCB0dG1fYnVm
ZmVyX29iamVjdCAqYm8sCiAJCQl0dG1fYm9fYnVsa19tb3ZlX3NldF9wb3MoJmJ1bGstPnZyYW1b
Ym8tPnByaW9yaXR5XSwgYm8pOwogCQkJYnJlYWs7CiAJCX0KLQkJaWYgKGJvLT50dG0gJiYgIShi
by0+dHRtLT5wYWdlX2ZsYWdzICYKLQkJCQkgKFRUTV9QQUdFX0ZMQUdfU0cgfCBUVE1fUEFHRV9G
TEFHX1NXQVBQRUQpKSkKLQkJCXR0bV9ib19idWxrX21vdmVfc2V0X3BvcygmYnVsay0+c3dhcFti
by0+cHJpb3JpdHldLCBibyk7CiAJfQogfQogRVhQT1JUX1NZTUJPTCh0dG1fYm9fbW92ZV90b19s
cnVfdGFpbCk7CkBAIC0xNjgsMjAgKzE1NCw2IEBAIHZvaWQgdHRtX2JvX2J1bGtfbW92ZV9scnVf
dGFpbChzdHJ1Y3QgdHRtX2xydV9idWxrX21vdmUgKmJ1bGspCiAJCWxpc3RfYnVsa19tb3ZlX3Rh
aWwoJm1hbi0+bHJ1W2ldLCAmcG9zLT5maXJzdC0+bHJ1LAogCQkJCSAgICAmcG9zLT5sYXN0LT5s
cnUpOwogCX0KLQotCWZvciAoaSA9IDA7IGkgPCBUVE1fTUFYX0JPX1BSSU9SSVRZOyArK2kpIHsK
LQkJc3RydWN0IHR0bV9scnVfYnVsa19tb3ZlX3BvcyAqcG9zID0gJmJ1bGstPnN3YXBbaV07Ci0J
CXN0cnVjdCBsaXN0X2hlYWQgKmxydTsKLQotCQlpZiAoIXBvcy0+Zmlyc3QpCi0JCQljb250aW51
ZTsKLQotCQlkbWFfcmVzdl9hc3NlcnRfaGVsZChwb3MtPmZpcnN0LT5iYXNlLnJlc3YpOwotCQlk
bWFfcmVzdl9hc3NlcnRfaGVsZChwb3MtPmxhc3QtPmJhc2UucmVzdik7Ci0KLQkJbHJ1ID0gJnR0
bV9nbG9iLnN3YXBfbHJ1W2ldOwotCQlsaXN0X2J1bGtfbW92ZV90YWlsKGxydSwgJnBvcy0+Zmly
c3QtPnN3YXAsICZwb3MtPmxhc3QtPnN3YXApOwotCX0KIH0KIEVYUE9SVF9TWU1CT0wodHRtX2Jv
X2J1bGtfbW92ZV9scnVfdGFpbCk7CiAKQEAgLTEwNTgsNyArMTAzMCw2IEBAIGludCB0dG1fYm9f
aW5pdF9yZXNlcnZlZChzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwKIAlrcmVmX2luaXQoJmJvLT5r
cmVmKTsKIAlJTklUX0xJU1RfSEVBRCgmYm8tPmxydSk7CiAJSU5JVF9MSVNUX0hFQUQoJmJvLT5k
ZGVzdHJveSk7Ci0JSU5JVF9MSVNUX0hFQUQoJmJvLT5zd2FwKTsKIAliby0+YmRldiA9IGJkZXY7
CiAJYm8tPnR5cGUgPSB0eXBlOwogCWJvLT5tZW0ubWVtX3R5cGUgPSBUVE1fUExfU1lTVEVNOwpA
QCAtMTE5Myw2ICsxMTY0LDEwIEBAIGludCB0dG1fYm9fc3dhcG91dChzdHJ1Y3QgdHRtX2J1ZmZl
cl9vYmplY3QgKmJvLCBzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHggKmN0eCwKIAlib29sIGxvY2tl
ZDsKIAlpbnQgcmV0OwogCisJaWYgKCFiby0+dHRtIHx8IGJvLT50dG0tPnBhZ2VfZmxhZ3MgJiAo
VFRNX1BBR0VfRkxBR19TRyB8CisJCQkJCSAgICAgICBUVE1fUEFHRV9GTEFHX1NXQVBQRUQpKQor
CQlyZXR1cm4gZmFsc2U7CisKIAlpZiAoIXR0bV9ib19ldmljdF9zd2Fwb3V0X2FsbG93YWJsZShi
bywgY3R4LCAmbG9ja2VkLCBOVUxMKSkKIAkJcmV0dXJuIC1FQlVTWTsKIApkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm9fdXRpbC5jIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90
dG1fYm9fdXRpbC5jCmluZGV4IDAzMWU1ODE5ZmVjNC4uYTJhMTdjODRjZWIzIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGlsLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L3R0bS90dG1fYm9fdXRpbC5jCkBAIC0zMDMsNyArMzAzLDYgQEAgc3RhdGljIGludCB0dG1fYnVm
ZmVyX29iamVjdF90cmFuc2ZlcihzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCWF0b21p
Y19pbmMoJnR0bV9nbG9iLmJvX2NvdW50KTsKIAlJTklUX0xJU1RfSEVBRCgmZmJvLT5iYXNlLmRk
ZXN0cm95KTsKIAlJTklUX0xJU1RfSEVBRCgmZmJvLT5iYXNlLmxydSk7Ci0JSU5JVF9MSVNUX0hF
QUQoJmZiby0+YmFzZS5zd2FwKTsKIAlmYm8tPmJhc2UubW92aW5nID0gTlVMTDsKIAlkcm1fdm1h
X25vZGVfcmVzZXQoJmZiby0+YmFzZS5iYXNlLnZtYV9ub2RlKTsKIApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL3R0bS90dG1fZGV2aWNlLmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9k
ZXZpY2UuYwppbmRleCBkZmMyYTdlNGU0OTAuLjJjMjgwZmIxZTk5MiAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL3R0bS90dG1fZGV2aWNlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90
dG1fZGV2aWNlLmMKQEAgLTY3LDcgKzY3LDYgQEAgc3RhdGljIGludCB0dG1fZ2xvYmFsX2luaXQo
dm9pZCkKIAl1bnNpZ25lZCBsb25nIG51bV9wYWdlczsKIAlzdHJ1Y3Qgc3lzaW5mbyBzaTsKIAlp
bnQgcmV0ID0gMDsKLQl1bnNpZ25lZCBpOwogCiAJbXV0ZXhfbG9jaygmdHRtX2dsb2JhbF9tdXRl
eCk7CiAJaWYgKCsrdHRtX2dsb2JfdXNlX2NvdW50ID4gMSkKQEAgLTkwLDggKzg5LDYgQEAgc3Rh
dGljIGludCB0dG1fZ2xvYmFsX2luaXQodm9pZCkKIAkJZ290byBvdXQ7CiAJfQogCi0JZm9yIChp
ID0gMDsgaSA8IFRUTV9NQVhfQk9fUFJJT1JJVFk7ICsraSkKLQkJSU5JVF9MSVNUX0hFQUQoJmds
b2ItPnN3YXBfbHJ1W2ldKTsKIAlJTklUX0xJU1RfSEVBRCgmZ2xvYi0+ZGV2aWNlX2xpc3QpOwog
CWF0b21pY19zZXQoJmdsb2ItPmJvX2NvdW50LCAwKTsKIApAQCAtMTA5LDI3ICsxMDYsNjAgQEAg
c3RhdGljIGludCB0dG1fZ2xvYmFsX2luaXQodm9pZCkKIGxvbmcgdHRtX2dsb2JhbF9zd2Fwb3V0
KHN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0eCAqY3R4LCBnZnBfdCBnZnBfZmxhZ3MpCiB7CiAJc3Ry
dWN0IHR0bV9nbG9iYWwgKmdsb2IgPSAmdHRtX2dsb2I7CisJc3RydWN0IHR0bV9kZXZpY2UgKmJk
ZXY7CisJaW50IHJldCA9IC1FQlVTWTsKKworCW11dGV4X2xvY2soJnR0bV9nbG9iYWxfbXV0ZXgp
OworCWxpc3RfZm9yX2VhY2hfZW50cnkoYmRldiwgJmdsb2ItPmRldmljZV9saXN0LCBkZXZpY2Vf
bGlzdCkgeworCQlyZXQgPSB0dG1fZGV2aWNlX3N3YXBvdXQoYmRldiwgY3R4LCBnZnBfZmxhZ3Mp
OworCQlpZiAocmV0ID4gMCkgeworCQkJbGlzdF9tb3ZlX3RhaWwoJmJkZXYtPmRldmljZV9saXN0
LCAmZ2xvYi0+ZGV2aWNlX2xpc3QpOworCQkJYnJlYWs7CisJCX0KKwl9CisJbXV0ZXhfdW5sb2Nr
KCZ0dG1fZ2xvYmFsX211dGV4KTsKKwlyZXR1cm4gcmV0OworfQorRVhQT1JUX1NZTUJPTCh0dG1f
Z2xvYmFsX3N3YXBvdXQpOworCitsb25nIHR0bV9kZXZpY2Vfc3dhcG91dChzdHJ1Y3QgdHRtX2Rl
dmljZSAqYmRldiwgc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4ICpjdHgsCisJCQlnZnBfdCBnZnBf
ZmxhZ3MpCit7CisJc3RydWN0IHR0bV9nbG9iYWwgKmdsb2IgPSAmdHRtX2dsb2I7CisJc3RydWN0
IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYW47CiAJc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpi
bzsKLQl1bnNpZ25lZCBpOworCXVuc2lnbmVkIGksIGo7CiAJaW50IHJldDsKIAogCXNwaW5fbG9j
aygmZ2xvYi0+bHJ1X2xvY2spOwotCWZvciAoaSA9IDA7IGkgPCBUVE1fTUFYX0JPX1BSSU9SSVRZ
OyArK2kpIHsKLQkJbGlzdF9mb3JfZWFjaF9lbnRyeShibywgJmdsb2ItPnN3YXBfbHJ1W2ldLCBz
d2FwKSB7Ci0JCQl1aW50MzJfdCBudW1fcGFnZXMgPSBiby0+dHRtLT5udW1fcGFnZXM7Ci0KLQkJ
CXJldCA9IHR0bV9ib19zd2Fwb3V0KGJvLCBjdHgsIGdmcF9mbGFncyk7Ci0JCQkvKiB0dG1fYm9f
c3dhcG91dCBoYXMgZHJvcHBlZCB0aGUgbHJ1X2xvY2sgKi8KLQkJCWlmICghcmV0KQotCQkJCXJl
dHVybiBudW1fcGFnZXM7Ci0JCQlpZiAocmV0ICE9IC1FQlVTWSkKLQkJCQlyZXR1cm4gcmV0Owor
CWZvciAoaSA9IFRUTV9QTF9TWVNURU07IGkgPCBUVE1fTlVNX01FTV9UWVBFUzsgKytpKSB7CisJ
CW1hbiA9IHR0bV9tYW5hZ2VyX3R5cGUoYmRldiwgaSk7CisJCWlmICghbWFuIHx8ICFtYW4tPnVz
ZV90dCkKKwkJCWNvbnRpbnVlOworCisJCWZvciAoaiA9IDA7IGogPCBUVE1fTUFYX0JPX1BSSU9S
SVRZOyArK2opIHsKKwkJCWxpc3RfZm9yX2VhY2hfZW50cnkoYm8sICZtYW4tPmxydVtqXSwgbHJ1
KSB7CisJCQkJbG9uZyBudW1fcGFnZXM7CisKKwkJCQlpZiAoIWJvLT50dG0gfHwKKwkJCQkgICAg
Ym8tPnR0bS0+cGFnZV9mbGFncyAmIFRUTV9QQUdFX0ZMQUdfU0cgfHwKKwkJCQkgICAgYm8tPnR0
bS0+cGFnZV9mbGFncyAmIFRUTV9QQUdFX0ZMQUdfU1dBUFBFRCkKKwkJCQkJY29udGludWU7CisK
KwkJCQludW1fcGFnZXMgPSBiby0+dHRtLT5udW1fcGFnZXM7CisJCQkJcmV0ID0gdHRtX2JvX3N3
YXBvdXQoYm8sIGN0eCwgZ2ZwX2ZsYWdzKTsKKwkJCQkvKiB0dG1fYm9fc3dhcG91dCBoYXMgZHJv
cHBlZCB0aGUgbHJ1X2xvY2sgKi8KKwkJCQlpZiAoIXJldCkKKwkJCQkJcmV0dXJuIG51bV9wYWdl
czsKKwkJCQlpZiAocmV0ICE9IC1FQlVTWSkKKwkJCQkJcmV0dXJuIHJldDsKKwkJCX0KIAkJfQog
CX0KIAlzcGluX3VubG9jaygmZ2xvYi0+bHJ1X2xvY2spOwogCXJldHVybiAwOwogfQotRVhQT1JU
X1NZTUJPTCh0dG1fZ2xvYmFsX3N3YXBvdXQpOworRVhQT1JUX1NZTUJPTCh0dG1fZGV2aWNlX3N3
YXBvdXQpOwogCiBzdGF0aWMgdm9pZCB0dG1faW5pdF9zeXNtYW4oc3RydWN0IHR0bV9kZXZpY2Ug
KmJkZXYpCiB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9kcnYu
YyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2Rydi5jCmluZGV4IGI5OTE0MjJlMTU2
Yy4uMGU4MmIwNjYyZDllIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dm
eF9kcnYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9kcnYuYwpAQCAtMTM3
MSw3ICsxMzcxLDcgQEAgc3RhdGljIGludCB2bXdfcG1fZnJlZXplKHN0cnVjdCBkZXZpY2UgKmtk
ZXYpCiAJdm13X2V4ZWNidWZfcmVsZWFzZV9waW5uZWRfYm8oZGV2X3ByaXYpOwogCXZtd19yZXNv
dXJjZV9ldmljdF9hbGwoZGV2X3ByaXYpOwogCXZtd19yZWxlYXNlX2RldmljZV9lYXJseShkZXZf
cHJpdik7Ci0Jd2hpbGUgKHR0bV9nbG9iYWxfc3dhcG91dCgmY3R4LCBHRlBfS0VSTkVMKSA+IDAp
OworCXdoaWxlICh0dG1fZGV2aWNlX3N3YXBvdXQoJmRldl9wcml2LT5iZGV2LCAmY3R4LCBHRlBf
S0VSTkVMKSA9PSAwKTsKIAlpZiAoZGV2X3ByaXYtPmVuYWJsZV9mYikKIAkJdm13X2ZpZm9fcmVz
b3VyY2VfZGVjKGRldl9wcml2KTsKIAlpZiAoYXRvbWljX3JlYWQoJmRldl9wcml2LT5udW1fZmlm
b19yZXNvdXJjZXMpICE9IDApIHsKZGlmZiAtLWdpdCBhL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9f
YXBpLmggYi9pbmNsdWRlL2RybS90dG0vdHRtX2JvX2FwaS5oCmluZGV4IDUwNDRhYzMzMDg1OC4u
MzU4N2Y2NjBlOGY0IDEwMDY0NAotLS0gYS9pbmNsdWRlL2RybS90dG0vdHRtX2JvX2FwaS5oCisr
KyBiL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmgKQEAgLTE0NCw3ICsxNDQsNiBAQCBzdHJ1
Y3QgdHRtX2J1ZmZlcl9vYmplY3QgewogCiAJc3RydWN0IGxpc3RfaGVhZCBscnU7CiAJc3RydWN0
IGxpc3RfaGVhZCBkZGVzdHJveTsKLQlzdHJ1Y3QgbGlzdF9oZWFkIHN3YXA7CiAKIAkvKioKIAkg
KiBNZW1iZXJzIHByb3RlY3RlZCBieSBhIGJvIHJlc2VydmF0aW9uLgpkaWZmIC0tZ2l0IGEvaW5j
bHVkZS9kcm0vdHRtL3R0bV9ib19kcml2ZXIuaCBiL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fZHJp
dmVyLmgKaW5kZXggODk1OWMwMDc1Y2ZkLi5kMDA3ZmVlZjc2NzYgMTAwNjQ0Ci0tLSBhL2luY2x1
ZGUvZHJtL3R0bS90dG1fYm9fZHJpdmVyLmgKKysrIGIvaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19k
cml2ZXIuaApAQCAtNjksNyArNjksNiBAQCBzdHJ1Y3QgdHRtX2xydV9idWxrX21vdmVfcG9zIHsK
IHN0cnVjdCB0dG1fbHJ1X2J1bGtfbW92ZSB7CiAJc3RydWN0IHR0bV9scnVfYnVsa19tb3ZlX3Bv
cyB0dFtUVE1fTUFYX0JPX1BSSU9SSVRZXTsKIAlzdHJ1Y3QgdHRtX2xydV9idWxrX21vdmVfcG9z
IHZyYW1bVFRNX01BWF9CT19QUklPUklUWV07Ci0Jc3RydWN0IHR0bV9scnVfYnVsa19tb3ZlX3Bv
cyBzd2FwW1RUTV9NQVhfQk9fUFJJT1JJVFldOwogfTsKIAogLyoKZGlmZiAtLWdpdCBhL2luY2x1
ZGUvZHJtL3R0bS90dG1fZGV2aWNlLmggYi9pbmNsdWRlL2RybS90dG0vdHRtX2RldmljZS5oCmlu
ZGV4IDZhMGIyNjdkNGZlNi4uY2RhNmVmYjRjMzRiIDEwMDY0NAotLS0gYS9pbmNsdWRlL2RybS90
dG0vdHRtX2RldmljZS5oCisrKyBiL2luY2x1ZGUvZHJtL3R0bS90dG1fZGV2aWNlLmgKQEAgLTYz
LDExICs2Myw2IEBAIGV4dGVybiBzdHJ1Y3QgdHRtX2dsb2JhbCB7CiAJICovCiAJc3RydWN0IGxp
c3RfaGVhZCBkZXZpY2VfbGlzdDsKIAotCS8qKgotCSAqIFByb3RlY3RlZCBieSB0aGUgbHJ1X2xv
Y2suCi0JICovCi0Jc3RydWN0IGxpc3RfaGVhZCBzd2FwX2xydVtUVE1fTUFYX0JPX1BSSU9SSVRZ
XTsKLQogCS8qKgogCSAqIEludGVybmFsIHByb3RlY3Rpb24uCiAJICovCkBAIC0yOTgsNiArMjkz
LDggQEAgc3RydWN0IHR0bV9kZXZpY2UgewogfTsKIAogbG9uZyB0dG1fZ2xvYmFsX3N3YXBvdXQo
c3RydWN0IHR0bV9vcGVyYXRpb25fY3R4ICpjdHgsIGdmcF90IGdmcF9mbGFncyk7Citsb25nIHR0
bV9kZXZpY2Vfc3dhcG91dChzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV9vcGVy
YXRpb25fY3R4ICpjdHgsCisJCSAgICAgICBnZnBfdCBnZnBfZmxhZ3MpOwogCiBzdGF0aWMgaW5s
aW5lIHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqCiB0dG1fbWFuYWdlcl90eXBlKHN0cnVj
dCB0dG1fZGV2aWNlICpiZGV2LCBpbnQgbWVtX3R5cGUpCi0tIAoyLjI1LjEKCl9fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxp
c3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNr
dG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbAo=
