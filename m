Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 89EB072D9E
	for <lists+dri-devel@lfdr.de>; Wed, 24 Jul 2019 13:30:33 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3239F6E4BE;
	Wed, 24 Jul 2019 11:30:31 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id EAE686E4BE
 for <dri-devel@lists.freedesktop.org>; Wed, 24 Jul 2019 11:30:26 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 3CD9DAE89;
 Wed, 24 Jul 2019 11:30:25 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: daniel@ffwll.ch, kraxel@redhat.com, sam@ravnborg.org, airlied@redhat.com,
 yc_chen@aspeedtech.com, Christian.Koenig@amd.com
Subject: [PATCH 1/3] drm/vram: Provide vmap and vunmap operations for GEM VRAM
 objects
Date: Wed, 24 Jul 2019 13:30:18 +0200
Message-Id: <20190724113020.3752-2-tzimmermann@suse.de>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20190724113020.3752-1-tzimmermann@suse.de>
References: <20190724113020.3752-1-tzimmermann@suse.de>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Zimmermann <tzimmermann@suse.de>, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIHBhdHRlcm4gb2YgdGVtcG9yYXJpbHkgcGlubmluZyBhbmQga21hcC1pbmcgdGhlIEJPJ3Mg
bWVtb3J5IGlzCmNvbW1vbiBlbm91Z2ggdG8ganVzdGlmeSBoZWxwZXIgZnVuY3Rpb25zIHRoYXQg
ZG8gYW5kIHVuZG8gdGhlc2UKb3BlcmF0aW9ucy4KClRoZSBpbXBsZW1lbnRhdGlvbiBvZiB2bWFw
IGFuZCB2dW5tYXAgZm9yIEdFTSBWUkFNIGhlbHBlcnMgaXMKYWxyZWFkeSBpbiBQUklNRSBoZWxw
ZXJzLiBUaGUgcGF0Y2ggbW92ZXMgdGhlIG9wZXJhdGlvbnMgdG8gc2VwYXJhdGUKZnVuY3Rpb25z
IGFuZCBleHBvcnRzIHRoZW0gZm9yIGdlbmVyYWwgdXNlLgoKVGhlIHBhdGNoIGFsc28gYWRkcyBh
IG5vdGUgYWJvdXQgcG9zc2libGUga21hcCBjb3VudGluZy4gU28gZmFyIHRoaXMKaXNuJ3QgcmVx
dWlyZWQgYnkgZHJpdmVycywgYnV0IG1vcmUgY29tcGxleCB1c2UgY2FzZXMgbWlnaHQgbWFrZSBp
dApuZWNlc3NhcnkuCgpTaWduZWQtb2ZmLWJ5OiBUaG9tYXMgWmltbWVybWFubiA8dHppbW1lcm1h
bm5Ac3VzZS5kZT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vZHJtX2dlbV92cmFtX2hlbHBlci5jIHwg
NTUgKysrKysrKysrKysrKysrKysrKysrKy0tLS0tCiBpbmNsdWRlL2RybS9kcm1fZ2VtX3ZyYW1f
aGVscGVyLmggICAgIHwgMTIgKysrKysrCiAyIGZpbGVzIGNoYW5nZWQsIDU3IGluc2VydGlvbnMo
KyksIDEwIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2Vt
X3ZyYW1faGVscGVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX2dlbV92cmFtX2hlbHBlci5jCmlu
ZGV4IGUwZmJmYjY1NzBjZi4uNTQ3NThlNGRlYmNhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vZHJtX2dlbV92cmFtX2hlbHBlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX3Zy
YW1faGVscGVyLmMKQEAgLTM0MCw2ICszNDAsNDggQEAgdm9pZCBkcm1fZ2VtX3ZyYW1fa3VubWFw
KHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8pCiB9CiBFWFBPUlRfU1lNQk9MKGRybV9n
ZW1fdnJhbV9rdW5tYXApOwogCisvKioKKyAqIGRybV9nZW1fdnJhbV92bWFwKCkgLSBQaW5zIGFu
ZCBtYXBzIGEgR0VNIFZSQU0gb2JqZWN0IGludG8ga2VybmVsIGFkZHJlc3MKKwlzcGFjZQorICog
QGdlbToJVGhlIEdFTSBWUkFNIG9iamVjdCB0byBtYXAKKyAqCisgKiBUaGUgdm1hcCBmdW5jdGlv
biBwaW5zIGEgR0VNIFZSQU0gb2JqZWN0IHRvIGl0J3MgY3VycmVudCBsb2NhdGlvbiwgZWl0aGVy
CisgKiBzeXN0ZW0gb3IgdmlkZW8gbWVtb3J5LCBhbmQgbWFwcyBpdCdzIGJ1ZmZlciBpbnRvIGtl
cm5lbCBhZGRyZXNzIHNwYWNlLiBBcworICogcGlubmVkIG9iamVjdCBjYW5ub3QgYmUgcmVsb2Fj
dGVkLCB5b3Ugc2hvdWxkIG5vdCBwZXJtYW5lbnRseSBwaW4gb2JqZWN0cy4KKyAqCisgKiBSZXR1
cm5zOgorICogVGhlIGJ1ZmZlcidzIHZpcnR1YWwgYWRkcmVzcyBvbiBzdWNjZXNzLCBvcgorICog
YW4gRVJSX1BUUigpLWVuY29kZWQgZXJyb3IgY29kZSBvdGhlcndpc2UuCisgKi8KK3ZvaWQgKmRy
bV9nZW1fdnJhbV92bWFwKHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8pCit7CisJaW50
IHJldDsKKwl2b2lkICpiYXNlOworCisJcmV0ID0gZHJtX2dlbV92cmFtX3BpbihnYm8sIDApOwor
CWlmIChyZXQpCisJCXJldHVybiBFUlJfUFRSKHJldCk7CisJYmFzZSA9IGRybV9nZW1fdnJhbV9r
bWFwKGdibywgdHJ1ZSwgTlVMTCk7CisJaWYgKElTX0VSUihiYXNlKSkgeworCQlkcm1fZ2VtX3Zy
YW1fdW5waW4oZ2JvKTsKKwkJcmV0dXJuIGJhc2U7CisJfQorCXJldHVybiBiYXNlOworfQorRVhQ
T1JUX1NZTUJPTChkcm1fZ2VtX3ZyYW1fdm1hcCk7CisKKy8qKgorICogZHJtX2dlbV92cmFtX3Z1
bm1hcCgpIC0gVW5tYXBzIGFuZCB1bnBpbnMgYSBHRU0gVlJBTSBvYmplY3QKKyAqIEBnZW06CVRo
ZSBHRU0gVlJBTSBvYmplY3QgdG8gdW5tYXAKKyAqIEB2YWRkcjoJVGhlIG1hcHBpbmcncyBiYXNl
IGFkZHJlc3MKKyAqLwordm9pZCBkcm1fZ2VtX3ZyYW1fdnVubWFwKHN0cnVjdCBkcm1fZ2VtX3Zy
YW1fb2JqZWN0ICpnYm8sIHZvaWQgKnZhZGRyKQoreworCWRybV9nZW1fdnJhbV9rdW5tYXAoZ2Jv
KTsKKwlkcm1fZ2VtX3ZyYW1fdW5waW4oZ2JvKTsKK30KK0VYUE9SVF9TWU1CT0woZHJtX2dlbV92
cmFtX3Z1bm1hcCk7CisKIC8qKgogICogZHJtX2dlbV92cmFtX2ZpbGxfY3JlYXRlX2R1bWIoKSAt
IFwKIAlIZWxwZXIgZm9yIGltcGxlbWVudGluZyAmc3RydWN0IGRybV9kcml2ZXIuZHVtYl9jcmVh
dGUKQEAgLTU5NSwxNyArNjM3LDExIEBAIHN0YXRpYyB2b2lkIGRybV9nZW1fdnJhbV9vYmplY3Rf
dW5waW4oc3RydWN0IGRybV9nZW1fb2JqZWN0ICpnZW0pCiBzdGF0aWMgdm9pZCAqZHJtX2dlbV92
cmFtX29iamVjdF92bWFwKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqZ2VtKQogewogCXN0cnVjdCBk
cm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8gPSBkcm1fZ2VtX3ZyYW1fb2ZfZ2VtKGdlbSk7Ci0JaW50
IHJldDsKIAl2b2lkICpiYXNlOwogCi0JcmV0ID0gZHJtX2dlbV92cmFtX3BpbihnYm8sIDApOwot
CWlmIChyZXQpCisJYmFzZSA9IGRybV9nZW1fdnJhbV92bWFwKGdibyk7CisJaWYgKElTX0VSUihi
YXNlKSkKIAkJcmV0dXJuIE5VTEw7Ci0JYmFzZSA9IGRybV9nZW1fdnJhbV9rbWFwKGdibywgdHJ1
ZSwgTlVMTCk7Ci0JaWYgKElTX0VSUihiYXNlKSkgewotCQlkcm1fZ2VtX3ZyYW1fdW5waW4oZ2Jv
KTsKLQkJcmV0dXJuIE5VTEw7Ci0JfQogCXJldHVybiBiYXNlOwogfQogCkBAIC02MjAsOCArNjU2
LDcgQEAgc3RhdGljIHZvaWQgZHJtX2dlbV92cmFtX29iamVjdF92dW5tYXAoc3RydWN0IGRybV9n
ZW1fb2JqZWN0ICpnZW0sCiB7CiAJc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKmdibyA9IGRy
bV9nZW1fdnJhbV9vZl9nZW0oZ2VtKTsKIAotCWRybV9nZW1fdnJhbV9rdW5tYXAoZ2JvKTsKLQlk
cm1fZ2VtX3ZyYW1fdW5waW4oZ2JvKTsKKwlkcm1fZ2VtX3ZyYW1fdnVubWFwKGdibywgdmFkZHIp
OwogfQogCiAvKgpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0vZHJtX2dlbV92cmFtX2hlbHBlci5o
IGIvaW5jbHVkZS9kcm0vZHJtX2dlbV92cmFtX2hlbHBlci5oCmluZGV4IGI0MWQ5MzJlYjUzYS4u
NTE5MmMxNjljZWMyIDEwMDY0NAotLS0gYS9pbmNsdWRlL2RybS9kcm1fZ2VtX3ZyYW1faGVscGVy
LmgKKysrIGIvaW5jbHVkZS9kcm0vZHJtX2dlbV92cmFtX2hlbHBlci5oCkBAIC00NCw2ICs0NCwx
NiBAQCBzdHJ1Y3QgZHJtX2dlbV92cmFtX29iamVjdCB7CiAJc3RydWN0IHR0bV9wbGFjZW1lbnQg
cGxhY2VtZW50OwogCXN0cnVjdCB0dG1fcGxhY2UgcGxhY2VtZW50c1syXTsKIAorCS8qIFRPRE86
IE1heWJlIGltcGxlbWVudCBhIG1hcCBjb3VudGVyLgorCSAqCisJICogU28gZmFyLCBkcml2ZXJz
IGJhc2VkIG9uIFZSQU0gaGVscGVycyBkb24ndCBoYXZlIG92ZXJsYXBwaW5nCisJICogbWFwcGlu
ZyBvcGVyYXRpb25zLiBBIGRyaXZlciB0ZW1wb3JhcmlseSBtYXBzIGFuIG9iamVjdCBhbmQKKwkg
KiB1bm1hcHMgaXQgQVNBUC4gVGhpcyB3b3JrcyB3ZWxsIGZvciBmYmRldiBlbXVsYXRpb24gb3Ig
Y3Vyc29ycy4KKwkgKgorCSAqIElmIHdlIGV2ZXIgaGF2ZSBhIGRyaXZlciB3aXRoIGJ1ZmZlciBv
YmplY3RzIHRoYXQgYXJlIG1hcHBlZAorCSAqIGJ5IG11bHRpcGxlIGNvZGUgZnJhZ21lbnRzIGNv
bmN1cnJlbnRseSwgd2UgbWF5IG5lZWQgYSBtYXAKKwkgKiBjb3VudGVyIHRvIGdldCB0aGUgbWFw
cGluZyByaWdodC4KKwkgKi8KIAlpbnQgcGluX2NvdW50OwogfTsKIApAQCAtODQsNiArOTQsOCBA
QCBpbnQgZHJtX2dlbV92cmFtX3VucGluKHN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8p
Owogdm9pZCAqZHJtX2dlbV92cmFtX2ttYXAoc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKmdi
bywgYm9vbCBtYXAsCiAJCQlib29sICppc19pb21lbSk7CiB2b2lkIGRybV9nZW1fdnJhbV9rdW5t
YXAoc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKmdibyk7Cit2b2lkICpkcm1fZ2VtX3ZyYW1f
dm1hcChzdHJ1Y3QgZHJtX2dlbV92cmFtX29iamVjdCAqZ2JvKTsKK3ZvaWQgZHJtX2dlbV92cmFt
X3Z1bm1hcChzdHJ1Y3QgZHJtX2dlbV92cmFtX29iamVjdCAqZ2JvLCB2b2lkICp2YWRkcik7CiAK
IGludCBkcm1fZ2VtX3ZyYW1fZmlsbF9jcmVhdGVfZHVtYihzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUs
CiAJCQkJICBzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAotLSAKMi4yMi4wCgpfX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0
CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3Rv
cC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
