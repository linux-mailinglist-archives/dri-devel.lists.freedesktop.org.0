Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 5614E29F6D8
	for <lists+dri-devel@lfdr.de>; Thu, 29 Oct 2020 22:29:06 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CF7BF6E90E;
	Thu, 29 Oct 2020 21:29:02 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mga06.intel.com (mga06.intel.com [134.134.136.31])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1F6866E909
 for <dri-devel@lists.freedesktop.org>; Thu, 29 Oct 2020 21:28:52 +0000 (UTC)
IronPort-SDR: w9kItMMP/3zQ2o/C9/5E1+EWiUjIags3EQwYL9pAL6VBrxnTcjqIZrVnYGIDMBjlKIP90CGIFD
 VbHRTkhda9Dg==
X-IronPort-AV: E=McAfee;i="6000,8403,9789"; a="230151677"
X-IronPort-AV: E=Sophos;i="5.77,430,1596524400"; d="scan'208";a="230151677"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga004.jf.intel.com ([10.7.209.38])
 by orsmga104.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 29 Oct 2020 14:28:51 -0700
IronPort-SDR: cwgI/RHyMJp5PdaYt/rERoGfjrfZjfQIY55O5ElLAokF8iEACHJxGRRY6qsDQiKBSiEDNPgFGu
 VE+qIjRgtA4w==
X-IronPort-AV: E=Sophos;i="5.77,430,1596524400"; d="scan'208";a="469282850"
Received: from nschweme-mobl.amr.corp.intel.com (HELO
 achrisan-DESK2.amr.corp.intel.com) ([10.254.34.96])
 by orsmga004-auth.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-SHA;
 29 Oct 2020 14:28:51 -0700
From: Anitha Chrisanthus <anitha.chrisanthus@intel.com>
To: dri-devel@lists.freedesktop.org,
	anitha.chrisanthus@intel.com
Subject: [PATCH v10 5/6] drm/kmb: Mipi DSI part of the display driver
Date: Thu, 29 Oct 2020 14:27:56 -0700
Message-Id: <1604006877-20092-6-git-send-email-anitha.chrisanthus@intel.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1604006877-20092-1-git-send-email-anitha.chrisanthus@intel.com>
References: <1604006877-20092-1-git-send-email-anitha.chrisanthus@intel.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: edmund.j.dea@intel.com, sam@ravnborg.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW5pdGlhbGl6ZXMgTWlwaSBEU0kgYW5kIHNldHMgdXAgY29ubmVjdHMgdG8gQURWIGJyaWRnZQoK
djI6IHJlbW92ZWQgbGljZW5zZSB0ZXh0CiAgICB1cGNsYXNzZWQgZGV2X3ByaXZhdGUsIHJlbW92
ZWQgSEFWRV9JUlEuIChTYW0pCgp2MzogU3F1YXNoZWQgYWxsIDU5IGNvbW1pdHMgdG8gb25lCgp2
NDogcmV2aWV3IGNoYW5nZXMgZnJvbSBTYW0gUmF2bmJvcmcKCXJlbmFtZWQgZGV2X3AgdG8ga21i
Cgp2NTogY29ycmVjdGVkIHNwZWxsaW5ncwp2NjogY29ycmVjdGVkIGNoZWNrcGF0Y2ggd2Fybmlu
Z3MKdjc6IHJldmlldyBjaGFuZ2VzIFNhbSBSYXZuYm9yZyBhbmQgVGhvbWFzIFppbW1lcm1hbgoJ
cmVtb3ZlZCB1bm5lY2Vzc2FyeSBsb2dzIGFuZCBkZWZpbmVzIGFuZCBpZmRlZiBjb2RlcyAoU2Ft
KQoJc3BsaXQgZHBoeV9pbml0X3NlcXVlbmNlIHNtYWxsZXIgKFNhbSkKCXJlbW92ZWQgcmVkdW5k
YW50IGNoZWNrcyBpbiBrbWJfZHNpIChTYW0pCgljaGFuZ2VkIGttYl9kc2lfaW5pdCB0byBkcm1f
YnJpZGdlX2Nvbm5lY3Rvcl9pbml0IGFuZAoJZHJtX2Nvbm5lY3Rvcl9hdHRhY2hfZW5jb2RlciB0
byBicmlkZ2UncyBjb25uZWN0b3IgKFNhbSkKdjg6IGNhbGwgZHJtX2JyaWRnZV9hdHRhY2ggd2l0
aCBEUk1fQlJJREdFX0FUVEFDSF9OT19DT05ORUNUT1IKdjk6IHJlbmFtZWQga21iX2RzaV9od19p
bml0IHRvIGttYl9kc2lfbW9kZV9zZXQgKERhbmllbCBWKQp2MTA6IGNoYW5nZXMgaW4gZHJpdmVy
IHRvIGFjY29tbW9kYXRlIGNoYW5nZXMgaW4gRFQgdG8gc2VwYXJhdGUgRFNJCiAgICAgZW50cmll
cyAoU2FtIFIpCiAgICAgYWRkZWQgY29tbWVudHMgdG8gY2xhcmlmeSBlbXB0eSBkc2kgaG9zdCBm
dW5jdGlvbnMKICAgICByZXZpZXcgY2hhbmdlcyBmcm9tIFNhbSB0byBzZXBhcmF0ZSBvdXQgRFNJ
IHBhcnQsCiAgICAgcmVtb3ZlZCBkZXBlbmRlbmNpZXMgb24gZHJtIHNpZGUgKFNhbSBSKQoKU2ln
bmVkLW9mZi1ieTogQW5pdGhhIENocmlzYW50aHVzIDxhbml0aGEuY2hyaXNhbnRodXNAaW50ZWwu
Y29tPgpDYzogU2FtIFJhdm5ib3JnIDxzYW1AcmF2bmJvcmcub3JnPgpDYzogVGhvbWFzIFppbW1l
cm1hbm4gPHR6aW1tZXJtYW5uQHN1c2UuZGU+CkNjOiBEYW5pZWwgVmV0dGVyIDxkYW5pZWxAZmZ3
bGwuY2g+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2ttYi9rbWJfZHNpLmMgfCAxNTQwICsrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0va21iL2tt
Yl9kc2kuaCB8ICAzODcgKysrKysrKysrKysKIDIgZmlsZXMgY2hhbmdlZCwgMTkyNyBpbnNlcnRp
b25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2ttYi9rbWJfZHNpLmMK
IGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0va21iL2ttYl9kc2kuaAoKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9rbWIva21iX2RzaS5jIGIvZHJpdmVycy9ncHUvZHJtL2tt
Yi9rbWJfZHNpLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uYjY1MjM2Zgot
LS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9rbWIva21iX2RzaS5jCkBAIC0wLDAg
KzEsMTU0MCBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seQorLyoK
KyAqIENvcHlyaWdodCDCqSAyMDE5LTIwMjAgSW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaW5j
bHVkZSA8bGludXgvY2xrLmg+CisjaW5jbHVkZSA8bGludXgvZGVsYXkuaD4KKyNpbmNsdWRlIDxs
aW51eC9vZl9ncmFwaC5oPgorI2luY2x1ZGUgPGxpbnV4L3BsYXRmb3JtX2RldmljZS5oPgorCisj
aW5jbHVkZSA8ZHJtL2RybV9hdG9taWNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9icmlk
Z2UuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2JyaWRnZV9jb25uZWN0b3IuaD4KKyNpbmNsdWRlIDxk
cm0vZHJtX21pcGlfZHNpLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9zaW1wbGVfa21zX2hlbHBlci5o
PgorI2luY2x1ZGUgPGRybS9kcm1fcHJpbnQuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3Byb2JlX2hl
bHBlci5oPgorCisjaW5jbHVkZSAia21iX2RzaS5oIgorI2luY2x1ZGUgImttYl9yZWdzLmgiCisK
K3N0YXRpYyBzdHJ1Y3QgbWlwaV9kc2lfaG9zdCAqZHNpX2hvc3Q7CitzdGF0aWMgc3RydWN0IG1p
cGlfZHNpX2RldmljZSAqZHNpX2RldmljZTsKK3N0YXRpYyBzdHJ1Y3QgZHJtX2JyaWRnZSAqYWR2
X2JyaWRnZTsKKworLyogRGVmYXVsdCBzZXR0aW5nIGlzIDEwODBwLCA0IGxhbmVzICovCisjZGVm
aW5lIElNR19IRUlHSFRfTElORVMgIDEwODAKKyNkZWZpbmUgSU1HX1dJRFRIX1BYICAgICAgMTky
MAorI2RlZmluZSBNSVBJX1RYX0FDVElWRV9MQU5FUyA0CisKK3N0YXRpYyBzdHJ1Y3QgbWlwaV90
eF9mcmFtZV9zZWN0aW9uX2NmZyBtaXBpX3R4X2ZyYW1lMF9zZWN0X2NmZyA9IHsKKwkud2lkdGhf
cGl4ZWxzID0gSU1HX1dJRFRIX1BYLAorCS5oZWlnaHRfbGluZXMgPSBJTUdfSEVJR0hUX0xJTkVT
LAorCS5kYXRhX3R5cGUgPSBEU0lfTFBfRFRfUFBTX1JHQjg4OF8yNEIsCisJLmRhdGFfbW9kZSA9
IE1JUElfREFUQV9NT0RFMSwKKwkuZG1hX3BhY2tlZCA9IDAKK307CisKK3N0YXRpYyBzdHJ1Y3Qg
bWlwaV90eF9mcmFtZV9jZmcgbWlwaXR4X2ZyYW1lMF9jZmcgPSB7CisJLnNlY3Rpb25zWzBdID0g
Jm1pcGlfdHhfZnJhbWUwX3NlY3RfY2ZnLAorCS5zZWN0aW9uc1sxXSA9IE5VTEwsCisJLnNlY3Rp
b25zWzJdID0gTlVMTCwKKwkuc2VjdGlvbnNbM10gPSBOVUxMLAorCS52c3luY193aWR0aCA9IDUs
CisJLnZfYmFja3BvcmNoID0gMzYsCisJLnZfZnJvbnRwb3JjaCA9IDQsCisJLmhzeW5jX3dpZHRo
ID0gNDQsCisJLmhfYmFja3BvcmNoID0gMTQ4LAorCS5oX2Zyb250cG9yY2ggPSA4OAorfTsKKwor
c3RhdGljIGNvbnN0IHN0cnVjdCBtaXBpX3R4X2RzaV9jZmcgbWlwaXR4X2RzaV9jZmcgPSB7CisJ
LmhmcF9ibGFua19lbiA9IDAsCisJLmVvdHBfZW4gPSAwLAorCS5scG1fbGFzdF92ZnBfbGluZSA9
IDAsCisJLmxwbV9maXJzdF92c2FfbGluZSA9IDAsCisJLnN5bmNfcHVsc2VfZXZlbnRuID0gRFNJ
X1ZJREVPX01PREVfTk9fQlVSU1RfRVZFTlQsCisJLmhmcF9ibGFua2luZyA9IFNFTkRfQkxBTktf
UEFDS0VULAorCS5oYnBfYmxhbmtpbmcgPSBTRU5EX0JMQU5LX1BBQ0tFVCwKKwkuaHNhX2JsYW5r
aW5nID0gU0VORF9CTEFOS19QQUNLRVQsCisJLnZfYmxhbmtpbmcgPSBTRU5EX0JMQU5LX1BBQ0tF
VCwKK307CisKK3N0YXRpYyBzdHJ1Y3QgbWlwaV9jdHJsX2NmZyBtaXBpX3R4X2luaXRfY2ZnID0g
eworCS5hY3RpdmVfbGFuZXMgPSBNSVBJX1RYX0FDVElWRV9MQU5FUywKKwkubGFuZV9yYXRlX21i
cHMgPSBNSVBJX1RYX0xBTkVfREFUQV9SQVRFX01CUFMsCisJLnJlZl9jbGtfa2h6ID0gTUlQSV9U
WF9SRUZfQ0xLX0tIWiwKKwkuY2ZnX2Nsa19raHogPSBNSVBJX1RYX0NGR19DTEtfS0haLAorCS50
eF9jdHJsX2NmZyA9IHsKKwkJCS5mcmFtZXNbMF0gPSAmbWlwaXR4X2ZyYW1lMF9jZmcsCisJCQku
ZnJhbWVzWzFdID0gTlVMTCwKKwkJCS5mcmFtZXNbMl0gPSBOVUxMLAorCQkJLmZyYW1lc1szXSA9
IE5VTEwsCisJCQkudHhfZHNpX2NmZyA9ICZtaXBpdHhfZHNpX2NmZywKKwkJCS5saW5lX3N5bmNf
cGt0X2VuID0gMCwKKwkJCS5saW5lX2NvdW50ZXJfYWN0aXZlID0gMCwKKwkJCS5mcmFtZV9jb3Vu
dGVyX2FjdGl2ZSA9IDAsCisJCQkudHhfYWx3YXlzX3VzZV9oYWN0ID0gMSwKKwkJCS50eF9oYWN0
X3dhaXRfc3RvcCA9IDEsCisJCQl9Cit9OworCitzdHJ1Y3QgIG1pcGlfaHNfZnJlcV9yYW5nZV9j
ZmcgeworCXUxNiBkZWZhdWx0X2JpdF9yYXRlX21icHM7CisJdTggaHNmcmVxcmFuZ2VfY29kZTsK
K307CisKK3N0cnVjdCB2Y29fcGFyYW1zIHsKKwl1MzIgZnJlcTsKKwl1MzIgcmFuZ2U7CisJdTMy
IGRpdmlkZXI7Cit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IHZjb19wYXJhbXMgdmNvX3RhYmxl
W10gPSB7CisJezUyLCAweDNmLCA4fSwKKwl7ODAsIDB4MzksIDh9LAorCXsxMDUsIDB4MmYsIDR9
LAorCXsxNjAsIDB4MjksIDR9LAorCXsyMTAsIDB4MWYsIDJ9LAorCXszMjAsIDB4MTksIDJ9LAor
CXs0MjAsIDB4MGYsIDF9LAorCXs2MzAsIDB4MDksIDF9LAorCXsxMTAwLCAweDAzLCAxfSwKKwl7
MHhmZmZmLCAweDAxLCAxfSwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgbWlwaV9oc19mcmVx
X3JhbmdlX2NmZworbWlwaV9oc19mcmVxX3JhbmdlW01JUElfRFBIWV9ERUZBVUxUX0JJVF9SQVRF
U10gPSB7CisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSA4MCwgLmhzZnJlcXJhbmdlX2NvZGUg
PSAweDAwfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDkwLCAuaHNmcmVxcmFuZ2VfY29k
ZSA9IDB4MTB9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTAwLCAuaHNmcmVxcmFuZ2Vf
Y29kZSA9IDB4MjB9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTEwLCAuaHNmcmVxcmFu
Z2VfY29kZSA9IDB4MzB9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTIwLCAuaHNmcmVx
cmFuZ2VfY29kZSA9IDB4MDF9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTMwLCAuaHNm
cmVxcmFuZ2VfY29kZSA9IDB4MTF9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTQwLCAu
aHNmcmVxcmFuZ2VfY29kZSA9IDB4MjF9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTUw
LCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MzF9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0g
MTYwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MDJ9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBz
ID0gMTcwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MTJ9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9t
YnBzID0gMTgwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MjJ9LAorCXsuZGVmYXVsdF9iaXRfcmF0
ZV9tYnBzID0gMTkwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MzJ9LAorCXsuZGVmYXVsdF9iaXRf
cmF0ZV9tYnBzID0gMjA1LCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MDN9LAorCXsuZGVmYXVsdF9i
aXRfcmF0ZV9tYnBzID0gMjIwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MTN9LAorCXsuZGVmYXVs
dF9iaXRfcmF0ZV9tYnBzID0gMjM1LCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MjN9LAorCXsuZGVm
YXVsdF9iaXRfcmF0ZV9tYnBzID0gMjUwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MzN9LAorCXsu
ZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMjc1LCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MDR9LAor
CXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMzAwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MTR9
LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMzI1LCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4
MjV9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMzUwLCAuaHNmcmVxcmFuZ2VfY29kZSA9
IDB4MzV9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gNDAwLCAuaHNmcmVxcmFuZ2VfY29k
ZSA9IDB4MDV9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gNDUwLCAuaHNmcmVxcmFuZ2Vf
Y29kZSA9IDB4MTZ9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gNTAwLCAuaHNmcmVxcmFu
Z2VfY29kZSA9IDB4MjZ9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gNTUwLCAuaHNmcmVx
cmFuZ2VfY29kZSA9IDB4Mzd9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gNjAwLCAuaHNm
cmVxcmFuZ2VfY29kZSA9IDB4MDd9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gNjUwLCAu
aHNmcmVxcmFuZ2VfY29kZSA9IDB4MTh9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gNzAw
LCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4Mjh9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0g
NzUwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4Mzl9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBz
ID0gODAwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MDl9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9t
YnBzID0gODUwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MTl9LAorCXsuZGVmYXVsdF9iaXRfcmF0
ZV9tYnBzID0gOTAwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4Mjl9LAorCXsuZGVmYXVsdF9iaXRf
cmF0ZV9tYnBzID0gMTAwMCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDBBfSwKKwl7LmRlZmF1bHRf
Yml0X3JhdGVfbWJwcyA9IDEwNTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgxQX0sCisJey5kZWZh
dWx0X2JpdF9yYXRlX21icHMgPSAxMTAwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MkF9LAorCXsu
ZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTE1MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDNCfSwK
Kwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDEyMDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgw
Qn0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxMjUwLCAuaHNmcmVxcmFuZ2VfY29kZSA9
IDB4MUJ9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTMwMCwgLmhzZnJlcXJhbmdlX2Nv
ZGUgPSAweDJCfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDEzNTAsIC5oc2ZyZXFyYW5n
ZV9jb2RlID0gMHgzQ30sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxNDAwLCAuaHNmcmVx
cmFuZ2VfY29kZSA9IDB4MEN9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTQ1MCwgLmhz
ZnJlcXJhbmdlX2NvZGUgPSAweDFDfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDE1MDAs
IC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgyQ30sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAx
NTUwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4M0R9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBz
ID0gMTYwMCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDBEfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVf
bWJwcyA9IDE2NTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgxRH0sCisJey5kZWZhdWx0X2JpdF9y
YXRlX21icHMgPSAxNzAwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MkV9LAorCXsuZGVmYXVsdF9i
aXRfcmF0ZV9tYnBzID0gMTc1MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDNFfSwKKwl7LmRlZmF1
bHRfYml0X3JhdGVfbWJwcyA9IDE4MDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgwRX0sCisJey5k
ZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxODUwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MUV9LAor
CXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTkwMCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDJG
fSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDE5NTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0g
MHgzRn0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAyMDAwLCAuaHNmcmVxcmFuZ2VfY29k
ZSA9IDB4MEZ9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMjA1MCwgLmhzZnJlcXJhbmdl
X2NvZGUgPSAweDQwfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDIxMDAsIC5oc2ZyZXFy
YW5nZV9jb2RlID0gMHg0MX0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAyMTUwLCAuaHNm
cmVxcmFuZ2VfY29kZSA9IDB4NDJ9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMjIwMCwg
LmhzZnJlcXJhbmdlX2NvZGUgPSAweDQzfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDIy
NTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHg0NH0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMg
PSAyMzAwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4NDV9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9t
YnBzID0gMjM1MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDQ2fSwKKwl7LmRlZmF1bHRfYml0X3Jh
dGVfbWJwcyA9IDI0MDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHg0N30sCisJey5kZWZhdWx0X2Jp
dF9yYXRlX21icHMgPSAyNDUwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4NDh9LAorCXsuZGVmYXVs
dF9iaXRfcmF0ZV9tYnBzID0gMjUwMCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDQ5fQorfTsKKwor
c3RhdGljIHZvaWQga21iX2RzaV9jbGtfZGlzYWJsZShzdHJ1Y3Qga21iX2RzaSAqa21iX2RzaSkK
K3sKKwljbGtfZGlzYWJsZV91bnByZXBhcmUoa21iX2RzaS0+Y2xrX21pcGkpOworCWNsa19kaXNh
YmxlX3VucHJlcGFyZShrbWJfZHNpLT5jbGtfbWlwaV9lY2ZnKTsKKwljbGtfZGlzYWJsZV91bnBy
ZXBhcmUoa21iX2RzaS0+Y2xrX21pcGlfY2ZnKTsKK30KKwordm9pZCBrbWJfZHNpX2hvc3RfdW5y
ZWdpc3RlcihzdHJ1Y3Qga21iX2RzaSAqa21iX2RzaSkKK3sKKwlrbWJfZHNpX2Nsa19kaXNhYmxl
KGttYl9kc2kpOworCW1pcGlfZHNpX2hvc3RfdW5yZWdpc3RlcihrbWJfZHNpLT5ob3N0KTsKK30K
KworLyoKKyAqIFRoaXMgRFNJIGNhbiBvbmx5IGJlIHBhaXJlZCB3aXRoIGJyaWRnZXMgdGhhdCBk
byBjb25maWcgdGhyb3VnaCBpMmMKKyAqIHdoaWNoIGlzIEFEViA3NTM1IGluIHRoZSBLTUIgRVZN
CisgKi8KK3N0YXRpYyBzc2l6ZV90IGttYl9kc2lfaG9zdF90cmFuc2ZlcihzdHJ1Y3QgbWlwaV9k
c2lfaG9zdCAqaG9zdCwKKwkJCQkgICAgIGNvbnN0IHN0cnVjdCBtaXBpX2RzaV9tc2cgKm1zZykK
K3sKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBrbWJfZHNpX2hvc3RfYXR0YWNoKHN0cnVj
dCBtaXBpX2RzaV9ob3N0ICpob3N0LAorCQkJICAgICAgIHN0cnVjdCBtaXBpX2RzaV9kZXZpY2Ug
KmRldikKK3sKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBrbWJfZHNpX2hvc3RfZGV0YWNo
KHN0cnVjdCBtaXBpX2RzaV9ob3N0ICpob3N0LAorCQkJICAgICAgIHN0cnVjdCBtaXBpX2RzaV9k
ZXZpY2UgKmRldikKK3sKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBtaXBp
X2RzaV9ob3N0X29wcyBrbWJfZHNpX2hvc3Rfb3BzID0geworCS5hdHRhY2ggPSBrbWJfZHNpX2hv
c3RfYXR0YWNoLAorCS5kZXRhY2ggPSBrbWJfZHNpX2hvc3RfZGV0YWNoLAorCS50cmFuc2ZlciA9
IGttYl9kc2lfaG9zdF90cmFuc2ZlciwKK307CisKK2ludCBrbWJfZHNpX2hvc3RfYnJpZGdlX2lu
aXQoc3RydWN0IGRldmljZSAqZGV2KQoreworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqZW5jb2Rlcl9u
b2RlLCAqZHNpX291dDsKKworCS8qIENyZWF0ZSBhbmQgcmVnaXN0ZXIgTUlQSSBEU0kgaG9zdCAq
LworCWlmICghZHNpX2hvc3QpIHsKKwkJZHNpX2hvc3QgPSBremFsbG9jKHNpemVvZigqZHNpX2hv
c3QpLCBHRlBfS0VSTkVMKTsKKwkJaWYgKCFkc2lfaG9zdCkKKwkJCXJldHVybiAtRU5PTUVNOwor
CisJCWRzaV9ob3N0LT5vcHMgPSAma21iX2RzaV9ob3N0X29wczsKKworCQlpZiAoIWRzaV9kZXZp
Y2UpIHsKKwkJCWRzaV9kZXZpY2UgPSBremFsbG9jKHNpemVvZigqZHNpX2RldmljZSksIEdGUF9L
RVJORUwpOworCQkJaWYgKCFkc2lfZGV2aWNlKSB7CisJCQkJa2ZyZWUoZHNpX2hvc3QpOworCQkJ
CXJldHVybiAtRU5PTUVNOworCQkJfQorCQl9CisKKwkJZHNpX2hvc3QtPmRldiA9IGRldjsKKwkJ
bWlwaV9kc2lfaG9zdF9yZWdpc3Rlcihkc2lfaG9zdCk7CisJfQorCisJLyogRmluZCBBRFY3NTM1
IG5vZGUgYW5kIGluaXRpYWxpemUgaXQgKi8KKwlkc2lfb3V0ID0gb2ZfZ3JhcGhfZ2V0X2VuZHBv
aW50X2J5X3JlZ3MoZGV2LT5vZl9ub2RlLCAwLCAxKTsKKwlpZiAoIWRzaV9vdXQpIHsKKwkJRFJN
X0VSUk9SKCJGYWlsZWQgdG8gZ2V0IGRzaV9vdXQgbm9kZSBpbmZvIGZyb20gRFRcbiIpOworCQly
ZXR1cm4gLUVJTlZBTDsKKwl9CisJZW5jb2Rlcl9ub2RlID0gb2ZfZ3JhcGhfZ2V0X3JlbW90ZV9w
b3J0X3BhcmVudChkc2lfb3V0KTsKKwlpZiAoIWVuY29kZXJfbm9kZSkgeworCQlvZl9ub2RlX3B1
dChkc2lfb3V0KTsKKwkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gZ2V0IGJyaWRnZSBpbmZvIGZyb20g
RFRcbiIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisJLyogTG9jYXRlIGRybSBicmlkZ2UgZnJv
bSB0aGUgaGRtaSBlbmNvZGVyIERUIG5vZGUgKi8KKwlhZHZfYnJpZGdlID0gb2ZfZHJtX2ZpbmRf
YnJpZGdlKGVuY29kZXJfbm9kZSk7CisJb2Zfbm9kZV9wdXQoZHNpX291dCk7CisJb2Zfbm9kZV9w
dXQoZW5jb2Rlcl9ub2RlKTsKKwlpZiAoIWFkdl9icmlkZ2UpIHsKKwkJRFJNX0RFQlVHKCJXYWl0
IGZvciBleHRlcm5hbCBicmlkZ2UgZHJpdmVyIERUXG4iKTsKKwkJcmV0dXJuIC1FUFJPQkVfREVG
RVI7CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB1MzIgbWlwaV9nZXRfZGF0YXR5cGVf
cGFyYW1zKHUzMiBkYXRhX3R5cGUsIHUzMiBkYXRhX21vZGUsCisJCQkJICAgIHN0cnVjdCBtaXBp
X2RhdGFfdHlwZV9wYXJhbXMgKnBhcmFtcykKK3sKKwlzdHJ1Y3QgbWlwaV9kYXRhX3R5cGVfcGFy
YW1zIGRhdGFfdHlwZV9wYXJhbTsKKworCXN3aXRjaCAoZGF0YV90eXBlKSB7CisJY2FzZSBEU0lf
TFBfRFRfUFBTX1lDQkNSNDIwXzEyQjoKKwkJZGF0YV90eXBlX3BhcmFtLnNpemVfY29uc3RyYWlu
dF9waXhlbHMgPSAyOworCQlkYXRhX3R5cGVfcGFyYW0uc2l6ZV9jb25zdHJhaW50X2J5dGVzID0g
MzsKKwkJc3dpdGNoIChkYXRhX21vZGUpIHsKKwkJCS8qIENhc2UgMCBub3Qgc3VwcG9ydGVkIGFj
Y29yZGluZyB0byBNREsgKi8KKwkJY2FzZSAxOgorCQljYXNlIDI6CisJCWNhc2UgMzoKKwkJCWRh
dGFfdHlwZV9wYXJhbS5waXhlbHNfcGVyX3BjbGsgPSAyOworCQkJZGF0YV90eXBlX3BhcmFtLmJp
dHNfcGVyX3BjbGsgPSAyNDsKKwkJCWJyZWFrOworCQlkZWZhdWx0OgorCQkJRFJNX0VSUk9SKCJE
U0k6IEludmFsaWQgZGF0YV9tb2RlICVkXG4iLCBkYXRhX21vZGUpOworCQkJcmV0dXJuIC1FSU5W
QUw7CisJCX07CisJCWJyZWFrOworCWNhc2UgRFNJX0xQX0RUX1BQU19ZQ0JDUjQyMl8xNkI6CisJ
CWRhdGFfdHlwZV9wYXJhbS5zaXplX2NvbnN0cmFpbnRfcGl4ZWxzID0gMjsKKwkJZGF0YV90eXBl
X3BhcmFtLnNpemVfY29uc3RyYWludF9ieXRlcyA9IDQ7CisJCXN3aXRjaCAoZGF0YV9tb2RlKSB7
CisJCQkvKiBDYXNlIDAgYW5kIDEgbm90IHN1cHBvcnRlZCBhY2NvcmRpbmcKKwkJCSAqIHRvIE1E
SworCQkJICovCisJCWNhc2UgMjoKKwkJCWRhdGFfdHlwZV9wYXJhbS5waXhlbHNfcGVyX3BjbGsg
PSAxOworCQkJZGF0YV90eXBlX3BhcmFtLmJpdHNfcGVyX3BjbGsgPSAxNjsKKwkJCWJyZWFrOwor
CQljYXNlIDM6CisJCQlkYXRhX3R5cGVfcGFyYW0ucGl4ZWxzX3Blcl9wY2xrID0gMjsKKwkJCWRh
dGFfdHlwZV9wYXJhbS5iaXRzX3Blcl9wY2xrID0gMzI7CisJCQlicmVhazsKKwkJZGVmYXVsdDoK
KwkJCURSTV9FUlJPUigiRFNJOiBJbnZhbGlkIGRhdGFfbW9kZSAlZFxuIiwgZGF0YV9tb2RlKTsK
KwkJCXJldHVybiAtRUlOVkFMOworCQl9OworCQlicmVhazsKKwljYXNlIERTSV9MUF9EVF9MUFBT
X1lDQkNSNDIyXzIwQjoKKwljYXNlIERTSV9MUF9EVF9QUFNfWUNCQ1I0MjJfMjRCOgorCQlkYXRh
X3R5cGVfcGFyYW0uc2l6ZV9jb25zdHJhaW50X3BpeGVscyA9IDI7CisJCWRhdGFfdHlwZV9wYXJh
bS5zaXplX2NvbnN0cmFpbnRfYnl0ZXMgPSA2OworCQlzd2l0Y2ggKGRhdGFfbW9kZSkgeworCQkJ
LyogQ2FzZSAwIG5vdCBzdXBwb3J0ZWQgYWNjb3JkaW5nIHRvIE1ESyAqLworCQljYXNlIDE6CisJ
CWNhc2UgMjoKKwkJY2FzZSAzOgorCQkJZGF0YV90eXBlX3BhcmFtLnBpeGVsc19wZXJfcGNsayA9
IDE7CisJCQlkYXRhX3R5cGVfcGFyYW0uYml0c19wZXJfcGNsayA9IDI0OworCQkJYnJlYWs7CisJ
CWRlZmF1bHQ6CisJCQlEUk1fRVJST1IoIkRTSTogSW52YWxpZCBkYXRhX21vZGUgJWRcbiIsIGRh
dGFfbW9kZSk7CisJCQlyZXR1cm4gLUVJTlZBTDsKKwkJfTsKKwkJYnJlYWs7CisJY2FzZSBEU0lf
TFBfRFRfUFBTX1JHQjU2NV8xNkI6CisJCWRhdGFfdHlwZV9wYXJhbS5zaXplX2NvbnN0cmFpbnRf
cGl4ZWxzID0gMTsKKwkJZGF0YV90eXBlX3BhcmFtLnNpemVfY29uc3RyYWludF9ieXRlcyA9IDI7
CisJCXN3aXRjaCAoZGF0YV9tb2RlKSB7CisJCWNhc2UgMDoKKwkJY2FzZSAxOgorCQkJZGF0YV90
eXBlX3BhcmFtLnBpeGVsc19wZXJfcGNsayA9IDE7CisJCQlkYXRhX3R5cGVfcGFyYW0uYml0c19w
ZXJfcGNsayA9IDE2OworCQkJYnJlYWs7CisJCWNhc2UgMjoKKwkJY2FzZSAzOgorCQkJZGF0YV90
eXBlX3BhcmFtLnBpeGVsc19wZXJfcGNsayA9IDI7CisJCQlkYXRhX3R5cGVfcGFyYW0uYml0c19w
ZXJfcGNsayA9IDMyOworCQkJYnJlYWs7CisJCWRlZmF1bHQ6CisJCQlEUk1fRVJST1IoIkRTSTog
SW52YWxpZCBkYXRhX21vZGUgJWRcbiIsIGRhdGFfbW9kZSk7CisJCQlyZXR1cm4gLUVJTlZBTDsK
KwkJfTsKKwkJYnJlYWs7CisJY2FzZSBEU0lfTFBfRFRfUFBTX1JHQjY2Nl8xOEI6CisJCWRhdGFf
dHlwZV9wYXJhbS5zaXplX2NvbnN0cmFpbnRfcGl4ZWxzID0gNDsKKwkJZGF0YV90eXBlX3BhcmFt
LnNpemVfY29uc3RyYWludF9ieXRlcyA9IDk7CisJCWRhdGFfdHlwZV9wYXJhbS5iaXRzX3Blcl9w
Y2xrID0gMTg7CisJCWRhdGFfdHlwZV9wYXJhbS5waXhlbHNfcGVyX3BjbGsgPSAxOworCQlicmVh
azsKKwljYXNlIERTSV9MUF9EVF9MUFBTX1JHQjY2Nl8xOEI6CisJY2FzZSBEU0lfTFBfRFRfUFBT
X1JHQjg4OF8yNEI6CisJCWRhdGFfdHlwZV9wYXJhbS5zaXplX2NvbnN0cmFpbnRfcGl4ZWxzID0g
MTsKKwkJZGF0YV90eXBlX3BhcmFtLnNpemVfY29uc3RyYWludF9ieXRlcyA9IDM7CisJCWRhdGFf
dHlwZV9wYXJhbS5iaXRzX3Blcl9wY2xrID0gMjQ7CisJCWRhdGFfdHlwZV9wYXJhbS5waXhlbHNf
cGVyX3BjbGsgPSAxOworCQlicmVhazsKKwljYXNlIERTSV9MUF9EVF9QUFNfUkdCMTAxMDEwXzMw
QjoKKwkJZGF0YV90eXBlX3BhcmFtLnNpemVfY29uc3RyYWludF9waXhlbHMgPSA0OworCQlkYXRh
X3R5cGVfcGFyYW0uc2l6ZV9jb25zdHJhaW50X2J5dGVzID0gMTU7CisJCWRhdGFfdHlwZV9wYXJh
bS5iaXRzX3Blcl9wY2xrID0gMzA7CisJCWRhdGFfdHlwZV9wYXJhbS5waXhlbHNfcGVyX3BjbGsg
PSAxOworCQlicmVhazsKKwlkZWZhdWx0OgorCQlEUk1fRVJST1IoIkRTSTogSW52YWxpZCBkYXRh
X3R5cGUgJWRcbiIsIGRhdGFfdHlwZSk7CisJCXJldHVybiAtRUlOVkFMOworCX07CisKKwkqcGFy
YW1zID0gZGF0YV90eXBlX3BhcmFtOworCXJldHVybiAwOworfQorCitzdGF0aWMgdTMyIGNvbXB1
dGVfd2ModTMyIHdpZHRoX3B4LCB1OCBzaXplX2NvbnN0cl9wLCB1OCBzaXplX2NvbnN0cl9iKQor
eworCS8qIENhbGN1bGF0ZSB0aGUgd29yZCBjb3VudCBmb3IgZWFjaCBsb25nIHBhY2tldCAqLwor
CXJldHVybiAoKCh3aWR0aF9weCAvIHNpemVfY29uc3RyX3ApICogc2l6ZV9jb25zdHJfYikgJiAw
eGZmZmYpOworfQorCitzdGF0aWMgdTMyIGNvbXB1dGVfdW5wYWNrZWRfYnl0ZXModTMyIHdjLCB1
OCBiaXRzX3Blcl9wY2xrKQoreworCS8qIE51bWJlciBvZiBQQ0xLIGN5Y2xlcyBuZWVkZWQgdG8g
dHJhbnNmZXIgYSBsaW5lCisJICogd2l0aCBlYWNoIFBDTEsgY3ljbGUsIDQgQnl0ZXMgYXJlIHNl
bnQgdGhyb3VnaCB0aGUgUFBMIG1vZHVsZQorCSAqLworCXJldHVybiAoKHdjICogOCkgLyBiaXRz
X3Blcl9wY2xrKSAqIDQ7Cit9CisKK3N0YXRpYyB1MzIgbWlwaV90eF9mZ19zZWN0aW9uX2NmZ19y
ZWdzKHN0cnVjdCBrbWJfZHNpICprbWJfZHNpLAorCQkJCSAgICAgICB1OCBmcmFtZV9pZCwgdTgg
c2VjdGlvbiwKKwkJCQkgICAgICAgdTMyIGhlaWdodF9saW5lcywgdTMyIHVucGFja2VkX2J5dGVz
LAorCQkJCSAgICAgICBzdHJ1Y3QgbWlwaV90eF9mcmFtZV9zZWN0X3BoY2ZnICpwaF9jZmcpCit7
CisJdTMyIGNmZyA9IDA7CisJdTMyIGN0cmxfbm8gPSBNSVBJX0NUUkw2OworCXUzMiByZWdfYWRy
OworCisJLyogRnJhbWUgc2VjdGlvbiBwYWNrZXQgaGVhZGVyICovCisJLyogV29yZCBjb3VudCBi
aXRzIFsxNTowXSAqLworCWNmZyA9IChwaF9jZmctPndjICYgTUlQSV9UWF9TRUNUX1dDX01BU0sp
IDw8IDA7CisKKwkvKiBEYXRhIHR5cGUgKGJpdHMgWzIxOjE2XSkgKi8KKwljZmcgfD0gKChwaF9j
ZmctPmRhdGFfdHlwZSAmIE1JUElfVFhfU0VDVF9EVF9NQVNLKQorCQk8PCBNSVBJX1RYX1NFQ1Rf
RFRfU0hJRlQpOworCisJLyogVmlydHVhbCBjaGFubmVsIChiaXRzIFsyMzoyMl0pICovCisJY2Zn
IHw9ICgocGhfY2ZnLT52Y2hhbm5lbCAmIE1JUElfVFhfU0VDVF9WQ19NQVNLKQorCQk8PCBNSVBJ
X1RYX1NFQ1RfVkNfU0hJRlQpOworCisJLyogRGF0YSBtb2RlIChiaXRzIFsyNDoyNV0pICovCisJ
Y2ZnIHw9ICgocGhfY2ZnLT5kYXRhX21vZGUgJiBNSVBJX1RYX1NFQ1RfRE1fTUFTSykKKwkJPDwg
TUlQSV9UWF9TRUNUX0RNX1NISUZUKTsKKwlpZiAocGhfY2ZnLT5kbWFfcGFja2VkKQorCQljZmcg
fD0gTUlQSV9UWF9TRUNUX0RNQV9QQUNLRUQ7CisKKwlkZXZfZGJnKGttYl9kc2ktPmRldiwKKwkJ
ImN0cmw9JWQgZnJhbWVfaWQ9JWQgc2VjdGlvbj0lZCBjZmc9JXggcGFja2VkPSVkXG4iLAorCQkg
IGN0cmxfbm8sIGZyYW1lX2lkLCBzZWN0aW9uLCBjZmcsIHBoX2NmZy0+ZG1hX3BhY2tlZCk7CisJ
a21iX3dyaXRlX21pcGkoa21iX2RzaSwKKwkJICAgICAgIChNSVBJX1RYbV9IU19GR25fU0VDVG9f
UEgoY3RybF9ubywgZnJhbWVfaWQsIHNlY3Rpb24pKSwKKwkJICAgICAgIGNmZyk7CisKKwkvKiBV
bnBhY2tlZCBieXRlcyAqLworCisJLyogVGhlcmUgYXJlIDQgZnJhbWUgZ2VuZXJhdG9ycyBhbmQg
ZWFjaCBmZyBoYXMgNCBzZWN0aW9ucworCSAqIFRoZXJlIGFyZSAyIHJlZ2lzdGVycyBmb3IgdW5w
YWNrZWQgYnl0ZXMgKCMgYnl0ZXMgZWFjaAorCSAqIHNlY3Rpb24gb2NjdXBpZXMgaW4gbWVtb3J5
KQorCSAqIFJFR19VTlBBQ0tFRF9CWVRFUzA6IFsxNTowXS1CWVRFUzAsIFszMToxNl0tQllURVMx
CisJICogUkVHX1VOUEFDS0VEX0JZVEVTMTogWzE1OjBdLUJZVEVTMiwgWzMxOjE2XS1CWVRFUzMK
KwkgKi8KKwlyZWdfYWRyID0KKwkgICAgTUlQSV9UWG1fSFNfRkduX1NFQ1RfVU5QQUNLRURfQllU
RVMwKGN0cmxfbm8sCisJCQkJCQkgZnJhbWVfaWQpICsgKHNlY3Rpb24gLyAyKSAqIDQ7CisJa21i
X3dyaXRlX2JpdHNfbWlwaShrbWJfZHNpLCByZWdfYWRyLCAoc2VjdGlvbiAlIDIpICogMTYsIDE2
LAorCQkJICAgIHVucGFja2VkX2J5dGVzKTsKKwlkZXZfZGJnKGttYl9kc2ktPmRldiwKKwkJInVu
cGFja2VkX2J5dGVzID0gJWQsIHdvcmRjb3VudCA9ICVkXG4iLCB1bnBhY2tlZF9ieXRlcywKKwkJ
ICBwaF9jZmctPndjKTsKKworCS8qIExpbmUgY29uZmlnICovCisJcmVnX2FkciA9IE1JUElfVFht
X0hTX0ZHbl9TRUNUb19MSU5FX0NGRyhjdHJsX25vLCBmcmFtZV9pZCwgc2VjdGlvbik7CisJa21i
X3dyaXRlX21pcGkoa21iX2RzaSwgcmVnX2FkciwgaGVpZ2h0X2xpbmVzKTsKKwlyZXR1cm4gMDsK
K30KKworc3RhdGljIHUzMiBtaXBpX3R4X2ZnX3NlY3Rpb25fY2ZnKHN0cnVjdCBrbWJfZHNpICpr
bWJfZHNpLAorCQkJCSAgdTggZnJhbWVfaWQsIHU4IHNlY3Rpb24sCisJCQkJICBzdHJ1Y3QgbWlw
aV90eF9mcmFtZV9zZWN0aW9uX2NmZyAqZnJhbWVfc2NmZywKKwkJCQkgIHUzMiAqYml0c19wZXJf
cGNsaywgdTMyICp3YykKK3sKKwl1MzIgcmV0ID0gMDsKKwl1MzIgdW5wYWNrZWRfYnl0ZXM7CisJ
c3RydWN0IG1pcGlfZGF0YV90eXBlX3BhcmFtcyBkYXRhX3R5cGVfcGFyYW1ldGVyczsKKwlzdHJ1
Y3QgbWlwaV90eF9mcmFtZV9zZWN0X3BoY2ZnIHBoX2NmZzsKKworCXJldCA9IG1pcGlfZ2V0X2Rh
dGF0eXBlX3BhcmFtcyhmcmFtZV9zY2ZnLT5kYXRhX3R5cGUsCisJCQkJICAgICAgIGZyYW1lX3Nj
ZmctPmRhdGFfbW9kZSwKKwkJCQkgICAgICAgJmRhdGFfdHlwZV9wYXJhbWV0ZXJzKTsKKwlpZiAo
cmV0KQorCQlyZXR1cm4gcmV0OworCisJLyogUGFja2V0IHdpZHRoIGhhcyB0byBiZSBhIG11bHRp
cGxlIG9mIHRoZSBtaW5pbXVtIHBhY2tldCB3aWR0aAorCSAqIChpbiBwaXhlbHMpIHNldCBmb3Ig
ZWFjaCBkYXRhIHR5cGUKKwkgKi8KKwlpZiAoZnJhbWVfc2NmZy0+d2lkdGhfcGl4ZWxzICUKKwkg
ICAgZGF0YV90eXBlX3BhcmFtZXRlcnMuc2l6ZV9jb25zdHJhaW50X3BpeGVscyAhPSAwKQorCQly
ZXR1cm4gLUVJTlZBTDsKKworCSp3YyA9IGNvbXB1dGVfd2MoZnJhbWVfc2NmZy0+d2lkdGhfcGl4
ZWxzLAorCQkJIGRhdGFfdHlwZV9wYXJhbWV0ZXJzLnNpemVfY29uc3RyYWludF9waXhlbHMsCisJ
CQkgZGF0YV90eXBlX3BhcmFtZXRlcnMuc2l6ZV9jb25zdHJhaW50X2J5dGVzKTsKKwl1bnBhY2tl
ZF9ieXRlcyA9IGNvbXB1dGVfdW5wYWNrZWRfYnl0ZXMoKndjLAorCQkJCQkJZGF0YV90eXBlX3Bh
cmFtZXRlcnMuYml0c19wZXJfcGNsayk7CisJcGhfY2ZnLndjID0gKndjOworCXBoX2NmZy5kYXRh
X21vZGUgPSBmcmFtZV9zY2ZnLT5kYXRhX21vZGU7CisJcGhfY2ZnLmRhdGFfdHlwZSA9IGZyYW1l
X3NjZmctPmRhdGFfdHlwZTsKKwlwaF9jZmcuZG1hX3BhY2tlZCA9IGZyYW1lX3NjZmctPmRtYV9w
YWNrZWQ7CisJcGhfY2ZnLnZjaGFubmVsID0gZnJhbWVfaWQ7CisKKwltaXBpX3R4X2ZnX3NlY3Rp
b25fY2ZnX3JlZ3Moa21iX2RzaSwgZnJhbWVfaWQsIHNlY3Rpb24sCisJCQkJICAgIGZyYW1lX3Nj
ZmctPmhlaWdodF9saW5lcywKKwkJCQkgICAgdW5wYWNrZWRfYnl0ZXMsICZwaF9jZmcpOworCisJ
LyogQ2FsbGVyIG5lZWRzIGJpdHNfcGVyX2NsayBmb3IgYWRkaXRpb25hbCBjYWx1Y2xhdGlvbnMg
Ki8KKwkqYml0c19wZXJfcGNsayA9IGRhdGFfdHlwZV9wYXJhbWV0ZXJzLmJpdHNfcGVyX3BjbGs7
CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgbWlwaV90eF9mZ19jZmdfcmVncyhzdHJ1
Y3Qga21iX2RzaSAqa21iX2RzaSwgdTggZnJhbWVfZ2VuLAorCQkJCXN0cnVjdCBtaXBpX3R4X2Zy
YW1lX3RpbWluZ19jZmcgKmZnX2NmZykKK3sKKwl1MzIgc3lzY2xrOworCXUzMiBwcGxfbGxwX3Jh
dGlvOworCXUzMiBjdHJsX25vID0gTUlQSV9DVFJMNiwgcmVnX2FkciwgdmFsLCBvZmZzZXQ7CisK
KwkvKiA1MDAgTWh6IHN5c3RlbSBjbG9jayBtaW51cyA1MCB0byBhY2NvdW50IGZvciB0aGUgZGlm
ZmVyZW5jZSBpbgorCSAqIE1JUEkgY2xvY2sgc3BlZWQgaW4gUlRMIHRlc3RzCisJICovCisJc3lz
Y2xrID0ga21iX2RzaS0+c3lzX2Nsa19taHogLSA1MDsKKworCS8qIFBQTC1QaXhlbCBQYWNraW5n
IExheWVyLCBMTFAtTG93IExldmVsIFByb3RvY29sCisJICogRnJhbWUgZ2VuYXJ0b3IgdGltaW5n
IHBhcmFtZXRlcnMgYXJlIGNsb2NrZWQgb24gdGhlIHN5c3RlbSBjbG9jaywKKwkgKiB3aGVyZWFz
IGFzIHRoZSBlcXVpdmFsZW50IHBhcmFtZXRlcnMgaW4gdGhlIExMUCBibG9ja3MgYXJlIGNsb2Nr
ZWQKKwkgKiBvbiBMTFAgVHggY2xvY2sgZnJvbSB0aGUgRC1QSFkgLSBCWVRFIGNsb2NrCisJICov
CisKKwkvKiBNdWx0aXBseSBieSAxMDAwIHRvIG1haW50YWluIHByZWNpc2lvbiAqLworCXBwbF9s
bHBfcmF0aW8gPSAoKGZnX2NmZy0+YnBwIC8gOCkgKiBzeXNjbGsgKiAxMDAwKSAvCisJICAgICgo
ZmdfY2ZnLT5sYW5lX3JhdGVfbWJwcyAvIDgpICogZmdfY2ZnLT5hY3RpdmVfbGFuZXMpOworCisJ
ZGV2X2RiZyhrbWJfZHNpLT5kZXYsICJwcGxfbGxwX3JhdGlvPSVkXG4iLCBwcGxfbGxwX3JhdGlv
KTsKKwlkZXZfZGJnKGttYl9kc2ktPmRldiwgImJwcD0lZCBzeXNjbGs9JWQgbGFuZS1yYXRlPSVk
IGFjdGl2ZS1sYW5lcz0lZFxuIiwKKwkJZmdfY2ZnLT5icHAsIHN5c2NsaywgZmdfY2ZnLT5sYW5l
X3JhdGVfbWJwcywKKwkJIGZnX2NmZy0+YWN0aXZlX2xhbmVzKTsKKworCS8qIEZyYW1lIGdlbmVy
YXRvciBudW1iZXIgb2YgbGluZXMgKi8KKwlyZWdfYWRyID0gTUlQSV9UWG1fSFNfRkduX05VTV9M
SU5FUyhjdHJsX25vLCBmcmFtZV9nZW4pOworCWttYl93cml0ZV9taXBpKGttYl9kc2ksIHJlZ19h
ZHIsIGZnX2NmZy0+dl9hY3RpdmUpOworCisJLyogdnN5bmMgd2lkdGgKKwkgKiBUaGVyZSBhcmUg
MiByZWdpc3RlcnMgZm9yIHZzeW5jIHdpZHRoIChWU0EgaW4gbGluZXMgZm9yCisJICogY2hhbm5l
bHMgMC0zKQorCSAqIFJFR19WU1lOQ19XSURUSDA6IFsxNTowXS1WU0EgZm9yIGNoYW5uZWwwLCBb
MzE6MTZdLVZTQSBmb3IgY2hhbm5lbDEKKwkgKiBSRUdfVlNZTkNfV0lEVEgxOiBbMTU6MF0tVlNB
IGZvciBjaGFubmVsMiwgWzMxOjE2XS1WU0EgZm9yIGNoYW5uZWwzCisJICovCisJb2Zmc2V0ID0g
KGZyYW1lX2dlbiAlIDIpICogMTY7CisJcmVnX2FkciA9IE1JUElfVFhtX0hTX1ZTWU5DX1dJRFRI
bihjdHJsX25vLCBmcmFtZV9nZW4gLyAyKTsKKwlrbWJfd3JpdGVfYml0c19taXBpKGttYl9kc2ks
IHJlZ19hZHIsIG9mZnNldCwgMTYsIGZnX2NmZy0+dnN5bmNfd2lkdGgpOworCisJLyogdmVydGlj
YWwgYmFja3BvcmNoICh2YnApICovCisJcmVnX2FkciA9IE1JUElfVFhtX0hTX1ZfQkFDS1BPUkNI
RVNuKGN0cmxfbm8sIGZyYW1lX2dlbiAvIDIpOworCWttYl93cml0ZV9iaXRzX21pcGkoa21iX2Rz
aSwgcmVnX2Fkciwgb2Zmc2V0LCAxNiwgZmdfY2ZnLT52X2JhY2twb3JjaCk7CisKKwkvKiB2ZXJ0
aWNhbCBmcm9udHBvcmNoICh2ZnApICovCisJcmVnX2FkciA9IE1JUElfVFhtX0hTX1ZfRlJPTlRQ
T1JDSEVTbihjdHJsX25vLCBmcmFtZV9nZW4gLyAyKTsKKwlrbWJfd3JpdGVfYml0c19taXBpKGtt
Yl9kc2ksIHJlZ19hZHIsIG9mZnNldCwgMTYsIGZnX2NmZy0+dl9mcm9udHBvcmNoKTsKKworCS8q
IHZlcnRpY2FsIGFjdGl2ZSAodmFjdGl2ZSkgKi8KKwlyZWdfYWRyID0gTUlQSV9UWG1fSFNfVl9B
Q1RJVkVuKGN0cmxfbm8sIGZyYW1lX2dlbiAvIDIpOworCWttYl93cml0ZV9iaXRzX21pcGkoa21i
X2RzaSwgcmVnX2Fkciwgb2Zmc2V0LCAxNiwgZmdfY2ZnLT52X2FjdGl2ZSk7CisKKwkvKiBoc3lu
YyB3aWR0aCAqLworCXJlZ19hZHIgPSBNSVBJX1RYbV9IU19IU1lOQ19XSURUSG4oY3RybF9ubywg
ZnJhbWVfZ2VuKTsKKwlrbWJfd3JpdGVfbWlwaShrbWJfZHNpLCByZWdfYWRyLAorCQkgICAgICAg
KGZnX2NmZy0+aHN5bmNfd2lkdGggKiBwcGxfbGxwX3JhdGlvKSAvIDEwMDApOworCisJLyogaG9y
aXpvbnRhbCBiYWNrcG9yY2ggKGhicCkgKi8KKwlyZWdfYWRyID0gTUlQSV9UWG1fSFNfSF9CQUNL
UE9SQ0huKGN0cmxfbm8sIGZyYW1lX2dlbik7CisJa21iX3dyaXRlX21pcGkoa21iX2RzaSwgcmVn
X2FkciwKKwkJICAgICAgIChmZ19jZmctPmhfYmFja3BvcmNoICogcHBsX2xscF9yYXRpbykgLyAx
MDAwKTsKKworCS8qIGhvcml6b250YWwgZnJvbnRwb3JjaCAoaGZwKSAqLworCXJlZ19hZHIgPSBN
SVBJX1RYbV9IU19IX0ZST05UUE9SQ0huKGN0cmxfbm8sIGZyYW1lX2dlbik7CisJa21iX3dyaXRl
X21pcGkoa21iX2RzaSwgcmVnX2FkciwKKwkJICAgICAgIChmZ19jZmctPmhfZnJvbnRwb3JjaCAq
IHBwbF9sbHBfcmF0aW8pIC8gMTAwMCk7CisKKwkvKiBob3Jpem9udGFsIGFjdGl2ZSAoaGEpICov
CisJcmVnX2FkciA9IE1JUElfVFhtX0hTX0hfQUNUSVZFbihjdHJsX25vLCBmcmFtZV9nZW4pOwor
CisJLyogY29udmVydCBoX2FjdGl2ZSB3aGljaCBpcyB3YyBpbiBieXRlcyB0byBjeWNsZXMgKi8K
Kwl2YWwgPSAoZmdfY2ZnLT5oX2FjdGl2ZSAqIHN5c2NsayAqIDEwMDApIC8KKwkgICAgKChmZ19j
ZmctPmxhbmVfcmF0ZV9tYnBzIC8gOCkgKiBmZ19jZmctPmFjdGl2ZV9sYW5lcyk7CisJdmFsIC89
IDEwMDA7CisJa21iX3dyaXRlX21pcGkoa21iX2RzaSwgcmVnX2FkciwgdmFsKTsKKworCS8qIGxs
cCBoc3luYyB3aWR0aCAqLworCXJlZ19hZHIgPSBNSVBJX1RYbV9IU19MTFBfSFNZTkNfV0lEVEhu
KGN0cmxfbm8sIGZyYW1lX2dlbik7CisJa21iX3dyaXRlX21pcGkoa21iX2RzaSwgcmVnX2Fkciwg
ZmdfY2ZnLT5oc3luY193aWR0aCAqIChmZ19jZmctPmJwcCAvIDgpKTsKKworCS8qIGxscCBoIGJh
Y2twb3JjaCAqLworCXJlZ19hZHIgPSBNSVBJX1RYbV9IU19MTFBfSF9CQUNLUE9SQ0huKGN0cmxf
bm8sIGZyYW1lX2dlbik7CisJa21iX3dyaXRlX21pcGkoa21iX2RzaSwgcmVnX2FkciwgZmdfY2Zn
LT5oX2JhY2twb3JjaCAqIChmZ19jZmctPmJwcCAvIDgpKTsKKworCS8qIGxscCBoIGZyb250cG9y
Y2ggKi8KKwlyZWdfYWRyID0gTUlQSV9UWG1fSFNfTExQX0hfRlJPTlRQT1JDSG4oY3RybF9ubywg
ZnJhbWVfZ2VuKTsKKwlrbWJfd3JpdGVfbWlwaShrbWJfZHNpLCByZWdfYWRyLAorCQkgICAgICAg
ZmdfY2ZnLT5oX2Zyb250cG9yY2ggKiAoZmdfY2ZnLT5icHAgLyA4KSk7Cit9CisKK3N0YXRpYyB2
b2lkIG1pcGlfdHhfZmdfY2ZnKHN0cnVjdCBrbWJfZHNpICprbWJfZHNpLCB1OCBmcmFtZV9nZW4s
CisJCQkgICB1OCBhY3RpdmVfbGFuZXMsIHUzMiBicHAsIHUzMiB3YywKKwkJCSAgIHUzMiBsYW5l
X3JhdGVfbWJwcywgc3RydWN0IG1pcGlfdHhfZnJhbWVfY2ZnICpmZ19jZmcpCit7CisJdTMyIGks
IGZnX251bV9saW5lcyA9IDA7CisJc3RydWN0IG1pcGlfdHhfZnJhbWVfdGltaW5nX2NmZyBmZ190
X2NmZzsKKworCS8qIENhbGN1bGF0ZSB0aGUgdG90YWwgZnJhbWUgZ2VuZXJhdG9yIG51bWJlciBv
ZgorCSAqIGxpbmVzIGJhc2VkIG9uIGl0J3MgYWN0aXZlIHNlY3Rpb25zCisJICovCisJZm9yIChp
ID0gMDsgaSA8IE1JUElfVFhfRlJBTUVfR0VOX1NFQ1RJT05TOyBpKyspIHsKKwkJaWYgKGZnX2Nm
Zy0+c2VjdGlvbnNbaV0pCisJCQlmZ19udW1fbGluZXMgKz0gZmdfY2ZnLT5zZWN0aW9uc1tpXS0+
aGVpZ2h0X2xpbmVzOworCX0KKworCWZnX3RfY2ZnLmJwcCA9IGJwcDsKKwlmZ190X2NmZy5sYW5l
X3JhdGVfbWJwcyA9IGxhbmVfcmF0ZV9tYnBzOworCWZnX3RfY2ZnLmhzeW5jX3dpZHRoID0gZmdf
Y2ZnLT5oc3luY193aWR0aDsKKwlmZ190X2NmZy5oX2JhY2twb3JjaCA9IGZnX2NmZy0+aF9iYWNr
cG9yY2g7CisJZmdfdF9jZmcuaF9mcm9udHBvcmNoID0gZmdfY2ZnLT5oX2Zyb250cG9yY2g7CisJ
ZmdfdF9jZmcuaF9hY3RpdmUgPSB3YzsKKwlmZ190X2NmZy52c3luY193aWR0aCA9IGZnX2NmZy0+
dnN5bmNfd2lkdGg7CisJZmdfdF9jZmcudl9iYWNrcG9yY2ggPSBmZ19jZmctPnZfYmFja3BvcmNo
OworCWZnX3RfY2ZnLnZfZnJvbnRwb3JjaCA9IGZnX2NmZy0+dl9mcm9udHBvcmNoOworCWZnX3Rf
Y2ZnLnZfYWN0aXZlID0gZmdfbnVtX2xpbmVzOworCWZnX3RfY2ZnLmFjdGl2ZV9sYW5lcyA9IGFj
dGl2ZV9sYW5lczsKKworCS8qIEFwcGx5IGZyYW1lIGdlbmVyYXRvciB0aW1pbmcgc2V0dGluZyAq
LworCW1pcGlfdHhfZmdfY2ZnX3JlZ3Moa21iX2RzaSwgZnJhbWVfZ2VuLCAmZmdfdF9jZmcpOwor
fQorCitzdGF0aWMgdm9pZCBtaXBpX3R4X211bHRpY2hhbm5lbF9maWZvX2NmZyhzdHJ1Y3Qga21i
X2RzaSAqa21iX2RzaSwKKwkJCQkJICB1OCBhY3RpdmVfbGFuZXMsIHU4IHZjaGFubmVsX2lkKQor
eworCXUzMiBmaWZvX3NpemUsIGZpZm9fcnRocmVzaG9sZDsKKwl1MzIgY3RybF9ubyA9IE1JUElf
Q1RSTDY7CisKKwkvKiBDbGVhciBhbGwgbWMgZmlmbyBjaGFubmVsIHNpemVzIGFuZCB0aHJlc2hv
bGRzICovCisJa21iX3dyaXRlX21pcGkoa21iX2RzaSwgTUlQSV9UWF9IU19NQ19GSUZPX0NUUkxf
RU4sIDApOworCWttYl93cml0ZV9taXBpKGttYl9kc2ksIE1JUElfVFhfSFNfTUNfRklGT19DSEFO
X0FMTE9DMCwgMCk7CisJa21iX3dyaXRlX21pcGkoa21iX2RzaSwgTUlQSV9UWF9IU19NQ19GSUZP
X0NIQU5fQUxMT0MxLCAwKTsKKwlrbWJfd3JpdGVfbWlwaShrbWJfZHNpLCBNSVBJX1RYX0hTX01D
X0ZJRk9fUlRIUkVTSE9MRDAsIDApOworCWttYl93cml0ZV9taXBpKGttYl9kc2ksIE1JUElfVFhf
SFNfTUNfRklGT19SVEhSRVNIT0xEMSwgMCk7CisKKwlmaWZvX3NpemUgPSAoKGFjdGl2ZV9sYW5l
cyA+IE1JUElfRF9MQU5FU19QRVJfRFBIWSkgPworCQkgICAgIE1JUElfQ1RSTF80TEFORV9NQVhf
TUNfRklGT19MT0MgOgorCQkgICAgIE1JUElfQ1RSTF8yTEFORV9NQVhfTUNfRklGT19MT0MpIC0g
MTsKKworCS8qIE1DIGZpZm8gc2l6ZSBmb3IgdmlydHVhbCBjaGFubmVscyAwLTMKKwkgKiBSRUdf
TUNfRklGT19DSEFOX0FMTE9DMDogWzg6MF0tY2hhbm5lbDAsIFsyNDoxNl0tY2hhbm5lbDEKKwkg
KiBSRUdfTUNfRklGT19DSEFOX0FMTE9DMTogWzg6MF0tMiwgWzI0OjE2XS1jaGFubmVsMworCSAq
LworCVNFVF9NQ19GSUZPX0NIQU5fQUxMT0Moa21iX2RzaSwgY3RybF9ubywgdmNoYW5uZWxfaWQs
IGZpZm9fc2l6ZSk7CisKKwkvKiBTZXQgdGhyZXNob2xkIHRvIGhhbGYgdGhlIGZpZm8gc2l6ZSwg
YWN0dWFsIHNpemU9c2l6ZSoxNiAqLworCWZpZm9fcnRocmVzaG9sZCA9ICgoZmlmb19zaXplKSAq
IDgpICYgQklUX01BU0tfMTY7CisJU0VUX01DX0ZJRk9fUlRIUkVTSE9MRChrbWJfZHNpLCBjdHJs
X25vLCB2Y2hhbm5lbF9pZCwgZmlmb19ydGhyZXNob2xkKTsKKworCS8qIEVuYWJsZSB0aGUgTUMg
RklGTyBjaGFubmVsIGNvcnJlc3BvbmRpbmcgdG8gdGhlIFZpcnR1YWwgQ2hhbm5lbCAqLworCWtt
Yl9zZXRfYml0X21pcGkoa21iX2RzaSwgTUlQSV9UWG1fSFNfTUNfRklGT19DVFJMX0VOKGN0cmxf
bm8pLAorCQkJIHZjaGFubmVsX2lkKTsKK30KKworc3RhdGljIHZvaWQgbWlwaV90eF9jdHJsX2Nm
ZyhzdHJ1Y3Qga21iX2RzaSAqa21iX2RzaSwgdTggZmdfaWQsCisJCQkgICAgIHN0cnVjdCBtaXBp
X2N0cmxfY2ZnICpjdHJsX2NmZykKK3sKKwl1MzIgc3luY19jZmcgPSAwLCBjdHJsID0gMCwgZmdf
ZW47CisJdTMyIGN0cmxfbm8gPSBNSVBJX0NUUkw2OworCisJLyogTUlQSV9UWF9IU19TWU5DX0NG
RyAqLworCWlmIChjdHJsX2NmZy0+dHhfY3RybF9jZmcubGluZV9zeW5jX3BrdF9lbikKKwkJc3lu
Y19jZmcgfD0gTElORV9TWU5DX1BLVF9FTkFCTEU7CisJaWYgKGN0cmxfY2ZnLT50eF9jdHJsX2Nm
Zy5mcmFtZV9jb3VudGVyX2FjdGl2ZSkKKwkJc3luY19jZmcgfD0gRlJBTUVfQ09VTlRFUl9BQ1RJ
VkU7CisJaWYgKGN0cmxfY2ZnLT50eF9jdHJsX2NmZy5saW5lX2NvdW50ZXJfYWN0aXZlKQorCQlz
eW5jX2NmZyB8PSBMSU5FX0NPVU5URVJfQUNUSVZFOworCWlmIChjdHJsX2NmZy0+dHhfY3RybF9j
ZmcudHhfZHNpX2NmZy0+dl9ibGFua2luZykKKwkJc3luY19jZmcgfD0gRFNJX1ZfQkxBTktJTkc7
CisJaWYgKGN0cmxfY2ZnLT50eF9jdHJsX2NmZy50eF9kc2lfY2ZnLT5oc2FfYmxhbmtpbmcpCisJ
CXN5bmNfY2ZnIHw9IERTSV9IU0FfQkxBTktJTkc7CisJaWYgKGN0cmxfY2ZnLT50eF9jdHJsX2Nm
Zy50eF9kc2lfY2ZnLT5oYnBfYmxhbmtpbmcpCisJCXN5bmNfY2ZnIHw9IERTSV9IQlBfQkxBTktJ
Tkc7CisJaWYgKGN0cmxfY2ZnLT50eF9jdHJsX2NmZy50eF9kc2lfY2ZnLT5oZnBfYmxhbmtpbmcp
CisJCXN5bmNfY2ZnIHw9IERTSV9IRlBfQkxBTktJTkc7CisJaWYgKGN0cmxfY2ZnLT50eF9jdHJs
X2NmZy50eF9kc2lfY2ZnLT5zeW5jX3B1bHNlX2V2ZW50bikKKwkJc3luY19jZmcgfD0gRFNJX1NZ
TkNfUFVMU0VfRVZFTlROOworCWlmIChjdHJsX2NmZy0+dHhfY3RybF9jZmcudHhfZHNpX2NmZy0+
bHBtX2ZpcnN0X3ZzYV9saW5lKQorCQlzeW5jX2NmZyB8PSBEU0lfTFBNX0ZJUlNUX1ZTQV9MSU5F
OworCWlmIChjdHJsX2NmZy0+dHhfY3RybF9jZmcudHhfZHNpX2NmZy0+bHBtX2xhc3RfdmZwX2xp
bmUpCisJCXN5bmNfY2ZnIHw9IERTSV9MUE1fTEFTVF9WRlBfTElORTsKKworCS8qIEVuYWJsZSBm
cmFtZSBnZW5lcmF0b3IgKi8KKwlmZ19lbiA9IDEgPDwgZmdfaWQ7CisJc3luY19jZmcgfD0gRlJB
TUVfR0VOX0VOKGZnX2VuKTsKKworCWlmIChjdHJsX2NmZy0+dHhfY3RybF9jZmcudHhfYWx3YXlz
X3VzZV9oYWN0KQorCQlzeW5jX2NmZyB8PSBBTFdBWVNfVVNFX0hBQ1QoZmdfZW4pOworCWlmIChj
dHJsX2NmZy0+dHhfY3RybF9jZmcudHhfaGFjdF93YWl0X3N0b3ApCisJCXN5bmNfY2ZnIHw9IEhB
Q1RfV0FJVF9TVE9QKGZnX2VuKTsKKworCWRldl9kYmcoa21iX2RzaS0+ZGV2LCAic3luY19jZmc9
JWQgZmdfZW49JWRcbiIsIHN5bmNfY2ZnLCBmZ19lbik7CisKKwkvKiBNSVBJX1RYX0hTX0NUUkwg
Ki8KKworCS8qIHR5cGU6RFNJLCBzb3VyY2U6TENEICovCisJY3RybCA9IEhTX0NUUkxfRU4gfCBU
WF9TT1VSQ0U7CisJY3RybCB8PSBMQ0RfVkMoZmdfaWQpOworCWN0cmwgfD0gQUNUSVZFX0xBTkVT
KGN0cmxfY2ZnLT5hY3RpdmVfbGFuZXMgLSAxKTsKKwlpZiAoY3RybF9jZmctPnR4X2N0cmxfY2Zn
LnR4X2RzaV9jZmctPmVvdHBfZW4pCisJCWN0cmwgfD0gRFNJX0VPVFBfRU47CisJaWYgKGN0cmxf
Y2ZnLT50eF9jdHJsX2NmZy50eF9kc2lfY2ZnLT5oZnBfYmxhbmtfZW4pCisJCWN0cmwgfD0gRFNJ
X0NNRF9IRlBfRU47CisKKwkvKjY3IG5zIHN0b3AgdGltZSAqLworCWN0cmwgfD0gSFNFWElUX0NO
VCgweDQzKTsKKworCWttYl93cml0ZV9taXBpKGttYl9kc2ksIE1JUElfVFhtX0hTX1NZTkNfQ0ZH
KGN0cmxfbm8pLCBzeW5jX2NmZyk7CisJa21iX3dyaXRlX21pcGkoa21iX2RzaSwgTUlQSV9UWG1f
SFNfQ1RSTChjdHJsX25vKSwgY3RybCk7Cit9CisKK3N0YXRpYyB1MzIgbWlwaV90eF9pbml0X2Nu
dHJsKHN0cnVjdCBrbWJfZHNpICprbWJfZHNpLAorCQkJICAgICAgc3RydWN0IG1pcGlfY3RybF9j
ZmcgKmN0cmxfY2ZnKQoreworCXUzMiByZXQgPSAwOworCXU4IGFjdGl2ZV92Y2hhbm5lbHMgPSAw
OworCXU4IGZyYW1lX2lkLCBzZWN0OworCXUzMiBiaXRzX3Blcl9wY2xrID0gMDsKKwl1MzIgd29y
ZF9jb3VudCA9IDA7CisJc3RydWN0IG1pcGlfdHhfZnJhbWVfY2ZnICpmcmFtZTsKKworCS8qIFRo
aXMgaXMgdGhlIG9yZGVyIHRvIGluaXRpYWxpemUgTUlQSSBUWDoKKwkgKiAxLiBzZXQgZnJhbWUg
c2VjdGlvbiBwYXJhbWV0ZXJzCisJICogMi4gc2V0IGZyYW1lIHNwZWNpZmljIHBhcmFtZXRlcnMK
KwkgKiAzLiBjb25uZWN0IGxjZCB0byBtaXBpCisJICogNC4gbXVsdGkgY2hhbm5lbCBmaWZvIGNm
ZworCSAqIDUuIHNldCBtaXBpdHhjY3RybGNmZworCSAqLworCisJZm9yIChmcmFtZV9pZCA9IDA7
IGZyYW1lX2lkIDwgNDsgZnJhbWVfaWQrKykgeworCQlmcmFtZSA9IGN0cmxfY2ZnLT50eF9jdHJs
X2NmZy5mcmFtZXNbZnJhbWVfaWRdOworCisJCS8qIEZpbmQgdmFsaWQgZnJhbWUsIGFzc3VtZSBv
bmx5IG9uZSB2YWxpZCBmcmFtZSAqLworCQlpZiAoIWZyYW1lKQorCQkJY29udGludWU7CisKKwkJ
LyogRnJhbWUgU2VjdGlvbiBjb25maWd1cmF0aW9uICovCisJCS8qIFRPRE8gLSBhc3N1bWUgdGhl
cmUgaXMgb25seSBvbmUgdmFsaWQgc2VjdGlvbiBpbiBhIGZyYW1lLAorCQkgKiBzbyBiaXRzX3Bl
cl9wY2xrIGFuZCB3b3JkX2NvdW50IGFyZSBvbmx5IHNldCBvbmNlCisJCSAqLworCQlmb3IgKHNl
Y3QgPSAwOyBzZWN0IDwgTUlQSV9DVFJMX1ZJUlRVQUxfQ0hBTk5FTFM7IHNlY3QrKykgeworCQkJ
aWYgKCFmcmFtZS0+c2VjdGlvbnNbc2VjdF0pCisJCQkJY29udGludWU7CisKKwkJCXJldCA9IG1p
cGlfdHhfZmdfc2VjdGlvbl9jZmcoa21iX2RzaSwgZnJhbWVfaWQsIHNlY3QsCisJCQkJCQkgICAg
IGZyYW1lLT5zZWN0aW9uc1tzZWN0XSwKKwkJCQkJCSAgICAgJmJpdHNfcGVyX3BjbGssCisJCQkJ
CQkgICAgICZ3b3JkX2NvdW50KTsKKwkJCWlmIChyZXQpCisJCQkJcmV0dXJuIHJldDsKKwkJfQor
CisJCS8qIFNldCBmcmFtZSBzcGVjaWZpYyBwYXJhbWV0ZXJzICovCisJCW1pcGlfdHhfZmdfY2Zn
KGttYl9kc2ksIGZyYW1lX2lkLCBjdHJsX2NmZy0+YWN0aXZlX2xhbmVzLAorCQkJICAgICAgIGJp
dHNfcGVyX3BjbGssIHdvcmRfY291bnQsCisJCQkgICAgICAgY3RybF9jZmctPmxhbmVfcmF0ZV9t
YnBzLCBmcmFtZSk7CisKKwkJYWN0aXZlX3ZjaGFubmVscysrOworCisJCS8qIFN0b3AgaXRlcmF0
aW5nIGFzIG9ubHkgb25lIHZpcnR1YWwgY2hhbm5lbAorCQkgKiBzaGFsbCBiZSB1c2VkIGZvciBM
Q0QgY29ubmVjdGlvbgorCQkgKi8KKwkJYnJlYWs7CisJfQorCisJaWYgKGFjdGl2ZV92Y2hhbm5l
bHMgPT0gMCkKKwkJcmV0dXJuIC1FSU5WQUw7CisJLyogTXVsdGktQ2hhbm5lbCBGSUZPIENvbmZp
Z3VyYXRpb24gKi8KKwltaXBpX3R4X211bHRpY2hhbm5lbF9maWZvX2NmZyhrbWJfZHNpLCBjdHJs
X2NmZy0+YWN0aXZlX2xhbmVzLCBmcmFtZV9pZCk7CisKKwkvKiBGcmFtZSBHZW5lcmF0b3IgRW5h
YmxlICovCisJbWlwaV90eF9jdHJsX2NmZyhrbWJfZHNpLCBmcmFtZV9pZCwgY3RybF9jZmcpOwor
CisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIHZvaWQgdGVzdF9tb2RlX3NlbmQoc3RydWN0IGtt
Yl9kc2kgKmttYl9kc2ksIHUzMiBkcGh5X25vLAorCQkJICAgdTMyIHRlc3RfY29kZSwgdTMyIHRl
c3RfZGF0YSkKK3sKKwkvKiBTdGVwcyB0byBzZW5kIHRlc3QgY29kZToKKwkgKiAtIHNldCB0ZXN0
Y2xrIEhJR0gKKwkgKiAtIHNldCB0ZXN0ZGluIHdpdGggdGVzdCBjb2RlCisJICogLSBzZXQgdGVz
dGVuIEhJR0gKKwkgKiAtIHNldCB0ZXN0Y2xrIExPVworCSAqIC0gc2V0IHRlc3RlbiBMT1cKKwkg
Ki8KKworCS8qIFNldCB0ZXN0Y2xrIGhpZ2ggKi8KKwlTRVRfRFBIWV9URVNUX0NUUkwxX0NMSyhr
bWJfZHNpLCBkcGh5X25vKTsKKworCS8qIFNldCB0ZXN0ZGluICovCisJU0VUX1RFU1RfRElOMF8z
KGttYl9kc2ksIGRwaHlfbm8sIHRlc3RfY29kZSk7CisKKwkvKiBTZXQgdGVzdGVuIGhpZ2ggKi8K
KwlTRVRfRFBIWV9URVNUX0NUUkwxX0VOKGttYl9kc2ksIGRwaHlfbm8pOworCisJLyogU2V0IHRl
c3RjbGsgbG93ICovCisJQ0xSX0RQSFlfVEVTVF9DVFJMMV9DTEsoa21iX2RzaSwgZHBoeV9ubyk7
CisKKwkvKiBTZXQgdGVzdGVuIGxvdyAqLworCUNMUl9EUEhZX1RFU1RfQ1RSTDFfRU4oa21iX2Rz
aSwgZHBoeV9ubyk7CisKKwlpZiAodGVzdF9jb2RlKSB7CisJCS8qICBTdGVwcyB0byBzZW5kIHRl
c3QgZGF0YToKKwkJICogLSBzZXQgdGVzdGVuIExPVworCQkgKiAtIHNldCB0ZXN0Y2xrIExPVwor
CQkgKiAtIHNldCB0ZXN0ZGluIHdpdGggZGF0YQorCQkgKiAtIHNldCB0ZXN0Y2xrIEhJR0gKKwkJ
ICovCisKKwkJLyogU2V0IHRlc3RlbiBsb3cgKi8KKwkJQ0xSX0RQSFlfVEVTVF9DVFJMMV9FTihr
bWJfZHNpLCBkcGh5X25vKTsKKworCQkvKiBTZXQgdGVzdGNsayBsb3cgKi8KKwkJQ0xSX0RQSFlf
VEVTVF9DVFJMMV9DTEsoa21iX2RzaSwgZHBoeV9ubyk7CisKKwkJLyogU2V0IGRhdGEgaW4gdGVz
dGRpbiAqLworCQlrbWJfd3JpdGVfbWlwaShrbWJfZHNpLAorCQkJICAgICAgIERQSFlfVEVTVF9E
SU4wXzMgKyAoKGRwaHlfbm8gLyAweDQpICogMHg0KSwKKwkJCSAgICAgICB0ZXN0X2RhdGEgPDwg
KChkcGh5X25vICUgNCkgKiA4KSk7CisKKwkJLyogU2V0IHRlc3RjbGsgaGlnaCAqLworCQlTRVRf
RFBIWV9URVNUX0NUUkwxX0NMSyhrbWJfZHNpLCBkcGh5X25vKTsKKwl9Cit9CisKK3N0YXRpYyBp
bmxpbmUgdm9pZAorCXNldF90ZXN0X21vZGVfc3JjX29zY19mcmVxX3RhcmdldF9sb3dfYml0cyhz
dHJ1Y3Qga21iX2RzaSAqa21iX2RzaSwKKwkJCQkJCSAgIHUzMiBkcGh5X25vLAorCQkJCQkJICAg
dTMyIGZyZXEpCit7CisJLyogVHlwaWNhbCByaXNlL2ZhbGwgdGltZT0xNjYsIHJlZmVyIFRhYmxl
IDEyMDcgZGF0YWJvb2ssCisJICogc3Jfb3NjX2ZyZXFfdGFyZ2V0Wzc6MF0KKwkgKi8KKwl0ZXN0
X21vZGVfc2VuZChrbWJfZHNpLCBkcGh5X25vLCBURVNUX0NPREVfU0xFV19SQVRFX0RETF9DWUNM
RVMsCisJCSAgICAgICAoZnJlcSAmIDB4N2YpKTsKK30KKworc3RhdGljIGlubGluZSB2b2lkCisJ
c2V0X3Rlc3RfbW9kZV9zcmNfb3NjX2ZyZXFfdGFyZ2V0X2hpX2JpdHMoc3RydWN0IGttYl9kc2kg
KmttYl9kc2ksCisJCQkJCQkgIHUzMiBkcGh5X25vLAorCQkJCQkJICB1MzIgZnJlcSkKK3sKKwl1
MzIgZGF0YTsKKworCS8qIEZsYWcgdGhpcyBhcyBoaWdoIG5pYmJsZSAqLworCWRhdGEgPSAoKGZy
ZXEgPj4gNikgJiAweDFmKSB8ICgxIDw8IDcpOworCisJLyogVHlwaWNhbCByaXNlL2ZhbGwgdGlt
ZT0xNjYsIHJlZmVyIFRhYmxlIDEyMDcgZGF0YWJvb2ssCisJICogc3Jfb3NjX2ZyZXFfdGFyZ2V0
WzExOjddCisJICovCisJdGVzdF9tb2RlX3NlbmQoa21iX2RzaSwgZHBoeV9ubywgVEVTVF9DT0RF
X1NMRVdfUkFURV9ERExfQ1lDTEVTLCBkYXRhKTsKK30KKworc3RhdGljIHZvaWQgbWlwaV90eF9n
ZXRfdmNvX3BhcmFtcyhzdHJ1Y3QgdmNvX3BhcmFtcyAqdmNvKQoreworCWludCBpOworCisJZm9y
IChpID0gMDsgaSA8IEFSUkFZX1NJWkUodmNvX3RhYmxlKTsgaSsrKSB7CisJCWlmICh2Y28tPmZy
ZXEgPCB2Y29fdGFibGVbaV0uZnJlcSkgeworCQkJKnZjbyA9IHZjb190YWJsZVtpXTsKKwkJCXJl
dHVybjsKKwkJfQorCX0KKworCVdBUk5fT05DRSgxLCAiSW52YWxpZCB2Y28gZnJlcSA9ICV1IGZv
ciBQTEwgc2V0dXBcbiIsIHZjby0+ZnJlcSk7Cit9CisKK3N0YXRpYyB2b2lkIG1pcGlfdHhfcGxs
X3NldHVwKHN0cnVjdCBrbWJfZHNpICprbWJfZHNpLCB1MzIgZHBoeV9ubywKKwkJCSAgICAgIHUz
MiByZWZfY2xrX21oeiwgdTMyIHRhcmdldF9mcmVxX21oeikKK3sKKwl1MzIgYmVzdF9uID0gMCwg
YmVzdF9tID0gMDsKKwl1MzIgbiA9IDAsIG0gPSAwLCBkaXYgPSAwLCBkZWx0YSwgZnJlcSA9IDAs
IHRfZnJlcTsKKwl1MzIgYmVzdF9mcmVxX2RlbHRhID0gMzAwMDsKKworCS8qIHBsbF9yZWZfY2xr
OiAtIHZhbGlkIHJhbmdlOiAyfjY0IE1IejsgVHlwaWNhbGx5IDI0IE1IegorCSAqIEZ2Y286IC0g
dmFsaWQgcmFuZ2U6IDMyMH4xMjUwIE1IeiAoR2VuMyBELVBIWSkKKwkgKiBGb3V0OiAtIHZhbGlk
IHJhbmdlOiA0MH4xMjUwIE1IeiAoR2VuMyBELVBIWSkKKwkgKiBuOiAtIHZhbGlkIHJhbmdlIFsw
IDE1XQorCSAqIE46IC0gTiA9IG4gKyAxCisJICogICAgICAtdmFsaWQgcmFuZ2U6IFsxIDE2XQor
CSAqICAgICAgLWNvbmRpdGlvbnM6IC0gKHBsbF9yZWZfY2xrIC8gTikgPj0gMiBNSHoKKwkgKiAg
ICAgICAgICAgICAtKHBsbF9yZWZfY2xrIC8gTikgPD0gOCBNSHoKKwkgKiBtOiB2YWxpZCByYW5n
ZSBbNjIgNjIzXQorCSAqIE06IC0gTSA9IG0gKyAyCisJICogICAgICAtdmFsaWQgcmFuZ2UgWzY0
IDYyNV0KKwkgKiAgICAgIC1GdmNvID0gKE0vTikgKiBwbGxfcmVmX2NsaworCSAqLworCXN0cnVj
dCB2Y29fcGFyYW1zIHZjb19wID0geworCQkucmFuZ2UgPSAwLAorCQkuZGl2aWRlciA9IDEsCisJ
fTsKKworCXZjb19wLmZyZXEgPSB0YXJnZXRfZnJlcV9taHo7CisJbWlwaV90eF9nZXRfdmNvX3Bh
cmFtcygmdmNvX3ApOworCisJLyogU2VhcmNoIHBsbCBuIHBhcmFtZXRlciAqLworCWZvciAobiA9
IFBMTF9OX01JTjsgbiA8PSBQTExfTl9NQVg7IG4rKykgeworCQkvKiBDYWxjdWxhdGUgdGhlIHBs
bCBpbnB1dCBmcmVxdWVuY3kgZGl2aXNpb24gcmF0aW8KKwkJICogbXVsdGlwbHkgYnkgMTAwMCBm
b3IgcHJlY2lzaW9uIC0KKwkJICogbm8gZmxvYXRpbmcgcG9pbnQsIGFkZCBuIGZvciByb3VuZGlu
ZworCQkgKi8KKwkJZGl2ID0gKChyZWZfY2xrX21oeiAqIDEwMDApICsgbikgLyAobiArIDEpOwor
CisJCS8qIEZvdW5kIGEgdmFsaWQgbiBwYXJhbWV0ZXIgKi8KKwkJaWYgKChkaXYgPCAyMDAwIHx8
IGRpdiA+IDgwMDApKQorCQkJY29udGludWU7CisKKwkJLyogU2VhcmNoIHBsbCBtIHBhcmFtZXRl
ciAqLworCQlmb3IgKG0gPSBQTExfTV9NSU47IG0gPD0gUExMX01fTUFYOyBtKyspIHsKKwkJCS8q
IENhbGN1bGF0ZSB0aGUgRnZjbyhEUEhZIFBMTCBvdXRwdXQgZnJlcXVlbmN5KQorCQkJICogdXNp
bmcgdGhlIGN1cnJlbnQgbixtIHBhcmFtcworCQkJICovCisJCQlmcmVxID0gZGl2ICogKG0gKyAy
KTsKKwkJCWZyZXEgLz0gMTAwMDsKKworCQkJLyogVHJpbSB0aGUgcG90ZW50aWFsIHBsbCBmcmVx
IHRvIG1heCBzdXBwb3J0ZWQgKi8KKwkJCWlmIChmcmVxID4gUExMX0ZWQ09fTUFYKQorCQkJCWNv
bnRpbnVlOworCisJCQlkZWx0YSA9IGFicyhmcmVxIC0gdGFyZ2V0X2ZyZXFfbWh6KTsKKworCQkJ
LyogU2VsZWN0IHRoZSBiZXN0IChjbG9zZXN0IHRvIHRhcmdldCBwbGwgZnJlcSkKKwkJCSAqIG4s
bSBwYXJhbWV0ZXJzIHNvIGZhcgorCQkJICovCisJCQlpZiAoZGVsdGEgPCBiZXN0X2ZyZXFfZGVs
dGEpIHsKKwkJCQliZXN0X24gPSBuOworCQkJCWJlc3RfbSA9IG07CisJCQkJYmVzdF9mcmVxX2Rl
bHRhID0gZGVsdGE7CisJCQl9CisJCX0KKwl9CisKKwkvKiBQcm9ncmFtIHZjb19jbnRybCBwYXJh
bWV0ZXIKKwkgKiBQTExfVkNPX0NvbnRyb2xbNTowXSA9IHBsbF92Y29fY250cmxfb3ZyLAorCSAq
IFBMTF9WQ09fQ29udHJvbFs2XSAgID0gcGxsX3Zjb19jbnRybF9vdnJfZW4KKwkgKi8KKwl0ZXN0
X21vZGVfc2VuZChrbWJfZHNpLCBkcGh5X25vLCBURVNUX0NPREVfUExMX1ZDT19DVFJMLCAodmNv
X3AucmFuZ2UKKwkJCQkJCQkJfCAoMSA8PCA2KSkpOworCisJLyogUHJvZ3JhbSBtLCBuIHBsbCBw
YXJhbWV0ZXJzICovCisJZGV2X2RiZyhrbWJfZHNpLT5kZXYsICJtID0gJWQgbiA9ICVkXG4iLCBi
ZXN0X20sIGJlc3Rfbik7CisKKwkvKiBQTExfSW5wdXRfRGl2aWRlcl9SYXRpb1szOjBdID0gcGxs
X25fb3ZyICovCisJdGVzdF9tb2RlX3NlbmQoa21iX2RzaSwgZHBoeV9ubywgVEVTVF9DT0RFX1BM
TF9JTlBVVF9ESVZJREVSLAorCQkgICAgICAgKGJlc3RfbiAmIDB4MGYpKTsKKworCS8qIG0gLSBs
b3cgbmliYmxlIFBMTF9Mb29wX0RpdmlkZXJfUmF0aW9bNDowXQorCSAqIHBsbF9tX292cls0OjBd
CisJICovCisJdGVzdF9tb2RlX3NlbmQoa21iX2RzaSwgZHBoeV9ubywgVEVTVF9DT0RFX1BMTF9G
RUVEQkFDS19ESVZJREVSLAorCQkgICAgICAgKGJlc3RfbSAmIDB4MWYpKTsKKworCS8qIG0gLSBo
aWdoIG5pYmJsZSBQTExfTG9vcF9EaXZpZGVyX1JhdGlvWzQ6MF0KKwkgKiBwbGxfbV9vdnJbOTo1
XQorCSAqLworCXRlc3RfbW9kZV9zZW5kKGttYl9kc2ksIGRwaHlfbm8sIFRFU1RfQ09ERV9QTExf
RkVFREJBQ0tfRElWSURFUiwKKwkJICAgICAgICgoYmVzdF9tID4+IDUpICYgMHgxZikgfCBQTExf
RkVFREJBQ0tfRElWSURFUl9ISUdIKTsKKworCS8qIEVuYWJsZSBvdmVyd3JpdGUgb2YgbixtIHBh
cmFtZXRlcnMgOnBsbF9uX292cl9lbiwgcGxsX21fb3ZyX2VuICovCisJdGVzdF9tb2RlX3NlbmQo
a21iX2RzaSwgZHBoeV9ubywgVEVTVF9DT0RFX1BMTF9PVVRQVVRfQ0xLX1NFTCwKKwkJICAgICAg
IChQTExfTl9PVlJfRU4gfCBQTExfTV9PVlJfRU4pKTsKKworCS8qIFByb2dyYW0gQ2hhcmdlLVB1
bXAgcGFyYW1ldGVycyAqLworCisJLyogcGxsX3Byb3BfY250cmwtZml4ZWQgdmFsdWVzIGZvciBw
cm9wX2NudHJsIGZyb20gRFBIWSBkb2MgKi8KKwl0X2ZyZXEgPSB0YXJnZXRfZnJlcV9taHogKiB2
Y29fcC5kaXZpZGVyOworCXRlc3RfbW9kZV9zZW5kKGttYl9kc2ksIGRwaHlfbm8sCisJCSAgICAg
ICBURVNUX0NPREVfUExMX1BST1BPUlRJT05BTF9DSEFSR0VfUFVNUF9DVFJMLAorCQkgICAgICAg
KCh0X2ZyZXEgPiAxMTUwKSA/IDB4MEMgOiAweDBCKSk7CisKKwkvKiBwbGxfaW50X2NudHJsLWZp
eGVkIHZhbHVlIGZvciBpbnRfY250cmwgZnJvbSBEUEhZIGRvYyAqLworCXRlc3RfbW9kZV9zZW5k
KGttYl9kc2ksIGRwaHlfbm8sIFRFU1RfQ09ERV9QTExfSU5URUdSQUxfQ0hBUkdFX1BVTVBfQ1RS
TCwKKwkJICAgICAgIDB4MDApOworCisJLyogcGxsX2dtcF9jbnRybC1maXhlZCB2YWx1ZSBmb3Ig
Z21wX2NudHJsIGZyb20gRFBIWSBkb2NpICovCisJdGVzdF9tb2RlX3NlbmQoa21iX2RzaSwgZHBo
eV9ubywgVEVTVF9DT0RFX1BMTF9HTVBfQ1RSTCwgMHgxMCk7CisKKwkvKiBwbGxfY3BiaWFzX2Nu
dHJsLWZpeGVkIHZhbHVlIGZvciBjcGJpYXNfY250cmwgZnJvbSBEUEhZIGRvYyAqLworCXRlc3Rf
bW9kZV9zZW5kKGttYl9kc2ksIGRwaHlfbm8sIFRFU1RfQ09ERV9QTExfQ0hBUkdFX1BVTVBfQklB
UywgMHgxMCk7CisKKwkvKiBwbGxfdGgxIC1Mb2NrIERldGVjdG9yIFBoYXNlIGVycm9yIHRocmVz
aG9sZCwKKwkgKiBkb2N1bWVudCBnaXZlcyBmaXhlZCB2YWx1ZQorCSAqLworCXRlc3RfbW9kZV9z
ZW5kKGttYl9kc2ksIGRwaHlfbm8sIFRFU1RfQ09ERV9QTExfUEhBU0VfRVJSX0NUUkwsIDB4MDIp
OworCisJLyogUExMIExvY2sgQ29uZmlndXJhdGlvbiAqLworCisJLyogcGxsX3RoMiAtIExvY2sg
RmlsdGVyIGxlbmd0aCwgZG9jdW1lbnQgZ2l2ZXMgZml4ZWQgdmFsdWUgKi8KKwl0ZXN0X21vZGVf
c2VuZChrbWJfZHNpLCBkcGh5X25vLCBURVNUX0NPREVfUExMX0xPQ0tfRklMVEVSLCAweDYwKTsK
KworCS8qIHBsbF90aDMtIFBMTCBVbmxvY2tpbmcgZmlsdGVyLCBkb2N1bWVudCBnaXZlcyBmaXhl
ZCB2YWx1ZSAqLworCXRlc3RfbW9kZV9zZW5kKGttYl9kc2ksIGRwaHlfbm8sIFRFU1RfQ09ERV9Q
TExfVU5MT0NLX0ZJTFRFUiwgMHgwMyk7CisKKwkvKiBwbGxfbG9ja19zZWwtUExMIExvY2sgRGV0
ZWN0b3IgU2VsZWN0aW9uLAorCSAqIGRvY3VtZW50IGdpdmVzIGZpeGVkIHZhbHVlCisJICovCisJ
dGVzdF9tb2RlX3NlbmQoa21iX2RzaSwgZHBoeV9ubywgVEVTVF9DT0RFX1BMTF9MT0NLX0RFVEVD
VE9SLCAweDAyKTsKK30KKworc3RhdGljIHZvaWQgc2V0X3NsZXdyYXRlX2d0XzE1MDAoc3RydWN0
IGttYl9kc2kgKmttYl9kc2ksIHUzMiBkcGh5X25vKQoreworCXUzMiB0ZXN0X2NvZGUgPSAwLCB0
ZXN0X2RhdGEgPSAwOworCS8qIEJ5cGFzcyBzbGV3IHJhdGUgY2FsaWJyYXRpb24gYWxnb3JpdGht
CisJICogYml0c1sxOjB9IHNyY2FsX2VuX292cl9lbiwgc3JjYWxfZW5fb3ZyCisJICovCisJdGVz
dF9jb2RlID0gVEVTVF9DT0RFX1NMRVdfUkFURV9PVkVSUklERV9DVFJMOworCXRlc3RfZGF0YSA9
IDB4MDI7CisJdGVzdF9tb2RlX3NlbmQoa21iX2RzaSwgZHBoeV9ubywgdGVzdF9jb2RlLCB0ZXN0
X2RhdGEpOworCisJLyogRGlzYWJsZSBzbGV3IHJhdGUgY2FsaWJyYXRpb24gKi8KKwl0ZXN0X2Nv
ZGUgPSBURVNUX0NPREVfU0xFV19SQVRFX0RETF9MT09QX0NUUkw7CisJdGVzdF9kYXRhID0gMHgw
MDsKKwl0ZXN0X21vZGVfc2VuZChrbWJfZHNpLCBkcGh5X25vLCB0ZXN0X2NvZGUsIHRlc3RfZGF0
YSk7Cit9CisKK3N0YXRpYyB2b2lkIHNldF9zbGV3cmF0ZV9ndF8xMDAwKHN0cnVjdCBrbWJfZHNp
ICprbWJfZHNpLCB1MzIgZHBoeV9ubykKK3sKKwl1MzIgdGVzdF9jb2RlID0gMCwgdGVzdF9kYXRh
ID0gMDsKKworCS8qIEJpdFJhdGU6ID4gMSBHYnBzICYmIDw9IDEuNSBHYnBzOiAtIHNsZXcgcmF0
ZSBjb250cm9sIE9OCisJICogdHlwaWNhbCByaXNlL2ZhbGwgdGltZXM6IDE2NiBwcworCSAqLwor
CisJLyogRG8gbm90IGJ5cGFzcyBzbGV3IHJhdGUgY2FsaWJyYXRpb24gYWxnb3JpdGhtCisJICog
Yml0c1sxOjB9PXNyY2FsX2VuX292cl9lbiwgc3JjYWxfZW5fb3ZyLCBiaXRbNl09c3JfcmFuZ2UK
KwkgKi8KKwl0ZXN0X2NvZGUgPSBURVNUX0NPREVfU0xFV19SQVRFX09WRVJSSURFX0NUUkw7CisJ
dGVzdF9kYXRhID0gKDB4MDMgfCAoMSA8PCA2KSk7CisJdGVzdF9tb2RlX3NlbmQoa21iX2RzaSwg
ZHBoeV9ubywgdGVzdF9jb2RlLCB0ZXN0X2RhdGEpOworCisJLyogRW5hYmxlIHNsZXcgcmF0ZSBj
YWxpYnJhdGlvbiAqLworCXRlc3RfY29kZSA9IFRFU1RfQ09ERV9TTEVXX1JBVEVfRERMX0xPT1Bf
Q1RSTDsKKwl0ZXN0X2RhdGEgPSAweDAxOworCXRlc3RfbW9kZV9zZW5kKGttYl9kc2ksIGRwaHlf
bm8sIHRlc3RfY29kZSwgdGVzdF9kYXRhKTsKKworCS8qIFNldCBzcl9vc2NfZnJlcV90YXJnZXRb
NjowXSBsb3cgbmliYmxlCisJICogdHlwaWNhbCByaXNlL2ZhbGwgdGltZT0xNjYsIHJlZmVyIFRh
YmxlIDEyMDcgZGF0YWJvb2sKKwkgKi8KKwl0ZXN0X2NvZGUgPSBURVNUX0NPREVfU0xFV19SQVRF
X0RETF9DWUNMRVM7CisJdGVzdF9kYXRhID0gKDB4NzJmICYgMHg3Zik7CisJdGVzdF9tb2RlX3Nl
bmQoa21iX2RzaSwgZHBoeV9ubywgdGVzdF9jb2RlLCB0ZXN0X2RhdGEpOworCisJLyogU2V0IHNy
X29zY19mcmVxX3RhcmdldFsxMTo3XSBoaWdoIG5pYmJsZQorCSAqIFR5cGljYWwgcmlzZS9mYWxs
IHRpbWU9MTY2LCByZWZlciBUYWJsZSAxMjA3IGRhdGFib29rCisJICovCisJdGVzdF9jb2RlID0g
VEVTVF9DT0RFX1NMRVdfUkFURV9ERExfQ1lDTEVTOworCXRlc3RfZGF0YSA9ICgoMHg3MmYgPj4g
NikgJiAweDFmKSB8ICgxIDw8IDcpOworCXRlc3RfbW9kZV9zZW5kKGttYl9kc2ksIGRwaHlfbm8s
IHRlc3RfY29kZSwgdGVzdF9kYXRhKTsKK30KKworc3RhdGljIHZvaWQgc2V0X3NsZXdyYXRlX2x0
XzEwMDAoc3RydWN0IGttYl9kc2kgKmttYl9kc2ksIHUzMiBkcGh5X25vKQoreworCXUzMiB0ZXN0
X2NvZGUgPSAwLCB0ZXN0X2RhdGEgPSAwOworCisJLyogbGFuZV9yYXRlX21icHMgPD0gMTAwMCBN
YnBzCisJICogQml0UmF0ZTogIDw9IDEgR2JwczoKKwkgKiAtIHNsZXcgcmF0ZSBjb250cm9sIE9O
CisJICogLSB0eXBpY2FsIHJpc2UvZmFsbCB0aW1lczogMjI1IHBzCisJICovCisKKwkvKiBEbyBu
b3QgYnlwYXNzIHNsZXcgcmF0ZSBjYWxpYnJhdGlvbiBhbGdvcml0aG0gKi8KKwl0ZXN0X2NvZGUg
PSBURVNUX0NPREVfU0xFV19SQVRFX09WRVJSSURFX0NUUkw7CisJdGVzdF9kYXRhID0gKDB4MDMg
fCAoMSA8PCA2KSk7CisJdGVzdF9tb2RlX3NlbmQoa21iX2RzaSwgZHBoeV9ubywgdGVzdF9jb2Rl
LCB0ZXN0X2RhdGEpOworCisJLyogRW5hYmxlIHNsZXcgcmF0ZSBjYWxpYnJhdGlvbiAqLworCXRl
c3RfY29kZSA9IFRFU1RfQ09ERV9TTEVXX1JBVEVfRERMX0xPT1BfQ1RSTDsKKwl0ZXN0X2RhdGEg
PSAweDAxOworCXRlc3RfbW9kZV9zZW5kKGttYl9kc2ksIGRwaHlfbm8sIHRlc3RfY29kZSwgdGVz
dF9kYXRhKTsKKworCS8qIFR5cGljYWwgcmlzZS9mYWxsIHRpbWU9MjU1LCByZWZlciBUYWJsZSAx
MjA3IGRhdGFib29rICovCisJdGVzdF9jb2RlID0gVEVTVF9DT0RFX1NMRVdfUkFURV9ERExfQ1lD
TEVTOworCXRlc3RfZGF0YSA9ICgweDUyMyAmIDB4N2YpOworCXRlc3RfbW9kZV9zZW5kKGttYl9k
c2ksIGRwaHlfbm8sIHRlc3RfY29kZSwgdGVzdF9kYXRhKTsKKworCS8qIFNldCBzcl9vc2NfZnJl
cV90YXJnZXRbMTE6N10gaGlnaCBuaWJibGUgKi8KKwl0ZXN0X2NvZGUgPSBURVNUX0NPREVfU0xF
V19SQVRFX0RETF9DWUNMRVM7CisJdGVzdF9kYXRhID0gKCgweDUyMyA+PiA2KSAmIDB4MWYpIHwg
KDEgPDwgNyk7CisJdGVzdF9tb2RlX3NlbmQoa21iX2RzaSwgZHBoeV9ubywgdGVzdF9jb2RlLCB0
ZXN0X2RhdGEpOworfQorCitzdGF0aWMgdm9pZCBzZXR1cF9wbGwoc3RydWN0IGttYl9kc2kgKmtt
Yl9kc2ksIHUzMiBkcGh5X25vLAorCQkgICAgICBzdHJ1Y3QgbWlwaV9jdHJsX2NmZyAqY2ZnKQor
eworCXUzMiB0ZXN0X2NvZGUgPSAwLCB0ZXN0X2RhdGEgPSAwOworCisJLyogU2V0IFBMTCByZWd1
bGF0b3IgaW4gYnlwYXNzICovCisJdGVzdF9jb2RlID0gVEVTVF9DT0RFX1BMTF9BTkFMT0dfUFJP
RzsKKwl0ZXN0X2RhdGEgPSAweDAxOworCXRlc3RfbW9kZV9zZW5kKGttYl9kc2ksIGRwaHlfbm8s
IHRlc3RfY29kZSwgdGVzdF9kYXRhKTsKKworCS8qIFBMTCBQYXJhbWV0ZXJzIFNldHVwICovCisJ
bWlwaV90eF9wbGxfc2V0dXAoa21iX2RzaSwgZHBoeV9ubywgY2ZnLT5yZWZfY2xrX2toeiAvIDEw
MDAsCisJCQkgIGNmZy0+bGFuZV9yYXRlX21icHMgLyAyKTsKKworCS8qIFNldCBjbGtzZWwgKi8K
KwlrbWJfd3JpdGVfYml0c19taXBpKGttYl9kc2ksIERQSFlfSU5JVF9DVFJMMSwgUExMX0NMS1NF
TF8wLCAyLCAweDAxKTsKKworCS8qIFNldCBwbGxfc2hhZG93X2NvbnRyb2wgKi8KKwlrbWJfc2V0
X2JpdF9taXBpKGttYl9kc2ksIERQSFlfSU5JVF9DVFJMMSwgUExMX1NIQURPV19DVFJMKTsKK30K
Kworc3RhdGljIHZvaWQgc2V0X2xhbmVfZGF0YV9yYXRlKHN0cnVjdCBrbWJfZHNpICprbWJfZHNp
LCB1MzIgZHBoeV9ubywKKwkJCSAgICAgICBzdHJ1Y3QgbWlwaV9jdHJsX2NmZyAqY2ZnKQorewor
CXUzMiBpLCB0ZXN0X2NvZGUgPSAwLCB0ZXN0X2RhdGEgPSAwOworCisJZm9yIChpID0gMDsgaSA8
IE1JUElfRFBIWV9ERUZBVUxUX0JJVF9SQVRFUzsgaSsrKSB7CisJCWlmIChtaXBpX2hzX2ZyZXFf
cmFuZ2VbaV0uZGVmYXVsdF9iaXRfcmF0ZV9tYnBzIDwKKwkJICAgIGNmZy0+bGFuZV9yYXRlX21i
cHMpCisJCQljb250aW51ZTsKKworCQkvKiBTZW5kIHRoZSB0ZXN0IGNvZGUgYW5kIGRhdGEgKi8K
KwkJLyogYml0WzY6MF0gPSBoc2ZyZXFyYW5nZV9vdnIgYml0WzddID0gaHNmcmVxcmFuZ2Vfb3Zy
X2VuICovCisJCXRlc3RfY29kZSA9IFRFU1RfQ09ERV9IU19GUkVRX1JBTkdFX0NGRzsKKwkJdGVz
dF9kYXRhID0gKG1pcGlfaHNfZnJlcV9yYW5nZVtpXS5oc2ZyZXFyYW5nZV9jb2RlICYgMHg3Zikg
fAorCQkgICAgKDEgPDwgNyk7CisJCXRlc3RfbW9kZV9zZW5kKGttYl9kc2ksIGRwaHlfbm8sIHRl
c3RfY29kZSwgdGVzdF9kYXRhKTsKKwkJYnJlYWs7CisJfQorfQorCitzdGF0aWMgdm9pZCBkcGh5
X2luaXRfc2VxdWVuY2Uoc3RydWN0IGttYl9kc2kgKmttYl9kc2ksCisJCQkgICAgICAgc3RydWN0
IG1pcGlfY3RybF9jZmcgKmNmZywgdTMyIGRwaHlfbm8sCisJCQkgICAgICAgaW50IGFjdGl2ZV9s
YW5lcywgZW51bSBkcGh5X21vZGUgbW9kZSkKK3sKKwl1MzIgdGVzdF9jb2RlID0gMCwgdGVzdF9k
YXRhID0gMCwgdmFsOworCisJLyogU2V0IEQtUEhZIGluIHNodXRkb3duIG1vZGUgKi8KKwkvKiBB
c3NlcnQgUlNUWiBzaWduYWwgKi8KKwlDTFJfRFBIWV9JTklUX0NUUkwwKGttYl9kc2ksIGRwaHlf
bm8sIFJFU0VUWik7CisKKwkvKiBBc3NlcnQgU0hVVERPV05aIHNpZ25hbCAqLworCUNMUl9EUEhZ
X0lOSVRfQ1RSTDAoa21iX2RzaSwgZHBoeV9ubywgU0hVVERPV05aKTsKKwl2YWwgPSBrbWJfcmVh
ZF9taXBpKGttYl9kc2ksIERQSFlfSU5JVF9DVFJMMCk7CisKKwkvKiBJbml0IEQtUEhZX24KKwkg
KiBQdWxzZSB0ZXN0Y2xlYXIgc2lnbmFsIHRvIG1ha2Ugc3VyZSB0aGUgZC1waHkgY29uZmlndXJh
dGlvbgorCSAqIHN0YXJ0cyBmcm9tIGEgY2xlYW4gYmFzZQorCSAqLworCUNMUl9EUEhZX1RFU1Rf
Q1RSTDAoa21iX2RzaSwgZHBoeV9ubyk7CisJbmRlbGF5KDE1KTsKKwlTRVRfRFBIWV9URVNUX0NU
UkwwKGttYl9kc2ksIGRwaHlfbm8pOworCW5kZWxheSgxNSk7CisJQ0xSX0RQSFlfVEVTVF9DVFJM
MChrbWJfZHNpLCBkcGh5X25vKTsKKwluZGVsYXkoMTUpOworCisJLyogU2V0IG1hc3Rlcm1hY3Jv
IGJpdCAtIE1hc3RlciBvciBzbGF2ZSBtb2RlICovCisJdGVzdF9jb2RlID0gVEVTVF9DT0RFX01V
TFRJUExFX1BIWV9DVFJMOworCisJLyogRFBIWSBoYXMgaXRzIG93biBjbG9jayBsYW5lIGVuYWJs
ZWQgKG1hc3RlcikgKi8KKwlpZiAobW9kZSA9PSBNSVBJX0RQSFlfTUFTVEVSKQorCQl0ZXN0X2Rh
dGEgPSAweDAxOworCWVsc2UKKwkJdGVzdF9kYXRhID0gMHgwMDsKKworCS8qIFNlbmQgdGhlIHRl
c3QgY29kZSBhbmQgZGF0YSAqLworCXRlc3RfbW9kZV9zZW5kKGttYl9kc2ksIGRwaHlfbm8sIHRl
c3RfY29kZSwgdGVzdF9kYXRhKTsKKworCS8qIFNldCB0aGUgbGFuZSBkYXRhIHJhdGUgKi8KKwlz
ZXRfbGFuZV9kYXRhX3JhdGUoa21iX2RzaSwgZHBoeV9ubywgY2ZnKTsKKworCS8qIEhpZ2gtU3Bl
ZWQgVHggU2xldyBSYXRlIENhbGlicmF0aW9uCisJICogQml0UmF0ZTogPiAxLjUgR2JwcyAmJiA8
PSAyLjUgR2Jwczogc2xldyByYXRlIGNvbnRyb2wgT0ZGCisJICovCisJaWYgKGNmZy0+bGFuZV9y
YXRlX21icHMgPiAxNTAwKQorCQlzZXRfc2xld3JhdGVfZ3RfMTUwMChrbWJfZHNpLCBkcGh5X25v
KTsKKwllbHNlIGlmIChjZmctPmxhbmVfcmF0ZV9tYnBzID4gMTAwMCkKKwkJc2V0X3NsZXdyYXRl
X2d0XzEwMDAoa21iX2RzaSwgZHBoeV9ubyk7CisJZWxzZQorCQlzZXRfc2xld3JhdGVfbHRfMTAw
MChrbWJfZHNpLCBkcGh5X25vKTsKKworCS8qIFNldCBjZmdjbGtmcmVxcmFuZ2UgKi8KKwl2YWwg
PSAoKChjZmctPmNmZ19jbGtfa2h6IC8gMTAwMCkgLSAxNykgKiA0KSAmIDB4M2Y7CisJU0VUX0RQ
SFlfRlJFUV9DVFJMMF8zKGttYl9kc2ksIGRwaHlfbm8sIHZhbCk7CisKKwkvKiBFbmFibGUgY29u
ZmlnIGNsayBmb3IgdGhlIGNvcnJlc3BvbmRpbmcgZC1waHkgKi8KKwlrbWJfc2V0X2JpdF9taXBp
KGttYl9kc2ksIERQSFlfQ0ZHX0NMS19FTiwgZHBoeV9ubyk7CisKKwkvKiBQTEwgc2V0dXAgKi8K
KwlpZiAobW9kZSA9PSBNSVBJX0RQSFlfTUFTVEVSKQorCQlzZXR1cF9wbGwoa21iX2RzaSwgZHBo
eV9ubywgY2ZnKTsKKworCS8qIFNlbmQgTk9STUFMIE9QRVJBVElPTiB0ZXN0IGNvZGUgKi8KKwl0
ZXN0X2NvZGUgPSAweDA7CisJdGVzdF9kYXRhID0gMHgwOworCXRlc3RfbW9kZV9zZW5kKGttYl9k
c2ksIGRwaHlfbm8sIHRlc3RfY29kZSwgdGVzdF9kYXRhKTsKKworCS8qIENvbmZpZ3VyZSBCQVNF
RElSIGZvciBkYXRhIGxhbmVzCisJICogTk9URTogYmFzZWRpciBvbmx5IGFwcGxpZXMgdG8gTEFO
RV8wIG9mIGVhY2ggRC1QSFkuCisJICogVGhlIG90aGVyIGxhbmVzIGtlZXAgdGhlaXIgZGlyZWN0
aW9uIGJhc2VkIG9uIHRoZSBELVBIWSB0eXBlLAorCSAqIGVpdGhlciBSeCBvciBUeC4KKwkgKiBi
aXRzWzU6MF0gIC0gQmFzZURpcjogMSA9IFJ4CisJICogYml0c1s5OjZdIC0gQmFzZURpcjogMCA9
IFR4CisJICovCisJa21iX3dyaXRlX2JpdHNfbWlwaShrbWJfZHNpLCBEUEhZX0lOSVRfQ1RSTDIs
IDAsIDksIDB4MDNmKTsKKwluZGVsYXkoMTUpOworCisJLyogRW5hYmxlIENMT0NLIExBTkUKKwkg
KiBDbG9jayBsYW5lIHNob3VsZCBiZSBlbmFibGVkIHJlZ2FyZGxlc3Mgb2YgdGhlIGRpcmVjdGlv
bgorCSAqIHNldCBmb3IgdGhlIEQtUEhZIChSeC9UeCkKKwkgKi8KKwlrbWJfc2V0X2JpdF9taXBp
KGttYl9kc2ksIERQSFlfSU5JVF9DVFJMMiwgMTIgKyBkcGh5X25vKTsKKworCS8qIEVuYWJsZSBE
QVRBIExBTkVTICovCisJa21iX3dyaXRlX2JpdHNfbWlwaShrbWJfZHNpLCBEUEhZX0VOQUJMRSwg
ZHBoeV9ubyAqIDIsIDIsCisJCQkgICAgKCgxIDw8IGFjdGl2ZV9sYW5lcykgLSAxKSk7CisKKwlu
ZGVsYXkoMTUpOworCisJLyogVGFrZSBELVBIWSBvdXQgb2Ygc2h1dGRvd24gbW9kZSAqLworCS8q
IERlYXNzZXJ0IFNIVVRET1dOWiBzaWduYWwgKi8KKwlTRVRfRFBIWV9JTklUX0NUUkwwKGttYl9k
c2ksIGRwaHlfbm8sIFNIVVRET1dOWik7CisJbmRlbGF5KDE1KTsKKworCS8qIERlYXNzZXJ0IFJT
VFogc2lnbmFsICovCisJU0VUX0RQSFlfSU5JVF9DVFJMMChrbWJfZHNpLCBkcGh5X25vLCBSRVNF
VFopOworfQorCitzdGF0aWMgdm9pZCBkcGh5X3dhaXRfZnNtKHN0cnVjdCBrbWJfZHNpICprbWJf
ZHNpLCB1MzIgZHBoeV9ubywKKwkJCSAgZW51bSBkcGh5X3R4X2ZzbSBmc21fc3RhdGUpCit7CisJ
ZW51bSBkcGh5X3R4X2ZzbSB2YWwgPSBEUEhZX1RYX1BPV0VSRFdOOworCWludCBpID0gMDsKKwlp
bnQgc3RhdHVzID0gMTsKKworCWRvIHsKKwkJdGVzdF9tb2RlX3NlbmQoa21iX2RzaSwgZHBoeV9u
bywgVEVTVF9DT0RFX0ZTTV9DT05UUk9MLCAweDgwKTsKKworCQl2YWwgPSBHRVRfVEVTVF9ET1VU
NF83KGttYl9kc2ksIGRwaHlfbm8pOworCQlpKys7CisJCWlmIChpID4gVElNRU9VVCkgeworCQkJ
c3RhdHVzID0gMDsKKwkJCWJyZWFrOworCQl9CisJfSB3aGlsZSAodmFsICE9IGZzbV9zdGF0ZSk7
CisKKwlkZXZfZGJnKGttYl9kc2ktPmRldiwgIiVzOiBkcGh5ICVkIHZhbCA9ICV4IiwgX19mdW5j
X18sIGRwaHlfbm8sIHZhbCk7CisJZGV2X2RiZyhrbWJfZHNpLT5kZXYsICIqIERQSFkgJWQgV0FJ
VF9GU00gJXMgKiIsCisJCWRwaHlfbm8sIHN0YXR1cyA/ICJTVUNDRVNTIiA6ICJGQUlMRUQiKTsK
K30KKworc3RhdGljIHZvaWQgd2FpdF9pbml0X2RvbmUoc3RydWN0IGttYl9kc2kgKmttYl9kc2ks
IHUzMiBkcGh5X25vLAorCQkJICAgdTMyIGFjdGl2ZV9sYW5lcykKK3sKKwl1MzIgc3RvcHN0YXRl
ZGF0YSA9IDA7CisJdTMyIGRhdGFfbGFuZXMgPSAoMSA8PCBhY3RpdmVfbGFuZXMpIC0gMTsKKwlp
bnQgaSA9IDAsIHZhbDsKKwlpbnQgc3RhdHVzID0gMTsKKworCWRvIHsKKwkJdmFsID0ga21iX3Jl
YWRfbWlwaShrbWJfZHNpLCBNSVBJX0RQSFlfU1RBVDRfNyk7CisJCXN0b3BzdGF0ZWRhdGEgPSBH
RVRfU1RPUFNUQVRFX0RBVEEoa21iX2RzaSwgZHBoeV9ubykKKwkJCQkmIGRhdGFfbGFuZXM7CisK
KwkJLyogVE9ETy1uZWVkIHRvIGFkZCBhIHRpbWUgb3V0IGFuZCByZXR1cm4gZmFpbHVyZSAqLwor
CQlpKys7CisKKwkJaWYgKGkgPiBUSU1FT1VUKSB7CisJCQlzdGF0dXMgPSAwOworCQkJZGV2X2Ri
ZyhrbWJfZHNpLT5kZXYsCisJCQkJIiEgV0FJVF9JTklUX0RPTkU6IFRJTUlORyBPVVQhKGVycl9z
dGF0PSVkKSIsCisJCQkJa21iX3JlYWRfbWlwaShrbWJfZHNpLCBNSVBJX0RQSFlfRVJSX1NUQVQ2
XzcpKTsKKwkJCWJyZWFrOworCQl9CisJfSB3aGlsZSAoc3RvcHN0YXRlZGF0YSAhPSBkYXRhX2xh
bmVzKTsKKworCWRldl9kYmcoa21iX2RzaS0+ZGV2LCAiKiBEUEhZICVkIElOSVQgLSAlcyAqIiwK
KwkJZHBoeV9ubywgc3RhdHVzID8gIlNVQ0NFU1MiIDogIkZBSUxFRCIpOworfQorCitzdGF0aWMg
dm9pZCB3YWl0X3BsbF9sb2NrKHN0cnVjdCBrbWJfZHNpICprbWJfZHNpLCB1MzIgZHBoeV9ubykK
K3sKKwlpbnQgaSA9IDA7CisJaW50IHN0YXR1cyA9IDE7CisKKwlkbyB7CisJCS8qIFRPRE8tbmVl
ZCB0byBhZGQgYSB0aW1lIG91dCBhbmQgcmV0dXJuIGZhaWx1cmUgKi8KKwkJaSsrOworCQlpZiAo
aSA+IFRJTUVPVVQpIHsKKwkJCXN0YXR1cyA9IDA7CisJCQlkZXZfZGJnKGttYl9kc2ktPmRldiwg
IiVzOiB0aW1pbmcgb3V0IiwgX19mdW5jX18pOworCQkJYnJlYWs7CisJCX0KKwl9IHdoaWxlICgh
R0VUX1BMTF9MT0NLKGttYl9kc2ksIGRwaHlfbm8pKTsKKworCWRldl9kYmcoa21iX2RzaS0+ZGV2
LCAiKiBQTEwgTG9ja2VkIGZvciBEUEhZICVkIC0gJXMgKiIsCisJCWRwaHlfbm8sIHN0YXR1cyA/
ICJTVUNDRVNTIiA6ICJGQUlMRUQiKTsKK30KKworc3RhdGljIHUzMiBtaXBpX3R4X2luaXRfZHBo
eShzdHJ1Y3Qga21iX2RzaSAqa21iX2RzaSwKKwkJCSAgICAgc3RydWN0IG1pcGlfY3RybF9jZmcg
KmNmZykKK3sKKwl1MzIgZHBoeV9ubyA9IE1JUElfRFBIWTY7CisKKwkvKiBNdWx0aXBsZSBELVBI
WXMgbmVlZGVkICovCisJaWYgKGNmZy0+YWN0aXZlX2xhbmVzID4gTUlQSV9EUEhZX0RfTEFORVMp
IHsKKwkJLyoKKwkJICpJbml0aWFsaXphdGlvbiBmb3IgVHggYWdncmVnYXRpb24gbW9kZSBpcyBk
b25lIGFjY29yZGluZyB0bworCQkgKmEuIHN0YXJ0IGluaXQgUEhZMQorCQkgKmIuIHBvbGwgZm9y
IFBIWTEgRlNNIHN0YXRlIExPQ0sKKwkJICogICBiMS4gcmVnIGFkZHIgMHgwM1szOjBdIC0gc3Rh
dGVfbWFpblszOjBdID09IDUgKExPQ0spCisJCSAqYy4gcG9sbCBmb3IgUEhZMSBjYWxpYnJhdGlv
bnMgZG9uZSA6CisJCSAqICAgYzEuIHRlcm1pbmF0aW9uIGNhbGlicmF0aW9uIGxvd2VyIHNlY3Rp
b246IGFkZHIgMHgyMls1XQorCQkgKiAgIC0gcmVzY2FsX2RvbmUKKwkJICogICBjMi4gc2xld3Jh
dGUgY2FsaWJyYXRpb24gKGlmIGRhdGEgcmF0ZSA8ID0gMTUwMCBNYnBzKToKKwkJICogICAgIGFk
ZHIgMHhBN1szOjJdIC0gc3JjYWxfZG9uZSwgc3JfZmluaXNoZWQKKwkJICpkLiBzdGFydCBpbml0
IFBIWTAKKwkJICplLiBwb2xsIGZvciBQSFkwIHN0b3BzdGF0ZQorCQkgKmYuIHBvbGwgZm9yIFBI
WTEgc3RvcHN0YXRlCisJCSAqLworCQkvKiBQSFkgI04rMSAoJ3NsYXZlJykgKi8KKworCQlkcGh5
X2luaXRfc2VxdWVuY2Uoa21iX2RzaSwgY2ZnLCBkcGh5X25vICsgMSwKKwkJCQkgICAoY2ZnLT5h
Y3RpdmVfbGFuZXMgLSBNSVBJX0RQSFlfRF9MQU5FUyksCisJCQkJICAgTUlQSV9EUEhZX1NMQVZF
KTsKKwkJZHBoeV93YWl0X2ZzbShrbWJfZHNpLCBkcGh5X25vICsgMSwgRFBIWV9UWF9MT0NLKTsK
KworCQkvKiBQSFkgI04gbWFzdGVyICovCisJCWRwaHlfaW5pdF9zZXF1ZW5jZShrbWJfZHNpLCBj
ZmcsIGRwaHlfbm8sIE1JUElfRFBIWV9EX0xBTkVTLAorCQkJCSAgIE1JUElfRFBIWV9NQVNURVIp
OworCisJCS8qIFdhaXQgZm9yIERQSFkgaW5pdCB0byBjb21wbGV0ZSAqLworCQl3YWl0X2luaXRf
ZG9uZShrbWJfZHNpLCBkcGh5X25vLCBNSVBJX0RQSFlfRF9MQU5FUyk7CisJCXdhaXRfaW5pdF9k
b25lKGttYl9kc2ksIGRwaHlfbm8gKyAxLAorCQkJICAgICAgIGNmZy0+YWN0aXZlX2xhbmVzIC0g
TUlQSV9EUEhZX0RfTEFORVMpOworCQl3YWl0X3BsbF9sb2NrKGttYl9kc2ksIGRwaHlfbm8pOwor
CQl3YWl0X3BsbF9sb2NrKGttYl9kc2ksIGRwaHlfbm8gKyAxKTsKKwkJZHBoeV93YWl0X2ZzbShr
bWJfZHNpLCBkcGh5X25vLCBEUEhZX1RYX0lETEUpOworCX0gZWxzZSB7CQkvKiBTaW5nbGUgRFBI
WSAqLworCQlkcGh5X2luaXRfc2VxdWVuY2Uoa21iX2RzaSwgY2ZnLCBkcGh5X25vLCBjZmctPmFj
dGl2ZV9sYW5lcywKKwkJCQkgICBNSVBJX0RQSFlfTUFTVEVSKTsKKwkJZHBoeV93YWl0X2ZzbShr
bWJfZHNpLCBkcGh5X25vLCBEUEhZX1RYX0lETEUpOworCQl3YWl0X2luaXRfZG9uZShrbWJfZHNp
LCBkcGh5X25vLCBjZmctPmFjdGl2ZV9sYW5lcyk7CisJCXdhaXRfcGxsX2xvY2soa21iX2RzaSwg
ZHBoeV9ubyk7CisJfQorCisJcmV0dXJuIDA7Cit9CisKK2ludCBrbWJfZHNpX21vZGVfc2V0KHN0
cnVjdCBrbWJfZHNpICprbWJfZHNpLCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSwKKwkJ
ICAgICBpbnQgc3lzX2Nsa19taHopCit7CisJdTY0IGRhdGFfcmF0ZTsKKworCWttYl9kc2ktPnN5
c19jbGtfbWh6ID0gc3lzX2Nsa19taHo7CisJbWlwaV90eF9pbml0X2NmZy5hY3RpdmVfbGFuZXMg
PSBNSVBJX1RYX0FDVElWRV9MQU5FUzsKKworCW1pcGlfdHhfZnJhbWUwX3NlY3RfY2ZnLndpZHRo
X3BpeGVscyA9IG1vZGUtPmNydGNfaGRpc3BsYXk7CisJbWlwaV90eF9mcmFtZTBfc2VjdF9jZmcu
aGVpZ2h0X2xpbmVzID0gbW9kZS0+Y3J0Y192ZGlzcGxheTsKKwltaXBpdHhfZnJhbWUwX2NmZy52
c3luY193aWR0aCA9CisJCW1vZGUtPmNydGNfdnN5bmNfZW5kIC0gbW9kZS0+Y3J0Y192c3luY19z
dGFydDsKKwltaXBpdHhfZnJhbWUwX2NmZy52X2JhY2twb3JjaCA9CisJCW1vZGUtPmNydGNfdnRv
dGFsIC0gbW9kZS0+Y3J0Y192c3luY19lbmQ7CisJbWlwaXR4X2ZyYW1lMF9jZmcudl9mcm9udHBv
cmNoID0KKwkJbW9kZS0+Y3J0Y192c3luY19zdGFydCAtIG1vZGUtPmNydGNfdmRpc3BsYXk7CisJ
bWlwaXR4X2ZyYW1lMF9jZmcuaHN5bmNfd2lkdGggPQorCQltb2RlLT5jcnRjX2hzeW5jX2VuZCAt
IG1vZGUtPmNydGNfaHN5bmNfc3RhcnQ7CisJbWlwaXR4X2ZyYW1lMF9jZmcuaF9iYWNrcG9yY2gg
PQorCQltb2RlLT5jcnRjX2h0b3RhbCAtIG1vZGUtPmNydGNfaHN5bmNfZW5kOworCW1pcGl0eF9m
cmFtZTBfY2ZnLmhfZnJvbnRwb3JjaCA9CisJCW1vZGUtPmNydGNfaHN5bmNfc3RhcnQgLSBtb2Rl
LT5jcnRjX2hkaXNwbGF5OworCisJLyogTGFuZSByYXRlID0gKHZ0b3RhbCpodG90YWwqZnBzKmJw
cCkvNCAvIDEwMDAwMDAKKwkgKiB0byBjb252ZXJ0IHRvIE1icHMKKwkgKi8KKwlkYXRhX3JhdGUg
PSAoKCgodTMyKW1vZGUtPmNydGNfdnRvdGFsICoJKHUzMiltb2RlLT5jcnRjX2h0b3RhbCkgKgor
CQkJKHUzMikoZHJtX21vZGVfdnJlZnJlc2gobW9kZSkpICoKKwkJCU1JUElfVFhfQlBQKSAvIG1p
cGlfdHhfaW5pdF9jZmcuYWN0aXZlX2xhbmVzKSAvCTEwMDAwMDA7CisKKwlkZXZfZGJnKGttYl9k
c2ktPmRldiwgImRhdGFfcmF0ZT0ldSBhY3RpdmVfbGFuZXM9JWRcbiIsCisJCSh1MzIpZGF0YV9y
YXRlLCBtaXBpX3R4X2luaXRfY2ZnLmFjdGl2ZV9sYW5lcyk7CisKKwkvKiBXaGVuIGxhdGUgcmF0
ZSA8IDgwMCwgbW9kZXNldCBmYWlscyB3aXRoIDQgbGFuZXMsCisJICogc28gc3dpdGNoIHRvIDIg
bGFuZXMKKwkgKi8KKwlpZiAoZGF0YV9yYXRlIDwgODAwKSB7CisJCW1pcGlfdHhfaW5pdF9jZmcu
YWN0aXZlX2xhbmVzID0gMjsKKwkJbWlwaV90eF9pbml0X2NmZy5sYW5lX3JhdGVfbWJwcyA9IGRh
dGFfcmF0ZSAqIDI7CisJfSBlbHNlIHsKKwkJbWlwaV90eF9pbml0X2NmZy5sYW5lX3JhdGVfbWJw
cyA9IGRhdGFfcmF0ZTsKKwl9CisKKwlrbWJfd3JpdGVfbWlwaShrbWJfZHNpLCBEUEhZX0VOQUJM
RSwgMCk7CisJa21iX3dyaXRlX21pcGkoa21iX2RzaSwgRFBIWV9JTklUX0NUUkwwLCAwKTsKKwlr
bWJfd3JpdGVfbWlwaShrbWJfZHNpLCBEUEhZX0lOSVRfQ1RSTDEsIDApOworCWttYl93cml0ZV9t
aXBpKGttYl9kc2ksIERQSFlfSU5JVF9DVFJMMiwgMCk7CisKKwkvKiBJbml0aWFsaXplIG1pcGkg
Y29udHJvbGxlciAqLworCW1pcGlfdHhfaW5pdF9jbnRybChrbWJfZHNpLCAmbWlwaV90eF9pbml0
X2NmZyk7CisKKwkvKiBEcGh5IGluaXRpYWxpemF0aW9uICovCisJbWlwaV90eF9pbml0X2RwaHko
a21iX2RzaSwgJm1pcGlfdHhfaW5pdF9jZmcpOworCisJZGV2X2luZm8oa21iX2RzaS0+ZGV2LCAi
bWlwaSBod19pbml0aWFsaXplZCIpOworCisJcmV0dXJuIDA7Cit9CisKK3N0cnVjdCBrbWJfZHNp
ICprbWJfZHNpX2luaXQoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKK3sKKwlzdHJ1Y3Qg
a21iX2RzaSAqa21iX2RzaTsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSBnZXRfZGV2aWNlKCZwZGV2
LT5kZXYpOworCisJa21iX2RzaSA9IGRldm1fa3phbGxvYyhkZXYsIHNpemVvZigqa21iX2RzaSks
IEdGUF9LRVJORUwpOworCWlmICgha21iX2RzaSkgeworCQlkZXZfZXJyKGRldiwgImZhaWxlZCB0
byBhbGxvY2F0ZSBrbWJfZHNpXG4iKTsKKwkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7CisJfQor
CisJa21iX2RzaS0+aG9zdCA9IGRzaV9ob3N0OworCWttYl9kc2ktPmhvc3QtPm9wcyA9ICZrbWJf
ZHNpX2hvc3Rfb3BzOworCisJZHNpX2RldmljZS0+aG9zdCA9IGttYl9kc2ktPmhvc3Q7CisJa21i
X2RzaS0+ZGV2aWNlID0gZHNpX2RldmljZTsKKworCXJldHVybiBrbWJfZHNpOworfQorCitpbnQg
a21iX2RzaV9lbmNvZGVyX2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgc3RydWN0IGttYl9k
c2kgKmttYl9kc2kpCit7CisJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyOworCXN0cnVjdCBk
cm1fY29ubmVjdG9yICpjb25uZWN0b3I7CisJaW50IHJldCA9IDA7CisKKwllbmNvZGVyID0gJmtt
Yl9kc2ktPmJhc2U7CisJZW5jb2Rlci0+cG9zc2libGVfY3J0Y3MgPSAxOworCWVuY29kZXItPnBv
c3NpYmxlX2Nsb25lcyA9IDA7CisKKwlyZXQgPSBkcm1fc2ltcGxlX2VuY29kZXJfaW5pdChkZXYs
IGVuY29kZXIsIERSTV9NT0RFX0VOQ09ERVJfRFNJKTsKKwlpZiAocmV0KSB7CisJCWRldl9lcnIo
a21iX2RzaS0+ZGV2LCAiRmFpbGVkIHRvIGluaXQgZW5jb2RlciAlZFxuIiwgcmV0KTsKKwkJcmV0
dXJuIHJldDsKKwl9CisKKwkvKiBMaW5rIGRybV9icmlkZ2UgdG8gZW5jb2RlciAqLworCXJldCA9
IGRybV9icmlkZ2VfYXR0YWNoKGVuY29kZXIsIGFkdl9icmlkZ2UsIE5VTEwsCisJCQkJRFJNX0JS
SURHRV9BVFRBQ0hfTk9fQ09OTkVDVE9SKTsKKwlpZiAocmV0KSB7CisJCURSTV9FUlJPUigiZmFp
bGVkIHRvIGF0dGFjaCBicmlkZ2UgdG8gTUlQSVxuIik7CisJCWRybV9lbmNvZGVyX2NsZWFudXAo
ZW5jb2Rlcik7CisJCXJldHVybiByZXQ7CisJfQorCWRybV9pbmZvKGRldiwgIkJyaWRnZSBhdHRh
Y2hlZCA6IFNVQ0NFU1MiKTsKKwljb25uZWN0b3IgPSBkcm1fYnJpZGdlX2Nvbm5lY3Rvcl9pbml0
KGRldiwgZW5jb2Rlcik7CisJaWYgKElTX0VSUihjb25uZWN0b3IpKSB7CisJCURSTV9FUlJPUigi
VW5hYmxlIHRvIGNyZWF0ZSBicmlkZ2UgY29ubmVjdG9yIik7CisJCWRybV9lbmNvZGVyX2NsZWFu
dXAoZW5jb2Rlcik7CisJCXJldHVybiBQVFJfRVJSKGNvbm5lY3Rvcik7CisJfQorCWRybV9jb25u
ZWN0b3JfYXR0YWNoX2VuY29kZXIoY29ubmVjdG9yLCBlbmNvZGVyKTsKKwlyZXR1cm4gMDsKK30K
KworaW50IGttYl9kc2lfbWFwX21taW8oc3RydWN0IGttYl9kc2kgKmttYl9kc2kpCit7CisJc3Ry
dWN0IHJlc291cmNlICpyZXM7CisJc3RydWN0IGRldmljZSAqZGV2ID0ga21iX2RzaS0+ZGV2Owor
CisJcmVzID0gcGxhdGZvcm1fZ2V0X3Jlc291cmNlX2J5bmFtZShrbWJfZHNpLT5wZGV2LCBJT1JF
U09VUkNFX01FTSwKKwkJCQkJICAgIm1pcGkiKTsKKwlpZiAoIXJlcykgeworCQlkZXZfZXJyKGRl
diwgImZhaWxlZCB0byBnZXQgcmVzb3VyY2UgZm9yIG1pcGkiKTsKKwkJcmV0dXJuIC1FTk9NRU07
CisJfQorCWttYl9kc2ktPm1pcGlfbW1pbyA9IGRldm1faW9yZW1hcF9yZXNvdXJjZShkZXYsIHJl
cyk7CisJaWYgKElTX0VSUihrbWJfZHNpLT5taXBpX21taW8pKSB7CisJCWRldl9lcnIoZGV2LCAi
ZmFpbGVkIHRvIGlvcmVtYXAgbWlwaSByZWdpc3RlcnMiKTsKKwkJcmV0dXJuIFBUUl9FUlIoa21i
X2RzaS0+bWlwaV9tbWlvKTsKKwl9CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQga21iX2Rz
aV9jbGtfZW5hYmxlKHN0cnVjdCBrbWJfZHNpICprbWJfZHNpKQoreworCWludCByZXQ7CisJc3Ry
dWN0IGRldmljZSAqZGV2ID0ga21iX2RzaS0+ZGV2OworCisJcmV0ID0gY2xrX3ByZXBhcmVfZW5h
YmxlKGttYl9kc2ktPmNsa19taXBpKTsKKwlpZiAocmV0KSB7CisJCWRldl9lcnIoZGV2LCAiRmFp
bGVkIHRvIGVuYWJsZSBNSVBJIGNsb2NrOiAlZFxuIiwgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9
CisKKwlyZXQgPSBjbGtfcHJlcGFyZV9lbmFibGUoa21iX2RzaS0+Y2xrX21pcGlfZWNmZyk7CisJ
aWYgKHJldCkgeworCQlkZXZfZXJyKGRldiwgIkZhaWxlZCB0byBlbmFibGUgTUlQSV9FQ0ZHIGNs
b2NrOiAlZFxuIiwgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXQgPSBjbGtfcHJlcGFy
ZV9lbmFibGUoa21iX2RzaS0+Y2xrX21pcGlfY2ZnKTsKKwlpZiAocmV0KSB7CisJCWRldl9lcnIo
ZGV2LCAiRmFpbGVkIHRvIGVuYWJsZSBNSVBJX0NGRyBjbG9jazogJWRcbiIsIHJldCk7CisJCXJl
dHVybiByZXQ7CisJfQorCisJZGV2X2luZm8oZGV2LCAiU1VDQ0VTUyA6IGVuYWJsZWQgTUlQSSBj
bG9ja3NcbiIpOworCXJldHVybiAwOworfQorCitpbnQga21iX2RzaV9jbGtfaW5pdChzdHJ1Y3Qg
a21iX2RzaSAqa21iX2RzaSkKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSBrbWJfZHNpLT5kZXY7
CisJdW5zaWduZWQgbG9uZyBjbGs7CisKKwlrbWJfZHNpLT5jbGtfbWlwaSA9IGRldm1fY2xrX2dl
dChkZXYsICJjbGtfbWlwaSIpOworCWlmIChJU19FUlIoa21iX2RzaS0+Y2xrX21pcGkpKSB7CisJ
CWRldl9lcnIoZGV2LCAiZGV2bV9jbGtfZ2V0KCkgZmFpbGVkIGNsa19taXBpXG4iKTsKKwkJcmV0
dXJuIFBUUl9FUlIoa21iX2RzaS0+Y2xrX21pcGkpOworCX0KKworCWttYl9kc2ktPmNsa19taXBp
X2VjZmcgPSBkZXZtX2Nsa19nZXQoZGV2LCAiY2xrX21pcGlfZWNmZyIpOworCWlmIChJU19FUlIo
a21iX2RzaS0+Y2xrX21pcGlfZWNmZykpIHsKKwkJZGV2X2VycihkZXYsICJkZXZtX2Nsa19nZXQo
KSBmYWlsZWQgY2xrX21pcGlfZWNmZ1xuIik7CisJCXJldHVybiBQVFJfRVJSKGttYl9kc2ktPmNs
a19taXBpX2VjZmcpOworCX0KKworCWttYl9kc2ktPmNsa19taXBpX2NmZyA9IGRldm1fY2xrX2dl
dChkZXYsICJjbGtfbWlwaV9jZmciKTsKKwlpZiAoSVNfRVJSKGttYl9kc2ktPmNsa19taXBpX2Nm
ZykpIHsKKwkJZGV2X2VycihkZXYsICJkZXZtX2Nsa19nZXQoKSBmYWlsZWQgY2xrX21pcGlfY2Zn
XG4iKTsKKwkJcmV0dXJuIFBUUl9FUlIoa21iX2RzaS0+Y2xrX21pcGlfY2ZnKTsKKwl9CisJLyog
U2V0IE1JUEkgY2xvY2sgdG8gMjQgTWh6ICovCisJY2xrX3NldF9yYXRlKGttYl9kc2ktPmNsa19t
aXBpLCBLTUJfTUlQSV9ERUZBVUxUX0NMSyk7CisJaWYgKGNsa19nZXRfcmF0ZShrbWJfZHNpLT5j
bGtfbWlwaSkgIT0gS01CX01JUElfREVGQVVMVF9DTEspIHsKKwkJZGV2X2VycihkZXYsICJmYWls
ZWQgdG8gc2V0IHRvIGNsa19taXBpIHRvICVkXG4iLAorCQkJS01CX01JUElfREVGQVVMVF9DTEsp
OworCQlyZXR1cm4gLTE7CisJfQorCWRldl9kYmcoZGV2LCAiY2xrX21pcGkgPSAlbGRcbiIsIGNs
a19nZXRfcmF0ZShrbWJfZHNpLT5jbGtfbWlwaSkpOworCisJY2xrID0gY2xrX2dldF9yYXRlKGtt
Yl9kc2ktPmNsa19taXBpX2VjZmcpOworCWlmIChjbGsgIT0gS01CX01JUElfREVGQVVMVF9DRkdf
Q0xLKSB7CisJCS8qIFNldCBNSVBJX0VDRkcgY2xvY2sgdG8gMjQgTWh6ICovCisJCWNsa19zZXRf
cmF0ZShrbWJfZHNpLT5jbGtfbWlwaV9lY2ZnLCBLTUJfTUlQSV9ERUZBVUxUX0NGR19DTEspOwor
CQljbGsgPSBjbGtfZ2V0X3JhdGUoa21iX2RzaS0+Y2xrX21pcGlfZWNmZyk7CisJCWlmIChjbGsg
IT0gS01CX01JUElfREVGQVVMVF9DRkdfQ0xLKSB7CisJCQlkZXZfZXJyKGRldiwgImZhaWxlZCB0
byBzZXQgdG8gY2xrX21pcGlfZWNmZyB0byAlZFxuIiwKKwkJCQlLTUJfTUlQSV9ERUZBVUxUX0NG
R19DTEspOworCQkJcmV0dXJuIC0xOworCQl9CisJfQorCisJY2xrID0gY2xrX2dldF9yYXRlKGtt
Yl9kc2ktPmNsa19taXBpX2NmZyk7CisJaWYgKGNsayAhPSBLTUJfTUlQSV9ERUZBVUxUX0NGR19D
TEspIHsKKwkJLyogU2V0IE1JUElfQ0ZHIGNsb2NrIHRvIDI0IE1oeiAqLworCQljbGtfc2V0X3Jh
dGUoa21iX2RzaS0+Y2xrX21pcGlfY2ZnLCAyNDAwMDAwMCk7CisJCWNsayA9IGNsa19nZXRfcmF0
ZShrbWJfZHNpLT5jbGtfbWlwaV9jZmcpOworCQlpZiAoY2xrICE9IEtNQl9NSVBJX0RFRkFVTFRf
Q0ZHX0NMSykgeworCQkJZGV2X2VycihkZXYsICJmYWlsZWQgdG8gc2V0IGNsa19taXBpX2NmZyB0
byAlZFxuIiwKKwkJCQlLTUJfTUlQSV9ERUZBVUxUX0NGR19DTEspOworCQkJcmV0dXJuIC0xOwor
CQl9CisJfQorCisJcmV0dXJuIGttYl9kc2lfY2xrX2VuYWJsZShrbWJfZHNpKTsKK30KZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9rbWIva21iX2RzaS5oIGIvZHJpdmVycy9ncHUvZHJtL2tt
Yi9rbWJfZHNpLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uNjZiN2M1MAot
LS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9rbWIva21iX2RzaS5oCkBAIC0wLDAg
KzEsMzg3IEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5CisgKgor
ICogQ29weXJpZ2h0IMKpIDIwMTktMjAyMCBJbnRlbCBDb3Jwb3JhdGlvbgorICovCisKKyNpZm5k
ZWYgX19LTUJfRFNJX0hfXworI2RlZmluZSBfX0tNQl9EU0lfSF9fCisKKyNpbmNsdWRlIDxkcm0v
ZHJtX2VuY29kZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX21pcGlfZHNpLmg+CisKKy8qIE1JUEkg
VFggQ0ZHICovCisjZGVmaW5lIE1JUElfVFhfTEFORV9EQVRBX1JBVEVfTUJQUyA4OTEKKyNkZWZp
bmUgTUlQSV9UWF9SRUZfQ0xLX0tIWiAgICAgICAgIDI0MDAwCisjZGVmaW5lIE1JUElfVFhfQ0ZH
X0NMS19LSFogICAgICAgICAyNDAwMAorI2RlZmluZSBNSVBJX1RYX0JQUAkJICAgIDI0CisKKy8q
IERQSFkgVHggdGVzdCBjb2RlcyovCisjZGVmaW5lIFRFU1RfQ09ERV9GU01fQ09OVFJPTAkJCQkw
eDAzCisjZGVmaW5lIFRFU1RfQ09ERV9NVUxUSVBMRV9QSFlfQ1RSTAkJCTB4MEMKKyNkZWZpbmUg
VEVTVF9DT0RFX1BMTF9QUk9QT1JUSU9OQUxfQ0hBUkdFX1BVTVBfQ1RSTAkweDBFCisjZGVmaW5l
IFRFU1RfQ09ERV9QTExfSU5URUdSQUxfQ0hBUkdFX1BVTVBfQ1RSTAkJMHgwRgorI2RlZmluZSBU
RVNUX0NPREVfUExMX1ZDT19DVFJMCQkJCTB4MTIKKyNkZWZpbmUgVEVTVF9DT0RFX1BMTF9HTVBf
Q1RSTAkJCQkweDEzCisjZGVmaW5lIFRFU1RfQ09ERV9QTExfUEhBU0VfRVJSX0NUUkwJCQkweDE0
CisjZGVmaW5lIFRFU1RfQ09ERV9QTExfTE9DS19GSUxURVIJCQkweDE1CisjZGVmaW5lIFRFU1Rf
Q09ERV9QTExfVU5MT0NLX0ZJTFRFUgkJCTB4MTYKKyNkZWZpbmUgVEVTVF9DT0RFX1BMTF9JTlBV
VF9ESVZJREVSCQkJMHgxNworI2RlZmluZSBURVNUX0NPREVfUExMX0ZFRURCQUNLX0RJVklERVIJ
CQkweDE4CisjZGVmaW5lICAgUExMX0ZFRURCQUNLX0RJVklERVJfSElHSAkJCUJJVCg3KQorI2Rl
ZmluZSBURVNUX0NPREVfUExMX09VVFBVVF9DTEtfU0VMCQkJMHgxOQorI2RlZmluZSAgIFBMTF9O
X09WUl9FTgkJCQkJQklUKDQpCisjZGVmaW5lICAgUExMX01fT1ZSX0VOCQkJCQlCSVQoNSkKKyNk
ZWZpbmUgVEVTVF9DT0RFX1ZPRF9MRVZFTAkJCQkweDI0CisjZGVmaW5lIFRFU1RfQ09ERV9QTExf
Q0hBUkdFX1BVTVBfQklBUwkJCTB4MUMKKyNkZWZpbmUgVEVTVF9DT0RFX1BMTF9MT0NLX0RFVEVD
VE9SCQkJMHgxRAorI2RlZmluZSBURVNUX0NPREVfSFNfRlJFUV9SQU5HRV9DRkcJCQkweDQ0Cisj
ZGVmaW5lIFRFU1RfQ09ERV9QTExfQU5BTE9HX1BST0cJCQkweDFGCisjZGVmaW5lIFRFU1RfQ09E
RV9TTEVXX1JBVEVfT1ZFUlJJREVfQ1RSTAkJMHhBMAorI2RlZmluZSBURVNUX0NPREVfU0xFV19S
QVRFX0RETF9MT09QX0NUUkwJCTB4QTMKKyNkZWZpbmUgVEVTVF9DT0RFX1NMRVdfUkFURV9ERExf
Q1lDTEVTCQkJMHhBNAorCisvKiBEUEhZIHBhcmFtcyAqLworI2RlZmluZSBQTExfTl9NSU4JMAor
I2RlZmluZSBQTExfTl9NQVgJMTUKKyNkZWZpbmUgUExMX01fTUlOCTYyCisjZGVmaW5lIFBMTF9N
X01BWAk2MjMKKyNkZWZpbmUgUExMX0ZWQ09fTUFYCTEyNTAKKworI2RlZmluZSBUSU1FT1VUCQk2
MDAKKworI2RlZmluZSBNSVBJX1RYX0ZSQU1FX0dFTgkJCQk0CisjZGVmaW5lIE1JUElfVFhfRlJB
TUVfR0VOX1NFQ1RJT05TCQkJNAorI2RlZmluZSBNSVBJX0NUUkxfVklSVFVBTF9DSEFOTkVMUwkJ
CTQKKyNkZWZpbmUgTUlQSV9EX0xBTkVTX1BFUl9EUEhZCQkJCTIKKyNkZWZpbmUgTUlQSV9DVFJM
XzJMQU5FX01BWF9NQ19GSUZPX0xPQwkJCTI1NQorI2RlZmluZSBNSVBJX0NUUkxfNExBTkVfTUFY
X01DX0ZJRk9fTE9DCQkJNTExCisvKiAyIERhdGEgTGFuZXMgcGVyIEQtUEhZICovCisjZGVmaW5l
IE1JUElfRFBIWV9EX0xBTkVTCQkJCTIKKyNkZWZpbmUgTUlQSV9EUEhZX0RFRkFVTFRfQklUX1JB
VEVTCQkJNjMKKworI2RlZmluZSBLTUJfTUlQSV9ERUZBVUxUX0NMSwkJCQkyNDAwMDAwMAorI2Rl
ZmluZSBLTUJfTUlQSV9ERUZBVUxUX0NGR19DTEsJCQkyNDAwMDAwMAorCisjZGVmaW5lIHRvX2tt
Yl9kc2koeCkgY29udGFpbmVyX29mKHgsIHN0cnVjdCBrbWJfZHNpLCBiYXNlKQorCitzdHJ1Y3Qg
a21iX2RzaSB7CisJc3RydWN0IGRybV9lbmNvZGVyIGJhc2U7CisJc3RydWN0IGRldmljZSAqZGV2
OworCXN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXY7CisJc3RydWN0IG1pcGlfZHNpX2hvc3Qg
Kmhvc3Q7CisJc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZGV2aWNlOworCXN0cnVjdCBkcm1fYnJp
ZGdlICphZHZfYnJpZGdlOworCXZvaWQgX19pb21lbSAqbWlwaV9tbWlvOworCXN0cnVjdCBjbGsg
KmNsa19taXBpOworCXN0cnVjdCBjbGsgKmNsa19taXBpX2VjZmc7CisJc3RydWN0IGNsayAqY2xr
X21pcGlfY2ZnOworCWludCBzeXNfY2xrX21oejsKK307CisKKy8qIERQSFkgVHggdGVzdCBjb2Rl
cyAqLworCitlbnVtIG1pcGlfY3RybF9udW0geworCU1JUElfQ1RSTDAgPSAwLAorCU1JUElfQ1RS
TDEsCisJTUlQSV9DVFJMMiwKKwlNSVBJX0NUUkwzLAorCU1JUElfQ1RSTDQsCisJTUlQSV9DVFJM
NSwKKwlNSVBJX0NUUkw2LAorCU1JUElfQ1RSTDcsCisJTUlQSV9DVFJMOCwKKwlNSVBJX0NUUkw5
LAorCU1JUElfQ1RSTF9OQQorfTsKKworZW51bSBtaXBpX2RwaHlfbnVtIHsKKwlNSVBJX0RQSFkw
ID0gMCwKKwlNSVBJX0RQSFkxLAorCU1JUElfRFBIWTIsCisJTUlQSV9EUEhZMywKKwlNSVBJX0RQ
SFk0LAorCU1JUElfRFBIWTUsCisJTUlQSV9EUEhZNiwKKwlNSVBJX0RQSFk3LAorCU1JUElfRFBI
WTgsCisJTUlQSV9EUEhZOSwKKwlNSVBJX0RQSFlfTkEKK307CisKK2VudW0gbWlwaV9kaXIgewor
CU1JUElfUlgsCisJTUlQSV9UWAorfTsKKworZW51bSBtaXBpX2N0cmxfdHlwZSB7CisJTUlQSV9E
U0ksCisJTUlQSV9DU0kKK307CisKK2VudW0gbWlwaV9kYXRhX2lmIHsKKwlNSVBJX0lGX0RNQSwK
KwlNSVBJX0lGX1BBUkFMTEVMCit9OworCitlbnVtIG1pcGlfZGF0YV9tb2RlIHsKKwlNSVBJX0RB
VEFfTU9ERTAsCisJTUlQSV9EQVRBX01PREUxLAorCU1JUElfREFUQV9NT0RFMiwKKwlNSVBJX0RB
VEFfTU9ERTMKK307CisKK2VudW0gbWlwaV9kc2lfdmlkZW9fbW9kZSB7CisJRFNJX1ZJREVPX01P
REVfTk9fQlVSU1RfUFVMU0UsCisJRFNJX1ZJREVPX01PREVfTk9fQlVSU1RfRVZFTlQsCisJRFNJ
X1ZJREVPX01PREVfQlVSU1QKK307CisKK2VudW0gbWlwaV9kc2lfYmxhbmtpbmdfbW9kZSB7CisJ
VFJBTlNJVElPTl9UT19MT1dfUE9XRVIsCisJU0VORF9CTEFOS19QQUNLRVQKK307CisKK2VudW0g
bWlwaV9kc2lfZW90cCB7CisJRFNJX0VPVFBfRElTQUJMRUQsCisJRFNJX0VPVFBfRU5BQkxFUwor
fTsKKworZW51bSBtaXBpX2RzaV9kYXRhX3R5cGUgeworCURTSV9TUF9EVF9SRVNFUlZFRF8wMCA9
IDB4MDAsCisJRFNJX1NQX0RUX1ZTWU5DX1NUQVJUID0gMHgwMSwKKwlEU0lfU1BfRFRfQ09MT1Jf
TU9ERV9PRkYgPSAweDAyLAorCURTSV9TUF9EVF9HRU5FUklDX1NIT1JUX1dSID0gMHgwMywKKwlE
U0lfU1BfRFRfR0VORVJJQ19SRCA9IDB4MDQsCisJRFNJX1NQX0RUX0RDU19TSE9SVF9XUiA9IDB4
MDUsCisJRFNJX1NQX0RUX0RDU19SRCA9IDB4MDYsCisJRFNJX1NQX0RUX0VPVFAgPSAweDA4LAor
CURTSV9MUF9EVF9OVUxMID0gMHgwOSwKKwlEU0lfTFBfRFRfUkVTRVJWRURfMEEgPSAweDBhLAor
CURTSV9MUF9EVF9SRVNFUlZFRF8wQiA9IDB4MGIsCisJRFNJX0xQX0RUX0xQUFNfWUNCQ1I0MjJf
MjBCID0gMHgwYywKKwlEU0lfTFBfRFRfUFBTX1JHQjEwMTAxMF8zMEIgPSAweDBkLAorCURTSV9M
UF9EVF9QUFNfUkdCNTY1XzE2QiA9IDB4MGUsCisJRFNJX0xQX0RUX1JFU0VSVkVEXzBGID0gMHgw
ZiwKKworCURTSV9TUF9EVF9SRVNFUlZFRF8xMCA9IDB4MTAsCisJRFNJX1NQX0RUX1ZTWU5DX0VO
RCA9IDB4MTEsCisJRFNJX1NQX0RUX0NPTE9SX01PREVfT04gPSAweDEyLAorCURTSV9TUF9EVF9H
RU5FUklDX1NIT1JUX1dSXzFQQVIgPSAweDEzLAorCURTSV9TUF9EVF9HRU5FUklDX1JEXzFQQVIg
PSAweDE0LAorCURTSV9TUF9EVF9EQ1NfU0hPUlRfV1JfMVBBUiA9IDB4MTUsCisJRFNJX1NQX0RU
X1JFU0VSVkVEXzE2ID0gMHgxNiwKKwlEU0lfU1BfRFRfUkVTRVJWRURfMTcgPSAweDE3LAorCURT
SV9TUF9EVF9SRVNFUlZFRF8xOCA9IDB4MTgsCisJRFNJX0xQX0RUX0JMQU5LID0gMHgxOSwKKwlE
U0lfTFBfRFRfUkVTRVJWRURfMUEgPSAweDFhLAorCURTSV9MUF9EVF9SRVNFUlZFRF8xQiA9IDB4
MWIsCisJRFNJX0xQX0RUX1BQU19ZQ0JDUjQyMl8yNEIgPSAweDFjLAorCURTSV9MUF9EVF9QUFNf
UkdCMTIxMjEyXzM2QiA9IDB4MWQsCisJRFNJX0xQX0RUX1BQU19SR0I2NjZfMThCID0gMHgxZSwK
KwlEU0lfTFBfRFRfUkVTRVJWRURfMUYgPSAweDFmLAorCisJRFNJX1NQX0RUX1JFU0VSVkVEXzIw
ID0gMHgyMCwKKwlEU0lfU1BfRFRfSFNZTkNfU1RBUlQgPSAweDIxLAorCURTSV9TUF9EVF9TSFVU
X0RPV05fUEVSSVBIX0NNRCA9IDB4MjIsCisJRFNJX1NQX0RUX0dFTkVSSUNfU0hPUlRfV1JfMlBB
UiA9IDB4MjMsCisJRFNJX1NQX0RUX0dFTkVSSUNfUkRfMlBBUiA9IDB4MjQsCisJRFNJX1NQX0RU
X1JFU0VSVkVEXzI1ID0gMHgyNSwKKwlEU0lfU1BfRFRfUkVTRVJWRURfMjYgPSAweDI2LAorCURT
SV9TUF9EVF9SRVNFUlZFRF8yNyA9IDB4MjcsCisJRFNJX1NQX0RUX1JFU0VSVkVEXzI4ID0gMHgy
OCwKKwlEU0lfTFBfRFRfR0VORVJJQ19MT05HX1dSID0gMHgyOSwKKwlEU0lfTFBfRFRfUkVTRVJW
RURfMkEgPSAweDJhLAorCURTSV9MUF9EVF9SRVNFUlZFRF8yQiA9IDB4MmIsCisJRFNJX0xQX0RU
X1BQU19ZQ0JDUjQyMl8xNkIgPSAweDJjLAorCURTSV9MUF9EVF9SRVNFUlZFRF8yRCA9IDB4MmQs
CisJRFNJX0xQX0RUX0xQUFNfUkdCNjY2XzE4QiA9IDB4MmUsCisJRFNJX0xQX0RUX1JFU0VSVkVE
XzJGID0gMHgyZiwKKworCURTSV9TUF9EVF9SRVNFUlZFRF8zMCA9IDB4MzAsCisJRFNJX1NQX0RU
X0hTWU5DX0VORCA9IDB4MzEsCisJRFNJX1NQX0RUX1RVUk5fT05fUEVSSVBIX0NNRCA9IDB4MzIs
CisJRFNJX1NQX0RUX1JFU0VSVkVEXzMzID0gMHgzMywKKwlEU0lfU1BfRFRfUkVTRVJWRURfMzQg
PSAweDM0LAorCURTSV9TUF9EVF9SRVNFUlZFRF8zNSA9IDB4MzUsCisJRFNJX1NQX0RUX1JFU0VS
VkVEXzM2ID0gMHgzNiwKKwlEU0lfU1BfRFRfU0VUX01BWF9SRVRVUk5fUEtUX1NJWkUgPSAweDM3
LAorCURTSV9TUF9EVF9SRVNFUlZFRF8zOCA9IDB4MzgsCisJRFNJX0xQX0RUX0RTQ19MT05HX1dS
ID0gMHgzOSwKKwlEU0lfTFBfRFRfUkVTRVJWRURfM0EgPSAweDNhLAorCURTSV9MUF9EVF9SRVNF
UlZFRF8zQiA9IDB4M2IsCisJRFNJX0xQX0RUX1JFU0VSVkVEXzNDID0gMHgzYywKKwlEU0lfTFBf
RFRfUFBTX1lDQkNSNDIwXzEyQiA9IDB4M2QsCisJRFNJX0xQX0RUX1BQU19SR0I4ODhfMjRCID0g
MHgzZSwKKwlEU0lfTFBfRFRfUkVTRVJWRURfM0YgPSAweDNmCit9OworCitlbnVtIG1pcGlfdHhf
aHNfdHBfc2VsIHsKKwlNSVBJX1RYX0hTX1RQX1dIT0xFX0ZSQU1FX0NPTE9SMCA9IDAsCisJTUlQ
SV9UWF9IU19UUF9XSE9MRV9GUkFNRV9DT0xPUjEsCisJTUlQSV9UWF9IU19UUF9WX1NUUklQRVMs
CisJTUlQSV9UWF9IU19UUF9IX1NUUklQRVMsCit9OworCitlbnVtIGRwaHlfbW9kZSB7CisJTUlQ
SV9EUEhZX1NMQVZFID0gMCwKKwlNSVBJX0RQSFlfTUFTVEVSCit9OworCitlbnVtIGRwaHlfdHhf
ZnNtIHsKKwlEUEhZX1RYX1BPV0VSRFdOID0gMCwKKwlEUEhZX1RYX0JHUE9OLAorCURQSFlfVFhf
VEVSTUNBTCwKKwlEUEhZX1RYX1RFUk1DQUxVUCwKKwlEUEhZX1RYX09GRlNFVENBTCwKKwlEUEhZ
X1RYX0xPQ0ssCisJRFBIWV9UWF9TUkNBTCwKKwlEUEhZX1RYX0lETEUsCisJRFBIWV9UWF9VTFAs
CisJRFBIWV9UWF9MQU5FU1RBUlQsCisJRFBIWV9UWF9DTEtBTElHTiwKKwlEUEhZX1RYX0RETFRV
Tk5JTkcsCisJRFBIWV9UWF9VTFBfRk9SQ0VfUExMLAorCURQSFlfVFhfTE9DS19MT1NTCit9Owor
CitzdHJ1Y3QgbWlwaV9kYXRhX3R5cGVfcGFyYW1zIHsKKwl1OCBzaXplX2NvbnN0cmFpbnRfcGl4
ZWxzOworCXU4IHNpemVfY29uc3RyYWludF9ieXRlczsKKwl1OCBwaXhlbHNfcGVyX3BjbGs7CisJ
dTggYml0c19wZXJfcGNsazsKK307CisKK3N0cnVjdCBtaXBpX3R4X2RzaV9jZmcgeworCXU4IGhm
cF9ibGFua19lbjsJLyogSG9yaXpvbnRhbCBmcm9udCBwb3JjaCBibGFua2luZyBlbmFibGUgKi8K
Kwl1OCBlb3RwX2VuOwkJLyogRW5kIG9mIHRyYW5zbWlzc2lvbiBwYWNrZXQgZW5hYmxlICovCisJ
LyogTGFzdCB2ZXJ0aWNhbCBmcm9udCBwb3JjaCBibGFua2luZyBtb2RlICovCisJdTggbHBtX2xh
c3RfdmZwX2xpbmU7CisJLyogRmlyc3QgdmVydGljYWwgc3luYyBhY3RpdmUgYmxhbmtpbmcgbW9k
ZSAqLworCXU4IGxwbV9maXJzdF92c2FfbGluZTsKKwl1OCBzeW5jX3B1bHNlX2V2ZW50bjsJLyog
U3luYyB0eXBlICovCisJdTggaGZwX2JsYW5raW5nOwkvKiBIb3Jpem9udGFsIGZyb250IHBvcmNo
IGJsYW5raW5nIG1vZGUgKi8KKwl1OCBoYnBfYmxhbmtpbmc7CS8qIEhvcml6b250YWwgYmFjayBw
b3JjaCBibGFua2luZyBtb2RlICovCisJdTggaHNhX2JsYW5raW5nOwkvKiBIb3Jpem9udGFsIHN5
bmMgYWN0aXZlIGJsYW5raW5nIG1vZGUgKi8KKwl1OCB2X2JsYW5raW5nOwkJLyogVmVydGljYWwg
dGltaW5nIGJsYW5raW5nIG1vZGUgKi8KK307CisKK3N0cnVjdCBtaXBpX3R4X2ZyYW1lX3NlY3Rp
b25fY2ZnIHsKKwl1MzIgZG1hX3Zfc3RyaWRlOworCXUxNiBkbWFfdl9zY2FsZV9jZmc7CisJdTE2
IHdpZHRoX3BpeGVsczsKKwl1MTYgaGVpZ2h0X2xpbmVzOworCXU4IGRtYV9wYWNrZWQ7CisJdTgg
YnBwOworCXU4IGJwcF91bnBhY2tlZDsKKwl1OCBkbWFfaF9zdHJpZGU7CisJdTggZGF0YV90eXBl
OworCXU4IGRhdGFfbW9kZTsKKwl1OCBkbWFfZmxpcF9yb3RhdGVfc2VsOworfTsKKworc3RydWN0
IG1pcGlfdHhfZnJhbWVfdGltaW5nX2NmZyB7CisJdTMyIGJwcDsKKwl1MzIgbGFuZV9yYXRlX21i
cHM7CisJdTMyIGhzeW5jX3dpZHRoOworCXUzMiBoX2JhY2twb3JjaDsKKwl1MzIgaF9mcm9udHBv
cmNoOworCXUzMiBoX2FjdGl2ZTsKKwl1MTYgdnN5bmNfd2lkdGg7CisJdTE2IHZfYmFja3BvcmNo
OworCXUxNiB2X2Zyb250cG9yY2g7CisJdTE2IHZfYWN0aXZlOworCXU4IGFjdGl2ZV9sYW5lczsK
K307CisKK3N0cnVjdCBtaXBpX3R4X2ZyYW1lX3NlY3RfcGhjZmcgeworCXUzMiB3YzsKKwllbnVt
IG1pcGlfZGF0YV9tb2RlIGRhdGFfbW9kZTsKKwllbnVtIG1pcGlfZHNpX2RhdGFfdHlwZSBkYXRh
X3R5cGU7CisJdTggdmNoYW5uZWw7CisJdTggZG1hX3BhY2tlZDsKK307CisKK3N0cnVjdCBtaXBp
X3R4X2ZyYW1lX2NmZyB7CisJc3RydWN0IG1pcGlfdHhfZnJhbWVfc2VjdGlvbl9jZmcgKnNlY3Rp
b25zW01JUElfVFhfRlJBTUVfR0VOX1NFQ1RJT05TXTsKKwl1MzIgaHN5bmNfd2lkdGg7CS8qIGlu
IHBpeGVscyAqLworCXUzMiBoX2JhY2twb3JjaDsJLyogaW4gcGl4ZWxzICovCisJdTMyIGhfZnJv
bnRwb3JjaDsJLyogaW4gcGl4ZWxzICovCisJdTE2IHZzeW5jX3dpZHRoOwkvKiBpbiBsaW5lcyAq
LworCXUxNiB2X2JhY2twb3JjaDsJLyogaW4gbGluZXMgKi8KKwl1MTYgdl9mcm9udHBvcmNoOwkv
KiBpbiBsaW5lcyAqLworfTsKKworc3RydWN0IG1pcGlfdHhfY3RybF9jZmcgeworCXN0cnVjdCBt
aXBpX3R4X2ZyYW1lX2NmZyAqZnJhbWVzW01JUElfVFhfRlJBTUVfR0VOXTsKKwljb25zdCBzdHJ1
Y3QgbWlwaV90eF9kc2lfY2ZnICp0eF9kc2lfY2ZnOworCXU4IGxpbmVfc3luY19wa3RfZW47CisJ
dTggbGluZV9jb3VudGVyX2FjdGl2ZTsKKwl1OCBmcmFtZV9jb3VudGVyX2FjdGl2ZTsKKwl1OCB0
eF9oc2Nsa2tpZGxlX2NudDsKKwl1OCB0eF9oc2V4aXRfY250OworCXU4IHR4X2NyY19lbjsKKwl1
OCB0eF9oYWN0X3dhaXRfc3RvcDsKKwl1OCB0eF9hbHdheXNfdXNlX2hhY3Q7CisJdTggdHhfd2Fp
dF90cmlnOworCXU4IHR4X3dhaXRfYWxsX3NlY3Q7Cit9OworCisvKiBjb25maWd1cmF0aW9uIHN0
cnVjdHVyZSBmb3IgTUlQSSBjb250cm9sICovCitzdHJ1Y3QgbWlwaV9jdHJsX2NmZyB7CisJdTgg
YWN0aXZlX2xhbmVzOwkvKiAjIGFjdGl2ZSBsYW5lcyBwZXIgY29udHJvbGxlciAyLzQgKi8KKwl1
MzIgbGFuZV9yYXRlX21icHM7CS8qIE1CUFMgKi8KKwl1MzIgcmVmX2Nsa19raHo7CisJdTMyIGNm
Z19jbGtfa2h6OworCXN0cnVjdCBtaXBpX3R4X2N0cmxfY2ZnIHR4X2N0cmxfY2ZnOworfTsKKwor
c3RhdGljIGlubGluZSB2b2lkIGttYl93cml0ZV9taXBpKHN0cnVjdCBrbWJfZHNpICprbWJfZHNp
LAorCQkJCSAgdW5zaWduZWQgaW50IHJlZywgdTMyIHZhbHVlKQoreworCXdyaXRlbCh2YWx1ZSwg
KGttYl9kc2ktPm1pcGlfbW1pbyArIHJlZykpOworfQorCitzdGF0aWMgaW5saW5lIHUzMiBrbWJf
cmVhZF9taXBpKHN0cnVjdCBrbWJfZHNpICprbWJfZHNpLCB1bnNpZ25lZCBpbnQgcmVnKQorewor
CXJldHVybiByZWFkbChrbWJfZHNpLT5taXBpX21taW8gKyByZWcpOworfQorCitzdGF0aWMgaW5s
aW5lIHZvaWQga21iX3dyaXRlX2JpdHNfbWlwaShzdHJ1Y3Qga21iX2RzaSAqa21iX2RzaSwKKwkJ
CQkgICAgICAgdW5zaWduZWQgaW50IHJlZywgdTMyIG9mZnNldCwKKwkJCQkgICAgICAgdTMyIG51
bV9iaXRzLCB1MzIgdmFsdWUpCit7CisJdTMyIHJlZ192YWwgPSBrbWJfcmVhZF9taXBpKGttYl9k
c2ksIHJlZyk7CisJdTMyIG1hc2sgPSAoMSA8PCBudW1fYml0cykgLSAxOworCisJdmFsdWUgJj0g
bWFzazsKKwltYXNrIDw8PSBvZmZzZXQ7CisJcmVnX3ZhbCAmPSAofm1hc2spOworCXJlZ192YWwg
fD0gKHZhbHVlIDw8IG9mZnNldCk7CisJa21iX3dyaXRlX21pcGkoa21iX2RzaSwgcmVnLCByZWdf
dmFsKTsKK30KKworc3RhdGljIGlubGluZSB2b2lkIGttYl9zZXRfYml0X21pcGkoc3RydWN0IGtt
Yl9kc2kgKmttYl9kc2ksCisJCQkJICAgIHVuc2lnbmVkIGludCByZWcsIHUzMiBvZmZzZXQpCit7
CisJdTMyIHJlZ192YWwgPSBrbWJfcmVhZF9taXBpKGttYl9kc2ksIHJlZyk7CisKKwlrbWJfd3Jp
dGVfbWlwaShrbWJfZHNpLCByZWcsIHJlZ192YWwgfCAoMSA8PCBvZmZzZXQpKTsKK30KKworc3Rh
dGljIGlubGluZSB2b2lkIGttYl9jbHJfYml0X21pcGkoc3RydWN0IGttYl9kc2kgKmttYl9kc2ks
CisJCQkJICAgIHVuc2lnbmVkIGludCByZWcsIHUzMiBvZmZzZXQpCit7CisJdTMyIHJlZ192YWwg
PSBrbWJfcmVhZF9taXBpKGttYl9kc2ksIHJlZyk7CisKKwlrbWJfd3JpdGVfbWlwaShrbWJfZHNp
LCByZWcsIHJlZ192YWwgJiAofigxIDw8IG9mZnNldCkpKTsKK30KKworaW50IGttYl9kc2lfaG9z
dF9icmlkZ2VfaW5pdChzdHJ1Y3QgZGV2aWNlICpkZXYpOworc3RydWN0IGttYl9kc2kgKmttYl9k
c2lfaW5pdChzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KTsKK3ZvaWQga21iX2RzaV9ob3N0
X3VucmVnaXN0ZXIoc3RydWN0IGttYl9kc2kgKmttYl9kc2kpOworaW50IGttYl9kc2lfbW9kZV9z
ZXQoc3RydWN0IGttYl9kc2kgKmttYl9kc2ksIHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2Rl
LAorCQkgICAgIGludCBzeXNfY2xrX21oeik7CitpbnQga21iX2RzaV9tYXBfbW1pbyhzdHJ1Y3Qg
a21iX2RzaSAqa21iX2RzaSk7CitpbnQga21iX2RzaV9jbGtfaW5pdChzdHJ1Y3Qga21iX2RzaSAq
a21iX2RzaSk7CitpbnQga21iX2RzaV9lbmNvZGVyX2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRl
diwgc3RydWN0IGttYl9kc2kgKmttYl9kc2kpOworI2VuZGlmIC8qIF9fS01CX0RTSV9IX18gKi8K
LS0gCjIuNy40CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
XwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcK
aHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWwK
