Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 0991738574
	for <lists+dri-devel@lfdr.de>; Fri,  7 Jun 2019 09:45:37 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8D41889B66;
	Fri,  7 Jun 2019 07:43:52 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from relay7-d.mail.gandi.net (relay7-d.mail.gandi.net
 [217.70.183.200])
 by gabe.freedesktop.org (Postfix) with ESMTPS id D663A8961E
 for <dri-devel@lists.freedesktop.org>; Thu,  6 Jun 2019 14:22:18 +0000 (UTC)
X-Originating-IP: 2.224.242.101
Received: from uno.lan (2-224-242-101.ip172.fastwebnet.it [2.224.242.101])
 (Authenticated sender: jacopo@jmondi.org)
 by relay7-d.mail.gandi.net (Postfix) with ESMTPSA id 4887620011;
 Thu,  6 Jun 2019 14:22:15 +0000 (UTC)
From: Jacopo Mondi <jacopo+renesas@jmondi.org>
To: laurent.pinchart@ideasonboard.com, kieran.bingham+renesas@ideasonboard.com,
 airlied@linux.ie, daniel@ffwll.ch
Subject: [PATCH 16/20] drm: rcar-du: kms: Collect CMM instances
Date: Thu,  6 Jun 2019 16:22:16 +0200
Message-Id: <20190606142220.1392-17-jacopo+renesas@jmondi.org>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190606142220.1392-1-jacopo+renesas@jmondi.org>
References: <20190606142220.1392-1-jacopo+renesas@jmondi.org>
MIME-Version: 1.0
X-Mailman-Approved-At: Fri, 07 Jun 2019 07:43:40 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: muroya@ksk.co.jp, koji.matsuoka.xm@renesas.com,
 dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org,
 linux-renesas-soc@vger.kernel.org, VenkataRajesh.Kalakodima@in.bosch.com,
 Jacopo Mondi <jacopo+renesas@jmondi.org>,
 Harsha.ManjulaMallikarjun@in.bosch.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW1wbGVtZW50IGRldmljZSB0cmVlIHBhcnNpbmcgdG8gY29sbGVjdCB0aGUgYXZhaWxhYmxlIENN
TSBpbnN0YW5jZXMKZGVzY3JpYmVkIGJ5IHRoZSAnY21tcycgcHJvcGVydHkuIEFzc29jaWF0ZSBD
TU1zIHdpdGggQ1JUQ3MgYW5kIHN0b3JlIGEKbWFzayBvZiBhY3RpdmUgQ01NcyBpbiB0aGUgRFUg
Z3JvdXAgZm9yIGxhdGVyIGVuYWJsZW1lbnQuCgpBbHNvIGRlZmluZSBhIG5ldyBmZWF0dXJlIHRv
IGxldCBlYWNoIFNvQyBjbGFpbSBzdXBwb3J0IGZvciBDTU0uCgpTaWduZWQtb2ZmLWJ5OiBKYWNv
cG8gTW9uZGkgPGphY29wbytyZW5lc2FzQGptb25kaS5vcmc+Ci0tLQogZHJpdmVycy9ncHUvZHJt
L3JjYXItZHUvcmNhcl9kdV9jcnRjLmMgIHwgIDcgKysrKwogZHJpdmVycy9ncHUvZHJtL3JjYXIt
ZHUvcmNhcl9kdV9jcnRjLmggIHwgIDIgKwogZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9k
dV9kcnYuaCAgIHwgIDMgKysKIGRyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfZ3JvdXAu
aCB8ICAyICsKIGRyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfa21zLmMgICB8IDUwICsr
KysrKysrKysrKysrKysrKysrKysrKysKIDUgZmlsZXMgY2hhbmdlZCwgNjQgaW5zZXJ0aW9ucygr
KQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfY3J0Yy5jIGIv
ZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9jcnRjLmMKaW5kZXggMmRhNDZlM2RjNGFl
Li45ZjI3MGE1NGIxNjQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJf
ZHVfY3J0Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfY3J0Yy5jCkBA
IC0xMTk0LDYgKzExOTQsMTMgQEAgaW50IHJjYXJfZHVfY3J0Y19jcmVhdGUoc3RydWN0IHJjYXJf
ZHVfZ3JvdXAgKnJncnAsIHVuc2lnbmVkIGludCBzd2luZGV4LAogCWlmIChyZXQgPCAwKQogCQly
ZXR1cm4gcmV0OwogCisJLyogQ01NIG1pZ2h0IGJlIGRpc2FibGVkIGZvciB0aGlzIENSVEMuICov
CisJaWYgKHJjYXJfZHVfaGFzKHJjZHUsIFJDQVJfRFVfRkVBVFVSRV9DTU0pICYmCisJICAgIHJj
ZHUtPmNtbXNbc3dpbmRleF0pIHsKKwkJcmNydGMtPmNtbSA9IHJjZHUtPmNtbXNbc3dpbmRleF07
CisJCXJncnAtPmNtbXNfbWFzayB8PSBCSVQoaHdpbmRleCAlIDIpOworCX0KKwogCWRybV9jcnRj
X2hlbHBlcl9hZGQoY3J0YywgJmNydGNfaGVscGVyX2Z1bmNzKTsKIAogCS8qIFN0YXJ0IHdpdGgg
dmVydGljYWwgYmxhbmtpbmcgaW50ZXJydXB0IHJlcG9ydGluZyBkaXNhYmxlZC4gKi8KZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfY3J0Yy5oIGIvZHJpdmVycy9n
cHUvZHJtL3JjYXItZHUvcmNhcl9kdV9jcnRjLmgKaW5kZXggM2I3ZmM2Njg5OTZmLi41ZjI5NDBj
NDIyMjUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfY3J0Yy5o
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfY3J0Yy5oCkBAIC0zOSw2ICsz
OSw3IEBAIHN0cnVjdCByY2FyX2R1X3ZzcDsKICAqIEB2Ymxhbmtfd2FpdDogd2FpdCBxdWV1ZSB1
c2VkIHRvIHNpZ25hbCB2ZXJ0aWNhbCBibGFua2luZwogICogQHZibGFua19jb3VudDogbnVtYmVy
IG9mIHZlcnRpY2FsIGJsYW5raW5nIGludGVycnVwdHMgdG8gd2FpdCBmb3IKICAqIEBncm91cDog
Q1JUQyBncm91cCB0aGlzIENSVEMgYmVsb25ncyB0bworICogQGNtbTogQ01NIGFzc29jaWF0ZWQg
d2l0aCB0aGlzIENSVEMKICAqIEB2c3A6IFZTUCBmZWVkaW5nIHZpZGVvIHRvIHRoaXMgQ1JUQwog
ICogQHZzcF9waXBlOiBpbmRleCBvZiB0aGUgVlNQIHBpcGVsaW5lIGZlZWRpbmcgdmlkZW8gdG8g
dGhpcyBDUlRDCiAgKiBAd3JpdGViYWNrOiB0aGUgd3JpdGViYWNrIGNvbm5lY3RvcgpAQCAtNjQs
NiArNjUsNyBAQCBzdHJ1Y3QgcmNhcl9kdV9jcnRjIHsKIAl1bnNpZ25lZCBpbnQgdmJsYW5rX2Nv
dW50OwogCiAJc3RydWN0IHJjYXJfZHVfZ3JvdXAgKmdyb3VwOworCXN0cnVjdCBwbGF0Zm9ybV9k
ZXZpY2UgKmNtbTsKIAlzdHJ1Y3QgcmNhcl9kdV92c3AgKnZzcDsKIAl1bnNpZ25lZCBpbnQgdnNw
X3BpcGU7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfZHJ2
LmggYi9kcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X2Rydi5oCmluZGV4IGEwMGRjY2M0
NDdhYS4uMzAwZWM2MGJhMzFiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9y
Y2FyX2R1X2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfZHJ2LmgK
QEAgLTEzLDYgKzEzLDcgQEAKICNpbmNsdWRlIDxsaW51eC9rZXJuZWwuaD4KICNpbmNsdWRlIDxs
aW51eC93YWl0Lmg+CiAKKyNpbmNsdWRlICJyY2FyX2NtbS5oIgogI2luY2x1ZGUgInJjYXJfZHVf
Y3J0Yy5oIgogI2luY2x1ZGUgInJjYXJfZHVfZ3JvdXAuaCIKICNpbmNsdWRlICJyY2FyX2R1X3Zz
cC5oIgpAQCAtNzAsNiArNzEsNyBAQCBzdHJ1Y3QgcmNhcl9kdV9kZXZpY2VfaW5mbyB7CiAKICNk
ZWZpbmUgUkNBUl9EVV9NQVhfQ1JUQ1MJCTQKICNkZWZpbmUgUkNBUl9EVV9NQVhfR1JPVVBTCQlE
SVZfUk9VTkRfVVAoUkNBUl9EVV9NQVhfQ1JUQ1MsIDIpCisjZGVmaW5lIFJDQVJfRFVfTUFYX0NN
TVMJCTQKICNkZWZpbmUgUkNBUl9EVV9NQVhfVlNQUwkJNAogCiBzdHJ1Y3QgcmNhcl9kdV9kZXZp
Y2UgewpAQCAtODYsNiArODgsNyBAQCBzdHJ1Y3QgcmNhcl9kdV9kZXZpY2UgewogCXN0cnVjdCBy
Y2FyX2R1X2VuY29kZXIgKmVuY29kZXJzW1JDQVJfRFVfT1VUUFVUX01BWF07CiAKIAlzdHJ1Y3Qg
cmNhcl9kdV9ncm91cCBncm91cHNbUkNBUl9EVV9NQVhfR1JPVVBTXTsKKwlzdHJ1Y3QgcGxhdGZv
cm1fZGV2aWNlICpjbW1zW1JDQVJfRFVfTUFYX0NNTVNdOwogCXN0cnVjdCByY2FyX2R1X3ZzcCB2
c3BzW1JDQVJfRFVfTUFYX1ZTUFNdOwogCiAJc3RydWN0IHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfZ3JvdXAuaCBiL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1
L3JjYXJfZHVfZ3JvdXAuaAppbmRleCA4Nzk1MGMxZjZhNTIuLmIwYzE0NjY1OTNhMyAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9ncm91cC5oCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfZ3JvdXAuaApAQCAtMjIsNiArMjIsNyBAQCBzdHJ1
Y3QgcmNhcl9kdV9kZXZpY2U7CiAgKiBAbW1pb19vZmZzZXQ6IHJlZ2lzdGVycyBvZmZzZXQgaW4g
dGhlIGRldmljZSBtZW1vcnkgbWFwCiAgKiBAaW5kZXg6IGdyb3VwIGluZGV4CiAgKiBAY2hhbm5l
bHNfbWFzazogYml0bWFzayBvZiBwb3B1bGF0ZWQgRFUgY2hhbm5lbHMgaW4gdGhpcyBncm91cAor
ICogQGNtbXNfbWFzazogYml0bWFzayBvZiBlbmFibGVkIENNTXMgaW4gdGhpcyBncm91cAogICog
QG51bV9jcnRjczogbnVtYmVyIG9mIENSVENzIGluIHRoaXMgZ3JvdXAgKDEgb3IgMikKICAqIEB1
c2VfY291bnQ6IG51bWJlciBvZiB1c2VycyBvZiB0aGUgZ3JvdXAgKHJjYXJfZHVfZ3JvdXBfKGdl
dHxwdXQpKQogICogQHVzZWRfY3J0Y3M6IG51bWJlciBvZiBDUlRDcyBjdXJyZW50bHkgaW4gdXNl
CkBAIC0zNyw2ICszOCw3IEBAIHN0cnVjdCByY2FyX2R1X2dyb3VwIHsKIAl1bnNpZ25lZCBpbnQg
aW5kZXg7CiAKIAl1bnNpZ25lZCBpbnQgY2hhbm5lbHNfbWFzazsKKwl1bnNpZ25lZCBpbnQgY21t
c19tYXNrOwogCXVuc2lnbmVkIGludCBudW1fY3J0Y3M7CiAJdW5zaWduZWQgaW50IHVzZV9jb3Vu
dDsKIAl1bnNpZ25lZCBpbnQgdXNlZF9jcnRjczsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9yY2FyLWR1L3JjYXJfZHVfa21zLmMgYi9kcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1
X2ttcy5jCmluZGV4IGFkYmM0ZjVkOGZjNS4uNWE5MTBhMDRlMWQ5IDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X2ttcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9y
Y2FyLWR1L3JjYXJfZHVfa21zLmMKQEAgLTE4LDYgKzE4LDcgQEAKICNpbmNsdWRlIDxkcm0vZHJt
X3ZibGFuay5oPgogCiAjaW5jbHVkZSA8bGludXgvb2ZfZ3JhcGguaD4KKyNpbmNsdWRlIDxsaW51
eC9vZl9wbGF0Zm9ybS5oPgogI2luY2x1ZGUgPGxpbnV4L3dhaXQuaD4KIAogI2luY2x1ZGUgInJj
YXJfZHVfY3J0Yy5oIgpAQCAtNjE0LDYgKzYxNSw0OCBAQCBzdGF0aWMgaW50IHJjYXJfZHVfdnNw
c19pbml0KHN0cnVjdCByY2FyX2R1X2RldmljZSAqcmNkdSkKIAlyZXR1cm4gcmV0OwogfQogCitz
dGF0aWMgaW50IHJjYXJfZHVfY21tX2luaXQoc3RydWN0IHJjYXJfZHVfZGV2aWNlICpyY2R1KQor
eworCWNvbnN0IHN0cnVjdCBkZXZpY2Vfbm9kZSAqbnAgPSByY2R1LT5kZXYtPm9mX25vZGU7CisJ
dW5zaWduZWQgaW50IGNlbGxzOworCXVuc2lnbmVkIGludCBpOworCisJY2VsbHMgPSBvZl9wcm9w
ZXJ0eV9jb3VudF91MzJfZWxlbXMobnAsICJjbW1zIik7CisJaWYgKGNlbGxzID4gUkNBUl9EVV9N
QVhfQ01NUyB8fCBjZWxscyA+IHJjZHUtPm51bV9jcnRjcykgeworCQlkZXZfZXJyKHJjZHUtPmRl
diwgImludmFsaWQgJ2NtbXMnIHByb3BlcnR5IGZvcm1hdFxuIik7CisJCXJldHVybiAtRUlOVkFM
OworCX0KKworCWZvciAoaSA9IDA7IGkgPCBjZWxsczsgKytpKSB7CisJCXN0cnVjdCBwbGF0Zm9y
bV9kZXZpY2UgKnBkZXY7CisJCXN0cnVjdCBkZXZpY2Vfbm9kZSAqY21tOworCisJCWNtbSA9IG9m
X3BhcnNlX3BoYW5kbGUobnAsICJjbW1zIiwgaSk7CisJCWlmIChJU19FUlIoY21tKSkgeworCQkJ
ZGV2X2VycihyY2R1LT5kZXYsICJmYWlsZWQgdG8gcGFyc2UgJ2NtbXMnIHByb3BlcnR5XG4iKTsK
KwkJCXJldHVybiBQVFJfRVJSKGNtbSk7CisJCX0KKworCQlwZGV2ID0gb2ZfZmluZF9kZXZpY2Vf
Ynlfbm9kZShjbW0pOworCQlpZiAoSVNfRVJSKHBkZXYpKSB7CisJCQlkZXZfZXJyKHJjZHUtPmRl
diwgImludmFsaWQgcHJvcGVydHkgJ2NtbXMnWyV1XVxuIiwgaSk7CisJCQlvZl9ub2RlX3B1dChj
bW0pOworCQkJcmV0dXJuIFBUUl9FUlIocGRldik7CisJCX0KKworCQlpZiAoIW9mX2RldmljZV9p
c19hdmFpbGFibGUoY21tKSkgeworCQkJLyogSXQncyBmaW5lIHRvIGhhdmUgYSBwaGFuZGxlIHRv
IGEgbm9uLWVuYWJsZWQgQ01NLiAqLworCQkJb2Zfbm9kZV9wdXQoY21tKTsKKwkJCWNvbnRpbnVl
OworCQl9CisKKwkJb2Zfbm9kZV9wdXQoY21tKTsKKwkJcmNkdS0+Y21tc1tpXSA9IHBkZXY7CisJ
fQorCisJcmV0dXJuIDA7Cit9CisKIGludCByY2FyX2R1X21vZGVzZXRfaW5pdChzdHJ1Y3QgcmNh
cl9kdV9kZXZpY2UgKnJjZHUpCiB7CiAJc3RhdGljIGNvbnN0IHVuc2lnbmVkIGludCBtbWlvX29m
ZnNldHNbXSA9IHsKQEAgLTcwNCw2ICs3NDcsMTMgQEAgaW50IHJjYXJfZHVfbW9kZXNldF9pbml0
KHN0cnVjdCByY2FyX2R1X2RldmljZSAqcmNkdSkKIAkJCXJldHVybiByZXQ7CiAJfQogCisJLyog
SW5pdGlhbGl6ZSB0aGUgQ29sb3IgTWFuYWdlbWVudCBNb2R1bGVzLiAqLworCWlmIChyY2FyX2R1
X2hhcyhyY2R1LCBSQ0FSX0RVX0ZFQVRVUkVfQ01NKSkgeworCQlyZXQgPSByY2FyX2R1X2NtbV9p
bml0KHJjZHUpOworCQlpZiAocmV0IDwgMCkKKwkJCXJldHVybiByZXQ7CisJfQorCiAJLyogQ3Jl
YXRlIHRoZSBDUlRDcy4gKi8KIAlmb3IgKHN3aW5kZXggPSAwLCBod2luZGV4ID0gMDsgc3dpbmRl
eCA8IHJjZHUtPm51bV9jcnRjczsgKytod2luZGV4KSB7CiAJCXN0cnVjdCByY2FyX2R1X2dyb3Vw
ICpyZ3JwOwotLSAKMi4yMS4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVz
a3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9k
cmktZGV2ZWw=
