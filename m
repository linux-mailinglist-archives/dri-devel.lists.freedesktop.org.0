Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 35294F32B2
	for <lists+dri-devel@lfdr.de>; Thu,  7 Nov 2019 16:17:46 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 651DD6F6DE;
	Thu,  7 Nov 2019 15:17:43 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mga18.intel.com (mga18.intel.com [134.134.136.126])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 52EB46F6DF;
 Thu,  7 Nov 2019 15:17:42 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga007.fm.intel.com ([10.253.24.52])
 by orsmga106.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 07 Nov 2019 07:17:41 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.68,278,1569308400"; d="scan'208";a="201421947"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.174])
 by fmsmga007.fm.intel.com with SMTP; 07 Nov 2019 07:17:39 -0800
Received: by stinkbox (sSMTP sendmail emulation);
 Thu, 07 Nov 2019 17:17:38 +0200
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Subject: [PATCH 03/12] drm/i915: Polish CHV CGM CSC loading
Date: Thu,  7 Nov 2019 17:17:16 +0200
Message-Id: <20191107151725.10507-4-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191107151725.10507-1-ville.syrjala@linux.intel.com>
References: <20191107151725.10507-1-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Swati Sharma <swati2.sharma@intel.com>, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KCk9u
bHkgbG9hZCB0aGUgQ0dNIENTQyBiYXNlZCBvbiB0aGUgY2dtX21vZGUgYml0IGxpa2Ugd2UKZG8g
d2l0aCB0aGUgZ2FtbWEvZGVnYW1tYSBMVVRzLiBBbmQgbWFrZSB0aGUgZnVuY3Rpb24KbmFtaW5n
IGFuZCBhcmd1bWVudHMgY29uc2lzdGVudCBhcyB3ZWxsLgoKVE9ETzogdGhlIGNvZGUgdG8gY29u
dmVydCB0aGUgY29lZmZpY2llbnRzIGxvb2sgdG90YWxseQpib2d1cy4gSUlSQyBDSFYgdXNlcyB0
d28ncyBjb21wbGVtZW50IGZvcm1hdCBidXQgdGhlIGNvZGUKY2VydGFpbmx5IGRvZXNuJ3QgZ2Vu
ZXJhdGUgdGhhdCwgc28gcHJvYmFibHkgbmVnYXRpdmUKY29lZmZpY2llbnRzIGFyZSB0b3RhbGx5
IGJ1c3RlZC4KClNpZ25lZC1vZmYtYnk6IFZpbGxlIFN5cmrDpGzDpCA8dmlsbGUuc3lyamFsYUBs
aW51eC5pbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9j
b2xvci5jIHwgNjkgKysrKysrKysrKy0tLS0tLS0tLS0tLQogMSBmaWxlIGNoYW5nZWQsIDMyIGlu
c2VydGlvbnMoKyksIDM3IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfY29sb3IuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfY29sb3IuYwppbmRleCBkOGVlOTBiNzc3NGEuLmYyMDgwOWQ5MWY4NSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9jb2xvci5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfY29sb3IuYwpAQCAtMzMzLDQ4ICszMzMs
MzggQEAgc3RhdGljIHZvaWQgaWNsX2xvYWRfY3NjX21hdHJpeChjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKIAlJOTE1X1dSSVRFKFBJUEVfQ1NDX01PREUoY3J0Yy0+
cGlwZSksIGNydGNfc3RhdGUtPmNzY19tb2RlKTsKIH0KIAotLyoKLSAqIFNldCB1cCB0aGUgcGlw
ZSBDU0MgdW5pdCBvbiBDaGVycnlWaWV3LgotICovCi1zdGF0aWMgdm9pZCBjaGVycnl2aWV3X2xv
YWRfY3NjX21hdHJpeChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkK
K3N0YXRpYyB2b2lkIGNodl9sb2FkX2NnbV9jc2Moc3RydWN0IGludGVsX2NydGMgKmNydGMsCisJ
CQkgICAgIGNvbnN0IHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqYmxvYikKIHsKLQlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsK
Kwljb25zdCBzdHJ1Y3QgZHJtX2NvbG9yX2N0bSAqY3RtID0gYmxvYi0+ZGF0YTsKIAlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKIAll
bnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7CisJdTE2IGNvZWZmc1s5XTsKKwlpbnQgaTsKIAot
CWlmIChjcnRjX3N0YXRlLT5ody5jdG0pIHsKLQkJY29uc3Qgc3RydWN0IGRybV9jb2xvcl9jdG0g
KmN0bSA9IGNydGNfc3RhdGUtPmh3LmN0bS0+ZGF0YTsKLQkJdTE2IGNvZWZmc1s5XSA9IHt9Owot
CQlpbnQgaTsKLQotCQlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShjb2VmZnMpOyBpKyspIHsK
LQkJCXU2NCBhYnNfY29lZmYgPQotCQkJCSgoMVVMTCA8PCA2MykgLSAxKSAmIGN0bS0+bWF0cml4
W2ldOwotCi0JCQkvKiBSb3VuZCBjb2VmZmljaWVudC4gKi8KLQkJCWFic19jb2VmZiArPSAxIDw8
ICgzMiAtIDEzKTsKLQkJCS8qIENsYW1wIHRvIGhhcmR3YXJlIGxpbWl0cy4gKi8KLQkJCWFic19j
b2VmZiA9IGNsYW1wX3ZhbChhYnNfY29lZmYsIDAsIENUTV9DT0VGRl84XzAgLSAxKTsKLQotCQkJ
LyogV3JpdGUgY29lZmZpY2llbnRzIGluIFMzLjEyIGZvcm1hdC4gKi8KLQkJCWlmIChjdG0tPm1h
dHJpeFtpXSAmICgxVUxMIDw8IDYzKSkKLQkJCQljb2VmZnNbaV0gPSAxIDw8IDE1OwotCQkJY29l
ZmZzW2ldIHw9ICgoYWJzX2NvZWZmID4+IDMyKSAmIDcpIDw8IDEyOwotCQkJY29lZmZzW2ldIHw9
IChhYnNfY29lZmYgPj4gMjApICYgMHhmZmY7Ci0JCX0KKwlmb3IgKGkgPSAwOyBpIDwgQVJSQVlf
U0laRShjb2VmZnMpOyBpKyspIHsKKwkJdTY0IGFic19jb2VmZiA9ICgoMVVMTCA8PCA2MykgLSAx
KSAmIGN0bS0+bWF0cml4W2ldOwogCi0JCUk5MTVfV1JJVEUoQ0dNX1BJUEVfQ1NDX0NPRUZGMDEo
cGlwZSksCi0JCQkgICBjb2VmZnNbMV0gPDwgMTYgfCBjb2VmZnNbMF0pOwotCQlJOTE1X1dSSVRF
KENHTV9QSVBFX0NTQ19DT0VGRjIzKHBpcGUpLAotCQkJICAgY29lZmZzWzNdIDw8IDE2IHwgY29l
ZmZzWzJdKTsKLQkJSTkxNV9XUklURShDR01fUElQRV9DU0NfQ09FRkY0NShwaXBlKSwKLQkJCSAg
IGNvZWZmc1s1XSA8PCAxNiB8IGNvZWZmc1s0XSk7Ci0JCUk5MTVfV1JJVEUoQ0dNX1BJUEVfQ1ND
X0NPRUZGNjcocGlwZSksCi0JCQkgICBjb2VmZnNbN10gPDwgMTYgfCBjb2VmZnNbNl0pOwotCQlJ
OTE1X1dSSVRFKENHTV9QSVBFX0NTQ19DT0VGRjgocGlwZSksIGNvZWZmc1s4XSk7CisJCS8qIFJv
dW5kIGNvZWZmaWNpZW50LiAqLworCQlhYnNfY29lZmYgKz0gMSA8PCAoMzIgLSAxMyk7CisJCS8q
IENsYW1wIHRvIGhhcmR3YXJlIGxpbWl0cy4gKi8KKwkJYWJzX2NvZWZmID0gY2xhbXBfdmFsKGFi
c19jb2VmZiwgMCwgQ1RNX0NPRUZGXzhfMCAtIDEpOworCisJCWNvZWZmc1tpXSA9IDA7CisKKwkJ
LyogV3JpdGUgY29lZmZpY2llbnRzIGluIFMzLjEyIGZvcm1hdC4gKi8KKwkJaWYgKGN0bS0+bWF0
cml4W2ldICYgKDFVTEwgPDwgNjMpKQorCQkJY29lZmZzW2ldIHw9IDEgPDwgMTU7CisKKwkJY29l
ZmZzW2ldIHw9ICgoYWJzX2NvZWZmID4+IDMyKSAmIDcpIDw8IDEyOworCQljb2VmZnNbaV0gfD0g
KGFic19jb2VmZiA+PiAyMCkgJiAweGZmZjsKIAl9CiAKLQlJOTE1X1dSSVRFKENHTV9QSVBFX01P
REUocGlwZSksIGNydGNfc3RhdGUtPmNnbV9tb2RlKTsKKwlJOTE1X1dSSVRFKENHTV9QSVBFX0NT
Q19DT0VGRjAxKHBpcGUpLCBjb2VmZnNbMV0gPDwgMTYgfCBjb2VmZnNbMF0pOworCUk5MTVfV1JJ
VEUoQ0dNX1BJUEVfQ1NDX0NPRUZGMjMocGlwZSksIGNvZWZmc1szXSA8PCAxNiB8IGNvZWZmc1sy
XSk7CisJSTkxNV9XUklURShDR01fUElQRV9DU0NfQ09FRkY0NShwaXBlKSwgY29lZmZzWzVdIDw8
IDE2IHwgY29lZmZzWzRdKTsKKwlJOTE1X1dSSVRFKENHTV9QSVBFX0NTQ19DT0VGRjY3KHBpcGUp
LCBjb2VmZnNbN10gPDwgMTYgfCBjb2VmZnNbNl0pOworCUk5MTVfV1JJVEUoQ0dNX1BJUEVfQ1ND
X0NPRUZGOChwaXBlKSwgY29lZmZzWzhdKTsKIH0KIAogLyogaTk2NSsgIjEwLjYiIGJpdCBpbnRl
cnBvbGF0ZWQgZm9ybWF0ICJldmVuIERXIiAobG93IDggYml0cykgKi8KQEAgLTk5MSwxMCArOTgx
LDEzIEBAIHN0YXRpYyB2b2lkIGNodl9sb2FkX2NnbV9nYW1tYShzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YywKIHN0YXRpYyB2b2lkIGNodl9sb2FkX2x1dHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCiB7CiAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Ci0JY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0
eV9ibG9iICpnYW1tYV9sdXQgPSBjcnRjX3N0YXRlLT5ody5nYW1tYV9sdXQ7CisJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7CiAJY29u
c3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpkZWdhbW1hX2x1dCA9IGNydGNfc3RhdGUtPmh3
LmRlZ2FtbWFfbHV0OworCWNvbnN0IHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqZ2FtbWFfbHV0
ID0gY3J0Y19zdGF0ZS0+aHcuZ2FtbWFfbHV0OworCWNvbnN0IHN0cnVjdCBkcm1fcHJvcGVydHlf
YmxvYiAqY3RtID0gY3J0Y19zdGF0ZS0+aHcuY3RtOwogCi0JY2hlcnJ5dmlld19sb2FkX2NzY19t
YXRyaXgoY3J0Y19zdGF0ZSk7CisJaWYgKGNydGNfc3RhdGUtPmNnbV9tb2RlICYgQ0dNX1BJUEVf
TU9ERV9DU0MpCisJCWNodl9sb2FkX2NnbV9jc2MoY3J0YywgY3RtKTsKIAogCWlmIChjcnRjX3N0
YXRlLT5jZ21fbW9kZSAmIENHTV9QSVBFX01PREVfREVHQU1NQSkKIAkJY2h2X2xvYWRfY2dtX2Rl
Z2FtbWEoY3J0YywgZGVnYW1tYV9sdXQpOwpAQCAtMTAwMyw2ICs5OTYsOCBAQCBzdGF0aWMgdm9p
ZCBjaHZfbG9hZF9sdXRzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
KQogCQljaHZfbG9hZF9jZ21fZ2FtbWEoY3J0YywgZ2FtbWFfbHV0KTsKIAllbHNlCiAJCWk5NjVf
bG9hZF9sdXRzKGNydGNfc3RhdGUpOworCisJSTkxNV9XUklURShDR01fUElQRV9NT0RFKGNydGMt
PnBpcGUpLCBjcnRjX3N0YXRlLT5jZ21fbW9kZSk7CiB9CiAKIHZvaWQgaW50ZWxfY29sb3JfbG9h
ZF9sdXRzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQotLSAKMi4y
My4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmkt
ZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6
Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
