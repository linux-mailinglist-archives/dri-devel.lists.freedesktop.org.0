Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id A8D3E9532A
	for <lists+dri-devel@lfdr.de>; Tue, 20 Aug 2019 03:18:37 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id DCD036E584;
	Tue, 20 Aug 2019 01:18:20 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from perceval.ideasonboard.com (perceval.ideasonboard.com
 [213.167.242.64])
 by gabe.freedesktop.org (Postfix) with ESMTPS id EE3876E529
 for <dri-devel@lists.freedesktop.org>; Tue, 20 Aug 2019 01:17:56 +0000 (UTC)
Received: from pendragon.bb.dnainternet.fi
 (dfj612yhrgyx302h3jwwy-3.rev.dnainternet.fi
 [IPv6:2001:14ba:21f5:5b00:ce28:277f:58d7:3ca4])
 by perceval.ideasonboard.com (Postfix) with ESMTPSA id DA5D6E1F;
 Tue, 20 Aug 2019 03:17:50 +0200 (CEST)
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v2 27/50] drm/omap: hdmi4: Register a drm_bridge for EDID read
Date: Tue, 20 Aug 2019 04:16:58 +0300
Message-Id: <20190820011721.30136-28-laurent.pinchart@ideasonboard.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190820011721.30136-1-laurent.pinchart@ideasonboard.com>
References: <20190820011721.30136-1-laurent.pinchart@ideasonboard.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=ideasonboard.com; s=mail; t=1566263871;
 bh=FcD+/CCVyv58imdRlc19xrxYI1VQO3lHRSg3Zo5oY8I=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=dhQXDcUgRqtdQZM+yYzC/dxGRz6Y7Ssr9umi/3GWqnlb6JajWfqbBQDmXylaI1Wbk
 eV6K8rVaoCjOp3D+FYj63XKlFrO5LzjH8k9qW3dAqUzp0oxZk8dQ2dyCBtnf88S7lL
 THuVYYv6wFmlThZOFJcFnPEhJAUr108FNBW8/s2s=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Maxime Ripard <maxime.ripard@bootlin.com>,
 Tomi Valkeinen <tomi.valkeinen@ti.com>, Sean Paul <sean@poorly.run>,
 Sebastian Reichel <sebastian.reichel@collabora.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW4gb3JkZXIgdG8gaW50ZWdyYXRlIHdpdGggYSBjaGFpbiBvZiBkcm1fYnJpZGdlLCB0aGUgaW50
ZXJuYWwgSERNSTQKZW5jb2RlciBoYXMgdG8gZXhwb3NlIHRoZSBFRElEIHJlYWQgb3BlcmF0aW9u
IHRocm91Z2ggdGhlIGRybV9icmlkZ2UKQVBJLiBSZWdpc3RlciBhIGJyaWRnZSBhdCBpbml0aWFs
aXNhdGlvbiB0aW1lIHRvIGRvIHNvLgoKRm9yIHRoZSB0aW1lIGJlaW5nIG1ha2UgdGhlIG5leHQg
YnJpZGdlIGluIHRoZSBjaGFpbiBvcHRpb25hbCBhcyB0aGUKSERNSSBvdXRwdXQgaXMgc3RpbGwg
YmFzZWQgb24gb21hcF9kc3NfZGV2aWNlLiBUaGUgY3JlYXRlX2Nvbm5lY3Rvcgphcmd1bWVudCB0
byB0aGUgYnJpZGdlIGF0dGFjaCBmdW5jdGlvbiBpcyBhbHNvIGlnbm9yZWQgZm9yIHRoZSBzYW1l
CnJlYXNvbi4gVGhpcyB3aWxsIGJlIGNoYW5nZWQgbGF0ZXIgd2hlbiByZW1vdmluZyB0aGUgcmVs
YXRlZApvbWFwZHJtLXNwZWNpZmljIGRpc3BsYXkgZHJpdmVycy4KClNpZ25lZC1vZmYtYnk6IExh
dXJlbnQgUGluY2hhcnQgPGxhdXJlbnQucGluY2hhcnRAaWRlYXNvbmJvYXJkLmNvbT4KLS0tCiBk
cml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3MvaGRtaS5oICB8ICAzICsrCiBkcml2ZXJzL2dwdS9k
cm0vb21hcGRybS9kc3MvaGRtaTQuYyB8IDc0ICsrKysrKysrKysrKysrKysrKysrKysrKysrKy0t
CiAyIGZpbGVzIGNoYW5nZWQsIDcyIGluc2VydGlvbnMoKyksIDUgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL29tYXBkcm0vZHNzL2hkbWkuaCBiL2RyaXZlcnMvZ3B1
L2RybS9vbWFwZHJtL2Rzcy9oZG1pLmgKaW5kZXggYzg2NzU1MmM5MjVjLi5iZDQzZjZhYmYyN2Ig
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJtL2Rzcy9oZG1pLmgKKysrIGIvZHJp
dmVycy9ncHUvZHJtL29tYXBkcm0vZHNzL2hkbWkuaApAQCAtMTQsNiArMTQsNyBAQAogI2luY2x1
ZGUgPGxpbnV4L2hkbWkuaD4KICNpbmNsdWRlIDxzb3VuZC9vbWFwLWhkbWktYXVkaW8uaD4KICNp
bmNsdWRlIDxtZWRpYS9jZWMuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2JyaWRnZS5oPgogCiAjaW5j
bHVkZSAib21hcGRzcy5oIgogI2luY2x1ZGUgImRzcy5oIgpAQCAtMzY0LDYgKzM2NSw3IEBAIHN0
cnVjdCBvbWFwX2hkbWkgewogCWJvb2wgY29yZV9lbmFibGVkOwogCiAJc3RydWN0IG9tYXBfZHNz
X2RldmljZSBvdXRwdXQ7CisJc3RydWN0IGRybV9icmlkZ2UgYnJpZGdlOwogCiAJc3RydWN0IHBs
YXRmb3JtX2RldmljZSAqYXVkaW9fcGRldjsKIAl2b2lkICgqYXVkaW9fYWJvcnRfY2IpKHN0cnVj
dCBkZXZpY2UgKmRldik7CkBAIC0zNzksNSArMzgxLDYgQEAgc3RydWN0IG9tYXBfaGRtaSB7CiB9
OwogCiAjZGVmaW5lIGRzc2Rldl90b19oZG1pKGRzc2RldikgY29udGFpbmVyX29mKGRzc2Rldiwg
c3RydWN0IG9tYXBfaGRtaSwgb3V0cHV0KQorI2RlZmluZSBkcm1fYnJpZGdlX3RvX2hkbWkoYikg
Y29udGFpbmVyX29mKGIsIHN0cnVjdCBvbWFwX2hkbWksIGJyaWRnZSkKIAogI2VuZGlmCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3MvaGRtaTQuYyBiL2RyaXZlcnMvZ3B1
L2RybS9vbWFwZHJtL2Rzcy9oZG1pNC5jCmluZGV4IDM3NTM2YjlmMzExNC4uOGI2ZmNkNzI0ZDY2
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3MvaGRtaTQuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3MvaGRtaTQuYwpAQCAtMzkwLDcgKzM5MCw4IEBAIHN0
YXRpYyB2b2lkIGhkbWlfZGlzY29ubmVjdChzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpzcmMsCiAK
ICNkZWZpbmUgTUFYX0VESUQJNTEyCiAKLXN0YXRpYyBzdHJ1Y3QgZWRpZCAqaGRtaV9yZWFkX2Vk
aWRfZGF0YShzdHJ1Y3Qgb21hcF9oZG1pICpoZG1pKQorc3RhdGljIHN0cnVjdCBlZGlkICpoZG1p
X3JlYWRfZWRpZF9kYXRhKHN0cnVjdCBvbWFwX2hkbWkgKmhkbWksCisJCQkJCXN0cnVjdCBkcm1f
Y29ubmVjdG9yICpjb25uZWN0b3IpCiB7CiAJdTggKmVkaWQ7CiAJaW50IHI7CkBAIC00MjgsOSAr
NDI5LDEyIEBAIHN0YXRpYyBzdHJ1Y3QgZWRpZCAqaGRtaV9yZWFkX2VkaWRfZGF0YShzdHJ1Y3Qg
b21hcF9oZG1pICpoZG1pKQogCXJldHVybiBOVUxMOwogfQogCi1zdGF0aWMgc3RydWN0IGVkaWQg
KmhkbWlfcmVhZF9lZGlkKHN0cnVjdCBvbWFwX2Rzc19kZXZpY2UgKmRzc2RldikKK3N0YXRpYyBz
dHJ1Y3QgZWRpZCAqCitoZG1pX2RvX3JlYWRfZWRpZChzdHJ1Y3Qgb21hcF9oZG1pICpoZG1pLAor
CQkgIHN0cnVjdCBlZGlkICooKnJlYWQpKHN0cnVjdCBvbWFwX2hkbWkgKmhkbWksCisJCQkJICAg
ICAgIHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpLAorCQkgIHN0cnVjdCBkcm1fY29u
bmVjdG9yICpjb25uZWN0b3IpCiB7Ci0Jc3RydWN0IG9tYXBfaGRtaSAqaGRtaSA9IGRzc2Rldl90
b19oZG1pKGRzc2Rldik7CiAJc3RydWN0IGVkaWQgKmVkaWQgPSBOVUxMOwogCXVuc2lnbmVkIGlu
dCBjZWNfYWRkcjsKIAlib29sIG5lZWRfZW5hYmxlOwpAQCAtNDUyLDcgKzQ1Niw3IEBAIHN0YXRp
YyBzdHJ1Y3QgZWRpZCAqaGRtaV9yZWFkX2VkaWQoc3RydWN0IG9tYXBfZHNzX2RldmljZSAqZHNz
ZGV2KQogCWlmIChyKQogCQlnb3RvIGRvbmU7CiAKLQllZGlkID0gaGRtaV9yZWFkX2VkaWRfZGF0
YShoZG1pKTsKKwllZGlkID0gcmVhZChoZG1pLCBjb25uZWN0b3IpOwogCiBkb25lOgogCWhkbWlf
cnVudGltZV9wdXQoaGRtaSk7CkBAIC00NzQsNiArNDc4LDEyIEBAIHN0YXRpYyBzdHJ1Y3QgZWRp
ZCAqaGRtaV9yZWFkX2VkaWQoc3RydWN0IG9tYXBfZHNzX2RldmljZSAqZHNzZGV2KQogCXJldHVy
biBlZGlkOwogfQogCitzdGF0aWMgc3RydWN0IGVkaWQgKmhkbWlfcmVhZF9lZGlkKHN0cnVjdCBv
bWFwX2Rzc19kZXZpY2UgKmRzc2RldikKK3sKKwlyZXR1cm4gaGRtaV9kb19yZWFkX2VkaWQoZHNz
ZGV2X3RvX2hkbWkoZHNzZGV2KSwgaGRtaV9yZWFkX2VkaWRfZGF0YSwKKwkJCQkgTlVMTCk7Cit9
CisKIHN0YXRpYyB2b2lkIGhkbWlfbG9zdF9ob3RwbHVnKHN0cnVjdCBvbWFwX2Rzc19kZXZpY2Ug
KmRzc2RldikKIHsKIAlzdHJ1Y3Qgb21hcF9oZG1pICpoZG1pID0gZHNzZGV2X3RvX2hkbWkoZHNz
ZGV2KTsKQEAgLTUxNyw2ICs1MjcsNTYgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBvbWFwX2Rzc19k
ZXZpY2Vfb3BzIGhkbWlfb3BzID0gewogCX0sCiB9OwogCisvKiAtLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LQorICogRFJNIEJyaWRnZSBPcGVyYXRpb25zCisgKi8KKworc3RhdGljIGludCBoZG1pNF9icmlk
Z2VfYXR0YWNoKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UsCisJCQkgICAgICAgZW51bSBkcm1f
YnJpZGdlX2F0dGFjaF9mbGFncyBmbGFncykKK3sKKwlzdHJ1Y3Qgb21hcF9oZG1pICpoZG1pID0g
ZHJtX2JyaWRnZV90b19oZG1pKGJyaWRnZSk7CisKKwlpZiAoIWhkbWktPm91dHB1dC5uZXh0X2Jy
aWRnZSkKKwkJcmV0dXJuIDA7CisKKwlyZXR1cm4gZHJtX2JyaWRnZV9hdHRhY2goYnJpZGdlLT5l
bmNvZGVyLCBoZG1pLT5vdXRwdXQubmV4dF9icmlkZ2UsCisJCQkJIGJyaWRnZSwgZmxhZ3MpOwor
fQorCitzdGF0aWMgc3RydWN0IGVkaWQgKmhkbWk0X2JyaWRnZV9yZWFkX2VkaWQoc3RydWN0IG9t
YXBfaGRtaSAqaGRtaSwKKwkJCQkJICAgc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikK
K3sKKwlyZXR1cm4gZHJtX2RvX2dldF9lZGlkKGNvbm5lY3RvciwgaGRtaTRfY29yZV9kZGNfcmVh
ZCwgJmhkbWktPmNvcmUpOworfQorCitzdGF0aWMgc3RydWN0IGVkaWQgKmhkbWk0X2JyaWRnZV9n
ZXRfZWRpZChzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAorCQkJCQkgIHN0cnVjdCBkcm1fY29u
bmVjdG9yICpjb25uZWN0b3IpCit7CisJc3RydWN0IG9tYXBfaGRtaSAqaGRtaSA9IGRybV9icmlk
Z2VfdG9faGRtaShicmlkZ2UpOworCisJcmV0dXJuIGhkbWlfZG9fcmVhZF9lZGlkKGhkbWksIGhk
bWk0X2JyaWRnZV9yZWFkX2VkaWQsIGNvbm5lY3Rvcik7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1
Y3QgZHJtX2JyaWRnZV9mdW5jcyBoZG1pNF9icmlkZ2VfZnVuY3MgPSB7CisJLmF0dGFjaCA9IGhk
bWk0X2JyaWRnZV9hdHRhY2gsCisJLmdldF9lZGlkID0gaGRtaTRfYnJpZGdlX2dldF9lZGlkLAor
fTsKKworc3RhdGljIHZvaWQgaGRtaTRfYnJpZGdlX2luaXQoc3RydWN0IG9tYXBfaGRtaSAqaGRt
aSkKK3sKKwloZG1pLT5icmlkZ2UuZnVuY3MgPSAmaGRtaTRfYnJpZGdlX2Z1bmNzOworCWhkbWkt
PmJyaWRnZS5vZl9ub2RlID0gaGRtaS0+cGRldi0+ZGV2Lm9mX25vZGU7CisJaGRtaS0+YnJpZGdl
Lm9wcyA9IERSTV9CUklER0VfT1BfRURJRDsKKwloZG1pLT5icmlkZ2UudHlwZSA9IERSTV9NT0RF
X0NPTk5FQ1RPUl9IRE1JQTsKKworCWRybV9icmlkZ2VfYWRkKCZoZG1pLT5icmlkZ2UpOworfQor
CitzdGF0aWMgdm9pZCBoZG1pNF9icmlkZ2VfY2xlYW51cChzdHJ1Y3Qgb21hcF9oZG1pICpoZG1p
KQoreworCWRybV9icmlkZ2VfcmVtb3ZlKCZoZG1pLT5icmlkZ2UpOworfQorCiAvKiAtLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLQogICogQXVkaW8gQ2FsbGJhY2tzCiAgKi8KQEAgLTcwOCw2ICs3NjgsOCBA
QCBzdGF0aWMgaW50IGhkbWk0X2luaXRfb3V0cHV0KHN0cnVjdCBvbWFwX2hkbWkgKmhkbWkpCiAJ
c3RydWN0IG9tYXBfZHNzX2RldmljZSAqb3V0ID0gJmhkbWktPm91dHB1dDsKIAlpbnQgcjsKIAor
CWhkbWk0X2JyaWRnZV9pbml0KGhkbWkpOworCiAJb3V0LT5kZXYgPSAmaGRtaS0+cGRldi0+ZGV2
OwogCW91dC0+aWQgPSBPTUFQX0RTU19PVVRQVVRfSERNSTsKIAlvdXQtPnR5cGUgPSBPTUFQX0RJ
U1BMQVlfVFlQRV9IRE1JOwpAQCAtNzE4LDcgKzc4MCw3IEBAIHN0YXRpYyBpbnQgaGRtaTRfaW5p
dF9vdXRwdXQoc3RydWN0IG9tYXBfaGRtaSAqaGRtaSkKIAlvdXQtPm9mX3BvcnQgPSAwOwogCW91
dC0+b3BzX2ZsYWdzID0gT01BUF9EU1NfREVWSUNFX09QX0VESUQ7CiAKLQlyID0gb21hcGRzc19k
ZXZpY2VfaW5pdF9vdXRwdXQob3V0LCBOVUxMKTsKKwlyID0gb21hcGRzc19kZXZpY2VfaW5pdF9v
dXRwdXQob3V0LCAmaGRtaS0+YnJpZGdlKTsKIAlpZiAociA8IDApCiAJCXJldHVybiByOwogCkBA
IC03MzMsNiArNzk1LDggQEAgc3RhdGljIHZvaWQgaGRtaTRfdW5pbml0X291dHB1dChzdHJ1Y3Qg
b21hcF9oZG1pICpoZG1pKQogCiAJb21hcGRzc19kZXZpY2VfdW5yZWdpc3RlcihvdXQpOwogCW9t
YXBkc3NfZGV2aWNlX2NsZWFudXBfb3V0cHV0KG91dCk7CisKKwloZG1pNF9icmlkZ2VfY2xlYW51
cChoZG1pKTsKIH0KIAogc3RhdGljIGludCBoZG1pNF9wcm9iZV9vZihzdHJ1Y3Qgb21hcF9oZG1p
ICpoZG1pKQotLSAKUmVnYXJkcywKCkxhdXJlbnQgUGluY2hhcnQKCl9fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJp
LWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9y
Zy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
