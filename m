Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 3C7BEDCE28
	for <lists+dri-devel@lfdr.de>; Fri, 18 Oct 2019 20:38:23 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4C58A6EBA5;
	Fri, 18 Oct 2019 18:37:50 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from smtp.codeaurora.org (smtp.codeaurora.org [198.145.29.96])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 903036E925
 for <dri-devel@lists.freedesktop.org>; Wed, 16 Oct 2019 10:14:48 +0000 (UTC)
Received: by smtp.codeaurora.org (Postfix, from userid 1000)
 id 33F9F60D82; Wed, 16 Oct 2019 10:14:46 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on
 pdx-caf-mail.web.codeaurora.org
X-Spam-Level: 
X-Spam-Status: No, score=-2.7 required=2.0 tests=ALL_TRUSTED,BAYES_00,
 DKIM_INVALID,DKIM_SIGNED,SPF_NONE autolearn=no autolearn_force=no
 version=3.4.0
Received: from kgunda-linux.qualcomm.com
 (blr-c-bdr-fw-01_globalnat_allzones-outside.qualcomm.com [103.229.19.19])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-SHA256 (128/128 bits))
 (No client certificate requested)
 (Authenticated sender: kgunda@smtp.codeaurora.org)
 by smtp.codeaurora.org (Postfix) with ESMTPSA id 8520C601E7;
 Wed, 16 Oct 2019 10:14:37 +0000 (UTC)
DMARC-Filter: OpenDMARC Filter v1.3.2 smtp.codeaurora.org 8520C601E7
From: Kiran Gunda <kgunda@codeaurora.org>
To: bjorn.andersson@linaro.org, jingoohan1@gmail.com, lee.jones@linaro.org,
 b.zolnierkie@samsung.com, dri-devel@lists.freedesktop.org,
 daniel.thompson@linaro.org, jacek.anaszewski@gmail.com, pavel@ucw.cz,
 robh+dt@kernel.org, mark.rutland@arm.com, linux-leds@vger.kernel.org,
 devicetree@vger.kernel.org, linux-kernel@vger.kernel.org,
 Andy Gross <agross@kernel.org>, linux-arm-msm@vger.kernel.org,
 linux-fbdev@vger.kernel.org
Subject: [PATCH V7 6/6] backlight: qcom-wled: Add auto string detection logic
Date: Wed, 16 Oct 2019 15:43:46 +0530
Message-Id: <1571220826-7740-7-git-send-email-kgunda@codeaurora.org>
X-Mailer: git-send-email 1.9.1
In-Reply-To: <1571220826-7740-1-git-send-email-kgunda@codeaurora.org>
References: <1571220826-7740-1-git-send-email-kgunda@codeaurora.org>
X-Mailman-Approved-At: Fri, 18 Oct 2019 18:37:46 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=codeaurora.org; s=default; t=1571220888;
 bh=FbZoALKa9lI6Tgsb/QWmQWrzQzYxeLn88BuHs69cANE=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=ky4vSlwTuQEcqUHTuDNib9KeSuZ/ye38JeUog5ahNn8okX3bXp6pjEvEmD2xd6fFN
 T+QwERa+zm2yhj/BK/ay3GLHe97ll6R4AhBLohU1QGtHsbb6JqwPvjESNfUSXULoR8
 84U0lgGaVZHn1xEeffpBzjS5cOchFaF9bhgfWiV4=
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=codeaurora.org; s=default; t=1571220883;
 bh=FbZoALKa9lI6Tgsb/QWmQWrzQzYxeLn88BuHs69cANE=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=mraFvY9vus4tnb5CB7gb1l7XBz5NRFhqZhlg8QmU5I1RaV4gQEMSZF4V8yS8UBK86
 tHeBUldOaPiXquONWxxNWK4VQ+MCA/Zx/D408e6IK8nYXDSOvuIS3tcQ48bWmLcMvb
 3uQDoyOUokjIW8t60Sd45Bua0HCQwPfKLUA1eVfU=
X-Mailman-Original-Authentication-Results: pdx-caf-mail.web.codeaurora.org;
 dmarc=none (p=none dis=none)
 header.from=codeaurora.org
X-Mailman-Original-Authentication-Results: pdx-caf-mail.web.codeaurora.org;
 spf=none
 smtp.mailfrom=kgunda@codeaurora.org
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Kiran Gunda <kgunda@codeaurora.org>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIGF1dG8gc3RyaW5nIGRldGVjdGlvbiBhbGdvcml0aG0gY2hlY2tzIGlmIHRoZSBjdXJyZW50
IFdMRUQKc2luayBjb25maWd1cmF0aW9uIGlzIHZhbGlkLiBJdCB0cmllcyBlbmFibGluZyBldmVy
eSBzaW5rIGFuZApjaGVja3MgaWYgdGhlIE9WUCBmYXVsdCBpcyBvYnNlcnZlZC4gQmFzZWQgb24g
dGhpcyBpbmZvcm1hdGlvbgppdCBkZXRlY3RzIGFuZCBlbmFibGVzIHRoZSB2YWxpZCBzaW5rIGNv
bmZpZ3VyYXRpb24uCkF1dG8gY2FsaWJyYXRpb24gd2lsbCBiZSB0cmlnZ2VyZWQgd2hlbiB0aGUg
T1ZQIGZhdWx0IGludGVycnVwdHMKYXJlIHNlZW4gZnJlcXVlbnRseSB0aGVyZWJ5IGl0IHRyaWVz
IHRvIGZpeCB0aGUgc2luayBjb25maWd1cmF0aW9uLgoKVGhlIGF1dG8tZGV0ZWN0aW9uIGFsc28g
a2lja3MgaW4gd2hlbiB0aGUgY29ubmVjdGVkIExFRCBzdHJpbmcKb2YgdGhlIGRpc3BsYXktYmFj
a2xpZ2h0IG1hbGZ1bmN0aW9ucyAoYmVjYXVzZSBvZiBkYW1hZ2UpIGFuZApyZXF1aXJlcyB0aGUg
ZGFtYWdlZCBzdHJpbmcgdG8gYmUgdHVybmVkIG9mZiB0byBwcmV2ZW50IHRoZQpjb21wbGV0ZSBw
YW5lbCBhbmQvb3IgYm9hcmQgZnJvbSBiZWluZyBkYW1hZ2VkLgoKU2lnbmVkLW9mZi1ieTogS2ly
YW4gR3VuZGEgPGtndW5kYUBjb2RlYXVyb3JhLm9yZz4KLS0tCiBkcml2ZXJzL3ZpZGVvL2JhY2ts
aWdodC9xY29tLXdsZWQuYyB8IDQxMCArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
Ky0KIDEgZmlsZSBjaGFuZ2VkLCA0MDQgaW5zZXJ0aW9ucygrKSwgNiBkZWxldGlvbnMoLSkKCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL3ZpZGVvL2JhY2tsaWdodC9xY29tLXdsZWQuYyBiL2RyaXZlcnMv
dmlkZW8vYmFja2xpZ2h0L3Fjb20td2xlZC5jCmluZGV4IGI1YjEyNWMuLmZmN2M0MDkgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvdmlkZW8vYmFja2xpZ2h0L3Fjb20td2xlZC5jCisrKyBiL2RyaXZlcnMv
dmlkZW8vYmFja2xpZ2h0L3Fjb20td2xlZC5jCkBAIC0xNywxOSArMTcsMjkgQEAKICNkZWZpbmUg
V0xFRF9NQVhfU1RSSU5HUwkJCQk0CiAKICNkZWZpbmUgV0xFRF9ERUZBVUxUX0JSSUdIVE5FU1MJ
CQkJMjA0OAotCisjZGVmaW5lIFdMRURfU09GVF9TVEFSVF9ETFlfVVMJCQkJMTAwMDAKICNkZWZp
bmUgV0xFRDNfU0lOS19SRUdfQlJJR0hUX01BWAkJCTB4RkZGCiAKIC8qIFdMRUQzL1dMRUQ0IGNv
bnRyb2wgcmVnaXN0ZXJzICovCisjZGVmaW5lIFdMRUQzX0NUUkxfUkVHX0ZBVUxUX1NUQVRVUwkJ
CTB4MDgKKyNkZWZpbmUgIFdMRUQzX0NUUkxfUkVHX0lMSU1fRkFVTFRfQklUCQkJQklUKDApCisj
ZGVmaW5lICBXTEVEM19DVFJMX1JFR19PVlBfRkFVTFRfQklUCQkJQklUKDEpCisjZGVmaW5lICBX
TEVENF9DVFJMX1JFR19TQ19GQVVMVF9CSVQJCQlCSVQoMikKKworI2RlZmluZSBXTEVEM19DVFJM
X1JFR19JTlRfUlRfU1RTCQkJMHgxMAorI2RlZmluZSAgV0xFRDNfQ1RSTF9SRUdfT1ZQX0ZBVUxU
X1NUQVRVUwkJQklUKDEpCisKICNkZWZpbmUgV0xFRDNfQ1RSTF9SRUdfTU9EX0VOCQkJCTB4NDYK
ICNkZWZpbmUgIFdMRUQzX0NUUkxfUkVHX01PRF9FTl9NQVNLCQkJQklUKDcpCiAjZGVmaW5lICBX
TEVEM19DVFJMX1JFR19NT0RfRU5fU0hJRlQJCQk3CiAKKyNkZWZpbmUgV0xFRDNfQ1RSTF9SRUdf
RkVFREJBQ0tfQ09OVFJPTAkJCTB4NDgKKwogI2RlZmluZSBXTEVEM19DVFJMX1JFR19GUkVRCQkJ
CTB4NGMKICNkZWZpbmUgIFdMRUQzX0NUUkxfUkVHX0ZSRVFfTUFTSwkJCUdFTk1BU0soMywgMCkK
IAogI2RlZmluZSBXTEVEM19DVFJMX1JFR19PVlAJCQkJMHg0ZAotI2RlZmluZSAgV0xFRDNfQ1RS
TF9SRUdfT1ZQX01BU0sJCQkJR0VOTUFTSygxLCAwKQorI2RlZmluZSAgV0xFRDNfQ1RSTF9SRUdf
T1ZQX01BU0sJCQlHRU5NQVNLKDEsIDApCiAKICNkZWZpbmUgV0xFRDNfQ1RSTF9SRUdfSUxJTUlU
CQkJCTB4NGUKICNkZWZpbmUgIFdMRUQzX0NUUkxfUkVHX0lMSU1JVF9NQVNLCQkJR0VOTUFTSygy
LCAwKQpAQCAtMTE5LDYgKzEyOSw3IEBAIHN0cnVjdCB3bGVkX2NvbmZpZyB7CiAJYm9vbCBleHRf
Z2VuOwogCWJvb2wgY2FiYzsKIAlib29sIGV4dGVybmFsX3BmZXQ7CisJYm9vbCBhdXRvX2RldGVj
dGlvbl9lbmFibGVkOwogfTsKIAogc3RydWN0IHdsZWQgewpAQCAtMTI3LDE2ICsxMzgsMjEgQEAg
c3RydWN0IHdsZWQgewogCXN0cnVjdCByZWdtYXAgKnJlZ21hcDsKIAlzdHJ1Y3QgbXV0ZXggbG9j
azsJLyogTG9jayB0byBhdm9pZCByYWNlIGZyb20gdGhyZWFkIGlycSBoYW5kbGVyICovCiAJa3Rp
bWVfdCBsYXN0X3Nob3J0X2V2ZW50OworCWt0aW1lX3Qgc3RhcnRfb3ZwX2ZhdWx0X3RpbWU7CiAJ
dTE2IGN0cmxfYWRkcjsKIAl1MTYgc2lua19hZGRyOwogCXUxNiBtYXhfc3RyaW5nX2NvdW50Owor
CXUxNiBhdXRvX2RldGVjdGlvbl9vdnBfY291bnQ7CiAJdTMyIGJyaWdodG5lc3M7CiAJdTMyIG1h
eF9icmlnaHRuZXNzOwogCXUzMiBzaG9ydF9jb3VudDsKKwl1MzIgYXV0b19kZXRlY3RfY291bnQ7
CiAJYm9vbCBkaXNhYmxlZF9ieV9zaG9ydDsKIAlib29sIGhhc19zaG9ydF9kZXRlY3Q7CisJaW50
IG92cF9pcnE7CiAKIAlzdHJ1Y3Qgd2xlZF9jb25maWcgY2ZnOworCXN0cnVjdCBkZWxheWVkX3dv
cmsgb3ZwX3dvcms7CiAJaW50ICgqd2xlZF9zZXRfYnJpZ2h0bmVzcykoc3RydWN0IHdsZWQgKnds
ZWQsIHUxNiBicmlnaHRuZXNzKTsKIH07CiAKQEAgLTE4MSw2ICsxOTcsMTMgQEAgc3RhdGljIGlu
dCB3bGVkNF9zZXRfYnJpZ2h0bmVzcyhzdHJ1Y3Qgd2xlZCAqd2xlZCwgdTE2IGJyaWdodG5lc3Mp
CiAJcmV0dXJuIDA7CiB9CiAKK3N0YXRpYyB2b2lkIHdsZWRfb3ZwX3dvcmsoc3RydWN0IHdvcmtf
c3RydWN0ICp3b3JrKQoreworCXN0cnVjdCB3bGVkICp3bGVkID0gY29udGFpbmVyX29mKHdvcmss
CisJCQkJCSBzdHJ1Y3Qgd2xlZCwgb3ZwX3dvcmsud29yayk7CisJZW5hYmxlX2lycSh3bGVkLT5v
dnBfaXJxKTsKK30KKwogc3RhdGljIGludCB3bGVkX21vZHVsZV9lbmFibGUoc3RydWN0IHdsZWQg
KndsZWQsIGludCB2YWwpCiB7CiAJaW50IHJjOwpAQCAtMTkyLDcgKzIxNSwxOSBAQCBzdGF0aWMg
aW50IHdsZWRfbW9kdWxlX2VuYWJsZShzdHJ1Y3Qgd2xlZCAqd2xlZCwgaW50IHZhbCkKIAkJCQlX
TEVEM19DVFJMX1JFR19NT0RfRU4sCiAJCQkJV0xFRDNfQ1RSTF9SRUdfTU9EX0VOX01BU0ssCiAJ
CQkJdmFsIDw8IFdMRUQzX0NUUkxfUkVHX01PRF9FTl9TSElGVCk7Ci0JcmV0dXJuIHJjOworCWlm
IChyYyA8IDApCisJCXJldHVybiByYzsKKworCWlmICh3bGVkLT5vdnBfaXJxID4gMCkgeworCQlp
ZiAodmFsKSB7CisJCQlzY2hlZHVsZV9kZWxheWVkX3dvcmsoJndsZWQtPm92cF93b3JrLCBIWiAv
IDEwMCk7CisJCX0gZWxzZSB7CisJCQlpZiAoIWNhbmNlbF9kZWxheWVkX3dvcmtfc3luYygmd2xl
ZC0+b3ZwX3dvcmspKQorCQkJCWRpc2FibGVfaXJxKHdsZWQtPm92cF9pcnEpOworCQl9CisJfQor
CisJcmV0dXJuIDA7CiB9CiAKIHN0YXRpYyBpbnQgd2xlZF9zeW5jX3RvZ2dsZShzdHJ1Y3Qgd2xl
ZCAqd2xlZCkKQEAgLTI5OSw2ICszMzQsMzExIEBAIHN0YXRpYyBpcnFyZXR1cm5fdCB3bGVkX3No
b3J0X2lycV9oYW5kbGVyKGludCBpcnEsIHZvaWQgKl93bGVkKQogCXJldHVybiBJUlFfSEFORExF
RDsKIH0KIAorI2RlZmluZSBBVVRPX0RFVEVDVF9CUklHSFRORVNTCQkyMDAKKworc3RhdGljIHZv
aWQgd2xlZF9hdXRvX3N0cmluZ19kZXRlY3Rpb24oc3RydWN0IHdsZWQgKndsZWQpCit7CisJaW50
IHJjID0gMCwgaTsKKwl1MzIgc2lua19jb25maWcgPSAwLCBpbnRfc3RzOworCXU4IHNpbmtfdGVz
dCA9IDAsIHNpbmtfdmFsaWQgPSAwLCB2YWw7CisKKwkvKiByZWFkIGNvbmZpZ3VyZWQgc2luayBj
b25maWd1cmF0aW9uICovCisJcmMgPSByZWdtYXBfcmVhZCh3bGVkLT5yZWdtYXAsIHdsZWQtPnNp
bmtfYWRkciArCisJCQkgV0xFRDRfU0lOS19SRUdfQ1VSUl9TSU5LLCAmc2lua19jb25maWcpOwor
CWlmIChyYyA8IDApIHsKKwkJZGV2X2Vycih3bGVkLT5kZXYsICJGYWlsZWQgdG8gcmVhZCBTSU5L
IGNvbmZpZ3VyYXRpb24gcmM9JWRcbiIsCisJCQlyYyk7CisJCWdvdG8gZmFpbGVkX2RldGVjdDsK
Kwl9CisKKwkvKiBkaXNhYmxlIHRoZSBtb2R1bGUgYmVmb3JlIHN0YXJ0aW5nIGRldGVjdGlvbiAq
LworCXJjID0gcmVnbWFwX3VwZGF0ZV9iaXRzKHdsZWQtPnJlZ21hcCwKKwkJCQl3bGVkLT5jdHJs
X2FkZHIgKyBXTEVEM19DVFJMX1JFR19NT0RfRU4sCisJCQkJV0xFRDNfQ1RSTF9SRUdfTU9EX0VO
X01BU0ssIDApOworCWlmIChyYyA8IDApIHsKKwkJZGV2X2Vycih3bGVkLT5kZXYsICJGYWlsZWQg
dG8gZGlzYWJsZSBXTEVEIG1vZHVsZSByYz0lZFxuIiwgcmMpOworCQlnb3RvIGZhaWxlZF9kZXRl
Y3Q7CisJfQorCisJLyogc2V0IGxvdyBicmlnaHRuZXNzIGFjcm9zcyBhbGwgc2lua3MgKi8KKwly
YyA9IHdsZWQ0X3NldF9icmlnaHRuZXNzKHdsZWQsIEFVVE9fREVURUNUX0JSSUdIVE5FU1MpOwor
CWlmIChyYyA8IDApIHsKKwkJZGV2X2Vycih3bGVkLT5kZXYsICJGYWlsZWQgdG8gc2V0IGJyaWdo
dG5lc3MgZm9yIGF1dG8gZGV0ZWN0aW9uIHJjPSVkXG4iLAorCQkJcmMpOworCQlnb3RvIGZhaWxl
ZF9kZXRlY3Q7CisJfQorCisJaWYgKHdsZWQtPmNmZy5jYWJjKSB7CisJCWZvciAoaSA9IDA7IGkg
PCB3bGVkLT5jZmcubnVtX3N0cmluZ3M7IGkrKykgeworCQkJcmMgPSByZWdtYXBfdXBkYXRlX2Jp
dHMod2xlZC0+cmVnbWFwLCB3bGVkLT5zaW5rX2FkZHIgKworCQkJCQkJV0xFRDRfU0lOS19SRUdf
U1RSX0NBQkMoaSksCisJCQkJCQlXTEVENF9TSU5LX1JFR19TVFJfQ0FCQ19NQVNLLAorCQkJCQkJ
MCk7CisJCQlpZiAocmMgPCAwKQorCQkJCWdvdG8gZmFpbGVkX2RldGVjdDsKKwkJfQorCX0KKwor
CS8qIGRpc2FibGUgYWxsIHNpbmtzICovCisJcmMgPSByZWdtYXBfd3JpdGUod2xlZC0+cmVnbWFw
LAorCQkJICB3bGVkLT5zaW5rX2FkZHIgKyBXTEVENF9TSU5LX1JFR19DVVJSX1NJTkssIDApOwor
CWlmIChyYyA8IDApIHsKKwkJZGV2X2Vycih3bGVkLT5kZXYsICJGYWlsZWQgdG8gZGlzYWJsZSBh
bGwgc2lua3MgcmM9JWRcbiIsIHJjKTsKKwkJZ290byBmYWlsZWRfZGV0ZWN0OworCX0KKworCS8q
IGl0ZXJhdGUgdGhyb3VnaCB0aGUgc3RyaW5ncyBvbmUgYnkgb25lICovCisJZm9yIChpID0gMDsg
aSA8IHdsZWQtPmNmZy5udW1fc3RyaW5nczsgaSsrKSB7CisJCXNpbmtfdGVzdCA9IEJJVCgoV0xF
RDRfU0lOS19SRUdfQ1VSUl9TSU5LX1NIRlQgKyBpKSk7CisKKwkJLyogRW5hYmxlIGZlZWRiYWNr
IGNvbnRyb2wgKi8KKwkJcmMgPSByZWdtYXBfd3JpdGUod2xlZC0+cmVnbWFwLCB3bGVkLT5jdHJs
X2FkZHIgKworCQkJCSAgV0xFRDNfQ1RSTF9SRUdfRkVFREJBQ0tfQ09OVFJPTCwgaSArIDEpOwor
CQlpZiAocmMgPCAwKSB7CisJCQlkZXZfZXJyKHdsZWQtPmRldiwgIkZhaWxlZCB0byBlbmFibGUg
ZmVlZGJhY2sgZm9yIFNJTksgJWQgcmMgPSAlZFxuIiwKKwkJCQlpICsgMSwgcmMpOworCQkJZ290
byBmYWlsZWRfZGV0ZWN0OworCQl9CisKKwkJLyogZW5hYmxlIHRoZSBzaW5rICovCisJCXJjID0g
cmVnbWFwX3dyaXRlKHdsZWQtPnJlZ21hcCwgd2xlZC0+c2lua19hZGRyICsKKwkJCQkgIFdMRUQ0
X1NJTktfUkVHX0NVUlJfU0lOSywgc2lua190ZXN0KTsKKwkJaWYgKHJjIDwgMCkgeworCQkJZGV2
X2Vycih3bGVkLT5kZXYsICJGYWlsZWQgdG8gY29uZmlndXJlIFNJTksgJWQgcmM9JWRcbiIsCisJ
CQkJaSArIDEsIHJjKTsKKwkJCWdvdG8gZmFpbGVkX2RldGVjdDsKKwkJfQorCisJCS8qIEVuYWJs
ZSB0aGUgbW9kdWxlICovCisJCXJjID0gcmVnbWFwX3VwZGF0ZV9iaXRzKHdsZWQtPnJlZ21hcCwg
d2xlZC0+Y3RybF9hZGRyICsKKwkJCQkJV0xFRDNfQ1RSTF9SRUdfTU9EX0VOLAorCQkJCQlXTEVE
M19DVFJMX1JFR19NT0RfRU5fTUFTSywKKwkJCQkJV0xFRDNfQ1RSTF9SRUdfTU9EX0VOX01BU0sp
OworCQlpZiAocmMgPCAwKSB7CisJCQlkZXZfZXJyKHdsZWQtPmRldiwgIkZhaWxlZCB0byBlbmFi
bGUgV0xFRCBtb2R1bGUgcmM9JWRcbiIsCisJCQkJcmMpOworCQkJZ290byBmYWlsZWRfZGV0ZWN0
OworCQl9CisKKwkJdXNsZWVwX3JhbmdlKFdMRURfU09GVF9TVEFSVF9ETFlfVVMsCisJCQkgICAg
IFdMRURfU09GVF9TVEFSVF9ETFlfVVMgKyAxMDAwKTsKKworCQlyYyA9IHJlZ21hcF9yZWFkKHds
ZWQtPnJlZ21hcCwgd2xlZC0+Y3RybF9hZGRyICsKKwkJCQkgV0xFRDNfQ1RSTF9SRUdfSU5UX1JU
X1NUUywgJmludF9zdHMpOworCQlpZiAocmMgPCAwKSB7CisJCQlkZXZfZXJyKHdsZWQtPmRldiwg
IkVycm9yIGluIHJlYWRpbmcgV0xFRDNfQ1RSTF9JTlRfUlRfU1RTIHJjPSVkXG4iLAorCQkJCXJj
KTsKKwkJCWdvdG8gZmFpbGVkX2RldGVjdDsKKwkJfQorCisJCWlmIChpbnRfc3RzICYgV0xFRDNf
Q1RSTF9SRUdfT1ZQX0ZBVUxUX1NUQVRVUykKKwkJCWRldl9kYmcod2xlZC0+ZGV2LCAiV0xFRCBP
VlAgZmF1bHQgZGV0ZWN0ZWQgd2l0aCBTSU5LICVkXG4iLAorCQkJCWkgKyAxKTsKKwkJZWxzZQor
CQkJc2lua192YWxpZCB8PSBzaW5rX3Rlc3Q7CisKKwkJLyogRGlzYWJsZSB0aGUgbW9kdWxlICov
CisJCXJjID0gcmVnbWFwX3VwZGF0ZV9iaXRzKHdsZWQtPnJlZ21hcCwKKwkJCQkJd2xlZC0+Y3Ry
bF9hZGRyICsgV0xFRDNfQ1RSTF9SRUdfTU9EX0VOLAorCQkJCQlXTEVEM19DVFJMX1JFR19NT0Rf
RU5fTUFTSywgMCk7CisJCWlmIChyYyA8IDApIHsKKwkJCWRldl9lcnIod2xlZC0+ZGV2LCAiRmFp
bGVkIHRvIGRpc2FibGUgV0xFRCBtb2R1bGUgcmM9JWRcbiIsCisJCQkJcmMpOworCQkJZ290byBm
YWlsZWRfZGV0ZWN0OworCQl9CisJfQorCisJaWYgKCFzaW5rX3ZhbGlkKSB7CisJCWRldl9lcnIo
d2xlZC0+ZGV2LCAiTm8gdmFsaWQgV0xFRCBzaW5rcyBmb3VuZFxuIik7CisJCXdsZWQtPmRpc2Fi
bGVkX2J5X3Nob3J0ID0gdHJ1ZTsKKwkJZ290byBmYWlsZWRfZGV0ZWN0OworCX0KKworCWlmIChz
aW5rX3ZhbGlkID09IHNpbmtfY29uZmlnKSB7CisJCWRldl9kYmcod2xlZC0+ZGV2LCAiV0xFRCBh
dXRvLWRldGVjdGlvbiBjb21wbGV0ZSwgc2luay1jb25maWc9JXggT0shXG4iLAorCQkJc2lua19j
b25maWcpOworCX0gZWxzZSB7CisJCWRldl93YXJuKHdsZWQtPmRldiwgIk5ldyBXTEVEIHN0cmlu
ZyBjb25maWd1cmF0aW9uIGZvdW5kICV4XG4iLAorCQkJIHNpbmtfdmFsaWQpOworCQlzaW5rX2Nv
bmZpZyA9IHNpbmtfdmFsaWQ7CisJfQorCisJLyogd3JpdGUgdGhlIG5ldyBzaW5rIGNvbmZpZ3Vy
YXRpb24gKi8KKwlyYyA9IHJlZ21hcF93cml0ZSh3bGVkLT5yZWdtYXAsCisJCQkgIHdsZWQtPnNp
bmtfYWRkciArIFdMRUQ0X1NJTktfUkVHX0NVUlJfU0lOSywKKwkJCSAgc2lua19jb25maWcpOwor
CWlmIChyYyA8IDApIHsKKwkJZGV2X2Vycih3bGVkLT5kZXYsICJGYWlsZWQgdG8gcmVjb25maWd1
cmUgdGhlIGRlZmF1bHQgc2luayByYz0lZFxuIiwKKwkJCXJjKTsKKwkJZ290byBmYWlsZWRfZGV0
ZWN0OworCX0KKworCS8qIEVuYWJsZSB2YWxpZCBzaW5rcyAqLworCWZvciAoaSA9IDA7IGkgPCB3
bGVkLT5jZmcubnVtX3N0cmluZ3M7IGkrKykgeworCQlpZiAod2xlZC0+Y2ZnLmNhYmMpIHsKKwkJ
CXJjID0gcmVnbWFwX3VwZGF0ZV9iaXRzKHdsZWQtPnJlZ21hcCwgd2xlZC0+c2lua19hZGRyICsK
KwkJCQkJCVdMRUQ0X1NJTktfUkVHX1NUUl9DQUJDKGkpLAorCQkJCQkJV0xFRDRfU0lOS19SRUdf
U1RSX0NBQkNfTUFTSywKKwkJCQkJCVdMRUQ0X1NJTktfUkVHX1NUUl9DQUJDX01BU0spOworCQkJ
aWYgKHJjIDwgMCkKKwkJCQlnb3RvIGZhaWxlZF9kZXRlY3Q7CisJCX0KKworCQlpZiAoc2lua19j
b25maWcgJiBCSVQoV0xFRDRfU0lOS19SRUdfQ1VSUl9TSU5LX1NIRlQgKyBpKSkKKwkJCXZhbCA9
IFdMRUQ0X1NJTktfUkVHX1NUUl9NT0RfTUFTSzsKKwkJZWxzZQorCQkJdmFsID0gMHgwOyAvKiBk
aXNhYmxlIG1vZHVsYXRvcl9lbiBmb3IgdW51c2VkIHNpbmsgKi8KKworCQlyYyA9IHJlZ21hcF93
cml0ZSh3bGVkLT5yZWdtYXAsIHdsZWQtPnNpbmtfYWRkciArCisJCQkJICBXTEVENF9TSU5LX1JF
R19TVFJfTU9EX0VOKGkpLCB2YWwpOworCQlpZiAocmMgPCAwKSB7CisJCQlkZXZfZXJyKHdsZWQt
PmRldiwgIkZhaWxlZCB0byBjb25maWd1cmUgTU9EVUxBVE9SX0VOIHJjPSVkXG4iLAorCQkJCXJj
KTsKKwkJCWdvdG8gZmFpbGVkX2RldGVjdDsKKwkJfQorCX0KKworCS8qIHJlc3RvcmUgdGhlIGZl
ZWRiYWNrIHNldHRpbmcgKi8KKwlyYyA9IHJlZ21hcF93cml0ZSh3bGVkLT5yZWdtYXAsCisJCQkg
IHdsZWQtPmN0cmxfYWRkciArIFdMRUQzX0NUUkxfUkVHX0ZFRURCQUNLX0NPTlRST0wsIDApOwor
CWlmIChyYyA8IDApIHsKKwkJZGV2X2Vycih3bGVkLT5kZXYsICJGYWlsZWQgdG8gcmVzdG9yZSBm
ZWVkYmFjayBzZXR0aW5nIHJjPSVkXG4iLAorCQkJcmMpOworCQlnb3RvIGZhaWxlZF9kZXRlY3Q7
CisJfQorCisJLyogcmVzdG9yZSBicmlnaHRuZXNzICovCisJcmMgPSB3bGVkNF9zZXRfYnJpZ2h0
bmVzcyh3bGVkLCB3bGVkLT5icmlnaHRuZXNzKTsKKwlpZiAocmMgPCAwKSB7CisJCWRldl9lcnIo
d2xlZC0+ZGV2LCAiRmFpbGVkIHRvIHNldCBicmlnaHRuZXNzIGFmdGVyIGF1dG8gZGV0ZWN0aW9u
IHJjPSVkXG4iLAorCQkJcmMpOworCQlnb3RvIGZhaWxlZF9kZXRlY3Q7CisJfQorCisJcmMgPSBy
ZWdtYXBfdXBkYXRlX2JpdHMod2xlZC0+cmVnbWFwLAorCQkJCXdsZWQtPmN0cmxfYWRkciArIFdM
RUQzX0NUUkxfUkVHX01PRF9FTiwKKwkJCQlXTEVEM19DVFJMX1JFR19NT0RfRU5fTUFTSywKKwkJ
CQlXTEVEM19DVFJMX1JFR19NT0RfRU5fTUFTSyk7CisJaWYgKHJjIDwgMCkgeworCQlkZXZfZXJy
KHdsZWQtPmRldiwgIkZhaWxlZCB0byBlbmFibGUgV0xFRCBtb2R1bGUgcmM9JWRcbiIsIHJjKTsK
KwkJZ290byBmYWlsZWRfZGV0ZWN0OworCX0KKworZmFpbGVkX2RldGVjdDoKKwlyZXR1cm47Cit9
CisKKyNkZWZpbmUgV0xFRF9BVVRPX0RFVEVDVF9PVlBfQ09VTlQJCTUKKyNkZWZpbmUgV0xFRF9B
VVRPX0RFVEVDVF9DTlRfRExZX1VTCQlVU0VDX1BFUl9TRUMKK3N0YXRpYyBib29sIHdsZWRfYXV0
b19kZXRlY3Rpb25fcmVxdWlyZWQoc3RydWN0IHdsZWQgKndsZWQpCit7CisJczY0IGVsYXBzZWRf
dGltZV91czsKKworCWlmICghd2xlZC0+Y2ZnLmF1dG9fZGV0ZWN0aW9uX2VuYWJsZWQpCisJCXJl
dHVybiBmYWxzZTsKKworCS8qCisJICogQ2hlY2sgaWYgdGhlIE9WUCBmYXVsdCB3YXMgYW4gb2Nj
YXNpb25hbCBvbmUKKwkgKiBvciBpZiBpdCdzIGZpcmluZyBjb250aW51b3VzbHksIHRoZSBsYXR0
ZXIgcXVhbGlmaWVzCisJICogZm9yIGFuIGF1dG8tZGV0ZWN0aW9uIGNoZWNrLgorCSAqLworCWlm
ICghd2xlZC0+YXV0b19kZXRlY3Rpb25fb3ZwX2NvdW50KSB7CisJCXdsZWQtPnN0YXJ0X292cF9m
YXVsdF90aW1lID0ga3RpbWVfZ2V0KCk7CisJCXdsZWQtPmF1dG9fZGV0ZWN0aW9uX292cF9jb3Vu
dCsrOworCX0gZWxzZSB7CisJCWVsYXBzZWRfdGltZV91cyA9IGt0aW1lX3VzX2RlbHRhKGt0aW1l
X2dldCgpLAorCQkJCQkJIHdsZWQtPnN0YXJ0X292cF9mYXVsdF90aW1lKTsKKwkJaWYgKGVsYXBz
ZWRfdGltZV91cyA+IFdMRURfQVVUT19ERVRFQ1RfQ05UX0RMWV9VUykKKwkJCXdsZWQtPmF1dG9f
ZGV0ZWN0aW9uX292cF9jb3VudCA9IDA7CisJCWVsc2UKKwkJCXdsZWQtPmF1dG9fZGV0ZWN0aW9u
X292cF9jb3VudCsrOworCisJCWlmICh3bGVkLT5hdXRvX2RldGVjdGlvbl9vdnBfY291bnQgPj0K
KwkJCQlXTEVEX0FVVE9fREVURUNUX09WUF9DT1VOVCkgeworCQkJd2xlZC0+YXV0b19kZXRlY3Rp
b25fb3ZwX2NvdW50ID0gMDsKKwkJCXJldHVybiB0cnVlOworCQl9CisJfQorCisJcmV0dXJuIGZh
bHNlOworfQorCitzdGF0aWMgaW50IHdsZWRfYXV0b19kZXRlY3Rpb25fYXRfaW5pdChzdHJ1Y3Qg
d2xlZCAqd2xlZCkKK3sKKwlpbnQgcmM7CisJdTMyIGZhdWx0X3N0YXR1cywgcnRfc3RhdHVzOwor
CisJaWYgKCF3bGVkLT5jZmcuYXV0b19kZXRlY3Rpb25fZW5hYmxlZCkKKwkJcmV0dXJuIDA7CisK
KwlyYyA9IHJlZ21hcF9yZWFkKHdsZWQtPnJlZ21hcCwKKwkJCSB3bGVkLT5jdHJsX2FkZHIgKyBX
TEVEM19DVFJMX1JFR19JTlRfUlRfU1RTLAorCQkJICZydF9zdGF0dXMpOworCWlmIChyYyA8IDAp
IHsKKwkJZGV2X2Vycih3bGVkLT5kZXYsICJGYWlsZWQgdG8gcmVhZCBSVCBzdGF0dXMgcmM9JWRc
biIsIHJjKTsKKwkJcmV0dXJuIHJjOworCX0KKworCXJjID0gcmVnbWFwX3JlYWQod2xlZC0+cmVn
bWFwLAorCQkJIHdsZWQtPmN0cmxfYWRkciArIFdMRUQzX0NUUkxfUkVHX0ZBVUxUX1NUQVRVUywK
KwkJCSAmZmF1bHRfc3RhdHVzKTsKKwlpZiAocmMgPCAwKSB7CisJCWRldl9lcnIod2xlZC0+ZGV2
LCAiRmFpbGVkIHRvIHJlYWQgZmF1bHQgc3RhdHVzIHJjPSVkXG4iLCByYyk7CisJCXJldHVybiBy
YzsKKwl9CisKKwlpZiAoKHJ0X3N0YXR1cyAmIFdMRUQzX0NUUkxfUkVHX09WUF9GQVVMVF9TVEFU
VVMpIHx8CisJICAgIChmYXVsdF9zdGF0dXMgJiBXTEVEM19DVFJMX1JFR19PVlBfRkFVTFRfQklU
KSkgeworCQltdXRleF9sb2NrKCZ3bGVkLT5sb2NrKTsKKwkJd2xlZF9hdXRvX3N0cmluZ19kZXRl
Y3Rpb24od2xlZCk7CisJCW11dGV4X3VubG9jaygmd2xlZC0+bG9jayk7CisJfQorCisJcmV0dXJu
IHJjOworfQorCitzdGF0aWMgaXJxcmV0dXJuX3Qgd2xlZF9vdnBfaXJxX2hhbmRsZXIoaW50IGly
cSwgdm9pZCAqX3dsZWQpCit7CisJc3RydWN0IHdsZWQgKndsZWQgPSBfd2xlZDsKKwlpbnQgcmM7
CisJdTMyIGludF9zdHMsIGZhdWx0X3N0czsKKworCXJjID0gcmVnbWFwX3JlYWQod2xlZC0+cmVn
bWFwLAorCQkJIHdsZWQtPmN0cmxfYWRkciArIFdMRUQzX0NUUkxfUkVHX0lOVF9SVF9TVFMsICZp
bnRfc3RzKTsKKwlpZiAocmMgPCAwKSB7CisJCWRldl9lcnIod2xlZC0+ZGV2LCAiRXJyb3IgaW4g
cmVhZGluZyBXTEVEM19JTlRfUlRfU1RTIHJjPSVkXG4iLAorCQkJcmMpOworCQlyZXR1cm4gSVJR
X0hBTkRMRUQ7CisJfQorCisJcmMgPSByZWdtYXBfcmVhZCh3bGVkLT5yZWdtYXAsIHdsZWQtPmN0
cmxfYWRkciArCisJCQkgV0xFRDNfQ1RSTF9SRUdfRkFVTFRfU1RBVFVTLCAmZmF1bHRfc3RzKTsK
KwlpZiAocmMgPCAwKSB7CisJCWRldl9lcnIod2xlZC0+ZGV2LCAiRXJyb3IgaW4gcmVhZGluZyBX
TEVEX0ZBVUxUX1NUQVRVUyByYz0lZFxuIiwKKwkJCXJjKTsKKwkJcmV0dXJuIElSUV9IQU5ETEVE
OworCX0KKworCWlmIChmYXVsdF9zdHMgJgorCQkoV0xFRDNfQ1RSTF9SRUdfT1ZQX0ZBVUxUX0JJ
VCB8IFdMRUQzX0NUUkxfUkVHX0lMSU1fRkFVTFRfQklUKSkKKwkJZGV2X2RiZyh3bGVkLT5kZXYs
ICJXTEVEIE9WUCBmYXVsdCBkZXRlY3RlZCwgaW50X3N0cz0leCBmYXVsdF9zdHM9ICV4XG4iLAor
CQkJaW50X3N0cywgZmF1bHRfc3RzKTsKKworCWlmIChmYXVsdF9zdHMgJiBXTEVEM19DVFJMX1JF
R19PVlBfRkFVTFRfQklUKSB7CisJCW11dGV4X2xvY2soJndsZWQtPmxvY2spOworCQlkaXNhYmxl
X2lycV9ub3N5bmMod2xlZC0+b3ZwX2lycSk7CisKKwkJaWYgKHdsZWRfYXV0b19kZXRlY3Rpb25f
cmVxdWlyZWQod2xlZCkpCisJCQl3bGVkX2F1dG9fc3RyaW5nX2RldGVjdGlvbih3bGVkKTsKKwor
CQllbmFibGVfaXJxKHdsZWQtPm92cF9pcnEpOworCisJCW11dGV4X3VubG9jaygmd2xlZC0+bG9j
ayk7CisJfQorCisJcmV0dXJuIElSUV9IQU5ETEVEOworfQorCiBzdGF0aWMgaW50IHdsZWQzX3Nl
dHVwKHN0cnVjdCB3bGVkICp3bGVkKQogewogCXUxNiBhZGRyOwpAQCAtNDM1LDggKzc3NSwxMCBA
QCBzdGF0aWMgaW50IHdsZWQ0X3NldHVwKHN0cnVjdCB3bGVkICp3bGVkKQogCQlzaW5rX2VuIHw9
IDEgPDwgdGVtcDsKIAl9CiAKLQlpZiAoc2lua19jZmcgPT0gc2lua19lbikKLQkJcmV0dXJuIDA7
CisJaWYgKHNpbmtfY2ZnID09IHNpbmtfZW4pIHsKKwkJcmMgPSB3bGVkX2F1dG9fZGV0ZWN0aW9u
X2F0X2luaXQod2xlZCk7CisJCXJldHVybiByYzsKKwl9CiAKIAlyYyA9IHJlZ21hcF91cGRhdGVf
Yml0cyh3bGVkLT5yZWdtYXAsCiAJCQkJd2xlZC0+c2lua19hZGRyICsgV0xFRDRfU0lOS19SRUdf
Q1VSUl9TSU5LLApAQCAtNDk5LDcgKzg0MSw5IEBAIHN0YXRpYyBpbnQgd2xlZDRfc2V0dXAoc3Ry
dWN0IHdsZWQgKndsZWQpCiAJCXJldHVybiByYzsKIAl9CiAKLQlyZXR1cm4gMDsKKwlyYyA9IHds
ZWRfYXV0b19kZXRlY3Rpb25fYXRfaW5pdCh3bGVkKTsKKworCXJldHVybiByYzsKIH0KIAogc3Rh
dGljIGNvbnN0IHN0cnVjdCB3bGVkX2NvbmZpZyB3bGVkNF9jb25maWdfZGVmYXVsdHMgPSB7CkBA
IC01MTAsNiArODU0LDcgQEAgc3RhdGljIGludCB3bGVkNF9zZXR1cChzdHJ1Y3Qgd2xlZCAqd2xl
ZCkKIAkuc3dpdGNoX2ZyZXEgPSAxMSwKIAkuY2FiYyA9IGZhbHNlLAogCS5leHRlcm5hbF9wZmV0
ID0gZmFsc2UsCisJLmF1dG9fZGV0ZWN0aW9uX2VuYWJsZWQgPSBmYWxzZSwKIH07CiAKIHN0YXRp
YyBjb25zdCB1MzIgd2xlZDNfYm9vc3RfaV9saW1pdF92YWx1ZXNbXSA9IHsKQEAgLTY3Niw2ICsx
MDIxLDcgQEAgc3RhdGljIGludCB3bGVkX2NvbmZpZ3VyZShzdHJ1Y3Qgd2xlZCAqd2xlZCwgaW50
IHZlcnNpb24pCiAJCXsgInFjb20sZXh0LWdlbiIsICZjZmctPmV4dF9nZW4sIH0sCiAJCXsgInFj
b20sY2FiYyIsICZjZmctPmNhYmMsIH0sCiAJCXsgInFjb20sZXh0ZXJuYWwtcGZldCIsICZjZmct
PmV4dGVybmFsX3BmZXQsIH0sCisJCXsgInFjb20sYXV0by1zdHJpbmctZGV0ZWN0aW9uIiwgJmNm
Zy0+YXV0b19kZXRlY3Rpb25fZW5hYmxlZCwgfSwKIAl9OwogCiAJcHJvcF9hZGRyID0gb2ZfZ2V0
X2FkZHJlc3MoZGV2LT5vZl9ub2RlLCAwLCBOVUxMLCBOVUxMKTsKQEAgLTc5Niw2ICsxMTQyLDQw
IEBAIHN0YXRpYyBpbnQgd2xlZF9jb25maWd1cmVfc2hvcnRfaXJxKHN0cnVjdCB3bGVkICp3bGVk
LAogCXJldHVybiByYzsKIH0KIAorc3RhdGljIGludCB3bGVkX2NvbmZpZ3VyZV9vdnBfaXJxKHN0
cnVjdCB3bGVkICp3bGVkLAorCQkJCSAgc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKK3sK
KwlpbnQgcmM7CisJdTMyIHZhbDsKKworCXdsZWQtPm92cF9pcnEgPSBwbGF0Zm9ybV9nZXRfaXJx
X2J5bmFtZShwZGV2LCAib3ZwIik7CisJaWYgKHdsZWQtPm92cF9pcnEgPCAwKSB7CisJCWRldl9k
YmcoJnBkZXYtPmRldiwgIm92cCBpcnEgaXMgbm90IHVzZWRcbiIpOworCQlyZXR1cm4gMDsKKwl9
CisKKwlyYyA9IGRldm1fcmVxdWVzdF90aHJlYWRlZF9pcnEod2xlZC0+ZGV2LCB3bGVkLT5vdnBf
aXJxLCBOVUxMLAorCQkJCSAgICAgICB3bGVkX292cF9pcnFfaGFuZGxlciwgSVJRRl9PTkVTSE9U
LAorCQkJCSAgICAgICAid2xlZF9vdnBfaXJxIiwgd2xlZCk7CisJaWYgKHJjIDwgMCkgeworCQlk
ZXZfZXJyKHdsZWQtPmRldiwgIlVuYWJsZSB0byByZXF1ZXN0IG92cF9pcnEgKGVycjolZClcbiIs
CisJCQlyYyk7CisJCXdsZWQtPm92cF9pcnEgPSAwOworCQlyZXR1cm4gMDsKKwl9CisKKwlyYyA9
IHJlZ21hcF9yZWFkKHdsZWQtPnJlZ21hcCwgd2xlZC0+Y3RybF9hZGRyICsKKwkJCSBXTEVEM19D
VFJMX1JFR19NT0RfRU4sICZ2YWwpOworCWlmIChyYyA8IDApCisJCXJldHVybiByYzsKKworCS8q
IEtlZXAgT1ZQIGlycSBkaXNhYmxlZCB1bnRpbCBtb2R1bGUgaXMgZW5hYmxlZCAqLworCWlmICgh
KHZhbCAmIFdMRUQzX0NUUkxfUkVHX01PRF9FTl9NQVNLKSkKKwkJZGlzYWJsZV9pcnEod2xlZC0+
b3ZwX2lycSk7CisKKwlyZXR1cm4gMDsKK30KKwogc3RhdGljIGNvbnN0IHN0cnVjdCBiYWNrbGln
aHRfb3BzIHdsZWRfb3BzID0gewogCS51cGRhdGVfc3RhdHVzID0gd2xlZF91cGRhdGVfc3RhdHVz
LAogfTsKQEAgLTgzNiw2ICsxMjE2LDcgQEAgc3RhdGljIGludCB3bGVkX3Byb2JlKHN0cnVjdCBw
bGF0Zm9ybV9kZXZpY2UgKnBkZXYpCiAKIAlzd2l0Y2ggKHZlcnNpb24pIHsKIAljYXNlIDM6CisJ
CXdsZWQtPmNmZy5hdXRvX2RldGVjdGlvbl9lbmFibGVkID0gZmFsc2U7CiAJCXJjID0gd2xlZDNf
c2V0dXAod2xlZCk7CiAJCWlmIChyYykgewogCQkJZGV2X2VycigmcGRldi0+ZGV2LCAid2xlZDNf
c2V0dXAgZmFpbGVkXG4iKTsKQEAgLTg1NywxMCArMTIzOCwxNiBAQCBzdGF0aWMgaW50IHdsZWRf
cHJvYmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKIAkJYnJlYWs7CiAJfQogCisJSU5J
VF9ERUxBWUVEX1dPUksoJndsZWQtPm92cF93b3JrLCB3bGVkX292cF93b3JrKTsKKwogCXJjID0g
d2xlZF9jb25maWd1cmVfc2hvcnRfaXJxKHdsZWQsIHBkZXYpOwogCWlmIChyYyA8IDApCiAJCXJl
dHVybiByYzsKIAorCXJjID0gd2xlZF9jb25maWd1cmVfb3ZwX2lycSh3bGVkLCBwZGV2KTsKKwlp
ZiAocmMgPCAwKQorCQlyZXR1cm4gcmM7CisKIAl2YWwgPSBXTEVEX0RFRkFVTFRfQlJJR0hUTkVT
UzsKIAlvZl9wcm9wZXJ0eV9yZWFkX3UzMihwZGV2LT5kZXYub2Zfbm9kZSwgImRlZmF1bHQtYnJp
Z2h0bmVzcyIsICZ2YWwpOwogCkBAIC04NzQsNiArMTI2MSwxNiBAQCBzdGF0aWMgaW50IHdsZWRf
cHJvYmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKIAlyZXR1cm4gUFRSX0VSUl9PUl9a
RVJPKGJsKTsKIH07CiAKK3N0YXRpYyBpbnQgd2xlZF9yZW1vdmUoc3RydWN0IHBsYXRmb3JtX2Rl
dmljZSAqcGRldikKK3sKKwlzdHJ1Y3Qgd2xlZCAqd2xlZCA9IGRldl9nZXRfZHJ2ZGF0YSgmcGRl
di0+ZGV2KTsKKworCWNhbmNlbF9kZWxheWVkX3dvcmtfc3luYygmd2xlZC0+b3ZwX3dvcmspOwor
CW11dGV4X2Rlc3Ryb3koJndsZWQtPmxvY2spOworCisJcmV0dXJuIDA7Cit9CisKIHN0YXRpYyBj
b25zdCBzdHJ1Y3Qgb2ZfZGV2aWNlX2lkIHdsZWRfbWF0Y2hfdGFibGVbXSA9IHsKIAl7IC5jb21w
YXRpYmxlID0gInFjb20scG04OTQxLXdsZWQiLCAuZGF0YSA9ICh2b2lkICopMyB9LAogCXsgLmNv
bXBhdGlibGUgPSAicWNvbSxwbWk4OTk4LXdsZWQiLCAuZGF0YSA9ICh2b2lkICopNCB9LApAQCAt
ODg0LDYgKzEyODEsNyBAQCBzdGF0aWMgaW50IHdsZWRfcHJvYmUoc3RydWN0IHBsYXRmb3JtX2Rl
dmljZSAqcGRldikKIAogc3RhdGljIHN0cnVjdCBwbGF0Zm9ybV9kcml2ZXIgd2xlZF9kcml2ZXIg
PSB7CiAJLnByb2JlID0gd2xlZF9wcm9iZSwKKwkucmVtb3ZlID0gd2xlZF9yZW1vdmUsCiAJLmRy
aXZlcgk9IHsKIAkJLm5hbWUgPSAicWNvbSx3bGVkIiwKIAkJLm9mX21hdGNoX3RhYmxlCT0gd2xl
ZF9tYXRjaF90YWJsZSwKLS0gClRoZSBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRlciwgSW5jLiBp
cyBhIG1lbWJlciBvZiB0aGUgQ29kZSBBdXJvcmEgRm9ydW0sCiBhIExpbnV4IEZvdW5kYXRpb24g
Q29sbGFib3JhdGl2ZSBQcm9qZWN0CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVl
ZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5m
by9kcmktZGV2ZWw=
