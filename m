Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 1001E287FC3
	for <lists+dri-devel@lfdr.de>; Fri,  9 Oct 2020 03:04:35 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 95C916EB98;
	Fri,  9 Oct 2020 01:04:23 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mga04.intel.com (mga04.intel.com [192.55.52.120])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 034806EB95
 for <dri-devel@lists.freedesktop.org>; Fri,  9 Oct 2020 01:04:20 +0000 (UTC)
IronPort-SDR: 3tE5g0KtBQT+9K+Z8dMJ94z0PSy5NAwucQ3LVF8TaaDqUa/zGoWBMsRwVHSq967yp58mCbAwYl
 IeOLAw3ok5Lw==
X-IronPort-AV: E=McAfee;i="6000,8403,9768"; a="162789787"
X-IronPort-AV: E=Sophos;i="5.77,353,1596524400"; d="scan'208";a="162789787"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga004.fm.intel.com ([10.253.24.48])
 by fmsmga104.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 08 Oct 2020 18:04:20 -0700
IronPort-SDR: 3Ri6w/oFofEzrbIUz/qPbsBgjah/Nxr73RdNwRN/sLhcRZUlbzJAhpg7U8qhBP5gIkn+/F21fh
 dQOwBM08Br7A==
X-IronPort-AV: E=Sophos;i="5.77,353,1596524400"; d="scan'208";a="343626293"
Received: from mgleaso-mobl.amr.corp.intel.com (HELO
 achrisan-DESK2.amr.corp.intel.com) ([10.251.146.83])
 by fmsmga004-auth.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-SHA;
 08 Oct 2020 18:04:19 -0700
From: Anitha Chrisanthus <anitha.chrisanthus@intel.com>
To: dri-devel@lists.freedesktop.org, anitha.chrisanthus@intel.com,
 devicetree@vger.kernel.org
Subject: [PATCH v9 4/5] drm/kmb: Mipi DSI part of the display driver
Date: Thu,  8 Oct 2020 18:04:02 -0700
Message-Id: <1602205443-9036-5-git-send-email-anitha.chrisanthus@intel.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1602205443-9036-1-git-send-email-anitha.chrisanthus@intel.com>
References: <1602205443-9036-1-git-send-email-anitha.chrisanthus@intel.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: daniel.vetter@intel.com, edmund.j.dea@intel.com, sam@ravnborg.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW5pdGlhbGl6ZXMgTWlwaSBEU0kgYW5kIHNldHMgdXAgY29ubmVjdHMgdG8gQURWIGJyaWRnZQoK
djI6IHJlbW92ZWQgbGljZW5zZSB0ZXh0CiAgICB1cGNsYXNzZWQgZGV2X3ByaXZhdGUsIHJlbW92
ZWQgSEFWRV9JUlEuIChTYW0pCgp2MzogU3F1YXNoZWQgYWxsIDU5IGNvbW1pdHMgdG8gb25lCgp2
NDogcmV2aWV3IGNoYW5nZXMgZnJvbSBTYW0gUmF2bmJvcmcKCXJlbmFtZWQgZGV2X3AgdG8ga21i
Cgp2NTogY29ycmVjdGVkIHNwZWxsaW5ncwp2NjogY29ycmVjdGVkIGNoZWNrcGF0Y2ggd2Fybmlu
Z3MKdjc6IHJldmlldyBjaGFuZ2VzIFNhbSBSYXZuYm9yZyBhbmQgVGhvbWFzIFppbW1lcm1hbgoJ
cmVtb3ZlZCB1bm5lY2Vzc2FyeSBsb2dzIGFuZCBkZWZpbmVzIGFuZCBpZmRlZiBjb2RlcyAoU2Ft
KQoJc3BsaXQgZHBoeV9pbml0X3NlcXVlbmNlIHNtYWxsZXIgKFNhbSkKCXJlbW92ZWQgcmVkdW5k
YW50IGNoZWNrcyBpbiBrbWJfZHNpIChTYW0pCgljaGFuZ2VkIGttYl9kc2lfaW5pdCB0byBkcm1f
YnJpZGdlX2Nvbm5lY3Rvcl9pbml0IGFuZAoJZHJtX2Nvbm5lY3Rvcl9hdHRhY2hfZW5jb2RlciB0
byBicmlkZ2UncyBjb25uZWN0b3IgKFNhbSkKdjg6IGNhbGwgZHJtX2JyaWRnZV9hdHRhY2ggd2l0
aCBEUk1fQlJJREdFX0FUVEFDSF9OT19DT05ORUNUT1IKdjk6IHJlbmFtZWQga21iX2RzaV9od19p
bml0IHRvIGttYl9kc2lfbW9kZV9zZXQgKERhbmllbCBWKQoKQ2M6IFNhbSBSYXZuYm9yZyA8c2Ft
QHJhdm5ib3JnLm9yZz4KU2lnbmVkLW9mZi1ieTogQW5pdGhhIENocmlzYW50aHVzIDxhbml0aGEu
Y2hyaXNhbnRodXNAaW50ZWwuY29tPgpSZXZpZXdlZC1ieTogQm9iIFBhYXV3ZSA8Ym9iLmoucGFh
dXdlQGludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0va21iL2ttYl9kc2kuYyB8IDE1MjQg
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIGRyaXZlcnMvZ3B1L2Ry
bS9rbWIva21iX2RzaS5oIHwgIDM1MCArKysrKysrKysrCiAyIGZpbGVzIGNoYW5nZWQsIDE4NzQg
aW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9rbWIva21i
X2RzaS5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2ttYi9rbWJfZHNpLmgK
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0va21iL2ttYl9kc2kuYyBiL2RyaXZlcnMvZ3B1
L2RybS9rbWIva21iX2RzaS5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjBj
MDBjN2QKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0va21iL2ttYl9kc2kuYwpA
QCAtMCwwICsxLDE1MjQgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9u
bHkKKy8qCisgKiBDb3B5cmlnaHQgwqkgMjAxOS0yMDIwIEludGVsIENvcnBvcmF0aW9uCisgKi8K
KworI2luY2x1ZGUgPGxpbnV4L2RlbGF5Lmg+CisjaW5jbHVkZSA8bGludXgvZ3Bpby9jb25zdW1l
ci5oPgorI2luY2x1ZGUgPGxpbnV4L3NsYWIuaD4KKyNpbmNsdWRlIDxsaW51eC9zcGlubG9jay5o
PgorCisjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2Ry
bV9icmlkZ2UuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2JyaWRnZV9jb25uZWN0b3IuaD4KKyNpbmNs
dWRlIDxkcm0vZHJtX2Nvbm5lY3Rvci5oPgorI2luY2x1ZGUgPGRybS9kcm1fY3J0Yy5oPgorI2lu
Y2x1ZGUgPGRybS9kcm1fY3J0Y19oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2VkaWQuaD4K
KyNpbmNsdWRlIDxkcm0vZHJtX21pcGlfZHNpLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wcmludC5o
PgorI2luY2x1ZGUgPGRybS9kcm1fcHJvYmVfaGVscGVyLmg+CisKKyNpbmNsdWRlICJrbWJfZHJ2
LmgiCisjaW5jbHVkZSAia21iX2RzaS5oIgorI2luY2x1ZGUgImttYl9yZWdzLmgiCisKK3N0YXRp
YyBzdHJ1Y3QgbWlwaV9kc2lfaG9zdCAqZHNpX2hvc3Q7CitzdGF0aWMgc3RydWN0IG1pcGlfZHNp
X2RldmljZSAqZHNpX2RldmljZTsKKworLyogRGVmYXVsdCBzZXR0aW5nIGlzIDEwODBwLCA0IGxh
bmVzICovCisjZGVmaW5lIElNR19IRUlHSFRfTElORVMgIDEwODAKKyNkZWZpbmUgSU1HX1dJRFRI
X1BYICAgICAgMTkyMAorI2RlZmluZSBNSVBJX1RYX0FDVElWRV9MQU5FUyA0CisKK3N0cnVjdCBt
aXBpX3R4X2ZyYW1lX3NlY3Rpb25fY2ZnIG1pcGlfdHhfZnJhbWUwX3NlY3RfY2ZnID0geworCS53
aWR0aF9waXhlbHMgPSBJTUdfV0lEVEhfUFgsCisJLmhlaWdodF9saW5lcyA9IElNR19IRUlHSFRf
TElORVMsCisJLmRhdGFfdHlwZSA9IERTSV9MUF9EVF9QUFNfUkdCODg4XzI0QiwKKwkuZGF0YV9t
b2RlID0gTUlQSV9EQVRBX01PREUxLAorCS5kbWFfcGFja2VkID0gMAorfTsKKworc3RydWN0IG1p
cGlfdHhfZnJhbWVfY2ZnIG1pcGl0eF9mcmFtZTBfY2ZnID0geworCS5zZWN0aW9uc1swXSA9ICZt
aXBpX3R4X2ZyYW1lMF9zZWN0X2NmZywKKwkuc2VjdGlvbnNbMV0gPSBOVUxMLAorCS5zZWN0aW9u
c1syXSA9IE5VTEwsCisJLnNlY3Rpb25zWzNdID0gTlVMTCwKKwkudnN5bmNfd2lkdGggPSA1LAor
CS52X2JhY2twb3JjaCA9IDM2LAorCS52X2Zyb250cG9yY2ggPSA0LAorCS5oc3luY193aWR0aCA9
IDQ0LAorCS5oX2JhY2twb3JjaCA9IDE0OCwKKwkuaF9mcm9udHBvcmNoID0gODgKK307CisKK3N0
cnVjdCBtaXBpX3R4X2RzaV9jZmcgbWlwaXR4X2RzaV9jZmcgPSB7CisJLmhmcF9ibGFua19lbiA9
IDAsCisJLmVvdHBfZW4gPSAwLAorCS5scG1fbGFzdF92ZnBfbGluZSA9IDAsCisJLmxwbV9maXJz
dF92c2FfbGluZSA9IDAsCisJLnN5bmNfcHVsc2VfZXZlbnRuID0gRFNJX1ZJREVPX01PREVfTk9f
QlVSU1RfRVZFTlQsCisJLmhmcF9ibGFua2luZyA9IFNFTkRfQkxBTktfUEFDS0VULAorCS5oYnBf
YmxhbmtpbmcgPSBTRU5EX0JMQU5LX1BBQ0tFVCwKKwkuaHNhX2JsYW5raW5nID0gU0VORF9CTEFO
S19QQUNLRVQsCisJLnZfYmxhbmtpbmcgPSBTRU5EX0JMQU5LX1BBQ0tFVCwKK307CisKK3N0cnVj
dCBtaXBpX2N0cmxfY2ZnIG1pcGlfdHhfaW5pdF9jZmcgPSB7CisJLmFjdGl2ZV9sYW5lcyA9IE1J
UElfVFhfQUNUSVZFX0xBTkVTLAorCS5sYW5lX3JhdGVfbWJwcyA9IE1JUElfVFhfTEFORV9EQVRB
X1JBVEVfTUJQUywKKwkucmVmX2Nsa19raHogPSBNSVBJX1RYX1JFRl9DTEtfS0haLAorCS5jZmdf
Y2xrX2toeiA9IE1JUElfVFhfQ0ZHX0NMS19LSFosCisJLnR4X2N0cmxfY2ZnID0geworCQkJLmZy
YW1lc1swXSA9ICZtaXBpdHhfZnJhbWUwX2NmZywKKwkJCS5mcmFtZXNbMV0gPSBOVUxMLAorCQkJ
LmZyYW1lc1syXSA9IE5VTEwsCisJCQkuZnJhbWVzWzNdID0gTlVMTCwKKwkJCS50eF9kc2lfY2Zn
ID0gJm1pcGl0eF9kc2lfY2ZnLAorCQkJLmxpbmVfc3luY19wa3RfZW4gPSAwLAorCQkJLmxpbmVf
Y291bnRlcl9hY3RpdmUgPSAwLAorCQkJLmZyYW1lX2NvdW50ZXJfYWN0aXZlID0gMCwKKwkJCS50
eF9hbHdheXNfdXNlX2hhY3QgPSAxLAorCQkJLnR4X2hhY3Rfd2FpdF9zdG9wID0gMSwKKwkJCX0K
K307CisKK3N0cnVjdCAgbWlwaV9oc19mcmVxX3JhbmdlX2NmZyB7CisJdTE2IGRlZmF1bHRfYml0
X3JhdGVfbWJwczsKKwl1OCBoc2ZyZXFyYW5nZV9jb2RlOworfTsKKworc3RydWN0IHZjb19wYXJh
bXMgeworCXUzMiBmcmVxOworCXUzMiByYW5nZTsKKwl1MzIgZGl2aWRlcjsKK307CisKK3N0YXRp
YyBzdHJ1Y3QgdmNvX3BhcmFtcyB2Y29fdGFibGVbXSA9IHsKKwl7NTIsIDB4M2YsIDh9LAorCXs4
MCwgMHgzOSwgOH0sCisJezEwNSwgMHgyZiwgNH0sCisJezE2MCwgMHgyOSwgNH0sCisJezIxMCwg
MHgxZiwgMn0sCisJezMyMCwgMHgxOSwgMn0sCisJezQyMCwgMHgwZiwgMX0sCisJezYzMCwgMHgw
OSwgMX0sCisJezExMDAsIDB4MDMsIDF9LAorCXsweGZmZmYsIDB4MDEsIDF9LAorfTsKKworc3Rh
dGljIHN0cnVjdCBtaXBpX2hzX2ZyZXFfcmFuZ2VfY2ZnCittaXBpX2hzX2ZyZXFfcmFuZ2VbTUlQ
SV9EUEhZX0RFRkFVTFRfQklUX1JBVEVTXSA9IHsKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9
IDgwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MDB9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBz
ID0gOTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgxMH0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21i
cHMgPSAxMDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgyMH0sCisJey5kZWZhdWx0X2JpdF9yYXRl
X21icHMgPSAxMTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgzMH0sCisJey5kZWZhdWx0X2JpdF9y
YXRlX21icHMgPSAxMjAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgwMX0sCisJey5kZWZhdWx0X2Jp
dF9yYXRlX21icHMgPSAxMzAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgxMX0sCisJey5kZWZhdWx0
X2JpdF9yYXRlX21icHMgPSAxNDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgyMX0sCisJey5kZWZh
dWx0X2JpdF9yYXRlX21icHMgPSAxNTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgzMX0sCisJey5k
ZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxNjAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgwMn0sCisJ
ey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxNzAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgxMn0s
CisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxODAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgy
Mn0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxOTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0g
MHgzMn0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAyMDUsIC5oc2ZyZXFyYW5nZV9jb2Rl
ID0gMHgwM30sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAyMjAsIC5oc2ZyZXFyYW5nZV9j
b2RlID0gMHgxM30sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAyMzUsIC5oc2ZyZXFyYW5n
ZV9jb2RlID0gMHgyM30sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAyNTAsIC5oc2ZyZXFy
YW5nZV9jb2RlID0gMHgzM30sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAyNzUsIC5oc2Zy
ZXFyYW5nZV9jb2RlID0gMHgwNH0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAzMDAsIC5o
c2ZyZXFyYW5nZV9jb2RlID0gMHgxNH0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAzMjUs
IC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgyNX0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAz
NTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgzNX0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMg
PSA0MDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgwNX0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21i
cHMgPSA0NTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgxNn0sCisJey5kZWZhdWx0X2JpdF9yYXRl
X21icHMgPSA1MDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgyNn0sCisJey5kZWZhdWx0X2JpdF9y
YXRlX21icHMgPSA1NTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgzN30sCisJey5kZWZhdWx0X2Jp
dF9yYXRlX21icHMgPSA2MDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgwN30sCisJey5kZWZhdWx0
X2JpdF9yYXRlX21icHMgPSA2NTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgxOH0sCisJey5kZWZh
dWx0X2JpdF9yYXRlX21icHMgPSA3MDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgyOH0sCisJey5k
ZWZhdWx0X2JpdF9yYXRlX21icHMgPSA3NTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgzOX0sCisJ
ey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSA4MDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgwOX0s
CisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSA4NTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgx
OX0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSA5MDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0g
MHgyOX0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxMDAwLCAuaHNmcmVxcmFuZ2VfY29k
ZSA9IDB4MEF9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTA1MCwgLmhzZnJlcXJhbmdl
X2NvZGUgPSAweDFBfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDExMDAsIC5oc2ZyZXFy
YW5nZV9jb2RlID0gMHgyQX0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxMTUwLCAuaHNm
cmVxcmFuZ2VfY29kZSA9IDB4M0J9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTIwMCwg
LmhzZnJlcXJhbmdlX2NvZGUgPSAweDBCfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDEy
NTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgxQn0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMg
PSAxMzAwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MkJ9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9t
YnBzID0gMTM1MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDNDfSwKKwl7LmRlZmF1bHRfYml0X3Jh
dGVfbWJwcyA9IDE0MDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgwQ30sCisJey5kZWZhdWx0X2Jp
dF9yYXRlX21icHMgPSAxNDUwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MUN9LAorCXsuZGVmYXVs
dF9iaXRfcmF0ZV9tYnBzID0gMTUwMCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDJDfSwKKwl7LmRl
ZmF1bHRfYml0X3JhdGVfbWJwcyA9IDE1NTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgzRH0sCisJ
ey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxNjAwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MER9
LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTY1MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAw
eDFEfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDE3MDAsIC5oc2ZyZXFyYW5nZV9jb2Rl
ID0gMHgyRX0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxNzUwLCAuaHNmcmVxcmFuZ2Vf
Y29kZSA9IDB4M0V9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTgwMCwgLmhzZnJlcXJh
bmdlX2NvZGUgPSAweDBFfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDE4NTAsIC5oc2Zy
ZXFyYW5nZV9jb2RlID0gMHgxRX0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxOTAwLCAu
aHNmcmVxcmFuZ2VfY29kZSA9IDB4MkZ9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTk1
MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDNGfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9
IDIwMDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgwRn0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21i
cHMgPSAyMDUwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4NDB9LAorCXsuZGVmYXVsdF9iaXRfcmF0
ZV9tYnBzID0gMjEwMCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDQxfSwKKwl7LmRlZmF1bHRfYml0
X3JhdGVfbWJwcyA9IDIxNTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHg0Mn0sCisJey5kZWZhdWx0
X2JpdF9yYXRlX21icHMgPSAyMjAwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4NDN9LAorCXsuZGVm
YXVsdF9iaXRfcmF0ZV9tYnBzID0gMjI1MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDQ0fSwKKwl7
LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDIzMDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHg0NX0s
CisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAyMzUwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4
NDZ9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMjQwMCwgLmhzZnJlcXJhbmdlX2NvZGUg
PSAweDQ3fSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDI0NTAsIC5oc2ZyZXFyYW5nZV9j
b2RlID0gMHg0OH0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAyNTAwLCAuaHNmcmVxcmFu
Z2VfY29kZSA9IDB4NDl9Cit9OworCitzdGF0aWMgZW51bSBkcm1fbW9kZV9zdGF0dXMKK2ttYl9k
c2lfbW9kZV92YWxpZChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAorCQkgICBzdHJ1
Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkKK3sKKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0g
Y29ubmVjdG9yLT5kZXY7CisJc3RydWN0IGRybV9tb2RlX2NvbmZpZyAqbW9kZV9jb25maWcgPSAm
ZGV2LT5tb2RlX2NvbmZpZzsKKworCWlmIChtb2RlLT5oZGlzcGxheSA8IG1vZGVfY29uZmlnLT5t
aW5fd2lkdGggfHwKKwkgICAgbW9kZS0+aGRpc3BsYXkgPiBtb2RlX2NvbmZpZy0+bWF4X3dpZHRo
KQorCQlyZXR1cm4gTU9ERV9CQURfSFZBTFVFOworCisJaWYgKG1vZGUtPnZkaXNwbGF5IDwgbW9k
ZV9jb25maWctPm1pbl9oZWlnaHQgfHwKKwkgICAgbW9kZS0+dmRpc3BsYXkgPiBtb2RlX2NvbmZp
Zy0+bWF4X2hlaWdodCkKKwkJcmV0dXJuIE1PREVfQkFEX1ZWQUxVRTsKKworCXJldHVybiBNT0RF
X09LOworfQorCitzdGF0aWMgaW50IGttYl9kc2lfZ2V0X21vZGVzKHN0cnVjdCBkcm1fY29ubmVj
dG9yICpjb25uZWN0b3IpCit7CisJaW50IG51bV9tb2RlcyA9IDA7CisKKwludW1fbW9kZXMgPSBk
cm1fYWRkX21vZGVzX25vZWRpZChjb25uZWN0b3IsCisJCQkJCSBjb25uZWN0b3ItPmRldi0+bW9k
ZV9jb25maWcubWF4X3dpZHRoLAorCQkJIGNvbm5lY3Rvci0+ZGV2LT5tb2RlX2NvbmZpZy5tYXhf
aGVpZ2h0KTsKKworCURSTV9JTkZPKCJ3aWR0aD0lZCBoZWlnaHQ9JWRcbiIsCisJCSBjb25uZWN0
b3ItPmRldi0+bW9kZV9jb25maWcubWF4X3dpZHRoLAorCQkgY29ubmVjdG9yLT5kZXYtPm1vZGVf
Y29uZmlnLm1heF9oZWlnaHQpOworCURSTV9JTkZPKCJudW0gbW9kZXM9JWRcbiIsIG51bV9tb2Rl
cyk7CisKKwlyZXR1cm4gbnVtX21vZGVzOworfQorCit2b2lkIGttYl9kc2lfaG9zdF91bnJlZ2lz
dGVyKHZvaWQpCit7CisJbWlwaV9kc2lfaG9zdF91bnJlZ2lzdGVyKGRzaV9ob3N0KTsKKwlrZnJl
ZShkc2lfaG9zdCk7Cit9CisKK3N0YXRpYyB2b2lkIGttYl9kc2lfY29ubmVjdG9yX2Rlc3Ryb3ko
c3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKK3sKKwlzdHJ1Y3Qga21iX2Nvbm5lY3Rv
ciAqa21iX2Nvbm5lY3RvciA9IHRvX2ttYl9jb25uZWN0b3IoY29ubmVjdG9yKTsKKworCWRybV9j
b25uZWN0b3JfY2xlYW51cChjb25uZWN0b3IpOworCWtmcmVlKGttYl9jb25uZWN0b3IpOworfQor
CitzdGF0aWMgdm9pZCBrbWJfZHNpX2VuY29kZXJfZGVzdHJveShzdHJ1Y3QgZHJtX2VuY29kZXIg
KmVuY29kZXIpCit7CisJc3RydWN0IGttYl9kc2kgKmttYl9kc2kgPSB0b19rbWJfZHNpKGVuY29k
ZXIpOworCisJaWYgKCFrbWJfZHNpKQorCQlyZXR1cm47CisKKwlrZnJlZShrbWJfZHNpLT5kc2lf
aG9zdCk7CisKKwlkcm1fZW5jb2Rlcl9jbGVhbnVwKGVuY29kZXIpOworCisJa2ZyZWUoa21iX2Rz
aSk7CisJaWYgKCFkc2lfZGV2aWNlKQorCQlrZnJlZShkc2lfZGV2aWNlKTsKK30KKworc3RhdGlj
IGNvbnN0IHN0cnVjdCBkcm1fZW5jb2Rlcl9mdW5jcyBrbWJfZHNpX2Z1bmNzID0geworCS5kZXN0
cm95ID0ga21iX2RzaV9lbmNvZGVyX2Rlc3Ryb3ksCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0
Citkcm1fY29ubmVjdG9yX2hlbHBlcl9mdW5jcyBrbWJfZHNpX2Nvbm5lY3Rvcl9oZWxwZXJfZnVu
Y3MgPSB7CisJLmdldF9tb2RlcyA9IGttYl9kc2lfZ2V0X21vZGVzLAorCS5tb2RlX3ZhbGlkID0g
a21iX2RzaV9tb2RlX3ZhbGlkLAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVj
dG9yX2Z1bmNzIGttYl9kc2lfY29ubmVjdG9yX2Z1bmNzID0geworCS5kZXN0cm95ID0ga21iX2Rz
aV9jb25uZWN0b3JfZGVzdHJveSwKKwkuZmlsbF9tb2RlcyA9IGRybV9oZWxwZXJfcHJvYmVfc2lu
Z2xlX2Nvbm5lY3Rvcl9tb2RlcywKKwkucmVzZXQgPSBkcm1fYXRvbWljX2hlbHBlcl9jb25uZWN0
b3JfcmVzZXQsCisJLmF0b21pY19kZXN0cm95X3N0YXRlID0gZHJtX2F0b21pY19oZWxwZXJfY29u
bmVjdG9yX2Rlc3Ryb3lfc3RhdGUsCisJLmF0b21pY19kdXBsaWNhdGVfc3RhdGUgPSBkcm1fYXRv
bWljX2hlbHBlcl9jb25uZWN0b3JfZHVwbGljYXRlX3N0YXRlLAorfTsKKworc3RhdGljIHNzaXpl
X3Qga21iX2RzaV9ob3N0X3RyYW5zZmVyKHN0cnVjdCBtaXBpX2RzaV9ob3N0ICpob3N0LAorCQkJ
CSAgICAgY29uc3Qgc3RydWN0IG1pcGlfZHNpX21zZyAqbXNnKQoreworCXJldHVybiAwOworfQor
CitzdGF0aWMgaW50IGttYl9kc2lfaG9zdF9hdHRhY2goc3RydWN0IG1pcGlfZHNpX2hvc3QgKmhv
c3QsCisJCQkgICAgICAgc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZGV2KQoreworCXJldHVybiAw
OworfQorCitzdGF0aWMgaW50IGttYl9kc2lfaG9zdF9kZXRhY2goc3RydWN0IG1pcGlfZHNpX2hv
c3QgKmhvc3QsCisJCQkgICAgICAgc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZGV2KQoreworCXJl
dHVybiAwOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IG1pcGlfZHNpX2hvc3Rfb3BzIGttYl9k
c2lfaG9zdF9vcHMgPSB7CisJLmF0dGFjaCA9IGttYl9kc2lfaG9zdF9hdHRhY2gsCisJLmRldGFj
aCA9IGttYl9kc2lfaG9zdF9kZXRhY2gsCisJLnRyYW5zZmVyID0ga21iX2RzaV9ob3N0X3RyYW5z
ZmVyLAorfTsKKworc3RhdGljIHN0cnVjdCBrbWJfZHNpX2hvc3QgKmttYl9kc2lfaG9zdF9pbml0
KHN0cnVjdCBkcm1fZGV2aWNlICpkcm0sCisJCQkJCSAgICAgIHN0cnVjdCBrbWJfZHNpICprbWJf
ZHNpKQoreworCXN0cnVjdCBrbWJfZHNpX2hvc3QgKmhvc3Q7CisKKwlob3N0ID0ga3phbGxvYyhz
aXplb2YoKmhvc3QpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWhvc3QpCisJCXJldHVybiBOVUxMOwor
CisJaG9zdC0+YmFzZSA9IGRzaV9ob3N0OworCWhvc3QtPmJhc2UtPm9wcyA9ICZrbWJfZHNpX2hv
c3Rfb3BzOworCWhvc3QtPmttYl9kc2kgPSBrbWJfZHNpOworCisJaG9zdC0+YmFzZS0+ZGV2ID0g
ZHJtLT5kZXY7CisKKwlkc2lfZGV2aWNlLT5ob3N0ID0gaG9zdC0+YmFzZTsKKwlob3N0LT5kZXZp
Y2UgPSBkc2lfZGV2aWNlOworCXJldHVybiBob3N0OworfQorCitzdHJ1Y3QgZHJtX2JyaWRnZSAq
a21iX2RzaV9ob3N0X2JyaWRnZV9pbml0KHN0cnVjdCBkZXZpY2UgKmRldikKK3sKKwlzdHJ1Y3Qg
ZHJtX2JyaWRnZSAqYnJpZGdlID0gTlVMTDsKKwlzdHJ1Y3QgZGV2aWNlX25vZGUgKmVuY29kZXJf
bm9kZTsKKworCS8qIENyZWF0ZSBhbmQgcmVnaXN0ZXIgTUlQSSBEU0kgaG9zdCAqLworCWlmICgh
ZHNpX2hvc3QpIHsKKwkJZHNpX2hvc3QgPSBremFsbG9jKHNpemVvZigqZHNpX2hvc3QpLCBHRlBf
S0VSTkVMKTsKKwkJaWYgKCFkc2lfaG9zdCkKKwkJCXJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwor
CisJCWRzaV9ob3N0LT5vcHMgPSAma21iX2RzaV9ob3N0X29wczsKKworCQlpZiAoIWRzaV9kZXZp
Y2UpIHsKKwkJCWRzaV9kZXZpY2UgPSBremFsbG9jKHNpemVvZigqZHNpX2RldmljZSksIEdGUF9L
RVJORUwpOworCQkJaWYgKCFkc2lfZGV2aWNlKSB7CisJCQkJa2ZyZWUoZHNpX2hvc3QpOworCQkJ
CXJldHVybiBFUlJfUFRSKC1FTk9NRU0pOworCQkJfQorCQl9CisKKwkJZHNpX2hvc3QtPmRldiA9
IGRldjsKKwkJbWlwaV9kc2lfaG9zdF9yZWdpc3Rlcihkc2lfaG9zdCk7CisJfQorCS8qIEZpbmQg
QURWNzUzNSBub2RlIGFuZCBpbml0aWFsaXplIGl0ICovCisJZW5jb2Rlcl9ub2RlID0gb2ZfcGFy
c2VfcGhhbmRsZShkZXYtPm9mX25vZGUsICJlbmNvZGVyLXNsYXZlIiwgMCk7CisKKwlpZiAoIWVu
Y29kZXJfbm9kZSkgeworCQlEUk1fRVJST1IoIkZhaWxlZCB0byBnZXQgYnJpZGdlIGluZm8gZnJv
bSBEVFxuIik7CisJCXJldHVybiBFUlJfUFRSKC1FSU5WQUwpOworCX0KKworCS8qIExvY2F0ZSBk
cm0gYnJpZGdlIGZyb20gdGhlIGhkbWkgZW5jb2RlciBEVCBub2RlICovCisJYnJpZGdlID0gb2Zf
ZHJtX2ZpbmRfYnJpZGdlKGVuY29kZXJfbm9kZSk7CisJb2Zfbm9kZV9wdXQoZW5jb2Rlcl9ub2Rl
KTsKKwlpZiAoIWJyaWRnZSkgeworCQlEUk1fSU5GTygiV2FpdCBmb3IgZXh0ZXJuYWwgYnJpZGdl
IGRyaXZlciBEVFxuIik7CisJCXJldHVybiBFUlJfUFRSKC1FUFJPQkVfREVGRVIpOworCX0KKwly
ZXR1cm4gYnJpZGdlOworfQorCitzdGF0aWMgdTMyIG1pcGlfZ2V0X2RhdGF0eXBlX3BhcmFtcyh1
MzIgZGF0YV90eXBlLCB1MzIgZGF0YV9tb2RlLAorCQkJCSAgICBzdHJ1Y3QgbWlwaV9kYXRhX3R5
cGVfcGFyYW1zICpwYXJhbXMpCit7CisJc3RydWN0IG1pcGlfZGF0YV90eXBlX3BhcmFtcyBkYXRh
X3R5cGVfcGFyYW07CisKKwlzd2l0Y2ggKGRhdGFfdHlwZSkgeworCWNhc2UgRFNJX0xQX0RUX1BQ
U19ZQ0JDUjQyMF8xMkI6CisJCWRhdGFfdHlwZV9wYXJhbS5zaXplX2NvbnN0cmFpbnRfcGl4ZWxz
ID0gMjsKKwkJZGF0YV90eXBlX3BhcmFtLnNpemVfY29uc3RyYWludF9ieXRlcyA9IDM7CisJCXN3
aXRjaCAoZGF0YV9tb2RlKSB7CisJCQkvKiBDYXNlIDAgbm90IHN1cHBvcnRlZCBhY2NvcmRpbmcg
dG8gTURLICovCisJCWNhc2UgMToKKwkJY2FzZSAyOgorCQljYXNlIDM6CisJCQlkYXRhX3R5cGVf
cGFyYW0ucGl4ZWxzX3Blcl9wY2xrID0gMjsKKwkJCWRhdGFfdHlwZV9wYXJhbS5iaXRzX3Blcl9w
Y2xrID0gMjQ7CisJCQlicmVhazsKKwkJZGVmYXVsdDoKKwkJCURSTV9FUlJPUigiRFNJOiBJbnZh
bGlkIGRhdGFfbW9kZSAlZFxuIiwgZGF0YV9tb2RlKTsKKwkJCXJldHVybiAtRUlOVkFMOworCQl9
OworCQlicmVhazsKKwljYXNlIERTSV9MUF9EVF9QUFNfWUNCQ1I0MjJfMTZCOgorCQlkYXRhX3R5
cGVfcGFyYW0uc2l6ZV9jb25zdHJhaW50X3BpeGVscyA9IDI7CisJCWRhdGFfdHlwZV9wYXJhbS5z
aXplX2NvbnN0cmFpbnRfYnl0ZXMgPSA0OworCQlzd2l0Y2ggKGRhdGFfbW9kZSkgeworCQkJLyog
Q2FzZSAwIGFuZCAxIG5vdCBzdXBwb3J0ZWQgYWNjb3JkaW5nCisJCQkgKiB0byBNREsKKwkJCSAq
LworCQljYXNlIDI6CisJCQlkYXRhX3R5cGVfcGFyYW0ucGl4ZWxzX3Blcl9wY2xrID0gMTsKKwkJ
CWRhdGFfdHlwZV9wYXJhbS5iaXRzX3Blcl9wY2xrID0gMTY7CisJCQlicmVhazsKKwkJY2FzZSAz
OgorCQkJZGF0YV90eXBlX3BhcmFtLnBpeGVsc19wZXJfcGNsayA9IDI7CisJCQlkYXRhX3R5cGVf
cGFyYW0uYml0c19wZXJfcGNsayA9IDMyOworCQkJYnJlYWs7CisJCWRlZmF1bHQ6CisJCQlEUk1f
RVJST1IoIkRTSTogSW52YWxpZCBkYXRhX21vZGUgJWRcbiIsIGRhdGFfbW9kZSk7CisJCQlyZXR1
cm4gLUVJTlZBTDsKKwkJfTsKKwkJYnJlYWs7CisJY2FzZSBEU0lfTFBfRFRfTFBQU19ZQ0JDUjQy
Ml8yMEI6CisJY2FzZSBEU0lfTFBfRFRfUFBTX1lDQkNSNDIyXzI0QjoKKwkJZGF0YV90eXBlX3Bh
cmFtLnNpemVfY29uc3RyYWludF9waXhlbHMgPSAyOworCQlkYXRhX3R5cGVfcGFyYW0uc2l6ZV9j
b25zdHJhaW50X2J5dGVzID0gNjsKKwkJc3dpdGNoIChkYXRhX21vZGUpIHsKKwkJCS8qIENhc2Ug
MCBub3Qgc3VwcG9ydGVkIGFjY29yZGluZyB0byBNREsgKi8KKwkJY2FzZSAxOgorCQljYXNlIDI6
CisJCWNhc2UgMzoKKwkJCWRhdGFfdHlwZV9wYXJhbS5waXhlbHNfcGVyX3BjbGsgPSAxOworCQkJ
ZGF0YV90eXBlX3BhcmFtLmJpdHNfcGVyX3BjbGsgPSAyNDsKKwkJCWJyZWFrOworCQlkZWZhdWx0
OgorCQkJRFJNX0VSUk9SKCJEU0k6IEludmFsaWQgZGF0YV9tb2RlICVkXG4iLCBkYXRhX21vZGUp
OworCQkJcmV0dXJuIC1FSU5WQUw7CisJCX07CisJCWJyZWFrOworCWNhc2UgRFNJX0xQX0RUX1BQ
U19SR0I1NjVfMTZCOgorCQlkYXRhX3R5cGVfcGFyYW0uc2l6ZV9jb25zdHJhaW50X3BpeGVscyA9
IDE7CisJCWRhdGFfdHlwZV9wYXJhbS5zaXplX2NvbnN0cmFpbnRfYnl0ZXMgPSAyOworCQlzd2l0
Y2ggKGRhdGFfbW9kZSkgeworCQljYXNlIDA6CisJCWNhc2UgMToKKwkJCWRhdGFfdHlwZV9wYXJh
bS5waXhlbHNfcGVyX3BjbGsgPSAxOworCQkJZGF0YV90eXBlX3BhcmFtLmJpdHNfcGVyX3BjbGsg
PSAxNjsKKwkJCWJyZWFrOworCQljYXNlIDI6CisJCWNhc2UgMzoKKwkJCWRhdGFfdHlwZV9wYXJh
bS5waXhlbHNfcGVyX3BjbGsgPSAyOworCQkJZGF0YV90eXBlX3BhcmFtLmJpdHNfcGVyX3BjbGsg
PSAzMjsKKwkJCWJyZWFrOworCQlkZWZhdWx0OgorCQkJRFJNX0VSUk9SKCJEU0k6IEludmFsaWQg
ZGF0YV9tb2RlICVkXG4iLCBkYXRhX21vZGUpOworCQkJcmV0dXJuIC1FSU5WQUw7CisJCX07CisJ
CWJyZWFrOworCWNhc2UgRFNJX0xQX0RUX1BQU19SR0I2NjZfMThCOgorCQlkYXRhX3R5cGVfcGFy
YW0uc2l6ZV9jb25zdHJhaW50X3BpeGVscyA9IDQ7CisJCWRhdGFfdHlwZV9wYXJhbS5zaXplX2Nv
bnN0cmFpbnRfYnl0ZXMgPSA5OworCQlkYXRhX3R5cGVfcGFyYW0uYml0c19wZXJfcGNsayA9IDE4
OworCQlkYXRhX3R5cGVfcGFyYW0ucGl4ZWxzX3Blcl9wY2xrID0gMTsKKwkJYnJlYWs7CisJY2Fz
ZSBEU0lfTFBfRFRfTFBQU19SR0I2NjZfMThCOgorCWNhc2UgRFNJX0xQX0RUX1BQU19SR0I4ODhf
MjRCOgorCQlkYXRhX3R5cGVfcGFyYW0uc2l6ZV9jb25zdHJhaW50X3BpeGVscyA9IDE7CisJCWRh
dGFfdHlwZV9wYXJhbS5zaXplX2NvbnN0cmFpbnRfYnl0ZXMgPSAzOworCQlkYXRhX3R5cGVfcGFy
YW0uYml0c19wZXJfcGNsayA9IDI0OworCQlkYXRhX3R5cGVfcGFyYW0ucGl4ZWxzX3Blcl9wY2xr
ID0gMTsKKwkJYnJlYWs7CisJY2FzZSBEU0lfTFBfRFRfUFBTX1JHQjEwMTAxMF8zMEI6CisJCWRh
dGFfdHlwZV9wYXJhbS5zaXplX2NvbnN0cmFpbnRfcGl4ZWxzID0gNDsKKwkJZGF0YV90eXBlX3Bh
cmFtLnNpemVfY29uc3RyYWludF9ieXRlcyA9IDE1OworCQlkYXRhX3R5cGVfcGFyYW0uYml0c19w
ZXJfcGNsayA9IDMwOworCQlkYXRhX3R5cGVfcGFyYW0ucGl4ZWxzX3Blcl9wY2xrID0gMTsKKwkJ
YnJlYWs7CisJZGVmYXVsdDoKKwkJRFJNX0VSUk9SKCJEU0k6IEludmFsaWQgZGF0YV90eXBlICVk
XG4iLCBkYXRhX3R5cGUpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9OworCisJKnBhcmFtcyA9IGRh
dGFfdHlwZV9wYXJhbTsKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHUzMiBjb21wdXRlX3djKHUz
MiB3aWR0aF9weCwgdTggc2l6ZV9jb25zdHJfcCwgdTggc2l6ZV9jb25zdHJfYikKK3sKKwkvKiBD
YWxjdWxhdGUgdGhlIHdvcmQgY291bnQgZm9yIGVhY2ggbG9uZyBwYWNrZXQgKi8KKwlyZXR1cm4g
KCgod2lkdGhfcHggLyBzaXplX2NvbnN0cl9wKSAqIHNpemVfY29uc3RyX2IpICYgMHhmZmZmKTsK
K30KKworc3RhdGljIHUzMiBjb21wdXRlX3VucGFja2VkX2J5dGVzKHUzMiB3YywgdTggYml0c19w
ZXJfcGNsaykKK3sKKwkvKiBOdW1iZXIgb2YgUENMSyBjeWNsZXMgbmVlZGVkIHRvIHRyYW5zZmVy
IGEgbGluZQorCSAqIHdpdGggZWFjaCBQQ0xLIGN5Y2xlLCA0IEJ5dGVzIGFyZSBzZW50IHRocm91
Z2ggdGhlIFBQTCBtb2R1bGUKKwkgKi8KKwlyZXR1cm4gKCh3YyAqIDgpIC8gYml0c19wZXJfcGNs
aykgKiA0OworfQorCitzdGF0aWMgdTMyIG1pcGlfdHhfZmdfc2VjdGlvbl9jZmdfcmVncyhzdHJ1
Y3Qga21iX2RybV9wcml2YXRlICprbWIsCisJCQkJICAgICAgIHU4IGZyYW1lX2lkLCB1OCBzZWN0
aW9uLAorCQkJCSAgICAgICB1MzIgaGVpZ2h0X2xpbmVzLCB1MzIgdW5wYWNrZWRfYnl0ZXMsCisJ
CQkJICAgICAgIHN0cnVjdCBtaXBpX3R4X2ZyYW1lX3NlY3RfcGhjZmcgKnBoX2NmZykKK3sKKwl1
MzIgY2ZnID0gMDsKKwl1MzIgY3RybF9ubyA9IE1JUElfQ1RSTDY7CisJdTMyIHJlZ19hZHI7CisK
KwkvKiBGcmFtZSBzZWN0aW9uIHBhY2tldCBoZWFkZXIgKi8KKwkvKiBXb3JkIGNvdW50IGJpdHMg
WzE1OjBdICovCisJY2ZnID0gKHBoX2NmZy0+d2MgJiBNSVBJX1RYX1NFQ1RfV0NfTUFTSykgPDwg
MDsKKworCS8qIERhdGEgdHlwZSAoYml0cyBbMjE6MTZdKSAqLworCWNmZyB8PSAoKHBoX2NmZy0+
ZGF0YV90eXBlICYgTUlQSV9UWF9TRUNUX0RUX01BU0spCisJCTw8IE1JUElfVFhfU0VDVF9EVF9T
SElGVCk7CisKKwkvKiBWaXJ0dWFsIGNoYW5uZWwgKGJpdHMgWzIzOjIyXSkgKi8KKwljZmcgfD0g
KChwaF9jZmctPnZjaGFubmVsICYgTUlQSV9UWF9TRUNUX1ZDX01BU0spCisJCTw8IE1JUElfVFhf
U0VDVF9WQ19TSElGVCk7CisKKwkvKiBEYXRhIG1vZGUgKGJpdHMgWzI0OjI1XSkgKi8KKwljZmcg
fD0gKChwaF9jZmctPmRhdGFfbW9kZSAmIE1JUElfVFhfU0VDVF9ETV9NQVNLKQorCQk8PCBNSVBJ
X1RYX1NFQ1RfRE1fU0hJRlQpOworCWlmIChwaF9jZmctPmRtYV9wYWNrZWQpCisJCWNmZyB8PSBN
SVBJX1RYX1NFQ1RfRE1BX1BBQ0tFRDsKKworCWRybV9kYmcoJmttYi0+ZHJtLAorCQkiY3RybD0l
ZCBmcmFtZV9pZD0lZCBzZWN0aW9uPSVkIGNmZz0leCBwYWNrZWQ9JWRcbiIsCisJCSAgY3RybF9u
bywgZnJhbWVfaWQsIHNlY3Rpb24sIGNmZywgcGhfY2ZnLT5kbWFfcGFja2VkKTsKKwlrbWJfd3Jp
dGVfbWlwaShrbWIsCisJCSAgICAgICAoTUlQSV9UWG1fSFNfRkduX1NFQ1RvX1BIKGN0cmxfbm8s
IGZyYW1lX2lkLCBzZWN0aW9uKSksCisJCSAgICAgICBjZmcpOworCisJLyogVW5wYWNrZWQgYnl0
ZXMgKi8KKworCS8qIFRoZXJlIGFyZSA0IGZyYW1lIGdlbmVyYXRvcnMgYW5kIGVhY2ggZmcgaGFz
IDQgc2VjdGlvbnMKKwkgKiBUaGVyZSBhcmUgMiByZWdpc3RlcnMgZm9yIHVucGFja2VkIGJ5dGVz
ICgjIGJ5dGVzIGVhY2gKKwkgKiBzZWN0aW9uIG9jY3VwaWVzIGluIG1lbW9yeSkKKwkgKiBSRUdf
VU5QQUNLRURfQllURVMwOiBbMTU6MF0tQllURVMwLCBbMzE6MTZdLUJZVEVTMQorCSAqIFJFR19V
TlBBQ0tFRF9CWVRFUzE6IFsxNTowXS1CWVRFUzIsIFszMToxNl0tQllURVMzCisJICovCisJcmVn
X2FkciA9CisJICAgIE1JUElfVFhtX0hTX0ZHbl9TRUNUX1VOUEFDS0VEX0JZVEVTMChjdHJsX25v
LAorCQkJCQkJIGZyYW1lX2lkKSArIChzZWN0aW9uIC8gMikgKiA0OworCWttYl93cml0ZV9iaXRz
X21pcGkoa21iLCByZWdfYWRyLCAoc2VjdGlvbiAlIDIpICogMTYsIDE2LAorCQkJICAgIHVucGFj
a2VkX2J5dGVzKTsKKwlkcm1fZGJnKCZrbWItPmRybSwKKwkJInVucGFja2VkX2J5dGVzID0gJWQs
IHdvcmRjb3VudCA9ICVkXG4iLCB1bnBhY2tlZF9ieXRlcywKKwkJICBwaF9jZmctPndjKTsKKwor
CS8qIExpbmUgY29uZmlnICovCisJcmVnX2FkciA9IE1JUElfVFhtX0hTX0ZHbl9TRUNUb19MSU5F
X0NGRyhjdHJsX25vLCBmcmFtZV9pZCwgc2VjdGlvbik7CisJa21iX3dyaXRlX21pcGkoa21iLCBy
ZWdfYWRyLCBoZWlnaHRfbGluZXMpOworCXJldHVybiAwOworfQorCitzdGF0aWMgdTMyIG1pcGlf
dHhfZmdfc2VjdGlvbl9jZmcoc3RydWN0IGttYl9kcm1fcHJpdmF0ZSAqa21iLAorCQkJCSAgdTgg
ZnJhbWVfaWQsIHU4IHNlY3Rpb24sCisJCQkJICBzdHJ1Y3QgbWlwaV90eF9mcmFtZV9zZWN0aW9u
X2NmZyAqZnJhbWVfc2NmZywKKwkJCQkgIHUzMiAqYml0c19wZXJfcGNsaywgdTMyICp3YykKK3sK
Kwl1MzIgcmV0ID0gMDsKKwl1MzIgdW5wYWNrZWRfYnl0ZXM7CisJc3RydWN0IG1pcGlfZGF0YV90
eXBlX3BhcmFtcyBkYXRhX3R5cGVfcGFyYW1ldGVyczsKKwlzdHJ1Y3QgbWlwaV90eF9mcmFtZV9z
ZWN0X3BoY2ZnIHBoX2NmZzsKKworCXJldCA9IG1pcGlfZ2V0X2RhdGF0eXBlX3BhcmFtcyhmcmFt
ZV9zY2ZnLT5kYXRhX3R5cGUsCisJCQkJICAgICAgIGZyYW1lX3NjZmctPmRhdGFfbW9kZSwKKwkJ
CQkgICAgICAgJmRhdGFfdHlwZV9wYXJhbWV0ZXJzKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0
OworCisJLyogUGFja2V0IHdpZHRoIGhhcyB0byBiZSBhIG11bHRpcGxlIG9mIHRoZSBtaW5pbXVt
IHBhY2tldCB3aWR0aAorCSAqIChpbiBwaXhlbHMpIHNldCBmb3IgZWFjaCBkYXRhIHR5cGUKKwkg
Ki8KKwlpZiAoZnJhbWVfc2NmZy0+d2lkdGhfcGl4ZWxzICUKKwkgICAgZGF0YV90eXBlX3BhcmFt
ZXRlcnMuc2l6ZV9jb25zdHJhaW50X3BpeGVscyAhPSAwKQorCQlyZXR1cm4gLUVJTlZBTDsKKwor
CSp3YyA9IGNvbXB1dGVfd2MoZnJhbWVfc2NmZy0+d2lkdGhfcGl4ZWxzLAorCQkJIGRhdGFfdHlw
ZV9wYXJhbWV0ZXJzLnNpemVfY29uc3RyYWludF9waXhlbHMsCisJCQkgZGF0YV90eXBlX3BhcmFt
ZXRlcnMuc2l6ZV9jb25zdHJhaW50X2J5dGVzKTsKKwl1bnBhY2tlZF9ieXRlcyA9IGNvbXB1dGVf
dW5wYWNrZWRfYnl0ZXMoKndjLAorCQkJCQkJZGF0YV90eXBlX3BhcmFtZXRlcnMuYml0c19wZXJf
cGNsayk7CisJcGhfY2ZnLndjID0gKndjOworCXBoX2NmZy5kYXRhX21vZGUgPSBmcmFtZV9zY2Zn
LT5kYXRhX21vZGU7CisJcGhfY2ZnLmRhdGFfdHlwZSA9IGZyYW1lX3NjZmctPmRhdGFfdHlwZTsK
KwlwaF9jZmcuZG1hX3BhY2tlZCA9IGZyYW1lX3NjZmctPmRtYV9wYWNrZWQ7CisJcGhfY2ZnLnZj
aGFubmVsID0gZnJhbWVfaWQ7CisKKwltaXBpX3R4X2ZnX3NlY3Rpb25fY2ZnX3JlZ3Moa21iLCBm
cmFtZV9pZCwgc2VjdGlvbiwKKwkJCQkgICAgZnJhbWVfc2NmZy0+aGVpZ2h0X2xpbmVzLAorCQkJ
CSAgICB1bnBhY2tlZF9ieXRlcywgJnBoX2NmZyk7CisKKwkvKiBDYWxsZXIgbmVlZHMgYml0c19w
ZXJfY2xrIGZvciBhZGRpdGlvbmFsIGNhbHVjbGF0aW9ucyAqLworCSpiaXRzX3Blcl9wY2xrID0g
ZGF0YV90eXBlX3BhcmFtZXRlcnMuYml0c19wZXJfcGNsazsKKworCXJldHVybiAwOworfQorCitz
dGF0aWMgdm9pZCBtaXBpX3R4X2ZnX2NmZ19yZWdzKHN0cnVjdCBrbWJfZHJtX3ByaXZhdGUgKmtt
YiwgdTggZnJhbWVfZ2VuLAorCQkJCXN0cnVjdCBtaXBpX3R4X2ZyYW1lX3RpbWluZ19jZmcgKmZn
X2NmZykKK3sKKwl1MzIgc3lzY2xrOworCXUzMiBwcGxfbGxwX3JhdGlvOworCXUzMiBjdHJsX25v
ID0gTUlQSV9DVFJMNiwgcmVnX2FkciwgdmFsLCBvZmZzZXQ7CisKKwkvKiA1MDAgTWh6IHN5c3Rl
bSBjbG9jayBtaW51cyA1MCB0byBhY2NvdW50IGZvciB0aGUgZGlmZmVyZW5jZSBpbgorCSAqIE1J
UEkgY2xvY2sgc3BlZWQgaW4gUlRMIHRlc3RzCisJICovCisJc3lzY2xrID0ga21iLT5zeXNfY2xr
X21oeiAtIDUwOworCisJLyogUFBMLVBpeGVsIFBhY2tpbmcgTGF5ZXIsIExMUC1Mb3cgTGV2ZWwg
UHJvdG9jb2wKKwkgKiBGcmFtZSBnZW5hcnRvciB0aW1pbmcgcGFyYW1ldGVycyBhcmUgY2xvY2tl
ZCBvbiB0aGUgc3lzdGVtIGNsb2NrLAorCSAqIHdoZXJlYXMgYXMgdGhlIGVxdWl2YWxlbnQgcGFy
YW1ldGVycyBpbiB0aGUgTExQIGJsb2NrcyBhcmUgY2xvY2tlZAorCSAqIG9uIExMUCBUeCBjbG9j
ayBmcm9tIHRoZSBELVBIWSAtIEJZVEUgY2xvY2sKKwkgKi8KKworCS8qIE11bHRpcGx5IGJ5IDEw
MDAgdG8gbWFpbnRhaW4gcHJlY2lzaW9uICovCisJcHBsX2xscF9yYXRpbyA9ICgoZmdfY2ZnLT5i
cHAgLyA4KSAqIHN5c2NsayAqIDEwMDApIC8KKwkgICAgKChmZ19jZmctPmxhbmVfcmF0ZV9tYnBz
IC8gOCkgKiBmZ19jZmctPmFjdGl2ZV9sYW5lcyk7CisKKwlkcm1fZGJnKCZrbWItPmRybSwgInBw
bF9sbHBfcmF0aW89JWRcbiIsIHBwbF9sbHBfcmF0aW8pOworCWRybV9kYmcoJmttYi0+ZHJtLCAi
YnBwPSVkIHN5c2Nsaz0lZCBsYW5lLXJhdGU9JWQgYWN0aXZlLWxhbmVzPSVkXG4iLAorCQlmZ19j
ZmctPmJwcCwgc3lzY2xrLCBmZ19jZmctPmxhbmVfcmF0ZV9tYnBzLAorCQkgZmdfY2ZnLT5hY3Rp
dmVfbGFuZXMpOworCisJLyogRnJhbWUgZ2VuZXJhdG9yIG51bWJlciBvZiBsaW5lcyAqLworCXJl
Z19hZHIgPSBNSVBJX1RYbV9IU19GR25fTlVNX0xJTkVTKGN0cmxfbm8sIGZyYW1lX2dlbik7CisJ
a21iX3dyaXRlX21pcGkoa21iLCByZWdfYWRyLCBmZ19jZmctPnZfYWN0aXZlKTsKKworCS8qIHZz
eW5jIHdpZHRoCisJICogVGhlcmUgYXJlIDIgcmVnaXN0ZXJzIGZvciB2c3luYyB3aWR0aCAoVlNB
IGluIGxpbmVzIGZvcgorCSAqIGNoYW5uZWxzIDAtMykKKwkgKiBSRUdfVlNZTkNfV0lEVEgwOiBb
MTU6MF0tVlNBIGZvciBjaGFubmVsMCwgWzMxOjE2XS1WU0EgZm9yIGNoYW5uZWwxCisJICogUkVH
X1ZTWU5DX1dJRFRIMTogWzE1OjBdLVZTQSBmb3IgY2hhbm5lbDIsIFszMToxNl0tVlNBIGZvciBj
aGFubmVsMworCSAqLworCW9mZnNldCA9IChmcmFtZV9nZW4gJSAyKSAqIDE2OworCXJlZ19hZHIg
PSBNSVBJX1RYbV9IU19WU1lOQ19XSURUSG4oY3RybF9ubywgZnJhbWVfZ2VuIC8gMik7CisJa21i
X3dyaXRlX2JpdHNfbWlwaShrbWIsIHJlZ19hZHIsIG9mZnNldCwgMTYsIGZnX2NmZy0+dnN5bmNf
d2lkdGgpOworCisJLyogdmVydGljYWwgYmFja3BvcmNoICh2YnApICovCisJcmVnX2FkciA9IE1J
UElfVFhtX0hTX1ZfQkFDS1BPUkNIRVNuKGN0cmxfbm8sIGZyYW1lX2dlbiAvIDIpOworCWttYl93
cml0ZV9iaXRzX21pcGkoa21iLCByZWdfYWRyLCBvZmZzZXQsIDE2LCBmZ19jZmctPnZfYmFja3Bv
cmNoKTsKKworCS8qIHZlcnRpY2FsIGZyb250cG9yY2ggKHZmcCkgKi8KKwlyZWdfYWRyID0gTUlQ
SV9UWG1fSFNfVl9GUk9OVFBPUkNIRVNuKGN0cmxfbm8sIGZyYW1lX2dlbiAvIDIpOworCWttYl93
cml0ZV9iaXRzX21pcGkoa21iLCByZWdfYWRyLCBvZmZzZXQsIDE2LCBmZ19jZmctPnZfZnJvbnRw
b3JjaCk7CisKKwkvKiB2ZXJ0aWNhbCBhY3RpdmUgKHZhY3RpdmUpICovCisJcmVnX2FkciA9IE1J
UElfVFhtX0hTX1ZfQUNUSVZFbihjdHJsX25vLCBmcmFtZV9nZW4gLyAyKTsKKwlrbWJfd3JpdGVf
Yml0c19taXBpKGttYiwgcmVnX2Fkciwgb2Zmc2V0LCAxNiwgZmdfY2ZnLT52X2FjdGl2ZSk7CisK
KwkvKiBoc3luYyB3aWR0aCAqLworCXJlZ19hZHIgPSBNSVBJX1RYbV9IU19IU1lOQ19XSURUSG4o
Y3RybF9ubywgZnJhbWVfZ2VuKTsKKwlrbWJfd3JpdGVfbWlwaShrbWIsIHJlZ19hZHIsCisJCSAg
ICAgICAoZmdfY2ZnLT5oc3luY193aWR0aCAqIHBwbF9sbHBfcmF0aW8pIC8gMTAwMCk7CisKKwkv
KiBob3Jpem9udGFsIGJhY2twb3JjaCAoaGJwKSAqLworCXJlZ19hZHIgPSBNSVBJX1RYbV9IU19I
X0JBQ0tQT1JDSG4oY3RybF9ubywgZnJhbWVfZ2VuKTsKKwlrbWJfd3JpdGVfbWlwaShrbWIsIHJl
Z19hZHIsCisJCSAgICAgICAoZmdfY2ZnLT5oX2JhY2twb3JjaCAqIHBwbF9sbHBfcmF0aW8pIC8g
MTAwMCk7CisKKwkvKiBob3Jpem9udGFsIGZyb250cG9yY2ggKGhmcCkgKi8KKwlyZWdfYWRyID0g
TUlQSV9UWG1fSFNfSF9GUk9OVFBPUkNIbihjdHJsX25vLCBmcmFtZV9nZW4pOworCWttYl93cml0
ZV9taXBpKGttYiwgcmVnX2FkciwKKwkJICAgICAgIChmZ19jZmctPmhfZnJvbnRwb3JjaCAqIHBw
bF9sbHBfcmF0aW8pIC8gMTAwMCk7CisKKwkvKiBob3Jpem9udGFsIGFjdGl2ZSAoaGEpICovCisJ
cmVnX2FkciA9IE1JUElfVFhtX0hTX0hfQUNUSVZFbihjdHJsX25vLCBmcmFtZV9nZW4pOworCisJ
LyogY29udmVydCBoX2FjdGl2ZSB3aGljaCBpcyB3YyBpbiBieXRlcyB0byBjeWNsZXMgKi8KKwl2
YWwgPSAoZmdfY2ZnLT5oX2FjdGl2ZSAqIHN5c2NsayAqIDEwMDApIC8KKwkgICAgKChmZ19jZmct
PmxhbmVfcmF0ZV9tYnBzIC8gOCkgKiBmZ19jZmctPmFjdGl2ZV9sYW5lcyk7CisJdmFsIC89IDEw
MDA7CisJa21iX3dyaXRlX21pcGkoa21iLCByZWdfYWRyLCB2YWwpOworCisJLyogbGxwIGhzeW5j
IHdpZHRoICovCisJcmVnX2FkciA9IE1JUElfVFhtX0hTX0xMUF9IU1lOQ19XSURUSG4oY3RybF9u
bywgZnJhbWVfZ2VuKTsKKwlrbWJfd3JpdGVfbWlwaShrbWIsIHJlZ19hZHIsIGZnX2NmZy0+aHN5
bmNfd2lkdGggKiAoZmdfY2ZnLT5icHAgLyA4KSk7CisKKwkvKiBsbHAgaCBiYWNrcG9yY2ggKi8K
KwlyZWdfYWRyID0gTUlQSV9UWG1fSFNfTExQX0hfQkFDS1BPUkNIbihjdHJsX25vLCBmcmFtZV9n
ZW4pOworCWttYl93cml0ZV9taXBpKGttYiwgcmVnX2FkciwgZmdfY2ZnLT5oX2JhY2twb3JjaCAq
IChmZ19jZmctPmJwcCAvIDgpKTsKKworCS8qIGxscCBoIGZyb250cG9yY2ggKi8KKwlyZWdfYWRy
ID0gTUlQSV9UWG1fSFNfTExQX0hfRlJPTlRQT1JDSG4oY3RybF9ubywgZnJhbWVfZ2VuKTsKKwlr
bWJfd3JpdGVfbWlwaShrbWIsIHJlZ19hZHIsCisJCSAgICAgICBmZ19jZmctPmhfZnJvbnRwb3Jj
aCAqIChmZ19jZmctPmJwcCAvIDgpKTsKK30KKworc3RhdGljIHZvaWQgbWlwaV90eF9mZ19jZmco
c3RydWN0IGttYl9kcm1fcHJpdmF0ZSAqa21iLCB1OCBmcmFtZV9nZW4sCisJCQkgICB1OCBhY3Rp
dmVfbGFuZXMsIHUzMiBicHAsIHUzMiB3YywKKwkJCSAgIHUzMiBsYW5lX3JhdGVfbWJwcywgc3Ry
dWN0IG1pcGlfdHhfZnJhbWVfY2ZnICpmZ19jZmcpCit7CisJdTMyIGksIGZnX251bV9saW5lcyA9
IDA7CisJc3RydWN0IG1pcGlfdHhfZnJhbWVfdGltaW5nX2NmZyBmZ190X2NmZzsKKworCS8qIENh
bGN1bGF0ZSB0aGUgdG90YWwgZnJhbWUgZ2VuZXJhdG9yIG51bWJlciBvZgorCSAqIGxpbmVzIGJh
c2VkIG9uIGl0J3MgYWN0aXZlIHNlY3Rpb25zCisJICovCisJZm9yIChpID0gMDsgaSA8IE1JUElf
VFhfRlJBTUVfR0VOX1NFQ1RJT05TOyBpKyspIHsKKwkJaWYgKGZnX2NmZy0+c2VjdGlvbnNbaV0p
CisJCQlmZ19udW1fbGluZXMgKz0gZmdfY2ZnLT5zZWN0aW9uc1tpXS0+aGVpZ2h0X2xpbmVzOwor
CX0KKworCWZnX3RfY2ZnLmJwcCA9IGJwcDsKKwlmZ190X2NmZy5sYW5lX3JhdGVfbWJwcyA9IGxh
bmVfcmF0ZV9tYnBzOworCWZnX3RfY2ZnLmhzeW5jX3dpZHRoID0gZmdfY2ZnLT5oc3luY193aWR0
aDsKKwlmZ190X2NmZy5oX2JhY2twb3JjaCA9IGZnX2NmZy0+aF9iYWNrcG9yY2g7CisJZmdfdF9j
ZmcuaF9mcm9udHBvcmNoID0gZmdfY2ZnLT5oX2Zyb250cG9yY2g7CisJZmdfdF9jZmcuaF9hY3Rp
dmUgPSB3YzsKKwlmZ190X2NmZy52c3luY193aWR0aCA9IGZnX2NmZy0+dnN5bmNfd2lkdGg7CisJ
ZmdfdF9jZmcudl9iYWNrcG9yY2ggPSBmZ19jZmctPnZfYmFja3BvcmNoOworCWZnX3RfY2ZnLnZf
ZnJvbnRwb3JjaCA9IGZnX2NmZy0+dl9mcm9udHBvcmNoOworCWZnX3RfY2ZnLnZfYWN0aXZlID0g
ZmdfbnVtX2xpbmVzOworCWZnX3RfY2ZnLmFjdGl2ZV9sYW5lcyA9IGFjdGl2ZV9sYW5lczsKKwor
CS8qIEFwcGx5IGZyYW1lIGdlbmVyYXRvciB0aW1pbmcgc2V0dGluZyAqLworCW1pcGlfdHhfZmdf
Y2ZnX3JlZ3Moa21iLCBmcmFtZV9nZW4sICZmZ190X2NmZyk7Cit9CisKK3N0YXRpYyB2b2lkIG1p
cGlfdHhfbXVsdGljaGFubmVsX2ZpZm9fY2ZnKHN0cnVjdCBrbWJfZHJtX3ByaXZhdGUgKmttYiwK
KwkJCQkJICB1OCBhY3RpdmVfbGFuZXMsIHU4IHZjaGFubmVsX2lkKQoreworCXUzMiBmaWZvX3Np
emUsIGZpZm9fcnRocmVzaG9sZDsKKwl1MzIgY3RybF9ubyA9IE1JUElfQ1RSTDY7CisKKwkvKiBD
bGVhciBhbGwgbWMgZmlmbyBjaGFubmVsIHNpemVzIGFuZCB0aHJlc2hvbGRzICovCisJa21iX3dy
aXRlX21pcGkoa21iLCBNSVBJX1RYX0hTX01DX0ZJRk9fQ1RSTF9FTiwgMCk7CisJa21iX3dyaXRl
X21pcGkoa21iLCBNSVBJX1RYX0hTX01DX0ZJRk9fQ0hBTl9BTExPQzAsIDApOworCWttYl93cml0
ZV9taXBpKGttYiwgTUlQSV9UWF9IU19NQ19GSUZPX0NIQU5fQUxMT0MxLCAwKTsKKwlrbWJfd3Jp
dGVfbWlwaShrbWIsIE1JUElfVFhfSFNfTUNfRklGT19SVEhSRVNIT0xEMCwgMCk7CisJa21iX3dy
aXRlX21pcGkoa21iLCBNSVBJX1RYX0hTX01DX0ZJRk9fUlRIUkVTSE9MRDEsIDApOworCisJZmlm
b19zaXplID0gKChhY3RpdmVfbGFuZXMgPiBNSVBJX0RfTEFORVNfUEVSX0RQSFkpID8KKwkJICAg
ICBNSVBJX0NUUkxfNExBTkVfTUFYX01DX0ZJRk9fTE9DIDoKKwkJICAgICBNSVBJX0NUUkxfMkxB
TkVfTUFYX01DX0ZJRk9fTE9DKSAtIDE7CisKKwkvKiBNQyBmaWZvIHNpemUgZm9yIHZpcnR1YWwg
Y2hhbm5lbHMgMC0zCisJICogUkVHX01DX0ZJRk9fQ0hBTl9BTExPQzA6IFs4OjBdLWNoYW5uZWww
LCBbMjQ6MTZdLWNoYW5uZWwxCisJICogUkVHX01DX0ZJRk9fQ0hBTl9BTExPQzE6IFs4OjBdLTIs
IFsyNDoxNl0tY2hhbm5lbDMKKwkgKi8KKwlTRVRfTUNfRklGT19DSEFOX0FMTE9DKGttYiwgY3Ry
bF9ubywgdmNoYW5uZWxfaWQsIGZpZm9fc2l6ZSk7CisKKwkvKiBTZXQgdGhyZXNob2xkIHRvIGhh
bGYgdGhlIGZpZm8gc2l6ZSwgYWN0dWFsIHNpemU9c2l6ZSoxNiAqLworCWZpZm9fcnRocmVzaG9s
ZCA9ICgoZmlmb19zaXplKSAqIDgpICYgQklUX01BU0tfMTY7CisJU0VUX01DX0ZJRk9fUlRIUkVT
SE9MRChrbWIsIGN0cmxfbm8sIHZjaGFubmVsX2lkLCBmaWZvX3J0aHJlc2hvbGQpOworCisJLyog
RW5hYmxlIHRoZSBNQyBGSUZPIGNoYW5uZWwgY29ycmVzcG9uZGluZyB0byB0aGUgVmlydHVhbCBD
aGFubmVsICovCisJa21iX3NldF9iaXRfbWlwaShrbWIsIE1JUElfVFhtX0hTX01DX0ZJRk9fQ1RS
TF9FTihjdHJsX25vKSwKKwkJCSB2Y2hhbm5lbF9pZCk7Cit9CisKK3N0YXRpYyB2b2lkIG1pcGlf
dHhfY3RybF9jZmcoc3RydWN0IGttYl9kcm1fcHJpdmF0ZSAqa21iLCB1OCBmZ19pZCwKKwkJCSAg
ICAgc3RydWN0IG1pcGlfY3RybF9jZmcgKmN0cmxfY2ZnKQoreworCXUzMiBzeW5jX2NmZyA9IDAs
IGN0cmwgPSAwLCBmZ19lbjsKKwl1MzIgY3RybF9ubyA9IE1JUElfQ1RSTDY7CisKKwkvKiBNSVBJ
X1RYX0hTX1NZTkNfQ0ZHICovCisJaWYgKGN0cmxfY2ZnLT50eF9jdHJsX2NmZy5saW5lX3N5bmNf
cGt0X2VuKQorCQlzeW5jX2NmZyB8PSBMSU5FX1NZTkNfUEtUX0VOQUJMRTsKKwlpZiAoY3RybF9j
ZmctPnR4X2N0cmxfY2ZnLmZyYW1lX2NvdW50ZXJfYWN0aXZlKQorCQlzeW5jX2NmZyB8PSBGUkFN
RV9DT1VOVEVSX0FDVElWRTsKKwlpZiAoY3RybF9jZmctPnR4X2N0cmxfY2ZnLmxpbmVfY291bnRl
cl9hY3RpdmUpCisJCXN5bmNfY2ZnIHw9IExJTkVfQ09VTlRFUl9BQ1RJVkU7CisJaWYgKGN0cmxf
Y2ZnLT50eF9jdHJsX2NmZy50eF9kc2lfY2ZnLT52X2JsYW5raW5nKQorCQlzeW5jX2NmZyB8PSBE
U0lfVl9CTEFOS0lORzsKKwlpZiAoY3RybF9jZmctPnR4X2N0cmxfY2ZnLnR4X2RzaV9jZmctPmhz
YV9ibGFua2luZykKKwkJc3luY19jZmcgfD0gRFNJX0hTQV9CTEFOS0lORzsKKwlpZiAoY3RybF9j
ZmctPnR4X2N0cmxfY2ZnLnR4X2RzaV9jZmctPmhicF9ibGFua2luZykKKwkJc3luY19jZmcgfD0g
RFNJX0hCUF9CTEFOS0lORzsKKwlpZiAoY3RybF9jZmctPnR4X2N0cmxfY2ZnLnR4X2RzaV9jZmct
PmhmcF9ibGFua2luZykKKwkJc3luY19jZmcgfD0gRFNJX0hGUF9CTEFOS0lORzsKKwlpZiAoY3Ry
bF9jZmctPnR4X2N0cmxfY2ZnLnR4X2RzaV9jZmctPnN5bmNfcHVsc2VfZXZlbnRuKQorCQlzeW5j
X2NmZyB8PSBEU0lfU1lOQ19QVUxTRV9FVkVOVE47CisJaWYgKGN0cmxfY2ZnLT50eF9jdHJsX2Nm
Zy50eF9kc2lfY2ZnLT5scG1fZmlyc3RfdnNhX2xpbmUpCisJCXN5bmNfY2ZnIHw9IERTSV9MUE1f
RklSU1RfVlNBX0xJTkU7CisJaWYgKGN0cmxfY2ZnLT50eF9jdHJsX2NmZy50eF9kc2lfY2ZnLT5s
cG1fbGFzdF92ZnBfbGluZSkKKwkJc3luY19jZmcgfD0gRFNJX0xQTV9MQVNUX1ZGUF9MSU5FOwor
CisJLyogRW5hYmxlIGZyYW1lIGdlbmVyYXRvciAqLworCWZnX2VuID0gMSA8PCBmZ19pZDsKKwlz
eW5jX2NmZyB8PSBGUkFNRV9HRU5fRU4oZmdfZW4pOworCisJaWYgKGN0cmxfY2ZnLT50eF9jdHJs
X2NmZy50eF9hbHdheXNfdXNlX2hhY3QpCisJCXN5bmNfY2ZnIHw9IEFMV0FZU19VU0VfSEFDVChm
Z19lbik7CisJaWYgKGN0cmxfY2ZnLT50eF9jdHJsX2NmZy50eF9oYWN0X3dhaXRfc3RvcCkKKwkJ
c3luY19jZmcgfD0gSEFDVF9XQUlUX1NUT1AoZmdfZW4pOworCisJZHJtX2RiZygma21iLT5kcm0s
ICJzeW5jX2NmZz0lZCBmZ19lbj0lZFxuIiwgc3luY19jZmcsIGZnX2VuKTsKKworCS8qIE1JUElf
VFhfSFNfQ1RSTCAqLworCisJLyogdHlwZTpEU0ksIHNvdXJjZTpMQ0QgKi8KKwljdHJsID0gSFNf
Q1RSTF9FTiB8IFRYX1NPVVJDRTsKKwljdHJsIHw9IExDRF9WQyhmZ19pZCk7CisJY3RybCB8PSBB
Q1RJVkVfTEFORVMoY3RybF9jZmctPmFjdGl2ZV9sYW5lcyAtIDEpOworCWlmIChjdHJsX2NmZy0+
dHhfY3RybF9jZmcudHhfZHNpX2NmZy0+ZW90cF9lbikKKwkJY3RybCB8PSBEU0lfRU9UUF9FTjsK
KwlpZiAoY3RybF9jZmctPnR4X2N0cmxfY2ZnLnR4X2RzaV9jZmctPmhmcF9ibGFua19lbikKKwkJ
Y3RybCB8PSBEU0lfQ01EX0hGUF9FTjsKKworCS8qNjcgbnMgc3RvcCB0aW1lICovCisJY3RybCB8
PSBIU0VYSVRfQ05UKDB4NDMpOworCisJa21iX3dyaXRlX21pcGkoa21iLCBNSVBJX1RYbV9IU19T
WU5DX0NGRyhjdHJsX25vKSwgc3luY19jZmcpOworCWttYl93cml0ZV9taXBpKGttYiwgTUlQSV9U
WG1fSFNfQ1RSTChjdHJsX25vKSwgY3RybCk7Cit9CisKK3N0YXRpYyB1MzIgbWlwaV90eF9pbml0
X2NudHJsKHN0cnVjdCBrbWJfZHJtX3ByaXZhdGUgKmttYiwKKwkJCSAgICAgIHN0cnVjdCBtaXBp
X2N0cmxfY2ZnICpjdHJsX2NmZykKK3sKKwl1MzIgcmV0ID0gMDsKKwl1OCBhY3RpdmVfdmNoYW5u
ZWxzID0gMDsKKwl1OCBmcmFtZV9pZCwgc2VjdDsKKwl1MzIgYml0c19wZXJfcGNsayA9IDA7CisJ
dTMyIHdvcmRfY291bnQgPSAwOworCXN0cnVjdCBtaXBpX3R4X2ZyYW1lX2NmZyAqZnJhbWU7CisK
KwkvKiBUaGlzIGlzIHRoZSBvcmRlciB0byBpbml0aWFsaXplIE1JUEkgVFg6CisJICogMS4gc2V0
IGZyYW1lIHNlY3Rpb24gcGFyYW1ldGVycworCSAqIDIuIHNldCBmcmFtZSBzcGVjaWZpYyBwYXJh
bWV0ZXJzCisJICogMy4gY29ubmVjdCBsY2QgdG8gbWlwaQorCSAqIDQuIG11bHRpIGNoYW5uZWwg
ZmlmbyBjZmcKKwkgKiA1LiBzZXQgbWlwaXR4Y2N0cmxjZmcKKwkgKi8KKworCWZvciAoZnJhbWVf
aWQgPSAwOyBmcmFtZV9pZCA8IDQ7IGZyYW1lX2lkKyspIHsKKwkJZnJhbWUgPSBjdHJsX2NmZy0+
dHhfY3RybF9jZmcuZnJhbWVzW2ZyYW1lX2lkXTsKKworCQkvKiBGaW5kIHZhbGlkIGZyYW1lLCBh
c3N1bWUgb25seSBvbmUgdmFsaWQgZnJhbWUgKi8KKwkJaWYgKCFmcmFtZSkKKwkJCWNvbnRpbnVl
OworCisJCS8qIEZyYW1lIFNlY3Rpb24gY29uZmlndXJhdGlvbiAqLworCQkvKiBUT0RPIC0gYXNz
dW1lIHRoZXJlIGlzIG9ubHkgb25lIHZhbGlkIHNlY3Rpb24gaW4gYSBmcmFtZSwKKwkJICogc28g
Yml0c19wZXJfcGNsayBhbmQgd29yZF9jb3VudCBhcmUgb25seSBzZXQgb25jZQorCQkgKi8KKwkJ
Zm9yIChzZWN0ID0gMDsgc2VjdCA8IE1JUElfQ1RSTF9WSVJUVUFMX0NIQU5ORUxTOyBzZWN0Kysp
IHsKKwkJCWlmICghZnJhbWUtPnNlY3Rpb25zW3NlY3RdKQorCQkJCWNvbnRpbnVlOworCisJCQly
ZXQgPSBtaXBpX3R4X2ZnX3NlY3Rpb25fY2ZnKGttYiwgZnJhbWVfaWQsIHNlY3QsCisJCQkJCQkg
ICAgIGZyYW1lLT5zZWN0aW9uc1tzZWN0XSwKKwkJCQkJCSAgICAgJmJpdHNfcGVyX3BjbGssCisJ
CQkJCQkgICAgICZ3b3JkX2NvdW50KTsKKwkJCWlmIChyZXQpCisJCQkJcmV0dXJuIHJldDsKKwkJ
fQorCisJCS8qIFNldCBmcmFtZSBzcGVjaWZpYyBwYXJhbWV0ZXJzICovCisJCW1pcGlfdHhfZmdf
Y2ZnKGttYiwgZnJhbWVfaWQsIGN0cmxfY2ZnLT5hY3RpdmVfbGFuZXMsCisJCQkgICAgICAgYml0
c19wZXJfcGNsaywgd29yZF9jb3VudCwKKwkJCSAgICAgICBjdHJsX2NmZy0+bGFuZV9yYXRlX21i
cHMsIGZyYW1lKTsKKworCQlhY3RpdmVfdmNoYW5uZWxzKys7CisKKwkJLyogU3RvcCBpdGVyYXRp
bmcgYXMgb25seSBvbmUgdmlydHVhbCBjaGFubmVsCisJCSAqIHNoYWxsIGJlIHVzZWQgZm9yIExD
RCBjb25uZWN0aW9uCisJCSAqLworCQlicmVhazsKKwl9CisKKwlpZiAoYWN0aXZlX3ZjaGFubmVs
cyA9PSAwKQorCQlyZXR1cm4gLUVJTlZBTDsKKwkvKiBNdWx0aS1DaGFubmVsIEZJRk8gQ29uZmln
dXJhdGlvbiAqLworCW1pcGlfdHhfbXVsdGljaGFubmVsX2ZpZm9fY2ZnKGttYiwgY3RybF9jZmct
PmFjdGl2ZV9sYW5lcywgZnJhbWVfaWQpOworCisJLyogRnJhbWUgR2VuZXJhdG9yIEVuYWJsZSAq
LworCW1pcGlfdHhfY3RybF9jZmcoa21iLCBmcmFtZV9pZCwgY3RybF9jZmcpOworCisJcmV0dXJu
IHJldDsKK30KKworc3RhdGljIHZvaWQgdGVzdF9tb2RlX3NlbmQoc3RydWN0IGttYl9kcm1fcHJp
dmF0ZSAqa21iLCB1MzIgZHBoeV9ubywKKwkJCSAgIHUzMiB0ZXN0X2NvZGUsIHUzMiB0ZXN0X2Rh
dGEpCit7CisJLyogU3RlcHMgdG8gc2VuZCB0ZXN0IGNvZGU6CisJICogLSBzZXQgdGVzdGNsayBI
SUdICisJICogLSBzZXQgdGVzdGRpbiB3aXRoIHRlc3QgY29kZQorCSAqIC0gc2V0IHRlc3RlbiBI
SUdICisJICogLSBzZXQgdGVzdGNsayBMT1cKKwkgKiAtIHNldCB0ZXN0ZW4gTE9XCisJICovCisK
KwkvKiBTZXQgdGVzdGNsayBoaWdoICovCisJU0VUX0RQSFlfVEVTVF9DVFJMMV9DTEsoa21iLCBk
cGh5X25vKTsKKworCS8qIFNldCB0ZXN0ZGluICovCisJU0VUX1RFU1RfRElOMF8zKGttYiwgZHBo
eV9ubywgdGVzdF9jb2RlKTsKKworCS8qIFNldCB0ZXN0ZW4gaGlnaCAqLworCVNFVF9EUEhZX1RF
U1RfQ1RSTDFfRU4oa21iLCBkcGh5X25vKTsKKworCS8qIFNldCB0ZXN0Y2xrIGxvdyAqLworCUNM
Ul9EUEhZX1RFU1RfQ1RSTDFfQ0xLKGttYiwgZHBoeV9ubyk7CisKKwkvKiBTZXQgdGVzdGVuIGxv
dyAqLworCUNMUl9EUEhZX1RFU1RfQ1RSTDFfRU4oa21iLCBkcGh5X25vKTsKKworCWlmICh0ZXN0
X2NvZGUpIHsKKwkJLyogIFN0ZXBzIHRvIHNlbmQgdGVzdCBkYXRhOgorCQkgKiAtIHNldCB0ZXN0
ZW4gTE9XCisJCSAqIC0gc2V0IHRlc3RjbGsgTE9XCisJCSAqIC0gc2V0IHRlc3RkaW4gd2l0aCBk
YXRhCisJCSAqIC0gc2V0IHRlc3RjbGsgSElHSAorCQkgKi8KKworCQkvKiBTZXQgdGVzdGVuIGxv
dyAqLworCQlDTFJfRFBIWV9URVNUX0NUUkwxX0VOKGttYiwgZHBoeV9ubyk7CisKKwkJLyogU2V0
IHRlc3RjbGsgbG93ICovCisJCUNMUl9EUEhZX1RFU1RfQ1RSTDFfQ0xLKGttYiwgZHBoeV9ubyk7
CisKKwkJLyogU2V0IGRhdGEgaW4gdGVzdGRpbiAqLworCQlrbWJfd3JpdGVfbWlwaShrbWIsCisJ
CQkgICAgICAgRFBIWV9URVNUX0RJTjBfMyArICgoZHBoeV9ubyAvIDB4NCkgKiAweDQpLAorCQkJ
ICAgICAgIHRlc3RfZGF0YSA8PCAoKGRwaHlfbm8gJSA0KSAqIDgpKTsKKworCQkvKiBTZXQgdGVz
dGNsayBoaWdoICovCisJCVNFVF9EUEhZX1RFU1RfQ1RSTDFfQ0xLKGttYiwgZHBoeV9ubyk7CisJ
fQorfQorCitzdGF0aWMgaW5saW5lIHZvaWQKKwlzZXRfdGVzdF9tb2RlX3NyY19vc2NfZnJlcV90
YXJnZXRfbG93X2JpdHMoc3RydWN0IGttYl9kcm1fcHJpdmF0ZSAqa21iLAorCQkJCQkJICAgdTMy
IGRwaHlfbm8sCisJCQkJCQkgICB1MzIgZnJlcSkKK3sKKwkvKiBUeXBpY2FsIHJpc2UvZmFsbCB0
aW1lPTE2NiwgcmVmZXIgVGFibGUgMTIwNyBkYXRhYm9vaywKKwkgKiBzcl9vc2NfZnJlcV90YXJn
ZXRbNzowXQorCSAqLworCXRlc3RfbW9kZV9zZW5kKGttYiwgZHBoeV9ubywgVEVTVF9DT0RFX1NM
RVdfUkFURV9ERExfQ1lDTEVTLAorCQkgICAgICAgKGZyZXEgJiAweDdmKSk7Cit9CisKK3N0YXRp
YyBpbmxpbmUgdm9pZAorCXNldF90ZXN0X21vZGVfc3JjX29zY19mcmVxX3RhcmdldF9oaV9iaXRz
KHN0cnVjdCBrbWJfZHJtX3ByaXZhdGUgKmttYiwKKwkJCQkJCSAgdTMyIGRwaHlfbm8sCisJCQkJ
CQkgIHUzMiBmcmVxKQoreworCXUzMiBkYXRhOworCisJLyogRmxhZyB0aGlzIGFzIGhpZ2ggbmli
YmxlICovCisJZGF0YSA9ICgoZnJlcSA+PiA2KSAmIDB4MWYpIHwgKDEgPDwgNyk7CisKKwkvKiBU
eXBpY2FsIHJpc2UvZmFsbCB0aW1lPTE2NiwgcmVmZXIgVGFibGUgMTIwNyBkYXRhYm9vaywKKwkg
KiBzcl9vc2NfZnJlcV90YXJnZXRbMTE6N10KKwkgKi8KKwl0ZXN0X21vZGVfc2VuZChrbWIsIGRw
aHlfbm8sIFRFU1RfQ09ERV9TTEVXX1JBVEVfRERMX0NZQ0xFUywgZGF0YSk7Cit9CisKK3N0YXRp
YyB2b2lkIG1pcGlfdHhfZ2V0X3Zjb19wYXJhbXMoc3RydWN0IHZjb19wYXJhbXMgKnZjbykKK3sK
KwlpbnQgaTsKKworCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKHZjb190YWJsZSk7IGkrKykg
eworCQlpZiAodmNvLT5mcmVxIDwgdmNvX3RhYmxlW2ldLmZyZXEpIHsKKwkJCSp2Y28gPSB2Y29f
dGFibGVbaV07CisJCQlyZXR1cm47CisJCX0KKwl9CisKKwlXQVJOX09OQ0UoMSwgIkludmFsaWQg
dmNvIGZyZXEgPSAldSBmb3IgUExMIHNldHVwXG4iLCB2Y28tPmZyZXEpOworfQorCitzdGF0aWMg
dm9pZCBtaXBpX3R4X3BsbF9zZXR1cChzdHJ1Y3Qga21iX2RybV9wcml2YXRlICprbWIsIHUzMiBk
cGh5X25vLAorCQkJICAgICAgdTMyIHJlZl9jbGtfbWh6LCB1MzIgdGFyZ2V0X2ZyZXFfbWh6KQor
eworCXUzMiBiZXN0X24gPSAwLCBiZXN0X20gPSAwOworCXUzMiBuID0gMCwgbSA9IDAsIGRpdiA9
IDAsIGRlbHRhLCBmcmVxID0gMCwgdF9mcmVxOworCXUzMiBiZXN0X2ZyZXFfZGVsdGEgPSAzMDAw
OworCisJLyogcGxsX3JlZl9jbGs6IC0gdmFsaWQgcmFuZ2U6IDJ+NjQgTUh6OyBUeXBpY2FsbHkg
MjQgTUh6CisJICogRnZjbzogLSB2YWxpZCByYW5nZTogMzIwfjEyNTAgTUh6IChHZW4zIEQtUEhZ
KQorCSAqIEZvdXQ6IC0gdmFsaWQgcmFuZ2U6IDQwfjEyNTAgTUh6IChHZW4zIEQtUEhZKQorCSAq
IG46IC0gdmFsaWQgcmFuZ2UgWzAgMTVdCisJICogTjogLSBOID0gbiArIDEKKwkgKiAgICAgIC12
YWxpZCByYW5nZTogWzEgMTZdCisJICogICAgICAtY29uZGl0aW9uczogLSAocGxsX3JlZl9jbGsg
LyBOKSA+PSAyIE1IegorCSAqICAgICAgICAgICAgICAtKHBsbF9yZWZfY2xrIC8gTikgPD0gOCBN
SHoKKwkgKiBtOiB2YWxpZCByYW5nZSBbNjIgNjIzXQorCSAqIE06IC0gTSA9IG0gKyAyCisJICog
ICAgICAtdmFsaWQgcmFuZ2UgWzY0IDYyNV0KKwkgKiAgICAgIC1GdmNvID0gKE0vTikgKiBwbGxf
cmVmX2NsaworCSAqLworCXN0cnVjdCB2Y29fcGFyYW1zIHZjb19wID0geworCQkucmFuZ2UgPSAw
LAorCQkuZGl2aWRlciA9IDEsCisJfTsKKworCXZjb19wLmZyZXEgPSB0YXJnZXRfZnJlcV9taHo7
CisJbWlwaV90eF9nZXRfdmNvX3BhcmFtcygmdmNvX3ApOworCisJLyogU2VhcmNoIHBsbCBuIHBh
cmFtZXRlciAqLworCWZvciAobiA9IFBMTF9OX01JTjsgbiA8PSBQTExfTl9NQVg7IG4rKykgewor
CQkvKiBDYWxjdWxhdGUgdGhlIHBsbCBpbnB1dCBmcmVxdWVuY3kgZGl2aXNpb24gcmF0aW8KKwkJ
ICogbXVsdGlwbHkgYnkgMTAwMCBmb3IgcHJlY2lzaW9uIC0KKwkJICogbm8gZmxvYXRpbmcgcG9p
bnQsIGFkZCBuIGZvciByb3VuZGluZworCQkgKi8KKwkJZGl2ID0gKChyZWZfY2xrX21oeiAqIDEw
MDApICsgbikgLyAobiArIDEpOworCisJCS8qIEZvdW5kIGEgdmFsaWQgbiBwYXJhbWV0ZXIgKi8K
KwkJaWYgKChkaXYgPCAyMDAwIHx8IGRpdiA+IDgwMDApKQorCQkJY29udGludWU7CisKKwkJLyog
U2VhcmNoIHBsbCBtIHBhcmFtZXRlciAqLworCQlmb3IgKG0gPSBQTExfTV9NSU47IG0gPD0gUExM
X01fTUFYOyBtKyspIHsKKwkJCS8qIENhbGN1bGF0ZSB0aGUgRnZjbyhEUEhZIFBMTCBvdXRwdXQg
ZnJlcXVlbmN5KQorCQkJICogdXNpbmcgdGhlIGN1cnJlbnQgbixtIHBhcmFtcworCQkJICovCisJ
CQlmcmVxID0gZGl2ICogKG0gKyAyKTsKKwkJCWZyZXEgLz0gMTAwMDsKKworCQkJLyogVHJpbSB0
aGUgcG90ZW50aWFsIHBsbCBmcmVxIHRvIG1heCBzdXBwb3J0ZWQgKi8KKwkJCWlmIChmcmVxID4g
UExMX0ZWQ09fTUFYKQorCQkJCWNvbnRpbnVlOworCisJCQlkZWx0YSA9IGFicyhmcmVxIC0gdGFy
Z2V0X2ZyZXFfbWh6KTsKKworCQkJLyogU2VsZWN0IHRoZSBiZXN0IChjbG9zZXN0IHRvIHRhcmdl
dCBwbGwgZnJlcSkKKwkJCSAqIG4sbSBwYXJhbWV0ZXJzIHNvIGZhcgorCQkJICovCisJCQlpZiAo
ZGVsdGEgPCBiZXN0X2ZyZXFfZGVsdGEpIHsKKwkJCQliZXN0X24gPSBuOworCQkJCWJlc3RfbSA9
IG07CisJCQkJYmVzdF9mcmVxX2RlbHRhID0gZGVsdGE7CisJCQl9CisJCX0KKwl9CisKKwkvKiBQ
cm9ncmFtIHZjb19jbnRybCBwYXJhbWV0ZXIKKwkgKiBQTExfVkNPX0NvbnRyb2xbNTowXSA9IHBs
bF92Y29fY250cmxfb3ZyLAorCSAqIFBMTF9WQ09fQ29udHJvbFs2XSAgID0gcGxsX3Zjb19jbnRy
bF9vdnJfZW4KKwkgKi8KKwl0ZXN0X21vZGVfc2VuZChrbWIsIGRwaHlfbm8sIFRFU1RfQ09ERV9Q
TExfVkNPX0NUUkwsICh2Y29fcC5yYW5nZQorCQkJCQkJCQl8ICgxIDw8IDYpKSk7CisKKwkvKiBQ
cm9ncmFtIG0sIG4gcGxsIHBhcmFtZXRlcnMgKi8KKwlkcm1fZGJnKCZrbWItPmRybSwgIm0gPSAl
ZCBuID0gJWRcbiIsIGJlc3RfbSwgYmVzdF9uKTsKKworCS8qIFBMTF9JbnB1dF9EaXZpZGVyX1Jh
dGlvWzM6MF0gPSBwbGxfbl9vdnIgKi8KKwl0ZXN0X21vZGVfc2VuZChrbWIsIGRwaHlfbm8sIFRF
U1RfQ09ERV9QTExfSU5QVVRfRElWSURFUiwKKwkJICAgICAgIChiZXN0X24gJiAweDBmKSk7CisK
KwkvKiBtIC0gbG93IG5pYmJsZSBQTExfTG9vcF9EaXZpZGVyX1JhdGlvWzQ6MF0KKwkgKiBwbGxf
bV9vdnJbNDowXQorCSAqLworCXRlc3RfbW9kZV9zZW5kKGttYiwgZHBoeV9ubywgVEVTVF9DT0RF
X1BMTF9GRUVEQkFDS19ESVZJREVSLAorCQkgICAgICAgKGJlc3RfbSAmIDB4MWYpKTsKKworCS8q
IG0gLSBoaWdoIG5pYmJsZSBQTExfTG9vcF9EaXZpZGVyX1JhdGlvWzQ6MF0KKwkgKiBwbGxfbV9v
dnJbOTo1XQorCSAqLworCXRlc3RfbW9kZV9zZW5kKGttYiwgZHBoeV9ubywgVEVTVF9DT0RFX1BM
TF9GRUVEQkFDS19ESVZJREVSLAorCQkgICAgICAgKChiZXN0X20gPj4gNSkgJiAweDFmKSB8IFBM
TF9GRUVEQkFDS19ESVZJREVSX0hJR0gpOworCisJLyogRW5hYmxlIG92ZXJ3cml0ZSBvZiBuLG0g
cGFyYW1ldGVycyA6cGxsX25fb3ZyX2VuLCBwbGxfbV9vdnJfZW4gKi8KKwl0ZXN0X21vZGVfc2Vu
ZChrbWIsIGRwaHlfbm8sIFRFU1RfQ09ERV9QTExfT1VUUFVUX0NMS19TRUwsCisJCSAgICAgICAo
UExMX05fT1ZSX0VOIHwgUExMX01fT1ZSX0VOKSk7CisKKwkvKiBQcm9ncmFtIENoYXJnZS1QdW1w
IHBhcmFtZXRlcnMgKi8KKworCS8qIHBsbF9wcm9wX2NudHJsLWZpeGVkIHZhbHVlcyBmb3IgcHJv
cF9jbnRybCBmcm9tIERQSFkgZG9jICovCisJdF9mcmVxID0gdGFyZ2V0X2ZyZXFfbWh6ICogdmNv
X3AuZGl2aWRlcjsKKwl0ZXN0X21vZGVfc2VuZChrbWIsIGRwaHlfbm8sCisJCSAgICAgICBURVNU
X0NPREVfUExMX1BST1BPUlRJT05BTF9DSEFSR0VfUFVNUF9DVFJMLAorCQkgICAgICAgKCh0X2Zy
ZXEgPiAxMTUwKSA/IDB4MEMgOiAweDBCKSk7CisKKwkvKiBwbGxfaW50X2NudHJsLWZpeGVkIHZh
bHVlIGZvciBpbnRfY250cmwgZnJvbSBEUEhZIGRvYyAqLworCXRlc3RfbW9kZV9zZW5kKGttYiwg
ZHBoeV9ubywgVEVTVF9DT0RFX1BMTF9JTlRFR1JBTF9DSEFSR0VfUFVNUF9DVFJMLAorCQkgICAg
ICAgMHgwMCk7CisKKwkvKiBwbGxfZ21wX2NudHJsLWZpeGVkIHZhbHVlIGZvciBnbXBfY250cmwg
ZnJvbSBEUEhZIGRvY2kgKi8KKwl0ZXN0X21vZGVfc2VuZChrbWIsIGRwaHlfbm8sIFRFU1RfQ09E
RV9QTExfR01QX0NUUkwsIDB4MTApOworCisJLyogcGxsX2NwYmlhc19jbnRybC1maXhlZCB2YWx1
ZSBmb3IgY3BiaWFzX2NudHJsIGZyb20gRFBIWSBkb2MgKi8KKwl0ZXN0X21vZGVfc2VuZChrbWIs
IGRwaHlfbm8sIFRFU1RfQ09ERV9QTExfQ0hBUkdFX1BVTVBfQklBUywgMHgxMCk7CisKKwkvKiBw
bGxfdGgxIC1Mb2NrIERldGVjdG9yIFBoYXNlIGVycm9yIHRocmVzaG9sZCwKKwkgKiBkb2N1bWVu
dCBnaXZlcyBmaXhlZCB2YWx1ZQorCSAqLworCXRlc3RfbW9kZV9zZW5kKGttYiwgZHBoeV9ubywg
VEVTVF9DT0RFX1BMTF9QSEFTRV9FUlJfQ1RSTCwgMHgwMik7CisKKwkvKiBQTEwgTG9jayBDb25m
aWd1cmF0aW9uICovCisKKwkvKiBwbGxfdGgyIC0gTG9jayBGaWx0ZXIgbGVuZ3RoLCBkb2N1bWVu
dCBnaXZlcyBmaXhlZCB2YWx1ZSAqLworCXRlc3RfbW9kZV9zZW5kKGttYiwgZHBoeV9ubywgVEVT
VF9DT0RFX1BMTF9MT0NLX0ZJTFRFUiwgMHg2MCk7CisKKwkvKiBwbGxfdGgzLSBQTEwgVW5sb2Nr
aW5nIGZpbHRlciwgZG9jdW1lbnQgZ2l2ZXMgZml4ZWQgdmFsdWUgKi8KKwl0ZXN0X21vZGVfc2Vu
ZChrbWIsIGRwaHlfbm8sIFRFU1RfQ09ERV9QTExfVU5MT0NLX0ZJTFRFUiwgMHgwMyk7CisKKwkv
KiBwbGxfbG9ja19zZWwtUExMIExvY2sgRGV0ZWN0b3IgU2VsZWN0aW9uLAorCSAqIGRvY3VtZW50
IGdpdmVzIGZpeGVkIHZhbHVlCisJICovCisJdGVzdF9tb2RlX3NlbmQoa21iLCBkcGh5X25vLCBU
RVNUX0NPREVfUExMX0xPQ0tfREVURUNUT1IsIDB4MDIpOworfQorCitzdGF0aWMgdm9pZCBzZXRf
c2xld3JhdGVfZ3RfMTUwMChzdHJ1Y3Qga21iX2RybV9wcml2YXRlICprbWIsIHUzMiBkcGh5X25v
KQoreworCXUzMiB0ZXN0X2NvZGUgPSAwLCB0ZXN0X2RhdGEgPSAwOworCS8qIEJ5cGFzcyBzbGV3
IHJhdGUgY2FsaWJyYXRpb24gYWxnb3JpdGhtCisJICogYml0c1sxOjB9IHNyY2FsX2VuX292cl9l
biwgc3JjYWxfZW5fb3ZyCisJICovCisJdGVzdF9jb2RlID0gVEVTVF9DT0RFX1NMRVdfUkFURV9P
VkVSUklERV9DVFJMOworCXRlc3RfZGF0YSA9IDB4MDI7CisJdGVzdF9tb2RlX3NlbmQoa21iLCBk
cGh5X25vLCB0ZXN0X2NvZGUsIHRlc3RfZGF0YSk7CisKKwkvKiBEaXNhYmxlIHNsZXcgcmF0ZSBj
YWxpYnJhdGlvbiAqLworCXRlc3RfY29kZSA9IFRFU1RfQ09ERV9TTEVXX1JBVEVfRERMX0xPT1Bf
Q1RSTDsKKwl0ZXN0X2RhdGEgPSAweDAwOworCXRlc3RfbW9kZV9zZW5kKGttYiwgZHBoeV9ubywg
dGVzdF9jb2RlLCB0ZXN0X2RhdGEpOworfQorCitzdGF0aWMgdm9pZCBzZXRfc2xld3JhdGVfZ3Rf
MTAwMChzdHJ1Y3Qga21iX2RybV9wcml2YXRlICprbWIsIHUzMiBkcGh5X25vKQoreworCXUzMiB0
ZXN0X2NvZGUgPSAwLCB0ZXN0X2RhdGEgPSAwOworCisJLyogQml0UmF0ZTogPiAxIEdicHMgJiYg
PD0gMS41IEdicHM6IC0gc2xldyByYXRlIGNvbnRyb2wgT04KKwkgKiB0eXBpY2FsIHJpc2UvZmFs
bCB0aW1lczogMTY2IHBzCisJICovCisKKwkvKiBEbyBub3QgYnlwYXNzIHNsZXcgcmF0ZSBjYWxp
YnJhdGlvbiBhbGdvcml0aG0KKwkgKiBiaXRzWzE6MH09c3JjYWxfZW5fb3ZyX2VuLCBzcmNhbF9l
bl9vdnIsIGJpdFs2XT1zcl9yYW5nZQorCSAqLworCXRlc3RfY29kZSA9IFRFU1RfQ09ERV9TTEVX
X1JBVEVfT1ZFUlJJREVfQ1RSTDsKKwl0ZXN0X2RhdGEgPSAoMHgwMyB8ICgxIDw8IDYpKTsKKwl0
ZXN0X21vZGVfc2VuZChrbWIsIGRwaHlfbm8sIHRlc3RfY29kZSwgdGVzdF9kYXRhKTsKKworCS8q
IEVuYWJsZSBzbGV3IHJhdGUgY2FsaWJyYXRpb24gKi8KKwl0ZXN0X2NvZGUgPSBURVNUX0NPREVf
U0xFV19SQVRFX0RETF9MT09QX0NUUkw7CisJdGVzdF9kYXRhID0gMHgwMTsKKwl0ZXN0X21vZGVf
c2VuZChrbWIsIGRwaHlfbm8sIHRlc3RfY29kZSwgdGVzdF9kYXRhKTsKKworCS8qIFNldCBzcl9v
c2NfZnJlcV90YXJnZXRbNjowXSBsb3cgbmliYmxlCisJICogdHlwaWNhbCByaXNlL2ZhbGwgdGlt
ZT0xNjYsIHJlZmVyIFRhYmxlIDEyMDcgZGF0YWJvb2sKKwkgKi8KKwl0ZXN0X2NvZGUgPSBURVNU
X0NPREVfU0xFV19SQVRFX0RETF9DWUNMRVM7CisJdGVzdF9kYXRhID0gKDB4NzJmICYgMHg3Zik7
CisJdGVzdF9tb2RlX3NlbmQoa21iLCBkcGh5X25vLCB0ZXN0X2NvZGUsIHRlc3RfZGF0YSk7CisK
KwkvKiBTZXQgc3Jfb3NjX2ZyZXFfdGFyZ2V0WzExOjddIGhpZ2ggbmliYmxlCisJICogVHlwaWNh
bCByaXNlL2ZhbGwgdGltZT0xNjYsIHJlZmVyIFRhYmxlIDEyMDcgZGF0YWJvb2sKKwkgKi8KKwl0
ZXN0X2NvZGUgPSBURVNUX0NPREVfU0xFV19SQVRFX0RETF9DWUNMRVM7CisJdGVzdF9kYXRhID0g
KCgweDcyZiA+PiA2KSAmIDB4MWYpIHwgKDEgPDwgNyk7CisJdGVzdF9tb2RlX3NlbmQoa21iLCBk
cGh5X25vLCB0ZXN0X2NvZGUsIHRlc3RfZGF0YSk7Cit9CisKK3N0YXRpYyB2b2lkIHNldF9zbGV3
cmF0ZV9sdF8xMDAwKHN0cnVjdCBrbWJfZHJtX3ByaXZhdGUgKmttYiwgdTMyIGRwaHlfbm8pCit7
CisJdTMyIHRlc3RfY29kZSA9IDAsIHRlc3RfZGF0YSA9IDA7CisKKwkvKiBsYW5lX3JhdGVfbWJw
cyA8PSAxMDAwIE1icHMKKwkgKiBCaXRSYXRlOiAgPD0gMSBHYnBzOgorCSAqIC0gc2xldyByYXRl
IGNvbnRyb2wgT04KKwkgKiAtIHR5cGljYWwgcmlzZS9mYWxsIHRpbWVzOiAyMjUgcHMKKwkgKi8K
KworCS8qIERvIG5vdCBieXBhc3Mgc2xldyByYXRlIGNhbGlicmF0aW9uIGFsZ29yaXRobSAqLwor
CXRlc3RfY29kZSA9IFRFU1RfQ09ERV9TTEVXX1JBVEVfT1ZFUlJJREVfQ1RSTDsKKwl0ZXN0X2Rh
dGEgPSAoMHgwMyB8ICgxIDw8IDYpKTsKKwl0ZXN0X21vZGVfc2VuZChrbWIsIGRwaHlfbm8sIHRl
c3RfY29kZSwgdGVzdF9kYXRhKTsKKworCS8qIEVuYWJsZSBzbGV3IHJhdGUgY2FsaWJyYXRpb24g
Ki8KKwl0ZXN0X2NvZGUgPSBURVNUX0NPREVfU0xFV19SQVRFX0RETF9MT09QX0NUUkw7CisJdGVz
dF9kYXRhID0gMHgwMTsKKwl0ZXN0X21vZGVfc2VuZChrbWIsIGRwaHlfbm8sIHRlc3RfY29kZSwg
dGVzdF9kYXRhKTsKKworCS8qIFR5cGljYWwgcmlzZS9mYWxsIHRpbWU9MjU1LCByZWZlciBUYWJs
ZSAxMjA3IGRhdGFib29rICovCisJdGVzdF9jb2RlID0gVEVTVF9DT0RFX1NMRVdfUkFURV9ERExf
Q1lDTEVTOworCXRlc3RfZGF0YSA9ICgweDUyMyAmIDB4N2YpOworCXRlc3RfbW9kZV9zZW5kKGtt
YiwgZHBoeV9ubywgdGVzdF9jb2RlLCB0ZXN0X2RhdGEpOworCisJLyogU2V0IHNyX29zY19mcmVx
X3RhcmdldFsxMTo3XSBoaWdoIG5pYmJsZSAqLworCXRlc3RfY29kZSA9IFRFU1RfQ09ERV9TTEVX
X1JBVEVfRERMX0NZQ0xFUzsKKwl0ZXN0X2RhdGEgPSAoKDB4NTIzID4+IDYpICYgMHgxZikgfCAo
MSA8PCA3KTsKKwl0ZXN0X21vZGVfc2VuZChrbWIsIGRwaHlfbm8sIHRlc3RfY29kZSwgdGVzdF9k
YXRhKTsKK30KKworc3RhdGljIHZvaWQgc2V0dXBfcGxsKHN0cnVjdCBrbWJfZHJtX3ByaXZhdGUg
KmttYiwgdTMyIGRwaHlfbm8sCisJCSAgICAgIHN0cnVjdCBtaXBpX2N0cmxfY2ZnICpjZmcpCit7
CisJdTMyIHRlc3RfY29kZSA9IDAsIHRlc3RfZGF0YSA9IDA7CisKKwkvKiBTZXQgUExMIHJlZ3Vs
YXRvciBpbiBieXBhc3MgKi8KKwl0ZXN0X2NvZGUgPSBURVNUX0NPREVfUExMX0FOQUxPR19QUk9H
OworCXRlc3RfZGF0YSA9IDB4MDE7CisJdGVzdF9tb2RlX3NlbmQoa21iLCBkcGh5X25vLCB0ZXN0
X2NvZGUsIHRlc3RfZGF0YSk7CisKKwkvKiBQTEwgUGFyYW1ldGVycyBTZXR1cCAqLworCW1pcGlf
dHhfcGxsX3NldHVwKGttYiwgZHBoeV9ubywgY2ZnLT5yZWZfY2xrX2toeiAvIDEwMDAsCisJCQkg
IGNmZy0+bGFuZV9yYXRlX21icHMgLyAyKTsKKworCS8qIFNldCBjbGtzZWwgKi8KKwlrbWJfd3Jp
dGVfYml0c19taXBpKGttYiwgRFBIWV9JTklUX0NUUkwxLCBQTExfQ0xLU0VMXzAsIDIsIDB4MDEp
OworCisJLyogU2V0IHBsbF9zaGFkb3dfY29udHJvbCAqLworCWttYl9zZXRfYml0X21pcGkoa21i
LCBEUEhZX0lOSVRfQ1RSTDEsIFBMTF9TSEFET1dfQ1RSTCk7Cit9CisKK3N0YXRpYyB2b2lkIHNl
dF9sYW5lX2RhdGFfcmF0ZShzdHJ1Y3Qga21iX2RybV9wcml2YXRlICprbWIsIHUzMiBkcGh5X25v
LAorCQkJICAgICAgIHN0cnVjdCBtaXBpX2N0cmxfY2ZnICpjZmcpCit7CisJdTMyIGksIHRlc3Rf
Y29kZSA9IDAsIHRlc3RfZGF0YSA9IDA7CisKKwlmb3IgKGkgPSAwOyBpIDwgTUlQSV9EUEhZX0RF
RkFVTFRfQklUX1JBVEVTOyBpKyspIHsKKwkJaWYgKG1pcGlfaHNfZnJlcV9yYW5nZVtpXS5kZWZh
dWx0X2JpdF9yYXRlX21icHMgPAorCQkgICAgY2ZnLT5sYW5lX3JhdGVfbWJwcykKKwkJCWNvbnRp
bnVlOworCisJCS8qIFNlbmQgdGhlIHRlc3QgY29kZSBhbmQgZGF0YSAqLworCQkvKiBiaXRbNjow
XSA9IGhzZnJlcXJhbmdlX292ciBiaXRbN10gPSBoc2ZyZXFyYW5nZV9vdnJfZW4gKi8KKwkJdGVz
dF9jb2RlID0gVEVTVF9DT0RFX0hTX0ZSRVFfUkFOR0VfQ0ZHOworCQl0ZXN0X2RhdGEgPSAobWlw
aV9oc19mcmVxX3JhbmdlW2ldLmhzZnJlcXJhbmdlX2NvZGUgJiAweDdmKSB8CisJCSAgICAoMSA8
PCA3KTsKKwkJdGVzdF9tb2RlX3NlbmQoa21iLCBkcGh5X25vLCB0ZXN0X2NvZGUsIHRlc3RfZGF0
YSk7CisJCWJyZWFrOworCX0KK30KKworc3RhdGljIHZvaWQgZHBoeV9pbml0X3NlcXVlbmNlKHN0
cnVjdCBrbWJfZHJtX3ByaXZhdGUgKmttYiwKKwkJCSAgICAgICBzdHJ1Y3QgbWlwaV9jdHJsX2Nm
ZyAqY2ZnLCB1MzIgZHBoeV9ubywKKwkJCSAgICAgICBpbnQgYWN0aXZlX2xhbmVzLCBlbnVtIGRw
aHlfbW9kZSBtb2RlKQoreworCXUzMiB0ZXN0X2NvZGUgPSAwLCB0ZXN0X2RhdGEgPSAwLCB2YWw7
CisKKwkvKiBTZXQgRC1QSFkgaW4gc2h1dGRvd24gbW9kZSAqLworCS8qIEFzc2VydCBSU1RaIHNp
Z25hbCAqLworCUNMUl9EUEhZX0lOSVRfQ1RSTDAoa21iLCBkcGh5X25vLCBSRVNFVFopOworCisJ
LyogQXNzZXJ0IFNIVVRET1dOWiBzaWduYWwgKi8KKwlDTFJfRFBIWV9JTklUX0NUUkwwKGttYiwg
ZHBoeV9ubywgU0hVVERPV05aKTsKKwl2YWwgPSBrbWJfcmVhZF9taXBpKGttYiwgRFBIWV9JTklU
X0NUUkwwKTsKKworCS8qIEluaXQgRC1QSFlfbgorCSAqIFB1bHNlIHRlc3RjbGVhciBzaWduYWwg
dG8gbWFrZSBzdXJlIHRoZSBkLXBoeSBjb25maWd1cmF0aW9uCisJICogc3RhcnRzIGZyb20gYSBj
bGVhbiBiYXNlCisJICovCisJQ0xSX0RQSFlfVEVTVF9DVFJMMChrbWIsIGRwaHlfbm8pOworCW5k
ZWxheSgxNSk7CisJU0VUX0RQSFlfVEVTVF9DVFJMMChrbWIsIGRwaHlfbm8pOworCW5kZWxheSgx
NSk7CisJQ0xSX0RQSFlfVEVTVF9DVFJMMChrbWIsIGRwaHlfbm8pOworCW5kZWxheSgxNSk7CisK
KwkvKiBTZXQgbWFzdGVybWFjcm8gYml0IC0gTWFzdGVyIG9yIHNsYXZlIG1vZGUgKi8KKwl0ZXN0
X2NvZGUgPSBURVNUX0NPREVfTVVMVElQTEVfUEhZX0NUUkw7CisKKwkvKiBEUEhZIGhhcyBpdHMg
b3duIGNsb2NrIGxhbmUgZW5hYmxlZCAobWFzdGVyKSAqLworCWlmIChtb2RlID09IE1JUElfRFBI
WV9NQVNURVIpCisJCXRlc3RfZGF0YSA9IDB4MDE7CisJZWxzZQorCQl0ZXN0X2RhdGEgPSAweDAw
OworCisJLyogU2VuZCB0aGUgdGVzdCBjb2RlIGFuZCBkYXRhICovCisJdGVzdF9tb2RlX3NlbmQo
a21iLCBkcGh5X25vLCB0ZXN0X2NvZGUsIHRlc3RfZGF0YSk7CisKKwkvKiBTZXQgdGhlIGxhbmUg
ZGF0YSByYXRlICovCisJc2V0X2xhbmVfZGF0YV9yYXRlKGttYiwgZHBoeV9ubywgY2ZnKTsKKwor
CS8qIEhpZ2gtU3BlZWQgVHggU2xldyBSYXRlIENhbGlicmF0aW9uCisJICogQml0UmF0ZTogPiAx
LjUgR2JwcyAmJiA8PSAyLjUgR2Jwczogc2xldyByYXRlIGNvbnRyb2wgT0ZGCisJICovCisJaWYg
KGNmZy0+bGFuZV9yYXRlX21icHMgPiAxNTAwKQorCQlzZXRfc2xld3JhdGVfZ3RfMTUwMChrbWIs
IGRwaHlfbm8pOworCWVsc2UgaWYgKGNmZy0+bGFuZV9yYXRlX21icHMgPiAxMDAwKQorCQlzZXRf
c2xld3JhdGVfZ3RfMTAwMChrbWIsIGRwaHlfbm8pOworCWVsc2UKKwkJc2V0X3NsZXdyYXRlX2x0
XzEwMDAoa21iLCBkcGh5X25vKTsKKworCS8qIFNldCBjZmdjbGtmcmVxcmFuZ2UgKi8KKwl2YWwg
PSAoKChjZmctPmNmZ19jbGtfa2h6IC8gMTAwMCkgLSAxNykgKiA0KSAmIDB4M2Y7CisJU0VUX0RQ
SFlfRlJFUV9DVFJMMF8zKGttYiwgZHBoeV9ubywgdmFsKTsKKworCS8qIEVuYWJsZSBjb25maWcg
Y2xrIGZvciB0aGUgY29ycmVzcG9uZGluZyBkLXBoeSAqLworCWttYl9zZXRfYml0X21pcGkoa21i
LCBEUEhZX0NGR19DTEtfRU4sIGRwaHlfbm8pOworCisJLyogUExMIHNldHVwICovCisJaWYgKG1v
ZGUgPT0gTUlQSV9EUEhZX01BU1RFUikKKwkJc2V0dXBfcGxsKGttYiwgZHBoeV9ubywgY2ZnKTsK
KworCS8qIFNlbmQgTk9STUFMIE9QRVJBVElPTiB0ZXN0IGNvZGUgKi8KKwl0ZXN0X2NvZGUgPSAw
eDA7CisJdGVzdF9kYXRhID0gMHgwOworCXRlc3RfbW9kZV9zZW5kKGttYiwgZHBoeV9ubywgdGVz
dF9jb2RlLCB0ZXN0X2RhdGEpOworCisJLyogQ29uZmlndXJlIEJBU0VESVIgZm9yIGRhdGEgbGFu
ZXMKKwkgKiBOT1RFOiBiYXNlZGlyIG9ubHkgYXBwbGllcyB0byBMQU5FXzAgb2YgZWFjaCBELVBI
WS4KKwkgKiBUaGUgb3RoZXIgbGFuZXMga2VlcCB0aGVpciBkaXJlY3Rpb24gYmFzZWQgb24gdGhl
IEQtUEhZIHR5cGUsCisJICogZWl0aGVyIFJ4IG9yIFR4LgorCSAqIGJpdHNbNTowXSAgLSBCYXNl
RGlyOiAxID0gUngKKwkgKiBiaXRzWzk6Nl0gLSBCYXNlRGlyOiAwID0gVHgKKwkgKi8KKwlrbWJf
d3JpdGVfYml0c19taXBpKGttYiwgRFBIWV9JTklUX0NUUkwyLCAwLCA5LCAweDAzZik7CisJbmRl
bGF5KDE1KTsKKworCS8qIEVuYWJsZSBDTE9DSyBMQU5FCisJICogQ2xvY2sgbGFuZSBzaG91bGQg
YmUgZW5hYmxlZCByZWdhcmRsZXNzIG9mIHRoZSBkaXJlY3Rpb24KKwkgKiBzZXQgZm9yIHRoZSBE
LVBIWSAoUngvVHgpCisJICovCisJa21iX3NldF9iaXRfbWlwaShrbWIsIERQSFlfSU5JVF9DVFJM
MiwgMTIgKyBkcGh5X25vKTsKKworCS8qIEVuYWJsZSBEQVRBIExBTkVTICovCisJa21iX3dyaXRl
X2JpdHNfbWlwaShrbWIsIERQSFlfRU5BQkxFLCBkcGh5X25vICogMiwgMiwKKwkJCSAgICAoKDEg
PDwgYWN0aXZlX2xhbmVzKSAtIDEpKTsKKworCW5kZWxheSgxNSk7CisKKwkvKiBUYWtlIEQtUEhZ
IG91dCBvZiBzaHV0ZG93biBtb2RlICovCisJLyogRGVhc3NlcnQgU0hVVERPV05aIHNpZ25hbCAq
LworCVNFVF9EUEhZX0lOSVRfQ1RSTDAoa21iLCBkcGh5X25vLCBTSFVURE9XTlopOworCW5kZWxh
eSgxNSk7CisKKwkvKiBEZWFzc2VydCBSU1RaIHNpZ25hbCAqLworCVNFVF9EUEhZX0lOSVRfQ1RS
TDAoa21iLCBkcGh5X25vLCBSRVNFVFopOworfQorCitzdGF0aWMgdm9pZCBkcGh5X3dhaXRfZnNt
KHN0cnVjdCBrbWJfZHJtX3ByaXZhdGUgKmttYiwgdTMyIGRwaHlfbm8sCisJCQkgIGVudW0gZHBo
eV90eF9mc20gZnNtX3N0YXRlKQoreworCWVudW0gZHBoeV90eF9mc20gdmFsID0gRFBIWV9UWF9Q
T1dFUkRXTjsKKwlpbnQgaSA9IDA7CisJaW50IHN0YXR1cyA9IDE7CisKKwlkbyB7CisJCXRlc3Rf
bW9kZV9zZW5kKGttYiwgZHBoeV9ubywgVEVTVF9DT0RFX0ZTTV9DT05UUk9MLCAweDgwKTsKKwor
CQl2YWwgPSBHRVRfVEVTVF9ET1VUNF83KGttYiwgZHBoeV9ubyk7CisJCWkrKzsKKwkJaWYgKGkg
PiBUSU1FT1VUKSB7CisJCQlzdGF0dXMgPSAwOworCQkJYnJlYWs7CisJCX0KKwl9IHdoaWxlICh2
YWwgIT0gZnNtX3N0YXRlKTsKKworCWRybV9kYmcoJmttYi0+ZHJtLCAiJXM6IGRwaHkgJWQgdmFs
ID0gJXgiLCBfX2Z1bmNfXywgZHBoeV9ubywgdmFsKTsKKwlkcm1fZGJnKCZrbWItPmRybSwgIiog
RFBIWSAlZCBXQUlUX0ZTTSAlcyAqIiwKKwkJZHBoeV9ubywgc3RhdHVzID8gIlNVQ0NFU1MiIDog
IkZBSUxFRCIpOworfQorCitzdGF0aWMgdm9pZCB3YWl0X2luaXRfZG9uZShzdHJ1Y3Qga21iX2Ry
bV9wcml2YXRlICprbWIsIHUzMiBkcGh5X25vLAorCQkJICAgdTMyIGFjdGl2ZV9sYW5lcykKK3sK
Kwl1MzIgc3RvcHN0YXRlZGF0YSA9IDA7CisJdTMyIGRhdGFfbGFuZXMgPSAoMSA8PCBhY3RpdmVf
bGFuZXMpIC0gMTsKKwlpbnQgaSA9IDAsIHZhbDsKKwlpbnQgc3RhdHVzID0gMTsKKworCWRvIHsK
KwkJdmFsID0ga21iX3JlYWRfbWlwaShrbWIsIE1JUElfRFBIWV9TVEFUNF83KTsKKwkJc3RvcHN0
YXRlZGF0YSA9IEdFVF9TVE9QU1RBVEVfREFUQShrbWIsIGRwaHlfbm8pICYgZGF0YV9sYW5lczsK
KworCQkvKiBUT0RPLW5lZWQgdG8gYWRkIGEgdGltZSBvdXQgYW5kIHJldHVybiBmYWlsdXJlICov
CisJCWkrKzsKKworCQlpZiAoaSA+IFRJTUVPVVQpIHsKKwkJCXN0YXR1cyA9IDA7CisJCQlkcm1f
ZGJnKCZrbWItPmRybSwKKwkJCQkiISBXQUlUX0lOSVRfRE9ORTogVElNSU5HIE9VVCEoZXJyX3N0
YXQ9JWQpIiwKKwkJCQlrbWJfcmVhZF9taXBpKGttYiwgTUlQSV9EUEhZX0VSUl9TVEFUNl83KSk7
CisJCQlicmVhazsKKwkJfQorCX0gd2hpbGUgKHN0b3BzdGF0ZWRhdGEgIT0gZGF0YV9sYW5lcyk7
CisKKwlkcm1fZGJnKCZrbWItPmRybSwgIiogRFBIWSAlZCBJTklUIC0gJXMgKiIsCisJCWRwaHlf
bm8sIHN0YXR1cyA/ICJTVUNDRVNTIiA6ICJGQUlMRUQiKTsKK30KKworc3RhdGljIHZvaWQgd2Fp
dF9wbGxfbG9jayhzdHJ1Y3Qga21iX2RybV9wcml2YXRlICprbWIsIHUzMiBkcGh5X25vKQorewor
CWludCBpID0gMDsKKwlpbnQgc3RhdHVzID0gMTsKKworCWRvIHsKKwkJLyogVE9ETy1uZWVkIHRv
IGFkZCBhIHRpbWUgb3V0IGFuZCByZXR1cm4gZmFpbHVyZSAqLworCQlpKys7CisJCWlmIChpID4g
VElNRU9VVCkgeworCQkJc3RhdHVzID0gMDsKKwkJCWRybV9kYmcoJmttYi0+ZHJtLCAiJXM6IHRp
bWluZyBvdXQiLCBfX2Z1bmNfXyk7CisJCQlicmVhazsKKwkJfQorCX0gd2hpbGUgKCFHRVRfUExM
X0xPQ0soa21iLCBkcGh5X25vKSk7CisKKwlkcm1fZGJnKCZrbWItPmRybSwgIiogUExMIExvY2tl
ZCBmb3IgRFBIWSAlZCAtICVzICoiLAorCQlkcGh5X25vLCBzdGF0dXMgPyAiU1VDQ0VTUyIgOiAi
RkFJTEVEIik7Cit9CisKK3N0YXRpYyB1MzIgbWlwaV90eF9pbml0X2RwaHkoc3RydWN0IGttYl9k
cm1fcHJpdmF0ZSAqa21iLAorCQkJICAgICBzdHJ1Y3QgbWlwaV9jdHJsX2NmZyAqY2ZnKQorewor
CXUzMiBkcGh5X25vID0gTUlQSV9EUEhZNjsKKworCS8qIE11bHRpcGxlIEQtUEhZcyBuZWVkZWQg
Ki8KKwlpZiAoY2ZnLT5hY3RpdmVfbGFuZXMgPiBNSVBJX0RQSFlfRF9MQU5FUykgeworCQkvKgor
CQkgKkluaXRpYWxpemF0aW9uIGZvciBUeCBhZ2dyZWdhdGlvbiBtb2RlIGlzIGRvbmUgYWNjb3Jk
aW5nIHRvCisJCSAqYS4gc3RhcnQgaW5pdCBQSFkxCisJCSAqYi4gcG9sbCBmb3IgUEhZMSBGU00g
c3RhdGUgTE9DSworCQkgKiAgIGIxLiByZWcgYWRkciAweDAzWzM6MF0gLSBzdGF0ZV9tYWluWzM6
MF0gPT0gNSAoTE9DSykKKwkJICpjLiBwb2xsIGZvciBQSFkxIGNhbGlicmF0aW9ucyBkb25lIDoK
KwkJICogICBjMS4gdGVybWluYXRpb24gY2FsaWJyYXRpb24gbG93ZXIgc2VjdGlvbjogYWRkciAw
eDIyWzVdCisJCSAqICAgLSByZXNjYWxfZG9uZQorCQkgKiAgIGMyLiBzbGV3cmF0ZSBjYWxpYnJh
dGlvbiAoaWYgZGF0YSByYXRlIDwgPSAxNTAwIE1icHMpOgorCQkgKiAgICAgYWRkciAweEE3WzM6
Ml0gLSBzcmNhbF9kb25lLCBzcl9maW5pc2hlZAorCQkgKmQuIHN0YXJ0IGluaXQgUEhZMAorCQkg
KmUuIHBvbGwgZm9yIFBIWTAgc3RvcHN0YXRlCisJCSAqZi4gcG9sbCBmb3IgUEhZMSBzdG9wc3Rh
dGUKKwkJICovCisJCS8qIFBIWSAjTisxICgnc2xhdmUnKSAqLworCisJCWRwaHlfaW5pdF9zZXF1
ZW5jZShrbWIsIGNmZywgZHBoeV9ubyArIDEsCisJCQkJICAgKGNmZy0+YWN0aXZlX2xhbmVzIC0g
TUlQSV9EUEhZX0RfTEFORVMpLAorCQkJCSAgIE1JUElfRFBIWV9TTEFWRSk7CisJCWRwaHlfd2Fp
dF9mc20oa21iLCBkcGh5X25vICsgMSwgRFBIWV9UWF9MT0NLKTsKKworCQkvKiBQSFkgI04gbWFz
dGVyICovCisJCWRwaHlfaW5pdF9zZXF1ZW5jZShrbWIsIGNmZywgZHBoeV9ubywgTUlQSV9EUEhZ
X0RfTEFORVMsCisJCQkJICAgTUlQSV9EUEhZX01BU1RFUik7CisKKwkJLyogV2FpdCBmb3IgRFBI
WSBpbml0IHRvIGNvbXBsZXRlICovCisJCXdhaXRfaW5pdF9kb25lKGttYiwgZHBoeV9ubywgTUlQ
SV9EUEhZX0RfTEFORVMpOworCQl3YWl0X2luaXRfZG9uZShrbWIsIGRwaHlfbm8gKyAxLAorCQkJ
ICAgICAgIGNmZy0+YWN0aXZlX2xhbmVzIC0gTUlQSV9EUEhZX0RfTEFORVMpOworCQl3YWl0X3Bs
bF9sb2NrKGttYiwgZHBoeV9ubyk7CisJCXdhaXRfcGxsX2xvY2soa21iLCBkcGh5X25vICsgMSk7
CisJCWRwaHlfd2FpdF9mc20oa21iLCBkcGh5X25vLCBEUEhZX1RYX0lETEUpOworCX0gZWxzZSB7
CQkvKiBTaW5nbGUgRFBIWSAqLworCQlkcGh5X2luaXRfc2VxdWVuY2Uoa21iLCBjZmcsIGRwaHlf
bm8sIGNmZy0+YWN0aXZlX2xhbmVzLAorCQkJCSAgIE1JUElfRFBIWV9NQVNURVIpOworCQlkcGh5
X3dhaXRfZnNtKGttYiwgZHBoeV9ubywgRFBIWV9UWF9JRExFKTsKKwkJd2FpdF9pbml0X2RvbmUo
a21iLCBkcGh5X25vLCBjZmctPmFjdGl2ZV9sYW5lcyk7CisJCXdhaXRfcGxsX2xvY2soa21iLCBk
cGh5X25vKTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgY29ubmVjdF9sY2Rf
dG9fbWlwaShzdHJ1Y3Qga21iX2RybV9wcml2YXRlICprbWIpCit7CisJLyogRElTQUJMRSBNSVBJ
LT5DSUYgQ09OTkVDVElPTiAqLworCWttYl93cml0ZV9tc3NjYW0oa21iLCBNU1NfTUlQSV9DSUZf
Q0ZHLCAwKTsKKworCS8qIEVOQUJMRSBMQ0QtPk1JUEkgQ09OTkVDVElPTiAqLworCWttYl93cml0
ZV9tc3NjYW0oa21iLCBNU1NfTENEX01JUElfQ0ZHLCAxKTsKKworCS8qIERJU0FCTEUgTENELT5D
SUYgTE9PUEJBQ0sgKi8KKwlrbWJfd3JpdGVfbXNzY2FtKGttYiwgTVNTX0xPT1BCQUNLX0NGRywg
MCk7Cit9CisKK2ludCBrbWJfZHNpX21vZGVfc2V0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHN0
cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlKQoreworCXN0cnVjdCBrbWJfZHJtX3ByaXZhdGUg
KmttYiA9IHRvX2ttYihkZXYpOworCXU2NCBkYXRhX3JhdGU7CisKKwltaXBpX3R4X2luaXRfY2Zn
LmFjdGl2ZV9sYW5lcyA9IE1JUElfVFhfQUNUSVZFX0xBTkVTOworCisJbWlwaV90eF9mcmFtZTBf
c2VjdF9jZmcud2lkdGhfcGl4ZWxzID0gbW9kZS0+Y3J0Y19oZGlzcGxheTsKKwltaXBpX3R4X2Zy
YW1lMF9zZWN0X2NmZy5oZWlnaHRfbGluZXMgPSBtb2RlLT5jcnRjX3ZkaXNwbGF5OworCW1pcGl0
eF9mcmFtZTBfY2ZnLnZzeW5jX3dpZHRoID0KKwkJbW9kZS0+Y3J0Y192c3luY19lbmQgLSBtb2Rl
LT5jcnRjX3ZzeW5jX3N0YXJ0OworCW1pcGl0eF9mcmFtZTBfY2ZnLnZfYmFja3BvcmNoID0KKwkJ
bW9kZS0+Y3J0Y192dG90YWwgLSBtb2RlLT5jcnRjX3ZzeW5jX2VuZDsKKwltaXBpdHhfZnJhbWUw
X2NmZy52X2Zyb250cG9yY2ggPQorCQltb2RlLT5jcnRjX3ZzeW5jX3N0YXJ0IC0gbW9kZS0+Y3J0
Y192ZGlzcGxheTsKKwltaXBpdHhfZnJhbWUwX2NmZy5oc3luY193aWR0aCA9CisJCW1vZGUtPmNy
dGNfaHN5bmNfZW5kIC0gbW9kZS0+Y3J0Y19oc3luY19zdGFydDsKKwltaXBpdHhfZnJhbWUwX2Nm
Zy5oX2JhY2twb3JjaCA9CisJCW1vZGUtPmNydGNfaHRvdGFsIC0gbW9kZS0+Y3J0Y19oc3luY19l
bmQ7CisJbWlwaXR4X2ZyYW1lMF9jZmcuaF9mcm9udHBvcmNoID0KKwkJbW9kZS0+Y3J0Y19oc3lu
Y19zdGFydCAtIG1vZGUtPmNydGNfaGRpc3BsYXk7CisKKwkvKiBMYW5lIHJhdGUgPSAodnRvdGFs
Kmh0b3RhbCpmcHMqYnBwKS80IC8gMTAwMDAwMAorCSAqIHRvIGNvbnZlcnQgdG8gTWJwcworCSAq
LworCWRhdGFfcmF0ZSA9ICgoKCh1MzIpbW9kZS0+Y3J0Y192dG90YWwgKgkodTMyKW1vZGUtPmNy
dGNfaHRvdGFsKSAqCisJCQkodTMyKShkcm1fbW9kZV92cmVmcmVzaChtb2RlKSkgKgorCQkJTUlQ
SV9UWF9CUFApIC8gbWlwaV90eF9pbml0X2NmZy5hY3RpdmVfbGFuZXMpIC8JMTAwMDAwMDsKKwor
CWRybV9kYmcoJmttYi0+ZHJtLCAiZGF0YV9yYXRlPSV1IGFjdGl2ZV9sYW5lcz0lZFxuIiwKKwkJ
KHUzMilkYXRhX3JhdGUsIG1pcGlfdHhfaW5pdF9jZmcuYWN0aXZlX2xhbmVzKTsKKworCS8qIFdo
ZW4gbGF0ZSByYXRlIDwgODAwLCBtb2Rlc2V0IGZhaWxzIHdpdGggNCBsYW5lcywKKwkgKiBzbyBz
d2l0Y2ggdG8gMiBsYW5lcworCSAqLworCWlmIChkYXRhX3JhdGUgPCA4MDApIHsKKwkJbWlwaV90
eF9pbml0X2NmZy5hY3RpdmVfbGFuZXMgPSAyOworCQltaXBpX3R4X2luaXRfY2ZnLmxhbmVfcmF0
ZV9tYnBzID0gZGF0YV9yYXRlICogMjsKKwl9IGVsc2UgeworCQltaXBpX3R4X2luaXRfY2ZnLmxh
bmVfcmF0ZV9tYnBzID0gZGF0YV9yYXRlOworCX0KKworCWttYl93cml0ZV9taXBpKGttYiwgRFBI
WV9FTkFCTEUsIDApOworCWttYl93cml0ZV9taXBpKGttYiwgRFBIWV9JTklUX0NUUkwwLCAwKTsK
KwlrbWJfd3JpdGVfbWlwaShrbWIsIERQSFlfSU5JVF9DVFJMMSwgMCk7CisJa21iX3dyaXRlX21p
cGkoa21iLCBEUEhZX0lOSVRfQ1RSTDIsIDApOworCisJLyogSW5pdGlhbGl6ZSBtaXBpIGNvbnRy
b2xsZXIgKi8KKwltaXBpX3R4X2luaXRfY250cmwoa21iLCAmbWlwaV90eF9pbml0X2NmZyk7CisK
KwkvKiBEcGh5IGluaXRpYWxpemF0aW9uICovCisJbWlwaV90eF9pbml0X2RwaHkoa21iLCAmbWlw
aV90eF9pbml0X2NmZyk7CisKKwljb25uZWN0X2xjZF90b19taXBpKGttYik7CisKKwlkcm1faW5m
bygma21iLT5kcm0sICJtaXBpIGh3X2luaXRpYWxpemVkIik7CisKKwlyZXR1cm4gMDsKK30KKwor
aW50IGttYl9kc2lfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBzdHJ1Y3QgZHJtX2JyaWRn
ZSAqYnJpZGdlKQoreworCXN0cnVjdCBrbWJfZHNpICprbWJfZHNpOworCXN0cnVjdCBkcm1fZW5j
b2RlciAqZW5jb2RlcjsKKwlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yOworCXN0cnVj
dCBrbWJfZHNpX2hvc3QgKmhvc3Q7CisJaW50IHJldCA9IDA7CisKKwlrbWJfZHNpID0ga3phbGxv
YyhzaXplb2YoKmttYl9kc2kpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWttYl9kc2kpIHsKKwkJRFJN
X0VSUk9SKCJmYWlsZWQgdG8gYWxsb2NhdGUga21iX2RzaVxuIik7CisJCXJldHVybiAtRU5PTUVN
OworCX0KKworCWhvc3QgPSBrbWJfZHNpX2hvc3RfaW5pdChkZXYsIGttYl9kc2kpOworCWlmICgh
aG9zdCkgeworCQlEUk1fRVJST1IoIkZhaWxlZCB0byBhbGxvY2F0ZSBob3N0XG4iKTsKKwkJa2Zy
ZWUoa21iX2RzaSk7CisJCXJldHVybiAtRU5PTUVNOworCX0KKworCWttYl9kc2ktPmRzaV9ob3N0
ID0gaG9zdDsKKwllbmNvZGVyID0gJmttYl9kc2ktPmJhc2U7CisJZW5jb2Rlci0+cG9zc2libGVf
Y3J0Y3MgPSAxOworCWVuY29kZXItPnBvc3NpYmxlX2Nsb25lcyA9IDA7CisKKwlkcm1fZW5jb2Rl
cl9pbml0KGRldiwgZW5jb2RlciwgJmttYl9kc2lfZnVuY3MsIERSTV9NT0RFX0VOQ09ERVJfRFNJ
LAorCQkJICJNSVBJLURTSSIpOworCisJLyogTGluayBkcm1fYnJpZGdlIHRvIGVuY29kZXIgKi8K
KwlyZXQgPSBkcm1fYnJpZGdlX2F0dGFjaChlbmNvZGVyLCBicmlkZ2UsIE5VTEwsCisJCQlEUk1f
QlJJREdFX0FUVEFDSF9OT19DT05ORUNUT1IpOworCWlmIChyZXQpIHsKKwkJRFJNX0VSUk9SKCJm
YWlsZWQgdG8gYXR0YWNoIGJyaWRnZSB0byBNSVBJXG4iKTsKKwkJZHJtX2VuY29kZXJfY2xlYW51
cChlbmNvZGVyKTsKKwkJcmV0dXJuIHJldDsKKwl9CisJZHJtX2luZm8oZGV2LCAiQnJpZGdlIGF0
dGFjaGVkIDogU1VDQ0VTUyIpOworCWNvbm5lY3RvciA9IGRybV9icmlkZ2VfY29ubmVjdG9yX2lu
aXQoZGV2LCBlbmNvZGVyKTsKKwlpZiAoSVNfRVJSKGNvbm5lY3RvcikpIHsKKwkJRFJNX0VSUk9S
KCJVbmFibGUgdG8gY3JlYXRlIGJyaWRnZSBjb25uZWN0b3IiKTsKKwkJZHJtX2VuY29kZXJfY2xl
YW51cChlbmNvZGVyKTsKKwkJcmV0dXJuIFBUUl9FUlIoY29ubmVjdG9yKTsKKwl9CisJZHJtX2Nv
bm5lY3Rvcl9hdHRhY2hfZW5jb2Rlcihjb25uZWN0b3IsIGVuY29kZXIpOworCisJcmV0dXJuIDA7
Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0va21iL2ttYl9kc2kuaCBiL2RyaXZlcnMv
Z3B1L2RybS9rbWIva21iX2RzaS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAu
LjM5OTY2NmIKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0va21iL2ttYl9kc2ku
aApAQCAtMCwwICsxLDM1MCBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAt
b25seQorICoKKyAqIENvcHlyaWdodCDCqSAyMDE5LTIwMjAgSW50ZWwgQ29ycG9yYXRpb24KKyAq
LworCisjaWZuZGVmIF9fS01CX0RTSV9IX18KKyNkZWZpbmUgX19LTUJfRFNJX0hfXworCisjaW5j
bHVkZSA8ZHJtL2RybV9jcnRjLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9taXBpX2RzaS5oPgorI2lu
Y2x1ZGUgPGRybS9kcm1fbW9kZXMuaD4KKyNpbmNsdWRlICJrbWJfZHJ2LmgiCisKKy8qIE1JUEkg
VFggQ0ZHKi8KKyNkZWZpbmUgTUlQSV9UWF9MQU5FX0RBVEFfUkFURV9NQlBTIDg5MQorI2RlZmlu
ZSBNSVBJX1RYX1JFRl9DTEtfS0haICAgICAgICAgMjQwMDAKKyNkZWZpbmUgTUlQSV9UWF9DRkdf
Q0xLX0tIWiAgICAgICAgIDI0MDAwCisjZGVmaW5lIE1JUElfVFhfQlBQCQkgICAgMjQKKworLyog
RFBIWSBUeCB0ZXN0IGNvZGVzKi8KKyNkZWZpbmUgVEVTVF9DT0RFX0ZTTV9DT05UUk9MCQkJCTB4
MDMKKyNkZWZpbmUgVEVTVF9DT0RFX01VTFRJUExFX1BIWV9DVFJMCQkJMHgwQworI2RlZmluZSBU
RVNUX0NPREVfUExMX1BST1BPUlRJT05BTF9DSEFSR0VfUFVNUF9DVFJMCTB4MEUKKyNkZWZpbmUg
VEVTVF9DT0RFX1BMTF9JTlRFR1JBTF9DSEFSR0VfUFVNUF9DVFJMCQkweDBGCisjZGVmaW5lIFRF
U1RfQ09ERV9QTExfVkNPX0NUUkwJCQkJMHgxMgorI2RlZmluZSBURVNUX0NPREVfUExMX0dNUF9D
VFJMCQkJCTB4MTMKKyNkZWZpbmUgVEVTVF9DT0RFX1BMTF9QSEFTRV9FUlJfQ1RSTAkJCTB4MTQK
KyNkZWZpbmUgVEVTVF9DT0RFX1BMTF9MT0NLX0ZJTFRFUgkJCTB4MTUKKyNkZWZpbmUgVEVTVF9D
T0RFX1BMTF9VTkxPQ0tfRklMVEVSCQkJMHgxNgorI2RlZmluZSBURVNUX0NPREVfUExMX0lOUFVU
X0RJVklERVIJCQkweDE3CisjZGVmaW5lIFRFU1RfQ09ERV9QTExfRkVFREJBQ0tfRElWSURFUgkJ
CTB4MTgKKyNkZWZpbmUgICBQTExfRkVFREJBQ0tfRElWSURFUl9ISUdICQkJQklUKDcpCisjZGVm
aW5lIFRFU1RfQ09ERV9QTExfT1VUUFVUX0NMS19TRUwJCQkweDE5CisjZGVmaW5lICAgUExMX05f
T1ZSX0VOCQkJCQlCSVQoNCkKKyNkZWZpbmUgICBQTExfTV9PVlJfRU4JCQkJCUJJVCg1KQorI2Rl
ZmluZSBURVNUX0NPREVfVk9EX0xFVkVMCQkJCTB4MjQKKyNkZWZpbmUgVEVTVF9DT0RFX1BMTF9D
SEFSR0VfUFVNUF9CSUFTCQkJMHgxQworI2RlZmluZSBURVNUX0NPREVfUExMX0xPQ0tfREVURUNU
T1IJCQkweDFECisjZGVmaW5lIFRFU1RfQ09ERV9IU19GUkVRX1JBTkdFX0NGRwkJCTB4NDQKKyNk
ZWZpbmUgVEVTVF9DT0RFX1BMTF9BTkFMT0dfUFJPRwkJCTB4MUYKKyNkZWZpbmUgVEVTVF9DT0RF
X1NMRVdfUkFURV9PVkVSUklERV9DVFJMCQkweEEwCisjZGVmaW5lIFRFU1RfQ09ERV9TTEVXX1JB
VEVfRERMX0xPT1BfQ1RSTAkJMHhBMworI2RlZmluZSBURVNUX0NPREVfU0xFV19SQVRFX0RETF9D
WUNMRVMJCQkweEE0CisKKy8qIERQSFkgcGFyYW1zICovCisjZGVmaW5lIFBMTF9OX01JTgkwCisj
ZGVmaW5lIFBMTF9OX01BWAkxNQorI2RlZmluZSBQTExfTV9NSU4JNjIKKyNkZWZpbmUgUExMX01f
TUFYCTYyMworI2RlZmluZSBQTExfRlZDT19NQVgJMTI1MAorCisjZGVmaW5lIFRJTUVPVVQJCTYw
MAorCisjZGVmaW5lIE1JUElfVFhfRlJBTUVfR0VOCQkJCTQKKyNkZWZpbmUgTUlQSV9UWF9GUkFN
RV9HRU5fU0VDVElPTlMJCQk0CisjZGVmaW5lIE1JUElfQ1RSTF9WSVJUVUFMX0NIQU5ORUxTCQkJ
NAorI2RlZmluZSBNSVBJX0RfTEFORVNfUEVSX0RQSFkJCQkJMgorI2RlZmluZSBNSVBJX0NUUkxf
MkxBTkVfTUFYX01DX0ZJRk9fTE9DCQkJMjU1CisjZGVmaW5lIE1JUElfQ1RSTF80TEFORV9NQVhf
TUNfRklGT19MT0MJCQk1MTEKKy8qIDIgRGF0YSBMYW5lcyBwZXIgRC1QSFkgKi8KKyNkZWZpbmUg
TUlQSV9EUEhZX0RfTEFORVMJCQkJMgorI2RlZmluZSBNSVBJX0RQSFlfREVGQVVMVF9CSVRfUkFU
RVMJCQk2MworCisjZGVmaW5lIHRvX2ttYl9jb25uZWN0b3IoeCkgY29udGFpbmVyX29mKHgsIHN0
cnVjdCBrbWJfY29ubmVjdG9yLCBiYXNlKQorI2RlZmluZSB0b19rbWJfaG9zdCh4KSBjb250YWlu
ZXJfb2YoeCwgc3RydWN0IGttYl9kc2lfaG9zdCwgYmFzZSkKKyNkZWZpbmUgdG9fa21iX2RzaSh4
KSBjb250YWluZXJfb2YoeCwgc3RydWN0IGttYl9kc2ksIGJhc2UpCisKK3N0cnVjdCBrbWJfY29u
bmVjdG9yOworc3RydWN0IGttYl9kc2lfaG9zdDsKKworc3RydWN0IGttYl9kc2kgeworCXN0cnVj
dCBkcm1fZW5jb2RlciBiYXNlOworCXN0cnVjdCBrbWJfZHNpX2hvc3QgKmRzaV9ob3N0OworCXN0
cnVjdCBkcm1fYnJpZGdlICpicmlkZ2U7Cit9OworCitzdHJ1Y3Qga21iX2RzaV9ob3N0IHsKKwlz
dHJ1Y3QgbWlwaV9kc2lfaG9zdCAqYmFzZTsKKwlzdHJ1Y3Qga21iX2RzaSAqa21iX2RzaTsKKwlz
dHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkZXZpY2U7Cit9OworCitzdHJ1Y3Qga21iX2Nvbm5lY3Rv
ciB7CisJc3RydWN0IGRybV9jb25uZWN0b3IgYmFzZTsKKwlzdHJ1Y3QgZHJtX2VuY29kZXIgKmVu
Y29kZXI7CisJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmZpeGVkX21vZGU7Cit9OworCisvKiBE
UEhZIFR4IHRlc3QgY29kZXMgKi8KKworZW51bSBtaXBpX2N0cmxfbnVtIHsKKwlNSVBJX0NUUkww
ID0gMCwKKwlNSVBJX0NUUkwxLAorCU1JUElfQ1RSTDIsCisJTUlQSV9DVFJMMywKKwlNSVBJX0NU
Ukw0LAorCU1JUElfQ1RSTDUsCisJTUlQSV9DVFJMNiwKKwlNSVBJX0NUUkw3LAorCU1JUElfQ1RS
TDgsCisJTUlQSV9DVFJMOSwKKwlNSVBJX0NUUkxfTkEKK307CisKK2VudW0gbWlwaV9kcGh5X251
bSB7CisJTUlQSV9EUEhZMCA9IDAsCisJTUlQSV9EUEhZMSwKKwlNSVBJX0RQSFkyLAorCU1JUElf
RFBIWTMsCisJTUlQSV9EUEhZNCwKKwlNSVBJX0RQSFk1LAorCU1JUElfRFBIWTYsCisJTUlQSV9E
UEhZNywKKwlNSVBJX0RQSFk4LAorCU1JUElfRFBIWTksCisJTUlQSV9EUEhZX05BCit9OworCitl
bnVtIG1pcGlfZGlyIHsKKwlNSVBJX1JYLAorCU1JUElfVFgKK307CisKK2VudW0gbWlwaV9jdHJs
X3R5cGUgeworCU1JUElfRFNJLAorCU1JUElfQ1NJCit9OworCitlbnVtIG1pcGlfZGF0YV9pZiB7
CisJTUlQSV9JRl9ETUEsCisJTUlQSV9JRl9QQVJBTExFTAorfTsKKworZW51bSBtaXBpX2RhdGFf
bW9kZSB7CisJTUlQSV9EQVRBX01PREUwLAorCU1JUElfREFUQV9NT0RFMSwKKwlNSVBJX0RBVEFf
TU9ERTIsCisJTUlQSV9EQVRBX01PREUzCit9OworCitlbnVtIG1pcGlfZHNpX3ZpZGVvX21vZGUg
eworCURTSV9WSURFT19NT0RFX05PX0JVUlNUX1BVTFNFLAorCURTSV9WSURFT19NT0RFX05PX0JV
UlNUX0VWRU5ULAorCURTSV9WSURFT19NT0RFX0JVUlNUCit9OworCitlbnVtIG1pcGlfZHNpX2Js
YW5raW5nX21vZGUgeworCVRSQU5TSVRJT05fVE9fTE9XX1BPV0VSLAorCVNFTkRfQkxBTktfUEFD
S0VUCit9OworCitlbnVtIG1pcGlfZHNpX2VvdHAgeworCURTSV9FT1RQX0RJU0FCTEVELAorCURT
SV9FT1RQX0VOQUJMRVMKK307CisKK2VudW0gbWlwaV9kc2lfZGF0YV90eXBlIHsKKwlEU0lfU1Bf
RFRfUkVTRVJWRURfMDAgPSAweDAwLAorCURTSV9TUF9EVF9WU1lOQ19TVEFSVCA9IDB4MDEsCisJ
RFNJX1NQX0RUX0NPTE9SX01PREVfT0ZGID0gMHgwMiwKKwlEU0lfU1BfRFRfR0VORVJJQ19TSE9S
VF9XUiA9IDB4MDMsCisJRFNJX1NQX0RUX0dFTkVSSUNfUkQgPSAweDA0LAorCURTSV9TUF9EVF9E
Q1NfU0hPUlRfV1IgPSAweDA1LAorCURTSV9TUF9EVF9EQ1NfUkQgPSAweDA2LAorCURTSV9TUF9E
VF9FT1RQID0gMHgwOCwKKwlEU0lfTFBfRFRfTlVMTCA9IDB4MDksCisJRFNJX0xQX0RUX1JFU0VS
VkVEXzBBID0gMHgwYSwKKwlEU0lfTFBfRFRfUkVTRVJWRURfMEIgPSAweDBiLAorCURTSV9MUF9E
VF9MUFBTX1lDQkNSNDIyXzIwQiA9IDB4MGMsCisJRFNJX0xQX0RUX1BQU19SR0IxMDEwMTBfMzBC
ID0gMHgwZCwKKwlEU0lfTFBfRFRfUFBTX1JHQjU2NV8xNkIgPSAweDBlLAorCURTSV9MUF9EVF9S
RVNFUlZFRF8wRiA9IDB4MGYsCisKKwlEU0lfU1BfRFRfUkVTRVJWRURfMTAgPSAweDEwLAorCURT
SV9TUF9EVF9WU1lOQ19FTkQgPSAweDExLAorCURTSV9TUF9EVF9DT0xPUl9NT0RFX09OID0gMHgx
MiwKKwlEU0lfU1BfRFRfR0VORVJJQ19TSE9SVF9XUl8xUEFSID0gMHgxMywKKwlEU0lfU1BfRFRf
R0VORVJJQ19SRF8xUEFSID0gMHgxNCwKKwlEU0lfU1BfRFRfRENTX1NIT1JUX1dSXzFQQVIgPSAw
eDE1LAorCURTSV9TUF9EVF9SRVNFUlZFRF8xNiA9IDB4MTYsCisJRFNJX1NQX0RUX1JFU0VSVkVE
XzE3ID0gMHgxNywKKwlEU0lfU1BfRFRfUkVTRVJWRURfMTggPSAweDE4LAorCURTSV9MUF9EVF9C
TEFOSyA9IDB4MTksCisJRFNJX0xQX0RUX1JFU0VSVkVEXzFBID0gMHgxYSwKKwlEU0lfTFBfRFRf
UkVTRVJWRURfMUIgPSAweDFiLAorCURTSV9MUF9EVF9QUFNfWUNCQ1I0MjJfMjRCID0gMHgxYywK
KwlEU0lfTFBfRFRfUFBTX1JHQjEyMTIxMl8zNkIgPSAweDFkLAorCURTSV9MUF9EVF9QUFNfUkdC
NjY2XzE4QiA9IDB4MWUsCisJRFNJX0xQX0RUX1JFU0VSVkVEXzFGID0gMHgxZiwKKworCURTSV9T
UF9EVF9SRVNFUlZFRF8yMCA9IDB4MjAsCisJRFNJX1NQX0RUX0hTWU5DX1NUQVJUID0gMHgyMSwK
KwlEU0lfU1BfRFRfU0hVVF9ET1dOX1BFUklQSF9DTUQgPSAweDIyLAorCURTSV9TUF9EVF9HRU5F
UklDX1NIT1JUX1dSXzJQQVIgPSAweDIzLAorCURTSV9TUF9EVF9HRU5FUklDX1JEXzJQQVIgPSAw
eDI0LAorCURTSV9TUF9EVF9SRVNFUlZFRF8yNSA9IDB4MjUsCisJRFNJX1NQX0RUX1JFU0VSVkVE
XzI2ID0gMHgyNiwKKwlEU0lfU1BfRFRfUkVTRVJWRURfMjcgPSAweDI3LAorCURTSV9TUF9EVF9S
RVNFUlZFRF8yOCA9IDB4MjgsCisJRFNJX0xQX0RUX0dFTkVSSUNfTE9OR19XUiA9IDB4MjksCisJ
RFNJX0xQX0RUX1JFU0VSVkVEXzJBID0gMHgyYSwKKwlEU0lfTFBfRFRfUkVTRVJWRURfMkIgPSAw
eDJiLAorCURTSV9MUF9EVF9QUFNfWUNCQ1I0MjJfMTZCID0gMHgyYywKKwlEU0lfTFBfRFRfUkVT
RVJWRURfMkQgPSAweDJkLAorCURTSV9MUF9EVF9MUFBTX1JHQjY2Nl8xOEIgPSAweDJlLAorCURT
SV9MUF9EVF9SRVNFUlZFRF8yRiA9IDB4MmYsCisKKwlEU0lfU1BfRFRfUkVTRVJWRURfMzAgPSAw
eDMwLAorCURTSV9TUF9EVF9IU1lOQ19FTkQgPSAweDMxLAorCURTSV9TUF9EVF9UVVJOX09OX1BF
UklQSF9DTUQgPSAweDMyLAorCURTSV9TUF9EVF9SRVNFUlZFRF8zMyA9IDB4MzMsCisJRFNJX1NQ
X0RUX1JFU0VSVkVEXzM0ID0gMHgzNCwKKwlEU0lfU1BfRFRfUkVTRVJWRURfMzUgPSAweDM1LAor
CURTSV9TUF9EVF9SRVNFUlZFRF8zNiA9IDB4MzYsCisJRFNJX1NQX0RUX1NFVF9NQVhfUkVUVVJO
X1BLVF9TSVpFID0gMHgzNywKKwlEU0lfU1BfRFRfUkVTRVJWRURfMzggPSAweDM4LAorCURTSV9M
UF9EVF9EU0NfTE9OR19XUiA9IDB4MzksCisJRFNJX0xQX0RUX1JFU0VSVkVEXzNBID0gMHgzYSwK
KwlEU0lfTFBfRFRfUkVTRVJWRURfM0IgPSAweDNiLAorCURTSV9MUF9EVF9SRVNFUlZFRF8zQyA9
IDB4M2MsCisJRFNJX0xQX0RUX1BQU19ZQ0JDUjQyMF8xMkIgPSAweDNkLAorCURTSV9MUF9EVF9Q
UFNfUkdCODg4XzI0QiA9IDB4M2UsCisJRFNJX0xQX0RUX1JFU0VSVkVEXzNGID0gMHgzZgorfTsK
KworZW51bSBtaXBpX3R4X2hzX3RwX3NlbCB7CisJTUlQSV9UWF9IU19UUF9XSE9MRV9GUkFNRV9D
T0xPUjAgPSAwLAorCU1JUElfVFhfSFNfVFBfV0hPTEVfRlJBTUVfQ09MT1IxLAorCU1JUElfVFhf
SFNfVFBfVl9TVFJJUEVTLAorCU1JUElfVFhfSFNfVFBfSF9TVFJJUEVTLAorfTsKKworZW51bSBk
cGh5X21vZGUgeworCU1JUElfRFBIWV9TTEFWRSA9IDAsCisJTUlQSV9EUEhZX01BU1RFUgorfTsK
KworZW51bSBkcGh5X3R4X2ZzbSB7CisJRFBIWV9UWF9QT1dFUkRXTiA9IDAsCisJRFBIWV9UWF9C
R1BPTiwKKwlEUEhZX1RYX1RFUk1DQUwsCisJRFBIWV9UWF9URVJNQ0FMVVAsCisJRFBIWV9UWF9P
RkZTRVRDQUwsCisJRFBIWV9UWF9MT0NLLAorCURQSFlfVFhfU1JDQUwsCisJRFBIWV9UWF9JRExF
LAorCURQSFlfVFhfVUxQLAorCURQSFlfVFhfTEFORVNUQVJULAorCURQSFlfVFhfQ0xLQUxJR04s
CisJRFBIWV9UWF9ERExUVU5OSU5HLAorCURQSFlfVFhfVUxQX0ZPUkNFX1BMTCwKKwlEUEhZX1RY
X0xPQ0tfTE9TUworfTsKKworc3RydWN0IG1pcGlfZGF0YV90eXBlX3BhcmFtcyB7CisJdTggc2l6
ZV9jb25zdHJhaW50X3BpeGVsczsKKwl1OCBzaXplX2NvbnN0cmFpbnRfYnl0ZXM7CisJdTggcGl4
ZWxzX3Blcl9wY2xrOworCXU4IGJpdHNfcGVyX3BjbGs7Cit9OworCitzdHJ1Y3QgbWlwaV90eF9k
c2lfY2ZnIHsKKwl1OCBoZnBfYmxhbmtfZW47CS8qaG9yaXpvbnRhbCBmcm9udCBwb3JjaCBibGFu
a2luZyBlbmFibGUgKi8KKwl1OCBlb3RwX2VuOwkvKkVuZCBvZiB0cmFuc21pc3Npb24gcGFja2V0
IGVuYWJsZSAqLworCS8qbGFzdCB2ZXJ0aWNhbCBmcm9udCBwb3JjaCBibGFua2luZyBtb2RlICov
CisJdTggbHBtX2xhc3RfdmZwX2xpbmU7CisJLypmaXJzdCB2ZXJ0aWNhbCBzeW5jIGFjdGl2ZSBi
bGFua2luZyBtb2RlICovCisJdTggbHBtX2ZpcnN0X3ZzYV9saW5lOworCXU4IHN5bmNfcHVsc2Vf
ZXZlbnRuOwkvKnN5bmMgdHlwZSAqLworCXU4IGhmcF9ibGFua2luZzsJLypob3Jpem9udGFsIGZy
b250IHBvcmNoIGJsYW5raW5nIG1vZGUgKi8KKwl1OCBoYnBfYmxhbmtpbmc7CS8qaG9yaXpvbnRh
bCBiYWNrIHBvcmNoIGJsYW5raW5nIG1vZGUgKi8KKwl1OCBoc2FfYmxhbmtpbmc7CS8qaG9yaXpv
bnRhbCBzeW5jIGFjdGl2ZSBibGFua2luZyBtb2RlICovCisJdTggdl9ibGFua2luZzsJLyp2ZXJ0
aWNhbCB0aW1pbmcgYmxhbmtpbmcgbW9kZSAqLworfTsKKworc3RydWN0IG1pcGlfdHhfZnJhbWVf
c2VjdGlvbl9jZmcgeworCXUzMiBkbWFfdl9zdHJpZGU7CisJdTE2IGRtYV92X3NjYWxlX2NmZzsK
Kwl1MTYgd2lkdGhfcGl4ZWxzOworCXUxNiBoZWlnaHRfbGluZXM7CisJdTggZG1hX3BhY2tlZDsK
Kwl1OCBicHA7CisJdTggYnBwX3VucGFja2VkOworCXU4IGRtYV9oX3N0cmlkZTsKKwl1OCBkYXRh
X3R5cGU7CisJdTggZGF0YV9tb2RlOworCXU4IGRtYV9mbGlwX3JvdGF0ZV9zZWw7Cit9OworCitz
dHJ1Y3QgbWlwaV90eF9mcmFtZV90aW1pbmdfY2ZnIHsKKwl1MzIgYnBwOworCXUzMiBsYW5lX3Jh
dGVfbWJwczsKKwl1MzIgaHN5bmNfd2lkdGg7CisJdTMyIGhfYmFja3BvcmNoOworCXUzMiBoX2Zy
b250cG9yY2g7CisJdTMyIGhfYWN0aXZlOworCXUxNiB2c3luY193aWR0aDsKKwl1MTYgdl9iYWNr
cG9yY2g7CisJdTE2IHZfZnJvbnRwb3JjaDsKKwl1MTYgdl9hY3RpdmU7CisJdTggYWN0aXZlX2xh
bmVzOworfTsKKworc3RydWN0IG1pcGlfdHhfZnJhbWVfc2VjdF9waGNmZyB7CisJdTMyIHdjOwor
CWVudW0gbWlwaV9kYXRhX21vZGUgZGF0YV9tb2RlOworCWVudW0gbWlwaV9kc2lfZGF0YV90eXBl
IGRhdGFfdHlwZTsKKwl1OCB2Y2hhbm5lbDsKKwl1OCBkbWFfcGFja2VkOworfTsKKworc3RydWN0
IG1pcGlfdHhfZnJhbWVfY2ZnIHsKKwlzdHJ1Y3QgbWlwaV90eF9mcmFtZV9zZWN0aW9uX2NmZyAq
c2VjdGlvbnNbTUlQSV9UWF9GUkFNRV9HRU5fU0VDVElPTlNdOworCXUzMiBoc3luY193aWR0aDsJ
LyppbiBwaXhlbHMgKi8KKwl1MzIgaF9iYWNrcG9yY2g7CS8qaW4gcGl4ZWxzICovCisJdTMyIGhf
ZnJvbnRwb3JjaDsJLyppbiBwaXhlbHMgKi8KKwl1MTYgdnN5bmNfd2lkdGg7CS8qaW4gbGluZXMg
Ki8KKwl1MTYgdl9iYWNrcG9yY2g7CS8qaW4gbGluZXMgKi8KKwl1MTYgdl9mcm9udHBvcmNoOwkv
KmluIGxpbmVzICovCit9OworCitzdHJ1Y3QgbWlwaV90eF9jdHJsX2NmZyB7CisJc3RydWN0IG1p
cGlfdHhfZnJhbWVfY2ZnICpmcmFtZXNbTUlQSV9UWF9GUkFNRV9HRU5dOworCXN0cnVjdCBtaXBp
X3R4X2RzaV9jZmcgKnR4X2RzaV9jZmc7CisJdTggbGluZV9zeW5jX3BrdF9lbjsKKwl1OCBsaW5l
X2NvdW50ZXJfYWN0aXZlOworCXU4IGZyYW1lX2NvdW50ZXJfYWN0aXZlOworCXU4IHR4X2hzY2xr
a2lkbGVfY250OworCXU4IHR4X2hzZXhpdF9jbnQ7CisJdTggdHhfY3JjX2VuOworCXU4IHR4X2hh
Y3Rfd2FpdF9zdG9wOworCXU4IHR4X2Fsd2F5c191c2VfaGFjdDsKKwl1OCB0eF93YWl0X3RyaWc7
CisJdTggdHhfd2FpdF9hbGxfc2VjdDsKK307CisKKy8qY29uZmlndXJhdGlvbiBzdHJ1Y3R1cmUg
Zm9yIE1JUEkgY29udHJvbCAqLworc3RydWN0IG1pcGlfY3RybF9jZmcgeworCXU4IGFjdGl2ZV9s
YW5lczsJLyogIyBhY3RpdmUgbGFuZXMgcGVyIGNvbnRyb2xsZXIgMi80ICovCisJdTMyIGxhbmVf
cmF0ZV9tYnBzOwkvKk1CUFMgKi8KKwl1MzIgcmVmX2Nsa19raHo7CisJdTMyIGNmZ19jbGtfa2h6
OworCXN0cnVjdCBtaXBpX3R4X2N0cmxfY2ZnIHR4X2N0cmxfY2ZnOworfTsKKworc3RydWN0IGRy
bV9icmlkZ2UgKmttYl9kc2lfaG9zdF9icmlkZ2VfaW5pdChzdHJ1Y3QgZGV2aWNlICpkZXYpOwor
aW50IGttYl9kc2lfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBzdHJ1Y3QgZHJtX2JyaWRn
ZSAqYnJpZGdlKTsKK3ZvaWQga21iX2RzaV9ob3N0X3VucmVnaXN0ZXIodm9pZCk7CitpbnQga21i
X2RzaV9tb2RlX3NldChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBzdHJ1Y3QgZHJtX2Rpc3BsYXlf
bW9kZSAqbW9kZSk7CisjZW5kaWYgLyogX19LTUJfRFNJX0hfXyAqLwotLSAKMi43LjQKCl9fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWls
aW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZy
ZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbAo=
