Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 89572109F7E
	for <lists+dri-devel@lfdr.de>; Tue, 26 Nov 2019 14:47:43 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CD6F76E3FE;
	Tue, 26 Nov 2019 13:47:40 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 268996E3EC
 for <dri-devel@lists.freedesktop.org>; Tue, 26 Nov 2019 13:47:13 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id BBF12B275;
 Tue, 26 Nov 2019 13:47:10 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: airlied@redhat.com, daniel@ffwll.ch, sam@ravnborg.org, kraxel@redhat.com,
 emil.velikov@collabora.com, noralf@tronnes.org, zboszor@pr.hu
Subject: [PATCH 5/7] drm/udl: Convert to drm_atomic_helper_dirtyfb()
Date: Tue, 26 Nov 2019 14:47:05 +0100
Message-Id: <20191126134707.22385-6-tzimmermann@suse.de>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191126134707.22385-1-tzimmermann@suse.de>
References: <20191126134707.22385-1-tzimmermann@suse.de>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Zimmermann <tzimmermann@suse.de>, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIGluZnJhc3RydXR1cmUgZm9yIGF0b21pYyBtb2Rlc2V0dGluZyBhbGxvd3MgdXMgdG8gdXNl
IHRoZSBnZW5lcmljCmNvZGUgZm9yIGRpcnR5LUZCIGFuZCBkYW1hZ2UgaGFuZGxpbmcuIFN3aXRj
aCBvdmVyIHVkbCBhbmQgcmVtb3ZlIHRoZQpkcml2ZXIncyBpbXBsZW1lbnRhdGlvbi4KClNpZ25l
ZC1vZmYtYnk6IFRob21hcyBaaW1tZXJtYW5uIDx0emltbWVybWFubkBzdXNlLmRlPgotLS0KIGRy
aXZlcnMvZ3B1L2RybS91ZGwvdWRsX2Rydi5oICAgICB8ICA1IC0tLQogZHJpdmVycy9ncHUvZHJt
L3VkbC91ZGxfZmIuYyAgICAgIHwgNjcgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQog
ZHJpdmVycy9ncHUvZHJtL3VkbC91ZGxfbW9kZXNldC5jIHwgMTEgKysrLS0KIDMgZmlsZXMgY2hh
bmdlZCwgOCBpbnNlcnRpb25zKCspLCA3NSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vdWRsL3VkbF9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS91ZGwvdWRsX2Rydi5o
CmluZGV4IDc3YjU3ZDZhYmQyMy4uYzZmZDVjMDhmNWZjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vdWRsL3VkbF9kcnYuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vdWRsL3VkbF9kcnYuaApA
QCAtODksMTEgKzg5LDYgQEAgdm9pZCB1ZGxfdXJiX2NvbXBsZXRpb24oc3RydWN0IHVyYiAqdXJi
KTsKIGludCB1ZGxfaW5pdChzdHJ1Y3QgdWRsX2RldmljZSAqdWRsKTsKIHZvaWQgdWRsX2Zpbmko
c3RydWN0IGRybV9kZXZpY2UgKmRldik7CiAKLXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKgotdWRs
X2ZiX3VzZXJfZmJfY3JlYXRlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCi0JCSAgICAgIHN0cnVj
dCBkcm1fZmlsZSAqZmlsZSwKLQkJICAgICAgY29uc3Qgc3RydWN0IGRybV9tb2RlX2ZiX2NtZDIg
Km1vZGVfY21kKTsKLQogaW50IHVkbF9yZW5kZXJfaGxpbmUoc3RydWN0IGRybV9kZXZpY2UgKmRl
diwgaW50IGxvZ19icHAsIHN0cnVjdCB1cmIgKip1cmJfcHRyLAogCQkgICAgIGNvbnN0IGNoYXIg
KmZyb250LCBjaGFyICoqdXJiX2J1Zl9wdHIsCiAJCSAgICAgdTMyIGJ5dGVfb2Zmc2V0LCB1MzIg
ZGV2aWNlX2J5dGVfb2Zmc2V0LCB1MzIgYnl0ZV93aWR0aCwKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS91ZGwvdWRsX2ZiLmMgYi9kcml2ZXJzL2dwdS9kcm0vdWRsL3VkbF9mYi5jCmluZGV4
IGMxOTk2YWM3M2ExZi4uZWQwMWViYWFmNDY4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
dWRsL3VkbF9mYi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS91ZGwvdWRsX2ZiLmMKQEAgLTksMTQg
KzksOSBAQAogICovCiAKICNpbmNsdWRlIDxsaW51eC9tb2R1bGVwYXJhbS5oPgotI2luY2x1ZGUg
PGxpbnV4L2RtYS1idWYuaD4KIAotI2luY2x1ZGUgPGRybS9kcm1fY3J0Y19oZWxwZXIuaD4KLSNp
bmNsdWRlIDxkcm0vZHJtX2Rydi5oPgogI2luY2x1ZGUgPGRybS9kcm1fZm91cmNjLmg+Ci0jaW5j
bHVkZSA8ZHJtL2RybV9nZW1fZnJhbWVidWZmZXJfaGVscGVyLmg+CiAjaW5jbHVkZSA8ZHJtL2Ry
bV9nZW1fc2htZW1faGVscGVyLmg+Ci0jaW5jbHVkZSA8ZHJtL2RybV9tb2Rlc2V0X2hlbHBlci5o
PgogCiAjaW5jbHVkZSAidWRsX2Rydi5oIgogCkBAIC0xNTIsNjUgKzE0NywzIEBAIGludCB1ZGxf
aGFuZGxlX2RhbWFnZShzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwgaW50IHgsIGludCB5LAog
CWRybV9nZW1fc2htZW1fdnVubWFwKGZiLT5vYmpbMF0sIHZhZGRyKTsKIAlyZXR1cm4gcmV0Owog
fQotCi1zdGF0aWMgaW50IHVkbF91c2VyX2ZyYW1lYnVmZmVyX2RpcnR5KHN0cnVjdCBkcm1fZnJh
bWVidWZmZXIgKmZiLAotCQkJCSAgICAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSwKLQkJCQkgICAg
ICB1bnNpZ25lZCBmbGFncywgdW5zaWduZWQgY29sb3IsCi0JCQkJICAgICAgc3RydWN0IGRybV9j
bGlwX3JlY3QgKmNsaXBzLAotCQkJCSAgICAgIHVuc2lnbmVkIG51bV9jbGlwcykKLXsKLQlzdHJ1
Y3QgdWRsX2RldmljZSAqdWRsID0gZmItPmRldi0+ZGV2X3ByaXZhdGU7Ci0Jc3RydWN0IGRtYV9i
dWZfYXR0YWNobWVudCAqaW1wb3J0X2F0dGFjaDsKLQlpbnQgaTsKLQlpbnQgcmV0ID0gMDsKLQot
CWRybV9tb2Rlc2V0X2xvY2tfYWxsKGZiLT5kZXYpOwotCi0Jc3Bpbl9sb2NrKCZ1ZGwtPmFjdGl2
ZV9mYl8xNl9sb2NrKTsKLQlpZiAodWRsLT5hY3RpdmVfZmJfMTYgIT0gZmIpIHsKLQkJc3Bpbl91
bmxvY2soJnVkbC0+YWN0aXZlX2ZiXzE2X2xvY2spOwotCQlnb3RvIHVubG9jazsKLQl9Ci0Jc3Bp
bl91bmxvY2soJnVkbC0+YWN0aXZlX2ZiXzE2X2xvY2spOwotCi0JaW1wb3J0X2F0dGFjaCA9IGZi
LT5vYmpbMF0tPmltcG9ydF9hdHRhY2g7Ci0KLQlpZiAoaW1wb3J0X2F0dGFjaCkgewotCQlyZXQg
PSBkbWFfYnVmX2JlZ2luX2NwdV9hY2Nlc3MoaW1wb3J0X2F0dGFjaC0+ZG1hYnVmLAotCQkJCQkg
ICAgICAgRE1BX0ZST01fREVWSUNFKTsKLQkJaWYgKHJldCkKLQkJCWdvdG8gdW5sb2NrOwotCX0K
LQotCWZvciAoaSA9IDA7IGkgPCBudW1fY2xpcHM7IGkrKykgewotCQlyZXQgPSB1ZGxfaGFuZGxl
X2RhbWFnZShmYiwgY2xpcHNbaV0ueDEsIGNsaXBzW2ldLnkxLAotCQkJCQljbGlwc1tpXS54MiAt
IGNsaXBzW2ldLngxLAotCQkJCQljbGlwc1tpXS55MiAtIGNsaXBzW2ldLnkxKTsKLQkJaWYgKHJl
dCkKLQkJCWJyZWFrOwotCX0KLQotCWlmIChpbXBvcnRfYXR0YWNoKQotCQlyZXQgPSBkbWFfYnVm
X2VuZF9jcHVfYWNjZXNzKGltcG9ydF9hdHRhY2gtPmRtYWJ1ZiwKLQkJCQkJICAgICBETUFfRlJP
TV9ERVZJQ0UpOwotCi0gdW5sb2NrOgotCWRybV9tb2Rlc2V0X3VubG9ja19hbGwoZmItPmRldik7
Ci0KLQlyZXR1cm4gcmV0OwotfQotCi1zdGF0aWMgY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZl
cl9mdW5jcyB1ZGxmYl9mdW5jcyA9IHsKLQkuZGVzdHJveQk9IGRybV9nZW1fZmJfZGVzdHJveSwK
LQkuY3JlYXRlX2hhbmRsZQk9IGRybV9nZW1fZmJfY3JlYXRlX2hhbmRsZSwKLQkuZGlydHkJCT0g
dWRsX3VzZXJfZnJhbWVidWZmZXJfZGlydHksCi19OwotCi1zdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVy
ICoKLXVkbF9mYl91c2VyX2ZiX2NyZWF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAotCQkgICBz
dHJ1Y3QgZHJtX2ZpbGUgKmZpbGUsCi0JCSAgIGNvbnN0IHN0cnVjdCBkcm1fbW9kZV9mYl9jbWQy
ICptb2RlX2NtZCkKLXsKLQlyZXR1cm4gZHJtX2dlbV9mYl9jcmVhdGVfd2l0aF9mdW5jcyhkZXYs
IGZpbGUsIG1vZGVfY21kLAotCQkJCQkgICAgJnVkbGZiX2Z1bmNzKTsKLX0KZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS91ZGwvdWRsX21vZGVzZXQuYyBiL2RyaXZlcnMvZ3B1L2RybS91ZGwv
dWRsX21vZGVzZXQuYwppbmRleCAxYjVhNDZhOTFjYjQuLmFhZGU2MWFkMDk3YiAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL3VkbC91ZGxfbW9kZXNldC5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS91ZGwvdWRsX21vZGVzZXQuYwpAQCAtMTEsNiArMTEsNyBAQAogCiAjaW5jbHVkZSA8ZHJtL2Ry
bV9hdG9taWNfaGVscGVyLmg+CiAjaW5jbHVkZSA8ZHJtL2RybV9jcnRjX2hlbHBlci5oPgorI2lu
Y2x1ZGUgPGRybS9kcm1fZGFtYWdlX2hlbHBlci5oPgogI2luY2x1ZGUgPGRybS9kcm1fZ2VtX2Zy
YW1lYnVmZmVyX2hlbHBlci5oPgogI2luY2x1ZGUgPGRybS9kcm1fbW9kZXNldF9oZWxwZXJfdnRh
Ymxlcy5oPgogI2luY2x1ZGUgPGRybS9kcm1fdmJsYW5rLmg+CkBAIC0zNjQsNyArMzY1LDkgQEAg
dWRsX3NpbXBsZV9kaXNwbGF5X3BpcGVfdXBkYXRlKHN0cnVjdCBkcm1fc2ltcGxlX2Rpc3BsYXlf
cGlwZSAqcGlwZSwKIHsKIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gcGlwZS0+Y3J0Yy5kZXY7
CiAJc3RydWN0IHVkbF9kZXZpY2UgKnVkbCA9IGRldi0+ZGV2X3ByaXZhdGU7Ci0Jc3RydWN0IGRy
bV9mcmFtZWJ1ZmZlciAqZmIgPSBwaXBlLT5wbGFuZS5zdGF0ZS0+ZmI7CisJc3RydWN0IGRybV9w
bGFuZV9zdGF0ZSAqc3RhdGUgPSBwaXBlLT5wbGFuZS5zdGF0ZTsKKwlzdHJ1Y3QgZHJtX2ZyYW1l
YnVmZmVyICpmYiA9IHN0YXRlLT5mYjsKKwlzdHJ1Y3QgZHJtX3JlY3QgcmVjdDsKIAogCXNwaW5f
bG9jaygmdWRsLT5hY3RpdmVfZmJfMTZfbG9jayk7CiAJdWRsLT5hY3RpdmVfZmJfMTYgPSBmYjsK
QEAgLTM3Myw3ICszNzYsOSBAQCB1ZGxfc2ltcGxlX2Rpc3BsYXlfcGlwZV91cGRhdGUoc3RydWN0
IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBlLAogCWlmICghZmIpCiAJCXJldHVybjsKIAot
CXVkbF9oYW5kbGVfZGFtYWdlKGZiLCAwLCAwLCBmYi0+d2lkdGgsIGZiLT5oZWlnaHQpOworCWlm
IChkcm1fYXRvbWljX2hlbHBlcl9kYW1hZ2VfbWVyZ2VkKG9sZF9wbGFuZV9zdGF0ZSwgc3RhdGUs
ICZyZWN0KSkKKwkJdWRsX2hhbmRsZV9kYW1hZ2UoZmIsIHJlY3QueDEsIHJlY3QueTEsIHJlY3Qu
eDIgLSByZWN0LngxLAorCQkJCSAgcmVjdC55MiAtIHJlY3QueTEpOwogfQogCiBzdGF0aWMgY29u
c3QKQEAgLTM5MSw3ICszOTYsNyBAQCBzdHJ1Y3QgZHJtX3NpbXBsZV9kaXNwbGF5X3BpcGVfZnVu
Y3MgdWRsX3NpbXBsZV9kaXNwbGF5X3BpcGVfZnVuY3MgPSB7CiAgKi8KIAogc3RhdGljIGNvbnN0
IHN0cnVjdCBkcm1fbW9kZV9jb25maWdfZnVuY3MgdWRsX21vZGVfZnVuY3MgPSB7Ci0JLmZiX2Ny
ZWF0ZSA9IHVkbF9mYl91c2VyX2ZiX2NyZWF0ZSwKKwkuZmJfY3JlYXRlID0gZHJtX2dlbV9mYl9j
cmVhdGVfd2l0aF9kaXJ0eSwKIAkuYXRvbWljX2NoZWNrICA9IGRybV9hdG9taWNfaGVscGVyX2No
ZWNrLAogCS5hdG9taWNfY29tbWl0ID0gZHJtX2F0b21pY19oZWxwZXJfY29tbWl0LAogfTsKLS0g
CjIuMjMuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18K
ZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0
dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
