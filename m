Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 0CCD1299412
	for <lists+dri-devel@lfdr.de>; Mon, 26 Oct 2020 18:41:31 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EF07A6EA4C;
	Mon, 26 Oct 2020 17:41:22 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x542.google.com (mail-ed1-x542.google.com
 [IPv6:2a00:1450:4864:20::542])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9AD4E6EA4A
 for <dri-devel@lists.freedesktop.org>; Mon, 26 Oct 2020 17:41:21 +0000 (UTC)
Received: by mail-ed1-x542.google.com with SMTP id w25so10332454edx.2
 for <dri-devel@lists.freedesktop.org>; Mon, 26 Oct 2020 10:41:21 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:subject:date:message-id:in-reply-to:references:mime-version
 :content-transfer-encoding;
 bh=Txj5pwF3irCV2nA9ejMES6zYmUaWi4r6LIESldm8ktI=;
 b=om1T3Obq2Xj0KGBOjF9+qTSrhmwRsAJtRcK/KEG8wKF2ZiUfEKbRhJRSlbYk8J8LIn
 Wgu7OtYjx/hiKoVqbhurzvi4UqU87eukX4pulNW2PyjKhFEbuz4WqxVH/Vlfu9V6wneB
 re1dSR2+b9Uia1IrsFx5u3sEKksybg1d2Vr76yjx9FnizYhSpK8LvCXsc8/1D7VWEXhg
 2iM8xl7hyEh1pgQaWNesbt3BT2DaZRlHJV0NcQbJZkLwCGLzToshaqwk0Hh8sZ1r6NNx
 KzVsn4/dB1RleJjYZfVhkwDfkLGWlT4c/dxeaYn1usEwJQLR4ZtfsSmcoU16zXeZCObP
 hHHw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=Txj5pwF3irCV2nA9ejMES6zYmUaWi4r6LIESldm8ktI=;
 b=D4y0G+U+3gs8Z/0WCjcsl1MvhNeO4gv8+IbcU+phtX9A3sefuyHrCNr3ItfY8cBJki
 DvdJthWUelFjVwhjRnuGjkkPmYTvCj9rH3RuFnZF1oVmNa+CuhmsJSHlnw77kMXkFBDy
 jhkL6VDNb+4og6KBxK4yTNu71X8mw78i1NUpB1oxqPuijwdgyuyIthKqlDJ4it4aS3Z/
 uIE9TcZjY2VqZb2w3wALQbjtjllS5sTvpbPjUIj2j3pyXs0gNIhJHlFS9tRRn7YeCzfZ
 upagB43bMBHkV8Nd6cqFk0MKi7xb6YkIDnSR3HIVMkdHOn1do+KukmFxnOyaCfForf0l
 SHbw==
X-Gm-Message-State: AOAM531yUaX8u6h5Zk6/89Mx5inZ1aEB8G+LLQ9ppd89g1uqlwcusMd/
 dgxCxyfAlaNTGgA7hPA5Qv4Fz/ncG8s=
X-Google-Smtp-Source: ABdhPJzCn+fW+HkCzggRlM4MUpXP6/iW4prWu7jsrBuHWsPPTSmY6y9HxoNxEx2l8ouhdEyW23ylNw==
X-Received: by 2002:a05:6402:1bcc:: with SMTP id
 ch12mr16925737edb.339.1603734079665; 
 Mon, 26 Oct 2020 10:41:19 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:203b:21f:8891:7b14])
 by smtp.gmail.com with ESMTPSA id i14sm6227325ejy.110.2020.10.26.10.41.19
 for <dri-devel@lists.freedesktop.org>
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 26 Oct 2020 10:41:19 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 2/9] drm/ttm: wire up the new pool as default one v2
Date: Mon, 26 Oct 2020 18:41:10 +0100
Message-Id: <20201026174117.2553-2-christian.koenig@amd.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20201026174117.2553-1-christian.koenig@amd.com>
References: <20201026174117.2553-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

UHJvdmlkZSB0aGUgbmVjZXNzYXJ5IHBhcmFtZXRlcnMgYnkgYWxsIGRyaXZlcnMgYW5kIHVzZSB0
aGUgbmV3IHBvb2wgYWxsb2MKd2hlbiBubyBkcml2ZXIgc3BlY2lmaWMgZnVuY3Rpb24gaXMgcHJv
dmlkZWQuCgp2MjogZml4IHRoZSBHRU0gVlJBTSBoZWxwZXJzCgpTaWduZWQtb2ZmLWJ5OiBDaHJp
c3RpYW4gS8O2bmlnIDxjaHJpc3RpYW4ua29lbmlnQGFtZC5jb20+Ci0tLQogZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jIHwgIDQgKystLQogZHJpdmVycy9ncHUvZHJtL2Ry
bV9nZW1fdnJhbV9oZWxwZXIuYyAgIHwgIDQgKystLQogZHJpdmVycy9ncHUvZHJtL25vdXZlYXUv
bm91dmVhdV90dG0uYyAgIHwgMTQgKysrKysrKysrLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9xeGwv
cXhsX3R0bS5jICAgICAgICAgICB8ICA1ICsrLS0tCiBkcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3Jh
ZGVvbl90dG0uYyAgICAgfCAgNCArKy0tCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5jICAg
ICAgICAgICAgfCAgOCArKysrKystLQogZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fdHQuYyAgICAg
ICAgICAgIHwgIDUgKystLS0KIGRyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2Rydi5jICAg
ICB8ICA1ICsrKy0tCiBpbmNsdWRlL2RybS90dG0vdHRtX2JvX2RyaXZlci5oICAgICAgICAgfCAx
MSArKysrKysrLS0tLQogOSBmaWxlcyBjaGFuZ2VkLCAzNSBpbnNlcnRpb25zKCspLCAyNSBkZWxl
dGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
dHRtLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmMKaW5kZXggYmVh
Y2QwMDIyMWQ4Li4zNDk0NDkyNzgzOGUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV90dG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfdHRtLmMKQEAgLTE5MTQsMTAgKzE5MTQsMTAgQEAgaW50IGFtZGdwdV90dG1faW5pdChzdHJ1
Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKIAltdXRleF9pbml0KCZhZGV2LT5tbWFuLmd0dF93aW5k
b3dfbG9jayk7CiAKIAkvKiBObyBvdGhlcnMgdXNlciBvZiBhZGRyZXNzIHNwYWNlIHNvIHNldCBp
dCB0byAwICovCi0JciA9IHR0bV9ib19kZXZpY2VfaW5pdCgmYWRldi0+bW1hbi5iZGV2LAotCQkJ
ICAgICAgICZhbWRncHVfYm9fZHJpdmVyLAorCXIgPSB0dG1fYm9fZGV2aWNlX2luaXQoJmFkZXYt
Pm1tYW4uYmRldiwgJmFtZGdwdV9ib19kcml2ZXIsIGFkZXYtPmRldiwKIAkJCSAgICAgICBhZGV2
X3RvX2RybShhZGV2KS0+YW5vbl9pbm9kZS0+aV9tYXBwaW5nLAogCQkJICAgICAgIGFkZXZfdG9f
ZHJtKGFkZXYpLT52bWFfb2Zmc2V0X21hbmFnZXIsCisJCQkgICAgICAgYWRldi0+bmVlZF9zd2lv
dGxiLAogCQkJICAgICAgIGRtYV9hZGRyZXNzaW5nX2xpbWl0ZWQoYWRldi0+ZGV2KSk7CiAJaWYg
KHIpIHsKIAkJRFJNX0VSUk9SKCJmYWlsZWQgaW5pdGlhbGl6aW5nIGJ1ZmZlciBvYmplY3QgZHJp
dmVyKCVkKS5cbiIsIHIpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2RybV9nZW1fdnJh
bV9oZWxwZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMKaW5kZXgg
OWRhODIzZWIwZWRkLi42ODM3NjJiMmY5YTggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9k
cm1fZ2VtX3ZyYW1faGVscGVyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2RybV9nZW1fdnJhbV9o
ZWxwZXIuYwpAQCAtMTA0NSwxMCArMTA0NSwxMCBAQCBzdGF0aWMgaW50IGRybV92cmFtX21tX2lu
aXQoc3RydWN0IGRybV92cmFtX21tICp2bW0sIHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJdm1t
LT52cmFtX2Jhc2UgPSB2cmFtX2Jhc2U7CiAJdm1tLT52cmFtX3NpemUgPSB2cmFtX3NpemU7CiAK
LQlyZXQgPSB0dG1fYm9fZGV2aWNlX2luaXQoJnZtbS0+YmRldiwgJmJvX2RyaXZlciwKKwlyZXQg
PSB0dG1fYm9fZGV2aWNlX2luaXQoJnZtbS0+YmRldiwgJmJvX2RyaXZlciwgZGV2LT5kZXYsCiAJ
CQkJIGRldi0+YW5vbl9pbm9kZS0+aV9tYXBwaW5nLAogCQkJCSBkZXYtPnZtYV9vZmZzZXRfbWFu
YWdlciwKLQkJCQkgdHJ1ZSk7CisJCQkJIGZhbHNlLCB0cnVlKTsKIAlpZiAocmV0KQogCQlyZXR1
cm4gcmV0OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X3R0
bS5jIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV90dG0uYwppbmRleCAwNTkyZWQ2
ZWFhZDEuLmQ2OTZkODgyYzllYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUv
bm91dmVhdV90dG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X3R0bS5j
CkBAIC0yODEsNiArMjgxLDcgQEAgbm91dmVhdV90dG1faW5pdChzdHJ1Y3Qgbm91dmVhdV9kcm0g
KmRybSkKIAlzdHJ1Y3QgbnZrbV9wY2kgKnBjaSA9IGRldmljZS0+cGNpOwogCXN0cnVjdCBudmlm
X21tdSAqbW11ID0gJmRybS0+Y2xpZW50Lm1tdTsKIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0g
ZHJtLT5kZXY7CisJYm9vbCBuZWVkX3N3aW90bGIgPSBmYWxzZTsKIAlpbnQgdHlwZWksIHJldDsK
IAogCXJldCA9IG5vdXZlYXVfdHRtX2luaXRfaG9zdChkcm0sIDApOwpAQCAtMzE1LDExICszMTYs
MTQgQEAgbm91dmVhdV90dG1faW5pdChzdHJ1Y3Qgbm91dmVhdV9kcm0gKmRybSkKIAkJZHJtLT5h
Z3AuY21hID0gcGNpLT5hZ3AuY21hOwogCX0KIAotCXJldCA9IHR0bV9ib19kZXZpY2VfaW5pdCgm
ZHJtLT50dG0uYmRldiwKLQkJCQkgICZub3V2ZWF1X2JvX2RyaXZlciwKLQkJCQkgIGRldi0+YW5v
bl9pbm9kZS0+aV9tYXBwaW5nLAotCQkJCSAgZGV2LT52bWFfb2Zmc2V0X21hbmFnZXIsCi0JCQkJ
ICBkcm0tPmNsaWVudC5tbXUuZG1hYml0cyA8PSAzMiA/IHRydWUgOiBmYWxzZSk7CisjaWYgSVNf
RU5BQkxFRChDT05GSUdfU1dJT1RMQikgJiYgSVNfRU5BQkxFRChDT05GSUdfWDg2KQorCW5lZWRf
c3dpb3RsYiA9ICEhc3dpb3RsYl9ucl90YmwoKTsKKyNlbmRpZgorCisJcmV0ID0gdHRtX2JvX2Rl
dmljZV9pbml0KCZkcm0tPnR0bS5iZGV2LCAmbm91dmVhdV9ib19kcml2ZXIsCisJCQkJIGRybS0+
ZGV2LT5kZXYsIGRldi0+YW5vbl9pbm9kZS0+aV9tYXBwaW5nLAorCQkJCSBkZXYtPnZtYV9vZmZz
ZXRfbWFuYWdlciwgbmVlZF9zd2lvdGxiLAorCQkJCSBkcm0tPmNsaWVudC5tbXUuZG1hYml0cyA8
PSAzMik7CiAJaWYgKHJldCkgewogCQlOVl9FUlJPUihkcm0sICJlcnJvciBpbml0aWFsaXNpbmcg
Ym8gZHJpdmVyLCAlZFxuIiwgcmV0KTsKIAkJcmV0dXJuIHJldDsKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9xeGwvcXhsX3R0bS5jIGIvZHJpdmVycy9ncHUvZHJtL3F4bC9xeGxfdHRtLmMK
aW5kZXggOTYwOWVlYjUyODIxLi5kOGVjZmI4YjMxOTMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9xeGwvcXhsX3R0bS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9xeGwvcXhsX3R0bS5jCkBA
IC0xOTQsMTEgKzE5NCwxMCBAQCBpbnQgcXhsX3R0bV9pbml0KHN0cnVjdCBxeGxfZGV2aWNlICpx
ZGV2KQogCWludCBudW1faW9fcGFnZXM7IC8qICE9IHJvbS0+bnVtX2lvX3BhZ2VzLCB3ZSBpbmNs
dWRlIHN1cmZhY2UwICovCiAKIAkvKiBObyBvdGhlcnMgdXNlciBvZiBhZGRyZXNzIHNwYWNlIHNv
IHNldCBpdCB0byAwICovCi0JciA9IHR0bV9ib19kZXZpY2VfaW5pdCgmcWRldi0+bW1hbi5iZGV2
LAotCQkJICAgICAgICZxeGxfYm9fZHJpdmVyLAorCXIgPSB0dG1fYm9fZGV2aWNlX2luaXQoJnFk
ZXYtPm1tYW4uYmRldiwgJnF4bF9ib19kcml2ZXIsIE5VTEwsCiAJCQkgICAgICAgcWRldi0+ZGRl
di5hbm9uX2lub2RlLT5pX21hcHBpbmcsCiAJCQkgICAgICAgcWRldi0+ZGRldi52bWFfb2Zmc2V0
X21hbmFnZXIsCi0JCQkgICAgICAgZmFsc2UpOworCQkJICAgICAgIGZhbHNlLCBmYWxzZSk7CiAJ
aWYgKHIpIHsKIAkJRFJNX0VSUk9SKCJmYWlsZWQgaW5pdGlhbGl6aW5nIGJ1ZmZlciBvYmplY3Qg
ZHJpdmVyKCVkKS5cbiIsIHIpOwogCQlyZXR1cm4gcjsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9yYWRlb24vcmFkZW9uX3R0bS5jIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25f
dHRtLmMKaW5kZXggMGE2ZDdlYTg0N2RiLi4xYWRkMzkxODUxOWMgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX3R0bS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRl
b24vcmFkZW9uX3R0bS5jCkBAIC04NDYsMTAgKzg0NiwxMCBAQCBpbnQgcmFkZW9uX3R0bV9pbml0
KHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2KQogCWludCByOwogCiAJLyogTm8gb3RoZXJzIHVz
ZXIgb2YgYWRkcmVzcyBzcGFjZSBzbyBzZXQgaXQgdG8gMCAqLwotCXIgPSB0dG1fYm9fZGV2aWNl
X2luaXQoJnJkZXYtPm1tYW4uYmRldiwKLQkJCSAgICAgICAmcmFkZW9uX2JvX2RyaXZlciwKKwly
ID0gdHRtX2JvX2RldmljZV9pbml0KCZyZGV2LT5tbWFuLmJkZXYsICZyYWRlb25fYm9fZHJpdmVy
LCByZGV2LT5kZXYsCiAJCQkgICAgICAgcmRldi0+ZGRldi0+YW5vbl9pbm9kZS0+aV9tYXBwaW5n
LAogCQkJICAgICAgIHJkZXYtPmRkZXYtPnZtYV9vZmZzZXRfbWFuYWdlciwKKwkJCSAgICAgICBy
ZGV2LT5uZWVkX3N3aW90bGIsCiAJCQkgICAgICAgZG1hX2FkZHJlc3NpbmdfbGltaXRlZCgmcmRl
di0+cGRldi0+ZGV2KSk7CiAJaWYgKHIpIHsKIAkJRFJNX0VSUk9SKCJmYWlsZWQgaW5pdGlhbGl6
aW5nIGJ1ZmZlciBvYmplY3QgZHJpdmVyKCVkKS5cbiIsIHIpOwpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL3R0bS90dG1fYm8uYyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvLmMKaW5k
ZXggNDBjNzJhMGY5MzI1Li5lOWY5MWNmY2U1ZTkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS90dG0vdHRtX2JvLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm8uYwpAQCAtMTI4
Myw2ICsxMjgzLDggQEAgaW50IHR0bV9ib19kZXZpY2VfcmVsZWFzZShzdHJ1Y3QgdHRtX2JvX2Rl
dmljZSAqYmRldikKIAkJCXByX2RlYnVnKCJTd2FwIGxpc3QgJWQgd2FzIGNsZWFuXG4iLCBpKTsK
IAlzcGluX3VubG9jaygmZ2xvYi0+bHJ1X2xvY2spOwogCisJdHRtX3Bvb2xfZmluaSgmYmRldi0+
cG9vbCk7CisKIAlpZiAoIXJldCkKIAkJdHRtX2JvX2dsb2JhbF9yZWxlYXNlKCk7CiAKQEAgLTEz
MDcsOSArMTMwOSwxMCBAQCBzdGF0aWMgdm9pZCB0dG1fYm9faW5pdF9zeXNtYW4oc3RydWN0IHR0
bV9ib19kZXZpY2UgKmJkZXYpCiAKIGludCB0dG1fYm9fZGV2aWNlX2luaXQoc3RydWN0IHR0bV9i
b19kZXZpY2UgKmJkZXYsCiAJCSAgICAgICBzdHJ1Y3QgdHRtX2JvX2RyaXZlciAqZHJpdmVyLAor
CQkgICAgICAgc3RydWN0IGRldmljZSAqZGV2LAogCQkgICAgICAgc3RydWN0IGFkZHJlc3Nfc3Bh
Y2UgKm1hcHBpbmcsCiAJCSAgICAgICBzdHJ1Y3QgZHJtX3ZtYV9vZmZzZXRfbWFuYWdlciAqdm1h
X21hbmFnZXIsCi0JCSAgICAgICBib29sIG5lZWRfZG1hMzIpCisJCSAgICAgICBib29sIHVzZV9k
bWFfYWxsb2MsIGJvb2wgdXNlX2RtYTMyKQogewogCXN0cnVjdCB0dG1fYm9fZ2xvYmFsICpnbG9i
ID0gJnR0bV9ib19nbG9iOwogCWludCByZXQ7CkBAIC0xMzI0LDEyICsxMzI3LDEzIEBAIGludCB0
dG1fYm9fZGV2aWNlX2luaXQoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCiAJYmRldi0+ZHJp
dmVyID0gZHJpdmVyOwogCiAJdHRtX2JvX2luaXRfc3lzbWFuKGJkZXYpOworCXR0bV9wb29sX2lu
aXQoJmJkZXYtPnBvb2wsIGRldiwgdXNlX2RtYV9hbGxvYywgdXNlX2RtYTMyKTsKIAogCWJkZXYt
PnZtYV9tYW5hZ2VyID0gdm1hX21hbmFnZXI7CiAJSU5JVF9ERUxBWUVEX1dPUksoJmJkZXYtPndx
LCB0dG1fYm9fZGVsYXllZF93b3JrcXVldWUpOwogCUlOSVRfTElTVF9IRUFEKCZiZGV2LT5kZGVz
dHJveSk7CiAJYmRldi0+ZGV2X21hcHBpbmcgPSBtYXBwaW5nOwotCWJkZXYtPm5lZWRfZG1hMzIg
PSBuZWVkX2RtYTMyOworCWJkZXYtPm5lZWRfZG1hMzIgPSB1c2VfZG1hMzI7CiAJbXV0ZXhfbG9j
aygmdHRtX2dsb2JhbF9tdXRleCk7CiAJbGlzdF9hZGRfdGFpbCgmYmRldi0+ZGV2aWNlX2xpc3Qs
ICZnbG9iLT5kZXZpY2VfbGlzdCk7CiAJbXV0ZXhfdW5sb2NrKCZ0dG1fZ2xvYmFsX211dGV4KTsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3R0LmMgYi9kcml2ZXJzL2dwdS9k
cm0vdHRtL3R0bV90dC5jCmluZGV4IDY1YzQyNTRlZWE1Yy4uOTAwNTQyODBjZDhmIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV90dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90
dG0vdHRtX3R0LmMKQEAgLTM3LDcgKzM3LDYgQEAKICNpbmNsdWRlIDxsaW51eC9maWxlLmg+CiAj
aW5jbHVkZSA8ZHJtL2RybV9jYWNoZS5oPgogI2luY2x1ZGUgPGRybS90dG0vdHRtX2JvX2RyaXZl
ci5oPgotI2luY2x1ZGUgPGRybS90dG0vdHRtX3BhZ2VfYWxsb2MuaD4KIAogLyoqCiAgKiBBbGxv
Y2F0ZXMgYSB0dG0gc3RydWN0dXJlIGZvciB0aGUgZ2l2ZW4gQk8uCkBAIC0zMjEsNyArMzIwLDcg
QEAgaW50IHR0bV90dF9wb3B1bGF0ZShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKIAlpZiAo
YmRldi0+ZHJpdmVyLT50dG1fdHRfcG9wdWxhdGUpCiAJCXJldCA9IGJkZXYtPmRyaXZlci0+dHRt
X3R0X3BvcHVsYXRlKGJkZXYsIHR0bSwgY3R4KTsKIAllbHNlCi0JCXJldCA9IHR0bV9wb29sX3Bv
cHVsYXRlKHR0bSwgY3R4KTsKKwkJcmV0ID0gdHRtX3Bvb2xfYWxsb2MoJmJkZXYtPnBvb2wsIHR0
bSwgY3R4KTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCkBAIC0zNjMsNiArMzYyLDYgQEAg
dm9pZCB0dG1fdHRfdW5wb3B1bGF0ZShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKIAlpZiAo
YmRldi0+ZHJpdmVyLT50dG1fdHRfdW5wb3B1bGF0ZSkKIAkJYmRldi0+ZHJpdmVyLT50dG1fdHRf
dW5wb3B1bGF0ZShiZGV2LCB0dG0pOwogCWVsc2UKLQkJdHRtX3Bvb2xfdW5wb3B1bGF0ZSh0dG0p
OworCQl0dG1fcG9vbF9mcmVlKCZiZGV2LT5wb29sLCB0dG0pOwogCXR0bS0+cGFnZV9mbGFncyAm
PSB+VFRNX1BBR0VfRkxBR19QUklWX1BPUFVMQVRFRDsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS92bXdnZngvdm13Z2Z4X2Rydi5jIGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdn
ZnhfZHJ2LmMKaW5kZXggNDg2MDM3MDc0MGUwLi43YmQxYmUyNmFmZTQgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2Rydi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92
bXdnZngvdm13Z2Z4X2Rydi5jCkBAIC04NzgsMTAgKzg3OCwxMSBAQCBzdGF0aWMgaW50IHZtd19k
cml2ZXJfbG9hZChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1bnNpZ25lZCBsb25nIGNoaXBzZXQp
CiAJZHJtX3ZtYV9vZmZzZXRfbWFuYWdlcl9pbml0KCZkZXZfcHJpdi0+dm1hX21hbmFnZXIsCiAJ
CQkJICAgIERSTV9GSUxFX1BBR0VfT0ZGU0VUX1NUQVJULAogCQkJCSAgICBEUk1fRklMRV9QQUdF
X09GRlNFVF9TSVpFKTsKLQlyZXQgPSB0dG1fYm9fZGV2aWNlX2luaXQoJmRldl9wcml2LT5iZGV2
LAotCQkJCSAmdm13X2JvX2RyaXZlciwKKwlyZXQgPSB0dG1fYm9fZGV2aWNlX2luaXQoJmRldl9w
cml2LT5iZGV2LCAmdm13X2JvX2RyaXZlciwKKwkJCQkgZGV2X3ByaXYtPmRldi0+ZGV2LAogCQkJ
CSBkZXYtPmFub25faW5vZGUtPmlfbWFwcGluZywKIAkJCQkgJmRldl9wcml2LT52bWFfbWFuYWdl
ciwKKwkJCQkgZGV2X3ByaXYtPm1hcF9tb2RlID09IHZtd19kbWFfYWxsb2NfY29oZXJlbnQsCiAJ
CQkJIGZhbHNlKTsKIAlpZiAodW5saWtlbHkocmV0ICE9IDApKSB7CiAJCURSTV9FUlJPUigiRmFp
bGVkIGluaXRpYWxpemluZyBUVE0gYnVmZmVyIG9iamVjdCBkcml2ZXIuXG4iKTsKZGlmZiAtLWdp
dCBhL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fZHJpdmVyLmggYi9pbmNsdWRlL2RybS90dG0vdHRt
X2JvX2RyaXZlci5oCmluZGV4IDI5ZjZhMWQxYzg1My4uNDVhZTg3NjQwOTA5IDEwMDY0NAotLS0g
YS9pbmNsdWRlL2RybS90dG0vdHRtX2JvX2RyaXZlci5oCisrKyBiL2luY2x1ZGUvZHJtL3R0bS90
dG1fYm9fZHJpdmVyLmgKQEAgLTQyLDYgKzQyLDcgQEAKICNpbmNsdWRlICJ0dG1fbW9kdWxlLmgi
CiAjaW5jbHVkZSAidHRtX3BsYWNlbWVudC5oIgogI2luY2x1ZGUgInR0bV90dC5oIgorI2luY2x1
ZGUgInR0bV9wb29sLmgiCiAKIC8qKgogICogc3RydWN0IHR0bV9ib19kcml2ZXIKQEAgLTI5NSw2
ICsyOTYsNyBAQCBzdHJ1Y3QgdHRtX2JvX2RldmljZSB7CiAJICogUHJvdGVjdGVkIGJ5IGludGVy
bmFsIGxvY2tzLgogCSAqLwogCXN0cnVjdCBkcm1fdm1hX29mZnNldF9tYW5hZ2VyICp2bWFfbWFu
YWdlcjsKKwlzdHJ1Y3QgdHRtX3Bvb2wgcG9vbDsKIAogCS8qCiAJICogUHJvdGVjdGVkIGJ5IHRo
ZSBnbG9iYWw6bHJ1IGxvY2suCkBAIC0zOTUsMTEgKzM5NywxMSBAQCBpbnQgdHRtX2JvX2Rldmlj
ZV9yZWxlYXNlKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2KTsKICAqIEBiZGV2OiBBIHBvaW50
ZXIgdG8gYSBzdHJ1Y3QgdHRtX2JvX2RldmljZSB0byBpbml0aWFsaXplLgogICogQGdsb2I6IEEg
cG9pbnRlciB0byBhbiBpbml0aWFsaXplZCBzdHJ1Y3QgdHRtX2JvX2dsb2JhbC4KICAqIEBkcml2
ZXI6IEEgcG9pbnRlciB0byBhIHN0cnVjdCB0dG1fYm9fZHJpdmVyIHNldCB1cCBieSB0aGUgY2Fs
bGVyLgorICogQGRldjogVGhlIGNvcmUga2VybmVsIGRldmljZSBwb2ludGVyIGZvciBETUEgbWFw
cGluZ3MgYW5kIGFsbG9jYXRpb25zLgogICogQG1hcHBpbmc6IFRoZSBhZGRyZXNzIHNwYWNlIHRv
IHVzZSBmb3IgdGhpcyBiby4KICAqIEB2bWFfbWFuYWdlcjogQSBwb2ludGVyIHRvIGEgdm1hIG1h
bmFnZXIuCi0gKiBAZmlsZV9wYWdlX29mZnNldDogT2Zmc2V0IGludG8gdGhlIGRldmljZSBhZGRy
ZXNzIHNwYWNlIHRoYXQgaXMgYXZhaWxhYmxlCi0gKiBmb3IgYnVmZmVyIGRhdGEuIFRoaXMgZW5z
dXJlcyBjb21wYXRpYmlsaXR5IHdpdGggb3RoZXIgdXNlcnMgb2YgdGhlCi0gKiBhZGRyZXNzIHNw
YWNlLgorICogQHVzZV9kbWFfYWxsb2M6IElmIGNvaGVyZW50IERNQSBhbGxvY2F0aW9uIEFQSSBz
aG91bGQgYmUgdXNlZC4KKyAqIEB1c2VfZG1hMzI6IElmIHdlIHNob3VsZCB1c2UgR0ZQX0RNQTMy
IGZvciBkZXZpY2UgbWVtb3J5IGFsbG9jYXRpb25zLgogICoKICAqIEluaXRpYWxpemVzIGEgc3Ry
dWN0IHR0bV9ib19kZXZpY2U6CiAgKiBSZXR1cm5zOgpAQCAtNDA3LDkgKzQwOSwxMCBAQCBpbnQg
dHRtX2JvX2RldmljZV9yZWxlYXNlKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2KTsKICAqLwog
aW50IHR0bV9ib19kZXZpY2VfaW5pdChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKIAkJICAg
ICAgIHN0cnVjdCB0dG1fYm9fZHJpdmVyICpkcml2ZXIsCisJCSAgICAgICBzdHJ1Y3QgZGV2aWNl
ICpkZXYsCiAJCSAgICAgICBzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZywKIAkJICAgICAg
IHN0cnVjdCBkcm1fdm1hX29mZnNldF9tYW5hZ2VyICp2bWFfbWFuYWdlciwKLQkJICAgICAgIGJv
b2wgbmVlZF9kbWEzMik7CisJCSAgICAgICBib29sIHVzZV9kbWFfYWxsb2MsIGJvb2wgdXNlX2Rt
YTMyKTsKIAogLyoqCiAgKiB0dG1fYm9fdW5tYXBfdmlydHVhbAotLSAKMi4xNy4xCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGlu
ZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWwK
