Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 7BE749D2A5
	for <lists+dri-devel@lfdr.de>; Mon, 26 Aug 2019 17:27:06 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3D6166E21D;
	Mon, 26 Aug 2019 15:27:00 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from bhuna.collabora.co.uk (bhuna.collabora.co.uk
 [IPv6:2a00:1098:0:82:1000:25:2eeb:e3e3])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2DE9C6E21D
 for <dri-devel@lists.freedesktop.org>; Mon, 26 Aug 2019 15:26:59 +0000 (UTC)
Received: from localhost.localdomain (unknown
 [IPv6:2a01:e0a:2c:6930:5cf4:84a1:2763:fe0d])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested) (Authenticated sender: bbrezillon)
 by bhuna.collabora.co.uk (Postfix) with ESMTPSA id 7114528BD81;
 Mon, 26 Aug 2019 16:26:57 +0100 (BST)
From: Boris Brezillon <boris.brezillon@collabora.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v2 06/21] drm/exynos: Implement bridge_funcs instead of
 encoder_helper_funcs
Date: Mon, 26 Aug 2019 17:26:34 +0200
Message-Id: <20190826152649.13820-7-boris.brezillon@collabora.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190826152649.13820-1-boris.brezillon@collabora.com>
References: <20190826152649.13820-1-boris.brezillon@collabora.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Nikita Yushchenko <nikita.yoush@cogentembedded.com>,
 Jernej Skrabec <jernej.skrabec@siol.net>,
 Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
 Neil Armstrong <narmstrong@baylibre.com>,
 Andrey Smirnov <andrew.smirnov@gmail.com>, Jonas Karlman <jonas@kwiboo.se>,
 Seung-Woo Kim <sw0312.kim@samsung.com>,
 Kyungmin Park <kyungmin.park@samsung.com>,
 Thierry Reding <thierry.reding@gmail.com>, Chris Healy <Chris.Healy@zii.aero>,
 Boris Brezillon <boris.brezillon@collabora.com>, kernel@collabora.com,
 Sam Ravnborg <sam@ravnborg.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhvc2UgaG9va3MgYXJlIGNhbGxlZCBleGFjdGx5IGF0IHRoZSBzYW1lIHRpbWUgZXhjZXB0IHRo
ZSBicmlkZ2UKZnVuY3MgaGF2ZSBwcmVfZW5hYmxlKCkvcG9zdF9kaXNhYmxlKCkgaG9va3Mgd2hp
Y2ggYWxsb3dzIHVzIHRvIGdldApyaWQgb2YgdGhlIGhhY2sgcmVzZXR0aW5nIGVuY29kZXItPmJy
aWRnZS5uZXh0ICh3YXMgbmVlZGVkIHRvIGNvbnRyb2wKdGhlIGVuY29kZXIvYnJpZGdlIGVuYWJs
ZS9kaXNhYmxlIHNlcXVlbmNlKS4KClNpZ25lZC1vZmYtYnk6IEJvcmlzIEJyZXppbGxvbiA8Ym9y
aXMuYnJlemlsbG9uQGNvbGxhYm9yYS5jb20+Ci0tLQpDaGFuZ2VzIGluIHYyOgoqIE5ldyBwYXRj
aCAocmVwbGFjZW1lbnQgZm9yICJkcm0vZXh5bm9zOiBHZXQgcmlkIG9mIGV4eW5vc19kc2ktPm91
dF9icmlkZ2UiKQotLS0KIGRyaXZlcnMvZ3B1L2RybS9leHlub3MvZXh5bm9zX2RybV9kc2kuYyB8
IDU1ICsrKysrKysrKysrKysrKystLS0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCAzNiBpbnNlcnRp
b25zKCspLCAxOSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vZXh5
bm9zL2V4eW5vc19kcm1fZHNpLmMgYi9kcml2ZXJzL2dwdS9kcm0vZXh5bm9zL2V4eW5vc19kcm1f
ZHNpLmMKaW5kZXggYzU1NWNlY2ZlMWY1Li40ZjcxM2IwYWMyNDQgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9leHlub3MvZXh5bm9zX2RybV9kc2kuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
ZXh5bm9zL2V4eW5vc19kcm1fZHNpLmMKQEAgLTEzNzQsNDAgKzEzNzQsNDggQEAgc3RhdGljIHZv
aWQgZXh5bm9zX2RzaV91bnJlZ2lzdGVyX3RlX2lycShzdHJ1Y3QgZXh5bm9zX2RzaSAqZHNpKQog
CX0KIH0KIAotc3RhdGljIHZvaWQgZXh5bm9zX2RzaV9lbmFibGUoc3RydWN0IGRybV9lbmNvZGVy
ICplbmNvZGVyKQorc3RhdGljIHZvaWQgZXh5bm9zX2RzaV9wcmVfZW5hYmxlKHN0cnVjdCBkcm1f
YnJpZGdlICpicmlkZ2UpCiB7CisJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyID0gYnJpZGdl
X3RvX2VuY29kZXIoYnJpZGdlKTsKIAlzdHJ1Y3QgZXh5bm9zX2RzaSAqZHNpID0gZW5jb2Rlcl90
b19kc2koZW5jb2Rlcik7Ci0JaW50IHJldDsKIAogCWlmIChkc2ktPnN0YXRlICYgRFNJTV9TVEFU
RV9FTkFCTEVEKQogCQlyZXR1cm47CiAKIAlwbV9ydW50aW1lX2dldF9zeW5jKGRzaS0+ZGV2KTsK
LQlkc2ktPnN0YXRlIHw9IERTSU1fU1RBVEVfRU5BQkxFRDsKIAogCWlmIChkc2ktPnBhbmVsKSB7
CisJCWludCByZXQ7CisKIAkJcmV0ID0gZHJtX3BhbmVsX3ByZXBhcmUoZHNpLT5wYW5lbCk7CiAJ
CVdBUk5fT04ocmV0ICYmIHJldCAhPSAtRU5PU1lTKTsKLQl9IGVsc2UgewotCQlkcm1fYnJpZGdl
X3ByZV9lbmFibGUoZHNpLT5vdXRfYnJpZGdlKTsKIAl9Cit9CisKK3N0YXRpYyB2b2lkIGV4eW5v
c19kc2lfZW5hYmxlKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UpCit7CisJc3RydWN0IGRybV9l
bmNvZGVyICplbmNvZGVyID0gYnJpZGdlX3RvX2VuY29kZXIoYnJpZGdlKTsKKwlzdHJ1Y3QgZXh5
bm9zX2RzaSAqZHNpID0gZW5jb2Rlcl90b19kc2koZW5jb2Rlcik7CisKKwlpZiAoZHNpLT5zdGF0
ZSAmIERTSU1fU1RBVEVfRU5BQkxFRCkKKwkJcmV0dXJuOwogCiAJZXh5bm9zX2RzaV9zZXRfZGlz
cGxheV9tb2RlKGRzaSk7CiAJZXh5bm9zX2RzaV9zZXRfZGlzcGxheV9lbmFibGUoZHNpLCB0cnVl
KTsKIAogCWlmIChkc2ktPnBhbmVsKSB7CisJCWludCByZXQ7CisKIAkJcmV0ID0gZHJtX3BhbmVs
X2VuYWJsZShkc2ktPnBhbmVsKTsKIAkJV0FSTl9PTihyZXQgJiYgcmV0ICE9IC1FTk9TWVMpOwot
CX0gZWxzZSB7Ci0JCWRybV9icmlkZ2VfZW5hYmxlKGRzaS0+b3V0X2JyaWRnZSk7CiAJfQogCi0J
ZHNpLT5zdGF0ZSB8PSBEU0lNX1NUQVRFX1ZJRE9VVF9BVkFJTEFCTEU7Ci0JcmV0dXJuOworCWRz
aS0+c3RhdGUgfD0gRFNJTV9TVEFURV9WSURPVVRfQVZBSUxBQkxFIHwgRFNJTV9TVEFURV9FTkFC
TEVEOwogfQogCi1zdGF0aWMgdm9pZCBleHlub3NfZHNpX2Rpc2FibGUoc3RydWN0IGRybV9lbmNv
ZGVyICplbmNvZGVyKQorc3RhdGljIHZvaWQgZXh5bm9zX2RzaV9kaXNhYmxlKHN0cnVjdCBkcm1f
YnJpZGdlICpicmlkZ2UpCiB7CisJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyID0gYnJpZGdl
X3RvX2VuY29kZXIoYnJpZGdlKTsKIAlzdHJ1Y3QgZXh5bm9zX2RzaSAqZHNpID0gZW5jb2Rlcl90
b19kc2koZW5jb2Rlcik7CiAKIAlpZiAoIShkc2ktPnN0YXRlICYgRFNJTV9TVEFURV9FTkFCTEVE
KSkKQEAgLTE0MTUsMTEgKzE0MjMsMTggQEAgc3RhdGljIHZvaWQgZXh5bm9zX2RzaV9kaXNhYmxl
KHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcikKIAogCWRzaS0+c3RhdGUgJj0gfkRTSU1fU1RB
VEVfVklET1VUX0FWQUlMQUJMRTsKIAotCWRybV9wYW5lbF9kaXNhYmxlKGRzaS0+cGFuZWwpOwot
CWRybV9icmlkZ2VfZGlzYWJsZShkc2ktPm91dF9icmlkZ2UpOwogCWV4eW5vc19kc2lfc2V0X2Rp
c3BsYXlfZW5hYmxlKGRzaSwgZmFsc2UpOwogCWRybV9wYW5lbF91bnByZXBhcmUoZHNpLT5wYW5l
bCk7Ci0JZHJtX2JyaWRnZV9wb3N0X2Rpc2FibGUoZHNpLT5vdXRfYnJpZGdlKTsKK30KKworc3Rh
dGljIHZvaWQgZXh5bm9zX2RzaV9wb3N0X2Rpc2FibGUoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRn
ZSkKK3sKKwlzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIgPSBicmlkZ2VfdG9fZW5jb2Rlcihi
cmlkZ2UpOworCXN0cnVjdCBleHlub3NfZHNpICpkc2kgPSBlbmNvZGVyX3RvX2RzaShlbmNvZGVy
KTsKKworCWlmICghKGRzaS0+c3RhdGUgJiBEU0lNX1NUQVRFX0VOQUJMRUQpKQorCQlyZXR1cm47
CisKIAlkc2ktPnN0YXRlICY9IH5EU0lNX1NUQVRFX0VOQUJMRUQ7CiAJcG1fcnVudGltZV9wdXRf
c3luYyhkc2ktPmRldik7CiB9CkBAIC0xNDg5LDkgKzE1MDQsMTEgQEAgc3RhdGljIGludCBleHlu
b3NfZHNpX2NyZWF0ZV9jb25uZWN0b3Ioc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyKQogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgY29uc3Qgc3RydWN0IGRybV9lbmNvZGVyX2hlbHBlcl9mdW5j
cyBleHlub3NfZHNpX2VuY29kZXJfaGVscGVyX2Z1bmNzID0geworc3RhdGljIGNvbnN0IHN0cnVj
dCBkcm1fYnJpZGdlX2Z1bmNzIGV4eW5vc19kc2lfYnJpZGdlX2Z1bmNzID0geworCS5wcmVfZW5h
YmxlID0gZXh5bm9zX2RzaV9wcmVfZW5hYmxlLAogCS5lbmFibGUgPSBleHlub3NfZHNpX2VuYWJs
ZSwKIAkuZGlzYWJsZSA9IGV4eW5vc19kc2lfZGlzYWJsZSwKKwkucG9zdF9kaXNhYmxlID0gZXh5
bm9zX2RzaV9wb3N0X2Rpc2FibGUsCiB9OwogCiBzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9lbmNv
ZGVyX2Z1bmNzIGV4eW5vc19kc2lfZW5jb2Rlcl9mdW5jcyA9IHsKQEAgLTE1MTIsNyArMTUyOSw2
IEBAIHN0YXRpYyBpbnQgZXh5bm9zX2RzaV9ob3N0X2F0dGFjaChzdHJ1Y3QgbWlwaV9kc2lfaG9z
dCAqaG9zdCwKIAlpZiAob3V0X2JyaWRnZSkgewogCQlkcm1fYnJpZGdlX2F0dGFjaChlbmNvZGVy
LCBvdXRfYnJpZGdlLCBOVUxMKTsKIAkJZHNpLT5vdXRfYnJpZGdlID0gb3V0X2JyaWRnZTsKLQkJ
ZW5jb2Rlci0+YnJpZGdlLm5leHQgPSBOVUxMOwogCX0gZWxzZSB7CiAJCWludCByZXQgPSBleHlu
b3NfZHNpX2NyZWF0ZV9jb25uZWN0b3IoZW5jb2Rlcik7CiAKQEAgLTE1NjksNyArMTU4NSw4IEBA
IHN0YXRpYyBpbnQgZXh5bm9zX2RzaV9ob3N0X2RldGFjaChzdHJ1Y3QgbWlwaV9kc2lfaG9zdCAq
aG9zdCwKIAogCWlmIChkc2ktPnBhbmVsKSB7CiAJCW11dGV4X2xvY2soJmRybS0+bW9kZV9jb25m
aWcubXV0ZXgpOwotCQlleHlub3NfZHNpX2Rpc2FibGUoJmRzaS0+ZW5jb2Rlcik7CisJCWV4eW5v
c19kc2lfZGlzYWJsZSgmZHNpLT5lbmNvZGVyLmJyaWRnZSk7CisJCWV4eW5vc19kc2lfcG9zdF9k
aXNhYmxlKCZkc2ktPmVuY29kZXIuYnJpZGdlKTsKIAkJZHJtX3BhbmVsX2RldGFjaChkc2ktPnBh
bmVsKTsKIAkJZHNpLT5wYW5lbCA9IE5VTEw7CiAJCWRzaS0+Y29ubmVjdG9yLnN0YXR1cyA9IGNv
bm5lY3Rvcl9zdGF0dXNfZGlzY29ubmVjdGVkOwpAQCAtMTY3NCwxMSArMTY5MSwxMCBAQCBzdGF0
aWMgaW50IGV4eW5vc19kc2lfYmluZChzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBkZXZpY2Ug
Km1hc3RlciwKIAlzdHJ1Y3QgZHJtX2JyaWRnZSAqaW5fYnJpZGdlOwogCWludCByZXQ7CiAKKwll
bmNvZGVyLT5icmlkZ2UuZnVuY3MgPSAmZXh5bm9zX2RzaV9icmlkZ2VfZnVuY3M7CiAJZHJtX2Vu
Y29kZXJfaW5pdChkcm1fZGV2LCBlbmNvZGVyLCAmZXh5bm9zX2RzaV9lbmNvZGVyX2Z1bmNzLAog
CQkJIERSTV9NT0RFX0VOQ09ERVJfVE1EUywgTlVMTCk7CiAKLQlkcm1fZW5jb2Rlcl9oZWxwZXJf
YWRkKGVuY29kZXIsICZleHlub3NfZHNpX2VuY29kZXJfaGVscGVyX2Z1bmNzKTsKLQogCXJldCA9
IGV4eW5vc19kcm1fc2V0X3Bvc3NpYmxlX2NydGNzKGVuY29kZXIsIEVYWU5PU19ESVNQTEFZX1RZ
UEVfTENEKTsKIAlpZiAocmV0IDwgMCkKIAkJcmV0dXJuIHJldDsKQEAgLTE2OTgsNyArMTcxNCw4
IEBAIHN0YXRpYyB2b2lkIGV4eW5vc19kc2lfdW5iaW5kKHN0cnVjdCBkZXZpY2UgKmRldiwgc3Ry
dWN0IGRldmljZSAqbWFzdGVyLAogCXN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlciA9IGRldl9n
ZXRfZHJ2ZGF0YShkZXYpOwogCXN0cnVjdCBleHlub3NfZHNpICpkc2kgPSBlbmNvZGVyX3RvX2Rz
aShlbmNvZGVyKTsKIAotCWV4eW5vc19kc2lfZGlzYWJsZShlbmNvZGVyKTsKKwlleHlub3NfZHNp
X2Rpc2FibGUoJmVuY29kZXItPmJyaWRnZSk7CisJZXh5bm9zX2RzaV9wb3N0X2Rpc2FibGUoJmVu
Y29kZXItPmJyaWRnZSk7CiAKIAltaXBpX2RzaV9ob3N0X3VucmVnaXN0ZXIoJmRzaS0+ZHNpX2hv
c3QpOwogfQotLSAKMi4yMS4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVz
a3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9k
cmktZGV2ZWw=
