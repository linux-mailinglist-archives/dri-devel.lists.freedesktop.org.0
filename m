Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 52D47FE844
	for <lists+dri-devel@lfdr.de>; Fri, 15 Nov 2019 23:47:11 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7A24A6E0DE;
	Fri, 15 Nov 2019 22:47:07 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from NAM03-CO1-obe.outbound.protection.outlook.com
 (mail-eopbgr790045.outbound.protection.outlook.com [40.107.79.45])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9BE946E0DE;
 Fri, 15 Nov 2019 22:47:05 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=ZJeqr0XJkAZ+s0RYw+/TGeBv2rIL3XuPP68R8njbKDJRoBJRdmRlC8BEwW9c5I4bgFfQvFvR4IZiKeqIIL/v7+hLdlgOrRvzxNP7T6Mnl363b0pjsV1PPXMZoIkHv0aNBK136oRfL56u4P0YeNv1hrAtTHF0JE6sxsN/SzQUI+UBw/Ukk80x53qemP8mS0He4ABIVk8gDwmM63XeI5uWh8VNqK/fLusYpJq9Hwp6DeNG7+AIcNtvDws4sKAQippPfB5YlDYPvqkX05+t8teRoj0N3psy6x4X3N+j0yknkgRxkEKPNyKHwaapsUiqFm664UatrpfmFf2sKQ3L8fXJ0A==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=mmguGQ4NRWhRXPGr4vPry7gawL6PPvTQVd8SD1om9ig=;
 b=gddf9wdq4ykHvUmm4B3kkOfsz778K2qurPryXjG6+nUjSlyNOy0eg+xIKFJkCCUCav8R4gW6qfR2igdmlistGU5LtnOu+WPbNqF4156vkKbq4Pzxi5Zes1ZjOUEtLi8ATXJGc9DtbfpQhfcUr68Mexwl8Am3T+A1snNwcIaW4X+kH/Ze/9HeNwVYAPYS/hObD+wiuRF8bhpSOcCzB0iBpgUdwF39HnwWLo4TqVlueK6grvv+0ANA9j/OQ3NHlGTpPYSS6v5yP7wO0aNZlevCSsA6vIY8uscoiSeTVfu1brpxNkkp/guaxRmmquaqFgJcLrtINNPGvBHIVOyDfTW1DA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
Received: from MN2PR12MB3949.namprd12.prod.outlook.com (10.255.237.150) by
 MN2PR12MB3326.namprd12.prod.outlook.com (20.178.242.204) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2451.23; Fri, 15 Nov 2019 22:47:03 +0000
Received: from MN2PR12MB3949.namprd12.prod.outlook.com
 ([fe80::49f3:af31:eb8e:569b]) by MN2PR12MB3949.namprd12.prod.outlook.com
 ([fe80::49f3:af31:eb8e:569b%4]) with mapi id 15.20.2451.029; Fri, 15 Nov 2019
 22:47:03 +0000
Subject: Re: [PATCH 3/4] drm/ttm: rework BO delayed delete.
To: =?UTF-8?Q?Christian_K=c3=b6nig?= <ckoenig.leichtzumerken@gmail.com>,
 Kevin1.Wang@amd.com, dri-devel@lists.freedesktop.org,
 amd-gfx@lists.freedesktop.org
References: <20191111145832.37320-1-christian.koenig@amd.com>
 <20191111145832.37320-3-christian.koenig@amd.com>
From: Felix Kuehling <felix.kuehling@amd.com>
Organization: AMD Inc.
Message-ID: <fe2c72fe-610b-af0e-9d16-3ee0b44b2a55@amd.com>
Date: Fri, 15 Nov 2019 17:47:01 -0500
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.9.0
In-Reply-To: <20191111145832.37320-3-christian.koenig@amd.com>
Content-Language: en-US
X-ClientProxiedBy: YTBPR01CA0029.CANPRD01.PROD.OUTLOOK.COM
 (2603:10b6:b01:14::42) To MN2PR12MB3949.namprd12.prod.outlook.com
 (2603:10b6:208:167::22)
MIME-Version: 1.0
X-Originating-IP: [165.204.55.251]
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-HT: Tenant
X-MS-Office365-Filtering-Correlation-Id: 42ea8a44-1c52-4c34-1d6c-08d76a1dbb75
X-MS-TrafficTypeDiagnostic: MN2PR12MB3326:
X-MS-Exchange-Transport-Forked: True
X-Microsoft-Antispam-PRVS: <MN2PR12MB3326434E3EC13A593A52164F92700@MN2PR12MB3326.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:6430;
X-Forefront-PRVS: 02229A4115
X-Forefront-Antispam-Report: SFV:NSPM;
 SFS:(10009020)(979002)(4636009)(376002)(346002)(39860400002)(366004)(136003)(396003)(199004)(189003)(14454004)(81166006)(3846002)(478600001)(81156014)(316002)(86362001)(31696002)(66476007)(6486002)(6436002)(6512007)(50466002)(8936002)(6116002)(5660300002)(14444005)(8676002)(99286004)(66574012)(36756003)(66556008)(30864003)(58126008)(4001150100001)(65956001)(229853002)(7736002)(66066001)(36916002)(52116002)(2486003)(23676004)(25786009)(65806001)(305945005)(2906002)(66946007)(2870700001)(31686004)(47776003)(26005)(11346002)(476003)(446003)(6246003)(186003)(386003)(6506007)(2616005)(44832011)(486006)(76176011)(53546011)(969003)(989001)(999001)(1009001)(1019001);
 DIR:OUT; SFP:1101; SCL:1; SRVR:MN2PR12MB3326;
 H:MN2PR12MB3949.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
Received-SPF: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: 6LiICO/JfSjFnvEp5c9LPbS7Bjkm2gZaOB7Jpxj7sudVEYWXq8a/NYMJ76OuunSeZ8Q3uV6Gncb8KFyW8CurSqcvqgMLyvoBh+dlFnGcCgMiQ7x5jlzMzUdFxcPkysD4jb0rR4UB3FcrT1kOaw6WKFn+e6KJ4dp0DXwAumTqIumbH6cUUujtCOJrGtdwVDzGNvtqJ8CHMcqSZEpqY6CP2HUiKGyZNjD4NdFaLsWx1KtX3T3Cj/Da3htT/A363zmeB/ZHDC3NOUk6SUGn/w1GJDhUZmR6quwB8Oliox/TpAdidIMpWr7L1RwRhflcFfQ7VTa9iqgK+Lqrs0RVg9uXyDE6abzdlko0Z0ULc6Dr86tt2FPrAo7AF3Bgcvbiy4+fA3tTVg7YhAc4eAYCW5EmqWGXHfqK2BQjRZBEx3pTAIE3DwOjGh3iB2l4mBzNCcd5
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 42ea8a44-1c52-4c34-1d6c-08d76a1dbb75
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 15 Nov 2019 22:47:03.0763 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: caKDG/V3qsbRha2HfYcEYojZGTdXTujJkxiq0rrVHhC+L+kO5CWpBN7UaXhRn3ViBPBH4XQSyRsK4LgbT3QmJA==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: MN2PR12MB3326
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=mmguGQ4NRWhRXPGr4vPry7gawL6PPvTQVd8SD1om9ig=;
 b=3ZA2pYdB9ag3bbGVTA8wvX4eX3RBaf3RtnnecGvLuj/W7KmNrH0KgfgRfYnhpbiL8gLNHhRXe1dBfU1nKWxzYAHGZChmGZks2VAyhw7KvTbRPDHJsGrUyjsxm5Xrc/4tQqrokRaiUlqBu3iYQd3jgnnxXhzmv4H61mXWvi1KqnU=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Felix.Kuehling@amd.com; 
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gMjAxOS0xMS0xMSA5OjU4IGEubS4sIENocmlzdGlhbiBLw7ZuaWcgd3JvdGU6Cj4gVGhpcyBw
YXRjaCByZXdvcmtzIHRoZSB3aG9sZSBkZWxheWVkIGRlbGV0aW9uIG9mIEJPcyB3aGljaCBhcmVu
J3QgaWRsZS4KPgo+IEluc3RlYWQgb2YgaGF2aW5nIHR3byBjb3VudGVycyBmb3IgdGhlIEJPIHN0
cnVjdHVyZSB3ZSByZXN1cnJlY3QgdGhlIEJPCj4gd2hlbiB3ZSBmaW5kIHRoYXQgYSBkZWxldGVk
IEJPIGlzIG5vdCBpZGxlIHlldC4KPgo+IFRoaXMgaGFzIG1hbnkgYWR2YW50YWdlcywgZXNwZWNp
YWxseSB0aGF0IHdlIGRvbid0IG5lZWQgdG8KPiBpbmNyZW1lbnQvZGVjcmVtZW50IHRoZSBCT3Mg
cmVmZXJlbmNlIGNvdW50ZXIgYW55IG1vcmUgd2hlbiBpdAo+IG1vdmVzIG9uIHRoZSBMUlVzLgo+
Cj4gU2lnbmVkLW9mZi1ieTogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0aWFuLmtvZW5pZ0BhbWQu
Y29tPgoKSSByZXZpZXdlZCBpdCBmYWlybHkgdGhvcm91Z2hseSBhbmQgY291bGRuJ3QgZmluZCBh
bnl0aGluZyB3cm9uZy4gQnV0IEkgCmRvbid0IGtub3cgdGhpcyBjb2RlIHdlbGwgZW5vdWdoLCBp
bmNsdWRpbmcgYWxsIHRoZSBpbXBsaWNhdGlvbnMgb2YgYWxsIAp0aGUgY2FsbHMgYmVpbmcgbW92
ZWQgYXJvdW5kLCB0byBnaXZlIGEgY29uZmlkZW50IFItYi4KCkFja2VkLWJ5OiBGZWxpeCBLdWVo
bGluZyA8RmVsaXguS3VlaGxpbmc+CgoKPiAtLS0KPiAgIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRt
X2JvLmMgICAgICB8IDIxNSArKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0KPiAgIGRyaXZl
cnMvZ3B1L2RybS90dG0vdHRtX2JvX3V0aWwuYyB8ICAgMSAtCj4gICBpbmNsdWRlL2RybS90dG0v
dHRtX2JvX2FwaS5oICAgICAgfCAgMTEgKy0KPiAgIDMgZmlsZXMgY2hhbmdlZCwgOTcgaW5zZXJ0
aW9ucygrKSwgMTMwIGRlbGV0aW9ucygtKQo+Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS90dG0vdHRtX2JvLmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5jCj4gaW5kZXggMTE3
ODk4MGY0MTQ3Li41NzBiMGUxMDg5YjcgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0
bS90dG1fYm8uYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvLmMKPiBAQCAtMTQ1
LDI2ICsxNDUsNiBAQCBzdGF0aWMgaW5saW5lIHVpbnQzMl90IHR0bV9ib190eXBlX2ZsYWdzKHVu
c2lnbmVkIHR5cGUpCj4gICAJcmV0dXJuIDEgPDwgKHR5cGUpOwo+ICAgfQo+ICAgCj4gLXN0YXRp
YyB2b2lkIHR0bV9ib19yZWxlYXNlX2xpc3Qoc3RydWN0IGtyZWYgKmxpc3Rfa3JlZikKPiAtewo+
IC0Jc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibyA9Cj4gLQkgICAgY29udGFpbmVyX29mKGxp
c3Rfa3JlZiwgc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0LCBsaXN0X2tyZWYpOwo+IC0Jc2l6ZV90
IGFjY19zaXplID0gYm8tPmFjY19zaXplOwo+IC0KPiAtCUJVR19PTihrcmVmX3JlYWQoJmJvLT5s
aXN0X2tyZWYpKTsKPiAtCUJVR19PTihrcmVmX3JlYWQoJmJvLT5rcmVmKSk7Cj4gLQlCVUdfT04o
Ym8tPm1lbS5tbV9ub2RlICE9IE5VTEwpOwo+IC0JQlVHX09OKCFsaXN0X2VtcHR5KCZiby0+bHJ1
KSk7Cj4gLQlCVUdfT04oIWxpc3RfZW1wdHkoJmJvLT5kZGVzdHJveSkpOwo+IC0JdHRtX3R0X2Rl
c3Ryb3koYm8tPnR0bSk7Cj4gLQlhdG9taWNfZGVjKCZ0dG1fYm9fZ2xvYi5ib19jb3VudCk7Cj4g
LQlkbWFfZmVuY2VfcHV0KGJvLT5tb3ZpbmcpOwo+IC0JaWYgKCF0dG1fYm9fdXNlc19lbWJlZGRl
ZF9nZW1fb2JqZWN0KGJvKSkKPiAtCQlkbWFfcmVzdl9maW5pKCZiby0+YmFzZS5fcmVzdik7Cj4g
LQliby0+ZGVzdHJveShibyk7Cj4gLQl0dG1fbWVtX2dsb2JhbF9mcmVlKCZ0dG1fbWVtX2dsb2Is
IGFjY19zaXplKTsKPiAtfQo+IC0KPiAgIHN0YXRpYyB2b2lkIHR0bV9ib19hZGRfbWVtX3RvX2xy
dShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAo+ICAgCQkJCSAgc3RydWN0IHR0bV9tZW1f
cmVnICptZW0pCj4gICB7Cj4gQEAgLTE4MSwyMSArMTYxLDE0IEBAIHN0YXRpYyB2b2lkIHR0bV9i
b19hZGRfbWVtX3RvX2xydShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAo+ICAgCj4gICAJ
bWFuID0gJmJkZXYtPm1hblttZW0tPm1lbV90eXBlXTsKPiAgIAlsaXN0X2FkZF90YWlsKCZiby0+
bHJ1LCAmbWFuLT5scnVbYm8tPnByaW9yaXR5XSk7Cj4gLQlrcmVmX2dldCgmYm8tPmxpc3Rfa3Jl
Zik7Cj4gICAKPiAgIAlpZiAoIShtYW4tPmZsYWdzICYgVFRNX01FTVRZUEVfRkxBR19GSVhFRCkg
JiYgYm8tPnR0bSAmJgo+ICAgCSAgICAhKGJvLT50dG0tPnBhZ2VfZmxhZ3MgJiAoVFRNX1BBR0Vf
RkxBR19TRyB8Cj4gICAJCQkJICAgICBUVE1fUEFHRV9GTEFHX1NXQVBQRUQpKSkgewo+ICAgCQls
aXN0X2FkZF90YWlsKCZiby0+c3dhcCwgJnR0bV9ib19nbG9iLnN3YXBfbHJ1W2JvLT5wcmlvcml0
eV0pOwo+IC0JCWtyZWZfZ2V0KCZiby0+bGlzdF9rcmVmKTsKPiAgIAl9Cj4gICB9Cj4gICAKPiAt
c3RhdGljIHZvaWQgdHRtX2JvX3JlZl9idWcoc3RydWN0IGtyZWYgKmxpc3Rfa3JlZikKPiAtewo+
IC0JQlVHKCk7Cj4gLX0KPiAtCj4gICBzdGF0aWMgdm9pZCB0dG1fYm9fZGVsX2Zyb21fbHJ1KHN0
cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8pCj4gICB7Cj4gICAJc3RydWN0IHR0bV9ib19kZXZp
Y2UgKmJkZXYgPSBiby0+YmRldjsKPiBAQCAtMjAzLDEyICsxNzYsMTAgQEAgc3RhdGljIHZvaWQg
dHRtX2JvX2RlbF9mcm9tX2xydShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvKQo+ICAgCj4g
ICAJaWYgKCFsaXN0X2VtcHR5KCZiby0+c3dhcCkpIHsKPiAgIAkJbGlzdF9kZWxfaW5pdCgmYm8t
PnN3YXApOwo+IC0JCWtyZWZfcHV0KCZiby0+bGlzdF9rcmVmLCB0dG1fYm9fcmVmX2J1Zyk7Cj4g
ICAJCW5vdGlmeSA9IHRydWU7Cj4gICAJfQo+ICAgCWlmICghbGlzdF9lbXB0eSgmYm8tPmxydSkp
IHsKPiAgIAkJbGlzdF9kZWxfaW5pdCgmYm8tPmxydSk7Cj4gLQkJa3JlZl9wdXQoJmJvLT5saXN0
X2tyZWYsIHR0bV9ib19yZWZfYnVnKTsKPiAgIAkJbm90aWZ5ID0gdHJ1ZTsKPiAgIAl9Cj4gICAK
PiBAQCAtNDQ2LDc0ICs0MTcsMTcgQEAgc3RhdGljIHZvaWQgdHRtX2JvX2ZsdXNoX2FsbF9mZW5j
ZXMoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibykKPiAgIAkJZG1hX2ZlbmNlX2VuYWJsZV9z
d19zaWduYWxpbmcoZmVuY2UpOwo+ICAgCj4gICAJZm9yIChpID0gMDsgZm9iaiAmJiBpIDwgZm9i
ai0+c2hhcmVkX2NvdW50OyArK2kpIHsKPiAtCQlmZW5jZSA9IHJjdV9kZXJlZmVyZW5jZV9wcm90
ZWN0ZWQoZm9iai0+c2hhcmVkW2ldLAo+IC0JCQkJCWRtYV9yZXN2X2hlbGQoYm8tPmJhc2UucmVz
dikpOwo+ICsJCWZlbmNlID0gcmN1X2RlcmVmZXJlbmNlX3Byb3RlY3RlZChmb2JqLT5zaGFyZWRb
aV0sIHRydWUpOwo+ICAgCj4gICAJCWlmICghZmVuY2UtPm9wcy0+c2lnbmFsZWQpCj4gICAJCQlk
bWFfZmVuY2VfZW5hYmxlX3N3X3NpZ25hbGluZyhmZW5jZSk7Cj4gICAJfQo+ICAgfQo+ICAgCj4g
LXN0YXRpYyB2b2lkIHR0bV9ib19jbGVhbnVwX3JlZnNfb3JfcXVldWUoc3RydWN0IHR0bV9idWZm
ZXJfb2JqZWN0ICpibykKPiAtewo+IC0Jc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYgPSBiby0+
YmRldjsKPiAtCWludCByZXQ7Cj4gLQo+IC0JcmV0ID0gdHRtX2JvX2luZGl2aWR1YWxpemVfcmVz
dihibyk7Cj4gLQlpZiAocmV0KSB7Cj4gLQkJLyogTGFzdCByZXNvcnQsIGlmIHdlIGZhaWwgdG8g
YWxsb2NhdGUgbWVtb3J5IGZvciB0aGUKPiAtCQkgKiBmZW5jZXMgYmxvY2sgZm9yIHRoZSBCTyB0
byBiZWNvbWUgaWRsZQo+IC0JCSAqLwo+IC0JCWRtYV9yZXN2X3dhaXRfdGltZW91dF9yY3UoYm8t
PmJhc2UucmVzdiwgdHJ1ZSwgZmFsc2UsCj4gLQkJCQkJCSAgICAzMCAqIEhaKTsKPiAtCQlzcGlu
X2xvY2soJnR0bV9ib19nbG9iLmxydV9sb2NrKTsKPiAtCQlnb3RvIGVycm9yOwo+IC0JfQo+IC0K
PiAtCXNwaW5fbG9jaygmdHRtX2JvX2dsb2IubHJ1X2xvY2spOwo+IC0JcmV0ID0gZG1hX3Jlc3Zf
dHJ5bG9jayhiby0+YmFzZS5yZXN2KSA/IDAgOiAtRUJVU1k7Cj4gLQlpZiAoIXJldCkgewo+IC0J
CWlmIChkbWFfcmVzdl90ZXN0X3NpZ25hbGVkX3JjdSgmYm8tPmJhc2UuX3Jlc3YsIHRydWUpKSB7
Cj4gLQkJCXR0bV9ib19kZWxfZnJvbV9scnUoYm8pOwo+IC0JCQlzcGluX3VubG9jaygmdHRtX2Jv
X2dsb2IubHJ1X2xvY2spOwo+IC0JCQlpZiAoYm8tPmJhc2UucmVzdiAhPSAmYm8tPmJhc2UuX3Jl
c3YpCj4gLQkJCQlkbWFfcmVzdl91bmxvY2soJmJvLT5iYXNlLl9yZXN2KTsKPiAtCj4gLQkJCXR0
bV9ib19jbGVhbnVwX21lbXR5cGVfdXNlKGJvKTsKPiAtCQkJZG1hX3Jlc3ZfdW5sb2NrKGJvLT5i
YXNlLnJlc3YpOwo+IC0JCQlyZXR1cm47Cj4gLQkJfQo+IC0KPiAtCQl0dG1fYm9fZmx1c2hfYWxs
X2ZlbmNlcyhibyk7Cj4gLQo+IC0JCS8qCj4gLQkJICogTWFrZSBOT19FVklDVCBib3MgaW1tZWRp
YXRlbHkgYXZhaWxhYmxlIHRvCj4gLQkJICogc2hyaW5rZXJzLCBub3cgdGhhdCB0aGV5IGFyZSBx
dWV1ZWQgZm9yCj4gLQkJICogZGVzdHJ1Y3Rpb24uCj4gLQkJICovCj4gLQkJaWYgKGJvLT5tZW0u
cGxhY2VtZW50ICYgVFRNX1BMX0ZMQUdfTk9fRVZJQ1QpIHsKPiAtCQkJYm8tPm1lbS5wbGFjZW1l
bnQgJj0gflRUTV9QTF9GTEFHX05PX0VWSUNUOwo+IC0JCQl0dG1fYm9fbW92ZV90b19scnVfdGFp
bChibywgTlVMTCk7Cj4gLQkJfQo+IC0KPiAtCQlkbWFfcmVzdl91bmxvY2soYm8tPmJhc2UucmVz
dik7Cj4gLQl9Cj4gLQlpZiAoYm8tPmJhc2UucmVzdiAhPSAmYm8tPmJhc2UuX3Jlc3YpCj4gLQkJ
ZG1hX3Jlc3ZfdW5sb2NrKCZiby0+YmFzZS5fcmVzdik7Cj4gLQo+IC1lcnJvcjoKPiAtCWtyZWZf
Z2V0KCZiby0+bGlzdF9rcmVmKTsKPiAtCWxpc3RfYWRkX3RhaWwoJmJvLT5kZGVzdHJveSwgJmJk
ZXYtPmRkZXN0cm95KTsKPiAtCXNwaW5fdW5sb2NrKCZ0dG1fYm9fZ2xvYi5scnVfbG9jayk7Cj4g
LQo+IC0Jc2NoZWR1bGVfZGVsYXllZF93b3JrKCZiZGV2LT53cSwKPiAtCQkJICAgICAgKChIWiAv
IDEwMCkgPCAxKSA/IDEgOiBIWiAvIDEwMCk7Cj4gLX0KPiAtCj4gICAvKioKPiAgICAqIGZ1bmN0
aW9uIHR0bV9ib19jbGVhbnVwX3JlZnMKPiAtICogSWYgYm8gaWRsZSwgcmVtb3ZlIGZyb20gZGVs
YXllZC0gYW5kIGxydSBsaXN0cywgYW5kIHVucmVmLgo+IC0gKiBJZiBub3QgaWRsZSwgZG8gbm90
aGluZy4KPiArICogSWYgYm8gaWRsZSwgcmVtb3ZlIGZyb20gbHJ1IGxpc3RzLCBhbmQgdW5yZWYu
Cj4gKyAqIElmIG5vdCBpZGxlLCBibG9jayBpZiBwb3NzaWJsZS4KPiAgICAqCj4gICAgKiBNdXN0
IGJlIGNhbGxlZCB3aXRoIGxydV9sb2NrIGFuZCByZXNlcnZhdGlvbiBoZWxkLCB0aGlzIGZ1bmN0
aW9uCj4gICAgKiB3aWxsIGRyb3AgdGhlIGxydSBsb2NrIGFuZCBvcHRpb25hbGx5IHRoZSByZXNl
cnZhdGlvbiBsb2NrIGJlZm9yZSByZXR1cm5pbmcuCj4gQEAgLTU3NSwxNCArNDg5LDE0IEBAIHN0
YXRpYyBpbnQgdHRtX2JvX2NsZWFudXBfcmVmcyhzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJv
LAo+ICAgCj4gICAJdHRtX2JvX2RlbF9mcm9tX2xydShibyk7Cj4gICAJbGlzdF9kZWxfaW5pdCgm
Ym8tPmRkZXN0cm95KTsKPiAtCWtyZWZfcHV0KCZiby0+bGlzdF9rcmVmLCB0dG1fYm9fcmVmX2J1
Zyk7Cj4gLQo+ICAgCXNwaW5fdW5sb2NrKCZ0dG1fYm9fZ2xvYi5scnVfbG9jayk7Cj4gICAJdHRt
X2JvX2NsZWFudXBfbWVtdHlwZV91c2UoYm8pOwo+ICAgCj4gICAJaWYgKHVubG9ja19yZXN2KQo+
ICAgCQlkbWFfcmVzdl91bmxvY2soYm8tPmJhc2UucmVzdik7Cj4gICAKPiArCXR0bV9ib19wdXQo
Ym8pOwo+ICsKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+IEBAIC02MDQsOCArNTE4LDkgQEAg
c3RhdGljIGJvb2wgdHRtX2JvX2RlbGF5ZWRfZGVsZXRlKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpi
ZGV2LCBib29sIHJlbW92ZV9hbGwpCj4gICAKPiAgIAkJYm8gPSBsaXN0X2ZpcnN0X2VudHJ5KCZi
ZGV2LT5kZGVzdHJveSwgc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0LAo+ICAgCQkJCSAgICAgIGRk
ZXN0cm95KTsKPiAtCQlrcmVmX2dldCgmYm8tPmxpc3Rfa3JlZik7Cj4gICAJCWxpc3RfbW92ZV90
YWlsKCZiby0+ZGRlc3Ryb3ksICZyZW1vdmVkKTsKPiArCQlpZiAoIXR0bV9ib19nZXRfdW5sZXNz
X3plcm8oYm8pKQo+ICsJCQljb250aW51ZTsKPiAgIAo+ICAgCQlpZiAocmVtb3ZlX2FsbCB8fCBi
by0+YmFzZS5yZXN2ICE9ICZiby0+YmFzZS5fcmVzdikgewo+ICAgCQkJc3Bpbl91bmxvY2soJmds
b2ItPmxydV9sb2NrKTsKPiBAQCAtNjIwLDcgKzUzNSw3IEBAIHN0YXRpYyBib29sIHR0bV9ib19k
ZWxheWVkX2RlbGV0ZShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwgYm9vbCByZW1vdmVfYWxs
KQo+ICAgCQkJc3Bpbl91bmxvY2soJmdsb2ItPmxydV9sb2NrKTsKPiAgIAkJfQo+ICAgCj4gLQkJ
a3JlZl9wdXQoJmJvLT5saXN0X2tyZWYsIHR0bV9ib19yZWxlYXNlX2xpc3QpOwo+ICsJCXR0bV9i
b19wdXQoYm8pOwo+ICAgCQlzcGluX2xvY2soJmdsb2ItPmxydV9sb2NrKTsKPiAgIAl9Cj4gICAJ
bGlzdF9zcGxpY2VfdGFpbCgmcmVtb3ZlZCwgJmJkZXYtPmRkZXN0cm95KTsKPiBAQCAtNjQ2LDE2
ICs1NjEsNjggQEAgc3RhdGljIHZvaWQgdHRtX2JvX3JlbGVhc2Uoc3RydWN0IGtyZWYgKmtyZWYp
Cj4gICAJICAgIGNvbnRhaW5lcl9vZihrcmVmLCBzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QsIGty
ZWYpOwo+ICAgCXN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2ID0gYm8tPmJkZXY7Cj4gICAJc3Ry
dWN0IHR0bV9tZW1fdHlwZV9tYW5hZ2VyICptYW4gPSAmYmRldi0+bWFuW2JvLT5tZW0ubWVtX3R5
cGVdOwo+ICsJc2l6ZV90IGFjY19zaXplID0gYm8tPmFjY19zaXplOwo+ICsJaW50IHJldDsKPiAg
IAo+IC0JaWYgKGJvLT5iZGV2LT5kcml2ZXItPnJlbGVhc2Vfbm90aWZ5KQo+IC0JCWJvLT5iZGV2
LT5kcml2ZXItPnJlbGVhc2Vfbm90aWZ5KGJvKTsKPiArCWlmICghYm8tPmRlbGV0ZWQpIHsKPiAr
CQlpZiAoYm8tPmJkZXYtPmRyaXZlci0+cmVsZWFzZV9ub3RpZnkpCj4gKwkJCWJvLT5iZGV2LT5k
cml2ZXItPnJlbGVhc2Vfbm90aWZ5KGJvKTsKPiAgIAo+IC0JZHJtX3ZtYV9vZmZzZXRfcmVtb3Zl
KGJkZXYtPnZtYV9tYW5hZ2VyLCAmYm8tPmJhc2Uudm1hX25vZGUpOwo+IC0JdHRtX21lbV9pb19s
b2NrKG1hbiwgZmFsc2UpOwo+IC0JdHRtX21lbV9pb19mcmVlX3ZtKGJvKTsKPiAtCXR0bV9tZW1f
aW9fdW5sb2NrKG1hbik7Cj4gLQl0dG1fYm9fY2xlYW51cF9yZWZzX29yX3F1ZXVlKGJvKTsKPiAt
CWtyZWZfcHV0KCZiby0+bGlzdF9rcmVmLCB0dG1fYm9fcmVsZWFzZV9saXN0KTsKPiArCQlkcm1f
dm1hX29mZnNldF9yZW1vdmUoYmRldi0+dm1hX21hbmFnZXIsICZiby0+YmFzZS52bWFfbm9kZSk7
Cj4gKwkJdHRtX21lbV9pb19sb2NrKG1hbiwgZmFsc2UpOwo+ICsJCXR0bV9tZW1faW9fZnJlZV92
bShibyk7Cj4gKwkJdHRtX21lbV9pb191bmxvY2sobWFuKTsKPiArCj4gKwkJcmV0ID0gdHRtX2Jv
X2luZGl2aWR1YWxpemVfcmVzdihibyk7Cj4gKwkJaWYgKHJldCkgewo+ICsJCQkvKiBMYXN0IHJl
c29ydCwgaWYgd2UgZmFpbCB0byBhbGxvY2F0ZSBtZW1vcnkgZm9yIHRoZQo+ICsJCQkgKiBmZW5j
ZXMgYmxvY2sgZm9yIHRoZSBCTyB0byBiZWNvbWUgaWRsZQo+ICsJCQkgKi8KPiArCQkJZG1hX3Jl
c3Zfd2FpdF90aW1lb3V0X3JjdShiby0+YmFzZS5yZXN2LCB0cnVlLCBmYWxzZSwKPiArCQkJCQkJ
ICAzMCAqIEhaKTsKPiArCQl9Cj4gKwl9Cj4gKwo+ICsJaWYgKCFkbWFfcmVzdl90ZXN0X3NpZ25h
bGVkX3JjdShiby0+YmFzZS5yZXN2LCB0cnVlKSkgewo+ICsJCS8qIFRoZSBCTyBpcyBub3QgaWRs
ZSwgcmVzdXJyZWN0IGl0IGZvciBkZWxheWVkIGRlc3Ryb3kgKi8KPiArCQl0dG1fYm9fZmx1c2hf
YWxsX2ZlbmNlcyhibyk7Cj4gKwkJYm8tPmRlbGV0ZWQgPSB0cnVlOwo+ICsKPiArCQkvKgo+ICsJ
CSAqIE1ha2UgTk9fRVZJQ1QgYm9zIGltbWVkaWF0ZWx5IGF2YWlsYWJsZSB0bwo+ICsJCSAqIHNo
cmlua2Vycywgbm93IHRoYXQgdGhleSBhcmUgcXVldWVkIGZvcgo+ICsJCSAqIGRlc3RydWN0aW9u
Lgo+ICsJCSAqLwo+ICsJCWlmIChiby0+bWVtLnBsYWNlbWVudCAmIFRUTV9QTF9GTEFHX05PX0VW
SUNUKSB7Cj4gKwkJCWJvLT5tZW0ucGxhY2VtZW50ICY9IH5UVE1fUExfRkxBR19OT19FVklDVDsK
PiArCQkJdHRtX2JvX21vdmVfdG9fbHJ1X3RhaWwoYm8sIE5VTEwpOwo+ICsJCX0KPiArCj4gKwkJ
c3Bpbl9sb2NrKCZ0dG1fYm9fZ2xvYi5scnVfbG9jayk7Cj4gKwkJa3JlZl9pbml0KCZiby0+a3Jl
Zik7Cj4gKwkJbGlzdF9hZGRfdGFpbCgmYm8tPmRkZXN0cm95LCAmYmRldi0+ZGRlc3Ryb3kpOwo+
ICsJCXNwaW5fdW5sb2NrKCZ0dG1fYm9fZ2xvYi5scnVfbG9jayk7Cj4gKwo+ICsJCXNjaGVkdWxl
X2RlbGF5ZWRfd29yaygmYmRldi0+d3EsCj4gKwkJCQkgICAgICAoKEhaIC8gMTAwKSA8IDEpID8g
MSA6IEhaIC8gMTAwKTsKPiArCQlyZXR1cm47Cj4gKwl9Cj4gKwo+ICsJc3Bpbl9sb2NrKCZ0dG1f
Ym9fZ2xvYi5scnVfbG9jayk7Cj4gKwl0dG1fYm9fZGVsX2Zyb21fbHJ1KGJvKTsKPiArCWxpc3Rf
ZGVsKCZiby0+ZGRlc3Ryb3kpOwo+ICsJc3Bpbl91bmxvY2soJnR0bV9ib19nbG9iLmxydV9sb2Nr
KTsKPiArCj4gKwl0dG1fYm9fY2xlYW51cF9tZW10eXBlX3VzZShibyk7Cj4gKwo+ICsJQlVHX09O
KGJvLT5tZW0ubW1fbm9kZSAhPSBOVUxMKTsKPiArCXR0bV90dF9kZXN0cm95KGJvLT50dG0pOwo+
ICsJYXRvbWljX2RlYygmdHRtX2JvX2dsb2IuYm9fY291bnQpOwo+ICsJZG1hX2ZlbmNlX3B1dChi
by0+bW92aW5nKTsKPiArCWlmICghdHRtX2JvX3VzZXNfZW1iZWRkZWRfZ2VtX29iamVjdChibykp
Cj4gKwkJZG1hX3Jlc3ZfZmluaSgmYm8tPmJhc2UuX3Jlc3YpOwo+ICsJYm8tPmRlc3Ryb3koYm8p
Owo+ICsJdHRtX21lbV9nbG9iYWxfZnJlZSgmdHRtX21lbV9nbG9iLCBhY2Nfc2l6ZSk7Cj4gICB9
Cj4gICAKPiAgIHZvaWQgdHRtX2JvX3B1dChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvKQo+
IEBAIC03NTgsOCArNzI1LDcgQEAgc3RhdGljIGJvb2wgdHRtX2JvX2V2aWN0X3N3YXBvdXRfYWxs
b3dhYmxlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCj4gICAKPiAgIAlpZiAoYm8tPmJh
c2UucmVzdiA9PSBjdHgtPnJlc3YpIHsKPiAgIAkJZG1hX3Jlc3ZfYXNzZXJ0X2hlbGQoYm8tPmJh
c2UucmVzdik7Cj4gLQkJaWYgKGN0eC0+ZmxhZ3MgJiBUVE1fT1BUX0ZMQUdfQUxMT1dfUkVTX0VW
SUNUCj4gLQkJICAgIHx8ICFsaXN0X2VtcHR5KCZiby0+ZGRlc3Ryb3kpKQo+ICsJCWlmIChjdHgt
PmZsYWdzICYgVFRNX09QVF9GTEFHX0FMTE9XX1JFU19FVklDVCB8fCBiby0+ZGVsZXRlZCkKPiAg
IAkJCXJldCA9IHRydWU7Cj4gICAJCSpsb2NrZWQgPSBmYWxzZTsKPiAgIAkJaWYgKGJ1c3kpCj4g
QEAgLTg0MCw2ICs4MDYsMTEgQEAgc3RhdGljIGludCB0dG1fbWVtX2V2aWN0X2ZpcnN0KHN0cnVj
dCB0dG1fYm9fZGV2aWNlICpiZGV2LAo+ICAgCQkJCQlkbWFfcmVzdl91bmxvY2soYm8tPmJhc2Uu
cmVzdik7Cj4gICAJCQkJY29udGludWU7Cj4gICAJCQl9Cj4gKwkJCWlmICghdHRtX2JvX2dldF91
bmxlc3NfemVybyhibykpIHsKPiArCQkJCWlmIChsb2NrZWQpCj4gKwkJCQkJZG1hX3Jlc3ZfdW5s
b2NrKGJvLT5iYXNlLnJlc3YpOwo+ICsJCQkJY29udGludWU7Cj4gKwkJCX0KPiAgIAkJCWJyZWFr
Owo+ICAgCQl9Cj4gICAKPiBAQCAtODUxLDIxICs4MjIsMTkgQEAgc3RhdGljIGludCB0dG1fbWVt
X2V2aWN0X2ZpcnN0KHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAo+ICAgCX0KPiAgIAo+ICAg
CWlmICghYm8pIHsKPiAtCQlpZiAoYnVzeV9ibykKPiAtCQkJa3JlZl9nZXQoJmJ1c3lfYm8tPmxp
c3Rfa3JlZik7Cj4gKwkJaWYgKGJ1c3lfYm8gJiYgIXR0bV9ib19nZXRfdW5sZXNzX3plcm8oYnVz
eV9ibykpCj4gKwkJCWJ1c3lfYm8gPSBOVUxMOwo+ICAgCQlzcGluX3VubG9jaygmdHRtX2JvX2ds
b2IubHJ1X2xvY2spOwo+ICAgCQlyZXQgPSB0dG1fbWVtX2V2aWN0X3dhaXRfYnVzeShidXN5X2Jv
LCBjdHgsIHRpY2tldCk7Cj4gICAJCWlmIChidXN5X2JvKQo+IC0JCQlrcmVmX3B1dCgmYnVzeV9i
by0+bGlzdF9rcmVmLCB0dG1fYm9fcmVsZWFzZV9saXN0KTsKPiArCQkJdHRtX2JvX3B1dChidXN5
X2JvKTsKPiAgIAkJcmV0dXJuIHJldDsKPiAgIAl9Cj4gICAKPiAtCWtyZWZfZ2V0KCZiby0+bGlz
dF9rcmVmKTsKPiAtCj4gLQlpZiAoIWxpc3RfZW1wdHkoJmJvLT5kZGVzdHJveSkpIHsKPiArCWlm
IChiby0+ZGVsZXRlZCkgewo+ICAgCQlyZXQgPSB0dG1fYm9fY2xlYW51cF9yZWZzKGJvLCBjdHgt
PmludGVycnVwdGlibGUsCj4gICAJCQkJCSAgY3R4LT5ub193YWl0X2dwdSwgbG9ja2VkKTsKPiAt
CQlrcmVmX3B1dCgmYm8tPmxpc3Rfa3JlZiwgdHRtX2JvX3JlbGVhc2VfbGlzdCk7Cj4gKwkJdHRt
X2JvX3B1dChibyk7Cj4gICAJCXJldHVybiByZXQ7Cj4gICAJfQo+ICAgCj4gQEAgLTg3NSw3ICs4
NDQsNyBAQCBzdGF0aWMgaW50IHR0bV9tZW1fZXZpY3RfZmlyc3Qoc3RydWN0IHR0bV9ib19kZXZp
Y2UgKmJkZXYsCj4gICAJaWYgKGxvY2tlZCkKPiAgIAkJdHRtX2JvX3VucmVzZXJ2ZShibyk7Cj4g
ICAKPiAtCWtyZWZfcHV0KCZiby0+bGlzdF9rcmVmLCB0dG1fYm9fcmVsZWFzZV9saXN0KTsKPiAr
CXR0bV9ib19wdXQoYm8pOwo+ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4gICAKPiBAQCAtMTI3OSw3
ICsxMjQ4LDYgQEAgaW50IHR0bV9ib19pbml0X3Jlc2VydmVkKHN0cnVjdCB0dG1fYm9fZGV2aWNl
ICpiZGV2LAo+ICAgCWJvLT5kZXN0cm95ID0gZGVzdHJveSA/IGRlc3Ryb3kgOiB0dG1fYm9fZGVm
YXVsdF9kZXN0cm95Owo+ICAgCj4gICAJa3JlZl9pbml0KCZiby0+a3JlZik7Cj4gLQlrcmVmX2lu
aXQoJmJvLT5saXN0X2tyZWYpOwo+ICAgCUlOSVRfTElTVF9IRUFEKCZiby0+bHJ1KTsKPiAgIAlJ
TklUX0xJU1RfSEVBRCgmYm8tPmRkZXN0cm95KTsKPiAgIAlJTklUX0xJU1RfSEVBRCgmYm8tPnN3
YXApOwo+IEBAIC0xNzk5LDExICsxNzY3LDE4IEBAIGludCB0dG1fYm9fc3dhcG91dChzdHJ1Y3Qg
dHRtX2JvX2dsb2JhbCAqZ2xvYiwgc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4ICpjdHgpCj4gICAJ
c3Bpbl9sb2NrKCZnbG9iLT5scnVfbG9jayk7Cj4gICAJZm9yIChpID0gMDsgaSA8IFRUTV9NQVhf
Qk9fUFJJT1JJVFk7ICsraSkgewo+ICAgCQlsaXN0X2Zvcl9lYWNoX2VudHJ5KGJvLCAmZ2xvYi0+
c3dhcF9scnVbaV0sIHN3YXApIHsKPiAtCQkJaWYgKHR0bV9ib19ldmljdF9zd2Fwb3V0X2FsbG93
YWJsZShibywgY3R4LCAmbG9ja2VkLAo+IC0JCQkJCQkJICAgTlVMTCkpIHsKPiAtCQkJCXJldCA9
IDA7Cj4gLQkJCQlicmVhazsKPiArCQkJaWYgKCF0dG1fYm9fZXZpY3Rfc3dhcG91dF9hbGxvd2Fi
bGUoYm8sIGN0eCwgJmxvY2tlZCwKPiArCQkJCQkJCSAgICBOVUxMKSkKPiArCQkJCWNvbnRpbnVl
Owo+ICsKPiArCQkJaWYgKCF0dG1fYm9fZ2V0X3VubGVzc196ZXJvKGJvKSkgewo+ICsJCQkJaWYg
KGxvY2tlZCkKPiArCQkJCQlkbWFfcmVzdl91bmxvY2soYm8tPmJhc2UucmVzdik7Cj4gKwkJCQlj
b250aW51ZTsKPiAgIAkJCX0KPiArCj4gKwkJCXJldCA9IDA7Cj4gKwkJCWJyZWFrOwo+ICAgCQl9
Cj4gICAJCWlmICghcmV0KQo+ICAgCQkJYnJlYWs7Cj4gQEAgLTE4MTQsMTEgKzE3ODksOSBAQCBp
bnQgdHRtX2JvX3N3YXBvdXQoc3RydWN0IHR0bV9ib19nbG9iYWwgKmdsb2IsIHN0cnVjdCB0dG1f
b3BlcmF0aW9uX2N0eCAqY3R4KQo+ICAgCQlyZXR1cm4gcmV0Owo+ICAgCX0KPiAgIAo+IC0Ja3Jl
Zl9nZXQoJmJvLT5saXN0X2tyZWYpOwo+IC0KPiAtCWlmICghbGlzdF9lbXB0eSgmYm8tPmRkZXN0
cm95KSkgewo+ICsJaWYgKGJvLT5kZWxldGVkKSB7Cj4gICAJCXJldCA9IHR0bV9ib19jbGVhbnVw
X3JlZnMoYm8sIGZhbHNlLCBmYWxzZSwgbG9ja2VkKTsKPiAtCQlrcmVmX3B1dCgmYm8tPmxpc3Rf
a3JlZiwgdHRtX2JvX3JlbGVhc2VfbGlzdCk7Cj4gKwkJdHRtX2JvX3B1dChibyk7Cj4gICAJCXJl
dHVybiByZXQ7Cj4gICAJfQo+ICAgCj4gQEAgLTE4NzIsNyArMTg0NSw3IEBAIGludCB0dG1fYm9f
c3dhcG91dChzdHJ1Y3QgdHRtX2JvX2dsb2JhbCAqZ2xvYiwgc3RydWN0IHR0bV9vcGVyYXRpb25f
Y3R4ICpjdHgpCj4gICAJICovCj4gICAJaWYgKGxvY2tlZCkKPiAgIAkJZG1hX3Jlc3ZfdW5sb2Nr
KGJvLT5iYXNlLnJlc3YpOwo+IC0Ja3JlZl9wdXQoJmJvLT5saXN0X2tyZWYsIHR0bV9ib19yZWxl
YXNlX2xpc3QpOwo+ICsJdHRtX2JvX3B1dChibyk7Cj4gICAJcmV0dXJuIHJldDsKPiAgIH0KPiAg
IEVYUE9SVF9TWU1CT0wodHRtX2JvX3N3YXBvdXQpOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vdHRtL3R0bV9ib191dGlsLmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGls
LmMKPiBpbmRleCA4NmQxNTI0NzJmMzguLmM4ZTM1OWRlZDFkZiAxMDA2NDQKPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGlsLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vdHRt
L3R0bV9ib191dGlsLmMKPiBAQCAtNTA3LDcgKzUwNyw2IEBAIHN0YXRpYyBpbnQgdHRtX2J1ZmZl
cl9vYmplY3RfdHJhbnNmZXIoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKPiAgIAlmYm8t
PmJhc2UubW92aW5nID0gTlVMTDsKPiAgIAlkcm1fdm1hX25vZGVfcmVzZXQoJmZiby0+YmFzZS5i
YXNlLnZtYV9ub2RlKTsKPiAgIAo+IC0Ja3JlZl9pbml0KCZmYm8tPmJhc2UubGlzdF9rcmVmKTsK
PiAgIAlrcmVmX2luaXQoJmZiby0+YmFzZS5rcmVmKTsKPiAgIAlmYm8tPmJhc2UuZGVzdHJveSA9
ICZ0dG1fdHJhbnNmZXJlZF9kZXN0cm95Owo+ICAgCWZiby0+YmFzZS5hY2Nfc2l6ZSA9IDA7Cj4g
ZGlmZiAtLWdpdCBhL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmggYi9pbmNsdWRlL2RybS90
dG0vdHRtX2JvX2FwaS5oCj4gaW5kZXggNjZjYTQ5ZGI5NjMzLi5iOWJjMWIwMDE0MmUgMTAwNjQ0
Cj4gLS0tIGEvaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19hcGkuaAo+ICsrKyBiL2luY2x1ZGUvZHJt
L3R0bS90dG1fYm9fYXBpLmgKPiBAQCAtMTM1LDE4ICsxMzUsMTQgQEAgc3RydWN0IHR0bV90dDsK
PiAgICAqIEBudW1fcGFnZXM6IEFjdHVhbCBudW1iZXIgb2YgcGFnZXMuCj4gICAgKiBAYWNjX3Np
emU6IEFjY291bnRlZCBzaXplIGZvciB0aGlzIG9iamVjdC4KPiAgICAqIEBrcmVmOiBSZWZlcmVu
Y2UgY291bnQgb2YgdGhpcyBidWZmZXIgb2JqZWN0LiBXaGVuIHRoaXMgcmVmY291bnQgcmVhY2hl
cwo+IC0gKiB6ZXJvLCB0aGUgb2JqZWN0IGlzIHB1dCBvbiB0aGUgZGVsYXllZCBkZWxldGUgbGlz
dC4KPiAtICogQGxpc3Rfa3JlZjogTGlzdCByZWZlcmVuY2UgY291bnQgb2YgdGhpcyBidWZmZXIg
b2JqZWN0LiBUaGlzIG1lbWJlciBpcwo+IC0gKiB1c2VkIHRvIGF2b2lkIGRlc3RydWN0aW9uIHdo
aWxlIHRoZSBidWZmZXIgb2JqZWN0IGlzIHN0aWxsIG9uIGEgbGlzdC4KPiAtICogTHJ1IGxpc3Rz
IG1heSBrZWVwIG9uZSByZWZjb3VudCwgdGhlIGRlbGF5ZWQgZGVsZXRlIGxpc3QsIGFuZCBrcmVm
ICE9IDAKPiAtICoga2VlcHMgb25lIHJlZmNvdW50LiBXaGVuIHRoaXMgcmVmY291bnQgcmVhY2hl
cyB6ZXJvLAo+IC0gKiB0aGUgb2JqZWN0IGlzIGRlc3Ryb3llZC4KPiArICogemVybywgdGhlIG9i
amVjdCBpcyBkZXN0cm95ZWQgb3IgcHV0IG9uIHRoZSBkZWxheWVkIGRlbGV0ZSBsaXN0Lgo+ICAg
ICogQG1lbTogc3RydWN0dXJlIGRlc2NyaWJpbmcgY3VycmVudCBwbGFjZW1lbnQuCj4gICAgKiBA
cGVyc2lzdGVudF9zd2FwX3N0b3JhZ2U6IFVzdWFsbHkgdGhlIHN3YXAgc3RvcmFnZSBpcyBkZWxl
dGVkIGZvciBidWZmZXJzCj4gICAgKiBwaW5uZWQgaW4gcGh5c2ljYWwgbWVtb3J5LiBJZiB0aGlz
IGJlaGF2aW91ciBpcyBub3QgZGVzaXJlZCwgdGhpcyBtZW1iZXIKPiAgICAqIGhvbGRzIGEgcG9p
bnRlciB0byBhIHBlcnNpc3RlbnQgc2htZW0gb2JqZWN0Lgo+ICAgICogQHR0bTogVFRNIHN0cnVj
dHVyZSBob2xkaW5nIHN5c3RlbSBwYWdlcy4KPiAgICAqIEBldmljdGVkOiBXaGV0aGVyIHRoZSBv
YmplY3Qgd2FzIGV2aWN0ZWQgd2l0aG91dCB1c2VyLXNwYWNlIGtub3dpbmcuCj4gKyAqIEBkZWxl
dGVkOiBUcnVlIGlmIHRoZSBvYmplY3QgaXMgb25seSBhIHpvbWJpZSBhbmQgYWxyZWFkeSBkZWxl
dGVkLgo+ICAgICogQGxydTogTGlzdCBoZWFkIGZvciB0aGUgbHJ1IGxpc3QuCj4gICAgKiBAZGRl
c3Ryb3k6IExpc3QgaGVhZCBmb3IgdGhlIGRlbGF5ZWQgZGVzdHJveSBsaXN0Lgo+ICAgICogQHN3
YXA6IExpc3QgaGVhZCBmb3Igc3dhcCBMUlUgbGlzdC4KPiBAQCAtMTgzLDkgKzE3OSw3IEBAIHN0
cnVjdCB0dG1fYnVmZmVyX29iamVjdCB7Cj4gICAJLyoqCj4gICAJKiBNZW1iZXJzIG5vdCBuZWVk
aW5nIHByb3RlY3Rpb24uCj4gICAJKi8KPiAtCj4gICAJc3RydWN0IGtyZWYga3JlZjsKPiAtCXN0
cnVjdCBrcmVmIGxpc3Rfa3JlZjsKPiAgIAo+ICAgCS8qKgo+ICAgCSAqIE1lbWJlcnMgcHJvdGVj
dGVkIGJ5IHRoZSBibzo6cmVzdjo6cmVzZXJ2ZWQgbG9jay4KPiBAQCAtMTk1LDYgKzE4OSw3IEBA
IHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCB7Cj4gICAJc3RydWN0IGZpbGUgKnBlcnNpc3RlbnRf
c3dhcF9zdG9yYWdlOwo+ICAgCXN0cnVjdCB0dG1fdHQgKnR0bTsKPiAgIAlib29sIGV2aWN0ZWQ7
Cj4gKwlib29sIGRlbGV0ZWQ7Cj4gICAKPiAgIAkvKioKPiAgIAkgKiBNZW1iZXJzIHByb3RlY3Rl
ZCBieSB0aGUgYmRldjo6bHJ1X2xvY2suCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZy
ZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3Rp
bmZvL2RyaS1kZXZlbA==
