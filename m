Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id A30D69D21D
	for <lists+dri-devel@lfdr.de>; Mon, 26 Aug 2019 16:57:52 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3613A89FC9;
	Mon, 26 Aug 2019 14:57:44 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-wr1-x443.google.com (mail-wr1-x443.google.com
 [IPv6:2a00:1450:4864:20::443])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B667989F8E
 for <dri-devel@lists.freedesktop.org>; Mon, 26 Aug 2019 14:57:40 +0000 (UTC)
Received: by mail-wr1-x443.google.com with SMTP id y8so15614662wrn.10
 for <dri-devel@lists.freedesktop.org>; Mon, 26 Aug 2019 07:57:40 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=4YEZfHUEvfCRDVgXKCcRqJ5N1s+7+Mxi21IddmT3YB0=;
 b=lyZFUnFpGSsY+vA3qTqVJrd7dVvw8qUn3PKDXe5RzhJpiNCX5oIni3aywUM58Ec/Ei
 DfDHd29lleRXc33UZLTr54WG56hOP4EdHaPiSGxJJDO1pGtqEVfc3cj2RSLrgInZzwG/
 E8DtVnjbZsj4t5Oh1Wr13e5vW1aicgMV3ZnQXg0APbLt4MOy3Y6w9nHlsADno/9FGt4D
 sMM81uftrvnZGYIKVpiEV9FhqjxCMNBk8ynpdVCIhq4TdCHg9V+pCXznd0AaWvtWx0ah
 Eb9JdU7S4aqG1RNkXKamscGu8Y5AxJaHIjRSCUXkwV9slPvULWeqaYiLi6xWfo6vxcN3
 DVhg==
X-Gm-Message-State: APjAAAUyQzFZLOBJ8789cMbxYUiS0qniai7ZcY7pTHaz0eYiEenRdhGN
 jUGHj3OXGTj75S1226D1HCLFujc3
X-Google-Smtp-Source: APXvYqzzhFtpY7gybZ6/rOPnJ49h20BUn69Ku0z73CKGBtcr7lfWK1fGCP2+ui9VzVy0dp4n9LQg3g==
X-Received: by 2002:a5d:69c8:: with SMTP id s8mr21623643wrw.353.1566831458975; 
 Mon, 26 Aug 2019 07:57:38 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:b0e3:7a12:98e5:ca6])
 by smtp.gmail.com with ESMTPSA id z8sm9865624wmi.7.2019.08.26.07.57.38
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 26 Aug 2019 07:57:38 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: dri-devel@lists.freedesktop.org, chris@chris-wilson.co.uk,
 daniel.vetter@ffwll.ch, sumit.semwal@linaro.org,
 linux-media@vger.kernel.org, linaro-mm-sig@lists.linaro.org
Subject: [PATCH 7/9] dma-buf/resv: add new fences container implementation
Date: Mon, 26 Aug 2019 16:57:29 +0200
Message-Id: <20190826145731.1725-8-christian.koenig@amd.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190826145731.1725-1-christian.koenig@amd.com>
References: <20190826145731.1725-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:subject:date:message-id:in-reply-to:references:mime-version
 :content-transfer-encoding;
 bh=4YEZfHUEvfCRDVgXKCcRqJ5N1s+7+Mxi21IddmT3YB0=;
 b=ruoPopLQENqaUT7j/4Rw5VrzOwzAA4z0XRnlTV60QmQYVJiqsjM9fSJyh8MoVf3sJP
 22tkOV7F2LMwlub3ltgOocgOuBDXpxV68t/tIA5wveMuMlTz3edQ/XngQKS5P8+oRu8a
 c0TlZByDQnG+yfKw/7M2nZOllxEnM+OqR7RuPy5p8wPOJJWNGKUV7MOcj2AS2LpCks5+
 eEWK3gFDgWjJ/xL0a6p1TVlWxYhHeIgylB5y4mhUqKaL+FoPnzukeFbiwwrHhvHVSeMA
 9sy1JcFnch974+6G11T9hrk2W/F4Za8rY6k/vnnEFTonWO+Xpa0Hu4NmrBRa3v2uddFr
 5ZQg==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIGEgbmV3IGNvbnRhaW5lciBmb3IgZmVuY2VzIHdoaWNoIGludGVybmFsbHkgdXNlcwpkbWFf
ZmVuY2VfYXJyYXkncyB0byBzdG9yZSB0aGUgZmVuY2VzLgoKU2lnbmVkLW9mZi1ieTogQ2hyaXN0
aWFuIEvDtm5pZyA8Y2hyaXN0aWFuLmtvZW5pZ0BhbWQuY29tPgotLS0KIGRyaXZlcnMvZG1hLWJ1
Zi9kbWEtcmVzdi5jIHwgMTgxICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysK
IGluY2x1ZGUvbGludXgvZG1hLXJlc3YuaCAgIHwgIDQ5ICsrKysrKysrKysKIDIgZmlsZXMgY2hh
bmdlZCwgMjMwIGluc2VydGlvbnMoKykKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2RtYS1idWYvZG1h
LXJlc3YuYyBiL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtcmVzdi5jCmluZGV4IDU5ZmJjZDlmNGIwMS4u
ZDY3ZWFhM2ZhNjUwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2RtYS1idWYvZG1hLXJlc3YuYworKysg
Yi9kcml2ZXJzL2RtYS1idWYvZG1hLXJlc3YuYwpAQCAtMzMsNiArMzMsNyBAQAogICovCiAKICNp
bmNsdWRlIDxsaW51eC9kbWEtcmVzdi5oPgorI2luY2x1ZGUgPGxpbnV4L2RtYS1mZW5jZS1hcnJh
eS5oPgogI2luY2x1ZGUgPGxpbnV4L2V4cG9ydC5oPgogCiAvKioKQEAgLTU1LDYgKzU2LDE4NiBA
QCBFWFBPUlRfU1lNQk9MKHJlc2VydmF0aW9uX3NlcWNvdW50X2NsYXNzKTsKIGNvbnN0IGNoYXIg
cmVzZXJ2YXRpb25fc2VxY291bnRfc3RyaW5nW10gPSAicmVzZXJ2YXRpb25fc2VxY291bnQiOwog
RVhQT1JUX1NZTUJPTChyZXNlcnZhdGlvbl9zZXFjb3VudF9zdHJpbmcpOwogCitzdGF0aWMgdm9p
ZCBkbWFfcmVzdl9mZW5jZXNfaW5pdChzdHJ1Y3QgZG1hX3Jlc3ZfZmVuY2VzICpmZW5jZXMpCit7
CisJUkNVX0lOSVRfUE9JTlRFUihmZW5jZXMtPmZlbmNlLCBOVUxMKTsKKwlmZW5jZXMtPnN0YWdl
ZCA9IE5VTEw7Cit9CisKK3N0YXRpYyB2b2lkIGRtYV9yZXN2X2ZlbmNlc19maW5pKHN0cnVjdCBk
bWFfcmVzdl9mZW5jZXMgKmZlbmNlcykKK3sKKwkvKgorCSAqIFRoaXMgb2JqZWN0IHNob3VsZCBi
ZSBkZWFkIGFuZCBhbGwgcmVmZXJlbmNlcyBtdXN0IGhhdmUKKwkgKiBiZWVuIHJlbGVhc2VkIHRv
IGl0LCBzbyBubyBuZWVkIHRvIGJlIHByb3RlY3RlZCB3aXRoIHJjdS4KKwkgKi8KKwlkbWFfZmVu
Y2VfcHV0KHJjdV9kZXJlZmVyZW5jZV9wcm90ZWN0ZWQoZmVuY2VzLT5mZW5jZSwgdHJ1ZSkpOwor
CWRtYV9mZW5jZV9hcnJheV9mcmVlKGZlbmNlcy0+c3RhZ2VkKTsKK30KKworLyoqCisgKiBkbWFf
cmVzdl9mZW5jZXNfcmVzZXJ2ZSAtIGFsbG9jYXRlIGZlbmNlIHNsb3RzCisgKiBAZmVuY2VzOiBm
ZW5jZXMgb2JqZWN0IHdoZXJlIHdlIG5lZWQgc2xvdHMKKyAqIEBudW1fZmVuY2VzOiBudW1iZXIg
b2YgZmVuY2Ugc2xvdHMgd2UgbmVlZAorICoKKyAqIE1ha2Ugc3VyZSB0aGF0IHdlIGhhdmUgYXQg
bGVhc3QgQG51bV9mZW5jZXMgKyBhbGwgdGhlIGV4aXN0aW5nIG9uZXMgZnJlZQorICogc2xvdHMg
aW4gdGhlIHN0YWdlZCBkbWFfZmVuY2VfYXJyYXkuCisgKgorICogUmV0dXJucyAtRU5PTUVNIG9u
IGFsbG9jYXRpb24gZmFpbHVyZSwgMCBvdGhlcndpc2UuCisgKi8KK2ludCBkbWFfcmVzdl9mZW5j
ZXNfcmVzZXJ2ZShzdHJ1Y3QgZG1hX3Jlc3YgKm9iaiwKKwkJCSAgICBzdHJ1Y3QgZG1hX3Jlc3Zf
ZmVuY2VzICpmZW5jZXMsCisJCQkgICAgdW5zaWduZWQgaW50IG51bV9mZW5jZXMpCit7CisJc3Ry
dWN0IGRtYV9mZW5jZSAqZmVuY2UgPSBkbWFfcmVzdl9mZW5jZXNfZGVyZWYob2JqLCBmZW5jZXMp
OworCXN0cnVjdCBkbWFfZmVuY2VfYXJyYXkgKnN0YWdlZCwgKmFycmF5OworCXVuc2lnbmVkIGlu
dCBpOworCisJYXJyYXkgPSBmZW5jZXMtPnN0YWdlZDsKKwlpZiAoIWFycmF5KQorCQlhcnJheSA9
IHRvX2RtYV9mZW5jZV9hcnJheShmZW5jZSk7CisKKwlpZiAoYXJyYXkpCisJCW51bV9mZW5jZXMg
Kz0gYXJyYXktPm51bV9mZW5jZXM7CisJZWxzZSBpZiAoZmVuY2UpCisJCW51bV9mZW5jZXMgKz0g
MTsKKworCXN0YWdlZCA9IGZlbmNlcy0+c3RhZ2VkOworCWlmIChzdGFnZWQgJiYgZG1hX2ZlbmNl
X2FycmF5X21heF9mZW5jZXMoc3RhZ2VkKSA+PSBudW1fZmVuY2VzKQorCQlyZXR1cm4gMDsKKwor
CXN0YWdlZCA9IGRtYV9mZW5jZV9hcnJheV9hbGxvYyhudW1fZmVuY2VzLCBOVUxMKTsKKwlpZiAo
IXN0YWdlZCkKKwkJcmV0dXJuIC1FTk9NRU07CisKKwkvKiBDb3B5IG92ZXIgYWxsIGZlbmNlcyBm
cm9tIHRoZSBvbGQgb2JqZWN0ICovCisJaWYgKGFycmF5KSB7CisJCWZvciAoaSA9IDA7IGkgPCBh
cnJheS0+bnVtX2ZlbmNlczsgKytpKSB7CisJCQlzdHJ1Y3QgZG1hX2ZlbmNlICpmID0gYXJyYXkt
PmZlbmNlc1tpXTsKKworCQkJc3RhZ2VkLT5mZW5jZXNbaV0gPSBkbWFfZmVuY2VfZ2V0KGYpOwor
CQl9CisJCXN0YWdlZC0+bnVtX2ZlbmNlcyA9IGFycmF5LT5udW1fZmVuY2VzOworCisJfSBlbHNl
IGlmIChmZW5jZSkgeworCQlzdGFnZWQtPmZlbmNlc1swXSA9IGRtYV9mZW5jZV9nZXQoZmVuY2Up
OworCQlzdGFnZWQtPm51bV9mZW5jZXMgPSAxOworCisJfSBlbHNlIHsKKwkJc3RhZ2VkLT5udW1f
ZmVuY2VzID0gMDsKKwl9CisKKwlkbWFfZmVuY2VfYXJyYXlfZnJlZShmZW5jZXMtPnN0YWdlZCk7
CisJZmVuY2VzLT5zdGFnZWQgPSBzdGFnZWQ7CisKKwlyZXR1cm4gMDsKK30KK0VYUE9SVF9TWU1C
T0woZG1hX3Jlc3ZfZmVuY2VzX3Jlc2VydmUpOworCisvKioKKyAqIGRtYV9yZXN2X2ZlbmNlc19z
ZXQgLSBzZXQgdGhlIHNpbmdsZXRvbiBmZW5jZQorICogQGZlbmNlczogZmVuY2VzIG9iamVjdCB3
aGVyZSB0byBzZXQgdGhlIGZlbmNlCisgKiBAZmVuY2U6IHNpbmdsZXRvbiBmZW5jZSBmb3IgdGhl
IG9iamVjdAorICoKKyAqIEdyYWJzIGEgcmVmZXJlbmNlIHRvIHRoZSBuZXcgZmVuY2UgYW5kIHJl
cGxhY2VzIHRoZSBjdXJyZW50IHNpbmdsZXRvbiBmZW5jZQorICogd2l0aCBhIG5ldyBvbmUgYW5k
IGRyb3AgYW55IHN0YWdlZCBmZW5jZXMuCisgKi8KK3ZvaWQgZG1hX3Jlc3ZfZmVuY2VzX3NldChz
dHJ1Y3QgZG1hX3Jlc3YgKm9iaiwKKwkJCSBzdHJ1Y3QgZG1hX3Jlc3ZfZmVuY2VzICpmZW5jZXMs
CisJCQkgc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpCit7CisJc3RydWN0IGRtYV9mZW5jZSAqb2xk
ID0gZG1hX3Jlc3ZfZmVuY2VzX2RlcmVmKG9iaiwgZmVuY2VzKTsKKworCXJjdV9hc3NpZ25fcG9p
bnRlcihmZW5jZXMtPmZlbmNlLCBkbWFfZmVuY2VfZ2V0KGZlbmNlKSk7CisJZG1hX2ZlbmNlX2Fy
cmF5X2ZyZWUoZmVuY2VzLT5zdGFnZWQpOworCWZlbmNlcy0+c3RhZ2VkID0gTlVMTDsKKwlkbWFf
ZmVuY2VfcHV0KG9sZCk7Cit9CitFWFBPUlRfU1lNQk9MKGRtYV9yZXN2X2ZlbmNlc19zZXQpOwor
CisvKioKKyAqIGRtYV9yZXN2X2ZlbmNlc19hZGQgLSBhZGQgYSBmZW5jZSB0byB0aGUgc3RhZ2Vk
IGZlbmNlX2FycmF5CisgKiBAZmVuY2VzOiBmZW5jZXMgb2JqZWN0IHdoZXJlIHRvIGFkZCB0aGUg
ZmVuY2UgdG8KKyAqIEBmZW5jZTogZmVuY2UgdG8gYWRkCisgKgorICogQWRkIGEgbmV3IGZlbmNl
IHRvIHRoZSBzdGFnZWQgZmVuY2VfYXJyYXkuCisgKi8KK3ZvaWQgZG1hX3Jlc3ZfZmVuY2VzX2Fk
ZChzdHJ1Y3QgZG1hX3Jlc3ZfZmVuY2VzICpmZW5jZXMsCisJCQkgc3RydWN0IGRtYV9mZW5jZSAq
ZmVuY2UpCit7CisJc3RydWN0IGRtYV9mZW5jZV9hcnJheSAqc3RhZ2VkID0gZmVuY2VzLT5zdGFn
ZWQ7CisJc3RydWN0IGRtYV9mZW5jZSAqb2xkOworCXVuc2lnbmVkIGludCBpOworCisJZm9yIChp
ID0gMDsgaSA8IHN0YWdlZC0+bnVtX2ZlbmNlczsgKytpKSB7CisJCW9sZCA9IHN0YWdlZC0+ZmVu
Y2VzW2ldOworCisJCWlmIChvbGQtPmNvbnRleHQgPT0gZmVuY2UtPmNvbnRleHQKKyNpZm5kZWYg
Q09ORklHX0RFQlVHX01VVEVYRVMKKwkJICAgIHx8IGRtYV9mZW5jZV9pc19zaWduYWxlZChvbGQp
CisjZW5kaWYKKwkJICAgICkgeworCQkJZG1hX2ZlbmNlX3B1dChvbGQpOworCQkJZ290byByZXBs
YWNlOworCQl9CisJfQorCisJQlVHX09OKHN0YWdlZC0+bnVtX2ZlbmNlcyA+PSBkbWFfZmVuY2Vf
YXJyYXlfbWF4X2ZlbmNlcyhzdGFnZWQpKTsKKwlpID0gc3RhZ2VkLT5udW1fZmVuY2VzKys7CisK
K3JlcGxhY2U6CisJc3RhZ2VkLT5mZW5jZXNbaV0gPSBkbWFfZmVuY2VfZ2V0KGZlbmNlKTsKK30K
K0VYUE9SVF9TWU1CT0woZG1hX3Jlc3ZfZmVuY2VzX2FkZCk7CisKKy8qKgorICogZG1hX3Jlc3Zf
ZmVuY2VzX2NvbW1pdCAtIGNvbW1pdCB0aGUgc3RhZ2VkIGRtYV9mZW5jZV9hcnJheQorICogQGZl
bmNlczogZmVuY2VzIG9iamVjdCB3aGVyZSB0aGUgY29tbWl0IHNob3VsZCBoYXBwZW4KKyAqCisg
KiBDb21taXQgdGhlIGZlbmNlcyBzdGFnZWQgaW4gdGhlIGRtYV9mZW5jZV9hcnJheSBhbmQgbWFr
ZSB0aGVtIHZpc2libGUgdG8KKyAqIG90aGVyIHRocmVhZHMuCisgKi8KK3ZvaWQgZG1hX3Jlc3Zf
ZmVuY2VzX2NvbW1pdChzdHJ1Y3QgZG1hX3Jlc3YgKm9iaiwKKwkJCSAgICBzdHJ1Y3QgZG1hX3Jl
c3ZfZmVuY2VzICpmZW5jZXMpCit7CisJc3RydWN0IGRtYV9mZW5jZSAqb2xkID0gZG1hX3Jlc3Zf
ZmVuY2VzX2RlcmVmKG9iaiwgZmVuY2VzKTsKKwlzdHJ1Y3QgZG1hX2ZlbmNlX2FycmF5ICphcnJh
eSA9IGZlbmNlcy0+c3RhZ2VkLCAqc3RhZ2VkOworCXVuc2lnbmVkIGludCBpOworCisJaWYgKCFh
cnJheSB8fCAhYXJyYXktPm51bV9mZW5jZXMpCisJCXJldHVybjsKKworCWZlbmNlcy0+c3RhZ2Vk
ID0gTlVMTDsKKwlkbWFfZmVuY2VfYXJyYXlfaW5pdChhcnJheSwgZG1hX2ZlbmNlX2NvbnRleHRf
YWxsb2MoMSksIDEsIGZhbHNlKTsKKwlyY3VfYXNzaWduX3BvaW50ZXIoZmVuY2VzLT5mZW5jZSwg
JmFycmF5LT5iYXNlKTsKKworCS8qIFRyeSB0byByZWN5Y2xlIHRoZSBvbGQgZmVuY2UgYXJyYXkg
Ki8KKwlzdGFnZWQgPSB0b19kbWFfZmVuY2VfYXJyYXkob2xkKTsKKwlpZiAoIXN0YWdlZCB8fCBk
bWFfZmVuY2VfYXJyYXlfbWF4X2ZlbmNlcyhzdGFnZWQpIDwgYXJyYXktPm51bV9mZW5jZXMpIHsK
KwkJZG1hX2ZlbmNlX3B1dChvbGQpOworCQlyZXR1cm47CisJfQorCisJLyogVHJ5IHRvIGRyb3Ag
dGhlIGxhc3QgcmVmZXJlbmNlICovCisJaWYgKCFkbWFfZmVuY2VfYXJyYXlfcmVjeWNsZShzdGFn
ZWQpKQorCQlyZXR1cm47CisKKwkvKiBNYWtlIHN1cmUgdGhlIHN0YWdlZCBhcnJheSBoYXMgdGhl
IGxhdGVzdCBmZW5jZXMgKi8KKwlmb3IgKGkgPSAwOyBpIDwgYXJyYXktPm51bV9mZW5jZXM7ICsr
aSkgeworCQlzdHJ1Y3QgZG1hX2ZlbmNlICpmID0gYXJyYXktPmZlbmNlc1tpXTsKKworCQlpZiAo
ZiA9PSBzdGFnZWQtPmZlbmNlc1tpXSkKKwkJCWNvbnRpbnVlOworCisJCWRtYV9mZW5jZV9wdXQo
c3RhZ2VkLT5mZW5jZXNbaV0pOworCQlzdGFnZWQtPmZlbmNlc1tpXSA9IGRtYV9mZW5jZV9nZXQo
Zik7CisJfQorCWZvciAoO2kgPCBzdGFnZWQtPm51bV9mZW5jZXM7ICsraSkKKwkJZG1hX2ZlbmNl
X3B1dChzdGFnZWQtPmZlbmNlc1tpXSk7CisJc3RhZ2VkLT5udW1fZmVuY2VzID0gYXJyYXktPm51
bV9mZW5jZXM7CisJZmVuY2VzLT5zdGFnZWQgPSBzdGFnZWQ7Cit9CitFWFBPUlRfU1lNQk9MKGRt
YV9yZXN2X2ZlbmNlc19jb21taXQpOworCiAvKioKICAqIGRtYV9yZXN2X2xpc3RfYWxsb2MgLSBh
bGxvY2F0ZSBmZW5jZSBsaXN0CiAgKiBAc2hhcmVkX21heDogbnVtYmVyIG9mIGZlbmNlcyB3ZSBu
ZWVkIHNwYWNlIGZvcgpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC9kbWEtcmVzdi5oIGIvaW5j
bHVkZS9saW51eC9kbWEtcmVzdi5oCmluZGV4IDAzYjBmOTU2ODJiMC4uYzcwZjEzZmE2Nzg5IDEw
MDY0NAotLS0gYS9pbmNsdWRlL2xpbnV4L2RtYS1yZXN2LmgKKysrIGIvaW5jbHVkZS9saW51eC9k
bWEtcmVzdi5oCkBAIC00NSwxMCArNDUsMzMgQEAKICNpbmNsdWRlIDxsaW51eC9zZXFsb2NrLmg+
CiAjaW5jbHVkZSA8bGludXgvcmN1cGRhdGUuaD4KIAorc3RydWN0IGRtYV9yZXN2OworCiBleHRl
cm4gc3RydWN0IHd3X2NsYXNzIHJlc2VydmF0aW9uX3d3X2NsYXNzOwogZXh0ZXJuIHN0cnVjdCBs
b2NrX2NsYXNzX2tleSByZXNlcnZhdGlvbl9zZXFjb3VudF9jbGFzczsKIGV4dGVybiBjb25zdCBj
aGFyIHJlc2VydmF0aW9uX3NlcWNvdW50X3N0cmluZ1tdOwogCisvKioKKyAqIHN0cnVjdCBkbWFf
cmVzdl9mZW5jZXMgLSBmZW5jZXMgaW5zaWRlIGEgcmVzZXJ2YXRpb24gb2JqZWN0CisgKiBAZmVu
Y2U6IHRoZSBjdXJyZW50IFJDVSBwcm90ZWN0ZWQgc2luZ2xldG9uIGZlbmNlCisgKiBAc3RhZ2Vk
OiBvcHRpb25hbCBzdGFnZWQgZG1hX2ZlbmNlX2FycmF5IHRvIHJlcGxhY2UgQGZlbmNlCisgKi8K
K3N0cnVjdCBkbWFfcmVzdl9mZW5jZXMgeworCXN0cnVjdCBkbWFfZmVuY2UgX19yY3UgKmZlbmNl
OworCXN0cnVjdCBkbWFfZmVuY2VfYXJyYXkgKnN0YWdlZDsKK307CisKK2ludCBkbWFfcmVzdl9m
ZW5jZXNfcmVzZXJ2ZShzdHJ1Y3QgZG1hX3Jlc3YgKm9iaiwKKwkJCSAgICBzdHJ1Y3QgZG1hX3Jl
c3ZfZmVuY2VzICpmZW5jZXMsCisJCQkgICAgdW5zaWduZWQgaW50IG51bV9mZW5jZXMpOwordm9p
ZCBkbWFfcmVzdl9mZW5jZXNfc2V0KHN0cnVjdCBkbWFfcmVzdiAqb2JqLAorCQkJIHN0cnVjdCBk
bWFfcmVzdl9mZW5jZXMgKmZlbmNlcywKKwkJCSBzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSk7Cit2
b2lkIGRtYV9yZXN2X2ZlbmNlc19hZGQoc3RydWN0IGRtYV9yZXN2X2ZlbmNlcyAqZmVuY2VzLAor
CQkJIHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlKTsKK3ZvaWQgZG1hX3Jlc3ZfZmVuY2VzX2NvbW1p
dChzdHJ1Y3QgZG1hX3Jlc3YgKm9iaiwKKwkJCSAgICBzdHJ1Y3QgZG1hX3Jlc3ZfZmVuY2VzICpm
ZW5jZXMpOworCiAvKioKICAqIHN0cnVjdCBkbWFfcmVzdl9saXN0IC0gYSBsaXN0IG9mIHNoYXJl
ZCBmZW5jZXMKICAqIEByY3U6IGZvciBpbnRlcm5hbCB1c2UKQEAgLTgwLDYgKzEwMywzMiBAQCBz
dHJ1Y3QgZG1hX3Jlc3YgewogI2RlZmluZSBkbWFfcmVzdl9oZWxkKG9iaikgbG9ja2RlcF9pc19o
ZWxkKCYob2JqKS0+bG9jay5iYXNlKQogI2RlZmluZSBkbWFfcmVzdl9hc3NlcnRfaGVsZChvYmop
IGxvY2tkZXBfYXNzZXJ0X2hlbGQoJihvYmopLT5sb2NrLmJhc2UpCiAKKy8qKgorICogZG1hX3Jl
c3ZfZmVuY2VzX2RlcmVmIC0gZ2V0IHNpbmdsZXRvbiBmZW5jZQorICogQG9iajogdGhlIHJlc2Vy
dmF0aW9uIG9iamVjdAorICogQGZlbmNlczogdGhlIGZlbmNlcyBvYmplY3QKKyAqCisgKiBSZXR1
cm5zIHRoZSBzaW5nbGV0b24gZmVuY2UgZnJvbSBhIHJlc3ZfZmVuY2VzIG9iamVjdC4KKyAqLwor
c3RhdGljIGlubGluZSBzdHJ1Y3QgZG1hX2ZlbmNlICoKK2RtYV9yZXN2X2ZlbmNlc19kZXJlZihz
dHJ1Y3QgZG1hX3Jlc3YgKm9iaiwgc3RydWN0IGRtYV9yZXN2X2ZlbmNlcyAqZmVuY2VzKQorewor
CXJldHVybiByY3VfZGVyZWZlcmVuY2VfcHJvdGVjdGVkKGZlbmNlcy0+ZmVuY2UsCisJCQkJCSBk
bWFfcmVzdl9oZWxkKG9iaikpOworfQorCisvKioKKyAqIGRtYV9yZXN2X2ZlbmNlc19nZXRfcmN1
IC0gUkNVIGdldCBzaW5nbGUgZmVuY2UKKyAqIEBmZW5jZXM6IGZlbmNlcyBzdHJ1Y3R1cmUgd2hl
cmUgd2UgbmVlZCB0byBnZXQgYSByZWZlcmVuY2UgZm9yCisgKgorICogR2V0IGEgcmVmZXJlbmNl
IHRvIHRoZSBzaW5nbGUgZmVuY2UgcmVwcmVzZW50aW5nIHRoZSBzeW5jaHJvbml6YXRpb24uCisg
Ki8KK3N0YXRpYyBpbmxpbmUgc3RydWN0IGRtYV9mZW5jZSAqCitkbWFfcmVzdl9mZW5jZXNfZ2V0
X3JjdShzdHJ1Y3QgZG1hX3Jlc3ZfZmVuY2VzICpmZW5jZXMpCit7CisJcmV0dXJuIGRtYV9mZW5j
ZV9nZXRfcmN1X3NhZmUoJmZlbmNlcy0+ZmVuY2UpOworfQorCiAvKioKICAqIGRtYV9yZXN2X2dl
dF9saXN0IC0gZ2V0IHRoZSByZXNlcnZhdGlvbiBvYmplY3QncwogICogc2hhcmVkIGZlbmNlIGxp
c3QsIHdpdGggdXBkYXRlLXNpZGUgbG9jayBoZWxkCi0tIAoyLjE3LjEKCl9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QK
ZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9w
Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
