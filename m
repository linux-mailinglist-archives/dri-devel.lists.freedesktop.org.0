Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 70AD6BB53F
	for <lists+dri-devel@lfdr.de>; Mon, 23 Sep 2019 15:30:06 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4F7976E900;
	Mon, 23 Sep 2019 13:30:03 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from foss.arm.com (foss.arm.com [217.140.110.172])
 by gabe.freedesktop.org (Postfix) with ESMTP id BC58B6E900
 for <dri-devel@lists.freedesktop.org>; Mon, 23 Sep 2019 13:30:01 +0000 (UTC)
Received: from usa-sjc-imap-foss1.foss.arm.com (unknown [10.121.207.14])
 by usa-sjc-mx-foss1.foss.arm.com (Postfix) with ESMTP id 33C381000;
 Mon, 23 Sep 2019 06:30:01 -0700 (PDT)
Received: from [10.1.196.133] (e112269-lin.cambridge.arm.com [10.1.196.133])
 by usa-sjc-imap-foss1.foss.arm.com (Postfix) with ESMTPSA id CF39A3F694;
 Mon, 23 Sep 2019 06:29:59 -0700 (PDT)
Subject: Re: [PATCH v2 02/11] drm/shmem: switch shmem helper to
 &drm_gem_object_funcs.mmap
To: Gerd Hoffmann <kraxel@redhat.com>, dri-devel@lists.freedesktop.org
References: <20190917092404.9982-1-kraxel@redhat.com>
 <20190917092404.9982-3-kraxel@redhat.com>
From: Steven Price <steven.price@arm.com>
Message-ID: <204968cf-d06a-7856-64d3-c611e683f4ea@arm.com>
Date: Mon, 23 Sep 2019 14:29:58 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <20190917092404.9982-3-kraxel@redhat.com>
Content-Language: en-GB
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Tomeu Vizoso <tomeu.vizoso@collabora.com>,
 Maxime Ripard <maxime.ripard@bootlin.com>,
 Daniel Vetter <daniel.vetter@ffwll.ch>,
 open list <linux-kernel@vger.kernel.org>,
 "open list:VIRTIO GPU DRIVER" <virtualization@lists.linux-foundation.org>,
 David Airlie <airlied@linux.ie>,
 Alyssa Rosenzweig <alyssa.rosenzweig@collabora.com>,
 Thomas Zimmermann <tzimmermann@suse.de>, Sean Paul <sean@poorly.run>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gMTcvMDkvMjAxOSAxMDoyMywgR2VyZCBIb2ZmbWFubiB3cm90ZToKPiBTd2l0Y2ggZ2VtIHNo
bWVtIGhlbHBlciB0byB0aGUgbmV3IG1tYXAoKSB3b3JrZmxvdywKPiBmcm9tICZnZW1fZHJpdmVy
LmZvcHMubW1hcCB0byAmZHJtX2dlbV9vYmplY3RfZnVuY3MubW1hcC4KPiAKPiB2MjogRml4IHZt
X2ZsYWdzIGFuZCB2bV9wYWdlX3Byb3QgaGFuZGxpbmcuCj4gCj4gU2lnbmVkLW9mZi1ieTogR2Vy
ZCBIb2ZmbWFubiA8a3JheGVsQHJlZGhhdC5jb20+CgpSZXZpZXdlZC1ieTogU3RldmVuIFByaWNl
IDxzdGV2ZW4ucHJpY2VAYXJtLmNvbT4KCj4gLS0tCj4gIGluY2x1ZGUvZHJtL2RybV9nZW1fc2ht
ZW1faGVscGVyLmggICAgICB8ICA2ICsrLS0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vZHJtX2dlbV9z
aG1lbV9oZWxwZXIuYyAgfCAyOCArKysrKysrKystLS0tLS0tLS0tLS0tLS0tCj4gIGRyaXZlcnMv
Z3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9nZW0uYyB8ICAyICstCj4gIGRyaXZlcnMvZ3B1L2Ry
bS92M2QvdjNkX2JvLmMgICAgICAgICAgICB8ICAyICstCj4gIGRyaXZlcnMvZ3B1L2RybS92aXJ0
aW8vdmlydGdwdV9vYmplY3QuYyB8ICAyICstCj4gIDUgZmlsZXMgY2hhbmdlZCwgMTUgaW5zZXJ0
aW9ucygrKSwgMjUgZGVsZXRpb25zKC0pCj4gCj4gZGlmZiAtLWdpdCBhL2luY2x1ZGUvZHJtL2Ry
bV9nZW1fc2htZW1faGVscGVyLmggYi9pbmNsdWRlL2RybS9kcm1fZ2VtX3NobWVtX2hlbHBlci5o
Cj4gaW5kZXggMDFmNTE0NTIxNjg3Li5kODlmMjExNmM4YWIgMTAwNjQ0Cj4gLS0tIGEvaW5jbHVk
ZS9kcm0vZHJtX2dlbV9zaG1lbV9oZWxwZXIuaAo+ICsrKyBiL2luY2x1ZGUvZHJtL2RybV9nZW1f
c2htZW1faGVscGVyLmgKPiBAQCAtMTExLDcgKzExMSw3IEBAIHN0cnVjdCBkcm1fZ2VtX3NobWVt
X29iamVjdCB7Cj4gIAkJLnBvbGwJCT0gZHJtX3BvbGwsXAo+ICAJCS5yZWFkCQk9IGRybV9yZWFk
LFwKPiAgCQkubGxzZWVrCQk9IG5vb3BfbGxzZWVrLFwKPiAtCQkubW1hcAkJPSBkcm1fZ2VtX3No
bWVtX21tYXAsIFwKPiArCQkubW1hcAkJPSBkcm1fZ2VtX21tYXAsIFwKPiAgCX0KPiAgCj4gIHN0
cnVjdCBkcm1fZ2VtX3NobWVtX29iamVjdCAqZHJtX2dlbV9zaG1lbV9jcmVhdGUoc3RydWN0IGRy
bV9kZXZpY2UgKmRldiwgc2l6ZV90IHNpemUpOwo+IEBAIC0xNDMsOSArMTQzLDcgQEAgZHJtX2dl
bV9zaG1lbV9jcmVhdGVfd2l0aF9oYW5kbGUoc3RydWN0IGRybV9maWxlICpmaWxlX3ByaXYsCj4g
IGludCBkcm1fZ2VtX3NobWVtX2R1bWJfY3JlYXRlKHN0cnVjdCBkcm1fZmlsZSAqZmlsZSwgc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiwKPiAgCQkJICAgICAgc3RydWN0IGRybV9tb2RlX2NyZWF0ZV9k
dW1iICphcmdzKTsKPiAgCj4gLWludCBkcm1fZ2VtX3NobWVtX21tYXAoc3RydWN0IGZpbGUgKmZp
bHAsIHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hKTsKPiAtCj4gLWV4dGVybiBjb25zdCBzdHJ1
Y3Qgdm1fb3BlcmF0aW9uc19zdHJ1Y3QgZHJtX2dlbV9zaG1lbV92bV9vcHM7Cj4gK2ludCBkcm1f
Z2VtX3NobWVtX21tYXAoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmosIHN0cnVjdCB2bV9hcmVh
X3N0cnVjdCAqdm1hKTsKPiAgCj4gIHZvaWQgZHJtX2dlbV9zaG1lbV9wcmludF9pbmZvKHN0cnVj
dCBkcm1fcHJpbnRlciAqcCwgdW5zaWduZWQgaW50IGluZGVudCwKPiAgCQkJICAgICAgY29uc3Qg
c3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmopOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vZHJtX2dlbV9zaG1lbV9oZWxwZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX3NobWVt
X2hlbHBlci5jCj4gaW5kZXggZjU5MTg3MDc2NzJmLi5hOWE1ODY2MzA1MTcgMTAwNjQ0Cj4gLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2RybV9nZW1fc2htZW1faGVscGVyLmMKPiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vZHJtX2dlbV9zaG1lbV9oZWxwZXIuYwo+IEBAIC0zMiw3ICszMiw3IEBAIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgZHJtX2dlbV9vYmplY3RfZnVuY3MgZHJtX2dlbV9zaG1lbV9mdW5jcyA9
IHsKPiAgCS5nZXRfc2dfdGFibGUgPSBkcm1fZ2VtX3NobWVtX2dldF9zZ190YWJsZSwKPiAgCS52
bWFwID0gZHJtX2dlbV9zaG1lbV92bWFwLAo+ICAJLnZ1bm1hcCA9IGRybV9nZW1fc2htZW1fdnVu
bWFwLAo+IC0JLnZtX29wcyA9ICZkcm1fZ2VtX3NobWVtX3ZtX29wcywKPiArCS5tbWFwID0gZHJt
X2dlbV9zaG1lbV9tbWFwLAo+ICB9Owo+ICAKPiAgLyoqCj4gQEAgLTUwNSwzOSArNTA1LDMwIEBA
IHN0YXRpYyB2b2lkIGRybV9nZW1fc2htZW1fdm1fY2xvc2Uoc3RydWN0IHZtX2FyZWFfc3RydWN0
ICp2bWEpCj4gIAlkcm1fZ2VtX3ZtX2Nsb3NlKHZtYSk7Cj4gIH0KPiAgCj4gLWNvbnN0IHN0cnVj
dCB2bV9vcGVyYXRpb25zX3N0cnVjdCBkcm1fZ2VtX3NobWVtX3ZtX29wcyA9IHsKPiArc3RhdGlj
IGNvbnN0IHN0cnVjdCB2bV9vcGVyYXRpb25zX3N0cnVjdCBkcm1fZ2VtX3NobWVtX3ZtX29wcyA9
IHsKPiAgCS5mYXVsdCA9IGRybV9nZW1fc2htZW1fZmF1bHQsCj4gIAkub3BlbiA9IGRybV9nZW1f
c2htZW1fdm1fb3BlbiwKPiAgCS5jbG9zZSA9IGRybV9nZW1fc2htZW1fdm1fY2xvc2UsCj4gIH07
Cj4gLUVYUE9SVF9TWU1CT0xfR1BMKGRybV9nZW1fc2htZW1fdm1fb3BzKTsKPiAgCj4gIC8qKgo+
ICAgKiBkcm1fZ2VtX3NobWVtX21tYXAgLSBNZW1vcnktbWFwIGEgc2htZW0gR0VNIG9iamVjdAo+
IC0gKiBAZmlscDogRmlsZSBvYmplY3QKPiArICogQG9iajogZ2VtIG9iamVjdAo+ICAgKiBAdm1h
OiBWTUEgZm9yIHRoZSBhcmVhIHRvIGJlIG1hcHBlZAo+ICAgKgo+ICAgKiBUaGlzIGZ1bmN0aW9u
IGltcGxlbWVudHMgYW4gYXVnbWVudGVkIHZlcnNpb24gb2YgdGhlIEdFTSBEUk0gZmlsZSBtbWFw
Cj4gICAqIG9wZXJhdGlvbiBmb3Igc2htZW0gb2JqZWN0cy4gRHJpdmVycyB3aGljaCBlbXBsb3kg
dGhlIHNobWVtIGhlbHBlcnMgc2hvdWxkCj4gLSAqIHVzZSB0aGlzIGZ1bmN0aW9uIGFzIHRoZWly
ICZmaWxlX29wZXJhdGlvbnMubW1hcCBoYW5kbGVyIGluIHRoZSBEUk0gZGV2aWNlIGZpbGUncwo+
IC0gKiBmaWxlX29wZXJhdGlvbnMgc3RydWN0dXJlLgo+IC0gKgo+IC0gKiBJbnN0ZWFkIG9mIGRp
cmVjdGx5IHJlZmVyZW5jaW5nIHRoaXMgZnVuY3Rpb24sIGRyaXZlcnMgc2hvdWxkIHVzZSB0aGUK
PiAtICogREVGSU5FX0RSTV9HRU1fU0hNRU1fRk9QUygpIG1hY3JvLgo+ICsgKiB1c2UgdGhpcyBm
dW5jdGlvbiBhcyB0aGVpciAmZHJtX2dlbV9vYmplY3RfZnVuY3MubW1hcCBoYW5kbGVyLgo+ICAg
Kgo+ICAgKiBSZXR1cm5zOgo+ICAgKiAwIG9uIHN1Y2Nlc3Mgb3IgYSBuZWdhdGl2ZSBlcnJvciBj
b2RlIG9uIGZhaWx1cmUuCj4gICAqLwo+IC1pbnQgZHJtX2dlbV9zaG1lbV9tbWFwKHN0cnVjdCBm
aWxlICpmaWxwLCBzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSkKPiAraW50IGRybV9nZW1fc2ht
ZW1fbW1hcChzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iaiwgc3RydWN0IHZtX2FyZWFfc3RydWN0
ICp2bWEpCj4gIHsKPiAgCXN0cnVjdCBkcm1fZ2VtX3NobWVtX29iamVjdCAqc2htZW07Cj4gIAlp
bnQgcmV0Owo+ICAKPiAtCXJldCA9IGRybV9nZW1fbW1hcChmaWxwLCB2bWEpOwo+IC0JaWYgKHJl
dCkKPiAtCQlyZXR1cm4gcmV0Owo+IC0KPiAtCXNobWVtID0gdG9fZHJtX2dlbV9zaG1lbV9vYmoo
dm1hLT52bV9wcml2YXRlX2RhdGEpOwo+ICsJc2htZW0gPSB0b19kcm1fZ2VtX3NobWVtX29iaihv
YmopOwo+ICAKPiAgCXJldCA9IGRybV9nZW1fc2htZW1fZ2V0X3BhZ2VzKHNobWVtKTsKPiAgCWlm
IChyZXQpIHsKPiBAQCAtNTQ1LDkgKzUzNiwxMCBAQCBpbnQgZHJtX2dlbV9zaG1lbV9tbWFwKHN0
cnVjdCBmaWxlICpmaWxwLCBzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSkKPiAgCQlyZXR1cm4g
cmV0Owo+ICAJfQo+ICAKPiAtCS8qIFZNX1BGTk1BUCB3YXMgc2V0IGJ5IGRybV9nZW1fbW1hcCgp
ICovCj4gLQl2bWEtPnZtX2ZsYWdzICY9IH5WTV9QRk5NQVA7Cj4gLQl2bWEtPnZtX2ZsYWdzIHw9
IFZNX01JWEVETUFQOwo+ICsJdm1hLT52bV9mbGFncyB8PSBWTV9JTyB8IFZNX01JWEVETUFQIHwg
Vk1fRE9OVEVYUEFORCB8IFZNX0RPTlREVU1QOwo+ICsJdm1hLT52bV9wYWdlX3Byb3QgPSBwZ3By
b3Rfd3JpdGVjb21iaW5lKHZtX2dldF9wYWdlX3Byb3Qodm1hLT52bV9mbGFncykpOwo+ICsJdm1h
LT52bV9wYWdlX3Byb3QgPSBwZ3Byb3RfZGVjcnlwdGVkKHZtYS0+dm1fcGFnZV9wcm90KTsKPiAr
CXZtYS0+dm1fb3BzID0gJmRybV9nZW1fc2htZW1fdm1fb3BzOwo+ICAKPiAgCS8qIFJlbW92ZSB0
aGUgZmFrZSBvZmZzZXQgKi8KPiAgCXZtYS0+dm1fcGdvZmYgLT0gZHJtX3ZtYV9ub2RlX3N0YXJ0
KCZzaG1lbS0+YmFzZS52bWFfbm9kZSk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9w
YW5mcm9zdC9wYW5mcm9zdF9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9z
dF9nZW0uYwo+IGluZGV4IGFjYjA3ZmUwNjU4MC4uZGVjYTBjMzBiYmQ0IDEwMDY0NAo+IC0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9nZW0uYwo+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9nZW0uYwo+IEBAIC0xMTIsNyArMTEyLDcgQEAgc3Rh
dGljIGNvbnN0IHN0cnVjdCBkcm1fZ2VtX29iamVjdF9mdW5jcyBwYW5mcm9zdF9nZW1fZnVuY3Mg
PSB7Cj4gIAkuZ2V0X3NnX3RhYmxlID0gZHJtX2dlbV9zaG1lbV9nZXRfc2dfdGFibGUsCj4gIAku
dm1hcCA9IGRybV9nZW1fc2htZW1fdm1hcCwKPiAgCS52dW5tYXAgPSBkcm1fZ2VtX3NobWVtX3Z1
bm1hcCwKPiAtCS52bV9vcHMgPSAmZHJtX2dlbV9zaG1lbV92bV9vcHMsCj4gKwkubW1hcCA9IGRy
bV9nZW1fc2htZW1fbW1hcCwKPiAgfTsKPiAgCj4gIC8qKgo+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vdjNkL3YzZF9iby5jIGIvZHJpdmVycy9ncHUvZHJtL3YzZC92M2RfYm8uYwo+IGlu
ZGV4IGEyMmI3NWEzYTUzMy4uZWRkMjk5YWI1M2Q4IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS92M2QvdjNkX2JvLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vdjNkL3YzZF9iby5jCj4g
QEAgLTU4LDcgKzU4LDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZ2VtX29iamVjdF9mdW5j
cyB2M2RfZ2VtX2Z1bmNzID0gewo+ICAJLmdldF9zZ190YWJsZSA9IGRybV9nZW1fc2htZW1fZ2V0
X3NnX3RhYmxlLAo+ICAJLnZtYXAgPSBkcm1fZ2VtX3NobWVtX3ZtYXAsCj4gIAkudnVubWFwID0g
ZHJtX2dlbV9zaG1lbV92dW5tYXAsCj4gLQkudm1fb3BzID0gJmRybV9nZW1fc2htZW1fdm1fb3Bz
LAo+ICsJLm1tYXAgPSBkcm1fZ2VtX3NobWVtX21tYXAsCj4gIH07Cj4gIAo+ICAvKiBnZW1fY3Jl
YXRlX29iamVjdCBmdW5jdGlvbiBmb3IgYWxsb2NhdGluZyBhIEJPIHN0cnVjdCBhbmQgZG9pbmcK
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X29iamVjdC5jIGIv
ZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X29iamVjdC5jCj4gaW5kZXggNjlhM2QzMTBm
ZjcwLi4wMTdhOWUwZmMzYmIgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92
aXJ0Z3B1X29iamVjdC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X29i
amVjdC5jCj4gQEAgLTg2LDcgKzg2LDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZ2VtX29i
amVjdF9mdW5jcyB2aXJ0aW9fZ3B1X2dlbV9mdW5jcyA9IHsKPiAgCS5nZXRfc2dfdGFibGUgPSBk
cm1fZ2VtX3NobWVtX2dldF9zZ190YWJsZSwKPiAgCS52bWFwID0gZHJtX2dlbV9zaG1lbV92bWFw
LAo+ICAJLnZ1bm1hcCA9IGRybV9nZW1fc2htZW1fdnVubWFwLAo+IC0JLnZtX29wcyA9ICZkcm1f
Z2VtX3NobWVtX3ZtX29wcywKPiArCS5tbWFwID0gJmRybV9nZW1fc2htZW1fbW1hcCwKPiAgfTsK
PiAgCj4gIHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqdmlydGlvX2dwdV9jcmVhdGVfb2JqZWN0KHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5m
cmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0
aW5mby9kcmktZGV2ZWw=
