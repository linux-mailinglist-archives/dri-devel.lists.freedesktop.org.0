Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 28D68D630B
	for <lists+dri-devel@lfdr.de>; Mon, 14 Oct 2019 14:51:21 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E97066E2CF;
	Mon, 14 Oct 2019 12:51:17 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-wm1-x342.google.com (mail-wm1-x342.google.com
 [IPv6:2a00:1450:4864:20::342])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E3E046E2C0
 for <dri-devel@lists.freedesktop.org>; Mon, 14 Oct 2019 12:51:14 +0000 (UTC)
Received: by mail-wm1-x342.google.com with SMTP id r17so14435540wme.0
 for <dri-devel@lists.freedesktop.org>; Mon, 14 Oct 2019 05:51:14 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=ByOD/URUTplb+5mvC2oecBpFoqh1Lrogh0FPvicFxx4=;
 b=GVjDDRL3dcccDrSxRq92oKuam2/XFN1rqKNba0X5s3NM95tpOA+sNEGa1Cpv/qHJZu
 9nReUUJgk5BVZ6NupZtr3yrJ2jAByFTxI5dVESE6ZusKQMLtA9Wfp6KDKIe+FWOGr2f5
 PsIXrVb5TXLtYXwnzBsucseUYQCx1YPlvqLD7M3M16JIP8kaTRQC0MAfQ0k/ULXCkHJ8
 qV1QRbMZB45Agj3pXmYWrph6NrUcYFGNQfdPz16sd/maDQYlA0/2hpy7oNhfMLntJ60O
 JdF8MtoNKZqtj+GN1Wk5WpnYZkA6S+drBxQbAuNvEORwQ74OtMHxoC6IB9UZ3YW4z78S
 xksA==
X-Gm-Message-State: APjAAAVbxYlmVCp7UgB7bVKyfSDoOoLQ4fXnvgORBgGm7UBqEmoJ/Lwo
 vR1UkVFhoqxEHxI5CPnunzE=
X-Google-Smtp-Source: APXvYqwzHVU93ie1bseLLY/s+4NFR5ZzARfzHrP6+sB19QpVkZf9w0io00VLw9eswka+jOaiddjjTw==
X-Received: by 2002:a05:600c:2107:: with SMTP id
 u7mr14817594wml.13.1571057472712; 
 Mon, 14 Oct 2019 05:51:12 -0700 (PDT)
Received: from localhost (p2E5BE2CE.dip0.t-ipconnect.de. [46.91.226.206])
 by smtp.gmail.com with ESMTPSA id c132sm27253057wme.27.2019.10.14.05.51.11
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 14 Oct 2019 05:51:11 -0700 (PDT)
From: Thierry Reding <thierry.reding@gmail.com>
To: Thierry Reding <thierry.reding@gmail.com>
Subject: [PATCH 10/14] drm/tegra: Move IOMMU group into host1x client
Date: Mon, 14 Oct 2019 14:50:45 +0200
Message-Id: <20191014125049.425101-11-thierry.reding@gmail.com>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191014125049.425101-1-thierry.reding@gmail.com>
References: <20191014125049.425101-1-thierry.reding@gmail.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=ByOD/URUTplb+5mvC2oecBpFoqh1Lrogh0FPvicFxx4=;
 b=BfXUzm2VewPyYkUCGJVNqEQaPRyntweb24BGSGEiaGKmWqLNb5E3CKsBtzyRHit1LF
 RH+rOqQtsJdAMqc/jwYwepBvBV70dlqA7O9VJVOPGNELd5sW/U3QINoZjawTzoxiX/iC
 oJVImuzxBq8VuGsrh0ilh8WUK/IFa8mmsgSdOLAbvsxiWTdKqs5bja6jYOVZ9AwACB6j
 jREavpuXhz0wORWSij+Y4/TSxLLfNmEZJEzjxXPxnyYnNyouaiaVFxz5lFFdppjm7Oo3
 rl/RuXhI4jeTY9JLPkzJBYslXaQRiIMVynoIOzO+GQQkg2z/OEqwceqXxAMzsfOxylto
 hoow==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: linux-tegra@vger.kernel.org, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogVGhpZXJyeSBSZWRpbmcgPHRyZWRpbmdAbnZpZGlhLmNvbT4KCkhhbmRsaW5nIG9mIHRo
ZSBJT01NVSBncm91cCBhdHRhY2htZW50IGlzIGNvbW1vbiB0byBhbGwgY2xpZW50cywgc28gbW92
ZQp0aGUgZ3JvdXAgaW50byB0aGUgY2xpZW50IHRvIHNpbXBsaWZ5IGNvZGUuCgpTaWduZWQtb2Zm
LWJ5OiBUaGllcnJ5IFJlZGluZyA8dHJlZGluZ0BudmlkaWEuY29tPgotLS0KIGRyaXZlcnMvZ3B1
L2RybS90ZWdyYS9kYy5jICAgfCAgOSArKysrLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS90ZWdyYS9k
Yy5oICAgfCAgMiAtLQogZHJpdmVycy9ncHUvZHJtL3RlZ3JhL2RybS5jICB8IDIyICsrKysrKysr
KysrLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS90ZWdyYS9kcm0uaCAgfCAgNiArKy0tLS0K
IGRyaXZlcnMvZ3B1L2RybS90ZWdyYS9ncjJkLmMgfCAxMCArKysrLS0tLS0tCiBkcml2ZXJzL2dw
dS9kcm0vdGVncmEvZ3IzZC5jIHwgMTAgKysrKy0tLS0tLQogZHJpdmVycy9ncHUvZHJtL3RlZ3Jh
L3ZpYy5jICB8IDEwICsrKystLS0tLS0KIGluY2x1ZGUvbGludXgvaG9zdDF4LmggICAgICAgfCAg
MiArKwogOCBmaWxlcyBjaGFuZ2VkLCAzMSBpbnNlcnRpb25zKCspLCA0MCBkZWxldGlvbnMoLSkK
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdGVncmEvZGMuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS90ZWdyYS9kYy5jCmluZGV4IGY3Zjc5ODRiYjc0OS4uM2FjNTM1YmQ5OWNhIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vdGVncmEvZGMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdGVncmEv
ZGMuYwpAQCAtMjAxNCw5ICsyMDE0LDggQEAgc3RhdGljIGludCB0ZWdyYV9kY19pbml0KHN0cnVj
dCBob3N0MXhfY2xpZW50ICpjbGllbnQpCiAJaWYgKCFkYy0+c3luY3B0KQogCQlkZXZfd2Fybihk
Yy0+ZGV2LCAiZmFpbGVkIHRvIGFsbG9jYXRlIHN5bmNwb2ludFxuIik7CiAKLQlkYy0+Z3JvdXAg
PSBob3N0MXhfY2xpZW50X2lvbW11X2F0dGFjaChjbGllbnQsIHRydWUpOwotCWlmIChJU19FUlIo
ZGMtPmdyb3VwKSkgewotCQllcnIgPSBQVFJfRVJSKGRjLT5ncm91cCk7CisJZXJyID0gaG9zdDF4
X2NsaWVudF9pb21tdV9hdHRhY2goY2xpZW50LCB0cnVlKTsKKwlpZiAoZXJyIDwgMCkgewogCQlk
ZXZfZXJyKGNsaWVudC0+ZGV2LCAiZmFpbGVkIHRvIGF0dGFjaCB0byBkb21haW46ICVkXG4iLCBl
cnIpOwogCQlyZXR1cm4gZXJyOwogCX0KQEAgLTIwODksNyArMjA4OCw3IEBAIHN0YXRpYyBpbnQg
dGVncmFfZGNfaW5pdChzdHJ1Y3QgaG9zdDF4X2NsaWVudCAqY2xpZW50KQogCWlmICghSVNfRVJS
KHByaW1hcnkpKQogCQlkcm1fcGxhbmVfY2xlYW51cChwcmltYXJ5KTsKIAotCWhvc3QxeF9jbGll
bnRfaW9tbXVfZGV0YWNoKGNsaWVudCwgZGMtPmdyb3VwKTsKKwlob3N0MXhfY2xpZW50X2lvbW11
X2RldGFjaChjbGllbnQpOwogCWhvc3QxeF9zeW5jcHRfZnJlZShkYy0+c3luY3B0KTsKIAogCXJl
dHVybiBlcnI7CkBAIC0yMTE0LDcgKzIxMTMsNyBAQCBzdGF0aWMgaW50IHRlZ3JhX2RjX2V4aXQo
c3RydWN0IGhvc3QxeF9jbGllbnQgKmNsaWVudCkKIAkJcmV0dXJuIGVycjsKIAl9CiAKLQlob3N0
MXhfY2xpZW50X2lvbW11X2RldGFjaChjbGllbnQsIGRjLT5ncm91cCk7CisJaG9zdDF4X2NsaWVu
dF9pb21tdV9kZXRhY2goY2xpZW50KTsKIAlob3N0MXhfc3luY3B0X2ZyZWUoZGMtPnN5bmNwdCk7
CiAKIAlyZXR1cm4gMDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90ZWdyYS9kYy5oIGIv
ZHJpdmVycy9ncHUvZHJtL3RlZ3JhL2RjLmgKaW5kZXggMGM0ZDE3ODUxZjQ3Li4zZDhkZGNjZDc1
OGYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS90ZWdyYS9kYy5oCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS90ZWdyYS9kYy5oCkBAIC05MCw4ICs5MCw2IEBAIHN0cnVjdCB0ZWdyYV9kYyB7CiAJ
c3RydWN0IGRybV9pbmZvX2xpc3QgKmRlYnVnZnNfZmlsZXM7CiAKIAljb25zdCBzdHJ1Y3QgdGVn
cmFfZGNfc29jX2luZm8gKnNvYzsKLQotCXN0cnVjdCBpb21tdV9ncm91cCAqZ3JvdXA7CiB9Owog
CiBzdGF0aWMgaW5saW5lIHN0cnVjdCB0ZWdyYV9kYyAqCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vdGVncmEvZHJtLmMgYi9kcml2ZXJzL2dwdS9kcm0vdGVncmEvZHJtLmMKaW5kZXggNDk4
ZDIyYTY1NjE2Li5iNzQzNjJjYjYzZWIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS90ZWdy
YS9kcm0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdGVncmEvZHJtLmMKQEAgLTEwNjgsOCArMTA2
OCw3IEBAIGludCB0ZWdyYV9kcm1fdW5yZWdpc3Rlcl9jbGllbnQoc3RydWN0IHRlZ3JhX2RybSAq
dGVncmEsCiAJcmV0dXJuIDA7CiB9CiAKLXN0cnVjdCBpb21tdV9ncm91cCAqaG9zdDF4X2NsaWVu
dF9pb21tdV9hdHRhY2goc3RydWN0IGhvc3QxeF9jbGllbnQgKmNsaWVudCwKLQkJCQkJICAgICAg
IGJvb2wgc2hhcmVkKQoraW50IGhvc3QxeF9jbGllbnRfaW9tbXVfYXR0YWNoKHN0cnVjdCBob3N0
MXhfY2xpZW50ICpjbGllbnQsIGJvb2wgc2hhcmVkKQogewogCXN0cnVjdCBkcm1fZGV2aWNlICpk
cm0gPSBkZXZfZ2V0X2RydmRhdGEoY2xpZW50LT5wYXJlbnQpOwogCXN0cnVjdCB0ZWdyYV9kcm0g
KnRlZ3JhID0gZHJtLT5kZXZfcHJpdmF0ZTsKQEAgLTEwODAsNyArMTA3OSw3IEBAIHN0cnVjdCBp
b21tdV9ncm91cCAqaG9zdDF4X2NsaWVudF9pb21tdV9hdHRhY2goc3RydWN0IGhvc3QxeF9jbGll
bnQgKmNsaWVudCwKIAkJZ3JvdXAgPSBpb21tdV9ncm91cF9nZXQoY2xpZW50LT5kZXYpOwogCQlp
ZiAoIWdyb3VwKSB7CiAJCQlkZXZfZXJyKGNsaWVudC0+ZGV2LCAiZmFpbGVkIHRvIGdldCBJT01N
VSBncm91cFxuIik7Ci0JCQlyZXR1cm4gRVJSX1BUUigtRU5PREVWKTsKKwkJCXJldHVybiAtRU5P
REVWOwogCQl9CiAKIAkJaWYgKCFzaGFyZWQgfHwgKHNoYXJlZCAmJiAoZ3JvdXAgIT0gdGVncmEt
Pmdyb3VwKSkpIHsKQEAgLTEwOTUsNyArMTA5NCw3IEBAIHN0cnVjdCBpb21tdV9ncm91cCAqaG9z
dDF4X2NsaWVudF9pb21tdV9hdHRhY2goc3RydWN0IGhvc3QxeF9jbGllbnQgKmNsaWVudCwKIAkJ
CWVyciA9IGlvbW11X2F0dGFjaF9ncm91cCh0ZWdyYS0+ZG9tYWluLCBncm91cCk7CiAJCQlpZiAo
ZXJyIDwgMCkgewogCQkJCWlvbW11X2dyb3VwX3B1dChncm91cCk7Ci0JCQkJcmV0dXJuIEVSUl9Q
VFIoZXJyKTsKKwkJCQlyZXR1cm4gZXJyOwogCQkJfQogCiAJCQlpZiAoc2hhcmVkICYmICF0ZWdy
YS0+Z3JvdXApCkBAIC0xMTAzLDIyICsxMTAyLDIzIEBAIHN0cnVjdCBpb21tdV9ncm91cCAqaG9z
dDF4X2NsaWVudF9pb21tdV9hdHRhY2goc3RydWN0IGhvc3QxeF9jbGllbnQgKmNsaWVudCwKIAkJ
fQogCX0KIAotCXJldHVybiBncm91cDsKKwljbGllbnQtPmdyb3VwID0gZ3JvdXA7CisKKwlyZXR1
cm4gMDsKIH0KIAotdm9pZCBob3N0MXhfY2xpZW50X2lvbW11X2RldGFjaChzdHJ1Y3QgaG9zdDF4
X2NsaWVudCAqY2xpZW50LAotCQkJCXN0cnVjdCBpb21tdV9ncm91cCAqZ3JvdXApCit2b2lkIGhv
c3QxeF9jbGllbnRfaW9tbXVfZGV0YWNoKHN0cnVjdCBob3N0MXhfY2xpZW50ICpjbGllbnQpCiB7
CiAJc3RydWN0IGRybV9kZXZpY2UgKmRybSA9IGRldl9nZXRfZHJ2ZGF0YShjbGllbnQtPnBhcmVu
dCk7CiAJc3RydWN0IHRlZ3JhX2RybSAqdGVncmEgPSBkcm0tPmRldl9wcml2YXRlOwogCi0JaWYg
KGdyb3VwKSB7Ci0JCWlmIChncm91cCA9PSB0ZWdyYS0+Z3JvdXApIHsKLQkJCWlvbW11X2RldGFj
aF9ncm91cCh0ZWdyYS0+ZG9tYWluLCBncm91cCk7CisJaWYgKGNsaWVudC0+Z3JvdXApIHsKKwkJ
aWYgKGNsaWVudC0+Z3JvdXAgPT0gdGVncmEtPmdyb3VwKSB7CisJCQlpb21tdV9kZXRhY2hfZ3Jv
dXAodGVncmEtPmRvbWFpbiwgY2xpZW50LT5ncm91cCk7CiAJCQl0ZWdyYS0+Z3JvdXAgPSBOVUxM
OwogCQl9CiAKLQkJaW9tbXVfZ3JvdXBfcHV0KGdyb3VwKTsKKwkJaW9tbXVfZ3JvdXBfcHV0KGNs
aWVudC0+Z3JvdXApOwogCX0KIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3RlZ3Jh
L2RybS5oIGIvZHJpdmVycy9ncHUvZHJtL3RlZ3JhL2RybS5oCmluZGV4IDI5OTExZWZmOWNlYi4u
NmEwNmQ2MzZlOTMwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdGVncmEvZHJtLmgKKysr
IGIvZHJpdmVycy9ncHUvZHJtL3RlZ3JhL2RybS5oCkBAIC0xMDAsMTAgKzEwMCw4IEBAIGludCB0
ZWdyYV9kcm1fcmVnaXN0ZXJfY2xpZW50KHN0cnVjdCB0ZWdyYV9kcm0gKnRlZ3JhLAogCQkJICAg
ICAgc3RydWN0IHRlZ3JhX2RybV9jbGllbnQgKmNsaWVudCk7CiBpbnQgdGVncmFfZHJtX3VucmVn
aXN0ZXJfY2xpZW50KHN0cnVjdCB0ZWdyYV9kcm0gKnRlZ3JhLAogCQkJCXN0cnVjdCB0ZWdyYV9k
cm1fY2xpZW50ICpjbGllbnQpOwotc3RydWN0IGlvbW11X2dyb3VwICpob3N0MXhfY2xpZW50X2lv
bW11X2F0dGFjaChzdHJ1Y3QgaG9zdDF4X2NsaWVudCAqY2xpZW50LAotCQkJCQkgICAgICAgYm9v
bCBzaGFyZWQpOwotdm9pZCBob3N0MXhfY2xpZW50X2lvbW11X2RldGFjaChzdHJ1Y3QgaG9zdDF4
X2NsaWVudCAqY2xpZW50LAotCQkJCXN0cnVjdCBpb21tdV9ncm91cCAqZ3JvdXApOworaW50IGhv
c3QxeF9jbGllbnRfaW9tbXVfYXR0YWNoKHN0cnVjdCBob3N0MXhfY2xpZW50ICpjbGllbnQsIGJv
b2wgc2hhcmVkKTsKK3ZvaWQgaG9zdDF4X2NsaWVudF9pb21tdV9kZXRhY2goc3RydWN0IGhvc3Qx
eF9jbGllbnQgKmNsaWVudCk7CiAKIGludCB0ZWdyYV9kcm1faW5pdChzdHJ1Y3QgdGVncmFfZHJt
ICp0ZWdyYSwgc3RydWN0IGRybV9kZXZpY2UgKmRybSk7CiBpbnQgdGVncmFfZHJtX2V4aXQoc3Ry
dWN0IHRlZ3JhX2RybSAqdGVncmEpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3RlZ3Jh
L2dyMmQuYyBiL2RyaXZlcnMvZ3B1L2RybS90ZWdyYS9ncjJkLmMKaW5kZXggM2NiYjRhMDI5YzQx
Li41ZDVhZjlhMDVjMTggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS90ZWdyYS9ncjJkLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL3RlZ3JhL2dyMmQuYwpAQCAtMTcsNyArMTcsNiBAQCBzdHJ1
Y3QgZ3IyZF9zb2MgewogfTsKIAogc3RydWN0IGdyMmQgewotCXN0cnVjdCBpb21tdV9ncm91cCAq
Z3JvdXA7CiAJc3RydWN0IHRlZ3JhX2RybV9jbGllbnQgY2xpZW50OwogCXN0cnVjdCBob3N0MXhf
Y2hhbm5lbCAqY2hhbm5lbDsKIAlzdHJ1Y3QgY2xrICpjbGs7CkBAIC01MSw5ICs1MCw4IEBAIHN0
YXRpYyBpbnQgZ3IyZF9pbml0KHN0cnVjdCBob3N0MXhfY2xpZW50ICpjbGllbnQpCiAJCWdvdG8g
cHV0OwogCX0KIAotCWdyMmQtPmdyb3VwID0gaG9zdDF4X2NsaWVudF9pb21tdV9hdHRhY2goY2xp
ZW50LCBmYWxzZSk7Ci0JaWYgKElTX0VSUihncjJkLT5ncm91cCkpIHsKLQkJZXJyID0gUFRSX0VS
UihncjJkLT5ncm91cCk7CisJZXJyID0gaG9zdDF4X2NsaWVudF9pb21tdV9hdHRhY2goY2xpZW50
LCBmYWxzZSk7CisJaWYgKGVyciA8IDApIHsKIAkJZGV2X2VycihjbGllbnQtPmRldiwgImZhaWxl
ZCB0byBhdHRhY2ggdG8gZG9tYWluOiAlZFxuIiwgZXJyKTsKIAkJZ290byBmcmVlOwogCX0KQEAg
LTY3LDcgKzY1LDcgQEAgc3RhdGljIGludCBncjJkX2luaXQoc3RydWN0IGhvc3QxeF9jbGllbnQg
KmNsaWVudCkKIAlyZXR1cm4gMDsKIAogZGV0YWNoOgotCWhvc3QxeF9jbGllbnRfaW9tbXVfZGV0
YWNoKGNsaWVudCwgZ3IyZC0+Z3JvdXApOworCWhvc3QxeF9jbGllbnRfaW9tbXVfZGV0YWNoKGNs
aWVudCk7CiBmcmVlOgogCWhvc3QxeF9zeW5jcHRfZnJlZShjbGllbnQtPnN5bmNwdHNbMF0pOwog
cHV0OgpAQCAtODcsNyArODUsNyBAQCBzdGF0aWMgaW50IGdyMmRfZXhpdChzdHJ1Y3QgaG9zdDF4
X2NsaWVudCAqY2xpZW50KQogCWlmIChlcnIgPCAwKQogCQlyZXR1cm4gZXJyOwogCi0JaG9zdDF4
X2NsaWVudF9pb21tdV9kZXRhY2goY2xpZW50LCBncjJkLT5ncm91cCk7CisJaG9zdDF4X2NsaWVu
dF9pb21tdV9kZXRhY2goY2xpZW50KTsKIAlob3N0MXhfc3luY3B0X2ZyZWUoY2xpZW50LT5zeW5j
cHRzWzBdKTsKIAlob3N0MXhfY2hhbm5lbF9wdXQoZ3IyZC0+Y2hhbm5lbCk7CiAKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS90ZWdyYS9ncjNkLmMgYi9kcml2ZXJzL2dwdS9kcm0vdGVncmEv
Z3IzZC5jCmluZGV4IDg3YTM4NjEzNGNjNC4uYzI0OWE2YmQ4ZDUxIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vdGVncmEvZ3IzZC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90ZWdyYS9ncjNk
LmMKQEAgLTIzLDcgKzIzLDYgQEAgc3RydWN0IGdyM2Rfc29jIHsKIH07CiAKIHN0cnVjdCBncjNk
IHsKLQlzdHJ1Y3QgaW9tbXVfZ3JvdXAgKmdyb3VwOwogCXN0cnVjdCB0ZWdyYV9kcm1fY2xpZW50
IGNsaWVudDsKIAlzdHJ1Y3QgaG9zdDF4X2NoYW5uZWwgKmNoYW5uZWw7CiAJc3RydWN0IGNsayAq
Y2xrX3NlY29uZGFyeTsKQEAgLTYwLDkgKzU5LDggQEAgc3RhdGljIGludCBncjNkX2luaXQoc3Ry
dWN0IGhvc3QxeF9jbGllbnQgKmNsaWVudCkKIAkJZ290byBwdXQ7CiAJfQogCi0JZ3IzZC0+Z3Jv
dXAgPSBob3N0MXhfY2xpZW50X2lvbW11X2F0dGFjaChjbGllbnQsIGZhbHNlKTsKLQlpZiAoSVNf
RVJSKGdyM2QtPmdyb3VwKSkgewotCQllcnIgPSBQVFJfRVJSKGdyM2QtPmdyb3VwKTsKKwllcnIg
PSBob3N0MXhfY2xpZW50X2lvbW11X2F0dGFjaChjbGllbnQsIGZhbHNlKTsKKwlpZiAoZXJyIDwg
MCkgewogCQlkZXZfZXJyKGNsaWVudC0+ZGV2LCAiZmFpbGVkIHRvIGF0dGFjaCB0byBkb21haW46
ICVkXG4iLCBlcnIpOwogCQlnb3RvIGZyZWU7CiAJfQpAQCAtNzYsNyArNzQsNyBAQCBzdGF0aWMg
aW50IGdyM2RfaW5pdChzdHJ1Y3QgaG9zdDF4X2NsaWVudCAqY2xpZW50KQogCXJldHVybiAwOwog
CiBkZXRhY2g6Ci0JaG9zdDF4X2NsaWVudF9pb21tdV9kZXRhY2goY2xpZW50LCBncjNkLT5ncm91
cCk7CisJaG9zdDF4X2NsaWVudF9pb21tdV9kZXRhY2goY2xpZW50KTsKIGZyZWU6CiAJaG9zdDF4
X3N5bmNwdF9mcmVlKGNsaWVudC0+c3luY3B0c1swXSk7CiBwdXQ6CkBAIC05NSw3ICs5Myw3IEBA
IHN0YXRpYyBpbnQgZ3IzZF9leGl0KHN0cnVjdCBob3N0MXhfY2xpZW50ICpjbGllbnQpCiAJaWYg
KGVyciA8IDApCiAJCXJldHVybiBlcnI7CiAKLQlob3N0MXhfY2xpZW50X2lvbW11X2RldGFjaChj
bGllbnQsIGdyM2QtPmdyb3VwKTsKKwlob3N0MXhfY2xpZW50X2lvbW11X2RldGFjaChjbGllbnQp
OwogCWhvc3QxeF9zeW5jcHRfZnJlZShjbGllbnQtPnN5bmNwdHNbMF0pOwogCWhvc3QxeF9jaGFu
bmVsX3B1dChncjNkLT5jaGFubmVsKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Rl
Z3JhL3ZpYy5jIGIvZHJpdmVycy9ncHUvZHJtL3RlZ3JhL3ZpYy5jCmluZGV4IGU0YjE3YzdjZTcw
OC4uZDM0YjFhZGE0MjJjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdGVncmEvdmljLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL3RlZ3JhL3ZpYy5jCkBAIC0zNCw3ICszNCw2IEBAIHN0cnVj
dCB2aWMgewogCXZvaWQgX19pb21lbSAqcmVnczsKIAlzdHJ1Y3QgdGVncmFfZHJtX2NsaWVudCBj
bGllbnQ7CiAJc3RydWN0IGhvc3QxeF9jaGFubmVsICpjaGFubmVsOwotCXN0cnVjdCBpb21tdV9n
cm91cCAqZ3JvdXA7CiAJc3RydWN0IGRldmljZSAqZGV2OwogCXN0cnVjdCBjbGsgKmNsazsKIAlz
dHJ1Y3QgcmVzZXRfY29udHJvbCAqcnN0OwpAQCAtMTg4LDkgKzE4Nyw4IEBAIHN0YXRpYyBpbnQg
dmljX2luaXQoc3RydWN0IGhvc3QxeF9jbGllbnQgKmNsaWVudCkKIAlzdHJ1Y3QgdmljICp2aWMg
PSB0b192aWMoZHJtKTsKIAlpbnQgZXJyOwogCi0JdmljLT5ncm91cCA9IGhvc3QxeF9jbGllbnRf
aW9tbXVfYXR0YWNoKGNsaWVudCwgZmFsc2UpOwotCWlmIChJU19FUlIodmljLT5ncm91cCkpIHsK
LQkJZXJyID0gUFRSX0VSUih2aWMtPmdyb3VwKTsKKwllcnIgPSBob3N0MXhfY2xpZW50X2lvbW11
X2F0dGFjaChjbGllbnQsIGZhbHNlKTsKKwlpZiAoZXJyIDwgMCkgewogCQlkZXZfZXJyKHZpYy0+
ZGV2LCAiZmFpbGVkIHRvIGF0dGFjaCB0byBkb21haW46ICVkXG4iLCBlcnIpOwogCQlyZXR1cm4g
ZXJyOwogCX0KQEAgLTIyNCw3ICsyMjIsNyBAQCBzdGF0aWMgaW50IHZpY19pbml0KHN0cnVjdCBo
b3N0MXhfY2xpZW50ICpjbGllbnQpCiBmcmVlX2NoYW5uZWw6CiAJaG9zdDF4X2NoYW5uZWxfcHV0
KHZpYy0+Y2hhbm5lbCk7CiBkZXRhY2g6Ci0JaG9zdDF4X2NsaWVudF9pb21tdV9kZXRhY2goY2xp
ZW50LCB2aWMtPmdyb3VwKTsKKwlob3N0MXhfY2xpZW50X2lvbW11X2RldGFjaChjbGllbnQpOwog
CiAJcmV0dXJuIGVycjsKIH0KQEAgLTI0Niw3ICsyNDQsNyBAQCBzdGF0aWMgaW50IHZpY19leGl0
KHN0cnVjdCBob3N0MXhfY2xpZW50ICpjbGllbnQpCiAKIAlob3N0MXhfc3luY3B0X2ZyZWUoY2xp
ZW50LT5zeW5jcHRzWzBdKTsKIAlob3N0MXhfY2hhbm5lbF9wdXQodmljLT5jaGFubmVsKTsKLQlo
b3N0MXhfY2xpZW50X2lvbW11X2RldGFjaChjbGllbnQsIHZpYy0+Z3JvdXApOworCWhvc3QxeF9j
bGllbnRfaW9tbXVfZGV0YWNoKGNsaWVudCk7CiAKIAlyZXR1cm4gMDsKIH0KZGlmZiAtLWdpdCBh
L2luY2x1ZGUvbGludXgvaG9zdDF4LmggYi9pbmNsdWRlL2xpbnV4L2hvc3QxeC5oCmluZGV4IDQz
OTZjZDU2NmEzMy4uOGIyZDFhNGJmN2IxIDEwMDY0NAotLS0gYS9pbmNsdWRlL2xpbnV4L2hvc3Qx
eC5oCisrKyBiL2luY2x1ZGUvbGludXgvaG9zdDF4LmgKQEAgLTE4LDYgKzE4LDcgQEAgZW51bSBo
b3N0MXhfY2xhc3MgewogfTsKIAogc3RydWN0IGhvc3QxeF9jbGllbnQ7CitzdHJ1Y3QgaW9tbXVf
Z3JvdXA7CiAKIC8qKgogICogc3RydWN0IGhvc3QxeF9jbGllbnRfb3BzIC0gaG9zdDF4IGNsaWVu
dCBvcGVyYXRpb25zCkBAIC00NCw2ICs0NSw3IEBAIHN0cnVjdCBob3N0MXhfY2xpZW50IHsKIAlz
dHJ1Y3QgbGlzdF9oZWFkIGxpc3Q7CiAJc3RydWN0IGRldmljZSAqcGFyZW50OwogCXN0cnVjdCBk
ZXZpY2UgKmRldjsKKwlzdHJ1Y3QgaW9tbXVfZ3JvdXAgKmdyb3VwOwogCiAJY29uc3Qgc3RydWN0
IGhvc3QxeF9jbGllbnRfb3BzICpvcHM7CiAKLS0gCjIuMjMuMAoKX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmkt
ZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
L21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
