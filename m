Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 4ABEB2820EA
	for <lists+dri-devel@lfdr.de>; Sat,  3 Oct 2020 06:03:16 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 026FE6EA35;
	Sat,  3 Oct 2020 04:03:12 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-pj1-x1042.google.com (mail-pj1-x1042.google.com
 [IPv6:2607:f8b0:4864:20::1042])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7D3376EA35
 for <dri-devel@lists.freedesktop.org>; Sat,  3 Oct 2020 04:03:10 +0000 (UTC)
Received: by mail-pj1-x1042.google.com with SMTP id kk9so2135519pjb.2
 for <dri-devel@lists.freedesktop.org>; Fri, 02 Oct 2020 21:03:10 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=linaro.org; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=cGUIBEkWC11rg0RjWa3vJFsNGj9IzWP6hXBSnRH8Oaw=;
 b=K8ky0oUxql2HLFd8MIjDQvT4orFZB0O42vP9Th86mfgsKq/w1Bw9+uCz1Ta2/HnoFB
 j24YfmJIeWEFLnujUTbnF4IMDKI8YiTz+FLqWAXzVOaQs2e2RFqi8wtJyE3E6n3qKyNi
 qH0tkmk4ZV569hBY3Urp1/GsKcKSA9RbpwKfgYJ2z4b99YVFnFcO/sCabH1/MRn1NcpI
 0BQk/uZ+me85TryF1tz0BTsO8DBU8Ipy54YOrVm6gEBT31PftsbwifzC63GWBQMrwSlH
 zy7b9Dndqm8K1zZKOnFAV/0KF8W6nltmGOcln163Gh6MLRZhzqEMxG2PxAh9zn5UopWj
 5F8Q==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=cGUIBEkWC11rg0RjWa3vJFsNGj9IzWP6hXBSnRH8Oaw=;
 b=sfFzRZdcE+5PCfFtQmZxETxnXx/aSrQvFHXBLfy17js3eygxz8N7uANK+Sh0kbXXFS
 QNEreNcGg3cuHv+5yr92eDlXweMPuTcz9cIUnA5dqZCyRkMDUwqLxoO+txNyQ4mtaPHG
 6YF6BPLLbUMMVh5tySd+V9gVxTjYSNIzKtYisNyhoclqeYejcrdLZzUyzig5Y2fOzfkN
 bhNbpoz/BcVeaBbvZNMgiJ7ZK1IBrHs++GXE5SOgw14qMJVRnex0tSStzaDK08BCy3Fh
 sRwSgwZjAvw5yc6pfemopD5O0YqdFjJ13b2dxWzK+fmPJz8pfJu6wObmwba05GexGZN7
 U+9Q==
X-Gm-Message-State: AOAM533xWQb/IMjvBYjRVDZkh9QZ6y4+qSjEGPrt8kH+zKHIrtBMMHFz
 EIUXZl9EgRVLCtFNG8v9G6h13w==
X-Google-Smtp-Source: ABdhPJysIPzeniAT+FLR9ZqqO7sDU57m+f4yfcl2pxHxmYqvXhPTXVUD3/G+uEh6ZkA8UyhfKSb5GA==
X-Received: by 2002:a17:90b:3197:: with SMTP id
 hc23mr6151496pjb.78.1601697789904; 
 Fri, 02 Oct 2020 21:03:09 -0700 (PDT)
Received: from localhost.localdomain ([2601:1c2:680:1319:692:26ff:feda:3a81])
 by smtp.gmail.com with ESMTPSA id
 190sm3909290pfy.22.2020.10.02.21.03.08
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 02 Oct 2020 21:03:09 -0700 (PDT)
From: John Stultz <john.stultz@linaro.org>
To: lkml <linux-kernel@vger.kernel.org>
Subject: [PATCH v3 3/7] dma-buf: heaps: Remove heap-helpers code
Date: Sat,  3 Oct 2020 04:02:53 +0000
Message-Id: <20201003040257.62768-4-john.stultz@linaro.org>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20201003040257.62768-1-john.stultz@linaro.org>
References: <20201003040257.62768-1-john.stultz@linaro.org>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Sandeep Patil <sspatil@google.com>, dri-devel@lists.freedesktop.org,
 Ezequiel Garcia <ezequiel@collabora.com>, Robin Murphy <robin.murphy@arm.com>,
 James Jones <jajones@nvidia.com>, Liam Mark <lmark@codeaurora.org>,
 Laura Abbott <labbott@kernel.org>, Chris Goldsworthy <cgoldswo@codeaurora.org>,
 Hridya Valsaraju <hridya@google.com>,
 =?UTF-8?q?=C3=98rjan=20Eide?= <orjan.eide@arm.com>,
 linux-media@vger.kernel.org, Suren Baghdasaryan <surenb@google.com>,
 Daniel Mentz <danielmentz@google.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIGhlYXAtaGVscGVycyBjb2RlIHdhcyBub3QgYXMgZ2VuZXJpYyBhcyBpbml0aWFsbHkgaG9w
ZWQKYW5kIGl0IGlzIG5vdyBub3QgYmVpbmcgdXNlZCwgc28gcmVtb3ZlIGl0IGZyb20gdGhlIHRy
ZWUuCgpDYzogU3VtaXQgU2Vtd2FsIDxzdW1pdC5zZW13YWxAbGluYXJvLm9yZz4KQ2M6IExpYW0g
TWFyayA8bG1hcmtAY29kZWF1cm9yYS5vcmc+CkNjOiBMYXVyYSBBYmJvdHQgPGxhYmJvdHRAa2Vy
bmVsLm9yZz4KQ2M6IEJyaWFuIFN0YXJrZXkgPEJyaWFuLlN0YXJrZXlAYXJtLmNvbT4KQ2M6IEhy
aWR5YSBWYWxzYXJhanUgPGhyaWR5YUBnb29nbGUuY29tPgpDYzogU3VyZW4gQmFnaGRhc2FyeWFu
IDxzdXJlbmJAZ29vZ2xlLmNvbT4KQ2M6IFNhbmRlZXAgUGF0aWwgPHNzcGF0aWxAZ29vZ2xlLmNv
bT4KQ2M6IERhbmllbCBNZW50eiA8ZGFuaWVsbWVudHpAZ29vZ2xlLmNvbT4KQ2M6IENocmlzIEdv
bGRzd29ydGh5IDxjZ29sZHN3b0Bjb2RlYXVyb3JhLm9yZz4KQ2M6IMOYcmphbiBFaWRlIDxvcmph
bi5laWRlQGFybS5jb20+CkNjOiBSb2JpbiBNdXJwaHkgPHJvYmluLm11cnBoeUBhcm0uY29tPgpD
YzogRXplcXVpZWwgR2FyY2lhIDxlemVxdWllbEBjb2xsYWJvcmEuY29tPgpDYzogU2ltb24gU2Vy
IDxjb250YWN0QGVtZXJzaW9uLmZyPgpDYzogSmFtZXMgSm9uZXMgPGpham9uZXNAbnZpZGlhLmNv
bT4KQ2M6IGxpbnV4LW1lZGlhQHZnZXIua2VybmVsLm9yZwpDYzogZHJpLWRldmVsQGxpc3RzLmZy
ZWVkZXNrdG9wLm9yZwpTaWduZWQtb2ZmLWJ5OiBKb2huIFN0dWx0eiA8am9obi5zdHVsdHpAbGlu
YXJvLm9yZz4KLS0tCiBkcml2ZXJzL2RtYS1idWYvaGVhcHMvTWFrZWZpbGUgICAgICAgfCAgIDEg
LQogZHJpdmVycy9kbWEtYnVmL2hlYXBzL2hlYXAtaGVscGVycy5jIHwgMjcxIC0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLQogZHJpdmVycy9kbWEtYnVmL2hlYXBzL2hlYXAtaGVscGVycy5oIHwg
IDUzIC0tLS0tLQogMyBmaWxlcyBjaGFuZ2VkLCAzMjUgZGVsZXRpb25zKC0pCiBkZWxldGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9kbWEtYnVmL2hlYXBzL2hlYXAtaGVscGVycy5jCiBkZWxldGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9kbWEtYnVmL2hlYXBzL2hlYXAtaGVscGVycy5oCgpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9kbWEtYnVmL2hlYXBzL01ha2VmaWxlIGIvZHJpdmVycy9kbWEtYnVmL2hlYXBz
L01ha2VmaWxlCmluZGV4IDZlNTRjZGVjM2RhMC4uOTc0NDY3NzkxMDMyIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2RtYS1idWYvaGVhcHMvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9kbWEtYnVmL2hlYXBz
L01ha2VmaWxlCkBAIC0xLDQgKzEsMyBAQAogIyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BM
LTIuMAotb2JqLXkJCQkJCSs9IGhlYXAtaGVscGVycy5vCiBvYmotJChDT05GSUdfRE1BQlVGX0hF
QVBTX1NZU1RFTSkJKz0gc3lzdGVtX2hlYXAubwogb2JqLSQoQ09ORklHX0RNQUJVRl9IRUFQU19D
TUEpCQkrPSBjbWFfaGVhcC5vCmRpZmYgLS1naXQgYS9kcml2ZXJzL2RtYS1idWYvaGVhcHMvaGVh
cC1oZWxwZXJzLmMgYi9kcml2ZXJzL2RtYS1idWYvaGVhcHMvaGVhcC1oZWxwZXJzLmMKZGVsZXRl
ZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDlmOTY0Y2EzZjU5Yy4uMDAwMDAwMDAwMDAwCi0tLSBh
L2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9oZWFwLWhlbHBlcnMuYworKysgL2Rldi9udWxsCkBAIC0x
LDI3MSArMCwwIEBACi0vLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAotI2luY2x1
ZGUgPGxpbnV4L2RldmljZS5oPgotI2luY2x1ZGUgPGxpbnV4L2RtYS1idWYuaD4KLSNpbmNsdWRl
IDxsaW51eC9lcnIuaD4KLSNpbmNsdWRlIDxsaW51eC9oaWdobWVtLmg+Ci0jaW5jbHVkZSA8bGlu
dXgvaWRyLmg+Ci0jaW5jbHVkZSA8bGludXgvbGlzdC5oPgotI2luY2x1ZGUgPGxpbnV4L3NsYWIu
aD4KLSNpbmNsdWRlIDxsaW51eC91YWNjZXNzLmg+Ci0jaW5jbHVkZSA8bGludXgvdm1hbGxvYy5o
PgotI2luY2x1ZGUgPHVhcGkvbGludXgvZG1hLWhlYXAuaD4KLQotI2luY2x1ZGUgImhlYXAtaGVs
cGVycy5oIgotCi12b2lkIGluaXRfaGVhcF9oZWxwZXJfYnVmZmVyKHN0cnVjdCBoZWFwX2hlbHBl
cl9idWZmZXIgKmJ1ZmZlciwKLQkJCSAgICAgdm9pZCAoKmZyZWUpKHN0cnVjdCBoZWFwX2hlbHBl
cl9idWZmZXIgKikpCi17Ci0JYnVmZmVyLT5wcml2X3ZpcnQgPSBOVUxMOwotCW11dGV4X2luaXQo
JmJ1ZmZlci0+bG9jayk7Ci0JYnVmZmVyLT52bWFwX2NudCA9IDA7Ci0JYnVmZmVyLT52YWRkciA9
IE5VTEw7Ci0JYnVmZmVyLT5wYWdlY291bnQgPSAwOwotCWJ1ZmZlci0+cGFnZXMgPSBOVUxMOwot
CUlOSVRfTElTVF9IRUFEKCZidWZmZXItPmF0dGFjaG1lbnRzKTsKLQlidWZmZXItPmZyZWUgPSBm
cmVlOwotfQotCi1zdHJ1Y3QgZG1hX2J1ZiAqaGVhcF9oZWxwZXJfZXhwb3J0X2RtYWJ1ZihzdHJ1
Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICpidWZmZXIsCi0JCQkJCSAgaW50IGZkX2ZsYWdzKQotewot
CURFRklORV9ETUFfQlVGX0VYUE9SVF9JTkZPKGV4cF9pbmZvKTsKLQotCWV4cF9pbmZvLm9wcyA9
ICZoZWFwX2hlbHBlcl9vcHM7Ci0JZXhwX2luZm8uc2l6ZSA9IGJ1ZmZlci0+c2l6ZTsKLQlleHBf
aW5mby5mbGFncyA9IGZkX2ZsYWdzOwotCWV4cF9pbmZvLnByaXYgPSBidWZmZXI7Ci0KLQlyZXR1
cm4gZG1hX2J1Zl9leHBvcnQoJmV4cF9pbmZvKTsKLX0KLQotc3RhdGljIHZvaWQgKmRtYV9oZWFw
X21hcF9rZXJuZWwoc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyKQotewotCXZvaWQg
KnZhZGRyOwotCi0JdmFkZHIgPSB2bWFwKGJ1ZmZlci0+cGFnZXMsIGJ1ZmZlci0+cGFnZWNvdW50
LCBWTV9NQVAsIFBBR0VfS0VSTkVMKTsKLQlpZiAoIXZhZGRyKQotCQlyZXR1cm4gRVJSX1BUUigt
RU5PTUVNKTsKLQotCXJldHVybiB2YWRkcjsKLX0KLQotc3RhdGljIHZvaWQgZG1hX2hlYXBfYnVm
ZmVyX2Rlc3Ryb3koc3RydWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyKQotewotCWlmIChi
dWZmZXItPnZtYXBfY250ID4gMCkgewotCQlXQVJOKDEsICIlczogYnVmZmVyIHN0aWxsIG1hcHBl
ZCBpbiB0aGUga2VybmVsXG4iLCBfX2Z1bmNfXyk7Ci0JCXZ1bm1hcChidWZmZXItPnZhZGRyKTsK
LQl9Ci0KLQlidWZmZXItPmZyZWUoYnVmZmVyKTsKLX0KLQotc3RhdGljIHZvaWQgKmRtYV9oZWFw
X2J1ZmZlcl92bWFwX2dldChzdHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICpidWZmZXIpCi17Ci0J
dm9pZCAqdmFkZHI7Ci0KLQlpZiAoYnVmZmVyLT52bWFwX2NudCkgewotCQlidWZmZXItPnZtYXBf
Y250Kys7Ci0JCXJldHVybiBidWZmZXItPnZhZGRyOwotCX0KLQl2YWRkciA9IGRtYV9oZWFwX21h
cF9rZXJuZWwoYnVmZmVyKTsKLQlpZiAoSVNfRVJSKHZhZGRyKSkKLQkJcmV0dXJuIHZhZGRyOwot
CWJ1ZmZlci0+dmFkZHIgPSB2YWRkcjsKLQlidWZmZXItPnZtYXBfY250Kys7Ci0JcmV0dXJuIHZh
ZGRyOwotfQotCi1zdGF0aWMgdm9pZCBkbWFfaGVhcF9idWZmZXJfdm1hcF9wdXQoc3RydWN0IGhl
YXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyKQotewotCWlmICghLS1idWZmZXItPnZtYXBfY250KSB7
Ci0JCXZ1bm1hcChidWZmZXItPnZhZGRyKTsKLQkJYnVmZmVyLT52YWRkciA9IE5VTEw7Ci0JfQot
fQotCi1zdHJ1Y3QgZG1hX2hlYXBzX2F0dGFjaG1lbnQgewotCXN0cnVjdCBkZXZpY2UgKmRldjsK
LQlzdHJ1Y3Qgc2dfdGFibGUgdGFibGU7Ci0Jc3RydWN0IGxpc3RfaGVhZCBsaXN0OwotfTsKLQot
c3RhdGljIGludCBkbWFfaGVhcF9hdHRhY2goc3RydWN0IGRtYV9idWYgKmRtYWJ1ZiwKLQkJCSAg
IHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFjaG1lbnQpCi17Ci0Jc3RydWN0IGRtYV9o
ZWFwc19hdHRhY2htZW50ICphOwotCXN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKmJ1ZmZlciA9
IGRtYWJ1Zi0+cHJpdjsKLQlpbnQgcmV0OwotCi0JYSA9IGt6YWxsb2Moc2l6ZW9mKCphKSwgR0ZQ
X0tFUk5FTCk7Ci0JaWYgKCFhKQotCQlyZXR1cm4gLUVOT01FTTsKLQotCXJldCA9IHNnX2FsbG9j
X3RhYmxlX2Zyb21fcGFnZXMoJmEtPnRhYmxlLCBidWZmZXItPnBhZ2VzLAotCQkJCQlidWZmZXIt
PnBhZ2Vjb3VudCwgMCwKLQkJCQkJYnVmZmVyLT5wYWdlY291bnQgPDwgUEFHRV9TSElGVCwKLQkJ
CQkJR0ZQX0tFUk5FTCk7Ci0JaWYgKHJldCkgewotCQlrZnJlZShhKTsKLQkJcmV0dXJuIHJldDsK
LQl9Ci0KLQlhLT5kZXYgPSBhdHRhY2htZW50LT5kZXY7Ci0JSU5JVF9MSVNUX0hFQUQoJmEtPmxp
c3QpOwotCi0JYXR0YWNobWVudC0+cHJpdiA9IGE7Ci0KLQltdXRleF9sb2NrKCZidWZmZXItPmxv
Y2spOwotCWxpc3RfYWRkKCZhLT5saXN0LCAmYnVmZmVyLT5hdHRhY2htZW50cyk7Ci0JbXV0ZXhf
dW5sb2NrKCZidWZmZXItPmxvY2spOwotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyB2b2lkIGRt
YV9oZWFwX2RldGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmLAotCQkJICAgIHN0cnVjdCBkbWFf
YnVmX2F0dGFjaG1lbnQgKmF0dGFjaG1lbnQpCi17Ci0Jc3RydWN0IGRtYV9oZWFwc19hdHRhY2ht
ZW50ICphID0gYXR0YWNobWVudC0+cHJpdjsKLQlzdHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICpi
dWZmZXIgPSBkbWFidWYtPnByaXY7Ci0KLQltdXRleF9sb2NrKCZidWZmZXItPmxvY2spOwotCWxp
c3RfZGVsKCZhLT5saXN0KTsKLQltdXRleF91bmxvY2soJmJ1ZmZlci0+bG9jayk7Ci0KLQlzZ19m
cmVlX3RhYmxlKCZhLT50YWJsZSk7Ci0Ja2ZyZWUoYSk7Ci19Ci0KLXN0YXRpYwotc3RydWN0IHNn
X3RhYmxlICpkbWFfaGVhcF9tYXBfZG1hX2J1ZihzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICph
dHRhY2htZW50LAotCQkJCSAgICAgIGVudW0gZG1hX2RhdGFfZGlyZWN0aW9uIGRpcmVjdGlvbikK
LXsKLQlzdHJ1Y3QgZG1hX2hlYXBzX2F0dGFjaG1lbnQgKmEgPSBhdHRhY2htZW50LT5wcml2Owot
CXN0cnVjdCBzZ190YWJsZSAqdGFibGU7Ci0KLQl0YWJsZSA9ICZhLT50YWJsZTsKLQotCWlmICgh
ZG1hX21hcF9zZyhhdHRhY2htZW50LT5kZXYsIHRhYmxlLT5zZ2wsIHRhYmxlLT5uZW50cywKLQkJ
CWRpcmVjdGlvbikpCi0JCXRhYmxlID0gRVJSX1BUUigtRU5PTUVNKTsKLQlyZXR1cm4gdGFibGU7
Ci19Ci0KLXN0YXRpYyB2b2lkIGRtYV9oZWFwX3VubWFwX2RtYV9idWYoc3RydWN0IGRtYV9idWZf
YXR0YWNobWVudCAqYXR0YWNobWVudCwKLQkJCQkgICBzdHJ1Y3Qgc2dfdGFibGUgKnRhYmxlLAot
CQkJCSAgIGVudW0gZG1hX2RhdGFfZGlyZWN0aW9uIGRpcmVjdGlvbikKLXsKLQlkbWFfdW5tYXBf
c2coYXR0YWNobWVudC0+ZGV2LCB0YWJsZS0+c2dsLCB0YWJsZS0+bmVudHMsIGRpcmVjdGlvbik7
Ci19Ci0KLXN0YXRpYyB2bV9mYXVsdF90IGRtYV9oZWFwX3ZtX2ZhdWx0KHN0cnVjdCB2bV9mYXVs
dCAqdm1mKQotewotCXN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hID0gdm1mLT52bWE7Ci0Jc3Ry
dWN0IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyID0gdm1hLT52bV9wcml2YXRlX2RhdGE7Ci0K
LQlpZiAodm1mLT5wZ29mZiA+IGJ1ZmZlci0+cGFnZWNvdW50KQotCQlyZXR1cm4gVk1fRkFVTFRf
U0lHQlVTOwotCi0Jdm1mLT5wYWdlID0gYnVmZmVyLT5wYWdlc1t2bWYtPnBnb2ZmXTsKLQlnZXRf
cGFnZSh2bWYtPnBhZ2UpOwotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBjb25zdCBzdHJ1Y3Qg
dm1fb3BlcmF0aW9uc19zdHJ1Y3QgZG1hX2hlYXBfdm1fb3BzID0gewotCS5mYXVsdCA9IGRtYV9o
ZWFwX3ZtX2ZhdWx0LAotfTsKLQotc3RhdGljIGludCBkbWFfaGVhcF9tbWFwKHN0cnVjdCBkbWFf
YnVmICpkbWFidWYsIHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hKQotewotCXN0cnVjdCBoZWFw
X2hlbHBlcl9idWZmZXIgKmJ1ZmZlciA9IGRtYWJ1Zi0+cHJpdjsKLQotCWlmICgodm1hLT52bV9m
bGFncyAmIChWTV9TSEFSRUQgfCBWTV9NQVlTSEFSRSkpID09IDApCi0JCXJldHVybiAtRUlOVkFM
OwotCi0Jdm1hLT52bV9vcHMgPSAmZG1hX2hlYXBfdm1fb3BzOwotCXZtYS0+dm1fcHJpdmF0ZV9k
YXRhID0gYnVmZmVyOwotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyB2b2lkIGRtYV9oZWFwX2Rt
YV9idWZfcmVsZWFzZShzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmKQotewotCXN0cnVjdCBoZWFwX2hl
bHBlcl9idWZmZXIgKmJ1ZmZlciA9IGRtYWJ1Zi0+cHJpdjsKLQotCWRtYV9oZWFwX2J1ZmZlcl9k
ZXN0cm95KGJ1ZmZlcik7Ci19Ci0KLXN0YXRpYyBpbnQgZG1hX2hlYXBfZG1hX2J1Zl9iZWdpbl9j
cHVfYWNjZXNzKHN0cnVjdCBkbWFfYnVmICpkbWFidWYsCi0JCQkJCSAgICAgZW51bSBkbWFfZGF0
YV9kaXJlY3Rpb24gZGlyZWN0aW9uKQotewotCXN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKmJ1
ZmZlciA9IGRtYWJ1Zi0+cHJpdjsKLQlzdHJ1Y3QgZG1hX2hlYXBzX2F0dGFjaG1lbnQgKmE7Ci0J
aW50IHJldCA9IDA7Ci0KLQltdXRleF9sb2NrKCZidWZmZXItPmxvY2spOwotCi0JaWYgKGJ1ZmZl
ci0+dm1hcF9jbnQpCi0JCWludmFsaWRhdGVfa2VybmVsX3ZtYXBfcmFuZ2UoYnVmZmVyLT52YWRk
ciwgYnVmZmVyLT5zaXplKTsKLQotCWxpc3RfZm9yX2VhY2hfZW50cnkoYSwgJmJ1ZmZlci0+YXR0
YWNobWVudHMsIGxpc3QpIHsKLQkJZG1hX3N5bmNfc2dfZm9yX2NwdShhLT5kZXYsIGEtPnRhYmxl
LnNnbCwgYS0+dGFibGUubmVudHMsCi0JCQkJICAgIGRpcmVjdGlvbik7Ci0JfQotCW11dGV4X3Vu
bG9jaygmYnVmZmVyLT5sb2NrKTsKLQotCXJldHVybiByZXQ7Ci19Ci0KLXN0YXRpYyBpbnQgZG1h
X2hlYXBfZG1hX2J1Zl9lbmRfY3B1X2FjY2VzcyhzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmLAotCQkJ
CQkgICBlbnVtIGRtYV9kYXRhX2RpcmVjdGlvbiBkaXJlY3Rpb24pCi17Ci0Jc3RydWN0IGhlYXBf
aGVscGVyX2J1ZmZlciAqYnVmZmVyID0gZG1hYnVmLT5wcml2OwotCXN0cnVjdCBkbWFfaGVhcHNf
YXR0YWNobWVudCAqYTsKLQotCW11dGV4X2xvY2soJmJ1ZmZlci0+bG9jayk7Ci0KLQlpZiAoYnVm
ZmVyLT52bWFwX2NudCkKLQkJZmx1c2hfa2VybmVsX3ZtYXBfcmFuZ2UoYnVmZmVyLT52YWRkciwg
YnVmZmVyLT5zaXplKTsKLQotCWxpc3RfZm9yX2VhY2hfZW50cnkoYSwgJmJ1ZmZlci0+YXR0YWNo
bWVudHMsIGxpc3QpIHsKLQkJZG1hX3N5bmNfc2dfZm9yX2RldmljZShhLT5kZXYsIGEtPnRhYmxl
LnNnbCwgYS0+dGFibGUubmVudHMsCi0JCQkJICAgICAgIGRpcmVjdGlvbik7Ci0JfQotCW11dGV4
X3VubG9jaygmYnVmZmVyLT5sb2NrKTsKLQotCXJldHVybiAwOwotfQotCi1zdGF0aWMgdm9pZCAq
ZG1hX2hlYXBfZG1hX2J1Zl92bWFwKHN0cnVjdCBkbWFfYnVmICpkbWFidWYpCi17Ci0Jc3RydWN0
IGhlYXBfaGVscGVyX2J1ZmZlciAqYnVmZmVyID0gZG1hYnVmLT5wcml2OwotCXZvaWQgKnZhZGRy
OwotCi0JbXV0ZXhfbG9jaygmYnVmZmVyLT5sb2NrKTsKLQl2YWRkciA9IGRtYV9oZWFwX2J1ZmZl
cl92bWFwX2dldChidWZmZXIpOwotCW11dGV4X3VubG9jaygmYnVmZmVyLT5sb2NrKTsKLQotCXJl
dHVybiB2YWRkcjsKLX0KLQotc3RhdGljIHZvaWQgZG1hX2hlYXBfZG1hX2J1Zl92dW5tYXAoc3Ry
dWN0IGRtYV9idWYgKmRtYWJ1Ziwgdm9pZCAqdmFkZHIpCi17Ci0Jc3RydWN0IGhlYXBfaGVscGVy
X2J1ZmZlciAqYnVmZmVyID0gZG1hYnVmLT5wcml2OwotCi0JbXV0ZXhfbG9jaygmYnVmZmVyLT5s
b2NrKTsKLQlkbWFfaGVhcF9idWZmZXJfdm1hcF9wdXQoYnVmZmVyKTsKLQltdXRleF91bmxvY2so
JmJ1ZmZlci0+bG9jayk7Ci19Ci0KLWNvbnN0IHN0cnVjdCBkbWFfYnVmX29wcyBoZWFwX2hlbHBl
cl9vcHMgPSB7Ci0JLm1hcF9kbWFfYnVmID0gZG1hX2hlYXBfbWFwX2RtYV9idWYsCi0JLnVubWFw
X2RtYV9idWYgPSBkbWFfaGVhcF91bm1hcF9kbWFfYnVmLAotCS5tbWFwID0gZG1hX2hlYXBfbW1h
cCwKLQkucmVsZWFzZSA9IGRtYV9oZWFwX2RtYV9idWZfcmVsZWFzZSwKLQkuYXR0YWNoID0gZG1h
X2hlYXBfYXR0YWNoLAotCS5kZXRhY2ggPSBkbWFfaGVhcF9kZXRhY2gsCi0JLmJlZ2luX2NwdV9h
Y2Nlc3MgPSBkbWFfaGVhcF9kbWFfYnVmX2JlZ2luX2NwdV9hY2Nlc3MsCi0JLmVuZF9jcHVfYWNj
ZXNzID0gZG1hX2hlYXBfZG1hX2J1Zl9lbmRfY3B1X2FjY2VzcywKLQkudm1hcCA9IGRtYV9oZWFw
X2RtYV9idWZfdm1hcCwKLQkudnVubWFwID0gZG1hX2hlYXBfZG1hX2J1Zl92dW5tYXAsCi19Owpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9kbWEtYnVmL2hlYXBzL2hlYXAtaGVscGVycy5oIGIvZHJpdmVy
cy9kbWEtYnVmL2hlYXBzL2hlYXAtaGVscGVycy5oCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NApp
bmRleCA4MDVkMmRmODgwMjQuLjAwMDAwMDAwMDAwMAotLS0gYS9kcml2ZXJzL2RtYS1idWYvaGVh
cHMvaGVhcC1oZWxwZXJzLmgKKysrIC9kZXYvbnVsbApAQCAtMSw1MyArMCwwIEBACi0vKiBTUERY
LUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCAqLwotLyoKLSAqIERNQUJVRiBIZWFwcyBoZWxw
ZXIgY29kZQotICoKLSAqIENvcHlyaWdodCAoQykgMjAxMSBHb29nbGUsIEluYy4KLSAqIENvcHly
aWdodCAoQykgMjAxOSBMaW5hcm8gTHRkLgotICovCi0KLSNpZm5kZWYgX0hFQVBfSEVMUEVSU19I
Ci0jZGVmaW5lIF9IRUFQX0hFTFBFUlNfSAotCi0jaW5jbHVkZSA8bGludXgvZG1hLWhlYXAuaD4K
LSNpbmNsdWRlIDxsaW51eC9saXN0Lmg+Ci0KLS8qKgotICogc3RydWN0IGhlYXBfaGVscGVyX2J1
ZmZlciAtIGhlbHBlciBidWZmZXIgbWV0YWRhdGEKLSAqIEBoZWFwOgkJYmFjayBwb2ludGVyIHRv
IHRoZSBoZWFwIHRoZSBidWZmZXIgY2FtZSBmcm9tCi0gKiBAZG1hYnVmOgkJYmFja2luZyBkbWEt
YnVmIGZvciB0aGlzIGJ1ZmZlcgotICogQHNpemU6CQlzaXplIG9mIHRoZSBidWZmZXIKLSAqIEBw
cml2X3ZpcnQJCXBvaW50ZXIgdG8gaGVhcCBzcGVjaWZpYyBwcml2YXRlIHZhbHVlCi0gKiBAbG9j
awkJbXV0ZXh0IHRvIHByb3RlY3QgdGhlIGRhdGEgaW4gdGhpcyBzdHJ1Y3R1cmUKLSAqIEB2bWFw
X2NudAkJY291bnQgb2Ygdm1hcCByZWZlcmVuY2VzIG9uIHRoZSBidWZmZXIKLSAqIEB2YWRkcgkJ
dm1hcCdlZCB2aXJ0dWFsIGFkZHJlc3MKLSAqIEBwYWdlY291bnQJCW51bWJlciBvZiBwYWdlcyBp
biB0aGUgYnVmZmVyCi0gKiBAcGFnZXMJCWxpc3Qgb2YgcGFnZSBwb2ludGVycwotICogQGF0dGFj
aG1lbnRzCQlsaXN0IG9mIGRldmljZSBhdHRhY2htZW50cwotICoKLSAqIEBmcmVlCQloZWFwIGNh
bGxiYWNrIHRvIGZyZWUgdGhlIGJ1ZmZlcgotICovCi1zdHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVy
IHsKLQlzdHJ1Y3QgZG1hX2hlYXAgKmhlYXA7Ci0Jc3RydWN0IGRtYV9idWYgKmRtYWJ1ZjsKLQlz
aXplX3Qgc2l6ZTsKLQotCXZvaWQgKnByaXZfdmlydDsKLQlzdHJ1Y3QgbXV0ZXggbG9jazsKLQlp
bnQgdm1hcF9jbnQ7Ci0Jdm9pZCAqdmFkZHI7Ci0JcGdvZmZfdCBwYWdlY291bnQ7Ci0Jc3RydWN0
IHBhZ2UgKipwYWdlczsKLQlzdHJ1Y3QgbGlzdF9oZWFkIGF0dGFjaG1lbnRzOwotCi0Jdm9pZCAo
KmZyZWUpKHN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKmJ1ZmZlcik7Ci19OwotCi12b2lkIGlu
aXRfaGVhcF9oZWxwZXJfYnVmZmVyKHN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKmJ1ZmZlciwK
LQkJCSAgICAgdm9pZCAoKmZyZWUpKHN0cnVjdCBoZWFwX2hlbHBlcl9idWZmZXIgKikpOwotCi1z
dHJ1Y3QgZG1hX2J1ZiAqaGVhcF9oZWxwZXJfZXhwb3J0X2RtYWJ1ZihzdHJ1Y3QgaGVhcF9oZWxw
ZXJfYnVmZmVyICpidWZmZXIsCi0JCQkJCSAgaW50IGZkX2ZsYWdzKTsKLQotZXh0ZXJuIGNvbnN0
IHN0cnVjdCBkbWFfYnVmX29wcyBoZWFwX2hlbHBlcl9vcHM7Ci0jZW5kaWYgLyogX0hFQVBfSEVM
UEVSU19IICovCi0tIAoyLjE3LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVk
ZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZv
L2RyaS1kZXZlbAo=
