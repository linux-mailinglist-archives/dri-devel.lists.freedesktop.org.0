Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id AAAFC2DA34A
	for <lists+dri-devel@lfdr.de>; Mon, 14 Dec 2020 23:21:54 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D24256E158;
	Mon, 14 Dec 2020 22:21:51 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from NAM02-CY1-obe.outbound.protection.outlook.com
 (mail-eopbgr760074.outbound.protection.outlook.com [40.107.76.74])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 579FD6E158;
 Mon, 14 Dec 2020 22:21:50 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=XQx1PPBdWoo2qLFVF3w4y+WHVQFRkaafxLNfEMNCyysK9UIUSogQ+GBCgKeo/V99kUCDX32Q4cXuZlNcyoxlFn8cp671+ZS38cjM+49nU3Sf3GgM613dqCd37LC6S3IqvsYZRtxyRT3jIiJ21gipXAnQ0GXaHbfEKNHHVt97CeRtkRNmMxxKcKs2KK2Q40Df41A/4Acl9I8Ayi9aBENYGV1L5soupnRM4OmyuAxE8crxFf7iAOSIA6kN2Q+uJmsvz8GaRtRaxHcXOQR6C20k6622skHxVmdACPbJAtXb0aFHrQbpQe/fMQ5o0vERqZWHeqitHtMS5+hFhRIq+TxDPQ==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=sB9B58MTdalSGwneQeDKLAJSV+M8ibDeak7Tc64eLMk=;
 b=P4dMKYGtvzBX+Bk8vmJ6e6PH6vxFWIp3JbhW9Q4tLBL4SoBPM4bpYQbSdEBbFCLLBbYRh32nmQx6sPOspuaaFu/+QPAE0C1SS+1POOZ63z6gwwtt8Mvk3zZjxKZFwzn6EoiPXIuCT6U+YxOv4vp+6kolKXwY0917Yv7KQ3FiDoK2OaZGc5PJTFAQPmQ4Ig7v3laPzUoNkIpsI5fVOjEtIz1gRh0iXj+ihyv5K5bqhWkO0qYeKYTD5hV1mHMVXIpgqUcghN192hB8XA7dSfFlVTwOiQzi6uCmsN7dWa7BXmakK64gKAs5khQAzdjTsOKrNNLCFOAilKl2rewHC2/qFQ==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=softfail (sender ip
 is 165.204.84.17) smtp.rcpttodomain=lists.freedesktop.org
 smtp.mailfrom=amd.com; dmarc=fail (p=none sp=none pct=100) action=none
 header.from=amd.com; dkim=none (message not signed); arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=sB9B58MTdalSGwneQeDKLAJSV+M8ibDeak7Tc64eLMk=;
 b=L4XWNHRZHg5WJ9pyntRR7e6KZ9/Shk4an2lO1ZL/buD6G2b0C5TBNZOnc/l7IPT1kwZdWhVQoa69mv+IwbTnHPtaW2WylO2zJO1WX0GkduivxSlLUYK/vVy2llz9yd31CaEbqttf2pSDxKJc2mmPyU+NisMtiVTVlvR0s7kcV0k=
Received: from DM5PR12CA0063.namprd12.prod.outlook.com (2603:10b6:3:103::25)
 by BL0PR12MB4930.namprd12.prod.outlook.com (2603:10b6:208:1c8::7) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.3654.12; Mon, 14 Dec
 2020 22:21:48 +0000
Received: from DM6NAM11FT028.eop-nam11.prod.protection.outlook.com
 (2603:10b6:3:103:cafe::9e) by DM5PR12CA0063.outlook.office365.com
 (2603:10b6:3:103::25) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.3654.12 via Frontend
 Transport; Mon, 14 Dec 2020 22:21:48 +0000
X-MS-Exchange-Authentication-Results: spf=softfail (sender IP is
 165.204.84.17) smtp.mailfrom=amd.com; lists.freedesktop.org; dkim=none
 (message not signed) header.d=none;lists.freedesktop.org; dmarc=fail
 action=none header.from=amd.com;
Received-SPF: SoftFail (protection.outlook.com: domain of transitioning
 amd.com discourages use of 165.204.84.17 as permitted sender)
Received: from SATLEXMB01.amd.com (165.204.84.17) by
 DM6NAM11FT028.mail.protection.outlook.com (10.13.173.140) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id
 15.20.3654.20 via Frontend Transport; Mon, 14 Dec 2020 22:21:46 +0000
Received: from SATLEXMB04.amd.com (10.181.40.145) by SATLEXMB01.amd.com
 (10.181.40.142) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id 15.1.1979.3; Mon, 14 Dec
 2020 16:21:36 -0600
Received: from SATLEXMB01.amd.com (10.181.40.142) by SATLEXMB04.amd.com
 (10.181.40.145) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id 15.1.1979.3; Mon, 14 Dec
 2020 16:21:35 -0600
Received: from elite-desk-aura.amd.com (10.180.168.240) by SATLEXMB01.amd.com
 (10.181.40.142) with Microsoft SMTP Server id 15.1.1979.3 via
 Frontend Transport; Mon, 14 Dec 2020 16:21:35 -0600
From: Aurabindo Pillai <aurabindo.pillai@amd.com>
To: <amd-gfx@lists.freedesktop.org>, <dri-devel@lists.freedesktop.org>
Subject: [PATCH v3 3/3] drm/amd/display: Skip modeset for front porch change
Date: Mon, 14 Dec 2020 17:20:36 -0500
Message-ID: <20201214222036.561352-4-aurabindo.pillai@amd.com>
X-Mailer: git-send-email 2.29.2
In-Reply-To: <20201214222036.561352-1-aurabindo.pillai@amd.com>
References: <20201214222036.561352-1-aurabindo.pillai@amd.com>
MIME-Version: 1.0
X-EOPAttributedMessage: 0
X-MS-Office365-Filtering-HT: Tenant
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: 31e3c965-776c-46b6-877a-08d8a07ea528
X-MS-TrafficTypeDiagnostic: BL0PR12MB4930:
X-Microsoft-Antispam-PRVS: <BL0PR12MB493098D4467BDA576F3CAE518BC70@BL0PR12MB4930.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:1122;
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: RzEPzj7EKbPdLFxuAL+CowN2LSB/T5IUwXySgu8jRqL20hTNMBpZl63+NPkUibFsKuXzpkzgEXR20SNLXQUW5mq+953V7tEB2b4HXmXLlq7ondCtzw2iNolnzMqp48Dm9/Cc+dZv/5t3bsWZo/3FIHT9wHUwaHy3DF/wHKg7Z0Oygz1k3JUnu+gCjnMsxcG/ZYM5a2NagJWq+b4eBzm9fuxQ7ova2e6IVuGB/vDvdEGnAmZL8OMcaJtId5lmFybza57g4oIHJHuyFq94jhoFOKpZBsG05pMeHNlQTm7fe62ZfVcdGiT2/DzGL9zjs90Ah0x97BrJqKpAVniV4S1qpmxt6X6rcUm1uE/Zor03DN7/5q9vVfljwpjf97whkjXkFXpN/qJ5a5TwdmCSmHk/1g==
X-Forefront-Antispam-Report: CIP:165.204.84.17; CTRY:US; LANG:en; SCL:1; SRV:;
 IPV:NLI; SFV:NSPM; H:SATLEXMB01.amd.com; PTR:ErrorRetry; CAT:NONE;
 SFS:(4636009)(136003)(376002)(346002)(46966005)(26005)(70586007)(7696005)(508600001)(30864003)(450100002)(186003)(426003)(4326008)(2616005)(110136005)(44832011)(1076003)(54906003)(82310400003)(47076004)(70206006)(2906002)(8676002)(86362001)(66574015)(5660300002)(81166007)(356005)(336012)(83380400001)(8936002)(36756003);
 DIR:OUT; SFP:1101; 
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 14 Dec 2020 22:21:46.9275 (UTC)
X-MS-Exchange-CrossTenant-Network-Message-Id: 31e3c965-776c-46b6-877a-08d8a07ea528
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-OriginalAttributedTenantConnectingIp: TenantId=3dd8961f-e488-4e60-8e11-a82d994e183d; Ip=[165.204.84.17];
 Helo=[SATLEXMB01.amd.com]
X-MS-Exchange-CrossTenant-AuthSource: DM6NAM11FT028.eop-nam11.prod.protection.outlook.com
X-MS-Exchange-CrossTenant-AuthAs: Anonymous
X-MS-Exchange-CrossTenant-FromEntityHeader: HybridOnPrem
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BL0PR12MB4930
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: alexander.deucher@amd.com, aurabindo.pillai@amd.com,
 nicholas.kazlauskas@amd.com, shashank.sharma@amd.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

W1doeSZIb3ddCklub3JkZXIgdG8gZW5hYmxlIGZyZWVzeW5jIHZpZGVvIG1vZGUsIGRyaXZlciBh
ZGRzIGV4dHJhCm1vZGVzIGJhc2VkIG9uIHByZWZlcnJlZCBtb2RlcyBmb3IgY29tbW9uIGZyZWVz
eW5jIGZyYW1lIHJhdGVzLgpXaGVuIGNvbW1pdGluZyB0aGVzZSBtb2RlIGNoYW5nZXMsIGEgZnVs
bCBtb2Rlc2V0IGlzIG5vdCBuZWVkZWQuCklmIHRoZSBjaGFuZ2UgaW4gb25seSBpbiB0aGUgZnJv
bnQgcG9yY2ggdGltaW5nIHZhbHVlLCBza2lwIGZ1bGwKbW9kZXNldCBhbmQgY29udGludWUgdXNp
bmcgdGhlIHNhbWUgc3RyZWFtLgoKU2lnbmVkLW9mZi1ieTogQXVyYWJpbmRvIFBpbGxhaSA8YXVy
YWJpbmRvLnBpbGxhaUBhbWQuY29tPgpBY2tlZC1ieTogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0
aWFuLmtvZW5pZyBhdCBhbWQuY29tPgotLS0KIC4uLi9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdw
dV9kbS9hbWRncHVfZG0uYyB8IDIxMCArKysrKysrKysrKysrKystLS0KIC4uLi9ncHUvZHJtL2Ft
ZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG0uaCB8ICAgMSArCiAyIGZpbGVzIGNoYW5nZWQs
IDE3OSBpbnNlcnRpb25zKCspLCAzMiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbS5jIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG0uYwppbmRleCBjMWZmZDMzZTlkODMu
LjRiYTZiZTU5ZGNkNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2Ft
ZGdwdV9kbS9hbWRncHVfZG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1k
Z3B1X2RtL2FtZGdwdV9kbS5jCkBAIC0yMTMsNiArMjEzLDkgQEAgc3RhdGljIGJvb2wgYW1kZ3B1
X2RtX3Bzcl9kaXNhYmxlX2FsbChzdHJ1Y3QgYW1kZ3B1X2Rpc3BsYXlfbWFuYWdlciAqZG0pOwog
c3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZm9ybWF0X2luZm8gKgogYW1kX2dldF9mb3JtYXRfaW5m
byhjb25zdCBzdHJ1Y3QgZHJtX21vZGVfZmJfY21kMiAqY21kKTsKIAorc3RhdGljIGJvb2wKK2lz
X3RpbWluZ191bmNoYW5nZWRfZm9yX2ZyZWVzeW5jKHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqb2xk
X2NydGNfc3RhdGUsCisJCQkJIHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUp
OwogLyoKICAqIGRtX3ZibGFua19nZXRfY291bnRlcgogICoKQEAgLTQ5NDAsNyArNDk0Myw4IEBA
IHN0YXRpYyB2b2lkIGZpbGxfc3RyZWFtX3Byb3BlcnRpZXNfZnJvbV9kcm1fZGlzcGxheV9tb2Rl
KAogCWNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCiAJY29uc3Qgc3RydWN0
IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5lY3Rvcl9zdGF0ZSwKIAljb25zdCBzdHJ1Y3QgZGNf
c3RyZWFtX3N0YXRlICpvbGRfc3RyZWFtLAotCWludCByZXF1ZXN0ZWRfYnBjKQorCWludCByZXF1
ZXN0ZWRfYnBjLAorCWJvb2wgaXNfaW5fbW9kZXNldCkKIHsKIAlzdHJ1Y3QgZGNfY3J0Y190aW1p
bmcgKnRpbWluZ19vdXQgPSAmc3RyZWFtLT50aW1pbmc7CiAJY29uc3Qgc3RydWN0IGRybV9kaXNw
bGF5X2luZm8gKmluZm8gPSAmY29ubmVjdG9yLT5kaXNwbGF5X2luZm87CkBAIC00OTk1LDE5ICs0
OTk5LDI4IEBAIHN0YXRpYyB2b2lkIGZpbGxfc3RyZWFtX3Byb3BlcnRpZXNfZnJvbV9kcm1fZGlz
cGxheV9tb2RlKAogCQl0aW1pbmdfb3V0LT5oZG1pX3ZpYyA9IGh2X2ZyYW1lLnZpYzsKIAl9CiAK
LQl0aW1pbmdfb3V0LT5oX2FkZHJlc3NhYmxlID0gbW9kZV9pbi0+Y3J0Y19oZGlzcGxheTsKLQl0
aW1pbmdfb3V0LT5oX3RvdGFsID0gbW9kZV9pbi0+Y3J0Y19odG90YWw7Ci0JdGltaW5nX291dC0+
aF9zeW5jX3dpZHRoID0KLQkJbW9kZV9pbi0+Y3J0Y19oc3luY19lbmQgLSBtb2RlX2luLT5jcnRj
X2hzeW5jX3N0YXJ0OwotCXRpbWluZ19vdXQtPmhfZnJvbnRfcG9yY2ggPQotCQltb2RlX2luLT5j
cnRjX2hzeW5jX3N0YXJ0IC0gbW9kZV9pbi0+Y3J0Y19oZGlzcGxheTsKLQl0aW1pbmdfb3V0LT52
X3RvdGFsID0gbW9kZV9pbi0+Y3J0Y192dG90YWw7Ci0JdGltaW5nX291dC0+dl9hZGRyZXNzYWJs
ZSA9IG1vZGVfaW4tPmNydGNfdmRpc3BsYXk7Ci0JdGltaW5nX291dC0+dl9mcm9udF9wb3JjaCA9
Ci0JCW1vZGVfaW4tPmNydGNfdnN5bmNfc3RhcnQgLSBtb2RlX2luLT5jcnRjX3ZkaXNwbGF5Owot
CXRpbWluZ19vdXQtPnZfc3luY193aWR0aCA9Ci0JCW1vZGVfaW4tPmNydGNfdnN5bmNfZW5kIC0g
bW9kZV9pbi0+Y3J0Y192c3luY19zdGFydDsKLQl0aW1pbmdfb3V0LT5waXhfY2xrXzEwMGh6ID0g
bW9kZV9pbi0+Y3J0Y19jbG9jayAqIDEwOworCWlmIChpc19pbl9tb2Rlc2V0KSB7CisJCXRpbWlu
Z19vdXQtPmhfYWRkcmVzc2FibGUgPSBtb2RlX2luLT5oZGlzcGxheTsKKwkJdGltaW5nX291dC0+
aF90b3RhbCA9IG1vZGVfaW4tPmh0b3RhbDsKKwkJdGltaW5nX291dC0+aF9zeW5jX3dpZHRoID0g
bW9kZV9pbi0+aHN5bmNfZW5kIC0gbW9kZV9pbi0+aHN5bmNfc3RhcnQ7CisJCXRpbWluZ19vdXQt
PmhfZnJvbnRfcG9yY2ggPSBtb2RlX2luLT5oc3luY19zdGFydCAtIG1vZGVfaW4tPmhkaXNwbGF5
OworCQl0aW1pbmdfb3V0LT52X3RvdGFsID0gbW9kZV9pbi0+dnRvdGFsOworCQl0aW1pbmdfb3V0
LT52X2FkZHJlc3NhYmxlID0gbW9kZV9pbi0+dmRpc3BsYXk7CisJCXRpbWluZ19vdXQtPnZfZnJv
bnRfcG9yY2ggPSBtb2RlX2luLT52c3luY19zdGFydCAtIG1vZGVfaW4tPnZkaXNwbGF5OworCQl0
aW1pbmdfb3V0LT52X3N5bmNfd2lkdGggPSBtb2RlX2luLT52c3luY19lbmQgLSBtb2RlX2luLT52
c3luY19zdGFydDsKKwkJdGltaW5nX291dC0+cGl4X2Nsa18xMDBoeiA9IG1vZGVfaW4tPmNsb2Nr
ICogMTA7CisJfSBlbHNlIHsKKwkJdGltaW5nX291dC0+aF9hZGRyZXNzYWJsZSA9IG1vZGVfaW4t
PmNydGNfaGRpc3BsYXk7CisJCXRpbWluZ19vdXQtPmhfdG90YWwgPSBtb2RlX2luLT5jcnRjX2h0
b3RhbDsKKwkJdGltaW5nX291dC0+aF9zeW5jX3dpZHRoID0gbW9kZV9pbi0+Y3J0Y19oc3luY19l
bmQgLSBtb2RlX2luLT5jcnRjX2hzeW5jX3N0YXJ0OworCQl0aW1pbmdfb3V0LT5oX2Zyb250X3Bv
cmNoID0gbW9kZV9pbi0+Y3J0Y19oc3luY19zdGFydCAtIG1vZGVfaW4tPmNydGNfaGRpc3BsYXk7
CisJCXRpbWluZ19vdXQtPnZfdG90YWwgPSBtb2RlX2luLT5jcnRjX3Z0b3RhbDsKKwkJdGltaW5n
X291dC0+dl9hZGRyZXNzYWJsZSA9IG1vZGVfaW4tPmNydGNfdmRpc3BsYXk7CisJCXRpbWluZ19v
dXQtPnZfZnJvbnRfcG9yY2ggPSBtb2RlX2luLT5jcnRjX3ZzeW5jX3N0YXJ0IC0gbW9kZV9pbi0+
Y3J0Y192ZGlzcGxheTsKKwkJdGltaW5nX291dC0+dl9zeW5jX3dpZHRoID0gbW9kZV9pbi0+Y3J0
Y192c3luY19lbmQgLSBtb2RlX2luLT5jcnRjX3ZzeW5jX3N0YXJ0OworCQl0aW1pbmdfb3V0LT5w
aXhfY2xrXzEwMGh6ID0gbW9kZV9pbi0+Y3J0Y19jbG9jayAqIDEwOworCX0KKwogCXRpbWluZ19v
dXQtPmFzcGVjdF9yYXRpbyA9IGdldF9hc3BlY3RfcmF0aW8obW9kZV9pbik7CiAKIAlzdHJlYW0t
Pm91dHB1dF9jb2xvcl9zcGFjZSA9IGdldF9vdXRwdXRfY29sb3Jfc3BhY2UodGltaW5nX291dCk7
CkBAIC01MjI3LDYgKzUyNDAsMjQgQEAgZ2V0X2hpZ2hlc3RfcmVmcmVzaF9yYXRlX21vZGUoc3Ry
dWN0IGFtZGdwdV9kbV9jb25uZWN0b3IgKmFjb25uZWN0b3IsCiAJcmV0dXJuIG1fcHJlZjsKIH0K
IAorc3RhdGljIGJvb2wgaXNfZnJlZXN5bmNfdmlkZW9fbW9kZShzdHJ1Y3QgZHJtX2Rpc3BsYXlf
bW9kZSAqbW9kZSwKKwkJCQkgICBzdHJ1Y3QgYW1kZ3B1X2RtX2Nvbm5lY3RvciAqYWNvbm5lY3Rv
cikKK3sKKwlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqaGlnaF9tb2RlOworCisJaGlnaF9tb2Rl
ID0gZ2V0X2hpZ2hlc3RfcmVmcmVzaF9yYXRlX21vZGUoYWNvbm5lY3RvciwgZmFsc2UpOworCWlm
ICghaGlnaF9tb2RlIHx8ICFtb2RlKQorCQlyZXR1cm4gZmFsc2U7CisKKwlpZiAoaGlnaF9tb2Rl
LT5jbG9jayA9PSAwIHx8CisJICAgIGhpZ2hfbW9kZS0+aGRpc3BsYXkgIT0gbW9kZS0+aGRpc3Bs
YXkgfHwKKwkgICAgaGlnaF9tb2RlLT52ZGlzcGxheSAhPSBtb2RlLT52ZGlzcGxheSB8fAorCSAg
ICBoaWdoX21vZGUtPmNsb2NrICE9IG1vZGUtPmNsb2NrKQorCQlyZXR1cm4gZmFsc2U7CisJZWxz
ZQorCQlyZXR1cm4gdHJ1ZTsKK30KKwogc3RhdGljIHN0cnVjdCBkY19zdHJlYW1fc3RhdGUgKgog
Y3JlYXRlX3N0cmVhbV9mb3Jfc2luayhzdHJ1Y3QgYW1kZ3B1X2RtX2Nvbm5lY3RvciAqYWNvbm5l
Y3RvciwKIAkJICAgICAgIGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICpkcm1fbW9kZSwK
QEAgLTUyNDAsMTUgKzUyNzEsMjEgQEAgY3JlYXRlX3N0cmVhbV9mb3Jfc2luayhzdHJ1Y3QgYW1k
Z3B1X2RtX2Nvbm5lY3RvciAqYWNvbm5lY3RvciwKIAkJZG1fc3RhdGUgPyAmZG1fc3RhdGUtPmJh
c2UgOiBOVUxMOwogCXN0cnVjdCBkY19zdHJlYW1fc3RhdGUgKnN0cmVhbSA9IE5VTEw7CiAJc3Ry
dWN0IGRybV9kaXNwbGF5X21vZGUgbW9kZSA9ICpkcm1fbW9kZTsKKwlzdHJ1Y3QgZHJtX2Rpc3Bs
YXlfbW9kZSBzYXZlZF9tb2RlOworCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICpmcmVlc3luY19t
b2RlID0gTlVMTDsKIAlib29sIG5hdGl2ZV9tb2RlX2ZvdW5kID0gZmFsc2U7CiAJYm9vbCBzY2Fs
ZSA9IGRtX3N0YXRlID8gKGRtX3N0YXRlLT5zY2FsaW5nICE9IFJNWF9PRkYpIDogZmFsc2U7CiAJ
aW50IG1vZGVfcmVmcmVzaDsKIAlpbnQgcHJlZmVycmVkX3JlZnJlc2ggPSAwOworCWJvb2wgaXNf
ZnNfdmlkX21vZGUgPSAwOwogI2lmIGRlZmluZWQoQ09ORklHX0RSTV9BTURfRENfRENOKQogCXN0
cnVjdCBkc2NfZGVjX2RwY2RfY2FwcyBkc2NfY2FwczsKIAl1aW50MzJfdCBsaW5rX2JhbmR3aWR0
aF9rYnBzOwogI2VuZGlmCiAJc3RydWN0IGRjX3NpbmsgKnNpbmsgPSBOVUxMOworCisJbWVtc2V0
KCZzYXZlZF9tb2RlLCAwLCBzaXplb2Yoc3RydWN0IGRybV9kaXNwbGF5X21vZGUpKTsKKwogCWlm
IChhY29ubmVjdG9yID09IE5VTEwpIHsKIAkJRFJNX0VSUk9SKCJhY29ubmVjdG9yIGlzIE5VTEwh
XG4iKTsKIAkJcmV0dXJuIHN0cmVhbTsKQEAgLTUzMDEsMjUgKzUzMzgsMzkgQEAgY3JlYXRlX3N0
cmVhbV9mb3Jfc2luayhzdHJ1Y3QgYW1kZ3B1X2RtX2Nvbm5lY3RvciAqYWNvbm5lY3RvciwKIAkJ
ICovCiAJCURSTV9ERUJVR19EUklWRVIoIk5vIHByZWZlcnJlZCBtb2RlIGZvdW5kXG4iKTsKIAl9
IGVsc2UgewotCQlkZWNpZGVfY3J0Y190aW1pbmdfZm9yX2RybV9kaXNwbGF5X21vZGUoCisJCWlz
X2ZzX3ZpZF9tb2RlID0gaXNfZnJlZXN5bmNfdmlkZW9fbW9kZSgmbW9kZSwgYWNvbm5lY3Rvcik7
CisJCWlmIChpc19mc192aWRfbW9kZSkgeworCQkJZnJlZXN5bmNfbW9kZSA9IGdldF9oaWdoZXN0
X3JlZnJlc2hfcmF0ZV9tb2RlKGFjb25uZWN0b3IsIGZhbHNlKTsKKwkJCXNhdmVkX21vZGUgPSBt
b2RlOworCQkJbW9kZSA9ICpmcmVlc3luY19tb2RlOworCQl9CisKKwkJaWYgKCFpc19mc192aWRf
bW9kZSkKKwkJCWRlY2lkZV9jcnRjX3RpbWluZ19mb3JfZHJtX2Rpc3BsYXlfbW9kZSgKIAkJCQkm
bW9kZSwgcHJlZmVycmVkX21vZGUsCiAJCQkJZG1fc3RhdGUgPyAoZG1fc3RhdGUtPnNjYWxpbmcg
IT0gUk1YX09GRikgOiBmYWxzZSk7CisKIAkJcHJlZmVycmVkX3JlZnJlc2ggPSBkcm1fbW9kZV92
cmVmcmVzaChwcmVmZXJyZWRfbW9kZSk7CiAJfQogCiAJaWYgKCFkbV9zdGF0ZSkKIAkJZHJtX21v
ZGVfc2V0X2NydGNpbmZvKCZtb2RlLCAwKTsKIAotCS8qCisJaWYgKGRtX3N0YXRlICYmIGlzX2Zz
X3ZpZF9tb2RlKQorCQlkcm1fbW9kZV9zZXRfY3J0Y2luZm8oJnNhdmVkX21vZGUsIDApOworCisg
ICAgICAgLyoKIAkqIElmIHNjYWxpbmcgaXMgZW5hYmxlZCBhbmQgcmVmcmVzaCByYXRlIGRpZG4n
dCBjaGFuZ2UKIAkqIHdlIGNvcHkgdGhlIHZpYyBhbmQgcG9sYXJpdGllcyBvZiB0aGUgb2xkIHRp
bWluZ3MKIAkqLwotCWlmICghc2NhbGUgfHwgbW9kZV9yZWZyZXNoICE9IHByZWZlcnJlZF9yZWZy
ZXNoKQotCQlmaWxsX3N0cmVhbV9wcm9wZXJ0aWVzX2Zyb21fZHJtX2Rpc3BsYXlfbW9kZShzdHJl
YW0sCi0JCQkmbW9kZSwgJmFjb25uZWN0b3ItPmJhc2UsIGNvbl9zdGF0ZSwgTlVMTCwgcmVxdWVz
dGVkX2JwYyk7CisJaWYgKCEoc2NhbGUgJiYgaXNfZnNfdmlkX21vZGUpIHx8IG1vZGVfcmVmcmVz
aCAhPSBwcmVmZXJyZWRfcmVmcmVzaCkKKwkJZmlsbF9zdHJlYW1fcHJvcGVydGllc19mcm9tX2Ry
bV9kaXNwbGF5X21vZGUoCisJCQlzdHJlYW0sICZtb2RlLCAmYWNvbm5lY3Rvci0+YmFzZSwgY29u
X3N0YXRlLCBOVUxMLAorCQkJcmVxdWVzdGVkX2JwYywgZG1fc3RhdGUgPyAxIDogMCk7CiAJZWxz
ZQotCQlmaWxsX3N0cmVhbV9wcm9wZXJ0aWVzX2Zyb21fZHJtX2Rpc3BsYXlfbW9kZShzdHJlYW0s
Ci0JCQkmbW9kZSwgJmFjb25uZWN0b3ItPmJhc2UsIGNvbl9zdGF0ZSwgb2xkX3N0cmVhbSwgcmVx
dWVzdGVkX2JwYyk7CisJCWZpbGxfc3RyZWFtX3Byb3BlcnRpZXNfZnJvbV9kcm1fZGlzcGxheV9t
b2RlKAorCQkJc3RyZWFtLCAmbW9kZSwgJmFjb25uZWN0b3ItPmJhc2UsIGNvbl9zdGF0ZSwgb2xk
X3N0cmVhbSwKKwkJCXJlcXVlc3RlZF9icGMsIGRtX3N0YXRlID8gMSA6IDApOwogCiAJc3RyZWFt
LT50aW1pbmcuZmxhZ3MuRFNDID0gMDsKIApAQCAtNzg0NCwxMyArNzg5NSwyOSBAQCBzdGF0aWMg
dm9pZCB1cGRhdGVfc3RyZWFtX2lycV9wYXJhbWV0ZXJzKAogCWlmIChuZXdfY3J0Y19zdGF0ZS0+
dnJyX3N1cHBvcnRlZCAmJgogCSAgICBjb25maWcubWluX3JlZnJlc2hfaW5fdWh6ICYmCiAJICAg
IGNvbmZpZy5tYXhfcmVmcmVzaF9pbl91aHopIHsKKwkJLyoKKwkJICogaWYgZnJlZXN5bmMgY29t
cGF0aWJsZSBtb2RlIHdhcyBzZXQsIGNvbmZpZy5zdGF0ZSB3aWxsIGJlIHNldAorCQkgKiBpbiBh
dG9taWMgY2hlY2sKKwkJICovCisJCWlmIChjb25maWcuc3RhdGUgPT0gVlJSX1NUQVRFX0FDVElW
RV9GSVhFRCAmJgorCQkgICAgY29uZmlnLmZpeGVkX3JlZnJlc2hfaW5fdWh6ICYmIGNvbmZpZy5t
YXhfcmVmcmVzaF9pbl91aHogJiYKKwkJICAgIGNvbmZpZy5taW5fcmVmcmVzaF9pbl91aHogJiYK
KwkJICAgICghZHJtX2F0b21pY19jcnRjX25lZWRzX21vZGVzZXQoJm5ld19jcnRjX3N0YXRlLT5i
YXNlKSB8fAorCQkgICAgIG5ld19jcnRjX3N0YXRlLT5mcmVlc3luY192aWRlb19tb2RlKSkgewor
CQkJdnJyX3BhcmFtcy5tYXhfcmVmcmVzaF9pbl91aHogPSBjb25maWcubWF4X3JlZnJlc2hfaW5f
dWh6OworCQkJdnJyX3BhcmFtcy5taW5fcmVmcmVzaF9pbl91aHogPSBjb25maWcubWluX3JlZnJl
c2hfaW5fdWh6OworCQkJdnJyX3BhcmFtcy5maXhlZF9yZWZyZXNoX2luX3VoeiA9IGNvbmZpZy5m
aXhlZF9yZWZyZXNoX2luX3VoejsKKwkJCXZycl9wYXJhbXMuc3RhdGUgPSBWUlJfU1RBVEVfQUNU
SVZFX0ZJWEVEOworCQkJZ290byBvdXQ7CisJCX0KKwogCQljb25maWcuc3RhdGUgPSBuZXdfY3J0
Y19zdGF0ZS0+YmFzZS52cnJfZW5hYmxlZCA/CiAJCQlWUlJfU1RBVEVfQUNUSVZFX1ZBUklBQkxF
IDoKIAkJCVZSUl9TVEFURV9JTkFDVElWRTsKLQl9IGVsc2UgeworCX0gZWxzZQogCQljb25maWcu
c3RhdGUgPSBWUlJfU1RBVEVfVU5TVVBQT1JURUQ7Ci0JfQogCitvdXQ6CiAJbW9kX2ZyZWVzeW5j
X2J1aWxkX3Zycl9wYXJhbXMoZG0tPmZyZWVzeW5jX21vZHVsZSwKIAkJCQkgICAgICBuZXdfc3Ry
ZWFtLAogCQkJCSAgICAgICZjb25maWcsICZ2cnJfcGFyYW1zKTsKQEAgLTgxNjgsNyArODIzNSw5
IEBAIHN0YXRpYyB2b2lkIGFtZGdwdV9kbV9jb21taXRfcGxhbmVzKHN0cnVjdCBkcm1fYXRvbWlj
X3N0YXRlICpzdGF0ZSwKIAkJICogYXMgcGFydCBvZiBjb21taXQuCiAJCSAqLwogCQlpZiAoYW1k
Z3B1X2RtX3Zycl9hY3RpdmUoZG1fb2xkX2NydGNfc3RhdGUpICE9Ci0JCSAgICBhbWRncHVfZG1f
dnJyX2FjdGl2ZShhY3J0Y19zdGF0ZSkpIHsKKwkJICAgIGFtZGdwdV9kbV92cnJfYWN0aXZlKGFj
cnRjX3N0YXRlKSB8fAorCQkgICAgYWNydGNfc3RhdGUtPmZyZWVzeW5jX2NvbmZpZy5zdGF0ZSA9
PSBWUlJfU1RBVEVfQUNUSVZFX0ZJWEVEIHx8CisJCSAgICBhY3J0Y19zdGF0ZS0+ZnJlZXN5bmNf
dmlkZW9fbW9kZSkgewogCQkJc3Bpbl9sb2NrX2lycXNhdmUoJnBjcnRjLT5kZXYtPmV2ZW50X2xv
Y2ssIGZsYWdzKTsKIAkJCWRjX3N0cmVhbV9hZGp1c3Rfdm1pbl92bWF4KAogCQkJCWRtLT5kYywg
YWNydGNfc3RhdGUtPnN0cmVhbSwKQEAgLTg4NjQsNiArODkzMyw3IEBAIHN0YXRpYyB2b2lkIGdl
dF9mcmVlc3luY19jb25maWdfZm9yX2NydGMoCiAJCQl0b19hbWRncHVfZG1fY29ubmVjdG9yKG5l
d19jb25fc3RhdGUtPmJhc2UuY29ubmVjdG9yKTsKIAlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAq
bW9kZSA9ICZuZXdfY3J0Y19zdGF0ZS0+YmFzZS5tb2RlOwogCWludCB2cmVmcmVzaCA9IGRybV9t
b2RlX3ZyZWZyZXNoKG1vZGUpOworCWJvb2wgZnNfdmlkX21vZGUgPSBmYWxzZTsKIAogCW5ld19j
cnRjX3N0YXRlLT52cnJfc3VwcG9ydGVkID0gbmV3X2Nvbl9zdGF0ZS0+ZnJlZXN5bmNfY2FwYWJs
ZSAmJgogCQkJCQl2cmVmcmVzaCA+PSBhY29ubmVjdG9yLT5taW5fdmZyZXEgJiYKQEAgLTg4NzEs
MTcgKzg5NDEsMjYgQEAgc3RhdGljIHZvaWQgZ2V0X2ZyZWVzeW5jX2NvbmZpZ19mb3JfY3J0YygK
IAogCWlmIChuZXdfY3J0Y19zdGF0ZS0+dnJyX3N1cHBvcnRlZCkgewogCQluZXdfY3J0Y19zdGF0
ZS0+c3RyZWFtLT5pZ25vcmVfbXNhX3RpbWluZ19wYXJhbSA9IHRydWU7Ci0JCWNvbmZpZy5zdGF0
ZSA9IG5ld19jcnRjX3N0YXRlLT5iYXNlLnZycl9lbmFibGVkID8KLQkJCQlWUlJfU1RBVEVfQUNU
SVZFX1ZBUklBQkxFIDoKLQkJCQlWUlJfU1RBVEVfSU5BQ1RJVkU7Ci0JCWNvbmZpZy5taW5fcmVm
cmVzaF9pbl91aHogPQotCQkJCWFjb25uZWN0b3ItPm1pbl92ZnJlcSAqIDEwMDAwMDA7Ci0JCWNv
bmZpZy5tYXhfcmVmcmVzaF9pbl91aHogPQotCQkJCWFjb25uZWN0b3ItPm1heF92ZnJlcSAqIDEw
MDAwMDA7CisJCWZzX3ZpZF9tb2RlID0gbmV3X2NydGNfc3RhdGUtPmZyZWVzeW5jX2NvbmZpZy5z
dGF0ZSA9PSBWUlJfU1RBVEVfQUNUSVZFX0ZJWEVEIHx8CisJCQluZXdfY3J0Y19zdGF0ZS0+ZnJl
ZXN5bmNfdmlkZW9fbW9kZTsKKworCQljb25maWcubWluX3JlZnJlc2hfaW5fdWh6ID0gYWNvbm5l
Y3Rvci0+bWluX3ZmcmVxICogMTAwMDAwMDsKKwkJY29uZmlnLm1heF9yZWZyZXNoX2luX3VoeiA9
IGFjb25uZWN0b3ItPm1heF92ZnJlcSAqIDEwMDAwMDA7CiAJCWNvbmZpZy52c2lmX3N1cHBvcnRl
ZCA9IHRydWU7CiAJCWNvbmZpZy5idHIgPSB0cnVlOwotCX0KIAorCQlpZiAoZnNfdmlkX21vZGUp
IHsKKwkJCWNvbmZpZy5zdGF0ZSA9IFZSUl9TVEFURV9BQ1RJVkVfRklYRUQ7CisJCQljb25maWcu
Zml4ZWRfcmVmcmVzaF9pbl91aHogPSBuZXdfY3J0Y19zdGF0ZS0+ZnJlZXN5bmNfY29uZmlnLmZp
eGVkX3JlZnJlc2hfaW5fdWh6OworCQkJZ290byBvdXQ7CisJCX0KKwkJZWxzZSBpZiAobmV3X2Ny
dGNfc3RhdGUtPmJhc2UudnJyX2VuYWJsZWQgJiYgIWZzX3ZpZF9tb2RlKQorCQkJY29uZmlnLnN0
YXRlID0gVlJSX1NUQVRFX0FDVElWRV9WQVJJQUJMRTsKKwkJZWxzZQorCQkJY29uZmlnLnN0YXRl
ID0gVlJSX1NUQVRFX0lOQUNUSVZFOworCisJfQorb3V0OgogCW5ld19jcnRjX3N0YXRlLT5mcmVl
c3luY19jb25maWcgPSBjb25maWc7CiB9CiAKQEAgLTg4OTQsNiArODk3Myw1MSBAQCBzdGF0aWMg
dm9pZCByZXNldF9mcmVlc3luY19jb25maWdfZm9yX2NydGMoCiAJICAgICAgIHNpemVvZihuZXdf
Y3J0Y19zdGF0ZS0+dnJyX2luZm9wYWNrZXQpKTsKIH0KIAorc3RhdGljIGJvb2wKK2lzX3RpbWlu
Z191bmNoYW5nZWRfZm9yX2ZyZWVzeW5jKHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqb2xkX2NydGNf
c3RhdGUsCisJCQkJIHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUpCit7CisJ
c3RydWN0IGRybV9kaXNwbGF5X21vZGUgb2xkX21vZGUsIG5ld19tb2RlOworCisJaWYgKCFvbGRf
Y3J0Y19zdGF0ZSB8fCAhbmV3X2NydGNfc3RhdGUpCisJCXJldHVybiBmYWxzZTsKKworCW9sZF9t
b2RlID0gb2xkX2NydGNfc3RhdGUtPm1vZGU7CisJbmV3X21vZGUgPSBuZXdfY3J0Y19zdGF0ZS0+
bW9kZTsKKworCWlmIChvbGRfbW9kZS5jbG9jayAgICAgICA9PSBuZXdfbW9kZS5jbG9jayAmJgor
CSAgICBvbGRfbW9kZS5oZGlzcGxheSAgICA9PSBuZXdfbW9kZS5oZGlzcGxheSAmJgorCSAgICBv
bGRfbW9kZS52ZGlzcGxheSAgICA9PSBuZXdfbW9kZS52ZGlzcGxheSAmJgorCSAgICBvbGRfbW9k
ZS5odG90YWwgICAgICA9PSBuZXdfbW9kZS5odG90YWwgJiYKKwkgICAgb2xkX21vZGUudnRvdGFs
ICAgICAgIT0gbmV3X21vZGUudnRvdGFsICYmCisJICAgIG9sZF9tb2RlLmhzeW5jX3N0YXJ0ID09
IG5ld19tb2RlLmhzeW5jX3N0YXJ0ICYmCisJICAgIG9sZF9tb2RlLnZzeW5jX3N0YXJ0ICE9IG5l
d19tb2RlLnZzeW5jX3N0YXJ0ICYmCisJICAgIG9sZF9tb2RlLmhzeW5jX2VuZCAgID09IG5ld19t
b2RlLmhzeW5jX2VuZCAmJgorCSAgICBvbGRfbW9kZS52c3luY19lbmQgICAhPSBuZXdfbW9kZS52
c3luY19lbmQgJiYKKwkgICAgb2xkX21vZGUuaHNrZXcgICAgICAgPT0gbmV3X21vZGUuaHNrZXcg
JiYKKwkgICAgb2xkX21vZGUudnNjYW4gICAgICAgPT0gbmV3X21vZGUudnNjYW4gJiYKKwkgICAg
KG9sZF9tb2RlLnZzeW5jX2VuZCAtIG9sZF9tb2RlLnZzeW5jX3N0YXJ0KSA9PQorCSAgICAobmV3
X21vZGUudnN5bmNfZW5kIC0gbmV3X21vZGUudnN5bmNfc3RhcnQpKQorCQlyZXR1cm4gdHJ1ZTsK
KworCXJldHVybiBmYWxzZTsKK30KKworc3RhdGljIHZvaWQgc2V0X2ZyZWVzeW5jX2ZpeGVkX2Nv
bmZpZyhzdHJ1Y3QgZG1fY3J0Y19zdGF0ZSAqZG1fbmV3X2NydGNfc3RhdGUpIHsKKwl1aW50NjRf
dCBudW0sIGRlbiwgcmVzOworCXN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUg
PSAmZG1fbmV3X2NydGNfc3RhdGUtPmJhc2U7CisKKwlkbV9uZXdfY3J0Y19zdGF0ZS0+ZnJlZXN5
bmNfY29uZmlnLnN0YXRlID0gVlJSX1NUQVRFX0FDVElWRV9GSVhFRDsKKworCW51bSA9ICh1bnNp
Z25lZCBsb25nIGxvbmcpbmV3X2NydGNfc3RhdGUtPm1vZGUuY2xvY2sgKiAxMDAwICogMTAwMDAw
MDsKKwlkZW4gPSAodW5zaWduZWQgbG9uZyBsb25nKW5ld19jcnRjX3N0YXRlLT5tb2RlLmh0b3Rh
bCAqCisJICAgICAgKHVuc2lnbmVkIGxvbmcgbG9uZyluZXdfY3J0Y19zdGF0ZS0+bW9kZS52dG90
YWw7CisKKwlyZXMgPSBkaXZfdTY0KG51bSwgZGVuKTsKKwlkbV9uZXdfY3J0Y19zdGF0ZS0+ZnJl
ZXN5bmNfY29uZmlnLmZpeGVkX3JlZnJlc2hfaW5fdWh6ID0gcmVzOworCWRtX25ld19jcnRjX3N0
YXRlLT5mcmVlc3luY192aWRlb19tb2RlID0gdHJ1ZTsKK30KKwogc3RhdGljIGludCBkbV91cGRh
dGVfY3J0Y19zdGF0ZShzdHJ1Y3QgYW1kZ3B1X2Rpc3BsYXlfbWFuYWdlciAqZG0sCiAJCQkJc3Ry
dWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCBkcm1fY3J0YyAqY3J0YywK
QEAgLTg5ODQsNiArOTEwOCwxMSBAQCBzdGF0aWMgaW50IGRtX3VwZGF0ZV9jcnRjX3N0YXRlKHN0
cnVjdCBhbWRncHVfZGlzcGxheV9tYW5hZ2VyICpkbSwKIAkJICogVE9ETzogUmVmYWN0b3IgdGhp
cyBmdW5jdGlvbiB0byBhbGxvdyB0aGlzIGNoZWNrIHRvIHdvcmsKIAkJICogaW4gYWxsIGNvbmRp
dGlvbnMuCiAJCSAqLworCQlpZiAoZG1fbmV3X2NydGNfc3RhdGUtPnN0cmVhbSAmJgorCQkgICAg
aXNfdGltaW5nX3VuY2hhbmdlZF9mb3JfZnJlZXN5bmMobmV3X2NydGNfc3RhdGUsIG9sZF9jcnRj
X3N0YXRlKSAmJgorCQkgICAgYW1kZ3B1X2V4cF9mcmVlc3luY192aWRfbW9kZSkKKwkJCWdvdG8g
c2tpcF9tb2Rlc2V0OworCiAJCWlmIChkbV9uZXdfY3J0Y19zdGF0ZS0+c3RyZWFtICYmCiAJCSAg
ICBkY19pc19zdHJlYW1fdW5jaGFuZ2VkKG5ld19zdHJlYW0sIGRtX29sZF9jcnRjX3N0YXRlLT5z
dHJlYW0pICYmCiAJCSAgICBkY19pc19zdHJlYW1fc2NhbGluZ191bmNoYW5nZWQobmV3X3N0cmVh
bSwgZG1fb2xkX2NydGNfc3RhdGUtPnN0cmVhbSkpIHsKQEAgLTkwMTUsNiArOTE0NCwyMyBAQCBz
dGF0aWMgaW50IGRtX3VwZGF0ZV9jcnRjX3N0YXRlKHN0cnVjdCBhbWRncHVfZGlzcGxheV9tYW5h
Z2VyICpkbSwKIAkJaWYgKCFkbV9vbGRfY3J0Y19zdGF0ZS0+c3RyZWFtKQogCQkJZ290byBza2lw
X21vZGVzZXQ7CiAKKwkJaWYgKGRtX25ld19jcnRjX3N0YXRlLT5zdHJlYW0gJiYKKwkJICAgIGlz
X3RpbWluZ191bmNoYW5nZWRfZm9yX2ZyZWVzeW5jKG5ld19jcnRjX3N0YXRlLCBvbGRfY3J0Y19z
dGF0ZSkgJiYKKwkJICAgIGFtZGdwdV9leHBfZnJlZXN5bmNfdmlkX21vZGUpIHsKKwkJCW5ld19j
cnRjX3N0YXRlLT5tb2RlX2NoYW5nZWQgPSBmYWxzZTsKKwkJCURSTV9ERUJVR19EUklWRVIoCisJ
CQkJIk1vZGUgY2hhbmdlIG5vdCByZXF1aXJlZCBmb3IgZnJvbnQgcG9yY2ggY2hhbmdlLCAiCisJ
CQkJInNldHRpbmcgbW9kZV9jaGFuZ2VkIHRvICVkIiwKKwkJCQluZXdfY3J0Y19zdGF0ZS0+bW9k
ZV9jaGFuZ2VkKTsKKworCQkJc2V0X2ZyZWVzeW5jX2ZpeGVkX2NvbmZpZyhkbV9uZXdfY3J0Y19z
dGF0ZSk7CisKKwkJCWdvdG8gc2tpcF9tb2Rlc2V0OworCQl9IGVsc2UgaWYgKGFjb25uZWN0b3Ig
JiYKKwkJCSAgIGlzX2ZyZWVzeW5jX3ZpZGVvX21vZGUoJm5ld19jcnRjX3N0YXRlLT5tb2RlLCBh
Y29ubmVjdG9yKSAmJgorCQkJICAgYW1kZ3B1X2V4cF9mcmVlc3luY192aWRfbW9kZSkKKwkJCXNl
dF9mcmVlc3luY19maXhlZF9jb25maWcoZG1fbmV3X2NydGNfc3RhdGUpOworCiAJCXJldCA9IGRt
X2F0b21pY19nZXRfc3RhdGUoc3RhdGUsICZkbV9zdGF0ZSk7CiAJCWlmIChyZXQpCiAJCQlnb3Rv
IGZhaWw7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2Rt
L2FtZGdwdV9kbS5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRn
cHVfZG0uaAppbmRleCBmNWE1ZjFhZDdkYmEuLmZkNWZiOWRhZmRlZCAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG0uaAorKysgYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbS5oCkBAIC00NTUsNiAr
NDU1LDcgQEAgc3RydWN0IGRtX2NydGNfc3RhdGUgewogCiAJYm9vbCBmcmVlc3luY190aW1pbmdf
Y2hhbmdlZDsKIAlib29sIGZyZWVzeW5jX3Zycl9pbmZvX2NoYW5nZWQ7CisJYm9vbCBmcmVlc3lu
Y192aWRlb19tb2RlOwogCiAJYm9vbCBkc2NfZm9yY2VfY2hhbmdlZDsKIAlib29sIHZycl9zdXBw
b3J0ZWQ7Ci0tIAoyLjI5LjIKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNr
dG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2Ry
aS1kZXZlbAo=
