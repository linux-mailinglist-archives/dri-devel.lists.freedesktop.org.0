Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8913D2A74D1
	for <lists+dri-devel@lfdr.de>; Thu,  5 Nov 2020 02:16:22 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 899936E974;
	Thu,  5 Nov 2020 01:16:15 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mga01.intel.com (mga01.intel.com [192.55.52.88])
 by gabe.freedesktop.org (Postfix) with ESMTPS id C93156E975
 for <dri-devel@lists.freedesktop.org>; Thu,  5 Nov 2020 01:16:12 +0000 (UTC)
IronPort-SDR: s7ZkpdFhXcNBK3CXV+P39eMNuYQBaWyv/4ANCVpiAW2mysuUrHkbZ8Hcj5/TIuz+CZhvADrYTY
 QJs1PqFND6Xg==
X-IronPort-AV: E=McAfee;i="6000,8403,9795"; a="187180175"
X-IronPort-AV: E=Sophos;i="5.77,451,1596524400"; d="scan'208";a="187180175"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga004.jf.intel.com ([10.7.209.38])
 by fmsmga101.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 04 Nov 2020 17:16:01 -0800
IronPort-SDR: SzJU96DGQ7GyzjVH8N1DC9KYwwdLk2KOIhuLKao5EWB6GxSM67ON32j23g4uHdVs0stg3gOEpl
 sH9VfBO0pmfw==
X-IronPort-AV: E=Sophos;i="5.77,451,1596524400"; d="scan'208";a="471445693"
Received: from pschung-mobl.amr.corp.intel.com (HELO
 achrisan-DESK2.amr.corp.intel.com) ([10.255.72.205])
 by orsmga004-auth.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-SHA;
 04 Nov 2020 17:16:00 -0800
From: Anitha Chrisanthus <anitha.chrisanthus@intel.com>
To: dri-devel@lists.freedesktop.org,
	anitha.chrisanthus@intel.com
Subject: [PATCH v13 6/7] drm/kmb: Mipi DSI part of the display driver
Date: Wed,  4 Nov 2020 17:15:30 -0800
Message-Id: <1604538931-26726-7-git-send-email-anitha.chrisanthus@intel.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1604538931-26726-1-git-send-email-anitha.chrisanthus@intel.com>
References: <1604538931-26726-1-git-send-email-anitha.chrisanthus@intel.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: edmund.j.dea@intel.com, sam@ravnborg.org, narmstrong@baylibre.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW5pdGlhbGl6ZXMgTWlwaSBEU0kgYW5kIHNldHMgdXAgY29ubmVjdHMgdG8gQURWIGJyaWRnZQoK
djI6IHJlbW92ZWQgbGljZW5zZSB0ZXh0CiAgICB1cGNsYXNzZWQgZGV2X3ByaXZhdGUsIHJlbW92
ZWQgSEFWRV9JUlEuIChTYW0pCgp2MzogU3F1YXNoZWQgYWxsIDU5IGNvbW1pdHMgdG8gb25lCgp2
NDogcmV2aWV3IGNoYW5nZXMgZnJvbSBTYW0gUmF2bmJvcmcKCXJlbmFtZWQgZGV2X3AgdG8ga21i
Cgp2NTogY29ycmVjdGVkIHNwZWxsaW5ncwp2NjogY29ycmVjdGVkIGNoZWNrcGF0Y2ggd2Fybmlu
Z3MKdjc6IHJldmlldyBjaGFuZ2VzIFNhbSBSYXZuYm9yZyBhbmQgVGhvbWFzIFppbW1lcm1hbgoJ
cmVtb3ZlZCB1bm5lY2Vzc2FyeSBsb2dzIGFuZCBkZWZpbmVzIGFuZCBpZmRlZiBjb2RlcyAoU2Ft
KQoJc3BsaXQgZHBoeV9pbml0X3NlcXVlbmNlIHNtYWxsZXIgKFNhbSkKCXJlbW92ZWQgcmVkdW5k
YW50IGNoZWNrcyBpbiBrbWJfZHNpIChTYW0pCgljaGFuZ2VkIGttYl9kc2lfaW5pdCB0byBkcm1f
YnJpZGdlX2Nvbm5lY3Rvcl9pbml0IGFuZAoJZHJtX2Nvbm5lY3Rvcl9hdHRhY2hfZW5jb2RlciB0
byBicmlkZ2UncyBjb25uZWN0b3IgKFNhbSkKdjg6IGNhbGwgZHJtX2JyaWRnZV9hdHRhY2ggd2l0
aCBEUk1fQlJJREdFX0FUVEFDSF9OT19DT05ORUNUT1IKdjk6IHJlbmFtZWQga21iX2RzaV9od19p
bml0IHRvIGttYl9kc2lfbW9kZV9zZXQgKERhbmllbCBWKQp2MTA6IGNoYW5nZXMgaW4gZHJpdmVy
IHRvIGFjY29tbW9kYXRlIGNoYW5nZXMgaW4gRFQgdG8gc2VwYXJhdGUgRFNJCiAgICAgZW50cmll
cyAoU2FtIFIpCiAgICAgYWRkZWQgY29tbWVudHMgdG8gY2xhcmlmeSBlbXB0eSBkc2kgaG9zdCBm
dW5jdGlvbnMKICAgICByZXZpZXcgY2hhbmdlcyBmcm9tIFNhbSB0byBzZXBhcmF0ZSBvdXQgRFNJ
IHBhcnQsCiAgICAgcmVtb3ZlZCBkZXBlbmRlbmNpZXMgb24gZHJtIHNpZGUgKFNhbSBSKQp2MTE6
IHJldmlldyBjaGFuZ2VzIGZvciBzZXBhcmF0ZSBtc3NjYW0gbm9kZSAoU2FtIFIsIE5laWwgQSkK
djEyOiBmaXhlZCB3YXJuaW5ncyBSZXBvcnRlZC1ieToga2VybmVsIHRlc3Qgcm9ib3QgPGxrcEBp
bnRlbC5jb20+CgpTaWduZWQtb2ZmLWJ5OiBBbml0aGEgQ2hyaXNhbnRodXMgPGFuaXRoYS5jaHJp
c2FudGh1c0BpbnRlbC5jb20+ClJldmlld2VkLWJ5OiBTYW0gUmF2bmJvcmcgPHNhbUByYXZuYm9y
Zy5vcmc+CkNjOiBTYW0gUmF2bmJvcmcgPHNhbUByYXZuYm9yZy5vcmc+CkNjOiBUaG9tYXMgWmlt
bWVybWFubiA8dHppbW1lcm1hbm5Ac3VzZS5kZT4KQ2M6IERhbmllbCBWZXR0ZXIgPGRhbmllbEBm
ZndsbC5jaD4KLS0tCiBkcml2ZXJzL2dwdS9kcm0va21iL2ttYl9kc2kuYyB8IDE1NjEgKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9rbWIv
a21iX2RzaS5oIHwgIDM4NyArKysrKysrKysrCiAyIGZpbGVzIGNoYW5nZWQsIDE5NDggaW5zZXJ0
aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9rbWIva21iX2RzaS5j
CiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2ttYi9rbWJfZHNpLmgKCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0va21iL2ttYl9kc2kuYyBiL2RyaXZlcnMvZ3B1L2RybS9r
bWIva21iX2RzaS5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjRiNWQ4MmEK
LS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0va21iL2ttYl9kc2kuYwpAQCAtMCww
ICsxLDE1NjEgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkKKy8q
CisgKiBDb3B5cmlnaHQgwqkgMjAxOS0yMDIwIEludGVsIENvcnBvcmF0aW9uCisgKi8KKworI2lu
Y2x1ZGUgPGxpbnV4L2Nsay5oPgorI2luY2x1ZGUgPGxpbnV4L2RlbGF5Lmg+CisjaW5jbHVkZSA8
bGludXgvb2ZfZ3JhcGguaD4KKyNpbmNsdWRlIDxsaW51eC9tZmQvc3lzY29uLmg+CisjaW5jbHVk
ZSA8bGludXgvcGxhdGZvcm1fZGV2aWNlLmg+CisjaW5jbHVkZSA8bGludXgvcmVnbWFwLmg+CisK
KyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pY19oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2Jy
aWRnZS5oPgorI2luY2x1ZGUgPGRybS9kcm1fYnJpZGdlX2Nvbm5lY3Rvci5oPgorI2luY2x1ZGUg
PGRybS9kcm1fbWlwaV9kc2kuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3NpbXBsZV9rbXNfaGVscGVy
Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wcmludC5oPgorI2luY2x1ZGUgPGRybS9kcm1fcHJvYmVf
aGVscGVyLmg+CisKKyNpbmNsdWRlICJrbWJfZHNpLmgiCisjaW5jbHVkZSAia21iX3JlZ3MuaCIK
Kworc3RhdGljIHN0cnVjdCBtaXBpX2RzaV9ob3N0ICpkc2lfaG9zdDsKK3N0YXRpYyBzdHJ1Y3Qg
bWlwaV9kc2lfZGV2aWNlICpkc2lfZGV2aWNlOworc3RhdGljIHN0cnVjdCBkcm1fYnJpZGdlICph
ZHZfYnJpZGdlOworCisvKiBEZWZhdWx0IHNldHRpbmcgaXMgMTA4MHAsIDQgbGFuZXMgKi8KKyNk
ZWZpbmUgSU1HX0hFSUdIVF9MSU5FUyAgMTA4MAorI2RlZmluZSBJTUdfV0lEVEhfUFggICAgICAx
OTIwCisjZGVmaW5lIE1JUElfVFhfQUNUSVZFX0xBTkVTIDQKKworc3RhdGljIHN0cnVjdCBtaXBp
X3R4X2ZyYW1lX3NlY3Rpb25fY2ZnIG1pcGlfdHhfZnJhbWUwX3NlY3RfY2ZnID0geworCS53aWR0
aF9waXhlbHMgPSBJTUdfV0lEVEhfUFgsCisJLmhlaWdodF9saW5lcyA9IElNR19IRUlHSFRfTElO
RVMsCisJLmRhdGFfdHlwZSA9IERTSV9MUF9EVF9QUFNfUkdCODg4XzI0QiwKKwkuZGF0YV9tb2Rl
ID0gTUlQSV9EQVRBX01PREUxLAorCS5kbWFfcGFja2VkID0gMAorfTsKKworc3RhdGljIHN0cnVj
dCBtaXBpX3R4X2ZyYW1lX2NmZyBtaXBpdHhfZnJhbWUwX2NmZyA9IHsKKwkuc2VjdGlvbnNbMF0g
PSAmbWlwaV90eF9mcmFtZTBfc2VjdF9jZmcsCisJLnNlY3Rpb25zWzFdID0gTlVMTCwKKwkuc2Vj
dGlvbnNbMl0gPSBOVUxMLAorCS5zZWN0aW9uc1szXSA9IE5VTEwsCisJLnZzeW5jX3dpZHRoID0g
NSwKKwkudl9iYWNrcG9yY2ggPSAzNiwKKwkudl9mcm9udHBvcmNoID0gNCwKKwkuaHN5bmNfd2lk
dGggPSA0NCwKKwkuaF9iYWNrcG9yY2ggPSAxNDgsCisJLmhfZnJvbnRwb3JjaCA9IDg4Cit9Owor
CitzdGF0aWMgY29uc3Qgc3RydWN0IG1pcGlfdHhfZHNpX2NmZyBtaXBpdHhfZHNpX2NmZyA9IHsK
KwkuaGZwX2JsYW5rX2VuID0gMCwKKwkuZW90cF9lbiA9IDAsCisJLmxwbV9sYXN0X3ZmcF9saW5l
ID0gMCwKKwkubHBtX2ZpcnN0X3ZzYV9saW5lID0gMCwKKwkuc3luY19wdWxzZV9ldmVudG4gPSBE
U0lfVklERU9fTU9ERV9OT19CVVJTVF9FVkVOVCwKKwkuaGZwX2JsYW5raW5nID0gU0VORF9CTEFO
S19QQUNLRVQsCisJLmhicF9ibGFua2luZyA9IFNFTkRfQkxBTktfUEFDS0VULAorCS5oc2FfYmxh
bmtpbmcgPSBTRU5EX0JMQU5LX1BBQ0tFVCwKKwkudl9ibGFua2luZyA9IFNFTkRfQkxBTktfUEFD
S0VULAorfTsKKworc3RhdGljIHN0cnVjdCBtaXBpX2N0cmxfY2ZnIG1pcGlfdHhfaW5pdF9jZmcg
PSB7CisJLmFjdGl2ZV9sYW5lcyA9IE1JUElfVFhfQUNUSVZFX0xBTkVTLAorCS5sYW5lX3JhdGVf
bWJwcyA9IE1JUElfVFhfTEFORV9EQVRBX1JBVEVfTUJQUywKKwkucmVmX2Nsa19raHogPSBNSVBJ
X1RYX1JFRl9DTEtfS0haLAorCS5jZmdfY2xrX2toeiA9IE1JUElfVFhfQ0ZHX0NMS19LSFosCisJ
LnR4X2N0cmxfY2ZnID0geworCQkJLmZyYW1lc1swXSA9ICZtaXBpdHhfZnJhbWUwX2NmZywKKwkJ
CS5mcmFtZXNbMV0gPSBOVUxMLAorCQkJLmZyYW1lc1syXSA9IE5VTEwsCisJCQkuZnJhbWVzWzNd
ID0gTlVMTCwKKwkJCS50eF9kc2lfY2ZnID0gJm1pcGl0eF9kc2lfY2ZnLAorCQkJLmxpbmVfc3lu
Y19wa3RfZW4gPSAwLAorCQkJLmxpbmVfY291bnRlcl9hY3RpdmUgPSAwLAorCQkJLmZyYW1lX2Nv
dW50ZXJfYWN0aXZlID0gMCwKKwkJCS50eF9hbHdheXNfdXNlX2hhY3QgPSAxLAorCQkJLnR4X2hh
Y3Rfd2FpdF9zdG9wID0gMSwKKwkJCX0KK307CisKK3N0cnVjdCAgbWlwaV9oc19mcmVxX3Jhbmdl
X2NmZyB7CisJdTE2IGRlZmF1bHRfYml0X3JhdGVfbWJwczsKKwl1OCBoc2ZyZXFyYW5nZV9jb2Rl
OworfTsKKworc3RydWN0IHZjb19wYXJhbXMgeworCXUzMiBmcmVxOworCXUzMiByYW5nZTsKKwl1
MzIgZGl2aWRlcjsKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgdmNvX3BhcmFtcyB2Y29fdGFi
bGVbXSA9IHsKKwl7NTIsIDB4M2YsIDh9LAorCXs4MCwgMHgzOSwgOH0sCisJezEwNSwgMHgyZiwg
NH0sCisJezE2MCwgMHgyOSwgNH0sCisJezIxMCwgMHgxZiwgMn0sCisJezMyMCwgMHgxOSwgMn0s
CisJezQyMCwgMHgwZiwgMX0sCisJezYzMCwgMHgwOSwgMX0sCisJezExMDAsIDB4MDMsIDF9LAor
CXsweGZmZmYsIDB4MDEsIDF9LAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBtaXBpX2hzX2Zy
ZXFfcmFuZ2VfY2ZnCittaXBpX2hzX2ZyZXFfcmFuZ2VbTUlQSV9EUEhZX0RFRkFVTFRfQklUX1JB
VEVTXSA9IHsKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDgwLCAuaHNmcmVxcmFuZ2VfY29k
ZSA9IDB4MDB9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gOTAsIC5oc2ZyZXFyYW5nZV9j
b2RlID0gMHgxMH0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxMDAsIC5oc2ZyZXFyYW5n
ZV9jb2RlID0gMHgyMH0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxMTAsIC5oc2ZyZXFy
YW5nZV9jb2RlID0gMHgzMH0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxMjAsIC5oc2Zy
ZXFyYW5nZV9jb2RlID0gMHgwMX0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxMzAsIC5o
c2ZyZXFyYW5nZV9jb2RlID0gMHgxMX0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxNDAs
IC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgyMX0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAx
NTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgzMX0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMg
PSAxNjAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgwMn0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21i
cHMgPSAxNzAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgxMn0sCisJey5kZWZhdWx0X2JpdF9yYXRl
X21icHMgPSAxODAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgyMn0sCisJey5kZWZhdWx0X2JpdF9y
YXRlX21icHMgPSAxOTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgzMn0sCisJey5kZWZhdWx0X2Jp
dF9yYXRlX21icHMgPSAyMDUsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgwM30sCisJey5kZWZhdWx0
X2JpdF9yYXRlX21icHMgPSAyMjAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgxM30sCisJey5kZWZh
dWx0X2JpdF9yYXRlX21icHMgPSAyMzUsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgyM30sCisJey5k
ZWZhdWx0X2JpdF9yYXRlX21icHMgPSAyNTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgzM30sCisJ
ey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAyNzUsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgwNH0s
CisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAzMDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgx
NH0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAzMjUsIC5oc2ZyZXFyYW5nZV9jb2RlID0g
MHgyNX0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAzNTAsIC5oc2ZyZXFyYW5nZV9jb2Rl
ID0gMHgzNX0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSA0MDAsIC5oc2ZyZXFyYW5nZV9j
b2RlID0gMHgwNX0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSA0NTAsIC5oc2ZyZXFyYW5n
ZV9jb2RlID0gMHgxNn0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSA1MDAsIC5oc2ZyZXFy
YW5nZV9jb2RlID0gMHgyNn0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSA1NTAsIC5oc2Zy
ZXFyYW5nZV9jb2RlID0gMHgzN30sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSA2MDAsIC5o
c2ZyZXFyYW5nZV9jb2RlID0gMHgwN30sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSA2NTAs
IC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgxOH0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSA3
MDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgyOH0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMg
PSA3NTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgzOX0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21i
cHMgPSA4MDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgwOX0sCisJey5kZWZhdWx0X2JpdF9yYXRl
X21icHMgPSA4NTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgxOX0sCisJey5kZWZhdWx0X2JpdF9y
YXRlX21icHMgPSA5MDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgyOX0sCisJey5kZWZhdWx0X2Jp
dF9yYXRlX21icHMgPSAxMDAwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MEF9LAorCXsuZGVmYXVs
dF9iaXRfcmF0ZV9tYnBzID0gMTA1MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDFBfSwKKwl7LmRl
ZmF1bHRfYml0X3JhdGVfbWJwcyA9IDExMDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgyQX0sCisJ
ey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxMTUwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4M0J9
LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTIwMCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAw
eDBCfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDEyNTAsIC5oc2ZyZXFyYW5nZV9jb2Rl
ID0gMHgxQn0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxMzAwLCAuaHNmcmVxcmFuZ2Vf
Y29kZSA9IDB4MkJ9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTM1MCwgLmhzZnJlcXJh
bmdlX2NvZGUgPSAweDNDfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDE0MDAsIC5oc2Zy
ZXFyYW5nZV9jb2RlID0gMHgwQ30sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxNDUwLCAu
aHNmcmVxcmFuZ2VfY29kZSA9IDB4MUN9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTUw
MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDJDfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9
IDE1NTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgzRH0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21i
cHMgPSAxNjAwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4MER9LAorCXsuZGVmYXVsdF9iaXRfcmF0
ZV9tYnBzID0gMTY1MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDFEfSwKKwl7LmRlZmF1bHRfYml0
X3JhdGVfbWJwcyA9IDE3MDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgyRX0sCisJey5kZWZhdWx0
X2JpdF9yYXRlX21icHMgPSAxNzUwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4M0V9LAorCXsuZGVm
YXVsdF9iaXRfcmF0ZV9tYnBzID0gMTgwMCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDBFfSwKKwl7
LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDE4NTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHgxRX0s
CisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAxOTAwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4
MkZ9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMTk1MCwgLmhzZnJlcXJhbmdlX2NvZGUg
PSAweDNGfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDIwMDAsIC5oc2ZyZXFyYW5nZV9j
b2RlID0gMHgwRn0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAyMDUwLCAuaHNmcmVxcmFu
Z2VfY29kZSA9IDB4NDB9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0gMjEwMCwgLmhzZnJl
cXJhbmdlX2NvZGUgPSAweDQxfSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJwcyA9IDIxNTAsIC5o
c2ZyZXFyYW5nZV9jb2RlID0gMHg0Mn0sCisJey5kZWZhdWx0X2JpdF9yYXRlX21icHMgPSAyMjAw
LCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4NDN9LAorCXsuZGVmYXVsdF9iaXRfcmF0ZV9tYnBzID0g
MjI1MCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDQ0fSwKKwl7LmRlZmF1bHRfYml0X3JhdGVfbWJw
cyA9IDIzMDAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHg0NX0sCisJey5kZWZhdWx0X2JpdF9yYXRl
X21icHMgPSAyMzUwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4NDZ9LAorCXsuZGVmYXVsdF9iaXRf
cmF0ZV9tYnBzID0gMjQwMCwgLmhzZnJlcXJhbmdlX2NvZGUgPSAweDQ3fSwKKwl7LmRlZmF1bHRf
Yml0X3JhdGVfbWJwcyA9IDI0NTAsIC5oc2ZyZXFyYW5nZV9jb2RlID0gMHg0OH0sCisJey5kZWZh
dWx0X2JpdF9yYXRlX21icHMgPSAyNTAwLCAuaHNmcmVxcmFuZ2VfY29kZSA9IDB4NDl9Cit9Owor
CitzdGF0aWMgdm9pZCBrbWJfZHNpX2Nsa19kaXNhYmxlKHN0cnVjdCBrbWJfZHNpICprbWJfZHNp
KQoreworCWNsa19kaXNhYmxlX3VucHJlcGFyZShrbWJfZHNpLT5jbGtfbWlwaSk7CisJY2xrX2Rp
c2FibGVfdW5wcmVwYXJlKGttYl9kc2ktPmNsa19taXBpX2VjZmcpOworCWNsa19kaXNhYmxlX3Vu
cHJlcGFyZShrbWJfZHNpLT5jbGtfbWlwaV9jZmcpOworfQorCit2b2lkIGttYl9kc2lfaG9zdF91
bnJlZ2lzdGVyKHN0cnVjdCBrbWJfZHNpICprbWJfZHNpKQoreworCWttYl9kc2lfY2xrX2Rpc2Fi
bGUoa21iX2RzaSk7CisJbWlwaV9kc2lfaG9zdF91bnJlZ2lzdGVyKGttYl9kc2ktPmhvc3QpOwor
fQorCisvKgorICogVGhpcyBEU0kgY2FuIG9ubHkgYmUgcGFpcmVkIHdpdGggYnJpZGdlcyB0aGF0
IGRvIGNvbmZpZyB0aHJvdWdoIGkyYworICogd2hpY2ggaXMgQURWIDc1MzUgaW4gdGhlIEtNQiBF
Vk0KKyAqLworc3RhdGljIHNzaXplX3Qga21iX2RzaV9ob3N0X3RyYW5zZmVyKHN0cnVjdCBtaXBp
X2RzaV9ob3N0ICpob3N0LAorCQkJCSAgICAgY29uc3Qgc3RydWN0IG1pcGlfZHNpX21zZyAqbXNn
KQoreworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGttYl9kc2lfaG9zdF9hdHRhY2goc3Ry
dWN0IG1pcGlfZHNpX2hvc3QgKmhvc3QsCisJCQkgICAgICAgc3RydWN0IG1pcGlfZHNpX2Rldmlj
ZSAqZGV2KQoreworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGttYl9kc2lfaG9zdF9kZXRh
Y2goc3RydWN0IG1pcGlfZHNpX2hvc3QgKmhvc3QsCisJCQkgICAgICAgc3RydWN0IG1pcGlfZHNp
X2RldmljZSAqZGV2KQoreworCXJldHVybiAwOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IG1p
cGlfZHNpX2hvc3Rfb3BzIGttYl9kc2lfaG9zdF9vcHMgPSB7CisJLmF0dGFjaCA9IGttYl9kc2lf
aG9zdF9hdHRhY2gsCisJLmRldGFjaCA9IGttYl9kc2lfaG9zdF9kZXRhY2gsCisJLnRyYW5zZmVy
ID0ga21iX2RzaV9ob3N0X3RyYW5zZmVyLAorfTsKKworaW50IGttYl9kc2lfaG9zdF9icmlkZ2Vf
aW5pdChzdHJ1Y3QgZGV2aWNlICpkZXYpCit7CisJc3RydWN0IGRldmljZV9ub2RlICplbmNvZGVy
X25vZGUsICpkc2lfb3V0OworCisJLyogQ3JlYXRlIGFuZCByZWdpc3RlciBNSVBJIERTSSBob3N0
ICovCisJaWYgKCFkc2lfaG9zdCkgeworCQlkc2lfaG9zdCA9IGt6YWxsb2Moc2l6ZW9mKCpkc2lf
aG9zdCksIEdGUF9LRVJORUwpOworCQlpZiAoIWRzaV9ob3N0KQorCQkJcmV0dXJuIC1FTk9NRU07
CisKKwkJZHNpX2hvc3QtPm9wcyA9ICZrbWJfZHNpX2hvc3Rfb3BzOworCisJCWlmICghZHNpX2Rl
dmljZSkgeworCQkJZHNpX2RldmljZSA9IGt6YWxsb2Moc2l6ZW9mKCpkc2lfZGV2aWNlKSwgR0ZQ
X0tFUk5FTCk7CisJCQlpZiAoIWRzaV9kZXZpY2UpIHsKKwkJCQlrZnJlZShkc2lfaG9zdCk7CisJ
CQkJcmV0dXJuIC1FTk9NRU07CisJCQl9CisJCX0KKworCQlkc2lfaG9zdC0+ZGV2ID0gZGV2Owor
CQltaXBpX2RzaV9ob3N0X3JlZ2lzdGVyKGRzaV9ob3N0KTsKKwl9CisKKwkvKiBGaW5kIEFEVjc1
MzUgbm9kZSBhbmQgaW5pdGlhbGl6ZSBpdCAqLworCWRzaV9vdXQgPSBvZl9ncmFwaF9nZXRfZW5k
cG9pbnRfYnlfcmVncyhkZXYtPm9mX25vZGUsIDAsIDEpOworCWlmICghZHNpX291dCkgeworCQlE
Uk1fRVJST1IoIkZhaWxlZCB0byBnZXQgZHNpX291dCBub2RlIGluZm8gZnJvbSBEVFxuIik7CisJ
CXJldHVybiAtRUlOVkFMOworCX0KKwllbmNvZGVyX25vZGUgPSBvZl9ncmFwaF9nZXRfcmVtb3Rl
X3BvcnRfcGFyZW50KGRzaV9vdXQpOworCWlmICghZW5jb2Rlcl9ub2RlKSB7CisJCW9mX25vZGVf
cHV0KGRzaV9vdXQpOworCQlEUk1fRVJST1IoIkZhaWxlZCB0byBnZXQgYnJpZGdlIGluZm8gZnJv
bSBEVFxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKwkvKiBMb2NhdGUgZHJtIGJyaWRnZSBm
cm9tIHRoZSBoZG1pIGVuY29kZXIgRFQgbm9kZSAqLworCWFkdl9icmlkZ2UgPSBvZl9kcm1fZmlu
ZF9icmlkZ2UoZW5jb2Rlcl9ub2RlKTsKKwlvZl9ub2RlX3B1dChkc2lfb3V0KTsKKwlvZl9ub2Rl
X3B1dChlbmNvZGVyX25vZGUpOworCWlmICghYWR2X2JyaWRnZSkgeworCQlEUk1fREVCVUcoIldh
aXQgZm9yIGV4dGVybmFsIGJyaWRnZSBkcml2ZXIgRFRcbiIpOworCQlyZXR1cm4gLUVQUk9CRV9E
RUZFUjsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHUzMiBtaXBpX2dldF9kYXRhdHlw
ZV9wYXJhbXModTMyIGRhdGFfdHlwZSwgdTMyIGRhdGFfbW9kZSwKKwkJCQkgICAgc3RydWN0IG1p
cGlfZGF0YV90eXBlX3BhcmFtcyAqcGFyYW1zKQoreworCXN0cnVjdCBtaXBpX2RhdGFfdHlwZV9w
YXJhbXMgZGF0YV90eXBlX3BhcmFtOworCisJc3dpdGNoIChkYXRhX3R5cGUpIHsKKwljYXNlIERT
SV9MUF9EVF9QUFNfWUNCQ1I0MjBfMTJCOgorCQlkYXRhX3R5cGVfcGFyYW0uc2l6ZV9jb25zdHJh
aW50X3BpeGVscyA9IDI7CisJCWRhdGFfdHlwZV9wYXJhbS5zaXplX2NvbnN0cmFpbnRfYnl0ZXMg
PSAzOworCQlzd2l0Y2ggKGRhdGFfbW9kZSkgeworCQkJLyogQ2FzZSAwIG5vdCBzdXBwb3J0ZWQg
YWNjb3JkaW5nIHRvIE1ESyAqLworCQljYXNlIDE6CisJCWNhc2UgMjoKKwkJY2FzZSAzOgorCQkJ
ZGF0YV90eXBlX3BhcmFtLnBpeGVsc19wZXJfcGNsayA9IDI7CisJCQlkYXRhX3R5cGVfcGFyYW0u
Yml0c19wZXJfcGNsayA9IDI0OworCQkJYnJlYWs7CisJCWRlZmF1bHQ6CisJCQlEUk1fRVJST1Io
IkRTSTogSW52YWxpZCBkYXRhX21vZGUgJWRcbiIsIGRhdGFfbW9kZSk7CisJCQlyZXR1cm4gLUVJ
TlZBTDsKKwkJfTsKKwkJYnJlYWs7CisJY2FzZSBEU0lfTFBfRFRfUFBTX1lDQkNSNDIyXzE2QjoK
KwkJZGF0YV90eXBlX3BhcmFtLnNpemVfY29uc3RyYWludF9waXhlbHMgPSAyOworCQlkYXRhX3R5
cGVfcGFyYW0uc2l6ZV9jb25zdHJhaW50X2J5dGVzID0gNDsKKwkJc3dpdGNoIChkYXRhX21vZGUp
IHsKKwkJCS8qIENhc2UgMCBhbmQgMSBub3Qgc3VwcG9ydGVkIGFjY29yZGluZworCQkJICogdG8g
TURLCisJCQkgKi8KKwkJY2FzZSAyOgorCQkJZGF0YV90eXBlX3BhcmFtLnBpeGVsc19wZXJfcGNs
ayA9IDE7CisJCQlkYXRhX3R5cGVfcGFyYW0uYml0c19wZXJfcGNsayA9IDE2OworCQkJYnJlYWs7
CisJCWNhc2UgMzoKKwkJCWRhdGFfdHlwZV9wYXJhbS5waXhlbHNfcGVyX3BjbGsgPSAyOworCQkJ
ZGF0YV90eXBlX3BhcmFtLmJpdHNfcGVyX3BjbGsgPSAzMjsKKwkJCWJyZWFrOworCQlkZWZhdWx0
OgorCQkJRFJNX0VSUk9SKCJEU0k6IEludmFsaWQgZGF0YV9tb2RlICVkXG4iLCBkYXRhX21vZGUp
OworCQkJcmV0dXJuIC1FSU5WQUw7CisJCX07CisJCWJyZWFrOworCWNhc2UgRFNJX0xQX0RUX0xQ
UFNfWUNCQ1I0MjJfMjBCOgorCWNhc2UgRFNJX0xQX0RUX1BQU19ZQ0JDUjQyMl8yNEI6CisJCWRh
dGFfdHlwZV9wYXJhbS5zaXplX2NvbnN0cmFpbnRfcGl4ZWxzID0gMjsKKwkJZGF0YV90eXBlX3Bh
cmFtLnNpemVfY29uc3RyYWludF9ieXRlcyA9IDY7CisJCXN3aXRjaCAoZGF0YV9tb2RlKSB7CisJ
CQkvKiBDYXNlIDAgbm90IHN1cHBvcnRlZCBhY2NvcmRpbmcgdG8gTURLICovCisJCWNhc2UgMToK
KwkJY2FzZSAyOgorCQljYXNlIDM6CisJCQlkYXRhX3R5cGVfcGFyYW0ucGl4ZWxzX3Blcl9wY2xr
ID0gMTsKKwkJCWRhdGFfdHlwZV9wYXJhbS5iaXRzX3Blcl9wY2xrID0gMjQ7CisJCQlicmVhazsK
KwkJZGVmYXVsdDoKKwkJCURSTV9FUlJPUigiRFNJOiBJbnZhbGlkIGRhdGFfbW9kZSAlZFxuIiwg
ZGF0YV9tb2RlKTsKKwkJCXJldHVybiAtRUlOVkFMOworCQl9OworCQlicmVhazsKKwljYXNlIERT
SV9MUF9EVF9QUFNfUkdCNTY1XzE2QjoKKwkJZGF0YV90eXBlX3BhcmFtLnNpemVfY29uc3RyYWlu
dF9waXhlbHMgPSAxOworCQlkYXRhX3R5cGVfcGFyYW0uc2l6ZV9jb25zdHJhaW50X2J5dGVzID0g
MjsKKwkJc3dpdGNoIChkYXRhX21vZGUpIHsKKwkJY2FzZSAwOgorCQljYXNlIDE6CisJCQlkYXRh
X3R5cGVfcGFyYW0ucGl4ZWxzX3Blcl9wY2xrID0gMTsKKwkJCWRhdGFfdHlwZV9wYXJhbS5iaXRz
X3Blcl9wY2xrID0gMTY7CisJCQlicmVhazsKKwkJY2FzZSAyOgorCQljYXNlIDM6CisJCQlkYXRh
X3R5cGVfcGFyYW0ucGl4ZWxzX3Blcl9wY2xrID0gMjsKKwkJCWRhdGFfdHlwZV9wYXJhbS5iaXRz
X3Blcl9wY2xrID0gMzI7CisJCQlicmVhazsKKwkJZGVmYXVsdDoKKwkJCURSTV9FUlJPUigiRFNJ
OiBJbnZhbGlkIGRhdGFfbW9kZSAlZFxuIiwgZGF0YV9tb2RlKTsKKwkJCXJldHVybiAtRUlOVkFM
OworCQl9OworCQlicmVhazsKKwljYXNlIERTSV9MUF9EVF9QUFNfUkdCNjY2XzE4QjoKKwkJZGF0
YV90eXBlX3BhcmFtLnNpemVfY29uc3RyYWludF9waXhlbHMgPSA0OworCQlkYXRhX3R5cGVfcGFy
YW0uc2l6ZV9jb25zdHJhaW50X2J5dGVzID0gOTsKKwkJZGF0YV90eXBlX3BhcmFtLmJpdHNfcGVy
X3BjbGsgPSAxODsKKwkJZGF0YV90eXBlX3BhcmFtLnBpeGVsc19wZXJfcGNsayA9IDE7CisJCWJy
ZWFrOworCWNhc2UgRFNJX0xQX0RUX0xQUFNfUkdCNjY2XzE4QjoKKwljYXNlIERTSV9MUF9EVF9Q
UFNfUkdCODg4XzI0QjoKKwkJZGF0YV90eXBlX3BhcmFtLnNpemVfY29uc3RyYWludF9waXhlbHMg
PSAxOworCQlkYXRhX3R5cGVfcGFyYW0uc2l6ZV9jb25zdHJhaW50X2J5dGVzID0gMzsKKwkJZGF0
YV90eXBlX3BhcmFtLmJpdHNfcGVyX3BjbGsgPSAyNDsKKwkJZGF0YV90eXBlX3BhcmFtLnBpeGVs
c19wZXJfcGNsayA9IDE7CisJCWJyZWFrOworCWNhc2UgRFNJX0xQX0RUX1BQU19SR0IxMDEwMTBf
MzBCOgorCQlkYXRhX3R5cGVfcGFyYW0uc2l6ZV9jb25zdHJhaW50X3BpeGVscyA9IDQ7CisJCWRh
dGFfdHlwZV9wYXJhbS5zaXplX2NvbnN0cmFpbnRfYnl0ZXMgPSAxNTsKKwkJZGF0YV90eXBlX3Bh
cmFtLmJpdHNfcGVyX3BjbGsgPSAzMDsKKwkJZGF0YV90eXBlX3BhcmFtLnBpeGVsc19wZXJfcGNs
ayA9IDE7CisJCWJyZWFrOworCWRlZmF1bHQ6CisJCURSTV9FUlJPUigiRFNJOiBJbnZhbGlkIGRh
dGFfdHlwZSAlZFxuIiwgZGF0YV90eXBlKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfTsKKworCSpw
YXJhbXMgPSBkYXRhX3R5cGVfcGFyYW07CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB1MzIgY29t
cHV0ZV93Yyh1MzIgd2lkdGhfcHgsIHU4IHNpemVfY29uc3RyX3AsIHU4IHNpemVfY29uc3RyX2Ip
Cit7CisJLyogQ2FsY3VsYXRlIHRoZSB3b3JkIGNvdW50IGZvciBlYWNoIGxvbmcgcGFja2V0ICov
CisJcmV0dXJuICgoKHdpZHRoX3B4IC8gc2l6ZV9jb25zdHJfcCkgKiBzaXplX2NvbnN0cl9iKSAm
IDB4ZmZmZik7Cit9CisKK3N0YXRpYyB1MzIgY29tcHV0ZV91bnBhY2tlZF9ieXRlcyh1MzIgd2Ms
IHU4IGJpdHNfcGVyX3BjbGspCit7CisJLyogTnVtYmVyIG9mIFBDTEsgY3ljbGVzIG5lZWRlZCB0
byB0cmFuc2ZlciBhIGxpbmUKKwkgKiB3aXRoIGVhY2ggUENMSyBjeWNsZSwgNCBCeXRlcyBhcmUg
c2VudCB0aHJvdWdoIHRoZSBQUEwgbW9kdWxlCisJICovCisJcmV0dXJuICgod2MgKiA4KSAvIGJp
dHNfcGVyX3BjbGspICogNDsKK30KKworc3RhdGljIHUzMiBtaXBpX3R4X2ZnX3NlY3Rpb25fY2Zn
X3JlZ3Moc3RydWN0IGttYl9kc2kgKmttYl9kc2ksCisJCQkJICAgICAgIHU4IGZyYW1lX2lkLCB1
OCBzZWN0aW9uLAorCQkJCSAgICAgICB1MzIgaGVpZ2h0X2xpbmVzLCB1MzIgdW5wYWNrZWRfYnl0
ZXMsCisJCQkJICAgICAgIHN0cnVjdCBtaXBpX3R4X2ZyYW1lX3NlY3RfcGhjZmcgKnBoX2NmZykK
K3sKKwl1MzIgY2ZnID0gMDsKKwl1MzIgY3RybF9ubyA9IE1JUElfQ1RSTDY7CisJdTMyIHJlZ19h
ZHI7CisKKwkvKiBGcmFtZSBzZWN0aW9uIHBhY2tldCBoZWFkZXIgKi8KKwkvKiBXb3JkIGNvdW50
IGJpdHMgWzE1OjBdICovCisJY2ZnID0gKHBoX2NmZy0+d2MgJiBNSVBJX1RYX1NFQ1RfV0NfTUFT
SykgPDwgMDsKKworCS8qIERhdGEgdHlwZSAoYml0cyBbMjE6MTZdKSAqLworCWNmZyB8PSAoKHBo
X2NmZy0+ZGF0YV90eXBlICYgTUlQSV9UWF9TRUNUX0RUX01BU0spCisJCTw8IE1JUElfVFhfU0VD
VF9EVF9TSElGVCk7CisKKwkvKiBWaXJ0dWFsIGNoYW5uZWwgKGJpdHMgWzIzOjIyXSkgKi8KKwlj
ZmcgfD0gKChwaF9jZmctPnZjaGFubmVsICYgTUlQSV9UWF9TRUNUX1ZDX01BU0spCisJCTw8IE1J
UElfVFhfU0VDVF9WQ19TSElGVCk7CisKKwkvKiBEYXRhIG1vZGUgKGJpdHMgWzI0OjI1XSkgKi8K
KwljZmcgfD0gKChwaF9jZmctPmRhdGFfbW9kZSAmIE1JUElfVFhfU0VDVF9ETV9NQVNLKQorCQk8
PCBNSVBJX1RYX1NFQ1RfRE1fU0hJRlQpOworCWlmIChwaF9jZmctPmRtYV9wYWNrZWQpCisJCWNm
ZyB8PSBNSVBJX1RYX1NFQ1RfRE1BX1BBQ0tFRDsKKworCWRldl9kYmcoa21iX2RzaS0+ZGV2LAor
CQkiY3RybD0lZCBmcmFtZV9pZD0lZCBzZWN0aW9uPSVkIGNmZz0leCBwYWNrZWQ9JWRcbiIsCisJ
CSAgY3RybF9ubywgZnJhbWVfaWQsIHNlY3Rpb24sIGNmZywgcGhfY2ZnLT5kbWFfcGFja2VkKTsK
KwlrbWJfd3JpdGVfbWlwaShrbWJfZHNpLAorCQkgICAgICAgKE1JUElfVFhtX0hTX0ZHbl9TRUNU
b19QSChjdHJsX25vLCBmcmFtZV9pZCwgc2VjdGlvbikpLAorCQkgICAgICAgY2ZnKTsKKworCS8q
IFVucGFja2VkIGJ5dGVzICovCisKKwkvKiBUaGVyZSBhcmUgNCBmcmFtZSBnZW5lcmF0b3JzIGFu
ZCBlYWNoIGZnIGhhcyA0IHNlY3Rpb25zCisJICogVGhlcmUgYXJlIDIgcmVnaXN0ZXJzIGZvciB1
bnBhY2tlZCBieXRlcyAoIyBieXRlcyBlYWNoCisJICogc2VjdGlvbiBvY2N1cGllcyBpbiBtZW1v
cnkpCisJICogUkVHX1VOUEFDS0VEX0JZVEVTMDogWzE1OjBdLUJZVEVTMCwgWzMxOjE2XS1CWVRF
UzEKKwkgKiBSRUdfVU5QQUNLRURfQllURVMxOiBbMTU6MF0tQllURVMyLCBbMzE6MTZdLUJZVEVT
MworCSAqLworCXJlZ19hZHIgPQorCSAgICBNSVBJX1RYbV9IU19GR25fU0VDVF9VTlBBQ0tFRF9C
WVRFUzAoY3RybF9ubywKKwkJCQkJCSBmcmFtZV9pZCkgKyAoc2VjdGlvbiAvIDIpICogNDsKKwlr
bWJfd3JpdGVfYml0c19taXBpKGttYl9kc2ksIHJlZ19hZHIsIChzZWN0aW9uICUgMikgKiAxNiwg
MTYsCisJCQkgICAgdW5wYWNrZWRfYnl0ZXMpOworCWRldl9kYmcoa21iX2RzaS0+ZGV2LAorCQki
dW5wYWNrZWRfYnl0ZXMgPSAlZCwgd29yZGNvdW50ID0gJWRcbiIsIHVucGFja2VkX2J5dGVzLAor
CQkgIHBoX2NmZy0+d2MpOworCisJLyogTGluZSBjb25maWcgKi8KKwlyZWdfYWRyID0gTUlQSV9U
WG1fSFNfRkduX1NFQ1RvX0xJTkVfQ0ZHKGN0cmxfbm8sIGZyYW1lX2lkLCBzZWN0aW9uKTsKKwlr
bWJfd3JpdGVfbWlwaShrbWJfZHNpLCByZWdfYWRyLCBoZWlnaHRfbGluZXMpOworCXJldHVybiAw
OworfQorCitzdGF0aWMgdTMyIG1pcGlfdHhfZmdfc2VjdGlvbl9jZmcoc3RydWN0IGttYl9kc2kg
KmttYl9kc2ksCisJCQkJICB1OCBmcmFtZV9pZCwgdTggc2VjdGlvbiwKKwkJCQkgIHN0cnVjdCBt
aXBpX3R4X2ZyYW1lX3NlY3Rpb25fY2ZnICpmcmFtZV9zY2ZnLAorCQkJCSAgdTMyICpiaXRzX3Bl
cl9wY2xrLCB1MzIgKndjKQoreworCXUzMiByZXQgPSAwOworCXUzMiB1bnBhY2tlZF9ieXRlczsK
KwlzdHJ1Y3QgbWlwaV9kYXRhX3R5cGVfcGFyYW1zIGRhdGFfdHlwZV9wYXJhbWV0ZXJzOworCXN0
cnVjdCBtaXBpX3R4X2ZyYW1lX3NlY3RfcGhjZmcgcGhfY2ZnOworCisJcmV0ID0gbWlwaV9nZXRf
ZGF0YXR5cGVfcGFyYW1zKGZyYW1lX3NjZmctPmRhdGFfdHlwZSwKKwkJCQkgICAgICAgZnJhbWVf
c2NmZy0+ZGF0YV9tb2RlLAorCQkJCSAgICAgICAmZGF0YV90eXBlX3BhcmFtZXRlcnMpOworCWlm
IChyZXQpCisJCXJldHVybiByZXQ7CisKKwkvKiBQYWNrZXQgd2lkdGggaGFzIHRvIGJlIGEgbXVs
dGlwbGUgb2YgdGhlIG1pbmltdW0gcGFja2V0IHdpZHRoCisJICogKGluIHBpeGVscykgc2V0IGZv
ciBlYWNoIGRhdGEgdHlwZQorCSAqLworCWlmIChmcmFtZV9zY2ZnLT53aWR0aF9waXhlbHMgJQor
CSAgICBkYXRhX3R5cGVfcGFyYW1ldGVycy5zaXplX2NvbnN0cmFpbnRfcGl4ZWxzICE9IDApCisJ
CXJldHVybiAtRUlOVkFMOworCisJKndjID0gY29tcHV0ZV93YyhmcmFtZV9zY2ZnLT53aWR0aF9w
aXhlbHMsCisJCQkgZGF0YV90eXBlX3BhcmFtZXRlcnMuc2l6ZV9jb25zdHJhaW50X3BpeGVscywK
KwkJCSBkYXRhX3R5cGVfcGFyYW1ldGVycy5zaXplX2NvbnN0cmFpbnRfYnl0ZXMpOworCXVucGFj
a2VkX2J5dGVzID0gY29tcHV0ZV91bnBhY2tlZF9ieXRlcygqd2MsCisJCQkJCQlkYXRhX3R5cGVf
cGFyYW1ldGVycy5iaXRzX3Blcl9wY2xrKTsKKwlwaF9jZmcud2MgPSAqd2M7CisJcGhfY2ZnLmRh
dGFfbW9kZSA9IGZyYW1lX3NjZmctPmRhdGFfbW9kZTsKKwlwaF9jZmcuZGF0YV90eXBlID0gZnJh
bWVfc2NmZy0+ZGF0YV90eXBlOworCXBoX2NmZy5kbWFfcGFja2VkID0gZnJhbWVfc2NmZy0+ZG1h
X3BhY2tlZDsKKwlwaF9jZmcudmNoYW5uZWwgPSBmcmFtZV9pZDsKKworCW1pcGlfdHhfZmdfc2Vj
dGlvbl9jZmdfcmVncyhrbWJfZHNpLCBmcmFtZV9pZCwgc2VjdGlvbiwKKwkJCQkgICAgZnJhbWVf
c2NmZy0+aGVpZ2h0X2xpbmVzLAorCQkJCSAgICB1bnBhY2tlZF9ieXRlcywgJnBoX2NmZyk7CisK
KwkvKiBDYWxsZXIgbmVlZHMgYml0c19wZXJfY2xrIGZvciBhZGRpdGlvbmFsIGNhbHVjbGF0aW9u
cyAqLworCSpiaXRzX3Blcl9wY2xrID0gZGF0YV90eXBlX3BhcmFtZXRlcnMuYml0c19wZXJfcGNs
azsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBtaXBpX3R4X2ZnX2NmZ19yZWdzKHN0
cnVjdCBrbWJfZHNpICprbWJfZHNpLCB1OCBmcmFtZV9nZW4sCisJCQkJc3RydWN0IG1pcGlfdHhf
ZnJhbWVfdGltaW5nX2NmZyAqZmdfY2ZnKQoreworCXUzMiBzeXNjbGs7CisJdTMyIHBwbF9sbHBf
cmF0aW87CisJdTMyIGN0cmxfbm8gPSBNSVBJX0NUUkw2LCByZWdfYWRyLCB2YWwsIG9mZnNldDsK
KworCS8qIDUwMCBNaHogc3lzdGVtIGNsb2NrIG1pbnVzIDUwIHRvIGFjY291bnQgZm9yIHRoZSBk
aWZmZXJlbmNlIGluCisJICogTUlQSSBjbG9jayBzcGVlZCBpbiBSVEwgdGVzdHMKKwkgKi8KKwlz
eXNjbGsgPSBrbWJfZHNpLT5zeXNfY2xrX21oeiAtIDUwOworCisJLyogUFBMLVBpeGVsIFBhY2tp
bmcgTGF5ZXIsIExMUC1Mb3cgTGV2ZWwgUHJvdG9jb2wKKwkgKiBGcmFtZSBnZW5hcnRvciB0aW1p
bmcgcGFyYW1ldGVycyBhcmUgY2xvY2tlZCBvbiB0aGUgc3lzdGVtIGNsb2NrLAorCSAqIHdoZXJl
YXMgYXMgdGhlIGVxdWl2YWxlbnQgcGFyYW1ldGVycyBpbiB0aGUgTExQIGJsb2NrcyBhcmUgY2xv
Y2tlZAorCSAqIG9uIExMUCBUeCBjbG9jayBmcm9tIHRoZSBELVBIWSAtIEJZVEUgY2xvY2sKKwkg
Ki8KKworCS8qIE11bHRpcGx5IGJ5IDEwMDAgdG8gbWFpbnRhaW4gcHJlY2lzaW9uICovCisJcHBs
X2xscF9yYXRpbyA9ICgoZmdfY2ZnLT5icHAgLyA4KSAqIHN5c2NsayAqIDEwMDApIC8KKwkgICAg
KChmZ19jZmctPmxhbmVfcmF0ZV9tYnBzIC8gOCkgKiBmZ19jZmctPmFjdGl2ZV9sYW5lcyk7CisK
KwlkZXZfZGJnKGttYl9kc2ktPmRldiwgInBwbF9sbHBfcmF0aW89JWRcbiIsIHBwbF9sbHBfcmF0
aW8pOworCWRldl9kYmcoa21iX2RzaS0+ZGV2LCAiYnBwPSVkIHN5c2Nsaz0lZCBsYW5lLXJhdGU9
JWQgYWN0aXZlLWxhbmVzPSVkXG4iLAorCQlmZ19jZmctPmJwcCwgc3lzY2xrLCBmZ19jZmctPmxh
bmVfcmF0ZV9tYnBzLAorCQkgZmdfY2ZnLT5hY3RpdmVfbGFuZXMpOworCisJLyogRnJhbWUgZ2Vu
ZXJhdG9yIG51bWJlciBvZiBsaW5lcyAqLworCXJlZ19hZHIgPSBNSVBJX1RYbV9IU19GR25fTlVN
X0xJTkVTKGN0cmxfbm8sIGZyYW1lX2dlbik7CisJa21iX3dyaXRlX21pcGkoa21iX2RzaSwgcmVn
X2FkciwgZmdfY2ZnLT52X2FjdGl2ZSk7CisKKwkvKiB2c3luYyB3aWR0aAorCSAqIFRoZXJlIGFy
ZSAyIHJlZ2lzdGVycyBmb3IgdnN5bmMgd2lkdGggKFZTQSBpbiBsaW5lcyBmb3IKKwkgKiBjaGFu
bmVscyAwLTMpCisJICogUkVHX1ZTWU5DX1dJRFRIMDogWzE1OjBdLVZTQSBmb3IgY2hhbm5lbDAs
IFszMToxNl0tVlNBIGZvciBjaGFubmVsMQorCSAqIFJFR19WU1lOQ19XSURUSDE6IFsxNTowXS1W
U0EgZm9yIGNoYW5uZWwyLCBbMzE6MTZdLVZTQSBmb3IgY2hhbm5lbDMKKwkgKi8KKwlvZmZzZXQg
PSAoZnJhbWVfZ2VuICUgMikgKiAxNjsKKwlyZWdfYWRyID0gTUlQSV9UWG1fSFNfVlNZTkNfV0lE
VEhuKGN0cmxfbm8sIGZyYW1lX2dlbiAvIDIpOworCWttYl93cml0ZV9iaXRzX21pcGkoa21iX2Rz
aSwgcmVnX2Fkciwgb2Zmc2V0LCAxNiwgZmdfY2ZnLT52c3luY193aWR0aCk7CisKKwkvKiB2ZXJ0
aWNhbCBiYWNrcG9yY2ggKHZicCkgKi8KKwlyZWdfYWRyID0gTUlQSV9UWG1fSFNfVl9CQUNLUE9S
Q0hFU24oY3RybF9ubywgZnJhbWVfZ2VuIC8gMik7CisJa21iX3dyaXRlX2JpdHNfbWlwaShrbWJf
ZHNpLCByZWdfYWRyLCBvZmZzZXQsIDE2LCBmZ19jZmctPnZfYmFja3BvcmNoKTsKKworCS8qIHZl
cnRpY2FsIGZyb250cG9yY2ggKHZmcCkgKi8KKwlyZWdfYWRyID0gTUlQSV9UWG1fSFNfVl9GUk9O
VFBPUkNIRVNuKGN0cmxfbm8sIGZyYW1lX2dlbiAvIDIpOworCWttYl93cml0ZV9iaXRzX21pcGko
a21iX2RzaSwgcmVnX2Fkciwgb2Zmc2V0LCAxNiwgZmdfY2ZnLT52X2Zyb250cG9yY2gpOworCisJ
LyogdmVydGljYWwgYWN0aXZlICh2YWN0aXZlKSAqLworCXJlZ19hZHIgPSBNSVBJX1RYbV9IU19W
X0FDVElWRW4oY3RybF9ubywgZnJhbWVfZ2VuIC8gMik7CisJa21iX3dyaXRlX2JpdHNfbWlwaShr
bWJfZHNpLCByZWdfYWRyLCBvZmZzZXQsIDE2LCBmZ19jZmctPnZfYWN0aXZlKTsKKworCS8qIGhz
eW5jIHdpZHRoICovCisJcmVnX2FkciA9IE1JUElfVFhtX0hTX0hTWU5DX1dJRFRIbihjdHJsX25v
LCBmcmFtZV9nZW4pOworCWttYl93cml0ZV9taXBpKGttYl9kc2ksIHJlZ19hZHIsCisJCSAgICAg
ICAoZmdfY2ZnLT5oc3luY193aWR0aCAqIHBwbF9sbHBfcmF0aW8pIC8gMTAwMCk7CisKKwkvKiBo
b3Jpem9udGFsIGJhY2twb3JjaCAoaGJwKSAqLworCXJlZ19hZHIgPSBNSVBJX1RYbV9IU19IX0JB
Q0tQT1JDSG4oY3RybF9ubywgZnJhbWVfZ2VuKTsKKwlrbWJfd3JpdGVfbWlwaShrbWJfZHNpLCBy
ZWdfYWRyLAorCQkgICAgICAgKGZnX2NmZy0+aF9iYWNrcG9yY2ggKiBwcGxfbGxwX3JhdGlvKSAv
IDEwMDApOworCisJLyogaG9yaXpvbnRhbCBmcm9udHBvcmNoIChoZnApICovCisJcmVnX2FkciA9
IE1JUElfVFhtX0hTX0hfRlJPTlRQT1JDSG4oY3RybF9ubywgZnJhbWVfZ2VuKTsKKwlrbWJfd3Jp
dGVfbWlwaShrbWJfZHNpLCByZWdfYWRyLAorCQkgICAgICAgKGZnX2NmZy0+aF9mcm9udHBvcmNo
ICogcHBsX2xscF9yYXRpbykgLyAxMDAwKTsKKworCS8qIGhvcml6b250YWwgYWN0aXZlIChoYSkg
Ki8KKwlyZWdfYWRyID0gTUlQSV9UWG1fSFNfSF9BQ1RJVkVuKGN0cmxfbm8sIGZyYW1lX2dlbik7
CisKKwkvKiBjb252ZXJ0IGhfYWN0aXZlIHdoaWNoIGlzIHdjIGluIGJ5dGVzIHRvIGN5Y2xlcyAq
LworCXZhbCA9IChmZ19jZmctPmhfYWN0aXZlICogc3lzY2xrICogMTAwMCkgLworCSAgICAoKGZn
X2NmZy0+bGFuZV9yYXRlX21icHMgLyA4KSAqIGZnX2NmZy0+YWN0aXZlX2xhbmVzKTsKKwl2YWwg
Lz0gMTAwMDsKKwlrbWJfd3JpdGVfbWlwaShrbWJfZHNpLCByZWdfYWRyLCB2YWwpOworCisJLyog
bGxwIGhzeW5jIHdpZHRoICovCisJcmVnX2FkciA9IE1JUElfVFhtX0hTX0xMUF9IU1lOQ19XSURU
SG4oY3RybF9ubywgZnJhbWVfZ2VuKTsKKwlrbWJfd3JpdGVfbWlwaShrbWJfZHNpLCByZWdfYWRy
LCBmZ19jZmctPmhzeW5jX3dpZHRoICogKGZnX2NmZy0+YnBwIC8gOCkpOworCisJLyogbGxwIGgg
YmFja3BvcmNoICovCisJcmVnX2FkciA9IE1JUElfVFhtX0hTX0xMUF9IX0JBQ0tQT1JDSG4oY3Ry
bF9ubywgZnJhbWVfZ2VuKTsKKwlrbWJfd3JpdGVfbWlwaShrbWJfZHNpLCByZWdfYWRyLCBmZ19j
ZmctPmhfYmFja3BvcmNoICogKGZnX2NmZy0+YnBwIC8gOCkpOworCisJLyogbGxwIGggZnJvbnRw
b3JjaCAqLworCXJlZ19hZHIgPSBNSVBJX1RYbV9IU19MTFBfSF9GUk9OVFBPUkNIbihjdHJsX25v
LCBmcmFtZV9nZW4pOworCWttYl93cml0ZV9taXBpKGttYl9kc2ksIHJlZ19hZHIsCisJCSAgICAg
ICBmZ19jZmctPmhfZnJvbnRwb3JjaCAqIChmZ19jZmctPmJwcCAvIDgpKTsKK30KKworc3RhdGlj
IHZvaWQgbWlwaV90eF9mZ19jZmcoc3RydWN0IGttYl9kc2kgKmttYl9kc2ksIHU4IGZyYW1lX2dl
biwKKwkJCSAgIHU4IGFjdGl2ZV9sYW5lcywgdTMyIGJwcCwgdTMyIHdjLAorCQkJICAgdTMyIGxh
bmVfcmF0ZV9tYnBzLCBzdHJ1Y3QgbWlwaV90eF9mcmFtZV9jZmcgKmZnX2NmZykKK3sKKwl1MzIg
aSwgZmdfbnVtX2xpbmVzID0gMDsKKwlzdHJ1Y3QgbWlwaV90eF9mcmFtZV90aW1pbmdfY2ZnIGZn
X3RfY2ZnOworCisJLyogQ2FsY3VsYXRlIHRoZSB0b3RhbCBmcmFtZSBnZW5lcmF0b3IgbnVtYmVy
IG9mCisJICogbGluZXMgYmFzZWQgb24gaXQncyBhY3RpdmUgc2VjdGlvbnMKKwkgKi8KKwlmb3Ig
KGkgPSAwOyBpIDwgTUlQSV9UWF9GUkFNRV9HRU5fU0VDVElPTlM7IGkrKykgeworCQlpZiAoZmdf
Y2ZnLT5zZWN0aW9uc1tpXSkKKwkJCWZnX251bV9saW5lcyArPSBmZ19jZmctPnNlY3Rpb25zW2ld
LT5oZWlnaHRfbGluZXM7CisJfQorCisJZmdfdF9jZmcuYnBwID0gYnBwOworCWZnX3RfY2ZnLmxh
bmVfcmF0ZV9tYnBzID0gbGFuZV9yYXRlX21icHM7CisJZmdfdF9jZmcuaHN5bmNfd2lkdGggPSBm
Z19jZmctPmhzeW5jX3dpZHRoOworCWZnX3RfY2ZnLmhfYmFja3BvcmNoID0gZmdfY2ZnLT5oX2Jh
Y2twb3JjaDsKKwlmZ190X2NmZy5oX2Zyb250cG9yY2ggPSBmZ19jZmctPmhfZnJvbnRwb3JjaDsK
KwlmZ190X2NmZy5oX2FjdGl2ZSA9IHdjOworCWZnX3RfY2ZnLnZzeW5jX3dpZHRoID0gZmdfY2Zn
LT52c3luY193aWR0aDsKKwlmZ190X2NmZy52X2JhY2twb3JjaCA9IGZnX2NmZy0+dl9iYWNrcG9y
Y2g7CisJZmdfdF9jZmcudl9mcm9udHBvcmNoID0gZmdfY2ZnLT52X2Zyb250cG9yY2g7CisJZmdf
dF9jZmcudl9hY3RpdmUgPSBmZ19udW1fbGluZXM7CisJZmdfdF9jZmcuYWN0aXZlX2xhbmVzID0g
YWN0aXZlX2xhbmVzOworCisJLyogQXBwbHkgZnJhbWUgZ2VuZXJhdG9yIHRpbWluZyBzZXR0aW5n
ICovCisJbWlwaV90eF9mZ19jZmdfcmVncyhrbWJfZHNpLCBmcmFtZV9nZW4sICZmZ190X2NmZyk7
Cit9CisKK3N0YXRpYyB2b2lkIG1pcGlfdHhfbXVsdGljaGFubmVsX2ZpZm9fY2ZnKHN0cnVjdCBr
bWJfZHNpICprbWJfZHNpLAorCQkJCQkgIHU4IGFjdGl2ZV9sYW5lcywgdTggdmNoYW5uZWxfaWQp
Cit7CisJdTMyIGZpZm9fc2l6ZSwgZmlmb19ydGhyZXNob2xkOworCXUzMiBjdHJsX25vID0gTUlQ
SV9DVFJMNjsKKworCS8qIENsZWFyIGFsbCBtYyBmaWZvIGNoYW5uZWwgc2l6ZXMgYW5kIHRocmVz
aG9sZHMgKi8KKwlrbWJfd3JpdGVfbWlwaShrbWJfZHNpLCBNSVBJX1RYX0hTX01DX0ZJRk9fQ1RS
TF9FTiwgMCk7CisJa21iX3dyaXRlX21pcGkoa21iX2RzaSwgTUlQSV9UWF9IU19NQ19GSUZPX0NI
QU5fQUxMT0MwLCAwKTsKKwlrbWJfd3JpdGVfbWlwaShrbWJfZHNpLCBNSVBJX1RYX0hTX01DX0ZJ
Rk9fQ0hBTl9BTExPQzEsIDApOworCWttYl93cml0ZV9taXBpKGttYl9kc2ksIE1JUElfVFhfSFNf
TUNfRklGT19SVEhSRVNIT0xEMCwgMCk7CisJa21iX3dyaXRlX21pcGkoa21iX2RzaSwgTUlQSV9U
WF9IU19NQ19GSUZPX1JUSFJFU0hPTEQxLCAwKTsKKworCWZpZm9fc2l6ZSA9ICgoYWN0aXZlX2xh
bmVzID4gTUlQSV9EX0xBTkVTX1BFUl9EUEhZKSA/CisJCSAgICAgTUlQSV9DVFJMXzRMQU5FX01B
WF9NQ19GSUZPX0xPQyA6CisJCSAgICAgTUlQSV9DVFJMXzJMQU5FX01BWF9NQ19GSUZPX0xPQykg
LSAxOworCisJLyogTUMgZmlmbyBzaXplIGZvciB2aXJ0dWFsIGNoYW5uZWxzIDAtMworCSAqIFJF
R19NQ19GSUZPX0NIQU5fQUxMT0MwOiBbODowXS1jaGFubmVsMCwgWzI0OjE2XS1jaGFubmVsMQor
CSAqIFJFR19NQ19GSUZPX0NIQU5fQUxMT0MxOiBbODowXS0yLCBbMjQ6MTZdLWNoYW5uZWwzCisJ
ICovCisJU0VUX01DX0ZJRk9fQ0hBTl9BTExPQyhrbWJfZHNpLCBjdHJsX25vLCB2Y2hhbm5lbF9p
ZCwgZmlmb19zaXplKTsKKworCS8qIFNldCB0aHJlc2hvbGQgdG8gaGFsZiB0aGUgZmlmbyBzaXpl
LCBhY3R1YWwgc2l6ZT1zaXplKjE2ICovCisJZmlmb19ydGhyZXNob2xkID0gKChmaWZvX3NpemUp
ICogOCkgJiBCSVRfTUFTS18xNjsKKwlTRVRfTUNfRklGT19SVEhSRVNIT0xEKGttYl9kc2ksIGN0
cmxfbm8sIHZjaGFubmVsX2lkLCBmaWZvX3J0aHJlc2hvbGQpOworCisJLyogRW5hYmxlIHRoZSBN
QyBGSUZPIGNoYW5uZWwgY29ycmVzcG9uZGluZyB0byB0aGUgVmlydHVhbCBDaGFubmVsICovCisJ
a21iX3NldF9iaXRfbWlwaShrbWJfZHNpLCBNSVBJX1RYbV9IU19NQ19GSUZPX0NUUkxfRU4oY3Ry
bF9ubyksCisJCQkgdmNoYW5uZWxfaWQpOworfQorCitzdGF0aWMgdm9pZCBtaXBpX3R4X2N0cmxf
Y2ZnKHN0cnVjdCBrbWJfZHNpICprbWJfZHNpLCB1OCBmZ19pZCwKKwkJCSAgICAgc3RydWN0IG1p
cGlfY3RybF9jZmcgKmN0cmxfY2ZnKQoreworCXUzMiBzeW5jX2NmZyA9IDAsIGN0cmwgPSAwLCBm
Z19lbjsKKwl1MzIgY3RybF9ubyA9IE1JUElfQ1RSTDY7CisKKwkvKiBNSVBJX1RYX0hTX1NZTkNf
Q0ZHICovCisJaWYgKGN0cmxfY2ZnLT50eF9jdHJsX2NmZy5saW5lX3N5bmNfcGt0X2VuKQorCQlz
eW5jX2NmZyB8PSBMSU5FX1NZTkNfUEtUX0VOQUJMRTsKKwlpZiAoY3RybF9jZmctPnR4X2N0cmxf
Y2ZnLmZyYW1lX2NvdW50ZXJfYWN0aXZlKQorCQlzeW5jX2NmZyB8PSBGUkFNRV9DT1VOVEVSX0FD
VElWRTsKKwlpZiAoY3RybF9jZmctPnR4X2N0cmxfY2ZnLmxpbmVfY291bnRlcl9hY3RpdmUpCisJ
CXN5bmNfY2ZnIHw9IExJTkVfQ09VTlRFUl9BQ1RJVkU7CisJaWYgKGN0cmxfY2ZnLT50eF9jdHJs
X2NmZy50eF9kc2lfY2ZnLT52X2JsYW5raW5nKQorCQlzeW5jX2NmZyB8PSBEU0lfVl9CTEFOS0lO
RzsKKwlpZiAoY3RybF9jZmctPnR4X2N0cmxfY2ZnLnR4X2RzaV9jZmctPmhzYV9ibGFua2luZykK
KwkJc3luY19jZmcgfD0gRFNJX0hTQV9CTEFOS0lORzsKKwlpZiAoY3RybF9jZmctPnR4X2N0cmxf
Y2ZnLnR4X2RzaV9jZmctPmhicF9ibGFua2luZykKKwkJc3luY19jZmcgfD0gRFNJX0hCUF9CTEFO
S0lORzsKKwlpZiAoY3RybF9jZmctPnR4X2N0cmxfY2ZnLnR4X2RzaV9jZmctPmhmcF9ibGFua2lu
ZykKKwkJc3luY19jZmcgfD0gRFNJX0hGUF9CTEFOS0lORzsKKwlpZiAoY3RybF9jZmctPnR4X2N0
cmxfY2ZnLnR4X2RzaV9jZmctPnN5bmNfcHVsc2VfZXZlbnRuKQorCQlzeW5jX2NmZyB8PSBEU0lf
U1lOQ19QVUxTRV9FVkVOVE47CisJaWYgKGN0cmxfY2ZnLT50eF9jdHJsX2NmZy50eF9kc2lfY2Zn
LT5scG1fZmlyc3RfdnNhX2xpbmUpCisJCXN5bmNfY2ZnIHw9IERTSV9MUE1fRklSU1RfVlNBX0xJ
TkU7CisJaWYgKGN0cmxfY2ZnLT50eF9jdHJsX2NmZy50eF9kc2lfY2ZnLT5scG1fbGFzdF92ZnBf
bGluZSkKKwkJc3luY19jZmcgfD0gRFNJX0xQTV9MQVNUX1ZGUF9MSU5FOworCisJLyogRW5hYmxl
IGZyYW1lIGdlbmVyYXRvciAqLworCWZnX2VuID0gMSA8PCBmZ19pZDsKKwlzeW5jX2NmZyB8PSBG
UkFNRV9HRU5fRU4oZmdfZW4pOworCisJaWYgKGN0cmxfY2ZnLT50eF9jdHJsX2NmZy50eF9hbHdh
eXNfdXNlX2hhY3QpCisJCXN5bmNfY2ZnIHw9IEFMV0FZU19VU0VfSEFDVChmZ19lbik7CisJaWYg
KGN0cmxfY2ZnLT50eF9jdHJsX2NmZy50eF9oYWN0X3dhaXRfc3RvcCkKKwkJc3luY19jZmcgfD0g
SEFDVF9XQUlUX1NUT1AoZmdfZW4pOworCisJZGV2X2RiZyhrbWJfZHNpLT5kZXYsICJzeW5jX2Nm
Zz0lZCBmZ19lbj0lZFxuIiwgc3luY19jZmcsIGZnX2VuKTsKKworCS8qIE1JUElfVFhfSFNfQ1RS
TCAqLworCisJLyogdHlwZTpEU0ksIHNvdXJjZTpMQ0QgKi8KKwljdHJsID0gSFNfQ1RSTF9FTiB8
IFRYX1NPVVJDRTsKKwljdHJsIHw9IExDRF9WQyhmZ19pZCk7CisJY3RybCB8PSBBQ1RJVkVfTEFO
RVMoY3RybF9jZmctPmFjdGl2ZV9sYW5lcyAtIDEpOworCWlmIChjdHJsX2NmZy0+dHhfY3RybF9j
ZmcudHhfZHNpX2NmZy0+ZW90cF9lbikKKwkJY3RybCB8PSBEU0lfRU9UUF9FTjsKKwlpZiAoY3Ry
bF9jZmctPnR4X2N0cmxfY2ZnLnR4X2RzaV9jZmctPmhmcF9ibGFua19lbikKKwkJY3RybCB8PSBE
U0lfQ01EX0hGUF9FTjsKKworCS8qNjcgbnMgc3RvcCB0aW1lICovCisJY3RybCB8PSBIU0VYSVRf
Q05UKDB4NDMpOworCisJa21iX3dyaXRlX21pcGkoa21iX2RzaSwgTUlQSV9UWG1fSFNfU1lOQ19D
RkcoY3RybF9ubyksIHN5bmNfY2ZnKTsKKwlrbWJfd3JpdGVfbWlwaShrbWJfZHNpLCBNSVBJX1RY
bV9IU19DVFJMKGN0cmxfbm8pLCBjdHJsKTsKK30KKworc3RhdGljIHUzMiBtaXBpX3R4X2luaXRf
Y250cmwoc3RydWN0IGttYl9kc2kgKmttYl9kc2ksCisJCQkgICAgICBzdHJ1Y3QgbWlwaV9jdHJs
X2NmZyAqY3RybF9jZmcpCit7CisJdTMyIHJldCA9IDA7CisJdTggYWN0aXZlX3ZjaGFubmVscyA9
IDA7CisJdTggZnJhbWVfaWQsIHNlY3Q7CisJdTMyIGJpdHNfcGVyX3BjbGsgPSAwOworCXUzMiB3
b3JkX2NvdW50ID0gMDsKKwlzdHJ1Y3QgbWlwaV90eF9mcmFtZV9jZmcgKmZyYW1lOworCisJLyog
VGhpcyBpcyB0aGUgb3JkZXIgdG8gaW5pdGlhbGl6ZSBNSVBJIFRYOgorCSAqIDEuIHNldCBmcmFt
ZSBzZWN0aW9uIHBhcmFtZXRlcnMKKwkgKiAyLiBzZXQgZnJhbWUgc3BlY2lmaWMgcGFyYW1ldGVy
cworCSAqIDMuIGNvbm5lY3QgbGNkIHRvIG1pcGkKKwkgKiA0LiBtdWx0aSBjaGFubmVsIGZpZm8g
Y2ZnCisJICogNS4gc2V0IG1pcGl0eGNjdHJsY2ZnCisJICovCisKKwlmb3IgKGZyYW1lX2lkID0g
MDsgZnJhbWVfaWQgPCA0OyBmcmFtZV9pZCsrKSB7CisJCWZyYW1lID0gY3RybF9jZmctPnR4X2N0
cmxfY2ZnLmZyYW1lc1tmcmFtZV9pZF07CisKKwkJLyogRmluZCB2YWxpZCBmcmFtZSwgYXNzdW1l
IG9ubHkgb25lIHZhbGlkIGZyYW1lICovCisJCWlmICghZnJhbWUpCisJCQljb250aW51ZTsKKwor
CQkvKiBGcmFtZSBTZWN0aW9uIGNvbmZpZ3VyYXRpb24gKi8KKwkJLyogVE9ETyAtIGFzc3VtZSB0
aGVyZSBpcyBvbmx5IG9uZSB2YWxpZCBzZWN0aW9uIGluIGEgZnJhbWUsCisJCSAqIHNvIGJpdHNf
cGVyX3BjbGsgYW5kIHdvcmRfY291bnQgYXJlIG9ubHkgc2V0IG9uY2UKKwkJICovCisJCWZvciAo
c2VjdCA9IDA7IHNlY3QgPCBNSVBJX0NUUkxfVklSVFVBTF9DSEFOTkVMUzsgc2VjdCsrKSB7CisJ
CQlpZiAoIWZyYW1lLT5zZWN0aW9uc1tzZWN0XSkKKwkJCQljb250aW51ZTsKKworCQkJcmV0ID0g
bWlwaV90eF9mZ19zZWN0aW9uX2NmZyhrbWJfZHNpLCBmcmFtZV9pZCwgc2VjdCwKKwkJCQkJCSAg
ICAgZnJhbWUtPnNlY3Rpb25zW3NlY3RdLAorCQkJCQkJICAgICAmYml0c19wZXJfcGNsaywKKwkJ
CQkJCSAgICAgJndvcmRfY291bnQpOworCQkJaWYgKHJldCkKKwkJCQlyZXR1cm4gcmV0OworCQl9
CisKKwkJLyogU2V0IGZyYW1lIHNwZWNpZmljIHBhcmFtZXRlcnMgKi8KKwkJbWlwaV90eF9mZ19j
Zmcoa21iX2RzaSwgZnJhbWVfaWQsIGN0cmxfY2ZnLT5hY3RpdmVfbGFuZXMsCisJCQkgICAgICAg
Yml0c19wZXJfcGNsaywgd29yZF9jb3VudCwKKwkJCSAgICAgICBjdHJsX2NmZy0+bGFuZV9yYXRl
X21icHMsIGZyYW1lKTsKKworCQlhY3RpdmVfdmNoYW5uZWxzKys7CisKKwkJLyogU3RvcCBpdGVy
YXRpbmcgYXMgb25seSBvbmUgdmlydHVhbCBjaGFubmVsCisJCSAqIHNoYWxsIGJlIHVzZWQgZm9y
IExDRCBjb25uZWN0aW9uCisJCSAqLworCQlicmVhazsKKwl9CisKKwlpZiAoYWN0aXZlX3ZjaGFu
bmVscyA9PSAwKQorCQlyZXR1cm4gLUVJTlZBTDsKKwkvKiBNdWx0aS1DaGFubmVsIEZJRk8gQ29u
ZmlndXJhdGlvbiAqLworCW1pcGlfdHhfbXVsdGljaGFubmVsX2ZpZm9fY2ZnKGttYl9kc2ksIGN0
cmxfY2ZnLT5hY3RpdmVfbGFuZXMsIGZyYW1lX2lkKTsKKworCS8qIEZyYW1lIEdlbmVyYXRvciBF
bmFibGUgKi8KKwltaXBpX3R4X2N0cmxfY2ZnKGttYl9kc2ksIGZyYW1lX2lkLCBjdHJsX2NmZyk7
CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgdm9pZCB0ZXN0X21vZGVfc2VuZChzdHJ1Y3Qg
a21iX2RzaSAqa21iX2RzaSwgdTMyIGRwaHlfbm8sCisJCQkgICB1MzIgdGVzdF9jb2RlLCB1MzIg
dGVzdF9kYXRhKQoreworCS8qIFN0ZXBzIHRvIHNlbmQgdGVzdCBjb2RlOgorCSAqIC0gc2V0IHRl
c3RjbGsgSElHSAorCSAqIC0gc2V0IHRlc3RkaW4gd2l0aCB0ZXN0IGNvZGUKKwkgKiAtIHNldCB0
ZXN0ZW4gSElHSAorCSAqIC0gc2V0IHRlc3RjbGsgTE9XCisJICogLSBzZXQgdGVzdGVuIExPVwor
CSAqLworCisJLyogU2V0IHRlc3RjbGsgaGlnaCAqLworCVNFVF9EUEhZX1RFU1RfQ1RSTDFfQ0xL
KGttYl9kc2ksIGRwaHlfbm8pOworCisJLyogU2V0IHRlc3RkaW4gKi8KKwlTRVRfVEVTVF9ESU4w
XzMoa21iX2RzaSwgZHBoeV9ubywgdGVzdF9jb2RlKTsKKworCS8qIFNldCB0ZXN0ZW4gaGlnaCAq
LworCVNFVF9EUEhZX1RFU1RfQ1RSTDFfRU4oa21iX2RzaSwgZHBoeV9ubyk7CisKKwkvKiBTZXQg
dGVzdGNsayBsb3cgKi8KKwlDTFJfRFBIWV9URVNUX0NUUkwxX0NMSyhrbWJfZHNpLCBkcGh5X25v
KTsKKworCS8qIFNldCB0ZXN0ZW4gbG93ICovCisJQ0xSX0RQSFlfVEVTVF9DVFJMMV9FTihrbWJf
ZHNpLCBkcGh5X25vKTsKKworCWlmICh0ZXN0X2NvZGUpIHsKKwkJLyogIFN0ZXBzIHRvIHNlbmQg
dGVzdCBkYXRhOgorCQkgKiAtIHNldCB0ZXN0ZW4gTE9XCisJCSAqIC0gc2V0IHRlc3RjbGsgTE9X
CisJCSAqIC0gc2V0IHRlc3RkaW4gd2l0aCBkYXRhCisJCSAqIC0gc2V0IHRlc3RjbGsgSElHSAor
CQkgKi8KKworCQkvKiBTZXQgdGVzdGVuIGxvdyAqLworCQlDTFJfRFBIWV9URVNUX0NUUkwxX0VO
KGttYl9kc2ksIGRwaHlfbm8pOworCisJCS8qIFNldCB0ZXN0Y2xrIGxvdyAqLworCQlDTFJfRFBI
WV9URVNUX0NUUkwxX0NMSyhrbWJfZHNpLCBkcGh5X25vKTsKKworCQkvKiBTZXQgZGF0YSBpbiB0
ZXN0ZGluICovCisJCWttYl93cml0ZV9taXBpKGttYl9kc2ksCisJCQkgICAgICAgRFBIWV9URVNU
X0RJTjBfMyArICgoZHBoeV9ubyAvIDB4NCkgKiAweDQpLAorCQkJICAgICAgIHRlc3RfZGF0YSA8
PCAoKGRwaHlfbm8gJSA0KSAqIDgpKTsKKworCQkvKiBTZXQgdGVzdGNsayBoaWdoICovCisJCVNF
VF9EUEhZX1RFU1RfQ1RSTDFfQ0xLKGttYl9kc2ksIGRwaHlfbm8pOworCX0KK30KKworc3RhdGlj
IGlubGluZSB2b2lkCisJc2V0X3Rlc3RfbW9kZV9zcmNfb3NjX2ZyZXFfdGFyZ2V0X2xvd19iaXRz
KHN0cnVjdCBrbWJfZHNpICprbWJfZHNpLAorCQkJCQkJICAgdTMyIGRwaHlfbm8sCisJCQkJCQkg
ICB1MzIgZnJlcSkKK3sKKwkvKiBUeXBpY2FsIHJpc2UvZmFsbCB0aW1lPTE2NiwgcmVmZXIgVGFi
bGUgMTIwNyBkYXRhYm9vaywKKwkgKiBzcl9vc2NfZnJlcV90YXJnZXRbNzowXQorCSAqLworCXRl
c3RfbW9kZV9zZW5kKGttYl9kc2ksIGRwaHlfbm8sIFRFU1RfQ09ERV9TTEVXX1JBVEVfRERMX0NZ
Q0xFUywKKwkJICAgICAgIChmcmVxICYgMHg3ZikpOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQK
KwlzZXRfdGVzdF9tb2RlX3NyY19vc2NfZnJlcV90YXJnZXRfaGlfYml0cyhzdHJ1Y3Qga21iX2Rz
aSAqa21iX2RzaSwKKwkJCQkJCSAgdTMyIGRwaHlfbm8sCisJCQkJCQkgIHUzMiBmcmVxKQorewor
CXUzMiBkYXRhOworCisJLyogRmxhZyB0aGlzIGFzIGhpZ2ggbmliYmxlICovCisJZGF0YSA9ICgo
ZnJlcSA+PiA2KSAmIDB4MWYpIHwgKDEgPDwgNyk7CisKKwkvKiBUeXBpY2FsIHJpc2UvZmFsbCB0
aW1lPTE2NiwgcmVmZXIgVGFibGUgMTIwNyBkYXRhYm9vaywKKwkgKiBzcl9vc2NfZnJlcV90YXJn
ZXRbMTE6N10KKwkgKi8KKwl0ZXN0X21vZGVfc2VuZChrbWJfZHNpLCBkcGh5X25vLCBURVNUX0NP
REVfU0xFV19SQVRFX0RETF9DWUNMRVMsIGRhdGEpOworfQorCitzdGF0aWMgdm9pZCBtaXBpX3R4
X2dldF92Y29fcGFyYW1zKHN0cnVjdCB2Y29fcGFyYW1zICp2Y28pCit7CisJaW50IGk7CisKKwlm
b3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRSh2Y29fdGFibGUpOyBpKyspIHsKKwkJaWYgKHZjby0+
ZnJlcSA8IHZjb190YWJsZVtpXS5mcmVxKSB7CisJCQkqdmNvID0gdmNvX3RhYmxlW2ldOworCQkJ
cmV0dXJuOworCQl9CisJfQorCisJV0FSTl9PTkNFKDEsICJJbnZhbGlkIHZjbyBmcmVxID0gJXUg
Zm9yIFBMTCBzZXR1cFxuIiwgdmNvLT5mcmVxKTsKK30KKworc3RhdGljIHZvaWQgbWlwaV90eF9w
bGxfc2V0dXAoc3RydWN0IGttYl9kc2kgKmttYl9kc2ksIHUzMiBkcGh5X25vLAorCQkJICAgICAg
dTMyIHJlZl9jbGtfbWh6LCB1MzIgdGFyZ2V0X2ZyZXFfbWh6KQoreworCXUzMiBiZXN0X24gPSAw
LCBiZXN0X20gPSAwOworCXUzMiBuID0gMCwgbSA9IDAsIGRpdiA9IDAsIGRlbHRhLCBmcmVxID0g
MCwgdF9mcmVxOworCXUzMiBiZXN0X2ZyZXFfZGVsdGEgPSAzMDAwOworCisJLyogcGxsX3JlZl9j
bGs6IC0gdmFsaWQgcmFuZ2U6IDJ+NjQgTUh6OyBUeXBpY2FsbHkgMjQgTUh6CisJICogRnZjbzog
LSB2YWxpZCByYW5nZTogMzIwfjEyNTAgTUh6IChHZW4zIEQtUEhZKQorCSAqIEZvdXQ6IC0gdmFs
aWQgcmFuZ2U6IDQwfjEyNTAgTUh6IChHZW4zIEQtUEhZKQorCSAqIG46IC0gdmFsaWQgcmFuZ2Ug
WzAgMTVdCisJICogTjogLSBOID0gbiArIDEKKwkgKiAgICAgIC12YWxpZCByYW5nZTogWzEgMTZd
CisJICogICAgICAtY29uZGl0aW9uczogLSAocGxsX3JlZl9jbGsgLyBOKSA+PSAyIE1IegorCSAq
ICAgICAgICAgICAgIC0ocGxsX3JlZl9jbGsgLyBOKSA8PSA4IE1IegorCSAqIG06IHZhbGlkIHJh
bmdlIFs2MiA2MjNdCisJICogTTogLSBNID0gbSArIDIKKwkgKiAgICAgIC12YWxpZCByYW5nZSBb
NjQgNjI1XQorCSAqICAgICAgLUZ2Y28gPSAoTS9OKSAqIHBsbF9yZWZfY2xrCisJICovCisJc3Ry
dWN0IHZjb19wYXJhbXMgdmNvX3AgPSB7CisJCS5yYW5nZSA9IDAsCisJCS5kaXZpZGVyID0gMSwK
Kwl9OworCisJdmNvX3AuZnJlcSA9IHRhcmdldF9mcmVxX21oejsKKwltaXBpX3R4X2dldF92Y29f
cGFyYW1zKCZ2Y29fcCk7CisKKwkvKiBTZWFyY2ggcGxsIG4gcGFyYW1ldGVyICovCisJZm9yIChu
ID0gUExMX05fTUlOOyBuIDw9IFBMTF9OX01BWDsgbisrKSB7CisJCS8qIENhbGN1bGF0ZSB0aGUg
cGxsIGlucHV0IGZyZXF1ZW5jeSBkaXZpc2lvbiByYXRpbworCQkgKiBtdWx0aXBseSBieSAxMDAw
IGZvciBwcmVjaXNpb24gLQorCQkgKiBubyBmbG9hdGluZyBwb2ludCwgYWRkIG4gZm9yIHJvdW5k
aW5nCisJCSAqLworCQlkaXYgPSAoKHJlZl9jbGtfbWh6ICogMTAwMCkgKyBuKSAvIChuICsgMSk7
CisKKwkJLyogRm91bmQgYSB2YWxpZCBuIHBhcmFtZXRlciAqLworCQlpZiAoKGRpdiA8IDIwMDAg
fHwgZGl2ID4gODAwMCkpCisJCQljb250aW51ZTsKKworCQkvKiBTZWFyY2ggcGxsIG0gcGFyYW1l
dGVyICovCisJCWZvciAobSA9IFBMTF9NX01JTjsgbSA8PSBQTExfTV9NQVg7IG0rKykgeworCQkJ
LyogQ2FsY3VsYXRlIHRoZSBGdmNvKERQSFkgUExMIG91dHB1dCBmcmVxdWVuY3kpCisJCQkgKiB1
c2luZyB0aGUgY3VycmVudCBuLG0gcGFyYW1zCisJCQkgKi8KKwkJCWZyZXEgPSBkaXYgKiAobSAr
IDIpOworCQkJZnJlcSAvPSAxMDAwOworCisJCQkvKiBUcmltIHRoZSBwb3RlbnRpYWwgcGxsIGZy
ZXEgdG8gbWF4IHN1cHBvcnRlZCAqLworCQkJaWYgKGZyZXEgPiBQTExfRlZDT19NQVgpCisJCQkJ
Y29udGludWU7CisKKwkJCWRlbHRhID0gYWJzKGZyZXEgLSB0YXJnZXRfZnJlcV9taHopOworCisJ
CQkvKiBTZWxlY3QgdGhlIGJlc3QgKGNsb3Nlc3QgdG8gdGFyZ2V0IHBsbCBmcmVxKQorCQkJICog
bixtIHBhcmFtZXRlcnMgc28gZmFyCisJCQkgKi8KKwkJCWlmIChkZWx0YSA8IGJlc3RfZnJlcV9k
ZWx0YSkgeworCQkJCWJlc3RfbiA9IG47CisJCQkJYmVzdF9tID0gbTsKKwkJCQliZXN0X2ZyZXFf
ZGVsdGEgPSBkZWx0YTsKKwkJCX0KKwkJfQorCX0KKworCS8qIFByb2dyYW0gdmNvX2NudHJsIHBh
cmFtZXRlcgorCSAqIFBMTF9WQ09fQ29udHJvbFs1OjBdID0gcGxsX3Zjb19jbnRybF9vdnIsCisJ
ICogUExMX1ZDT19Db250cm9sWzZdICAgPSBwbGxfdmNvX2NudHJsX292cl9lbgorCSAqLworCXRl
c3RfbW9kZV9zZW5kKGttYl9kc2ksIGRwaHlfbm8sIFRFU1RfQ09ERV9QTExfVkNPX0NUUkwsICh2
Y29fcC5yYW5nZQorCQkJCQkJCQl8ICgxIDw8IDYpKSk7CisKKwkvKiBQcm9ncmFtIG0sIG4gcGxs
IHBhcmFtZXRlcnMgKi8KKwlkZXZfZGJnKGttYl9kc2ktPmRldiwgIm0gPSAlZCBuID0gJWRcbiIs
IGJlc3RfbSwgYmVzdF9uKTsKKworCS8qIFBMTF9JbnB1dF9EaXZpZGVyX1JhdGlvWzM6MF0gPSBw
bGxfbl9vdnIgKi8KKwl0ZXN0X21vZGVfc2VuZChrbWJfZHNpLCBkcGh5X25vLCBURVNUX0NPREVf
UExMX0lOUFVUX0RJVklERVIsCisJCSAgICAgICAoYmVzdF9uICYgMHgwZikpOworCisJLyogbSAt
IGxvdyBuaWJibGUgUExMX0xvb3BfRGl2aWRlcl9SYXRpb1s0OjBdCisJICogcGxsX21fb3ZyWzQ6
MF0KKwkgKi8KKwl0ZXN0X21vZGVfc2VuZChrbWJfZHNpLCBkcGh5X25vLCBURVNUX0NPREVfUExM
X0ZFRURCQUNLX0RJVklERVIsCisJCSAgICAgICAoYmVzdF9tICYgMHgxZikpOworCisJLyogbSAt
IGhpZ2ggbmliYmxlIFBMTF9Mb29wX0RpdmlkZXJfUmF0aW9bNDowXQorCSAqIHBsbF9tX292cls5
OjVdCisJICovCisJdGVzdF9tb2RlX3NlbmQoa21iX2RzaSwgZHBoeV9ubywgVEVTVF9DT0RFX1BM
TF9GRUVEQkFDS19ESVZJREVSLAorCQkgICAgICAgKChiZXN0X20gPj4gNSkgJiAweDFmKSB8IFBM
TF9GRUVEQkFDS19ESVZJREVSX0hJR0gpOworCisJLyogRW5hYmxlIG92ZXJ3cml0ZSBvZiBuLG0g
cGFyYW1ldGVycyA6cGxsX25fb3ZyX2VuLCBwbGxfbV9vdnJfZW4gKi8KKwl0ZXN0X21vZGVfc2Vu
ZChrbWJfZHNpLCBkcGh5X25vLCBURVNUX0NPREVfUExMX09VVFBVVF9DTEtfU0VMLAorCQkgICAg
ICAgKFBMTF9OX09WUl9FTiB8IFBMTF9NX09WUl9FTikpOworCisJLyogUHJvZ3JhbSBDaGFyZ2Ut
UHVtcCBwYXJhbWV0ZXJzICovCisKKwkvKiBwbGxfcHJvcF9jbnRybC1maXhlZCB2YWx1ZXMgZm9y
IHByb3BfY250cmwgZnJvbSBEUEhZIGRvYyAqLworCXRfZnJlcSA9IHRhcmdldF9mcmVxX21oeiAq
IHZjb19wLmRpdmlkZXI7CisJdGVzdF9tb2RlX3NlbmQoa21iX2RzaSwgZHBoeV9ubywKKwkJICAg
ICAgIFRFU1RfQ09ERV9QTExfUFJPUE9SVElPTkFMX0NIQVJHRV9QVU1QX0NUUkwsCisJCSAgICAg
ICAoKHRfZnJlcSA+IDExNTApID8gMHgwQyA6IDB4MEIpKTsKKworCS8qIHBsbF9pbnRfY250cmwt
Zml4ZWQgdmFsdWUgZm9yIGludF9jbnRybCBmcm9tIERQSFkgZG9jICovCisJdGVzdF9tb2RlX3Nl
bmQoa21iX2RzaSwgZHBoeV9ubywgVEVTVF9DT0RFX1BMTF9JTlRFR1JBTF9DSEFSR0VfUFVNUF9D
VFJMLAorCQkgICAgICAgMHgwMCk7CisKKwkvKiBwbGxfZ21wX2NudHJsLWZpeGVkIHZhbHVlIGZv
ciBnbXBfY250cmwgZnJvbSBEUEhZIGRvY2kgKi8KKwl0ZXN0X21vZGVfc2VuZChrbWJfZHNpLCBk
cGh5X25vLCBURVNUX0NPREVfUExMX0dNUF9DVFJMLCAweDEwKTsKKworCS8qIHBsbF9jcGJpYXNf
Y250cmwtZml4ZWQgdmFsdWUgZm9yIGNwYmlhc19jbnRybCBmcm9tIERQSFkgZG9jICovCisJdGVz
dF9tb2RlX3NlbmQoa21iX2RzaSwgZHBoeV9ubywgVEVTVF9DT0RFX1BMTF9DSEFSR0VfUFVNUF9C
SUFTLCAweDEwKTsKKworCS8qIHBsbF90aDEgLUxvY2sgRGV0ZWN0b3IgUGhhc2UgZXJyb3IgdGhy
ZXNob2xkLAorCSAqIGRvY3VtZW50IGdpdmVzIGZpeGVkIHZhbHVlCisJICovCisJdGVzdF9tb2Rl
X3NlbmQoa21iX2RzaSwgZHBoeV9ubywgVEVTVF9DT0RFX1BMTF9QSEFTRV9FUlJfQ1RSTCwgMHgw
Mik7CisKKwkvKiBQTEwgTG9jayBDb25maWd1cmF0aW9uICovCisKKwkvKiBwbGxfdGgyIC0gTG9j
ayBGaWx0ZXIgbGVuZ3RoLCBkb2N1bWVudCBnaXZlcyBmaXhlZCB2YWx1ZSAqLworCXRlc3RfbW9k
ZV9zZW5kKGttYl9kc2ksIGRwaHlfbm8sIFRFU1RfQ09ERV9QTExfTE9DS19GSUxURVIsIDB4NjAp
OworCisJLyogcGxsX3RoMy0gUExMIFVubG9ja2luZyBmaWx0ZXIsIGRvY3VtZW50IGdpdmVzIGZp
eGVkIHZhbHVlICovCisJdGVzdF9tb2RlX3NlbmQoa21iX2RzaSwgZHBoeV9ubywgVEVTVF9DT0RF
X1BMTF9VTkxPQ0tfRklMVEVSLCAweDAzKTsKKworCS8qIHBsbF9sb2NrX3NlbC1QTEwgTG9jayBE
ZXRlY3RvciBTZWxlY3Rpb24sCisJICogZG9jdW1lbnQgZ2l2ZXMgZml4ZWQgdmFsdWUKKwkgKi8K
Kwl0ZXN0X21vZGVfc2VuZChrbWJfZHNpLCBkcGh5X25vLCBURVNUX0NPREVfUExMX0xPQ0tfREVU
RUNUT1IsIDB4MDIpOworfQorCitzdGF0aWMgdm9pZCBzZXRfc2xld3JhdGVfZ3RfMTUwMChzdHJ1
Y3Qga21iX2RzaSAqa21iX2RzaSwgdTMyIGRwaHlfbm8pCit7CisJdTMyIHRlc3RfY29kZSA9IDAs
IHRlc3RfZGF0YSA9IDA7CisJLyogQnlwYXNzIHNsZXcgcmF0ZSBjYWxpYnJhdGlvbiBhbGdvcml0
aG0KKwkgKiBiaXRzWzE6MH0gc3JjYWxfZW5fb3ZyX2VuLCBzcmNhbF9lbl9vdnIKKwkgKi8KKwl0
ZXN0X2NvZGUgPSBURVNUX0NPREVfU0xFV19SQVRFX09WRVJSSURFX0NUUkw7CisJdGVzdF9kYXRh
ID0gMHgwMjsKKwl0ZXN0X21vZGVfc2VuZChrbWJfZHNpLCBkcGh5X25vLCB0ZXN0X2NvZGUsIHRl
c3RfZGF0YSk7CisKKwkvKiBEaXNhYmxlIHNsZXcgcmF0ZSBjYWxpYnJhdGlvbiAqLworCXRlc3Rf
Y29kZSA9IFRFU1RfQ09ERV9TTEVXX1JBVEVfRERMX0xPT1BfQ1RSTDsKKwl0ZXN0X2RhdGEgPSAw
eDAwOworCXRlc3RfbW9kZV9zZW5kKGttYl9kc2ksIGRwaHlfbm8sIHRlc3RfY29kZSwgdGVzdF9k
YXRhKTsKK30KKworc3RhdGljIHZvaWQgc2V0X3NsZXdyYXRlX2d0XzEwMDAoc3RydWN0IGttYl9k
c2kgKmttYl9kc2ksIHUzMiBkcGh5X25vKQoreworCXUzMiB0ZXN0X2NvZGUgPSAwLCB0ZXN0X2Rh
dGEgPSAwOworCisJLyogQml0UmF0ZTogPiAxIEdicHMgJiYgPD0gMS41IEdicHM6IC0gc2xldyBy
YXRlIGNvbnRyb2wgT04KKwkgKiB0eXBpY2FsIHJpc2UvZmFsbCB0aW1lczogMTY2IHBzCisJICov
CisKKwkvKiBEbyBub3QgYnlwYXNzIHNsZXcgcmF0ZSBjYWxpYnJhdGlvbiBhbGdvcml0aG0KKwkg
KiBiaXRzWzE6MH09c3JjYWxfZW5fb3ZyX2VuLCBzcmNhbF9lbl9vdnIsIGJpdFs2XT1zcl9yYW5n
ZQorCSAqLworCXRlc3RfY29kZSA9IFRFU1RfQ09ERV9TTEVXX1JBVEVfT1ZFUlJJREVfQ1RSTDsK
Kwl0ZXN0X2RhdGEgPSAoMHgwMyB8ICgxIDw8IDYpKTsKKwl0ZXN0X21vZGVfc2VuZChrbWJfZHNp
LCBkcGh5X25vLCB0ZXN0X2NvZGUsIHRlc3RfZGF0YSk7CisKKwkvKiBFbmFibGUgc2xldyByYXRl
IGNhbGlicmF0aW9uICovCisJdGVzdF9jb2RlID0gVEVTVF9DT0RFX1NMRVdfUkFURV9ERExfTE9P
UF9DVFJMOworCXRlc3RfZGF0YSA9IDB4MDE7CisJdGVzdF9tb2RlX3NlbmQoa21iX2RzaSwgZHBo
eV9ubywgdGVzdF9jb2RlLCB0ZXN0X2RhdGEpOworCisJLyogU2V0IHNyX29zY19mcmVxX3Rhcmdl
dFs2OjBdIGxvdyBuaWJibGUKKwkgKiB0eXBpY2FsIHJpc2UvZmFsbCB0aW1lPTE2NiwgcmVmZXIg
VGFibGUgMTIwNyBkYXRhYm9vaworCSAqLworCXRlc3RfY29kZSA9IFRFU1RfQ09ERV9TTEVXX1JB
VEVfRERMX0NZQ0xFUzsKKwl0ZXN0X2RhdGEgPSAoMHg3MmYgJiAweDdmKTsKKwl0ZXN0X21vZGVf
c2VuZChrbWJfZHNpLCBkcGh5X25vLCB0ZXN0X2NvZGUsIHRlc3RfZGF0YSk7CisKKwkvKiBTZXQg
c3Jfb3NjX2ZyZXFfdGFyZ2V0WzExOjddIGhpZ2ggbmliYmxlCisJICogVHlwaWNhbCByaXNlL2Zh
bGwgdGltZT0xNjYsIHJlZmVyIFRhYmxlIDEyMDcgZGF0YWJvb2sKKwkgKi8KKwl0ZXN0X2NvZGUg
PSBURVNUX0NPREVfU0xFV19SQVRFX0RETF9DWUNMRVM7CisJdGVzdF9kYXRhID0gKCgweDcyZiA+
PiA2KSAmIDB4MWYpIHwgKDEgPDwgNyk7CisJdGVzdF9tb2RlX3NlbmQoa21iX2RzaSwgZHBoeV9u
bywgdGVzdF9jb2RlLCB0ZXN0X2RhdGEpOworfQorCitzdGF0aWMgdm9pZCBzZXRfc2xld3JhdGVf
bHRfMTAwMChzdHJ1Y3Qga21iX2RzaSAqa21iX2RzaSwgdTMyIGRwaHlfbm8pCit7CisJdTMyIHRl
c3RfY29kZSA9IDAsIHRlc3RfZGF0YSA9IDA7CisKKwkvKiBsYW5lX3JhdGVfbWJwcyA8PSAxMDAw
IE1icHMKKwkgKiBCaXRSYXRlOiAgPD0gMSBHYnBzOgorCSAqIC0gc2xldyByYXRlIGNvbnRyb2wg
T04KKwkgKiAtIHR5cGljYWwgcmlzZS9mYWxsIHRpbWVzOiAyMjUgcHMKKwkgKi8KKworCS8qIERv
IG5vdCBieXBhc3Mgc2xldyByYXRlIGNhbGlicmF0aW9uIGFsZ29yaXRobSAqLworCXRlc3RfY29k
ZSA9IFRFU1RfQ09ERV9TTEVXX1JBVEVfT1ZFUlJJREVfQ1RSTDsKKwl0ZXN0X2RhdGEgPSAoMHgw
MyB8ICgxIDw8IDYpKTsKKwl0ZXN0X21vZGVfc2VuZChrbWJfZHNpLCBkcGh5X25vLCB0ZXN0X2Nv
ZGUsIHRlc3RfZGF0YSk7CisKKwkvKiBFbmFibGUgc2xldyByYXRlIGNhbGlicmF0aW9uICovCisJ
dGVzdF9jb2RlID0gVEVTVF9DT0RFX1NMRVdfUkFURV9ERExfTE9PUF9DVFJMOworCXRlc3RfZGF0
YSA9IDB4MDE7CisJdGVzdF9tb2RlX3NlbmQoa21iX2RzaSwgZHBoeV9ubywgdGVzdF9jb2RlLCB0
ZXN0X2RhdGEpOworCisJLyogVHlwaWNhbCByaXNlL2ZhbGwgdGltZT0yNTUsIHJlZmVyIFRhYmxl
IDEyMDcgZGF0YWJvb2sgKi8KKwl0ZXN0X2NvZGUgPSBURVNUX0NPREVfU0xFV19SQVRFX0RETF9D
WUNMRVM7CisJdGVzdF9kYXRhID0gKDB4NTIzICYgMHg3Zik7CisJdGVzdF9tb2RlX3NlbmQoa21i
X2RzaSwgZHBoeV9ubywgdGVzdF9jb2RlLCB0ZXN0X2RhdGEpOworCisJLyogU2V0IHNyX29zY19m
cmVxX3RhcmdldFsxMTo3XSBoaWdoIG5pYmJsZSAqLworCXRlc3RfY29kZSA9IFRFU1RfQ09ERV9T
TEVXX1JBVEVfRERMX0NZQ0xFUzsKKwl0ZXN0X2RhdGEgPSAoKDB4NTIzID4+IDYpICYgMHgxZikg
fCAoMSA8PCA3KTsKKwl0ZXN0X21vZGVfc2VuZChrbWJfZHNpLCBkcGh5X25vLCB0ZXN0X2NvZGUs
IHRlc3RfZGF0YSk7Cit9CisKK3N0YXRpYyB2b2lkIHNldHVwX3BsbChzdHJ1Y3Qga21iX2RzaSAq
a21iX2RzaSwgdTMyIGRwaHlfbm8sCisJCSAgICAgIHN0cnVjdCBtaXBpX2N0cmxfY2ZnICpjZmcp
Cit7CisJdTMyIHRlc3RfY29kZSA9IDAsIHRlc3RfZGF0YSA9IDA7CisKKwkvKiBTZXQgUExMIHJl
Z3VsYXRvciBpbiBieXBhc3MgKi8KKwl0ZXN0X2NvZGUgPSBURVNUX0NPREVfUExMX0FOQUxPR19Q
Uk9HOworCXRlc3RfZGF0YSA9IDB4MDE7CisJdGVzdF9tb2RlX3NlbmQoa21iX2RzaSwgZHBoeV9u
bywgdGVzdF9jb2RlLCB0ZXN0X2RhdGEpOworCisJLyogUExMIFBhcmFtZXRlcnMgU2V0dXAgKi8K
KwltaXBpX3R4X3BsbF9zZXR1cChrbWJfZHNpLCBkcGh5X25vLCBjZmctPnJlZl9jbGtfa2h6IC8g
MTAwMCwKKwkJCSAgY2ZnLT5sYW5lX3JhdGVfbWJwcyAvIDIpOworCisJLyogU2V0IGNsa3NlbCAq
LworCWttYl93cml0ZV9iaXRzX21pcGkoa21iX2RzaSwgRFBIWV9JTklUX0NUUkwxLCBQTExfQ0xL
U0VMXzAsIDIsIDB4MDEpOworCisJLyogU2V0IHBsbF9zaGFkb3dfY29udHJvbCAqLworCWttYl9z
ZXRfYml0X21pcGkoa21iX2RzaSwgRFBIWV9JTklUX0NUUkwxLCBQTExfU0hBRE9XX0NUUkwpOwor
fQorCitzdGF0aWMgdm9pZCBzZXRfbGFuZV9kYXRhX3JhdGUoc3RydWN0IGttYl9kc2kgKmttYl9k
c2ksIHUzMiBkcGh5X25vLAorCQkJICAgICAgIHN0cnVjdCBtaXBpX2N0cmxfY2ZnICpjZmcpCit7
CisJdTMyIGksIHRlc3RfY29kZSA9IDAsIHRlc3RfZGF0YSA9IDA7CisKKwlmb3IgKGkgPSAwOyBp
IDwgTUlQSV9EUEhZX0RFRkFVTFRfQklUX1JBVEVTOyBpKyspIHsKKwkJaWYgKG1pcGlfaHNfZnJl
cV9yYW5nZVtpXS5kZWZhdWx0X2JpdF9yYXRlX21icHMgPAorCQkgICAgY2ZnLT5sYW5lX3JhdGVf
bWJwcykKKwkJCWNvbnRpbnVlOworCisJCS8qIFNlbmQgdGhlIHRlc3QgY29kZSBhbmQgZGF0YSAq
LworCQkvKiBiaXRbNjowXSA9IGhzZnJlcXJhbmdlX292ciBiaXRbN10gPSBoc2ZyZXFyYW5nZV9v
dnJfZW4gKi8KKwkJdGVzdF9jb2RlID0gVEVTVF9DT0RFX0hTX0ZSRVFfUkFOR0VfQ0ZHOworCQl0
ZXN0X2RhdGEgPSAobWlwaV9oc19mcmVxX3JhbmdlW2ldLmhzZnJlcXJhbmdlX2NvZGUgJiAweDdm
KSB8CisJCSAgICAoMSA8PCA3KTsKKwkJdGVzdF9tb2RlX3NlbmQoa21iX2RzaSwgZHBoeV9ubywg
dGVzdF9jb2RlLCB0ZXN0X2RhdGEpOworCQlicmVhazsKKwl9Cit9CisKK3N0YXRpYyB2b2lkIGRw
aHlfaW5pdF9zZXF1ZW5jZShzdHJ1Y3Qga21iX2RzaSAqa21iX2RzaSwKKwkJCSAgICAgICBzdHJ1
Y3QgbWlwaV9jdHJsX2NmZyAqY2ZnLCB1MzIgZHBoeV9ubywKKwkJCSAgICAgICBpbnQgYWN0aXZl
X2xhbmVzLCBlbnVtIGRwaHlfbW9kZSBtb2RlKQoreworCXUzMiB0ZXN0X2NvZGUgPSAwLCB0ZXN0
X2RhdGEgPSAwLCB2YWw7CisKKwkvKiBTZXQgRC1QSFkgaW4gc2h1dGRvd24gbW9kZSAqLworCS8q
IEFzc2VydCBSU1RaIHNpZ25hbCAqLworCUNMUl9EUEhZX0lOSVRfQ1RSTDAoa21iX2RzaSwgZHBo
eV9ubywgUkVTRVRaKTsKKworCS8qIEFzc2VydCBTSFVURE9XTlogc2lnbmFsICovCisJQ0xSX0RQ
SFlfSU5JVF9DVFJMMChrbWJfZHNpLCBkcGh5X25vLCBTSFVURE9XTlopOworCXZhbCA9IGttYl9y
ZWFkX21pcGkoa21iX2RzaSwgRFBIWV9JTklUX0NUUkwwKTsKKworCS8qIEluaXQgRC1QSFlfbgor
CSAqIFB1bHNlIHRlc3RjbGVhciBzaWduYWwgdG8gbWFrZSBzdXJlIHRoZSBkLXBoeSBjb25maWd1
cmF0aW9uCisJICogc3RhcnRzIGZyb20gYSBjbGVhbiBiYXNlCisJICovCisJQ0xSX0RQSFlfVEVT
VF9DVFJMMChrbWJfZHNpLCBkcGh5X25vKTsKKwluZGVsYXkoMTUpOworCVNFVF9EUEhZX1RFU1Rf
Q1RSTDAoa21iX2RzaSwgZHBoeV9ubyk7CisJbmRlbGF5KDE1KTsKKwlDTFJfRFBIWV9URVNUX0NU
UkwwKGttYl9kc2ksIGRwaHlfbm8pOworCW5kZWxheSgxNSk7CisKKwkvKiBTZXQgbWFzdGVybWFj
cm8gYml0IC0gTWFzdGVyIG9yIHNsYXZlIG1vZGUgKi8KKwl0ZXN0X2NvZGUgPSBURVNUX0NPREVf
TVVMVElQTEVfUEhZX0NUUkw7CisKKwkvKiBEUEhZIGhhcyBpdHMgb3duIGNsb2NrIGxhbmUgZW5h
YmxlZCAobWFzdGVyKSAqLworCWlmIChtb2RlID09IE1JUElfRFBIWV9NQVNURVIpCisJCXRlc3Rf
ZGF0YSA9IDB4MDE7CisJZWxzZQorCQl0ZXN0X2RhdGEgPSAweDAwOworCisJLyogU2VuZCB0aGUg
dGVzdCBjb2RlIGFuZCBkYXRhICovCisJdGVzdF9tb2RlX3NlbmQoa21iX2RzaSwgZHBoeV9ubywg
dGVzdF9jb2RlLCB0ZXN0X2RhdGEpOworCisJLyogU2V0IHRoZSBsYW5lIGRhdGEgcmF0ZSAqLwor
CXNldF9sYW5lX2RhdGFfcmF0ZShrbWJfZHNpLCBkcGh5X25vLCBjZmcpOworCisJLyogSGlnaC1T
cGVlZCBUeCBTbGV3IFJhdGUgQ2FsaWJyYXRpb24KKwkgKiBCaXRSYXRlOiA+IDEuNSBHYnBzICYm
IDw9IDIuNSBHYnBzOiBzbGV3IHJhdGUgY29udHJvbCBPRkYKKwkgKi8KKwlpZiAoY2ZnLT5sYW5l
X3JhdGVfbWJwcyA+IDE1MDApCisJCXNldF9zbGV3cmF0ZV9ndF8xNTAwKGttYl9kc2ksIGRwaHlf
bm8pOworCWVsc2UgaWYgKGNmZy0+bGFuZV9yYXRlX21icHMgPiAxMDAwKQorCQlzZXRfc2xld3Jh
dGVfZ3RfMTAwMChrbWJfZHNpLCBkcGh5X25vKTsKKwllbHNlCisJCXNldF9zbGV3cmF0ZV9sdF8x
MDAwKGttYl9kc2ksIGRwaHlfbm8pOworCisJLyogU2V0IGNmZ2Nsa2ZyZXFyYW5nZSAqLworCXZh
bCA9ICgoKGNmZy0+Y2ZnX2Nsa19raHogLyAxMDAwKSAtIDE3KSAqIDQpICYgMHgzZjsKKwlTRVRf
RFBIWV9GUkVRX0NUUkwwXzMoa21iX2RzaSwgZHBoeV9ubywgdmFsKTsKKworCS8qIEVuYWJsZSBj
b25maWcgY2xrIGZvciB0aGUgY29ycmVzcG9uZGluZyBkLXBoeSAqLworCWttYl9zZXRfYml0X21p
cGkoa21iX2RzaSwgRFBIWV9DRkdfQ0xLX0VOLCBkcGh5X25vKTsKKworCS8qIFBMTCBzZXR1cCAq
LworCWlmIChtb2RlID09IE1JUElfRFBIWV9NQVNURVIpCisJCXNldHVwX3BsbChrbWJfZHNpLCBk
cGh5X25vLCBjZmcpOworCisJLyogU2VuZCBOT1JNQUwgT1BFUkFUSU9OIHRlc3QgY29kZSAqLwor
CXRlc3RfY29kZSA9IDB4MDsKKwl0ZXN0X2RhdGEgPSAweDA7CisJdGVzdF9tb2RlX3NlbmQoa21i
X2RzaSwgZHBoeV9ubywgdGVzdF9jb2RlLCB0ZXN0X2RhdGEpOworCisJLyogQ29uZmlndXJlIEJB
U0VESVIgZm9yIGRhdGEgbGFuZXMKKwkgKiBOT1RFOiBiYXNlZGlyIG9ubHkgYXBwbGllcyB0byBM
QU5FXzAgb2YgZWFjaCBELVBIWS4KKwkgKiBUaGUgb3RoZXIgbGFuZXMga2VlcCB0aGVpciBkaXJl
Y3Rpb24gYmFzZWQgb24gdGhlIEQtUEhZIHR5cGUsCisJICogZWl0aGVyIFJ4IG9yIFR4LgorCSAq
IGJpdHNbNTowXSAgLSBCYXNlRGlyOiAxID0gUngKKwkgKiBiaXRzWzk6Nl0gLSBCYXNlRGlyOiAw
ID0gVHgKKwkgKi8KKwlrbWJfd3JpdGVfYml0c19taXBpKGttYl9kc2ksIERQSFlfSU5JVF9DVFJM
MiwgMCwgOSwgMHgwM2YpOworCW5kZWxheSgxNSk7CisKKwkvKiBFbmFibGUgQ0xPQ0sgTEFORQor
CSAqIENsb2NrIGxhbmUgc2hvdWxkIGJlIGVuYWJsZWQgcmVnYXJkbGVzcyBvZiB0aGUgZGlyZWN0
aW9uCisJICogc2V0IGZvciB0aGUgRC1QSFkgKFJ4L1R4KQorCSAqLworCWttYl9zZXRfYml0X21p
cGkoa21iX2RzaSwgRFBIWV9JTklUX0NUUkwyLCAxMiArIGRwaHlfbm8pOworCisJLyogRW5hYmxl
IERBVEEgTEFORVMgKi8KKwlrbWJfd3JpdGVfYml0c19taXBpKGttYl9kc2ksIERQSFlfRU5BQkxF
LCBkcGh5X25vICogMiwgMiwKKwkJCSAgICAoKDEgPDwgYWN0aXZlX2xhbmVzKSAtIDEpKTsKKwor
CW5kZWxheSgxNSk7CisKKwkvKiBUYWtlIEQtUEhZIG91dCBvZiBzaHV0ZG93biBtb2RlICovCisJ
LyogRGVhc3NlcnQgU0hVVERPV05aIHNpZ25hbCAqLworCVNFVF9EUEhZX0lOSVRfQ1RSTDAoa21i
X2RzaSwgZHBoeV9ubywgU0hVVERPV05aKTsKKwluZGVsYXkoMTUpOworCisJLyogRGVhc3NlcnQg
UlNUWiBzaWduYWwgKi8KKwlTRVRfRFBIWV9JTklUX0NUUkwwKGttYl9kc2ksIGRwaHlfbm8sIFJF
U0VUWik7Cit9CisKK3N0YXRpYyB2b2lkIGRwaHlfd2FpdF9mc20oc3RydWN0IGttYl9kc2kgKmtt
Yl9kc2ksIHUzMiBkcGh5X25vLAorCQkJICBlbnVtIGRwaHlfdHhfZnNtIGZzbV9zdGF0ZSkKK3sK
KwllbnVtIGRwaHlfdHhfZnNtIHZhbCA9IERQSFlfVFhfUE9XRVJEV047CisJaW50IGkgPSAwOwor
CWludCBzdGF0dXMgPSAxOworCisJZG8geworCQl0ZXN0X21vZGVfc2VuZChrbWJfZHNpLCBkcGh5
X25vLCBURVNUX0NPREVfRlNNX0NPTlRST0wsIDB4ODApOworCisJCXZhbCA9IEdFVF9URVNUX0RP
VVQ0Xzcoa21iX2RzaSwgZHBoeV9ubyk7CisJCWkrKzsKKwkJaWYgKGkgPiBUSU1FT1VUKSB7CisJ
CQlzdGF0dXMgPSAwOworCQkJYnJlYWs7CisJCX0KKwl9IHdoaWxlICh2YWwgIT0gZnNtX3N0YXRl
KTsKKworCWRldl9kYmcoa21iX2RzaS0+ZGV2LCAiJXM6IGRwaHkgJWQgdmFsID0gJXgiLCBfX2Z1
bmNfXywgZHBoeV9ubywgdmFsKTsKKwlkZXZfZGJnKGttYl9kc2ktPmRldiwgIiogRFBIWSAlZCBX
QUlUX0ZTTSAlcyAqIiwKKwkJZHBoeV9ubywgc3RhdHVzID8gIlNVQ0NFU1MiIDogIkZBSUxFRCIp
OworfQorCitzdGF0aWMgdm9pZCB3YWl0X2luaXRfZG9uZShzdHJ1Y3Qga21iX2RzaSAqa21iX2Rz
aSwgdTMyIGRwaHlfbm8sCisJCQkgICB1MzIgYWN0aXZlX2xhbmVzKQoreworCXUzMiBzdG9wc3Rh
dGVkYXRhID0gMDsKKwl1MzIgZGF0YV9sYW5lcyA9ICgxIDw8IGFjdGl2ZV9sYW5lcykgLSAxOwor
CWludCBpID0gMDsKKwlpbnQgc3RhdHVzID0gMTsKKworCWRvIHsKKwkJc3RvcHN0YXRlZGF0YSA9
IEdFVF9TVE9QU1RBVEVfREFUQShrbWJfZHNpLCBkcGh5X25vKQorCQkJCSYgZGF0YV9sYW5lczsK
KworCQkvKiBUT0RPLW5lZWQgdG8gYWRkIGEgdGltZSBvdXQgYW5kIHJldHVybiBmYWlsdXJlICov
CisJCWkrKzsKKworCQlpZiAoaSA+IFRJTUVPVVQpIHsKKwkJCXN0YXR1cyA9IDA7CisJCQlkZXZf
ZGJnKGttYl9kc2ktPmRldiwKKwkJCQkiISBXQUlUX0lOSVRfRE9ORTogVElNSU5HIE9VVCEoZXJy
X3N0YXQ9JWQpIiwKKwkJCQlrbWJfcmVhZF9taXBpKGttYl9kc2ksIE1JUElfRFBIWV9FUlJfU1RB
VDZfNykpOworCQkJYnJlYWs7CisJCX0KKwl9IHdoaWxlIChzdG9wc3RhdGVkYXRhICE9IGRhdGFf
bGFuZXMpOworCisJZGV2X2RiZyhrbWJfZHNpLT5kZXYsICIqIERQSFkgJWQgSU5JVCAtICVzICoi
LAorCQlkcGh5X25vLCBzdGF0dXMgPyAiU1VDQ0VTUyIgOiAiRkFJTEVEIik7Cit9CisKK3N0YXRp
YyB2b2lkIHdhaXRfcGxsX2xvY2soc3RydWN0IGttYl9kc2kgKmttYl9kc2ksIHUzMiBkcGh5X25v
KQoreworCWludCBpID0gMDsKKwlpbnQgc3RhdHVzID0gMTsKKworCWRvIHsKKwkJLyogVE9ETy1u
ZWVkIHRvIGFkZCBhIHRpbWUgb3V0IGFuZCByZXR1cm4gZmFpbHVyZSAqLworCQlpKys7CisJCWlm
IChpID4gVElNRU9VVCkgeworCQkJc3RhdHVzID0gMDsKKwkJCWRldl9kYmcoa21iX2RzaS0+ZGV2
LCAiJXM6IHRpbWluZyBvdXQiLCBfX2Z1bmNfXyk7CisJCQlicmVhazsKKwkJfQorCX0gd2hpbGUg
KCFHRVRfUExMX0xPQ0soa21iX2RzaSwgZHBoeV9ubykpOworCisJZGV2X2RiZyhrbWJfZHNpLT5k
ZXYsICIqIFBMTCBMb2NrZWQgZm9yIERQSFkgJWQgLSAlcyAqIiwKKwkJZHBoeV9ubywgc3RhdHVz
ID8gIlNVQ0NFU1MiIDogIkZBSUxFRCIpOworfQorCitzdGF0aWMgdTMyIG1pcGlfdHhfaW5pdF9k
cGh5KHN0cnVjdCBrbWJfZHNpICprbWJfZHNpLAorCQkJICAgICBzdHJ1Y3QgbWlwaV9jdHJsX2Nm
ZyAqY2ZnKQoreworCXUzMiBkcGh5X25vID0gTUlQSV9EUEhZNjsKKworCS8qIE11bHRpcGxlIEQt
UEhZcyBuZWVkZWQgKi8KKwlpZiAoY2ZnLT5hY3RpdmVfbGFuZXMgPiBNSVBJX0RQSFlfRF9MQU5F
UykgeworCQkvKgorCQkgKkluaXRpYWxpemF0aW9uIGZvciBUeCBhZ2dyZWdhdGlvbiBtb2RlIGlz
IGRvbmUgYWNjb3JkaW5nIHRvCisJCSAqYS4gc3RhcnQgaW5pdCBQSFkxCisJCSAqYi4gcG9sbCBm
b3IgUEhZMSBGU00gc3RhdGUgTE9DSworCQkgKiAgIGIxLiByZWcgYWRkciAweDAzWzM6MF0gLSBz
dGF0ZV9tYWluWzM6MF0gPT0gNSAoTE9DSykKKwkJICpjLiBwb2xsIGZvciBQSFkxIGNhbGlicmF0
aW9ucyBkb25lIDoKKwkJICogICBjMS4gdGVybWluYXRpb24gY2FsaWJyYXRpb24gbG93ZXIgc2Vj
dGlvbjogYWRkciAweDIyWzVdCisJCSAqICAgLSByZXNjYWxfZG9uZQorCQkgKiAgIGMyLiBzbGV3
cmF0ZSBjYWxpYnJhdGlvbiAoaWYgZGF0YSByYXRlIDwgPSAxNTAwIE1icHMpOgorCQkgKiAgICAg
YWRkciAweEE3WzM6Ml0gLSBzcmNhbF9kb25lLCBzcl9maW5pc2hlZAorCQkgKmQuIHN0YXJ0IGlu
aXQgUEhZMAorCQkgKmUuIHBvbGwgZm9yIFBIWTAgc3RvcHN0YXRlCisJCSAqZi4gcG9sbCBmb3Ig
UEhZMSBzdG9wc3RhdGUKKwkJICovCisJCS8qIFBIWSAjTisxICgnc2xhdmUnKSAqLworCisJCWRw
aHlfaW5pdF9zZXF1ZW5jZShrbWJfZHNpLCBjZmcsIGRwaHlfbm8gKyAxLAorCQkJCSAgIChjZmct
PmFjdGl2ZV9sYW5lcyAtIE1JUElfRFBIWV9EX0xBTkVTKSwKKwkJCQkgICBNSVBJX0RQSFlfU0xB
VkUpOworCQlkcGh5X3dhaXRfZnNtKGttYl9kc2ksIGRwaHlfbm8gKyAxLCBEUEhZX1RYX0xPQ0sp
OworCisJCS8qIFBIWSAjTiBtYXN0ZXIgKi8KKwkJZHBoeV9pbml0X3NlcXVlbmNlKGttYl9kc2ks
IGNmZywgZHBoeV9ubywgTUlQSV9EUEhZX0RfTEFORVMsCisJCQkJICAgTUlQSV9EUEhZX01BU1RF
Uik7CisKKwkJLyogV2FpdCBmb3IgRFBIWSBpbml0IHRvIGNvbXBsZXRlICovCisJCXdhaXRfaW5p
dF9kb25lKGttYl9kc2ksIGRwaHlfbm8sIE1JUElfRFBIWV9EX0xBTkVTKTsKKwkJd2FpdF9pbml0
X2RvbmUoa21iX2RzaSwgZHBoeV9ubyArIDEsCisJCQkgICAgICAgY2ZnLT5hY3RpdmVfbGFuZXMg
LSBNSVBJX0RQSFlfRF9MQU5FUyk7CisJCXdhaXRfcGxsX2xvY2soa21iX2RzaSwgZHBoeV9ubyk7
CisJCXdhaXRfcGxsX2xvY2soa21iX2RzaSwgZHBoeV9ubyArIDEpOworCQlkcGh5X3dhaXRfZnNt
KGttYl9kc2ksIGRwaHlfbm8sIERQSFlfVFhfSURMRSk7CisJfSBlbHNlIHsJCS8qIFNpbmdsZSBE
UEhZICovCisJCWRwaHlfaW5pdF9zZXF1ZW5jZShrbWJfZHNpLCBjZmcsIGRwaHlfbm8sIGNmZy0+
YWN0aXZlX2xhbmVzLAorCQkJCSAgIE1JUElfRFBIWV9NQVNURVIpOworCQlkcGh5X3dhaXRfZnNt
KGttYl9kc2ksIGRwaHlfbm8sIERQSFlfVFhfSURMRSk7CisJCXdhaXRfaW5pdF9kb25lKGttYl9k
c2ksIGRwaHlfbm8sIGNmZy0+YWN0aXZlX2xhbmVzKTsKKwkJd2FpdF9wbGxfbG9jayhrbWJfZHNp
LCBkcGh5X25vKTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgY29ubmVjdF9s
Y2RfdG9fbWlwaShzdHJ1Y3Qga21iX2RzaSAqa21iX2RzaSkKK3sKKwlzdHJ1Y3QgcmVnbWFwICpt
c3NjYW07CisKKwltc3NjYW0gPSBzeXNjb25fcmVnbWFwX2xvb2t1cF9ieV9jb21wYXRpYmxlKCJp
bnRlbCxrZWVtYmF5LW1zc2NhbSIpOworCWlmIChJU19FUlIobXNzY2FtKSkgeworCQlkZXZfZGJn
KGttYl9kc2ktPmRldiwgImZhaWxlZCB0byBnZXQgbXNzY2FtIHN5c2NvbiIpOworCQlyZXR1cm47
CisJfQorCisJLyogRElTQUJMRSBNSVBJLT5DSUYgQ09OTkVDVElPTiAqLworCXJlZ21hcF93cml0
ZShtc3NjYW0sIE1TU19NSVBJX0NJRl9DRkcsIDApOworCisJLyogRU5BQkxFIExDRC0+TUlQSSBD
T05ORUNUSU9OICovCisJcmVnbWFwX3dyaXRlKG1zc2NhbSwgTVNTX0xDRF9NSVBJX0NGRywgMSk7
CisJLyogRElTQUJMRSBMQ0QtPkNJRiBMT09QQkFDSyAqLworCXJlZ21hcF93cml0ZShtc3NjYW0s
IE1TU19MT09QQkFDS19DRkcsIDEpOworfQorCitpbnQga21iX2RzaV9tb2RlX3NldChzdHJ1Y3Qg
a21iX2RzaSAqa21iX2RzaSwgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUsCisJCSAgICAg
aW50IHN5c19jbGtfbWh6KQoreworCXU2NCBkYXRhX3JhdGU7CisKKwlrbWJfZHNpLT5zeXNfY2xr
X21oeiA9IHN5c19jbGtfbWh6OworCW1pcGlfdHhfaW5pdF9jZmcuYWN0aXZlX2xhbmVzID0gTUlQ
SV9UWF9BQ1RJVkVfTEFORVM7CisKKwltaXBpX3R4X2ZyYW1lMF9zZWN0X2NmZy53aWR0aF9waXhl
bHMgPSBtb2RlLT5jcnRjX2hkaXNwbGF5OworCW1pcGlfdHhfZnJhbWUwX3NlY3RfY2ZnLmhlaWdo
dF9saW5lcyA9IG1vZGUtPmNydGNfdmRpc3BsYXk7CisJbWlwaXR4X2ZyYW1lMF9jZmcudnN5bmNf
d2lkdGggPQorCQltb2RlLT5jcnRjX3ZzeW5jX2VuZCAtIG1vZGUtPmNydGNfdnN5bmNfc3RhcnQ7
CisJbWlwaXR4X2ZyYW1lMF9jZmcudl9iYWNrcG9yY2ggPQorCQltb2RlLT5jcnRjX3Z0b3RhbCAt
IG1vZGUtPmNydGNfdnN5bmNfZW5kOworCW1pcGl0eF9mcmFtZTBfY2ZnLnZfZnJvbnRwb3JjaCA9
CisJCW1vZGUtPmNydGNfdnN5bmNfc3RhcnQgLSBtb2RlLT5jcnRjX3ZkaXNwbGF5OworCW1pcGl0
eF9mcmFtZTBfY2ZnLmhzeW5jX3dpZHRoID0KKwkJbW9kZS0+Y3J0Y19oc3luY19lbmQgLSBtb2Rl
LT5jcnRjX2hzeW5jX3N0YXJ0OworCW1pcGl0eF9mcmFtZTBfY2ZnLmhfYmFja3BvcmNoID0KKwkJ
bW9kZS0+Y3J0Y19odG90YWwgLSBtb2RlLT5jcnRjX2hzeW5jX2VuZDsKKwltaXBpdHhfZnJhbWUw
X2NmZy5oX2Zyb250cG9yY2ggPQorCQltb2RlLT5jcnRjX2hzeW5jX3N0YXJ0IC0gbW9kZS0+Y3J0
Y19oZGlzcGxheTsKKworCS8qIExhbmUgcmF0ZSA9ICh2dG90YWwqaHRvdGFsKmZwcypicHApLzQg
LyAxMDAwMDAwCisJICogdG8gY29udmVydCB0byBNYnBzCisJICovCisJZGF0YV9yYXRlID0gKCgo
KHUzMiltb2RlLT5jcnRjX3Z0b3RhbCAqCSh1MzIpbW9kZS0+Y3J0Y19odG90YWwpICoKKwkJCSh1
MzIpKGRybV9tb2RlX3ZyZWZyZXNoKG1vZGUpKSAqCisJCQlNSVBJX1RYX0JQUCkgLyBtaXBpX3R4
X2luaXRfY2ZnLmFjdGl2ZV9sYW5lcykgLwkxMDAwMDAwOworCisJZGV2X2RiZyhrbWJfZHNpLT5k
ZXYsICJkYXRhX3JhdGU9JXUgYWN0aXZlX2xhbmVzPSVkXG4iLAorCQkodTMyKWRhdGFfcmF0ZSwg
bWlwaV90eF9pbml0X2NmZy5hY3RpdmVfbGFuZXMpOworCisJLyogV2hlbiBsYXRlIHJhdGUgPCA4
MDAsIG1vZGVzZXQgZmFpbHMgd2l0aCA0IGxhbmVzLAorCSAqIHNvIHN3aXRjaCB0byAyIGxhbmVz
CisJICovCisJaWYgKGRhdGFfcmF0ZSA8IDgwMCkgeworCQltaXBpX3R4X2luaXRfY2ZnLmFjdGl2
ZV9sYW5lcyA9IDI7CisJCW1pcGlfdHhfaW5pdF9jZmcubGFuZV9yYXRlX21icHMgPSBkYXRhX3Jh
dGUgKiAyOworCX0gZWxzZSB7CisJCW1pcGlfdHhfaW5pdF9jZmcubGFuZV9yYXRlX21icHMgPSBk
YXRhX3JhdGU7CisJfQorCisJa21iX3dyaXRlX21pcGkoa21iX2RzaSwgRFBIWV9FTkFCTEUsIDAp
OworCWttYl93cml0ZV9taXBpKGttYl9kc2ksIERQSFlfSU5JVF9DVFJMMCwgMCk7CisJa21iX3dy
aXRlX21pcGkoa21iX2RzaSwgRFBIWV9JTklUX0NUUkwxLCAwKTsKKwlrbWJfd3JpdGVfbWlwaShr
bWJfZHNpLCBEUEhZX0lOSVRfQ1RSTDIsIDApOworCisJLyogSW5pdGlhbGl6ZSBtaXBpIGNvbnRy
b2xsZXIgKi8KKwltaXBpX3R4X2luaXRfY250cmwoa21iX2RzaSwgJm1pcGlfdHhfaW5pdF9jZmcp
OworCisJLyogRHBoeSBpbml0aWFsaXphdGlvbiAqLworCW1pcGlfdHhfaW5pdF9kcGh5KGttYl9k
c2ksICZtaXBpX3R4X2luaXRfY2ZnKTsKKworCWNvbm5lY3RfbGNkX3RvX21pcGkoa21iX2RzaSk7
CisJZGV2X2luZm8oa21iX2RzaS0+ZGV2LCAibWlwaSBodyBpbml0aWFsaXplZCIpOworCisJcmV0
dXJuIDA7Cit9CisKK3N0cnVjdCBrbWJfZHNpICprbWJfZHNpX2luaXQoc3RydWN0IHBsYXRmb3Jt
X2RldmljZSAqcGRldikKK3sKKwlzdHJ1Y3Qga21iX2RzaSAqa21iX2RzaTsKKwlzdHJ1Y3QgZGV2
aWNlICpkZXYgPSBnZXRfZGV2aWNlKCZwZGV2LT5kZXYpOworCisJa21iX2RzaSA9IGRldm1fa3ph
bGxvYyhkZXYsIHNpemVvZigqa21iX2RzaSksIEdGUF9LRVJORUwpOworCWlmICgha21iX2RzaSkg
eworCQlkZXZfZXJyKGRldiwgImZhaWxlZCB0byBhbGxvY2F0ZSBrbWJfZHNpXG4iKTsKKwkJcmV0
dXJuIEVSUl9QVFIoLUVOT01FTSk7CisJfQorCisJa21iX2RzaS0+aG9zdCA9IGRzaV9ob3N0Owor
CWttYl9kc2ktPmhvc3QtPm9wcyA9ICZrbWJfZHNpX2hvc3Rfb3BzOworCisJZHNpX2RldmljZS0+
aG9zdCA9IGttYl9kc2ktPmhvc3Q7CisJa21iX2RzaS0+ZGV2aWNlID0gZHNpX2RldmljZTsKKwor
CXJldHVybiBrbWJfZHNpOworfQorCitpbnQga21iX2RzaV9lbmNvZGVyX2luaXQoc3RydWN0IGRy
bV9kZXZpY2UgKmRldiwgc3RydWN0IGttYl9kc2kgKmttYl9kc2kpCit7CisJc3RydWN0IGRybV9l
bmNvZGVyICplbmNvZGVyOworCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3I7CisJaW50
IHJldCA9IDA7CisKKwllbmNvZGVyID0gJmttYl9kc2ktPmJhc2U7CisJZW5jb2Rlci0+cG9zc2li
bGVfY3J0Y3MgPSAxOworCWVuY29kZXItPnBvc3NpYmxlX2Nsb25lcyA9IDA7CisKKwlyZXQgPSBk
cm1fc2ltcGxlX2VuY29kZXJfaW5pdChkZXYsIGVuY29kZXIsIERSTV9NT0RFX0VOQ09ERVJfRFNJ
KTsKKwlpZiAocmV0KSB7CisJCWRldl9lcnIoa21iX2RzaS0+ZGV2LCAiRmFpbGVkIHRvIGluaXQg
ZW5jb2RlciAlZFxuIiwgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwkvKiBMaW5rIGRybV9i
cmlkZ2UgdG8gZW5jb2RlciAqLworCXJldCA9IGRybV9icmlkZ2VfYXR0YWNoKGVuY29kZXIsIGFk
dl9icmlkZ2UsIE5VTEwsCisJCQkJRFJNX0JSSURHRV9BVFRBQ0hfTk9fQ09OTkVDVE9SKTsKKwlp
ZiAocmV0KSB7CisJCURSTV9FUlJPUigiZmFpbGVkIHRvIGF0dGFjaCBicmlkZ2UgdG8gTUlQSVxu
Iik7CisJCWRybV9lbmNvZGVyX2NsZWFudXAoZW5jb2Rlcik7CisJCXJldHVybiByZXQ7CisJfQor
CWRybV9pbmZvKGRldiwgIkJyaWRnZSBhdHRhY2hlZCA6IFNVQ0NFU1MiKTsKKwljb25uZWN0b3Ig
PSBkcm1fYnJpZGdlX2Nvbm5lY3Rvcl9pbml0KGRldiwgZW5jb2Rlcik7CisJaWYgKElTX0VSUihj
b25uZWN0b3IpKSB7CisJCURSTV9FUlJPUigiVW5hYmxlIHRvIGNyZWF0ZSBicmlkZ2UgY29ubmVj
dG9yIik7CisJCWRybV9lbmNvZGVyX2NsZWFudXAoZW5jb2Rlcik7CisJCXJldHVybiBQVFJfRVJS
KGNvbm5lY3Rvcik7CisJfQorCWRybV9jb25uZWN0b3JfYXR0YWNoX2VuY29kZXIoY29ubmVjdG9y
LCBlbmNvZGVyKTsKKwlyZXR1cm4gMDsKK30KKworaW50IGttYl9kc2lfbWFwX21taW8oc3RydWN0
IGttYl9kc2kgKmttYl9kc2kpCit7CisJc3RydWN0IHJlc291cmNlICpyZXM7CisJc3RydWN0IGRl
dmljZSAqZGV2ID0ga21iX2RzaS0+ZGV2OworCisJcmVzID0gcGxhdGZvcm1fZ2V0X3Jlc291cmNl
X2J5bmFtZShrbWJfZHNpLT5wZGV2LCBJT1JFU09VUkNFX01FTSwKKwkJCQkJICAgIm1pcGkiKTsK
KwlpZiAoIXJlcykgeworCQlkZXZfZXJyKGRldiwgImZhaWxlZCB0byBnZXQgcmVzb3VyY2UgZm9y
IG1pcGkiKTsKKwkJcmV0dXJuIC1FTk9NRU07CisJfQorCWttYl9kc2ktPm1pcGlfbW1pbyA9IGRl
dm1faW9yZW1hcF9yZXNvdXJjZShkZXYsIHJlcyk7CisJaWYgKElTX0VSUihrbWJfZHNpLT5taXBp
X21taW8pKSB7CisJCWRldl9lcnIoZGV2LCAiZmFpbGVkIHRvIGlvcmVtYXAgbWlwaSByZWdpc3Rl
cnMiKTsKKwkJcmV0dXJuIFBUUl9FUlIoa21iX2RzaS0+bWlwaV9tbWlvKTsKKwl9CisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyBpbnQga21iX2RzaV9jbGtfZW5hYmxlKHN0cnVjdCBrbWJfZHNpICpr
bWJfZHNpKQoreworCWludCByZXQ7CisJc3RydWN0IGRldmljZSAqZGV2ID0ga21iX2RzaS0+ZGV2
OworCisJcmV0ID0gY2xrX3ByZXBhcmVfZW5hYmxlKGttYl9kc2ktPmNsa19taXBpKTsKKwlpZiAo
cmV0KSB7CisJCWRldl9lcnIoZGV2LCAiRmFpbGVkIHRvIGVuYWJsZSBNSVBJIGNsb2NrOiAlZFxu
IiwgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXQgPSBjbGtfcHJlcGFyZV9lbmFibGUo
a21iX2RzaS0+Y2xrX21pcGlfZWNmZyk7CisJaWYgKHJldCkgeworCQlkZXZfZXJyKGRldiwgIkZh
aWxlZCB0byBlbmFibGUgTUlQSV9FQ0ZHIGNsb2NrOiAlZFxuIiwgcmV0KTsKKwkJcmV0dXJuIHJl
dDsKKwl9CisKKwlyZXQgPSBjbGtfcHJlcGFyZV9lbmFibGUoa21iX2RzaS0+Y2xrX21pcGlfY2Zn
KTsKKwlpZiAocmV0KSB7CisJCWRldl9lcnIoZGV2LCAiRmFpbGVkIHRvIGVuYWJsZSBNSVBJX0NG
RyBjbG9jazogJWRcbiIsIHJldCk7CisJCXJldHVybiByZXQ7CisJfQorCisJZGV2X2luZm8oZGV2
LCAiU1VDQ0VTUyA6IGVuYWJsZWQgTUlQSSBjbG9ja3NcbiIpOworCXJldHVybiAwOworfQorCitp
bnQga21iX2RzaV9jbGtfaW5pdChzdHJ1Y3Qga21iX2RzaSAqa21iX2RzaSkKK3sKKwlzdHJ1Y3Qg
ZGV2aWNlICpkZXYgPSBrbWJfZHNpLT5kZXY7CisJdW5zaWduZWQgbG9uZyBjbGs7CisKKwlrbWJf
ZHNpLT5jbGtfbWlwaSA9IGRldm1fY2xrX2dldChkZXYsICJjbGtfbWlwaSIpOworCWlmIChJU19F
UlIoa21iX2RzaS0+Y2xrX21pcGkpKSB7CisJCWRldl9lcnIoZGV2LCAiZGV2bV9jbGtfZ2V0KCkg
ZmFpbGVkIGNsa19taXBpXG4iKTsKKwkJcmV0dXJuIFBUUl9FUlIoa21iX2RzaS0+Y2xrX21pcGkp
OworCX0KKworCWttYl9kc2ktPmNsa19taXBpX2VjZmcgPSBkZXZtX2Nsa19nZXQoZGV2LCAiY2xr
X21pcGlfZWNmZyIpOworCWlmIChJU19FUlIoa21iX2RzaS0+Y2xrX21pcGlfZWNmZykpIHsKKwkJ
ZGV2X2VycihkZXYsICJkZXZtX2Nsa19nZXQoKSBmYWlsZWQgY2xrX21pcGlfZWNmZ1xuIik7CisJ
CXJldHVybiBQVFJfRVJSKGttYl9kc2ktPmNsa19taXBpX2VjZmcpOworCX0KKworCWttYl9kc2kt
PmNsa19taXBpX2NmZyA9IGRldm1fY2xrX2dldChkZXYsICJjbGtfbWlwaV9jZmciKTsKKwlpZiAo
SVNfRVJSKGttYl9kc2ktPmNsa19taXBpX2NmZykpIHsKKwkJZGV2X2VycihkZXYsICJkZXZtX2Ns
a19nZXQoKSBmYWlsZWQgY2xrX21pcGlfY2ZnXG4iKTsKKwkJcmV0dXJuIFBUUl9FUlIoa21iX2Rz
aS0+Y2xrX21pcGlfY2ZnKTsKKwl9CisJLyogU2V0IE1JUEkgY2xvY2sgdG8gMjQgTWh6ICovCisJ
Y2xrX3NldF9yYXRlKGttYl9kc2ktPmNsa19taXBpLCBLTUJfTUlQSV9ERUZBVUxUX0NMSyk7CisJ
aWYgKGNsa19nZXRfcmF0ZShrbWJfZHNpLT5jbGtfbWlwaSkgIT0gS01CX01JUElfREVGQVVMVF9D
TEspIHsKKwkJZGV2X2VycihkZXYsICJmYWlsZWQgdG8gc2V0IHRvIGNsa19taXBpIHRvICVkXG4i
LAorCQkJS01CX01JUElfREVGQVVMVF9DTEspOworCQlyZXR1cm4gLTE7CisJfQorCWRldl9kYmco
ZGV2LCAiY2xrX21pcGkgPSAlbGRcbiIsIGNsa19nZXRfcmF0ZShrbWJfZHNpLT5jbGtfbWlwaSkp
OworCisJY2xrID0gY2xrX2dldF9yYXRlKGttYl9kc2ktPmNsa19taXBpX2VjZmcpOworCWlmIChj
bGsgIT0gS01CX01JUElfREVGQVVMVF9DRkdfQ0xLKSB7CisJCS8qIFNldCBNSVBJX0VDRkcgY2xv
Y2sgdG8gMjQgTWh6ICovCisJCWNsa19zZXRfcmF0ZShrbWJfZHNpLT5jbGtfbWlwaV9lY2ZnLCBL
TUJfTUlQSV9ERUZBVUxUX0NGR19DTEspOworCQljbGsgPSBjbGtfZ2V0X3JhdGUoa21iX2RzaS0+
Y2xrX21pcGlfZWNmZyk7CisJCWlmIChjbGsgIT0gS01CX01JUElfREVGQVVMVF9DRkdfQ0xLKSB7
CisJCQlkZXZfZXJyKGRldiwgImZhaWxlZCB0byBzZXQgdG8gY2xrX21pcGlfZWNmZyB0byAlZFxu
IiwKKwkJCQlLTUJfTUlQSV9ERUZBVUxUX0NGR19DTEspOworCQkJcmV0dXJuIC0xOworCQl9CisJ
fQorCisJY2xrID0gY2xrX2dldF9yYXRlKGttYl9kc2ktPmNsa19taXBpX2NmZyk7CisJaWYgKGNs
ayAhPSBLTUJfTUlQSV9ERUZBVUxUX0NGR19DTEspIHsKKwkJLyogU2V0IE1JUElfQ0ZHIGNsb2Nr
IHRvIDI0IE1oeiAqLworCQljbGtfc2V0X3JhdGUoa21iX2RzaS0+Y2xrX21pcGlfY2ZnLCAyNDAw
MDAwMCk7CisJCWNsayA9IGNsa19nZXRfcmF0ZShrbWJfZHNpLT5jbGtfbWlwaV9jZmcpOworCQlp
ZiAoY2xrICE9IEtNQl9NSVBJX0RFRkFVTFRfQ0ZHX0NMSykgeworCQkJZGV2X2VycihkZXYsICJm
YWlsZWQgdG8gc2V0IGNsa19taXBpX2NmZyB0byAlZFxuIiwKKwkJCQlLTUJfTUlQSV9ERUZBVUxU
X0NGR19DTEspOworCQkJcmV0dXJuIC0xOworCQl9CisJfQorCisJcmV0dXJuIGttYl9kc2lfY2xr
X2VuYWJsZShrbWJfZHNpKTsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9rbWIva21i
X2RzaS5oIGIvZHJpdmVycy9ncHUvZHJtL2ttYi9rbWJfZHNpLmgKbmV3IGZpbGUgbW9kZSAxMDA2
NDQKaW5kZXggMDAwMDAwMC4uNjZiN2M1MAotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9rbWIva21iX2RzaS5oCkBAIC0wLDAgKzEsMzg3IEBACisvKiBTUERYLUxpY2Vuc2UtSWRl
bnRpZmllcjogR1BMLTIuMC1vbmx5CisgKgorICogQ29weXJpZ2h0IMKpIDIwMTktMjAyMCBJbnRl
bCBDb3Jwb3JhdGlvbgorICovCisKKyNpZm5kZWYgX19LTUJfRFNJX0hfXworI2RlZmluZSBfX0tN
Ql9EU0lfSF9fCisKKyNpbmNsdWRlIDxkcm0vZHJtX2VuY29kZXIuaD4KKyNpbmNsdWRlIDxkcm0v
ZHJtX21pcGlfZHNpLmg+CisKKy8qIE1JUEkgVFggQ0ZHICovCisjZGVmaW5lIE1JUElfVFhfTEFO
RV9EQVRBX1JBVEVfTUJQUyA4OTEKKyNkZWZpbmUgTUlQSV9UWF9SRUZfQ0xLX0tIWiAgICAgICAg
IDI0MDAwCisjZGVmaW5lIE1JUElfVFhfQ0ZHX0NMS19LSFogICAgICAgICAyNDAwMAorI2RlZmlu
ZSBNSVBJX1RYX0JQUAkJICAgIDI0CisKKy8qIERQSFkgVHggdGVzdCBjb2RlcyovCisjZGVmaW5l
IFRFU1RfQ09ERV9GU01fQ09OVFJPTAkJCQkweDAzCisjZGVmaW5lIFRFU1RfQ09ERV9NVUxUSVBM
RV9QSFlfQ1RSTAkJCTB4MEMKKyNkZWZpbmUgVEVTVF9DT0RFX1BMTF9QUk9QT1JUSU9OQUxfQ0hB
UkdFX1BVTVBfQ1RSTAkweDBFCisjZGVmaW5lIFRFU1RfQ09ERV9QTExfSU5URUdSQUxfQ0hBUkdF
X1BVTVBfQ1RSTAkJMHgwRgorI2RlZmluZSBURVNUX0NPREVfUExMX1ZDT19DVFJMCQkJCTB4MTIK
KyNkZWZpbmUgVEVTVF9DT0RFX1BMTF9HTVBfQ1RSTAkJCQkweDEzCisjZGVmaW5lIFRFU1RfQ09E
RV9QTExfUEhBU0VfRVJSX0NUUkwJCQkweDE0CisjZGVmaW5lIFRFU1RfQ09ERV9QTExfTE9DS19G
SUxURVIJCQkweDE1CisjZGVmaW5lIFRFU1RfQ09ERV9QTExfVU5MT0NLX0ZJTFRFUgkJCTB4MTYK
KyNkZWZpbmUgVEVTVF9DT0RFX1BMTF9JTlBVVF9ESVZJREVSCQkJMHgxNworI2RlZmluZSBURVNU
X0NPREVfUExMX0ZFRURCQUNLX0RJVklERVIJCQkweDE4CisjZGVmaW5lICAgUExMX0ZFRURCQUNL
X0RJVklERVJfSElHSAkJCUJJVCg3KQorI2RlZmluZSBURVNUX0NPREVfUExMX09VVFBVVF9DTEtf
U0VMCQkJMHgxOQorI2RlZmluZSAgIFBMTF9OX09WUl9FTgkJCQkJQklUKDQpCisjZGVmaW5lICAg
UExMX01fT1ZSX0VOCQkJCQlCSVQoNSkKKyNkZWZpbmUgVEVTVF9DT0RFX1ZPRF9MRVZFTAkJCQkw
eDI0CisjZGVmaW5lIFRFU1RfQ09ERV9QTExfQ0hBUkdFX1BVTVBfQklBUwkJCTB4MUMKKyNkZWZp
bmUgVEVTVF9DT0RFX1BMTF9MT0NLX0RFVEVDVE9SCQkJMHgxRAorI2RlZmluZSBURVNUX0NPREVf
SFNfRlJFUV9SQU5HRV9DRkcJCQkweDQ0CisjZGVmaW5lIFRFU1RfQ09ERV9QTExfQU5BTE9HX1BS
T0cJCQkweDFGCisjZGVmaW5lIFRFU1RfQ09ERV9TTEVXX1JBVEVfT1ZFUlJJREVfQ1RSTAkJMHhB
MAorI2RlZmluZSBURVNUX0NPREVfU0xFV19SQVRFX0RETF9MT09QX0NUUkwJCTB4QTMKKyNkZWZp
bmUgVEVTVF9DT0RFX1NMRVdfUkFURV9ERExfQ1lDTEVTCQkJMHhBNAorCisvKiBEUEhZIHBhcmFt
cyAqLworI2RlZmluZSBQTExfTl9NSU4JMAorI2RlZmluZSBQTExfTl9NQVgJMTUKKyNkZWZpbmUg
UExMX01fTUlOCTYyCisjZGVmaW5lIFBMTF9NX01BWAk2MjMKKyNkZWZpbmUgUExMX0ZWQ09fTUFY
CTEyNTAKKworI2RlZmluZSBUSU1FT1VUCQk2MDAKKworI2RlZmluZSBNSVBJX1RYX0ZSQU1FX0dF
TgkJCQk0CisjZGVmaW5lIE1JUElfVFhfRlJBTUVfR0VOX1NFQ1RJT05TCQkJNAorI2RlZmluZSBN
SVBJX0NUUkxfVklSVFVBTF9DSEFOTkVMUwkJCTQKKyNkZWZpbmUgTUlQSV9EX0xBTkVTX1BFUl9E
UEhZCQkJCTIKKyNkZWZpbmUgTUlQSV9DVFJMXzJMQU5FX01BWF9NQ19GSUZPX0xPQwkJCTI1NQor
I2RlZmluZSBNSVBJX0NUUkxfNExBTkVfTUFYX01DX0ZJRk9fTE9DCQkJNTExCisvKiAyIERhdGEg
TGFuZXMgcGVyIEQtUEhZICovCisjZGVmaW5lIE1JUElfRFBIWV9EX0xBTkVTCQkJCTIKKyNkZWZp
bmUgTUlQSV9EUEhZX0RFRkFVTFRfQklUX1JBVEVTCQkJNjMKKworI2RlZmluZSBLTUJfTUlQSV9E
RUZBVUxUX0NMSwkJCQkyNDAwMDAwMAorI2RlZmluZSBLTUJfTUlQSV9ERUZBVUxUX0NGR19DTEsJ
CQkyNDAwMDAwMAorCisjZGVmaW5lIHRvX2ttYl9kc2koeCkgY29udGFpbmVyX29mKHgsIHN0cnVj
dCBrbWJfZHNpLCBiYXNlKQorCitzdHJ1Y3Qga21iX2RzaSB7CisJc3RydWN0IGRybV9lbmNvZGVy
IGJhc2U7CisJc3RydWN0IGRldmljZSAqZGV2OworCXN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBk
ZXY7CisJc3RydWN0IG1pcGlfZHNpX2hvc3QgKmhvc3Q7CisJc3RydWN0IG1pcGlfZHNpX2Rldmlj
ZSAqZGV2aWNlOworCXN0cnVjdCBkcm1fYnJpZGdlICphZHZfYnJpZGdlOworCXZvaWQgX19pb21l
bSAqbWlwaV9tbWlvOworCXN0cnVjdCBjbGsgKmNsa19taXBpOworCXN0cnVjdCBjbGsgKmNsa19t
aXBpX2VjZmc7CisJc3RydWN0IGNsayAqY2xrX21pcGlfY2ZnOworCWludCBzeXNfY2xrX21oejsK
K307CisKKy8qIERQSFkgVHggdGVzdCBjb2RlcyAqLworCitlbnVtIG1pcGlfY3RybF9udW0gewor
CU1JUElfQ1RSTDAgPSAwLAorCU1JUElfQ1RSTDEsCisJTUlQSV9DVFJMMiwKKwlNSVBJX0NUUkwz
LAorCU1JUElfQ1RSTDQsCisJTUlQSV9DVFJMNSwKKwlNSVBJX0NUUkw2LAorCU1JUElfQ1RSTDcs
CisJTUlQSV9DVFJMOCwKKwlNSVBJX0NUUkw5LAorCU1JUElfQ1RSTF9OQQorfTsKKworZW51bSBt
aXBpX2RwaHlfbnVtIHsKKwlNSVBJX0RQSFkwID0gMCwKKwlNSVBJX0RQSFkxLAorCU1JUElfRFBI
WTIsCisJTUlQSV9EUEhZMywKKwlNSVBJX0RQSFk0LAorCU1JUElfRFBIWTUsCisJTUlQSV9EUEhZ
NiwKKwlNSVBJX0RQSFk3LAorCU1JUElfRFBIWTgsCisJTUlQSV9EUEhZOSwKKwlNSVBJX0RQSFlf
TkEKK307CisKK2VudW0gbWlwaV9kaXIgeworCU1JUElfUlgsCisJTUlQSV9UWAorfTsKKworZW51
bSBtaXBpX2N0cmxfdHlwZSB7CisJTUlQSV9EU0ksCisJTUlQSV9DU0kKK307CisKK2VudW0gbWlw
aV9kYXRhX2lmIHsKKwlNSVBJX0lGX0RNQSwKKwlNSVBJX0lGX1BBUkFMTEVMCit9OworCitlbnVt
IG1pcGlfZGF0YV9tb2RlIHsKKwlNSVBJX0RBVEFfTU9ERTAsCisJTUlQSV9EQVRBX01PREUxLAor
CU1JUElfREFUQV9NT0RFMiwKKwlNSVBJX0RBVEFfTU9ERTMKK307CisKK2VudW0gbWlwaV9kc2lf
dmlkZW9fbW9kZSB7CisJRFNJX1ZJREVPX01PREVfTk9fQlVSU1RfUFVMU0UsCisJRFNJX1ZJREVP
X01PREVfTk9fQlVSU1RfRVZFTlQsCisJRFNJX1ZJREVPX01PREVfQlVSU1QKK307CisKK2VudW0g
bWlwaV9kc2lfYmxhbmtpbmdfbW9kZSB7CisJVFJBTlNJVElPTl9UT19MT1dfUE9XRVIsCisJU0VO
RF9CTEFOS19QQUNLRVQKK307CisKK2VudW0gbWlwaV9kc2lfZW90cCB7CisJRFNJX0VPVFBfRElT
QUJMRUQsCisJRFNJX0VPVFBfRU5BQkxFUworfTsKKworZW51bSBtaXBpX2RzaV9kYXRhX3R5cGUg
eworCURTSV9TUF9EVF9SRVNFUlZFRF8wMCA9IDB4MDAsCisJRFNJX1NQX0RUX1ZTWU5DX1NUQVJU
ID0gMHgwMSwKKwlEU0lfU1BfRFRfQ09MT1JfTU9ERV9PRkYgPSAweDAyLAorCURTSV9TUF9EVF9H
RU5FUklDX1NIT1JUX1dSID0gMHgwMywKKwlEU0lfU1BfRFRfR0VORVJJQ19SRCA9IDB4MDQsCisJ
RFNJX1NQX0RUX0RDU19TSE9SVF9XUiA9IDB4MDUsCisJRFNJX1NQX0RUX0RDU19SRCA9IDB4MDYs
CisJRFNJX1NQX0RUX0VPVFAgPSAweDA4LAorCURTSV9MUF9EVF9OVUxMID0gMHgwOSwKKwlEU0lf
TFBfRFRfUkVTRVJWRURfMEEgPSAweDBhLAorCURTSV9MUF9EVF9SRVNFUlZFRF8wQiA9IDB4MGIs
CisJRFNJX0xQX0RUX0xQUFNfWUNCQ1I0MjJfMjBCID0gMHgwYywKKwlEU0lfTFBfRFRfUFBTX1JH
QjEwMTAxMF8zMEIgPSAweDBkLAorCURTSV9MUF9EVF9QUFNfUkdCNTY1XzE2QiA9IDB4MGUsCisJ
RFNJX0xQX0RUX1JFU0VSVkVEXzBGID0gMHgwZiwKKworCURTSV9TUF9EVF9SRVNFUlZFRF8xMCA9
IDB4MTAsCisJRFNJX1NQX0RUX1ZTWU5DX0VORCA9IDB4MTEsCisJRFNJX1NQX0RUX0NPTE9SX01P
REVfT04gPSAweDEyLAorCURTSV9TUF9EVF9HRU5FUklDX1NIT1JUX1dSXzFQQVIgPSAweDEzLAor
CURTSV9TUF9EVF9HRU5FUklDX1JEXzFQQVIgPSAweDE0LAorCURTSV9TUF9EVF9EQ1NfU0hPUlRf
V1JfMVBBUiA9IDB4MTUsCisJRFNJX1NQX0RUX1JFU0VSVkVEXzE2ID0gMHgxNiwKKwlEU0lfU1Bf
RFRfUkVTRVJWRURfMTcgPSAweDE3LAorCURTSV9TUF9EVF9SRVNFUlZFRF8xOCA9IDB4MTgsCisJ
RFNJX0xQX0RUX0JMQU5LID0gMHgxOSwKKwlEU0lfTFBfRFRfUkVTRVJWRURfMUEgPSAweDFhLAor
CURTSV9MUF9EVF9SRVNFUlZFRF8xQiA9IDB4MWIsCisJRFNJX0xQX0RUX1BQU19ZQ0JDUjQyMl8y
NEIgPSAweDFjLAorCURTSV9MUF9EVF9QUFNfUkdCMTIxMjEyXzM2QiA9IDB4MWQsCisJRFNJX0xQ
X0RUX1BQU19SR0I2NjZfMThCID0gMHgxZSwKKwlEU0lfTFBfRFRfUkVTRVJWRURfMUYgPSAweDFm
LAorCisJRFNJX1NQX0RUX1JFU0VSVkVEXzIwID0gMHgyMCwKKwlEU0lfU1BfRFRfSFNZTkNfU1RB
UlQgPSAweDIxLAorCURTSV9TUF9EVF9TSFVUX0RPV05fUEVSSVBIX0NNRCA9IDB4MjIsCisJRFNJ
X1NQX0RUX0dFTkVSSUNfU0hPUlRfV1JfMlBBUiA9IDB4MjMsCisJRFNJX1NQX0RUX0dFTkVSSUNf
UkRfMlBBUiA9IDB4MjQsCisJRFNJX1NQX0RUX1JFU0VSVkVEXzI1ID0gMHgyNSwKKwlEU0lfU1Bf
RFRfUkVTRVJWRURfMjYgPSAweDI2LAorCURTSV9TUF9EVF9SRVNFUlZFRF8yNyA9IDB4MjcsCisJ
RFNJX1NQX0RUX1JFU0VSVkVEXzI4ID0gMHgyOCwKKwlEU0lfTFBfRFRfR0VORVJJQ19MT05HX1dS
ID0gMHgyOSwKKwlEU0lfTFBfRFRfUkVTRVJWRURfMkEgPSAweDJhLAorCURTSV9MUF9EVF9SRVNF
UlZFRF8yQiA9IDB4MmIsCisJRFNJX0xQX0RUX1BQU19ZQ0JDUjQyMl8xNkIgPSAweDJjLAorCURT
SV9MUF9EVF9SRVNFUlZFRF8yRCA9IDB4MmQsCisJRFNJX0xQX0RUX0xQUFNfUkdCNjY2XzE4QiA9
IDB4MmUsCisJRFNJX0xQX0RUX1JFU0VSVkVEXzJGID0gMHgyZiwKKworCURTSV9TUF9EVF9SRVNF
UlZFRF8zMCA9IDB4MzAsCisJRFNJX1NQX0RUX0hTWU5DX0VORCA9IDB4MzEsCisJRFNJX1NQX0RU
X1RVUk5fT05fUEVSSVBIX0NNRCA9IDB4MzIsCisJRFNJX1NQX0RUX1JFU0VSVkVEXzMzID0gMHgz
MywKKwlEU0lfU1BfRFRfUkVTRVJWRURfMzQgPSAweDM0LAorCURTSV9TUF9EVF9SRVNFUlZFRF8z
NSA9IDB4MzUsCisJRFNJX1NQX0RUX1JFU0VSVkVEXzM2ID0gMHgzNiwKKwlEU0lfU1BfRFRfU0VU
X01BWF9SRVRVUk5fUEtUX1NJWkUgPSAweDM3LAorCURTSV9TUF9EVF9SRVNFUlZFRF8zOCA9IDB4
MzgsCisJRFNJX0xQX0RUX0RTQ19MT05HX1dSID0gMHgzOSwKKwlEU0lfTFBfRFRfUkVTRVJWRURf
M0EgPSAweDNhLAorCURTSV9MUF9EVF9SRVNFUlZFRF8zQiA9IDB4M2IsCisJRFNJX0xQX0RUX1JF
U0VSVkVEXzNDID0gMHgzYywKKwlEU0lfTFBfRFRfUFBTX1lDQkNSNDIwXzEyQiA9IDB4M2QsCisJ
RFNJX0xQX0RUX1BQU19SR0I4ODhfMjRCID0gMHgzZSwKKwlEU0lfTFBfRFRfUkVTRVJWRURfM0Yg
PSAweDNmCit9OworCitlbnVtIG1pcGlfdHhfaHNfdHBfc2VsIHsKKwlNSVBJX1RYX0hTX1RQX1dI
T0xFX0ZSQU1FX0NPTE9SMCA9IDAsCisJTUlQSV9UWF9IU19UUF9XSE9MRV9GUkFNRV9DT0xPUjEs
CisJTUlQSV9UWF9IU19UUF9WX1NUUklQRVMsCisJTUlQSV9UWF9IU19UUF9IX1NUUklQRVMsCit9
OworCitlbnVtIGRwaHlfbW9kZSB7CisJTUlQSV9EUEhZX1NMQVZFID0gMCwKKwlNSVBJX0RQSFlf
TUFTVEVSCit9OworCitlbnVtIGRwaHlfdHhfZnNtIHsKKwlEUEhZX1RYX1BPV0VSRFdOID0gMCwK
KwlEUEhZX1RYX0JHUE9OLAorCURQSFlfVFhfVEVSTUNBTCwKKwlEUEhZX1RYX1RFUk1DQUxVUCwK
KwlEUEhZX1RYX09GRlNFVENBTCwKKwlEUEhZX1RYX0xPQ0ssCisJRFBIWV9UWF9TUkNBTCwKKwlE
UEhZX1RYX0lETEUsCisJRFBIWV9UWF9VTFAsCisJRFBIWV9UWF9MQU5FU1RBUlQsCisJRFBIWV9U
WF9DTEtBTElHTiwKKwlEUEhZX1RYX0RETFRVTk5JTkcsCisJRFBIWV9UWF9VTFBfRk9SQ0VfUExM
LAorCURQSFlfVFhfTE9DS19MT1NTCit9OworCitzdHJ1Y3QgbWlwaV9kYXRhX3R5cGVfcGFyYW1z
IHsKKwl1OCBzaXplX2NvbnN0cmFpbnRfcGl4ZWxzOworCXU4IHNpemVfY29uc3RyYWludF9ieXRl
czsKKwl1OCBwaXhlbHNfcGVyX3BjbGs7CisJdTggYml0c19wZXJfcGNsazsKK307CisKK3N0cnVj
dCBtaXBpX3R4X2RzaV9jZmcgeworCXU4IGhmcF9ibGFua19lbjsJLyogSG9yaXpvbnRhbCBmcm9u
dCBwb3JjaCBibGFua2luZyBlbmFibGUgKi8KKwl1OCBlb3RwX2VuOwkJLyogRW5kIG9mIHRyYW5z
bWlzc2lvbiBwYWNrZXQgZW5hYmxlICovCisJLyogTGFzdCB2ZXJ0aWNhbCBmcm9udCBwb3JjaCBi
bGFua2luZyBtb2RlICovCisJdTggbHBtX2xhc3RfdmZwX2xpbmU7CisJLyogRmlyc3QgdmVydGlj
YWwgc3luYyBhY3RpdmUgYmxhbmtpbmcgbW9kZSAqLworCXU4IGxwbV9maXJzdF92c2FfbGluZTsK
Kwl1OCBzeW5jX3B1bHNlX2V2ZW50bjsJLyogU3luYyB0eXBlICovCisJdTggaGZwX2JsYW5raW5n
OwkvKiBIb3Jpem9udGFsIGZyb250IHBvcmNoIGJsYW5raW5nIG1vZGUgKi8KKwl1OCBoYnBfYmxh
bmtpbmc7CS8qIEhvcml6b250YWwgYmFjayBwb3JjaCBibGFua2luZyBtb2RlICovCisJdTggaHNh
X2JsYW5raW5nOwkvKiBIb3Jpem9udGFsIHN5bmMgYWN0aXZlIGJsYW5raW5nIG1vZGUgKi8KKwl1
OCB2X2JsYW5raW5nOwkJLyogVmVydGljYWwgdGltaW5nIGJsYW5raW5nIG1vZGUgKi8KK307CisK
K3N0cnVjdCBtaXBpX3R4X2ZyYW1lX3NlY3Rpb25fY2ZnIHsKKwl1MzIgZG1hX3Zfc3RyaWRlOwor
CXUxNiBkbWFfdl9zY2FsZV9jZmc7CisJdTE2IHdpZHRoX3BpeGVsczsKKwl1MTYgaGVpZ2h0X2xp
bmVzOworCXU4IGRtYV9wYWNrZWQ7CisJdTggYnBwOworCXU4IGJwcF91bnBhY2tlZDsKKwl1OCBk
bWFfaF9zdHJpZGU7CisJdTggZGF0YV90eXBlOworCXU4IGRhdGFfbW9kZTsKKwl1OCBkbWFfZmxp
cF9yb3RhdGVfc2VsOworfTsKKworc3RydWN0IG1pcGlfdHhfZnJhbWVfdGltaW5nX2NmZyB7CisJ
dTMyIGJwcDsKKwl1MzIgbGFuZV9yYXRlX21icHM7CisJdTMyIGhzeW5jX3dpZHRoOworCXUzMiBo
X2JhY2twb3JjaDsKKwl1MzIgaF9mcm9udHBvcmNoOworCXUzMiBoX2FjdGl2ZTsKKwl1MTYgdnN5
bmNfd2lkdGg7CisJdTE2IHZfYmFja3BvcmNoOworCXUxNiB2X2Zyb250cG9yY2g7CisJdTE2IHZf
YWN0aXZlOworCXU4IGFjdGl2ZV9sYW5lczsKK307CisKK3N0cnVjdCBtaXBpX3R4X2ZyYW1lX3Nl
Y3RfcGhjZmcgeworCXUzMiB3YzsKKwllbnVtIG1pcGlfZGF0YV9tb2RlIGRhdGFfbW9kZTsKKwll
bnVtIG1pcGlfZHNpX2RhdGFfdHlwZSBkYXRhX3R5cGU7CisJdTggdmNoYW5uZWw7CisJdTggZG1h
X3BhY2tlZDsKK307CisKK3N0cnVjdCBtaXBpX3R4X2ZyYW1lX2NmZyB7CisJc3RydWN0IG1pcGlf
dHhfZnJhbWVfc2VjdGlvbl9jZmcgKnNlY3Rpb25zW01JUElfVFhfRlJBTUVfR0VOX1NFQ1RJT05T
XTsKKwl1MzIgaHN5bmNfd2lkdGg7CS8qIGluIHBpeGVscyAqLworCXUzMiBoX2JhY2twb3JjaDsJ
LyogaW4gcGl4ZWxzICovCisJdTMyIGhfZnJvbnRwb3JjaDsJLyogaW4gcGl4ZWxzICovCisJdTE2
IHZzeW5jX3dpZHRoOwkvKiBpbiBsaW5lcyAqLworCXUxNiB2X2JhY2twb3JjaDsJLyogaW4gbGlu
ZXMgKi8KKwl1MTYgdl9mcm9udHBvcmNoOwkvKiBpbiBsaW5lcyAqLworfTsKKworc3RydWN0IG1p
cGlfdHhfY3RybF9jZmcgeworCXN0cnVjdCBtaXBpX3R4X2ZyYW1lX2NmZyAqZnJhbWVzW01JUElf
VFhfRlJBTUVfR0VOXTsKKwljb25zdCBzdHJ1Y3QgbWlwaV90eF9kc2lfY2ZnICp0eF9kc2lfY2Zn
OworCXU4IGxpbmVfc3luY19wa3RfZW47CisJdTggbGluZV9jb3VudGVyX2FjdGl2ZTsKKwl1OCBm
cmFtZV9jb3VudGVyX2FjdGl2ZTsKKwl1OCB0eF9oc2Nsa2tpZGxlX2NudDsKKwl1OCB0eF9oc2V4
aXRfY250OworCXU4IHR4X2NyY19lbjsKKwl1OCB0eF9oYWN0X3dhaXRfc3RvcDsKKwl1OCB0eF9h
bHdheXNfdXNlX2hhY3Q7CisJdTggdHhfd2FpdF90cmlnOworCXU4IHR4X3dhaXRfYWxsX3NlY3Q7
Cit9OworCisvKiBjb25maWd1cmF0aW9uIHN0cnVjdHVyZSBmb3IgTUlQSSBjb250cm9sICovCitz
dHJ1Y3QgbWlwaV9jdHJsX2NmZyB7CisJdTggYWN0aXZlX2xhbmVzOwkvKiAjIGFjdGl2ZSBsYW5l
cyBwZXIgY29udHJvbGxlciAyLzQgKi8KKwl1MzIgbGFuZV9yYXRlX21icHM7CS8qIE1CUFMgKi8K
Kwl1MzIgcmVmX2Nsa19raHo7CisJdTMyIGNmZ19jbGtfa2h6OworCXN0cnVjdCBtaXBpX3R4X2N0
cmxfY2ZnIHR4X2N0cmxfY2ZnOworfTsKKworc3RhdGljIGlubGluZSB2b2lkIGttYl93cml0ZV9t
aXBpKHN0cnVjdCBrbWJfZHNpICprbWJfZHNpLAorCQkJCSAgdW5zaWduZWQgaW50IHJlZywgdTMy
IHZhbHVlKQoreworCXdyaXRlbCh2YWx1ZSwgKGttYl9kc2ktPm1pcGlfbW1pbyArIHJlZykpOwor
fQorCitzdGF0aWMgaW5saW5lIHUzMiBrbWJfcmVhZF9taXBpKHN0cnVjdCBrbWJfZHNpICprbWJf
ZHNpLCB1bnNpZ25lZCBpbnQgcmVnKQoreworCXJldHVybiByZWFkbChrbWJfZHNpLT5taXBpX21t
aW8gKyByZWcpOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQga21iX3dyaXRlX2JpdHNfbWlwaShz
dHJ1Y3Qga21iX2RzaSAqa21iX2RzaSwKKwkJCQkgICAgICAgdW5zaWduZWQgaW50IHJlZywgdTMy
IG9mZnNldCwKKwkJCQkgICAgICAgdTMyIG51bV9iaXRzLCB1MzIgdmFsdWUpCit7CisJdTMyIHJl
Z192YWwgPSBrbWJfcmVhZF9taXBpKGttYl9kc2ksIHJlZyk7CisJdTMyIG1hc2sgPSAoMSA8PCBu
dW1fYml0cykgLSAxOworCisJdmFsdWUgJj0gbWFzazsKKwltYXNrIDw8PSBvZmZzZXQ7CisJcmVn
X3ZhbCAmPSAofm1hc2spOworCXJlZ192YWwgfD0gKHZhbHVlIDw8IG9mZnNldCk7CisJa21iX3dy
aXRlX21pcGkoa21iX2RzaSwgcmVnLCByZWdfdmFsKTsKK30KKworc3RhdGljIGlubGluZSB2b2lk
IGttYl9zZXRfYml0X21pcGkoc3RydWN0IGttYl9kc2kgKmttYl9kc2ksCisJCQkJICAgIHVuc2ln
bmVkIGludCByZWcsIHUzMiBvZmZzZXQpCit7CisJdTMyIHJlZ192YWwgPSBrbWJfcmVhZF9taXBp
KGttYl9kc2ksIHJlZyk7CisKKwlrbWJfd3JpdGVfbWlwaShrbWJfZHNpLCByZWcsIHJlZ192YWwg
fCAoMSA8PCBvZmZzZXQpKTsKK30KKworc3RhdGljIGlubGluZSB2b2lkIGttYl9jbHJfYml0X21p
cGkoc3RydWN0IGttYl9kc2kgKmttYl9kc2ksCisJCQkJICAgIHVuc2lnbmVkIGludCByZWcsIHUz
MiBvZmZzZXQpCit7CisJdTMyIHJlZ192YWwgPSBrbWJfcmVhZF9taXBpKGttYl9kc2ksIHJlZyk7
CisKKwlrbWJfd3JpdGVfbWlwaShrbWJfZHNpLCByZWcsIHJlZ192YWwgJiAofigxIDw8IG9mZnNl
dCkpKTsKK30KKworaW50IGttYl9kc2lfaG9zdF9icmlkZ2VfaW5pdChzdHJ1Y3QgZGV2aWNlICpk
ZXYpOworc3RydWN0IGttYl9kc2kgKmttYl9kc2lfaW5pdChzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNl
ICpwZGV2KTsKK3ZvaWQga21iX2RzaV9ob3N0X3VucmVnaXN0ZXIoc3RydWN0IGttYl9kc2kgKmtt
Yl9kc2kpOworaW50IGttYl9kc2lfbW9kZV9zZXQoc3RydWN0IGttYl9kc2kgKmttYl9kc2ksIHN0
cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlLAorCQkgICAgIGludCBzeXNfY2xrX21oeik7Citp
bnQga21iX2RzaV9tYXBfbW1pbyhzdHJ1Y3Qga21iX2RzaSAqa21iX2RzaSk7CitpbnQga21iX2Rz
aV9jbGtfaW5pdChzdHJ1Y3Qga21iX2RzaSAqa21iX2RzaSk7CitpbnQga21iX2RzaV9lbmNvZGVy
X2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgc3RydWN0IGttYl9kc2kgKmttYl9kc2kpOwor
I2VuZGlmIC8qIF9fS01CX0RTSV9IX18gKi8KLS0gCjIuNy40CgpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1k
ZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcv
bWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWwK
