Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id AC79A1C80C
	for <lists+dri-devel@lfdr.de>; Tue, 14 May 2019 13:55:27 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id DE33A8918E;
	Tue, 14 May 2019 11:55:24 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-qk1-x741.google.com (mail-qk1-x741.google.com
 [IPv6:2607:f8b0:4864:20::741])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 217628918E
 for <dri-devel@lists.freedesktop.org>; Tue, 14 May 2019 11:55:23 +0000 (UTC)
Received: by mail-qk1-x741.google.com with SMTP id g190so7937897qkf.8
 for <dri-devel@lists.freedesktop.org>; Tue, 14 May 2019 04:55:23 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc:content-transfer-encoding;
 bh=94i9moI9aAbX79rtWjpIvzJ0KFEcyOyw4lumuTSlrtk=;
 b=iiop8+TS8BWB9uj5/3pJowEBd9Pe2UOEdzj32b6e75R92wH+eVgl09WfkufdRBTjGP
 8iIoySK1BKR1cUHpKWfEun6CE/9nfuyYAcpBe/QxgRryrcWCHBr85sBnFJWewwjLXw6z
 H1g1zEUflZuHMg4BucwaqlCbvQ4O6AKkAGNkmdKTchzazsoubacctcNkhokezdqamy0a
 6c2kFMizDW3+btjcjxaqZGQJb/glwCjM0G6Pw5Tp4EHMEzZ+zDLH61kmmjVUVxh++vBZ
 KvKArGpgkLPVq1zEgLdaY2qxpyDp45HvK9k87TE96UXJXgh+8CFyhVXJuEXuZMKZYmFi
 5A0A==
X-Gm-Message-State: APjAAAWSvdXUrPe0Jd39dBUgfmHRTFtCpPBE5GsojW+HRsJfBL76FcwD
 sQQd4KfFkqaMiCukbydbMfT90819FFZhnXy8r7t21A==
X-Google-Smtp-Source: APXvYqyFF17HsOszywGmF6KjHUPe9oJPkm6zQ4rDzy+424HwfzAhi+CCI8+aH+toJuBKvd4DozAfNJP88hj/7yQesY8=
X-Received: by 2002:a05:620a:1084:: with SMTP id
 g4mr27155596qkk.228.1557834922886; 
 Tue, 14 May 2019 04:55:22 -0700 (PDT)
MIME-Version: 1.0
References: <20190513183727.15755-1-john.stultz@linaro.org>
 <20190513183727.15755-5-john.stultz@linaro.org>
 <0333e2b3-0e3d-360e-c8ac-62f3235d24be@hisilicon.com>
In-Reply-To: <0333e2b3-0e3d-360e-c8ac-62f3235d24be@hisilicon.com>
From: Benjamin Gaignard <benjamin.gaignard@linaro.org>
Date: Tue, 14 May 2019 13:55:12 +0200
Message-ID: <CA+M3ks5W7ad7ckFop7Stw4NU+fc-vfS=dX85hCuro0iER0OCNg@mail.gmail.com>
Subject: Re: [RFC][PATCH 4/5 v4] dma-buf: heaps: Add CMA heap to dmabuf heaps
To: "Xiaqing (A)" <saberlily.xia@hisilicon.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=linaro.org; s=google;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc:content-transfer-encoding;
 bh=94i9moI9aAbX79rtWjpIvzJ0KFEcyOyw4lumuTSlrtk=;
 b=njeEaVjVsuPpDrj4DnX1BoMZVHRIvg5rvZrR1k4dXWKMXfOPOfYXJJmMuf9ocxTdBO
 Sul8oJOHPGA9ucaDu5NQj9HNbVLbPgEj2g58aScK4m/i8UmCMS2rbrzpXauvWaL9e2Y6
 5ZOES+8jRckWen7NfneXM6jXTG1chpsQ/eA7fBTF8EjecAHHP3b+VKLrJZRQ9VIJOpSb
 Zzoul9AphxCiBYED1cKia1ZaM6YjcxvDdx9jx+Cj6/knFDQbu0RmQN/z1zwGpRjWganm
 e9o3S4yMTuwxNwl6IisxpLXNQV9vABebfKH9RA2WBljJtz1sf/bhOEq8j/iIVXLChLD5
 g8vA==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Yudongbin <yudongbin@hisilicon.com>, Sudipto Paul <Sudipto.Paul@arm.com>,
 Xu YiPing <xuyiping@hisilicon.com>, Alistair Strachan <astrachan@google.com>,
 Vincent Donnefort <Vincent.Donnefort@arm.com>,
 "Chenfeng \(puck\)" <puck.chen@hisilicon.com>, Kongfei <kongfei@hisilicon.com>,
 Chenbo Feng <fengc@google.com>, lkml <linux-kernel@vger.kernel.org>,
 Liam Mark <lmark@codeaurora.org>, Christoph Hellwig <hch@infradead.org>,
 ML dri-devel <dri-devel@lists.freedesktop.org>,
 "Andrew F . Davis" <afd@ti.com>,
 "Liuyi \(Daniel\)" <daniel.liuyi@hisilicon.com>,
 Pratik Patel <pratikp@codeaurora.org>, butao <butao@hisilicon.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

TGUgbWFyLiAxNCBtYWkgMjAxOSDDoCAxMjo0MCwgWGlhcWluZyAoQSkgPHNhYmVybGlseS54aWFA
aGlzaWxpY29uLmNvbT4gYSDDqWNyaXQgOgo+Cj4KPgo+IE9uIDIwMTkvNS8xNCAyOjM3LCBKb2hu
IFN0dWx0eiB3cm90ZToKPiA+IFRoaXMgYWRkcyBhIENNQSBoZWFwLCB3aGljaCBhbGxvd3MgdXNl
cnNwYWNlIHRvIGFsbG9jYXRlCj4gPiBhIGRtYS1idWYgb2YgY29udGlndW91cyBtZW1vcnkgb3V0
IG9mIGEgQ01BIHJlZ2lvbi4KPiA+Cj4gPiBUaGlzIGNvZGUgaXMgYW4gZXZvbHV0aW9uIG9mIHRo
ZSBBbmRyb2lkIElPTiBpbXBsZW1lbnRhdGlvbiwgc28KPiA+IHRoYW5rcyB0byBpdHMgb3JpZ2lu
YWwgYXV0aG9yIGFuZCBtYWludGFpbnRlcnM6Cj4gPiAgICBCZW5qYW1pbiBHYWlnbmFyZCwgTGF1
cmEgQWJib3R0LCBhbmQgb3RoZXJzIQo+ID4KPiA+IENjOiBMYXVyYSBBYmJvdHQgPGxhYmJvdHRA
cmVkaGF0LmNvbT4KPiA+IENjOiBCZW5qYW1pbiBHYWlnbmFyZCA8YmVuamFtaW4uZ2FpZ25hcmRA
bGluYXJvLm9yZz4KPiA+IENjOiBTdW1pdCBTZW13YWwgPHN1bWl0LnNlbXdhbEBsaW5hcm8ub3Jn
Pgo+ID4gQ2M6IExpYW0gTWFyayA8bG1hcmtAY29kZWF1cm9yYS5vcmc+Cj4gPiBDYzogUHJhdGlr
IFBhdGVsIDxwcmF0aWtwQGNvZGVhdXJvcmEub3JnPgo+ID4gQ2M6IEJyaWFuIFN0YXJrZXkgPEJy
aWFuLlN0YXJrZXlAYXJtLmNvbT4KPiA+IENjOiBWaW5jZW50IERvbm5lZm9ydCA8VmluY2VudC5E
b25uZWZvcnRAYXJtLmNvbT4KPiA+IENjOiBTdWRpcHRvIFBhdWwgPFN1ZGlwdG8uUGF1bEBhcm0u
Y29tPgo+ID4gQ2M6IEFuZHJldyBGLiBEYXZpcyA8YWZkQHRpLmNvbT4KPiA+IENjOiBYdSBZaVBp
bmcgPHh1eWlwaW5nQGhpc2lsaWNvbi5jb20+Cj4gPiBDYzogIkNoZW5mZW5nIChwdWNrKSIgPHB1
Y2suY2hlbkBoaXNpbGljb24uY29tPgo+ID4gQ2M6IGJ1dGFvIDxidXRhb0BoaXNpbGljb24uY29t
Pgo+ID4gQ2M6ICJYaWFxaW5nIChBKSIgPHNhYmVybGlseS54aWFAaGlzaWxpY29uLmNvbT4KPiA+
IENjOiBZdWRvbmdiaW4gPHl1ZG9uZ2JpbkBoaXNpbGljb24uY29tPgo+ID4gQ2M6IENocmlzdG9w
aCBIZWxsd2lnIDxoY2hAaW5mcmFkZWFkLm9yZz4KPiA+IENjOiBDaGVuYm8gRmVuZyA8ZmVuZ2NA
Z29vZ2xlLmNvbT4KPiA+IENjOiBBbGlzdGFpciBTdHJhY2hhbiA8YXN0cmFjaGFuQGdvb2dsZS5j
b20+Cj4gPiBDYzogZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwo+ID4gU2lnbmVkLW9m
Zi1ieTogSm9obiBTdHVsdHogPGpvaG4uc3R1bHR6QGxpbmFyby5vcmc+Cj4gPiAtLS0KPiA+IHYy
Ogo+ID4gKiBTd2l0Y2ggYWxsb2NhdGUgdG8gcmV0dXJuIGRtYWJ1ZiBmZAo+ID4gKiBTaW1wbGlm
eSBpbml0IGNvZGUKPiA+ICogQ2hlY2twYXRjaCBmaXh1cHMKPiA+IHYzOgo+ID4gKiBTd2l0Y2gg
dG8gaW5saW5lIGZ1bmN0aW9uIGZvciB0b19jbWFfaGVhcCgpCj4gPiAqIE1pbm9yIGNsZWFudXBz
IHN1Z2dlc3RlZCBieSBCcmlhbgo+ID4gKiBGb2xkIGluIG5ldyByZWdpc3RyYXRpb24gc3R5bGUg
ZnJvbSBBbmRyZXcKPiA+ICogRm9sZGVkIGluIGNoYW5nZXMgZnJvbSBBbmRyZXcgdG8gdXNlIHNp
bXBsaWZpZWQgcGFnZSBsaXN0Cj4gPiAgICBmcm9tIHRoZSBoZWFwIGhlbHBlcnMKPiA+ICogVXNl
IHRoZSBmZF9mbGFncyB3aGVuIGNyZWF0aW5nIGRtYWJ1ZiBmZCAoU3VnZ2VzdGVkIGJ5Cj4gPiAg
ICBCZW5qYW1pbikKPiA+ICogVXNlIHByZWNhbGN1bGF0ZWQgcGFnZWNvdW50IChTdWdnZXN0ZWQg
YnkgQW5kcmV3KQo+ID4gLS0tCj4gPiAgIGRyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9LY29uZmlnICAg
IHwgICA4ICsrCj4gPiAgIGRyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9NYWtlZmlsZSAgIHwgICAxICsK
PiA+ICAgZHJpdmVycy9kbWEtYnVmL2hlYXBzL2NtYV9oZWFwLmMgfCAxNjkgKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKwo+ID4gICAzIGZpbGVzIGNoYW5nZWQsIDE3OCBpbnNlcnRpb25z
KCspCj4gPiAgIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2RtYS1idWYvaGVhcHMvY21hX2hl
YXAuYwo+ID4KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2RtYS1idWYvaGVhcHMvS2NvbmZpZyBi
L2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9LY29uZmlnCj4gPiBpbmRleCAyMDUwNTI3NDQxNjkuLmE1
ZWVmMDZjNDIyNiAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9LY29uZmln
Cj4gPiArKysgYi9kcml2ZXJzL2RtYS1idWYvaGVhcHMvS2NvbmZpZwo+ID4gQEAgLTQsMyArNCwx
MSBAQCBjb25maWcgRE1BQlVGX0hFQVBTX1NZU1RFTQo+ID4gICAgICAgaGVscAo+ID4gICAgICAg
ICBDaG9vc2UgdGhpcyBvcHRpb24gdG8gZW5hYmxlIHRoZSBzeXN0ZW0gZG1hYnVmIGhlYXAuIFRo
ZSBzeXN0ZW0gaGVhcAo+ID4gICAgICAgICBpcyBiYWNrZWQgYnkgcGFnZXMgZnJvbSB0aGUgYnVk
ZHkgYWxsb2NhdG9yLiBJZiBpbiBkb3VidCwgc2F5IFkuCj4gPiArCj4gPiArY29uZmlnIERNQUJV
Rl9IRUFQU19DTUEKPiA+ICsgICAgIGJvb2wgIkRNQS1CVUYgQ01BIEhlYXAiCj4gPiArICAgICBk
ZXBlbmRzIG9uIERNQUJVRl9IRUFQUyAmJiBETUFfQ01BCj4gPiArICAgICBoZWxwCj4gPiArICAg
ICAgIENob29zZSB0aGlzIG9wdGlvbiB0byBlbmFibGUgZG1hLWJ1ZiBDTUEgaGVhcC4gVGhpcyBo
ZWFwIGlzIGJhY2tlZAo+ID4gKyAgICAgICBieSB0aGUgQ29udGlndW91cyBNZW1vcnkgQWxsb2Nh
dG9yIChDTUEpLiBJZiB5b3VyIHN5c3RlbSBoYXMgdGhlc2UKPiA+ICsgICAgICAgcmVnaW9ucywg
eW91IHNob3VsZCBzYXkgWSBoZXJlLgo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZG1hLWJ1Zi9o
ZWFwcy9NYWtlZmlsZSBiL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9NYWtlZmlsZQo+ID4gaW5kZXgg
ZDE4MDhlY2EyNTgxLi42ZTU0Y2RlYzNkYTAgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2RtYS1i
dWYvaGVhcHMvTWFrZWZpbGUKPiA+ICsrKyBiL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9NYWtlZmls
ZQo+ID4gQEAgLTEsMyArMSw0IEBACj4gPiAgICMgU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQ
TC0yLjAKPiA+ICAgb2JqLXkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAr
PSBoZWFwLWhlbHBlcnMubwo+ID4gICBvYmotJChDT05GSUdfRE1BQlVGX0hFQVBTX1NZU1RFTSkg
ICArPSBzeXN0ZW1faGVhcC5vCj4gPiArb2JqLSQoQ09ORklHX0RNQUJVRl9IRUFQU19DTUEpICAg
ICAgICAgICAgICAgKz0gY21hX2hlYXAubwo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZG1hLWJ1
Zi9oZWFwcy9jbWFfaGVhcC5jIGIvZHJpdmVycy9kbWEtYnVmL2hlYXBzL2NtYV9oZWFwLmMKPiA+
IG5ldyBmaWxlIG1vZGUgMTAwNjQ0Cj4gPiBpbmRleCAwMDAwMDAwMDAwMDAuLjNkMGZmYmJkMGEz
NAo+ID4gLS0tIC9kZXYvbnVsbAo+ID4gKysrIGIvZHJpdmVycy9kbWEtYnVmL2hlYXBzL2NtYV9o
ZWFwLmMKPiA+IEBAIC0wLDAgKzEsMTY5IEBACj4gPiArLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IEdQTC0yLjAKPiA+ICsvKgo+ID4gKyAqIERNQUJVRiBDTUEgaGVhcCBleHBvcnRlcgo+ID4g
KyAqCj4gPiArICogQ29weXJpZ2h0IChDKSAyMDEyLCAyMDE5IExpbmFybyBMdGQuCj4gPiArICog
QXV0aG9yOiA8YmVuamFtaW4uZ2FpZ25hcmRAbGluYXJvLm9yZz4gZm9yIFNULUVyaWNzc29uLgo+
ID4gKyAqLwo+ID4gKwo+ID4gKyNpbmNsdWRlIDxsaW51eC9kZXZpY2UuaD4KPiA+ICsjaW5jbHVk
ZSA8bGludXgvZG1hLWJ1Zi5oPgo+ID4gKyNpbmNsdWRlIDxsaW51eC9kbWEtaGVhcC5oPgo+ID4g
KyNpbmNsdWRlIDxsaW51eC9zbGFiLmg+Cj4gPiArI2luY2x1ZGUgPGxpbnV4L2Vycm5vLmg+Cj4g
PiArI2luY2x1ZGUgPGxpbnV4L2Vyci5oPgo+ID4gKyNpbmNsdWRlIDxsaW51eC9jbWEuaD4KPiA+
ICsjaW5jbHVkZSA8bGludXgvc2NhdHRlcmxpc3QuaD4KPiA+ICsjaW5jbHVkZSA8bGludXgvaGln
aG1lbS5oPgo+ID4gKwo+ID4gKyNpbmNsdWRlICJoZWFwLWhlbHBlcnMuaCIKPiA+ICsKPiA+ICtz
dHJ1Y3QgY21hX2hlYXAgewo+ID4gKyAgICAgc3RydWN0IGRtYV9oZWFwICpoZWFwOwo+ID4gKyAg
ICAgc3RydWN0IGNtYSAqY21hOwo+ID4gK307Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgY21hX2hl
YXBfZnJlZShzdHJ1Y3QgaGVhcF9oZWxwZXJfYnVmZmVyICpidWZmZXIpCj4gPiArewo+ID4gKyAg
ICAgc3RydWN0IGNtYV9oZWFwICpjbWFfaGVhcCA9IGRtYV9oZWFwX2dldF9kYXRhKGJ1ZmZlci0+
aGVhcF9idWZmZXIuaGVhcCk7Cj4gPiArICAgICB1bnNpZ25lZCBsb25nIG5yX3BhZ2VzID0gYnVm
ZmVyLT5wYWdlY291bnQ7Cj4gPiArICAgICBzdHJ1Y3QgcGFnZSAqcGFnZXMgPSBidWZmZXItPnBy
aXZfdmlydDsKPiA+ICsKPiA+ICsgICAgIC8qIGZyZWUgcGFnZSBsaXN0ICovCj4gPiArICAgICBr
ZnJlZShidWZmZXItPnBhZ2VzKTsKPiA+ICsgICAgIC8qIHJlbGVhc2UgbWVtb3J5ICovCj4gPiAr
ICAgICBjbWFfcmVsZWFzZShjbWFfaGVhcC0+Y21hLCBwYWdlcywgbnJfcGFnZXMpOwo+ID4gKyAg
ICAga2ZyZWUoYnVmZmVyKTsKPiA+ICt9Cj4gPiArCj4gPiArLyogZG1hYnVmIGhlYXAgQ01BIG9w
ZXJhdGlvbnMgZnVuY3Rpb25zICovCj4gPiArc3RhdGljIGludCBjbWFfaGVhcF9hbGxvY2F0ZShz
dHJ1Y3QgZG1hX2hlYXAgKmhlYXAsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1
bnNpZ25lZCBsb25nIGxlbiwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2ln
bmVkIGxvbmcgZmRfZmxhZ3MsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNp
Z25lZCBsb25nIGhlYXBfZmxhZ3MpCj4gPiArewo+ID4gKyAgICAgc3RydWN0IGNtYV9oZWFwICpj
bWFfaGVhcCA9IGRtYV9oZWFwX2dldF9kYXRhKGhlYXApOwo+ID4gKyAgICAgc3RydWN0IGhlYXBf
aGVscGVyX2J1ZmZlciAqaGVscGVyX2J1ZmZlcjsKPiA+ICsgICAgIHN0cnVjdCBwYWdlICpwYWdl
czsKPiA+ICsgICAgIHNpemVfdCBzaXplID0gUEFHRV9BTElHTihsZW4pOwo+ID4gKyAgICAgdW5z
aWduZWQgbG9uZyBucl9wYWdlcyA9IHNpemUgPj4gUEFHRV9TSElGVDsKPiA+ICsgICAgIHVuc2ln
bmVkIGxvbmcgYWxpZ24gPSBnZXRfb3JkZXIoc2l6ZSk7Cj4gPiArICAgICBERUZJTkVfRE1BX0JV
Rl9FWFBPUlRfSU5GTyhleHBfaW5mbyk7Cj4gPiArICAgICBzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVm
Owo+ID4gKyAgICAgaW50IHJldCA9IC1FTk9NRU07Cj4gPiArICAgICBwZ29mZl90IHBnOwo+ID4g
Kwo+ID4gKyAgICAgaWYgKGFsaWduID4gQ09ORklHX0NNQV9BTElHTk1FTlQpCj4gPiArICAgICAg
ICAgICAgIGFsaWduID0gQ09ORklHX0NNQV9BTElHTk1FTlQ7Cj4gPiArCj4gPiArICAgICBoZWxw
ZXJfYnVmZmVyID0ga3phbGxvYyhzaXplb2YoKmhlbHBlcl9idWZmZXIpLCBHRlBfS0VSTkVMKTsK
PiA+ICsgICAgIGlmICghaGVscGVyX2J1ZmZlcikKPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1F
Tk9NRU07Cj4gPiArCj4gPiArICAgICBJTklUX0hFQVBfSEVMUEVSX0JVRkZFUihoZWxwZXJfYnVm
ZmVyLCBjbWFfaGVhcF9mcmVlKTsKPiA+ICsgICAgIGhlbHBlcl9idWZmZXItPmhlYXBfYnVmZmVy
LmZsYWdzID0gaGVhcF9mbGFnczsKPiA+ICsgICAgIGhlbHBlcl9idWZmZXItPmhlYXBfYnVmZmVy
LmhlYXAgPSBoZWFwOwo+ID4gKyAgICAgaGVscGVyX2J1ZmZlci0+aGVhcF9idWZmZXIuc2l6ZSA9
IGxlbjsKPiA+ICsKPiA+ICsgICAgIHBhZ2VzID0gY21hX2FsbG9jKGNtYV9oZWFwLT5jbWEsIG5y
X3BhZ2VzLCBhbGlnbiwgZmFsc2UpOwo+ID4gKyAgICAgaWYgKCFwYWdlcykKPiA+ICsgICAgICAg
ICAgICAgZ290byBmcmVlX2J1ZjsKPiA+ICsKPiA+ICsgICAgIGlmIChQYWdlSGlnaE1lbShwYWdl
cykpIHsKPiA+ICsgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBucl9jbGVhcl9wYWdlcyA9IG5y
X3BhZ2VzOwo+ID4gKyAgICAgICAgICAgICBzdHJ1Y3QgcGFnZSAqcGFnZSA9IHBhZ2VzOwo+ID4g
Kwo+ID4gKyAgICAgICAgICAgICB3aGlsZSAobnJfY2xlYXJfcGFnZXMgPiAwKSB7Cj4gPiArICAg
ICAgICAgICAgICAgICAgICAgdm9pZCAqdmFkZHIgPSBrbWFwX2F0b21pYyhwYWdlKTsKPiA+ICsK
PiA+ICsgICAgICAgICAgICAgICAgICAgICBtZW1zZXQodmFkZHIsIDAsIFBBR0VfU0laRSk7Cj4g
PiArICAgICAgICAgICAgICAgICAgICAga3VubWFwX2F0b21pYyh2YWRkcik7Cj4gPiArICAgICAg
ICAgICAgICAgICAgICAgcGFnZSsrOwo+ID4gKyAgICAgICAgICAgICAgICAgICAgIG5yX2NsZWFy
X3BhZ2VzLS07Cj4gPiArICAgICAgICAgICAgIH0KPiA+ICsgICAgIH0gZWxzZSB7Cj4gPiArICAg
ICAgICAgICAgIG1lbXNldChwYWdlX2FkZHJlc3MocGFnZXMpLCAwLCBzaXplKTsKPiA+ICsgICAg
IH0KPiA+ICsKPiA+ICsgICAgIGhlbHBlcl9idWZmZXItPnBhZ2Vjb3VudCA9IG5yX3BhZ2VzOwo+
ID4gKyAgICAgaGVscGVyX2J1ZmZlci0+cGFnZXMgPSBrbWFsbG9jX2FycmF5KGhlbHBlcl9idWZm
ZXItPnBhZ2Vjb3VudCwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzaXplb2YoKmhlbHBlcl9idWZmZXItPnBhZ2VzKSwKPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBHRlBfS0VSTkVMKTsKPiA+ICsgICAgIGlmICghaGVs
cGVyX2J1ZmZlci0+cGFnZXMpIHsKPiA+ICsgICAgICAgICAgICAgcmV0ID0gLUVOT01FTTsKPiA+
ICsgICAgICAgICAgICAgZ290byBmcmVlX2NtYTsKPiA+ICsgICAgIH0KPiA+ICsKPiA+ICsgICAg
IGZvciAocGcgPSAwOyBwZyA8IGhlbHBlcl9idWZmZXItPnBhZ2Vjb3VudDsgcGcrKykgewo+ID4g
KyAgICAgICAgICAgICBoZWxwZXJfYnVmZmVyLT5wYWdlc1twZ10gPSAmcGFnZXNbcGddOwo+ID4g
KyAgICAgICAgICAgICBpZiAoIWhlbHBlcl9idWZmZXItPnBhZ2VzW3BnXSkKPiA+ICsgICAgICAg
ICAgICAgICAgICAgICBnb3RvIGZyZWVfcGFnZXM7Cj4gPiArICAgICB9Cj4gPiArCj4gPiArICAg
ICAvKiBjcmVhdGUgdGhlIGRtYWJ1ZiAqLwo+ID4gKyAgICAgZXhwX2luZm8ub3BzID0gJmhlYXBf
aGVscGVyX29wczsKPiA+ICsgICAgIGV4cF9pbmZvLnNpemUgPSBsZW47Cj4gPiArICAgICBleHBf
aW5mby5mbGFncyA9IGZkX2ZsYWdzOwo+ID4gKyAgICAgZXhwX2luZm8ucHJpdiA9ICZoZWxwZXJf
YnVmZmVyLT5oZWFwX2J1ZmZlcjsKPiA+ICsgICAgIGRtYWJ1ZiA9IGRtYV9idWZfZXhwb3J0KCZl
eHBfaW5mbyk7Cj4gPiArICAgICBpZiAoSVNfRVJSKGRtYWJ1ZikpIHsKPiA+ICsgICAgICAgICAg
ICAgcmV0ID0gUFRSX0VSUihkbWFidWYpOwo+ID4gKyAgICAgICAgICAgICBnb3RvIGZyZWVfcGFn
ZXM7Cj4gPiArICAgICB9Cj4gQ2FuIHRoZSBkbWFidWYgYmUgY3JlYXRlZCBpbiB0aGUgZnJhbWV3
b3JrIGxheWVyPwo+IGVhY2ggaGVhcCBuZWVkcyB0byBhZGQgdGhlIHNhbWUgY29kZSBoZXJlLCB3
aGljaCBpcyBub3QgdmVyeSBnb29kLgoKTm8gdGhhdCB3b3VsZCBtYWtlIGVycm9ycyBjYXNlcyBt
b3JlIGRpZmZpY3VsdCB0byBoYW5kbGUgYmVjYXVzZQp5b3Ugd2lsbCBuZWVkIHRvIGNhbGwgYSBu
ZXcgaGVhcCdzIGZ1bmN0aW9uIHRvIGNsZWFuIGV2ZXJ5dGhpbmcuCgo+Cj4gPiArCj4gPiArICAg
ICBoZWxwZXJfYnVmZmVyLT5oZWFwX2J1ZmZlci5kbWFidWYgPSBkbWFidWY7Cj4gPiArICAgICBo
ZWxwZXJfYnVmZmVyLT5wcml2X3ZpcnQgPSBwYWdlczsKPiA+ICsKPiA+ICsgICAgIHJldCA9IGRt
YV9idWZfZmQoZG1hYnVmLCBmZF9mbGFncyk7Cj4gPiArICAgICBpZiAocmV0IDwgMCkgewo+ID4g
KyAgICAgICAgICAgICBkbWFfYnVmX3B1dChkbWFidWYpOwo+ID4gKyAgICAgICAgICAgICAvKiBq
dXN0IHJldHVybiwgYXMgcHV0IHdpbGwgY2FsbCByZWxlYXNlIGFuZCB0aGF0IHdpbGwgZnJlZSAq
Lwo+ID4gKyAgICAgICAgICAgICByZXR1cm4gcmV0Owo+ID4gKyAgICAgfQo+ID4gKwo+ID4gKyAg
ICAgcmV0dXJuIHJldDsKPiA+ICsKPiA+ICtmcmVlX3BhZ2VzOgo+ID4gKyAgICAga2ZyZWUoaGVs
cGVyX2J1ZmZlci0+cGFnZXMpOwo+ID4gK2ZyZWVfY21hOgo+ID4gKyAgICAgY21hX3JlbGVhc2Uo
Y21hX2hlYXAtPmNtYSwgcGFnZXMsIG5yX3BhZ2VzKTsKPiA+ICtmcmVlX2J1ZjoKPiA+ICsgICAg
IGtmcmVlKGhlbHBlcl9idWZmZXIpOwo+ID4gKyAgICAgcmV0dXJuIHJldDsKPiA+ICt9Cj4gPiAr
Cj4gPiArc3RhdGljIHN0cnVjdCBkbWFfaGVhcF9vcHMgY21hX2hlYXBfb3BzID0gewo+ID4gKyAg
ICAgLmFsbG9jYXRlID0gY21hX2hlYXBfYWxsb2NhdGUsCj4gPiArfTsKPiA+ICsKPiA+ICtzdGF0
aWMgaW50IF9fYWRkX2NtYV9oZWFwKHN0cnVjdCBjbWEgKmNtYSwgdm9pZCAqZGF0YSkKPiA+ICt7
Cj4gPiArICAgICBzdHJ1Y3QgY21hX2hlYXAgKmNtYV9oZWFwOwo+ID4gKyAgICAgc3RydWN0IGRt
YV9oZWFwX2V4cG9ydF9pbmZvIGV4cF9pbmZvOwo+ID4gKwo+ID4gKyAgICAgY21hX2hlYXAgPSBr
emFsbG9jKHNpemVvZigqY21hX2hlYXApLCBHRlBfS0VSTkVMKTsKPiA+ICsgICAgIGlmICghY21h
X2hlYXApCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwo+ID4gKyAgICAgY21hX2hl
YXAtPmNtYSA9IGNtYTsKPiA+ICsKPiA+ICsgICAgIGV4cF9pbmZvLm5hbWUgPSBjbWFfZ2V0X25h
bWUoY21hKTsKPiA+ICsgICAgIGV4cF9pbmZvLm9wcyA9ICZjbWFfaGVhcF9vcHM7Cj4gPiArICAg
ICBleHBfaW5mby5wcml2ID0gY21hX2hlYXA7Cj4gPiArCj4gPiArICAgICBjbWFfaGVhcC0+aGVh
cCA9IGRtYV9oZWFwX2FkZCgmZXhwX2luZm8pOwo+ID4gKyAgICAgaWYgKElTX0VSUihjbWFfaGVh
cC0+aGVhcCkpIHsKPiA+ICsgICAgICAgICAgICAgaW50IHJldCA9IFBUUl9FUlIoY21hX2hlYXAt
PmhlYXApOwo+ID4gKwo+ID4gKyAgICAgICAgICAgICBrZnJlZShjbWFfaGVhcCk7Cj4gPiArICAg
ICAgICAgICAgIHJldHVybiByZXQ7Cj4gPiArICAgICB9Cj4gPiArCj4gPiArICAgICByZXR1cm4g
MDsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBhZGRfY21hX2hlYXBzKHZvaWQpCj4gPiAr
ewo+ID4gKyAgICAgY21hX2Zvcl9lYWNoX2FyZWEoX19hZGRfY21hX2hlYXAsIE5VTEwpOwo+ID4g
KyAgICAgcmV0dXJuIDA7Cj4gPiArfQo+ID4gK2RldmljZV9pbml0Y2FsbChhZGRfY21hX2hlYXBz
KTsKPiA+Cj4KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18K
ZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0
dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
