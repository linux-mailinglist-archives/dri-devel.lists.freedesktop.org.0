Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 21D3DE78DC
	for <lists+dri-devel@lfdr.de>; Mon, 28 Oct 2019 19:59:06 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 97E5A6E9D9;
	Mon, 28 Oct 2019 18:59:02 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from us-smtp-delivery-1.mimecast.com (us-smtp-2.mimecast.com
 [207.211.31.81])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 30F6B6E9D8
 for <dri-devel@lists.freedesktop.org>; Mon, 28 Oct 2019 18:59:01 +0000 (UTC)
Received: from mimecast-mx01.redhat.com (mimecast-mx01.redhat.com
 [209.132.183.4]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-301-_xl_ctdZNqKISptFAVQyFw-1; Mon, 28 Oct 2019 14:58:56 -0400
Received: from smtp.corp.redhat.com (int-mx01.intmail.prod.int.phx2.redhat.com
 [10.5.11.11])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mimecast-mx01.redhat.com (Postfix) with ESMTPS id 372211804971;
 Mon, 28 Oct 2019 18:58:55 +0000 (UTC)
Received: from shalem.localdomain.com (ovpn-116-64.ams2.redhat.com
 [10.36.116.64])
 by smtp.corp.redhat.com (Postfix) with ESMTP id D921F600C9;
 Mon, 28 Oct 2019 18:58:52 +0000 (UTC)
From: Hans de Goede <hdegoede@redhat.com>
To: Jani Nikula <jani.nikula@linux.intel.com>,
 Joonas Lahtinen <joonas.lahtinen@linux.intel.com>,
 Rodrigo Vivi <rodrigo.vivi@intel.com>,
 =?UTF-8?q?Ville=20Syrj=C3=A4l=C3=A4?= <ville.syrjala@linux.intel.com>
Subject: [PATCH] drm/i915: Program LUT before intel_color_commit() if LUT was
 not previously set v2
Date: Mon, 28 Oct 2019 19:58:51 +0100
Message-Id: <20191028185851.592922-1-hdegoede@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.11
X-MC-Unique: _xl_ctdZNqKISptFAVQyFw-1
X-Mimecast-Spam-Score: 0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=redhat.com; 
 s=mimecast20190719; t=1572289140;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding;
 bh=fz76W9C8Cl9WjWLsYHlEKOXb+O7SacamRCvF/FBjWCQ=;
 b=HC2g2TBSVyA3HDziY8VHUN2QZpUF/GmzwuNXRZgLRHumie3hFw0195ykUfdg/Q3tnJDf8g
 BWxntc8tpOQWwPLxBN3HwKprxzdYj5KrAC7ADeI+OoynuDJZgEV3O0/Hl0B9WcQJtTU4Jo
 Wn60t+BLFf04XzDuWMfyf9zabYtWlis=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Hans de Goede <hdegoede@redhat.com>,
 intel-gfx <intel-gfx@lists.freedesktop.org>, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

U2luY2UgY29tbWl0IDA1MWE2ZDhkM2NhMCAoImRybS9pOTE1OiBNb3ZlIExVVCBwcm9ncmFtbWlu
ZyB0byBoYXBwZW4gYWZ0ZXIKdmJsYW5rIHdhaXRzIiksIEkgYW0gc2VlaW5nIGFuIHVnbHkgY29s
b3JlZCBmbGFzaCBvZiB0aGUgZmlyc3QgZmV3IGRpc3BsYXkKbGluZXMgb24gMiBDaGVycnkgVHJh
aWwgZGV2aWNlcyB3aGVuIHRoZSBnYW1tYSB0YWJsZSBnZXRzIHNldCBmb3IgdGhlIGZpcnN0CnRp
bWUuIEEgYmx1ZSBmbGFzaCBvbiBhIEdQRCB3aW4gYW5kIGEgeWVsbG93IGZsYXNoIG9uIGFuIEFz
dXMgVDEwMEhBLgoKVGhlIHByb2JsZW0gaXMgdGhhdCBzaW5jZSB0aGlzIGNoYW5nZSwgdGhlIExV
VCBpcyBwcm9ncmFtbWVkIGFmdGVyIHRoZQp3cml0ZSAqYW5kIGxhdGNoaW5nKiBvZiB0aGUgZG91
YmxlLWJ1ZmZlcmVkIHJlZ2lzdGVyIHdoaWNoIGNhdXNlcyB0aGUgTFVUCnRvIGJlIHVzZWQgc3Rh
cnRpbmcgYXQgdGhlIG5leHQgZnJhbWUuIFRoaXMgbWVhbnMgdGhhdCB0aGUgb2xkIExVVCBpcyBz
dGlsbAp1c2VkIGZvciB0aGUgZmlyc3QgY291cGxlIG9mIGxpbmVzIG9mIHRoZSBkaXNwbGF5LiBJ
ZiBubyBMVVQgd2FzIGluIHVzZQpiZWZvcmUgdGhlbiB0aGUgTFVUIHJlZ2lzdGVycyBtYXkgY29u
dGFpbiBib2d1cyB2YWx1ZXMuIFRoaXMgbGVhZHMgdG8KbWVzc2VkIHVwIGNvbG9ycyB1bnRpbCB0
aGUgbmV3IExVVCB2YWx1ZXMgYXJlIHdyaXR0ZW4uIEF0IGxlYXN0IG9uIENIVCBEU0kKcGFuZWxz
IHRoaXMgY2F1c2VzIG1lc3NlZCB1cCBjb2xvcnMgb24gdGhlIGZpcnN0IGZldyBsaW5lcy4KClRo
aXMgY29tbWl0IGZpeGVzIHRoaXMgYnkgYWRkaW5nIGEgbG9hZF9sdXRfYmVmb3JlX2NvbW1pdCBi
b29sZWFuLAptb2RpZnlpbmcgY29tbWl0X3BpcGVfY29uZmlnKCkgdG8gbG9hZCB0aGUgbHV0cyBl
YXJsaWVyIGlmIHRoaXMgaXMgc2V0LgphbmQgc2V0dGluZyB0aGlzIGZyb20gaW50ZWxfY29sb3Jf
Y2hlY2sgd2hlbiBlbmFibGluZyBnYW1tYSAocmF0aGVyIHRoZW4KdXBkYXRpbmcgYW4gZXhpc3Rp
bmcgZ2FtbWEgdGFibGUpLgoKQ2hhbmdlcyBpbiB2MjoKLVNpbXBseSBjaGVjayBmb3Igc2V0dGlu
ZyBsb2FkX2x1dF9iZWZvcmVfY29tbWl0IHRvOgogaWYgKCFvbGRfY3J0Y19zdGF0ZS0+Z2FtbWFf
ZW5hYmxlICYmIG5ld19jcnRjX3N0YXRlLT5nYW1tYV9lbmFibGUpCgpGaXhlczogMDUxYTZkOGQz
Y2EwICgiZHJtL2k5MTU6IE1vdmUgTFVUIHByb2dyYW1taW5nIHRvIGhhcHBlbiBhZnRlciB2Ymxh
bmsgd2FpdHMiKQpTaWduZWQtb2ZmLWJ5OiBIYW5zIGRlIEdvZWRlIDxoZGVnb2VkZUByZWRoYXQu
Y29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfY29sb3IuYyAgICAg
ICAgIHwgMTQgKysrKysrKysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfZGlzcGxheS5jICAgICAgIHwgIDYgKysrKystCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaCB8ICAzICsrKwogMyBmaWxlcyBjaGFuZ2VkLCAyMiBp
bnNlcnRpb25zKCspLCAxIGRlbGV0aW9uKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9jb2xvci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9jb2xvci5jCmluZGV4IGZhNDRlYjczZDA4OC4uOTU0YTIzMmMxNWQxIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2NvbG9yLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9jb2xvci5jCkBAIC0xMDYzLDYgKzEwNjMs
OCBAQCBpbnRlbF9jb2xvcl9hZGRfYWZmZWN0ZWRfcGxhbmVzKHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpuZXdfY3J0Y19zdGF0ZSkKIAkJaW50ZWxfYXRvbWljX2dldF9vbGRfY3J0Y19zdGF0ZShz
dGF0ZSwgY3J0Yyk7CiAJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZTsKIAorCW5ld19jcnRjX3N0
YXRlLT5sb2FkX2x1dF9iZWZvcmVfY29tbWl0ID0gZmFsc2U7CisKIAlpZiAoIW5ld19jcnRjX3N0
YXRlLT5iYXNlLmFjdGl2ZSB8fAogCSAgICBkcm1fYXRvbWljX2NydGNfbmVlZHNfbW9kZXNldCgm
bmV3X2NydGNfc3RhdGUtPmJhc2UpKQogCQlyZXR1cm4gMDsKQEAgLTEwNzEsNiArMTA3MywxOCBA
QCBpbnRlbF9jb2xvcl9hZGRfYWZmZWN0ZWRfcGxhbmVzKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpuZXdfY3J0Y19zdGF0ZSkKIAkgICAgbmV3X2NydGNfc3RhdGUtPmNzY19lbmFibGUgPT0gb2xk
X2NydGNfc3RhdGUtPmNzY19lbmFibGUpCiAJCXJldHVybiAwOwogCisJLyoKKwkgKiBOb3JtYWxs
eSB3ZSBsb2FkIHRoZSBMVVRzIGFmdGVyIHZibGFuayAvIGFmdGVyIHRoZSBkb3VibGUtYnVmZmVy
CisJICogcmVnaXN0ZXJzIHdyaXR0ZW4gYnkgY29tbWl0IGhhdmUgYmVlbiBsYXRjaGVkLCB0aGlz
IGF2b2lkcyBhCisJICogZ2FtbWEgY2hhbmdlIG1pZC13YXkgdGhlIHNjcmVlbi4gVGhpcyBkb2Vz
IG1lYW4gdGhhdCB0aGUgZmlyc3QKKwkgKiBmZXcgbGluZXMgb2YgdGhlIGRpc3BsYXkgd2lsbCAo
c29tZXRpbWVzKSBzdGlsbCB1c2UgdGhlIG9sZAorCSAqIHRhYmxlLiBUaGlzIGlzIGZpbmUgd2hl
biBjaGFuZ2luZyBhbiBleGlzdGluZyBMVVQsIGJ1dCBpZiB0aGlzCisJICogaXMgdGhlIGZpcnN0
IHRpbWUgdGhlIExVVCBnZXRzIGxvYWRlZCwgdGhlbiB0aGUgaHcgbWF5IGNvbnRhaW4KKwkgKiBy
YW5kb20gdmFsdWVzLCBjYXVzaW5nIHRoZSBmaXJzdCBsaW5lcyB0byBoYXZlIGZ1bmt5IGNvbG9y
cy4KKwkgKi8KKwlpZiAoIW9sZF9jcnRjX3N0YXRlLT5nYW1tYV9lbmFibGUgJiYgbmV3X2NydGNf
c3RhdGUtPmdhbW1hX2VuYWJsZSkKKwkJbmV3X2NydGNfc3RhdGUtPmxvYWRfbHV0X2JlZm9yZV9j
b21taXQgPSB0cnVlOworCiAJZm9yX2VhY2hfaW50ZWxfcGxhbmVfb25fY3J0YygmZGV2X3ByaXYt
PmRybSwgY3J0YywgcGxhbmUpIHsKIAkJc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9z
dGF0ZTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9k
aXNwbGF5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwpp
bmRleCBjYmY5Y2YzMDA1MGMuLjZiMWRjNWE1YWViMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKQEAgLTE0MTY4LDggKzE0MTY4LDExIEBAIHN0YXRp
YyB2b2lkIGNvbW1pdF9waXBlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0
ZSwKIAkgKi8KIAlpZiAoIW1vZGVzZXQpIHsKIAkJaWYgKG5ld19jcnRjX3N0YXRlLT5iYXNlLmNv
bG9yX21nbXRfY2hhbmdlZCB8fAotCQkgICAgbmV3X2NydGNfc3RhdGUtPnVwZGF0ZV9waXBlKQor
CQkgICAgbmV3X2NydGNfc3RhdGUtPnVwZGF0ZV9waXBlKSB7CisJCQlpZiAobmV3X2NydGNfc3Rh
dGUtPmxvYWRfbHV0X2JlZm9yZV9jb21taXQpCisJCQkJaW50ZWxfY29sb3JfbG9hZF9sdXRzKG5l
d19jcnRjX3N0YXRlKTsKIAkJCWludGVsX2NvbG9yX2NvbW1pdChuZXdfY3J0Y19zdGF0ZSk7CisJ
CX0KIAogCQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQogCQkJc2tsX2RldGFjaF9zY2Fs
ZXJzKG5ld19jcnRjX3N0YXRlKTsKQEAgLTE0NzE3LDYgKzE0NzIwLDcgQEAgc3RhdGljIHZvaWQg
aW50ZWxfYXRvbWljX2NvbW1pdF90YWlsKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRl
KQogCWZvcl9lYWNoX25ld19pbnRlbF9jcnRjX2luX3N0YXRlKHN0YXRlLCBjcnRjLCBuZXdfY3J0
Y19zdGF0ZSwgaSkgewogCQlpZiAobmV3X2NydGNfc3RhdGUtPmJhc2UuYWN0aXZlICYmCiAJCSAg
ICAhbmVlZHNfbW9kZXNldChuZXdfY3J0Y19zdGF0ZSkgJiYKKwkJICAgICFuZXdfY3J0Y19zdGF0
ZS0+bG9hZF9sdXRfYmVmb3JlX2NvbW1pdCAmJgogCQkgICAgKG5ld19jcnRjX3N0YXRlLT5iYXNl
LmNvbG9yX21nbXRfY2hhbmdlZCB8fAogCQkgICAgIG5ld19jcnRjX3N0YXRlLT51cGRhdGVfcGlw
ZSkpCiAJCQlpbnRlbF9jb2xvcl9sb2FkX2x1dHMobmV3X2NydGNfc3RhdGUpOwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmggYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaAppbmRleCA0
MDE4NGU4MjNjODQuLjZiY2M5OTdiN2VjYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgKQEAgLTk5MCw2ICs5OTAsOSBAQCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSB7CiAJLyogZW5hYmxlIHBpcGUgY3NjPyAqLwogCWJvb2wgY3Nj
X2VuYWJsZTsKIAorCS8qIGxvYWQgbHV0cyBiZWZvcmUgY29sb3Igc2V0dGluZ3MgY29tbWl0ICov
CisJYm9vbCBsb2FkX2x1dF9iZWZvcmVfY29tbWl0OworCiAJLyogRGlzcGxheSBTdHJlYW0gY29t
cHJlc3Npb24gc3RhdGUgKi8KIAlzdHJ1Y3QgewogCQlib29sIGNvbXByZXNzaW9uX2VuYWJsZTsK
LS0gCjIuMjMuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
Cmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
