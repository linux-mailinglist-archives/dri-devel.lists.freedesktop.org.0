Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 7EA1CF1649
	for <lists+dri-devel@lfdr.de>; Wed,  6 Nov 2019 13:47:39 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A89356E1E8;
	Wed,  6 Nov 2019 12:47:33 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 384206E1E8
 for <dri-devel@lists.freedesktop.org>; Wed,  6 Nov 2019 12:47:32 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id B7C76B364;
 Wed,  6 Nov 2019 12:47:30 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: daniel@ffwll.ch,
	noralf@tronnes.org
Subject: [PATCH v2 2/2] drm/fb-helper: Remove drm_fb_helper_fbdev_{setup,
 teardown}()
Date: Wed,  6 Nov 2019 13:47:27 +0100
Message-Id: <20191106124727.11641-3-tzimmermann@suse.de>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191106124727.11641-1-tzimmermann@suse.de>
References: <20191106124727.11641-1-tzimmermann@suse.de>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Zimmermann <tzimmermann@suse.de>, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

Qm90aCBmdW5jdGlvbnMgYXJlIHVudXNlZCBhbmQgY2FuIGJlIHJlbW92ZWQuIERyaXZlcnMgc2hv
dWxkIHVzZQpkcm1fZmJkZXZfZ2VuZXJpY19zZXR1cCgpIGluc3RlYWQuCgpTaWduZWQtb2ZmLWJ5
OiBUaG9tYXMgWmltbWVybWFubiA8dHppbW1lcm1hbm5Ac3VzZS5kZT4KUmV2aWV3ZWQtYnk6IE5v
cmFsZiBUcsO4bm5lcyA8bm9yYWxmQHRyb25uZXMub3JnPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9k
cm1fZmJfaGVscGVyLmMgfCAxMDkgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIGlu
Y2x1ZGUvZHJtL2RybV9mYl9oZWxwZXIuaCAgICAgfCAgMjUgLS0tLS0tLS0KIDIgZmlsZXMgY2hh
bmdlZCwgMSBpbnNlcnRpb24oKyksIDEzMyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vZHJtX2ZiX2hlbHBlci5jIGIvZHJpdmVycy9ncHUvZHJtL2RybV9mYl9oZWxw
ZXIuYwppbmRleCA4ZWJlY2NkZWVkMjMuLjEwMzhhMmYwNjM5ZSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2RybV9mYl9oZWxwZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX2ZiX2hl
bHBlci5jCkBAIC05NSwxMCArOTUsNiBAQCBzdGF0aWMgREVGSU5FX01VVEVYKGtlcm5lbF9mYl9o
ZWxwZXJfbG9jayk7CiAgKiBJdCB3aWxsIGF1dG9tYXRpY2FsbHkgc2V0IHVwIGRlZmVycmVkIEkv
TyBpZiB0aGUgZHJpdmVyIHJlcXVpcmVzIGEgc2hhZG93CiAgKiBidWZmZXIuCiAgKgotICogRm9y
IG90aGVyIGRyaXZlcnMsIHNldHVwIGZiZGV2IGVtdWxhdGlvbiBieSBjYWxsaW5nCi0gKiBkcm1f
ZmJfaGVscGVyX2ZiZGV2X3NldHVwKCkgYW5kIHRlYXIgaXQgZG93biBieSBjYWxsaW5nCi0gKiBk
cm1fZmJfaGVscGVyX2ZiZGV2X3RlYXJkb3duKCkuCi0gKgogICogQXQgcnVudGltZSBkcml2ZXJz
IHNob3VsZCByZXN0b3JlIHRoZSBmYmRldiBjb25zb2xlIGJ5IHVzaW5nCiAgKiBkcm1fZmJfaGVs
cGVyX2xhc3RjbG9zZSgpIGFzIHRoZWlyICZkcm1fZHJpdmVyLmxhc3RjbG9zZSBjYWxsYmFjay4K
ICAqIFRoZXkgc2hvdWxkIGFsc28gbm90aWZ5IHRoZSBmYiBoZWxwZXIgY29kZSBmcm9tIHVwZGF0
ZXMgdG8gdGhlIG91dHB1dApAQCAtMTkxOSwxMDggKzE5MTUsNiBAQCBpbnQgZHJtX2ZiX2hlbHBl
cl9ob3RwbHVnX2V2ZW50KHN0cnVjdCBkcm1fZmJfaGVscGVyICpmYl9oZWxwZXIpCiB9CiBFWFBP
UlRfU1lNQk9MKGRybV9mYl9oZWxwZXJfaG90cGx1Z19ldmVudCk7CiAKLS8qKgotICogZHJtX2Zi
X2hlbHBlcl9mYmRldl9zZXR1cCgpIC0gU2V0dXAgZmJkZXYgZW11bGF0aW9uCi0gKiBAZGV2OiBE
Uk0gZGV2aWNlCi0gKiBAZmJfaGVscGVyOiBmYmRldiBoZWxwZXIgc3RydWN0dXJlIHRvIHNldCB1
cAotICogQGZ1bmNzOiBmYmRldiBoZWxwZXIgZnVuY3Rpb25zCi0gKiBAcHJlZmVycmVkX2JwcDog
UHJlZmVycmVkIGJpdHMgcGVyIHBpeGVsIGZvciB0aGUgZGV2aWNlLgotICogICAgICAgICAgICAg
ICAgIEBkZXYtPm1vZGVfY29uZmlnLnByZWZlcnJlZF9kZXB0aCBpcyB1c2VkIGlmIHRoaXMgaXMg
emVyby4KLSAqIEBtYXhfY29ubl9jb3VudDogTWF4aW11bSBudW1iZXIgb2YgY29ubmVjdG9ycyAo
bm90IHVzZWQpCi0gKgotICogVGhpcyBmdW5jdGlvbiBzZXRzIHVwIGZiZGV2IGVtdWxhdGlvbiBh
bmQgcmVnaXN0ZXJzIGZiZGV2IGZvciBhY2Nlc3MgYnkKLSAqIHVzZXJzcGFjZS4gSWYgYWxsIGNv
bm5lY3RvcnMgYXJlIGRpc2Nvbm5lY3RlZCwgc2V0dXAgaXMgZGVmZXJyZWQgdG8gdGhlIG5leHQK
LSAqIHRpbWUgZHJtX2ZiX2hlbHBlcl9ob3RwbHVnX2V2ZW50KCkgaXMgY2FsbGVkLgotICogVGhl
IGNhbGxlciBtdXN0IHRvIHByb3ZpZGUgYSAmZHJtX2ZiX2hlbHBlcl9mdW5jcy0+ZmJfcHJvYmUg
Y2FsbGJhY2sKLSAqIGZ1bmN0aW9uLgotICoKLSAqIFVzZSBkcm1fZmJfaGVscGVyX2ZiZGV2X3Rl
YXJkb3duKCkgdG8gZGVzdHJveSB0aGUgZmJkZXYuCi0gKgotICogU2VlIGFsc286IGRybV9mYl9o
ZWxwZXJfaW5pdGlhbF9jb25maWcoKSwgZHJtX2ZiZGV2X2dlbmVyaWNfc2V0dXAoKS4KLSAqCi0g
KiBSZXR1cm5zOgotICogWmVybyBvbiBzdWNjZXNzIG9yIG5lZ2F0aXZlIGVycm9yIGNvZGUgb24g
ZmFpbHVyZS4KLSAqLwotaW50IGRybV9mYl9oZWxwZXJfZmJkZXZfc2V0dXAoc3RydWN0IGRybV9k
ZXZpY2UgKmRldiwKLQkJCSAgICAgIHN0cnVjdCBkcm1fZmJfaGVscGVyICpmYl9oZWxwZXIsCi0J
CQkgICAgICBjb25zdCBzdHJ1Y3QgZHJtX2ZiX2hlbHBlcl9mdW5jcyAqZnVuY3MsCi0JCQkgICAg
ICB1bnNpZ25lZCBpbnQgcHJlZmVycmVkX2JwcCwKLQkJCSAgICAgIHVuc2lnbmVkIGludCBtYXhf
Y29ubl9jb3VudCkKLXsKLQlpbnQgcmV0OwotCi0JaWYgKCFwcmVmZXJyZWRfYnBwKQotCQlwcmVm
ZXJyZWRfYnBwID0gZGV2LT5tb2RlX2NvbmZpZy5wcmVmZXJyZWRfZGVwdGg7Ci0JaWYgKCFwcmVm
ZXJyZWRfYnBwKQotCQlwcmVmZXJyZWRfYnBwID0gMzI7Ci0KLQlkcm1fZmJfaGVscGVyX3ByZXBh
cmUoZGV2LCBmYl9oZWxwZXIsIGZ1bmNzKTsKLQotCXJldCA9IGRybV9mYl9oZWxwZXJfaW5pdChk
ZXYsIGZiX2hlbHBlciwgMCk7Ci0JaWYgKHJldCA8IDApIHsKLQkJRFJNX0RFVl9FUlJPUihkZXYt
PmRldiwgImZiZGV2OiBGYWlsZWQgdG8gaW5pdGlhbGl6ZSAocmV0PSVkKVxuIiwgcmV0KTsKLQkJ
cmV0dXJuIHJldDsKLQl9Ci0KLQlpZiAoIWRybV9kcnZfdXNlc19hdG9taWNfbW9kZXNldChkZXYp
KQotCQlkcm1faGVscGVyX2Rpc2FibGVfdW51c2VkX2Z1bmN0aW9ucyhkZXYpOwotCi0JcmV0ID0g
ZHJtX2ZiX2hlbHBlcl9pbml0aWFsX2NvbmZpZyhmYl9oZWxwZXIsIHByZWZlcnJlZF9icHApOwot
CWlmIChyZXQgPCAwKSB7Ci0JCURSTV9ERVZfRVJST1IoZGV2LT5kZXYsICJmYmRldjogRmFpbGVk
IHRvIHNldCBjb25maWd1cmF0aW9uIChyZXQ9JWQpXG4iLCByZXQpOwotCQlnb3RvIGVycl9kcm1f
ZmJfaGVscGVyX2Zpbmk7Ci0JfQotCi0JcmV0dXJuIDA7Ci0KLWVycl9kcm1fZmJfaGVscGVyX2Zp
bmk6Ci0JZHJtX2ZiX2hlbHBlcl9mYmRldl90ZWFyZG93bihkZXYpOwotCi0JcmV0dXJuIHJldDsK
LX0KLUVYUE9SVF9TWU1CT0woZHJtX2ZiX2hlbHBlcl9mYmRldl9zZXR1cCk7Ci0KLS8qKgotICog
ZHJtX2ZiX2hlbHBlcl9mYmRldl90ZWFyZG93biAtIFRlYXIgZG93biBmYmRldiBlbXVsYXRpb24K
LSAqIEBkZXY6IERSTSBkZXZpY2UKLSAqCi0gKiBUaGlzIGZ1bmN0aW9uIHVucmVnaXN0ZXJzIGZi
ZGV2IGlmIG5vdCBhbHJlYWR5IGRvbmUgYW5kIGNsZWFucyB1cCB0aGUKLSAqIGFzc29jaWF0ZWQg
cmVzb3VyY2VzIGluY2x1ZGluZyB0aGUgJmRybV9mcmFtZWJ1ZmZlci4KLSAqIFRoZSBkcml2ZXIg
aXMgcmVzcG9uc2libGUgZm9yIGZyZWVpbmcgdGhlICZkcm1fZmJfaGVscGVyIHN0cnVjdHVyZSB3
aGljaCBpcwotICogc3RvcmVkIGluICZkcm1fZGV2aWNlLT5mYl9oZWxwZXIuIERvIG5vdGUgdGhh
dCB0aGlzIHBvaW50ZXIgaGFzIGJlZW4gY2xlYXJlZAotICogd2hlbiB0aGlzIGZ1bmN0aW9uIHJl
dHVybnMuCi0gKgotICogSW4gb3JkZXIgdG8gc3VwcG9ydCBkZXZpY2UgcmVtb3ZhbC91bnBsdWcg
d2hpbGUgZmlsZSBoYW5kbGVzIGFyZSBzdGlsbCBvcGVuLAotICogZHJtX2ZiX2hlbHBlcl91bnJl
Z2lzdGVyX2ZiaSgpIHNob3VsZCBiZSBjYWxsZWQgb24gZGV2aWNlIHJlbW92YWwgYW5kCi0gKiBk
cm1fZmJfaGVscGVyX2ZiZGV2X3RlYXJkb3duKCkgaW4gdGhlICZkcm1fZHJpdmVyLT5yZWxlYXNl
IGNhbGxiYWNrIHdoZW4KLSAqIGZpbGUgaGFuZGxlcyBhcmUgY2xvc2VkLgotICovCi12b2lkIGRy
bV9mYl9oZWxwZXJfZmJkZXZfdGVhcmRvd24oc3RydWN0IGRybV9kZXZpY2UgKmRldikKLXsKLQlz
dHJ1Y3QgZHJtX2ZiX2hlbHBlciAqZmJfaGVscGVyID0gZGV2LT5mYl9oZWxwZXI7Ci0Jc3RydWN0
IGZiX29wcyAqZmJvcHMgPSBOVUxMOwotCi0JaWYgKCFmYl9oZWxwZXIpCi0JCXJldHVybjsKLQot
CS8qIFVucmVnaXN0ZXIgaWYgaXQgaGFzbid0IGJlZW4gZG9uZSBhbHJlYWR5ICovCi0JaWYgKGZi
X2hlbHBlci0+ZmJkZXYgJiYgZmJfaGVscGVyLT5mYmRldi0+ZGV2KQotCQlkcm1fZmJfaGVscGVy
X3VucmVnaXN0ZXJfZmJpKGZiX2hlbHBlcik7Ci0KLQlpZiAoZmJfaGVscGVyLT5mYmRldiAmJiBm
Yl9oZWxwZXItPmZiZGV2LT5mYmRlZmlvKSB7Ci0JCWZiX2RlZmVycmVkX2lvX2NsZWFudXAoZmJf
aGVscGVyLT5mYmRldik7Ci0JCWtmcmVlKGZiX2hlbHBlci0+ZmJkZXYtPmZiZGVmaW8pOwotCQlm
Ym9wcyA9IGZiX2hlbHBlci0+ZmJkZXYtPmZib3BzOwotCX0KLQotCWRybV9mYl9oZWxwZXJfZmlu
aShmYl9oZWxwZXIpOwotCWtmcmVlKGZib3BzKTsKLQotCWlmIChmYl9oZWxwZXItPmZiKQotCQlk
cm1fZnJhbWVidWZmZXJfcmVtb3ZlKGZiX2hlbHBlci0+ZmIpOwotfQotRVhQT1JUX1NZTUJPTChk
cm1fZmJfaGVscGVyX2ZiZGV2X3RlYXJkb3duKTsKLQogLyoqCiAgKiBkcm1fZmJfaGVscGVyX2xh
c3RjbG9zZSAtIERSTSBkcml2ZXIgbGFzdGNsb3NlIGhlbHBlciBmb3IgZmJkZXYgZW11bGF0aW9u
CiAgKiBAZGV2OiBEUk0gZGV2aWNlCkBAIC0yMzA5LDggKzIyMDMsNyBAQCBzdGF0aWMgY29uc3Qg
c3RydWN0IGRybV9jbGllbnRfZnVuY3MgZHJtX2ZiZGV2X2NsaWVudF9mdW5jcyA9IHsKICAqICAg
ICAgICAgICAgICAgICBAZGV2LT5tb2RlX2NvbmZpZy5wcmVmZXJyZWRfZGVwdGggaXMgdXNlZCBp
ZiB0aGlzIGlzIHplcm8uCiAgKgogICogVGhpcyBmdW5jdGlvbiBzZXRzIHVwIGdlbmVyaWMgZmJk
ZXYgZW11bGF0aW9uIGZvciBkcml2ZXJzIHRoYXQgc3VwcG9ydHMKLSAqIGR1bWIgYnVmZmVycyB3
aXRoIGEgdmlydHVhbCBhZGRyZXNzIGFuZCB0aGF0IGNhbiBiZSBtbWFwJ2VkLiBJZiB0aGUgZHJp
dmVyCi0gKiBkb2VzIG5vdCBzdXBwb3J0IHRoZXNlIGZ1bmN0aW9ucywgaXQgY291bGQgdXNlIGRy
bV9mYl9oZWxwZXJfZmJkZXZfc2V0dXAoKS4KKyAqIGR1bWIgYnVmZmVycyB3aXRoIGEgdmlydHVh
bCBhZGRyZXNzIGFuZCB0aGF0IGNhbiBiZSBtbWFwJ2VkLgogICoKICAqIFJlc3RvcmUsIGhvdHBs
dWcgZXZlbnRzIGFuZCB0ZWFyZG93biBhcmUgYWxsIHRha2VuIGNhcmUgb2YuIERyaXZlcnMgdGhh
dCBkbwogICogc3VzcGVuZC9yZXN1bWUgbmVlZCB0byBjYWxsIGRybV9mYl9oZWxwZXJfc2V0X3N1
c3BlbmRfdW5sb2NrZWQoKSB0aGVtc2VsdmVzLgpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0vZHJt
X2ZiX2hlbHBlci5oIGIvaW5jbHVkZS9kcm0vZHJtX2ZiX2hlbHBlci5oCmluZGV4IDIzMzhlOWY5
NGEwMy4uZTNhNzVmZjA3MzkwIDEwMDY0NAotLS0gYS9pbmNsdWRlL2RybS9kcm1fZmJfaGVscGVy
LmgKKysrIGIvaW5jbHVkZS9kcm0vZHJtX2ZiX2hlbHBlci5oCkBAIC0yNjksMTMgKzI2OSw2IEBA
IGludCBkcm1fZmJfaGVscGVyX2luaXRpYWxfY29uZmlnKHN0cnVjdCBkcm1fZmJfaGVscGVyICpm
Yl9oZWxwZXIsIGludCBicHBfc2VsKTsKIGludCBkcm1fZmJfaGVscGVyX2RlYnVnX2VudGVyKHN0
cnVjdCBmYl9pbmZvICppbmZvKTsKIGludCBkcm1fZmJfaGVscGVyX2RlYnVnX2xlYXZlKHN0cnVj
dCBmYl9pbmZvICppbmZvKTsKIAotaW50IGRybV9mYl9oZWxwZXJfZmJkZXZfc2V0dXAoc3RydWN0
IGRybV9kZXZpY2UgKmRldiwKLQkJCSAgICAgIHN0cnVjdCBkcm1fZmJfaGVscGVyICpmYl9oZWxw
ZXIsCi0JCQkgICAgICBjb25zdCBzdHJ1Y3QgZHJtX2ZiX2hlbHBlcl9mdW5jcyAqZnVuY3MsCi0J
CQkgICAgICB1bnNpZ25lZCBpbnQgcHJlZmVycmVkX2JwcCwKLQkJCSAgICAgIHVuc2lnbmVkIGlu
dCBtYXhfY29ubl9jb3VudCk7Ci12b2lkIGRybV9mYl9oZWxwZXJfZmJkZXZfdGVhcmRvd24oc3Ry
dWN0IGRybV9kZXZpY2UgKmRldik7Ci0KIHZvaWQgZHJtX2ZiX2hlbHBlcl9sYXN0Y2xvc2Uoc3Ry
dWN0IGRybV9kZXZpY2UgKmRldik7CiB2b2lkIGRybV9mYl9oZWxwZXJfb3V0cHV0X3BvbGxfY2hh
bmdlZChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KTsKIApAQCAtNDUyLDI0ICs0NDUsNiBAQCBzdGF0
aWMgaW5saW5lIGludCBkcm1fZmJfaGVscGVyX2RlYnVnX2xlYXZlKHN0cnVjdCBmYl9pbmZvICpp
bmZvKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW5saW5lIGludAotZHJtX2ZiX2hlbHBlcl9m
YmRldl9zZXR1cChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAotCQkJICBzdHJ1Y3QgZHJtX2ZiX2hl
bHBlciAqZmJfaGVscGVyLAotCQkJICBjb25zdCBzdHJ1Y3QgZHJtX2ZiX2hlbHBlcl9mdW5jcyAq
ZnVuY3MsCi0JCQkgIHVuc2lnbmVkIGludCBwcmVmZXJyZWRfYnBwLAotCQkJICB1bnNpZ25lZCBp
bnQgbWF4X2Nvbm5fY291bnQpCi17Ci0JLyogU28gZHJpdmVycyBjYW4gdXNlIGl0IHRvIGZyZWUg
dGhlIHN0cnVjdCAqLwotCWRldi0+ZmJfaGVscGVyID0gZmJfaGVscGVyOwotCi0JcmV0dXJuIDA7
Ci19Ci0KLXN0YXRpYyBpbmxpbmUgdm9pZCBkcm1fZmJfaGVscGVyX2ZiZGV2X3RlYXJkb3duKHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYpCi17Ci0JZGV2LT5mYl9oZWxwZXIgPSBOVUxMOwotfQotCiBz
dGF0aWMgaW5saW5lIHZvaWQgZHJtX2ZiX2hlbHBlcl9sYXN0Y2xvc2Uoc3RydWN0IGRybV9kZXZp
Y2UgKmRldikKIHsKIH0KLS0gCjIuMjMuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlz
dGluZm8vZHJpLWRldmVs
