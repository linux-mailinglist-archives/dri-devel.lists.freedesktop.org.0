Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id F1F7D240CCF
	for <lists+dri-devel@lfdr.de>; Mon, 10 Aug 2020 20:16:07 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8BD0789DA5;
	Mon, 10 Aug 2020 18:16:03 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from asavdk3.altibox.net (asavdk3.altibox.net [109.247.116.14])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 66DBE89D84
 for <dri-devel@lists.freedesktop.org>; Mon, 10 Aug 2020 18:16:01 +0000 (UTC)
Received: from ravnborg.org (unknown [188.228.123.71])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested)
 by asavdk3.altibox.net (Postfix) with ESMTPS id 9020B20023;
 Mon, 10 Aug 2020 20:15:55 +0200 (CEST)
Date: Mon, 10 Aug 2020 20:15:54 +0200
From: Sam Ravnborg <sam@ravnborg.org>
To: allen <allen.chen@ite.com.tw>
Subject: Re: [PATCH v10] drm/bridge: add it6505 driver
Message-ID: <20200810181554.GE292825@ravnborg.org>
References: <1594892860-6569-1-git-send-email-allen.chen@ite.com.tw>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <1594892860-6569-1-git-send-email-allen.chen@ite.com.tw>
X-CMAE-Score: 0
X-CMAE-Analysis: v=2.3 cv=f+hm+t6M c=1 sm=1 tr=0
 a=S6zTFyMACwkrwXSdXUNehg==:117 a=S6zTFyMACwkrwXSdXUNehg==:17
 a=IkcTkHD0fZMA:10 a=mpaa-ttXAAAA:8 a=cm27Pg_UAAAA:8 a=1XWaLZrsAAAA:8
 a=Ns9eNvu6AAAA:8 a=e5mUnYsNAAAA:8 a=L8YDfXaSqtconZh9qGgA:9
 a=6YHz0X6AXIijI_lZ:21 a=OhsBIkaczIQ1SNPw:21 a=QEXdDO2ut3YA:10
 a=6heAxKwa5pAsJatQ0mat:22 a=xmb-EsYY8bH0VWELuYED:22
 a=LZLx1i01EnjtqRv10NxV:22 a=Vxmtnl_E_bksehYqCbjh:22
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Jernej Skrabec <jernej.skrabec@siol.net>,
 Jitao Shi <jitao.shi@mediatek.com>, Neil Armstrong <narmstrong@baylibre.com>,
 Yilun Lin <yllin@google.com>, Jau-Chih Tseng <Jau-Chih.Tseng@ite.com.tw>,
 open list <linux-kernel@vger.kernel.org>,
 "open list:DRM DRIVERS" <dri-devel@lists.freedesktop.org>,
 Andrzej Hajda <a.hajda@samsung.com>, David Airlie <airlied@linux.ie>,
 Hermes Wu <hermes.wu@ite.com.tw>,
 "moderated list:ARM/Mediatek SoC support" <linux-mediatek@lists.infradead.org>,
 Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
 Pi-Hsun Shih <pihsun@chromium.org>, Matthias Brugger <matthias.bgg@gmail.com>,
 "moderated list:ARM/Mediatek SoC support"
 <linux-arm-kernel@lists.infradead.org>, Jonas Karlman <jonas@kwiboo.se>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SGkgYWxsZW4uCgpPbiBUaHUsIEp1bCAxNiwgMjAyMCBhdCAwNTo0NzozMVBNICswODAwLCBhbGxl
biB3cm90ZToKPiBUaGlzIGFkZHMgc3VwcG9ydCBmb3IgdGhlIGlURSBJVDY1MDUuCj4gVGhpcyBk
ZXZpY2UgY2FuIGNvbnZlcnQgRFBJIHNpZ25hbCB0byBEUCBvdXRwdXQuCj4gCj4gU2lnbmVkLW9m
Zi1ieTogSml0YW8gU2hpIDxqaXRhby5zaGlAbWVkaWF0ZWsuY29tPgo+IFNpZ25lZC1vZmYtYnk6
IFBpLUhzdW4gU2hpaCA8cGloc3VuQGNocm9taXVtLm9yZz4KPiBTaWduZWQtb2ZmLWJ5OiBZaWx1
biBMaW4gPHlsbGluQGdvb2dsZS5jb20+Cj4gU2lnbmVkLW9mZi1ieTogSGVybWVzIFd1IDxoZXJt
ZXMud3VAaXRlLmNvbS50dz4KPiBTaWduZWQtb2ZmLWJ5OiBBbGxlbiBDaGVuIDxhbGxlbi5jaGVu
QGl0ZS5jb20udHc+Cj4gLS0tCkNhbiB5b3UgcGxlYXNlIGFkZCBhIEZyb206IGxpbmUgc28gaXQg
aXMgcG9zc2libGUgZm9yIHRoZSB0b29scyB0byBwaWNrCndobyBpcyB0aGUgYXV0aG9yLgpSaWdo
dCBub3cgeW91IGFyZSBwaWNrZWQgLSB3aGljaCBtYXkgb3IgbWF5IG5vdCBiZSBPSy4KCgpJIHRy
aWVkIHRvIGFwcGx5IHRoZSBwYXRjaCAtIGJ1dCB0aGVyZSBpcyBhIGZldyB0aGluZ3MgdG8gbG9v
ayBhdDoKCkkgZ290IHRoaXMgd2l0aCBvbmUgb2YgbXkgY29uZmlncyAoYWxseWVzIG9yIGFsbG1v
ZGNvbmZpZ3MpOgogQ0MgW01dICBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2l0ZS1pdDY1MDUubwov
aG9tZS9zYW0vZHJtL2xpbnV4LmdpdC9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2l0ZS1pdDY1MDUu
YzoyNTg5OjEyOiB3YXJuaW5nOiDigJhpdDY1MDVfYnJpZGdlX3N1c3BlbmTigJkgZGVmaW5lZCBi
dXQgbm90IHVzZWQgWy1XdW51c2VkLWZ1bmN0aW9uXQogMjU4OSB8IHN0YXRpYyBpbnQgaXQ2NTA1
X2JyaWRnZV9zdXNwZW5kKHN0cnVjdCBkZXZpY2UgKmRldikKICAgICAgfCAgICAgICAgICAgIF5+
fn5+fn5+fn5+fn5+fn5+fn5+fgovaG9tZS9zYW0vZHJtL2xpbnV4LmdpdC9kcml2ZXJzL2dwdS9k
cm0vYnJpZGdlL2l0ZS1pdDY1MDUuYzoyNTgyOjEyOiB3YXJuaW5nOiDigJhpdDY1MDVfYnJpZGdl
X3Jlc3VtZeKAmSBkZWZpbmVkIGJ1dCBub3QgdXNlZCBbLVd1bnVzZWQtZnVuY3Rpb25dCiAyNTgy
IHwgc3RhdGljIGludCBpdDY1MDVfYnJpZGdlX3Jlc3VtZShzdHJ1Y3QgZGV2aWNlICpkZXYpCiAg
ICAgIHwgICAgICAgICAgICBefn5+fn5+fn5+fn5+fn5+fn5+fgoKUGxlYXNlIGZpeC4KCgpQbGVh
c2UgdHJ5IHRvIHJ1biBpdCB0aHJvdWdoIGNoZWNrcGF0Y2ggd2l0aCB0aGUgZm9sbG93aW5nIG9w
dGlvbnM6Ci4vc2NyaXB0cy9jaGVja3BhdGNoIC1xIC0tZW1hY3MgLS1zdHJpY3QgLS1zaG93LXR5
cGVzIC0tY29kZXNwZWxsCgpEcm9wIGNvZGVzcGVsbCBpZiBpdCBkb2VzIG5vdCB3b3JrIGZvciB5
b3UuCgpDb2Rlc3BlbGwgZGlkIG5vdCBsaWtlIGFmZSAtIHNlZW1zIHRoYXQgaXQgZG9lcyBub3Qg
a25vdyB0aGlzIGlzIGEKc2hvcnRoYW5kIGZvciAiYW5hbG9nIGZyb250IGVuZCIuIFRoaXMgaXMg
b25lIG9mIHRoZSB3YXJuaW5ncyB0byBpZ25vcmUuCgpUaGVyZSBhcmUgc2V2ZXJhbCB2YWxpZCB3
YXJuaW5ncyB0aGF0IG5lZWRzIGZpeGluZy4gRm9yIGV4YW1wbGUgaW5kZW50LgoKClRoZSBkcml2
ZXIgbmVlZHMgdG8gc3VwcG9ydCAiZmxhZ3MiIGluIGF0dGFjaCB0byBtYWtlIGNvbm5lY3RvciBj
cmVhdGlvbgpvcHRpb25hbCAtIHN1cHBvcnQgZm9yIHRoaXMgaXMgbWFuZGF0b3J5IGluIG5ldyBk
cml2ZXJzLgoKVGhlIGRyaXZlciBhbHNvIG5lZWRzIHRvIHN1cHBvcnQgcmVsZXZhbnQgYnJpZGdl
IG9wZXJhdGlvbnMuCgkuZ2V0X2VkaWQKCS5kZXRlY3QKCm5lZWRzIHRvIGJlIHN1cHBvcnRlZCwg
bWF5YmUgbW9yZS4KClNlZSBvdGhlciBicmlkZ2UgZHJpdmVycyAtIG1vc3Qgb2YgdGhlbSBhcmUg
Y29udmVydGVkIHRvZGF5LgoKClBsZWFzZSBmaXggc28gd2UgY2FuIGdldCB0aGlzIGRyaXZlciBh
cHBsaWVkLgoKCVNhbQoKCgo+ICBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL0tjb25maWcgICAgICB8
ICAgIDcgKwo+ICBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL01ha2VmaWxlICAgICB8ICAgIDEgKwo+
ICBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2l0ZS1pdDY1MDUuYyB8IDI4OTAgKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysKPiAgMyBmaWxlcyBjaGFuZ2VkLCAyODk4IGluc2VydGlv
bnMoKykKPiAgY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9icmlkZ2UvaXRlLWl0
NjUwNS5jCj4gCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvS2NvbmZpZyBi
L2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvS2NvbmZpZwo+IGluZGV4IDQzMjcxYzIuLjU5NzUwYjgg
MTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9LY29uZmlnCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2JyaWRnZS9LY29uZmlnCj4gQEAgLTU3LDYgKzU3LDEzIEBAIGNvbmZpZyBE
Uk1fTFZEU19DT0RFQwo+ICAJICBTdXBwb3J0IGZvciB0cmFuc3BhcmVudCBMVkRTIGVuY29kZXJz
IGFuZCBkZWNvZGVycyB0aGF0IGRvbid0Cj4gIAkgIHJlcXVpcmUgYW55IGNvbmZpZ3VyYXRpb24u
Cj4gIAo+ICtjb25maWcgRFJNX0lURV9JVDY1MDUKPiArCXRyaXN0YXRlICJJVEUgSVQ2NTA1IERQ
IGJyaWRnZSIKPiArCWRlcGVuZHMgb24gT0YKPiArCXNlbGVjdCBEUk1fS01TX0hFTFBFUgo+ICsJ
aGVscAo+ICsJICBJVEUgSVQ2NTA1IERQIGJyaWRnZSBjaGlwIGRyaXZlci4KPiArCj4gIGNvbmZp
ZyBEUk1fTUVHQUNISVBTX1NURFBYWFhYX0dFX0I4NTBWM19GVwo+ICAJdHJpc3RhdGUgIk1lZ2FD
aGlwcyBzdGRwNDAyOC1nZS1iODUwdjMtZncgYW5kIHN0ZHAyNjkwLWdlLWI4NTB2My1mdyIKPiAg
CWRlcGVuZHMgb24gT0YKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9NYWtl
ZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvTWFrZWZpbGUKPiBpbmRleCBkNjNkNGI3Li44
NjYxOWM3IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvTWFrZWZpbGUKPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL01ha2VmaWxlCj4gQEAgLTMsNiArMyw3IEBAIG9i
ai0kKENPTkZJR19EUk1fQ0ROU19EU0kpICs9IGNkbnMtZHNpLm8KPiAgb2JqLSQoQ09ORklHX0RS
TV9DSFJPTlRFTF9DSDcwMzMpICs9IGNocm9udGVsLWNoNzAzMy5vCj4gIG9iai0kKENPTkZJR19E
Uk1fRElTUExBWV9DT05ORUNUT1IpICs9IGRpc3BsYXktY29ubmVjdG9yLm8KPiAgb2JqLSQoQ09O
RklHX0RSTV9MVkRTX0NPREVDKSArPSBsdmRzLWNvZGVjLm8KPiArb2JqLSQoQ09ORklHX0RSTV9J
VEVfSVQ2NTA1KSArPSBpdGUtaXQ2NTA1Lm8KPiAgb2JqLSQoQ09ORklHX0RSTV9NRUdBQ0hJUFNf
U1REUFhYWFhfR0VfQjg1MFYzX0ZXKSArPSBtZWdhY2hpcHMtc3RkcHh4eHgtZ2UtYjg1MHYzLWZ3
Lm8KPiAgb2JqLSQoQ09ORklHX0RSTV9OWFBfUFROMzQ2MCkgKz0gbnhwLXB0bjM0NjAubwo+ICBv
YmotJChDT05GSUdfRFJNX1BBUkFERV9QUzg2MjIpICs9IHBhcmFkZS1wczg2MjIubwo+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2l0ZS1pdDY1MDUuYyBiL2RyaXZlcnMvZ3B1
L2RybS9icmlkZ2UvaXRlLWl0NjUwNS5jCj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRleCAw
MDAwMDAwMC4uMTJhNTZjZAo+IC0tLSAvZGV2L251bGwKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0v
YnJpZGdlL2l0ZS1pdDY1MDUuYwo+IEBAIC0wLDAgKzEsMjg5MCBAQAo+ICsvLyBTUERYLUxpY2Vu
c2UtSWRlbnRpZmllcjogKEdQTC0yLjAtb25seSBPUiBCU0QtMi1DbGF1c2UpCj4gKy8qCj4gKyAq
IENvcHlyaWdodCAoYykgMjAyMCwgVGhlIExpbnV4IEZvdW5kYXRpb24uIEFsbCByaWdodHMgcmVz
ZXJ2ZWQuCj4gKyAqLwo+ICsjaW5jbHVkZSA8bGludXgvYml0cy5oPgo+ICsjaW5jbHVkZSA8bGlu
dXgvZGVsYXkuaD4KPiArI2luY2x1ZGUgPGxpbnV4L2RldmljZS5oPgo+ICsjaW5jbHVkZSA8bGlu
dXgvZXJyLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9leHRjb24uaD4KPiArI2luY2x1ZGUgPGxpbnV4
L2ZzLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9ncGlvL2NvbnN1bWVyLmg+Cj4gKyNpbmNsdWRlIDxs
aW51eC9pMmMuaD4KPiArI2luY2x1ZGUgPGxpbnV4L2ludGVycnVwdC5oPgo+ICsjaW5jbHVkZSA8
bGludXgva2VybmVsLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KPiArI2luY2x1ZGUg
PGxpbnV4L3BtX3J1bnRpbWUuaD4KPiArI2luY2x1ZGUgPGxpbnV4L3JlZ21hcC5oPgo+ICsjaW5j
bHVkZSA8bGludXgvcmVndWxhdG9yL2NvbnN1bWVyLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC90eXBl
cy5oPgo+ICsjaW5jbHVkZSA8bGludXgvd2FpdC5oPgo+ICsKPiArI2luY2x1ZGUgPGNyeXB0by9o
YXNoLmg+Cj4gKyNpbmNsdWRlIDxjcnlwdG8vc2hhLmg+Cj4gKwo+ICsjaW5jbHVkZSA8ZHJtL2Ry
bV9hdG9taWNfaGVscGVyLmg+Cj4gKyNpbmNsdWRlIDxkcm0vZHJtX2JyaWRnZS5oPgo+ICsjaW5j
bHVkZSA8ZHJtL2RybV9jcnRjLmg+Cj4gKyNpbmNsdWRlIDxkcm0vZHJtX2NydGNfaGVscGVyLmg+
Cj4gKyNpbmNsdWRlIDxkcm0vZHJtX2RwX2hlbHBlci5oPgo+ICsjaW5jbHVkZSA8ZHJtL2RybV9l
ZGlkLmg+Cj4gKyNpbmNsdWRlIDxkcm0vZHJtX3ByaW50Lmg+Cj4gKyNpbmNsdWRlIDxkcm0vZHJt
X3Byb2JlX2hlbHBlci5oPgo+ICsKPiArI2luY2x1ZGUgPHNvdW5kL2hkbWktY29kZWMuaD4KPiAr
Cj4gKyNkZWZpbmUgUkVHX0lDX1ZFUiAweDA0Cj4gKwo+ICsjZGVmaW5lIFJFR19SRVNFVF9DVFJM
IDB4MDUKPiArI2RlZmluZSBWSURFT19SRVNFVCBCSVQoMCkKPiArI2RlZmluZSBBVURJT19SRVNF
VCBCSVQoMSkKPiArI2RlZmluZSBBTExfTE9HSUNfUkVTRVQgQklUKDIpCj4gKyNkZWZpbmUgQVVY
X1JFU0VUIEJJVCgzKQo+ICsjZGVmaW5lIEhEQ1BfUkVTRVQgQklUKDQpCj4gKwo+ICsjZGVmaW5l
IElOVF9TVEFUVVNfMDEgMHgwNgo+ICsjZGVmaW5lIElOVF9NQVNLXzAxIDB4MDkKPiArI2RlZmlu
ZSBJTlRfSFBEX0NIQU5HRSBCSVQoMCkKPiArI2RlZmluZSBJTlRfUkVDRUlWRV9IUERfSVJRIEJJ
VCgxKQo+ICsjZGVmaW5lIElOVF9TQ0RUX0NIQU5HRSBCSVQoMikKPiArCj4gKyNkZWZpbmUgSU5U
X1NUQVRVU18wMiAweDA3Cj4gKyNkZWZpbmUgSU5UX01BU0tfMDIgMHgwQQo+ICsjZGVmaW5lIElO
VF9BVVhfQ01EX0ZBSUwgQklUKDApCj4gKyNkZWZpbmUgSU5UX0FVRElPX0ZJRk9fRVJST1IgQklU
KDIpCj4gKwo+ICsjZGVmaW5lIElOVF9TVEFUVVNfMDMgMHgwOAo+ICsjZGVmaW5lIElOVF9NQVNL
XzAzIDB4MEIKPiArI2RlZmluZSBJTlRfTElOS19UUkFJTl9GQUlMIEJJVCg0KQo+ICsjZGVmaW5l
IElOVF9WSURfRklGT19FUlJPUiBCSVQoNSkKPiArI2RlZmluZSBJTlRfSU9fTEFUQ0hfRklGT19P
VkVSRkxPVyBCSVQoNykKPiArCj4gKyNkZWZpbmUgUkVHX1NZU1RFTV9TVFMgMHgwRAo+ICsjZGVm
aW5lIElOVF9TVFMgQklUKDApCj4gKyNkZWZpbmUgSFBEX1NUUyBCSVQoMSkKPiArI2RlZmluZSBW
SURFT19TVEIgQklUKDIpCj4gKwo+ICsjZGVmaW5lIFJFR19MSU5LX1RSQUlOX1NUUyAweDBFCj4g
KyNkZWZpbmUgTElOS19TVEFURV9DUiBCSVQoMikKPiArI2RlZmluZSBMSU5LX1NUQVRFX0VRIEJJ
VCgzKQo+ICsjZGVmaW5lIExJTktfU1RBVEVfTk9SUCBCSVQoNCkKPiArCj4gKyNkZWZpbmUgUkVH
X0JBTktfU0VMIDB4MEYKPiArI2RlZmluZSBSRUdfQ0xLX0NUUkwwIDB4MTAKPiArI2RlZmluZSBN
X1BDTEtfREVMQVkgMHgwMwo+ICsKPiArI2RlZmluZSBSRUdfQVVYX09QVCAweDExCj4gKyNkZWZp
bmUgQVVYX0FVVE9fUlNUIEJJVCgwKQo+ICsjZGVmaW5lIEFVWF9GSVhfRlJFUSBCSVQoMykKPiAr
Cj4gKyNkZWZpbmUgUkVHX0RBVEFfQ1RSTDAgMHgxMgo+ICsjZGVmaW5lIFZJREVPX0xBVENIX0VE
R0UgQklUKDQpCj4gKyNkZWZpbmUgRU5BQkxFX1BDTEtfQ09VTlRFUiBCSVQoNykKPiArCj4gKyNk
ZWZpbmUgUkVHX1BDTEtfQ09VTlRFUl9WQUxVRSAweDEzCj4gKwo+ICsjZGVmaW5lIFJFR181MDFf
RklGT19DVFJMIDB4MTUKPiArI2RlZmluZSBSU1RfNTAxX0ZJRk8gQklUKDEpCj4gKwo+ICsjZGVm
aW5lIFJFR19UUkFJTl9DVFJMMCAweDE2Cj4gKyNkZWZpbmUgRk9SQ0VfTEJSIEJJVCgwKQo+ICsj
ZGVmaW5lIExBTkVfQ09VTlRfTUFTSyAweDA2Cj4gKyNkZWZpbmUgTEFORV9TV0FQIEJJVCgzKQo+
ICsjZGVmaW5lIFNQUkVBRF9BTVBfNSBCSVQoNCkKPiArI2RlZmluZSBGT1JDRV9DUl9ET05FIEJJ
VCg1KQo+ICsjZGVmaW5lIEZPUkNFX0VRX0RPTkUgQklUKDYpCj4gKwo+ICsjZGVmaW5lIFJFR19U
UkFJTl9DVFJMMSAweDE3Cj4gKyNkZWZpbmUgQVVUT19UUkFJTiBCSVQoMCkKPiArI2RlZmluZSBN
QU5VQUxfVFJBSU4gQklUKDEpCj4gKyNkZWZpbmUgRk9SQ0VfUkVUUkFJTiBCSVQoMikKPiArCj4g
KyNkZWZpbmUgUkVHX0FVWF9DVFJMIDB4MjMKPiArI2RlZmluZSBDTFJfRURJRF9GSUZPIEJJVCgw
KQo+ICsjZGVmaW5lIEFVWF9VU0VSX01PREUgQklUKDEpCj4gKyNkZWZpbmUgQVVYX05PX1NFR01F
TlRfV1IgQklUKDYpCj4gKyNkZWZpbmUgQVVYX0VOX0ZJRk9fUkVBRCBCSVQoNykKPiArCj4gKyNk
ZWZpbmUgUkVHX0FVWF9BRFJfMF83IDB4MjQKPiArI2RlZmluZSBSRUdfQVVYX0FEUl84XzE1IDB4
MjUKPiArI2RlZmluZSBSRUdfQVVYX0FEUl8xNl8xOSAweDI2Cj4gKyNkZWZpbmUgUkVHX0FVWF9P
VVRfREFUQTAgMHgyNwo+ICsKPiArI2RlZmluZSBSRUdfQVVYX0NNRF9SRVEgMHgyQgo+ICsjZGVm
aW5lIEFVWF9CVVNZIEJJVCg1KQo+ICsKPiArI2RlZmluZSBSRUdfQVVYX0RBVEFfMF83IDB4MkMK
PiArI2RlZmluZSBSRUdfQVVYX0RBVEFfOF8xNSAweDJECj4gKyNkZWZpbmUgUkVHX0FVWF9EQVRB
XzE2XzIzIDB4MkUKPiArI2RlZmluZSBSRUdfQVVYX0RBVEFfMjRfMzEgMHgyRgo+ICsKPiArI2Rl
ZmluZSBSRUdfQVVYX0RBVEFfRklGTyAweDJGCj4gKwo+ICsjZGVmaW5lIFJFR19BVVhfRVJST1Jf
U1RTIDB4OUYKPiArI2RlZmluZSBNX0FVWF9SRVFfRkFJTCAweDAzCj4gKwo+ICsjZGVmaW5lIFJF
R19IRENQX0NUUkwxIDB4MzgKPiArI2RlZmluZSBIRENQX0NQX0VOQUJMRSBCSVQoMCkKPiArCj4g
KyNkZWZpbmUgUkVHX0hEQ1BfQ1RSTDIgMHgzQQo+ICsjZGVmaW5lIEhEQ1BfQU5fU0VMIEJJVCgw
KQo+ICsjZGVmaW5lIEhEQ1BfSFdfSFBESVJRX0FDVCBCSVQoMikKPiArCj4gKyNkZWZpbmUgUkVH
X00wXzBfNyAweDRDCj4gKyNkZWZpbmUgUkVHX0FOXzBfNyAweDRDCj4gKyNkZWZpbmUgUkVHX1NQ
X0NUUkwwIDB4NTgKPiArI2RlZmluZSBSRUdfSVBfQ1RSTDEgMHg1OQo+ICsjZGVmaW5lIFJFR19J
UF9DVFJMMiAweDVBCj4gKwo+ICsjZGVmaW5lIFJFR19MSU5LX0RSViAweDVDCj4gKyNkZWZpbmUg
RFJWX0hTIEJJVCgxKQo+ICsKPiArI2RlZmluZSBSRUdfRFJWX0xOX0RBVEFfU0VMIDB4NUQKPiAr
Cj4gKyNkZWZpbmUgUkVHX0FVWCAweDVFCj4gKwo+ICsjZGVmaW5lIFJFR19WSURfQlVTX0NUUkww
IDB4NjAKPiArI2RlZmluZSBJTl9ERFIgQklUKDIpCj4gKyNkZWZpbmUgRERSX0NEICgweDAxIDw8
IDYpCj4gKwo+ICsjZGVmaW5lIFJFR19WSURfQlVTX0NUUkwxIDB4NjEKPiArI2RlZmluZSBUWF9G
SUZPX1JFU0VUIEJJVCgxKQo+ICsKPiArI2RlZmluZSBSRUdfSU5QVVRfQ1RSTCAweEEwCj4gKyNk
ZWZpbmUgSU5QVVRfSFNZTkNfUE9MIEJJVCgwKQo+ICsjZGVmaW5lIElOUFVUX1ZTWU5DX1BPTCBC
SVQoMikKPiArI2RlZmluZSBJTlBVVF9JTlRFUkxBQ0VEIEJJVCg0KQo+ICsKPiArI2RlZmluZSBS
RUdfSU5QVVRfSFRPVEFMIDB4QTEKPiArI2RlZmluZSBSRUdfSU5QVVRfSEFDVElWRV9TVEFSVCAw
eEEzCj4gKyNkZWZpbmUgUkVHX0lOUFVUX0hBQ1RJVkVfV0lEVEggMHhBNQo+ICsjZGVmaW5lIFJF
R19JTlBVVF9IRlJPTlRfUE9SQ0ggMHhBNwo+ICsjZGVmaW5lIFJFR19JTlBVVF9IU1lOQ19XSURU
SCAweEE5Cj4gKyNkZWZpbmUgUkVHX0lOUFVUX1ZUT1RBTCAweEFCCj4gKyNkZWZpbmUgUkVHX0lO
UFVUX1ZBQ1RJVkVfU1RBUlQgMHhBRAo+ICsjZGVmaW5lIFJFR19JTlBVVF9WQUNUSVZFX1dJRFRI
IDB4QUYKPiArI2RlZmluZSBSRUdfSU5QVVRfVkZST05UX1BPUkNIIDB4QjEKPiArI2RlZmluZSBS
RUdfSU5QVVRfVlNZTkNfV0lEVEggMHhCMwo+ICsKPiArI2RlZmluZSBSRUdfQVVESU9fU1JDX0NU
UkwgMHhCOAo+ICsjZGVmaW5lIE1fQVVESU9fSTJTX0VOIDB4MEYKPiArI2RlZmluZSBFTl9JMlMw
IEJJVCgwKQo+ICsjZGVmaW5lIEVOX0kyUzEgQklUKDEpCj4gKyNkZWZpbmUgRU5fSTJTMiBCSVQo
MikKPiArI2RlZmluZSBFTl9JMlMzIEJJVCgzKQo+ICsjZGVmaW5lIEFVRElPX0ZJRk9fUkVTRVQg
QklUKDcpCj4gKwo+ICsjZGVmaW5lIFJFR19BVURJT19GTVQgMHhCOQo+ICsjZGVmaW5lIFJFR19B
VURJT19GSUZPX1NFTCAweEJBCj4gKwo+ICsjZGVmaW5lIFJFR19BVURJT19DVFJMMCAweEJCCj4g
KyNkZWZpbmUgQVVESU9fRlVMTF9QS1QgQklUKDQpCj4gKyNkZWZpbmUgQVVESU9fMTZCX0JPVU5E
IEJJVCg1KQo+ICsKPiArI2RlZmluZSBSRUdfQVVESU9fQ1RSTDEgMHhCQwo+ICsjZGVmaW5lIFJF
R19BVURJT19JTlBVVF9GUkVRIDB4QkUKPiArCj4gKyNkZWZpbmUgUkVHX0lFQzk1OF9TVFMwIDB4
QkYKPiArI2RlZmluZSBSRUdfSUVDOTU4X1NUUzEgMHhDMAo+ICsjZGVmaW5lIFJFR19JRUM5NThf
U1RTMiAweEMxCj4gKyNkZWZpbmUgUkVHX0lFQzk1OF9TVFMzIDB4QzIKPiArI2RlZmluZSBSRUdf
SUVDOTU4X1NUUzQgMHhDMwo+ICsKPiArI2RlZmluZSBSRUdfSFBEX0lSUV9USU1FIDB4QzkKPiAr
I2RlZmluZSBSRUdfQVVYX0RFQlVHX01PREUgMHhDQQo+ICsjZGVmaW5lIFJFR19BVVhfT1BUMiAw
eENCCj4gKyNkZWZpbmUgUkVHX0hEQ1BfT1BUIDB4Q0UKPiArCj4gKyNkZWZpbmUgUkVHX0RBVEFf
TVVURV9DVFJMIDB4RDMKPiArI2RlZmluZSBFTkFCTEVfRU5IQU5DRURfRlJBTUUgQklUKDApCj4g
KyNkZWZpbmUgRU5BQkxFX0FVVE9fVklERU9fRklGT19SRVNFVCBCSVQoMSkKPiArI2RlZmluZSBF
Tl9WSURfTVVURSBCSVQoNCkKPiArI2RlZmluZSBFTl9BVURfTVVURSBCSVQoNSkKPiArCj4gKyNk
ZWZpbmUgUkVHX1RJTUVfU1RNUF9DVFJMIDB4RDQKPiArI2RlZmluZSBFTl9FTkhBTkNFX1ZJRF9T
VE1QIEJJVCgwKQo+ICsjZGVmaW5lIEVOX0VOSEFOQ0VfQVVEX1NUTVAgQklUKDIpCj4gKyNkZWZp
bmUgTV9TVEFNUF9TVEVQIDB4MzAKPiArI2RlZmluZSBFTl9TU0NfR0FUIEJJVCg2KQo+ICsKPiAr
I2RlZmluZSBSRUdfSU5GT0ZSQU1FX0NUUkwgMHhFOAo+ICsjZGVmaW5lIEVOX0FWSV9QS1QgQklU
KDApCj4gKyNkZWZpbmUgRU5fQVVEX1BLVCBCSVQoMSkKPiArI2RlZmluZSBFTl9NUEdfUEtUIEJJ
VCgyKQo+ICsjZGVmaW5lIEVOX0dFTl9QS1QgQklUKDMpCj4gKyNkZWZpbmUgRU5fVklEX1RJTUVf
U1RNUCBCSVQoNCkKPiArI2RlZmluZSBFTl9BVURfVElNRV9TVE1QIEJJVCg1KQo+ICsjZGVmaW5l
IEVOX1ZJRF9DVFJMX1BLVCAoRU5fQVZJX1BLVCB8IEVOX1ZJRF9USU1FX1NUTVApCj4gKyNkZWZp
bmUgRU5fQVVEX0NUUkxfUEtUIChFTl9BVURfUEtUIHwgRU5fQVVEX1RJTUVfU1RNUCkKPiArCj4g
KyNkZWZpbmUgUkVHX0FVRElPX05fMF83IDB4REUKPiArI2RlZmluZSBSRUdfQVVESU9fTl84XzE1
IDB4REYKPiArI2RlZmluZSBSRUdfQVVESU9fTl8xNl8yMyAweEUwCj4gKwo+ICsjZGVmaW5lIFJF
R19BVklfSU5GT19EQjEgMHhFOQo+ICsjZGVmaW5lIFJFR19BVklfSU5GT19EQjIgMHhFQQo+ICsj
ZGVmaW5lIFJFR19BVklfSU5GT19EQjMgMHhFQgo+ICsjZGVmaW5lIFJFR19BVklfSU5GT19EQjQg
MHhFQwo+ICsjZGVmaW5lIFJFR19BVklfSU5GT19EQjUgMHhFRAo+ICsjZGVmaW5lIFJFR19BVklf
SU5GT19TVU0gMHhGNgo+ICsKPiArI2RlZmluZSBSRUdfQVVEX0lORk9GUkFNX0RCMSAweEY3Cj4g
KyNkZWZpbmUgUkVHX0FVRF9JTkZPRlJBTV9EQjIgMHhGOAo+ICsjZGVmaW5lIFJFR19BVURfSU5G
T0ZSQU1fREIzIDB4RjkKPiArI2RlZmluZSBSRUdfQVVEX0lORk9GUkFNX0RCNCAweEZBCj4gKyNk
ZWZpbmUgUkVHX0FVRF9JTkZPRlJBTV9TVU0gMHhGQgo+ICsKPiArLyogdGhlIGZvbGxvd2luZyBz
aXggcmVnaXN0ZXJzIGFyZSBpbiBiYW5rMSAqLwo+ICsjZGVmaW5lIFJFR19EUlZfMF9EQl84MDBf
TVYgMHg3RQo+ICsjZGVmaW5lIFJFR19QUkVfMF9EQl84MDBfTVYgMHg3Rgo+ICsjZGVmaW5lIFJF
R19QUkVfM1A1X0RCXzgwMF9NViAweDgxCj4gKyNkZWZpbmUgUkVHX1NTQ19DVFJMMCAweDg4Cj4g
KyNkZWZpbmUgUkVHX1NTQ19DVFJMMSAweDg5Cj4gKyNkZWZpbmUgUkVHX1NTQ19DVFJMMiAweDhB
Cj4gKwo+ICsjZGVmaW5lIFJCUiBEUF9MSU5LX0JXXzFfNjIKPiArI2RlZmluZSBIQlIgRFBfTElO
S19CV18yXzcKPiArI2RlZmluZSBIQlIyIERQX0xJTktfQldfNV80Cj4gKyNkZWZpbmUgSEJSMyBE
UF9MSU5LX0JXXzhfMQo+ICsKPiArLyogVmVuZG9yIG9wdGlvbiAqLwo+ICsjZGVmaW5lIE1BWF9M
QU5FX0NPVU5UIDQKPiArI2RlZmluZSBNQVhfTElOS19SQVRFIEhCUgo+ICsjZGVmaW5lIEFVVE9f
VFJBSU5fUkVUUlkgMwo+ICsjZGVmaW5lIE1BWF9DUl9MRVZFTCAweDAzCj4gKyNkZWZpbmUgTUFY
X0VRX0xFVkVMIDB4MDMKPiArI2RlZmluZSBBVVhfV0FJVF9USU1FT1VUX01TIDE1Cj4gKyNkZWZp
bmUgQVVYX0ZJRk9fTUFYX1NJWkUgMzIKPiArI2RlZmluZSBQSVhFTF9DTEtfREVMQVkgMQo+ICsj
ZGVmaW5lIFBJWEVMX0NMS19JTlZFUlNFIDAKPiArI2RlZmluZSBBREpVU1RfUEhBU0VfVEhSRVNI
T0xEIDgwMDAwCj4gKyNkZWZpbmUgRFBJX1BJWEVMX0NMS19NQVggOTUwMDAKPiArI2RlZmluZSBE
RUZBVUxUX1BXUl9PTiAwCj4gKyNkZWZpbmUgREVGQVVMVF9EUlZfSE9MRCAwCj4gKwo+ICsjZGVm
aW5lIEFVRElPX1NFTEVDVCBJMlMKPiArI2RlZmluZSBBVURJT19UWVBFIExQQ00KPiArI2RlZmlu
ZSBBVURJT19TQU1QTEVfUkFURSBTQU1QTEVfUkFURV80OEsKPiArI2RlZmluZSBBVURJT19DSEFO
TkVMX0NPVU5UIDIKPiArCj4gKy8qCj4gKyAqIDA6IFN0YW5kYXJkIEkyUwo+ICsgKiAxOiAzMmJp
dCBJMlMKPiArICovCj4gKyNkZWZpbmUgSTJTX0lOUFVUX0ZPUk1BVCAxCj4gKwo+ICsvKgo+ICsg
KiAwOiBMZWZ0LWp1c3RpZmllZAo+ICsgKiAxOiBSaWdodC1qdXN0aWZpZWQKPiArICovCj4gKyNk
ZWZpbmUgSTJTX0pVU1RJRklFRCAwCj4gKwo+ICsvKgo+ICsgKiAwOiBEYXRhIGRlbGF5IDFUIGNv
cnJlc3BvbmQgdG8gV1MKPiArICogMTogTm8gZGF0YSBkZWxheSBjb3JyZXNwb25kIHRvIFdTCj4g
KyAqLwo+ICsjZGVmaW5lIEkyU19EQVRBX0RFTEFZIDAKPiArCj4gKy8qCj4gKyAqIDA6IExlZnQg
Y2hhbm5lbAo+ICsgKiAxOiBSaWdodCBjaGFubmVsCj4gKyAqLwo+ICsjZGVmaW5lIEkyU19XU19D
SEFOTkVMIDAKPiArCj4gKy8qCj4gKyAqIDA6IE1TQiBzaGlmdCBmaXJzdAo+ICsgKiAxOiBMU0Ig
c2hpZnQgZmlyc3QKPiArICovCj4gKyNkZWZpbmUgSTJTX0RBVEFfU0VRVUVOQ0UgMAo+ICsKPiAr
LyoKPiArICogQXVkaW8gU2FtcGxlIFdvcmQgTGVuZ3RoCj4gKyAqIFdPUkRfTEVOR1RIXzE2QklU
Cj4gKyAqIFdPUkRfTEVOR1RIXzE4QklUCj4gKyAqIFdPUkRfTEVOR1RIXzIwQklUCj4gKyAqIFdP
UkRfTEVOR1RIXzI0QklUCj4gKyAqLwo+ICsjZGVmaW5lIEFVRElPX1dPUkRfTEVOR1RIIFdPUkRf
TEVOR1RIXzI0QklUCj4gKwo+ICtlbnVtIGF1eF9jbWRfdHlwZSB7Cj4gKwlDTURfQVVYX05BVElW
RV9SRUFEID0gMHgwLAo+ICsJQ01EX0FVWF9OQVRJVkVfV1JJVEUgPSAweDUsCj4gKwlDTURfQVVY
X0kyQ19FRElEX1JFQUQgPSAweEIsCj4gK307Cj4gKwo+ICtlbnVtIGF1eF9jbWRfcmVwbHkgewo+
ICsJUkVQTFlfQUNLLAo+ICsJUkVQTFlfTkFDSywKPiArCVJFUExZX0RFRkVSLAo+ICt9Owo+ICsK
PiArZW51bSBsaW5rX3RyYWluX3N0YXR1cyB7Cj4gKwlMSU5LX0lETEUsCj4gKwlMSU5LX0JVU1ks
Cj4gKwlMSU5LX09LLAo+ICt9Owo+ICsKPiArZW51bSBtYXhfdmFsdWVfY2hlY2sgewo+ICsJVk9M
VEFHRV9TV0lORywKPiArCVBSRV9FTVBIQVNJUywKPiArfTsKPiArCj4gK3N0cnVjdCBpdDY1MDVf
cGxhdGZvcm1fZGF0YSB7Cj4gKwlzdHJ1Y3QgcmVndWxhdG9yICpwd3IxODsKPiArCXN0cnVjdCBy
ZWd1bGF0b3IgKm92ZGQ7Cj4gKwlzdHJ1Y3QgZ3Bpb19kZXNjICpncGlvZF9yZXNldDsKPiArfTsK
PiArCj4gK2VudW0gaXQ2NTA1X2F1ZGlvX3NlbGVjdCB7Cj4gKwlJMlMgPSAwLAo+ICsJU1BESUYs
Cj4gK307Cj4gKwo+ICtlbnVtIGl0NjUwNV9hdWRpb19zYW1wbGVfcmF0ZSB7Cj4gKwlTQU1QTEVf
UkFURV8yNEsgPSAweDYsCj4gKwlTQU1QTEVfUkFURV8zMksgPSAweDMsCj4gKwlTQU1QTEVfUkFU
RV80OEsgPSAweDIsCj4gKwlTQU1QTEVfUkFURV85NksgPSAweEEsCj4gKwlTQU1QTEVfUkFURV8x
OTJLID0gMHhFLAo+ICsJU0FNUExFX1JBVEVfNDRfMUsgPSAweDAsCj4gKwlTQU1QTEVfUkFURV84
OF8ySyA9IDB4OCwKPiArCVNBTVBMRV9SQVRFXzE3Nl80SyA9IDB4QywKPiArfTsKPiArCj4gK2Vu
dW0gaXQ2NTA1X2F1ZGlvX3R5cGUgewo+ICsJTFBDTSA9IDAsCj4gKwlOTFBDTSwKPiArCURTUywK
PiArfTsKPiArCj4gK2VudW0gaXQ2NTA1X2F1ZGlvX3dvcmRfbGVuZ3RoIHsKPiArCVdPUkRfTEVO
R1RIXzE2QklUID0gMCwKPiArCVdPUkRfTEVOR1RIXzE4QklULAo+ICsJV09SRF9MRU5HVEhfMjBC
SVQsCj4gKwlXT1JEX0xFTkdUSF8yNEJJVCwKPiArfTsKPiArCj4gK3N0cnVjdCBpdDY1MDVfYXVk
aW9fZGF0YSB7Cj4gKwllbnVtIGl0NjUwNV9hdWRpb19zZWxlY3Qgc2VsZWN0Owo+ICsJZW51bSBp
dDY1MDVfYXVkaW9fc2FtcGxlX3JhdGUgc2FtcGxlX3JhdGU7Cj4gKwllbnVtIGl0NjUwNV9hdWRp
b190eXBlIHR5cGU7Cj4gKwllbnVtIGl0NjUwNV9hdWRpb193b3JkX2xlbmd0aCB3b3JkX2xlbmd0
aDsKPiArCXU4IGNoYW5uZWxfY291bnQ7Cj4gKwl1OCBpMnNfaW5wdXRfZm9ybWF0Owo+ICsJdTgg
aTJzX2p1c3RpZmllZDsKPiArCXU4IGkyc19kYXRhX2RlbGF5Owo+ICsJdTggaTJzX3dzX2NoYW5u
ZWw7Cj4gKwl1OCBpMnNfZGF0YV9zZXF1ZW5jZTsKPiArfTsKPiArCj4gK3N0cnVjdCBpdDY1MDVf
YXVkaW9fc2FtcGxlX3JhdGVfbWFwIHsKPiArCWVudW0gaXQ2NTA1X2F1ZGlvX3NhbXBsZV9yYXRl
IHJhdGU7Cj4gKwlpbnQgc2FtcGxlX3JhdGVfdmFsdWU7Cj4gK307Cj4gKwo+ICtzdHJ1Y3QgaXQ2
NTA1X2RybV9kcF9saW5rIHsKPiArCXVuc2lnbmVkIGNoYXIgcmV2aXNpb247Cj4gKwl1bnNpZ25l
ZCBpbnQgcmF0ZTsKPiArCXVuc2lnbmVkIGludCBudW1fbGFuZXM7Cj4gKwl1bnNpZ25lZCBsb25n
IGNhcGFiaWxpdGllczsKPiArfTsKPiArCj4gK3N0cnVjdCBpdDY1MDUgewo+ICsJc3RydWN0IGRy
bV9kcF9hdXggYXV4Owo+ICsJc3RydWN0IGRybV9icmlkZ2UgYnJpZGdlOwo+ICsJc3RydWN0IGky
Y19jbGllbnQgKmNsaWVudDsKPiArCXN0cnVjdCBlZGlkICplZGlkOwo+ICsJc3RydWN0IGRybV9j
b25uZWN0b3IgY29ubmVjdG9yOwo+ICsJc3RydWN0IGl0NjUwNV9kcm1fZHBfbGluayBsaW5rOwo+
ICsJc3RydWN0IGl0NjUwNV9wbGF0Zm9ybV9kYXRhIHBkYXRhOwo+ICsJc3RydWN0IG11dGV4IGV4
dGNvbl9sb2NrOwo+ICsJc3RydWN0IG11dGV4IG1vZGVfbG9jazsKPiArCXN0cnVjdCBtdXRleCBh
dXhfbG9jazsKPiArCXN0cnVjdCByZWdtYXAgKnJlZ21hcDsKPiArCXN0cnVjdCBkcm1fZGlzcGxh
eV9tb2RlIHZpZGVvX2luZm87Cj4gKwlzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgZXZlbnRfbmI7Cj4g
KwlzdHJ1Y3QgZXh0Y29uX2RldiAqZXh0Y29uOwo+ICsJc3RydWN0IHdvcmtfc3RydWN0IGV4dGNv
bl93cTsKPiArCWVudW0gZHJtX2Nvbm5lY3Rvcl9zdGF0dXMgY29ubmVjdG9yX3N0YXR1czsKPiAr
CWludCByZXZpc2lvbjsKPiArCWVudW0gbGlua190cmFpbl9zdGF0dXMgbGlua19zdGF0ZTsKPiAr
CXN0cnVjdCB3b3JrX3N0cnVjdCBsaW5rX3dvcmtzOwo+ICsJdTggZHBjZFtEUF9SRUNFSVZFUl9D
QVBfU0laRV07Cj4gKwl1OCBsYW5lX2NvdW50Owo+ICsJdTggbGlua19yYXRlX2J3X2NvZGU7Cj4g
Kwl1OCBzaW5rX2NvdW50Owo+ICsJYm9vbCBzdGVwX3RyYWluOwo+ICsJYm9vbCBicmFuY2hfZGV2
aWNlOwo+ICsJYm9vbCBlbmFibGVfc3NjOwo+ICsJYm9vbCBsYW5lX3N3YXBfZGlzYWJsZWQ7Cj4g
Kwlib29sIGxhbmVfc3dhcDsKPiArCWJvb2wgcG93ZXJlZDsKPiArCXUzMiBhZmVfc2V0dGluZzsK
PiArCXN0cnVjdCBjb21wbGV0aW9uIHdhaXRfZWRpZF9jb21wbGV0ZTsKPiArCXU4IGF1dG9fdHJh
aW5fcmV0cnk7Cj4gKwlib29sIGlzX3JlcGVhdGVyOwo+ICsJYm9vbCBlbmFibGVfZW5oYW5jZWRf
ZnJhbWU7Cj4gKwloZG1pX2NvZGVjX3BsdWdnZWRfY2IgcGx1Z2dlZF9jYjsKPiArCXN0cnVjdCBk
ZXZpY2UgKmNvZGVjX2RldjsKPiArCXN0cnVjdCBkZWxheWVkX3dvcmsgZGVsYXllZF9hdWRpbzsK
PiArCWJvb2wgZW5hYmxlX2F1ZGlvOwo+ICsJc3RydWN0IGl0NjUwNV9hdWRpb19kYXRhIGF1ZGlv
Owo+ICsKPiArCS8qIGl0NjUwNSBkcml2ZXIgaG9sZCBvcHRpb24gKi8KPiArCWJvb2wgZW5hYmxl
X2Rydl9ob2xkOwo+ICt9Owo+ICsKPiArc3RydWN0IGl0NjUwNV9zdGVwX3RyYWluX3BhcmEgewo+
ICsJdTggdm9sdGFnZV9zd2luZ1tNQVhfTEFORV9DT1VOVF07Cj4gKwl1OCBwcmVfZW1waGFzaXNb
TUFYX0xBTkVfQ09VTlRdOwo+ICt9Owo+ICsKPiArLyoKPiArICogVmVuZG9yIG9wdGlvbiBhZmUg
c2V0dGluZ3MgZm9yIGRpZmZlcmVudCBwbGF0Zm9ybXMKPiArICogMDogZm9yIGJpdGxhbmQgMTBl
LCBxdWFudGEgemRlCj4gKyAqIDE6IGZvciBnb29nbGUga3VrdWkgcDEvcDIsIGh1YXFpbiBrcmFu
ZQo+ICsgKi8KPiArCj4gK3N0YXRpYyB1OCBjb25zdCBhZmVfc2V0dGluZ190YWJsZVtdWzNdID0g
ewo+ICsJezB4ODIsIDB4MDAsIDB4QTZ9LAo+ICsJezB4OTMsIDB4MkEsIDB4ODV9Cj4gK307Cj4g
Kwo+ICtzdGF0aWMgY29uc3Qgc3RydWN0IGl0NjUwNV9hdWRpb19zYW1wbGVfcmF0ZV9tYXAgYXVk
aW9fc2FtcGxlX3JhdGVfbWFwW10gPSB7Cj4gKwl7U0FNUExFX1JBVEVfMjRLLCAyNDAwMH0sCj4g
Kwl7U0FNUExFX1JBVEVfMzJLLCAzMjAwMH0sCj4gKwl7U0FNUExFX1JBVEVfNDhLLCA0ODAwMH0s
Cj4gKwl7U0FNUExFX1JBVEVfOTZLLCA5NjAwMH0sCj4gKwl7U0FNUExFX1JBVEVfMTkySywgMTky
MDAwfSwKPiArCXtTQU1QTEVfUkFURV80NF8xSywgNDQxMDB9LAo+ICsJe1NBTVBMRV9SQVRFXzg4
XzJLLCA4ODIwMH0sCj4gKwl7U0FNUExFX1JBVEVfMTc2XzRLLCAxNzY0MDB9LAo+ICt9Owo+ICsK
PiArc3RhdGljIGNvbnN0IHN0cnVjdCByZWdtYXBfcmFuZ2UgaXQ2NTA1X2JyaWRnZV92b2xhdGls
ZV9yYW5nZXNbXSA9IHsKPiArCXsgLnJhbmdlX21pbiA9IDAsIC5yYW5nZV9tYXggPSAweEZGIH0s
Cj4gK307Cj4gKwo+ICtzdGF0aWMgY29uc3Qgc3RydWN0IHJlZ21hcF9hY2Nlc3NfdGFibGUgaXQ2
NTA1X2JyaWRnZV92b2xhdGlsZV90YWJsZSA9IHsKPiArCS55ZXNfcmFuZ2VzID0gaXQ2NTA1X2Jy
aWRnZV92b2xhdGlsZV9yYW5nZXMsCj4gKwkubl95ZXNfcmFuZ2VzID0gQVJSQVlfU0laRShpdDY1
MDVfYnJpZGdlX3ZvbGF0aWxlX3JhbmdlcyksCj4gK307Cj4gKwo+ICtzdGF0aWMgY29uc3Qgc3Ry
dWN0IHJlZ21hcF9jb25maWcgaXQ2NTA1X3JlZ21hcF9jb25maWcgPSB7Cj4gKwkucmVnX2JpdHMg
PSA4LAo+ICsJLnZhbF9iaXRzID0gOCwKPiArCS52b2xhdGlsZV90YWJsZSA9ICZpdDY1MDVfYnJp
ZGdlX3ZvbGF0aWxlX3RhYmxlLAo+ICsJLmNhY2hlX3R5cGUgPSBSRUdDQUNIRV9OT05FLAo+ICt9
Owo+ICsKPiArc3RhdGljIGludCBpdDY1MDVfcmVhZChzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUsIHVu
c2lnbmVkIGludCByZWdfYWRkcikKPiArewo+ICsJdW5zaWduZWQgaW50IHZhbHVlOwo+ICsJaW50
IGVycjsKPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZpdDY1MDUtPmNsaWVudC0+ZGV2Owo+ICsK
PiArCWVyciA9IHJlZ21hcF9yZWFkKGl0NjUwNS0+cmVnbWFwLCByZWdfYWRkciwgJnZhbHVlKTsK
PiArCWlmIChlcnIgPCAwKSB7Cj4gKwkJRFJNX0RFVl9FUlJPUihkZXYsICJyZWFkIGZhaWxlZCBy
ZWdbMHgleF0gZXJyOiAlZCIsIHJlZ19hZGRyLAo+ICsJCQkgICAgICBlcnIpOwo+ICsJCXJldHVy
biBlcnI7Cj4gKwl9Cj4gKwo+ICsJcmV0dXJuIHZhbHVlOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50
IGl0NjUwNV93cml0ZShzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUsIHVuc2lnbmVkIGludCByZWdfYWRk
ciwKPiArCQkgICAgICB1bnNpZ25lZCBpbnQgcmVnX3ZhbCkKPiArewo+ICsJaW50IGVycjsKPiAr
CXN0cnVjdCBkZXZpY2UgKmRldiA9ICZpdDY1MDUtPmNsaWVudC0+ZGV2Owo+ICsKPiArCWVyciA9
IHJlZ21hcF93cml0ZShpdDY1MDUtPnJlZ21hcCwgcmVnX2FkZHIsIHJlZ192YWwpOwo+ICsKPiAr
CWlmIChlcnIgPCAwKSB7Cj4gKwkJRFJNX0RFVl9FUlJPUihkZXYsICJ3cml0ZSBmYWlsZWQgcmVn
WzB4JXhdID0gMHgleCBlcnIgPSAlZCIsCj4gKwkJCSAgICAgIHJlZ19hZGRyLCByZWdfdmFsLCBl
cnIpOwo+ICsJCXJldHVybiBlcnI7Cj4gKwl9Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4g
K3N0YXRpYyBpbnQgaXQ2NTA1X3NldF9iaXRzKHN0cnVjdCBpdDY1MDUgKml0NjUwNSwgdW5zaWdu
ZWQgaW50IHJlZywKPiArCQkJIHVuc2lnbmVkIGludCBtYXNrLCB1bnNpZ25lZCBpbnQgdmFsdWUp
Cj4gK3sKPiArCWludCBlcnI7Cj4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmaXQ2NTA1LT5jbGll
bnQtPmRldjsKPiArCj4gKwllcnIgPSByZWdtYXBfdXBkYXRlX2JpdHMoaXQ2NTA1LT5yZWdtYXAs
IHJlZywgbWFzaywgdmFsdWUpOwo+ICsJaWYgKGVyciA8IDApIHsKPiArCQlEUk1fREVWX0VSUk9S
KAo+ICsJCQlkZXYsICJ3cml0ZSByZWdbMHgleF0gPSAweCV4IG1hc2sgPSAweCV4IGZhaWxlZCBl
cnIgJWQiLAo+ICsJCQlyZWcsIHZhbHVlLCBtYXNrLCBlcnIpOwo+ICsJCXJldHVybiBlcnI7Cj4g
Kwl9Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgaXQ2NTA1X2RwY2Rf
cmVhZChzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUsIHVuc2lnbmVkIGxvbmcgb2Zmc2V0KQo+ICt7Cj4g
Kwl1OCB2YWx1ZTsKPiArCWludCByZXQ7Cj4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmaXQ2NTA1
LT5jbGllbnQtPmRldjsKPiArCj4gKwlyZXQgPSBkcm1fZHBfZHBjZF9yZWFkYigmaXQ2NTA1LT5h
dXgsIG9mZnNldCwgJnZhbHVlKTsKPiArCWlmIChyZXQgPCAwKSB7Cj4gKwkJRFJNX0RFVl9FUlJP
UihkZXYsICJEUENEIHJlYWQgZmFpbGVkIFsweCVseF0gcmV0OiAlZCIsIG9mZnNldCwKPiArCQkJ
ICAgICAgcmV0KTsKPiArCQlyZXR1cm4gcmV0Owo+ICsJfQo+ICsJcmV0dXJuIHZhbHVlOwo+ICt9
Cj4gKwo+ICtzdGF0aWMgaW50IGl0NjUwNV9kcGNkX3dyaXRlKHN0cnVjdCBpdDY1MDUgKml0NjUw
NSwgdW5zaWduZWQgbG9uZyBvZmZzZXQsCj4gKwkJCSAgICAgdW5zaWduZWQgbG9uZyBkYXRhaW4p
Cj4gK3sKPiArCWludCByZXQ7Cj4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmaXQ2NTA1LT5jbGll
bnQtPmRldjsKPiArCj4gKwlyZXQgPSBkcm1fZHBfZHBjZF93cml0ZWIoJml0NjUwNS0+YXV4LCBv
ZmZzZXQsIGRhdGFpbik7Cj4gKwlpZiAocmV0IDwgMCkgewo+ICsJCURSTV9ERVZfRVJST1IoZGV2
LCAiRFBDRCB3cml0ZSBmYWlsZWQgWzB4JWx4XSByZXQ6ICVkIiwgb2Zmc2V0LAo+ICsJCQkgICAg
ICByZXQpOwo+ICsJCXJldHVybiByZXQ7Cj4gKwl9Cj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiAr
c3RhdGljIGludCBpdDY1MDVfZ2V0X2RwY2Qoc3RydWN0IGl0NjUwNSAqaXQ2NTA1LCBpbnQgb2Zm
c2V0LCB1OCAqZHBjZCwgaW50IG51bSkKPiArewo+ICsJaW50IHJldDsKPiArCXN0cnVjdCBkZXZp
Y2UgKmRldiA9ICZpdDY1MDUtPmNsaWVudC0+ZGV2Owo+ICsKPiArCXJldCA9IGRybV9kcF9kcGNk
X3JlYWQoJml0NjUwNS0+YXV4LCBvZmZzZXQsIGRwY2QsIG51bSk7Cj4gKwo+ICsJaWYgKHJldCA8
IDApCj4gKwkJcmV0dXJuIHJldDsKPiArCj4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJy
ZXQgPSAlZCBEUENEWzB4JXhdID0gMHglKnBoIiwgcmV0LCBvZmZzZXQsCj4gKwkJCSAgICAgbnVt
LCBkcGNkKTsKPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgaXQ2NTA1
X2R1bXAoc3RydWN0IGl0NjUwNSAqaXQ2NTA1KQo+ICt7Cj4gKwl1bnNpZ25lZCBpbnQgaSwgajsK
PiArCXU4IHJlZ3NbMTZdOwo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJml0NjUwNS0+Y2xpZW50
LT5kZXY7Cj4gKwo+ICsJZm9yIChpID0gMDsgaSA8PSAweGZmOyBpICs9IDE2KSB7Cj4gKwkJZm9y
IChqID0gMDsgaiA8IDE2OyBqKyspCj4gKwkJCXJlZ3Nbal0gPSBpdDY1MDVfcmVhZChpdDY1MDUs
IGkgKyBqKTsKPiArCj4gKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiWzB4JTAyeF0gPSAl
MTZwaCIsIGksIHJlZ3MpOwo+ICsJfQo+ICt9Cj4gKwo+ICtzdGF0aWMgYm9vbCBpdDY1MDVfZ2V0
X3NpbmtfaHBkX3N0YXR1cyhzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUpCj4gK3sKPiArCWludCByZWdf
MGQ7Cj4gKwo+ICsJcmVnXzBkID0gaXQ2NTA1X3JlYWQoaXQ2NTA1LCBSRUdfU1lTVEVNX1NUUyk7
Cj4gKwo+ICsJaWYgKHJlZ18wZCA8IDApCj4gKwkJcmV0dXJuIGZhbHNlOwo+ICsKPiArCXJldHVy
biAocmVnXzBkICYgSFBEX1NUUykgPyB0cnVlIDogZmFsc2U7Cj4gK30KPiArCj4gK3N0YXRpYyBp
bnQgaXQ2NTA1X3JlYWRfd29yZChzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUsIHVuc2lnbmVkIGludCBy
ZWcpCj4gK3sKPiArCWludCB2YWwwLCB2YWwxOwo+ICsKPiArCXZhbDAgPSBpdDY1MDVfcmVhZChp
dDY1MDUsIHJlZyk7Cj4gKwlpZiAodmFsMCA8IDApCj4gKwkJcmV0dXJuIHZhbDA7Cj4gKwo+ICsJ
dmFsMSA9IGl0NjUwNV9yZWFkKGl0NjUwNSwgcmVnICsgMSk7Cj4gKwlpZiAodmFsMSA8IDApCj4g
KwkJcmV0dXJuIHZhbDE7Cj4gKwo+ICsJcmV0dXJuICh2YWwxIDw8IDgpIHwgdmFsMDsKPiArfQo+
ICsKPiArc3RhdGljIHZvaWQgaXQ2NTA1X2NhbGNfdmlkZW9faW5mbyhzdHJ1Y3QgaXQ2NTA1ICpp
dDY1MDUpCj4gK3sKPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZpdDY1MDUtPmNsaWVudC0+ZGV2
Owo+ICsJaW50IGhzeW5jX3BvbCwgdnN5bmNfcG9sLCBpbnRlcmxhY2VkOwo+ICsJaW50IGh0b3Rh
bCwgaGRlcywgaGRldywgaGZwaCwgaHN5bmN3Owo+ICsJaW50IHZ0b3RhbCwgdmRlcywgdmRldywg
dmZwaCwgdnN5bmN3Owo+ICsJaW50IHJkZGF0YSwgaSwgcGNsaywgc3VtOwo+ICsKPiArCXVzbGVl
cF9yYW5nZSgxMDAwMCwgMTUwMDApOwo+ICsJaXQ2NTA1X3dyaXRlKGl0NjUwNSwgUkVHX0JBTktf
U0VMLCAweDAwKTsKPiArCXJkZGF0YSA9IGl0NjUwNV9yZWFkKGl0NjUwNSwgUkVHX0lOUFVUX0NU
UkwpOwo+ICsJaHN5bmNfcG9sID0gcmRkYXRhICYgSU5QVVRfSFNZTkNfUE9MOwo+ICsJdnN5bmNf
cG9sID0gKHJkZGF0YSAmIElOUFVUX1ZTWU5DX1BPTCkgPj4gMjsKPiArCWludGVybGFjZWQgPSAo
cmRkYXRhICYgSU5QVVRfSU5URVJMQUNFRCkgPj4gNDsKPiArCj4gKwlodG90YWwgPSBpdDY1MDVf
cmVhZF93b3JkKGl0NjUwNSwgUkVHX0lOUFVUX0hUT1RBTCkgJiAweDFGRkY7Cj4gKwloZGVzID0g
aXQ2NTA1X3JlYWRfd29yZChpdDY1MDUsIFJFR19JTlBVVF9IQUNUSVZFX1NUQVJUKSAmIDB4MUZG
RjsKPiArCWhkZXcgPSBpdDY1MDVfcmVhZF93b3JkKGl0NjUwNSwgUkVHX0lOUFVUX0hBQ1RJVkVf
V0lEVEgpICYgMHgxRkZGOwo+ICsJaGZwaCA9IGl0NjUwNV9yZWFkX3dvcmQoaXQ2NTA1LCBSRUdf
SU5QVVRfSEZST05UX1BPUkNIKSAmIDB4MUZGRjsKPiArCWhzeW5jdyA9IGl0NjUwNV9yZWFkX3dv
cmQoaXQ2NTA1LCBSRUdfSU5QVVRfSFNZTkNfV0lEVEgpICYgMHgxRkZGOwo+ICsKPiArCXZ0b3Rh
bCA9IGl0NjUwNV9yZWFkX3dvcmQoaXQ2NTA1LCBSRUdfSU5QVVRfVlRPVEFMKSAmIDB4RkZGOwo+
ICsJdmRlcyA9IGl0NjUwNV9yZWFkX3dvcmQoaXQ2NTA1LCBSRUdfSU5QVVRfVkFDVElWRV9TVEFS
VCkgJiAweEZGRjsKPiArCXZkZXcgPSBpdDY1MDVfcmVhZF93b3JkKGl0NjUwNSwgUkVHX0lOUFVU
X1ZBQ1RJVkVfV0lEVEgpICYgMHhGRkY7Cj4gKwl2ZnBoID0gaXQ2NTA1X3JlYWRfd29yZChpdDY1
MDUsIFJFR19JTlBVVF9WRlJPTlRfUE9SQ0gpICYgMHhGRkY7Cj4gKwl2c3luY3cgPSBpdDY1MDVf
cmVhZF93b3JkKGl0NjUwNSwgUkVHX0lOUFVUX1ZTWU5DX1dJRFRIKSAmIDB4RkZGOwo+ICsKPiAr
CXN1bSA9IDA7Cj4gKwlmb3IgKGkgPSAwOyBpIDwgMTA7IGkrKykgewo+ICsJCWl0NjUwNV9zZXRf
Yml0cyhpdDY1MDUsIFJFR19EQVRBX0NUUkwwLCBFTkFCTEVfUENMS19DT1VOVEVSLAo+ICsJCQkJ
RU5BQkxFX1BDTEtfQ09VTlRFUik7Cj4gKwkJdXNsZWVwX3JhbmdlKDEwMDAwLCAxNTAwMCk7Cj4g
KwkJaXQ2NTA1X3NldF9iaXRzKGl0NjUwNSwgUkVHX0RBVEFfQ1RSTDAsIEVOQUJMRV9QQ0xLX0NP
VU5URVIsCj4gKwkJCQkweDAwKTsKPiArCQlyZGRhdGEgPSBpdDY1MDVfcmVhZF93b3JkKGl0NjUw
NSwgUkVHX1BDTEtfQ09VTlRFUl9WQUxVRSkgJgo+ICsJCQkgMHhGRkY7Cj4gKwo+ICsJCXN1bSAr
PSByZGRhdGE7Cj4gKwl9Cj4gKwo+ICsJaWYgKHN1bSA9PSAwKSB7Cj4gKwkJRFJNX0RFVl9ERUJV
R19EUklWRVIoZGV2LCAiY2FsYyB2aWRlbyB0aW1pbmcgZXJyb3IiKTsKPiArCQlyZXR1cm47Cj4g
Kwl9Cj4gKwo+ICsJc3VtIC89IDEwOwo+ICsJcGNsayA9IDEzNTAwICogMjA0OCAvIHN1bTsKPiAr
CWl0NjUwNS0+dmlkZW9faW5mby5jbG9jayA9IHBjbGs7Cj4gKwlpdDY1MDUtPnZpZGVvX2luZm8u
aGRpc3BsYXkgPSBoZGV3Owo+ICsJaXQ2NTA1LT52aWRlb19pbmZvLmhzeW5jX3N0YXJ0ID0gaGRl
dyArIGhmcGg7Cj4gKwlpdDY1MDUtPnZpZGVvX2luZm8uaHN5bmNfZW5kID0gaGRldyArIGhmcGgg
KyBoc3luY3c7Cj4gKwlpdDY1MDUtPnZpZGVvX2luZm8uaHRvdGFsID0gaHRvdGFsOwo+ICsJaXQ2
NTA1LT52aWRlb19pbmZvLnZkaXNwbGF5ID0gdmRldzsKPiArCWl0NjUwNS0+dmlkZW9faW5mby52
c3luY19zdGFydCA9IHZkZXcgKyB2ZnBoOwo+ICsJaXQ2NTA1LT52aWRlb19pbmZvLnZzeW5jX2Vu
ZCA9IHZkZXcgKyB2ZnBoICsgdnN5bmN3Owo+ICsJaXQ2NTA1LT52aWRlb19pbmZvLnZ0b3RhbCA9
IHZ0b3RhbDsKPiArCj4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsIERSTV9NT0RFX0ZNVCwK
PiArCQkJICAgICBEUk1fTU9ERV9BUkcoJml0NjUwNS0+dmlkZW9faW5mbykpOwo+ICt9Cj4gKwo+
ICtzdGF0aWMgaW50IGl0NjUwNV9kcm1fZHBfbGlua19wcm9iZShzdHJ1Y3QgZHJtX2RwX2F1eCAq
YXV4LAo+ICsJCQkJICAgIHN0cnVjdCBpdDY1MDVfZHJtX2RwX2xpbmsgKmxpbmspCj4gK3sKPiAr
CXU4IHZhbHVlc1szXTsKPiArCWludCBlcnI7Cj4gKwo+ICsJbWVtc2V0KGxpbmssIDAsIHNpemVv
ZigqbGluaykpOwo+ICsKPiArCWVyciA9IGRybV9kcF9kcGNkX3JlYWQoYXV4LCBEUF9EUENEX1JF
ViwgdmFsdWVzLCBzaXplb2YodmFsdWVzKSk7Cj4gKwlpZiAoZXJyIDwgMCkKPiArCQlyZXR1cm4g
ZXJyOwo+ICsKPiArCWxpbmstPnJldmlzaW9uID0gdmFsdWVzWzBdOwo+ICsJbGluay0+cmF0ZSA9
IGRybV9kcF9id19jb2RlX3RvX2xpbmtfcmF0ZSh2YWx1ZXNbMV0pOwo+ICsJbGluay0+bnVtX2xh
bmVzID0gdmFsdWVzWzJdICYgRFBfTUFYX0xBTkVfQ09VTlRfTUFTSzsKPiArCj4gKwlpZiAodmFs
dWVzWzJdICYgRFBfRU5IQU5DRURfRlJBTUVfQ0FQKQo+ICsJCWxpbmstPmNhcGFiaWxpdGllcyA9
IDE7Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgaXQ2NTA1X2RybV9k
cF9saW5rX3Bvd2VyX3VwKHN0cnVjdCBkcm1fZHBfYXV4ICphdXgsCj4gKwkJCQkgICAgICAgc3Ry
dWN0IGl0NjUwNV9kcm1fZHBfbGluayAqbGluaykKPiArewo+ICsJdTggdmFsdWU7Cj4gKwlpbnQg
ZXJyOwo+ICsKPiArCS8qIERQX1NFVF9QT1dFUiByZWdpc3RlciBpcyBvbmx5IGF2YWlsYWJsZSBv
biBEUENEIHYxLjEgYW5kIGxhdGVyICovCj4gKwlpZiAobGluay0+cmV2aXNpb24gPCAweDExKQo+
ICsJCXJldHVybiAwOwo+ICsKPiArCWVyciA9IGRybV9kcF9kcGNkX3JlYWRiKGF1eCwgRFBfU0VU
X1BPV0VSLCAmdmFsdWUpOwo+ICsJaWYgKGVyciA8IDApCj4gKwkJcmV0dXJuIGVycjsKPiArCj4g
Kwl2YWx1ZSAmPSB+RFBfU0VUX1BPV0VSX01BU0s7Cj4gKwl2YWx1ZSB8PSBEUF9TRVRfUE9XRVJf
RDA7Cj4gKwo+ICsJZXJyID0gZHJtX2RwX2RwY2Rfd3JpdGViKGF1eCwgRFBfU0VUX1BPV0VSLCB2
YWx1ZSk7Cj4gKwlpZiAoZXJyIDwgMCkKPiArCQlyZXR1cm4gZXJyOwo+ICsKPiArCS8qCj4gKwkg
KiBBY2NvcmRpbmcgdG8gdGhlIERQIDEuMSBzcGVjaWZpY2F0aW9uLCBhICJTaW5rIERldmljZSBt
dXN0IGV4aXQgdGhlCj4gKwkgKiBwb3dlciBzYXZpbmcgc3RhdGUgd2l0aGluIDEgbXMiIChTZWN0
aW9uIDIuNS4zLjEsIFRhYmxlIDUtNTIsICJTaW5rCj4gKwkgKiBDb250cm9sIEZpZWxkIiAocmVn
aXN0ZXIgMHg2MDApLgo+ICsJICovCj4gKwl1c2xlZXBfcmFuZ2UoMTAwMCwgMjAwMCk7Cj4gKwo+
ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGl0NjUwNV9jbGVhcl9pbnQoc3Ry
dWN0IGl0NjUwNSAqaXQ2NTA1KQo+ICt7Cj4gKwlpdDY1MDVfd3JpdGUoaXQ2NTA1LCBSRUdfQkFO
S19TRUwsIDB4MDApOwo+ICsJaXQ2NTA1X3dyaXRlKGl0NjUwNSwgSU5UX1NUQVRVU18wMSwgMHhG
Rik7Cj4gKwlpdDY1MDVfd3JpdGUoaXQ2NTA1LCBJTlRfU1RBVFVTXzAyLCAweEZGKTsKPiArCWl0
NjUwNV93cml0ZShpdDY1MDUsIElOVF9TVEFUVVNfMDMsIDB4RkYpOwo+ICt9Cj4gKwo+ICtzdGF0
aWMgdm9pZCBpdDY1MDVfaW50X21hc2tfZW5hYmxlKHN0cnVjdCBpdDY1MDUgKml0NjUwNSkKPiAr
ewo+ICsJaXQ2NTA1X3dyaXRlKGl0NjUwNSwgUkVHX0JBTktfU0VMLCAweDAwKTsKPiArCWl0NjUw
NV93cml0ZShpdDY1MDUsIElOVF9NQVNLXzAxLCAweDFGKTsKPiArCWl0NjUwNV93cml0ZShpdDY1
MDUsIElOVF9NQVNLXzAyLCAweDA3KTsKPiArCWl0NjUwNV93cml0ZShpdDY1MDUsIElOVF9NQVNL
XzAzLCAweEIwKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgaXQ2NTA1X2ludF9tYXNrX2Rpc2Fi
bGUoc3RydWN0IGl0NjUwNSAqaXQ2NTA1KQo+ICt7Cj4gKwlpdDY1MDVfd3JpdGUoaXQ2NTA1LCBS
RUdfQkFOS19TRUwsIDB4MDApOwo+ICsJaXQ2NTA1X3dyaXRlKGl0NjUwNSwgSU5UX01BU0tfMDEs
IDB4MDApOwo+ICsJaXQ2NTA1X3dyaXRlKGl0NjUwNSwgSU5UX01BU0tfMDIsIDB4MDApOwo+ICsJ
aXQ2NTA1X3dyaXRlKGl0NjUwNSwgSU5UX01BU0tfMDMsIDB4MDApOwo+ICt9Cj4gKwo+ICtzdGF0
aWMgdm9pZCBpdDY1MDVfbGFuZV90ZXJtaW5hdGlvbl9vbihzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUp
Cj4gK3sKPiArCWlmIChpdDY1MDVfcmVhZChpdDY1MDUsIDB4Q0YpID09IDB4RjApCj4gKwkJaXQ2
NTA1X3NldF9iaXRzKGl0NjUwNSwgUkVHX0RSVl9MTl9EQVRBX1NFTCwgMHg4MCwgMHgwMCk7Cj4g
Kwo+ICsJaWYgKGl0NjUwNV9yZWFkKGl0NjUwNSwgMHhDRikgPT0gMHg3MCkgewo+ICsJCWlmIChp
dDY1MDUtPmxhbmVfc3dhcCkgewo+ICsJCQlzd2l0Y2ggKGl0NjUwNS0+bGFuZV9jb3VudCkgewo+
ICsJCQljYXNlIDE6Cj4gKwkJCWNhc2UgMjoKPiArCQkJCWl0NjUwNV9zZXRfYml0cyhpdDY1MDUs
IFJFR19EUlZfTE5fREFUQV9TRUwsCj4gKwkJCQkJCTB4MEMsIDB4MDgpOwo+ICsJCQkJYnJlYWs7
Cj4gKwkJCWRlZmF1bHQ6Cj4gKwkJCQlpdDY1MDVfc2V0X2JpdHMoaXQ2NTA1LCBSRUdfRFJWX0xO
X0RBVEFfU0VMLAo+ICsJCQkJCQkweDBDLCAweDBDKTsKPiArCQkJCWJyZWFrOwo+ICsJCQl9Cj4g
KwkJfSBlbHNlIHsKPiArCQkJc3dpdGNoIChpdDY1MDUtPmxhbmVfY291bnQpIHsKPiArCQkJY2Fz
ZSAxOgo+ICsJCQljYXNlIDI6Cj4gKwkJCQlpdDY1MDVfc2V0X2JpdHMoaXQ2NTA1LCBSRUdfRFJW
X0xOX0RBVEFfU0VMLAo+ICsJCQkJCQkweDBDLCAweDA0KTsKPiArCQkJCWJyZWFrOwo+ICsJCQlk
ZWZhdWx0Ogo+ICsJCQkJaXQ2NTA1X3NldF9iaXRzKGl0NjUwNSwgUkVHX0RSVl9MTl9EQVRBX1NF
TCwKPiArCQkJCQkJMHgwQywgMHgwQyk7Cj4gKwkJCQlicmVhazsKPiArCQkJfQo+ICsJCX0KPiAr
CX0KPiArfQo+ICsKPiArc3RhdGljIHZvaWQgaXQ2NTA1X2xhbmVfdGVybWluYXRpb25fb2ZmKHN0
cnVjdCBpdDY1MDUgKml0NjUwNSkKPiArewo+ICsJaWYgKGl0NjUwNV9yZWFkKGl0NjUwNSwgMHhD
RikgPT0gMHhGMCkKPiArCQlpdDY1MDVfc2V0X2JpdHMoaXQ2NTA1LCBSRUdfRFJWX0xOX0RBVEFf
U0VMLCAweDgwLCAweDgwKTsKPiArCj4gKwlpZiAoaXQ2NTA1X3JlYWQoaXQ2NTA1LCAweENGKSA9
PSAweDcwKQo+ICsJCWl0NjUwNV9zZXRfYml0cyhpdDY1MDUsIFJFR19EUlZfTE5fREFUQV9TRUws
IDB4MEMsIDB4MDApOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBpdDY1MDVfbGFuZV9wb3dlcl9v
bihzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUpCj4gK3sKPiArCWl0NjUwNV9zZXRfYml0cygKPiArCQlp
dDY1MDUsIFJFR19MSU5LX0RSViwgMHhGMSwKPiArCQkoKEJJVChpdDY1MDUtPmxhbmVfY291bnQp
IC0gMSkKPiArCQkgPDwgKGl0NjUwNS0+bGFuZV9zd2FwID8gKDggLSBpdDY1MDUtPmxhbmVfY291
bnQpIDogNCkpIHwKPiArCQkJMHgwMSk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGl0NjUwNV9s
YW5lX3Bvd2VyX29mZihzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUpCj4gK3sKPiArCWl0NjUwNV9zZXRf
Yml0cyhpdDY1MDUsIFJFR19MSU5LX0RSViwgMHhGMCwgMHgwMCk7Cj4gK30KPiArCj4gK3N0YXRp
YyB2b2lkIGl0NjUwNV9sYW5lX29mZihzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUpCj4gK3sKPiArCWl0
NjUwNV9sYW5lX3Bvd2VyX29mZihpdDY1MDUpOwo+ICsJaXQ2NTA1X2xhbmVfdGVybWluYXRpb25f
b2ZmKGl0NjUwNSk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGl0NjUwNV9hdXhfdGVybWluYXRp
b25fb24oc3RydWN0IGl0NjUwNSAqaXQ2NTA1KQo+ICt7Cj4gKwlpZiAoaXQ2NTA1X3JlYWQoaXQ2
NTA1LCAweENGKSA9PSAweEYwKQo+ICsJCWl0NjUwNV9sYW5lX3Rlcm1pbmF0aW9uX29uKGl0NjUw
NSk7Cj4gKwo+ICsJaWYgKGl0NjUwNV9yZWFkKGl0NjUwNSwgMHhDRikgPT0gMHg3MCkKPiArCQlp
dDY1MDVfc2V0X2JpdHMoaXQ2NTA1LCBSRUdfRFJWX0xOX0RBVEFfU0VMLCAweDgwLCAweDgwKTsK
PiArfQo+ICsKPiArc3RhdGljIHZvaWQgaXQ2NTA1X2F1eF9wb3dlcl9vbihzdHJ1Y3QgaXQ2NTA1
ICppdDY1MDUpCj4gK3sKPiArCWl0NjUwNV9zZXRfYml0cyhpdDY1MDUsIFJFR19BVVgsIDB4MDIs
IDB4MDIpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBpdDY1MDVfYXV4X29uKHN0cnVjdCBpdDY1
MDUgKml0NjUwNSkKPiArewo+ICsJaXQ2NTA1X2F1eF9wb3dlcl9vbihpdDY1MDUpOwo+ICsJaXQ2
NTA1X2F1eF90ZXJtaW5hdGlvbl9vbihpdDY1MDUpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBp
dDY1MDVfYXV4X3Jlc2V0KHN0cnVjdCBpdDY1MDUgKml0NjUwNSkKPiArewo+ICsJaXQ2NTA1X3Nl
dF9iaXRzKGl0NjUwNSwgUkVHX1JFU0VUX0NUUkwsIEFVWF9SRVNFVCwgQVVYX1JFU0VUKTsKPiAr
CWl0NjUwNV9zZXRfYml0cyhpdDY1MDUsIFJFR19SRVNFVF9DVFJMLCBBVVhfUkVTRVQsIDB4MDAp
Owo+ICt9Cj4gKwo+ICtzdGF0aWMgYm9vbCBpdDY1MDVfcmVzZXRfbG9naWMoc3RydWN0IGl0NjUw
NSAqaXQ2NTA1KQo+ICt7Cj4gKwlyZWdtYXBfd3JpdGUoaXQ2NTA1LT5yZWdtYXAsIFJFR19SRVNF
VF9DVFJMLCBBTExfTE9HSUNfUkVTRVQpOwo+ICsJdXNsZWVwX3JhbmdlKDEwMDAsIDE1MDApOwo+
ICsKPiArCWl0NjUwNS0+cmV2aXNpb24gPSBpdDY1MDVfcmVhZChpdDY1MDUsIFJFR19JQ19WRVIp
Owo+ICsKPiArCWlmIChpdDY1MDUtPnJldmlzaW9uIDwgMCkKPiArCQlyZXR1cm4gZmFsc2U7Cj4g
Kwo+ICsJcmV0dXJuIHRydWU7Cj4gK30KPiArCj4gK3N0YXRpYyBib29sIGl0NjUwNV9hdXhfb3Bf
ZmluaXNoZWQoc3RydWN0IGl0NjUwNSAqaXQ2NTA1KQo+ICt7Cj4gKwlpbnQgcmVnMmIgPSBpdDY1
MDVfcmVhZChpdDY1MDUsIFJFR19BVVhfQ01EX1JFUSk7Cj4gKwo+ICsJaWYgKHJlZzJiIDwgMCkK
PiArCQlyZXR1cm4gZmFsc2U7Cj4gKwo+ICsJcmV0dXJuIChyZWcyYiAmIEFVWF9CVVNZKSA9PSAw
Owo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGl0NjUwNV9hdXhfd2FpdChzdHJ1Y3QgaXQ2NTA1ICpp
dDY1MDUpCj4gK3sKPiArCWludCBzdGF0dXM7Cj4gKwl1bnNpZ25lZCBsb25nIHRpbWVvdXQ7Cj4g
KwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmaXQ2NTA1LT5jbGllbnQtPmRldjsKPiArCj4gKwl0aW1l
b3V0ID0gamlmZmllcyArIG1zZWNzX3RvX2ppZmZpZXMoQVVYX1dBSVRfVElNRU9VVF9NUykgKyAx
Owo+ICsKPiArCXdoaWxlICghaXQ2NTA1X2F1eF9vcF9maW5pc2hlZChpdDY1MDUpKSB7Cj4gKwkJ
aWYgKHRpbWVfYWZ0ZXIoamlmZmllcywgdGltZW91dCkpIHsKPiArCQkJRFJNX0RFVl9FUlJPUihk
ZXYsICJUaW1lZCBvdXQgd2FpdGluZyBBVVggdG8gZmluaXNoIik7Cj4gKwkJCXJldHVybiAtRVRJ
TUVET1VUOwo+ICsJCX0KPiArCQl1c2xlZXBfcmFuZ2UoMTAwMCwgMjAwMCk7Cj4gKwl9Cj4gKwo+
ICsJc3RhdHVzID0gaXQ2NTA1X3JlYWQoaXQ2NTA1LCBSRUdfQVVYX0VSUk9SX1NUUyk7Cj4gKwlp
ZiAoc3RhdHVzIDwgMCkgewo+ICsJCURSTV9ERVZfRVJST1IoZGV2LCAiRmFpbGVkIHRvIHJlYWQg
QVVYIGNoYW5uZWw6ICVkIiwgc3RhdHVzKTsKPiArCQlyZXR1cm4gc3RhdHVzOwo+ICsJfQo+ICsK
PiArCXJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgc3NpemVfdCBpdDY1MDVfYXV4X29wZXJh
dGlvbihzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUsCj4gKwkJCQkgICAgZW51bSBhdXhfY21kX3R5cGUg
Y21kLAo+ICsJCQkJICAgIHVuc2lnbmVkIGludCBhZGRyZXNzLCB1OCAqYnVmZmVyLAo+ICsJCQkJ
ICAgIHNpemVfdCBzaXplLCBlbnVtIGF1eF9jbWRfcmVwbHkgKnJlcGx5KQo+ICt7Cj4gKwlpbnQg
aSwgc3RhdHVzOwo+ICsJYm9vbCBhdXhfd3JpdGVfY2hlY2sgPSBmYWxzZTsKPiArCj4gKwlpZiAo
IWl0NjUwNV9nZXRfc2lua19ocGRfc3RhdHVzKGl0NjUwNSkpCj4gKwkJcmV0dXJuIC1FSU87Cj4g
Kwo+ICsJLyogc2V0IEFVWCB1c2VyIG1vZGUgKi8KPiArCWl0NjUwNV9zZXRfYml0cyhpdDY1MDUs
IFJFR19BVVhfQ1RSTCwgQVVYX1VTRVJfTU9ERSwgQVVYX1VTRVJfTU9ERSk7Cj4gKwo+ICthdXhf
b3Bfc3RhcnQ6Cj4gKwo+ICsJaWYgKGNtZCA9PSBDTURfQVVYX0kyQ19FRElEX1JFQUQpIHsKPiAr
CQkvKiBEUCBBVVggRURJRCBGSUZPIGhhcyBtYXhpbXVtIGxlbmd0aCBvZiBuIGJ5dGVzLiAqLwo+
ICsJCXNpemUgPSBtaW5fdChzaXplX3QsIHNpemUsIEFVWF9GSUZPX01BWF9TSVpFKTsKPiArCQkv
KiBFbmFibGUgQVVYIEZJRk8gcmVhZCBiYWNrIGFuZCBjbGVhciBGSUZPICovCj4gKwkJaXQ2NTA1
X3NldF9iaXRzKGl0NjUwNSwgUkVHX0FVWF9DVFJMLAo+ICsJCQkJQVVYX0VOX0ZJRk9fUkVBRCB8
IENMUl9FRElEX0ZJRk8sCj4gKwkJCQlBVVhfRU5fRklGT19SRUFEIHwgQ0xSX0VESURfRklGTyk7
Cj4gKwo+ICsJCWl0NjUwNV9zZXRfYml0cyhpdDY1MDUsIFJFR19BVVhfQ1RSTCwKPiArCQkJCUFV
WF9FTl9GSUZPX1JFQUQgfCBDTFJfRURJRF9GSUZPLAo+ICsJCQkJQVVYX0VOX0ZJRk9fUkVBRCk7
Cj4gKwl9IGVsc2Ugewo+ICsJCS8qIFRoZSBEUCBBVVggdHJhbnNtaXQgYnVmZmVyIGhhcyA0IGJ5
dGVzLiAqLwo+ICsJCXNpemUgPSBtaW5fdChzaXplX3QsIHNpemUsIDQpOwo+ICsJCWl0NjUwNV9z
ZXRfYml0cyhpdDY1MDUsIFJFR19BVVhfQ1RSTCwgQVVYX05PX1NFR01FTlRfV1IsCj4gKwkJCQlB
VVhfTk9fU0VHTUVOVF9XUik7Cj4gKwl9Cj4gKwo+ICsJLyogU3RhcnQgQWRkcmVzc1s3OjBdICov
Cj4gKwlpdDY1MDVfd3JpdGUoaXQ2NTA1LCBSRUdfQVVYX0FEUl8wXzcsIChhZGRyZXNzID4+IDAp
ICYgMHhGRik7Cj4gKwkvKiBTdGFydCBBZGRyZXNzWzE1OjhdICovCj4gKwlpdDY1MDVfd3JpdGUo
aXQ2NTA1LCBSRUdfQVVYX0FEUl84XzE1LCAoYWRkcmVzcyA+PiA4KSAmIDB4RkYpOwo+ICsJLyog
V3JpdGVOdW1bMzowXStTdGFydEFkclsxOToxNl0gKi8KPiArCWl0NjUwNV93cml0ZShpdDY1MDUs
IFJFR19BVVhfQURSXzE2XzE5LAo+ICsJCSAgICAgKChhZGRyZXNzID4+IDE2KSAmIDB4MEYpIHwg
KChzaXplIC0gMSkgPDwgNCkpOwo+ICsKPiArCWlmIChjbWQgPT0gQ01EX0FVWF9OQVRJVkVfV1JJ
VEUpCj4gKwkJcmVnbWFwX2J1bGtfd3JpdGUoaXQ2NTA1LT5yZWdtYXAsIFJFR19BVVhfT1VUX0RB
VEEwLCBidWZmZXIsCj4gKwkJCQkgIHNpemUpOwo+ICsKPiArCS8qIEF1eCBGaXJlICovCj4gKwlp
dDY1MDVfd3JpdGUoaXQ2NTA1LCBSRUdfQVVYX0NNRF9SRVEsIGNtZCk7Cj4gKwo+ICsJc3RhdHVz
ID0gaXQ2NTA1X2F1eF93YWl0KGl0NjUwNSk7Cj4gKwlpZiAoc3RhdHVzIDwgMCkKPiArCQlnb3Rv
IGF1eF9vcF9lcnI7Cj4gKwo+ICsJc3RhdHVzID0gaXQ2NTA1X3JlYWQoaXQ2NTA1LCBSRUdfQVVY
X0VSUk9SX1NUUyk7Cj4gKwlpZiAoc3RhdHVzIDwgMCkKPiArCQlnb3RvIGF1eF9vcF9lcnI7Cj4g
Kwo+ICsJc3dpdGNoICgoc3RhdHVzID4+IDYpICYgMHgzKSB7Cj4gKwljYXNlIDA6Cj4gKwkJKnJl
cGx5ID0gUkVQTFlfQUNLOwo+ICsJCWJyZWFrOwo+ICsJY2FzZSAxOgo+ICsJCSpyZXBseSA9IFJF
UExZX0RFRkVSOwo+ICsJCXN0YXR1cyA9IC1FQUdBSU47Cj4gKwkJZ290byBhdXhfb3BfZXJyOwo+
ICsJY2FzZSAyOgo+ICsJCSpyZXBseSA9IFJFUExZX05BQ0s7Cj4gKwkJc3RhdHVzID0gLUVJTzsK
PiArCQlnb3RvIGF1eF9vcF9lcnI7Cj4gKwljYXNlIDM6Cj4gKwkJc3RhdHVzID0gLUVUSU1FRE9V
VDsKPiArCQlnb3RvIGF1eF9vcF9lcnI7Cj4gKwl9Cj4gKwo+ICsJLyogUmVhZCBiYWNrIE5hdGl2
ZSBXcml0ZSBkYXRhICovCj4gKwlpZiAoY21kID09IENNRF9BVVhfTkFUSVZFX1dSSVRFKSB7Cj4g
KwkJYXV4X3dyaXRlX2NoZWNrID0gdHJ1ZTsKPiArCQljbWQgPSBDTURfQVVYX05BVElWRV9SRUFE
Owo+ICsJCWdvdG8gYXV4X29wX3N0YXJ0Owo+ICsJfQo+ICsKPiArCWlmIChjbWQgPT0gQ01EX0FV
WF9JMkNfRURJRF9SRUFEKSB7Cj4gKwkJZm9yIChpID0gMDsgaSA8IHNpemU7IGkrKykgewo+ICsJ
CQlzdGF0dXMgPSBpdDY1MDVfcmVhZChpdDY1MDUsIFJFR19BVVhfREFUQV9GSUZPKTsKPiArCQkJ
aWYgKHN0YXR1cyA8IDApCj4gKwkJCQlnb3RvIGF1eF9vcF9lcnI7Cj4gKwkJCWJ1ZmZlcltpXSA9
IHN0YXR1czsKPiArCQl9Cj4gKwl9IGVsc2Ugewo+ICsJCWZvciAoaSA9IDA7IGkgPCBzaXplOyBp
KyspIHsKPiArCQkJc3RhdHVzID0gaXQ2NTA1X3JlYWQoaXQ2NTA1LCBSRUdfQVVYX0RBVEFfMF83
ICsgaSk7Cj4gKwkJCWlmIChzdGF0dXMgPCAwKQo+ICsJCQkJZ290byBhdXhfb3BfZXJyOwo+ICsK
PiArCQkJaWYgKGF1eF93cml0ZV9jaGVjayAmJiBidWZmZXJbc2l6ZSAtIDEgLSBpXSAhPSBzdGF0
dXMpCj4gKwkJCQlicmVhazsKPiArCj4gKwkJCWJ1ZmZlcltzaXplIC0gMSAtIGldID0gc3RhdHVz
Owo+ICsJCX0KPiArCX0KPiArCj4gKwlzdGF0dXMgPSBpOwo+ICsKPiArYXV4X29wX2VycjoKPiAr
Cj4gKwlpZiAoY21kID09IENNRF9BVVhfSTJDX0VESURfUkVBRCkgewo+ICsJCS8qY2xlYXIgQVVY
IEZJRk8gKi8KPiArCQlpdDY1MDVfc2V0X2JpdHMoaXQ2NTA1LCBSRUdfQVVYX0NUUkwsCj4gKwkJ
CQlBVVhfRU5fRklGT19SRUFEIHwgQ0xSX0VESURfRklGTywKPiArCQkJCUFVWF9FTl9GSUZPX1JF
QUQgfCBDTFJfRURJRF9GSUZPKTsKPiArCQlpdDY1MDVfc2V0X2JpdHMoaXQ2NTA1LCBSRUdfQVVY
X0NUUkwsCj4gKwkJCQlBVVhfRU5fRklGT19SRUFEIHwgQ0xSX0VESURfRklGTywgMHgwMCk7Cj4g
Kwl9Cj4gKwo+ICsJLyogTGVhdmUgQVVYIHVzZXIgbW9kZSAqLwo+ICsJaXQ2NTA1X3NldF9iaXRz
KGl0NjUwNSwgUkVHX0FVWF9DVFJMLCBBVVhfVVNFUl9NT0RFLCAwKTsKPiArCj4gKwlyZXR1cm4g
c3RhdHVzOwo+ICt9Cj4gKwo+ICtzdGF0aWMgc3NpemVfdCBpdDY1MDVfYXV4X2RvX3RyYW5zZmVy
KHN0cnVjdCBpdDY1MDUgKml0NjUwNSwKPiArCQkJCSAgICAgIGVudW0gYXV4X2NtZF90eXBlIGNt
ZCwKPiArCQkJCSAgICAgIHVuc2lnbmVkIGludCBhZGRyZXNzLCB1OCAqYnVmZmVyLAo+ICsJCQkJ
ICAgICAgc2l6ZV90IHNpemUsIGVudW0gYXV4X2NtZF9yZXBseSAqcmVwbHkpCj4gK3sKPiArCWlu
dCBpLCByZXQsIHJldF9zaXplID0gMCwgcmVxdWVzdF9zaXplOwo+ICsKPiArCW11dGV4X2xvY2so
Jml0NjUwNS0+YXV4X2xvY2spOwo+ICsJZm9yIChpID0gMDsgaSA8IHNpemU7IGkgKz0gNCkgewo+
ICsJCXJlcXVlc3Rfc2l6ZSA9IG1pbigoaW50KXNpemUgLSBpLCA0KTsKPiArCQlyZXQgPSBpdDY1
MDVfYXV4X29wZXJhdGlvbihpdDY1MDUsIGNtZCwgYWRkcmVzcyArIGksCj4gKwkJCQkJICAgYnVm
ZmVyICsgaSwgcmVxdWVzdF9zaXplLCByZXBseSk7Cj4gKwkJaWYgKHJldCA8IDApIHsKPiArCQkJ
cmV0X3NpemUgPSByZXQ7Cj4gKwkJCWdvdG8gYXV4X29wX2VycjsKPiArCQl9Cj4gKwo+ICsJCXJl
dF9zaXplICs9ICByZXQ7Cj4gKwl9Cj4gK2F1eF9vcF9lcnI6Cj4gKwo+ICsJbXV0ZXhfdW5sb2Nr
KCZpdDY1MDUtPmF1eF9sb2NrKTsKPiArCXJldHVybiByZXRfc2l6ZTsKPiArfQo+ICsKPiArc3Rh
dGljIHNzaXplX3QgaXQ2NTA1X2F1eF90cmFuc2ZlcihzdHJ1Y3QgZHJtX2RwX2F1eCAqYXV4LAo+
ICsJCQkJICAgc3RydWN0IGRybV9kcF9hdXhfbXNnICptc2cpCj4gK3sKPiArCXN0cnVjdCBpdDY1
MDUgKml0NjUwNSA9IGNvbnRhaW5lcl9vZihhdXgsIHN0cnVjdCBpdDY1MDUsIGF1eCk7Cj4gKwl1
OCBjbWQ7Cj4gKwlib29sIGlzX2kyYyA9ICEobXNnLT5yZXF1ZXN0ICYgRFBfQVVYX05BVElWRV9X
UklURSk7Cj4gKwlpbnQgcmV0Owo+ICsJZW51bSBhdXhfY21kX3JlcGx5IHJlcGx5Owo+ICsKPiAr
CS8qIElUNjUwNSBkb2Vzbid0IHN1cHBvcnQgYXJiaXRyYXJ5IEkyQyByZWFkIC8gd3JpdGUuICov
Cj4gKwlpZiAoaXNfaTJjKQo+ICsJCXJldHVybiAtRUlOVkFMOwo+ICsKPiArCXN3aXRjaCAobXNn
LT5yZXF1ZXN0KSB7Cj4gKwljYXNlIERQX0FVWF9OQVRJVkVfUkVBRDoKPiArCQljbWQgPSBDTURf
QVVYX05BVElWRV9SRUFEOwo+ICsJCWJyZWFrOwo+ICsJY2FzZSBEUF9BVVhfTkFUSVZFX1dSSVRF
Ogo+ICsJCWNtZCA9IENNRF9BVVhfTkFUSVZFX1dSSVRFOwo+ICsJCWJyZWFrOwo+ICsJZGVmYXVs
dDoKPiArCQlyZXR1cm4gLUVJTlZBTDsKPiArCX0KPiArCj4gKwlyZXQgPSBpdDY1MDVfYXV4X2Rv
X3RyYW5zZmVyKGl0NjUwNSwgY21kLCBtc2ctPmFkZHJlc3MsIG1zZy0+YnVmZmVyLAo+ICsJCQkJ
ICAgICBtc2ctPnNpemUsICZyZXBseSk7Cj4gKwlpZiAocmV0IDwgMCkKPiArCQlyZXR1cm4gcmV0
Owo+ICsKPiArCXN3aXRjaCAocmVwbHkpIHsKPiArCWNhc2UgUkVQTFlfQUNLOgo+ICsJCW1zZy0+
cmVwbHkgPSBEUF9BVVhfTkFUSVZFX1JFUExZX0FDSzsKPiArCQlicmVhazsKPiArCWNhc2UgUkVQ
TFlfTkFDSzoKPiArCQltc2ctPnJlcGx5ID0gRFBfQVVYX05BVElWRV9SRVBMWV9OQUNLOwo+ICsJ
CWJyZWFrOwo+ICsJY2FzZSBSRVBMWV9ERUZFUjoKPiArCQltc2ctPnJlcGx5ID0gRFBfQVVYX05B
VElWRV9SRVBMWV9ERUZFUjsKPiArCQlicmVhazsKPiArCX0KPiArCj4gKwlyZXR1cm4gcmV0Owo+
ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGl0NjUwNV9nZXRfZWRpZF9ibG9jayh2b2lkICpkYXRhLCB1
OCAqYnVmLCB1bnNpZ25lZCBpbnQgYmxvY2ssCj4gKwkJCQkgc2l6ZV90IGxlbikKPiArewo+ICsJ
c3RydWN0IGl0NjUwNSAqaXQ2NTA1ID0gZGF0YTsKPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZp
dDY1MDUtPmNsaWVudC0+ZGV2Owo+ICsJZW51bSBhdXhfY21kX3JlcGx5IHJlcGx5Owo+ICsJaW50
IG9mZnNldCwgcmV0LCBhdXhfcmV0cnkgPSAxMDA7Cj4gKwo+ICsJaXQ2NTA1X2F1eF9yZXNldChp
dDY1MDUpOwo+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiYmxvY2sgbnVtYmVyID0gJWQi
LCBibG9jayk7Cj4gKwo+ICsJZm9yIChvZmZzZXQgPSAwOyBvZmZzZXQgPCBFRElEX0xFTkdUSDsp
IHsKPiArCQlyZXQgPSBpdDY1MDVfYXV4X2RvX3RyYW5zZmVyKGl0NjUwNSwgQ01EX0FVWF9JMkNf
RURJRF9SRUFELAo+ICsJCQkJCSAgICAgYmxvY2sgKiBFRElEX0xFTkdUSCArIG9mZnNldCwKPiAr
CQkJCQkgICAgIGJ1ZiArIG9mZnNldCwgOCwgJnJlcGx5KTsKPiArCj4gKwkJaWYgKHJldCA8IDAg
JiYgcmV0ICE9IC1FQUdBSU4pCj4gKwkJCXJldHVybiByZXQ7Cj4gKwo+ICsJCXN3aXRjaCAocmVw
bHkpIHsKPiArCQljYXNlIFJFUExZX0FDSzoKPiArCQkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2
LCAiWzB4JTAyeF06ICU4cGgiLCBvZmZzZXQsCj4gKwkJCQkJICAgICBidWYgKyBvZmZzZXQpOwo+
ICsJCQlvZmZzZXQgKz0gODsKPiArCQkJYXV4X3JldHJ5ID0gMTAwOwo+ICsJCQlicmVhazsKPiAr
CQljYXNlIFJFUExZX05BQ0s6Cj4gKwkJCXJldHVybiAtRUlPOwo+ICsJCWNhc2UgUkVQTFlfREVG
RVI6Cj4gKwkJCW1zbGVlcCgyMCk7Cj4gKwkJCWlmICghKC0tYXV4X3JldHJ5KSkKPiArCQkJCXJl
dHVybiAtRUlPOwo+ICsJCX0KPiArCX0KPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3Rh
dGljIHZvaWQgaXQ2NTA1X3ZhcmlhYmxlX2NvbmZpZyhzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUpCj4g
K3sKPiArCWl0NjUwNS0+bGlua19yYXRlX2J3X2NvZGUgPSBIQlI7Cj4gKwlpdDY1MDUtPmxhbmVf
Y291bnQgPSBNQVhfTEFORV9DT1VOVDsKPiArCWl0NjUwNS0+bGlua19zdGF0ZSA9IExJTktfSURM
RTsKPiArCWl0NjUwNS0+YXV0b190cmFpbl9yZXRyeSA9IEFVVE9fVFJBSU5fUkVUUlk7Cj4gKwlp
dDY1MDUtPmF1ZGlvLnNlbGVjdCA9IEFVRElPX1NFTEVDVDsKPiArCWl0NjUwNS0+YXVkaW8uc2Ft
cGxlX3JhdGUgPSBBVURJT19TQU1QTEVfUkFURTsKPiArCWl0NjUwNS0+YXVkaW8uY2hhbm5lbF9j
b3VudCA9IEFVRElPX0NIQU5ORUxfQ09VTlQ7Cj4gKwlpdDY1MDUtPmF1ZGlvLnR5cGUgPSBBVURJ
T19UWVBFOwo+ICsJaXQ2NTA1LT5hdWRpby5pMnNfaW5wdXRfZm9ybWF0ID0gSTJTX0lOUFVUX0ZP
Uk1BVDsKPiArCWl0NjUwNS0+YXVkaW8uaTJzX2p1c3RpZmllZCA9IEkyU19KVVNUSUZJRUQ7Cj4g
KwlpdDY1MDUtPmF1ZGlvLmkyc19kYXRhX2RlbGF5ID0gSTJTX0RBVEFfREVMQVk7Cj4gKwlpdDY1
MDUtPmF1ZGlvLmkyc193c19jaGFubmVsID0gSTJTX1dTX0NIQU5ORUw7Cj4gKwlpdDY1MDUtPmF1
ZGlvLmkyc19kYXRhX3NlcXVlbmNlID0gSTJTX0RBVEFfU0VRVUVOQ0U7Cj4gKwlpdDY1MDUtPmF1
ZGlvLndvcmRfbGVuZ3RoID0gQVVESU9fV09SRF9MRU5HVEg7Cj4gK30KPiArCj4gK3N0YXRpYyBp
bnQgaXQ2NTA1X3NlbmRfdmlkZW9faW5mb2ZyYW1lKHN0cnVjdCBpdDY1MDUgKml0NjUwNSwKPiAr
CQkJCSAgICAgICBzdHJ1Y3QgaGRtaV9hdmlfaW5mb2ZyYW1lICpmcmFtZSkKPiArewo+ICsJdTgg
YnVmZmVyW0hETUlfSU5GT0ZSQU1FX0hFQURFUl9TSVpFICsgSERNSV9BVklfSU5GT0ZSQU1FX1NJ
WkVdOwo+ICsJaW50IGVycjsKPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZpdDY1MDUtPmNsaWVu
dC0+ZGV2Owo+ICsKPiArCWVyciA9IGhkbWlfYXZpX2luZm9mcmFtZV9wYWNrKGZyYW1lLCBidWZm
ZXIsIHNpemVvZihidWZmZXIpKTsKPiArCWlmIChlcnIgPCAwKSB7Cj4gKwkJRFJNX0RFVl9FUlJP
UihkZXYsICJGYWlsZWQgdG8gcGFjayBBVkkgaW5mb2ZyYW1lOiAlZCIsIGVycik7Cj4gKwkJcmV0
dXJuIGVycjsKPiArCX0KPiArCj4gKwllcnIgPSBpdDY1MDVfc2V0X2JpdHMoaXQ2NTA1LCBSRUdf
SU5GT0ZSQU1FX0NUUkwsIEVOX0FWSV9QS1QsIDB4MDApOwo+ICsJaWYgKGVycikKPiArCQlyZXR1
cm4gZXJyOwo+ICsKPiArCWVyciA9IHJlZ21hcF9idWxrX3dyaXRlKGl0NjUwNS0+cmVnbWFwLCBS
RUdfQVZJX0lORk9fREIxLAo+ICsJCQkJYnVmZmVyICsgSERNSV9JTkZPRlJBTUVfSEVBREVSX1NJ
WkUsCj4gKwkJCQlmcmFtZS0+bGVuZ3RoKTsKPiArCWlmIChlcnIpCj4gKwkJcmV0dXJuIGVycjsK
PiArCj4gKwllcnIgPSBpdDY1MDVfc2V0X2JpdHMoaXQ2NTA1LCBSRUdfSU5GT0ZSQU1FX0NUUkws
IEVOX0FWSV9QS1QsCj4gKwkJCSAgICAgIEVOX0FWSV9QS1QpOwo+ICsJaWYgKGVycikKPiArCQly
ZXR1cm4gZXJyOwo+ICsKPiArCXJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBpdDY1
MDVfZ2V0X2V4dGNvbl9wcm9wZXJ0eShzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUpCj4gK3sKPiArCWlu
dCBlcnI7Cj4gKwl1bmlvbiBleHRjb25fcHJvcGVydHlfdmFsdWUgcHJvcGVydHk7Cj4gKwlzdHJ1
Y3QgZGV2aWNlICpkZXYgPSAmaXQ2NTA1LT5jbGllbnQtPmRldjsKPiArCj4gKwlpZiAoaXQ2NTA1
LT5leHRjb24gJiYgIWl0NjUwNS0+bGFuZV9zd2FwX2Rpc2FibGVkKSB7Cj4gKwkJZXJyID0gZXh0
Y29uX2dldF9wcm9wZXJ0eShpdDY1MDUtPmV4dGNvbiwgRVhUQ09OX0RJU1BfRFAsCj4gKwkJCQkJ
ICBFWFRDT05fUFJPUF9VU0JfVFlQRUNfUE9MQVJJVFksCj4gKwkJCQkJICAmcHJvcGVydHkpOwo+
ICsJCWlmIChlcnIpIHsKPiArCQkJRFJNX0RFVl9FUlJPUihkZXYsICJnZXQgcHJvcGVydHkgZmFp
bCEiKTsKPiArCQkJcmV0dXJuOwo+ICsJCX0KPiArCQlpdDY1MDUtPmxhbmVfc3dhcCA9IHByb3Bl
cnR5LmludHZhbDsKPiArCX0KPiArfQo+ICsKPiArc3RhdGljIHZvaWQgaXQ2NTA1X2Nsa19waGFz
ZV9hZGp1c3RtZW50KHN0cnVjdCBpdDY1MDUgKml0NjUwNSwKPiArCQkJCQljb25zdCBzdHJ1Y3Qg
ZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkKPiArewo+ICsJaXQ2NTA1X3NldF9iaXRzKGl0NjUwNSwg
UkVHX0NMS19DVFJMMCwgTV9QQ0xLX0RFTEFZLAo+ICsJCW1vZGUtPmNsb2NrIDwgQURKVVNUX1BI
QVNFX1RIUkVTSE9MRCA/IFBJWEVMX0NMS19ERUxBWSA6IDApOwo+ICsJaXQ2NTA1X3NldF9iaXRz
KGl0NjUwNSwgUkVHX0RBVEFfQ1RSTDAsIFZJREVPX0xBVENIX0VER0UsCj4gKwkJCVBJWEVMX0NM
S19JTlZFUlNFIDw8IDQpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBpdDY1MDVfaW5pdChzdHJ1
Y3QgaXQ2NTA1ICppdDY1MDUpCj4gK3sKPiArCWl0NjUwNV93cml0ZShpdDY1MDUsIFJFR19CQU5L
X1NFTCwgMHgwMCk7Cj4gKwlpdDY1MDVfd3JpdGUoaXQ2NTA1LCBSRUdfQVVYX09QVCwgQVVYX0FV
VE9fUlNUIHwgQVVYX0ZJWF9GUkVRKTsKPiArCWl0NjUwNV93cml0ZShpdDY1MDUsIFJFR19BVVhf
Q1RSTCwgQVVYX05PX1NFR01FTlRfV1IpOwo+ICsJaXQ2NTA1X3dyaXRlKGl0NjUwNSwgUkVHX0hE
Q1BfQ1RSTDIsIEhEQ1BfQU5fU0VMIHwgSERDUF9IV19IUERJUlFfQUNUKTsKPiArCWl0NjUwNV93
cml0ZShpdDY1MDUsIFJFR19WSURfQlVTX0NUUkwwLCBJTl9ERFIgfCBERFJfQ0QpOwo+ICsJaXQ2
NTA1X3dyaXRlKGl0NjUwNSwgUkVHX1ZJRF9CVVNfQ1RSTDEsIDB4MDEpOwo+ICsJaXQ2NTA1X3dy
aXRlKGl0NjUwNSwgUkVHX0FVRElPX0NUUkwwLCBBVURJT18xNkJfQk9VTkQpOwo+ICsKPiArCS8q
IGNoaXAgaW50ZXJuYWwgc2V0dGluZywgZG9uJ3QgbW9kaWZ5ICovCj4gKwlpdDY1MDVfd3JpdGUo
aXQ2NTA1LCBSRUdfSFBEX0lSUV9USU1FLCAweEY1KTsKPiArCWl0NjUwNV93cml0ZShpdDY1MDUs
IFJFR19BVVhfREVCVUdfTU9ERSwgMHg0RCk7Cj4gKwlpdDY1MDVfd3JpdGUoaXQ2NTA1LCBSRUdf
QVVYX09QVDIsIDB4MTcpOwo+ICsJaXQ2NTA1X3dyaXRlKGl0NjUwNSwgUkVHX0hEQ1BfT1BULCAw
eDYwKTsKPiArCWl0NjUwNV93cml0ZShpdDY1MDUsIFJFR19EQVRBX01VVEVfQ1RSTCwKPiArCQkg
ICAgIEVOX1ZJRF9NVVRFIHwgRU5fQVVEX01VVEUgfCBFTkFCTEVfQVVUT19WSURFT19GSUZPX1JF
U0VUKTsKPiArCWl0NjUwNV93cml0ZShpdDY1MDUsIFJFR19USU1FX1NUTVBfQ1RSTCwKPiArCQkg
ICAgIEVOX1NTQ19HQVQgfCBFTl9FTkhBTkNFX1ZJRF9TVE1QIHwgRU5fRU5IQU5DRV9BVURfU1RN
UCk7Cj4gKwlpdDY1MDVfd3JpdGUoaXQ2NTA1LCBSRUdfSU5GT0ZSQU1FX0NUUkwsIDB4MDApOwo+
ICsJaXQ2NTA1X3dyaXRlKGl0NjUwNSwgUkVHX0JBTktfU0VMLCAweDAxKTsKPiArCWl0NjUwNV93
cml0ZShpdDY1MDUsIFJFR19EUlZfMF9EQl84MDBfTVYsCj4gKwkJICAgICBhZmVfc2V0dGluZ190
YWJsZVtpdDY1MDUtPmFmZV9zZXR0aW5nXVswXSk7Cj4gKwlpdDY1MDVfd3JpdGUoaXQ2NTA1LCBS
RUdfUFJFXzBfREJfODAwX01WLAo+ICsJCSAgICAgYWZlX3NldHRpbmdfdGFibGVbaXQ2NTA1LT5h
ZmVfc2V0dGluZ11bMV0pOwo+ICsJaXQ2NTA1X3dyaXRlKGl0NjUwNSwgUkVHX1BSRV8zUDVfREJf
ODAwX01WLAo+ICsJCSAgICAgYWZlX3NldHRpbmdfdGFibGVbaXQ2NTA1LT5hZmVfc2V0dGluZ11b
Ml0pOwo+ICsJaXQ2NTA1X3dyaXRlKGl0NjUwNSwgUkVHX1NTQ19DVFJMMCwgMHg5RSk7Cj4gKwlp
dDY1MDVfd3JpdGUoaXQ2NTA1LCBSRUdfU1NDX0NUUkwxLCAweDFDKTsKPiArCWl0NjUwNV93cml0
ZShpdDY1MDUsIFJFR19TU0NfQ1RSTDIsIDB4NDIpOwo+ICsJaXQ2NTA1X3dyaXRlKGl0NjUwNSwg
UkVHX0JBTktfU0VMLCAweDAwKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgaXQ2NTA1X3ZpZGVv
X2Rpc2FibGUoc3RydWN0IGl0NjUwNSAqaXQ2NTA1KQo+ICt7Cj4gKwlpdDY1MDVfc2V0X2JpdHMo
aXQ2NTA1LCBSRUdfREFUQV9NVVRFX0NUUkwsIEVOX1ZJRF9NVVRFLCBFTl9WSURfTVVURSk7Cj4g
KwlpdDY1MDVfc2V0X2JpdHMoaXQ2NTA1LCBSRUdfSU5GT0ZSQU1FX0NUUkwsIEVOX1ZJRF9DVFJM
X1BLVCwgMHgwMCk7Cj4gKwlpdDY1MDVfc2V0X2JpdHMoaXQ2NTA1LCBSRUdfUkVTRVRfQ1RSTCwg
VklERU9fUkVTRVQsIFZJREVPX1JFU0VUKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgaXQ2NTA1
X3ZpZGVvX3Jlc2V0KHN0cnVjdCBpdDY1MDUgKml0NjUwNSkKPiArewo+ICsJaXQ2NTA1X3NldF9i
aXRzKGl0NjUwNSwgUkVHX0RBVEFfTVVURV9DVFJMLCBFTl9WSURfTVVURSwgRU5fVklEX01VVEUp
Owo+ICsJaXQ2NTA1X3NldF9iaXRzKGl0NjUwNSwgUkVHX0lORk9GUkFNRV9DVFJMLCBFTl9WSURf
Q1RSTF9QS1QsIDB4MDApOwo+ICsJaXQ2NTA1X3NldF9iaXRzKGl0NjUwNSwgUkVHX1JFU0VUX0NU
UkwsIFZJREVPX1JFU0VULCBWSURFT19SRVNFVCk7Cj4gKwlpdDY1MDVfc2V0X2JpdHMoaXQ2NTA1
LCBSRUdfNTAxX0ZJRk9fQ1RSTCwgUlNUXzUwMV9GSUZPLCBSU1RfNTAxX0ZJRk8pOwo+ICsJaXQ2
NTA1X3NldF9iaXRzKGl0NjUwNSwgUkVHXzUwMV9GSUZPX0NUUkwsIFJTVF81MDFfRklGTywgMHgw
MCk7Cj4gKwlpdDY1MDVfc2V0X2JpdHMoaXQ2NTA1LCBSRUdfUkVTRVRfQ1RSTCwgVklERU9fUkVT
RVQsIDB4MDApOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBpdDY1MDVfdXBkYXRlX3ZpZGVvX3By
YXJtZXRlcihzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUsCj4gKwkJCQkJICBjb25zdCBzdHJ1Y3QgZHJt
X2Rpc3BsYXlfbW9kZSAqbW9kZSkKPiArewo+ICsJaXQ2NTA1X2Nsa19waGFzZV9hZGp1c3RtZW50
KGl0NjUwNSwgbW9kZSk7Cj4gKwlpdDY1MDVfdmlkZW9fZGlzYWJsZShpdDY1MDUpOwo+ICt9Cj4g
Kwo+ICtzdGF0aWMgYm9vbCBpdDY1MDVfYXVkaW9faW5wdXQoc3RydWN0IGl0NjUwNSAqaXQ2NTA1
KQo+ICt7Cj4gKwlpbnQgcmVnMDUsIHJlZ2JlOwo+ICsKPiArCXJlZzA1ID0gaXQ2NTA1X3JlYWQo
aXQ2NTA1LCBSRUdfUkVTRVRfQ1RSTCk7Cj4gKwlpdDY1MDVfc2V0X2JpdHMoaXQ2NTA1LCBSRUdf
UkVTRVRfQ1RSTCwgQVVESU9fUkVTRVQsIDB4MDApOwo+ICsJdXNsZWVwX3JhbmdlKDMwMDAsIDQw
MDApOwo+ICsJcmVnYmUgPSBpdDY1MDVfcmVhZChpdDY1MDUsIFJFR19BVURJT19JTlBVVF9GUkVR
KTsKPiArCWl0NjUwNV93cml0ZShpdDY1MDUsIFJFR19SRVNFVF9DVFJMLCByZWcwNSk7Cj4gKwo+
ICsJcmV0dXJuIHJlZ2JlICE9IDB4RkY7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGl0NjUwNV9z
ZXR1cF9hdWRpb19jaGFubmVsX3N0YXR1cyhzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUpCj4gK3sKPiAr
CWVudW0gaXQ2NTA1X2F1ZGlvX3NhbXBsZV9yYXRlIHNhbXBsZV9yYXRlID0gaXQ2NTA1LT5hdWRp
by5zYW1wbGVfcmF0ZTsKPiArCXU4IGF1ZGlvX3dvcmRfbGVuZ3RoX21hcFtdID0gezB4MDIsIDB4
MDQsIDB4MDMsIDB4MEJ9Owo+ICsKPiArCS8qIENoYW5uZWwgU3RhdHVzICovCj4gKwlpdDY1MDVf
d3JpdGUoaXQ2NTA1LCBSRUdfSUVDOTU4X1NUUzAsIGl0NjUwNS0+YXVkaW8udHlwZSA8PCAxKTsK
PiArCWl0NjUwNV93cml0ZShpdDY1MDUsIFJFR19JRUM5NThfU1RTMSwgMHgwMCk7Cj4gKwlpdDY1
MDVfd3JpdGUoaXQ2NTA1LCBSRUdfSUVDOTU4X1NUUzIsIDB4MDApOwo+ICsJaXQ2NTA1X3dyaXRl
KGl0NjUwNSwgUkVHX0lFQzk1OF9TVFMzLCBzYW1wbGVfcmF0ZSk7Cj4gKwlpdDY1MDVfd3JpdGUo
aXQ2NTA1LCBSRUdfSUVDOTU4X1NUUzQsICh+c2FtcGxlX3JhdGUgPDwgNCkgfAo+ICsJCSAgICAg
YXVkaW9fd29yZF9sZW5ndGhfbWFwW2l0NjUwNS0+YXVkaW8ud29yZF9sZW5ndGhdKTsKPiArfQo+
ICsKPiArc3RhdGljIHZvaWQgaXQ2NTA1X3NldHVwX2F1ZGlvX2Zvcm1hdChzdHJ1Y3QgaXQ2NTA1
ICppdDY1MDUpCj4gK3sKPiArCS8qIEkyUyBNT0RFICovCj4gKwlpdDY1MDVfd3JpdGUoaXQ2NTA1
LCBSRUdfQVVESU9fRk1ULAo+ICsJCSAgICAgKGl0NjUwNS0+YXVkaW8ud29yZF9sZW5ndGggPDwg
NSkgfAo+ICsJCSAgICAgKGl0NjUwNS0+YXVkaW8uaTJzX2RhdGFfc2VxdWVuY2UgPDwgNCkgfAo+
ICsJCSAgICAgKGl0NjUwNS0+YXVkaW8uaTJzX3dzX2NoYW5uZWwgPDwgMykgfAo+ICsJCSAgICAg
KGl0NjUwNS0+YXVkaW8uaTJzX2RhdGFfZGVsYXkgPDwgMikgfAo+ICsJCSAgICAgKGl0NjUwNS0+
YXVkaW8uaTJzX2p1c3RpZmllZCA8PCAxKSB8Cj4gKwkJICAgICBpdDY1MDUtPmF1ZGlvLmkyc19p
bnB1dF9mb3JtYXQpOwo+ICsJaWYgKGl0NjUwNS0+YXVkaW8uc2VsZWN0ID09IFNQRElGKSB7Cj4g
KwkJaXQ2NTA1X3dyaXRlKGl0NjUwNSwgUkVHX0FVRElPX0ZJRk9fU0VMLCAweDAwKTsKPiArCQkv
KiAweDMwID0gMTI4KkZTICovCj4gKwkJaXQ2NTA1X3NldF9iaXRzKGl0NjUwNSwgUkVHX0FVWF9P
UFQsIDB4RjAsIDB4MzApOwo+ICsJfSBlbHNlIHsKPiArCQlpdDY1MDVfd3JpdGUoaXQ2NTA1LCBS
RUdfQVVESU9fRklGT19TRUwsIDB4RTQpOwo+ICsJfQo+ICsKPiArCWl0NjUwNV93cml0ZShpdDY1
MDUsIFJFR19BVURJT19DVFJMMCwgMHgyMCk7Cj4gKwlpdDY1MDVfd3JpdGUoaXQ2NTA1LCBSRUdf
QVVESU9fQ1RSTDEsIDB4MDApOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBpdDY1MDVfZW5hYmxl
X2F1ZGlvX3NvdXJjZShzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUpCj4gK3sKPiArCXVuc2lnbmVkIGlu
dCBhdWRpb19zb3VyY2VfY291bnQ7Cj4gKwo+ICsJYXVkaW9fc291cmNlX2NvdW50ID0gQklUKERJ
Vl9ST1VORF9VUChpdDY1MDUtPmF1ZGlvLmNoYW5uZWxfY291bnQsIDIpKQo+ICsJCQkJIC0gMTsK
PiArCj4gKwlhdWRpb19zb3VyY2VfY291bnQgfD0gaXQ2NTA1LT5hdWRpby5zZWxlY3QgPDwgNDsK
PiArCj4gKwlpdDY1MDVfd3JpdGUoaXQ2NTA1LCBSRUdfQVVESU9fU1JDX0NUUkwsIGF1ZGlvX3Nv
dXJjZV9jb3VudCk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGl0NjUwNV9lbmFibGVfYXVkaW9f
aW5mb2ZyYW1lKHN0cnVjdCBpdDY1MDUgKml0NjUwNSkKPiArewo+ICsJc3RydWN0IGRldmljZSAq
ZGV2ID0gJml0NjUwNS0+Y2xpZW50LT5kZXY7Cj4gKwl1OCBhdWRpb19pbmZvX2NhW10gPSB7IDB4
MDAsIDB4MDAsIDB4MDEsIDB4MDMsIDB4MDcsIDB4MEIsIDB4MEYsIDB4MUYgfTsKPiArCj4gKwlE
Uk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJpbmZvZnJhbWUgY2hhbm5lbF9hbGxvY2F0aW9uOjB4
JTAyeCIsCj4gKwkJCSAgICAgYXVkaW9faW5mb19jYVtpdDY1MDUtPmF1ZGlvLmNoYW5uZWxfY291
bnQgLSAxXSk7Cj4gKwo+ICsJaXQ2NTA1X3dyaXRlKGl0NjUwNSwgUkVHX0FVRF9JTkZPRlJBTV9E
QjEsIGl0NjUwNS0+YXVkaW8uY2hhbm5lbF9jb3VudAo+ICsJCSAgICAgLSAxKTsKPiArCWl0NjUw
NV93cml0ZShpdDY1MDUsIFJFR19BVURfSU5GT0ZSQU1fREIyLCAweDAwKTsKPiArCWl0NjUwNV93
cml0ZShpdDY1MDUsIFJFR19BVURfSU5GT0ZSQU1fREIzLAo+ICsJCSAgICAgYXVkaW9faW5mb19j
YVtpdDY1MDUtPmF1ZGlvLmNoYW5uZWxfY291bnQgLSAxXSk7Cj4gKwlpdDY1MDVfd3JpdGUoaXQ2
NTA1LCBSRUdfQVVEX0lORk9GUkFNX0RCNCwgMHgwMCk7Cj4gKwlpdDY1MDVfd3JpdGUoaXQ2NTA1
LCBSRUdfQVVEX0lORk9GUkFNX1NVTSwgMHgwMCk7Cj4gKwo+ICsJLyogRW5hYmxlIEF1ZGlvIElu
Zm9GcmFtZSAqLwo+ICsJaXQ2NTA1X3NldF9iaXRzKGl0NjUwNSwgUkVHX0lORk9GUkFNRV9DVFJM
LCBFTl9BVURfQ1RSTF9QS1QsCj4gKwkJCUVOX0FVRF9DVFJMX1BLVCk7Cj4gK30KPiArCj4gK3N0
YXRpYyB2b2lkIGl0NjUwNV9kaXNhYmxlX2F1ZGlvKHN0cnVjdCBpdDY1MDUgKml0NjUwNSkKPiAr
ewo+ICsJaXQ2NTA1X3NldF9iaXRzKGl0NjUwNSwgUkVHX0RBVEFfTVVURV9DVFJMLCBFTl9BVURf
TVVURSwgRU5fQVVEX01VVEUpOwo+ICsJaXQ2NTA1X3NldF9iaXRzKGl0NjUwNSwgUkVHX0FVRElP
X1NSQ19DVFJMLCBNX0FVRElPX0kyU19FTiwgMHgwMCk7Cj4gKwlpdDY1MDVfc2V0X2JpdHMoaXQ2
NTA1LCBSRUdfSU5GT0ZSQU1FX0NUUkwsIEVOX0FVRF9DVFJMX1BLVCwgMHgwMCk7Cj4gKwlpdDY1
MDVfc2V0X2JpdHMoaXQ2NTA1LCBSRUdfUkVTRVRfQ1RSTCwgQVVESU9fUkVTRVQsIEFVRElPX1JF
U0VUKTsKPiArCWl0NjUwNS0+ZW5hYmxlX2F1ZGlvID0gZmFsc2U7Cj4gK30KPiArCj4gK3N0YXRp
YyB2b2lkIGl0NjUwNV9lbmFibGVfYXVkaW8oc3RydWN0IGl0NjUwNSAqaXQ2NTA1KQo+ICt7Cj4g
KwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmaXQ2NTA1LT5jbGllbnQtPmRldjsKPiArCWludCByZWdi
ZTsKPiArCj4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJzdGFydCIpOwo+ICsJaXQ2NTA1
X2Rpc2FibGVfYXVkaW8oaXQ2NTA1KTsKPiArCj4gKwlpdDY1MDVfc2V0dXBfYXVkaW9fY2hhbm5l
bF9zdGF0dXMoaXQ2NTA1KTsKPiArCWl0NjUwNV9zZXR1cF9hdWRpb19mb3JtYXQoaXQ2NTA1KTsK
PiArCWl0NjUwNV9lbmFibGVfYXVkaW9fc291cmNlKGl0NjUwNSk7Cj4gKwlpdDY1MDVfZW5hYmxl
X2F1ZGlvX2luZm9mcmFtZShpdDY1MDUpOwo+ICsKPiArCWl0NjUwNV93cml0ZShpdDY1MDUsIFJF
R19BVURJT19OXzBfNywgMHgwMCk7Cj4gKwlpdDY1MDVfd3JpdGUoaXQ2NTA1LCBSRUdfQVVESU9f
Tl84XzE1LCAweDgwKTsKPiArCWl0NjUwNV93cml0ZShpdDY1MDUsIFJFR19BVURJT19OXzE2XzIz
LCAweDAwKTsKPiArCj4gKwlpdDY1MDVfc2V0X2JpdHMoaXQ2NTA1LCBSRUdfQVVESU9fU1JDX0NU
UkwsIEFVRElPX0ZJRk9fUkVTRVQsCj4gKwkJCUFVRElPX0ZJRk9fUkVTRVQpOwo+ICsJaXQ2NTA1
X3NldF9iaXRzKGl0NjUwNSwgUkVHX0FVRElPX1NSQ19DVFJMLCBBVURJT19GSUZPX1JFU0VULCAw
eDAwKTsKPiArCWl0NjUwNV9zZXRfYml0cyhpdDY1MDUsIFJFR19SRVNFVF9DVFJMLCBBVURJT19S
RVNFVCwgMHgwMCk7Cj4gKwlyZWdiZSA9IGl0NjUwNV9yZWFkKGl0NjUwNSwgUkVHX0FVRElPX0lO
UFVUX0ZSRVEpOwo+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAicmVnYmU6MHglMDJ4IGF1
ZGlvIGlucHV0IGZzOiAlZC4lZCBrSHoiLAo+ICsJCQkgICAgIHJlZ2JlLCA2NzUwIC8gcmVnYmUs
IDY3NTAwICUgcmVnYmUpOwo+ICsJaXQ2NTA1X3NldF9iaXRzKGl0NjUwNSwgUkVHX0RBVEFfTVVU
RV9DVFJMLCBFTl9BVURfTVVURSwgMHgwMCk7Cj4gK30KPiArCj4gK3N0YXRpYyBib29sIGl0NjUw
NV91c2Vfc3RlcF90cmFpbl9jaGVjayhzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUpCj4gK3sKPiArCWlm
IChpdDY1MDUtPmxpbmsucmV2aXNpb24gPj0gMHgxMikKPiArCQlyZXR1cm4gaXQ2NTA1LT5kcGNk
W0RQX1RSQUlOSU5HX0FVWF9SRF9JTlRFUlZBTF0gPj0gMHgwMTsKPiArCj4gKwlyZXR1cm4gdHJ1
ZTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgaXQ2NTA1X3BhcnNlX2xpbmtfY2FwYWJpbGl0aWVz
KHN0cnVjdCBpdDY1MDUgKml0NjUwNSkKPiArewo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJml0
NjUwNS0+Y2xpZW50LT5kZXY7Cj4gKwlzdHJ1Y3QgaXQ2NTA1X2RybV9kcF9saW5rICpsaW5rID0g
Jml0NjUwNS0+bGluazsKPiArCWludCBiY2FwczsKPiArCj4gKwlpZiAoaXQ2NTA1LT5kcGNkWzBd
ID09IDApIHsKPiArCQlpdDY1MDVfYXV4X29uKGl0NjUwNSk7Cj4gKwkJaXQ2NTA1X2dldF9kcGNk
KGl0NjUwNSwgRFBfRFBDRF9SRVYsIGl0NjUwNS0+ZHBjZCwKPiArCQkJCUFSUkFZX1NJWkUoaXQ2
NTA1LT5kcGNkKSk7Cj4gKwl9Cj4gKwo+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiRFBD
RCBSZXYuOiAlZC4lZCIsCj4gKwkJCSAgICAgbGluay0+cmV2aXNpb24gPj4gNCwgbGluay0+cmV2
aXNpb24gJiAweDBGKTsKPiArCj4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJTaW5rIG1h
eCBsaW5rIHJhdGU6ICVkLiVkIEdicHMgcGVyIGxhbmUiLAo+ICsJCQkgICAgIGxpbmstPnJhdGUg
LyAxMDAwMDAsIGxpbmstPnJhdGUgLyAxMDAwICUgMTAwKTsKPiArCj4gKwlpdDY1MDUtPmxpbmtf
cmF0ZV9id19jb2RlID0gZHJtX2RwX2xpbmtfcmF0ZV90b19id19jb2RlKGxpbmstPnJhdGUpOwo+
ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAibGluayByYXRlIGJ3IGNvZGU6MHglMDJ4IiwK
PiArCQkJICAgICBpdDY1MDUtPmxpbmtfcmF0ZV9id19jb2RlKTsKPiArCWl0NjUwNS0+bGlua19y
YXRlX2J3X2NvZGUgPSBtaW4oKGludClpdDY1MDUtPmxpbmtfcmF0ZV9id19jb2RlLAo+ICsJCQkJ
CU1BWF9MSU5LX1JBVEUpOwo+ICsKPiArCWl0NjUwNS0+bGFuZV9jb3VudCA9IGxpbmstPm51bV9s
YW5lczsKPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIlNpbmsgc3VwcG9ydCAlZCBsYW5l
cyB0cmFpbmluZyIsCj4gKwkJCSAgICAgaXQ2NTA1LT5sYW5lX2NvdW50KTsKPiArCWl0NjUwNS0+
bGFuZV9jb3VudCA9IG1pbigoaW50KWl0NjUwNS0+bGFuZV9jb3VudCwgTUFYX0xBTkVfQ09VTlQp
Owo+ICsKPiArCWl0NjUwNS0+YnJhbmNoX2RldmljZSA9IGRybV9kcF9pc19icmFuY2goaXQ2NTA1
LT5kcGNkKTsKPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIlNpbmsgJXNicmFuY2ggZGV2
aWNlIiwKPiArCQkJICAgICBpdDY1MDUtPmJyYW5jaF9kZXZpY2UgPyAiIiA6ICJOb3QgIik7Cj4g
Kwo+ICsJaXQ2NTA1LT5lbmFibGVfZW5oYW5jZWRfZnJhbWUgPSAhIWxpbmstPmNhcGFiaWxpdGll
czsKPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIlNpbmsgJXNTdXBwb3J0IEVuaGFuY2Vk
IEZyYW1pbmciLAo+ICsJCQkgICAgIGl0NjUwNS0+ZW5hYmxlX2VuaGFuY2VkX2ZyYW1lID8gIiIg
OiAiTm90ICIpOwo+ICsKPiArCWl0NjUwNS0+ZW5hYmxlX3NzYyA9ICEhKGl0NjUwNS0+ZHBjZFtE
UF9NQVhfRE9XTlNQUkVBRF0gJgo+ICsJCQkJRFBfTUFYX0RPV05TUFJFQURfMF81KTsKPiArCURS
TV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIk1heGltdW0gRG93bi1TcHJlYWQ6ICVzLCAlc3N1cHBv
cnQgU1NDISIsCj4gKwkJCSAgICAgaXQ2NTA1LT5lbmFibGVfc3NjID8gIjAuNSIgOiAiMCIsCj4g
KwkJCSAgICAgaXQ2NTA1LT5lbmFibGVfc3NjID8gIiIgOiAiTm90ICIpOwo+ICsKPiArCWl0NjUw
NS0+c3RlcF90cmFpbiA9IGl0NjUwNV91c2Vfc3RlcF90cmFpbl9jaGVjayhpdDY1MDUpOwo+ICsJ
aWYgKGl0NjUwNS0+c3RlcF90cmFpbikKPiArCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJh
dXRvIHRyYWluIGZhaWwsIHdpbGwgc3RlcCB0cmFpbiIpOwo+ICsKPiArCWJjYXBzID0gaXQ2NTA1
X2RwY2RfcmVhZChpdDY1MDUsIERQX0FVWF9IRENQX0JDQVBTKTsKPiArCURSTV9ERVZfREVCVUdf
RFJJVkVSKGRldiwgImJjYXBzOjB4JTAyeCIsIGJjYXBzKTsKPiArCWlmIChiY2FwcyAmIERQX0JD
QVBTX0hEQ1BfQ0FQQUJMRSkgewo+ICsJCWl0NjUwNS0+aXNfcmVwZWF0ZXIgPSAhIShiY2FwcyAm
IERQX0JDQVBTX1JFUEVBVEVSX1BSRVNFTlQpOwo+ICsJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRl
diwgIlN1cHBvcnQgSERDUCEgRG93bnN0cmVhbSBpcyAlcyEiLAo+ICsJCQkJICAgICBpdDY1MDUt
PmlzX3JlcGVhdGVyID8gInJlcGVhdGVyIiA6Cj4gKwkJCQkgICAgICJyZWNlaXZlciIpOwo+ICsJ
fSBlbHNlIHsKPiArCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJTaW5rIG5vdCBzdXBwb3J0
IEhEQ1AhIik7Cj4gKwl9Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGl0NjUwNV9zZXR1cF9zc2Mo
c3RydWN0IGl0NjUwNSAqaXQ2NTA1KQo+ICt7Cj4gKwlpdDY1MDVfc2V0X2JpdHMoaXQ2NTA1LCBS
RUdfVFJBSU5fQ1RSTDAsIFNQUkVBRF9BTVBfNSwKPiArCQkJaXQ2NTA1LT5lbmFibGVfc3NjID8g
U1BSRUFEX0FNUF81IDogMHgwMCk7Cj4gKwlpZiAoaXQ2NTA1LT5lbmFibGVfc3NjKSB7Cj4gKwkJ
aXQ2NTA1X3dyaXRlKGl0NjUwNSwgUkVHX0JBTktfU0VMLCAweDAxKTsKPiArCQlpdDY1MDVfd3Jp
dGUoaXQ2NTA1LCBSRUdfU1NDX0NUUkwwLCAweDlFKTsKPiArCQlpdDY1MDVfd3JpdGUoaXQ2NTA1
LCBSRUdfU1NDX0NUUkwxLCAweDFDKTsKPiArCQlpdDY1MDVfd3JpdGUoaXQ2NTA1LCBSRUdfU1ND
X0NUUkwyLCAweDQyKTsKPiArCQlpdDY1MDVfd3JpdGUoaXQ2NTA1LCBSRUdfQkFOS19TRUwsIDB4
MDApOwo+ICsJCWl0NjUwNV93cml0ZShpdDY1MDUsIFJFR19TUF9DVFJMMCwgMHgwNyk7Cj4gKwkJ
aXQ2NTA1X3dyaXRlKGl0NjUwNSwgUkVHX0lQX0NUUkwxLCAweDI5KTsKPiArCQlpdDY1MDVfd3Jp
dGUoaXQ2NTA1LCBSRUdfSVBfQ1RSTDIsIDB4MDMpOwo+ICsJCS8qIFN0YW1wIEludGVycnVwdCBT
dGVwICovCj4gKwkJaXQ2NTA1X3NldF9iaXRzKGl0NjUwNSwgUkVHX1RJTUVfU1RNUF9DVFJMLCBN
X1NUQU1QX1NURVAsCj4gKwkJCQkweDEwKTsKPiArCQlpdDY1MDVfZHBjZF93cml0ZShpdDY1MDUs
IERQX0RPV05TUFJFQURfQ1RSTCwKPiArCQkJCSAgRFBfU1BSRUFEX0FNUF8wXzUpOwo+ICsJfSBl
bHNlIHsKPiArCQlpdDY1MDVfZHBjZF93cml0ZShpdDY1MDUsIERQX0RPV05TUFJFQURfQ1RSTCwg
MHgwMCk7Cj4gKwkJaXQ2NTA1X3NldF9iaXRzKGl0NjUwNSwgUkVHX1RJTUVfU1RNUF9DVFJMLCBN
X1NUQU1QX1NURVAsCj4gKwkJCQkweDAwKTsKPiArCX0KPiArfQo+ICsKPiArc3RhdGljIGlubGlu
ZSB2b2lkIGl0NjUwNV9saW5rX3JhdGVfc2V0dXAoc3RydWN0IGl0NjUwNSAqaXQ2NTA1KQo+ICt7
Cj4gKwlpdDY1MDVfc2V0X2JpdHMoaXQ2NTA1LCBSRUdfVFJBSU5fQ1RSTDAsIEZPUkNFX0xCUiwK
PiArCQkJKGl0NjUwNS0+bGlua19yYXRlX2J3X2NvZGUgPT0gUkJSKSA/IEZPUkNFX0xCUiA6IDB4
MDApOwo+ICsJaXQ2NTA1X3NldF9iaXRzKGl0NjUwNSwgUkVHX0xJTktfRFJWLCBEUlZfSFMsCj4g
KwkJCShpdDY1MDUtPmxpbmtfcmF0ZV9id19jb2RlID09IFJCUikgPyAweDAwIDogRFJWX0hTKTsK
PiArfQo+ICsKPiArc3RhdGljIHZvaWQgaXQ2NTA1X2xhbmVfY291bnRfc2V0dXAoc3RydWN0IGl0
NjUwNSAqaXQ2NTA1KQo+ICt7Cj4gKwlpdDY1MDVfZ2V0X2V4dGNvbl9wcm9wZXJ0eShpdDY1MDUp
Owo+ICsJaXQ2NTA1X3NldF9iaXRzKGl0NjUwNSwgUkVHX1RSQUlOX0NUUkwwLCBMQU5FX1NXQVAs
Cj4gKwkJCWl0NjUwNS0+bGFuZV9zd2FwID8gTEFORV9TV0FQIDogMHgwMCk7Cj4gKwlpdDY1MDVf
c2V0X2JpdHMoaXQ2NTA1LCBSRUdfVFJBSU5fQ1RSTDAsIExBTkVfQ09VTlRfTUFTSywKPiArCQkJ
KGl0NjUwNS0+bGFuZV9jb3VudCAtIDEpIDw8IDEpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBp
dDY1MDVfbGlua190cmFpbmluZ19zZXR1cChzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUpCj4gK3sKPiAr
CXN0cnVjdCBkZXZpY2UgKmRldiA9ICZpdDY1MDUtPmNsaWVudC0+ZGV2Owo+ICsKPiArCWlmIChp
dDY1MDUtPmVuYWJsZV9lbmhhbmNlZF9mcmFtZSkKPiArCQlpdDY1MDVfc2V0X2JpdHMoaXQ2NTA1
LCBSRUdfREFUQV9NVVRFX0NUUkwsCj4gKwkJCQlFTkFCTEVfRU5IQU5DRURfRlJBTUUsIEVOQUJM
RV9FTkhBTkNFRF9GUkFNRSk7Cj4gKwo+ICsJaXQ2NTA1X2xpbmtfcmF0ZV9zZXR1cChpdDY1MDUp
Owo+ICsJaXQ2NTA1X2xhbmVfY291bnRfc2V0dXAoaXQ2NTA1KTsKPiArCWl0NjUwNV9zZXR1cF9z
c2MoaXQ2NTA1KTsKPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwKPiArCQkJICAgICAiJXMs
ICVkIGxhbmVzLCAlc2FibGUgc3NjLCAlc2FibGUgZW5oYW5jZWQgZnJhbWUiLAo+ICsJCQkgICAg
IGl0NjUwNS0+bGlua19yYXRlX2J3X2NvZGUgIT0gUkJSID8gIkhCUiIgOiAiUkJSIiwKPiArCQkJ
ICAgICBpdDY1MDUtPmxhbmVfY291bnQsCj4gKwkJCSAgICAgaXQ2NTA1LT5lbmFibGVfc3NjID8g
ImVuIiA6ICJkaXMiLAo+ICsJCQkgICAgIGl0NjUwNS0+ZW5hYmxlX2VuaGFuY2VkX2ZyYW1lID8g
ImVuIiA6ICJkaXMiKTsKPiArfQo+ICsKPiArc3RhdGljIGJvb2wgaXQ2NTA1X2xpbmtfc3RhcnRf
YXV0b190cmFpbihzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUpCj4gK3sKPiArCWludCB0aW1lb3V0ID0g
NTAwLCBsaW5rX3RyYWluaW5nX3N0YXRlOwo+ICsKPiArCWl0NjUwNV9zZXRfYml0cyhpdDY1MDUs
IFJFR19UUkFJTl9DVFJMMCwKPiArCQkJCUZPUkNFX0NSX0RPTkUgfCBGT1JDRV9FUV9ET05FLCAw
eDAwKTsKPiArCWl0NjUwNV93cml0ZShpdDY1MDUsIFJFR19UUkFJTl9DVFJMMSwgRk9SQ0VfUkVU
UkFJTik7Cj4gKwlpdDY1MDVfd3JpdGUoaXQ2NTA1LCBSRUdfVFJBSU5fQ1RSTDEsIEFVVE9fVFJB
SU4pOwo+ICsKPiArCXdoaWxlICh0aW1lb3V0ID4gMCkgewo+ICsJCXVzbGVlcF9yYW5nZSgxMDAw
LCAyMDAwKTsKPiArCQlsaW5rX3RyYWluaW5nX3N0YXRlID0gaXQ2NTA1X3JlYWQoaXQ2NTA1LCBS
RUdfTElOS19UUkFJTl9TVFMpOwo+ICsKPiArCQlpZiAoKGxpbmtfdHJhaW5pbmdfc3RhdGUgPiAw
KSAmJgo+ICsJCSAgICAobGlua190cmFpbmluZ19zdGF0ZSAmIExJTktfU1RBVEVfTk9SUCkpCj4g
KwkJCXJldHVybiB0cnVlOwo+ICsKPiArCQl0aW1lb3V0LS07Cj4gKwl9Cj4gKwo+ICsJcmV0dXJu
IGZhbHNlOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGl0NjUwNV9kcm1fZHBfbGlua19jb25maWd1
cmUoc3RydWN0IGl0NjUwNSAqaXQ2NTA1KQo+ICt7Cj4gKwl1OCB2YWx1ZXNbMl07Cj4gKwlpbnQg
ZXJyOwo+ICsJc3RydWN0IGRybV9kcF9hdXggKmF1eCA9ICZpdDY1MDUtPmF1eDsKPiArCj4gKwl2
YWx1ZXNbMF0gPSBpdDY1MDUtPmxpbmtfcmF0ZV9id19jb2RlOwo+ICsJdmFsdWVzWzFdID0gaXQ2
NTA1LT5sYW5lX2NvdW50Owo+ICsKPiArCWlmIChpdDY1MDUtPmVuYWJsZV9lbmhhbmNlZF9mcmFt
ZSkKPiArCQl2YWx1ZXNbMV0gfD0gRFBfTEFORV9DT1VOVF9FTkhBTkNFRF9GUkFNRV9FTjsKPiAr
Cj4gKwllcnIgPSBkcm1fZHBfZHBjZF93cml0ZShhdXgsIERQX0xJTktfQldfU0VULCB2YWx1ZXMs
IHNpemVvZih2YWx1ZXMpKTsKPiArCWlmIChlcnIgPCAwKQo+ICsJCXJldHVybiBlcnI7Cj4gKwo+
ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyB1OCBkcF9saW5rX3N0YXR1cyhjb25zdCB1
OCBsaW5rX3N0YXR1c1tEUF9MSU5LX1NUQVRVU19TSVpFXSwgaW50IHIpCj4gK3sKPiArCXJldHVy
biBsaW5rX3N0YXR1c1tyIC0gRFBfTEFORTBfMV9TVEFUVVNdOwo+ICt9Cj4gKwo+ICtzdGF0aWMg
Ym9vbCBpdDY1MDVfY2hlY2tfbWF4X3ZhbHVlKGVudW0gbWF4X3ZhbHVlX2NoZWNrIHR5cGUsCj4g
KwkJCQkgICB1OCBsYW5lX3ZvbHRhZ2Vfc3dpbmdfcHJlX2VtcGhhc2lzKQo+ICt7Cj4gKwlpZiAo
dHlwZSA9PSBWT0xUQUdFX1NXSU5HKQo+ICsJCXJldHVybiAoKGxhbmVfdm9sdGFnZV9zd2luZ19w
cmVfZW1waGFzaXMgJiAweDAzKSA9PQo+ICsJCQlNQVhfQ1JfTEVWRUwpOwo+ICsJZWxzZQo+ICsJ
CXJldHVybiAoKGxhbmVfdm9sdGFnZV9zd2luZ19wcmVfZW1waGFzaXMgJiAweDAzKSA9PQo+ICsJ
CQlNQVhfRVFfTEVWRUwpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgYm9vbCBpdDY1MDVfY2hlY2tfbWF4
X3ZvbHRhZ2Vfc3dpbmdfcmVhY2hlZCh1OCAqbGFuZV92b2x0YWdlX3N3aW5nLAo+ICsJCQkJCQkg
ICB1OCBsYW5lX2NvdW50KQo+ICt7Cj4gKwl1OCBpOwo+ICsKPiArCWZvciAoaSA9IDA7IGkgPCBs
YW5lX2NvdW50OyBpKyspIHsKPiArCQlpZiAobGFuZV92b2x0YWdlX3N3aW5nW2ldICYgRFBfVFJB
SU5fTUFYX1NXSU5HX1JFQUNIRUQpCj4gKwkJCXJldHVybiB0cnVlOwo+ICsJfQo+ICsKPiArCXJl
dHVybiBmYWxzZTsKPiArfQo+ICsKPiArc3RhdGljIGJvb2wgaXQ2NTA1X3N0ZXBfdHJhaW5fbGFu
ZV92b2x0YWdlX3ByZV9lbXBoYXNpc19zZXQoCj4gKwlzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUsCj4g
KwlzdHJ1Y3QgaXQ2NTA1X3N0ZXBfdHJhaW5fcGFyYSAqbGFuZV92b2x0YWdlX3ByZV9lbXBoYXNp
cywKPiArCXU4ICpsYW5lX3ZvbHRhZ2VfcHJlX2VtcGhhc2lzX3NldCkKPiArewo+ICsJdTggaTsK
PiArCj4gKwlmb3IgKGkgPSAwOyBpIDwgaXQ2NTA1LT5sYW5lX2NvdW50OyBpKyspIHsKPiArCQls
YW5lX3ZvbHRhZ2VfcHJlX2VtcGhhc2lzLT52b2x0YWdlX3N3aW5nW2ldICY9IDB4MDM7Cj4gKwkJ
bGFuZV92b2x0YWdlX3ByZV9lbXBoYXNpc19zZXRbaV0gPQo+ICsJCQlsYW5lX3ZvbHRhZ2VfcHJl
X2VtcGhhc2lzLT52b2x0YWdlX3N3aW5nW2ldOwo+ICsJCWlmIChpdDY1MDVfY2hlY2tfbWF4X3Zh
bHVlKAo+ICsJCQkgICAgVk9MVEFHRV9TV0lORywKPiArCQkJICAgIGxhbmVfdm9sdGFnZV9wcmVf
ZW1waGFzaXMtPnZvbHRhZ2Vfc3dpbmdbaV0pKQo+ICsJCQlsYW5lX3ZvbHRhZ2VfcHJlX2VtcGhh
c2lzX3NldFtpXSB8PQo+ICsJCQkJRFBfVFJBSU5fTUFYX1NXSU5HX1JFQUNIRUQ7Cj4gKwo+ICsJ
CWxhbmVfdm9sdGFnZV9wcmVfZW1waGFzaXMtPnByZV9lbXBoYXNpc1tpXSAmPSAweDAzOwo+ICsJ
CWxhbmVfdm9sdGFnZV9wcmVfZW1waGFzaXNfc2V0W2ldIHw9Cj4gKwkJCWxhbmVfdm9sdGFnZV9w
cmVfZW1waGFzaXMtPnByZV9lbXBoYXNpc1tpXQo+ICsJCQk8PCBEUF9UUkFJTl9QUkVfRU1QSEFT
SVNfU0hJRlQ7Cj4gKwkJaWYgKGl0NjUwNV9jaGVja19tYXhfdmFsdWUoCj4gKwkJCSAgICBQUkVf
RU1QSEFTSVMsCj4gKwkJCSAgICBsYW5lX3ZvbHRhZ2VfcHJlX2VtcGhhc2lzLT5wcmVfZW1waGFz
aXNbaV0pKQo+ICsJCQlsYW5lX3ZvbHRhZ2VfcHJlX2VtcGhhc2lzX3NldFtpXSB8PQo+ICsJCQkJ
RFBfVFJBSU5fTUFYX1BSRV9FTVBIQVNJU19SRUFDSEVEOwo+ICsJCWl0NjUwNV9kcGNkX3dyaXRl
KGl0NjUwNSwgRFBfVFJBSU5JTkdfTEFORTBfU0VUICsgaSwKPiArCQkJCSAgbGFuZV92b2x0YWdl
X3ByZV9lbXBoYXNpc19zZXRbaV0pOwo+ICsKPiArCQlpZiAobGFuZV92b2x0YWdlX3ByZV9lbXBo
YXNpc19zZXRbaV0gIT0KPiArCQkgICAgaXQ2NTA1X2RwY2RfcmVhZChpdDY1MDUsIERQX1RSQUlO
SU5HX0xBTkUwX1NFVCArIGkpKQo+ICsJCQlyZXR1cm4gZmFsc2U7Cj4gKwl9Cj4gKwo+ICsJcmV0
dXJuIHRydWU7Cj4gK30KPiArCj4gK3N0YXRpYyBib29sCj4gK2l0NjUwNV9zdGVwX2NyX3RyYWlu
KHN0cnVjdCBpdDY1MDUgKml0NjUwNSwKPiArCQkgICAgIHN0cnVjdCBpdDY1MDVfc3RlcF90cmFp
bl9wYXJhICpsYW5lX3ZvbHRhZ2VfcHJlX2VtcGhhc2lzKQo+ICt7Cj4gKwl1OCBsb29wX2NvdW50
ID0gMCwgaSA9IDAsIGo7Cj4gKwl1OCBsaW5rX3N0YXR1c1tEUF9MSU5LX1NUQVRVU19TSVpFXSA9
IHsgMCB9Owo+ICsJdTggbGFuZV9sZXZlbF9jb25maWdbTUFYX0xBTkVfQ09VTlRdID0geyAwIH07
Cj4gKwlpbnQgcHJlX2VtcGhhc2lzX2FkanVzdCA9IC0xLCB2b2x0YWdlX3N3aW5nX2FkanVzdCA9
IC0xOwo+ICsKPiArCWl0NjUwNV9kcGNkX3dyaXRlKGl0NjUwNSwgRFBfRE9XTlNQUkVBRF9DVFJM
LAo+ICsJCQkgIGl0NjUwNS0+ZW5hYmxlX3NzYyA/IERQX1NQUkVBRF9BTVBfMF81IDogMHgwMCk7
Cj4gKwlpdDY1MDVfZHBjZF93cml0ZShpdDY1MDUsIERQX1RSQUlOSU5HX1BBVFRFUk5fU0VULAo+
ICsJCQkgIERQX1RSQUlOSU5HX1BBVFRFUk5fMSk7Cj4gKwo+ICsJd2hpbGUgKGxvb3BfY291bnQg
PCA1ICYmIGkgPCAxMCkgewo+ICsJCWkrKzsKPiArCQlpZiAoIWl0NjUwNV9zdGVwX3RyYWluX2xh
bmVfdm9sdGFnZV9wcmVfZW1waGFzaXNfc2V0KAo+ICsJCQkgICAgaXQ2NTA1LCBsYW5lX3ZvbHRh
Z2VfcHJlX2VtcGhhc2lzLAo+ICsJCQkgICAgbGFuZV9sZXZlbF9jb25maWcpKQo+ICsJCQljb250
aW51ZTsKPiArCQlkcm1fZHBfbGlua190cmFpbl9jbG9ja19yZWNvdmVyeV9kZWxheShpdDY1MDUt
PmRwY2QpOwo+ICsJCWRybV9kcF9kcGNkX3JlYWRfbGlua19zdGF0dXMoJml0NjUwNS0+YXV4LCBs
aW5rX3N0YXR1cyk7Cj4gKwo+ICsJCWlmIChkcm1fZHBfY2xvY2tfcmVjb3Zlcnlfb2sobGlua19z
dGF0dXMsIGl0NjUwNS0+bGFuZV9jb3VudCkpIHsKPiArCQkJaXQ2NTA1X3NldF9iaXRzKGl0NjUw
NSwgUkVHX1RSQUlOX0NUUkwwLCBGT1JDRV9DUl9ET05FLAo+ICsJCQkJCUZPUkNFX0NSX0RPTkUp
Owo+ICsJCQlyZXR1cm4gdHJ1ZTsKPiArCQl9Cj4gKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoJml0
NjUwNS0+Y2xpZW50LT5kZXYsICJjciBub3QgZG9uZSIpOwo+ICsKPiArCQlpZiAoaXQ2NTA1X2No
ZWNrX21heF92b2x0YWdlX3N3aW5nX3JlYWNoZWQobGFuZV9sZXZlbF9jb25maWcsCj4gKwkJCQkJ
CQkgICBpdDY1MDUtPmxhbmVfY291bnQpKQo+ICsJCQlnb3RvIGNyX3RyYWluX2ZhaWw7Cj4gKwo+
ICsJCWZvciAoaiA9IDA7IGogPCBpdDY1MDUtPmxhbmVfY291bnQ7IGorKykgewo+ICsJCQlsYW5l
X3ZvbHRhZ2VfcHJlX2VtcGhhc2lzLT52b2x0YWdlX3N3aW5nW2pdID0KPiArCQkJCWRybV9kcF9n
ZXRfYWRqdXN0X3JlcXVlc3Rfdm9sdGFnZShsaW5rX3N0YXR1cywKPiArCQkJCQkJCQkgIGopID4+
Cj4gKwkJCQlEUF9UUkFJTl9WT0xUQUdFX1NXSU5HX1NISUZUOwo+ICsJCQlsYW5lX3ZvbHRhZ2Vf
cHJlX2VtcGhhc2lzLT5wcmVfZW1waGFzaXNbal0gPQo+ICsJCQkJZHJtX2RwX2dldF9hZGp1c3Rf
cmVxdWVzdF9wcmVfZW1waGFzaXMoCj4gKwkJCQkJbGlua19zdGF0dXMsIGopID4+Cj4gKwkJCQlE
UF9UUkFJTl9QUkVfRU1QSEFTSVNfU0hJRlQ7Cj4gKwkJCWlmICgodm9sdGFnZV9zd2luZ19hZGp1
c3QgPT0KPiArCQkJICAgICBsYW5lX3ZvbHRhZ2VfcHJlX2VtcGhhc2lzLT52b2x0YWdlX3N3aW5n
W2pdKSAmJgo+ICsJCQkgICAgKHByZV9lbXBoYXNpc19hZGp1c3QgPT0KPiArCQkJICAgICBsYW5l
X3ZvbHRhZ2VfcHJlX2VtcGhhc2lzLT5wcmVfZW1waGFzaXNbal0pKSB7Cj4gKwkJCQlsb29wX2Nv
dW50Kys7Cj4gKwkJCQljb250aW51ZTsKPiArCQkJfQo+ICsKPiArCQkJdm9sdGFnZV9zd2luZ19h
ZGp1c3QgPQo+ICsJCQkJbGFuZV92b2x0YWdlX3ByZV9lbXBoYXNpcy0+dm9sdGFnZV9zd2luZ1tq
XTsKPiArCQkJcHJlX2VtcGhhc2lzX2FkanVzdCA9Cj4gKwkJCQlsYW5lX3ZvbHRhZ2VfcHJlX2Vt
cGhhc2lzLT5wcmVfZW1waGFzaXNbal07Cj4gKwkJCWxvb3BfY291bnQgPSAwOwo+ICsKPiArCQkJ
aWYgKHZvbHRhZ2Vfc3dpbmdfYWRqdXN0ICsgcHJlX2VtcGhhc2lzX2FkanVzdCA+IDB4MDMpCj4g
KwkJCQlsYW5lX3ZvbHRhZ2VfcHJlX2VtcGhhc2lzLT52b2x0YWdlX3N3aW5nW2pdID0KPiArCQkJ
CQlNQVhfRVFfTEVWRUwgLQo+ICsJCQkJCWxhbmVfdm9sdGFnZV9wcmVfZW1waGFzaXMKPiArCQkJ
CQkJLT5wcmVfZW1waGFzaXNbal07Cj4gKwkJfQo+ICsJfQo+ICsKPiArY3JfdHJhaW5fZmFpbDoK
PiArCWl0NjUwNV9kcGNkX3dyaXRlKGl0NjUwNSwgRFBfVFJBSU5JTkdfUEFUVEVSTl9TRVQsCj4g
KwkJCSAgRFBfVFJBSU5JTkdfUEFUVEVSTl9ESVNBQkxFKTsKPiArCj4gKwlyZXR1cm4gZmFsc2U7
Cj4gK30KPiArCj4gK3N0YXRpYyBib29sCj4gK2l0NjUwNV9zdGVwX2VxX3RyYWluKHN0cnVjdCBp
dDY1MDUgKml0NjUwNSwKPiArCQkgICAgIHN0cnVjdCBpdDY1MDVfc3RlcF90cmFpbl9wYXJhICps
YW5lX3ZvbHRhZ2VfcHJlX2VtcGhhc2lzKQo+ICt7Cj4gKwl1OCBsb29wX2NvdW50ID0gMCwgaSwg
bGlua19zdGF0dXNbRFBfTElOS19TVEFUVVNfU0laRV0gPSB7IDAgfTsKPiArCXU4IGxhbmVfbGV2
ZWxfY29uZmlnW01BWF9MQU5FX0NPVU5UXSA9IHsgMCB9Owo+ICsKPiArCWl0NjUwNV9kcGNkX3dy
aXRlKGl0NjUwNSwgRFBfVFJBSU5JTkdfUEFUVEVSTl9TRVQsCj4gKwkJCSAgRFBfVFJBSU5JTkdf
UEFUVEVSTl8yKTsKPiArCj4gKwl3aGlsZSAobG9vcF9jb3VudCA8IDYpIHsKPiArCQlsb29wX2Nv
dW50Kys7Cj4gKwo+ICsJCWlmICghaXQ2NTA1X3N0ZXBfdHJhaW5fbGFuZV92b2x0YWdlX3ByZV9l
bXBoYXNpc19zZXQoCj4gKwkJCSAgICBpdDY1MDUsIGxhbmVfdm9sdGFnZV9wcmVfZW1waGFzaXMs
Cj4gKwkJCSAgICBsYW5lX2xldmVsX2NvbmZpZykpCj4gKwkJCWNvbnRpbnVlOwo+ICsKPiArCQlk
cm1fZHBfbGlua190cmFpbl9jaGFubmVsX2VxX2RlbGF5KGl0NjUwNS0+ZHBjZCk7Cj4gKwkJZHJt
X2RwX2RwY2RfcmVhZF9saW5rX3N0YXR1cygmaXQ2NTA1LT5hdXgsIGxpbmtfc3RhdHVzKTsKPiAr
Cj4gKwkJaWYgKCFkcm1fZHBfY2xvY2tfcmVjb3Zlcnlfb2sobGlua19zdGF0dXMsIGl0NjUwNS0+
bGFuZV9jb3VudCkpCj4gKwkJCWdvdG8gZXFfdHJhaW5fZmFpbDsKPiArCj4gKwkJaWYgKGRybV9k
cF9jaGFubmVsX2VxX29rKGxpbmtfc3RhdHVzLCBpdDY1MDUtPmxhbmVfY291bnQpKSB7Cj4gKwkJ
CWl0NjUwNV9kcGNkX3dyaXRlKGl0NjUwNSwgRFBfVFJBSU5JTkdfUEFUVEVSTl9TRVQsCj4gKwkJ
CQkJICBEUF9UUkFJTklOR19QQVRURVJOX0RJU0FCTEUpOwo+ICsJCQlpdDY1MDVfc2V0X2JpdHMo
aXQ2NTA1LCBSRUdfVFJBSU5fQ1RSTDAsIEZPUkNFX0VRX0RPTkUsCj4gKwkJCQkJRk9SQ0VfRVFf
RE9ORSk7Cj4gKwkJCXJldHVybiB0cnVlOwo+ICsJCX0KPiArCQlEUk1fREVWX0RFQlVHX0RSSVZF
UigmaXQ2NTA1LT5jbGllbnQtPmRldiwgImVxIG5vdCBkb25lIik7Cj4gKwo+ICsJCWZvciAoaSA9
IDA7IGkgPCBpdDY1MDUtPmxhbmVfY291bnQ7IGkrKykgewo+ICsJCQlsYW5lX3ZvbHRhZ2VfcHJl
X2VtcGhhc2lzLT52b2x0YWdlX3N3aW5nW2ldID0KPiArCQkJCWRybV9kcF9nZXRfYWRqdXN0X3Jl
cXVlc3Rfdm9sdGFnZShsaW5rX3N0YXR1cywKPiArCQkJCQkJCQkgIGkpID4+Cj4gKwkJCQlEUF9U
UkFJTl9WT0xUQUdFX1NXSU5HX1NISUZUOwo+ICsJCQlsYW5lX3ZvbHRhZ2VfcHJlX2VtcGhhc2lz
LT5wcmVfZW1waGFzaXNbaV0gPQo+ICsJCQkJZHJtX2RwX2dldF9hZGp1c3RfcmVxdWVzdF9wcmVf
ZW1waGFzaXMoCj4gKwkJCQkJbGlua19zdGF0dXMsIGkpID4+Cj4gKwkJCQlEUF9UUkFJTl9QUkVf
RU1QSEFTSVNfU0hJRlQ7Cj4gKwo+ICsJCQlpZiAobGFuZV92b2x0YWdlX3ByZV9lbXBoYXNpcy0+
dm9sdGFnZV9zd2luZ1tpXSArCj4gKwkJCQkgICAgbGFuZV92b2x0YWdlX3ByZV9lbXBoYXNpcy0+
cHJlX2VtcGhhc2lzW2ldID4KPiArCQkJICAgIDB4MDMpCj4gKwkJCQlsYW5lX3ZvbHRhZ2VfcHJl
X2VtcGhhc2lzLT52b2x0YWdlX3N3aW5nW2ldID0KPiArCQkJCQkweDAzIC0gbGFuZV92b2x0YWdl
X3ByZV9lbXBoYXNpcwo+ICsJCQkJCQkgICAgICAgLT5wcmVfZW1waGFzaXNbaV07Cj4gKwkJfQo+
ICsJfQo+ICsKPiArZXFfdHJhaW5fZmFpbDoKPiArCWl0NjUwNV9kcGNkX3dyaXRlKGl0NjUwNSwg
RFBfVFJBSU5JTkdfUEFUVEVSTl9TRVQsCj4gKwkJCSAgRFBfVFJBSU5JTkdfUEFUVEVSTl9ESVNB
QkxFKTsKPiArCXJldHVybiBmYWxzZTsKPiArfQo+ICsKPiArc3RhdGljIGJvb2wgaXQ2NTA1X2xp
bmtfc3RhcnRfc3RlcF90cmFpbihzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUpCj4gK3sKPiArCWludCBl
cnI7Cj4gKwlzdHJ1Y3QgaXQ2NTA1X3N0ZXBfdHJhaW5fcGFyYSBsYW5lX3ZvbHRhZ2VfcHJlX2Vt
cGhhc2lzID0gewo+ICsJCS52b2x0YWdlX3N3aW5nID0geyAwIH0sCj4gKwkJLnByZV9lbXBoYXNp
cyA9IHsgMCB9LAo+ICsJfTsKPiArCj4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUigmaXQ2NTA1LT5j
bGllbnQtPmRldiwgInN0YXJ0Iik7Cj4gKwllcnIgPSBpdDY1MDVfZHJtX2RwX2xpbmtfY29uZmln
dXJlKGl0NjUwNSk7Cj4gKwo+ICsJaWYgKGVyciAhPSAwKQo+ICsJCXJldHVybiBmYWxzZTsKPiAr
CWlmICghaXQ2NTA1X3N0ZXBfY3JfdHJhaW4oaXQ2NTA1LCAmbGFuZV92b2x0YWdlX3ByZV9lbXBo
YXNpcykpCj4gKwkJcmV0dXJuIGZhbHNlOwo+ICsJaWYgKCFpdDY1MDVfc3RlcF9lcV90cmFpbihp
dDY1MDUsICZsYW5lX3ZvbHRhZ2VfcHJlX2VtcGhhc2lzKSkKPiArCQlyZXR1cm4gZmFsc2U7Cj4g
KwlyZXR1cm4gdHJ1ZTsKPiArfQo+ICsKPiArc3RhdGljIGJvb2wgaXQ2NTA1X2dldF92aWRlb19z
dGF0dXMoc3RydWN0IGl0NjUwNSAqaXQ2NTA1KQo+ICt7Cj4gKwlpbnQgcmVnXzBkOwo+ICsKPiAr
CXJlZ18wZCA9IGl0NjUwNV9yZWFkKGl0NjUwNSwgUkVHX1NZU1RFTV9TVFMpOwo+ICsKPiArCWlm
IChyZWdfMGQgPCAwKQo+ICsJCXJldHVybiBmYWxzZTsKPiArCj4gKwlyZXR1cm4gKHJlZ18wZCAm
IFZJREVPX1NUQikgPyB0cnVlIDogZmFsc2U7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGl0NjUw
NV9yZXNldF9oZGNwKHN0cnVjdCBpdDY1MDUgKml0NjUwNSkKPiArewo+ICsJLyogRGlzYWJsZSBD
UF9EZXNpcmVkICovCj4gKwlpdDY1MDVfc2V0X2JpdHMoaXQ2NTA1LCBSRUdfSERDUF9DVFJMMSwg
SERDUF9DUF9FTkFCTEUsIDB4MDApOwo+ICsJaXQ2NTA1X3NldF9iaXRzKGl0NjUwNSwgUkVHX1JF
U0VUX0NUUkwsIEhEQ1BfUkVTRVQsIEhEQ1BfUkVTRVQpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9p
ZCBpdDY1MDVfc3RvcF9saW5rX3RyYWluKHN0cnVjdCBpdDY1MDUgKml0NjUwNSkKPiArewo+ICsJ
aXQ2NTA1LT5saW5rX3N0YXRlID0gTElOS19JRExFOwo+ICsJY2FuY2VsX3dvcmtfc3luYygmaXQ2
NTA1LT5saW5rX3dvcmtzKTsKPiArCWl0NjUwNV93cml0ZShpdDY1MDUsIFJFR19UUkFJTl9DVFJM
MSwgRk9SQ0VfUkVUUkFJTik7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGl0NjUwNV9saW5rX3Ry
YWluaW5nX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICt7Cj4gKwlzdHJ1Y3QgaXQ2
NTA1ICppdDY1MDUgPSBjb250YWluZXJfb2Yod29yaywgc3RydWN0IGl0NjUwNSwgbGlua193b3Jr
cyk7Cj4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmaXQ2NTA1LT5jbGllbnQtPmRldjsKPiArCWlu
dCBlcnIsIGksIHN0ZXBfcmV0cnkgPSAzOwo+ICsKPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRl
diwgIml0NjUwNS0+c2lua19jb3VudDogJWQiLAo+ICsJCQkgICAgIGl0NjUwNS0+c2lua19jb3Vu
dCk7Cj4gKwo+ICsKPiArCWlmICghaXQ2NTA1X2dldF9zaW5rX2hwZF9zdGF0dXMoaXQ2NTA1KSkK
PiArCQlyZXR1cm47Cj4gKwo+ICsJaXQ2NTA1X2xpbmtfdHJhaW5pbmdfc2V0dXAoaXQ2NTA1KTsK
PiArCj4gKwlpZiAoaXQ2NTA1LT5hdXRvX3RyYWluX3JldHJ5IDwgMSkKPiArCQlnb3RvIHN0ZXBf
dHJhaW47Cj4gKwo+ICsJaXQ2NTA1X3Jlc2V0X2hkY3AoaXQ2NTA1KTsKPiArCWl0NjUwNV9hdXhf
cmVzZXQoaXQ2NTA1KTsKPiArCWVyciA9IGl0NjUwNV9saW5rX3N0YXJ0X2F1dG9fdHJhaW4oaXQ2
NTA1KTsKPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImF1dG8gdHJhaW4gJXMsIGF1dG9f
dHJhaW5fcmV0cnk6ICVkIiwKPiArCQkJICAgICBlcnIgPyAicGFzcyIgOiAiZmFpbGVkIiwgaXQ2
NTA1LT5hdXRvX3RyYWluX3JldHJ5KTsKPiArCWl0NjUwNS0+YXV0b190cmFpbl9yZXRyeS0tOwo+
ICsKPiArCWlmIChlcnIpCj4gKwkJZ290byBsaW5rX3RyYWluX29rOwo+ICsKPiArCWl0NjUwNV9k
dW1wKGl0NjUwNSk7Cj4gKwlyZXR1cm47Cj4gKwo+ICtzdGVwX3RyYWluOgo+ICsJRFJNX0RFVl9E
RUJVR19EUklWRVIoZGV2LCAiU3RhcnQgc3RlcCB0cmFpbiIpOwo+ICsKPiArCWlmIChpdDY1MDUt
PnNpbmtfY291bnQgPT0gMCkgewo+ICsJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIml0NjUw
NS0+c2lua19jb3VudDolZCwgZm9yY2UgZXEiLAo+ICsJCQkJICAgICBpdDY1MDUtPnNpbmtfY291
bnQpOwo+ICsJCWl0NjUwNV9zZXRfYml0cyhpdDY1MDUsCVJFR19UUkFJTl9DVFJMMCwgRk9SQ0Vf
RVFfRE9ORSwKPiArCQkJCUZPUkNFX0VRX0RPTkUpOwo+ICsJCXJldHVybjsKPiArCX0KPiArCj4g
KwlpZiAoIWl0NjUwNS0+c3RlcF90cmFpbikKPiArCQlnb3RvIGxpbmtfdHJhaW5fZXJyb3I7Cj4g
Kwo+ICsJLyogc2V0cCB0cmFpbmluZyBzdGFydCBoZXJlICovCj4gKwlmb3IgKGkgPSAwOyBpIDwg
c3RlcF9yZXRyeTsgaSsrKSB7Cj4gKwkJaXQ2NTA1X3NldF9iaXRzKGl0NjUwNSwgUkVHX1RSQUlO
X0NUUkwwLAo+ICsJCQkJRk9SQ0VfQ1JfRE9ORSB8IEZPUkNFX0VRX0RPTkUsIDB4MDApOwo+ICsJ
CWl0NjUwNV9kcGNkX3dyaXRlKGl0NjUwNSwgRFBfVFJBSU5JTkdfUEFUVEVSTl9TRVQsCj4gKwkJ
CQkgIERQX1RSQUlOSU5HX1BBVFRFUk5fRElTQUJMRSk7Cj4gKwkJZXJyID0gaXQ2NTA1X2xpbmtf
c3RhcnRfc3RlcF90cmFpbihpdDY1MDUpOwo+ICsJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwg
InN0ZXAgdHJhaW4gJXMsIHJldHJ5OiVkIHRpbWVzIiwKPiArCQkJCSAgICAgZXJyID8gInBhc3Mi
IDogImZhaWxlZCIsIGkgKyAxKTsKPiArCQlpZiAoZXJyKQo+ICsJCQlnb3RvIGxpbmtfdHJhaW5f
b2s7Cj4gKwl9Cj4gKwo+ICtsaW5rX3RyYWluX2Vycm9yOgo+ICsJRFJNX0RFVl9ERUJVR19EUklW
RVIoZGV2LCAidHJhaW5pbmcgZmFpbCIpOwo+ICsJaXQ2NTA1LT5saW5rX3N0YXRlID0gTElOS19J
RExFOwo+ICsKPiArCWlmICghaXQ2NTA1X2dldF92aWRlb19zdGF0dXMoaXQ2NTA1KSkKPiArCQlp
dDY1MDVfdmlkZW9fcmVzZXQoaXQ2NTA1KTsKPiArCXJldHVybjsKPiArCj4gK2xpbmtfdHJhaW5f
b2s6Cj4gKwo+ICsJaXQ2NTA1LT5saW5rX3N0YXRlID0gTElOS19PSzsKPiArCS8qIGRpc2FsYmUg
bXV0ZSBlbmFibGUgYXZpIGluZm8gZnJhbWUgKi8KPiArCWl0NjUwNV9zZXRfYml0cyhpdDY1MDUs
IFJFR19EQVRBX01VVEVfQ1RSTCwgRU5fVklEX01VVEUsIDB4MDApOwo+ICsJaXQ2NTA1X3NldF9i
aXRzKGl0NjUwNSwgUkVHX0lORk9GUkFNRV9DVFJMLAo+ICsJCQlFTl9WSURfQ1RSTF9QS1QsIEVO
X1ZJRF9DVFJMX1BLVCk7Cj4gKwo+ICsJaWYgKGl0NjUwNV9hdWRpb19pbnB1dChpdDY1MDUpKSB7
Cj4gKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiRW5hYmxlIGF1ZGlvISIpOwo+ICsJCWl0
NjUwNV9lbmFibGVfYXVkaW8oaXQ2NTA1KTsKPiArCX0KPiArfQo+ICsKPiArc3RhdGljIHZvaWQg
aXQ2NTA1X3BsdWdnZWRfc3RhdHVzX3RvX2NvZGVjKHN0cnVjdCBpdDY1MDUgKml0NjUwNSkKPiAr
ewo+ICsJZW51bSBkcm1fY29ubmVjdG9yX3N0YXR1cyBzdGF0dXMgPSBpdDY1MDUtPmNvbm5lY3Rv
cl9zdGF0dXM7Cj4gKwo+ICsJaWYgKGl0NjUwNS0+cGx1Z2dlZF9jYiAmJiBpdDY1MDUtPmNvZGVj
X2RldikKPiArCQlpdDY1MDUtPnBsdWdnZWRfY2IoaXQ2NTA1LT5jb2RlY19kZXYsCj4gKwkJCQkg
ICBzdGF0dXMgPT0gY29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQpOwo+ICt9Cj4gKwo+ICtzdGF0
aWMgaW50IGl0NjUwNV9wcm9jc3NfaHBkX2lycShzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUpCj4gK3sK
PiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZpdDY1MDUtPmNsaWVudC0+ZGV2Owo+ICsJaW50IHJl
dCwgZHBjZF9zaW5rX2NvdW50LCBkcF9pcnFfdmVjdG9yOwo+ICsJdTggbGlua19zdGF0dXNbRFBf
TElOS19TVEFUVVNfU0laRV07Cj4gKwo+ICsJaWYgKCFpdDY1MDVfZ2V0X3NpbmtfaHBkX3N0YXR1
cyhpdDY1MDUpKSB7Cj4gKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiSFBEX0lSUSBIUEQg
bG93Iik7Cj4gKwkJaXQ2NTA1LT5zaW5rX2NvdW50ID0gMDsKPiArCQlyZXR1cm4gMDsKPiArCX0K
PiArCj4gKwlyZXQgPSBpdDY1MDVfZHBjZF9yZWFkKGl0NjUwNSwgRFBfU0lOS19DT1VOVCk7Cj4g
KwlpZiAocmV0IDwgMCkKPiArCQlyZXR1cm4gcmV0Owo+ICsKPiArCWRwY2Rfc2lua19jb3VudCA9
IERQX0dFVF9TSU5LX0NPVU5UKHJldCk7Cj4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJk
cGNkX3NpbmtfY291bnQ6ICVkIGl0NjUwNS0+c2lua19jb3VudDolZCIsCj4gKwkJCSAgICAgZHBj
ZF9zaW5rX2NvdW50LCBpdDY1MDUtPnNpbmtfY291bnQpOwo+ICsKPiArCWlmIChpdDY1MDUtPmJy
YW5jaF9kZXZpY2UgJiYgZHBjZF9zaW5rX2NvdW50ICE9IGl0NjUwNS0+c2lua19jb3VudCkgewo+
ICsJCW1lbXNldChpdDY1MDUtPmRwY2QsIDAsIHNpemVvZihpdDY1MDUtPmRwY2QpKTsKPiArCQlp
dDY1MDUtPnNpbmtfY291bnQgPSBkcGNkX3NpbmtfY291bnQ7Cj4gKwkJa2ZyZWUoaXQ2NTA1LT5l
ZGlkKTsKPiArCQlpdDY1MDUtPmVkaWQgPSBOVUxMOwo+ICsJCWl0NjUwNV9yZXNldF9sb2dpYyhp
dDY1MDUpOwo+ICsJCWl0NjUwNV9pbnRfbWFza19lbmFibGUoaXQ2NTA1KTsKPiArCQlpdDY1MDVf
aW5pdChpdDY1MDUpOwo+ICsJCXJldHVybiAwOwo+ICsJfQo+ICsKPiArCWRwX2lycV92ZWN0b3Ig
PSBpdDY1MDVfZHBjZF9yZWFkKGl0NjUwNSwgRFBfREVWSUNFX1NFUlZJQ0VfSVJRX1ZFQ1RPUik7
Cj4gKwlpZiAoZHBfaXJxX3ZlY3RvciA8IDApCj4gKwkJcmV0dXJuIGRwX2lycV92ZWN0b3I7Cj4g
Kwo+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZHBfaXJxX3ZlY3RvciA9IDB4JTAyeCIs
IGRwX2lycV92ZWN0b3IpOwo+ICsKPiArCS8qIG5vIG5lZWQgdG8gY2hlY2sgbGluayBzdGF0dXMg
aWYgbm8gdHJhaW5pbmcgKi8KPiArCWlmIChpdDY1MDUtPmxpbmtfc3RhdGUgPT0gTElOS19PSykg
ewo+ICsJCXJldCA9IGRybV9kcF9kcGNkX3JlYWRfbGlua19zdGF0dXMoJml0NjUwNS0+YXV4LCBs
aW5rX3N0YXR1cyk7Cj4gKwkJaWYgKHJldCA8IDApIHsKPiArCQkJRFJNX0RFVl9FUlJPUihkZXYs
ICJGYWlsIHRvIHJlYWQgbGluayBzdGF0dXMgcmV0OiAlZCIsCj4gKwkJCQkgICAgICByZXQpOwo+
ICsJCQlyZXR1cm4gcmV0Owo+ICsJCX0KPiArCj4gKwkJaWYgKGRwX2xpbmtfc3RhdHVzKGxpbmtf
c3RhdHVzLCBEUF9MQU5FX0FMSUdOX1NUQVRVU19VUERBVEVEKSAmCj4gKwkJICAgIERQX0xJTktf
U1RBVFVTX1VQREFURUQpIHsKPiArCQkJaWYgKCFkcm1fZHBfY2hhbm5lbF9lcV9vayhsaW5rX3N0
YXR1cywKPiArCQkJCQkJICBpdDY1MDUtPmxhbmVfY291bnQpKQo+ICsJCQkJaXQ2NTA1X3ZpZGVv
X3Jlc2V0KGl0NjUwNSk7Cj4gKwkJfQo+ICsJfQo+ICsKPiArCXJldHVybiAwOwo+ICt9Cj4gKwo+
ICtzdGF0aWMgdm9pZCBpdDY1MDVfY2hlY2tfcmVnMDYoc3RydWN0IGl0NjUwNSAqaXQ2NTA1LCB1
bnNpZ25lZCBpbnQgcmVnMDYpCj4gK3sKPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZpdDY1MDUt
PmNsaWVudC0+ZGV2Owo+ICsJYm9vbCBkYXRhOwo+ICsKPiArCWlmIChyZWcwNiAmIElOVF9IUERf
Q0hBTkdFKSB7Cj4gKwkJZGF0YSA9IGl0NjUwNV9nZXRfc2lua19ocGRfc3RhdHVzKGl0NjUwNSk7
Cj4gKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiaHBkIGNoYW5nZSBpbnRlcnJ1cHQsIGNo
YW5nZSB0byAlcyIsCj4gKwkJCQkgICAgIGRhdGEgPyAiaGlnaCIgOiAibG93Iik7Cj4gKwo+ICsJ
CWRybV9oZWxwZXJfaHBkX2lycV9ldmVudChpdDY1MDUtPmNvbm5lY3Rvci5kZXYpOwo+ICsJCURS
TV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIml0NjUwNS0+c2lua19jb3VudDogJWQiLAo+ICsJCQkJ
ICAgICBpdDY1MDUtPnNpbmtfY291bnQpOwo+ICsKPiArCQlpZiAoZGF0YSkgewo+ICsJCQl3YWl0
X2Zvcl9jb21wbGV0aW9uX3RpbWVvdXQoJml0NjUwNS0+d2FpdF9lZGlkX2NvbXBsZXRlLAo+ICsJ
CQkJCQkgICAgbXNlY3NfdG9famlmZmllcyg2MDAwKSk7Cj4gKwkJCWl0NjUwNV9sYW5lX3Rlcm1p
bmF0aW9uX29uKGl0NjUwNSk7Cj4gKwkJCWl0NjUwNV9sYW5lX3Bvd2VyX29uKGl0NjUwNSk7Cj4g
Kwo+ICsJCQkvKgo+ICsJCQkgKiBmb3Igc29tZSBkb25nbGUgd2hpY2ggaXNzdWUgSFBEX2lycQo+
ICsJCQkgKiB3aGVuIHNpbmsgY291bm50IGNoYW5nZSBmcm9tICAwLT4xCj4gKwkJCSAqIGl0NjUw
NSBub3QgYWJsZSB0byByZWNlaXZlIEhQRF9JUlEKPiArCQkJICogaWYgSFcgbmV2ZXIgZ28gaW50
byB0cmFpbmlnIGRvbmUKPiArCQkJICovCj4gKwo+ICsJCQlpZiAoaXQ2NTA1LT5icmFuY2hfZGV2
aWNlICYmIGl0NjUwNS0+c2lua19jb3VudCA9PSAwKQo+ICsJCQkJc2NoZWR1bGVfd29yaygmaXQ2
NTA1LT5saW5rX3dvcmtzKTsKPiArCj4gKwkJCWlmICghaXQ2NTA1X2dldF92aWRlb19zdGF0dXMo
aXQ2NTA1KSkKPiArCQkJCWl0NjUwNV92aWRlb19yZXNldChpdDY1MDUpOwo+ICsKPiArCQkJaXQ2
NTA1X2NhbGNfdmlkZW9faW5mbyhpdDY1MDUpOwo+ICsJCX0gZWxzZSB7Cj4gKwkJCWtmcmVlKGl0
NjUwNS0+ZWRpZCk7Cj4gKwkJCWl0NjUwNS0+ZWRpZCA9IE5VTEw7Cj4gKwkJCW1lbXNldChpdDY1
MDUtPmRwY2QsIDAsIHNpemVvZihpdDY1MDUtPmRwY2QpKTsKPiArCj4gKwkJCWl0NjUwNV92aWRl
b19kaXNhYmxlKGl0NjUwNSk7Cj4gKwkJCWl0NjUwNV9kaXNhYmxlX2F1ZGlvKGl0NjUwNSk7Cj4g
KwkJCWl0NjUwNV9zdG9wX2xpbmtfdHJhaW4oaXQ2NTA1KTsKPiArCQkJaXQ2NTA1X2xhbmVfb2Zm
KGl0NjUwNSk7Cj4gKwkJCXJldHVybjsKPiArCQl9Cj4gKwl9Cj4gKwo+ICsJaWYgKHJlZzA2ICYg
SU5UX1JFQ0VJVkVfSFBEX0lSUSkgewo+ICsJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImhw
ZF9pcnEgaW50ZXJydXB0Iik7Cj4gKwo+ICsJCWlmIChpdDY1MDVfcHJvY3NzX2hwZF9pcnEoaXQ2
NTA1KSA8IDApCj4gKwkJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgInByb2Nlc3MgaHBkX2ly
cSBmYWlsISIpOwo+ICsJfQo+ICsKPiArCWlmIChyZWcwNiAmIElOVF9TQ0RUX0NIQU5HRSkgewo+
ICsJCWRhdGEgPSBpdDY1MDVfZ2V0X3ZpZGVvX3N0YXR1cyhpdDY1MDUpOwo+ICsJCURSTV9ERVZf
REVCVUdfRFJJVkVSKGRldiwgInZpZGVvIHN0YWJsZSBjaGFuZ2UgaW50ZXJydXB0LCAlcyIsCj4g
KwkJCQkgICAgIGRhdGEgPyAic3RhYmxlIiA6ICJ1bnN0YWJsZSIpOwo+ICsJCWl0NjUwNV9jYWxj
X3ZpZGVvX2luZm8oaXQ2NTA1KTsKPiArCj4gKwkJaWYgKGRhdGEpCj4gKwkJCXNjaGVkdWxlX3dv
cmsoJml0NjUwNS0+bGlua193b3Jrcyk7Cj4gKwl9Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGl0
NjUwNV9jaGVja19yZWcwNyhzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUsIHVuc2lnbmVkIGludCByZWcw
NykKPiArewo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJml0NjUwNS0+Y2xpZW50LT5kZXY7Cj4g
Kwo+ICsJaWYgKHJlZzA3ICYgSU5UX0FVWF9DTURfRkFJTCkKPiArCQlEUk1fREVWX0RFQlVHX0RS
SVZFUihkZXYsICJBVVggUEMgUmVxdWVzdCBGYWlsIEludGVycnVwdCIpOwo+ICsKPiArCWlmIChy
ZWcwNyAmIElOVF9BVURJT19GSUZPX0VSUk9SKSB7Cj4gKwkJRFJNX0RFVl9ERUJVR19EUklWRVIo
ZGV2LCAiYXVkaW8gZmlmbyBlcnJvciBJbnRlcnJ1cHQiKTsKPiArCj4gKwkJaWYgKGl0NjUwNV9h
dWRpb19pbnB1dChpdDY1MDUpKQo+ICsJCQlpdDY1MDVfZW5hYmxlX2F1ZGlvKGl0NjUwNSk7Cj4g
Kwl9Cj4gKwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBpdDY1MDVfY2hlY2tfcmVnMDgoc3RydWN0
IGl0NjUwNSAqaXQ2NTA1LCB1bnNpZ25lZCBpbnQgcmVnMDgpCj4gK3sKPiArCXN0cnVjdCBkZXZp
Y2UgKmRldiA9ICZpdDY1MDUtPmNsaWVudC0+ZGV2Owo+ICsKPiArCWlmIChyZWcwOCAmIElOVF9M
SU5LX1RSQUlOX0ZBSUwpIHsKPiArCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJsaW5rIHRy
YWluaW5nIGZhaWwgaW50ZXJydXB0Iik7Cj4gKwkJc2NoZWR1bGVfd29yaygmaXQ2NTA1LT5saW5r
X3dvcmtzKTsKPiArCX0KPiArCj4gKwlpZiAocmVnMDggJiBJTlRfVklEX0ZJRk9fRVJST1IpIHsK
PiArCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJ2aWRlbyBmaWZvIG92ZXJmbG93IGludGVy
cnVwdCIpOwo+ICsJCWl0NjUwNV92aWRlb19yZXNldChpdDY1MDUpOwo+ICsJCWl0NjUwNS0+YXV0
b190cmFpbl9yZXRyeSA9IEFVVE9fVFJBSU5fUkVUUlk7Cj4gKwl9Cj4gKwo+ICsJaWYgKHJlZzA4
ICYgSU5UX0lPX0xBVENIX0ZJRk9fT1ZFUkZMT1cpIHsKPiArCQlEUk1fREVWX0RFQlVHX0RSSVZF
UihkZXYsICJJTyBsYXRjaCBmaWZvIG92ZXJmbG93IGludGVycnVwdCIpOwo+ICsJCWl0NjUwNV92
aWRlb19yZXNldChpdDY1MDUpOwo+ICsJfQo+ICt9Cj4gKwo+ICtzdGF0aWMgaXJxcmV0dXJuX3Qg
aXQ2NTA1X2ludF90aHJlYWRlZF9oYW5kbGVyKGludCB1bnVzZWQsIHZvaWQgKmRhdGEpCj4gK3sK
PiArCXN0cnVjdCBpdDY1MDUgKml0NjUwNSA9IGRhdGE7Cj4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYg
PSAmaXQ2NTA1LT5jbGllbnQtPmRldjsKPiArCWludCByZWcwNiwgcmVnMDcsIHJlZzA4Owo+ICsK
PiArCW1zbGVlcCgxMDApOwo+ICsJbXV0ZXhfbG9jaygmaXQ2NTA1LT5leHRjb25fbG9jayk7Cj4g
Kwo+ICsJaWYgKGl0NjUwNS0+ZW5hYmxlX2Rydl9ob2xkIHx8ICFpdDY1MDUtPnBvd2VyZWQpCj4g
KwkJZ290byB1bmxvY2s7Cj4gKwo+ICsJcmVnMDYgPSBpdDY1MDVfcmVhZChpdDY1MDUsIElOVF9T
VEFUVVNfMDEpOwo+ICsJcmVnMDcgPSBpdDY1MDVfcmVhZChpdDY1MDUsIElOVF9TVEFUVVNfMDIp
Owo+ICsJcmVnMDggPSBpdDY1MDVfcmVhZChpdDY1MDUsIElOVF9TVEFUVVNfMDMpOwo+ICsKPiAr
CWl0NjUwNV93cml0ZShpdDY1MDUsIElOVF9TVEFUVVNfMDEsIHJlZzA2KTsKPiArCWl0NjUwNV93
cml0ZShpdDY1MDUsIElOVF9TVEFUVVNfMDIsIHJlZzA3KTsKPiArCWl0NjUwNV93cml0ZShpdDY1
MDUsIElOVF9TVEFUVVNfMDMsIHJlZzA4KTsKPiArCj4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUihk
ZXYsICJyZWcwNiA9IDB4JTAyeCIsIHJlZzA2KTsKPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRl
diwgInJlZzA3ID0gMHglMDJ4IiwgcmVnMDcpOwo+ICsJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2
LCAicmVnMDggPSAweCUwMngiLCByZWcwOCk7Cj4gKwo+ICsJaWYgKHJlZzA2ICE9IDApCj4gKwkJ
aXQ2NTA1X2NoZWNrX3JlZzA2KGl0NjUwNSwgcmVnMDYpOwo+ICsKPiArCWlmIChyZWcwNyAhPSAw
KQo+ICsJCWl0NjUwNV9jaGVja19yZWcwNyhpdDY1MDUsIHJlZzA3KTsKPiArCj4gKwlpZiAocmVn
MDggIT0gMCkKPiArCQlpdDY1MDVfY2hlY2tfcmVnMDgoaXQ2NTA1LCByZWcwOCk7Cj4gKwo+ICt1
bmxvY2s6Cj4gKwltdXRleF91bmxvY2soJml0NjUwNS0+ZXh0Y29uX2xvY2spOwo+ICsKPiArCXJl
dHVybiBJUlFfSEFORExFRDsKPiArfQo+ICsKPiArc3RhdGljIGludCBpdDY1MDVfcG93ZXJvbihz
dHJ1Y3QgaXQ2NTA1ICppdDY1MDUpCj4gK3sKPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZpdDY1
MDUtPmNsaWVudC0+ZGV2Owo+ICsJc3RydWN0IGl0NjUwNV9wbGF0Zm9ybV9kYXRhICpwZGF0YSA9
ICZpdDY1MDUtPnBkYXRhOwo+ICsJaW50IGVycjsKPiArCj4gKwlpZiAoaXQ2NTA1LT5wb3dlcmVk
KSB7Cj4gKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiaXQ2NTA1IGFscmVhZHkgcG93ZXJl
ZCBvbiIpOwo+ICsJCXJldHVybiAwOwo+ICsJfQo+ICsKPiArCWlmIChwZGF0YS0+cHdyMTgpIHsK
PiArCQllcnIgPSByZWd1bGF0b3JfZW5hYmxlKHBkYXRhLT5wd3IxOCk7Cj4gKwkJaWYgKGVycikg
ewo+ICsJCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJGYWlsZWQgdG8gZW5hYmxlIFZERDE4
OiAlZCIsCj4gKwkJCQkJICAgICBlcnIpOwo+ICsJCQlyZXR1cm4gZXJyOwo+ICsJCX0KPiArCX0K
PiArCj4gKwlpZiAocGRhdGEtPm92ZGQpIHsKPiArCQkvKiB0aW1lIGludGVydmFsIGJldHdlZW4g
SVZERCBhbmQgT1ZERCBhdCBsZWFzdCBiZSAxbXMgKi8KPiArCQl1c2xlZXBfcmFuZ2UoMTAwMCwg
MjAwMCk7Cj4gKwkJZXJyID0gcmVndWxhdG9yX2VuYWJsZShwZGF0YS0+b3ZkZCk7Cj4gKwkJaWYg
KGVycikgewo+ICsJCQlyZWd1bGF0b3JfZGlzYWJsZShwZGF0YS0+cHdyMTgpOwo+ICsJCQlyZXR1
cm4gZXJyOwo+ICsJCX0KPiArCX0KPiArCS8qIHRpbWUgaW50ZXJ2YWwgYmV0d2VlbiBPVkREIGFu
ZCBTWVNSU1ROIGF0IGxlYXN0IGJlIDEwbXMgKi8KPiArCWlmIChwZGF0YS0+Z3Bpb2RfcmVzZXQp
IHsKPiArCQl1c2xlZXBfcmFuZ2UoMTAwMDAsIDIwMDAwKTsKPiArCQlncGlvZF9zZXRfdmFsdWVf
Y2Fuc2xlZXAocGRhdGEtPmdwaW9kX3Jlc2V0LCAwKTsKPiArCQl1c2xlZXBfcmFuZ2UoMTAwMCwg
MjAwMCk7Cj4gKwkJZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKHBkYXRhLT5ncGlvZF9yZXNldCwg
MSk7Cj4gKwkJdXNsZWVwX3JhbmdlKDEwMDAwLCAyMDAwMCk7Cj4gKwl9Cj4gKwo+ICsJaXQ2NTA1
X3Jlc2V0X2xvZ2ljKGl0NjUwNSk7Cj4gKwlpdDY1MDVfaW50X21hc2tfZW5hYmxlKGl0NjUwNSk7
Cj4gKwlpdDY1MDVfaW5pdChpdDY1MDUpOwo+ICsJaXQ2NTA1X2xhbmVfb2ZmKGl0NjUwNSk7Cj4g
Kwo+ICsJaXQ2NTA1LT5wb3dlcmVkID0gdHJ1ZTsKPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsK
PiArc3RhdGljIGludCBpdDY1MDVfcG93ZXJvZmYoc3RydWN0IGl0NjUwNSAqaXQ2NTA1KQo+ICt7
Cj4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmaXQ2NTA1LT5jbGllbnQtPmRldjsKPiArCXN0cnVj
dCBpdDY1MDVfcGxhdGZvcm1fZGF0YSAqcGRhdGEgPSAmaXQ2NTA1LT5wZGF0YTsKPiArCWludCBl
cnI7Cj4gKwo+ICsJaWYgKCFpdDY1MDUtPnBvd2VyZWQpIHsKPiArCQlEUk1fREVWX0RFQlVHX0RS
SVZFUihkZXYsICJwb3dlciBoYWQgYmVlbiBhbHJlYWR5IG9mZiIpOwo+ICsJCXJldHVybiAwOwo+
ICsJfQo+ICsKPiArCWlmIChwZGF0YS0+Z3Bpb2RfcmVzZXQpCj4gKwkJZ3Bpb2Rfc2V0X3ZhbHVl
X2NhbnNsZWVwKHBkYXRhLT5ncGlvZF9yZXNldCwgMCk7Cj4gKwo+ICsJaWYgKHBkYXRhLT5wd3Ix
OCkgewo+ICsJCWVyciA9IHJlZ3VsYXRvcl9kaXNhYmxlKHBkYXRhLT5wd3IxOCk7Cj4gKwkJaWYg
KGVycikKPiArCQkJcmV0dXJuIGVycjsKPiArCX0KPiArCj4gKwlpZiAocGRhdGEtPm92ZGQpIHsK
PiArCQllcnIgPSByZWd1bGF0b3JfZGlzYWJsZShwZGF0YS0+b3ZkZCk7Cj4gKwkJaWYgKGVycikK
PiArCQkJcmV0dXJuIGVycjsKPiArCX0KPiArCj4gKwlpdDY1MDUtPnBvd2VyZWQgPSBmYWxzZTsK
PiArCWtmcmVlKGl0NjUwNS0+ZWRpZCk7Cj4gKwlpdDY1MDUtPmVkaWQgPSBOVUxMOwo+ICsJaXQ2
NTA1LT5zaW5rX2NvdW50ID0gMDsKPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGlj
IGlubGluZSBzdHJ1Y3QgaXQ2NTA1ICpjb25uZWN0b3JfdG9faXQ2NTA1KHN0cnVjdCBkcm1fY29u
bmVjdG9yICpjKQo+ICt7Cj4gKwlyZXR1cm4gY29udGFpbmVyX29mKGMsIHN0cnVjdCBpdDY1MDUs
IGNvbm5lY3Rvcik7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgaXQ2NTA1X2dldF9tb2RlcyhzdHJ1
Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ICt7Cj4gKwlzdHJ1Y3QgaXQ2NTA1ICppdDY1
MDUgPSBjb25uZWN0b3JfdG9faXQ2NTA1KGNvbm5lY3Rvcik7Cj4gKwlpbnQgZXJyLCBudW1fbW9k
ZXMgPSAwLCBpOwo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJml0NjUwNS0+Y2xpZW50LT5kZXY7
Cj4gKwo+ICsJaWYgKGl0NjUwNS0+ZWRpZCkKPiArCQlyZXR1cm4gZHJtX2FkZF9lZGlkX21vZGVz
KGNvbm5lY3RvciwgaXQ2NTA1LT5lZGlkKTsKPiArCj4gKwltdXRleF9sb2NrKCZpdDY1MDUtPm1v
ZGVfbG9jayk7Cj4gKwlpbml0X2NvbXBsZXRpb24oJml0NjUwNS0+d2FpdF9lZGlkX2NvbXBsZXRl
KTsKPiArCj4gKwlmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKSB7Cj4gKwkJaWYgKCFpdDY1MDVfZ2V0
X3NpbmtfaHBkX3N0YXR1cyhpdDY1MDUpKQo+ICsJCQlnb3RvIHVubG9jazsKPiArCj4gKwkJaXQ2
NTA1LT5lZGlkID0KPiArCQlkcm1fZG9fZ2V0X2VkaWQoJml0NjUwNS0+Y29ubmVjdG9yLCBpdDY1
MDVfZ2V0X2VkaWRfYmxvY2ssCj4gKwkJCQlpdDY1MDUpOwo+ICsKPiArCQlpZiAoaXQ2NTA1LT5l
ZGlkKQo+ICsJCQlicmVhazsKPiArCX0KPiArCWlmICghaXQ2NTA1LT5lZGlkKSB7Cj4gKwkJRFJN
X0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8gcmVhZCBFRElEIik7Cj4gKwkJZ290byB1bmxvY2s7
Cj4gKwl9Cj4gKwo+ICsJZXJyID0gZHJtX2Nvbm5lY3Rvcl91cGRhdGVfZWRpZF9wcm9wZXJ0eShj
b25uZWN0b3IsIGl0NjUwNS0+ZWRpZCk7Cj4gKwlpZiAoZXJyKSB7Cj4gKwkJRFJNX0RFVl9FUlJP
UihkZXYsICJGYWlsZWQgdG8gdXBkYXRlIEVESUQgcHJvcGVydHk6ICVkIiwgZXJyKTsKPiArCQln
b3RvIHVubG9jazsKPiArCX0KPiArCj4gKwludW1fbW9kZXMgPSBkcm1fYWRkX2VkaWRfbW9kZXMo
Y29ubmVjdG9yLCBpdDY1MDUtPmVkaWQpOwo+ICsKPiArdW5sb2NrOgo+ICsJY29tcGxldGUoJml0
NjUwNS0+d2FpdF9lZGlkX2NvbXBsZXRlKTsKPiArCW11dGV4X3VubG9jaygmaXQ2NTA1LT5tb2Rl
X2xvY2spOwo+ICsKPiArCXJldHVybiBudW1fbW9kZXM7Cj4gK30KPiArCj4gK3N0YXRpYyBjb25z
dCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9oZWxwZXJfZnVuY3MgaXQ2NTA1X2Nvbm5lY3Rvcl9oZWxw
ZXJfZnVuY3MgPSB7Cj4gKwkuZ2V0X21vZGVzID0gaXQ2NTA1X2dldF9tb2RlcywKPiArfTsKPiAr
Cj4gK3N0YXRpYyBlbnVtIGRybV9jb25uZWN0b3Jfc3RhdHVzIGl0NjUwNV9kZXRlY3Qoc3RydWN0
IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKPiArCQkJCQkgICAgICAgYm9vbCBmb3JjZSkKPiAr
ewo+ICsJc3RydWN0IGl0NjUwNSAqaXQ2NTA1ID0gY29ubmVjdG9yX3RvX2l0NjUwNShjb25uZWN0
b3IpOwo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJml0NjUwNS0+Y2xpZW50LT5kZXY7Cj4gKwll
bnVtIGRybV9jb25uZWN0b3Jfc3RhdHVzIHN0YXR1cyA9IGNvbm5lY3Rvcl9zdGF0dXNfZGlzY29u
bmVjdGVkOwo+ICsKPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIml0NjUwNS0+c2lua19j
b3VudDolZCBwb3dlcmVkOiVkIiwKPiArCQkJICAgICBpdDY1MDUtPnNpbmtfY291bnQsIGl0NjUw
NS0+cG93ZXJlZCk7Cj4gKwo+ICsJbXV0ZXhfbG9jaygmaXQ2NTA1LT5tb2RlX2xvY2spOwo+ICsK
PiArCWlmICghaXQ2NTA1LT5wb3dlcmVkKQo+ICsJCWdvdG8gdW5sb2NrOwo+ICsKPiArCWlmIChp
dDY1MDUtPmVuYWJsZV9kcnZfaG9sZCkgewo+ICsJCXN0YXR1cyA9IGl0NjUwNV9nZXRfc2lua19o
cGRfc3RhdHVzKGl0NjUwNSkgPwo+ICsJCQkJCWNvbm5lY3Rvcl9zdGF0dXNfY29ubmVjdGVkIDoK
PiArCQkJCQljb25uZWN0b3Jfc3RhdHVzX2Rpc2Nvbm5lY3RlZDsKPiArCQlnb3RvIHVubG9jazsK
PiArCX0KPiArCj4gKwlpZiAoaXQ2NTA1X2dldF9zaW5rX2hwZF9zdGF0dXMoaXQ2NTA1KSkgewo+
ICsJCWl0NjUwNV9hdXhfb24oaXQ2NTA1KTsKPiArCQlpdDY1MDVfZHJtX2RwX2xpbmtfcHJvYmUo
Jml0NjUwNS0+YXV4LCAmaXQ2NTA1LT5saW5rKTsKPiArCQlpdDY1MDVfZHJtX2RwX2xpbmtfcG93
ZXJfdXAoJml0NjUwNS0+YXV4LCAmaXQ2NTA1LT5saW5rKTsKPiArCQlpdDY1MDUtPmF1dG9fdHJh
aW5fcmV0cnkgPSBBVVRPX1RSQUlOX1JFVFJZOwo+ICsKPiArCQlpZiAoaXQ2NTA1LT5kcGNkWzBd
ID09IDApIHsKPiArCQkJaXQ2NTA1X2dldF9kcGNkKGl0NjUwNSwgRFBfRFBDRF9SRVYsIGl0NjUw
NS0+ZHBjZCwKPiArCQkJCQlBUlJBWV9TSVpFKGl0NjUwNS0+ZHBjZCkpOwo+ICsJCQlpdDY1MDVf
dmFyaWFibGVfY29uZmlnKGl0NjUwNSk7Cj4gKwkJCWl0NjUwNV9wYXJzZV9saW5rX2NhcGFiaWxp
dGllcyhpdDY1MDUpOwo+ICsJCX0KPiArCj4gKwkJaXQ2NTA1LT5zaW5rX2NvdW50ID0gRFBfR0VU
X1NJTktfQ09VTlQoaXQ2NTA1X2RwY2RfcmVhZChpdDY1MDUsCj4gKwkJCQkJCSAgICAgICBEUF9T
SU5LX0NPVU5UKSk7Cj4gKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiaXQ2NTA1LT5zaW5r
X2NvdW50OiVkIGJyYW5jaDolZCIsCj4gKwkJCQkgICAgIGl0NjUwNS0+c2lua19jb3VudCwgaXQ2
NTA1LT5icmFuY2hfZGV2aWNlKTsKPiArCj4gKwkJaWYgKGl0NjUwNS0+YnJhbmNoX2RldmljZSkg
ewo+ICsJCQlzdGF0dXMgPSAoaXQ2NTA1LT5zaW5rX2NvdW50ICE9IDApID8KPiArCQkJCSBjb25u
ZWN0b3Jfc3RhdHVzX2Nvbm5lY3RlZCA6Cj4gKwkJCQkgY29ubmVjdG9yX3N0YXR1c19kaXNjb25u
ZWN0ZWQ7Cj4gKwkJfSBlbHNlIHsKPiArCQkJc3RhdHVzID0gY29ubmVjdG9yX3N0YXR1c19jb25u
ZWN0ZWQ7Cj4gKwkJfQo+ICsJfSBlbHNlIHsKPiArCQlpdDY1MDUtPnNpbmtfY291bnQgPSAwOwo+
ICsJCW1lbXNldChpdDY1MDUtPmRwY2QsIDAsIHNpemVvZihpdDY1MDUtPmRwY2QpKTsKPiArCX0K
PiArCj4gK3VubG9jazoKPiArCWlmIChpdDY1MDUtPmNvbm5lY3Rvcl9zdGF0dXMgIT0gc3RhdHVz
KSB7Cj4gKwkJaXQ2NTA1LT5jb25uZWN0b3Jfc3RhdHVzID0gc3RhdHVzOwo+ICsJCWl0NjUwNV9w
bHVnZ2VkX3N0YXR1c190b19jb2RlYyhpdDY1MDUpOwo+ICsJfQo+ICsKPiArCW11dGV4X3VubG9j
aygmaXQ2NTA1LT5tb2RlX2xvY2spOwo+ICsKPiArCXJldHVybiBzdGF0dXM7Cj4gK30KPiArCj4g
K3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9mdW5jcyBpdDY1MDVfY29ubmVjdG9y
X2Z1bmNzID0gewo+ICsJLmZpbGxfbW9kZXMgPSBkcm1faGVscGVyX3Byb2JlX3NpbmdsZV9jb25u
ZWN0b3JfbW9kZXMsCj4gKwkuZGV0ZWN0ID0gaXQ2NTA1X2RldGVjdCwKPiArCS5kZXN0cm95ID0g
ZHJtX2Nvbm5lY3Rvcl9jbGVhbnVwLAo+ICsJLnJlc2V0ID0gZHJtX2F0b21pY19oZWxwZXJfY29u
bmVjdG9yX3Jlc2V0LAo+ICsJLmF0b21pY19kdXBsaWNhdGVfc3RhdGUgPSBkcm1fYXRvbWljX2hl
bHBlcl9jb25uZWN0b3JfZHVwbGljYXRlX3N0YXRlLAo+ICsJLmF0b21pY19kZXN0cm95X3N0YXRl
ID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2Rlc3Ryb3lfc3RhdGUsCj4gK307Cj4gKwo+
ICtzdGF0aWMgaW50IGl0NjUwNV9leHRjb25fbm90aWZpZXIoc3RydWN0IG5vdGlmaWVyX2Jsb2Nr
ICpzZWxmLAo+ICsJCQkJICB1bnNpZ25lZCBsb25nIGV2ZW50LCB2b2lkICpwdHIpCj4gK3sKPiAr
CXN0cnVjdCBpdDY1MDUgKml0NjUwNSA9IGNvbnRhaW5lcl9vZihzZWxmLCBzdHJ1Y3QgaXQ2NTA1
LCBldmVudF9uYik7Cj4gKwo+ICsJc2NoZWR1bGVfd29yaygmaXQ2NTA1LT5leHRjb25fd3EpOwo+
ICsJcmV0dXJuIE5PVElGWV9ET05FOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBpdDY1MDVfZXh0
Y29uX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICt7Cj4gKwlzdHJ1Y3QgaXQ2NTA1
ICppdDY1MDUgPSBjb250YWluZXJfb2Yod29yaywgc3RydWN0IGl0NjUwNSwgZXh0Y29uX3dxKTsK
PiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZpdDY1MDUtPmNsaWVudC0+ZGV2Owo+ICsJaW50IHN0
YXRlID0gZXh0Y29uX2dldF9zdGF0ZShpdDY1MDUtPmV4dGNvbiwgRVhUQ09OX0RJU1BfRFApOwo+
ICsJdW5zaWduZWQgaW50IHB3cm9mZnJldHJ5ID0gMDsKPiArCj4gKwlpZiAoaXQ2NTA1LT5lbmFi
bGVfZHJ2X2hvbGQpCj4gKwkJcmV0dXJuOwo+ICsKPiArCW11dGV4X2xvY2soJml0NjUwNS0+ZXh0
Y29uX2xvY2spOwo+ICsKPiArCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIkVYVENPTl9ESVNQ
X0RQID0gMHglMDJ4Iiwgc3RhdGUpOwo+ICsJaWYgKHN0YXRlID4gMCkgewo+ICsJCURSTV9ERVZf
REVCVUdfRFJJVkVSKGRldiwgInN0YXJ0IHRvIHBvd2VyIG9uIik7Cj4gKwkJbXNsZWVwKDEwMCk7
Cj4gKwkJaXQ2NTA1X3Bvd2Vyb24oaXQ2NTA1KTsKPiArCX0gZWxzZSB7Cj4gKwkJRFJNX0RFVl9E
RUJVR19EUklWRVIoZGV2LCAic3RhcnQgdG8gcG93ZXIgb2ZmIik7Cj4gKwkJd2hpbGUgKGl0NjUw
NV9wb3dlcm9mZihpdDY1MDUpICYmIHB3cm9mZnJldHJ5KysgPCA1KSB7Cj4gKwkJCURSTV9ERVZf
REVCVUdfRFJJVkVSKGRldiwgInBvd2VyIG9mZiBmYWlsICVkIHRpbWVzIiwKPiArCQkJCQkgICAg
IHB3cm9mZnJldHJ5KTsKPiArCQl9Cj4gKwo+ICsJCWRybV9oZWxwZXJfaHBkX2lycV9ldmVudChp
dDY1MDUtPmNvbm5lY3Rvci5kZXYpOwo+ICsJCW1lbXNldChpdDY1MDUtPmRwY2QsIDAsIHNpemVv
ZihpdDY1MDUtPmRwY2QpKTsKPiArCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJwb3dlciBv
ZmYgaXQ2NTA1IHN1Y2Nlc3MhIik7Cj4gKwl9Cj4gKwo+ICsJbXV0ZXhfdW5sb2NrKCZpdDY1MDUt
PmV4dGNvbl9sb2NrKTsKPiArfQo+ICsKPiArc3RhdGljIGludCBpdDY1MDVfdXNlX25vdGlmaWVy
X21vZHVsZShzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUpCj4gK3sKPiArCWludCByZXQ7Cj4gKwlzdHJ1
Y3QgZGV2aWNlICpkZXYgPSAmaXQ2NTA1LT5jbGllbnQtPmRldjsKPiArCj4gKwlpdDY1MDUtPmV2
ZW50X25iLm5vdGlmaWVyX2NhbGwgPSBpdDY1MDVfZXh0Y29uX25vdGlmaWVyOwo+ICsJSU5JVF9X
T1JLKCZpdDY1MDUtPmV4dGNvbl93cSwgaXQ2NTA1X2V4dGNvbl93b3JrKTsKPiArCXJldCA9IGRl
dm1fZXh0Y29uX3JlZ2lzdGVyX25vdGlmaWVyKCZpdDY1MDUtPmNsaWVudC0+ZGV2LAo+ICsJCQkJ
CSAgICBpdDY1MDUtPmV4dGNvbiwgRVhUQ09OX0RJU1BfRFAsCj4gKwkJCQkJICAgICZpdDY1MDUt
PmV2ZW50X25iKTsKPiArCWlmIChyZXQpIHsKPiArCQlEUk1fREVWX0VSUk9SKGRldiwgImZhaWxl
ZCB0byByZWdpc3RlciBub3RpZmllciBmb3IgRFAiKTsKPiArCQlyZXR1cm4gcmV0Owo+ICsJfQo+
ICsKPiArCXNjaGVkdWxlX3dvcmsoJml0NjUwNS0+ZXh0Y29uX3dxKTsKPiArCj4gKwlyZXR1cm4g
MDsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgaXQ2NTA1X3JlbW92ZV9ub3RpZmllcl9tb2R1bGUo
c3RydWN0IGl0NjUwNSAqaXQ2NTA1KQo+ICt7Cj4gKwlpZiAoaXQ2NTA1LT5leHRjb24pIHsKPiAr
CQlkZXZtX2V4dGNvbl91bnJlZ2lzdGVyX25vdGlmaWVyKCZpdDY1MDUtPmNsaWVudC0+ZGV2LAo+
ICsJCQkJCQlpdDY1MDUtPmV4dGNvbiwJRVhUQ09OX0RJU1BfRFAsCj4gKwkJCQkJCSZpdDY1MDUt
PmV2ZW50X25iKTsKPiArCj4gKwkJZmx1c2hfd29yaygmaXQ2NTA1LT5leHRjb25fd3EpOwo+ICsJ
fQo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBfX21heWJlX3VudXNlZCBpdDY1MDVfZGVsYXllZF9h
dWRpbyhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gK3sKPiArCXN0cnVjdCBpdDY1MDUgKml0
NjUwNSA9IGNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3QgaXQ2NTA1LAo+ICsJCQkJCSAgICAgZGVs
YXllZF9hdWRpby53b3JrKTsKPiArCj4gKwlEUk1fREVWX0RFQlVHX0RSSVZFUigmaXQ2NTA1LT5j
bGllbnQtPmRldiwgInN0YXJ0Iik7Cj4gKwo+ICsJaWYgKCFpdDY1MDUtPnBvd2VyZWQpCj4gKwkJ
cmV0dXJuOwo+ICsKPiArCWlmICghaXQ2NTA1LT5lbmFibGVfZHJ2X2hvbGQpCj4gKwkJaXQ2NTA1
X2VuYWJsZV9hdWRpbyhpdDY1MDUpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IF9fbWF5YmVfdW51
c2VkIGl0NjUwNV9hdWRpb19zZXR1cF9od19wYXJhbXMoc3RydWN0IGl0NjUwNSAqaXQ2NTA1LAo+
ICsJCQkJCXN0cnVjdCBoZG1pX2NvZGVjX3BhcmFtcyAqcGFyYW1zKQo+ICt7Cj4gKwlzdHJ1Y3Qg
ZGV2aWNlICpkZXYgPSAmaXQ2NTA1LT5jbGllbnQtPmRldjsKPiArCWludCBpID0gMDsKPiArCj4g
KwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICIlcyAlZCBIeiwgJWQgYml0LCAlZCBjaGFubmVs
c1xuIiwgX19mdW5jX18sCj4gKwkJCSAgICAgcGFyYW1zLT5zYW1wbGVfcmF0ZSwgcGFyYW1zLT5z
YW1wbGVfd2lkdGgsCj4gKwkJCSAgICAgcGFyYW1zLT5jZWEuY2hhbm5lbHMpOwo+ICsKPiArCWlm
ICghaXQ2NTA1LT5icmlkZ2UuZW5jb2RlcikKPiArCQlyZXR1cm4gLUVOT0RFVjsKPiArCj4gKwlp
ZiAocGFyYW1zLT5jZWEuY2hhbm5lbHMgPD0gMSB8fCBwYXJhbXMtPmNlYS5jaGFubmVscyA+IDgp
IHsKPiArCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJjaGFubmVsIG51bWJlcjogJWQgbm90
IHN1cHBvcnQiLAo+ICsJCQkJICAgICBpdDY1MDUtPmF1ZGlvLmNoYW5uZWxfY291bnQpOwo+ICsJ
CXJldHVybiAtRUlOVkFMOwo+ICsJfQo+ICsKPiArCWl0NjUwNS0+YXVkaW8uY2hhbm5lbF9jb3Vu
dCA9IHBhcmFtcy0+Y2VhLmNoYW5uZWxzOwo+ICsKPiArCXdoaWxlIChpIDwgQVJSQVlfU0laRShh
dWRpb19zYW1wbGVfcmF0ZV9tYXApICYmCj4gKwkgICAgICAgcGFyYW1zLT5zYW1wbGVfcmF0ZSAh
PQo+ICsJCSAgICAgICBhdWRpb19zYW1wbGVfcmF0ZV9tYXBbaV0uc2FtcGxlX3JhdGVfdmFsdWUp
IHsKPiArCQlpKys7Cj4gKwl9Cj4gKwlpZiAoaSA9PSBBUlJBWV9TSVpFKGF1ZGlvX3NhbXBsZV9y
YXRlX21hcCkpIHsKPiArCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJzYW1wbGUgcmF0ZTog
JWQgSHogbm90IHN1cHBvcnQiLAo+ICsJCQkJICAgICBwYXJhbXMtPnNhbXBsZV9yYXRlKTsKPiAr
CQlyZXR1cm4gLUVJTlZBTDsKPiArCX0KPiArCWl0NjUwNS0+YXVkaW8uc2FtcGxlX3JhdGUgPSBh
dWRpb19zYW1wbGVfcmF0ZV9tYXBbaV0ucmF0ZTsKPiArCj4gKwlzd2l0Y2ggKHBhcmFtcy0+c2Ft
cGxlX3dpZHRoKSB7Cj4gKwljYXNlIDE2Ogo+ICsJCWl0NjUwNS0+YXVkaW8ud29yZF9sZW5ndGgg
PSBXT1JEX0xFTkdUSF8xNkJJVDsKPiArCQlicmVhazsKPiArCWNhc2UgMTg6Cj4gKwkJaXQ2NTA1
LT5hdWRpby53b3JkX2xlbmd0aCA9IFdPUkRfTEVOR1RIXzE4QklUOwo+ICsJCWJyZWFrOwo+ICsJ
Y2FzZSAyMDoKPiArCQlpdDY1MDUtPmF1ZGlvLndvcmRfbGVuZ3RoID0gV09SRF9MRU5HVEhfMjBC
SVQ7Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIDI0Ogo+ICsJY2FzZSAzMjoKPiArCQlpdDY1MDUtPmF1
ZGlvLndvcmRfbGVuZ3RoID0gV09SRF9MRU5HVEhfMjRCSVQ7Cj4gKwkJYnJlYWs7Cj4gKwlkZWZh
dWx0Ogo+ICsJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIndvcmRsZW5ndGg6ICVkIGJpdCBu
b3Qgc3VwcG9ydCIsCj4gKwkJCQkgICAgIHBhcmFtcy0+c2FtcGxlX3dpZHRoKTsKPiArCQlyZXR1
cm4gLUVJTlZBTDsKPiArCX0KPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIHZv
aWQgX19tYXliZV91bnVzZWQgaXQ2NTA1X2F1ZGlvX3NodXRkb3duKHN0cnVjdCBkZXZpY2UgKmRl
diwgdm9pZCAqZGF0YSkKPiArewo+ICsJc3RydWN0IGl0NjUwNSAqaXQ2NTA1ID0gZGV2X2dldF9k
cnZkYXRhKGRldik7Cj4gKwo+ICsJaWYgKGl0NjUwNS0+cG93ZXJlZCkKPiArCQlpdDY1MDVfZGlz
YWJsZV9hdWRpbyhpdDY1MDUpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IF9fbWF5YmVfdW51c2Vk
IGl0NjUwNV9hdWRpb19ob29rX3BsdWdnZWRfY2Ioc3RydWN0IGRldmljZSAqZGV2LAo+ICsJCQkJ
CQkgICAgICAgdm9pZCAqZGF0YSwKPiArCQkJCQkJICAgICAgIGhkbWlfY29kZWNfcGx1Z2dlZF9j
YiBmbiwKPiArCQkJCQkJICAgICAgIHN0cnVjdCBkZXZpY2UgKmNvZGVjX2RldikKPiArewo+ICsJ
c3RydWN0IGl0NjUwNSAqaXQ2NTA1ID0gZGF0YTsKPiArCj4gKwlpdDY1MDUtPnBsdWdnZWRfY2Ig
PSBmbjsKPiArCWl0NjUwNS0+Y29kZWNfZGV2ID0gY29kZWNfZGV2Owo+ICsJaXQ2NTA1X3BsdWdn
ZWRfc3RhdHVzX3RvX2NvZGVjKGl0NjUwNSk7Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4g
K3N0YXRpYyBpbmxpbmUgc3RydWN0IGl0NjUwNSAqYnJpZGdlX3RvX2l0NjUwNShzdHJ1Y3QgZHJt
X2JyaWRnZSAqYnJpZGdlKQo+ICt7Cj4gKwlyZXR1cm4gY29udGFpbmVyX29mKGJyaWRnZSwgc3Ry
dWN0IGl0NjUwNSwgYnJpZGdlKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgaXQ2NTA1X2JyaWRn
ZV9tb2RlX3NldChzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAo+ICsJCQkJICAgY29uc3Qgc3Ry
dWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUsCj4gKwkJCQkgICBjb25zdCBzdHJ1Y3QgZHJtX2Rp
c3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSkKPiArewo+ICsJc3RydWN0IGl0NjUwNSAqaXQ2NTA1
ID0gYnJpZGdlX3RvX2l0NjUwNShicmlkZ2UpOwo+ICsJc3RydWN0IGhkbWlfYXZpX2luZm9mcmFt
ZSBmcmFtZTsKPiArCWludCBlcnI7Cj4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmaXQ2NTA1LT5j
bGllbnQtPmRldjsKPiArCj4gKwlpZiAoV0FSTl9PTighaXQ2NTA1LT5wb3dlcmVkKSkKPiArCQly
ZXR1cm47Cj4gKwo+ICsJbXV0ZXhfbG9jaygmaXQ2NTA1LT5tb2RlX2xvY2spOwo+ICsKPiArCWVy
ciA9IGRybV9oZG1pX2F2aV9pbmZvZnJhbWVfZnJvbV9kaXNwbGF5X21vZGUoJmZyYW1lLAo+ICsJ
CQkJCQkgICAgICAgJml0NjUwNS0+Y29ubmVjdG9yLAo+ICsJCQkJCQkgICAgICAgYWRqdXN0ZWRf
bW9kZSk7Cj4gKwlpZiAoZXJyKSB7Cj4gKwkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8g
c2V0dXAgQVZJIGluZm9mcmFtZTogJWQiLCBlcnIpOwo+ICsJCWdvdG8gdW5sb2NrOwo+ICsJfQo+
ICsKPiArCWl0NjUwNV91cGRhdGVfdmlkZW9fcHJhcm1ldGVyKGl0NjUwNSwgYWRqdXN0ZWRfbW9k
ZSk7Cj4gKwo+ICsJZXJyID0gaXQ2NTA1X3NlbmRfdmlkZW9faW5mb2ZyYW1lKGl0NjUwNSwgJmZy
YW1lKTsKPiArCWlmIChlcnIpCj4gKwkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8gc2Vu
ZCBBVkkgaW5mb2ZyYW1lOiAlZCIsIGVycik7Cj4gKwo+ICt1bmxvY2s6Cj4gKwltdXRleF91bmxv
Y2soJml0NjUwNS0+bW9kZV9sb2NrKTsKPiArfQo+ICsKPiArc3RhdGljIGludCBpdDY1MDVfYnJp
ZGdlX2F0dGFjaChzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAo+ICsJCQkJZW51bSBkcm1fYnJp
ZGdlX2F0dGFjaF9mbGFncyBmbGFncykKPiArewo+ICsJc3RydWN0IGl0NjUwNSAqaXQ2NTA1ID0g
YnJpZGdlX3RvX2l0NjUwNShicmlkZ2UpOwo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJml0NjUw
NS0+Y2xpZW50LT5kZXY7Cj4gKwlpbnQgZXJyOwo+ICsKPiArCWlmICghYnJpZGdlLT5lbmNvZGVy
KSB7Cj4gKwkJRFJNX0RFVl9FUlJPUihkZXYsICJQYXJlbnQgZW5jb2RlciBvYmplY3Qgbm90IGZv
dW5kIik7Cj4gKwkJcmV0dXJuIC1FTk9ERVY7Cj4gKwl9Cj4gKwo+ICsJZXJyID0gZHJtX2Nvbm5l
Y3Rvcl9pbml0KGJyaWRnZS0+ZGV2LCAmaXQ2NTA1LT5jb25uZWN0b3IsCj4gKwkJCQkgJml0NjUw
NV9jb25uZWN0b3JfZnVuY3MsCj4gKwkJCQkgRFJNX01PREVfQ09OTkVDVE9SX0Rpc3BsYXlQb3J0
KTsKPiArCWlmIChlcnIgPCAwKSB7Cj4gKwkJRFJNX0RFVl9FUlJPUihkZXYsICJGYWlsZWQgdG8g
aW5pdGlhbGl6ZSBjb25uZWN0b3I6ICVkIiwgZXJyKTsKPiArCQlyZXR1cm4gZXJyOwo+ICsJfQo+
ICsKPiArCWRybV9jb25uZWN0b3JfaGVscGVyX2FkZCgmaXQ2NTA1LT5jb25uZWN0b3IsCj4gKwkJ
CQkgJml0NjUwNV9jb25uZWN0b3JfaGVscGVyX2Z1bmNzKTsKPiArCj4gKwlpdDY1MDUtPmNvbm5l
Y3Rvci5wb2xsZWQgPSBEUk1fQ09OTkVDVE9SX1BPTExfSFBEOwo+ICsKPiArCWVyciA9IGRybV9j
b25uZWN0b3JfYXR0YWNoX2VuY29kZXIoJml0NjUwNS0+Y29ubmVjdG9yLCBicmlkZ2UtPmVuY29k
ZXIpOwo+ICsJaWYgKGVyciA8IDApIHsKPiArCQlEUk1fREVWX0VSUk9SKGRldiwgIkZhaWxlZCB0
byBsaW5rIHVwIGNvbm5lY3RvciB0byBlbmNvZGVyOiAlZCIsCj4gKwkJCSAgICAgIGVycik7Cj4g
KwkJZ290byBjbGVhbnVwX2Nvbm5lY3RvcjsKPiArCX0KPiArCj4gKwllcnIgPSBkcm1fY29ubmVj
dG9yX3JlZ2lzdGVyKCZpdDY1MDUtPmNvbm5lY3Rvcik7Cj4gKwlpZiAoZXJyIDwgMCkgewo+ICsJ
CURSTV9ERVZfRVJST1IoZGV2LCAiRmFpbGVkIHRvIHJlZ2lzdGVyIGNvbm5lY3RvcjogJWQiLCBl
cnIpOwo+ICsJCWdvdG8gY2xlYW51cF9jb25uZWN0b3I7Cj4gKwl9Cj4gKwo+ICsJaWYgKGl0NjUw
NS0+ZXh0Y29uKSB7Cj4gKwkJZXJyID0gaXQ2NTA1X3VzZV9ub3RpZmllcl9tb2R1bGUoaXQ2NTA1
KTsKPiArCQlpZiAoZXJyIDwgMCkgewo+ICsJCQlkcm1fY29ubmVjdG9yX3VucmVnaXN0ZXIoJml0
NjUwNS0+Y29ubmVjdG9yKTsKPiArCQkJZ290byBjbGVhbnVwX2Nvbm5lY3RvcjsKPiArCQl9Cj4g
Kwl9Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gKwo+ICtjbGVhbnVwX2Nvbm5lY3RvcjoKPiArCWRybV9j
b25uZWN0b3JfY2xlYW51cCgmaXQ2NTA1LT5jb25uZWN0b3IpOwo+ICsJcmV0dXJuIGVycjsKPiAr
fQo+ICsKPiArc3RhdGljIHZvaWQgaXQ2NTA1X2JyaWRnZV9kZXRhY2goc3RydWN0IGRybV9icmlk
Z2UgKmJyaWRnZSkKPiArewo+ICsJc3RydWN0IGl0NjUwNSAqaXQ2NTA1ID0gYnJpZGdlX3RvX2l0
NjUwNShicmlkZ2UpOwo+ICsKPiArCWZsdXNoX3dvcmsoJml0NjUwNS0+bGlua193b3Jrcyk7Cj4g
KwlpdDY1MDVfcmVtb3ZlX25vdGlmaWVyX21vZHVsZShpdDY1MDUpOwo+ICsJZHJtX2Nvbm5lY3Rv
cl91bnJlZ2lzdGVyKCZpdDY1MDUtPmNvbm5lY3Rvcik7Cj4gKwlkcm1fY29ubmVjdG9yX2NsZWFu
dXAoJml0NjUwNS0+Y29ubmVjdG9yKTsKPiArfQo+ICsKPiArc3RhdGljIGVudW0gZHJtX21vZGVf
c3RhdHVzCj4gK2l0NjUwNV9icmlkZ2VfbW9kZV92YWxpZChzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJp
ZGdlLAo+ICsJCQkgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X2luZm8gKmluZm8sCj4gKwkJCSBj
b25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkKPiArewo+ICsJc3RydWN0IGl0NjUw
NSAqaXQ2NTA1ID0gYnJpZGdlX3RvX2l0NjUwNShicmlkZ2UpOwo+ICsKPiArCWlmIChtb2RlLT5m
bGFncyAmIERSTV9NT0RFX0ZMQUdfSU5URVJMQUNFKQo+ICsJCXJldHVybiBNT0RFX05PX0lOVEVS
TEFDRTsKPiArCj4gKwlpZiAobW9kZS0+Y2xvY2sgPiBEUElfUElYRUxfQ0xLX01BWCkKPiArCQly
ZXR1cm4gTU9ERV9DTE9DS19ISUdIOwo+ICsKPiArCWl0NjUwNS0+dmlkZW9faW5mby5jbG9jayA9
IG1vZGUtPmNsb2NrOwo+ICsKPiArCXJldHVybiBNT0RFX09LOwo+ICt9Cj4gKwo+ICtzdGF0aWMg
dm9pZCBpdDY1MDVfYnJpZGdlX2VuYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQo+ICt7
Cj4gKwlzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUgPSBicmlkZ2VfdG9faXQ2NTA1KGJyaWRnZSk7Cj4g
Kwo+ICsJaXQ2NTA1X2ludF9tYXNrX2VuYWJsZShpdDY1MDUpOwo+ICsJaXQ2NTA1X3ZpZGVvX3Jl
c2V0KGl0NjUwNSk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGl0NjUwNV9icmlkZ2VfZGlzYWJs
ZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQo+ICt7Cj4gKwlzdHJ1Y3QgaXQ2NTA1ICppdDY1
MDUgPSBicmlkZ2VfdG9faXQ2NTA1KGJyaWRnZSk7Cj4gKwo+ICsJaWYgKGl0NjUwNS0+cG93ZXJl
ZCkKPiArCQlpdDY1MDVfdmlkZW9fZGlzYWJsZShpdDY1MDUpOwo+ICt9Cj4gKwo+ICtzdGF0aWMg
Y29uc3Qgc3RydWN0IGRybV9icmlkZ2VfZnVuY3MgaXQ2NTA1X2JyaWRnZV9mdW5jcyA9IHsKPiAr
CS5hdHRhY2ggPSBpdDY1MDVfYnJpZGdlX2F0dGFjaCwKPiArCS5kZXRhY2ggPSBpdDY1MDVfYnJp
ZGdlX2RldGFjaCwKPiArCS5tb2RlX3ZhbGlkID0gaXQ2NTA1X2JyaWRnZV9tb2RlX3ZhbGlkLAo+
ICsJLm1vZGVfc2V0ID0gaXQ2NTA1X2JyaWRnZV9tb2RlX3NldCwKPiArCS5lbmFibGUgPSBpdDY1
MDVfYnJpZGdlX2VuYWJsZSwKPiArCS5kaXNhYmxlID0gaXQ2NTA1X2JyaWRnZV9kaXNhYmxlLAo+
ICt9Owo+ICsKPiArc3RhdGljIGludCBpdDY1MDVfYnJpZGdlX3Jlc3VtZShzdHJ1Y3QgZGV2aWNl
ICpkZXYpCj4gK3sKPiArCXN0cnVjdCBpdDY1MDUgKml0NjUwNSA9IGRldl9nZXRfZHJ2ZGF0YShk
ZXYpOwo+ICsKPiArCXJldHVybiBpdDY1MDVfcG93ZXJvbihpdDY1MDUpOwo+ICt9Cj4gKwo+ICtz
dGF0aWMgaW50IGl0NjUwNV9icmlkZ2Vfc3VzcGVuZChzdHJ1Y3QgZGV2aWNlICpkZXYpCj4gK3sK
PiArCXN0cnVjdCBpdDY1MDUgKml0NjUwNSA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwo+ICsKPiAr
CXJldHVybiBpdDY1MDVfcG93ZXJvZmYoaXQ2NTA1KTsKPiArfQo+ICsKPiArc3RhdGljIFNJTVBM
RV9ERVZfUE1fT1BTKGl0NjUwNV9icmlkZ2VfcG1fb3BzLCBpdDY1MDVfYnJpZGdlX3N1c3BlbmQs
Cj4gKwkJCSBpdDY1MDVfYnJpZGdlX3Jlc3VtZSk7Cj4gKwo+ICsKPiArCj4gK3N0YXRpYyBpbnQg
aXQ2NTA1X2luaXRfcGRhdGEoc3RydWN0IGl0NjUwNSAqaXQ2NTA1KQo+ICt7Cj4gKwlzdHJ1Y3Qg
aXQ2NTA1X3BsYXRmb3JtX2RhdGEgKnBkYXRhID0gJml0NjUwNS0+cGRhdGE7Cj4gKwlzdHJ1Y3Qg
ZGV2aWNlICpkZXYgPSAmaXQ2NTA1LT5jbGllbnQtPmRldjsKPiArCj4gKwkvKiAxLjBWIGRpZ2l0
YWwgY29yZSBwb3dlciByZWd1bGF0b3IgICovCj4gKwlwZGF0YS0+cHdyMTggPSBkZXZtX3JlZ3Vs
YXRvcl9nZXQoZGV2LCAicHdyMTgiKTsKPiArCWlmIChJU19FUlIocGRhdGEtPnB3cjE4KSkgewo+
ICsJCURSTV9ERVZfRVJST1IoZGV2LCAicHdyMTggcmVndWxhdG9yIG5vdCBmb3VuZCIpOwo+ICsJ
CXJldHVybiBQVFJfRVJSKHBkYXRhLT5wd3IxOCk7Cj4gKwl9Cj4gKwo+ICsJcGRhdGEtPm92ZGQg
PSBkZXZtX3JlZ3VsYXRvcl9nZXQoZGV2LCAib3ZkZCIpOwo+ICsJaWYgKElTX0VSUihwZGF0YS0+
b3ZkZCkpIHsKPiArCQlEUk1fREVWX0VSUk9SKGRldiwgIm92ZGQgcmVndWxhdG9yIG5vdCBmb3Vu
ZCIpOwo+ICsJCXJldHVybiBQVFJfRVJSKHBkYXRhLT5vdmRkKTsKPiArCX0KPiArCj4gKwlwZGF0
YS0+Z3Bpb2RfcmVzZXQgPSBkZXZtX2dwaW9kX2dldChkZXYsICJyZXNldCIsIEdQSU9EX09VVF9I
SUdIKTsKPiArCWlmIChJU19FUlIocGRhdGEtPmdwaW9kX3Jlc2V0KSkgewo+ICsJCURSTV9ERVZf
RVJST1IoZGV2LCAiZ3Bpb2RfcmVzZXQgZ3BpbyBub3QgZm91bmQiKTsKPiArCQlyZXR1cm4gUFRS
X0VSUihwZGF0YS0+Z3Bpb2RfcmVzZXQpOwo+ICsJfQo+ICsKPiArCXJldHVybiAwOwo+ICt9Cj4g
Kwo+ICtzdGF0aWMgdm9pZCBpdDY1MDVfcGFyc2VfZHQoc3RydWN0IGl0NjUwNSAqaXQ2NTA1KQo+
ICt7Cj4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmaXQ2NTA1LT5jbGllbnQtPmRldjsKPiArCXUz
MiBhZmVfc2V0dGluZyA9IDA7Cj4gKwo+ICsJaXQ2NTA1LT5sYW5lX3N3YXBfZGlzYWJsZWQgPSB0
cnVlOwo+ICsJaXQ2NTA1LT5hZmVfc2V0dGluZyA9IDA7Cj4gKwo+ICsJaXQ2NTA1LT5sYW5lX3N3
YXBfZGlzYWJsZWQgPQo+ICsJCWRldmljZV9wcm9wZXJ0eV9yZWFkX2Jvb2woZGV2LCAibm8tbGFu
ZXN3YXAiKTsKPiArCj4gKwlpZiAoaXQ2NTA1LT5sYW5lX3N3YXBfZGlzYWJsZWQpCj4gKwkJaXQ2
NTA1LT5sYW5lX3N3YXAgPSBmYWxzZTsKPiArCj4gKwlpZiAoZGV2aWNlX3Byb3BlcnR5X3JlYWRf
dTMyKGRldiwgImFmZS1zZXR0aW5nIiwgJmFmZV9zZXR0aW5nKSA9PSAwKQo+ICsJCWlmIChhZmVf
c2V0dGluZyA+PSBBUlJBWV9TSVpFKGFmZV9zZXR0aW5nX3RhYmxlKSkgewo+ICsJCQlEUk1fREVW
X0VSUk9SKGRldiwgImFmZSBzZXR0aW5nIGVycm9yLCB1c2UgZGVmYXVsdCIpOwo+ICsJCQlhZmVf
c2V0dGluZyA9IDA7Cj4gKwkJfQo+ICsKPiArCWl0NjUwNS0+YWZlX3NldHRpbmcgPSBhZmVfc2V0
dGluZzsKPiArfQo+ICsKPiArc3RhdGljIHNzaXplX3QgcHJpbnRfdGltaW5nX3Nob3coc3RydWN0
IGRldmljZSAqZGV2LAo+ICsJCQkJIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFy
ICpidWYpCj4gK3sKPiArCXN0cnVjdCBpdDY1MDUgKml0NjUwNSA9IGRldl9nZXRfZHJ2ZGF0YShk
ZXYpOwo+ICsJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKnZpZCA9ICZpdDY1MDUtPnZpZGVvX2lu
Zm87Cj4gKwljaGFyICpzdHIgPSBidWYsICplbmQgPSBidWYgKyBQQUdFX1NJWkU7Cj4gKwo+ICsJ
aXQ2NTA1X2NhbGNfdmlkZW9faW5mbyhpdDY1MDUpOwo+ICsJc3RyICs9IHNjbnByaW50ZihzdHIs
IGVuZCAtIHN0ciwgIi0tLXZpZGVvIHRpbWluZy0tLVxuIik7Cj4gKwlzdHIgKz0gc2NucHJpbnRm
KHN0ciwgZW5kIC0gc3RyLCAiUENMSzolZC4lMDNkTUh6XG4iLAo+ICsJCQkgdmlkLT5jbG9jayAv
IDEwMDAsIHZpZC0+Y2xvY2sgJSAxMDAwKTsKPiArCXN0ciArPSBzY25wcmludGYoc3RyLCBlbmQg
LSBzdHIsICJIVG90YWw6JWRcbiIsIHZpZC0+aHRvdGFsKTsKPiArCXN0ciArPSBzY25wcmludGYo
c3RyLCBlbmQgLSBzdHIsICJIQWN0aXZlOiVkXG4iLCB2aWQtPmhkaXNwbGF5KTsKPiArCXN0ciAr
PSBzY25wcmludGYoc3RyLCBlbmQgLSBzdHIsICJIRnJvbnRQb3JjaDolZFxuIiwKPiArCQkJIHZp
ZC0+aHN5bmNfc3RhcnQgLSB2aWQtPmhkaXNwbGF5KTsKPiArCXN0ciArPSBzY25wcmludGYoc3Ry
LCBlbmQgLSBzdHIsICJIU3luY1dpZHRoOiVkXG4iLAo+ICsJCQkgdmlkLT5oc3luY19lbmQgLSB2
aWQtPmhzeW5jX3N0YXJ0KTsKPiArCXN0ciArPSBzY25wcmludGYoc3RyLCBlbmQgLSBzdHIsICJI
QmFja1BvcmNoOiVkXG4iLAo+ICsJCQkgdmlkLT5odG90YWwgLSB2aWQtPmhzeW5jX2VuZCk7Cj4g
KwlzdHIgKz0gc2NucHJpbnRmKHN0ciwgZW5kIC0gc3RyLCAiVlRvdGFsOiVkXG4iLCB2aWQtPnZ0
b3RhbCk7Cj4gKwlzdHIgKz0gc2NucHJpbnRmKHN0ciwgZW5kIC0gc3RyLCAiVkFjdGl2ZTolZFxu
IiwgdmlkLT52ZGlzcGxheSk7Cj4gKwlzdHIgKz0gc2NucHJpbnRmKHN0ciwgZW5kIC0gc3RyLCAi
VkZyb250UG9yY2g6JWRcbiIsCj4gKwkJCSB2aWQtPnZzeW5jX3N0YXJ0IC0gdmlkLT52ZGlzcGxh
eSk7Cj4gKwlzdHIgKz0gc2NucHJpbnRmKHN0ciwgZW5kIC0gc3RyLCAiVlN5bmNXaWR0aDolZFxu
IiwKPiArCQkJIHZpZC0+dnN5bmNfZW5kIC0gdmlkLT52c3luY19zdGFydCk7Cj4gKwlzdHIgKz0g
c2NucHJpbnRmKHN0ciwgZW5kIC0gc3RyLCAiVkJhY2tQb3JjaDolZFxuIiwKPiArCQkJIHZpZC0+
dnRvdGFsIC0gdmlkLT52c3luY19lbmQpOwo+ICsKPiArCXJldHVybiBzdHIgLSBidWY7Cj4gK30K
PiArCj4gK3N0YXRpYyBzc2l6ZV90IGZvcmNlX3B3cm9ub2ZmX3N0b3JlKHN0cnVjdCBkZXZpY2Ug
KmRldiwKPiArCQkJCSAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKPiArCQkJCSAg
ICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBjb3VudCkKPiArewo+ICsJc3RydWN0IGl0NjUwNSAq
aXQ2NTA1ID0gZGV2X2dldF9kcnZkYXRhKGRldik7Cj4gKwlpbnQgcHdyOwo+ICsKPiArCWlmIChr
c3RydG9pbnQoYnVmLCAxMCwgJnB3cikgPCAwKQo+ICsJCXJldHVybiAtRUlOVkFMOwo+ICsKPiAr
CWlmIChwd3IpCj4gKwkJaXQ2NTA1X3Bvd2Vyb24oaXQ2NTA1KTsKPiArCWVsc2UKPiArCQlpdDY1
MDVfcG93ZXJvZmYoaXQ2NTA1KTsKPiArCj4gKwlyZXR1cm4gY291bnQ7Cj4gK30KPiArCj4gK3N0
YXRpYyBzc2l6ZV90IGVuYWJsZV9kcnZfaG9sZF9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKPiAr
CQkJCSAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+ICt7Cj4g
KwlzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiArCj4gKwly
ZXR1cm4gc2NucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiJWRcbiIsIGl0NjUwNS0+ZW5hYmxlX2Ry
dl9ob2xkKTsKPiArfQo+ICsKPiArc3RhdGljIHNzaXplX3QgZW5hYmxlX2Rydl9ob2xkX3N0b3Jl
KHN0cnVjdCBkZXZpY2UgKmRldiwKPiArCQkJCSAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUg
KmF0dHIsCj4gKwkJCQkgICAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGNvdW50KQo+ICt7Cj4g
KwlzdHJ1Y3QgaXQ2NTA1ICppdDY1MDUgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiArCXVuc2ln
bmVkIGludCBkcnZfaG9sZDsKPiArCj4gKwlpZiAoa3N0cnRvaW50KGJ1ZiwgMTAsICZkcnZfaG9s
ZCkgPCAwKQo+ICsJCXJldHVybiAtRUlOVkFMOwo+ICsKPiArCWl0NjUwNS0+ZW5hYmxlX2Rydl9o
b2xkID0gISFkcnZfaG9sZDsKPiArCj4gKwlpZiAoaXQ2NTA1LT5lbmFibGVfZHJ2X2hvbGQpIHsK
PiArCQlpdDY1MDVfaW50X21hc2tfZGlzYWJsZShpdDY1MDUpOwo+ICsJfSBlbHNlIHsKPiArCQlp
dDY1MDVfY2xlYXJfaW50KGl0NjUwNSk7Cj4gKwkJaXQ2NTA1X2ludF9tYXNrX2VuYWJsZShpdDY1
MDUpOwo+ICsKPiArCQlpZiAoaXQ2NTA1LT5wb3dlcmVkKSB7Cj4gKwkJCWl0NjUwNS0+Y29ubmVj
dG9yX3N0YXR1cyA9Cj4gKwkJCQkJaXQ2NTA1X2dldF9zaW5rX2hwZF9zdGF0dXMoaXQ2NTA1KSA/
Cj4gKwkJCQkJY29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQgOgo+ICsJCQkJCWNvbm5lY3Rvcl9z
dGF0dXNfZGlzY29ubmVjdGVkOwo+ICsJCX0gZWxzZSB7Cj4gKwkJCWl0NjUwNS0+Y29ubmVjdG9y
X3N0YXR1cyA9Cj4gKwkJCQkJY29ubmVjdG9yX3N0YXR1c19kaXNjb25uZWN0ZWQ7Cj4gKwkJfQo+
ICsJfQo+ICsJcmV0dXJuIGNvdW50Owo+ICt9Cj4gKwo+ICtzdGF0aWMgREVWSUNFX0FUVFJfUk8o
cHJpbnRfdGltaW5nKTsKPiArc3RhdGljIERFVklDRV9BVFRSX1dPKGZvcmNlX3B3cm9ub2ZmKTsK
PiArc3RhdGljIERFVklDRV9BVFRSX1JXKGVuYWJsZV9kcnZfaG9sZCk7Cj4gKwo+ICtzdGF0aWMg
Y29uc3Qgc3RydWN0IGF0dHJpYnV0ZSAqaXQ2NTA1X2F0dHJzW10gPSB7Cj4gKwkmZGV2X2F0dHJf
cHJpbnRfdGltaW5nLmF0dHIsCj4gKwkmZGV2X2F0dHJfZm9yY2VfcHdyb25vZmYuYXR0ciwKPiAr
CSZkZXZfYXR0cl9lbmFibGVfZHJ2X2hvbGQuYXR0ciwKPiArCU5VTEwsCj4gK307Cj4gKwo+ICtz
dGF0aWMgaW50IGl0NjUwNV9pMmNfcHJvYmUoc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCwKPiAr
CQkJICAgIGNvbnN0IHN0cnVjdCBpMmNfZGV2aWNlX2lkICppZCkKPiArewo+ICsJc3RydWN0IGl0
NjUwNSAqaXQ2NTA1Owo+ICsJc3RydWN0IGl0NjUwNV9wbGF0Zm9ybV9kYXRhICpwZGF0YTsKPiAr
CXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjbGllbnQtPmRldjsKPiArCXN0cnVjdCBleHRjb25fZGV2
ICpleHRjb247Cj4gKwlpbnQgZXJyLCBpbnRwX2lycTsKPiArCj4gKwlpdDY1MDUgPSBkZXZtX2t6
YWxsb2MoJmNsaWVudC0+ZGV2LCBzaXplb2YoKml0NjUwNSksIEdGUF9LRVJORUwpOwo+ICsJaWYg
KCFpdDY1MDUpCj4gKwkJcmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsJbXV0ZXhfaW5pdCgmaXQ2NTA1
LT5leHRjb25fbG9jayk7Cj4gKwltdXRleF9pbml0KCZpdDY1MDUtPm1vZGVfbG9jayk7Cj4gKwlt
dXRleF9pbml0KCZpdDY1MDUtPmF1eF9sb2NrKTsKPiArCj4gKwlwZGF0YSA9ICZpdDY1MDUtPnBk
YXRhOwo+ICsKPiArCWl0NjUwNS0+YnJpZGdlLm9mX25vZGUgPSBjbGllbnQtPmRldi5vZl9ub2Rl
Owo+ICsJaXQ2NTA1LT5jb25uZWN0b3Jfc3RhdHVzID0gY29ubmVjdG9yX3N0YXR1c19kaXNjb25u
ZWN0ZWQ7Cj4gKwlpdDY1MDUtPmNsaWVudCA9IGNsaWVudDsKPiArCWkyY19zZXRfY2xpZW50ZGF0
YShjbGllbnQsIGl0NjUwNSk7Cj4gKwo+ICsJLyogZ2V0IGV4dGNvbiBkZXZpY2UgZnJvbSBEVFMg
Ki8KPiArCWV4dGNvbiA9IGV4dGNvbl9nZXRfZWRldl9ieV9waGFuZGxlKGRldiwgMCk7Cj4gKwlp
ZiAoUFRSX0VSUihleHRjb24pID09IC1FUFJPQkVfREVGRVIpCj4gKwkJcmV0dXJuIC1FUFJPQkVf
REVGRVI7Cj4gKwlpZiAoSVNfRVJSKGV4dGNvbikpIHsKPiArCQlEUk1fREVWX0VSUk9SKGRldiwg
ImNhbiBub3QgZ2V0IGV4dGNvbiBkZXZpY2UhIik7Cj4gKwkJcmV0dXJuIC1FSU5WQUw7Cj4gKwl9
Cj4gKwo+ICsJaXQ2NTA1LT5leHRjb24gPSBleHRjb247Cj4gKwo+ICsJaXQ2NTA1LT5yZWdtYXAg
PSBkZXZtX3JlZ21hcF9pbml0X2kyYyhjbGllbnQsICZpdDY1MDVfcmVnbWFwX2NvbmZpZyk7Cj4g
KwlpZiAoSVNfRVJSKGl0NjUwNS0+cmVnbWFwKSkgewo+ICsJCURSTV9ERVZfRVJST1IoZGV2LCAi
cmVnbWFwIGkyYyBpbml0IGZhaWxlZCIpOwo+ICsJCWVyciA9IFBUUl9FUlIoaXQ2NTA1LT5yZWdt
YXApOwo+ICsJCXJldHVybiBlcnI7Cj4gKwl9Cj4gKwo+ICsJZXJyID0gaXQ2NTA1X2luaXRfcGRh
dGEoaXQ2NTA1KTsKPiArCWlmIChlcnIpIHsKPiArCQlEUk1fREVWX0VSUk9SKGRldiwgIkZhaWxl
ZCB0byBpbml0aWFsaXplIHBkYXRhOiAlZCIsIGVycik7Cj4gKwkJcmV0dXJuIGVycjsKPiArCX0K
PiArCj4gKwlpdDY1MDVfcGFyc2VfZHQoaXQ2NTA1KTsKPiArCj4gKwlpbnRwX2lycSA9IGNsaWVu
dC0+aXJxOwo+ICsKPiArCWlmICghaW50cF9pcnEpIHsKPiArCQlEUk1fREVWX0VSUk9SKGRldiwg
IkZhaWxlZCB0byBnZXQgSU5UUCBJUlEiKTsKPiArCQllcnIgPSAtRU5PREVWOwo+ICsJCXJldHVy
biBlcnI7Cj4gKwl9Cj4gKwo+ICsJZXJyID0gZGV2bV9yZXF1ZXN0X3RocmVhZGVkX2lycSgmY2xp
ZW50LT5kZXYsIGludHBfaXJxLCBOVUxMLAo+ICsJCQkJCWl0NjUwNV9pbnRfdGhyZWFkZWRfaGFu
ZGxlciwKPiArCQkJCQlJUlFGX1RSSUdHRVJfTE9XIHwgSVJRRl9PTkVTSE9ULAo+ICsJCQkJCSJp
dDY1MDUtaW50cCIsIGl0NjUwNSk7Cj4gKwlpZiAoZXJyKSB7Cj4gKwkJRFJNX0RFVl9FUlJPUihk
ZXYsICJGYWlsZWQgdG8gcmVxdWVzdCBJTlRQIHRocmVhZGVkIElSUTogJWQiLAo+ICsJCQkgICAg
ICBlcnIpOwo+ICsJCXJldHVybiBlcnI7Cj4gKwl9Cj4gKwo+ICsJLyogUmVnaXN0ZXIgYXV4IGNo
YW5uZWwgKi8KPiArCWl0NjUwNS0+YXV4Lm5hbWUgPSAiRFAtQVVYIjsKPiArCWl0NjUwNS0+YXV4
LmRldiA9IGRldjsKPiArCWl0NjUwNS0+YXV4LnRyYW5zZmVyID0gaXQ2NTA1X2F1eF90cmFuc2Zl
cjsKPiArCj4gKwllcnIgPSBkcm1fZHBfYXV4X3JlZ2lzdGVyKCZpdDY1MDUtPmF1eCk7Cj4gKwlp
ZiAoZXJyIDwgMCkgewo+ICsJCURSTV9ERVZfRVJST1IoZGV2LCAiRmFpbGVkIHRvIHJlZ2lzdGVy
IGF1eDogJWQiLCBlcnIpOwo+ICsJCXJldHVybiBlcnI7Cj4gKwl9Cj4gKwo+ICsJSU5JVF9XT1JL
KCZpdDY1MDUtPmxpbmtfd29ya3MsIGl0NjUwNV9saW5rX3RyYWluaW5nX3dvcmspOwo+ICsJaW5p
dF9jb21wbGV0aW9uKCZpdDY1MDUtPndhaXRfZWRpZF9jb21wbGV0ZSk7Cj4gKwlpdDY1MDUtPnBv
d2VyZWQgPSBmYWxzZTsKPiArCWl0NjUwNS0+ZW5hYmxlX2Rydl9ob2xkID0gREVGQVVMVF9EUlZf
SE9MRDsKPiArCj4gKwlpZiAoREVGQVVMVF9QV1JfT04pCj4gKwkJaXQ2NTA1X3Bvd2Vyb24oaXQ2
NTA1KTsKPiArCj4gKwllcnIgPSBzeXNmc19jcmVhdGVfZmlsZXMoJmNsaWVudC0+ZGV2LmtvYmos
IGl0NjUwNV9hdHRycyk7Cj4gKwlpZiAoZXJyKSB7Cj4gKwkJZHJtX2RwX2F1eF91bnJlZ2lzdGVy
KCZpdDY1MDUtPmF1eCk7Cj4gKwkJcmV0dXJuIGVycjsKPiArCX0KPiArCj4gKwlpdDY1MDUtPmJy
aWRnZS5mdW5jcyA9ICZpdDY1MDVfYnJpZGdlX2Z1bmNzOwo+ICsJZHJtX2JyaWRnZV9hZGQoJml0
NjUwNS0+YnJpZGdlKTsKPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIGludCBp
dDY1MDVfaTJjX3JlbW92ZShzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50KQo+ICt7Cj4gKwlzdHJ1
Y3QgaXQ2NTA1ICppdDY1MDUgPSBpMmNfZ2V0X2NsaWVudGRhdGEoY2xpZW50KTsKPiArCj4gKwlk
cm1fY29ubmVjdG9yX3VucmVnaXN0ZXIoJml0NjUwNS0+Y29ubmVjdG9yKTsKPiArCWRybV9jb25u
ZWN0b3JfY2xlYW51cCgmaXQ2NTA1LT5jb25uZWN0b3IpOwo+ICsJZHJtX2JyaWRnZV9yZW1vdmUo
Jml0NjUwNS0+YnJpZGdlKTsKPiArCWRybV9kcF9hdXhfdW5yZWdpc3RlcigmaXQ2NTA1LT5hdXgp
Owo+ICsJc3lzZnNfcmVtb3ZlX2ZpbGVzKCZjbGllbnQtPmRldi5rb2JqLCBpdDY1MDVfYXR0cnMp
Owo+ICsJaXQ2NTA1X3Bvd2Vyb2ZmKGl0NjUwNSk7Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gK30KPiAr
Cj4gK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaTJjX2RldmljZV9pZCBpdDY1MDVfaWRbXSA9IHsKPiAr
CXsgIml0NjUwNSIsIDAgfSwKPiArCXsgfQo+ICt9Owo+ICsKPiArTU9EVUxFX0RFVklDRV9UQUJM
RShpMmMsIGl0NjUwNV9pZCk7Cj4gKwo+ICtzdGF0aWMgY29uc3Qgc3RydWN0IG9mX2RldmljZV9p
ZCBpdDY1MDVfb2ZfbWF0Y2hbXSA9IHsKPiArCXsgLmNvbXBhdGlibGUgPSAiaXRlLGl0NjUwNSIg
fSwKPiArCXsgfQo+ICt9Owo+ICsKPiArc3RhdGljIHN0cnVjdCBpMmNfZHJpdmVyIGl0NjUwNV9p
MmNfZHJpdmVyID0gewo+ICsJLmRyaXZlciA9IHsKPiArCQkubmFtZSA9ICJpdDY1MDUiLAo+ICsJ
CS5vZl9tYXRjaF90YWJsZSA9IGl0NjUwNV9vZl9tYXRjaCwKPiArCQkucG0gPSAmaXQ2NTA1X2Jy
aWRnZV9wbV9vcHMsCj4gKwl9LAo+ICsJLnByb2JlID0gaXQ2NTA1X2kyY19wcm9iZSwKPiArCS5y
ZW1vdmUgPSBpdDY1MDVfaTJjX3JlbW92ZSwKPiArCS5pZF90YWJsZSA9IGl0NjUwNV9pZCwKPiAr
fTsKPiArCj4gK21vZHVsZV9pMmNfZHJpdmVyKGl0NjUwNV9pMmNfZHJpdmVyKTsKPiArCj4gK01P
RFVMRV9BVVRIT1IoIkhlcm1lcyBXdSA8aGVybWVzLnd1QGl0ZS5jb20udHc+Iik7Cj4gK01PRFVM
RV9ERVNDUklQVElPTigiSVQ2NTA1IERpc3BsYXlQb3J0IFRyYW5zbWl0dGVyIGRyaXZlciIpOwo+
ICtNT0RVTEVfTElDRU5TRSgiR1BMIHYyIik7Cj4gLS0gCj4gMS45LjEKPiAKPiBfX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwo+IGRyaS1kZXZlbCBtYWlsaW5n
IGxpc3QKPiBkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCj4gaHR0cHM6Ly9saXN0cy5m
cmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWwKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApk
cmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Au
b3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVsCg==
