Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 405D4D3E25
	for <lists+dri-devel@lfdr.de>; Fri, 11 Oct 2019 13:18:42 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1C4556EC17;
	Fri, 11 Oct 2019 11:18:39 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from bhuna.collabora.co.uk (bhuna.collabora.co.uk [46.235.227.227])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1894F6EC18
 for <dri-devel@lists.freedesktop.org>; Fri, 11 Oct 2019 11:18:38 +0000 (UTC)
Received: from [127.0.0.1] (localhost [127.0.0.1])
 (Authenticated sender: andrzej.p) with ESMTPSA id 5611128D251
From: Andrzej Pietrasiewicz <andrzej.p@collabora.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 1/2] drm/arm: Factor out generic afbc helpers
Date: Fri, 11 Oct 2019 13:18:10 +0200
Message-Id: <20191011111813.20851-2-andrzej.p@collabora.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20191011111813.20851-1-andrzej.p@collabora.com>
References: <20191011111813.20851-1-andrzej.p@collabora.com>
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: David Airlie <airlied@linux.ie>, Liviu Dudau <liviu.dudau@arm.com>,
 Andrzej Pietrasiewicz <andrzej.p@collabora.com>,
 linux-rockchip@lists.infradead.org, linux-arm-kernel@lists.infradead.org,
 kernel@collabora.com, Sean Paul <sean@poorly.run>,
 linux-kernel@vger.kernel.org
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlc2UgYXJlIHVzZWZ1bCBmb3Igb3RoZXIgdXNlcnMgb2YgYWZiYywgZS5nLiByb2NrY2hpcC4K
ClNpZ25lZC1vZmYtYnk6IEFuZHJ6ZWogUGlldHJhc2lld2ljeiA8YW5kcnplai5wQGNvbGxhYm9y
YS5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL0tjb25maWcgICAgICAgICAgfCAgIDQgKysKIGRy
aXZlcnMvZ3B1L2RybS9NYWtlZmlsZSAgICAgICAgIHwgICAxICsKIGRyaXZlcnMvZ3B1L2RybS9h
cm0vS2NvbmZpZyAgICAgIHwgICAxICsKIGRyaXZlcnMvZ3B1L2RybS9hcm0vbWFsaWRwX2Rydi5j
IHwgIDU4ICsrLS0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9kcm1fYWZiYy5jICAgICAg
IHwgMTE0ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIGluY2x1ZGUvZHJtL2RybV9h
ZmJjLmggICAgICAgICAgIHwgIDI1ICsrKysrKysKIDYgZmlsZXMgY2hhbmdlZCwgMTQ5IGluc2Vy
dGlvbnMoKyksIDU0IGRlbGV0aW9ucygtKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1
L2RybS9kcm1fYWZiYy5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgaW5jbHVkZS9kcm0vZHJtX2FmYmMu
aAoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9LY29uZmlnIGIvZHJpdmVycy9ncHUvZHJt
L0tjb25maWcKaW5kZXggM2M4ODQyMGUzNDk3Li4wMGUzZjkwNTU3ZjQgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9LY29uZmlnCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9LY29uZmlnCkBAIC0x
OTUsNiArMTk1LDEwIEBAIGNvbmZpZyBEUk1fU0NIRUQKIAl0cmlzdGF0ZQogCWRlcGVuZHMgb24g
RFJNCiAKK2NvbmZpZyBEUk1fQUZCQworCXRyaXN0YXRlCisJZGVwZW5kcyBvbiBEUk0KKwogc291
cmNlICJkcml2ZXJzL2dwdS9kcm0vaTJjL0tjb25maWciCiAKIHNvdXJjZSAiZHJpdmVycy9ncHUv
ZHJtL2FybS9LY29uZmlnIgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL01ha2VmaWxlIGIv
ZHJpdmVycy9ncHUvZHJtL01ha2VmaWxlCmluZGV4IDlmMGQyZWUzNTc5NC4uNTUzNjhiNjY4MzU1
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL01ha2VmaWxlCkBAIC0zMSw2ICszMSw3IEBAIGRybS0kKENPTkZJR19PRikgKz0gZHJtX29m
Lm8KIGRybS0kKENPTkZJR19BR1ApICs9IGRybV9hZ3BzdXBwb3J0Lm8KIGRybS0kKENPTkZJR19E
RUJVR19GUykgKz0gZHJtX2RlYnVnZnMubyBkcm1fZGVidWdmc19jcmMubwogZHJtLSQoQ09ORklH
X0RSTV9MT0FEX0VESURfRklSTVdBUkUpICs9IGRybV9lZGlkX2xvYWQubworZHJtLSQoQ09ORklH
X0RSTV9BRkJDKSArPSBkcm1fYWZiYy5vCiAKIGRybV92cmFtX2hlbHBlci15IDo9IGRybV9nZW1f
dnJhbV9oZWxwZXIubyBcCiAJCSAgICAgZHJtX3ZyYW1faGVscGVyX2NvbW1vbi5vIFwKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hcm0vS2NvbmZpZyBiL2RyaXZlcnMvZ3B1L2RybS9hcm0v
S2NvbmZpZwppbmRleCBhMjA0MTAzYjNlZmIuLjI1YzNkYzQwOGNkYSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2FybS9LY29uZmlnCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hcm0vS2NvbmZp
ZwpAQCAtMjksNiArMjksNyBAQCBjb25maWcgRFJNX01BTElfRElTUExBWQogCXNlbGVjdCBEUk1f
S01TX0hFTFBFUgogCXNlbGVjdCBEUk1fS01TX0NNQV9IRUxQRVIKIAlzZWxlY3QgRFJNX0dFTV9D
TUFfSEVMUEVSCisJc2VsZWN0IERSTV9BRkJDCiAJc2VsZWN0IFZJREVPTU9ERV9IRUxQRVJTCiAJ
aGVscAogCSAgQ2hvb3NlIHRoaXMgb3B0aW9uIGlmIHlvdSB3YW50IHRvIGNvbXBpbGUgdGhlIEFS
TSBNYWxpIERpc3BsYXkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hcm0vbWFsaWRwX2Ry
di5jIGIvZHJpdmVycy9ncHUvZHJtL2FybS9tYWxpZHBfZHJ2LmMKaW5kZXggZjI1ZWM0MzgyMjc3
Li5hNjdiNjllMDhmNjMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hcm0vbWFsaWRwX2Ry
di5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hcm0vbWFsaWRwX2Rydi5jCkBAIC0xNiw2ICsxNiw3
IEBACiAjaW5jbHVkZSA8bGludXgvZGVidWdmcy5oPgogCiAjaW5jbHVkZSA8ZHJtL2RybVAuaD4K
KyNpbmNsdWRlIDxkcm0vZHJtX2FmYmMuaD4KICNpbmNsdWRlIDxkcm0vZHJtX2F0b21pYy5oPgog
I2luY2x1ZGUgPGRybS9kcm1fYXRvbWljX2hlbHBlci5oPgogI2luY2x1ZGUgPGRybS9kcm1fY3J0
Yy5oPgpAQCAtMzMsOCArMzQsNiBAQAogI2luY2x1ZGUgIm1hbGlkcF9ody5oIgogCiAjZGVmaW5l
IE1BTElEUF9DT05GX1ZBTElEX1RJTUVPVVQJMjUwCi0jZGVmaW5lIEFGQkNfSEVBREVSX1NJWkUJ
CTE2Ci0jZGVmaW5lIEFGQkNfU1VQRVJCTEtfQUxJR05NRU5UCQkxMjgKIAogc3RhdGljIHZvaWQg
bWFsaWRwX3dyaXRlX2dhbW1hX3RhYmxlKHN0cnVjdCBtYWxpZHBfaHdfZGV2aWNlICpod2RldiwK
IAkJCQkgICAgIHUzMiBkYXRhW01BTElEUF9DT0VGRlRBQl9OVU1fQ09FRkZTXSkKQEAgLTI3NSwy
NCArMjc0LDggQEAgbWFsaWRwX3ZlcmlmeV9hZmJjX2ZyYW1lYnVmZmVyX2NhcHMoc3RydWN0IGRy
bV9kZXZpY2UgKmRldiwKIAkJCQkJbW9kZV9jbWQtPm1vZGlmaWVyWzBdKSA9PSBmYWxzZSkKIAkJ
cmV0dXJuIGZhbHNlOwogCi0JaWYgKG1vZGVfY21kLT5vZmZzZXRzWzBdICE9IDApIHsKLQkJRFJN
X0RFQlVHX0tNUygiQUZCQyBidWZmZXJzJyBwbGFuZSBvZmZzZXQgc2hvdWxkIGJlIDBcbiIpOwot
CQlyZXR1cm4gZmFsc2U7Ci0JfQotCi0Jc3dpdGNoIChtb2RlX2NtZC0+bW9kaWZpZXJbMF0gJiBB
RkJDX1NJWkVfTUFTSykgewotCWNhc2UgQUZCQ19TSVpFXzE2WDE2OgotCQlpZiAoKG1vZGVfY21k
LT53aWR0aCAlIDE2KSB8fCAobW9kZV9jbWQtPmhlaWdodCAlIDE2KSkgewotCQkJRFJNX0RFQlVH
X0tNUygiQUZCQyBidWZmZXJzIG11c3QgYmUgYWxpZ25lZCB0byAxNiBwaXhlbHNcbiIpOwotCQkJ
cmV0dXJuIGZhbHNlOwotCQl9Ci0JCWJyZWFrOwotCWRlZmF1bHQ6Ci0JCURSTV9ERUJVR19LTVMo
IlVuc3VwcG9ydGVkIEFGQkMgYmxvY2sgc2l6ZVxuIik7Ci0JCXJldHVybiBmYWxzZTsKLQl9Ci0K
LQlyZXR1cm4gdHJ1ZTsKKwlyZXR1cm4gZHJtX2FmYmNfY2hlY2tfb2Zmc2V0KGRldiwgbW9kZV9j
bWQpICYmCisJICAgICAgIGRybV9hZmJjX2NoZWNrX3NpemVfYWxpZ24oZGV2LCBtb2RlX2NtZCk7
CiB9CiAKIHN0YXRpYyBib29sCkBAIC0zMDAsNTMgKzI4MywyMCBAQCBtYWxpZHBfdmVyaWZ5X2Fm
YmNfZnJhbWVidWZmZXJfc2l6ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogCQkJCSAgICBzdHJ1
Y3QgZHJtX2ZpbGUgKmZpbGUsCiAJCQkJICAgIGNvbnN0IHN0cnVjdCBkcm1fbW9kZV9mYl9jbWQy
ICptb2RlX2NtZCkKIHsKLQlpbnQgbl9zdXBlcmJsb2NrcyA9IDA7CiAJY29uc3Qgc3RydWN0IGRy
bV9mb3JtYXRfaW5mbyAqaW5mbzsKIAlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9ianMgPSBOVUxM
OwotCXUzMiBhZmJjX3N1cGVyYmxvY2tfc2l6ZSA9IDAsIGFmYmNfc3VwZXJibG9ja19oZWlnaHQg
PSAwOwotCXUzMiBhZmJjX3N1cGVyYmxvY2tfd2lkdGggPSAwLCBhZmJjX3NpemUgPSAwOwogCWlu
dCBicHAgPSAwOwogCi0Jc3dpdGNoIChtb2RlX2NtZC0+bW9kaWZpZXJbMF0gJiBBRkJDX1NJWkVf
TUFTSykgewotCWNhc2UgQUZCQ19TSVpFXzE2WDE2OgotCQlhZmJjX3N1cGVyYmxvY2tfaGVpZ2h0
ID0gMTY7Ci0JCWFmYmNfc3VwZXJibG9ja193aWR0aCA9IDE2OwotCQlicmVhazsKLQlkZWZhdWx0
OgotCQlEUk1fREVCVUdfS01TKCJBRkJDIHN1cGVyYmxvY2sgc2l6ZSBpcyBub3Qgc3VwcG9ydGVk
XG4iKTsKLQkJcmV0dXJuIGZhbHNlOwotCX0KLQogCWluZm8gPSBkcm1fZ2V0X2Zvcm1hdF9pbmZv
KGRldiwgbW9kZV9jbWQpOwotCi0Jbl9zdXBlcmJsb2NrcyA9IChtb2RlX2NtZC0+d2lkdGggLyBh
ZmJjX3N1cGVyYmxvY2tfd2lkdGgpICoKLQkJKG1vZGVfY21kLT5oZWlnaHQgLyBhZmJjX3N1cGVy
YmxvY2tfaGVpZ2h0KTsKLQogCWJwcCA9IG1hbGlkcF9mb3JtYXRfZ2V0X2JwcChpbmZvLT5mb3Jt
YXQpOwogCi0JYWZiY19zdXBlcmJsb2NrX3NpemUgPSAoYnBwICogYWZiY19zdXBlcmJsb2NrX3dp
ZHRoICogYWZiY19zdXBlcmJsb2NrX2hlaWdodCkKLQkJCQkvIEJJVFNfUEVSX0JZVEU7Ci0KLQlh
ZmJjX3NpemUgPSBBTElHTihuX3N1cGVyYmxvY2tzICogQUZCQ19IRUFERVJfU0laRSwgQUZCQ19T
VVBFUkJMS19BTElHTk1FTlQpOwotCWFmYmNfc2l6ZSArPSBuX3N1cGVyYmxvY2tzICogQUxJR04o
YWZiY19zdXBlcmJsb2NrX3NpemUsIEFGQkNfU1VQRVJCTEtfQUxJR05NRU5UKTsKLQotCWlmICgo
bW9kZV9jbWQtPndpZHRoICogYnBwKSAhPSAobW9kZV9jbWQtPnBpdGNoZXNbMF0gKiBCSVRTX1BF
Ul9CWVRFKSkgewotCQlEUk1fREVCVUdfS01TKCJJbnZhbGlkIHZhbHVlIG9mIChwaXRjaCAqIEJJ
VFNfUEVSX0JZVEUpICg9JXUpICIKLQkJCSAgICAgICJzaG91bGQgYmUgc2FtZSBhcyB3aWR0aCAo
PSV1KSAqIGJwcCAoPSV1KVxuIiwKLQkJCSAgICAgIChtb2RlX2NtZC0+cGl0Y2hlc1swXSAqIEJJ
VFNfUEVSX0JZVEUpLAotCQkJICAgICAgbW9kZV9jbWQtPndpZHRoLCBicHApOwotCQlyZXR1cm4g
ZmFsc2U7Ci0JfQotCiAJb2JqcyA9IGRybV9nZW1fb2JqZWN0X2xvb2t1cChmaWxlLCBtb2RlX2Nt
ZC0+aGFuZGxlc1swXSk7CiAJaWYgKCFvYmpzKSB7CiAJCURSTV9ERUJVR19LTVMoIkZhaWxlZCB0
byBsb29rdXAgR0VNIG9iamVjdFxuIik7CiAJCXJldHVybiBmYWxzZTsKIAl9CiAKLQlpZiAob2Jq
cy0+c2l6ZSA8IGFmYmNfc2l6ZSkgewotCQlEUk1fREVCVUdfS01TKCJidWZmZXIgc2l6ZSAoJXp1
KSB0b28gc21hbGwgZm9yIEFGQkMgYnVmZmVyIHNpemUgPSAldVxuIiwKLQkJCSAgICAgIG9ianMt
PnNpemUsIGFmYmNfc2l6ZSk7CisJaWYgKCFkcm1fYWZiY19jaGVja19mYl9zaXplKGRldiwgbW9k
ZV9jbWQsIG9ianMsIGJwcCkpIHsKIAkJZHJtX2dlbV9vYmplY3RfcHV0X3VubG9ja2VkKG9ianMp
OwogCQlyZXR1cm4gZmFsc2U7CiAJfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2RybV9h
ZmJjLmMgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX2FmYmMuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NApp
bmRleCAwMDAwMDAwMDAwMDAuLjNlOGE5MjI1ZmQyZQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9kcm1fYWZiYy5jCkBAIC0wLDAgKzEsMTE0IEBACisvLyBTUERYLUxpY2Vuc2Ut
SWRlbnRpZmllcjogR1BMLTIuMCsKKy8qCisgKiAoQykgMjAxOSBDb2xsYWJvcmEgTHRkLgorICoK
KyAqIGF1dGhvcjogQW5kcnplaiBQaWV0cmFzaWV3aWN6IDxhbmRyemVqLnBAY29sbGFib3JhLmNv
bT4KKyAqCisgKi8KKyNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KKworI2luY2x1ZGUgPGRybS9k
cm1fYWZiYy5oPgorI2luY2x1ZGUgPGRybS9kcm1fZGV2aWNlLmg+CisjaW5jbHVkZSA8ZHJtL2Ry
bV9mb3VyY2MuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2dlbS5oPgorI2luY2x1ZGUgPGRybS9kcm1f
bW9kZS5oPgorI2luY2x1ZGUgPGRybS9kcm1fcHJpbnQuaD4KKworI2RlZmluZSBBRkJDX0hFQURF
Ul9TSVpFCQkxNgorI2RlZmluZSBBRkJDX1NVUEVSQkxLX0FMSUdOTUVOVAkJMTI4CisKK2Jvb2wg
ZHJtX2FmYmNfY2hlY2tfb2Zmc2V0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCisJCQkgICBjb25z
dCBzdHJ1Y3QgZHJtX21vZGVfZmJfY21kMiAqbW9kZV9jbWQpCit7CisJaWYgKG1vZGVfY21kLT5v
ZmZzZXRzWzBdICE9IDApIHsKKwkJRFJNX0RFQlVHX0tNUygiQUZCQyBidWZmZXJzJyBwbGFuZSBv
ZmZzZXQgc2hvdWxkIGJlIDBcbiIpOworCQlyZXR1cm4gZmFsc2U7CisJfQorCisJcmV0dXJuIHRy
dWU7Cit9CitFWFBPUlRfU1lNQk9MX0dQTChkcm1fYWZiY19jaGVja19vZmZzZXQpOworCitib29s
IGRybV9hZmJjX2NoZWNrX3NpemVfYWxpZ24oc3RydWN0IGRybV9kZXZpY2UgKmRldiwKKwkJCSAg
ICAgICBjb25zdCBzdHJ1Y3QgZHJtX21vZGVfZmJfY21kMiAqbW9kZV9jbWQpCit7CisKKwlzd2l0
Y2ggKG1vZGVfY21kLT5tb2RpZmllclswXSAmIEFGQkNfRk9STUFUX01PRF9CTE9DS19TSVpFX01B
U0spIHsKKwljYXNlIEFGQkNfRk9STUFUX01PRF9CTE9DS19TSVpFXzE2eDE2OgorCQlpZiAoKG1v
ZGVfY21kLT53aWR0aCAlIDE2KSB8fCAobW9kZV9jbWQtPmhlaWdodCAlIDE2KSkgeworCQkJRFJN
X0RFQlVHX0tNUygKKwkJCQkiQUZCQyBidWZmZXIgbXVzdCBiZSBhbGlnbmVkIHRvIDE2IHBpeGVs
c1xuIgorCQkJKTsKKwkJCXJldHVybiBmYWxzZTsKKwkJfQorCQlicmVhazsKKwljYXNlIEFGQkNf
Rk9STUFUX01PRF9CTE9DS19TSVpFXzMyeDg6CisJCS8qIGZhbGwgdGhyb3VnaCAqLworCWNhc2Ug
QUZCQ19GT1JNQVRfTU9EX0JMT0NLX1NJWkVfNjR4NDoKKwkJLyogZmFsbCB0aHJvdWdoICovCisJ
Y2FzZSBBRkJDX0ZPUk1BVF9NT0RfQkxPQ0tfU0laRV8zMng4XzY0eDQ6CisJCS8qIGZhbGwgdGhy
b3VnaCAqLworCWRlZmF1bHQ6CisJCURSTV9ERUJVR19LTVMoIlVuc3VwcG9ydGVkIEFGQkMgYmxv
Y2sgc2l6ZVxuIik7CisJCXJldHVybiBmYWxzZTsKKwl9CisKKwlyZXR1cm4gdHJ1ZTsKK30KK0VY
UE9SVF9TWU1CT0xfR1BMKGRybV9hZmJjX2NoZWNrX3NpemVfYWxpZ24pOworCitib29sIGRybV9h
ZmJjX2NoZWNrX2ZiX3NpemUoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKKwkJCSAgICBjb25zdCBz
dHJ1Y3QgZHJtX21vZGVfZmJfY21kMiAqbW9kZV9jbWQsCisJCQkgICAgc3RydWN0IGRybV9nZW1f
b2JqZWN0ICpvYmpzLCBpbnQgYnBwKQoreworCWludCBuX3N1cGVyYmxvY2tzID0gMDsKKwl1MzIg
YWZiY19zdXBlcmJsb2NrX3NpemUgPSAwLCBhZmJjX3N1cGVyYmxvY2tfaGVpZ2h0ID0gMDsKKwl1
MzIgYWZiY19zdXBlcmJsb2NrX3dpZHRoID0gMCwgYWZiY19zaXplID0gMDsKKworCXN3aXRjaCAo
bW9kZV9jbWQtPm1vZGlmaWVyWzBdICYgQUZCQ19GT1JNQVRfTU9EX0JMT0NLX1NJWkVfTUFTSykg
eworCWNhc2UgQUZCQ19GT1JNQVRfTU9EX0JMT0NLX1NJWkVfMTZ4MTY6CisJCWFmYmNfc3VwZXJi
bG9ja19oZWlnaHQgPSAxNjsKKwkJYWZiY19zdXBlcmJsb2NrX3dpZHRoID0gMTY7CisJCWJyZWFr
OworCWNhc2UgQUZCQ19GT1JNQVRfTU9EX0JMT0NLX1NJWkVfMzJ4ODoKKwkJLyogZmFsbCB0aHJv
dWdoICovCisJY2FzZSBBRkJDX0ZPUk1BVF9NT0RfQkxPQ0tfU0laRV82NHg0OgorCQkvKiBmYWxs
IHRocm91Z2ggKi8KKwljYXNlIEFGQkNfRk9STUFUX01PRF9CTE9DS19TSVpFXzMyeDhfNjR4NDoK
KwkJLyogZmFsbCB0aHJvdWdoICovCisJZGVmYXVsdDoKKwkJRFJNX0RFQlVHX0tNUygiQUZCQyBz
dXBlcmJsb2NrIHNpemUgaXMgbm90IHN1cHBvcnRlZFxuIik7CisJCXJldHVybiBmYWxzZTsKKwl9
CisKKwluX3N1cGVyYmxvY2tzID0gKG1vZGVfY21kLT53aWR0aCAvIGFmYmNfc3VwZXJibG9ja193
aWR0aCkgKgorCQkobW9kZV9jbWQtPmhlaWdodCAvIGFmYmNfc3VwZXJibG9ja19oZWlnaHQpOwor
CisJYWZiY19zdXBlcmJsb2NrX3NpemUgPQorCQkoYnBwICogYWZiY19zdXBlcmJsb2NrX3dpZHRo
ICogYWZiY19zdXBlcmJsb2NrX2hlaWdodCkKKwkJCS8gQklUU19QRVJfQllURTsKKworCWFmYmNf
c2l6ZSA9IEFMSUdOKG5fc3VwZXJibG9ja3MgKiBBRkJDX0hFQURFUl9TSVpFLAorCQkJICBBRkJD
X1NVUEVSQkxLX0FMSUdOTUVOVCk7CisJYWZiY19zaXplICs9IG5fc3VwZXJibG9ja3MgKgorCQlB
TElHTihhZmJjX3N1cGVyYmxvY2tfc2l6ZSwgQUZCQ19TVVBFUkJMS19BTElHTk1FTlQpOworCisJ
aWYgKChtb2RlX2NtZC0+d2lkdGggKiBicHApICE9IChtb2RlX2NtZC0+cGl0Y2hlc1swXSAqIEJJ
VFNfUEVSX0JZVEUpKSB7CisJCURSTV9ERUJVR19LTVMoIkludmFsaWQgdmFsdWUgb2YgKHBpdGNo
ICogQklUU19QRVJfQllURSkgKD0ldSkgc2hvdWxkIGJlIHNhbWUgYXMgd2lkdGggKD0ldSkgKiBi
cHAgKD0ldSlcbiIsCisJCQltb2RlX2NtZC0+cGl0Y2hlc1swXSAqIEJJVFNfUEVSX0JZVEUsCisJ
CQltb2RlX2NtZC0+d2lkdGgsIGJwcAorCQkpOworCQlyZXR1cm4gZmFsc2U7CisJfQorCisJaWYg
KG9ianMtPnNpemUgPCBhZmJjX3NpemUpIHsKKwkJRFJNX0RFQlVHX0tNUygiYnVmZmVyIHNpemUg
KCV6dSkgdG9vIHNtYWxsIGZvciBBRkJDIGJ1ZmZlciBzaXplID0gJXVcbiIsCisJCQlvYmpzLT5z
aXplLCBhZmJjX3NpemUKKwkJKTsKKworCQlyZXR1cm4gZmFsc2U7CisJfQorCisJcmV0dXJuIHRy
dWU7Cit9CitFWFBPUlRfU1lNQk9MKGRybV9hZmJjX2NoZWNrX2ZiX3NpemUpOwpkaWZmIC0tZ2l0
IGEvaW5jbHVkZS9kcm0vZHJtX2FmYmMuaCBiL2luY2x1ZGUvZHJtL2RybV9hZmJjLmgKbmV3IGZp
bGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5jZTM5Yzg1MDIxN2IKLS0tIC9kZXYv
bnVsbAorKysgYi9pbmNsdWRlL2RybS9kcm1fYWZiYy5oCkBAIC0wLDAgKzEsMjUgQEAKKy8qIFNQ
RFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wKyAqLworLyoKKyAqIChDKSAyMDE5IENvbGxh
Ym9yYSBMdGQuCisgKgorICogYXV0aG9yOiBBbmRyemVqIFBpZXRyYXNpZXdpY3ogPGFuZHJ6ZWou
cEBjb2xsYWJvcmEuY29tPgorICoKKyAqLworI2lmbmRlZiBfX0RSTV9BRkJDX0hfXworI2RlZmlu
ZSBfX0RSTV9BRkJDX0hfXworCitzdHJ1Y3QgZHJtX2RldmljZTsKK3N0cnVjdCBkcm1fbW9kZV9m
Yl9jbWQyOworc3RydWN0IGRybV9nZW1fb2JqZWN0OworCitib29sIGRybV9hZmJjX2NoZWNrX29m
ZnNldChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAorCQkJICAgY29uc3Qgc3RydWN0IGRybV9tb2Rl
X2ZiX2NtZDIgKm1vZGVfY21kKTsKKworYm9vbCBkcm1fYWZiY19jaGVja19zaXplX2FsaWduKHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYsCisJCQkgICAgICAgY29uc3Qgc3RydWN0IGRybV9tb2RlX2Zi
X2NtZDIgKm1vZGVfY21kKTsKKworYm9vbCBkcm1fYWZiY19jaGVja19mYl9zaXplKHN0cnVjdCBk
cm1fZGV2aWNlICpkZXYsCisJCQkgICAgY29uc3Qgc3RydWN0IGRybV9tb2RlX2ZiX2NtZDIgKm1v
ZGVfY21kLAorCQkJICAgIHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqcywgaW50IGJwcCk7CisK
KyNlbmRpZiAvKiBfX0RSTV9BRkJDX0hfXyAqLwotLSAKMi4xNy4xCgpfX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRy
aS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5v
cmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
