Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 4E025A501E
	for <lists+dri-devel@lfdr.de>; Mon,  2 Sep 2019 09:44:41 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F14D9890DD;
	Mon,  2 Sep 2019 07:44:37 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-qk1-x742.google.com (mail-qk1-x742.google.com
 [IPv6:2607:f8b0:4864:20::742])
 by gabe.freedesktop.org (Postfix) with ESMTPS id CE532890DD
 for <dri-devel@lists.freedesktop.org>; Mon,  2 Sep 2019 07:44:36 +0000 (UTC)
Received: by mail-qk1-x742.google.com with SMTP id 4so11747258qki.6
 for <dri-devel@lists.freedesktop.org>; Mon, 02 Sep 2019 00:44:36 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=XFXQzU8iZG+JbQ666POQ8fYnLTr/7PFWLlx1qudpCCU=;
 b=V0eYPCpOJb/cOW7Hr7Rf7sPq/zSnVzNsb1yZ3qXLIn34UyIkkE2qHeP57HTSbDayT6
 WZYEm/sUrN51TIytME24/rUQVMRxByArspQWebLJZ4x+ZnPKPQ6NChEK8+DHykN7t5+r
 Hb9lyNJHKNUB1qgtFK3KYSe4EoCw+h8oD1huqqzzxSGjrYU3rx1xSUe27WRCMxDDC2jo
 Xei/QRkmAlR9oNKNtg7Za2Q/ha9e3bGlpds/MX2/zekJAs909adq9DCn69cwhAVZl8dx
 ozZfgjZ2lJPiRKwxjgUTpM9cstqXCLr2CSxcasox/2q/c7dro2+BppsAKnA0y84Ux/rR
 DMvQ==
X-Gm-Message-State: APjAAAXnqSvMbz1i0+Bzhx4Fin1emXR5+dmXWbjyqYbuJM0rVpzQTK/u
 SyGhuFDrwBEN9P1G9y6FjqJXBlqwZ83RSH/1oq2aIw==
X-Google-Smtp-Source: APXvYqznA9u2irl3hYlZAT8bMKuiauumT5Dk2extnFHPlE3Ol53oxcgq11wOQ3eR/1HbfKHz8ryDhMdobqHw7pJfrdk=
X-Received: by 2002:a05:620a:16ca:: with SMTP id
 a10mr10298471qkn.18.1567410275622; 
 Mon, 02 Sep 2019 00:44:35 -0700 (PDT)
MIME-Version: 1.0
References: <20190830074103.16671-1-bibby.hsieh@mediatek.com>
 <20190830074103.16671-2-bibby.hsieh@mediatek.com>
In-Reply-To: <20190830074103.16671-2-bibby.hsieh@mediatek.com>
From: Nicolas Boichat <drinkcat@chromium.org>
Date: Mon, 2 Sep 2019 15:44:24 +0800
Message-ID: <CANMq1KAQgxQ0bDUdBj=sOobh+qiNoyasvJHqNstrhu-j2f20CA@mail.gmail.com>
Subject: Re: [PATCH 1/2] drm/mediatek: Support CMDQ interface in ddp component
To: Bibby Hsieh <bibby.hsieh@mediatek.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=chromium.org; s=google;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=XFXQzU8iZG+JbQ666POQ8fYnLTr/7PFWLlx1qudpCCU=;
 b=Yr3Whvhk5B3v33OT26lkME1JVxjrlHGJSoNYPqfmM09CMt8iii92uhk6SoFQ1iDBJj
 vUolgnBYBTKyxvFZHpkXVDPsjXtFssQjH96zG5NKtl1bvux4MhrGVaR7jU04cfhZIJKV
 vauP+g280g33T1rCMEU1/5FTYhz39YX2msiKY=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Yongqiang Niu <yongqiang.niu@mediatek.com>, David Airlie <airlied@linux.ie>,
 Daniel Vetter <daniel.vetter@ffwll.ch>, lkml <linux-kernel@vger.kernel.org>,
 dri-devel@lists.freedesktop.org, Tomasz Figa <tfiga@chromium.org>,
 Thierry Reding <thierry.reding@gmail.com>,
 "moderated list:ARM/Mediatek SoC support" <linux-mediatek@lists.infradead.org>,
 Matthias Brugger <matthias.bgg@gmail.com>,
 linux-arm Mailing List <linux-arm-kernel@lists.infradead.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gRnJpLCBBdWcgMzAsIDIwMTkgYXQgMzo0MSBQTSBCaWJieSBIc2llaCA8YmliYnkuaHNpZWhA
bWVkaWF0ZWsuY29tPiB3cm90ZToKPgo+IFRoZSBDTURRIChDb21tYW5kIFF1ZXVlKSBpbiBNVDgx
ODMgaXMgdXNlZCB0byBoZWxwCj4gdXBkYXRlIGFsbCByZWxldmFudCBkaXNwbGF5IGNvbnRyb2xs
ZXIgcmVnaXN0ZXJzCj4gd2l0aCBjcml0aWNhbCB0aW1lIGxpbWF0aW9uLgo+IFRoaXMgcGF0Y2gg
YWRkIGNtZHEgaW50ZXJmYWNlIGluIGRkcF9jb21wIGludGVyZmFjZSwKPiBsZXQgYWxsIGRkcF9j
b21wIGludGVyZmFjZSBjYW4gc3VwcG9ydCBjcHUvY21kcSBmdW5jdGlvbgo+IGF0IHRoZSBzYW1l
IHRpbWUuCj4KPiBTaWduZWQtb2ZmLWJ5OiBZVCBTaGVuIDx5dC5zaGVuQG1lZGlhdGVrLmNvbT4K
PiBTaWduZWQtb2ZmLWJ5OiBDSyBIdSA8Y2suaHVAbWVkaWF0ZWsuY29tPgo+IFNpZ25lZC1vZmYt
Ynk6IFBoaWxpcHAgWmFiZWwgPHAuemFiZWxAcGVuZ3V0cm9uaXguZGU+Cj4gU2lnbmVkLW9mZi1i
eTogQmliYnkgSHNpZWggPGJpYmJ5LmhzaWVoQG1lZGlhdGVrLmNvbT4KPiBTaWduZWQtb2ZmLWJ5
OiBZb25ncWlhbmcgTml1IDx5b25ncWlhbmcubml1QG1lZGlhdGVrLmNvbT4KPiAtLS0KPiAgZHJp
dmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kaXNwX2NvbG9yLmMgICB8ICAgNyArLQo+ICBkcml2
ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2Rpc3Bfb3ZsLmMgICAgIHwgIDc4ICsrKysrKystLS0t
LS0tCj4gIGRyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZGlzcF9yZG1hLmMgICAgfCAgNjYg
KysrKysrLS0tLS0tCj4gIGRyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2RkcF9jb21w
LmMgfCAxMTAgKysrKysrKysrKysrKystLS0tLS0KPiAgZHJpdmVycy9ncHUvZHJtL21lZGlhdGVr
L210a19kcm1fZGRwX2NvbXAuaCB8ICA1MyArKysrKystLS0tCj4gIDUgZmlsZXMgY2hhbmdlZCwg
MTg3IGluc2VydGlvbnMoKyksIDEyNyBkZWxldGlvbnMoLSkKPgo+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2Rpc3BfY29sb3IuYyBiL2RyaXZlcnMvZ3B1L2RybS9t
ZWRpYXRlay9tdGtfZGlzcF9jb2xvci5jCj4gaW5kZXggZjMzZDk4YjM1NmQ2Li5jNWQzZTNjZjhh
ZDUgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kaXNwX2NvbG9y
LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2Rpc3BfY29sb3IuYwo+IEBA
IC05LDYgKzksNyBAQAo+ICAjaW5jbHVkZSA8bGludXgvb2ZfZGV2aWNlLmg+Cj4gICNpbmNsdWRl
IDxsaW51eC9vZl9pcnEuaD4KPiAgI2luY2x1ZGUgPGxpbnV4L3BsYXRmb3JtX2RldmljZS5oPgo+
ICsjaW5jbHVkZSA8bGludXgvc29jL21lZGlhdGVrL210ay1jbWRxLmg+Cj4KPiAgI2luY2x1ZGUg
Im10a19kcm1fY3J0Yy5oIgo+ICAjaW5jbHVkZSAibXRrX2RybV9kZHBfY29tcC5oIgo+IEBAIC00
NSwxMiArNDYsMTIgQEAgc3RhdGljIGlubGluZSBzdHJ1Y3QgbXRrX2Rpc3BfY29sb3IgKmNvbXBf
dG9fY29sb3Ioc3RydWN0IG10a19kZHBfY29tcCAqY29tcCkKPgo+ICBzdGF0aWMgdm9pZCBtdGtf
Y29sb3JfY29uZmlnKHN0cnVjdCBtdGtfZGRwX2NvbXAgKmNvbXAsIHVuc2lnbmVkIGludCB3LAo+
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGgsIHVuc2lnbmVkIGlu
dCB2cmVmcmVzaCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBi
cGMpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgYnBjLCBzdHJ1
Y3QgY21kcV9wa3QgKmNtZHFfcGt0KQo+ICB7Cj4gICAgICAgICBzdHJ1Y3QgbXRrX2Rpc3BfY29s
b3IgKmNvbG9yID0gY29tcF90b19jb2xvcihjb21wKTsKPgo+IC0gICAgICAgd3JpdGVsKHcsIGNv
bXAtPnJlZ3MgKyBESVNQX0NPTE9SX1dJRFRIKGNvbG9yKSk7Cj4gLSAgICAgICB3cml0ZWwoaCwg
Y29tcC0+cmVncyArIERJU1BfQ09MT1JfSEVJR0hUKGNvbG9yKSk7Cj4gKyAgICAgICBtdGtfZGRw
X3dyaXRlKGNtZHFfcGt0LCB3LCBjb21wLCBESVNQX0NPTE9SX1dJRFRIKGNvbG9yKSk7Cj4gKyAg
ICAgICBtdGtfZGRwX3dyaXRlKGNtZHFfcGt0LCBoLCBjb21wLCBESVNQX0NPTE9SX0hFSUdIVChj
b2xvcikpOwo+ICB9Cj4KPiAgc3RhdGljIHZvaWQgbXRrX2NvbG9yX3N0YXJ0KHN0cnVjdCBtdGtf
ZGRwX2NvbXAgKmNvbXApCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9t
dGtfZGlzcF9vdmwuYyBiL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZGlzcF9vdmwuYwo+
IGluZGV4IDk0YzgwYzIxNWM2ZS4uZjExYzc4NTE5OWQzIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9tZWRpYXRlay9tdGtfZGlzcF9vdmwuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9t
ZWRpYXRlay9tdGtfZGlzcF9vdmwuYwo+IEBAIC05LDYgKzksNyBAQAo+ICAjaW5jbHVkZSA8bGlu
dXgvb2ZfZGV2aWNlLmg+Cj4gICNpbmNsdWRlIDxsaW51eC9vZl9pcnEuaD4KPiAgI2luY2x1ZGUg
PGxpbnV4L3BsYXRmb3JtX2RldmljZS5oPgo+ICsjaW5jbHVkZSA8bGludXgvc29jL21lZGlhdGVr
L210ay1jbWRxLmg+Cj4KPiAgI2luY2x1ZGUgIm10a19kcm1fY3J0Yy5oIgo+ICAjaW5jbHVkZSAi
bXRrX2RybV9kZHBfY29tcC5oIgo+IEBAIC0xMjAsMTQgKzEyMSwxNSBAQCBzdGF0aWMgdm9pZCBt
dGtfb3ZsX3N0b3Aoc3RydWN0IG10a19kZHBfY29tcCAqY29tcCkKPgo+ICBzdGF0aWMgdm9pZCBt
dGtfb3ZsX2NvbmZpZyhzdHJ1Y3QgbXRrX2RkcF9jb21wICpjb21wLCB1bnNpZ25lZCBpbnQgdywK
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgaCwgdW5zaWduZWQgaW50
IHZyZWZyZXNoLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBicGMp
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGJwYywgc3RydWN0IGNt
ZHFfcGt0ICpjbWRxX3BrdCkKPiAgewo+ICAgICAgICAgaWYgKHcgIT0gMCAmJiBoICE9IDApCj4g
LSAgICAgICAgICAgICAgIHdyaXRlbF9yZWxheGVkKGggPDwgMTYgfCB3LCBjb21wLT5yZWdzICsg
RElTUF9SRUdfT1ZMX1JPSV9TSVpFKTsKPiAtICAgICAgIHdyaXRlbF9yZWxheGVkKDB4MCwgY29t
cC0+cmVncyArIERJU1BfUkVHX09WTF9ST0lfQkdDTFIpOwo+ICsgICAgICAgICAgICAgICBtdGtf
ZGRwX3dyaXRlX3JlbGF4ZWQoY21kcV9wa3QsIGggPDwgMTYgfCB3LCBjb21wLAo+ICsgICAgICAg
ICAgICAgICBESVNQX1JFR19PVkxfUk9JX1NJWkUpOwo+ICsgICAgICAgbXRrX2RkcF93cml0ZV9y
ZWxheGVkKGNtZHFfcGt0LCAweDAsIGNvbXAsIERJU1BfUkVHX09WTF9ST0lfQkdDTFIpOwo+Cj4g
LSAgICAgICB3cml0ZWwoMHgxLCBjb21wLT5yZWdzICsgRElTUF9SRUdfT1ZMX1JTVCk7Cj4gLSAg
ICAgICB3cml0ZWwoMHgwLCBjb21wLT5yZWdzICsgRElTUF9SRUdfT1ZMX1JTVCk7Cj4gKyAgICAg
ICBtdGtfZGRwX3dyaXRlKGNtZHFfcGt0LCAweDEsIGNvbXAsIERJU1BfUkVHX09WTF9SU1QpOwo+
ICsgICAgICAgbXRrX2RkcF93cml0ZShjbWRxX3BrdCwgMHgwLCBjb21wLCBESVNQX1JFR19PVkxf
UlNUKTsKPiAgfQo+Cj4gIHN0YXRpYyB1bnNpZ25lZCBpbnQgbXRrX292bF9sYXllcl9ucihzdHJ1
Y3QgbXRrX2RkcF9jb21wICpjb21wKQo+IEBAIC0xMzcsNyArMTM5LDggQEAgc3RhdGljIHVuc2ln
bmVkIGludCBtdGtfb3ZsX2xheWVyX25yKHN0cnVjdCBtdGtfZGRwX2NvbXAgKmNvbXApCj4gICAg
ICAgICByZXR1cm4gb3ZsLT5kYXRhLT5sYXllcl9ucjsKPiAgfQo+Cj4gLXN0YXRpYyB2b2lkIG10
a19vdmxfbGF5ZXJfb24oc3RydWN0IG10a19kZHBfY29tcCAqY29tcCwgdW5zaWduZWQgaW50IGlk
eCkKPiArc3RhdGljIHZvaWQgbXRrX292bF9sYXllcl9vbihzdHJ1Y3QgbXRrX2RkcF9jb21wICpj
b21wLCB1bnNpZ25lZCBpbnQgaWR4LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ry
dWN0IGNtZHFfcGt0ICpjbWRxX3BrdCkKPiAgewo+ICAgICAgICAgdW5zaWduZWQgaW50IHJlZzsK
PiAgICAgICAgIHVuc2lnbmVkIGludCBnbWNfdGhyc2hkX2w7Cj4gQEAgLTE0NSw4ICsxNDgsOCBA
QCBzdGF0aWMgdm9pZCBtdGtfb3ZsX2xheWVyX29uKHN0cnVjdCBtdGtfZGRwX2NvbXAgKmNvbXAs
IHVuc2lnbmVkIGludCBpZHgpCj4gICAgICAgICB1bnNpZ25lZCBpbnQgZ21jX3ZhbHVlOwo+ICAg
ICAgICAgc3RydWN0IG10a19kaXNwX292bCAqb3ZsID0gY29tcF90b19vdmwoY29tcCk7Cj4KPiAt
ICAgICAgIHdyaXRlbCgweDEsIGNvbXAtPnJlZ3MgKyBESVNQX1JFR19PVkxfUkRNQV9DVFJMKGlk
eCkpOwo+IC0KPiArICAgICAgIG10a19kZHBfd3JpdGUoY21kcV9wa3QsIDB4MSwgY29tcCwKPiAr
ICAgICAgICAgICAgICAgICAgICAgRElTUF9SRUdfT1ZMX1JETUFfQ1RSTChpZHgpKTsKPiAgICAg
ICAgIGdtY190aHJzaGRfbCA9IEdNQ19USFJFU0hPTERfTE9XID4+Cj4gICAgICAgICAgICAgICAg
ICAgICAgIChHTUNfVEhSRVNIT0xEX0JJVFMgLSBvdmwtPmRhdGEtPmdtY19iaXRzKTsKPiAgICAg
ICAgIGdtY190aHJzaGRfaCA9IEdNQ19USFJFU0hPTERfSElHSCA+Pgo+IEBAIC0xNTYsMjIgKzE1
OSwxOSBAQCBzdGF0aWMgdm9pZCBtdGtfb3ZsX2xheWVyX29uKHN0cnVjdCBtdGtfZGRwX2NvbXAg
KmNvbXAsIHVuc2lnbmVkIGludCBpZHgpCj4gICAgICAgICBlbHNlCj4gICAgICAgICAgICAgICAg
IGdtY192YWx1ZSA9IGdtY190aHJzaGRfbCB8IGdtY190aHJzaGRfbCA8PCA4IHwKPiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgZ21jX3RocnNoZF9oIDw8IDE2IHwgZ21jX3RocnNoZF9oIDw8
IDI0Owo+IC0gICAgICAgd3JpdGVsKGdtY192YWx1ZSwgY29tcC0+cmVncyArIERJU1BfUkVHX09W
TF9SRE1BX0dNQyhpZHgpKTsKPiAtCj4gLSAgICAgICByZWcgPSByZWFkbChjb21wLT5yZWdzICsg
RElTUF9SRUdfT1ZMX1NSQ19DT04pOwo+IC0gICAgICAgcmVnID0gcmVnIHwgQklUKGlkeCk7Cj4g
LSAgICAgICB3cml0ZWwocmVnLCBjb21wLT5yZWdzICsgRElTUF9SRUdfT1ZMX1NSQ19DT04pOwoK
WW91IGdldCByaWQgb2YgYWxsIHVzZXMgb2YgdGhlICJyZWciIHZhcmlhYmxlLCBzbyBwbGVhc2Ug
ZHJvcCB0aGUKZGVjbGFyYXRpb24gdG9vLgoKPiArICAgICAgIG10a19kZHBfd3JpdGUoY21kcV9w
a3QsIGdtY192YWx1ZSwKPiArICAgICAgICAgICAgICAgICAgICAgY29tcCwgRElTUF9SRUdfT1ZM
X1JETUFfR01DKGlkeCkpOwo+ICsgICAgICAgbXRrX2RkcF93cml0ZV9tYXNrKGNtZHFfcGt0LCBC
SVQoaWR4KSwgY29tcCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgRElTUF9SRUdfT1ZM
X1NSQ19DT04sIEJJVChpZHgpKTsKPiAgfQo+Cj4gLXN0YXRpYyB2b2lkIG10a19vdmxfbGF5ZXJf
b2ZmKHN0cnVjdCBtdGtfZGRwX2NvbXAgKmNvbXAsIHVuc2lnbmVkIGludCBpZHgpCj4gK3N0YXRp
YyB2b2lkIG10a19vdmxfbGF5ZXJfb2ZmKHN0cnVjdCBtdGtfZGRwX2NvbXAgKmNvbXAsIHVuc2ln
bmVkIGludCBpZHgsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNtZHFf
cGt0ICpjbWRxX3BrdCkKPiAgewo+IC0gICAgICAgdW5zaWduZWQgaW50IHJlZzsKPiAtCj4gLSAg
ICAgICByZWcgPSByZWFkbChjb21wLT5yZWdzICsgRElTUF9SRUdfT1ZMX1NSQ19DT04pOwo+IC0g
ICAgICAgcmVnID0gcmVnICYgfkJJVChpZHgpOwo+IC0gICAgICAgd3JpdGVsKHJlZywgY29tcC0+
cmVncyArIERJU1BfUkVHX09WTF9TUkNfQ09OKTsKPiAtCj4gLSAgICAgICB3cml0ZWwoMHgwLCBj
b21wLT5yZWdzICsgRElTUF9SRUdfT1ZMX1JETUFfQ1RSTChpZHgpKTsKPiArICAgICAgIG10a19k
ZHBfd3JpdGVfbWFzayhjbWRxX3BrdCwgMCwgY29tcCwKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgRElTUF9SRUdfT1ZMX1NSQ19DT04sIEJJVChpZHgpKTsKPiArICAgICAgIG10a19kZHBf
d3JpdGUoY21kcV9wa3QsIDAsIGNvbXAsCj4gKyAgICAgICAgICAgICAgICAgICAgICBESVNQX1JF
R19PVkxfUkRNQV9DVFJMKGlkeCkpOwo+ICB9Cj4KPiAgc3RhdGljIHVuc2lnbmVkIGludCBvdmxf
Zm10X2NvbnZlcnQoc3RydWN0IG10a19kaXNwX292bCAqb3ZsLCB1bnNpZ25lZCBpbnQgZm10KQo+
IEBAIC0yMTEsNyArMjExLDggQEAgc3RhdGljIHVuc2lnbmVkIGludCBvdmxfZm10X2NvbnZlcnQo
c3RydWN0IG10a19kaXNwX292bCAqb3ZsLCB1bnNpZ25lZCBpbnQgZm10KQo+ICB9Cj4KPiAgc3Rh
dGljIHZvaWQgbXRrX292bF9sYXllcl9jb25maWcoc3RydWN0IG10a19kZHBfY29tcCAqY29tcCwg
dW5zaWduZWQgaW50IGlkeCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1
Y3QgbXRrX3BsYW5lX3N0YXRlICpzdGF0ZSkKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdHJ1Y3QgbXRrX3BsYW5lX3N0YXRlICpzdGF0ZSwKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBzdHJ1Y3QgY21kcV9wa3QgKmNtZHFfcGt0KQo+ICB7Cj4gICAgICAgICBz
dHJ1Y3QgbXRrX2Rpc3Bfb3ZsICpvdmwgPSBjb21wX3RvX292bChjb21wKTsKPiAgICAgICAgIHN0
cnVjdCBtdGtfcGxhbmVfcGVuZGluZ19zdGF0ZSAqcGVuZGluZyA9ICZzdGF0ZS0+cGVuZGluZzsK
PiBAQCAtMjIzLDM4ICsyMjQsMzcgQEAgc3RhdGljIHZvaWQgbXRrX292bF9sYXllcl9jb25maWco
c3RydWN0IG10a19kZHBfY29tcCAqY29tcCwgdW5zaWduZWQgaW50IGlkeCwKPiAgICAgICAgIHVu
c2lnbmVkIGludCBjb247Cj4KPiAgICAgICAgIGlmICghcGVuZGluZy0+ZW5hYmxlKQo+IC0gICAg
ICAgICAgICAgICBtdGtfb3ZsX2xheWVyX29mZihjb21wLCBpZHgpOwo+ICsgICAgICAgICAgICAg
ICBtdGtfb3ZsX2xheWVyX29mZihjb21wLCBpZHgsIGNtZHFfcGt0KTsKPgo+ICAgICAgICAgY29u
ID0gb3ZsX2ZtdF9jb252ZXJ0KG92bCwgZm10KTsKPiAgICAgICAgIGlmIChpZHggIT0gMCkKPiAg
ICAgICAgICAgICAgICAgY29uIHw9IE9WTF9DT05fQUVOIHwgT1ZMX0NPTl9BTFBIQTsKPgo+IC0g
ICAgICAgd3JpdGVsX3JlbGF4ZWQoY29uLCBjb21wLT5yZWdzICsgRElTUF9SRUdfT1ZMX0NPTihp
ZHgpKTsKPiAtICAgICAgIHdyaXRlbF9yZWxheGVkKHBpdGNoLCBjb21wLT5yZWdzICsgRElTUF9S
RUdfT1ZMX1BJVENIKGlkeCkpOwo+IC0gICAgICAgd3JpdGVsX3JlbGF4ZWQoc3JjX3NpemUsIGNv
bXAtPnJlZ3MgKyBESVNQX1JFR19PVkxfU1JDX1NJWkUoaWR4KSk7Cj4gLSAgICAgICB3cml0ZWxf
cmVsYXhlZChvZmZzZXQsIGNvbXAtPnJlZ3MgKyBESVNQX1JFR19PVkxfT0ZGU0VUKGlkeCkpOwo+
IC0gICAgICAgd3JpdGVsX3JlbGF4ZWQoYWRkciwgY29tcC0+cmVncyArIERJU1BfUkVHX09WTF9B
RERSKG92bCwgaWR4KSk7Cj4gKyAgICAgICBtdGtfZGRwX3dyaXRlX3JlbGF4ZWQoY21kcV9wa3Qs
IGNvbiwgY29tcCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBESVNQX1JFR19PVkxf
Q09OKGlkeCkpOwo+ICsgICAgICAgbXRrX2RkcF93cml0ZV9yZWxheGVkKGNtZHFfcGt0LCBwaXRj
aCwgY29tcCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBESVNQX1JFR19PVkxfUElU
Q0goaWR4KSk7Cj4gKyAgICAgICBtdGtfZGRwX3dyaXRlX3JlbGF4ZWQoY21kcV9wa3QsIHNyY19z
aXplLCBjb21wLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERJU1BfUkVHX09WTF9T
UkNfU0laRShpZHgpKTsKPiArICAgICAgIG10a19kZHBfd3JpdGVfcmVsYXhlZChjbWRxX3BrdCwg
b2Zmc2V0LCBjb21wLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERJU1BfUkVHX09W
TF9PRkZTRVQoaWR4KSk7Cj4gKyAgICAgICBtdGtfZGRwX3dyaXRlX3JlbGF4ZWQoY21kcV9wa3Qs
IGFkZHIsIGNvbXAsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRElTUF9SRUdfT1ZM
X0FERFIob3ZsLCBpZHgpKTsKPgo+ICAgICAgICAgaWYgKHBlbmRpbmctPmVuYWJsZSkKPiAtICAg
ICAgICAgICAgICAgbXRrX292bF9sYXllcl9vbihjb21wLCBpZHgpOwo+ICsgICAgICAgICAgICAg
ICBtdGtfb3ZsX2xheWVyX29uKGNvbXAsIGlkeCwgY21kcV9wa3QpOwo+ICB9Cj4KPiAgc3RhdGlj
IHZvaWQgbXRrX292bF9iZ2Nscl9pbl9vbihzdHJ1Y3QgbXRrX2RkcF9jb21wICpjb21wKQo+ICB7
Cj4gLSAgICAgICB1bnNpZ25lZCBpbnQgcmVnOwo+IC0KPiAtICAgICAgIHJlZyA9IHJlYWRsKGNv
bXAtPnJlZ3MgKyBESVNQX1JFR19PVkxfREFUQVBBVEhfQ09OKTsKPiAtICAgICAgIHJlZyA9IHJl
ZyB8IE9WTF9CR0NMUl9TRUxfSU47Cj4gLSAgICAgICB3cml0ZWwocmVnLCBjb21wLT5yZWdzICsg
RElTUF9SRUdfT1ZMX0RBVEFQQVRIX0NPTik7Cj4gKyAgICAgICBtdGtfZGRwX3dyaXRlX21hc2so
TlVMTCwgT1ZMX0JHQ0xSX1NFTF9JTiwgY29tcCwKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICBESVNQX1JFR19PVkxfREFUQVBBVEhfQ09OLCBPVkxfQkdDTFJfU0VMX0lOKTsKPiAgfQo+Cj4g
IHN0YXRpYyB2b2lkIG10a19vdmxfYmdjbHJfaW5fb2ZmKHN0cnVjdCBtdGtfZGRwX2NvbXAgKmNv
bXApCj4gIHsKPiAtICAgICAgIHVuc2lnbmVkIGludCByZWc7Cj4gLQo+IC0gICAgICAgcmVnID0g
cmVhZGwoY29tcC0+cmVncyArIERJU1BfUkVHX09WTF9EQVRBUEFUSF9DT04pOwo+IC0gICAgICAg
cmVnID0gcmVnICYgfk9WTF9CR0NMUl9TRUxfSU47Cj4gLSAgICAgICB3cml0ZWwocmVnLCBjb21w
LT5yZWdzICsgRElTUF9SRUdfT1ZMX0RBVEFQQVRIX0NPTik7Cj4gKyAgICAgICBtdGtfZGRwX3dy
aXRlX21hc2soTlVMTCwgMCwgY29tcCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICBESVNQ
X1JFR19PVkxfREFUQVBBVEhfQ09OLCBPVkxfQkdDTFJfU0VMX0lOKTsKPiAgfQo+Cj4gIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgbXRrX2RkcF9jb21wX2Z1bmNzIG10a19kaXNwX292bF9mdW5jcyA9IHsK
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kaXNwX3JkbWEuYyBi
L2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZGlzcF9yZG1hLmMKPiBpbmRleCAyNDk0NWZl
YzAwYjEuLjZkZjM3MmRhYzNlMyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0
ZWsvbXRrX2Rpc3BfcmRtYS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19k
aXNwX3JkbWEuYwo+IEBAIC05LDYgKzksNyBAQAo+ICAjaW5jbHVkZSA8bGludXgvb2ZfZGV2aWNl
Lmg+Cj4gICNpbmNsdWRlIDxsaW51eC9vZl9pcnEuaD4KPiAgI2luY2x1ZGUgPGxpbnV4L3BsYXRm
b3JtX2RldmljZS5oPgo+ICsjaW5jbHVkZSA8bGludXgvc29jL21lZGlhdGVrL210ay1jbWRxLmg+
Cj4KPiAgI2luY2x1ZGUgIm10a19kcm1fY3J0Yy5oIgo+ICAjaW5jbHVkZSAibXRrX2RybV9kZHBf
Y29tcC5oIgo+IEBAIC04NiwyMyArODcsMTQgQEAgc3RhdGljIGlycXJldHVybl90IG10a19kaXNw
X3JkbWFfaXJxX2hhbmRsZXIoaW50IGlycSwgdm9pZCAqZGV2X2lkKQo+ICAgICAgICAgcmV0dXJu
IElSUV9IQU5ETEVEOwo+ICB9Cj4KPiAtc3RhdGljIHZvaWQgcmRtYV91cGRhdGVfYml0cyhzdHJ1
Y3QgbXRrX2RkcF9jb21wICpjb21wLCB1bnNpZ25lZCBpbnQgcmVnLAo+IC0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG1hc2ssIHVuc2lnbmVkIGludCB2YWwpCj4gLXsK
PiAtICAgICAgIHVuc2lnbmVkIGludCB0bXAgPSByZWFkbChjb21wLT5yZWdzICsgcmVnKTsKPiAt
Cj4gLSAgICAgICB0bXAgPSAodG1wICYgfm1hc2spIHwgKHZhbCAmIG1hc2spOwo+IC0gICAgICAg
d3JpdGVsKHRtcCwgY29tcC0+cmVncyArIHJlZyk7Cj4gLX0KPiAtCj4gIHN0YXRpYyB2b2lkIG10
a19yZG1hX2VuYWJsZV92Ymxhbmsoc3RydWN0IG10a19kZHBfY29tcCAqY29tcCwKPiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBkcm1fY3J0YyAqY3J0YykKPiAgewo+
ICAgICAgICAgc3RydWN0IG10a19kaXNwX3JkbWEgKnJkbWEgPSBjb21wX3RvX3JkbWEoY29tcCk7
Cj4KPiAgICAgICAgIHJkbWEtPmNydGMgPSBjcnRjOwo+IC0gICAgICAgcmRtYV91cGRhdGVfYml0
cyhjb21wLCBESVNQX1JFR19SRE1BX0lOVF9FTkFCTEUsIFJETUFfRlJBTUVfRU5EX0lOVCwKPiAt
ICAgICAgICAgICAgICAgICAgICAgICAgUkRNQV9GUkFNRV9FTkRfSU5UKTsKPiArICAgICAgIG10
a19kZHBfd3JpdGVfbWFzayhOVUxMLCBSRE1BX0ZSQU1FX0VORF9JTlQsIGNvbXAsCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgRElTUF9SRUdfUkRNQV9JTlRfRU5BQkxFLCBSRE1BX0ZSQU1F
X0VORF9JTlQpOwo+ICB9Cj4KPiAgc3RhdGljIHZvaWQgbXRrX3JkbWFfZGlzYWJsZV92Ymxhbmso
c3RydWN0IG10a19kZHBfY29tcCAqY29tcCkKPiBAQCAtMTEwLDMxICsxMDIsMzUgQEAgc3RhdGlj
IHZvaWQgbXRrX3JkbWFfZGlzYWJsZV92Ymxhbmsoc3RydWN0IG10a19kZHBfY29tcCAqY29tcCkK
PiAgICAgICAgIHN0cnVjdCBtdGtfZGlzcF9yZG1hICpyZG1hID0gY29tcF90b19yZG1hKGNvbXAp
Owo+Cj4gICAgICAgICByZG1hLT5jcnRjID0gTlVMTDsKPiAtICAgICAgIHJkbWFfdXBkYXRlX2Jp
dHMoY29tcCwgRElTUF9SRUdfUkRNQV9JTlRfRU5BQkxFLCBSRE1BX0ZSQU1FX0VORF9JTlQsIDAp
Owo+ICsgICAgICAgbXRrX2RkcF93cml0ZV9tYXNrKE5VTEwsIDAsIGNvbXAsCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgRElTUF9SRUdfUkRNQV9JTlRfRU5BQkxFLCBSRE1BX0ZSQU1FX0VO
RF9JTlQpOwo+ICB9Cj4KPiAgc3RhdGljIHZvaWQgbXRrX3JkbWFfc3RhcnQoc3RydWN0IG10a19k
ZHBfY29tcCAqY29tcCkKPiAgewo+IC0gICAgICAgcmRtYV91cGRhdGVfYml0cyhjb21wLCBESVNQ
X1JFR19SRE1BX0dMT0JBTF9DT04sIFJETUFfRU5HSU5FX0VOLAo+IC0gICAgICAgICAgICAgICAg
ICAgICAgICBSRE1BX0VOR0lORV9FTik7Cj4gKyAgICAgICBtdGtfZGRwX3dyaXRlX21hc2soTlVM
TCwgUkRNQV9FTkdJTkVfRU4sIGNvbXAsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgRElT
UF9SRUdfUkRNQV9HTE9CQUxfQ09OLCBSRE1BX0VOR0lORV9FTik7Cj4gIH0KPgo+ICBzdGF0aWMg
dm9pZCBtdGtfcmRtYV9zdG9wKHN0cnVjdCBtdGtfZGRwX2NvbXAgKmNvbXApCj4gIHsKPiAtICAg
ICAgIHJkbWFfdXBkYXRlX2JpdHMoY29tcCwgRElTUF9SRUdfUkRNQV9HTE9CQUxfQ09OLCBSRE1B
X0VOR0lORV9FTiwgMCk7Cj4gKyAgICAgICBtdGtfZGRwX3dyaXRlX21hc2soTlVMTCwgMCwgY29t
cCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICBESVNQX1JFR19SRE1BX0dMT0JBTF9DT04s
IFJETUFfRU5HSU5FX0VOKTsKPiAgfQo+Cj4gIHN0YXRpYyB2b2lkIG10a19yZG1hX2NvbmZpZyhz
dHJ1Y3QgbXRrX2RkcF9jb21wICpjb21wLCB1bnNpZ25lZCBpbnQgd2lkdGgsCj4gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBoZWlnaHQsIHVuc2lnbmVkIGludCB2cmVm
cmVzaCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGJwYykKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGJwYywgc3RydWN0IGNtZHFf
cGt0ICpjbWRxX3BrdCkKPiAgewo+ICAgICAgICAgdW5zaWduZWQgaW50IHRocmVzaG9sZDsKPiAg
ICAgICAgIHVuc2lnbmVkIGludCByZWc7Cj4gICAgICAgICBzdHJ1Y3QgbXRrX2Rpc3BfcmRtYSAq
cmRtYSA9IGNvbXBfdG9fcmRtYShjb21wKTsKPiAgICAgICAgIHUzMiByZG1hX2ZpZm9fc2l6ZTsK
Pgo+IC0gICAgICAgcmRtYV91cGRhdGVfYml0cyhjb21wLCBESVNQX1JFR19SRE1BX1NJWkVfQ09O
XzAsIDB4ZmZmLCB3aWR0aCk7Cj4gLSAgICAgICByZG1hX3VwZGF0ZV9iaXRzKGNvbXAsIERJU1Bf
UkVHX1JETUFfU0laRV9DT05fMSwgMHhmZmZmZiwgaGVpZ2h0KTsKPiArICAgICAgIG10a19kZHBf
d3JpdGVfbWFzayhjbWRxX3BrdCwgd2lkdGgsIGNvbXAsCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgIERJU1BfUkVHX1JETUFfU0laRV9DT05fMCwgMHhmZmYpOwo+ICsgICAgICAgbXRrX2Rk
cF93cml0ZV9tYXNrKGNtZHFfcGt0LCBoZWlnaHQsIGNvbXAsCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgIERJU1BfUkVHX1JETUFfU0laRV9DT05fMSwgMHhmZmZmZik7Cj4KPiAgICAgICAg
IGlmIChyZG1hLT5maWZvX3NpemUpCj4gICAgICAgICAgICAgICAgIHJkbWFfZmlmb19zaXplID0g
cmRtYS0+Zmlmb19zaXplOwo+IEBAIC0xNTEsNyArMTQ3LDcgQEAgc3RhdGljIHZvaWQgbXRrX3Jk
bWFfY29uZmlnKHN0cnVjdCBtdGtfZGRwX2NvbXAgKmNvbXAsIHVuc2lnbmVkIGludCB3aWR0aCwK
PiAgICAgICAgIHJlZyA9IFJETUFfRklGT19VTkRFUkZMT1dfRU4gfAo+ICAgICAgICAgICAgICAg
UkRNQV9GSUZPX1BTRVVET19TSVpFKHJkbWFfZmlmb19zaXplKSB8Cj4gICAgICAgICAgICAgICBS
RE1BX09VVFBVVF9WQUxJRF9GSUZPX1RIUkVTSE9MRCh0aHJlc2hvbGQpOwo+IC0gICAgICAgd3Jp
dGVsKHJlZywgY29tcC0+cmVncyArIERJU1BfUkVHX1JETUFfRklGT19DT04pOwo+ICsgICAgICAg
bXRrX2RkcF93cml0ZShjbWRxX3BrdCwgcmVnLCBjb21wLCBESVNQX1JFR19SRE1BX0ZJRk9fQ09O
KTsKPiAgfQo+Cj4gIHN0YXRpYyB1bnNpZ25lZCBpbnQgcmRtYV9mbXRfY29udmVydChzdHJ1Y3Qg
bXRrX2Rpc3BfcmRtYSAqcmRtYSwKPiBAQCAtMTk3LDcgKzE5Myw4IEBAIHN0YXRpYyB1bnNpZ25l
ZCBpbnQgbXRrX3JkbWFfbGF5ZXJfbnIoc3RydWN0IG10a19kZHBfY29tcCAqY29tcCkKPiAgfQo+
Cj4gIHN0YXRpYyB2b2lkIG10a19yZG1hX2xheWVyX2NvbmZpZyhzdHJ1Y3QgbXRrX2RkcF9jb21w
ICpjb21wLCB1bnNpZ25lZCBpbnQgaWR4LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdHJ1Y3QgbXRrX3BsYW5lX3N0YXRlICpzdGF0ZSkKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgc3RydWN0IG10a19wbGFuZV9zdGF0ZSAqc3RhdGUsCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjbWRxX3BrdCAqY21kcV9wa3QpCj4gIHsK
PiAgICAgICAgIHN0cnVjdCBtdGtfZGlzcF9yZG1hICpyZG1hID0gY29tcF90b19yZG1hKGNvbXAp
Owo+ICAgICAgICAgc3RydWN0IG10a19wbGFuZV9wZW5kaW5nX3N0YXRlICpwZW5kaW5nID0gJnN0
YXRlLT5wZW5kaW5nOwo+IEBAIC0yMDcsMjQgKzIwNCwyNyBAQCBzdGF0aWMgdm9pZCBtdGtfcmRt
YV9sYXllcl9jb25maWcoc3RydWN0IG10a19kZHBfY29tcCAqY29tcCwgdW5zaWduZWQgaW50IGlk
eCwKPiAgICAgICAgIHVuc2lnbmVkIGludCBjb247Cj4KPiAgICAgICAgIGNvbiA9IHJkbWFfZm10
X2NvbnZlcnQocmRtYSwgZm10KTsKPiAtICAgICAgIHdyaXRlbF9yZWxheGVkKGNvbiwgY29tcC0+
cmVncyArIERJU1BfUkRNQV9NRU1fQ09OKTsKPiArICAgICAgIG10a19kZHBfd3JpdGVfcmVsYXhl
ZChjbWRxX3BrdCwgY29uLCBjb21wLCBESVNQX1JETUFfTUVNX0NPTik7Cj4KPiAgICAgICAgIGlm
IChmbXQgPT0gRFJNX0ZPUk1BVF9VWVZZIHx8IGZtdCA9PSBEUk1fRk9STUFUX1lVWVYpIHsKPiAt
ICAgICAgICAgICAgICAgcmRtYV91cGRhdGVfYml0cyhjb21wLCBESVNQX1JFR19SRE1BX1NJWkVf
Q09OXzAsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkRNQV9NQVRSSVhfRU5B
QkxFLCBSRE1BX01BVFJJWF9FTkFCTEUpOwo+IC0gICAgICAgICAgICAgICByZG1hX3VwZGF0ZV9i
aXRzKGNvbXAsIERJU1BfUkVHX1JETUFfU0laRV9DT05fMCwKPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBSRE1BX01BVFJJWF9JTlRfTVRYX1NFTCwKPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBSRE1BX01BVFJJWF9JTlRfTVRYX0JUNjAxX3RvX1JHQik7Cj4gKyAg
ICAgICAgICAgICAgIG10a19kZHBfd3JpdGVfbWFzayhjbWRxX3BrdCwgUkRNQV9NQVRSSVhfRU5B
QkxFLCBjb21wLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRElTUF9SRUdf
UkRNQV9TSVpFX0NPTl8wLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkRN
QV9NQVRSSVhfRU5BQkxFKTsKPiArICAgICAgICAgICAgICAgbXRrX2RkcF93cml0ZV9tYXNrKGNt
ZHFfcGt0LCBSRE1BX01BVFJJWF9JTlRfTVRYX0JUNjAxX3RvX1JHQiwKPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGNvbXAsIERJU1BfUkVHX1JETUFfU0laRV9DT05fMCwKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJETUFfTUFUUklYX0lOVF9NVFhfU0VM
KTsKPiAgICAgICAgIH0gZWxzZSB7Cj4gLSAgICAgICAgICAgICAgIHJkbWFfdXBkYXRlX2JpdHMo
Y29tcCwgRElTUF9SRUdfUkRNQV9TSVpFX0NPTl8wLAo+IC0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIFJETUFfTUFUUklYX0VOQUJMRSwgMCk7Cj4gKyAgICAgICAgICAgICAgIG10a19k
ZHBfd3JpdGVfbWFzayhjbWRxX3BrdCwgMCwgY29tcCwKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIERJU1BfUkVHX1JETUFfU0laRV9DT05fMCwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIFJETUFfTUFUUklYX0VOQUJMRSk7Cj4gICAgICAgICB9Cj4gKyAg
ICAgICBtdGtfZGRwX3dyaXRlX3JlbGF4ZWQoY21kcV9wa3QsIGFkZHIsIGNvbXAsIERJU1BfUkRN
QV9NRU1fU1RBUlRfQUREUik7Cj4gKyAgICAgICBtdGtfZGRwX3dyaXRlX3JlbGF4ZWQoY21kcV9w
a3QsIHBpdGNoLCBjb21wLCBESVNQX1JETUFfTUVNX1NSQ19QSVRDSCk7Cj4gKyAgICAgICBtdGtf
ZGRwX3dyaXRlKGNtZHFfcGt0LCBSRE1BX01FTV9HTUMsIGNvbXAsCj4gKyAgICAgICAgICAgICAg
ICAgICAgIERJU1BfUkRNQV9NRU1fR01DX1NFVFRJTkdfMCk7Cj4gKyAgICAgICBtdGtfZGRwX3dy
aXRlX21hc2soY21kcV9wa3QsIFJETUFfTU9ERV9NRU1PUlksIGNvbXAsCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgRElTUF9SRUdfUkRNQV9HTE9CQUxfQ09OLCBSRE1BX01PREVfTUVNT1JZ
KTsKPgo+IC0gICAgICAgd3JpdGVsX3JlbGF4ZWQoYWRkciwgY29tcC0+cmVncyArIERJU1BfUkRN
QV9NRU1fU1RBUlRfQUREUik7Cj4gLSAgICAgICB3cml0ZWxfcmVsYXhlZChwaXRjaCwgY29tcC0+
cmVncyArIERJU1BfUkRNQV9NRU1fU1JDX1BJVENIKTsKPiAtICAgICAgIHdyaXRlbChSRE1BX01F
TV9HTUMsIGNvbXAtPnJlZ3MgKyBESVNQX1JETUFfTUVNX0dNQ19TRVRUSU5HXzApOwo+IC0gICAg
ICAgcmRtYV91cGRhdGVfYml0cyhjb21wLCBESVNQX1JFR19SRE1BX0dMT0JBTF9DT04sCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgIFJETUFfTU9ERV9NRU1PUlksIFJETUFfTU9ERV9NRU1PUlkp
Owo+ICB9Cj4KPiAgc3RhdGljIGNvbnN0IHN0cnVjdCBtdGtfZGRwX2NvbXBfZnVuY3MgbXRrX2Rp
c3BfcmRtYV9mdW5jcyA9IHsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVr
L210a19kcm1fZGRwX2NvbXAuYyBiL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9tdGtfZHJtX2Rk
cF9jb21wLmMKPiBpbmRleCA4ZmVhOTg1NzhiYzguLjc2NDE2YzFjYmIyOCAxMDA2NDQKPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9kZHBfY29tcC5jCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fZGRwX2NvbXAuYwo+IEBAIC0xMyw2ICsxMyw3
IEBACj4gICNpbmNsdWRlIDxsaW51eC9vZl9wbGF0Zm9ybS5oPgo+ICAjaW5jbHVkZSA8bGludXgv
cGxhdGZvcm1fZGV2aWNlLmg+Cj4gICNpbmNsdWRlIDxkcm0vZHJtUC5oPgo+ICsjaW5jbHVkZSA8
bGludXgvc29jL21lZGlhdGVrL210ay1jbWRxLmg+Cj4gICNpbmNsdWRlICJtdGtfZHJtX2Rydi5o
Igo+ICAjaW5jbHVkZSAibXRrX2RybV9wbGFuZS5oIgo+ICAjaW5jbHVkZSAibXRrX2RybV9kZHBf
Y29tcC5oIgo+IEBAIC03NiwzNiArNzcsNzYgQEAKPiAgI2RlZmluZSBESVRIRVJfQUREX0xTSElG
VF9HKHgpICAgICAgICAgICAgICAgICAoKCh4KSAmIDB4NykgPDwgNCkKPiAgI2RlZmluZSBESVRI
RVJfQUREX1JTSElGVF9HKHgpICAgICAgICAgICAgICAgICAoKCh4KSAmIDB4NykgPDwgMCkKPgo+
ICt2b2lkIG10a19kZHBfd3JpdGUoc3RydWN0IGNtZHFfcGt0ICpjbWRxX3BrdCwgdW5zaWduZWQg
aW50IHZhbHVlLAo+ICsgICAgICAgICAgICAgICAgICBzdHJ1Y3QgbXRrX2RkcF9jb21wICpjb21w
LCB1bnNpZ25lZCBpbnQgb2Zmc2V0KQo+ICt7Cj4gKyAgICAgICBpZiAoSVNfRU5BQkxFRChDT05G
SUdfTVRLX0NNRFEpICYmIGNtZHFfcGt0KQo+ICsgICAgICAgICAgICAgICBjbWRxX3BrdF93cml0
ZShjbWRxX3BrdCwgY29tcC0+c3Vic3lzLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBjb21wLT5yZWdzX3BhICsgb2Zmc2V0LCB2YWx1ZSk7Cj4gKyAgICAgICBlbHNlCj4gKyAgICAg
ICAgICAgICAgIHdyaXRlbCh2YWx1ZSwgY29tcC0+cmVncyArIG9mZnNldCk7Cj4gK30KPiArCj4g
K3ZvaWQgbXRrX2RkcF93cml0ZV9yZWxheGVkKHN0cnVjdCBjbWRxX3BrdCAqY21kcV9wa3QsIHVu
c2lnbmVkIGludCB2YWx1ZSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgbXRr
X2RkcF9jb21wICpjb21wLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGlu
dCBvZmZzZXQpCj4gK3sKPiArICAgICAgIGlmIChJU19FTkFCTEVEKENPTkZJR19NVEtfQ01EUSkg
JiYgY21kcV9wa3QpCj4gKyAgICAgICAgICAgICAgIGNtZHFfcGt0X3dyaXRlKGNtZHFfcGt0LCBj
b21wLT5zdWJzeXMsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXAtPnJlZ3Nf
cGEgKyBvZmZzZXQsIHZhbHVlKTsKPiArICAgICAgIGVsc2UKPiArICAgICAgICAgICAgICAgd3Jp
dGVsX3JlbGF4ZWQodmFsdWUsIGNvbXAtPnJlZ3MgKyBvZmZzZXQpOwo+ICt9Cj4gKwo+ICt2b2lk
IG10a19kZHBfd3JpdGVfbWFzayhzdHJ1Y3QgY21kcV9wa3QgKmNtZHFfcGt0LAo+ICsgICAgICAg
ICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCB2YWx1ZSwKPiArICAgICAgICAgICAgICAgICAg
ICAgICBzdHJ1Y3QgbXRrX2RkcF9jb21wICpjb21wLAo+ICsgICAgICAgICAgICAgICAgICAgICAg
IHVuc2lnbmVkIGludCBvZmZzZXQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQg
aW50IG1hc2spCj4gK3sKPiArICAgICAgIGlmIChJU19FTkFCTEVEKENPTkZJR19NVEtfQ01EUSkg
JiYgY21kcV9wa3QpIHsKPiArICAgICAgICAgICAgICAgY21kcV9wa3Rfd3JpdGVfbWFzayhjbWRx
X3BrdCwgY29tcC0+c3Vic3lzLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGNvbXAtPnJlZ3NfcGEgKyBvZmZzZXQsIHZhbHVlLCBtYXNrKTsKPiArICAgICAgIH0gZWxzZSB7
Cj4gKyAgICAgICAgICAgICAgIHUzMiB0bXAgPSByZWFkbChjb21wLT5yZWdzICsgb2Zmc2V0KTsK
PiArCj4gKyAgICAgICAgICAgICAgIHRtcCA9ICh0bXAgJiB+bWFzaykgfCAodmFsdWUgJiBtYXNr
KTsKPiArICAgICAgICAgICAgICAgd3JpdGVsKHRtcCwgY29tcC0+cmVncyArIG9mZnNldCk7Cj4g
KyAgICAgICB9Cj4gK30KPiArCj4gIHZvaWQgbXRrX2RpdGhlcl9zZXQoc3RydWN0IG10a19kZHBf
Y29tcCAqY29tcCwgdW5zaWduZWQgaW50IGJwYywKPiAtICAgICAgICAgICAgICAgICAgIHVuc2ln
bmVkIGludCBDRkcpCj4gKyAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgQ0ZHLCBzdHJ1
Y3QgY21kcV9wa3QgKmNtZHFfcGt0KQo+ICB7Cj4gICAgICAgICAvKiBJZiBicGMgZXF1YWwgdG8g
MCwgdGhlIGRpdGhlcmluZyBmdW5jdGlvbiBkaWRuJ3QgYmUgZW5hYmxlZCAqLwo+ICAgICAgICAg
aWYgKGJwYyA9PSAwKQo+ICAgICAgICAgICAgICAgICByZXR1cm47Cj4KPiAgICAgICAgIGlmIChi
cGMgPj0gTVRLX01JTl9CUEMpIHsKPiAtICAgICAgICAgICAgICAgd3JpdGVsKDAsIGNvbXAtPnJl
Z3MgKyBESVNQX0RJVEhFUl81KTsKPiAtICAgICAgICAgICAgICAgd3JpdGVsKDAsIGNvbXAtPnJl
Z3MgKyBESVNQX0RJVEhFUl83KTsKPiAtICAgICAgICAgICAgICAgd3JpdGVsKERJVEhFUl9MU0Jf
RVJSX1NISUZUX1IoTVRLX01BWF9CUEMgLSBicGMpIHwKPiAtICAgICAgICAgICAgICAgICAgICAg
IERJVEhFUl9BRERfTFNISUZUX1IoTVRLX01BWF9CUEMgLSBicGMpIHwKPiAtICAgICAgICAgICAg
ICAgICAgICAgIERJVEhFUl9ORVdfQklUX01PREUsCj4gLSAgICAgICAgICAgICAgICAgICAgICBj
b21wLT5yZWdzICsgRElTUF9ESVRIRVJfMTUpOwo+IC0gICAgICAgICAgICAgICB3cml0ZWwoRElU
SEVSX0xTQl9FUlJfU0hJRlRfQihNVEtfTUFYX0JQQyAtIGJwYykgfAo+IC0gICAgICAgICAgICAg
ICAgICAgICAgRElUSEVSX0FERF9MU0hJRlRfQihNVEtfTUFYX0JQQyAtIGJwYykgfAo+IC0gICAg
ICAgICAgICAgICAgICAgICAgRElUSEVSX0xTQl9FUlJfU0hJRlRfRyhNVEtfTUFYX0JQQyAtIGJw
YykgfAo+IC0gICAgICAgICAgICAgICAgICAgICAgRElUSEVSX0FERF9MU0hJRlRfRyhNVEtfTUFY
X0JQQyAtIGJwYyksCj4gLSAgICAgICAgICAgICAgICAgICAgICBjb21wLT5yZWdzICsgRElTUF9E
SVRIRVJfMTYpOwo+IC0gICAgICAgICAgICAgICB3cml0ZWwoRElTUF9ESVRIRVJJTkcsIGNvbXAt
PnJlZ3MgKyBDRkcpOwo+ICsgICAgICAgICAgICAgICBtdGtfZGRwX3dyaXRlKGNtZHFfcGt0LCAw
LCBjb21wLCBESVNQX0RJVEhFUl81KTsKPiArICAgICAgICAgICAgICAgbXRrX2RkcF93cml0ZShj
bWRxX3BrdCwgMCwgY29tcCwgRElTUF9ESVRIRVJfNyk7Cj4gKyAgICAgICAgICAgICAgIG10a19k
ZHBfd3JpdGUoY21kcV9wa3QsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRElUSEVS
X0xTQl9FUlJfU0hJRlRfUihNVEtfTUFYX0JQQyAtIGJwYykgfAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIERJVEhFUl9BRERfTFNISUZUX1IoTVRLX01BWF9CUEMgLSBicGMpIHwKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBESVRIRVJfTkVXX0JJVF9NT0RFLAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXAsIERJU1BfRElUSEVSXzE1KTsKPiArICAgICAg
ICAgICAgICAgbXRrX2RkcF93cml0ZShjbWRxX3BrdCwKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBESVRIRVJfTFNCX0VSUl9TSElGVF9CKE1US19NQVhfQlBDIC0gYnBjKSB8Cj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgRElUSEVSX0FERF9MU0hJRlRfQihNVEtfTUFYX0JQ
QyAtIGJwYykgfAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERJVEhFUl9MU0JfRVJS
X1NISUZUX0coTVRLX01BWF9CUEMgLSBicGMpIHwKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBESVRIRVJfQUREX0xTSElGVF9HKE1US19NQVhfQlBDIC0gYnBjKSwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBjb21wLCBESVNQX0RJVEhFUl8xNik7Cj4gKyAgICAgICAgICAg
ICAgIG10a19kZHBfd3JpdGUoY21kcV9wa3QsIERJU1BfRElUSEVSSU5HLCBjb21wLCBDRkcpOwo+
ICAgICAgICAgfQo+ICB9Cj4KPiAgc3RhdGljIHZvaWQgbXRrX29kX2NvbmZpZyhzdHJ1Y3QgbXRr
X2RkcF9jb21wICpjb21wLCB1bnNpZ25lZCBpbnQgdywKPiAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHVuc2lnbmVkIGludCBoLCB1bnNpZ25lZCBpbnQgdnJlZnJlc2gsCj4gLSAgICAgICAgICAg
ICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgYnBjKQo+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgdW5zaWduZWQgaW50IGJwYywgc3RydWN0IGNtZHFfcGt0ICpjbWRxX3BrdCkKPiAgewo+IC0g
ICAgICAgd3JpdGVsKHcgPDwgMTYgfCBoLCBjb21wLT5yZWdzICsgRElTUF9PRF9TSVpFKTsKPiAt
ICAgICAgIHdyaXRlbChPRF9SRUxBWU1PREUsIGNvbXAtPnJlZ3MgKyBESVNQX09EX0NGRyk7Cj4g
LSAgICAgICBtdGtfZGl0aGVyX3NldChjb21wLCBicGMsIERJU1BfT0RfQ0ZHKTsKPiArICAgICAg
IG10a19kZHBfd3JpdGUoY21kcV9wa3QsIHcgPDwgMTYgfCBoLCBjb21wLCBESVNQX09EX1NJWkUp
Owo+ICsgICAgICAgbXRrX2RkcF93cml0ZShjbWRxX3BrdCwgT0RfUkVMQVlNT0RFLCBjb21wLCBE
SVNQX09EX0NGRyk7Cj4gKyAgICAgICBtdGtfZGl0aGVyX3NldChjb21wLCBicGMsIERJU1BfT0Rf
Q0ZHLCBjbWRxX3BrdCk7Cj4gIH0KPgo+ICBzdGF0aWMgdm9pZCBtdGtfb2Rfc3RhcnQoc3RydWN0
IG10a19kZHBfY29tcCAqY29tcCkKPiBAQCAtMTIwLDkgKzE2MSw5IEBAIHN0YXRpYyB2b2lkIG10
a191Zm9lX3N0YXJ0KHN0cnVjdCBtdGtfZGRwX2NvbXAgKmNvbXApCj4KPiAgc3RhdGljIHZvaWQg
bXRrX2FhbF9jb25maWcoc3RydWN0IG10a19kZHBfY29tcCAqY29tcCwgdW5zaWduZWQgaW50IHcs
Cj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGgsIHVuc2lnbmVkIGlu
dCB2cmVmcmVzaCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgYnBj
KQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBicGMsIHN0cnVjdCBj
bWRxX3BrdCAqY21kcV9wa3QpCj4gIHsKPiAtICAgICAgIHdyaXRlbChoIDw8IDE2IHwgdywgY29t
cC0+cmVncyArIERJU1BfQUFMX1NJWkUpOwo+ICsgICAgICAgbXRrX2RkcF93cml0ZShjbWRxX3Br
dCwgaCA8PCAxNiB8IHcsIGNvbXAsIERJU1BfQUFMX1NJWkUpOwo+ICB9Cj4KPiAgc3RhdGljIHZv
aWQgbXRrX2FhbF9zdGFydChzdHJ1Y3QgbXRrX2RkcF9jb21wICpjb21wKQo+IEBAIC0xMzcsMTAg
KzE3OCwxMCBAQCBzdGF0aWMgdm9pZCBtdGtfYWFsX3N0b3Aoc3RydWN0IG10a19kZHBfY29tcCAq
Y29tcCkKPgo+ICBzdGF0aWMgdm9pZCBtdGtfY2NvcnJfY29uZmlnKHN0cnVjdCBtdGtfZGRwX2Nv
bXAgKmNvbXAsIHVuc2lnbmVkIGludCB3LAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dW5zaWduZWQgaW50IGgsIHVuc2lnbmVkIGludCB2cmVmcmVzaCwKPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHVuc2lnbmVkIGludCBicGMpCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1bnNpZ25lZCBpbnQgYnBjLCBzdHJ1Y3QgY21kcV9wa3QgKmNtZHFfcGt0KQo+ICB7Cj4g
LSAgICAgICB3cml0ZWwoaCA8PCAxNiB8IHcsIGNvbXAtPnJlZ3MgKyBESVNQX0NDT1JSX1NJWkUp
Owo+IC0gICAgICAgd3JpdGVsKENDT1JSX1JFTEFZX01PREUsIGNvbXAtPnJlZ3MgKyBESVNQX0ND
T1JSX0NGRyk7Cj4gKyAgICAgICBtdGtfZGRwX3dyaXRlKGNtZHFfcGt0LCBoIDw8IDE2IHwgdywg
Y29tcCwgRElTUF9DQ09SUl9TSVpFKTsKPiArICAgICAgIG10a19kZHBfd3JpdGUoY21kcV9wa3Qs
IENDT1JSX1JFTEFZX01PREUsIGNvbXAsIERJU1BfQ0NPUlJfQ0ZHKTsKPiAgfQo+Cj4gIHN0YXRp
YyB2b2lkIG10a19jY29ycl9zdGFydChzdHJ1Y3QgbXRrX2RkcF9jb21wICpjb21wKQo+IEBAIC0x
NTUsMTAgKzE5NiwxMCBAQCBzdGF0aWMgdm9pZCBtdGtfY2NvcnJfc3RvcChzdHJ1Y3QgbXRrX2Rk
cF9jb21wICpjb21wKQo+Cj4gIHN0YXRpYyB2b2lkIG10a19kaXRoZXJfY29uZmlnKHN0cnVjdCBt
dGtfZGRwX2NvbXAgKmNvbXAsIHVuc2lnbmVkIGludCB3LAo+ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHVuc2lnbmVkIGludCBoLCB1bnNpZ25lZCBpbnQgdnJlZnJlc2gsCj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGJwYykKPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgYnBjLCBzdHJ1Y3QgY21kcV9wa3QgKmNtZHFf
cGt0KQo+ICB7Cj4gLSAgICAgICB3cml0ZWwoaCA8PCAxNiB8IHcsIGNvbXAtPnJlZ3MgKyBESVNQ
X0RJVEhFUl9TSVpFKTsKPiAtICAgICAgIHdyaXRlbChESVRIRVJfUkVMQVlfTU9ERSwgY29tcC0+
cmVncyArIERJU1BfRElUSEVSX0NGRyk7Cj4gKyAgICAgICBtdGtfZGRwX3dyaXRlKGNtZHFfcGt0
LCBoIDw8IDE2IHwgdywgY29tcCwgRElTUF9ESVRIRVJfU0laRSk7Cj4gKyAgICAgICBtdGtfZGRw
X3dyaXRlKGNtZHFfcGt0LCBESVRIRVJfUkVMQVlfTU9ERSwgY29tcCwgRElTUF9ESVRIRVJfQ0ZH
KTsKPiAgfQo+Cj4gIHN0YXRpYyB2b2lkIG10a19kaXRoZXJfc3RhcnQoc3RydWN0IG10a19kZHBf
Y29tcCAqY29tcCkKPiBAQCAtMTczLDEwICsyMTQsMTAgQEAgc3RhdGljIHZvaWQgbXRrX2RpdGhl
cl9zdG9wKHN0cnVjdCBtdGtfZGRwX2NvbXAgKmNvbXApCj4KPiAgc3RhdGljIHZvaWQgbXRrX2dh
bW1hX2NvbmZpZyhzdHJ1Y3QgbXRrX2RkcF9jb21wICpjb21wLCB1bnNpZ25lZCBpbnQgdywKPiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBoLCB1bnNpZ25lZCBpbnQg
dnJlZnJlc2gsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgYnBj
KQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGJwYywgc3RydWN0
IGNtZHFfcGt0ICpjbWRxX3BrdCkKPiAgewo+IC0gICAgICAgd3JpdGVsKGggPDwgMTYgfCB3LCBj
b21wLT5yZWdzICsgRElTUF9HQU1NQV9TSVpFKTsKPiAtICAgICAgIG10a19kaXRoZXJfc2V0KGNv
bXAsIGJwYywgRElTUF9HQU1NQV9DRkcpOwo+ICsgICAgICAgbXRrX2RkcF93cml0ZShjbWRxX3Br
dCwgaCA8PCAxNiB8IHcsIGNvbXAsIERJU1BfR0FNTUFfU0laRSk7Cj4gKyAgICAgICBtdGtfZGl0
aGVyX3NldChjb21wLCBicGMsIERJU1BfR0FNTUFfQ0ZHLCBjbWRxX3BrdCk7Cj4gIH0KPgo+ICBz
dGF0aWMgdm9pZCBtdGtfZ2FtbWFfc3RhcnQoc3RydWN0IG10a19kZHBfY29tcCAqY29tcCkKPiBA
QCAtMTkwLDI0ICsyMzEsMjUgQEAgc3RhdGljIHZvaWQgbXRrX2dhbW1hX3N0b3Aoc3RydWN0IG10
a19kZHBfY29tcCAqY29tcCkKPiAgfQo+Cj4gIHN0YXRpYyB2b2lkIG10a19nYW1tYV9zZXQoc3Ry
dWN0IG10a19kZHBfY29tcCAqY29tcCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVj
dCBkcm1fY3J0Y19zdGF0ZSAqc3RhdGUpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1
Y3QgZHJtX2NydGNfc3RhdGUgKnN0YXRlLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgc3Ry
dWN0IGNtZHFfcGt0ICpjbWRxX3BrdCkKPiAgewo+IC0gICAgICAgdW5zaWduZWQgaW50IGksIHJl
ZzsKPiArICAgICAgIHVuc2lnbmVkIGludCBpOwo+ICAgICAgICAgc3RydWN0IGRybV9jb2xvcl9s
dXQgKmx1dDsKPiAgICAgICAgIHZvaWQgX19pb21lbSAqbHV0X2Jhc2U7Cj4gICAgICAgICB1MzIg
d29yZDsKPgo+ICAgICAgICAgaWYgKHN0YXRlLT5nYW1tYV9sdXQpIHsKPiAtICAgICAgICAgICAg
ICAgcmVnID0gcmVhZGwoY29tcC0+cmVncyArIERJU1BfR0FNTUFfQ0ZHKTsKPiAtICAgICAgICAg
ICAgICAgcmVnID0gcmVnIHwgR0FNTUFfTFVUX0VOOwo+IC0gICAgICAgICAgICAgICB3cml0ZWwo
cmVnLCBjb21wLT5yZWdzICsgRElTUF9HQU1NQV9DRkcpOwo+ICsgICAgICAgICAgICAgICBtdGtf
ZGRwX3dyaXRlX21hc2soY21kcV9wa3QsIEdBTU1BX0xVVF9FTiwgY29tcCwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIERJU1BfR0FNTUFfQ0ZHLCBHQU1NQV9MVVRfRU4pOwo+
ICAgICAgICAgICAgICAgICBsdXRfYmFzZSA9IGNvbXAtPnJlZ3MgKyBESVNQX0dBTU1BX0xVVDsK
PiAgICAgICAgICAgICAgICAgbHV0ID0gKHN0cnVjdCBkcm1fY29sb3JfbHV0ICopc3RhdGUtPmdh
bW1hX2x1dC0+ZGF0YTsKPiAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IE1US19MVVRf
U0laRTsgaSsrKSB7Cj4gICAgICAgICAgICAgICAgICAgICAgICAgd29yZCA9ICgoKGx1dFtpXS5y
ZWQgPj4gNikgJiBMVVRfMTBCSVRfTUFTSykgPDwgMjApICsKPiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICgoKGx1dFtpXS5ncmVlbiA+PiA2KSAmIExVVF8xMEJJVF9NQVNLKSA8PCAx
MCkgKwo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKChsdXRbaV0uYmx1ZSA+PiA2
KSAmIExVVF8xMEJJVF9NQVNLKTsKPiAtICAgICAgICAgICAgICAgICAgICAgICB3cml0ZWwod29y
ZCwgKGx1dF9iYXNlICsgaSAqIDQpKTsKPiArICAgICAgICAgICAgICAgICAgICAgICBtdGtfZGRw
X3dyaXRlKGNtZHFfcGt0LCB3b3JkLCBjb21wLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgKHVuc2lnbmVkIGludCkobHV0X2Jhc2UgKyBpICogNCkpOwo+ICAgICAgICAg
ICAgICAgICB9Cj4gICAgICAgICB9Cj4gIH0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L21lZGlhdGVrL210a19kcm1fZGRwX2NvbXAuaCBiL2RyaXZlcnMvZ3B1L2RybS9tZWRpYXRlay9t
dGtfZHJtX2RkcF9jb21wLmgKPiBpbmRleCAyNjhkNDE2MDgxZGEuLjZiYmMzNWY5MjgxNSAxMDA2
NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vbWVkaWF0ZWsvbXRrX2RybV9kZHBfY29tcC5oCj4g
KysrIGIvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fZGRwX2NvbXAuaAo+IEBAIC02
OSwyMSArNjksMjYgQEAgZW51bSBtdGtfZGRwX2NvbXBfaWQgewo+ICB9Owo+Cj4gIHN0cnVjdCBt
dGtfZGRwX2NvbXA7Cj4gLQo+ICtzdHJ1Y3QgY21kcV9wa3Q7Cj4gIHN0cnVjdCBtdGtfZGRwX2Nv
bXBfZnVuY3Mgewo+ICAgICAgICAgdm9pZCAoKmNvbmZpZykoc3RydWN0IG10a19kZHBfY29tcCAq
Y29tcCwgdW5zaWduZWQgaW50IHcsCj4gLSAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBp
bnQgaCwgdW5zaWduZWQgaW50IHZyZWZyZXNoLCB1bnNpZ25lZCBpbnQgYnBjKTsKPiArICAgICAg
ICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBoLCB1bnNpZ25lZCBpbnQgdnJlZnJlc2gsCj4g
KyAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgYnBjLCBzdHJ1Y3QgY21kcV9wa3Qg
KmNtZHFfcGt0KTsKPiAgICAgICAgIHZvaWQgKCpzdGFydCkoc3RydWN0IG10a19kZHBfY29tcCAq
Y29tcCk7Cj4gICAgICAgICB2b2lkICgqc3RvcCkoc3RydWN0IG10a19kZHBfY29tcCAqY29tcCk7
Cj4gICAgICAgICB2b2lkICgqZW5hYmxlX3ZibGFuaykoc3RydWN0IG10a19kZHBfY29tcCAqY29t
cCwgc3RydWN0IGRybV9jcnRjICpjcnRjKTsKPiAgICAgICAgIHZvaWQgKCpkaXNhYmxlX3ZibGFu
aykoc3RydWN0IG10a19kZHBfY29tcCAqY29tcCk7Cj4gICAgICAgICB1bnNpZ25lZCBpbnQgKCps
YXllcl9ucikoc3RydWN0IG10a19kZHBfY29tcCAqY29tcCk7Cj4gLSAgICAgICB2b2lkICgqbGF5
ZXJfb24pKHN0cnVjdCBtdGtfZGRwX2NvbXAgKmNvbXAsIHVuc2lnbmVkIGludCBpZHgpOwo+IC0g
ICAgICAgdm9pZCAoKmxheWVyX29mZikoc3RydWN0IG10a19kZHBfY29tcCAqY29tcCwgdW5zaWdu
ZWQgaW50IGlkeCk7Cj4gKyAgICAgICB2b2lkICgqbGF5ZXJfb24pKHN0cnVjdCBtdGtfZGRwX2Nv
bXAgKmNvbXAsIHVuc2lnbmVkIGludCBpZHgsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgIHN0
cnVjdCBjbWRxX3BrdCAqY21kcV9wa3QpOwo+ICsgICAgICAgdm9pZCAoKmxheWVyX29mZikoc3Ry
dWN0IG10a19kZHBfY29tcCAqY29tcCwgdW5zaWduZWQgaW50IGlkeCwKPiArICAgICAgICAgICAg
ICAgICAgICAgICAgIHN0cnVjdCBjbWRxX3BrdCAqY21kcV9wa3QpOwo+ICAgICAgICAgdm9pZCAo
KmxheWVyX2NvbmZpZykoc3RydWN0IG10a19kZHBfY29tcCAqY29tcCwgdW5zaWduZWQgaW50IGlk
eCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBtdGtfcGxhbmVfc3RhdGUg
KnN0YXRlKTsKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBtdGtfcGxhbmVf
c3RhdGUgKnN0YXRlLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNtZHFf
cGt0ICpjbWRxX3BrdCk7Cj4gICAgICAgICB2b2lkICgqZ2FtbWFfc2V0KShzdHJ1Y3QgbXRrX2Rk
cF9jb21wICpjb21wLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGRybV9jcnRj
X3N0YXRlICpzdGF0ZSk7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgZHJtX2Ny
dGNfc3RhdGUgKnN0YXRlLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNtZHFf
cGt0ICpjbWRxX3BrdCk7Cj4gICAgICAgICB2b2lkICgqYmdjbHJfaW5fb24pKHN0cnVjdCBtdGtf
ZGRwX2NvbXAgKmNvbXApOwo+ICAgICAgICAgdm9pZCAoKmJnY2xyX2luX29mZikoc3RydWN0IG10
a19kZHBfY29tcCAqY29tcCk7Cj4gIH07Cj4gQEAgLTk4LDEwICsxMDMsMTEgQEAgc3RydWN0IG10
a19kZHBfY29tcCB7Cj4KPiAgc3RhdGljIGlubGluZSB2b2lkIG10a19kZHBfY29tcF9jb25maWco
c3RydWN0IG10a19kZHBfY29tcCAqY29tcCwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1bnNpZ25lZCBpbnQgdywgdW5zaWduZWQgaW50IGgsCj4gLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IHZyZWZyZXNoLCB1bnNpZ25l
ZCBpbnQgYnBjKQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2ln
bmVkIGludCB2cmVmcmVzaCwgdW5zaWduZWQgaW50IGJwYywKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY21kcV9wa3QgKmNtZHFfcGt0KQo+ICB7Cj4gICAg
ICAgICBpZiAoY29tcC0+ZnVuY3MgJiYgY29tcC0+ZnVuY3MtPmNvbmZpZykKPiAtICAgICAgICAg
ICAgICAgY29tcC0+ZnVuY3MtPmNvbmZpZyhjb21wLCB3LCBoLCB2cmVmcmVzaCwgYnBjKTsKPiAr
ICAgICAgICAgICAgICAgY29tcC0+ZnVuY3MtPmNvbmZpZyhjb21wLCB3LCBoLCB2cmVmcmVzaCwg
YnBjLCBjbWRxX3BrdCk7Cj4gIH0KPgo+ICBzdGF0aWMgaW5saW5lIHZvaWQgbXRrX2RkcF9jb21w
X3N0YXJ0KHN0cnVjdCBtdGtfZGRwX2NvbXAgKmNvbXApCj4gQEAgLTEzOCwzMiArMTQ0LDM2IEBA
IHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgaW50IG10a19kZHBfY29tcF9sYXllcl9ucihzdHJ1Y3Qg
bXRrX2RkcF9jb21wICpjb21wKQo+ICB9Cj4KPiAgc3RhdGljIGlubGluZSB2b2lkIG10a19kZHBf
Y29tcF9sYXllcl9vbihzdHJ1Y3QgbXRrX2RkcF9jb21wICpjb21wLAo+IC0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGlkeCkKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBpZHgsCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY21kcV9wa3QgKmNtZHFf
cGt0KQo+ICB7Cj4gICAgICAgICBpZiAoY29tcC0+ZnVuY3MgJiYgY29tcC0+ZnVuY3MtPmxheWVy
X29uKQo+IC0gICAgICAgICAgICAgICBjb21wLT5mdW5jcy0+bGF5ZXJfb24oY29tcCwgaWR4KTsK
PiArICAgICAgICAgICAgICAgY29tcC0+ZnVuY3MtPmxheWVyX29uKGNvbXAsIGlkeCwgY21kcV9w
a3QpOwo+ICB9Cj4KPiAgc3RhdGljIGlubGluZSB2b2lkIG10a19kZHBfY29tcF9sYXllcl9vZmYo
c3RydWN0IG10a19kZHBfY29tcCAqY29tcCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgaWR4KQo+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBpZHgsCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNtZHFfcGt0ICpjbWRxX3BrdCkKPiAgewo+
ICAgICAgICAgaWYgKGNvbXAtPmZ1bmNzICYmIGNvbXAtPmZ1bmNzLT5sYXllcl9vZmYpCj4gLSAg
ICAgICAgICAgICAgIGNvbXAtPmZ1bmNzLT5sYXllcl9vZmYoY29tcCwgaWR4KTsKPiArICAgICAg
ICAgICAgICAgY29tcC0+ZnVuY3MtPmxheWVyX29mZihjb21wLCBpZHgsIGNtZHFfcGt0KTsKPiAg
fQo+Cj4gIHN0YXRpYyBpbmxpbmUgdm9pZCBtdGtfZGRwX2NvbXBfbGF5ZXJfY29uZmlnKHN0cnVj
dCBtdGtfZGRwX2NvbXAgKmNvbXAsCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgdW5zaWduZWQgaW50IGlkeCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgbXRrX3BsYW5lX3N0YXRlICpzdGF0ZSkKPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgbXRrX3BsYW5l
X3N0YXRlICpzdGF0ZSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdHJ1Y3QgY21kcV9wa3QgKmNtZHFfcGt0KQo+ICB7Cj4gICAgICAgICBpZiAoY29tcC0+
ZnVuY3MgJiYgY29tcC0+ZnVuY3MtPmxheWVyX2NvbmZpZykKPiAtICAgICAgICAgICAgICAgY29t
cC0+ZnVuY3MtPmxheWVyX2NvbmZpZyhjb21wLCBpZHgsIHN0YXRlKTsKPiArICAgICAgICAgICAg
ICAgY29tcC0+ZnVuY3MtPmxheWVyX2NvbmZpZyhjb21wLCBpZHgsIHN0YXRlLCBjbWRxX3BrdCk7
Cj4gIH0KPgo+ICBzdGF0aWMgaW5saW5lIHZvaWQgbXRrX2RkcF9nYW1tYV9zZXQoc3RydWN0IG10
a19kZHBfY29tcCAqY29tcCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
c3RydWN0IGRybV9jcnRjX3N0YXRlICpzdGF0ZSkKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc3RydWN0IGRybV9jcnRjX3N0YXRlICpzdGF0ZSwKPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNtZHFfcGt0ICpjbWRxX3BrdCkKPiAgewo+
ICAgICAgICAgaWYgKGNvbXAtPmZ1bmNzICYmIGNvbXAtPmZ1bmNzLT5nYW1tYV9zZXQpCj4gLSAg
ICAgICAgICAgICAgIGNvbXAtPmZ1bmNzLT5nYW1tYV9zZXQoY29tcCwgc3RhdGUpOwo+ICsgICAg
ICAgICAgICAgICBjb21wLT5mdW5jcy0+Z2FtbWFfc2V0KGNvbXAsIHN0YXRlLCBjbWRxX3BrdCk7
Cj4gIH0KPgo+ICBzdGF0aWMgaW5saW5lIHZvaWQgbXRrX2RkcF9jb21wX2JnY2xyX2luX29uKHN0
cnVjdCBtdGtfZGRwX2NvbXAgKmNvbXApCj4gQEAgLTE4Niw2ICsxOTYsMTMgQEAgaW50IG10a19k
ZHBfY29tcF9pbml0KHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRldmljZV9ub2RlICpjb21w
X25vZGUsCj4gIGludCBtdGtfZGRwX2NvbXBfcmVnaXN0ZXIoc3RydWN0IGRybV9kZXZpY2UgKmRy
bSwgc3RydWN0IG10a19kZHBfY29tcCAqY29tcCk7Cj4gIHZvaWQgbXRrX2RkcF9jb21wX3VucmVn
aXN0ZXIoc3RydWN0IGRybV9kZXZpY2UgKmRybSwgc3RydWN0IG10a19kZHBfY29tcCAqY29tcCk7
Cj4gIHZvaWQgbXRrX2RpdGhlcl9zZXQoc3RydWN0IG10a19kZHBfY29tcCAqY29tcCwgdW5zaWdu
ZWQgaW50IGJwYywKPiAtICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBDRkcpOwo+IC0K
PiArICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBDRkcsIHN0cnVjdCBjbWRxX3BrdCAq
Y21kcV9wa3QpOwo+ICtlbnVtIG10a19kZHBfY29tcF90eXBlIG10a19kZHBfY29tcF9nZXRfdHlw
ZShlbnVtIG10a19kZHBfY29tcF9pZCBjb21wX2lkKTsKPiArdm9pZCBtdGtfZGRwX3dyaXRlKHN0
cnVjdCBjbWRxX3BrdCAqY21kcV9wa3QsIHVuc2lnbmVkIGludCB2YWx1ZSwKPiArICAgICAgICAg
ICAgICAgICAgc3RydWN0IG10a19kZHBfY29tcCAqY29tcCwgdW5zaWduZWQgaW50IG9mZnNldCk7
Cj4gK3ZvaWQgbXRrX2RkcF93cml0ZV9yZWxheGVkKHN0cnVjdCBjbWRxX3BrdCAqY21kcV9wa3Qs
IHVuc2lnbmVkIGludCB2YWx1ZSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
bXRrX2RkcF9jb21wICpjb21wLCB1bnNpZ25lZCBpbnQgb2Zmc2V0KTsKPiArdm9pZCBtdGtfZGRw
X3dyaXRlX21hc2soc3RydWN0IGNtZHFfcGt0ICpjbWRxX3BrdCwgdW5zaWduZWQgaW50IHZhbHVl
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBtdGtfZGRwX2NvbXAgKmNvbXAsIHVu
c2lnbmVkIGludCBvZmZzZXQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50
IG1hc2spOwo+ICAjZW5kaWYgLyogTVRLX0RSTV9ERFBfQ09NUF9IICovCj4gLS0KPiAyLjE4LjAK
PgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2
ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9s
aXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
