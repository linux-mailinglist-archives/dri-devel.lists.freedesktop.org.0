Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 6B25F61B21
	for <lists+dri-devel@lfdr.de>; Mon,  8 Jul 2019 09:13:13 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 629BC89C21;
	Mon,  8 Jul 2019 07:12:40 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from relay6-d.mail.gandi.net (relay6-d.mail.gandi.net
 [217.70.183.198])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6A0A289D4B
 for <dri-devel@lists.freedesktop.org>; Sat,  6 Jul 2019 14:07:22 +0000 (UTC)
X-Originating-IP: 2.224.242.101
Received: from uno.localdomain (2-224-242-101.ip172.fastwebnet.it
 [2.224.242.101]) (Authenticated sender: jacopo@jmondi.org)
 by relay6-d.mail.gandi.net (Postfix) with ESMTPSA id E70A1C0002;
 Sat,  6 Jul 2019 14:07:18 +0000 (UTC)
From: Jacopo Mondi <jacopo+renesas@jmondi.org>
To: laurent.pinchart@ideasonboard.com, kieran.bingham+renesas@ideasonboard.com,
 airlied@linux.ie, daniel@ffwll.ch
Subject: [PATCH v2 16/19] drm: rcar-du: kms: Collect CMM instances
Date: Sat,  6 Jul 2019 16:07:43 +0200
Message-Id: <20190706140746.29132-17-jacopo+renesas@jmondi.org>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190706140746.29132-1-jacopo+renesas@jmondi.org>
References: <20190706140746.29132-1-jacopo+renesas@jmondi.org>
MIME-Version: 1.0
X-Mailman-Approved-At: Mon, 08 Jul 2019 07:11:53 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: muroya@ksk.co.jp, koji.matsuoka.xm@renesas.com,
 dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org,
 linux-renesas-soc@vger.kernel.org, VenkataRajesh.Kalakodima@in.bosch.com,
 Jacopo Mondi <jacopo+renesas@jmondi.org>,
 Harsha.ManjulaMallikarjun@in.bosch.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW1wbGVtZW50IGRldmljZSB0cmVlIHBhcnNpbmcgdG8gY29sbGVjdCB0aGUgYXZhaWxhYmxlIENN
TSBpbnN0YW5jZXMKZGVzY3JpYmVkIGJ5IHRoZSAnY21tcycgcHJvcGVydHkuIEFzc29jaWF0ZSBD
TU1zIHdpdGggQ1JUQ3MgYW5kIHN0b3JlIGEKbWFzayBvZiBhY3RpdmUgQ01NcyBpbiB0aGUgRFUg
Z3JvdXAgZm9yIGxhdGVyIGVuYWJsZW1lbnQuCgpTaWduZWQtb2ZmLWJ5OiBKYWNvcG8gTW9uZGkg
PGphY29wbytyZW5lc2FzQGptb25kaS5vcmc+Ci0tLQogZHJpdmVycy9ncHUvZHJtL3JjYXItZHUv
cmNhcl9kdV9jcnRjLmMgIHwgIDYgKysrCiBkcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1
X2NydGMuaCAgfCAgMiArCiBkcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X2Rydi5oICAg
fCAgMyArKwogZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9ncm91cC5oIHwgIDIgKwog
ZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9rbXMuYyAgIHwgNTAgKysrKysrKysrKysr
KysrKysrKysrKysrKwogNSBmaWxlcyBjaGFuZ2VkLCA2MyBpbnNlcnRpb25zKCspCgpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9jcnRjLmMgYi9kcml2ZXJzL2dw
dS9kcm0vcmNhci1kdS9yY2FyX2R1X2NydGMuYwppbmRleCAyZGE0NmUzZGM0YWUuLjIzZjFkNmNj
MTcxOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9jcnRjLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9jcnRjLmMKQEAgLTExOTQsNiAr
MTE5NCwxMiBAQCBpbnQgcmNhcl9kdV9jcnRjX2NyZWF0ZShzdHJ1Y3QgcmNhcl9kdV9ncm91cCAq
cmdycCwgdW5zaWduZWQgaW50IHN3aW5kZXgsCiAJaWYgKHJldCA8IDApCiAJCXJldHVybiByZXQ7
CiAKKwkvKiBDTU0gbWlnaHQgYmUgZGlzYWJsZWQgZm9yIHRoaXMgQ1JUQy4gKi8KKwlpZiAocmNk
dS0+Y21tc1tzd2luZGV4XSkgeworCQlyY3J0Yy0+Y21tID0gcmNkdS0+Y21tc1tzd2luZGV4XTsK
KwkJcmdycC0+Y21tc19tYXNrIHw9IEJJVChod2luZGV4ICUgMik7CisJfQorCiAJZHJtX2NydGNf
aGVscGVyX2FkZChjcnRjLCAmY3J0Y19oZWxwZXJfZnVuY3MpOwogCiAJLyogU3RhcnQgd2l0aCB2
ZXJ0aWNhbCBibGFua2luZyBpbnRlcnJ1cHQgcmVwb3J0aW5nIGRpc2FibGVkLiAqLwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9jcnRjLmggYi9kcml2ZXJzL2dw
dS9kcm0vcmNhci1kdS9yY2FyX2R1X2NydGMuaAppbmRleCAzYjdmYzY2ODk5NmYuLjVmMjk0MGM0
MjIyNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9jcnRjLmgK
KysrIGIvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9jcnRjLmgKQEAgLTM5LDYgKzM5
LDcgQEAgc3RydWN0IHJjYXJfZHVfdnNwOwogICogQHZibGFua193YWl0OiB3YWl0IHF1ZXVlIHVz
ZWQgdG8gc2lnbmFsIHZlcnRpY2FsIGJsYW5raW5nCiAgKiBAdmJsYW5rX2NvdW50OiBudW1iZXIg
b2YgdmVydGljYWwgYmxhbmtpbmcgaW50ZXJydXB0cyB0byB3YWl0IGZvcgogICogQGdyb3VwOiBD
UlRDIGdyb3VwIHRoaXMgQ1JUQyBiZWxvbmdzIHRvCisgKiBAY21tOiBDTU0gYXNzb2NpYXRlZCB3
aXRoIHRoaXMgQ1JUQwogICogQHZzcDogVlNQIGZlZWRpbmcgdmlkZW8gdG8gdGhpcyBDUlRDCiAg
KiBAdnNwX3BpcGU6IGluZGV4IG9mIHRoZSBWU1AgcGlwZWxpbmUgZmVlZGluZyB2aWRlbyB0byB0
aGlzIENSVEMKICAqIEB3cml0ZWJhY2s6IHRoZSB3cml0ZWJhY2sgY29ubmVjdG9yCkBAIC02NCw2
ICs2NSw3IEBAIHN0cnVjdCByY2FyX2R1X2NydGMgewogCXVuc2lnbmVkIGludCB2YmxhbmtfY291
bnQ7CiAKIAlzdHJ1Y3QgcmNhcl9kdV9ncm91cCAqZ3JvdXA7CisJc3RydWN0IHBsYXRmb3JtX2Rl
dmljZSAqY21tOwogCXN0cnVjdCByY2FyX2R1X3ZzcCAqdnNwOwogCXVuc2lnbmVkIGludCB2c3Bf
cGlwZTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9kcnYu
aCBiL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfZHJ2LmgKaW5kZXggYTAwZGNjYzQ0
N2FhLi4zMDBlYzYwYmEzMWIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3Jj
YXJfZHVfZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9kcnYuaApA
QCAtMTMsNiArMTMsNyBAQAogI2luY2x1ZGUgPGxpbnV4L2tlcm5lbC5oPgogI2luY2x1ZGUgPGxp
bnV4L3dhaXQuaD4KIAorI2luY2x1ZGUgInJjYXJfY21tLmgiCiAjaW5jbHVkZSAicmNhcl9kdV9j
cnRjLmgiCiAjaW5jbHVkZSAicmNhcl9kdV9ncm91cC5oIgogI2luY2x1ZGUgInJjYXJfZHVfdnNw
LmgiCkBAIC03MCw2ICs3MSw3IEBAIHN0cnVjdCByY2FyX2R1X2RldmljZV9pbmZvIHsKIAogI2Rl
ZmluZSBSQ0FSX0RVX01BWF9DUlRDUwkJNAogI2RlZmluZSBSQ0FSX0RVX01BWF9HUk9VUFMJCURJ
Vl9ST1VORF9VUChSQ0FSX0RVX01BWF9DUlRDUywgMikKKyNkZWZpbmUgUkNBUl9EVV9NQVhfQ01N
UwkJNAogI2RlZmluZSBSQ0FSX0RVX01BWF9WU1BTCQk0CiAKIHN0cnVjdCByY2FyX2R1X2Rldmlj
ZSB7CkBAIC04Niw2ICs4OCw3IEBAIHN0cnVjdCByY2FyX2R1X2RldmljZSB7CiAJc3RydWN0IHJj
YXJfZHVfZW5jb2RlciAqZW5jb2RlcnNbUkNBUl9EVV9PVVRQVVRfTUFYXTsKIAogCXN0cnVjdCBy
Y2FyX2R1X2dyb3VwIGdyb3Vwc1tSQ0FSX0RVX01BWF9HUk9VUFNdOworCXN0cnVjdCBwbGF0Zm9y
bV9kZXZpY2UgKmNtbXNbUkNBUl9EVV9NQVhfQ01NU107CiAJc3RydWN0IHJjYXJfZHVfdnNwIHZz
cHNbUkNBUl9EVV9NQVhfVlNQU107CiAKIAlzdHJ1Y3QgewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL3JjYXItZHUvcmNhcl9kdV9ncm91cC5oIGIvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUv
cmNhcl9kdV9ncm91cC5oCmluZGV4IDg3OTUwYzFmNmE1Mi4uYjBjMTQ2NjU5M2EzIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X2dyb3VwLmgKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9ncm91cC5oCkBAIC0yMiw2ICsyMiw3IEBAIHN0cnVj
dCByY2FyX2R1X2RldmljZTsKICAqIEBtbWlvX29mZnNldDogcmVnaXN0ZXJzIG9mZnNldCBpbiB0
aGUgZGV2aWNlIG1lbW9yeSBtYXAKICAqIEBpbmRleDogZ3JvdXAgaW5kZXgKICAqIEBjaGFubmVs
c19tYXNrOiBiaXRtYXNrIG9mIHBvcHVsYXRlZCBEVSBjaGFubmVscyBpbiB0aGlzIGdyb3VwCisg
KiBAY21tc19tYXNrOiBiaXRtYXNrIG9mIGVuYWJsZWQgQ01NcyBpbiB0aGlzIGdyb3VwCiAgKiBA
bnVtX2NydGNzOiBudW1iZXIgb2YgQ1JUQ3MgaW4gdGhpcyBncm91cCAoMSBvciAyKQogICogQHVz
ZV9jb3VudDogbnVtYmVyIG9mIHVzZXJzIG9mIHRoZSBncm91cCAocmNhcl9kdV9ncm91cF8oZ2V0
fHB1dCkpCiAgKiBAdXNlZF9jcnRjczogbnVtYmVyIG9mIENSVENzIGN1cnJlbnRseSBpbiB1c2UK
QEAgLTM3LDYgKzM4LDcgQEAgc3RydWN0IHJjYXJfZHVfZ3JvdXAgewogCXVuc2lnbmVkIGludCBp
bmRleDsKIAogCXVuc2lnbmVkIGludCBjaGFubmVsc19tYXNrOworCXVuc2lnbmVkIGludCBjbW1z
X21hc2s7CiAJdW5zaWduZWQgaW50IG51bV9jcnRjczsKIAl1bnNpZ25lZCBpbnQgdXNlX2NvdW50
OwogCXVuc2lnbmVkIGludCB1c2VkX2NydGNzOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L3JjYXItZHUvcmNhcl9kdV9rbXMuYyBiL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVf
a21zLmMKaW5kZXggZjhmN2ZmZjM0ZGZmLi5iNzljZGEyZjU1MzEgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfa21zLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3Jj
YXItZHUvcmNhcl9kdV9rbXMuYwpAQCAtMTgsNiArMTgsNyBAQAogI2luY2x1ZGUgPGRybS9kcm1f
dmJsYW5rLmg+CiAKICNpbmNsdWRlIDxsaW51eC9vZl9ncmFwaC5oPgorI2luY2x1ZGUgPGxpbnV4
L29mX3BsYXRmb3JtLmg+CiAjaW5jbHVkZSA8bGludXgvd2FpdC5oPgogCiAjaW5jbHVkZSAicmNh
cl9kdV9jcnRjLmgiCkBAIC01MzQsNiArNTM1LDUxIEBAIHN0YXRpYyBpbnQgcmNhcl9kdV92c3Bz
X2luaXQoc3RydWN0IHJjYXJfZHVfZGV2aWNlICpyY2R1KQogCXJldHVybiByZXQ7CiB9CiAKK3N0
YXRpYyBpbnQgcmNhcl9kdV9jbW1faW5pdChzdHJ1Y3QgcmNhcl9kdV9kZXZpY2UgKnJjZHUpCit7
CisJY29uc3Qgc3RydWN0IGRldmljZV9ub2RlICpucCA9IHJjZHUtPmRldi0+b2Zfbm9kZTsKKwl1
bnNpZ25lZCBpbnQgaTsKKwlpbnQgY2VsbHM7CisKKwljZWxscyA9IG9mX3Byb3BlcnR5X2NvdW50
X3UzMl9lbGVtcyhucCwgImNtbXMiKTsKKwlpZiAoY2VsbHMgPT0gLUVJTlZBTCkKKwkJcmV0dXJu
IDA7CisKKwlpZiAoY2VsbHMgPiBSQ0FSX0RVX01BWF9DTU1TIHx8IGNlbGxzID4gcmNkdS0+bnVt
X2NydGNzKSB7CisJCWRldl9lcnIocmNkdS0+ZGV2LCAiSW52YWxpZCAnY21tcycgcHJvcGVydHkg
Zm9ybWF0XG4iKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJZm9yIChpID0gMDsgaSA8IGNl
bGxzOyArK2kpIHsKKwkJc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldjsKKwkJc3RydWN0IGRl
dmljZV9ub2RlICpjbW07CisKKwkJY21tID0gb2ZfcGFyc2VfcGhhbmRsZShucCwgImNtbXMiLCBp
KTsKKwkJaWYgKElTX0VSUihjbW0pKSB7CisJCQlkZXZfZXJyKHJjZHUtPmRldiwgIkZhaWxlZCB0
byBwYXJzZSAnY21tcycgcHJvcGVydHlcbiIpOworCQkJcmV0dXJuIFBUUl9FUlIoY21tKTsKKwkJ
fQorCisJCXBkZXYgPSBvZl9maW5kX2RldmljZV9ieV9ub2RlKGNtbSk7CisJCWlmIChJU19FUlIo
cGRldikpIHsKKwkJCWRldl9lcnIocmNkdS0+ZGV2LCAiTm8gZGV2aWNlIGZvdW5kIGZvciBjbW1z
WyV1XVxuIiwgaSk7CisJCQlvZl9ub2RlX3B1dChjbW0pOworCQkJcmV0dXJuIFBUUl9FUlIocGRl
dik7CisJCX0KKworCQlpZiAoIW9mX2RldmljZV9pc19hdmFpbGFibGUoY21tKSkgeworCQkJLyog
SXQncyBmaW5lIHRvIGhhdmUgYSBwaGFuZGxlIHRvIGEgbm9uLWVuYWJsZWQgQ01NLiAqLworCQkJ
b2Zfbm9kZV9wdXQoY21tKTsKKwkJCWNvbnRpbnVlOworCQl9CisKKwkJb2Zfbm9kZV9wdXQoY21t
KTsKKwkJcmNkdS0+Y21tc1tpXSA9IHBkZXY7CisJfQorCisJcmV0dXJuIDA7Cit9CisKIGludCBy
Y2FyX2R1X21vZGVzZXRfaW5pdChzdHJ1Y3QgcmNhcl9kdV9kZXZpY2UgKnJjZHUpCiB7CiAJc3Rh
dGljIGNvbnN0IHVuc2lnbmVkIGludCBtbWlvX29mZnNldHNbXSA9IHsKQEAgLTYyNCw2ICs2NzAs
MTAgQEAgaW50IHJjYXJfZHVfbW9kZXNldF9pbml0KHN0cnVjdCByY2FyX2R1X2RldmljZSAqcmNk
dSkKIAkJCXJldHVybiByZXQ7CiAJfQogCisJLyogSW5pdGlhbGl6ZSB0aGUgQ29sb3IgTWFuYWdl
bWVudCBNb2R1bGVzLiAqLworCWlmIChyY2FyX2R1X2NtbV9pbml0KHJjZHUpKQorCQlyZXR1cm4g
cmV0OworCiAJLyogQ3JlYXRlIHRoZSBDUlRDcy4gKi8KIAlmb3IgKHN3aW5kZXggPSAwLCBod2lu
ZGV4ID0gMDsgc3dpbmRleCA8IHJjZHUtPm51bV9jcnRjczsgKytod2luZGV4KSB7CiAJCXN0cnVj
dCByY2FyX2R1X2dyb3VwICpyZ3JwOwotLSAKMi4yMS4wCgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZl
bEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFp
bG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
