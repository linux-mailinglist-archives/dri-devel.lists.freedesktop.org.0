Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 2C08EB28E2
	for <lists+dri-devel@lfdr.de>; Sat, 14 Sep 2019 01:29:10 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 94B046F4AB;
	Fri, 13 Sep 2019 23:29:04 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mga07.intel.com (mga07.intel.com [134.134.136.100])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 690CB6F4AB;
 Fri, 13 Sep 2019 23:29:03 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga008.jf.intel.com ([10.7.209.65])
 by orsmga105.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 13 Sep 2019 16:29:02 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,492,1559545200"; d="scan'208";a="179832442"
Received: from josouza-mobl.jf.intel.com (HELO josouza-MOBL.intel.com)
 ([10.24.9.135])
 by orsmga008.jf.intel.com with ESMTP; 13 Sep 2019 16:29:02 -0700
From: =?UTF-8?q?Jos=C3=A9=20Roberto=20de=20Souza?= <jose.souza@intel.com>
To: intel-gfx@lists.freedesktop.org,
	dri-devel@lists.freedesktop.org
Subject: [PATCH CI 2/2] drm/connector: Allow max possible encoders to attach
 to a connector
Date: Fri, 13 Sep 2019 16:28:57 -0700
Message-Id: <20190913232857.389834-2-jose.souza@intel.com>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190913232857.389834-1-jose.souza@intel.com>
References: <20190913232857.389834-1-jose.souza@intel.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: nouveau@lists.freedesktop.org,
 =?UTF-8?q?Jos=C3=A9=20Roberto=20de=20Souza?= <jose.souza@intel.com>,
 amd-gfx@lists.freedesktop.org, Alex Deucher <alexander.deucher@amd.com>,
 Dhinakaran Pandiyan <dhinakaran.pandiyan@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

Q3VycmVudGx5IHdlIHJlc3RyaWN0IHRoZSBudW1iZXIgb2YgZW5jb2RlcnMgdGhhdCBjYW4gYmUg
bGlua2VkIHRvCmEgY29ubmVjdG9yIHRvIDMsIGluY3JlYXNlIGl0IHRvIG1hdGNoIHRoZSBtYXhp
bXVtIG51bWJlciBvZiBlbmNvZGVycwp0aGF0IGNhbiBiZSBpbml0aWFsaXplZCgzMikuCgpUbyBt
b3JlIGVmZmllbnRseSBkbyB0aGF0IGxldHMgc3dpdGNoIGZyb20gYW4gYXJyYXkgb2YgZW5jb2Rl
ciBpZHMgdG8KYml0bWFzay4KCnYyOiBGaXhpbmcgbWlzc2VkIHJldHVybiBvbiBhbWRncHVfZG1f
Y29ubmVjdG9yX3RvX2VuY29kZXIoKQoKU3VnZ2VzdGVkLWJ5OiBWaWxsZSBTeXJqw6Rsw6QgPHZp
bGxlLnN5cmphbGFAbGludXguaW50ZWwuY29tPgpDYzogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5z
eXJqYWxhQGxpbnV4LmludGVsLmNvbT4KQ2M6IEFsZXggRGV1Y2hlciA8YWxleGFuZGVyLmRldWNo
ZXJAYW1kLmNvbT4KQ2M6IGRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKQ2M6IGludGVs
LWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKQ2M6IG5vdXZlYXVAbGlzdHMuZnJlZWRlc2t0b3Au
b3JnCkNjOiBhbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpSZXZpZXdlZC1ieTogVmlsbGUg
U3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KU2lnbmVkLW9mZi1ieTog
RGhpbmFrYXJhbiBQYW5kaXlhbiA8ZGhpbmFrYXJhbi5wYW5kaXlhbkBpbnRlbC5jb20+ClNpZ25l
ZC1vZmYtYnk6IEpvc8OpIFJvYmVydG8gZGUgU291emEgPGpvc2Uuc291emFAaW50ZWwuY29tPgot
LS0KIC4uLi9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Nvbm5lY3RvcnMuYyAgICB8IDIzICsr
KysrLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9kY2VfdmlydHVhbC5jICAg
ICAgfCAgNSArKy0KIC4uLi9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG0u
YyB8ICA4ICsrKystCiBkcml2ZXJzL2dwdS9kcm0vZHJtX2NsaWVudF9tb2Rlc2V0LmMgICAgICAg
ICAgfCAgMyArLQogZHJpdmVycy9ncHUvZHJtL2RybV9jb25uZWN0b3IuYyAgICAgICAgICAgICAg
IHwgMzEgKysrKystLS0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2RybV9jcnRjX2hlbHBl
ci5jICAgICAgICAgICAgIHwgIDkgKysrKy0tCiBkcml2ZXJzL2dwdS9kcm0vZHJtX3Byb2JlX2hl
bHBlci5jICAgICAgICAgICAgfCAgMyArLQogZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvZGlzcG52
MDQvZGlzcC5jICAgICAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L2Rpc3BudjUw
L2Rpc3AuYyAgICAgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2Nv
bm5lY3Rvci5jICAgfCAgNyArKy0tLQogZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fY29u
bmVjdG9ycy5jICAgIHwgMjcgKysrKysrLS0tLS0tLS0tLQogaW5jbHVkZS9kcm0vZHJtX2Nvbm5l
Y3Rvci5oICAgICAgICAgICAgICAgICAgIHwgMTggKysrKystLS0tLS0KIDEyIGZpbGVzIGNoYW5n
ZWQsIDU1IGluc2VydGlvbnMoKyksIDgzIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9jb25uZWN0b3JzLmMgYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfY29ubmVjdG9ycy5jCmluZGV4IGVjZTU1YzhmYTY3My4uZDg3
MjkyODVmNzMxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
Y29ubmVjdG9ycy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9jb25u
ZWN0b3JzLmMKQEAgLTIxNywxMSArMjE3LDEwIEBAIGFtZGdwdV9jb25uZWN0b3JfdXBkYXRlX3Nj
cmF0Y2hfcmVncyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAogCXN0cnVjdCBkcm1f
ZW5jb2RlciAqZW5jb2RlcjsKIAljb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9oZWxwZXJfZnVu
Y3MgKmNvbm5lY3Rvcl9mdW5jcyA9IGNvbm5lY3Rvci0+aGVscGVyX3ByaXZhdGU7CiAJYm9vbCBj
b25uZWN0ZWQ7Ci0JaW50IGk7CiAKIAliZXN0X2VuY29kZXIgPSBjb25uZWN0b3JfZnVuY3MtPmJl
c3RfZW5jb2Rlcihjb25uZWN0b3IpOwogCi0JZHJtX2Nvbm5lY3Rvcl9mb3JfZWFjaF9wb3NzaWJs
ZV9lbmNvZGVyKGNvbm5lY3RvciwgZW5jb2RlciwgaSkgeworCWRybV9jb25uZWN0b3JfZm9yX2Vh
Y2hfcG9zc2libGVfZW5jb2Rlcihjb25uZWN0b3IsIGVuY29kZXIpIHsKIAkJaWYgKChlbmNvZGVy
ID09IGJlc3RfZW5jb2RlcikgJiYgKHN0YXR1cyA9PSBjb25uZWN0b3Jfc3RhdHVzX2Nvbm5lY3Rl
ZCkpCiAJCQljb25uZWN0ZWQgPSB0cnVlOwogCQllbHNlCkBAIC0yMzYsOSArMjM1LDggQEAgYW1k
Z3B1X2Nvbm5lY3Rvcl9maW5kX2VuY29kZXIoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3Rv
ciwKIAkJCSAgICAgICBpbnQgZW5jb2Rlcl90eXBlKQogewogCXN0cnVjdCBkcm1fZW5jb2RlciAq
ZW5jb2RlcjsKLQlpbnQgaTsKIAotCWRybV9jb25uZWN0b3JfZm9yX2VhY2hfcG9zc2libGVfZW5j
b2Rlcihjb25uZWN0b3IsIGVuY29kZXIsIGkpIHsKKwlkcm1fY29ubmVjdG9yX2Zvcl9lYWNoX3Bv
c3NpYmxlX2VuY29kZXIoY29ubmVjdG9yLCBlbmNvZGVyKSB7CiAJCWlmIChlbmNvZGVyLT5lbmNv
ZGVyX3R5cGUgPT0gZW5jb2Rlcl90eXBlKQogCQkJcmV0dXJuIGVuY29kZXI7CiAJfQpAQCAtMzQ3
LDEwICszNDUsOSBAQCBzdGF0aWMgc3RydWN0IGRybV9lbmNvZGVyICoKIGFtZGdwdV9jb25uZWN0
b3JfYmVzdF9zaW5nbGVfZW5jb2RlcihzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQog
ewogCXN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcjsKLQlpbnQgaTsKIAogCS8qIHBpY2sgdGhl
IGZpcnN0IG9uZSAqLwotCWRybV9jb25uZWN0b3JfZm9yX2VhY2hfcG9zc2libGVfZW5jb2Rlcihj
b25uZWN0b3IsIGVuY29kZXIsIGkpCisJZHJtX2Nvbm5lY3Rvcl9mb3JfZWFjaF9wb3NzaWJsZV9l
bmNvZGVyKGNvbm5lY3RvciwgZW5jb2RlcikKIAkJcmV0dXJuIGVuY29kZXI7CiAKIAlyZXR1cm4g
TlVMTDsKQEAgLTEwNjUsOSArMTA2Miw4IEBAIGFtZGdwdV9jb25uZWN0b3JfZHZpX2RldGVjdChz
dHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBib29sIGZvcmNlKQogCS8qIGZpbmQgYW5h
bG9nIGVuY29kZXIgKi8KIAlpZiAoYW1kZ3B1X2Nvbm5lY3Rvci0+ZGFjX2xvYWRfZGV0ZWN0KSB7
CiAJCXN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcjsKLQkJaW50IGk7CiAKLQkJZHJtX2Nvbm5l
Y3Rvcl9mb3JfZWFjaF9wb3NzaWJsZV9lbmNvZGVyKGNvbm5lY3RvciwgZW5jb2RlciwgaSkgewor
CQlkcm1fY29ubmVjdG9yX2Zvcl9lYWNoX3Bvc3NpYmxlX2VuY29kZXIoY29ubmVjdG9yLCBlbmNv
ZGVyKSB7CiAJCQlpZiAoZW5jb2Rlci0+ZW5jb2Rlcl90eXBlICE9IERSTV9NT0RFX0VOQ09ERVJf
REFDICYmCiAJCQkgICAgZW5jb2Rlci0+ZW5jb2Rlcl90eXBlICE9IERSTV9NT0RFX0VOQ09ERVJf
VFZEQUMpCiAJCQkJY29udGludWU7CkBAIC0xMTE3LDkgKzExMTMsOCBAQCBhbWRncHVfY29ubmVj
dG9yX2R2aV9lbmNvZGVyKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCiB7CiAJc3Ry
dWN0IGFtZGdwdV9jb25uZWN0b3IgKmFtZGdwdV9jb25uZWN0b3IgPSB0b19hbWRncHVfY29ubmVj
dG9yKGNvbm5lY3Rvcik7CiAJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyOwotCWludCBpOwog
Ci0JZHJtX2Nvbm5lY3Rvcl9mb3JfZWFjaF9wb3NzaWJsZV9lbmNvZGVyKGNvbm5lY3RvciwgZW5j
b2RlciwgaSkgeworCWRybV9jb25uZWN0b3JfZm9yX2VhY2hfcG9zc2libGVfZW5jb2Rlcihjb25u
ZWN0b3IsIGVuY29kZXIpIHsKIAkJaWYgKGFtZGdwdV9jb25uZWN0b3ItPnVzZV9kaWdpdGFsID09
IHRydWUpIHsKIAkJCWlmIChlbmNvZGVyLT5lbmNvZGVyX3R5cGUgPT0gRFJNX01PREVfRU5DT0RF
Ul9UTURTKQogCQkJCXJldHVybiBlbmNvZGVyOwpAQCAtMTEzNCw3ICsxMTI5LDcgQEAgYW1kZ3B1
X2Nvbm5lY3Rvcl9kdmlfZW5jb2RlcihzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQog
CiAJLyogdGhlbiBjaGVjayB1c2UgZGlnaXRpYWwgKi8KIAkvKiBwaWNrIHRoZSBmaXJzdCBvbmUg
Ki8KLQlkcm1fY29ubmVjdG9yX2Zvcl9lYWNoX3Bvc3NpYmxlX2VuY29kZXIoY29ubmVjdG9yLCBl
bmNvZGVyLCBpKQorCWRybV9jb25uZWN0b3JfZm9yX2VhY2hfcG9zc2libGVfZW5jb2Rlcihjb25u
ZWN0b3IsIGVuY29kZXIpCiAJCXJldHVybiBlbmNvZGVyOwogCiAJcmV0dXJuIE5VTEw7CkBAIC0x
MjcxLDkgKzEyNjYsOCBAQCB1MTYgYW1kZ3B1X2Nvbm5lY3Rvcl9lbmNvZGVyX2dldF9kcF9icmlk
Z2VfZW5jb2Rlcl9pZChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubgogewogCXN0cnVjdCBkcm1f
ZW5jb2RlciAqZW5jb2RlcjsKIAlzdHJ1Y3QgYW1kZ3B1X2VuY29kZXIgKmFtZGdwdV9lbmNvZGVy
OwotCWludCBpOwogCi0JZHJtX2Nvbm5lY3Rvcl9mb3JfZWFjaF9wb3NzaWJsZV9lbmNvZGVyKGNv
bm5lY3RvciwgZW5jb2RlciwgaSkgeworCWRybV9jb25uZWN0b3JfZm9yX2VhY2hfcG9zc2libGVf
ZW5jb2Rlcihjb25uZWN0b3IsIGVuY29kZXIpIHsKIAkJYW1kZ3B1X2VuY29kZXIgPSB0b19hbWRn
cHVfZW5jb2RlcihlbmNvZGVyKTsKIAogCQlzd2l0Y2ggKGFtZGdwdV9lbmNvZGVyLT5lbmNvZGVy
X2lkKSB7CkBAIC0xMjkyLDEwICsxMjg2LDkgQEAgc3RhdGljIGJvb2wgYW1kZ3B1X2Nvbm5lY3Rv
cl9lbmNvZGVyX2lzX2hicjIoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKIHsKIAlz
dHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXI7CiAJc3RydWN0IGFtZGdwdV9lbmNvZGVyICphbWRn
cHVfZW5jb2RlcjsKLQlpbnQgaTsKIAlib29sIGZvdW5kID0gZmFsc2U7CiAKLQlkcm1fY29ubmVj
dG9yX2Zvcl9lYWNoX3Bvc3NpYmxlX2VuY29kZXIoY29ubmVjdG9yLCBlbmNvZGVyLCBpKSB7CisJ
ZHJtX2Nvbm5lY3Rvcl9mb3JfZWFjaF9wb3NzaWJsZV9lbmNvZGVyKGNvbm5lY3RvciwgZW5jb2Rl
cikgewogCQlhbWRncHVfZW5jb2RlciA9IHRvX2FtZGdwdV9lbmNvZGVyKGVuY29kZXIpOwogCQlp
ZiAoYW1kZ3B1X2VuY29kZXItPmNhcHMgJiBBVE9NX0VOQ09ERVJfQ0FQX1JFQ09SRF9IQlIyKQog
CQkJZm91bmQgPSB0cnVlOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
ZGNlX3ZpcnR1YWwuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2RjZV92aXJ0dWFsLmMK
aW5kZXggYzk2MDhhZTg2NDNiLi5lNGY5NDg2MzMzMmMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2RjZV92aXJ0dWFsLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvZGNlX3ZpcnR1YWwuYwpAQCAtMjYwLDE1ICsyNjAsMTQgQEAgc3RhdGljIHN0cnVjdCBk
cm1fZW5jb2RlciAqCiBkY2VfdmlydHVhbF9lbmNvZGVyKHN0cnVjdCBkcm1fY29ubmVjdG9yICpj
b25uZWN0b3IpCiB7CiAJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyOwotCWludCBpOwogCi0J
ZHJtX2Nvbm5lY3Rvcl9mb3JfZWFjaF9wb3NzaWJsZV9lbmNvZGVyKGNvbm5lY3RvciwgZW5jb2Rl
ciwgaSkgeworCWRybV9jb25uZWN0b3JfZm9yX2VhY2hfcG9zc2libGVfZW5jb2Rlcihjb25uZWN0
b3IsIGVuY29kZXIpIHsKIAkJaWYgKGVuY29kZXItPmVuY29kZXJfdHlwZSA9PSBEUk1fTU9ERV9F
TkNPREVSX1ZJUlRVQUwpCiAJCQlyZXR1cm4gZW5jb2RlcjsKIAl9CiAKIAkvKiBwaWNrIHRoZSBm
aXJzdCBvbmUgKi8KLQlkcm1fY29ubmVjdG9yX2Zvcl9lYWNoX3Bvc3NpYmxlX2VuY29kZXIoY29u
bmVjdG9yLCBlbmNvZGVyLCBpKQorCWRybV9jb25uZWN0b3JfZm9yX2VhY2hfcG9zc2libGVfZW5j
b2Rlcihjb25uZWN0b3IsIGVuY29kZXIpCiAJCXJldHVybiBlbmNvZGVyOwogCiAJcmV0dXJuIE5V
TEw7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2Ft
ZGdwdV9kbS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVf
ZG0uYwppbmRleCBlMWIwOWJiNDMyYmQuLjg2MGMyOWM0ODljMiAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG0uYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbS5jCkBAIC00ODM2LDcgKzQ4
MzYsMTMgQEAgc3RhdGljIGludCB0b19kcm1fY29ubmVjdG9yX3R5cGUoZW51bSBzaWduYWxfdHlw
ZSBzdCkKIAogc3RhdGljIHN0cnVjdCBkcm1fZW5jb2RlciAqYW1kZ3B1X2RtX2Nvbm5lY3Rvcl90
b19lbmNvZGVyKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCiB7Ci0JcmV0dXJuIGRy
bV9lbmNvZGVyX2ZpbmQoY29ubmVjdG9yLT5kZXYsIE5VTEwsIGNvbm5lY3Rvci0+ZW5jb2Rlcl9p
ZHNbMF0pOworCXN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcjsKKworCS8qIFRoZXJlIGlzIG9u
bHkgb25lIGVuY29kZXIgcGVyIGNvbm5lY3RvciAqLworCWRybV9jb25uZWN0b3JfZm9yX2VhY2hf
cG9zc2libGVfZW5jb2Rlcihjb25uZWN0b3IsIGVuY29kZXIpCisJCXJldHVybiBlbmNvZGVyOwor
CisJcmV0dXJuIE5VTEw7CiB9CiAKIHN0YXRpYyB2b2lkIGFtZGdwdV9kbV9nZXRfbmF0aXZlX21v
ZGUoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9kcm1fY2xpZW50X21vZGVzZXQuYyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fY2xpZW50
X21vZGVzZXQuYwppbmRleCBjODkyMmI3Y2FjMDkuLjg5NWI3M2YyMzA3OSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2RybV9jbGllbnRfbW9kZXNldC5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9kcm1fY2xpZW50X21vZGVzZXQuYwpAQCAtNDE1LDkgKzQxNSw4IEBAIHN0YXRpYyBib29sIGNv
bm5lY3Rvcl9oYXNfcG9zc2libGVfY3J0YyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9y
LAogCQkJCQlzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCiB7CiAJc3RydWN0IGRybV9lbmNvZGVyICpl
bmNvZGVyOwotCWludCBpOwogCi0JZHJtX2Nvbm5lY3Rvcl9mb3JfZWFjaF9wb3NzaWJsZV9lbmNv
ZGVyKGNvbm5lY3RvciwgZW5jb2RlciwgaSkgeworCWRybV9jb25uZWN0b3JfZm9yX2VhY2hfcG9z
c2libGVfZW5jb2Rlcihjb25uZWN0b3IsIGVuY29kZXIpIHsKIAkJaWYgKGVuY29kZXItPnBvc3Np
YmxlX2NydGNzICYgZHJtX2NydGNfbWFzayhjcnRjKSkKIAkJCXJldHVybiB0cnVlOwogCX0KZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9kcm1fY29ubmVjdG9yLmMgYi9kcml2ZXJzL2dwdS9k
cm0vZHJtX2Nvbm5lY3Rvci5jCmluZGV4IDRjNzY2NjI0YjIwZC4uNDM4OTZjNzExYjUwIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2Nvbm5lY3Rvci5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9kcm1fY29ubmVjdG9yLmMKQEAgLTM2NSw4ICszNjUsNiBAQCBFWFBPUlRfU1lNQk9MKGRy
bV9jb25uZWN0b3JfYXR0YWNoX2VkaWRfcHJvcGVydHkpOwogaW50IGRybV9jb25uZWN0b3JfYXR0
YWNoX2VuY29kZXIoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKIAkJCQkgc3RydWN0
IGRybV9lbmNvZGVyICplbmNvZGVyKQogewotCWludCBpOwotCiAJLyoKIAkgKiBJbiB0aGUgcGFz
dCwgZHJpdmVycyBoYXZlIGF0dGVtcHRlZCB0byBtb2RlbCB0aGUgc3RhdGljIGFzc29jaWF0aW9u
CiAJICogb2YgY29ubmVjdG9yIHRvIGVuY29kZXIgaW4gc2ltcGxlIGNvbm5lY3Rvci9lbmNvZGVy
IGRldmljZXMgdXNpbmcgYQpAQCAtMzgxLDE4ICszNzksMTUgQEAgaW50IGRybV9jb25uZWN0b3Jf
YXR0YWNoX2VuY29kZXIoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKIAlpZiAoV0FS
Tl9PTihjb25uZWN0b3ItPmVuY29kZXIpKQogCQlyZXR1cm4gLUVJTlZBTDsKIAotCWZvciAoaSA9
IDA7IGkgPCBBUlJBWV9TSVpFKGNvbm5lY3Rvci0+ZW5jb2Rlcl9pZHMpOyBpKyspIHsKLQkJaWYg
KGNvbm5lY3Rvci0+ZW5jb2Rlcl9pZHNbaV0gPT0gMCkgewotCQkJY29ubmVjdG9yLT5lbmNvZGVy
X2lkc1tpXSA9IGVuY29kZXItPmJhc2UuaWQ7Ci0JCQlyZXR1cm4gMDsKLQkJfQotCX0KLQlyZXR1
cm4gLUVOT01FTTsKKwljb25uZWN0b3ItPnBvc3NpYmxlX2VuY29kZXJzIHw9IGRybV9lbmNvZGVy
X21hc2soZW5jb2Rlcik7CisKKwlyZXR1cm4gMDsKIH0KIEVYUE9SVF9TWU1CT0woZHJtX2Nvbm5l
Y3Rvcl9hdHRhY2hfZW5jb2Rlcik7CiAKIC8qKgotICogZHJtX2Nvbm5lY3Rvcl9oYXNfcG9zc2li
bGVfZW5jb2RlciAtIGNoZWNrIGlmIHRoZSBjb25uZWN0b3IgYW5kIGVuY29kZXIgYXJlIGFzc29z
aWNhdGVkIHdpdGggZWFjaCBvdGhlcgorICogZHJtX2Nvbm5lY3Rvcl9oYXNfcG9zc2libGVfZW5j
b2RlciAtIGNoZWNrIGlmIHRoZSBjb25uZWN0b3IgYW5kIGVuY29kZXIgYXJlCisgKiBhc3NvY2lh
dGVkIHdpdGggZWFjaCBvdGhlcgogICogQGNvbm5lY3RvcjogdGhlIGNvbm5lY3RvcgogICogQGVu
Y29kZXI6IHRoZSBlbmNvZGVyCiAgKgpAQCAtNDAyLDE1ICszOTcsNyBAQCBFWFBPUlRfU1lNQk9M
KGRybV9jb25uZWN0b3JfYXR0YWNoX2VuY29kZXIpOwogYm9vbCBkcm1fY29ubmVjdG9yX2hhc19w
b3NzaWJsZV9lbmNvZGVyKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCiAJCQkJCXN0
cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcikKIHsKLQlzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuYzsK
LQlpbnQgaTsKLQotCWRybV9jb25uZWN0b3JfZm9yX2VhY2hfcG9zc2libGVfZW5jb2Rlcihjb25u
ZWN0b3IsIGVuYywgaSkgewotCQlpZiAoZW5jID09IGVuY29kZXIpCi0JCQlyZXR1cm4gdHJ1ZTsK
LQl9Ci0KLQlyZXR1cm4gZmFsc2U7CisJcmV0dXJuIGNvbm5lY3Rvci0+cG9zc2libGVfZW5jb2Rl
cnMgJiBkcm1fZW5jb2Rlcl9tYXNrKGVuY29kZXIpOwogfQogRVhQT1JUX1NZTUJPTChkcm1fY29u
bmVjdG9yX2hhc19wb3NzaWJsZV9lbmNvZGVyKTsKIApAQCAtMjEyMSw3ICsyMTA4LDYgQEAgaW50
IGRybV9tb2RlX2dldGNvbm5lY3RvcihzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRh
LAogCWludCBlbmNvZGVyc19jb3VudCA9IDA7CiAJaW50IHJldCA9IDA7CiAJaW50IGNvcGllZCA9
IDA7Ci0JaW50IGk7CiAJc3RydWN0IGRybV9tb2RlX21vZGVpbmZvIHVfbW9kZTsKIAlzdHJ1Y3Qg
ZHJtX21vZGVfbW9kZWluZm8gX191c2VyICptb2RlX3B0cjsKIAl1aW50MzJfdCBfX3VzZXIgKmVu
Y29kZXJfcHRyOwpAQCAtMjEzNiwxNCArMjEyMiwxMyBAQCBpbnQgZHJtX21vZGVfZ2V0Y29ubmVj
dG9yKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAJaWYgKCFjb25uZWN0b3Ip
CiAJCXJldHVybiAtRU5PRU5UOwogCi0JZHJtX2Nvbm5lY3Rvcl9mb3JfZWFjaF9wb3NzaWJsZV9l
bmNvZGVyKGNvbm5lY3RvciwgZW5jb2RlciwgaSkKLQkJZW5jb2RlcnNfY291bnQrKzsKKwllbmNv
ZGVyc19jb3VudCA9IGh3ZWlnaHQzMihjb25uZWN0b3ItPnBvc3NpYmxlX2VuY29kZXJzKTsKIAog
CWlmICgob3V0X3Jlc3AtPmNvdW50X2VuY29kZXJzID49IGVuY29kZXJzX2NvdW50KSAmJiBlbmNv
ZGVyc19jb3VudCkgewogCQljb3BpZWQgPSAwOwogCQllbmNvZGVyX3B0ciA9ICh1aW50MzJfdCBf
X3VzZXIgKikodW5zaWduZWQgbG9uZykob3V0X3Jlc3AtPmVuY29kZXJzX3B0cik7CiAKLQkJZHJt
X2Nvbm5lY3Rvcl9mb3JfZWFjaF9wb3NzaWJsZV9lbmNvZGVyKGNvbm5lY3RvciwgZW5jb2Rlciwg
aSkgeworCQlkcm1fY29ubmVjdG9yX2Zvcl9lYWNoX3Bvc3NpYmxlX2VuY29kZXIoY29ubmVjdG9y
LCBlbmNvZGVyKSB7CiAJCQlpZiAocHV0X3VzZXIoZW5jb2Rlci0+YmFzZS5pZCwgZW5jb2Rlcl9w
dHIgKyBjb3BpZWQpKSB7CiAJCQkJcmV0ID0gLUVGQVVMVDsKIAkJCQlnb3RvIG91dDsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9kcm1fY3J0Y19oZWxwZXIuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9kcm1fY3J0Y19oZWxwZXIuYwppbmRleCA0YTc0NDdhNTNjZWEuLjQ5OWIwNWFhY2NmYyAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2RybV9jcnRjX2hlbHBlci5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9kcm1fY3J0Y19oZWxwZXIuYwpAQCAtNDY3LDggKzQ2NywxMyBAQCBkcm1fY3J0Y19o
ZWxwZXJfZGlzYWJsZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCiBzdHJ1Y3QgZHJtX2VuY29kZXIg
KgogZHJtX2Nvbm5lY3Rvcl9nZXRfc2luZ2xlX2VuY29kZXIoc3RydWN0IGRybV9jb25uZWN0b3Ig
KmNvbm5lY3RvcikKIHsKLQlXQVJOX09OKGNvbm5lY3Rvci0+ZW5jb2Rlcl9pZHNbMV0pOwotCXJl
dHVybiBkcm1fZW5jb2Rlcl9maW5kKGNvbm5lY3Rvci0+ZGV2LCBOVUxMLCBjb25uZWN0b3ItPmVu
Y29kZXJfaWRzWzBdKTsKKwlzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXI7CisKKwlXQVJOX09O
KGh3ZWlnaHQzMihjb25uZWN0b3ItPnBvc3NpYmxlX2VuY29kZXJzKSA+IDEpOworCWRybV9jb25u
ZWN0b3JfZm9yX2VhY2hfcG9zc2libGVfZW5jb2Rlcihjb25uZWN0b3IsIGVuY29kZXIpCisJCXJl
dHVybiBlbmNvZGVyOworCisJcmV0dXJuIE5VTEw7CiB9CiAKIC8qKgpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2RybV9wcm9iZV9oZWxwZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fcHJv
YmVfaGVscGVyLmMKaW5kZXggMzUxY2JjNDBmMGY4Li5hN2M4N2FiZTg4ZDAgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9kcm1fcHJvYmVfaGVscGVyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2RybV9wcm9iZV9oZWxwZXIuYwpAQCAtOTMsNyArOTMsNiBAQCBkcm1fbW9kZV92YWxpZGF0ZV9w
aXBlbGluZShzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSwKIAlzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2ID0gY29ubmVjdG9yLT5kZXY7CiAJZW51bSBkcm1fbW9kZV9zdGF0dXMgcmV0ID0gTU9E
RV9PSzsKIAlzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXI7Ci0JaW50IGk7CiAKIAkvKiBTdGVw
IDE6IFZhbGlkYXRlIGFnYWluc3QgY29ubmVjdG9yICovCiAJcmV0ID0gZHJtX2Nvbm5lY3Rvcl9t
b2RlX3ZhbGlkKGNvbm5lY3RvciwgbW9kZSk7CkBAIC0xMDEsNyArMTAwLDcgQEAgZHJtX21vZGVf
dmFsaWRhdGVfcGlwZWxpbmUoc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUsCiAJCXJldHVy
biByZXQ7CiAKIAkvKiBTdGVwIDI6IFZhbGlkYXRlIGFnYWluc3QgZW5jb2RlcnMgYW5kIGNydGNz
ICovCi0JZHJtX2Nvbm5lY3Rvcl9mb3JfZWFjaF9wb3NzaWJsZV9lbmNvZGVyKGNvbm5lY3Rvciwg
ZW5jb2RlciwgaSkgeworCWRybV9jb25uZWN0b3JfZm9yX2VhY2hfcG9zc2libGVfZW5jb2Rlcihj
b25uZWN0b3IsIGVuY29kZXIpIHsKIAkJc3RydWN0IGRybV9jcnRjICpjcnRjOwogCiAJCXJldCA9
IGRybV9lbmNvZGVyX21vZGVfdmFsaWQoZW5jb2RlciwgbW9kZSk7CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vbm91dmVhdS9kaXNwbnYwNC9kaXNwLmMgYi9kcml2ZXJzL2dwdS9kcm0vbm91
dmVhdS9kaXNwbnYwNC9kaXNwLmMKaW5kZXggZGM2NDg2M2I1ZmQ4Li40NGVlODJkMGM5YjYgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L2Rpc3BudjA0L2Rpc3AuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vbm91dmVhdS9kaXNwbnYwNC9kaXNwLmMKQEAgLTI1Niw3ICsyNTYsNyBA
QCBudjA0X2Rpc3BsYXlfY3JlYXRlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCiAKIAlsaXN0X2Zv
cl9lYWNoX2VudHJ5X3NhZmUoY29ubmVjdG9yLCBjdCwKIAkJCQkgJmRldi0+bW9kZV9jb25maWcu
Y29ubmVjdG9yX2xpc3QsIGhlYWQpIHsKLQkJaWYgKCFjb25uZWN0b3ItPmVuY29kZXJfaWRzWzBd
KSB7CisJCWlmICghY29ubmVjdG9yLT5wb3NzaWJsZV9lbmNvZGVycykgewogCQkJTlZfV0FSTihk
cm0sICIlcyBoYXMgbm8gZW5jb2RlcnMsIHJlbW92aW5nXG4iLAogCQkJCWNvbm5lY3Rvci0+bmFt
ZSk7CiAJCQljb25uZWN0b3ItPmZ1bmNzLT5kZXN0cm95KGNvbm5lY3Rvcik7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9kaXNwbnY1MC9kaXNwLmMgYi9kcml2ZXJzL2dwdS9k
cm0vbm91dmVhdS9kaXNwbnY1MC9kaXNwLmMKaW5kZXggMzA3NTg0MTA3ZDc3Li45OGM4NzE5NWQ3
MTEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L2Rpc3BudjUwL2Rpc3AuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9kaXNwbnY1MC9kaXNwLmMKQEAgLTIzOTEsNyAr
MjM5MSw3IEBAIG52NTBfZGlzcGxheV9jcmVhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRldikKIAog
CS8qIGN1bGwgYW55IGNvbm5lY3RvcnMgd2UgY3JlYXRlZCB0aGF0IGRvbid0IGhhdmUgYW4gZW5j
b2RlciAqLwogCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShjb25uZWN0b3IsIHRtcCwgJmRldi0+
bW9kZV9jb25maWcuY29ubmVjdG9yX2xpc3QsIGhlYWQpIHsKLQkJaWYgKGNvbm5lY3Rvci0+ZW5j
b2Rlcl9pZHNbMF0pCisJCWlmIChjb25uZWN0b3ItPnBvc3NpYmxlX2VuY29kZXJzKQogCQkJY29u
dGludWU7CiAKIAkJTlZfV0FSTihkcm0sICIlcyBoYXMgbm8gZW5jb2RlcnMsIHJlbW92aW5nXG4i
LApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9jb25uZWN0b3Iu
YyBiL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfY29ubmVjdG9yLmMKaW5kZXggNTY4
NzFkMzRlM2ZiLi4zYTVkYjE3YmM1YzcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2
ZWF1L25vdXZlYXVfY29ubmVjdG9yLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91
dmVhdV9jb25uZWN0b3IuYwpAQCAtMzY1LDkgKzM2NSw4IEBAIGZpbmRfZW5jb2RlcihzdHJ1Y3Qg
ZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBpbnQgdHlwZSkKIHsKIAlzdHJ1Y3Qgbm91dmVhdV9l
bmNvZGVyICpudl9lbmNvZGVyOwogCXN0cnVjdCBkcm1fZW5jb2RlciAqZW5jOwotCWludCBpOwog
Ci0JZHJtX2Nvbm5lY3Rvcl9mb3JfZWFjaF9wb3NzaWJsZV9lbmNvZGVyKGNvbm5lY3RvciwgZW5j
LCBpKSB7CisJZHJtX2Nvbm5lY3Rvcl9mb3JfZWFjaF9wb3NzaWJsZV9lbmNvZGVyKGNvbm5lY3Rv
ciwgZW5jKSB7CiAJCW52X2VuY29kZXIgPSBub3V2ZWF1X2VuY29kZXIoZW5jKTsKIAogCQlpZiAo
dHlwZSA9PSBEQ0JfT1VUUFVUX0FOWSB8fApAQCAtNDE0LDEwICs0MTMsMTAgQEAgbm91dmVhdV9j
b25uZWN0b3JfZGRjX2RldGVjdChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQogCXN0
cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjb25uZWN0b3ItPmRldjsKIAlzdHJ1Y3Qgbm91dmVhdV9l
bmNvZGVyICpudl9lbmNvZGVyID0gTlVMTCwgKmZvdW5kID0gTlVMTDsKIAlzdHJ1Y3QgZHJtX2Vu
Y29kZXIgKmVuY29kZXI7Ci0JaW50IGksIHJldDsKKwlpbnQgcmV0OwogCWJvb2wgc3dpdGNoZXJv
b19kZGMgPSBmYWxzZTsKIAotCWRybV9jb25uZWN0b3JfZm9yX2VhY2hfcG9zc2libGVfZW5jb2Rl
cihjb25uZWN0b3IsIGVuY29kZXIsIGkpIHsKKwlkcm1fY29ubmVjdG9yX2Zvcl9lYWNoX3Bvc3Np
YmxlX2VuY29kZXIoY29ubmVjdG9yLCBlbmNvZGVyKSB7CiAJCW52X2VuY29kZXIgPSBub3V2ZWF1
X2VuY29kZXIoZW5jb2Rlcik7CiAKIAkJc3dpdGNoIChudl9lbmNvZGVyLT5kY2ItPnR5cGUpIHsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX2Nvbm5lY3RvcnMuYyBi
L2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX2Nvbm5lY3RvcnMuYwppbmRleCBiNjg0Y2Q3
MTk2MTIuLmMwNzQyN2QzYzE5OSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9y
YWRlb25fY29ubmVjdG9ycy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX2Nv
bm5lY3RvcnMuYwpAQCAtMjQ5LDExICsyNDksMTAgQEAgcmFkZW9uX2Nvbm5lY3Rvcl91cGRhdGVf
c2NyYXRjaF9yZWdzKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsIGVudW0gZHJtX2MK
IAlzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXI7CiAJY29uc3Qgc3RydWN0IGRybV9jb25uZWN0
b3JfaGVscGVyX2Z1bmNzICpjb25uZWN0b3JfZnVuY3MgPSBjb25uZWN0b3ItPmhlbHBlcl9wcml2
YXRlOwogCWJvb2wgY29ubmVjdGVkOwotCWludCBpOwogCiAJYmVzdF9lbmNvZGVyID0gY29ubmVj
dG9yX2Z1bmNzLT5iZXN0X2VuY29kZXIoY29ubmVjdG9yKTsKIAotCWRybV9jb25uZWN0b3JfZm9y
X2VhY2hfcG9zc2libGVfZW5jb2Rlcihjb25uZWN0b3IsIGVuY29kZXIsIGkpIHsKKwlkcm1fY29u
bmVjdG9yX2Zvcl9lYWNoX3Bvc3NpYmxlX2VuY29kZXIoY29ubmVjdG9yLCBlbmNvZGVyKSB7CiAJ
CWlmICgoZW5jb2RlciA9PSBiZXN0X2VuY29kZXIpICYmIChzdGF0dXMgPT0gY29ubmVjdG9yX3N0
YXR1c19jb25uZWN0ZWQpKQogCQkJY29ubmVjdGVkID0gdHJ1ZTsKIAkJZWxzZQpAQCAtMjY5LDkg
KzI2OCw4IEBAIHJhZGVvbl9jb25uZWN0b3JfdXBkYXRlX3NjcmF0Y2hfcmVncyhzdHJ1Y3QgZHJt
X2Nvbm5lY3RvciAqY29ubmVjdG9yLCBlbnVtIGRybV9jCiBzdGF0aWMgc3RydWN0IGRybV9lbmNv
ZGVyICpyYWRlb25fZmluZF9lbmNvZGVyKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3Is
IGludCBlbmNvZGVyX3R5cGUpCiB7CiAJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyOwotCWlu
dCBpOwogCi0JZHJtX2Nvbm5lY3Rvcl9mb3JfZWFjaF9wb3NzaWJsZV9lbmNvZGVyKGNvbm5lY3Rv
ciwgZW5jb2RlciwgaSkgeworCWRybV9jb25uZWN0b3JfZm9yX2VhY2hfcG9zc2libGVfZW5jb2Rl
cihjb25uZWN0b3IsIGVuY29kZXIpIHsKIAkJaWYgKGVuY29kZXItPmVuY29kZXJfdHlwZSA9PSBl
bmNvZGVyX3R5cGUpCiAJCQlyZXR1cm4gZW5jb2RlcjsKIAl9CkBAIC0zODAsMTAgKzM3OCw5IEBA
IHN0YXRpYyBpbnQgcmFkZW9uX2RkY19nZXRfbW9kZXMoc3RydWN0IGRybV9jb25uZWN0b3IgKmNv
bm5lY3RvcikKIHN0YXRpYyBzdHJ1Y3QgZHJtX2VuY29kZXIgKnJhZGVvbl9iZXN0X3NpbmdsZV9l
bmNvZGVyKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCiB7CiAJc3RydWN0IGRybV9l
bmNvZGVyICplbmNvZGVyOwotCWludCBpOwogCiAJLyogcGljayB0aGUgZmlyc3Qgb25lICovCi0J
ZHJtX2Nvbm5lY3Rvcl9mb3JfZWFjaF9wb3NzaWJsZV9lbmNvZGVyKGNvbm5lY3RvciwgZW5jb2Rl
ciwgaSkKKwlkcm1fY29ubmVjdG9yX2Zvcl9lYWNoX3Bvc3NpYmxlX2VuY29kZXIoY29ubmVjdG9y
LCBlbmNvZGVyKQogCQlyZXR1cm4gZW5jb2RlcjsKIAogCXJldHVybiBOVUxMOwpAQCAtNDI4LDE0
ICs0MjUsMTMgQEAgcmFkZW9uX2Nvbm5lY3Rvcl9hbmFsb2dfZW5jb2Rlcl9jb25mbGljdF9zb2x2
ZShzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAogCiAJbGlzdF9mb3JfZWFjaF9lbnRy
eShjb25mbGljdCwgJmRldi0+bW9kZV9jb25maWcuY29ubmVjdG9yX2xpc3QsIGhlYWQpIHsKIAkJ
c3RydWN0IGRybV9lbmNvZGVyICplbmM7Ci0JCWludCBpOwogCiAJCWlmIChjb25mbGljdCA9PSBj
b25uZWN0b3IpCiAJCQljb250aW51ZTsKIAogCQlyYWRlb25fY29uZmxpY3QgPSB0b19yYWRlb25f
Y29ubmVjdG9yKGNvbmZsaWN0KTsKIAotCQlkcm1fY29ubmVjdG9yX2Zvcl9lYWNoX3Bvc3NpYmxl
X2VuY29kZXIoY29uZmxpY3QsIGVuYywgaSkgeworCQlkcm1fY29ubmVjdG9yX2Zvcl9lYWNoX3Bv
c3NpYmxlX2VuY29kZXIoY29uZmxpY3QsIGVuYykgewogCQkJLyogaWYgdGhlIElEcyBtYXRjaCAq
LwogCQkJaWYgKGVuYyA9PSBlbmNvZGVyKSB7CiAJCQkJaWYgKGNvbmZsaWN0LT5zdGF0dXMgIT0g
Y29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQpCkBAIC0xMzYzLDkgKzEzNTksNyBAQCByYWRlb25f
ZHZpX2RldGVjdChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBib29sIGZvcmNlKQog
CiAJLyogZmluZCBhbmFsb2cgZW5jb2RlciAqLwogCWlmIChyYWRlb25fY29ubmVjdG9yLT5kYWNf
bG9hZF9kZXRlY3QpIHsKLQkJaW50IGk7Ci0KLQkJZHJtX2Nvbm5lY3Rvcl9mb3JfZWFjaF9wb3Nz
aWJsZV9lbmNvZGVyKGNvbm5lY3RvciwgZW5jb2RlciwgaSkgeworCQlkcm1fY29ubmVjdG9yX2Zv
cl9lYWNoX3Bvc3NpYmxlX2VuY29kZXIoY29ubmVjdG9yLCBlbmNvZGVyKSB7CiAJCQlpZiAoZW5j
b2Rlci0+ZW5jb2Rlcl90eXBlICE9IERSTV9NT0RFX0VOQ09ERVJfREFDICYmCiAJCQkgICAgZW5j
b2Rlci0+ZW5jb2Rlcl90eXBlICE9IERSTV9NT0RFX0VOQ09ERVJfVFZEQUMpCiAJCQkJY29udGlu
dWU7CkBAIC0xNDQzLDkgKzE0MzcsOCBAQCBzdGF0aWMgc3RydWN0IGRybV9lbmNvZGVyICpyYWRl
b25fZHZpX2VuY29kZXIoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKIHsKIAlzdHJ1
Y3QgcmFkZW9uX2Nvbm5lY3RvciAqcmFkZW9uX2Nvbm5lY3RvciA9IHRvX3JhZGVvbl9jb25uZWN0
b3IoY29ubmVjdG9yKTsKIAlzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXI7Ci0JaW50IGk7CiAK
LQlkcm1fY29ubmVjdG9yX2Zvcl9lYWNoX3Bvc3NpYmxlX2VuY29kZXIoY29ubmVjdG9yLCBlbmNv
ZGVyLCBpKSB7CisJZHJtX2Nvbm5lY3Rvcl9mb3JfZWFjaF9wb3NzaWJsZV9lbmNvZGVyKGNvbm5l
Y3RvciwgZW5jb2RlcikgewogCQlpZiAocmFkZW9uX2Nvbm5lY3Rvci0+dXNlX2RpZ2l0YWwgPT0g
dHJ1ZSkgewogCQkJaWYgKGVuY29kZXItPmVuY29kZXJfdHlwZSA9PSBEUk1fTU9ERV9FTkNPREVS
X1RNRFMpCiAJCQkJcmV0dXJuIGVuY29kZXI7CkBAIC0xNDYwLDcgKzE0NTMsNyBAQCBzdGF0aWMg
c3RydWN0IGRybV9lbmNvZGVyICpyYWRlb25fZHZpX2VuY29kZXIoc3RydWN0IGRybV9jb25uZWN0
b3IgKmNvbm5lY3RvcikKIAogCS8qIHRoZW4gY2hlY2sgdXNlIGRpZ2l0aWFsICovCiAJLyogcGlj
ayB0aGUgZmlyc3Qgb25lICovCi0JZHJtX2Nvbm5lY3Rvcl9mb3JfZWFjaF9wb3NzaWJsZV9lbmNv
ZGVyKGNvbm5lY3RvciwgZW5jb2RlciwgaSkKKwlkcm1fY29ubmVjdG9yX2Zvcl9lYWNoX3Bvc3Np
YmxlX2VuY29kZXIoY29ubmVjdG9yLCBlbmNvZGVyKQogCQlyZXR1cm4gZW5jb2RlcjsKIAogCXJl
dHVybiBOVUxMOwpAQCAtMTYwMyw5ICsxNTk2LDggQEAgdTE2IHJhZGVvbl9jb25uZWN0b3JfZW5j
b2Rlcl9nZXRfZHBfYnJpZGdlX2VuY29kZXJfaWQoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm4K
IHsKIAlzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXI7CiAJc3RydWN0IHJhZGVvbl9lbmNvZGVy
ICpyYWRlb25fZW5jb2RlcjsKLQlpbnQgaTsKIAotCWRybV9jb25uZWN0b3JfZm9yX2VhY2hfcG9z
c2libGVfZW5jb2Rlcihjb25uZWN0b3IsIGVuY29kZXIsIGkpIHsKKwlkcm1fY29ubmVjdG9yX2Zv
cl9lYWNoX3Bvc3NpYmxlX2VuY29kZXIoY29ubmVjdG9yLCBlbmNvZGVyKSB7CiAJCXJhZGVvbl9l
bmNvZGVyID0gdG9fcmFkZW9uX2VuY29kZXIoZW5jb2Rlcik7CiAKIAkJc3dpdGNoIChyYWRlb25f
ZW5jb2Rlci0+ZW5jb2Rlcl9pZCkgewpAQCAtMTYyNCwxMCArMTYxNiw5IEBAIHN0YXRpYyBib29s
IHJhZGVvbl9jb25uZWN0b3JfZW5jb2Rlcl9pc19oYnIyKHN0cnVjdCBkcm1fY29ubmVjdG9yICpj
b25uZWN0b3IpCiB7CiAJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyOwogCXN0cnVjdCByYWRl
b25fZW5jb2RlciAqcmFkZW9uX2VuY29kZXI7Ci0JaW50IGk7CiAJYm9vbCBmb3VuZCA9IGZhbHNl
OwogCi0JZHJtX2Nvbm5lY3Rvcl9mb3JfZWFjaF9wb3NzaWJsZV9lbmNvZGVyKGNvbm5lY3Rvciwg
ZW5jb2RlciwgaSkgeworCWRybV9jb25uZWN0b3JfZm9yX2VhY2hfcG9zc2libGVfZW5jb2Rlcihj
b25uZWN0b3IsIGVuY29kZXIpIHsKIAkJcmFkZW9uX2VuY29kZXIgPSB0b19yYWRlb25fZW5jb2Rl
cihlbmNvZGVyKTsKIAkJaWYgKHJhZGVvbl9lbmNvZGVyLT5jYXBzICYgQVRPTV9FTkNPREVSX0NB
UF9SRUNPUkRfSEJSMikKIAkJCWZvdW5kID0gdHJ1ZTsKZGlmZiAtLWdpdCBhL2luY2x1ZGUvZHJt
L2RybV9jb25uZWN0b3IuaCBiL2luY2x1ZGUvZHJtL2RybV9jb25uZWN0b3IuaAppbmRleCA2ODFj
YjU5MGY5NTIuLmM2ZTk5M2U3OGRiZCAxMDA2NDQKLS0tIGEvaW5jbHVkZS9kcm0vZHJtX2Nvbm5l
Y3Rvci5oCisrKyBiL2luY2x1ZGUvZHJtL2RybV9jb25uZWN0b3IuaApAQCAtMTI4OCwxMiArMTI4
OCwxMiBAQCBzdHJ1Y3QgZHJtX2Nvbm5lY3RvciB7CiAJLyoqIEBvdmVycmlkZV9lZGlkOiBoYXMg
dGhlIEVESUQgYmVlbiBvdmVyd3JpdHRlbiB0aHJvdWdoIGRlYnVnZnMgZm9yIHRlc3Rpbmc/ICov
CiAJYm9vbCBvdmVycmlkZV9lZGlkOwogCi0jZGVmaW5lIERSTV9DT05ORUNUT1JfTUFYX0VOQ09E
RVIgMwogCS8qKgotCSAqIEBlbmNvZGVyX2lkczogVmFsaWQgZW5jb2RlcnMgZm9yIHRoaXMgY29u
bmVjdG9yLiBQbGVhc2Ugb25seSB1c2UKLQkgKiBkcm1fY29ubmVjdG9yX2Zvcl9lYWNoX3Bvc3Np
YmxlX2VuY29kZXIoKSB0byBlbnVtZXJhdGUgdGhlc2UuCisJICogQHBvc3NpYmxlX2VuY29kZXJz
OiBCaXQgbWFzayBvZiBlbmNvZGVycyB0aGF0IGNhbiBkcml2ZSB0aGlzCisJICogY29ubmVjdG9y
LCBkcm1fZW5jb2Rlcl9pbmRleCgpIGRldGVybWluZXMgdGhlIGluZGV4IGludG8gdGhlIGJpdGZp
ZWxkCisJICogYW5kIHRoZSBiaXRzIGFyZSBzZXQgd2l0aCBkcm1fY29ubmVjdG9yX2F0dGFjaF9l
bmNvZGVyKCkuCiAJICovCi0JdWludDMyX3QgZW5jb2Rlcl9pZHNbRFJNX0NPTk5FQ1RPUl9NQVhf
RU5DT0RFUl07CisJdTMyIHBvc3NpYmxlX2VuY29kZXJzOwogCiAJLyoqCiAJICogQGVuY29kZXI6
IEN1cnJlbnRseSBib3VuZCBlbmNvZGVyIGRyaXZpbmcgdGhpcyBjb25uZWN0b3IsIGlmIGFueS4K
QEAgLTE2MDgsMTMgKzE2MDgsOSBAQCBib29sIGRybV9jb25uZWN0b3JfaGFzX3Bvc3NpYmxlX2Vu
Y29kZXIoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKICAqIGRybV9jb25uZWN0b3Jf
Zm9yX2VhY2hfcG9zc2libGVfZW5jb2RlciAtIGl0ZXJhdGUgY29ubmVjdG9yJ3MgcG9zc2libGUg
ZW5jb2RlcnMKICAqIEBjb25uZWN0b3I6ICZzdHJ1Y3QgZHJtX2Nvbm5lY3RvciBwb2ludGVyCiAg
KiBAZW5jb2RlcjogJnN0cnVjdCBkcm1fZW5jb2RlciBwb2ludGVyIHVzZWQgYXMgY3Vyc29yCi0g
KiBAX19pOiBpbnQgaXRlcmF0aW9uIGN1cnNvciwgZm9yIG1hY3JvLWludGVybmFsIHVzZQogICov
Ci0jZGVmaW5lIGRybV9jb25uZWN0b3JfZm9yX2VhY2hfcG9zc2libGVfZW5jb2Rlcihjb25uZWN0
b3IsIGVuY29kZXIsIF9faSkgXAotCWZvciAoKF9faSkgPSAwOyAoX19pKSA8IEFSUkFZX1NJWkUo
KGNvbm5lY3RvciktPmVuY29kZXJfaWRzKSAmJiBcCi0JCSAgICAgKGNvbm5lY3RvciktPmVuY29k
ZXJfaWRzWyhfX2kpXSAhPSAwOyAoX19pKSsrKSBcCi0JCWZvcl9lYWNoX2lmKChlbmNvZGVyKSA9
IFwKLQkJCSAgICBkcm1fZW5jb2Rlcl9maW5kKChjb25uZWN0b3IpLT5kZXYsIE5VTEwsIFwKLQkJ
CQkJICAgICAoY29ubmVjdG9yKS0+ZW5jb2Rlcl9pZHNbKF9faSldKSkgXAorI2RlZmluZSBkcm1f
Y29ubmVjdG9yX2Zvcl9lYWNoX3Bvc3NpYmxlX2VuY29kZXIoY29ubmVjdG9yLCBlbmNvZGVyKSBc
CisJZHJtX2Zvcl9lYWNoX2VuY29kZXJfbWFzayhlbmNvZGVyLCAoY29ubmVjdG9yKS0+ZGV2LCBc
CisJCQkJICAoY29ubmVjdG9yKS0+cG9zc2libGVfZW5jb2RlcnMpCiAKICNlbmRpZgotLSAKMi4y
My4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmkt
ZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6
Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
