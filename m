Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 9E0EF5AB3F
	for <lists+dri-devel@lfdr.de>; Sat, 29 Jun 2019 15:02:14 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0564F6E9AB;
	Sat, 29 Jun 2019 13:02:11 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-lf1-x142.google.com (mail-lf1-x142.google.com
 [IPv6:2a00:1450:4864:20::142])
 by gabe.freedesktop.org (Postfix) with ESMTPS id CB7856E9AA
 for <dri-devel@lists.freedesktop.org>; Sat, 29 Jun 2019 13:02:05 +0000 (UTC)
Received: by mail-lf1-x142.google.com with SMTP id d11so5782014lfb.4
 for <dri-devel@lists.freedesktop.org>; Sat, 29 Jun 2019 06:02:05 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=2KRTAU6ehPX/xpH0HKMaZdgcL0pE06VvF+Cz0lSkdGM=;
 b=jrYuZ6n/gp4ekwQN622y70QdP8uz8yK9OiY1pskbNwIusjilXKxeWQ9gReP0LKdcuI
 KtoMEKjpDtGIQMmGo2hnqYUU55gxO8kqeBxaF3TTWkPgxlCQNnLJLuUai1wl6JWCe5Se
 b9DAq26OK1vudSnnKE+hwJeTGSd12MVHehFPnmKu5PZNRIpwxPk7XtoA1Te91X0FuCoE
 wxG1i841Nus4nmddWhf/Ak2JoRolQtaabfuFON34TesmEvTRiaqHEh7fH9oX9B8kf6e1
 TeBAzsbth2tWoca7PdSnSe0i6xPm++fFlr/V8qSonL2qzwZpDkURF2m2UN6/His37lD0
 eaKw==
X-Gm-Message-State: APjAAAW3ZYkOACBAcTKKDnUkpBxUkbzV6Y/QMyywmv8+T0f9isVpdGh4
 cCFMXzl1lVrxrFfDkL+HBYP6e5Hglh0lxg==
X-Google-Smtp-Source: APXvYqyisZIfrxWe3N5Szh1GWTfKSxX3a3LffxrfYVO394S3qG3CuHcrkb/6yrrtWRGEB7o6fAik4A==
X-Received: by 2002:a05:6512:30a:: with SMTP id
 t10mr7348435lfp.22.1561813323803; 
 Sat, 29 Jun 2019 06:02:03 -0700 (PDT)
Received: from localhost.localdomain
 (c-22cd225c.014-348-6c756e10.bbcust.telenor.se. [92.34.205.34])
 by smtp.gmail.com with ESMTPSA id v2sm1354500lfi.52.2019.06.29.06.02.02
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Sat, 29 Jun 2019 06:02:02 -0700 (PDT)
From: Linus Walleij <linus.walleij@linaro.org>
To: dri-devel@lists.freedesktop.org,
 Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
 Maxime Ripard <maxime.ripard@bootlin.com>, Sean Paul <sean@poorly.run>
Subject: [PATCH 5/7] drm/msm/hdmi: Convert to use GPIO descriptors
Date: Sat, 29 Jun 2019 14:59:31 +0200
Message-Id: <20190629125933.679-5-linus.walleij@linaro.org>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190629125933.679-1-linus.walleij@linaro.org>
References: <20190629125933.679-1-linus.walleij@linaro.org>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=linaro.org; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=2KRTAU6ehPX/xpH0HKMaZdgcL0pE06VvF+Cz0lSkdGM=;
 b=oIll79elm1tF0VCcLp+Ng7l/OtHRjW3+0tBcilR4GYUeAnu3R6/Tedhi0bc9XsRg6T
 +qRPVUxXAmDbf3sj21K2PQ3L7OjFaGPFZIMphP/X/UfJfX+2WL59aqU6pJOg2OssIe8x
 3piXFJldqvugqPHWGtZv/T1hV7YJQUruoE+3Pj5dJeN4Ae1/hZP6n0ZesOEa/5MS9Mzi
 qzOKI21XULgKL/ldq3TNUGorYUQ34j0w6zB94iDk/jKaqce80x2goGU/wAlbsamJwz+R
 28p9Mw/Ie9Bd2PrC0yCh1J/VeWnbNfZtT22ymuou/9SV2PvPo1k7TGBExHXNTzbRRVml
 txtg==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: linux-arm-msm@vger.kernel.org, freedreno@lists.freedesktop.org,
 linux-arm-kernel@lists.infradead.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBzd2l0Y2hlcyB0aGUgTVNNIEhETUkgY29kZSB0byB1c2UgR1BJTyBkZXNjcmlwdG9ycy4K
Tm9ybWFsbHkgd2Ugd291bGQgZmV0Y2ggdGhlIEdQSU9zIGZyb20gdGhlIGRldmljZSB3aXRoIHRo
ZQpmbGFncyBHUElPRF9JTiBvciBHUElPRF9PVVRfW0xPV3xISUdIXSB0byBzZXQgdXAgdGhlIGxp
bmVzCmltbWVkaWF0ZWx5LCBidXQgc2luY2UgdGhlIGNvZGUgc2VlbXMgZWFnZXIgdG8gYWN0aXZl
bHkKZHJpdmUgdGhlIGxpbmVzIGhpZ2gvbG93IHdoZW4gdHVybmluZyBIRE1JIG9uIGFuZCBvZmYs
IHdlCmp1c3QgZmV0Y2ggdGhlIEdQSU9zIGFzLWlzIGFuZCBrZWVwIHRoZSBjb2RlIGV4cGxpY2l0
bHkKZHJpdmluZyB0aGVtLgoKVGhlIG9sZCBjb2RlIHdvdWxkIHRyeSBsZWdhY3kgYmluZGluZ3Mg
KEdQSU9zIHdpdGhvdXQgYW55CiItZ3Bpb3MiIHN1ZmZpeCkgYnV0IHRoaXMgaGFzIGJlZW4gbW92
ZWQgdG8gdGhlIGdwaW9saWIKYXMgYSBxdWlyayBieSB0aGUgcHJldmlvdXMgcGF0Y2guCgpDYzog
Um9iIENsYXJrIDxyb2JkY2xhcmtAZ21haWwuY29tPgpDYzogU2VhbiBQYXVsIDxzZWFuQHBvb3Js
eS5ydW4+CkNjOiBsaW51eC1hcm0tbXNtQHZnZXIua2VybmVsLm9yZwpDYzogZnJlZWRyZW5vQGxp
c3RzLmZyZWVkZXNrdG9wLm9yZwpTaWduZWQtb2ZmLWJ5OiBMaW51cyBXYWxsZWlqIDxsaW51cy53
YWxsZWlqQGxpbmFyby5vcmc+Ci0tLQogZHJpdmVycy9ncHUvZHJtL21zbS9oZG1pL2hkbWkuYyAg
ICAgICAgICAgfCA2NiArKysrKysrKysrKy0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL21z
bS9oZG1pL2hkbWkuaCAgICAgICAgICAgfCAgNCArLQogZHJpdmVycy9ncHUvZHJtL21zbS9oZG1p
L2hkbWlfY29ubmVjdG9yLmMgfCA0MiArKysrKy0tLS0tLS0tLS0KIDMgZmlsZXMgY2hhbmdlZCwg
NDUgaW5zZXJ0aW9ucygrKSwgNjcgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL21zbS9oZG1pL2hkbWkuYyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vaGRtaS9oZG1pLmMK
aW5kZXggZTI0N2Q2OTQyYTQ5Li5jOGU4MjY4Yzc2ZTIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9tc20vaGRtaS9oZG1pLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL21zbS9oZG1pL2hkbWku
YwpAQCAtNDM2LDM4ICs0MzYsNiBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHsKIAl7ICJxY29tLGhk
bWktdHgtbXV4LWxwbSIsIHRydWUsIDEsICJIRE1JX01VWF9MUE0iIH0sCiB9OwogCi1zdGF0aWMg
aW50IG1zbV9oZG1pX2dldF9ncGlvKHN0cnVjdCBkZXZpY2Vfbm9kZSAqb2Zfbm9kZSwgY29uc3Qg
Y2hhciAqbmFtZSkKLXsKLQlpbnQgZ3BpbzsKLQotCS8qIHRyeSB3aXRoIHRoZSBncGlvIG5hbWVz
IGFzIGluIHRoZSB0YWJsZSAoZG93bnN0cmVhbSBiaW5kaW5ncykgKi8KLQlncGlvID0gb2ZfZ2V0
X25hbWVkX2dwaW8ob2Zfbm9kZSwgbmFtZSwgMCk7Ci0JaWYgKGdwaW8gPCAwKSB7Ci0JCWNoYXIg
bmFtZTJbMzJdOwotCi0JCS8qIHRyeSB3aXRoIHRoZSBncGlvIG5hbWVzIGFzIGluIHRoZSB1cHN0
cmVhbSBiaW5kaW5ncyAqLwotCQlzbnByaW50ZihuYW1lMiwgc2l6ZW9mKG5hbWUyKSwgIiVzLWdw
aW9zIiwgbmFtZSk7Ci0JCWdwaW8gPSBvZl9nZXRfbmFtZWRfZ3BpbyhvZl9ub2RlLCBuYW1lMiwg
MCk7Ci0JCWlmIChncGlvIDwgMCkgewotCQkJY2hhciBuYW1lM1szMl07Ci0KLQkJCS8qCi0JCQkg
KiB0cnkgYWdhaW4gYWZ0ZXIgc3RyaXBwaW5nIG91dCB0aGUgInFjb20saGRtaS10eCIKLQkJCSAq
IHByZWZpeC4gVGhpcyBpcyBtYWlubHkgdG8gbWF0Y2ggImhwZC1ncGlvcyIgdXNlZAotCQkJICog
aW4gdGhlIHVwc3RyZWFtIGJpbmRpbmdzCi0JCQkgKi8KLQkJCWlmIChzc2NhbmYobmFtZTIsICJx
Y29tLGhkbWktdHgtJXMiLCBuYW1lMykpCi0JCQkJZ3BpbyA9IG9mX2dldF9uYW1lZF9ncGlvKG9m
X25vZGUsIG5hbWUzLCAwKTsKLQkJfQotCi0JCWlmIChncGlvIDwgMCkgewotCQkJREJHKCJmYWls
ZWQgdG8gZ2V0IGdwaW86ICVzICglZCkiLCBuYW1lLCBncGlvKTsKLQkJCWdwaW8gPSAtMTsKLQkJ
fQotCX0KLQlyZXR1cm4gZ3BpbzsKLX0KLQogLyoKICAqIEhETUkgYXVkaW8gY29kZWMgY2FsbGJh
Y2tzCiAgKi8KQEAgLTU5MywxMSArNTYxLDM5IEBAIHN0YXRpYyBpbnQgbXNtX2hkbWlfYmluZChz
dHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBkZXZpY2UgKm1hc3Rlciwgdm9pZCAqZGF0YSkKIAlo
ZG1pX2NmZy0+cWZwcm9tX21taW9fbmFtZSA9ICJxZnByb21fcGh5c2ljYWwiOwogCiAJZm9yIChp
ID0gMDsgaSA8IEhETUlfTUFYX05VTV9HUElPOyBpKyspIHsKLQkJaGRtaV9jZmctPmdwaW9zW2ld
Lm51bSA9IG1zbV9oZG1pX2dldF9ncGlvKG9mX25vZGUsCi0JCQkJCQltc21faGRtaV9ncGlvX3Bk
YXRhW2ldLm5hbWUpOworCQljb25zdCBjaGFyICpuYW1lID0gbXNtX2hkbWlfZ3Bpb19wZGF0YVtp
XS5uYW1lOworCQlzdHJ1Y3QgZ3Bpb19kZXNjICpncGlvZDsKKworCQkvKgorCQkgKiBXZSBhcmUg
ZmV0Y2hpbmcgdGhlIEdQSU8gbGluZXMgImFzIGlzIiBzaW5jZSB0aGUgY29ubmVjdG9yCisJCSAq
IGNvZGUgaXMgZW5hYmxpbmcgYW5kIGRpc2FibGluZyB0aGUgbGluZXMuIFVudGlsIHRoYXQgcG9p
bnQKKwkJICogdGhlIHBvd2VyLW9uIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSBrZXB0LgorCQkgKi8K
KwkJZ3Bpb2QgPSBkZXZtX2dwaW9kX2dldF9vcHRpb25hbChkZXYsIG5hbWUsIEdQSU9EX0FTSVMp
OworCQkvKiBUaGlzIHdpbGwgY2F0Y2ggZS5nLiAtUFJPQkVfREVGRVIgKi8KKwkJaWYgKElTX0VS
UihncGlvZCkpCisJCQlyZXR1cm4gUFRSX0VSUihncGlvZCk7CisJCWlmICghZ3Bpb2QpIHsKKwkJ
CS8qIFRyeSBhIHNlY29uZCB0aW1lLCBzdHJpcHBpbmcgZG93biB0aGUgbmFtZSAqLworCQkJY2hh
ciBuYW1lM1szMl07CisKKwkJCS8qCisJCQkgKiBUcnkgYWdhaW4gYWZ0ZXIgc3RyaXBwaW5nIG91
dCB0aGUgInFjb20saGRtaS10eCIKKwkJCSAqIHByZWZpeC4gVGhpcyBpcyBtYWlubHkgdG8gbWF0
Y2ggImhwZC1ncGlvcyIgdXNlZAorCQkJICogaW4gdGhlIHVwc3RyZWFtIGJpbmRpbmdzLgorCQkJ
ICovCisJCQlpZiAoc3NjYW5mKG5hbWUsICJxY29tLGhkbWktdHgtJXMiLCBuYW1lMykpCisJCQkJ
Z3Bpb2QgPSBkZXZtX2dwaW9kX2dldF9vcHRpb25hbChkZXYsIG5hbWUzLCBHUElPRF9BU0lTKTsK
KwkJCWlmIChJU19FUlIoZ3Bpb2QpKQorCQkJCXJldHVybiBQVFJfRVJSKGdwaW9kKTsKKwkJCWlm
ICghZ3Bpb2QpCisJCQkJREJHKCJmYWlsZWQgdG8gZ2V0IGdwaW86ICVzIiwgbmFtZSk7CisJCX0K
KwkJaGRtaV9jZmctPmdwaW9zW2ldLmdwaW9kID0gZ3Bpb2Q7CisJCWlmIChncGlvZCkKKwkJCWdw
aW9kX3NldF9jb25zdW1lcl9uYW1lKGdwaW9kLCBtc21faGRtaV9ncGlvX3BkYXRhW2ldLmxhYmVs
KTsKIAkJaGRtaV9jZmctPmdwaW9zW2ldLm91dHB1dCA9IG1zbV9oZG1pX2dwaW9fcGRhdGFbaV0u
b3V0cHV0OwogCQloZG1pX2NmZy0+Z3Bpb3NbaV0udmFsdWUgPSBtc21faGRtaV9ncGlvX3BkYXRh
W2ldLnZhbHVlOwotCQloZG1pX2NmZy0+Z3Bpb3NbaV0ubGFiZWwgPSBtc21faGRtaV9ncGlvX3Bk
YXRhW2ldLmxhYmVsOwogCX0KIAogCWRldi0+cGxhdGZvcm1fZGF0YSA9IGhkbWlfY2ZnOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21zbS9oZG1pL2hkbWkuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9tc20vaGRtaS9oZG1pLmgKaW5kZXggNWM1ZGY2YWIyYTU3Li4zZWY5NTZlOGRlNzEgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9tc20vaGRtaS9oZG1pLmgKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL21zbS9oZG1pL2hkbWkuaApAQCAtMjIsNiArMjIsNyBAQAogI2luY2x1ZGUgPGxpbnV4L2Ns
ay5oPgogI2luY2x1ZGUgPGxpbnV4L3BsYXRmb3JtX2RldmljZS5oPgogI2luY2x1ZGUgPGxpbnV4
L3JlZ3VsYXRvci9jb25zdW1lci5oPgorI2luY2x1ZGUgPGxpbnV4L2dwaW8vY29uc3VtZXIuaD4K
ICNpbmNsdWRlIDxsaW51eC9oZG1pLmg+CiAKICNpbmNsdWRlICJtc21fZHJ2LmgiCkBAIC0zMywx
MCArMzQsOSBAQCBzdHJ1Y3QgaGRtaV9waHk7CiBzdHJ1Y3QgaGRtaV9wbGF0Zm9ybV9jb25maWc7
CiAKIHN0cnVjdCBoZG1pX2dwaW9fZGF0YSB7Ci0JaW50IG51bTsKKwlzdHJ1Y3QgZ3Bpb19kZXNj
ICpncGlvZDsKIAlib29sIG91dHB1dDsKIAlpbnQgdmFsdWU7Ci0JY29uc3QgY2hhciAqbGFiZWw7
CiB9OwogCiBzdHJ1Y3QgaGRtaV9hdWRpbyB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
bXNtL2hkbWkvaGRtaV9jb25uZWN0b3IuYyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vaGRtaS9oZG1p
X2Nvbm5lY3Rvci5jCmluZGV4IGE2ZWVhYjJjNGRjMy4uYzRlOWY2ZDc5NjBmIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vbXNtL2hkbWkvaGRtaV9jb25uZWN0b3IuYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vbXNtL2hkbWkvaGRtaV9jb25uZWN0b3IuYwpAQCAtMTUsNyArMTUsNyBAQAogICog
dGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+
LgogICovCiAKLSNpbmNsdWRlIDxsaW51eC9ncGlvLmg+CisjaW5jbHVkZSA8bGludXgvZ3Bpby9j
b25zdW1lci5oPgogI2luY2x1ZGUgPGxpbnV4L3BpbmN0cmwvY29uc3VtZXIuaD4KIAogI2luY2x1
ZGUgIm1zbV9rbXMuaCIKQEAgLTc5LDMwICs3OSwyMSBAQCBzdGF0aWMgdm9pZCBtc21faGRtaV9w
aHlfcmVzZXQoc3RydWN0IGhkbWkgKmhkbWkpCiAKIHN0YXRpYyBpbnQgZ3Bpb19jb25maWcoc3Ry
dWN0IGhkbWkgKmhkbWksIGJvb2wgb24pCiB7Ci0Jc3RydWN0IGRldmljZSAqZGV2ID0gJmhkbWkt
PnBkZXYtPmRldjsKIAljb25zdCBzdHJ1Y3QgaGRtaV9wbGF0Zm9ybV9jb25maWcgKmNvbmZpZyA9
IGhkbWktPmNvbmZpZzsKLQlpbnQgcmV0LCBpOworCWludCBpOwogCiAJaWYgKG9uKSB7CiAJCWZv
ciAoaSA9IDA7IGkgPCBIRE1JX01BWF9OVU1fR1BJTzsgaSsrKSB7CiAJCQlzdHJ1Y3QgaGRtaV9n
cGlvX2RhdGEgZ3BpbyA9IGNvbmZpZy0+Z3Bpb3NbaV07CiAKLQkJCWlmIChncGlvLm51bSAhPSAt
MSkgewotCQkJCXJldCA9IGdwaW9fcmVxdWVzdChncGlvLm51bSwgZ3Bpby5sYWJlbCk7Ci0JCQkJ
aWYgKHJldCkgewotCQkJCQlEUk1fREVWX0VSUk9SKGRldiwKLQkJCQkJCSInJXMnKCVkKSBncGlv
X3JlcXVlc3QgZmFpbGVkOiAlZFxuIiwKLQkJCQkJCWdwaW8ubGFiZWwsIGdwaW8ubnVtLCByZXQp
OwotCQkJCQlnb3RvIGVycjsKLQkJCQl9Ci0KKwkJCWlmIChncGlvLmdwaW9kKSB7CiAJCQkJaWYg
KGdwaW8ub3V0cHV0KSB7Ci0JCQkJCWdwaW9fZGlyZWN0aW9uX291dHB1dChncGlvLm51bSwKLQkJ
CQkJCQkgICAgICBncGlvLnZhbHVlKTsKKwkJCQkJZ3Bpb2RfZGlyZWN0aW9uX291dHB1dChncGlv
LmdwaW9kLAorCQkJCQkJCSAgICAgICBncGlvLnZhbHVlKTsKIAkJCQl9IGVsc2UgewotCQkJCQln
cGlvX2RpcmVjdGlvbl9pbnB1dChncGlvLm51bSk7Ci0JCQkJCWdwaW9fc2V0X3ZhbHVlX2NhbnNs
ZWVwKGdwaW8ubnVtLAotCQkJCQkJCQlncGlvLnZhbHVlKTsKKwkJCQkJZ3Bpb2RfZGlyZWN0aW9u
X2lucHV0KGdwaW8uZ3Bpb2QpOworCQkJCQlncGlvZF9zZXRfdmFsdWVfY2Fuc2xlZXAoZ3Bpby5n
cGlvZCwKKwkJCQkJCQkJIGdwaW8udmFsdWUpOwogCQkJCX0KIAkJCX0KIAkJfQpAQCAtMTEyLDI5
ICsxMDMsMjAgQEAgc3RhdGljIGludCBncGlvX2NvbmZpZyhzdHJ1Y3QgaGRtaSAqaGRtaSwgYm9v
bCBvbikKIAkJZm9yIChpID0gMDsgaSA8IEhETUlfTUFYX05VTV9HUElPOyBpKyspIHsKIAkJCXN0
cnVjdCBoZG1pX2dwaW9fZGF0YSBncGlvID0gY29uZmlnLT5ncGlvc1tpXTsKIAotCQkJaWYgKGdw
aW8ubnVtID09IC0xKQorCQkJaWYgKCFncGlvLmdwaW9kKQogCQkJCWNvbnRpbnVlOwogCiAJCQlp
ZiAoZ3Bpby5vdXRwdXQpIHsKIAkJCQlpbnQgdmFsdWUgPSBncGlvLnZhbHVlID8gMCA6IDE7CiAK
LQkJCQlncGlvX3NldF92YWx1ZV9jYW5zbGVlcChncGlvLm51bSwgdmFsdWUpOworCQkJCWdwaW9k
X3NldF92YWx1ZV9jYW5zbGVlcChncGlvLmdwaW9kLCB2YWx1ZSk7CiAJCQl9Ci0KLQkJCWdwaW9f
ZnJlZShncGlvLm51bSk7CiAJCX07CiAKIAkJREJHKCJncGlvIG9mZiIpOwogCX0KIAogCXJldHVy
biAwOwotZXJyOgotCXdoaWxlIChpLS0pIHsKLQkJaWYgKGNvbmZpZy0+Z3Bpb3NbaV0ubnVtICE9
IC0xKQotCQkJZ3Bpb19mcmVlKGNvbmZpZy0+Z3Bpb3NbaV0ubnVtKTsKLQl9Ci0KLQlyZXR1cm4g
cmV0OwogfQogCiBzdGF0aWMgdm9pZCBlbmFibGVfaHBkX2Nsb2NrcyhzdHJ1Y3QgaGRtaSAqaGRt
aSwgYm9vbCBlbmFibGUpCkBAIC0zMjIsNyArMzA0LDcgQEAgc3RhdGljIGVudW0gZHJtX2Nvbm5l
Y3Rvcl9zdGF0dXMgZGV0ZWN0X2dwaW8oc3RydWN0IGhkbWkgKmhkbWkpCiAJY29uc3Qgc3RydWN0
IGhkbWlfcGxhdGZvcm1fY29uZmlnICpjb25maWcgPSBoZG1pLT5jb25maWc7CiAJc3RydWN0IGhk
bWlfZ3Bpb19kYXRhIGhwZF9ncGlvID0gY29uZmlnLT5ncGlvc1tIUERfR1BJT19JTkRFWF07CiAK
LQlyZXR1cm4gZ3Bpb19nZXRfdmFsdWUoaHBkX2dwaW8ubnVtKSA/CisJcmV0dXJuIGdwaW9kX2dl
dF92YWx1ZShocGRfZ3Bpby5ncGlvZCkgPwogCQkJY29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQg
OgogCQkJY29ubmVjdG9yX3N0YXR1c19kaXNjb25uZWN0ZWQ7CiB9CkBAIC0zNDEsNyArMzIzLDcg
QEAgc3RhdGljIGVudW0gZHJtX2Nvbm5lY3Rvcl9zdGF0dXMgaGRtaV9jb25uZWN0b3JfZGV0ZWN0
KAogCSAqIHNvbWUgcGxhdGZvcm1zIG1heSBub3QgaGF2ZSBocGQgZ3Bpby4gUmVseSBvbmx5IG9u
IHRoZSBzdGF0dXMKIAkgKiBwcm92aWRlZCBieSBSRUdfSERNSV9IUERfSU5UX1NUQVRVUyBpbiB0
aGlzIGNhc2UuCiAJICovCi0JaWYgKGhwZF9ncGlvLm51bSA9PSAtMSkKKwlpZiAoIWhwZF9ncGlv
LmdwaW9kKQogCQlyZXR1cm4gZGV0ZWN0X3JlZyhoZG1pKTsKIAogCWRvIHsKLS0gCjIuMjAuMQoK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVs
IG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlz
dHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
