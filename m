Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id CC3AB274321
	for <lists+dri-devel@lfdr.de>; Tue, 22 Sep 2020 15:32:33 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9EA6A6E879;
	Tue, 22 Sep 2020 13:32:26 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ej1-x643.google.com (mail-ej1-x643.google.com
 [IPv6:2a00:1450:4864:20::643])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A773B6E86D;
 Tue, 22 Sep 2020 13:32:15 +0000 (UTC)
Received: by mail-ej1-x643.google.com with SMTP id nw23so22850334ejb.4;
 Tue, 22 Sep 2020 06:32:15 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:subject:date:message-id:in-reply-to:references:mime-version
 :content-transfer-encoding;
 bh=yUCepw6Ck/TqTA6dNy6+/5rD4JUuOVb4ozCqO4HGsUw=;
 b=Qza59+fo2QozUtoQNZ3t5Xn56y30RyWphPuw/Q9dorVnRap/h43CAoq4jndp3VVgQ0
 LyQqHhtZfg531t4p8vvge+Am4oZsj+zH7nUBesw3aK1c/dPNQAEv5HoRqkcGTeOYyM3m
 MmYA+uv1QLuDvfn2fvWNBQOIso5sj/bFQeRcmD9R/OIZhjK386ITN8mRbbN1vv99Lq2G
 Q7poQUC+UOYKX/88RW7NPiDEaErZDKzN4ZARObl9ij/MCwJDt5hy0O8hxb6MdBmdGbf4
 TKm8eGzWs2hbSDEJKTKfcJVkBjO04SpDN+PI8kSrvzt8rR3xUUp35gnVGO/+V/eC6VxH
 lr4Q==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=yUCepw6Ck/TqTA6dNy6+/5rD4JUuOVb4ozCqO4HGsUw=;
 b=RGaNb6qS2hqfM0v13EHaa2jCSe+eYrefpftIVBbSqbfbXQlkVegdNwcZMH7gfi+62s
 uGR4c12KlK5/HYDjIdSAZWup2tfveOxLvwzHcJTGULAcKfH04HhqFp+lGnvhERz76hrF
 sC7YeCnignPp2TxytQjECXEeoYdkmQ498sfUvG24pv4e27JYLKXpstWOagBRLZO1oCfn
 hVf241KXyNsZuZIZ5eaS/orWCzGT590jjZRYItNJ+6+WExlRcCBzHtX27DiDedvd6ufr
 /iqF/YUh9VAJTesXOeiQ7aR3kirHUp1OjGOWTEG/uMRgMY0G4YAK8YHMoAqmH1slAS2V
 2W+A==
X-Gm-Message-State: AOAM531AMYRu95Nf5ZgddSo46u02pBHrw6y2dN2TLPkKvmS/v3/GxRFP
 jlf/GdLYPJRtrHdLdEtSRCdy3rvAZnE=
X-Google-Smtp-Source: ABdhPJxY6n+gvKs/0DdwI79GLW2yRn4fWun4iKXvJOC7lYLitnPyyKaB3EGyQLMFt+qBFLBl3oBP8g==
X-Received: by 2002:a17:906:f747:: with SMTP id
 jp7mr4777693ejb.22.1600781534371; 
 Tue, 22 Sep 2020 06:32:14 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:11af:3d77:a1c7:4f3a])
 by smtp.gmail.com with ESMTPSA id z21sm11541028eja.72.2020.09.22.06.32.13
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 22 Sep 2020 06:32:13 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: linux-graphics-maintainer@vmware.com, sroland@vmware.com, airlied@linux.ie,
 daniel@ffwll.ch, amd-gfx@lists.freedesktop.org,
 dri-devel@lists.freedesktop.org, ray.huang@amd.com
Subject: [PATCH 05/11] drm/nouveau: switch over to the new pin interface
Date: Tue, 22 Sep 2020 15:32:02 +0200
Message-Id: <20200922133208.1273-5-christian.koenig@amd.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200922133208.1273-1-christian.koenig@amd.com>
References: <20200922133208.1273-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

U3RvcCB1c2luZyBUVE1fUExfRkxBR19OT19FVklDVC4KClNpZ25lZC1vZmYtYnk6IENocmlzdGlh
biBLw7ZuaWcgPGNocmlzdGlhbi5rb2VuaWdAYW1kLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0v
bm91dmVhdS9ub3V2ZWF1X2JvLmMgICB8IDQ4ICsrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tCiBk
cml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2JvLmggICB8ICAzIC0tCiBkcml2ZXJzL2dw
dS9kcm0vbm91dmVhdS9ub3V2ZWF1X2NoYW4uYyB8ICAyICstCiAzIGZpbGVzIGNoYW5nZWQsIDEz
IGluc2VydGlvbnMoKyksIDQwIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9ub3V2ZWF1L25vdXZlYXVfYm8uYyBiL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZl
YXVfYm8uYwppbmRleCAyZWU3NTY0NmFkNmYuLmJjYWU0NTE0OTUyZiAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9iby5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9u
b3V2ZWF1L25vdXZlYXVfYm8uYwpAQCAtMTM5LDcgKzEzOSw3IEBAIG5vdXZlYXVfYm9fZGVsX3R0
bShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvKQogCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYg
PSBkcm0tPmRldjsKIAlzdHJ1Y3Qgbm91dmVhdV9ibyAqbnZibyA9IG5vdXZlYXVfYm8oYm8pOwog
Ci0JV0FSTl9PTihudmJvLT5waW5fcmVmY250ID4gMCk7CisJV0FSTl9PTihudmJvLT5iby5waW5f
Y291bnQgPiAwKTsKIAlub3V2ZWF1X2JvX2RlbF9pb19yZXNlcnZlX2xydShibyk7CiAJbnYxMF9i
b19wdXRfdGlsZV9yZWdpb24oZGV2LCBudmJvLT50aWxlLCBOVUxMKTsKIApAQCAtNDE3LDkgKzQx
Nyw4IEBAIG5vdXZlYXVfYm9fcGxhY2VtZW50X3NldChzdHJ1Y3Qgbm91dmVhdV9ibyAqbnZibywg
dWludDMyX3QgZG9tYWluLAogewogCXN0cnVjdCBub3V2ZWF1X2RybSAqZHJtID0gbm91dmVhdV9i
ZGV2KG52Ym8tPmJvLmJkZXYpOwogCXN0cnVjdCB0dG1fcGxhY2VtZW50ICpwbCA9ICZudmJvLT5w
bGFjZW1lbnQ7Ci0JdWludDMyX3QgZmxhZ3MgPSAobnZiby0+Zm9yY2VfY29oZXJlbnQgPyBUVE1f
UExfRkxBR19VTkNBQ0hFRCA6Ci0JCQkJCQkgVFRNX1BMX01BU0tfQ0FDSElORykgfAotCQkJIChu
dmJvLT5waW5fcmVmY250ID8gVFRNX1BMX0ZMQUdfTk9fRVZJQ1QgOiAwKTsKKwl1aW50MzJfdCBm
bGFncyA9IG52Ym8tPmZvcmNlX2NvaGVyZW50ID8gVFRNX1BMX0ZMQUdfVU5DQUNIRUQgOgorCQkJ
CQkJVFRNX1BMX01BU0tfQ0FDSElORzsKIAogCXBsLT5wbGFjZW1lbnQgPSBudmJvLT5wbGFjZW1l
bnRzOwogCXNldF9wbGFjZW1lbnRfbGlzdChkcm0sIG52Ym8tPnBsYWNlbWVudHMsICZwbC0+bnVt
X3BsYWNlbWVudCwKQEAgLTQ1Myw3ICs0NTIsNyBAQCBub3V2ZWF1X2JvX3BpbihzdHJ1Y3Qgbm91
dmVhdV9ibyAqbnZibywgdWludDMyX3QgZG9tYWluLCBib29sIGNvbnRpZykKIAkJfQogCX0KIAot
CWlmIChudmJvLT5waW5fcmVmY250KSB7CisJaWYgKG52Ym8tPmJvLnBpbl9jb3VudCkgewogCQli
b29sIGVycm9yID0gZXZpY3Q7CiAKIAkJc3dpdGNoIChiby0+bWVtLm1lbV90eXBlKSB7CkBAIC00
NzIsNyArNDcxLDcgQEAgbm91dmVhdV9ib19waW4oc3RydWN0IG5vdXZlYXVfYm8gKm52Ym8sIHVp
bnQzMl90IGRvbWFpbiwgYm9vbCBjb250aWcpCiAJCQkJIGJvLT5tZW0ubWVtX3R5cGUsIGRvbWFp
bik7CiAJCQlyZXQgPSAtRUJVU1k7CiAJCX0KLQkJbnZiby0+cGluX3JlZmNudCsrOworCQl0dG1f
Ym9fcGluKCZudmJvLT5ibyk7CiAJCWdvdG8gb3V0OwogCX0KIApAQCAtNDgzLDE4ICs0ODIsMTIg
QEAgbm91dmVhdV9ib19waW4oc3RydWN0IG5vdXZlYXVfYm8gKm52Ym8sIHVpbnQzMl90IGRvbWFp
biwgYm9vbCBjb250aWcpCiAJCQlnb3RvIG91dDsKIAl9CiAKLQludmJvLT5waW5fcmVmY250Kys7
CiAJbm91dmVhdV9ib19wbGFjZW1lbnRfc2V0KG52Ym8sIGRvbWFpbiwgMCk7Ci0KLQkvKiBkcm9w
IHBpbl9yZWZjbnQgdGVtcG9yYXJpbHksIHNvIHdlIGRvbid0IHRyaXAgdGhlIGFzc2VydGlvbgot
CSAqIGluIG5vdXZlYXVfYm9fbW92ZSgpIHRoYXQgbWFrZXMgc3VyZSB3ZSdyZSBub3QgdHJ5aW5n
IHRvCi0JICogbW92ZSBhIHBpbm5lZCBidWZmZXIKLQkgKi8KLQludmJvLT5waW5fcmVmY250LS07
CiAJcmV0ID0gbm91dmVhdV9ib192YWxpZGF0ZShudmJvLCBmYWxzZSwgZmFsc2UpOwogCWlmIChy
ZXQpCiAJCWdvdG8gb3V0OwotCW52Ym8tPnBpbl9yZWZjbnQrKzsKKworCXR0bV9ib19waW4oJm52
Ym8tPmJvKTsKIAogCXN3aXRjaCAoYm8tPm1lbS5tZW1fdHlwZSkgewogCWNhc2UgVFRNX1BMX1ZS
QU06CkBAIC01MTksMzAgKzUxMiwxNCBAQCBub3V2ZWF1X2JvX3VucGluKHN0cnVjdCBub3V2ZWF1
X2JvICpudmJvKQogewogCXN0cnVjdCBub3V2ZWF1X2RybSAqZHJtID0gbm91dmVhdV9iZGV2KG52
Ym8tPmJvLmJkZXYpOwogCXN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8gPSAmbnZiby0+Ym87
Ci0JaW50IHJldCwgcmVmOworCWludCByZXQ7CiAKIAlyZXQgPSB0dG1fYm9fcmVzZXJ2ZShibywg
ZmFsc2UsIGZhbHNlLCBOVUxMKTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCi0JcmVmID0g
LS1udmJvLT5waW5fcmVmY250OwotCVdBUk5fT05fT05DRShyZWYgPCAwKTsKLQlpZiAocmVmKQot
CQlnb3RvIG91dDsKLQotCXN3aXRjaCAoYm8tPm1lbS5tZW1fdHlwZSkgewotCWNhc2UgVFRNX1BM
X1ZSQU06Ci0JCW5vdXZlYXVfYm9fcGxhY2VtZW50X3NldChudmJvLCBOT1VWRUFVX0dFTV9ET01B
SU5fVlJBTSwgMCk7Ci0JCWJyZWFrOwotCWNhc2UgVFRNX1BMX1RUOgotCQlub3V2ZWF1X2JvX3Bs
YWNlbWVudF9zZXQobnZibywgTk9VVkVBVV9HRU1fRE9NQUlOX0dBUlQsIDApOwotCQlicmVhazsK
LQlkZWZhdWx0OgotCQlicmVhazsKLQl9Ci0KLQlyZXQgPSBub3V2ZWF1X2JvX3ZhbGlkYXRlKG52
Ym8sIGZhbHNlLCBmYWxzZSk7Ci0JaWYgKHJldCA9PSAwKSB7CisJdHRtX2JvX3VucGluKCZudmJv
LT5ibyk7CisJaWYgKCFudmJvLT5iby5waW5fY291bnQpIHsKIAkJc3dpdGNoIChiby0+bWVtLm1l
bV90eXBlKSB7CiAJCWNhc2UgVFRNX1BMX1ZSQU06CiAJCQlkcm0tPmdlbS52cmFtX2F2YWlsYWJs
ZSArPSBiby0+bWVtLnNpemU7CkBAIC01NTUsOSArNTMyLDggQEAgbm91dmVhdV9ib191bnBpbihz
dHJ1Y3Qgbm91dmVhdV9ibyAqbnZibykKIAkJfQogCX0KIAotb3V0OgogCXR0bV9ib191bnJlc2Vy
dmUoYm8pOwotCXJldHVybiByZXQ7CisJcmV0dXJuIDA7CiB9CiAKIGludApAQCAtMTA2NSw3ICsx
MDQxLDcgQEAgbm91dmVhdV9ib19tb3ZlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sIGJv
b2wgZXZpY3QsCiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIAotCWlmIChudmJvLT5waW5fcmVm
Y250KQorCWlmIChudmJvLT5iby5waW5fY291bnQpCiAJCU5WX1dBUk4oZHJtLCAiTW92aW5nIHBp
bm5lZCBvYmplY3QgJXAhXG4iLCBudmJvKTsKIAogCWlmIChkcm0tPmNsaWVudC5kZXZpY2UuaW5m
by5mYW1pbHkgPCBOVl9ERVZJQ0VfSU5GT19WMF9URVNMQSkgewpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9iby5oIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUv
bm91dmVhdV9iby5oCmluZGV4IDJhMjNjODIwNzQzNi4uZmY2OGRlZDhkNTkwIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2JvLmgKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL25vdXZlYXUvbm91dmVhdV9iby5oCkBAIC00MCw5ICs0MCw2IEBAIHN0cnVjdCBub3V2ZWF1
X2JvIHsKIAogCXN0cnVjdCBub3V2ZWF1X2RybV90aWxlICp0aWxlOwogCi0JLyogcHJvdGVjdCBi
eSB0aGUgdHRtIHJlc2VydmF0aW9uIGxvY2sgKi8KLQlpbnQgcGluX3JlZmNudDsKLQogCXN0cnVj
dCB0dG1fYm9fa21hcF9vYmogZG1hX2J1Zl92bWFwOwogfTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9jaGFuLmMgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVh
dS9ub3V2ZWF1X2NoYW4uYwppbmRleCA4ZjA5OTYwMWQyZjIuLjVkMTkxZTU4ZWRmMSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9jaGFuLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9jaGFuLmMKQEAgLTEwNyw3ICsxMDcsNyBAQCBub3V2
ZWF1X2NoYW5uZWxfZGVsKHN0cnVjdCBub3V2ZWF1X2NoYW5uZWwgKipwY2hhbikKIAkJbnZpZl9v
YmplY3RfZHRvcigmY2hhbi0+cHVzaC5jdHhkbWEpOwogCQlub3V2ZWF1X3ZtYV9kZWwoJmNoYW4t
PnB1c2gudm1hKTsKIAkJbm91dmVhdV9ib191bm1hcChjaGFuLT5wdXNoLmJ1ZmZlcik7Ci0JCWlm
IChjaGFuLT5wdXNoLmJ1ZmZlciAmJiBjaGFuLT5wdXNoLmJ1ZmZlci0+cGluX3JlZmNudCkKKwkJ
aWYgKGNoYW4tPnB1c2guYnVmZmVyICYmIGNoYW4tPnB1c2guYnVmZmVyLT5iby5waW5fY291bnQp
CiAJCQlub3V2ZWF1X2JvX3VucGluKGNoYW4tPnB1c2guYnVmZmVyKTsKIAkJbm91dmVhdV9ib19y
ZWYoTlVMTCwgJmNoYW4tPnB1c2guYnVmZmVyKTsKIAkJa2ZyZWUoY2hhbik7Ci0tIAoyLjE3LjEK
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZl
bCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xp
c3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbAo=
