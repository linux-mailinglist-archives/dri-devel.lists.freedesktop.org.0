Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 0266560313
	for <lists+dri-devel@lfdr.de>; Fri,  5 Jul 2019 11:26:32 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 15FB56E45C;
	Fri,  5 Jul 2019 09:26:25 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 288686E459
 for <dri-devel@lists.freedesktop.org>; Fri,  5 Jul 2019 09:26:19 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id AB70BAE89;
 Fri,  5 Jul 2019 09:26:17 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: airlied@redhat.com, daniel@ffwll.ch, kraxel@redhat.com,
 maarten.lankhorst@linux.intel.com, maxime.ripard@bootlin.com,
 sean@poorly.run, noralf@tronnes.org, sam@ravnborg.org,
 yc_chen@aspeedtech.com
Subject: [PATCH v2 3/6] drm/fb-helper: Instanciate shadow FB if configured in
 device's mode_config
Date: Fri,  5 Jul 2019 11:26:10 +0200
Message-Id: <20190705092613.7621-4-tzimmermann@suse.de>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190705092613.7621-1-tzimmermann@suse.de>
References: <20190705092613.7621-1-tzimmermann@suse.de>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Zimmermann <tzimmermann@suse.de>, dri-devel@lists.freedesktop.org,
 virtualization@lists.linux-foundation.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

R2VuZXJpYyBmcmFtZWJ1ZmZlciBlbXVsYXRpb24gdXNlcyBhIHNoYWRvdyBidWZmZXIgZm9yIGZy
YW1lYnVmZmVycyB3aXRoCmRpcnR5KCkgZnVuY3Rpb24uIElmIGRyaXZlcnMgd2FudCB0byB1c2Ug
dGhlIHNoYWRvdyBGQiB3aXRob3V0IHN1Y2ggYQpmdW5jdGlvbiwgdGhleSBjYW4gbm93IHNldCBw
cmVmZXJfc2hhZG93IG9yIHByZWZlcl9zaGFkb3dfZmJkZXYgaW4gdGhlaXIKbW9kZV9jb25maWcg
c3RydWN0dXJlcy4gVGhlIGZvcm1lciBmbGFnIGlzIGV4cG9ydGVkIHRvIHVzZXJzcGFjZSwgdGhl
IGxhdHRlcgpmbGFnIGlzIGZiZGV2LW9ubHkuCgpTaWduZWQtb2ZmLWJ5OiBUaG9tYXMgWmltbWVy
bWFubiA8dHppbW1lcm1hbm5Ac3VzZS5kZT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vZHJtX2ZiX2hl
bHBlci5jIHwgMTkgKysrKysrKysrKysrKystLS0tLQogaW5jbHVkZS9kcm0vZHJtX21vZGVfY29u
ZmlnLmggICB8ICA1ICsrKysrCiAyIGZpbGVzIGNoYW5nZWQsIDE5IGluc2VydGlvbnMoKyksIDUg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2RybV9mYl9oZWxwZXIu
YyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fZmJfaGVscGVyLmMKaW5kZXggN2JhNmEwMjU1ODIxLi41
NmVmMTY5ZTE4MTQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9kcm1fZmJfaGVscGVyLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2RybV9mYl9oZWxwZXIuYwpAQCAtNDIxLDcgKzQyMSw5IEBA
IHN0YXRpYyB2b2lkIGRybV9mYl9oZWxwZXJfZGlydHlfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3Qg
KndvcmspCiAJCQkJcmV0dXJuOwogCQkJZHJtX2ZiX2hlbHBlcl9kaXJ0eV9ibGl0X3JlYWwoaGVs
cGVyLCAmY2xpcF9jb3B5KTsKIAkJfQotCQloZWxwZXItPmZiLT5mdW5jcy0+ZGlydHkoaGVscGVy
LT5mYiwgTlVMTCwgMCwgMCwgJmNsaXBfY29weSwgMSk7CisJCWlmIChoZWxwZXItPmZiLT5mdW5j
cy0+ZGlydHkpCisJCQloZWxwZXItPmZiLT5mdW5jcy0+ZGlydHkoaGVscGVyLT5mYiwgTlVMTCwg
MCwgMCwKKwkJCQkJCSAmY2xpcF9jb3B5LCAxKTsKIAogCQlpZiAoaGVscGVyLT5idWZmZXIpCiAJ
CQlkcm1fY2xpZW50X2J1ZmZlcl92dW5tYXAoaGVscGVyLT5idWZmZXIpOwpAQCAtNjIwLDkgKzYy
Miw2IEBAIHN0YXRpYyB2b2lkIGRybV9mYl9oZWxwZXJfZGlydHkoc3RydWN0IGZiX2luZm8gKmlu
Zm8sIHUzMiB4LCB1MzIgeSwKIAlzdHJ1Y3QgZHJtX2NsaXBfcmVjdCAqY2xpcCA9ICZoZWxwZXIt
PmRpcnR5X2NsaXA7CiAJdW5zaWduZWQgbG9uZyBmbGFnczsKIAotCWlmICghaGVscGVyLT5mYi0+
ZnVuY3MtPmRpcnR5KQotCQlyZXR1cm47Ci0KIAlzcGluX2xvY2tfaXJxc2F2ZSgmaGVscGVyLT5k
aXJ0eV9sb2NrLCBmbGFncyk7CiAJY2xpcC0+eDEgPSBtaW5fdCh1MzIsIGNsaXAtPngxLCB4KTsK
IAljbGlwLT55MSA9IG1pbl90KHUzMiwgY2xpcC0+eTEsIHkpOwpAQCAtMjE2Niw2ICsyMTY1LDE2
IEBAIHN0YXRpYyBzdHJ1Y3QgZmJfZGVmZXJyZWRfaW8gZHJtX2ZiZGV2X2RlZmlvID0gewogCS5k
ZWZlcnJlZF9pbwk9IGRybV9mYl9oZWxwZXJfZGVmZXJyZWRfaW8sCiB9OwogCitzdGF0aWMgYm9v
bCBkcm1fZmJkZXZfdXNlX3NoYWRvd19mYihzdHJ1Y3QgZHJtX2ZiX2hlbHBlciAqZmJfaGVscGVy
KQoreworCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBmYl9oZWxwZXItPmRldjsKKwlzdHJ1Y3Qg
ZHJtX2ZyYW1lYnVmZmVyICpmYiA9IGZiX2hlbHBlci0+ZmI7CisKKwlyZXR1cm4gZGV2LT5tb2Rl
X2NvbmZpZy5wcmVmZXJfc2hhZG93X2ZiZGV2IHwKKwkgICAgICAgZGV2LT5tb2RlX2NvbmZpZy5w
cmVmZXJfc2hhZG93IHwKKwkgICAgICAgISFmYi0+ZnVuY3MtPmRpcnR5OworfQorCiAvKioKICAq
IGRybV9mYl9oZWxwZXJfZ2VuZXJpY19wcm9iZSAtIEdlbmVyaWMgZmJkZXYgZW11bGF0aW9uIHBy
b2JlIGhlbHBlcgogICogQGZiX2hlbHBlcjogZmJkZXYgaGVscGVyIHN0cnVjdHVyZQpAQCAtMjIx
Myw3ICsyMjIyLDcgQEAgaW50IGRybV9mYl9oZWxwZXJfZ2VuZXJpY19wcm9iZShzdHJ1Y3QgZHJt
X2ZiX2hlbHBlciAqZmJfaGVscGVyLAogCiAJZHJtX2ZiX2hlbHBlcl9maWxsX2luZm8oZmJpLCBm
Yl9oZWxwZXIsIHNpemVzKTsKIAotCWlmIChmYi0+ZnVuY3MtPmRpcnR5KSB7CisJaWYgKGRybV9m
YmRldl91c2Vfc2hhZG93X2ZiKGZiX2hlbHBlcikpIHsKIAkJc3RydWN0IGZiX29wcyAqZmJvcHM7
CiAJCXZvaWQgKnNoYWRvdzsKIApkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0vZHJtX21vZGVfY29u
ZmlnLmggYi9pbmNsdWRlL2RybS9kcm1fbW9kZV9jb25maWcuaAppbmRleCA3NTlkNDYyZDAyOGIu
LmUxYzc1MWFjYTM1MyAxMDA2NDQKLS0tIGEvaW5jbHVkZS9kcm0vZHJtX21vZGVfY29uZmlnLmgK
KysrIGIvaW5jbHVkZS9kcm0vZHJtX21vZGVfY29uZmlnLmgKQEAgLTM0Nyw2ICszNDcsOCBAQCBz
dHJ1Y3QgZHJtX21vZGVfY29uZmlnX2Z1bmNzIHsKICAqIEBvdXRwdXRfcG9sbF93b3JrOiBkZWxh
eWVkIHdvcmsgZm9yIHBvbGxpbmcgaW4gcHJvY2VzcyBjb250ZXh0CiAgKiBAcHJlZmVycmVkX2Rl
cHRoOiBwcmVmZXJyZWQgUkJHIHBpeGVsIGRlcHRoLCB1c2VkIGJ5IGZiIGhlbHBlcnMKICAqIEBw
cmVmZXJfc2hhZG93OiBoaW50IHRvIHVzZXJzcGFjZSB0byBwcmVmZXIgc2hhZG93LWZiIHJlbmRl
cmluZworICogQHByZWZlcl9zaGFkb3dfZmJkZXY6IGhpbnQgdG8gZnJhbWVidWZmZXIgZW11bGF0
aW9uIHRvIHByZWZlciBzaGFkb3ctZmIgXAorCXJlbmRlcmluZwogICogQGN1cnNvcl93aWR0aDog
aGludCB0byB1c2Vyc3BhY2UgZm9yIG1heCBjdXJzb3Igd2lkdGgKICAqIEBjdXJzb3JfaGVpZ2h0
OiBoaW50IHRvIHVzZXJzcGFjZSBmb3IgbWF4IGN1cnNvciBoZWlnaHQKICAqIEBoZWxwZXJfcHJp
dmF0ZTogbWlkLWxheWVyIHByaXZhdGUgZGF0YQpAQCAtODUyLDYgKzg1NCw5IEBAIHN0cnVjdCBk
cm1fbW9kZV9jb25maWcgewogCS8qIGR1bWIgaW9jdGwgcGFyYW1ldGVycyAqLwogCXVpbnQzMl90
IHByZWZlcnJlZF9kZXB0aCwgcHJlZmVyX3NoYWRvdzsKIAorCS8qIGZiZGV2IHBhcmFtZXRlcnMg
Ki8KKwl1aW50MzJfdCBwcmVmZXJfc2hhZG93X2ZiZGV2OworCiAJLyoqCiAJICogQHF1aXJrX2Fk
ZGZiX3ByZWZlcl94YmdyXzMwYnBwOgogCSAqCi0tIAoyLjIxLjAKCl9fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJp
LWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9y
Zy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
