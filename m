Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8EEA382CA9
	for <lists+dri-devel@lfdr.de>; Tue,  6 Aug 2019 09:25:42 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E49BA89F6F;
	Tue,  6 Aug 2019 07:24:40 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from onstation.org (onstation.org [52.200.56.107])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 84AA56E1E9;
 Tue,  6 Aug 2019 00:22:58 +0000 (UTC)
Received: from localhost.localdomain (c-98-239-145-235.hsd1.wv.comcast.net
 [98.239.145.235])
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits))
 (No client certificate requested) (Authenticated sender: masneyb)
 by onstation.org (Postfix) with ESMTPSA id 87B033E9AC;
 Tue,  6 Aug 2019 00:22:57 +0000 (UTC)
From: Brian Masney <masneyb@onstation.org>
To: agross@kernel.org, robdclark@gmail.com, sean@poorly.run,
 robh+dt@kernel.org, bjorn.andersson@linaro.org
Subject: [PATCH v5 3/7] firmware: qcom: scm: add OCMEM lock/unlock interface
Date: Mon,  5 Aug 2019 20:22:25 -0400
Message-Id: <20190806002229.8304-4-masneyb@onstation.org>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190806002229.8304-1-masneyb@onstation.org>
References: <20190806002229.8304-1-masneyb@onstation.org>
X-Mailman-Approved-At: Tue, 06 Aug 2019 07:24:35 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=onstation.org; s=default; t=1565050977;
 bh=S/QdnhMCwKW5JSFlLDs+tHo/hKIlLBjJoq6uDPtLTwI=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=GUBViSodITe0a+hZ/1CA/MDR88/ZQhQ7C6C83qMDPKdOZWazTFrCncZr8uIrtLXqp
 RsAxQMFYmnKMe7rsUMjfCQsEn8UthVKpMpzl4CII4ZSs9+X6ShyqyKsXaZiF7ieFp4
 5WEf5lx8YouE6iaUPwJoiWh57vz2LKMviSnsf+Tw=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: mark.rutland@arm.com, devicetree@vger.kernel.org, jonathan@marek.ca,
 airlied@linux.ie, linux-arm-msm@vger.kernel.org, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, freedreno@lists.freedesktop.org
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogUm9iIENsYXJrIDxyb2JkY2xhcmtAZ21haWwuY29tPgoKQWRkIHN1cHBvcnQgZm9yIHRo
ZSBPQ01FTSBsb2NrL3VubG9jayBpbnRlcmZhY2UgdGhhdCBpcyBuZWVkZWQgYnkgdGhlCk9uIENo
aXAgTUVNb3J5IChPQ01FTSkgdGhhdCBpcyBwcmVzZW50IG9uIHNvbWUgU25hcGRyYWdvbiBkZXZp
Y2VzLgoKU2lnbmVkLW9mZi1ieTogUm9iIENsYXJrIDxyb2JkY2xhcmtAZ21haWwuY29tPgpbbWFz
bmV5YkBvbnN0YXRpb24ub3JnOiBwb3J0ZWQgdG8gbGF0ZXN0IGtlcm5lbDsgbWlub3IgcmVmb3Jt
YXR0aW5nLl0KU2lnbmVkLW9mZi1ieTogQnJpYW4gTWFzbmV5IDxtYXNuZXliQG9uc3RhdGlvbi5v
cmc+ClJldmlld2VkLWJ5OiBCam9ybiBBbmRlcnNzb24gPGJqb3JuLmFuZGVyc3NvbkBsaW5hcm8u
b3JnPgotLS0KUm9iJ3MgbGFzdCB2ZXJzaW9uIG9mIHRoaXMgcGF0Y2g6Cmh0dHBzOi8vcGF0Y2h3
b3JrLmtlcm5lbC5vcmcvcGF0Y2gvNzM0MDcxMS8KCkNoYW5nZXMgc2luY2UgdjQ6Ci0gTm9uZQoK
Q2hhbmdlcyBzaW5jZSB2MzoKLSBOb25lCgpDaGFuZ2VzIHNpbmNlIHYyOgotIE5vbmUKCkNoYW5n
ZXMgc2luY2UgdjE6Ci0gTm9uZQoKIGRyaXZlcnMvZmlybXdhcmUvcWNvbV9zY20tMzIuYyB8IDM1
ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL2Zpcm13YXJlL3Fjb21fc2Nt
LTY0LmMgfCAxMiArKysrKysrKysrCiBkcml2ZXJzL2Zpcm13YXJlL3Fjb21fc2NtLmMgICAgfCA0
MCArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL2Zpcm13YXJlL3Fj
b21fc2NtLmggICAgfCAgOSArKysrKysrKwogaW5jbHVkZS9saW51eC9xY29tX3NjbS5oICAgICAg
IHwgMTUgKysrKysrKysrKysrKwogNSBmaWxlcyBjaGFuZ2VkLCAxMTEgaW5zZXJ0aW9ucygrKQoK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZmlybXdhcmUvcWNvbV9zY20tMzIuYyBiL2RyaXZlcnMvZmly
bXdhcmUvcWNvbV9zY20tMzIuYwppbmRleCAyMTUwNjFjNTgxZTEuLjRjMjUxNGU1ZTI0OSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9maXJtd2FyZS9xY29tX3NjbS0zMi5jCisrKyBiL2RyaXZlcnMvZmly
bXdhcmUvcWNvbV9zY20tMzIuYwpAQCAtNDQyLDYgKzQ0Miw0MSBAQCBpbnQgX19xY29tX3NjbV9o
ZGNwX3JlcShzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBxY29tX3NjbV9oZGNwX3JlcSAqcmVx
LAogCQlyZXEsIHJlcV9jbnQgKiBzaXplb2YoKnJlcSksIHJlc3AsIHNpemVvZigqcmVzcCkpOwog
fQogCitpbnQgX19xY29tX3NjbV9vY21lbV9sb2NrKHN0cnVjdCBkZXZpY2UgKmRldiwgdTMyIGlk
LCB1MzIgb2Zmc2V0LCB1MzIgc2l6ZSwKKwkJCSAgdTMyIG1vZGUpCit7CisJc3RydWN0IG9jbWVt
X3R6X2xvY2sgeworCQlfX2xlMzIgaWQ7CisJCV9fbGUzMiBvZmZzZXQ7CisJCV9fbGUzMiBzaXpl
OworCQlfX2xlMzIgbW9kZTsKKwl9IHJlcXVlc3Q7CisKKwlyZXF1ZXN0LmlkID0gY3B1X3RvX2xl
MzIoaWQpOworCXJlcXVlc3Qub2Zmc2V0ID0gY3B1X3RvX2xlMzIob2Zmc2V0KTsKKwlyZXF1ZXN0
LnNpemUgPSBjcHVfdG9fbGUzMihzaXplKTsKKwlyZXF1ZXN0Lm1vZGUgPSBjcHVfdG9fbGUzMiht
b2RlKTsKKworCXJldHVybiBxY29tX3NjbV9jYWxsKGRldiwgUUNPTV9TQ01fT0NNRU1fU1ZDLCBR
Q09NX1NDTV9PQ01FTV9MT0NLX0NNRCwKKwkJCSAgICAgJnJlcXVlc3QsIHNpemVvZihyZXF1ZXN0
KSwgTlVMTCwgMCk7Cit9CisKK2ludCBfX3Fjb21fc2NtX29jbWVtX3VubG9jayhzdHJ1Y3QgZGV2
aWNlICpkZXYsIHUzMiBpZCwgdTMyIG9mZnNldCwgdTMyIHNpemUpCit7CisJc3RydWN0IG9jbWVt
X3R6X3VubG9jayB7CisJCV9fbGUzMiBpZDsKKwkJX19sZTMyIG9mZnNldDsKKwkJX19sZTMyIHNp
emU7CisJfSByZXF1ZXN0OworCisJcmVxdWVzdC5pZCA9IGNwdV90b19sZTMyKGlkKTsKKwlyZXF1
ZXN0Lm9mZnNldCA9IGNwdV90b19sZTMyKG9mZnNldCk7CisJcmVxdWVzdC5zaXplID0gY3B1X3Rv
X2xlMzIoc2l6ZSk7CisKKwlyZXR1cm4gcWNvbV9zY21fY2FsbChkZXYsIFFDT01fU0NNX09DTUVN
X1NWQywgUUNPTV9TQ01fT0NNRU1fVU5MT0NLX0NNRCwKKwkJCSAgICAgJnJlcXVlc3QsIHNpemVv
ZihyZXF1ZXN0KSwgTlVMTCwgMCk7Cit9CisKIHZvaWQgX19xY29tX3NjbV9pbml0KHZvaWQpCiB7
CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2Zpcm13YXJlL3Fjb21fc2NtLTY0LmMgYi9kcml2ZXJz
L2Zpcm13YXJlL3Fjb21fc2NtLTY0LmMKaW5kZXggOTFkNWFkN2NmNThiLi5jM2EzZDk4NzRkZWYg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZmlybXdhcmUvcWNvbV9zY20tNjQuYworKysgYi9kcml2ZXJz
L2Zpcm13YXJlL3Fjb21fc2NtLTY0LmMKQEAgLTI0MSw2ICsyNDEsMTggQEAgaW50IF9fcWNvbV9z
Y21faGRjcF9yZXEoc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1Y3QgcWNvbV9zY21faGRjcF9yZXEg
KnJlcSwKIAlyZXR1cm4gcmV0OwogfQogCitpbnQgX19xY29tX3NjbV9vY21lbV9sb2NrKHN0cnVj
dCBkZXZpY2UgKmRldiwgdWludDMyX3QgaWQsIHVpbnQzMl90IG9mZnNldCwKKwkJCSAgdWludDMy
X3Qgc2l6ZSwgdWludDMyX3QgbW9kZSkKK3sKKwlyZXR1cm4gLUVOT1RTVVBQOworfQorCitpbnQg
X19xY29tX3NjbV9vY21lbV91bmxvY2soc3RydWN0IGRldmljZSAqZGV2LCB1aW50MzJfdCBpZCwg
dWludDMyX3Qgb2Zmc2V0LAorCQkJICAgIHVpbnQzMl90IHNpemUpCit7CisJcmV0dXJuIC1FTk9U
U1VQUDsKK30KKwogdm9pZCBfX3Fjb21fc2NtX2luaXQodm9pZCkKIHsKIAl1NjQgY21kOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9maXJtd2FyZS9xY29tX3NjbS5jIGIvZHJpdmVycy9maXJtd2FyZS9x
Y29tX3NjbS5jCmluZGV4IDQ4MDJhYjE3MGZlNS4uN2UyODVmZjM5NjFkIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2Zpcm13YXJlL3Fjb21fc2NtLmMKKysrIGIvZHJpdmVycy9maXJtd2FyZS9xY29tX3Nj
bS5jCkBAIC0xOTEsNiArMTkxLDQ2IEBAIGJvb2wgcWNvbV9zY21fcGFzX3N1cHBvcnRlZCh1MzIg
cGVyaXBoZXJhbCkKIH0KIEVYUE9SVF9TWU1CT0wocWNvbV9zY21fcGFzX3N1cHBvcnRlZCk7CiAK
Ky8qKgorICogcWNvbV9zY21fb2NtZW1fbG9ja19hdmFpbGFibGUoKSAtIGlzIE9DTUVNIGxvY2sv
dW5sb2NrIGludGVyZmFjZSBhdmFpbGFibGUKKyAqLworYm9vbCBxY29tX3NjbV9vY21lbV9sb2Nr
X2F2YWlsYWJsZSh2b2lkKQoreworCXJldHVybiBfX3Fjb21fc2NtX2lzX2NhbGxfYXZhaWxhYmxl
KF9fc2NtLT5kZXYsIFFDT01fU0NNX09DTUVNX1NWQywKKwkJCQkJICAgIFFDT01fU0NNX09DTUVN
X0xPQ0tfQ01EKTsKK30KK0VYUE9SVF9TWU1CT0wocWNvbV9zY21fb2NtZW1fbG9ja19hdmFpbGFi
bGUpOworCisvKioKKyAqIHFjb21fc2NtX29jbWVtX2xvY2soKSAtIGNhbGwgT0NNRU0gbG9jayBp
bnRlcmZhY2UgdG8gYXNzaWduIGFuIE9DTUVNCisgKiByZWdpb24gdG8gdGhlIHNwZWNpZmllZCBp
bml0aWF0b3IKKyAqCisgKiBAaWQ6ICAgICB0eiBpbml0aWF0b3IgaWQKKyAqIEBvZmZzZXQ6IE9D
TUVNIG9mZnNldAorICogQHNpemU6ICAgT0NNRU0gc2l6ZQorICogQG1vZGU6ICAgYWNjZXNzIG1v
ZGUgKFdJREUvTkFSUk9XKQorICovCitpbnQgcWNvbV9zY21fb2NtZW1fbG9jayhlbnVtIHFjb21f
c2NtX29jbWVtX2NsaWVudCBpZCwgdTMyIG9mZnNldCwgdTMyIHNpemUsCisJCQl1MzIgbW9kZSkK
K3sKKwlyZXR1cm4gX19xY29tX3NjbV9vY21lbV9sb2NrKF9fc2NtLT5kZXYsIGlkLCBvZmZzZXQs
IHNpemUsIG1vZGUpOworfQorRVhQT1JUX1NZTUJPTChxY29tX3NjbV9vY21lbV9sb2NrKTsKKwor
LyoqCisgKiBxY29tX3NjbV9vY21lbV91bmxvY2soKSAtIGNhbGwgT0NNRU0gdW5sb2NrIGludGVy
ZmFjZSB0byByZWxlYXNlIGFuIE9DTUVNCisgKiByZWdpb24gZnJvbSB0aGUgc3BlY2lmaWVkIGlu
aXRpYXRvcgorICoKKyAqIEBpZDogICAgIHR6IGluaXRpYXRvciBpZAorICogQG9mZnNldDogT0NN
RU0gb2Zmc2V0CisgKiBAc2l6ZTogICBPQ01FTSBzaXplCisgKi8KK2ludCBxY29tX3NjbV9vY21l
bV91bmxvY2soZW51bSBxY29tX3NjbV9vY21lbV9jbGllbnQgaWQsIHUzMiBvZmZzZXQsIHUzMiBz
aXplKQoreworCXJldHVybiBfX3Fjb21fc2NtX29jbWVtX3VubG9jayhfX3NjbS0+ZGV2LCBpZCwg
b2Zmc2V0LCBzaXplKTsKK30KK0VYUE9SVF9TWU1CT0wocWNvbV9zY21fb2NtZW1fdW5sb2NrKTsK
KwogLyoqCiAgKiBxY29tX3NjbV9wYXNfaW5pdF9pbWFnZSgpIC0gSW5pdGlhbGl6ZSBwZXJpcGhl
cmFsIGF1dGhlbnRpY2F0aW9uIHNlcnZpY2UKICAqCQkJICAgICAgIHN0YXRlIG1hY2hpbmUgZm9y
IGEgZ2l2ZW4gcGVyaXBoZXJhbCwgdXNpbmcgdGhlCmRpZmYgLS1naXQgYS9kcml2ZXJzL2Zpcm13
YXJlL3Fjb21fc2NtLmggYi9kcml2ZXJzL2Zpcm13YXJlL3Fjb21fc2NtLmgKaW5kZXggOTk1MDZi
ZDg3M2MwLi5lZjI5M2VlNjdlYzEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZmlybXdhcmUvcWNvbV9z
Y20uaAorKysgYi9kcml2ZXJzL2Zpcm13YXJlL3Fjb21fc2NtLmgKQEAgLTQyLDYgKzQyLDE1IEBA
IGV4dGVybiBpbnQgX19xY29tX3NjbV9oZGNwX3JlcShzdHJ1Y3QgZGV2aWNlICpkZXYsCiAKIGV4
dGVybiB2b2lkIF9fcWNvbV9zY21faW5pdCh2b2lkKTsKIAorI2RlZmluZSBRQ09NX1NDTV9PQ01F
TV9TVkMJCQkweGYKKyNkZWZpbmUgUUNPTV9TQ01fT0NNRU1fTE9DS19DTUQJCTB4MQorI2RlZmlu
ZSBRQ09NX1NDTV9PQ01FTV9VTkxPQ0tfQ01ECQkweDIKKworZXh0ZXJuIGludCBfX3Fjb21fc2Nt
X29jbWVtX2xvY2soc3RydWN0IGRldmljZSAqZGV2LCB1MzIgaWQsIHUzMiBvZmZzZXQsCisJCQkJ
IHUzMiBzaXplLCB1MzIgbW9kZSk7CitleHRlcm4gaW50IF9fcWNvbV9zY21fb2NtZW1fdW5sb2Nr
KHN0cnVjdCBkZXZpY2UgKmRldiwgdTMyIGlkLCB1MzIgb2Zmc2V0LAorCQkJCSAgIHUzMiBzaXpl
KTsKKwogI2RlZmluZSBRQ09NX1NDTV9TVkNfUElMCQkweDIKICNkZWZpbmUgUUNPTV9TQ01fUEFT
X0lOSVRfSU1BR0VfQ01ECTB4MQogI2RlZmluZSBRQ09NX1NDTV9QQVNfTUVNX1NFVFVQX0NNRAkw
eDIKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvcWNvbV9zY20uaCBiL2luY2x1ZGUvbGludXgv
cWNvbV9zY20uaAppbmRleCAyZDVlZmY1MDZlMTMuLmI0OWI3MzRkNjYyYyAxMDA2NDQKLS0tIGEv
aW5jbHVkZS9saW51eC9xY29tX3NjbS5oCisrKyBiL2luY2x1ZGUvbGludXgvcWNvbV9zY20uaApA
QCAtMjQsNiArMjQsMTYgQEAgc3RydWN0IHFjb21fc2NtX3ZtcGVybSB7CiAJaW50IHBlcm07CiB9
OwogCitlbnVtIHFjb21fc2NtX29jbWVtX2NsaWVudCB7CisJUUNPTV9TQ01fT0NNRU1fVU5VU0VE
X0lEID0gMHgwLAorCVFDT01fU0NNX09DTUVNX0dSQVBISUNTX0lELAorCVFDT01fU0NNX09DTUVN
X1ZJREVPX0lELAorCVFDT01fU0NNX09DTUVNX0xQX0FVRElPX0lELAorCVFDT01fU0NNX09DTUVN
X1NFTlNPUlNfSUQsCisJUUNPTV9TQ01fT0NNRU1fT1RIRVJfT1NfSUQsCisJUUNPTV9TQ01fT0NN
RU1fREVCVUdfSUQsCit9OworCiAjZGVmaW5lIFFDT01fU0NNX1ZNSURfSExPUyAgICAgICAweDMK
ICNkZWZpbmUgUUNPTV9TQ01fVk1JRF9NU1NfTVNBICAgIDB4RgogI2RlZmluZSBRQ09NX1NDTV9W
TUlEX1dMQU4gICAgICAgMHgxOApAQCAtNDEsNiArNTEsMTEgQEAgZXh0ZXJuIGJvb2wgcWNvbV9z
Y21faXNfYXZhaWxhYmxlKHZvaWQpOwogZXh0ZXJuIGJvb2wgcWNvbV9zY21faGRjcF9hdmFpbGFi
bGUodm9pZCk7CiBleHRlcm4gaW50IHFjb21fc2NtX2hkY3BfcmVxKHN0cnVjdCBxY29tX3NjbV9o
ZGNwX3JlcSAqcmVxLCB1MzIgcmVxX2NudCwKIAkJCSAgICAgdTMyICpyZXNwKTsKK2V4dGVybiBi
b29sIHFjb21fc2NtX29jbWVtX2xvY2tfYXZhaWxhYmxlKHZvaWQpOworZXh0ZXJuIGludCBxY29t
X3NjbV9vY21lbV9sb2NrKGVudW0gcWNvbV9zY21fb2NtZW1fY2xpZW50IGlkLCB1MzIgb2Zmc2V0
LAorCQkJICAgICAgIHUzMiBzaXplLCB1MzIgbW9kZSk7CitleHRlcm4gaW50IHFjb21fc2NtX29j
bWVtX3VubG9jayhlbnVtIHFjb21fc2NtX29jbWVtX2NsaWVudCBpZCwgdTMyIG9mZnNldCwKKwkJ
CQkgdTMyIHNpemUpOwogZXh0ZXJuIGJvb2wgcWNvbV9zY21fcGFzX3N1cHBvcnRlZCh1MzIgcGVy
aXBoZXJhbCk7CiBleHRlcm4gaW50IHFjb21fc2NtX3Bhc19pbml0X2ltYWdlKHUzMiBwZXJpcGhl
cmFsLCBjb25zdCB2b2lkICptZXRhZGF0YSwKIAkJCQkgICBzaXplX3Qgc2l6ZSk7Ci0tIAoyLjIx
LjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1k
ZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczov
L2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
