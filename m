Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1012F22E97
	for <lists+dri-devel@lfdr.de>; Mon, 20 May 2019 10:24:16 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D00E389321;
	Mon, 20 May 2019 08:23:08 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x543.google.com (mail-ed1-x543.google.com
 [IPv6:2a00:1450:4864:20::543])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4D8E2892CC
 for <dri-devel@lists.freedesktop.org>; Mon, 20 May 2019 08:23:00 +0000 (UTC)
Received: by mail-ed1-x543.google.com with SMTP id n17so22609593edb.0
 for <dri-devel@lists.freedesktop.org>; Mon, 20 May 2019 01:23:00 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=gP9JWtZYIDChqhoaVz3EsPvoQXah1TnF7aRj3vegt3E=;
 b=SsYKxj3mX6V++9pC/6x+icqjIwQFiw4XOf1zkdaxIi+cUD8umt9BAFhXqKa9qi8/53
 lOIT0rRPqK9WniJSpPn2c4D96eqO+5nn2TrfQhmLzWmWXXlTtYyyULWCigQe1/0L/wJ5
 JWYYAUYfvPHrIUTbV15pmRxMvCh22sCLoeUcHE9jANdT9+fv4ZXjVbp1eQwe19uewYVG
 TPFRN2a56wNwaGfdxu5o54HcisorTXb27EBvBgNE2DNY6D2PeI+wqFgXFHK5eA+EIPY0
 vWmz0lRwWRPcD17FaGCuDjYyQmLxXVb+F9bAdFY6cPTR+DqpPXR3aJYYV+4uu+8AkHOp
 Q8uA==
X-Gm-Message-State: APjAAAUZdDCswF1kcbWVLeE2ITBXvsuGzHH7Jge0fnrHEKZNjYgyRRgu
 T2+P9bHqAr9ctWjJTN/bfq2u2qcdQRw=
X-Google-Smtp-Source: APXvYqzSe/uoCy8plrFShz+D+0lTuXDe8CAAGZgk03dqPaYS7lZWXOEAi0arPyI9QcUZ0NHbZhWtTQ==
X-Received: by 2002:a17:906:8311:: with SMTP id
 j17mr32001014ejx.227.1558340577317; 
 Mon, 20 May 2019 01:22:57 -0700 (PDT)
Received: from phenom.ffwll.local ([2a02:168:569e:0:3106:d637:d723:e855])
 by smtp.gmail.com with ESMTPSA id t25sm3021263ejx.8.2019.05.20.01.22.56
 (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
 Mon, 20 May 2019 01:22:56 -0700 (PDT)
From: Daniel Vetter <daniel.vetter@ffwll.ch>
To: DRI Development <dri-devel@lists.freedesktop.org>
Subject: [PATCH 30/33] vgaswitcheroo: call fbcon_remap_all directly
Date: Mon, 20 May 2019 10:22:13 +0200
Message-Id: <20190520082216.26273-31-daniel.vetter@ffwll.ch>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190520082216.26273-1-daniel.vetter@ffwll.ch>
References: <20190520082216.26273-1-daniel.vetter@ffwll.ch>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ffwll.ch; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=gP9JWtZYIDChqhoaVz3EsPvoQXah1TnF7aRj3vegt3E=;
 b=BUP+ZVHpSa6cm0eQ2i5P1I8TI4De/3rS6Ui4iYSGE+J5pYNyl3gfHlOQEBrM87Khlv
 cmiALWLfTnw2dtMq3P7g/q1F6wThHrEk8buZl4oanGqblRMMZmgwQMeAsYNtDMNs4cwx
 qW8Cp2AQc8vCtMxYwY4yv2TiXOCexYNIQBfi4=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Hans de Goede <hdegoede@redhat.com>,
 Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>,
 David Airlie <airlied@linux.ie>, Daniel Vetter <daniel.vetter@ffwll.ch>,
 Intel Graphics Development <intel-gfx@lists.freedesktop.org>,
 LKML <linux-kernel@vger.kernel.org>, linux-fbdev@vger.kernel.org,
 Yisheng Xie <ysxie@foxmail.com>, Maxime Ripard <maxime.ripard@bootlin.com>,
 Daniel Vetter <daniel.vetter@intel.com>, Sean Paul <sean@poorly.run>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

V2hpbGUgYXQgaXQsIGNsZWFuIHVwIHRoZSBpbnRlcmZhY2UgYSBiaXQgYW5kIHB1c2ggdGhlIGNv
bnNvbGUgbG9ja2luZwppbnRvIGZiY29uLmMuCgpTaWduZWQtb2ZmLWJ5OiBEYW5pZWwgVmV0dGVy
IDxkYW5pZWwudmV0dGVyQGludGVsLmNvbT4KQ2M6IEx1a2FzIFd1bm5lciA8bHVrYXNAd3VubmVy
LmRlPgpDYzogRGF2aWQgQWlybGllIDxhaXJsaWVkQGxpbnV4LmllPgpDYzogRGFuaWVsIFZldHRl
ciA8ZGFuaWVsQGZmd2xsLmNoPgpDYzogTWFhcnRlbiBMYW5raG9yc3QgPG1hYXJ0ZW4ubGFua2hv
cnN0QGxpbnV4LmludGVsLmNvbT4KQ2M6IE1heGltZSBSaXBhcmQgPG1heGltZS5yaXBhcmRAYm9v
dGxpbi5jb20+CkNjOiBTZWFuIFBhdWwgPHNlYW5AcG9vcmx5LnJ1bj4KQ2M6IEJhcnRsb21pZWog
Wm9sbmllcmtpZXdpY3ogPGIuem9sbmllcmtpZUBzYW1zdW5nLmNvbT4KQ2M6IEhhbnMgZGUgR29l
ZGUgPGhkZWdvZWRlQHJlZGhhdC5jb20+CkNjOiBZaXNoZW5nIFhpZSA8eXN4aWVAZm94bWFpbC5j
b20+CkNjOiBsaW51eC1mYmRldkB2Z2VyLmtlcm5lbC5vcmcKLS0tCiBkcml2ZXJzL2dwdS92Z2Ev
dmdhX3N3aXRjaGVyb28uYyB8IDExICsrKy0tLS0tLS0tCiBkcml2ZXJzL3ZpZGVvL2ZiZGV2L2Nv
cmUvZmJjb24uYyB8IDEzICsrKysrLS0tLS0tLS0KIGluY2x1ZGUvbGludXgvZmIuaCAgICAgICAg
ICAgICAgIHwgIDIgLS0KIGluY2x1ZGUvbGludXgvZmJjb24uaCAgICAgICAgICAgIHwgIDIgKysK
IDQgZmlsZXMgY2hhbmdlZCwgMTAgaW5zZXJ0aW9ucygrKSwgMTggZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvdmdhL3ZnYV9zd2l0Y2hlcm9vLmMgYi9kcml2ZXJzL2dwdS92
Z2EvdmdhX3N3aXRjaGVyb28uYwppbmRleCBhMTMyYzM3ZDczMzQuLjY1ZDc1NDFjNDEzYSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvdmdhL3ZnYV9zd2l0Y2hlcm9vLmMKKysrIGIvZHJpdmVycy9n
cHUvdmdhL3ZnYV9zd2l0Y2hlcm9vLmMKQEAgLTM1LDYgKzM1LDcgQEAKICNpbmNsdWRlIDxsaW51
eC9kZWJ1Z2ZzLmg+CiAjaW5jbHVkZSA8bGludXgvZmIuaD4KICNpbmNsdWRlIDxsaW51eC9mcy5o
PgorI2luY2x1ZGUgPGxpbnV4L2ZiY29uLmg+CiAjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+CiAj
aW5jbHVkZSA8bGludXgvcGNpLmg+CiAjaW5jbHVkZSA8bGludXgvcG1fZG9tYWluLmg+CkBAIC03
MzYsMTQgKzczNyw4IEBAIHN0YXRpYyBpbnQgdmdhX3N3aXRjaHRvX3N0YWdlMihzdHJ1Y3Qgdmdh
X3N3aXRjaGVyb29fY2xpZW50ICpuZXdfY2xpZW50KQogCWlmICghYWN0aXZlLT5kcml2ZXJfcG93
ZXJfY29udHJvbCkKIAkJc2V0X2F1ZGlvX3N0YXRlKGFjdGl2ZS0+aWQsIFZHQV9TV0lUQ0hFUk9P
X09GRik7CiAKLQlpZiAobmV3X2NsaWVudC0+ZmJfaW5mbykgewotCQlzdHJ1Y3QgZmJfZXZlbnQg
ZXZlbnQ7Ci0KLQkJY29uc29sZV9sb2NrKCk7Ci0JCWV2ZW50LmluZm8gPSBuZXdfY2xpZW50LT5m
Yl9pbmZvOwotCQlmYl9ub3RpZmllcl9jYWxsX2NoYWluKEZCX0VWRU5UX1JFTUFQX0FMTF9DT05T
T0xFLCAmZXZlbnQpOwotCQljb25zb2xlX3VubG9jaygpOwotCX0KKwlpZiAobmV3X2NsaWVudC0+
ZmJfaW5mbykKKwkJZmJjb25fcmVtYXBfYWxsKG5ld19jbGllbnQtPmZiX2luZm8pOwogCiAJbXV0
ZXhfbG9jaygmdmdhc3JfcHJpdi5tdXhfaHdfbG9jayk7CiAJcmV0ID0gdmdhc3JfcHJpdi5oYW5k
bGVyLT5zd2l0Y2h0byhuZXdfY2xpZW50LT5pZCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL3ZpZGVv
L2ZiZGV2L2NvcmUvZmJjb24uYyBiL2RyaXZlcnMvdmlkZW8vZmJkZXYvY29yZS9mYmNvbi5jCmlu
ZGV4IDhjYzYyZDM0MDM4Ny4uZmQ2MDRmZmIzYzA1IDEwMDY0NAotLS0gYS9kcml2ZXJzL3ZpZGVv
L2ZiZGV2L2NvcmUvZmJjb24uYworKysgYi9kcml2ZXJzL3ZpZGVvL2ZiZGV2L2NvcmUvZmJjb24u
YwpAQCAtMzE0NiwxNiArMzE0NiwxNiBAQCB2b2lkIGZiY29uX2ZiX3VucmVnaXN0ZXJlZChzdHJ1
Y3QgZmJfaW5mbyAqaW5mbykKIH0KIAogLyogY2FsbGVkIHdpdGggY29uc29sZV9sb2NrIGhlbGQg
Ki8KLXN0YXRpYyB2b2lkIGZiY29uX3JlbWFwX2FsbChpbnQgaWR4KQordm9pZCBmYmNvbl9yZW1h
cF9hbGwoc3RydWN0IGZiX2luZm8gKmluZm8pCiB7Ci0JaW50IGk7Ci0KLQlXQVJOX0NPTlNPTEVf
VU5MT0NLRUQoKTsKKwlpbnQgaSwgaWR4ID0gaW5mby0+bm9kZTsKIAorCWNvbnNvbGVfbG9jaygp
OwogCWlmIChkZWZlcnJlZF90YWtlb3ZlcikgewogCQlmb3IgKGkgPSBmaXJzdF9mYl92YzsgaSA8
PSBsYXN0X2ZiX3ZjOyBpKyspCiAJCQljb24yZmJfbWFwX2Jvb3RbaV0gPSBpZHg7CiAJCWZiY29u
X21hcF9vdmVycmlkZSgpOworCQljb25zb2xlX3VubG9jaygpOwogCQlyZXR1cm47CiAJfQogCkBA
IC0zMTY4LDYgKzMxNjgsNyBAQCBzdGF0aWMgdm9pZCBmYmNvbl9yZW1hcF9hbGwoaW50IGlkeCkK
IAkJICAgICAgIGZpcnN0X2ZiX3ZjICsgMSwgbGFzdF9mYl92YyArIDEpOwogCQlpbmZvX2lkeCA9
IGlkeDsKIAl9CisJY29uc29sZV91bmxvY2soKTsKIH0KIAogI2lmZGVmIENPTkZJR19GUkFNRUJV
RkZFUl9DT05TT0xFX0RFVEVDVF9QUklNQVJZCkBAIC0zMzMzLDEwICszMzM0LDYgQEAgc3RhdGlj
IGludCBmYmNvbl9ldmVudF9ub3RpZnkoc3RydWN0IG5vdGlmaWVyX2Jsb2NrICpzZWxmLAogCQlj
b24yZmIgPSBldmVudC0+ZGF0YTsKIAkJY29uMmZiLT5mcmFtZWJ1ZmZlciA9IGNvbjJmYl9tYXBb
Y29uMmZiLT5jb25zb2xlIC0gMV07CiAJCWJyZWFrOwotCWNhc2UgRkJfRVZFTlRfUkVNQVBfQUxM
X0NPTlNPTEU6Ci0JCWlkeCA9IGluZm8tPm5vZGU7Ci0JCWZiY29uX3JlbWFwX2FsbChpZHgpOwot
CQlicmVhazsKIAl9CiAJcmV0dXJuIHJldDsKIH0KZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgv
ZmIuaCBiL2luY2x1ZGUvbGludXgvZmIuaAppbmRleCA1NGQ2YmVlMDkxMjEuLmFjZDhkYWEyMzAw
MiAxMDA2NDQKLS0tIGEvaW5jbHVkZS9saW51eC9mYi5oCisrKyBiL2luY2x1ZGUvbGludXgvZmIu
aApAQCAtMTMwLDggKzEzMCw2IEBAIHN0cnVjdCBmYl9jdXJzb3JfdXNlciB7CiAjZGVmaW5lIEZC
X0VWRU5UX1NFVF9DT05TT0xFX01BUCAgICAgICAgMHgwOAogLyogICAgICBBIGRpc3BsYXkgYmxh
bmsgaXMgcmVxdWVzdGVkICAgICAgICovCiAjZGVmaW5lIEZCX0VWRU5UX0JMQU5LICAgICAgICAg
ICAgICAgICAgMHgwOQotLyogICAgICBDT05TT0xFLVNQRUNJRklDOiByZW1hcCBhbGwgY29uc29s
ZXMgdG8gbmV3IGZiIC0gZm9yIHZnYV9zd2l0Y2hlcm9vICovCi0jZGVmaW5lIEZCX0VWRU5UX1JF
TUFQX0FMTF9DT05TT0xFICAgICAgMHgwRgogLyogICAgICBBIGhhcmR3YXJlIGRpc3BsYXkgYmxh
bmsgZWFybHkgY2hhbmdlIG9jY3VycmVkICovCiAjZGVmaW5lIEZCX0VBUkxZX0VWRU5UX0JMQU5L
CQkweDEwCiAvKiAgICAgIEEgaGFyZHdhcmUgZGlzcGxheSBibGFuayByZXZlcnQgZWFybHkgY2hh
bmdlIG9jY3VycmVkICovCmRpZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L2ZiY29uLmggYi9pbmNs
dWRlL2xpbnV4L2ZiY29uLmgKaW5kZXggZGFhYTk3YjBjOWU2Li4zZjg1NGU4MDM3NDYgMTAwNjQ0
Ci0tLSBhL2luY2x1ZGUvbGludXgvZmJjb24uaAorKysgYi9pbmNsdWRlL2xpbnV4L2ZiY29uLmgK
QEAgLTE2LDYgKzE2LDcgQEAgdm9pZCBmYmNvbl9nZXRfcmVxdWlyZW1lbnQoc3RydWN0IGZiX2lu
Zm8gKmluZm8sCiAJCQkgICBzdHJ1Y3QgZmJfYmxpdF9jYXBzICpjYXBzKTsKIHZvaWQgZmJjb25f
ZmJfYmxhbmtlZChzdHJ1Y3QgZmJfaW5mbyAqaW5mbywgaW50IGJsYW5rKTsKIHZvaWQgZmJjb25f
dXBkYXRlX3ZjcyhzdHJ1Y3QgZmJfaW5mbyAqaW5mbywgYm9vbCBhbGwpOwordm9pZCBmYmNvbl9y
ZW1hcF9hbGwoc3RydWN0IGZiX2luZm8gKmluZm8pOwogI2Vsc2UKIHN0YXRpYyBpbmxpbmUgdm9p
ZCBmYl9jb25zb2xlX2luaXQodm9pZCkge30KIHN0YXRpYyBpbmxpbmUgdm9pZCBmYl9jb25zb2xl
X2V4aXQodm9pZCkge30KQEAgLTMxLDYgKzMyLDcgQEAgdm9pZCBmYmNvbl9nZXRfcmVxdWlyZW1l
bnQoc3RydWN0IGZiX2luZm8gKmluZm8sCiAJCQkgICBzdHJ1Y3QgZmJfYmxpdF9jYXBzICpjYXBz
KSB7fQogdm9pZCBmYmNvbl9mYl9ibGFua2VkKHN0cnVjdCBmYl9pbmZvICppbmZvLCBpbnQgYmxh
bmspIHt9CiB2b2lkIGZiY29uX3VwZGF0ZV92Y3Moc3RydWN0IGZiX2luZm8gKmluZm8sIGJvb2wg
YWxsKSB7fQordm9pZCBmYmNvbl9yZW1hcF9hbGwoc3RydWN0IGZiX2luZm8gKmluZm8pIHt9CiAj
ZW5kaWYKIAogI2VuZGlmIC8qIF9MSU5VWF9GQkNPTl9IICovCi0tIAoyLjIwLjEKCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5n
IGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVk
ZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
