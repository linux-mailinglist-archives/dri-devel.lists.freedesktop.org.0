Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 2DF5198847
	for <lists+dri-devel@lfdr.de>; Thu, 22 Aug 2019 02:02:30 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 514C06E3CB;
	Thu, 22 Aug 2019 00:02:27 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from perceval.ideasonboard.com (perceval.ideasonboard.com
 [IPv6:2001:4b98:dc2:55:216:3eff:fef7:d647])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8F4126E3CB
 for <dri-devel@lists.freedesktop.org>; Thu, 22 Aug 2019 00:02:25 +0000 (UTC)
Received: from pendragon.ideasonboard.com
 (dfj612yhrgyx302h3jwwy-3.rev.dnainternet.fi
 [IPv6:2001:14ba:21f5:5b00:ce28:277f:58d7:3ca4])
 by perceval.ideasonboard.com (Postfix) with ESMTPSA id D221B2DF;
 Thu, 22 Aug 2019 02:02:23 +0200 (CEST)
Date: Thu, 22 Aug 2019 03:02:17 +0300
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
To: Boris Brezillon <boris.brezillon@collabora.com>
Subject: Re: [PATCH RFC 11/19] drm/bridge: Patch atomic hooks to take a
 drm_bridge_state
Message-ID: <20190822000217.GB16985@pendragon.ideasonboard.com>
References: <20190808151150.16336-1-boris.brezillon@collabora.com>
 <20190808151150.16336-12-boris.brezillon@collabora.com>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <20190808151150.16336-12-boris.brezillon@collabora.com>
User-Agent: Mutt/1.10.1 (2018-07-13)
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=ideasonboard.com; s=mail; t=1566432144;
 bh=6IePsZDXKAnwYoIMWVFjw7dthGZ5Jx7mfz+eYP5Bvcw=;
 h=Date:From:To:Cc:Subject:References:In-Reply-To:From;
 b=ew1BUbfvAtpZhbqKGDipfI5VqSPpstLSKHVlUqY0obfWmueuYcf4cPRaQxo5ADlKb
 UsuOp0JpHgaupMQe9jwPKS9usS65zk/bQQmpzTvr25aDCarIP2Q7JOSRbfbx2cSY39
 wt+/h1W+uCtIu2N3hioNU80+smOmCHv7rY9q39IQ=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Jernej Skrabec <jernej.skrabec@siol.net>,
 Neil Armstrong <narmstrong@baylibre.com>, Jonas Karlman <jonas@kwiboo.se>,
 Seung-Woo Kim <sw0312.kim@samsung.com>, dri-devel@lists.freedesktop.org,
 Kyungmin Park <kyungmin.park@samsung.com>,
 Thierry Reding <thierry.reding@gmail.com>, Chris Healy <Chris.Healy@zii.aero>,
 kernel@collabora.com, Sam Ravnborg <sam@ravnborg.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SGkgQm9yaXMsCgpUaGFuayB5b3UgZm9yIHRoZSBwYXRjaC4KCk9uIFRodSwgQXVnIDA4LCAyMDE5
IGF0IDA1OjExOjQyUE0gKzAyMDAsIEJvcmlzIEJyZXppbGxvbiB3cm90ZToKPiBJbnN0ZWFkIG9m
IGEgZHJtX2F0b21pY19zdGF0ZS4gVGhlIG9ubHkgZHJpdmVyIGltcGxlbWVudGluZyB0aG9zZSBo
b29rcwo+IGlzIHBhdGNoZWQgdG9vLgo+IAo+IFNpZ25lZC1vZmYtYnk6IEJvcmlzIEJyZXppbGxv
biA8Ym9yaXMuYnJlemlsbG9uQGNvbGxhYm9yYS5jb20+Cj4gLS0tCj4gIC4uLi9kcm0vYnJpZGdl
L2FuYWxvZ2l4L2FuYWxvZ2l4X2RwX2NvcmUuYyAgICB8IDEyICsrLS0KPiAgZHJpdmVycy9ncHUv
ZHJtL2RybV9icmlkZ2UuYyAgICAgICAgICAgICAgICAgIHwgNTcgKysrKysrKysrKysrKysrLS0t
LQo+ICBpbmNsdWRlL2RybS9kcm1fYnJpZGdlLmggICAgICAgICAgICAgICAgICAgICAgfCAgOCAr
LS0KPiAgMyBmaWxlcyBjaGFuZ2VkLCA1NyBpbnNlcnRpb25zKCspLCAyMCBkZWxldGlvbnMoLSkK
PiAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9hbmFsb2dp
eF9kcF9jb3JlLmMgYi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L2FuYWxvZ2l4X2Rw
X2NvcmUuYwo+IGluZGV4IGIwOTZhN2E3NWMxNC4uMDJiOWVlMGU0ZjdhIDEwMDY0NAo+IC0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvYW5hbG9naXhfZHBfY29yZS5jCj4gKysr
IGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9hbmFsb2dpeF9kcF9jb3JlLmMKPiBA
QCAtMTI5MCw4ICsxMjkwLDkgQEAgc3RydWN0IGRybV9jcnRjICphbmFsb2dpeF9kcF9nZXRfbmV3
X2NydGMoc3RydWN0IGFuYWxvZ2l4X2RwX2RldmljZSAqZHAsCj4gIH0KPiAgCj4gIHN0YXRpYyB2
b2lkIGFuYWxvZ2l4X2RwX2JyaWRnZV9hdG9taWNfcHJlX2VuYWJsZShzdHJ1Y3QgZHJtX2JyaWRn
ZSAqYnJpZGdlLAo+IC0JCQkJCQkgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICsJ
CQkJCQkgc3RydWN0IGRybV9icmlkZ2Vfc3RhdGUgKmJzdGF0ZSkKPiAgewo+ICsJc3RydWN0IGRy
bV9hdG9taWNfc3RhdGUgKnN0YXRlID0gYnN0YXRlLT5iYXNlLnN0YXRlOwo+ICAJc3RydWN0IGFu
YWxvZ2l4X2RwX2RldmljZSAqZHAgPSBicmlkZ2UtPmRyaXZlcl9wcml2YXRlOwo+ICAJc3RydWN0
IGRybV9jcnRjICpjcnRjOwo+ICAJc3RydWN0IGRybV9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0
ZTsKPiBAQCAtMTM2Nyw4ICsxMzY4LDkgQEAgc3RhdGljIGludCBhbmFsb2dpeF9kcF9zZXRfYnJp
ZGdlKHN0cnVjdCBhbmFsb2dpeF9kcF9kZXZpY2UgKmRwKQo+ICB9Cj4gIAo+ICBzdGF0aWMgdm9p
ZCBhbmFsb2dpeF9kcF9icmlkZ2VfYXRvbWljX2VuYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJp
ZGdlLAo+IC0JCQkJCSAgICAgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICsJCQkJ
CSAgICAgc3RydWN0IGRybV9icmlkZ2Vfc3RhdGUgKmJzdGF0ZSkKPiAgewo+ICsJc3RydWN0IGRy
bV9hdG9taWNfc3RhdGUgKnN0YXRlID0gYnN0YXRlLT5iYXNlLnN0YXRlOwo+ICAJc3RydWN0IGFu
YWxvZ2l4X2RwX2RldmljZSAqZHAgPSBicmlkZ2UtPmRyaXZlcl9wcml2YXRlOwo+ICAJc3RydWN0
IGRybV9jcnRjICpjcnRjOwo+ICAJc3RydWN0IGRybV9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0
ZTsKPiBAQCAtMTQ0MSw4ICsxNDQzLDkgQEAgc3RhdGljIHZvaWQgYW5hbG9naXhfZHBfYnJpZGdl
X2Rpc2FibGUoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSkKPiAgfQo+ICAKPiAgc3RhdGljIHZv
aWQgYW5hbG9naXhfZHBfYnJpZGdlX2F0b21pY19kaXNhYmxlKHN0cnVjdCBkcm1fYnJpZGdlICpi
cmlkZ2UsCj4gLQkJCQkJICAgICAgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICsJ
CQkJCSAgICAgIHN0cnVjdCBkcm1fYnJpZGdlX3N0YXRlICpic3RhdGUpCj4gIHsKPiArCXN0cnVj
dCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSA9IGJzdGF0ZS0+YmFzZS5zdGF0ZTsKPiAgCXN0cnVj
dCBhbmFsb2dpeF9kcF9kZXZpY2UgKmRwID0gYnJpZGdlLT5kcml2ZXJfcHJpdmF0ZTsKPiAgCXN0
cnVjdCBkcm1fY3J0YyAqY3J0YzsKPiAgCXN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqbmV3X2NydGNf
c3RhdGUgPSBOVUxMOwo+IEBAIC0xNDY1LDggKzE0NjgsOSBAQCBzdGF0aWMgdm9pZCBhbmFsb2dp
eF9kcF9icmlkZ2VfYXRvbWljX2Rpc2FibGUoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSwKPiAg
Cj4gIHN0YXRpYwo+ICB2b2lkIGFuYWxvZ2l4X2RwX2JyaWRnZV9hdG9taWNfcG9zdF9kaXNhYmxl
KHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UsCj4gLQkJCQkJICAgIHN0cnVjdCBkcm1fYXRvbWlj
X3N0YXRlICpzdGF0ZSkKPiArCQkJCQkgICAgc3RydWN0IGRybV9icmlkZ2Vfc3RhdGUgKmJzdGF0
ZSkKPiAgewo+ICsJc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gYnN0YXRlLT5iYXNl
LnN0YXRlOwo+ICAJc3RydWN0IGFuYWxvZ2l4X2RwX2RldmljZSAqZHAgPSBicmlkZ2UtPmRyaXZl
cl9wcml2YXRlOwo+ICAJc3RydWN0IGRybV9jcnRjICpjcnRjOwo+ICAJc3RydWN0IGRybV9jcnRj
X3N0YXRlICpuZXdfY3J0Y19zdGF0ZTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2Ry
bV9icmlkZ2UuYyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fYnJpZGdlLmMKPiBpbmRleCAwMjgwZGE2
YmUxZTYuLjA1MjhjYTk0MTg1NSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2Jy
aWRnZS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2RybV9icmlkZ2UuYwo+IEBAIC00NjcsMTAg
KzQ2NywxOCBAQCB2b2lkIGRybV9hdG9taWNfYnJpZGdlX2NoYWluX2Rpc2FibGUoc3RydWN0IGRy
bV9lbmNvZGVyICplbmNvZGVyLAo+ICAKPiAgCWxpc3RfZm9yX2VhY2hfZW50cnlfcmV2ZXJzZShi
cmlkZ2UsICZlbmNvZGVyLT5icmlkZ2VfY2hhaW4sCj4gIAkJCQkgICAgY2hhaW5fbm9kZSkgewo+
IC0JCWlmIChicmlkZ2UtPmZ1bmNzLT5hdG9taWNfZGlzYWJsZSkKPiAtCQkJYnJpZGdlLT5mdW5j
cy0+YXRvbWljX2Rpc2FibGUoYnJpZGdlLCBzdGF0ZSk7Cj4gLQkJZWxzZSBpZiAoYnJpZGdlLT5m
dW5jcy0+ZGlzYWJsZSkKPiArCQlpZiAoYnJpZGdlLT5mdW5jcy0+YXRvbWljX2Rpc2FibGUpIHsK
PiArCQkJc3RydWN0IGRybV9icmlkZ2Vfc3RhdGUgKmJyaWRnZV9zdGF0ZTsKPiArCj4gKwkJCWJy
aWRnZV9zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X29sZF9icmlkZ2Vfc3RhdGUoc3RhdGUsCj4gKwkJ
CQkJCQkJICAgICAgIGJyaWRnZSk7Cj4gKwkJCWlmIChXQVJOX09OKCFicmlkZ2Vfc3RhdGUpKQo+
ICsJCQkJcmV0dXJuOwo+ICsKPiArCQkJYnJpZGdlLT5mdW5jcy0+YXRvbWljX2Rpc2FibGUoYnJp
ZGdlLCBicmlkZ2Vfc3RhdGUpOwo+ICsJCX0gZWxzZSBpZiAoYnJpZGdlLT5mdW5jcy0+ZGlzYWJs
ZSkgewo+ICAJCQlicmlkZ2UtPmZ1bmNzLT5kaXNhYmxlKGJyaWRnZSk7Cj4gKwkJfQo+ICAJfQo+
ICB9Cj4gIEVYUE9SVF9TWU1CT0woZHJtX2F0b21pY19icmlkZ2VfY2hhaW5fZGlzYWJsZSk7Cj4g
QEAgLTQ5MiwxMCArNTAwLDE5IEBAIHZvaWQgZHJtX2F0b21pY19icmlkZ2VfY2hhaW5fcG9zdF9k
aXNhYmxlKHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlciwKPiAgCXN0cnVjdCBkcm1fYnJpZGdl
ICpicmlkZ2U7Cj4gIAo+ICAJbGlzdF9mb3JfZWFjaF9lbnRyeShicmlkZ2UsICZlbmNvZGVyLT5i
cmlkZ2VfY2hhaW4sIGNoYWluX25vZGUpIHsKPiAtCQlpZiAoYnJpZGdlLT5mdW5jcy0+YXRvbWlj
X3Bvc3RfZGlzYWJsZSkKPiAtCQkJYnJpZGdlLT5mdW5jcy0+YXRvbWljX3Bvc3RfZGlzYWJsZShi
cmlkZ2UsIHN0YXRlKTsKPiAtCQllbHNlIGlmIChicmlkZ2UtPmZ1bmNzLT5wb3N0X2Rpc2FibGUp
Cj4gKwkJaWYgKGJyaWRnZS0+ZnVuY3MtPmF0b21pY19wb3N0X2Rpc2FibGUpIHsKPiArCQkJc3Ry
dWN0IGRybV9icmlkZ2Vfc3RhdGUgKmJyaWRnZV9zdGF0ZTsKPiArCj4gKwkJCWJyaWRnZV9zdGF0
ZSA9IGRybV9hdG9taWNfZ2V0X29sZF9icmlkZ2Vfc3RhdGUoc3RhdGUsCj4gKwkJCQkJCQkJICAg
ICAgIGJyaWRnZSk7Cj4gKwkJCWlmIChXQVJOX09OKCFicmlkZ2Vfc3RhdGUpKQo+ICsJCQkJcmV0
dXJuOwo+ICsKPiArCQkJYnJpZGdlLT5mdW5jcy0+YXRvbWljX3Bvc3RfZGlzYWJsZShicmlkZ2Us
Cj4gKwkJCQkJCQkgICBicmlkZ2Vfc3RhdGUpOwo+ICsJCX0gZWxzZSBpZiAoYnJpZGdlLT5mdW5j
cy0+cG9zdF9kaXNhYmxlKSB7Cj4gIAkJCWJyaWRnZS0+ZnVuY3MtPnBvc3RfZGlzYWJsZShicmlk
Z2UpOwo+ICsJCX0KPiAgCX0KPiAgfQo+ICBFWFBPUlRfU1lNQk9MKGRybV9hdG9taWNfYnJpZGdl
X2NoYWluX3Bvc3RfZGlzYWJsZSk7Cj4gQEAgLTUxOCwxMCArNTM1LDE4IEBAIHZvaWQgZHJtX2F0
b21pY19icmlkZ2VfY2hhaW5fcHJlX2VuYWJsZShzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIs
Cj4gIAo+ICAJbGlzdF9mb3JfZWFjaF9lbnRyeV9yZXZlcnNlKGJyaWRnZSwgJmVuY29kZXItPmJy
aWRnZV9jaGFpbiwKPiAgCQkJCSAgICBjaGFpbl9ub2RlKSB7Cj4gLQkJaWYgKGJyaWRnZS0+ZnVu
Y3MtPmF0b21pY19wcmVfZW5hYmxlKQo+IC0JCQlicmlkZ2UtPmZ1bmNzLT5hdG9taWNfcHJlX2Vu
YWJsZShicmlkZ2UsIHN0YXRlKTsKPiAtCQllbHNlIGlmIChicmlkZ2UtPmZ1bmNzLT5wcmVfZW5h
YmxlKQo+ICsJCWlmIChicmlkZ2UtPmZ1bmNzLT5hdG9taWNfcHJlX2VuYWJsZSkgewo+ICsJCQlz
dHJ1Y3QgZHJtX2JyaWRnZV9zdGF0ZSAqYnJpZGdlX3N0YXRlOwo+ICsKPiArCQkJYnJpZGdlX3N0
YXRlID0gZHJtX2F0b21pY19nZXRfbmV3X2JyaWRnZV9zdGF0ZShzdGF0ZSwKPiArCQkJCQkJCQkg
ICAgICAgYnJpZGdlKTsKClNob3VsZG4ndCB5b3UgZ2V0IHRoZSBvbGQgc3RhdGUgaGVyZSA/IFRo
ZSBuZXcgc3RhdGUgaW4gY29tbWl0LXJlbGF0ZWQKb3BlcmF0aW9ucyBpcyBzdXBwb3NlZCB0byBi
ZSBvYnRhaW5lZCBmcm9tIHRoZSBvYmplY3QgaXRzZWxmLCBhbmQgdGhlCm9sZCBzdGF0ZSBpcyBw
YXNzZWQgdG8gdGhlIGZ1bmN0aW9uLiBTZWUgaG93IHRoZSBDUlRDIGFuZCBlbmNvZGVyCi5hdG9t
aWNfZW5hYmxlKCkgYXJlIGNhbGxlZCBpbiBkcm1fYXRvbWljX2hlbHBlcl9jb21taXRfbW9kZXNl
dF9lbmFibGVzCihkcm1fYXRvbWljX2hlbHBlci5jKSBmb3IgaW5zdGFuY2UuCgpZb3Ugc2hvdWxk
IHVwZGF0ZSB0aGUgZG9jdW1lbnRhdGlvbiBvZiB0aGUgYnJpZGdlIGF0b21pYyBvcGVyYXRpb25z
IHRvCm1ha2VzIHRoaXMgZXhwbGljaXQuIFRoZSBkb2N1bWVudGF0aW9uIG9mIHRoZSBicmlkZ2Ug
aGVscGVycwooZHJtX2F0b21pY19icmlkZ2VfZW5hYmxlKCkgJiBjby4pIGlzIGFsc28gbWlzbGVh
ZGluZywgdGhleSBnZXQgcGFzc2VkCnRoZSBvbGQgc3RhdGUsIHdoaWxlIHRoZSBkb2N1bWVudGF0
aW9uIHN0YXRlcyAiYXRvbWljIHN0YXRlIGJlaW5nCmNvbW1pdHRlZCIuIEkgdGhpbmsgeW91IHNo
b3VsZCByZW5hbWUgYWxsIHRob3NlIHN0YXRlIHBhcmFtZXRlcnMgdG8Kb2xkX3N0YXRlIHRvIG1h
a2UgdGhpcyBjbGVhcmVyLgoKTGFzdCBidXQgbm90IGxlYXN0LCB0aGUgaW1wbGVtZW50YXRpb24g
aW4gdGhlIGFuYWxvZ2l4IGJyaWRnZSBkcml2ZXIKc2VlbXMgdG8gZXhwZWN0IHRoZSBuZXcgc3Rh
dGUsIHNvIEkgdGhpbmsgaXQncyBidWdneS4KCj4gKwkJCWlmIChXQVJOX09OKCFicmlkZ2Vfc3Rh
dGUpKQo+ICsJCQkJcmV0dXJuOwo+ICsKPiArCQkJYnJpZGdlLT5mdW5jcy0+YXRvbWljX3ByZV9l
bmFibGUoYnJpZGdlLCBicmlkZ2Vfc3RhdGUpOwo+ICsJCX0gZWxzZSBpZiAoYnJpZGdlLT5mdW5j
cy0+cHJlX2VuYWJsZSkgewo+ICAJCQlicmlkZ2UtPmZ1bmNzLT5wcmVfZW5hYmxlKGJyaWRnZSk7
Cj4gKwkJfQo+ICAJfQo+ICB9Cj4gIEVYUE9SVF9TWU1CT0woZHJtX2F0b21pY19icmlkZ2VfY2hh
aW5fcHJlX2VuYWJsZSk7Cj4gQEAgLTU0MiwxMCArNTY3LDE4IEBAIHZvaWQgZHJtX2F0b21pY19i
cmlkZ2VfY2hhaW5fZW5hYmxlKHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlciwKPiAgCXN0cnVj
dCBkcm1fYnJpZGdlICpicmlkZ2U7Cj4gIAo+ICAJbGlzdF9mb3JfZWFjaF9lbnRyeShicmlkZ2Us
ICZlbmNvZGVyLT5icmlkZ2VfY2hhaW4sIGNoYWluX25vZGUpIHsKPiAtCQlpZiAoYnJpZGdlLT5m
dW5jcy0+YXRvbWljX2VuYWJsZSkKPiAtCQkJYnJpZGdlLT5mdW5jcy0+YXRvbWljX2VuYWJsZShi
cmlkZ2UsIHN0YXRlKTsKPiAtCQllbHNlIGlmIChicmlkZ2UtPmZ1bmNzLT5lbmFibGUpCj4gKwkJ
aWYgKGJyaWRnZS0+ZnVuY3MtPmF0b21pY19lbmFibGUpIHsKPiArCQkJc3RydWN0IGRybV9icmlk
Z2Vfc3RhdGUgKmJyaWRnZV9zdGF0ZTsKPiArCj4gKwkJCWJyaWRnZV9zdGF0ZSA9IGRybV9hdG9t
aWNfZ2V0X25ld19icmlkZ2Vfc3RhdGUoc3RhdGUsCj4gKwkJCQkJCQkJICAgICAgIGJyaWRnZSk7
Cj4gKwkJCWlmIChXQVJOX09OKCFicmlkZ2Vfc3RhdGUpKQo+ICsJCQkJcmV0dXJuOwo+ICsKPiAr
CQkJYnJpZGdlLT5mdW5jcy0+YXRvbWljX2VuYWJsZShicmlkZ2UsIGJyaWRnZV9zdGF0ZSk7Cj4g
KwkJfSBlbHNlIGlmIChicmlkZ2UtPmZ1bmNzLT5lbmFibGUpIHsKPiAgCQkJYnJpZGdlLT5mdW5j
cy0+ZW5hYmxlKGJyaWRnZSk7Cj4gKwkJfQo+ICAJfQo+ICB9Cj4gIEVYUE9SVF9TWU1CT0woZHJt
X2F0b21pY19icmlkZ2VfY2hhaW5fZW5hYmxlKTsKPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0v
ZHJtX2JyaWRnZS5oIGIvaW5jbHVkZS9kcm0vZHJtX2JyaWRnZS5oCj4gaW5kZXggOGNhMjVkMjY2
ZDBjLi45MzgzYjRlNGI4NTMgMTAwNjQ0Cj4gLS0tIGEvaW5jbHVkZS9kcm0vZHJtX2JyaWRnZS5o
Cj4gKysrIGIvaW5jbHVkZS9kcm0vZHJtX2JyaWRnZS5oCj4gQEAgLTI4MCw3ICsyODAsNyBAQCBz
dHJ1Y3QgZHJtX2JyaWRnZV9mdW5jcyB7Cj4gIAkgKiBUaGUgQGF0b21pY19wcmVfZW5hYmxlIGNh
bGxiYWNrIGlzIG9wdGlvbmFsLgo+ICAJICovCj4gIAl2b2lkICgqYXRvbWljX3ByZV9lbmFibGUp
KHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UsCj4gLQkJCQkgIHN0cnVjdCBkcm1fYXRvbWljX3N0
YXRlICpzdGF0ZSk7Cj4gKwkJCQkgIHN0cnVjdCBkcm1fYnJpZGdlX3N0YXRlICpzdGF0ZSk7Cj4g
IAo+ICAJLyoqCj4gIAkgKiBAYXRvbWljX2VuYWJsZToKPiBAQCAtMzA1LDcgKzMwNSw3IEBAIHN0
cnVjdCBkcm1fYnJpZGdlX2Z1bmNzIHsKPiAgCSAqIFRoZSBlbmFibGUgY2FsbGJhY2sgaXMgb3B0
aW9uYWwuCj4gIAkgKi8KPiAgCXZvaWQgKCphdG9taWNfZW5hYmxlKShzdHJ1Y3QgZHJtX2JyaWRn
ZSAqYnJpZGdlLAo+IC0JCQkgICAgICBzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpOwo+
ICsJCQkgICAgICBzdHJ1Y3QgZHJtX2JyaWRnZV9zdGF0ZSAqc3RhdGUpOwo+ICAJLyoqCj4gIAkg
KiBAYXRvbWljX2Rpc2FibGU6Cj4gIAkgKgo+IEBAIC0zMjgsNyArMzI4LDcgQEAgc3RydWN0IGRy
bV9icmlkZ2VfZnVuY3Mgewo+ICAJICogVGhlIGRpc2FibGUgY2FsbGJhY2sgaXMgb3B0aW9uYWwu
Cj4gIAkgKi8KPiAgCXZvaWQgKCphdG9taWNfZGlzYWJsZSkoc3RydWN0IGRybV9icmlkZ2UgKmJy
aWRnZSwKPiAtCQkJICAgICAgIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSk7Cj4gKwkJ
CSAgICAgICBzdHJ1Y3QgZHJtX2JyaWRnZV9zdGF0ZSAqc3RhdGUpOwo+ICAKPiAgCS8qKgo+ICAJ
ICogQGF0b21pY19wb3N0X2Rpc2FibGU6Cj4gQEAgLTM1NCw3ICszNTQsNyBAQCBzdHJ1Y3QgZHJt
X2JyaWRnZV9mdW5jcyB7Cj4gIAkgKiBUaGUgcG9zdF9kaXNhYmxlIGNhbGxiYWNrIGlzIG9wdGlv
bmFsLgo+ICAJICovCj4gIAl2b2lkICgqYXRvbWljX3Bvc3RfZGlzYWJsZSkoc3RydWN0IGRybV9i
cmlkZ2UgKmJyaWRnZSwKPiAtCQkJCSAgICBzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUp
Owo+ICsJCQkJICAgIHN0cnVjdCBkcm1fYnJpZGdlX3N0YXRlICpzdGF0ZSk7Cj4gIAo+ICAJLyoq
Cj4gIAkgKiBAYXRvbWljX2R1cGxpY2F0ZV9zdGF0ZToKCi0tIApSZWdhcmRzLAoKTGF1cmVudCBQ
aW5jaGFydApfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpk
cmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0
cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
