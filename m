Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id BB8CB21532C
	for <lists+dri-devel@lfdr.de>; Mon,  6 Jul 2020 09:20:34 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id AB9F56E356;
	Mon,  6 Jul 2020 07:19:32 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-wm1-x343.google.com (mail-wm1-x343.google.com
 [IPv6:2a00:1450:4864:20::343])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 08A9A89E8C
 for <dri-devel@lists.freedesktop.org>; Sat,  4 Jul 2020 10:25:47 +0000 (UTC)
Received: by mail-wm1-x343.google.com with SMTP id 17so36477631wmo.1
 for <dri-devel@lists.freedesktop.org>; Sat, 04 Jul 2020 03:25:47 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=BeNdffpPmYnmhm02KtRcgQ/SrqRpQJMfHL7+M9hoCsI=;
 b=Sowfu0LC8UqSHkxtyX9RUMFBW7jW2vzo8CVJTB4NkbaRHl4opgX23d1qNBr83m2Wa6
 mIN56Os/DPM+sFRnf3Zz8Cfvos4lTjsUi666vJK31J4WrOi8r+c/mXkLKvvJqu53q+8H
 g/EtJwj+8+G389BI/BhC0Zo+Igt0xSRnz+f7wWRVbJlTaS5kZiUWrYIXmAf7J94G8PWi
 C9R6XNvMjHEIp5ObrHB9OquDQORqCs34ydO+eMVcEy6+J+463RDdQ+W1b04v1jRi1Anj
 JFtyaa9NpckmvpgTr5D4loBepY58wqXOC75znzvWKgfvRX6Kuz3H9Eo414JvyrJjeFRS
 QJWQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=BeNdffpPmYnmhm02KtRcgQ/SrqRpQJMfHL7+M9hoCsI=;
 b=CgWrYmt6XVyX/Iz8HQyxAtOQb8w116VIQSbkUNcMb+3N41bEH+3BRjmy+wMPmxyWOo
 gTPDvYLzgtPIZEpGa6YcsPOWP+wSFQplqaQeQmQAIgPDCuWoftgNYFpr3YDeqeE9UhHY
 p1EEMou90JCrXVUnPT4rUwNu9QCTIvGxDlffczRpziSZq6ot8OL7Axvh47wO1eRGLmCf
 27kWuKKFzgZefLPKvlK2ucJ8FdEwXrWWiwwuL8IXV48bk9upJZtwO8TgL9wXYxGZUicP
 AQNoVKiVD4mBAwewBesOfOjemNh2h7pV86ztgfQStvIRMOzDIeDG/PUY7hmTdlZEQGXQ
 s92w==
X-Gm-Message-State: AOAM533IbL9GwzKFMhXBEjnOnk0nt3D8y+JHDbq6yEqQY3m/Yt4W3y2K
 ImAHXNU2n2vzKNQjtiG11vU=
X-Google-Smtp-Source: ABdhPJxnKFaXi7VkT/L9f/V1duxJLFFKA5PDg/KP77cyDWKIKdj67y6TiKIVWPMVl+xxo3nHnUYQGA==
X-Received: by 2002:a1c:23d0:: with SMTP id j199mr41750804wmj.12.1593858346494; 
 Sat, 04 Jul 2020 03:25:46 -0700 (PDT)
Received: from clement-Latitude-7490.numericable.fr
 (213-245-241-245.rev.numericable.fr. [213.245.241.245])
 by smtp.gmail.com with ESMTPSA id g14sm16421428wrm.93.2020.07.04.03.25.45
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Sat, 04 Jul 2020 03:25:45 -0700 (PDT)
From: =?UTF-8?q?Cl=C3=A9ment=20P=C3=A9ron?= <peron.clem@gmail.com>
To: Rob Herring <robh@kernel.org>, Tomeu Vizoso <tomeu.vizoso@collabora.com>,
 Steven Price <steven.price@arm.com>,
 Alyssa Rosenzweig <alyssa.rosenzweig@collabora.com>,
 Viresh Kumar <vireshk@kernel.org>, Nishanth Menon <nm@ti.com>,
 Stephen Boyd <sboyd@kernel.org>, Maxime Ripard <mripard@kernel.org>,
 Chen-Yu Tsai <wens@csie.org>
Subject: [PATCH v2 04/14] drm/panfrost: introduce panfrost_devfreq struct
Date: Sat,  4 Jul 2020 12:25:25 +0200
Message-Id: <20200704102535.189647-5-peron.clem@gmail.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20200704102535.189647-1-peron.clem@gmail.com>
References: <20200704102535.189647-1-peron.clem@gmail.com>
MIME-Version: 1.0
X-Mailman-Approved-At: Mon, 06 Jul 2020 07:19:17 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: =?UTF-8?q?Cl=C3=A9ment=20P=C3=A9ron?= <peron.clem@gmail.com>,
 linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW50cm9kdWNlIGEgcHJvcGVyIHBhbmZyb3N0X2RldmZyZXEgdG8gZGVhbCB3aXRoIGRldmZyZXEg
dmFyaWFibGVzLgoKU2lnbmVkLW9mZi1ieTogQ2zDqW1lbnQgUMOpcm9uIDxwZXJvbi5jbGVtQGdt
YWlsLmNvbT4KUmV2aWV3ZWQtYnk6IFN0ZXZlbiBQcmljZSA8c3RldmVuLnByaWNlQGFybS5jb20+
Ci0tLQogZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2RldmZyZXEuYyB8IDc2ICsr
KysrKysrKysrKy0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2Rl
dmZyZXEuaCB8IDIwICsrKysrLQogZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2Rl
dmljZS5oICB8IDExICstLQogZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2pvYi5j
ICAgICB8ICA2ICstCiA0IGZpbGVzIGNoYW5nZWQsIDY2IGluc2VydGlvbnMoKyksIDQ3IGRlbGV0
aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9k
ZXZmcmVxLmMgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZGV2ZnJlcS5jCmlu
ZGV4IGRmN2I3MWRhOWE4NC4uOTYyNTUwMzYzMzkxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vcGFuZnJvc3QvcGFuZnJvc3RfZGV2ZnJlcS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5m
cm9zdC9wYW5mcm9zdF9kZXZmcmVxLmMKQEAgLTEwLDIzICsxMCwyMyBAQAogI2luY2x1ZGUgInBh
bmZyb3N0X2RldmljZS5oIgogI2luY2x1ZGUgInBhbmZyb3N0X2RldmZyZXEuaCIKIAotc3RhdGlj
IHZvaWQgcGFuZnJvc3RfZGV2ZnJlcV91cGRhdGVfdXRpbGl6YXRpb24oc3RydWN0IHBhbmZyb3N0
X2RldmljZSAqcGZkZXYpCitzdGF0aWMgdm9pZCBwYW5mcm9zdF9kZXZmcmVxX3VwZGF0ZV91dGls
aXphdGlvbihzdHJ1Y3QgcGFuZnJvc3RfZGV2ZnJlcSAqcGZkZXZmcmVxKQogewogCWt0aW1lX3Qg
bm93OwogCWt0aW1lX3QgbGFzdDsKIAotCWlmICghcGZkZXYtPmRldmZyZXEuZGV2ZnJlcSkKKwlp
ZiAoIXBmZGV2ZnJlcS0+ZGV2ZnJlcSkKIAkJcmV0dXJuOwogCiAJbm93ID0ga3RpbWVfZ2V0KCk7
Ci0JbGFzdCA9IHBmZGV2LT5kZXZmcmVxLnRpbWVfbGFzdF91cGRhdGU7CisJbGFzdCA9IHBmZGV2
ZnJlcS0+dGltZV9sYXN0X3VwZGF0ZTsKIAotCWlmIChhdG9taWNfcmVhZCgmcGZkZXYtPmRldmZy
ZXEuYnVzeV9jb3VudCkgPiAwKQotCQlwZmRldi0+ZGV2ZnJlcS5idXN5X3RpbWUgKz0ga3RpbWVf
c3ViKG5vdywgbGFzdCk7CisJaWYgKGF0b21pY19yZWFkKCZwZmRldmZyZXEtPmJ1c3lfY291bnQp
ID4gMCkKKwkJcGZkZXZmcmVxLT5idXN5X3RpbWUgKz0ga3RpbWVfc3ViKG5vdywgbGFzdCk7CiAJ
ZWxzZQotCQlwZmRldi0+ZGV2ZnJlcS5pZGxlX3RpbWUgKz0ga3RpbWVfc3ViKG5vdywgbGFzdCk7
CisJCXBmZGV2ZnJlcS0+aWRsZV90aW1lICs9IGt0aW1lX3N1Yihub3csIGxhc3QpOwogCi0JcGZk
ZXYtPmRldmZyZXEudGltZV9sYXN0X3VwZGF0ZSA9IG5vdzsKKwlwZmRldmZyZXEtPnRpbWVfbGFz
dF91cGRhdGUgPSBub3c7CiB9CiAKIHN0YXRpYyBpbnQgcGFuZnJvc3RfZGV2ZnJlcV90YXJnZXQo
c3RydWN0IGRldmljZSAqZGV2LCB1bnNpZ25lZCBsb25nICpmcmVxLApAQCAtNDcsMzAgKzQ3LDMx
IEBAIHN0YXRpYyBpbnQgcGFuZnJvc3RfZGV2ZnJlcV90YXJnZXQoc3RydWN0IGRldmljZSAqZGV2
LCB1bnNpZ25lZCBsb25nICpmcmVxLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgdm9pZCBwYW5m
cm9zdF9kZXZmcmVxX3Jlc2V0KHN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2KQorc3RhdGlj
IHZvaWQgcGFuZnJvc3RfZGV2ZnJlcV9yZXNldChzdHJ1Y3QgcGFuZnJvc3RfZGV2ZnJlcSAqcGZk
ZXZmcmVxKQogewotCXBmZGV2LT5kZXZmcmVxLmJ1c3lfdGltZSA9IDA7Ci0JcGZkZXYtPmRldmZy
ZXEuaWRsZV90aW1lID0gMDsKLQlwZmRldi0+ZGV2ZnJlcS50aW1lX2xhc3RfdXBkYXRlID0ga3Rp
bWVfZ2V0KCk7CisJcGZkZXZmcmVxLT5idXN5X3RpbWUgPSAwOworCXBmZGV2ZnJlcS0+aWRsZV90
aW1lID0gMDsKKwlwZmRldmZyZXEtPnRpbWVfbGFzdF91cGRhdGUgPSBrdGltZV9nZXQoKTsKIH0K
IAogc3RhdGljIGludCBwYW5mcm9zdF9kZXZmcmVxX2dldF9kZXZfc3RhdHVzKHN0cnVjdCBkZXZp
Y2UgKmRldiwKIAkJCQkJICAgc3RydWN0IGRldmZyZXFfZGV2X3N0YXR1cyAqc3RhdHVzKQogewog
CXN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2ID0gZGV2X2dldF9kcnZkYXRhKGRldik7CisJ
c3RydWN0IHBhbmZyb3N0X2RldmZyZXEgKnBmZGV2ZnJlcSA9ICZwZmRldi0+cGZkZXZmcmVxOwog
Ci0JcGFuZnJvc3RfZGV2ZnJlcV91cGRhdGVfdXRpbGl6YXRpb24ocGZkZXYpOworCXBhbmZyb3N0
X2RldmZyZXFfdXBkYXRlX3V0aWxpemF0aW9uKHBmZGV2ZnJlcSk7CiAKIAlzdGF0dXMtPmN1cnJl
bnRfZnJlcXVlbmN5ID0gY2xrX2dldF9yYXRlKHBmZGV2LT5jbG9jayk7Ci0Jc3RhdHVzLT50b3Rh
bF90aW1lID0ga3RpbWVfdG9fbnMoa3RpbWVfYWRkKHBmZGV2LT5kZXZmcmVxLmJ1c3lfdGltZSwK
LQkJCQkJCSAgIHBmZGV2LT5kZXZmcmVxLmlkbGVfdGltZSkpOworCXN0YXR1cy0+dG90YWxfdGlt
ZSA9IGt0aW1lX3RvX25zKGt0aW1lX2FkZChwZmRldmZyZXEtPmJ1c3lfdGltZSwKKwkJCQkJCSAg
IHBmZGV2ZnJlcS0+aWRsZV90aW1lKSk7CiAKLQlzdGF0dXMtPmJ1c3lfdGltZSA9IGt0aW1lX3Rv
X25zKHBmZGV2LT5kZXZmcmVxLmJ1c3lfdGltZSk7CisJc3RhdHVzLT5idXN5X3RpbWUgPSBrdGlt
ZV90b19ucyhwZmRldmZyZXEtPmJ1c3lfdGltZSk7CiAKLQlwYW5mcm9zdF9kZXZmcmVxX3Jlc2V0
KHBmZGV2KTsKKwlwYW5mcm9zdF9kZXZmcmVxX3Jlc2V0KHBmZGV2ZnJlcSk7CiAKLQlkZXZfZGJn
KHBmZGV2LT5kZXYsICJidXN5ICVsdSB0b3RhbCAlbHUgJWx1ICUlIGZyZXEgJWx1IE1IelxuIiwg
c3RhdHVzLT5idXN5X3RpbWUsCi0JCXN0YXR1cy0+dG90YWxfdGltZSwKKwlkZXZfZGJnKHBmZGV2
LT5kZXYsICJidXN5ICVsdSB0b3RhbCAlbHUgJWx1ICUlIGZyZXEgJWx1IE1IelxuIiwKKwkJc3Rh
dHVzLT5idXN5X3RpbWUsIHN0YXR1cy0+dG90YWxfdGltZSwKIAkJc3RhdHVzLT5idXN5X3RpbWUg
LyAoc3RhdHVzLT50b3RhbF90aW1lIC8gMTAwKSwKIAkJc3RhdHVzLT5jdXJyZW50X2ZyZXF1ZW5j
eSAvIDEwMDAgLyAxMDAwKTsKIApAQCAtOTEsNiArOTIsNyBAQCBpbnQgcGFuZnJvc3RfZGV2ZnJl
cV9pbml0KHN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2KQogCXN0cnVjdCBkZXZpY2UgKmRl
diA9ICZwZmRldi0+cGRldi0+ZGV2OwogCXN0cnVjdCBkZXZmcmVxICpkZXZmcmVxOwogCXN0cnVj
dCB0aGVybWFsX2Nvb2xpbmdfZGV2aWNlICpjb29saW5nOworCXN0cnVjdCBwYW5mcm9zdF9kZXZm
cmVxICpwZmRldmZyZXEgPSAmcGZkZXYtPnBmZGV2ZnJlcTsKIAogCXJldCA9IGRldl9wbV9vcHBf
b2ZfYWRkX3RhYmxlKGRldik7CiAJaWYgKHJldCA9PSAtRU5PREVWKSAvKiBPcHRpb25hbCwgY29u
dGludWUgd2l0aG91dCBkZXZmcmVxICovCkBAIC05OCw3ICsxMDAsNyBAQCBpbnQgcGFuZnJvc3Rf
ZGV2ZnJlcV9pbml0KHN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2KQogCWVsc2UgaWYgKHJl
dCkKIAkJcmV0dXJuIHJldDsKIAotCXBhbmZyb3N0X2RldmZyZXFfcmVzZXQocGZkZXYpOworCXBh
bmZyb3N0X2RldmZyZXFfcmVzZXQocGZkZXZmcmVxKTsKIAogCWN1cl9mcmVxID0gY2xrX2dldF9y
YXRlKHBmZGV2LT5jbG9jayk7CiAKQEAgLTExNiw1MyArMTE4LDU5IEBAIGludCBwYW5mcm9zdF9k
ZXZmcmVxX2luaXQoc3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYpCiAJCWRldl9wbV9vcHBf
b2ZfcmVtb3ZlX3RhYmxlKGRldik7CiAJCXJldHVybiBQVFJfRVJSKGRldmZyZXEpOwogCX0KLQlw
ZmRldi0+ZGV2ZnJlcS5kZXZmcmVxID0gZGV2ZnJlcTsKKwlwZmRldmZyZXEtPmRldmZyZXEgPSBk
ZXZmcmVxOwogCiAJY29vbGluZyA9IG9mX2RldmZyZXFfY29vbGluZ19yZWdpc3RlcihkZXYtPm9m
X25vZGUsIGRldmZyZXEpOwogCWlmIChJU19FUlIoY29vbGluZykpCiAJCURSTV9ERVZfSU5GTyhk
ZXYsICJGYWlsZWQgdG8gcmVnaXN0ZXIgY29vbGluZyBkZXZpY2VcbiIpOwogCWVsc2UKLQkJcGZk
ZXYtPmRldmZyZXEuY29vbGluZyA9IGNvb2xpbmc7CisJCXBmZGV2ZnJlcS0+Y29vbGluZyA9IGNv
b2xpbmc7CiAKIAlyZXR1cm4gMDsKIH0KIAogdm9pZCBwYW5mcm9zdF9kZXZmcmVxX2Zpbmkoc3Ry
dWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYpCiB7Ci0JaWYgKHBmZGV2LT5kZXZmcmVxLmNvb2xp
bmcpCi0JCWRldmZyZXFfY29vbGluZ191bnJlZ2lzdGVyKHBmZGV2LT5kZXZmcmVxLmNvb2xpbmcp
OworCXN0cnVjdCBwYW5mcm9zdF9kZXZmcmVxICpwZmRldmZyZXEgPSAmcGZkZXYtPnBmZGV2ZnJl
cTsKKworCWlmIChwZmRldmZyZXEtPmNvb2xpbmcpCisJCWRldmZyZXFfY29vbGluZ191bnJlZ2lz
dGVyKHBmZGV2ZnJlcS0+Y29vbGluZyk7CiAJZGV2X3BtX29wcF9vZl9yZW1vdmVfdGFibGUoJnBm
ZGV2LT5wZGV2LT5kZXYpOwogfQogCiB2b2lkIHBhbmZyb3N0X2RldmZyZXFfcmVzdW1lKHN0cnVj
dCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2KQogewotCWlmICghcGZkZXYtPmRldmZyZXEuZGV2ZnJl
cSkKKwlzdHJ1Y3QgcGFuZnJvc3RfZGV2ZnJlcSAqcGZkZXZmcmVxID0gJnBmZGV2LT5wZmRldmZy
ZXE7CisKKwlpZiAoIXBmZGV2ZnJlcS0+ZGV2ZnJlcSkKIAkJcmV0dXJuOwogCi0JcGFuZnJvc3Rf
ZGV2ZnJlcV9yZXNldChwZmRldik7CisJcGFuZnJvc3RfZGV2ZnJlcV9yZXNldChwZmRldmZyZXEp
OwogCi0JZGV2ZnJlcV9yZXN1bWVfZGV2aWNlKHBmZGV2LT5kZXZmcmVxLmRldmZyZXEpOworCWRl
dmZyZXFfcmVzdW1lX2RldmljZShwZmRldmZyZXEtPmRldmZyZXEpOwogfQogCiB2b2lkIHBhbmZy
b3N0X2RldmZyZXFfc3VzcGVuZChzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldikKIHsKLQlp
ZiAoIXBmZGV2LT5kZXZmcmVxLmRldmZyZXEpCisJc3RydWN0IHBhbmZyb3N0X2RldmZyZXEgKnBm
ZGV2ZnJlcSA9ICZwZmRldi0+cGZkZXZmcmVxOworCisJaWYgKCFwZmRldmZyZXEtPmRldmZyZXEp
CiAJCXJldHVybjsKIAotCWRldmZyZXFfc3VzcGVuZF9kZXZpY2UocGZkZXYtPmRldmZyZXEuZGV2
ZnJlcSk7CisJZGV2ZnJlcV9zdXNwZW5kX2RldmljZShwZmRldmZyZXEtPmRldmZyZXEpOwogfQog
Ci12b2lkIHBhbmZyb3N0X2RldmZyZXFfcmVjb3JkX2J1c3koc3RydWN0IHBhbmZyb3N0X2Rldmlj
ZSAqcGZkZXYpCit2b2lkIHBhbmZyb3N0X2RldmZyZXFfcmVjb3JkX2J1c3koc3RydWN0IHBhbmZy
b3N0X2RldmZyZXEgKnBmZGV2ZnJlcSkKIHsKLQlwYW5mcm9zdF9kZXZmcmVxX3VwZGF0ZV91dGls
aXphdGlvbihwZmRldik7Ci0JYXRvbWljX2luYygmcGZkZXYtPmRldmZyZXEuYnVzeV9jb3VudCk7
CisJcGFuZnJvc3RfZGV2ZnJlcV91cGRhdGVfdXRpbGl6YXRpb24ocGZkZXZmcmVxKTsKKwlhdG9t
aWNfaW5jKCZwZmRldmZyZXEtPmJ1c3lfY291bnQpOwogfQogCi12b2lkIHBhbmZyb3N0X2RldmZy
ZXFfcmVjb3JkX2lkbGUoc3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYpCit2b2lkIHBhbmZy
b3N0X2RldmZyZXFfcmVjb3JkX2lkbGUoc3RydWN0IHBhbmZyb3N0X2RldmZyZXEgKnBmZGV2ZnJl
cSkKIHsKIAlpbnQgY291bnQ7CiAKLQlwYW5mcm9zdF9kZXZmcmVxX3VwZGF0ZV91dGlsaXphdGlv
bihwZmRldik7Ci0JY291bnQgPSBhdG9taWNfZGVjX2lmX3Bvc2l0aXZlKCZwZmRldi0+ZGV2ZnJl
cS5idXN5X2NvdW50KTsKKwlwYW5mcm9zdF9kZXZmcmVxX3VwZGF0ZV91dGlsaXphdGlvbihwZmRl
dmZyZXEpOworCWNvdW50ID0gYXRvbWljX2RlY19pZl9wb3NpdGl2ZSgmcGZkZXZmcmVxLT5idXN5
X2NvdW50KTsKIAlXQVJOX09OKGNvdW50IDwgMCk7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZGV2ZnJlcS5oIGIvZHJpdmVycy9ncHUvZHJtL3BhbmZy
b3N0L3BhbmZyb3N0X2RldmZyZXEuaAppbmRleCAwNjExYmVmZmM4ZDAuLjA2OTdmOGQ1YWEzNCAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2RldmZyZXEuaAor
KysgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZGV2ZnJlcS5oCkBAIC00LDEz
ICs0LDI5IEBACiAjaWZuZGVmIF9fUEFORlJPU1RfREVWRlJFUV9IX18KICNkZWZpbmUgX19QQU5G
Uk9TVF9ERVZGUkVRX0hfXwogCisjaW5jbHVkZSA8bGludXgva3RpbWUuaD4KKworc3RydWN0IGRl
dmZyZXE7CitzdHJ1Y3QgdGhlcm1hbF9jb29saW5nX2RldmljZTsKKworc3RydWN0IHBhbmZyb3N0
X2RldmljZTsKKworc3RydWN0IHBhbmZyb3N0X2RldmZyZXEgeworCXN0cnVjdCBkZXZmcmVxICpk
ZXZmcmVxOworCXN0cnVjdCB0aGVybWFsX2Nvb2xpbmdfZGV2aWNlICpjb29saW5nOworCWt0aW1l
X3QgYnVzeV90aW1lOworCWt0aW1lX3QgaWRsZV90aW1lOworCWt0aW1lX3QgdGltZV9sYXN0X3Vw
ZGF0ZTsKKwlhdG9taWNfdCBidXN5X2NvdW50OworfTsKKwogaW50IHBhbmZyb3N0X2RldmZyZXFf
aW5pdChzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldik7CiB2b2lkIHBhbmZyb3N0X2RldmZy
ZXFfZmluaShzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldik7CiAKIHZvaWQgcGFuZnJvc3Rf
ZGV2ZnJlcV9yZXN1bWUoc3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYpOwogdm9pZCBwYW5m
cm9zdF9kZXZmcmVxX3N1c3BlbmQoc3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYpOwogCi12
b2lkIHBhbmZyb3N0X2RldmZyZXFfcmVjb3JkX2J1c3koc3RydWN0IHBhbmZyb3N0X2RldmljZSAq
cGZkZXYpOwotdm9pZCBwYW5mcm9zdF9kZXZmcmVxX3JlY29yZF9pZGxlKHN0cnVjdCBwYW5mcm9z
dF9kZXZpY2UgKnBmZGV2KTsKK3ZvaWQgcGFuZnJvc3RfZGV2ZnJlcV9yZWNvcmRfYnVzeShzdHJ1
Y3QgcGFuZnJvc3RfZGV2ZnJlcSAqZGV2ZnJlcSk7Cit2b2lkIHBhbmZyb3N0X2RldmZyZXFfcmVj
b3JkX2lkbGUoc3RydWN0IHBhbmZyb3N0X2RldmZyZXEgKmRldmZyZXEpOwogCiAjZW5kaWYgLyog
X19QQU5GUk9TVF9ERVZGUkVRX0hfXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Bh
bmZyb3N0L3BhbmZyb3N0X2RldmljZS5oIGIvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZy
b3N0X2RldmljZS5oCmluZGV4IGMzMGM3MTlhODA1OS4uMmVmYTU5YzlkMWM1IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZGV2aWNlLmgKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2RldmljZS5oCkBAIC0xMyw2ICsxMyw4IEBACiAj
aW5jbHVkZSA8ZHJtL2RybV9tbS5oPgogI2luY2x1ZGUgPGRybS9ncHVfc2NoZWR1bGVyLmg+CiAK
KyNpbmNsdWRlICJwYW5mcm9zdF9kZXZmcmVxLmgiCisKIHN0cnVjdCBwYW5mcm9zdF9kZXZpY2U7
CiBzdHJ1Y3QgcGFuZnJvc3RfbW11Owogc3RydWN0IHBhbmZyb3N0X2pvYl9zbG90OwpAQCAtMTA3
LDE0ICsxMDksNyBAQCBzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlIHsKIAlzdHJ1Y3QgbGlzdF9oZWFk
IHNocmlua2VyX2xpc3Q7CiAJc3RydWN0IHNocmlua2VyIHNocmlua2VyOwogCi0Jc3RydWN0IHsK
LQkJc3RydWN0IGRldmZyZXEgKmRldmZyZXE7Ci0JCXN0cnVjdCB0aGVybWFsX2Nvb2xpbmdfZGV2
aWNlICpjb29saW5nOwotCQlrdGltZV90IGJ1c3lfdGltZTsKLQkJa3RpbWVfdCBpZGxlX3RpbWU7
Ci0JCWt0aW1lX3QgdGltZV9sYXN0X3VwZGF0ZTsKLQkJYXRvbWljX3QgYnVzeV9jb3VudDsKLQl9
IGRldmZyZXE7CisJc3RydWN0IHBhbmZyb3N0X2RldmZyZXEgcGZkZXZmcmVxOwogfTsKIAogc3Ry
dWN0IHBhbmZyb3N0X21tdSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3Qv
cGFuZnJvc3Rfam9iLmMgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3Rfam9iLmMK
aW5kZXggNjNlMzJhOWYyNzQ5Li5hNjdmM2VhYzZhNTggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9qb2IuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZnJv
c3QvcGFuZnJvc3Rfam9iLmMKQEAgLTE1NSw3ICsxNTUsNyBAQCBzdGF0aWMgdm9pZCBwYW5mcm9z
dF9qb2JfaHdfc3VibWl0KHN0cnVjdCBwYW5mcm9zdF9qb2IgKmpvYiwgaW50IGpzKQogCX0KIAog
CWNmZyA9IHBhbmZyb3N0X21tdV9hc19nZXQocGZkZXYsICZqb2ItPmZpbGVfcHJpdi0+bW11KTsK
LQlwYW5mcm9zdF9kZXZmcmVxX3JlY29yZF9idXN5KHBmZGV2KTsKKwlwYW5mcm9zdF9kZXZmcmVx
X3JlY29yZF9idXN5KCZwZmRldi0+cGZkZXZmcmVxKTsKIAogCWpvYl93cml0ZShwZmRldiwgSlNf
SEVBRF9ORVhUX0xPKGpzKSwgamNfaGVhZCAmIDB4RkZGRkZGRkYpOwogCWpvYl93cml0ZShwZmRl
diwgSlNfSEVBRF9ORVhUX0hJKGpzKSwgamNfaGVhZCA+PiAzMik7CkBAIC00MTUsNyArNDE1LDcg
QEAgc3RhdGljIHZvaWQgcGFuZnJvc3Rfam9iX3RpbWVkb3V0KHN0cnVjdCBkcm1fc2NoZWRfam9i
ICpzY2hlZF9qb2IpCiAJfQogCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnBmZGV2LT5qcy0+am9i
X2xvY2ssIGZsYWdzKTsKIAotCXBhbmZyb3N0X2RldmZyZXFfcmVjb3JkX2lkbGUocGZkZXYpOwor
CXBhbmZyb3N0X2RldmZyZXFfcmVjb3JkX2lkbGUoJnBmZGV2LT5wZmRldmZyZXEpOwogCXBhbmZy
b3N0X2RldmljZV9yZXNldChwZmRldik7CiAKIAlmb3IgKGkgPSAwOyBpIDwgTlVNX0pPQl9TTE9U
UzsgaSsrKQpAQCAtNDc4LDcgKzQ3OCw3IEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBwYW5mcm9zdF9q
b2JfaXJxX2hhbmRsZXIoaW50IGlycSwgdm9pZCAqZGF0YSkKIAkJCQlwZmRldi0+am9ic1tqXSA9
IE5VTEw7CiAKIAkJCQlwYW5mcm9zdF9tbXVfYXNfcHV0KHBmZGV2LCAmam9iLT5maWxlX3ByaXYt
Pm1tdSk7Ci0JCQkJcGFuZnJvc3RfZGV2ZnJlcV9yZWNvcmRfaWRsZShwZmRldik7CisJCQkJcGFu
ZnJvc3RfZGV2ZnJlcV9yZWNvcmRfaWRsZSgmcGZkZXYtPnBmZGV2ZnJlcSk7CiAKIAkJCQlkbWFf
ZmVuY2Vfc2lnbmFsX2xvY2tlZChqb2ItPmRvbmVfZmVuY2UpOwogCQkJCXBtX3J1bnRpbWVfcHV0
X2F1dG9zdXNwZW5kKHBmZGV2LT5kZXYpOwotLSAKMi4yNS4xCgpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1k
ZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcv
bWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWwK
