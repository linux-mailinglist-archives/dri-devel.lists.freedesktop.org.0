Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id A3D2F25FB73
	for <lists+dri-devel@lfdr.de>; Mon,  7 Sep 2020 15:29:45 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D06996E455;
	Mon,  7 Sep 2020 13:29:38 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x544.google.com (mail-ed1-x544.google.com
 [IPv6:2a00:1450:4864:20::544])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3D08E6E44E
 for <dri-devel@lists.freedesktop.org>; Mon,  7 Sep 2020 13:29:38 +0000 (UTC)
Received: by mail-ed1-x544.google.com with SMTP id ay8so12807941edb.8
 for <dri-devel@lists.freedesktop.org>; Mon, 07 Sep 2020 06:29:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:subject:date:message-id:in-reply-to:references:mime-version
 :content-transfer-encoding;
 bh=nPYK0o5qszdgTxx33p8ErwbSCeIo53J6kP0bd2x9Gzo=;
 b=JfhKDa3cn1lXtdPULMFN6Njdr1O5hB+gaGwcX55NRwIT6ofjvU6hN19qvkcG44jCAC
 zoF5sXhfKiJxYlTJQxAvDrHki62biLvmSXDhFNU3UnSeBs7CVYOA8zruAXp1ChicLPZU
 dUyRLE7vvgjCDeeHNEjUczuiR5bRGlelXi3YOeZZW2fGZWTpXcOUDJqfnRA+QqE3csFv
 zRyQ4Wu+HSVOxcLkD9A86KejZ3RUKM6nS8iRiL8E8ymyT2XvTYD89VYPkn5l71VcFZFV
 XEViIgMkGrl2tKVrAFz8QVgnq6Bel3YzZfyOx2tnhk7HnwZlR3+3PwupAKMUrAqjfAIa
 QnfA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=nPYK0o5qszdgTxx33p8ErwbSCeIo53J6kP0bd2x9Gzo=;
 b=Nh3fgG93dSY7M0JBTs984D8Po9BIQ5jPiUDML6RcsICNUs0V3we8dnqJUTmuSf1Oib
 tj1FY18vvOSDT44v7qdZhgdR20woF8N5LkAG4aKqjfSTt2VyoXYGrEzSjcWZiva1GnqU
 gChOZghi7N49khP9i8Vixx1U28S87LxW+txCuTPlqq0ZL3Qzpaq4gu26fxaRzJR1jjni
 WS1JcpLRcOhPKaVKbzJT4BCkiNqpljd/B5F8Tb9J+You9Uke9SV4G/61ITthXXHnp/5l
 vmbbSSBiK28maoho9/XXA4M9Bm25/T+7sOkh+hdbqI8AGgAQpZsHyXgaK/6LNGFrMW/V
 3M5g==
X-Gm-Message-State: AOAM532V9JXsACn/5Xj5ddM8giolJEqvL8MR2YCOC5D6/ICsaNCWpbAG
 c09GKioJkTBaZ1sj4Qq6qKhyvwaWuFY=
X-Google-Smtp-Source: ABdhPJy1Cghr9yPOtwy/ogq/HimmKMvLqecLejjtBsdwN458qCASLaAjv1i8Ysb8bSgN03p2+Diwjw==
X-Received: by 2002:aa7:d7ca:: with SMTP id e10mr21058566eds.191.1599485376848; 
 Mon, 07 Sep 2020 06:29:36 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:b600:ca59:71b3:2cdb])
 by smtp.gmail.com with ESMTPSA id c5sm14730568edt.24.2020.09.07.06.29.36
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 07 Sep 2020 06:29:36 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: airlied@gmail.com,
	dri-devel@lists.freedesktop.org
Subject: [PATCH 2/2] drm/ttm: merge offset and base in ttm_bus_placement
Date: Mon,  7 Sep 2020 15:29:33 +0200
Message-Id: <20200907132933.5401-2-christian.koenig@amd.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200907132933.5401-1-christian.koenig@amd.com>
References: <20200907132933.5401-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBpcyB1c2VkIGJ5IFRUTSB0byBjb21tdW5pY2F0ZSB0aGUgcGh5c2ljYWwgYWRkcmVzcwp3
aGljaCBzaG91bGQgYmUgdXNlZCB3aXRoIGlvcmVtYXAoKSwgaW9yZW1hcF93YygpLiBXZSBkb24n
dApuZWVkIHRvIHNlcGFyYXRlIHRoZSBiYXNlIGFuZCBvZmZzZXQgaW4gYW55IHdheSBoZXJlLgoK
U2lnbmVkLW9mZi1ieTogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0aWFuLmtvZW5pZ0BhbWQuY29t
PgotLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYyAgICB8ICA3ICsr
KystLS0KIGRyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX3R0bV9oZWxwZXIuYyAgICAgICB8ICA1ICst
LS0tCiBkcml2ZXJzL2dwdS9kcm0vZHJtX2dlbV92cmFtX2hlbHBlci5jICAgICAgfCAgMyArLS0K
IGRyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfYm8uYyAgICAgICB8ICA5ICsrKystLS0t
LQogZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9mYmNvbi5jICAgIHwgIDMgKy0tCiBk
cml2ZXJzL2dwdS9kcm0vcXhsL3F4bF90dG0uYyAgICAgICAgICAgICAgfCAgNyArKystLS0tCiBk
cml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl90dG0uYyAgICAgICAgfCAxNCArKysrKystLS0t
LS0tLQogZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm8uYyAgICAgICAgICAgICAgIHwgIDMgLS0t
CiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGlsLmMgICAgICAgICAgfCAxNyArKysrKyst
LS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm9fdm0uYyAgICAgICAgICAgIHwg
IDMgKy0tCiBkcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF90dG1fYnVmZmVyLmMgfCAgNCAr
Ky0tCiBpbmNsdWRlL2RybS90dG0vdHRtX3Jlc291cmNlLmggICAgICAgICAgICAgfCAgNiArKy0t
LS0KIDEyIGZpbGVzIGNoYW5nZWQsIDMxIGluc2VydGlvbnMoKyksIDUwIGRlbGV0aW9ucygtKQoK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYwppbmRleCA0NmQ2MjA4MTc0ODIu
LmIzOWQyYTgzNDM0MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X3R0bS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYwpA
QCAtNzczLDcgKzc3Myw3IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X3R0bV9pb19tZW1fcmVzZXJ2ZShz
dHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV9yZXNvCiAJCQltZW0tPmJ1cy5h
ZGRyID0gKHU4ICopYWRldi0+bW1hbi5hcGVyX2Jhc2Vfa2FkZHIgKwogCQkJCQltZW0tPmJ1cy5v
ZmZzZXQ7CiAKLQkJbWVtLT5idXMuYmFzZSA9IGFkZXYtPmdtYy5hcGVyX2Jhc2U7CisJCW1lbS0+
YnVzLm9mZnNldCArPSBhZGV2LT5nbWMuYXBlcl9iYXNlOwogCQltZW0tPmJ1cy5pc19pb21lbSA9
IHRydWU7CiAJCWJyZWFrOwogCWRlZmF1bHQ6CkBAIC03ODUsMTIgKzc4NSwxMyBAQCBzdGF0aWMg
aW50IGFtZGdwdV90dG1faW9fbWVtX3Jlc2VydmUoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYs
IHN0cnVjdCB0dG1fcmVzbwogc3RhdGljIHVuc2lnbmVkIGxvbmcgYW1kZ3B1X3R0bV9pb19tZW1f
cGZuKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJCQkJCSAgIHVuc2lnbmVkIGxvbmcg
cGFnZV9vZmZzZXQpCiB7CisJc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSBhbWRncHVfdHRt
X2FkZXYoYm8tPmJkZXYpOwogCXVpbnQ2NF90IG9mZnNldCA9IChwYWdlX29mZnNldCA8PCBQQUdF
X1NISUZUKTsKIAlzdHJ1Y3QgZHJtX21tX25vZGUgKm1tOwogCiAJbW0gPSBhbWRncHVfZmluZF9t
bV9ub2RlKCZiby0+bWVtLCAmb2Zmc2V0KTsKLQlyZXR1cm4gKGJvLT5tZW0uYnVzLmJhc2UgPj4g
UEFHRV9TSElGVCkgKyBtbS0+c3RhcnQgKwotCQkob2Zmc2V0ID4+IFBBR0VfU0hJRlQpOworCW9m
ZnNldCArPSBhZGV2LT5nbWMuYXBlcl9iYXNlOworCXJldHVybiBtbS0+c3RhcnQgKyAob2Zmc2V0
ID4+IFBBR0VfU0hJRlQpOwogfQogCiAvKioKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9k
cm1fZ2VtX3R0bV9oZWxwZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX3R0bV9oZWxwZXIu
YwppbmRleCA4OTJiMjI4OGExMDQuLjBlNGZiOWJhNDNhZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2RybV9nZW1fdHRtX2hlbHBlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2Vt
X3R0bV9oZWxwZXIuYwpAQCAtNDMsMTIgKzQzLDkgQEAgdm9pZCBkcm1fZ2VtX3R0bV9wcmludF9p
bmZvKHN0cnVjdCBkcm1fcHJpbnRlciAqcCwgdW5zaWduZWQgaW50IGluZGVudCwKIAlkcm1fcHJp
bnRfYml0cyhwLCBiby0+bWVtLnBsYWNlbWVudCwgcGxuYW1lLCBBUlJBWV9TSVpFKHBsbmFtZSkp
OwogCWRybV9wcmludGYocCwgIlxuIik7CiAKLQlpZiAoYm8tPm1lbS5idXMuaXNfaW9tZW0pIHsK
LQkJZHJtX3ByaW50Zl9pbmRlbnQocCwgaW5kZW50LCAiYnVzLmJhc2U9JWx4XG4iLAotCQkJCSAg
KHVuc2lnbmVkIGxvbmcpYm8tPm1lbS5idXMuYmFzZSk7CisJaWYgKGJvLT5tZW0uYnVzLmlzX2lv
bWVtKQogCQlkcm1fcHJpbnRmX2luZGVudChwLCBpbmRlbnQsICJidXMub2Zmc2V0PSVseFxuIiwK
IAkJCQkgICh1bnNpZ25lZCBsb25nKWJvLT5tZW0uYnVzLm9mZnNldCk7Ci0JfQogfQogRVhQT1JU
X1NZTUJPTChkcm1fZ2VtX3R0bV9wcmludF9pbmZvKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2RybV9nZW1fdnJhbV9oZWxwZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX3Zy
YW1faGVscGVyLmMKaW5kZXggNTQ1YTg3NzQwNmY0Li4yNTU1NjA1OTE5MTYgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2RybV9nZW1fdnJhbV9oZWxwZXIuYwpAQCAtMTA0Miw4ICsxMDQyLDcgQEAgc3RhdGljIGlu
dCBib19kcml2ZXJfaW9fbWVtX3Jlc2VydmUoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCiAJ
Y2FzZSBUVE1fUExfU1lTVEVNOgkvKiBub3RoaW5nIHRvIGRvICovCiAJCWJyZWFrOwogCWNhc2Ug
VFRNX1BMX1ZSQU06Ci0JCW1lbS0+YnVzLm9mZnNldCA9IG1lbS0+c3RhcnQgPDwgUEFHRV9TSElG
VDsKLQkJbWVtLT5idXMuYmFzZSA9IHZtbS0+dnJhbV9iYXNlOworCQltZW0tPmJ1cy5vZmZzZXQg
PSAobWVtLT5zdGFydCA8PCBQQUdFX1NISUZUKSArIHZtbS0+dnJhbV9iYXNlOwogCQltZW0tPmJ1
cy5pc19pb21lbSA9IHRydWU7CiAJCWJyZWFrOwogCWRlZmF1bHQ6CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2JvLmMgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVh
dS9ub3V2ZWF1X2JvLmMKaW5kZXggZjc0OTg4NzcxZWQ4Li40YzJjYzg2MmViMTkgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfYm8uYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vbm91dmVhdS9ub3V2ZWF1X2JvLmMKQEAgLTEwODEsOCArMTA4MSw4IEBAIG5vdXZlYXVf
dHRtX2lvX21lbV9yZXNlcnZlKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LCBzdHJ1Y3QgdHRt
X3Jlc291cmNlICpyZWcpCiAJY2FzZSBUVE1fUExfVFQ6CiAjaWYgSVNfRU5BQkxFRChDT05GSUdf
QUdQKQogCQlpZiAoZHJtLT5hZ3AuYnJpZGdlKSB7Ci0JCQlyZWctPmJ1cy5vZmZzZXQgPSByZWct
PnN0YXJ0IDw8IFBBR0VfU0hJRlQ7Ci0JCQlyZWctPmJ1cy5iYXNlID0gZHJtLT5hZ3AuYmFzZTsK
KwkJCXJlZy0+YnVzLm9mZnNldCA9IChyZWctPnN0YXJ0IDw8IFBBR0VfU0hJRlQpICsKKwkJCQlk
cm0tPmFncC5iYXNlOwogCQkJcmVnLT5idXMuaXNfaW9tZW0gPSAhZHJtLT5hZ3AuY21hOwogCQl9
CiAjZW5kaWYKQEAgLTEwOTQsOCArMTA5NCw4IEBAIG5vdXZlYXVfdHRtX2lvX21lbV9yZXNlcnZl
KHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LCBzdHJ1Y3QgdHRtX3Jlc291cmNlICpyZWcpCiAJ
CX0KIAkJZmFsbHRocm91Z2g7CS8qIHRpbGVkIG1lbW9yeSAqLwogCWNhc2UgVFRNX1BMX1ZSQU06
Ci0JCXJlZy0+YnVzLm9mZnNldCA9IHJlZy0+c3RhcnQgPDwgUEFHRV9TSElGVDsKLQkJcmVnLT5i
dXMuYmFzZSA9IGRldmljZS0+ZnVuYy0+cmVzb3VyY2VfYWRkcihkZXZpY2UsIDEpOworCQlyZWct
PmJ1cy5vZmZzZXQgPSAocmVnLT5zdGFydCA8PCBQQUdFX1NISUZUKSArCisJCQlkZXZpY2UtPmZ1
bmMtPnJlc291cmNlX2FkZHIoZGV2aWNlLCAxKTsKIAkJcmVnLT5idXMuaXNfaW9tZW0gPSB0cnVl
OwogCQlpZiAoZHJtLT5jbGllbnQubWVtLT5vY2xhc3MgPj0gTlZJRl9DTEFTU19NRU1fTlY1MCkg
ewogCQkJdW5pb24gewpAQCAtMTEzMyw3ICsxMTMzLDYgQEAgbm91dmVhdV90dG1faW9fbWVtX3Jl
c2VydmUoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fcmVzb3VyY2UgKnJl
ZykKIAkJCQlnb3RvIG91dDsKIAkJCX0KIAotCQkJcmVnLT5idXMuYmFzZSA9IDA7CiAJCQlyZWct
PmJ1cy5vZmZzZXQgPSBoYW5kbGU7CiAJCQlyZXQgPSAwOwogCQl9CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2ZiY29uLmMgYi9kcml2ZXJzL2dwdS9kcm0vbm91
dmVhdS9ub3V2ZWF1X2ZiY29uLmMKaW5kZXggZmFkODAzMGVjMWY4Li4zMTU5YTIxNzJkYjUgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfZmJjb24uYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2ZiY29uLmMKQEAgLTM3OCw4ICszNzgsNyBA
QCBub3V2ZWF1X2ZiY29uX2NyZWF0ZShzdHJ1Y3QgZHJtX2ZiX2hlbHBlciAqaGVscGVyLAogCQkJ
ICAgICAgRkJJTkZPX0hXQUNDRUxfRklMTFJFQ1QgfAogCQkJICAgICAgRkJJTkZPX0hXQUNDRUxf
SU1BR0VCTElUOwogCWluZm8tPmZib3BzID0gJm5vdXZlYXVfZmJjb25fc3dfb3BzOwotCWluZm8t
PmZpeC5zbWVtX3N0YXJ0ID0gbnZiby0+Ym8ubWVtLmJ1cy5iYXNlICsKLQkJCSAgICAgICBudmJv
LT5iby5tZW0uYnVzLm9mZnNldDsKKwlpbmZvLT5maXguc21lbV9zdGFydCA9IG52Ym8tPmJvLm1l
bS5idXMub2Zmc2V0OwogCWluZm8tPmZpeC5zbWVtX2xlbiA9IG52Ym8tPmJvLm1lbS5udW1fcGFn
ZXMgPDwgUEFHRV9TSElGVDsKIAogCWluZm8tPnNjcmVlbl9iYXNlID0gbnZib19rbWFwX29ial9p
b3ZpcnR1YWwobnZibyk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF90dG0u
YyBiL2RyaXZlcnMvZ3B1L2RybS9xeGwvcXhsX3R0bS5jCmluZGV4IDdhYWUwYTk2ZjA0My4uYjIw
YzM1NjIyOWMzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF90dG0uYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF90dG0uYwpAQCAtODEsMTMgKzgxLDEyIEBAIGludCBx
eGxfdHRtX2lvX21lbV9yZXNlcnZlKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAogCQlyZXR1
cm4gMDsKIAljYXNlIFRUTV9QTF9WUkFNOgogCQltZW0tPmJ1cy5pc19pb21lbSA9IHRydWU7Ci0J
CW1lbS0+YnVzLmJhc2UgPSBxZGV2LT52cmFtX2Jhc2U7Ci0JCW1lbS0+YnVzLm9mZnNldCA9IG1l
bS0+c3RhcnQgPDwgUEFHRV9TSElGVDsKKwkJbWVtLT5idXMub2Zmc2V0ID0gKG1lbS0+c3RhcnQg
PDwgUEFHRV9TSElGVCkgKyBxZGV2LT52cmFtX2Jhc2U7CiAJCWJyZWFrOwogCWNhc2UgVFRNX1BM
X1BSSVY6CiAJCW1lbS0+YnVzLmlzX2lvbWVtID0gdHJ1ZTsKLQkJbWVtLT5idXMuYmFzZSA9IHFk
ZXYtPnN1cmZhY2VyYW1fYmFzZTsKLQkJbWVtLT5idXMub2Zmc2V0ID0gbWVtLT5zdGFydCA8PCBQ
QUdFX1NISUZUOworCQltZW0tPmJ1cy5vZmZzZXQgPSAobWVtLT5zdGFydCA8PCBQQUdFX1NISUZU
KSArCisJCQlxZGV2LT5zdXJmYWNlcmFtX2Jhc2U7CiAJCWJyZWFrOwogCWRlZmF1bHQ6CiAJCXJl
dHVybiAtRUlOVkFMOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25f
dHRtLmMgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl90dG0uYwppbmRleCA3NGFkNTBj
NzQ5MWMuLjRjZmFkZGE3YmUyYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9y
YWRlb25fdHRtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fdHRtLmMKQEAg
LTM3Miw4ICszNzIsOCBAQCBzdGF0aWMgaW50IHJhZGVvbl90dG1faW9fbWVtX3Jlc2VydmUoc3Ry
dWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fcmVzbwogI2lmIElTX0VOQUJMRUQo
Q09ORklHX0FHUCkKIAkJaWYgKHJkZXYtPmZsYWdzICYgUkFERU9OX0lTX0FHUCkgewogCQkJLyog
UkFERU9OX0lTX0FHUCBpcyBzZXQgb25seSBpZiBBR1AgaXMgYWN0aXZlICovCi0JCQltZW0tPmJ1
cy5vZmZzZXQgPSBtZW0tPnN0YXJ0IDw8IFBBR0VfU0hJRlQ7Ci0JCQltZW0tPmJ1cy5iYXNlID0g
cmRldi0+bWMuYWdwX2Jhc2U7CisJCQltZW0tPmJ1cy5vZmZzZXQgPSAobWVtLT5zdGFydCA8PCBQ
QUdFX1NISUZUKSArCisJCQkJcmRldi0+bWMuYWdwX2Jhc2U7CiAJCQltZW0tPmJ1cy5pc19pb21l
bSA9ICFyZGV2LT5kZGV2LT5hZ3AtPmNhbnRfdXNlX2FwZXJ0dXJlOwogCQl9CiAjZW5kaWYKQEAg
LTM4Myw3ICszODMsNyBAQCBzdGF0aWMgaW50IHJhZGVvbl90dG1faW9fbWVtX3Jlc2VydmUoc3Ry
dWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fcmVzbwogCQkvKiBjaGVjayBpZiBp
dCdzIHZpc2libGUgKi8KIAkJaWYgKChtZW0tPmJ1cy5vZmZzZXQgKyBidXNfc2l6ZSkgPiByZGV2
LT5tYy52aXNpYmxlX3ZyYW1fc2l6ZSkKIAkJCXJldHVybiAtRUlOVkFMOwotCQltZW0tPmJ1cy5i
YXNlID0gcmRldi0+bWMuYXBlcl9iYXNlOworCQltZW0tPmJ1cy5vZmZzZXQgKz0gcmRldi0+bWMu
YXBlcl9iYXNlOwogCQltZW0tPmJ1cy5pc19pb21lbSA9IHRydWU7CiAjaWZkZWYgX19hbHBoYV9f
CiAJCS8qCkBAIC0zOTIsMTIgKzM5MiwxMCBAQCBzdGF0aWMgaW50IHJhZGVvbl90dG1faW9fbWVt
X3Jlc2VydmUoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fcmVzbwogCQkg
Ki8KIAkJaWYgKG1lbS0+cGxhY2VtZW50ICYgVFRNX1BMX0ZMQUdfV0MpCiAJCQltZW0tPmJ1cy5h
ZGRyID0KLQkJCQlpb3JlbWFwX3djKG1lbS0+YnVzLmJhc2UgKyBtZW0tPmJ1cy5vZmZzZXQsCi0J
CQkJCSAgIGJ1c19zaXplKTsKKwkJCQlpb3JlbWFwX3djKG1lbS0+YnVzLm9mZnNldCwgYnVzX3Np
emUpOwogCQllbHNlCiAJCQltZW0tPmJ1cy5hZGRyID0KLQkJCQlpb3JlbWFwKG1lbS0+YnVzLmJh
c2UgKyBtZW0tPmJ1cy5vZmZzZXQsCi0JCQkJCWJ1c19zaXplKTsKKwkJCQlpb3JlbWFwKG1lbS0+
YnVzLm9mZnNldCwgYnVzX3NpemUpOwogCQlpZiAoIW1lbS0+YnVzLmFkZHIpCiAJCQlyZXR1cm4g
LUVOT01FTTsKIApAQCAtNDA3LDcgKzQwNSw3IEBAIHN0YXRpYyBpbnQgcmFkZW9uX3R0bV9pb19t
ZW1fcmVzZXJ2ZShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV9yZXNvCiAJ
CSAqIEl0IHRoZW4gY2FuIGJlIHVzZWQgdG8gYnVpbGQgUFRFcyBmb3IgVlJBTQogCQkgKiBhY2Nl
c3MsIGFzIGRvbmUgaW4gdHRtX2JvX3ZtX2ZhdWx0KCkuCiAJCSAqLwotCQltZW0tPmJ1cy5iYXNl
ID0gKG1lbS0+YnVzLmJhc2UgJiAweDBmZmZmZmZmZlVMKSArCisJCW1lbS0+YnVzLm9mZnNldCA9
IChtZW0tPmJ1cy5vZmZzZXQgJiAweDBmZmZmZmZmZlVMKSArCiAJCQlyZGV2LT5kZGV2LT5ob3Nl
LT5kZW5zZV9tZW1fYmFzZTsKICNlbmRpZgogCQlicmVhazsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS90dG0vdHRtX2JvLmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5jCmluZGV4
IDg5ZDhhYjZlZGQ0MC4uMDgxMmY0Y2U0MGRiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
dHRtL3R0bV9iby5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvLmMKQEAgLTY0MSw3
ICs2NDEsNiBAQCBzdGF0aWMgaW50IHR0bV9ib19ldmljdChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmpl
Y3QgKmJvLAogCiAJZXZpY3RfbWVtID0gYm8tPm1lbTsKIAlldmljdF9tZW0ubW1fbm9kZSA9IE5V
TEw7Ci0JZXZpY3RfbWVtLmJ1cy5iYXNlID0gMDsKIAlldmljdF9tZW0uYnVzLm9mZnNldCA9IDA7
CiAJZXZpY3RfbWVtLmJ1cy5hZGRyID0gTlVMTDsKIApAQCAtMTA3Niw3ICsxMDc1LDYgQEAgc3Rh
dGljIGludCB0dG1fYm9fbW92ZV9idWZmZXIoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywK
IAltZW0ubnVtX3BhZ2VzID0gYm8tPm51bV9wYWdlczsKIAltZW0uc2l6ZSA9IG1lbS5udW1fcGFn
ZXMgPDwgUEFHRV9TSElGVDsKIAltZW0ucGFnZV9hbGlnbm1lbnQgPSBiby0+bWVtLnBhZ2VfYWxp
Z25tZW50OwotCW1lbS5idXMuYmFzZSA9IDA7CiAJbWVtLmJ1cy5vZmZzZXQgPSAwOwogCW1lbS5i
dXMuYWRkciA9IE5VTEw7CiAJbWVtLm1tX25vZGUgPSBOVUxMOwpAQCAtMTIzNSw3ICsxMjMzLDYg
QEAgaW50IHR0bV9ib19pbml0X3Jlc2VydmVkKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAog
CWJvLT5tZW0ubnVtX3BhZ2VzID0gYm8tPm51bV9wYWdlczsKIAliby0+bWVtLm1tX25vZGUgPSBO
VUxMOwogCWJvLT5tZW0ucGFnZV9hbGlnbm1lbnQgPSBwYWdlX2FsaWdubWVudDsKLQliby0+bWVt
LmJ1cy5iYXNlID0gMDsKIAliby0+bWVtLmJ1cy5vZmZzZXQgPSAwOwogCWJvLT5tZW0uYnVzLmFk
ZHIgPSBOVUxMOwogCWJvLT5tb3ZpbmcgPSBOVUxMOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL3R0bS90dG1fYm9fdXRpbC5jIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm9fdXRpbC5j
CmluZGV4IDJjOTY3NjA3ZDQ4NS4uODViNjcwZTdjMjBkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vdHRtL3R0bV9ib191dGlsLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm9f
dXRpbC5jCkBAIC05NCw3ICs5NCw3IEBAIEVYUE9SVF9TWU1CT0wodHRtX2JvX21vdmVfdHRtKTsK
IGludCB0dG1fbWVtX2lvX3Jlc2VydmUoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCiAJCSAg
ICAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0pCiB7Ci0JaWYgKG1lbS0+YnVzLmJhc2UgfHwg
bWVtLT5idXMub2Zmc2V0IHx8IG1lbS0+YnVzLmFkZHIpCisJaWYgKG1lbS0+YnVzLm9mZnNldCB8
fCBtZW0tPmJ1cy5hZGRyKQogCQlyZXR1cm4gMDsKIAogCW1lbS0+YnVzLmlzX2lvbWVtID0gZmFs
c2U7CkBAIC0xMDcsMTMgKzEwNywxMiBAQCBpbnQgdHRtX21lbV9pb19yZXNlcnZlKHN0cnVjdCB0
dG1fYm9fZGV2aWNlICpiZGV2LAogdm9pZCB0dG1fbWVtX2lvX2ZyZWUoc3RydWN0IHR0bV9ib19k
ZXZpY2UgKmJkZXYsCiAJCSAgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqbWVtKQogewotCWlmICgh
bWVtLT5idXMuYmFzZSAmJiAhbWVtLT5idXMub2Zmc2V0ICYmICFtZW0tPmJ1cy5hZGRyKQorCWlm
ICghbWVtLT5idXMub2Zmc2V0ICYmICFtZW0tPmJ1cy5hZGRyKQogCQlyZXR1cm47CiAKIAlpZiAo
YmRldi0+ZHJpdmVyLT5pb19tZW1fZnJlZSkKIAkJYmRldi0+ZHJpdmVyLT5pb19tZW1fZnJlZShi
ZGV2LCBtZW0pOwogCi0JbWVtLT5idXMuYmFzZSA9IDA7CiAJbWVtLT5idXMub2Zmc2V0ID0gMDsK
IAltZW0tPmJ1cy5hZGRyID0gTlVMTDsKIH0KQEAgLTEzNiwxMSArMTM1LDkgQEAgc3RhdGljIGlu
dCB0dG1fcmVzb3VyY2VfaW9yZW1hcChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKIAkJc2l6
ZV90IGJ1c19zaXplID0gKHNpemVfdCltZW0tPm51bV9wYWdlcyA8PCBQQUdFX1NISUZUOwogCiAJ
CWlmIChtZW0tPnBsYWNlbWVudCAmIFRUTV9QTF9GTEFHX1dDKQotCQkJYWRkciA9IGlvcmVtYXBf
d2MobWVtLT5idXMuYmFzZSArIG1lbS0+YnVzLm9mZnNldCwKLQkJCQkJICBidXNfc2l6ZSk7CisJ
CQlhZGRyID0gaW9yZW1hcF93YyhtZW0tPmJ1cy5vZmZzZXQsIGJ1c19zaXplKTsKIAkJZWxzZQot
CQkJYWRkciA9IGlvcmVtYXAobWVtLT5idXMuYmFzZSArIG1lbS0+YnVzLm9mZnNldCwKLQkJCQkg
ICAgICAgYnVzX3NpemUpOworCQkJYWRkciA9IGlvcmVtYXAobWVtLT5idXMub2Zmc2V0LCBidXNf
c2l6ZSk7CiAJCWlmICghYWRkcikgewogCQkJdHRtX21lbV9pb19mcmVlKGJkZXYsIG1lbSk7CiAJ
CQlyZXR1cm4gLUVOT01FTTsKQEAgLTQyNywxMiArNDI0LDEwIEBAIHN0YXRpYyBpbnQgdHRtX2Jv
X2lvcmVtYXAoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAl9IGVsc2UgewogCQltYXAt
PmJvX2ttYXBfdHlwZSA9IHR0bV9ib19tYXBfaW9tYXA7CiAJCWlmIChtZW0tPnBsYWNlbWVudCAm
IFRUTV9QTF9GTEFHX1dDKQotCQkJbWFwLT52aXJ0dWFsID0gaW9yZW1hcF93Yyhiby0+bWVtLmJ1
cy5iYXNlICsKLQkJCQkJCSAgYm8tPm1lbS5idXMub2Zmc2V0ICsgb2Zmc2V0LAorCQkJbWFwLT52
aXJ0dWFsID0gaW9yZW1hcF93Yyhiby0+bWVtLmJ1cy5vZmZzZXQgKyBvZmZzZXQsCiAJCQkJCQkg
IHNpemUpOwogCQllbHNlCi0JCQltYXAtPnZpcnR1YWwgPSBpb3JlbWFwKGJvLT5tZW0uYnVzLmJh
c2UgKwotCQkJCQkgICAgICAgYm8tPm1lbS5idXMub2Zmc2V0ICsgb2Zmc2V0LAorCQkJbWFwLT52
aXJ0dWFsID0gaW9yZW1hcChiby0+bWVtLmJ1cy5vZmZzZXQgKyBvZmZzZXQsCiAJCQkJCSAgICAg
ICBzaXplKTsKIAl9CiAJcmV0dXJuICghbWFwLT52aXJ0dWFsKSA/IC1FTk9NRU0gOiAwOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm9fdm0uYyBiL2RyaXZlcnMvZ3B1L2Ry
bS90dG0vdHRtX2JvX3ZtLmMKaW5kZXggZDNkYzA2ODI0MjVjLi5lYjEwMTdhZjA3MTAgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3ZtLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL3R0bS90dG1fYm9fdm0uYwpAQCAtMTAxLDggKzEwMSw3IEBAIHN0YXRpYyB1bnNpZ25lZCBs
b25nIHR0bV9ib19pb19tZW1fcGZuKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJaWYg
KGJkZXYtPmRyaXZlci0+aW9fbWVtX3BmbikKIAkJcmV0dXJuIGJkZXYtPmRyaXZlci0+aW9fbWVt
X3BmbihibywgcGFnZV9vZmZzZXQpOwogCi0JcmV0dXJuICgoYm8tPm1lbS5idXMuYmFzZSArIGJv
LT5tZW0uYnVzLm9mZnNldCkgPj4gUEFHRV9TSElGVCkKLQkJKyBwYWdlX29mZnNldDsKKwlyZXR1
cm4gKGJvLT5tZW0uYnVzLm9mZnNldCA+PiBQQUdFX1NISUZUKSArIHBhZ2Vfb2Zmc2V0OwogfQog
CiAvKioKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3R0bV9idWZm
ZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3R0bV9idWZmZXIuYwppbmRleCBj
N2YxMGIyYzkzZDIuLjBhZGJhY2QyOTA2NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Zt
d2dmeC92bXdnZnhfdHRtX2J1ZmZlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13
Z2Z4X3R0bV9idWZmZXIuYwpAQCAtNzIxLDggKzcyMSw4IEBAIHN0YXRpYyBpbnQgdm13X3R0bV9p
b19tZW1fcmVzZXJ2ZShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV9yZXNv
dXJjCiAJY2FzZSBWTVdfUExfTU9COgogCQlyZXR1cm4gMDsKIAljYXNlIFRUTV9QTF9WUkFNOgot
CQltZW0tPmJ1cy5vZmZzZXQgPSBtZW0tPnN0YXJ0IDw8IFBBR0VfU0hJRlQ7Ci0JCW1lbS0+YnVz
LmJhc2UgPSBkZXZfcHJpdi0+dnJhbV9zdGFydDsKKwkJbWVtLT5idXMub2Zmc2V0ID0gKG1lbS0+
c3RhcnQgPDwgUEFHRV9TSElGVCkgKworCQkJZGV2X3ByaXYtPnZyYW1fc3RhcnQ7CiAJCW1lbS0+
YnVzLmlzX2lvbWVtID0gdHJ1ZTsKIAkJYnJlYWs7CiAJZGVmYXVsdDoKZGlmZiAtLWdpdCBhL2lu
Y2x1ZGUvZHJtL3R0bS90dG1fcmVzb3VyY2UuaCBiL2luY2x1ZGUvZHJtL3R0bS90dG1fcmVzb3Vy
Y2UuaAppbmRleCA0MDZiYWE4ZjAwNjguLjdiOGEzMTU3ZmJiMyAxMDA2NDQKLS0tIGEvaW5jbHVk
ZS9kcm0vdHRtL3R0bV9yZXNvdXJjZS5oCisrKyBiL2luY2x1ZGUvZHJtL3R0bS90dG1fcmVzb3Vy
Y2UuaApAQCAtMTQ4LDE2ICsxNDgsMTQgQEAgc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyIHsK
ICAqIHN0cnVjdCB0dG1fYnVzX3BsYWNlbWVudAogICoKICAqIEBhZGRyOgkJbWFwcGVkIHZpcnR1
YWwgYWRkcmVzcwotICogQGJhc2U6CQlidXMgYmFzZSBhZGRyZXNzCisgKiBAb2Zmc2V0OgkJcGh5
c2ljYWwgYWRkcgogICogQGlzX2lvbWVtOgkJaXMgdGhpcyBpbyBtZW1vcnkgPwotICogQG9mZnNl
dDoJCW9mZnNldCBmcm9tIHRoZSBiYXNlIGFkZHJlc3MKICAqCiAgKiBTdHJ1Y3R1cmUgaW5kaWNh
dGluZyB0aGUgYnVzIHBsYWNlbWVudCBvZiBhbiBvYmplY3QuCiAgKi8KIHN0cnVjdCB0dG1fYnVz
X3BsYWNlbWVudCB7CiAJdm9pZAkJKmFkZHI7Ci0JcGh5c19hZGRyX3QJYmFzZTsKLQl1bnNpZ25l
ZCBsb25nCW9mZnNldDsKKwlwaHlzX2FkZHJfdAlvZmZzZXQ7CiAJYm9vbAkJaXNfaW9tZW07CiB9
OwogCi0tIAoyLjE3LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9w
Lm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1k
ZXZlbAo=
