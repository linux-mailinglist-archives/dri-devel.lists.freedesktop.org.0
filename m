Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 7DE8F1790C
	for <lists+dri-devel@lfdr.de>; Wed,  8 May 2019 14:06:03 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7153689804;
	Wed,  8 May 2019 12:06:01 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3C7CC89804
 for <dri-devel@lists.freedesktop.org>; Wed,  8 May 2019 12:06:00 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16489689-1500050 
 for multiple; Wed, 08 May 2019 13:05:51 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 1/2] drm/i915: Seal races between async GPU cancellation,
 retirement and signaling
Date: Wed,  8 May 2019 13:05:41 +0100
Message-Id: <20190508120542.28377-2-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190508120542.28377-1-chris@chris-wilson.co.uk>
References: <20190508120542.28377-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Tvrtko Ursulin <tvrtko.ursulin@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

Q3VycmVudGx5IHRoZXJlIGlzIGFuIHVuZGVybHlpbmcgYXNzdW1wdGlvbiB0aGF0IGk5MTVfcmVx
dWVzdF91bnN1Ym1pdCgpCmlzIHN5bmNocm9ub3VzIHdydCB0aGUgR1BVIC0tIHRoYXQgaXMgdGhl
IHJlcXVlc3QgaXMgbm8gbG9uZ2VyIGluIGZsaWdodAphcyB3ZSByZW1vdmUgaXQuIEluIHRoZSBu
ZWFyIGZ1dHVyZSB0aGF0IG1heSBjaGFuZ2UsIGFuZCB0aGlzIG1heSB1cHNldApvdXIgc2lnbmFs
aW5nIGFzIHdlIGNhbiBwcm9jZXNzIGFuIGludGVycnVwdCBmb3IgdGhhdCByZXF1ZXN0IHdoaWxl
IGl0CmlzIG5vIGxvbmdlciBpbiBmbGlnaHQuCgpDUFUwCQkJCQlDUFUxCmludGVsX2VuZ2luZV9i
cmVhZGNydW1ic19pcnEKKHF1ZXVlIHJlcXVlc3QgY29tcGxldGlvbikKCQkJCQlpOTE1X3JlcXVl
c3RfY2FuY2VsX3NpZ25hbGluZwouLi4JCQkJCS4uLgoJCQkJCWk5MTVfcmVxdWVzdF9lbmFibGVf
c2lnbmFsaW5nCmRtYV9mZW5jZV9zaWduYWwKCkhlbmNlIGluIHRoZSB0aW1lIGl0IHRvb2sgdXMg
dG8gZHJvcCB0aGUgbG9jayB0byBzaWduYWwgdGhlIHJlcXVlc3QsIGEKcHJlZW1wdGlvbiBldmVu
dCBtYXkgaGF2ZSBvY2N1cnJlZCBhbmQgcmUtcXVldWVkIHRoZSByZXF1ZXN0LiBJbiB0aGUKcHJv
Y2VzcywgdGhhdCByZXF1ZXN0IHdvdWxkIGhhdmUgc2VlbiBJOTE1X0ZFTkNFX0ZMQUdfU0lHTkFM
IGNsZWFyIGFuZApzbyByZXVzZWQgdGhlIHJxLT5zaWduYWxfbGluayB0aGF0IHdhcyBpbiB1c2Ug
b24gQ1BVMCwgbGVhZGluZyB0byBiYWQKcG9pbnRlciBjaGFzaW5nIGluIGludGVsX2VuZ2luZV9i
cmVhZGNydW1ic19pcnEuCgpBIHJlbGF0ZWQgaXNzdWUgd2FzIHRoYXQgaWYgc29tZW9uZSBzdGFy
dGVkIGxpc3RlbmluZyBmb3IgYSBzaWduYWwgb24gYQpjb21wbGV0ZWQgYnV0IG5vIGxvbmdlciBp
bi1mbGlnaHQgcmVxdWVzdCwgd2UgbWlzc2VkIHRoZSBvcHBvcnR1bml0eSB0bwppbW1lZGlhdGVs
eSBzaWduYWwgdGhhdCByZXF1ZXN0LgoKRnVydGhlcm1vcmUsIGFzIGludGVsX2NvbnRleHRzIG1h
eSBiZSBpbW1lZGlhdGVseSByZWxlYXNlZCBkdXJpbmcKcmVxdWVzdCByZXRpcmVtZW50LCBpbiBv
cmRlciB0byBiZSBlbnRpcmVseSBzdXJlIHRoYXQKaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJzX2ly
cSBtYXkgbm8gbG9uZ2VyIGRlcmVmZXJlbmNlIHRoZSBpbnRlbF9jb250ZXh0CihjZS0+c2lnbmFs
cyBhbmQgY2UtPnNpZ25hbF9saW5rKSwgd2UgbXVzdCB3YWl0IGZvciBpcnEgc3BpbmxvY2suCgpJ
biBvcmRlciB0byBwcmV2ZW50IHRoZSByYWNlLCB3ZSB1c2UgYSBiaXQgaW4gdGhlIGZlbmNlLmZs
YWdzIHRvIHNpZ25hbAp0aGUgdHJhbnNmZXIgb250byB0aGUgc2lnbmFsIGxpc3QgaW5zaWRlIGlu
dGVsX2VuZ2luZV9icmVhZGNydW1ic19pcnEuCkZvciBzaW1wbGljaXR5LCB3ZSB1c2UgdGhlIERN
QV9GRU5DRV9GTEFHX1NJR05BTEVEX0JJVCBhcyBpdCB0aGVuCnF1aWNrbHkgc2lnbmFscyB0byBh
bnkgb3V0c2lkZSBvYnNlcnZlciB0aGF0IHRoZSBmZW5jZSBpcyBpbmRlZWQgc2lnbmFsZWQuCgp2
MjogU2tldGNoIG91dCBwb3RlbnRpYWwgZG1hLWZlbmNlIEFQSSBmb3IgbWFudWFsIHNpZ25hbGlu
Zwp2MzogQW5kIHRoZSB0ZXN0X2FuZF9zZXRfYml0KCkKCkZpeGVzOiA1MmMwZmRiMjVjN2MgKCJk
cm0vaTkxNTogUmVwbGFjZSBnbG9iYWwgYnJlYWRjcnVtYnMgd2l0aCBwZXItY29udGV4dCBpbnRl
cnJ1cHQgdHJhY2tpbmciKQpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlz
LXdpbHNvbi5jby51az4KQ2M6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBpbnRlbC5j
b20+ClJldmlld2VkLWJ5OiBUdnJ0a28gVXJzdWxpbiA8dHZydGtvLnVyc3VsaW5AaW50ZWwuY29t
PgotLS0KIGRyaXZlcnMvZG1hLWJ1Zi9kbWEtZmVuY2UuYyAgICAgICAgICAgICAgICAgfCAgMSAr
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9icmVhZGNydW1icy5jIHwgNzggKysrKysr
KysrKysrKysrLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYyAgICAg
ICAgIHwgIDEgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYyB8
ICAxIC0KIDQgZmlsZXMgY2hhbmdlZCwgNTkgaW5zZXJ0aW9ucygrKSwgMjIgZGVsZXRpb25zKC0p
CgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9kbWEtYnVmL2RtYS1mZW5jZS5jIGIvZHJpdmVycy9kbWEt
YnVmL2RtYS1mZW5jZS5jCmluZGV4IDNhYTg3MzNmODMyYS4uOWJmMDYwNDI2MTlhIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2RtYS1idWYvZG1hLWZlbmNlLmMKKysrIGIvZHJpdmVycy9kbWEtYnVmL2Rt
YS1mZW5jZS5jCkBAIC0yOSw2ICsyOSw3IEBACiAKIEVYUE9SVF9UUkFDRVBPSU5UX1NZTUJPTChk
bWFfZmVuY2VfZW1pdCk7CiBFWFBPUlRfVFJBQ0VQT0lOVF9TWU1CT0woZG1hX2ZlbmNlX2VuYWJs
ZV9zaWduYWwpOworRVhQT1JUX1RSQUNFUE9JTlRfU1lNQk9MKGRtYV9mZW5jZV9zaWduYWxlZCk7
CiAKIHN0YXRpYyBERUZJTkVfU1BJTkxPQ0soZG1hX2ZlbmNlX3N0dWJfbG9jayk7CiBzdGF0aWMg
c3RydWN0IGRtYV9mZW5jZSBkbWFfZmVuY2Vfc3R1YjsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2JyZWFkY3J1bWJzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9icmVhZGNydW1icy5jCmluZGV4IGZlNDU1ZjAxYWE2NS4uYzA5MmJkZjVmMGJmIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9icmVhZGNydW1icy5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2JyZWFkY3J1bWJzLmMKQEAgLTIzLDYg
KzIzLDcgQEAKICAqLwogCiAjaW5jbHVkZSA8bGludXgva3RocmVhZC5oPgorI2luY2x1ZGUgPHRy
YWNlL2V2ZW50cy9kbWFfZmVuY2UuaD4KICNpbmNsdWRlIDx1YXBpL2xpbnV4L3NjaGVkL3R5cGVz
Lmg+CiAKICNpbmNsdWRlICJpOTE1X2Rydi5oIgpAQCAtOTYsOSArOTcsMzkgQEAgY2hlY2tfc2ln
bmFsX29yZGVyKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgc3RydWN0IGk5MTVfcmVxdWVzdCAq
cnEpCiAJcmV0dXJuIHRydWU7CiB9CiAKK3N0YXRpYyBib29sCitfX2RtYV9mZW5jZV9zaWduYWwo
c3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpCit7CisJcmV0dXJuICF0ZXN0X2FuZF9zZXRfYml0KERN
QV9GRU5DRV9GTEFHX1NJR05BTEVEX0JJVCwgJmZlbmNlLT5mbGFncyk7Cit9CisKK3N0YXRpYyB2
b2lkCitfX2RtYV9mZW5jZV9zaWduYWxfX3RpbWVzdGFtcChzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5j
ZSwga3RpbWVfdCB0aW1lc3RhbXApCit7CisJZmVuY2UtPnRpbWVzdGFtcCA9IHRpbWVzdGFtcDsK
KwlzZXRfYml0KERNQV9GRU5DRV9GTEFHX1RJTUVTVEFNUF9CSVQsICZmZW5jZS0+ZmxhZ3MpOwor
CXRyYWNlX2RtYV9mZW5jZV9zaWduYWxlZChmZW5jZSk7Cit9CisKK3N0YXRpYyB2b2lkCitfX2Rt
YV9mZW5jZV9zaWduYWxfX25vdGlmeShzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSkKK3sKKwlzdHJ1
Y3QgZG1hX2ZlbmNlX2NiICpjdXIsICp0bXA7CisKKwlsb2NrZGVwX2Fzc2VydF9oZWxkKGZlbmNl
LT5sb2NrKTsKKwlsb2NrZGVwX2Fzc2VydF9pcnFzX2Rpc2FibGVkKCk7CisKKwlsaXN0X2Zvcl9l
YWNoX2VudHJ5X3NhZmUoY3VyLCB0bXAsICZmZW5jZS0+Y2JfbGlzdCwgbm9kZSkgeworCQlJTklU
X0xJU1RfSEVBRCgmY3VyLT5ub2RlKTsKKwkJY3VyLT5mdW5jKGZlbmNlLCBjdXIpOworCX0KKwlJ
TklUX0xJU1RfSEVBRCgmZmVuY2UtPmNiX2xpc3QpOworfQorCiB2b2lkIGludGVsX2VuZ2luZV9i
cmVhZGNydW1ic19pcnEoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewogCXN0cnVj
dCBpbnRlbF9icmVhZGNydW1icyAqYiA9ICZlbmdpbmUtPmJyZWFkY3J1bWJzOworCWNvbnN0IGt0
aW1lX3QgdGltZXN0YW1wID0ga3RpbWVfZ2V0KCk7CiAJc3RydWN0IGludGVsX2NvbnRleHQgKmNl
LCAqY247CiAJc3RydWN0IGxpc3RfaGVhZCAqcG9zLCAqbmV4dDsKIAlMSVNUX0hFQUQoc2lnbmFs
KTsKQEAgLTEyMiw2ICsxNTMsMTAgQEAgdm9pZCBpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNfaXJx
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAogCQkJR0VNX0JVR19PTighdGVzdF9i
aXQoSTkxNV9GRU5DRV9GTEFHX1NJR05BTCwKIAkJCQkJICAgICAmcnEtPmZlbmNlLmZsYWdzKSk7
CisJCQljbGVhcl9iaXQoSTkxNV9GRU5DRV9GTEFHX1NJR05BTCwgJnJxLT5mZW5jZS5mbGFncyk7
CisKKwkJCWlmICghX19kbWFfZmVuY2Vfc2lnbmFsKCZycS0+ZmVuY2UpKQorCQkJCWNvbnRpbnVl
OwogCiAJCQkvKgogCQkJICogUXVldWUgZm9yIGV4ZWN1dGlvbiBhZnRlciBkcm9wcGluZyB0aGUg
c2lnbmFsaW5nCkBAIC0xMjksMTQgKzE2NCw2IEBAIHZvaWQgaW50ZWxfZW5naW5lX2JyZWFkY3J1
bWJzX2lycShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJCQkgKiBtb3JlIHNpZ25h
bGVycyB0byB0aGUgc2FtZSBjb250ZXh0IG9yIGVuZ2luZS4KIAkJCSAqLwogCQkJaTkxNV9yZXF1
ZXN0X2dldChycSk7Ci0KLQkJCS8qCi0JCQkgKiBXZSBtYXkgcmFjZSB3aXRoIGRpcmVjdCBpbnZv
Y2F0aW9uIG9mCi0JCQkgKiBkbWFfZmVuY2Vfc2lnbmFsKCksIGUuZy4gaTkxNV9yZXF1ZXN0X3Jl
dGlyZSgpLAotCQkJICogc28gd2UgbmVlZCB0byBhY3F1aXJlIG91ciByZWZlcmVuY2UgdG8gdGhl
IHJlcXVlc3QKLQkJCSAqIGJlZm9yZSB3ZSBjYW5jZWwgdGhlIGJyZWFkY3J1bWIuCi0JCQkgKi8K
LQkJCWNsZWFyX2JpdChJOTE1X0ZFTkNFX0ZMQUdfU0lHTkFMLCAmcnEtPmZlbmNlLmZsYWdzKTsK
IAkJCWxpc3RfYWRkX3RhaWwoJnJxLT5zaWduYWxfbGluaywgJnNpZ25hbCk7CiAJCX0KIApAQCAt
MTU5LDcgKzE4NiwxMiBAQCB2b2lkIGludGVsX2VuZ2luZV9icmVhZGNydW1ic19pcnEoc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSA9CiAJ
CQlsaXN0X2VudHJ5KHBvcywgdHlwZW9mKCpycSksIHNpZ25hbF9saW5rKTsKIAotCQlkbWFfZmVu
Y2Vfc2lnbmFsKCZycS0+ZmVuY2UpOworCQlfX2RtYV9mZW5jZV9zaWduYWxfX3RpbWVzdGFtcCgm
cnEtPmZlbmNlLCB0aW1lc3RhbXApOworCisJCXNwaW5fbG9jaygmcnEtPmxvY2spOworCQlfX2Rt
YV9mZW5jZV9zaWduYWxfX25vdGlmeSgmcnEtPmZlbmNlKTsKKwkJc3Bpbl91bmxvY2soJnJxLT5s
b2NrKTsKKwogCQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKIAl9CiB9CkBAIC0yNjEsMTkgKzI5Mywx
NyBAQCB2b2lkIGludGVsX2VuZ2luZV9maW5pX2JyZWFkY3J1bWJzKHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSkKIAogYm9vbCBpOTE1X3JlcXVlc3RfZW5hYmxlX2JyZWFkY3J1bWIoc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7Ci0Jc3RydWN0IGludGVsX2JyZWFkY3J1bWJzICpiID0g
JnJxLT5lbmdpbmUtPmJyZWFkY3J1bWJzOwotCi0JR0VNX0JVR19PTih0ZXN0X2JpdChJOTE1X0ZF
TkNFX0ZMQUdfU0lHTkFMLCAmcnEtPmZlbmNlLmZsYWdzKSk7CisJbG9ja2RlcF9hc3NlcnRfaGVs
ZCgmcnEtPmxvY2spOworCWxvY2tkZXBfYXNzZXJ0X2lycXNfZGlzYWJsZWQoKTsKIAotCWlmICgh
dGVzdF9iaXQoSTkxNV9GRU5DRV9GTEFHX0FDVElWRSwgJnJxLT5mZW5jZS5mbGFncykpCi0JCXJl
dHVybiB0cnVlOwotCi0Jc3Bpbl9sb2NrKCZiLT5pcnFfbG9jayk7Ci0JaWYgKHRlc3RfYml0KEk5
MTVfRkVOQ0VfRkxBR19BQ1RJVkUsICZycS0+ZmVuY2UuZmxhZ3MpICYmCi0JICAgICFfX3JlcXVl
c3RfY29tcGxldGVkKHJxKSkgeworCWlmICh0ZXN0X2JpdChJOTE1X0ZFTkNFX0ZMQUdfQUNUSVZF
LCAmcnEtPmZlbmNlLmZsYWdzKSkgeworCQlzdHJ1Y3QgaW50ZWxfYnJlYWRjcnVtYnMgKmIgPSAm
cnEtPmVuZ2luZS0+YnJlYWRjcnVtYnM7CiAJCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSA9IHJx
LT5od19jb250ZXh0OwogCQlzdHJ1Y3QgbGlzdF9oZWFkICpwb3M7CiAKKwkJc3Bpbl9sb2NrKCZi
LT5pcnFfbG9jayk7CisJCUdFTV9CVUdfT04odGVzdF9iaXQoSTkxNV9GRU5DRV9GTEFHX1NJR05B
TCwgJnJxLT5mZW5jZS5mbGFncykpOworCiAJCV9faW50ZWxfYnJlYWRjcnVtYnNfYXJtX2lycShi
KTsKIAogCQkvKgpAQCAtMzAzLDggKzMzMyw4IEBAIGJvb2wgaTkxNV9yZXF1ZXN0X2VuYWJsZV9i
cmVhZGNydW1iKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogCQlHRU1fQlVHX09OKCFjaGVja19z
aWduYWxfb3JkZXIoY2UsIHJxKSk7CiAKIAkJc2V0X2JpdChJOTE1X0ZFTkNFX0ZMQUdfU0lHTkFM
LCAmcnEtPmZlbmNlLmZsYWdzKTsKKwkJc3Bpbl91bmxvY2soJmItPmlycV9sb2NrKTsKIAl9Ci0J
c3Bpbl91bmxvY2soJmItPmlycV9sb2NrKTsKIAogCXJldHVybiAhX19yZXF1ZXN0X2NvbXBsZXRl
ZChycSk7CiB9CkBAIC0zMTMsOSArMzQzLDE1IEBAIHZvaWQgaTkxNV9yZXF1ZXN0X2NhbmNlbF9i
cmVhZGNydW1iKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogewogCXN0cnVjdCBpbnRlbF9icmVh
ZGNydW1icyAqYiA9ICZycS0+ZW5naW5lLT5icmVhZGNydW1iczsKIAotCWlmICghdGVzdF9iaXQo
STkxNV9GRU5DRV9GTEFHX1NJR05BTCwgJnJxLT5mZW5jZS5mbGFncykpCi0JCXJldHVybjsKKwls
b2NrZGVwX2Fzc2VydF9oZWxkKCZycS0+bG9jayk7CisJbG9ja2RlcF9hc3NlcnRfaXJxc19kaXNh
YmxlZCgpOwogCisJLyoKKwkgKiBXZSBtdXN0IHdhaXQgZm9yIGItPmlycV9sb2NrIHNvIHRoYXQg
d2Uga25vdyB0aGUgaW50ZXJydXB0IGhhbmRsZXIKKwkgKiBoYXMgcmVsZWFzZWQgaXRzIHJlZmVy
ZW5jZSB0byB0aGUgaW50ZWxfY29udGV4dCBhbmQgaGFzIGNvbXBsZXRlZAorCSAqIHRoZSBETUFf
RkVOQ0VfRkxBR19TSUdOQUxFRF9CSVQvSTkxNV9GRU5DRV9GTEFHX1NJR05BTCBkYW5jZSAoaWYK
KwkgKiByZXF1aXJlZCkuCisJICovCiAJc3Bpbl9sb2NrKCZiLT5pcnFfbG9jayk7CiAJaWYgKHRl
c3RfYml0KEk5MTVfRkVOQ0VfRkxBR19TSUdOQUwsICZycS0+ZmVuY2UuZmxhZ3MpKSB7CiAJCXN0
cnVjdCBpbnRlbF9jb250ZXh0ICpjZSA9IHJxLT5od19jb250ZXh0OwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3JlcXVlc3QuYwppbmRleCBmYTk1NWI3YjZkZWYuLmJlZDIxMzE0OGNiYiAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMKQEAgLTQzNyw2ICs0MzcsNyBAQCB2b2lkIF9faTkxNV9y
ZXF1ZXN0X3N1Ym1pdChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0KQogCXNldF9iaXQoSTkx
NV9GRU5DRV9GTEFHX0FDVElWRSwgJnJlcXVlc3QtPmZlbmNlLmZsYWdzKTsKIAogCWlmICh0ZXN0
X2JpdChETUFfRkVOQ0VfRkxBR19FTkFCTEVfU0lHTkFMX0JJVCwgJnJlcXVlc3QtPmZlbmNlLmZs
YWdzKSAmJgorCSAgICAhdGVzdF9iaXQoRE1BX0ZFTkNFX0ZMQUdfU0lHTkFMRURfQklULCAmcmVx
dWVzdC0+ZmVuY2UuZmxhZ3MpICYmCiAJICAgICFpOTE1X3JlcXVlc3RfZW5hYmxlX2JyZWFkY3J1
bWIocmVxdWVzdCkpCiAJCWludGVsX2VuZ2luZV9xdWV1ZV9icmVhZGNydW1icyhlbmdpbmUpOwog
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfc3VibWlzc2lvbi5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYwppbmRleCAzODBk
ODNhMmJmYjYuLmVhMGUzNzM0ZDM3YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfZ3VjX3N1Ym1pc3Npb24uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9n
dWNfc3VibWlzc2lvbi5jCkBAIC0yMyw3ICsyMyw2IEBACiAgKi8KIAogI2luY2x1ZGUgPGxpbnV4
L2NpcmNfYnVmLmg+Ci0jaW5jbHVkZSA8dHJhY2UvZXZlbnRzL2RtYV9mZW5jZS5oPgogCiAjaW5j
bHVkZSAiZ3QvaW50ZWxfZW5naW5lX3BtLmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfbHJjX3JlZy5o
IgotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5v
cmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2
ZWw=
