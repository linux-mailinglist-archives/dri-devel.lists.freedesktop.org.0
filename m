Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 62CA9107D69
	for <lists+dri-devel@lfdr.de>; Sat, 23 Nov 2019 08:14:09 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D44F76F5AD;
	Sat, 23 Nov 2019 07:14:05 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from bhuna.collabora.co.uk (bhuna.collabora.co.uk [46.235.227.227])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 97BB36F5AD
 for <dri-devel@lists.freedesktop.org>; Sat, 23 Nov 2019 07:14:03 +0000 (UTC)
Received: from [IPv6:2001:240:2403:f475:c2ab:b9b2:8c8f:a567] (unknown
 [IPv6:2001:240:2403:f475:c2ab:b9b2:8c8f:a567])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested) (Authenticated sender: ezequiel)
 by bhuna.collabora.co.uk (Postfix) with ESMTPSA id F3D6A28FF82;
 Sat, 23 Nov 2019 07:13:49 +0000 (GMT)
Message-ID: <1490487539860b5e26063d25180830604b96c002.camel@collabora.com>
Subject: Re: [PATCHv3/RFC 1/4] drm/arm: Factor out generic afbc helpers
From: Ezequiel Garcia <ezequiel@collabora.com>
To: Andrzej Pietrasiewicz <andrzej.p@collabora.com>, 
 dri-devel@lists.freedesktop.org
Date: Sat, 23 Nov 2019 16:13:32 +0900
In-Reply-To: <20191121172247.31150-2-andrzej.p@collabora.com>
References: <20191119083429.GA2881@jamwan02-TSP300>
 <20191121172247.31150-1-andrzej.p@collabora.com>
 <20191121172247.31150-2-andrzej.p@collabora.com>
Organization: Collabora
User-Agent: Evolution 3.34.1-2 
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Ayan Halder <Ayan.Halder@arm.com>, kernel@collabora.com,
 David Airlie <airlied@linux.ie>, Liviu Dudau <liviu.dudau@arm.com>,
 James Wang <james.qian.wang@arm.com>,
 Mihail Atanassov <mihail.atanassov@arm.com>, Sean Paul <sean@poorly.run>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SGkgQW5kcnplaiwKClRoYW5rcyBmb3IgdGhlIHNlcmllcy4gSXQncyBjZXJ0YWlubHkgZ29pbmcg
d2VsbC4KClBsZWFzZSBzZWUgc29tZSBtaW5vciBjb21tZW50cyBiZWxvdy4KCk9uIFRodSwgMjAx
OS0xMS0yMSBhdCAxODoyMiArMDEwMCwgQW5kcnplaiBQaWV0cmFzaWV3aWN6IHdyb3RlOgo+IFRo
ZXNlIGFyZSB1c2VmdWwgZm9yIG90aGVyIHVzZXJzIG9mIGFmYmMsIGUuZy4gcm9ja2NoaXAuCj4g
Cj4gU2lnbmVkLW9mZi1ieTogQW5kcnplaiBQaWV0cmFzaWV3aWN6IDxhbmRyemVqLnBAY29sbGFi
b3JhLmNvbT4KPiAtLS0KPiAgZHJpdmVycy9ncHUvZHJtL01ha2VmaWxlICAgICAgICAgIHwgIDIg
Ky0KPiAgZHJpdmVycy9ncHUvZHJtL2RybV9hZmJjLmMgICAgICAgIHwgODQgKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKwo+ICBkcml2ZXJzL2dwdS9kcm0vZHJtX2ZvdXJjYy5jICAgICAg
fCAxMSArKystCj4gIGRyaXZlcnMvZ3B1L2RybS9kcm1fZnJhbWVidWZmZXIuYyB8IDcxICsrKysr
KysrKysrKysrKysrKysrKysrKystCj4gIGluY2x1ZGUvZHJtL2RybV9hZmJjLmggICAgICAgICAg
ICB8IDM1ICsrKysrKysrKysrKysKPiAgNSBmaWxlcyBjaGFuZ2VkLCAxOTkgaW5zZXJ0aW9ucygr
KSwgNCBkZWxldGlvbnMoLSkKPiAgY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9k
cm1fYWZiYy5jCj4gIGNyZWF0ZSBtb2RlIDEwMDY0NCBpbmNsdWRlL2RybS9kcm1fYWZiYy5oCj4g
Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2Ry
bS9NYWtlZmlsZQo+IGluZGV4IGQ5YmNjOWYyYTBhNC4uM2E1OGYzMGI4M2E2IDEwMDY0NAo+IC0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9NYWtlZmlsZQo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9NYWtl
ZmlsZQo+IEBAIC00NCw3ICs0NCw3IEBAIGRybV9rbXNfaGVscGVyLXkgOj0gZHJtX2NydGNfaGVs
cGVyLm8gZHJtX2RwX2hlbHBlci5vIGRybV9kc2MubyBkcm1fcHJvYmVfaGVscGVyCj4gIAkJZHJt
X3NpbXBsZV9rbXNfaGVscGVyLm8gZHJtX21vZGVzZXRfaGVscGVyLm8gXAo+ICAJCWRybV9zY2Rj
X2hlbHBlci5vIGRybV9nZW1fZnJhbWVidWZmZXJfaGVscGVyLm8gXAo+ICAJCWRybV9hdG9taWNf
c3RhdGVfaGVscGVyLm8gZHJtX2RhbWFnZV9oZWxwZXIubyBcCj4gLQkJZHJtX2Zvcm1hdF9oZWxw
ZXIubyBkcm1fc2VsZl9yZWZyZXNoX2hlbHBlci5vCj4gKwkJZHJtX2Zvcm1hdF9oZWxwZXIubyBk
cm1fc2VsZl9yZWZyZXNoX2hlbHBlci5vIGRybV9hZmJjLm8KPiAgCj4gIGRybV9rbXNfaGVscGVy
LSQoQ09ORklHX0RSTV9QQU5FTF9CUklER0UpICs9IGJyaWRnZS9wYW5lbC5vCj4gIGRybV9rbXNf
aGVscGVyLSQoQ09ORklHX0RSTV9GQkRFVl9FTVVMQVRJT04pICs9IGRybV9mYl9oZWxwZXIubwo+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2FmYmMuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9kcm1fYWZiYy5jCj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRleCAwMDAwMDAwMDAwMDAu
LmYzMDhjNDcxOTU0Ngo+IC0tLSAvZGV2L251bGwKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vZHJt
X2FmYmMuYwo+IEBAIC0wLDAgKzEsODQgQEAKPiArLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6
IEdQTC0yLjAKPiArLyoKPiArICogKEMpIDIwMTkgQ29sbGFib3JhIEx0ZC4KPiArICoKPiArICog
YXV0aG9yOiBBbmRyemVqIFBpZXRyYXNpZXdpY3ogPGFuZHJ6ZWoucEBjb2xsYWJvcmEuY29tPgo+
ICsgKgo+ICsgKi8KPiArI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgo+ICsKPiArI2luY2x1ZGUg
PGRybS9kcm1fYWZiYy5oPgo+ICsjaW5jbHVkZSA8ZHJtL2RybV9kZXZpY2UuaD4KPiArI2luY2x1
ZGUgPGRybS9kcm1fZm91cmNjLmg+Cj4gKyNpbmNsdWRlIDxkcm0vZHJtX2dlbS5oPgo+ICsjaW5j
bHVkZSA8ZHJtL2RybV9tb2RlLmg+Cj4gKyNpbmNsdWRlIDxkcm0vZHJtX3ByaW50Lmg+Cj4gKwo+
ICsvKioKPiArICogZHJtX2FmYmNfZ2V0X3N1cGVyYmxrX3doIC0gZXh0cmFjdCBhZmJjIGJsb2Nr
IHdpZHRoL2hlaWdodCBmcm9tIG1vZGlmaWVyCj4gKyAqIEBtb2RpZmllcjogdGhlIG1vZGlmaWVy
IHRvIGJlIGxvb2tlZCBhdAo+ICsgKiBAdzogYWRkcmVzcyBvZiBhIHBsYWNlIHRvIHN0b3JlIHRo
ZSBibG9jayB3aWR0aAo+ICsgKiBAaDogYWRkcmVzcyBvZiBhIHBsYWNlIHRvIHN0b3JlIHRoZSBi
bG9jayBoZWlnaHQKPiArICoKPiArICogUmV0dXJuczogdHJ1ZSBpZiB0aGUgbW9kaWZpZXIgZGVz
Y3JpYmVzIGEgc3VwcG9ydGVkIGJsb2NrIHNpemUKPiArICovCj4gK2Jvb2wgZHJtX2FmYmNfZ2V0
X3N1cGVyYmxrX3doKHU2NCBtb2RpZmllciwgdTMyICp3LCB1MzIgKmgpCj4gK3sKCk5hbWUgbml0
cGlja2luZzogZHJtX2FmYmNfZ2V0X3N1cGVyYmxvY2tfc2l6ZS4gVGhlIGNvZGluZy1zdHlsZQpn
dWlkZSBoYXMgYSBjaGFwdGVyIG9uIG5hbWluZyBhbmQgc3VnZ2VzdHMgYXZvaWRpbmcgc3R1ZmYg
bGlrZQoic3VwZXJibGsiLgoKPiArCXN3aXRjaCAobW9kaWZpZXIgJiBBRkJDX0ZPUk1BVF9NT0Rf
QkxPQ0tfU0laRV9NQVNLKSB7Cj4gKwljYXNlIEFGQkNfRk9STUFUX01PRF9CTE9DS19TSVpFXzE2
eDE2Ogo+ICsJCSp3ID0gMTY7Cj4gKwkJKmggPSAxNjsKPiArCQlicmVhazsKPiArCWNhc2UgQUZC
Q19GT1JNQVRfTU9EX0JMT0NLX1NJWkVfMzJ4ODoKPiArCQkqdyA9IDMyOwo+ICsJCSpoID0gODsK
PiArCQlicmVhazsKPiArCWNhc2UgQUZCQ19GT1JNQVRfTU9EX0JMT0NLX1NJWkVfNjR4NDoKPiAr
CQkvKiBmYWxsIHRocm91Z2ggKi8KPiArCWNhc2UgQUZCQ19GT1JNQVRfTU9EX0JMT0NLX1NJWkVf
MzJ4OF82NHg0Ogo+ICsJCS8qIGZhbGwgdGhyb3VnaCAqLwo+ICsJZGVmYXVsdDoKPiArCQlEUk1f
REVCVUdfS01TKCJJbnZhbGlkIEFGQkNfRk9STUFUX01PRF9CTE9DS19TSVpFOiAlbGxkLlxuIiwK
PiArCQkJICAgICAgbW9kaWZpZXIgJiBBRkJDX0ZPUk1BVF9NT0RfQkxPQ0tfU0laRV9NQVNLKTsK
PiArCQlyZXR1cm4gZmFsc2U7Cj4gKwl9Cj4gKwlyZXR1cm4gdHJ1ZTsKPiArfQo+ICtFWFBPUlRf
U1lNQk9MX0dQTChkcm1fYWZiY19nZXRfc3VwZXJibGtfd2gpOwo+ICsKPiArLyoqCj4gKyAqIGRy
bV9hZmJjX2dldF9wYXJhbWV0ZXJzIC0gZXh0cmFjdCBhZmJjIHBhcmFtZXRlcnMgZnJvbSBtb2Rl
IGNvbW1hbmQKPiArICogQG1vZGVfY21kOiBtb2RlIGNvbW1hbmQgdG8gYmUgbG9va2VkIGF0Cj4g
KyAqIEBhZmJjOiBhZGRyZXNzIG9mIGEgc3RydWN0IHRvIGJlIGZpbGxlZCBpbgo+ICsgKi8KPiAr
dm9pZCBkcm1fYWZiY19nZXRfcGFyYW1ldGVycyhjb25zdCBzdHJ1Y3QgZHJtX21vZGVfZmJfY21k
MiAqbW9kZV9jbWQsCj4gKwkJCSAgICAgc3RydWN0IGRybV9hZmJjICphZmJjKQo+ICt7Cj4gKwlk
cm1fYWZiY19nZXRfc3VwZXJibGtfd2gobW9kZV9jbWQtPm1vZGlmaWVyWzBdLAo+ICsJCQkJICZh
ZmJjLT50aWxlX3csICZhZmJjLT50aWxlX2gpOwo+ICsJYWZiYy0+d2lkdGggPSBtb2RlX2NtZC0+
cGl0Y2hlc1swXTsKPiArCWFmYmMtPmhlaWdodCA9Cj4gKwkJRElWX1JPVU5EX1VQKG1vZGVfY21k
LT5oZWlnaHQsIGFmYmMtPnRpbGVfaCkgKiBhZmJjLT50aWxlX2g7Cj4gKwlhZmJjLT5vZmZzZXQg
PSBtb2RlX2NtZC0+b2Zmc2V0c1swXTsKPiArfQo+ICtFWFBPUlRfU1lNQk9MKGRybV9hZmJjX2dl
dF9wYXJhbWV0ZXJzKTsKPiArCgpOb3Qgc3VyZSBpZiB0aGlzIHdhcyBkaXNjdXNzZWQgYmVmb3Jl
LCBidXQgd2h5IHNvbWUKYXJlIEVYUE9SVF9TWU1CT0wgYW5kIG90aGVycyBhcmUgZXhwb3J0ZWQg
YXMgX0dQTD8KCj4gKy8qKgo+ICsgKiBkcm1faXNfYWZiYyAtIHRlc3QgaWYgdGhlIG1vZGlmaWVy
IGRlc2NyaWJlcyBhbiBhZmJjIGJ1ZmZlcgo+ICsgKiBAbW9kaWZpZXIgLSBtb2RpZmllciB0byBi
ZSB0ZXN0ZWQKPiArICoKPiArICogUmV0dXJuczogdHJ1ZSBpZiB0aGUgbW9kaWZpZXIgZGVzY3Jp
YmVzIGFuIGFmYmMgYnVmZmVyCj4gKyAqLwo+ICtib29sIGRybV9pc19hZmJjKHU2NCBtb2RpZmll
cikKPiArewo+ICsJLyogaXMgaXQgQVJNIEFGQkM/ICovCj4gKwlpZiAoKG1vZGlmaWVyICYgRFJN
X0ZPUk1BVF9NT0RfQVJNX0FGQkMoMCkpID09IDApCj4gKwkJcmV0dXJuIGZhbHNlOwo+ICsKPiAr
CS8qIEJsb2NrIHNpemUgbXVzdCBiZSBrbm93biAqLwo+ICsJaWYgKChtb2RpZmllciAmIEFGQkNf
Rk9STUFUX01PRF9CTE9DS19TSVpFX01BU0spID09IDApCj4gKwkJcmV0dXJuIGZhbHNlOwo+ICsK
PiArCXJldHVybiB0cnVlOwo+ICt9Cj4gK0VYUE9SVF9TWU1CT0xfR1BMKGRybV9pc19hZmJjKTsK
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2RybV9mb3VyY2MuYyBiL2RyaXZlcnMvZ3B1
L2RybS9kcm1fZm91cmNjLmMKPiBpbmRleCBjNjMwMDY0Y2NmNDEuLjhkOWYxOTdjYzBhYiAxMDA2
NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2ZvdXJjYy5jCj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2RybV9mb3VyY2MuYwo+IEBAIC0yNyw2ICsyNyw3IEBACj4gICNpbmNsdWRlIDxsaW51
eC9leHBvcnQuaD4KPiAgI2luY2x1ZGUgPGxpbnV4L2tlcm5lbC5oPgo+ICAKPiArI2luY2x1ZGUg
PGRybS9kcm1fYWZiYy5oPgo+ICAjaW5jbHVkZSA8ZHJtL2RybV9kZXZpY2UuaD4KPiAgI2luY2x1
ZGUgPGRybS9kcm1fZm91cmNjLmg+Cj4gIAo+IEBAIC0zMjIsOCArMzIzLDE0IEBAIGRybV9nZXRf
Zm9ybWF0X2luZm8oc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAgewo+ICAJY29uc3Qgc3RydWN0
IGRybV9mb3JtYXRfaW5mbyAqaW5mbyA9IE5VTEw7Cj4gIAo+IC0JaWYgKGRldi0+bW9kZV9jb25m
aWcuZnVuY3MtPmdldF9mb3JtYXRfaW5mbykKPiAtCQlpbmZvID0gZGV2LT5tb2RlX2NvbmZpZy5m
dW5jcy0+Z2V0X2Zvcm1hdF9pbmZvKG1vZGVfY21kKTsKPiArCS8qIGJ5cGFzcyBkcml2ZXIgY2Fs
bGJhY2sgaWYgYWZiYyAqLwo+ICsJaWYgKCFkcm1faXNfYWZiYyhtb2RlX2NtZC0+bW9kaWZpZXJb
MF0pKQo+ICsJCWlmIChkZXYtPm1vZGVfY29uZmlnLmZ1bmNzLT5nZXRfZm9ybWF0X2luZm8pIHsK
PiArCQkJY29uc3Qgc3RydWN0IGRybV9tb2RlX2NvbmZpZ19mdW5jcyAqZnVuY3M7Cj4gKwo+ICsJ
CQlmdW5jcyA9IGRldi0+bW9kZV9jb25maWcuZnVuY3M7Cj4gKwkJCWluZm8gPSBmdW5jcy0+Z2V0
X2Zvcm1hdF9pbmZvKG1vZGVfY21kKTsKPiArCQl9Cj4gIAo+ICAJaWYgKCFpbmZvKQo+ICAJCWlu
Zm8gPSBkcm1fZm9ybWF0X2luZm8obW9kZV9jbWQtPnBpeGVsX2Zvcm1hdCk7Cj4gZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9kcm1fZnJhbWVidWZmZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9k
cm1fZnJhbWVidWZmZXIuYwo+IGluZGV4IDU3NTY0MzE4Y2VlYS4uMzAzZWVhNjI0YTAyIDEwMDY0
NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9kcm1fZnJhbWVidWZmZXIuYwo+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9kcm1fZnJhbWVidWZmZXIuYwo+IEBAIC0yMyw2ICsyMyw3IEBACj4gICNpbmNs
dWRlIDxsaW51eC9leHBvcnQuaD4KPiAgI2luY2x1ZGUgPGxpbnV4L3VhY2Nlc3MuaD4KPiAgCj4g
KyNpbmNsdWRlIDxkcm0vZHJtX2FmYmMuaD4KPiAgI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljLmg+
Cj4gICNpbmNsdWRlIDxkcm0vZHJtX2F0b21pY191YXBpLmg+Cj4gICNpbmNsdWRlIDxkcm0vZHJt
X2F1dGguaD4KPiBAQCAtMzEsNiArMzIsNyBAQAo+ICAjaW5jbHVkZSA8ZHJtL2RybV9maWxlLmg+
Cj4gICNpbmNsdWRlIDxkcm0vZHJtX2ZvdXJjYy5oPgo+ICAjaW5jbHVkZSA8ZHJtL2RybV9mcmFt
ZWJ1ZmZlci5oPgo+ICsjaW5jbHVkZSA8ZHJtL2RybV9nZW0uaD4KPiAgI2luY2x1ZGUgPGRybS9k
cm1fcHJpbnQuaD4KPiAgI2luY2x1ZGUgPGRybS9kcm1fdXRpbC5oPgo+ICAKPiBAQCAtMTY4LDcg
KzE3MCw2OSBAQCBzdGF0aWMgaW50IGZiX3BsYW5lX2hlaWdodChpbnQgaGVpZ2h0LAo+ICAJcmV0
dXJuIERJVl9ST1VORF9VUChoZWlnaHQsIGZvcm1hdC0+dnN1Yik7Cj4gIH0KPiAgCj4gK3N0YXRp
YyBpbnQgYWZiY19jaGVjayhzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdiwKPiArCQkgICAgICBj
b25zdCBzdHJ1Y3QgZHJtX21vZGVfZmJfY21kMiAqciwgaW50IGksCj4gKwkJICAgICAgY29uc3Qg
c3RydWN0IGRybV9mb3JtYXRfaW5mbyAqaW5mbykKPiArewo+ICsJc3RydWN0IGRybV9nZW1fb2Jq
ZWN0ICpvYmo7Cj4gKwlpbnQgYnBwID0gaW5mby0+Y3BwWzBdICogODsKPiArCWludCB0aWxlczsK
PiArCXUzMiB3LCBoLCBoZWlnaHQsIHRpbGVfc3osIGFmYmNfc2l6ZTsKPiArCWludCByZXN1bHQg
PSAwOwo+ICsKPiArCWlmIChpKSB7Cj4gKwkJRFJNX0RFQlVHX0tNUygiQUZCQyBzdXBwb3J0ZWQg
b25seSBmb3IgcGxhbmUgMFxuIik7Cj4gKwo+ICsJCXJldHVybiAxOwoKQW55IHJlYXNvbiB0byBy
ZXR1cm4gMSwgaW5zdGVhZCBvZiBhbiBlcnJubywgb3IgYSBib29sZWFuPwoKPiArCX0KPiArCj4g
KwkvKiBnZXQgdGlsZSB3L2ggKi8KPiArCWlmICghZHJtX2FmYmNfZ2V0X3N1cGVyYmxrX3doKHIt
Pm1vZGlmaWVyWzBdLCAmdywgJmgpKQo+ICsJCXJldHVybiAxOwo+ICsKPiArCS8qIHBpdGNoIG11
c3QgYmUgZGl2aXNpYmxlIGJ5IHRpbGUgd2lkdGggKi8KPiArCWlmIChyLT5waXRjaGVzWzBdICUg
dykgewo+ICsJCURSTV9ERUJVR19LTVMoIkludmFsaWQgcGl0Y2ggZm9yIHBsYW5lICVkXG4iLCBp
KTsKPiArCj4gKwkJcmV0dXJuIDE7Cj4gKwl9Cj4gKwo+ICsJb2JqID0gZHJtX2dlbV9vYmplY3Rf
bG9va3VwKGZpbGVfcHJpdiwgci0+aGFuZGxlc1swXSk7Cj4gKwlpZiAoIW9iaikgewo+ICsJCURS
TV9ERUJVR19LTVMoIkZhaWxlZCB0byBsb29rdXAgR0VNIG9iamVjdFxuIik7Cj4gKwo+ICsJCXJl
dHVybiAxOwo+ICsJfQo+ICsKPiArCS8qIGVzdGltYXRlIGhlaWdodCBiYXNlZCBvbiB0aWxlIHNp
emUgYW5kIGhlaWdodCBmcm9tIHVzZXJzcGFjZSAqLwo+ICsJaGVpZ2h0ID0gRElWX1JPVU5EX1VQ
KHItPmhlaWdodCwgaCkgKiBoOwo+ICsKPiArCXRpbGVzID0gKHItPnBpdGNoZXNbMF0gLyB3KSAq
IChoZWlnaHQgLyBoKTsKPiArCWFmYmNfc2l6ZSA9IEFMSUdOKHRpbGVzICogQUZCQ19IRUFERVJf
U0laRSwgQUZCQ19TVVBFUkJMS19BTElHTk1FTlQpOwo+ICsKPiArCXRpbGVfc3ogPSAoYnBwICog
dyAqIGgpIC8gQklUU19QRVJfQllURTsKPiArCWFmYmNfc2l6ZSArPSB0aWxlcyAqIEFMSUdOKHRp
bGVfc3osIEFGQkNfU1VQRVJCTEtfQUxJR05NRU5UKTsKPiArCj4gKwlyZXN1bHQgPSBvYmotPnNp
emUgPCBhZmJjX3NpemU7Cj4gKwo+ICsJZHJtX2dlbV9vYmplY3RfcHV0X3VubG9ja2VkKG9iaik7
Cj4gKwo+ICsJcmV0dXJuIHJlc3VsdDsKPiArfQo+ICsKPiArc3RhdGljIGludCBtb2RpZmllcl9j
aGVjayhzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdiwKPiArCQkJICBjb25zdCBzdHJ1Y3QgZHJt
X21vZGVfZmJfY21kMiAqciwgaW50IGksCj4gKwkJCSAgY29uc3Qgc3RydWN0IGRybV9mb3JtYXRf
aW5mbyAqaW5mbykKPiArewo+ICsJLyogbm9uLWFmYmMgZm9ybWF0ICovCj4gKwlpZiAoIWRybV9p
c19hZmJjKHItPm1vZGlmaWVyW2ldKSkKPiArCQlyZXR1cm4gMDsKPiArCj4gKwlyZXR1cm4gYWZi
Y19jaGVjayhmaWxlX3ByaXYsIHIsIGksIGluZm8pOwo+ICt9Cj4gKwo+ICBzdGF0aWMgaW50IGZy
YW1lYnVmZmVyX2NoZWNrKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gKwkJCSAgICAgc3RydWN0
IGRybV9maWxlICpmaWxlX3ByaXYsCj4gIAkJCSAgICAgY29uc3Qgc3RydWN0IGRybV9tb2RlX2Zi
X2NtZDIgKnIpCj4gIHsKPiAgCWNvbnN0IHN0cnVjdCBkcm1fZm9ybWF0X2luZm8gKmluZm87Cj4g
QEAgLTIwNCw2ICsyNjgsOSBAQCBzdGF0aWMgaW50IGZyYW1lYnVmZmVyX2NoZWNrKHN0cnVjdCBk
cm1fZGV2aWNlICpkZXYsCj4gIAkJdW5zaWduZWQgaW50IGJsb2NrX3NpemUgPSBpbmZvLT5jaGFy
X3Blcl9ibG9ja1tpXTsKPiAgCQl1NjQgbWluX3BpdGNoID0gZHJtX2Zvcm1hdF9pbmZvX21pbl9w
aXRjaChpbmZvLCBpLCB3aWR0aCk7Cj4gIAo+ICsJCWlmIChkcm1faXNfYWZiYyhyLT5tb2RpZmll
cltpXSkpCj4gKwkJCWJsb2NrX3NpemUgPSAwOwo+ICsKPiAgCQlpZiAoIWJsb2NrX3NpemUgJiYg
KHItPm1vZGlmaWVyW2ldID09IERSTV9GT1JNQVRfTU9EX0xJTkVBUikpIHsKPiAgCQkJRFJNX0RF
QlVHX0tNUygiRm9ybWF0IHJlcXVpcmVzIG5vbi1saW5lYXIgbW9kaWZpZXIgZm9yIHBsYW5lICVk
XG4iLCBpKTsKPiAgCQkJcmV0dXJuIC1FSU5WQUw7Cj4gQEAgLTI1Myw2ICszMjAsOCBAQCBzdGF0
aWMgaW50IGZyYW1lYnVmZmVyX2NoZWNrKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gIAkJCWJy
ZWFrOwo+ICAKPiAgCQlkZWZhdWx0Ogo+ICsJCQlpZiAobW9kaWZpZXJfY2hlY2soZmlsZV9wcml2
LCByLCBpLCBpbmZvKSkKPiArCQkJCXJldHVybiAtRUlOVkFMOwo+ICAJCQlicmVhazsKPiAgCQl9
Cj4gIAl9Cj4gQEAgLTMxNyw3ICszODYsNyBAQCBkcm1faW50ZXJuYWxfZnJhbWVidWZmZXJfY3Jl
YXRlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gIAkJcmV0dXJuIEVSUl9QVFIoLUVJTlZBTCk7
Cj4gIAl9Cj4gIAo+IC0JcmV0ID0gZnJhbWVidWZmZXJfY2hlY2soZGV2LCByKTsKPiArCXJldCA9
IGZyYW1lYnVmZmVyX2NoZWNrKGRldiwgZmlsZV9wcml2LCByKTsKPiAgCWlmIChyZXQpCj4gIAkJ
cmV0dXJuIEVSUl9QVFIocmV0KTsKPiAgCj4gZGlmZiAtLWdpdCBhL2luY2x1ZGUvZHJtL2RybV9h
ZmJjLmggYi9pbmNsdWRlL2RybS9kcm1fYWZiYy5oCj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiBp
bmRleCAwMDAwMDAwMDAwMDAuLmZiNGQ0NTQ5Zjc3ZQo+IC0tLSAvZGV2L251bGwKPiArKysgYi9p
bmNsdWRlL2RybS9kcm1fYWZiYy5oCj4gQEAgLTAsMCArMSwzNSBAQAo+ICsvKiBTUERYLUxpY2Vu
c2UtSWRlbnRpZmllcjogR1BMLTIuMCsgKi8KPiArLyoKPiArICogKEMpIDIwMTkgQ29sbGFib3Jh
IEx0ZC4KPiArICoKPiArICogYXV0aG9yOiBBbmRyemVqIFBpZXRyYXNpZXdpY3ogPGFuZHJ6ZWou
cEBjb2xsYWJvcmEuY29tPgo+ICsgKgo+ICsgKi8KPiArI2lmbmRlZiBfX0RSTV9BRkJDX0hfXwo+
ICsjZGVmaW5lIF9fRFJNX0FGQkNfSF9fCj4gKwo+ICsjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4K
PiArCj4gK3N0cnVjdCBkcm1fZGV2aWNlOwo+ICtzdHJ1Y3QgZHJtX21vZGVfZmJfY21kMjsKPiAr
c3RydWN0IGRybV9nZW1fb2JqZWN0Owo+ICsKPiArc3RydWN0IGRybV9hZmJjIHsKPiArCXUzMiB0
aWxlX3c7Cj4gKwl1MzIgdGlsZV9oOwoKSSdkIGdvIHdpdGggdGlsZV93aWR0aCBhbmQgdGlsZV9o
ZWlnaHQuCgo+ICsJdTMyIHdpZHRoOwo+ICsJdTMyIGhlaWdodDsKPiArCXUzMiBvZmZzZXQ7Cj4g
K307Cj4gKwo+ICsjZGVmaW5lIEFGQkNfSEVBREVSX1NJWkUJCTE2Cj4gKyNkZWZpbmUgQUZCQ19T
VVBFUkJMS19BTElHTk1FTlQJCTEyOAo+ICsKCkRpdHRvLCBzL1NVUEVSQkxLL1NVUEVSQkxPQ0su
Cgo+ICtib29sIGRybV9hZmJjX2dldF9zdXBlcmJsa193aCh1NjQgbW9kaWZpZXIsIHUzMiAqdywg
dTMyICpoKTsKPiArCj4gK3ZvaWQgZHJtX2FmYmNfZ2V0X3BhcmFtZXRlcnMoY29uc3Qgc3RydWN0
IGRybV9tb2RlX2ZiX2NtZDIgKm1vZGVfY21kLAo+ICsJCQkgICAgIHN0cnVjdCBkcm1fYWZiYyAq
YWZiYyk7Cj4gKwo+ICtib29sIGRybV9pc19hZmJjKHU2NCBtb2RpZmllcik7Cj4gKwo+ICsjZW5k
aWYgLyogX19EUk1fQUZCQ19IX18gKi8KPiAtLSAKPiAyLjE3LjEKPiAKPiAKClRoYW5rcyEKRXpl
CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2
ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9s
aXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
