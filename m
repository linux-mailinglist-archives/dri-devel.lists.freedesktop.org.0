Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 08ECB36F7D3
	for <lists+dri-devel@lfdr.de>; Fri, 30 Apr 2021 11:25:25 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E43C66F50F;
	Fri, 30 Apr 2021 09:25:15 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x52d.google.com (mail-ed1-x52d.google.com
 [IPv6:2a00:1450:4864:20::52d])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 393F46F504
 for <dri-devel@lists.freedesktop.org>; Fri, 30 Apr 2021 09:25:14 +0000 (UTC)
Received: by mail-ed1-x52d.google.com with SMTP id h10so81801571edt.13
 for <dri-devel@lists.freedesktop.org>; Fri, 30 Apr 2021 02:25:14 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=SU0+4saHUaDaVPK/pmkTcgPhg2NlnFK8gZkzEH9qbsk=;
 b=InlV7/JHT4xUmZEk7LOUqm3ZwZT6WzoSvrA5dNQQonz5WPiTTlAJx9yphDBBn/WyW2
 dJa4teqlyCeH/1sz+FrgMxYR4tKTScXEONeV9OFF53EcrbpjARKomU6+HUnhSmEf/GLm
 u0oafvES6yyaAXki4zeA24gO0Hv16r99qZxodGQHTV6gvbU9N7FaXZrXT6cuodhHO8At
 cAdfkJRG7fIYjRY0U31bZPbf54D2neZCPtmQayrQ3VSJbqlrX9FHpQUKnBiLu+dReL4C
 +orH5viZPtz56fhyHdytsepjWc1mnqOBi6yXGs0OasMdMIWWvlJtXk+tQtaOHSCpBv0F
 X1pw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=SU0+4saHUaDaVPK/pmkTcgPhg2NlnFK8gZkzEH9qbsk=;
 b=S3lHq7fVfaINFK79ubM4OpT8lBTQaZ45TA9iml8v6sVRc71TLb/qKBWZP+qdobJ9bF
 yC1qh0KIfw4je+GSkDag3WZ83tOJUAJRh4GY+6d9nL4MBz86CBCY7LvAUHVdra2ewjjL
 cuZM9kGJHWKtZXdTt5nFZ0x/qZEYXtfxhCn+atFtUTlprFhhl7SHDMjCXpuctnlwBK06
 HtNJtC9ikpYG/t7/RegcWjkKiCoXwHKLkVHfkw7SnzJs5ybWXp8E0Si9JykpYkgR45R3
 catH1kLxUGZTSKdVNw4O60uoKspxfk/G3RFog0HvDVV/+SnMlTKGKum9X+9nT1N95Oo1
 oSGQ==
X-Gm-Message-State: AOAM531G3k82j7ia0NaKcop3N7NWVIgdwABnGslorx4vuBtoMOOltPtC
 lwSMkvYCFQL2lkYZxdTJRSOai0lU+E0=
X-Google-Smtp-Source: ABdhPJyB6pBJkJ7kt69NisyCsncZLUI8gXrp7ANfYhsXjM1jmxAQrPDS+mtK+Ip4t8DU8f6jom8krg==
X-Received: by 2002:a05:6402:1547:: with SMTP id
 p7mr4683641edx.319.1619774712520; 
 Fri, 30 Apr 2021 02:25:12 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:d08c:9633:b7a2:37e2])
 by smtp.gmail.com with ESMTPSA id h23sm1550959ejx.90.2021.04.30.02.25.11
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 30 Apr 2021 02:25:11 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 04/13] drm/ttm: rename bo->mem and make it a pointer
Date: Fri, 30 Apr 2021 11:24:59 +0200
Message-Id: <20210430092508.60710-4-christian.koenig@amd.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20210430092508.60710-1-christian.koenig@amd.com>
References: <20210430092508.60710-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: daniel.vetter@ffwll.ch, matthew.william.auld@gmail.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

V2hlbiB3ZSB3YW50IHRvIGRlY291YmxlIHJlc291cmNlIG1hbmFnZW1lbnQgZnJvbSBidWZmZXIg
bWFuYWdlbWVudCB3ZSBuZWVkIHRvCmJlIGFibGUgdG8gaGFuZGxlIHJlc291cmNlcyBzZXBhcmF0
ZWx5LgoKQWRkIGEgcmVzb3VyY2UgcG9pbnRlciBhbmQgcmVuYW1lIGJvLT5tZW0gc28gdGhhdCBh
bGwgY29kZSBuZWVkcyB0bwpjaGFuZ2UgdG8gYWNjZXNzIHRoZSBwb2ludGVyIGluc3RlYWQuCgpO
byBmdW5jdGlvbmFsIGNoYW5nZS4KClNpZ25lZC1vZmYtYnk6IENocmlzdGlhbiBLw7ZuaWcgPGNo
cmlzdGlhbi5rb2VuaWdAYW1kLmNvbT4KUmV2aWV3ZWQtYnk6IE1hdHRoZXcgQXVsZCA8bWF0dGhl
dy5hdWxkQGludGVsLmNvbT4KLS0tCiAuLi4vZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRr
ZmRfZ3B1dm0uYyAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Rl
dmljZS5jICAgIHwgIDYgKy0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZG1h
X2J1Zi5jICAgfCAxMSArKystLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dt
Yy5jICAgICAgIHwgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9ndHRf
bWdyLmMgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfb2JqZWN0
LmMgICAgfCA0OCArKysrKysrKystLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdV9vYmplY3QuaCAgICB8ICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9h
bWRncHVfdHJhY2UuaCAgICAgfCAgNCArLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X3R0bS5jICAgICAgIHwgNDIgKysrKysrKystLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1X3ZtLmMgICAgICAgIHwgMTIgKystLS0KIGRyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2FtZGdwdV92cmFtX21nci5jICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vZHJt
X2dlbV90dG1faGVscGVyLmMgICAgICAgICAgfCAgNiArLS0KIGRyaXZlcnMvZ3B1L2RybS9kcm1f
Z2VtX3ZyYW1faGVscGVyLmMgICAgICAgICB8ICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vbm91dmVh
dS9ub3V2ZWF1X2FiaTE2LmMgICAgICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL25vdXZlYXUv
bm91dmVhdV9iby5jICAgICAgICAgIHwgMzAgKysrKysrLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0v
bm91dmVhdS9ub3V2ZWF1X2NoYW4uYyAgICAgICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL25v
dXZlYXUvbm91dmVhdV9mYmNvbi5jICAgICAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9ub3V2
ZWF1L25vdXZlYXVfZ2VtLmMgICAgICAgICB8IDE2ICsrKy0tLQogZHJpdmVycy9ncHUvZHJtL25v
dXZlYXUvbm91dmVhdV92bW0uYyAgICAgICAgIHwgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9ub3V2
ZWF1L252MTdfZmVuY2UuYyAgICAgICAgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vbm91dmVh
dS9udjUwX2ZlbmNlLmMgICAgICAgICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL3F4bC9xeGxf
ZHJ2LmggICAgICAgICAgICAgICAgIHwgIDYgKy0tCiBkcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF9v
YmplY3QuYyAgICAgICAgICAgICAgfCAxMCArKy0tCiBkcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF90
dG0uYyAgICAgICAgICAgICAgICAgfCAgNCArLQogZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRl
b25fY3MuYyAgICAgICAgICAgIHwgIDggKy0tCiBkcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVv
bl9nZW0uYyAgICAgICAgICAgfCAxMCArKy0tCiBkcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVv
bl9vYmplY3QuYyAgICAgICAgfCAyMiArKysrLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9yYWRlb24v
cmFkZW9uX29iamVjdC5oICAgICAgICB8ICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3Jh
ZGVvbl9wbS5jICAgICAgICAgICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRl
b25fdHJhY2UuaCAgICAgICAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9u
X3R0bS5jICAgICAgICAgICB8ICA4ICstLQogZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm8uYyAg
ICAgICAgICAgICAgICAgIHwgMzcgKysrKysrKy0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS90dG0v
dHRtX2JvX3V0aWwuYyAgICAgICAgICAgICB8IDQ5ICsrKysrKysrKystLS0tLS0tLS0KIGRyaXZl
cnMvZ3B1L2RybS90dG0vdHRtX2JvX3ZtLmMgICAgICAgICAgICAgICB8IDIyICsrKystLS0tLQog
ZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfYmxpdC5jICAgICAgICAgIHwgIDggKy0tCiBk
cml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9iby5jICAgICAgICAgICAgfCAzNiArKysrKysr
LS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfY21kLmMgICAgICAgICAgIHwg
MTAgKystLQogZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfY21kYnVmLmMgICAgICAgIHwg
IDIgKy0KIGRyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2NvbnRleHQuYyAgICAgICB8IDEy
ICsrLS0tCiBkcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9jb3RhYmxlLmMgICAgICAgfCAx
MCArKy0tCiBkcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9leGVjYnVmLmMgICAgICAgfCAx
MiArKy0tLQogZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfcGFnZV9kaXJ0eS5jICAgIHwg
IDggKy0tCiBkcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9zaGFkZXIuYyAgICAgICAgfCAx
MiArKy0tLQogZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfc3RyZWFtb3V0cHV0LmMgIHwg
IDYgKy0tCiBkcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9zdXJmYWNlLmMgICAgICAgfCAg
NiArLS0KIGRyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3R0bV9idWZmZXIuYyAgICB8IDEw
ICsrLS0KIGluY2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmggICAgICAgICAgICAgICAgICB8ICAz
ICstCiBpbmNsdWRlL2RybS90dG0vdHRtX2JvX2RyaXZlci5oICAgICAgICAgICAgICAgfCAgNiAr
LS0KIDQ4IGZpbGVzIGNoYW5nZWQsIDI3MCBpbnNlcnRpb25zKCspLCAyNjIgZGVsZXRpb25zKC0p
CgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9n
cHV2bS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9ncHV2bS5j
CmluZGV4IGU5Mzg1MGYyZjNiMS4uN2U1NTgxNjdlNTJiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dwdXZtLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9ncHV2bS5jCkBAIC0xNDU2LDcgKzE0NTYsNyBA
QCBpbnQgYW1kZ3B1X2FtZGtmZF9ncHV2bV9tYXBfbWVtb3J5X3RvX2dwdSgKIAkgKiB0aGUgbmV4
dCByZXN0b3JlIHdvcmtlcgogCSAqLwogCWlmIChhbWRncHVfdHRtX3R0X2dldF91c2VybW0oYm8t
PnRiby50dG0pICYmCi0JICAgIGJvLT50Ym8ubWVtLm1lbV90eXBlID09IFRUTV9QTF9TWVNURU0p
CisJICAgIGJvLT50Ym8ucmVzb3VyY2UtPm1lbV90eXBlID09IFRUTV9QTF9TWVNURU0pCiAJCWlz
X2ludmFsaWRfdXNlcnB0ciA9IHRydWU7CiAKIAlpZiAoY2hlY2tfaWZfYWRkX2JvX3RvX3ZtKGF2
bSwgbWVtKSkgewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X2RldmljZS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RldmljZS5jCmlu
ZGV4IGI0YWQxYzA1NWM3MC4uZGNhYmU4NjI4M2YzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfZGV2aWNlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X2RldmljZS5jCkBAIC00MDMwLDkgKzQwMzAsOSBAQCBzdGF0aWMgaW50IGFt
ZGdwdV9kZXZpY2VfcmVjb3Zlcl92cmFtKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQogCWxp
c3RfZm9yX2VhY2hfZW50cnkoc2hhZG93LCAmYWRldi0+c2hhZG93X2xpc3QsIHNoYWRvd19saXN0
KSB7CiAKIAkJLyogTm8gbmVlZCB0byByZWNvdmVyIGFuIGV2aWN0ZWQgQk8gKi8KLQkJaWYgKHNo
YWRvdy0+dGJvLm1lbS5tZW1fdHlwZSAhPSBUVE1fUExfVFQgfHwKLQkJICAgIHNoYWRvdy0+dGJv
Lm1lbS5zdGFydCA9PSBBTURHUFVfQk9fSU5WQUxJRF9PRkZTRVQgfHwKLQkJICAgIHNoYWRvdy0+
cGFyZW50LT50Ym8ubWVtLm1lbV90eXBlICE9IFRUTV9QTF9WUkFNKQorCQlpZiAoc2hhZG93LT50
Ym8ucmVzb3VyY2UtPm1lbV90eXBlICE9IFRUTV9QTF9UVCB8fAorCQkgICAgc2hhZG93LT50Ym8u
cmVzb3VyY2UtPnN0YXJ0ID09IEFNREdQVV9CT19JTlZBTElEX09GRlNFVCB8fAorCQkgICAgc2hh
ZG93LT5wYXJlbnQtPnRiby5yZXNvdXJjZS0+bWVtX3R5cGUgIT0gVFRNX1BMX1ZSQU0pCiAJCQlj
b250aW51ZTsKIAogCQlyID0gYW1kZ3B1X2JvX3Jlc3RvcmVfc2hhZG93KHNoYWRvdywgJm5leHQp
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RtYV9idWYu
YyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kbWFfYnVmLmMKaW5kZXggYmFh
OTgwYTQ3N2Q5Li5mYTU5ZjdjMTdkNTYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV9kbWFfYnVmLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X2RtYV9idWYuYwpAQCAtMjcyLDEyICsyNzIsMTIgQEAgc3RhdGljIHN0cnVjdCBzZ190
YWJsZSAqYW1kZ3B1X2RtYV9idWZfbWFwKHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFj
aCwKIAkJaWYgKHIpCiAJCQlyZXR1cm4gRVJSX1BUUihyKTsKIAotCX0gZWxzZSBpZiAoIShhbWRn
cHVfbWVtX3R5cGVfdG9fZG9tYWluKGJvLT50Ym8ubWVtLm1lbV90eXBlKSAmCisJfSBlbHNlIGlm
ICghKGFtZGdwdV9tZW1fdHlwZV90b19kb21haW4oYm8tPnRiby5yZXNvdXJjZS0+bWVtX3R5cGUp
ICYKIAkJICAgICBBTURHUFVfR0VNX0RPTUFJTl9HVFQpKSB7CiAJCXJldHVybiBFUlJfUFRSKC1F
QlVTWSk7CiAJfQogCi0Jc3dpdGNoIChiby0+dGJvLm1lbS5tZW1fdHlwZSkgeworCXN3aXRjaCAo
Ym8tPnRiby5yZXNvdXJjZS0+bWVtX3R5cGUpIHsKIAljYXNlIFRUTV9QTF9UVDoKIAkJc2d0ID0g
ZHJtX3ByaW1lX3BhZ2VzX3RvX3NnKG9iai0+ZGV2LAogCQkJCQkgICAgYm8tPnRiby50dG0tPnBh
Z2VzLApAQCAtMjkxLDggKzI5MSw5IEBAIHN0YXRpYyBzdHJ1Y3Qgc2dfdGFibGUgKmFtZGdwdV9k
bWFfYnVmX21hcChzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICphdHRhY2gsCiAJCWJyZWFrOwog
CiAJY2FzZSBUVE1fUExfVlJBTToKLQkJciA9IGFtZGdwdV92cmFtX21ncl9hbGxvY19zZ3QoYWRl
diwgJmJvLT50Ym8ubWVtLCAwLAotCQkJCWJvLT50Ym8uYmFzZS5zaXplLCBhdHRhY2gtPmRldiwg
ZGlyLCAmc2d0KTsKKwkJciA9IGFtZGdwdV92cmFtX21ncl9hbGxvY19zZ3QoYWRldiwgYm8tPnRi
by5yZXNvdXJjZSwgMCwKKwkJCQkJICAgICAgYm8tPnRiby5iYXNlLnNpemUsIGF0dGFjaC0+ZGV2
LAorCQkJCQkgICAgICBkaXIsICZzZ3QpOwogCQlpZiAocikKIAkJCXJldHVybiBFUlJfUFRSKHIp
OwogCQlicmVhazsKQEAgLTQ4Miw3ICs0ODMsNyBAQCBhbWRncHVfZG1hX2J1Zl9tb3ZlX25vdGlm
eShzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICphdHRhY2gpCiAJc3RydWN0IGFtZGdwdV92bV9i
b19iYXNlICpib19iYXNlOwogCWludCByOwogCi0JaWYgKGJvLT50Ym8ubWVtLm1lbV90eXBlID09
IFRUTV9QTF9TWVNURU0pCisJaWYgKGJvLT50Ym8ucmVzb3VyY2UtPm1lbV90eXBlID09IFRUTV9Q
TF9TWVNURU0pCiAJCXJldHVybjsKIAogCXIgPSB0dG1fYm9fdmFsaWRhdGUoJmJvLT50Ym8sICZw
bGFjZW1lbnQsICZjdHgpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X2dtYy5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dtYy5jCmlu
ZGV4IDRkMzIyMzNjZGU5Mi4uZDMyNzE4YmJiNDY0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfZ21jLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2dtYy5jCkBAIC05OSw3ICs5OSw3IEBAIHZvaWQgYW1kZ3B1X2dtY19nZXRfcGRl
X2Zvcl9ibyhzdHJ1Y3QgYW1kZ3B1X2JvICpibywgaW50IGxldmVsLAogewogCXN0cnVjdCBhbWRn
cHVfZGV2aWNlICphZGV2ID0gYW1kZ3B1X3R0bV9hZGV2KGJvLT50Ym8uYmRldik7CiAKLQlzd2l0
Y2ggKGJvLT50Ym8ubWVtLm1lbV90eXBlKSB7CisJc3dpdGNoIChiby0+dGJvLnJlc291cmNlLT5t
ZW1fdHlwZSkgewogCWNhc2UgVFRNX1BMX1RUOgogCQkqYWRkciA9IGJvLT50Ym8udHRtLT5kbWFf
YWRkcmVzc1swXTsKIAkJYnJlYWs7CkBAIC0xMTAsNyArMTEwLDcgQEAgdm9pZCBhbWRncHVfZ21j
X2dldF9wZGVfZm9yX2JvKHN0cnVjdCBhbWRncHVfYm8gKmJvLCBpbnQgbGV2ZWwsCiAJCSphZGRy
ID0gMDsKIAkJYnJlYWs7CiAJfQotCSpmbGFncyA9IGFtZGdwdV90dG1fdHRfcGRlX2ZsYWdzKGJv
LT50Ym8udHRtLCAmYm8tPnRiby5tZW0pOworCSpmbGFncyA9IGFtZGdwdV90dG1fdHRfcGRlX2Zs
YWdzKGJvLT50Ym8udHRtLCBiby0+dGJvLnJlc291cmNlKTsKIAlhbWRncHVfZ21jX2dldF92bV9w
ZGUoYWRldiwgbGV2ZWwsIGFkZHIsIGZsYWdzKTsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2d0dF9tZ3IuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV9ndHRfbWdyLmMKaW5kZXggYzAyNjk3MmNhOWExLi4xMDg2Njg3YTgxMzgg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9ndHRfbWdyLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2d0dF9tZ3IuYwpAQCAtMTEy
LDcgKzExMiw3IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2d0dF9tZ3JfbmV3KHN0cnVjdCB0dG1fcmVz
b3VyY2VfbWFuYWdlciAqbWFuLAogCWludCByOwogCiAJc3Bpbl9sb2NrKCZtZ3ItPmxvY2spOwot
CWlmICgoJnRiby0+bWVtID09IG1lbSB8fCB0Ym8tPm1lbS5tZW1fdHlwZSAhPSBUVE1fUExfVFQp
ICYmCisJaWYgKCh0Ym8tPnJlc291cmNlID09IG1lbSB8fCB0Ym8tPnJlc291cmNlLT5tZW1fdHlw
ZSAhPSBUVE1fUExfVFQpICYmCiAJICAgIGF0b21pYzY0X3JlYWQoJm1nci0+YXZhaWxhYmxlKSA8
IG1lbS0+bnVtX3BhZ2VzKSB7CiAJCXNwaW5fdW5sb2NrKCZtZ3ItPmxvY2spOwogCQlyZXR1cm4g
LUVOT1NQQzsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9v
YmplY3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9vYmplY3QuYwppbmRl
eCBmZTRlNTg4MDUwOWQuLjZiYjlkOWQwNTMyNiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X29iamVjdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV9vYmplY3QuYwpAQCAtMzYyLDE0ICszNjIsMTQgQEAgaW50IGFtZGdwdV9ib19j
cmVhdGVfa2VybmVsX2F0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAogCWlmIChjcHVfYWRk
cikKIAkJYW1kZ3B1X2JvX2t1bm1hcCgqYm9fcHRyKTsKIAotCXR0bV9yZXNvdXJjZV9mcmVlKCYo
KmJvX3B0ciktPnRibywgJigqYm9fcHRyKS0+dGJvLm1lbSk7CisJdHRtX3Jlc291cmNlX2ZyZWUo
JigqYm9fcHRyKS0+dGJvLCAoKmJvX3B0ciktPnRiby5yZXNvdXJjZSk7CiAKIAlmb3IgKGkgPSAw
OyBpIDwgKCpib19wdHIpLT5wbGFjZW1lbnQubnVtX3BsYWNlbWVudDsgKytpKSB7CiAJCSgqYm9f
cHRyKS0+cGxhY2VtZW50c1tpXS5mcGZuID0gb2Zmc2V0ID4+IFBBR0VfU0hJRlQ7CiAJCSgqYm9f
cHRyKS0+cGxhY2VtZW50c1tpXS5scGZuID0gKG9mZnNldCArIHNpemUpID4+IFBBR0VfU0hJRlQ7
CiAJfQogCXIgPSB0dG1fYm9fbWVtX3NwYWNlKCYoKmJvX3B0ciktPnRibywgJigqYm9fcHRyKS0+
cGxhY2VtZW50LAotCQkJICAgICAmKCpib19wdHIpLT50Ym8ubWVtLCAmY3R4KTsKKwkJCSAgICAg
KCpib19wdHIpLT50Ym8ucmVzb3VyY2UsICZjdHgpOwogCWlmIChyKQogCQlnb3RvIGVycm9yOwog
CkBAIC01NjIsMTUgKzU2MiwxNSBAQCBzdGF0aWMgaW50IGFtZGdwdV9ib19kb19jcmVhdGUoc3Ry
dWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCiAJCXJldHVybiByOwogCiAJaWYgKCFhbWRncHVfZ21j
X3ZyYW1fZnVsbF92aXNpYmxlKCZhZGV2LT5nbWMpICYmCi0JICAgIGJvLT50Ym8ubWVtLm1lbV90
eXBlID09IFRUTV9QTF9WUkFNICYmCi0JICAgIGJvLT50Ym8ubWVtLnN0YXJ0IDwgYWRldi0+Z21j
LnZpc2libGVfdnJhbV9zaXplID4+IFBBR0VfU0hJRlQpCisJICAgIGJvLT50Ym8ucmVzb3VyY2Ut
Pm1lbV90eXBlID09IFRUTV9QTF9WUkFNICYmCisJICAgIGJvLT50Ym8ucmVzb3VyY2UtPnN0YXJ0
IDwgYWRldi0+Z21jLnZpc2libGVfdnJhbV9zaXplID4+IFBBR0VfU0hJRlQpCiAJCWFtZGdwdV9j
c19yZXBvcnRfbW92ZWRfYnl0ZXMoYWRldiwgY3R4LmJ5dGVzX21vdmVkLAogCQkJCQkgICAgIGN0
eC5ieXRlc19tb3ZlZCk7CiAJZWxzZQogCQlhbWRncHVfY3NfcmVwb3J0X21vdmVkX2J5dGVzKGFk
ZXYsIGN0eC5ieXRlc19tb3ZlZCwgMCk7CiAKIAlpZiAoYnAtPmZsYWdzICYgQU1ER1BVX0dFTV9D
UkVBVEVfVlJBTV9DTEVBUkVEICYmCi0JICAgIGJvLT50Ym8ubWVtLm1lbV90eXBlID09IFRUTV9Q
TF9WUkFNKSB7CisJICAgIGJvLT50Ym8ucmVzb3VyY2UtPm1lbV90eXBlID09IFRUTV9QTF9WUkFN
KSB7CiAJCXN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlOwogCiAJCXIgPSBhbWRncHVfZmlsbF9idWZm
ZXIoYm8sIDAsIGJvLT50Ym8uYmFzZS5yZXN2LCAmZmVuY2UpOwpAQCAtNzk2LDcgKzc5Niw3IEBA
IGludCBhbWRncHVfYm9fa21hcChzdHJ1Y3QgYW1kZ3B1X2JvICpibywgdm9pZCAqKnB0cikKIAlp
ZiAociA8IDApCiAJCXJldHVybiByOwogCi0JciA9IHR0bV9ib19rbWFwKCZiby0+dGJvLCAwLCBi
by0+dGJvLm1lbS5udW1fcGFnZXMsICZiby0+a21hcCk7CisJciA9IHR0bV9ib19rbWFwKCZiby0+
dGJvLCAwLCBiby0+dGJvLnJlc291cmNlLT5udW1fcGFnZXMsICZiby0+a21hcCk7CiAJaWYgKHIp
CiAJCXJldHVybiByOwogCkBAIC05MTksOCArOTE5LDggQEAgaW50IGFtZGdwdV9ib19waW5fcmVz
dHJpY3RlZChzdHJ1Y3QgYW1kZ3B1X2JvICpibywgdTMyIGRvbWFpbiwKIAlkb21haW4gPSBhbWRn
cHVfYm9fZ2V0X3ByZWZlcnJlZF9waW5fZG9tYWluKGFkZXYsIGRvbWFpbik7CiAKIAlpZiAoYm8t
PnRiby5waW5fY291bnQpIHsKLQkJdWludDMyX3QgbWVtX3R5cGUgPSBiby0+dGJvLm1lbS5tZW1f
dHlwZTsKLQkJdWludDMyX3QgbWVtX2ZsYWdzID0gYm8tPnRiby5tZW0ucGxhY2VtZW50OworCQl1
aW50MzJfdCBtZW1fdHlwZSA9IGJvLT50Ym8ucmVzb3VyY2UtPm1lbV90eXBlOworCQl1aW50MzJf
dCBtZW1fZmxhZ3MgPSBiby0+dGJvLnJlc291cmNlLT5wbGFjZW1lbnQ7CiAKIAkJaWYgKCEoZG9t
YWluICYgYW1kZ3B1X21lbV90eXBlX3RvX2RvbWFpbihtZW1fdHlwZSkpKQogCQkJcmV0dXJuIC1F
SU5WQUw7CkBAIC05NzAsNyArOTcwLDcgQEAgaW50IGFtZGdwdV9ib19waW5fcmVzdHJpY3RlZChz
dHJ1Y3QgYW1kZ3B1X2JvICpibywgdTMyIGRvbWFpbiwKIAogCXR0bV9ib19waW4oJmJvLT50Ym8p
OwogCi0JZG9tYWluID0gYW1kZ3B1X21lbV90eXBlX3RvX2RvbWFpbihiby0+dGJvLm1lbS5tZW1f
dHlwZSk7CisJZG9tYWluID0gYW1kZ3B1X21lbV90eXBlX3RvX2RvbWFpbihiby0+dGJvLnJlc291
cmNlLT5tZW1fdHlwZSk7CiAJaWYgKGRvbWFpbiA9PSBBTURHUFVfR0VNX0RPTUFJTl9WUkFNKSB7
CiAJCWF0b21pYzY0X2FkZChhbWRncHVfYm9fc2l6ZShibyksICZhZGV2LT52cmFtX3Bpbl9zaXpl
KTsKIAkJYXRvbWljNjRfYWRkKGFtZGdwdV92cmFtX21ncl9ib192aXNpYmxlX3NpemUoYm8pLApA
QCAtMTAyMiwxMSArMTAyMiwxMSBAQCB2b2lkIGFtZGdwdV9ib191bnBpbihzdHJ1Y3QgYW1kZ3B1
X2JvICpibykKIAlpZiAoYm8tPnRiby5iYXNlLmltcG9ydF9hdHRhY2gpCiAJCWRtYV9idWZfdW5w
aW4oYm8tPnRiby5iYXNlLmltcG9ydF9hdHRhY2gpOwogCi0JaWYgKGJvLT50Ym8ubWVtLm1lbV90
eXBlID09IFRUTV9QTF9WUkFNKSB7CisJaWYgKGJvLT50Ym8ucmVzb3VyY2UtPm1lbV90eXBlID09
IFRUTV9QTF9WUkFNKSB7CiAJCWF0b21pYzY0X3N1YihhbWRncHVfYm9fc2l6ZShibyksICZhZGV2
LT52cmFtX3Bpbl9zaXplKTsKIAkJYXRvbWljNjRfc3ViKGFtZGdwdV92cmFtX21ncl9ib192aXNp
YmxlX3NpemUoYm8pLAogCQkJICAgICAmYWRldi0+dmlzaWJsZV9waW5fc2l6ZSk7Ci0JfSBlbHNl
IGlmIChiby0+dGJvLm1lbS5tZW1fdHlwZSA9PSBUVE1fUExfVFQpIHsKKwl9IGVsc2UgaWYgKGJv
LT50Ym8ucmVzb3VyY2UtPm1lbV90eXBlID09IFRUTV9QTF9UVCkgewogCQlhdG9taWM2NF9zdWIo
YW1kZ3B1X2JvX3NpemUoYm8pLCAmYWRldi0+Z2FydF9waW5fc2l6ZSk7CiAJfQogfQpAQCAtMTI2
Miw3ICsxMjYyLDcgQEAgdm9pZCBhbWRncHVfYm9fbW92ZV9ub3RpZnkoc3RydWN0IHR0bV9idWZm
ZXJfb2JqZWN0ICpibywKIHsKIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGFtZGdwdV90
dG1fYWRldihiby0+YmRldik7CiAJc3RydWN0IGFtZGdwdV9ibyAqYWJvOwotCXN0cnVjdCB0dG1f
cmVzb3VyY2UgKm9sZF9tZW0gPSAmYm8tPm1lbTsKKwlzdHJ1Y3QgdHRtX3Jlc291cmNlICpvbGRf
bWVtID0gYm8tPnJlc291cmNlOwogCiAJaWYgKCFhbWRncHVfYm9faXNfYW1kZ3B1X2JvKGJvKSkK
IAkJcmV0dXJuOwpAQCAtMTI3Myw3ICsxMjczLDcgQEAgdm9pZCBhbWRncHVfYm9fbW92ZV9ub3Rp
Znkoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAlhbWRncHVfYm9fa3VubWFwKGFibyk7
CiAKIAlpZiAoYWJvLT50Ym8uYmFzZS5kbWFfYnVmICYmICFhYm8tPnRiby5iYXNlLmltcG9ydF9h
dHRhY2ggJiYKLQkgICAgYm8tPm1lbS5tZW1fdHlwZSAhPSBUVE1fUExfU1lTVEVNKQorCSAgICBi
by0+cmVzb3VyY2UtPm1lbV90eXBlICE9IFRUTV9QTF9TWVNURU0pCiAJCWRtYV9idWZfbW92ZV9u
b3RpZnkoYWJvLT50Ym8uYmFzZS5kbWFfYnVmKTsKIAogCS8qIHJlbWVtYmVyIHRoZSBldmljdGlv
biAqLwpAQCAtMTMxNSw3ICsxMzE1LDcgQEAgdm9pZCBhbWRncHVfYm9fcmVsZWFzZV9ub3RpZnko
c3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibykKIAlpZiAoYm8tPmJhc2UucmVzdiA9PSAmYm8t
PmJhc2UuX3Jlc3YpCiAJCWFtZGdwdV9hbWRrZmRfcmVtb3ZlX2ZlbmNlX29uX3B0X3BkX2Jvcyhh
Ym8pOwogCi0JaWYgKGJvLT5tZW0ubWVtX3R5cGUgIT0gVFRNX1BMX1ZSQU0gfHwgIWJvLT5tZW0u
bW1fbm9kZSB8fAorCWlmIChiby0+cmVzb3VyY2UtPm1lbV90eXBlICE9IFRUTV9QTF9WUkFNIHx8
ICFiby0+cmVzb3VyY2UtPm1tX25vZGUgfHwKIAkgICAgIShhYm8tPmZsYWdzICYgQU1ER1BVX0dF
TV9DUkVBVEVfVlJBTV9XSVBFX09OX1JFTEVBU0UpKQogCQlyZXR1cm47CiAKQEAgLTEzNTIsMTAg
KzEzNTIsMTAgQEAgdm1fZmF1bHRfdCBhbWRncHVfYm9fZmF1bHRfcmVzZXJ2ZV9ub3RpZnkoc3Ry
dWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibykKIAkvKiBSZW1lbWJlciB0aGF0IHRoaXMgQk8gd2Fz
IGFjY2Vzc2VkIGJ5IHRoZSBDUFUgKi8KIAlhYm8tPmZsYWdzIHw9IEFNREdQVV9HRU1fQ1JFQVRF
X0NQVV9BQ0NFU1NfUkVRVUlSRUQ7CiAKLQlpZiAoYm8tPm1lbS5tZW1fdHlwZSAhPSBUVE1fUExf
VlJBTSkKKwlpZiAoYm8tPnJlc291cmNlLT5tZW1fdHlwZSAhPSBUVE1fUExfVlJBTSkKIAkJcmV0
dXJuIDA7CiAKLQlvZmZzZXQgPSBiby0+bWVtLnN0YXJ0IDw8IFBBR0VfU0hJRlQ7CisJb2Zmc2V0
ID0gYm8tPnJlc291cmNlLT5zdGFydCA8PCBQQUdFX1NISUZUOwogCWlmICgob2Zmc2V0ICsgYm8t
PmJhc2Uuc2l6ZSkgPD0gYWRldi0+Z21jLnZpc2libGVfdnJhbV9zaXplKQogCQlyZXR1cm4gMDsK
IApAQCAtMTM3OCw5ICsxMzc4LDkgQEAgdm1fZmF1bHRfdCBhbWRncHVfYm9fZmF1bHRfcmVzZXJ2
ZV9ub3RpZnkoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibykKIAllbHNlIGlmICh1bmxpa2Vs
eShyKSkKIAkJcmV0dXJuIFZNX0ZBVUxUX1NJR0JVUzsKIAotCW9mZnNldCA9IGJvLT5tZW0uc3Rh
cnQgPDwgUEFHRV9TSElGVDsKKwlvZmZzZXQgPSBiby0+cmVzb3VyY2UtPnN0YXJ0IDw8IFBBR0Vf
U0hJRlQ7CiAJLyogdGhpcyBzaG91bGQgbmV2ZXIgaGFwcGVuICovCi0JaWYgKGJvLT5tZW0ubWVt
X3R5cGUgPT0gVFRNX1BMX1ZSQU0gJiYKKwlpZiAoYm8tPnJlc291cmNlLT5tZW1fdHlwZSA9PSBU
VE1fUExfVlJBTSAmJgogCSAgICAob2Zmc2V0ICsgYm8tPmJhc2Uuc2l6ZSkgPiBhZGV2LT5nbWMu
dmlzaWJsZV92cmFtX3NpemUpCiAJCXJldHVybiBWTV9GQVVMVF9TSUdCVVM7CiAKQEAgLTE0NjUs
MTEgKzE0NjUsMTEgQEAgaW50IGFtZGdwdV9ib19zeW5jX3dhaXQoc3RydWN0IGFtZGdwdV9ibyAq
Ym8sIHZvaWQgKm93bmVyLCBib29sIGludHIpCiAgKi8KIHU2NCBhbWRncHVfYm9fZ3B1X29mZnNl
dChzdHJ1Y3QgYW1kZ3B1X2JvICpibykKIHsKLQlXQVJOX09OX09OQ0UoYm8tPnRiby5tZW0ubWVt
X3R5cGUgPT0gVFRNX1BMX1NZU1RFTSk7CisJV0FSTl9PTl9PTkNFKGJvLT50Ym8ucmVzb3VyY2Ut
Pm1lbV90eXBlID09IFRUTV9QTF9TWVNURU0pOwogCVdBUk5fT05fT05DRSghZG1hX3Jlc3ZfaXNf
bG9ja2VkKGJvLT50Ym8uYmFzZS5yZXN2KSAmJgogCQkgICAgICFiby0+dGJvLnBpbl9jb3VudCAm
JiBiby0+dGJvLnR5cGUgIT0gdHRtX2JvX3R5cGVfa2VybmVsKTsKLQlXQVJOX09OX09OQ0UoYm8t
PnRiby5tZW0uc3RhcnQgPT0gQU1ER1BVX0JPX0lOVkFMSURfT0ZGU0VUKTsKLQlXQVJOX09OX09O
Q0UoYm8tPnRiby5tZW0ubWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0gJiYKKwlXQVJOX09OX09OQ0Uo
Ym8tPnRiby5yZXNvdXJjZS0+c3RhcnQgPT0gQU1ER1BVX0JPX0lOVkFMSURfT0ZGU0VUKTsKKwlX
QVJOX09OX09OQ0UoYm8tPnRiby5yZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0gJiYK
IAkJICAgICAhKGJvLT5mbGFncyAmIEFNREdQVV9HRU1fQ1JFQVRFX1ZSQU1fQ09OVElHVU9VUykp
OwogCiAJcmV0dXJuIGFtZGdwdV9ib19ncHVfb2Zmc2V0X25vX2NoZWNrKGJvKTsKQEAgLTE0ODcs
OCArMTQ4Nyw4IEBAIHU2NCBhbWRncHVfYm9fZ3B1X29mZnNldF9ub19jaGVjayhzdHJ1Y3QgYW1k
Z3B1X2JvICpibykKIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGFtZGdwdV90dG1fYWRl
dihiby0+dGJvLmJkZXYpOwogCXVpbnQ2NF90IG9mZnNldDsKIAotCW9mZnNldCA9IChiby0+dGJv
Lm1lbS5zdGFydCA8PCBQQUdFX1NISUZUKSArCi0JCSBhbWRncHVfdHRtX2RvbWFpbl9zdGFydChh
ZGV2LCBiby0+dGJvLm1lbS5tZW1fdHlwZSk7CisJb2Zmc2V0ID0gKGJvLT50Ym8ucmVzb3VyY2Ut
PnN0YXJ0IDw8IFBBR0VfU0hJRlQpICsKKwkJIGFtZGdwdV90dG1fZG9tYWluX3N0YXJ0KGFkZXYs
IGJvLT50Ym8ucmVzb3VyY2UtPm1lbV90eXBlKTsKIAogCXJldHVybiBhbWRncHVfZ21jX3NpZ25f
ZXh0ZW5kKG9mZnNldCk7CiB9CkBAIC0xNTQxLDcgKzE1NDEsNyBAQCB1NjQgYW1kZ3B1X2JvX3By
aW50X2luZm8oaW50IGlkLCBzdHJ1Y3QgYW1kZ3B1X2JvICpibywgc3RydWN0IHNlcV9maWxlICpt
KQogCXVuc2lnbmVkIGludCBwaW5fY291bnQ7CiAJdTY0IHNpemU7CiAKLQlkb21haW4gPSBhbWRn
cHVfbWVtX3R5cGVfdG9fZG9tYWluKGJvLT50Ym8ubWVtLm1lbV90eXBlKTsKKwlkb21haW4gPSBh
bWRncHVfbWVtX3R5cGVfdG9fZG9tYWluKGJvLT50Ym8ucmVzb3VyY2UtPm1lbV90eXBlKTsKIAlz
d2l0Y2ggKGRvbWFpbikgewogCWNhc2UgQU1ER1BVX0dFTV9ET01BSU5fVlJBTToKIAkJcGxhY2Vt
ZW50ID0gIlZSQU0iOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X29iamVjdC5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X29iamVjdC5o
CmluZGV4IGRlZWJiNGU4NzE4My4uMzIyNTZjNWJiNDg3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfb2JqZWN0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1X29iamVjdC5oCkBAIC0yMTUsMTAgKzIxNSwxMCBAQCBzdGF0aWMgaW5s
aW5lIGJvb2wgYW1kZ3B1X2JvX2luX2NwdV92aXNpYmxlX3ZyYW0oc3RydWN0IGFtZGdwdV9ibyAq
Ym8pCiAJc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSBhbWRncHVfdHRtX2FkZXYoYm8tPnRi
by5iZGV2KTsKIAlzdHJ1Y3QgYW1kZ3B1X3Jlc19jdXJzb3IgY3Vyc29yOwogCi0JaWYgKGJvLT50
Ym8ubWVtLm1lbV90eXBlICE9IFRUTV9QTF9WUkFNKQorCWlmIChiby0+dGJvLnJlc291cmNlLT5t
ZW1fdHlwZSAhPSBUVE1fUExfVlJBTSkKIAkJcmV0dXJuIGZhbHNlOwogCi0JYW1kZ3B1X3Jlc19m
aXJzdCgmYm8tPnRiby5tZW0sIDAsIGFtZGdwdV9ib19zaXplKGJvKSwgJmN1cnNvcik7CisJYW1k
Z3B1X3Jlc19maXJzdChiby0+dGJvLnJlc291cmNlLCAwLCBhbWRncHVfYm9fc2l6ZShibyksICZj
dXJzb3IpOwogCXdoaWxlIChjdXJzb3IucmVtYWluaW5nKSB7CiAJCWlmIChjdXJzb3Iuc3RhcnQg
PCBhZGV2LT5nbWMudmlzaWJsZV92cmFtX3NpemUpCiAJCQlyZXR1cm4gdHJ1ZTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90cmFjZS5oIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3RyYWNlLmgKaW5kZXggNzkyZDIwMjYxODQ2Li4wNTI3
NzcyZmUxYjggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90
cmFjZS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90cmFjZS5oCkBA
IC0xMjcsOCArMTI3LDggQEAgVFJBQ0VfRVZFTlQoYW1kZ3B1X2JvX2NyZWF0ZSwKIAogCSAgICBU
UF9mYXN0X2Fzc2lnbigKIAkJCSAgIF9fZW50cnktPmJvID0gYm87Ci0JCQkgICBfX2VudHJ5LT5w
YWdlcyA9IGJvLT50Ym8ubWVtLm51bV9wYWdlczsKLQkJCSAgIF9fZW50cnktPnR5cGUgPSBiby0+
dGJvLm1lbS5tZW1fdHlwZTsKKwkJCSAgIF9fZW50cnktPnBhZ2VzID0gYm8tPnRiby5yZXNvdXJj
ZS0+bnVtX3BhZ2VzOworCQkJICAgX19lbnRyeS0+dHlwZSA9IGJvLT50Ym8ucmVzb3VyY2UtPm1l
bV90eXBlOwogCQkJICAgX19lbnRyeS0+cHJlZmVyID0gYm8tPnByZWZlcnJlZF9kb21haW5zOwog
CQkJICAgX19lbnRyeS0+YWxsb3cgPSBiby0+YWxsb3dlZF9kb21haW5zOwogCQkJICAgX19lbnRy
eS0+dmlzaWJsZSA9IGJvLT5mbGFnczsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV90dG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90
dG0uYwppbmRleCAyZjc1ODBkMmVlNzEuLjU4MTUyM2QyMTJkMiAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2FtZGdwdV90dG0uYwpAQCAtMTEyLDcgKzExMiw3IEBAIHN0YXRpYyB2b2lkIGFt
ZGdwdV9ldmljdF9mbGFncyhzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCX0KIAogCWFi
byA9IHR0bV90b19hbWRncHVfYm8oYm8pOwotCXN3aXRjaCAoYm8tPm1lbS5tZW1fdHlwZSkgewor
CXN3aXRjaCAoYm8tPnJlc291cmNlLT5tZW1fdHlwZSkgewogCWNhc2UgQU1ER1BVX1BMX0dEUzoK
IAljYXNlIEFNREdQVV9QTF9HV1M6CiAJY2FzZSBBTURHUFVfUExfT0E6CkBAIC00NzEsNyArNDcx
LDcgQEAgc3RhdGljIGludCBhbWRncHVfYm9fbW92ZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3Qg
KmJvLCBib29sIGV2aWN0LAogewogCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2OwogCXN0cnVj
dCBhbWRncHVfYm8gKmFibzsKLQlzdHJ1Y3QgdHRtX3Jlc291cmNlICpvbGRfbWVtID0gJmJvLT5t
ZW07CisJc3RydWN0IHR0bV9yZXNvdXJjZSAqb2xkX21lbSA9IGJvLT5yZXNvdXJjZTsKIAlpbnQg
cjsKIAogCWlmIChuZXdfbWVtLT5tZW1fdHlwZSA9PSBUVE1fUExfVFQpIHsKQEAgLTUwMyw3ICs1
MDMsNyBAQCBzdGF0aWMgaW50IGFtZGdwdV9ib19tb3ZlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVj
dCAqYm8sIGJvb2wgZXZpY3QsCiAJCQlyZXR1cm4gcjsKIAogCQlhbWRncHVfdHRtX2JhY2tlbmRf
dW5iaW5kKGJvLT5iZGV2LCBiby0+dHRtKTsKLQkJdHRtX3Jlc291cmNlX2ZyZWUoYm8sICZiby0+
bWVtKTsKKwkJdHRtX3Jlc291cmNlX2ZyZWUoYm8sIGJvLT5yZXNvdXJjZSk7CiAJCXR0bV9ib19h
c3NpZ25fbWVtKGJvLCBuZXdfbWVtKTsKIAkJZ290byBvdXQ7CiAJfQpAQCAtNjEyLDcgKzYxMiw4
IEBAIHN0YXRpYyB1bnNpZ25lZCBsb25nIGFtZGdwdV90dG1faW9fbWVtX3BmbihzdHJ1Y3QgdHRt
X2J1ZmZlcl9vYmplY3QgKmJvLAogCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gYW1kZ3B1
X3R0bV9hZGV2KGJvLT5iZGV2KTsKIAlzdHJ1Y3QgYW1kZ3B1X3Jlc19jdXJzb3IgY3Vyc29yOwog
Ci0JYW1kZ3B1X3Jlc19maXJzdCgmYm8tPm1lbSwgKHU2NClwYWdlX29mZnNldCA8PCBQQUdFX1NI
SUZULCAwLCAmY3Vyc29yKTsKKwlhbWRncHVfcmVzX2ZpcnN0KGJvLT5yZXNvdXJjZSwgKHU2NClw
YWdlX29mZnNldCA8PCBQQUdFX1NISUZULCAwLAorCQkJICZjdXJzb3IpOwogCXJldHVybiAoYWRl
di0+Z21jLmFwZXJfYmFzZSArIGN1cnNvci5zdGFydCkgPj4gUEFHRV9TSElGVDsKIH0KIApAQCAt
MTAwNiwxMiArMTAwNywxMiBAQCBpbnQgYW1kZ3B1X3R0bV9hbGxvY19nYXJ0KHN0cnVjdCB0dG1f
YnVmZmVyX29iamVjdCAqYm8pCiAJdWludDY0X3QgYWRkciwgZmxhZ3M7CiAJaW50IHI7CiAKLQlp
ZiAoYm8tPm1lbS5zdGFydCAhPSBBTURHUFVfQk9fSU5WQUxJRF9PRkZTRVQpCisJaWYgKGJvLT5y
ZXNvdXJjZS0+c3RhcnQgIT0gQU1ER1BVX0JPX0lOVkFMSURfT0ZGU0VUKQogCQlyZXR1cm4gMDsK
IAogCWFkZHIgPSBhbWRncHVfZ21jX2FncF9hZGRyKGJvKTsKIAlpZiAoYWRkciAhPSBBTURHUFVf
Qk9fSU5WQUxJRF9PRkZTRVQpIHsKLQkJYm8tPm1lbS5zdGFydCA9IGFkZHIgPj4gUEFHRV9TSElG
VDsKKwkJYm8tPnJlc291cmNlLT5zdGFydCA9IGFkZHIgPj4gUEFHRV9TSElGVDsKIAl9IGVsc2Ug
ewogCiAJCS8qIGFsbG9jYXRlIEdBUlQgc3BhY2UgKi8KQEAgLTEwMjIsNyArMTAyMyw3IEBAIGlu
dCBhbWRncHVfdHRtX2FsbG9jX2dhcnQoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibykKIAkJ
cGxhY2VtZW50cy5mcGZuID0gMDsKIAkJcGxhY2VtZW50cy5scGZuID0gYWRldi0+Z21jLmdhcnRf
c2l6ZSA+PiBQQUdFX1NISUZUOwogCQlwbGFjZW1lbnRzLm1lbV90eXBlID0gVFRNX1BMX1RUOwot
CQlwbGFjZW1lbnRzLmZsYWdzID0gYm8tPm1lbS5wbGFjZW1lbnQ7CisJCXBsYWNlbWVudHMuZmxh
Z3MgPSBiby0+cmVzb3VyY2UtPnBsYWNlbWVudDsKIAogCQlyID0gdHRtX2JvX21lbV9zcGFjZShi
bywgJnBsYWNlbWVudCwgJnRtcCwgJmN0eCk7CiAJCWlmICh1bmxpa2VseShyKSkKQEAgLTEwMzks
OCArMTA0MCw4IEBAIGludCBhbWRncHVfdHRtX2FsbG9jX2dhcnQoc3RydWN0IHR0bV9idWZmZXJf
b2JqZWN0ICpibykKIAkJCXJldHVybiByOwogCQl9CiAKLQkJdHRtX3Jlc291cmNlX2ZyZWUoYm8s
ICZiby0+bWVtKTsKLQkJYm8tPm1lbSA9IHRtcDsKKwkJdHRtX3Jlc291cmNlX2ZyZWUoYm8sIGJv
LT5yZXNvdXJjZSk7CisJCXR0bV9ib19hc3NpZ25fbWVtKGJvLCAmdG1wKTsKIAl9CiAKIAlyZXR1
cm4gMDsKQEAgLTEwNjEsNyArMTA2Miw3IEBAIGludCBhbWRncHVfdHRtX3JlY292ZXJfZ2FydChz
dHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKnRibykKIAlpZiAoIXRiby0+dHRtKQogCQlyZXR1cm4g
MDsKIAotCWZsYWdzID0gYW1kZ3B1X3R0bV90dF9wdGVfZmxhZ3MoYWRldiwgdGJvLT50dG0sICZ0
Ym8tPm1lbSk7CisJZmxhZ3MgPSBhbWRncHVfdHRtX3R0X3B0ZV9mbGFncyhhZGV2LCB0Ym8tPnR0
bSwgdGJvLT5yZXNvdXJjZSk7CiAJciA9IGFtZGdwdV90dG1fZ2FydF9iaW5kKGFkZXYsIHRibywg
ZmxhZ3MpOwogCiAJcmV0dXJuIHI7CkBAIC0xMzkwLDcgKzEzOTEsNyBAQCB1aW50NjRfdCBhbWRn
cHVfdHRtX3R0X3B0ZV9mbGFncyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgc3RydWN0IHR0
bV90dCAqdHRtLAogc3RhdGljIGJvb2wgYW1kZ3B1X3R0bV9ib19ldmljdGlvbl92YWx1YWJsZShz
dHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQkJCQkgICAgY29uc3Qgc3RydWN0IHR0bV9w
bGFjZSAqcGxhY2UpCiB7Ci0JdW5zaWduZWQgbG9uZyBudW1fcGFnZXMgPSBiby0+bWVtLm51bV9w
YWdlczsKKwl1bnNpZ25lZCBsb25nIG51bV9wYWdlcyA9IGJvLT5yZXNvdXJjZS0+bnVtX3BhZ2Vz
OwogCXN0cnVjdCBhbWRncHVfcmVzX2N1cnNvciBjdXJzb3I7CiAJc3RydWN0IGRtYV9yZXN2X2xp
c3QgKmZsaXN0OwogCXN0cnVjdCBkbWFfZmVuY2UgKmY7CkBAIC0xNDE0LDcgKzE0MTUsNyBAQCBz
dGF0aWMgYm9vbCBhbWRncHVfdHRtX2JvX2V2aWN0aW9uX3ZhbHVhYmxlKHN0cnVjdCB0dG1fYnVm
ZmVyX29iamVjdCAqYm8sCiAJCX0KIAl9CiAKLQlzd2l0Y2ggKGJvLT5tZW0ubWVtX3R5cGUpIHsK
Kwlzd2l0Y2ggKGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUpIHsKIAljYXNlIFRUTV9QTF9UVDoKIAkJ
aWYgKGFtZGdwdV9ib19pc19hbWRncHVfYm8oYm8pICYmCiAJCSAgICBhbWRncHVfYm9fZW5jcnlw
dGVkKHR0bV90b19hbWRncHVfYm8oYm8pKSkKQEAgLTE0MjMsNyArMTQyNCw3IEBAIHN0YXRpYyBi
b29sIGFtZGdwdV90dG1fYm9fZXZpY3Rpb25fdmFsdWFibGUoc3RydWN0IHR0bV9idWZmZXJfb2Jq
ZWN0ICpibywKIAogCWNhc2UgVFRNX1BMX1ZSQU06CiAJCS8qIENoZWNrIGVhY2ggZHJtIE1NIG5v
ZGUgaW5kaXZpZHVhbGx5ICovCi0JCWFtZGdwdV9yZXNfZmlyc3QoJmJvLT5tZW0sIDAsICh1NjQp
bnVtX3BhZ2VzIDw8IFBBR0VfU0hJRlQsCisJCWFtZGdwdV9yZXNfZmlyc3QoYm8tPnJlc291cmNl
LCAwLCAodTY0KW51bV9wYWdlcyA8PCBQQUdFX1NISUZULAogCQkJCSAmY3Vyc29yKTsKIAkJd2hp
bGUgKGN1cnNvci5yZW1haW5pbmcpIHsKIAkJCWlmIChwbGFjZS0+ZnBmbiA8IFBGTl9ET1dOKGN1
cnNvci5zdGFydCArIGN1cnNvci5zaXplKQpAQCAtMTQ2NSwxMCArMTQ2NiwxMCBAQCBzdGF0aWMg
aW50IGFtZGdwdV90dG1fYWNjZXNzX21lbW9yeShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJv
LAogCXVpbnQzMl90IHZhbHVlID0gMDsKIAlpbnQgcmV0ID0gMDsKIAotCWlmIChiby0+bWVtLm1l
bV90eXBlICE9IFRUTV9QTF9WUkFNKQorCWlmIChiby0+cmVzb3VyY2UtPm1lbV90eXBlICE9IFRU
TV9QTF9WUkFNKQogCQlyZXR1cm4gLUVJTzsKIAotCWFtZGdwdV9yZXNfZmlyc3QoJmJvLT5tZW0s
IG9mZnNldCwgbGVuLCAmY3Vyc29yKTsKKwlhbWRncHVfcmVzX2ZpcnN0KGJvLT5yZXNvdXJjZSwg
b2Zmc2V0LCBsZW4sICZjdXJzb3IpOwogCXdoaWxlIChjdXJzb3IucmVtYWluaW5nKSB7CiAJCXVp
bnQ2NF90IGFsaWduZWRfcG9zID0gY3Vyc29yLnN0YXJ0ICYgfih1aW50NjRfdCkzOwogCQl1aW50
NjRfdCBieXRlcyA9IDQgLSAoY3Vyc29yLnN0YXJ0ICYgMyk7CkBAIC0yMDM3LDE2ICsyMDM4LDE2
IEBAIGludCBhbWRncHVfZmlsbF9idWZmZXIoc3RydWN0IGFtZGdwdV9ibyAqYm8sCiAJCXJldHVy
biAtRUlOVkFMOwogCX0KIAotCWlmIChiby0+dGJvLm1lbS5tZW1fdHlwZSA9PSBUVE1fUExfVFQp
IHsKKwlpZiAoYm8tPnRiby5yZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1RUKSB7CiAJCXIg
PSBhbWRncHVfdHRtX2FsbG9jX2dhcnQoJmJvLT50Ym8pOwogCQlpZiAocikKIAkJCXJldHVybiBy
OwogCX0KIAotCW51bV9ieXRlcyA9IGJvLT50Ym8ubWVtLm51bV9wYWdlcyA8PCBQQUdFX1NISUZU
OworCW51bV9ieXRlcyA9IGJvLT50Ym8ucmVzb3VyY2UtPm51bV9wYWdlcyA8PCBQQUdFX1NISUZU
OwogCW51bV9sb29wcyA9IDA7CiAKLQlhbWRncHVfcmVzX2ZpcnN0KCZiby0+dGJvLm1lbSwgMCwg
bnVtX2J5dGVzLCAmY3Vyc29yKTsKKwlhbWRncHVfcmVzX2ZpcnN0KGJvLT50Ym8ucmVzb3VyY2Us
IDAsIG51bV9ieXRlcywgJmN1cnNvcik7CiAJd2hpbGUgKGN1cnNvci5yZW1haW5pbmcpIHsKIAkJ
bnVtX2xvb3BzICs9IERJVl9ST1VORF9VUF9VTEwoY3Vyc29yLnNpemUsIG1heF9ieXRlcyk7CiAJ
CWFtZGdwdV9yZXNfbmV4dCgmY3Vyc29yLCBjdXJzb3Iuc2l6ZSk7CkBAIC0yMDcxLDEyICsyMDcy
LDEzIEBAIGludCBhbWRncHVfZmlsbF9idWZmZXIoc3RydWN0IGFtZGdwdV9ibyAqYm8sCiAJCX0K
IAl9CiAKLQlhbWRncHVfcmVzX2ZpcnN0KCZiby0+dGJvLm1lbSwgMCwgbnVtX2J5dGVzLCAmY3Vy
c29yKTsKKwlhbWRncHVfcmVzX2ZpcnN0KGJvLT50Ym8ucmVzb3VyY2UsIDAsIG51bV9ieXRlcywg
JmN1cnNvcik7CiAJd2hpbGUgKGN1cnNvci5yZW1haW5pbmcpIHsKIAkJdWludDMyX3QgY3VyX3Np
emUgPSBtaW5fdCh1aW50NjRfdCwgY3Vyc29yLnNpemUsIG1heF9ieXRlcyk7CiAJCXVpbnQ2NF90
IGRzdF9hZGRyID0gY3Vyc29yLnN0YXJ0OwogCi0JCWRzdF9hZGRyICs9IGFtZGdwdV90dG1fZG9t
YWluX3N0YXJ0KGFkZXYsIGJvLT50Ym8ubWVtLm1lbV90eXBlKTsKKwkJZHN0X2FkZHIgKz0gYW1k
Z3B1X3R0bV9kb21haW5fc3RhcnQoYWRldiwKKwkJCQkJCSAgICBiby0+dGJvLnJlc291cmNlLT5t
ZW1fdHlwZSk7CiAJCWFtZGdwdV9lbWl0X2ZpbGxfYnVmZmVyKGFkZXYsICZqb2ItPmlic1swXSwg
c3JjX2RhdGEsIGRzdF9hZGRyLAogCQkJCQljdXJfc2l6ZSk7CiAKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92bS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X3ZtLmMKaW5kZXggMDMxMWY4YjM5YzMyLi4xZTlmMzU4ZjI1ZjMgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92bS5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92bS5jCkBAIC0zMzksNyArMzM5LDcgQEAgc3Rh
dGljIHZvaWQgYW1kZ3B1X3ZtX2JvX2Jhc2VfaW5pdChzdHJ1Y3QgYW1kZ3B1X3ZtX2JvX2Jhc2Ug
KmJhc2UsCiAJCWFtZGdwdV92bV9ib19pZGxlKGJhc2UpOwogCiAJaWYgKGJvLT5wcmVmZXJyZWRf
ZG9tYWlucyAmCi0JICAgIGFtZGdwdV9tZW1fdHlwZV90b19kb21haW4oYm8tPnRiby5tZW0ubWVt
X3R5cGUpKQorCSAgICBhbWRncHVfbWVtX3R5cGVfdG9fZG9tYWluKGJvLT50Ym8ucmVzb3VyY2Ut
Pm1lbV90eXBlKSkKIAkJcmV0dXJuOwogCiAJLyoKQEAgLTY1NCwxMSArNjU0LDExIEBAIHZvaWQg
YW1kZ3B1X3ZtX21vdmVfdG9fbHJ1X3RhaWwoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCiAJ
CWlmICghYm8tPnBhcmVudCkKIAkJCWNvbnRpbnVlOwogCi0JCXR0bV9ib19tb3ZlX3RvX2xydV90
YWlsKCZiby0+dGJvLCAmYm8tPnRiby5tZW0sCisJCXR0bV9ib19tb3ZlX3RvX2xydV90YWlsKCZi
by0+dGJvLCBiby0+dGJvLnJlc291cmNlLAogCQkJCQkmdm0tPmxydV9idWxrX21vdmUpOwogCQlp
ZiAoYm8tPnNoYWRvdykKIAkJCXR0bV9ib19tb3ZlX3RvX2xydV90YWlsKCZiby0+c2hhZG93LT50
Ym8sCi0JCQkJCQkmYm8tPnNoYWRvdy0+dGJvLm1lbSwKKwkJCQkJCWJvLT5zaGFkb3ctPnRiby5y
ZXNvdXJjZSwKIAkJCQkJCSZ2bS0+bHJ1X2J1bGtfbW92ZSk7CiAJfQogCXNwaW5fdW5sb2NrKCZh
ZGV2LT5tbWFuLmJkZXYubHJ1X2xvY2spOwpAQCAtMTczOSwxMCArMTczOSwxMCBAQCBpbnQgYW1k
Z3B1X3ZtX2JvX3VwZGF0ZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgc3RydWN0IGFtZGdw
dV9ib192YSAqYm9fdmEsCiAJCQlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdvYmogPSBkbWFfYnVm
LT5wcml2OwogCQkJc3RydWN0IGFtZGdwdV9ibyAqYWJvID0gZ2VtX3RvX2FtZGdwdV9ibyhnb2Jq
KTsKIAotCQkJaWYgKGFiby0+dGJvLm1lbS5tZW1fdHlwZSA9PSBUVE1fUExfVlJBTSkKKwkJCWlm
IChhYm8tPnRiby5yZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0pCiAJCQkJYm8gPSBn
ZW1fdG9fYW1kZ3B1X2JvKGdvYmopOwogCQl9Ci0JCW1lbSA9ICZiby0+dGJvLm1lbTsKKwkJbWVt
ID0gYm8tPnRiby5yZXNvdXJjZTsKIAkJaWYgKG1lbS0+bWVtX3R5cGUgPT0gVFRNX1BMX1RUKQog
CQkJcGFnZXNfYWRkciA9IGJvLT50Ym8udHRtLT5kbWFfYWRkcmVzczsKIAl9CkBAIC0xODAyLDcg
KzE4MDIsNyBAQCBpbnQgYW1kZ3B1X3ZtX2JvX3VwZGF0ZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAq
YWRldiwgc3RydWN0IGFtZGdwdV9ib192YSAqYm9fdmEsCiAJICogbmV4dCBjb21tYW5kIHN1Ym1p
c3Npb24uCiAJICovCiAJaWYgKGJvICYmIGJvLT50Ym8uYmFzZS5yZXN2ID09IHZtLT5yb290LmJh
c2UuYm8tPnRiby5iYXNlLnJlc3YpIHsKLQkJdWludDMyX3QgbWVtX3R5cGUgPSBiby0+dGJvLm1l
bS5tZW1fdHlwZTsKKwkJdWludDMyX3QgbWVtX3R5cGUgPSBiby0+dGJvLnJlc291cmNlLT5tZW1f
dHlwZTsKIAogCQlpZiAoIShiby0+cHJlZmVycmVkX2RvbWFpbnMgJgogCQkgICAgICBhbWRncHVf
bWVtX3R5cGVfdG9fZG9tYWluKG1lbV90eXBlKSkpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfdnJhbV9tZ3IuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV92cmFtX21nci5jCmluZGV4IDJmZjdiOTRlNThmNS4uYmIwMWUwZmM2MjFjIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdnJhbV9tZ3IuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdnJhbV9tZ3IuYwpAQCAtMjEz
LDcgKzIxMyw3IEBAIHN0YXRpYyB1NjQgYW1kZ3B1X3ZyYW1fbWdyX3Zpc19zaXplKHN0cnVjdCBh
bWRncHVfZGV2aWNlICphZGV2LAogdTY0IGFtZGdwdV92cmFtX21ncl9ib192aXNpYmxlX3NpemUo
c3RydWN0IGFtZGdwdV9ibyAqYm8pCiB7CiAJc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSBh
bWRncHVfdHRtX2FkZXYoYm8tPnRiby5iZGV2KTsKLQlzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0g
PSAmYm8tPnRiby5tZW07CisJc3RydWN0IHR0bV9yZXNvdXJjZSAqbWVtID0gYm8tPnRiby5yZXNv
dXJjZTsKIAlzdHJ1Y3QgZHJtX21tX25vZGUgKm5vZGVzID0gbWVtLT5tbV9ub2RlOwogCXVuc2ln
bmVkIHBhZ2VzID0gbWVtLT5udW1fcGFnZXM7CiAJdTY0IHVzYWdlOwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2RybV9nZW1fdHRtX2hlbHBlci5jIGIvZHJpdmVycy9ncHUvZHJtL2RybV9n
ZW1fdHRtX2hlbHBlci5jCmluZGV4IGIxNGJlZDhiZTc3MS4uZWNmM2QyYTU0YTk4IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2dlbV90dG1faGVscGVyLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2RybV9nZW1fdHRtX2hlbHBlci5jCkBAIC00MCwxMiArNDAsMTIgQEAgdm9pZCBkcm1f
Z2VtX3R0bV9wcmludF9pbmZvKHN0cnVjdCBkcm1fcHJpbnRlciAqcCwgdW5zaWduZWQgaW50IGlu
ZGVudCwKIAljb25zdCBzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvID0gZHJtX2dlbV90dG1f
b2ZfZ2VtKGdlbSk7CiAKIAlkcm1fcHJpbnRmX2luZGVudChwLCBpbmRlbnQsICJwbGFjZW1lbnQ9
Iik7Ci0JZHJtX3ByaW50X2JpdHMocCwgYm8tPm1lbS5wbGFjZW1lbnQsIHBsbmFtZSwgQVJSQVlf
U0laRShwbG5hbWUpKTsKKwlkcm1fcHJpbnRfYml0cyhwLCBiby0+cmVzb3VyY2UtPnBsYWNlbWVu
dCwgcGxuYW1lLCBBUlJBWV9TSVpFKHBsbmFtZSkpOwogCWRybV9wcmludGYocCwgIlxuIik7CiAK
LQlpZiAoYm8tPm1lbS5idXMuaXNfaW9tZW0pCisJaWYgKGJvLT5yZXNvdXJjZS0+YnVzLmlzX2lv
bWVtKQogCQlkcm1fcHJpbnRmX2luZGVudChwLCBpbmRlbnQsICJidXMub2Zmc2V0PSVseFxuIiwK
LQkJCQkgICh1bnNpZ25lZCBsb25nKWJvLT5tZW0uYnVzLm9mZnNldCk7CisJCQkJICAodW5zaWdu
ZWQgbG9uZyliby0+cmVzb3VyY2UtPmJ1cy5vZmZzZXQpOwogfQogRVhQT1JUX1NZTUJPTChkcm1f
Z2VtX3R0bV9wcmludF9pbmZvKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2RybV9n
ZW1fdnJhbV9oZWxwZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMK
aW5kZXggNzk3MjAwMzE1ODU0Li44M2U3MjU4YzdmOTAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2RybV9nZW1f
dnJhbV9oZWxwZXIuYwpAQCAtMjQ4LDEwICsyNDgsMTAgQEAgRVhQT1JUX1NZTUJPTChkcm1fZ2Vt
X3ZyYW1fcHV0KTsKIHN0YXRpYyB1NjQgZHJtX2dlbV92cmFtX3BnX29mZnNldChzdHJ1Y3QgZHJt
X2dlbV92cmFtX29iamVjdCAqZ2JvKQogewogCS8qIEtlZXAgVFRNIGJlaGF2aW9yIGZvciBub3cs
IHJlbW92ZSB3aGVuIGRyaXZlcnMgYXJlIGF1ZGl0ZWQgKi8KLQlpZiAoV0FSTl9PTl9PTkNFKCFn
Ym8tPmJvLm1lbS5tbV9ub2RlKSkKKwlpZiAoV0FSTl9PTl9PTkNFKCFnYm8tPmJvLnJlc291cmNl
LT5tbV9ub2RlKSkKIAkJcmV0dXJuIDA7CiAKLQlyZXR1cm4gZ2JvLT5iby5tZW0uc3RhcnQ7CisJ
cmV0dXJuIGdiby0+Ym8ucmVzb3VyY2UtPnN0YXJ0OwogfQogCiAvKioKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfYWJpMTYuYyBiL2RyaXZlcnMvZ3B1L2RybS9u
b3V2ZWF1L25vdXZlYXVfYWJpMTYuYwppbmRleCAwYTkzMzRkZWZmZTIuLmI0NWVjMzA4NjI4NSAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9hYmkxNi5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfYWJpMTYuYwpAQCAtMzEyLDcgKzMxMiw3
IEBAIG5vdXZlYXVfYWJpMTZfaW9jdGxfY2hhbm5lbF9hbGxvYyhBQkkxNl9JT0NUTF9BUkdTKQog
CQlpbml0LT5wdXNoYnVmX2RvbWFpbnMgPSBOT1VWRUFVX0dFTV9ET01BSU5fVlJBTSB8CiAJCQkJ
CU5PVVZFQVVfR0VNX0RPTUFJTl9HQVJUOwogCWVsc2UKLQlpZiAoY2hhbi0+Y2hhbi0+cHVzaC5i
dWZmZXItPmJvLm1lbS5tZW1fdHlwZSA9PSBUVE1fUExfVlJBTSkKKwlpZiAoY2hhbi0+Y2hhbi0+
cHVzaC5idWZmZXItPmJvLnJlc291cmNlLT5tZW1fdHlwZSA9PSBUVE1fUExfVlJBTSkKIAkJaW5p
dC0+cHVzaGJ1Zl9kb21haW5zID0gTk9VVkVBVV9HRU1fRE9NQUlOX1ZSQU07CiAJZWxzZQogCQlp
bml0LT5wdXNoYnVmX2RvbWFpbnMgPSBOT1VWRUFVX0dFTV9ET01BSU5fR0FSVDsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfYm8uYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9ub3V2ZWF1L25vdXZlYXVfYm8uYwppbmRleCA3YTI2MjRjMGJhNGMuLjllYWEzMjc0YmQwMiAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9iby5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfYm8uYwpAQCAtNDMzLDcgKzQzMyw3IEBAIG5v
dXZlYXVfYm9fcGluKHN0cnVjdCBub3V2ZWF1X2JvICpudmJvLCB1aW50MzJfdCBkb21haW4sIGJv
b2wgY29udGlnKQogCWlmIChudmJvLT5iby5waW5fY291bnQpIHsKIAkJYm9vbCBlcnJvciA9IGV2
aWN0OwogCi0JCXN3aXRjaCAoYm8tPm1lbS5tZW1fdHlwZSkgeworCQlzd2l0Y2ggKGJvLT5yZXNv
dXJjZS0+bWVtX3R5cGUpIHsKIAkJY2FzZSBUVE1fUExfVlJBTToKIAkJCWVycm9yIHw9ICEoZG9t
YWluICYgTk9VVkVBVV9HRU1fRE9NQUlOX1ZSQU0pOwogCQkJYnJlYWs7CkBAIC00NDYsNyArNDQ2
LDcgQEAgbm91dmVhdV9ib19waW4oc3RydWN0IG5vdXZlYXVfYm8gKm52Ym8sIHVpbnQzMl90IGRv
bWFpbiwgYm9vbCBjb250aWcpCiAJCWlmIChlcnJvcikgewogCQkJTlZfRVJST1IoZHJtLCAiYm8g
JXAgcGlubmVkIGVsc2V3aGVyZTogIgogCQkJCSAgICAgICIweCUwOHggdnMgMHglMDh4XG4iLCBi
bywKLQkJCQkgYm8tPm1lbS5tZW1fdHlwZSwgZG9tYWluKTsKKwkJCQkgYm8tPnJlc291cmNlLT5t
ZW1fdHlwZSwgZG9tYWluKTsKIAkJCXJldCA9IC1FQlVTWTsKIAkJfQogCQl0dG1fYm9fcGluKCZu
dmJvLT5ibyk7CkBAIC00NjcsNyArNDY3LDcgQEAgbm91dmVhdV9ib19waW4oc3RydWN0IG5vdXZl
YXVfYm8gKm52Ym8sIHVpbnQzMl90IGRvbWFpbiwgYm9vbCBjb250aWcpCiAKIAl0dG1fYm9fcGlu
KCZudmJvLT5ibyk7CiAKLQlzd2l0Y2ggKGJvLT5tZW0ubWVtX3R5cGUpIHsKKwlzd2l0Y2ggKGJv
LT5yZXNvdXJjZS0+bWVtX3R5cGUpIHsKIAljYXNlIFRUTV9QTF9WUkFNOgogCQlkcm0tPmdlbS52
cmFtX2F2YWlsYWJsZSAtPSBiby0+YmFzZS5zaXplOwogCQlicmVhazsKQEAgLTQ5OCw3ICs0OTgs
NyBAQCBub3V2ZWF1X2JvX3VucGluKHN0cnVjdCBub3V2ZWF1X2JvICpudmJvKQogCiAJdHRtX2Jv
X3VucGluKCZudmJvLT5ibyk7CiAJaWYgKCFudmJvLT5iby5waW5fY291bnQpIHsKLQkJc3dpdGNo
IChiby0+bWVtLm1lbV90eXBlKSB7CisJCXN3aXRjaCAoYm8tPnJlc291cmNlLT5tZW1fdHlwZSkg
ewogCQljYXNlIFRUTV9QTF9WUkFNOgogCQkJZHJtLT5nZW0udnJhbV9hdmFpbGFibGUgKz0gYm8t
PmJhc2Uuc2l6ZTsKIAkJCWJyZWFrOwpAQCAtNTIzLDcgKzUyMyw3IEBAIG5vdXZlYXVfYm9fbWFw
KHN0cnVjdCBub3V2ZWF1X2JvICpudmJvKQogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKLQly
ZXQgPSB0dG1fYm9fa21hcCgmbnZiby0+Ym8sIDAsIG52Ym8tPmJvLm1lbS5udW1fcGFnZXMsICZu
dmJvLT5rbWFwKTsKKwlyZXQgPSB0dG1fYm9fa21hcCgmbnZiby0+Ym8sIDAsIG52Ym8tPmJvLnJl
c291cmNlLT5udW1fcGFnZXMsICZudmJvLT5rbWFwKTsKIAogCXR0bV9ib191bnJlc2VydmUoJm52
Ym8tPmJvKTsKIAlyZXR1cm4gcmV0OwpAQCAtNzM3LDcgKzczNyw3IEBAIG5vdXZlYXVfYm9fZXZp
Y3RfZmxhZ3Moc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywgc3RydWN0IHR0bV9wbGFjZW1l
bnQgKnBsKQogewogCXN0cnVjdCBub3V2ZWF1X2JvICpudmJvID0gbm91dmVhdV9ibyhibyk7CiAK
LQlzd2l0Y2ggKGJvLT5tZW0ubWVtX3R5cGUpIHsKKwlzd2l0Y2ggKGJvLT5yZXNvdXJjZS0+bWVt
X3R5cGUpIHsKIAljYXNlIFRUTV9QTF9WUkFNOgogCQlub3V2ZWF1X2JvX3BsYWNlbWVudF9zZXQo
bnZibywgTk9VVkVBVV9HRU1fRE9NQUlOX0dBUlQsCiAJCQkJCSBOT1VWRUFVX0dFTV9ET01BSU5f
Q1BVKTsKQEAgLTc1NCw3ICs3NTQsNyBAQCBzdGF0aWMgaW50CiBub3V2ZWF1X2JvX21vdmVfcHJl
cChzdHJ1Y3Qgbm91dmVhdV9kcm0gKmRybSwgc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywK
IAkJICAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlICpyZWcpCiB7Ci0Jc3RydWN0IG5vdXZlYXVfbWVt
ICpvbGRfbWVtID0gbm91dmVhdV9tZW0oJmJvLT5tZW0pOworCXN0cnVjdCBub3V2ZWF1X21lbSAq
b2xkX21lbSA9IG5vdXZlYXVfbWVtKGJvLT5yZXNvdXJjZSk7CiAJc3RydWN0IG5vdXZlYXVfbWVt
ICpuZXdfbWVtID0gbm91dmVhdV9tZW0ocmVnKTsKIAlzdHJ1Y3QgbnZpZl92bW0gKnZtbSA9ICZk
cm0tPmNsaWVudC52bW0udm1tOwogCWludCByZXQ7CkBAIC04MDksNyArODA5LDcgQEAgbm91dmVh
dV9ib19tb3ZlX20ybWYoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywgaW50IGV2aWN0LAog
CQltdXRleF9sb2NrX25lc3RlZCgmY2xpLT5tdXRleCwgU0lOR0xFX0RFUFRIX05FU1RJTkcpOwog
CXJldCA9IG5vdXZlYXVfZmVuY2Vfc3luYyhub3V2ZWF1X2JvKGJvKSwgY2hhbiwgdHJ1ZSwgY3R4
LT5pbnRlcnJ1cHRpYmxlKTsKIAlpZiAocmV0ID09IDApIHsKLQkJcmV0ID0gZHJtLT50dG0ubW92
ZShjaGFuLCBibywgJmJvLT5tZW0sIG5ld19yZWcpOworCQlyZXQgPSBkcm0tPnR0bS5tb3ZlKGNo
YW4sIGJvLCBiby0+cmVzb3VyY2UsIG5ld19yZWcpOwogCQlpZiAocmV0ID09IDApIHsKIAkJCXJl
dCA9IG5vdXZlYXVfZmVuY2VfbmV3KGNoYW4sIGZhbHNlLCAmZmVuY2UpOwogCQkJaWYgKHJldCA9
PSAwKSB7CkBAIC05NjksNyArOTY5LDcgQEAgbm91dmVhdV9ib19tb3ZlKHN0cnVjdCB0dG1fYnVm
ZmVyX29iamVjdCAqYm8sIGJvb2wgZXZpY3QsCiB7CiAJc3RydWN0IG5vdXZlYXVfZHJtICpkcm0g
PSBub3V2ZWF1X2JkZXYoYm8tPmJkZXYpOwogCXN0cnVjdCBub3V2ZWF1X2JvICpudmJvID0gbm91
dmVhdV9ibyhibyk7Ci0Jc3RydWN0IHR0bV9yZXNvdXJjZSAqb2xkX3JlZyA9ICZiby0+bWVtOwor
CXN0cnVjdCB0dG1fcmVzb3VyY2UgKm9sZF9yZWcgPSBiby0+cmVzb3VyY2U7CiAJc3RydWN0IG5v
dXZlYXVfZHJtX3RpbGUgKm5ld190aWxlID0gTlVMTDsKIAlpbnQgcmV0ID0gMDsKIApAQCAtMTAw
OSw3ICsxMDA5LDcgQEAgbm91dmVhdV9ib19tb3ZlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAq
Ym8sIGJvb2wgZXZpY3QsCiAJaWYgKG9sZF9yZWctPm1lbV90eXBlID09IFRUTV9QTF9UVCAmJgog
CSAgICBuZXdfcmVnLT5tZW1fdHlwZSA9PSBUVE1fUExfU1lTVEVNKSB7CiAJCW5vdXZlYXVfdHRt
X3R0X3VuYmluZChiby0+YmRldiwgYm8tPnR0bSk7Ci0JCXR0bV9yZXNvdXJjZV9mcmVlKGJvLCAm
Ym8tPm1lbSk7CisJCXR0bV9yZXNvdXJjZV9mcmVlKGJvLCBiby0+cmVzb3VyY2UpOwogCQl0dG1f
Ym9fYXNzaWduX21lbShibywgbmV3X3JlZyk7CiAJCWdvdG8gb3V0OwogCX0KQEAgLTEwNDUsNyAr
MTA0NSw3IEBAIG5vdXZlYXVfYm9fbW92ZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLCBi
b29sIGV2aWN0LAogCX0KIG91dF9udGZ5OgogCWlmIChyZXQpIHsKLQkJbm91dmVhdV9ib19tb3Zl
X250ZnkoYm8sICZiby0+bWVtKTsKKwkJbm91dmVhdV9ib19tb3ZlX250ZnkoYm8sIGJvLT5yZXNv
dXJjZSk7CiAJfQogCXJldHVybiByZXQ7CiB9CkBAIC0xMTc5LDcgKzExNzksNyBAQCBub3V2ZWF1
X3R0bV9pb19tZW1fcmVzZXJ2ZShzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV9y
ZXNvdXJjZSAqcmVnKQogCQkJbGlzdF9kZWxfaW5pdCgmbnZiby0+aW9fcmVzZXJ2ZV9scnUpOwog
CQkJZHJtX3ZtYV9ub2RlX3VubWFwKCZudmJvLT5iby5iYXNlLnZtYV9ub2RlLAogCQkJCQkgICBi
ZGV2LT5kZXZfbWFwcGluZyk7Ci0JCQlub3V2ZWF1X3R0bV9pb19tZW1fZnJlZV9sb2NrZWQoZHJt
LCAmbnZiby0+Ym8ubWVtKTsKKwkJCW5vdXZlYXVfdHRtX2lvX21lbV9mcmVlX2xvY2tlZChkcm0s
IG52Ym8tPmJvLnJlc291cmNlKTsKIAkJCWdvdG8gcmV0cnk7CiAJCX0KIApAQCAtMTIwOSwxMiAr
MTIwOSwxMiBAQCB2bV9mYXVsdF90IG5vdXZlYXVfdHRtX2ZhdWx0X3Jlc2VydmVfbm90aWZ5KHN0
cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8pCiAJLyogYXMgbG9uZyBhcyB0aGUgYm8gaXNuJ3Qg
aW4gdnJhbSwgYW5kIGlzbid0IHRpbGVkLCB3ZSd2ZSBnb3QKIAkgKiBub3RoaW5nIHRvIGRvIGhl
cmUuCiAJICovCi0JaWYgKGJvLT5tZW0ubWVtX3R5cGUgIT0gVFRNX1BMX1ZSQU0pIHsKKwlpZiAo
Ym8tPnJlc291cmNlLT5tZW1fdHlwZSAhPSBUVE1fUExfVlJBTSkgewogCQlpZiAoZHJtLT5jbGll
bnQuZGV2aWNlLmluZm8uZmFtaWx5IDwgTlZfREVWSUNFX0lORk9fVjBfVEVTTEEgfHwKIAkJICAg
ICFudmJvLT5raW5kKQogCQkJcmV0dXJuIDA7CiAKLQkJaWYgKGJvLT5tZW0ubWVtX3R5cGUgIT0g
VFRNX1BMX1NZU1RFTSkKKwkJaWYgKGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgIT0gVFRNX1BMX1NZ
U1RFTSkKIAkJCXJldHVybiAwOwogCiAJCW5vdXZlYXVfYm9fcGxhY2VtZW50X3NldChudmJvLCBO
T1VWRUFVX0dFTV9ET01BSU5fR0FSVCwgMCk7CkBAIC0xMjIyLDcgKzEyMjIsNyBAQCB2bV9mYXVs
dF90IG5vdXZlYXVfdHRtX2ZhdWx0X3Jlc2VydmVfbm90aWZ5KHN0cnVjdCB0dG1fYnVmZmVyX29i
amVjdCAqYm8pCiAJfSBlbHNlIHsKIAkJLyogbWFrZSBzdXJlIGJvIGlzIGluIG1hcHBhYmxlIHZy
YW0gKi8KIAkJaWYgKGRybS0+Y2xpZW50LmRldmljZS5pbmZvLmZhbWlseSA+PSBOVl9ERVZJQ0Vf
SU5GT19WMF9URVNMQSB8fAotCQkgICAgYm8tPm1lbS5zdGFydCArIGJvLT5tZW0ubnVtX3BhZ2Vz
IDwgbWFwcGFibGUpCisJCSAgICBiby0+cmVzb3VyY2UtPnN0YXJ0ICsgYm8tPnJlc291cmNlLT5u
dW1fcGFnZXMgPCBtYXBwYWJsZSkKIAkJCXJldHVybiAwOwogCiAJCWZvciAoaSA9IDA7IGkgPCBu
dmJvLT5wbGFjZW1lbnQubnVtX3BsYWNlbWVudDsgKytpKSB7CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2NoYW4uYyBiL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1
L25vdXZlYXVfY2hhbi5jCmluZGV4IDdjZmFjMjY1ZmQ0NS4uNDAzNjI2MDBlZWQyIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2NoYW4uYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2NoYW4uYwpAQCAtMjEyLDcgKzIxMiw3IEBAIG5vdXZl
YXVfY2hhbm5lbF9wcmVwKHN0cnVjdCBub3V2ZWF1X2RybSAqZHJtLCBzdHJ1Y3QgbnZpZl9kZXZp
Y2UgKmRldmljZSwKIAkJYXJncy5zdGFydCA9IDA7CiAJCWFyZ3MubGltaXQgPSBjaGFuLT52bW0t
PnZtbS5saW1pdCAtIDE7CiAJfSBlbHNlCi0JaWYgKGNoYW4tPnB1c2guYnVmZmVyLT5iby5tZW0u
bWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0pIHsKKwlpZiAoY2hhbi0+cHVzaC5idWZmZXItPmJvLnJl
c291cmNlLT5tZW1fdHlwZSA9PSBUVE1fUExfVlJBTSkgewogCQlpZiAoZGV2aWNlLT5pbmZvLmZh
bWlseSA9PSBOVl9ERVZJQ0VfSU5GT19WMF9UTlQpIHsKIAkJCS8qIG52MDQgdnJhbSBwdXNoYnVm
IGhhY2ssIHJldGFyZ2V0IHRvIGl0cyBsb2NhdGlvbiBpbgogCQkJICogdGhlIGZyYW1lYnVmZmVy
IGJhciByYXRoZXIgdGhhbiBkaXJlY3QgdnJhbSBhY2Nlc3MuLgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9mYmNvbi5jIGIvZHJpdmVycy9ncHUvZHJtL25vdXZl
YXUvbm91dmVhdV9mYmNvbi5jCmluZGV4IDkzYWM3OGJkYTc1MC4uNGY5YjNhYTVkZWRhIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2ZiY29uLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9mYmNvbi5jCkBAIC0zNzgsNyArMzc4LDcgQEAg
bm91dmVhdV9mYmNvbl9jcmVhdGUoc3RydWN0IGRybV9mYl9oZWxwZXIgKmhlbHBlciwKIAkJCSAg
ICAgIEZCSU5GT19IV0FDQ0VMX0ZJTExSRUNUIHwKIAkJCSAgICAgIEZCSU5GT19IV0FDQ0VMX0lN
QUdFQkxJVDsKIAlpbmZvLT5mYm9wcyA9ICZub3V2ZWF1X2ZiY29uX3N3X29wczsKLQlpbmZvLT5m
aXguc21lbV9zdGFydCA9IG52Ym8tPmJvLm1lbS5idXMub2Zmc2V0OworCWluZm8tPmZpeC5zbWVt
X3N0YXJ0ID0gbnZiby0+Ym8ucmVzb3VyY2UtPmJ1cy5vZmZzZXQ7CiAJaW5mby0+Zml4LnNtZW1f
bGVuID0gbnZiby0+Ym8uYmFzZS5zaXplOwogCiAJaW5mby0+c2NyZWVuX2Jhc2UgPSBudmJvX2tt
YXBfb2JqX2lvdmlydHVhbChudmJvKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2
ZWF1L25vdXZlYXVfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2dlbS5j
CmluZGV4IGE3MGU4MjQxM2ZhNy4uNzFiMjQwMWY4YzczIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vbm91dmVhdS9ub3V2ZWF1X2dlbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1
L25vdXZlYXVfZ2VtLmMKQEAgLTI0MCw3ICsyNDAsNyBAQCBub3V2ZWF1X2dlbV9pbmZvKHN0cnVj
dCBkcm1fZmlsZSAqZmlsZV9wcml2LCBzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdlbSwKIAogCWlm
IChpc19wb3dlcl9vZl8yKG52Ym8tPnZhbGlkX2RvbWFpbnMpKQogCQlyZXAtPmRvbWFpbiA9IG52
Ym8tPnZhbGlkX2RvbWFpbnM7Ci0JZWxzZSBpZiAobnZiby0+Ym8ubWVtLm1lbV90eXBlID09IFRU
TV9QTF9UVCkKKwllbHNlIGlmIChudmJvLT5iby5yZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BM
X1RUKQogCQlyZXAtPmRvbWFpbiA9IE5PVVZFQVVfR0VNX0RPTUFJTl9HQVJUOwogCWVsc2UKIAkJ
cmVwLT5kb21haW4gPSBOT1VWRUFVX0dFTV9ET01BSU5fVlJBTTsKQEAgLTMxMSwxMSArMzExLDEx
IEBAIG5vdXZlYXVfZ2VtX3NldF9kb21haW4oc3RydWN0IGRybV9nZW1fb2JqZWN0ICpnZW0sIHVp
bnQzMl90IHJlYWRfZG9tYWlucywKIAl2YWxpZF9kb21haW5zICY9IH4oTk9VVkVBVV9HRU1fRE9N
QUlOX1ZSQU0gfCBOT1VWRUFVX0dFTV9ET01BSU5fR0FSVCk7CiAKIAlpZiAoKGRvbWFpbnMgJiBO
T1VWRUFVX0dFTV9ET01BSU5fVlJBTSkgJiYKLQkgICAgYm8tPm1lbS5tZW1fdHlwZSA9PSBUVE1f
UExfVlJBTSkKKwkgICAgYm8tPnJlc291cmNlLT5tZW1fdHlwZSA9PSBUVE1fUExfVlJBTSkKIAkJ
cHJlZl9kb21haW5zIHw9IE5PVVZFQVVfR0VNX0RPTUFJTl9WUkFNOwogCiAJZWxzZSBpZiAoKGRv
bWFpbnMgJiBOT1VWRUFVX0dFTV9ET01BSU5fR0FSVCkgJiYKLQkJIGJvLT5tZW0ubWVtX3R5cGUg
PT0gVFRNX1BMX1RUKQorCQkgYm8tPnJlc291cmNlLT5tZW1fdHlwZSA9PSBUVE1fUExfVFQpCiAJ
CXByZWZfZG9tYWlucyB8PSBOT1VWRUFVX0dFTV9ET01BSU5fR0FSVDsKIAogCWVsc2UgaWYgKGRv
bWFpbnMgJiBOT1VWRUFVX0dFTV9ET01BSU5fVlJBTSkKQEAgLTUyNSwxMyArNTI1LDEzIEBAIHZh
bGlkYXRlX2xpc3Qoc3RydWN0IG5vdXZlYXVfY2hhbm5lbCAqY2hhbiwgc3RydWN0IG5vdXZlYXVf
Y2xpICpjbGksCiAKIAkJaWYgKGRybS0+Y2xpZW50LmRldmljZS5pbmZvLmZhbWlseSA8IE5WX0RF
VklDRV9JTkZPX1YwX1RFU0xBKSB7CiAJCQlpZiAobnZiby0+b2Zmc2V0ID09IGItPnByZXN1bWVk
Lm9mZnNldCAmJgotCQkJICAgICgobnZiby0+Ym8ubWVtLm1lbV90eXBlID09IFRUTV9QTF9WUkFN
ICYmCisJCQkgICAgKChudmJvLT5iby5yZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0g
JiYKIAkJCSAgICAgIGItPnByZXN1bWVkLmRvbWFpbiAmIE5PVVZFQVVfR0VNX0RPTUFJTl9WUkFN
KSB8fAotCQkJICAgICAobnZiby0+Ym8ubWVtLm1lbV90eXBlID09IFRUTV9QTF9UVCAmJgorCQkJ
ICAgICAobnZiby0+Ym8ucmVzb3VyY2UtPm1lbV90eXBlID09IFRUTV9QTF9UVCAmJgogCQkJICAg
ICAgYi0+cHJlc3VtZWQuZG9tYWluICYgTk9VVkVBVV9HRU1fRE9NQUlOX0dBUlQpKSkKIAkJCQlj
b250aW51ZTsKIAotCQkJaWYgKG52Ym8tPmJvLm1lbS5tZW1fdHlwZSA9PSBUVE1fUExfVFQpCisJ
CQlpZiAobnZiby0+Ym8ucmVzb3VyY2UtPm1lbV90eXBlID09IFRUTV9QTF9UVCkKIAkJCQliLT5w
cmVzdW1lZC5kb21haW4gPSBOT1VWRUFVX0dFTV9ET01BSU5fR0FSVDsKIAkJCWVsc2UKIAkJCQli
LT5wcmVzdW1lZC5kb21haW4gPSBOT1VWRUFVX0dFTV9ET01BSU5fVlJBTTsKQEAgLTY0NSw3ICs2
NDUsNyBAQCBub3V2ZWF1X2dlbV9wdXNoYnVmX3JlbG9jX2FwcGx5KHN0cnVjdCBub3V2ZWF1X2Ns
aSAqY2xpLAogCQl9CiAKIAkJaWYgKCFudmJvLT5rbWFwLnZpcnR1YWwpIHsKLQkJCXJldCA9IHR0
bV9ib19rbWFwKCZudmJvLT5ibywgMCwgbnZiby0+Ym8ubWVtLm51bV9wYWdlcywKKwkJCXJldCA9
IHR0bV9ib19rbWFwKCZudmJvLT5ibywgMCwgbnZiby0+Ym8ucmVzb3VyY2UtPm51bV9wYWdlcywK
IAkJCQkJICAmbnZiby0+a21hcCk7CiAJCQlpZiAocmV0KSB7CiAJCQkJTlZfUFJJTlRLKGVyciwg
Y2xpLCAiZmFpbGVkIGttYXAgZm9yIHJlbG9jXG4iKTsKQEAgLTgzNCw3ICs4MzQsNyBAQCBub3V2
ZWF1X2dlbV9pb2N0bF9wdXNoYnVmKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEs
CiAJCQlpZiAodW5saWtlbHkoY21kICE9IHJlcS0+c3VmZml4MCkpIHsKIAkJCQlpZiAoIW52Ym8t
PmttYXAudmlydHVhbCkgewogCQkJCQlyZXQgPSB0dG1fYm9fa21hcCgmbnZiby0+Ym8sIDAsCi0J
CQkJCQkJICBudmJvLT5iby5tZW0uCisJCQkJCQkJICBudmJvLT5iby5yZXNvdXJjZS0+CiAJCQkJ
CQkJICBudW1fcGFnZXMsCiAJCQkJCQkJICAmbnZiby0+a21hcCk7CiAJCQkJCWlmIChyZXQpIHsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfdm1tLmMgYi9kcml2
ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X3ZtbS5jCmluZGV4IGE0OWU4ODEyOWM5Mi4uNjdk
NjYxOWZjZDVlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X3Zt
bS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfdm1tLmMKQEAgLTc3LDcg
Kzc3LDcgQEAgaW50CiBub3V2ZWF1X3ZtYV9uZXcoc3RydWN0IG5vdXZlYXVfYm8gKm52Ym8sIHN0
cnVjdCBub3V2ZWF1X3ZtbSAqdm1tLAogCQlzdHJ1Y3Qgbm91dmVhdV92bWEgKipwdm1hKQogewot
CXN0cnVjdCBub3V2ZWF1X21lbSAqbWVtID0gbm91dmVhdV9tZW0oJm52Ym8tPmJvLm1lbSk7CisJ
c3RydWN0IG5vdXZlYXVfbWVtICptZW0gPSBub3V2ZWF1X21lbShudmJvLT5iby5yZXNvdXJjZSk7
CiAJc3RydWN0IG5vdXZlYXVfdm1hICp2bWE7CiAJc3RydWN0IG52aWZfdm1hIHRtcDsKIAlpbnQg
cmV0OwpAQCAtOTYsNyArOTYsNyBAQCBub3V2ZWF1X3ZtYV9uZXcoc3RydWN0IG5vdXZlYXVfYm8g
Km52Ym8sIHN0cnVjdCBub3V2ZWF1X3ZtbSAqdm1tLAogCXZtYS0+ZmVuY2UgPSBOVUxMOwogCWxp
c3RfYWRkX3RhaWwoJnZtYS0+aGVhZCwgJm52Ym8tPnZtYV9saXN0KTsKIAotCWlmIChudmJvLT5i
by5tZW0ubWVtX3R5cGUgIT0gVFRNX1BMX1NZU1RFTSAmJgorCWlmIChudmJvLT5iby5yZXNvdXJj
ZS0+bWVtX3R5cGUgIT0gVFRNX1BMX1NZU1RFTSAmJgogCSAgICBtZW0tPm1lbS5wYWdlID09IG52
Ym8tPnBhZ2UpIHsKIAkJcmV0ID0gbnZpZl92bW1fZ2V0KCZ2bW0tPnZtbSwgTEFaWSwgZmFsc2Us
IG1lbS0+bWVtLnBhZ2UsIDAsCiAJCQkJICAgbWVtLT5tZW0uc2l6ZSwgJnRtcCk7CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9udjE3X2ZlbmNlLmMgYi9kcml2ZXJzL2dwdS9k
cm0vbm91dmVhdS9udjE3X2ZlbmNlLmMKaW5kZXggYjFjZDhkN2RkODdkLi4wN2MyZTA4NzhjMjQg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L252MTdfZmVuY2UuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vbm91dmVhdS9udjE3X2ZlbmNlLmMKQEAgLTc3LDggKzc3LDggQEAgc3Rh
dGljIGludAogbnYxN19mZW5jZV9jb250ZXh0X25ldyhzdHJ1Y3Qgbm91dmVhdV9jaGFubmVsICpj
aGFuKQogewogCXN0cnVjdCBudjEwX2ZlbmNlX3ByaXYgKnByaXYgPSBjaGFuLT5kcm0tPmZlbmNl
OworCXN0cnVjdCB0dG1fcmVzb3VyY2UgKnJlZyA9IHByaXYtPmJvLT5iby5yZXNvdXJjZTsKIAlz
dHJ1Y3QgbnYxMF9mZW5jZV9jaGFuICpmY3R4OwotCXN0cnVjdCB0dG1fcmVzb3VyY2UgKnJlZyA9
ICZwcml2LT5iby0+Ym8ubWVtOwogCXUzMiBzdGFydCA9IHJlZy0+c3RhcnQgKiBQQUdFX1NJWkU7
CiAJdTMyIGxpbWl0ID0gc3RhcnQgKyBwcml2LT5iby0+Ym8uYmFzZS5zaXplIC0gMTsKIAlpbnQg
cmV0ID0gMDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L252NTBfZmVuY2Uu
YyBiL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L252NTBfZmVuY2UuYwppbmRleCAxNjI1ODI2NTA1
ZjYuLmVhMWUxZjQ4MGJmZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbnY1
MF9mZW5jZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L252NTBfZmVuY2UuYwpAQCAt
MzcsNyArMzcsNyBAQCBudjUwX2ZlbmNlX2NvbnRleHRfbmV3KHN0cnVjdCBub3V2ZWF1X2NoYW5u
ZWwgKmNoYW4pCiB7CiAJc3RydWN0IG52MTBfZmVuY2VfcHJpdiAqcHJpdiA9IGNoYW4tPmRybS0+
ZmVuY2U7CiAJc3RydWN0IG52MTBfZmVuY2VfY2hhbiAqZmN0eDsKLQlzdHJ1Y3QgdHRtX3Jlc291
cmNlICpyZWcgPSAmcHJpdi0+Ym8tPmJvLm1lbTsKKwlzdHJ1Y3QgdHRtX3Jlc291cmNlICpyZWcg
PSBwcml2LT5iby0+Ym8ucmVzb3VyY2U7CiAJdTMyIHN0YXJ0ID0gcmVnLT5zdGFydCAqIFBBR0Vf
U0laRTsKIAl1MzIgbGltaXQgPSBzdGFydCArIHByaXYtPmJvLT5iby5iYXNlLnNpemUgLSAxOwog
CWludCByZXQ7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF9kcnYuaCBiL2Ry
aXZlcnMvZ3B1L2RybS9xeGwvcXhsX2Rydi5oCmluZGV4IDIwYTBmM2FiODRhZC4uZGQ2YWJlZTU1
ZjU2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF9kcnYuaAorKysgYi9kcml2
ZXJzL2dwdS9kcm0vcXhsL3F4bF9kcnYuaApAQCAtMjkyLDEyICsyOTIsMTIgQEAgcXhsX2JvX3Bo
eXNpY2FsX2FkZHJlc3Moc3RydWN0IHF4bF9kZXZpY2UgKnFkZXYsIHN0cnVjdCBxeGxfYm8gKmJv
LAogCQkJdW5zaWduZWQgbG9uZyBvZmZzZXQpCiB7CiAJc3RydWN0IHF4bF9tZW1zbG90ICpzbG90
ID0KLQkJKGJvLT50Ym8ubWVtLm1lbV90eXBlID09IFRUTV9QTF9WUkFNKQorCQkoYm8tPnRiby5y
ZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0pCiAJCT8gJnFkZXYtPm1haW5fc2xvdCA6
ICZxZGV2LT5zdXJmYWNlc19zbG90OwogCi0gICAgICAgLyogVE9ETyAtIG5lZWQgdG8gaG9sZCBv
bmUgb2YgdGhlIGxvY2tzIHRvIHJlYWQgYm8tPnRiby5tZW0uc3RhcnQgKi8KKyAgICAgICAvKiBU
T0RPIC0gbmVlZCB0byBob2xkIG9uZSBvZiB0aGUgbG9ja3MgdG8gcmVhZCBiby0+dGJvLnJlc291
cmNlLT5zdGFydCAqLwogCi0JcmV0dXJuIHNsb3QtPmhpZ2hfYml0cyB8ICgoYm8tPnRiby5tZW0u
c3RhcnQgPDwgUEFHRV9TSElGVCkgKyBvZmZzZXQpOworCXJldHVybiBzbG90LT5oaWdoX2JpdHMg
fCAoKGJvLT50Ym8ucmVzb3VyY2UtPnN0YXJ0IDw8IFBBR0VfU0hJRlQpICsgb2Zmc2V0KTsKIH0K
IAogLyogcXhsX2Rpc3BsYXkuYyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3F4bC9x
eGxfb2JqZWN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF9vYmplY3QuYwppbmRleCA2ZTI2
ZDcwZjJmMDcuLmZiYjM2ZTNlODU2NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3F4bC9x
eGxfb2JqZWN0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3F4bC9xeGxfb2JqZWN0LmMKQEAgLTIx
MiwxNCArMjEyLDE0IEBAIHZvaWQgKnF4bF9ib19rbWFwX2F0b21pY19wYWdlKHN0cnVjdCBxeGxf
ZGV2aWNlICpxZGV2LAogCXN0cnVjdCBpb19tYXBwaW5nICptYXA7CiAJc3RydWN0IGRtYV9idWZf
bWFwIGJvX21hcDsKIAotCWlmIChiby0+dGJvLm1lbS5tZW1fdHlwZSA9PSBUVE1fUExfVlJBTSkK
KwlpZiAoYm8tPnRiby5yZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0pCiAJCW1hcCA9
IHFkZXYtPnZyYW1fbWFwcGluZzsKLQllbHNlIGlmIChiby0+dGJvLm1lbS5tZW1fdHlwZSA9PSBU
VE1fUExfUFJJVikKKwllbHNlIGlmIChiby0+dGJvLnJlc291cmNlLT5tZW1fdHlwZSA9PSBUVE1f
UExfUFJJVikKIAkJbWFwID0gcWRldi0+c3VyZmFjZV9tYXBwaW5nOwogCWVsc2UKIAkJZ290byBm
YWxsYmFjazsKIAotCW9mZnNldCA9IGJvLT50Ym8ubWVtLnN0YXJ0IDw8IFBBR0VfU0hJRlQ7CisJ
b2Zmc2V0ID0gYm8tPnRiby5yZXNvdXJjZS0+c3RhcnQgPDwgUEFHRV9TSElGVDsKIAlyZXR1cm4g
aW9fbWFwcGluZ19tYXBfYXRvbWljX3djKG1hcCwgb2Zmc2V0ICsgcGFnZV9vZmZzZXQpOwogZmFs
bGJhY2s6CiAJaWYgKGJvLT5rcHRyKSB7CkBAIC0yNjYsOCArMjY2LDggQEAgaW50IHF4bF9ib192
dW5tYXAoc3RydWN0IHF4bF9ibyAqYm8pCiB2b2lkIHF4bF9ib19rdW5tYXBfYXRvbWljX3BhZ2Uo
c3RydWN0IHF4bF9kZXZpY2UgKnFkZXYsCiAJCQkgICAgICAgc3RydWN0IHF4bF9ibyAqYm8sIHZv
aWQgKnBtYXApCiB7Ci0JaWYgKChiby0+dGJvLm1lbS5tZW1fdHlwZSAhPSBUVE1fUExfVlJBTSkg
JiYKLQkgICAgKGJvLT50Ym8ubWVtLm1lbV90eXBlICE9IFRUTV9QTF9QUklWKSkKKwlpZiAoKGJv
LT50Ym8ucmVzb3VyY2UtPm1lbV90eXBlICE9IFRUTV9QTF9WUkFNKSAmJgorCSAgICAoYm8tPnRi
by5yZXNvdXJjZS0+bWVtX3R5cGUgIT0gVFRNX1BMX1BSSVYpKQogCQlnb3RvIGZhbGxiYWNrOwog
CiAJaW9fbWFwcGluZ191bm1hcF9hdG9taWMocG1hcCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vcXhsL3F4bF90dG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9xeGwvcXhsX3R0bS5jCmluZGV4
IDQ3YWZlOTVkMDRhMS4uOGFhODdiOGVkYjljIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
cXhsL3F4bF90dG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF90dG0uYwpAQCAtMTMx
LDcgKzEzMSw3IEBAIHN0YXRpYyB2b2lkIHF4bF9ib19tb3ZlX25vdGlmeShzdHJ1Y3QgdHRtX2J1
ZmZlcl9vYmplY3QgKmJvLAogCXFibyA9IHRvX3F4bF9ibyhibyk7CiAJcWRldiA9IHRvX3F4bChx
Ym8tPnRiby5iYXNlLmRldik7CiAKLQlpZiAoYm8tPm1lbS5tZW1fdHlwZSA9PSBUVE1fUExfUFJJ
ViAmJiBxYm8tPnN1cmZhY2VfaWQpCisJaWYgKGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRN
X1BMX1BSSVYgJiYgcWJvLT5zdXJmYWNlX2lkKQogCQlxeGxfc3VyZmFjZV9ldmljdChxZGV2LCBx
Ym8sIG5ld19tZW0gPyB0cnVlIDogZmFsc2UpOwogfQogCkBAIC0xNDAsNyArMTQwLDcgQEAgc3Rh
dGljIGludCBxeGxfYm9fbW92ZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLCBib29sIGV2
aWN0LAogCQkgICAgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqbmV3X21lbSwKIAkJICAgICAgIHN0
cnVjdCB0dG1fcGxhY2UgKmhvcCkKIHsKLQlzdHJ1Y3QgdHRtX3Jlc291cmNlICpvbGRfbWVtID0g
JmJvLT5tZW07CisJc3RydWN0IHR0bV9yZXNvdXJjZSAqb2xkX21lbSA9IGJvLT5yZXNvdXJjZTsK
IAlpbnQgcmV0OwogCiAJcXhsX2JvX21vdmVfbm90aWZ5KGJvLCBuZXdfbWVtKTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX2NzLmMgYi9kcml2ZXJzL2dwdS9kcm0v
cmFkZW9uL3JhZGVvbl9jcy5jCmluZGV4IDA1OTQzMTY4OWMyZC4uNTFkYTg4MGE4NGEwIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9jcy5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9yYWRlb24vcmFkZW9uX2NzLmMKQEAgLTQwMCw4ICs0MDAsOCBAQCBzdGF0aWMgaW50
IGNtcF9zaXplX3NtYWxsZXJfZmlyc3Qodm9pZCAqcHJpdiwgc3RydWN0IGxpc3RfaGVhZCAqYSwK
IAlzdHJ1Y3QgcmFkZW9uX2JvX2xpc3QgKmxiID0gbGlzdF9lbnRyeShiLCBzdHJ1Y3QgcmFkZW9u
X2JvX2xpc3QsIHR2LmhlYWQpOwogCiAJLyogU29ydCBBIGJlZm9yZSBCIGlmIEEgaXMgc21hbGxl
ci4gKi8KLQlyZXR1cm4gKGludClsYS0+cm9iai0+dGJvLm1lbS5udW1fcGFnZXMgLQotCQkoaW50
KWxiLT5yb2JqLT50Ym8ubWVtLm51bV9wYWdlczsKKwlyZXR1cm4gKGludClsYS0+cm9iai0+dGJv
LnJlc291cmNlLT5udW1fcGFnZXMgLQorCQkoaW50KWxiLT5yb2JqLT50Ym8ucmVzb3VyY2UtPm51
bV9wYWdlczsKIH0KIAogLyoqCkBAIC01MTYsNyArNTE2LDcgQEAgc3RhdGljIGludCByYWRlb25f
Ym9fdm1fdXBkYXRlX3B0ZShzdHJ1Y3QgcmFkZW9uX2NzX3BhcnNlciAqcCwKIAl9CiAKIAlyID0g
cmFkZW9uX3ZtX2JvX3VwZGF0ZShyZGV2LCB2bS0+aWJfYm9fdmEsCi0JCQkJJnJkZXYtPnJpbmdf
dG1wX2JvLmJvLT50Ym8ubWVtKTsKKwkJCQlyZGV2LT5yaW5nX3RtcF9iby5iby0+dGJvLnJlc291
cmNlKTsKIAlpZiAocikKIAkJcmV0dXJuIHI7CiAKQEAgLTUzMCw3ICs1MzAsNyBAQCBzdGF0aWMg
aW50IHJhZGVvbl9ib192bV91cGRhdGVfcHRlKHN0cnVjdCByYWRlb25fY3NfcGFyc2VyICpwLAog
CQkJcmV0dXJuIC1FSU5WQUw7CiAJCX0KIAotCQlyID0gcmFkZW9uX3ZtX2JvX3VwZGF0ZShyZGV2
LCBib192YSwgJmJvLT50Ym8ubWVtKTsKKwkJciA9IHJhZGVvbl92bV9ib191cGRhdGUocmRldiwg
Ym9fdmEsIGJvLT50Ym8ucmVzb3VyY2UpOwogCQlpZiAocikKIAkJCXJldHVybiByOwogCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9nZW0uYyBiL2RyaXZlcnMvZ3B1
L2RybS9yYWRlb24vcmFkZW9uX2dlbS5jCmluZGV4IDA1ZWEyZjM5ZjYyNi4uMjI2YzE3NTA3MDlj
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9nZW0uYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9nZW0uYwpAQCAtNDgwLDcgKzQ4MCw3IEBAIGlu
dCByYWRlb25fZ2VtX2J1c3lfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0
YSwKIAllbHNlCiAJCXIgPSAwOwogCi0JY3VyX3BsYWNlbWVudCA9IFJFQURfT05DRShyb2JqLT50
Ym8ubWVtLm1lbV90eXBlKTsKKwljdXJfcGxhY2VtZW50ID0gUkVBRF9PTkNFKHJvYmotPnRiby5y
ZXNvdXJjZS0+bWVtX3R5cGUpOwogCWFyZ3MtPmRvbWFpbiA9IHJhZGVvbl9tZW1fdHlwZV90b19k
b21haW4oY3VyX3BsYWNlbWVudCk7CiAJZHJtX2dlbV9vYmplY3RfcHV0KGdvYmopOwogCXJldHVy
biByOwpAQCAtNTEwLDcgKzUxMCw3IEBAIGludCByYWRlb25fZ2VtX3dhaXRfaWRsZV9pb2N0bChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCQlyID0gcmV0OwogCiAJLyogRmx1
c2ggSERQIGNhY2hlIHZpYSBNTUlPIGlmIG5lY2Vzc2FyeSAqLwotCWN1cl9wbGFjZW1lbnQgPSBS
RUFEX09OQ0Uocm9iai0+dGJvLm1lbS5tZW1fdHlwZSk7CisJY3VyX3BsYWNlbWVudCA9IFJFQURf
T05DRShyb2JqLT50Ym8ucmVzb3VyY2UtPm1lbV90eXBlKTsKIAlpZiAocmRldi0+YXNpYy0+bW1p
b19oZHBfZmx1c2ggJiYKIAkgICAgcmFkZW9uX21lbV90eXBlX3RvX2RvbWFpbihjdXJfcGxhY2Vt
ZW50KSA9PSBSQURFT05fR0VNX0RPTUFJTl9WUkFNKQogCQlyb2JqLT5yZGV2LT5hc2ljLT5tbWlv
X2hkcF9mbHVzaChyZGV2KTsKQEAgLTU5NCw3ICs1OTQsNyBAQCBzdGF0aWMgdm9pZCByYWRlb25f
Z2VtX3ZhX3VwZGF0ZV92bShzdHJ1Y3QgcmFkZW9uX2RldmljZSAqcmRldiwKIAkJZ290byBlcnJv
cl9mcmVlOwogCiAJbGlzdF9mb3JfZWFjaF9lbnRyeShlbnRyeSwgJmxpc3QsIGhlYWQpIHsKLQkJ
ZG9tYWluID0gcmFkZW9uX21lbV90eXBlX3RvX2RvbWFpbihlbnRyeS0+Ym8tPm1lbS5tZW1fdHlw
ZSk7CisJCWRvbWFpbiA9IHJhZGVvbl9tZW1fdHlwZV90b19kb21haW4oZW50cnktPmJvLT5yZXNv
dXJjZS0+bWVtX3R5cGUpOwogCQkvKiBpZiBhbnl0aGluZyBpcyBzd2FwcGVkIG91dCBkb24ndCBz
d2FwIGl0IGluIGhlcmUsCiAJCSAgIGp1c3QgYWJvcnQgYW5kIHdhaXQgZm9yIHRoZSBuZXh0IENT
ICovCiAJCWlmIChkb21haW4gPT0gUkFERU9OX0dFTV9ET01BSU5fQ1BVKQpAQCAtNjA3LDcgKzYw
Nyw3IEBAIHN0YXRpYyB2b2lkIHJhZGVvbl9nZW1fdmFfdXBkYXRlX3ZtKHN0cnVjdCByYWRlb25f
ZGV2aWNlICpyZGV2LAogCQlnb3RvIGVycm9yX3VubG9jazsKIAogCWlmIChib192YS0+aXQuc3Rh
cnQpCi0JCXIgPSByYWRlb25fdm1fYm9fdXBkYXRlKHJkZXYsIGJvX3ZhLCAmYm9fdmEtPmJvLT50
Ym8ubWVtKTsKKwkJciA9IHJhZGVvbl92bV9ib191cGRhdGUocmRldiwgYm9fdmEsIGJvX3ZhLT5i
by0+dGJvLnJlc291cmNlKTsKIAogZXJyb3JfdW5sb2NrOgogCW11dGV4X3VubG9jaygmYm9fdmEt
PnZtLT5tdXRleCk7CkBAIC04MTEsNyArODExLDcgQEAgc3RhdGljIGludCByYWRlb25fZGVidWdm
c19nZW1faW5mb19zaG93KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogCQl1bnNp
Z25lZCBkb21haW47CiAJCWNvbnN0IGNoYXIgKnBsYWNlbWVudDsKIAotCQlkb21haW4gPSByYWRl
b25fbWVtX3R5cGVfdG9fZG9tYWluKHJiby0+dGJvLm1lbS5tZW1fdHlwZSk7CisJCWRvbWFpbiA9
IHJhZGVvbl9tZW1fdHlwZV90b19kb21haW4ocmJvLT50Ym8ucmVzb3VyY2UtPm1lbV90eXBlKTsK
IAkJc3dpdGNoIChkb21haW4pIHsKIAkJY2FzZSBSQURFT05fR0VNX0RPTUFJTl9WUkFNOgogCQkJ
cGxhY2VtZW50ID0gIlZSQU0iOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9y
YWRlb25fb2JqZWN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9vYmplY3QuYwpp
bmRleCBjZWUxMWM1NWZkMTUuLmJmYWFhM2M5NjlhMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL3JhZGVvbi9yYWRlb25fb2JqZWN0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9y
YWRlb25fb2JqZWN0LmMKQEAgLTc2LDcgKzc2LDcgQEAgc3RhdGljIHZvaWQgcmFkZW9uX3R0bV9i
b19kZXN0cm95KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqdGJvKQogCiAJYm8gPSBjb250YWlu
ZXJfb2YodGJvLCBzdHJ1Y3QgcmFkZW9uX2JvLCB0Ym8pOwogCi0JcmFkZW9uX3VwZGF0ZV9tZW1v
cnlfdXNhZ2UoYm8sIGJvLT50Ym8ubWVtLm1lbV90eXBlLCAtMSk7CisJcmFkZW9uX3VwZGF0ZV9t
ZW1vcnlfdXNhZ2UoYm8sIGJvLT50Ym8ucmVzb3VyY2UtPm1lbV90eXBlLCAtMSk7CiAKIAltdXRl
eF9sb2NrKCZiby0+cmRldi0+Z2VtLm11dGV4KTsKIAlsaXN0X2RlbF9pbml0KCZiby0+bGlzdCk7
CkBAIC0yNTAsNyArMjUwLDcgQEAgaW50IHJhZGVvbl9ib19rbWFwKHN0cnVjdCByYWRlb25fYm8g
KmJvLCB2b2lkICoqcHRyKQogCQl9CiAJCXJldHVybiAwOwogCX0KLQlyID0gdHRtX2JvX2ttYXAo
JmJvLT50Ym8sIDAsIGJvLT50Ym8ubWVtLm51bV9wYWdlcywgJmJvLT5rbWFwKTsKKwlyID0gdHRt
X2JvX2ttYXAoJmJvLT50Ym8sIDAsIGJvLT50Ym8ucmVzb3VyY2UtPm51bV9wYWdlcywgJmJvLT5r
bWFwKTsKIAlpZiAocikgewogCQlyZXR1cm4gcjsKIAl9CkBAIC0zNTksNyArMzU5LDcgQEAgdm9p
ZCByYWRlb25fYm9fdW5waW4oc3RydWN0IHJhZGVvbl9ibyAqYm8pCiB7CiAJdHRtX2JvX3VucGlu
KCZiby0+dGJvKTsKIAlpZiAoIWJvLT50Ym8ucGluX2NvdW50KSB7Ci0JCWlmIChiby0+dGJvLm1l
bS5tZW1fdHlwZSA9PSBUVE1fUExfVlJBTSkKKwkJaWYgKGJvLT50Ym8ucmVzb3VyY2UtPm1lbV90
eXBlID09IFRUTV9QTF9WUkFNKQogCQkJYm8tPnJkZXYtPnZyYW1fcGluX3NpemUgLT0gcmFkZW9u
X2JvX3NpemUoYm8pOwogCQllbHNlCiAJCQliby0+cmRldi0+Z2FydF9waW5fc2l6ZSAtPSByYWRl
b25fYm9fc2l6ZShibyk7CkBAIC01MDYsNyArNTA2LDcgQEAgaW50IHJhZGVvbl9ib19saXN0X3Zh
bGlkYXRlKHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2LAogCQkJdTMyIGRvbWFpbiA9IGxvYmot
PnByZWZlcnJlZF9kb21haW5zOwogCQkJdTMyIGFsbG93ZWQgPSBsb2JqLT5hbGxvd2VkX2RvbWFp
bnM7CiAJCQl1MzIgY3VycmVudF9kb21haW4gPQotCQkJCXJhZGVvbl9tZW1fdHlwZV90b19kb21h
aW4oYm8tPnRiby5tZW0ubWVtX3R5cGUpOworCQkJCXJhZGVvbl9tZW1fdHlwZV90b19kb21haW4o
Ym8tPnRiby5yZXNvdXJjZS0+bWVtX3R5cGUpOwogCiAJCQkvKiBDaGVjayBpZiB0aGlzIGJ1ZmZl
ciB3aWxsIGJlIG1vdmVkIGFuZCBkb24ndCBtb3ZlIGl0CiAJCQkgKiBpZiB3ZSBoYXZlIG1vdmVk
IHRvbyBtYW55IGJ1ZmZlcnMgZm9yIHRoaXMgSUIgYWxyZWFkeS4KQEAgLTYwNSw3ICs2MDUsNyBA
QCBpbnQgcmFkZW9uX2JvX2dldF9zdXJmYWNlX3JlZyhzdHJ1Y3QgcmFkZW9uX2JvICpibykKIAog
b3V0OgogCXJhZGVvbl9zZXRfc3VyZmFjZV9yZWcocmRldiwgaSwgYm8tPnRpbGluZ19mbGFncywg
Ym8tPnBpdGNoLAotCQkJICAgICAgIGJvLT50Ym8ubWVtLnN0YXJ0IDw8IFBBR0VfU0hJRlQsCisJ
CQkgICAgICAgYm8tPnRiby5yZXNvdXJjZS0+c3RhcnQgPDwgUEFHRV9TSElGVCwKIAkJCSAgICAg
ICBiby0+dGJvLmJhc2Uuc2l6ZSk7CiAJcmV0dXJuIDA7CiB9CkBAIC03MTEsNyArNzExLDcgQEAg
aW50IHJhZGVvbl9ib19jaGVja190aWxpbmcoc3RydWN0IHJhZGVvbl9ibyAqYm8sIGJvb2wgaGFz
X21vdmVkLAogCQlyZXR1cm4gMDsKIAl9CiAKLQlpZiAoYm8tPnRiby5tZW0ubWVtX3R5cGUgIT0g
VFRNX1BMX1ZSQU0pIHsKKwlpZiAoYm8tPnRiby5yZXNvdXJjZS0+bWVtX3R5cGUgIT0gVFRNX1BM
X1ZSQU0pIHsKIAkJaWYgKCFoYXNfbW92ZWQpCiAJCQlyZXR1cm4gMDsKIApAQCAtNzQzLDcgKzc0
Myw3IEBAIHZvaWQgcmFkZW9uX2JvX21vdmVfbm90aWZ5KHN0cnVjdCB0dG1fYnVmZmVyX29iamVj
dCAqYm8sCiAJaWYgKCFuZXdfbWVtKQogCQlyZXR1cm47CiAKLQlyYWRlb25fdXBkYXRlX21lbW9y
eV91c2FnZShyYm8sIGJvLT5tZW0ubWVtX3R5cGUsIC0xKTsKKwlyYWRlb25fdXBkYXRlX21lbW9y
eV91c2FnZShyYm8sIGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUsIC0xKTsKIAlyYWRlb25fdXBkYXRl
X21lbW9yeV91c2FnZShyYm8sIG5ld19tZW0tPm1lbV90eXBlLCAxKTsKIH0KIApAQCAtNzYwLDEx
ICs3NjAsMTEgQEAgdm1fZmF1bHRfdCByYWRlb25fYm9fZmF1bHRfcmVzZXJ2ZV9ub3RpZnkoc3Ry
dWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibykKIAlyYm8gPSBjb250YWluZXJfb2YoYm8sIHN0cnVj
dCByYWRlb25fYm8sIHRibyk7CiAJcmFkZW9uX2JvX2NoZWNrX3RpbGluZyhyYm8sIDAsIDApOwog
CXJkZXYgPSByYm8tPnJkZXY7Ci0JaWYgKGJvLT5tZW0ubWVtX3R5cGUgIT0gVFRNX1BMX1ZSQU0p
CisJaWYgKGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgIT0gVFRNX1BMX1ZSQU0pCiAJCXJldHVybiAw
OwogCi0Jc2l6ZSA9IGJvLT5tZW0ubnVtX3BhZ2VzIDw8IFBBR0VfU0hJRlQ7Ci0Jb2Zmc2V0ID0g
Ym8tPm1lbS5zdGFydCA8PCBQQUdFX1NISUZUOworCXNpemUgPSBiby0+cmVzb3VyY2UtPm51bV9w
YWdlcyA8PCBQQUdFX1NISUZUOworCW9mZnNldCA9IGJvLT5yZXNvdXJjZS0+c3RhcnQgPDwgUEFH
RV9TSElGVDsKIAlpZiAoKG9mZnNldCArIHNpemUpIDw9IHJkZXYtPm1jLnZpc2libGVfdnJhbV9z
aXplKQogCQlyZXR1cm4gMDsKIApAQCAtNzg2LDcgKzc4Niw3IEBAIHZtX2ZhdWx0X3QgcmFkZW9u
X2JvX2ZhdWx0X3Jlc2VydmVfbm90aWZ5KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8pCiAJ
CXJhZGVvbl90dG1fcGxhY2VtZW50X2Zyb21fZG9tYWluKHJibywgUkFERU9OX0dFTV9ET01BSU5f
R1RUKTsKIAkJciA9IHR0bV9ib192YWxpZGF0ZShibywgJnJiby0+cGxhY2VtZW50LCAmY3R4KTsK
IAl9IGVsc2UgaWYgKGxpa2VseSghcikpIHsKLQkJb2Zmc2V0ID0gYm8tPm1lbS5zdGFydCA8PCBQ
QUdFX1NISUZUOworCQlvZmZzZXQgPSBiby0+cmVzb3VyY2UtPnN0YXJ0IDw8IFBBR0VfU0hJRlQ7
CiAJCS8qIHRoaXMgc2hvdWxkIG5ldmVyIGhhcHBlbiAqLwogCQlpZiAoKG9mZnNldCArIHNpemUp
ID4gcmRldi0+bWMudmlzaWJsZV92cmFtX3NpemUpCiAJCQlyZXR1cm4gVk1fRkFVTFRfU0lHQlVT
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fb2JqZWN0LmggYi9k
cml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9vYmplY3QuaAppbmRleCBmZDQxMTZiZGRlMGYu
LjE3MzljNmExNDJjZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25f
b2JqZWN0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fb2JqZWN0LmgKQEAg
LTk1LDcgKzk1LDcgQEAgc3RhdGljIGlubGluZSB1NjQgcmFkZW9uX2JvX2dwdV9vZmZzZXQoc3Ry
dWN0IHJhZGVvbl9ibyAqYm8pCiAKIAlyZGV2ID0gcmFkZW9uX2dldF9yZGV2KGJvLT50Ym8uYmRl
dik7CiAKLQlzd2l0Y2ggKGJvLT50Ym8ubWVtLm1lbV90eXBlKSB7CisJc3dpdGNoIChiby0+dGJv
LnJlc291cmNlLT5tZW1fdHlwZSkgewogCWNhc2UgVFRNX1BMX1RUOgogCQlzdGFydCA9IHJkZXYt
Pm1jLmd0dF9zdGFydDsKIAkJYnJlYWs7CkBAIC0xMDQsNyArMTA0LDcgQEAgc3RhdGljIGlubGlu
ZSB1NjQgcmFkZW9uX2JvX2dwdV9vZmZzZXQoc3RydWN0IHJhZGVvbl9ibyAqYm8pCiAJCWJyZWFr
OwogCX0KIAotCXJldHVybiAoYm8tPnRiby5tZW0uc3RhcnQgPDwgUEFHRV9TSElGVCkgKyBzdGFy
dDsKKwlyZXR1cm4gKGJvLT50Ym8ucmVzb3VyY2UtPnN0YXJ0IDw8IFBBR0VfU0hJRlQpICsgc3Rh
cnQ7CiB9CiAKIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgbG9uZyByYWRlb25fYm9fc2l6ZShzdHJ1
Y3QgcmFkZW9uX2JvICpibykKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFk
ZW9uX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9wbS5jCmluZGV4IDBjMTk1
MGY0ZTE0Ni4uZWRkN2I5YjdjNmZmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9u
L3JhZGVvbl9wbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX3BtLmMKQEAg
LTE1NCw3ICsxNTQsNyBAQCBzdGF0aWMgdm9pZCByYWRlb25fdW5tYXBfdnJhbV9ib3Moc3RydWN0
IHJhZGVvbl9kZXZpY2UgKnJkZXYpCiAJCXJldHVybjsKIAogCWxpc3RfZm9yX2VhY2hfZW50cnlf
c2FmZShibywgbiwgJnJkZXYtPmdlbS5vYmplY3RzLCBsaXN0KSB7Ci0JCWlmIChiby0+dGJvLm1l
bS5tZW1fdHlwZSA9PSBUVE1fUExfVlJBTSkKKwkJaWYgKGJvLT50Ym8ucmVzb3VyY2UtPm1lbV90
eXBlID09IFRUTV9QTF9WUkFNKQogCQkJdHRtX2JvX3VubWFwX3ZpcnR1YWwoJmJvLT50Ym8pOwog
CX0KIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX3RyYWNlLmgg
Yi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl90cmFjZS5oCmluZGV4IDE3MjljYjlhOTVj
NS4uYzlmZWQ1ZjJiODcwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVv
bl90cmFjZS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX3RyYWNlLmgKQEAg
LTIyLDcgKzIyLDcgQEAgVFJBQ0VfRVZFTlQocmFkZW9uX2JvX2NyZWF0ZSwKIAogCSAgICBUUF9m
YXN0X2Fzc2lnbigKIAkJCSAgIF9fZW50cnktPmJvID0gYm87Ci0JCQkgICBfX2VudHJ5LT5wYWdl
cyA9IGJvLT50Ym8ubWVtLm51bV9wYWdlczsKKwkJCSAgIF9fZW50cnktPnBhZ2VzID0gYm8tPnRi
by5yZXNvdXJjZS0+bnVtX3BhZ2VzOwogCQkJICAgKSwKIAkgICAgVFBfcHJpbnRrKCJibz0lcCwg
cGFnZXM9JXUiLCBfX2VudHJ5LT5ibywgX19lbnRyeS0+cGFnZXMpCiApOwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fdHRtLmMgYi9kcml2ZXJzL2dwdS9kcm0vcmFk
ZW9uL3JhZGVvbl90dG0uYwppbmRleCAzODBiMzAwN2ZkMGIuLjQ3ODdiYzI4MTI4MSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fdHRtLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL3JhZGVvbi9yYWRlb25fdHRtLmMKQEAgLTk5LDEyICs5OSwxMiBAQCBzdGF0aWMgdm9p
ZCByYWRlb25fZXZpY3RfZmxhZ3Moc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAkJcmV0
dXJuOwogCX0KIAlyYm8gPSBjb250YWluZXJfb2YoYm8sIHN0cnVjdCByYWRlb25fYm8sIHRibyk7
Ci0Jc3dpdGNoIChiby0+bWVtLm1lbV90eXBlKSB7CisJc3dpdGNoIChiby0+cmVzb3VyY2UtPm1l
bV90eXBlKSB7CiAJY2FzZSBUVE1fUExfVlJBTToKIAkJaWYgKHJiby0+cmRldi0+cmluZ1tyYWRl
b25fY29weV9yaW5nX2luZGV4KHJiby0+cmRldildLnJlYWR5ID09IGZhbHNlKQogCQkJcmFkZW9u
X3R0bV9wbGFjZW1lbnRfZnJvbV9kb21haW4ocmJvLCBSQURFT05fR0VNX0RPTUFJTl9DUFUpOwog
CQllbHNlIGlmIChyYm8tPnJkZXYtPm1jLnZpc2libGVfdnJhbV9zaXplIDwgcmJvLT5yZGV2LT5t
Yy5yZWFsX3ZyYW1fc2l6ZSAmJgotCQkJIGJvLT5tZW0uc3RhcnQgPCAocmJvLT5yZGV2LT5tYy52
aXNpYmxlX3ZyYW1fc2l6ZSA+PiBQQUdFX1NISUZUKSkgeworCQkJIGJvLT5yZXNvdXJjZS0+c3Rh
cnQgPCAocmJvLT5yZGV2LT5tYy52aXNpYmxlX3ZyYW1fc2l6ZSA+PiBQQUdFX1NISUZUKSkgewog
CQkJdW5zaWduZWQgZnBmbiA9IHJiby0+cmRldi0+bWMudmlzaWJsZV92cmFtX3NpemUgPj4gUEFH
RV9TSElGVDsKIAkJCWludCBpOwogCkBAIC0yMDcsOSArMjA3LDkgQEAgc3RhdGljIGludCByYWRl
b25fYm9fbW92ZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLCBib29sIGV2aWN0LAogCQkJ
ICBzdHJ1Y3QgdHRtX3Jlc291cmNlICpuZXdfbWVtLAogCQkJICBzdHJ1Y3QgdHRtX3BsYWNlICpo
b3ApCiB7CisJc3RydWN0IHR0bV9yZXNvdXJjZSAqb2xkX21lbSA9IGJvLT5yZXNvdXJjZTsKIAlz
dHJ1Y3QgcmFkZW9uX2RldmljZSAqcmRldjsKIAlzdHJ1Y3QgcmFkZW9uX2JvICpyYm87Ci0Jc3Ry
dWN0IHR0bV9yZXNvdXJjZSAqb2xkX21lbSA9ICZiby0+bWVtOwogCWludCByOwogCiAJaWYgKG5l
d19tZW0tPm1lbV90eXBlID09IFRUTV9QTF9UVCkgewpAQCAtMjQxLDcgKzI0MSw3IEBAIHN0YXRp
YyBpbnQgcmFkZW9uX2JvX21vdmUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywgYm9vbCBl
dmljdCwKIAlpZiAob2xkX21lbS0+bWVtX3R5cGUgPT0gVFRNX1BMX1RUICYmCiAJICAgIG5ld19t
ZW0tPm1lbV90eXBlID09IFRUTV9QTF9TWVNURU0pIHsKIAkJcmFkZW9uX3R0bV90dF91bmJpbmQo
Ym8tPmJkZXYsIGJvLT50dG0pOwotCQl0dG1fcmVzb3VyY2VfZnJlZShibywgJmJvLT5tZW0pOwor
CQl0dG1fcmVzb3VyY2VfZnJlZShibywgYm8tPnJlc291cmNlKTsKIAkJdHRtX2JvX2Fzc2lnbl9t
ZW0oYm8sIG5ld19tZW0pOwogCQlnb3RvIG91dDsKIAl9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vdHRtL3R0bV9iby5jIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm8uYwppbmRleCBj
YTFiMDk4YjZhNTYuLmQ2Y2IyYjI4OWJhNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0
bS90dG1fYm8uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5jCkBAIC01OCw3ICs1
OCw3IEBAIHN0YXRpYyB2b2lkIHR0bV9ib19tZW1fc3BhY2VfZGVidWcoc3RydWN0IHR0bV9idWZm
ZXJfb2JqZWN0ICpibywKIAlpbnQgaSwgbWVtX3R5cGU7CiAKIAlkcm1fcHJpbnRmKCZwLCAiTm8g
c3BhY2UgZm9yICVwICglbHUgcGFnZXMsICV6dUssICV6dU0pXG4iLAotCQkgICBibywgYm8tPm1l
bS5udW1fcGFnZXMsIGJvLT5iYXNlLnNpemUgPj4gMTAsCisJCSAgIGJvLCBiby0+cmVzb3VyY2Ut
Pm51bV9wYWdlcywgYm8tPmJhc2Uuc2l6ZSA+PiAxMCwKIAkJICAgYm8tPmJhc2Uuc2l6ZSA+PiAy
MCk7CiAJZm9yIChpID0gMDsgaSA8IHBsYWNlbWVudC0+bnVtX3BsYWNlbWVudDsgaSsrKSB7CiAJ
CW1lbV90eXBlID0gcGxhY2VtZW50LT5wbGFjZW1lbnRbaV0ubWVtX3R5cGU7CkBAIC0xMDksNyAr
MTA5LDcgQEAgdm9pZCB0dG1fYm9fbW92ZV90b19scnVfdGFpbChzdHJ1Y3QgdHRtX2J1ZmZlcl9v
YmplY3QgKmJvLAogCQliZGV2LT5mdW5jcy0+ZGVsX2Zyb21fbHJ1X25vdGlmeShibyk7CiAKIAlp
ZiAoYnVsayAmJiAhYm8tPnBpbl9jb3VudCkgewotCQlzd2l0Y2ggKGJvLT5tZW0ubWVtX3R5cGUp
IHsKKwkJc3dpdGNoIChiby0+cmVzb3VyY2UtPm1lbV90eXBlKSB7CiAJCWNhc2UgVFRNX1BMX1RU
OgogCQkJdHRtX2JvX2J1bGtfbW92ZV9zZXRfcG9zKCZidWxrLT50dFtiby0+cHJpb3JpdHldLCBi
byk7CiAJCQlicmVhazsKQEAgLTE2MywxMSArMTYzLDEzIEBAIHN0YXRpYyBpbnQgdHRtX2JvX2hh
bmRsZV9tb3ZlX21lbShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQkJCSAgc3RydWN0
IHR0bV9vcGVyYXRpb25fY3R4ICpjdHgsCiAJCQkJICBzdHJ1Y3QgdHRtX3BsYWNlICpob3ApCiB7
CisJc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICpvbGRfbWFuLCAqbmV3X21hbjsKIAlzdHJ1
Y3QgdHRtX2RldmljZSAqYmRldiA9IGJvLT5iZGV2OwotCXN0cnVjdCB0dG1fcmVzb3VyY2VfbWFu
YWdlciAqb2xkX21hbiA9IHR0bV9tYW5hZ2VyX3R5cGUoYmRldiwgYm8tPm1lbS5tZW1fdHlwZSk7
Ci0Jc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICpuZXdfbWFuID0gdHRtX21hbmFnZXJfdHlw
ZShiZGV2LCBtZW0tPm1lbV90eXBlKTsKIAlpbnQgcmV0OwogCisJb2xkX21hbiA9IHR0bV9tYW5h
Z2VyX3R5cGUoYmRldiwgYm8tPnJlc291cmNlLT5tZW1fdHlwZSk7CisJbmV3X21hbiA9IHR0bV9t
YW5hZ2VyX3R5cGUoYmRldiwgbWVtLT5tZW1fdHlwZSk7CisKIAl0dG1fYm9fdW5tYXBfdmlydHVh
bChibyk7CiAKIAkvKgpAQCAtMjAwLDcgKzIwMiw3IEBAIHN0YXRpYyBpbnQgdHRtX2JvX2hhbmRs
ZV9tb3ZlX21lbShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCXJldHVybiAwOwogCiBv
dXRfZXJyOgotCW5ld19tYW4gPSB0dG1fbWFuYWdlcl90eXBlKGJkZXYsIGJvLT5tZW0ubWVtX3R5
cGUpOworCW5ld19tYW4gPSB0dG1fbWFuYWdlcl90eXBlKGJkZXYsIGJvLT5yZXNvdXJjZS0+bWVt
X3R5cGUpOwogCWlmICghbmV3X21hbi0+dXNlX3R0KQogCQl0dG1fYm9fdHRfZGVzdHJveShibyk7
CiAKQEAgLTIyMSw3ICsyMjMsNyBAQCBzdGF0aWMgdm9pZCB0dG1fYm9fY2xlYW51cF9tZW10eXBl
X3VzZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvKQogCQliby0+YmRldi0+ZnVuY3MtPmRl
bGV0ZV9tZW1fbm90aWZ5KGJvKTsKIAogCXR0bV9ib190dF9kZXN0cm95KGJvKTsKLQl0dG1fcmVz
b3VyY2VfZnJlZShibywgJmJvLT5tZW0pOworCXR0bV9yZXNvdXJjZV9mcmVlKGJvLCBiby0+cmVz
b3VyY2UpOwogfQogCiBzdGF0aWMgaW50IHR0bV9ib19pbmRpdmlkdWFsaXplX3Jlc3Yoc3RydWN0
IHR0bV9idWZmZXJfb2JqZWN0ICpibykKQEAgLTQxNyw3ICs0MTksNyBAQCBzdGF0aWMgdm9pZCB0
dG1fYm9fcmVsZWFzZShzdHJ1Y3Qga3JlZiAqa3JlZikKIAkJCWJvLT5iZGV2LT5mdW5jcy0+cmVs
ZWFzZV9ub3RpZnkoYm8pOwogCiAJCWRybV92bWFfb2Zmc2V0X3JlbW92ZShiZGV2LT52bWFfbWFu
YWdlciwgJmJvLT5iYXNlLnZtYV9ub2RlKTsKLQkJdHRtX21lbV9pb19mcmVlKGJkZXYsICZiby0+
bWVtKTsKKwkJdHRtX21lbV9pb19mcmVlKGJkZXYsIGJvLT5yZXNvdXJjZSk7CiAJfQogCiAJaWYg
KCFkbWFfcmVzdl90ZXN0X3NpZ25hbGVkX3JjdShiby0+YmFzZS5yZXN2LCB0cnVlKSB8fApAQCAt
NDM4LDcgKzQ0MCw3IEBAIHN0YXRpYyB2b2lkIHR0bV9ib19yZWxlYXNlKHN0cnVjdCBrcmVmICpr
cmVmKQogCQkgKi8KIAkJaWYgKGJvLT5waW5fY291bnQpIHsKIAkJCWJvLT5waW5fY291bnQgPSAw
OwotCQkJdHRtX2JvX21vdmVfdG9fbHJ1X3RhaWwoYm8sICZiby0+bWVtLCBOVUxMKTsKKwkJCXR0
bV9ib19tb3ZlX3RvX2xydV90YWlsKGJvLCBiby0+cmVzb3VyY2UsIE5VTEwpOwogCQl9CiAKIAkJ
a3JlZl9pbml0KCZiby0+a3JlZik7CkBAIC01MzQsOCArNTM2LDggQEAgYm9vbCB0dG1fYm9fZXZp
Y3Rpb25fdmFsdWFibGUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAkvKiBEb24ndCBl
dmljdCB0aGlzIEJPIGlmIGl0J3Mgb3V0c2lkZSBvZiB0aGUKIAkgKiByZXF1ZXN0ZWQgcGxhY2Vt
ZW50IHJhbmdlCiAJICovCi0JaWYgKHBsYWNlLT5mcGZuID49IChiby0+bWVtLnN0YXJ0ICsgYm8t
Pm1lbS5udW1fcGFnZXMpIHx8Ci0JICAgIChwbGFjZS0+bHBmbiAmJiBwbGFjZS0+bHBmbiA8PSBi
by0+bWVtLnN0YXJ0KSkKKwlpZiAocGxhY2UtPmZwZm4gPj0gKGJvLT5yZXNvdXJjZS0+c3RhcnQg
KyBiby0+cmVzb3VyY2UtPm51bV9wYWdlcykgfHwKKwkgICAgKHBsYWNlLT5scGZuICYmIHBsYWNl
LT5scGZuIDw9IGJvLT5yZXNvdXJjZS0+c3RhcnQpKQogCQlyZXR1cm4gZmFsc2U7CiAKIAlyZXR1
cm4gdHJ1ZTsKQEAgLTg0OSw3ICs4NTEsNyBAQCBpbnQgdHRtX2JvX21lbV9zcGFjZShzdHJ1Y3Qg
dHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCX0KIAogZXJyb3I6Ci0JaWYgKGJvLT5tZW0ubWVtX3R5
cGUgPT0gVFRNX1BMX1NZU1RFTSAmJiAhYm8tPnBpbl9jb3VudCkKKwlpZiAoYm8tPnJlc291cmNl
LT5tZW1fdHlwZSA9PSBUVE1fUExfU1lTVEVNICYmICFiby0+cGluX2NvdW50KQogCQl0dG1fYm9f
bW92ZV90b19scnVfdGFpbF91bmxvY2tlZChibyk7CiAKIAlyZXR1cm4gcmV0OwpAQCAtOTg1LDcg
Kzk4Nyw3IEBAIGludCB0dG1fYm9fdmFsaWRhdGUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpi
bywKIAkvKgogCSAqIENoZWNrIHdoZXRoZXIgd2UgbmVlZCB0byBtb3ZlIGJ1ZmZlci4KIAkgKi8K
LQlpZiAoIXR0bV9ib19tZW1fY29tcGF0KHBsYWNlbWVudCwgJmJvLT5tZW0sICZuZXdfZmxhZ3Mp
KSB7CisJaWYgKCF0dG1fYm9fbWVtX2NvbXBhdChwbGFjZW1lbnQsIGJvLT5yZXNvdXJjZSwgJm5l
d19mbGFncykpIHsKIAkJcmV0ID0gdHRtX2JvX21vdmVfYnVmZmVyKGJvLCBwbGFjZW1lbnQsIGN0
eCk7CiAJCWlmIChyZXQpCiAJCQlyZXR1cm4gcmV0OwpAQCAtOTkzLDcgKzk5NSw3IEBAIGludCB0
dG1fYm9fdmFsaWRhdGUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAkvKgogCSAqIFdl
IG1pZ2h0IG5lZWQgdG8gYWRkIGEgVFRNLgogCSAqLwotCWlmIChiby0+bWVtLm1lbV90eXBlID09
IFRUTV9QTF9TWVNURU0pIHsKKwlpZiAoYm8tPnJlc291cmNlLT5tZW1fdHlwZSA9PSBUVE1fUExf
U1lTVEVNKSB7CiAJCXJldCA9IHR0bV90dF9jcmVhdGUoYm8sIHRydWUpOwogCQlpZiAocmV0KQog
CQkJcmV0dXJuIHJldDsKQEAgLTEwMjUsNyArMTAyNyw4IEBAIGludCB0dG1fYm9faW5pdF9yZXNl
cnZlZChzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwKIAliby0+YmRldiA9IGJkZXY7CiAJYm8tPnR5
cGUgPSB0eXBlOwogCWJvLT5wYWdlX2FsaWdubWVudCA9IHBhZ2VfYWxpZ25tZW50OwotCXR0bV9y
ZXNvdXJjZV9hbGxvYyhibywgJnN5c19tZW0sICZiby0+bWVtKTsKKwliby0+cmVzb3VyY2UgPSAm
Ym8tPl9tZW07CisJdHRtX3Jlc291cmNlX2FsbG9jKGJvLCAmc3lzX21lbSwgYm8tPnJlc291cmNl
KTsKIAliby0+bW92aW5nID0gTlVMTDsKIAliby0+cGluX2NvdW50ID0gMDsKIAliby0+c2cgPSBz
ZzsKQEAgLTEwNDQsNyArMTA0Nyw3IEBAIGludCB0dG1fYm9faW5pdF9yZXNlcnZlZChzdHJ1Y3Qg
dHRtX2RldmljZSAqYmRldiwKIAlpZiAoYm8tPnR5cGUgPT0gdHRtX2JvX3R5cGVfZGV2aWNlIHx8
CiAJICAgIGJvLT50eXBlID09IHR0bV9ib190eXBlX3NnKQogCQlyZXQgPSBkcm1fdm1hX29mZnNl
dF9hZGQoYmRldi0+dm1hX21hbmFnZXIsICZiby0+YmFzZS52bWFfbm9kZSwKLQkJCQkJIGJvLT5t
ZW0ubnVtX3BhZ2VzKTsKKwkJCQkJIGJvLT5yZXNvdXJjZS0+bnVtX3BhZ2VzKTsKIAogCS8qIHBh
c3NlZCByZXNlcnZhdGlvbiBvYmplY3RzIHNob3VsZCBhbHJlYWR5IGJlIGxvY2tlZCwKIAkgKiBz
aW5jZSBvdGhlcndpc2UgbG9ja2RlcCB3aWxsIGJlIGFuZ2VyZWQgaW4gcmFkZW9uLgpAQCAtMTEw
Niw3ICsxMTA5LDcgQEAgdm9pZCB0dG1fYm9fdW5tYXBfdmlydHVhbChzdHJ1Y3QgdHRtX2J1ZmZl
cl9vYmplY3QgKmJvKQogCXN0cnVjdCB0dG1fZGV2aWNlICpiZGV2ID0gYm8tPmJkZXY7CiAKIAlk
cm1fdm1hX25vZGVfdW5tYXAoJmJvLT5iYXNlLnZtYV9ub2RlLCBiZGV2LT5kZXZfbWFwcGluZyk7
Ci0JdHRtX21lbV9pb19mcmVlKGJkZXYsICZiby0+bWVtKTsKKwl0dG1fbWVtX2lvX2ZyZWUoYmRl
diwgYm8tPnJlc291cmNlKTsKIH0KIEVYUE9SVF9TWU1CT0wodHRtX2JvX3VubWFwX3ZpcnR1YWwp
OwogCkBAIC0xMTYzLDcgKzExNjYsNyBAQCBpbnQgdHRtX2JvX3N3YXBvdXQoc3RydWN0IHR0bV9i
dWZmZXJfb2JqZWN0ICpibywgc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4ICpjdHgsCiAJLyoKIAkg
KiBNb3ZlIHRvIHN5c3RlbSBjYWNoZWQKIAkgKi8KLQlpZiAoYm8tPm1lbS5tZW1fdHlwZSAhPSBU
VE1fUExfU1lTVEVNKSB7CisJaWYgKGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgIT0gVFRNX1BMX1NZ
U1RFTSkgewogCQlzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHggY3R4ID0geyBmYWxzZSwgZmFsc2Ug
fTsKIAkJc3RydWN0IHR0bV9yZXNvdXJjZSBldmljdF9tZW07CiAJCXN0cnVjdCB0dG1fcGxhY2Ug
cGxhY2UsIGhvcDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3V0aWwu
YyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3V0aWwuYwppbmRleCBhZThiNjE0NjA3MjQu
LmFlZGYwMmEzMWM3MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm9fdXRp
bC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3V0aWwuYwpAQCAtMTc5LDcgKzE3
OSw3IEBAIGludCB0dG1fYm9fbW92ZV9tZW1jcHkoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpi
bywKIAlzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiA9IGJvLT5iZGV2OwogCXN0cnVjdCB0dG1fcmVz
b3VyY2VfbWFuYWdlciAqbWFuID0gdHRtX21hbmFnZXJfdHlwZShiZGV2LCBuZXdfbWVtLT5tZW1f
dHlwZSk7CiAJc3RydWN0IHR0bV90dCAqdHRtID0gYm8tPnR0bTsKLQlzdHJ1Y3QgdHRtX3Jlc291
cmNlICpvbGRfbWVtID0gJmJvLT5tZW07CisJc3RydWN0IHR0bV9yZXNvdXJjZSAqb2xkX21lbSA9
IGJvLT5yZXNvdXJjZTsKIAlzdHJ1Y3QgdHRtX3Jlc291cmNlIG9sZF9jb3B5ID0gKm9sZF9tZW07
CiAJdm9pZCAqb2xkX2lvbWFwOwogCXZvaWQgKm5ld19pb21hcDsKQEAgLTM2NSwyNCArMzY1LDIz
IEBAIHN0YXRpYyBpbnQgdHRtX2JvX2lvcmVtYXAoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpi
bywKIAkJCSAgdW5zaWduZWQgbG9uZyBzaXplLAogCQkJICBzdHJ1Y3QgdHRtX2JvX2ttYXBfb2Jq
ICptYXApCiB7Ci0Jc3RydWN0IHR0bV9yZXNvdXJjZSAqbWVtID0gJmJvLT5tZW07CisJc3RydWN0
IHR0bV9yZXNvdXJjZSAqbWVtID0gYm8tPnJlc291cmNlOwogCi0JaWYgKGJvLT5tZW0uYnVzLmFk
ZHIpIHsKKwlpZiAoYm8tPnJlc291cmNlLT5idXMuYWRkcikgewogCQltYXAtPmJvX2ttYXBfdHlw
ZSA9IHR0bV9ib19tYXBfcHJlbWFwcGVkOwotCQltYXAtPnZpcnR1YWwgPSAodm9pZCAqKSgoKHU4
ICopYm8tPm1lbS5idXMuYWRkcikgKyBvZmZzZXQpOworCQltYXAtPnZpcnR1YWwgPSAoKHU4ICop
Ym8tPnJlc291cmNlLT5idXMuYWRkcikgKyBvZmZzZXQ7CiAJfSBlbHNlIHsKKwkJcmVzb3VyY2Vf
c2l6ZV90IHJlcyA9IGJvLT5yZXNvdXJjZS0+YnVzLm9mZnNldCArIG9mZnNldDsKKwogCQltYXAt
PmJvX2ttYXBfdHlwZSA9IHR0bV9ib19tYXBfaW9tYXA7CiAJCWlmIChtZW0tPmJ1cy5jYWNoaW5n
ID09IHR0bV93cml0ZV9jb21iaW5lZCkKLQkJCW1hcC0+dmlydHVhbCA9IGlvcmVtYXBfd2MoYm8t
Pm1lbS5idXMub2Zmc2V0ICsgb2Zmc2V0LAotCQkJCQkJICBzaXplKTsKKwkJCW1hcC0+dmlydHVh
bCA9IGlvcmVtYXBfd2MocmVzLCBzaXplKTsKICNpZmRlZiBDT05GSUdfWDg2CiAJCWVsc2UgaWYg
KG1lbS0+YnVzLmNhY2hpbmcgPT0gdHRtX2NhY2hlZCkKLQkJCW1hcC0+dmlydHVhbCA9IGlvcmVt
YXBfY2FjaGUoYm8tPm1lbS5idXMub2Zmc2V0ICsgb2Zmc2V0LAotCQkJCQkJICBzaXplKTsKKwkJ
CW1hcC0+dmlydHVhbCA9IGlvcmVtYXBfY2FjaGUocmVzLCBzaXplKTsKICNlbmRpZgogCQllbHNl
Ci0JCQltYXAtPnZpcnR1YWwgPSBpb3JlbWFwKGJvLT5tZW0uYnVzLm9mZnNldCArIG9mZnNldCwK
LQkJCQkJICAgICAgIHNpemUpOworCQkJbWFwLT52aXJ0dWFsID0gaW9yZW1hcChyZXMsIHNpemUp
OwogCX0KIAlyZXR1cm4gKCFtYXAtPnZpcnR1YWwpID8gLUVOT01FTSA6IDA7CiB9CkBAIC0zOTIs
NyArMzkxLDcgQEAgc3RhdGljIGludCB0dG1fYm9fa21hcF90dG0oc3RydWN0IHR0bV9idWZmZXJf
b2JqZWN0ICpibywKIAkJCSAgIHVuc2lnbmVkIGxvbmcgbnVtX3BhZ2VzLAogCQkJICAgc3RydWN0
IHR0bV9ib19rbWFwX29iaiAqbWFwKQogewotCXN0cnVjdCB0dG1fcmVzb3VyY2UgKm1lbSA9ICZi
by0+bWVtOworCXN0cnVjdCB0dG1fcmVzb3VyY2UgKm1lbSA9IGJvLT5yZXNvdXJjZTsKIAlzdHJ1
Y3QgdHRtX29wZXJhdGlvbl9jdHggY3R4ID0gewogCQkuaW50ZXJydXB0aWJsZSA9IGZhbHNlLAog
CQkubm9fd2FpdF9ncHUgPSBmYWxzZQpAQCAtNDM4LDE1ICs0MzcsMTUgQEAgaW50IHR0bV9ib19r
bWFwKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAKIAltYXAtPnZpcnR1YWwgPSBOVUxM
OwogCW1hcC0+Ym8gPSBibzsKLQlpZiAobnVtX3BhZ2VzID4gYm8tPm1lbS5udW1fcGFnZXMpCisJ
aWYgKG51bV9wYWdlcyA+IGJvLT5yZXNvdXJjZS0+bnVtX3BhZ2VzKQogCQlyZXR1cm4gLUVJTlZB
TDsKLQlpZiAoKHN0YXJ0X3BhZ2UgKyBudW1fcGFnZXMpID4gYm8tPm1lbS5udW1fcGFnZXMpCisJ
aWYgKChzdGFydF9wYWdlICsgbnVtX3BhZ2VzKSA+IGJvLT5yZXNvdXJjZS0+bnVtX3BhZ2VzKQog
CQlyZXR1cm4gLUVJTlZBTDsKIAotCXJldCA9IHR0bV9tZW1faW9fcmVzZXJ2ZShiby0+YmRldiwg
JmJvLT5tZW0pOworCXJldCA9IHR0bV9tZW1faW9fcmVzZXJ2ZShiby0+YmRldiwgYm8tPnJlc291
cmNlKTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwotCWlmICghYm8tPm1lbS5idXMuaXNfaW9t
ZW0pIHsKKwlpZiAoIWJvLT5yZXNvdXJjZS0+YnVzLmlzX2lvbWVtKSB7CiAJCXJldHVybiB0dG1f
Ym9fa21hcF90dG0oYm8sIHN0YXJ0X3BhZ2UsIG51bV9wYWdlcywgbWFwKTsKIAl9IGVsc2Ugewog
CQlvZmZzZXQgPSBzdGFydF9wYWdlIDw8IFBBR0VfU0hJRlQ7CkBAIC00NzUsNyArNDc0LDcgQEAg
dm9pZCB0dG1fYm9fa3VubWFwKHN0cnVjdCB0dG1fYm9fa21hcF9vYmogKm1hcCkKIAlkZWZhdWx0
OgogCQlCVUcoKTsKIAl9Ci0JdHRtX21lbV9pb19mcmVlKG1hcC0+Ym8tPmJkZXYsICZtYXAtPmJv
LT5tZW0pOworCXR0bV9tZW1faW9fZnJlZShtYXAtPmJvLT5iZGV2LCBtYXAtPmJvLT5yZXNvdXJj
ZSk7CiAJbWFwLT52aXJ0dWFsID0gTlVMTDsKIAltYXAtPnBhZ2UgPSBOVUxMOwogfQpAQCAtNDgz
LDcgKzQ4Miw3IEBAIEVYUE9SVF9TWU1CT0wodHRtX2JvX2t1bm1hcCk7CiAKIGludCB0dG1fYm9f
dm1hcChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLCBzdHJ1Y3QgZG1hX2J1Zl9tYXAgKm1h
cCkKIHsKLQlzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0gPSAmYm8tPm1lbTsKKwlzdHJ1Y3QgdHRt
X3Jlc291cmNlICptZW0gPSBiby0+cmVzb3VyY2U7CiAJaW50IHJldDsKIAogCXJldCA9IHR0bV9t
ZW1faW9fcmVzZXJ2ZShiby0+YmRldiwgbWVtKTsKQEAgLTU0Miw3ICs1NDEsNyBAQCBFWFBPUlRf
U1lNQk9MKHR0bV9ib192bWFwKTsKIAogdm9pZCB0dG1fYm9fdnVubWFwKHN0cnVjdCB0dG1fYnVm
ZmVyX29iamVjdCAqYm8sIHN0cnVjdCBkbWFfYnVmX21hcCAqbWFwKQogewotCXN0cnVjdCB0dG1f
cmVzb3VyY2UgKm1lbSA9ICZiby0+bWVtOworCXN0cnVjdCB0dG1fcmVzb3VyY2UgKm1lbSA9IGJv
LT5yZXNvdXJjZTsKIAogCWlmIChkbWFfYnVmX21hcF9pc19udWxsKG1hcCkpCiAJCXJldHVybjsK
QEAgLTU1Myw3ICs1NTIsNyBAQCB2b2lkIHR0bV9ib192dW5tYXAoc3RydWN0IHR0bV9idWZmZXJf
b2JqZWN0ICpibywgc3RydWN0IGRtYV9idWZfbWFwICptYXApCiAJCWlvdW5tYXAobWFwLT52YWRk
cl9pb21lbSk7CiAJZG1hX2J1Zl9tYXBfY2xlYXIobWFwKTsKIAotCXR0bV9tZW1faW9fZnJlZShi
by0+YmRldiwgJmJvLT5tZW0pOworCXR0bV9tZW1faW9fZnJlZShiby0+YmRldiwgYm8tPnJlc291
cmNlKTsKIH0KIEVYUE9SVF9TWU1CT0wodHRtX2JvX3Z1bm1hcCk7CiAKQEAgLTU2Nyw3ICs1NjYs
NyBAQCBzdGF0aWMgaW50IHR0bV9ib193YWl0X2ZyZWVfbm9kZShzdHJ1Y3QgdHRtX2J1ZmZlcl9v
YmplY3QgKmJvLAogCiAJaWYgKCFkc3RfdXNlX3R0KQogCQl0dG1fYm9fdHRfZGVzdHJveShibyk7
Ci0JdHRtX3Jlc291cmNlX2ZyZWUoYm8sICZiby0+bWVtKTsKKwl0dG1fcmVzb3VyY2VfZnJlZShi
bywgYm8tPnJlc291cmNlKTsKIAlyZXR1cm4gMDsKIH0KIApAQCAtNjE1LDcgKzYxNCw5IEBAIHN0
YXRpYyB2b2lkIHR0bV9ib19tb3ZlX3BpcGVsaW5lX2V2aWN0KHN0cnVjdCB0dG1fYnVmZmVyX29i
amVjdCAqYm8sCiAJCQkJICAgICAgIHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlKQogewogCXN0cnVj
dCB0dG1fZGV2aWNlICpiZGV2ID0gYm8tPmJkZXY7Ci0Jc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5h
Z2VyICpmcm9tID0gdHRtX21hbmFnZXJfdHlwZShiZGV2LCBiby0+bWVtLm1lbV90eXBlKTsKKwlz
dHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKmZyb207CisKKwlmcm9tID0gdHRtX21hbmFnZXJf
dHlwZShiZGV2LCBiby0+cmVzb3VyY2UtPm1lbV90eXBlKTsKIAogCS8qKgogCSAqIEJPIGRvZXNu
J3QgaGF2ZSBhIFRUTSB3ZSBuZWVkIHRvIGJpbmQvdW5iaW5kLiBKdXN0IHJlbWVtYmVyCkBAIC02
MjgsNyArNjI5LDcgQEAgc3RhdGljIHZvaWQgdHRtX2JvX21vdmVfcGlwZWxpbmVfZXZpY3Qoc3Ry
dWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAl9CiAJc3Bpbl91bmxvY2soJmZyb20tPm1vdmVf
bG9jayk7CiAKLQl0dG1fcmVzb3VyY2VfZnJlZShibywgJmJvLT5tZW0pOworCXR0bV9yZXNvdXJj
ZV9mcmVlKGJvLCBiby0+cmVzb3VyY2UpOwogCiAJZG1hX2ZlbmNlX3B1dChiby0+bW92aW5nKTsK
IAliby0+bW92aW5nID0gZG1hX2ZlbmNlX2dldChmZW5jZSk7CkBAIC02NDEsNyArNjQyLDcgQEAg
aW50IHR0bV9ib19tb3ZlX2FjY2VsX2NsZWFudXAoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpi
bywKIAkJCSAgICAgIHN0cnVjdCB0dG1fcmVzb3VyY2UgKm5ld19tZW0pCiB7CiAJc3RydWN0IHR0
bV9kZXZpY2UgKmJkZXYgPSBiby0+YmRldjsKLQlzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIg
KmZyb20gPSB0dG1fbWFuYWdlcl90eXBlKGJkZXYsIGJvLT5tZW0ubWVtX3R5cGUpOworCXN0cnVj
dCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqZnJvbSA9IHR0bV9tYW5hZ2VyX3R5cGUoYmRldiwgYm8t
PnJlc291cmNlLT5tZW1fdHlwZSk7CiAJc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYW4g
PSB0dG1fbWFuYWdlcl90eXBlKGJkZXYsIG5ld19tZW0tPm1lbV90eXBlKTsKIAlpbnQgcmV0ID0g
MDsKIApAQCAtNjc3LDcgKzY3OCw3IEBAIGludCB0dG1fYm9fcGlwZWxpbmVfZ3V0dGluZyhzdHJ1
Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvKQogCWlmIChyZXQpCiAJCXR0bV9ib193YWl0KGJvLCBm
YWxzZSwgZmFsc2UpOwogCi0JdHRtX3Jlc291cmNlX2FsbG9jKGJvLCAmc3lzX21lbSwgJmJvLT5t
ZW0pOworCXR0bV9yZXNvdXJjZV9hbGxvYyhibywgJnN5c19tZW0sIGJvLT5yZXNvdXJjZSk7CiAJ
Ym8tPnR0bSA9IE5VTEw7CiAKIAlkbWFfcmVzdl91bmxvY2soJmdob3N0LT5iYXNlLl9yZXN2KTsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3ZtLmMgYi9kcml2ZXJzL2dw
dS9kcm0vdHRtL3R0bV9ib192bS5jCmluZGV4IGIzMWIxODA1ODk2NS4uZTNmMTY4MzIxZDJmIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib192bS5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS90dG0vdHRtX2JvX3ZtLmMKQEAgLTEwMCw3ICsxMDAsNyBAQCBzdGF0aWMgdW5zaWdu
ZWQgbG9uZyB0dG1fYm9faW9fbWVtX3BmbihzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAog
CWlmIChiZGV2LT5mdW5jcy0+aW9fbWVtX3BmbikKIAkJcmV0dXJuIGJkZXYtPmZ1bmNzLT5pb19t
ZW1fcGZuKGJvLCBwYWdlX29mZnNldCk7CiAKLQlyZXR1cm4gKGJvLT5tZW0uYnVzLm9mZnNldCA+
PiBQQUdFX1NISUZUKSArIHBhZ2Vfb2Zmc2V0OworCXJldHVybiAoYm8tPnJlc291cmNlLT5idXMu
b2Zmc2V0ID4+IFBBR0VfU0hJRlQpICsgcGFnZV9vZmZzZXQ7CiB9CiAKIC8qKgpAQCAtMTk4LDEw
ICsxOTgsMTAgQEAgc3RhdGljIHZtX2ZhdWx0X3QgdHRtX2JvX3ZtX2luc2VydF9odWdlKHN0cnVj
dCB2bV9mYXVsdCAqdm1mLAogCiAJLyogRmF1bHQgc2hvdWxkIG5vdCBjcm9zcyBibyBib3VuZGFy
eS4gKi8KIAlwYWdlX29mZnNldCAmPSB+KGZhdWx0X3BhZ2Vfc2l6ZSAtIDEpOwotCWlmIChwYWdl
X29mZnNldCArIGZhdWx0X3BhZ2Vfc2l6ZSA+IGJvLT5tZW0ubnVtX3BhZ2VzKQorCWlmIChwYWdl
X29mZnNldCArIGZhdWx0X3BhZ2Vfc2l6ZSA+IGJvLT5yZXNvdXJjZS0+bnVtX3BhZ2VzKQogCQln
b3RvIG91dF9mYWxsYmFjazsKIAotCWlmIChiby0+bWVtLmJ1cy5pc19pb21lbSkKKwlpZiAoYm8t
PnJlc291cmNlLT5idXMuaXNfaW9tZW0pCiAJCXBmbiA9IHR0bV9ib19pb19tZW1fcGZuKGJvLCBw
YWdlX29mZnNldCk7CiAJZWxzZQogCQlwZm4gPSBwYWdlX3RvX3Bmbih0dG0tPnBhZ2VzW3BhZ2Vf
b2Zmc2V0XSk7CkBAIC0yMTEsNyArMjExLDcgQEAgc3RhdGljIHZtX2ZhdWx0X3QgdHRtX2JvX3Zt
X2luc2VydF9odWdlKHN0cnVjdCB2bV9mYXVsdCAqdm1mLAogCQlnb3RvIG91dF9mYWxsYmFjazsK
IAogCS8qIENoZWNrIHRoYXQgbWVtb3J5IGlzIGNvbnRpZ3VvdXMuICovCi0JaWYgKCFiby0+bWVt
LmJ1cy5pc19pb21lbSkgeworCWlmICghYm8tPnJlc291cmNlLT5idXMuaXNfaW9tZW0pIHsKIAkJ
Zm9yIChpID0gMTsgaSA8IGZhdWx0X3BhZ2Vfc2l6ZTsgKytpKSB7CiAJCQlpZiAocGFnZV90b19w
Zm4odHRtLT5wYWdlc1twYWdlX29mZnNldCArIGldKSAhPSBwZm4gKyBpKQogCQkJCWdvdG8gb3V0
X2ZhbGxiYWNrOwpAQCAtMjk3LDcgKzI5Nyw3IEBAIHZtX2ZhdWx0X3QgdHRtX2JvX3ZtX2ZhdWx0
X3Jlc2VydmVkKHN0cnVjdCB2bV9mYXVsdCAqdm1mLAogCWlmICh1bmxpa2VseShyZXQgIT0gMCkp
CiAJCXJldHVybiByZXQ7CiAKLQllcnIgPSB0dG1fbWVtX2lvX3Jlc2VydmUoYmRldiwgJmJvLT5t
ZW0pOworCWVyciA9IHR0bV9tZW1faW9fcmVzZXJ2ZShiZGV2LCBiby0+cmVzb3VyY2UpOwogCWlm
ICh1bmxpa2VseShlcnIgIT0gMCkpCiAJCXJldHVybiBWTV9GQVVMVF9TSUdCVVM7CiAKQEAgLTMw
NiwxMSArMzA2LDExIEBAIHZtX2ZhdWx0X3QgdHRtX2JvX3ZtX2ZhdWx0X3Jlc2VydmVkKHN0cnVj
dCB2bV9mYXVsdCAqdm1mLAogCXBhZ2VfbGFzdCA9IHZtYV9wYWdlcyh2bWEpICsgdm1hLT52bV9w
Z29mZiAtCiAJCWRybV92bWFfbm9kZV9zdGFydCgmYm8tPmJhc2Uudm1hX25vZGUpOwogCi0JaWYg
KHVubGlrZWx5KHBhZ2Vfb2Zmc2V0ID49IGJvLT5tZW0ubnVtX3BhZ2VzKSkKKwlpZiAodW5saWtl
bHkocGFnZV9vZmZzZXQgPj0gYm8tPnJlc291cmNlLT5udW1fcGFnZXMpKQogCQlyZXR1cm4gVk1f
RkFVTFRfU0lHQlVTOwogCi0JcHJvdCA9IHR0bV9pb19wcm90KGJvLCAmYm8tPm1lbSwgcHJvdCk7
Ci0JaWYgKCFiby0+bWVtLmJ1cy5pc19pb21lbSkgeworCXByb3QgPSB0dG1faW9fcHJvdChibywg
Ym8tPnJlc291cmNlLCBwcm90KTsKKwlpZiAoIWJvLT5yZXNvdXJjZS0+YnVzLmlzX2lvbWVtKSB7
CiAJCXN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0eCBjdHggPSB7CiAJCQkuaW50ZXJydXB0aWJsZSA9
IGZhbHNlLAogCQkJLm5vX3dhaXRfZ3B1ID0gZmFsc2UsCkBAIC0zMzUsNyArMzM1LDcgQEAgdm1f
ZmF1bHRfdCB0dG1fYm9fdm1fZmF1bHRfcmVzZXJ2ZWQoc3RydWN0IHZtX2ZhdWx0ICp2bWYsCiAJ
ICogZmlyc3QgcGFnZS4KIAkgKi8KIAlmb3IgKGkgPSAwOyBpIDwgbnVtX3ByZWZhdWx0OyArK2kp
IHsKLQkJaWYgKGJvLT5tZW0uYnVzLmlzX2lvbWVtKSB7CisJCWlmIChiby0+cmVzb3VyY2UtPmJ1
cy5pc19pb21lbSkgewogCQkJcGZuID0gdHRtX2JvX2lvX21lbV9wZm4oYm8sIHBhZ2Vfb2Zmc2V0
KTsKIAkJfSBlbHNlIHsKIAkJCXBhZ2UgPSB0dG0tPnBhZ2VzW3BhZ2Vfb2Zmc2V0XTsKQEAgLTQ2
OSwxNCArNDY5LDE0IEBAIGludCB0dG1fYm9fdm1fYWNjZXNzKHN0cnVjdCB2bV9hcmVhX3N0cnVj
dCAqdm1hLCB1bnNpZ25lZCBsb25nIGFkZHIsCiAJCSA8PCBQQUdFX1NISUZUKTsKIAlpbnQgcmV0
OwogCi0JaWYgKGxlbiA8IDEgfHwgKG9mZnNldCArIGxlbikgPj4gUEFHRV9TSElGVCA+IGJvLT5t
ZW0ubnVtX3BhZ2VzKQorCWlmIChsZW4gPCAxIHx8IChvZmZzZXQgKyBsZW4pID4+IFBBR0VfU0hJ
RlQgPiBiby0+cmVzb3VyY2UtPm51bV9wYWdlcykKIAkJcmV0dXJuIC1FSU87CiAKIAlyZXQgPSB0
dG1fYm9fcmVzZXJ2ZShibywgdHJ1ZSwgZmFsc2UsIE5VTEwpOwogCWlmIChyZXQpCiAJCXJldHVy
biByZXQ7CiAKLQlzd2l0Y2ggKGJvLT5tZW0ubWVtX3R5cGUpIHsKKwlzd2l0Y2ggKGJvLT5yZXNv
dXJjZS0+bWVtX3R5cGUpIHsKIAljYXNlIFRUTV9QTF9TWVNURU06CiAJCWlmICh1bmxpa2VseShi
by0+dHRtLT5wYWdlX2ZsYWdzICYgVFRNX1BBR0VfRkxBR19TV0FQUEVEKSkgewogCQkJcmV0ID0g
dHRtX3R0X3N3YXBpbihiby0+dHRtKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdn
Zngvdm13Z2Z4X2JsaXQuYyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2JsaXQuYwpp
bmRleCAzYTQzOGFlNGQzZjQuLmZhN2MwYzhkYTE5MyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL3Ztd2dmeC92bXdnZnhfYmxpdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13
Z2Z4X2JsaXQuYwpAQCAtNDgzLDEwICs0ODMsMTAgQEAgaW50IHZtd19ib19jcHVfYmxpdChzdHJ1
Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmRzdCwKIAlkLnNyY19hZGRyID0gTlVMTDsKIAlkLmRzdF9w
YWdlcyA9IGRzdC0+dHRtLT5wYWdlczsKIAlkLnNyY19wYWdlcyA9IHNyYy0+dHRtLT5wYWdlczsK
LQlkLmRzdF9udW1fcGFnZXMgPSBkc3QtPm1lbS5udW1fcGFnZXM7Ci0JZC5zcmNfbnVtX3BhZ2Vz
ID0gc3JjLT5tZW0ubnVtX3BhZ2VzOwotCWQuZHN0X3Byb3QgPSB0dG1faW9fcHJvdChkc3QsICZk
c3QtPm1lbSwgUEFHRV9LRVJORUwpOwotCWQuc3JjX3Byb3QgPSB0dG1faW9fcHJvdChzcmMsICZz
cmMtPm1lbSwgUEFHRV9LRVJORUwpOworCWQuZHN0X251bV9wYWdlcyA9IGRzdC0+cmVzb3VyY2Ut
Pm51bV9wYWdlczsKKwlkLnNyY19udW1fcGFnZXMgPSBzcmMtPnJlc291cmNlLT5udW1fcGFnZXM7
CisJZC5kc3RfcHJvdCA9IHR0bV9pb19wcm90KGRzdCwgZHN0LT5yZXNvdXJjZSwgUEFHRV9LRVJO
RUwpOworCWQuc3JjX3Byb3QgPSB0dG1faW9fcHJvdChzcmMsIHNyYy0+cmVzb3VyY2UsIFBBR0Vf
S0VSTkVMKTsKIAlkLmRpZmYgPSBkaWZmOwogCiAJZm9yIChqID0gMDsgaiA8IGg7ICsraikgewpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfYm8uYyBiL2RyaXZlcnMv
Z3B1L2RybS92bXdnZngvdm13Z2Z4X2JvLmMKaW5kZXggNTg3MzE0ZDU3OTkxLi42ZjhkZjEyY2Nl
YmIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2JvLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfYm8uYwpAQCAtMTA3LDcgKzEwNyw3IEBAIGlu
dCB2bXdfYm9fcGluX2luX3BsYWNlbWVudChzdHJ1Y3Qgdm13X3ByaXZhdGUgKmRldl9wcml2LAog
CQlnb3RvIGVycjsKIAogCWlmIChidWYtPmJhc2UucGluX2NvdW50ID4gMCkKLQkJcmV0ID0gdHRt
X2JvX21lbV9jb21wYXQocGxhY2VtZW50LCAmYm8tPm1lbSwKKwkJcmV0ID0gdHRtX2JvX21lbV9j
b21wYXQocGxhY2VtZW50LCBiby0+cmVzb3VyY2UsCiAJCQkJCSZuZXdfZmxhZ3MpID09IHRydWUg
PyAwIDogLUVJTlZBTDsKIAllbHNlCiAJCXJldCA9IHR0bV9ib192YWxpZGF0ZShibywgcGxhY2Vt
ZW50LCAmY3R4KTsKQEAgLTE1NSw3ICsxNTUsNyBAQCBpbnQgdm13X2JvX3Bpbl9pbl92cmFtX29y
X2dtcihzdHJ1Y3Qgdm13X3ByaXZhdGUgKmRldl9wcml2LAogCQlnb3RvIGVycjsKIAogCWlmIChi
dWYtPmJhc2UucGluX2NvdW50ID4gMCkgewotCQlyZXQgPSB0dG1fYm9fbWVtX2NvbXBhdCgmdm13
X3ZyYW1fZ21yX3BsYWNlbWVudCwgJmJvLT5tZW0sCisJCXJldCA9IHR0bV9ib19tZW1fY29tcGF0
KCZ2bXdfdnJhbV9nbXJfcGxhY2VtZW50LCBiby0+cmVzb3VyY2UsCiAJCQkJCSZuZXdfZmxhZ3Mp
ID09IHRydWUgPyAwIDogLUVJTlZBTDsKIAkJZ290byBvdXRfdW5yZXNlcnZlOwogCX0KQEAgLTIy
Miw3ICsyMjIsNyBAQCBpbnQgdm13X2JvX3Bpbl9pbl9zdGFydF9vZl92cmFtKHN0cnVjdCB2bXdf
cHJpdmF0ZSAqZGV2X3ByaXYsCiAJdWludDMyX3QgbmV3X2ZsYWdzOwogCiAJcGxhY2UgPSB2bXdf
dnJhbV9wbGFjZW1lbnQucGxhY2VtZW50WzBdOwotCXBsYWNlLmxwZm4gPSBiby0+bWVtLm51bV9w
YWdlczsKKwlwbGFjZS5scGZuID0gYm8tPnJlc291cmNlLT5udW1fcGFnZXM7CiAJcGxhY2VtZW50
Lm51bV9wbGFjZW1lbnQgPSAxOwogCXBsYWNlbWVudC5wbGFjZW1lbnQgPSAmcGxhY2U7CiAJcGxh
Y2VtZW50Lm51bV9idXN5X3BsYWNlbWVudCA9IDE7CkBAIC0yNDIsMjIgKzI0MiwyMiBAQCBpbnQg
dm13X2JvX3Bpbl9pbl9zdGFydF9vZl92cmFtKHN0cnVjdCB2bXdfcHJpdmF0ZSAqZGV2X3ByaXYs
CiAJICogSW4gdGhhdCBjYXNlLCBldmljdCBpdCBmaXJzdCBiZWNhdXNlIFRUTSBpc24ndCBnb29k
IGF0IGhhbmRsaW5nCiAJICogdGhhdCBzaXR1YXRpb24uCiAJICovCi0JaWYgKGJvLT5tZW0ubWVt
X3R5cGUgPT0gVFRNX1BMX1ZSQU0gJiYKLQkgICAgYm8tPm1lbS5zdGFydCA8IGJvLT5tZW0ubnVt
X3BhZ2VzICYmCi0JICAgIGJvLT5tZW0uc3RhcnQgPiAwICYmCisJaWYgKGJvLT5yZXNvdXJjZS0+
bWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0gJiYKKwkgICAgYm8tPnJlc291cmNlLT5zdGFydCA8IGJv
LT5yZXNvdXJjZS0+bnVtX3BhZ2VzICYmCisJICAgIGJvLT5yZXNvdXJjZS0+c3RhcnQgPiAwICYm
CiAJICAgIGJ1Zi0+YmFzZS5waW5fY291bnQgPT0gMCkgewogCQljdHguaW50ZXJydXB0aWJsZSA9
IGZhbHNlOwogCQkodm9pZCkgdHRtX2JvX3ZhbGlkYXRlKGJvLCAmdm13X3N5c19wbGFjZW1lbnQs
ICZjdHgpOwogCX0KIAogCWlmIChidWYtPmJhc2UucGluX2NvdW50ID4gMCkKLQkJcmV0ID0gdHRt
X2JvX21lbV9jb21wYXQoJnBsYWNlbWVudCwgJmJvLT5tZW0sCisJCXJldCA9IHR0bV9ib19tZW1f
Y29tcGF0KCZwbGFjZW1lbnQsIGJvLT5yZXNvdXJjZSwKIAkJCQkJJm5ld19mbGFncykgPT0gdHJ1
ZSA/IDAgOiAtRUlOVkFMOwogCWVsc2UKIAkJcmV0ID0gdHRtX2JvX3ZhbGlkYXRlKGJvLCAmcGxh
Y2VtZW50LCAmY3R4KTsKIAogCS8qIEZvciBzb21lIHJlYXNvbiB3ZSBkaWRuJ3QgZW5kIHVwIGF0
IHRoZSBzdGFydCBvZiB2cmFtICovCi0JV0FSTl9PTihyZXQgPT0gMCAmJiBiby0+bWVtLnN0YXJ0
ICE9IDApOworCVdBUk5fT04ocmV0ID09IDAgJiYgYm8tPnJlc291cmNlLT5zdGFydCAhPSAwKTsK
IAlpZiAoIXJldCkKIAkJdm13X2JvX3Bpbl9yZXNlcnZlZChidWYsIHRydWUpOwogCkBAIC0zMTQs
MTEgKzMxNCwxMSBAQCBpbnQgdm13X2JvX3VucGluKHN0cnVjdCB2bXdfcHJpdmF0ZSAqZGV2X3By
aXYsCiB2b2lkIHZtd19ib19nZXRfZ3Vlc3RfcHRyKGNvbnN0IHN0cnVjdCB0dG1fYnVmZmVyX29i
amVjdCAqYm8sCiAJCQkgIFNWR0FHdWVzdFB0ciAqcHRyKQogewotCWlmIChiby0+bWVtLm1lbV90
eXBlID09IFRUTV9QTF9WUkFNKSB7CisJaWYgKGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRN
X1BMX1ZSQU0pIHsKIAkJcHRyLT5nbXJJZCA9IFNWR0FfR01SX0ZSQU1FQlVGRkVSOwotCQlwdHIt
Pm9mZnNldCA9IGJvLT5tZW0uc3RhcnQgPDwgUEFHRV9TSElGVDsKKwkJcHRyLT5vZmZzZXQgPSBi
by0+cmVzb3VyY2UtPnN0YXJ0IDw8IFBBR0VfU0hJRlQ7CiAJfSBlbHNlIHsKLQkJcHRyLT5nbXJJ
ZCA9IGJvLT5tZW0uc3RhcnQ7CisJCXB0ci0+Z21ySWQgPSBiby0+cmVzb3VyY2UtPnN0YXJ0Owog
CQlwdHItPm9mZnNldCA9IDA7CiAJfQogfQpAQCAtMzM3LDcgKzMzNyw3IEBAIHZvaWQgdm13X2Jv
X3Bpbl9yZXNlcnZlZChzdHJ1Y3Qgdm13X2J1ZmZlcl9vYmplY3QgKnZibywgYm9vbCBwaW4pCiAJ
c3RydWN0IHR0bV9wbGFjZSBwbDsKIAlzdHJ1Y3QgdHRtX3BsYWNlbWVudCBwbGFjZW1lbnQ7CiAJ
c3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibyA9ICZ2Ym8tPmJhc2U7Ci0JdWludDMyX3Qgb2xk
X21lbV90eXBlID0gYm8tPm1lbS5tZW1fdHlwZTsKKwl1aW50MzJfdCBvbGRfbWVtX3R5cGUgPSBi
by0+cmVzb3VyY2UtPm1lbV90eXBlOwogCWludCByZXQ7CiAKIAlkbWFfcmVzdl9hc3NlcnRfaGVs
ZChiby0+YmFzZS5yZXN2KTsKQEAgLTM0Nyw4ICszNDcsOCBAQCB2b2lkIHZtd19ib19waW5fcmVz
ZXJ2ZWQoc3RydWN0IHZtd19idWZmZXJfb2JqZWN0ICp2Ym8sIGJvb2wgcGluKQogCiAJcGwuZnBm
biA9IDA7CiAJcGwubHBmbiA9IDA7Ci0JcGwubWVtX3R5cGUgPSBiby0+bWVtLm1lbV90eXBlOwot
CXBsLmZsYWdzID0gYm8tPm1lbS5wbGFjZW1lbnQ7CisJcGwubWVtX3R5cGUgPSBiby0+cmVzb3Vy
Y2UtPm1lbV90eXBlOworCXBsLmZsYWdzID0gYm8tPnJlc291cmNlLT5wbGFjZW1lbnQ7CiAKIAlt
ZW1zZXQoJnBsYWNlbWVudCwgMCwgc2l6ZW9mKHBsYWNlbWVudCkpOwogCXBsYWNlbWVudC5udW1f
cGxhY2VtZW50ID0gMTsKQEAgLTM1Niw3ICszNTYsNyBAQCB2b2lkIHZtd19ib19waW5fcmVzZXJ2
ZWQoc3RydWN0IHZtd19idWZmZXJfb2JqZWN0ICp2Ym8sIGJvb2wgcGluKQogCiAJcmV0ID0gdHRt
X2JvX3ZhbGlkYXRlKGJvLCAmcGxhY2VtZW50LCAmY3R4KTsKIAotCUJVR19PTihyZXQgIT0gMCB8
fCBiby0+bWVtLm1lbV90eXBlICE9IG9sZF9tZW1fdHlwZSk7CisJQlVHX09OKHJldCAhPSAwIHx8
IGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgIT0gb2xkX21lbV90eXBlKTsKIAogCWlmIChwaW4pCiAJ
CXR0bV9ib19waW4oYm8pOwpAQCAtMzkwLDcgKzM5MCw3IEBAIHZvaWQgKnZtd19ib19tYXBfYW5k
X2NhY2hlKHN0cnVjdCB2bXdfYnVmZmVyX29iamVjdCAqdmJvKQogCWlmICh2aXJ0dWFsKQogCQly
ZXR1cm4gdmlydHVhbDsKIAotCXJldCA9IHR0bV9ib19rbWFwKGJvLCAwLCBiby0+bWVtLm51bV9w
YWdlcywgJnZiby0+bWFwKTsKKwlyZXQgPSB0dG1fYm9fa21hcChibywgMCwgYm8tPnJlc291cmNl
LT5udW1fcGFnZXMsICZ2Ym8tPm1hcCk7CiAJaWYgKHJldCkKIAkJRFJNX0VSUk9SKCJCdWZmZXIg
b2JqZWN0IG1hcCBmYWlsZWQ6ICVkLlxuIiwgcmV0KTsKIApAQCAtMTIyOCw3ICsxMjI4LDcgQEAg
dm9pZCB2bXdfYm9fbW92ZV9ub3RpZnkoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAkg
KiBXaXRoIG90aGVyIHR5cGVzIG9mIG1vdmVzLCB0aGUgdW5kZXJseWluZyBwYWdlcyBzdGF5IHRo
ZSBzYW1lLAogCSAqIGFuZCB0aGUgbWFwIGNhbiBiZSBrZXB0LgogCSAqLwotCWlmIChtZW0tPm1l
bV90eXBlID09IFRUTV9QTF9WUkFNIHx8IGJvLT5tZW0ubWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0p
CisJaWYgKG1lbS0+bWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0gfHwgYm8tPnJlc291cmNlLT5tZW1f
dHlwZSA9PSBUVE1fUExfVlJBTSkKIAkJdm13X2JvX3VubWFwKHZibyk7CiAKIAkvKgpAQCAtMTIz
Niw2ICsxMjM2LDYgQEAgdm9pZCB2bXdfYm9fbW92ZV9ub3RpZnkoc3RydWN0IHR0bV9idWZmZXJf
b2JqZWN0ICpibywKIAkgKiByZWFkIGJhY2sgYWxsIHJlc291cmNlIGNvbnRlbnQgZmlyc3QsIGFu
ZCB1bmJpbmQgdGhlIE1PQiBmcm9tCiAJICogdGhlIHJlc291cmNlLgogCSAqLwotCWlmIChtZW0t
Pm1lbV90eXBlICE9IFZNV19QTF9NT0IgJiYgYm8tPm1lbS5tZW1fdHlwZSA9PSBWTVdfUExfTU9C
KQorCWlmIChtZW0tPm1lbV90eXBlICE9IFZNV19QTF9NT0IgJiYgYm8tPnJlc291cmNlLT5tZW1f
dHlwZSA9PSBWTVdfUExfTU9CKQogCQl2bXdfcmVzb3VyY2VfdW5iaW5kX2xpc3QodmJvKTsKIH0K
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2NtZC5jIGIvZHJpdmVy
cy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfY21kLmMKaW5kZXggMjAyNDZhN2M5N2M5Li4wNjEzNDMw
NWFmMTEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2NtZC5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2NtZC5jCkBAIC02MDAsMTEgKzYwMCwx
MSBAQCBzdGF0aWMgaW50IHZtd19maWZvX2VtaXRfZHVtbXlfbGVnYWN5X3F1ZXJ5KHN0cnVjdCB2
bXdfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJY21kLT5ib2R5LmNpZCA9IGNpZDsKIAljbWQtPmJvZHku
dHlwZSA9IFNWR0EzRF9RVUVSWVRZUEVfT0NDTFVTSU9OOwogCi0JaWYgKGJvLT5tZW0ubWVtX3R5
cGUgPT0gVFRNX1BMX1ZSQU0pIHsKKwlpZiAoYm8tPnJlc291cmNlLT5tZW1fdHlwZSA9PSBUVE1f
UExfVlJBTSkgewogCQljbWQtPmJvZHkuZ3Vlc3RSZXN1bHQuZ21ySWQgPSBTVkdBX0dNUl9GUkFN
RUJVRkZFUjsKLQkJY21kLT5ib2R5Lmd1ZXN0UmVzdWx0Lm9mZnNldCA9IGJvLT5tZW0uc3RhcnQg
PDwgUEFHRV9TSElGVDsKKwkJY21kLT5ib2R5Lmd1ZXN0UmVzdWx0Lm9mZnNldCA9IGJvLT5yZXNv
dXJjZS0+c3RhcnQgPDwgUEFHRV9TSElGVDsKIAl9IGVsc2UgewotCQljbWQtPmJvZHkuZ3Vlc3RS
ZXN1bHQuZ21ySWQgPSBiby0+bWVtLnN0YXJ0OworCQljbWQtPmJvZHkuZ3Vlc3RSZXN1bHQuZ21y
SWQgPSBiby0+cmVzb3VyY2UtPnN0YXJ0OwogCQljbWQtPmJvZHkuZ3Vlc3RSZXN1bHQub2Zmc2V0
ID0gMDsKIAl9CiAKQEAgLTY0NSw4ICs2NDUsOCBAQCBzdGF0aWMgaW50IHZtd19maWZvX2VtaXRf
ZHVtbXlfZ2JfcXVlcnkoc3RydWN0IHZtd19wcml2YXRlICpkZXZfcHJpdiwKIAljbWQtPmhlYWRl
ci5zaXplID0gc2l6ZW9mKGNtZC0+Ym9keSk7CiAJY21kLT5ib2R5LmNpZCA9IGNpZDsKIAljbWQt
PmJvZHkudHlwZSA9IFNWR0EzRF9RVUVSWVRZUEVfT0NDTFVTSU9OOwotCUJVR19PTihiby0+bWVt
Lm1lbV90eXBlICE9IFZNV19QTF9NT0IpOwotCWNtZC0+Ym9keS5tb2JpZCA9IGJvLT5tZW0uc3Rh
cnQ7CisJQlVHX09OKGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgIT0gVk1XX1BMX01PQik7CisJY21k
LT5ib2R5Lm1vYmlkID0gYm8tPnJlc291cmNlLT5zdGFydDsKIAljbWQtPmJvZHkub2Zmc2V0ID0g
MDsKIAogCXZtd19jbWRfY29tbWl0KGRldl9wcml2LCBzaXplb2YoKmNtZCkpOwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfY21kYnVmLmMgYi9kcml2ZXJzL2dwdS9k
cm0vdm13Z2Z4L3Ztd2dmeF9jbWRidWYuYwppbmRleCAyZTIzZTUzN2NkZjUuLjk1ZDQ0MjM2MWIz
MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfY21kYnVmLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfY21kYnVmLmMKQEAgLTg4OSw3ICs4ODks
NyBAQCBzdGF0aWMgaW50IHZtd19jbWRidWZfc3BhY2VfcG9vbChzdHJ1Y3Qgdm13X2NtZGJ1Zl9t
YW4gKm1hbiwKIAloZWFkZXItPmNtZCA9IG1hbi0+bWFwICsgb2Zmc2V0OwogCWlmIChtYW4tPnVz
aW5nX21vYikgewogCQljYl9oZHItPmZsYWdzID0gU1ZHQV9DQl9GTEFHX01PQjsKLQkJY2JfaGRy
LT5wdHIubW9iLm1vYmlkID0gbWFuLT5jbWRfc3BhY2UtPm1lbS5zdGFydDsKKwkJY2JfaGRyLT5w
dHIubW9iLm1vYmlkID0gbWFuLT5jbWRfc3BhY2UtPnJlc291cmNlLT5zdGFydDsKIAkJY2JfaGRy
LT5wdHIubW9iLm1vYk9mZnNldCA9IG9mZnNldDsKIAl9IGVsc2UgewogCQljYl9oZHItPnB0ci5w
YSA9ICh1NjQpbWFuLT5oYW5kbGUgKyAodTY0KW9mZnNldDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS92bXdnZngvdm13Z2Z4X2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngv
dm13Z2Z4X2NvbnRleHQuYwppbmRleCA0YTVhM2UyNDYyMTYuLjQ3ODIzZmIzNzNmYSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfY29udGV4dC5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2NvbnRleHQuYwpAQCAtMzQ2LDcgKzM0Niw3IEBAIHN0
YXRpYyBpbnQgdm13X2diX2NvbnRleHRfYmluZChzdHJ1Y3Qgdm13X3Jlc291cmNlICpyZXMsCiAJ
fSAqY21kOwogCXN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8gPSB2YWxfYnVmLT5ibzsKIAot
CUJVR19PTihiby0+bWVtLm1lbV90eXBlICE9IFZNV19QTF9NT0IpOworCUJVR19PTihiby0+cmVz
b3VyY2UtPm1lbV90eXBlICE9IFZNV19QTF9NT0IpOwogCiAJY21kID0gVk1XX0NNRF9SRVNFUlZF
KGRldl9wcml2LCBzaXplb2YoKmNtZCkpOwogCWlmICh1bmxpa2VseShjbWQgPT0gTlVMTCkpCkBA
IC0zNTUsNyArMzU1LDcgQEAgc3RhdGljIGludCB2bXdfZ2JfY29udGV4dF9iaW5kKHN0cnVjdCB2
bXdfcmVzb3VyY2UgKnJlcywKIAljbWQtPmhlYWRlci5pZCA9IFNWR0FfM0RfQ01EX0JJTkRfR0Jf
Q09OVEVYVDsKIAljbWQtPmhlYWRlci5zaXplID0gc2l6ZW9mKGNtZC0+Ym9keSk7CiAJY21kLT5i
b2R5LmNpZCA9IHJlcy0+aWQ7Ci0JY21kLT5ib2R5Lm1vYmlkID0gYm8tPm1lbS5zdGFydDsKKwlj
bWQtPmJvZHkubW9iaWQgPSBiby0+cmVzb3VyY2UtPnN0YXJ0OwogCWNtZC0+Ym9keS52YWxpZENv
bnRlbnRzID0gcmVzLT5iYWNrdXBfZGlydHk7CiAJcmVzLT5iYWNrdXBfZGlydHkgPSBmYWxzZTsK
IAl2bXdfY21kX2NvbW1pdChkZXZfcHJpdiwgc2l6ZW9mKCpjbWQpKTsKQEAgLTM4NSw3ICszODUs
NyBAQCBzdGF0aWMgaW50IHZtd19nYl9jb250ZXh0X3VuYmluZChzdHJ1Y3Qgdm13X3Jlc291cmNl
ICpyZXMsCiAJdWludDhfdCAqY21kOwogCiAKLQlCVUdfT04oYm8tPm1lbS5tZW1fdHlwZSAhPSBW
TVdfUExfTU9CKTsKKwlCVUdfT04oYm8tPnJlc291cmNlLT5tZW1fdHlwZSAhPSBWTVdfUExfTU9C
KTsKIAogCW11dGV4X2xvY2soJmRldl9wcml2LT5iaW5kaW5nX211dGV4KTsKIAl2bXdfYmluZGlu
Z19zdGF0ZV9zY3J1Yih1Y3R4LT5jYnMpOwpAQCAtNTEzLDcgKzUxMyw3IEBAIHN0YXRpYyBpbnQg
dm13X2R4X2NvbnRleHRfYmluZChzdHJ1Y3Qgdm13X3Jlc291cmNlICpyZXMsCiAJfSAqY21kOwog
CXN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8gPSB2YWxfYnVmLT5ibzsKIAotCUJVR19PTihi
by0+bWVtLm1lbV90eXBlICE9IFZNV19QTF9NT0IpOworCUJVR19PTihiby0+cmVzb3VyY2UtPm1l
bV90eXBlICE9IFZNV19QTF9NT0IpOwogCiAJY21kID0gVk1XX0NNRF9SRVNFUlZFKGRldl9wcml2
LCBzaXplb2YoKmNtZCkpOwogCWlmICh1bmxpa2VseShjbWQgPT0gTlVMTCkpCkBAIC01MjIsNyAr
NTIyLDcgQEAgc3RhdGljIGludCB2bXdfZHhfY29udGV4dF9iaW5kKHN0cnVjdCB2bXdfcmVzb3Vy
Y2UgKnJlcywKIAljbWQtPmhlYWRlci5pZCA9IFNWR0FfM0RfQ01EX0RYX0JJTkRfQ09OVEVYVDsK
IAljbWQtPmhlYWRlci5zaXplID0gc2l6ZW9mKGNtZC0+Ym9keSk7CiAJY21kLT5ib2R5LmNpZCA9
IHJlcy0+aWQ7Ci0JY21kLT5ib2R5Lm1vYmlkID0gYm8tPm1lbS5zdGFydDsKKwljbWQtPmJvZHku
bW9iaWQgPSBiby0+cmVzb3VyY2UtPnN0YXJ0OwogCWNtZC0+Ym9keS52YWxpZENvbnRlbnRzID0g
cmVzLT5iYWNrdXBfZGlydHk7CiAJcmVzLT5iYWNrdXBfZGlydHkgPSBmYWxzZTsKIAl2bXdfY21k
X2NvbW1pdChkZXZfcHJpdiwgc2l6ZW9mKCpjbWQpKTsKQEAgLTU5NCw3ICs1OTQsNyBAQCBzdGF0
aWMgaW50IHZtd19keF9jb250ZXh0X3VuYmluZChzdHJ1Y3Qgdm13X3Jlc291cmNlICpyZXMsCiAJ
dWludDhfdCAqY21kOwogCiAKLQlCVUdfT04oYm8tPm1lbS5tZW1fdHlwZSAhPSBWTVdfUExfTU9C
KTsKKwlCVUdfT04oYm8tPnJlc291cmNlLT5tZW1fdHlwZSAhPSBWTVdfUExfTU9CKTsKIAogCW11
dGV4X2xvY2soJmRldl9wcml2LT5iaW5kaW5nX211dGV4KTsKIAl2bXdfZHhfY29udGV4dF9zY3J1
Yl9jb3RhYmxlcyhyZXMsIHJlYWRiYWNrKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92
bXdnZngvdm13Z2Z4X2NvdGFibGUuYyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2Nv
dGFibGUuYwppbmRleCA0MjMyMWI5YzgxMjkuLjY2MDAwMGEzN2U4ZCAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfY290YWJsZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS92bXdnZngvdm13Z2Z4X2NvdGFibGUuYwpAQCAtMTczLDcgKzE3Myw3IEBAIHN0YXRpYyBpbnQg
dm13X2NvdGFibGVfdW5zY3J1YihzdHJ1Y3Qgdm13X3Jlc291cmNlICpyZXMpCiAJCVNWR0EzZENt
ZERYU2V0Q09UYWJsZSBib2R5OwogCX0gKmNtZDsKIAotCVdBUk5fT05fT05DRShiby0+bWVtLm1l
bV90eXBlICE9IFZNV19QTF9NT0IpOworCVdBUk5fT05fT05DRShiby0+cmVzb3VyY2UtPm1lbV90
eXBlICE9IFZNV19QTF9NT0IpOwogCWRtYV9yZXN2X2Fzc2VydF9oZWxkKGJvLT5iYXNlLnJlc3Yp
OwogCiAJY21kID0gVk1XX0NNRF9SRVNFUlZFKGRldl9wcml2LCBzaXplb2YoKmNtZCkpOwpAQCAt
MTgxLDEyICsxODEsMTIgQEAgc3RhdGljIGludCB2bXdfY290YWJsZV91bnNjcnViKHN0cnVjdCB2
bXdfcmVzb3VyY2UgKnJlcykKIAkJcmV0dXJuIC1FTk9NRU07CiAKIAlXQVJOX09OKHZjb3RibC0+
Y3R4LT5pZCA9PSBTVkdBM0RfSU5WQUxJRF9JRCk7Ci0JV0FSTl9PTihiby0+bWVtLm1lbV90eXBl
ICE9IFZNV19QTF9NT0IpOworCVdBUk5fT04oYm8tPnJlc291cmNlLT5tZW1fdHlwZSAhPSBWTVdf
UExfTU9CKTsKIAljbWQtPmhlYWRlci5pZCA9IFNWR0FfM0RfQ01EX0RYX1NFVF9DT1RBQkxFOwog
CWNtZC0+aGVhZGVyLnNpemUgPSBzaXplb2YoY21kLT5ib2R5KTsKIAljbWQtPmJvZHkuY2lkID0g
dmNvdGJsLT5jdHgtPmlkOwogCWNtZC0+Ym9keS50eXBlID0gdmNvdGJsLT50eXBlOwotCWNtZC0+
Ym9keS5tb2JpZCA9IGJvLT5tZW0uc3RhcnQ7CisJY21kLT5ib2R5Lm1vYmlkID0gYm8tPnJlc291
cmNlLT5zdGFydDsKIAljbWQtPmJvZHkudmFsaWRTaXplSW5CeXRlcyA9IHZjb3RibC0+c2l6ZV9y
ZWFkX2JhY2s7CiAKIAl2bXdfY21kX2NvbW1pdF9mbHVzaChkZXZfcHJpdiwgc2l6ZW9mKCpjbWQp
KTsKQEAgLTMxNSw3ICszMTUsNyBAQCBzdGF0aWMgaW50IHZtd19jb3RhYmxlX3VuYmluZChzdHJ1
Y3Qgdm13X3Jlc291cmNlICpyZXMsCiAJaWYgKCF2bXdfcmVzb3VyY2VfbW9iX2F0dGFjaGVkKHJl
cykpCiAJCXJldHVybiAwOwogCi0JV0FSTl9PTl9PTkNFKGJvLT5tZW0ubWVtX3R5cGUgIT0gVk1X
X1BMX01PQik7CisJV0FSTl9PTl9PTkNFKGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgIT0gVk1XX1BM
X01PQik7CiAJZG1hX3Jlc3ZfYXNzZXJ0X2hlbGQoYm8tPmJhc2UucmVzdik7CiAKIAltdXRleF9s
b2NrKCZkZXZfcHJpdi0+YmluZGluZ19tdXRleCk7CkBAIC00MzEsNyArNDMxLDcgQEAgc3RhdGlj
IGludCB2bXdfY290YWJsZV9yZXNpemUoc3RydWN0IHZtd19yZXNvdXJjZSAqcmVzLCBzaXplX3Qg
bmV3X3NpemUpCiAJICogRG8gYSBwYWdlIGJ5IHBhZ2UgY29weSBvZiBDT1RhYmxlcy4gVGhpcyBl
bGltaW5hdGVzIHNsb3cgdm1hcCgpcy4KIAkgKiBUaGlzIHNob3VsZCByZWFsbHkgYmUgYSBUVE0g
dXRpbGl0eS4KIAkgKi8KLQlmb3IgKGkgPSAwOyBpIDwgb2xkX2JvLT5tZW0ubnVtX3BhZ2VzOyAr
K2kpIHsKKwlmb3IgKGkgPSAwOyBpIDwgb2xkX2JvLT5yZXNvdXJjZS0+bnVtX3BhZ2VzOyArK2kp
IHsKIAkJYm9vbCBkdW1teTsKIAogCQlyZXQgPSB0dG1fYm9fa21hcChvbGRfYm8sIGksIDEsICZv
bGRfbWFwKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2V4ZWNi
dWYuYyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2V4ZWNidWYuYwppbmRleCA3YTI0
MTk2ZjkyYzMuLjQyZjM3NjU4MmUxNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dm
eC92bXdnZnhfZXhlY2J1Zi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2V4
ZWNidWYuYwpAQCAtNzM1LDcgKzczNSw3IEBAIHN0YXRpYyBpbnQgdm13X3JlYmluZF9hbGxfZHhf
cXVlcnkoc3RydWN0IHZtd19yZXNvdXJjZSAqY3R4X3JlcykKIAljbWQtPmhlYWRlci5pZCA9IFNW
R0FfM0RfQ01EX0RYX0JJTkRfQUxMX1FVRVJZOwogCWNtZC0+aGVhZGVyLnNpemUgPSBzaXplb2Yo
Y21kLT5ib2R5KTsKIAljbWQtPmJvZHkuY2lkID0gY3R4X3Jlcy0+aWQ7Ci0JY21kLT5ib2R5Lm1v
YmlkID0gZHhfcXVlcnlfbW9iLT5iYXNlLm1lbS5zdGFydDsKKwljbWQtPmJvZHkubW9iaWQgPSBk
eF9xdWVyeV9tb2ItPmJhc2UucmVzb3VyY2UtPnN0YXJ0OwogCXZtd19jbWRfY29tbWl0KGRldl9w
cml2LCBzaXplb2YoKmNtZCkpOwogCiAJdm13X2NvbnRleHRfYmluZF9keF9xdWVyeShjdHhfcmVz
LCBkeF9xdWVyeV9tb2IpOwpAQCAtMTA0Niw3ICsxMDQ2LDcgQEAgc3RhdGljIGludCB2bXdfcXVl
cnlfYm9fc3dpdGNoX3ByZXBhcmUoc3RydWN0IHZtd19wcml2YXRlICpkZXZfcHJpdiwKIAogCWlm
ICh1bmxpa2VseShuZXdfcXVlcnlfYm8gIT0gc3dfY29udGV4dC0+Y3VyX3F1ZXJ5X2JvKSkgewog
Ci0JCWlmICh1bmxpa2VseShuZXdfcXVlcnlfYm8tPmJhc2UubWVtLm51bV9wYWdlcyA+IDQpKSB7
CisJCWlmICh1bmxpa2VseShuZXdfcXVlcnlfYm8tPmJhc2UucmVzb3VyY2UtPm51bV9wYWdlcyA+
IDQpKSB7CiAJCQlWTVdfREVCVUdfVVNFUigiUXVlcnkgYnVmZmVyIHRvbyBsYXJnZS5cbiIpOwog
CQkJcmV0dXJuIC1FSU5WQUw7CiAJCX0KQEAgLTM2OTgsMTYgKzM2OTgsMTYgQEAgc3RhdGljIHZv
aWQgdm13X2FwcGx5X3JlbG9jYXRpb25zKHN0cnVjdCB2bXdfc3dfY29udGV4dCAqc3dfY29udGV4
dCkKIAogCWxpc3RfZm9yX2VhY2hfZW50cnkocmVsb2MsICZzd19jb250ZXh0LT5ib19yZWxvY2F0
aW9ucywgaGVhZCkgewogCQlibyA9ICZyZWxvYy0+dmJvLT5iYXNlOwotCQlzd2l0Y2ggKGJvLT5t
ZW0ubWVtX3R5cGUpIHsKKwkJc3dpdGNoIChiby0+cmVzb3VyY2UtPm1lbV90eXBlKSB7CiAJCWNh
c2UgVFRNX1BMX1ZSQU06Ci0JCQlyZWxvYy0+bG9jYXRpb24tPm9mZnNldCArPSBiby0+bWVtLnN0
YXJ0IDw8IFBBR0VfU0hJRlQ7CisJCQlyZWxvYy0+bG9jYXRpb24tPm9mZnNldCArPSBiby0+cmVz
b3VyY2UtPnN0YXJ0IDw8IFBBR0VfU0hJRlQ7CiAJCQlyZWxvYy0+bG9jYXRpb24tPmdtcklkID0g
U1ZHQV9HTVJfRlJBTUVCVUZGRVI7CiAJCQlicmVhazsKIAkJY2FzZSBWTVdfUExfR01SOgotCQkJ
cmVsb2MtPmxvY2F0aW9uLT5nbXJJZCA9IGJvLT5tZW0uc3RhcnQ7CisJCQlyZWxvYy0+bG9jYXRp
b24tPmdtcklkID0gYm8tPnJlc291cmNlLT5zdGFydDsKIAkJCWJyZWFrOwogCQljYXNlIFZNV19Q
TF9NT0I6Ci0JCQkqcmVsb2MtPm1vYl9sb2MgPSBiby0+bWVtLnN0YXJ0OworCQkJKnJlbG9jLT5t
b2JfbG9jID0gYm8tPnJlc291cmNlLT5zdGFydDsKIAkJCWJyZWFrOwogCQlkZWZhdWx0OgogCQkJ
QlVHKCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9wYWdlX2Rp
cnR5LmMgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9wYWdlX2RpcnR5LmMKaW5kZXgg
NDVjOWM2YTdmMWQ2Li5lNWE5YTVjYmQwMWEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92
bXdnZngvdm13Z2Z4X3BhZ2VfZGlydHkuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Zt
d2dmeF9wYWdlX2RpcnR5LmMKQEAgLTIzMiw3ICsyMzIsNyBAQCB2b2lkIHZtd19ib19kaXJ0eV91
bm1hcChzdHJ1Y3Qgdm13X2J1ZmZlcl9vYmplY3QgKnZibywKIGludCB2bXdfYm9fZGlydHlfYWRk
KHN0cnVjdCB2bXdfYnVmZmVyX29iamVjdCAqdmJvKQogewogCXN0cnVjdCB2bXdfYm9fZGlydHkg
KmRpcnR5ID0gdmJvLT5kaXJ0eTsKLQlwZ29mZl90IG51bV9wYWdlcyA9IHZiby0+YmFzZS5tZW0u
bnVtX3BhZ2VzOworCXBnb2ZmX3QgbnVtX3BhZ2VzID0gdmJvLT5iYXNlLnJlc291cmNlLT5udW1f
cGFnZXM7CiAJc2l6ZV90IHNpemUsIGFjY19zaXplOwogCWludCByZXQ7CiAJc3RhdGljIHN0cnVj
dCB0dG1fb3BlcmF0aW9uX2N0eCBjdHggPSB7CkBAIC00MTMsNyArNDEzLDcgQEAgdm1fZmF1bHRf
dCB2bXdfYm9fdm1fbWt3cml0ZShzdHJ1Y3Qgdm1fZmF1bHQgKnZtZikKIAkJcmV0dXJuIHJldDsK
IAogCXBhZ2Vfb2Zmc2V0ID0gdm1mLT5wZ29mZiAtIGRybV92bWFfbm9kZV9zdGFydCgmYm8tPmJh
c2Uudm1hX25vZGUpOwotCWlmICh1bmxpa2VseShwYWdlX29mZnNldCA+PSBiby0+bWVtLm51bV9w
YWdlcykpIHsKKwlpZiAodW5saWtlbHkocGFnZV9vZmZzZXQgPj0gYm8tPnJlc291cmNlLT5udW1f
cGFnZXMpKSB7CiAJCXJldCA9IFZNX0ZBVUxUX1NJR0JVUzsKIAkJZ290byBvdXRfdW5sb2NrOwog
CX0KQEAgLTQ1Niw3ICs0NTYsNyBAQCB2bV9mYXVsdF90IHZtd19ib192bV9mYXVsdChzdHJ1Y3Qg
dm1fZmF1bHQgKnZtZikKIAogCQlwYWdlX29mZnNldCA9IHZtZi0+cGdvZmYgLQogCQkJZHJtX3Zt
YV9ub2RlX3N0YXJ0KCZiby0+YmFzZS52bWFfbm9kZSk7Ci0JCWlmIChwYWdlX29mZnNldCA+PSBi
by0+bWVtLm51bV9wYWdlcyB8fAorCQlpZiAocGFnZV9vZmZzZXQgPj0gYm8tPnJlc291cmNlLT5u
dW1fcGFnZXMgfHwKIAkJICAgIHZtd19yZXNvdXJjZXNfY2xlYW4odmJvLCBwYWdlX29mZnNldCwK
IAkJCQkJcGFnZV9vZmZzZXQgKyBQQUdFX1NJWkUsCiAJCQkJCSZhbGxvd2VkX3ByZWZhdWx0KSkg
ewpAQCAtNTI5LDcgKzUyOSw3IEBAIHZtX2ZhdWx0X3Qgdm13X2JvX3ZtX2h1Z2VfZmF1bHQoc3Ry
dWN0IHZtX2ZhdWx0ICp2bWYsCiAKIAkJcGFnZV9vZmZzZXQgPSB2bWYtPnBnb2ZmIC0KIAkJCWRy
bV92bWFfbm9kZV9zdGFydCgmYm8tPmJhc2Uudm1hX25vZGUpOwotCQlpZiAocGFnZV9vZmZzZXQg
Pj0gYm8tPm1lbS5udW1fcGFnZXMgfHwKKwkJaWYgKHBhZ2Vfb2Zmc2V0ID49IGJvLT5yZXNvdXJj
ZS0+bnVtX3BhZ2VzIHx8CiAJCSAgICB2bXdfcmVzb3VyY2VzX2NsZWFuKHZibywgcGFnZV9vZmZz
ZXQsCiAJCQkJCXBhZ2Vfb2Zmc2V0ICsgUEFHRV9TSVpFLAogCQkJCQkmYWxsb3dlZF9wcmVmYXVs
dCkpIHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3NoYWRlci5j
IGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfc2hhZGVyLmMKaW5kZXggYTBkYjA2NTY0
MDEzLi4zMjA2NzQ0OTg4ZjkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13
Z2Z4X3NoYWRlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3NoYWRlci5j
CkBAIC0yNTQsNyArMjU0LDcgQEAgc3RhdGljIGludCB2bXdfZ2Jfc2hhZGVyX2JpbmQoc3RydWN0
IHZtd19yZXNvdXJjZSAqcmVzLAogCX0gKmNtZDsKIAlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3Qg
KmJvID0gdmFsX2J1Zi0+Ym87CiAKLQlCVUdfT04oYm8tPm1lbS5tZW1fdHlwZSAhPSBWTVdfUExf
TU9CKTsKKwlCVUdfT04oYm8tPnJlc291cmNlLT5tZW1fdHlwZSAhPSBWTVdfUExfTU9CKTsKIAog
CWNtZCA9IFZNV19DTURfUkVTRVJWRShkZXZfcHJpdiwgc2l6ZW9mKCpjbWQpKTsKIAlpZiAodW5s
aWtlbHkoY21kID09IE5VTEwpKQpAQCAtMjYzLDcgKzI2Myw3IEBAIHN0YXRpYyBpbnQgdm13X2di
X3NoYWRlcl9iaW5kKHN0cnVjdCB2bXdfcmVzb3VyY2UgKnJlcywKIAljbWQtPmhlYWRlci5pZCA9
IFNWR0FfM0RfQ01EX0JJTkRfR0JfU0hBREVSOwogCWNtZC0+aGVhZGVyLnNpemUgPSBzaXplb2Yo
Y21kLT5ib2R5KTsKIAljbWQtPmJvZHkuc2hpZCA9IHJlcy0+aWQ7Ci0JY21kLT5ib2R5Lm1vYmlk
ID0gYm8tPm1lbS5zdGFydDsKKwljbWQtPmJvZHkubW9iaWQgPSBiby0+cmVzb3VyY2UtPnN0YXJ0
OwogCWNtZC0+Ym9keS5vZmZzZXRJbkJ5dGVzID0gcmVzLT5iYWNrdXBfb2Zmc2V0OwogCXJlcy0+
YmFja3VwX2RpcnR5ID0gZmFsc2U7CiAJdm13X2NtZF9jb21taXQoZGV2X3ByaXYsIHNpemVvZigq
Y21kKSk7CkBAIC0yODIsNyArMjgyLDcgQEAgc3RhdGljIGludCB2bXdfZ2Jfc2hhZGVyX3VuYmlu
ZChzdHJ1Y3Qgdm13X3Jlc291cmNlICpyZXMsCiAJfSAqY21kOwogCXN0cnVjdCB2bXdfZmVuY2Vf
b2JqICpmZW5jZTsKIAotCUJVR19PTihyZXMtPmJhY2t1cC0+YmFzZS5tZW0ubWVtX3R5cGUgIT0g
Vk1XX1BMX01PQik7CisJQlVHX09OKHJlcy0+YmFja3VwLT5iYXNlLnJlc291cmNlLT5tZW1fdHlw
ZSAhPSBWTVdfUExfTU9CKTsKIAogCWNtZCA9IFZNV19DTURfUkVTRVJWRShkZXZfcHJpdiwgc2l6
ZW9mKCpjbWQpKTsKIAlpZiAodW5saWtlbHkoY21kID09IE5VTEwpKQpAQCAtNDAyLDcgKzQwMiw3
IEBAIHN0YXRpYyBpbnQgdm13X2R4X3NoYWRlcl91bnNjcnViKHN0cnVjdCB2bXdfcmVzb3VyY2Ug
KnJlcykKIAljbWQtPmhlYWRlci5zaXplID0gc2l6ZW9mKGNtZC0+Ym9keSk7CiAJY21kLT5ib2R5
LmNpZCA9IHNoYWRlci0+Y3R4LT5pZDsKIAljbWQtPmJvZHkuc2hpZCA9IHNoYWRlci0+aWQ7Ci0J
Y21kLT5ib2R5Lm1vYmlkID0gcmVzLT5iYWNrdXAtPmJhc2UubWVtLnN0YXJ0OworCWNtZC0+Ym9k
eS5tb2JpZCA9IHJlcy0+YmFja3VwLT5iYXNlLnJlc291cmNlLT5zdGFydDsKIAljbWQtPmJvZHku
b2Zmc2V0SW5CeXRlcyA9IHJlcy0+YmFja3VwX29mZnNldDsKIAl2bXdfY21kX2NvbW1pdChkZXZf
cHJpdiwgc2l6ZW9mKCpjbWQpKTsKIApAQCAtNDUwLDcgKzQ1MCw3IEBAIHN0YXRpYyBpbnQgdm13
X2R4X3NoYWRlcl9iaW5kKHN0cnVjdCB2bXdfcmVzb3VyY2UgKnJlcywKIAlzdHJ1Y3Qgdm13X3By
aXZhdGUgKmRldl9wcml2ID0gcmVzLT5kZXZfcHJpdjsKIAlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmpl
Y3QgKmJvID0gdmFsX2J1Zi0+Ym87CiAKLQlCVUdfT04oYm8tPm1lbS5tZW1fdHlwZSAhPSBWTVdf
UExfTU9CKTsKKwlCVUdfT04oYm8tPnJlc291cmNlLT5tZW1fdHlwZSAhPSBWTVdfUExfTU9CKTsK
IAltdXRleF9sb2NrKCZkZXZfcHJpdi0+YmluZGluZ19tdXRleCk7CiAJdm13X2R4X3NoYWRlcl91
bnNjcnViKHJlcyk7CiAJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+YmluZGluZ19tdXRleCk7CkBA
IC01MTMsNyArNTEzLDcgQEAgc3RhdGljIGludCB2bXdfZHhfc2hhZGVyX3VuYmluZChzdHJ1Y3Qg
dm13X3Jlc291cmNlICpyZXMsCiAJc3RydWN0IHZtd19mZW5jZV9vYmogKmZlbmNlOwogCWludCBy
ZXQ7CiAKLQlCVUdfT04ocmVzLT5iYWNrdXAtPmJhc2UubWVtLm1lbV90eXBlICE9IFZNV19QTF9N
T0IpOworCUJVR19PTihyZXMtPmJhY2t1cC0+YmFzZS5yZXNvdXJjZS0+bWVtX3R5cGUgIT0gVk1X
X1BMX01PQik7CiAKIAltdXRleF9sb2NrKCZkZXZfcHJpdi0+YmluZGluZ19tdXRleCk7CiAJcmV0
ID0gdm13X2R4X3NoYWRlcl9zY3J1YihyZXMpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L3Ztd2dmeC92bXdnZnhfc3RyZWFtb3V0cHV0LmMgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Zt
d2dmeF9zdHJlYW1vdXRwdXQuYwppbmRleCAxZGQwNDJhMjBhNjYuLmM4ZWZhNGE2Yzk5NSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfc3RyZWFtb3V0cHV0LmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfc3RyZWFtb3V0cHV0LmMKQEAgLTEwNiw3
ICsxMDYsNyBAQCBzdGF0aWMgaW50IHZtd19keF9zdHJlYW1vdXRwdXRfdW5zY3J1YihzdHJ1Y3Qg
dm13X3Jlc291cmNlICpyZXMpCiAJY21kLT5oZWFkZXIuaWQgPSBTVkdBXzNEX0NNRF9EWF9CSU5E
X1NUUkVBTU9VVFBVVDsKIAljbWQtPmhlYWRlci5zaXplID0gc2l6ZW9mKGNtZC0+Ym9keSk7CiAJ
Y21kLT5ib2R5LnNvaWQgPSBzby0+aWQ7Ci0JY21kLT5ib2R5Lm1vYmlkID0gcmVzLT5iYWNrdXAt
PmJhc2UubWVtLnN0YXJ0OworCWNtZC0+Ym9keS5tb2JpZCA9IHJlcy0+YmFja3VwLT5iYXNlLnJl
c291cmNlLT5zdGFydDsKIAljbWQtPmJvZHkub2Zmc2V0SW5CeXRlcyA9IHJlcy0+YmFja3VwX29m
ZnNldDsKIAljbWQtPmJvZHkuc2l6ZUluQnl0ZXMgPSBzby0+c2l6ZTsKIAl2bXdfY21kX2NvbW1p
dChkZXZfcHJpdiwgc2l6ZW9mKCpjbWQpKTsKQEAgLTE0Miw3ICsxNDIsNyBAQCBzdGF0aWMgaW50
IHZtd19keF9zdHJlYW1vdXRwdXRfYmluZChzdHJ1Y3Qgdm13X3Jlc291cmNlICpyZXMsCiAJc3Ry
dWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibyA9IHZhbF9idWYtPmJvOwogCWludCByZXQ7CiAKLQlp
ZiAoV0FSTl9PTihiby0+bWVtLm1lbV90eXBlICE9IFZNV19QTF9NT0IpKQorCWlmIChXQVJOX09O
KGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgIT0gVk1XX1BMX01PQikpCiAJCXJldHVybiAtRUlOVkFM
OwogCiAJbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmJpbmRpbmdfbXV0ZXgpOwpAQCAtMTk3LDcgKzE5
Nyw3IEBAIHN0YXRpYyBpbnQgdm13X2R4X3N0cmVhbW91dHB1dF91bmJpbmQoc3RydWN0IHZtd19y
ZXNvdXJjZSAqcmVzLCBib29sIHJlYWRiYWNrLAogCXN0cnVjdCB2bXdfZmVuY2Vfb2JqICpmZW5j
ZTsKIAlpbnQgcmV0OwogCi0JaWYgKFdBUk5fT04ocmVzLT5iYWNrdXAtPmJhc2UubWVtLm1lbV90
eXBlICE9IFZNV19QTF9NT0IpKQorCWlmIChXQVJOX09OKHJlcy0+YmFja3VwLT5iYXNlLnJlc291
cmNlLT5tZW1fdHlwZSAhPSBWTVdfUExfTU9CKSkKIAkJcmV0dXJuIC1FSU5WQUw7CiAKIAltdXRl
eF9sb2NrKCZkZXZfcHJpdi0+YmluZGluZ19tdXRleCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vdm13Z2Z4L3Ztd2dmeF9zdXJmYWNlLmMgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Zt
d2dmeF9zdXJmYWNlLmMKaW5kZXggYzNlNTVjMTM3NmViLi5jOTAzMmIxMzQzNjUgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3N1cmZhY2UuYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9zdXJmYWNlLmMKQEAgLTEyMTgsNyArMTIxOCw3IEBAIHN0
YXRpYyBpbnQgdm13X2diX3N1cmZhY2VfYmluZChzdHJ1Y3Qgdm13X3Jlc291cmNlICpyZXMsCiAJ
dWludDMyX3Qgc3VibWl0X3NpemU7CiAJc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibyA9IHZh
bF9idWYtPmJvOwogCi0JQlVHX09OKGJvLT5tZW0ubWVtX3R5cGUgIT0gVk1XX1BMX01PQik7CisJ
QlVHX09OKGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgIT0gVk1XX1BMX01PQik7CiAKIAlzdWJtaXRf
c2l6ZSA9IHNpemVvZigqY21kMSkgKyAocmVzLT5iYWNrdXBfZGlydHkgPyBzaXplb2YoKmNtZDIp
IDogMCk7CiAKQEAgLTEyMjksNyArMTIyOSw3IEBAIHN0YXRpYyBpbnQgdm13X2diX3N1cmZhY2Vf
YmluZChzdHJ1Y3Qgdm13X3Jlc291cmNlICpyZXMsCiAJY21kMS0+aGVhZGVyLmlkID0gU1ZHQV8z
RF9DTURfQklORF9HQl9TVVJGQUNFOwogCWNtZDEtPmhlYWRlci5zaXplID0gc2l6ZW9mKGNtZDEt
PmJvZHkpOwogCWNtZDEtPmJvZHkuc2lkID0gcmVzLT5pZDsKLQljbWQxLT5ib2R5Lm1vYmlkID0g
Ym8tPm1lbS5zdGFydDsKKwljbWQxLT5ib2R5Lm1vYmlkID0gYm8tPnJlc291cmNlLT5zdGFydDsK
IAlpZiAocmVzLT5iYWNrdXBfZGlydHkpIHsKIAkJY21kMiA9ICh2b2lkICopICZjbWQxWzFdOwog
CQljbWQyLT5oZWFkZXIuaWQgPSBTVkdBXzNEX0NNRF9VUERBVEVfR0JfU1VSRkFDRTsKQEAgLTEy
NzIsNyArMTI3Miw3IEBAIHN0YXRpYyBpbnQgdm13X2diX3N1cmZhY2VfdW5iaW5kKHN0cnVjdCB2
bXdfcmVzb3VyY2UgKnJlcywKIAl1aW50OF90ICpjbWQ7CiAKIAotCUJVR19PTihiby0+bWVtLm1l
bV90eXBlICE9IFZNV19QTF9NT0IpOworCUJVR19PTihiby0+cmVzb3VyY2UtPm1lbV90eXBlICE9
IFZNV19QTF9NT0IpOwogCiAJc3VibWl0X3NpemUgPSBzaXplb2YoKmNtZDMpICsgKHJlYWRiYWNr
ID8gc2l6ZW9mKCpjbWQxKSA6IHNpemVvZigqY21kMikpOwogCWNtZCA9IFZNV19DTURfUkVTRVJW
RShkZXZfcHJpdiwgc3VibWl0X3NpemUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Zt
d2dmeC92bXdnZnhfdHRtX2J1ZmZlci5jIGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhf
dHRtX2J1ZmZlci5jCmluZGV4IDJkYzAzMWZlNGE5MC4uYmIxZDQ1M2Y3Y2E2IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF90dG1fYnVmZmVyLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfdHRtX2J1ZmZlci5jCkBAIC03MjQsNyArNzI0LDcgQEAg
c3RhdGljIGludCB2bXdfbW92ZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQkgICAg
c3RydWN0IHR0bV9yZXNvdXJjZSAqbmV3X21lbSwKIAkJICAgIHN0cnVjdCB0dG1fcGxhY2UgKmhv
cCkKIHsKLQlzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm9sZF9tYW4gPSB0dG1fbWFuYWdl
cl90eXBlKGJvLT5iZGV2LCBiby0+bWVtLm1lbV90eXBlKTsKKwlzdHJ1Y3QgdHRtX3Jlc291cmNl
X21hbmFnZXIgKm9sZF9tYW4gPSB0dG1fbWFuYWdlcl90eXBlKGJvLT5iZGV2LCBiby0+cmVzb3Vy
Y2UtPm1lbV90eXBlKTsKIAlzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm5ld19tYW4gPSB0
dG1fbWFuYWdlcl90eXBlKGJvLT5iZGV2LCBuZXdfbWVtLT5tZW1fdHlwZSk7CiAJaW50IHJldDsK
IApAQCAtNzM0LDEwICs3MzQsMTAgQEAgc3RhdGljIGludCB2bXdfbW92ZShzdHJ1Y3QgdHRtX2J1
ZmZlcl9vYmplY3QgKmJvLAogCQkJcmV0dXJuIHJldDsKIAl9CiAKLQl2bXdfbW92ZV9ub3RpZnko
Ym8sICZiby0+bWVtLCBuZXdfbWVtKTsKKwl2bXdfbW92ZV9ub3RpZnkoYm8sIGJvLT5yZXNvdXJj
ZSwgbmV3X21lbSk7CiAKIAlpZiAob2xkX21hbi0+dXNlX3R0ICYmIG5ld19tYW4tPnVzZV90dCkg
ewotCQlpZiAoYm8tPm1lbS5tZW1fdHlwZSA9PSBUVE1fUExfU1lTVEVNKSB7CisJCWlmIChiby0+
cmVzb3VyY2UtPm1lbV90eXBlID09IFRUTV9QTF9TWVNURU0pIHsKIAkJCXR0bV9ib19hc3NpZ25f
bWVtKGJvLCBuZXdfbWVtKTsKIAkJCXJldHVybiAwOwogCQl9CkBAIC03NDYsNyArNzQ2LDcgQEAg
c3RhdGljIGludCB2bXdfbW92ZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQkJZ290
byBmYWlsOwogCiAJCXZtd190dG1fdW5iaW5kKGJvLT5iZGV2LCBiby0+dHRtKTsKLQkJdHRtX3Jl
c291cmNlX2ZyZWUoYm8sICZiby0+bWVtKTsKKwkJdHRtX3Jlc291cmNlX2ZyZWUoYm8sIGJvLT5y
ZXNvdXJjZSk7CiAJCXR0bV9ib19hc3NpZ25fbWVtKGJvLCBuZXdfbWVtKTsKIAkJcmV0dXJuIDA7
CiAJfSBlbHNlIHsKQEAgLTc1Niw3ICs3NTYsNyBAQCBzdGF0aWMgaW50IHZtd19tb3ZlKHN0cnVj
dCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJfQogCXJldHVybiAwOwogZmFpbDoKLQl2bXdfbW92
ZV9ub3RpZnkoYm8sIG5ld19tZW0sICZiby0+bWVtKTsKKwl2bXdfbW92ZV9ub3RpZnkoYm8sIG5l
d19tZW0sIGJvLT5yZXNvdXJjZSk7CiAJcmV0dXJuIHJldDsKIH0KIApkaWZmIC0tZ2l0IGEvaW5j
bHVkZS9kcm0vdHRtL3R0bV9ib19hcGkuaCBiL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmgK
aW5kZXggNjM5NTIxODgwYzI5Li4xODc2YTNkNmRmNzMgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvZHJt
L3R0bS90dG1fYm9fYXBpLmgKKysrIGIvaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19hcGkuaApAQCAt
MTM2LDcgKzEzNiw4IEBAIHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCB7CiAJICogTWVtYmVycyBw
cm90ZWN0ZWQgYnkgdGhlIGJvOjpyZXN2OjpyZXNlcnZlZCBsb2NrLgogCSAqLwogCi0Jc3RydWN0
IHR0bV9yZXNvdXJjZSBtZW07CisJc3RydWN0IHR0bV9yZXNvdXJjZSAqcmVzb3VyY2U7CisJc3Ry
dWN0IHR0bV9yZXNvdXJjZSBfbWVtOwogCXN0cnVjdCB0dG1fdHQgKnR0bTsKIAlib29sIGRlbGV0
ZWQ7CiAKZGlmZiAtLWdpdCBhL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fZHJpdmVyLmggYi9pbmNs
dWRlL2RybS90dG0vdHRtX2JvX2RyaXZlci5oCmluZGV4IGRiY2NhYzk1N2Y4Zi4uMWE5YmEwYjEz
NjIyIDEwMDY0NAotLS0gYS9pbmNsdWRlL2RybS90dG0vdHRtX2JvX2RyaXZlci5oCisrKyBiL2lu
Y2x1ZGUvZHJtL3R0bS90dG1fYm9fZHJpdmVyLmgKQEAgLTE4MSwxNCArMTgxLDE0IEBAIHN0YXRp
YyBpbmxpbmUgdm9pZAogdHRtX2JvX21vdmVfdG9fbHJ1X3RhaWxfdW5sb2NrZWQoc3RydWN0IHR0
bV9idWZmZXJfb2JqZWN0ICpibykKIHsKIAlzcGluX2xvY2soJmJvLT5iZGV2LT5scnVfbG9jayk7
Ci0JdHRtX2JvX21vdmVfdG9fbHJ1X3RhaWwoYm8sICZiby0+bWVtLCBOVUxMKTsKKwl0dG1fYm9f
bW92ZV90b19scnVfdGFpbChibywgYm8tPnJlc291cmNlLCBOVUxMKTsKIAlzcGluX3VubG9jaygm
Ym8tPmJkZXYtPmxydV9sb2NrKTsKIH0KIAogc3RhdGljIGlubGluZSB2b2lkIHR0bV9ib19hc3Np
Z25fbWVtKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJCQkJICAgICBzdHJ1Y3QgdHRt
X3Jlc291cmNlICpuZXdfbWVtKQogewotCWJvLT5tZW0gPSAqbmV3X21lbTsKKwliby0+X21lbSA9
ICpuZXdfbWVtOwogCW5ld19tZW0tPm1tX25vZGUgPSBOVUxMOwogfQogCkBAIC0yMDIsNyArMjAy
LDcgQEAgc3RhdGljIGlubGluZSB2b2lkIHR0bV9ib19hc3NpZ25fbWVtKHN0cnVjdCB0dG1fYnVm
ZmVyX29iamVjdCAqYm8sCiBzdGF0aWMgaW5saW5lIHZvaWQgdHRtX2JvX21vdmVfbnVsbChzdHJ1
Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQkJCSAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlICpu
ZXdfbWVtKQogewotCXN0cnVjdCB0dG1fcmVzb3VyY2UgKm9sZF9tZW0gPSAmYm8tPm1lbTsKKwlz
dHJ1Y3QgdHRtX3Jlc291cmNlICpvbGRfbWVtID0gYm8tPnJlc291cmNlOwogCiAJV0FSTl9PTihv
bGRfbWVtLT5tbV9ub2RlICE9IE5VTEwpOwogCXR0bV9ib19hc3NpZ25fbWVtKGJvLCBuZXdfbWVt
KTsKLS0gCjIuMjUuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Au
b3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRl
dmVsCg==
