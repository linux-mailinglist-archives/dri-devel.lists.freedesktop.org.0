Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 5199510DDBC
	for <lists+dri-devel@lfdr.de>; Sat, 30 Nov 2019 14:24:46 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6DF596E122;
	Sat, 30 Nov 2019 13:24:37 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from alexa-out-blr-02.qualcomm.com (alexa-out-blr-02.qualcomm.com
 [103.229.18.198])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 92A756E892;
 Fri, 29 Nov 2019 06:56:19 +0000 (UTC)
Received: from ironmsg01-blr.qualcomm.com ([10.86.208.130])
 by alexa-out-blr-02.qualcomm.com with ESMTP/TLS/AES256-SHA;
 29 Nov 2019 12:26:15 +0530
Received: from harigovi-linux.qualcomm.com ([10.204.66.147])
 by ironmsg01-blr.qualcomm.com with ESMTP; 29 Nov 2019 12:25:57 +0530
Received: by harigovi-linux.qualcomm.com (Postfix, from userid 2332695)
 id C63072346; Fri, 29 Nov 2019 12:25:56 +0530 (IST)
From: Harigovindan P <harigovi@codeaurora.org>
To: dri-devel@lists.freedesktop.org, linux-arm-msm@vger.kernel.org,
 freedreno@lists.freedesktop.org, devicetree@vger.kernel.org
Subject: [PATCH v1 2/2] drm/panel: add support for rm69299 visionox panel
 driver
Date: Fri, 29 Nov 2019 12:25:45 +0530
Message-Id: <1575010545-25971-3-git-send-email-harigovi@codeaurora.org>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1575010545-25971-1-git-send-email-harigovi@codeaurora.org>
References: <1575010545-25971-1-git-send-email-harigovi@codeaurora.org>
X-Mailman-Approved-At: Sat, 30 Nov 2019 13:23:59 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Harigovindan P <harigovi@codeaurora.org>, abhinavk@codeaurora.org,
 linux-kernel@vger.kernel.org, seanpaul@chromium.org, hoegsberg@chromium.org,
 chandanu@codeaurora.org
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIHN1cHBvcnQgZm9yIFZpc2lvbm94IHBhbmVsIGRyaXZlci4KCkNoYW5nZXMgaW4gdjE6Cgkt
U3BsaXQgb3V0IHBhbmVsIGRyaXZlciBwYXRjaCBmcm9tIGRzaSBjb25maWcgY2hhbmdlcyhSb2Ig
Q2xhcmspLgogICAgICAgIC1SZW1vdmUgdW5yZWxhdGVkIGNvZGUoU3RlcGhlbiBCb3lkKS4KICAg
ICAgICAtUmVtb3ZlIHN0YXRpYyBhcnJheXMgdG8gbWFrZSByZWd1bGF0b3Igc2V0dXAgb3BlbiBj
b2RlZAoJIGluIHByb2JlKFN0ZXBoZW4gQm95ZCkuCiAgICAgICAgLVJlbW92ZSBwcmUtYXNzaWdu
aW5nIHZhcmlhYmxlcyhTdGVwaGVuIEJveWQpLgogICAgICAgIC1JbmxpbmUgcGFuZWxfYWRkIGZ1
bmN0aW9uIGludG8gcHJvYmUoU3RlcGhlbiBCb3lkKS4KICAgICAgICAtVXNlIG1pcGlfZHNpX2Rj
c193cml0ZSBkaXJlY3RseShSb2IgQ2xhcmspLgoJLVJlbW92ZSBxY29tX3JtNjkyOTlfMTA4MHBf
cGFuZWxfbWFnaWNfY21kcyBhcnJheShSb2IgQ2xhcmspLgoKU2lnbmVkLW9mZi1ieTogSGFyaWdv
dmluZGFuIFAgPGhhcmlnb3ZpQGNvZGVhdXJvcmEub3JnPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9w
YW5lbC9LY29uZmlnICAgICAgICAgICAgICAgICAgfCAgIDkgKwogZHJpdmVycy9ncHUvZHJtL3Bh
bmVsL01ha2VmaWxlICAgICAgICAgICAgICAgICB8ICAgMSArCiBkcml2ZXJzL2dwdS9kcm0vcGFu
ZWwvcGFuZWwtdmlzaW9ub3gtcm02OTI5OS5jIHwgNDEyICsrKysrKysrKysrKysrKysrKysrKysr
KysKIDMgZmlsZXMgY2hhbmdlZCwgNDIyIGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2RlIDEwMDc1
NSBkcml2ZXJzL2dwdS9kcm0vcGFuZWwvcGFuZWwtdmlzaW9ub3gtcm02OTI5OS5jCgpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmVsL0tjb25maWcgYi9kcml2ZXJzL2dwdS9kcm0vcGFu
ZWwvS2NvbmZpZwppbmRleCBmMTUyYmM0Li5jMDZjNDAzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vcGFuZWwvS2NvbmZpZworKysgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvS2NvbmZpZwpA
QCAtMzU1LDQgKzM1NSwxMyBAQCBjb25maWcgRFJNX1BBTkVMX1RSVUxZX05UMzU1OTdfV1FYR0EK
IAloZWxwCiAJICBTYXkgWSBoZXJlIGlmIHlvdSB3YW50IHRvIGVuYWJsZSBzdXBwb3J0IGZvciBU
cnVseSBOVDM1NTk3IFdRWEdBIER1YWwgRFNJCiAJICBWaWRlbyBNb2RlIHBhbmVsCisKK2NvbmZp
ZyBEUk1fUEFORUxfVklTSU9OT1hfUk02OTI5OQorCXRyaXN0YXRlICJWaXNpb25veCBSTTY5Mjk5
IgorCWRlcGVuZHMgb24gT0YKKwlkZXBlbmRzIG9uIERSTV9NSVBJX0RTSQorCWhlbHAKKwkgIFNh
eSBZIGhlcmUgaWYgeW91IHdhbnQgdG8gZW5hYmxlIHN1cHBvcnQgZm9yIFZpc2lvbm94CisJICBS
TTY5Mjk5ICBEU0kgVmlkZW8gTW9kZSBwYW5lbC4KKwogZW5kbWVudQpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL3BhbmVsL01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL3BhbmVsL01ha2Vm
aWxlCmluZGV4IGI2Y2QzOWYuLjZmMWU0YzYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9w
YW5lbC9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvTWFrZWZpbGUKQEAgLTM4
LDMgKzM4LDQgQEAgb2JqLSQoQ09ORklHX0RSTV9QQU5FTF9UUE9fVEQwMjhUVEVDMSkgKz0gcGFu
ZWwtdHBvLXRkMDI4dHRlYzEubwogb2JqLSQoQ09ORklHX0RSTV9QQU5FTF9UUE9fVEQwNDNNVEVB
MSkgKz0gcGFuZWwtdHBvLXRkMDQzbXRlYTEubwogb2JqLSQoQ09ORklHX0RSTV9QQU5FTF9UUE9f
VFBHMTEwKSArPSBwYW5lbC10cG8tdHBnMTEwLm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfVFJV
TFlfTlQzNTU5N19XUVhHQSkgKz0gcGFuZWwtdHJ1bHktbnQzNTU5Ny5vCitvYmotJChDT05GSUdf
RFJNX1BBTkVMX1ZJU0lPTk9YX1JNNjkyOTkpICs9IHBhbmVsLXZpc2lvbm94LXJtNjkyOTkubwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLXZpc2lvbm94LXJtNjkyOTku
YyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC12aXNpb25veC1ybTY5Mjk5LmMKbmV3IGZp
bGUgbW9kZSAxMDA3NTUKaW5kZXggMDAwMDAwMC4uZGE4NjcxNAotLS0gL2Rldi9udWxsCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC12aXNpb25veC1ybTY5Mjk5LmMKQEAgLTAsMCAr
MSw0MTIgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisvKgorICogQ29w
eXJpZ2h0IChjKSAyMDE5LCBUaGUgTGludXggRm91bmRhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZl
ZC4KKyAqLworCisjaW5jbHVkZSA8ZHJtL2RybV9wYW5lbC5oPgorI2luY2x1ZGUgPGRybS9kcm1f
bWlwaV9kc2kuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX21vZGVzLmg+CisjaW5jbHVkZSA8ZHJtL2Ry
bV9wcmludC5oPgorCisjaW5jbHVkZSA8bGludXgvZ3Bpby9jb25zdW1lci5oPgorI2luY2x1ZGUg
PGxpbnV4L29mX2RldmljZS5oPgorI2luY2x1ZGUgPGxpbnV4L3JlZ3VsYXRvci9jb25zdW1lci5o
PgorI2luY2x1ZGUgPGxpbnV4L2JhY2tsaWdodC5oPgorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5o
PgorI2luY2x1ZGUgPGxpbnV4L2RlbGF5Lmg+CisKKyNpbmNsdWRlIDx2aWRlby9taXBpX2Rpc3Bs
YXkuaD4KKworc3RydWN0IHJtNjkyOTlfY29uZmlnIHsKKwl1bnNpZ25lZCBsb25nIHdpZHRoX21t
OworCXVuc2lnbmVkIGxvbmcgaGVpZ2h0X21tOworCWNvbnN0IGNoYXIgKnBhbmVsX25hbWU7CisJ
dTMyIG51bV9vbl9jbWRzOworCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICpkbTsKK307
CisKK3N0cnVjdCB2aXNpb25veF9ybTY5Mjk5IHsKKwlzdHJ1Y3QgZGV2aWNlICpkZXY7CisJc3Ry
dWN0IGRybV9wYW5lbCBwYW5lbDsKKworCXN0cnVjdCByZWd1bGF0b3JfYnVsa19kYXRhIHN1cHBs
aWVzWzJdOworCisJc3RydWN0IGdwaW9fZGVzYyAqcmVzZXRfZ3BpbzsKKworCXN0cnVjdCBiYWNr
bGlnaHRfZGV2aWNlICpiYWNrbGlnaHQ7CisKKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2k7
CisJY29uc3Qgc3RydWN0IHJtNjkyOTlfY29uZmlnICpjb25maWc7CisJYm9vbCBwcmVwYXJlZDsK
Kwlib29sIGVuYWJsZWQ7Cit9OworCitzdGF0aWMgaW5saW5lIHN0cnVjdCB2aXNpb25veF9ybTY5
Mjk5ICpwYW5lbF90b19jdHgoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwpCit7CisJcmV0dXJuIGNv
bnRhaW5lcl9vZihwYW5lbCwgc3RydWN0IHZpc2lvbm94X3JtNjkyOTksIHBhbmVsKTsKK30KKwor
c3RhdGljIGludCB2aXNpb25veF8zNTU5N19wb3dlcl9vbihzdHJ1Y3QgdmlzaW9ub3hfcm02OTI5
OSAqY3R4KQoreworCWludCByZXQ7CisKKwlyZXQgPSByZWd1bGF0b3Jfc2V0X2xvYWQoY3R4LT5z
dXBwbGllc1swXS5jb25zdW1lciwgMzIwMDApOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisK
KwlyZXQgPSByZWd1bGF0b3Jfc2V0X2xvYWQoY3R4LT5zdXBwbGllc1sxXS5jb25zdW1lciwgMTMy
MDApOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwlyZXQgPSByZWd1bGF0b3JfYnVsa19l
bmFibGUoQVJSQVlfU0laRShjdHgtPnN1cHBsaWVzKSwgY3R4LT5zdXBwbGllcyk7CisJaWYgKHJl
dCA8IDApCisJCXJldHVybiByZXQ7CisKKwkvKgorCSAqIFJlc2V0IHNlcXVlbmNlIG9mIHZpc2lv
bm94IHBhbmVsIHJlcXVpcmVzIHRoZSBwYW5lbCB0byBiZQorCSAqIG91dCBvZiByZXNldCBmb3Ig
MTBtcywgZm9sbG93ZWQgYnkgYmVpbmcgaGVsZCBpbiByZXNldAorCSAqIGZvciAxMG1zIGFuZCB0
aGVuIG91dCBhZ2FpbgorCSAqLworCWdwaW9kX3NldF92YWx1ZShjdHgtPnJlc2V0X2dwaW8sIDEp
OworCXVzbGVlcF9yYW5nZSgxMDAwMCwgMjAwMDApOworCWdwaW9kX3NldF92YWx1ZShjdHgtPnJl
c2V0X2dwaW8sIDApOworCXVzbGVlcF9yYW5nZSgxMDAwMCwgMjAwMDApOworCWdwaW9kX3NldF92
YWx1ZShjdHgtPnJlc2V0X2dwaW8sIDEpOworCXVzbGVlcF9yYW5nZSgxMDAwMCwgMjAwMDApOwor
CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgdmlzaW9ub3hfcm02OTI5OV9wb3dlcl9vZmYo
c3RydWN0IHZpc2lvbm94X3JtNjkyOTkgKmN0eCkKK3sKKwlpbnQgcmV0OworCisJZ3Bpb2Rfc2V0
X3ZhbHVlKGN0eC0+cmVzZXRfZ3BpbywgMCk7CisKKwlyZXQgPSByZWd1bGF0b3Jfc2V0X2xvYWQo
Y3R4LT5zdXBwbGllc1swXS5jb25zdW1lciwgODApOworCisJaWYgKHJldCkgeworCQlEUk1fREVW
X0VSUk9SKGN0eC0+ZGV2LAorCQkJInJlZ3VsYXRvcl9zZXRfbG9hZCBmYWlsZWQgJWRcbiIsIHJl
dCk7CisJCXJldHVybiByZXQ7CisJfQorCisJcmV0ID0gcmVndWxhdG9yX3NldF9sb2FkKGN0eC0+
c3VwcGxpZXNbMV0uY29uc3VtZXIsIDgwKTsKKworCWlmIChyZXQpIHsKKwkJRFJNX0RFVl9FUlJP
UihjdHgtPmRldiwKKwkJCSJyZWd1bGF0b3Jfc2V0X2xvYWQgZmFpbGVkICVkXG4iLCByZXQpOwor
CQlyZXR1cm4gcmV0OworCX0KKworCXJldCA9IHJlZ3VsYXRvcl9idWxrX2Rpc2FibGUoQVJSQVlf
U0laRShjdHgtPnN1cHBsaWVzKSwgY3R4LT5zdXBwbGllcyk7CisJaWYgKHJldCkgeworCQlEUk1f
REVWX0VSUk9SKGN0eC0+ZGV2LAorCQkJInJlZ3VsYXRvcl9idWxrX2Rpc2FibGUgZmFpbGVkICVk
XG4iLCByZXQpOworCX0KKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IHZpc2lvbm94X3Jt
NjkyOTlfZGlzYWJsZShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKK3sKKwlzdHJ1Y3QgdmlzaW9u
b3hfcm02OTI5OSAqY3R4ID0gcGFuZWxfdG9fY3R4KHBhbmVsKTsKKwlpbnQgcmV0OworCisJaWYg
KCFjdHgtPmVuYWJsZWQpCisJCXJldHVybiAwOworCisJcmV0ID0gYmFja2xpZ2h0X2Rpc2FibGUo
Y3R4LT5iYWNrbGlnaHQpOworCWlmIChyZXQgPCAwKQorCQlEUk1fREVWX0VSUk9SKGN0eC0+ZGV2
LCAiYmFja2xpZ2h0IGRpc2FibGUgZmFpbGVkICVkXG4iLAorCQlyZXQpOworCisJY3R4LT5lbmFi
bGVkID0gZmFsc2U7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgdmlzaW9ub3hfcm02OTI5
OV91bnByZXBhcmUoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwpCit7CisJc3RydWN0IHZpc2lvbm94
X3JtNjkyOTkgKmN0eCA9IHBhbmVsX3RvX2N0eChwYW5lbCk7CisJaW50IHJldDsKKworCWlmICgh
Y3R4LT5wcmVwYXJlZCkKKwkJcmV0dXJuIDA7CisKKwljdHgtPmRzaS0+bW9kZV9mbGFncyA9IDA7
CisKKwlyZXQgPSBtaXBpX2RzaV9kY3Nfd3JpdGUoY3R4LT5kc2ksIE1JUElfRENTX1NFVF9ESVNQ
TEFZX09GRiwgTlVMTCwgMCk7CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihjdHgt
PmRldiwKKwkJCSJzZXRfZGlzcGxheV9vZmYgY21kIGZhaWxlZCByZXQgPSAlZFxuIiwKKwkJCXJl
dCk7CisJfQorCisJLyogMTIwbXMgZGVsYXkgcmVxdWlyZWQgaGVyZSBhcyBwZXIgRENTIHNwZWMg
Ki8KKwltc2xlZXAoMTIwKTsKKworCXJldCA9IG1pcGlfZHNpX2Rjc193cml0ZShjdHgtPmRzaSwg
TUlQSV9EQ1NfRU5URVJfU0xFRVBfTU9ERSwgTlVMTCwgMCk7CisJaWYgKHJldCA8IDApIHsKKwkJ
RFJNX0RFVl9FUlJPUihjdHgtPmRldiwKKwkJCSJlbnRlcl9zbGVlcCBjbWQgZmFpbGVkIHJldCA9
ICVkXG4iLCByZXQpOworCX0KKworCXJldCA9IHZpc2lvbm94X3JtNjkyOTlfcG93ZXJfb2ZmKGN0
eCk7CisJaWYgKHJldCA8IDApCisJCURSTV9ERVZfRVJST1IoY3R4LT5kZXYsICJwb3dlcl9vZmYg
ZmFpbGVkIHJldCA9ICVkXG4iLCByZXQpOworCisJY3R4LT5wcmVwYXJlZCA9IGZhbHNlOworCXJl
dHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgdmlzaW9ub3hfcm02OTI5OV9wcmVwYXJlKHN0cnVj
dCBkcm1fcGFuZWwgKnBhbmVsKQoreworCXN0cnVjdCB2aXNpb25veF9ybTY5Mjk5ICpjdHggPSBw
YW5lbF90b19jdHgocGFuZWwpOworCWludCByZXQ7CisJY29uc3Qgc3RydWN0IHJtNjkyOTlfY29u
ZmlnICpjb25maWc7CisKKwlpZiAoY3R4LT5wcmVwYXJlZCkKKwkJcmV0dXJuIDA7CisKKwlyZXQg
PSB2aXNpb25veF8zNTU5N19wb3dlcl9vbihjdHgpOworCWlmIChyZXQgPCAwKQorCQlyZXR1cm4g
cmV0OworCisJY3R4LT5kc2ktPm1vZGVfZmxhZ3MgfD0gTUlQSV9EU0lfTU9ERV9MUE07CisKKwlj
b25maWcgPSBjdHgtPmNvbmZpZzsKKworCXJldCA9IG1pcGlfZHNpX2Rjc193cml0ZV9idWZmZXIo
Y3R4LT5kc2ksICh1OFtdKXsgMHhmZSwgMHgwMCB9LCAyKTsKKwlpZiAocmV0IDwgMCkgeworCQlE
Uk1fREVWX0VSUk9SKGN0eC0+ZGV2LAorCQkiY21kIHNldCB0eCAwIGZhaWxlZCwgcmV0ID0gJWRc
biIsCisJCXJldCk7CisJCWdvdG8gcG93ZXJfb2ZmOworCX0KKworCXJldCA9IG1pcGlfZHNpX2Rj
c193cml0ZV9idWZmZXIoY3R4LT5kc2ksICh1OFtdKXsgMHhjMiwgMHgwOCB9LCAyKTsKKwlpZiAo
cmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGN0eC0+ZGV2LAorCQkiY21kIHNldCB0eCAxIGZh
aWxlZCwgcmV0ID0gJWRcbiIsCisJCXJldCk7CisJCWdvdG8gcG93ZXJfb2ZmOworCX0KKworCXJl
dCA9IG1pcGlfZHNpX2Rjc193cml0ZV9idWZmZXIoY3R4LT5kc2ksICh1OFtdKXsgMHgzNSwgMHgw
MCB9LCAyKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGN0eC0+ZGV2LAorCQki
Y21kIHNldCB0eCAyIGZhaWxlZCwgcmV0ID0gJWRcbiIsCisJCXJldCk7CisJCWdvdG8gcG93ZXJf
b2ZmOworCX0KKworCXJldCA9IG1pcGlfZHNpX2Rjc193cml0ZV9idWZmZXIoY3R4LT5kc2ksICh1
OFtdKXsgMHg1MSwgMHhmZiB9LCAyKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9S
KGN0eC0+ZGV2LAorCQkiY21kIHNldCB0eCAzIGZhaWxlZCwgcmV0ID0gJWRcbiIsCisJCXJldCk7
CisJCWdvdG8gcG93ZXJfb2ZmOworCX0KKworCXJldCA9IG1pcGlfZHNpX2Rjc193cml0ZShjdHgt
PmRzaSwgTUlQSV9EQ1NfRVhJVF9TTEVFUF9NT0RFLCBOVUxMLCAwKTsKKwlpZiAocmV0IDwgMCkg
eworCQlEUk1fREVWX0VSUk9SKGN0eC0+ZGV2LAorCQkJImV4aXRfc2xlZXBfbW9kZSBjbWQgZmFp
bGVkIHJldCA9ICVkXG4iLAorCQkJcmV0KTsKKwkJZ290byBwb3dlcl9vZmY7CisJfQorCisJLyog
UGVyIERTSSBzcGVjIHdhaXQgMTIwbXMgYWZ0ZXIgc2VuZGluZyBleGl0IHNsZWVwIERDUyBjb21t
YW5kICovCisJbXNsZWVwKDEyMCk7CisKKwlyZXQgPSBtaXBpX2RzaV9kY3Nfd3JpdGUoY3R4LT5k
c2ksIE1JUElfRENTX1NFVF9ESVNQTEFZX09OLCBOVUxMLCAwKTsKKwlpZiAocmV0IDwgMCkgewor
CQlEUk1fREVWX0VSUk9SKGN0eC0+ZGV2LAorCQkJInNldF9kaXNwbGF5X29uIGNtZCBmYWlsZWQg
cmV0ID0gJWRcbiIsIHJldCk7CisJCWdvdG8gcG93ZXJfb2ZmOworCX0KKworCS8qIFBlciBEU0kg
c3BlYyB3YWl0IDEyMG1zIGFmdGVyIHNlbmRpbmcgc2V0X2Rpc3BsYXlfb24gRENTIGNvbW1hbmQg
Ki8KKwltc2xlZXAoMTIwKTsKKworCWN0eC0+cHJlcGFyZWQgPSB0cnVlOworCisJcmV0dXJuIDA7
CisKK3Bvd2VyX29mZjoKKwlpZiAodmlzaW9ub3hfcm02OTI5OV9wb3dlcl9vZmYoY3R4KSkKKwkJ
RFJNX0RFVl9FUlJPUihjdHgtPmRldiwgInBvd2VyX29mZiBmYWlsZWRcbiIpOworCXJldHVybiBy
ZXQ7Cit9CisKK3N0YXRpYyBpbnQgdmlzaW9ub3hfcm02OTI5OV9lbmFibGUoc3RydWN0IGRybV9w
YW5lbCAqcGFuZWwpCit7CisJc3RydWN0IHZpc2lvbm94X3JtNjkyOTkgKmN0eCA9IHBhbmVsX3Rv
X2N0eChwYW5lbCk7CisJaW50IHJldDsKKworCWlmIChjdHgtPmVuYWJsZWQpCisJCXJldHVybiAw
OworCisJcmV0ID0gYmFja2xpZ2h0X2VuYWJsZShjdHgtPmJhY2tsaWdodCk7CisJaWYgKHJldCA8
IDApCisJCURSTV9ERVZfRVJST1IoY3R4LT5kZXYsICJiYWNrbGlnaHQgZW5hYmxlIGZhaWxlZCAl
ZFxuIiwKKwkJcmV0KTsKKworCWN0eC0+ZW5hYmxlZCA9IHRydWU7CisKKwlyZXR1cm4gMDsKK30K
Kworc3RhdGljIGludCB2aXNpb25veF9ybTY5Mjk5X2dldF9tb2RlcyhzdHJ1Y3QgZHJtX3BhbmVs
ICpwYW5lbCkKK3sKKwlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gcGFuZWwtPmNv
bm5lY3RvcjsKKwlzdHJ1Y3QgdmlzaW9ub3hfcm02OTI5OSAqY3R4ID0gcGFuZWxfdG9fY3R4KHBh
bmVsKTsKKwlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZTsKKwljb25zdCBzdHJ1Y3Qgcm02
OTI5OV9jb25maWcgKmNvbmZpZzsKKworCWNvbmZpZyA9IGN0eC0+Y29uZmlnOworCW1vZGUgPSBk
cm1fbW9kZV9jcmVhdGUoY29ubmVjdG9yLT5kZXYpOworCWlmICghbW9kZSkgeworCQlEUk1fREVW
X0VSUk9SKGN0eC0+ZGV2LAorCQkJImZhaWxlZCB0byBjcmVhdGUgYSBuZXcgZGlzcGxheSBtb2Rl
XG4iKTsKKwkJcmV0dXJuIDA7CisJfQorCisJY29ubmVjdG9yLT5kaXNwbGF5X2luZm8ud2lkdGhf
bW0gPSBjb25maWctPndpZHRoX21tOworCWNvbm5lY3Rvci0+ZGlzcGxheV9pbmZvLmhlaWdodF9t
bSA9IGNvbmZpZy0+aGVpZ2h0X21tOworCWRybV9tb2RlX2NvcHkobW9kZSwgY29uZmlnLT5kbSk7
CisJbW9kZS0+dHlwZSA9IERSTV9NT0RFX1RZUEVfRFJJVkVSIHwgRFJNX01PREVfVFlQRV9QUkVG
RVJSRUQ7CisJZHJtX21vZGVfcHJvYmVkX2FkZChjb25uZWN0b3IsIG1vZGUpOworCisJcmV0dXJu
IDE7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX3BhbmVsX2Z1bmNzIHZpc2lvbm94X3Jt
NjkyOTlfZHJtX2Z1bmNzID0geworCS5kaXNhYmxlID0gdmlzaW9ub3hfcm02OTI5OV9kaXNhYmxl
LAorCS51bnByZXBhcmUgPSB2aXNpb25veF9ybTY5Mjk5X3VucHJlcGFyZSwKKwkucHJlcGFyZSA9
IHZpc2lvbm94X3JtNjkyOTlfcHJlcGFyZSwKKwkuZW5hYmxlID0gdmlzaW9ub3hfcm02OTI5OV9l
bmFibGUsCisJLmdldF9tb2RlcyA9IHZpc2lvbm94X3JtNjkyOTlfZ2V0X21vZGVzLAorfTsKKwor
c3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlIHFjb21fc2M3MTgwX210cF8xMDgw
cF9tb2RlID0geworCS5uYW1lID0gIjEwODB4MjI0OCIsCisJLmNsb2NrID0gMTU4Njk1LAorCS5o
ZGlzcGxheSA9IDEwODAsCisJLmhzeW5jX3N0YXJ0ID0gMTA4MCArIDI2LAorCS5oc3luY19lbmQg
PSAxMDgwICsgMjYgKyAyLAorCS5odG90YWwgPSAxMDgwICsgMjYgKyAyICsgMzYsCisJLnZkaXNw
bGF5ID0gMjI0OCwKKwkudnN5bmNfc3RhcnQgPSAyMjQ4ICsgNTYsCisJLnZzeW5jX2VuZCA9IDIy
NDggKyA1NiArIDQsCisJLnZ0b3RhbCA9IDIyNDggKyA1NiArIDQgKyA0LAorCS52cmVmcmVzaCA9
IDYwLAorCS5mbGFncyA9IDAsCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IHJtNjkyOTlfY29u
ZmlnIHJtNjkyOTlfZGlyID0geworCS53aWR0aF9tbSA9IDc0LAorCS5oZWlnaHRfbW0gPSAxMzEs
CisJLnBhbmVsX25hbWUgPSAicWNvbV9zYzcxODBfbXRwXzEwODBwX3BhbmVsIiwKKwkuZG0gPSAm
cWNvbV9zYzcxODBfbXRwXzEwODBwX21vZGUsCit9OworCitzdGF0aWMgaW50IHZpc2lvbm94X3Jt
NjkyOTlfcHJvYmUoc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpKQoreworCXN0cnVjdCBkZXZp
Y2UgKmRldiA9ICZkc2ktPmRldjsKKwlzdHJ1Y3QgZGV2aWNlICpkZXZpY2U7CisJc3RydWN0IHZp
c2lvbm94X3JtNjkyOTkgKmN0eDsKKwljb25zdCBzdHJ1Y3Qgcm02OTI5OV9jb25maWcgKmNvbmZp
ZzsKKwlpbnQgcmV0OworCisJY3R4ID0gZGV2bV9remFsbG9jKGRldiwgc2l6ZW9mKCpjdHgpLCBH
RlBfS0VSTkVMKTsKKworCWlmICghY3R4KQorCQlyZXR1cm4gLUVOT01FTTsKKworCWN0eC0+Y29u
ZmlnID0gZGV2aWNlX2dldF9tYXRjaF9kYXRhKGRldik7CisKKwlpZiAoIWN0eC0+Y29uZmlnKSB7
CisJCWRldl9lcnIoZGV2LCAibWlzc2luZyBkZXZpY2UgY29uZmlndXJhdGlvblxuIik7CisJCXJl
dHVybiAtRU5PREVWOworCX0KKworCW1pcGlfZHNpX3NldF9kcnZkYXRhKGRzaSwgY3R4KTsKKwor
CWN0eC0+ZGV2ID0gZGV2OworCWN0eC0+ZHNpID0gZHNpOworCisJZGV2aWNlID0gY3R4LT5kZXY7
CisKKwljb25maWcgPSBjdHgtPmNvbmZpZzsKKwljdHgtPnN1cHBsaWVzWzBdLnN1cHBseSA9ICJ2
ZGRhIjsKKwljdHgtPnN1cHBsaWVzWzFdLnN1cHBseSA9ICJ2ZGQzcDMiOworCisJcmV0ID0gZGV2
bV9yZWd1bGF0b3JfYnVsa19nZXQoZGV2aWNlLCBBUlJBWV9TSVpFKGN0eC0+c3VwcGxpZXMpLAor
CQkJCQkJCQljdHgtPnN1cHBsaWVzKTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0dXJuIHJldDsKKwor
CWN0eC0+cmVzZXRfZ3BpbyA9IGRldm1fZ3Bpb2RfZ2V0KGRldmljZSwgInJlc2V0IiwgR1BJT0Rf
T1VUX0xPVyk7CisJaWYgKElTX0VSUihjdHgtPnJlc2V0X2dwaW8pKSB7CisJCURSTV9ERVZfRVJS
T1IoZGV2LCAiY2Fubm90IGdldCByZXNldCBncGlvICVsZFxuIiwKKwkJCQkJUFRSX0VSUihjdHgt
PnJlc2V0X2dwaW8pKTsKKwkJcmV0dXJuIFBUUl9FUlIoY3R4LT5yZXNldF9ncGlvKTsKKwl9CisK
Kwlkcm1fcGFuZWxfaW5pdCgmY3R4LT5wYW5lbCk7CisJY3R4LT5wYW5lbC5kZXYgPSBkZXZpY2U7
CisJY3R4LT5wYW5lbC5mdW5jcyA9ICZ2aXNpb25veF9ybTY5Mjk5X2RybV9mdW5jczsKKwlkcm1f
cGFuZWxfYWRkKCZjdHgtPnBhbmVsKTsKKworCWRzaS0+bGFuZXMgPSA0OworCWRzaS0+Zm9ybWF0
ID0gTUlQSV9EU0lfRk1UX1JHQjg4ODsKKwlkc2ktPm1vZGVfZmxhZ3MgPSBNSVBJX0RTSV9NT0RF
X1ZJREVPIHwgTUlQSV9EU0lfTU9ERV9MUE0gfAorCQlNSVBJX0RTSV9DTE9DS19OT05fQ09OVElO
VU9VUzsKKwlyZXQgPSBtaXBpX2RzaV9hdHRhY2goZHNpKTsKKwlpZiAocmV0IDwgMCkgeworCQlE
Uk1fREVWX0VSUk9SKGRldiwKKwkJCSJkc2kgYXR0YWNoIGZhaWxlZCByZXQgPSAlZFxuIiwgcmV0
KTsKKwkJZ290byBlcnJfZHNpX2F0dGFjaDsKKwl9CisKKwlyZXR1cm4gMDsKKworZXJyX2RzaV9h
dHRhY2g6CisJZHJtX3BhbmVsX3JlbW92ZSgmY3R4LT5wYW5lbCk7CisJcmV0dXJuIHJldDsKK30K
Kworc3RhdGljIGludCB2aXNpb25veF9ybTY5Mjk5X3JlbW92ZShzdHJ1Y3QgbWlwaV9kc2lfZGV2
aWNlICpkc2kpCit7CisJc3RydWN0IHZpc2lvbm94X3JtNjkyOTkgKmN0eCA9IG1pcGlfZHNpX2dl
dF9kcnZkYXRhKGRzaSk7CisKKwlpZiAoY3R4LT5kc2kpIHsKKwkJbWlwaV9kc2lfZGV0YWNoKGN0
eC0+ZHNpKTsKKwkJbWlwaV9kc2lfZGV2aWNlX3VucmVnaXN0ZXIoY3R4LT5kc2kpOworCX0KKwor
CWRybV9wYW5lbF9yZW1vdmUoJmN0eC0+cGFuZWwpOworCXJldHVybiAwOworfQorCitzdGF0aWMg
Y29uc3Qgc3RydWN0IG9mX2RldmljZV9pZCB2aXNpb25veF9ybTY5Mjk5X29mX21hdGNoW10gPSB7
CisJeworCQkuY29tcGF0aWJsZSA9ICJ2aXNpb25veCxybTY5Mjk5LTEwODBwLWRpc3BsYXkiLAor
CQkuZGF0YSA9ICZybTY5Mjk5X2RpciwKKwl9LAorCXsgfQorfTsKK01PRFVMRV9ERVZJQ0VfVEFC
TEUob2YsIHZpc2lvbm94X3JtNjkyOTlfb2ZfbWF0Y2gpOworCitzdGF0aWMgc3RydWN0IG1pcGlf
ZHNpX2RyaXZlciB2aXNpb25veF9ybTY5Mjk5X2RyaXZlciA9IHsKKwkuZHJpdmVyID0geworCQku
bmFtZSA9ICJwYW5lbC12aXNpb25veC1ybTY5Mjk5IiwKKwkJLm9mX21hdGNoX3RhYmxlID0gdmlz
aW9ub3hfcm02OTI5OV9vZl9tYXRjaCwKKwl9LAorCS5wcm9iZSA9IHZpc2lvbm94X3JtNjkyOTlf
cHJvYmUsCisJLnJlbW92ZSA9IHZpc2lvbm94X3JtNjkyOTlfcmVtb3ZlLAorfTsKK21vZHVsZV9t
aXBpX2RzaV9kcml2ZXIodmlzaW9ub3hfcm02OTI5OV9kcml2ZXIpOworCitNT0RVTEVfREVTQ1JJ
UFRJT04oIlZJU0lPTk9YIFJNNjkyOTkgRFNJIFBhbmVsIERyaXZlciIpOworTU9EVUxFX0xJQ0VO
U0UoIkdQTCB2MiIpOwotLSAKMi43LjQKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZy
ZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3Rp
bmZvL2RyaS1kZXZlbA==
