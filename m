Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id F3C08107DCE
	for <lists+dri-devel@lfdr.de>; Sat, 23 Nov 2019 09:57:07 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2BE006E051;
	Sat, 23 Nov 2019 08:57:05 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
X-Greylist: delayed 464 seconds by postgrey-1.36 at gabe;
 Sat, 23 Nov 2019 08:57:04 UTC
Received: from asavdk4.altibox.net (asavdk4.altibox.net [109.247.116.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2D8F06E051
 for <dri-devel@lists.freedesktop.org>; Sat, 23 Nov 2019 08:57:04 +0000 (UTC)
Received: from ravnborg.org (unknown [158.248.194.18])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested)
 by asavdk4.altibox.net (Postfix) with ESMTPS id D88CB80566;
 Sat, 23 Nov 2019 09:56:59 +0100 (CET)
Date: Sat, 23 Nov 2019 09:56:58 +0100
From: Sam Ravnborg <sam@ravnborg.org>
To: Thomas Zimmermann <tzimmermann@suse.de>
Subject: Re: [PATCH 3/4] drm/hisilicon/hibmc: Implement hibmc_dumb_create()
 with generic helpers
Message-ID: <20191123085658.GB17899@ravnborg.org>
References: <20191122083044.6627-1-tzimmermann@suse.de>
 <20191122083044.6627-4-tzimmermann@suse.de>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <20191122083044.6627-4-tzimmermann@suse.de>
User-Agent: Mutt/1.10.1 (2018-07-13)
X-CMAE-Score: 0
X-CMAE-Analysis: v=2.3 cv=VcLZwmh9 c=1 sm=1 tr=0
 a=UWs3HLbX/2nnQ3s7vZ42gw==:117 a=UWs3HLbX/2nnQ3s7vZ42gw==:17
 a=jpOVt7BSZ2e4Z31A5e1TngXxSK0=:19 a=kj9zAlcOel0A:10
 a=J0-AY567FrCJv8lAIl0A:9 a=CjuIK1q_8ugA:10 a=pHzHmUro8NiASowvMSCR:22
 a=Ew2E2A-JSTLzCXPT_086:22
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: yuehaibing@huawei.com, airlied@linux.ie, puck.chen@hisilicon.com,
 dri-devel@lists.freedesktop.org, z.liuxinliang@hisilicon.com,
 kong.kongxinwei@hisilicon.com, hslester96@gmail.com, kraxel@redhat.com,
 zourongrong@gmail.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SGkgVGhvbWFzLgoKQ2hhbmdlIGxvb2tzIGdvb2QuIElmIHlvdSBzcGluIHRoaXMgY291bGQgeW91
IG1vdmUgdGhlCmNoYW5nZXMgdG8gZ2VuZXJpYyBkcm0gY29kZSB0byBhIHNlcGFyYXRlIHBhdGNo
PwpBcyBpdCBpcyBub3cgaXQgaXMgaGlkZGVuIGZvciBtb3N0LgpCdXQgdGhlbiB0aGVyZSBhcmUg
YWxzbyBubyB1c2VycyBvZiBkcm1fZ2VtX3ZyYW1fZmlsbF9jcmVhdGVfZHVtYigpCgpPbmUgc21h
bGwgbml0IGJlbG93IHRoYXQgeW91IGNhbiBzYWZlbHkgaWdub3JlIDotKQoKCglTYW0KCgpPbiBG
cmksIE5vdiAyMiwgMjAxOSBhdCAwOTozMDo0M0FNICswMTAwLCBUaG9tYXMgWmltbWVybWFubiB3
cm90ZToKPiBUaGUgaGlibWMgZHJpdmVyIGFsaWducyBzY2FubGluZXMgdG8gMTYgYnl0ZXMuIEFk
ZGluZyB0aGUgcGl0Y2ggYWxpZ25tZW50Cj4gYXMgYW4gYXJndW1lbnQgdG8gZHJtX2dlbV92cmFt
X2ZpbGxfY3JlYXRlX2R1bWIoKSBhbGxvd3MgdG8gdXNlIHRoZSBnZW5lcmljCj4gaW1wbGVtZW50
YXRpb24gd2l0aCBoaWJtYy4gQSB2YWx1ZSBvZiAwIGRpc2FibGVzIHNjYW5saW5lIHBpdGNoZXMu
Cj4gCj4gU2lnbmVkLW9mZi1ieTogVGhvbWFzIFppbW1lcm1hbm4gPHR6aW1tZXJtYW5uQHN1c2Uu
ZGU+Cj4gLS0tCj4gIGRyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMgICAgICAg
ICB8IDEwICsrLS0KPiAgLi4uL2dwdS9kcm0vaGlzaWxpY29uL2hpYm1jL2hpYm1jX2RybV9kcnYu
aCAgIHwgIDQgLS0KPiAgZHJpdmVycy9ncHUvZHJtL2hpc2lsaWNvbi9oaWJtYy9oaWJtY190dG0u
YyAgIHwgNDggKy0tLS0tLS0tLS0tLS0tLS0tLQo+ICBpbmNsdWRlL2RybS9kcm1fZ2VtX3ZyYW1f
aGVscGVyLmggICAgICAgICAgICAgfCAgMSArCj4gIDQgZmlsZXMgY2hhbmdlZCwgMTAgaW5zZXJ0
aW9ucygrKSwgNTMgZGVsZXRpb25zKC0pCj4gCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX2dlbV92cmFtX2hl
bHBlci5jCj4gaW5kZXggNjY2Y2I0YzIyYmI5Li5mMDk4Nzg0ZTdkZmQgMTAwNjQ0Cj4gLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2RybV9nZW1fdnJhbV9oZWxwZXIuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1
L2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMKPiBAQCAtNDg1LDYgKzQ4NSw3IEBAIEVYUE9SVF9T
WU1CT0woZHJtX2dlbV92cmFtX3Z1bm1hcCk7Cj4gICAqIEBkZXY6CQl0aGUgRFJNIGRldmljZQo+
ICAgKiBAYmRldjoJCXRoZSBUVE0gQk8gZGV2aWNlIG1hbmFnaW5nIHRoZSBidWZmZXIgb2JqZWN0
Cj4gICAqIEBwZ19hbGlnbjoJCXRoZSBidWZmZXIncyBhbGlnbm1lbnQgaW4gbXVsdGlwbGVzIG9m
IHRoZSBwYWdlIHNpemUKPiArICogQHBpdGNoX2FsaWduOgl0aGUgc2NhbmxpbmUncyBhbGlnbm1l
bnQgaW4gcG93ZXJzIG9mIDIKPiAgICogQGludGVycnVwdGlibGU6CXNsZWVwIGludGVycnVwdGli
bGUgaWYgd2FpdGluZyBmb3IgbWVtb3J5Cj4gICAqIEBhcmdzOgkJdGhlIGFyZ3VtZW50cyBhcyBw
cm92aWRlZCB0byBcCj4gIAkJCQkmc3RydWN0IGRybV9kcml2ZXIuZHVtYl9jcmVhdGUKPiBAQCAt
NTAyLDYgKzUwMyw3IEBAIGludCBkcm1fZ2VtX3ZyYW1fZmlsbF9jcmVhdGVfZHVtYihzdHJ1Y3Qg
ZHJtX2ZpbGUgKmZpbGUsCj4gIAkJCQkgIHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gIAkJCQkg
IHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAo+ICAJCQkJICB1bnNpZ25lZCBsb25nIHBnX2Fs
aWduLAo+ICsJCQkJICB1bnNpZ25lZCBsb25nIHBpdGNoX2FsaWduLAo+ICAJCQkJICBib29sIGlu
dGVycnVwdGlibGUsCj4gIAkJCQkgIHN0cnVjdCBkcm1fbW9kZV9jcmVhdGVfZHVtYiAqYXJncykK
PiAgewo+IEBAIC01MTAsNyArNTEyLDkgQEAgaW50IGRybV9nZW1fdnJhbV9maWxsX2NyZWF0ZV9k
dW1iKHN0cnVjdCBkcm1fZmlsZSAqZmlsZSwKPiAgCWludCByZXQ7Cj4gIAl1MzIgaGFuZGxlOwo+
ICAKPiAtCXBpdGNoID0gYXJncy0+d2lkdGggKiAoKGFyZ3MtPmJwcCArIDcpIC8gOCk7Cj4gKwlw
aXRjaCA9IGFyZ3MtPndpZHRoICogRElWX1JPVU5EX1VQKGFyZ3MtPmJwcCwgOCk7ClNlbWkgcmVs
YXRlZCBjaGFuZ2UuLi4KCj4gKwlpZiAocGl0Y2hfYWxpZ24pCj4gKwkJcGl0Y2ggPSBBTElHTihw
aXRjaCwgcGl0Y2hfYWxpZ24pOwo+ICAJc2l6ZSA9IHBpdGNoICogYXJncy0+aGVpZ2h0Owo+ICAK
PiAgCXNpemUgPSByb3VuZHVwKHNpemUsIFBBR0VfU0laRSk7Cj4gQEAgLTYxMiw4ICs2MTYsOCBA
QCBpbnQgZHJtX2dlbV92cmFtX2RyaXZlcl9kdW1iX2NyZWF0ZShzdHJ1Y3QgZHJtX2ZpbGUgKmZp
bGUsCj4gIAlpZiAoV0FSTl9PTkNFKCFkZXYtPnZyYW1fbW0sICJWUkFNIE1NIG5vdCBpbml0aWFs
aXplZCIpKQo+ICAJCXJldHVybiAtRUlOVkFMOwo+ICAKPiAtCXJldHVybiBkcm1fZ2VtX3ZyYW1f
ZmlsbF9jcmVhdGVfZHVtYihmaWxlLCBkZXYsICZkZXYtPnZyYW1fbW0tPmJkZXYsIDAsCj4gLQkJ
CQkJICAgICBmYWxzZSwgYXJncyk7Cj4gKwlyZXR1cm4gZHJtX2dlbV92cmFtX2ZpbGxfY3JlYXRl
X2R1bWIoZmlsZSwgZGV2LCAmZGV2LT52cmFtX21tLT5iZGV2LAo+ICsJCQkJCSAgICAgMCwgMCwg
ZmFsc2UsIGFyZ3MpOwo+ICB9Cj4gIEVYUE9SVF9TWU1CT0woZHJtX2dlbV92cmFtX2RyaXZlcl9k
dW1iX2NyZWF0ZSk7Cj4gIAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaGlzaWxpY29u
L2hpYm1jL2hpYm1jX2RybV9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9oaXNpbGljb24vaGlibWMv
aGlibWNfZHJtX2Rydi5oCj4gaW5kZXggOGViNzI1OGIyMzZhLi41MGEwYzFmOWQyMTEgMTAwNjQ0
Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2hpc2lsaWNvbi9oaWJtYy9oaWJtY19kcm1fZHJ2LmgK
PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaGlzaWxpY29uL2hpYm1jL2hpYm1jX2RybV9kcnYuaAo+
IEBAIC0xOCw3ICsxOCw2IEBACj4gICNpbmNsdWRlIDxkcm0vZHJtX2ZyYW1lYnVmZmVyLmg+Cj4g
IAo+ICBzdHJ1Y3QgZHJtX2RldmljZTsKPiAtc3RydWN0IGRybV9nZW1fb2JqZWN0Owo+ICAKPiAg
c3RydWN0IGhpYm1jX2RybV9wcml2YXRlIHsKPiAgCS8qIGh3ICovCj4gQEAgLTQxLDkgKzQwLDYg
QEAgdm9pZCBoaWJtY19zZXRfY3VycmVudF9nYXRlKHN0cnVjdCBoaWJtY19kcm1fcHJpdmF0ZSAq
cHJpdiwKPiAgaW50IGhpYm1jX2RlX2luaXQoc3RydWN0IGhpYm1jX2RybV9wcml2YXRlICpwcml2
KTsKPiAgaW50IGhpYm1jX3ZkYWNfaW5pdChzdHJ1Y3QgaGlibWNfZHJtX3ByaXZhdGUgKnByaXYp
Owo+ICAKPiAtaW50IGhpYm1jX2dlbV9jcmVhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdTMy
IHNpemUsIGJvb2wgaXNrZXJuZWwsCj4gLQkJICAgICBzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKipv
YmopOwo+IC0KPiAgaW50IGhpYm1jX21tX2luaXQoc3RydWN0IGhpYm1jX2RybV9wcml2YXRlICpo
aWJtYyk7Cj4gIHZvaWQgaGlibWNfbW1fZmluaShzdHJ1Y3QgaGlibWNfZHJtX3ByaXZhdGUgKmhp
Ym1jKTsKPiAgaW50IGhpYm1jX2R1bWJfY3JlYXRlKHN0cnVjdCBkcm1fZmlsZSAqZmlsZSwgc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiwKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2hpc2ls
aWNvbi9oaWJtYy9oaWJtY190dG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9oaXNpbGljb24vaGlibWMv
aGlibWNfdHRtLmMKPiBpbmRleCBmNmQyNWI4NWMyMDkuLjBhZjVkOTY2YTQ4MCAxMDA2NDQKPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaGlzaWxpY29uL2hpYm1jL2hpYm1jX3R0bS5jCj4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2hpc2lsaWNvbi9oaWJtYy9oaWJtY190dG0uYwo+IEBAIC00Nyw1NSAr
NDcsMTEgQEAgdm9pZCBoaWJtY19tbV9maW5pKHN0cnVjdCBoaWJtY19kcm1fcHJpdmF0ZSAqaGli
bWMpCj4gIAlkcm1fdnJhbV9oZWxwZXJfcmVsZWFzZV9tbShoaWJtYy0+ZGV2KTsKPiAgfQo+ICAK
PiAtaW50IGhpYm1jX2dlbV9jcmVhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdTMyIHNpemUs
IGJvb2wgaXNrZXJuZWwsCj4gLQkJICAgICBzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKipvYmopCj4g
LXsKPiAtCXN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm87Cj4gLQlpbnQgcmV0Owo+IC0K
PiAtCSpvYmogPSBOVUxMOwo+IC0KPiAtCXNpemUgPSByb3VuZHVwKHNpemUsIFBBR0VfU0laRSk7
Cj4gLQlpZiAoc2l6ZSA9PSAwKQo+IC0JCXJldHVybiAtRUlOVkFMOwo+IC0KPiAtCWdibyA9IGRy
bV9nZW1fdnJhbV9jcmVhdGUoZGV2LCAmZGV2LT52cmFtX21tLT5iZGV2LCBzaXplLCAwLCBmYWxz
ZSk7Cj4gLQlpZiAoSVNfRVJSKGdibykpIHsKPiAtCQlyZXQgPSBQVFJfRVJSKGdibyk7Cj4gLQkJ
aWYgKHJldCAhPSAtRVJFU1RBUlRTWVMpCj4gLQkJCURSTV9FUlJPUigiZmFpbGVkIHRvIGFsbG9j
YXRlIEdFTSBvYmplY3Q6ICVkXG4iLCByZXQpOwo+IC0JCXJldHVybiByZXQ7Cj4gLQl9Cj4gLQkq
b2JqID0gJmdiby0+Ym8uYmFzZTsKPiAtCXJldHVybiAwOwo+IC19Cj4gLQo+ICBpbnQgaGlibWNf
ZHVtYl9jcmVhdGUoc3RydWN0IGRybV9maWxlICpmaWxlLCBzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
LAo+ICAJCSAgICAgIHN0cnVjdCBkcm1fbW9kZV9jcmVhdGVfZHVtYiAqYXJncykKPiAgewo+IC0J
c3RydWN0IGRybV9nZW1fb2JqZWN0ICpnb2JqOwo+IC0JdTMyIGhhbmRsZTsKPiAtCWludCByZXQ7
Cj4gLQo+IC0JYXJncy0+cGl0Y2ggPSBBTElHTihhcmdzLT53aWR0aCAqIERJVl9ST1VORF9VUChh
cmdzLT5icHAsIDgpLCAxNik7Cj4gLQlhcmdzLT5zaXplID0gYXJncy0+cGl0Y2ggKiBhcmdzLT5o
ZWlnaHQ7Cj4gLQo+IC0JcmV0ID0gaGlibWNfZ2VtX2NyZWF0ZShkZXYsIGFyZ3MtPnNpemUsIGZh
bHNlLAo+IC0JCQkgICAgICAgJmdvYmopOwo+IC0JaWYgKHJldCkgewo+IC0JCURSTV9FUlJPUigi
ZmFpbGVkIHRvIGNyZWF0ZSBHRU0gb2JqZWN0OiAlZFxuIiwgcmV0KTsKPiAtCQlyZXR1cm4gcmV0
Owo+IC0JfQo+IC0KPiAtCXJldCA9IGRybV9nZW1faGFuZGxlX2NyZWF0ZShmaWxlLCBnb2JqLCAm
aGFuZGxlKTsKPiAtCWRybV9nZW1fb2JqZWN0X3B1dF91bmxvY2tlZChnb2JqKTsKPiAtCWlmIChy
ZXQpIHsKPiAtCQlEUk1fRVJST1IoImZhaWxlZCB0byB1bnJlZmVyZW5jZSBHRU0gb2JqZWN0OiAl
ZFxuIiwgcmV0KTsKPiAtCQlyZXR1cm4gcmV0Owo+IC0JfQo+IC0KPiAtCWFyZ3MtPmhhbmRsZSA9
IGhhbmRsZTsKPiAtCXJldHVybiAwOwo+ICsJcmV0dXJuIGRybV9nZW1fdnJhbV9maWxsX2NyZWF0
ZV9kdW1iKGZpbGUsIGRldiwgJmRldi0+dnJhbV9tbS0+YmRldiwKPiArCQkJCQkgICAgIDAsIDE2
LCBmYWxzZSwgYXJncyk7Cj4gIH0KPiAgCj4gIGNvbnN0IHN0cnVjdCBkcm1fbW9kZV9jb25maWdf
ZnVuY3MgaGlibWNfbW9kZV9mdW5jcyA9IHsKPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0vZHJt
X2dlbV92cmFtX2hlbHBlci5oIGIvaW5jbHVkZS9kcm0vZHJtX2dlbV92cmFtX2hlbHBlci5oCj4g
aW5kZXggZTA0MDU0MWExMDVmLi5jNjQyYjRjYjY2MDAgMTAwNjQ0Cj4gLS0tIGEvaW5jbHVkZS9k
cm0vZHJtX2dlbV92cmFtX2hlbHBlci5oCj4gKysrIGIvaW5jbHVkZS9kcm0vZHJtX2dlbV92cmFt
X2hlbHBlci5oCj4gQEAgLTExMyw2ICsxMTMsNyBAQCBpbnQgZHJtX2dlbV92cmFtX2ZpbGxfY3Jl
YXRlX2R1bWIoc3RydWN0IGRybV9maWxlICpmaWxlLAo+ICAJCQkJICBzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2LAo+ICAJCQkJICBzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKPiAgCQkJCSAgdW5z
aWduZWQgbG9uZyBwZ19hbGlnbiwKPiArCQkJCSAgdW5zaWduZWQgbG9uZyBwaXRjaF9hbGlnbiwK
PiAgCQkJCSAgYm9vbCBpbnRlcnJ1cHRpYmxlLAo+ICAJCQkJICBzdHJ1Y3QgZHJtX21vZGVfY3Jl
YXRlX2R1bWIgKmFyZ3MpOwo+ICAKPiAtLSAKPiAyLjIzLjAKX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2
ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21h
aWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
