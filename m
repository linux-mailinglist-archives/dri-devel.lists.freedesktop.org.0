Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id E9C7DE3109
	for <lists+dri-devel@lfdr.de>; Thu, 24 Oct 2019 13:43:25 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 5A63F6E2E3;
	Thu, 24 Oct 2019 11:43:23 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-lj1-x243.google.com (mail-lj1-x243.google.com
 [IPv6:2a00:1450:4864:20::243])
 by gabe.freedesktop.org (Postfix) with ESMTPS id C63776E2F2
 for <dri-devel@lists.freedesktop.org>; Thu, 24 Oct 2019 11:43:15 +0000 (UTC)
Received: by mail-lj1-x243.google.com with SMTP id d1so24619370ljl.13
 for <dri-devel@lists.freedesktop.org>; Thu, 24 Oct 2019 04:43:15 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=HocbHkVryxQKKYD4eJZYx0TKKDYaGAurOyeG5XutFxE=;
 b=jticXYNFVPgb1g/hUtnzulJwMI3ViipqAE3OXxlCxC3r2aCgAczTl+3SwHNdFOFkCK
 zqHfXcFs07xDUiqRZJnPc3+kh7i8I2Z1ifu5U3PS61OOVNTLUvJOK5GnfsdCEswnxTRI
 XLe10M2O1PLkfQfKYDNyfd7K8mPvpfR/gx/Y8nn4f2bP0g+53pZ6iJZkCQL7wlU56HWF
 6DdqQgv/1vuFLvZ2HHoLEnLsjwW2J31SaHp6Qpzc2uowPA177i7M87SrBG2Tau+7LSkg
 /qWAcVMyAPfMNKuruwEMsNG1rnQbtSqVD20pdVPUriqnpfSmK1xmTM072eo5mu/QT+92
 5cFA==
X-Gm-Message-State: APjAAAWsA8EvXHQshX5q0DThLqy7bBpGHB7gr0L0grNiM0yIgQwhn27M
 aqFyBDcNOa+i+d+MLodbYOCIHA==
X-Google-Smtp-Source: APXvYqxcgyF29QcGwMHLxkC16T3aLMAI6U+cDeZMwCvAE/EXkBuqDis0fZWqudY01GEyThZ5mTPcjA==
X-Received: by 2002:a2e:9e85:: with SMTP id f5mr26487084ljk.203.1571917393741; 
 Thu, 24 Oct 2019 04:43:13 -0700 (PDT)
Received: from genomnajs.ideon.se ([85.235.10.227])
 by smtp.gmail.com with ESMTPSA id e14sm4001846ljb.75.2019.10.24.04.43.12
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Thu, 24 Oct 2019 04:43:13 -0700 (PDT)
From: Linus Walleij <linus.walleij@linaro.org>
To: Thierry Reding <thierry.reding@gmail.com>, Sam Ravnborg <sam@ravnborg.org>,
 dri-devel@lists.freedesktop.org
Subject: [PATCH 3/3 v4] drm/panel: Add driver for Sony ACX424AKP panel
Date: Thu, 24 Oct 2019 13:43:05 +0200
Message-Id: <20191024114305.15581-3-linus.walleij@linaro.org>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20191024114305.15581-1-linus.walleij@linaro.org>
References: <20191024114305.15581-1-linus.walleij@linaro.org>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=linaro.org; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=HocbHkVryxQKKYD4eJZYx0TKKDYaGAurOyeG5XutFxE=;
 b=k81rwmW70iZcnMNYDKoKql86Z5v2JtegX+HhBvBItjDaDP3ZaiQ1ZSdT5DE3S3W3uP
 yG3acCQfCrLo+x9H9Gw6GzLkSyf0lfPNyoSx0dK2uSNkbXm8azMMJswWwxCi0VLvNsUw
 SleFhz5+rIP1gSZS/DtTr2YKGy1okQDFdtUmegnKW1TU0mx9OaStHLhLQWJiUZQDgO1v
 8pw+ejFNn4bnI4D16+orvdiqEcfiBIw2ps+NtfPfdttMUe772lLCp46UbYNhG+n75XMA
 8gAcPIs5u3QZpi50nV6uCoILDb6aZJf8iih6WB5DHFIA1FHwtT6+kY0DdhhszSELaxI8
 xPmA==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIFNvbnkgQUNYNDI0QUtQIGlzIGEgY29tbWFuZC92aWRlb21vZGUgRFNJIHBhbmVsIGZvcgpt
b2JpbGUgZGV2aWNlcy4gSXQgaXMgdXNlZCBvbiB0aGUgU1QtRXJpY3Nzb24gSFJFRjUyMApyZWZl
cmVuY2UgZGVzaWduLiBXZSBzdXBwb3J0IHZpZGVvIG1vZGUgYnkgZGVmYXVsdCwgYnV0Cml0IGlz
IHBvc3NpYmxlIHRvIHN3aXRjaCB0aGUgcGFuZWwgaW50byBjb21tYW5kIG1vZGUKYnkgdXNpbmcg
dGhlIGJvb2wgcHJvcGVydHkgImRzaS1jb21tYW5kLW1vZGUiLgoKU2lnbmVkLW9mZi1ieTogTGlu
dXMgV2FsbGVpaiA8bGludXMud2FsbGVpakBsaW5hcm8ub3JnPgotLS0KQ2hhbmdlTG9nIHYzLT52
NDoKLSBObyBjaGFuZ2VzIGp1c3QgcmVzZW5kaW5nIHdpdGggdGhlIG5ldyBiaW5kaW5nIHVwZGF0
ZXMuCkNoYW5nZUxvZyB2Mi0+djM6Ci0gTm8gY2hhbmdlcyBqdXN0IHJlc2VuZGluZyB3aXRoIHRo
ZSBuZXcgYmluZGluZyB1cGRhdGVzLgpDaGFuZ2VMb2cgdjEtPnYyOgotIEZpeCB1cCB0aGUgSUQg
cmVhZCBmdW5jdGlvbiB0byBzcGxpdCBpbnRvIHJlYWRpbmcgaGVhZGVyLAogIHZlcnNpb24gYW5k
IElELCBzdG9yZSB0aGUgdmVyc2lvbiBpbiB0aGUgc3RydWN0LgotIEdldCByaWQgb2YgYSBzdXJw
bHVzIHNlbWljb2xvbiBmb3VuZCBieSB0aGUgYnVpbGQgcm9ib3QKICB3aGlsZSByZXdyaXRpbmcg
dGhlIGFib3ZlIGNvZGUuCi0gVXNlIHVuc2lnbmVkIGludCBpbiBwcm9iZSgpIGxvb3AuCi0gU2V0
IHZyZWZyZXNoIHRvIDYwSHosIGFzIGdvb2QgYXMgYW55LCB0aGUgbWVhc3VyZWQgdnJlZnJlc2gK
ICBpbiBjb250aW5vdXMgY29tbWFuZCBtb2RlIGlzIH4xMTcgSHouCi0gVXNlIGEgZGlmZmVyZW50
IGZvcigpIGlkaW9tIHdoaWxlIHJldHJ5aW5nIHRvIHJlYWQgSUQKICA1IHRpbWVzLgotIERyb3Ag
dGhlIHN5bmMgcHVsc2Ugc2V0dGluZywgd2UgYXJlIG5vdCB1c2luZyB0aGlzLCB0aGlzCiAgcGFu
ZWwgdXNlcyBhbiBldmVudC4KLSBVc2UgdGhlIGdlbmVyaWMgImVuZm9yY2UtdmlkZW8tbW9kZSIg
Zm9yIHZpZGVvIG1vZGUKICBlbmZvcmNlbWVudC4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vcGFuZWwv
S2NvbmZpZyAgICAgICAgICAgICAgICB8ICAgNyArCiBkcml2ZXJzL2dwdS9kcm0vcGFuZWwvTWFr
ZWZpbGUgICAgICAgICAgICAgICB8ICAgMSArCiBkcml2ZXJzL2dwdS9kcm0vcGFuZWwvcGFuZWwt
c29ueS1hY3g0MjRha3AuYyB8IDU0MiArKysrKysrKysrKysrKysrKysrCiBpbmNsdWRlL3ZpZGVv
L21pcGlfZGlzcGxheS5oICAgICAgICAgICAgICAgICB8ICAgMSArCiA0IGZpbGVzIGNoYW5nZWQs
IDU1MSBpbnNlcnRpb25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL3Bh
bmVsL3BhbmVsLXNvbnktYWN4NDI0YWtwLmMKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
cGFuZWwvS2NvbmZpZyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9LY29uZmlnCmluZGV4IGYxNTJi
YzRlZWI1My4uOTU5ZGY1YmVhN2QyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcGFuZWwv
S2NvbmZpZworKysgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvS2NvbmZpZwpAQCAtMzE2LDYgKzMx
NiwxMyBAQCBjb25maWcgRFJNX1BBTkVMX1NJVFJPTklYX1NUNzc4OVYKIAkgIFNheSBZIGhlcmUg
aWYgeW91IHdhbnQgdG8gZW5hYmxlIHN1cHBvcnQgZm9yIHRoZSBTaXRyb25peAogCSAgU1Q3Nzg5
ViBjb250cm9sbGVyIGZvciAyNDB4MzIwIExDRCBwYW5lbHMKIAorY29uZmlnIERSTV9QQU5FTF9T
T05ZX0FDWDQyNEFLUAorCXRyaXN0YXRlICJTb255IEFDWDQyNEFLUCBEU0kgY29tbWFuZCBtb2Rl
IHBhbmVsIgorCWRlcGVuZHMgb24gT0YKKwlkZXBlbmRzIG9uIERSTV9NSVBJX0RTSQorCWRlcGVu
ZHMgb24gQkFDS0xJR0hUX0NMQVNTX0RFVklDRQorCXNlbGVjdCBWSURFT01PREVfSEVMUEVSUwor
CiBjb25maWcgRFJNX1BBTkVMX1NPTllfQUNYNTY1QUtNCiAJdHJpc3RhdGUgIlNvbnkgQUNYNTY1
QUtNIHBhbmVsIgogCWRlcGVuZHMgb24gR1BJT0xJQiAmJiBPRiAmJiBTUEkKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9N
YWtlZmlsZQppbmRleCBiNmNkMzlmZTBmMjAuLjBiNTE3OTNlM2I0MyAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL3BhbmVsL01ha2VmaWxlCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9N
YWtlZmlsZQpAQCAtMzMsNiArMzMsNyBAQCBvYmotJChDT05GSUdfRFJNX1BBTkVMX1NIQVJQX0xT
MDM3VjdEVzAxKSArPSBwYW5lbC1zaGFycC1sczAzN3Y3ZHcwMS5vCiBvYmotJChDT05GSUdfRFJN
X1BBTkVMX1NIQVJQX0xTMDQzVDFMRTAxKSArPSBwYW5lbC1zaGFycC1sczA0M3QxbGUwMS5vCiBv
YmotJChDT05GSUdfRFJNX1BBTkVMX1NJVFJPTklYX1NUNzcwMSkgKz0gcGFuZWwtc2l0cm9uaXgt
c3Q3NzAxLm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfU0lUUk9OSVhfU1Q3Nzg5VikgKz0gcGFu
ZWwtc2l0cm9uaXgtc3Q3Nzg5di5vCitvYmotJChDT05GSUdfRFJNX1BBTkVMX1NPTllfQUNYNDI0
QUtQKSArPSBwYW5lbC1zb255LWFjeDQyNGFrcC5vCiBvYmotJChDT05GSUdfRFJNX1BBTkVMX1NP
TllfQUNYNTY1QUtNKSArPSBwYW5lbC1zb255LWFjeDU2NWFrbS5vCiBvYmotJChDT05GSUdfRFJN
X1BBTkVMX1RQT19URDAyOFRURUMxKSArPSBwYW5lbC10cG8tdGQwMjh0dGVjMS5vCiBvYmotJChD
T05GSUdfRFJNX1BBTkVMX1RQT19URDA0M01URUExKSArPSBwYW5lbC10cG8tdGQwNDNtdGVhMS5v
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvcGFuZWwtc29ueS1hY3g0MjRha3Au
YyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1zb255LWFjeDQyNGFrcC5jCm5ldyBmaWxl
IG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uOTZhMTQ1MGI2OTllCi0tLSAvZGV2L251
bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLXNvbnktYWN4NDI0YWtwLmMKQEAg
LTAsMCArMSw1NDIgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wKworLyoK
KyAqIE1JUEktRFNJIFNvbnkgQUNYNDI0QUtQIHBhbmVsIGRyaXZlci4gVGhpcyBpcyBhIDQ4MHg4
NjQKKyAqIEFNT0xFRCBwYW5lbCB3aXRoIGEgY29tbWFuZC1vbmx5IERTSSBpbnRlcmZhY2UuCisg
KgorICogQ29weXJpZ2h0IChDKSBMaW5hcm8gTHRkLiAyMDE5CisgKiBBdXRob3I6IExpbnVzIFdh
bGxlaWoKKyAqIEJhc2VkIG9uIGNvZGUgYW5kIGtub3ctaG93IGZyb20gTWFyY3VzIExvcmVudHpv
bgorICogQ29weXJpZ2h0IChDKSBTVC1Fcmljc3NvbiBTQSAyMDEwCisgKi8KKworI2luY2x1ZGUg
PGRybS9kcm1fbW9kZXMuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX21pcGlfZHNpLmg+CisjaW5jbHVk
ZSA8ZHJtL2RybV9wYW5lbC5oPgorI2luY2x1ZGUgPGRybS9kcm1fcHJpbnQuaD4KKyNpbmNsdWRl
IDx2aWRlby9taXBpX2Rpc3BsYXkuaD4KKworI2luY2x1ZGUgPGxpbnV4L2dwaW8vY29uc3VtZXIu
aD4KKyNpbmNsdWRlIDxsaW51eC9yZWd1bGF0b3IvY29uc3VtZXIuaD4KKyNpbmNsdWRlIDxsaW51
eC9kZWxheS5oPgorI2luY2x1ZGUgPGxpbnV4L29mLmg+CisjaW5jbHVkZSA8bGludXgvbW9kdWxl
Lmg+CisjaW5jbHVkZSA8bGludXgvYmFja2xpZ2h0Lmg+CisKKyNkZWZpbmUgQUNYNDI0X0RDU19S
RUFEX0lEMQkJMHhEQQorI2RlZmluZSBBQ1g0MjRfRENTX1JFQURfSUQyCQkweERCCisjZGVmaW5l
IEFDWDQyNF9EQ1NfUkVBRF9JRDMJCTB4REMKKworI2RlZmluZSBESVNQTEFZX1NPTllfQUNYNDI0
QUtQX0lEMQkweDgxMWIKKyNkZWZpbmUgRElTUExBWV9TT05ZX0FDWDQyNEFLUF9JRDIJMHg4MTFh
CisjZGVmaW5lIERJU1BMQVlfU09OWV9BQ1g0MjRBS1BfSUQzCTB4ODAwMAorCitzdHJ1Y3QgYWN4
NDI0YWtwIHsKKwlzdHJ1Y3QgZGV2aWNlICpkZXY7CisJc3RydWN0IGRybV9wYW5lbCBwYW5lbDsK
KwlzdHJ1Y3QgYmFja2xpZ2h0X2RldmljZSAqYmw7CisJc3RydWN0IHJlZ3VsYXRvciAqc3VwcGx5
OworCXN0cnVjdCBncGlvX2Rlc2MgKnJlc2V0X2dwaW87CisJdTggdmVyc2lvbjsKKwlib29sIHZp
ZGVvX21vZGU7Cit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgc29u
eV9hY3g0MjRha3BfdmlkX21vZGUgPSB7CisJLmNsb2NrID0gMzMwMDAwLAorCS5oZGlzcGxheSA9
IDQ4MCwKKwkuaHN5bmNfc3RhcnQgPSA0ODAgKyAxNSwKKwkuaHN5bmNfZW5kID0gNDgwICsgMTUg
KyAwLAorCS5odG90YWwgPSA0ODAgKyAxNSArIDAgKyAxNSwKKwkudmRpc3BsYXkgPSA4NjQsCisJ
LnZzeW5jX3N0YXJ0ID0gODY0ICsgMTQsCisJLnZzeW5jX2VuZCA9IDg2NCArIDE0ICsgMSwKKwku
dnRvdGFsID0gODY0ICsgMTQgKyAxICsgMTEsCisJLnZyZWZyZXNoID0gNjAsCisJLndpZHRoX21t
ID0gNDgsCisJLmhlaWdodF9tbSA9IDg0LAorCS5mbGFncyA9IERSTV9NT0RFX0ZMQUdfUFZTWU5D
LAorfTsKKworLyoKKyAqIFRoZSB0aW1pbmdzIGFyZSBub3QgdmVyeSBoZWxwZnVsIGFzIHRoZSBk
aXNwbGF5IGlzIHVzZWQgaW4KKyAqIGNvbW1hbmQgbW9kZSB1c2luZyB0aGUgbWF4aW11bSBIUyBm
cmVxdWVuY3kuCisgKi8KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSBzb255
X2FjeDQyNGFrcF9jbWRfbW9kZSA9IHsKKwkuY2xvY2sgPSA0MjAxNjAsCisJLmhkaXNwbGF5ID0g
NDgwLAorCS5oc3luY19zdGFydCA9IDQ4MCArIDE1NCwKKwkuaHN5bmNfZW5kID0gNDgwICsgMTU0
ICsgMTYsCisJLmh0b3RhbCA9IDQ4MCArIDE1NCArIDE2ICsgMzIsCisJLnZkaXNwbGF5ID0gODY0
LAorCS52c3luY19zdGFydCA9IDg2NCArIDEsCisJLnZzeW5jX2VuZCA9IDg2NCArIDEgKyAxLAor
CS52dG90YWwgPSA4NjQgKyAxICsgMSArIDEsCisJLyoKKwkgKiBTb21lIGRlc2lyZWQgcmVmcmVz
aCByYXRlLCBleHBlcmltZW50cyBhdCB0aGUgbWF4aW11bSAicGl4ZWwiCisJICogY2xvY2sgc3Bl
ZWQgKEhTIGNsb2NrIDQyMCBNSHopIHlpZWxkcyBhcm91bmQgMTE3SHouCisJICovCisJLnZyZWZy
ZXNoID0gNjAsCisJLndpZHRoX21tID0gNDgsCisJLmhlaWdodF9tbSA9IDg0LAorfTsKKworc3Rh
dGljIGlubGluZSBzdHJ1Y3QgYWN4NDI0YWtwICpwYW5lbF90b19hY3g0MjRha3Aoc3RydWN0IGRy
bV9wYW5lbCAqcGFuZWwpCit7CisJcmV0dXJuIGNvbnRhaW5lcl9vZihwYW5lbCwgc3RydWN0IGFj
eDQyNGFrcCwgcGFuZWwpOworfQorCisjZGVmaW5lIEZPU0MJCQkyMCAvKiAyME1oeiAqLworI2Rl
ZmluZSBTQ0FMRV9GQUNUT1JfTlNfRElWX01IWgkxMDAwCisKK3N0YXRpYyBpbnQgYWN4NDI0YWtw
X3NldF9icmlnaHRuZXNzKHN0cnVjdCBiYWNrbGlnaHRfZGV2aWNlICpibCkKK3sKKwlzdHJ1Y3Qg
YWN4NDI0YWtwICphY3ggPSBibF9nZXRfZGF0YShibCk7CisJc3RydWN0IG1pcGlfZHNpX2Rldmlj
ZSAqZHNpID0gdG9fbWlwaV9kc2lfZGV2aWNlKGFjeC0+ZGV2KTsKKwlpbnQgcGVyaW9kX25zID0g
MTAyMzsKKwlpbnQgZHV0eV9ucyA9IGJsLT5wcm9wcy5icmlnaHRuZXNzOworCXU4IHB3bV9yYXRp
bzsKKwl1OCBwd21fZGl2OworCXU4IHBhcjsKKwlpbnQgcmV0OworCisJLyogQ2FsY3VsYXRlIHRo
ZSBQV00gZHV0eSBjeWNsZSBpbiBuLzI1NidzICovCisJcHdtX3JhdGlvID0gbWF4KCgoZHV0eV9u
cyAqIDI1NikgLyBwZXJpb2RfbnMpIC0gMSwgMSk7CisJcHdtX2RpdiA9IG1heCgxLAorCQkgICAg
ICAoKEZPU0MgKiBwZXJpb2RfbnMpIC8gMjU2KSAvCisJCSAgICAgIFNDQUxFX0ZBQ1RPUl9OU19E
SVZfTUhaKTsKKworCS8qIFNldCB1cCBQV00gZHV0eWN5Y2xlIE9ORSBieXRlIChkaWZmZXJzIGZy
b20gdGhlIHN0YW5kYXJkKSAqLworCURSTV9ERVZfREVCVUcoYWN4LT5kZXYsICJjYWxjdWxhdGVk
IGR1dHkgY3ljbGUgJTAyeFxuIiwgcHdtX3JhdGlvKTsKKwlyZXQgPSBtaXBpX2RzaV9kY3Nfd3Jp
dGUoZHNpLCBNSVBJX0RDU19TRVRfRElTUExBWV9CUklHSFRORVNTLAorCQkJCSAmcHdtX3JhdGlv
LCAxKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGFjeC0+ZGV2LAorCQkJICAg
ICAgImZhaWxlZCB0byBzZXQgZGlzcGxheSBQV00gcmF0aW8gKCVkKVxuIiwKKwkJCSAgICAgIHJl
dCk7CisJCXJldHVybiByZXQ7CisJfQorCisJLyoKKwkgKiBTZXF1ZW5jZSB0byB3cml0ZSBQV01E
SVY6CisJICoJYWRkcmVzcwkJZGF0YQorCSAqCTB4RjMJCTB4QUEgICBDTUQyIFVubG9jaworCSAq
CTB4MDAJCTB4MDEgICBFbnRlciBDTUQyIHBhZ2UgMAorCSAqCTBYN0QJCTB4MDEgICBObyByZWxv
YWQgTVRQIG9mIENNRDIgUDEKKwkgKgkweDIyCQlQV01ESVYKKwkgKgkweDdGCQkweEFBICAgQ01E
MiBwYWdlIDEgbG9jaworCSAqLworCXBhciA9IDB4YWE7CisJcmV0ID0gbWlwaV9kc2lfZGNzX3dy
aXRlKGRzaSwgMHhmMywgJnBhciwgMSk7CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJP
UihhY3gtPmRldiwKKwkJCSAgICAgICJmYWlsZWQgdG8gdW5sb2NrIENNRCAyICglZClcbiIsCisJ
CQkgICAgICByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKwlwYXIgPSAweDAxOworCXJldCA9IG1p
cGlfZHNpX2Rjc193cml0ZShkc2ksIDB4MDAsICZwYXIsIDEpOworCWlmIChyZXQgPCAwKSB7CisJ
CURSTV9ERVZfRVJST1IoYWN4LT5kZXYsCisJCQkgICAgICAiZmFpbGVkIHRvIGVudGVyIHBhZ2Ug
MSAoJWQpXG4iLAorCQkJICAgICAgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisJcGFyID0gMHgw
MTsKKwlyZXQgPSBtaXBpX2RzaV9kY3Nfd3JpdGUoZHNpLCAweDdkLCAmcGFyLCAxKTsKKwlpZiAo
cmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGFjeC0+ZGV2LAorCQkJICAgICAgImZhaWxlZCB0
byBkaXNhYmxlIE1UUCByZWxvYWQgKCVkKVxuIiwKKwkJCSAgICAgIHJldCk7CisJCXJldHVybiBy
ZXQ7CisJfQorCXJldCA9IG1pcGlfZHNpX2Rjc193cml0ZShkc2ksIDB4MjIsICZwd21fZGl2LCAx
KTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGFjeC0+ZGV2LAorCQkJICAgICAg
ImZhaWxlZCB0byBzZXQgUFdNIGRpdmlzb3IgKCVkKVxuIiwKKwkJCSAgICAgIHJldCk7CisJCXJl
dHVybiByZXQ7CisJfQorCXBhciA9IDB4YWE7CisJcmV0ID0gbWlwaV9kc2lfZGNzX3dyaXRlKGRz
aSwgMHg3ZiwgJnBhciwgMSk7CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihhY3gt
PmRldiwKKwkJCSAgICAgICJmYWlsZWQgdG8gbG9jayBDTUQgMiAoJWQpXG4iLAorCQkJICAgICAg
cmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwkvKiBFbmFibGUgYmFja2xpZ2h0ICovCisJcGFy
ID0gMHgyNDsKKwlyZXQgPSBtaXBpX2RzaV9kY3Nfd3JpdGUoZHNpLCBNSVBJX0RDU19XUklURV9D
T05UUk9MX0RJU1BMQVksCisJCQkJICZwYXIsIDEpOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9E
RVZfRVJST1IoYWN4LT5kZXYsCisJCQkgICAgICAiZmFpbGVkIHRvIGVuYWJsZSBkaXNwbGF5IGJh
Y2tsaWdodCAoJWQpXG4iLAorCQkJICAgICAgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwly
ZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBiYWNrbGlnaHRfb3BzIGFjeDQyNGFr
cF9ibF9vcHMgPSB7CisJLnVwZGF0ZV9zdGF0dXMgPSBhY3g0MjRha3Bfc2V0X2JyaWdodG5lc3Ms
Cit9OworCitzdGF0aWMgaW50IGFjeDQyNGFrcF9yZWFkX2lkKHN0cnVjdCBhY3g0MjRha3AgKmFj
eCkKK3sKKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kgPSB0b19taXBpX2RzaV9kZXZpY2Uo
YWN4LT5kZXYpOworCXU4IGhlYWRlciwgdmVyc2lvbiwgaWQ7CisJdTE2IHZhbDsKKwlpbnQgcmV0
OworCisJcmV0ID0gbWlwaV9kc2lfZGNzX3JlYWQoZHNpLCBBQ1g0MjRfRENTX1JFQURfSUQxLCAm
aGVhZGVyLCAxKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGFjeC0+ZGV2LCAi
Y291bGQgbm90IHJlYWQgSUQgaGVhZGVyIGJ5dGVcbiIpOworCQlyZXR1cm4gcmV0OworCX0KKwly
ZXQgPSBtaXBpX2RzaV9kY3NfcmVhZChkc2ksIEFDWDQyNF9EQ1NfUkVBRF9JRDIsICZpZCwgMSk7
CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihhY3gtPmRldiwgImNvdWxkIG5vdCBy
ZWFkIGRldmljZSBJRCBieXRlXG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisJcmV0ID0gbWlwaV9k
c2lfZGNzX3JlYWQoZHNpLCBBQ1g0MjRfRENTX1JFQURfSUQzLCAmdmVyc2lvbiwgMSk7CisJaWYg
KHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihhY3gtPmRldiwgImNvdWxkIG5vdCByZWFkIHZl
cnNpb24gYnl0ZVxuIik7CisJCXJldHVybiByZXQ7CisJfQorCisJaWYgKGhlYWRlciA9PSAweDAw
KSB7CisJCURSTV9ERVZfRVJST1IoYWN4LT5kZXYsICJkZXZpY2UgSUQgaGVhZGVyIGlzIHplcm9c
biIpOworCQlyZXR1cm4gLUVOT0RFVjsKKwl9CisKKwl2YWwgPSAoaWQgPDwgOCkgfCB2ZXJzaW9u
OworCXN3aXRjaCAodmFsKSB7CisJY2FzZSBESVNQTEFZX1NPTllfQUNYNDI0QUtQX0lEMToKKwlj
YXNlIERJU1BMQVlfU09OWV9BQ1g0MjRBS1BfSUQyOgorCWNhc2UgRElTUExBWV9TT05ZX0FDWDQy
NEFLUF9JRDM6CisJCURSTV9ERVZfSU5GTyhhY3gtPmRldiwgInBhbmVsIElEICUwMngsIHZlcnNp
b246ICUwMnhcbiIsCisJCQkgICAgIGlkLCB2ZXJzaW9uKTsKKwkJYnJlYWs7CisJZGVmYXVsdDoK
KwkJRFJNX0RFVl9JTkZPKGFjeC0+ZGV2LCAidW5rbm93biBwYW5lbCBJRCAlMDJ4LCB2ZXJzaW9u
OiAlMDJ4XG4iLAorCQkJICAgICBpZCwgdmVyc2lvbik7CisJCWJyZWFrOworCX0KKwlhY3gtPnZl
cnNpb24gPSB2ZXJzaW9uOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgYWN4NDI0YWtw
X3Bvd2VyX29uKHN0cnVjdCBhY3g0MjRha3AgKmFjeCkKK3sKKwlpbnQgcmV0OworCisJcmV0ID0g
cmVndWxhdG9yX2VuYWJsZShhY3gtPnN1cHBseSk7CisJaWYgKHJldCkgeworCQlEUk1fREVWX0VS
Uk9SKGFjeC0+ZGV2LCAiZmFpbGVkIHRvIGVuYWJsZSBzdXBwbHkgKCVkKVxuIiwgcmV0KTsKKwkJ
cmV0dXJuIHJldDsKKwl9CisKKwkvKiBBc3NlcnQgUkVTRVQgKi8KKwlncGlvZF9zZXRfdmFsdWVf
Y2Fuc2xlZXAoYWN4LT5yZXNldF9ncGlvLCAxKTsKKwl1ZGVsYXkoMjApOworCS8qIERlLWFzc2Vy
dCBSRVNFVCAqLworCWdwaW9kX3NldF92YWx1ZV9jYW5zbGVlcChhY3gtPnJlc2V0X2dwaW8sIDAp
OworCW1zbGVlcCgxMSk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBhY3g0MjRha3Bf
cHJlcGFyZShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKK3sKKwlzdHJ1Y3QgYWN4NDI0YWtwICph
Y3ggPSBwYW5lbF90b19hY3g0MjRha3AocGFuZWwpOworCXN0cnVjdCBtaXBpX2RzaV9kZXZpY2Ug
KmRzaSA9IHRvX21pcGlfZHNpX2RldmljZShhY3gtPmRldik7CisJY29uc3QgdTggbWRkaSA9IDM7
CisJaW50IHJldDsKKworCXJldCA9IGFjeDQyNGFrcF9wb3dlcl9vbihhY3gpOworCWlmIChyZXQp
CisJCXJldHVybiByZXQ7CisKKwkvKiBFbmFiZSB0ZWFyaW5nIG1vZGU6IHNlbmQgVEUgKHRlYXJp
bmcgZWZmZWN0KSBhdCBWQkxBTksgKi8KKwlyZXQgPSBtaXBpX2RzaV9kY3Nfc2V0X3RlYXJfb24o
ZHNpLAorCQkJCSAgICAgICBNSVBJX0RTSV9EQ1NfVEVBUl9NT0RFX1ZCTEFOSyk7CisJaWYgKHJl
dCkgeworCQlEUk1fREVWX0VSUk9SKGFjeC0+ZGV2LCAiZmFpbGVkIHRvIGVuYWJsZSB2Ymxhbmsg
VEUgKCVkKVxuIiwKKwkJCSAgICAgIHJldCk7CisJCXJldHVybiByZXQ7CisJfQorCisJLyogU2V0
IE1EREkgKi8KKwlyZXQgPSBtaXBpX2RzaV9kY3Nfd3JpdGUoZHNpLCBNSVBJX0RTSV9EQ1NfU0VU
X01EREksCisJCQkJICZtZGRpLCBzaXplb2YobWRkaSkpOworCWlmIChyZXQgPCAwKSB7CisJCURS
TV9ERVZfRVJST1IoYWN4LT5kZXYsICJmYWlsZWQgdG8gc2V0IE1EREkgKCVkKVxuIiwgcmV0KTsK
KwkJcmV0dXJuIHJldDsKKwl9CisKKwlhY3gtPmJsLT5wcm9wcy5wb3dlciA9IEZCX0JMQU5LX05P
Uk1BTDsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBhY3g0MjRha3BfcG93ZXJfb2Zm
KHN0cnVjdCBhY3g0MjRha3AgKmFjeCkKK3sKKwkvKiBBc3NlcnQgUkVTRVQgKi8KKwlncGlvZF9z
ZXRfdmFsdWVfY2Fuc2xlZXAoYWN4LT5yZXNldF9ncGlvLCAxKTsKKwltc2xlZXAoMTEpOworCisJ
cmVndWxhdG9yX2Rpc2FibGUoYWN4LT5zdXBwbHkpOworfQorCitzdGF0aWMgaW50IGFjeDQyNGFr
cF91bnByZXBhcmUoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwpCit7CisJc3RydWN0IGFjeDQyNGFr
cCAqYWN4ID0gcGFuZWxfdG9fYWN4NDI0YWtwKHBhbmVsKTsKKworCWFjeDQyNGFrcF9wb3dlcl9v
ZmYoYWN4KTsKKwlhY3gtPmJsLT5wcm9wcy5wb3dlciA9IEZCX0JMQU5LX1BPV0VSRE9XTjsKKwor
CXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGFjeDQyNGFrcF9lbmFibGUoc3RydWN0IGRybV9w
YW5lbCAqcGFuZWwpCit7CisJc3RydWN0IGFjeDQyNGFrcCAqYWN4ID0gcGFuZWxfdG9fYWN4NDI0
YWtwKHBhbmVsKTsKKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kgPSB0b19taXBpX2RzaV9k
ZXZpY2UoYWN4LT5kZXYpOworCWludCByZXQ7CisKKwkvKiBFeGl0IHNsZWVwIG1vZGUgKi8KKwly
ZXQgPSBtaXBpX2RzaV9kY3NfZXhpdF9zbGVlcF9tb2RlKGRzaSk7CisJaWYgKHJldCkgeworCQlE
Uk1fREVWX0VSUk9SKGFjeC0+ZGV2LCAiZmFpbGVkIHRvIGV4aXQgc2xlZXAgbW9kZSAoJWQpXG4i
LAorCQkJICAgICAgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisJbXNsZWVwKDE0MCk7CisKKwly
ZXQgPSBtaXBpX2RzaV9kY3Nfc2V0X2Rpc3BsYXlfb24oZHNpKTsKKwlpZiAocmV0KSB7CisJCURS
TV9ERVZfRVJST1IoYWN4LT5kZXYsICJmYWlsZWQgdG8gdHVybiBkaXNwbGF5IG9uICglZClcbiIs
CisJCQkgICAgICByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKwlpZiAoYWN4LT52aWRlb19tb2Rl
KSB7CisJCS8qIEluIHZpZGVvIG1vZGUgdHVybiBwZXJpcGhlcmFsIG9uICovCisJCXJldCA9IG1p
cGlfZHNpX3R1cm5fb25fcGVyaXBoZXJhbChkc2kpOworCQlpZiAocmV0KSB7CisJCQlkZXZfZXJy
KGFjeC0+ZGV2LCAiZmFpbGVkIHRvIHR1cm4gb24gcGVyaXBoZXJhbFxuIik7CisJCQlyZXR1cm4g
cmV0OworCQl9CisJfQorCisJYWN4LT5ibC0+cHJvcHMucG93ZXIgPSBGQl9CTEFOS19VTkJMQU5L
OworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgYWN4NDI0YWtwX2Rpc2FibGUoc3RydWN0
IGRybV9wYW5lbCAqcGFuZWwpCit7CisJc3RydWN0IGFjeDQyNGFrcCAqYWN4ID0gcGFuZWxfdG9f
YWN4NDI0YWtwKHBhbmVsKTsKKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kgPSB0b19taXBp
X2RzaV9kZXZpY2UoYWN4LT5kZXYpOworCXU4IHBhcjsKKwlpbnQgcmV0OworCisJLyogRGlzYWJs
ZSBiYWNrbGlnaHQgKi8KKwlwYXIgPSAweDAwOworCXJldCA9IG1pcGlfZHNpX2Rjc193cml0ZShk
c2ksIE1JUElfRENTX1dSSVRFX0NPTlRST0xfRElTUExBWSwKKwkJCQkgJnBhciwgMSk7CisJaWYg
KHJldCkgeworCQlEUk1fREVWX0VSUk9SKGFjeC0+ZGV2LAorCQkJICAgICAgImZhaWxlZCB0byBk
aXNhYmxlIGRpc3BsYXkgYmFja2xpZ2h0ICglZClcbiIsCisJCQkgICAgICByZXQpOworCQlyZXR1
cm4gcmV0OworCX0KKworCXJldCA9IG1pcGlfZHNpX2Rjc19zZXRfZGlzcGxheV9vZmYoZHNpKTsK
KwlpZiAocmV0KSB7CisJCURSTV9ERVZfRVJST1IoYWN4LT5kZXYsICJmYWlsZWQgdG8gdHVybiBk
aXNwbGF5IG9mZiAoJWQpXG4iLAorCQkJICAgICAgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisK
KwkvKiBFbnRlciBzbGVlcCBtb2RlICovCisJcmV0ID0gbWlwaV9kc2lfZGNzX2VudGVyX3NsZWVw
X21vZGUoZHNpKTsKKwlpZiAocmV0KSB7CisJCURSTV9ERVZfRVJST1IoYWN4LT5kZXYsICJmYWls
ZWQgdG8gZW50ZXIgc2xlZXAgbW9kZSAoJWQpXG4iLAorCQkJICAgICAgcmV0KTsKKwkJcmV0dXJu
IHJldDsKKwl9CisJbXNsZWVwKDg1KTsKKworCWFjeC0+YmwtPnByb3BzLnBvd2VyID0gRkJfQkxB
TktfTk9STUFMOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgYWN4NDI0YWtwX2dldF9t
b2RlcyhzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKK3sKKwlzdHJ1Y3QgYWN4NDI0YWtwICphY3gg
PSBwYW5lbF90b19hY3g0MjRha3AocGFuZWwpOworCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25u
ZWN0b3IgPSBwYW5lbC0+Y29ubmVjdG9yOworCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2Rl
OworCisJaWYgKGFjeC0+dmlkZW9fbW9kZSkKKwkJbW9kZSA9IGRybV9tb2RlX2R1cGxpY2F0ZShw
YW5lbC0+ZHJtLAorCQkJCQkgICZzb255X2FjeDQyNGFrcF92aWRfbW9kZSk7CisJZWxzZQorCQlt
b2RlID0gZHJtX21vZGVfZHVwbGljYXRlKHBhbmVsLT5kcm0sCisJCQkJCSAgJnNvbnlfYWN4NDI0
YWtwX2NtZF9tb2RlKTsKKwlpZiAoIW1vZGUpIHsKKwkJRFJNX0VSUk9SKCJiYWQgbW9kZSBvciBm
YWlsZWQgdG8gYWRkIG1vZGVcbiIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisJZHJtX21vZGVf
c2V0X25hbWUobW9kZSk7CisJbW9kZS0+dHlwZSA9IERSTV9NT0RFX1RZUEVfRFJJVkVSIHwgRFJN
X01PREVfVFlQRV9QUkVGRVJSRUQ7CisKKwljb25uZWN0b3ItPmRpc3BsYXlfaW5mby53aWR0aF9t
bSA9IG1vZGUtPndpZHRoX21tOworCWNvbm5lY3Rvci0+ZGlzcGxheV9pbmZvLmhlaWdodF9tbSA9
IG1vZGUtPmhlaWdodF9tbTsKKworCWRybV9tb2RlX3Byb2JlZF9hZGQoY29ubmVjdG9yLCBtb2Rl
KTsKKworCXJldHVybiAxOyAvKiBOdW1iZXIgb2YgbW9kZXMgKi8KK30KKworc3RhdGljIGNvbnN0
IHN0cnVjdCBkcm1fcGFuZWxfZnVuY3MgYWN4NDI0YWtwX2RybV9mdW5jcyA9IHsKKwkuZGlzYWJs
ZSA9IGFjeDQyNGFrcF9kaXNhYmxlLAorCS51bnByZXBhcmUgPSBhY3g0MjRha3BfdW5wcmVwYXJl
LAorCS5wcmVwYXJlID0gYWN4NDI0YWtwX3ByZXBhcmUsCisJLmVuYWJsZSA9IGFjeDQyNGFrcF9l
bmFibGUsCisJLmdldF9tb2RlcyA9IGFjeDQyNGFrcF9nZXRfbW9kZXMsCit9OworCitzdGF0aWMg
aW50IGFjeDQyNGFrcF9wcm9iZShzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kpCit7CisJc3Ry
dWN0IGRldmljZSAqZGV2ID0gJmRzaS0+ZGV2OworCXN0cnVjdCBhY3g0MjRha3AgKmFjeDsKKwlp
bnQgcmV0OworCXVuc2lnbmVkIGludCBpOworCisJYWN4ID0gZGV2bV9remFsbG9jKGRldiwgc2l6
ZW9mKHN0cnVjdCBhY3g0MjRha3ApLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWFjeCkKKwkJcmV0dXJu
IC1FTk9NRU07CisJYWN4LT52aWRlb19tb2RlID0gb2ZfcHJvcGVydHlfcmVhZF9ib29sKGRldi0+
b2Zfbm9kZSwKKwkJCQkJCSJlbmZvcmNlLXZpZGVvLW1vZGUiKTsKKworCW1pcGlfZHNpX3NldF9k
cnZkYXRhKGRzaSwgYWN4KTsKKwlhY3gtPmRldiA9IGRldjsKKworCWRzaS0+bGFuZXMgPSAyOwor
CWRzaS0+Zm9ybWF0ID0gTUlQSV9EU0lfRk1UX1JHQjg4ODsKKwkvKgorCSAqIEZJWE1FOiB0aGVz
ZSBjb21lIGZyb20gdGhlIFNULUVyaWNzc29uIHZlbmRvciBkcml2ZXIgZm9yIHRoZQorCSAqIEhS
RUY1MjAgYW5kIHNlZW1zIHRvIHJlZmxlY3QgbGltaXRhdGlvbnMgaW4gdGhlIFBMTHMgb24gdGhh
dAorCSAqIHBsYXRmb3JtLCBpZiB5b3UgaGF2ZSB0aGUgZGF0YXNoZWV0LCBwbGVhc2UgY3Jvc3Mt
Y2hlY2sgdGhlCisJICogYWN0dWFsIG1heCByYXRlcy4KKwkgKi8KKwlkc2ktPmxwX3JhdGUgPSAx
OTIwMDAwMDsKKwlkc2ktPmhzX3JhdGUgPSA0MjAxNjAwMDA7CisKKwlpZiAoYWN4LT52aWRlb19t
b2RlKQorCQkvKiBCdXJzdCBtb2RlIHVzaW5nIGV2ZW50IGZvciBzeW5jICovCisJCWRzaS0+bW9k
ZV9mbGFncyA9CisJCQlNSVBJX0RTSV9NT0RFX1ZJREVPIHwKKwkJCU1JUElfRFNJX01PREVfVklE
RU9fQlVSU1Q7CisJZWxzZQorCQlkc2ktPm1vZGVfZmxhZ3MgPQorCQkJTUlQSV9EU0lfQ0xPQ0tf
Tk9OX0NPTlRJTlVPVVMgfAorCQkJTUlQSV9EU0lfTU9ERV9FT1RfUEFDS0VUOworCisJYWN4LT5z
dXBwbHkgPSBkZXZtX3JlZ3VsYXRvcl9nZXQoZGV2LCAidmRkaSIpOworCWlmIChJU19FUlIoYWN4
LT5zdXBwbHkpKQorCQlyZXR1cm4gUFRSX0VSUihhY3gtPnN1cHBseSk7CisKKwkvKiBUaGlzIGFz
c2VydHMgUkVTRVQgYnkgZGVmYXVsdCAqLworCWFjeC0+cmVzZXRfZ3BpbyA9IGRldm1fZ3Bpb2Rf
Z2V0X29wdGlvbmFsKGRldiwgInJlc2V0IiwKKwkJCQkJCSBHUElPRF9PVVRfSElHSCk7CisJaWYg
KElTX0VSUihhY3gtPnJlc2V0X2dwaW8pKSB7CisJCXJldCA9IFBUUl9FUlIoYWN4LT5yZXNldF9n
cGlvKTsKKwkJaWYgKHJldCAhPSAtRVBST0JFX0RFRkVSKQorCQkJRFJNX0RFVl9FUlJPUihkZXYs
ICJmYWlsZWQgdG8gcmVxdWVzdCBHUElPICglZClcbiIsCisJCQkJICAgICAgcmV0KTsKKwkJcmV0
dXJuIHJldDsKKwl9CisKKwlkcm1fcGFuZWxfaW5pdCgmYWN4LT5wYW5lbCk7CisJYWN4LT5wYW5l
bC5kZXYgPSBkZXY7CisJYWN4LT5wYW5lbC5mdW5jcyA9ICZhY3g0MjRha3BfZHJtX2Z1bmNzOwor
CisJYWN4LT5ibCA9IGRldm1fYmFja2xpZ2h0X2RldmljZV9yZWdpc3RlcihkZXYsICJhY3g0MjRh
a3AiLCBkZXYsIGFjeCwKKwkJCQkJCSAmYWN4NDI0YWtwX2JsX29wcywgTlVMTCk7CisJaWYgKElT
X0VSUihhY3gtPmJsKSkgeworCQlEUk1fREVWX0VSUk9SKGRldiwgImZhaWxlZCB0byByZWdpc3Rl
ciBiYWNrbGlnaHQgZGV2aWNlXG4iKTsKKwkJcmV0dXJuIFBUUl9FUlIoYWN4LT5ibCk7CisJfQor
CWFjeC0+YmwtPnByb3BzLm1heF9icmlnaHRuZXNzID0gMTAyMzsKKwlhY3gtPmJsLT5wcm9wcy5i
cmlnaHRuZXNzID0gNTEyOworCWFjeC0+YmwtPnByb3BzLnBvd2VyID0gRkJfQkxBTktfUE9XRVJE
T1dOOworCisJcmV0ID0gZHJtX3BhbmVsX2FkZCgmYWN4LT5wYW5lbCk7CisJaWYgKHJldCA8IDAp
CisJCXJldHVybiByZXQ7CisKKwlyZXQgPSBhY3g0MjRha3BfcG93ZXJfb24oYWN4KTsKKwlpZiAo
cmV0KSB7CisJCURSTV9ERVZfRVJST1IoZGV2LCAiZmFpbGVkIHRvIHBvd2VyIHVwIGRpc3BsYXlc
biIpOworCQlnb3RvIG91dF9yZW1vdmU7CisJfQorCisJLyogVHJ5IDUgdGltZXMgdG8gcmVhZCB0
aGUgZGV2aWNlIElEICovCisJZm9yIChpID0gMDsgaSA8IDU7IGkrKykgeworCQlyZXQgPSBhY3g0
MjRha3BfcmVhZF9pZChhY3gpOworCQlpZiAoIXJldCkKKwkJCWJyZWFrOworCX0KKworCWlmIChy
ZXQpIHsKKwkJRFJNX0RFVl9FUlJPUihhY3gtPmRldiwgImZhaWxlZCB0byByZWFkIHBhbmVsIElE
ICglZClcbiIsIHJldCk7CisJCWdvdG8gb3V0X3Bvd2Vyb2ZmOworCX0KKwlhY3g0MjRha3BfcG93
ZXJfb2ZmKGFjeCk7CisKKwlyZXQgPSBtaXBpX2RzaV9hdHRhY2goZHNpKTsKKwlpZiAocmV0IDwg
MCkKKwkJZ290byBvdXRfcG93ZXJvZmY7CisKKwlyZXR1cm4gMDsKKworb3V0X3Bvd2Vyb2ZmOgor
CWFjeDQyNGFrcF9wb3dlcl9vZmYoYWN4KTsKK291dF9yZW1vdmU6CisJZHJtX3BhbmVsX3JlbW92
ZSgmYWN4LT5wYW5lbCk7CisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBhY3g0MjRha3Bf
cmVtb3ZlKHN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSkKK3sKKwlzdHJ1Y3QgYWN4NDI0YWtw
ICphY3ggPSBtaXBpX2RzaV9nZXRfZHJ2ZGF0YShkc2kpOworCisJbWlwaV9kc2lfZGV0YWNoKGRz
aSk7CisJZHJtX3BhbmVsX3JlbW92ZSgmYWN4LT5wYW5lbCk7CisKKwlyZXR1cm4gMDsKK30KKwor
c3RhdGljIGNvbnN0IHN0cnVjdCBvZl9kZXZpY2VfaWQgYWN4NDI0YWtwX29mX21hdGNoW10gPSB7
CisJeyAuY29tcGF0aWJsZSA9ICJzb255LGFjeDQyNGFrcCIgfSwKKwl7IH0KK307CitNT0RVTEVf
REVWSUNFX1RBQkxFKG9mLCBhY3g0MjRha3Bfb2ZfbWF0Y2gpOworCitzdGF0aWMgc3RydWN0IG1p
cGlfZHNpX2RyaXZlciBhY3g0MjRha3BfZHJpdmVyID0geworCS5wcm9iZSA9IGFjeDQyNGFrcF9w
cm9iZSwKKwkucmVtb3ZlID0gYWN4NDI0YWtwX3JlbW92ZSwKKwkuZHJpdmVyID0geworCQkubmFt
ZSA9ICJwYW5lbC1zb255LWFjeDQyNGFrcCIsCisJCS5vZl9tYXRjaF90YWJsZSA9IGFjeDQyNGFr
cF9vZl9tYXRjaCwKKwl9LAorfTsKK21vZHVsZV9taXBpX2RzaV9kcml2ZXIoYWN4NDI0YWtwX2Ry
aXZlcik7CisKK01PRFVMRV9BVVRIT1IoIkxpbnVzIFdhbGxlaSA8bGludXMud2FsbGVpakBsaW5h
cm8ub3JnPiIpOworTU9EVUxFX0RFU0NSSVBUSU9OKCJNSVBJLURTSSBTb255IGFjeDQyNGFrcCBQ
YW5lbCBEcml2ZXIiKTsKK01PRFVMRV9MSUNFTlNFKCJHUEwgdjIiKTsKZGlmZiAtLWdpdCBhL2lu
Y2x1ZGUvdmlkZW8vbWlwaV9kaXNwbGF5LmggYi9pbmNsdWRlL3ZpZGVvL21pcGlfZGlzcGxheS5o
CmluZGV4IGNiYTU3YTY3OGRhZi4uY2Y5OWM2YTUxOWQ1IDEwMDY0NAotLS0gYS9pbmNsdWRlL3Zp
ZGVvL21pcGlfZGlzcGxheS5oCisrKyBiL2luY2x1ZGUvdmlkZW8vbWlwaV9kaXNwbGF5LmgKQEAg
LTEyNSw2ICsxMjUsNyBAQCBlbnVtIHsKIAlNSVBJX0RDU19HRVRfQ0FCQ19NSU5fQlJJR0hUTkVT
UyA9IDB4NUYsCS8qIE1JUEkgRENTIDEuMyAqLwogCU1JUElfRENTX1JFQURfRERCX1NUQVJUCQk9
IDB4QTEsCiAJTUlQSV9EQ1NfUkVBRF9EREJfQ09OVElOVUUJPSAweEE4LAorCU1JUElfRFNJX0RD
U19TRVRfTURESQkJPSAweEFFLAogfTsKIAogLyogTUlQSSBEQ1MgcGl4ZWwgZm9ybWF0cyAqLwot
LSAKMi4yMS4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
XwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcK
aHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
