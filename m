Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 60C8035E0A7
	for <lists+dri-devel@lfdr.de>; Tue, 13 Apr 2021 15:53:06 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 13A796E19B;
	Tue, 13 Apr 2021 13:52:59 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x52d.google.com (mail-ed1-x52d.google.com
 [IPv6:2a00:1450:4864:20::52d])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 277F76E1A7
 for <dri-devel@lists.freedesktop.org>; Tue, 13 Apr 2021 13:52:56 +0000 (UTC)
Received: by mail-ed1-x52d.google.com with SMTP id bx20so18349879edb.12
 for <dri-devel@lists.freedesktop.org>; Tue, 13 Apr 2021 06:52:56 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=xCO2Ra8J0WhNf+cl3OA3H31lKED2NJxAOYVd7xq+SYM=;
 b=LSlZfP9LOIERMFqrxyFI4cEGupXoHNiufmj5lYi3JGLOJNHQk1Yrbg/QxxHxu9Z9jN
 kNa3YZaQ5ArQ0ZTSngYHCQelUeLuX1Q5wM8v4jQD12a3BMKGUbhW52EYrtjQDoll+CbI
 YxZ0bRbPuenO5N4hV++3GANWWgnYizQDDrdF737LBjj++ueWXGz7e1pQ34pNxfjInTWP
 PImmaXkwWHZfcidxSve8iNJrGSPb+hxW2sjZqC4aowVVcaJaGn0JlMNNX9vmCyxy83yp
 Ho3Yj3ETwiCihXsiARXhBhNZZbNkVwEaamGgUD1QOWEOusCMUTpY+ZXAhmlT6G2i05F8
 lrWg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=xCO2Ra8J0WhNf+cl3OA3H31lKED2NJxAOYVd7xq+SYM=;
 b=cEcnGJPaU5HGUj3AzMSxV3CqHuoE4swLIoJxZOf32UmJV3qjyWaVmb8ZrSmJFrjlLD
 RlqqpjNEIStQKwRawrKzIA2qYzElLQK6nQlx72SyxmtKNXirAaMwfYFGumJ5I15ydKKQ
 h4HpRJKvuEiIpGNfSuKTVS7RL+nZGyYkSd8niu0OuoQ8io+m4cmzz82FJguUSV2JB7RL
 GLOBj7vI4K54eokD2WnAFvs/gpQN2vJkYjYMg7bR03bTG7ylcTOZXVNPKk65wd4MClYX
 j0exeTDXsh/4SYrGpj3MTuBY/llWtt5MG8jrTFhOt1ILC1UOTmeGqaijUkiC/A8nbsxn
 1Y2w==
X-Gm-Message-State: AOAM531kRDE4H7MEO2VozzeOfBIjUj/eL02WKuobVov4/BVyqAMIg7hi
 BJPdTDYU24LA82dLRusW14ayc8So6LY=
X-Google-Smtp-Source: ABdhPJwxviuy5BbwvknKK7A9S2xeEmB1nB2yTag7AFOHeIoJoAP6KO1Ze1F564UCjjP0gjUqlm/D5w==
X-Received: by 2002:a05:6402:27d4:: with SMTP id
 c20mr35421921ede.271.1618321974325; 
 Tue, 13 Apr 2021 06:52:54 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:a061:9101:8418:4794])
 by smtp.gmail.com with ESMTPSA id m10sm491465ejc.32.2021.04.13.06.52.53
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 13 Apr 2021 06:52:53 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 7/7] drm/ttm: rename bo->mem and make it a pointer
Date: Tue, 13 Apr 2021 15:52:48 +0200
Message-Id: <20210413135248.1266-7-christian.koenig@amd.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20210413135248.1266-1-christian.koenig@amd.com>
References: <20210413135248.1266-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: daniel.vetter@ffwll.ch, thomas.hellstrom@linux.intel.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

V2hlbiB3ZSB3YW50IHRvIGRlY291YmxlIHJlc291cmNlIG1hbmFnZW1lbnQgZnJvbSBidWZmZXIg
bWFuYWdlbWVudCB3ZSBuZWVkIHRvCmJlIGFibGUgdG8gaGFuZGxlIHJlc291cmNlcyBzZXBhcmF0
ZWx5LgoKQWRkIGEgcmVzb3VyY2UgcG9pbnRlciBhbmQgcmVuYW1lIGJvLT5tZW0gc28gdGhhdCBh
bGwgY29kZSBuZWVkcyB0bwpjaGFuZ2UgdG8gYWNjZXNzIHRoZSBwb2ludGVyIGluc3RlYWQuCgpO
byBmdW5jdGlvbmFsIGNoYW5nZS4KClNpZ25lZC1vZmYtYnk6IENocmlzdGlhbiBLw7ZuaWcgPGNo
cmlzdGlhbi5rb2VuaWdAYW1kLmNvbT4KLS0tCiAuLi4vZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9hbWRrZmRfZ3B1dm0uYyAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X2RldmljZS5jICAgIHwgIDYgKy0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfZG1hX2J1Zi5jICAgfCAgOCArLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9nbWMuYyAgICAgICB8ICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
Z3R0X21nci5jICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X29i
amVjdC5jICAgIHwgNDggKysrKysrKysrLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9hbWRncHVfb2JqZWN0LmggICAgfCAgNiArLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV90cmFjZS5oICAgICB8ICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfdHRtLmMgICAgICAgfCA0MiArKysrKysrKy0tLS0tLS0tCiBkcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uYyAgICAgICAgfCAxMiArKy0tLQogZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZyYW1fbWdyLmMgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9kcm1fZ2VtX3R0bV9oZWxwZXIuYyAgICAgICAgICB8ICA2ICstLQogZHJpdmVycy9ncHUvZHJt
L2RybV9nZW1fdnJhbV9oZWxwZXIuYyAgICAgICAgIHwgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9u
b3V2ZWF1L25vdXZlYXVfYWJpMTYuYyAgICAgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vbm91
dmVhdS9ub3V2ZWF1X2JvLmMgICAgICAgICAgfCAzMCArKysrKystLS0tLS0KIGRyaXZlcnMvZ3B1
L2RybS9ub3V2ZWF1L25vdXZlYXVfY2hhbi5jICAgICAgICB8ICAyICstCiBkcml2ZXJzL2dwdS9k
cm0vbm91dmVhdS9ub3V2ZWF1X2ZiY29uLmMgICAgICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJt
L25vdXZlYXUvbm91dmVhdV9nZW0uYyAgICAgICAgIHwgMTYgKysrLS0tCiBkcml2ZXJzL2dwdS9k
cm0vbm91dmVhdS9ub3V2ZWF1X3ZtbS5jICAgICAgICAgfCAgNCArLQogZHJpdmVycy9ncHUvZHJt
L25vdXZlYXUvbnYxN19mZW5jZS5jICAgICAgICAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9u
b3V2ZWF1L252NTBfZmVuY2UuYyAgICAgICAgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vcXhs
L3F4bF9kcnYuaCAgICAgICAgICAgICAgICAgfCAgNiArLS0KIGRyaXZlcnMvZ3B1L2RybS9xeGwv
cXhsX29iamVjdC5jICAgICAgICAgICAgICB8IDEwICsrLS0KIGRyaXZlcnMvZ3B1L2RybS9xeGwv
cXhsX3R0bS5jICAgICAgICAgICAgICAgICB8ICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vcmFkZW9u
L3JhZGVvbl9jcy5jICAgICAgICAgICAgfCAgOCArLS0KIGRyaXZlcnMvZ3B1L2RybS9yYWRlb24v
cmFkZW9uX2dlbS5jICAgICAgICAgICB8IDEwICsrLS0KIGRyaXZlcnMvZ3B1L2RybS9yYWRlb24v
cmFkZW9uX29iamVjdC5jICAgICAgICB8IDIyICsrKystLS0tLQogZHJpdmVycy9ncHUvZHJtL3Jh
ZGVvbi9yYWRlb25fb2JqZWN0LmggICAgICAgIHwgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9yYWRl
b24vcmFkZW9uX3BtLmMgICAgICAgICAgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vcmFkZW9u
L3JhZGVvbl90cmFjZS5oICAgICAgICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9y
YWRlb25fdHRtLmMgICAgICAgICAgIHwgIDggKy0tCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9i
by5jICAgICAgICAgICAgICAgICAgfCAzOSArKysrKysrKy0tLS0tLS0KIGRyaXZlcnMvZ3B1L2Ry
bS90dG0vdHRtX2JvX3V0aWwuYyAgICAgICAgICAgICB8IDQ5ICsrKysrKysrKystLS0tLS0tLS0K
IGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3ZtLmMgICAgICAgICAgICAgICB8IDIyICsrKyst
LS0tLQogZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfYmxpdC5jICAgICAgICAgIHwgIDgg
Ky0tCiBkcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9iby5jICAgICAgICAgICAgfCAzNiAr
KysrKysrLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfY21kLmMgICAgICAg
ICAgIHwgMTAgKystLQogZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfY21kYnVmLmMgICAg
ICAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2NvbnRleHQuYyAgICAg
ICB8IDEyICsrLS0tCiBkcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9jb3RhYmxlLmMgICAg
ICAgfCAxMCArKy0tCiBkcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9leGVjYnVmLmMgICAg
ICAgfCAxMiArKy0tLQogZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfcGFnZV9kaXJ0eS5j
ICAgIHwgIDggKy0tCiBkcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9zaGFkZXIuYyAgICAg
ICAgfCAxMiArKy0tLQogZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfc3RyZWFtb3V0cHV0
LmMgIHwgIDYgKy0tCiBkcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9zdXJmYWNlLmMgICAg
ICAgfCAgNiArLS0KIGRyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3R0bV9idWZmZXIuYyAg
ICB8IDEwICsrLS0KIGluY2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmggICAgICAgICAgICAgICAg
ICB8ICAzICstCiBpbmNsdWRlL2RybS90dG0vdHRtX2JvX2RyaXZlci5oICAgICAgICAgICAgICAg
fCAgNiArLS0KIDQ4IGZpbGVzIGNoYW5nZWQsIDI2OSBpbnNlcnRpb25zKCspLCAyNjQgZGVsZXRp
b25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Ft
ZGtmZF9ncHV2bS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9n
cHV2bS5jCmluZGV4IDlmNmIyOTljYmY3NC4uMmE2YzJhM2M3YjZkIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dwdXZtLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9ncHV2bS5jCkBAIC0xNDIzLDcgKzE0
MjMsNyBAQCBpbnQgYW1kZ3B1X2FtZGtmZF9ncHV2bV9tYXBfbWVtb3J5X3RvX2dwdSgKIAkgKiB0
aGUgbmV4dCByZXN0b3JlIHdvcmtlcgogCSAqLwogCWlmIChhbWRncHVfdHRtX3R0X2dldF91c2Vy
bW0oYm8tPnRiby50dG0pICYmCi0JICAgIGJvLT50Ym8ubWVtLm1lbV90eXBlID09IFRUTV9QTF9T
WVNURU0pCisJICAgIGJvLT50Ym8ucmVzb3VyY2UtPm1lbV90eXBlID09IFRUTV9QTF9TWVNURU0p
CiAJCWlzX2ludmFsaWRfdXNlcnB0ciA9IHRydWU7CiAKIAlpZiAoY2hlY2tfaWZfYWRkX2JvX3Rv
X3ZtKGF2bSwgbWVtKSkgewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X2RldmljZS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Rldmlj
ZS5jCmluZGV4IDMzYjZlNDYwZjQ4MS4uZTRkYTkzM2FhZjRlIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZGV2aWNlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X2RldmljZS5jCkBAIC00MDU3LDkgKzQwNTcsOSBAQCBzdGF0aWMg
aW50IGFtZGdwdV9kZXZpY2VfcmVjb3Zlcl92cmFtKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2
KQogCWxpc3RfZm9yX2VhY2hfZW50cnkoc2hhZG93LCAmYWRldi0+c2hhZG93X2xpc3QsIHNoYWRv
d19saXN0KSB7CiAKIAkJLyogTm8gbmVlZCB0byByZWNvdmVyIGFuIGV2aWN0ZWQgQk8gKi8KLQkJ
aWYgKHNoYWRvdy0+dGJvLm1lbS5tZW1fdHlwZSAhPSBUVE1fUExfVFQgfHwKLQkJICAgIHNoYWRv
dy0+dGJvLm1lbS5zdGFydCA9PSBBTURHUFVfQk9fSU5WQUxJRF9PRkZTRVQgfHwKLQkJICAgIHNo
YWRvdy0+cGFyZW50LT50Ym8ubWVtLm1lbV90eXBlICE9IFRUTV9QTF9WUkFNKQorCQlpZiAoc2hh
ZG93LT50Ym8ucmVzb3VyY2UtPm1lbV90eXBlICE9IFRUTV9QTF9UVCB8fAorCQkgICAgc2hhZG93
LT50Ym8ucmVzb3VyY2UtPnN0YXJ0ID09IEFNREdQVV9CT19JTlZBTElEX09GRlNFVCB8fAorCQkg
ICAgc2hhZG93LT5wYXJlbnQtPnRiby5yZXNvdXJjZS0+bWVtX3R5cGUgIT0gVFRNX1BMX1ZSQU0p
CiAJCQljb250aW51ZTsKIAogCQlyID0gYW1kZ3B1X2JvX3Jlc3RvcmVfc2hhZG93KHNoYWRvdywg
Jm5leHQpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Rt
YV9idWYuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kbWFfYnVmLmMKaW5k
ZXggNDdlMGI0OGRjMjZmLi42OWU0YjI5MjAzYTUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV9kbWFfYnVmLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X2RtYV9idWYuYwpAQCAtMjcyLDEyICsyNzIsMTIgQEAgc3RhdGljIHN0cnVj
dCBzZ190YWJsZSAqYW1kZ3B1X2RtYV9idWZfbWFwKHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQg
KmF0dGFjaCwKIAkJaWYgKHIpCiAJCQlyZXR1cm4gRVJSX1BUUihyKTsKIAotCX0gZWxzZSBpZiAo
IShhbWRncHVfbWVtX3R5cGVfdG9fZG9tYWluKGJvLT50Ym8ubWVtLm1lbV90eXBlKSAmCisJfSBl
bHNlIGlmICghKGFtZGdwdV9tZW1fdHlwZV90b19kb21haW4oYm8tPnRiby5yZXNvdXJjZS0+bWVt
X3R5cGUpICYKIAkJICAgICBBTURHUFVfR0VNX0RPTUFJTl9HVFQpKSB7CiAJCXJldHVybiBFUlJf
UFRSKC1FQlVTWSk7CiAJfQogCi0Jc3dpdGNoIChiby0+dGJvLm1lbS5tZW1fdHlwZSkgeworCXN3
aXRjaCAoYm8tPnRiby5yZXNvdXJjZS0+bWVtX3R5cGUpIHsKIAljYXNlIFRUTV9QTF9UVDoKIAkJ
c2d0ID0gZHJtX3ByaW1lX3BhZ2VzX3RvX3NnKG9iai0+ZGV2LAogCQkJCQkgICAgYm8tPnRiby50
dG0tPnBhZ2VzLApAQCAtMjkxLDcgKzI5MSw3IEBAIHN0YXRpYyBzdHJ1Y3Qgc2dfdGFibGUgKmFt
ZGdwdV9kbWFfYnVmX21hcChzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICphdHRhY2gsCiAJCWJy
ZWFrOwogCiAJY2FzZSBUVE1fUExfVlJBTToKLQkJciA9IGFtZGdwdV92cmFtX21ncl9hbGxvY19z
Z3QoYWRldiwgJmJvLT50Ym8ubWVtLCBhdHRhY2gtPmRldiwKKwkJciA9IGFtZGdwdV92cmFtX21n
cl9hbGxvY19zZ3QoYWRldiwgYm8tPnRiby5yZXNvdXJjZSwgYXR0YWNoLT5kZXYsCiAJCQkJCSAg
ICAgIGRpciwgJnNndCk7CiAJCWlmIChyKQogCQkJcmV0dXJuIEVSUl9QVFIocik7CkBAIC00ODcs
NyArNDg3LDcgQEAgYW1kZ3B1X2RtYV9idWZfbW92ZV9ub3RpZnkoc3RydWN0IGRtYV9idWZfYXR0
YWNobWVudCAqYXR0YWNoKQogCXN0cnVjdCBhbWRncHVfdm1fYm9fYmFzZSAqYm9fYmFzZTsKIAlp
bnQgcjsKIAotCWlmIChiby0+dGJvLm1lbS5tZW1fdHlwZSA9PSBUVE1fUExfU1lTVEVNKQorCWlm
IChiby0+dGJvLnJlc291cmNlLT5tZW1fdHlwZSA9PSBUVE1fUExfU1lTVEVNKQogCQlyZXR1cm47
CiAKIAlyID0gdHRtX2JvX3ZhbGlkYXRlKCZiby0+dGJvLCAmcGxhY2VtZW50LCAmY3R4KTsKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nbWMuYyBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nbWMuYwppbmRleCBmZTFhMzlmZmRhNzIuLmI3
ZDdmZmY2YjM3YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X2dtYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nbWMuYwpAQCAt
NDYsNyArNDYsNyBAQCB2b2lkIGFtZGdwdV9nbWNfZ2V0X3BkZV9mb3JfYm8oc3RydWN0IGFtZGdw
dV9ibyAqYm8sIGludCBsZXZlbCwKIHsKIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGFt
ZGdwdV90dG1fYWRldihiby0+dGJvLmJkZXYpOwogCi0Jc3dpdGNoIChiby0+dGJvLm1lbS5tZW1f
dHlwZSkgeworCXN3aXRjaCAoYm8tPnRiby5yZXNvdXJjZS0+bWVtX3R5cGUpIHsKIAljYXNlIFRU
TV9QTF9UVDoKIAkJKmFkZHIgPSBiby0+dGJvLnR0bS0+ZG1hX2FkZHJlc3NbMF07CiAJCWJyZWFr
OwpAQCAtNTcsNyArNTcsNyBAQCB2b2lkIGFtZGdwdV9nbWNfZ2V0X3BkZV9mb3JfYm8oc3RydWN0
IGFtZGdwdV9ibyAqYm8sIGludCBsZXZlbCwKIAkJKmFkZHIgPSAwOwogCQlicmVhazsKIAl9Ci0J
KmZsYWdzID0gYW1kZ3B1X3R0bV90dF9wZGVfZmxhZ3MoYm8tPnRiby50dG0sICZiby0+dGJvLm1l
bSk7CisJKmZsYWdzID0gYW1kZ3B1X3R0bV90dF9wZGVfZmxhZ3MoYm8tPnRiby50dG0sIGJvLT50
Ym8ucmVzb3VyY2UpOwogCWFtZGdwdV9nbWNfZ2V0X3ZtX3BkZShhZGV2LCBsZXZlbCwgYWRkciwg
ZmxhZ3MpOwogfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfZ3R0X21nci5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2d0dF9tZ3Iu
YwppbmRleCBjMDI2OTcyY2E5YTEuLjEwODY2ODdhODEzOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2d0dF9tZ3IuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfZ3R0X21nci5jCkBAIC0xMTIsNyArMTEyLDcgQEAgc3RhdGljIGlu
dCBhbWRncHVfZ3R0X21ncl9uZXcoc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYW4sCiAJ
aW50IHI7CiAKIAlzcGluX2xvY2soJm1nci0+bG9jayk7Ci0JaWYgKCgmdGJvLT5tZW0gPT0gbWVt
IHx8IHRiby0+bWVtLm1lbV90eXBlICE9IFRUTV9QTF9UVCkgJiYKKwlpZiAoKHRiby0+cmVzb3Vy
Y2UgPT0gbWVtIHx8IHRiby0+cmVzb3VyY2UtPm1lbV90eXBlICE9IFRUTV9QTF9UVCkgJiYKIAkg
ICAgYXRvbWljNjRfcmVhZCgmbWdyLT5hdmFpbGFibGUpIDwgbWVtLT5udW1fcGFnZXMpIHsKIAkJ
c3Bpbl91bmxvY2soJm1nci0+bG9jayk7CiAJCXJldHVybiAtRU5PU1BDOwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X29iamVjdC5jIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X29iamVjdC5jCmluZGV4IGUzMTZjZWJiMWZkYy4uZTFmM2Nk
NmMzZjIzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfb2Jq
ZWN0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X29iamVjdC5jCkBA
IC02NCwxMSArNjQsMTEgQEAgc3RhdGljIHZvaWQgYW1kZ3B1X2JvX3N1YnRyYWN0X3Bpbl9zaXpl
KHN0cnVjdCBhbWRncHVfYm8gKmJvKQogewogCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0g
YW1kZ3B1X3R0bV9hZGV2KGJvLT50Ym8uYmRldik7CiAKLQlpZiAoYm8tPnRiby5tZW0ubWVtX3R5
cGUgPT0gVFRNX1BMX1ZSQU0pIHsKKwlpZiAoYm8tPnRiby5yZXNvdXJjZS0+bWVtX3R5cGUgPT0g
VFRNX1BMX1ZSQU0pIHsKIAkJYXRvbWljNjRfc3ViKGFtZGdwdV9ib19zaXplKGJvKSwgJmFkZXYt
PnZyYW1fcGluX3NpemUpOwogCQlhdG9taWM2NF9zdWIoYW1kZ3B1X3ZyYW1fbWdyX2JvX3Zpc2li
bGVfc2l6ZShibyksCiAJCQkgICAgICZhZGV2LT52aXNpYmxlX3Bpbl9zaXplKTsKLQl9IGVsc2Ug
aWYgKGJvLT50Ym8ubWVtLm1lbV90eXBlID09IFRUTV9QTF9UVCkgeworCX0gZWxzZSBpZiAoYm8t
PnRiby5yZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1RUKSB7CiAJCWF0b21pYzY0X3N1Yihh
bWRncHVfYm9fc2l6ZShibyksICZhZGV2LT5nYXJ0X3Bpbl9zaXplKTsKIAl9CiB9CkBAIC0zODAs
MTQgKzM4MCwxNCBAQCBpbnQgYW1kZ3B1X2JvX2NyZWF0ZV9rZXJuZWxfYXQoc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYsCiAJaWYgKGNwdV9hZGRyKQogCQlhbWRncHVfYm9fa3VubWFwKCpib19w
dHIpOwogCi0JdHRtX3Jlc291cmNlX2ZyZWUoJigqYm9fcHRyKS0+dGJvLCAmKCpib19wdHIpLT50
Ym8ubWVtKTsKKwl0dG1fcmVzb3VyY2VfZnJlZSgmKCpib19wdHIpLT50Ym8sICgqYm9fcHRyKS0+
dGJvLnJlc291cmNlKTsKIAogCWZvciAoaSA9IDA7IGkgPCAoKmJvX3B0ciktPnBsYWNlbWVudC5u
dW1fcGxhY2VtZW50OyArK2kpIHsKIAkJKCpib19wdHIpLT5wbGFjZW1lbnRzW2ldLmZwZm4gPSBv
ZmZzZXQgPj4gUEFHRV9TSElGVDsKIAkJKCpib19wdHIpLT5wbGFjZW1lbnRzW2ldLmxwZm4gPSAo
b2Zmc2V0ICsgc2l6ZSkgPj4gUEFHRV9TSElGVDsKIAl9CiAJciA9IHR0bV9ib19tZW1fc3BhY2Uo
JigqYm9fcHRyKS0+dGJvLCAmKCpib19wdHIpLT5wbGFjZW1lbnQsCi0JCQkgICAgICYoKmJvX3B0
ciktPnRiby5tZW0sICZjdHgpOworCQkJICAgICAoKmJvX3B0ciktPnRiby5yZXNvdXJjZSwgJmN0
eCk7CiAJaWYgKHIpCiAJCWdvdG8gZXJyb3I7CiAKQEAgLTU3OSwxNSArNTc5LDE1IEBAIHN0YXRp
YyBpbnQgYW1kZ3B1X2JvX2RvX2NyZWF0ZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIAkJ
cmV0dXJuIHI7CiAKIAlpZiAoIWFtZGdwdV9nbWNfdnJhbV9mdWxsX3Zpc2libGUoJmFkZXYtPmdt
YykgJiYKLQkgICAgYm8tPnRiby5tZW0ubWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0gJiYKLQkgICAg
Ym8tPnRiby5tZW0uc3RhcnQgPCBhZGV2LT5nbWMudmlzaWJsZV92cmFtX3NpemUgPj4gUEFHRV9T
SElGVCkKKwkgICAgYm8tPnRiby5yZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0gJiYK
KwkgICAgYm8tPnRiby5yZXNvdXJjZS0+c3RhcnQgPCBhZGV2LT5nbWMudmlzaWJsZV92cmFtX3Np
emUgPj4gUEFHRV9TSElGVCkKIAkJYW1kZ3B1X2NzX3JlcG9ydF9tb3ZlZF9ieXRlcyhhZGV2LCBj
dHguYnl0ZXNfbW92ZWQsCiAJCQkJCSAgICAgY3R4LmJ5dGVzX21vdmVkKTsKIAllbHNlCiAJCWFt
ZGdwdV9jc19yZXBvcnRfbW92ZWRfYnl0ZXMoYWRldiwgY3R4LmJ5dGVzX21vdmVkLCAwKTsKIAog
CWlmIChicC0+ZmxhZ3MgJiBBTURHUFVfR0VNX0NSRUFURV9WUkFNX0NMRUFSRUQgJiYKLQkgICAg
Ym8tPnRiby5tZW0ubWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0pIHsKKwkgICAgYm8tPnRiby5yZXNv
dXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0pIHsKIAkJc3RydWN0IGRtYV9mZW5jZSAqZmVu
Y2U7CiAKIAkJciA9IGFtZGdwdV9maWxsX2J1ZmZlcihibywgMCwgYm8tPnRiby5iYXNlLnJlc3Ys
ICZmZW5jZSk7CkBAIC03ODMsNyArNzgzLDcgQEAgaW50IGFtZGdwdV9ib19rbWFwKHN0cnVjdCBh
bWRncHVfYm8gKmJvLCB2b2lkICoqcHRyKQogCWlmIChyIDwgMCkKIAkJcmV0dXJuIHI7CiAKLQly
ID0gdHRtX2JvX2ttYXAoJmJvLT50Ym8sIDAsIGJvLT50Ym8ubWVtLm51bV9wYWdlcywgJmJvLT5r
bWFwKTsKKwlyID0gdHRtX2JvX2ttYXAoJmJvLT50Ym8sIDAsIGJvLT50Ym8ucmVzb3VyY2UtPm51
bV9wYWdlcywgJmJvLT5rbWFwKTsKIAlpZiAocikKIAkJcmV0dXJuIHI7CiAKQEAgLTkwNiw4ICs5
MDYsOCBAQCBpbnQgYW1kZ3B1X2JvX3Bpbl9yZXN0cmljdGVkKHN0cnVjdCBhbWRncHVfYm8gKmJv
LCB1MzIgZG9tYWluLAogCWRvbWFpbiA9IGFtZGdwdV9ib19nZXRfcHJlZmVycmVkX3Bpbl9kb21h
aW4oYWRldiwgZG9tYWluKTsKIAogCWlmIChiby0+dGJvLnBpbl9jb3VudCkgewotCQl1aW50MzJf
dCBtZW1fdHlwZSA9IGJvLT50Ym8ubWVtLm1lbV90eXBlOwotCQl1aW50MzJfdCBtZW1fZmxhZ3Mg
PSBiby0+dGJvLm1lbS5wbGFjZW1lbnQ7CisJCXVpbnQzMl90IG1lbV90eXBlID0gYm8tPnRiby5y
ZXNvdXJjZS0+bWVtX3R5cGU7CisJCXVpbnQzMl90IG1lbV9mbGFncyA9IGJvLT50Ym8ucmVzb3Vy
Y2UtPnBsYWNlbWVudDsKIAogCQlpZiAoIShkb21haW4gJiBhbWRncHVfbWVtX3R5cGVfdG9fZG9t
YWluKG1lbV90eXBlKSkpCiAJCQlyZXR1cm4gLUVJTlZBTDsKQEAgLTk1Nyw3ICs5NTcsNyBAQCBp
bnQgYW1kZ3B1X2JvX3Bpbl9yZXN0cmljdGVkKHN0cnVjdCBhbWRncHVfYm8gKmJvLCB1MzIgZG9t
YWluLAogCiAJdHRtX2JvX3BpbigmYm8tPnRibyk7CiAKLQlkb21haW4gPSBhbWRncHVfbWVtX3R5
cGVfdG9fZG9tYWluKGJvLT50Ym8ubWVtLm1lbV90eXBlKTsKKwlkb21haW4gPSBhbWRncHVfbWVt
X3R5cGVfdG9fZG9tYWluKGJvLT50Ym8ucmVzb3VyY2UtPm1lbV90eXBlKTsKIAlpZiAoZG9tYWlu
ID09IEFNREdQVV9HRU1fRE9NQUlOX1ZSQU0pIHsKIAkJYXRvbWljNjRfYWRkKGFtZGdwdV9ib19z
aXplKGJvKSwgJmFkZXYtPnZyYW1fcGluX3NpemUpOwogCQlhdG9taWM2NF9hZGQoYW1kZ3B1X3Zy
YW1fbWdyX2JvX3Zpc2libGVfc2l6ZShibyksCkBAIC0xMjQzLDcgKzEyNDMsNyBAQCB2b2lkIGFt
ZGdwdV9ib19tb3ZlX25vdGlmeShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogewogCXN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gYW1kZ3B1X3R0bV9hZGV2KGJvLT5iZGV2KTsKIAlz
dHJ1Y3QgYW1kZ3B1X2JvICphYm87Ci0Jc3RydWN0IHR0bV9yZXNvdXJjZSAqb2xkX21lbSA9ICZi
by0+bWVtOworCXN0cnVjdCB0dG1fcmVzb3VyY2UgKm9sZF9tZW0gPSBiby0+cmVzb3VyY2U7CiAK
IAlpZiAoIWFtZGdwdV9ib19pc19hbWRncHVfYm8oYm8pKQogCQlyZXR1cm47CkBAIC0xMjU0LDcg
KzEyNTQsNyBAQCB2b2lkIGFtZGdwdV9ib19tb3ZlX25vdGlmeShzdHJ1Y3QgdHRtX2J1ZmZlcl9v
YmplY3QgKmJvLAogCWFtZGdwdV9ib19rdW5tYXAoYWJvKTsKIAogCWlmIChhYm8tPnRiby5iYXNl
LmRtYV9idWYgJiYgIWFiby0+dGJvLmJhc2UuaW1wb3J0X2F0dGFjaCAmJgotCSAgICBiby0+bWVt
Lm1lbV90eXBlICE9IFRUTV9QTF9TWVNURU0pCisJICAgIGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUg
IT0gVFRNX1BMX1NZU1RFTSkKIAkJZG1hX2J1Zl9tb3ZlX25vdGlmeShhYm8tPnRiby5iYXNlLmRt
YV9idWYpOwogCiAJLyogcmVtZW1iZXIgdGhlIGV2aWN0aW9uICovCkBAIC0xMjk2LDcgKzEyOTYs
NyBAQCB2b2lkIGFtZGdwdV9ib19yZWxlYXNlX25vdGlmeShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmpl
Y3QgKmJvKQogCWlmIChiby0+YmFzZS5yZXN2ID09ICZiby0+YmFzZS5fcmVzdikKIAkJYW1kZ3B1
X2FtZGtmZF9yZW1vdmVfZmVuY2Vfb25fcHRfcGRfYm9zKGFibyk7CiAKLQlpZiAoYm8tPm1lbS5t
ZW1fdHlwZSAhPSBUVE1fUExfVlJBTSB8fCAhYm8tPm1lbS5tbV9ub2RlIHx8CisJaWYgKGJvLT5y
ZXNvdXJjZS0+bWVtX3R5cGUgIT0gVFRNX1BMX1ZSQU0gfHwgIWJvLT5yZXNvdXJjZS0+bW1fbm9k
ZSB8fAogCSAgICAhKGFiby0+ZmxhZ3MgJiBBTURHUFVfR0VNX0NSRUFURV9WUkFNX1dJUEVfT05f
UkVMRUFTRSkpCiAJCXJldHVybjsKIApAQCAtMTMzMywxMCArMTMzMywxMCBAQCB2bV9mYXVsdF90
IGFtZGdwdV9ib19mYXVsdF9yZXNlcnZlX25vdGlmeShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3Qg
KmJvKQogCS8qIFJlbWVtYmVyIHRoYXQgdGhpcyBCTyB3YXMgYWNjZXNzZWQgYnkgdGhlIENQVSAq
LwogCWFiby0+ZmxhZ3MgfD0gQU1ER1BVX0dFTV9DUkVBVEVfQ1BVX0FDQ0VTU19SRVFVSVJFRDsK
IAotCWlmIChiby0+bWVtLm1lbV90eXBlICE9IFRUTV9QTF9WUkFNKQorCWlmIChiby0+cmVzb3Vy
Y2UtPm1lbV90eXBlICE9IFRUTV9QTF9WUkFNKQogCQlyZXR1cm4gMDsKIAotCW9mZnNldCA9IGJv
LT5tZW0uc3RhcnQgPDwgUEFHRV9TSElGVDsKKwlvZmZzZXQgPSBiby0+cmVzb3VyY2UtPnN0YXJ0
IDw8IFBBR0VfU0hJRlQ7CiAJaWYgKChvZmZzZXQgKyBiby0+YmFzZS5zaXplKSA8PSBhZGV2LT5n
bWMudmlzaWJsZV92cmFtX3NpemUpCiAJCXJldHVybiAwOwogCkBAIC0xMzU5LDkgKzEzNTksOSBA
QCB2bV9mYXVsdF90IGFtZGdwdV9ib19mYXVsdF9yZXNlcnZlX25vdGlmeShzdHJ1Y3QgdHRtX2J1
ZmZlcl9vYmplY3QgKmJvKQogCWVsc2UgaWYgKHVubGlrZWx5KHIpKQogCQlyZXR1cm4gVk1fRkFV
TFRfU0lHQlVTOwogCi0Jb2Zmc2V0ID0gYm8tPm1lbS5zdGFydCA8PCBQQUdFX1NISUZUOworCW9m
ZnNldCA9IGJvLT5yZXNvdXJjZS0+c3RhcnQgPDwgUEFHRV9TSElGVDsKIAkvKiB0aGlzIHNob3Vs
ZCBuZXZlciBoYXBwZW4gKi8KLQlpZiAoYm8tPm1lbS5tZW1fdHlwZSA9PSBUVE1fUExfVlJBTSAm
JgorCWlmIChiby0+cmVzb3VyY2UtPm1lbV90eXBlID09IFRUTV9QTF9WUkFNICYmCiAJICAgIChv
ZmZzZXQgKyBiby0+YmFzZS5zaXplKSA+IGFkZXYtPmdtYy52aXNpYmxlX3ZyYW1fc2l6ZSkKIAkJ
cmV0dXJuIFZNX0ZBVUxUX1NJR0JVUzsKIApAQCAtMTQ0NiwxMSArMTQ0NiwxMSBAQCBpbnQgYW1k
Z3B1X2JvX3N5bmNfd2FpdChzdHJ1Y3QgYW1kZ3B1X2JvICpibywgdm9pZCAqb3duZXIsIGJvb2wg
aW50cikKICAqLwogdTY0IGFtZGdwdV9ib19ncHVfb2Zmc2V0KHN0cnVjdCBhbWRncHVfYm8gKmJv
KQogewotCVdBUk5fT05fT05DRShiby0+dGJvLm1lbS5tZW1fdHlwZSA9PSBUVE1fUExfU1lTVEVN
KTsKKwlXQVJOX09OX09OQ0UoYm8tPnRiby5yZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1NZ
U1RFTSk7CiAJV0FSTl9PTl9PTkNFKCFkbWFfcmVzdl9pc19sb2NrZWQoYm8tPnRiby5iYXNlLnJl
c3YpICYmCiAJCSAgICAgIWJvLT50Ym8ucGluX2NvdW50ICYmIGJvLT50Ym8udHlwZSAhPSB0dG1f
Ym9fdHlwZV9rZXJuZWwpOwotCVdBUk5fT05fT05DRShiby0+dGJvLm1lbS5zdGFydCA9PSBBTURH
UFVfQk9fSU5WQUxJRF9PRkZTRVQpOwotCVdBUk5fT05fT05DRShiby0+dGJvLm1lbS5tZW1fdHlw
ZSA9PSBUVE1fUExfVlJBTSAmJgorCVdBUk5fT05fT05DRShiby0+dGJvLnJlc291cmNlLT5zdGFy
dCA9PSBBTURHUFVfQk9fSU5WQUxJRF9PRkZTRVQpOworCVdBUk5fT05fT05DRShiby0+dGJvLnJl
c291cmNlLT5tZW1fdHlwZSA9PSBUVE1fUExfVlJBTSAmJgogCQkgICAgICEoYm8tPmZsYWdzICYg
QU1ER1BVX0dFTV9DUkVBVEVfVlJBTV9DT05USUdVT1VTKSk7CiAKIAlyZXR1cm4gYW1kZ3B1X2Jv
X2dwdV9vZmZzZXRfbm9fY2hlY2soYm8pOwpAQCAtMTQ2OCw4ICsxNDY4LDggQEAgdTY0IGFtZGdw
dV9ib19ncHVfb2Zmc2V0X25vX2NoZWNrKHN0cnVjdCBhbWRncHVfYm8gKmJvKQogCXN0cnVjdCBh
bWRncHVfZGV2aWNlICphZGV2ID0gYW1kZ3B1X3R0bV9hZGV2KGJvLT50Ym8uYmRldik7CiAJdWlu
dDY0X3Qgb2Zmc2V0OwogCi0Jb2Zmc2V0ID0gKGJvLT50Ym8ubWVtLnN0YXJ0IDw8IFBBR0VfU0hJ
RlQpICsKLQkJIGFtZGdwdV90dG1fZG9tYWluX3N0YXJ0KGFkZXYsIGJvLT50Ym8ubWVtLm1lbV90
eXBlKTsKKwlvZmZzZXQgPSAoYm8tPnRiby5yZXNvdXJjZS0+c3RhcnQgPDwgUEFHRV9TSElGVCkg
KworCQkgYW1kZ3B1X3R0bV9kb21haW5fc3RhcnQoYWRldiwgYm8tPnRiby5yZXNvdXJjZS0+bWVt
X3R5cGUpOwogCiAJcmV0dXJuIGFtZGdwdV9nbWNfc2lnbl9leHRlbmQob2Zmc2V0KTsKIH0KQEAg
LTE1MjIsNyArMTUyMiw3IEBAIHU2NCBhbWRncHVfYm9fcHJpbnRfaW5mbyhpbnQgaWQsIHN0cnVj
dCBhbWRncHVfYm8gKmJvLCBzdHJ1Y3Qgc2VxX2ZpbGUgKm0pCiAJdW5zaWduZWQgaW50IHBpbl9j
b3VudDsKIAl1NjQgc2l6ZTsKIAotCWRvbWFpbiA9IGFtZGdwdV9tZW1fdHlwZV90b19kb21haW4o
Ym8tPnRiby5tZW0ubWVtX3R5cGUpOworCWRvbWFpbiA9IGFtZGdwdV9tZW1fdHlwZV90b19kb21h
aW4oYm8tPnRiby5yZXNvdXJjZS0+bWVtX3R5cGUpOwogCXN3aXRjaCAoZG9tYWluKSB7CiAJY2Fz
ZSBBTURHUFVfR0VNX0RPTUFJTl9WUkFNOgogCQlwbGFjZW1lbnQgPSAiVlJBTSI7CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfb2JqZWN0LmggYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfb2JqZWN0LmgKaW5kZXggYWU0YTY4ZGI4N2MwLi42
YjMwYWI4MjI0ZjggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9vYmplY3QuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfb2JqZWN0
LmgKQEAgLTIwNSwxMyArMjA1LDEzIEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBhbWRncHVfYm9faW5f
Y3B1X3Zpc2libGVfdnJhbShzdHJ1Y3QgYW1kZ3B1X2JvICpibykKIHsKIAlzdHJ1Y3QgYW1kZ3B1
X2RldmljZSAqYWRldiA9IGFtZGdwdV90dG1fYWRldihiby0+dGJvLmJkZXYpOwogCXVuc2lnbmVk
IGZwZm4gPSBhZGV2LT5nbWMudmlzaWJsZV92cmFtX3NpemUgPj4gUEFHRV9TSElGVDsKLQlzdHJ1
Y3QgZHJtX21tX25vZGUgKm5vZGUgPSBiby0+dGJvLm1lbS5tbV9ub2RlOworCXN0cnVjdCBkcm1f
bW1fbm9kZSAqbm9kZSA9IGJvLT50Ym8ucmVzb3VyY2UtPm1tX25vZGU7CiAJdW5zaWduZWQgbG9u
ZyBwYWdlc19sZWZ0OwogCi0JaWYgKGJvLT50Ym8ubWVtLm1lbV90eXBlICE9IFRUTV9QTF9WUkFN
KQorCWlmIChiby0+dGJvLnJlc291cmNlLT5tZW1fdHlwZSAhPSBUVE1fUExfVlJBTSkKIAkJcmV0
dXJuIGZhbHNlOwogCi0JZm9yIChwYWdlc19sZWZ0ID0gYm8tPnRiby5tZW0ubnVtX3BhZ2VzOyBw
YWdlc19sZWZ0OworCWZvciAocGFnZXNfbGVmdCA9IGJvLT50Ym8ucmVzb3VyY2UtPm51bV9wYWdl
czsgcGFnZXNfbGVmdDsKIAkgICAgIHBhZ2VzX2xlZnQgLT0gbm9kZS0+c2l6ZSwgbm9kZSsrKQog
CQlpZiAobm9kZS0+c3RhcnQgPCBmcGZuKQogCQkJcmV0dXJuIHRydWU7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHJhY2UuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV90cmFjZS5oCmluZGV4IDc5MmQyMDI2MTg0Ni4uMDUyNzc3MmZl
MWI4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHJhY2Uu
aAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHJhY2UuaApAQCAtMTI3
LDggKzEyNyw4IEBAIFRSQUNFX0VWRU5UKGFtZGdwdV9ib19jcmVhdGUsCiAKIAkgICAgVFBfZmFz
dF9hc3NpZ24oCiAJCQkgICBfX2VudHJ5LT5ibyA9IGJvOwotCQkJICAgX19lbnRyeS0+cGFnZXMg
PSBiby0+dGJvLm1lbS5udW1fcGFnZXM7Ci0JCQkgICBfX2VudHJ5LT50eXBlID0gYm8tPnRiby5t
ZW0ubWVtX3R5cGU7CisJCQkgICBfX2VudHJ5LT5wYWdlcyA9IGJvLT50Ym8ucmVzb3VyY2UtPm51
bV9wYWdlczsKKwkJCSAgIF9fZW50cnktPnR5cGUgPSBiby0+dGJvLnJlc291cmNlLT5tZW1fdHlw
ZTsKIAkJCSAgIF9fZW50cnktPnByZWZlciA9IGJvLT5wcmVmZXJyZWRfZG9tYWluczsKIAkJCSAg
IF9fZW50cnktPmFsbG93ID0gYm8tPmFsbG93ZWRfZG9tYWluczsKIAkJCSAgIF9fZW50cnktPnZp
c2libGUgPSBiby0+ZmxhZ3M7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfdHRtLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmMK
aW5kZXggNzhhZTZjY2M4ODM2Li5jMzg1NjQ1ZGRhMmQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9hbWRncHVfdHRtLmMKQEAgLTExMiw3ICsxMTIsNyBAQCBzdGF0aWMgdm9pZCBhbWRncHVf
ZXZpY3RfZmxhZ3Moc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAl9CiAKIAlhYm8gPSB0
dG1fdG9fYW1kZ3B1X2JvKGJvKTsKLQlzd2l0Y2ggKGJvLT5tZW0ubWVtX3R5cGUpIHsKKwlzd2l0
Y2ggKGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUpIHsKIAljYXNlIEFNREdQVV9QTF9HRFM6CiAJY2Fz
ZSBBTURHUFVfUExfR1dTOgogCWNhc2UgQU1ER1BVX1BMX09BOgpAQCAtNTQ3LDcgKzU0Nyw3IEBA
IHN0YXRpYyBpbnQgYW1kZ3B1X2JvX21vdmUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywg
Ym9vbCBldmljdCwKIHsKIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldjsKIAlzdHJ1Y3QgYW1k
Z3B1X2JvICphYm87Ci0Jc3RydWN0IHR0bV9yZXNvdXJjZSAqb2xkX21lbSA9ICZiby0+bWVtOwor
CXN0cnVjdCB0dG1fcmVzb3VyY2UgKm9sZF9tZW0gPSBiby0+cmVzb3VyY2U7CiAJaW50IHI7CiAK
IAlpZiAobmV3X21lbS0+bWVtX3R5cGUgPT0gVFRNX1BMX1RUKSB7CkBAIC01NzksNyArNTc5LDcg
QEAgc3RhdGljIGludCBhbWRncHVfYm9fbW92ZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJv
LCBib29sIGV2aWN0LAogCQkJcmV0dXJuIHI7CiAKIAkJYW1kZ3B1X3R0bV9iYWNrZW5kX3VuYmlu
ZChiby0+YmRldiwgYm8tPnR0bSk7Ci0JCXR0bV9yZXNvdXJjZV9mcmVlKGJvLCAmYm8tPm1lbSk7
CisJCXR0bV9yZXNvdXJjZV9mcmVlKGJvLCBiby0+cmVzb3VyY2UpOwogCQl0dG1fYm9fYXNzaWdu
X21lbShibywgbmV3X21lbSk7CiAJCWdvdG8gb3V0OwogCX0KQEAgLTY4OSw3ICs2ODksNyBAQCBz
dGF0aWMgdW5zaWduZWQgbG9uZyBhbWRncHVfdHRtX2lvX21lbV9wZm4oc3RydWN0IHR0bV9idWZm
ZXJfb2JqZWN0ICpibywKIAl1aW50NjRfdCBvZmZzZXQgPSAocGFnZV9vZmZzZXQgPDwgUEFHRV9T
SElGVCk7CiAJc3RydWN0IGRybV9tbV9ub2RlICptbTsKIAotCW1tID0gYW1kZ3B1X2ZpbmRfbW1f
bm9kZSgmYm8tPm1lbSwgJm9mZnNldCk7CisJbW0gPSBhbWRncHVfZmluZF9tbV9ub2RlKGJvLT5y
ZXNvdXJjZSwgJm9mZnNldCk7CiAJb2Zmc2V0ICs9IGFkZXYtPmdtYy5hcGVyX2Jhc2U7CiAJcmV0
dXJuIG1tLT5zdGFydCArIChvZmZzZXQgPj4gUEFHRV9TSElGVCk7CiB9CkBAIC0xMDg2LDEyICsx
MDg2LDEyIEBAIGludCBhbWRncHVfdHRtX2FsbG9jX2dhcnQoc3RydWN0IHR0bV9idWZmZXJfb2Jq
ZWN0ICpibykKIAl1aW50NjRfdCBhZGRyLCBmbGFnczsKIAlpbnQgcjsKIAotCWlmIChiby0+bWVt
LnN0YXJ0ICE9IEFNREdQVV9CT19JTlZBTElEX09GRlNFVCkKKwlpZiAoYm8tPnJlc291cmNlLT5z
dGFydCAhPSBBTURHUFVfQk9fSU5WQUxJRF9PRkZTRVQpCiAJCXJldHVybiAwOwogCiAJYWRkciA9
IGFtZGdwdV9nbWNfYWdwX2FkZHIoYm8pOwogCWlmIChhZGRyICE9IEFNREdQVV9CT19JTlZBTElE
X09GRlNFVCkgewotCQliby0+bWVtLnN0YXJ0ID0gYWRkciA+PiBQQUdFX1NISUZUOworCQliby0+
cmVzb3VyY2UtPnN0YXJ0ID0gYWRkciA+PiBQQUdFX1NISUZUOwogCX0gZWxzZSB7CiAKIAkJLyog
YWxsb2NhdGUgR0FSVCBzcGFjZSAqLwpAQCAtMTEwMiw3ICsxMTAyLDcgQEAgaW50IGFtZGdwdV90
dG1fYWxsb2NfZ2FydChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvKQogCQlwbGFjZW1lbnRz
LmZwZm4gPSAwOwogCQlwbGFjZW1lbnRzLmxwZm4gPSBhZGV2LT5nbWMuZ2FydF9zaXplID4+IFBB
R0VfU0hJRlQ7CiAJCXBsYWNlbWVudHMubWVtX3R5cGUgPSBUVE1fUExfVFQ7Ci0JCXBsYWNlbWVu
dHMuZmxhZ3MgPSBiby0+bWVtLnBsYWNlbWVudDsKKwkJcGxhY2VtZW50cy5mbGFncyA9IGJvLT5y
ZXNvdXJjZS0+cGxhY2VtZW50OwogCiAJCXIgPSB0dG1fYm9fbWVtX3NwYWNlKGJvLCAmcGxhY2Vt
ZW50LCAmdG1wLCAmY3R4KTsKIAkJaWYgKHVubGlrZWx5KHIpKQpAQCAtMTExOSw4ICsxMTE5LDgg
QEAgaW50IGFtZGdwdV90dG1fYWxsb2NfZ2FydChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJv
KQogCQkJcmV0dXJuIHI7CiAJCX0KIAotCQl0dG1fcmVzb3VyY2VfZnJlZShibywgJmJvLT5tZW0p
OwotCQliby0+bWVtID0gdG1wOworCQl0dG1fcmVzb3VyY2VfZnJlZShibywgYm8tPnJlc291cmNl
KTsKKwkJdHRtX2JvX2Fzc2lnbl9tZW0oYm8sICZ0bXApOwogCX0KIAogCXJldHVybiAwOwpAQCAt
MTE0MSw3ICsxMTQxLDcgQEAgaW50IGFtZGdwdV90dG1fcmVjb3Zlcl9nYXJ0KHN0cnVjdCB0dG1f
YnVmZmVyX29iamVjdCAqdGJvKQogCWlmICghdGJvLT50dG0pCiAJCXJldHVybiAwOwogCi0JZmxh
Z3MgPSBhbWRncHVfdHRtX3R0X3B0ZV9mbGFncyhhZGV2LCB0Ym8tPnR0bSwgJnRiby0+bWVtKTsK
KwlmbGFncyA9IGFtZGdwdV90dG1fdHRfcHRlX2ZsYWdzKGFkZXYsIHRiby0+dHRtLCB0Ym8tPnJl
c291cmNlKTsKIAlyID0gYW1kZ3B1X3R0bV9nYXJ0X2JpbmQoYWRldiwgdGJvLCBmbGFncyk7CiAK
IAlyZXR1cm4gcjsKQEAgLTE0NjYsOCArMTQ2Niw4IEBAIHVpbnQ2NF90IGFtZGdwdV90dG1fdHRf
cHRlX2ZsYWdzKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBzdHJ1Y3QgdHRtX3R0ICp0dG0s
CiBzdGF0aWMgYm9vbCBhbWRncHVfdHRtX2JvX2V2aWN0aW9uX3ZhbHVhYmxlKHN0cnVjdCB0dG1f
YnVmZmVyX29iamVjdCAqYm8sCiAJCQkJCSAgICBjb25zdCBzdHJ1Y3QgdHRtX3BsYWNlICpwbGFj
ZSkKIHsKLQl1bnNpZ25lZCBsb25nIG51bV9wYWdlcyA9IGJvLT5tZW0ubnVtX3BhZ2VzOwotCXN0
cnVjdCBkcm1fbW1fbm9kZSAqbm9kZSA9IGJvLT5tZW0ubW1fbm9kZTsKKwl1bnNpZ25lZCBsb25n
IG51bV9wYWdlcyA9IGJvLT5yZXNvdXJjZS0+bnVtX3BhZ2VzOworCXN0cnVjdCBkcm1fbW1fbm9k
ZSAqbm9kZSA9IGJvLT5yZXNvdXJjZS0+bW1fbm9kZTsKIAlzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCAq
Zmxpc3Q7CiAJc3RydWN0IGRtYV9mZW5jZSAqZjsKIAlpbnQgaTsKQEAgLTE0OTAsNyArMTQ5MCw3
IEBAIHN0YXRpYyBib29sIGFtZGdwdV90dG1fYm9fZXZpY3Rpb25fdmFsdWFibGUoc3RydWN0IHR0
bV9idWZmZXJfb2JqZWN0ICpibywKIAkJfQogCX0KIAotCXN3aXRjaCAoYm8tPm1lbS5tZW1fdHlw
ZSkgeworCXN3aXRjaCAoYm8tPnJlc291cmNlLT5tZW1fdHlwZSkgewogCWNhc2UgVFRNX1BMX1RU
OgogCQlpZiAoYW1kZ3B1X2JvX2lzX2FtZGdwdV9ibyhibykgJiYKIAkJICAgIGFtZGdwdV9ib19l
bmNyeXB0ZWQodHRtX3RvX2FtZGdwdV9ibyhibykpKQpAQCAtMTU0MCwxMSArMTU0MCwxMSBAQCBz
dGF0aWMgaW50IGFtZGdwdV90dG1fYWNjZXNzX21lbW9yeShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmpl
Y3QgKmJvLAogCXVpbnQ2NF90IHBvczsKIAl1bnNpZ25lZCBsb25nIGZsYWdzOwogCi0JaWYgKGJv
LT5tZW0ubWVtX3R5cGUgIT0gVFRNX1BMX1ZSQU0pCisJaWYgKGJvLT5yZXNvdXJjZS0+bWVtX3R5
cGUgIT0gVFRNX1BMX1ZSQU0pCiAJCXJldHVybiAtRUlPOwogCiAJcG9zID0gb2Zmc2V0OwotCW5v
ZGVzID0gYW1kZ3B1X2ZpbmRfbW1fbm9kZSgmYWJvLT50Ym8ubWVtLCAmcG9zKTsKKwlub2RlcyA9
IGFtZGdwdV9maW5kX21tX25vZGUoYWJvLT50Ym8ucmVzb3VyY2UsICZwb3MpOwogCXBvcyArPSAo
bm9kZXMtPnN0YXJ0IDw8IFBBR0VfU0hJRlQpOwogCiAJd2hpbGUgKGxlbiAmJiBwb3MgPCBhZGV2
LT5nbWMubWNfdnJhbV9zaXplKSB7CkBAIC0yMTE0LDE0ICsyMTE0LDE0IEBAIGludCBhbWRncHVf
ZmlsbF9idWZmZXIoc3RydWN0IGFtZGdwdV9ibyAqYm8sCiAJCXJldHVybiAtRUlOVkFMOwogCX0K
IAotCWlmIChiby0+dGJvLm1lbS5tZW1fdHlwZSA9PSBUVE1fUExfVFQpIHsKKwlpZiAoYm8tPnRi
by5yZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1RUKSB7CiAJCXIgPSBhbWRncHVfdHRtX2Fs
bG9jX2dhcnQoJmJvLT50Ym8pOwogCQlpZiAocikKIAkJCXJldHVybiByOwogCX0KIAotCW51bV9w
YWdlcyA9IGJvLT50Ym8ubWVtLm51bV9wYWdlczsKLQltbV9ub2RlID0gYm8tPnRiby5tZW0ubW1f
bm9kZTsKKwludW1fcGFnZXMgPSBiby0+dGJvLnJlc291cmNlLT5udW1fcGFnZXM7CisJbW1fbm9k
ZSA9IGJvLT50Ym8ucmVzb3VyY2UtPm1tX25vZGU7CiAJbnVtX2xvb3BzID0gMDsKIAl3aGlsZSAo
bnVtX3BhZ2VzKSB7CiAJCXVpbnQ2NF90IGJ5dGVfY291bnQgPSBtbV9ub2RlLT5zaXplIDw8IFBB
R0VfU0hJRlQ7CkBAIC0yMTUwLDE0ICsyMTUwLDE0IEBAIGludCBhbWRncHVfZmlsbF9idWZmZXIo
c3RydWN0IGFtZGdwdV9ibyAqYm8sCiAJCX0KIAl9CiAKLQludW1fcGFnZXMgPSBiby0+dGJvLm1l
bS5udW1fcGFnZXM7Ci0JbW1fbm9kZSA9IGJvLT50Ym8ubWVtLm1tX25vZGU7CisJbnVtX3BhZ2Vz
ID0gYm8tPnRiby5yZXNvdXJjZS0+bnVtX3BhZ2VzOworCW1tX25vZGUgPSBiby0+dGJvLnJlc291
cmNlLT5tbV9ub2RlOwogCiAJd2hpbGUgKG51bV9wYWdlcykgewogCQl1aW50NjRfdCBieXRlX2Nv
dW50ID0gbW1fbm9kZS0+c2l6ZSA8PCBQQUdFX1NISUZUOwogCQl1aW50NjRfdCBkc3RfYWRkcjsK
IAotCQlkc3RfYWRkciA9IGFtZGdwdV9tbV9ub2RlX2FkZHIoJmJvLT50Ym8sIG1tX25vZGUsICZi
by0+dGJvLm1lbSk7CisJCWRzdF9hZGRyID0gYW1kZ3B1X21tX25vZGVfYWRkcigmYm8tPnRibywg
bW1fbm9kZSwgYm8tPnRiby5yZXNvdXJjZSk7CiAJCXdoaWxlIChieXRlX2NvdW50KSB7CiAJCQl1
aW50MzJfdCBjdXJfc2l6ZV9pbl9ieXRlcyA9IG1pbl90KHVpbnQ2NF90LCBieXRlX2NvdW50LAog
CQkJCQkJCSAgIG1heF9ieXRlcyk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9hbWRncHVfdm0uYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92bS5j
CmluZGV4IGFlMThjMGUzMjM0Ny4uM2Q3ZGUyOGNkOTViIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9hbWRncHVfdm0uYwpAQCAtMzM4LDcgKzMzOCw3IEBAIHN0YXRpYyB2b2lkIGFtZGdwdV92
bV9ib19iYXNlX2luaXQoc3RydWN0IGFtZGdwdV92bV9ib19iYXNlICpiYXNlLAogCQlhbWRncHVf
dm1fYm9faWRsZShiYXNlKTsKIAogCWlmIChiby0+cHJlZmVycmVkX2RvbWFpbnMgJgotCSAgICBh
bWRncHVfbWVtX3R5cGVfdG9fZG9tYWluKGJvLT50Ym8ubWVtLm1lbV90eXBlKSkKKwkgICAgYW1k
Z3B1X21lbV90eXBlX3RvX2RvbWFpbihiby0+dGJvLnJlc291cmNlLT5tZW1fdHlwZSkpCiAJCXJl
dHVybjsKIAogCS8qCkBAIC02NTMsMTEgKzY1MywxMSBAQCB2b2lkIGFtZGdwdV92bV9tb3ZlX3Rv
X2xydV90YWlsKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAogCQlpZiAoIWJvLT5wYXJlbnQp
CiAJCQljb250aW51ZTsKIAotCQl0dG1fYm9fbW92ZV90b19scnVfdGFpbCgmYm8tPnRibywgJmJv
LT50Ym8ubWVtLAorCQl0dG1fYm9fbW92ZV90b19scnVfdGFpbCgmYm8tPnRibywgYm8tPnRiby5y
ZXNvdXJjZSwKIAkJCQkJJnZtLT5scnVfYnVsa19tb3ZlKTsKIAkJaWYgKGJvLT5zaGFkb3cpCiAJ
CQl0dG1fYm9fbW92ZV90b19scnVfdGFpbCgmYm8tPnNoYWRvdy0+dGJvLAotCQkJCQkJJmJvLT5z
aGFkb3ctPnRiby5tZW0sCisJCQkJCQliby0+c2hhZG93LT50Ym8ucmVzb3VyY2UsCiAJCQkJCQkm
dm0tPmxydV9idWxrX21vdmUpOwogCX0KIAlzcGluX3VubG9jaygmYWRldi0+bW1hbi5iZGV2Lmxy
dV9sb2NrKTsKQEAgLTE3NTYsMTAgKzE3NTYsMTAgQEAgaW50IGFtZGdwdV92bV9ib191cGRhdGUo
c3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIHN0cnVjdCBhbWRncHVfYm9fdmEgKmJvX3ZhLAog
CQkJc3RydWN0IGRybV9nZW1fb2JqZWN0ICpnb2JqID0gZG1hX2J1Zi0+cHJpdjsKIAkJCXN0cnVj
dCBhbWRncHVfYm8gKmFibyA9IGdlbV90b19hbWRncHVfYm8oZ29iaik7CiAKLQkJCWlmIChhYm8t
PnRiby5tZW0ubWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0pCisJCQlpZiAoYWJvLT50Ym8ucmVzb3Vy
Y2UtPm1lbV90eXBlID09IFRUTV9QTF9WUkFNKQogCQkJCWJvID0gZ2VtX3RvX2FtZGdwdV9ibyhn
b2JqKTsKIAkJfQotCQltZW0gPSAmYm8tPnRiby5tZW07CisJCW1lbSA9IGJvLT50Ym8ucmVzb3Vy
Y2U7CiAJCW5vZGVzID0gbWVtLT5tbV9ub2RlOwogCQlpZiAobWVtLT5tZW1fdHlwZSA9PSBUVE1f
UExfVFQpCiAJCQlwYWdlc19hZGRyID0gYm8tPnRiby50dG0tPmRtYV9hZGRyZXNzOwpAQCAtMTgy
MCw3ICsxODIwLDcgQEAgaW50IGFtZGdwdV92bV9ib191cGRhdGUoc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYsIHN0cnVjdCBhbWRncHVfYm9fdmEgKmJvX3ZhLAogCSAqIG5leHQgY29tbWFuZCBz
dWJtaXNzaW9uLgogCSAqLwogCWlmIChibyAmJiBiby0+dGJvLmJhc2UucmVzdiA9PSB2bS0+cm9v
dC5iYXNlLmJvLT50Ym8uYmFzZS5yZXN2KSB7Ci0JCXVpbnQzMl90IG1lbV90eXBlID0gYm8tPnRi
by5tZW0ubWVtX3R5cGU7CisJCXVpbnQzMl90IG1lbV90eXBlID0gYm8tPnRiby5yZXNvdXJjZS0+
bWVtX3R5cGU7CiAKIAkJaWYgKCEoYm8tPnByZWZlcnJlZF9kb21haW5zICYKIAkJICAgICAgYW1k
Z3B1X21lbV90eXBlX3RvX2RvbWFpbihtZW1fdHlwZSkpKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZyYW1fbWdyLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfdnJhbV9tZ3IuYwppbmRleCAzOGIxOTk1ZDBkNmMuLmRiM2FlZTBlZDhm
ZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZyYW1fbWdy
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZyYW1fbWdyLmMKQEAg
LTIwNyw3ICsyMDcsNyBAQCBzdGF0aWMgdTY0IGFtZGdwdV92cmFtX21ncl92aXNfc2l6ZShzdHJ1
Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIHU2NCBhbWRncHVfdnJhbV9tZ3JfYm9fdmlzaWJsZV9z
aXplKHN0cnVjdCBhbWRncHVfYm8gKmJvKQogewogCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2
ID0gYW1kZ3B1X3R0bV9hZGV2KGJvLT50Ym8uYmRldik7Ci0Jc3RydWN0IHR0bV9yZXNvdXJjZSAq
bWVtID0gJmJvLT50Ym8ubWVtOworCXN0cnVjdCB0dG1fcmVzb3VyY2UgKm1lbSA9IGJvLT50Ym8u
cmVzb3VyY2U7CiAJc3RydWN0IGRybV9tbV9ub2RlICpub2RlcyA9IG1lbS0+bW1fbm9kZTsKIAl1
bnNpZ25lZCBwYWdlcyA9IG1lbS0+bnVtX3BhZ2VzOwogCXU2NCB1c2FnZTsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX3R0bV9oZWxwZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9k
cm1fZ2VtX3R0bV9oZWxwZXIuYwppbmRleCBiMTRiZWQ4YmU3NzEuLmVjZjNkMmE1NGE5OCAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2RybV9nZW1fdHRtX2hlbHBlci5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9kcm1fZ2VtX3R0bV9oZWxwZXIuYwpAQCAtNDAsMTIgKzQwLDEyIEBAIHZvaWQg
ZHJtX2dlbV90dG1fcHJpbnRfaW5mbyhzdHJ1Y3QgZHJtX3ByaW50ZXIgKnAsIHVuc2lnbmVkIGlu
dCBpbmRlbnQsCiAJY29uc3Qgc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibyA9IGRybV9nZW1f
dHRtX29mX2dlbShnZW0pOwogCiAJZHJtX3ByaW50Zl9pbmRlbnQocCwgaW5kZW50LCAicGxhY2Vt
ZW50PSIpOwotCWRybV9wcmludF9iaXRzKHAsIGJvLT5tZW0ucGxhY2VtZW50LCBwbG5hbWUsIEFS
UkFZX1NJWkUocGxuYW1lKSk7CisJZHJtX3ByaW50X2JpdHMocCwgYm8tPnJlc291cmNlLT5wbGFj
ZW1lbnQsIHBsbmFtZSwgQVJSQVlfU0laRShwbG5hbWUpKTsKIAlkcm1fcHJpbnRmKHAsICJcbiIp
OwogCi0JaWYgKGJvLT5tZW0uYnVzLmlzX2lvbWVtKQorCWlmIChiby0+cmVzb3VyY2UtPmJ1cy5p
c19pb21lbSkKIAkJZHJtX3ByaW50Zl9pbmRlbnQocCwgaW5kZW50LCAiYnVzLm9mZnNldD0lbHhc
biIsCi0JCQkJICAodW5zaWduZWQgbG9uZyliby0+bWVtLmJ1cy5vZmZzZXQpOworCQkJCSAgKHVu
c2lnbmVkIGxvbmcpYm8tPnJlc291cmNlLT5idXMub2Zmc2V0KTsKIH0KIEVYUE9SVF9TWU1CT0wo
ZHJtX2dlbV90dG1fcHJpbnRfaW5mbyk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9k
cm1fZ2VtX3ZyYW1faGVscGVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX2dlbV92cmFtX2hlbHBl
ci5jCmluZGV4IDc5NzIwMDMxNTg1NC4uODNlNzI1OGM3ZjkwIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vZHJtX2dlbV92cmFtX2hlbHBlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1f
Z2VtX3ZyYW1faGVscGVyLmMKQEAgLTI0OCwxMCArMjQ4LDEwIEBAIEVYUE9SVF9TWU1CT0woZHJt
X2dlbV92cmFtX3B1dCk7CiBzdGF0aWMgdTY0IGRybV9nZW1fdnJhbV9wZ19vZmZzZXQoc3RydWN0
IGRybV9nZW1fdnJhbV9vYmplY3QgKmdibykKIHsKIAkvKiBLZWVwIFRUTSBiZWhhdmlvciBmb3Ig
bm93LCByZW1vdmUgd2hlbiBkcml2ZXJzIGFyZSBhdWRpdGVkICovCi0JaWYgKFdBUk5fT05fT05D
RSghZ2JvLT5iby5tZW0ubW1fbm9kZSkpCisJaWYgKFdBUk5fT05fT05DRSghZ2JvLT5iby5yZXNv
dXJjZS0+bW1fbm9kZSkpCiAJCXJldHVybiAwOwogCi0JcmV0dXJuIGdiby0+Ym8ubWVtLnN0YXJ0
OworCXJldHVybiBnYm8tPmJvLnJlc291cmNlLT5zdGFydDsKIH0KIAogLyoqCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2FiaTE2LmMgYi9kcml2ZXJzL2dwdS9k
cm0vbm91dmVhdS9ub3V2ZWF1X2FiaTE2LmMKaW5kZXggMGE5MzM0ZGVmZmUyLi5iNDVlYzMwODYy
ODUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfYWJpMTYuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2FiaTE2LmMKQEAgLTMxMiw3ICsz
MTIsNyBAQCBub3V2ZWF1X2FiaTE2X2lvY3RsX2NoYW5uZWxfYWxsb2MoQUJJMTZfSU9DVExfQVJH
UykKIAkJaW5pdC0+cHVzaGJ1Zl9kb21haW5zID0gTk9VVkVBVV9HRU1fRE9NQUlOX1ZSQU0gfAog
CQkJCQlOT1VWRUFVX0dFTV9ET01BSU5fR0FSVDsKIAllbHNlCi0JaWYgKGNoYW4tPmNoYW4tPnB1
c2guYnVmZmVyLT5iby5tZW0ubWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0pCisJaWYgKGNoYW4tPmNo
YW4tPnB1c2guYnVmZmVyLT5iby5yZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0pCiAJ
CWluaXQtPnB1c2hidWZfZG9tYWlucyA9IE5PVVZFQVVfR0VNX0RPTUFJTl9WUkFNOwogCWVsc2UK
IAkJaW5pdC0+cHVzaGJ1Zl9kb21haW5zID0gTk9VVkVBVV9HRU1fRE9NQUlOX0dBUlQ7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2JvLmMgYi9kcml2ZXJzL2dw
dS9kcm0vbm91dmVhdS9ub3V2ZWF1X2JvLmMKaW5kZXggNmRiY2JlMmZhNTVmLi5mOWZhOTY0YmVl
ZDIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfYm8uYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2JvLmMKQEAgLTQzMyw3ICs0MzMsNyBA
QCBub3V2ZWF1X2JvX3BpbihzdHJ1Y3Qgbm91dmVhdV9ibyAqbnZibywgdWludDMyX3QgZG9tYWlu
LCBib29sIGNvbnRpZykKIAlpZiAobnZiby0+Ym8ucGluX2NvdW50KSB7CiAJCWJvb2wgZXJyb3Ig
PSBldmljdDsKIAotCQlzd2l0Y2ggKGJvLT5tZW0ubWVtX3R5cGUpIHsKKwkJc3dpdGNoIChiby0+
cmVzb3VyY2UtPm1lbV90eXBlKSB7CiAJCWNhc2UgVFRNX1BMX1ZSQU06CiAJCQllcnJvciB8PSAh
KGRvbWFpbiAmIE5PVVZFQVVfR0VNX0RPTUFJTl9WUkFNKTsKIAkJCWJyZWFrOwpAQCAtNDQ2LDcg
KzQ0Niw3IEBAIG5vdXZlYXVfYm9fcGluKHN0cnVjdCBub3V2ZWF1X2JvICpudmJvLCB1aW50MzJf
dCBkb21haW4sIGJvb2wgY29udGlnKQogCQlpZiAoZXJyb3IpIHsKIAkJCU5WX0VSUk9SKGRybSwg
ImJvICVwIHBpbm5lZCBlbHNld2hlcmU6ICIKIAkJCQkgICAgICAiMHglMDh4IHZzIDB4JTA4eFxu
IiwgYm8sCi0JCQkJIGJvLT5tZW0ubWVtX3R5cGUsIGRvbWFpbik7CisJCQkJIGJvLT5yZXNvdXJj
ZS0+bWVtX3R5cGUsIGRvbWFpbik7CiAJCQlyZXQgPSAtRUJVU1k7CiAJCX0KIAkJdHRtX2JvX3Bp
bigmbnZiby0+Ym8pOwpAQCAtNDY3LDcgKzQ2Nyw3IEBAIG5vdXZlYXVfYm9fcGluKHN0cnVjdCBu
b3V2ZWF1X2JvICpudmJvLCB1aW50MzJfdCBkb21haW4sIGJvb2wgY29udGlnKQogCiAJdHRtX2Jv
X3BpbigmbnZiby0+Ym8pOwogCi0Jc3dpdGNoIChiby0+bWVtLm1lbV90eXBlKSB7CisJc3dpdGNo
IChiby0+cmVzb3VyY2UtPm1lbV90eXBlKSB7CiAJY2FzZSBUVE1fUExfVlJBTToKIAkJZHJtLT5n
ZW0udnJhbV9hdmFpbGFibGUgLT0gYm8tPmJhc2Uuc2l6ZTsKIAkJYnJlYWs7CkBAIC00OTgsNyAr
NDk4LDcgQEAgbm91dmVhdV9ib191bnBpbihzdHJ1Y3Qgbm91dmVhdV9ibyAqbnZibykKIAogCXR0
bV9ib191bnBpbigmbnZiby0+Ym8pOwogCWlmICghbnZiby0+Ym8ucGluX2NvdW50KSB7Ci0JCXN3
aXRjaCAoYm8tPm1lbS5tZW1fdHlwZSkgeworCQlzd2l0Y2ggKGJvLT5yZXNvdXJjZS0+bWVtX3R5
cGUpIHsKIAkJY2FzZSBUVE1fUExfVlJBTToKIAkJCWRybS0+Z2VtLnZyYW1fYXZhaWxhYmxlICs9
IGJvLT5iYXNlLnNpemU7CiAJCQlicmVhazsKQEAgLTUyMyw3ICs1MjMsNyBAQCBub3V2ZWF1X2Jv
X21hcChzdHJ1Y3Qgbm91dmVhdV9ibyAqbnZibykKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0Owog
Ci0JcmV0ID0gdHRtX2JvX2ttYXAoJm52Ym8tPmJvLCAwLCBudmJvLT5iby5tZW0ubnVtX3BhZ2Vz
LCAmbnZiby0+a21hcCk7CisJcmV0ID0gdHRtX2JvX2ttYXAoJm52Ym8tPmJvLCAwLCBudmJvLT5i
by5yZXNvdXJjZS0+bnVtX3BhZ2VzLCAmbnZiby0+a21hcCk7CiAKIAl0dG1fYm9fdW5yZXNlcnZl
KCZudmJvLT5ibyk7CiAJcmV0dXJuIHJldDsKQEAgLTcyOSw3ICs3MjksNyBAQCBub3V2ZWF1X2Jv
X2V2aWN0X2ZsYWdzKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sIHN0cnVjdCB0dG1fcGxh
Y2VtZW50ICpwbCkKIHsKIAlzdHJ1Y3Qgbm91dmVhdV9ibyAqbnZibyA9IG5vdXZlYXVfYm8oYm8p
OwogCi0Jc3dpdGNoIChiby0+bWVtLm1lbV90eXBlKSB7CisJc3dpdGNoIChiby0+cmVzb3VyY2Ut
Pm1lbV90eXBlKSB7CiAJY2FzZSBUVE1fUExfVlJBTToKIAkJbm91dmVhdV9ib19wbGFjZW1lbnRf
c2V0KG52Ym8sIE5PVVZFQVVfR0VNX0RPTUFJTl9HQVJULAogCQkJCQkgTk9VVkVBVV9HRU1fRE9N
QUlOX0NQVSk7CkBAIC03NDYsNyArNzQ2LDcgQEAgc3RhdGljIGludAogbm91dmVhdV9ib19tb3Zl
X3ByZXAoc3RydWN0IG5vdXZlYXVfZHJtICpkcm0sIHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAq
Ym8sCiAJCSAgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqcmVnKQogewotCXN0cnVjdCBub3V2ZWF1
X21lbSAqb2xkX21lbSA9IG5vdXZlYXVfbWVtKCZiby0+bWVtKTsKKwlzdHJ1Y3Qgbm91dmVhdV9t
ZW0gKm9sZF9tZW0gPSBub3V2ZWF1X21lbShiby0+cmVzb3VyY2UpOwogCXN0cnVjdCBub3V2ZWF1
X21lbSAqbmV3X21lbSA9IG5vdXZlYXVfbWVtKHJlZyk7CiAJc3RydWN0IG52aWZfdm1tICp2bW0g
PSAmZHJtLT5jbGllbnQudm1tLnZtbTsKIAlpbnQgcmV0OwpAQCAtODAxLDcgKzgwMSw3IEBAIG5v
dXZlYXVfYm9fbW92ZV9tMm1mKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sIGludCBldmlj
dCwKIAkJbXV0ZXhfbG9ja19uZXN0ZWQoJmNsaS0+bXV0ZXgsIFNJTkdMRV9ERVBUSF9ORVNUSU5H
KTsKIAlyZXQgPSBub3V2ZWF1X2ZlbmNlX3N5bmMobm91dmVhdV9ibyhibyksIGNoYW4sIHRydWUs
IGN0eC0+aW50ZXJydXB0aWJsZSk7CiAJaWYgKHJldCA9PSAwKSB7Ci0JCXJldCA9IGRybS0+dHRt
Lm1vdmUoY2hhbiwgYm8sICZiby0+bWVtLCBuZXdfcmVnKTsKKwkJcmV0ID0gZHJtLT50dG0ubW92
ZShjaGFuLCBibywgYm8tPnJlc291cmNlLCBuZXdfcmVnKTsKIAkJaWYgKHJldCA9PSAwKSB7CiAJ
CQlyZXQgPSBub3V2ZWF1X2ZlbmNlX25ldyhjaGFuLCBmYWxzZSwgJmZlbmNlKTsKIAkJCWlmIChy
ZXQgPT0gMCkgewpAQCAtOTYxLDcgKzk2MSw3IEBAIG5vdXZlYXVfYm9fbW92ZShzdHJ1Y3QgdHRt
X2J1ZmZlcl9vYmplY3QgKmJvLCBib29sIGV2aWN0LAogewogCXN0cnVjdCBub3V2ZWF1X2RybSAq
ZHJtID0gbm91dmVhdV9iZGV2KGJvLT5iZGV2KTsKIAlzdHJ1Y3Qgbm91dmVhdV9ibyAqbnZibyA9
IG5vdXZlYXVfYm8oYm8pOwotCXN0cnVjdCB0dG1fcmVzb3VyY2UgKm9sZF9yZWcgPSAmYm8tPm1l
bTsKKwlzdHJ1Y3QgdHRtX3Jlc291cmNlICpvbGRfcmVnID0gYm8tPnJlc291cmNlOwogCXN0cnVj
dCBub3V2ZWF1X2RybV90aWxlICpuZXdfdGlsZSA9IE5VTEw7CiAJaW50IHJldCA9IDA7CiAKQEAg
LTEwMDEsNyArMTAwMSw3IEBAIG5vdXZlYXVfYm9fbW92ZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmpl
Y3QgKmJvLCBib29sIGV2aWN0LAogCWlmIChvbGRfcmVnLT5tZW1fdHlwZSA9PSBUVE1fUExfVFQg
JiYKIAkgICAgbmV3X3JlZy0+bWVtX3R5cGUgPT0gVFRNX1BMX1NZU1RFTSkgewogCQlub3V2ZWF1
X3R0bV90dF91bmJpbmQoYm8tPmJkZXYsIGJvLT50dG0pOwotCQl0dG1fcmVzb3VyY2VfZnJlZShi
bywgJmJvLT5tZW0pOworCQl0dG1fcmVzb3VyY2VfZnJlZShibywgYm8tPnJlc291cmNlKTsKIAkJ
dHRtX2JvX2Fzc2lnbl9tZW0oYm8sIG5ld19yZWcpOwogCQlnb3RvIG91dDsKIAl9CkBAIC0xMDM3
LDcgKzEwMzcsNyBAQCBub3V2ZWF1X2JvX21vdmUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpi
bywgYm9vbCBldmljdCwKIAl9CiBvdXRfbnRmeToKIAlpZiAocmV0KSB7Ci0JCW5vdXZlYXVfYm9f
bW92ZV9udGZ5KGJvLCAmYm8tPm1lbSk7CisJCW5vdXZlYXVfYm9fbW92ZV9udGZ5KGJvLCBiby0+
cmVzb3VyY2UpOwogCX0KIAlyZXR1cm4gcmV0OwogfQpAQCAtMTE3MSw3ICsxMTcxLDcgQEAgbm91
dmVhdV90dG1faW9fbWVtX3Jlc2VydmUoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIHN0cnVjdCB0
dG1fcmVzb3VyY2UgKnJlZykKIAkJCWxpc3RfZGVsX2luaXQoJm52Ym8tPmlvX3Jlc2VydmVfbHJ1
KTsKIAkJCWRybV92bWFfbm9kZV91bm1hcCgmbnZiby0+Ym8uYmFzZS52bWFfbm9kZSwKIAkJCQkJ
ICAgYmRldi0+ZGV2X21hcHBpbmcpOwotCQkJbm91dmVhdV90dG1faW9fbWVtX2ZyZWVfbG9ja2Vk
KGRybSwgJm52Ym8tPmJvLm1lbSk7CisJCQlub3V2ZWF1X3R0bV9pb19tZW1fZnJlZV9sb2NrZWQo
ZHJtLCBudmJvLT5iby5yZXNvdXJjZSk7CiAJCQlnb3RvIHJldHJ5OwogCQl9CiAKQEAgLTEyMDEs
MTIgKzEyMDEsMTIgQEAgdm1fZmF1bHRfdCBub3V2ZWF1X3R0bV9mYXVsdF9yZXNlcnZlX25vdGlm
eShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvKQogCS8qIGFzIGxvbmcgYXMgdGhlIGJvIGlz
bid0IGluIHZyYW0sIGFuZCBpc24ndCB0aWxlZCwgd2UndmUgZ290CiAJICogbm90aGluZyB0byBk
byBoZXJlLgogCSAqLwotCWlmIChiby0+bWVtLm1lbV90eXBlICE9IFRUTV9QTF9WUkFNKSB7CisJ
aWYgKGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgIT0gVFRNX1BMX1ZSQU0pIHsKIAkJaWYgKGRybS0+
Y2xpZW50LmRldmljZS5pbmZvLmZhbWlseSA8IE5WX0RFVklDRV9JTkZPX1YwX1RFU0xBIHx8CiAJ
CSAgICAhbnZiby0+a2luZCkKIAkJCXJldHVybiAwOwogCi0JCWlmIChiby0+bWVtLm1lbV90eXBl
ICE9IFRUTV9QTF9TWVNURU0pCisJCWlmIChiby0+cmVzb3VyY2UtPm1lbV90eXBlICE9IFRUTV9Q
TF9TWVNURU0pCiAJCQlyZXR1cm4gMDsKIAogCQlub3V2ZWF1X2JvX3BsYWNlbWVudF9zZXQobnZi
bywgTk9VVkVBVV9HRU1fRE9NQUlOX0dBUlQsIDApOwpAQCAtMTIxNCw3ICsxMjE0LDcgQEAgdm1f
ZmF1bHRfdCBub3V2ZWF1X3R0bV9mYXVsdF9yZXNlcnZlX25vdGlmeShzdHJ1Y3QgdHRtX2J1ZmZl
cl9vYmplY3QgKmJvKQogCX0gZWxzZSB7CiAJCS8qIG1ha2Ugc3VyZSBibyBpcyBpbiBtYXBwYWJs
ZSB2cmFtICovCiAJCWlmIChkcm0tPmNsaWVudC5kZXZpY2UuaW5mby5mYW1pbHkgPj0gTlZfREVW
SUNFX0lORk9fVjBfVEVTTEEgfHwKLQkJICAgIGJvLT5tZW0uc3RhcnQgKyBiby0+bWVtLm51bV9w
YWdlcyA8IG1hcHBhYmxlKQorCQkgICAgYm8tPnJlc291cmNlLT5zdGFydCArIGJvLT5yZXNvdXJj
ZS0+bnVtX3BhZ2VzIDwgbWFwcGFibGUpCiAJCQlyZXR1cm4gMDsKIAogCQlmb3IgKGkgPSAwOyBp
IDwgbnZiby0+cGxhY2VtZW50Lm51bV9wbGFjZW1lbnQ7ICsraSkgewpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9jaGFuLmMgYi9kcml2ZXJzL2dwdS9kcm0vbm91
dmVhdS9ub3V2ZWF1X2NoYW4uYwppbmRleCA3Y2ZhYzI2NWZkNDUuLjQwMzYyNjAwZWVkMiAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9jaGFuLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9jaGFuLmMKQEAgLTIxMiw3ICsyMTIsNyBAQCBu
b3V2ZWF1X2NoYW5uZWxfcHJlcChzdHJ1Y3Qgbm91dmVhdV9kcm0gKmRybSwgc3RydWN0IG52aWZf
ZGV2aWNlICpkZXZpY2UsCiAJCWFyZ3Muc3RhcnQgPSAwOwogCQlhcmdzLmxpbWl0ID0gY2hhbi0+
dm1tLT52bW0ubGltaXQgLSAxOwogCX0gZWxzZQotCWlmIChjaGFuLT5wdXNoLmJ1ZmZlci0+Ym8u
bWVtLm1lbV90eXBlID09IFRUTV9QTF9WUkFNKSB7CisJaWYgKGNoYW4tPnB1c2guYnVmZmVyLT5i
by5yZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0pIHsKIAkJaWYgKGRldmljZS0+aW5m
by5mYW1pbHkgPT0gTlZfREVWSUNFX0lORk9fVjBfVE5UKSB7CiAJCQkvKiBudjA0IHZyYW0gcHVz
aGJ1ZiBoYWNrLCByZXRhcmdldCB0byBpdHMgbG9jYXRpb24gaW4KIAkJCSAqIHRoZSBmcmFtZWJ1
ZmZlciBiYXIgcmF0aGVyIHRoYW4gZGlyZWN0IHZyYW0gYWNjZXNzLi4KZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfZmJjb24uYyBiL2RyaXZlcnMvZ3B1L2RybS9u
b3V2ZWF1L25vdXZlYXVfZmJjb24uYwppbmRleCA5M2FjNzhiZGE3NTAuLjRmOWIzYWE1ZGVkYSAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9mYmNvbi5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfZmJjb24uYwpAQCAtMzc4LDcgKzM3OCw3
IEBAIG5vdXZlYXVfZmJjb25fY3JlYXRlKHN0cnVjdCBkcm1fZmJfaGVscGVyICpoZWxwZXIsCiAJ
CQkgICAgICBGQklORk9fSFdBQ0NFTF9GSUxMUkVDVCB8CiAJCQkgICAgICBGQklORk9fSFdBQ0NF
TF9JTUFHRUJMSVQ7CiAJaW5mby0+ZmJvcHMgPSAmbm91dmVhdV9mYmNvbl9zd19vcHM7Ci0JaW5m
by0+Zml4LnNtZW1fc3RhcnQgPSBudmJvLT5iby5tZW0uYnVzLm9mZnNldDsKKwlpbmZvLT5maXgu
c21lbV9zdGFydCA9IG52Ym8tPmJvLnJlc291cmNlLT5idXMub2Zmc2V0OwogCWluZm8tPmZpeC5z
bWVtX2xlbiA9IG52Ym8tPmJvLmJhc2Uuc2l6ZTsKIAogCWluZm8tPnNjcmVlbl9iYXNlID0gbnZi
b19rbWFwX29ial9pb3ZpcnR1YWwobnZibyk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
bm91dmVhdS9ub3V2ZWF1X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9n
ZW0uYwppbmRleCBhNzBlODI0MTNmYTcuLjcxYjI0MDFmOGM3MyAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9nZW0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbm91
dmVhdS9ub3V2ZWF1X2dlbS5jCkBAIC0yNDAsNyArMjQwLDcgQEAgbm91dmVhdV9nZW1faW5mbyhz
dHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdiwgc3RydWN0IGRybV9nZW1fb2JqZWN0ICpnZW0sCiAK
IAlpZiAoaXNfcG93ZXJfb2ZfMihudmJvLT52YWxpZF9kb21haW5zKSkKIAkJcmVwLT5kb21haW4g
PSBudmJvLT52YWxpZF9kb21haW5zOwotCWVsc2UgaWYgKG52Ym8tPmJvLm1lbS5tZW1fdHlwZSA9
PSBUVE1fUExfVFQpCisJZWxzZSBpZiAobnZiby0+Ym8ucmVzb3VyY2UtPm1lbV90eXBlID09IFRU
TV9QTF9UVCkKIAkJcmVwLT5kb21haW4gPSBOT1VWRUFVX0dFTV9ET01BSU5fR0FSVDsKIAllbHNl
CiAJCXJlcC0+ZG9tYWluID0gTk9VVkVBVV9HRU1fRE9NQUlOX1ZSQU07CkBAIC0zMTEsMTEgKzMx
MSwxMSBAQCBub3V2ZWF1X2dlbV9zZXRfZG9tYWluKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqZ2Vt
LCB1aW50MzJfdCByZWFkX2RvbWFpbnMsCiAJdmFsaWRfZG9tYWlucyAmPSB+KE5PVVZFQVVfR0VN
X0RPTUFJTl9WUkFNIHwgTk9VVkVBVV9HRU1fRE9NQUlOX0dBUlQpOwogCiAJaWYgKChkb21haW5z
ICYgTk9VVkVBVV9HRU1fRE9NQUlOX1ZSQU0pICYmCi0JICAgIGJvLT5tZW0ubWVtX3R5cGUgPT0g
VFRNX1BMX1ZSQU0pCisJICAgIGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0p
CiAJCXByZWZfZG9tYWlucyB8PSBOT1VWRUFVX0dFTV9ET01BSU5fVlJBTTsKIAogCWVsc2UgaWYg
KChkb21haW5zICYgTk9VVkVBVV9HRU1fRE9NQUlOX0dBUlQpICYmCi0JCSBiby0+bWVtLm1lbV90
eXBlID09IFRUTV9QTF9UVCkKKwkJIGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1RU
KQogCQlwcmVmX2RvbWFpbnMgfD0gTk9VVkVBVV9HRU1fRE9NQUlOX0dBUlQ7CiAKIAllbHNlIGlm
IChkb21haW5zICYgTk9VVkVBVV9HRU1fRE9NQUlOX1ZSQU0pCkBAIC01MjUsMTMgKzUyNSwxMyBA
QCB2YWxpZGF0ZV9saXN0KHN0cnVjdCBub3V2ZWF1X2NoYW5uZWwgKmNoYW4sIHN0cnVjdCBub3V2
ZWF1X2NsaSAqY2xpLAogCiAJCWlmIChkcm0tPmNsaWVudC5kZXZpY2UuaW5mby5mYW1pbHkgPCBO
Vl9ERVZJQ0VfSU5GT19WMF9URVNMQSkgewogCQkJaWYgKG52Ym8tPm9mZnNldCA9PSBiLT5wcmVz
dW1lZC5vZmZzZXQgJiYKLQkJCSAgICAoKG52Ym8tPmJvLm1lbS5tZW1fdHlwZSA9PSBUVE1fUExf
VlJBTSAmJgorCQkJICAgICgobnZiby0+Ym8ucmVzb3VyY2UtPm1lbV90eXBlID09IFRUTV9QTF9W
UkFNICYmCiAJCQkgICAgICBiLT5wcmVzdW1lZC5kb21haW4gJiBOT1VWRUFVX0dFTV9ET01BSU5f
VlJBTSkgfHwKLQkJCSAgICAgKG52Ym8tPmJvLm1lbS5tZW1fdHlwZSA9PSBUVE1fUExfVFQgJiYK
KwkJCSAgICAgKG52Ym8tPmJvLnJlc291cmNlLT5tZW1fdHlwZSA9PSBUVE1fUExfVFQgJiYKIAkJ
CSAgICAgIGItPnByZXN1bWVkLmRvbWFpbiAmIE5PVVZFQVVfR0VNX0RPTUFJTl9HQVJUKSkpCiAJ
CQkJY29udGludWU7CiAKLQkJCWlmIChudmJvLT5iby5tZW0ubWVtX3R5cGUgPT0gVFRNX1BMX1RU
KQorCQkJaWYgKG52Ym8tPmJvLnJlc291cmNlLT5tZW1fdHlwZSA9PSBUVE1fUExfVFQpCiAJCQkJ
Yi0+cHJlc3VtZWQuZG9tYWluID0gTk9VVkVBVV9HRU1fRE9NQUlOX0dBUlQ7CiAJCQllbHNlCiAJ
CQkJYi0+cHJlc3VtZWQuZG9tYWluID0gTk9VVkVBVV9HRU1fRE9NQUlOX1ZSQU07CkBAIC02NDUs
NyArNjQ1LDcgQEAgbm91dmVhdV9nZW1fcHVzaGJ1Zl9yZWxvY19hcHBseShzdHJ1Y3Qgbm91dmVh
dV9jbGkgKmNsaSwKIAkJfQogCiAJCWlmICghbnZiby0+a21hcC52aXJ0dWFsKSB7Ci0JCQlyZXQg
PSB0dG1fYm9fa21hcCgmbnZiby0+Ym8sIDAsIG52Ym8tPmJvLm1lbS5udW1fcGFnZXMsCisJCQly
ZXQgPSB0dG1fYm9fa21hcCgmbnZiby0+Ym8sIDAsIG52Ym8tPmJvLnJlc291cmNlLT5udW1fcGFn
ZXMsCiAJCQkJCSAgJm52Ym8tPmttYXApOwogCQkJaWYgKHJldCkgewogCQkJCU5WX1BSSU5USyhl
cnIsIGNsaSwgImZhaWxlZCBrbWFwIGZvciByZWxvY1xuIik7CkBAIC04MzQsNyArODM0LDcgQEAg
bm91dmVhdV9nZW1faW9jdGxfcHVzaGJ1ZihzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpk
YXRhLAogCQkJaWYgKHVubGlrZWx5KGNtZCAhPSByZXEtPnN1ZmZpeDApKSB7CiAJCQkJaWYgKCFu
dmJvLT5rbWFwLnZpcnR1YWwpIHsKIAkJCQkJcmV0ID0gdHRtX2JvX2ttYXAoJm52Ym8tPmJvLCAw
LAotCQkJCQkJCSAgbnZiby0+Ym8ubWVtLgorCQkJCQkJCSAgbnZiby0+Ym8ucmVzb3VyY2UtPgog
CQkJCQkJCSAgbnVtX3BhZ2VzLAogCQkJCQkJCSAgJm52Ym8tPmttYXApOwogCQkJCQlpZiAocmV0
KSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X3ZtbS5jIGIv
ZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV92bW0uYwppbmRleCBhNDllODgxMjljOTIu
LjY3ZDY2MTlmY2Q1ZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVh
dV92bW0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X3ZtbS5jCkBAIC03
Nyw3ICs3Nyw3IEBAIGludAogbm91dmVhdV92bWFfbmV3KHN0cnVjdCBub3V2ZWF1X2JvICpudmJv
LCBzdHJ1Y3Qgbm91dmVhdV92bW0gKnZtbSwKIAkJc3RydWN0IG5vdXZlYXVfdm1hICoqcHZtYSkK
IHsKLQlzdHJ1Y3Qgbm91dmVhdV9tZW0gKm1lbSA9IG5vdXZlYXVfbWVtKCZudmJvLT5iby5tZW0p
OworCXN0cnVjdCBub3V2ZWF1X21lbSAqbWVtID0gbm91dmVhdV9tZW0obnZiby0+Ym8ucmVzb3Vy
Y2UpOwogCXN0cnVjdCBub3V2ZWF1X3ZtYSAqdm1hOwogCXN0cnVjdCBudmlmX3ZtYSB0bXA7CiAJ
aW50IHJldDsKQEAgLTk2LDcgKzk2LDcgQEAgbm91dmVhdV92bWFfbmV3KHN0cnVjdCBub3V2ZWF1
X2JvICpudmJvLCBzdHJ1Y3Qgbm91dmVhdV92bW0gKnZtbSwKIAl2bWEtPmZlbmNlID0gTlVMTDsK
IAlsaXN0X2FkZF90YWlsKCZ2bWEtPmhlYWQsICZudmJvLT52bWFfbGlzdCk7CiAKLQlpZiAobnZi
by0+Ym8ubWVtLm1lbV90eXBlICE9IFRUTV9QTF9TWVNURU0gJiYKKwlpZiAobnZiby0+Ym8ucmVz
b3VyY2UtPm1lbV90eXBlICE9IFRUTV9QTF9TWVNURU0gJiYKIAkgICAgbWVtLT5tZW0ucGFnZSA9
PSBudmJvLT5wYWdlKSB7CiAJCXJldCA9IG52aWZfdm1tX2dldCgmdm1tLT52bW0sIExBWlksIGZh
bHNlLCBtZW0tPm1lbS5wYWdlLCAwLAogCQkJCSAgIG1lbS0+bWVtLnNpemUsICZ0bXApOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbnYxN19mZW5jZS5jIGIvZHJpdmVycy9n
cHUvZHJtL25vdXZlYXUvbnYxN19mZW5jZS5jCmluZGV4IGIxY2Q4ZDdkZDg3ZC4uMDdjMmUwODc4
YzI0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9udjE3X2ZlbmNlLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbnYxN19mZW5jZS5jCkBAIC03Nyw4ICs3Nyw4IEBA
IHN0YXRpYyBpbnQKIG52MTdfZmVuY2VfY29udGV4dF9uZXcoc3RydWN0IG5vdXZlYXVfY2hhbm5l
bCAqY2hhbikKIHsKIAlzdHJ1Y3QgbnYxMF9mZW5jZV9wcml2ICpwcml2ID0gY2hhbi0+ZHJtLT5m
ZW5jZTsKKwlzdHJ1Y3QgdHRtX3Jlc291cmNlICpyZWcgPSBwcml2LT5iby0+Ym8ucmVzb3VyY2U7
CiAJc3RydWN0IG52MTBfZmVuY2VfY2hhbiAqZmN0eDsKLQlzdHJ1Y3QgdHRtX3Jlc291cmNlICpy
ZWcgPSAmcHJpdi0+Ym8tPmJvLm1lbTsKIAl1MzIgc3RhcnQgPSByZWctPnN0YXJ0ICogUEFHRV9T
SVpFOwogCXUzMiBsaW1pdCA9IHN0YXJ0ICsgcHJpdi0+Ym8tPmJvLmJhc2Uuc2l6ZSAtIDE7CiAJ
aW50IHJldCA9IDA7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9udjUwX2Zl
bmNlLmMgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9udjUwX2ZlbmNlLmMKaW5kZXggMTYyNTgy
NjUwNWY2Li5lYTFlMWY0ODBiZmUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1
L252NTBfZmVuY2UuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9udjUwX2ZlbmNlLmMK
QEAgLTM3LDcgKzM3LDcgQEAgbnY1MF9mZW5jZV9jb250ZXh0X25ldyhzdHJ1Y3Qgbm91dmVhdV9j
aGFubmVsICpjaGFuKQogewogCXN0cnVjdCBudjEwX2ZlbmNlX3ByaXYgKnByaXYgPSBjaGFuLT5k
cm0tPmZlbmNlOwogCXN0cnVjdCBudjEwX2ZlbmNlX2NoYW4gKmZjdHg7Ci0Jc3RydWN0IHR0bV9y
ZXNvdXJjZSAqcmVnID0gJnByaXYtPmJvLT5iby5tZW07CisJc3RydWN0IHR0bV9yZXNvdXJjZSAq
cmVnID0gcHJpdi0+Ym8tPmJvLnJlc291cmNlOwogCXUzMiBzdGFydCA9IHJlZy0+c3RhcnQgKiBQ
QUdFX1NJWkU7CiAJdTMyIGxpbWl0ID0gc3RhcnQgKyBwcml2LT5iby0+Ym8uYmFzZS5zaXplIC0g
MTsKIAlpbnQgcmV0OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3F4bC9xeGxfZHJ2Lmgg
Yi9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF9kcnYuaAppbmRleCAyMGEwZjNhYjg0YWQuLmRkNmFi
ZWU1NWY1NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3F4bC9xeGxfZHJ2LmgKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL3F4bC9xeGxfZHJ2LmgKQEAgLTI5MiwxMiArMjkyLDEyIEBAIHF4bF9i
b19waHlzaWNhbF9hZGRyZXNzKHN0cnVjdCBxeGxfZGV2aWNlICpxZGV2LCBzdHJ1Y3QgcXhsX2Jv
ICpibywKIAkJCXVuc2lnbmVkIGxvbmcgb2Zmc2V0KQogewogCXN0cnVjdCBxeGxfbWVtc2xvdCAq
c2xvdCA9Ci0JCShiby0+dGJvLm1lbS5tZW1fdHlwZSA9PSBUVE1fUExfVlJBTSkKKwkJKGJvLT50
Ym8ucmVzb3VyY2UtPm1lbV90eXBlID09IFRUTV9QTF9WUkFNKQogCQk/ICZxZGV2LT5tYWluX3Ns
b3QgOiAmcWRldi0+c3VyZmFjZXNfc2xvdDsKIAotICAgICAgIC8qIFRPRE8gLSBuZWVkIHRvIGhv
bGQgb25lIG9mIHRoZSBsb2NrcyB0byByZWFkIGJvLT50Ym8ubWVtLnN0YXJ0ICovCisgICAgICAg
LyogVE9ETyAtIG5lZWQgdG8gaG9sZCBvbmUgb2YgdGhlIGxvY2tzIHRvIHJlYWQgYm8tPnRiby5y
ZXNvdXJjZS0+c3RhcnQgKi8KIAotCXJldHVybiBzbG90LT5oaWdoX2JpdHMgfCAoKGJvLT50Ym8u
bWVtLnN0YXJ0IDw8IFBBR0VfU0hJRlQpICsgb2Zmc2V0KTsKKwlyZXR1cm4gc2xvdC0+aGlnaF9i
aXRzIHwgKChiby0+dGJvLnJlc291cmNlLT5zdGFydCA8PCBQQUdFX1NISUZUKSArIG9mZnNldCk7
CiB9CiAKIC8qIHF4bF9kaXNwbGF5LmMgKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9x
eGwvcXhsX29iamVjdC5jIGIvZHJpdmVycy9ncHUvZHJtL3F4bC9xeGxfb2JqZWN0LmMKaW5kZXgg
NmUyNmQ3MGYyZjA3Li5mYmIzNmUzZTg1NjQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9x
eGwvcXhsX29iamVjdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9xeGwvcXhsX29iamVjdC5jCkBA
IC0yMTIsMTQgKzIxMiwxNCBAQCB2b2lkICpxeGxfYm9fa21hcF9hdG9taWNfcGFnZShzdHJ1Y3Qg
cXhsX2RldmljZSAqcWRldiwKIAlzdHJ1Y3QgaW9fbWFwcGluZyAqbWFwOwogCXN0cnVjdCBkbWFf
YnVmX21hcCBib19tYXA7CiAKLQlpZiAoYm8tPnRiby5tZW0ubWVtX3R5cGUgPT0gVFRNX1BMX1ZS
QU0pCisJaWYgKGJvLT50Ym8ucmVzb3VyY2UtPm1lbV90eXBlID09IFRUTV9QTF9WUkFNKQogCQlt
YXAgPSBxZGV2LT52cmFtX21hcHBpbmc7Ci0JZWxzZSBpZiAoYm8tPnRiby5tZW0ubWVtX3R5cGUg
PT0gVFRNX1BMX1BSSVYpCisJZWxzZSBpZiAoYm8tPnRiby5yZXNvdXJjZS0+bWVtX3R5cGUgPT0g
VFRNX1BMX1BSSVYpCiAJCW1hcCA9IHFkZXYtPnN1cmZhY2VfbWFwcGluZzsKIAllbHNlCiAJCWdv
dG8gZmFsbGJhY2s7CiAKLQlvZmZzZXQgPSBiby0+dGJvLm1lbS5zdGFydCA8PCBQQUdFX1NISUZU
OworCW9mZnNldCA9IGJvLT50Ym8ucmVzb3VyY2UtPnN0YXJ0IDw8IFBBR0VfU0hJRlQ7CiAJcmV0
dXJuIGlvX21hcHBpbmdfbWFwX2F0b21pY193YyhtYXAsIG9mZnNldCArIHBhZ2Vfb2Zmc2V0KTsK
IGZhbGxiYWNrOgogCWlmIChiby0+a3B0cikgewpAQCAtMjY2LDggKzI2Niw4IEBAIGludCBxeGxf
Ym9fdnVubWFwKHN0cnVjdCBxeGxfYm8gKmJvKQogdm9pZCBxeGxfYm9fa3VubWFwX2F0b21pY19w
YWdlKHN0cnVjdCBxeGxfZGV2aWNlICpxZGV2LAogCQkJICAgICAgIHN0cnVjdCBxeGxfYm8gKmJv
LCB2b2lkICpwbWFwKQogewotCWlmICgoYm8tPnRiby5tZW0ubWVtX3R5cGUgIT0gVFRNX1BMX1ZS
QU0pICYmCi0JICAgIChiby0+dGJvLm1lbS5tZW1fdHlwZSAhPSBUVE1fUExfUFJJVikpCisJaWYg
KChiby0+dGJvLnJlc291cmNlLT5tZW1fdHlwZSAhPSBUVE1fUExfVlJBTSkgJiYKKwkgICAgKGJv
LT50Ym8ucmVzb3VyY2UtPm1lbV90eXBlICE9IFRUTV9QTF9QUklWKSkKIAkJZ290byBmYWxsYmFj
azsKIAogCWlvX21hcHBpbmdfdW5tYXBfYXRvbWljKHBtYXApOwpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL3F4bC9xeGxfdHRtLmMgYi9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF90dG0uYwpp
bmRleCA0N2FmZTk1ZDA0YTEuLjhhYTg3YjhlZGI5YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL3F4bC9xeGxfdHRtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3F4bC9xeGxfdHRtLmMKQEAg
LTEzMSw3ICsxMzEsNyBAQCBzdGF0aWMgdm9pZCBxeGxfYm9fbW92ZV9ub3RpZnkoc3RydWN0IHR0
bV9idWZmZXJfb2JqZWN0ICpibywKIAlxYm8gPSB0b19xeGxfYm8oYm8pOwogCXFkZXYgPSB0b19x
eGwocWJvLT50Ym8uYmFzZS5kZXYpOwogCi0JaWYgKGJvLT5tZW0ubWVtX3R5cGUgPT0gVFRNX1BM
X1BSSVYgJiYgcWJvLT5zdXJmYWNlX2lkKQorCWlmIChiby0+cmVzb3VyY2UtPm1lbV90eXBlID09
IFRUTV9QTF9QUklWICYmIHFiby0+c3VyZmFjZV9pZCkKIAkJcXhsX3N1cmZhY2VfZXZpY3QocWRl
diwgcWJvLCBuZXdfbWVtID8gdHJ1ZSA6IGZhbHNlKTsKIH0KIApAQCAtMTQwLDcgKzE0MCw3IEBA
IHN0YXRpYyBpbnQgcXhsX2JvX21vdmUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywgYm9v
bCBldmljdCwKIAkJICAgICAgIHN0cnVjdCB0dG1fcmVzb3VyY2UgKm5ld19tZW0sCiAJCSAgICAg
ICBzdHJ1Y3QgdHRtX3BsYWNlICpob3ApCiB7Ci0Jc3RydWN0IHR0bV9yZXNvdXJjZSAqb2xkX21l
bSA9ICZiby0+bWVtOworCXN0cnVjdCB0dG1fcmVzb3VyY2UgKm9sZF9tZW0gPSBiby0+cmVzb3Vy
Y2U7CiAJaW50IHJldDsKIAogCXF4bF9ib19tb3ZlX25vdGlmeShibywgbmV3X21lbSk7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9jcy5jIGIvZHJpdmVycy9ncHUv
ZHJtL3JhZGVvbi9yYWRlb25fY3MuYwppbmRleCAzNWU5MzdkMzliNTEuLjkwNDM5MTk0ZmYzOCAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fY3MuYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9jcy5jCkBAIC00MDAsOCArNDAwLDggQEAgc3RhdGlj
IGludCBjbXBfc2l6ZV9zbWFsbGVyX2ZpcnN0KHZvaWQgKnByaXYsIHN0cnVjdCBsaXN0X2hlYWQg
KmEsCiAJc3RydWN0IHJhZGVvbl9ib19saXN0ICpsYiA9IGxpc3RfZW50cnkoYiwgc3RydWN0IHJh
ZGVvbl9ib19saXN0LCB0di5oZWFkKTsKIAogCS8qIFNvcnQgQSBiZWZvcmUgQiBpZiBBIGlzIHNt
YWxsZXIuICovCi0JcmV0dXJuIChpbnQpbGEtPnJvYmotPnRiby5tZW0ubnVtX3BhZ2VzIC0KLQkJ
KGludClsYi0+cm9iai0+dGJvLm1lbS5udW1fcGFnZXM7CisJcmV0dXJuIChpbnQpbGEtPnJvYmot
PnRiby5yZXNvdXJjZS0+bnVtX3BhZ2VzIC0KKwkJKGludClsYi0+cm9iai0+dGJvLnJlc291cmNl
LT5udW1fcGFnZXM7CiB9CiAKIC8qKgpAQCAtNTE2LDcgKzUxNiw3IEBAIHN0YXRpYyBpbnQgcmFk
ZW9uX2JvX3ZtX3VwZGF0ZV9wdGUoc3RydWN0IHJhZGVvbl9jc19wYXJzZXIgKnAsCiAJfQogCiAJ
ciA9IHJhZGVvbl92bV9ib191cGRhdGUocmRldiwgdm0tPmliX2JvX3ZhLAotCQkJCSZyZGV2LT5y
aW5nX3RtcF9iby5iby0+dGJvLm1lbSk7CisJCQkJcmRldi0+cmluZ190bXBfYm8uYm8tPnRiby5y
ZXNvdXJjZSk7CiAJaWYgKHIpCiAJCXJldHVybiByOwogCkBAIC01MzAsNyArNTMwLDcgQEAgc3Rh
dGljIGludCByYWRlb25fYm9fdm1fdXBkYXRlX3B0ZShzdHJ1Y3QgcmFkZW9uX2NzX3BhcnNlciAq
cCwKIAkJCXJldHVybiAtRUlOVkFMOwogCQl9CiAKLQkJciA9IHJhZGVvbl92bV9ib191cGRhdGUo
cmRldiwgYm9fdmEsICZiby0+dGJvLm1lbSk7CisJCXIgPSByYWRlb25fdm1fYm9fdXBkYXRlKHJk
ZXYsIGJvX3ZhLCBiby0+dGJvLnJlc291cmNlKTsKIAkJaWYgKHIpCiAJCQlyZXR1cm4gcjsKIApk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fZ2VtLmMgYi9kcml2ZXJz
L2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9nZW0uYwppbmRleCBkYjE0YTgyYTJlNGIuLmViMWFjZmVk
NmRkNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fZ2VtLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fZ2VtLmMKQEAgLTQ4MSw3ICs0ODEsNyBA
QCBpbnQgcmFkZW9uX2dlbV9idXN5X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQg
KmRhdGEsCiAJZWxzZQogCQlyID0gMDsKIAotCWN1cl9wbGFjZW1lbnQgPSBSRUFEX09OQ0Uocm9i
ai0+dGJvLm1lbS5tZW1fdHlwZSk7CisJY3VyX3BsYWNlbWVudCA9IFJFQURfT05DRShyb2JqLT50
Ym8ucmVzb3VyY2UtPm1lbV90eXBlKTsKIAlhcmdzLT5kb21haW4gPSByYWRlb25fbWVtX3R5cGVf
dG9fZG9tYWluKGN1cl9wbGFjZW1lbnQpOwogCWRybV9nZW1fb2JqZWN0X3B1dChnb2JqKTsKIAly
ZXR1cm4gcjsKQEAgLTUxMSw3ICs1MTEsNyBAQCBpbnQgcmFkZW9uX2dlbV93YWl0X2lkbGVfaW9j
dGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIAkJciA9IHJldDsKIAogCS8q
IEZsdXNoIEhEUCBjYWNoZSB2aWEgTU1JTyBpZiBuZWNlc3NhcnkgKi8KLQljdXJfcGxhY2VtZW50
ID0gUkVBRF9PTkNFKHJvYmotPnRiby5tZW0ubWVtX3R5cGUpOworCWN1cl9wbGFjZW1lbnQgPSBS
RUFEX09OQ0Uocm9iai0+dGJvLnJlc291cmNlLT5tZW1fdHlwZSk7CiAJaWYgKHJkZXYtPmFzaWMt
Pm1taW9faGRwX2ZsdXNoICYmCiAJICAgIHJhZGVvbl9tZW1fdHlwZV90b19kb21haW4oY3VyX3Bs
YWNlbWVudCkgPT0gUkFERU9OX0dFTV9ET01BSU5fVlJBTSkKIAkJcm9iai0+cmRldi0+YXNpYy0+
bW1pb19oZHBfZmx1c2gocmRldik7CkBAIC01OTUsNyArNTk1LDcgQEAgc3RhdGljIHZvaWQgcmFk
ZW9uX2dlbV92YV91cGRhdGVfdm0oc3RydWN0IHJhZGVvbl9kZXZpY2UgKnJkZXYsCiAJCWdvdG8g
ZXJyb3JfZnJlZTsKIAogCWxpc3RfZm9yX2VhY2hfZW50cnkoZW50cnksICZsaXN0LCBoZWFkKSB7
Ci0JCWRvbWFpbiA9IHJhZGVvbl9tZW1fdHlwZV90b19kb21haW4oZW50cnktPmJvLT5tZW0ubWVt
X3R5cGUpOworCQlkb21haW4gPSByYWRlb25fbWVtX3R5cGVfdG9fZG9tYWluKGVudHJ5LT5iby0+
cmVzb3VyY2UtPm1lbV90eXBlKTsKIAkJLyogaWYgYW55dGhpbmcgaXMgc3dhcHBlZCBvdXQgZG9u
J3Qgc3dhcCBpdCBpbiBoZXJlLAogCQkgICBqdXN0IGFib3J0IGFuZCB3YWl0IGZvciB0aGUgbmV4
dCBDUyAqLwogCQlpZiAoZG9tYWluID09IFJBREVPTl9HRU1fRE9NQUlOX0NQVSkKQEAgLTYwOCw3
ICs2MDgsNyBAQCBzdGF0aWMgdm9pZCByYWRlb25fZ2VtX3ZhX3VwZGF0ZV92bShzdHJ1Y3QgcmFk
ZW9uX2RldmljZSAqcmRldiwKIAkJZ290byBlcnJvcl91bmxvY2s7CiAKIAlpZiAoYm9fdmEtPml0
LnN0YXJ0KQotCQlyID0gcmFkZW9uX3ZtX2JvX3VwZGF0ZShyZGV2LCBib192YSwgJmJvX3ZhLT5i
by0+dGJvLm1lbSk7CisJCXIgPSByYWRlb25fdm1fYm9fdXBkYXRlKHJkZXYsIGJvX3ZhLCBib192
YS0+Ym8tPnRiby5yZXNvdXJjZSk7CiAKIGVycm9yX3VubG9jazoKIAltdXRleF91bmxvY2soJmJv
X3ZhLT52bS0+bXV0ZXgpOwpAQCAtODE0LDcgKzgxNCw3IEBAIHN0YXRpYyBpbnQgcmFkZW9uX2Rl
YnVnZnNfZ2VtX2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQogCQl1bnNpZ25l
ZCBkb21haW47CiAJCWNvbnN0IGNoYXIgKnBsYWNlbWVudDsKIAotCQlkb21haW4gPSByYWRlb25f
bWVtX3R5cGVfdG9fZG9tYWluKHJiby0+dGJvLm1lbS5tZW1fdHlwZSk7CisJCWRvbWFpbiA9IHJh
ZGVvbl9tZW1fdHlwZV90b19kb21haW4ocmJvLT50Ym8ucmVzb3VyY2UtPm1lbV90eXBlKTsKIAkJ
c3dpdGNoIChkb21haW4pIHsKIAkJY2FzZSBSQURFT05fR0VNX0RPTUFJTl9WUkFNOgogCQkJcGxh
Y2VtZW50ID0gIlZSQU0iOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRl
b25fb2JqZWN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9vYmplY3QuYwppbmRl
eCA4MDRmN2E0MjdiZTcuLmMwMDU4MzIwZWJhOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L3JhZGVvbi9yYWRlb25fb2JqZWN0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRl
b25fb2JqZWN0LmMKQEAgLTc2LDcgKzc2LDcgQEAgc3RhdGljIHZvaWQgcmFkZW9uX3R0bV9ib19k
ZXN0cm95KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqdGJvKQogCiAJYm8gPSBjb250YWluZXJf
b2YodGJvLCBzdHJ1Y3QgcmFkZW9uX2JvLCB0Ym8pOwogCi0JcmFkZW9uX3VwZGF0ZV9tZW1vcnlf
dXNhZ2UoYm8sIGJvLT50Ym8ubWVtLm1lbV90eXBlLCAtMSk7CisJcmFkZW9uX3VwZGF0ZV9tZW1v
cnlfdXNhZ2UoYm8sIGJvLT50Ym8ucmVzb3VyY2UtPm1lbV90eXBlLCAtMSk7CiAKIAltdXRleF9s
b2NrKCZiby0+cmRldi0+Z2VtLm11dGV4KTsKIAlsaXN0X2RlbF9pbml0KCZiby0+bGlzdCk7CkBA
IC0yNTAsNyArMjUwLDcgQEAgaW50IHJhZGVvbl9ib19rbWFwKHN0cnVjdCByYWRlb25fYm8gKmJv
LCB2b2lkICoqcHRyKQogCQl9CiAJCXJldHVybiAwOwogCX0KLQlyID0gdHRtX2JvX2ttYXAoJmJv
LT50Ym8sIDAsIGJvLT50Ym8ubWVtLm51bV9wYWdlcywgJmJvLT5rbWFwKTsKKwlyID0gdHRtX2Jv
X2ttYXAoJmJvLT50Ym8sIDAsIGJvLT50Ym8ucmVzb3VyY2UtPm51bV9wYWdlcywgJmJvLT5rbWFw
KTsKIAlpZiAocikgewogCQlyZXR1cm4gcjsKIAl9CkBAIC0zNTksNyArMzU5LDcgQEAgdm9pZCBy
YWRlb25fYm9fdW5waW4oc3RydWN0IHJhZGVvbl9ibyAqYm8pCiB7CiAJdHRtX2JvX3VucGluKCZi
by0+dGJvKTsKIAlpZiAoIWJvLT50Ym8ucGluX2NvdW50KSB7Ci0JCWlmIChiby0+dGJvLm1lbS5t
ZW1fdHlwZSA9PSBUVE1fUExfVlJBTSkKKwkJaWYgKGJvLT50Ym8ucmVzb3VyY2UtPm1lbV90eXBl
ID09IFRUTV9QTF9WUkFNKQogCQkJYm8tPnJkZXYtPnZyYW1fcGluX3NpemUgLT0gcmFkZW9uX2Jv
X3NpemUoYm8pOwogCQllbHNlCiAJCQliby0+cmRldi0+Z2FydF9waW5fc2l6ZSAtPSByYWRlb25f
Ym9fc2l6ZShibyk7CkBAIC01MDQsNyArNTA0LDcgQEAgaW50IHJhZGVvbl9ib19saXN0X3ZhbGlk
YXRlKHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2LAogCQkJdTMyIGRvbWFpbiA9IGxvYmotPnBy
ZWZlcnJlZF9kb21haW5zOwogCQkJdTMyIGFsbG93ZWQgPSBsb2JqLT5hbGxvd2VkX2RvbWFpbnM7
CiAJCQl1MzIgY3VycmVudF9kb21haW4gPQotCQkJCXJhZGVvbl9tZW1fdHlwZV90b19kb21haW4o
Ym8tPnRiby5tZW0ubWVtX3R5cGUpOworCQkJCXJhZGVvbl9tZW1fdHlwZV90b19kb21haW4oYm8t
PnRiby5yZXNvdXJjZS0+bWVtX3R5cGUpOwogCiAJCQkvKiBDaGVjayBpZiB0aGlzIGJ1ZmZlciB3
aWxsIGJlIG1vdmVkIGFuZCBkb24ndCBtb3ZlIGl0CiAJCQkgKiBpZiB3ZSBoYXZlIG1vdmVkIHRv
byBtYW55IGJ1ZmZlcnMgZm9yIHRoaXMgSUIgYWxyZWFkeS4KQEAgLTYwMyw3ICs2MDMsNyBAQCBp
bnQgcmFkZW9uX2JvX2dldF9zdXJmYWNlX3JlZyhzdHJ1Y3QgcmFkZW9uX2JvICpibykKIAogb3V0
OgogCXJhZGVvbl9zZXRfc3VyZmFjZV9yZWcocmRldiwgaSwgYm8tPnRpbGluZ19mbGFncywgYm8t
PnBpdGNoLAotCQkJICAgICAgIGJvLT50Ym8ubWVtLnN0YXJ0IDw8IFBBR0VfU0hJRlQsCisJCQkg
ICAgICAgYm8tPnRiby5yZXNvdXJjZS0+c3RhcnQgPDwgUEFHRV9TSElGVCwKIAkJCSAgICAgICBi
by0+dGJvLmJhc2Uuc2l6ZSk7CiAJcmV0dXJuIDA7CiB9CkBAIC03MDksNyArNzA5LDcgQEAgaW50
IHJhZGVvbl9ib19jaGVja190aWxpbmcoc3RydWN0IHJhZGVvbl9ibyAqYm8sIGJvb2wgaGFzX21v
dmVkLAogCQlyZXR1cm4gMDsKIAl9CiAKLQlpZiAoYm8tPnRiby5tZW0ubWVtX3R5cGUgIT0gVFRN
X1BMX1ZSQU0pIHsKKwlpZiAoYm8tPnRiby5yZXNvdXJjZS0+bWVtX3R5cGUgIT0gVFRNX1BMX1ZS
QU0pIHsKIAkJaWYgKCFoYXNfbW92ZWQpCiAJCQlyZXR1cm4gMDsKIApAQCAtNzQxLDcgKzc0MSw3
IEBAIHZvaWQgcmFkZW9uX2JvX21vdmVfbm90aWZ5KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAq
Ym8sCiAJaWYgKCFuZXdfbWVtKQogCQlyZXR1cm47CiAKLQlyYWRlb25fdXBkYXRlX21lbW9yeV91
c2FnZShyYm8sIGJvLT5tZW0ubWVtX3R5cGUsIC0xKTsKKwlyYWRlb25fdXBkYXRlX21lbW9yeV91
c2FnZShyYm8sIGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUsIC0xKTsKIAlyYWRlb25fdXBkYXRlX21l
bW9yeV91c2FnZShyYm8sIG5ld19tZW0tPm1lbV90eXBlLCAxKTsKIH0KIApAQCAtNzU4LDExICs3
NTgsMTEgQEAgdm1fZmF1bHRfdCByYWRlb25fYm9fZmF1bHRfcmVzZXJ2ZV9ub3RpZnkoc3RydWN0
IHR0bV9idWZmZXJfb2JqZWN0ICpibykKIAlyYm8gPSBjb250YWluZXJfb2YoYm8sIHN0cnVjdCBy
YWRlb25fYm8sIHRibyk7CiAJcmFkZW9uX2JvX2NoZWNrX3RpbGluZyhyYm8sIDAsIDApOwogCXJk
ZXYgPSByYm8tPnJkZXY7Ci0JaWYgKGJvLT5tZW0ubWVtX3R5cGUgIT0gVFRNX1BMX1ZSQU0pCisJ
aWYgKGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgIT0gVFRNX1BMX1ZSQU0pCiAJCXJldHVybiAwOwog
Ci0Jc2l6ZSA9IGJvLT5tZW0ubnVtX3BhZ2VzIDw8IFBBR0VfU0hJRlQ7Ci0Jb2Zmc2V0ID0gYm8t
Pm1lbS5zdGFydCA8PCBQQUdFX1NISUZUOworCXNpemUgPSBiby0+cmVzb3VyY2UtPm51bV9wYWdl
cyA8PCBQQUdFX1NISUZUOworCW9mZnNldCA9IGJvLT5yZXNvdXJjZS0+c3RhcnQgPDwgUEFHRV9T
SElGVDsKIAlpZiAoKG9mZnNldCArIHNpemUpIDw9IHJkZXYtPm1jLnZpc2libGVfdnJhbV9zaXpl
KQogCQlyZXR1cm4gMDsKIApAQCAtNzg0LDcgKzc4NCw3IEBAIHZtX2ZhdWx0X3QgcmFkZW9uX2Jv
X2ZhdWx0X3Jlc2VydmVfbm90aWZ5KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8pCiAJCXJh
ZGVvbl90dG1fcGxhY2VtZW50X2Zyb21fZG9tYWluKHJibywgUkFERU9OX0dFTV9ET01BSU5fR1RU
KTsKIAkJciA9IHR0bV9ib192YWxpZGF0ZShibywgJnJiby0+cGxhY2VtZW50LCAmY3R4KTsKIAl9
IGVsc2UgaWYgKGxpa2VseSghcikpIHsKLQkJb2Zmc2V0ID0gYm8tPm1lbS5zdGFydCA8PCBQQUdF
X1NISUZUOworCQlvZmZzZXQgPSBiby0+cmVzb3VyY2UtPnN0YXJ0IDw8IFBBR0VfU0hJRlQ7CiAJ
CS8qIHRoaXMgc2hvdWxkIG5ldmVyIGhhcHBlbiAqLwogCQlpZiAoKG9mZnNldCArIHNpemUpID4g
cmRldi0+bWMudmlzaWJsZV92cmFtX3NpemUpCiAJCQlyZXR1cm4gVk1fRkFVTFRfU0lHQlVTOwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fb2JqZWN0LmggYi9kcml2
ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9vYmplY3QuaAppbmRleCBmZDQxMTZiZGRlMGYuLjE3
MzljNmExNDJjZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fb2Jq
ZWN0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fb2JqZWN0LmgKQEAgLTk1
LDcgKzk1LDcgQEAgc3RhdGljIGlubGluZSB1NjQgcmFkZW9uX2JvX2dwdV9vZmZzZXQoc3RydWN0
IHJhZGVvbl9ibyAqYm8pCiAKIAlyZGV2ID0gcmFkZW9uX2dldF9yZGV2KGJvLT50Ym8uYmRldik7
CiAKLQlzd2l0Y2ggKGJvLT50Ym8ubWVtLm1lbV90eXBlKSB7CisJc3dpdGNoIChiby0+dGJvLnJl
c291cmNlLT5tZW1fdHlwZSkgewogCWNhc2UgVFRNX1BMX1RUOgogCQlzdGFydCA9IHJkZXYtPm1j
Lmd0dF9zdGFydDsKIAkJYnJlYWs7CkBAIC0xMDQsNyArMTA0LDcgQEAgc3RhdGljIGlubGluZSB1
NjQgcmFkZW9uX2JvX2dwdV9vZmZzZXQoc3RydWN0IHJhZGVvbl9ibyAqYm8pCiAJCWJyZWFrOwog
CX0KIAotCXJldHVybiAoYm8tPnRiby5tZW0uc3RhcnQgPDwgUEFHRV9TSElGVCkgKyBzdGFydDsK
KwlyZXR1cm4gKGJvLT50Ym8ucmVzb3VyY2UtPnN0YXJ0IDw8IFBBR0VfU0hJRlQpICsgc3RhcnQ7
CiB9CiAKIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgbG9uZyByYWRlb25fYm9fc2l6ZShzdHJ1Y3Qg
cmFkZW9uX2JvICpibykKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9u
X3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9wbS5jCmluZGV4IDE5OTVkYWQ1
OWRkMC4uZmY5YWUwOWQxMzYyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3Jh
ZGVvbl9wbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX3BtLmMKQEAgLTE1
NSw3ICsxNTUsNyBAQCBzdGF0aWMgdm9pZCByYWRlb25fdW5tYXBfdnJhbV9ib3Moc3RydWN0IHJh
ZGVvbl9kZXZpY2UgKnJkZXYpCiAJCXJldHVybjsKIAogCWxpc3RfZm9yX2VhY2hfZW50cnlfc2Fm
ZShibywgbiwgJnJkZXYtPmdlbS5vYmplY3RzLCBsaXN0KSB7Ci0JCWlmIChiby0+dGJvLm1lbS5t
ZW1fdHlwZSA9PSBUVE1fUExfVlJBTSkKKwkJaWYgKGJvLT50Ym8ucmVzb3VyY2UtPm1lbV90eXBl
ID09IFRUTV9QTF9WUkFNKQogCQkJdHRtX2JvX3VubWFwX3ZpcnR1YWwoJmJvLT50Ym8pOwogCX0K
IH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX3RyYWNlLmggYi9k
cml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl90cmFjZS5oCmluZGV4IDE3MjljYjlhOTVjNS4u
YzlmZWQ1ZjJiODcwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl90
cmFjZS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX3RyYWNlLmgKQEAgLTIy
LDcgKzIyLDcgQEAgVFJBQ0VfRVZFTlQocmFkZW9uX2JvX2NyZWF0ZSwKIAogCSAgICBUUF9mYXN0
X2Fzc2lnbigKIAkJCSAgIF9fZW50cnktPmJvID0gYm87Ci0JCQkgICBfX2VudHJ5LT5wYWdlcyA9
IGJvLT50Ym8ubWVtLm51bV9wYWdlczsKKwkJCSAgIF9fZW50cnktPnBhZ2VzID0gYm8tPnRiby5y
ZXNvdXJjZS0+bnVtX3BhZ2VzOwogCQkJICAgKSwKIAkgICAgVFBfcHJpbnRrKCJibz0lcCwgcGFn
ZXM9JXUiLCBfX2VudHJ5LT5ibywgX19lbnRyeS0+cGFnZXMpCiApOwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fdHRtLmMgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9u
L3JhZGVvbl90dG0uYwppbmRleCA1ZmM4YmFlNDAxYWYuLjc5ZDgwOGExY2JiZCAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fdHRtLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL3JhZGVvbi9yYWRlb25fdHRtLmMKQEAgLTEwMSwxMiArMTAxLDEyIEBAIHN0YXRpYyB2b2lk
IHJhZGVvbl9ldmljdF9mbGFncyhzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQlyZXR1
cm47CiAJfQogCXJibyA9IGNvbnRhaW5lcl9vZihibywgc3RydWN0IHJhZGVvbl9ibywgdGJvKTsK
LQlzd2l0Y2ggKGJvLT5tZW0ubWVtX3R5cGUpIHsKKwlzd2l0Y2ggKGJvLT5yZXNvdXJjZS0+bWVt
X3R5cGUpIHsKIAljYXNlIFRUTV9QTF9WUkFNOgogCQlpZiAocmJvLT5yZGV2LT5yaW5nW3JhZGVv
bl9jb3B5X3JpbmdfaW5kZXgocmJvLT5yZGV2KV0ucmVhZHkgPT0gZmFsc2UpCiAJCQlyYWRlb25f
dHRtX3BsYWNlbWVudF9mcm9tX2RvbWFpbihyYm8sIFJBREVPTl9HRU1fRE9NQUlOX0NQVSk7CiAJ
CWVsc2UgaWYgKHJiby0+cmRldi0+bWMudmlzaWJsZV92cmFtX3NpemUgPCByYm8tPnJkZXYtPm1j
LnJlYWxfdnJhbV9zaXplICYmCi0JCQkgYm8tPm1lbS5zdGFydCA8IChyYm8tPnJkZXYtPm1jLnZp
c2libGVfdnJhbV9zaXplID4+IFBBR0VfU0hJRlQpKSB7CisJCQkgYm8tPnJlc291cmNlLT5zdGFy
dCA8IChyYm8tPnJkZXYtPm1jLnZpc2libGVfdnJhbV9zaXplID4+IFBBR0VfU0hJRlQpKSB7CiAJ
CQl1bnNpZ25lZCBmcGZuID0gcmJvLT5yZGV2LT5tYy52aXNpYmxlX3ZyYW1fc2l6ZSA+PiBQQUdF
X1NISUZUOwogCQkJaW50IGk7CiAKQEAgLTIwOSw5ICsyMDksOSBAQCBzdGF0aWMgaW50IHJhZGVv
bl9ib19tb3ZlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sIGJvb2wgZXZpY3QsCiAJCQkg
IHN0cnVjdCB0dG1fcmVzb3VyY2UgKm5ld19tZW0sCiAJCQkgIHN0cnVjdCB0dG1fcGxhY2UgKmhv
cCkKIHsKKwlzdHJ1Y3QgdHRtX3Jlc291cmNlICpvbGRfbWVtID0gYm8tPnJlc291cmNlOwogCXN0
cnVjdCByYWRlb25fZGV2aWNlICpyZGV2OwogCXN0cnVjdCByYWRlb25fYm8gKnJibzsKLQlzdHJ1
Y3QgdHRtX3Jlc291cmNlICpvbGRfbWVtID0gJmJvLT5tZW07CiAJaW50IHI7CiAKIAlpZiAobmV3
X21lbS0+bWVtX3R5cGUgPT0gVFRNX1BMX1RUKSB7CkBAIC0yNDMsNyArMjQzLDcgQEAgc3RhdGlj
IGludCByYWRlb25fYm9fbW92ZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLCBib29sIGV2
aWN0LAogCWlmIChvbGRfbWVtLT5tZW1fdHlwZSA9PSBUVE1fUExfVFQgJiYKIAkgICAgbmV3X21l
bS0+bWVtX3R5cGUgPT0gVFRNX1BMX1NZU1RFTSkgewogCQlyYWRlb25fdHRtX3R0X3VuYmluZChi
by0+YmRldiwgYm8tPnR0bSk7Ci0JCXR0bV9yZXNvdXJjZV9mcmVlKGJvLCAmYm8tPm1lbSk7CisJ
CXR0bV9yZXNvdXJjZV9mcmVlKGJvLCBiby0+cmVzb3VyY2UpOwogCQl0dG1fYm9fYXNzaWduX21l
bShibywgbmV3X21lbSk7CiAJCWdvdG8gb3V0OwogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS90dG0vdHRtX2JvLmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5jCmluZGV4IGQz
NTgwZGZhMmJjNi4uZGMwNjcyMGE0NDI2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRt
L3R0bV9iby5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvLmMKQEAgLTU4LDcgKzU4
LDcgQEAgc3RhdGljIHZvaWQgdHRtX2JvX21lbV9zcGFjZV9kZWJ1ZyhzdHJ1Y3QgdHRtX2J1ZmZl
cl9vYmplY3QgKmJvLAogCWludCBpLCBtZW1fdHlwZTsKIAogCWRybV9wcmludGYoJnAsICJObyBz
cGFjZSBmb3IgJXAgKCVsdSBwYWdlcywgJXp1SywgJXp1TSlcbiIsCi0JCSAgIGJvLCBiby0+bWVt
Lm51bV9wYWdlcywgYm8tPmJhc2Uuc2l6ZSA+PiAxMCwKKwkJICAgYm8sIGJvLT5yZXNvdXJjZS0+
bnVtX3BhZ2VzLCBiby0+YmFzZS5zaXplID4+IDEwLAogCQkgICBiby0+YmFzZS5zaXplID4+IDIw
KTsKIAlmb3IgKGkgPSAwOyBpIDwgcGxhY2VtZW50LT5udW1fcGxhY2VtZW50OyBpKyspIHsKIAkJ
bWVtX3R5cGUgPSBwbGFjZW1lbnQtPnBsYWNlbWVudFtpXS5tZW1fdHlwZTsKQEAgLTEwOSw3ICsx
MDksNyBAQCB2b2lkIHR0bV9ib19tb3ZlX3RvX2xydV90YWlsKHN0cnVjdCB0dG1fYnVmZmVyX29i
amVjdCAqYm8sCiAJCWJkZXYtPmZ1bmNzLT5kZWxfZnJvbV9scnVfbm90aWZ5KGJvKTsKIAogCWlm
IChidWxrICYmICFiby0+cGluX2NvdW50KSB7Ci0JCXN3aXRjaCAoYm8tPm1lbS5tZW1fdHlwZSkg
eworCQlzd2l0Y2ggKGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUpIHsKIAkJY2FzZSBUVE1fUExfVFQ6
CiAJCQl0dG1fYm9fYnVsa19tb3ZlX3NldF9wb3MoJmJ1bGstPnR0W2JvLT5wcmlvcml0eV0sIGJv
KTsKIAkJCWJyZWFrOwpAQCAtMTYzLDExICsxNjMsMTMgQEAgc3RhdGljIGludCB0dG1fYm9faGFu
ZGxlX21vdmVfbWVtKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJCQkJICBzdHJ1Y3Qg
dHRtX29wZXJhdGlvbl9jdHggKmN0eCwKIAkJCQkgIHN0cnVjdCB0dG1fcGxhY2UgKmhvcCkKIHsK
KwlzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm9sZF9tYW4sICpuZXdfbWFuOwogCXN0cnVj
dCB0dG1fZGV2aWNlICpiZGV2ID0gYm8tPmJkZXY7Ci0Jc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5h
Z2VyICpvbGRfbWFuID0gdHRtX21hbmFnZXJfdHlwZShiZGV2LCBiby0+bWVtLm1lbV90eXBlKTsK
LQlzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm5ld19tYW4gPSB0dG1fbWFuYWdlcl90eXBl
KGJkZXYsIG1lbS0+bWVtX3R5cGUpOwogCWludCByZXQ7CiAKKwlvbGRfbWFuID0gdHRtX21hbmFn
ZXJfdHlwZShiZGV2LCBiby0+cmVzb3VyY2UtPm1lbV90eXBlKTsKKwluZXdfbWFuID0gdHRtX21h
bmFnZXJfdHlwZShiZGV2LCBtZW0tPm1lbV90eXBlKTsKKwogCXR0bV9ib191bm1hcF92aXJ0dWFs
KGJvKTsKIAogCS8qCkBAIC0yMDAsNyArMjAyLDcgQEAgc3RhdGljIGludCB0dG1fYm9faGFuZGxl
X21vdmVfbWVtKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJcmV0dXJuIDA7CiAKIG91
dF9lcnI6Ci0JbmV3X21hbiA9IHR0bV9tYW5hZ2VyX3R5cGUoYmRldiwgYm8tPm1lbS5tZW1fdHlw
ZSk7CisJbmV3X21hbiA9IHR0bV9tYW5hZ2VyX3R5cGUoYmRldiwgYm8tPnJlc291cmNlLT5tZW1f
dHlwZSk7CiAJaWYgKCFuZXdfbWFuLT51c2VfdHQpCiAJCXR0bV9ib190dF9kZXN0cm95KGJvKTsK
IApAQCAtMjIxLDcgKzIyMyw3IEBAIHN0YXRpYyB2b2lkIHR0bV9ib19jbGVhbnVwX21lbXR5cGVf
dXNlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8pCiAJCWJvLT5iZGV2LT5mdW5jcy0+ZGVs
ZXRlX21lbV9ub3RpZnkoYm8pOwogCiAJdHRtX2JvX3R0X2Rlc3Ryb3koYm8pOwotCXR0bV9yZXNv
dXJjZV9mcmVlKGJvLCAmYm8tPm1lbSk7CisJdHRtX3Jlc291cmNlX2ZyZWUoYm8sIGJvLT5yZXNv
dXJjZSk7CiB9CiAKIHN0YXRpYyBpbnQgdHRtX2JvX2luZGl2aWR1YWxpemVfcmVzdihzdHJ1Y3Qg
dHRtX2J1ZmZlcl9vYmplY3QgKmJvKQpAQCAtNDE1LDcgKzQxNyw3IEBAIHN0YXRpYyB2b2lkIHR0
bV9ib19yZWxlYXNlKHN0cnVjdCBrcmVmICprcmVmKQogCQkJYm8tPmJkZXYtPmZ1bmNzLT5yZWxl
YXNlX25vdGlmeShibyk7CiAKIAkJZHJtX3ZtYV9vZmZzZXRfcmVtb3ZlKGJkZXYtPnZtYV9tYW5h
Z2VyLCAmYm8tPmJhc2Uudm1hX25vZGUpOwotCQl0dG1fbWVtX2lvX2ZyZWUoYmRldiwgJmJvLT5t
ZW0pOworCQl0dG1fbWVtX2lvX2ZyZWUoYmRldiwgYm8tPnJlc291cmNlKTsKIAl9CiAKIAlpZiAo
IWRtYV9yZXN2X3Rlc3Rfc2lnbmFsZWRfcmN1KGJvLT5iYXNlLnJlc3YsIHRydWUpIHx8CkBAIC00
MzYsNyArNDM4LDcgQEAgc3RhdGljIHZvaWQgdHRtX2JvX3JlbGVhc2Uoc3RydWN0IGtyZWYgKmty
ZWYpCiAJCSAqLwogCQlpZiAoV0FSTl9PTl9PTkNFKGJvLT5waW5fY291bnQpKSB7CiAJCQliby0+
cGluX2NvdW50ID0gMDsKLQkJCXR0bV9ib19tb3ZlX3RvX2xydV90YWlsKGJvLCAmYm8tPm1lbSwg
TlVMTCk7CisJCQl0dG1fYm9fbW92ZV90b19scnVfdGFpbChibywgYm8tPnJlc291cmNlLCBOVUxM
KTsKIAkJfQogCiAJCWtyZWZfaW5pdCgmYm8tPmtyZWYpOwpAQCAtNTM0LDggKzUzNiw4IEBAIGJv
b2wgdHRtX2JvX2V2aWN0aW9uX3ZhbHVhYmxlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8s
CiAJLyogRG9uJ3QgZXZpY3QgdGhpcyBCTyBpZiBpdCdzIG91dHNpZGUgb2YgdGhlCiAJICogcmVx
dWVzdGVkIHBsYWNlbWVudCByYW5nZQogCSAqLwotCWlmIChwbGFjZS0+ZnBmbiA+PSAoYm8tPm1l
bS5zdGFydCArIGJvLT5tZW0ubnVtX3BhZ2VzKSB8fAotCSAgICAocGxhY2UtPmxwZm4gJiYgcGxh
Y2UtPmxwZm4gPD0gYm8tPm1lbS5zdGFydCkpCisJaWYgKHBsYWNlLT5mcGZuID49IChiby0+cmVz
b3VyY2UtPnN0YXJ0ICsgYm8tPnJlc291cmNlLT5udW1fcGFnZXMpIHx8CisJICAgIChwbGFjZS0+
bHBmbiAmJiBwbGFjZS0+bHBmbiA8PSBiby0+cmVzb3VyY2UtPnN0YXJ0KSkKIAkJcmV0dXJuIGZh
bHNlOwogCiAJcmV0dXJuIHRydWU7CkBAIC04NDksNyArODUxLDcgQEAgaW50IHR0bV9ib19tZW1f
c3BhY2Uoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAl9CiAKIGVycm9yOgotCWlmIChi
by0+bWVtLm1lbV90eXBlID09IFRUTV9QTF9TWVNURU0gJiYgIWJvLT5waW5fY291bnQpCisJaWYg
KGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1NZU1RFTSAmJiAhYm8tPnBpbl9jb3Vu
dCkKIAkJdHRtX2JvX21vdmVfdG9fbHJ1X3RhaWxfdW5sb2NrZWQoYm8pOwogCiAJcmV0dXJuIHJl
dDsKQEAgLTk4NSw3ICs5ODcsNyBAQCBpbnQgdHRtX2JvX3ZhbGlkYXRlKHN0cnVjdCB0dG1fYnVm
ZmVyX29iamVjdCAqYm8sCiAJLyoKIAkgKiBDaGVjayB3aGV0aGVyIHdlIG5lZWQgdG8gbW92ZSBi
dWZmZXIuCiAJICovCi0JaWYgKCF0dG1fYm9fbWVtX2NvbXBhdChwbGFjZW1lbnQsICZiby0+bWVt
LCAmbmV3X2ZsYWdzKSkgeworCWlmICghdHRtX2JvX21lbV9jb21wYXQocGxhY2VtZW50LCBiby0+
cmVzb3VyY2UsICZuZXdfZmxhZ3MpKSB7CiAJCXJldCA9IHR0bV9ib19tb3ZlX2J1ZmZlcihibywg
cGxhY2VtZW50LCBjdHgpOwogCQlpZiAocmV0KQogCQkJcmV0dXJuIHJldDsKQEAgLTk5Myw3ICs5
OTUsNyBAQCBpbnQgdHRtX2JvX3ZhbGlkYXRlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8s
CiAJLyoKIAkgKiBXZSBtaWdodCBuZWVkIHRvIGFkZCBhIFRUTS4KIAkgKi8KLQlpZiAoYm8tPm1l
bS5tZW1fdHlwZSA9PSBUVE1fUExfU1lTVEVNKSB7CisJaWYgKGJvLT5yZXNvdXJjZS0+bWVtX3R5
cGUgPT0gVFRNX1BMX1NZU1RFTSkgewogCQlyZXQgPSB0dG1fdHRfY3JlYXRlKGJvLCB0cnVlKTsK
IAkJaWYgKHJldCkKIAkJCXJldHVybiByZXQ7CkBAIC0xMDI1LDcgKzEwMjcsOCBAQCBpbnQgdHRt
X2JvX2luaXRfcmVzZXJ2ZWQoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsCiAJYm8tPmJkZXYgPSBi
ZGV2OwogCWJvLT50eXBlID0gdHlwZTsKIAliby0+cGFnZV9hbGlnbm1lbnQgPSBwYWdlX2FsaWdu
bWVudDsKLQl0dG1fcmVzb3VyY2VfYWxsb2MoYm8sICZzeXNfbWVtLCAmYm8tPm1lbSk7CisJYm8t
PnJlc291cmNlID0gJmJvLT5fbWVtOworCXR0bV9yZXNvdXJjZV9hbGxvYyhibywgJnN5c19tZW0s
IGJvLT5yZXNvdXJjZSk7CiAJYm8tPm1vdmluZyA9IE5VTEw7CiAJYm8tPnBpbl9jb3VudCA9IDA7
CiAJYm8tPnNnID0gc2c7CkBAIC0xMDUzLDcgKzEwNTYsNyBAQCBpbnQgdHRtX2JvX2luaXRfcmVz
ZXJ2ZWQoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsCiAJaWYgKGJvLT50eXBlID09IHR0bV9ib190
eXBlX2RldmljZSB8fAogCSAgICBiby0+dHlwZSA9PSB0dG1fYm9fdHlwZV9zZykKIAkJcmV0ID0g
ZHJtX3ZtYV9vZmZzZXRfYWRkKGJkZXYtPnZtYV9tYW5hZ2VyLCAmYm8tPmJhc2Uudm1hX25vZGUs
Ci0JCQkJCSBiby0+bWVtLm51bV9wYWdlcyk7CisJCQkJCSBiby0+cmVzb3VyY2UtPm51bV9wYWdl
cyk7CiAKIAkvKiBwYXNzZWQgcmVzZXJ2YXRpb24gb2JqZWN0cyBzaG91bGQgYWxyZWFkeSBiZSBs
b2NrZWQsCiAJICogc2luY2Ugb3RoZXJ3aXNlIGxvY2tkZXAgd2lsbCBiZSBhbmdlcmVkIGluIHJh
ZGVvbi4KQEAgLTExMTUsNyArMTExOCw3IEBAIHZvaWQgdHRtX2JvX3VubWFwX3ZpcnR1YWwoc3Ry
dWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibykKIAlzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiA9IGJv
LT5iZGV2OwogCiAJZHJtX3ZtYV9ub2RlX3VubWFwKCZiby0+YmFzZS52bWFfbm9kZSwgYmRldi0+
ZGV2X21hcHBpbmcpOwotCXR0bV9tZW1faW9fZnJlZShiZGV2LCAmYm8tPm1lbSk7CisJdHRtX21l
bV9pb19mcmVlKGJkZXYsIGJvLT5yZXNvdXJjZSk7CiB9CiBFWFBPUlRfU1lNQk9MKHR0bV9ib191
bm1hcF92aXJ0dWFsKTsKIApAQCAtMTE3MiwxNCArMTE3NSwxNCBAQCBpbnQgdHRtX2JvX3N3YXBv
dXQoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywgc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4
ICpjdHgsCiAJLyoKIAkgKiBNb3ZlIHRvIHN5c3RlbSBjYWNoZWQKIAkgKi8KLQlpZiAoYm8tPm1l
bS5tZW1fdHlwZSAhPSBUVE1fUExfU1lTVEVNKSB7CisJaWYgKGJvLT5yZXNvdXJjZS0+bWVtX3R5
cGUgIT0gVFRNX1BMX1NZU1RFTSkgewogCQlzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHggY3R4ID0g
eyBmYWxzZSwgZmFsc2UgfTsKIAkJc3RydWN0IHR0bV9yZXNvdXJjZSBldmljdF9tZW07CiAJCXN0
cnVjdCB0dG1fcGxhY2UgaG9wOwogCiAJCW1lbXNldCgmaG9wLCAwLCBzaXplb2YoaG9wKSk7CiAK
LQkJZXZpY3RfbWVtID0gYm8tPm1lbTsKKwkJZXZpY3RfbWVtID0gKmJvLT5yZXNvdXJjZTsKIAkJ
ZXZpY3RfbWVtLm1tX25vZGUgPSBOVUxMOwogCQlldmljdF9tZW0ucGxhY2VtZW50ID0gMDsKIAkJ
ZXZpY3RfbWVtLm1lbV90eXBlID0gVFRNX1BMX1NZU1RFTTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS90dG0vdHRtX2JvX3V0aWwuYyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3V0
aWwuYwppbmRleCBhZThiNjE0NjA3MjQuLmFlZGYwMmEzMWM3MCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL3R0bS90dG1fYm9fdXRpbC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRt
X2JvX3V0aWwuYwpAQCAtMTc5LDcgKzE3OSw3IEBAIGludCB0dG1fYm9fbW92ZV9tZW1jcHkoc3Ry
dWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAlzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiA9IGJv
LT5iZGV2OwogCXN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuID0gdHRtX21hbmFnZXJf
dHlwZShiZGV2LCBuZXdfbWVtLT5tZW1fdHlwZSk7CiAJc3RydWN0IHR0bV90dCAqdHRtID0gYm8t
PnR0bTsKLQlzdHJ1Y3QgdHRtX3Jlc291cmNlICpvbGRfbWVtID0gJmJvLT5tZW07CisJc3RydWN0
IHR0bV9yZXNvdXJjZSAqb2xkX21lbSA9IGJvLT5yZXNvdXJjZTsKIAlzdHJ1Y3QgdHRtX3Jlc291
cmNlIG9sZF9jb3B5ID0gKm9sZF9tZW07CiAJdm9pZCAqb2xkX2lvbWFwOwogCXZvaWQgKm5ld19p
b21hcDsKQEAgLTM2NSwyNCArMzY1LDIzIEBAIHN0YXRpYyBpbnQgdHRtX2JvX2lvcmVtYXAoc3Ry
dWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAkJCSAgdW5zaWduZWQgbG9uZyBzaXplLAogCQkJ
ICBzdHJ1Y3QgdHRtX2JvX2ttYXBfb2JqICptYXApCiB7Ci0Jc3RydWN0IHR0bV9yZXNvdXJjZSAq
bWVtID0gJmJvLT5tZW07CisJc3RydWN0IHR0bV9yZXNvdXJjZSAqbWVtID0gYm8tPnJlc291cmNl
OwogCi0JaWYgKGJvLT5tZW0uYnVzLmFkZHIpIHsKKwlpZiAoYm8tPnJlc291cmNlLT5idXMuYWRk
cikgewogCQltYXAtPmJvX2ttYXBfdHlwZSA9IHR0bV9ib19tYXBfcHJlbWFwcGVkOwotCQltYXAt
PnZpcnR1YWwgPSAodm9pZCAqKSgoKHU4ICopYm8tPm1lbS5idXMuYWRkcikgKyBvZmZzZXQpOwor
CQltYXAtPnZpcnR1YWwgPSAoKHU4ICopYm8tPnJlc291cmNlLT5idXMuYWRkcikgKyBvZmZzZXQ7
CiAJfSBlbHNlIHsKKwkJcmVzb3VyY2Vfc2l6ZV90IHJlcyA9IGJvLT5yZXNvdXJjZS0+YnVzLm9m
ZnNldCArIG9mZnNldDsKKwogCQltYXAtPmJvX2ttYXBfdHlwZSA9IHR0bV9ib19tYXBfaW9tYXA7
CiAJCWlmIChtZW0tPmJ1cy5jYWNoaW5nID09IHR0bV93cml0ZV9jb21iaW5lZCkKLQkJCW1hcC0+
dmlydHVhbCA9IGlvcmVtYXBfd2MoYm8tPm1lbS5idXMub2Zmc2V0ICsgb2Zmc2V0LAotCQkJCQkJ
ICBzaXplKTsKKwkJCW1hcC0+dmlydHVhbCA9IGlvcmVtYXBfd2MocmVzLCBzaXplKTsKICNpZmRl
ZiBDT05GSUdfWDg2CiAJCWVsc2UgaWYgKG1lbS0+YnVzLmNhY2hpbmcgPT0gdHRtX2NhY2hlZCkK
LQkJCW1hcC0+dmlydHVhbCA9IGlvcmVtYXBfY2FjaGUoYm8tPm1lbS5idXMub2Zmc2V0ICsgb2Zm
c2V0LAotCQkJCQkJICBzaXplKTsKKwkJCW1hcC0+dmlydHVhbCA9IGlvcmVtYXBfY2FjaGUocmVz
LCBzaXplKTsKICNlbmRpZgogCQllbHNlCi0JCQltYXAtPnZpcnR1YWwgPSBpb3JlbWFwKGJvLT5t
ZW0uYnVzLm9mZnNldCArIG9mZnNldCwKLQkJCQkJICAgICAgIHNpemUpOworCQkJbWFwLT52aXJ0
dWFsID0gaW9yZW1hcChyZXMsIHNpemUpOwogCX0KIAlyZXR1cm4gKCFtYXAtPnZpcnR1YWwpID8g
LUVOT01FTSA6IDA7CiB9CkBAIC0zOTIsNyArMzkxLDcgQEAgc3RhdGljIGludCB0dG1fYm9fa21h
cF90dG0oc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAkJCSAgIHVuc2lnbmVkIGxvbmcg
bnVtX3BhZ2VzLAogCQkJICAgc3RydWN0IHR0bV9ib19rbWFwX29iaiAqbWFwKQogewotCXN0cnVj
dCB0dG1fcmVzb3VyY2UgKm1lbSA9ICZiby0+bWVtOworCXN0cnVjdCB0dG1fcmVzb3VyY2UgKm1l
bSA9IGJvLT5yZXNvdXJjZTsKIAlzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHggY3R4ID0gewogCQku
aW50ZXJydXB0aWJsZSA9IGZhbHNlLAogCQkubm9fd2FpdF9ncHUgPSBmYWxzZQpAQCAtNDM4LDE1
ICs0MzcsMTUgQEAgaW50IHR0bV9ib19rbWFwKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8s
CiAKIAltYXAtPnZpcnR1YWwgPSBOVUxMOwogCW1hcC0+Ym8gPSBibzsKLQlpZiAobnVtX3BhZ2Vz
ID4gYm8tPm1lbS5udW1fcGFnZXMpCisJaWYgKG51bV9wYWdlcyA+IGJvLT5yZXNvdXJjZS0+bnVt
X3BhZ2VzKQogCQlyZXR1cm4gLUVJTlZBTDsKLQlpZiAoKHN0YXJ0X3BhZ2UgKyBudW1fcGFnZXMp
ID4gYm8tPm1lbS5udW1fcGFnZXMpCisJaWYgKChzdGFydF9wYWdlICsgbnVtX3BhZ2VzKSA+IGJv
LT5yZXNvdXJjZS0+bnVtX3BhZ2VzKQogCQlyZXR1cm4gLUVJTlZBTDsKIAotCXJldCA9IHR0bV9t
ZW1faW9fcmVzZXJ2ZShiby0+YmRldiwgJmJvLT5tZW0pOworCXJldCA9IHR0bV9tZW1faW9fcmVz
ZXJ2ZShiby0+YmRldiwgYm8tPnJlc291cmNlKTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0Owot
CWlmICghYm8tPm1lbS5idXMuaXNfaW9tZW0pIHsKKwlpZiAoIWJvLT5yZXNvdXJjZS0+YnVzLmlz
X2lvbWVtKSB7CiAJCXJldHVybiB0dG1fYm9fa21hcF90dG0oYm8sIHN0YXJ0X3BhZ2UsIG51bV9w
YWdlcywgbWFwKTsKIAl9IGVsc2UgewogCQlvZmZzZXQgPSBzdGFydF9wYWdlIDw8IFBBR0VfU0hJ
RlQ7CkBAIC00NzUsNyArNDc0LDcgQEAgdm9pZCB0dG1fYm9fa3VubWFwKHN0cnVjdCB0dG1fYm9f
a21hcF9vYmogKm1hcCkKIAlkZWZhdWx0OgogCQlCVUcoKTsKIAl9Ci0JdHRtX21lbV9pb19mcmVl
KG1hcC0+Ym8tPmJkZXYsICZtYXAtPmJvLT5tZW0pOworCXR0bV9tZW1faW9fZnJlZShtYXAtPmJv
LT5iZGV2LCBtYXAtPmJvLT5yZXNvdXJjZSk7CiAJbWFwLT52aXJ0dWFsID0gTlVMTDsKIAltYXAt
PnBhZ2UgPSBOVUxMOwogfQpAQCAtNDgzLDcgKzQ4Miw3IEBAIEVYUE9SVF9TWU1CT0wodHRtX2Jv
X2t1bm1hcCk7CiAKIGludCB0dG1fYm9fdm1hcChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJv
LCBzdHJ1Y3QgZG1hX2J1Zl9tYXAgKm1hcCkKIHsKLQlzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0g
PSAmYm8tPm1lbTsKKwlzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0gPSBiby0+cmVzb3VyY2U7CiAJ
aW50IHJldDsKIAogCXJldCA9IHR0bV9tZW1faW9fcmVzZXJ2ZShiby0+YmRldiwgbWVtKTsKQEAg
LTU0Miw3ICs1NDEsNyBAQCBFWFBPUlRfU1lNQk9MKHR0bV9ib192bWFwKTsKIAogdm9pZCB0dG1f
Ym9fdnVubWFwKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sIHN0cnVjdCBkbWFfYnVmX21h
cCAqbWFwKQogewotCXN0cnVjdCB0dG1fcmVzb3VyY2UgKm1lbSA9ICZiby0+bWVtOworCXN0cnVj
dCB0dG1fcmVzb3VyY2UgKm1lbSA9IGJvLT5yZXNvdXJjZTsKIAogCWlmIChkbWFfYnVmX21hcF9p
c19udWxsKG1hcCkpCiAJCXJldHVybjsKQEAgLTU1Myw3ICs1NTIsNyBAQCB2b2lkIHR0bV9ib192
dW5tYXAoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywgc3RydWN0IGRtYV9idWZfbWFwICpt
YXApCiAJCWlvdW5tYXAobWFwLT52YWRkcl9pb21lbSk7CiAJZG1hX2J1Zl9tYXBfY2xlYXIobWFw
KTsKIAotCXR0bV9tZW1faW9fZnJlZShiby0+YmRldiwgJmJvLT5tZW0pOworCXR0bV9tZW1faW9f
ZnJlZShiby0+YmRldiwgYm8tPnJlc291cmNlKTsKIH0KIEVYUE9SVF9TWU1CT0wodHRtX2JvX3Z1
bm1hcCk7CiAKQEAgLTU2Nyw3ICs1NjYsNyBAQCBzdGF0aWMgaW50IHR0bV9ib193YWl0X2ZyZWVf
bm9kZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCiAJaWYgKCFkc3RfdXNlX3R0KQog
CQl0dG1fYm9fdHRfZGVzdHJveShibyk7Ci0JdHRtX3Jlc291cmNlX2ZyZWUoYm8sICZiby0+bWVt
KTsKKwl0dG1fcmVzb3VyY2VfZnJlZShibywgYm8tPnJlc291cmNlKTsKIAlyZXR1cm4gMDsKIH0K
IApAQCAtNjE1LDcgKzYxNCw5IEBAIHN0YXRpYyB2b2lkIHR0bV9ib19tb3ZlX3BpcGVsaW5lX2V2
aWN0KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJCQkJICAgICAgIHN0cnVjdCBkbWFf
ZmVuY2UgKmZlbmNlKQogewogCXN0cnVjdCB0dG1fZGV2aWNlICpiZGV2ID0gYm8tPmJkZXY7Ci0J
c3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICpmcm9tID0gdHRtX21hbmFnZXJfdHlwZShiZGV2
LCBiby0+bWVtLm1lbV90eXBlKTsKKwlzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKmZyb207
CisKKwlmcm9tID0gdHRtX21hbmFnZXJfdHlwZShiZGV2LCBiby0+cmVzb3VyY2UtPm1lbV90eXBl
KTsKIAogCS8qKgogCSAqIEJPIGRvZXNuJ3QgaGF2ZSBhIFRUTSB3ZSBuZWVkIHRvIGJpbmQvdW5i
aW5kLiBKdXN0IHJlbWVtYmVyCkBAIC02MjgsNyArNjI5LDcgQEAgc3RhdGljIHZvaWQgdHRtX2Jv
X21vdmVfcGlwZWxpbmVfZXZpY3Qoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAl9CiAJ
c3Bpbl91bmxvY2soJmZyb20tPm1vdmVfbG9jayk7CiAKLQl0dG1fcmVzb3VyY2VfZnJlZShibywg
JmJvLT5tZW0pOworCXR0bV9yZXNvdXJjZV9mcmVlKGJvLCBiby0+cmVzb3VyY2UpOwogCiAJZG1h
X2ZlbmNlX3B1dChiby0+bW92aW5nKTsKIAliby0+bW92aW5nID0gZG1hX2ZlbmNlX2dldChmZW5j
ZSk7CkBAIC02NDEsNyArNjQyLDcgQEAgaW50IHR0bV9ib19tb3ZlX2FjY2VsX2NsZWFudXAoc3Ry
dWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAkJCSAgICAgIHN0cnVjdCB0dG1fcmVzb3VyY2Ug
Km5ld19tZW0pCiB7CiAJc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYgPSBiby0+YmRldjsKLQlzdHJ1
Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKmZyb20gPSB0dG1fbWFuYWdlcl90eXBlKGJkZXYsIGJv
LT5tZW0ubWVtX3R5cGUpOworCXN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqZnJvbSA9IHR0
bV9tYW5hZ2VyX3R5cGUoYmRldiwgYm8tPnJlc291cmNlLT5tZW1fdHlwZSk7CiAJc3RydWN0IHR0
bV9yZXNvdXJjZV9tYW5hZ2VyICptYW4gPSB0dG1fbWFuYWdlcl90eXBlKGJkZXYsIG5ld19tZW0t
Pm1lbV90eXBlKTsKIAlpbnQgcmV0ID0gMDsKIApAQCAtNjc3LDcgKzY3OCw3IEBAIGludCB0dG1f
Ym9fcGlwZWxpbmVfZ3V0dGluZyhzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvKQogCWlmIChy
ZXQpCiAJCXR0bV9ib193YWl0KGJvLCBmYWxzZSwgZmFsc2UpOwogCi0JdHRtX3Jlc291cmNlX2Fs
bG9jKGJvLCAmc3lzX21lbSwgJmJvLT5tZW0pOworCXR0bV9yZXNvdXJjZV9hbGxvYyhibywgJnN5
c19tZW0sIGJvLT5yZXNvdXJjZSk7CiAJYm8tPnR0bSA9IE5VTEw7CiAKIAlkbWFfcmVzdl91bmxv
Y2soJmdob3N0LT5iYXNlLl9yZXN2KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90dG0v
dHRtX2JvX3ZtLmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib192bS5jCmluZGV4IGIzMWIx
ODA1ODk2NS4uZTNmMTY4MzIxZDJmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0
bV9ib192bS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3ZtLmMKQEAgLTEwMCw3
ICsxMDAsNyBAQCBzdGF0aWMgdW5zaWduZWQgbG9uZyB0dG1fYm9faW9fbWVtX3BmbihzdHJ1Y3Qg
dHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCWlmIChiZGV2LT5mdW5jcy0+aW9fbWVtX3BmbikKIAkJ
cmV0dXJuIGJkZXYtPmZ1bmNzLT5pb19tZW1fcGZuKGJvLCBwYWdlX29mZnNldCk7CiAKLQlyZXR1
cm4gKGJvLT5tZW0uYnVzLm9mZnNldCA+PiBQQUdFX1NISUZUKSArIHBhZ2Vfb2Zmc2V0OworCXJl
dHVybiAoYm8tPnJlc291cmNlLT5idXMub2Zmc2V0ID4+IFBBR0VfU0hJRlQpICsgcGFnZV9vZmZz
ZXQ7CiB9CiAKIC8qKgpAQCAtMTk4LDEwICsxOTgsMTAgQEAgc3RhdGljIHZtX2ZhdWx0X3QgdHRt
X2JvX3ZtX2luc2VydF9odWdlKHN0cnVjdCB2bV9mYXVsdCAqdm1mLAogCiAJLyogRmF1bHQgc2hv
dWxkIG5vdCBjcm9zcyBibyBib3VuZGFyeS4gKi8KIAlwYWdlX29mZnNldCAmPSB+KGZhdWx0X3Bh
Z2Vfc2l6ZSAtIDEpOwotCWlmIChwYWdlX29mZnNldCArIGZhdWx0X3BhZ2Vfc2l6ZSA+IGJvLT5t
ZW0ubnVtX3BhZ2VzKQorCWlmIChwYWdlX29mZnNldCArIGZhdWx0X3BhZ2Vfc2l6ZSA+IGJvLT5y
ZXNvdXJjZS0+bnVtX3BhZ2VzKQogCQlnb3RvIG91dF9mYWxsYmFjazsKIAotCWlmIChiby0+bWVt
LmJ1cy5pc19pb21lbSkKKwlpZiAoYm8tPnJlc291cmNlLT5idXMuaXNfaW9tZW0pCiAJCXBmbiA9
IHR0bV9ib19pb19tZW1fcGZuKGJvLCBwYWdlX29mZnNldCk7CiAJZWxzZQogCQlwZm4gPSBwYWdl
X3RvX3Bmbih0dG0tPnBhZ2VzW3BhZ2Vfb2Zmc2V0XSk7CkBAIC0yMTEsNyArMjExLDcgQEAgc3Rh
dGljIHZtX2ZhdWx0X3QgdHRtX2JvX3ZtX2luc2VydF9odWdlKHN0cnVjdCB2bV9mYXVsdCAqdm1m
LAogCQlnb3RvIG91dF9mYWxsYmFjazsKIAogCS8qIENoZWNrIHRoYXQgbWVtb3J5IGlzIGNvbnRp
Z3VvdXMuICovCi0JaWYgKCFiby0+bWVtLmJ1cy5pc19pb21lbSkgeworCWlmICghYm8tPnJlc291
cmNlLT5idXMuaXNfaW9tZW0pIHsKIAkJZm9yIChpID0gMTsgaSA8IGZhdWx0X3BhZ2Vfc2l6ZTsg
KytpKSB7CiAJCQlpZiAocGFnZV90b19wZm4odHRtLT5wYWdlc1twYWdlX29mZnNldCArIGldKSAh
PSBwZm4gKyBpKQogCQkJCWdvdG8gb3V0X2ZhbGxiYWNrOwpAQCAtMjk3LDcgKzI5Nyw3IEBAIHZt
X2ZhdWx0X3QgdHRtX2JvX3ZtX2ZhdWx0X3Jlc2VydmVkKHN0cnVjdCB2bV9mYXVsdCAqdm1mLAog
CWlmICh1bmxpa2VseShyZXQgIT0gMCkpCiAJCXJldHVybiByZXQ7CiAKLQllcnIgPSB0dG1fbWVt
X2lvX3Jlc2VydmUoYmRldiwgJmJvLT5tZW0pOworCWVyciA9IHR0bV9tZW1faW9fcmVzZXJ2ZShi
ZGV2LCBiby0+cmVzb3VyY2UpOwogCWlmICh1bmxpa2VseShlcnIgIT0gMCkpCiAJCXJldHVybiBW
TV9GQVVMVF9TSUdCVVM7CiAKQEAgLTMwNiwxMSArMzA2LDExIEBAIHZtX2ZhdWx0X3QgdHRtX2Jv
X3ZtX2ZhdWx0X3Jlc2VydmVkKHN0cnVjdCB2bV9mYXVsdCAqdm1mLAogCXBhZ2VfbGFzdCA9IHZt
YV9wYWdlcyh2bWEpICsgdm1hLT52bV9wZ29mZiAtCiAJCWRybV92bWFfbm9kZV9zdGFydCgmYm8t
PmJhc2Uudm1hX25vZGUpOwogCi0JaWYgKHVubGlrZWx5KHBhZ2Vfb2Zmc2V0ID49IGJvLT5tZW0u
bnVtX3BhZ2VzKSkKKwlpZiAodW5saWtlbHkocGFnZV9vZmZzZXQgPj0gYm8tPnJlc291cmNlLT5u
dW1fcGFnZXMpKQogCQlyZXR1cm4gVk1fRkFVTFRfU0lHQlVTOwogCi0JcHJvdCA9IHR0bV9pb19w
cm90KGJvLCAmYm8tPm1lbSwgcHJvdCk7Ci0JaWYgKCFiby0+bWVtLmJ1cy5pc19pb21lbSkgewor
CXByb3QgPSB0dG1faW9fcHJvdChibywgYm8tPnJlc291cmNlLCBwcm90KTsKKwlpZiAoIWJvLT5y
ZXNvdXJjZS0+YnVzLmlzX2lvbWVtKSB7CiAJCXN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0eCBjdHgg
PSB7CiAJCQkuaW50ZXJydXB0aWJsZSA9IGZhbHNlLAogCQkJLm5vX3dhaXRfZ3B1ID0gZmFsc2Us
CkBAIC0zMzUsNyArMzM1LDcgQEAgdm1fZmF1bHRfdCB0dG1fYm9fdm1fZmF1bHRfcmVzZXJ2ZWQo
c3RydWN0IHZtX2ZhdWx0ICp2bWYsCiAJICogZmlyc3QgcGFnZS4KIAkgKi8KIAlmb3IgKGkgPSAw
OyBpIDwgbnVtX3ByZWZhdWx0OyArK2kpIHsKLQkJaWYgKGJvLT5tZW0uYnVzLmlzX2lvbWVtKSB7
CisJCWlmIChiby0+cmVzb3VyY2UtPmJ1cy5pc19pb21lbSkgewogCQkJcGZuID0gdHRtX2JvX2lv
X21lbV9wZm4oYm8sIHBhZ2Vfb2Zmc2V0KTsKIAkJfSBlbHNlIHsKIAkJCXBhZ2UgPSB0dG0tPnBh
Z2VzW3BhZ2Vfb2Zmc2V0XTsKQEAgLTQ2OSwxNCArNDY5LDE0IEBAIGludCB0dG1fYm9fdm1fYWNj
ZXNzKHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hLCB1bnNpZ25lZCBsb25nIGFkZHIsCiAJCSA8
PCBQQUdFX1NISUZUKTsKIAlpbnQgcmV0OwogCi0JaWYgKGxlbiA8IDEgfHwgKG9mZnNldCArIGxl
bikgPj4gUEFHRV9TSElGVCA+IGJvLT5tZW0ubnVtX3BhZ2VzKQorCWlmIChsZW4gPCAxIHx8IChv
ZmZzZXQgKyBsZW4pID4+IFBBR0VfU0hJRlQgPiBiby0+cmVzb3VyY2UtPm51bV9wYWdlcykKIAkJ
cmV0dXJuIC1FSU87CiAKIAlyZXQgPSB0dG1fYm9fcmVzZXJ2ZShibywgdHJ1ZSwgZmFsc2UsIE5V
TEwpOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKLQlzd2l0Y2ggKGJvLT5tZW0ubWVtX3R5
cGUpIHsKKwlzd2l0Y2ggKGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUpIHsKIAljYXNlIFRUTV9QTF9T
WVNURU06CiAJCWlmICh1bmxpa2VseShiby0+dHRtLT5wYWdlX2ZsYWdzICYgVFRNX1BBR0VfRkxB
R19TV0FQUEVEKSkgewogCQkJcmV0ID0gdHRtX3R0X3N3YXBpbihiby0+dHRtKTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2JsaXQuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS92bXdnZngvdm13Z2Z4X2JsaXQuYwppbmRleCAzYTQzOGFlNGQzZjQuLmZhN2MwYzhkYTE5MyAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfYmxpdC5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2JsaXQuYwpAQCAtNDgzLDEwICs0ODMsMTAgQEAg
aW50IHZtd19ib19jcHVfYmxpdChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmRzdCwKIAlkLnNy
Y19hZGRyID0gTlVMTDsKIAlkLmRzdF9wYWdlcyA9IGRzdC0+dHRtLT5wYWdlczsKIAlkLnNyY19w
YWdlcyA9IHNyYy0+dHRtLT5wYWdlczsKLQlkLmRzdF9udW1fcGFnZXMgPSBkc3QtPm1lbS5udW1f
cGFnZXM7Ci0JZC5zcmNfbnVtX3BhZ2VzID0gc3JjLT5tZW0ubnVtX3BhZ2VzOwotCWQuZHN0X3By
b3QgPSB0dG1faW9fcHJvdChkc3QsICZkc3QtPm1lbSwgUEFHRV9LRVJORUwpOwotCWQuc3JjX3By
b3QgPSB0dG1faW9fcHJvdChzcmMsICZzcmMtPm1lbSwgUEFHRV9LRVJORUwpOworCWQuZHN0X251
bV9wYWdlcyA9IGRzdC0+cmVzb3VyY2UtPm51bV9wYWdlczsKKwlkLnNyY19udW1fcGFnZXMgPSBz
cmMtPnJlc291cmNlLT5udW1fcGFnZXM7CisJZC5kc3RfcHJvdCA9IHR0bV9pb19wcm90KGRzdCwg
ZHN0LT5yZXNvdXJjZSwgUEFHRV9LRVJORUwpOworCWQuc3JjX3Byb3QgPSB0dG1faW9fcHJvdChz
cmMsIHNyYy0+cmVzb3VyY2UsIFBBR0VfS0VSTkVMKTsKIAlkLmRpZmYgPSBkaWZmOwogCiAJZm9y
IChqID0gMDsgaiA8IGg7ICsraikgewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dm
eC92bXdnZnhfYm8uYyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2JvLmMKaW5kZXgg
NTBlNTI5YTAxNjc3Li4yNzY0N2Q3OWU5YmMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92
bXdnZngvdm13Z2Z4X2JvLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfYm8u
YwpAQCAtMTA3LDcgKzEwNyw3IEBAIGludCB2bXdfYm9fcGluX2luX3BsYWNlbWVudChzdHJ1Y3Qg
dm13X3ByaXZhdGUgKmRldl9wcml2LAogCQlnb3RvIGVycjsKIAogCWlmIChidWYtPmJhc2UucGlu
X2NvdW50ID4gMCkKLQkJcmV0ID0gdHRtX2JvX21lbV9jb21wYXQocGxhY2VtZW50LCAmYm8tPm1l
bSwKKwkJcmV0ID0gdHRtX2JvX21lbV9jb21wYXQocGxhY2VtZW50LCBiby0+cmVzb3VyY2UsCiAJ
CQkJCSZuZXdfZmxhZ3MpID09IHRydWUgPyAwIDogLUVJTlZBTDsKIAllbHNlCiAJCXJldCA9IHR0
bV9ib192YWxpZGF0ZShibywgcGxhY2VtZW50LCAmY3R4KTsKQEAgLTE1NSw3ICsxNTUsNyBAQCBp
bnQgdm13X2JvX3Bpbl9pbl92cmFtX29yX2dtcihzdHJ1Y3Qgdm13X3ByaXZhdGUgKmRldl9wcml2
LAogCQlnb3RvIGVycjsKIAogCWlmIChidWYtPmJhc2UucGluX2NvdW50ID4gMCkgewotCQlyZXQg
PSB0dG1fYm9fbWVtX2NvbXBhdCgmdm13X3ZyYW1fZ21yX3BsYWNlbWVudCwgJmJvLT5tZW0sCisJ
CXJldCA9IHR0bV9ib19tZW1fY29tcGF0KCZ2bXdfdnJhbV9nbXJfcGxhY2VtZW50LCBiby0+cmVz
b3VyY2UsCiAJCQkJCSZuZXdfZmxhZ3MpID09IHRydWUgPyAwIDogLUVJTlZBTDsKIAkJZ290byBv
dXRfdW5yZXNlcnZlOwogCX0KQEAgLTIyMiw3ICsyMjIsNyBAQCBpbnQgdm13X2JvX3Bpbl9pbl9z
dGFydF9vZl92cmFtKHN0cnVjdCB2bXdfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJdWludDMyX3QgbmV3
X2ZsYWdzOwogCiAJcGxhY2UgPSB2bXdfdnJhbV9wbGFjZW1lbnQucGxhY2VtZW50WzBdOwotCXBs
YWNlLmxwZm4gPSBiby0+bWVtLm51bV9wYWdlczsKKwlwbGFjZS5scGZuID0gYm8tPnJlc291cmNl
LT5udW1fcGFnZXM7CiAJcGxhY2VtZW50Lm51bV9wbGFjZW1lbnQgPSAxOwogCXBsYWNlbWVudC5w
bGFjZW1lbnQgPSAmcGxhY2U7CiAJcGxhY2VtZW50Lm51bV9idXN5X3BsYWNlbWVudCA9IDE7CkBA
IC0yNDIsMjIgKzI0MiwyMiBAQCBpbnQgdm13X2JvX3Bpbl9pbl9zdGFydF9vZl92cmFtKHN0cnVj
dCB2bXdfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJICogSW4gdGhhdCBjYXNlLCBldmljdCBpdCBmaXJz
dCBiZWNhdXNlIFRUTSBpc24ndCBnb29kIGF0IGhhbmRsaW5nCiAJICogdGhhdCBzaXR1YXRpb24u
CiAJICovCi0JaWYgKGJvLT5tZW0ubWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0gJiYKLQkgICAgYm8t
Pm1lbS5zdGFydCA8IGJvLT5tZW0ubnVtX3BhZ2VzICYmCi0JICAgIGJvLT5tZW0uc3RhcnQgPiAw
ICYmCisJaWYgKGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0gJiYKKwkgICAg
Ym8tPnJlc291cmNlLT5zdGFydCA8IGJvLT5yZXNvdXJjZS0+bnVtX3BhZ2VzICYmCisJICAgIGJv
LT5yZXNvdXJjZS0+c3RhcnQgPiAwICYmCiAJICAgIGJ1Zi0+YmFzZS5waW5fY291bnQgPT0gMCkg
ewogCQljdHguaW50ZXJydXB0aWJsZSA9IGZhbHNlOwogCQkodm9pZCkgdHRtX2JvX3ZhbGlkYXRl
KGJvLCAmdm13X3N5c19wbGFjZW1lbnQsICZjdHgpOwogCX0KIAogCWlmIChidWYtPmJhc2UucGlu
X2NvdW50ID4gMCkKLQkJcmV0ID0gdHRtX2JvX21lbV9jb21wYXQoJnBsYWNlbWVudCwgJmJvLT5t
ZW0sCisJCXJldCA9IHR0bV9ib19tZW1fY29tcGF0KCZwbGFjZW1lbnQsIGJvLT5yZXNvdXJjZSwK
IAkJCQkJJm5ld19mbGFncykgPT0gdHJ1ZSA/IDAgOiAtRUlOVkFMOwogCWVsc2UKIAkJcmV0ID0g
dHRtX2JvX3ZhbGlkYXRlKGJvLCAmcGxhY2VtZW50LCAmY3R4KTsKIAogCS8qIEZvciBzb21lIHJl
YXNvbiB3ZSBkaWRuJ3QgZW5kIHVwIGF0IHRoZSBzdGFydCBvZiB2cmFtICovCi0JV0FSTl9PTihy
ZXQgPT0gMCAmJiBiby0+bWVtLnN0YXJ0ICE9IDApOworCVdBUk5fT04ocmV0ID09IDAgJiYgYm8t
PnJlc291cmNlLT5zdGFydCAhPSAwKTsKIAlpZiAoIXJldCkKIAkJdm13X2JvX3Bpbl9yZXNlcnZl
ZChidWYsIHRydWUpOwogCkBAIC0zMTQsMTEgKzMxNCwxMSBAQCBpbnQgdm13X2JvX3VucGluKHN0
cnVjdCB2bXdfcHJpdmF0ZSAqZGV2X3ByaXYsCiB2b2lkIHZtd19ib19nZXRfZ3Vlc3RfcHRyKGNv
bnN0IHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJCQkgIFNWR0FHdWVzdFB0ciAqcHRy
KQogewotCWlmIChiby0+bWVtLm1lbV90eXBlID09IFRUTV9QTF9WUkFNKSB7CisJaWYgKGJvLT5y
ZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0pIHsKIAkJcHRyLT5nbXJJZCA9IFNWR0Ff
R01SX0ZSQU1FQlVGRkVSOwotCQlwdHItPm9mZnNldCA9IGJvLT5tZW0uc3RhcnQgPDwgUEFHRV9T
SElGVDsKKwkJcHRyLT5vZmZzZXQgPSBiby0+cmVzb3VyY2UtPnN0YXJ0IDw8IFBBR0VfU0hJRlQ7
CiAJfSBlbHNlIHsKLQkJcHRyLT5nbXJJZCA9IGJvLT5tZW0uc3RhcnQ7CisJCXB0ci0+Z21ySWQg
PSBiby0+cmVzb3VyY2UtPnN0YXJ0OwogCQlwdHItPm9mZnNldCA9IDA7CiAJfQogfQpAQCAtMzM3
LDcgKzMzNyw3IEBAIHZvaWQgdm13X2JvX3Bpbl9yZXNlcnZlZChzdHJ1Y3Qgdm13X2J1ZmZlcl9v
YmplY3QgKnZibywgYm9vbCBwaW4pCiAJc3RydWN0IHR0bV9wbGFjZSBwbDsKIAlzdHJ1Y3QgdHRt
X3BsYWNlbWVudCBwbGFjZW1lbnQ7CiAJc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibyA9ICZ2
Ym8tPmJhc2U7Ci0JdWludDMyX3Qgb2xkX21lbV90eXBlID0gYm8tPm1lbS5tZW1fdHlwZTsKKwl1
aW50MzJfdCBvbGRfbWVtX3R5cGUgPSBiby0+cmVzb3VyY2UtPm1lbV90eXBlOwogCWludCByZXQ7
CiAKIAlkbWFfcmVzdl9hc3NlcnRfaGVsZChiby0+YmFzZS5yZXN2KTsKQEAgLTM0Nyw4ICszNDcs
OCBAQCB2b2lkIHZtd19ib19waW5fcmVzZXJ2ZWQoc3RydWN0IHZtd19idWZmZXJfb2JqZWN0ICp2
Ym8sIGJvb2wgcGluKQogCiAJcGwuZnBmbiA9IDA7CiAJcGwubHBmbiA9IDA7Ci0JcGwubWVtX3R5
cGUgPSBiby0+bWVtLm1lbV90eXBlOwotCXBsLmZsYWdzID0gYm8tPm1lbS5wbGFjZW1lbnQ7CisJ
cGwubWVtX3R5cGUgPSBiby0+cmVzb3VyY2UtPm1lbV90eXBlOworCXBsLmZsYWdzID0gYm8tPnJl
c291cmNlLT5wbGFjZW1lbnQ7CiAKIAltZW1zZXQoJnBsYWNlbWVudCwgMCwgc2l6ZW9mKHBsYWNl
bWVudCkpOwogCXBsYWNlbWVudC5udW1fcGxhY2VtZW50ID0gMTsKQEAgLTM1Niw3ICszNTYsNyBA
QCB2b2lkIHZtd19ib19waW5fcmVzZXJ2ZWQoc3RydWN0IHZtd19idWZmZXJfb2JqZWN0ICp2Ym8s
IGJvb2wgcGluKQogCiAJcmV0ID0gdHRtX2JvX3ZhbGlkYXRlKGJvLCAmcGxhY2VtZW50LCAmY3R4
KTsKIAotCUJVR19PTihyZXQgIT0gMCB8fCBiby0+bWVtLm1lbV90eXBlICE9IG9sZF9tZW1fdHlw
ZSk7CisJQlVHX09OKHJldCAhPSAwIHx8IGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgIT0gb2xkX21l
bV90eXBlKTsKIAogCWlmIChwaW4pCiAJCXR0bV9ib19waW4oYm8pOwpAQCAtMzkwLDcgKzM5MCw3
IEBAIHZvaWQgKnZtd19ib19tYXBfYW5kX2NhY2hlKHN0cnVjdCB2bXdfYnVmZmVyX29iamVjdCAq
dmJvKQogCWlmICh2aXJ0dWFsKQogCQlyZXR1cm4gdmlydHVhbDsKIAotCXJldCA9IHR0bV9ib19r
bWFwKGJvLCAwLCBiby0+bWVtLm51bV9wYWdlcywgJnZiby0+bWFwKTsKKwlyZXQgPSB0dG1fYm9f
a21hcChibywgMCwgYm8tPnJlc291cmNlLT5udW1fcGFnZXMsICZ2Ym8tPm1hcCk7CiAJaWYgKHJl
dCkKIAkJRFJNX0VSUk9SKCJCdWZmZXIgb2JqZWN0IG1hcCBmYWlsZWQ6ICVkLlxuIiwgcmV0KTsK
IApAQCAtMTIxOCw3ICsxMjE4LDcgQEAgdm9pZCB2bXdfYm9fbW92ZV9ub3RpZnkoc3RydWN0IHR0
bV9idWZmZXJfb2JqZWN0ICpibywKIAkgKiBXaXRoIG90aGVyIHR5cGVzIG9mIG1vdmVzLCB0aGUg
dW5kZXJseWluZyBwYWdlcyBzdGF5IHRoZSBzYW1lLAogCSAqIGFuZCB0aGUgbWFwIGNhbiBiZSBr
ZXB0LgogCSAqLwotCWlmIChtZW0tPm1lbV90eXBlID09IFRUTV9QTF9WUkFNIHx8IGJvLT5tZW0u
bWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0pCisJaWYgKG1lbS0+bWVtX3R5cGUgPT0gVFRNX1BMX1ZS
QU0gfHwgYm8tPnJlc291cmNlLT5tZW1fdHlwZSA9PSBUVE1fUExfVlJBTSkKIAkJdm13X2JvX3Vu
bWFwKHZibyk7CiAKIAkvKgpAQCAtMTIyNiw2ICsxMjI2LDYgQEAgdm9pZCB2bXdfYm9fbW92ZV9u
b3RpZnkoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAkgKiByZWFkIGJhY2sgYWxsIHJl
c291cmNlIGNvbnRlbnQgZmlyc3QsIGFuZCB1bmJpbmQgdGhlIE1PQiBmcm9tCiAJICogdGhlIHJl
c291cmNlLgogCSAqLwotCWlmIChtZW0tPm1lbV90eXBlICE9IFZNV19QTF9NT0IgJiYgYm8tPm1l
bS5tZW1fdHlwZSA9PSBWTVdfUExfTU9CKQorCWlmIChtZW0tPm1lbV90eXBlICE9IFZNV19QTF9N
T0IgJiYgYm8tPnJlc291cmNlLT5tZW1fdHlwZSA9PSBWTVdfUExfTU9CKQogCQl2bXdfcmVzb3Vy
Y2VfdW5iaW5kX2xpc3QodmJvKTsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdn
Zngvdm13Z2Z4X2NtZC5jIGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfY21kLmMKaW5k
ZXggMjAyNDZhN2M5N2M5Li4wNjEzNDMwNWFmMTEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS92bXdnZngvdm13Z2Z4X2NtZC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4
X2NtZC5jCkBAIC02MDAsMTEgKzYwMCwxMSBAQCBzdGF0aWMgaW50IHZtd19maWZvX2VtaXRfZHVt
bXlfbGVnYWN5X3F1ZXJ5KHN0cnVjdCB2bXdfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJY21kLT5ib2R5
LmNpZCA9IGNpZDsKIAljbWQtPmJvZHkudHlwZSA9IFNWR0EzRF9RVUVSWVRZUEVfT0NDTFVTSU9O
OwogCi0JaWYgKGJvLT5tZW0ubWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0pIHsKKwlpZiAoYm8tPnJl
c291cmNlLT5tZW1fdHlwZSA9PSBUVE1fUExfVlJBTSkgewogCQljbWQtPmJvZHkuZ3Vlc3RSZXN1
bHQuZ21ySWQgPSBTVkdBX0dNUl9GUkFNRUJVRkZFUjsKLQkJY21kLT5ib2R5Lmd1ZXN0UmVzdWx0
Lm9mZnNldCA9IGJvLT5tZW0uc3RhcnQgPDwgUEFHRV9TSElGVDsKKwkJY21kLT5ib2R5Lmd1ZXN0
UmVzdWx0Lm9mZnNldCA9IGJvLT5yZXNvdXJjZS0+c3RhcnQgPDwgUEFHRV9TSElGVDsKIAl9IGVs
c2UgewotCQljbWQtPmJvZHkuZ3Vlc3RSZXN1bHQuZ21ySWQgPSBiby0+bWVtLnN0YXJ0OworCQlj
bWQtPmJvZHkuZ3Vlc3RSZXN1bHQuZ21ySWQgPSBiby0+cmVzb3VyY2UtPnN0YXJ0OwogCQljbWQt
PmJvZHkuZ3Vlc3RSZXN1bHQub2Zmc2V0ID0gMDsKIAl9CiAKQEAgLTY0NSw4ICs2NDUsOCBAQCBz
dGF0aWMgaW50IHZtd19maWZvX2VtaXRfZHVtbXlfZ2JfcXVlcnkoc3RydWN0IHZtd19wcml2YXRl
ICpkZXZfcHJpdiwKIAljbWQtPmhlYWRlci5zaXplID0gc2l6ZW9mKGNtZC0+Ym9keSk7CiAJY21k
LT5ib2R5LmNpZCA9IGNpZDsKIAljbWQtPmJvZHkudHlwZSA9IFNWR0EzRF9RVUVSWVRZUEVfT0ND
TFVTSU9OOwotCUJVR19PTihiby0+bWVtLm1lbV90eXBlICE9IFZNV19QTF9NT0IpOwotCWNtZC0+
Ym9keS5tb2JpZCA9IGJvLT5tZW0uc3RhcnQ7CisJQlVHX09OKGJvLT5yZXNvdXJjZS0+bWVtX3R5
cGUgIT0gVk1XX1BMX01PQik7CisJY21kLT5ib2R5Lm1vYmlkID0gYm8tPnJlc291cmNlLT5zdGFy
dDsKIAljbWQtPmJvZHkub2Zmc2V0ID0gMDsKIAogCXZtd19jbWRfY29tbWl0KGRldl9wcml2LCBz
aXplb2YoKmNtZCkpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhf
Y21kYnVmLmMgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9jbWRidWYuYwppbmRleCAy
ZTIzZTUzN2NkZjUuLjk1ZDQ0MjM2MWIzMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Zt
d2dmeC92bXdnZnhfY21kYnVmLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhf
Y21kYnVmLmMKQEAgLTg4OSw3ICs4ODksNyBAQCBzdGF0aWMgaW50IHZtd19jbWRidWZfc3BhY2Vf
cG9vbChzdHJ1Y3Qgdm13X2NtZGJ1Zl9tYW4gKm1hbiwKIAloZWFkZXItPmNtZCA9IG1hbi0+bWFw
ICsgb2Zmc2V0OwogCWlmIChtYW4tPnVzaW5nX21vYikgewogCQljYl9oZHItPmZsYWdzID0gU1ZH
QV9DQl9GTEFHX01PQjsKLQkJY2JfaGRyLT5wdHIubW9iLm1vYmlkID0gbWFuLT5jbWRfc3BhY2Ut
Pm1lbS5zdGFydDsKKwkJY2JfaGRyLT5wdHIubW9iLm1vYmlkID0gbWFuLT5jbWRfc3BhY2UtPnJl
c291cmNlLT5zdGFydDsKIAkJY2JfaGRyLT5wdHIubW9iLm1vYk9mZnNldCA9IG9mZnNldDsKIAl9
IGVsc2UgewogCQljYl9oZHItPnB0ci5wYSA9ICh1NjQpbWFuLT5oYW5kbGUgKyAodTY0KW9mZnNl
dDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2NvbnRleHQuYyBi
L2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2NvbnRleHQuYwppbmRleCA0YTVhM2UyNDYy
MTYuLjQ3ODIzZmIzNzNmYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdn
ZnhfY29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2NvbnRleHQu
YwpAQCAtMzQ2LDcgKzM0Niw3IEBAIHN0YXRpYyBpbnQgdm13X2diX2NvbnRleHRfYmluZChzdHJ1
Y3Qgdm13X3Jlc291cmNlICpyZXMsCiAJfSAqY21kOwogCXN0cnVjdCB0dG1fYnVmZmVyX29iamVj
dCAqYm8gPSB2YWxfYnVmLT5ibzsKIAotCUJVR19PTihiby0+bWVtLm1lbV90eXBlICE9IFZNV19Q
TF9NT0IpOworCUJVR19PTihiby0+cmVzb3VyY2UtPm1lbV90eXBlICE9IFZNV19QTF9NT0IpOwog
CiAJY21kID0gVk1XX0NNRF9SRVNFUlZFKGRldl9wcml2LCBzaXplb2YoKmNtZCkpOwogCWlmICh1
bmxpa2VseShjbWQgPT0gTlVMTCkpCkBAIC0zNTUsNyArMzU1LDcgQEAgc3RhdGljIGludCB2bXdf
Z2JfY29udGV4dF9iaW5kKHN0cnVjdCB2bXdfcmVzb3VyY2UgKnJlcywKIAljbWQtPmhlYWRlci5p
ZCA9IFNWR0FfM0RfQ01EX0JJTkRfR0JfQ09OVEVYVDsKIAljbWQtPmhlYWRlci5zaXplID0gc2l6
ZW9mKGNtZC0+Ym9keSk7CiAJY21kLT5ib2R5LmNpZCA9IHJlcy0+aWQ7Ci0JY21kLT5ib2R5Lm1v
YmlkID0gYm8tPm1lbS5zdGFydDsKKwljbWQtPmJvZHkubW9iaWQgPSBiby0+cmVzb3VyY2UtPnN0
YXJ0OwogCWNtZC0+Ym9keS52YWxpZENvbnRlbnRzID0gcmVzLT5iYWNrdXBfZGlydHk7CiAJcmVz
LT5iYWNrdXBfZGlydHkgPSBmYWxzZTsKIAl2bXdfY21kX2NvbW1pdChkZXZfcHJpdiwgc2l6ZW9m
KCpjbWQpKTsKQEAgLTM4NSw3ICszODUsNyBAQCBzdGF0aWMgaW50IHZtd19nYl9jb250ZXh0X3Vu
YmluZChzdHJ1Y3Qgdm13X3Jlc291cmNlICpyZXMsCiAJdWludDhfdCAqY21kOwogCiAKLQlCVUdf
T04oYm8tPm1lbS5tZW1fdHlwZSAhPSBWTVdfUExfTU9CKTsKKwlCVUdfT04oYm8tPnJlc291cmNl
LT5tZW1fdHlwZSAhPSBWTVdfUExfTU9CKTsKIAogCW11dGV4X2xvY2soJmRldl9wcml2LT5iaW5k
aW5nX211dGV4KTsKIAl2bXdfYmluZGluZ19zdGF0ZV9zY3J1Yih1Y3R4LT5jYnMpOwpAQCAtNTEz
LDcgKzUxMyw3IEBAIHN0YXRpYyBpbnQgdm13X2R4X2NvbnRleHRfYmluZChzdHJ1Y3Qgdm13X3Jl
c291cmNlICpyZXMsCiAJfSAqY21kOwogCXN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8gPSB2
YWxfYnVmLT5ibzsKIAotCUJVR19PTihiby0+bWVtLm1lbV90eXBlICE9IFZNV19QTF9NT0IpOwor
CUJVR19PTihiby0+cmVzb3VyY2UtPm1lbV90eXBlICE9IFZNV19QTF9NT0IpOwogCiAJY21kID0g
Vk1XX0NNRF9SRVNFUlZFKGRldl9wcml2LCBzaXplb2YoKmNtZCkpOwogCWlmICh1bmxpa2VseShj
bWQgPT0gTlVMTCkpCkBAIC01MjIsNyArNTIyLDcgQEAgc3RhdGljIGludCB2bXdfZHhfY29udGV4
dF9iaW5kKHN0cnVjdCB2bXdfcmVzb3VyY2UgKnJlcywKIAljbWQtPmhlYWRlci5pZCA9IFNWR0Ff
M0RfQ01EX0RYX0JJTkRfQ09OVEVYVDsKIAljbWQtPmhlYWRlci5zaXplID0gc2l6ZW9mKGNtZC0+
Ym9keSk7CiAJY21kLT5ib2R5LmNpZCA9IHJlcy0+aWQ7Ci0JY21kLT5ib2R5Lm1vYmlkID0gYm8t
Pm1lbS5zdGFydDsKKwljbWQtPmJvZHkubW9iaWQgPSBiby0+cmVzb3VyY2UtPnN0YXJ0OwogCWNt
ZC0+Ym9keS52YWxpZENvbnRlbnRzID0gcmVzLT5iYWNrdXBfZGlydHk7CiAJcmVzLT5iYWNrdXBf
ZGlydHkgPSBmYWxzZTsKIAl2bXdfY21kX2NvbW1pdChkZXZfcHJpdiwgc2l6ZW9mKCpjbWQpKTsK
QEAgLTU5NCw3ICs1OTQsNyBAQCBzdGF0aWMgaW50IHZtd19keF9jb250ZXh0X3VuYmluZChzdHJ1
Y3Qgdm13X3Jlc291cmNlICpyZXMsCiAJdWludDhfdCAqY21kOwogCiAKLQlCVUdfT04oYm8tPm1l
bS5tZW1fdHlwZSAhPSBWTVdfUExfTU9CKTsKKwlCVUdfT04oYm8tPnJlc291cmNlLT5tZW1fdHlw
ZSAhPSBWTVdfUExfTU9CKTsKIAogCW11dGV4X2xvY2soJmRldl9wcml2LT5iaW5kaW5nX211dGV4
KTsKIAl2bXdfZHhfY29udGV4dF9zY3J1Yl9jb3RhYmxlcyhyZXMsIHJlYWRiYWNrKTsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2NvdGFibGUuYyBiL2RyaXZlcnMv
Z3B1L2RybS92bXdnZngvdm13Z2Z4X2NvdGFibGUuYwppbmRleCA0MjMyMWI5YzgxMjkuLjY2MDAw
MGEzN2U4ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfY290YWJs
ZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2NvdGFibGUuYwpAQCAtMTcz
LDcgKzE3Myw3IEBAIHN0YXRpYyBpbnQgdm13X2NvdGFibGVfdW5zY3J1YihzdHJ1Y3Qgdm13X3Jl
c291cmNlICpyZXMpCiAJCVNWR0EzZENtZERYU2V0Q09UYWJsZSBib2R5OwogCX0gKmNtZDsKIAot
CVdBUk5fT05fT05DRShiby0+bWVtLm1lbV90eXBlICE9IFZNV19QTF9NT0IpOworCVdBUk5fT05f
T05DRShiby0+cmVzb3VyY2UtPm1lbV90eXBlICE9IFZNV19QTF9NT0IpOwogCWRtYV9yZXN2X2Fz
c2VydF9oZWxkKGJvLT5iYXNlLnJlc3YpOwogCiAJY21kID0gVk1XX0NNRF9SRVNFUlZFKGRldl9w
cml2LCBzaXplb2YoKmNtZCkpOwpAQCAtMTgxLDEyICsxODEsMTIgQEAgc3RhdGljIGludCB2bXdf
Y290YWJsZV91bnNjcnViKHN0cnVjdCB2bXdfcmVzb3VyY2UgKnJlcykKIAkJcmV0dXJuIC1FTk9N
RU07CiAKIAlXQVJOX09OKHZjb3RibC0+Y3R4LT5pZCA9PSBTVkdBM0RfSU5WQUxJRF9JRCk7Ci0J
V0FSTl9PTihiby0+bWVtLm1lbV90eXBlICE9IFZNV19QTF9NT0IpOworCVdBUk5fT04oYm8tPnJl
c291cmNlLT5tZW1fdHlwZSAhPSBWTVdfUExfTU9CKTsKIAljbWQtPmhlYWRlci5pZCA9IFNWR0Ff
M0RfQ01EX0RYX1NFVF9DT1RBQkxFOwogCWNtZC0+aGVhZGVyLnNpemUgPSBzaXplb2YoY21kLT5i
b2R5KTsKIAljbWQtPmJvZHkuY2lkID0gdmNvdGJsLT5jdHgtPmlkOwogCWNtZC0+Ym9keS50eXBl
ID0gdmNvdGJsLT50eXBlOwotCWNtZC0+Ym9keS5tb2JpZCA9IGJvLT5tZW0uc3RhcnQ7CisJY21k
LT5ib2R5Lm1vYmlkID0gYm8tPnJlc291cmNlLT5zdGFydDsKIAljbWQtPmJvZHkudmFsaWRTaXpl
SW5CeXRlcyA9IHZjb3RibC0+c2l6ZV9yZWFkX2JhY2s7CiAKIAl2bXdfY21kX2NvbW1pdF9mbHVz
aChkZXZfcHJpdiwgc2l6ZW9mKCpjbWQpKTsKQEAgLTMxNSw3ICszMTUsNyBAQCBzdGF0aWMgaW50
IHZtd19jb3RhYmxlX3VuYmluZChzdHJ1Y3Qgdm13X3Jlc291cmNlICpyZXMsCiAJaWYgKCF2bXdf
cmVzb3VyY2VfbW9iX2F0dGFjaGVkKHJlcykpCiAJCXJldHVybiAwOwogCi0JV0FSTl9PTl9PTkNF
KGJvLT5tZW0ubWVtX3R5cGUgIT0gVk1XX1BMX01PQik7CisJV0FSTl9PTl9PTkNFKGJvLT5yZXNv
dXJjZS0+bWVtX3R5cGUgIT0gVk1XX1BMX01PQik7CiAJZG1hX3Jlc3ZfYXNzZXJ0X2hlbGQoYm8t
PmJhc2UucmVzdik7CiAKIAltdXRleF9sb2NrKCZkZXZfcHJpdi0+YmluZGluZ19tdXRleCk7CkBA
IC00MzEsNyArNDMxLDcgQEAgc3RhdGljIGludCB2bXdfY290YWJsZV9yZXNpemUoc3RydWN0IHZt
d19yZXNvdXJjZSAqcmVzLCBzaXplX3QgbmV3X3NpemUpCiAJICogRG8gYSBwYWdlIGJ5IHBhZ2Ug
Y29weSBvZiBDT1RhYmxlcy4gVGhpcyBlbGltaW5hdGVzIHNsb3cgdm1hcCgpcy4KIAkgKiBUaGlz
IHNob3VsZCByZWFsbHkgYmUgYSBUVE0gdXRpbGl0eS4KIAkgKi8KLQlmb3IgKGkgPSAwOyBpIDwg
b2xkX2JvLT5tZW0ubnVtX3BhZ2VzOyArK2kpIHsKKwlmb3IgKGkgPSAwOyBpIDwgb2xkX2JvLT5y
ZXNvdXJjZS0+bnVtX3BhZ2VzOyArK2kpIHsKIAkJYm9vbCBkdW1teTsKIAogCQlyZXQgPSB0dG1f
Ym9fa21hcChvbGRfYm8sIGksIDEsICZvbGRfbWFwKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS92bXdnZngvdm13Z2Z4X2V4ZWNidWYuYyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13
Z2Z4X2V4ZWNidWYuYwppbmRleCA3YTI0MTk2ZjkyYzMuLjQyZjM3NjU4MmUxNCAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfZXhlY2J1Zi5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS92bXdnZngvdm13Z2Z4X2V4ZWNidWYuYwpAQCAtNzM1LDcgKzczNSw3IEBAIHN0YXRp
YyBpbnQgdm13X3JlYmluZF9hbGxfZHhfcXVlcnkoc3RydWN0IHZtd19yZXNvdXJjZSAqY3R4X3Jl
cykKIAljbWQtPmhlYWRlci5pZCA9IFNWR0FfM0RfQ01EX0RYX0JJTkRfQUxMX1FVRVJZOwogCWNt
ZC0+aGVhZGVyLnNpemUgPSBzaXplb2YoY21kLT5ib2R5KTsKIAljbWQtPmJvZHkuY2lkID0gY3R4
X3Jlcy0+aWQ7Ci0JY21kLT5ib2R5Lm1vYmlkID0gZHhfcXVlcnlfbW9iLT5iYXNlLm1lbS5zdGFy
dDsKKwljbWQtPmJvZHkubW9iaWQgPSBkeF9xdWVyeV9tb2ItPmJhc2UucmVzb3VyY2UtPnN0YXJ0
OwogCXZtd19jbWRfY29tbWl0KGRldl9wcml2LCBzaXplb2YoKmNtZCkpOwogCiAJdm13X2NvbnRl
eHRfYmluZF9keF9xdWVyeShjdHhfcmVzLCBkeF9xdWVyeV9tb2IpOwpAQCAtMTA0Niw3ICsxMDQ2
LDcgQEAgc3RhdGljIGludCB2bXdfcXVlcnlfYm9fc3dpdGNoX3ByZXBhcmUoc3RydWN0IHZtd19w
cml2YXRlICpkZXZfcHJpdiwKIAogCWlmICh1bmxpa2VseShuZXdfcXVlcnlfYm8gIT0gc3dfY29u
dGV4dC0+Y3VyX3F1ZXJ5X2JvKSkgewogCi0JCWlmICh1bmxpa2VseShuZXdfcXVlcnlfYm8tPmJh
c2UubWVtLm51bV9wYWdlcyA+IDQpKSB7CisJCWlmICh1bmxpa2VseShuZXdfcXVlcnlfYm8tPmJh
c2UucmVzb3VyY2UtPm51bV9wYWdlcyA+IDQpKSB7CiAJCQlWTVdfREVCVUdfVVNFUigiUXVlcnkg
YnVmZmVyIHRvbyBsYXJnZS5cbiIpOwogCQkJcmV0dXJuIC1FSU5WQUw7CiAJCX0KQEAgLTM2OTgs
MTYgKzM2OTgsMTYgQEAgc3RhdGljIHZvaWQgdm13X2FwcGx5X3JlbG9jYXRpb25zKHN0cnVjdCB2
bXdfc3dfY29udGV4dCAqc3dfY29udGV4dCkKIAogCWxpc3RfZm9yX2VhY2hfZW50cnkocmVsb2Ms
ICZzd19jb250ZXh0LT5ib19yZWxvY2F0aW9ucywgaGVhZCkgewogCQlibyA9ICZyZWxvYy0+dmJv
LT5iYXNlOwotCQlzd2l0Y2ggKGJvLT5tZW0ubWVtX3R5cGUpIHsKKwkJc3dpdGNoIChiby0+cmVz
b3VyY2UtPm1lbV90eXBlKSB7CiAJCWNhc2UgVFRNX1BMX1ZSQU06Ci0JCQlyZWxvYy0+bG9jYXRp
b24tPm9mZnNldCArPSBiby0+bWVtLnN0YXJ0IDw8IFBBR0VfU0hJRlQ7CisJCQlyZWxvYy0+bG9j
YXRpb24tPm9mZnNldCArPSBiby0+cmVzb3VyY2UtPnN0YXJ0IDw8IFBBR0VfU0hJRlQ7CiAJCQly
ZWxvYy0+bG9jYXRpb24tPmdtcklkID0gU1ZHQV9HTVJfRlJBTUVCVUZGRVI7CiAJCQlicmVhazsK
IAkJY2FzZSBWTVdfUExfR01SOgotCQkJcmVsb2MtPmxvY2F0aW9uLT5nbXJJZCA9IGJvLT5tZW0u
c3RhcnQ7CisJCQlyZWxvYy0+bG9jYXRpb24tPmdtcklkID0gYm8tPnJlc291cmNlLT5zdGFydDsK
IAkJCWJyZWFrOwogCQljYXNlIFZNV19QTF9NT0I6Ci0JCQkqcmVsb2MtPm1vYl9sb2MgPSBiby0+
bWVtLnN0YXJ0OworCQkJKnJlbG9jLT5tb2JfbG9jID0gYm8tPnJlc291cmNlLT5zdGFydDsKIAkJ
CWJyZWFrOwogCQlkZWZhdWx0OgogCQkJQlVHKCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vdm13Z2Z4L3Ztd2dmeF9wYWdlX2RpcnR5LmMgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Zt
d2dmeF9wYWdlX2RpcnR5LmMKaW5kZXggNDVjOWM2YTdmMWQ2Li5lNWE5YTVjYmQwMWEgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3BhZ2VfZGlydHkuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9wYWdlX2RpcnR5LmMKQEAgLTIzMiw3ICsyMzIs
NyBAQCB2b2lkIHZtd19ib19kaXJ0eV91bm1hcChzdHJ1Y3Qgdm13X2J1ZmZlcl9vYmplY3QgKnZi
bywKIGludCB2bXdfYm9fZGlydHlfYWRkKHN0cnVjdCB2bXdfYnVmZmVyX29iamVjdCAqdmJvKQog
ewogCXN0cnVjdCB2bXdfYm9fZGlydHkgKmRpcnR5ID0gdmJvLT5kaXJ0eTsKLQlwZ29mZl90IG51
bV9wYWdlcyA9IHZiby0+YmFzZS5tZW0ubnVtX3BhZ2VzOworCXBnb2ZmX3QgbnVtX3BhZ2VzID0g
dmJvLT5iYXNlLnJlc291cmNlLT5udW1fcGFnZXM7CiAJc2l6ZV90IHNpemUsIGFjY19zaXplOwog
CWludCByZXQ7CiAJc3RhdGljIHN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0eCBjdHggPSB7CkBAIC00
MTMsNyArNDEzLDcgQEAgdm1fZmF1bHRfdCB2bXdfYm9fdm1fbWt3cml0ZShzdHJ1Y3Qgdm1fZmF1
bHQgKnZtZikKIAkJcmV0dXJuIHJldDsKIAogCXBhZ2Vfb2Zmc2V0ID0gdm1mLT5wZ29mZiAtIGRy
bV92bWFfbm9kZV9zdGFydCgmYm8tPmJhc2Uudm1hX25vZGUpOwotCWlmICh1bmxpa2VseShwYWdl
X29mZnNldCA+PSBiby0+bWVtLm51bV9wYWdlcykpIHsKKwlpZiAodW5saWtlbHkocGFnZV9vZmZz
ZXQgPj0gYm8tPnJlc291cmNlLT5udW1fcGFnZXMpKSB7CiAJCXJldCA9IFZNX0ZBVUxUX1NJR0JV
UzsKIAkJZ290byBvdXRfdW5sb2NrOwogCX0KQEAgLTQ1Niw3ICs0NTYsNyBAQCB2bV9mYXVsdF90
IHZtd19ib192bV9mYXVsdChzdHJ1Y3Qgdm1fZmF1bHQgKnZtZikKIAogCQlwYWdlX29mZnNldCA9
IHZtZi0+cGdvZmYgLQogCQkJZHJtX3ZtYV9ub2RlX3N0YXJ0KCZiby0+YmFzZS52bWFfbm9kZSk7
Ci0JCWlmIChwYWdlX29mZnNldCA+PSBiby0+bWVtLm51bV9wYWdlcyB8fAorCQlpZiAocGFnZV9v
ZmZzZXQgPj0gYm8tPnJlc291cmNlLT5udW1fcGFnZXMgfHwKIAkJICAgIHZtd19yZXNvdXJjZXNf
Y2xlYW4odmJvLCBwYWdlX29mZnNldCwKIAkJCQkJcGFnZV9vZmZzZXQgKyBQQUdFX1NJWkUsCiAJ
CQkJCSZhbGxvd2VkX3ByZWZhdWx0KSkgewpAQCAtNTI5LDcgKzUyOSw3IEBAIHZtX2ZhdWx0X3Qg
dm13X2JvX3ZtX2h1Z2VfZmF1bHQoc3RydWN0IHZtX2ZhdWx0ICp2bWYsCiAKIAkJcGFnZV9vZmZz
ZXQgPSB2bWYtPnBnb2ZmIC0KIAkJCWRybV92bWFfbm9kZV9zdGFydCgmYm8tPmJhc2Uudm1hX25v
ZGUpOwotCQlpZiAocGFnZV9vZmZzZXQgPj0gYm8tPm1lbS5udW1fcGFnZXMgfHwKKwkJaWYgKHBh
Z2Vfb2Zmc2V0ID49IGJvLT5yZXNvdXJjZS0+bnVtX3BhZ2VzIHx8CiAJCSAgICB2bXdfcmVzb3Vy
Y2VzX2NsZWFuKHZibywgcGFnZV9vZmZzZXQsCiAJCQkJCXBhZ2Vfb2Zmc2V0ICsgUEFHRV9TSVpF
LAogCQkJCQkmYWxsb3dlZF9wcmVmYXVsdCkpIHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS92bXdnZngvdm13Z2Z4X3NoYWRlci5jIGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhf
c2hhZGVyLmMKaW5kZXggYTBkYjA2NTY0MDEzLi4zMjA2NzQ0OTg4ZjkgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3NoYWRlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS92bXdnZngvdm13Z2Z4X3NoYWRlci5jCkBAIC0yNTQsNyArMjU0LDcgQEAgc3RhdGljIGludCB2
bXdfZ2Jfc2hhZGVyX2JpbmQoc3RydWN0IHZtd19yZXNvdXJjZSAqcmVzLAogCX0gKmNtZDsKIAlz
dHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvID0gdmFsX2J1Zi0+Ym87CiAKLQlCVUdfT04oYm8t
Pm1lbS5tZW1fdHlwZSAhPSBWTVdfUExfTU9CKTsKKwlCVUdfT04oYm8tPnJlc291cmNlLT5tZW1f
dHlwZSAhPSBWTVdfUExfTU9CKTsKIAogCWNtZCA9IFZNV19DTURfUkVTRVJWRShkZXZfcHJpdiwg
c2l6ZW9mKCpjbWQpKTsKIAlpZiAodW5saWtlbHkoY21kID09IE5VTEwpKQpAQCAtMjYzLDcgKzI2
Myw3IEBAIHN0YXRpYyBpbnQgdm13X2diX3NoYWRlcl9iaW5kKHN0cnVjdCB2bXdfcmVzb3VyY2Ug
KnJlcywKIAljbWQtPmhlYWRlci5pZCA9IFNWR0FfM0RfQ01EX0JJTkRfR0JfU0hBREVSOwogCWNt
ZC0+aGVhZGVyLnNpemUgPSBzaXplb2YoY21kLT5ib2R5KTsKIAljbWQtPmJvZHkuc2hpZCA9IHJl
cy0+aWQ7Ci0JY21kLT5ib2R5Lm1vYmlkID0gYm8tPm1lbS5zdGFydDsKKwljbWQtPmJvZHkubW9i
aWQgPSBiby0+cmVzb3VyY2UtPnN0YXJ0OwogCWNtZC0+Ym9keS5vZmZzZXRJbkJ5dGVzID0gcmVz
LT5iYWNrdXBfb2Zmc2V0OwogCXJlcy0+YmFja3VwX2RpcnR5ID0gZmFsc2U7CiAJdm13X2NtZF9j
b21taXQoZGV2X3ByaXYsIHNpemVvZigqY21kKSk7CkBAIC0yODIsNyArMjgyLDcgQEAgc3RhdGlj
IGludCB2bXdfZ2Jfc2hhZGVyX3VuYmluZChzdHJ1Y3Qgdm13X3Jlc291cmNlICpyZXMsCiAJfSAq
Y21kOwogCXN0cnVjdCB2bXdfZmVuY2Vfb2JqICpmZW5jZTsKIAotCUJVR19PTihyZXMtPmJhY2t1
cC0+YmFzZS5tZW0ubWVtX3R5cGUgIT0gVk1XX1BMX01PQik7CisJQlVHX09OKHJlcy0+YmFja3Vw
LT5iYXNlLnJlc291cmNlLT5tZW1fdHlwZSAhPSBWTVdfUExfTU9CKTsKIAogCWNtZCA9IFZNV19D
TURfUkVTRVJWRShkZXZfcHJpdiwgc2l6ZW9mKCpjbWQpKTsKIAlpZiAodW5saWtlbHkoY21kID09
IE5VTEwpKQpAQCAtNDAyLDcgKzQwMiw3IEBAIHN0YXRpYyBpbnQgdm13X2R4X3NoYWRlcl91bnNj
cnViKHN0cnVjdCB2bXdfcmVzb3VyY2UgKnJlcykKIAljbWQtPmhlYWRlci5zaXplID0gc2l6ZW9m
KGNtZC0+Ym9keSk7CiAJY21kLT5ib2R5LmNpZCA9IHNoYWRlci0+Y3R4LT5pZDsKIAljbWQtPmJv
ZHkuc2hpZCA9IHNoYWRlci0+aWQ7Ci0JY21kLT5ib2R5Lm1vYmlkID0gcmVzLT5iYWNrdXAtPmJh
c2UubWVtLnN0YXJ0OworCWNtZC0+Ym9keS5tb2JpZCA9IHJlcy0+YmFja3VwLT5iYXNlLnJlc291
cmNlLT5zdGFydDsKIAljbWQtPmJvZHkub2Zmc2V0SW5CeXRlcyA9IHJlcy0+YmFja3VwX29mZnNl
dDsKIAl2bXdfY21kX2NvbW1pdChkZXZfcHJpdiwgc2l6ZW9mKCpjbWQpKTsKIApAQCAtNDUwLDcg
KzQ1MCw3IEBAIHN0YXRpYyBpbnQgdm13X2R4X3NoYWRlcl9iaW5kKHN0cnVjdCB2bXdfcmVzb3Vy
Y2UgKnJlcywKIAlzdHJ1Y3Qgdm13X3ByaXZhdGUgKmRldl9wcml2ID0gcmVzLT5kZXZfcHJpdjsK
IAlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvID0gdmFsX2J1Zi0+Ym87CiAKLQlCVUdfT04o
Ym8tPm1lbS5tZW1fdHlwZSAhPSBWTVdfUExfTU9CKTsKKwlCVUdfT04oYm8tPnJlc291cmNlLT5t
ZW1fdHlwZSAhPSBWTVdfUExfTU9CKTsKIAltdXRleF9sb2NrKCZkZXZfcHJpdi0+YmluZGluZ19t
dXRleCk7CiAJdm13X2R4X3NoYWRlcl91bnNjcnViKHJlcyk7CiAJbXV0ZXhfdW5sb2NrKCZkZXZf
cHJpdi0+YmluZGluZ19tdXRleCk7CkBAIC01MTMsNyArNTEzLDcgQEAgc3RhdGljIGludCB2bXdf
ZHhfc2hhZGVyX3VuYmluZChzdHJ1Y3Qgdm13X3Jlc291cmNlICpyZXMsCiAJc3RydWN0IHZtd19m
ZW5jZV9vYmogKmZlbmNlOwogCWludCByZXQ7CiAKLQlCVUdfT04ocmVzLT5iYWNrdXAtPmJhc2Uu
bWVtLm1lbV90eXBlICE9IFZNV19QTF9NT0IpOworCUJVR19PTihyZXMtPmJhY2t1cC0+YmFzZS5y
ZXNvdXJjZS0+bWVtX3R5cGUgIT0gVk1XX1BMX01PQik7CiAKIAltdXRleF9sb2NrKCZkZXZfcHJp
di0+YmluZGluZ19tdXRleCk7CiAJcmV0ID0gdm13X2R4X3NoYWRlcl9zY3J1YihyZXMpOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfc3RyZWFtb3V0cHV0LmMgYi9k
cml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9zdHJlYW1vdXRwdXQuYwppbmRleCAxZGQwNDJh
MjBhNjYuLmM4ZWZhNGE2Yzk5NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92
bXdnZnhfc3RyZWFtb3V0cHV0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhf
c3RyZWFtb3V0cHV0LmMKQEAgLTEwNiw3ICsxMDYsNyBAQCBzdGF0aWMgaW50IHZtd19keF9zdHJl
YW1vdXRwdXRfdW5zY3J1YihzdHJ1Y3Qgdm13X3Jlc291cmNlICpyZXMpCiAJY21kLT5oZWFkZXIu
aWQgPSBTVkdBXzNEX0NNRF9EWF9CSU5EX1NUUkVBTU9VVFBVVDsKIAljbWQtPmhlYWRlci5zaXpl
ID0gc2l6ZW9mKGNtZC0+Ym9keSk7CiAJY21kLT5ib2R5LnNvaWQgPSBzby0+aWQ7Ci0JY21kLT5i
b2R5Lm1vYmlkID0gcmVzLT5iYWNrdXAtPmJhc2UubWVtLnN0YXJ0OworCWNtZC0+Ym9keS5tb2Jp
ZCA9IHJlcy0+YmFja3VwLT5iYXNlLnJlc291cmNlLT5zdGFydDsKIAljbWQtPmJvZHkub2Zmc2V0
SW5CeXRlcyA9IHJlcy0+YmFja3VwX29mZnNldDsKIAljbWQtPmJvZHkuc2l6ZUluQnl0ZXMgPSBz
by0+c2l6ZTsKIAl2bXdfY21kX2NvbW1pdChkZXZfcHJpdiwgc2l6ZW9mKCpjbWQpKTsKQEAgLTE0
Miw3ICsxNDIsNyBAQCBzdGF0aWMgaW50IHZtd19keF9zdHJlYW1vdXRwdXRfYmluZChzdHJ1Y3Qg
dm13X3Jlc291cmNlICpyZXMsCiAJc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibyA9IHZhbF9i
dWYtPmJvOwogCWludCByZXQ7CiAKLQlpZiAoV0FSTl9PTihiby0+bWVtLm1lbV90eXBlICE9IFZN
V19QTF9NT0IpKQorCWlmIChXQVJOX09OKGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgIT0gVk1XX1BM
X01PQikpCiAJCXJldHVybiAtRUlOVkFMOwogCiAJbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmJpbmRp
bmdfbXV0ZXgpOwpAQCAtMTk3LDcgKzE5Nyw3IEBAIHN0YXRpYyBpbnQgdm13X2R4X3N0cmVhbW91
dHB1dF91bmJpbmQoc3RydWN0IHZtd19yZXNvdXJjZSAqcmVzLCBib29sIHJlYWRiYWNrLAogCXN0
cnVjdCB2bXdfZmVuY2Vfb2JqICpmZW5jZTsKIAlpbnQgcmV0OwogCi0JaWYgKFdBUk5fT04ocmVz
LT5iYWNrdXAtPmJhc2UubWVtLm1lbV90eXBlICE9IFZNV19QTF9NT0IpKQorCWlmIChXQVJOX09O
KHJlcy0+YmFja3VwLT5iYXNlLnJlc291cmNlLT5tZW1fdHlwZSAhPSBWTVdfUExfTU9CKSkKIAkJ
cmV0dXJuIC1FSU5WQUw7CiAKIAltdXRleF9sb2NrKCZkZXZfcHJpdi0+YmluZGluZ19tdXRleCk7
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9zdXJmYWNlLmMgYi9k
cml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9zdXJmYWNlLmMKaW5kZXggYzNlNTVjMTM3NmVi
Li5jOTAzMmIxMzQzNjUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4
X3N1cmZhY2UuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9zdXJmYWNlLmMK
QEAgLTEyMTgsNyArMTIxOCw3IEBAIHN0YXRpYyBpbnQgdm13X2diX3N1cmZhY2VfYmluZChzdHJ1
Y3Qgdm13X3Jlc291cmNlICpyZXMsCiAJdWludDMyX3Qgc3VibWl0X3NpemU7CiAJc3RydWN0IHR0
bV9idWZmZXJfb2JqZWN0ICpibyA9IHZhbF9idWYtPmJvOwogCi0JQlVHX09OKGJvLT5tZW0ubWVt
X3R5cGUgIT0gVk1XX1BMX01PQik7CisJQlVHX09OKGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgIT0g
Vk1XX1BMX01PQik7CiAKIAlzdWJtaXRfc2l6ZSA9IHNpemVvZigqY21kMSkgKyAocmVzLT5iYWNr
dXBfZGlydHkgPyBzaXplb2YoKmNtZDIpIDogMCk7CiAKQEAgLTEyMjksNyArMTIyOSw3IEBAIHN0
YXRpYyBpbnQgdm13X2diX3N1cmZhY2VfYmluZChzdHJ1Y3Qgdm13X3Jlc291cmNlICpyZXMsCiAJ
Y21kMS0+aGVhZGVyLmlkID0gU1ZHQV8zRF9DTURfQklORF9HQl9TVVJGQUNFOwogCWNtZDEtPmhl
YWRlci5zaXplID0gc2l6ZW9mKGNtZDEtPmJvZHkpOwogCWNtZDEtPmJvZHkuc2lkID0gcmVzLT5p
ZDsKLQljbWQxLT5ib2R5Lm1vYmlkID0gYm8tPm1lbS5zdGFydDsKKwljbWQxLT5ib2R5Lm1vYmlk
ID0gYm8tPnJlc291cmNlLT5zdGFydDsKIAlpZiAocmVzLT5iYWNrdXBfZGlydHkpIHsKIAkJY21k
MiA9ICh2b2lkICopICZjbWQxWzFdOwogCQljbWQyLT5oZWFkZXIuaWQgPSBTVkdBXzNEX0NNRF9V
UERBVEVfR0JfU1VSRkFDRTsKQEAgLTEyNzIsNyArMTI3Miw3IEBAIHN0YXRpYyBpbnQgdm13X2di
X3N1cmZhY2VfdW5iaW5kKHN0cnVjdCB2bXdfcmVzb3VyY2UgKnJlcywKIAl1aW50OF90ICpjbWQ7
CiAKIAotCUJVR19PTihiby0+bWVtLm1lbV90eXBlICE9IFZNV19QTF9NT0IpOworCUJVR19PTihi
by0+cmVzb3VyY2UtPm1lbV90eXBlICE9IFZNV19QTF9NT0IpOwogCiAJc3VibWl0X3NpemUgPSBz
aXplb2YoKmNtZDMpICsgKHJlYWRiYWNrID8gc2l6ZW9mKCpjbWQxKSA6IHNpemVvZigqY21kMikp
OwogCWNtZCA9IFZNV19DTURfUkVTRVJWRShkZXZfcHJpdiwgc3VibWl0X3NpemUpOwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfdHRtX2J1ZmZlci5jIGIvZHJpdmVy
cy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfdHRtX2J1ZmZlci5jCmluZGV4IDJkYzAzMWZlNGE5MC4u
YmIxZDQ1M2Y3Y2E2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF90
dG1fYnVmZmVyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfdHRtX2J1ZmZl
ci5jCkBAIC03MjQsNyArNzI0LDcgQEAgc3RhdGljIGludCB2bXdfbW92ZShzdHJ1Y3QgdHRtX2J1
ZmZlcl9vYmplY3QgKmJvLAogCQkgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqbmV3X21lbSwKIAkJ
ICAgIHN0cnVjdCB0dG1fcGxhY2UgKmhvcCkKIHsKLQlzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFn
ZXIgKm9sZF9tYW4gPSB0dG1fbWFuYWdlcl90eXBlKGJvLT5iZGV2LCBiby0+bWVtLm1lbV90eXBl
KTsKKwlzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm9sZF9tYW4gPSB0dG1fbWFuYWdlcl90
eXBlKGJvLT5iZGV2LCBiby0+cmVzb3VyY2UtPm1lbV90eXBlKTsKIAlzdHJ1Y3QgdHRtX3Jlc291
cmNlX21hbmFnZXIgKm5ld19tYW4gPSB0dG1fbWFuYWdlcl90eXBlKGJvLT5iZGV2LCBuZXdfbWVt
LT5tZW1fdHlwZSk7CiAJaW50IHJldDsKIApAQCAtNzM0LDEwICs3MzQsMTAgQEAgc3RhdGljIGlu
dCB2bXdfbW92ZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQkJcmV0dXJuIHJldDsK
IAl9CiAKLQl2bXdfbW92ZV9ub3RpZnkoYm8sICZiby0+bWVtLCBuZXdfbWVtKTsKKwl2bXdfbW92
ZV9ub3RpZnkoYm8sIGJvLT5yZXNvdXJjZSwgbmV3X21lbSk7CiAKIAlpZiAob2xkX21hbi0+dXNl
X3R0ICYmIG5ld19tYW4tPnVzZV90dCkgewotCQlpZiAoYm8tPm1lbS5tZW1fdHlwZSA9PSBUVE1f
UExfU1lTVEVNKSB7CisJCWlmIChiby0+cmVzb3VyY2UtPm1lbV90eXBlID09IFRUTV9QTF9TWVNU
RU0pIHsKIAkJCXR0bV9ib19hc3NpZ25fbWVtKGJvLCBuZXdfbWVtKTsKIAkJCXJldHVybiAwOwog
CQl9CkBAIC03NDYsNyArNzQ2LDcgQEAgc3RhdGljIGludCB2bXdfbW92ZShzdHJ1Y3QgdHRtX2J1
ZmZlcl9vYmplY3QgKmJvLAogCQkJZ290byBmYWlsOwogCiAJCXZtd190dG1fdW5iaW5kKGJvLT5i
ZGV2LCBiby0+dHRtKTsKLQkJdHRtX3Jlc291cmNlX2ZyZWUoYm8sICZiby0+bWVtKTsKKwkJdHRt
X3Jlc291cmNlX2ZyZWUoYm8sIGJvLT5yZXNvdXJjZSk7CiAJCXR0bV9ib19hc3NpZ25fbWVtKGJv
LCBuZXdfbWVtKTsKIAkJcmV0dXJuIDA7CiAJfSBlbHNlIHsKQEAgLTc1Niw3ICs3NTYsNyBAQCBz
dGF0aWMgaW50IHZtd19tb3ZlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJfQogCXJl
dHVybiAwOwogZmFpbDoKLQl2bXdfbW92ZV9ub3RpZnkoYm8sIG5ld19tZW0sICZiby0+bWVtKTsK
Kwl2bXdfbW92ZV9ub3RpZnkoYm8sIG5ld19tZW0sIGJvLT5yZXNvdXJjZSk7CiAJcmV0dXJuIHJl
dDsKIH0KIApkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19hcGkuaCBiL2luY2x1
ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmgKaW5kZXggMTY3YzEzMmJhMWMyLi5kMGQyODk5MWI1Mjkg
MTAwNjQ0Ci0tLSBhL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmgKKysrIGIvaW5jbHVkZS9k
cm0vdHRtL3R0bV9ib19hcGkuaApAQCAtMTM1LDcgKzEzNSw4IEBAIHN0cnVjdCB0dG1fYnVmZmVy
X29iamVjdCB7CiAJICogTWVtYmVycyBwcm90ZWN0ZWQgYnkgdGhlIGJvOjpyZXN2OjpyZXNlcnZl
ZCBsb2NrLgogCSAqLwogCi0Jc3RydWN0IHR0bV9yZXNvdXJjZSBtZW07CisJc3RydWN0IHR0bV9y
ZXNvdXJjZSAqcmVzb3VyY2U7CisJc3RydWN0IHR0bV9yZXNvdXJjZSBfbWVtOwogCXN0cnVjdCB0
dG1fdHQgKnR0bTsKIAlib29sIGRlbGV0ZWQ7CiAKZGlmZiAtLWdpdCBhL2luY2x1ZGUvZHJtL3R0
bS90dG1fYm9fZHJpdmVyLmggYi9pbmNsdWRlL2RybS90dG0vdHRtX2JvX2RyaXZlci5oCmluZGV4
IGRiY2NhYzk1N2Y4Zi4uMWE5YmEwYjEzNjIyIDEwMDY0NAotLS0gYS9pbmNsdWRlL2RybS90dG0v
dHRtX2JvX2RyaXZlci5oCisrKyBiL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fZHJpdmVyLmgKQEAg
LTE4MSwxNCArMTgxLDE0IEBAIHN0YXRpYyBpbmxpbmUgdm9pZAogdHRtX2JvX21vdmVfdG9fbHJ1
X3RhaWxfdW5sb2NrZWQoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibykKIHsKIAlzcGluX2xv
Y2soJmJvLT5iZGV2LT5scnVfbG9jayk7Ci0JdHRtX2JvX21vdmVfdG9fbHJ1X3RhaWwoYm8sICZi
by0+bWVtLCBOVUxMKTsKKwl0dG1fYm9fbW92ZV90b19scnVfdGFpbChibywgYm8tPnJlc291cmNl
LCBOVUxMKTsKIAlzcGluX3VubG9jaygmYm8tPmJkZXYtPmxydV9sb2NrKTsKIH0KIAogc3RhdGlj
IGlubGluZSB2b2lkIHR0bV9ib19hc3NpZ25fbWVtKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAq
Ym8sCiAJCQkJICAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlICpuZXdfbWVtKQogewotCWJvLT5tZW0g
PSAqbmV3X21lbTsKKwliby0+X21lbSA9ICpuZXdfbWVtOwogCW5ld19tZW0tPm1tX25vZGUgPSBO
VUxMOwogfQogCkBAIC0yMDIsNyArMjAyLDcgQEAgc3RhdGljIGlubGluZSB2b2lkIHR0bV9ib19h
c3NpZ25fbWVtKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiBzdGF0aWMgaW5saW5lIHZv
aWQgdHRtX2JvX21vdmVfbnVsbChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQkJCSAg
ICBzdHJ1Y3QgdHRtX3Jlc291cmNlICpuZXdfbWVtKQogewotCXN0cnVjdCB0dG1fcmVzb3VyY2Ug
Km9sZF9tZW0gPSAmYm8tPm1lbTsKKwlzdHJ1Y3QgdHRtX3Jlc291cmNlICpvbGRfbWVtID0gYm8t
PnJlc291cmNlOwogCiAJV0FSTl9PTihvbGRfbWVtLT5tbV9ub2RlICE9IE5VTEwpOwogCXR0bV9i
b19hc3NpZ25fbWVtKGJvLCBuZXdfbWVtKTsKLS0gCjIuMjUuMQoKX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmkt
ZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
L21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVsCg==
