Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 55085B65F9
	for <lists+dri-devel@lfdr.de>; Wed, 18 Sep 2019 16:23:38 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B12906F4D5;
	Wed, 18 Sep 2019 14:23:21 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 85B426F3C0
 for <dri-devel@lists.freedesktop.org>; Wed, 18 Sep 2019 14:23:16 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 1670CB689;
 Wed, 18 Sep 2019 14:23:15 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: airlied@linux.ie, daniel@ffwll.ch, kraxel@redhat.com, sam@ravnborg.org,
 yc_chen@aspeedtech.com, corbet@lwn.net
Subject: [PATCH 11/11] drm/mgag200: Implement cursor buffer with struct
 drm_vram_buffer
Date: Wed, 18 Sep 2019 16:23:07 +0200
Message-Id: <20190918142307.27127-12-tzimmermann@suse.de>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190918142307.27127-1-tzimmermann@suse.de>
References: <20190918142307.27127-1-tzimmermann@suse.de>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Zimmermann <tzimmermann@suse.de>, dri-devel@lists.freedesktop.org,
 linux-doc@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIG5ldyBWUkFNIGJ1ZmZlciByZXBsYWNlcyBhbGwgR0VNIGJ1ZmZlciBvYmplY3RzIHRoYXQg
Y29udGFpbmVkIGN1cnNvcgppbWFnZXMuIFRoZSBidWZmZXIgbWFpbnRhaW5zIHRoZSBwcmV2aW91
c2x5IHJlc2VydmVkIG1lbW9yeSBhdCB0aGUgaGlnaAplbmQgb2YgdmlkZW8gUkFNLiBUaGUgdXBk
YXRlKCkgYW5kIHNldF9iYXNlKCkgbm93IHNlcnZlIGFzIGNhbGxiYWNrcyBmb3IKdGhlIFZSQU0g
YnVmZmVyLgoKU2lnbmVkLW9mZi1ieTogVGhvbWFzIFppbW1lcm1hbm4gPHR6aW1tZXJtYW5uQHN1
c2UuZGU+Ci0tLQogZHJpdmVycy9ncHUvZHJtL21nYWcyMDAvbWdhZzIwMF9jdXJzb3IuYyB8IDEy
NCArKysrKysrLS0tLS0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL21nYWcyMDAvbWdhZzIw
MF9kcnYuaCAgICB8ICAxNiArLS0KIDIgZmlsZXMgY2hhbmdlZCwgMzggaW5zZXJ0aW9ucygrKSwg
MTAyIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9tZ2FnMjAwL21n
YWcyMDBfY3Vyc29yLmMgYi9kcml2ZXJzL2dwdS9kcm0vbWdhZzIwMC9tZ2FnMjAwX2N1cnNvci5j
CmluZGV4IGFiM2RmZTZiZGQ5Mi4uNjUwMDEzZTQ4OGMyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vbWdhZzIwMC9tZ2FnMjAwX2N1cnNvci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9tZ2Fn
MjAwL21nYWcyMDBfY3Vyc29yLmMKQEAgLTEyLDkgKzEyLDEyIEBACiBzdGF0aWMgYm9vbCB3YXJu
X3RyYW5zcGFyZW50ID0gdHJ1ZTsKIHN0YXRpYyBib29sIHdhcm5fcGFsZXR0ZSA9IHRydWU7CiAK
LXN0YXRpYyBpbnQgbWdhZzIwMF9jdXJzb3JfdXBkYXRlKHN0cnVjdCBtZ2FfZGV2aWNlICptZGV2
LCB2b2lkICpkc3QsIHZvaWQgKnNyYywKLQkJCQkgdW5zaWduZWQgaW50IHdpZHRoLCB1bnNpZ25l
ZCBpbnQgaGVpZ2h0KQorc3RhdGljIGludCBtZ2FnMjAwX2N1cnNvcl92cmFtX2J1ZmZlcl91cGRh
dGUoc3RydWN0IGRybV92cmFtX2J1ZmZlciAqdmJ1ZiwKKwkJCQkJICAgICB2b2lkICpkc3QsIHZv
aWQgKnNyYywKKwkJCQkJICAgICB1bnNpZ25lZCBpbnQgd2lkdGgsCisJCQkJCSAgICAgdW5zaWdu
ZWQgaW50IGhlaWdodCkKIHsKKwlzdHJ1Y3QgbWdhX2RldmljZSAqbWRldiA9IGNvbnRhaW5lcl9v
Zih2YnVmLCBzdHJ1Y3QgbWdhX2RldmljZSwgY3Vyc29yKTsKIAlzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2ID0gbWRldi0+ZGV2OwogCXVuc2lnbmVkIGludCBpLCByb3csIGNvbDsKIAl1aW50MzJfdCBj
b2xvdXJfc2V0WzE2XTsKQEAgLTEwNyw4ICsxMTAsMTAgQEAgc3RhdGljIGludCBtZ2FnMjAwX2N1
cnNvcl91cGRhdGUoc3RydWN0IG1nYV9kZXZpY2UgKm1kZXYsIHZvaWQgKmRzdCwgdm9pZCAqc3Jj
LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgdm9pZCBtZ2FnMjAwX2N1cnNvcl9zZXRfYmFzZShz
dHJ1Y3QgbWdhX2RldmljZSAqbWRldiwgdTY0IGFkZHJlc3MpCitzdGF0aWMgdm9pZCBtZ2FnMjAw
X2N1cnNvcl92cmFtX2J1ZmZlcl9zZXRfYmFzZShzdHJ1Y3QgZHJtX3ZyYW1fYnVmZmVyICp2YnVm
LAorCQkJCQkJdTY0IGFkZHJlc3MpCiB7CisJc3RydWN0IG1nYV9kZXZpY2UgKm1kZXYgPSBjb250
YWluZXJfb2YodmJ1Ziwgc3RydWN0IG1nYV9kZXZpY2UsIGN1cnNvcik7CiAJdTggYWRkcmwgPSAo
YWRkcmVzcyA+PiAxMCkgJiAweGZmOwogCXU4IGFkZHJoID0gKGFkZHJlc3MgPj4gMTgpICYgMHgz
ZjsKIApAQCAtMTE3LDE2ICsxMjIsMjAgQEAgc3RhdGljIHZvaWQgbWdhZzIwMF9jdXJzb3Jfc2V0
X2Jhc2Uoc3RydWN0IG1nYV9kZXZpY2UgKm1kZXYsIHU2NCBhZGRyZXNzKQogCVdSRUdfREFDKE1H
QTEwNjRfQ1VSU09SX0JBU0VfQURSX0hJLCBhZGRyaCk7CiB9CiAKLXN0YXRpYyBpbnQgbWdhZzIw
MF9zaG93X2N1cnNvcihzdHJ1Y3QgbWdhX2RldmljZSAqbWRldiwgdm9pZCAqZHN0LCB2b2lkICpz
cmMsCi0JCQkgICAgICAgdW5zaWduZWQgaW50IHdpZHRoLCB1bnNpZ25lZCBpbnQgaGVpZ2h0LAot
CQkJICAgICAgIHU2NCBkc3RfZ3B1KQorc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fdnJhbV9idWZm
ZXJfZnVuY3MgbWdhZzIwMF9jdXJzb3JfdnJhbV9idWZmZXJfZnVuY3MgPSB7CisJLnVwZGF0ZSA9
IG1nYWcyMDBfY3Vyc29yX3ZyYW1fYnVmZmVyX3VwZGF0ZSwKKwkuc2V0X2Jhc2UgPSBtZ2FnMjAw
X2N1cnNvcl92cmFtX2J1ZmZlcl9zZXRfYmFzZQorfTsKKworc3RhdGljIGludCBtZ2FnMjAwX3No
b3dfY3Vyc29yKHN0cnVjdCBtZ2FfZGV2aWNlICptZGV2LCB2b2lkICpzcmMsCisJCQkgICAgICAg
dW5zaWduZWQgaW50IHdpZHRoLCB1bnNpZ25lZCBpbnQgaGVpZ2h0KQogewogCWludCByZXQ7CiAK
LQlyZXQgPSBtZ2FnMjAwX2N1cnNvcl91cGRhdGUobWRldiwgZHN0LCBzcmMsIHdpZHRoLCBoZWln
aHQpOworCXJldCA9IGRybV92cmFtX2J1ZmZlcl91cGRhdGUoJm1kZXYtPmN1cnNvciwgc3JjLCB3
aWR0aCwgaGVpZ2h0KTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwotCW1nYWcyMDBfY3Vyc29y
X3NldF9iYXNlKG1kZXYsIGRzdF9ncHUpOworCWRybV92cmFtX2J1ZmZlcl9zd2FwKCZtZGV2LT5j
dXJzb3IpOwogCiAJLyogQWRqdXN0IGN1cnNvciBjb250cm9sIHJlZ2lzdGVyIHRvIHR1cm4gb24g
dGhlIGN1cnNvciAqLwogCVdSRUdfREFDKE1HQTEwNjRfQ1VSU09SX0NUTCwgNCk7IC8qIDE2LWNv
bG91ciBwYWxsZXRpemVkIGN1cnNvciBtb2RlICovCkBAIC0xNDEsOSArMTUwLDYgQEAgc3RhdGlj
IHZvaWQgbWdhZzIwMF9oaWRlX2N1cnNvcihzdHJ1Y3QgbWdhX2RldmljZSAqbWRldikKIHsKIAlX
UkVHOChNR0FfQ1VSUE9TWEwsIDApOwogCVdSRUc4KE1HQV9DVVJQT1NYSCwgMCk7Ci0JaWYgKG1k
ZXYtPmN1cnNvci5waXhlbHNfY3VycmVudCkKLQkJZHJtX2dlbV92cmFtX3VucGluKG1kZXYtPmN1
cnNvci5waXhlbHNfY3VycmVudCk7Ci0JbWRldi0+Y3Vyc29yLnBpeGVsc19jdXJyZW50ID0gTlVM
TDsKIH0KIAogc3RhdGljIHZvaWQgbWdhZzIwMF9tb3ZlX2N1cnNvcihzdHJ1Y3QgbWdhX2Rldmlj
ZSAqbWRldiwgaW50IHgsIGludCB5KQpAQCAtMTY3LDU4ICsxNzMsMzkgQEAgc3RhdGljIHZvaWQg
bWdhZzIwMF9tb3ZlX2N1cnNvcihzdHJ1Y3QgbWdhX2RldmljZSAqbWRldiwgaW50IHgsIGludCB5
KQogaW50IG1nYWcyMDBfY3Vyc29yX2luaXQoc3RydWN0IG1nYV9kZXZpY2UgKm1kZXYpCiB7CiAJ
c3RydWN0IGRybV9kZXZpY2UgKmRldiA9IG1kZXYtPmRldjsKKwl1bnNpZ25lZCBsb25nIGJhc2Us
IGZyYW1lX3NpemUsIG5mcmFtZXMsIHNpemU7CisJaW50IHJldDsKIAotCS8qCi0JICogTWFrZSBz
bWFsbCBidWZmZXJzIHRvIHN0b3JlIGEgaGFyZHdhcmUgY3Vyc29yIChkb3VibGUKLQkgKiBidWZm
ZXJlZCBpY29uIHVwZGF0ZXMpCi0JICovCi0JbWRldi0+Y3Vyc29yLnBpeGVsc18xID0gZHJtX2dl
bV92cmFtX2NyZWF0ZShkZXYsICZkZXYtPnZyYW1fbW0tPmJkZXYsCi0JCQkJCQkgICAgcm91bmR1
cCg0OCo2NCwgUEFHRV9TSVpFKSwKLQkJCQkJCSAgICAwLCAwKTsKLQltZGV2LT5jdXJzb3IucGl4
ZWxzXzIgPSBkcm1fZ2VtX3ZyYW1fY3JlYXRlKGRldiwgJmRldi0+dnJhbV9tbS0+YmRldiwKLQkJ
CQkJCSAgICByb3VuZHVwKDQ4KjY0LCBQQUdFX1NJWkUpLAotCQkJCQkJICAgIDAsIDApOwotCWlm
IChJU19FUlIobWRldi0+Y3Vyc29yLnBpeGVsc18yKSB8fCBJU19FUlIobWRldi0+Y3Vyc29yLnBp
eGVsc18xKSkgewotCQltZGV2LT5jdXJzb3IucGl4ZWxzXzEgPSBOVUxMOwotCQltZGV2LT5jdXJz
b3IucGl4ZWxzXzIgPSBOVUxMOwotCQlkZXZfd2FybigmZGV2LT5wZGV2LT5kZXYsCi0JCQkiQ291
bGQgbm90IGFsbG9jYXRlIHNwYWNlIGZvciBjdXJzb3JzLiBOb3QgZG9pbmcgaGFyZHdhcmUgY3Vy
c29ycy5cbiIpOwotCX0KLQltZGV2LT5jdXJzb3IucGl4ZWxzX2N1cnJlbnQgPSBOVUxMOworCWJh
c2UgPSBtZGV2LT5tYy52cmFtX2Jhc2UgKyBkZXYtPnZyYW1fbW0tPnZyYW1fc2l6ZTsKKwlmcmFt
ZV9zaXplID0gcm91bmR1cCg2NCAqIDQ4LCAxMDI0KTsKKwluZnJhbWVzID0gMjsKKwlzaXplID0g
cm91bmR1cChmcmFtZV9zaXplICogbmZyYW1lcywgUEFHRV9TSVpFKTsKKworCXJldCA9IGRybV92
cmFtX2J1ZmZlcl9pbml0KCZtZGV2LT5jdXJzb3IsIGJhc2UsIHNpemUsIGZyYW1lX3NpemUsCisJ
CQkJICAgbmZyYW1lcywgJm1nYWcyMDBfY3Vyc29yX3ZyYW1fYnVmZmVyX2Z1bmNzKTsKKwlpZiAo
cmV0KQorCQlyZXR1cm4gcmV0OwogCiAJcmV0dXJuIDA7CiB9CiAKIHZvaWQgbWdhZzIwMF9jdXJz
b3JfZmluaShzdHJ1Y3QgbWdhX2RldmljZSAqbWRldikKLXsgfQoreworCWRybV92cmFtX2J1ZmZl
cl9jbGVhbnVwKCZtZGV2LT5jdXJzb3IpOworfQogCiBpbnQgbWdhZzIwMF9jcnRjX2N1cnNvcl9z
ZXQoc3RydWN0IGRybV9jcnRjICpjcnRjLCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdiwKIAkJ
CSAgICB1aW50MzJfdCBoYW5kbGUsIHVpbnQzMl90IHdpZHRoLCB1aW50MzJfdCBoZWlnaHQpCiB7
CiAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmRldjsKIAlzdHJ1Y3QgbWdhX2Rldmlj
ZSAqbWRldiA9IChzdHJ1Y3QgbWdhX2RldmljZSAqKWRldi0+ZGV2X3ByaXZhdGU7Ci0Jc3RydWN0
IGRybV9nZW1fdnJhbV9vYmplY3QgKnBpeGVsc18xID0gbWRldi0+Y3Vyc29yLnBpeGVsc18xOwot
CXN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpwaXhlbHNfMiA9IG1kZXYtPmN1cnNvci5waXhl
bHNfMjsKLQlzdHJ1Y3QgZHJtX2dlbV92cmFtX29iamVjdCAqcGl4ZWxzX2N1cnJlbnQgPSBtZGV2
LT5jdXJzb3IucGl4ZWxzX2N1cnJlbnQ7Ci0Jc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKnBp
eGVsc19uZXh0OwogCXN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqOwogCXN0cnVjdCBkcm1fZ2Vt
X3ZyYW1fb2JqZWN0ICpnYm8gPSBOVUxMOwogCWludCByZXQ7Ci0JdTggKnNyYywgKmRzdDsKLQlz
NjQgZ3B1X2FkZHI7Ci0JdTY0IGRzdF9ncHU7CisJdTggKnNyYzsKIAotCWlmICghcGl4ZWxzXzEg
fHwgIXBpeGVsc18yKSB7Ci0JCVdSRUc4KE1HQV9DVVJQT1NYTCwgMCk7Ci0JCVdSRUc4KE1HQV9D
VVJQT1NYSCwgMCk7CisJaWYgKCFtZGV2LT5jdXJzb3IubWVtKQogCQlyZXR1cm4gLUVOT1RTVVBQ
OyAvKiBEaWRuJ3QgYWxsb2NhdGUgc3BhY2UgZm9yIGN1cnNvcnMgKi8KLQl9Ci0KLQlpZiAoV0FS
Tl9PTihwaXhlbHNfY3VycmVudCAmJgotCQkgICAgcGl4ZWxzXzEgIT0gcGl4ZWxzX2N1cnJlbnQg
JiYKLQkJICAgIHBpeGVsc18yICE9IHBpeGVsc19jdXJyZW50KSkgewotCQlyZXR1cm4gLUVOT1RT
VVBQOyAvKiBpbmNvbnNpc3RlbnQgc3RhdGUgKi8KLQl9CiAKIAlpZiAoIWhhbmRsZSB8fCAhZmls
ZV9wcml2KSB7CiAJCW1nYWcyMDBfaGlkZV9jdXJzb3IobWRldik7CkBAIC0yMjYsMTYgKzIxMywx
MCBAQCBpbnQgbWdhZzIwMF9jcnRjX2N1cnNvcl9zZXQoc3RydWN0IGRybV9jcnRjICpjcnRjLCBz
dHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdiwKIAl9CiAKIAlpZiAod2lkdGggIT0gNjQgfHwgaGVp
Z2h0ICE9IDY0KSB7Ci0JCVdSRUc4KE1HQV9DVVJQT1NYTCwgMCk7Ci0JCVdSRUc4KE1HQV9DVVJQ
T1NYSCwgMCk7CisJCW1nYWcyMDBfaGlkZV9jdXJzb3IobWRldik7CiAJCXJldHVybiAtRUlOVkFM
OwogCX0KIAotCWlmIChwaXhlbHNfY3VycmVudCA9PSBwaXhlbHNfMSkKLQkJcGl4ZWxzX25leHQg
PSBwaXhlbHNfMjsKLQllbHNlCi0JCXBpeGVsc19uZXh0ID0gcGl4ZWxzXzE7Ci0KIAlvYmogPSBk
cm1fZ2VtX29iamVjdF9sb29rdXAoZmlsZV9wcml2LCBoYW5kbGUpOwogCWlmICghb2JqKQogCQly
ZXR1cm4gLUVOT0VOVDsKQEAgLTI0OCw0OCArMjI5LDE1IEBAIGludCBtZ2FnMjAwX2NydGNfY3Vy
c29yX3NldChzdHJ1Y3QgZHJtX2NydGMgKmNydGMsIHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wcml2
LAogCQlnb3RvIGVycl9kcm1fZ2VtX29iamVjdF9wdXRfdW5sb2NrZWQ7CiAJfQogCi0JLyogUGlu
IGFuZCBtYXAgdXAtY29taW5nIGJ1ZmZlciB0byB3cml0ZSBjb2xvdXIgaW5kaWNlcyAqLwotCXJl
dCA9IGRybV9nZW1fdnJhbV9waW4ocGl4ZWxzX25leHQsIERSTV9HRU1fVlJBTV9QTF9GTEFHX1ZS
QU0pOwotCWlmIChyZXQpIHsKLQkJZGV2X2VycigmZGV2LT5wZGV2LT5kZXYsCi0JCQkiZmFpbGVk
IHRvIHBpbiBjdXJzb3IgYnVmZmVyOiAlZFxuIiwgcmV0KTsKLQkJZ290byBlcnJfZHJtX2dlbV92
cmFtX3Z1bm1hcDsKLQl9Ci0JZHN0ID0gZHJtX2dlbV92cmFtX2ttYXAocGl4ZWxzX25leHQsIHRy
dWUsIE5VTEwpOwotCWlmIChJU19FUlIoZHN0KSkgewotCQlyZXQgPSBQVFJfRVJSKGRzdCk7Ci0J
CWRldl9lcnIoJmRldi0+cGRldi0+ZGV2LAotCQkJImZhaWxlZCB0byBrbWFwIGN1cnNvciB1cGRh
dGVzOiAlZFxuIiwgcmV0KTsKLQkJZ290byBlcnJfZHJtX2dlbV92cmFtX3VucGluX2RzdDsKLQl9
Ci0JZ3B1X2FkZHIgPSBkcm1fZ2VtX3ZyYW1fb2Zmc2V0KHBpeGVsc19uZXh0KTsKLQlpZiAoZ3B1
X2FkZHIgPCAwKSB7Ci0JCXJldCA9IChpbnQpZ3B1X2FkZHI7Ci0JCWRldl9lcnIoJmRldi0+cGRl
di0+ZGV2LAotCQkJImZhaWxlZCB0byBnZXQgY3Vyc29yIHNjYW5vdXQgYWRkcmVzczogJWRcbiIs
IHJldCk7Ci0JCWdvdG8gZXJyX2RybV9nZW1fdnJhbV9rdW5tYXBfZHN0OwotCX0KLQlkc3RfZ3B1
ID0gKHU2NClncHVfYWRkcjsKLQotCXJldCA9IG1nYWcyMDBfc2hvd19jdXJzb3IobWRldiwgZHN0
LCBzcmMsIHdpZHRoLCBoZWlnaHQsIGRzdF9ncHUpOworCXJldCA9IG1nYWcyMDBfc2hvd19jdXJz
b3IobWRldiwgc3JjLCB3aWR0aCwgaGVpZ2h0KTsKIAlpZiAocmV0KQotCQlnb3RvIGVycl9kcm1f
Z2VtX3ZyYW1fa3VubWFwX2RzdDsKLQotCS8qIE5vdyB1cGRhdGUgaW50ZXJuYWwgYnVmZmVyIHBv
aW50ZXJzICovCi0JaWYgKHBpeGVsc19jdXJyZW50KQotCQlkcm1fZ2VtX3ZyYW1fdW5waW4ocGl4
ZWxzX2N1cnJlbnQpOwotCW1kZXYtPmN1cnNvci5waXhlbHNfY3VycmVudCA9IHBpeGVsc19uZXh0
OworCQlnb3RvIGVycl9kcm1fZ2VtX3ZyYW1fdnVubWFwOwogCi0JZHJtX2dlbV92cmFtX2t1bm1h
cChwaXhlbHNfbmV4dCk7CiAJZHJtX2dlbV92cmFtX3Z1bm1hcChnYm8sIHNyYyk7CiAJZHJtX2dl
bV9vYmplY3RfcHV0X3VubG9ja2VkKG9iaik7CiAKIAlyZXR1cm4gMDsKIAotZXJyX2RybV9nZW1f
dnJhbV9rdW5tYXBfZHN0OgotCWRybV9nZW1fdnJhbV9rdW5tYXAocGl4ZWxzX25leHQpOwotZXJy
X2RybV9nZW1fdnJhbV91bnBpbl9kc3Q6Ci0JZHJtX2dlbV92cmFtX3VucGluKHBpeGVsc19uZXh0
KTsKIGVycl9kcm1fZ2VtX3ZyYW1fdnVubWFwOgogCWRybV9nZW1fdnJhbV92dW5tYXAoZ2JvLCBz
cmMpOwogZXJyX2RybV9nZW1fb2JqZWN0X3B1dF91bmxvY2tlZDoKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9tZ2FnMjAwL21nYWcyMDBfZHJ2LmggYi9kcml2ZXJzL2dwdS9kcm0vbWdhZzIw
MC9tZ2FnMjAwX2Rydi5oCmluZGV4IDAxMjQzZmE2Mzk3Yy4uN2NlZDk4ZDYxYzIyIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vbWdhZzIwMC9tZ2FnMjAwX2Rydi5oCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9tZ2FnMjAwL21nYWcyMDBfZHJ2LmgKQEAgLTE5LDYgKzE5LDcgQEAKICNpbmNsdWRl
IDxkcm0vZHJtX2ZiX2hlbHBlci5oPgogI2luY2x1ZGUgPGRybS9kcm1fZ2VtLmg+CiAjaW5jbHVk
ZSA8ZHJtL2RybV9nZW1fdnJhbV9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3ZyYW1faGVs
cGVyLmg+CiAKICNpbmNsdWRlICJtZ2FnMjAwX3JlZy5oIgogCkBAIC0xMjgsMTkgKzEyOSw2IEBA
IHN0cnVjdCBtZ2FfY29ubmVjdG9yIHsKIAlzdHJ1Y3QgbWdhX2kyY19jaGFuICppMmM7CiB9Owog
Ci1zdHJ1Y3QgbWdhX2N1cnNvciB7Ci0JLyoKLQkgICBXZSBoYXZlIHRvIGhhdmUgMiBidWZmZXJz
IGZvciB0aGUgY3Vyc29yIHRvIGF2b2lkIG9jY2FzaW9uYWwKLQkgICBjb3JydXB0aW9uIHdoaWxl
IHN3aXRjaGluZyBjdXJzb3IgaWNvbnMuCi0JICAgSWYgZWl0aGVyIG9mIHRoZXNlIGlzIE5VTEws
IHRoZW4gZG9uJ3QgZG8gaGFyZHdhcmUgY3Vyc29ycywgYW5kCi0JICAgZmFsbCBiYWNrIHRvIHNv
ZnR3YXJlLgotCSovCi0Jc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKnBpeGVsc18xOwotCXN0
cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpwaXhlbHNfMjsKLQkvKiBUaGUgY3VycmVudGx5IGRp
c3BsYXllZCBpY29uLCB0aGlzIHBvaW50cyB0byBvbmUgb2YgcGl4ZWxzXzEsIG9yIHBpeGVsc18y
ICovCi0Jc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKnBpeGVsc19jdXJyZW50OwotfTsKLQog
c3RydWN0IG1nYV9tYyB7CiAJcmVzb3VyY2Vfc2l6ZV90CQkJdnJhbV9zaXplOwogCXJlc291cmNl
X3NpemVfdAkJCXZyYW1fYmFzZTsKQEAgLTE3MSw3ICsxNTksNyBAQCBzdHJ1Y3QgbWdhX2Rldmlj
ZSB7CiAJc3RydWN0IG1nYV9tYwkJCW1jOwogCXN0cnVjdCBtZ2FfbW9kZV9pbmZvCQltb2RlX2lu
Zm87CiAKLQlzdHJ1Y3QgbWdhX2N1cnNvciBjdXJzb3I7CisJc3RydWN0IGRybV92cmFtX2J1ZmZl
ciBjdXJzb3I7CiAKIAlib29sCQkJCXN1c3BlbmRlZDsKIAlpbnQJCQkJbnVtX2NydGM7Ci0tIAoy
LjIzLjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRy
aS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRw
czovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
