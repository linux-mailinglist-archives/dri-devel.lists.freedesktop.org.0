Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 12C14D7C03
	for <lists+dri-devel@lfdr.de>; Tue, 15 Oct 2019 18:39:23 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A41EF6E871;
	Tue, 15 Oct 2019 16:38:45 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from relay6-d.mail.gandi.net (relay6-d.mail.gandi.net
 [217.70.183.198])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3388E6E359
 for <dri-devel@lists.freedesktop.org>; Tue, 15 Oct 2019 10:45:06 +0000 (UTC)
X-Originating-IP: 2.224.242.101
Received: from uno.lan (2-224-242-101.ip172.fastwebnet.it [2.224.242.101])
 (Authenticated sender: jacopo@jmondi.org)
 by relay6-d.mail.gandi.net (Postfix) with ESMTPSA id C1AD5C0012;
 Tue, 15 Oct 2019 10:45:01 +0000 (UTC)
From: Jacopo Mondi <jacopo+renesas@jmondi.org>
To: laurent.pinchart@ideasonboard.com, kieran.bingham+renesas@ideasonboard.com,
 geert@linux-m68k.org, horms@verge.net.au, uli+renesas@fpond.eu,
 VenkataRajesh.Kalakodima@in.bosch.com
Subject: [PATCH v5 5/8] drm: rcar-du: crtc: Control CMM operations
Date: Tue, 15 Oct 2019 12:46:18 +0200
Message-Id: <20191015104621.62514-6-jacopo+renesas@jmondi.org>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191015104621.62514-1-jacopo+renesas@jmondi.org>
References: <20191015104621.62514-1-jacopo+renesas@jmondi.org>
MIME-Version: 1.0
X-Mailman-Approved-At: Tue, 15 Oct 2019 16:38:12 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: muroya@ksk.co.jp, airlied@linux.ie, koji.matsuoka.xm@renesas.com,
 dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org,
 linux-renesas-soc@vger.kernel.org, Jacopo Mondi <jacopo+renesas@jmondi.org>,
 seanpaul@chromium.org, Harsha.ManjulaMallikarjun@in.bosch.com,
 ezequiel@collabora.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW1wbGVtZW50IENNTSBoYW5kbGluZyBpbiB0aGUgY3J0YyBiZWdpbiBhbmQgZW5hYmxlIGF0b21p
YyBjYWxsYmFja3MsCmFuZCBlbmFibGUgQ01NIHVuaXQgdGhyb3VnaCB0aGUgRGlzcGxheSBFeHRl
bnNpb25hbCBGdW5jdGlvbnMKcmVnaXN0ZXIgYXQgZ3JvdXAgc2V0dXAgdGltZS4KClNpZ25lZC1v
ZmYtYnk6IEphY29wbyBNb25kaSA8amFjb3BvK3JlbmVzYXNAam1vbmRpLm9yZz4KLS0tCiBkcml2
ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X2NydGMuYyAgfCA3OSArKysrKysrKysrKysrKysr
KysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X2dyb3VwLmMgfCAgNSAr
KwogZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9yZWdzLmggIHwgIDUgKysKIDMgZmls
ZXMgY2hhbmdlZCwgODkgaW5zZXJ0aW9ucygrKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9yY2FyLWR1L3JjYXJfZHVfY3J0Yy5jIGIvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9k
dV9jcnRjLmMKaW5kZXggMjNmMWQ2Y2MxNzE5Li40YmM1MGEzZjRhMDAgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfY3J0Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9yY2FyLWR1L3JjYXJfZHVfY3J0Yy5jCkBAIC0yMSw2ICsyMSw3IEBACiAjaW5jbHVkZSA8ZHJt
L2RybV9wbGFuZV9oZWxwZXIuaD4KICNpbmNsdWRlIDxkcm0vZHJtX3ZibGFuay5oPgogCisjaW5j
bHVkZSAicmNhcl9jbW0uaCIKICNpbmNsdWRlICJyY2FyX2R1X2NydGMuaCIKICNpbmNsdWRlICJy
Y2FyX2R1X2Rydi5oIgogI2luY2x1ZGUgInJjYXJfZHVfZW5jb2Rlci5oIgpAQCAtNDc0LDYgKzQ3
NSw3MCBAQCBzdGF0aWMgdm9pZCByY2FyX2R1X2NydGNfd2FpdF9wYWdlX2ZsaXAoc3RydWN0IHJj
YXJfZHVfY3J0YyAqcmNydGMpCiAJcmNhcl9kdV9jcnRjX2ZpbmlzaF9wYWdlX2ZsaXAocmNydGMp
OwogfQogCisvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICogQ29sb3IgTWFuYWdlbWVudCBNb2R1
bGUgKENNTSkKKyAqLworc3RhdGljIGludCByY2FyX2R1X2NtbV9lbmFibGUoc3RydWN0IGRybV9j
cnRjICpjcnRjKQoreworCXN0cnVjdCByY2FyX2R1X2NydGMgKnJjcnRjID0gdG9fcmNhcl9jcnRj
KGNydGMpOworCisJaWYgKCFyY3J0Yy0+Y21tKQorCQlyZXR1cm4gMDsKKworCXJldHVybiByY2Fy
X2NtbV9lbmFibGUocmNydGMtPmNtbSk7Cit9CisKK3N0YXRpYyB2b2lkIHJjYXJfZHVfY21tX2Rp
c2FibGUoc3RydWN0IGRybV9jcnRjICpjcnRjKQoreworCXN0cnVjdCByY2FyX2R1X2NydGMgKnJj
cnRjID0gdG9fcmNhcl9jcnRjKGNydGMpOworCisJaWYgKCFyY3J0Yy0+Y21tKQorCQlyZXR1cm47
CisKKwlyY2FyX2NtbV9kaXNhYmxlKHJjcnRjLT5jbW0pOworfQorCitzdGF0aWMgaW50IHJjYXJf
ZHVfY21tX2NoZWNrKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKKwkJCSAgICAgc3RydWN0IGRybV9j
cnRjX3N0YXRlICpzdGF0ZSkKK3sKKwlzdHJ1Y3QgZHJtX3Byb3BlcnR5X2Jsb2IgKmRybV9sdXQg
PSBzdGF0ZS0+Z2FtbWFfbHV0OworCXN0cnVjdCByY2FyX2R1X2NydGMgKnJjcnRjID0gdG9fcmNh
cl9jcnRjKGNydGMpOworCXN0cnVjdCBkZXZpY2UgKmRldiA9IHJjcnRjLT5kZXYtPmRldjsKKwor
CWlmICghcmNydGMtPmNtbSB8fCAhZHJtX2x1dCkKKwkJcmV0dXJuIDA7CisKKwkvKiBXZSBvbmx5
IGFjY2VwdCBmdWxseSBwb3B1bGF0ZWQgTFVUIHRhYmxlcy4gKi8KKwlpZiAoQ00yX0xVVF9TSVpF
ICogc2l6ZW9mKHN0cnVjdCBkcm1fY29sb3JfbHV0KSAhPQorCSAgICBkcm1fbHV0LT5sZW5ndGgp
IHsKKwkJZGV2X2VycihkZXYsICJpbnZhbGlkIGdhbW1hIGx1dCBzaXplOiAlbHUgYnl0ZXNcbiIs
CisJCQlkcm1fbHV0LT5sZW5ndGgpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlyZXR1cm4g
MDsKK30KKworc3RhdGljIHZvaWQgcmNhcl9kdV9jbW1fc2V0dXAoc3RydWN0IGRybV9jcnRjICpj
cnRjKQoreworCXN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqZHJtX2x1dCA9IGNydGMtPnN0YXRl
LT5nYW1tYV9sdXQ7CisJc3RydWN0IHJjYXJfZHVfY3J0YyAqcmNydGMgPSB0b19yY2FyX2NydGMo
Y3J0Yyk7CisJc3RydWN0IHJjYXJfY21tX2NvbmZpZyBjbW1fY29uZmlnID0ge307CisKKwlpZiAo
IXJjcnRjLT5jbW0pCisJCXJldHVybjsKKworCWlmIChkcm1fbHV0KSB7CisJCWNtbV9jb25maWcu
bHV0LmVuYWJsZSA9IHRydWU7CisJCWNtbV9jb25maWcubHV0LnRhYmxlID0gKHN0cnVjdCBkcm1f
Y29sb3JfbHV0ICopZHJtX2x1dC0+ZGF0YTsKKworCX0gZWxzZSB7CisJCWNtbV9jb25maWcubHV0
LmVuYWJsZSA9IGZhbHNlOworCX0KKworCXJjYXJfY21tX3NldHVwKHJjcnRjLT5jbW0sICZjbW1f
Y29uZmlnKTsKK30KKwogLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAqIFN0YXJ0L1N0b3AgYW5k
IFN1c3BlbmQvUmVzdW1lCiAgKi8KQEAgLTYxOSw2ICs2ODQsOCBAQCBzdGF0aWMgdm9pZCByY2Fy
X2R1X2NydGNfc3RvcChzdHJ1Y3QgcmNhcl9kdV9jcnRjICpyY3J0YykKIAlpZiAocmNhcl9kdV9o
YXMocmNydGMtPmRldiwgUkNBUl9EVV9GRUFUVVJFX1ZTUDFfU09VUkNFKSkKIAkJcmNhcl9kdV92
c3BfZGlzYWJsZShyY3J0Yyk7CiAKKwlyY2FyX2R1X2NtbV9kaXNhYmxlKGNydGMpOworCiAJLyoK
IAkgKiBTZWxlY3Qgc3dpdGNoIHN5bmMgbW9kZS4gVGhpcyBzdG9wcyBkaXNwbGF5IG9wZXJhdGlv
biBhbmQgY29uZmlndXJlcwogCSAqIHRoZSBIU1lOQyBhbmQgVlNZTkMgc2lnbmFscyBhcyBpbnB1
dHMuCkBAIC02MzEsNiArNjk4LDcgQEAgc3RhdGljIHZvaWQgcmNhcl9kdV9jcnRjX3N0b3Aoc3Ry
dWN0IHJjYXJfZHVfY3J0YyAqcmNydGMpCiAJCQkJCSAgIERTWVNSX1RWTV9TV0lUQ0gpOwogCiAJ
cmNhcl9kdV9ncm91cF9zdGFydF9zdG9wKHJjcnRjLT5ncm91cCwgZmFsc2UpOworCiB9CiAKIC8q
IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tCkBAIC02NDIsNiArNzEwLDExIEBAIHN0YXRpYyBpbnQgcmNh
cl9kdV9jcnRjX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCiB7CiAJc3RydWN0
IHJjYXJfZHVfY3J0Y19zdGF0ZSAqcnN0YXRlID0gdG9fcmNhcl9jcnRjX3N0YXRlKHN0YXRlKTsK
IAlzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXI7CisJaW50IHJldDsKKworCXJldCA9IHJjYXJf
ZHVfY21tX2NoZWNrKGNydGMsIHN0YXRlKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OwogCiAJ
LyogU3RvcmUgdGhlIHJvdXRlcyBmcm9tIHRoZSBDUlRDIG91dHB1dCB0byB0aGUgRFUgb3V0cHV0
cy4gKi8KIAlyc3RhdGUtPm91dHB1dHMgPSAwOwpAQCAtNjY3LDYgKzc0MCw3IEBAIHN0YXRpYyB2
b2lkIHJjYXJfZHVfY3J0Y19hdG9taWNfZW5hYmxlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKIAlz
dHJ1Y3QgcmNhcl9kdV9jcnRjX3N0YXRlICpyc3RhdGUgPSB0b19yY2FyX2NydGNfc3RhdGUoY3J0
Yy0+c3RhdGUpOwogCXN0cnVjdCByY2FyX2R1X2RldmljZSAqcmNkdSA9IHJjcnRjLT5kZXY7CiAK
KwlyY2FyX2R1X2NtbV9lbmFibGUoY3J0Yyk7CiAJcmNhcl9kdV9jcnRjX2dldChyY3J0Yyk7CiAK
IAkvKgpAQCAtNjg2LDYgKzc2MCw3IEBAIHN0YXRpYyB2b2lkIHJjYXJfZHVfY3J0Y19hdG9taWNf
ZW5hYmxlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKIAl9CiAKIAlyY2FyX2R1X2NydGNfc3RhcnQo
cmNydGMpOworCXJjYXJfZHVfY21tX3NldHVwKGNydGMpOwogfQogCiBzdGF0aWMgdm9pZCByY2Fy
X2R1X2NydGNfYXRvbWljX2Rpc2FibGUoc3RydWN0IGRybV9jcnRjICpjcnRjLApAQCAtNzM5LDYg
KzgxNCwxMCBAQCBzdGF0aWMgdm9pZCByY2FyX2R1X2NydGNfYXRvbWljX2JlZ2luKHN0cnVjdCBk
cm1fY3J0YyAqY3J0YywKIAkgKi8KIAlyY2FyX2R1X2NydGNfZ2V0KHJjcnRjKTsKIAorCS8qIElm
IHRoZSBhY3RpdmUgc3RhdGUgY2hhbmdlZCwgd2UgbGV0IC5hdG9taWNfZW5hYmxlIGhhbmRsZSBD
TU0uICovCisJaWYgKGNydGMtPnN0YXRlLT5jb2xvcl9tZ210X2NoYW5nZWQgJiYgIWNydGMtPnN0
YXRlLT5hY3RpdmVfY2hhbmdlZCkKKwkJcmNhcl9kdV9jbW1fc2V0dXAoY3J0Yyk7CisKIAlpZiAo
cmNhcl9kdV9oYXMocmNydGMtPmRldiwgUkNBUl9EVV9GRUFUVVJFX1ZTUDFfU09VUkNFKSkKIAkJ
cmNhcl9kdV92c3BfYXRvbWljX2JlZ2luKHJjcnRjKTsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfZ3JvdXAuYyBiL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1
L3JjYXJfZHVfZ3JvdXAuYwppbmRleCA5ZWVlNDc5NjllNzcuLjU4M2RlODAwYTY2ZCAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9ncm91cC5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfZ3JvdXAuYwpAQCAtMTM1LDYgKzEzNSw3IEBAIHN0
YXRpYyB2b2lkIHJjYXJfZHVfZ3JvdXBfc2V0dXBfZGlkc3Ioc3RydWN0IHJjYXJfZHVfZ3JvdXAg
KnJncnApCiBzdGF0aWMgdm9pZCByY2FyX2R1X2dyb3VwX3NldHVwKHN0cnVjdCByY2FyX2R1X2dy
b3VwICpyZ3JwKQogewogCXN0cnVjdCByY2FyX2R1X2RldmljZSAqcmNkdSA9IHJncnAtPmRldjsK
Kwl1MzIgZGVmcjcgPSBERUZSN19DT0RFOwogCiAJLyogRW5hYmxlIGV4dGVuZGVkIGZlYXR1cmVz
ICovCiAJcmNhcl9kdV9ncm91cF93cml0ZShyZ3JwLCBERUZSLCBERUZSX0NPREUgfCBERUZSX0RF
RkUpOwpAQCAtMTQ3LDYgKzE0OCwxMCBAQCBzdGF0aWMgdm9pZCByY2FyX2R1X2dyb3VwX3NldHVw
KHN0cnVjdCByY2FyX2R1X2dyb3VwICpyZ3JwKQogCiAJcmNhcl9kdV9ncm91cF9zZXR1cF9waW5z
KHJncnApOwogCisJZGVmcjcgfD0gKHJncnAtPmNtbXNfbWFzayAmIEJJVCgxKSA/IERFRlI3X0NN
TUUxIDogMCkgfAorCQkgKHJncnAtPmNtbXNfbWFzayAmIEJJVCgwKSA/IERFRlI3X0NNTUUwIDog
MCk7CisJcmNhcl9kdV9ncm91cF93cml0ZShyZ3JwLCBERUZSNywgZGVmcjcpOworCiAJaWYgKHJj
ZHUtPmluZm8tPmdlbiA+PSAyKSB7CiAJCXJjYXJfZHVfZ3JvdXBfc2V0dXBfZGVmcjgocmdycCk7
CiAJCXJjYXJfZHVfZ3JvdXBfc2V0dXBfZGlkc3IocmdycCk7CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X3JlZ3MuaCBiL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1
L3JjYXJfZHVfcmVncy5oCmluZGV4IGJjODdmMDgwYjE3MC4uZmI5OTY0OTQ5MzY4IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X3JlZ3MuaAorKysgYi9kcml2ZXJz
L2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X3JlZ3MuaApAQCAtMTk3LDYgKzE5NywxMSBAQAogI2Rl
ZmluZSBERUZSNl9NTE9TMQkJKDEgPDwgMikKICNkZWZpbmUgREVGUjZfREVGQVVMVAkJKERFRlI2
X0NPREUgfCBERUZSNl9UQ05FMSkKIAorI2RlZmluZSBERUZSNwkJCTB4MDAwZWMKKyNkZWZpbmUg
REVGUjdfQ09ERQkJKDB4Nzc3OSA8PCAxNikKKyNkZWZpbmUgREVGUjdfQ01NRTEJCUJJVCg2KQor
I2RlZmluZSBERUZSN19DTU1FMAkJQklUKDQpCisKIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAg
KiBSOEE3NzkwLW9ubHkgQ29udHJvbCBSZWdpc3RlcnMKICAqLwotLSAKMi4yMy4wCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGlu
ZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
