Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 738EA97FA6
	for <lists+dri-devel@lfdr.de>; Wed, 21 Aug 2019 18:05:03 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9DC176E351;
	Wed, 21 Aug 2019 16:05:00 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x543.google.com (mail-ed1-x543.google.com
 [IPv6:2a00:1450:4864:20::543])
 by gabe.freedesktop.org (Postfix) with ESMTPS id EEFBF6E351
 for <dri-devel@lists.freedesktop.org>; Wed, 21 Aug 2019 16:04:58 +0000 (UTC)
Received: by mail-ed1-x543.google.com with SMTP id a21so3524106edt.11
 for <dri-devel@lists.freedesktop.org>; Wed, 21 Aug 2019 09:04:58 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:sender:date:from:to:cc:subject:message-id
 :references:mime-version:content-disposition
 :content-transfer-encoding:in-reply-to:user-agent;
 bh=PQJzaKCMOyJ9cU3DjRwvUQW5X0QqM3/O0kDiRQb5Fws=;
 b=bqgzfPCcasjpmZyrDaP3RiJPUzIntqleY91PKd7cu0CkuA8RZJJ3QO/8YXmb++8L4e
 ffILXEDY4f7qau5jk36NXPwh7T1FlyVGWW6u7x2B4ZtDE7lRB8cPuTNEyvPk5e/xqb/9
 iDwJJcnK8JDFlMd4wP13VbFrFK3Cu8rPt/VF4FvS58uUwfaVFRtt00Jciirj+dPl+U4j
 uGT/B7+BUAlTSTN6Ec90pId3e2jLZfePOUNqjv9yyo6UuTZYVF23OcSrWOu0pI/CZvix
 GGWGXg9wjD3BSO5fq8MyI+CxNHaygfOAKGTg8R/rCyANjqYJbMJ4qinNQK4hdmluCk1Z
 h1NQ==
X-Gm-Message-State: APjAAAVxDfx9lfpDcZmY0J3G1/SxpeBK0MA7Fk8AoZohy3nLaLrHeQ2L
 ZPLYX82r/JsSCnR4ygNl7XUZEyvpqukE7A==
X-Google-Smtp-Source: APXvYqzfBlG84lxHLAw426uNJramGTgcjxmP98IF3UpKL+sGMYXE31acDeKoLVmTgmziF7MVHCmc4g==
X-Received: by 2002:a17:906:254f:: with SMTP id
 j15mr31543641ejb.69.1566403497424; 
 Wed, 21 Aug 2019 09:04:57 -0700 (PDT)
Received: from phenom.ffwll.local (212-51-149-96.fiber7.init7.net.
 [212.51.149.96])
 by smtp.gmail.com with ESMTPSA id ay8sm3203806ejb.4.2019.08.21.09.04.55
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Wed, 21 Aug 2019 09:04:56 -0700 (PDT)
Date: Wed, 21 Aug 2019 18:04:54 +0200
From: Daniel Vetter <daniel@ffwll.ch>
To: Christian =?iso-8859-1?Q?K=F6nig?= <ckoenig.leichtzumerken@gmail.com>
Subject: Re: [PATCH 07/10] dma-buf/resv: add new fences container
 implementation
Message-ID: <20190821160454.GN11147@phenom.ffwll.local>
References: <20190821123147.110736-1-christian.koenig@amd.com>
 <20190821123147.110736-8-christian.koenig@amd.com>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <20190821123147.110736-8-christian.koenig@amd.com>
X-Operating-System: Linux phenom 5.2.0-2-amd64 
User-Agent: Mutt/1.10.1 (2018-07-13)
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ffwll.ch; s=google;
 h=sender:date:from:to:cc:subject:message-id:references:mime-version
 :content-disposition:content-transfer-encoding:in-reply-to
 :user-agent;
 bh=PQJzaKCMOyJ9cU3DjRwvUQW5X0QqM3/O0kDiRQb5Fws=;
 b=EL8c2Kjeg/3PdUXDP426h6rXAU9ZHvTlfR6UKJaur5GqpZKBEEqvA38G5oqyB95yU0
 IREqeCTr+s9FBNyaAxmfOyUiwAeCNqAppyjLDs0q3oQtQBwS5fmB+ET1kNasO5Gwz97+
 OBWoEX0tN8p7drJexvFCn/OMITNqrOvZ251RQ=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: daniel.vetter@ffwll.ch, dri-devel@lists.freedesktop.org,
 linaro-mm-sig@lists.linaro.org, linux-media@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gV2VkLCBBdWcgMjEsIDIwMTkgYXQgMDI6MzE6NDRQTSArMDIwMCwgQ2hyaXN0aWFuIEvDtm5p
ZyB3cm90ZToKPiBBZGQgYSBuZXcgY29udGFpbmVyIGZvciBmZW5jZXMgd2hpY2ggaW50ZXJuYWxs
eSB1c2VzCj4gZG1hX2ZlbmNlX2FycmF5J3MgdG8gc3RvcmUgdGhlIGZlbmNlcy4KPiAKPiBTaWdu
ZWQtb2ZmLWJ5OiBDaHJpc3RpYW4gS8O2bmlnIDxjaHJpc3RpYW4ua29lbmlnQGFtZC5jb20+Cj4g
LS0tCj4gIGRyaXZlcnMvZG1hLWJ1Zi9kbWEtcmVzdi5jIHwgMjIxICsrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysKPiAgaW5jbHVkZS9saW51eC9kbWEtcmVzdi5oICAgfCAgNDkg
KysrKysrKysKPiAgMiBmaWxlcyBjaGFuZ2VkLCAyNzAgaW5zZXJ0aW9ucygrKQo+IAo+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL2RtYS1idWYvZG1hLXJlc3YuYyBiL2RyaXZlcnMvZG1hLWJ1Zi9kbWEt
cmVzdi5jCj4gaW5kZXggZDNhOWEzYmIxNWYwLi44MzAzM2IzZTg1MjEgMTAwNjQ0Cj4gLS0tIGEv
ZHJpdmVycy9kbWEtYnVmL2RtYS1yZXN2LmMKPiArKysgYi9kcml2ZXJzL2RtYS1idWYvZG1hLXJl
c3YuYwo+IEBAIC0zMyw2ICszMyw3IEBACj4gICAqLwo+ICAKPiAgI2luY2x1ZGUgPGxpbnV4L2Rt
YS1yZXN2Lmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9kbWEtZmVuY2UtYXJyYXkuaD4KPiAgI2luY2x1
ZGUgPGxpbnV4L2V4cG9ydC5oPgo+ICAKPiAgLyoqCj4gQEAgLTU1LDYgKzU2LDIyNiBAQCBFWFBP
UlRfU1lNQk9MKHJlc2VydmF0aW9uX3NlcWNvdW50X2NsYXNzKTsKPiAgY29uc3QgY2hhciByZXNl
cnZhdGlvbl9zZXFjb3VudF9zdHJpbmdbXSA9ICJyZXNlcnZhdGlvbl9zZXFjb3VudCI7Cj4gIEVY
UE9SVF9TWU1CT0wocmVzZXJ2YXRpb25fc2VxY291bnRfc3RyaW5nKTsKPiAgCj4gK3N0YXRpYyB2
b2lkIGRtYV9yZXN2X2ZlbmNlc19pbml0KHN0cnVjdCBkbWFfcmVzdl9mZW5jZXMgKmZlbmNlcykK
PiArewo+ICsJUkNVX0lOSVRfUE9JTlRFUihmZW5jZXMtPmZlbmNlLCBOVUxMKTsKPiArCWZlbmNl
cy0+c3RhZ2VkID0gTlVMTDsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgZG1hX3Jlc3ZfZmVuY2Vz
X2Zpbmkoc3RydWN0IGRtYV9yZXN2X2ZlbmNlcyAqZmVuY2VzKQo+ICt7Cj4gKwkvKgo+ICsJICog
VGhpcyBvYmplY3Qgc2hvdWxkIGJlIGRlYWQgYW5kIGFsbCByZWZlcmVuY2VzIG11c3QgaGF2ZQo+
ICsJICogYmVlbiByZWxlYXNlZCB0byBpdCwgc28gbm8gbmVlZCB0byBiZSBwcm90ZWN0ZWQgd2l0
aCByY3UuCj4gKwkgKi8KPiArCWRtYV9mZW5jZV9wdXQocmN1X2RlcmVmZXJlbmNlX3Byb3RlY3Rl
ZChmZW5jZXMtPmZlbmNlLCB0cnVlKSk7Cj4gKwlkbWFfZmVuY2VfYXJyYXlfZnJlZShmZW5jZXMt
PnN0YWdlZCk7Cj4gK30KPiArCj4gKy8qKgo+ICsgKiBkbWFfcmVzdl9mZW5jZXNfcmVzZXJ2ZSAt
IGFsbG9jYXRlIGZlbmNlIHNsb3RzCj4gKyAqIEBmZW5jZXM6IGZlbmNlcyBvYmplY3Qgd2hlcmUg
d2UgbmVlZCBzbG90cwo+ICsgKiBAbnVtX2ZlbmNlczogbnVtYmVyIG9mIGZlbmNlIHNsb3RzIHdl
IG5lZWQKPiArICoKPiArICogTWFrZSBzdXJlIHRoYXQgd2UgaGF2ZSBhdCBsZWFzdCBAbnVtX2Zl
bmNlcyArIGFsbCB0aGUgZXhpc3Rpbmcgb25lcyBmcmVlCj4gKyAqIHNsb3RzIGluIHRoZSBzdGFn
ZWQgZG1hX2ZlbmNlX2FycmF5Lgo+ICsgKgo+ICsgKiBSZXR1cm5zIC1FTk9NRU0gb24gYWxsb2Nh
dGlvbiBmYWlsdXJlLCAwIG90aGVyd2lzZS4KPiArICovCj4gK2ludCBkbWFfcmVzdl9mZW5jZXNf
cmVzZXJ2ZShzdHJ1Y3QgZG1hX3Jlc3YgKm9iaiwKPiArCQkJICAgIHN0cnVjdCBkbWFfcmVzdl9m
ZW5jZXMgKmZlbmNlcywKPiArCQkJICAgIHVuc2lnbmVkIGludCBudW1fZmVuY2VzKQo+ICt7Cj4g
KwlzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSA9IGRtYV9yZXN2X2ZlbmNlc19kZXJlZihvYmosIGZl
bmNlcyk7Cj4gKwlzdHJ1Y3QgZG1hX2ZlbmNlX2FycmF5ICpzdGFnZWQsICphcnJheTsKPiArCXVu
c2lnbmVkIGludCBpOwo+ICsKPiArCWFycmF5ID0gZmVuY2VzLT5zdGFnZWQ7Cj4gKwlpZiAoIWFy
cmF5KQo+ICsJCWFycmF5ID0gdG9fZG1hX2ZlbmNlX2FycmF5KGZlbmNlKTsKPiArCj4gKwlpZiAo
YXJyYXkpCj4gKwkJbnVtX2ZlbmNlcyArPSBhcnJheS0+bnVtX2ZlbmNlczsKPiArCWVsc2UgaWYg
KGZlbmNlKQo+ICsJCW51bV9mZW5jZXMgKz0gMTsKPiArCj4gKwlzdGFnZWQgPSBmZW5jZXMtPnN0
YWdlZDsKPiArCWlmIChzdGFnZWQgJiYgZG1hX2ZlbmNlX2FycmF5X21heF9mZW5jZXMoc3RhZ2Vk
KSA+PSBudW1fZmVuY2VzKQo+ICsJCXJldHVybiAwOwo+ICsKPiArCXN0YWdlZCA9IGRtYV9mZW5j
ZV9hcnJheV9hbGxvYyhudW1fZmVuY2VzLCBOVUxMKTsKPiArCWlmICghc3RhZ2VkKQo+ICsJCXJl
dHVybiAtRU5PTUVNOwo+ICsKPiArCS8qIENvcHkgb3ZlciBhbGwgZmVuY2VzIGZyb20gdGhlIG9s
ZCBvYmplY3QgKi8KPiArCWlmIChhcnJheSkgewo+ICsJCWZvciAoaSA9IDA7IGkgPCBhcnJheS0+
bnVtX2ZlbmNlczsgKytpKSB7Cj4gKwkJCXN0cnVjdCBkbWFfZmVuY2UgKmYgPSBhcnJheS0+ZmVu
Y2VzW2ldOwo+ICsKPiArCQkJc3RhZ2VkLT5mZW5jZXNbaV0gPSBkbWFfZmVuY2VfZ2V0KGYpOwo+
ICsJCX0KPiArCQlzdGFnZWQtPm51bV9mZW5jZXMgPSBhcnJheS0+bnVtX2ZlbmNlczsKPiArCj4g
Kwl9IGVsc2UgaWYgKGZlbmNlKSB7Cj4gKwkJc3RhZ2VkLT5mZW5jZXNbMF0gPSBkbWFfZmVuY2Vf
Z2V0KGZlbmNlKTsKPiArCQlzdGFnZWQtPm51bV9mZW5jZXMgPSAxOwo+ICsKPiArCX0gZWxzZSB7
Cj4gKwkJc3RhZ2VkLT5udW1fZmVuY2VzID0gMDsKPiArCX0KPiArCj4gKwlkbWFfZmVuY2VfYXJy
YXlfZnJlZShmZW5jZXMtPnN0YWdlZCk7Cj4gKwlmZW5jZXMtPnN0YWdlZCA9IHN0YWdlZDsKPiAr
Cj4gKwlyZXR1cm4gMDsKPiArfQo+ICtFWFBPUlRfU1lNQk9MKGRtYV9yZXN2X2ZlbmNlc19yZXNl
cnZlKTsKPiArCj4gKy8qKgo+ICsgKiBkbWFfcmVzdl9mZW5jZXNfYXNzaWduIC0gc2V0IHRoZSBz
aW5nbGV0b24gZmVuY2UKPiArICogQGZlbmNlczogZmVuY2VzIG9iamVjdCB3aGVyZSB0byBzZXQg
dGhlIGZlbmNlCj4gKyAqIEBmZW5jZTogc2luZ2xldG9uIGZlbmNlIGZvciB0aGUgb2JqZWN0Cj4g
KyAqCj4gKyAqIEludGVybmFsIGhlbHBlciB0byBhc3NpZ24gdGhlIHNpZ25sZXRvbiBmZW5jZSB3
aXRob3V0IGdyYXBwaW5nIGEgcmVmZXJlbmNlLgo+ICsgKiBJZiB0aGUgb2xkIGZlbmNlIGlzIGEg
ZG1hX2ZlbmNlX2FycmF5IHRyeSB0byByZWN5Y2xlIGl0Lgo+ICsgKi8KPiArc3RhdGljIHZvaWQg
ZG1hX3Jlc3ZfZmVuY2VzX2Fzc2lnbihzdHJ1Y3QgZG1hX3Jlc3YgKm9iaiwKPiArCQkJCSAgIHN0
cnVjdCBkbWFfcmVzdl9mZW5jZXMgKmZlbmNlcywKPiArCQkJCSAgIHN0cnVjdCBkbWFfZmVuY2Ug
KmZlbmNlKQo+ICt7Cj4gKwlzdHJ1Y3QgZG1hX2ZlbmNlX2FycmF5ICphcnJheSwgKnN0YWdlZDsK
PiArCXVuc2lnbmVkIGludCBudW1fZmVuY2VzLCBpOwo+ICsJc3RydWN0IGRtYV9mZW5jZSAqb2xk
Owo+ICsKPiArCW9sZCA9IGRtYV9yZXN2X2ZlbmNlc19kZXJlZihvYmosIGZlbmNlcyk7Cj4gKwly
Y3VfYXNzaWduX3BvaW50ZXIoZmVuY2VzLT5mZW5jZSwgZmVuY2UpOwo+ICsKPiArCWRtYV9mZW5j
ZV9hcnJheV9mcmVlKGZlbmNlcy0+c3RhZ2VkKTsKPiArCWZlbmNlcy0+c3RhZ2VkID0gTlVMTDsK
PiArCj4gKwkvKiBUcnkgdG8gcmVjeWNsZSB0aGUgb2xkIGZlbmNlIGFycmF5ICovCj4gKwlzdGFn
ZWQgPSB0b19kbWFfZmVuY2VfYXJyYXkob2xkKTsKPiArCWlmICghc3RhZ2VkKQo+ICsJCWdvdG8g
ZHJvcF9vbGQ7Cj4gKwo+ICsJYXJyYXkgPSB0b19kbWFfZmVuY2VfYXJyYXkoZmVuY2UpOwo+ICsJ
aWYgKGFycmF5KQo+ICsJCW51bV9mZW5jZXMgPSBhcnJheS0+bnVtX2ZlbmNlczsKPiArCWVsc2UK
PiArCQludW1fZmVuY2VzID0gZmVuY2UgPyAxIDogMDsKPiArCj4gKwlpZiAoZG1hX2ZlbmNlX2Fy
cmF5X21heF9mZW5jZXMoc3RhZ2VkKSA8IG51bV9mZW5jZXMpCj4gKwkJZ290byBkcm9wX29sZDsK
PiArCj4gKwkvKiBUcnkgdG8gZHJvcCB0aGUgbGFzdCByZWZlcmVuY2UgKi8KPiArCWlmICghZG1h
X2ZlbmNlX2FycmF5X3JlY3ljbGUoc3RhZ2VkKSkKCldpdGhvdXQgYW4gcmN1IGJhcnJpZXIgaGVy
ZSB5b3UncmUgbm90IHN5bmNpbmcgdG8gbmV3IGNsaWVudHMgYXQgYWxsLgpJIGRvbid0IHRoaW5r
IHRoaXMgd29ya3MsIGFuZCBJIGV4cGVjdCB0aGF0IG9uY2UgeW91J3ZlIHJlYWRkZWQgYWxsIHRo
ZQpiYXJyaWVycyBhbmQgcmV0cnkgbG9vcHMgd2UncmUgYmFjayB0byBzZXFsb2Nrcy4KLURhbmll
bAoKPiArCQlyZXR1cm47Cj4gKwo+ICsJLyogTWFrZSBzdXJlIHRoZSBzdGFnZWQgYXJyYXkgaGFz
IHRoZSBsYXRlc3QgZmVuY2VzICovCj4gKwlpZiAoYXJyYXkpIHsKPiArCQlmb3IgKGkgPSAwOyBp
IDwgYXJyYXktPm51bV9mZW5jZXM7ICsraSkgewo+ICsJCQlzdHJ1Y3QgZG1hX2ZlbmNlICpmID0g
YXJyYXktPmZlbmNlc1tpXTsKPiArCj4gKwkJCWlmIChmID09IHN0YWdlZC0+ZmVuY2VzW2ldKQo+
ICsJCQkJY29udGludWU7Cj4gKwo+ICsJCQlkbWFfZmVuY2VfcHV0KHN0YWdlZC0+ZmVuY2VzW2ld
KTsKPiArCQkJc3RhZ2VkLT5mZW5jZXNbaV0gPSBkbWFfZmVuY2VfZ2V0KGYpOwo+ICsJCX0KPiAr
CQlmb3IgKDtpIDwgc3RhZ2VkLT5udW1fZmVuY2VzOyArK2kpCj4gKwkJCWRtYV9mZW5jZV9wdXQo
c3RhZ2VkLT5mZW5jZXNbaV0pOwo+ICsJCXN0YWdlZC0+bnVtX2ZlbmNlcyA9IGFycmF5LT5udW1f
ZmVuY2VzOwo+ICsKPiArCX0gZWxzZSBpZiAoZmVuY2UpIHsKPiArCQlmb3IgKGkgPSAwOyBpIDwg
c3RhZ2VkLT5udW1fZmVuY2VzOyArK2kpCj4gKwkJCWRtYV9mZW5jZV9wdXQoc3RhZ2VkLT5mZW5j
ZXNbaV0pOwo+ICsJCXN0YWdlZC0+ZmVuY2VzWzBdID0gZG1hX2ZlbmNlX2dldChmZW5jZSk7Cj4g
KwkJc3RhZ2VkLT5udW1fZmVuY2VzID0gMTsKPiArCX0gZWxzZSB7Cj4gKwkJZm9yIChpID0gMDsg
aSA8IHN0YWdlZC0+bnVtX2ZlbmNlczsgKytpKQo+ICsJCQlkbWFfZmVuY2VfcHV0KHN0YWdlZC0+
ZmVuY2VzW2ldKTsKPiArCQlzdGFnZWQtPm51bV9mZW5jZXMgPSAwOwo+ICsJfQo+ICsKPiArCWZl
bmNlcy0+c3RhZ2VkID0gc3RhZ2VkOwo+ICsJcmV0dXJuOwo+ICsKPiArZHJvcF9vbGQ6Cj4gKwlk
bWFfZmVuY2VfcHV0KG9sZCk7Cj4gK30KPiArCj4gKy8qKgo+ICsgKiBkbWFfcmVzdl9mZW5jZXNf
c2V0IC0gc2V0IHRoZSBzaW5nbGV0b24gZmVuY2UKPiArICogQGZlbmNlczogZmVuY2VzIG9iamVj
dCB3aGVyZSB0byBzZXQgdGhlIGZlbmNlCj4gKyAqIEBmZW5jZTogc2luZ2xldG9uIGZlbmNlIGZv
ciB0aGUgb2JqZWN0Cj4gKyAqCj4gKyAqIEdyYWJzIGEgcmVmZXJlbmNlIHRvIHRoZSBuZXcgZmVu
Y2UgYW5kIHJlcGxhY2VzIHRoZSBjdXJyZW50IHNpbmdsZXRvbiBmZW5jZQo+ICsgKiB3aXRoIGEg
bmV3IG9uZS4gSWYgdGhlIG9sZCBmZW5jZSBpcyBhIGRtYV9mZW5jZV9hcnJheSB0cnkgdG8gcmVj
eWNsZSBpdC4KPiArICovCj4gK3ZvaWQgZG1hX3Jlc3ZfZmVuY2VzX3NldChzdHJ1Y3QgZG1hX3Jl
c3YgKm9iaiwKPiArCQkJIHN0cnVjdCBkbWFfcmVzdl9mZW5jZXMgKmZlbmNlcywKPiArCQkJIHN0
cnVjdCBkbWFfZmVuY2UgKmZlbmNlKQo+ICt7Cj4gKwlkbWFfZmVuY2VfZ2V0KGZlbmNlKTsKPiAr
CWRtYV9yZXN2X2ZlbmNlc19hc3NpZ24ob2JqLCBmZW5jZXMsIGZlbmNlKTsKPiArfQo+ICtFWFBP
UlRfU1lNQk9MKGRtYV9yZXN2X2ZlbmNlc19zZXQpOwo+ICsKPiArLyoqCj4gKyAqIGRtYV9yZXN2
X2ZlbmNlc19hZGQgLSBhZGQgYSBmZW5jZSB0byB0aGUgc3RhZ2VkIGZlbmNlX2FycmF5Cj4gKyAq
IEBmZW5jZXM6IGZlbmNlcyBvYmplY3Qgd2hlcmUgdG8gYWRkIHRoZSBmZW5jZSB0bwo+ICsgKiBA
ZmVuY2U6IGZlbmNlIHRvIGFkZAo+ICsgKgo+ICsgKiBBZGQgYSBuZXcgZmVuY2UgdG8gdGhlIHN0
YWdlZCBmZW5jZV9hcnJheS4KPiArICovCj4gK3ZvaWQgZG1hX3Jlc3ZfZmVuY2VzX2FkZChzdHJ1
Y3QgZG1hX3Jlc3ZfZmVuY2VzICpmZW5jZXMsCj4gKwkJCSBzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5j
ZSkKPiArewo+ICsJc3RydWN0IGRtYV9mZW5jZV9hcnJheSAqc3RhZ2VkID0gZmVuY2VzLT5zdGFn
ZWQ7Cj4gKwlzdHJ1Y3QgZG1hX2ZlbmNlICpvbGQ7Cj4gKwl1bnNpZ25lZCBpbnQgaTsKPiArCj4g
KyNpZm5kZWYgQ09ORklHX0RFQlVHX01VVEVYRVMKPiArCWZvciAoaSA9IDA7IGkgPCBzdGFnZWQt
Pm51bV9mZW5jZXM7ICsraSkgewo+ICsJCW9sZCA9IHN0YWdlZC0+ZmVuY2VzW2ldOwo+ICsKPiAr
CQlpZiAob2xkLT5jb250ZXh0ID09IGZlbmNlLT5jb250ZXh0IHx8Cj4gKwkJICAgIGRtYV9mZW5j
ZV9pc19zaWduYWxlZChvbGQpKSB7Cj4gKwkJCWRtYV9mZW5jZV9wdXQob2xkKTsKPiArCQkJZ290
byByZXBsYWNlOwo+ICsJCX0KPiArCX0KPiArI2VuZGlmCj4gKwo+ICsJQlVHX09OKHN0YWdlZC0+
bnVtX2ZlbmNlcyA+PSBkbWFfZmVuY2VfYXJyYXlfbWF4X2ZlbmNlcyhzdGFnZWQpKTsKPiArCWkg
PSBzdGFnZWQtPm51bV9mZW5jZXMrKzsKPiArCj4gK3JlcGxhY2U6Cj4gKwlzdGFnZWQtPmZlbmNl
c1tpXSA9IGRtYV9mZW5jZV9nZXQoZmVuY2UpOwo+ICt9Cj4gK0VYUE9SVF9TWU1CT0woZG1hX3Jl
c3ZfZmVuY2VzX2FkZCk7Cj4gKwo+ICsvKioKPiArICogZG1hX3Jlc3ZfZmVuY2VzX2NvbW1pdCAt
IGNvbW1pdCB0aGUgc3RhZ2VkIGRtYV9mZW5jZV9hcnJheQo+ICsgKiBAZmVuY2VzOiBmZW5jZXMg
b2JqZWN0IHdoZXJlIHRoZSBjb21taXQgc2hvdWxkIGhhcHBlbgo+ICsgKgo+ICsgKiBDb21taXQg
dGhlIGZlbmNlcyBzdGFnZWQgaW4gdGhlIGRtYV9mZW5jZV9hcnJheSBhbmQgbWFrZSB0aGVtIHZp
c2libGUgdG8KPiArICogb3RoZXIgdGhyZWFkcy4KPiArICovCj4gK3ZvaWQgZG1hX3Jlc3ZfZmVu
Y2VzX2NvbW1pdChzdHJ1Y3QgZG1hX3Jlc3YgKm9iaiwKPiArCQkJICAgIHN0cnVjdCBkbWFfcmVz
dl9mZW5jZXMgKmZlbmNlcykKPiArewo+ICsJc3RydWN0IGRtYV9mZW5jZV9hcnJheSAqc3RhZ2Vk
ID0gZmVuY2VzLT5zdGFnZWQ7Cj4gKwo+ICsJaWYgKCFzdGFnZWQgfHwgIXN0YWdlZC0+bnVtX2Zl
bmNlcykKPiArCQlyZXR1cm47Cj4gKwo+ICsJZmVuY2VzLT5zdGFnZWQgPSBOVUxMOwo+ICsJZG1h
X2ZlbmNlX2FycmF5X2luaXQoc3RhZ2VkLCBkbWFfZmVuY2VfY29udGV4dF9hbGxvYygxKSwgMSwg
ZmFsc2UpOwo+ICsJZG1hX3Jlc3ZfZmVuY2VzX2Fzc2lnbihvYmosIGZlbmNlcywgJnN0YWdlZC0+
YmFzZSk7Cj4gK30KPiArRVhQT1JUX1NZTUJPTChkbWFfcmVzdl9mZW5jZXNfY29tbWl0KTsKPiAr
Cj4gIC8qKgo+ICAgKiBkbWFfcmVzdl9saXN0X2FsbG9jIC0gYWxsb2NhdGUgZmVuY2UgbGlzdAo+
ICAgKiBAc2hhcmVkX21heDogbnVtYmVyIG9mIGZlbmNlcyB3ZSBuZWVkIHNwYWNlIGZvcgo+IGRp
ZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L2RtYS1yZXN2LmggYi9pbmNsdWRlL2xpbnV4L2RtYS1y
ZXN2LmgKPiBpbmRleCAwM2IwZjk1NjgyYjAuLmM3MGYxM2ZhNjc4OSAxMDA2NDQKPiAtLS0gYS9p
bmNsdWRlL2xpbnV4L2RtYS1yZXN2LmgKPiArKysgYi9pbmNsdWRlL2xpbnV4L2RtYS1yZXN2LmgK
PiBAQCAtNDUsMTAgKzQ1LDMzIEBACj4gICNpbmNsdWRlIDxsaW51eC9zZXFsb2NrLmg+Cj4gICNp
bmNsdWRlIDxsaW51eC9yY3VwZGF0ZS5oPgo+ICAKPiArc3RydWN0IGRtYV9yZXN2Owo+ICsKPiAg
ZXh0ZXJuIHN0cnVjdCB3d19jbGFzcyByZXNlcnZhdGlvbl93d19jbGFzczsKPiAgZXh0ZXJuIHN0
cnVjdCBsb2NrX2NsYXNzX2tleSByZXNlcnZhdGlvbl9zZXFjb3VudF9jbGFzczsKPiAgZXh0ZXJu
IGNvbnN0IGNoYXIgcmVzZXJ2YXRpb25fc2VxY291bnRfc3RyaW5nW107Cj4gIAo+ICsvKioKPiAr
ICogc3RydWN0IGRtYV9yZXN2X2ZlbmNlcyAtIGZlbmNlcyBpbnNpZGUgYSByZXNlcnZhdGlvbiBv
YmplY3QKPiArICogQGZlbmNlOiB0aGUgY3VycmVudCBSQ1UgcHJvdGVjdGVkIHNpbmdsZXRvbiBm
ZW5jZQo+ICsgKiBAc3RhZ2VkOiBvcHRpb25hbCBzdGFnZWQgZG1hX2ZlbmNlX2FycmF5IHRvIHJl
cGxhY2UgQGZlbmNlCj4gKyAqLwo+ICtzdHJ1Y3QgZG1hX3Jlc3ZfZmVuY2VzIHsKPiArCXN0cnVj
dCBkbWFfZmVuY2UgX19yY3UgKmZlbmNlOwo+ICsJc3RydWN0IGRtYV9mZW5jZV9hcnJheSAqc3Rh
Z2VkOwo+ICt9Owo+ICsKPiAraW50IGRtYV9yZXN2X2ZlbmNlc19yZXNlcnZlKHN0cnVjdCBkbWFf
cmVzdiAqb2JqLAo+ICsJCQkgICAgc3RydWN0IGRtYV9yZXN2X2ZlbmNlcyAqZmVuY2VzLAo+ICsJ
CQkgICAgdW5zaWduZWQgaW50IG51bV9mZW5jZXMpOwo+ICt2b2lkIGRtYV9yZXN2X2ZlbmNlc19z
ZXQoc3RydWN0IGRtYV9yZXN2ICpvYmosCj4gKwkJCSBzdHJ1Y3QgZG1hX3Jlc3ZfZmVuY2VzICpm
ZW5jZXMsCj4gKwkJCSBzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSk7Cj4gK3ZvaWQgZG1hX3Jlc3Zf
ZmVuY2VzX2FkZChzdHJ1Y3QgZG1hX3Jlc3ZfZmVuY2VzICpmZW5jZXMsCj4gKwkJCSBzdHJ1Y3Qg
ZG1hX2ZlbmNlICpmZW5jZSk7Cj4gK3ZvaWQgZG1hX3Jlc3ZfZmVuY2VzX2NvbW1pdChzdHJ1Y3Qg
ZG1hX3Jlc3YgKm9iaiwKPiArCQkJICAgIHN0cnVjdCBkbWFfcmVzdl9mZW5jZXMgKmZlbmNlcyk7
Cj4gKwo+ICAvKioKPiAgICogc3RydWN0IGRtYV9yZXN2X2xpc3QgLSBhIGxpc3Qgb2Ygc2hhcmVk
IGZlbmNlcwo+ICAgKiBAcmN1OiBmb3IgaW50ZXJuYWwgdXNlCj4gQEAgLTgwLDYgKzEwMywzMiBA
QCBzdHJ1Y3QgZG1hX3Jlc3Ygewo+ICAjZGVmaW5lIGRtYV9yZXN2X2hlbGQob2JqKSBsb2NrZGVw
X2lzX2hlbGQoJihvYmopLT5sb2NrLmJhc2UpCj4gICNkZWZpbmUgZG1hX3Jlc3ZfYXNzZXJ0X2hl
bGQob2JqKSBsb2NrZGVwX2Fzc2VydF9oZWxkKCYob2JqKS0+bG9jay5iYXNlKQo+ICAKPiArLyoq
Cj4gKyAqIGRtYV9yZXN2X2ZlbmNlc19kZXJlZiAtIGdldCBzaW5nbGV0b24gZmVuY2UKPiArICog
QG9iajogdGhlIHJlc2VydmF0aW9uIG9iamVjdAo+ICsgKiBAZmVuY2VzOiB0aGUgZmVuY2VzIG9i
amVjdAo+ICsgKgo+ICsgKiBSZXR1cm5zIHRoZSBzaW5nbGV0b24gZmVuY2UgZnJvbSBhIHJlc3Zf
ZmVuY2VzIG9iamVjdC4KPiArICovCj4gK3N0YXRpYyBpbmxpbmUgc3RydWN0IGRtYV9mZW5jZSAq
Cj4gK2RtYV9yZXN2X2ZlbmNlc19kZXJlZihzdHJ1Y3QgZG1hX3Jlc3YgKm9iaiwgc3RydWN0IGRt
YV9yZXN2X2ZlbmNlcyAqZmVuY2VzKQo+ICt7Cj4gKwlyZXR1cm4gcmN1X2RlcmVmZXJlbmNlX3By
b3RlY3RlZChmZW5jZXMtPmZlbmNlLAo+ICsJCQkJCSBkbWFfcmVzdl9oZWxkKG9iaikpOwo+ICt9
Cj4gKwo+ICsvKioKPiArICogZG1hX3Jlc3ZfZmVuY2VzX2dldF9yY3UgLSBSQ1UgZ2V0IHNpbmds
ZSBmZW5jZQo+ICsgKiBAZmVuY2VzOiBmZW5jZXMgc3RydWN0dXJlIHdoZXJlIHdlIG5lZWQgdG8g
Z2V0IGEgcmVmZXJlbmNlIGZvcgo+ICsgKgo+ICsgKiBHZXQgYSByZWZlcmVuY2UgdG8gdGhlIHNp
bmdsZSBmZW5jZSByZXByZXNlbnRpbmcgdGhlIHN5bmNocm9uaXphdGlvbi4KPiArICovCj4gK3N0
YXRpYyBpbmxpbmUgc3RydWN0IGRtYV9mZW5jZSAqCj4gK2RtYV9yZXN2X2ZlbmNlc19nZXRfcmN1
KHN0cnVjdCBkbWFfcmVzdl9mZW5jZXMgKmZlbmNlcykKPiArewo+ICsJcmV0dXJuIGRtYV9mZW5j
ZV9nZXRfcmN1X3NhZmUoJmZlbmNlcy0+ZmVuY2UpOwo+ICt9Cj4gKwo+ICAvKioKPiAgICogZG1h
X3Jlc3ZfZ2V0X2xpc3QgLSBnZXQgdGhlIHJlc2VydmF0aW9uIG9iamVjdCdzCj4gICAqIHNoYXJl
ZCBmZW5jZSBsaXN0LCB3aXRoIHVwZGF0ZS1zaWRlIGxvY2sgaGVsZAo+IC0tIAo+IDIuMTcuMQo+
IAoKLS0gCkRhbmllbCBWZXR0ZXIKU29mdHdhcmUgRW5naW5lZXIsIEludGVsIENvcnBvcmF0aW9u
Cmh0dHA6Ly9ibG9nLmZmd2xsLmNoCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVk
ZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZv
L2RyaS1kZXZlbA==
