Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 7592E85B98
	for <lists+dri-devel@lfdr.de>; Thu,  8 Aug 2019 09:31:07 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B34296E484;
	Thu,  8 Aug 2019 07:31:04 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ot1-x342.google.com (mail-ot1-x342.google.com
 [IPv6:2607:f8b0:4864:20::342])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4C9576E46E
 for <dri-devel@lists.freedesktop.org>; Thu,  8 Aug 2019 07:31:03 +0000 (UTC)
Received: by mail-ot1-x342.google.com with SMTP id j11so14426415otp.10
 for <dri-devel@lists.freedesktop.org>; Thu, 08 Aug 2019 00:31:03 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc:content-transfer-encoding;
 bh=+bPhQfc8F4RC7kDRrQXyjuTrCZWZxiVqPXDyFC0nj50=;
 b=L2lB0d6wiA8cDbfkwfhPhiwr/3x+bf67IZzieDgExjLY6JEnoK1HwJuAGScirH22Bb
 OUrsGdtbv0sMdjGhzQZ0bEEbLNgK/pUDHo+4X2IuOwGUUzPy0PfN+lEYAfSdmrhsAw9g
 fcaOuBHmedlt406gs20wIuU73fm6HCaXfMYNDjtbcSj7bBewOA3ZiM0VbbWqK/tL77Kb
 n5gWuMiAlkec9sKExpBzwI7P+qdv/br1gb67Jswu6LV1pGbgTDGQ63H+d4sy3tOjZ+Ty
 pENaCjPDj8OJm/2JtlApbWBbMAiXiTRi8usdAEz/VwCZyREXoH54gKissEDNjWcT7B3t
 2blQ==
X-Gm-Message-State: APjAAAXgPDNYc8OgubjZAgTv7REqxY3pLHLJGdldgA9T3WUGtilUpzmX
 OyZb4KOw5DfWlIjk3KkFNHjuiq1WHZXWNBuvblP32g==
X-Google-Smtp-Source: APXvYqwdnE1zA63ss8TQXS96DkImU5jHVEwIXxdFKrEvI/B/LO6eXq90ibCDKJFUfwrU1SSEDE6jg/VgDrMlgEaFXUQ=
X-Received: by 2002:a9d:590d:: with SMTP id t13mr872313oth.281.1565249461221; 
 Thu, 08 Aug 2019 00:31:01 -0700 (PDT)
MIME-Version: 1.0
References: <20190614071023.17929-1-chris@chris-wilson.co.uk>
 <20190614071023.17929-37-chris@chris-wilson.co.uk>
 <20190807204958.GD7444@phenom.ffwll.local>
In-Reply-To: <20190807204958.GD7444@phenom.ffwll.local>
From: Daniel Vetter <daniel@ffwll.ch>
Date: Thu, 8 Aug 2019 09:30:49 +0200
Message-ID: <CAKMK7uHQk-km264==ka=kVhSQPy5QFdTvFArdFUwZvDdJSMz9Q@mail.gmail.com>
Subject: Re: [Intel-gfx] [PATCH 36/39] drm/i915: Use reservation_object to
 coordinate userptr get_pages()
To: Chris Wilson <chris@chris-wilson.co.uk>,
 =?UTF-8?Q?Christian_K=C3=B6nig?= <christian.koenig@amd.com>, 
 Matthew Auld <matthew.auld@intel.com>,
 Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>, 
 Joonas Lahtinen <joonas.lahtinen@linux.intel.com>, CQ Tang <cq.tang@intel.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ffwll.ch; s=google;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc:content-transfer-encoding;
 bh=+bPhQfc8F4RC7kDRrQXyjuTrCZWZxiVqPXDyFC0nj50=;
 b=Zj94flgyaPy+BCx5CuDqlNnQj81ztYqn9IeurJ2xoET7mA6Cf9GXOU76sYrO1Lmfo8
 ZpOdmFKeP6QGst2SFTv1/NZEhCCTDjGfB3lOk/FbTDLnr0Qrx9Zh89PEA5kHHYKb++bw
 fhvd5P06UnTObI2mBma+jdQ5T9OBb5rcKiFxQ=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: intel-gfx <intel-gfx@lists.freedesktop.org>,
 dri-devel <dri-devel@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkaW5nIGEgcGlsZSBvZiBwZW9wbGUgc2luY2UgdGhlcmUncyBsb3RzIG9mIGRpc2N1c3NvaW5z
IGdvaW5nIG9uIGFyb3VuZCB0aGlzLgotRGFuaWVsCgpPbiBXZWQsIEF1ZyA3LCAyMDE5IGF0IDEw
OjUwIFBNIERhbmllbCBWZXR0ZXIgPGRhbmllbEBmZndsbC5jaD4gd3JvdGU6Cj4KPiBPbiBGcmks
IEp1biAxNCwgMjAxOSBhdCAwODoxMDoyMEFNICswMTAwLCBDaHJpcyBXaWxzb24gd3JvdGU6Cj4g
PiBTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4K
Pgo+IE5vdCBzdXJlIHRoaXMgd29ya3MsIDIgdGhvdWdodHMgd2F5IGRvd24gLi4uCj4KPiA+IC0t
LQo+ID4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9kbWFidWYuYyAgICB8ICAy
NyArLS0KPiA+ICAuLi4vZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMgICAg
fCAgIDMgLQo+ID4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9pbnRlcm5hbC5j
ICB8ICAzMCArLS0KPiA+ICAuLi4vZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlw
ZXMuaCAgfCAgMTEgKy0KPiA+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcGFn
ZXMuYyAgICAgfCAxMzcgKysrKysrKysrKy0KPiA+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fcGh5cy5jICAgICAgfCAgMzMgKystCj4gPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX3NobWVtLmMgICAgIHwgIDMwICstLQo+ID4gIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9zdG9sZW4uYyAgICB8ICAyNSArLQo+ID4gIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV91c2VycHRyLmMgICB8IDIyMSArKysrLS0tLS0tLS0tLS0tLS0K
PiA+ICAuLi4vZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX2dlbV9vYmplY3QuYyAgfCAgMTcg
Ky0KPiA+ICAuLi4vZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaHVnZV9wYWdlcy5jICAgfCAg
NDUgKystLQo+ID4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9kbWFidWYuYyAgICAgICAgICAg
ICB8ICAxNyArLQo+ID4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggICAgICAgICAg
ICAgICB8ICAgOSArLQo+ID4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMgICAgICAg
ICAgICAgICB8ICAgNSArLQo+ID4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1
X2dlbV9ndHQuYyB8ICAxNCArLQo+ID4gIDE1IGZpbGVzIGNoYW5nZWQsIDMwMCBpbnNlcnRpb25z
KCspLCAzMjQgZGVsZXRpb25zKC0pCj4gPgo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9kbWFidWYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9kbWFidWYuYwo+ID4gaW5kZXggODQ5OTJkNTkwZGE1Li5hNDRkNmQyZWY3ZWQgMTAw
NjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZG1hYnVmLmMK
PiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9kbWFidWYuYwo+ID4g
QEAgLTIyNSwzMyArMjI1LDI0IEBAIHN0cnVjdCBkbWFfYnVmICppOTE1X2dlbV9wcmltZV9leHBv
cnQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiA+ICAgICAgIHJldHVybiBkcm1fZ2VtX2RtYWJ1
Zl9leHBvcnQoZGV2LCAmZXhwX2luZm8pOwo+ID4gIH0KPiA+Cj4gPiAtc3RhdGljIGludCBpOTE1
X2dlbV9vYmplY3RfZ2V0X3BhZ2VzX2RtYWJ1ZihzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAq
b2JqKQo+ID4gK3N0YXRpYyBzdHJ1Y3Qgc2dfdGFibGUgKgo+ID4gK2RtYWJ1Zl9nZXRfcGFnZXMo
c3RydWN0IGk5MTVfZ2VtX29iamVjdF9nZXRfcGFnZXNfY29udGV4dCAqY3R4LAo+ID4gKyAgICAg
ICAgICAgICAgdW5zaWduZWQgaW50ICpzaXplcykKPiA+ICB7Cj4gPiAtICAgICBzdHJ1Y3Qgc2df
dGFibGUgKnBhZ2VzOwo+ID4gLSAgICAgdW5zaWduZWQgaW50IHNnX3BhZ2Vfc2l6ZXM7Cj4gPiAt
Cj4gPiAtICAgICBwYWdlcyA9IGRtYV9idWZfbWFwX2F0dGFjaG1lbnQob2JqLT5iYXNlLmltcG9y
dF9hdHRhY2gsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRE1BX0JJ
RElSRUNUSU9OQUwpOwo+ID4gLSAgICAgaWYgKElTX0VSUihwYWdlcykpCj4gPiAtICAgICAgICAg
ICAgIHJldHVybiBQVFJfRVJSKHBhZ2VzKTsKPiA+IC0KPiA+IC0gICAgIHNnX3BhZ2Vfc2l6ZXMg
PSBpOTE1X3NnX3BhZ2Vfc2l6ZXMocGFnZXMtPnNnbCk7Cj4gPiAtCj4gPiAtICAgICBfX2k5MTVf
Z2VtX29iamVjdF9zZXRfcGFnZXMob2JqLCBwYWdlcywgc2dfcGFnZV9zaXplcyk7Cj4gPiAtCj4g
PiAtICAgICByZXR1cm4gMDsKPiA+ICsgICAgIHJldHVybiBkbWFfYnVmX21hcF9hdHRhY2htZW50
KGN0eC0+b2JqZWN0LT5iYXNlLmltcG9ydF9hdHRhY2gsCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBETUFfQklESVJFQ1RJT05BTCk7Cj4gPiAgfQo+ID4KPiA+IC1zdGF0
aWMgdm9pZCBpOTE1X2dlbV9vYmplY3RfcHV0X3BhZ2VzX2RtYWJ1ZihzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHN0cnVjdCBzZ190YWJsZSAqcGFnZXMpCj4gPiArc3RhdGljIHZvaWQgZG1hYnVmX3B1
dF9wYWdlcyhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAo+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgc3RydWN0IHNnX3RhYmxlICpwYWdlcykKPiA+ICB7Cj4gPiAgICAgICBk
bWFfYnVmX3VubWFwX2F0dGFjaG1lbnQob2JqLT5iYXNlLmltcG9ydF9hdHRhY2gsIHBhZ2VzLAo+
ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERNQV9CSURJUkVDVElPTkFMKTsKPiA+
ICB9Cj4gPgo+ID4gIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdF9vcHMg
aTkxNV9nZW1fb2JqZWN0X2RtYWJ1Zl9vcHMgPSB7Cj4gPiAtICAgICAuZ2V0X3BhZ2VzID0gaTkx
NV9nZW1fb2JqZWN0X2dldF9wYWdlc19kbWFidWYsCj4gPiAtICAgICAucHV0X3BhZ2VzID0gaTkx
NV9nZW1fb2JqZWN0X3B1dF9wYWdlc19kbWFidWYsCj4gPiArICAgICAuZ2V0X3BhZ2VzID0gZG1h
YnVmX2dldF9wYWdlcywKPiA+ICsgICAgIC5wdXRfcGFnZXMgPSBkbWFidWZfcHV0X3BhZ2VzLAo+
ID4gIH07Cj4gPgo+ID4gIHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqaTkxNV9nZW1fcHJpbWVfaW1w
b3J0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKPiA+IGluZGV4IDQ0YmNiNjgxYzE2OC4uNjhmYWYx
YTcxYzk3IDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X2V4ZWNidWZmZXIuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X2V4ZWNidWZmZXIuYwo+ID4gQEAgLTE3ODQsOSArMTc4NCw2IEBAIHN0YXRpYyBub2lubGluZSBp
bnQgZWJfcmVsb2NhdGVfc2xvdyhzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYikKPiA+ICAgICAg
ICAgICAgICAgZ290byBvdXQ7Cj4gPiAgICAgICB9Cj4gPgo+ID4gLSAgICAgLyogQSBmcmVxdWVu
dCBjYXVzZSBmb3IgRUFHQUlOIGFyZSBjdXJyZW50bHkgdW5hdmFpbGFibGUgY2xpZW50IHBhZ2Vz
ICovCj4gPiAtICAgICBmbHVzaF93b3JrcXVldWUoZWItPmk5MTUtPm1tLnVzZXJwdHJfd3EpOwo+
ID4gLQo+ID4gICAgICAgZXJyID0gaTkxNV9tdXRleF9sb2NrX2ludGVycnVwdGlibGUoZGV2KTsK
PiA+ICAgICAgIGlmIChlcnIpIHsKPiA+ICAgICAgICAgICAgICAgbXV0ZXhfbG9jaygmZGV2LT5z
dHJ1Y3RfbXV0ZXgpOwo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9pbnRlcm5hbC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2lu
dGVybmFsLmMKPiA+IGluZGV4IDBjNDFlMDRhYjhmYS4uYWEwYmQ1ZGUzMTNiIDEwMDY0NAo+ID4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2ludGVybmFsLmMKPiA+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9pbnRlcm5hbC5jCj4gPiBAQCAt
MzIsMTEgKzMyLDE0IEBAIHN0YXRpYyB2b2lkIGludGVybmFsX2ZyZWVfcGFnZXMoc3RydWN0IHNn
X3RhYmxlICpzdCkKPiA+ICAgICAgIGtmcmVlKHN0KTsKPiA+ICB9Cj4gPgo+ID4gLXN0YXRpYyBp
bnQgaTkxNV9nZW1fb2JqZWN0X2dldF9wYWdlc19pbnRlcm5hbChzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdCAqb2JqKQo+ID4gK3N0YXRpYyBzdHJ1Y3Qgc2dfdGFibGUgKgo+ID4gK2ludGVybmFs
X2dldF9wYWdlcyhzdHJ1Y3QgaTkxNV9nZW1fb2JqZWN0X2dldF9wYWdlc19jb250ZXh0ICpjdHgs
Cj4gPiArICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCAqc2l6ZXMpCj4gPiAgewo+ID4gKyAg
ICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IGN0eC0+b2JqZWN0Owo+ID4gICAg
ICAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYp
Owo+ID4gLSAgICAgc3RydWN0IHNnX3RhYmxlICpzdDsKPiA+ICAgICAgIHN0cnVjdCBzY2F0dGVy
bGlzdCAqc2c7Cj4gPiArICAgICBzdHJ1Y3Qgc2dfdGFibGUgKnN0Owo+ID4gICAgICAgdW5zaWdu
ZWQgaW50IHNnX3BhZ2Vfc2l6ZXM7Cj4gPiAgICAgICB1bnNpZ25lZCBpbnQgbnBhZ2VzOwo+ID4g
ICAgICAgaW50IG1heF9vcmRlcjsKPiA+IEBAIC02NiwxMiArNjksMTIgQEAgc3RhdGljIGludCBp
OTE1X2dlbV9vYmplY3RfZ2V0X3BhZ2VzX2ludGVybmFsKHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpvYmopCj4gPiAgY3JlYXRlX3N0Ogo+ID4gICAgICAgc3QgPSBrbWFsbG9jKHNpemVvZigq
c3QpLCBHRlBfS0VSTkVMKTsKPiA+ICAgICAgIGlmICghc3QpCj4gPiAtICAgICAgICAgICAgIHJl
dHVybiAtRU5PTUVNOwo+ID4gKyAgICAgICAgICAgICByZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsK
PiA+Cj4gPiAgICAgICBucGFnZXMgPSBvYmotPmJhc2Uuc2l6ZSAvIFBBR0VfU0laRTsKPiA+ICAg
ICAgIGlmIChzZ19hbGxvY190YWJsZShzdCwgbnBhZ2VzLCBHRlBfS0VSTkVMKSkgewo+ID4gICAg
ICAgICAgICAgICBrZnJlZShzdCk7Cj4gPiAtICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwo+
ID4gKyAgICAgICAgICAgICByZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKPiA+ICAgICAgIH0KPiA+
Cj4gPiAgICAgICBzZyA9IHN0LT5zZ2w7Cj4gPiBAQCAtMTE3LDI3ICsxMjAsMjYgQEAgc3RhdGlj
IGludCBpOTE1X2dlbV9vYmplY3RfZ2V0X3BhZ2VzX2ludGVybmFsKHN0cnVjdCBkcm1faTkxNV9n
ZW1fb2JqZWN0ICpvYmopCj4gPiAgICAgICAgICAgICAgIGdvdG8gZXJyOwo+ID4gICAgICAgfQo+
ID4KPiA+IC0gICAgIC8qIE1hcmsgdGhlIHBhZ2VzIGFzIGRvbnRuZWVkIHdoaWxzdCB0aGV5IGFy
ZSBzdGlsbCBwaW5uZWQuIEFzIHNvb24KPiA+ICsgICAgIC8qCj4gPiArICAgICAgKiBNYXJrIHRo
ZSBwYWdlcyBhcyBkb250bmVlZCB3aGlsc3QgdGhleSBhcmUgc3RpbGwgcGlubmVkLiBBcyBzb29u
Cj4gPiAgICAgICAgKiBhcyB0aGV5IGFyZSB1bnBpbm5lZCB0aGV5IGFyZSBhbGxvd2VkIHRvIGJl
IHJlYXBlZCBieSB0aGUgc2hyaW5rZXIsCj4gPiAgICAgICAgKiBhbmQgdGhlIGNhbGxlciBpcyBl
eHBlY3RlZCB0byByZXBvcHVsYXRlIC0gdGhlIGNvbnRlbnRzIG9mIHRoaXMKPiA+ICAgICAgICAq
IG9iamVjdCBhcmUgb25seSB2YWxpZCB3aGlsc3QgYWN0aXZlIGFuZCBwaW5uZWQuCj4gPiAgICAg
ICAgKi8KPiA+ICAgICAgIG9iai0+bW0ubWFkdiA9IEk5MTVfTUFEVl9ET05UTkVFRDsKPiA+Cj4g
PiAtICAgICBfX2k5MTVfZ2VtX29iamVjdF9zZXRfcGFnZXMob2JqLCBzdCwgc2dfcGFnZV9zaXpl
cyk7Cj4gPiAtCj4gPiAtICAgICByZXR1cm4gMDsKPiA+ICsgICAgICpzaXplcyA9IHNnX3BhZ2Vf
c2l6ZXM7Cj4gPiArICAgICByZXR1cm4gc3Q7Cj4gPgo+ID4gIGVycjoKPiA+ICAgICAgIHNnX3Nl
dF9wYWdlKHNnLCBOVUxMLCAwLCAwKTsKPiA+ICAgICAgIHNnX21hcmtfZW5kKHNnKTsKPiA+ICAg
ICAgIGludGVybmFsX2ZyZWVfcGFnZXMoc3QpOwo+ID4gLQo+ID4gLSAgICAgcmV0dXJuIC1FTk9N
RU07Cj4gPiArICAgICByZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKPiA+ICB9Cj4gPgo+ID4gLXN0
YXRpYyB2b2lkIGk5MTVfZ2VtX29iamVjdF9wdXRfcGFnZXNfaW50ZXJuYWwoc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgKm9iaiwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHN0cnVjdCBzZ190YWJsZSAqcGFnZXMpCj4gPiArc3RhdGljIHZvaWQgaW50
ZXJuYWxfcHV0X3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCj4gPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBzZ190YWJsZSAqcGFnZXMpCj4gPiAgewo+
ID4gICAgICAgaTkxNV9nZW1fZ3R0X2ZpbmlzaF9wYWdlcyhvYmosIHBhZ2VzKTsKPiA+ICAgICAg
IGludGVybmFsX2ZyZWVfcGFnZXMocGFnZXMpOwo+ID4gQEAgLTE0OSw4ICsxNTEsOCBAQCBzdGF0
aWMgdm9pZCBpOTE1X2dlbV9vYmplY3RfcHV0X3BhZ2VzX2ludGVybmFsKHN0cnVjdCBkcm1faTkx
NV9nZW1fb2JqZWN0ICpvYmosCj4gPiAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0X29wcyBpOTE1X2dlbV9vYmplY3RfaW50ZXJuYWxfb3BzID0gewo+ID4gICAgICAgLmZs
YWdzID0gSTkxNV9HRU1fT0JKRUNUX0hBU19TVFJVQ1RfUEFHRSB8Cj4gPiAgICAgICAgICAgICAg
ICBJOTE1X0dFTV9PQkpFQ1RfSVNfU0hSSU5LQUJMRSwKPiA+IC0gICAgIC5nZXRfcGFnZXMgPSBp
OTE1X2dlbV9vYmplY3RfZ2V0X3BhZ2VzX2ludGVybmFsLAo+ID4gLSAgICAgLnB1dF9wYWdlcyA9
IGk5MTVfZ2VtX29iamVjdF9wdXRfcGFnZXNfaW50ZXJuYWwsCj4gPiArICAgICAuZ2V0X3BhZ2Vz
ID0gaW50ZXJuYWxfZ2V0X3BhZ2VzLAo+ID4gKyAgICAgLnB1dF9wYWdlcyA9IGludGVybmFsX3B1
dF9wYWdlcywKPiA+ICB9Owo+ID4KPiA+ICAvKioKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X3R5cGVzLmgKPiA+IGluZGV4IGY3OTI5NTNiOGE3MS4u
MGVhNDA0Y2ZiYzFjIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5
MTVfZ2VtX29iamVjdF90eXBlcy5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fb2JqZWN0X3R5cGVzLmgKPiA+IEBAIC0xOSw2ICsxOSw3IEBACj4gPgo+ID4gIHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0Owo+ID4gIHN0cnVjdCBpbnRlbF9mcm9uYnVmZmVyOwo+
ID4gK3N0cnVjdCB0YXNrX3N0cnVjdDsKPiA+Cj4gPiAgLyoKPiA+ICAgKiBzdHJ1Y3QgaTkxNV9s
dXRfaGFuZGxlIHRyYWNrcyB0aGUgZmFzdCBsb29rdXBzIGZyb20gaGFuZGxlIHRvIHZtYSB1c2Vk
Cj4gPiBAQCAtMzIsNiArMzMsMTEgQEAgc3RydWN0IGk5MTVfbHV0X2hhbmRsZSB7Cj4gPiAgICAg
ICB1MzIgaGFuZGxlOwo+ID4gIH07Cj4gPgo+ID4gK3N0cnVjdCBpOTE1X2dlbV9vYmplY3RfZ2V0
X3BhZ2VzX2NvbnRleHQgIHsKPiA+ICsgICAgIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpv
YmplY3Q7Cj4gPiArICAgICBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2s7Cj4gPiArfTsKPiA+ICsK
PiA+ICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdF9vcHMgewo+ID4gICAgICAgdW5zaWduZWQg
aW50IGZsYWdzOwo+ID4gICNkZWZpbmUgSTkxNV9HRU1fT0JKRUNUX0hBU19TVFJVQ1RfUEFHRSAg
ICAgIEJJVCgwKQo+ID4gQEAgLTUyLDkgKzU4LDExIEBAIHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0X29wcyB7Cj4gPiAgICAgICAgKiBiZWluZyByZWxlYXNlZCBvciB1bmRlciBtZW1vcnkgcHJl
c3N1cmUgKHdoZXJlIHdlIGF0dGVtcHQgdG8KPiA+ICAgICAgICAqIHJlYXAgcGFnZXMgZm9yIHRo
ZSBzaHJpbmtlcikuCj4gPiAgICAgICAgKi8KPiA+IC0gICAgIGludCAoKmdldF9wYWdlcykoc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaik7Cj4gPiArICAgICBzdHJ1Y3Qgc2dfdGFibGUg
KigqZ2V0X3BhZ2VzKShzdHJ1Y3QgaTkxNV9nZW1fb2JqZWN0X2dldF9wYWdlc19jb250ZXh0ICpj
dHgsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQg
KnNpemVzKTsKPiA+ICAgICAgIHZvaWQgKCpwdXRfcGFnZXMpKHN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICpvYmosCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2dfdGFibGUg
KnBhZ2VzKTsKPiA+ICsKPiA+ICAgICAgIHZvaWQgKCp0cnVuY2F0ZSkoc3RydWN0IGRybV9pOTE1
X2dlbV9vYmplY3QgKm9iaik7Cj4gPiAgICAgICB2b2lkICgqd3JpdGViYWNrKShzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqb2JqKTsKPiA+Cj4gPiBAQCAtMjUyLDcgKzI2MCw2IEBAIHN0cnVj
dCBkcm1faTkxNV9nZW1fb2JqZWN0IHsKPiA+Cj4gPiAgICAgICAgICAgICAgICAgICAgICAgc3Ry
dWN0IGk5MTVfbW1fc3RydWN0ICptbTsKPiA+ICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
aTkxNV9tbXVfb2JqZWN0ICptbXVfb2JqZWN0Owo+ID4gLSAgICAgICAgICAgICAgICAgICAgIHN0
cnVjdCB3b3JrX3N0cnVjdCAqd29yazsKPiA+ICAgICAgICAgICAgICAgfSB1c2VycHRyOwo+ID4K
PiA+ICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBzY3JhdGNoOwo+ID4gZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wYWdlcy5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BhZ2VzLmMKPiA+IGluZGV4IDZiZWMzMDFjZWU3OS4uZjY1
YTk4MzI0OGM2IDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX3BhZ2VzLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9w
YWdlcy5jCj4gPiBAQCAtOCwxNiArOCw0OSBAQAo+ID4gICNpbmNsdWRlICJpOTE1X2dlbV9vYmpl
Y3QuaCIKPiA+ICAjaW5jbHVkZSAiaTkxNV9zY2F0dGVybGlzdC5oIgo+ID4KPiA+IC12b2lkIF9f
aTkxNV9nZW1fb2JqZWN0X3NldF9wYWdlcyhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2Jq
LAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBzZ190YWJsZSAqcGFn
ZXMsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IHNnX3Bh
Z2Vfc2l6ZXMpCj4gPiArc3RhdGljIERFRklORV9TUElOTE9DSyhmZW5jZV9sb2NrKTsKPiA+ICsK
PiA+ICtzdHJ1Y3QgZ2V0X3BhZ2VzX3dvcmsgewo+ID4gKyAgICAgc3RydWN0IGRtYV9mZW5jZSBk
bWE7IC8qIE11c3QgYmUgZmlyc3QgZm9yIGRtYV9mZW5jZV9mcmVlKCkgKi8KPiA+ICsgICAgIHN0
cnVjdCBpOTE1X3N3X2ZlbmNlIHdhaXQ7Cj4gPiArICAgICBzdHJ1Y3Qgd29ya19zdHJ1Y3Qgd29y
azsKPiA+ICsgICAgIHN0cnVjdCBpOTE1X2dlbV9vYmplY3RfZ2V0X3BhZ2VzX2NvbnRleHQgY3R4
Owo+ID4gK307Cj4gPiArCj4gPiArc3RhdGljIGNvbnN0IGNoYXIgKmdldF9wYWdlc193b3JrX2Ry
aXZlcl9uYW1lKHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlKQo+ID4gK3sKPiA+ICsgICAgIHJldHVy
biBEUklWRVJfTkFNRTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGNvbnN0IGNoYXIgKmdldF9w
YWdlc193b3JrX3RpbWVsaW5lX25hbWUoc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpCj4gPiArewo+
ID4gKyAgICAgcmV0dXJuICJhbGxvY2F0aW9uIjsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHZv
aWQgZ2V0X3BhZ2VzX3dvcmtfcmVsZWFzZShzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSkKPiA+ICt7
Cj4gPiArICAgICBzdHJ1Y3QgZ2V0X3BhZ2VzX3dvcmsgKncgPSBjb250YWluZXJfb2YoZmVuY2Us
IHR5cGVvZigqdyksIGRtYSk7Cj4gPiArCj4gPiArICAgICBpOTE1X3N3X2ZlbmNlX2ZpbmkoJnct
PndhaXQpOwo+ID4gKwo+ID4gKyAgICAgQlVJTERfQlVHX09OKG9mZnNldG9mKHR5cGVvZigqdyks
IGRtYSkpOwo+ID4gKyAgICAgZG1hX2ZlbmNlX2ZyZWUoJnctPmRtYSk7Cj4gPiArfQo+ID4gKwo+
ID4gK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZG1hX2ZlbmNlX29wcyBnZXRfcGFnZXNfd29ya19vcHMg
PSB7Cj4gPiArICAgICAuZ2V0X2RyaXZlcl9uYW1lID0gZ2V0X3BhZ2VzX3dvcmtfZHJpdmVyX25h
bWUsCj4gPiArICAgICAuZ2V0X3RpbWVsaW5lX25hbWUgPSBnZXRfcGFnZXNfd29ya190aW1lbGlu
ZV9uYW1lLAo+ID4gKyAgICAgLnJlbGVhc2UgPSBnZXRfcGFnZXNfd29ya19yZWxlYXNlLAo+ID4g
K307Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgX19zZXRfcGFnZXMoc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm9iaiwKPiA+ICsgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2dfdGFibGUg
KnBhZ2VzLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBzZ19wYWdlX3Np
emVzKQo+ID4gIHsKPiA+ICAgICAgIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShvYmotPmJhc2UuZGV2KTsKPiA+ICAgICAgIHVuc2lnbmVkIGxvbmcgc3VwcG9ydGVkID0g
SU5URUxfSU5GTyhpOTE1KS0+cGFnZV9zaXplczsKPiA+ICAgICAgIGludCBpOwo+ID4KPiA+IC0g
ICAgIGxvY2tkZXBfYXNzZXJ0X2hlbGQoJm9iai0+bW0ubG9jayk7Cj4gPiAtCj4gPiAgICAgICAv
KiBNYWtlIHRoZSBwYWdlcyBjb2hlcmVudCB3aXRoIHRoZSBHUFUgKGZsdXNoaW5nIGFueSBzd2Fw
aW4pLiAqLwo+ID4gICAgICAgaWYgKG9iai0+Y2FjaGVfZGlydHkpIHsKPiA+ICAgICAgICAgICAg
ICAgb2JqLT53cml0ZV9kb21haW4gPSAwOwo+ID4gQEAgLTI5LDggKzYyLDYgQEAgdm9pZCBfX2k5
MTVfZ2VtX29iamVjdF9zZXRfcGFnZXMoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwK
PiA+ICAgICAgIG9iai0+bW0uZ2V0X3BhZ2Uuc2dfcG9zID0gcGFnZXMtPnNnbDsKPiA+ICAgICAg
IG9iai0+bW0uZ2V0X3BhZ2Uuc2dfaWR4ID0gMDsKPiA+Cj4gPiAtICAgICBvYmotPm1tLnBhZ2Vz
ID0gcGFnZXM7Cj4gPiAtCj4gPiAgICAgICBpZiAoaTkxNV9nZW1fb2JqZWN0X2lzX3RpbGVkKG9i
aikgJiYKPiA+ICAgICAgICAgICBpOTE1LT5xdWlya3MgJiBRVUlSS19QSU5fU1dJWlpMRURfUEFH
RVMpIHsKPiA+ICAgICAgICAgICAgICAgR0VNX0JVR19PTihvYmotPm1tLnF1aXJrZWQpOwo+ID4g
QEAgLTM4LDcgKzY5LDggQEAgdm9pZCBfX2k5MTVfZ2VtX29iamVjdF9zZXRfcGFnZXMoc3RydWN0
IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiA+ICAgICAgICAgICAgICAgb2JqLT5tbS5xdWly
a2VkID0gdHJ1ZTsKPiA+ICAgICAgIH0KPiA+Cj4gPiAtICAgICBHRU1fQlVHX09OKCFzZ19wYWdl
X3NpemVzKTsKPiA+ICsgICAgIGlmICghc2dfcGFnZV9zaXplcykKPiA+ICsgICAgICAgICAgICAg
c2dfcGFnZV9zaXplcyA9IGk5MTVfc2dfcGFnZV9zaXplcyhwYWdlcy0+c2dsKTsKPiA+ICAgICAg
IG9iai0+bW0ucGFnZV9zaXplcy5waHlzID0gc2dfcGFnZV9zaXplczsKPiA+Cj4gPiAgICAgICAv
Kgo+ID4gQEAgLTczLDE4ICsxMDUsMTA1IEBAIHZvaWQgX19pOTE1X2dlbV9vYmplY3Rfc2V0X3Bh
Z2VzKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCj4gPgo+ID4gICAgICAgICAgICAg
ICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT5tbS5vYmpfbG9jaywgZmxhZ3MpOwo+ID4g
ICAgICAgfQo+ID4gK30KPiA+Cj4gPiArc3RhdGljIHZvaWQKPiA+ICtnZXRfcGFnZXNfd29ya2Vy
KHN0cnVjdCB3b3JrX3N0cnVjdCAqX3dvcmspCj4gPiArewo+ID4gKyAgICAgc3RydWN0IGdldF9w
YWdlc193b3JrICp3b3JrID0gY29udGFpbmVyX29mKF93b3JrLCB0eXBlb2YoKndvcmspLCB3b3Jr
KTsKPiA+ICsgICAgIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSB3b3JrLT5jdHgu
b2JqZWN0Owo+ID4gKyAgICAgc3RydWN0IHNnX3RhYmxlICpwYWdlczsKPiA+ICsgICAgIHVuc2ln
bmVkIGludCBzaXplcyA9IDA7Cj4gPiArCj4gPiArICAgICBpZiAoIXdvcmstPmRtYS5lcnJvcikg
ewo+ID4gKyAgICAgICAgICAgICBwYWdlcyA9IG9iai0+b3BzLT5nZXRfcGFnZXMoJndvcmstPmN0
eCwgJnNpemVzKTsKPiA+ICsgICAgICAgICAgICAgaWYgKCFJU19FUlIocGFnZXMpKQo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgIF9fc2V0X3BhZ2VzKG9iaiwgcGFnZXMsIHNpemVzKTsKPiA+ICsg
ICAgICAgICAgICAgZWxzZQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGRtYV9mZW5jZV9zZXRf
ZXJyb3IoJndvcmstPmRtYSwgUFRSX0VSUihwYWdlcykpOwo+ID4gKyAgICAgfSBlbHNlIHsKPiA+
ICsgICAgICAgICAgICAgcGFnZXMgPSBFUlJfUFRSKHdvcmstPmRtYS5lcnJvcik7Cj4gPiArICAg
ICB9Cj4gPiArCj4gPiArICAgICBvYmotPm1tLnBhZ2VzID0gcGFnZXM7Cj4gPiAgICAgICBjb21w
bGV0ZV9hbGwoJm9iai0+bW0uY29tcGxldGlvbik7Cj4gPiArICAgICBhdG9taWNfZGVjKCZvYmot
Pm1tLnBhZ2VzX3Bpbl9jb3VudCk7Cj4gPiArCj4gPiArICAgICBpOTE1X2dlbV9vYmplY3RfcHV0
KG9iaik7Cj4gPiArICAgICBwdXRfdGFza19zdHJ1Y3Qod29yay0+Y3R4LnRhc2spOwo+ID4gKwo+
ID4gKyAgICAgZG1hX2ZlbmNlX3NpZ25hbCgmd29yay0+ZG1hKTsKPiA+ICsgICAgIGRtYV9mZW5j
ZV9wdXQoJndvcmstPmRtYSk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgX19pOTE1X3N3
X2ZlbmNlX2NhbGwKPiA+ICtnZXRfcGFnZXNfbm90aWZ5KHN0cnVjdCBpOTE1X3N3X2ZlbmNlICpm
ZW5jZSwgZW51bSBpOTE1X3N3X2ZlbmNlX25vdGlmeSBzdGF0ZSkKPiA+ICt7Cj4gPiArICAgICBz
dHJ1Y3QgZ2V0X3BhZ2VzX3dvcmsgKncgPSBjb250YWluZXJfb2YoZmVuY2UsIHR5cGVvZigqdyks
IHdhaXQpOwo+ID4gKwo+ID4gKyAgICAgc3dpdGNoIChzdGF0ZSkgewo+ID4gKyAgICAgY2FzZSBG
RU5DRV9DT01QTEVURToKPiA+ICsgICAgICAgICAgICAgaWYgKGZlbmNlLT5lcnJvcikKPiA+ICsg
ICAgICAgICAgICAgICAgICAgICBkbWFfZmVuY2Vfc2V0X2Vycm9yKCZ3LT5kbWEsIGZlbmNlLT5l
cnJvcik7Cj4gPiArICAgICAgICAgICAgIHF1ZXVlX3dvcmsoc3lzdGVtX3VuYm91bmRfd3EsICZ3
LT53b3JrKTsKPiA+ICsgICAgICAgICAgICAgYnJlYWs7Cj4gPiArCj4gPiArICAgICBjYXNlIEZF
TkNFX0ZSRUU6Cj4gPiArICAgICAgICAgICAgIGRtYV9mZW5jZV9wdXQoJnctPmRtYSk7Cj4gPiAr
ICAgICAgICAgICAgIGJyZWFrOwo+ID4gKyAgICAgfQo+ID4gKwo+ID4gKyAgICAgcmV0dXJuIE5P
VElGWV9ET05FOwo+ID4gIH0KPiA+Cj4gPiAgaW50IF9fX19pOTE1X2dlbV9vYmplY3RfZ2V0X3Bh
Z2VzKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCj4gPiAgewo+ID4gKyAgICAgc3Ry
dWN0IGdldF9wYWdlc193b3JrICp3b3JrOwo+ID4gKyAgICAgaW50IGVycjsKPiA+ICsKPiA+ICAg
ICAgIGlmICh1bmxpa2VseShvYmotPm1tLm1hZHYgIT0gSTkxNV9NQURWX1dJTExORUVEKSkgewo+
ID4gICAgICAgICAgICAgICBEUk1fREVCVUcoIkF0dGVtcHRpbmcgdG8gb2J0YWluIGEgcHVyZ2Vh
YmxlIG9iamVjdFxuIik7Cj4gPiAgICAgICAgICAgICAgIHJldHVybiAtRUZBVUxUOwo+ID4gICAg
ICAgfQo+ID4KPiA+IC0gICAgIHJldHVybiBvYmotPm9wcy0+Z2V0X3BhZ2VzKG9iaik7Cj4gPiAr
ICAgICAvKiBYWFggaW5saW5lPyAqLwo+ID4gKwo+ID4gKyAgICAgd29yayA9IGttYWxsb2Moc2l6
ZW9mKCp3b3JrKSwgR0ZQX0tFUk5FTCk7Cj4gPiArICAgICBpZiAoIXdvcmspCj4gPiArICAgICAg
ICAgICAgIHJldHVybiAtRU5PTUVNOwo+ID4gKwo+ID4gKyAgICAgZG1hX2ZlbmNlX2luaXQoJndv
cmstPmRtYSwKPiA+ICsgICAgICAgICAgICAgICAgICAgICZnZXRfcGFnZXNfd29ya19vcHMsCj4g
PiArICAgICAgICAgICAgICAgICAgICAmZmVuY2VfbG9jaywKPiA+ICsgICAgICAgICAgICAgICAg
ICAgIHRvX2k5MTUob2JqLT5iYXNlLmRldiktPm1tLnVub3JkZXJlZF90aW1lbGluZSwKPiA+ICsg
ICAgICAgICAgICAgICAgICAgIDApOwo+Cj4gV2l0aCBhbGwgdGhlIHNocmlua2VycyAoYWNyb3Nz
IHRoZSB0cmVlLCBub3QganVzdCBpOTE1KSB3ZSBoYXZlIHRoYXQganVzdAo+IGJsaW5kbHkgYXNz
dW1lIHlvdSBjYW4gd2FpdCBmb3IgYSBmZW5jZSAoYXQgbGVhc3QgaWYgeW91IG1hbmFnZSB0byBh
Y3F1aXJlCj4gdGhlIHJlc2VydmF0aW9uX2xvY2spIEkgZXhwZWN0IHRoaXMgdG8gZGVhZGxvY2su
IEkgdGhpbmsgdGhlIHJ1bGUgaXMgdGhhdAo+IG5vIHB1Ymxpc2hlZCBmZW5jZSBjYW4gZGVwZW5k
IG9uIGFueSBtZW1vcnkgYWxsb2NhdGlvbiBhbnl3aGVyZS4KPgo+IFllcyBpdCBzdWNrcyByZWFs
IGhhcmQuCj4KPiA+ICsgICAgIGk5MTVfc3dfZmVuY2VfaW5pdCgmd29yay0+d2FpdCwgZ2V0X3Bh
Z2VzX25vdGlmeSk7Cj4gPiArCj4gPiArICAgICB3b3JrLT5jdHgub2JqZWN0ID0gaTkxNV9nZW1f
b2JqZWN0X2dldChvYmopOwo+ID4gKwo+ID4gKyAgICAgd29yay0+Y3R4LnRhc2sgPSBjdXJyZW50
Owo+ID4gKyAgICAgZ2V0X3Rhc2tfc3RydWN0KHdvcmstPmN0eC50YXNrKTsKPiA+ICsKPiA+ICsg
ICAgIElOSVRfV09SSygmd29yay0+d29yaywgZ2V0X3BhZ2VzX3dvcmtlcik7Cj4gPiArCj4gPiAr
ICAgICBpOTE1X2dlbV9vYmplY3RfbG9jayhvYmopOwo+Cj4gT3RoZXIgYml0IGlzIG5lc3Rpbmcg
cmVzZXJ2YXRpb25fb2JqZWN0IGxvY2sgd2l0aGluIG9iai0+bW0ubG9jay4KPgo+IG9iai0+bW0u
bG9jayBpcyBhIHZlcnkgbmVhdCZ0aWR5IGFuc3dlciB0byBkZWFsaW5nIHdpdGggYm8gYWxsb2Mg
dnMuCj4gc2hyaW5rZXIgbWFkbmVzcy4gQnV0IGxvb2tpbmcgYXQgd2hlcmUgZG1hLWJ1ZiBpcyBo
ZWFkZWQgd2UnbGwgbmVlZCB0bwo+IGhhdmUgdGhlIHJlc2VydmF0aW9uX29iamVjdCBuZXN0IG91
dHNpZGUgb2YgdGhlIG9iai0+bW0ubG9jayAoYmVjYXVzZSB0aGUKPiBpbXBvcnRlciBpcyBnb2lu
ZyB0byBhY3F1aXJlIHRoYXQgZm9yIHVzLCBiZWZvcmUgY2FsbGluZyBkb3duIGludG8KPiBleHBv
cnRlciBjb2RlKS4KPgo+IE9mIGNvdXJzZSBvbiB0aGUgaW1wb3J0ZXIgc2lkZSB3ZSdyZSBjdXJy
ZW50bHkgbmVzdGluZyB0aGUgb3RoZXIgd2F5Cj4gcm91bmQsIGFuZCBDaHJpc3RpYW4gS8O2bmln
IGFscmVhZHkgc2V0IENJIG9uIGZpcmUgZmlndXJpbmcgdGhhdCBvdXQuCj4KPiBJIHRoaW5rIHdo
YXQgY291bGQgd29yayBpcyBwdWxsaW5nIHRoZSByZXNlcnZhdGlvbl9vYmplY3Qgb3V0IG9mCj4g
b2JqLT5tbS5sb2NrLCBhbmQgZW50aXJlbHkgYnlwYXNzaW5nIGl0IGZvciBpbXBvcnRlZCBkbWEt
YnVmIChzaW5jZSBmb3IKPiB0aGF0IGNhc2UgZGVhbGluZyB3aXRoIHNocmlua2VyIGxvbHogaXNu
J3Qgb3VyIHByb2JsZW0sIGJ1dCB0aGUgZXhwb3J0ZXJzLAo+IHNvIHdlIGRvbid0IG5lZWQgdGhl
IHNwZWNpYWwgc2hyaW5rZXIgbG9jaykuCj4KPiAzcmQgcGFydCBpcyBqdXN0IGlycmF0aW9uYWwg
bWUgZnJlYWtpbmcgb3V0IHdoZW4gd2UgaGlkZSB1c2VycHRyIGJlaGluZCBhCj4gd2FpdF9jb21w
bGV0aW9uLCB0aGF0IGRpZG4ndCB3b3JrIG91dCB3ZWxsIGxhc3QgdGltZSBhcm91bmQgYmVjYXVz
ZQo+IGxvY2tkZXAgZmFpbHMgdXMuIEJ1dCB0aGF0J3MgcmVhbGx5IGp1c3QgYW4gYXNpZGUuCj4g
LURhbmllbAo+Cj4gPiArICAgICBHRU1fQlVHX09OKCFyZXNlcnZhdGlvbl9vYmplY3RfdGVzdF9z
aWduYWxlZF9yY3Uob2JqLT5yZXN2LCB0cnVlKSk7Cj4gPiArICAgICBlcnIgPSBpOTE1X3N3X2Zl
bmNlX2F3YWl0X3Jlc2VydmF0aW9uKCZ3b3JrLT53YWl0LAo+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBvYmotPnJlc3YsIE5VTEwsCj4gPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWUsIEk5MTVfRkVOQ0VfVElNRU9V
VCwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSTkxNV9G
RU5DRV9HRlApOwo+ID4gKyAgICAgaWYgKGVyciA9PSAwKSB7Cj4gPiArICAgICAgICAgICAgIHJl
c2VydmF0aW9uX29iamVjdF9hZGRfZXhjbF9mZW5jZShvYmotPnJlc3YsICZ3b3JrLT5kbWEpOwo+
ID4gKyAgICAgICAgICAgICBhdG9taWNfaW5jKCZvYmotPm1tLnBhZ2VzX3Bpbl9jb3VudCk7Cj4g
PiArICAgICB9IGVsc2Ugewo+ID4gKyAgICAgICAgICAgICBkbWFfZmVuY2Vfc2V0X2Vycm9yKCZ3
b3JrLT5kbWEsIGVycik7Cj4gPiArICAgICB9Cj4gPiArICAgICBpOTE1X2dlbV9vYmplY3RfdW5s
b2NrKG9iaik7Cj4gPiArCj4gPiArICAgICBkbWFfZmVuY2VfZ2V0KCZ3b3JrLT5kbWEpOwo+ID4g
KyAgICAgaTkxNV9zd19mZW5jZV9jb21taXQoJndvcmstPndhaXQpOwo+ID4gKwo+ID4gKyAgICAg
cmV0dXJuIGVycjsKPiA+ICB9Cj4gPgo+ID4gIC8qIEVuc3VyZSB0aGF0IHRoZSBhc3NvY2lhdGVk
IHBhZ2VzIGFyZSBnYXRoZXJlZCBmcm9tIHRoZSBiYWNraW5nIHN0b3JhZ2UKPiA+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcGh5cy5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BoeXMuYwo+ID4gaW5kZXggMmRlYWM5MzNjZjU5Li42
YjRhNWZiNTIwNTUgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fcGh5cy5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
cGh5cy5jCj4gPiBAQCAtMTcsMTggKzE3LDIxIEBACj4gPiAgI2luY2x1ZGUgImk5MTVfZ2VtX29i
amVjdC5oIgo+ID4gICNpbmNsdWRlICJpOTE1X3NjYXR0ZXJsaXN0LmgiCj4gPgo+ID4gLXN0YXRp
YyBpbnQgaTkxNV9nZW1fb2JqZWN0X2dldF9wYWdlc19waHlzKHN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICpvYmopCj4gPiArc3RhdGljIHN0cnVjdCBzZ190YWJsZSAqCj4gPiArcGh5c19nZXRf
cGFnZXMoc3RydWN0IGk5MTVfZ2VtX29iamVjdF9nZXRfcGFnZXNfY29udGV4dCAqY3R4LAo+ID4g
KyAgICAgICAgICAgIHVuc2lnbmVkIGludCAqc2l6ZXMpCj4gPiAgewo+ID4gKyAgICAgc3RydWN0
IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IGN0eC0+b2JqZWN0Owo+ID4gICAgICAgc3RydWN0
IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcgPSBvYmotPmJhc2UuZmlscC0+Zl9tYXBwaW5nOwo+ID4g
ICAgICAgc3RydWN0IGRybV9kbWFfaGFuZGxlICpwaHlzOwo+ID4gLSAgICAgc3RydWN0IHNnX3Rh
YmxlICpzdDsKPiA+ICAgICAgIHN0cnVjdCBzY2F0dGVybGlzdCAqc2c7Cj4gPiArICAgICBzdHJ1
Y3Qgc2dfdGFibGUgKnN0Owo+ID4gICAgICAgY2hhciAqdmFkZHI7Cj4gPiAgICAgICBpbnQgaTsK
PiA+ICAgICAgIGludCBlcnI7Cj4gPgo+ID4gICAgICAgaWYgKFdBUk5fT04oaTkxNV9nZW1fb2Jq
ZWN0X25lZWRzX2JpdDE3X3N3aXp6bGUob2JqKSkpCj4gPiAtICAgICAgICAgICAgIHJldHVybiAt
RUlOVkFMOwo+ID4gKyAgICAgICAgICAgICByZXR1cm4gRVJSX1BUUigtRUlOVkFMKTsKPiA+Cj4g
PiAgICAgICAvKiBBbHdheXMgYWxpZ25pbmcgdG8gdGhlIG9iamVjdCBzaXplLCBhbGxvd3MgYSBz
aW5nbGUgYWxsb2NhdGlvbgo+ID4gICAgICAgICogdG8gaGFuZGxlIGFsbCBwb3NzaWJsZSBjYWxs
ZXJzLCBhbmQgZ2l2ZW4gdHlwaWNhbCBvYmplY3Qgc2l6ZXMsCj4gPiBAQCAtMzgsNyArNDEsNyBA
QCBzdGF0aWMgaW50IGk5MTVfZ2VtX29iamVjdF9nZXRfcGFnZXNfcGh5cyhzdHJ1Y3QgZHJtX2k5
MTVfZ2VtX29iamVjdCAqb2JqKQo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91bmR1
cF9wb3dfb2ZfdHdvKG9iai0+YmFzZS5zaXplKSwKPiA+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHJvdW5kdXBfcG93X29mX3R3byhvYmotPmJhc2Uuc2l6ZSkpOwo+ID4gICAgICAgaWYgKCFw
aHlzKQo+ID4gLSAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKPiA+ICsgICAgICAgICAgICAg
cmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7Cj4gPgo+ID4gICAgICAgdmFkZHIgPSBwaHlzLT52YWRk
cjsKPiA+ICAgICAgIGZvciAoaSA9IDA7IGkgPCBvYmotPmJhc2Uuc2l6ZSAvIFBBR0VfU0laRTsg
aSsrKSB7Cj4gPiBAQCAtODMsMTkgKzg2LDE2IEBAIHN0YXRpYyBpbnQgaTkxNV9nZW1fb2JqZWN0
X2dldF9wYWdlc19waHlzKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCj4gPgo+ID4g
ICAgICAgb2JqLT5waHlzX2hhbmRsZSA9IHBoeXM7Cj4gPgo+ID4gLSAgICAgX19pOTE1X2dlbV9v
YmplY3Rfc2V0X3BhZ2VzKG9iaiwgc3QsIHNnLT5sZW5ndGgpOwo+ID4gLQo+ID4gLSAgICAgcmV0
dXJuIDA7Cj4gPiArICAgICAqc2l6ZXMgPSBzZy0+bGVuZ3RoOwo+ID4gKyAgICAgcmV0dXJuIHN0
Owo+ID4KPiA+ICBlcnJfcGh5czoKPiA+ICAgICAgIGRybV9wY2lfZnJlZShvYmotPmJhc2UuZGV2
LCBwaHlzKTsKPiA+IC0KPiA+IC0gICAgIHJldHVybiBlcnI7Cj4gPiArICAgICByZXR1cm4gRVJS
X1BUUihlcnIpOwo+ID4gIH0KPiA+Cj4gPiAgc3RhdGljIHZvaWQKPiA+IC1pOTE1X2dlbV9vYmpl
Y3RfcHV0X3BhZ2VzX3BoeXMoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiA+IC0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNnX3RhYmxlICpwYWdlcykKPiA+ICtw
aHlzX3B1dF9wYWdlcyhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLCBzdHJ1Y3Qgc2df
dGFibGUgKnBhZ2VzKQo+ID4gIHsKPiA+ICAgICAgIF9faTkxNV9nZW1fb2JqZWN0X3JlbGVhc2Vf
c2htZW0ob2JqLCBwYWdlcywgZmFsc2UpOwo+ID4KPiA+IEBAIC0xMzksOCArMTM5LDggQEAgaTkx
NV9nZW1fb2JqZWN0X3JlbGVhc2VfcGh5cyhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2Jq
KQo+ID4gIH0KPiA+Cj4gPiAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0
X29wcyBpOTE1X2dlbV9waHlzX29wcyA9IHsKPiA+IC0gICAgIC5nZXRfcGFnZXMgPSBpOTE1X2dl
bV9vYmplY3RfZ2V0X3BhZ2VzX3BoeXMsCj4gPiAtICAgICAucHV0X3BhZ2VzID0gaTkxNV9nZW1f
b2JqZWN0X3B1dF9wYWdlc19waHlzLAo+ID4gKyAgICAgLmdldF9wYWdlcyA9IHBoeXNfZ2V0X3Bh
Z2VzLAo+ID4gKyAgICAgLnB1dF9wYWdlcyA9IHBoeXNfcHV0X3BhZ2VzLAo+ID4gICAgICAgLnJl
bGVhc2UgPSBpOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9waHlzLAo+ID4gIH07Cj4gPgo+ID4gQEAg
LTE5MywxNSArMTkzLDEyIEBAIGludCBpOTE1X2dlbV9vYmplY3RfYXR0YWNoX3BoeXMoc3RydWN0
IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwgaW50IGFsaWduKQo+ID4gICAgICAgaWYgKCFJU19F
UlJfT1JfTlVMTChwYWdlcykpCj4gPiAgICAgICAgICAgICAgIGk5MTVfZ2VtX3NobWVtX29wcy5w
dXRfcGFnZXMob2JqLCBwYWdlcyk7Cj4gPiAgICAgICBtdXRleF91bmxvY2soJm9iai0+bW0ubG9j
ayk7Cj4gPiArCj4gPiArICAgICB3YWl0X2Zvcl9jb21wbGV0aW9uKCZvYmotPm1tLmNvbXBsZXRp
b24pOwo+ID4gICAgICAgcmV0dXJuIDA7Cj4gPgo+ID4gIGVycl94ZmVyOgo+ID4gICAgICAgb2Jq
LT5vcHMgPSAmaTkxNV9nZW1fc2htZW1fb3BzOwo+ID4gLSAgICAgaWYgKCFJU19FUlJfT1JfTlVM
TChwYWdlcykpIHsKPiA+IC0gICAgICAgICAgICAgdW5zaWduZWQgaW50IHNnX3BhZ2Vfc2l6ZXMg
PSBpOTE1X3NnX3BhZ2Vfc2l6ZXMocGFnZXMtPnNnbCk7Cj4gPiAtCj4gPiAtICAgICAgICAgICAg
IF9faTkxNV9nZW1fb2JqZWN0X3NldF9wYWdlcyhvYmosIHBhZ2VzLCBzZ19wYWdlX3NpemVzKTsK
PiA+IC0gICAgIH0KPiA+ICBlcnJfdW5sb2NrOgo+ID4gICAgICAgbXV0ZXhfdW5sb2NrKCZvYmot
Pm1tLmxvY2spOwo+ID4gICAgICAgcmV0dXJuIGVycjsKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fc2htZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9zaG1lbS5jCj4gPiBpbmRleCAxOWQ5ZWNkYjI4OTQuLmM0MzMwNGUzYmFk
YSAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9zaG1l
bS5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fc2htZW0uYwo+
ID4gQEAgLTIyLDExICsyMiwxMyBAQCBzdGF0aWMgdm9pZCBjaGVja19yZWxlYXNlX3BhZ2V2ZWMo
c3RydWN0IHBhZ2V2ZWMgKnB2ZWMpCj4gPiAgICAgICBjb25kX3Jlc2NoZWQoKTsKPiA+ICB9Cj4g
Pgo+ID4gLXN0YXRpYyBpbnQgc2htZW1fZ2V0X3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpvYmopCj4gPiArc3RhdGljIHN0cnVjdCBzZ190YWJsZSAqCj4gPiArc2htZW1fZ2V0X3Bh
Z2VzKHN0cnVjdCBpOTE1X2dlbV9vYmplY3RfZ2V0X3BhZ2VzX2NvbnRleHQgKmN0eCwKPiA+ICsg
ICAgICAgICAgICAgdW5zaWduZWQgaW50ICpzaXplcykKPiA+ICB7Cj4gPiArICAgICBzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gY3R4LT5vYmplY3Q7Cj4gPiAgICAgICBzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUob2JqLT5iYXNlLmRldik7Cj4gPiAgICAg
ICBjb25zdCB1bnNpZ25lZCBsb25nIHBhZ2VfY291bnQgPSBvYmotPmJhc2Uuc2l6ZSAvIFBBR0Vf
U0laRTsKPiA+IC0gICAgIHVuc2lnbmVkIGxvbmcgaTsKPiA+ICAgICAgIHN0cnVjdCBhZGRyZXNz
X3NwYWNlICptYXBwaW5nOwo+ID4gICAgICAgc3RydWN0IHNnX3RhYmxlICpzdDsKPiA+ICAgICAg
IHN0cnVjdCBzY2F0dGVybGlzdCAqc2c7Cj4gPiBAQCAtMzcsMzEgKzM5LDI0IEBAIHN0YXRpYyBp
bnQgc2htZW1fZ2V0X3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCj4gPiAg
ICAgICB1bnNpZ25lZCBpbnQgc2dfcGFnZV9zaXplczsKPiA+ICAgICAgIHN0cnVjdCBwYWdldmVj
IHB2ZWM7Cj4gPiAgICAgICBnZnBfdCBub3JlY2xhaW07Cj4gPiArICAgICB1bnNpZ25lZCBsb25n
IGk7Cj4gPiAgICAgICBpbnQgcmV0Owo+ID4KPiA+IC0gICAgIC8qCj4gPiAtICAgICAgKiBBc3Nl
cnQgdGhhdCB0aGUgb2JqZWN0IGlzIG5vdCBjdXJyZW50bHkgaW4gYW55IEdQVSBkb21haW4uIEFz
IGl0Cj4gPiAtICAgICAgKiB3YXNuJ3QgaW4gdGhlIEdUVCwgdGhlcmUgc2hvdWxkbid0IGJlIGFu
eSB3YXkgaXQgY291bGQgaGF2ZSBiZWVuIGluCj4gPiAtICAgICAgKiBhIEdQVSBjYWNoZQo+ID4g
LSAgICAgICovCj4gPiAtICAgICBHRU1fQlVHX09OKG9iai0+cmVhZF9kb21haW5zICYgSTkxNV9H
RU1fR1BVX0RPTUFJTlMpOwo+ID4gLSAgICAgR0VNX0JVR19PTihvYmotPndyaXRlX2RvbWFpbiAm
IEk5MTVfR0VNX0dQVV9ET01BSU5TKTsKPiA+IC0KPiA+ICAgICAgIC8qCj4gPiAgICAgICAgKiBJ
ZiB0aGVyZSdzIG5vIGNoYW5jZSBvZiBhbGxvY2F0aW5nIGVub3VnaCBwYWdlcyBmb3IgdGhlIHdo
b2xlCj4gPiAgICAgICAgKiBvYmplY3QsIGJhaWwgZWFybHkuCj4gPiAgICAgICAgKi8KPiA+ICAg
ICAgIGlmIChwYWdlX2NvdW50ID4gdG90YWxyYW1fcGFnZXMoKSkKPiA+IC0gICAgICAgICAgICAg
cmV0dXJuIC1FTk9NRU07Cj4gPiArICAgICAgICAgICAgIHJldHVybiBFUlJfUFRSKC1FTk9NRU0p
Owo+ID4KPiA+ICAgICAgIHN0ID0ga21hbGxvYyhzaXplb2YoKnN0KSwgR0ZQX0tFUk5FTCk7Cj4g
PiAgICAgICBpZiAoIXN0KQo+ID4gLSAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKPiA+ICsg
ICAgICAgICAgICAgcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7Cj4gPgo+ID4gIHJlYnVpbGRfc3Q6
Cj4gPiAgICAgICBpZiAoc2dfYWxsb2NfdGFibGUoc3QsIHBhZ2VfY291bnQsIEdGUF9LRVJORUwp
KSB7Cj4gPiAgICAgICAgICAgICAgIGtmcmVlKHN0KTsKPiA+IC0gICAgICAgICAgICAgcmV0dXJu
IC1FTk9NRU07Cj4gPiArICAgICAgICAgICAgIHJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwo+ID4g
ICAgICAgfQo+ID4KPiA+ICAgICAgIC8qCj4gPiBAQCAtMTc5LDkgKzE3NCw4IEBAIHN0YXRpYyBp
bnQgc2htZW1fZ2V0X3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCj4gPiAg
ICAgICBpZiAoaTkxNV9nZW1fb2JqZWN0X25lZWRzX2JpdDE3X3N3aXp6bGUob2JqKSkKPiA+ICAg
ICAgICAgICAgICAgaTkxNV9nZW1fb2JqZWN0X2RvX2JpdF8xN19zd2l6emxlKG9iaiwgc3QpOwo+
ID4KPiA+IC0gICAgIF9faTkxNV9nZW1fb2JqZWN0X3NldF9wYWdlcyhvYmosIHN0LCBzZ19wYWdl
X3NpemVzKTsKPiA+IC0KPiA+IC0gICAgIHJldHVybiAwOwo+ID4gKyAgICAgKnNpemVzID0gc2df
cGFnZV9zaXplczsKPiA+ICsgICAgIHJldHVybiBzdDsKPiA+Cj4gPiAgZXJyX3NnOgo+ID4gICAg
ICAgc2dfbWFya19lbmQoc2cpOwo+ID4gQEAgLTIwOSw3ICsyMDMsNyBAQCBzdGF0aWMgaW50IHNo
bWVtX2dldF9wYWdlcyhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQo+ID4gICAgICAg
aWYgKHJldCA9PSAtRU5PU1BDKQo+ID4gICAgICAgICAgICAgICByZXQgPSAtRU5PTUVNOwo+ID4K
PiA+IC0gICAgIHJldHVybiByZXQ7Cj4gPiArICAgICByZXR1cm4gRVJSX1BUUihyZXQpOwo+ID4g
IH0KPiA+Cj4gPiAgc3RhdGljIHZvaWQKPiA+IEBAIC0yNzYsOCArMjcwLDYgQEAgX19pOTE1X2dl
bV9vYmplY3RfcmVsZWFzZV9zaG1lbShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAo+
ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNnX3RhYmxlICpwYWdlcywK
PiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgbmVlZHNfY2xmbHVzaCkKPiA+
ICB7Cj4gPiAtICAgICBHRU1fQlVHX09OKG9iai0+bW0ubWFkdiA9PSBfX0k5MTVfTUFEVl9QVVJH
RUQpOwo+ID4gLQo+ID4gICAgICAgaWYgKG9iai0+bW0ubWFkdiA9PSBJOTE1X01BRFZfRE9OVE5F
RUQpCj4gPiAgICAgICAgICAgICAgIG9iai0+bW0uZGlydHkgPSBmYWxzZTsKPiA+Cj4gPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3N0b2xlbi5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3N0b2xlbi5jCj4gPiBpbmRleCA3MDY2MDQ0
ZDYzY2YuLjI4ZWEwNmU2NjdjZCAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9zdG9sZW4uYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX3N0b2xlbi5jCj4gPiBAQCAtNDk5LDIyICs0OTksMTkgQEAgaTkxNV9wYWdlc19j
cmVhdGVfZm9yX3N0b2xlbihzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ID4gICAgICAgcmV0dXJu
IHN0Owo+ID4gIH0KPiA+Cj4gPiAtc3RhdGljIGludCBpOTE1X2dlbV9vYmplY3RfZ2V0X3BhZ2Vz
X3N0b2xlbihzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQo+ID4gK3N0YXRpYyBzdHJ1
Y3Qgc2dfdGFibGUgKgo+ID4gK3N0b2xlbl9nZXRfcGFnZXMoc3RydWN0IGk5MTVfZ2VtX29iamVj
dF9nZXRfcGFnZXNfY29udGV4dCAqY3R4LAo+ID4gKyAgICAgICAgICAgICAgdW5zaWduZWQgaW50
ICpzaXplcykKPiA+ICB7Cj4gPiAtICAgICBzdHJ1Y3Qgc2dfdGFibGUgKnBhZ2VzID0KPiA+IC0g
ICAgICAgICAgICAgaTkxNV9wYWdlc19jcmVhdGVfZm9yX3N0b2xlbihvYmotPmJhc2UuZGV2LAo+
ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iai0+c3RvbGVu
LT5zdGFydCwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBv
YmotPnN0b2xlbi0+c2l6ZSk7Cj4gPiAtICAgICBpZiAoSVNfRVJSKHBhZ2VzKSkKPiA+IC0gICAg
ICAgICAgICAgcmV0dXJuIFBUUl9FUlIocGFnZXMpOwo+ID4gLQo+ID4gLSAgICAgX19pOTE1X2dl
bV9vYmplY3Rfc2V0X3BhZ2VzKG9iaiwgcGFnZXMsIG9iai0+c3RvbGVuLT5zaXplKTsKPiA+ICsg
ICAgIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSBjdHgtPm9iamVjdDsKPiA+Cj4g
PiAtICAgICByZXR1cm4gMDsKPiA+ICsgICAgIHJldHVybiBpOTE1X3BhZ2VzX2NyZWF0ZV9mb3Jf
c3RvbGVuKG9iai0+YmFzZS5kZXYsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBvYmotPnN0b2xlbi0+c3RhcnQsCj4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBvYmotPnN0b2xlbi0+c2l6ZSk7Cj4gPiAgfQo+ID4KPiA+IC1z
dGF0aWMgdm9pZCBpOTE1X2dlbV9vYmplY3RfcHV0X3BhZ2VzX3N0b2xlbihzdHJ1Y3QgZHJtX2k5
MTVfZ2VtX29iamVjdCAqb2JqLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHN0cnVjdCBzZ190YWJsZSAqcGFnZXMpCj4gPiArc3RhdGljIHZvaWQKPiA+ICtz
dG9sZW5fcHV0X3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosIHN0cnVjdCBz
Z190YWJsZSAqcGFnZXMpCj4gPiAgewo+ID4gICAgICAgLyogU2hvdWxkIG9ubHkgYmUgY2FsbGVk
IGZyb20gaTkxNV9nZW1fb2JqZWN0X3JlbGVhc2Vfc3RvbGVuKCkgKi8KPiA+ICAgICAgIHNnX2Zy
ZWVfdGFibGUocGFnZXMpOwo+ID4gQEAgLTUzNiw4ICs1MzMsOCBAQCBpOTE1X2dlbV9vYmplY3Rf
cmVsZWFzZV9zdG9sZW4oc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKPiA+ICB9Cj4g
Pgo+ID4gIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdF9vcHMgaTkxNV9n
ZW1fb2JqZWN0X3N0b2xlbl9vcHMgPSB7Cj4gPiAtICAgICAuZ2V0X3BhZ2VzID0gaTkxNV9nZW1f
b2JqZWN0X2dldF9wYWdlc19zdG9sZW4sCj4gPiAtICAgICAucHV0X3BhZ2VzID0gaTkxNV9nZW1f
b2JqZWN0X3B1dF9wYWdlc19zdG9sZW4sCj4gPiArICAgICAuZ2V0X3BhZ2VzID0gc3RvbGVuX2dl
dF9wYWdlcywKPiA+ICsgICAgIC5wdXRfcGFnZXMgPSBzdG9sZW5fcHV0X3BhZ2VzLAo+ID4gICAg
ICAgLnJlbGVhc2UgPSBpOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9zdG9sZW4sCj4gPiAgfTsKPiA+
Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3VzZXJw
dHIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV91c2VycHRyLmMKPiA+IGlu
ZGV4IGYwOTNkZWFlYjVjMC4uNjc0OGUxNWJmODlhIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3VzZXJwdHIuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3VzZXJwdHIuYwo+ID4gQEAgLTM3OCw3ICszNzgsNyBAQCBf
X2k5MTVfbW1fc3RydWN0X2ZyZWUoc3RydWN0IGtyZWYgKmtyZWYpCj4gPiAgICAgICBtdXRleF91
bmxvY2soJm1tLT5pOTE1LT5tbV9sb2NrKTsKPiA+Cj4gPiAgICAgICBJTklUX1dPUksoJm1tLT53
b3JrLCBfX2k5MTVfbW1fc3RydWN0X2ZyZWVfX3dvcmtlcik7Cj4gPiAtICAgICBxdWV1ZV93b3Jr
KG1tLT5pOTE1LT5tbS51c2VycHRyX3dxLCAmbW0tPndvcmspOwo+ID4gKyAgICAgc2NoZWR1bGVf
d29yaygmbW0tPndvcmspOwo+ID4gIH0KPiA+Cj4gPiAgc3RhdGljIHZvaWQKPiA+IEBAIC0zOTMs
MTkgKzM5MywxMiBAQCBpOTE1X2dlbV91c2VycHRyX3JlbGVhc2VfX21tX3N0cnVjdChzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQo+ID4gICAgICAgb2JqLT51c2VycHRyLm1tID0gTlVM
TDsKPiA+ICB9Cj4gPgo+ID4gLXN0cnVjdCBnZXRfcGFnZXNfd29yayB7Cj4gPiAtICAgICBzdHJ1
Y3Qgd29ya19zdHJ1Y3Qgd29yazsKPiA+IC0gICAgIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0
ICpvYmo7Cj4gPiAtICAgICBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2s7Cj4gPiAtfTsKPiA+IC0K
PiA+ICBzdGF0aWMgc3RydWN0IHNnX3RhYmxlICoKPiA+ICBfX2k5MTVfZ2VtX3VzZXJwdHJfYWxs
b2NfcGFnZXMoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiA+ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IHBhZ2UgKipwdmVjLCBpbnQgbnVtX3BhZ2VzKQo+ID4g
IHsKPiA+ICAgICAgIHVuc2lnbmVkIGludCBtYXhfc2VnbWVudCA9IGk5MTVfc2dfc2VnbWVudF9z
aXplKCk7Cj4gPiAgICAgICBzdHJ1Y3Qgc2dfdGFibGUgKnN0Owo+ID4gLSAgICAgdW5zaWduZWQg
aW50IHNnX3BhZ2Vfc2l6ZXM7Cj4gPiAgICAgICBpbnQgcmV0Owo+ID4KPiA+ICAgICAgIHN0ID0g
a21hbGxvYyhzaXplb2YoKnN0KSwgR0ZQX0tFUk5FTCk7Cj4gPiBAQCAtNDM1LDEzMSArNDI4LDIz
IEBAIF9faTkxNV9nZW1fdXNlcnB0cl9hbGxvY19wYWdlcyhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29i
amVjdCAqb2JqLAo+ID4gICAgICAgICAgICAgICByZXR1cm4gRVJSX1BUUihyZXQpOwo+ID4gICAg
ICAgfQo+ID4KPiA+IC0gICAgIHNnX3BhZ2Vfc2l6ZXMgPSBpOTE1X3NnX3BhZ2Vfc2l6ZXMoc3Qt
PnNnbCk7Cj4gPiAtCj4gPiAtICAgICBfX2k5MTVfZ2VtX29iamVjdF9zZXRfcGFnZXMob2JqLCBz
dCwgc2dfcGFnZV9zaXplcyk7Cj4gPiAtCj4gPiAgICAgICByZXR1cm4gc3Q7Cj4gPiAgfQo+ID4K
PiA+IC1zdGF0aWMgdm9pZAo+ID4gLV9faTkxNV9nZW1fdXNlcnB0cl9nZXRfcGFnZXNfd29ya2Vy
KHN0cnVjdCB3b3JrX3N0cnVjdCAqX3dvcmspCj4gPiAtewo+ID4gLSAgICAgc3RydWN0IGdldF9w
YWdlc193b3JrICp3b3JrID0gY29udGFpbmVyX29mKF93b3JrLCB0eXBlb2YoKndvcmspLCB3b3Jr
KTsKPiA+IC0gICAgIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSB3b3JrLT5vYmo7
Cj4gPiAtICAgICBjb25zdCBpbnQgbnBhZ2VzID0gb2JqLT5iYXNlLnNpemUgPj4gUEFHRV9TSElG
VDsKPiA+IC0gICAgIHN0cnVjdCBwYWdlICoqcHZlYzsKPiA+IC0gICAgIGludCBwaW5uZWQsIHJl
dDsKPiA+IC0KPiA+IC0gICAgIHJldCA9IC1FTk9NRU07Cj4gPiAtICAgICBwaW5uZWQgPSAwOwo+
ID4gLQo+ID4gLSAgICAgcHZlYyA9IGt2bWFsbG9jX2FycmF5KG5wYWdlcywgc2l6ZW9mKHN0cnVj
dCBwYWdlICopLCBHRlBfS0VSTkVMKTsKPiA+IC0gICAgIGlmIChwdmVjICE9IE5VTEwpIHsKPiA+
IC0gICAgICAgICAgICAgc3RydWN0IG1tX3N0cnVjdCAqbW0gPSBvYmotPnVzZXJwdHIubW0tPm1t
Owo+ID4gLSAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgZmxhZ3MgPSAwOwo+ID4gLQo+ID4gLSAg
ICAgICAgICAgICBpZiAoIWk5MTVfZ2VtX29iamVjdF9pc19yZWFkb25seShvYmopKQo+ID4gLSAg
ICAgICAgICAgICAgICAgICAgIGZsYWdzIHw9IEZPTExfV1JJVEU7Cj4gPiAtCj4gPiAtICAgICAg
ICAgICAgIHJldCA9IC1FRkFVTFQ7Cj4gPiAtICAgICAgICAgICAgIGlmIChtbWdldF9ub3RfemVy
byhtbSkpIHsKPiA+IC0gICAgICAgICAgICAgICAgICAgICBkb3duX3JlYWQoJm1tLT5tbWFwX3Nl
bSk7Cj4gPiAtICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHBpbm5lZCA8IG5wYWdlcykgewo+
ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gZ2V0X3VzZXJfcGFnZXNfcmVt
b3RlCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh3b3JrLT50YXNr
LCBtbSwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iai0+dXNl
cnB0ci5wdHIgKyBwaW5uZWQgKiBQQUdFX1NJWkUsCj4gPiAtICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBucGFnZXMgLSBwaW5uZWQsCj4gPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBmbGFncywKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHB2ZWMgKyBwaW5uZWQsIE5VTEwsIE5VTEwpOwo+ID4gLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgaWYgKHJldCA8IDApCj4gPiAtICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGJyZWFrOwo+ID4gLQo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgcGlubmVkICs9IHJldDsKPiA+IC0gICAgICAgICAgICAgICAgICAgICB9Cj4gPiAtICAg
ICAgICAgICAgICAgICAgICAgdXBfcmVhZCgmbW0tPm1tYXBfc2VtKTsKPiA+IC0gICAgICAgICAg
ICAgICAgICAgICBtbXB1dChtbSk7Cj4gPiAtICAgICAgICAgICAgIH0KPiA+IC0gICAgIH0KPiA+
IC0KPiA+IC0gICAgIG11dGV4X2xvY2soJm9iai0+bW0ubG9jayk7Cj4gPiAtICAgICBpZiAob2Jq
LT51c2VycHRyLndvcmsgPT0gJndvcmstPndvcmspIHsKPiA+IC0gICAgICAgICAgICAgc3RydWN0
IHNnX3RhYmxlICpwYWdlcyA9IEVSUl9QVFIocmV0KTsKPiA+IC0KPiA+IC0gICAgICAgICAgICAg
aWYgKHBpbm5lZCA9PSBucGFnZXMpIHsKPiA+IC0gICAgICAgICAgICAgICAgICAgICBwYWdlcyA9
IF9faTkxNV9nZW1fdXNlcnB0cl9hbGxvY19wYWdlcyhvYmosIHB2ZWMsCj4gPiAtICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnBhZ2Vz
KTsKPiA+IC0gICAgICAgICAgICAgICAgICAgICBpZiAoIUlTX0VSUihwYWdlcykpIHsKPiA+IC0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpbm5lZCA9IDA7Cj4gPiAtICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBwYWdlcyA9IE5VTEw7Cj4gPiAtICAgICAgICAgICAgICAgICAgICAg
fQo+ID4gLSAgICAgICAgICAgICB9Cj4gPiAtCj4gPiAtICAgICAgICAgICAgIG9iai0+dXNlcnB0
ci53b3JrID0gRVJSX0NBU1QocGFnZXMpOwo+ID4gLSAgICAgICAgICAgICBpZiAoSVNfRVJSKHBh
Z2VzKSkKPiA+IC0gICAgICAgICAgICAgICAgICAgICBfX2k5MTVfZ2VtX3VzZXJwdHJfc2V0X2Fj
dGl2ZShvYmosIGZhbHNlKTsKPiA+IC0gICAgIH0KPiA+IC0gICAgIG11dGV4X3VubG9jaygmb2Jq
LT5tbS5sb2NrKTsKPiA+IC0KPiA+IC0gICAgIHJlbGVhc2VfcGFnZXMocHZlYywgcGlubmVkKTsK
PiA+IC0gICAgIGt2ZnJlZShwdmVjKTsKPiA+IC0KPiA+IC0gICAgIGk5MTVfZ2VtX29iamVjdF9w
dXQob2JqKTsKPiA+IC0gICAgIHB1dF90YXNrX3N0cnVjdCh3b3JrLT50YXNrKTsKPiA+IC0gICAg
IGtmcmVlKHdvcmspOwo+ID4gLX0KPiA+IC0KPiA+ICBzdGF0aWMgc3RydWN0IHNnX3RhYmxlICoK
PiA+IC1fX2k5MTVfZ2VtX3VzZXJwdHJfZ2V0X3BhZ2VzX3NjaGVkdWxlKHN0cnVjdCBkcm1faTkx
NV9nZW1fb2JqZWN0ICpvYmopCj4gPiAtewo+ID4gLSAgICAgc3RydWN0IGdldF9wYWdlc193b3Jr
ICp3b3JrOwo+ID4gLQo+ID4gLSAgICAgLyogU3Bhd24gYSB3b3JrZXIgc28gdGhhdCB3ZSBjYW4g
YWNxdWlyZSB0aGUKPiA+IC0gICAgICAqIHVzZXIgcGFnZXMgd2l0aG91dCBob2xkaW5nIG91ciBt
dXRleC4gQWNjZXNzCj4gPiAtICAgICAgKiB0byB0aGUgdXNlciBwYWdlcyByZXF1aXJlcyBtbWFw
X3NlbSwgYW5kIHdlIGhhdmUKPiA+IC0gICAgICAqIGEgc3RyaWN0IGxvY2sgb3JkZXJpbmcgb2Yg
bW1hcF9zZW0sIHN0cnVjdF9tdXRleCAtCj4gPiAtICAgICAgKiB3ZSBhbHJlYWR5IGhvbGQgc3Ry
dWN0X211dGV4IGhlcmUgYW5kIHNvIGNhbm5vdAo+ID4gLSAgICAgICogY2FsbCBndXAgd2l0aG91
dCBlbmNvdW50ZXJpbmcgYSBsb2NrIGludmVyc2lvbi4KPiA+IC0gICAgICAqCj4gPiAtICAgICAg
KiBVc2Vyc3BhY2Ugd2lsbCBrZWVwIG9uIHJlcGVhdGluZyB0aGUgb3BlcmF0aW9uCj4gPiAtICAg
ICAgKiAodGhhbmtzIHRvIEVBR0FJTikgdW50aWwgZWl0aGVyIHdlIGhpdCB0aGUgZmFzdAo+ID4g
LSAgICAgICogcGF0aCBvciB0aGUgd29ya2VyIGNvbXBsZXRlcy4gSWYgdGhlIHdvcmtlciBpcwo+
ID4gLSAgICAgICogY2FuY2VsbGVkIG9yIHN1cGVyc2VkZWQsIHRoZSB0YXNrIGlzIHN0aWxsIHJ1
bgo+ID4gLSAgICAgICogYnV0IHRoZSByZXN1bHRzIGlnbm9yZWQuIChUaGlzIGxlYWRzIHRvCj4g
PiAtICAgICAgKiBjb21wbGljYXRpb25zIHRoYXQgd2UgbWF5IGhhdmUgYSBzdHJheSBvYmplY3QK
PiA+IC0gICAgICAqIHJlZmNvdW50IHRoYXQgd2UgbmVlZCB0byBiZSB3YXJ5IG9mIHdoZW4KPiA+
IC0gICAgICAqIGNoZWNraW5nIGZvciBleGlzdGluZyBvYmplY3RzIGR1cmluZyBjcmVhdGlvbi4p
Cj4gPiAtICAgICAgKiBJZiB0aGUgd29ya2VyIGVuY291bnRlcnMgYW4gZXJyb3IsIGl0IHJlcG9y
dHMKPiA+IC0gICAgICAqIHRoYXQgZXJyb3IgYmFjayB0byB0aGlzIGZ1bmN0aW9uIHRocm91Z2gK
PiA+IC0gICAgICAqIG9iai0+dXNlcnB0ci53b3JrID0gRVJSX1BUUi4KPiA+IC0gICAgICAqLwo+
ID4gLSAgICAgd29yayA9IGttYWxsb2Moc2l6ZW9mKCp3b3JrKSwgR0ZQX0tFUk5FTCk7Cj4gPiAt
ICAgICBpZiAod29yayA9PSBOVUxMKQo+ID4gLSAgICAgICAgICAgICByZXR1cm4gRVJSX1BUUigt
RU5PTUVNKTsKPiA+IC0KPiA+IC0gICAgIG9iai0+dXNlcnB0ci53b3JrID0gJndvcmstPndvcms7
Cj4gPiAtCj4gPiAtICAgICB3b3JrLT5vYmogPSBpOTE1X2dlbV9vYmplY3RfZ2V0KG9iaik7Cj4g
PiAtCj4gPiAtICAgICB3b3JrLT50YXNrID0gY3VycmVudDsKPiA+IC0gICAgIGdldF90YXNrX3N0
cnVjdCh3b3JrLT50YXNrKTsKPiA+IC0KPiA+IC0gICAgIElOSVRfV09SSygmd29yay0+d29yaywg
X19pOTE1X2dlbV91c2VycHRyX2dldF9wYWdlc193b3JrZXIpOwo+ID4gLSAgICAgcXVldWVfd29y
ayh0b19pOTE1KG9iai0+YmFzZS5kZXYpLT5tbS51c2VycHRyX3dxLCAmd29yay0+d29yayk7Cj4g
PiAtCj4gPiAtICAgICByZXR1cm4gRVJSX1BUUigtRUFHQUlOKTsKPiA+IC19Cj4gPiAtCj4gPiAt
c3RhdGljIGludCBpOTE1X2dlbV91c2VycHRyX2dldF9wYWdlcyhzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdCAqb2JqKQo+ID4gK3VzZXJwdHJfZ2V0X3BhZ2VzKHN0cnVjdCBpOTE1X2dlbV9vYmpl
Y3RfZ2V0X3BhZ2VzX2NvbnRleHQgKmN0eCwKPiA+ICsgICAgICAgICAgICAgICB1bnNpZ25lZCBp
bnQgKnNpemVzKQo+ID4gIHsKPiA+ICsgICAgIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpv
YmogPSBjdHgtPm9iamVjdDsKPiA+ICAgICAgIGNvbnN0IGludCBudW1fcGFnZXMgPSBvYmotPmJh
c2Uuc2l6ZSA+PiBQQUdFX1NISUZUOwo+ID4gICAgICAgc3RydWN0IG1tX3N0cnVjdCAqbW0gPSBv
YmotPnVzZXJwdHIubW0tPm1tOwo+ID4gLSAgICAgc3RydWN0IHBhZ2UgKipwdmVjOwo+ID4gICAg
ICAgc3RydWN0IHNnX3RhYmxlICpwYWdlczsKPiA+IC0gICAgIGJvb2wgYWN0aXZlOwo+ID4gKyAg
ICAgc3RydWN0IHBhZ2UgKipwdmVjOwo+ID4gICAgICAgaW50IHBpbm5lZDsKPiA+ICsgICAgIGlu
dCByZXQ7Cj4gPgo+ID4gLSAgICAgLyogSWYgdXNlcnNwYWNlIHNob3VsZCBlbmdpbmVlciB0aGF0
IHRoZXNlIHBhZ2VzIGFyZSByZXBsYWNlZCBpbgo+ID4gKyAgICAgLyoKPiA+ICsgICAgICAqIElm
IHVzZXJzcGFjZSBzaG91bGQgZW5naW5lZXIgdGhhdCB0aGVzZSBwYWdlcyBhcmUgcmVwbGFjZWQg
aW4KPiA+ICAgICAgICAqIHRoZSB2bWEgYmV0d2VlbiB1cyBiaW5kaW5nIHRoaXMgcGFnZSBpbnRv
IHRoZSBHVFQgYW5kIGNvbXBsZXRpb24KPiA+ICAgICAgICAqIG9mIHJlbmRlcmluZy4uLiBUaGVp
ciBsb3NzLiBJZiB0aGV5IGNoYW5nZSB0aGUgbWFwcGluZyBvZiB0aGVpcgo+ID4gICAgICAgICog
cGFnZXMgdGhleSBuZWVkIHRvIGNyZWF0ZSBhIG5ldyBibyB0byBwb2ludCB0byB0aGUgbmV3IHZt
YS4KPiA+IEBAIC01NzYsNTkgKzQ2MSw1OCBAQCBzdGF0aWMgaW50IGk5MTVfZ2VtX3VzZXJwdHJf
Z2V0X3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCj4gPiAgICAgICAgKiBl
Z3JlZ2lvdXMgY2FzZXMgZnJvbSBjYXVzaW5nIGhhcm0uCj4gPiAgICAgICAgKi8KPiA+Cj4gPiAt
ICAgICBpZiAob2JqLT51c2VycHRyLndvcmspIHsKPiA+IC0gICAgICAgICAgICAgLyogYWN0aXZl
IGZsYWcgc2hvdWxkIHN0aWxsIGJlIGhlbGQgZm9yIHRoZSBwZW5kaW5nIHdvcmsgKi8KPiA+IC0g
ICAgICAgICAgICAgaWYgKElTX0VSUihvYmotPnVzZXJwdHIud29yaykpCj4gPiAtICAgICAgICAg
ICAgICAgICAgICAgcmV0dXJuIFBUUl9FUlIob2JqLT51c2VycHRyLndvcmspOwo+ID4gLSAgICAg
ICAgICAgICBlbHNlCj4gPiAtICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FQUdBSU47Cj4g
PiAtICAgICB9Cj4gPiArICAgICBwdmVjID0ga3ZtYWxsb2NfYXJyYXkobnVtX3BhZ2VzLCBzaXpl
b2Yoc3RydWN0IHBhZ2UgKiksCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgR0ZQX0tF
Uk5FTCB8IF9fR0ZQX05PUkVUUlkgfCBfX0dGUF9OT1dBUk4pOwo+ID4gKyAgICAgaWYgKCFwdmVj
KQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKPiA+ICsKPiA+ICsg
ICAgIF9faTkxNV9nZW1fdXNlcnB0cl9zZXRfYWN0aXZlKG9iaiwgdHJ1ZSk7Cj4gPgo+ID4gLSAg
ICAgcHZlYyA9IE5VTEw7Cj4gPiAgICAgICBwaW5uZWQgPSAwOwo+ID4gKyAgICAgcmV0ID0gLUVG
QVVMVDsKPiA+ICsgICAgIGlmIChtbWdldF9ub3RfemVybyhtbSkpIHsKPiA+ICsgICAgICAgICAg
ICAgdW5zaWduZWQgaW50IGZsYWdzOwo+ID4KPiA+IC0gICAgIGlmIChtbSA9PSBjdXJyZW50LT5t
bSkgewo+ID4gLSAgICAgICAgICAgICBwdmVjID0ga3ZtYWxsb2NfYXJyYXkobnVtX3BhZ2VzLCBz
aXplb2Yoc3RydWN0IHBhZ2UgKiksCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBHRlBfS0VSTkVMIHwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IF9fR0ZQX05PUkVUUlkgfAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
X19HRlBfTk9XQVJOKTsKPiA+IC0gICAgICAgICAgICAgaWYgKHB2ZWMpIC8qIGRlZmVyIHRvIHdv
cmtlciBpZiBtYWxsb2MgZmFpbHMgKi8KPiA+IC0gICAgICAgICAgICAgICAgICAgICBwaW5uZWQg
PSBfX2dldF91c2VyX3BhZ2VzX2Zhc3Qob2JqLT51c2VycHRyLnB0ciwKPiA+IC0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtX3BhZ2VzLAo+ID4g
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhaTkx
NV9nZW1fb2JqZWN0X2lzX3JlYWRvbmx5KG9iaiksCj4gPiAtICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB2ZWMpOwo+ID4gLSAgICAgfQo+ID4gKyAg
ICAgICAgICAgICBmbGFncyA9IDA7Cj4gPiArICAgICAgICAgICAgIGlmICghaTkxNV9nZW1fb2Jq
ZWN0X2lzX3JlYWRvbmx5KG9iaikpCj4gPiArICAgICAgICAgICAgICAgICAgICAgZmxhZ3MgfD0g
Rk9MTF9XUklURTsKPiA+Cj4gPiAtICAgICBhY3RpdmUgPSBmYWxzZTsKPiA+IC0gICAgIGlmIChw
aW5uZWQgPCAwKSB7Cj4gPiAtICAgICAgICAgICAgIHBhZ2VzID0gRVJSX1BUUihwaW5uZWQpOwo+
ID4gLSAgICAgICAgICAgICBwaW5uZWQgPSAwOwo+ID4gLSAgICAgfSBlbHNlIGlmIChwaW5uZWQg
PCBudW1fcGFnZXMpIHsKPiA+IC0gICAgICAgICAgICAgcGFnZXMgPSBfX2k5MTVfZ2VtX3VzZXJw
dHJfZ2V0X3BhZ2VzX3NjaGVkdWxlKG9iaik7Cj4gPiAtICAgICAgICAgICAgIGFjdGl2ZSA9IHBh
Z2VzID09IEVSUl9QVFIoLUVBR0FJTik7Cj4gPiAtICAgICB9IGVsc2Ugewo+ID4gLSAgICAgICAg
ICAgICBwYWdlcyA9IF9faTkxNV9nZW1fdXNlcnB0cl9hbGxvY19wYWdlcyhvYmosIHB2ZWMsIG51
bV9wYWdlcyk7Cj4gPiAtICAgICAgICAgICAgIGFjdGl2ZSA9ICFJU19FUlIocGFnZXMpOwo+ID4g
KyAgICAgICAgICAgICBkb3duX3JlYWQoJm1tLT5tbWFwX3NlbSk7Cj4gPiArICAgICAgICAgICAg
IHdoaWxlIChwaW5uZWQgPCBudW1fcGFnZXMpIHsKPiA+ICsgICAgICAgICAgICAgICAgICAgICBy
ZXQgPSBnZXRfdXNlcl9wYWdlc19yZW1vdGUKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIChjdHgtPnRhc2ssIG1tLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9i
ai0+dXNlcnB0ci5wdHIgKyBwaW5uZWQgKiBQQUdFX1NJWkUsCj4gPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgbnVtX3BhZ2VzIC0gcGlubmVkLAo+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGZsYWdzLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB2
ZWMgKyBwaW5uZWQsIE5VTEwsIE5VTEwpOwo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGlmIChy
ZXQgPCAwKQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Cj4gPiArCj4g
PiArICAgICAgICAgICAgICAgICAgICAgcGlubmVkICs9IHJldDsKPiA+ICsgICAgICAgICAgICAg
fQo+ID4gKyAgICAgICAgICAgICB1cF9yZWFkKCZtbS0+bW1hcF9zZW0pOwo+ID4gKyAgICAgICAg
ICAgICBtbXB1dChtbSk7Cj4gPiAgICAgICB9Cj4gPiAtICAgICBpZiAoYWN0aXZlKQo+ID4gLSAg
ICAgICAgICAgICBfX2k5MTVfZ2VtX3VzZXJwdHJfc2V0X2FjdGl2ZShvYmosIHRydWUpOwo+ID4K
PiA+IC0gICAgIGlmIChJU19FUlIocGFnZXMpKQo+ID4gKyAgICAgaWYgKHJldCkKPiA+ICsgICAg
ICAgICAgICAgcGFnZXMgPSBFUlJfUFRSKHJldCk7Cj4gPiArICAgICBlbHNlCj4gPiArICAgICAg
ICAgICAgIHBhZ2VzID0gX19pOTE1X2dlbV91c2VycHRyX2FsbG9jX3BhZ2VzKG9iaiwgcHZlYywg
bnVtX3BhZ2VzKTsKPiA+ICsgICAgIGlmIChJU19FUlIocGFnZXMpKSB7Cj4gPiAgICAgICAgICAg
ICAgIHJlbGVhc2VfcGFnZXMocHZlYywgcGlubmVkKTsKPiA+ICsgICAgICAgICAgICAgX19pOTE1
X2dlbV91c2VycHRyX3NldF9hY3RpdmUob2JqLCBmYWxzZSk7Cj4gPiArICAgICB9Cj4gPiAgICAg
ICBrdmZyZWUocHZlYyk7Cj4gPgo+ID4gLSAgICAgcmV0dXJuIFBUUl9FUlJfT1JfWkVSTyhwYWdl
cyk7Cj4gPiArICAgICByZXR1cm4gcGFnZXM7Cj4gPiAgfQo+ID4KPiA+ICBzdGF0aWMgdm9pZAo+
ID4gLWk5MTVfZ2VtX3VzZXJwdHJfcHV0X3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0
ICpvYmosCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNnX3RhYmxlICpwYWdl
cykKPiA+ICt1c2VycHRyX3B1dF9wYWdlcyhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2Jq
LCBzdHJ1Y3Qgc2dfdGFibGUgKnBhZ2VzKQo+ID4gIHsKPiA+ICAgICAgIHN0cnVjdCBzZ3RfaXRl
ciBzZ3RfaXRlcjsKPiA+ICAgICAgIHN0cnVjdCBwYWdlICpwYWdlOwo+ID4KPiA+IC0gICAgIC8q
IENhbmNlbCBhbnkgaW5mbGlnaHQgd29yayBhbmQgZm9yY2UgdGhlbSB0byByZXN0YXJ0IHRoZWly
IGd1cCAqLwo+ID4gLSAgICAgb2JqLT51c2VycHRyLndvcmsgPSBOVUxMOwo+ID4gICAgICAgX19p
OTE1X2dlbV91c2VycHRyX3NldF9hY3RpdmUob2JqLCBmYWxzZSk7Cj4gPiAgICAgICBpZiAoIXBh
Z2VzKQo+ID4gICAgICAgICAgICAgICByZXR1cm47Cj4gPiBAQCAtNjY5LDggKzU1Myw4IEBAIHN0
YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdF9vcHMgaTkxNV9nZW1fdXNlcnB0
cl9vcHMgPSB7Cj4gPiAgICAgICAuZmxhZ3MgPSBJOTE1X0dFTV9PQkpFQ1RfSEFTX1NUUlVDVF9Q
QUdFIHwKPiA+ICAgICAgICAgICAgICAgIEk5MTVfR0VNX09CSkVDVF9JU19TSFJJTktBQkxFIHwK
PiA+ICAgICAgICAgICAgICAgIEk5MTVfR0VNX09CSkVDVF9BU1lOQ19DQU5DRUwsCj4gPiAtICAg
ICAuZ2V0X3BhZ2VzID0gaTkxNV9nZW1fdXNlcnB0cl9nZXRfcGFnZXMsCj4gPiAtICAgICAucHV0
X3BhZ2VzID0gaTkxNV9nZW1fdXNlcnB0cl9wdXRfcGFnZXMsCj4gPiArICAgICAuZ2V0X3BhZ2Vz
ID0gdXNlcnB0cl9nZXRfcGFnZXMsCj4gPiArICAgICAucHV0X3BhZ2VzID0gdXNlcnB0cl9wdXRf
cGFnZXMsCj4gPiAgICAgICAuZG1hYnVmX2V4cG9ydCA9IGk5MTVfZ2VtX3VzZXJwdHJfZG1hYnVm
X2V4cG9ydCwKPiA+ICAgICAgIC5yZWxlYXNlID0gaTkxNV9nZW1fdXNlcnB0cl9yZWxlYXNlLAo+
ID4gIH07Cj4gPiBAQCAtNzg2LDIyICs2NzAsMTMgQEAgaTkxNV9nZW1fdXNlcnB0cl9pb2N0bChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ID4gICAgICAgcmV0dXJuIDA7Cj4gPiAgfQo+ID4KPiA+
IC1pbnQgaTkxNV9nZW1faW5pdF91c2VycHRyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICt2b2lkIGk5MTVfZ2VtX2luaXRfdXNlcnB0cihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gPiAgewo+ID4gICAgICAgbXV0ZXhfaW5pdCgmZGV2X3ByaXYtPm1t
X2xvY2spOwo+ID4gICAgICAgaGFzaF9pbml0KGRldl9wcml2LT5tbV9zdHJ1Y3RzKTsKPiA+IC0K
PiA+IC0gICAgIGRldl9wcml2LT5tbS51c2VycHRyX3dxID0KPiA+IC0gICAgICAgICAgICAgYWxs
b2Nfd29ya3F1ZXVlKCJpOTE1LXVzZXJwdHItYWNxdWlyZSIsCj4gPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBXUV9ISUdIUFJJIHwgV1FfVU5CT1VORCwKPiA+IC0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIDApOwo+ID4gLSAgICAgaWYgKCFkZXZfcHJpdi0+bW0udXNlcnB0cl93
cSkKPiA+IC0gICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gPiAtCj4gPiAtICAgICByZXR1
cm4gMDsKPiA+ICB9Cj4gPgo+ID4gIHZvaWQgaTkxNV9nZW1fY2xlYW51cF91c2VycHRyKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICB7Cj4gPiAtICAgICBkZXN0cm95X3dv
cmtxdWV1ZShkZXZfcHJpdi0+bW0udXNlcnB0cl93cSk7Cj4gPiArICAgICBtdXRleF9kZXN0cm95
KCZkZXZfcHJpdi0+bW1fbG9jayk7Cj4gPiAgfQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaHVnZV9nZW1fb2JqZWN0LmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vc2VsZnRlc3RzL2h1Z2VfZ2VtX29iamVjdC5jCj4gPiBpbmRleCAzYzVkMTdi
MmI2NzAuLjAyZTZlZGNlNzE1ZSAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9zZWxmdGVzdHMvaHVnZV9nZW1fb2JqZWN0LmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9zZWxmdGVzdHMvaHVnZV9nZW1fb2JqZWN0LmMKPiA+IEBAIC0yMSw5ICsyMSwx
MiBAQCBzdGF0aWMgdm9pZCBodWdlX2ZyZWVfcGFnZXMoc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iaiwKPiA+ICAgICAgIGtmcmVlKHBhZ2VzKTsKPiA+ICB9Cj4gPgo+ID4gLXN0YXRpYyBp
bnQgaHVnZV9nZXRfcGFnZXMoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKPiA+ICtz
dGF0aWMgc3RydWN0IHNnX3RhYmxlICoKPiA+ICtodWdlX2dldF9wYWdlcyhzdHJ1Y3QgaTkxNV9n
ZW1fb2JqZWN0X2dldF9wYWdlc19jb250ZXh0ICpjdHgsCj4gPiArICAgICAgICAgICAgdW5zaWdu
ZWQgaW50ICpzaXplcykKPiA+ICB7Cj4gPiAgI2RlZmluZSBHRlAgKEdGUF9LRVJORUwgfCBfX0dG
UF9OT1dBUk4gfCBfX0dGUF9OT1JFVFJZKQo+ID4gKyAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3QgKm9iaiA9IGN0eC0+b2JqZWN0Owo+ID4gICAgICAgY29uc3QgdW5zaWduZWQgbG9uZyBu
cmVhbCA9IG9iai0+c2NyYXRjaCAvIFBBR0VfU0laRTsKPiA+ICAgICAgIGNvbnN0IHVuc2lnbmVk
IGxvbmcgbnBhZ2VzID0gb2JqLT5iYXNlLnNpemUgLyBQQUdFX1NJWkU7Cj4gPiAgICAgICBzdHJ1
Y3Qgc2NhdHRlcmxpc3QgKnNnLCAqc3JjLCAqZW5kOwo+ID4gQEAgLTMyLDExICszNSwxMSBAQCBz
dGF0aWMgaW50IGh1Z2VfZ2V0X3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmop
Cj4gPgo+ID4gICAgICAgcGFnZXMgPSBrbWFsbG9jKHNpemVvZigqcGFnZXMpLCBHRlApOwo+ID4g
ICAgICAgaWYgKCFwYWdlcykKPiA+IC0gICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gPiAr
ICAgICAgICAgICAgIHJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwo+ID4KPiA+ICAgICAgIGlmIChz
Z19hbGxvY190YWJsZShwYWdlcywgbnBhZ2VzLCBHRlApKSB7Cj4gPiAgICAgICAgICAgICAgIGtm
cmVlKHBhZ2VzKTsKPiA+IC0gICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gPiArICAgICAg
ICAgICAgIHJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwo+ID4gICAgICAgfQo+ID4KPiA+ICAgICAg
IHNnID0gcGFnZXMtPnNnbDsKPiA+IEBAIC02NCwxNCArNjcsMTIgQEAgc3RhdGljIGludCBodWdl
X2dldF9wYWdlcyhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQo+ID4gICAgICAgaWYg
KGk5MTVfZ2VtX2d0dF9wcmVwYXJlX3BhZ2VzKG9iaiwgcGFnZXMpKQo+ID4gICAgICAgICAgICAg
ICBnb3RvIGVycjsKPiA+Cj4gPiAtICAgICBfX2k5MTVfZ2VtX29iamVjdF9zZXRfcGFnZXMob2Jq
LCBwYWdlcywgUEFHRV9TSVpFKTsKPiA+IC0KPiA+IC0gICAgIHJldHVybiAwOwo+ID4gKyAgICAg
KnNpemVzID0gUEFHRV9TSVpFOwo+ID4gKyAgICAgcmV0dXJuIHBhZ2VzOwo+ID4KPiA+ICBlcnI6
Cj4gPiAgICAgICBodWdlX2ZyZWVfcGFnZXMob2JqLCBwYWdlcyk7Cj4gPiAtCj4gPiAtICAgICBy
ZXR1cm4gLUVOT01FTTsKPiA+ICsgICAgIHJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwo+ID4gICN1
bmRlZiBHRlAKPiA+ICB9Cj4gPgo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9zZWxmdGVzdHMvaHVnZV9wYWdlcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3Nl
bGZ0ZXN0cy9odWdlX3BhZ2VzLmMKPiA+IGluZGV4IGIwM2EyOTM2NmJkMS4uM2I5M2E3MzM3ZjI3
IDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdl
X3BhZ2VzLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaHVn
ZV9wYWdlcy5jCj4gPiBAQCAtNTEsOSArNTEsMTIgQEAgc3RhdGljIHZvaWQgaHVnZV9wYWdlc19m
cmVlX3BhZ2VzKHN0cnVjdCBzZ190YWJsZSAqc3QpCj4gPiAgICAgICBrZnJlZShzdCk7Cj4gPiAg
fQo+ID4KPiA+IC1zdGF0aWMgaW50IGdldF9odWdlX3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICpvYmopCj4gPiArc3RhdGljIHN0cnVjdCBzZ190YWJsZSAqCj4gPiArZ2V0X2h1Z2Vf
cGFnZXMoc3RydWN0IGk5MTVfZ2VtX29iamVjdF9nZXRfcGFnZXNfY29udGV4dCAqY3R4LAo+ID4g
KyAgICAgICAgICAgIHVuc2lnbmVkIGludCAqc2l6ZXMpCj4gPiAgewo+ID4gICNkZWZpbmUgR0ZQ
IChHRlBfS0VSTkVMIHwgX19HRlBfTk9XQVJOIHwgX19HRlBfTk9SRVRSWSkKPiA+ICsgICAgIHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSBjdHgtPm9iamVjdDsKPiA+ICAgICAgIHVu
c2lnbmVkIGludCBwYWdlX21hc2sgPSBvYmotPm1tLnBhZ2VfbWFzazsKPiA+ICAgICAgIHN0cnVj
dCBzZ190YWJsZSAqc3Q7Cj4gPiAgICAgICBzdHJ1Y3Qgc2NhdHRlcmxpc3QgKnNnOwo+ID4gQEAg
LTYyLDExICs2NSwxMSBAQCBzdGF0aWMgaW50IGdldF9odWdlX3BhZ2VzKHN0cnVjdCBkcm1faTkx
NV9nZW1fb2JqZWN0ICpvYmopCj4gPgo+ID4gICAgICAgc3QgPSBrbWFsbG9jKHNpemVvZigqc3Qp
LCBHRlApOwo+ID4gICAgICAgaWYgKCFzdCkKPiA+IC0gICAgICAgICAgICAgcmV0dXJuIC1FTk9N
RU07Cj4gPiArICAgICAgICAgICAgIHJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwo+ID4KPiA+ICAg
ICAgIGlmIChzZ19hbGxvY190YWJsZShzdCwgb2JqLT5iYXNlLnNpemUgPj4gUEFHRV9TSElGVCwg
R0ZQKSkgewo+ID4gICAgICAgICAgICAgICBrZnJlZShzdCk7Cj4gPiAtICAgICAgICAgICAgIHJl
dHVybiAtRU5PTUVNOwo+ID4gKyAgICAgICAgICAgICByZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsK
PiA+ICAgICAgIH0KPiA+Cj4gPiAgICAgICByZW0gPSBvYmotPmJhc2Uuc2l6ZTsKPiA+IEBAIC0x
MTQsMTYgKzExNywxNCBAQCBzdGF0aWMgaW50IGdldF9odWdlX3BhZ2VzKHN0cnVjdCBkcm1faTkx
NV9nZW1fb2JqZWN0ICpvYmopCj4gPiAgICAgICBvYmotPm1tLm1hZHYgPSBJOTE1X01BRFZfRE9O
VE5FRUQ7Cj4gPgo+ID4gICAgICAgR0VNX0JVR19PTihzZ19wYWdlX3NpemVzICE9IG9iai0+bW0u
cGFnZV9tYXNrKTsKPiA+IC0gICAgIF9faTkxNV9nZW1fb2JqZWN0X3NldF9wYWdlcyhvYmosIHN0
LCBzZ19wYWdlX3NpemVzKTsKPiA+IC0KPiA+IC0gICAgIHJldHVybiAwOwo+ID4gKyAgICAgKnNp
emVzID0gc2dfcGFnZV9zaXplczsKPiA+ICsgICAgIHJldHVybiBzdDsKPiA+Cj4gPiAgZXJyOgo+
ID4gICAgICAgc2dfc2V0X3BhZ2Uoc2csIE5VTEwsIDAsIDApOwo+ID4gICAgICAgc2dfbWFya19l
bmQoc2cpOwo+ID4gICAgICAgaHVnZV9wYWdlc19mcmVlX3BhZ2VzKHN0KTsKPiA+IC0KPiA+IC0g
ICAgIHJldHVybiAtRU5PTUVNOwo+ID4gKyAgICAgcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7Cj4g
PiAgfQo+ID4KPiA+ICBzdGF0aWMgdm9pZCBwdXRfaHVnZV9wYWdlcyhzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqLAo+ID4gQEAgLTE3NSw4ICsxNzYsMTEgQEAgaHVnZV9wYWdlc19vYmpl
Y3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgICAgICByZXR1cm4gb2JqOwo+
ID4gIH0KPiA+Cj4gPiAtc3RhdGljIGludCBmYWtlX2dldF9odWdlX3BhZ2VzKHN0cnVjdCBkcm1f
aTkxNV9nZW1fb2JqZWN0ICpvYmopCj4gPiArc3RhdGljIHN0cnVjdCBzZ190YWJsZSAqCj4gPiAr
ZmFrZV9nZXRfaHVnZV9wYWdlcyhzdHJ1Y3QgaTkxNV9nZW1fb2JqZWN0X2dldF9wYWdlc19jb250
ZXh0ICpjdHgsCj4gPiArICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgKnNpemVzKQo+ID4g
IHsKPiA+ICsgICAgIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSBjdHgtPm9iamVj
dDsKPiA+ICAgICAgIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShvYmot
PmJhc2UuZGV2KTsKPiA+ICAgICAgIGNvbnN0IHU2NCBtYXhfbGVuID0gcm91bmRkb3duX3Bvd19v
Zl90d28oVUlOVF9NQVgpOwo+ID4gICAgICAgc3RydWN0IHNnX3RhYmxlICpzdDsKPiA+IEBAIC0x
ODYsMTEgKzE5MCwxMSBAQCBzdGF0aWMgaW50IGZha2VfZ2V0X2h1Z2VfcGFnZXMoc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKm9iaikKPiA+Cj4gPiAgICAgICBzdCA9IGttYWxsb2Moc2l6ZW9m
KCpzdCksIEdGUCk7Cj4gPiAgICAgICBpZiAoIXN0KQo+ID4gLSAgICAgICAgICAgICByZXR1cm4g
LUVOT01FTTsKPiA+ICsgICAgICAgICAgICAgcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7Cj4gPgo+
ID4gICAgICAgaWYgKHNnX2FsbG9jX3RhYmxlKHN0LCBvYmotPmJhc2Uuc2l6ZSA+PiBQQUdFX1NI
SUZULCBHRlApKSB7Cj4gPiAgICAgICAgICAgICAgIGtmcmVlKHN0KTsKPiA+IC0gICAgICAgICAg
ICAgcmV0dXJuIC1FTk9NRU07Cj4gPiArICAgICAgICAgICAgIHJldHVybiBFUlJfUFRSKC1FTk9N
RU0pOwo+ID4gICAgICAgfQo+ID4KPiA+ICAgICAgIC8qIFVzZSBvcHRpbWFsIHBhZ2Ugc2l6ZWQg
Y2h1bmtzIHRvIGZpbGwgaW4gdGhlIHNnIHRhYmxlICovCj4gPiBAQCAtMjI3LDEzICsyMzEsMTUg
QEAgc3RhdGljIGludCBmYWtlX2dldF9odWdlX3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpvYmopCj4gPgo+ID4gICAgICAgb2JqLT5tbS5tYWR2ID0gSTkxNV9NQURWX0RPTlRORUVE
Owo+ID4KPiA+IC0gICAgIF9faTkxNV9nZW1fb2JqZWN0X3NldF9wYWdlcyhvYmosIHN0LCBzZ19w
YWdlX3NpemVzKTsKPiA+IC0KPiA+IC0gICAgIHJldHVybiAwOwo+ID4gKyAgICAgKnNpemVzID0g
c2dfcGFnZV9zaXplczsKPiA+ICsgICAgIHJldHVybiBzdDsKPiA+ICB9Cj4gPgo+ID4gLXN0YXRp
YyBpbnQgZmFrZV9nZXRfaHVnZV9wYWdlc19zaW5nbGUoc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iaikKPiA+ICtzdGF0aWMgc3RydWN0IHNnX3RhYmxlICoKPiA+ICtmYWtlX2dldF9odWdl
X3BhZ2VzX3NpbmdsZShzdHJ1Y3QgaTkxNV9nZW1fb2JqZWN0X2dldF9wYWdlc19jb250ZXh0ICpj
dHgsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50ICpzaXplcykKPiA+
ICB7Cj4gPiArICAgICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gY3R4LT5vYmpl
Y3Q7Cj4gPiAgICAgICBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUob2Jq
LT5iYXNlLmRldik7Cj4gPiAgICAgICBzdHJ1Y3Qgc2dfdGFibGUgKnN0Owo+ID4gICAgICAgc3Ry
dWN0IHNjYXR0ZXJsaXN0ICpzZzsKPiA+IEBAIC0yNDEsMTEgKzI0NywxMSBAQCBzdGF0aWMgaW50
IGZha2VfZ2V0X2h1Z2VfcGFnZXNfc2luZ2xlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpv
YmopCj4gPgo+ID4gICAgICAgc3QgPSBrbWFsbG9jKHNpemVvZigqc3QpLCBHRlApOwo+ID4gICAg
ICAgaWYgKCFzdCkKPiA+IC0gICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gPiArICAgICAg
ICAgICAgIHJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwo+ID4KPiA+ICAgICAgIGlmIChzZ19hbGxv
Y190YWJsZShzdCwgMSwgR0ZQKSkgewo+ID4gICAgICAgICAgICAgICBrZnJlZShzdCk7Cj4gPiAt
ICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwo+ID4gKyAgICAgICAgICAgICByZXR1cm4gRVJS
X1BUUigtRU5PTUVNKTsKPiA+ICAgICAgIH0KPiA+Cj4gPiAgICAgICBzZyA9IHN0LT5zZ2w7Cj4g
PiBAQCAtMjYxLDkgKzI2Nyw4IEBAIHN0YXRpYyBpbnQgZmFrZV9nZXRfaHVnZV9wYWdlc19zaW5n
bGUoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKPiA+Cj4gPiAgICAgICBvYmotPm1t
Lm1hZHYgPSBJOTE1X01BRFZfRE9OVE5FRUQ7Cj4gPgo+ID4gLSAgICAgX19pOTE1X2dlbV9vYmpl
Y3Rfc2V0X3BhZ2VzKG9iaiwgc3QsIHNnLT5sZW5ndGgpOwo+ID4gLQo+ID4gLSAgICAgcmV0dXJu
IDA7Cj4gPiArICAgICAqc2l6ZXMgPSBzZy0+bGVuZ3RoOwo+ID4gKyAgICAgcmV0dXJuIHN0Owo+
ID4gICN1bmRlZiBHRlAKPiA+ICB9Cj4gPgo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d2dC9kbWFidWYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9kbWFidWYuYwo+
ID4gaW5kZXggNDFjOGViYzYwYzYzLi5jMmE4MTkzOWY2OTggMTAwNjQ0Cj4gPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZG1hYnVmLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d2dC9kbWFidWYuYwo+ID4gQEAgLTM2LDkgKzM2LDExIEBACj4gPgo+ID4gICNkZWZpbmUg
R0VOOF9ERUNPREVfUFRFKHB0ZSkgKHB0ZSAmIEdFTk1BU0tfVUxMKDYzLCAxMikpCj4gPgo+ID4g
LXN0YXRpYyBpbnQgdmdwdV9nZW1fZ2V0X3BhZ2VzKAo+ID4gLSAgICAgICAgICAgICBzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQo+ID4gK3N0YXRpYyBzdHJ1Y3Qgc2dfdGFibGUgKgo+
ID4gK3ZncHVfZ2VtX2dldF9wYWdlcyhzdHJ1Y3QgaTkxNV9nZW1fb2JqZWN0X2dldF9wYWdlc19j
b250ZXh0ICpjdHgsCj4gPiArICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCAqc2l6ZXMpCj4g
PiAgewo+ID4gKyAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IGN0eC0+b2Jq
ZWN0Owo+ID4gICAgICAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShvYmotPmJhc2UuZGV2KTsKPiA+ICAgICAgIHN0cnVjdCBzZ190YWJsZSAqc3Q7Cj4gPiAgICAg
ICBzdHJ1Y3Qgc2NhdHRlcmxpc3QgKnNnOwo+ID4gQEAgLTQ5LDE3ICs1MSwxNyBAQCBzdGF0aWMg
aW50IHZncHVfZ2VtX2dldF9wYWdlcygKPiA+Cj4gPiAgICAgICBmYl9pbmZvID0gKHN0cnVjdCBp
bnRlbF92Z3B1X2ZiX2luZm8gKilvYmotPmd2dF9pbmZvOwo+ID4gICAgICAgaWYgKFdBUk5fT04o
IWZiX2luZm8pKQo+ID4gLSAgICAgICAgICAgICByZXR1cm4gLUVOT0RFVjsKPiA+ICsgICAgICAg
ICAgICAgcmV0dXJuIEVSUl9QVFIoLUVOT0RFVik7Cj4gPgo+ID4gICAgICAgc3QgPSBrbWFsbG9j
KHNpemVvZigqc3QpLCBHRlBfS0VSTkVMKTsKPiA+ICAgICAgIGlmICh1bmxpa2VseSghc3QpKQo+
ID4gLSAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKPiA+ICsgICAgICAgICAgICAgcmV0dXJu
IEVSUl9QVFIoLUVOT01FTSk7Cj4gPgo+ID4gICAgICAgcGFnZV9udW0gPSBvYmotPmJhc2Uuc2l6
ZSA+PiBQQUdFX1NISUZUOwo+ID4gICAgICAgcmV0ID0gc2dfYWxsb2NfdGFibGUoc3QsIHBhZ2Vf
bnVtLCBHRlBfS0VSTkVMKTsKPiA+ICAgICAgIGlmIChyZXQpIHsKPiA+ICAgICAgICAgICAgICAg
a2ZyZWUoc3QpOwo+ID4gLSAgICAgICAgICAgICByZXR1cm4gcmV0Owo+ID4gKyAgICAgICAgICAg
ICByZXR1cm4gRVJSX1BUUihyZXQpOwo+ID4gICAgICAgfQo+ID4gICAgICAgZ3R0X2VudHJpZXMg
PSAoZ2VuOF9wdGVfdCBfX2lvbWVtICopZGV2X3ByaXYtPmdndHQuZ3NtICsKPiA+ICAgICAgICAg
ICAgICAgKGZiX2luZm8tPnN0YXJ0ID4+IFBBR0VfU0hJRlQpOwo+ID4gQEAgLTcxLDkgKzczLDgg
QEAgc3RhdGljIGludCB2Z3B1X2dlbV9nZXRfcGFnZXMoCj4gPiAgICAgICAgICAgICAgIHNnX2Rt
YV9sZW4oc2cpID0gUEFHRV9TSVpFOwo+ID4gICAgICAgfQo+ID4KPiA+IC0gICAgIF9faTkxNV9n
ZW1fb2JqZWN0X3NldF9wYWdlcyhvYmosIHN0LCBQQUdFX1NJWkUpOwo+ID4gLQo+ID4gLSAgICAg
cmV0dXJuIDA7Cj4gPiArICAgICAqc2l6ZXMgPSBQQUdFX1NJWkU7Cj4gPiArICAgICByZXR1cm4g
c3Q7Cj4gPiAgfQo+ID4KPiA+ICBzdGF0aWMgdm9pZCB2Z3B1X2dlbV9wdXRfcGFnZXMoc3RydWN0
IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAo+ID4g
aW5kZXggOWExZWM0ODdlOGIxLi5lZjllNGNiNDliNGEgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2Rydi5oCj4gPiBAQCAtNzg2LDEzICs3ODYsNiBAQCBzdHJ1Y3QgaTkxNV9nZW1fbW0gewo+
ID4gICAgICAgc3RydWN0IG5vdGlmaWVyX2Jsb2NrIHZtYXBfbm90aWZpZXI7Cj4gPiAgICAgICBz
dHJ1Y3Qgc2hyaW5rZXIgc2hyaW5rZXI7Cj4gPgo+ID4gLSAgICAgLyoqCj4gPiAtICAgICAgKiBX
b3JrcXVldWUgdG8gZmF1bHQgaW4gdXNlcnB0ciBwYWdlcywgZmx1c2hlZCBieSB0aGUgZXhlY2J1
Zgo+ID4gLSAgICAgICogd2hlbiByZXF1aXJlZCBidXQgb3RoZXJ3aXNlIGxlZnQgdG8gdXNlcnNw
YWNlIHRvIHRyeSBhZ2Fpbgo+ID4gLSAgICAgICogb24gRUFHQUlOLgo+ID4gLSAgICAgICovCj4g
PiAtICAgICBzdHJ1Y3Qgd29ya3F1ZXVlX3N0cnVjdCAqdXNlcnB0cl93cTsKPiA+IC0KPiA+ICAg
ICAgIHU2NCB1bm9yZGVyZWRfdGltZWxpbmU7Cj4gPgo+ID4gICAgICAgLyogdGhlIGluZGljYXRv
ciBmb3IgZGlzcGF0Y2ggdmlkZW8gY29tbWFuZHMgb24gdHdvIEJTRCByaW5ncyAqLwo+ID4gQEAg
LTI1MTQsNyArMjUwNyw3IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF92Z3B1X2FjdGl2ZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgfQo+ID4KPiA+ICAvKiBpOTE1
X2dlbS5jICovCj4gPiAtaW50IGk5MTVfZ2VtX2luaXRfdXNlcnB0cihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gK3ZvaWQgaTkxNV9nZW1faW5pdF91c2VycHRyKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAgdm9pZCBpOTE1X2dlbV9jbGVhbnVw
X3VzZXJwdHIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICB2b2lkIGk5
MTVfZ2VtX3Nhbml0aXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICBpbnQg
aTkxNV9nZW1faW5pdF9lYXJseShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+
ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCj4gPiBpbmRleCAyMTQxNmI4NzkwNWUuLjE1NzFjNzA3
YWQxNSAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKPiA+
ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKPiA+IEBAIC0xNTQ0LDEwICsx
NTQ0LDcgQEAgaW50IGk5MTVfZ2VtX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ID4gICAgICAgZGV2X3ByaXYtPm1tLnVub3JkZXJlZF90aW1lbGluZSA9IGRtYV9mZW5j
ZV9jb250ZXh0X2FsbG9jKDEpOwo+ID4KPiA+ICAgICAgIGk5MTVfdGltZWxpbmVzX2luaXQoZGV2
X3ByaXYpOwo+ID4gLQo+ID4gLSAgICAgcmV0ID0gaTkxNV9nZW1faW5pdF91c2VycHRyKGRldl9w
cml2KTsKPiA+IC0gICAgIGlmIChyZXQpCj4gPiAtICAgICAgICAgICAgIHJldHVybiByZXQ7Cj4g
PiArICAgICBpOTE1X2dlbV9pbml0X3VzZXJwdHIoZGV2X3ByaXYpOwo+ID4KPiA+ICAgICAgIHJl
dCA9IGludGVsX3VjX2luaXRfbWlzYyhkZXZfcHJpdik7Cj4gPiAgICAgICBpZiAocmV0KQo+ID4g
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ndHQu
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ndHQuYwo+ID4gaW5k
ZXggNjY0YjdlM2UxZDdjLi5kYWUxZjg2MzRhMzggMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZ3R0LmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ndHQuYwo+ID4gQEAgLTU0LDEwICs1NCwxMyBA
QCBzdGF0aWMgdm9pZCBmYWtlX2ZyZWVfcGFnZXMoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iaiwKPiA+ICAgICAgIGtmcmVlKHBhZ2VzKTsKPiA+ICB9Cj4gPgo+ID4gLXN0YXRpYyBpbnQg
ZmFrZV9nZXRfcGFnZXMoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKPiA+ICtzdGF0
aWMgc3RydWN0IHNnX3RhYmxlICoKPiA+ICtmYWtlX2dldF9wYWdlcyhzdHJ1Y3QgaTkxNV9nZW1f
b2JqZWN0X2dldF9wYWdlc19jb250ZXh0ICpjdHgsCj4gPiArICAgICAgICAgICAgdW5zaWduZWQg
aW50ICpzaXplcykKPiA+ICB7Cj4gPiAgI2RlZmluZSBHRlAgKEdGUF9LRVJORUwgfCBfX0dGUF9O
T1dBUk4gfCBfX0dGUF9OT1JFVFJZKQo+ID4gICNkZWZpbmUgUEZOX0JJQVMgMHgxMDAwCj4gPiAr
ICAgICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gY3R4LT5vYmplY3Q7Cj4gPiAg
ICAgICBzdHJ1Y3Qgc2dfdGFibGUgKnBhZ2VzOwo+ID4gICAgICAgc3RydWN0IHNjYXR0ZXJsaXN0
ICpzZzsKPiA+ICAgICAgIHVuc2lnbmVkIGludCBzZ19wYWdlX3NpemVzOwo+ID4gQEAgLTY1LDEy
ICs2OCwxMiBAQCBzdGF0aWMgaW50IGZha2VfZ2V0X3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICpvYmopCj4gPgo+ID4gICAgICAgcGFnZXMgPSBrbWFsbG9jKHNpemVvZigqcGFnZXMp
LCBHRlApOwo+ID4gICAgICAgaWYgKCFwYWdlcykKPiA+IC0gICAgICAgICAgICAgcmV0dXJuIC1F
Tk9NRU07Cj4gPiArICAgICAgICAgICAgIHJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwo+ID4KPiA+
ICAgICAgIHJlbSA9IHJvdW5kX3VwKG9iai0+YmFzZS5zaXplLCBCSVQoMzEpKSA+PiAzMTsKPiA+
ICAgICAgIGlmIChzZ19hbGxvY190YWJsZShwYWdlcywgcmVtLCBHRlApKSB7Cj4gPiAgICAgICAg
ICAgICAgIGtmcmVlKHBhZ2VzKTsKPiA+IC0gICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4g
PiArICAgICAgICAgICAgIHJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwo+ID4gICAgICAgfQo+ID4K
PiA+ICAgICAgIHNnX3BhZ2Vfc2l6ZXMgPSAwOwo+ID4gQEAgLTkwLDkgKzkzLDggQEAgc3RhdGlj
IGludCBmYWtlX2dldF9wYWdlcyhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQo+ID4K
PiA+ICAgICAgIG9iai0+bW0ubWFkdiA9IEk5MTVfTUFEVl9ET05UTkVFRDsKPiA+Cj4gPiAtICAg
ICBfX2k5MTVfZ2VtX29iamVjdF9zZXRfcGFnZXMob2JqLCBwYWdlcywgc2dfcGFnZV9zaXplcyk7
Cj4gPiAtCj4gPiAtICAgICByZXR1cm4gMDsKPiA+ICsgICAgICpzaXplcyA9IHNnX3BhZ2Vfc2l6
ZXM7Cj4gPiArICAgICByZXR1cm4gcGFnZXM7Cj4gPiAgI3VuZGVmIEdGUAo+ID4gIH0KPiA+Cj4g
PiAtLQo+ID4gMi4yMC4xCj4gPgo+ID4gX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX18KPiA+IEludGVsLWdmeCBtYWlsaW5nIGxpc3QKPiA+IEludGVsLWdmeEBs
aXN0cy5mcmVlZGVza3RvcC5vcmcKPiA+IGh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21h
aWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4Cj4KPiAtLQo+IERhbmllbCBWZXR0ZXIKPiBTb2Z0d2Fy
ZSBFbmdpbmVlciwgSW50ZWwgQ29ycG9yYXRpb24KPiBodHRwOi8vYmxvZy5mZndsbC5jaAoKCgot
LQpEYW5pZWwgVmV0dGVyClNvZnR3YXJlIEVuZ2luZWVyLCBJbnRlbCBDb3Jwb3JhdGlvbgorNDEg
KDApIDc5IDM2NSA1NyA0OCAtIGh0dHA6Ly9ibG9nLmZmd2xsLmNoCl9fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJp
LWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9y
Zy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
