Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 6AD7059AF5
	for <lists+dri-devel@lfdr.de>; Fri, 28 Jun 2019 14:27:20 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 355B06E916;
	Fri, 28 Jun 2019 12:27:12 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8D8456E913
 for <dri-devel@lists.freedesktop.org>; Fri, 28 Jun 2019 12:27:05 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id D87EAB62B;
 Fri, 28 Jun 2019 12:27:03 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: kraxel@redhat.com, airlied@redhat.com, daniel@ffwll.ch,
 maarten.lankhorst@linux.intel.com, maxime.ripard@bootlin.com,
 sean@poorly.run, sam@ravnborg.org, dri-devel@lists.freedesktop.org,
 z.liuxinliang@hisilicon.com, zourongrong@gmail.com,
 kong.kongxinwei@hisilicon.com, puck.chen@hisilicon.com
Subject: [PATCH 1/4] drm/vram: Set GEM object functions for PRIME
Date: Fri, 28 Jun 2019 14:26:56 +0200
Message-Id: <20190628122659.31887-2-tzimmermann@suse.de>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190628122659.31887-1-tzimmermann@suse.de>
References: <20190628122659.31887-1-tzimmermann@suse.de>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Zimmermann <tzimmermann@suse.de>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

UFJJTUUgZnVuY3Rpb25hbGl0eSBpcyBub3cgcHJvdmlkZWQgdmlhIHRoZSBjYWxsYmFjayBmdW5j
dGlvbnMgaW4Kc3RydWN0IGRybV9nZW1fb2JqZWN0X2Z1bmNzLiBUaGUgZHJpdmVyLXN0cnVjdHVy
ZSBmdW5jdGlvbnMgYXJlIG9ic29sZXRlLgpBcyBhIHNpZGUgZWZmZWN0IG9mIHRoaXMgcGF0Y2gs
IFZSQU0tYmFzZWQgZHJpdmVycyBnZXQgYmFzaWMgUFJJTUUKc3VwcG9ydCBhdXRvbWF0aWNhbGx5
IHdpdGhvdXQgaGF2aW5nIHRvIHNldCBhbnkgZmxhZ3Mgb3IgYWRkaXRpb25hbApmaWVsZHMuCgpT
aWduZWQtb2ZmLWJ5OiBUaG9tYXMgWmltbWVybWFubiA8dHppbW1lcm1hbm5Ac3VzZS5kZT4KLS0t
CiBkcml2ZXJzL2dwdS9kcm0vZHJtX2dlbV92cmFtX2hlbHBlci5jIHwgNzAgKysrKysrKysrKysr
KysrKysrKysrKysrKysrCiBpbmNsdWRlL2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmggICAgIHwg
IDMgKy0KIDIgZmlsZXMgY2hhbmdlZCwgNzIgaW5zZXJ0aW9ucygrKSwgMSBkZWxldGlvbigtKQoK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMgYi9kcml2
ZXJzL2dwdS9kcm0vZHJtX2dlbV92cmFtX2hlbHBlci5jCmluZGV4IDRkZTc4MmNhMjZiMi4uZGQy
MjA3OTVlNzI1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2dlbV92cmFtX2hlbHBl
ci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMKQEAgLTE0LDYg
KzE0LDczIEBACiAgKiAoVlJBTSkuIEl0IGNhbiBiZSB1c2VkIGZvciBmcmFtZWJ1ZmZlciBkZXZp
Y2VzIHdpdGggZGVkaWNhdGVkIG1lbW9yeS4KICAqLwogCisvKgorICogR0VNIG9iamVjdCBmdW5j
cworICovCisKK3N0YXRpYyB2b2lkIGRybV9nZW1fdnJhbV9vYmplY3RfZnJlZShzdHJ1Y3QgZHJt
X2dlbV9vYmplY3QgKmdlbSkKK3sKKwlzdHJ1Y3QgZHJtX2dlbV92cmFtX29iamVjdCAqZ2JvID0g
ZHJtX2dlbV92cmFtX29mX2dlbShnZW0pOworCisJZHJtX2dlbV92cmFtX3B1dChnYm8pOworfQor
CitzdGF0aWMgaW50IGRybV9nZW1fdnJhbV9vYmplY3RfZnVuY3NfcGluKHN0cnVjdCBkcm1fZ2Vt
X29iamVjdCAqZ2VtKQoreworCXN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8gPSBkcm1f
Z2VtX3ZyYW1fb2ZfZ2VtKGdlbSk7CisKKwkvKiBGYmRldiBjb25zb2xlIGVtdWxhdGlvbiBpcyB0
aGUgdXNlIGNhc2Ugb2YgdGhlc2UgUFJJTUUKKwkgKiBoZWxwZXJzLiBUaGlzIG1heSBpbnZvbHZl
IHVwZGF0aW5nIGEgaGFyZHdhcmUgYnVmZmVyIGZyb20KKwkgKiBhIHNoYWRvdyBGQi4gV2UgcGlu
IHRoZSBidWZmZXIgdG8gaXQncyBjdXJyZW50IGxvY2F0aW9uCisJICogKGVpdGhlciB2aWRlbyBS
QU0gb3Igc3lzdGVtIG1lbW9yeSkgdG8gcHJldmVudCBpdCBmcm9tCisJICogYmVpbmcgcmVsb2Nh
dGVkIGR1cmluZyB0aGUgdXBkYXRlIG9wZXJhdGlvbi4gSWYgeW91IHJlcXVpcmUKKwkgKiB0aGUg
YnVmZmVyIHRvIGJlIHBpbm5lZCB0byBWUkFNLCBpbXBsZW1lbnQgYSBjYWxsYmFjayB0aGF0CisJ
ICogc2V0cyB0aGUgZmxhZ3MgYWNjb3JkaW5nbHkuCisJICovCisJcmV0dXJuIGRybV9nZW1fdnJh
bV9waW4oZ2JvLCAwKTsKK30KKworc3RhdGljIHZvaWQgZHJtX2dlbV92cmFtX29iamVjdF9mdW5j
c191bnBpbihzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdlbSkKK3sKKwlzdHJ1Y3QgZHJtX2dlbV92
cmFtX29iamVjdCAqZ2JvID0gZHJtX2dlbV92cmFtX29mX2dlbShnZW0pOworCisJZHJtX2dlbV92
cmFtX3VucGluKGdibyk7Cit9CisKK3N0YXRpYyB2b2lkICpkcm1fZ2VtX3ZyYW1fb2JqZWN0X2Z1
bmNzX3ZtYXAoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpnZW0pCit7CisJc3RydWN0IGRybV9nZW1f
dnJhbV9vYmplY3QgKmdibyA9IGRybV9nZW1fdnJhbV9vZl9nZW0oZ2VtKTsKKwlpbnQgcmV0Owor
CXZvaWQgKmJhc2U7CisKKwlyZXQgPSBkcm1fZ2VtX3ZyYW1fcGluKGdibywgMCk7CisJaWYgKHJl
dCkKKwkJcmV0dXJuIE5VTEw7CisJYmFzZSA9IGRybV9nZW1fdnJhbV9rbWFwKGdibywgdHJ1ZSwg
TlVMTCk7CisJaWYgKElTX0VSUihiYXNlKSkgeworCQlkcm1fZ2VtX3ZyYW1fdW5waW4oZ2JvKTsK
KwkJcmV0dXJuIE5VTEw7CisJfQorCXJldHVybiBiYXNlOworfQorCitzdGF0aWMgdm9pZCBkcm1f
Z2VtX3ZyYW1fb2JqZWN0X2Z1bmNzX3Z1bm1hcChzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdlbSwK
KwkJCQkJICAgICB2b2lkICp2YWRkcikKK3sKKwlzdHJ1Y3QgZHJtX2dlbV92cmFtX29iamVjdCAq
Z2JvID0gZHJtX2dlbV92cmFtX29mX2dlbShnZW0pOworCisJZHJtX2dlbV92cmFtX2t1bm1hcChn
Ym8pOworCWRybV9nZW1fdnJhbV91bnBpbihnYm8pOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0
IGRybV9nZW1fb2JqZWN0X2Z1bmNzIGRybV9nZW1fdnJhbV9vYmplY3RfZnVuY3MgPSB7CisJLmZy
ZWUJPSBkcm1fZ2VtX3ZyYW1fb2JqZWN0X2ZyZWUsCisJLnBpbgk9IGRybV9nZW1fdnJhbV9vYmpl
Y3RfZnVuY3NfcGluLAorCS51bnBpbgk9IGRybV9nZW1fdnJhbV9vYmplY3RfZnVuY3NfdW5waW4s
CisJLnZtYXAJPSBkcm1fZ2VtX3ZyYW1fb2JqZWN0X2Z1bmNzX3ZtYXAsCisJLnZ1bm1hcAk9IGRy
bV9nZW1fdnJhbV9vYmplY3RfZnVuY3NfdnVubWFwCit9OworCiAvKgogICogQnVmZmVyLW9iamVj
dHMgaGVscGVycwogICovCkBAIC04MCw2ICsxNDcsOSBAQCBzdGF0aWMgaW50IGRybV9nZW1fdnJh
bV9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJaW50IHJldDsKIAlzaXplX3QgYWNjX3Np
emU7CiAKKwlpZiAoIWdiby0+Z2VtLmZ1bmNzKQorCQlnYm8tPmdlbS5mdW5jcyA9ICZkcm1fZ2Vt
X3ZyYW1fb2JqZWN0X2Z1bmNzOworCiAJcmV0ID0gZHJtX2dlbV9vYmplY3RfaW5pdChkZXYsICZn
Ym8tPmdlbSwgc2l6ZSk7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKZGlmZiAtLWdpdCBhL2lu
Y2x1ZGUvZHJtL2RybV9nZW1fdnJhbV9oZWxwZXIuaCBiL2luY2x1ZGUvZHJtL2RybV9nZW1fdnJh
bV9oZWxwZXIuaAppbmRleCAxYTBlYTE4ZTdhNzQuLmJjOGZlOWZlZWUzYiAxMDA2NDQKLS0tIGEv
aW5jbHVkZS9kcm0vZHJtX2dlbV92cmFtX2hlbHBlci5oCisrKyBiL2luY2x1ZGUvZHJtL2RybV9n
ZW1fdnJhbV9oZWxwZXIuaApAQCAtMTI3LDcgKzEyNyw4IEBAIGludCBkcm1fZ2VtX3ZyYW1fZHJp
dmVyX2R1bWJfbW1hcF9vZmZzZXQoc3RydWN0IGRybV9maWxlICpmaWxlLAogCS5nZW1fZnJlZV9v
YmplY3RfdW5sb2NrZWQgPSBcCiAJCWRybV9nZW1fdnJhbV9kcml2ZXJfZ2VtX2ZyZWVfb2JqZWN0
X3VubG9ja2VkLCBcCiAJLmR1bWJfY3JlYXRlCQkgID0gZHJtX2dlbV92cmFtX2RyaXZlcl9kdW1i
X2NyZWF0ZSwgXAotCS5kdW1iX21hcF9vZmZzZXQJICA9IGRybV9nZW1fdnJhbV9kcml2ZXJfZHVt
Yl9tbWFwX29mZnNldAorCS5kdW1iX21hcF9vZmZzZXQJICA9IGRybV9nZW1fdnJhbV9kcml2ZXJf
ZHVtYl9tbWFwX29mZnNldCwgXAorCS5nZW1fcHJpbWVfbW1hcAkJICA9IGRybV9nZW1fcHJpbWVf
bW1hcAogCiAvKgogICogUFJJTUUgaGVscGVycyBmb3Igc3RydWN0IGRybV9kcml2ZXIKLS0gCjIu
MjEuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJp
LWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
