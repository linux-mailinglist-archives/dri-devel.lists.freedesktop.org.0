Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1E399CB0B7
	for <lists+dri-devel@lfdr.de>; Thu,  3 Oct 2019 23:01:35 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8784A6EA83;
	Thu,  3 Oct 2019 21:01:27 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id DE1796EA7A;
 Thu,  3 Oct 2019 21:01:25 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18715181-1500050 
 for multiple; Thu, 03 Oct 2019 22:01:04 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Subject: [PATCH 3/5] drm/mm: Use helpers for drm_mm_node booleans
Date: Thu,  3 Oct 2019 22:00:58 +0100
Message-Id: <20191003210100.22250-3-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191003210100.22250-1-chris@chris-wilson.co.uk>
References: <20191003210100.22250-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: dri-devel@lists.freedesktop.org, tvrtko.ursulin@intel.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW4gcHJlcGFyYXRpb24gZm9yIHJlYXJyYW5naW5nIHRoZSBib29sZWFucyBpbnRvIGEgZmxhZ3Mg
ZmllbGQsIGVuc3VyZQphbGwgdGhlIGN1cnJlbnQgdXNlcnMgYXJlIHVzaW5nIHRoZSBpbmxpbmUg
aGVscGVycyBhbmQgbm90IGRpcmVjdGx5CmFjY2Vzc2luZyB0aGUgbWVtYmVycy4KClNpZ25lZC1v
ZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgotLS0KIGRyaXZl
cnMvZ3B1L2RybS9kcm1fbW0uYyAgICAgICAgICAgICAgICAgICAgICB8IDE5ICsrKysrKysrKysr
Ky0tLS0tLS0KIC4uLi9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyAgICB8
ICA0ICsrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX3VjX2Z3LmMgICAgICB8
ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jICAgICAgICAgICAgICAgfCAx
MiArKysrKystLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2V2aWN0LmMgICAg
ICAgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jICAgICAgICAgICAg
ICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuaCAgICAgICAgICAgICAg
IHwgIDQgKystLQogZHJpdmVycy9ncHUvZHJtL3NlbGZ0ZXN0cy90ZXN0LWRybV9tbS5jICAgICAg
IHwgMTQgKysrKysrKy0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS92YzQvdmM0X2NydGMuYyAgICAg
ICAgICAgICAgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vdmM0L3ZjNF9odnMuYyAgICAgICAg
ICAgICAgICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL3ZjNC92YzRfcGxhbmUuYyAgICAgICAg
ICAgICAgIHwgIDQgKystLQogMTEgZmlsZXMgY2hhbmdlZCwgMzYgaW5zZXJ0aW9ucygrKSwgMzEg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2RybV9tbS5jIGIvZHJp
dmVycy9ncHUvZHJtL2RybV9tbS5jCmluZGV4IDQ1ODFjNTM4NzM3Mi4uOTkzMTJiZGM2MjczIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vZHJtX21tLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2RybV9tbS5jCkBAIC0xNzQsNyArMTc0LDcgQEAgc3RhdGljIHZvaWQgZHJtX21tX2ludGVydmFs
X3RyZWVfYWRkX25vZGUoc3RydWN0IGRybV9tbV9ub2RlICpob2xlX25vZGUsCiAKIAlub2RlLT5f
X3N1YnRyZWVfbGFzdCA9IExBU1Qobm9kZSk7CiAKLQlpZiAoaG9sZV9ub2RlLT5hbGxvY2F0ZWQp
IHsKKwlpZiAoZHJtX21tX25vZGVfYWxsb2NhdGVkKGhvbGVfbm9kZSkpIHsKIAkJcmIgPSAmaG9s
ZV9ub2RlLT5yYjsKIAkJd2hpbGUgKHJiKSB7CiAJCQlwYXJlbnQgPSByYl9lbnRyeShyYiwgc3Ry
dWN0IGRybV9tbV9ub2RlLCByYik7CkBAIC01NjEsNiArNTYxLDExIEBAIGludCBkcm1fbW1faW5z
ZXJ0X25vZGVfaW5fcmFuZ2Uoc3RydWN0IGRybV9tbSAqIGNvbnN0IG1tLAogfQogRVhQT1JUX1NZ
TUJPTChkcm1fbW1faW5zZXJ0X25vZGVfaW5fcmFuZ2UpOwogCitzdGF0aWMgaW5saW5lIGJvb2wg
ZHJtX21tX25vZGVfc2Nhbm5lZF9ibG9jayhjb25zdCBzdHJ1Y3QgZHJtX21tX25vZGUgKm5vZGUp
Cit7CisJcmV0dXJuIG5vZGUtPnNjYW5uZWRfYmxvY2s7Cit9CisKIC8qKgogICogZHJtX21tX3Jl
bW92ZV9ub2RlIC0gUmVtb3ZlIGEgbWVtb3J5IG5vZGUgZnJvbSB0aGUgYWxsb2NhdG9yLgogICog
QG5vZGU6IGRybV9tbV9ub2RlIHRvIHJlbW92ZQpAQCAtNTc0LDggKzU3OSw4IEBAIHZvaWQgZHJt
X21tX3JlbW92ZV9ub2RlKHN0cnVjdCBkcm1fbW1fbm9kZSAqbm9kZSkKIAlzdHJ1Y3QgZHJtX21t
ICptbSA9IG5vZGUtPm1tOwogCXN0cnVjdCBkcm1fbW1fbm9kZSAqcHJldl9ub2RlOwogCi0JRFJN
X01NX0JVR19PTighbm9kZS0+YWxsb2NhdGVkKTsKLQlEUk1fTU1fQlVHX09OKG5vZGUtPnNjYW5u
ZWRfYmxvY2spOworCURSTV9NTV9CVUdfT04oIWRybV9tbV9ub2RlX2FsbG9jYXRlZChub2RlKSk7
CisJRFJNX01NX0JVR19PTihkcm1fbW1fbm9kZV9zY2FubmVkX2Jsb2NrKG5vZGUpKTsKIAogCXBy
ZXZfbm9kZSA9IGxpc3RfcHJldl9lbnRyeShub2RlLCBub2RlX2xpc3QpOwogCkBAIC02MDUsNyAr
NjEwLDcgQEAgdm9pZCBkcm1fbW1fcmVwbGFjZV9ub2RlKHN0cnVjdCBkcm1fbW1fbm9kZSAqb2xk
LCBzdHJ1Y3QgZHJtX21tX25vZGUgKm5ldykKIHsKIAlzdHJ1Y3QgZHJtX21tICptbSA9IG9sZC0+
bW07CiAKLQlEUk1fTU1fQlVHX09OKCFvbGQtPmFsbG9jYXRlZCk7CisJRFJNX01NX0JVR19PTigh
ZHJtX21tX25vZGVfYWxsb2NhdGVkKG9sZCkpOwogCiAJKm5ldyA9ICpvbGQ7CiAKQEAgLTczMSw4
ICs3MzYsOCBAQCBib29sIGRybV9tbV9zY2FuX2FkZF9ibG9jayhzdHJ1Y3QgZHJtX21tX3NjYW4g
KnNjYW4sCiAJdTY0IGFkal9zdGFydCwgYWRqX2VuZDsKIAogCURSTV9NTV9CVUdfT04obm9kZS0+
bW0gIT0gbW0pOwotCURSTV9NTV9CVUdfT04oIW5vZGUtPmFsbG9jYXRlZCk7Ci0JRFJNX01NX0JV
R19PTihub2RlLT5zY2FubmVkX2Jsb2NrKTsKKwlEUk1fTU1fQlVHX09OKCFkcm1fbW1fbm9kZV9h
bGxvY2F0ZWQobm9kZSkpOworCURSTV9NTV9CVUdfT04oZHJtX21tX25vZGVfc2Nhbm5lZF9ibG9j
ayhub2RlKSk7CiAJbm9kZS0+c2Nhbm5lZF9ibG9jayA9IHRydWU7CiAJbW0tPnNjYW5fYWN0aXZl
Kys7CiAKQEAgLTgxOCw3ICs4MjMsNyBAQCBib29sIGRybV9tbV9zY2FuX3JlbW92ZV9ibG9jayhz
dHJ1Y3QgZHJtX21tX3NjYW4gKnNjYW4sCiAJc3RydWN0IGRybV9tbV9ub2RlICpwcmV2X25vZGU7
CiAKIAlEUk1fTU1fQlVHX09OKG5vZGUtPm1tICE9IHNjYW4tPm1tKTsKLQlEUk1fTU1fQlVHX09O
KCFub2RlLT5zY2FubmVkX2Jsb2NrKTsKKwlEUk1fTU1fQlVHX09OKCFkcm1fbW1fbm9kZV9zY2Fu
bmVkX2Jsb2NrKG5vZGUpKTsKIAlub2RlLT5zY2FubmVkX2Jsb2NrID0gZmFsc2U7CiAKIAlEUk1f
TU1fQlVHX09OKCFub2RlLT5tbS0+c2Nhbl9hY3RpdmUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKaW5kZXggMjdkYmNiNTA4MDU1Li4yMGQ4YTYy
OTc5ODUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVj
YnVmZmVyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZm
ZXIuYwpAQCAtOTY4LDcgKzk2OCw3IEBAIHN0YXRpYyB2b2lkIHJlbG9jX2NhY2hlX3Jlc2V0KHN0
cnVjdCByZWxvY19jYWNoZSAqY2FjaGUpCiAJCWludGVsX2d0X2ZsdXNoX2dndHRfd3JpdGVzKGdn
dHQtPnZtLmd0KTsKIAkJaW9fbWFwcGluZ191bm1hcF9hdG9taWMoKHZvaWQgX19pb21lbSAqKXZh
ZGRyKTsKIAotCQlpZiAoY2FjaGUtPm5vZGUuYWxsb2NhdGVkKSB7CisJCWlmIChkcm1fbW1fbm9k
ZV9hbGxvY2F0ZWQoJmNhY2hlLT5ub2RlKSkgewogCQkJZ2d0dC0+dm0uY2xlYXJfcmFuZ2UoJmdn
dHQtPnZtLAogCQkJCQkgICAgIGNhY2hlLT5ub2RlLnN0YXJ0LAogCQkJCQkgICAgIGNhY2hlLT5u
b2RlLnNpemUpOwpAQCAtMTA2MSw3ICsxMDYxLDcgQEAgc3RhdGljIHZvaWQgKnJlbG9jX2lvbWFw
KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJfQogCiAJb2Zmc2V0ID0gY2FjaGUt
Pm5vZGUuc3RhcnQ7Ci0JaWYgKGNhY2hlLT5ub2RlLmFsbG9jYXRlZCkgeworCWlmIChkcm1fbW1f
bm9kZV9hbGxvY2F0ZWQoJmNhY2hlLT5ub2RlKSkgewogCQlnZ3R0LT52bS5pbnNlcnRfcGFnZSgm
Z2d0dC0+dm0sCiAJCQkJICAgICBpOTE1X2dlbV9vYmplY3RfZ2V0X2RtYV9hZGRyZXNzKG9iaiwg
cGFnZSksCiAJCQkJICAgICBvZmZzZXQsIEk5MTVfQ0FDSEVfTk9ORSwgMCk7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF91Y19mdy5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvdWMvaW50ZWxfdWNfZncuYwppbmRleCBiYjg3ODExOWYwNmMuLmJiNDg4OWQy
MzQ2ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfdWNfZncu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF91Y19mdy5jCkBAIC0zODcs
NyArMzg3LDcgQEAgc3RhdGljIHUzMiB1Y19md19nZ3R0X29mZnNldChzdHJ1Y3QgaW50ZWxfdWNf
ZncgKnVjX2Z3LCBzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0KQogewogCXN0cnVjdCBkcm1fbW1fbm9k
ZSAqbm9kZSA9ICZnZ3R0LT51Y19mdzsKIAotCUdFTV9CVUdfT04oIW5vZGUtPmFsbG9jYXRlZCk7
CisJR0VNX0JVR19PTighZHJtX21tX25vZGVfYWxsb2NhdGVkKG5vZGUpKTsKIAlHRU1fQlVHX09O
KHVwcGVyXzMyX2JpdHMobm9kZS0+c3RhcnQpKTsKIAlHRU1fQlVHX09OKHVwcGVyXzMyX2JpdHMo
bm9kZS0+c3RhcnQgKyBub2RlLT5zaXplIC0gMSkpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwpp
bmRleCAxNDI2ZTUwNjcwMGQuLmZhOGUwMjhhYzBiNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9nZW0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5j
CkBAIC0zNTYsNyArMzU2LDcgQEAgaTkxNV9nZW1fZ3R0X3ByZWFkKHN0cnVjdCBkcm1faTkxNV9n
ZW1fb2JqZWN0ICpvYmosCiAJCXJldCA9IGluc2VydF9tYXBwYWJsZV9ub2RlKGdndHQsICZub2Rl
LCBQQUdFX1NJWkUpOwogCQlpZiAocmV0KQogCQkJZ290byBvdXRfdW5sb2NrOwotCQlHRU1fQlVH
X09OKCFub2RlLmFsbG9jYXRlZCk7CisJCUdFTV9CVUdfT04oIWRybV9tbV9ub2RlX2FsbG9jYXRl
ZCgmbm9kZSkpOwogCX0KIAogCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7
CkBAIC0zOTMsNyArMzkzLDcgQEAgaTkxNV9nZW1fZ3R0X3ByZWFkKHN0cnVjdCBkcm1faTkxNV9n
ZW1fb2JqZWN0ICpvYmosCiAJCXVuc2lnbmVkIHBhZ2Vfb2Zmc2V0ID0gb2Zmc2V0X2luX3BhZ2Uo
b2Zmc2V0KTsKIAkJdW5zaWduZWQgcGFnZV9sZW5ndGggPSBQQUdFX1NJWkUgLSBwYWdlX29mZnNl
dDsKIAkJcGFnZV9sZW5ndGggPSByZW1haW4gPCBwYWdlX2xlbmd0aCA/IHJlbWFpbiA6IHBhZ2Vf
bGVuZ3RoOwotCQlpZiAobm9kZS5hbGxvY2F0ZWQpIHsKKwkJaWYgKGRybV9tbV9ub2RlX2FsbG9j
YXRlZCgmbm9kZSkpIHsKIAkJCWdndHQtPnZtLmluc2VydF9wYWdlKCZnZ3R0LT52bSwKIAkJCQkJ
ICAgICBpOTE1X2dlbV9vYmplY3RfZ2V0X2RtYV9hZGRyZXNzKG9iaiwgb2Zmc2V0ID4+IFBBR0Vf
U0hJRlQpLAogCQkJCQkgICAgIG5vZGUuc3RhcnQsIEk5MTVfQ0FDSEVfTk9ORSwgMCk7CkBAIC00
MTUsNyArNDE1LDcgQEAgaTkxNV9nZW1fZ3R0X3ByZWFkKHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpvYmosCiAJaTkxNV9nZW1fb2JqZWN0X3VubG9ja19mZW5jZShvYmosIGZlbmNlKTsKIG91
dF91bnBpbjoKIAltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQlpZiAobm9k
ZS5hbGxvY2F0ZWQpIHsKKwlpZiAoZHJtX21tX25vZGVfYWxsb2NhdGVkKCZub2RlKSkgewogCQln
Z3R0LT52bS5jbGVhcl9yYW5nZSgmZ2d0dC0+dm0sIG5vZGUuc3RhcnQsIG5vZGUuc2l6ZSk7CiAJ
CXJlbW92ZV9tYXBwYWJsZV9ub2RlKCZub2RlKTsKIAl9IGVsc2UgewpAQCAtNTY2LDcgKzU2Niw3
IEBAIGk5MTVfZ2VtX2d0dF9wd3JpdGVfZmFzdChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAq
b2JqLAogCQlyZXQgPSBpbnNlcnRfbWFwcGFibGVfbm9kZShnZ3R0LCAmbm9kZSwgUEFHRV9TSVpF
KTsKIAkJaWYgKHJldCkKIAkJCWdvdG8gb3V0X3JwbTsKLQkJR0VNX0JVR19PTighbm9kZS5hbGxv
Y2F0ZWQpOworCQlHRU1fQlVHX09OKCFkcm1fbW1fbm9kZV9hbGxvY2F0ZWQoJm5vZGUpKTsKIAl9
CiAKIAltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwpAQCAtNjA0LDcgKzYw
NCw3IEBAIGk5MTVfZ2VtX2d0dF9wd3JpdGVfZmFzdChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dCAqb2JqLAogCQl1bnNpZ25lZCBpbnQgcGFnZV9vZmZzZXQgPSBvZmZzZXRfaW5fcGFnZShvZmZz
ZXQpOwogCQl1bnNpZ25lZCBpbnQgcGFnZV9sZW5ndGggPSBQQUdFX1NJWkUgLSBwYWdlX29mZnNl
dDsKIAkJcGFnZV9sZW5ndGggPSByZW1haW4gPCBwYWdlX2xlbmd0aCA/IHJlbWFpbiA6IHBhZ2Vf
bGVuZ3RoOwotCQlpZiAobm9kZS5hbGxvY2F0ZWQpIHsKKwkJaWYgKGRybV9tbV9ub2RlX2FsbG9j
YXRlZCgmbm9kZSkpIHsKIAkJCS8qIGZsdXNoIHRoZSB3cml0ZSBiZWZvcmUgd2UgbW9kaWZ5IHRo
ZSBHR1RUICovCiAJCQlpbnRlbF9ndF9mbHVzaF9nZ3R0X3dyaXRlcyhnZ3R0LT52bS5ndCk7CiAJ
CQlnZ3R0LT52bS5pbnNlcnRfcGFnZSgmZ2d0dC0+dm0sCkBAIC02MzYsNyArNjM2LDcgQEAgaTkx
NV9nZW1fZ3R0X3B3cml0ZV9mYXN0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiBv
dXRfdW5waW46CiAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJaW50ZWxf
Z3RfZmx1c2hfZ2d0dF93cml0ZXMoZ2d0dC0+dm0uZ3QpOwotCWlmIChub2RlLmFsbG9jYXRlZCkg
eworCWlmIChkcm1fbW1fbm9kZV9hbGxvY2F0ZWQoJm5vZGUpKSB7CiAJCWdndHQtPnZtLmNsZWFy
X3JhbmdlKCZnZ3R0LT52bSwgbm9kZS5zdGFydCwgbm9kZS5zaXplKTsKIAkJcmVtb3ZlX21hcHBh
YmxlX25vZGUoJm5vZGUpOwogCX0gZWxzZSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2dlbV9ldmljdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZXZp
Y3QuYwppbmRleCBlNzZjOWRhOTk5MmQuLjhjMWUwNGY0MDJiYyAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZXZpY3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2dlbV9ldmljdC5jCkBAIC0yOTksNyArMjk5LDcgQEAgaW50IGk5MTVfZ2VtX2V2aWN0
X2Zvcl9ub2RlKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLAogCQkJYnJlYWs7CiAJCX0K
IAotCQlHRU1fQlVHX09OKCFub2RlLT5hbGxvY2F0ZWQpOworCQlHRU1fQlVHX09OKCFkcm1fbW1f
bm9kZV9hbGxvY2F0ZWQobm9kZSkpOwogCQl2bWEgPSBjb250YWluZXJfb2Yobm9kZSwgdHlwZW9m
KCp2bWEpLCBub2RlKTsKIAogCQkvKiBJZiB3ZSBhcmUgdXNpbmcgY29sb3JpbmcgdG8gaW5zZXJ0
IGd1YXJkIHBhZ2VzIGJldHdlZW4KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfdm1hLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCmluZGV4IDlkNWIwZjg3
YzIxMC4uNjhjMzRiMWEyMGU0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3ZtYS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMKQEAgLTc5NSw3ICs3
OTUsNyBAQCB2b2lkIGk5MTVfdm1hX3Jlb3BlbihzdHJ1Y3QgaTkxNV92bWEgKnZtYSkKIAogc3Rh
dGljIHZvaWQgX19pOTE1X3ZtYV9kZXN0cm95KHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQogewotCUdF
TV9CVUdfT04odm1hLT5ub2RlLmFsbG9jYXRlZCk7CisJR0VNX0JVR19PTihkcm1fbW1fbm9kZV9h
bGxvY2F0ZWQoJnZtYS0+bm9kZSkpOwogCUdFTV9CVUdfT04odm1hLT5mZW5jZSk7CiAKIAltdXRl
eF9sb2NrKCZ2bWEtPnZtLT5tdXRleCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3ZtYS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuaAppbmRleCA4YmNi
NTgxMmM0NDYuLmU0OWIxOTlmN2RlNyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV92bWEuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5oCkBAIC0yMjgs
NyArMjI4LDcgQEAgc3RhdGljIGlubGluZSBib29sIGk5MTVfdm1hX2lzX2Nsb3NlZChjb25zdCBz
dHJ1Y3QgaTkxNV92bWEgKnZtYSkKIHN0YXRpYyBpbmxpbmUgdTMyIGk5MTVfZ2d0dF9vZmZzZXQo
Y29uc3Qgc3RydWN0IGk5MTVfdm1hICp2bWEpCiB7CiAJR0VNX0JVR19PTighaTkxNV92bWFfaXNf
Z2d0dCh2bWEpKTsKLQlHRU1fQlVHX09OKCF2bWEtPm5vZGUuYWxsb2NhdGVkKTsKKwlHRU1fQlVH
X09OKCFkcm1fbW1fbm9kZV9hbGxvY2F0ZWQoJnZtYS0+bm9kZSkpOwogCUdFTV9CVUdfT04odXBw
ZXJfMzJfYml0cyh2bWEtPm5vZGUuc3RhcnQpKTsKIAlHRU1fQlVHX09OKHVwcGVyXzMyX2JpdHMo
dm1hLT5ub2RlLnN0YXJ0ICsgdm1hLT5ub2RlLnNpemUgLSAxKSk7CiAJcmV0dXJuIGxvd2VyXzMy
X2JpdHModm1hLT5ub2RlLnN0YXJ0KTsKQEAgLTM5MCw3ICszOTAsNyBAQCBzdGF0aWMgaW5saW5l
IGJvb2wgaTkxNV92bWFfaXNfYm91bmQoY29uc3Qgc3RydWN0IGk5MTVfdm1hICp2bWEsCiBzdGF0
aWMgaW5saW5lIGJvb2wgaTkxNV9ub2RlX2NvbG9yX2RpZmZlcnMoY29uc3Qgc3RydWN0IGRybV9t
bV9ub2RlICpub2RlLAogCQkJCQkgICB1bnNpZ25lZCBsb25nIGNvbG9yKQogewotCXJldHVybiBu
b2RlLT5hbGxvY2F0ZWQgJiYgbm9kZS0+Y29sb3IgIT0gY29sb3I7CisJcmV0dXJuIGRybV9tbV9u
b2RlX2FsbG9jYXRlZChub2RlKSAmJiBub2RlLT5jb2xvciAhPSBjb2xvcjsKIH0KIAogLyoqCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vc2VsZnRlc3RzL3Rlc3QtZHJtX21tLmMgYi9kcml2
ZXJzL2dwdS9kcm0vc2VsZnRlc3RzL3Rlc3QtZHJtX21tLmMKaW5kZXggMzg4Zjk4NDRmNGJhLi45
YWFiZTgyZGNkM2EgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9zZWxmdGVzdHMvdGVzdC1k
cm1fbW0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vc2VsZnRlc3RzL3Rlc3QtZHJtX21tLmMKQEAg
LTg1NCw3ICs4NTQsNyBAQCBzdGF0aWMgYm9vbCBhc3NlcnRfY29udGlndW91c19pbl9yYW5nZShz
dHJ1Y3QgZHJtX21tICptbSwKIAogCWlmIChzdGFydCA+IDApIHsKIAkJbm9kZSA9IF9fZHJtX21t
X2ludGVydmFsX2ZpcnN0KG1tLCAwLCBzdGFydCAtIDEpOwotCQlpZiAobm9kZS0+YWxsb2NhdGVk
KSB7CisJCWlmIChkcm1fbW1fbm9kZV9hbGxvY2F0ZWQobm9kZSkpIHsKIAkJCXByX2Vycigibm9k
ZSBiZWZvcmUgc3RhcnQ6IG5vZGU9JWxseCslbGx1LCBzdGFydD0lbGx4XG4iLAogCQkJICAgICAg
IG5vZGUtPnN0YXJ0LCBub2RlLT5zaXplLCBzdGFydCk7CiAJCQlyZXR1cm4gZmFsc2U7CkBAIC04
NjMsNyArODYzLDcgQEAgc3RhdGljIGJvb2wgYXNzZXJ0X2NvbnRpZ3VvdXNfaW5fcmFuZ2Uoc3Ry
dWN0IGRybV9tbSAqbW0sCiAKIAlpZiAoZW5kIDwgVTY0X01BWCkgewogCQlub2RlID0gX19kcm1f
bW1faW50ZXJ2YWxfZmlyc3QobW0sIGVuZCwgVTY0X01BWCk7Ci0JCWlmIChub2RlLT5hbGxvY2F0
ZWQpIHsKKwkJaWYgKGRybV9tbV9ub2RlX2FsbG9jYXRlZChub2RlKSkgewogCQkJcHJfZXJyKCJu
b2RlIGFmdGVyIGVuZDogbm9kZT0lbGx4KyVsbHUsIGVuZD0lbGx4XG4iLAogCQkJICAgICAgIG5v
ZGUtPnN0YXJ0LCBub2RlLT5zaXplLCBlbmQpOwogCQkJcmV0dXJuIGZhbHNlOwpAQCAtMTE1Niwx
MiArMTE1NiwxMiBAQCBzdGF0aWMgdm9pZCBzaG93X2hvbGVzKGNvbnN0IHN0cnVjdCBkcm1fbW0g
Km1tLCBpbnQgY291bnQpCiAJCXN0cnVjdCBkcm1fbW1fbm9kZSAqbmV4dCA9IGxpc3RfbmV4dF9l
bnRyeShob2xlLCBub2RlX2xpc3QpOwogCQljb25zdCBjaGFyICpub2RlMSA9IE5VTEwsICpub2Rl
MiA9IE5VTEw7CiAKLQkJaWYgKGhvbGUtPmFsbG9jYXRlZCkKKwkJaWYgKGRybV9tbV9ub2RlX2Fs
bG9jYXRlZChob2xlKSkKIAkJCW5vZGUxID0ga2FzcHJpbnRmKEdGUF9LRVJORUwsCiAJCQkJCSAg
IlslbGx4ICsgJWxsZCwgY29sb3I9JWxkXSwgIiwKIAkJCQkJICBob2xlLT5zdGFydCwgaG9sZS0+
c2l6ZSwgaG9sZS0+Y29sb3IpOwogCi0JCWlmIChuZXh0LT5hbGxvY2F0ZWQpCisJCWlmIChkcm1f
bW1fbm9kZV9hbGxvY2F0ZWQobmV4dCkpCiAJCQlub2RlMiA9IGthc3ByaW50ZihHRlBfS0VSTkVM
LAogCQkJCQkgICIsIFslbGx4ICsgJWxsZCwgY29sb3I9JWxkXSIsCiAJCQkJCSAgbmV4dC0+c3Rh
cnQsIG5leHQtPnNpemUsIG5leHQtPmNvbG9yKTsKQEAgLTE5MDAsMTggKzE5MDAsMTggQEAgc3Rh
dGljIHZvaWQgc2VwYXJhdGVfYWRqYWNlbnRfY29sb3JzKGNvbnN0IHN0cnVjdCBkcm1fbW1fbm9k
ZSAqbm9kZSwKIAkJCQkgICAgIHU2NCAqc3RhcnQsCiAJCQkJICAgICB1NjQgKmVuZCkKIHsKLQlp
ZiAobm9kZS0+YWxsb2NhdGVkICYmIG5vZGUtPmNvbG9yICE9IGNvbG9yKQorCWlmIChkcm1fbW1f
bm9kZV9hbGxvY2F0ZWQobm9kZSkgJiYgbm9kZS0+Y29sb3IgIT0gY29sb3IpCiAJCSsrKnN0YXJ0
OwogCiAJbm9kZSA9IGxpc3RfbmV4dF9lbnRyeShub2RlLCBub2RlX2xpc3QpOwotCWlmIChub2Rl
LT5hbGxvY2F0ZWQgJiYgbm9kZS0+Y29sb3IgIT0gY29sb3IpCisJaWYgKGRybV9tbV9ub2RlX2Fs
bG9jYXRlZChub2RlKSAmJiBub2RlLT5jb2xvciAhPSBjb2xvcikKIAkJLS0qZW5kOwogfQogCiBz
dGF0aWMgYm9vbCBjb2xvcnNfYWJ1dHQoY29uc3Qgc3RydWN0IGRybV9tbV9ub2RlICpub2RlKQog
ewogCWlmICghZHJtX21tX2hvbGVfZm9sbG93cyhub2RlKSAmJgotCSAgICBsaXN0X25leHRfZW50
cnkobm9kZSwgbm9kZV9saXN0KS0+YWxsb2NhdGVkKSB7CisJICAgIGRybV9tbV9ub2RlX2FsbG9j
YXRlZChsaXN0X25leHRfZW50cnkobm9kZSwgbm9kZV9saXN0KSkpIHsKIAkJcHJfZXJyKCJjb2xv
cnMgYWJ1dHQ7ICVsZCBbJWxseCArICVsbHhdIGlzIG5leHQgdG8gJWxkIFslbGx4ICsgJWxseF0h
XG4iLAogCQkgICAgICAgbm9kZS0+Y29sb3IsIG5vZGUtPnN0YXJ0LCBub2RlLT5zaXplLAogCQkg
ICAgICAgbGlzdF9uZXh0X2VudHJ5KG5vZGUsIG5vZGVfbGlzdCktPmNvbG9yLApkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL3ZjNC92YzRfY3J0Yy5jIGIvZHJpdmVycy9ncHUvZHJtL3ZjNC92
YzRfY3J0Yy5jCmluZGV4IGYxZjBhN2M4Nzc3MS4uYjAwZTIwZjVjZTA1IDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vdmM0L3ZjNF9jcnRjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3ZjNC92
YzRfY3J0Yy5jCkBAIC05OTQsNyArOTk0LDcgQEAgc3RhdGljIHZvaWQgdmM0X2NydGNfZGVzdHJv
eV9zdGF0ZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCiAJc3RydWN0IHZjNF9kZXYgKnZjNCA9IHRv
X3ZjNF9kZXYoY3J0Yy0+ZGV2KTsKIAlzdHJ1Y3QgdmM0X2NydGNfc3RhdGUgKnZjNF9zdGF0ZSA9
IHRvX3ZjNF9jcnRjX3N0YXRlKHN0YXRlKTsKIAotCWlmICh2YzRfc3RhdGUtPm1tLmFsbG9jYXRl
ZCkgeworCWlmIChkcm1fbW1fbm9kZV9hbGxvY2F0ZWQoJnZjNF9zdGF0ZS0+bW0pKSB7CiAJCXVu
c2lnbmVkIGxvbmcgZmxhZ3M7CiAKIAkJc3Bpbl9sb2NrX2lycXNhdmUoJnZjNC0+aHZzLT5tbV9s
b2NrLCBmbGFncyk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdmM0L3ZjNF9odnMuYyBi
L2RyaXZlcnMvZ3B1L2RybS92YzQvdmM0X2h2cy5jCmluZGV4IDk5MzZiMTVkMGJmMS4uNWE0MzY1
OWRhMzE5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdmM0L3ZjNF9odnMuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vdmM0L3ZjNF9odnMuYwpAQCAtMzE1LDcgKzMxNSw3IEBAIHN0YXRpYyB2
b2lkIHZjNF9odnNfdW5iaW5kKHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRldmljZSAqbWFz
dGVyLAogCXN0cnVjdCBkcm1fZGV2aWNlICpkcm0gPSBkZXZfZ2V0X2RydmRhdGEobWFzdGVyKTsK
IAlzdHJ1Y3QgdmM0X2RldiAqdmM0ID0gZHJtLT5kZXZfcHJpdmF0ZTsKIAotCWlmICh2YzQtPmh2
cy0+bWl0Y2hlbGxfbmV0cmF2YWxpX2ZpbHRlci5hbGxvY2F0ZWQpCisJaWYgKGRybV9tbV9ub2Rl
X2FsbG9jYXRlZCgmdmM0LT5odnMtPm1pdGNoZWxsX25ldHJhdmFsaV9maWx0ZXIpKQogCQlkcm1f
bW1fcmVtb3ZlX25vZGUoJnZjNC0+aHZzLT5taXRjaGVsbF9uZXRyYXZhbGlfZmlsdGVyKTsKIAog
CWRybV9tbV90YWtlZG93bigmdmM0LT5odnMtPmRsaXN0X21tKTsKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS92YzQvdmM0X3BsYW5lLmMgYi9kcml2ZXJzL2dwdS9kcm0vdmM0L3ZjNF9wbGFu
ZS5jCmluZGV4IDVlNWY5MDgxMGFjYS4uNDkzNDEyN2YwZDc2IDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vdmM0L3ZjNF9wbGFuZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92YzQvdmM0X3Bs
YW5lLmMKQEAgLTE3OCw3ICsxNzgsNyBAQCBzdGF0aWMgdm9pZCB2YzRfcGxhbmVfZGVzdHJveV9z
dGF0ZShzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKIAlzdHJ1Y3QgdmM0X2RldiAqdmM0ID0gdG9f
dmM0X2RldihwbGFuZS0+ZGV2KTsKIAlzdHJ1Y3QgdmM0X3BsYW5lX3N0YXRlICp2YzRfc3RhdGUg
PSB0b192YzRfcGxhbmVfc3RhdGUoc3RhdGUpOwogCi0JaWYgKHZjNF9zdGF0ZS0+bGJtLmFsbG9j
YXRlZCkgeworCWlmIChkcm1fbW1fbm9kZV9hbGxvY2F0ZWQoJnZjNF9zdGF0ZS0+bGJtKSkgewog
CQl1bnNpZ25lZCBsb25nIGlycWZsYWdzOwogCiAJCXNwaW5fbG9ja19pcnFzYXZlKCZ2YzQtPmh2
cy0+bW1fbG9jaywgaXJxZmxhZ3MpOwpAQCAtNTU3LDcgKzU1Nyw3IEBAIHN0YXRpYyBpbnQgdmM0
X3BsYW5lX2FsbG9jYXRlX2xibShzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpzdGF0ZSkKIAkvKiBB
bGxvY2F0ZSB0aGUgTEJNIG1lbW9yeSB0aGF0IHRoZSBIVlMgd2lsbCB1c2UgZm9yIHRlbXBvcmFy
eQogCSAqIHN0b3JhZ2UgZHVlIHRvIG91ciBzY2FsaW5nL2Zvcm1hdCBjb252ZXJzaW9uLgogCSAq
LwotCWlmICghdmM0X3N0YXRlLT5sYm0uYWxsb2NhdGVkKSB7CisJaWYgKCFkcm1fbW1fbm9kZV9h
bGxvY2F0ZWQoJnZjNF9zdGF0ZS0+bGJtKSkgewogCQlpbnQgcmV0OwogCiAJCXNwaW5fbG9ja19p
cnFzYXZlKCZ2YzQtPmh2cy0+bW1fbG9jaywgaXJxZmxhZ3MpOwotLSAKMi4yMy4wCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGlu
ZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
