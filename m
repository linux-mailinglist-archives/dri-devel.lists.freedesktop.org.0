Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id D61E86CA0A
	for <lists+dri-devel@lfdr.de>; Thu, 18 Jul 2019 09:40:06 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 48F086E321;
	Thu, 18 Jul 2019 07:39:58 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ot1-x343.google.com (mail-ot1-x343.google.com
 [IPv6:2607:f8b0:4864:20::343])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B77F06E2E3
 for <dri-devel@lists.freedesktop.org>; Thu, 18 Jul 2019 02:08:29 +0000 (UTC)
Received: by mail-ot1-x343.google.com with SMTP id z23so27267056ote.13
 for <dri-devel@lists.freedesktop.org>; Wed, 17 Jul 2019 19:08:29 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references;
 bh=93JoAYPL9tewPVBFI3G9ENUOC7b9LkvOdiaDD0Nor2g=;
 b=TXwVEP/gNd7JWXJyjtMcKQtVl4VT3mqWXeQBNQq5bXauOoRf2frzX15zgP/al/1l0k
 P6LlGmxiy6HYTyKHYWp8yQeQG1HA4hiUlNoVmd4JjPvumrQaZGTFCezkLnNfMJjFBX6k
 FTcO9wnqCxy5LHOS5Zk4CPCxG4ZBItr7pv0b4+jiYE//jrcoX3hGOsbsNkQr+8ELEON0
 63OgVfRgHsVECZ92F6FVxJ8DEubpT7PkJ8mHJ6xmg561XRW8rEET76Iz0X8l6MabOPW7
 lOGAFTjJwJtp7KZiR+EFfp9w3X9MVKLZ0rip67BDRe78AwcMb4+R09BvBHtyDnNAHMbX
 u4aQ==
X-Gm-Message-State: APjAAAXItM4Ll+25DPkLWWouargJ+mfgNp7jNmuaY7NNmkgLS2HaLePx
 8EWL5ry9RZlQR5EYcuevLGU=
X-Google-Smtp-Source: APXvYqwk2tbL2nAXScS3lgy0GTHckvqA7/tE1gkNK+082l6h5slCUtiYdcZNf6ezvqm/3BGVwcdstQ==
X-Received: by 2002:a9d:7e88:: with SMTP id m8mr30622093otp.177.1563415709025; 
 Wed, 17 Jul 2019 19:08:29 -0700 (PDT)
Received: from linux.fredlawl.com ([2600:1700:18a0:11d0:18af:e893:6cb0:139a])
 by smtp.gmail.com with ESMTPSA id
 103sm9117378otu.33.2019.07.17.19.08.28
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Wed, 17 Jul 2019 19:08:28 -0700 (PDT)
From: Frederick Lawler <fred@fredlawl.com>
To: airlied@linux.ie,
	daniel@ffwll.ch
Subject: [PATCH] drm/radeon: Prefer pcie_capability_read_word()
Date: Wed, 17 Jul 2019 21:07:38 -0500
Message-Id: <20190718020745.8867-3-fred@fredlawl.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190718020745.8867-1-fred@fredlawl.com>
References: <20190718020745.8867-1-fred@fredlawl.com>
X-Mailman-Approved-At: Thu, 18 Jul 2019 07:39:55 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=fredlawl-com.20150623.gappssmtp.com; s=20150623;
 h=from:to:cc:subject:date:message-id:in-reply-to:references;
 bh=93JoAYPL9tewPVBFI3G9ENUOC7b9LkvOdiaDD0Nor2g=;
 b=HiH7W0DOdTHgW+WqgSEmRbok2FYhzH5larqzMlYGU2YWLauCwUjIx6Xceo+l7UixfL
 ClVV7URMmuE6BQp4wIzxhHNQYWjA2jfe3uLPxeBmVfpwL4pg+vMZb7k8qJ0X38qYbzPT
 KE/5qriIJvPlhIuEtaqJzBc1JbwbndFO69yUmwtSEy25QtIT467QnWYSpF8nKbdVUeE7
 MM/XSmlfkRghoDfqgUUEMPp+64sfqYQwB2pgXQLpD72hAdQXK0Cvi0E0fhNCM9M9sNn+
 bvWt/6eRAnUCg+kh3lHZuclo5Sl2QogSDkIPgrqjCXe3W7S2x5aKvIZ4Xn5AZjb91bNm
 D9Fg==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: bhelgaas@google.com, dri-devel@lists.freedesktop.org,
 amd-gfx@lists.freedesktop.org, Frederick Lawler <fred@fredlawl.com>,
 linux-kernel@vger.kernel.org
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

Q29tbWl0IDhjMGQzYTAyYzEzMCAoIlBDSTogQWRkIGFjY2Vzc29ycyBmb3IgUENJIEV4cHJlc3Mg
Q2FwYWJpbGl0eSIpCmFkZGVkIGFjY2Vzc29ycyBmb3IgdGhlIFBDSSBFeHByZXNzIENhcGFiaWxp
dHkgc28gdGhhdCBkcml2ZXJzIGRpZG4ndApuZWVkIHRvIGJlIGF3YXJlIG9mIGRpZmZlcmVuY2Vz
IGJldHdlZW4gdjEgYW5kIHYyIG9mIHRoZSBQQ0kKRXhwcmVzcyBDYXBhYmlsaXR5LgoKUmVwbGFj
ZSBwY2lfcmVhZF9jb25maWdfd29yZCgpIGFuZCBwY2lfd3JpdGVfY29uZmlnX3dvcmQoKSBjYWxs
cyB3aXRoCnBjaWVfY2FwYWJpbGl0eV9yZWFkX3dvcmQoKSBhbmQgcGNpZV9jYXBhYmlsaXR5X3dy
aXRlX3dvcmQoKS4KClNpZ25lZC1vZmYtYnk6IEZyZWRlcmljayBMYXdsZXIgPGZyZWRAZnJlZGxh
d2wuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9yYWRlb24vY2lrLmMgfCA3MCArKysrKysrKysr
KysrKysrKysrKystLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3NpLmMgIHwg
NzMgKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0tLS0tCiAyIGZpbGVzIGNoYW5nZWQs
IDkwIGluc2VydGlvbnMoKyksIDUzIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9yYWRlb24vY2lrLmMgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL2Npay5jCmluZGV4
IGFiN2I0ZTJmZmNkMi4uZjZjOTFhYzU0MjdhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
cmFkZW9uL2Npay5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vY2lrLmMKQEAgLTk1MDAs
NyArOTUwMCw2IEBAIHN0YXRpYyB2b2lkIGNpa19wY2llX2dlbjNfZW5hYmxlKHN0cnVjdCByYWRl
b25fZGV2aWNlICpyZGV2KQogewogCXN0cnVjdCBwY2lfZGV2ICpyb290ID0gcmRldi0+cGRldi0+
YnVzLT5zZWxmOwogCWVudW0gcGNpX2J1c19zcGVlZCBzcGVlZF9jYXA7Ci0JaW50IGJyaWRnZV9w
b3MsIGdwdV9wb3M7CiAJdTMyIHNwZWVkX2NudGwsIGN1cnJlbnRfZGF0YV9yYXRlOwogCWludCBp
OwogCXUxNiB0bXAxNjsKQEAgLTk1NDIsMTIgKzk1NDEsNyBAQCBzdGF0aWMgdm9pZCBjaWtfcGNp
ZV9nZW4zX2VuYWJsZShzdHJ1Y3QgcmFkZW9uX2RldmljZSAqcmRldikKIAkJRFJNX0lORk8oImVu
YWJsaW5nIFBDSUUgZ2VuIDIgbGluayBzcGVlZHMsIGRpc2FibGUgd2l0aCByYWRlb24ucGNpZV9n
ZW4yPTBcbiIpOwogCX0KIAotCWJyaWRnZV9wb3MgPSBwY2lfcGNpZV9jYXAocm9vdCk7Ci0JaWYg
KCFicmlkZ2VfcG9zKQotCQlyZXR1cm47Ci0KLQlncHVfcG9zID0gcGNpX3BjaWVfY2FwKHJkZXYt
PnBkZXYpOwotCWlmICghZ3B1X3BvcykKKwlpZiAoIXBjaV9pc19wY2llKHJvb3QpIHx8ICFwY2lf
aXNfcGNpZShyZGV2LT5wZGV2KSkKIAkJcmV0dXJuOwogCiAJaWYgKHNwZWVkX2NhcCA9PSBQQ0lF
X1NQRUVEXzhfMEdUKSB7CkBAIC05NTU3LDE0ICs5NTUxLDE3IEBAIHN0YXRpYyB2b2lkIGNpa19w
Y2llX2dlbjNfZW5hYmxlKHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2KQogCQkJdTE2IGJyaWRn
ZV9jZmcyLCBncHVfY2ZnMjsKIAkJCXUzMiBtYXhfbHcsIGN1cnJlbnRfbHcsIHRtcDsKIAotCQkJ
cGNpX3JlYWRfY29uZmlnX3dvcmQocm9vdCwgYnJpZGdlX3BvcyArIFBDSV9FWFBfTE5LQ1RMLCAm
YnJpZGdlX2NmZyk7Ci0JCQlwY2lfcmVhZF9jb25maWdfd29yZChyZGV2LT5wZGV2LCBncHVfcG9z
ICsgUENJX0VYUF9MTktDVEwsICZncHVfY2ZnKTsKKwkJCXBjaWVfY2FwYWJpbGl0eV9yZWFkX3dv
cmQocm9vdCwgUENJX0VYUF9MTktDVEwsCisJCQkJCQkgICZicmlkZ2VfY2ZnKTsKKwkJCXBjaWVf
Y2FwYWJpbGl0eV9yZWFkX3dvcmQocmRldi0+cGRldiwgUENJX0VYUF9MTktDVEwsCisJCQkJCQkg
ICZncHVfY2ZnKTsKIAogCQkJdG1wMTYgPSBicmlkZ2VfY2ZnIHwgUENJX0VYUF9MTktDVExfSEFX
RDsKLQkJCXBjaV93cml0ZV9jb25maWdfd29yZChyb290LCBicmlkZ2VfcG9zICsgUENJX0VYUF9M
TktDVEwsIHRtcDE2KTsKKwkJCXBjaWVfY2FwYWJpbGl0eV93cml0ZV93b3JkKHJvb3QsIFBDSV9F
WFBfTE5LQ1RMLCB0bXAxNik7CiAKIAkJCXRtcDE2ID0gZ3B1X2NmZyB8IFBDSV9FWFBfTE5LQ1RM
X0hBV0Q7Ci0JCQlwY2lfd3JpdGVfY29uZmlnX3dvcmQocmRldi0+cGRldiwgZ3B1X3BvcyArIFBD
SV9FWFBfTE5LQ1RMLCB0bXAxNik7CisJCQlwY2llX2NhcGFiaWxpdHlfd3JpdGVfd29yZChyZGV2
LT5wZGV2LCBQQ0lfRVhQX0xOS0NUTCwKKwkJCQkJCSAgIHRtcDE2KTsKIAogCQkJdG1wID0gUlJF
RzMyX1BDSUVfUE9SVChQQ0lFX0xDX1NUQVRVUzEpOwogCQkJbWF4X2x3ID0gKHRtcCAmIExDX0RF
VEVDVEVEX0xJTktfV0lEVEhfTUFTSykgPj4gTENfREVURUNURURfTElOS19XSURUSF9TSElGVDsK
QEAgLTk1ODIsMTUgKzk1NzksMjMgQEAgc3RhdGljIHZvaWQgY2lrX3BjaWVfZ2VuM19lbmFibGUo
c3RydWN0IHJhZGVvbl9kZXZpY2UgKnJkZXYpCiAKIAkJCWZvciAoaSA9IDA7IGkgPCAxMDsgaSsr
KSB7CiAJCQkJLyogY2hlY2sgc3RhdHVzICovCi0JCQkJcGNpX3JlYWRfY29uZmlnX3dvcmQocmRl
di0+cGRldiwgZ3B1X3BvcyArIFBDSV9FWFBfREVWU1RBLCAmdG1wMTYpOworCQkJCXBjaWVfY2Fw
YWJpbGl0eV9yZWFkX3dvcmQocmRldi0+cGRldiwKKwkJCQkJCQkgIFBDSV9FWFBfREVWU1RBLAor
CQkJCQkJCSAgJnRtcDE2KTsKIAkJCQlpZiAodG1wMTYgJiBQQ0lfRVhQX0RFVlNUQV9UUlBORCkK
IAkJCQkJYnJlYWs7CiAKLQkJCQlwY2lfcmVhZF9jb25maWdfd29yZChyb290LCBicmlkZ2VfcG9z
ICsgUENJX0VYUF9MTktDVEwsICZicmlkZ2VfY2ZnKTsKLQkJCQlwY2lfcmVhZF9jb25maWdfd29y
ZChyZGV2LT5wZGV2LCBncHVfcG9zICsgUENJX0VYUF9MTktDVEwsICZncHVfY2ZnKTsKKwkJCQlw
Y2llX2NhcGFiaWxpdHlfcmVhZF93b3JkKHJvb3QsIFBDSV9FWFBfTE5LQ1RMLAorCQkJCQkJCSAg
JmJyaWRnZV9jZmcpOworCQkJCXBjaWVfY2FwYWJpbGl0eV9yZWFkX3dvcmQocmRldi0+cGRldiwK
KwkJCQkJCQkgIFBDSV9FWFBfTE5LQ1RMLAorCQkJCQkJCSAgJmdwdV9jZmcpOwogCi0JCQkJcGNp
X3JlYWRfY29uZmlnX3dvcmQocm9vdCwgYnJpZGdlX3BvcyArIFBDSV9FWFBfTE5LQ1RMMiwgJmJy
aWRnZV9jZmcyKTsKLQkJCQlwY2lfcmVhZF9jb25maWdfd29yZChyZGV2LT5wZGV2LCBncHVfcG9z
ICsgUENJX0VYUF9MTktDVEwyLCAmZ3B1X2NmZzIpOworCQkJCXBjaWVfY2FwYWJpbGl0eV9yZWFk
X3dvcmQocm9vdCwgUENJX0VYUF9MTktDVEwyLAorCQkJCQkJCSAgJmJyaWRnZV9jZmcyKTsKKwkJ
CQlwY2llX2NhcGFiaWxpdHlfcmVhZF93b3JkKHJkZXYtPnBkZXYsCisJCQkJCQkJICBQQ0lfRVhQ
X0xOS0NUTDIsCisJCQkJCQkJICAmZ3B1X2NmZzIpOwogCiAJCQkJdG1wID0gUlJFRzMyX1BDSUVf
UE9SVChQQ0lFX0xDX0NOVEw0KTsKIAkJCQl0bXAgfD0gTENfU0VUX1FVSUVTQ0U7CkBAIC05NjAz
LDI2ICs5NjA4LDM5IEBAIHN0YXRpYyB2b2lkIGNpa19wY2llX2dlbjNfZW5hYmxlKHN0cnVjdCBy
YWRlb25fZGV2aWNlICpyZGV2KQogCQkJCW1zbGVlcCgxMDApOwogCiAJCQkJLyogbGlua2N0bCAq
LwotCQkJCXBjaV9yZWFkX2NvbmZpZ193b3JkKHJvb3QsIGJyaWRnZV9wb3MgKyBQQ0lfRVhQX0xO
S0NUTCwgJnRtcDE2KTsKKwkJCQlwY2llX2NhcGFiaWxpdHlfcmVhZF93b3JkKHJvb3QsIFBDSV9F
WFBfTE5LQ1RMLAorCQkJCQkJCSAgJnRtcDE2KTsKIAkJCQl0bXAxNiAmPSB+UENJX0VYUF9MTktD
VExfSEFXRDsKIAkJCQl0bXAxNiB8PSAoYnJpZGdlX2NmZyAmIFBDSV9FWFBfTE5LQ1RMX0hBV0Qp
OwotCQkJCXBjaV93cml0ZV9jb25maWdfd29yZChyb290LCBicmlkZ2VfcG9zICsgUENJX0VYUF9M
TktDVEwsIHRtcDE2KTsKKwkJCQlwY2llX2NhcGFiaWxpdHlfd3JpdGVfd29yZChyb290LCBQQ0lf
RVhQX0xOS0NUTCwKKwkJCQkJCQkgICB0bXAxNik7CiAKLQkJCQlwY2lfcmVhZF9jb25maWdfd29y
ZChyZGV2LT5wZGV2LCBncHVfcG9zICsgUENJX0VYUF9MTktDVEwsICZ0bXAxNik7CisJCQkJcGNp
ZV9jYXBhYmlsaXR5X3JlYWRfd29yZChyZGV2LT5wZGV2LAorCQkJCQkJCSAgUENJX0VYUF9MTktD
VEwsCisJCQkJCQkJICAmdG1wMTYpOwogCQkJCXRtcDE2ICY9IH5QQ0lfRVhQX0xOS0NUTF9IQVdE
OwogCQkJCXRtcDE2IHw9IChncHVfY2ZnICYgUENJX0VYUF9MTktDVExfSEFXRCk7Ci0JCQkJcGNp
X3dyaXRlX2NvbmZpZ193b3JkKHJkZXYtPnBkZXYsIGdwdV9wb3MgKyBQQ0lfRVhQX0xOS0NUTCwg
dG1wMTYpOworCQkJCXBjaWVfY2FwYWJpbGl0eV93cml0ZV93b3JkKHJkZXYtPnBkZXYsCisJCQkJ
CQkJICAgUENJX0VYUF9MTktDVEwsCisJCQkJCQkJICAgdG1wMTYpOwogCiAJCQkJLyogbGlua2N0
bDIgKi8KLQkJCQlwY2lfcmVhZF9jb25maWdfd29yZChyb290LCBicmlkZ2VfcG9zICsgUENJX0VY
UF9MTktDVEwyLCAmdG1wMTYpOworCQkJCXBjaWVfY2FwYWJpbGl0eV9yZWFkX3dvcmQocm9vdCwg
UENJX0VYUF9MTktDVEwyLAorCQkJCQkJCSAgJnRtcDE2KTsKIAkJCQl0bXAxNiAmPSB+KCgxIDw8
IDQpIHwgKDcgPDwgOSkpOwogCQkJCXRtcDE2IHw9IChicmlkZ2VfY2ZnMiAmICgoMSA8PCA0KSB8
ICg3IDw8IDkpKSk7Ci0JCQkJcGNpX3dyaXRlX2NvbmZpZ193b3JkKHJvb3QsIGJyaWRnZV9wb3Mg
KyBQQ0lfRVhQX0xOS0NUTDIsIHRtcDE2KTsKKwkJCQlwY2llX2NhcGFiaWxpdHlfd3JpdGVfd29y
ZChyb290LAorCQkJCQkJCSAgIFBDSV9FWFBfTE5LQ1RMMiwKKwkJCQkJCQkgICB0bXAxNik7CiAK
LQkJCQlwY2lfcmVhZF9jb25maWdfd29yZChyZGV2LT5wZGV2LCBncHVfcG9zICsgUENJX0VYUF9M
TktDVEwyLCAmdG1wMTYpOworCQkJCXBjaWVfY2FwYWJpbGl0eV9yZWFkX3dvcmQocmRldi0+cGRl
diwKKwkJCQkJCQkgIFBDSV9FWFBfTE5LQ1RMMiwKKwkJCQkJCQkgICZ0bXAxNik7CiAJCQkJdG1w
MTYgJj0gfigoMSA8PCA0KSB8ICg3IDw8IDkpKTsKIAkJCQl0bXAxNiB8PSAoZ3B1X2NmZzIgJiAo
KDEgPDwgNCkgfCAoNyA8PCA5KSkpOwotCQkJCXBjaV93cml0ZV9jb25maWdfd29yZChyZGV2LT5w
ZGV2LCBncHVfcG9zICsgUENJX0VYUF9MTktDVEwyLCB0bXAxNik7CisJCQkJcGNpZV9jYXBhYmls
aXR5X3dyaXRlX3dvcmQocmRldi0+cGRldiwKKwkJCQkJCQkgICBQQ0lfRVhQX0xOS0NUTDIsCisJ
CQkJCQkJICAgdG1wMTYpOwogCiAJCQkJdG1wID0gUlJFRzMyX1BDSUVfUE9SVChQQ0lFX0xDX0NO
VEw0KTsKIAkJCQl0bXAgJj0gfkxDX1NFVF9RVUlFU0NFOwpAQCAtOTYzNiw3ICs5NjU0LDcgQEAg
c3RhdGljIHZvaWQgY2lrX3BjaWVfZ2VuM19lbmFibGUoc3RydWN0IHJhZGVvbl9kZXZpY2UgKnJk
ZXYpCiAJc3BlZWRfY250bCAmPSB+TENfRk9SQ0VfRElTX1NXX1NQRUVEX0NIQU5HRTsKIAlXUkVH
MzJfUENJRV9QT1JUKFBDSUVfTENfU1BFRURfQ05UTCwgc3BlZWRfY250bCk7CiAKLQlwY2lfcmVh
ZF9jb25maWdfd29yZChyZGV2LT5wZGV2LCBncHVfcG9zICsgUENJX0VYUF9MTktDVEwyLCAmdG1w
MTYpOworCXBjaWVfY2FwYWJpbGl0eV9yZWFkX3dvcmQocmRldi0+cGRldiwgUENJX0VYUF9MTktD
VEwyLCAmdG1wMTYpOwogCXRtcDE2ICY9IH4weGY7CiAJaWYgKHNwZWVkX2NhcCA9PSBQQ0lFX1NQ
RUVEXzhfMEdUKQogCQl0bXAxNiB8PSAzOyAvKiBnZW4zICovCkBAIC05NjQ0LDcgKzk2NjIsNyBA
QCBzdGF0aWMgdm9pZCBjaWtfcGNpZV9nZW4zX2VuYWJsZShzdHJ1Y3QgcmFkZW9uX2RldmljZSAq
cmRldikKIAkJdG1wMTYgfD0gMjsgLyogZ2VuMiAqLwogCWVsc2UKIAkJdG1wMTYgfD0gMTsgLyog
Z2VuMSAqLwotCXBjaV93cml0ZV9jb25maWdfd29yZChyZGV2LT5wZGV2LCBncHVfcG9zICsgUENJ
X0VYUF9MTktDVEwyLCB0bXAxNik7CisJcGNpZV9jYXBhYmlsaXR5X3dyaXRlX3dvcmQocmRldi0+
cGRldiwgUENJX0VYUF9MTktDVEwyLCB0bXAxNik7CiAKIAlzcGVlZF9jbnRsID0gUlJFRzMyX1BD
SUVfUE9SVChQQ0lFX0xDX1NQRUVEX0NOVEwpOwogCXNwZWVkX2NudGwgfD0gTENfSU5JVElBVEVf
TElOS19TUEVFRF9DSEFOR0U7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3Np
LmMgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3NpLmMKaW5kZXggODQxYmM4YmMzMzNkLi42OTE2
NzAzZDc4OTkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vc2kuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vcmFkZW9uL3NpLmMKQEAgLTMyNTMsNyArMzI1Myw3IEBAIHN0YXRpYyB2
b2lkIHNpX2dwdV9pbml0KHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2KQogCQkvKiBYWFggd2hh
dCBhYm91dCAxMj8gKi8KIAkJcmRldi0+Y29uZmlnLnNpLnRpbGVfY29uZmlnIHw9ICgzIDw8IDAp
OwogCQlicmVhazsKLQl9CQorCX0KIAlzd2l0Y2ggKChtY19hcmJfcmFtY2ZnICYgTk9PRkJBTktf
TUFTSykgPj4gTk9PRkJBTktfU0hJRlQpIHsKIAljYXNlIDA6IC8qIGZvdXIgYmFua3MgKi8KIAkJ
cmRldi0+Y29uZmlnLnNpLnRpbGVfY29uZmlnIHw9IDAgPDwgNDsKQEAgLTcwODMsNyArNzA4Myw2
IEBAIHN0YXRpYyB2b2lkIHNpX3BjaWVfZ2VuM19lbmFibGUoc3RydWN0IHJhZGVvbl9kZXZpY2Ug
KnJkZXYpCiB7CiAJc3RydWN0IHBjaV9kZXYgKnJvb3QgPSByZGV2LT5wZGV2LT5idXMtPnNlbGY7
CiAJZW51bSBwY2lfYnVzX3NwZWVkIHNwZWVkX2NhcDsKLQlpbnQgYnJpZGdlX3BvcywgZ3B1X3Bv
czsKIAl1MzIgc3BlZWRfY250bCwgY3VycmVudF9kYXRhX3JhdGU7CiAJaW50IGk7CiAJdTE2IHRt
cDE2OwpAQCAtNzEyNSwxMiArNzEyNCw3IEBAIHN0YXRpYyB2b2lkIHNpX3BjaWVfZ2VuM19lbmFi
bGUoc3RydWN0IHJhZGVvbl9kZXZpY2UgKnJkZXYpCiAJCURSTV9JTkZPKCJlbmFibGluZyBQQ0lF
IGdlbiAyIGxpbmsgc3BlZWRzLCBkaXNhYmxlIHdpdGggcmFkZW9uLnBjaWVfZ2VuMj0wXG4iKTsK
IAl9CiAKLQlicmlkZ2VfcG9zID0gcGNpX3BjaWVfY2FwKHJvb3QpOwotCWlmICghYnJpZGdlX3Bv
cykKLQkJcmV0dXJuOwotCi0JZ3B1X3BvcyA9IHBjaV9wY2llX2NhcChyZGV2LT5wZGV2KTsKLQlp
ZiAoIWdwdV9wb3MpCisJaWYgKCFwY2lfaXNfcGNpZShyb290KSB8fCAhcGNpX2lzX3BjaWUocmRl
di0+cGRldikpCiAJCXJldHVybjsKIAogCWlmIChzcGVlZF9jYXAgPT0gUENJRV9TUEVFRF84XzBH
VCkgewpAQCAtNzE0MCwxNCArNzEzNCwxNyBAQCBzdGF0aWMgdm9pZCBzaV9wY2llX2dlbjNfZW5h
YmxlKHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2KQogCQkJdTE2IGJyaWRnZV9jZmcyLCBncHVf
Y2ZnMjsKIAkJCXUzMiBtYXhfbHcsIGN1cnJlbnRfbHcsIHRtcDsKIAotCQkJcGNpX3JlYWRfY29u
ZmlnX3dvcmQocm9vdCwgYnJpZGdlX3BvcyArIFBDSV9FWFBfTE5LQ1RMLCAmYnJpZGdlX2NmZyk7
Ci0JCQlwY2lfcmVhZF9jb25maWdfd29yZChyZGV2LT5wZGV2LCBncHVfcG9zICsgUENJX0VYUF9M
TktDVEwsICZncHVfY2ZnKTsKKwkJCXBjaWVfY2FwYWJpbGl0eV9yZWFkX3dvcmQocm9vdCwgUENJ
X0VYUF9MTktDVEwsCisJCQkJCQkgICZicmlkZ2VfY2ZnKTsKKwkJCXBjaWVfY2FwYWJpbGl0eV9y
ZWFkX3dvcmQocmRldi0+cGRldiwgUENJX0VYUF9MTktDVEwsCisJCQkJCQkgICZncHVfY2ZnKTsK
IAogCQkJdG1wMTYgPSBicmlkZ2VfY2ZnIHwgUENJX0VYUF9MTktDVExfSEFXRDsKLQkJCXBjaV93
cml0ZV9jb25maWdfd29yZChyb290LCBicmlkZ2VfcG9zICsgUENJX0VYUF9MTktDVEwsIHRtcDE2
KTsKKwkJCXBjaWVfY2FwYWJpbGl0eV93cml0ZV93b3JkKHJvb3QsIFBDSV9FWFBfTE5LQ1RMLCB0
bXAxNik7CiAKIAkJCXRtcDE2ID0gZ3B1X2NmZyB8IFBDSV9FWFBfTE5LQ1RMX0hBV0Q7Ci0JCQlw
Y2lfd3JpdGVfY29uZmlnX3dvcmQocmRldi0+cGRldiwgZ3B1X3BvcyArIFBDSV9FWFBfTE5LQ1RM
LCB0bXAxNik7CisJCQlwY2llX2NhcGFiaWxpdHlfd3JpdGVfd29yZChyZGV2LT5wZGV2LCBQQ0lf
RVhQX0xOS0NUTCwKKwkJCQkJCSAgIHRtcDE2KTsKIAogCQkJdG1wID0gUlJFRzMyX1BDSUUoUENJ
RV9MQ19TVEFUVVMxKTsKIAkJCW1heF9sdyA9ICh0bXAgJiBMQ19ERVRFQ1RFRF9MSU5LX1dJRFRI
X01BU0spID4+IExDX0RFVEVDVEVEX0xJTktfV0lEVEhfU0hJRlQ7CkBAIC03MTY1LDE1ICs3MTYy
LDIzIEBAIHN0YXRpYyB2b2lkIHNpX3BjaWVfZ2VuM19lbmFibGUoc3RydWN0IHJhZGVvbl9kZXZp
Y2UgKnJkZXYpCiAKIAkJCWZvciAoaSA9IDA7IGkgPCAxMDsgaSsrKSB7CiAJCQkJLyogY2hlY2sg
c3RhdHVzICovCi0JCQkJcGNpX3JlYWRfY29uZmlnX3dvcmQocmRldi0+cGRldiwgZ3B1X3BvcyAr
IFBDSV9FWFBfREVWU1RBLCAmdG1wMTYpOworCQkJCXBjaWVfY2FwYWJpbGl0eV9yZWFkX3dvcmQo
cmRldi0+cGRldiwKKwkJCQkJCQkgIFBDSV9FWFBfREVWU1RBLAorCQkJCQkJCSAgJnRtcDE2KTsK
IAkJCQlpZiAodG1wMTYgJiBQQ0lfRVhQX0RFVlNUQV9UUlBORCkKIAkJCQkJYnJlYWs7CiAKLQkJ
CQlwY2lfcmVhZF9jb25maWdfd29yZChyb290LCBicmlkZ2VfcG9zICsgUENJX0VYUF9MTktDVEws
ICZicmlkZ2VfY2ZnKTsKLQkJCQlwY2lfcmVhZF9jb25maWdfd29yZChyZGV2LT5wZGV2LCBncHVf
cG9zICsgUENJX0VYUF9MTktDVEwsICZncHVfY2ZnKTsKKwkJCQlwY2llX2NhcGFiaWxpdHlfcmVh
ZF93b3JkKHJvb3QsIFBDSV9FWFBfTE5LQ1RMLAorCQkJCQkJCSAgJmJyaWRnZV9jZmcpOworCQkJ
CXBjaWVfY2FwYWJpbGl0eV9yZWFkX3dvcmQocmRldi0+cGRldiwKKwkJCQkJCQkgIFBDSV9FWFBf
TE5LQ1RMLAorCQkJCQkJCSAgJmdwdV9jZmcpOwogCi0JCQkJcGNpX3JlYWRfY29uZmlnX3dvcmQo
cm9vdCwgYnJpZGdlX3BvcyArIFBDSV9FWFBfTE5LQ1RMMiwgJmJyaWRnZV9jZmcyKTsKLQkJCQlw
Y2lfcmVhZF9jb25maWdfd29yZChyZGV2LT5wZGV2LCBncHVfcG9zICsgUENJX0VYUF9MTktDVEwy
LCAmZ3B1X2NmZzIpOworCQkJCXBjaWVfY2FwYWJpbGl0eV9yZWFkX3dvcmQocm9vdCwgUENJX0VY
UF9MTktDVEwyLAorCQkJCQkJCSAgJmJyaWRnZV9jZmcyKTsKKwkJCQlwY2llX2NhcGFiaWxpdHlf
cmVhZF93b3JkKHJkZXYtPnBkZXYsCisJCQkJCQkJICBQQ0lfRVhQX0xOS0NUTDIsCisJCQkJCQkJ
ICAmZ3B1X2NmZzIpOwogCiAJCQkJdG1wID0gUlJFRzMyX1BDSUVfUE9SVChQQ0lFX0xDX0NOVEw0
KTsKIAkJCQl0bXAgfD0gTENfU0VUX1FVSUVTQ0U7CkBAIC03MTg2LDI2ICs3MTkxLDQwIEBAIHN0
YXRpYyB2b2lkIHNpX3BjaWVfZ2VuM19lbmFibGUoc3RydWN0IHJhZGVvbl9kZXZpY2UgKnJkZXYp
CiAJCQkJbXNsZWVwKDEwMCk7CiAKIAkJCQkvKiBsaW5rY3RsICovCi0JCQkJcGNpX3JlYWRfY29u
ZmlnX3dvcmQocm9vdCwgYnJpZGdlX3BvcyArIFBDSV9FWFBfTE5LQ1RMLCAmdG1wMTYpOworCQkJ
CXBjaWVfY2FwYWJpbGl0eV9yZWFkX3dvcmQocm9vdCwgUENJX0VYUF9MTktDVEwsCisJCQkJCQkJ
ICAmdG1wMTYpOwogCQkJCXRtcDE2ICY9IH5QQ0lfRVhQX0xOS0NUTF9IQVdEOwogCQkJCXRtcDE2
IHw9IChicmlkZ2VfY2ZnICYgUENJX0VYUF9MTktDVExfSEFXRCk7Ci0JCQkJcGNpX3dyaXRlX2Nv
bmZpZ193b3JkKHJvb3QsIGJyaWRnZV9wb3MgKyBQQ0lfRVhQX0xOS0NUTCwgdG1wMTYpOworCQkJ
CXBjaWVfY2FwYWJpbGl0eV93cml0ZV93b3JkKHJvb3QsCisJCQkJCQkJICAgUENJX0VYUF9MTktD
VEwsCisJCQkJCQkJICAgdG1wMTYpOwogCi0JCQkJcGNpX3JlYWRfY29uZmlnX3dvcmQocmRldi0+
cGRldiwgZ3B1X3BvcyArIFBDSV9FWFBfTE5LQ1RMLCAmdG1wMTYpOworCQkJCXBjaWVfY2FwYWJp
bGl0eV9yZWFkX3dvcmQocmRldi0+cGRldiwKKwkJCQkJCQkgIFBDSV9FWFBfTE5LQ1RMLAorCQkJ
CQkJCSAgJnRtcDE2KTsKIAkJCQl0bXAxNiAmPSB+UENJX0VYUF9MTktDVExfSEFXRDsKIAkJCQl0
bXAxNiB8PSAoZ3B1X2NmZyAmIFBDSV9FWFBfTE5LQ1RMX0hBV0QpOwotCQkJCXBjaV93cml0ZV9j
b25maWdfd29yZChyZGV2LT5wZGV2LCBncHVfcG9zICsgUENJX0VYUF9MTktDVEwsIHRtcDE2KTsK
KwkJCQlwY2llX2NhcGFiaWxpdHlfd3JpdGVfd29yZChyZGV2LT5wZGV2LAorCQkJCQkJCSAgIFBD
SV9FWFBfTE5LQ1RMLAorCQkJCQkJCSAgIHRtcDE2KTsKIAogCQkJCS8qIGxpbmtjdGwyICovCi0J
CQkJcGNpX3JlYWRfY29uZmlnX3dvcmQocm9vdCwgYnJpZGdlX3BvcyArIFBDSV9FWFBfTE5LQ1RM
MiwgJnRtcDE2KTsKKwkJCQlwY2llX2NhcGFiaWxpdHlfcmVhZF93b3JkKHJvb3QsIFBDSV9FWFBf
TE5LQ1RMMiwKKwkJCQkJCQkgICZ0bXAxNik7CiAJCQkJdG1wMTYgJj0gfigoMSA8PCA0KSB8ICg3
IDw8IDkpKTsKIAkJCQl0bXAxNiB8PSAoYnJpZGdlX2NmZzIgJiAoKDEgPDwgNCkgfCAoNyA8PCA5
KSkpOwotCQkJCXBjaV93cml0ZV9jb25maWdfd29yZChyb290LCBicmlkZ2VfcG9zICsgUENJX0VY
UF9MTktDVEwyLCB0bXAxNik7CisJCQkJcGNpZV9jYXBhYmlsaXR5X3dyaXRlX3dvcmQocm9vdCwK
KwkJCQkJCQkgICBQQ0lfRVhQX0xOS0NUTDIsCisJCQkJCQkJICAgdG1wMTYpOwogCi0JCQkJcGNp
X3JlYWRfY29uZmlnX3dvcmQocmRldi0+cGRldiwgZ3B1X3BvcyArIFBDSV9FWFBfTE5LQ1RMMiwg
JnRtcDE2KTsKKwkJCQlwY2llX2NhcGFiaWxpdHlfcmVhZF93b3JkKHJkZXYtPnBkZXYsCisJCQkJ
CQkJICBQQ0lfRVhQX0xOS0NUTDIsCisJCQkJCQkJICAmdG1wMTYpOwogCQkJCXRtcDE2ICY9IH4o
KDEgPDwgNCkgfCAoNyA8PCA5KSk7CiAJCQkJdG1wMTYgfD0gKGdwdV9jZmcyICYgKCgxIDw8IDQp
IHwgKDcgPDwgOSkpKTsKLQkJCQlwY2lfd3JpdGVfY29uZmlnX3dvcmQocmRldi0+cGRldiwgZ3B1
X3BvcyArIFBDSV9FWFBfTE5LQ1RMMiwgdG1wMTYpOworCQkJCXBjaWVfY2FwYWJpbGl0eV93cml0
ZV93b3JkKHJkZXYtPnBkZXYsCisJCQkJCQkJICAgUENJX0VYUF9MTktDVEwyLAorCQkJCQkJCSAg
IHRtcDE2KTsKIAogCQkJCXRtcCA9IFJSRUczMl9QQ0lFX1BPUlQoUENJRV9MQ19DTlRMNCk7CiAJ
CQkJdG1wICY9IH5MQ19TRVRfUVVJRVNDRTsKQEAgLTcyMTksNyArNzIzOCw3IEBAIHN0YXRpYyB2
b2lkIHNpX3BjaWVfZ2VuM19lbmFibGUoc3RydWN0IHJhZGVvbl9kZXZpY2UgKnJkZXYpCiAJc3Bl
ZWRfY250bCAmPSB+TENfRk9SQ0VfRElTX1NXX1NQRUVEX0NIQU5HRTsKIAlXUkVHMzJfUENJRV9Q
T1JUKFBDSUVfTENfU1BFRURfQ05UTCwgc3BlZWRfY250bCk7CiAKLQlwY2lfcmVhZF9jb25maWdf
d29yZChyZGV2LT5wZGV2LCBncHVfcG9zICsgUENJX0VYUF9MTktDVEwyLCAmdG1wMTYpOworCXBj
aWVfY2FwYWJpbGl0eV9yZWFkX3dvcmQocmRldi0+cGRldiwgUENJX0VYUF9MTktDVEwyLCAmdG1w
MTYpOwogCXRtcDE2ICY9IH4weGY7CiAJaWYgKHNwZWVkX2NhcCA9PSBQQ0lFX1NQRUVEXzhfMEdU
KQogCQl0bXAxNiB8PSAzOyAvKiBnZW4zICovCkBAIC03MjI3LDcgKzcyNDYsNyBAQCBzdGF0aWMg
dm9pZCBzaV9wY2llX2dlbjNfZW5hYmxlKHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2KQogCQl0
bXAxNiB8PSAyOyAvKiBnZW4yICovCiAJZWxzZQogCQl0bXAxNiB8PSAxOyAvKiBnZW4xICovCi0J
cGNpX3dyaXRlX2NvbmZpZ193b3JkKHJkZXYtPnBkZXYsIGdwdV9wb3MgKyBQQ0lfRVhQX0xOS0NU
TDIsIHRtcDE2KTsKKwlwY2llX2NhcGFiaWxpdHlfd3JpdGVfd29yZChyZGV2LT5wZGV2LCBQQ0lf
RVhQX0xOS0NUTDIsIHRtcDE2KTsKIAogCXNwZWVkX2NudGwgPSBSUkVHMzJfUENJRV9QT1JUKFBD
SUVfTENfU1BFRURfQ05UTCk7CiAJc3BlZWRfY250bCB8PSBMQ19JTklUSUFURV9MSU5LX1NQRUVE
X0NIQU5HRTsKLS0gCjIuMTcuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRl
c2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8v
ZHJpLWRldmVs
