Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id B6B8BB65ED
	for <lists+dri-devel@lfdr.de>; Wed, 18 Sep 2019 16:23:26 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EF11A6F3C4;
	Wed, 18 Sep 2019 14:23:15 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4D64F6F3BB
 for <dri-devel@lists.freedesktop.org>; Wed, 18 Sep 2019 14:23:14 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 05273B675;
 Wed, 18 Sep 2019 14:23:11 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: airlied@linux.ie, daniel@ffwll.ch, kraxel@redhat.com, sam@ravnborg.org,
 yc_chen@aspeedtech.com, corbet@lwn.net
Subject: [PATCH 03/11] drm/ast: Move cursor update code to ast_show_cursor()
Date: Wed, 18 Sep 2019 16:22:59 +0200
Message-Id: <20190918142307.27127-4-tzimmermann@suse.de>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190918142307.27127-1-tzimmermann@suse.de>
References: <20190918142307.27127-1-tzimmermann@suse.de>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Zimmermann <tzimmermann@suse.de>, dri-devel@lists.freedesktop.org,
 linux-doc@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QSBjYWxsIHRvIGFzdCdzIHNob3ctY3Vyc29yIGZ1bmN0aW9uIG5vdyByZWNlaXZlcyB0aGUgY3Vy
c29yIGltYWdlCmFuZCB1cGRhdGVzIHRoZSBidWZmZXIuIFRoZSBjaGFuZ2Ugc3BsaXRzIG9mZiBp
bWFnZSB1cGRhdGUgYW5kCmJhc2UtYWRkcmVzcyB1cGRhdGUgaW50byBzZXBhcmF0ZSBmdW5jdGlv
bnMuIFRoZSB3aWxsIGhlbHAgd2l0aAp0aGUgdXBjb21pbmcgY2hhbmdlIHRvIFZSQU0gYnVmZmVy
cy4KClNpZ25lZC1vZmYtYnk6IFRob21hcyBaaW1tZXJtYW5uIDx0emltbWVybWFubkBzdXNlLmRl
PgotLS0KIGRyaXZlcnMvZ3B1L2RybS9hc3QvYXN0X21vZGUuYyB8IDEyMCArKysrKysrKysrKysr
KysrKysrLS0tLS0tLS0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA2OSBpbnNlcnRpb25zKCspLCA1
MSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYXN0L2FzdF9tb2Rl
LmMgYi9kcml2ZXJzL2dwdS9kcm0vYXN0L2FzdF9tb2RlLmMKaW5kZXggYTRjYmYyZDVlZTBhLi4x
Mjk0ZjA2MTJmZDUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hc3QvYXN0X21vZGUuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vYXN0L2FzdF9tb2RlLmMKQEAgLTEwNjQsMjMgKzEwNjQsNiBA
QCBzdGF0aWMgdm9pZCBhc3RfaTJjX2Rlc3Ryb3koc3RydWN0IGFzdF9pMmNfY2hhbiAqaTJjKQog
CWtmcmVlKGkyYyk7CiB9CiAKLXN0YXRpYyB2b2lkIGFzdF9zaG93X2N1cnNvcihzdHJ1Y3QgZHJt
X2NydGMgKmNydGMpCi17Ci0Jc3RydWN0IGFzdF9wcml2YXRlICphc3QgPSBjcnRjLT5kZXYtPmRl
dl9wcml2YXRlOwotCXU4IGpyZWc7Ci0KLQlqcmVnID0gMHgyOwotCS8qIGVuYWJsZSBBUkdCIGN1
cnNvciAqLwotCWpyZWcgfD0gMTsKLQlhc3Rfc2V0X2luZGV4X3JlZ19tYXNrKGFzdCwgQVNUX0lP
X0NSVENfUE9SVCwgMHhjYiwgMHhmYywganJlZyk7Ci19Ci0KLXN0YXRpYyB2b2lkIGFzdF9oaWRl
X2N1cnNvcihzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCi17Ci0Jc3RydWN0IGFzdF9wcml2YXRlICph
c3QgPSBjcnRjLT5kZXYtPmRldl9wcml2YXRlOwotCWFzdF9zZXRfaW5kZXhfcmVnX21hc2soYXN0
LCBBU1RfSU9fQ1JUQ19QT1JULCAweGNiLCAweGZjLCAweDAwKTsKLX0KLQogc3RhdGljIHUzMiBj
b3B5X2N1cnNvcl9pbWFnZSh1OCAqc3JjLCB1OCAqZHN0LCBpbnQgd2lkdGgsIGludCBoZWlnaHQp
CiB7CiAJdW5pb24gewpAQCAtMTEzNyw2ICsxMTIwLDcyIEBAIHN0YXRpYyB1MzIgY29weV9jdXJz
b3JfaW1hZ2UodTggKnNyYywgdTggKmRzdCwgaW50IHdpZHRoLCBpbnQgaGVpZ2h0KQogCXJldHVy
biBjc3VtOwogfQogCitzdGF0aWMgaW50IGFzdF9jdXJzb3JfdXBkYXRlKHZvaWQgKmRzdCwgdm9p
ZCAqc3JjLCB1bnNpZ25lZCBpbnQgd2lkdGgsCisJCQkgICAgIHVuc2lnbmVkIGludCBoZWlnaHQp
Cit7CisJdTMyIGNzdW07CisKKwkvKiBkbyBkYXRhIHRyYW5zZmVyIHRvIGN1cnNvciBjYWNoZSAq
LworCWNzdW0gPSBjb3B5X2N1cnNvcl9pbWFnZShzcmMsIGRzdCwgd2lkdGgsIGhlaWdodCk7CisK
KwkvKiB3cml0ZSBjaGVja3N1bSArIHNpZ25hdHVyZSAqLworCWRzdCArPSBBU1RfSFdDX1NJWkU7
CisJd3JpdGVsKGNzdW0sIGRzdCk7CisJd3JpdGVsKHdpZHRoLCBkc3QgKyBBU1RfSFdDX1NJR05B
VFVSRV9TaXplWCk7CisJd3JpdGVsKGhlaWdodCwgZHN0ICsgQVNUX0hXQ19TSUdOQVRVUkVfU2l6
ZVkpOworCXdyaXRlbCgwLCBkc3QgKyBBU1RfSFdDX1NJR05BVFVSRV9IT1RTUE9UWCk7CisJd3Jp
dGVsKDAsIGRzdCArIEFTVF9IV0NfU0lHTkFUVVJFX0hPVFNQT1RZKTsKKworCXJldHVybiAwOwor
fQorCitzdGF0aWMgdm9pZCBhc3RfY3Vyc29yX3NldF9iYXNlKHN0cnVjdCBhc3RfcHJpdmF0ZSAq
YXN0LCB1NjQgYWRkcmVzcykKK3sKKwl1OCBhZGRyMCA9IChhZGRyZXNzID4+IDMpICYgMHhmZjsK
Kwl1OCBhZGRyMSA9IChhZGRyZXNzID4+IDExKSAmIDB4ZmY7CisJdTggYWRkcjIgPSAoYWRkcmVz
cyA+PiAxOSkgJiAweGZmOworCisJYXN0X3NldF9pbmRleF9yZWcoYXN0LCBBU1RfSU9fQ1JUQ19Q
T1JULCAweGM4LCBhZGRyMCk7CisJYXN0X3NldF9pbmRleF9yZWcoYXN0LCBBU1RfSU9fQ1JUQ19Q
T1JULCAweGM5LCBhZGRyMSk7CisJYXN0X3NldF9pbmRleF9yZWcoYXN0LCBBU1RfSU9fQ1JUQ19Q
T1JULCAweGNhLCBhZGRyMik7Cit9CisKK3N0YXRpYyBpbnQgYXN0X3Nob3dfY3Vyc29yKHN0cnVj
dCBkcm1fY3J0YyAqY3J0Yywgdm9pZCAqZHN0LCB2b2lkICpzcmMsCisJCQkgICB1bnNpZ25lZCBp
bnQgd2lkdGgsIHVuc2lnbmVkIGludCBoZWlnaHQsCisJCQkgICB1NjQgZHN0X2dwdSkKK3sKKwlz
dHJ1Y3QgYXN0X3ByaXZhdGUgKmFzdCA9IGNydGMtPmRldi0+ZGV2X3ByaXZhdGU7CisJc3RydWN0
IGFzdF9jcnRjICphc3RfY3J0YyA9IHRvX2FzdF9jcnRjKGNydGMpOworCWludCByZXQ7CisJdTgg
anJlZzsKKworCWRzdCArPSAoQVNUX0hXQ19TSVpFICsgQVNUX0hXQ19TSUdOQVRVUkVfU0laRSkq
YXN0LT5uZXh0X2N1cnNvcjsKKworCXJldCA9IGFzdF9jdXJzb3JfdXBkYXRlKGRzdCwgc3JjLCB3
aWR0aCwgaGVpZ2h0KTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCWFzdF9jdXJzb3Jfc2V0
X2Jhc2UoYXN0LCBkc3RfZ3B1KTsKKworCWFzdC0+bmV4dF9jdXJzb3IgPSAoYXN0LT5uZXh0X2N1
cnNvciArIDEpICUgQVNUX0RFRkFVTFRfSFdDX05VTTsKKworCWFzdF9jcnRjLT5vZmZzZXRfeCA9
IEFTVF9NQVhfSFdDX1dJRFRIIC0gd2lkdGg7CisJYXN0X2NydGMtPm9mZnNldF95ID0gQVNUX01B
WF9IV0NfV0lEVEggLSBoZWlnaHQ7CisKKwlqcmVnID0gMHgyOworCS8qIGVuYWJsZSBBUkdCIGN1
cnNvciAqLworCWpyZWcgfD0gMTsKKwlhc3Rfc2V0X2luZGV4X3JlZ19tYXNrKGFzdCwgQVNUX0lP
X0NSVENfUE9SVCwgMHhjYiwgMHhmYywganJlZyk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGlj
IHZvaWQgYXN0X2hpZGVfY3Vyc29yKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykKK3sKKwlzdHJ1Y3Qg
YXN0X3ByaXZhdGUgKmFzdCA9IGNydGMtPmRldi0+ZGV2X3ByaXZhdGU7CisKKwlhc3Rfc2V0X2lu
ZGV4X3JlZ19tYXNrKGFzdCwgQVNUX0lPX0NSVENfUE9SVCwgMHhjYiwgMHhmYywgMHgwMCk7Cit9
CisKIHN0YXRpYyBpbnQgYXN0X2N1cnNvcl9zZXQoc3RydWN0IGRybV9jcnRjICpjcnRjLAogCQkJ
ICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdiwKIAkJCSAgdWludDMyX3QgaGFuZGxlLApAQCAt
MTE0NCwxMiArMTE5Myw5IEBAIHN0YXRpYyBpbnQgYXN0X2N1cnNvcl9zZXQoc3RydWN0IGRybV9j
cnRjICpjcnRjLAogCQkJICB1aW50MzJfdCBoZWlnaHQpCiB7CiAJc3RydWN0IGFzdF9wcml2YXRl
ICphc3QgPSBjcnRjLT5kZXYtPmRldl9wcml2YXRlOwotCXN0cnVjdCBhc3RfY3J0YyAqYXN0X2Ny
dGMgPSB0b19hc3RfY3J0YyhjcnRjKTsKIAlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iajsKIAlz
dHJ1Y3QgZHJtX2dlbV92cmFtX29iamVjdCAqZ2JvOwogCXM2NCBkc3RfZ3B1OwotCXU2NCBncHVf
YWRkcjsKLQl1MzIgY3N1bTsKIAlpbnQgcmV0OwogCXU4ICpzcmMsICpkc3Q7CiAKQEAgLTExODUs
MzcgKzEyMzEsOSBAQCBzdGF0aWMgaW50IGFzdF9jdXJzb3Jfc2V0KHN0cnVjdCBkcm1fY3J0YyAq
Y3J0YywKIAkJZ290byBlcnJfZHJtX2dlbV92cmFtX3Z1bm1hcDsKIAl9CiAKLQlkc3QgKz0gKEFT
VF9IV0NfU0laRSArIEFTVF9IV0NfU0lHTkFUVVJFX1NJWkUpKmFzdC0+bmV4dF9jdXJzb3I7Ci0K
LQkvKiBkbyBkYXRhIHRyYW5zZmVyIHRvIGN1cnNvciBjYWNoZSAqLwotCWNzdW0gPSBjb3B5X2N1
cnNvcl9pbWFnZShzcmMsIGRzdCwgd2lkdGgsIGhlaWdodCk7Ci0KLQkvKiB3cml0ZSBjaGVja3N1
bSArIHNpZ25hdHVyZSAqLwotCXsKLQkJc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKmRzdF9n
Ym8gPQotCQkJZHJtX2dlbV92cmFtX29mX2dlbShhc3QtPmN1cnNvcl9jYWNoZSk7Ci0JCXU4ICpk
c3QgPSBkcm1fZ2VtX3ZyYW1fa21hcChkc3RfZ2JvLCBmYWxzZSwgTlVMTCk7Ci0JCWRzdCArPSAo
QVNUX0hXQ19TSVpFICsgQVNUX0hXQ19TSUdOQVRVUkVfU0laRSkqYXN0LT5uZXh0X2N1cnNvciAr
IEFTVF9IV0NfU0laRTsKLQkJd3JpdGVsKGNzdW0sIGRzdCk7Ci0JCXdyaXRlbCh3aWR0aCwgZHN0
ICsgQVNUX0hXQ19TSUdOQVRVUkVfU2l6ZVgpOwotCQl3cml0ZWwoaGVpZ2h0LCBkc3QgKyBBU1Rf
SFdDX1NJR05BVFVSRV9TaXplWSk7Ci0JCXdyaXRlbCgwLCBkc3QgKyBBU1RfSFdDX1NJR05BVFVS
RV9IT1RTUE9UWCk7Ci0JCXdyaXRlbCgwLCBkc3QgKyBBU1RfSFdDX1NJR05BVFVSRV9IT1RTUE9U
WSk7Ci0KLQkJLyogc2V0IHBhdHRlcm4gb2Zmc2V0ICovCi0JCWdwdV9hZGRyID0gKHU2NClkc3Rf
Z3B1OwotCQlncHVfYWRkciArPSAoQVNUX0hXQ19TSVpFICsgQVNUX0hXQ19TSUdOQVRVUkVfU0la
RSkqYXN0LT5uZXh0X2N1cnNvcjsKLQkJZ3B1X2FkZHIgPj49IDM7Ci0JCWFzdF9zZXRfaW5kZXhf
cmVnKGFzdCwgQVNUX0lPX0NSVENfUE9SVCwgMHhjOCwgZ3B1X2FkZHIgJiAweGZmKTsKLQkJYXN0
X3NldF9pbmRleF9yZWcoYXN0LCBBU1RfSU9fQ1JUQ19QT1JULCAweGM5LCAoZ3B1X2FkZHIgPj4g
OCkgJiAweGZmKTsKLQkJYXN0X3NldF9pbmRleF9yZWcoYXN0LCBBU1RfSU9fQ1JUQ19QT1JULCAw
eGNhLCAoZ3B1X2FkZHIgPj4gMTYpICYgMHhmZik7Ci0JfQotCWFzdF9jcnRjLT5vZmZzZXRfeCA9
IEFTVF9NQVhfSFdDX1dJRFRIIC0gd2lkdGg7Ci0JYXN0X2NydGMtPm9mZnNldF95ID0gQVNUX01B
WF9IV0NfV0lEVEggLSBoZWlnaHQ7Ci0KLQlhc3QtPm5leHRfY3Vyc29yID0gKGFzdC0+bmV4dF9j
dXJzb3IgKyAxKSAlIEFTVF9ERUZBVUxUX0hXQ19OVU07Ci0KLQlhc3Rfc2hvd19jdXJzb3IoY3J0
Yyk7CisJcmV0ID0gYXN0X3Nob3dfY3Vyc29yKGNydGMsIGRzdCwgc3JjLCB3aWR0aCwgaGVpZ2h0
LCBkc3RfZ3B1KTsKKwlpZiAocmV0KQorCQlnb3RvIGVycl9kcm1fZ2VtX3ZyYW1fa3VubWFwOwog
CiAJZHJtX2dlbV92cmFtX3Z1bm1hcChnYm8sIHNyYyk7CiAJZHJtX2dlbV9vYmplY3RfcHV0X3Vu
bG9ja2VkKG9iaik7Ci0tIAoyLjIzLjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZy
ZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3Rp
bmZvL2RyaS1kZXZlbA==
