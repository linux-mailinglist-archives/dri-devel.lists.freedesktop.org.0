Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 9B77D35E0A6
	for <lists+dri-devel@lfdr.de>; Tue, 13 Apr 2021 15:53:04 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6128D89E03;
	Tue, 13 Apr 2021 13:52:55 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x52a.google.com (mail-ed1-x52a.google.com
 [IPv6:2a00:1450:4864:20::52a])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 39C5789D4B
 for <dri-devel@lists.freedesktop.org>; Tue, 13 Apr 2021 13:52:53 +0000 (UTC)
Received: by mail-ed1-x52a.google.com with SMTP id w23so19496583edx.7
 for <dri-devel@lists.freedesktop.org>; Tue, 13 Apr 2021 06:52:53 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=2ytVj+fYbY0cgJ5TUUs3f8zEEya4m6gj9MLrdt5aXgs=;
 b=ZXkvHqhzSAJj+7RHnoLI4D13P39Fl0dBWS5I5CaJIa8C9UDbBTef+safLV6wTXIpa0
 4aMOazfm9kvq0UVCz3/FydZb2ZdLn59HJzS8/uCzCVslWK2OVwYRZet6OfHd6OQ70mC3
 V3JEbyPgKNdWutFZ2ZVJk/bolqMZ+C1DN2OoB06vdqcl7hcI9awPDYAow33q8jPGO+FX
 bupSLrj3jxh+p36xhbgSxKH6f62DQwGBfT91BZ4FH/xJoxh5kKdRX/h+QVWFhjarRaKp
 qhgfF30MrQzqNmel5HB04y34kxiNZHeiHvjFEBpxbMSCrlLcE2aINyup2KUs62NOwYK0
 MUkw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=2ytVj+fYbY0cgJ5TUUs3f8zEEya4m6gj9MLrdt5aXgs=;
 b=inO63sNJm7SDoZGloH6fhJTrkeMSc0+StG4+82jRuNeuvCA7sEe0qIk4s7H//Jrz4Q
 1AppzVeklCsFpE45+VqNYzQuacWxFsTRD5aTkJ6+tpGL+HGl5TxNkhFP44Y0XscZpr1n
 DP5GawY0tkTnn/MbJxhXHU23OrvUFbbC70x3NfitH47c6XyQlXCSk2XYn1Ezcn5Kp2h8
 jTaXvI6ykCQh8s3hen/GqYFeSRW7XaytGsx79Srf/w7vWU6goJPo9xKbkm4bHQPCHLkF
 zRwZ3OVInzM+a0tTcqGqs7KZnGPnckrlFWnY0jKvUOh+H9/giIPwsraalaWsSz3MmA4B
 dL2g==
X-Gm-Message-State: AOAM530Y8LHVrnk9flMc60cdIb4BX1nykCmdM4NZ4K1pWiQJH3APUfom
 ZrrEIq6pmfgvZ3NB+Alf2MVW69wWRRE=
X-Google-Smtp-Source: ABdhPJy4hcdbIbPS2uAbBprx3KDLnlH0Ywm45COVmO2LaRrc0D3jDMcLn7HVwofJjytq2hk5tjUUPg==
X-Received: by 2002:a50:ee85:: with SMTP id f5mr31844274edr.203.1618321971914; 
 Tue, 13 Apr 2021 06:52:51 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:a061:9101:8418:4794])
 by smtp.gmail.com with ESMTPSA id m10sm491465ejc.32.2021.04.13.06.52.51
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 13 Apr 2021 06:52:51 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 4/7] drm/ttm: move the page_alignment into the BO
Date: Tue, 13 Apr 2021 15:52:45 +0200
Message-Id: <20210413135248.1266-4-christian.koenig@amd.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20210413135248.1266-1-christian.koenig@amd.com>
References: <20210413135248.1266-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: daniel.vetter@ffwll.ch, thomas.hellstrom@linux.intel.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIGFsaWdubWVudCBpcyBhIGNvbnN0YW50IHByb3BlcnR5IGFuZCBzaG91bGRuJ3QgY2hhbmdl
LgoKU2lnbmVkLW9mZi1ieTogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0aWFuLmtvZW5pZ0BhbWQu
Y29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nZW0uYyAgICAgIHwg
IDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9ndHRfbWdyLmMgIHwgIDIg
Ky0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9vYmplY3QuaCAgIHwgIDIgKy0K
IGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92cmFtX21nci5jIHwgIDUgKysrLS0K
IGRyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX29iamVjdC5oICAgICAgIHwgIDIgKy0KIGRy
aXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvLmMgICAgICAgICAgICAgICAgIHwgIDMgKy0tCiBkcml2
ZXJzL2dwdS9kcm0vdHRtL3R0bV9yYW5nZV9tYW5hZ2VyLmMgICAgICB8ICA1ICsrLS0tCiBkcml2
ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF90aHAuYyAgICAgICAgICB8IDE1ICsrKysrKysrLS0t
LS0tLQogaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19hcGkuaCAgICAgICAgICAgICAgICAgfCAgMSAr
CiBpbmNsdWRlL2RybS90dG0vdHRtX3Jlc291cmNlLmggICAgICAgICAgICAgICB8ICAxIC0KIDEw
IGZpbGVzIGNoYW5nZWQsIDE5IGluc2VydGlvbnMoKyksIDE5IGRlbGV0aW9ucygtKQoKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nZW0uYyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nZW0uYwppbmRleCBiNDQzOTA3YWZjZWEuLmYxYzM5
N2JlMzgzZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dl
bS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nZW0uYwpAQCAtNzYz
LDcgKzc2Myw3IEBAIGludCBhbWRncHVfZ2VtX29wX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYsIHZvaWQgKmRhdGEsCiAJCXZvaWQgX191c2VyICpvdXQgPSB1NjRfdG9fdXNlcl9wdHIoYXJn
cy0+dmFsdWUpOwogCiAJCWluZm8uYm9fc2l6ZSA9IHJvYmotPnRiby5iYXNlLnNpemU7Ci0JCWlu
Zm8uYWxpZ25tZW50ID0gcm9iai0+dGJvLm1lbS5wYWdlX2FsaWdubWVudCA8PCBQQUdFX1NISUZU
OworCQlpbmZvLmFsaWdubWVudCA9IHJvYmotPnRiby5wYWdlX2FsaWdubWVudCA8PCBQQUdFX1NI
SUZUOwogCQlpbmZvLmRvbWFpbnMgPSByb2JqLT5wcmVmZXJyZWRfZG9tYWluczsKIAkJaW5mby5k
b21haW5fZmxhZ3MgPSByb2JqLT5mbGFnczsKIAkJYW1kZ3B1X2JvX3VucmVzZXJ2ZShyb2JqKTsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9ndHRfbWdyLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZ3R0X21nci5jCmluZGV4IDg4NjA1
NDUzNDRjNy4uYzAyNjk3MmNhOWExIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9hbWRncHVfZ3R0X21nci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV9ndHRfbWdyLmMKQEAgLTEzNiw3ICsxMzYsNyBAQCBzdGF0aWMgaW50IGFtZGdwdV9ndHRf
bWdyX25ldyhzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiwKIAogCXNwaW5fbG9jaygm
bWdyLT5sb2NrKTsKIAlyID0gZHJtX21tX2luc2VydF9ub2RlX2luX3JhbmdlKCZtZ3ItPm1tLCAm
bm9kZS0+bm9kZSwgbWVtLT5udW1fcGFnZXMsCi0JCQkJCW1lbS0+cGFnZV9hbGlnbm1lbnQsIDAs
IHBsYWNlLT5mcGZuLAorCQkJCQl0Ym8tPnBhZ2VfYWxpZ25tZW50LCAwLCBwbGFjZS0+ZnBmbiwK
IAkJCQkJcGxhY2UtPmxwZm4sIERSTV9NTV9JTlNFUlRfQkVTVCk7CiAJc3Bpbl91bmxvY2soJm1n
ci0+bG9jayk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9vYmplY3QuaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9vYmplY3QuaApp
bmRleCA5YWMzNzU2OTgyM2YuLmFlNGE2OGRiODdjMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X29iamVjdC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV9vYmplY3QuaApAQCAtMTg0LDcgKzE4NCw3IEBAIHN0YXRpYyBpbmxpbmUg
dW5zaWduZWQgYW1kZ3B1X2JvX25ncHVfcGFnZXMoc3RydWN0IGFtZGdwdV9ibyAqYm8pCiAKIHN0
YXRpYyBpbmxpbmUgdW5zaWduZWQgYW1kZ3B1X2JvX2dwdV9wYWdlX2FsaWdubWVudChzdHJ1Y3Qg
YW1kZ3B1X2JvICpibykKIHsKLQlyZXR1cm4gKGJvLT50Ym8ubWVtLnBhZ2VfYWxpZ25tZW50IDw8
IFBBR0VfU0hJRlQpIC8gQU1ER1BVX0dQVV9QQUdFX1NJWkU7CisJcmV0dXJuIChiby0+dGJvLnBh
Z2VfYWxpZ25tZW50IDw8IFBBR0VfU0hJRlQpIC8gQU1ER1BVX0dQVV9QQUdFX1NJWkU7CiB9CiAK
IC8qKgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZyYW1f
bWdyLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdnJhbV9tZ3IuYwppbmRl
eCAxZmM3ZWMwYjg5MTUuLjM4YjE5OTVkMGQ2YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X3ZyYW1fbWdyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X3ZyYW1fbWdyLmMKQEAgLTM5Miw3ICszOTIsOCBAQCBzdGF0aWMgaW50IGFt
ZGdwdV92cmFtX21ncl9uZXcoc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYW4sCiAJCS8q
IGRlZmF1bHQgdG8gMk1CICovCiAJCXBhZ2VzX3Blcl9ub2RlID0gKDJVTCA8PCAoMjBVTCAtIFBB
R0VfU0hJRlQpKTsKICNlbmRpZgotCQlwYWdlc19wZXJfbm9kZSA9IG1heCgodWludDMyX3QpcGFn
ZXNfcGVyX25vZGUsIG1lbS0+cGFnZV9hbGlnbm1lbnQpOworCQlwYWdlc19wZXJfbm9kZSA9IG1h
eCgodWludDMyX3QpcGFnZXNfcGVyX25vZGUsCisJCQkJICAgICB0Ym8tPnBhZ2VfYWxpZ25tZW50
KTsKIAkJbnVtX25vZGVzID0gRElWX1JPVU5EX1VQKG1lbS0+bnVtX3BhZ2VzLCBwYWdlc19wZXJf
bm9kZSk7CiAJfQogCkBAIC00MzEsNyArNDMyLDcgQEAgc3RhdGljIGludCBhbWRncHVfdnJhbV9t
Z3JfbmV3KHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuLAogCiAJZm9yICg7IHBhZ2Vz
X2xlZnQ7ICsraSkgewogCQl1bnNpZ25lZCBsb25nIHBhZ2VzID0gbWluKHBhZ2VzX2xlZnQsIHBh
Z2VzX3Blcl9ub2RlKTsKLQkJdWludDMyX3QgYWxpZ25tZW50ID0gbWVtLT5wYWdlX2FsaWdubWVu
dDsKKwkJdWludDMyX3QgYWxpZ25tZW50ID0gdGJvLT5wYWdlX2FsaWdubWVudDsKIAogCQlpZiAo
cGFnZXMgPT0gcGFnZXNfcGVyX25vZGUpCiAJCQlhbGlnbm1lbnQgPSBwYWdlc19wZXJfbm9kZTsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX29iamVjdC5oIGIvZHJp
dmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fb2JqZWN0LmgKaW5kZXggOTg5NmQ4MjMxZmU1Li5m
ZDQxMTZiZGRlMGYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX29i
amVjdC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX29iamVjdC5oCkBAIC0x
MTksNyArMTE5LDcgQEAgc3RhdGljIGlubGluZSB1bnNpZ25lZCByYWRlb25fYm9fbmdwdV9wYWdl
cyhzdHJ1Y3QgcmFkZW9uX2JvICpibykKIAogc3RhdGljIGlubGluZSB1bnNpZ25lZCByYWRlb25f
Ym9fZ3B1X3BhZ2VfYWxpZ25tZW50KHN0cnVjdCByYWRlb25fYm8gKmJvKQogewotCXJldHVybiAo
Ym8tPnRiby5tZW0ucGFnZV9hbGlnbm1lbnQgPDwgUEFHRV9TSElGVCkgLyBSQURFT05fR1BVX1BB
R0VfU0laRTsKKwlyZXR1cm4gKGJvLT50Ym8ucGFnZV9hbGlnbm1lbnQgPDwgUEFHRV9TSElGVCkg
LyBSQURFT05fR1BVX1BBR0VfU0laRTsKIH0KIAogLyoqCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vdHRtL3R0bV9iby5jIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm8uYwppbmRleCBj
ZmQwYjkyOTIzOTcuLjJlZmFlNjIwNzU5YSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0
bS90dG1fYm8uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5jCkBAIC05MDMsNyAr
OTAzLDYgQEAgc3RhdGljIGludCB0dG1fYm9fbW92ZV9idWZmZXIoc3RydWN0IHR0bV9idWZmZXJf
b2JqZWN0ICpibywKIAltZW1zZXQoJmhvcCwgMCwgc2l6ZW9mKGhvcCkpOwogCiAJbWVtLm51bV9w
YWdlcyA9IFBBR0VfQUxJR04oYm8tPmJhc2Uuc2l6ZSkgPj4gUEFHRV9TSElGVDsKLQltZW0ucGFn
ZV9hbGlnbm1lbnQgPSBiby0+bWVtLnBhZ2VfYWxpZ25tZW50OwogCW1lbS5idXMub2Zmc2V0ID0g
MDsKIAltZW0uYnVzLmFkZHIgPSBOVUxMOwogCW1lbS5tbV9ub2RlID0gTlVMTDsKQEAgLTEwMzgs
MTAgKzEwMzcsMTAgQEAgaW50IHR0bV9ib19pbml0X3Jlc2VydmVkKHN0cnVjdCB0dG1fZGV2aWNl
ICpiZGV2LAogCUlOSVRfTElTVF9IRUFEKCZiby0+ZGRlc3Ryb3kpOwogCWJvLT5iZGV2ID0gYmRl
djsKIAliby0+dHlwZSA9IHR5cGU7CisJYm8tPnBhZ2VfYWxpZ25tZW50ID0gcGFnZV9hbGlnbm1l
bnQ7CiAJYm8tPm1lbS5tZW1fdHlwZSA9IFRUTV9QTF9TWVNURU07CiAJYm8tPm1lbS5udW1fcGFn
ZXMgPSBQQUdFX0FMSUdOKHNpemUpID4+IFBBR0VfU0hJRlQ7CiAJYm8tPm1lbS5tbV9ub2RlID0g
TlVMTDsKLQliby0+bWVtLnBhZ2VfYWxpZ25tZW50ID0gcGFnZV9hbGlnbm1lbnQ7CiAJYm8tPm1l
bS5idXMub2Zmc2V0ID0gMDsKIAliby0+bWVtLmJ1cy5hZGRyID0gTlVMTDsKIAliby0+bW92aW5n
ID0gTlVMTDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3JhbmdlX21hbmFn
ZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3JhbmdlX21hbmFnZXIuYwppbmRleCBiMWUz
ZjMwZjdlMmQuLmI5ZDVkYTZlNmE4MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0bS90
dG1fcmFuZ2VfbWFuYWdlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3JhbmdlX21h
bmFnZXIuYwpAQCAtNzksOSArNzksOCBAQCBzdGF0aWMgaW50IHR0bV9yYW5nZV9tYW5fYWxsb2Mo
c3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYW4sCiAJCW1vZGUgPSBEUk1fTU1fSU5TRVJU
X0hJR0g7CiAKIAlzcGluX2xvY2soJnJtYW4tPmxvY2spOwotCXJldCA9IGRybV9tbV9pbnNlcnRf
bm9kZV9pbl9yYW5nZShtbSwgbm9kZSwKLQkJCQkJICBtZW0tPm51bV9wYWdlcywKLQkJCQkJICBt
ZW0tPnBhZ2VfYWxpZ25tZW50LCAwLAorCXJldCA9IGRybV9tbV9pbnNlcnRfbm9kZV9pbl9yYW5n
ZShtbSwgbm9kZSwgbWVtLT5udW1fcGFnZXMsCisJCQkJCSAgYm8tPnBhZ2VfYWxpZ25tZW50LCAw
LAogCQkJCQkgIHBsYWNlLT5mcGZuLCBscGZuLCBtb2RlKTsKIAlzcGluX3VubG9jaygmcm1hbi0+
bG9jayk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3RocC5j
IGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfdGhwLmMKaW5kZXggZWI2M2NiZTY0OTA5
Li41Y2NjMzViMzE5NGMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4
X3RocC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3RocC5jCkBAIC0yOCwx
NSArMjgsMTYgQEAgc3RhdGljIHN0cnVjdCB2bXdfdGhwX21hbmFnZXIgKnRvX3RocF9tYW5hZ2Vy
KHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuKQogCiBzdGF0aWMgY29uc3Qgc3RydWN0
IHR0bV9yZXNvdXJjZV9tYW5hZ2VyX2Z1bmMgdm13X3RocF9mdW5jOwogCi1zdGF0aWMgaW50IHZt
d190aHBfaW5zZXJ0X2FsaWduZWQoc3RydWN0IGRybV9tbSAqbW0sIHN0cnVjdCBkcm1fbW1fbm9k
ZSAqbm9kZSwKK3N0YXRpYyBpbnQgdm13X3RocF9pbnNlcnRfYWxpZ25lZChzdHJ1Y3QgdHRtX2J1
ZmZlcl9vYmplY3QgKmJvLAorCQkJCSAgc3RydWN0IGRybV9tbSAqbW0sIHN0cnVjdCBkcm1fbW1f
bm9kZSAqbm9kZSwKIAkJCQkgIHVuc2lnbmVkIGxvbmcgYWxpZ25fcGFnZXMsCiAJCQkJICBjb25z
dCBzdHJ1Y3QgdHRtX3BsYWNlICpwbGFjZSwKIAkJCQkgIHN0cnVjdCB0dG1fcmVzb3VyY2UgKm1l
bSwKIAkJCQkgIHVuc2lnbmVkIGxvbmcgbHBmbiwKIAkJCQkgIGVudW0gZHJtX21tX2luc2VydF9t
b2RlIG1vZGUpCiB7Ci0JaWYgKGFsaWduX3BhZ2VzID49IG1lbS0+cGFnZV9hbGlnbm1lbnQgJiYK
LQkgICAgKCFtZW0tPnBhZ2VfYWxpZ25tZW50IHx8IGFsaWduX3BhZ2VzICUgbWVtLT5wYWdlX2Fs
aWdubWVudCA9PSAwKSkgeworCWlmIChhbGlnbl9wYWdlcyA+PSBiby0+cGFnZV9hbGlnbm1lbnQg
JiYKKwkgICAgKCFiby0+cGFnZV9hbGlnbm1lbnQgfHwgYWxpZ25fcGFnZXMgJSBiby0+cGFnZV9h
bGlnbm1lbnQgPT0gMCkpIHsKIAkJcmV0dXJuIGRybV9tbV9pbnNlcnRfbm9kZV9pbl9yYW5nZSht
bSwgbm9kZSwKIAkJCQkJCSAgIG1lbS0+bnVtX3BhZ2VzLAogCQkJCQkJICAgYWxpZ25fcGFnZXMs
IDAsCkBAIC03NSw3ICs3Niw3IEBAIHN0YXRpYyBpbnQgdm13X3RocF9nZXRfbm9kZShzdHJ1Y3Qg
dHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiwKIAlpZiAoSVNfRU5BQkxFRChDT05GSUdfSEFWRV9B
UkNIX1RSQU5TUEFSRU5UX0hVR0VQQUdFX1BVRCkpIHsKIAkJYWxpZ25fcGFnZXMgPSAoSFBBR0Vf
UFVEX1NJWkUgPj4gUEFHRV9TSElGVCk7CiAJCWlmIChtZW0tPm51bV9wYWdlcyA+PSBhbGlnbl9w
YWdlcykgewotCQkJcmV0ID0gdm13X3RocF9pbnNlcnRfYWxpZ25lZChtbSwgbm9kZSwgYWxpZ25f
cGFnZXMsCisJCQlyZXQgPSB2bXdfdGhwX2luc2VydF9hbGlnbmVkKGJvLCBtbSwgbm9kZSwgYWxp
Z25fcGFnZXMsCiAJCQkJCQkgICAgIHBsYWNlLCBtZW0sIGxwZm4sIG1vZGUpOwogCQkJaWYgKCFy
ZXQpCiAJCQkJZ290byBmb3VuZF91bmxvY2s7CkBAIC04NCwxNCArODUsMTQgQEAgc3RhdGljIGlu
dCB2bXdfdGhwX2dldF9ub2RlKHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuLAogCiAJ
YWxpZ25fcGFnZXMgPSAoSFBBR0VfUE1EX1NJWkUgPj4gUEFHRV9TSElGVCk7CiAJaWYgKG1lbS0+
bnVtX3BhZ2VzID49IGFsaWduX3BhZ2VzKSB7Ci0JCXJldCA9IHZtd190aHBfaW5zZXJ0X2FsaWdu
ZWQobW0sIG5vZGUsIGFsaWduX3BhZ2VzLCBwbGFjZSwgbWVtLAotCQkJCQkgICAgIGxwZm4sIG1v
ZGUpOworCQlyZXQgPSB2bXdfdGhwX2luc2VydF9hbGlnbmVkKGJvLCBtbSwgbm9kZSwgYWxpZ25f
cGFnZXMsIHBsYWNlLAorCQkJCQkgICAgIG1lbSwgbHBmbiwgbW9kZSk7CiAJCWlmICghcmV0KQog
CQkJZ290byBmb3VuZF91bmxvY2s7CiAJfQogCiAJcmV0ID0gZHJtX21tX2luc2VydF9ub2RlX2lu
X3JhbmdlKG1tLCBub2RlLCBtZW0tPm51bV9wYWdlcywKLQkJCQkJICBtZW0tPnBhZ2VfYWxpZ25t
ZW50LCAwLAorCQkJCQkgIGJvLT5wYWdlX2FsaWdubWVudCwgMCwKIAkJCQkJICBwbGFjZS0+ZnBm
biwgbHBmbiwgbW9kZSk7CiBmb3VuZF91bmxvY2s6CiAJc3Bpbl91bmxvY2soJnJtYW4tPmxvY2sp
OwpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19hcGkuaCBiL2luY2x1ZGUvZHJt
L3R0bS90dG1fYm9fYXBpLmgKaW5kZXggMzU4N2Y2NjBlOGY0Li4xNjdjMTMyYmExYzIgMTAwNjQ0
Ci0tLSBhL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmgKKysrIGIvaW5jbHVkZS9kcm0vdHRt
L3R0bV9ib19hcGkuaApAQCAtMTIzLDYgKzEyMyw3IEBAIHN0cnVjdCB0dG1fYnVmZmVyX29iamVj
dCB7CiAKIAlzdHJ1Y3QgdHRtX2RldmljZSAqYmRldjsKIAllbnVtIHR0bV9ib190eXBlIHR5cGU7
CisJdWludDMyX3QgcGFnZV9hbGlnbm1lbnQ7CiAJdm9pZCAoKmRlc3Ryb3kpIChzdHJ1Y3QgdHRt
X2J1ZmZlcl9vYmplY3QgKik7CiAKIAkvKioKZGlmZiAtLWdpdCBhL2luY2x1ZGUvZHJtL3R0bS90
dG1fcmVzb3VyY2UuaCBiL2luY2x1ZGUvZHJtL3R0bS90dG1fcmVzb3VyY2UuaAppbmRleCA2MTY0
Y2NmNGYzMDguLjNmZjRhNjY5NjQxZSAxMDA2NDQKLS0tIGEvaW5jbHVkZS9kcm0vdHRtL3R0bV9y
ZXNvdXJjZS5oCisrKyBiL2luY2x1ZGUvZHJtL3R0bS90dG1fcmVzb3VyY2UuaApAQCAtMTcyLDcg
KzE3Miw2IEBAIHN0cnVjdCB0dG1fcmVzb3VyY2UgewogCXZvaWQgKm1tX25vZGU7CiAJdW5zaWdu
ZWQgbG9uZyBzdGFydDsKIAl1bnNpZ25lZCBsb25nIG51bV9wYWdlczsKLQl1aW50MzJfdCBwYWdl
X2FsaWdubWVudDsKIAl1aW50MzJfdCBtZW1fdHlwZTsKIAl1aW50MzJfdCBwbGFjZW1lbnQ7CiAJ
c3RydWN0IHR0bV9idXNfcGxhY2VtZW50IGJ1czsKLS0gCjIuMjUuMQoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApk
cmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Au
b3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVsCg==
