Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 5238136BDE9
	for <lists+dri-devel@lfdr.de>; Tue, 27 Apr 2021 05:47:57 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F172E6E8EF;
	Tue, 27 Apr 2021 03:47:52 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from NAM10-DM6-obe.outbound.protection.outlook.com
 (mail-dm6nam10on2042.outbound.protection.outlook.com [40.107.93.42])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3A46F6E8EE;
 Tue, 27 Apr 2021 03:47:51 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=AJkF7vkuLBeN8Sy6jZeFbEQ+tqKSxXgKozTebqWtIwpU61aTs/ctEeDWZ09Dz4Hj7RAi119P/f41mRDQbpqxIdP6jFVP0QvBqpbOU9JzalTTBD844PWN6PTOW7w5By/jwpVvUsbnC3kULt1Iv71IHcRYFa4CkqHSc0X8FErcAOy367zWYzrD7OdnbX8sFFxXWXtOEZ9d3SOLe6W3+y55FouYz3wjUnFC/V6LrBb4Odup7KYiy9Wr5AGEsG48jvgSVPVqBX98hyvTsw343pcoulHMyKFrIMGqloCHBGHHJCGk64uyDKCa+7OO64Bp3LuQD37lZOqnEHsi1xRB2XKUAg==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=zEkT+3vaTxCu1QcGzxJRxypSGLO5EpGtmFMZh0+5FAY=;
 b=MTgIGXaYmNZH3AlScfGqsEDnr8auxquvbrwkqrQPLE9jLf0pP2OSCSJpBzV87fskikEKIJxr/OIte2nRWzJakLXF6XTmE9868gYQm3f51k9nmLwZAJL4yCmhuN9LN87ehYejlT9/fxQ2nccTh/1FkSsyuRQN0L3VTfzdtIiri5dJZckkm1+h7o+tqPSfDVoaFiNQc1UVa1lxyHCUbvsRBzj9acPqAKuFqqqnqvhQSKWNZV8Alyuq4eBsJY9Cikue3FuFfH6M8QqORcCyCZrP9dkW/HQwTAKHVPxpnfDgNlLAJwZfxfgAyfxzrpnUzwsIphcIMlXPD6WoHr51GsCDBg==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=amd.com; s=selector1; 
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=zEkT+3vaTxCu1QcGzxJRxypSGLO5EpGtmFMZh0+5FAY=;
 b=hhru3zjbx9ughJszQWUXEaPrU4AEaKji+MyVmN2bVNrG3N2p4MN4IBvcYh8/ooNTpFmVid2Mw93FPGkKFZv/EtladtMBUdqW1fxEMWAzqVm+k/3aAyB1xCFFrEpM7dDBLdLUW4ydldJd+WWrrjU1nZO458ZavmYsb0ttH67H6sw=
Authentication-Results: lists.freedesktop.org; dkim=none (message not signed)
 header.d=none; lists.freedesktop.org;
 dmarc=none action=none header.from=amd.com;
Received: from BL0PR12MB4948.namprd12.prod.outlook.com (2603:10b6:208:1cc::20)
 by MN2PR12MB4405.namprd12.prod.outlook.com (2603:10b6:208:26d::17)
 with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.4065.21; Tue, 27 Apr
 2021 03:47:48 +0000
Received: from BL0PR12MB4948.namprd12.prod.outlook.com
 ([fe80::70f5:99ed:65a1:c033]) by BL0PR12MB4948.namprd12.prod.outlook.com
 ([fe80::70f5:99ed:65a1:c033%7]) with mapi id 15.20.3933.040; Tue, 27 Apr 2021
 03:47:48 +0000
Subject: Re: [PATCH v2 06/10] drm/amdgpu: DMA map/unmap when updating GPU
 mappings
To: "Zeng, Oak" <Oak.Zeng@amd.com>,
 "amd-gfx@lists.freedesktop.org" <amd-gfx@lists.freedesktop.org>,
 "dri-devel@lists.freedesktop.org" <dri-devel@lists.freedesktop.org>
References: <20210422013058.6305-1-Felix.Kuehling@amd.com>
 <20210422013058.6305-7-Felix.Kuehling@amd.com>
 <95A9652F-CAC4-4D0B-82E8-7F84BABAB937@amd.com>
From: Felix Kuehling <felix.kuehling@amd.com>
Message-ID: <745a7952-51aa-4727-a8bf-7ca3d2dd4700@amd.com>
Date: Mon, 26 Apr 2021 23:47:46 -0400
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101
 Thunderbird/78.7.1
In-Reply-To: <95A9652F-CAC4-4D0B-82E8-7F84BABAB937@amd.com>
Content-Language: en-US
X-Originating-IP: [142.182.183.69]
X-ClientProxiedBy: YTXPR0101CA0058.CANPRD01.PROD.OUTLOOK.COM
 (2603:10b6:b00:1::35) To BL0PR12MB4948.namprd12.prod.outlook.com
 (2603:10b6:208:1cc::20)
MIME-Version: 1.0
X-MS-Exchange-MessageSentRepresentingType: 1
Received: from [192.168.2.100] (142.182.183.69) by
 YTXPR0101CA0058.CANPRD01.PROD.OUTLOOK.COM (2603:10b6:b00:1::35) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.4065.24 via Frontend
 Transport; Tue, 27 Apr 2021 03:47:47 +0000
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: 4301d23c-8c8a-4b70-50c7-08d9092f3957
X-MS-TrafficTypeDiagnostic: MN2PR12MB4405:
X-MS-Exchange-Transport-Forked: True
X-Microsoft-Antispam-PRVS: <MN2PR12MB4405D5B3958C7B62168E918B92419@MN2PR12MB4405.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:9508;
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: IlW2LigAwi9AwZ13Ty1zoKIWY8UyOI+GIL1Zoxho/YotRhRnCeqBsrYNnkGXCD55ezrFMwL6zoPwylCyZHXsLPRcV5UUlSl++mHa4ZkaXNssNAg0k7INUSbDP4My5kP/71KnbTyK7BWpHrsR6qVrC9hWkdG71xwo9O3ivF073fTMHu9LNMS9hNJFqNxhq0telKuf2vOsRf/hZJcozIWvBUadIigAAQiSx7+EaDRh5gFO3qmnvkXX/nxFZMp3FYZUVtm1LrJ2gZ4Fwqt/BF8RQQPjByNl7G8xZaIev5OJHuUXO6iSqOEb8+y9HA4i4+HXPIIS57HqcKRKLCKYS4JQzfEBBXZZa5Zw6kHMs6FHi5xvyztlrrPMH78syyNbNhFOwcDMKQMDcMok2pbTh62tOGqagirTOsCqnVurteIR4Fk58kIvXFuq98xgK/rXfC/ZXmHOY9FcQWv3vKFBK7ifn7MqSfgxyAySw9K3uvOVsDiSrPgHZQUzHUmwfdRE/KlwGT4ZJ8fCF+KdpXclWN5z1bogY+CyZtatem9IEQa5vekg6ccn6MrDETfnMsbPV/3Wf4Nvc2Ua3AhvWBSTPKqOPEKrnbLeBqZC5qbvYS1b8ZdcRxZJanqiwORMTt5gP4ZwE/TAJQoACQhfIaF1AJJyx2pNivWhM2oOlYgd9wQxkmtrD/vG3SIvX+FJfNLkApIFTzlyEUGIx+dK6nLPX5m9Pd62JiWMmhG/Il4H9EF8xZE=
X-Forefront-Antispam-Report: CIP:255.255.255.255; CTRY:; LANG:en; SCL:1; SRV:;
 IPV:NLI; SFV:NSPM; H:BL0PR12MB4948.namprd12.prod.outlook.com; PTR:; CAT:NONE;
 SFS:(4636009)(396003)(376002)(136003)(346002)(39860400002)(366004)(86362001)(2616005)(956004)(8936002)(16526019)(66476007)(2906002)(6486002)(38100700002)(966005)(44832011)(8676002)(66556008)(31696002)(66946007)(5660300002)(26005)(110136005)(31686004)(36756003)(83380400001)(186003)(316002)(478600001)(16576012)(450100002)(43740500002)(45980500001);
 DIR:OUT; SFP:1101; 
X-MS-Exchange-AntiSpam-MessageData: =?utf-8?B?QWhYK054LzIxOFFMdFhVa2pkN0xaclhDaGxBVERUSmt2ZHNzSXlnN3RaQ0hn?=
 =?utf-8?B?UEprQlZKUnc1QmhGNHRZZ24xeU9vQzNDelIvRnJLNnltVmVZalR2d290QkQr?=
 =?utf-8?B?RWgwWjdMZkd3M1J6NEJnNlZZNFJuRU11N2dybVNsYWc1Ri9md1B0U2hidmNB?=
 =?utf-8?B?djI1OFJIQmlWSEZseTFjeTN0aUNmbFM4TllxUkU3SHRCVTV4YmRLbTFvKzNz?=
 =?utf-8?B?QXBmK2dBUnoyNnVqbzlyWktDSDcvc1JYdk5QN1pvbHUwZTJMK3h1Y25NSVAw?=
 =?utf-8?B?SXlta014U2d4WThNVnZUY0hCbXNzMGZIclowTURqZnNsOXYweXdaUDdFZGQv?=
 =?utf-8?B?bHhRUUl0M1lDTTlRc1dLUjMvbjUya2diTXQvV0FkNFRPM0plR3pUTS9NMEVw?=
 =?utf-8?B?cWU0UU5UM0MrVU1IYjNFQ015b3RNcVNnU21TWEpEWjdRdFhHYS9raUdTVzJh?=
 =?utf-8?B?djM2RWt6a3BUSXovOVc1WU40NU9IbE1QZER3TEIvaGRmM043YnZYTFNwdmp2?=
 =?utf-8?B?OGhvQStkaGw5NkRDQTk0UjIzNUJhRm5WaVRwblAwSDFzNHBoaHhNUHlQZlJZ?=
 =?utf-8?B?VVE0RlJoc1BuRXVJdXNCT093SkxQQjRSMnFhOU5ncjdGZ3lGM0prbU40TVdZ?=
 =?utf-8?B?Z0xESUNmQzVJcVRvd3hySStzNE9wdndxQXZVcDZXdXJvT01OS1lsRVQyb3FB?=
 =?utf-8?B?SmNUdWJKQTRqUVJDZDkxTi8rd0ZmanQrSWp1eGVPNTJxMnlhKy9OVHVkRkN6?=
 =?utf-8?B?SlF6Nzh4QVpOU2prQk83UkFNalpBYmZzd1dwOFhITTZtczBGTjBJMTNUVDB0?=
 =?utf-8?B?R2JNVDMvbnZmOTRHOXplMEhBRFdSVVllTE9wRTlWWnlWRkxHWEdvSXgvbmw4?=
 =?utf-8?B?SmQ0Z0hyMlJTQnJxT3lFcndzWXp5SzNSM1hHTVVnNmlONGlsbkNTSmdscENX?=
 =?utf-8?B?ekZ2YjdYbFRwVXZzMVpFVlJ4WEtpT0htUk5FWUE5S0hPdEFVNndUQXkrZ1Mw?=
 =?utf-8?B?SDR0RklWRE8yQSt1eUticHNrNDRveXJnN2NjTDR6WHpJYW5zT3l2aXZiTmdv?=
 =?utf-8?B?VzdWaVdZRmZOV2xDRWMvUDlEaE9MSkwrT1hEdU5TcDJUbzd3WGhTVWltdHVt?=
 =?utf-8?B?UFM5U3k1NVdtMVNKT3BUQThxZjJmdnp0NWxHaFl4U21OeFdwSmZ3KzZ1RUlO?=
 =?utf-8?B?NmhnUERBWldHM1hadW5NTnQwa28vdUlDVHppaUdwMHlNbWRPMG5jTFpnckx1?=
 =?utf-8?B?SmlBQlRMSlJKU04vT0NtMlRIdmdtQ083OWxNU3FjdC95L3BQUmZ1UkdYUHFt?=
 =?utf-8?B?T01CaUNzVWxTTlpHamZpdW1uRDJNMTdIeGNYa1RHZ0QxTU05amJPaDc5UzdL?=
 =?utf-8?B?blVtSmxHaDZ2UkM1ZlN6clNMR0hFM1ZxZTB3NmpNWGV1d3FOdUZHZGtkQWd4?=
 =?utf-8?B?Zzg2Qks3Wk9EdVFtSEMrclN4TlZlbjhxOFJPTzIxalo0dE13ME94dTQyd1Fk?=
 =?utf-8?B?V1RRdk01akxLRzBzM2ZIRitjdFNSY1BrQWVGYmlBOEJQUXNaNjdzeXJqcW4z?=
 =?utf-8?B?Y2JpWDlIK25mVWJyWkowSmowdE1qTnZzcnpGbmlqL0dhajRWcTN0UTgrWXBa?=
 =?utf-8?B?eTkyajZ2ZUxmUW5zV2M1S0JuQnlvakFVcWc4U3Vac3ptTGRYcjhLb1JRaTlF?=
 =?utf-8?B?bHRsc0hTTHNKUHoxTDdpQ3ZNUmJQUlJWYTAzZ293ckNKVXlnK2MyRUw3YUJI?=
 =?utf-8?Q?Q6xqOFn1uGSHSAhVWJHHIhJvABJZJyD65Zoivnr?=
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 4301d23c-8c8a-4b70-50c7-08d9092f3957
X-MS-Exchange-CrossTenant-AuthSource: BL0PR12MB4948.namprd12.prod.outlook.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 27 Apr 2021 03:47:48.1106 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: Xbs/0/r9e7GKvXmp31JdAPjp8fESmQdmZ4J7LJooiNC4YSqsH4pv6bz6DOYC3QW/Ih2yBJkQp4jSdQcoQnf4vw==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: MN2PR12MB4405
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QW0gMjAyMS0wNC0yNiB1bSA4OjIzIHAubS4gc2NocmllYiBaZW5nLCBPYWs6Cj4gUmVnYXJkcywK
PiBPYWsgCj4KPiAgCj4KPiDvu79PbiAyMDIxLTA0LTIxLCA5OjMxIFBNLCAiZHJpLWRldmVsIG9u
IGJlaGFsZiBvZiBGZWxpeCBLdWVobGluZyIgPGRyaS1kZXZlbC1ib3VuY2VzQGxpc3RzLmZyZWVk
ZXNrdG9wLm9yZyBvbiBiZWhhbGYgb2YgRmVsaXguS3VlaGxpbmdAYW1kLmNvbT4gd3JvdGU6Cj4K
PiAgICAgRE1BIG1hcCBrZmRfbWVtX2F0dGFjaG1lbnRzIGluIHVwZGF0ZV9ncHV2bV9wdGUuIFRo
aXMgZnVuY3Rpb24gaXMgY2FsbGVkCj4gICAgIHdpdGggdGhlIEJPIGFuZCBwYWdlIHRhYmxlcyBy
ZXNlcnZlZCwgc28gd2UgY2FuIHNhZmVseSB1cGRhdGUgdGhlIERNQQo+ICAgICBtYXBwaW5nLgo+
Cj4gICAgIERNQSB1bm1hcCB3aGVuIGEgQk8gaXMgdW5tYXBwZWQgZnJvbSBhIEdQVSBhbmQgYmVm
b3JlIHVwZGF0aW5nIG1hcHBpbmdzCj4gICAgIGluIHJlc3RvcmUgd29ya2Vycy4KPgo+ICAgICBT
aWduZWQtb2ZmLWJ5OiBGZWxpeCBLdWVobGluZyA8RmVsaXguS3VlaGxpbmdAYW1kLmNvbT4KPiAg
ICAgLS0tCj4gICAgICAuLi4vZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ3B1dm0u
YyAgfCA1NiArKysrKysrKysrLS0tLS0tLS0tCj4gICAgICAxIGZpbGUgY2hhbmdlZCwgMjkgaW5z
ZXJ0aW9ucygrKSwgMjcgZGVsZXRpb25zKC0pCj4KPiAgICAgZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ3B1dm0uYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ3B1dm0uYwo+ICAgICBpbmRleCA0OWQxYWY0YWE1
ZjEuLjdkMjVkODg2Yjk4YyAxMDA2NDQKPiAgICAgLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X2FtZGtmZF9ncHV2bS5jCj4gICAgICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ3B1dm0uYwo+ICAgICBAQCAtOTYxLDExICs5NjEsMTIg
QEAgc3RhdGljIGludCB1bnJlc2VydmVfYm9fYW5kX3ZtcyhzdHJ1Y3QgYm9fdm1fcmVzZXJ2YXRp
b25fY29udGV4dCAqY3R4LAo+ICAgICAgCXJldHVybiByZXQ7Cj4gICAgICB9Cj4KPiAgICAgLXN0
YXRpYyBpbnQgdW5tYXBfYm9fZnJvbV9ncHV2bShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwK
PiAgICAgK3N0YXRpYyB2b2lkIHVubWFwX2JvX2Zyb21fZ3B1dm0oc3RydWN0IGtnZF9tZW0gKm1l
bSwKPiAgICAgIAkJCQlzdHJ1Y3Qga2ZkX21lbV9hdHRhY2htZW50ICplbnRyeSwKPiAgICAgIAkJ
CQlzdHJ1Y3QgYW1kZ3B1X3N5bmMgKnN5bmMpCj4gICAgICB7Cj4gICAgICAJc3RydWN0IGFtZGdw
dV9ib192YSAqYm9fdmEgPSBlbnRyeS0+Ym9fdmE7Cj4gICAgICsJc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYgPSBlbnRyeS0+YWRldjsKPiAgICAgIAlzdHJ1Y3QgYW1kZ3B1X3ZtICp2bSA9IGJv
X3ZhLT5iYXNlLnZtOwo+Cj4gICAgICAJYW1kZ3B1X3ZtX2JvX3VubWFwKGFkZXYsIGJvX3ZhLCBl
bnRyeS0+dmEpOwo+ICAgICBAQCAtOTc0LDE1ICs5NzUsMjAgQEAgc3RhdGljIGludCB1bm1hcF9i
b19mcm9tX2dwdXZtKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAo+Cj4gICAgICAJYW1kZ3B1
X3N5bmNfZmVuY2Uoc3luYywgYm9fdmEtPmxhc3RfcHRfdXBkYXRlKTsKPgo+ICAgICAtCXJldHVy
biAwOwo+ICAgICArCWtmZF9tZW1fZG1hdW5tYXBfYXR0YWNobWVudChtZW0sIGVudHJ5KTsKPiAg
ICAgIH0KPgo+ICAgICAtc3RhdGljIGludCB1cGRhdGVfZ3B1dm1fcHRlKHN0cnVjdCBhbWRncHVf
ZGV2aWNlICphZGV2LAo+ICAgICAtCQlzdHJ1Y3Qga2ZkX21lbV9hdHRhY2htZW50ICplbnRyeSwK
PiAgICAgLQkJc3RydWN0IGFtZGdwdV9zeW5jICpzeW5jKQo+ICAgICArc3RhdGljIGludCB1cGRh
dGVfZ3B1dm1fcHRlKHN0cnVjdCBrZ2RfbWVtICptZW0sCj4gICAgICsJCQkgICAgc3RydWN0IGtm
ZF9tZW1fYXR0YWNobWVudCAqZW50cnksCj4gICAgICsJCQkgICAgc3RydWN0IGFtZGdwdV9zeW5j
ICpzeW5jKQo+ICAgICAgewo+ICAgICAtCWludCByZXQ7Cj4gICAgICAJc3RydWN0IGFtZGdwdV9i
b192YSAqYm9fdmEgPSBlbnRyeS0+Ym9fdmE7Cj4gICAgICsJc3RydWN0IGFtZGdwdV9kZXZpY2Ug
KmFkZXYgPSBlbnRyeS0+YWRldjsKPiAgICAgKwlpbnQgcmV0Owo+ICAgICArCj4gICAgICsJcmV0
ID0ga2ZkX21lbV9kbWFtYXBfYXR0YWNobWVudChtZW0sIGVudHJ5KTsKPiBTaG91bGQgdGhlIGRt
YSBtYXBwaW5nIGJlIGRvbmUgaW4gdGhlIGtmZF9tZW1fYXR0YWNoIGZ1bmN0aW9uIG9uIGEgbWVt
b3J5IG9iamVjdCBpcyBhdHRhY2hlZCB0byBhIHZtIHRoZSBmaXJzdCB0aW1lPyBTaW5jZSBlYWNo
IG1lbW9yeSBvYmplY3QgY2FuIGJlIG1hcHBlZCB0byBtYW55IEdQVSBvciBtYW55IFZNcywgYnkg
ZG9pbmcgZG1hIG1hcHBpbmcgdGhlIGZpcnN0IGl0IGlzIGF0dGFjaGVkIGNhbiBzaW1wbGlmeSB0
aGUgbG9naWNzLiBPciBldmVuIHNpbXBsZXIsIG1heWJlIHdlIGNhbiBqdXN0IGp1c3QgZG1hIG1h
cCB3aGVuIGEgbWVtb3J5IG9iamVjdCBpcyBjcmVhdGVkIC0gaXQgd2FzdGVzIHNvbWUgaW9tbXUg
cGFnZSB0YWJsZSBlbnRyeSBidXQgcmVhbGx5IHNpbXBsaWZ5IHRoZSBsb2dpYyBpbiB0aGlzIHBh
dGNoIHNlcmllcy4gSSBmb3VuZCB0aGlzIHNlcmllcyBpcyBub3QgdmVyeSBlYXN5IHRvIHVuZGVy
c3RhbmQuCgpUaGUgRE1BIG1hcHBpbmcgbXVzdCBiZSB1cGRhdGVkIGV2ZXJ5IHRpbWUgdGhlIHBo
eXNpY2FsIG1lbW9yeQphbGxvY2F0aW9uIGNoYW5nZXMsIGUuZy4gYWZ0ZXIgYSBCTyB3YXMgZXZp
Y3RlZCBhbmQgcmVzdG9yZWQuIEJhc2ljYWxseSwKaWYgdGhlIHBoeXNpY2FsIHBhZ2VzIG9mIHRo
ZSBCTyBjaGFuZ2UsIHdlIG5lZWQgdG8gdXBkYXRlIHRoZSBETUEKbWFwcGluZyB0byBwb2ludCB0
byB0aG9zZSBuZXcgcGFnZXMuIFRoZXJlZm9yZSBJIGFkZGVkIHRoaXMgaW4gdGhlCnVwZGF0ZV9n
cHVfdm1fcHRlIGZ1bmN0aW9uLCB3aGljaCBpcyBjYWxsZWQgYWZ0ZXIgYSBCTyBoYXMgYmVlbgp2
YWxpZGF0ZWQgdGhlIGZpcnN0IHRpbWUsIG9yIHJldmFsaWRhdGVkIGFmdGVyIGFuIGV2aWN0aW9u
LgoKWW91J2xsIGFsc28gc2VlIHRoYXQgSSBjYWxsIGRtYXVubWFwIGluIHRoZSByZS12YWxpZGF0
aW9uIGNhc2VzIChpbiB0aGUKcmVzdG9yZSB3b3JrZXJzIGJlbG93KSB0byBlbnN1cmUgdGhhdCB3
ZSBkb24ndCBsZWFrIERNQSBtYXBwaW5ncy4KClJlZ2FyZHMsCsKgIEZlbGl4CgoKPiAgICAgKwlp
ZiAocmV0KQo+ICAgICArCQlyZXR1cm4gcmV0Owo+Cj4gICAgICAJLyogVXBkYXRlIHRoZSBwYWdl
IHRhYmxlcyAgKi8KPiAgICAgIAlyZXQgPSBhbWRncHVfdm1fYm9fdXBkYXRlKGFkZXYsIGJvX3Zh
LCBmYWxzZSk7Cj4gICAgIEBAIC05OTQsMTQgKzEwMDAsMTUgQEAgc3RhdGljIGludCB1cGRhdGVf
Z3B1dm1fcHRlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAo+ICAgICAgCXJldHVybiBhbWRn
cHVfc3luY19mZW5jZShzeW5jLCBib192YS0+bGFzdF9wdF91cGRhdGUpOwo+ICAgICAgfQo+Cj4g
ICAgIC1zdGF0aWMgaW50IG1hcF9ib190b19ncHV2bShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
diwKPiAgICAgLQkJc3RydWN0IGtmZF9tZW1fYXR0YWNobWVudCAqZW50cnksIHN0cnVjdCBhbWRn
cHVfc3luYyAqc3luYywKPiAgICAgLQkJYm9vbCBub191cGRhdGVfcHRlKQo+ICAgICArc3RhdGlj
IGludCBtYXBfYm9fdG9fZ3B1dm0oc3RydWN0IGtnZF9tZW0gKm1lbSwKPiAgICAgKwkJCSAgIHN0
cnVjdCBrZmRfbWVtX2F0dGFjaG1lbnQgKmVudHJ5LAo+ICAgICArCQkJICAgc3RydWN0IGFtZGdw
dV9zeW5jICpzeW5jLAo+ICAgICArCQkJICAgYm9vbCBub191cGRhdGVfcHRlKQo+ICAgICAgewo+
ICAgICAgCWludCByZXQ7Cj4KPiAgICAgIAkvKiBTZXQgdmlydHVhbCBhZGRyZXNzIGZvciB0aGUg
YWxsb2NhdGlvbiAqLwo+ICAgICAtCXJldCA9IGFtZGdwdV92bV9ib19tYXAoYWRldiwgZW50cnkt
PmJvX3ZhLCBlbnRyeS0+dmEsIDAsCj4gICAgICsJcmV0ID0gYW1kZ3B1X3ZtX2JvX21hcChlbnRy
eS0+YWRldiwgZW50cnktPmJvX3ZhLCBlbnRyeS0+dmEsIDAsCj4gICAgICAJCQkgICAgICAgYW1k
Z3B1X2JvX3NpemUoZW50cnktPmJvX3ZhLT5iYXNlLmJvKSwKPiAgICAgIAkJCSAgICAgICBlbnRy
eS0+cHRlX2ZsYWdzKTsKPiAgICAgIAlpZiAocmV0KSB7Cj4gICAgIEBAIC0xMDEzLDcgKzEwMjAs
NyBAQCBzdGF0aWMgaW50IG1hcF9ib190b19ncHV2bShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
diwKPiAgICAgIAlpZiAobm9fdXBkYXRlX3B0ZSkKPiAgICAgIAkJcmV0dXJuIDA7Cj4KPiAgICAg
LQlyZXQgPSB1cGRhdGVfZ3B1dm1fcHRlKGFkZXYsIGVudHJ5LCBzeW5jKTsKPiAgICAgKwlyZXQg
PSB1cGRhdGVfZ3B1dm1fcHRlKG1lbSwgZW50cnksIHN5bmMpOwo+ICAgICAgCWlmIChyZXQpIHsK
PiAgICAgIAkJcHJfZXJyKCJ1cGRhdGVfZ3B1dm1fcHRlKCkgZmFpbGVkXG4iKTsKPiAgICAgIAkJ
Z290byB1cGRhdGVfZ3B1dm1fcHRlX2ZhaWxlZDsKPiAgICAgQEAgLTEwMjIsNyArMTAyOSw3IEBA
IHN0YXRpYyBpbnQgbWFwX2JvX3RvX2dwdXZtKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAo+
ICAgICAgCXJldHVybiAwOwo+Cj4gICAgICB1cGRhdGVfZ3B1dm1fcHRlX2ZhaWxlZDoKPiAgICAg
LQl1bm1hcF9ib19mcm9tX2dwdXZtKGFkZXYsIGVudHJ5LCBzeW5jKTsKPiAgICAgKwl1bm1hcF9i
b19mcm9tX2dwdXZtKG1lbSwgZW50cnksIHN5bmMpOwo+ICAgICAgCXJldHVybiByZXQ7Cj4gICAg
ICB9Cj4KPiAgICAgQEAgLTE1OTYsNyArMTYwMyw3IEBAIGludCBhbWRncHVfYW1ka2ZkX2dwdXZt
X21hcF9tZW1vcnlfdG9fZ3B1KAo+ICAgICAgCQlwcl9kZWJ1ZygiXHQgbWFwIFZBIDB4JWxseCAt
IDB4JWxseCBpbiBlbnRyeSAlcFxuIiwKPiAgICAgIAkJCSBlbnRyeS0+dmEsIGVudHJ5LT52YSAr
IGJvX3NpemUsIGVudHJ5KTsKPgo+ICAgICAtCQlyZXQgPSBtYXBfYm9fdG9fZ3B1dm0oYWRldiwg
ZW50cnksIGN0eC5zeW5jLAo+ICAgICArCQlyZXQgPSBtYXBfYm9fdG9fZ3B1dm0obWVtLCBlbnRy
eSwgY3R4LnN5bmMsCj4gICAgICAJCQkJICAgICAgaXNfaW52YWxpZF91c2VycHRyKTsKPiAgICAg
IAkJaWYgKHJldCkgewo+ICAgICAgCQkJcHJfZXJyKCJGYWlsZWQgdG8gbWFwIGJvIHRvIGdwdXZt
XG4iKTsKPiAgICAgQEAgLTE2MzUsNyArMTY0Miw2IEBAIGludCBhbWRncHVfYW1ka2ZkX2dwdXZt
X21hcF9tZW1vcnlfdG9fZ3B1KAo+ICAgICAgaW50IGFtZGdwdV9hbWRrZmRfZ3B1dm1fdW5tYXBf
bWVtb3J5X2Zyb21fZ3B1KAo+ICAgICAgCQlzdHJ1Y3Qga2dkX2RldiAqa2dkLCBzdHJ1Y3Qga2dk
X21lbSAqbWVtLCB2b2lkICpkcm1fcHJpdikKPiAgICAgIHsKPiAgICAgLQlzdHJ1Y3QgYW1kZ3B1
X2RldmljZSAqYWRldiA9IGdldF9hbWRncHVfZGV2aWNlKGtnZCk7Cj4gICAgICAJc3RydWN0IGFt
ZGdwdV92bSAqYXZtID0gZHJtX3ByaXZfdG9fdm0oZHJtX3ByaXYpOwo+ICAgICAgCXN0cnVjdCBh
bWRrZmRfcHJvY2Vzc19pbmZvICpwcm9jZXNzX2luZm8gPSBhdm0tPnByb2Nlc3NfaW5mbzsKPiAg
ICAgIAl1bnNpZ25lZCBsb25nIGJvX3NpemUgPSBtZW0tPmJvLT50Ym8uYmFzZS5zaXplOwo+ICAg
ICBAQCAtMTY3MCwxMyArMTY3Niw4IEBAIGludCBhbWRncHVfYW1ka2ZkX2dwdXZtX3VubWFwX21l
bW9yeV9mcm9tX2dwdSgKPiAgICAgIAkJcHJfZGVidWcoIlx0IHVubWFwIFZBIDB4JWxseCAtIDB4
JWxseCBmcm9tIGVudHJ5ICVwXG4iLAo+ICAgICAgCQkJIGVudHJ5LT52YSwgZW50cnktPnZhICsg
Ym9fc2l6ZSwgZW50cnkpOwo+Cj4gICAgIC0JCXJldCA9IHVubWFwX2JvX2Zyb21fZ3B1dm0oYWRl
diwgZW50cnksIGN0eC5zeW5jKTsKPiAgICAgLQkJaWYgKHJldCA9PSAwKSB7Cj4gICAgIC0JCQll
bnRyeS0+aXNfbWFwcGVkID0gZmFsc2U7Cj4gICAgIC0JCX0gZWxzZSB7Cj4gICAgIC0JCQlwcl9l
cnIoImZhaWxlZCB0byB1bm1hcCBWQSAweCVsbHhcbiIsIG1lbS0+dmEpOwo+ICAgICAtCQkJZ290
byB1bnJlc2VydmVfb3V0Owo+ICAgICAtCQl9Cj4gICAgICsJCXVubWFwX2JvX2Zyb21fZ3B1dm0o
bWVtLCBlbnRyeSwgY3R4LnN5bmMpOwo+ICAgICArCQllbnRyeS0+aXNfbWFwcGVkID0gZmFsc2U7
Cj4KPiAgICAgIAkJbWVtLT5tYXBwZWRfdG9fZ3B1X21lbW9yeS0tOwo+ICAgICAgCQlwcl9kZWJ1
ZygiXHQgREVDIG1hcHBpbmcgY291bnQgJWRcbiIsCj4gICAgIEBAIC0yMDUzLDkgKzIwNTQsOCBA
QCBzdGF0aWMgaW50IHZhbGlkYXRlX2ludmFsaWRfdXNlcl9wYWdlcyhzdHJ1Y3QgYW1ka2ZkX3By
b2Nlc3NfaW5mbyAqcHJvY2Vzc19pbmZvKQo+ICAgICAgCQkJaWYgKCFhdHRhY2htZW50LT5pc19t
YXBwZWQpCj4gICAgICAJCQkJY29udGludWU7Cj4KPiAgICAgLQkJCXJldCA9IHVwZGF0ZV9ncHV2
bV9wdGUoKHN0cnVjdCBhbWRncHVfZGV2aWNlICopCj4gICAgIC0JCQkJCSAgICAgICBhdHRhY2ht
ZW50LT5hZGV2LAo+ICAgICAtCQkJCQkgICAgICAgYXR0YWNobWVudCwgJnN5bmMpOwo+ICAgICAr
CQkJa2ZkX21lbV9kbWF1bm1hcF9hdHRhY2htZW50KG1lbSwgYXR0YWNobWVudCk7Cj4gICAgICsJ
CQlyZXQgPSB1cGRhdGVfZ3B1dm1fcHRlKG1lbSwgYXR0YWNobWVudCwgJnN5bmMpOwo+ICAgICAg
CQkJaWYgKHJldCkgewo+ICAgICAgCQkJCXByX2VycigiJXM6IHVwZGF0ZSBQVEUgZmFpbGVkXG4i
LCBfX2Z1bmNfXyk7Cj4gICAgICAJCQkJLyogbWFrZSBzdXJlIHRoaXMgZ2V0cyB2YWxpZGF0ZWQg
YWdhaW4gKi8KPiAgICAgQEAgLTIyNTcsOSArMjI1NywxMSBAQCBpbnQgYW1kZ3B1X2FtZGtmZF9n
cHV2bV9yZXN0b3JlX3Byb2Nlc3NfYm9zKHZvaWQgKmluZm8sIHN0cnVjdCBkbWFfZmVuY2UgKipl
ZikKPiAgICAgIAkJCWdvdG8gdmFsaWRhdGVfbWFwX2ZhaWw7Cj4gICAgICAJCX0KPiAgICAgIAkJ
bGlzdF9mb3JfZWFjaF9lbnRyeShhdHRhY2htZW50LCAmbWVtLT5hdHRhY2htZW50cywgbGlzdCkg
ewo+ICAgICAtCQkJcmV0ID0gdXBkYXRlX2dwdXZtX3B0ZSgoc3RydWN0IGFtZGdwdV9kZXZpY2Ug
KikKPiAgICAgLQkJCQkJICAgICAgYXR0YWNobWVudC0+YWRldiwgYXR0YWNobWVudCwKPiAgICAg
LQkJCQkJICAgICAgJnN5bmNfb2JqKTsKPiAgICAgKwkJCWlmICghYXR0YWNobWVudC0+aXNfbWFw
cGVkKQo+ICAgICArCQkJCWNvbnRpbnVlOwo+ICAgICArCj4gICAgICsJCQlrZmRfbWVtX2RtYXVu
bWFwX2F0dGFjaG1lbnQobWVtLCBhdHRhY2htZW50KTsKPiAgICAgKwkJCXJldCA9IHVwZGF0ZV9n
cHV2bV9wdGUobWVtLCBhdHRhY2htZW50LCAmc3luY19vYmopOwo+ICAgICAgCQkJaWYgKHJldCkg
ewo+ICAgICAgCQkJCXByX2RlYnVnKCJNZW1vcnkgZXZpY3Rpb246IHVwZGF0ZSBQVEUgZmFpbGVk
LiBUcnkgYWdhaW5cbiIpOwo+ICAgICAgCQkJCWdvdG8gdmFsaWRhdGVfbWFwX2ZhaWw7Cj4gICAg
IC0tIAo+ICAgICAyLjMxLjEKPgo+ICAgICBfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fXwo+ICAgICBkcmktZGV2ZWwgbWFpbGluZyBsaXN0Cj4gICAgIGRyaS1k
ZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKPiAgICAgaHR0cHM6Ly9saXN0cy5mcmVlZGVza3Rv
cC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWwKPgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZl
bEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFp
bG1hbi9saXN0aW5mby9kcmktZGV2ZWwK
