Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id E6E539D2A3
	for <lists+dri-devel@lfdr.de>; Mon, 26 Aug 2019 17:27:01 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 468506E225;
	Mon, 26 Aug 2019 15:26:59 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from bhuna.collabora.co.uk (bhuna.collabora.co.uk [46.235.227.227])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E26D06E225
 for <dri-devel@lists.freedesktop.org>; Mon, 26 Aug 2019 15:26:56 +0000 (UTC)
Received: from localhost.localdomain (unknown
 [IPv6:2a01:e0a:2c:6930:5cf4:84a1:2763:fe0d])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested) (Authenticated sender: bbrezillon)
 by bhuna.collabora.co.uk (Postfix) with ESMTPSA id 30D1228BD41;
 Mon, 26 Aug 2019 16:26:55 +0100 (BST)
From: Boris Brezillon <boris.brezillon@collabora.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v2 03/21] drm/vc4: Implement bridge_funcs instead of
 encoder_helper_funcs
Date: Mon, 26 Aug 2019 17:26:31 +0200
Message-Id: <20190826152649.13820-4-boris.brezillon@collabora.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190826152649.13820-1-boris.brezillon@collabora.com>
References: <20190826152649.13820-1-boris.brezillon@collabora.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Nikita Yushchenko <nikita.yoush@cogentembedded.com>,
 Jernej Skrabec <jernej.skrabec@siol.net>,
 Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
 Neil Armstrong <narmstrong@baylibre.com>,
 Andrey Smirnov <andrew.smirnov@gmail.com>, Jonas Karlman <jonas@kwiboo.se>,
 Seung-Woo Kim <sw0312.kim@samsung.com>,
 Kyungmin Park <kyungmin.park@samsung.com>,
 Thierry Reding <thierry.reding@gmail.com>, Chris Healy <Chris.Healy@zii.aero>,
 Boris Brezillon <boris.brezillon@collabora.com>, kernel@collabora.com,
 Sam Ravnborg <sam@ravnborg.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhvc2UgaG9va3MgYXJlIGNhbGxlZCBleGFjdGx5IGF0IHRoZSBzYW1lIHRpbWUgZXhjZXB0IHRo
ZSBicmlkZ2UKZnVuY3MgaGF2ZSBwcmVfZW5hYmxlKCkvcG9zdF9kaXNhYmxlKCkgaG9va3Mgd2hp
Y2ggYWxsb3dzIHVzIHRvIGdldApyaWQgb2YgdGhlIGhhY2sgcmVzZXR0aW5nIGVuY29kZXItPmJy
aWRnZS5uZXh0ICh3YXMgbmVlZGVkIHRvIGNvbnRyb2wKdGhlIGVuY29kZXIvYnJpZGdlIGVuYWJs
ZS9kaXNhYmxlIHNlcXVlbmNlKS4KCldlIGNhbiBhbHNvIGdldCBvZiB0aGUgZHNpLT5icmlkZ2Ug
ZmllbGQgc2luY2UgdGhlIGJyaWRnZSBwb2ludGVyIGlzCmF2YWlsYWJsZSBpbiBlbmNvZGVyLT5i
cmlkZ2UubmV4dC4KClNpZ25lZC1vZmYtYnk6IEJvcmlzIEJyZXppbGxvbiA8Ym9yaXMuYnJlemls
bG9uQGNvbGxhYm9yYS5jb20+Ci0tLQpDaGFuZ2VzIGluIHYyOgoqIE5ldyBwYXRjaCAocmVwbGFj
ZXMgImRybS92YzQ6IEdldCByaWQgb2YgdGhlIGRzaS0+YnJpZGdlIGZpZWxkIikKLS0tCiBkcml2
ZXJzL2dwdS9kcm0vdmM0L3ZjNF9kc2kuYyB8IDcwICsrKysrKysrKysrKysrKysrKystLS0tLS0t
LS0tLS0tLS0tCiAxIGZpbGUgY2hhbmdlZCwgMzkgaW5zZXJ0aW9ucygrKSwgMzEgZGVsZXRpb25z
KC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZjNC92YzRfZHNpLmMgYi9kcml2ZXJz
L2dwdS9kcm0vdmM0L3ZjNF9kc2kuYwppbmRleCBlNjRiNjZiMWVmY2QuLjRhYTRjMWE5NGYxNyAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3ZjNC92YzRfZHNpLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL3ZjNC92YzRfZHNpLmMKQEAgLTQ5OCw3ICs0OTgsNiBAQCBzdHJ1Y3QgdmM0X2RzaSB7
CiAKIAlzdHJ1Y3QgbWlwaV9kc2lfaG9zdCBkc2lfaG9zdDsKIAlzdHJ1Y3QgZHJtX2VuY29kZXIg
KmVuY29kZXI7Ci0Jc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZTsKIAogCXZvaWQgX19pb21lbSAq
cmVnczsKIApAQCAtNzQ3LDE2ICs3NDYsMTMgQEAgZHNpX2VzY190aW1pbmcodTMyIG5zKQogCXJl
dHVybiBESVZfUk9VTkRfVVAobnMsIEVTQ19USU1FX05TKTsKIH0KIAotc3RhdGljIHZvaWQgdmM0
X2RzaV9lbmNvZGVyX2Rpc2FibGUoc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyKQorc3RhdGlj
IHZvaWQgdmM0X2RzaV9icmlkZ2VfcG9zdF9kaXNhYmxlKHN0cnVjdCBkcm1fYnJpZGdlICpicmlk
Z2UpCiB7CisJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyID0gYnJpZGdlX3RvX2VuY29kZXIo
YnJpZGdlKTsKIAlzdHJ1Y3QgdmM0X2RzaV9lbmNvZGVyICp2YzRfZW5jb2RlciA9IHRvX3ZjNF9k
c2lfZW5jb2RlcihlbmNvZGVyKTsKIAlzdHJ1Y3QgdmM0X2RzaSAqZHNpID0gdmM0X2VuY29kZXIt
PmRzaTsKIAlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmZHNpLT5wZGV2LT5kZXY7CiAKLQlkcm1fYnJp
ZGdlX2Rpc2FibGUoZHNpLT5icmlkZ2UpOwotCXZjNF9kc2lfdWxwcyhkc2ksIHRydWUpOwotCWRy
bV9icmlkZ2VfcG9zdF9kaXNhYmxlKGRzaS0+YnJpZGdlKTsKLQogCWNsa19kaXNhYmxlX3VucHJl
cGFyZShkc2ktPnBsbF9waHlfY2xvY2spOwogCWNsa19kaXNhYmxlX3VucHJlcGFyZShkc2ktPmVz
Y2FwZV9jbG9jayk7CiAJY2xrX2Rpc2FibGVfdW5wcmVwYXJlKGRzaS0+cGl4ZWxfY2xvY2spOwpA
QCAtNzY0LDYgKzc2MCwxNSBAQCBzdGF0aWMgdm9pZCB2YzRfZHNpX2VuY29kZXJfZGlzYWJsZShz
dHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIpCiAJcG1fcnVudGltZV9wdXQoZGV2KTsKIH0KIAor
c3RhdGljIHZvaWQgdmM0X2RzaV9icmlkZ2VfZGlzYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJp
ZGdlKQoreworCXN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlciA9IGJyaWRnZV90b19lbmNvZGVy
KGJyaWRnZSk7CisJc3RydWN0IHZjNF9kc2lfZW5jb2RlciAqdmM0X2VuY29kZXIgPSB0b192YzRf
ZHNpX2VuY29kZXIoZW5jb2Rlcik7CisJc3RydWN0IHZjNF9kc2kgKmRzaSA9IHZjNF9lbmNvZGVy
LT5kc2k7CisKKwl2YzRfZHNpX3VscHMoZHNpLCB0cnVlKTsKK30KKwogLyogRXh0ZW5kcyB0aGUg
bW9kZSdzIGJsYW5rIGludGVydmFscyB0byBoYW5kbGUgQkNNMjgzNSdzIGludGVnZXItb25seQog
ICogRFNJIFBMTCBkaXZpZGVyLgogICoKQEAgLTc3NywxMCArNzgyLDExIEBAIHN0YXRpYyB2b2lk
IHZjNF9kc2lfZW5jb2Rlcl9kaXNhYmxlKHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcikKICAq
IGhpZ2hlci10aGFuLWV4cGVjdGVkIGNsb2NrIHJhdGUgdG8gdGhlIHBhbmVsLCBidXQgdGhhdCdz
IHdoYXQgdGhlCiAgKiBmaXJtd2FyZSBkb2VzIHRvby4KICAqLwotc3RhdGljIGJvb2wgdmM0X2Rz
aV9lbmNvZGVyX21vZGVfZml4dXAoc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyLAotCQkJCSAg
ICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSwKLQkJCQkgICAgICAgc3Ry
dWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUpCitzdGF0aWMgYm9vbCB2YzRfZHNp
X2JyaWRnZV9tb2RlX2ZpeHVwKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UsCisJCQkJICAgICAg
Y29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUsCisJCQkJICAgICAgc3RydWN0IGRy
bV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUpCiB7CisJc3RydWN0IGRybV9lbmNvZGVyICpl
bmNvZGVyID0gYnJpZGdlX3RvX2VuY29kZXIoYnJpZGdlKTsKIAlzdHJ1Y3QgdmM0X2RzaV9lbmNv
ZGVyICp2YzRfZW5jb2RlciA9IHRvX3ZjNF9kc2lfZW5jb2RlcihlbmNvZGVyKTsKIAlzdHJ1Y3Qg
dmM0X2RzaSAqZHNpID0gdmM0X2VuY29kZXItPmRzaTsKIAlzdHJ1Y3QgY2xrICpwaHlfcGFyZW50
ID0gY2xrX2dldF9wYXJlbnQoZHNpLT5wbGxfcGh5X2Nsb2NrKTsKQEAgLTgxNiw4ICs4MjIsOSBA
QCBzdGF0aWMgYm9vbCB2YzRfZHNpX2VuY29kZXJfbW9kZV9maXh1cChzdHJ1Y3QgZHJtX2VuY29k
ZXIgKmVuY29kZXIsCiAJcmV0dXJuIHRydWU7CiB9CiAKLXN0YXRpYyB2b2lkIHZjNF9kc2lfZW5j
b2Rlcl9lbmFibGUoc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyKQorc3RhdGljIHZvaWQgdmM0
X2RzaV9icmlkZ2VfcHJlX2VuYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQogeworCXN0
cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlciA9IGJyaWRnZV90b19lbmNvZGVyKGJyaWRnZSk7CiAJ
c3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUgPSAmZW5jb2Rlci0+Y3J0Yy0+c3RhdGUtPmFk
anVzdGVkX21vZGU7CiAJc3RydWN0IHZjNF9kc2lfZW5jb2RlciAqdmM0X2VuY29kZXIgPSB0b192
YzRfZHNpX2VuY29kZXIoZW5jb2Rlcik7CiAJc3RydWN0IHZjNF9kc2kgKmRzaSA9IHZjNF9lbmNv
ZGVyLT5kc2k7CkBAIC0xMDU0LDggKzEwNjEsMTQgQEAgc3RhdGljIHZvaWQgdmM0X2RzaV9lbmNv
ZGVyX2VuYWJsZShzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIpCiAJfQogCiAJdmM0X2RzaV91
bHBzKGRzaSwgZmFsc2UpOworfQogCi0JZHJtX2JyaWRnZV9wcmVfZW5hYmxlKGRzaS0+YnJpZGdl
KTsKK3N0YXRpYyB2b2lkIHZjNF9kc2lfYnJpZGdlX2VuYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAq
YnJpZGdlKQoreworCXN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlciA9IGJyaWRnZV90b19lbmNv
ZGVyKGJyaWRnZSk7CisJc3RydWN0IHZjNF9kc2lfZW5jb2RlciAqdmM0X2VuY29kZXIgPSB0b192
YzRfZHNpX2VuY29kZXIoZW5jb2Rlcik7CisJc3RydWN0IHZjNF9kc2kgKmRzaSA9IHZjNF9lbmNv
ZGVyLT5kc2k7CisJYm9vbCBkZWJ1Z19kdW1wX3JlZ3MgPSBmYWxzZTsKIAogCWlmIChkc2ktPm1v
ZGVfZmxhZ3MgJiBNSVBJX0RTSV9NT0RFX1ZJREVPKSB7CiAJCURTSV9QT1JUX1dSSVRFKERJU1Aw
X0NUUkwsCkBAIC0xMDcyLDggKzEwODUsNiBAQCBzdGF0aWMgdm9pZCB2YzRfZHNpX2VuY29kZXJf
ZW5hYmxlKHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcikKIAkJCSAgICAgICBEU0lfRElTUDBf
RU5BQkxFKTsKIAl9CiAKLQlkcm1fYnJpZGdlX2VuYWJsZShkc2ktPmJyaWRnZSk7Ci0KIAlpZiAo
ZGVidWdfZHVtcF9yZWdzKSB7CiAJCXN0cnVjdCBkcm1fcHJpbnRlciBwID0gZHJtX2luZm9fcHJp
bnRlcigmZHNpLT5wZGV2LT5kZXYpOwogCQlkZXZfaW5mbygmZHNpLT5wZGV2LT5kZXYsICJEU0kg
cmVncyBhZnRlcjpcbiIpOwpAQCAtMTI5MCwxMCArMTMwMSwxMiBAQCBzdGF0aWMgY29uc3Qgc3Ry
dWN0IG1pcGlfZHNpX2hvc3Rfb3BzIHZjNF9kc2lfaG9zdF9vcHMgPSB7CiAJLnRyYW5zZmVyID0g
dmM0X2RzaV9ob3N0X3RyYW5zZmVyLAogfTsKIAotc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZW5j
b2Rlcl9oZWxwZXJfZnVuY3MgdmM0X2RzaV9lbmNvZGVyX2hlbHBlcl9mdW5jcyA9IHsKLQkuZGlz
YWJsZSA9IHZjNF9kc2lfZW5jb2Rlcl9kaXNhYmxlLAotCS5lbmFibGUgPSB2YzRfZHNpX2VuY29k
ZXJfZW5hYmxlLAotCS5tb2RlX2ZpeHVwID0gdmM0X2RzaV9lbmNvZGVyX21vZGVfZml4dXAsCitz
dGF0aWMgY29uc3Qgc3RydWN0IGRybV9icmlkZ2VfZnVuY3MgdmM0X2RzaV9icmlkZ2VfZnVuY3Mg
PSB7CisJLnByZV9lbmFibGUgPSB2YzRfZHNpX2JyaWRnZV9wcmVfZW5hYmxlLAorCS5lbmFibGUg
PSB2YzRfZHNpX2JyaWRnZV9lbmFibGUsCisJLmRpc2FibGUgPSB2YzRfZHNpX2JyaWRnZV9kaXNh
YmxlLAorCS5wb3N0X2Rpc2FibGUgPSB2YzRfZHNpX2JyaWRnZV9wb3N0X2Rpc2FibGUsCisJLm1v
ZGVfZml4dXAgPSB2YzRfZHNpX2JyaWRnZV9tb2RlX2ZpeHVwLAogfTsKIAogc3RhdGljIGNvbnN0
IHN0cnVjdCBvZl9kZXZpY2VfaWQgdmM0X2RzaV9kdF9tYXRjaFtdID0gewpAQCAtMTQ0NSw2ICsx
NDU4LDcgQEAgc3RhdGljIGludCB2YzRfZHNpX2JpbmQoc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1
Y3QgZGV2aWNlICptYXN0ZXIsIHZvaWQgKmRhdGEpCiAJc3RydWN0IHZjNF9kZXYgKnZjNCA9IHRv
X3ZjNF9kZXYoZHJtKTsKIAlzdHJ1Y3QgdmM0X2RzaSAqZHNpID0gZGV2X2dldF9kcnZkYXRhKGRl
dik7CiAJc3RydWN0IHZjNF9kc2lfZW5jb2RlciAqdmM0X2RzaV9lbmNvZGVyOworCXN0cnVjdCBk
cm1fYnJpZGdlICpicmlkZ2U7CiAJc3RydWN0IGRybV9wYW5lbCAqcGFuZWw7CiAJY29uc3Qgc3Ry
dWN0IG9mX2RldmljZV9pZCAqbWF0Y2g7CiAJZG1hX2NhcF9tYXNrX3QgZG1hX21hc2s7CkBAIC0x
NTYxLDcgKzE1NzUsNyBAQCBzdGF0aWMgaW50IHZjNF9kc2lfYmluZChzdHJ1Y3QgZGV2aWNlICpk
ZXYsIHN0cnVjdCBkZXZpY2UgKm1hc3Rlciwgdm9pZCAqZGF0YSkKIAl9CiAKIAlyZXQgPSBkcm1f
b2ZfZmluZF9wYW5lbF9vcl9icmlkZ2UoZGV2LT5vZl9ub2RlLCAwLCAwLAotCQkJCQkgICZwYW5l
bCwgJmRzaS0+YnJpZGdlKTsKKwkJCQkJICAmcGFuZWwsICZicmlkZ2UpOwogCWlmIChyZXQpIHsK
IAkJLyogSWYgdGhlIGJyaWRnZSBvciBwYW5lbCBwb2ludGVkIGJ5IGRldi0+b2Zfbm9kZSBpcyBu
b3QKIAkJICogZW5hYmxlZCwganVzdCByZXR1cm4gMCBoZXJlIHNvIHRoYXQgd2UgZG9uJ3QgcHJl
dmVudCB0aGUgRFJNCkBAIC0xNTc2LDEwICsxNTkwLDEwIEBAIHN0YXRpYyBpbnQgdmM0X2RzaV9i
aW5kKHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRldmljZSAqbWFzdGVyLCB2b2lkICpkYXRh
KQogCX0KIAogCWlmIChwYW5lbCkgewotCQlkc2ktPmJyaWRnZSA9IGRldm1fZHJtX3BhbmVsX2Jy
aWRnZV9hZGQoZGV2LCBwYW5lbCwKLQkJCQkJCQlEUk1fTU9ERV9DT05ORUNUT1JfRFNJKTsKLQkJ
aWYgKElTX0VSUihkc2ktPmJyaWRnZSkpCi0JCQlyZXR1cm4gUFRSX0VSUihkc2ktPmJyaWRnZSk7
CisJCWJyaWRnZSA9IGRldm1fZHJtX3BhbmVsX2JyaWRnZV9hZGQoZGV2LCBwYW5lbCwKKwkJCQkJ
CSAgIERSTV9NT0RFX0NPTk5FQ1RPUl9EU0kpOworCQlpZiAoSVNfRVJSKGJyaWRnZSkpCisJCQly
ZXR1cm4gUFRSX0VSUihicmlkZ2UpOwogCX0KIAogCS8qIFRoZSBlc2MgY2xvY2sgcmF0ZSBpcyBz
dXBwb3NlZCB0byBhbHdheXMgYmUgMTAwTWh6LiAqLwpAQCAtMTU5NiwyMSArMTYxMCwxNSBAQCBz
dGF0aWMgaW50IHZjNF9kc2lfYmluZChzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBkZXZpY2Ug
Km1hc3Rlciwgdm9pZCAqZGF0YSkKIAlpZiAoZHNpLT5wb3J0ID09IDEpCiAJCXZjNC0+ZHNpMSA9
IGRzaTsKIAorCWRzaS0+ZW5jb2Rlci0+YnJpZGdlLmZ1bmNzID0gJnZjNF9kc2lfYnJpZGdlX2Z1
bmNzOwogCWRybV9lbmNvZGVyX2luaXQoZHJtLCBkc2ktPmVuY29kZXIsICZ2YzRfZHNpX2VuY29k
ZXJfZnVuY3MsCiAJCQkgRFJNX01PREVfRU5DT0RFUl9EU0ksIE5VTEwpOwotCWRybV9lbmNvZGVy
X2hlbHBlcl9hZGQoZHNpLT5lbmNvZGVyLCAmdmM0X2RzaV9lbmNvZGVyX2hlbHBlcl9mdW5jcyk7
CiAKLQlyZXQgPSBkcm1fYnJpZGdlX2F0dGFjaChkc2ktPmVuY29kZXIsIGRzaS0+YnJpZGdlLCBO
VUxMKTsKKwlyZXQgPSBkcm1fYnJpZGdlX2F0dGFjaChkc2ktPmVuY29kZXIsIGJyaWRnZSwgTlVM
TCk7CiAJaWYgKHJldCkgewogCQlkZXZfZXJyKGRldiwgImJyaWRnZSBhdHRhY2ggZmFpbGVkOiAl
ZFxuIiwgcmV0KTsKIAkJcmV0dXJuIHJldDsKIAl9Ci0JLyogRGlzYWJsZSB0aGUgYXRvbWljIGhl
bHBlciBjYWxscyBpbnRvIHRoZSBicmlkZ2UuICBXZQotCSAqIG1hbnVhbGx5IGNhbGwgdGhlIGJy
aWRnZSBwcmVfZW5hYmxlIC8gZW5hYmxlIC8gZXRjLiBjYWxscwotCSAqIGZyb20gb3VyIGRyaXZl
ciwgc2luY2Ugd2UgbmVlZCB0byBzZXF1ZW5jZSB0aGVtIHdpdGhpbiB0aGUKLQkgKiBlbmNvZGVy
J3MgZW5hYmxlL2Rpc2FibGUgcGF0aHMuCi0JICovCi0JZHNpLT5lbmNvZGVyLT5icmlkZ2UubmV4
dCA9IE5VTEw7CiAKIAlpZiAoZHNpLT5wb3J0ID09IDApCiAJCXZjNF9kZWJ1Z2ZzX2FkZF9yZWdz
ZXQzMihkcm0sICJkc2kwX3JlZ3MiLCAmZHNpLT5yZWdzZXQpOwpAQCAtMTYyOSw3ICsxNjM3LDcg
QEAgc3RhdGljIHZvaWQgdmM0X2RzaV91bmJpbmQoc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1Y3Qg
ZGV2aWNlICptYXN0ZXIsCiAJc3RydWN0IHZjNF9kZXYgKnZjNCA9IHRvX3ZjNF9kZXYoZHJtKTsK
IAlzdHJ1Y3QgdmM0X2RzaSAqZHNpID0gZGV2X2dldF9kcnZkYXRhKGRldik7CiAKLQlpZiAoZHNp
LT5icmlkZ2UpCisJaWYgKGRzaS0+ZW5jb2Rlci0+YnJpZGdlLm5leHQpCiAJCXBtX3J1bnRpbWVf
ZGlzYWJsZShkZXYpOwogCiAJdmM0X2RzaV9lbmNvZGVyX2Rlc3Ryb3koZHNpLT5lbmNvZGVyKTsK
LS0gCjIuMjEuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
Cmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
