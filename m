Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 7EF659E509
	for <lists+dri-devel@lfdr.de>; Tue, 27 Aug 2019 11:58:41 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6285C89686;
	Tue, 27 Aug 2019 09:58:39 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-wr1-x443.google.com (mail-wr1-x443.google.com
 [IPv6:2a00:1450:4864:20::443])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 56C8589664
 for <dri-devel@lists.freedesktop.org>; Tue, 27 Aug 2019 09:58:30 +0000 (UTC)
Received: by mail-wr1-x443.google.com with SMTP id y8so18120167wrn.10
 for <dri-devel@lists.freedesktop.org>; Tue, 27 Aug 2019 02:58:30 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=e3MX6dJTEQsQ89HsRB1zdZlcheUaoM7pF8lBBmIX570=;
 b=qbWKSP6jMqnPqqrDiWWu8SvFYAt3i6A/maa2UcqoqbnUtZBixWigdjkA08iFhc+Bq9
 SsAdXooKmh4s8YeuYcJzRlsXosQiwhpzoxNsMEX90xCgAdGLYx9cJXbkhZph03QhATZ9
 x8H8gKY3QdZ6xXoQcOERChwpL52nHuHN0Aq3VPm0JhB9RX79mbNTz0lzDkYVlcQUSNyl
 CGRkVEWHPmps9b9BDUvxJ9yaEvJZaaYM2MbjgESfBt38pB/reGe42viMKTgNlvbblzBg
 jl8dR8pFNbwiykKPHLY5b9OSY1Dvulo0FAri6ItIVCy+wQzHpeoKAxcFMOLc/6GMsaB6
 f/Pw==
X-Gm-Message-State: APjAAAWtPsLzSI6JHNdU+DhYXGcQ+o4PVqGbyUXfpOZVPbCD4R7UyKj5
 QkNaDjvmEkl3Xczn/3X2ZCXb/vqkKaBV3w==
X-Google-Smtp-Source: APXvYqy4ZYB2/q/DqDVQb0WL+EPpli8OSFxCaqbkjlDMpmc/cnWWUqiSdxK0DJT+0XlCte2VBKjc4Q==
X-Received: by 2002:a5d:66c8:: with SMTP id k8mr28230101wrw.7.1566899908606;
 Tue, 27 Aug 2019 02:58:28 -0700 (PDT)
Received: from bender.baylibre.local
 (lmontsouris-657-1-212-31.w90-63.abo.wanadoo.fr. [90.63.244.31])
 by smtp.gmail.com with ESMTPSA id m6sm10862084wrq.95.2019.08.27.02.58.27
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 27 Aug 2019 02:58:28 -0700 (PDT)
From: Neil Armstrong <narmstrong@baylibre.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 1/2] drm/meson: dw_hdmi: add resume/suspend hooks
Date: Tue, 27 Aug 2019 11:58:24 +0200
Message-Id: <20190827095825.21015-2-narmstrong@baylibre.com>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20190827095825.21015-1-narmstrong@baylibre.com>
References: <20190827095825.21015-1-narmstrong@baylibre.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=baylibre-com.20150623.gappssmtp.com; s=20150623;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=e3MX6dJTEQsQ89HsRB1zdZlcheUaoM7pF8lBBmIX570=;
 b=Ugl/8zrolmxov83L5GM9xV8mmhNk/xvoT9Qx80voxCM0e8fyHjKUfK9EPT9dzOC14H
 hDRkEM8GqCtOPBom0oTAthFAT/kEh2l/myItSPKeMeNTkl/qfNLQ/lIvkyxw4YvUBcom
 LaMQoNUJEJ+bdvvurb05C58eDEp2KNhjg9m46jQoNSAYu+zFKVgBhKQHPKp1+fSHpp9P
 7obFgm0tdMoEyEKKO10dgDvTaWnz2rUrvbU0EDVHVaNwJoLLfSHFCwM/dvDk113dUAP7
 Q5czgoZ3XfZXqGwFrWn/2hJjvjMMeYoj7TgAu5ru27WSD46DDJpRCHBZ2Pbsd2BIlHhK
 nJtA==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: khilman@baylibre.com, Neil Armstrong <narmstrong@baylibre.com>,
 linux-kernel@vger.kernel.org, linux-arm-kernel@lists.infradead.org,
 linux-amlogic@lists.infradead.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIHRoZSBzdXNwZW5zIGFuZCByZXN1bWUgaG9va3MgdG86Ci0gcmVzZXQgdGhlIHdob2xlIEhE
TUkgZ2x1ZSBhbmQgSERNSSBjb250cm9sbGVyIG9uIHN1c3BlbmQKLSByZS1pbml0IHRoZSBIRE1J
IGdsdWUgYW5kIEhETUkgY29udHJvbGxlciBvbiByZXN1bWUKClRoZSBIRE1JIGdsdWUgaW5pdCBp
cyByZWZhY3RvcmVkIHRvIGJlIHJlLXVzZWQgZnJvbSB0aGUgcmVzdW1lIGhvb2suCgpJdCBtYWtl
cyB1c2FnZSBvZiBkd19oZG1pX3Jlc3VtZSgpIHRvIHJlY292ZXIgYSBmdW5jdGlvbm5hbCBEREMg
YnVzLgoKU2lnbmVkLW9mZi1ieTogTmVpbCBBcm1zdHJvbmcgPG5hcm1zdHJvbmdAYmF5bGlicmUu
Y29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9tZXNvbi9tZXNvbl9kd19oZG1pLmMgfCAxMTAgKysr
KysrKysrKysrKysrKysrLS0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA3NiBpbnNlcnRpb25zKCsp
LCAzNCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbWVzb24vbWVz
b25fZHdfaGRtaS5jIGIvZHJpdmVycy9ncHUvZHJtL21lc29uL21lc29uX2R3X2hkbWkuYwppbmRl
eCBkZjNmOWRkZDIyMzQuLmE3MjJkZGJmYmVkZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L21lc29uL21lc29uX2R3X2hkbWkuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbWVzb24vbWVzb25f
ZHdfaGRtaS5jCkBAIC03OTksNiArNzk5LDQ3IEBAIHN0YXRpYyBib29sIG1lc29uX2hkbWlfY29u
bmVjdG9yX2lzX2F2YWlsYWJsZShzdHJ1Y3QgZGV2aWNlICpkZXYpCiAJcmV0dXJuIGZhbHNlOwog
fQogCitzdGF0aWMgdm9pZCBtZXNvbl9kd19oZG1pX2luaXQoc3RydWN0IG1lc29uX2R3X2hkbWkg
Km1lc29uX2R3X2hkbWkpCit7CisJc3RydWN0IG1lc29uX2RybSAqcHJpdiA9IG1lc29uX2R3X2hk
bWktPnByaXY7CisKKwkvKiBFbmFibGUgY2xvY2tzICovCisJcmVnbWFwX3VwZGF0ZV9iaXRzKHBy
aXYtPmhoaSwgSEhJX0hETUlfQ0xLX0NOVEwsIDB4ZmZmZiwgMHgxMDApOworCisJLyogQnJpbmcg
SERNSVRYIE1FTSBvdXRwdXQgb2YgcG93ZXIgZG93biAqLworCXJlZ21hcF91cGRhdGVfYml0cyhw
cml2LT5oaGksIEhISV9NRU1fUERfUkVHMCwgMHhmZiA8PCA4LCAwKTsKKworCS8qIFJlc2V0IEhE
TUlUWCBBUEIgJiBUWCAmIFBIWSAqLworCXJlc2V0X2NvbnRyb2xfcmVzZXQobWVzb25fZHdfaGRt
aS0+aGRtaXR4X2FwYik7CisJcmVzZXRfY29udHJvbF9yZXNldChtZXNvbl9kd19oZG1pLT5oZG1p
dHhfY3RybCk7CisJcmVzZXRfY29udHJvbF9yZXNldChtZXNvbl9kd19oZG1pLT5oZG1pdHhfcGh5
KTsKKworCS8qIEVuYWJsZSBBUEIzIGZhaWwgb24gZXJyb3IgKi8KKwlpZiAoIW1lc29uX3ZwdV9p
c19jb21wYXRpYmxlKHByaXYsICJhbWxvZ2ljLG1lc29uLWcxMmEtdnB1IikpIHsKKwkJd3JpdGVs
X2JpdHNfcmVsYXhlZChCSVQoMTUpLCBCSVQoMTUpLAorCQkJCSAgICBtZXNvbl9kd19oZG1pLT5o
ZG1pdHggKyBIRE1JVFhfVE9QX0NUUkxfUkVHKTsKKwkJd3JpdGVsX2JpdHNfcmVsYXhlZChCSVQo
MTUpLCBCSVQoMTUpLAorCQkJCSAgICBtZXNvbl9kd19oZG1pLT5oZG1pdHggKyBIRE1JVFhfRFdD
X0NUUkxfUkVHKTsKKwl9CisKKwkvKiBCcmluZyBvdXQgb2YgcmVzZXQgKi8KKwltZXNvbl9kd19o
ZG1pLT5kYXRhLT50b3Bfd3JpdGUobWVzb25fZHdfaGRtaSwKKwkJCQkgICAgICAgSERNSVRYX1RP
UF9TV19SRVNFVCwgIDApOworCisJbXNsZWVwKDIwKTsKKworCW1lc29uX2R3X2hkbWktPmRhdGEt
PnRvcF93cml0ZShtZXNvbl9kd19oZG1pLAorCQkJCSAgICAgICBIRE1JVFhfVE9QX0NMS19DTlRM
LCAweGZmKTsKKworCS8qIEVuYWJsZSBIRE1JLVRYIEludGVycnVwdCAqLworCW1lc29uX2R3X2hk
bWktPmRhdGEtPnRvcF93cml0ZShtZXNvbl9kd19oZG1pLCBIRE1JVFhfVE9QX0lOVFJfU1RBVF9D
TFIsCisJCQkJICAgICAgIEhETUlUWF9UT1BfSU5UUl9DT1JFKTsKKworCW1lc29uX2R3X2hkbWkt
PmRhdGEtPnRvcF93cml0ZShtZXNvbl9kd19oZG1pLCBIRE1JVFhfVE9QX0lOVFJfTUFTS04sCisJ
CQkJICAgICAgIEhETUlUWF9UT1BfSU5UUl9DT1JFKTsKKworfQorCiBzdGF0aWMgaW50IG1lc29u
X2R3X2hkbWlfYmluZChzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBkZXZpY2UgKm1hc3RlciwK
IAkJCQl2b2lkICpkYXRhKQogewpAQCAtOTIyLDQwICs5NjMsNyBAQCBzdGF0aWMgaW50IG1lc29u
X2R3X2hkbWlfYmluZChzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBkZXZpY2UgKm1hc3RlciwK
IAogCURSTV9ERUJVR19EUklWRVIoImVuY29kZXIgaW5pdGlhbGl6ZWRcbiIpOwogCi0JLyogRW5h
YmxlIGNsb2NrcyAqLwotCXJlZ21hcF91cGRhdGVfYml0cyhwcml2LT5oaGksIEhISV9IRE1JX0NM
S19DTlRMLCAweGZmZmYsIDB4MTAwKTsKLQotCS8qIEJyaW5nIEhETUlUWCBNRU0gb3V0cHV0IG9m
IHBvd2VyIGRvd24gKi8KLQlyZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+aGhpLCBISElfTUVNX1BE
X1JFRzAsIDB4ZmYgPDwgOCwgMCk7Ci0KLQkvKiBSZXNldCBIRE1JVFggQVBCICYgVFggJiBQSFkg
Ki8KLQlyZXNldF9jb250cm9sX3Jlc2V0KG1lc29uX2R3X2hkbWktPmhkbWl0eF9hcGIpOwotCXJl
c2V0X2NvbnRyb2xfcmVzZXQobWVzb25fZHdfaGRtaS0+aGRtaXR4X2N0cmwpOwotCXJlc2V0X2Nv
bnRyb2xfcmVzZXQobWVzb25fZHdfaGRtaS0+aGRtaXR4X3BoeSk7Ci0KLQkvKiBFbmFibGUgQVBC
MyBmYWlsIG9uIGVycm9yICovCi0JaWYgKCFtZXNvbl92cHVfaXNfY29tcGF0aWJsZShwcml2LCAi
YW1sb2dpYyxtZXNvbi1nMTJhLXZwdSIpKSB7Ci0JCXdyaXRlbF9iaXRzX3JlbGF4ZWQoQklUKDE1
KSwgQklUKDE1KSwKLQkJCQkgICAgbWVzb25fZHdfaGRtaS0+aGRtaXR4ICsgSERNSVRYX1RPUF9D
VFJMX1JFRyk7Ci0JCXdyaXRlbF9iaXRzX3JlbGF4ZWQoQklUKDE1KSwgQklUKDE1KSwKLQkJCQkg
ICAgbWVzb25fZHdfaGRtaS0+aGRtaXR4ICsgSERNSVRYX0RXQ19DVFJMX1JFRyk7Ci0JfQotCi0J
LyogQnJpbmcgb3V0IG9mIHJlc2V0ICovCi0JbWVzb25fZHdfaGRtaS0+ZGF0YS0+dG9wX3dyaXRl
KG1lc29uX2R3X2hkbWksCi0JCQkJICAgICAgIEhETUlUWF9UT1BfU1dfUkVTRVQsICAwKTsKLQot
CW1zbGVlcCgyMCk7Ci0KLQltZXNvbl9kd19oZG1pLT5kYXRhLT50b3Bfd3JpdGUobWVzb25fZHdf
aGRtaSwKLQkJCQkgICAgICAgSERNSVRYX1RPUF9DTEtfQ05UTCwgMHhmZik7Ci0KLQkvKiBFbmFi
bGUgSERNSS1UWCBJbnRlcnJ1cHQgKi8KLQltZXNvbl9kd19oZG1pLT5kYXRhLT50b3Bfd3JpdGUo
bWVzb25fZHdfaGRtaSwgSERNSVRYX1RPUF9JTlRSX1NUQVRfQ0xSLAotCQkJCSAgICAgICBIRE1J
VFhfVE9QX0lOVFJfQ09SRSk7Ci0KLQltZXNvbl9kd19oZG1pLT5kYXRhLT50b3Bfd3JpdGUobWVz
b25fZHdfaGRtaSwgSERNSVRYX1RPUF9JTlRSX01BU0tOLAotCQkJCSAgICAgICBIRE1JVFhfVE9Q
X0lOVFJfQ09SRSk7CisJbWVzb25fZHdfaGRtaV9pbml0KG1lc29uX2R3X2hkbWkpOwogCiAJLyog
QnJpZGdlIC8gQ29ubmVjdG9yICovCiAKQEAgLTk5MSw2ICs5OTksMzQgQEAgc3RhdGljIGNvbnN0
IHN0cnVjdCBjb21wb25lbnRfb3BzIG1lc29uX2R3X2hkbWlfb3BzID0gewogCS51bmJpbmQJPSBt
ZXNvbl9kd19oZG1pX3VuYmluZCwKIH07CiAKK3N0YXRpYyBpbnQgX19tYXliZV91bnVzZWQgbWVz
b25fZHdfaGRtaV9wbV9zdXNwZW5kKHN0cnVjdCBkZXZpY2UgKmRldikKK3sKKwlzdHJ1Y3QgbWVz
b25fZHdfaGRtaSAqbWVzb25fZHdfaGRtaSA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOworCisJaWYg
KCFtZXNvbl9kd19oZG1pKQorCQlyZXR1cm4gMDsKKworCS8qIFJlc2V0IFRPUCAqLworCW1lc29u
X2R3X2hkbWktPmRhdGEtPnRvcF93cml0ZShtZXNvbl9kd19oZG1pLAorCQkJCSAgICAgICBIRE1J
VFhfVE9QX1NXX1JFU0VULCAwKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IF9fbWF5
YmVfdW51c2VkIG1lc29uX2R3X2hkbWlfcG1fcmVzdW1lKHN0cnVjdCBkZXZpY2UgKmRldikKK3sK
KwlzdHJ1Y3QgbWVzb25fZHdfaGRtaSAqbWVzb25fZHdfaGRtaSA9IGRldl9nZXRfZHJ2ZGF0YShk
ZXYpOworCisJaWYgKCFtZXNvbl9kd19oZG1pKQorCQlyZXR1cm4gMDsKKworCW1lc29uX2R3X2hk
bWlfaW5pdChtZXNvbl9kd19oZG1pKTsKKworCWR3X2hkbWlfcmVzdW1lKG1lc29uX2R3X2hkbWkt
PmhkbWkpOworCisJcmV0dXJuIDA7Cit9CisKIHN0YXRpYyBpbnQgbWVzb25fZHdfaGRtaV9wcm9i
ZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQogewogCXJldHVybiBjb21wb25lbnRfYWRk
KCZwZGV2LT5kZXYsICZtZXNvbl9kd19oZG1pX29wcyk7CkBAIC0xMDAzLDYgKzEwMzksMTEgQEAg
c3RhdGljIGludCBtZXNvbl9kd19oZG1pX3JlbW92ZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpw
ZGV2KQogCXJldHVybiAwOwogfQogCitzdGF0aWMgY29uc3Qgc3RydWN0IGRldl9wbV9vcHMgbWVz
b25fZHdfaGRtaV9wbV9vcHMgPSB7CisJU0VUX1NZU1RFTV9TTEVFUF9QTV9PUFMobWVzb25fZHdf
aGRtaV9wbV9zdXNwZW5kLAorCQkJCW1lc29uX2R3X2hkbWlfcG1fcmVzdW1lKQorfTsKKwogc3Rh
dGljIGNvbnN0IHN0cnVjdCBvZl9kZXZpY2VfaWQgbWVzb25fZHdfaGRtaV9vZl90YWJsZVtdID0g
ewogCXsgLmNvbXBhdGlibGUgPSAiYW1sb2dpYyxtZXNvbi1neGJiLWR3LWhkbWkiLAogCSAgLmRh
dGEgPSAmbWVzb25fZHdfaGRtaV9neF9kYXRhIH0sCkBAIC0xMDIyLDYgKzEwNjMsNyBAQCBzdGF0
aWMgc3RydWN0IHBsYXRmb3JtX2RyaXZlciBtZXNvbl9kd19oZG1pX3BsYXRmb3JtX2RyaXZlciA9
IHsKIAkuZHJpdmVyCQk9IHsKIAkJLm5hbWUJCT0gRFJJVkVSX05BTUUsCiAJCS5vZl9tYXRjaF90
YWJsZQk9IG1lc29uX2R3X2hkbWlfb2ZfdGFibGUsCisJCS5wbSA9ICZtZXNvbl9kd19oZG1pX3Bt
X29wcywKIAl9LAogfTsKIG1vZHVsZV9wbGF0Zm9ybV9kcml2ZXIobWVzb25fZHdfaGRtaV9wbGF0
Zm9ybV9kcml2ZXIpOwotLSAKMi4yMi4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5m
cmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0
aW5mby9kcmktZGV2ZWw=
