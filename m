Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 20D28F531A
	for <lists+dri-devel@lfdr.de>; Fri,  8 Nov 2019 19:00:06 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 04F216FA46;
	Fri,  8 Nov 2019 17:59:57 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from perceval.ideasonboard.com (perceval.ideasonboard.com
 [IPv6:2001:4b98:dc2:55:216:3eff:fef7:d647])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4CF206FA41
 for <dri-devel@lists.freedesktop.org>; Fri,  8 Nov 2019 17:59:54 +0000 (UTC)
Received: from pendragon.bb.dnainternet.fi (81-175-216-236.bb.dnainternet.fi
 [81.175.216.236])
 by perceval.ideasonboard.com (Postfix) with ESMTPSA id 4403F71D;
 Fri,  8 Nov 2019 18:59:52 +0100 (CET)
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v10 2/4] drm: xlnx: DRM/KMS driver for Xilinx ZynqMP
 DisplayPort Subsystem
Date: Fri,  8 Nov 2019 19:59:33 +0200
Message-Id: <20191108175935.29766-3-laurent.pinchart@ideasonboard.com>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191108175935.29766-1-laurent.pinchart@ideasonboard.com>
References: <20191108175935.29766-1-laurent.pinchart@ideasonboard.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=ideasonboard.com; s=mail; t=1573235993;
 bh=m/0TpxKeKFxuJ12ae3EQSSjgfv9M7ue43pqTDxCMELw=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=lph5cpS/e3ExNzcRR0Oh+q9oUqno3Mgf+v4ZUikSMZoB2/Nw9tLrjaNlyszJy0mSu
 cxQQ7SihrSSmdQC7foNthL8nF0xROxmwCifldDK11ayk8TQxGHVS0b/LXTbi0vCJ7l
 U0VsmhxC5jOqD1NaI200QgLiFdsO5z7l+9caF3hE=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Michal Simek <michal.simek@xilinx.com>, Hyun Kwon <hyun.kwon@xilinx.com>,
 Satish Kumar Nagireddy <SATISHNA@xilinx.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogSHl1biBLd29uIDxoeXVuLmt3b25AeGlsaW54LmNvbT4KClRoZSBYaWxpbnggWnlucU1Q
IFNvQyBoYXMgYSBoYXJkZW5lZCBkaXNwbGF5IHBpcGVsaW5lIG5hbWVkIERpc3BsYXlQb3J0ClN1
YnN5c3RlbS4gSXQgaW5jbHVkZXMgYSBidWZmZXIgbWFuYWdlciwgYSB2aWRlbyBwaXBlbGluZSBy
ZW5kZXJlcgooYmxlbmRlciksIGFuIGF1ZGlvIG1peGVyIGFuZCBhIERpc3BsYXlQb3J0IHNvdXJj
ZSBjb250cm9sbGVyCih0cmFuc21pdHRlcikuIFRoZSBETUEgZW5naW5lIHRoZSBwcm92aWRlIGRh
dGEgdG8gdGhlIGJ1ZmZlciBtYW5hZ2VyLCBhcwp3ZWxsIGFzIHRoZSBEaXNwbGF5UG9ydCBQSFlz
IHRoYXQgZHJpdmUgdGhlIGxhbmVzLCBhcmUgZXh0ZXJuYWwgdG8gdGhlCnN1YnN5c3RlbSBhbmQg
aW50ZXJmYWNlZCB1c2luZyB0aGUgRE1BIGVuZ2luZSBhbmQgUEhZIEFQSXMgcmVzcGVjdGl2ZWx5
LgoKVGhpcyBkcml2ZXIgc3VwcG9ydHMgdGhlIERpc3BsYXlQb3J0IFN1YnN5c3RlbSBhbmQgaW1w
bGVtZW50cwoKLSBUd28gcGxhbmVzLCBmb3IgZ3JhcGhpY3MgYW5kIHZpZGVvCi0gT25lIENSVEMg
dGhhdCBzdXBwb3J0cyBhbHBoYSBibGVuZGluZwotIE9uZSBlbmNvZGVyIGZvciB0aGUgRGlzcGxh
eVBvcnQgdHJhbnNtaXR0ZXIKLSBPbmUgY29ubmVjdG9yIGZvciBhbiBleHRlcm5hbCBtb25pdG9y
CgpJdCBjdXJyZW50bHkgZG9lc24ndCBzdXBwb3J0CgotIENvbG9yIGtleWluZwotIFRlc3QgcGF0
dGVybiBnZW5lcmF0aW9uCi0gQXVkaW8KLSBMaXZlIGlucHV0IGZyb20gdGhlIFByb2dyYW1tYWJs
ZSBMb2dpYyAoRlBHQSkKLSBPdXRwdXQgdG8gdGhlIFByb2dyYW1tYWJsZSBMb2dpYyAoRlBHQSkK
ClNpZ25lZC1vZmYtYnk6IEh5dW4gS3dvbiA8aHl1bi5rd29uQHhpbGlueC5jb20+ClNpZ25lZC1v
ZmYtYnk6IExhdXJlbnQgUGluY2hhcnQgPGxhdXJlbnQucGluY2hhcnRAaWRlYXNvbmJvYXJkLmNv
bT4KLS0tCkNoYW5nZXMgc2luY2Ugdjk6CgotIERyb3AgRFJJVkVSX1BSSU1FCi0gRG9uJ3Qgc2V0
IHRoZSBzdHJ1Y3QgZHJpdmVyIG93bmVyIGZpZWxkIG1hbnVhbGx5Ci0gUmVuYW1lIHp5bnFtcF9k
cHN1YiBhbGlnbiBmaWVsZCB0byBkbWFfYWxpZ24gYW5kIGNsYXJpZnkgaXRzCiAgZGVzY3JpcHRp
b24KLSBEb2N1bWVudCB0aGUgenlucW1wX2Rwc3ViIGFwYl9jbGsgZmllbGQgYW5kIGZpeCBhIHJl
bGF0ZWQgY29tbWVudCB0bwogIG1lbnRpb24gdGhlIEFQQiBjbG9jayBpbnN0ZWFkIG9mIHRoZSBB
WEkgY2xvY2sKLSBDb2Rpbmcgc3R5bGUgZml4ZXMKCk5vdGFibGUgY2hhbmdlcyBzaW5jZSB2ODoK
Ci0gUmViYXNlIG9uIHRvcCBvZiB2NS4zIGFuZCB1cGRhdGUgdG8gQVBJIGNoYW5nZXMKLSBDbGVh
bnVwICNpbmNsdWRlIHN0YXRlbWVudHMKLSBVc2UgdGhlIG1vZGUgY29uZmlnIHN1c3BlbmQvcmVz
dW1lIGhlbHBlcnMKLSBSZW1vdmUgdW51c2VkIGNvZGUgKG1hY3JvcywgZmllbGRzLCBmdW5jdGlv
bnMsIC4uLikKLSBTb3J0IGhlYWRlcnMgYW5kIGZvcndhcmQgZGVjbGFyYXRpb25zIGFscGhhYmV0
aWNhbGx5Ci0gVXNlIG1vcmUgc3RhbmRhcmQgRFJNL0tNUyBoZWxwZXJzIChzdXNwZW5kL3Jlc3Vt
ZSwgZmJkZXYsCiAgREVGSU5FX0RSTV9HRU1fQ01BX0ZPUFMpCi0gRHJvcCBzdXBwb3J0IGZvciBo
YWxmLWltcGxlbWVudGVkIG9yIHVuc3VwcG9ydGVkIGZlYXR1cmVzIChzb3VuZCBEVAogIGJpbmRp
bmdzIHBhcnNpbmcsIGludGVyZmFjZSB3aXRoIFBMKQotIFJlbW92ZSB0aGUgeGxueCBkcm0gaGVs
cGVycwotIFJlbW92ZSBzb21lIG1vZHVsZSBwYXJhbWV0ZXJzCi0gUmVvcmdhbml6ZSBjb2RlIGlu
IHNlY3Rpb25zLCB3aXRoIGJldHRlciBzZXBhcmF0aW9uIG9mIG9wZXJhdGlvbnMKLSBCZXR0ZXIg
c2VwYXJhdGlvbiBvZiB0aGUgZW5jb2RlciBmcm9tIHRoZSBDUlRDCi0gRHJvcCB0aGUgY29tcG9u
ZW50IGZyYW1ld29yawotIFZhcmlvdXMga2VybmVsZG9jIHJld29ya3MsIHdpdGggcmVuYW1lcyBv
ZiBzdHJ1Y3R1cmVzLCBmaWVsZHMgYW5kCiAgZnVuY3Rpb25zCi0gRml4IHZibGFuayBhbmQgcGFn
ZSBmbGlwIGV2ZW50IGhhbmRsaW5nCi0gUmVtb3ZlIGhhY2sgdG8gZGlzYWJsZSBjbG9ja3MgYXQg
c3RhcnR1cAotIFVwZGF0ZSBjb3B5cmlnaHQgaGVhZGVycwotIE1vdmUgY2hlY2tzIGZyb20gYXRv
bWljIGNvbW1pdCB0aW1lIHRvIGF0b21pYyBjaGVjayB0aW1lCi0gUmVtb3ZlIHBhcnRpYWwgc3Vw
cG9ydCBmb3IgdGhlIFRQRwotIFJlbW92ZSBwYXJ0aWFsIHN1cHBvcnQgZm9yIGxpdmUgaW5wdXRz
Ci0gUmVtb3ZlIGFzeW5jIHVwZGF0ZSBzdXBwb3J0Ci0gQ2xlYW4gdXAgRFAgVFggaW5pdGlhbGlz
YXRpb24gYW5kIGNsZWFudXAKCndpcAotLS0KIE1BSU5UQUlORVJTICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB8ICAgIDkgKwogZHJpdmVycy9ncHUvZHJtL0tjb25maWcgICAgICAgICAgICAg
ICAgIHwgICAgMiArCiBkcml2ZXJzL2dwdS9kcm0vTWFrZWZpbGUgICAgICAgICAgICAgICAgfCAg
ICAxICsKIGRyaXZlcnMvZ3B1L2RybS94bG54L0tjb25maWcgICAgICAgICAgICB8ICAgMTMgKwog
ZHJpdmVycy9ncHUvZHJtL3hsbngvTWFrZWZpbGUgICAgICAgICAgIHwgICAgMiArCiBkcml2ZXJz
L2dwdS9kcm0veGxueC96eW5xbXBfZGlzcC5jICAgICAgfCAxNjc4ICsrKysrKysrKysrKysrKysr
KysrKysrCiBkcml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZGlzcC5oICAgICAgfCAgIDQzICsK
IGRyaXZlcnMvZ3B1L2RybS94bG54L3p5bnFtcF9kaXNwX3JlZ3MuaCB8ICAyMDEgKysrCiBkcml2
ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZHAuYyAgICAgICAgfCAxNjc3ICsrKysrKysrKysrKysr
KysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS94bG54L3p5bnFtcF9kcC5oICAgICAgICB8ICAgMjkg
KwogZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rwc3ViLmMgICAgIHwgIDMzMCArKysrKwog
ZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rwc3ViLmggICAgIHwgICA0OSArCiAxMiBmaWxl
cyBjaGFuZ2VkLCA0MDM0IGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJz
L2dwdS9kcm0veGxueC9LY29uZmlnCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJt
L3hsbngvTWFrZWZpbGUKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0veGxueC96
eW5xbXBfZGlzcC5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL3hsbngvenlu
cW1wX2Rpc3AuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS94bG54L3p5bnFt
cF9kaXNwX3JlZ3MuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS94bG54L3p5
bnFtcF9kcC5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1w
X2RwLmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZHBz
dWIuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS94bG54L3p5bnFtcF9kcHN1
Yi5oCgpkaWZmIC0tZ2l0IGEvTUFJTlRBSU5FUlMgYi9NQUlOVEFJTkVSUwppbmRleCAzNjhiYjEy
N2VkZjEuLmQ2MjJmYWVmMjJhOCAxMDA2NDQKLS0tIGEvTUFJTlRBSU5FUlMKKysrIGIvTUFJTlRB
SU5FUlMKQEAgLTU1NzQsNiArNTU3NCwxNSBAQCBGOglkcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi8K
IEY6CWluY2x1ZGUvdWFwaS9kcm0vZXRuYXZpdl9kcm0uaAogRjoJRG9jdW1lbnRhdGlvbi9kZXZp
Y2V0cmVlL2JpbmRpbmdzL2Rpc3BsYXkvZXRuYXZpdi8KIAorRFJNIERSSVZFUlMgRk9SIFhJTElO
WAorTToJSHl1biBLd29uIDxoeXVuLmt3b25AeGlsaW54LmNvbT4KK006CUxhdXJlbnQgUGluY2hh
cnQgPGxhdXJlbnQucGluY2hhcnRAaWRlYXNvbmJvYXJkLmNvbT4KK0w6CWRyaS1kZXZlbEBsaXN0
cy5mcmVlZGVza3RvcC5vcmcKK1M6CU1haW50YWluZWQKK0Y6CWRyaXZlcnMvZ3B1L2RybS94bG54
LworRjoJRG9jdW1lbnRhdGlvbi9kZXZpY2V0cmVlL2JpbmRpbmdzL2Rpc3BsYXkveGxueC8KK1Q6
CWdpdCBnaXQ6Ly9hbm9uZ2l0LmZyZWVkZXNrdG9wLm9yZy9kcm0vZHJtLW1pc2MKKwogRFJNIERS
SVZFUlMgRk9SIFpURSBaWAogTToJU2hhd24gR3VvIDxzaGF3bmd1b0BrZXJuZWwub3JnPgogTDoJ
ZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL0tjb25maWcgYi9kcml2ZXJzL2dwdS9kcm0vS2NvbmZpZwppbmRleCBlNjdjMTk0YzJhY2Eu
LjMwOThjMmRiMGI5NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL0tjb25maWcKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL0tjb25maWcKQEAgLTM1OCw2ICszNTgsOCBAQCBzb3VyY2UgImRyaXZl
cnMvZ3B1L2RybS9hc3BlZWQvS2NvbmZpZyIKIAogc291cmNlICJkcml2ZXJzL2dwdS9kcm0vbWNk
ZS9LY29uZmlnIgogCitzb3VyY2UgImRyaXZlcnMvZ3B1L2RybS94bG54L0tjb25maWciCisKICMg
S2VlcCBsZWdhY3kgZHJpdmVycyBsYXN0CiAKIG1lbnVjb25maWcgRFJNX0xFR0FDWQpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL01ha2VmaWxl
CmluZGV4IDgyZmY4MjZiMzNjYy4uOTZkNDZiMDBlYTUwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL01ha2VmaWxlCkBAIC0xMjAsMyAr
MTIwLDQgQEAgb2JqLSQoQ09ORklHX0RSTV9MSU1BKSAgKz0gbGltYS8KIG9iai0kKENPTkZJR19E
Uk1fUEFORlJPU1QpICs9IHBhbmZyb3N0Lwogb2JqLSQoQ09ORklHX0RSTV9BU1BFRURfR0ZYKSAr
PSBhc3BlZWQvCiBvYmotJChDT05GSUdfRFJNX01DREUpICs9IG1jZGUvCitvYmoteQkJCSs9IHhs
bngvCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0veGxueC9LY29uZmlnIGIvZHJpdmVycy9n
cHUvZHJtL3hsbngvS2NvbmZpZwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAw
MDAuLmFhNmNkODg5YmQxMQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS94bG54
L0tjb25maWcKQEAgLTAsMCArMSwxMyBAQAorY29uZmlnIERSTV9aWU5RTVBfRFBTVUIKKwl0cmlz
dGF0ZSAiWnlucU1QIERpc3BsYXlQb3J0IENvbnRyb2xsZXIgRHJpdmVyIgorCWRlcGVuZHMgb24g
QVJDSF9aWU5RTVAgfHwgQ09NUElMRV9URVNUCisJZGVwZW5kcyBvbiBDT01NT05fQ0xLICYmIERS
TSAmJiBPRgorCXNlbGVjdCBETUFfRU5HSU5FCisJc2VsZWN0IERSTV9HRU1fQ01BX0hFTFBFUgor
CXNlbGVjdCBEUk1fS01TX0NNQV9IRUxQRVIKKwlzZWxlY3QgRFJNX0tNU19IRUxQRVIKKwlzZWxl
Y3QgR0VORVJJQ19QSFkKKwloZWxwCisJICBUaGlzIGlzIGEgRFJNL0tNUyBkcml2ZXIgZm9yIFp5
bnFNUCBEaXNwbGF5UG9ydCBjb250cm9sbGVyLiBDaG9vc2UKKwkgIHRoaXMgb3B0aW9uIGlmIHlv
dSBoYXZlIGEgWGlsaW54IFp5bnFNUCBTb0Mgd2l0aCBEaXNwbGF5UG9ydAorCSAgc3Vic3lzdGVt
LgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3hsbngvTWFrZWZpbGUgYi9kcml2ZXJzL2dw
dS9kcm0veGxueC9NYWtlZmlsZQpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAw
MDAuLjJiODQ0YzYwYTgwYQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS94bG54
L01ha2VmaWxlCkBAIC0wLDAgKzEsMiBAQAorenlucW1wLWRwc3ViLW9ianMgKz0genlucW1wX2Rp
c3AubyB6eW5xbXBfZHBzdWIubyB6eW5xbXBfZHAubworb2JqLSQoQ09ORklHX0RSTV9aWU5RTVBf
RFBTVUIpICs9IHp5bnFtcC1kcHN1Yi5vCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0veGxu
eC96eW5xbXBfZGlzcC5jIGIvZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rpc3AuYwpuZXcg
ZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjQwZjJmZTBlNDZiNgotLS0gL2Rl
di9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS94bG54L3p5bnFtcF9kaXNwLmMKQEAgLTAsMCAr
MSwxNjc4IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAorLyoKKyAqIFp5
bnFNUCBEaXNwbGF5IENvbnRyb2xsZXIgRHJpdmVyCisgKgorICogQ29weXJpZ2h0IChDKSAyMDE3
IC0gMjAxOSBYaWxpbngsIEluYy4KKyAqCisgKiBBdXRob3JzOgorICogLSBIeXVuIFdvbyBLd29u
IDxoeXVuLmt3b25AeGlsaW54LmNvbT4KKyAqIC0gTGF1cmVudCBQaW5jaGFydCA8bGF1cmVudC5w
aW5jaGFydEBpZGVhc29uYm9hcmQuY29tPgorICovCisKKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21p
Yy5oPgorI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljX2hlbHBlci5oPgorI2luY2x1ZGUgPGRybS9k
cm1fYXRvbWljX3VhcGkuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2NydGMuaD4KKyNpbmNsdWRlIDxk
cm0vZHJtX2RldmljZS5oPgorI2luY2x1ZGUgPGRybS9kcm1fZmJfY21hX2hlbHBlci5oPgorI2lu
Y2x1ZGUgPGRybS9kcm1fZm91cmNjLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9mcmFtZWJ1ZmZlci5o
PgorI2luY2x1ZGUgPGRybS9kcm1fcGxhbmUuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3BsYW5lX2hl
bHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fdmJsYW5rLmg+CisKKyNpbmNsdWRlIDxsaW51eC9j
bGsuaD4KKyNpbmNsdWRlIDxsaW51eC9kZWxheS5oPgorI2luY2x1ZGUgPGxpbnV4L2RtYS1tYXBw
aW5nLmg+CisjaW5jbHVkZSA8bGludXgvZG1hZW5naW5lLmg+CisjaW5jbHVkZSA8bGludXgvbW9k
dWxlLmg+CisjaW5jbHVkZSA8bGludXgvb2YuaD4KKyNpbmNsdWRlIDxsaW51eC9vZl9kbWEuaD4K
KyNpbmNsdWRlIDxsaW51eC9wbGF0Zm9ybV9kZXZpY2UuaD4KKyNpbmNsdWRlIDxsaW51eC9wbV9y
dW50aW1lLmg+CisjaW5jbHVkZSA8bGludXgvc3BpbmxvY2suaD4KKworI2luY2x1ZGUgInp5bnFt
cF9kaXNwLmgiCisjaW5jbHVkZSAienlucW1wX2Rpc3BfcmVncy5oIgorI2luY2x1ZGUgInp5bnFt
cF9kcC5oIgorI2luY2x1ZGUgInp5bnFtcF9kcHN1Yi5oIgorCisvKgorICogT3ZlcnZpZXcKKyAq
IC0tLS0tLS0tCisgKgorICogVGhlIGRpc3BsYXkgY29udHJvbGxlciBwYXJ0IG9mIFp5bnFNUCBE
UCBzdWJzeXN0ZW0sIG1hZGUgb2YgdGhlIEF1ZGlvL1ZpZGVvCisgKiBCdWZmZXIgTWFuYWdlciwg
dGhlIFZpZGVvIFJlbmRlcmluZyBQaXBlbGluZSAoYmxlbmRlcikgYW5kIHRoZSBBdWRpbyBNaXhl
ci4KKyAqCisgKiAgICAgICAgICAgICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsKKyAqICstLS0tLS0tLSsgICB8ICstLS0tLS0t
LS0tLS0tLS0tKyAgICAgKy0tLS0tLS0tLS0tKyAgICAgICAgICAgICAgICAgICAgICAgfAorICog
fCBEUERNQSAgfCAtLS0+fCAgICAgICAgICAgICAgICB8IC0tPiB8ICAgVmlkZW8gICB8IFZpZGVv
ICstLS0tLS0tLS0tLS0tKyB8CisgKiB8IDR4IHZpZCB8ICAgfCB8ICAgICAgICAgICAgICAgIHwg
ICAgIHwgUmVuZGVyaW5nIHwgLSstLT4gfCAgICAgICAgICAgICB8IHwgICArLS0tLS0tKworICog
fCAyeCBhdWQgfCAgIHwgfCAgQXVkaW8vVmlkZW8gICB8IC0tPiB8IFBpcGVsaW5lICB8ICB8ICAg
IHwgRGlzcGxheVBvcnQgfC0tLT4gfCBQSFkwIHwKKyAqICstLS0tLS0tLSsgICB8IHwgQnVmZmVy
IE1hbmFnZXIgfCAgICAgKy0tLS0tLS0tLS0tKyAgfCAgICB8ICAgU291cmNlICAgIHwgfCAgICst
LS0tLS0rCisgKiAgICAgICAgICAgICAgfCB8ICAgIGFuZCBTVEMgICAgIHwgICAgICstLS0tLS0t
LS0tLSsgIHwgICAgfCBDb250cm9sbGVyICB8IHwgICArLS0tLS0tKworICogTGl2ZSBWaWRlbyAt
LS0+fCAgICAgICAgICAgICAgICB8IC0tPiB8ICAgQXVkaW8gICB8IEF1ZGlvIHwgICAgICAgICAg
ICAgfC0tLT4gfCBQSFkxIHwKKyAqICAgICAgICAgICAgICB8IHwgICAgICAgICAgICAgICAgfCAg
ICAgfCAgIE1peGVyICAgfCAtLSstPiB8ICAgICAgICAgICAgIHwgfCAgICstLS0tLS0rCisgKiBM
aXZlIEF1ZGlvIC0tLT58ICAgICAgICAgICAgICAgIHwgLS0+IHwgICAgICAgICAgIHwgIHx8ICAg
Ky0tLS0tLS0tLS0tLS0rIHwKKyAqICAgICAgICAgICAgICB8ICstLS0tLS0tLS0tLS0tLS0tKyAg
ICAgKy0tLS0tLS0tLS0tKyAgfHwgICAgICAgICAgICAgICAgICAgfAorICogICAgICAgICAgICAg
ICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fC0tLS0tLS0tLS0tLS0t
LS0tLS0rCisgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHZ2CisgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIEJsZW5kZWQgVmlkZW8gYW5kCisgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIE1peGVkIEF1ZGlvIHRvIFBMCisgKgorICogT25seSBub24tbGl2ZSBp
bnB1dCBmcm9tIHRoZSBEUERNQSBhbmQgb3V0cHV0IHRvIHRoZSBEaXNwbGF5UG9ydCBTb3VyY2UK
KyAqIENvbnRyb2xsZXIgYXJlIGN1cnJlbnRseSBzdXBwb3J0ZWQuIEludGVyZmFjZSB3aXRoIHRo
ZSBwcm9ncmFtbWFibGUgbG9naWMKKyAqIGZvciBsaXZlIHN0cmVhbXMgaXMgbm90IGltcGxlbWVu
dGVkLgorICoKKyAqIFRoZSBkaXNwbGF5IGNvbnRyb2xsZXIgY29kZSBjcmVhdGVzIHBsYW5lcyBm
b3IgdGhlIERQRE1BIHZpZGVvIGFuZCBncmFwaGljcworICogbGF5ZXJzLCBhbmQgYSBDUlRDIGZv
ciB0aGUgVmlkZW8gUmVuZGVyaW5nIFBpcGVsaW5lLgorICoKKyAqIGludGVyZmFjZSBpbnRvIHRo
b3NlIDMgYmxvY2tzLiBJbiBoaWdoIGxldmVsLCB0aGUgZHJpdmVyIGlzIGxheWVyZWQKKyAqIGlu
IHRoZSBmb2xsb3dpbmcgd2F5OgorICoKKyAqIHp5bnFtcF9kaXNwX2NydGMgJiB6eW5xbXBfZGlz
cF9wbGFuZQorICogfC0+enlucW1wX2Rpc3AKKyAqCXwtPnp5bnFtcF9kaXNwX2F1ZAorICoJfC0+
enlucW1wX2Rpc3BfYmxlbmQKKyAqCXwtPnp5bnFtcF9kaXNwX2F2YnVmCisgKi8KKworI2RlZmlu
ZSBaWU5RTVBfRElTUF9BVl9CVUZfTlVNX1ZJRF9HRlhfQlVGRkVSUwkJNAorI2RlZmluZSBaWU5R
TVBfRElTUF9BVl9CVUZfTlVNX0JVRkZFUlMJCQk2CisKKyNkZWZpbmUgWllOUU1QX0RJU1BfTlVN
X0xBWUVSUwkJCQkyCisjZGVmaW5lIFpZTlFNUF9ESVNQX01BWF9OVU1fU1VCX1BMQU5FUwkJCTMK
KworLyoqCisgKiBzdHJ1Y3QgenlucW1wX2Rpc3BfZm9ybWF0IC0gRGlzcGxheSBzdWJzeXN0ZW0g
Zm9ybWF0IGluZm9ybWF0aW9uCisgKiBAZHJtX2ZtdDogRFJNIGZvcm1hdCAoNENDKQorICogQGJ1
Zl9mbXQ6IEFWIGJ1ZmZlciBmb3JtYXQKKyAqIEBidXNfZm10OiBNZWRpYSBidXMgZm9ybWF0cyAo
bGl2ZSBmb3JtYXRzKQorICogQHN3YXA6IEZsYWcgdG8gc3dhcCBSICYgQiBmb3IgUkdCIGZvcm1h
dHMsIGFuZCBVICYgViBmb3IgWVVWIGZvcm1hdHMKKyAqIEBzZjogU2NhbGluZyBmYWN0b3JzIGZv
ciBjb2xvciBjb21wb25lbnRzCisgKi8KK3N0cnVjdCB6eW5xbXBfZGlzcF9mb3JtYXQgeworCXUz
MiBkcm1fZm10OworCXUzMiBidWZfZm10OworCXUzMiBidXNfZm10OworCWJvb2wgc3dhcDsKKwlj
b25zdCB1MzIgKnNmOworfTsKKworLyoqCisgKiBlbnVtIHp5bnFtcF9kaXNwX2lkIC0gTGF5ZXIg
aWRlbnRpZmllcgorICogQFpZTlFNUF9ESVNQX0xBWUVSX1ZJRDogVmlkZW8gbGF5ZXIKKyAqIEBa
WU5RTVBfRElTUF9MQVlFUl9HRlg6IEdyYXBoaWNzIGxheWVyCisgKi8KK2VudW0genlucW1wX2Rp
c3BfbGF5ZXJfaWQgeworCVpZTlFNUF9ESVNQX0xBWUVSX1ZJRCwKKwlaWU5RTVBfRElTUF9MQVlF
Ul9HRlgKK307CisKKy8qKgorICogZW51bSB6eW5xbXBfZGlzcF9sYXllcl9tb2RlIC0gTGF5ZXIg
bW9kZQorICogQFpZTlFNUF9ESVNQX0xBWUVSX05PTkxJVkU6IG5vbi1saXZlIChtZW1vcnkpIG1v
ZGUKKyAqIEBaWU5RTVBfRElTUF9MQVlFUl9MSVZFOiBsaXZlIChzdHJlYW0pIG1vZGUKKyAqLwor
ZW51bSB6eW5xbXBfZGlzcF9sYXllcl9tb2RlIHsKKwlaWU5RTVBfRElTUF9MQVlFUl9OT05MSVZF
LAorCVpZTlFNUF9ESVNQX0xBWUVSX0xJVkUKK307CisKKy8qKgorICogc3RydWN0IHp5bnFtcF9k
aXNwX2xheWVyX2RtYSAtIERNQSBjaGFubmVsIGZvciBvbmUgZGF0YSBwbGFuZSBvZiBhIGxheWVy
CisgKiBAY2hhbjogRE1BIGNoYW5uZWwKKyAqIEB4dDogSW50ZXJsZWF2ZWQgRE1BIGRlc2NyaXB0
b3IgdGVtcGxhdGUKKyAqIEBzZ2w6IERhdGEgY2h1bmsgZm9yIGRtYV9pbnRlcmxlYXZlZF90ZW1w
bGF0ZQorICovCitzdHJ1Y3QgenlucW1wX2Rpc3BfbGF5ZXJfZG1hIHsKKwlzdHJ1Y3QgZG1hX2No
YW4gKmNoYW47CisJc3RydWN0IGRtYV9pbnRlcmxlYXZlZF90ZW1wbGF0ZSB4dDsKKwlzdHJ1Y3Qg
ZGF0YV9jaHVuayBzZ2w7Cit9OworCisvKioKKyAqIHN0cnVjdCB6eW5xbXBfZGlzcF9sYXllcl9p
bmZvIC0gU3RhdGljIGxheWVyIGluZm9ybWF0aW9uCisgKiBAZm9ybWF0czogQXJyYXkgb2Ygc3Vw
cG9ydGVkIGZvcm1hdHMKKyAqIEBudW1fZm9ybWF0czogTnVtYmVyIG9mIGZvcm1hdHMgaW4gQGZv
cm1hdHMgYXJyYXkKKyAqIEBudW1fY2hhbm5lbHM6IE51bWJlciBvZiBETUEgY2hhbm5lbHMKKyAq
Lworc3RydWN0IHp5bnFtcF9kaXNwX2xheWVyX2luZm8geworCWNvbnN0IHN0cnVjdCB6eW5xbXBf
ZGlzcF9mb3JtYXQgKmZvcm1hdHM7CisJdW5zaWduZWQgaW50IG51bV9mb3JtYXRzOworCXVuc2ln
bmVkIGludCBudW1fY2hhbm5lbHM7Cit9OworCisvKioKKyAqIHN0cnVjdCB6eW5xbXBfZGlzcF9s
YXllciAtIERpc3BsYXkgbGF5ZXIgKERSTSBwbGFuZSkKKyAqIEBwbGFuZTogRFJNIHBsYW5lCisg
KiBAaWQ6IExheWVyIElECisgKiBAZGlzcDogQmFjayBwb2ludGVyIHRvIHN0cnVjdCB6eW5xbXBf
ZGlzcAorICogQGluZm86IFN0YXRpYyBsYXllciBpbmZvcm1hdGlvbgorICogQGRtYXM6IERNQSBj
aGFubmVscworICogQGRpc3BfZm10OiBDdXJyZW50IGZvcm1hdCBpbmZvcm1hdGlvbgorICogQGRy
bV9mbXQ6IEN1cnJlbnQgRFJNIGZvcm1hdCBpbmZvcm1hdGlvbgorICogQG1vZGU6IEN1cnJlbnQg
b3BlcmF0aW9uIG1vZGUKKyAqLworc3RydWN0IHp5bnFtcF9kaXNwX2xheWVyIHsKKwlzdHJ1Y3Qg
ZHJtX3BsYW5lIHBsYW5lOworCWVudW0genlucW1wX2Rpc3BfbGF5ZXJfaWQgaWQ7CisJc3RydWN0
IHp5bnFtcF9kaXNwICpkaXNwOworCWNvbnN0IHN0cnVjdCB6eW5xbXBfZGlzcF9sYXllcl9pbmZv
ICppbmZvOworCisJc3RydWN0IHp5bnFtcF9kaXNwX2xheWVyX2RtYSBkbWFzW1pZTlFNUF9ESVNQ
X01BWF9OVU1fU1VCX1BMQU5FU107CisKKwljb25zdCBzdHJ1Y3QgenlucW1wX2Rpc3BfZm9ybWF0
ICpkaXNwX2ZtdDsKKwljb25zdCBzdHJ1Y3QgZHJtX2Zvcm1hdF9pbmZvICpkcm1fZm10OworCWVu
dW0genlucW1wX2Rpc3BfbGF5ZXJfbW9kZSBtb2RlOworfTsKKworLyoqCisgKiBzdHJ1Y3Qgenlu
cW1wX2Rpc3BfYmxlbmQgLSBCbGVuZGVyCisgKiBAYmFzZTogUmVnaXN0ZXJzIEkvTyBiYXNlIGFk
ZHJlc3MKKyAqLworc3RydWN0IHp5bnFtcF9kaXNwX2JsZW5kIHsKKwl2b2lkIF9faW9tZW0gKmJh
c2U7Cit9OworCisvKioKKyAqIHN0cnVjdCB6eW5xbXBfZGlzcF9hdmJ1ZiAtIEF1ZGlvL3ZpZGVv
IGJ1ZmZlciBtYW5hZ2VyCisgKiBAYmFzZTogUmVnaXN0ZXJzIEkvTyBiYXNlIGFkZHJlc3MKKyAq
Lworc3RydWN0IHp5bnFtcF9kaXNwX2F2YnVmIHsKKwl2b2lkIF9faW9tZW0gKmJhc2U7Cit9Owor
CisvKioKKyAqIHN0cnVjdCB6eW5xbXBfZGlzcF9hdWRpbyAtIEF1ZGlvIG1peGVyCisgKiBAYmFz
ZTogUmVnaXN0ZXJzIEkvTyBiYXNlIGFkZHJlc3MKKyAqIEBfcHNfY2xrOiBBdWRpbyBjbG9jayBm
cm9tIFBTCisgKiBAX3BsX2NsazogQXVkaW8gY2xvY2sgZnJvbSBQTAorICogQGNsazogQXVkaW8g
Y2xvY2sKKyAqLworc3RydWN0IHp5bnFtcF9kaXNwX2F1ZGlvIHsKKwl2b2lkIF9faW9tZW0gKmJh
c2U7CisJc3RydWN0IGNsayAqX3BzX2NsazsKKwlzdHJ1Y3QgY2xrICpfcGxfY2xrOworCXN0cnVj
dCBjbGsgKmNsazsKK307CisKKy8qKgorICogc3RydWN0IHp5bnFtcF9kaXNwIC0gRGlzcGxheSBj
b250cm9sbGVyCisgKiBAZGV2OiBEZXZpY2Ugc3RydWN0dXJlCisgKiBAZHJtOiBEUk0gY29yZQor
ICogQGRwc3ViOiBEaXNwbGF5IHN1YnN5c3RlbQorICogQGNydGM6IERSTSBDUlRDCisgKiBAYmxl
bmQ6IEJsZW5kZXIgKHZpZGVvIHJlbmRlcmluZyBwaXBlbGluZSkKKyAqIEBhdmJ1ZjogQXVkaW8v
dmlkZW8gYnVmZmVyIG1hbmFnZXIKKyAqIEBhdWRpbzogQXVkaW8gbWl4ZXIKKyAqIEBsYXllcnM6
IExheWVycyAocGxhbmVzKQorICogQGV2ZW50OiBQZW5kaW5nIHZibGFuayBldmVudCByZXF1ZXN0
CisgKiBAX3BzX3BjbGs6IFBpeGVsIGNsb2NrIGZyb20gUFMKKyAqIEBfcGxfcGNsazogUGl4ZWwg
Y2xvY2sgZnJvbSBQTAorICogQHBjbGs6IFBpeGVsIGNsb2NrCisgKi8KK3N0cnVjdCB6eW5xbXBf
ZGlzcCB7CisJc3RydWN0IGRldmljZSAqZGV2OworCXN0cnVjdCBkcm1fZGV2aWNlICpkcm07CisJ
c3RydWN0IHp5bnFtcF9kcHN1YiAqZHBzdWI7CisKKwlzdHJ1Y3QgZHJtX2NydGMgY3J0YzsKKwor
CXN0cnVjdCB6eW5xbXBfZGlzcF9ibGVuZCBibGVuZDsKKwlzdHJ1Y3QgenlucW1wX2Rpc3BfYXZi
dWYgYXZidWY7CisJc3RydWN0IHp5bnFtcF9kaXNwX2F1ZGlvIGF1ZGlvOworCisJc3RydWN0IHp5
bnFtcF9kaXNwX2xheWVyIGxheWVyc1taWU5RTVBfRElTUF9OVU1fTEFZRVJTXTsKKworCXN0cnVj
dCBkcm1fcGVuZGluZ192YmxhbmtfZXZlbnQgKmV2ZW50OworCisJLyogRG9uJ3Qgb3BlcmF0ZSBk
aXJlY3RseSBvbiBfcHNfICovCisJc3RydWN0IGNsayAqX3BzX3BjbGs7CisJc3RydWN0IGNsayAq
X3BsX3BjbGs7CisJc3RydWN0IGNsayAqcGNsazsKK307CisKKy8qIC0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tCisgKiBBdWRpby9WaWRlbyBCdWZmZXIgTWFuYWdlcgorICovCisKK3N0YXRpYyBjb25zdCB1
MzIgc2NhbGluZ19mYWN0b3JzXzQ0NFtdID0geworCVpZTlFNUF9ESVNQX0FWX0JVRl80QklUX1NG
LAorCVpZTlFNUF9ESVNQX0FWX0JVRl80QklUX1NGLAorCVpZTlFNUF9ESVNQX0FWX0JVRl80QklU
X1NGLAorfTsKKworc3RhdGljIGNvbnN0IHUzMiBzY2FsaW5nX2ZhY3RvcnNfNTU1W10gPSB7CisJ
WllOUU1QX0RJU1BfQVZfQlVGXzVCSVRfU0YsCisJWllOUU1QX0RJU1BfQVZfQlVGXzVCSVRfU0Ys
CisJWllOUU1QX0RJU1BfQVZfQlVGXzVCSVRfU0YsCit9OworCitzdGF0aWMgY29uc3QgdTMyIHNj
YWxpbmdfZmFjdG9yc181NjVbXSA9IHsKKwlaWU5RTVBfRElTUF9BVl9CVUZfNUJJVF9TRiwKKwla
WU5RTVBfRElTUF9BVl9CVUZfNkJJVF9TRiwKKwlaWU5RTVBfRElTUF9BVl9CVUZfNUJJVF9TRiwK
K307CisKK3N0YXRpYyBjb25zdCB1MzIgc2NhbGluZ19mYWN0b3JzXzY2NltdID0geworCVpZTlFN
UF9ESVNQX0FWX0JVRl82QklUX1NGLAorCVpZTlFNUF9ESVNQX0FWX0JVRl82QklUX1NGLAorCVpZ
TlFNUF9ESVNQX0FWX0JVRl82QklUX1NGLAorfTsKKworc3RhdGljIGNvbnN0IHUzMiBzY2FsaW5n
X2ZhY3RvcnNfODg4W10gPSB7CisJWllOUU1QX0RJU1BfQVZfQlVGXzhCSVRfU0YsCisJWllOUU1Q
X0RJU1BfQVZfQlVGXzhCSVRfU0YsCisJWllOUU1QX0RJU1BfQVZfQlVGXzhCSVRfU0YsCit9Owor
CitzdGF0aWMgY29uc3QgdTMyIHNjYWxpbmdfZmFjdG9yc18xMDEwMTBbXSA9IHsKKwlaWU5RTVBf
RElTUF9BVl9CVUZfMTBCSVRfU0YsCisJWllOUU1QX0RJU1BfQVZfQlVGXzEwQklUX1NGLAorCVpZ
TlFNUF9ESVNQX0FWX0JVRl8xMEJJVF9TRiwKK307CisKKy8qIExpc3Qgb2YgdmlkZW8gbGF5ZXIg
Zm9ybWF0cyAqLworc3RhdGljIGNvbnN0IHN0cnVjdCB6eW5xbXBfZGlzcF9mb3JtYXQgYXZidWZf
dmlkX2ZtdHNbXSA9IHsKKwl7CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9WWVVZLAorCQkuYnVm
X2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1ZZVVksCisJCS5zd2FwCQk9IHRy
dWUsCisJCS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNfODg4LAorCX0sIHsKKwkJLmRybV9mbXQJPSBE
Uk1fRk9STUFUX1VZVlksCisJCS5idWZfZm10CT0gWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9W
SURfVllVWSwKKwkJLnN3YXAJCT0gZmFsc2UsCisJCS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNfODg4
LAorCX0sIHsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFUX1lVWVYsCisJCS5idWZfZm10CT0gWllO
UU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVVZViwKKwkJLnN3YXAJCT0gZmFsc2UsCisJCS5z
ZgkJPSBzY2FsaW5nX2ZhY3RvcnNfODg4LAorCX0sIHsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFU
X1lWWVUsCisJCS5idWZfZm10CT0gWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVVZViwK
KwkJLnN3YXAJCT0gdHJ1ZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc184ODgsCisJfSwgewor
CQkuZHJtX2ZtdAk9IERSTV9GT1JNQVRfWVVWNDIyLAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQ
X0FWX0JVRl9GTVRfTkxfVklEX1lWMTYsCisJCS5zd2FwCQk9IGZhbHNlLAorCQkuc2YJCT0gc2Nh
bGluZ19mYWN0b3JzXzg4OCwKKwl9LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9ZVlU0MjIs
CisJCS5idWZfZm10CT0gWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVYxNiwKKwkJLnN3
YXAJCT0gdHJ1ZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc184ODgsCisJfSwgeworCQkuZHJt
X2ZtdAk9IERSTV9GT1JNQVRfWVVWNDQ0LAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JV
Rl9GTVRfTkxfVklEX1lWMjQsCisJCS5zd2FwCQk9IGZhbHNlLAorCQkuc2YJCT0gc2NhbGluZ19m
YWN0b3JzXzg4OCwKKwl9LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9ZVlU0NDQsCisJCS5i
dWZfZm10CT0gWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVYyNCwKKwkJLnN3YXAJCT0g
dHJ1ZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc184ODgsCisJfSwgeworCQkuZHJtX2ZtdAk9
IERSTV9GT1JNQVRfTlYxNiwKKwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05M
X1ZJRF9ZVjE2Q0ksCisJCS5zd2FwCQk9IGZhbHNlLAorCQkuc2YJCT0gc2NhbGluZ19mYWN0b3Jz
Xzg4OCwKKwl9LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9OVjYxLAorCQkuYnVmX2ZtdAk9
IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1lWMTZDSSwKKwkJLnN3YXAJCT0gdHJ1ZSwK
KwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc184ODgsCisJfSwgeworCQkuZHJtX2ZtdAk9IERSTV9G
T1JNQVRfQkdSODg4LAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklE
X1JHQjg4OCwKKwkJLnN3YXAJCT0gZmFsc2UsCisJCS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNfODg4
LAorCX0sIHsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFUX1JHQjg4OCwKKwkJLmJ1Zl9mbXQJPSBa
WU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9SR0I4ODgsCisJCS5zd2FwCQk9IHRydWUsCisJ
CS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNfODg4LAorCX0sIHsKKwkJLmRybV9mbXQJPSBEUk1fRk9S
TUFUX1hCR1I4ODg4LAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklE
X1JHQkE4ODgwLAorCQkuc3dhcAkJPSBmYWxzZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc184
ODgsCisJfSwgeworCQkuZHJtX2ZtdAk9IERSTV9GT1JNQVRfWFJHQjg4ODgsCisJCS5idWZfZm10
CT0gWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfUkdCQTg4ODAsCisJCS5zd2FwCQk9IHRy
dWUsCisJCS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNfODg4LAorCX0sIHsKKwkJLmRybV9mbXQJPSBE
Uk1fRk9STUFUX1hCR1IyMTAxMDEwLAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9G
TVRfTkxfVklEX1JHQjg4OF8xMCwKKwkJLnN3YXAJCT0gZmFsc2UsCisJCS5zZgkJPSBzY2FsaW5n
X2ZhY3RvcnNfMTAxMDEwLAorCX0sIHsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFUX1hSR0IyMTAx
MDEwLAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1JHQjg4OF8x
MCwKKwkJLnN3YXAJCT0gdHJ1ZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc18xMDEwMTAsCisJ
fSwgeworCQkuZHJtX2ZtdAk9IERSTV9GT1JNQVRfWVVWNDIwLAorCQkuYnVmX2ZtdAk9IFpZTlFN
UF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1lWMTZfNDIwLAorCQkuc3dhcAkJPSBmYWxzZSwKKwkJ
LnNmCQk9IHNjYWxpbmdfZmFjdG9yc184ODgsCisJfSwgeworCQkuZHJtX2ZtdAk9IERSTV9GT1JN
QVRfWVZVNDIwLAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1lW
MTZfNDIwLAorCQkuc3dhcAkJPSB0cnVlLAorCQkuc2YJCT0gc2NhbGluZ19mYWN0b3JzXzg4OCwK
Kwl9LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9OVjEyLAorCQkuYnVmX2ZtdAk9IFpZTlFN
UF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1lWMTZDSV80MjAsCisJCS5zd2FwCQk9IGZhbHNlLAor
CQkuc2YJCT0gc2NhbGluZ19mYWN0b3JzXzg4OCwKKwl9LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZP
Uk1BVF9OVjIxLAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1lW
MTZDSV80MjAsCisJCS5zd2FwCQk9IHRydWUsCisJCS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNfODg4
LAorCX0sCit9OworCisvKiBMaXN0IG9mIGdyYXBoaWNzIGxheWVyIGZvcm1hdHMgKi8KK3N0YXRp
YyBjb25zdCBzdHJ1Y3QgenlucW1wX2Rpc3BfZm9ybWF0IGF2YnVmX2dmeF9mbXRzW10gPSB7CisJ
eworCQkuZHJtX2ZtdAk9IERSTV9GT1JNQVRfQUJHUjg4ODgsCisJCS5idWZfZm10CT0gWllOUU1Q
X0RJU1BfQVZfQlVGX0ZNVF9OTF9HRlhfUkdCQTg4ODgsCisJCS5zd2FwCQk9IGZhbHNlLAorCQku
c2YJCT0gc2NhbGluZ19mYWN0b3JzXzg4OCwKKwl9LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1B
VF9BUkdCODg4OCwKKwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX0dGWF9S
R0JBODg4OCwKKwkJLnN3YXAJCT0gdHJ1ZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc184ODgs
CisJfSwgeworCQkuZHJtX2ZtdAk9IERSTV9GT1JNQVRfUkdCQTg4ODgsCisJCS5idWZfZm10CT0g
WllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9HRlhfQUJHUjg4ODgsCisJCS5zd2FwCQk9IGZhbHNl
LAorCQkuc2YJCT0gc2NhbGluZ19mYWN0b3JzXzg4OCwKKwl9LCB7CisJCS5kcm1fZm10CT0gRFJN
X0ZPUk1BVF9CR1JBODg4OCwKKwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05M
X0dGWF9BQkdSODg4OCwKKwkJLnN3YXAJCT0gdHJ1ZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9y
c184ODgsCisJfSwgeworCQkuZHJtX2ZtdAk9IERSTV9GT1JNQVRfQkdSODg4LAorCQkuYnVmX2Zt
dAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfR0ZYX1JHQjg4OCwKKwkJLnN3YXAJCT0gZmFs
c2UsCisJCS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNfODg4LAorCX0sIHsKKwkJLmRybV9mbXQJPSBE
Uk1fRk9STUFUX1JHQjg4OCwKKwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05M
X0dGWF9CR1I4ODgsCisJCS5zd2FwCQk9IGZhbHNlLAorCQkuc2YJCT0gc2NhbGluZ19mYWN0b3Jz
Xzg4OCwKKwl9LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9SR0JBNTU1MSwKKwkJLmJ1Zl9m
bXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX0dGWF9SR0JBNTU1MSwKKwkJLnN3YXAJCT0g
ZmFsc2UsCisJCS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNfNTU1LAorCX0sIHsKKwkJLmRybV9mbXQJ
PSBEUk1fRk9STUFUX0JHUkE1NTUxLAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9G
TVRfTkxfR0ZYX1JHQkE1NTUxLAorCQkuc3dhcAkJPSB0cnVlLAorCQkuc2YJCT0gc2NhbGluZ19m
YWN0b3JzXzU1NSwKKwl9LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9SR0JBNDQ0NCwKKwkJ
LmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX0dGWF9SR0JBNDQ0NCwKKwkJLnN3
YXAJCT0gZmFsc2UsCisJCS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNfNDQ0LAorCX0sIHsKKwkJLmRy
bV9mbXQJPSBEUk1fRk9STUFUX0JHUkE0NDQ0LAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FW
X0JVRl9GTVRfTkxfR0ZYX1JHQkE0NDQ0LAorCQkuc3dhcAkJPSB0cnVlLAorCQkuc2YJCT0gc2Nh
bGluZ19mYWN0b3JzXzQ0NCwKKwl9LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9SR0I1NjUs
CisJCS5idWZfZm10CT0gWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9HRlhfUkdCNTY1LAorCQku
c3dhcAkJPSBmYWxzZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc181NjUsCisJfSwgeworCQku
ZHJtX2ZtdAk9IERSTV9GT1JNQVRfQkdSNTY1LAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FW
X0JVRl9GTVRfTkxfR0ZYX1JHQjU2NSwKKwkJLnN3YXAJCT0gdHJ1ZSwKKwkJLnNmCQk9IHNjYWxp
bmdfZmFjdG9yc181NjUsCisJfSwKK307CisKK3N0YXRpYyB1MzIgenlucW1wX2Rpc3BfYXZidWZf
cmVhZChzdHJ1Y3QgenlucW1wX2Rpc3BfYXZidWYgKmF2YnVmLCBpbnQgcmVnKQoreworCXJldHVy
biByZWFkbChhdmJ1Zi0+YmFzZSArIHJlZyk7Cit9CisKK3N0YXRpYyB2b2lkIHp5bnFtcF9kaXNw
X2F2YnVmX3dyaXRlKHN0cnVjdCB6eW5xbXBfZGlzcF9hdmJ1ZiAqYXZidWYsCisJCQkJICAgIGlu
dCByZWcsIHUzMiB2YWwpCit7CisJd3JpdGVsKHZhbCwgYXZidWYtPmJhc2UgKyByZWcpOworfQor
CisvKioKKyAqIHp5bnFtcF9kaXNwX2F2YnVmX3NldF9mb3JtYXQgLSBTZXQgdGhlIGlucHV0IGZv
cm1hdCBmb3IgYSBsYXllcgorICogQGF2YnVmOiBBdWRpby92aWRlbyBidWZmZXIgbWFuYWdlcgor
ICogQGxheWVyOiBUaGUgbGF5ZXIgSUQKKyAqIEBmbXQ6IFRoZSBmb3JtYXQgaW5mb3JtYXRpb24K
KyAqCisgKiBTZXQgdGhlIHZpZGVvIGJ1ZmZlciBtYW5hZ2VyIGZvcm1hdCBmb3IgQGxheWVyIHRv
IEBmbXQuCisgKi8KK3N0YXRpYyB2b2lkIHp5bnFtcF9kaXNwX2F2YnVmX3NldF9mb3JtYXQoc3Ry
dWN0IHp5bnFtcF9kaXNwX2F2YnVmICphdmJ1ZiwKKwkJCQkJIGVudW0genlucW1wX2Rpc3BfbGF5
ZXJfaWQgbGF5ZXIsCisJCQkJCSBjb25zdCBzdHJ1Y3QgenlucW1wX2Rpc3BfZm9ybWF0ICpmbXQp
Cit7CisJdW5zaWduZWQgaW50IGk7CisJdTMyIHZhbDsKKworCXZhbCA9IHp5bnFtcF9kaXNwX2F2
YnVmX3JlYWQoYXZidWYsIFpZTlFNUF9ESVNQX0FWX0JVRl9GTVQpOworCXZhbCAmPSBsYXllciA9
PSBaWU5RTVBfRElTUF9MQVlFUl9WSUQKKwkgICAgPyB+WllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9O
TF9WSURfTUFTSworCSAgICA6IH5aWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX0dGWF9NQVNLOwor
CXZhbCB8PSBmbXQtPmJ1Zl9mbXQ7CisJenlucW1wX2Rpc3BfYXZidWZfd3JpdGUoYXZidWYsIFpZ
TlFNUF9ESVNQX0FWX0JVRl9GTVQsIHZhbCk7CisKKwlmb3IgKGkgPSAwOyBpIDwgWllOUU1QX0RJ
U1BfQVZfQlVGX05VTV9TRjsgaSsrKSB7CisJCXVuc2lnbmVkIGludCByZWcgPSBsYXllciA9PSBa
WU5RTVBfRElTUF9MQVlFUl9WSUQKKwkJCQkgPyBaWU5RTVBfRElTUF9BVl9CVUZfVklEX0NPTVBf
U0YoaSkKKwkJCQkgOiBaWU5RTVBfRElTUF9BVl9CVUZfR0ZYX0NPTVBfU0YoaSk7CisKKwkJenlu
cW1wX2Rpc3BfYXZidWZfd3JpdGUoYXZidWYsIHJlZywgZm10LT5zZltpXSk7CisJfQorfQorCisv
KioKKyAqIHp5bnFtcF9kaXNwX2F2YnVmX3NldF9jbG9ja3Nfc291cmNlcyAtIFNldCB0aGUgY2xv
Y2tzIHNvdXJjZXMKKyAqIEBhdmJ1ZjogQXVkaW8vdmlkZW8gYnVmZmVyIG1hbmFnZXIKKyAqIEB2
aWRlb19mcm9tX3BzOiBUcnVlIGlmIHRoZSB2aWRlbyBjbG9jayBvcmlnaW5hdGVzIGZyb20gdGhl
IFBTCisgKiBAYXVkaW9fZnJvbV9wczogVHJ1ZSBpZiB0aGUgYXVkaW8gY2xvY2sgb3JpZ2luYXRl
cyBmcm9tIHRoZSBQUworICogQHRpbWluZ3NfaW50ZXJuYWw6IFRydWUgaWYgdmlkZW8gdGltaW5n
cyBhcmUgZ2VuZXJhdGVkIGludGVybmFsbHkKKyAqCisgKiBTZXQgdGhlIHNvdXJjZSBmb3IgdGhl
IHZpZGVvIGFuZCBhdWRpbyBjbG9ja3MsIGFzIHdlbGwgYXMgZm9yIHRoZSB2aWRlbworICogdGlt
aW5ncy4gQ2xvY2tzIGNhbiBvcmlnaW5hdGUgZnJvbSB0aGUgUFMgb3IgUEwsIGFuZCB0aW1pbmdz
IGNhbiBiZQorICogZ2VuZXJhdGVkIGludGVybmFsbHkgb3IgZXh0ZXJuYWxseS4KKyAqLworc3Rh
dGljIHZvaWQKK3p5bnFtcF9kaXNwX2F2YnVmX3NldF9jbG9ja3Nfc291cmNlcyhzdHJ1Y3Qgenlu
cW1wX2Rpc3BfYXZidWYgKmF2YnVmLAorCQkJCSAgICAgYm9vbCB2aWRlb19mcm9tX3BzLCBib29s
IGF1ZGlvX2Zyb21fcHMsCisJCQkJICAgICBib29sIHRpbWluZ3NfaW50ZXJuYWwpCit7CisJdTMy
IHZhbCA9IDA7CisKKwlpZiAodmlkZW9fZnJvbV9wcykKKwkJdmFsIHw9IFpZTlFNUF9ESVNQX0FW
X0JVRl9DTEtfU1JDX1ZJRF9GUk9NX1BTOworCWlmIChhdWRpb19mcm9tX3BzKQorCQl2YWwgfD0g
WllOUU1QX0RJU1BfQVZfQlVGX0NMS19TUkNfQVVEX0ZST01fUFM7CisJaWYgKHRpbWluZ3NfaW50
ZXJuYWwpCisJCXZhbCB8PSBaWU5RTVBfRElTUF9BVl9CVUZfQ0xLX1NSQ19WSURfSU5URVJOQUxf
VElNSU5HOworCisJenlucW1wX2Rpc3BfYXZidWZfd3JpdGUoYXZidWYsIFpZTlFNUF9ESVNQX0FW
X0JVRl9DTEtfU1JDLCB2YWwpOworfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2F2YnVmX2VuYWJs
ZV9jaGFubmVscyAtIEVuYWJsZSBidWZmZXIgY2hhbm5lbHMKKyAqIEBhdmJ1ZjogQXVkaW8vdmlk
ZW8gYnVmZmVyIG1hbmFnZXIKKyAqCisgKiBFbmFibGUgYWxsICh2aWRlbyBhbmQgYXVkaW8pIGJ1
ZmZlciBjaGFubmVscy4KKyAqLworc3RhdGljIHZvaWQgenlucW1wX2Rpc3BfYXZidWZfZW5hYmxl
X2NoYW5uZWxzKHN0cnVjdCB6eW5xbXBfZGlzcF9hdmJ1ZiAqYXZidWYpCit7CisJdW5zaWduZWQg
aW50IGk7CisJdTMyIHZhbDsKKworCXZhbCA9IFpZTlFNUF9ESVNQX0FWX0JVRl9DSEJVRl9FTiB8
CisJICAgICAgKFpZTlFNUF9ESVNQX0FWX0JVRl9DSEJVRl9CVVJTVF9MRU5fTUFYIDw8CisJICAg
ICAgIFpZTlFNUF9ESVNQX0FWX0JVRl9DSEJVRl9CVVJTVF9MRU5fU0hJRlQpOworCisJZm9yIChp
ID0gMDsgaSA8IFpZTlFNUF9ESVNQX0FWX0JVRl9OVU1fVklEX0dGWF9CVUZGRVJTOyBpKyspCisJ
CXp5bnFtcF9kaXNwX2F2YnVmX3dyaXRlKGF2YnVmLCBaWU5RTVBfRElTUF9BVl9CVUZfQ0hCVUYo
aSksCisJCQkJCXZhbCk7CisKKwl2YWwgPSBaWU5RTVBfRElTUF9BVl9CVUZfQ0hCVUZfRU4gfAor
CSAgICAgIChaWU5RTVBfRElTUF9BVl9CVUZfQ0hCVUZfQlVSU1RfTEVOX0FVRF9NQVggPDwKKwkg
ICAgICAgWllOUU1QX0RJU1BfQVZfQlVGX0NIQlVGX0JVUlNUX0xFTl9TSElGVCk7CisKKwlmb3Ig
KDsgaSA8IFpZTlFNUF9ESVNQX0FWX0JVRl9OVU1fQlVGRkVSUzsgaSsrKQorCQl6eW5xbXBfZGlz
cF9hdmJ1Zl93cml0ZShhdmJ1ZiwgWllOUU1QX0RJU1BfQVZfQlVGX0NIQlVGKGkpLAorCQkJCQl2
YWwpOworfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2F2YnVmX2Rpc2FibGVfY2hhbm5lbHMgLSBE
aXNhYmxlIGJ1ZmZlciBjaGFubmVscworICogQGF2YnVmOiBBdWRpby92aWRlbyBidWZmZXIgbWFu
YWdlcgorICoKKyAqIERpc2FibGUgYWxsICh2aWRlbyBhbmQgYXVkaW8pIGJ1ZmZlciBjaGFubmVs
cy4KKyAqLworc3RhdGljIHZvaWQgenlucW1wX2Rpc3BfYXZidWZfZGlzYWJsZV9jaGFubmVscyhz
dHJ1Y3QgenlucW1wX2Rpc3BfYXZidWYgKmF2YnVmKQoreworCXVuc2lnbmVkIGludCBpOworCisJ
Zm9yIChpID0gMDsgaSA8IFpZTlFNUF9ESVNQX0FWX0JVRl9OVU1fQlVGRkVSUzsgaSsrKQorCQl6
eW5xbXBfZGlzcF9hdmJ1Zl93cml0ZShhdmJ1ZiwgWllOUU1QX0RJU1BfQVZfQlVGX0NIQlVGKGkp
LAorCQkJCQlaWU5RTVBfRElTUF9BVl9CVUZfQ0hCVUZfRkxVU0gpOworfQorCisvKioKKyAqIHp5
bnFtcF9kaXNwX2F2YnVmX2VuYWJsZV9hdWRpbyAtIEVuYWJsZSBhdWRpbworICogQGF2YnVmOiBB
dWRpby92aWRlbyBidWZmZXIgbWFuYWdlcgorICoKKyAqIEVuYWJsZSBhbGwgYXVkaW8gYnVmZmVy
cyB3aXRoIGEgbm9uLWxpdmUgKG1lbW9yeSkgc291cmNlLgorICovCitzdGF0aWMgdm9pZCB6eW5x
bXBfZGlzcF9hdmJ1Zl9lbmFibGVfYXVkaW8oc3RydWN0IHp5bnFtcF9kaXNwX2F2YnVmICphdmJ1
ZikKK3sKKwl1MzIgdmFsOworCisJdmFsID0genlucW1wX2Rpc3BfYXZidWZfcmVhZChhdmJ1Ziwg
WllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVCk7CisJdmFsICY9IH5aWU5RTVBfRElTUF9BVl9CVUZf
T1VUUFVUX0FVRDFfTUFTSzsKKwl2YWwgfD0gWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9BVUQx
X01FTTsKKwl2YWwgfD0gWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9BVUQyX0VOOworCXp5bnFt
cF9kaXNwX2F2YnVmX3dyaXRlKGF2YnVmLCBaWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVULCB2YWwp
OworfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2F2YnVmX2Rpc2FibGVfYXVkaW8gLSBEaXNhYmxl
IGF1ZGlvCisgKiBAYXZidWY6IEF1ZGlvL3ZpZGVvIGJ1ZmZlciBtYW5hZ2VyCisgKgorICogRGlz
YWJsZSBhbGwgYXVkaW8gYnVmZmVycy4KKyAqLworc3RhdGljIHZvaWQgenlucW1wX2Rpc3BfYXZi
dWZfZGlzYWJsZV9hdWRpbyhzdHJ1Y3QgenlucW1wX2Rpc3BfYXZidWYgKmF2YnVmKQoreworCXUz
MiB2YWw7CisKKwl2YWwgPSB6eW5xbXBfZGlzcF9hdmJ1Zl9yZWFkKGF2YnVmLCBaWU5RTVBfRElT
UF9BVl9CVUZfT1VUUFVUKTsKKwl2YWwgJj0gflpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfQVVE
MV9NQVNLOworCXZhbCB8PSBaWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVUX0FVRDFfRElTQUJMRTsK
Kwl2YWwgJj0gflpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfQVVEMl9FTjsKKwl6eW5xbXBfZGlz
cF9hdmJ1Zl93cml0ZShhdmJ1ZiwgWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVCwgdmFsKTsKK30K
KworLyoqCisgKiB6eW5xbXBfZGlzcF9hdmJ1Zl9lbmFibGVfdmlkZW8gLSBFbmFibGUgYSB2aWRl
byBsYXllcgorICogQGF2YnVmOiBBdWRpby92aWRlbyBidWZmZXIgbWFuYWdlcgorICogQGxheWVy
OiBUaGUgbGF5ZXIgSUQKKyAqIEBtb2RlOiBPcGVyYXRpbmcgbW9kZSBvZiBsYXllcgorICoKKyAq
IEVuYWJsZSB0aGUgdmlkZW8vZ3JhcGhpY3MgYnVmZmVyIGZvciBAbGF5ZXIuCisgKi8KK3N0YXRp
YyB2b2lkIHp5bnFtcF9kaXNwX2F2YnVmX2VuYWJsZV92aWRlbyhzdHJ1Y3QgenlucW1wX2Rpc3Bf
YXZidWYgKmF2YnVmLAorCQkJCQkgICBlbnVtIHp5bnFtcF9kaXNwX2xheWVyX2lkIGxheWVyLAor
CQkJCQkgICBlbnVtIHp5bnFtcF9kaXNwX2xheWVyX21vZGUgbW9kZSkKK3sKKwl1MzIgdmFsOwor
CisJdmFsID0genlucW1wX2Rpc3BfYXZidWZfcmVhZChhdmJ1ZiwgWllOUU1QX0RJU1BfQVZfQlVG
X09VVFBVVCk7CisJaWYgKGxheWVyID09IFpZTlFNUF9ESVNQX0xBWUVSX1ZJRCkgeworCQl2YWwg
Jj0gflpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfVklEMV9NQVNLOworCQlpZiAobW9kZSA9PSBa
WU5RTVBfRElTUF9MQVlFUl9OT05MSVZFKQorCQkJdmFsIHw9IFpZTlFNUF9ESVNQX0FWX0JVRl9P
VVRQVVRfVklEMV9NRU07CisJCWVsc2UKKwkJCXZhbCB8PSBaWU5RTVBfRElTUF9BVl9CVUZfT1VU
UFVUX1ZJRDFfTElWRTsKKwl9IGVsc2UgeworCQl2YWwgJj0gflpZTlFNUF9ESVNQX0FWX0JVRl9P
VVRQVVRfVklEMl9NQVNLOworCQl2YWwgfD0gWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9WSUQy
X01FTTsKKwkJaWYgKG1vZGUgPT0gWllOUU1QX0RJU1BfTEFZRVJfTk9OTElWRSkKKwkJCXZhbCB8
PSBaWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVUX1ZJRDJfTUVNOworCQllbHNlCisJCQl2YWwgfD0g
WllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9WSUQyX0xJVkU7CisJfQorCXp5bnFtcF9kaXNwX2F2
YnVmX3dyaXRlKGF2YnVmLCBaWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVULCB2YWwpOworfQorCisv
KioKKyAqIHp5bnFtcF9kaXNwX2F2YnVmX2Rpc2FibGVfdmlkZW8gLSBEaXNhYmxlIGEgdmlkZW8g
bGF5ZXIKKyAqIEBhdmJ1ZjogQXVkaW8vdmlkZW8gYnVmZmVyIG1hbmFnZXIKKyAqIEBsYXllcjog
VGhlIGxheWVyIElECisgKgorICogRGlzYWJsZSB0aGUgdmlkZW8vZ3JhcGhpY3MgYnVmZmVyIGZv
ciBAbGF5ZXIuCisgKi8KK3N0YXRpYyB2b2lkIHp5bnFtcF9kaXNwX2F2YnVmX2Rpc2FibGVfdmlk
ZW8oc3RydWN0IHp5bnFtcF9kaXNwX2F2YnVmICphdmJ1ZiwKKwkJCQkJICAgIGVudW0genlucW1w
X2Rpc3BfbGF5ZXJfaWQgbGF5ZXIpCit7CisJdTMyIHZhbDsKKworCXZhbCA9IHp5bnFtcF9kaXNw
X2F2YnVmX3JlYWQoYXZidWYsIFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVQpOworCWlmIChsYXll
ciA9PSBaWU5RTVBfRElTUF9MQVlFUl9WSUQpIHsKKwkJdmFsICY9IH5aWU5RTVBfRElTUF9BVl9C
VUZfT1VUUFVUX1ZJRDFfTUFTSzsKKwkJdmFsIHw9IFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRf
VklEMV9OT05FOworCX0gZWxzZSB7CisJCXZhbCAmPSB+WllOUU1QX0RJU1BfQVZfQlVGX09VVFBV
VF9WSUQyX01BU0s7CisJCXZhbCB8PSBaWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVUX1ZJRDJfRElT
QUJMRTsKKwl9CisJenlucW1wX2Rpc3BfYXZidWZfd3JpdGUoYXZidWYsIFpZTlFNUF9ESVNQX0FW
X0JVRl9PVVRQVVQsIHZhbCk7Cit9CisKKy8qKgorICogenlucW1wX2Rpc3BfYXZidWZfZW5hYmxl
IC0gRW5hYmxlIHRoZSB2aWRlbyBwaXBlCisgKiBAYXZidWY6IEF1ZGlvL3ZpZGVvIGJ1ZmZlciBt
YW5hZ2VyCisgKgorICogRGUtYXNzZXJ0IHRoZSB2aWRlbyBwaXBlIHJlc2V0LgorICovCitzdGF0
aWMgdm9pZCB6eW5xbXBfZGlzcF9hdmJ1Zl9lbmFibGUoc3RydWN0IHp5bnFtcF9kaXNwX2F2YnVm
ICphdmJ1ZikKK3sKKwl6eW5xbXBfZGlzcF9hdmJ1Zl93cml0ZShhdmJ1ZiwgWllOUU1QX0RJU1Bf
QVZfQlVGX1NSU1RfUkVHLCAwKTsKK30KKworLyoqCisgKiB6eW5xbXBfZGlzcF9hdmJ1Zl9kaXNh
YmxlIC0gRGlzYWJsZSB0aGUgdmlkZW8gcGlwZQorICogQGF2YnVmOiBBdWRpby92aWRlbyBidWZm
ZXIgbWFuYWdlcgorICoKKyAqIEFzc2VydCB0aGUgdmlkZW8gcGlwZSByZXNldC4KKyAqLworc3Rh
dGljIHZvaWQgenlucW1wX2Rpc3BfYXZidWZfZGlzYWJsZShzdHJ1Y3QgenlucW1wX2Rpc3BfYXZi
dWYgKmF2YnVmKQoreworCXp5bnFtcF9kaXNwX2F2YnVmX3dyaXRlKGF2YnVmLCBaWU5RTVBfRElT
UF9BVl9CVUZfU1JTVF9SRUcsCisJCQkJWllOUU1QX0RJU1BfQVZfQlVGX1NSU1RfUkVHX1ZJRF9S
U1QpOworfQorCisvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICogQmxlbmRlciAoVmlkZW8gUGlw
ZWxpbmUpCisgKi8KKworc3RhdGljIHZvaWQgenlucW1wX2Rpc3BfYmxlbmRfd3JpdGUoc3RydWN0
IHp5bnFtcF9kaXNwX2JsZW5kICpibGVuZCwKKwkJCQkgICAgaW50IHJlZywgdTMyIHZhbCkKK3sK
Kwl3cml0ZWwodmFsLCBibGVuZC0+YmFzZSArIHJlZyk7Cit9CisKKy8qCisgKiBDb2xvcnNwYWNl
IGNvbnZlcnNpb24gbWF0cmljZXMuCisgKgorICogSGFyZGNvZGUgUkdCIDwtPiBZVVYgY29udmVy
c2lvbiB0byBmdWxsLXJhbmdlIFNEVFYgZm9yIG5vdy4KKyAqLworc3RhdGljIGNvbnN0IHUxNiBj
c2NfemVyb19tYXRyaXhbXSA9IHsKKwkweDAsICAgIDB4MCwgICAgMHgwLAorCTB4MCwgICAgMHgw
LCAgICAweDAsCisJMHgwLCAgICAweDAsICAgIDB4MAorfTsKKworc3RhdGljIGNvbnN0IHUxNiBj
c2NfaWRlbnRpdHlfbWF0cml4W10gPSB7CisJMHgxMDAwLCAweDAsICAgIDB4MCwKKwkweDAsICAg
IDB4MTAwMCwgMHgwLAorCTB4MCwgICAgMHgwLCAgICAweDEwMDAKK307CisKK3N0YXRpYyBjb25z
dCB1MzIgY3NjX3plcm9fb2Zmc2V0c1tdID0geworCTAsIDAsIDAKK307CisKK3N0YXRpYyBjb25z
dCB1MTYgY3NjX3JnYl90b19zZHR2X21hdHJpeFtdID0geworCTB4NGM5LCAgMHg4NjQsICAweDFk
MywKKwkweDdkNGQsIDB4N2FiMywgMHg4MDAsCisJMHg4MDAsICAweDc5NGQsIDB4N2ViMworfTsK
Kworc3RhdGljIGNvbnN0IHUzMiBjc2NfcmdiX3RvX3NkdHZfb2Zmc2V0c1tdID0geworCTB4MCwg
MHg4MDAwMDAwLCAweDgwMDAwMDAKK307CisKK3N0YXRpYyBjb25zdCB1MTYgY3NjX3NkdHZfdG9f
cmdiX21hdHJpeFtdID0geworCTB4MTAwMCwgMHgxNjZmLCAweDAsCisJMHgxMDAwLCAweDc0ODMs
IDB4N2E3ZiwKKwkweDEwMDAsIDB4MCwgICAgMHgxYzVhCit9OworCitzdGF0aWMgY29uc3QgdTMy
IGNzY19zZHR2X3RvX3JnYl9vZmZzZXRzW10gPSB7CisJMHgwLCAweDE4MDAsIDB4MTgwMAorfTsK
KworLyoqCisgKiB6eW5xbXBfZGlzcF9ibGVuZF9zZXRfb3V0cHV0X2Zvcm1hdCAtIFNldCB0aGUg
b3V0cHV0IGZvcm1hdCBvZiB0aGUgYmxlbmRlcgorICogQGJsZW5kOiBCbGVuZGVyIG9iamVjdAor
ICogQGZvcm1hdDogT3V0cHV0IGZvcm1hdAorICoKKyAqIFNldCB0aGUgb3V0cHV0IGZvcm1hdCBv
ZiB0aGUgYmxlbmRlciB0byBAZm9ybWF0LgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9i
bGVuZF9zZXRfb3V0cHV0X2Zvcm1hdChzdHJ1Y3QgenlucW1wX2Rpc3BfYmxlbmQgKmJsZW5kLAor
CQkJCQkJZW51bSB6eW5xbXBfZHBzdWJfZm9ybWF0IGZvcm1hdCkKK3sKKwlzdGF0aWMgY29uc3Qg
dW5zaWduZWQgaW50IGJsZW5kX291dHB1dF9mbXRzW10gPSB7CisJCVtaWU5RTVBfRFBTVUJfRk9S
TUFUX1JHQl0gPSBaWU5RTVBfRElTUF9WX0JMRU5EX09VVFBVVF9WSURfRk1UX1JHQiwKKwkJW1pZ
TlFNUF9EUFNVQl9GT1JNQVRfWUNSQ0I0NDRdID0gWllOUU1QX0RJU1BfVl9CTEVORF9PVVRQVVRf
VklEX0ZNVF9ZQ0JDUjQ0NCwKKwkJW1pZTlFNUF9EUFNVQl9GT1JNQVRfWUNSQ0I0MjJdID0gWllO
UU1QX0RJU1BfVl9CTEVORF9PVVRQVVRfVklEX0ZNVF9ZQ0JDUjQyMgorCQkJCQkgICAgICAgfCBa
WU5RTVBfRElTUF9WX0JMRU5EX09VVFBVVF9WSURfRk1UX0VOX0RPV05TQU1QTEUsCisJCVtaWU5R
TVBfRFBTVUJfRk9STUFUX1lPTkxZXSA9IFpZTlFNUF9ESVNQX1ZfQkxFTkRfT1VUUFVUX1ZJRF9G
TVRfWU9OTFksCisJfTsKKworCXUzMiBmbXQgPSBibGVuZF9vdXRwdXRfZm10c1tmb3JtYXRdOwor
CWNvbnN0IHUxNiAqY29lZmZzOworCWNvbnN0IHUzMiAqb2Zmc2V0czsKKwl1bnNpZ25lZCBpbnQg
aTsKKworCXp5bnFtcF9kaXNwX2JsZW5kX3dyaXRlKGJsZW5kLCBaWU5RTVBfRElTUF9WX0JMRU5E
X09VVFBVVF9WSURfRk1ULCBmbXQpOworCWlmIChmbXQgPT0gWllOUU1QX0RJU1BfVl9CTEVORF9P
VVRQVVRfVklEX0ZNVF9SR0IpIHsKKwkJY29lZmZzID0gY3NjX2lkZW50aXR5X21hdHJpeDsKKwkJ
b2Zmc2V0cyA9IGNzY196ZXJvX29mZnNldHM7CisJfSBlbHNlIHsKKwkJY29lZmZzID0gY3NjX3Jn
Yl90b19zZHR2X21hdHJpeDsKKwkJb2Zmc2V0cyA9IGNzY19yZ2JfdG9fc2R0dl9vZmZzZXRzOwor
CX0KKworCWZvciAoaSA9IDA7IGkgPCBaWU5RTVBfRElTUF9WX0JMRU5EX05VTV9DT0VGRjsgaSsr
KQorCQl6eW5xbXBfZGlzcF9ibGVuZF93cml0ZShibGVuZCwKKwkJCQkJWllOUU1QX0RJU1BfVl9C
TEVORF9SR0IyWUNCQ1JfQ09FRkYoaSksCisJCQkJCWNvZWZmc1tpXSk7CisKKwlmb3IgKGkgPSAw
OyBpIDwgWllOUU1QX0RJU1BfVl9CTEVORF9OVU1fT0ZGU0VUOyBpKyspCisJCXp5bnFtcF9kaXNw
X2JsZW5kX3dyaXRlKGJsZW5kLAorCQkJCQlaWU5RTVBfRElTUF9WX0JMRU5EX09VVENTQ19PRkZT
RVQoaSksCisJCQkJCW9mZnNldHNbaV0pOworfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2JsZW5k
X3NldF9iZ19jb2xvciAtIFNldCB0aGUgYmFja2dyb3VuZCBjb2xvcgorICogQGJsZW5kOiBCbGVu
ZGVyIG9iamVjdAorICogQHJjcjogUmVkL0NyIGNvbG9yIGNvbXBvbmVudAorICogQGd5OiBHcmVl
bi9ZIGNvbG9yIGNvbXBvbmVudAorICogQGJjYjogQmx1ZS9DYiBjb2xvciBjb21wb25lbnQKKyAq
CisgKiBTZXQgdGhlIGJhY2tncm91bmQgY29sb3IgdG8gKEByY3IsIEBneSwgQGJjYiksIGNvcnJl
c3BvbmRpbmcgdG8gdGhlIFIsIEcgYW5kCisgKiBCIG9yIENyLCBZIGFuZCBDYiBjb21wb25lbnRz
IHJlc3BlY3RpdmVseSBkZXBlbmRpbmcgb24gdGhlIHNlbGVjdGVkIG91dHB1dAorICogZm9ybWF0
LgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9ibGVuZF9zZXRfYmdfY29sb3Ioc3RydWN0
IHp5bnFtcF9kaXNwX2JsZW5kICpibGVuZCwKKwkJCQkJICAgdTMyIHJjciwgdTMyIGd5LCB1MzIg
YmNiKQoreworCXp5bnFtcF9kaXNwX2JsZW5kX3dyaXRlKGJsZW5kLCBaWU5RTVBfRElTUF9WX0JM
RU5EX0JHX0NMUl8wLCByY3IpOworCXp5bnFtcF9kaXNwX2JsZW5kX3dyaXRlKGJsZW5kLCBaWU5R
TVBfRElTUF9WX0JMRU5EX0JHX0NMUl8xLCBneSk7CisJenlucW1wX2Rpc3BfYmxlbmRfd3JpdGUo
YmxlbmQsIFpZTlFNUF9ESVNQX1ZfQkxFTkRfQkdfQ0xSXzIsIGJjYik7Cit9CisKKy8qKgorICog
enlucW1wX2Rpc3BfYmxlbmRfc2V0X2dsb2JhbF9hbHBoYSAtIENvbmZpZ3VyZSBnbG9iYWwgYWxw
aGEgYmxlbmRpbmcKKyAqIEBibGVuZDogQmxlbmRlciBvYmplY3QKKyAqIEBlbmFibGU6IFRydWUg
dG8gZW5hYmxlIGdsb2JhbCBhbHBoYSBibGVuZGluZworICogQGFscGhhOiBHbG9iYWwgYWxwaGEg
dmFsdWUgKGlnbm9yZWQgaWYgQGVuYWJsZWQgaXMgZmFsc2UpCisgKi8KK3N0YXRpYyB2b2lkIHp5
bnFtcF9kaXNwX2JsZW5kX3NldF9nbG9iYWxfYWxwaGEoc3RydWN0IHp5bnFtcF9kaXNwX2JsZW5k
ICpibGVuZCwKKwkJCQkJICAgICAgIGJvb2wgZW5hYmxlLCB1MzIgYWxwaGEpCit7CisJenlucW1w
X2Rpc3BfYmxlbmRfd3JpdGUoYmxlbmQsIFpZTlFNUF9ESVNQX1ZfQkxFTkRfU0VUX0dMT0JBTF9B
TFBIQSwKKwkJCQlaWU5RTVBfRElTUF9WX0JMRU5EX1NFVF9HTE9CQUxfQUxQSEFfVkFMVUUoYWxw
aGEpIHwKKwkJCQkoZW5hYmxlID8gWllOUU1QX0RJU1BfVl9CTEVORF9TRVRfR0xPQkFMX0FMUEhB
X0VOIDogMCkpOworfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2JsZW5kX2xheWVyX3NldF9jc2Mg
LSBDb25maWd1cmUgY29sb3JzcGFjZSBjb252ZXJzaW9uIGZvciBsYXllcgorICogQGJsZW5kOiBC
bGVuZGVyIG9iamVjdAorICogQGxheWVyOiBUaGUgbGF5ZXIKKyAqIEBjb2VmZnM6IENvbG9yc3Bh
Y2UgY29udmVyc2lvbiBtYXRyaXgKKyAqIEBvZmZzZXRzOiBDb2xvcnNwYWNlIGNvbnZlcnNpb24g
b2Zmc2V0cworICoKKyAqIENvbmZpZ3VyZSB0aGUgaW5wdXQgY29sb3JzcGFjZSBjb252ZXJzaW9u
IG1hdHJpeCBhbmQgb2Zmc2V0cyBmb3IgdGhlIEBsYXllci4KKyAqIENvbHVtbnMgb2YgdGhlIG1h
dHJpeCBhcmUgYXV0b21hdGljYWxseSBzd2FwcGVkIGJhc2VkIG9uIHRoZSBpbnB1dCBmb3JtYXQg
dG8KKyAqIGhhbmRsZSBSR0IgYW5kIFlDckNiIGNvbXBvbmVudHMgcGVybXV0YXRpb25zLgorICov
CitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9ibGVuZF9sYXllcl9zZXRfY3NjKHN0cnVjdCB6eW5x
bXBfZGlzcF9ibGVuZCAqYmxlbmQsCisJCQkJCSAgICBzdHJ1Y3QgenlucW1wX2Rpc3BfbGF5ZXIg
KmxheWVyLAorCQkJCQkgICAgY29uc3QgdTE2ICpjb2VmZnMsCisJCQkJCSAgICBjb25zdCB1MzIg
Km9mZnNldHMpCit7CisJdW5zaWduZWQgaW50IHN3YXBbM10gPSB7IDAsIDEsIDIgfTsKKwl1bnNp
Z25lZCBpbnQgcmVnOworCXVuc2lnbmVkIGludCBpOworCisJaWYgKGxheWVyLT5kaXNwX2ZtdC0+
c3dhcCkgeworCQlpZiAobGF5ZXItPmRybV9mbXQtPmlzX3l1dikgeworCQkJLyogU3dhcCBVIGFu
ZCBWLiAqLworCQkJc3dhcFsxXSA9IDI7CisJCQlzd2FwWzJdID0gMTsKKwkJfSBlbHNlIHsKKwkJ
CS8qIFN3YXAgUiBhbmQgQi4gKi8KKwkJCXN3YXBbMF0gPSAyOworCQkJc3dhcFsyXSA9IDA7CisJ
CX0KKwl9CisKKwlpZiAobGF5ZXItPmlkID09IFpZTlFNUF9ESVNQX0xBWUVSX1ZJRCkKKwkJcmVn
ID0gWllOUU1QX0RJU1BfVl9CTEVORF9JTjFDU0NfQ09FRkYoMCk7CisJZWxzZQorCQlyZWcgPSBa
WU5RTVBfRElTUF9WX0JMRU5EX0lOMkNTQ19DT0VGRigwKTsKKworCWZvciAoaSA9IDA7IGkgPCBa
WU5RTVBfRElTUF9WX0JMRU5EX05VTV9DT0VGRjsgaSArPSAzLCByZWcgKz0gMTIpIHsKKwkJenlu
cW1wX2Rpc3BfYmxlbmRfd3JpdGUoYmxlbmQsIHJlZyArIDAsIGNvZWZmc1tpICsgc3dhcFswXV0p
OworCQl6eW5xbXBfZGlzcF9ibGVuZF93cml0ZShibGVuZCwgcmVnICsgNCwgY29lZmZzW2kgKyBz
d2FwWzFdXSk7CisJCXp5bnFtcF9kaXNwX2JsZW5kX3dyaXRlKGJsZW5kLCByZWcgKyA4LCBjb2Vm
ZnNbaSArIHN3YXBbMl1dKTsKKwl9CisKKwlpZiAobGF5ZXItPmlkID09IFpZTlFNUF9ESVNQX0xB
WUVSX1ZJRCkKKwkJcmVnID0gWllOUU1QX0RJU1BfVl9CTEVORF9JTjFDU0NfT0ZGU0VUKDApOwor
CWVsc2UKKwkJcmVnID0gWllOUU1QX0RJU1BfVl9CTEVORF9JTjJDU0NfT0ZGU0VUKDApOworCisJ
Zm9yIChpID0gMDsgaSA8IFpZTlFNUF9ESVNQX1ZfQkxFTkRfTlVNX09GRlNFVDsgaSsrKQorCQl6
eW5xbXBfZGlzcF9ibGVuZF93cml0ZShibGVuZCwgcmVnICsgaSAqIDQsIG9mZnNldHNbaV0pOwor
fQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2JsZW5kX2xheWVyX2VuYWJsZSAtIEVuYWJsZSBhIGxh
eWVyCisgKiBAYmxlbmQ6IEJsZW5kZXIgb2JqZWN0CisgKiBAbGF5ZXI6IFRoZSBsYXllcgorICov
CitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9ibGVuZF9sYXllcl9lbmFibGUoc3RydWN0IHp5bnFt
cF9kaXNwX2JsZW5kICpibGVuZCwKKwkJCQkJICAgc3RydWN0IHp5bnFtcF9kaXNwX2xheWVyICps
YXllcikKK3sKKwljb25zdCB1MTYgKmNvZWZmczsKKwljb25zdCB1MzIgKm9mZnNldHM7CisJdTMy
IHZhbDsKKworCXZhbCA9IChsYXllci0+ZHJtX2ZtdC0+aXNfeXV2ID8KKwkgICAgICAgMCA6IFpZ
TlFNUF9ESVNQX1ZfQkxFTkRfTEFZRVJfQ09OVFJPTF9SR0IpIHwKKwkgICAgICAobGF5ZXItPmRy
bV9mbXQtPmhzdWIgPiAxID8KKwkgICAgICAgWllOUU1QX0RJU1BfVl9CTEVORF9MQVlFUl9DT05U
Uk9MX0VOX1VTIDogMCk7CisKKwl6eW5xbXBfZGlzcF9ibGVuZF93cml0ZShibGVuZCwKKwkJCQla
WU5RTVBfRElTUF9WX0JMRU5EX0xBWUVSX0NPTlRST0wobGF5ZXItPmlkKSwKKwkJCQl2YWwpOwor
CisJaWYgKGxheWVyLT5kcm1fZm10LT5pc195dXYpIHsKKwkJY29lZmZzID0gY3NjX3NkdHZfdG9f
cmdiX21hdHJpeDsKKwkJb2Zmc2V0cyA9IGNzY19zZHR2X3RvX3JnYl9vZmZzZXRzOworCX0gZWxz
ZSB7CisJCWNvZWZmcyA9IGNzY19pZGVudGl0eV9tYXRyaXg7CisJCW9mZnNldHMgPSBjc2NfemVy
b19vZmZzZXRzOworCX0KKworCXp5bnFtcF9kaXNwX2JsZW5kX2xheWVyX3NldF9jc2MoYmxlbmQs
IGxheWVyLCBjb2VmZnMsIG9mZnNldHMpOworfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2JsZW5k
X2xheWVyX2Rpc2FibGUgLSBEaXNhYmxlIGEgbGF5ZXIKKyAqIEBibGVuZDogQmxlbmRlciBvYmpl
Y3QKKyAqIEBsYXllcjogVGhlIGxheWVyCisgKi8KK3N0YXRpYyB2b2lkIHp5bnFtcF9kaXNwX2Js
ZW5kX2xheWVyX2Rpc2FibGUoc3RydWN0IHp5bnFtcF9kaXNwX2JsZW5kICpibGVuZCwKKwkJCQkJ
ICAgIHN0cnVjdCB6eW5xbXBfZGlzcF9sYXllciAqbGF5ZXIpCit7CisJenlucW1wX2Rpc3BfYmxl
bmRfd3JpdGUoYmxlbmQsCisJCQkJWllOUU1QX0RJU1BfVl9CTEVORF9MQVlFUl9DT05UUk9MKGxh
eWVyLT5pZCksCisJCQkJMCk7CisKKwl6eW5xbXBfZGlzcF9ibGVuZF9sYXllcl9zZXRfY3NjKGJs
ZW5kLCBsYXllciwgY3NjX3plcm9fbWF0cml4LAorCQkJCQljc2NfemVyb19vZmZzZXRzKTsKK30K
KworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqIEF1ZGlvIE1peGVyCisgKi8KKworc3RhdGlj
IHZvaWQgenlucW1wX2Rpc3BfYXVkaW9fd3JpdGUoc3RydWN0IHp5bnFtcF9kaXNwX2F1ZGlvICph
dWRpbywKKwkJCQkgIGludCByZWcsIHUzMiB2YWwpCit7CisJd3JpdGVsKHZhbCwgYXVkaW8tPmJh
c2UgKyByZWcpOworfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2F1ZGlvX2VuYWJsZSAtIEVuYWJs
ZSB0aGUgYXVkaW8gbWl4ZXIKKyAqIEBhdWRpbzogQXVkaW8gbWl4ZXIKKyAqCisgKiBFbmFibGUg
dGhlIGF1ZGlvIG1peGVyIGJ5IGRlLWFzc2VydGluZyB0aGUgc29mdCByZXNldC4gVGhlIGF1ZGlv
IHN0YXRlIGlzIHNldCB0bworICogZGVmYXVsdCB2YWx1ZXMgYnkgdGhlIHJlc2V0LCBzZXQgdGhl
IGRlZmF1bHQgbWl4ZXIgdm9sdW1lIGV4cGxpY2l0bHkuCisgKi8KK3N0YXRpYyB2b2lkIHp5bnFt
cF9kaXNwX2F1ZGlvX2VuYWJsZShzdHJ1Y3QgenlucW1wX2Rpc3BfYXVkaW8gKmF1ZGlvKQorewor
CS8qIENsZWFyIHRoZSBhdWRpbyBzb2Z0IHJlc2V0IHJlZ2lzdGVyIGFzIGl0J3MgYW4gbm9uLXJl
c2V0IGZsb3AuICovCisJenlucW1wX2Rpc3BfYXVkaW9fd3JpdGUoYXVkaW8sIFpZTlFNUF9ESVNQ
X0FVRF9TT0ZUX1JFU0VULCAwKTsKKwl6eW5xbXBfZGlzcF9hdWRpb193cml0ZShhdWRpbywgWllO
UU1QX0RJU1BfQVVEX01JWEVSX1ZPTFVNRSwKKwkJCQlaWU5RTVBfRElTUF9BVURfTUlYRVJfVk9M
VU1FX05PX1NDQUxFKTsKK30KKworLyoqCisgKiB6eW5xbXBfZGlzcF9hdWRpb19kaXNhYmxlIC0g
RGlzYWJsZSB0aGUgYXVkaW8gbWl4ZXIKKyAqIEBhdWRpbzogQXVkaW8gbWl4ZXIKKyAqCisgKiBE
aXNhYmxlIHRoZSBhdWRpbyBtaXhlciBieSBhc3NlcnRpbmcgaXRzIHNvZnQgcmVzZXQuCisgKi8K
K3N0YXRpYyB2b2lkIHp5bnFtcF9kaXNwX2F1ZGlvX2Rpc2FibGUoc3RydWN0IHp5bnFtcF9kaXNw
X2F1ZGlvICphdWRpbykKK3sKKwl6eW5xbXBfZGlzcF9hdWRpb193cml0ZShhdWRpbywgWllOUU1Q
X0RJU1BfQVVEX1NPRlRfUkVTRVQsCisJCQkJWllOUU1QX0RJU1BfQVVEX1NPRlRfUkVTRVRfQVVE
X1NSU1QpOworfQorCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9hdWRpb19pbml0KHN0cnVjdCBk
ZXZpY2UgKmRldiwKKwkJCQkgc3RydWN0IHp5bnFtcF9kaXNwX2F1ZGlvICphdWRpbykKK3sKKwkv
KiBUcnkgdGhlIGxpdmUgUEwgYXVkaW8gY2xvY2suICovCisJYXVkaW8tPl9wbF9jbGsgPSBkZXZt
X2Nsa19nZXQoZGV2LCAiZHBfbGl2ZV9hdWRpb19hY2xrIik7CisJaWYgKCFJU19FUlIoYXVkaW8t
Pl9wbF9jbGspKSB7CisJCWF1ZGlvLT5jbGsgPSBhdWRpby0+X3BsX2NsazsKKwkJcmV0dXJuOwor
CX0KKworCS8qIElmIHRoZSBsaXZlIFBMIGF1ZGlvIGNsb2NrIGlzIG5vdCB2YWxpZCwgZmFsbCBi
YWNrIHRvIFBTIGNsb2NrLiAqLworCWF1ZGlvLT5fcHNfY2xrID0gZGV2bV9jbGtfZ2V0KGRldiwg
ImRwX2F1ZF9jbGsiKTsKKwlpZiAoIUlTX0VSUihhdWRpby0+X3BzX2NsaykpIHsKKwkJYXVkaW8t
PmNsayA9IGF1ZGlvLT5fcHNfY2xrOworCQlyZXR1cm47CisJfQorCisJZGV2X2VycihkZXYsICJh
dWRpbyBkaXNhYmxlZCBkdWUgdG8gbWlzc2luZyBjbG9ja1xuIik7Cit9CisKKy8qIC0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tCisgKiBaeW5xTVAgRGlzcGxheSBleHRlcm5hbCBmdW5jdGlvbnMgZm9yIHp5
bnFtcF9kcAorICovCisKKy8qKgorICogenlucW1wX2Rpc3BfaGFuZGxlX3ZibGFuayAtIEhhbmRs
ZSB0aGUgdmJsYW5rIGV2ZW50CisgKiBAZGlzcDogRGlzcGxheSBjb250cm9sbGVyCisgKgorICog
VGhpcyBmdW5jdGlvbiBoYW5kbGVzIHRoZSB2YmxhbmsgaW50ZXJydXB0LCBhbmQgc2VuZHMgYW4g
ZXZlbnQgdG8KKyAqIENSVEMgb2JqZWN0LiBUaGlzIHdpbGwgYmUgY2FsbGVkIGJ5IHRoZSBEUCB2
YmxhbmsgaW50ZXJydXB0IGhhbmRsZXIuCisgKi8KK3ZvaWQgenlucW1wX2Rpc3BfaGFuZGxlX3Zi
bGFuayhzdHJ1Y3QgenlucW1wX2Rpc3AgKmRpc3ApCit7CisJc3RydWN0IGRybV9jcnRjICpjcnRj
ID0gJmRpc3AtPmNydGM7CisKKwlkcm1fY3J0Y19oYW5kbGVfdmJsYW5rKGNydGMpOworfQorCisv
KioKKyAqIHp5bnFtcF9kaXNwX2F1ZGlvX2VuYWJsZWQgLSBJZiB0aGUgYXVkaW8gaXMgZW5hYmxl
ZAorICogQGRpc3A6IERpc3BsYXkgY29udHJvbGxlcgorICoKKyAqIFJldHVybiBpZiB0aGUgYXVk
aW8gaXMgZW5hYmxlZCBkZXBlbmRpbmcgb24gdGhlIGF1ZGlvIGNsb2NrLgorICoKKyAqIFJldHVy
bjogdHJ1ZSBpZiBhdWRpbyBpcyBlbmFibGVkLCBvciBmYWxzZS4KKyAqLworYm9vbCB6eW5xbXBf
ZGlzcF9hdWRpb19lbmFibGVkKHN0cnVjdCB6eW5xbXBfZGlzcCAqZGlzcCkKK3sKKwlyZXR1cm4g
ISFkaXNwLT5hdWRpby5jbGs7Cit9CisKKy8qKgorICogenlucW1wX2Rpc3BfZ2V0X2F1ZGlvX2Ns
a19yYXRlIC0gR2V0IHRoZSBjdXJyZW50IGF1ZGlvIGNsb2NrIHJhdGUKKyAqIEBkaXNwOiBEaXNw
bGF5IGNvbnRyb2xsZXIKKyAqCisgKiBSZXR1cm46IHRoZSBjdXJyZW50IGF1ZGlvIGNsb2NrIHJh
dGUuCisgKi8KK3Vuc2lnbmVkIGludCB6eW5xbXBfZGlzcF9nZXRfYXVkaW9fY2xrX3JhdGUoc3Ry
dWN0IHp5bnFtcF9kaXNwICpkaXNwKQoreworCWlmICh6eW5xbXBfZGlzcF9hdWRpb19lbmFibGVk
KGRpc3ApKQorCQlyZXR1cm4gMDsKKwlyZXR1cm4gY2xrX2dldF9yYXRlKGRpc3AtPmF1ZGlvLmNs
ayk7Cit9CisKKy8qKgorICogenlucW1wX2Rpc3BfZ2V0X2NydGNfbWFzayAtIFJldHVybiB0aGUg
Q1JUQyBiaXQgbWFzaworICogQGRpc3A6IERpc3BsYXkgY29udHJvbGxlcgorICoKKyAqIFJldHVy
bjogdGhlIGNydGMgbWFzayBvZiB0aGUgenlxbm1wX2Rpc3AgQ1JUQy4KKyAqLwordWludDMyX3Qg
enlucW1wX2Rpc3BfZ2V0X2NydGNfbWFzayhzdHJ1Y3QgenlucW1wX2Rpc3AgKmRpc3ApCit7CisJ
cmV0dXJuIGRybV9jcnRjX21hc2soJmRpc3AtPmNydGMpOworfQorCisvKiAtLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLQorICogWnlucU1QIERpc3BsYXkgTGF5ZXIgJiBEUk0gUGxhbmUKKyAqLworCisvKioK
KyAqIHp5bnFtcF9kaXNwX2xheWVyX2ZpbmRfZm9ybWF0IC0gRmluZCBmb3JtYXQgaW5mb3JtYXRp
b24gZm9yIGEgRFJNIGZvcm1hdAorICogQGxheWVyOiBUaGUgbGF5ZXIKKyAqIEBkcm1fZm10OiBE
Uk0gZm9ybWF0IHRvIHNlYXJjaAorICoKKyAqIFNlYXJjaCBkaXNwbGF5IHN1YnN5c3RlbSBmb3Jt
YXQgaW5mb3JtYXRpb24gY29ycmVzcG9uZGluZyB0byB0aGUgZ2l2ZW4gRFJNCisgKiBmb3JtYXQg
QGRybV9mbXQgZm9yIHRoZSBAbGF5ZXIsIGFuZCByZXR1cm4gYSBwb2ludGVyIHRvIHRoZSBmb3Jt
YXQKKyAqIGRlc2NyaXB0b3IuCisgKgorICogUmV0dXJuOiBBIHBvaW50ZXIgdG8gdGhlIGZvcm1h
dCBkZXNjcmlwdG9yIGlmIGZvdW5kLCBOVUxMIG90aGVyd2lzZQorICovCitzdGF0aWMgY29uc3Qg
c3RydWN0IHp5bnFtcF9kaXNwX2Zvcm1hdCAqCit6eW5xbXBfZGlzcF9sYXllcl9maW5kX2Zvcm1h
dChzdHJ1Y3QgenlucW1wX2Rpc3BfbGF5ZXIgKmxheWVyLAorCQkJICAgICAgdTMyIGRybV9mbXQp
Cit7CisJdW5zaWduZWQgaW50IGk7CisKKwlmb3IgKGkgPSAwOyBpIDwgbGF5ZXItPmluZm8tPm51
bV9mb3JtYXRzOyBpKyspIHsKKwkJaWYgKGxheWVyLT5pbmZvLT5mb3JtYXRzW2ldLmRybV9mbXQg
PT0gZHJtX2ZtdCkKKwkJCXJldHVybiAmbGF5ZXItPmluZm8tPmZvcm1hdHNbaV07CisJfQorCisJ
cmV0dXJuIE5VTEw7Cit9CisKKy8qKgorICogenlucW1wX2Rpc3BfbGF5ZXJfZW5hYmxlIC0gRW5h
YmxlIGEgbGF5ZXIKKyAqIEBsYXllcjogVGhlIGxheWVyCisgKgorICogRW5hYmxlIHRoZSBAbGF5
ZXIgaW4gdGhlIGF1ZGlvL3ZpZGVvIGJ1ZmZlciBtYW5hZ2VyIGFuZCB0aGUgYmxlbmRlci4gRE1B
CisgKiBjaGFubmVscyBhcmUgc3RhcnRlZCBzZXBhcmF0ZWx5IGJ5IHp5bnFtcF9kaXNwX2xheWVy
X3VwZGF0ZSgpLgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9sYXllcl9lbmFibGUoc3Ry
dWN0IHp5bnFtcF9kaXNwX2xheWVyICpsYXllcikKK3sKKwl6eW5xbXBfZGlzcF9hdmJ1Zl9lbmFi
bGVfdmlkZW8oJmxheWVyLT5kaXNwLT5hdmJ1ZiwgbGF5ZXItPmlkLAorCQkJCSAgICAgICBaWU5R
TVBfRElTUF9MQVlFUl9OT05MSVZFKTsKKwl6eW5xbXBfZGlzcF9ibGVuZF9sYXllcl9lbmFibGUo
JmxheWVyLT5kaXNwLT5ibGVuZCwgbGF5ZXIpOworCisJbGF5ZXItPm1vZGUgPSBaWU5RTVBfRElT
UF9MQVlFUl9OT05MSVZFOworfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2xheWVyX2Rpc2FibGUg
LSBEaXNhYmxlIHRoZSBsYXllcgorICogQGxheWVyOiBUaGUgbGF5ZXIKKyAqCisgKiBEaXNhYmxl
IHRoZSBsYXllciBieSBzdG9wcGluZyBpdHMgRE1BIGNoYW5uZWxzIGFuZCBkaXNhYmxpbmcgaXQg
aW4gdGhlCisgKiBhdWRpby92aWRlbyBidWZmZXIgbWFuYWdlciBhbmQgdGhlIGJsZW5kZXIuCisg
Ki8KK3N0YXRpYyB2b2lkIHp5bnFtcF9kaXNwX2xheWVyX2Rpc2FibGUoc3RydWN0IHp5bnFtcF9k
aXNwX2xheWVyICpsYXllcikKK3sKKwl1bnNpZ25lZCBpbnQgaTsKKworCWZvciAoaSA9IDA7IGkg
PCBsYXllci0+ZHJtX2ZtdC0+bnVtX3BsYW5lczsgaSsrKQorCQlkbWFlbmdpbmVfdGVybWluYXRl
X3N5bmMobGF5ZXItPmRtYXNbaV0uY2hhbik7CisKKwl6eW5xbXBfZGlzcF9hdmJ1Zl9kaXNhYmxl
X3ZpZGVvKCZsYXllci0+ZGlzcC0+YXZidWYsIGxheWVyLT5pZCk7CisJenlucW1wX2Rpc3BfYmxl
bmRfbGF5ZXJfZGlzYWJsZSgmbGF5ZXItPmRpc3AtPmJsZW5kLCBsYXllcik7Cit9CisKKy8qKgor
ICogenlucW1wX2Rpc3BfbGF5ZXJfc2V0X2Zvcm1hdCAtIFNldCB0aGUgbGF5ZXIgZm9ybWF0Cisg
KiBAbGF5ZXI6IFRoZSBsYXllcgorICogQHN0YXRlOiBUaGUgcGxhbmUgc3RhdGUKKyAqCisgKiBT
ZXQgdGhlIGZvcm1hdCBmb3IgQGxheWVyIGJhc2VkIG9uIEBzdGF0ZS0+ZmItPmZvcm1hdC4gVGhl
IGxheWVyIG11c3QgYmUKKyAqIGRpc2FibGVkLgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlz
cF9sYXllcl9zZXRfZm9ybWF0KHN0cnVjdCB6eW5xbXBfZGlzcF9sYXllciAqbGF5ZXIsCisJCQkJ
CSBzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpzdGF0ZSkKK3sKKwljb25zdCBzdHJ1Y3QgZHJtX2Zv
cm1hdF9pbmZvICppbmZvID0gc3RhdGUtPmZiLT5mb3JtYXQ7CisKKwlsYXllci0+ZGlzcF9mbXQg
PSB6eW5xbXBfZGlzcF9sYXllcl9maW5kX2Zvcm1hdChsYXllciwgaW5mby0+Zm9ybWF0KTsKKwls
YXllci0+ZHJtX2ZtdCA9IGluZm87CisKKwl6eW5xbXBfZGlzcF9hdmJ1Zl9zZXRfZm9ybWF0KCZs
YXllci0+ZGlzcC0+YXZidWYsIGxheWVyLT5pZCwKKwkJCQkgICAgIGxheWVyLT5kaXNwX2ZtdCk7
Cit9CisKKy8qKgorICogenlucW1wX2Rpc3BfbGF5ZXJfdXBkYXRlIC0gVXBkYXRlIHRoZSBsYXll
ciBmcmFtZWJ1ZmZlcgorICogQGxheWVyOiBUaGUgbGF5ZXIKKyAqIEBzdGF0ZTogVGhlIHBsYW5l
IHN0YXRlCisgKgorICogVXBkYXRlIHRoZSBmcmFtZWJ1ZmZlciBmb3IgdGhlIGxheWVyIGJ5IGlz
c3VpbmcgYSBuZXcgRE1BIGVuZ2luZSB0cmFuc2FjdGlvbgorICogZm9yIHRoZSBuZXcgZnJhbWVi
dWZmZXIuCisgKgorICogUmV0dXJuOiAwIG9uIHN1Y2Nlc3MsIG9yIHRoZSBETUEgZGVzY3JpcHRv
ciBmYWlsdXJlIGVycm9yIG90aGVyd2lzZQorICovCitzdGF0aWMgaW50IHp5bnFtcF9kaXNwX2xh
eWVyX3VwZGF0ZShzdHJ1Y3QgenlucW1wX2Rpc3BfbGF5ZXIgKmxheWVyLAorCQkJCSAgICBzdHJ1
Y3QgZHJtX3BsYW5lX3N0YXRlICpzdGF0ZSkKK3sKKwljb25zdCBzdHJ1Y3QgZHJtX2Zvcm1hdF9p
bmZvICppbmZvID0gbGF5ZXItPmRybV9mbXQ7CisJdW5zaWduZWQgaW50IGk7CisKKwlmb3IgKGkg
PSAwOyBpIDwgbGF5ZXItPmRybV9mbXQtPm51bV9wbGFuZXM7IGkrKykgeworCQl1bnNpZ25lZCBp
bnQgd2lkdGggPSBzdGF0ZS0+Y3J0Y193IC8gKGkgPyBpbmZvLT5oc3ViIDogMSk7CisJCXVuc2ln
bmVkIGludCBoZWlnaHQgPSBzdGF0ZS0+Y3J0Y19oIC8gKGkgPyBpbmZvLT52c3ViIDogMSk7CisJ
CXN0cnVjdCB6eW5xbXBfZGlzcF9sYXllcl9kbWEgKmRtYSA9ICZsYXllci0+ZG1hc1tpXTsKKwkJ
c3RydWN0IGRtYV9hc3luY190eF9kZXNjcmlwdG9yICpkZXNjOworCQlkbWFfYWRkcl90IHBhZGRy
OworCisJCXBhZGRyID0gZHJtX2ZiX2NtYV9nZXRfZ2VtX2FkZHIoc3RhdGUtPmZiLCBzdGF0ZSwg
aSk7CisKKwkJZG1hLT54dC5udW1mID0gaGVpZ2h0OworCQlkbWEtPnNnbC5zaXplID0gd2lkdGgg
KiBpbmZvLT5jcHBbaV07CisJCWRtYS0+c2dsLmljZyA9IHN0YXRlLT5mYi0+cGl0Y2hlc1tpXSAt
IGRtYS0+c2dsLnNpemU7CisJCWRtYS0+eHQuc3JjX3N0YXJ0ID0gcGFkZHI7CisJCWRtYS0+eHQu
ZnJhbWVfc2l6ZSA9IDE7CisJCWRtYS0+eHQuZGlyID0gRE1BX01FTV9UT19ERVY7CisJCWRtYS0+
eHQuc3JjX3NnbCA9IHRydWU7CisJCWRtYS0+eHQuZHN0X3NnbCA9IGZhbHNlOworCisJCWRlc2Mg
PSBkbWFlbmdpbmVfcHJlcF9pbnRlcmxlYXZlZF9kbWEoZG1hLT5jaGFuLCAmZG1hLT54dCwKKwkJ
CQkJCSAgICAgIERNQV9DVFJMX0FDSyB8CisJCQkJCQkgICAgICBETUFfUFJFUF9JTlRFUlJVUFQp
OworCQlpZiAoIWRlc2MpIHsKKwkJCWRldl9lcnIobGF5ZXItPmRpc3AtPmRldiwKKwkJCQkiZmFp
bGVkIHRvIHByZXBhcmUgRE1BIGRlc2NyaXB0b3JcbiIpOworCQkJcmV0dXJuIC1FTk9NRU07CisJ
CX0KKworCQlkbWFlbmdpbmVfc3VibWl0KGRlc2MpOworCQlkbWFfYXN5bmNfaXNzdWVfcGVuZGlu
ZyhkbWEtPmNoYW4pOworCX0KKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW5saW5lIHN0cnVj
dCB6eW5xbXBfZGlzcF9sYXllciAqcGxhbmVfdG9fbGF5ZXIoc3RydWN0IGRybV9wbGFuZSAqcGxh
bmUpCit7CisJcmV0dXJuIGNvbnRhaW5lcl9vZihwbGFuZSwgc3RydWN0IHp5bnFtcF9kaXNwX2xh
eWVyLCBwbGFuZSk7Cit9CisKK3N0YXRpYyBpbnQKK3p5bnFtcF9kaXNwX3BsYW5lX2F0b21pY19j
aGVjayhzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKKwkJCSAgICAgICBzdHJ1Y3QgZHJtX3BsYW5l
X3N0YXRlICpzdGF0ZSkKK3sKKwlzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKmNydGNfc3RhdGU7CisK
KwlpZiAoIXN0YXRlLT5jcnRjKQorCQlyZXR1cm4gMDsKKworCWNydGNfc3RhdGUgPSBkcm1fYXRv
bWljX2dldF9jcnRjX3N0YXRlKHN0YXRlLT5zdGF0ZSwgc3RhdGUtPmNydGMpOworCWlmIChJU19F
UlIoY3J0Y19zdGF0ZSkpCisJCXJldHVybiBQVFJfRVJSKGNydGNfc3RhdGUpOworCisJcmV0dXJu
IGRybV9hdG9taWNfaGVscGVyX2NoZWNrX3BsYW5lX3N0YXRlKHN0YXRlLCBjcnRjX3N0YXRlLAor
CQkJCQkJICAgRFJNX1BMQU5FX0hFTFBFUl9OT19TQ0FMSU5HLAorCQkJCQkJICAgRFJNX1BMQU5F
X0hFTFBFUl9OT19TQ0FMSU5HLAorCQkJCQkJICAgZmFsc2UsIGZhbHNlKTsKK30KKworc3RhdGlj
IHZvaWQKK3p5bnFtcF9kaXNwX3BsYW5lX2F0b21pY19kaXNhYmxlKHN0cnVjdCBkcm1fcGxhbmUg
KnBsYW5lLAorCQkJCSBzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpvbGRfc3RhdGUpCit7CisJc3Ry
dWN0IHp5bnFtcF9kaXNwX2xheWVyICpsYXllciA9IHBsYW5lX3RvX2xheWVyKHBsYW5lKTsKKwor
CXp5bnFtcF9kaXNwX2xheWVyX2Rpc2FibGUobGF5ZXIpOworfQorCitzdGF0aWMgdm9pZAorenlu
cW1wX2Rpc3BfcGxhbmVfYXRvbWljX3VwZGF0ZShzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKKwkJ
CQlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpvbGRfc3RhdGUpCit7CisJc3RydWN0IHp5bnFtcF9k
aXNwX2xheWVyICpsYXllciA9IHBsYW5lX3RvX2xheWVyKHBsYW5lKTsKKwlib29sIGZvcm1hdF9j
aGFuZ2VkID0gZmFsc2U7CisKKwlpZiAoIW9sZF9zdGF0ZS0+ZmIgfHwKKwkgICAgb2xkX3N0YXRl
LT5mYi0+Zm9ybWF0LT5mb3JtYXQgIT0gcGxhbmUtPnN0YXRlLT5mYi0+Zm9ybWF0LT5mb3JtYXQp
CisJCWZvcm1hdF9jaGFuZ2VkID0gdHJ1ZTsKKworCS8qCisJICogSWYgdGhlIGZvcm1hdCBoYXMg
Y2hhbmdlZCAoaW5jbHVkaW5nIGdvaW5nIGZyb20gYSBwcmV2aW91c2x5CisJICogZGlzYWJsZWQg
c3RhdGUgdG8gYW55IGZvcm1hdCksIHJlY29uZmlndXJlIHRoZSBmb3JtYXQuIERpc2FibGUgdGhl
CisJICogcGxhbmUgZmlyc3QgaWYgbmVlZGVkLgorCSAqLworCWlmIChmb3JtYXRfY2hhbmdlZCkg
eworCQlpZiAob2xkX3N0YXRlLT5mYikKKwkJCXp5bnFtcF9kaXNwX2xheWVyX2Rpc2FibGUobGF5
ZXIpOworCisJCXp5bnFtcF9kaXNwX2xheWVyX3NldF9mb3JtYXQobGF5ZXIsIHBsYW5lLT5zdGF0
ZSk7CisJfQorCisJenlucW1wX2Rpc3BfbGF5ZXJfdXBkYXRlKGxheWVyLCBwbGFuZS0+c3RhdGUp
OworCisJLyogRW5hYmxlIG9yIHJlLWVuYWJsZSB0aGUgcGxhbmUgaXMgdGhlIGZvcm1hdCBoYXMg
Y2hhbmdlZC4gKi8KKwlpZiAoZm9ybWF0X2NoYW5nZWQpCisJCXp5bnFtcF9kaXNwX2xheWVyX2Vu
YWJsZShsYXllcik7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX3BsYW5lX2hlbHBlcl9m
dW5jcyB6eW5xbXBfZGlzcF9wbGFuZV9oZWxwZXJfZnVuY3MgPSB7CisJLmF0b21pY19jaGVjawkJ
PSB6eW5xbXBfZGlzcF9wbGFuZV9hdG9taWNfY2hlY2ssCisJLmF0b21pY191cGRhdGUJCT0genlu
cW1wX2Rpc3BfcGxhbmVfYXRvbWljX3VwZGF0ZSwKKwkuYXRvbWljX2Rpc2FibGUJCT0genlucW1w
X2Rpc3BfcGxhbmVfYXRvbWljX2Rpc2FibGUsCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGRy
bV9wbGFuZV9mdW5jcyB6eW5xbXBfZGlzcF9wbGFuZV9mdW5jcyA9IHsKKwkudXBkYXRlX3BsYW5l
CQk9IGRybV9hdG9taWNfaGVscGVyX3VwZGF0ZV9wbGFuZSwKKwkuZGlzYWJsZV9wbGFuZQkJPSBk
cm1fYXRvbWljX2hlbHBlcl9kaXNhYmxlX3BsYW5lLAorCS5kZXN0cm95CQk9IGRybV9wbGFuZV9j
bGVhbnVwLAorCS5yZXNldAkJCT0gZHJtX2F0b21pY19oZWxwZXJfcGxhbmVfcmVzZXQsCisJLmF0
b21pY19kdXBsaWNhdGVfc3RhdGUJPSBkcm1fYXRvbWljX2hlbHBlcl9wbGFuZV9kdXBsaWNhdGVf
c3RhdGUsCisJLmF0b21pY19kZXN0cm95X3N0YXRlCT0gZHJtX2F0b21pY19oZWxwZXJfcGxhbmVf
ZGVzdHJveV9zdGF0ZSwKK307CisKK3N0YXRpYyBpbnQgenlucW1wX2Rpc3BfY3JlYXRlX3BsYW5l
cyhzdHJ1Y3QgenlucW1wX2Rpc3AgKmRpc3ApCit7CisJdW5zaWduZWQgaW50IGksIGo7CisJaW50
IHJldDsKKworCWZvciAoaSA9IDA7IGkgPCBaWU5RTVBfRElTUF9OVU1fTEFZRVJTOyBpKyspIHsK
KwkJc3RydWN0IHp5bnFtcF9kaXNwX2xheWVyICpsYXllciA9ICZkaXNwLT5sYXllcnNbaV07CisJ
CWVudW0gZHJtX3BsYW5lX3R5cGUgdHlwZTsKKwkJdTMyICpkcm1fZm9ybWF0czsKKworCQlkcm1f
Zm9ybWF0cyA9IGRldm1fa2NhbGxvYyhkaXNwLT5kZXYsIHNpemVvZigqZHJtX2Zvcm1hdHMpLAor
CQkJCQkgICBsYXllci0+aW5mby0+bnVtX2Zvcm1hdHMsCisJCQkJCSAgIEdGUF9LRVJORUwpOwor
CQlpZiAoIWRybV9mb3JtYXRzKQorCQkJcmV0dXJuIC1FTk9NRU07CisKKwkJZm9yIChqID0gMDsg
aiA8IGxheWVyLT5pbmZvLT5udW1fZm9ybWF0czsgKytqKQorCQkJZHJtX2Zvcm1hdHNbal0gPSBs
YXllci0+aW5mby0+Zm9ybWF0c1tqXS5kcm1fZm10OworCisJCS8qIEdyYXBoaWNzIGxheWVyIGlz
IHByaW1hcnksIGFuZCB2aWRlbyBsYXllciBpcyBvdmVybGF5LiAqLworCQl0eXBlID0gaSA9PSBa
WU5RTVBfRElTUF9MQVlFUl9HRlgKKwkJICAgICA/IERSTV9QTEFORV9UWVBFX1BSSU1BUlkgOiBE
Uk1fUExBTkVfVFlQRV9PVkVSTEFZOworCQlyZXQgPSBkcm1fdW5pdmVyc2FsX3BsYW5lX2luaXQo
ZGlzcC0+ZHJtLCAmbGF5ZXItPnBsYW5lLCAwLAorCQkJCQkgICAgICAgJnp5bnFtcF9kaXNwX3Bs
YW5lX2Z1bmNzLAorCQkJCQkgICAgICAgZHJtX2Zvcm1hdHMsCisJCQkJCSAgICAgICBsYXllci0+
aW5mby0+bnVtX2Zvcm1hdHMsCisJCQkJCSAgICAgICBOVUxMLCB0eXBlLCBOVUxMKTsKKwkJaWYg
KHJldCkKKwkJCXJldHVybiByZXQ7CisKKwkJZHJtX3BsYW5lX2hlbHBlcl9hZGQoJmxheWVyLT5w
bGFuZSwKKwkJCQkgICAgICZ6eW5xbXBfZGlzcF9wbGFuZV9oZWxwZXJfZnVuY3MpOworCX0KKwor
CXJldHVybiAwOworfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2xheWVyX3JlbGVhc2VfZG1hIC0g
UmVsZWFzZSBETUEgY2hhbm5lbHMgZm9yIGEgbGF5ZXIKKyAqIEBkaXNwOiBEaXNwbGF5IGNvbnRy
b2xsZXIKKyAqIEBsYXllcjogVGhlIGxheWVyCisgKgorICogUmVsZWFzZSB0aGUgRE1BIGNoYW5u
ZWxzIGFzc29jaWF0ZWQgd2l0aCBAbGF5ZXIuCisgKi8KK3N0YXRpYyB2b2lkIHp5bnFtcF9kaXNw
X2xheWVyX3JlbGVhc2VfZG1hKHN0cnVjdCB6eW5xbXBfZGlzcCAqZGlzcCwKKwkJCQkJICBzdHJ1
Y3QgenlucW1wX2Rpc3BfbGF5ZXIgKmxheWVyKQoreworCXVuc2lnbmVkIGludCBpOworCisJZm9y
IChpID0gMDsgaSA8IGxheWVyLT5pbmZvLT5udW1fY2hhbm5lbHM7IGkrKykgeworCQlzdHJ1Y3Qg
enlucW1wX2Rpc3BfbGF5ZXJfZG1hICpkbWEgPSAmbGF5ZXItPmRtYXNbaV07CisKKwkJaWYgKCFk
bWEpCisJCQljb250aW51ZTsKKworCQkvKiBNYWtlIHN1cmUgdGhlIGNoYW5uZWwgaXMgdGVybWlu
YXRlZCBiZWZvcmUgcmVsZWFzZS4gKi8KKwkJZG1hZW5naW5lX3Rlcm1pbmF0ZV9hbGwoZG1hLT5j
aGFuKTsKKwkJZG1hX3JlbGVhc2VfY2hhbm5lbChkbWEtPmNoYW4pOworCX0KK30KKworLyoqCisg
KiB6eW5xbXBfZGlzcF9kZXN0cm95X2xheWVycyAtIERlc3Ryb3kgYWxsIGxheWVycworICogQGRp
c3A6IERpc3BsYXkgY29udHJvbGxlcgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9kZXN0
cm95X2xheWVycyhzdHJ1Y3QgenlucW1wX2Rpc3AgKmRpc3ApCit7CisJdW5zaWduZWQgaW50IGk7
CisKKwlmb3IgKGkgPSAwOyBpIDwgWllOUU1QX0RJU1BfTlVNX0xBWUVSUzsgaSsrKQorCQl6eW5x
bXBfZGlzcF9sYXllcl9yZWxlYXNlX2RtYShkaXNwLCAmZGlzcC0+bGF5ZXJzW2ldKTsKK30KKwor
LyoqCisgKiB6eW5xbXBfZGlzcF9sYXllcl9yZXF1ZXN0X2RtYSAtIFJlcXVlc3QgRE1BIGNoYW5u
ZWxzIGZvciBhIGxheWVyCisgKiBAZGlzcDogRGlzcGxheSBjb250cm9sbGVyCisgKiBAbGF5ZXI6
IFRoZSBsYXllcgorICoKKyAqIFJlcXVlc3QgYWxsIERNQSBlbmdpbmUgY2hhbm5lbHMgbmVlZGVk
IGJ5IEBsYXllci4KKyAqCisgKiBSZXR1cm46IDAgb24gc3VjY2Vzcywgb3IgdGhlIERNQSBjaGFu
bmVsIHJlcXVlc3QgZXJyb3Igb3RoZXJ3aXNlCisgKi8KK3N0YXRpYyBpbnQgenlucW1wX2Rpc3Bf
bGF5ZXJfcmVxdWVzdF9kbWEoc3RydWN0IHp5bnFtcF9kaXNwICpkaXNwLAorCQkJCQkgc3RydWN0
IHp5bnFtcF9kaXNwX2xheWVyICpsYXllcikKK3sKKwlzdGF0aWMgY29uc3QgY2hhciAqIGNvbnN0
IGRtYV9uYW1lc1tdID0geyAidmlkIiwgImdmeCIgfTsKKwl1bnNpZ25lZCBpbnQgaTsKKwlpbnQg
cmV0OworCisJZm9yIChpID0gMDsgaSA8IGxheWVyLT5pbmZvLT5udW1fY2hhbm5lbHM7IGkrKykg
eworCQlzdHJ1Y3QgenlucW1wX2Rpc3BfbGF5ZXJfZG1hICpkbWEgPSAmbGF5ZXItPmRtYXNbaV07
CisJCWNoYXIgZG1hX2NoYW5uZWxfbmFtZVsxNl07CisKKwkJc25wcmludGYoZG1hX2NoYW5uZWxf
bmFtZSwgc2l6ZW9mKGRtYV9jaGFubmVsX25hbWUpLAorCQkJICIlcyV1IiwgZG1hX25hbWVzW2xh
eWVyLT5pZF0sIGkpOworCQlkbWEtPmNoYW4gPSBvZl9kbWFfcmVxdWVzdF9zbGF2ZV9jaGFubmVs
KGRpc3AtPmRldi0+b2Zfbm9kZSwKKwkJCQkJCQkgZG1hX2NoYW5uZWxfbmFtZSk7CisJCWlmIChJ
U19FUlIoZG1hLT5jaGFuKSkgeworCQkJZGV2X2VycihkaXNwLT5kZXYsICJmYWlsZWQgdG8gcmVx
dWVzdCBkbWEgY2hhbm5lbFxuIik7CisJCQlyZXQgPSBQVFJfRVJSKGRtYS0+Y2hhbik7CisJCQlk
bWEtPmNoYW4gPSBOVUxMOworCQkJcmV0dXJuIHJldDsKKwkJfQorCX0KKworCXJldHVybiAwOwor
fQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2NyZWF0ZV9sYXllcnMgLSBDcmVhdGUgYWxsIGxheWVy
cworICogQGRpc3A6IERpc3BsYXkgY29udHJvbGxlcgorICoKKyAqIFJldHVybjogMCBvbiBzdWNj
ZXNzLCBvciB0aGUgRE1BIGNoYW5uZWwgcmVxdWVzdCBlcnJvciBvdGhlcndpc2UKKyAqLworc3Rh
dGljIGludCB6eW5xbXBfZGlzcF9jcmVhdGVfbGF5ZXJzKHN0cnVjdCB6eW5xbXBfZGlzcCAqZGlz
cCkKK3sKKwlzdGF0aWMgY29uc3Qgc3RydWN0IHp5bnFtcF9kaXNwX2xheWVyX2luZm8gbGF5ZXJf
aW5mb1tdID0geworCQlbWllOUU1QX0RJU1BfTEFZRVJfVklEXSA9IHsKKwkJCS5mb3JtYXRzID0g
YXZidWZfdmlkX2ZtdHMsCisJCQkubnVtX2Zvcm1hdHMgPSBBUlJBWV9TSVpFKGF2YnVmX3ZpZF9m
bXRzKSwKKwkJCS5udW1fY2hhbm5lbHMgPSAzLAorCQl9LAorCQlbWllOUU1QX0RJU1BfTEFZRVJf
R0ZYXSA9IHsKKwkJCS5mb3JtYXRzID0gYXZidWZfZ2Z4X2ZtdHMsCisJCQkubnVtX2Zvcm1hdHMg
PSBBUlJBWV9TSVpFKGF2YnVmX2dmeF9mbXRzKSwKKwkJCS5udW1fY2hhbm5lbHMgPSAxLAorCQl9
LAorCX07CisKKwl1bnNpZ25lZCBpbnQgaTsKKwlpbnQgcmV0OworCisJZm9yIChpID0gMDsgaSA8
IFpZTlFNUF9ESVNQX05VTV9MQVlFUlM7IGkrKykgeworCQlzdHJ1Y3QgenlucW1wX2Rpc3BfbGF5
ZXIgKmxheWVyID0gJmRpc3AtPmxheWVyc1tpXTsKKworCQlsYXllci0+aWQgPSBpOworCQlsYXll
ci0+ZGlzcCA9IGRpc3A7CisJCWxheWVyLT5pbmZvID0gJmxheWVyX2luZm9baV07CisKKwkJcmV0
ID0genlucW1wX2Rpc3BfbGF5ZXJfcmVxdWVzdF9kbWEoZGlzcCwgbGF5ZXIpOworCQlpZiAocmV0
KQorCQkJZ290byBlcnI7CisJfQorCisJcmV0dXJuIDA7CisKK2VycjoKKwl6eW5xbXBfZGlzcF9k
ZXN0cm95X2xheWVycyhkaXNwKTsKKwlyZXR1cm4gcmV0OworfQorCisvKiAtLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLQorICogWnlucU1QIERpc3BsYXkgJiBEUk0gQ1JUQworICovCisKKy8qKgorICogenlu
cW1wX2Rpc3BfZW5hYmxlIC0gRW5hYmxlIHRoZSBkaXNwbGF5IGNvbnRyb2xsZXIKKyAqIEBkaXNw
OiBEaXNwbGF5IGNvbnRyb2xsZXIKKyAqLworc3RhdGljIHZvaWQgenlucW1wX2Rpc3BfZW5hYmxl
KHN0cnVjdCB6eW5xbXBfZGlzcCAqZGlzcCkKK3sKKwl6eW5xbXBfZGlzcF9hdmJ1Zl9lbmFibGUo
JmRpc3AtPmF2YnVmKTsKKwkvKiBDaG9vc2UgY2xvY2sgc291cmNlIGJhc2VkIG9uIHRoZSBEVCBj
bG9jayBoYW5kbGUuICovCisJenlucW1wX2Rpc3BfYXZidWZfc2V0X2Nsb2Nrc19zb3VyY2VzKCZk
aXNwLT5hdmJ1ZiwgISFkaXNwLT5fcHNfcGNsaywKKwkJCQkJICAgICAhIWRpc3AtPmF1ZGlvLl9w
c19jbGssIHRydWUpOworCXp5bnFtcF9kaXNwX2F2YnVmX2VuYWJsZV9jaGFubmVscygmZGlzcC0+
YXZidWYpOworCXp5bnFtcF9kaXNwX2F2YnVmX2VuYWJsZV9hdWRpbygmZGlzcC0+YXZidWYpOwor
CisJenlucW1wX2Rpc3BfYXVkaW9fZW5hYmxlKCZkaXNwLT5hdWRpbyk7Cit9CisKKy8qKgorICog
enlucW1wX2Rpc3BfZGlzYWJsZSAtIERpc2FibGUgdGhlIGRpc3BsYXkgY29udHJvbGxlcgorICog
QGRpc3A6IERpc3BsYXkgY29udHJvbGxlcgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9k
aXNhYmxlKHN0cnVjdCB6eW5xbXBfZGlzcCAqZGlzcCkKK3sKKwlzdHJ1Y3QgZHJtX2NydGMgKmNy
dGMgPSAmZGlzcC0+Y3J0YzsKKworCXp5bnFtcF9kaXNwX2F1ZGlvX2Rpc2FibGUoJmRpc3AtPmF1
ZGlvKTsKKworCXp5bnFtcF9kaXNwX2F2YnVmX2Rpc2FibGVfYXVkaW8oJmRpc3AtPmF2YnVmKTsK
Kwl6eW5xbXBfZGlzcF9hdmJ1Zl9kaXNhYmxlX2NoYW5uZWxzKCZkaXNwLT5hdmJ1Zik7CisJenlu
cW1wX2Rpc3BfYXZidWZfZGlzYWJsZSgmZGlzcC0+YXZidWYpOworCisJLyogTWFyayB0aGUgZmxp
cCBpcyBkb25lIGFzIGNydGMgaXMgZGlzYWJsZWQgYW55d2F5ICovCisJaWYgKGNydGMtPnN0YXRl
LT5ldmVudCkgeworCQljb21wbGV0ZV9hbGwoY3J0Yy0+c3RhdGUtPmV2ZW50LT5iYXNlLmNvbXBs
ZXRpb24pOworCQljcnRjLT5zdGF0ZS0+ZXZlbnQgPSBOVUxMOworCX0KK30KKworc3RhdGljIGlu
bGluZSBzdHJ1Y3QgenlucW1wX2Rpc3AgKmNydGNfdG9fZGlzcChzdHJ1Y3QgZHJtX2NydGMgKmNy
dGMpCit7CisJcmV0dXJuIGNvbnRhaW5lcl9vZihjcnRjLCBzdHJ1Y3QgenlucW1wX2Rpc3AsIGNy
dGMpOworfQorCitzdGF0aWMgaW50IHp5bnFtcF9kaXNwX2NydGNfc2V0dXBfY2xvY2soc3RydWN0
IGRybV9jcnRjICpjcnRjLAorCQkJCQlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRf
bW9kZSkKK3sKKwlzdHJ1Y3QgenlucW1wX2Rpc3AgKmRpc3AgPSBjcnRjX3RvX2Rpc3AoY3J0Yyk7
CisJdW5zaWduZWQgbG9uZyBtb2RlX2Nsb2NrID0gYWRqdXN0ZWRfbW9kZS0+Y2xvY2sgKiAxMDAw
OworCXVuc2lnbmVkIGxvbmcgcmF0ZTsKKwlsb25nIGRpZmY7CisJaW50IHJldDsKKworCXJldCA9
IGNsa19zZXRfcmF0ZShkaXNwLT5wY2xrLCBtb2RlX2Nsb2NrKTsKKwlpZiAocmV0KSB7CisJCWRl
dl9lcnIoZGlzcC0+ZGV2LCAiZmFpbGVkIHRvIHNldCBhIHBpeGVsIGNsb2NrXG4iKTsKKwkJcmV0
dXJuIHJldDsKKwl9CisKKwlyYXRlID0gY2xrX2dldF9yYXRlKGRpc3AtPnBjbGspOworCWRpZmYg
PSByYXRlIC0gbW9kZV9jbG9jazsKKwlpZiAoYWJzKGRpZmYpID4gbW9kZV9jbG9jayAvIDIwKQor
CQlkZXZfaW5mbyhkaXNwLT5kZXYsCisJCQkgInJlcXVlc3RlZCBwaXhlbCByYXRlOiAlbHUgYWN0
dWFsIHJhdGU6ICVsdVxuIiwKKwkJCSBtb2RlX2Nsb2NrLCByYXRlKTsKKwllbHNlCisJCWRldl9k
YmcoZGlzcC0+ZGV2LAorCQkJInJlcXVlc3RlZCBwaXhlbCByYXRlOiAlbHUgYWN0dWFsIHJhdGU6
ICVsdVxuIiwKKwkJCW1vZGVfY2xvY2ssIHJhdGUpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRp
YyB2b2lkCit6eW5xbXBfZGlzcF9jcnRjX2F0b21pY19lbmFibGUoc3RydWN0IGRybV9jcnRjICpj
cnRjLAorCQkJICAgICAgIHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUpCit7
CisJc3RydWN0IHp5bnFtcF9kaXNwICpkaXNwID0gY3J0Y190b19kaXNwKGNydGMpOworCXN0cnVj
dCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJmNydGMtPnN0YXRlLT5hZGp1c3Rl
ZF9tb2RlOworCWludCByZXQsIHZyZWZyZXNoOworCisJenlucW1wX2Rpc3BfY3J0Y19zZXR1cF9j
bG9jayhjcnRjLCBhZGp1c3RlZF9tb2RlKTsKKworCXBtX3J1bnRpbWVfZ2V0X3N5bmMoZGlzcC0+
ZGV2KTsKKwlyZXQgPSBjbGtfcHJlcGFyZV9lbmFibGUoZGlzcC0+cGNsayk7CisJaWYgKHJldCkg
eworCQlkZXZfZXJyKGRpc3AtPmRldiwgImZhaWxlZCB0byBlbmFibGUgYSBwaXhlbCBjbG9ja1xu
Iik7CisJCXBtX3J1bnRpbWVfcHV0X3N5bmMoZGlzcC0+ZGV2KTsKKwkJcmV0dXJuOworCX0KKwor
CXp5bnFtcF9kaXNwX2JsZW5kX3NldF9vdXRwdXRfZm9ybWF0KCZkaXNwLT5ibGVuZCwKKwkJCQkJ
ICAgIFpZTlFNUF9EUFNVQl9GT1JNQVRfUkdCKTsKKwl6eW5xbXBfZGlzcF9ibGVuZF9zZXRfYmdf
Y29sb3IoJmRpc3AtPmJsZW5kLCAwLCAwLCAwKTsKKwl6eW5xbXBfZGlzcF9ibGVuZF9zZXRfZ2xv
YmFsX2FscGhhKCZkaXNwLT5ibGVuZCwgZmFsc2UsIDApOworCisJenlucW1wX2Rpc3BfZW5hYmxl
KGRpc3ApOworCisJLyogRGVsYXkgb2YgMyB2YmxhbmsgaW50ZXJ2YWxzIGZvciB0aW1pbmcgZ2Vu
IHRvIGJlIHN0YWJsZSAqLworCXZyZWZyZXNoID0gKGFkanVzdGVkX21vZGUtPmNsb2NrICogMTAw
MCkgLworCQkgICAoYWRqdXN0ZWRfbW9kZS0+dnRvdGFsICogYWRqdXN0ZWRfbW9kZS0+aHRvdGFs
KTsKKwltc2xlZXAoMyAqIDEwMDAgLyB2cmVmcmVzaCk7Cit9CisKK3N0YXRpYyB2b2lkCit6eW5x
bXBfZGlzcF9jcnRjX2F0b21pY19kaXNhYmxlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKKwkJCQlz
dHJ1Y3QgZHJtX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlKQoreworCXN0cnVjdCB6eW5xbXBf
ZGlzcCAqZGlzcCA9IGNydGNfdG9fZGlzcChjcnRjKTsKKworCXp5bnFtcF9kaXNwX3BsYW5lX2F0
b21pY19kaXNhYmxlKGNydGMtPnByaW1hcnksIE5VTEwpOworCXp5bnFtcF9kaXNwX2Rpc2FibGUo
ZGlzcCk7CisKKwlkcm1fY3J0Y192Ymxhbmtfb2ZmKCZkaXNwLT5jcnRjKTsKKworCWNsa19kaXNh
YmxlX3VucHJlcGFyZShkaXNwLT5wY2xrKTsKKwlwbV9ydW50aW1lX3B1dF9zeW5jKGRpc3AtPmRl
dik7Cit9CisKK3N0YXRpYyBpbnQgenlucW1wX2Rpc3BfY3J0Y19hdG9taWNfY2hlY2soc3RydWN0
IGRybV9jcnRjICpjcnRjLAorCQkJCQkgc3RydWN0IGRybV9jcnRjX3N0YXRlICpzdGF0ZSkKK3sK
KwlyZXR1cm4gZHJtX2F0b21pY19hZGRfYWZmZWN0ZWRfcGxhbmVzKHN0YXRlLT5zdGF0ZSwgY3J0
Yyk7Cit9CisKK3N0YXRpYyB2b2lkCit6eW5xbXBfZGlzcF9jcnRjX2F0b21pY19iZWdpbihzdHJ1
Y3QgZHJtX2NydGMgKmNydGMsCisJCQkgICAgICBzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKm9sZF9j
cnRjX3N0YXRlKQoreworCWRybV9jcnRjX3ZibGFua19vbihjcnRjKTsKK30KKworc3RhdGljIHZv
aWQKK3p5bnFtcF9kaXNwX2NydGNfYXRvbWljX2ZsdXNoKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywK
KwkJCSAgICAgIHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUpCit7CisJaWYg
KGNydGMtPnN0YXRlLT5ldmVudCkgeworCQlzdHJ1Y3QgZHJtX3BlbmRpbmdfdmJsYW5rX2V2ZW50
ICpldmVudDsKKworCQkvKiBDb25zdW1lIHRoZSBmbGlwX2RvbmUgZXZlbnQgZnJvbSBhdG9taWMg
aGVscGVyLiAqLworCQlldmVudCA9IGNydGMtPnN0YXRlLT5ldmVudDsKKwkJY3J0Yy0+c3RhdGUt
PmV2ZW50ID0gTlVMTDsKKworCQlldmVudC0+cGlwZSA9IGRybV9jcnRjX2luZGV4KGNydGMpOwor
CisJCVdBUk5fT04oZHJtX2NydGNfdmJsYW5rX2dldChjcnRjKSAhPSAwKTsKKworCQlzcGluX2xv
Y2tfaXJxKCZjcnRjLT5kZXYtPmV2ZW50X2xvY2spOworCQlkcm1fY3J0Y19hcm1fdmJsYW5rX2V2
ZW50KGNydGMsIGV2ZW50KTsKKwkJc3Bpbl91bmxvY2tfaXJxKCZjcnRjLT5kZXYtPmV2ZW50X2xv
Y2spOworCX0KK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY3J0Y19oZWxwZXJfZnVuY3Mg
enlucW1wX2Rpc3BfY3J0Y19oZWxwZXJfZnVuY3MgPSB7CisJLmF0b21pY19lbmFibGUJPSB6eW5x
bXBfZGlzcF9jcnRjX2F0b21pY19lbmFibGUsCisJLmF0b21pY19kaXNhYmxlCT0genlucW1wX2Rp
c3BfY3J0Y19hdG9taWNfZGlzYWJsZSwKKwkuYXRvbWljX2NoZWNrCT0genlucW1wX2Rpc3BfY3J0
Y19hdG9taWNfY2hlY2ssCisJLmF0b21pY19iZWdpbgk9IHp5bnFtcF9kaXNwX2NydGNfYXRvbWlj
X2JlZ2luLAorCS5hdG9taWNfZmx1c2gJPSB6eW5xbXBfZGlzcF9jcnRjX2F0b21pY19mbHVzaCwK
K307CisKK3N0YXRpYyBpbnQgenlucW1wX2Rpc3BfY3J0Y19lbmFibGVfdmJsYW5rKHN0cnVjdCBk
cm1fY3J0YyAqY3J0YykKK3sKKwlzdHJ1Y3QgenlucW1wX2Rpc3AgKmRpc3AgPSBjcnRjX3RvX2Rp
c3AoY3J0Yyk7CisKKwl6eW5xbXBfZHBfZW5hYmxlX3ZibGFuayhkaXNwLT5kcHN1Yi0+ZHApOwor
CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIHp5bnFtcF9kaXNwX2NydGNfZGlzYWJsZV92
Ymxhbmsoc3RydWN0IGRybV9jcnRjICpjcnRjKQoreworCXN0cnVjdCB6eW5xbXBfZGlzcCAqZGlz
cCA9IGNydGNfdG9fZGlzcChjcnRjKTsKKworCXp5bnFtcF9kcF9kaXNhYmxlX3ZibGFuayhkaXNw
LT5kcHN1Yi0+ZHApOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9jcnRjX2Z1bmNzIHp5
bnFtcF9kaXNwX2NydGNfZnVuY3MgPSB7CisJLmRlc3Ryb3kJCT0gZHJtX2NydGNfY2xlYW51cCwK
Kwkuc2V0X2NvbmZpZwkJPSBkcm1fYXRvbWljX2hlbHBlcl9zZXRfY29uZmlnLAorCS5wYWdlX2Zs
aXAJCT0gZHJtX2F0b21pY19oZWxwZXJfcGFnZV9mbGlwLAorCS5yZXNldAkJCT0gZHJtX2F0b21p
Y19oZWxwZXJfY3J0Y19yZXNldCwKKwkuYXRvbWljX2R1cGxpY2F0ZV9zdGF0ZQk9IGRybV9hdG9t
aWNfaGVscGVyX2NydGNfZHVwbGljYXRlX3N0YXRlLAorCS5hdG9taWNfZGVzdHJveV9zdGF0ZQk9
IGRybV9hdG9taWNfaGVscGVyX2NydGNfZGVzdHJveV9zdGF0ZSwKKwkuZW5hYmxlX3ZibGFuawkJ
PSB6eW5xbXBfZGlzcF9jcnRjX2VuYWJsZV92YmxhbmssCisJLmRpc2FibGVfdmJsYW5rCQk9IHp5
bnFtcF9kaXNwX2NydGNfZGlzYWJsZV92YmxhbmssCit9OworCitzdGF0aWMgaW50IHp5bnFtcF9k
aXNwX2NyZWF0ZV9jcnRjKHN0cnVjdCB6eW5xbXBfZGlzcCAqZGlzcCkKK3sKKwlzdHJ1Y3QgZHJt
X3BsYW5lICpwbGFuZSA9ICZkaXNwLT5sYXllcnNbWllOUU1QX0RJU1BfTEFZRVJfR0ZYXS5wbGFu
ZTsKKwlpbnQgcmV0OworCisJcmV0ID0gZHJtX2NydGNfaW5pdF93aXRoX3BsYW5lcyhkaXNwLT5k
cm0sICZkaXNwLT5jcnRjLCBwbGFuZSwKKwkJCQkJTlVMTCwgJnp5bnFtcF9kaXNwX2NydGNfZnVu
Y3MsIE5VTEwpOworCWlmIChyZXQgPCAwKQorCQlyZXR1cm4gcmV0OworCisJZHJtX2NydGNfaGVs
cGVyX2FkZCgmZGlzcC0+Y3J0YywgJnp5bnFtcF9kaXNwX2NydGNfaGVscGVyX2Z1bmNzKTsKKwor
CS8qIFN0YXJ0IHdpdGggdmVydGljYWwgYmxhbmtpbmcgaW50ZXJydXB0IHJlcG9ydGluZyBkaXNh
YmxlZC4gKi8KKwlkcm1fY3J0Y192Ymxhbmtfb2ZmKCZkaXNwLT5jcnRjKTsKKworCXJldHVybiAw
OworfQorCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9tYXBfY3J0Y190b19wbGFuZShzdHJ1Y3Qg
enlucW1wX2Rpc3AgKmRpc3ApCit7CisJdTMyIHBvc3NpYmxlX2NydGNzID0gZHJtX2NydGNfbWFz
aygmZGlzcC0+Y3J0Yyk7CisJdW5zaWduZWQgaW50IGk7CisKKwlmb3IgKGkgPSAwOyBpIDwgWllO
UU1QX0RJU1BfTlVNX0xBWUVSUzsgaSsrKQorCQlkaXNwLT5sYXllcnNbaV0ucGxhbmUucG9zc2li
bGVfY3J0Y3MgPSBwb3NzaWJsZV9jcnRjczsKK30KKworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0K
KyAqIEluaXRpYWxpemF0aW9uICYgQ2xlYW51cAorICovCisKK2ludCB6eW5xbXBfZGlzcF9pbml0
KHN0cnVjdCB6eW5xbXBfZHBzdWIgKmRwc3ViLCBzdHJ1Y3QgZHJtX2RldmljZSAqZHJtKQorewor
CXN0cnVjdCB6eW5xbXBfZGlzcCAqZGlzcCA9IGRwc3ViLT5kaXNwOworCWludCByZXQ7CisKKwlk
aXNwLT5kcm0gPSBkcm07CisKKwlyZXQgPSB6eW5xbXBfZGlzcF9jcmVhdGVfcGxhbmVzKGRpc3Ap
OworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwlyZXQgPSB6eW5xbXBfZGlzcF9jcmVhdGVf
Y3J0YyhkaXNwKTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0dXJuIHJldDsKKworCXp5bnFtcF9kaXNw
X21hcF9jcnRjX3RvX3BsYW5lKGRpc3ApOworCisJcmV0dXJuIDA7Cit9CisKK2ludCB6eW5xbXBf
ZGlzcF9wcm9iZShzdHJ1Y3QgenlucW1wX2Rwc3ViICpkcHN1Yiwgc3RydWN0IHBsYXRmb3JtX2Rl
dmljZSAqcGRldikKK3sKKwlzdHJ1Y3QgenlucW1wX2Rpc3AgKmRpc3A7CisJc3RydWN0IHp5bnFt
cF9kaXNwX2xheWVyICpsYXllcjsKKwlzdHJ1Y3QgcmVzb3VyY2UgKnJlczsKKwlpbnQgcmV0Owor
CisJZGlzcCA9IGRldm1fa3phbGxvYygmcGRldi0+ZGV2LCBzaXplb2YoKmRpc3ApLCBHRlBfS0VS
TkVMKTsKKwlpZiAoIWRpc3ApCisJCXJldHVybiAtRU5PTUVNOworCWRpc3AtPmRldiA9ICZwZGV2
LT5kZXY7CisKKwlyZXMgPSBwbGF0Zm9ybV9nZXRfcmVzb3VyY2VfYnluYW1lKHBkZXYsIElPUkVT
T1VSQ0VfTUVNLCAiYmxlbmQiKTsKKwlkaXNwLT5ibGVuZC5iYXNlID0gZGV2bV9pb3JlbWFwX3Jl
c291cmNlKCZwZGV2LT5kZXYsIHJlcyk7CisJaWYgKElTX0VSUihkaXNwLT5ibGVuZC5iYXNlKSkK
KwkJcmV0dXJuIFBUUl9FUlIoZGlzcC0+YmxlbmQuYmFzZSk7CisKKwlyZXMgPSBwbGF0Zm9ybV9n
ZXRfcmVzb3VyY2VfYnluYW1lKHBkZXYsIElPUkVTT1VSQ0VfTUVNLCAiYXZfYnVmIik7CisJZGlz
cC0+YXZidWYuYmFzZSA9IGRldm1faW9yZW1hcF9yZXNvdXJjZSgmcGRldi0+ZGV2LCByZXMpOwor
CWlmIChJU19FUlIoZGlzcC0+YXZidWYuYmFzZSkpCisJCXJldHVybiBQVFJfRVJSKGRpc3AtPmF2
YnVmLmJhc2UpOworCisJcmVzID0gcGxhdGZvcm1fZ2V0X3Jlc291cmNlX2J5bmFtZShwZGV2LCBJ
T1JFU09VUkNFX01FTSwgImF1ZCIpOworCWRpc3AtPmF1ZGlvLmJhc2UgPSBkZXZtX2lvcmVtYXBf
cmVzb3VyY2UoJnBkZXYtPmRldiwgcmVzKTsKKwlpZiAoSVNfRVJSKGRpc3AtPmF1ZGlvLmJhc2Up
KQorCQlyZXR1cm4gUFRSX0VSUihkaXNwLT5hdWRpby5iYXNlKTsKKworCWRwc3ViLT5kaXNwID0g
ZGlzcDsKKwlkaXNwLT5kcHN1YiA9IGRwc3ViOworCisJLyogVHJ5IHRoZSBsaXZlIFBMIHZpZGVv
IGNsb2NrICovCisJZGlzcC0+X3BsX3BjbGsgPSBkZXZtX2Nsa19nZXQoZGlzcC0+ZGV2LCAiZHBf
bGl2ZV92aWRlb19pbl9jbGsiKTsKKwlpZiAoIUlTX0VSUihkaXNwLT5fcGxfcGNsaykpCisJCWRp
c3AtPnBjbGsgPSBkaXNwLT5fcGxfcGNsazsKKwllbHNlIGlmIChQVFJfRVJSKGRpc3AtPl9wbF9w
Y2xrKSA9PSAtRVBST0JFX0RFRkVSKQorCQlyZXR1cm4gUFRSX0VSUihkaXNwLT5fcGxfcGNsayk7
CisKKwkvKiBJZiB0aGUgbGl2ZSBQTCB2aWRlbyBjbG9jayBpcyBub3QgdmFsaWQsIGZhbGwgYmFj
ayB0byBQUyBjbG9jayAqLworCWlmICghZGlzcC0+cGNsaykgeworCQlkaXNwLT5fcHNfcGNsayA9
IGRldm1fY2xrX2dldChkaXNwLT5kZXYsICJkcF92dGNfcGl4ZWxfY2xrX2luIik7CisJCWlmIChJ
U19FUlIoZGlzcC0+X3BzX3BjbGspKSB7CisJCQlkZXZfZXJyKGRpc3AtPmRldiwgImZhaWxlZCB0
byBpbml0IGFueSB2aWRlbyBjbG9ja1xuIik7CisJCQlyZXR1cm4gUFRSX0VSUihkaXNwLT5fcHNf
cGNsayk7CisJCX0KKwkJZGlzcC0+cGNsayA9IGRpc3AtPl9wc19wY2xrOworCX0KKworCXp5bnFt
cF9kaXNwX2F1ZGlvX2luaXQoZGlzcC0+ZGV2LCAmZGlzcC0+YXVkaW8pOworCisJcmV0ID0genlu
cW1wX2Rpc3BfY3JlYXRlX2xheWVycyhkaXNwKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0Owor
CisJbGF5ZXIgPSAmZGlzcC0+bGF5ZXJzW1pZTlFNUF9ESVNQX0xBWUVSX1ZJRF07CisJZHBzdWIt
PmRtYV9hbGlnbiA9IDEgPDwgbGF5ZXItPmRtYXNbMF0uY2hhbi0+ZGV2aWNlLT5jb3B5X2FsaWdu
OworCisJcmV0dXJuIDA7Cit9CisKK3ZvaWQgenlucW1wX2Rpc3BfcmVtb3ZlKHN0cnVjdCB6eW5x
bXBfZHBzdWIgKmRwc3ViKQoreworCXN0cnVjdCB6eW5xbXBfZGlzcCAqZGlzcCA9IGRwc3ViLT5k
aXNwOworCisJenlucW1wX2Rpc3BfZGVzdHJveV9sYXllcnMoZGlzcCk7CisJZHBzdWItPmRpc3Ag
PSBOVUxMOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rpc3Au
aCBiL2RyaXZlcnMvZ3B1L2RybS94bG54L3p5bnFtcF9kaXNwLmgKbmV3IGZpbGUgbW9kZSAxMDA2
NDQKaW5kZXggMDAwMDAwMDAwMDAwLi45M2FkMzZhZDdlZjMKLS0tIC9kZXYvbnVsbAorKysgYi9k
cml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZGlzcC5oCkBAIC0wLDAgKzEsNDMgQEAKKy8qIFNQ
RFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovCisvKgorICogWnlucU1QIERpc3BsYXkg
RHJpdmVyCisgKgorICogQ29weXJpZ2h0IChDKSAyMDE3IC0gMjAxOSBYaWxpbngsIEluYy4KKyAq
CisgKiBBdXRob3JzOgorICogLSBIeXVuIFdvbyBLd29uIDxoeXVuLmt3b25AeGlsaW54LmNvbT4K
KyAqIC0gTGF1cmVudCBQaW5jaGFydCA8bGF1cmVudC5waW5jaGFydEBpZGVhc29uYm9hcmQuY29t
PgorICovCisKKyNpZm5kZWYgX1pZTlFNUF9ESVNQX0hfCisjZGVmaW5lIF9aWU5RTVBfRElTUF9I
XworCisjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KKworLyoKKyAqIDM4NDB4MjE2MCBpcyBhZHZl
cnRpc2VkIGFzIHRoZSBtYXhpbXVtIHJlc29sdXRpb24sIGJ1dCBhbG1vc3QgYW55CisgKiByZXNv
bHV0aW9ucyB1bmRlciBhIDMwME1oeiBwaXhlbCByYXRlIHdvdWxkIHdvcmsuIFBpY2sgNDA5Nng0
MDk2LgorICovCisjZGVmaW5lIFpZTlFNUF9ESVNQX01BWF9XSURUSAkJCQk0MDk2CisjZGVmaW5l
IFpZTlFNUF9ESVNQX01BWF9IRUlHSFQJCQkJNDA5NgorCisvKiBUaGUgRFBETUEgaXMgbGltaXRl
ZCB0byA0NCBiaXQgYWRkcmVzc2luZy4gKi8KKyNkZWZpbmUgWllOUU1QX0RJU1BfTUFYX0RNQV9C
SVQJCQkJNDQKKworc3RydWN0IGRldmljZTsKK3N0cnVjdCBkcm1fZGV2aWNlOworc3RydWN0IHBs
YXRmb3JtX2RldmljZTsKK3N0cnVjdCB6eW5xbXBfZGlzcDsKK3N0cnVjdCB6eW5xbXBfZHBzdWI7
CisKK3ZvaWQgenlucW1wX2Rpc3BfaGFuZGxlX3ZibGFuayhzdHJ1Y3QgenlucW1wX2Rpc3AgKmRp
c3ApOworYm9vbCB6eW5xbXBfZGlzcF9hdWRpb19lbmFibGVkKHN0cnVjdCB6eW5xbXBfZGlzcCAq
ZGlzcCk7Cit1bnNpZ25lZCBpbnQgenlucW1wX2Rpc3BfZ2V0X2F1ZGlvX2Nsa19yYXRlKHN0cnVj
dCB6eW5xbXBfZGlzcCAqZGlzcCk7Cit1aW50MzJfdCB6eW5xbXBfZGlzcF9nZXRfY3J0Y19tYXNr
KHN0cnVjdCB6eW5xbXBfZGlzcCAqZGlzcCk7CisKK2ludCB6eW5xbXBfZGlzcF9pbml0KHN0cnVj
dCB6eW5xbXBfZHBzdWIgKmRwc3ViLCBzdHJ1Y3QgZHJtX2RldmljZSAqZHJtKTsKKworaW50IHp5
bnFtcF9kaXNwX3Byb2JlKHN0cnVjdCB6eW5xbXBfZHBzdWIgKmRwc3ViLCBzdHJ1Y3QgcGxhdGZv
cm1fZGV2aWNlICpwZGV2KTsKK3ZvaWQgenlucW1wX2Rpc3BfcmVtb3ZlKHN0cnVjdCB6eW5xbXBf
ZHBzdWIgKmRwc3ViKTsKKworI2VuZGlmIC8qIF9aWU5RTVBfRElTUF9IXyAqLwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rpc3BfcmVncy5oIGIvZHJpdmVycy9ncHUv
ZHJtL3hsbngvenlucW1wX2Rpc3BfcmVncy5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAw
MDAwMDAwMDAwMC4uYzkyZTJjMmJkMjJlCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL3hsbngvenlucW1wX2Rpc3BfcmVncy5oCkBAIC0wLDAgKzEsMjAxIEBACisvKiBTUERYLUxp
Y2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCAqLworLyoKKyAqIFp5bnFNUCBEaXNwbGF5IENvbnRy
b2xsZXIgRHJpdmVyIC0gUmVnaXN0ZXIgRGVmaW5pdGlvbnMKKyAqCisgKiBDb3B5cmlnaHQgKEMp
IDIwMTcgLSAyMDE5IFhpbGlueCwgSW5jLgorICoKKyAqIEF1dGhvcnM6CisgKiAtIEh5dW4gV29v
IEt3b24gPGh5dW4ua3dvbkB4aWxpbnguY29tPgorICogLSBMYXVyZW50IFBpbmNoYXJ0IDxsYXVy
ZW50LnBpbmNoYXJ0QGlkZWFzb25ib2FyZC5jb20+CisgKi8KKworI2lmbmRlZiBfWllOUU1QX0RJ
U1BfUkVHU19IXworI2RlZmluZSBfWllOUU1QX0RJU1BfUkVHU19IXworCisjaW5jbHVkZSA8bGlu
dXgvYml0cy5oPgorCisvKiBCbGVuZGVyIHJlZ2lzdGVycyAqLworI2RlZmluZSBaWU5RTVBfRElT
UF9WX0JMRU5EX0JHX0NMUl8wCQkJMHgwCisjZGVmaW5lIFpZTlFNUF9ESVNQX1ZfQkxFTkRfQkdf
Q0xSXzEJCQkweDQKKyNkZWZpbmUgWllOUU1QX0RJU1BfVl9CTEVORF9CR19DTFJfMgkJCTB4OAor
I2RlZmluZSBaWU5RTVBfRElTUF9WX0JMRU5EX0JHX01BWAkJCTB4ZmZmCisjZGVmaW5lIFpZTlFN
UF9ESVNQX1ZfQkxFTkRfU0VUX0dMT0JBTF9BTFBIQQkJMHhjCisjZGVmaW5lIFpZTlFNUF9ESVNQ
X1ZfQkxFTkRfU0VUX0dMT0JBTF9BTFBIQV9WQUxVRShuKQkoKG4pIDw8IDEpCisjZGVmaW5lIFpZ
TlFNUF9ESVNQX1ZfQkxFTkRfU0VUX0dMT0JBTF9BTFBIQV9FTgkJQklUKDApCisjZGVmaW5lIFpZ
TlFNUF9ESVNQX1ZfQkxFTkRfT1VUUFVUX1ZJRF9GTVQJCTB4MTQKKyNkZWZpbmUgWllOUU1QX0RJ
U1BfVl9CTEVORF9PVVRQVVRfVklEX0ZNVF9SR0IJCTB4MAorI2RlZmluZSBaWU5RTVBfRElTUF9W
X0JMRU5EX09VVFBVVF9WSURfRk1UX1lDQkNSNDQ0CTB4MQorI2RlZmluZSBaWU5RTVBfRElTUF9W
X0JMRU5EX09VVFBVVF9WSURfRk1UX1lDQkNSNDIyCTB4MgorI2RlZmluZSBaWU5RTVBfRElTUF9W
X0JMRU5EX09VVFBVVF9WSURfRk1UX1lPTkxZCTB4MworI2RlZmluZSBaWU5RTVBfRElTUF9WX0JM
RU5EX09VVFBVVF9WSURfRk1UX1hWWUNDCTB4NAorI2RlZmluZSBaWU5RTVBfRElTUF9WX0JMRU5E
X09VVFBVVF9WSURfRk1UX0VOX0RPV05TQU1QTEUJQklUKDQpCisjZGVmaW5lIFpZTlFNUF9ESVNQ
X1ZfQkxFTkRfTEFZRVJfQ09OVFJPTChuKQkJKDB4MTggKyAoKG4pICogNCkpCisjZGVmaW5lIFpZ
TlFNUF9ESVNQX1ZfQkxFTkRfTEFZRVJfQ09OVFJPTF9FTl9VUwkJQklUKDApCisjZGVmaW5lIFpZ
TlFNUF9ESVNQX1ZfQkxFTkRfTEFZRVJfQ09OVFJPTF9SR0IJCUJJVCgxKQorI2RlZmluZSBaWU5R
TVBfRElTUF9WX0JMRU5EX0xBWUVSX0NPTlRST0xfQllQQVNTCUJJVCg4KQorI2RlZmluZSBaWU5R
TVBfRElTUF9WX0JMRU5EX05VTV9DT0VGRgkJCTkKKyNkZWZpbmUgWllOUU1QX0RJU1BfVl9CTEVO
RF9OVU1fT0ZGU0VUCQkJMworI2RlZmluZSBaWU5RTVBfRElTUF9WX0JMRU5EX1JHQjJZQ0JDUl9D
T0VGRihuKQkJKDB4MjAgKyAoKG4pICogNCkpCisjZGVmaW5lIFpZTlFNUF9ESVNQX1ZfQkxFTkRf
SU4xQ1NDX0NPRUZGKG4pCQkoMHg0NCArICgobikgKiA0KSkKKyNkZWZpbmUgWllOUU1QX0RJU1Bf
Vl9CTEVORF9JTjFDU0NfT0ZGU0VUKG4pCQkoMHg2OCArICgobikgKiA0KSkKKyNkZWZpbmUgWllO
UU1QX0RJU1BfVl9CTEVORF9PVVRDU0NfT0ZGU0VUKG4pCQkoMHg3NCArICgobikgKiA0KSkKKyNk
ZWZpbmUgWllOUU1QX0RJU1BfVl9CTEVORF9JTjJDU0NfQ09FRkYobikJCSgweDgwICsgKChuKSAq
IDQpKQorI2RlZmluZSBaWU5RTVBfRElTUF9WX0JMRU5EX0lOMkNTQ19PRkZTRVQobikJCSgweGE0
ICsgKChuKSAqIDQpKQorI2RlZmluZSBaWU5RTVBfRElTUF9WX0JMRU5EX0NIUk9NQV9LRVlfRU5B
QkxFCQkweDFkMAorI2RlZmluZSBaWU5RTVBfRElTUF9WX0JMRU5EX0NIUk9NQV9LRVlfQ09NUDEJ
CTB4MWQ0CisjZGVmaW5lIFpZTlFNUF9ESVNQX1ZfQkxFTkRfQ0hST01BX0tFWV9DT01QMgkJMHgx
ZDgKKyNkZWZpbmUgWllOUU1QX0RJU1BfVl9CTEVORF9DSFJPTUFfS0VZX0NPTVAzCQkweDFkYwor
CisvKiBBViBidWZmZXIgbWFuYWdlciByZWdpc3RlcnMgKi8KKyNkZWZpbmUgWllOUU1QX0RJU1Bf
QVZfQlVGX0ZNVAkJCQkweDAKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURf
U0hJRlQJCTAKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfTUFTSwkJKDB4
MWYgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfVVlWWQkJKDAg
PDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfVllVWQkJKDEgPDwg
MCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVZZVQkJKDIgPDwgMCkK
KyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVVZVgkJKDMgPDwgMCkKKyNk
ZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVYxNgkJKDQgPDwgMCkKKyNkZWZp
bmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVYyNAkJKDUgPDwgMCkKKyNkZWZpbmUg
WllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVYxNkNJCQkoNiA8PCAwKQorI2RlZmluZSBa
WU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9NT05PCQkoNyA8PCAwKQorI2RlZmluZSBaWU5R
TVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9ZVjE2Q0kyCQkoOCA8PCAwKQorI2RlZmluZSBaWU5R
TVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9ZVVY0NDQJCSg5IDw8IDApCisjZGVmaW5lIFpZTlFN
UF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1JHQjg4OAkJKDEwIDw8IDApCisjZGVmaW5lIFpZTlFN
UF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1JHQkE4ODgwCQkoMTEgPDwgMCkKKyNkZWZpbmUgWllO
UU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfUkdCODg4XzEwCQkoMTIgPDwgMCkKKyNkZWZpbmUg
WllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVVWNDQ0XzEwCQkoMTMgPDwgMCkKKyNkZWZp
bmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVYxNkNJMl8xMAkoMTQgPDwgMCkKKyNk
ZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVYxNkNJXzEwCQkoMTUgPDwgMCkK
KyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVYxNl8xMAkJKDE2IDw8IDAp
CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1lWMjRfMTAJCSgxNyA8PCAw
KQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9ZT05MWV8xMAkJKDE4IDw8
IDApCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1lWMTZfNDIwCQkoMTkg
PDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVYxNkNJXzQyMAko
MjAgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVYxNkNJMl80
MjAJKDIxIDw8IDApCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1lWMTZf
NDIwXzEwCSgyMiA8PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9Z
VjE2Q0lfNDIwXzEwCSgyMyA8PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05M
X1ZJRF9ZVjE2Q0kyXzQyMF8xMAkoMjQgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVG
X0ZNVF9OTF9HRlhfU0hJRlQJCTgKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9H
RlhfTUFTSwkJKDB4ZiA8PCA4KQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX0dG
WF9SR0JBODg4OAkJKDAgPDwgOCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9H
RlhfQUJHUjg4ODgJCSgxIDw8IDgpCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxf
R0ZYX1JHQjg4OAkJKDIgPDwgOCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9H
RlhfQkdSODg4CQkoMyA8PCA4KQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX0dG
WF9SR0JBNTU1MQkJKDQgPDwgOCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9H
RlhfUkdCQTQ0NDQJCSg1IDw8IDgpCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxf
R0ZYX1JHQjU2NQkJKDYgPDwgOCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9H
RlhfOEJQUAkJKDcgPDwgOCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9HRlhf
NEJQUAkJKDggPDwgOCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9HRlhfMkJQ
UAkJKDkgPDwgOCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9HRlhfMUJQUAkJ
KDEwIDw8IDgpCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9OT05fTElWRV9MQVRFTkNZCQkw
eDgKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0NIQlVGKG4pCQkJKDB4MTAgKyAoKG4pICog
NCkpCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9DSEJVRl9FTgkJCUJJVCgwKQorI2RlZmlu
ZSBaWU5RTVBfRElTUF9BVl9CVUZfQ0hCVUZfRkxVU0gJCQlCSVQoMSkKKyNkZWZpbmUgWllOUU1Q
X0RJU1BfQVZfQlVGX0NIQlVGX0JVUlNUX0xFTl9TSElGVAkyCisjZGVmaW5lIFpZTlFNUF9ESVNQ
X0FWX0JVRl9DSEJVRl9CVVJTVF9MRU5fTUFTSwkJKDB4ZiA8PCAyKQorI2RlZmluZSBaWU5RTVBf
RElTUF9BVl9CVUZfQ0hCVUZfQlVSU1RfTEVOX01BWAkJMHhmCisjZGVmaW5lIFpZTlFNUF9ESVNQ
X0FWX0JVRl9DSEJVRl9CVVJTVF9MRU5fQVVEX01BWAkweDMKKyNkZWZpbmUgWllOUU1QX0RJU1Bf
QVZfQlVGX1NUQVRVUwkJCTB4MjgKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX1NUQ19DVFJM
CQkJMHgyYworI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfU1RDX0NUUkxfRU4JCQlCSVQoMCkK
KyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX1NUQ19DVFJMX0VWRU5UX1NISUZUCQkxCisjZGVm
aW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9TVENfQ1RSTF9FVkVOVF9FWF9WU1lOQwkwCisjZGVmaW5l
IFpZTlFNUF9ESVNQX0FWX0JVRl9TVENfQ1RSTF9FVkVOVF9FWF9WSUQJMQorI2RlZmluZSBaWU5R
TVBfRElTUF9BVl9CVUZfU1RDX0NUUkxfRVZFTlRfRVhfQVVECTIKKyNkZWZpbmUgWllOUU1QX0RJ
U1BfQVZfQlVGX1NUQ19DVFJMX0VWRU5UX0lOVF9WU1lOQwkzCisjZGVmaW5lIFpZTlFNUF9ESVNQ
X0FWX0JVRl9TVENfSU5JVF9WQUxVRTAJCTB4MzAKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVG
X1NUQ19JTklUX1ZBTFVFMQkJMHgzNAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfU1RDX0FE
SgkJCTB4MzgKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX1NUQ19WSURfVlNZTkNfVFMwCQkw
eDNjCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9TVENfVklEX1ZTWU5DX1RTMQkJMHg0MAor
I2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfU1RDX0VYVF9WU1lOQ19UUzAJCTB4NDQKKyNkZWZp
bmUgWllOUU1QX0RJU1BfQVZfQlVGX1NUQ19FWFRfVlNZTkNfVFMxCQkweDQ4CisjZGVmaW5lIFpZ
TlFNUF9ESVNQX0FWX0JVRl9TVENfQ1VTVE9NX0VWRU5UX1RTMAkJMHg0YworI2RlZmluZSBaWU5R
TVBfRElTUF9BVl9CVUZfU1RDX0NVU1RPTV9FVkVOVF9UUzEJCTB4NTAKKyNkZWZpbmUgWllOUU1Q
X0RJU1BfQVZfQlVGX1NUQ19DVVNUT01fRVZFTlQyX1RTMAkweDU0CisjZGVmaW5lIFpZTlFNUF9E
SVNQX0FWX0JVRl9TVENfQ1VTVE9NX0VWRU5UMl9UUzEJMHg1OAorI2RlZmluZSBaWU5RTVBfRElT
UF9BVl9CVUZfU1RDX1NOQVBTSE9UMAkJMHg2MAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZf
U1RDX1NOQVBTSE9UMQkJMHg2NAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVUCQkJ
MHg3MAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVUX1ZJRDFfU0hJRlQJCTAKKyNk
ZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9WSUQxX01BU0sJCSgweDMgPDwgMCkKKyNk
ZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9WSUQxX0xJVkUJCSgwIDw8IDApCisjZGVm
aW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfVklEMV9NRU0JCSgxIDw8IDApCisjZGVmaW5l
IFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfVklEMV9QQVRURVJOCQkoMiA8PCAwKQorI2RlZmlu
ZSBaWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVUX1ZJRDFfTk9ORQkJKDMgPDwgMCkKKyNkZWZpbmUg
WllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9WSUQyX1NISUZUCQkyCisjZGVmaW5lIFpZTlFNUF9E
SVNQX0FWX0JVRl9PVVRQVVRfVklEMl9NQVNLCQkoMHgzIDw8IDIpCisjZGVmaW5lIFpZTlFNUF9E
SVNQX0FWX0JVRl9PVVRQVVRfVklEMl9ESVNBQkxFCQkoMCA8PCAyKQorI2RlZmluZSBaWU5RTVBf
RElTUF9BVl9CVUZfT1VUUFVUX1ZJRDJfTUVNCQkoMSA8PCAyKQorI2RlZmluZSBaWU5RTVBfRElT
UF9BVl9CVUZfT1VUUFVUX1ZJRDJfTElWRQkJKDIgPDwgMikKKyNkZWZpbmUgWllOUU1QX0RJU1Bf
QVZfQlVGX09VVFBVVF9WSUQyX05PTkUJCSgzIDw8IDIpCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FW
X0JVRl9PVVRQVVRfQVVEMV9TSElGVAkJNAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfT1VU
UFVUX0FVRDFfTUFTSwkJKDB4MyA8PCA0KQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfT1VU
UFVUX0FVRDFfUEwJCSgwIDw8IDQpCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRf
QVVEMV9NRU0JCSgxIDw8IDQpCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfQVVE
MV9QQVRURVJOCQkoMiA8PCA0KQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVUX0FV
RDFfRElTQUJMRQkJKDMgPDwgNCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9B
VUQyX0VOCQlCSVQoNikKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0hDT1VOVF9WQ09VTlRf
SU5UMAkJMHg3NAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfSENPVU5UX1ZDT1VOVF9JTlQx
CQkweDc4CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9QQVRURVJOX0dFTl9TRUxFQ1QJCTB4
MTAwCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9DTEtfU1JDCQkJMHgxMjAKKyNkZWZpbmUg
WllOUU1QX0RJU1BfQVZfQlVGX0NMS19TUkNfVklEX0ZST01fUFMJCUJJVCgwKQorI2RlZmluZSBa
WU5RTVBfRElTUF9BVl9CVUZfQ0xLX1NSQ19BVURfRlJPTV9QUwkJQklUKDEpCisjZGVmaW5lIFpZ
TlFNUF9ESVNQX0FWX0JVRl9DTEtfU1JDX1ZJRF9JTlRFUk5BTF9USU1JTkcJQklUKDIpCisjZGVm
aW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9TUlNUX1JFRwkJCTB4MTI0CisjZGVmaW5lIFpZTlFNUF9E
SVNQX0FWX0JVRl9TUlNUX1JFR19WSURfUlNUCQlCSVQoMSkKKyNkZWZpbmUgWllOUU1QX0RJU1Bf
QVZfQlVGX0FVRElPX0NIX0NPTkZJRwkJMHgxMmMKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVG
X0dGWF9DT01QX1NGKG4pCQkoMHgyMDAgKyAoKG4pICogNCkpCisjZGVmaW5lIFpZTlFNUF9ESVNQ
X0FWX0JVRl9WSURfQ09NUF9TRihuKQkJKDB4MjBjICsgKChuKSAqIDQpKQorI2RlZmluZSBaWU5R
TVBfRElTUF9BVl9CVUZfTElWRF9WSURfQ09NUF9TRihuKQkJKDB4MjE4ICsgKChuKSAqIDQpKQor
I2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfTElWRV9WSURfQ09ORklHCQkweDIyNAorI2RlZmlu
ZSBaWU5RTVBfRElTUF9BVl9CVUZfTElWRF9HRlhfQ09NUF9TRihuKQkJKDB4MjI4ICsgKChuKSAq
IDQpKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfTElWRV9HRlhfQ09ORklHCQkweDIzNAor
I2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfNEJJVF9TRgkJCTB4MTExMTEKKyNkZWZpbmUgWllO
UU1QX0RJU1BfQVZfQlVGXzVCSVRfU0YJCQkweDEwODQyCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FW
X0JVRl82QklUX1NGCQkJMHgxMDQxMAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfOEJJVF9T
RgkJCTB4MTAxMDEKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGXzEwQklUX1NGCQkJMHgxMDA0
MAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfTlVMTF9TRgkJCTAKKyNkZWZpbmUgWllOUU1Q
X0RJU1BfQVZfQlVGX05VTV9TRgkJCTMKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0xJVkVf
Q09ORklHX0JQQ182CQkweDAKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0xJVkVfQ09ORklH
X0JQQ184CQkweDEKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0xJVkVfQ09ORklHX0JQQ18x
MAkJMHgyCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9MSVZFX0NPTkZJR19CUENfMTIJCTB4
MworI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfTElWRV9DT05GSUdfQlBDX01BU0sJCUdFTk1B
U0soMiwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0xJVkVfQ09ORklHX0ZNVF9SR0IJ
CTB4MAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfTElWRV9DT05GSUdfRk1UX1lVVjQ0NAkw
eDEKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0xJVkVfQ09ORklHX0ZNVF9ZVVY0MjIJMHgy
CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9MSVZFX0NPTkZJR19GTVRfWU9OTFkJMHgzCisj
ZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9MSVZFX0NPTkZJR19GTVRfTUFTSwkJR0VOTUFTSyg1
LCA0KQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfTElWRV9DT05GSUdfQ0JfRklSU1QJCUJJ
VCg4KQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfUEFMRVRURV9NRU1PUlkJCTB4NDAwCisK
Ky8qIEF1ZGlvIHJlZ2lzdGVycyAqLworI2RlZmluZSBaWU5RTVBfRElTUF9BVURfTUlYRVJfVk9M
VU1FCQkJMHgwCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FVRF9NSVhFUl9WT0xVTUVfTk9fU0NBTEUJ
CTB4MjAwMDIwMDAKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVVEX01JWEVSX01FVEFfREFUQQkJCTB4
NAorI2RlZmluZSBaWU5RTVBfRElTUF9BVURfQ0hfU1RBVFVTMAkJCTB4OAorI2RlZmluZSBaWU5R
TVBfRElTUF9BVURfQ0hfU1RBVFVTMQkJCTB4YworI2RlZmluZSBaWU5RTVBfRElTUF9BVURfQ0hf
U1RBVFVTMgkJCTB4MTAKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVVEX0NIX1NUQVRVUzMJCQkweDE0
CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FVRF9DSF9TVEFUVVM0CQkJMHgxOAorI2RlZmluZSBaWU5R
TVBfRElTUF9BVURfQ0hfU1RBVFVTNQkJCTB4MWMKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVVEX0NI
X0FfREFUQTAJCQkweDIwCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FVRF9DSF9BX0RBVEExCQkJMHgy
NAorI2RlZmluZSBaWU5RTVBfRElTUF9BVURfQ0hfQV9EQVRBMgkJCTB4MjgKKyNkZWZpbmUgWllO
UU1QX0RJU1BfQVVEX0NIX0FfREFUQTMJCQkweDJjCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FVRF9D
SF9BX0RBVEE0CQkJMHgzMAorI2RlZmluZSBaWU5RTVBfRElTUF9BVURfQ0hfQV9EQVRBNQkJCTB4
MzQKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVVEX0NIX0JfREFUQTAJCQkweDM4CisjZGVmaW5lIFpZ
TlFNUF9ESVNQX0FVRF9DSF9CX0RBVEExCQkJMHgzYworI2RlZmluZSBaWU5RTVBfRElTUF9BVURf
Q0hfQl9EQVRBMgkJCTB4NDAKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVVEX0NIX0JfREFUQTMJCQkw
eDQ0CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FVRF9DSF9CX0RBVEE0CQkJMHg0OAorI2RlZmluZSBa
WU5RTVBfRElTUF9BVURfQ0hfQl9EQVRBNQkJCTB4NGMKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVVE
X1NPRlRfUkVTRVQJCQkweGMwMAorI2RlZmluZSBaWU5RTVBfRElTUF9BVURfU09GVF9SRVNFVF9B
VURfU1JTVAkJQklUKDApCisKKyNlbmRpZiAvKiBfWllOUU1QX0RJU1BfUkVHU19IXyAqLwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2RwLmMgYi9kcml2ZXJzL2dwdS9k
cm0veGxueC96eW5xbXBfZHAuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAw
MDAuLjIzOTYwMWEwMGU5ZAotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS94bG54
L3p5bnFtcF9kcC5jCkBAIC0wLDAgKzEsMTY3NyBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IEdQTC0yLjAKKy8qCisgKiBaeW5xTVAgRGlzcGxheVBvcnQgRHJpdmVyCisgKgorICogQ29w
eXJpZ2h0IChDKSAyMDE3IC0gMjAxOSBYaWxpbngsIEluYy4KKyAqCisgKiBBdXRob3JzOgorICog
LSBIeXVuIFdvbyBLd29uIDxoeXVuLmt3b25AeGlsaW54LmNvbT4KKyAqIC0gTGF1cmVudCBQaW5j
aGFydCA8bGF1cmVudC5waW5jaGFydEBpZGVhc29uYm9hcmQuY29tPgorICovCisKKyNpbmNsdWRl
IDxkcm0vZHJtX2F0b21pY19oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2Nvbm5lY3Rvci5o
PgorI2luY2x1ZGUgPGRybS9kcm1fY3J0Yy5oPgorI2luY2x1ZGUgPGRybS9kcm1fZGV2aWNlLmg+
CisjaW5jbHVkZSA8ZHJtL2RybV9kcF9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2VkaWQu
aD4KKyNpbmNsdWRlIDxkcm0vZHJtX2VuY29kZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX21vZGVz
Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV9vZi5oPgorI2luY2x1ZGUgPGRybS9kcm1fcHJvYmVfaGVs
cGVyLmg+CisKKyNpbmNsdWRlIDxsaW51eC9jbGsuaD4KKyNpbmNsdWRlIDxsaW51eC9kZWxheS5o
PgorI2luY2x1ZGUgPGxpbnV4L2RldmljZS5oPgorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgor
I2luY2x1ZGUgPGxpbnV4L3BsYXRmb3JtX2RldmljZS5oPgorI2luY2x1ZGUgPGxpbnV4L3BtX3J1
bnRpbWUuaD4KKyNpbmNsdWRlIDxsaW51eC9waHkvcGh5Lmg+CisKKyNpbmNsdWRlICJ6eW5xbXBf
ZGlzcC5oIgorI2luY2x1ZGUgInp5bnFtcF9kcC5oIgorI2luY2x1ZGUgInp5bnFtcF9kcHN1Yi5o
IgorCitzdGF0aWMgdWludCB6eW5xbXBfZHBfYXV4X3RpbWVvdXRfbXMgPSA1MDsKK21vZHVsZV9w
YXJhbV9uYW1lZChhdXhfdGltZW91dF9tcywgenlucW1wX2RwX2F1eF90aW1lb3V0X21zLCB1aW50
LCAwNDQ0KTsKK01PRFVMRV9QQVJNX0RFU0MoYXV4X3RpbWVvdXRfbXMsICJEUCBhdXggdGltZW91
dCB2YWx1ZSBpbiBtc2VjIChkZWZhdWx0OiA1MCkiKTsKKworLyoKKyAqIFNvbWUgc2luayByZXF1
aXJlcyBhIGRlbGF5IGFmdGVyIHBvd2VyIG9uIHJlcXVlc3QKKyAqLworc3RhdGljIHVpbnQgenlu
cW1wX2RwX3Bvd2VyX29uX2RlbGF5X21zID0gNDsKK21vZHVsZV9wYXJhbV9uYW1lZChwb3dlcl9v
bl9kZWxheV9tcywgenlucW1wX2RwX3Bvd2VyX29uX2RlbGF5X21zLCB1aW50LCAwNDQ0KTsKK01P
RFVMRV9QQVJNX0RFU0MoYXV4X3RpbWVvdXRfbXMsICJEUCBwb3dlciBvbiBkZWxheSBpbiBtc2Vj
IChkZWZhdWx0OiA0KSIpOworCisvKiBMaW5rIGNvbmZpZ3VyYXRpb24gcmVnaXN0ZXJzICovCisj
ZGVmaW5lIFpZTlFNUF9EUF9MSU5LX0JXX1NFVAkJCQkweDAKKyNkZWZpbmUgWllOUU1QX0RQX0xB
TkVfQ09VTlRfU0VUCQkJMHg0CisjZGVmaW5lIFpZTlFNUF9EUF9FTkhBTkNFRF9GUkFNRV9FTgkJ
CTB4OAorI2RlZmluZSBaWU5RTVBfRFBfVFJBSU5JTkdfUEFUVEVSTl9TRVQJCQkweGMKKyNkZWZp
bmUgWllOUU1QX0RQX1NDUkFNQkxJTkdfRElTQUJMRQkJCTB4MTQKKyNkZWZpbmUgWllOUU1QX0RQ
X0RPV05TUFJFQURfQ1RMCQkJMHgxOAorI2RlZmluZSBaWU5RTVBfRFBfU09GVFdBUkVfUkVTRVQJ
CQkweDFjCisjZGVmaW5lIFpZTlFNUF9EUF9TT0ZUV0FSRV9SRVNFVF9TVFJFQU0xCQlCSVQoMCkK
KyNkZWZpbmUgWllOUU1QX0RQX1NPRlRXQVJFX1JFU0VUX1NUUkVBTTIJCUJJVCgxKQorI2RlZmlu
ZSBaWU5RTVBfRFBfU09GVFdBUkVfUkVTRVRfU1RSRUFNMwkJQklUKDIpCisjZGVmaW5lIFpZTlFN
UF9EUF9TT0ZUV0FSRV9SRVNFVF9TVFJFQU00CQlCSVQoMykKKyNkZWZpbmUgWllOUU1QX0RQX1NP
RlRXQVJFX1JFU0VUX0FVWAkJCUJJVCg3KQorI2RlZmluZSBaWU5RTVBfRFBfU09GVFdBUkVfUkVT
RVRfQUxMCQkJKFpZTlFNUF9EUF9TT0ZUV0FSRV9SRVNFVF9TVFJFQU0xIHwgXAorCQkJCQkJCSBa
WU5RTVBfRFBfU09GVFdBUkVfUkVTRVRfU1RSRUFNMiB8IFwKKwkJCQkJCQkgWllOUU1QX0RQX1NP
RlRXQVJFX1JFU0VUX1NUUkVBTTMgfCBcCisJCQkJCQkJIFpZTlFNUF9EUF9TT0ZUV0FSRV9SRVNF
VF9TVFJFQU00IHwgXAorCQkJCQkJCSBaWU5RTVBfRFBfU09GVFdBUkVfUkVTRVRfQVVYKQorCisv
KiBDb3JlIGVuYWJsZSByZWdpc3RlcnMgKi8KKyNkZWZpbmUgWllOUU1QX0RQX1RSQU5TTUlUVEVS
X0VOQUJMRQkJCTB4ODAKKyNkZWZpbmUgWllOUU1QX0RQX01BSU5fU1RSRUFNX0VOQUJMRQkJCTB4
ODQKKyNkZWZpbmUgWllOUU1QX0RQX0ZPUkNFX1NDUkFNQkxFUl9SRVNFVAkJCTB4YzAKKyNkZWZp
bmUgWllOUU1QX0RQX1ZFUlNJT04JCQkJMHhmOAorI2RlZmluZSBaWU5RTVBfRFBfVkVSU0lPTl9N
QUpPUl9NQVNLCQkJR0VOTUFTSygzMSwgMjQpCisjZGVmaW5lIFpZTlFNUF9EUF9WRVJTSU9OX01B
Sk9SX1NISUZUCQkJMjQKKyNkZWZpbmUgWllOUU1QX0RQX1ZFUlNJT05fTUlOT1JfTUFTSwkJCUdF
Tk1BU0soMjMsIDE2KQorI2RlZmluZSBaWU5RTVBfRFBfVkVSU0lPTl9NSU5PUl9TSElGVAkJCTE2
CisjZGVmaW5lIFpZTlFNUF9EUF9WRVJTSU9OX1JFVklTSU9OX01BU0sJCQlHRU5NQVNLKDE1LCAx
MikKKyNkZWZpbmUgWllOUU1QX0RQX1ZFUlNJT05fUkVWSVNJT05fU0hJRlQJCTEyCisjZGVmaW5l
IFpZTlFNUF9EUF9WRVJTSU9OX1BBVENIX01BU0sJCQlHRU5NQVNLKDExLCA4KQorI2RlZmluZSBa
WU5RTVBfRFBfVkVSU0lPTl9QQVRDSF9TSElGVAkJCTgKKyNkZWZpbmUgWllOUU1QX0RQX1ZFUlNJ
T05fSU5URVJOQUxfTUFTSwkJCUdFTk1BU0soNywgMCkKKyNkZWZpbmUgWllOUU1QX0RQX1ZFUlNJ
T05fSU5URVJOQUxfU0hJRlQJCTAKKworLyogQ29yZSBJRCByZWdpc3RlcnMgKi8KKyNkZWZpbmUg
WllOUU1QX0RQX0NPUkVfSUQJCQkJMHhmYworI2RlZmluZSBaWU5RTVBfRFBfQ09SRV9JRF9NQUpP
Ul9NQVNLCQkJR0VOTUFTSygzMSwgMjQpCisjZGVmaW5lIFpZTlFNUF9EUF9DT1JFX0lEX01BSk9S
X1NISUZUCQkJMjQKKyNkZWZpbmUgWllOUU1QX0RQX0NPUkVfSURfTUlOT1JfTUFTSwkJCUdFTk1B
U0soMjMsIDE2KQorI2RlZmluZSBaWU5RTVBfRFBfQ09SRV9JRF9NSU5PUl9TSElGVAkJCTE2Cisj
ZGVmaW5lIFpZTlFNUF9EUF9DT1JFX0lEX1JFVklTSU9OX01BU0sJCQlHRU5NQVNLKDE1LCA4KQor
I2RlZmluZSBaWU5RTVBfRFBfQ09SRV9JRF9SRVZJU0lPTl9TSElGVAkJOAorI2RlZmluZSBaWU5R
TVBfRFBfQ09SRV9JRF9ESVJFQ1RJT04JCQlHRU5NQVNLKDEpCisKKy8qIEFVWCBjaGFubmVsIGlu
dGVyZmFjZSByZWdpc3RlcnMgKi8KKyNkZWZpbmUgWllOUU1QX0RQX0FVWF9DT01NQU5ECQkJCTB4
MTAwCisjZGVmaW5lIFpZTlFNUF9EUF9BVVhfQ09NTUFORF9DTURfU0hJRlQJCQk4CisjZGVmaW5l
IFpZTlFNUF9EUF9BVVhfQ09NTUFORF9BRERSRVNTX09OTFkJCUJJVCgxMikKKyNkZWZpbmUgWllO
UU1QX0RQX0FVWF9DT01NQU5EX0JZVEVTX1NISUZUCQkwCisjZGVmaW5lIFpZTlFNUF9EUF9BVVhf
V1JJVEVfRklGTwkJCTB4MTA0CisjZGVmaW5lIFpZTlFNUF9EUF9BVVhfQUREUkVTUwkJCQkweDEw
OAorI2RlZmluZSBaWU5RTVBfRFBfQVVYX0NMS19ESVZJREVSCQkJMHgxMGMKKyNkZWZpbmUgWllO
UU1QX0RQX0FVWF9DTEtfRElWSURFUl9BVVhfRklMVEVSX1NISUZUCTgKKyNkZWZpbmUgWllOUU1Q
X0RQX0lOVEVSUlVQVF9TSUdOQUxfU1RBVEUJCTB4MTMwCisjZGVmaW5lIFpZTlFNUF9EUF9JTlRF
UlJVUFRfU0lHTkFMX1NUQVRFX0hQRAkJQklUKDApCisjZGVmaW5lIFpZTlFNUF9EUF9JTlRFUlJV
UFRfU0lHTkFMX1NUQVRFX1JFUVVFU1QJQklUKDEpCisjZGVmaW5lIFpZTlFNUF9EUF9JTlRFUlJV
UFRfU0lHTkFMX1NUQVRFX1JFUExZCQlCSVQoMikKKyNkZWZpbmUgWllOUU1QX0RQX0lOVEVSUlVQ
VF9TSUdOQUxfU1RBVEVfUkVQTFlfVElNRU9VVAlCSVQoMykKKyNkZWZpbmUgWllOUU1QX0RQX0FV
WF9SRVBMWV9EQVRBCQkJMHgxMzQKKyNkZWZpbmUgWllOUU1QX0RQX0FVWF9SRVBMWV9DT0RFCQkJ
MHgxMzgKKyNkZWZpbmUgWllOUU1QX0RQX0FVWF9SRVBMWV9DT0RFX0FVWF9BQ0sJCSgwKQorI2Rl
ZmluZSBaWU5RTVBfRFBfQVVYX1JFUExZX0NPREVfQVVYX05BQ0sJCUJJVCgwKQorI2RlZmluZSBa
WU5RTVBfRFBfQVVYX1JFUExZX0NPREVfQVVYX0RFRkVSCQlCSVQoMSkKKyNkZWZpbmUgWllOUU1Q
X0RQX0FVWF9SRVBMWV9DT0RFX0kyQ19BQ0sJCSgwKQorI2RlZmluZSBaWU5RTVBfRFBfQVVYX1JF
UExZX0NPREVfSTJDX05BQ0sJCUJJVCgyKQorI2RlZmluZSBaWU5RTVBfRFBfQVVYX1JFUExZX0NP
REVfSTJDX0RFRkVSCQlCSVQoMykKKyNkZWZpbmUgWllOUU1QX0RQX0FVWF9SRVBMWV9DT1VOVAkJ
CTB4MTNjCisjZGVmaW5lIFpZTlFNUF9EUF9SRVBMWV9EQVRBX0NPVU5UCQkJMHgxNDgKKyNkZWZp
bmUgWllOUU1QX0RQX1JFUExZX0RBVEFfQ09VTlRfTUFTSwkJCTB4ZmYKKyNkZWZpbmUgWllOUU1Q
X0RQX0lOVF9TVEFUVVMJCQkJMHgzYTAKKyNkZWZpbmUgWllOUU1QX0RQX0lOVF9NQVNLCQkJCTB4
M2E0CisjZGVmaW5lIFpZTlFNUF9EUF9JTlRfRU4JCQkJMHgzYTgKKyNkZWZpbmUgWllOUU1QX0RQ
X0lOVF9EUwkJCQkweDNhYworI2RlZmluZSBaWU5RTVBfRFBfSU5UX0hQRF9JUlEJCQkJQklUKDAp
CisjZGVmaW5lIFpZTlFNUF9EUF9JTlRfSFBEX0VWRU5UCQkJCUJJVCgxKQorI2RlZmluZSBaWU5R
TVBfRFBfSU5UX1JFUExZX1JFQ0VJVkVECQkJQklUKDIpCisjZGVmaW5lIFpZTlFNUF9EUF9JTlRf
UkVQTFlfVElNRU9VVAkJCUJJVCgzKQorI2RlZmluZSBaWU5RTVBfRFBfSU5UX0hQRF9QVUxTRV9E
RVQJCQlCSVQoNCkKKyNkZWZpbmUgWllOUU1QX0RQX0lOVF9FWFRfUEtUX1RYRAkJCUJJVCg1KQor
I2RlZmluZSBaWU5RTVBfRFBfSU5UX0xJVl9BQlVGX1VORFJGTFcJCQlCSVQoMTIpCisjZGVmaW5l
IFpZTlFNUF9EUF9JTlRfVkJMQU5LX1NUQVJUCQkJQklUKDEzKQorI2RlZmluZSBaWU5RTVBfRFBf
SU5UX1BJWEVMMV9NQVRDSAkJCUJJVCgxNCkKKyNkZWZpbmUgWllOUU1QX0RQX0lOVF9QSVhFTDBf
TUFUQ0gJCQlCSVQoMTUpCisjZGVmaW5lIFpZTlFNUF9EUF9JTlRfQ0hCVUZfVU5ERVJGTFdfTUFT
SwkJMHgzZjAwMDAKKyNkZWZpbmUgWllOUU1QX0RQX0lOVF9DSEJVRl9PVkVSRkxXX01BU0sJCTB4
ZmMwMDAwMAorI2RlZmluZSBaWU5RTVBfRFBfSU5UX0NVU1RfVFNfMgkJCQlCSVQoMjgpCisjZGVm
aW5lIFpZTlFNUF9EUF9JTlRfQ1VTVF9UUwkJCQlCSVQoMjkpCisjZGVmaW5lIFpZTlFNUF9EUF9J
TlRfRVhUX1ZTWU5DX1RTCQkJQklUKDMwKQorI2RlZmluZSBaWU5RTVBfRFBfSU5UX1ZTWU5DX1RT
CQkJCUJJVCgzMSkKKyNkZWZpbmUgWllOUU1QX0RQX0lOVF9BTEwJCQkJKFpZTlFNUF9EUF9JTlRf
SFBEX0lSUSB8IFwKKwkJCQkJCQkgWllOUU1QX0RQX0lOVF9IUERfRVZFTlQgfCBcCisJCQkJCQkJ
IFpZTlFNUF9EUF9JTlRfQ0hCVUZfVU5ERVJGTFdfTUFTSyB8IFwKKwkJCQkJCQkgWllOUU1QX0RQ
X0lOVF9DSEJVRl9PVkVSRkxXX01BU0spCisKKy8qIE1haW4gc3RyZWFtIGF0dHJpYnV0ZSByZWdp
c3RlcnMgKi8KKyNkZWZpbmUgWllOUU1QX0RQX01BSU5fU1RSRUFNX0hUT1RBTAkJCTB4MTgwCisj
ZGVmaW5lIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9WVE9UQUwJCQkweDE4NAorI2RlZmluZSBaWU5R
TVBfRFBfTUFJTl9TVFJFQU1fUE9MQVJJVFkJCQkweDE4OAorI2RlZmluZSBaWU5RTVBfRFBfTUFJ
Tl9TVFJFQU1fUE9MQVJJVFlfSFNZTkNfU0hJRlQJMAorI2RlZmluZSBaWU5RTVBfRFBfTUFJTl9T
VFJFQU1fUE9MQVJJVFlfVlNZTkNfU0hJRlQJMQorI2RlZmluZSBaWU5RTVBfRFBfTUFJTl9TVFJF
QU1fSFNXSURUSAkJCTB4MThjCisjZGVmaW5lIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9WU1dJRFRI
CQkJMHgxOTAKKyNkZWZpbmUgWllOUU1QX0RQX01BSU5fU1RSRUFNX0hSRVMJCQkweDE5NAorI2Rl
ZmluZSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fVlJFUwkJCTB4MTk4CisjZGVmaW5lIFpZTlFNUF9E
UF9NQUlOX1NUUkVBTV9IU1RBUlQJCQkweDE5YworI2RlZmluZSBaWU5RTVBfRFBfTUFJTl9TVFJF
QU1fVlNUQVJUCQkJMHgxYTAKKyNkZWZpbmUgWllOUU1QX0RQX01BSU5fU1RSRUFNX01JU0MwCQkJ
MHgxYTQKKyNkZWZpbmUgWllOUU1QX0RQX01BSU5fU1RSRUFNX01JU0MwX1NZTkNfTE9DSwkJQklU
KDApCisjZGVmaW5lIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9NSVNDMF9DT01QX0ZPUk1BVF9SR0IJ
KDAgPDwgMSkKKyNkZWZpbmUgWllOUU1QX0RQX01BSU5fU1RSRUFNX01JU0MwX0NPTVBfRk9STUFU
X1lDUkNCXzQyMgkoNSA8PCAxKQorI2RlZmluZSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fTUlTQzBf
Q09NUF9GT1JNQVRfWUNSQ0JfNDQ0CSg2IDw8IDEpCisjZGVmaW5lIFpZTlFNUF9EUF9NQUlOX1NU
UkVBTV9NSVNDMF9DT01QX0ZPUk1BVF9NQVNLCSg3IDw8IDEpCisjZGVmaW5lIFpZTlFNUF9EUF9N
QUlOX1NUUkVBTV9NSVNDMF9EWU5BTUlDX1JBTkdFCUJJVCgzKQorI2RlZmluZSBaWU5RTVBfRFBf
TUFJTl9TVFJFQU1fTUlTQzBfWUNCQ1JfQ09MUgkJQklUKDQpCisjZGVmaW5lIFpZTlFNUF9EUF9N
QUlOX1NUUkVBTV9NSVNDMF9CUENfNgkJKDAgPDwgNSkKKyNkZWZpbmUgWllOUU1QX0RQX01BSU5f
U1RSRUFNX01JU0MwX0JQQ184CQkoMSA8PCA1KQorI2RlZmluZSBaWU5RTVBfRFBfTUFJTl9TVFJF
QU1fTUlTQzBfQlBDXzEwCQkoMiA8PCA1KQorI2RlZmluZSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1f
TUlTQzBfQlBDXzEyCQkoMyA8PCA1KQorI2RlZmluZSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fTUlT
QzBfQlBDXzE2CQkoNCA8PCA1KQorI2RlZmluZSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fTUlTQzBf
QlBDX01BU0sJCSg3IDw8IDUpCisjZGVmaW5lIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9NSVNDMQkJ
CTB4MWE4CisjZGVmaW5lIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9NSVNDMV9ZX09OTFlfRU4JCUJJ
VCg3KQorI2RlZmluZSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fTV9WSUQJCQkweDFhYworI2RlZmlu
ZSBaWU5RTVBfRFBfTVNBX1RSQU5TRkVSX1VOSVRfU0laRQkJMHgxYjAKKyNkZWZpbmUgWllOUU1Q
X0RQX01TQV9UUkFOU0ZFUl9VTklUX1NJWkVfVFVfU0laRV9ERUYJNjQKKyNkZWZpbmUgWllOUU1Q
X0RQX01BSU5fU1RSRUFNX05fVklECQkJMHgxYjQKKyNkZWZpbmUgWllOUU1QX0RQX1VTRVJfUElY
X1dJRFRICQkJMHgxYjgKKyNkZWZpbmUgWllOUU1QX0RQX1VTRVJfREFUQV9DT1VOVF9QRVJfTEFO
RQkJMHgxYmMKKyNkZWZpbmUgWllOUU1QX0RQX01JTl9CWVRFU19QRVJfVFUJCQkweDFjNAorI2Rl
ZmluZSBaWU5RTVBfRFBfRlJBQ19CWVRFU19QRVJfVFUJCQkweDFjOAorI2RlZmluZSBaWU5RTVBf
RFBfSU5JVF9XQUlUCQkJCTB4MWNjCisKKy8qIFBIWSBjb25maWd1cmF0aW9uIGFuZCBzdGF0dXMg
cmVnaXN0ZXJzICovCisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfUkVTRVQJCQkJMHgyMDAKKyNkZWZp
bmUgWllOUU1QX0RQX1BIWV9SRVNFVF9QSFlfUkVTRVQJCQlCSVQoMCkKKyNkZWZpbmUgWllOUU1Q
X0RQX1BIWV9SRVNFVF9HVFRYX1JFU0VUCQkJQklUKDEpCisjZGVmaW5lIFpZTlFNUF9EUF9QSFlf
UkVTRVRfUEhZX1BNQV9SRVNFVAkJQklUKDgpCisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfUkVTRVRf
UEhZX1BDU19SRVNFVAkJQklUKDkpCisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfUkVTRVRfQUxMX1JF
U0VUCQkJKFpZTlFNUF9EUF9QSFlfUkVTRVRfUEhZX1JFU0VUIHwgXAorCQkJCQkJCSBaWU5RTVBf
RFBfUEhZX1JFU0VUX0dUVFhfUkVTRVQgfCBcCisJCQkJCQkJIFpZTlFNUF9EUF9QSFlfUkVTRVRf
UEhZX1BNQV9SRVNFVCB8IFwKKwkJCQkJCQkgWllOUU1QX0RQX1BIWV9SRVNFVF9QSFlfUENTX1JF
U0VUKQorI2RlZmluZSBaWU5RTVBfRFBfUEhZX1BSRUVNUEhBU0lTX0xBTkVfMAkJMHgyMTAKKyNk
ZWZpbmUgWllOUU1QX0RQX1BIWV9QUkVFTVBIQVNJU19MQU5FXzEJCTB4MjE0CisjZGVmaW5lIFpZ
TlFNUF9EUF9QSFlfUFJFRU1QSEFTSVNfTEFORV8yCQkweDIxOAorI2RlZmluZSBaWU5RTVBfRFBf
UEhZX1BSRUVNUEhBU0lTX0xBTkVfMwkJMHgyMWMKKyNkZWZpbmUgWllOUU1QX0RQX1BIWV9WT0xU
QUdFX0RJRkZfTEFORV8wCQkweDIyMAorI2RlZmluZSBaWU5RTVBfRFBfUEhZX1ZPTFRBR0VfRElG
Rl9MQU5FXzEJCTB4MjI0CisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfVk9MVEFHRV9ESUZGX0xBTkVf
MgkJMHgyMjgKKyNkZWZpbmUgWllOUU1QX0RQX1BIWV9WT0xUQUdFX0RJRkZfTEFORV8zCQkweDIy
YworI2RlZmluZSBaWU5RTVBfRFBfUEhZX0NMT0NLX1NFTEVDVAkJCTB4MjM0CisjZGVmaW5lIFpZ
TlFNUF9EUF9QSFlfQ0xPQ0tfU0VMRUNUXzFfNjJHCQkweDEKKyNkZWZpbmUgWllOUU1QX0RQX1BI
WV9DTE9DS19TRUxFQ1RfMl83MEcJCTB4MworI2RlZmluZSBaWU5RTVBfRFBfUEhZX0NMT0NLX1NF
TEVDVF81XzQwRwkJMHg1CisjZGVmaW5lIFpZTlFNUF9EUF9UWF9QSFlfUE9XRVJfRE9XTgkJCTB4
MjM4CisjZGVmaW5lIFpZTlFNUF9EUF9UWF9QSFlfUE9XRVJfRE9XTl9MQU5FXzAJCUJJVCgwKQor
I2RlZmluZSBaWU5RTVBfRFBfVFhfUEhZX1BPV0VSX0RPV05fTEFORV8xCQlCSVQoMSkKKyNkZWZp
bmUgWllOUU1QX0RQX1RYX1BIWV9QT1dFUl9ET1dOX0xBTkVfMgkJQklUKDIpCisjZGVmaW5lIFpZ
TlFNUF9EUF9UWF9QSFlfUE9XRVJfRE9XTl9MQU5FXzMJCUJJVCgzKQorI2RlZmluZSBaWU5RTVBf
RFBfVFhfUEhZX1BPV0VSX0RPV05fQUxMCQkJMHhmCisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfUFJF
Q1VSU09SX0xBTkVfMAkJCTB4MjNjCisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfUFJFQ1VSU09SX0xB
TkVfMQkJCTB4MjQwCisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfUFJFQ1VSU09SX0xBTkVfMgkJCTB4
MjQ0CisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfUFJFQ1VSU09SX0xBTkVfMwkJCTB4MjQ4CisjZGVm
aW5lIFpZTlFNUF9EUF9QSFlfUE9TVENVUlNPUl9MQU5FXzAJCQkweDI0YworI2RlZmluZSBaWU5R
TVBfRFBfUEhZX1BPU1RDVVJTT1JfTEFORV8xCQkJMHgyNTAKKyNkZWZpbmUgWllOUU1QX0RQX1BI
WV9QT1NUQ1VSU09SX0xBTkVfMgkJCTB4MjU0CisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfUE9TVENV
UlNPUl9MQU5FXzMJCQkweDI1OAorI2RlZmluZSBaWU5RTVBfRFBfU1VCX1RYX1BIWV9QUkVDVVJT
T1JfTEFORV8wCQkweDI0YworI2RlZmluZSBaWU5RTVBfRFBfU1VCX1RYX1BIWV9QUkVDVVJTT1Jf
TEFORV8xCQkweDI1MAorI2RlZmluZSBaWU5RTVBfRFBfUEhZX1NUQVRVUwkJCQkweDI4MAorI2Rl
ZmluZSBaWU5RTVBfRFBfUEhZX1NUQVRVU19QTExfTE9DS0VEX1NISUZUCQk0CisjZGVmaW5lIFpZ
TlFNUF9EUF9QSFlfU1RBVFVTX0ZQR0FfUExMX0xPQ0tFRAkJQklUKDYpCisKKy8qIEF1ZGlvIHJl
Z2lzdGVycyAqLworI2RlZmluZSBaWU5RTVBfRFBfVFhfQVVESU9fQ09OVFJPTAkJCTB4MzAwCisj
ZGVmaW5lIFpZTlFNUF9EUF9UWF9BVURJT19DSEFOTkVMUwkJCTB4MzA0CisjZGVmaW5lIFpZTlFN
UF9EUF9UWF9BVURJT19JTkZPX0RBVEEJCQkweDMwOAorI2RlZmluZSBaWU5RTVBfRFBfVFhfTV9B
VUQJCQkJMHgzMjgKKyNkZWZpbmUgWllOUU1QX0RQX1RYX05fQVVECQkJCTB4MzJjCisjZGVmaW5l
IFpZTlFNUF9EUF9UWF9BVURJT19FWFRfREFUQQkJCTB4MzMwCisKKyNkZWZpbmUgWllOUU1QX0RQ
X01BWF9MQU5FUwkJCQkyCisjZGVmaW5lIFpZTlFNUF9NQVhfRlJFUQkJCQkJMzAwMDAwMAorCisj
ZGVmaW5lIERQX1JFRFVDRURfQklUX1JBVEUJCQkJMTYyMDAwCisjZGVmaW5lIERQX0hJR0hfQklU
X1JBVEUJCQkJMjcwMDAwCisjZGVmaW5lIERQX0hJR0hfQklUX1JBVEUyCQkJCTU0MDAwMAorI2Rl
ZmluZSBEUF9NQVhfVFJBSU5JTkdfVFJJRVMJCQkJNQorI2RlZmluZSBEUF9WMV8yCQkJCQkJMHgx
MgorCisvKioKKyAqIHN0cnVjdCB6eW5xbXBfZHBfbGlua19jb25maWcgLSBDb21tb24gbGluayBj
b25maWcgYmV0d2VlbiBzb3VyY2UgYW5kIHNpbmsKKyAqIEBtYXhfcmF0ZTogbWF4aW11bSBsaW5r
IHJhdGUKKyAqIEBtYXhfbGFuZXM6IG1heGltdW0gbnVtYmVyIG9mIGxhbmVzCisgKi8KK3N0cnVj
dCB6eW5xbXBfZHBfbGlua19jb25maWcgeworCWludCBtYXhfcmF0ZTsKKwl1OCBtYXhfbGFuZXM7
Cit9OworCisvKioKKyAqIHN0cnVjdCB6eW5xbXBfZHBfbW9kZSAtIENvbmZpZ3VyZWQgbW9kZSBv
ZiBEaXNwbGF5UG9ydAorICogQGJ3X2NvZGU6IGNvZGUgZm9yIGJhbmR3aWR0aChsaW5rIHJhdGUp
CisgKiBAbGFuZV9jbnQ6IG51bWJlciBvZiBsYW5lcworICogQHBjbG9jazogcGl4ZWwgY2xvY2sg
ZnJlcXVlbmN5IG9mIGN1cnJlbnQgbW9kZQorICogQGZtdDogZm9ybWF0IGlkZW50aWZpZXIgc3Ry
aW5nCisgKi8KK3N0cnVjdCB6eW5xbXBfZHBfbW9kZSB7CisJdTggYndfY29kZTsKKwl1OCBsYW5l
X2NudDsKKwlpbnQgcGNsb2NrOworCWNvbnN0IGNoYXIgKmZtdDsKK307CisKKy8qKgorICogc3Ry
dWN0IHp5bnFtcF9kcF9jb25maWcgLSBDb25maWd1cmF0aW9uIG9mIERpc3BsYXlQb3J0IGZyb20g
RFRTCisgKiBAbWlzYzA6IG1pc2MwIGNvbmZpZ3VyYXRpb24gKHBlciBEUCB2MS4yIHNwZWMpCisg
KiBAbWlzYzE6IG1pc2MxIGNvbmZpZ3VyYXRpb24gKHBlciBEUCB2MS4yIHNwZWMpCisgKiBAYnBw
OiBiaXRzIHBlciBwaXhlbAorICovCitzdHJ1Y3QgenlucW1wX2RwX2NvbmZpZyB7CisJdTggbWlz
YzA7CisJdTggbWlzYzE7CisJdTggYnBwOworfTsKKworLyoqCisgKiBzdHJ1Y3QgenlucW1wX2Rw
IC0gWGlsaW54IERpc3BsYXlQb3J0IGNvcmUKKyAqIEBlbmNvZGVyOiB0aGUgZHJtIGVuY29kZXIg
c3RydWN0dXJlCisgKiBAY29ubmVjdG9yOiB0aGUgZHJtIGNvbm5lY3RvciBzdHJ1Y3R1cmUKKyAq
IEBkZXY6IGRldmljZSBzdHJ1Y3R1cmUKKyAqIEBkcHN1YjogRGlzcGxheSBzdWJzeXN0ZW0KKyAq
IEBkcm06IERSTSBjb3JlCisgKiBAaW9tZW06IGRldmljZSBJL08gbWVtb3J5IGZvciByZWdpc3Rl
ciBhY2Nlc3MKKyAqIEBpcnE6IGlycQorICogQGNvbmZpZzogSVAgY29yZSBjb25maWd1cmF0aW9u
IGZyb20gRFRTCisgKiBAYXV4OiBhdXggY2hhbm5lbAorICogQHBoeTogUEhZIGhhbmRsZXMgZm9y
IERQIGxhbmVzCisgKiBAbnVtX2xhbmVzOiBudW1iZXIgb2YgZW5hYmxlZCBwaHkgbGFuZXMKKyAq
IEBocGRfd29yazogaG90IHBsdWcgZGV0ZWN0aW9uIHdvcmtlcgorICogQHN0YXR1czogY29ubmVj
dGlvbiBzdGF0dXMKKyAqIEBlbmFibGVkOiBmbGFnIHRvIGluZGljYXRlIGlmIHRoZSBkZXZpY2Ug
aXMgZW5hYmxlZAorICogQGRwY2Q6IERQIGNvbmZpZ3VyYXRpb24gZGF0YSBmcm9tIGN1cnJlbnRs
eSBjb25uZWN0ZWQgc2luayBkZXZpY2UKKyAqIEBsaW5rX2NvbmZpZzogY29tbW9uIGxpbmsgY29u
ZmlndXJhdGlvbiBiZXR3ZWVuIElQIGNvcmUgYW5kIHNpbmsgZGV2aWNlCisgKiBAbW9kZTogY3Vy
cmVudCBtb2RlIGJldHdlZW4gSVAgY29yZSBhbmQgc2luayBkZXZpY2UKKyAqIEB0cmFpbl9zZXQ6
IHNldCBvZiB0cmFpbmluZyBkYXRhCisgKi8KK3N0cnVjdCB6eW5xbXBfZHAgeworCXN0cnVjdCBk
cm1fZW5jb2RlciBlbmNvZGVyOworCXN0cnVjdCBkcm1fY29ubmVjdG9yIGNvbm5lY3RvcjsKKwlz
dHJ1Y3QgZGV2aWNlICpkZXY7CisJc3RydWN0IHp5bnFtcF9kcHN1YiAqZHBzdWI7CisJc3RydWN0
IGRybV9kZXZpY2UgKmRybTsKKwl2b2lkIF9faW9tZW0gKmlvbWVtOworCWludCBpcnE7CisKKwlz
dHJ1Y3QgenlucW1wX2RwX2NvbmZpZyBjb25maWc7CisJc3RydWN0IGRybV9kcF9hdXggYXV4Owor
CXN0cnVjdCBwaHkgKnBoeVtaWU5RTVBfRFBfTUFYX0xBTkVTXTsKKwl1OCBudW1fbGFuZXM7CisJ
c3RydWN0IGRlbGF5ZWRfd29yayBocGRfd29yazsKKwllbnVtIGRybV9jb25uZWN0b3Jfc3RhdHVz
IHN0YXR1czsKKwlib29sIGVuYWJsZWQ7CisKKwl1OCBkcGNkW0RQX1JFQ0VJVkVSX0NBUF9TSVpF
XTsKKwlzdHJ1Y3QgenlucW1wX2RwX2xpbmtfY29uZmlnIGxpbmtfY29uZmlnOworCXN0cnVjdCB6
eW5xbXBfZHBfbW9kZSBtb2RlOworCXU4IHRyYWluX3NldFtaWU5RTVBfRFBfTUFYX0xBTkVTXTsK
K307CisKK3N0YXRpYyBpbmxpbmUgc3RydWN0IHp5bnFtcF9kcCAqZW5jb2Rlcl90b19kcChzdHJ1
Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIpCit7CisJcmV0dXJuIGNvbnRhaW5lcl9vZihlbmNvZGVy
LCBzdHJ1Y3QgenlucW1wX2RwLCBlbmNvZGVyKTsKK30KKworc3RhdGljIGlubGluZSBzdHJ1Y3Qg
enlucW1wX2RwICpjb25uZWN0b3JfdG9fZHAoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3Rv
cikKK3sKKwlyZXR1cm4gY29udGFpbmVyX29mKGNvbm5lY3Rvciwgc3RydWN0IHp5bnFtcF9kcCwg
Y29ubmVjdG9yKTsKK30KKworc3RhdGljIHZvaWQgenlucW1wX2RwX3dyaXRlKHN0cnVjdCB6eW5x
bXBfZHAgKmRwLCBpbnQgb2Zmc2V0LCB1MzIgdmFsKQoreworCXdyaXRlbCh2YWwsIGRwLT5pb21l
bSArIG9mZnNldCk7Cit9CisKK3N0YXRpYyB1MzIgenlucW1wX2RwX3JlYWQoc3RydWN0IHp5bnFt
cF9kcCAqZHAsIGludCBvZmZzZXQpCit7CisJcmV0dXJuIHJlYWRsKGRwLT5pb21lbSArIG9mZnNl
dCk7Cit9CisKK3N0YXRpYyB2b2lkIHp5bnFtcF9kcF9jbHIoc3RydWN0IHp5bnFtcF9kcCAqZHAs
IGludCBvZmZzZXQsIHUzMiBjbHIpCit7CisJenlucW1wX2RwX3dyaXRlKGRwLCBvZmZzZXQsIHp5
bnFtcF9kcF9yZWFkKGRwLCBvZmZzZXQpICYgfmNscik7Cit9CisKK3N0YXRpYyB2b2lkIHp5bnFt
cF9kcF9zZXQoc3RydWN0IHp5bnFtcF9kcCAqZHAsIGludCBvZmZzZXQsIHUzMiBzZXQpCit7CisJ
enlucW1wX2RwX3dyaXRlKGRwLCBvZmZzZXQsIHp5bnFtcF9kcF9yZWFkKGRwLCBvZmZzZXQpIHwg
c2V0KTsKK30KKworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqIFBIWSBIYW5kbGluZworICov
CisKKy8qKgorICogenlucW1wX2RwX3BoeV9pbml0IC0gSW5pdGlhbGl6ZSB0aGUgcGh5CisgKiBA
ZHA6IERpc3BsYXlQb3J0IElQIGNvcmUgc3RydWN0dXJlCisgKgorICogSW5pdGlhbGl6ZSB0aGUg
cGh5LgorICoKKyAqIFJldHVybjogMCBpZiB0aGUgcGh5IGluc3RhbmNlcyBhcmUgaW5pdGlhbGl6
ZWQgY29ycmVjdGx5LCBvciB0aGUgZXJyb3IgY29kZQorICogcmV0dXJuZWQgZnJvbSB0aGUgY2Fs
bGVlIGZ1bmN0aW9ucy4KKyAqLworc3RhdGljIGludCB6eW5xbXBfZHBfcGh5X2luaXQoc3RydWN0
IHp5bnFtcF9kcCAqZHApCit7CisJdW5zaWduZWQgaW50IGk7CisJaW50IHJldDsKKworCWZvciAo
aSA9IDA7IGkgPCBkcC0+bnVtX2xhbmVzOyBpKyspIHsKKwkJcmV0ID0gcGh5X2luaXQoZHAtPnBo
eVtpXSk7CisJCWlmIChyZXQpIHsKKwkJCWRldl9lcnIoZHAtPmRldiwgImZhaWxlZCB0byBpbml0
IHBoeSBsYW5lICVkXG4iLCBpKTsKKwkJCXJldHVybiByZXQ7CisJCX0KKwl9CisKKwl6eW5xbXBf
ZHBfY2xyKGRwLCBaWU5RTVBfRFBfUEhZX1JFU0VULCBaWU5RTVBfRFBfUEhZX1JFU0VUX0FMTF9S
RVNFVCk7CisKKwlyZXR1cm4gMDsKK30KKworLyoqCisgKiB6eW5xbXBfZHBfcGh5X2V4aXQgLSBF
eGl0IHRoZSBwaHkKKyAqIEBkcDogRGlzcGxheVBvcnQgSVAgY29yZSBzdHJ1Y3R1cmUKKyAqCisg
KiBFeGl0IHRoZSBwaHkuCisgKi8KK3N0YXRpYyB2b2lkIHp5bnFtcF9kcF9waHlfZXhpdChzdHJ1
Y3QgenlucW1wX2RwICpkcCkKK3sKKwl1bnNpZ25lZCBpbnQgaTsKKwlpbnQgcmV0OworCisJZm9y
IChpID0gMDsgaSA8IGRwLT5udW1fbGFuZXM7IGkrKykgeworCQlyZXQgPSBwaHlfZXhpdChkcC0+
cGh5W2ldKTsKKwkJaWYgKHJldCkKKwkJCWRldl9lcnIoZHAtPmRldiwgImZhaWxlZCB0byBleGl0
IHBoeSglZCkgJWRcbiIsIGksIHJldCk7CisJfQorfQorCisvKioKKyAqIHp5bnFtcF9kcF9waHlf
cHJvYmUgLSBQcm9iZSB0aGUgUEhZcworICogQGRwOiBEaXNwbGF5UG9ydCBJUCBjb3JlIHN0cnVj
dHVyZQorICoKKyAqIFByb2JlIFBIWXMgZm9yIGFsbCBsYW5lcy4gTGVzcyBQSFlzIG1heSBiZSBh
dmFpbGFibGUgdGhhbiB0aGUgbnVtYmVyIG9mCisgKiBsYW5lcywgd2hpY2ggaXMgbm90IGNvbnNp
ZGVyZWQgYW4gZXJyb3IgYXMgbG9uZyBhcyBhdCBsZWFzdCBvbmUgUEhZIGlzCisgKiBmb3VuZC4g
VGhlIGNhbGxlciBjYW4gY2hlY2sgZHAtPm51bV9sYW5lcyB0byBjaGVjayBob3cgbWFueSBQSFlz
IHdlcmUgZm91bmQuCisgKgorICogUmV0dXJuOgorICogKiAwCQkJCS0gU3VjY2VzcworICogKiAt
RU5YSU8JCQktIE5vIFBIWSBmb3VuZAorICogKiAtRVBST0JFX0RFRkVSCQktIFByb2JlIGRlZmVy
cmFsIHJlcXVlc3RlZAorICogKiBPdGhlciBuZWdhdGl2ZSB2YWx1ZQktIFBIWSByZXRyaWV2YWwg
ZmFpbHVyZQorICovCitzdGF0aWMgaW50IHp5bnFtcF9kcF9waHlfcHJvYmUoc3RydWN0IHp5bnFt
cF9kcCAqZHApCit7CisJdW5zaWduZWQgaW50IGk7CisKKwlmb3IgKGkgPSAwOyBpIDwgWllOUU1Q
X0RQX01BWF9MQU5FUzsgaSsrKSB7CisJCWNoYXIgcGh5X25hbWVbMTZdOworCQlzdHJ1Y3QgcGh5
ICpwaHk7CisKKwkJc25wcmludGYocGh5X25hbWUsIHNpemVvZihwaHlfbmFtZSksICJkcC1waHkl
ZCIsIGkpOworCQlwaHkgPSBkZXZtX3BoeV9nZXQoZHAtPmRldiwgcGh5X25hbWUpOworCisJCWlm
IChJU19FUlIocGh5KSkgeworCQkJc3dpdGNoIChQVFJfRVJSKHBoeSkpIHsKKwkJCWNhc2UgLUVO
T0RFVjoKKwkJCQlpZiAoZHAtPm51bV9sYW5lcykKKwkJCQkJcmV0dXJuIDA7CisKKwkJCQlkZXZf
ZXJyKGRwLT5kZXYsICJubyBQSFkgZm91bmRcbiIpOworCQkJCXJldHVybiAtRU5YSU87CisKKwkJ
CWNhc2UgLUVQUk9CRV9ERUZFUjoKKwkJCQlyZXR1cm4gLUVQUk9CRV9ERUZFUjsKKworCQkJZGVm
YXVsdDoKKwkJCQlkZXZfZXJyKGRwLT5kZXYsICJmYWlsZWQgdG8gZ2V0IFBIWSBsYW5lICV1XG4i
LAorCQkJCQlpKTsKKwkJCQlyZXR1cm4gUFRSX0VSUihwaHkpOworCQkJfQorCQl9CisKKwkJZHAt
PnBoeVtpXSA9IHBoeTsKKwkJZHAtPm51bV9sYW5lcysrOworCX0KKworCXJldHVybiAwOworfQor
CisvKioKKyAqIHp5bnFtcF9kcF9waHlfcmVhZHkgLSBDaGVjayBpZiBQSFkgaXMgcmVhZHkKKyAq
IEBkcDogRGlzcGxheVBvcnQgSVAgY29yZSBzdHJ1Y3R1cmUKKyAqCisgKiBDaGVjayBpZiBQSFkg
aXMgcmVhZHkuIElmIFBIWSBpcyBub3QgcmVhZHksIHdhaXQgMW1zIHRvIGNoZWNrIGZvciAxMDAg
dGltZXMuCisgKiBUaGlzIGFtb3VudCBvZiBkZWxheSB3YXMgc3VnZ2VzdGVkIGJ5IElQIGRlc2ln
bmVyLgorICoKKyAqIFJldHVybjogMCBpZiBQSFkgaXMgcmVhZHksIG9yIC1FTk9ERVYgaWYgUEhZ
IGlzIG5vdCByZWFkeS4KKyAqLworc3RhdGljIGludCB6eW5xbXBfZHBfcGh5X3JlYWR5KHN0cnVj
dCB6eW5xbXBfZHAgKmRwKQoreworCXUzMiBpLCByZWcsIHJlYWR5OworCisJcmVhZHkgPSAoMSA8
PCBkcC0+bnVtX2xhbmVzKSAtIDE7CisKKwkvKiBXYWl0IGZvciAxMDAgKiAxbXMuIFRoaXMgc2hv
dWxkIGJlIGVub3VnaCB0aW1lIGZvciBQSFkgdG8gYmUgcmVhZHkgKi8KKwlmb3IgKGkgPSAwOyA7
IGkrKykgeworCQlyZWcgPSB6eW5xbXBfZHBfcmVhZChkcCwgWllOUU1QX0RQX1BIWV9TVEFUVVMp
OworCQlpZiAoKHJlZyAmIHJlYWR5KSA9PSByZWFkeSkKKwkJCXJldHVybiAwOworCisJCWlmIChp
ID09IDEwMCkgeworCQkJZGV2X2VycihkcC0+ZGV2LCAiUEhZIGlzbid0IHJlYWR5XG4iKTsKKwkJ
CXJldHVybiAtRU5PREVWOworCQl9CisKKwkJdXNsZWVwX3JhbmdlKDEwMDAsIDExMDApOworCX0K
KworCXJldHVybiAwOworfQorCisvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICogRGlzcGxheVBv
cnQgTGluayBUcmFpbmluZworICovCisKKy8qKgorICogenlucW1wX2RwX21heF9yYXRlIC0gQ2Fs
Y3VsYXRlIGFuZCByZXR1cm4gYXZhaWxhYmxlIG1heCBwaXhlbCBjbG9jaworICogQGxpbmtfcmF0
ZTogbGluayByYXRlIChLaWxvLWJ5dGVzIC8gc2VjKQorICogQGxhbmVfbnVtOiBudW1iZXIgb2Yg
bGFuZXMKKyAqIEBicHA6IGJpdHMgcGVyIHBpeGVsCisgKgorICogUmV0dXJuOiBtYXggcGl4ZWwg
Y2xvY2sgKEtIeikgc3VwcG9ydGVkIGJ5IGN1cnJlbnQgbGluayBjb25maWcuCisgKi8KK3N0YXRp
YyBpbmxpbmUgaW50IHp5bnFtcF9kcF9tYXhfcmF0ZShpbnQgbGlua19yYXRlLCB1OCBsYW5lX251
bSwgdTggYnBwKQoreworCXJldHVybiBsaW5rX3JhdGUgKiBsYW5lX251bSAqIDggLyBicHA7Cit9
CisKKy8qKgorICogenlucW1wX2RwX21vZGVfY29uZmlndXJlIC0gQ29uZmlndXJlIHRoZSBsaW5r
IHZhbHVlcworICogQGRwOiBEaXNwbGF5UG9ydCBJUCBjb3JlIHN0cnVjdHVyZQorICogQHBjbG9j
azogcGl4ZWwgY2xvY2sgZm9yIHJlcXVlc3RlZCBkaXNwbGF5IG1vZGUKKyAqIEBjdXJyZW50X2J3
OiBjdXJyZW50IGxpbmsgcmF0ZQorICoKKyAqIEZpbmQgdGhlIGxpbmsgY29uZmlndXJhdGlvbiB2
YWx1ZXMsIHJhdGUgYW5kIGxhbmUgY291bnQgZm9yIHJlcXVlc3RlZCBwaXhlbAorICogY2xvY2sg
QHBjbG9jay4gVGhlIEBwY2xvY2sgaXMgc3RvcmVkIGluIHRoZSBtb2RlIHRvIGJlIHVzZWQgaW4g
b3RoZXIKKyAqIGZ1bmN0aW9ucyBsYXRlci4gVGhlIHJldHVybmVkIHJhdGUgaXMgZG93bnNoaWZ0
ZWQgZnJvbSB0aGUgY3VycmVudCByYXRlCisgKiBAY3VycmVudF9idy4KKyAqCisgKiBSZXR1cm46
IEN1cnJlbnQgbGluayByYXRlIGNvZGUsIG9yIC1FSU5WQUwuCisgKi8KK3N0YXRpYyBpbnQgenlu
cW1wX2RwX21vZGVfY29uZmlndXJlKHN0cnVjdCB6eW5xbXBfZHAgKmRwLCBpbnQgcGNsb2NrLAor
CQkJCSAgICB1OCBjdXJyZW50X2J3KQoreworCWludCBtYXhfcmF0ZSA9IGRwLT5saW5rX2NvbmZp
Zy5tYXhfcmF0ZTsKKwl1OCBid3NbM10gPSB7IERQX0xJTktfQldfMV82MiwgRFBfTElOS19CV18y
XzcsIERQX0xJTktfQldfNV80IH07CisJdTggbWF4X2xhbmVzID0gZHAtPmxpbmtfY29uZmlnLm1h
eF9sYW5lczsKKwl1OCBtYXhfbGlua19yYXRlX2NvZGUgPSBkcm1fZHBfbGlua19yYXRlX3RvX2J3
X2NvZGUobWF4X3JhdGUpOworCXU4IGJwcCA9IGRwLT5jb25maWcuYnBwOworCXU4IGxhbmVfY250
OworCXM4IGk7CisKKwlpZiAoY3VycmVudF9idyA9PSBEUF9MSU5LX0JXXzFfNjIpIHsKKwkJZGV2
X2VycihkcC0+ZGV2LCAiY2FuJ3QgZG93bnNoaWZ0LiBhbHJlYWR5IGxvd2VzdCBsaW5rIHJhdGVc
biIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlmb3IgKGkgPSBBUlJBWV9TSVpFKGJ3cykg
LSAxOyBpID49IDA7IGktLSkgeworCQlpZiAoY3VycmVudF9idyAmJiBid3NbaV0gPj0gY3VycmVu
dF9idykKKwkJCWNvbnRpbnVlOworCisJCWlmIChid3NbaV0gPD0gbWF4X2xpbmtfcmF0ZV9jb2Rl
KQorCQkJYnJlYWs7CisJfQorCisJZm9yIChsYW5lX2NudCA9IDE7IGxhbmVfY250IDw9IG1heF9s
YW5lczsgbGFuZV9jbnQgPDw9IDEpIHsKKwkJaW50IGJ3OworCQl1MzIgcmF0ZTsKKworCQlidyA9
IGRybV9kcF9id19jb2RlX3RvX2xpbmtfcmF0ZShid3NbaV0pOworCQlyYXRlID0genlucW1wX2Rw
X21heF9yYXRlKGJ3LCBsYW5lX2NudCwgYnBwKTsKKwkJaWYgKHBjbG9jayA8PSByYXRlKSB7CisJ
CQlkcC0+bW9kZS5id19jb2RlID0gYndzW2ldOworCQkJZHAtPm1vZGUubGFuZV9jbnQgPSBsYW5l
X2NudDsKKwkJCWRwLT5tb2RlLnBjbG9jayA9IHBjbG9jazsKKwkJCXJldHVybiBkcC0+bW9kZS5i
d19jb2RlOworCQl9CisJfQorCisJZGV2X2VycihkcC0+ZGV2LCAiZmFpbGVkIHRvIGNvbmZpZ3Vy
ZSBsaW5rIHZhbHVlc1xuIik7CisKKwlyZXR1cm4gLUVJTlZBTDsKK30KKworLyoqCisgKiB6eW5x
bXBfZHBfYWRqdXN0X3RyYWluIC0gQWRqdXN0IHRyYWluIHZhbHVlcworICogQGRwOiBEaXNwbGF5
UG9ydCBJUCBjb3JlIHN0cnVjdHVyZQorICogQGxpbmtfc3RhdHVzOiBsaW5rIHN0YXR1cyBmcm9t
IHNpbmsgd2hpY2ggY29udGFpbnMgcmVxdWVzdGVkIHRyYWluaW5nIHZhbHVlcworICovCitzdGF0
aWMgdm9pZCB6eW5xbXBfZHBfYWRqdXN0X3RyYWluKHN0cnVjdCB6eW5xbXBfZHAgKmRwLAorCQkJ
CSAgIHU4IGxpbmtfc3RhdHVzW0RQX0xJTktfU1RBVFVTX1NJWkVdKQoreworCXU4ICp0cmFpbl9z
ZXQgPSBkcC0+dHJhaW5fc2V0OworCXU4IHZvbHRhZ2UgPSAwLCBwcmVlbXBoYXNpcyA9IDA7CisJ
dTggaTsKKworCWZvciAoaSA9IDA7IGkgPCBkcC0+bW9kZS5sYW5lX2NudDsgaSsrKSB7CisJCXU4
IHYgPSBkcm1fZHBfZ2V0X2FkanVzdF9yZXF1ZXN0X3ZvbHRhZ2UobGlua19zdGF0dXMsIGkpOwor
CQl1OCBwID0gZHJtX2RwX2dldF9hZGp1c3RfcmVxdWVzdF9wcmVfZW1waGFzaXMobGlua19zdGF0
dXMsIGkpOworCisJCWlmICh2ID4gdm9sdGFnZSkKKwkJCXZvbHRhZ2UgPSB2OworCisJCWlmIChw
ID4gcHJlZW1waGFzaXMpCisJCQlwcmVlbXBoYXNpcyA9IHA7CisJfQorCisJaWYgKHZvbHRhZ2Ug
Pj0gRFBfVFJBSU5fVk9MVEFHRV9TV0lOR19MRVZFTF8zKQorCQl2b2x0YWdlIHw9IERQX1RSQUlO
X01BWF9TV0lOR19SRUFDSEVEOworCisJaWYgKHByZWVtcGhhc2lzID49IERQX1RSQUlOX1BSRV9F
TVBIX0xFVkVMXzIpCisJCXByZWVtcGhhc2lzIHw9IERQX1RSQUlOX01BWF9QUkVfRU1QSEFTSVNf
UkVBQ0hFRDsKKworCWZvciAoaSA9IDA7IGkgPCBkcC0+bW9kZS5sYW5lX2NudDsgaSsrKQorCQl0
cmFpbl9zZXRbaV0gPSB2b2x0YWdlIHwgcHJlZW1waGFzaXM7Cit9CisKKy8qKgorICogenlucW1w
X2RwX3VwZGF0ZV92c19lbXBoIC0gVXBkYXRlIHRoZSB0cmFpbmluZyB2YWx1ZXMKKyAqIEBkcDog
RGlzcGxheVBvcnQgSVAgY29yZSBzdHJ1Y3R1cmUKKyAqCisgKiBVcGRhdGUgdGhlIHRyYWluaW5n
IHZhbHVlcyBiYXNlZCBvbiB0aGUgcmVxdWVzdCBmcm9tIHNpbmsuIFRoZSBtYXBwZWQgdmFsdWVz
CisgKiBhcmUgcHJlZGVmaW5lZCwgYW5kIHZhbHVlcyh2cywgcGUsIHBjKSBhcmUgZnJvbSB0aGUg
ZGV2aWNlIG1hbnVhbC4KKyAqCisgKiBSZXR1cm46IDAgaWYgdnMgYW5kIGVtcGggYXJlIHVwZGF0
ZWQgc3VjY2Vzc2Z1bGx5LCBvciB0aGUgZXJyb3IgY29kZSByZXR1cm5lZAorICogYnkgZHJtX2Rw
X2RwY2Rfd3JpdGUoKS4KKyAqLworc3RhdGljIGludCB6eW5xbXBfZHBfdXBkYXRlX3ZzX2VtcGgo
c3RydWN0IHp5bnFtcF9kcCAqZHApCit7CisJdTggKnRyYWluX3NldCA9IGRwLT50cmFpbl9zZXQ7
CisJdTggaSwgdl9sZXZlbCwgcF9sZXZlbDsKKwlpbnQgcmV0OworCisJcmV0ID0gZHJtX2RwX2Rw
Y2Rfd3JpdGUoJmRwLT5hdXgsIERQX1RSQUlOSU5HX0xBTkUwX1NFVCwgdHJhaW5fc2V0LAorCQkJ
CWRwLT5tb2RlLmxhbmVfY250KTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0dXJuIHJldDsKKworCWZv
ciAoaSA9IDA7IGkgPCBkcC0+bW9kZS5sYW5lX2NudDsgaSsrKSB7CisJCXUzMiByZWcgPSBaWU5R
TVBfRFBfU1VCX1RYX1BIWV9QUkVDVVJTT1JfTEFORV8wICsgaSAqIDQ7CisKKwkJdl9sZXZlbCA9
ICh0cmFpbl9zZXRbaV0gJiBEUF9UUkFJTl9WT0xUQUdFX1NXSU5HX01BU0spID4+CisJCQkgIERQ
X1RSQUlOX1ZPTFRBR0VfU1dJTkdfU0hJRlQ7CisJCXBfbGV2ZWwgPSAodHJhaW5fc2V0W2ldICYg
RFBfVFJBSU5fUFJFX0VNUEhBU0lTX01BU0spID4+CisJCQkgIERQX1RSQUlOX1BSRV9FTVBIQVNJ
U19TSElGVDsKKworCQl6eW5xbXBfZHBfd3JpdGUoZHAsIHJlZywgMHgyKTsKKwl9CisKKwlyZXR1
cm4gMDsKK30KKworLyoqCisgKiB6eW5xbXBfZHBfbGlua190cmFpbl9jciAtIFRyYWluIGNsb2Nr
IHJlY292ZXJ5CisgKiBAZHA6IERpc3BsYXlQb3J0IElQIGNvcmUgc3RydWN0dXJlCisgKgorICog
UmV0dXJuOiAwIGlmIGNsb2NrIHJlY292ZXJ5IHRyYWluIGlzIGRvbmUgc3VjY2Vzc2Z1bGx5LCBv
ciBjb3JyZXNwb25kaW5nCisgKiBlcnJvciBjb2RlLgorICovCitzdGF0aWMgaW50IHp5bnFtcF9k
cF9saW5rX3RyYWluX2NyKHN0cnVjdCB6eW5xbXBfZHAgKmRwKQoreworCXU4IGxpbmtfc3RhdHVz
W0RQX0xJTktfU1RBVFVTX1NJWkVdOworCXU4IGxhbmVfY250ID0gZHAtPm1vZGUubGFuZV9jbnQ7
CisJdTggdnMgPSAwLCB0cmllcyA9IDA7CisJdTE2IG1heF90cmllcywgaTsKKwlib29sIGNyX2Rv
bmU7CisJaW50IHJldDsKKworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX1RSQUlOSU5H
X1BBVFRFUk5fU0VULAorCQkJRFBfVFJBSU5JTkdfUEFUVEVSTl8xKTsKKwlyZXQgPSBkcm1fZHBf
ZHBjZF93cml0ZWIoJmRwLT5hdXgsIERQX1RSQUlOSU5HX1BBVFRFUk5fU0VULAorCQkJCSBEUF9U
UkFJTklOR19QQVRURVJOXzEgfAorCQkJCSBEUF9MSU5LX1NDUkFNQkxJTkdfRElTQUJMRSk7CisJ
aWYgKHJldCA8IDApCisJCXJldHVybiByZXQ7CisKKwkvKgorCSAqIDI1NiBsb29wcyBzaG91bGQg
YmUgbWF4aW11bSBpdGVyYXRpb25zIGZvciA0IGxhbmVzIGFuZCA0IHZhbHVlcy4KKwkgKiBTbywg
VGhpcyBsb29wIHNob3VsZCBleGl0IGJlZm9yZSA1MTIgaXRlcmF0aW9ucworCSAqLworCWZvciAo
bWF4X3RyaWVzID0gMDsgbWF4X3RyaWVzIDwgNTEyOyBtYXhfdHJpZXMrKykgeworCQlyZXQgPSB6
eW5xbXBfZHBfdXBkYXRlX3ZzX2VtcGgoZHApOworCQlpZiAocmV0KQorCQkJcmV0dXJuIHJldDsK
KworCQlkcm1fZHBfbGlua190cmFpbl9jbG9ja19yZWNvdmVyeV9kZWxheShkcC0+ZHBjZCk7CisJ
CXJldCA9IGRybV9kcF9kcGNkX3JlYWRfbGlua19zdGF0dXMoJmRwLT5hdXgsIGxpbmtfc3RhdHVz
KTsKKwkJaWYgKHJldCA8IDApCisJCQlyZXR1cm4gcmV0OworCisJCWNyX2RvbmUgPSBkcm1fZHBf
Y2xvY2tfcmVjb3Zlcnlfb2sobGlua19zdGF0dXMsIGxhbmVfY250KTsKKwkJaWYgKGNyX2RvbmUp
CisJCQlicmVhazsKKworCQlmb3IgKGkgPSAwOyBpIDwgbGFuZV9jbnQ7IGkrKykKKwkJCWlmICgh
KGRwLT50cmFpbl9zZXRbaV0gJiBEUF9UUkFJTl9NQVhfU1dJTkdfUkVBQ0hFRCkpCisJCQkJYnJl
YWs7CisJCWlmIChpID09IGxhbmVfY250KQorCQkJYnJlYWs7CisKKwkJaWYgKChkcC0+dHJhaW5f
c2V0WzBdICYgRFBfVFJBSU5fVk9MVEFHRV9TV0lOR19NQVNLKSA9PSB2cykKKwkJCXRyaWVzKys7
CisJCWVsc2UKKwkJCXRyaWVzID0gMDsKKworCQlpZiAodHJpZXMgPT0gRFBfTUFYX1RSQUlOSU5H
X1RSSUVTKQorCQkJYnJlYWs7CisKKwkJdnMgPSBkcC0+dHJhaW5fc2V0WzBdICYgRFBfVFJBSU5f
Vk9MVEFHRV9TV0lOR19NQVNLOworCQl6eW5xbXBfZHBfYWRqdXN0X3RyYWluKGRwLCBsaW5rX3N0
YXR1cyk7CisJfQorCisJaWYgKCFjcl9kb25lKQorCQlyZXR1cm4gLUVJTzsKKworCXJldHVybiAw
OworfQorCisvKioKKyAqIHp5bnFtcF9kcF9saW5rX3RyYWluX2NlIC0gVHJhaW4gY2hhbm5lbCBl
cXVhbGl6YXRpb24KKyAqIEBkcDogRGlzcGxheVBvcnQgSVAgY29yZSBzdHJ1Y3R1cmUKKyAqCisg
KiBSZXR1cm46IDAgaWYgY2hhbm5lbCBlcXVhbGl6YXRpb24gdHJhaW4gaXMgZG9uZSBzdWNjZXNz
ZnVsbHksIG9yCisgKiBjb3JyZXNwb25kaW5nIGVycm9yIGNvZGUuCisgKi8KK3N0YXRpYyBpbnQg
enlucW1wX2RwX2xpbmtfdHJhaW5fY2Uoc3RydWN0IHp5bnFtcF9kcCAqZHApCit7CisJdTggbGlu
a19zdGF0dXNbRFBfTElOS19TVEFUVVNfU0laRV07CisJdTggbGFuZV9jbnQgPSBkcC0+bW9kZS5s
YW5lX2NudDsKKwl1MzIgcGF0LCB0cmllczsKKwlpbnQgcmV0OworCWJvb2wgY2VfZG9uZTsKKwor
CWlmIChkcC0+ZHBjZFtEUF9EUENEX1JFVl0gPj0gRFBfVjFfMiAmJgorCSAgICBkcC0+ZHBjZFtE
UF9NQVhfTEFORV9DT1VOVF0gJiBEUF9UUFMzX1NVUFBPUlRFRCkKKwkJcGF0ID0gRFBfVFJBSU5J
TkdfUEFUVEVSTl8zOworCWVsc2UKKwkJcGF0ID0gRFBfVFJBSU5JTkdfUEFUVEVSTl8yOworCisJ
enlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfVFJBSU5JTkdfUEFUVEVSTl9TRVQsIHBhdCk7
CisJcmV0ID0gZHJtX2RwX2RwY2Rfd3JpdGViKCZkcC0+YXV4LCBEUF9UUkFJTklOR19QQVRURVJO
X1NFVCwKKwkJCQkgcGF0IHwgRFBfTElOS19TQ1JBTUJMSU5HX0RJU0FCTEUpOworCWlmIChyZXQg
PCAwKQorCQlyZXR1cm4gcmV0OworCisJZm9yICh0cmllcyA9IDA7IHRyaWVzIDwgRFBfTUFYX1RS
QUlOSU5HX1RSSUVTOyB0cmllcysrKSB7CisJCXJldCA9IHp5bnFtcF9kcF91cGRhdGVfdnNfZW1w
aChkcCk7CisJCWlmIChyZXQpCisJCQlyZXR1cm4gcmV0OworCisJCWRybV9kcF9saW5rX3RyYWlu
X2NoYW5uZWxfZXFfZGVsYXkoZHAtPmRwY2QpOworCQlyZXQgPSBkcm1fZHBfZHBjZF9yZWFkX2xp
bmtfc3RhdHVzKCZkcC0+YXV4LCBsaW5rX3N0YXR1cyk7CisJCWlmIChyZXQgPCAwKQorCQkJcmV0
dXJuIHJldDsKKworCQljZV9kb25lID0gZHJtX2RwX2NoYW5uZWxfZXFfb2sobGlua19zdGF0dXMs
IGxhbmVfY250KTsKKwkJaWYgKGNlX2RvbmUpCisJCQlicmVhazsKKworCQl6eW5xbXBfZHBfYWRq
dXN0X3RyYWluKGRwLCBsaW5rX3N0YXR1cyk7CisJfQorCisJaWYgKCFjZV9kb25lKQorCQlyZXR1
cm4gLUVJTzsKKworCXJldHVybiAwOworfQorCisvKioKKyAqIHp5bnFtcF9kcF9saW5rX3RyYWlu
IC0gVHJhaW4gdGhlIGxpbmsKKyAqIEBkcDogRGlzcGxheVBvcnQgSVAgY29yZSBzdHJ1Y3R1cmUK
KyAqCisgKiBSZXR1cm46IDAgaWYgYWxsIHRyYWlucyBhcmUgZG9uZSBzdWNjZXNzZnVsbHksIG9y
IGNvcnJlc3BvbmRpbmcgZXJyb3IgY29kZS4KKyAqLworc3RhdGljIGludCB6eW5xbXBfZHBfdHJh
aW4oc3RydWN0IHp5bnFtcF9kcCAqZHApCit7CisJdTMyIHJlZzsKKwl1OCBid19jb2RlID0gZHAt
Pm1vZGUuYndfY29kZTsKKwl1OCBsYW5lX2NudCA9IGRwLT5tb2RlLmxhbmVfY250OworCXU4IGF1
eF9sYW5lX2NudCA9IGxhbmVfY250OworCWJvb2wgZW5oYW5jZWQ7CisJaW50IHJldDsKKworCXp5
bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX0xBTkVfQ09VTlRfU0VULCBsYW5lX2NudCk7CisJ
ZW5oYW5jZWQgPSBkcm1fZHBfZW5oYW5jZWRfZnJhbWVfY2FwKGRwLT5kcGNkKTsKKwlpZiAoZW5o
YW5jZWQpIHsKKwkJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfRU5IQU5DRURfRlJBTUVf
RU4sIDEpOworCQlhdXhfbGFuZV9jbnQgfD0gRFBfTEFORV9DT1VOVF9FTkhBTkNFRF9GUkFNRV9F
TjsKKwl9CisKKwlpZiAoZHAtPmRwY2RbM10gJiAweDEpIHsKKwkJenlucW1wX2RwX3dyaXRlKGRw
LCBaWU5RTVBfRFBfRE9XTlNQUkVBRF9DVEwsIDEpOworCQlkcm1fZHBfZHBjZF93cml0ZWIoJmRw
LT5hdXgsIERQX0RPV05TUFJFQURfQ1RSTCwKKwkJCQkgICBEUF9TUFJFQURfQU1QXzBfNSk7CisJ
fSBlbHNlIHsKKwkJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfRE9XTlNQUkVBRF9DVEws
IDApOworCQlkcm1fZHBfZHBjZF93cml0ZWIoJmRwLT5hdXgsIERQX0RPV05TUFJFQURfQ1RSTCwg
MCk7CisJfQorCisJcmV0ID0gZHJtX2RwX2RwY2Rfd3JpdGViKCZkcC0+YXV4LCBEUF9MQU5FX0NP
VU5UX1NFVCwgYXV4X2xhbmVfY250KTsKKwlpZiAocmV0IDwgMCkgeworCQlkZXZfZXJyKGRwLT5k
ZXYsICJmYWlsZWQgdG8gc2V0IGxhbmUgY291bnRcbiIpOworCQlyZXR1cm4gcmV0OworCX0KKwor
CXJldCA9IGRybV9kcF9kcGNkX3dyaXRlYigmZHAtPmF1eCwgRFBfTUFJTl9MSU5LX0NIQU5ORUxf
Q09ESU5HX1NFVCwKKwkJCQkgRFBfU0VUX0FOU0lfOEIxMEIpOworCWlmIChyZXQgPCAwKSB7CisJ
CWRldl9lcnIoZHAtPmRldiwgImZhaWxlZCB0byBzZXQgQU5TSSA4Qi8xMEIgZW5jb2RpbmdcbiIp
OworCQlyZXR1cm4gcmV0OworCX0KKworCXJldCA9IGRybV9kcF9kcGNkX3dyaXRlYigmZHAtPmF1
eCwgRFBfTElOS19CV19TRVQsIGJ3X2NvZGUpOworCWlmIChyZXQgPCAwKSB7CisJCWRldl9lcnIo
ZHAtPmRldiwgImZhaWxlZCB0byBzZXQgRFAgYmFuZHdpZHRoXG4iKTsKKwkJcmV0dXJuIHJldDsK
Kwl9CisKKwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9MSU5LX0JXX1NFVCwgYndfY29k
ZSk7CisJc3dpdGNoIChid19jb2RlKSB7CisJY2FzZSBEUF9MSU5LX0JXXzFfNjI6CisJCXJlZyA9
IFpZTlFNUF9EUF9QSFlfQ0xPQ0tfU0VMRUNUXzFfNjJHOworCQlicmVhazsKKwljYXNlIERQX0xJ
TktfQldfMl83OgorCQlyZWcgPSBaWU5RTVBfRFBfUEhZX0NMT0NLX1NFTEVDVF8yXzcwRzsKKwkJ
YnJlYWs7CisJY2FzZSBEUF9MSU5LX0JXXzVfNDoKKwlkZWZhdWx0OgorCQlyZWcgPSBaWU5RTVBf
RFBfUEhZX0NMT0NLX1NFTEVDVF81XzQwRzsKKwkJYnJlYWs7CisJfQorCisJenlucW1wX2RwX3dy
aXRlKGRwLCBaWU5RTVBfRFBfUEhZX0NMT0NLX1NFTEVDVCwgcmVnKTsKKwlyZXQgPSB6eW5xbXBf
ZHBfcGh5X3JlYWR5KGRwKTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0dXJuIHJldDsKKworCXp5bnFt
cF9kcF93cml0ZShkcCwgWllOUU1QX0RQX1NDUkFNQkxJTkdfRElTQUJMRSwgMSk7CisJbWVtc2V0
KGRwLT50cmFpbl9zZXQsIDAsIDQpOworCXJldCA9IHp5bnFtcF9kcF9saW5rX3RyYWluX2NyKGRw
KTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJcmV0ID0genlucW1wX2RwX2xpbmtfdHJh
aW5fY2UoZHApOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwlyZXQgPSBkcm1fZHBfZHBj
ZF93cml0ZWIoJmRwLT5hdXgsIERQX1RSQUlOSU5HX1BBVFRFUk5fU0VULAorCQkJCSBEUF9UUkFJ
TklOR19QQVRURVJOX0RJU0FCTEUpOworCWlmIChyZXQgPCAwKSB7CisJCWRldl9lcnIoZHAtPmRl
diwgImZhaWxlZCB0byBkaXNhYmxlIHRyYWluaW5nIHBhdHRlcm5cbiIpOworCQlyZXR1cm4gcmV0
OworCX0KKwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9UUkFJTklOR19QQVRURVJOX1NF
VCwKKwkJCURQX1RSQUlOSU5HX1BBVFRFUk5fRElTQUJMRSk7CisKKwl6eW5xbXBfZHBfd3JpdGUo
ZHAsIFpZTlFNUF9EUF9TQ1JBTUJMSU5HX0RJU0FCTEUsIDApOworCisJcmV0dXJuIDA7Cit9CisK
Ky8qKgorICogenlucW1wX2RwX3RyYWluX2xvb3AgLSBEb3duc2hpZnQgdGhlIGxpbmsgcmF0ZSBk
dXJpbmcgdHJhaW5pbmcKKyAqIEBkcDogRGlzcGxheVBvcnQgSVAgY29yZSBzdHJ1Y3R1cmUKKyAq
CisgKiBUcmFpbiB0aGUgbGluayBieSBkb3duc2hpZnRpbmcgdGhlIGxpbmsgcmF0ZSBpZiB0cmFp
bmluZyBpcyBub3Qgc3VjY2Vzc2Z1bC4KKyAqLworc3RhdGljIHZvaWQgenlucW1wX2RwX3RyYWlu
X2xvb3Aoc3RydWN0IHp5bnFtcF9kcCAqZHApCit7CisJc3RydWN0IHp5bnFtcF9kcF9tb2RlICpt
b2RlID0gJmRwLT5tb2RlOworCXU4IGJ3ID0gbW9kZS0+YndfY29kZTsKKwlpbnQgcmV0OworCisJ
ZG8geworCQlpZiAoZHAtPnN0YXR1cyA9PSBjb25uZWN0b3Jfc3RhdHVzX2Rpc2Nvbm5lY3RlZCB8
fAorCQkgICAgIWRwLT5lbmFibGVkKQorCQkJcmV0dXJuOworCisJCXJldCA9IHp5bnFtcF9kcF90
cmFpbihkcCk7CisJCWlmICghcmV0KQorCQkJcmV0dXJuOworCisJCXJldCA9IHp5bnFtcF9kcF9t
b2RlX2NvbmZpZ3VyZShkcCwgbW9kZS0+cGNsb2NrLCBidyk7CisJCWlmIChyZXQgPCAwKQorCQkJ
Z290byBlcnJfb3V0OworCisJCWJ3ID0gcmV0OworCX0gd2hpbGUgKGJ3ID49IERQX0xJTktfQldf
MV82Mik7CisKK2Vycl9vdXQ6CisJZGV2X2VycihkcC0+ZGV2LCAiZmFpbGVkIHRvIHRyYWluIHRo
ZSBEUCBsaW5rXG4iKTsKK30KKworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqIERpc3BsYXlQ
b3J0IEFVWAorICovCisKKyNkZWZpbmUgQVVYX1JFQURfQklUCTB4MQorCisvKioKKyAqIHp5bnFt
cF9kcF9hdXhfY21kX3N1Ym1pdCAtIFN1Ym1pdCBhdXggY29tbWFuZAorICogQGRwOiBEaXNwbGF5
UG9ydCBJUCBjb3JlIHN0cnVjdHVyZQorICogQGNtZDogYXV4IGNvbW1hbmQKKyAqIEBhZGRyOiBh
dXggYWRkcmVzcworICogQGJ1ZjogYnVmZmVyIGZvciBjb21tYW5kIGRhdGEKKyAqIEBieXRlczog
bnVtYmVyIG9mIGJ5dGVzIGZvciBAYnVmCisgKiBAcmVwbHk6IHJlcGx5IGNvZGUgdG8gYmUgcmV0
dXJuZWQKKyAqCisgKiBTdWJtaXQgYW4gYXV4IGNvbW1hbmQuIEFsbCBhdXggcmVsYXRlZCBjb21t
YW5kcywgbmF0aXZlIG9yIGkyYyBhdXgKKyAqIHJlYWQvd3JpdGUsIGFyZSBzdWJtaXR0ZWQgdGhy
b3VnaCB0aGlzIGZ1bmN0aW9uLiBUaGUgZnVuY3Rpb24gaXMgbWFwcGVkIHRvCisgKiB0aGUgdHJh
bnNmZXIgZnVuY3Rpb24gb2Ygc3RydWN0IGRybV9kcF9hdXguIFRoaXMgZnVuY3Rpb24gaW52b2x2
ZXMgaW4KKyAqIG11bHRpcGxlIHJlZ2lzdGVyIHJlYWRzL3dyaXRlcywgdGh1cyBzeW5jaHJvbml6
YXRpb24gaXMgbmVlZGVkLCBhbmQgaXQgaXMKKyAqIGRvbmUgYnkgZHJtX2RwX2hlbHBlciB1c2lu
ZyBAaHdfbXV0ZXguIFRoZSBjYWxsaW5nIHRocmVhZCBnb2VzIGludG8gc2xlZXAKKyAqIGlmIHRo
ZXJlJ3Mgbm8gaW1tZWRpYXRlIHJlcGx5IHRvIHRoZSBjb21tYW5kIHN1Ym1pc3Npb24uIFRoZSBy
ZXBseSBjb2RlIGlzCisgKiByZXR1cm5lZCBhdCBAcmVwbHkgaWYgQHJlcGx5ICE9IE5VTEwuCisg
KgorICogUmV0dXJuOiAwIGlmIHRoZSBjb21tYW5kIGlzIHN1Ym1pdHRlZCBwcm9wZXJseSwgb3Ig
Y29ycmVzcG9uZGluZyBlcnJvciBjb2RlOgorICogLUVCVVNZIHdoZW4gdGhlcmUgaXMgYW55IHJl
cXVlc3QgYWxyZWFkeSBiZWluZyBwcm9jZXNzZWQKKyAqIC1FVElNRURPVVQgd2hlbiByZWNlaXZp
bmcgcmVwbHkgaXMgdGltZWQgb3V0CisgKiAtRUlPIHdoZW4gcmVjZWl2ZWQgYnl0ZXMgYXJlIGxl
c3MgdGhhbiByZXF1ZXN0ZWQKKyAqLworc3RhdGljIGludCB6eW5xbXBfZHBfYXV4X2NtZF9zdWJt
aXQoc3RydWN0IHp5bnFtcF9kcCAqZHAsIHUzMiBjbWQsIHUxNiBhZGRyLAorCQkJCSAgICB1OCAq
YnVmLCB1OCBieXRlcywgdTggKnJlcGx5KQoreworCWJvb2wgaXNfcmVhZCA9IChjbWQgJiBBVVhf
UkVBRF9CSVQpID8gdHJ1ZSA6IGZhbHNlOworCXUzMiByZWcsIGk7CisKKwlyZWcgPSB6eW5xbXBf
ZHBfcmVhZChkcCwgWllOUU1QX0RQX0lOVEVSUlVQVF9TSUdOQUxfU1RBVEUpOworCWlmIChyZWcg
JiBaWU5RTVBfRFBfSU5URVJSVVBUX1NJR05BTF9TVEFURV9SRVFVRVNUKQorCQlyZXR1cm4gLUVC
VVNZOworCisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfQVVYX0FERFJFU1MsIGFkZHIp
OworCWlmICghaXNfcmVhZCkKKwkJZm9yIChpID0gMDsgaSA8IGJ5dGVzOyBpKyspCisJCQl6eW5x
bXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9BVVhfV1JJVEVfRklGTywKKwkJCQkJYnVmW2ldKTsK
KworCXJlZyA9IGNtZCA8PCBaWU5RTVBfRFBfQVVYX0NPTU1BTkRfQ01EX1NISUZUOworCWlmICgh
YnVmIHx8ICFieXRlcykKKwkJcmVnIHw9IFpZTlFNUF9EUF9BVVhfQ09NTUFORF9BRERSRVNTX09O
TFk7CisJZWxzZQorCQlyZWcgfD0gKGJ5dGVzIC0gMSkgPDwgWllOUU1QX0RQX0FVWF9DT01NQU5E
X0JZVEVTX1NISUZUOworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX0FVWF9DT01NQU5E
LCByZWcpOworCisJLyogV2FpdCBmb3IgcmVwbHkgdG8gYmUgZGVsaXZlcmVkIHVwdG8gMm1zICov
CisJZm9yIChpID0gMDsgOyBpKyspIHsKKwkJcmVnID0genlucW1wX2RwX3JlYWQoZHAsIFpZTlFN
UF9EUF9JTlRFUlJVUFRfU0lHTkFMX1NUQVRFKTsKKwkJaWYgKHJlZyAmIFpZTlFNUF9EUF9JTlRF
UlJVUFRfU0lHTkFMX1NUQVRFX1JFUExZKQorCQkJYnJlYWs7CisKKwkJaWYgKHJlZyAmIFpZTlFN
UF9EUF9JTlRFUlJVUFRfU0lHTkFMX1NUQVRFX1JFUExZX1RJTUVPVVQgfHwKKwkJICAgIGkgPT0g
MikKKwkJCXJldHVybiAtRVRJTUVET1VUOworCisJCXVzbGVlcF9yYW5nZSgxMDAwLCAxMTAwKTsK
Kwl9CisKKwlyZWcgPSB6eW5xbXBfZHBfcmVhZChkcCwgWllOUU1QX0RQX0FVWF9SRVBMWV9DT0RF
KTsKKwlpZiAocmVwbHkpCisJCSpyZXBseSA9IHJlZzsKKworCWlmIChpc19yZWFkICYmCisJICAg
IChyZWcgPT0gWllOUU1QX0RQX0FVWF9SRVBMWV9DT0RFX0FVWF9BQ0sgfHwKKwkgICAgIHJlZyA9
PSBaWU5RTVBfRFBfQVVYX1JFUExZX0NPREVfSTJDX0FDSykpIHsKKwkJcmVnID0genlucW1wX2Rw
X3JlYWQoZHAsIFpZTlFNUF9EUF9SRVBMWV9EQVRBX0NPVU5UKTsKKwkJaWYgKChyZWcgJiBaWU5R
TVBfRFBfUkVQTFlfREFUQV9DT1VOVF9NQVNLKSAhPSBieXRlcykKKwkJCXJldHVybiAtRUlPOwor
CisJCWZvciAoaSA9IDA7IGkgPCBieXRlczsgaSsrKQorCQkJYnVmW2ldID0genlucW1wX2RwX3Jl
YWQoZHAsIFpZTlFNUF9EUF9BVVhfUkVQTFlfREFUQSk7CisJfQorCisJcmV0dXJuIDA7Cit9CisK
K3N0YXRpYyBzc2l6ZV90Cit6eW5xbXBfZHBfYXV4X3RyYW5zZmVyKHN0cnVjdCBkcm1fZHBfYXV4
ICphdXgsIHN0cnVjdCBkcm1fZHBfYXV4X21zZyAqbXNnKQoreworCXN0cnVjdCB6eW5xbXBfZHAg
KmRwID0gY29udGFpbmVyX29mKGF1eCwgc3RydWN0IHp5bnFtcF9kcCwgYXV4KTsKKwlpbnQgcmV0
OworCXVuc2lnbmVkIGludCBpLCBpdGVyOworCisJLyogTnVtYmVyIG9mIGxvb3BzID0gdGltZW91
dCBpbiBtc2VjIC8gYXV4IGRlbGF5ICg0MDAgdXNlYykgKi8KKwlpdGVyID0genlucW1wX2RwX2F1
eF90aW1lb3V0X21zICogMTAwMCAvIDQwMDsKKwlpdGVyID0gaXRlciA/IGl0ZXIgOiAxOworCisJ
Zm9yIChpID0gMDsgaSA8IGl0ZXI7IGkrKykgeworCQlyZXQgPSB6eW5xbXBfZHBfYXV4X2NtZF9z
dWJtaXQoZHAsIG1zZy0+cmVxdWVzdCwgbXNnLT5hZGRyZXNzLAorCQkJCQkgICAgICAgbXNnLT5i
dWZmZXIsIG1zZy0+c2l6ZSwKKwkJCQkJICAgICAgICZtc2ctPnJlcGx5KTsKKwkJaWYgKCFyZXQp
IHsKKwkJCWRldl9kYmcoZHAtPmRldiwgImF1eCAlZCByZXRyaWVzXG4iLCBpKTsKKwkJCXJldHVy
biBtc2ctPnNpemU7CisJCX0KKworCQlpZiAoZHAtPnN0YXR1cyA9PSBjb25uZWN0b3Jfc3RhdHVz
X2Rpc2Nvbm5lY3RlZCkgeworCQkJZGV2X2RiZyhkcC0+ZGV2LCAibm8gY29ubmVjdGVkIGF1eCBk
ZXZpY2VcbiIpOworCQkJcmV0dXJuIC1FTk9ERVY7CisJCX0KKworCQl1c2xlZXBfcmFuZ2UoNDAw
LCA1MDApOworCX0KKworCWRldl9kYmcoZHAtPmRldiwgImZhaWxlZCB0byBkbyBhdXggdHJhbnNm
ZXIgKCVkKVxuIiwgcmV0KTsKKworCXJldHVybiByZXQ7Cit9CisKKy8qKgorICogenlucW1wX2Rw
X2F1eF9pbml0IC0gSW5pdGlhbGl6ZSBhbmQgcmVnaXN0ZXIgdGhlIERQIEFVWAorICogQGRwOiBE
aXNwbGF5UG9ydCBJUCBjb3JlIHN0cnVjdHVyZQorICoKKyAqIFByb2dyYW0gdGhlIEFVWCBjbG9j
ayBkaXZpZGVyIGFuZCBmaWx0ZXIgYW5kIHJlZ2lzdGVyIHRoZSBEUCBBVVggYWRhcHRlci4KKyAq
CisgKiBSZXR1cm46IDAgb24gc3VjY2VzcywgZXJyb3IgdmFsdWUgb3RoZXJ3aXNlCisgKi8KK3N0
YXRpYyBpbnQgenlucW1wX2RwX2F1eF9pbml0KHN0cnVjdCB6eW5xbXBfZHAgKmRwKQoreworCXVu
c2lnbmVkIGxvbmcgcmF0ZTsKKwl1bnNpZ25lZCBpbnQgdzsKKworCS8qCisJICogVGhlIEFVWF9T
SUdOQUxfV0lEVEhfRklMVEVSIGlzIHRoZSBudW1iZXIgb2YgQVBCIGNsb2NrIGN5Y2xlcworCSAq
IGNvcnJlc3BvbmRpbmcgdG8gdGhlIEFVWCBwdWxzZS4gQWxsb3dhYmxlIHZhbHVlcyBhcmUgOCwg
MTYsIDI0LCAzMiwKKwkgKiA0MCBhbmQgNDguIFRoZSBBVVggcHVsc2Ugd2lkdGggbXVzdCBiZSBi
ZXR3ZWVuIDAuNMK1cyBhbmQgMC42wrVzLAorCSAqIGNvbXB1dGUgdGhlIHcgLyA4IHZhbHVlIGNv
cnJlc3BvbmRpbmcgdG8gMC40wrVzIHJvdW5kZWQgdXAsIGFuZCBtYWtlCisJICogc3VyZSBpdCBz
dGF5cyBiZWxvdyAwLjbCtXMgYW5kIHdpdGhpbiB0aGUgYWxsb3dhYmxlIHZhbHVlcy4KKwkgKi8K
KwlyYXRlID0gY2xrX2dldF9yYXRlKGRwLT5kcHN1Yi0+YXBiX2Nsayk7CisJdyA9IERJVl9ST1VO
RF9VUCg0ICogcmF0ZSwgMTAwMCAqIDEwMDAgKiAxMCAqIDgpICogODsKKwlpZiAodyA+IDYgKiBy
YXRlIC8gKDEwMDAgKiAxMDAwICogMTApIHx8IHcgPiA0OCkgeworCQlkZXZfZXJyKGRwLT5kZXYs
ICJhY2xrIGZyZXF1ZW5jeSB0b28gaGlnaFxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKwor
CXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX0FVWF9DTEtfRElWSURFUiwKKwkJCSh3IDw8
IFpZTlFNUF9EUF9BVVhfQ0xLX0RJVklERVJfQVVYX0ZJTFRFUl9TSElGVCkgfAorCQkJKHJhdGUg
LyAoMTAwMCAqIDEwMDApKSk7CisKKwlkcC0+YXV4Lm5hbWUgPSAiWnlucU1QIERQIEFVWCI7CisJ
ZHAtPmF1eC5kZXYgPSBkcC0+ZGV2OworCWRwLT5hdXgudHJhbnNmZXIgPSB6eW5xbXBfZHBfYXV4
X3RyYW5zZmVyOworCisJcmV0dXJuIGRybV9kcF9hdXhfcmVnaXN0ZXIoJmRwLT5hdXgpOworfQor
CisvKioKKyAqIHp5bnFtcF9kcF9hdXhfY2xlYW51cCAtIENsZWFudXAgdGhlIERQIEFVWAorICog
QGRwOiBEaXNwbGF5UG9ydCBJUCBjb3JlIHN0cnVjdHVyZQorICoKKyAqIFVucmVnaXN0ZXIgdGhl
IERQIEFVWCBhZGFwdGVyLgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZHBfYXV4X2NsZWFudXAo
c3RydWN0IHp5bnFtcF9kcCAqZHApCit7CisJZHJtX2RwX2F1eF91bnJlZ2lzdGVyKCZkcC0+YXV4
KTsKK30KKworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqIERpc3BsYXlQb3J0IEdlbmVyaWMg
U3VwcG9ydAorICovCisKKy8qKgorICogenlucW1wX2RwX3VwZGF0ZV9taXNjIC0gV3JpdGUgdGhl
IG1pc2MgcmVnaXN0ZXJzCisgKiBAZHA6IERpc3BsYXlQb3J0IElQIGNvcmUgc3RydWN0dXJlCisg
KgorICogVGhlIG1pc2MgcmVnaXN0ZXIgdmFsdWVzIGFyZSBzdG9yZWQgaW4gdGhlIHN0cnVjdHVy
ZSwgYW5kIHRoaXMKKyAqIGZ1bmN0aW9uIGFwcGxpZXMgdGhlIHZhbHVlcyBpbnRvIHRoZSByZWdp
c3RlcnMuCisgKi8KK3N0YXRpYyB2b2lkIHp5bnFtcF9kcF91cGRhdGVfbWlzYyhzdHJ1Y3Qgenlu
cW1wX2RwICpkcCkKK3sKKwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9NQUlOX1NUUkVB
TV9NSVNDMCwgZHAtPmNvbmZpZy5taXNjMCk7CisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBf
RFBfTUFJTl9TVFJFQU1fTUlTQzEsIGRwLT5jb25maWcubWlzYzEpOworfQorCisvKioKKyAqIHp5
bnFtcF9kcF9zZXRfZm9ybWF0IC0gU2V0IHRoZSBpbnB1dCBmb3JtYXQKKyAqIEBkcDogRGlzcGxh
eVBvcnQgSVAgY29yZSBzdHJ1Y3R1cmUKKyAqIEBmb3JtYXQ6IGlucHV0IGZvcm1hdAorICogQGJw
YzogYml0cyBwZXIgY29tcG9uZW50CisgKgorICogVXBkYXRlIG1pc2MgcmVnaXN0ZXIgdmFsdWVz
IGJhc2VkIG9uIGlucHV0IEBmb3JtYXQgYW5kIEBicGMuCisgKgorICogUmV0dXJuOiAwIG9uIHN1
Y2Nlc3MsIG9yIC1FSU5WQUwuCisgKi8KK3N0YXRpYyBpbnQgenlucW1wX2RwX3NldF9mb3JtYXQo
c3RydWN0IHp5bnFtcF9kcCAqZHAsCisJCQkJZW51bSB6eW5xbXBfZHBzdWJfZm9ybWF0IGZvcm1h
dCwKKwkJCQl1bnNpZ25lZCBpbnQgYnBjKQoreworCXN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Rp
c3BsYXlfaW5mbyAqZGlzcGxheTsKKwlzdHJ1Y3QgenlucW1wX2RwX2NvbmZpZyAqY29uZmlnID0g
JmRwLT5jb25maWc7CisJdW5zaWduZWQgaW50IG51bV9jb2xvcnM7CisKKwljb25maWctPm1pc2Mw
ICY9IH5aWU5RTVBfRFBfTUFJTl9TVFJFQU1fTUlTQzBfQ09NUF9GT1JNQVRfTUFTSzsKKwljb25m
aWctPm1pc2MxICY9IH5aWU5RTVBfRFBfTUFJTl9TVFJFQU1fTUlTQzFfWV9PTkxZX0VOOworCisJ
c3dpdGNoIChmb3JtYXQpIHsKKwljYXNlIFpZTlFNUF9EUFNVQl9GT1JNQVRfUkdCOgorCQljb25m
aWctPm1pc2MwIHw9IFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9NSVNDMF9DT01QX0ZPUk1BVF9SR0I7
CisJCW51bV9jb2xvcnMgPSAzOworCQlicmVhazsKKworCWNhc2UgWllOUU1QX0RQU1VCX0ZPUk1B
VF9ZQ1JDQjQ0NDoKKwkJY29uZmlnLT5taXNjMCB8PSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fTUlT
QzBfQ09NUF9GT1JNQVRfWUNSQ0JfNDQ0OworCQludW1fY29sb3JzID0gMzsKKwkJYnJlYWs7CisK
KwljYXNlIFpZTlFNUF9EUFNVQl9GT1JNQVRfWUNSQ0I0MjI6CisJCWNvbmZpZy0+bWlzYzAgfD0g
WllOUU1QX0RQX01BSU5fU1RSRUFNX01JU0MwX0NPTVBfRk9STUFUX1lDUkNCXzQyMjsKKwkJbnVt
X2NvbG9ycyA9IDI7CisJCWJyZWFrOworCisJY2FzZSBaWU5RTVBfRFBTVUJfRk9STUFUX1lPTkxZ
OgorCQljb25maWctPm1pc2MxIHw9IFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9NSVNDMV9ZX09OTFlf
RU47CisJCW51bV9jb2xvcnMgPSAxOworCQlicmVhazsKKworCWRlZmF1bHQ6CisJCWRldl9lcnIo
ZHAtPmRldiwgIkludmFsaWQgY29sb3JtZXRyeSBpbiBEVFxuIik7CisJCXJldHVybiAtRUlOVkFM
OworCX0KKworCWRpc3BsYXkgPSAmZHAtPmNvbm5lY3Rvci5kaXNwbGF5X2luZm87CisJaWYgKGRp
c3BsYXktPmJwYyAmJiBicGMgPiBkaXNwbGF5LT5icGMpIHsKKwkJZGV2X3dhcm4oZHAtPmRldiwK
KwkJCSAiZG93bmdyYWRpbmcgcmVxdWVzdGVkICV1YnBjIHRvIGRpc3BsYXkgbGltaXQgJXVicGNc
biIsCisJCQkgYnBjLCBkaXNwbGF5LT5icGMpOworCQlicGMgPSBkaXNwbGF5LT5icGM7CisJfQor
CisJY29uZmlnLT5taXNjMCAmPSB+WllOUU1QX0RQX01BSU5fU1RSRUFNX01JU0MwX0JQQ19NQVNL
OworCisJc3dpdGNoIChicGMpIHsKKwljYXNlIDY6CisJCWNvbmZpZy0+bWlzYzAgfD0gWllOUU1Q
X0RQX01BSU5fU1RSRUFNX01JU0MwX0JQQ182OworCQlicmVhazsKKwljYXNlIDg6CisJCWNvbmZp
Zy0+bWlzYzAgfD0gWllOUU1QX0RQX01BSU5fU1RSRUFNX01JU0MwX0JQQ184OworCQlicmVhazsK
KwljYXNlIDEwOgorCQljb25maWctPm1pc2MwIHw9IFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9NSVND
MF9CUENfMTA7CisJCWJyZWFrOworCWNhc2UgMTI6CisJCWNvbmZpZy0+bWlzYzAgfD0gWllOUU1Q
X0RQX01BSU5fU1RSRUFNX01JU0MwX0JQQ18xMjsKKwkJYnJlYWs7CisJY2FzZSAxNjoKKwkJY29u
ZmlnLT5taXNjMCB8PSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fTUlTQzBfQlBDXzE2OworCQlicmVh
azsKKwlkZWZhdWx0OgorCQlkZXZfd2FybihkcC0+ZGV2LCAiTm90IHN1cHBvcnRlZCBicGMgKCV1
KS4gZmFsbCBiYWNrIHRvIDhicGNcbiIsCisJCQkgYnBjKTsKKwkJY29uZmlnLT5taXNjMCB8PSBa
WU5RTVBfRFBfTUFJTl9TVFJFQU1fTUlTQzBfQlBDXzg7CisJCWJwYyA9IDg7CisJCWJyZWFrOwor
CX0KKworCS8qIFVwZGF0ZSB0aGUgY3VycmVudCBicHAgYmFzZWQgb24gdGhlIGZvcm1hdC4gKi8K
Kwljb25maWctPmJwcCA9IGJwYyAqIG51bV9jb2xvcnM7CisKKwlyZXR1cm4gMDsKK30KKworLyoq
CisgKiB6eW5xbXBfZHBfZW5jb2Rlcl9tb2RlX3NldF90cmFuc2Zlcl91bml0IC0gU2V0IHRoZSB0
cmFuc2ZlciB1bml0IHZhbHVlcworICogQGRwOiBEaXNwbGF5UG9ydCBJUCBjb3JlIHN0cnVjdHVy
ZQorICogQG1vZGU6IHJlcXVlc3RlZCBkaXNwbGF5IG1vZGUKKyAqCisgKiBTZXQgdGhlIHRyYW5z
ZmVyIHVuaXQsIGFuZCBjYWxjdWxhdGUgYWxsIHRyYW5zZmVyIHVuaXQgc2l6ZSByZWxhdGVkIHZh
bHVlcy4KKyAqIENhbGN1bGF0aW9uIGlzIGJhc2VkIG9uIERQIGFuZCBJUCBjb3JlIHNwZWNpZmlj
YXRpb24uCisgKi8KK3N0YXRpYyB2b2lkCit6eW5xbXBfZHBfZW5jb2Rlcl9tb2RlX3NldF90cmFu
c2Zlcl91bml0KHN0cnVjdCB6eW5xbXBfZHAgKmRwLAorCQkJCQkgc3RydWN0IGRybV9kaXNwbGF5
X21vZGUgKm1vZGUpCit7CisJdTMyIHR1ID0gWllOUU1QX0RQX01TQV9UUkFOU0ZFUl9VTklUX1NJ
WkVfVFVfU0laRV9ERUY7CisJdTMyIGJ3LCB2aWRfa2J5dGVzLCBhdmdfYnl0ZXNfcGVyX3R1LCBp
bml0X3dhaXQ7CisKKwkvKiBVc2UgdGhlIG1heCB0cmFuc2ZlciB1bml0IHNpemUgKGRlZmF1bHQp
ICovCisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfTVNBX1RSQU5TRkVSX1VOSVRfU0la
RSwgdHUpOworCisJdmlkX2tieXRlcyA9IG1vZGUtPmNsb2NrICogKGRwLT5jb25maWcuYnBwIC8g
OCk7CisJYncgPSBkcm1fZHBfYndfY29kZV90b19saW5rX3JhdGUoZHAtPm1vZGUuYndfY29kZSk7
CisJYXZnX2J5dGVzX3Blcl90dSA9IHZpZF9rYnl0ZXMgKiB0dSAvIChkcC0+bW9kZS5sYW5lX2Nu
dCAqIGJ3IC8gMTAwMCk7CisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfTUlOX0JZVEVT
X1BFUl9UVSwKKwkJCWF2Z19ieXRlc19wZXJfdHUgLyAxMDAwKTsKKwl6eW5xbXBfZHBfd3JpdGUo
ZHAsIFpZTlFNUF9EUF9GUkFDX0JZVEVTX1BFUl9UVSwKKwkJCWF2Z19ieXRlc19wZXJfdHUgJSAx
MDAwKTsKKworCS8qIENvbmZpZ3VyZSB0aGUgaW5pdGlhbCB3YWl0IGN5Y2xlIGJhc2VkIG9uIHRy
YW5zZmVyIHVuaXQgc2l6ZSAqLworCWlmICh0dSA8IChhdmdfYnl0ZXNfcGVyX3R1IC8gMTAwMCkp
CisJCWluaXRfd2FpdCA9IDA7CisJZWxzZSBpZiAoKGF2Z19ieXRlc19wZXJfdHUgLyAxMDAwKSA8
PSA0KQorCQlpbml0X3dhaXQgPSB0dTsKKwllbHNlCisJCWluaXRfd2FpdCA9IHR1IC0gYXZnX2J5
dGVzX3Blcl90dSAvIDEwMDA7CisKKwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9JTklU
X1dBSVQsIGluaXRfd2FpdCk7Cit9CisKKy8qKgorICogenlucW1wX2RwX2VuY29kZXJfbW9kZV9z
ZXRfc3RyZWFtIC0gQ29uZmlndXJlIHRoZSBtYWluIHN0cmVhbQorICogQGRwOiBEaXNwbGF5UG9y
dCBJUCBjb3JlIHN0cnVjdHVyZQorICogQG1vZGU6IHJlcXVlc3RlZCBkaXNwbGF5IG1vZGUKKyAq
CisgKiBDb25maWd1cmUgdGhlIG1haW4gc3RyZWFtIGJhc2VkIG9uIHRoZSByZXF1ZXN0ZWQgbW9k
ZSBAbW9kZS4gQ2FsY3VsYXRpb24gaXMKKyAqIGJhc2VkIG9uIElQIGNvcmUgc3BlY2lmaWNhdGlv
bi4KKyAqLworc3RhdGljIHZvaWQgenlucW1wX2RwX2VuY29kZXJfbW9kZV9zZXRfc3RyZWFtKHN0
cnVjdCB6eW5xbXBfZHAgKmRwLAorCQkJCQkgICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlf
bW9kZSAqbW9kZSkKK3sKKwl1OCBsYW5lX2NudCA9IGRwLT5tb2RlLmxhbmVfY250OworCXUzMiBy
ZWcsIHdwbDsKKwl1bnNpZ25lZCBpbnQgcmF0ZTsKKworCXp5bnFtcF9kcF93cml0ZShkcCwgWllO
UU1QX0RQX01BSU5fU1RSRUFNX0hUT1RBTCwgbW9kZS0+aHRvdGFsKTsKKwl6eW5xbXBfZHBfd3Jp
dGUoZHAsIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9WVE9UQUwsIG1vZGUtPnZ0b3RhbCk7CisJenlu
cW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fUE9MQVJJVFksCisJCQkoISEo
bW9kZS0+ZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX1BWU1lOQykgPDwKKwkJCSBaWU5RTVBfRFBfTUFJ
Tl9TVFJFQU1fUE9MQVJJVFlfVlNZTkNfU0hJRlQpIHwKKwkJCSghIShtb2RlLT5mbGFncyAmIERS
TV9NT0RFX0ZMQUdfUEhTWU5DKSA8PAorCQkJIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9QT0xBUklU
WV9IU1lOQ19TSElGVCkpOworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX01BSU5fU1RS
RUFNX0hTV0lEVEgsCisJCQltb2RlLT5oc3luY19lbmQgLSBtb2RlLT5oc3luY19zdGFydCk7CisJ
enlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fVlNXSURUSCwKKwkJCW1v
ZGUtPnZzeW5jX2VuZCAtIG1vZGUtPnZzeW5jX3N0YXJ0KTsKKwl6eW5xbXBfZHBfd3JpdGUoZHAs
IFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9IUkVTLCBtb2RlLT5oZGlzcGxheSk7CisJenlucW1wX2Rw
X3dyaXRlKGRwLCBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fVlJFUywgbW9kZS0+dmRpc3BsYXkpOwor
CXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX01BSU5fU1RSRUFNX0hTVEFSVCwKKwkJCW1v
ZGUtPmh0b3RhbCAtIG1vZGUtPmhzeW5jX3N0YXJ0KTsKKwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZ
TlFNUF9EUF9NQUlOX1NUUkVBTV9WU1RBUlQsCisJCQltb2RlLT52dG90YWwgLSBtb2RlLT52c3lu
Y19zdGFydCk7CisKKwkvKiBJbiBzeW5jaHJvbm91cyBtb2RlLCBzZXQgdGhlIGRpdmllcnMgKi8K
KwlpZiAoZHAtPmNvbmZpZy5taXNjMCAmIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9NSVNDMF9TWU5D
X0xPQ0spIHsKKwkJcmVnID0gZHJtX2RwX2J3X2NvZGVfdG9fbGlua19yYXRlKGRwLT5tb2RlLmJ3
X2NvZGUpOworCQl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9OX1ZJ
RCwgcmVnKTsKKwkJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fTV9W
SUQsIG1vZGUtPmNsb2NrKTsKKwkJcmF0ZSA9IHp5bnFtcF9kaXNwX2dldF9hdWRpb19jbGtfcmF0
ZShkcC0+ZHBzdWItPmRpc3ApOworCQlpZiAocmF0ZSkgeworCQkJZGV2X2RiZyhkcC0+ZGV2LCAi
QXVkaW8gcmF0ZTogJWRcbiIsIHJhdGUgLyA1MTIpOworCQkJenlucW1wX2RwX3dyaXRlKGRwLCBa
WU5RTVBfRFBfVFhfTl9BVUQsIHJlZyk7CisJCQl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9E
UF9UWF9NX0FVRCwgcmF0ZSAvIDEwMDApOworCQl9CisJfQorCisJLyogT25seSAyIGNoYW5uZWwg
YXVkaW8gaXMgc3VwcG9ydGVkIG5vdyAqLworCWlmICh6eW5xbXBfZGlzcF9hdWRpb19lbmFibGVk
KGRwLT5kcHN1Yi0+ZGlzcCkpCisJCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX1RYX0FV
RElPX0NIQU5ORUxTLCAxKTsKKworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX1VTRVJf
UElYX1dJRFRILCAxKTsKKworCS8qIFRyYW5zbGF0ZSB0byB0aGUgbmF0aXZlIDE2IGJpdCBkYXRh
cGF0aCBiYXNlZCBvbiBJUCBjb3JlIHNwZWMgKi8KKwl3cGwgPSAobW9kZS0+aGRpc3BsYXkgKiBk
cC0+Y29uZmlnLmJwcCArIDE1KSAvIDE2OworCXJlZyA9IHdwbCArIHdwbCAlIGxhbmVfY250IC0g
bGFuZV9jbnQ7CisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfVVNFUl9EQVRBX0NPVU5U
X1BFUl9MQU5FLCByZWcpOworfQorCisvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICogRFJNIENv
bm5lY3RvcgorICovCisKK3N0YXRpYyBlbnVtIGRybV9jb25uZWN0b3Jfc3RhdHVzCit6eW5xbXBf
ZHBfY29ubmVjdG9yX2RldGVjdChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBib29s
IGZvcmNlKQoreworCXN0cnVjdCB6eW5xbXBfZHAgKmRwID0gY29ubmVjdG9yX3RvX2RwKGNvbm5l
Y3Rvcik7CisJc3RydWN0IHp5bnFtcF9kcF9saW5rX2NvbmZpZyAqbGlua19jb25maWcgPSAmZHAt
PmxpbmtfY29uZmlnOworCXUzMiBzdGF0ZSwgaTsKKwlpbnQgcmV0OworCisJLyoKKwkgKiBUaGlz
IGlzIGZyb20gaGV1cmlzdGljLiBJdCB0YWtlcyBzb21lIGRlbGF5IChleCwgMTAwIH4gNTAwIG1z
ZWMpIHRvCisJICogZ2V0IHRoZSBIUEQgc2lnbmFsIHdpdGggc29tZSBtb25pdG9ycy4KKwkgKi8K
Kwlmb3IgKGkgPSAwOyBpIDwgMTA7IGkrKykgeworCQlzdGF0ZSA9IHp5bnFtcF9kcF9yZWFkKGRw
LCBaWU5RTVBfRFBfSU5URVJSVVBUX1NJR05BTF9TVEFURSk7CisJCWlmIChzdGF0ZSAmIFpZTlFN
UF9EUF9JTlRFUlJVUFRfU0lHTkFMX1NUQVRFX0hQRCkKKwkJCWJyZWFrOworCQltc2xlZXAoMTAw
KTsKKwl9CisKKwlpZiAoc3RhdGUgJiBaWU5RTVBfRFBfSU5URVJSVVBUX1NJR05BTF9TVEFURV9I
UEQpIHsKKwkJcmV0ID0gZHJtX2RwX2RwY2RfcmVhZCgmZHAtPmF1eCwgMHgwLCBkcC0+ZHBjZCwK
KwkJCQkgICAgICAgc2l6ZW9mKGRwLT5kcGNkKSk7CisJCWlmIChyZXQgPCAwKSB7CisJCQlkZXZf
ZGJnKGRwLT5kZXYsICJEUENEIHJlYWQgZmFpbGVzIik7CisJCQlnb3RvIGRpc2Nvbm5lY3RlZDsK
KwkJfQorCisJCWxpbmtfY29uZmlnLT5tYXhfcmF0ZSA9IG1pbl90KGludCwKKwkJCQkJICAgICAg
ZHJtX2RwX21heF9saW5rX3JhdGUoZHAtPmRwY2QpLAorCQkJCQkgICAgICBEUF9ISUdIX0JJVF9S
QVRFMik7CisJCWxpbmtfY29uZmlnLT5tYXhfbGFuZXMgPSBtaW5fdCh1OCwKKwkJCQkJICAgICAg
IGRybV9kcF9tYXhfbGFuZV9jb3VudChkcC0+ZHBjZCksCisJCQkJCSAgICAgICBkcC0+bnVtX2xh
bmVzKTsKKworCQlkcC0+c3RhdHVzID0gY29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQ7CisJCXJl
dHVybiBjb25uZWN0b3Jfc3RhdHVzX2Nvbm5lY3RlZDsKKwl9CisKK2Rpc2Nvbm5lY3RlZDoKKwlk
cC0+c3RhdHVzID0gY29ubmVjdG9yX3N0YXR1c19kaXNjb25uZWN0ZWQ7CisJcmV0dXJuIGNvbm5l
Y3Rvcl9zdGF0dXNfZGlzY29ubmVjdGVkOworfQorCitzdGF0aWMgaW50IHp5bnFtcF9kcF9jb25u
ZWN0b3JfZ2V0X21vZGVzKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCit7CisJc3Ry
dWN0IHp5bnFtcF9kcCAqZHAgPSBjb25uZWN0b3JfdG9fZHAoY29ubmVjdG9yKTsKKwlzdHJ1Y3Qg
ZWRpZCAqZWRpZDsKKwlpbnQgcmV0OworCisJZWRpZCA9IGRybV9nZXRfZWRpZChjb25uZWN0b3Is
ICZkcC0+YXV4LmRkYyk7CisJaWYgKCFlZGlkKQorCQlyZXR1cm4gMDsKKworCWRybV9jb25uZWN0
b3JfdXBkYXRlX2VkaWRfcHJvcGVydHkoY29ubmVjdG9yLCBlZGlkKTsKKwlyZXQgPSBkcm1fYWRk
X2VkaWRfbW9kZXMoY29ubmVjdG9yLCBlZGlkKTsKKwlrZnJlZShlZGlkKTsKKworCXJldHVybiBy
ZXQ7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgZHJtX2VuY29kZXIgKgorenlucW1wX2RwX2Nvbm5lY3Rv
cl9iZXN0X2VuY29kZXIoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKK3sKKwlzdHJ1
Y3QgenlucW1wX2RwICpkcCA9IGNvbm5lY3Rvcl90b19kcChjb25uZWN0b3IpOworCisJcmV0dXJu
ICZkcC0+ZW5jb2RlcjsKK30KKworc3RhdGljIGludCB6eW5xbXBfZHBfY29ubmVjdG9yX21vZGVf
dmFsaWQoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKKwkJCQkJICBzdHJ1Y3QgZHJt
X2Rpc3BsYXlfbW9kZSAqbW9kZSkKK3sKKwlzdHJ1Y3QgenlucW1wX2RwICpkcCA9IGNvbm5lY3Rv
cl90b19kcChjb25uZWN0b3IpOworCXU4IG1heF9sYW5lcyA9IGRwLT5saW5rX2NvbmZpZy5tYXhf
bGFuZXM7CisJdTggYnBwID0gZHAtPmNvbmZpZy5icHA7CisJaW50IG1heF9yYXRlID0gZHAtPmxp
bmtfY29uZmlnLm1heF9yYXRlOworCWludCByYXRlOworCisJaWYgKG1vZGUtPmNsb2NrID4gWllO
UU1QX01BWF9GUkVRKSB7CisJCWRldl9kYmcoZHAtPmRldiwgImZpbHRlcmVkIHRoZSBtb2RlLCAl
cyxmb3IgaGlnaCBwaXhlbCByYXRlXG4iLAorCQkJbW9kZS0+bmFtZSk7CisJCWRybV9tb2RlX2Rl
YnVnX3ByaW50bW9kZWxpbmUobW9kZSk7CisJCXJldHVybiBNT0RFX0NMT0NLX0hJR0g7CisJfQor
CisJLyogQ2hlY2sgd2l0aCBsaW5rIHJhdGUgYW5kIGxhbmUgY291bnQgKi8KKwlyYXRlID0genlu
cW1wX2RwX21heF9yYXRlKG1heF9yYXRlLCBtYXhfbGFuZXMsIGJwcCk7CisJaWYgKG1vZGUtPmNs
b2NrID4gcmF0ZSkgeworCQlkZXZfZGJnKGRwLT5kZXYsICJmaWx0ZXJlZCB0aGUgbW9kZSwgJXMs
Zm9yIGhpZ2ggcGl4ZWwgcmF0ZVxuIiwKKwkJCW1vZGUtPm5hbWUpOworCQlkcm1fbW9kZV9kZWJ1
Z19wcmludG1vZGVsaW5lKG1vZGUpOworCQlyZXR1cm4gTU9ERV9DTE9DS19ISUdIOworCX0KKwor
CXJldHVybiBNT0RFX09LOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jf
ZnVuY3MgenlucW1wX2RwX2Nvbm5lY3Rvcl9mdW5jcyA9IHsKKwkuZGV0ZWN0CQkJPSB6eW5xbXBf
ZHBfY29ubmVjdG9yX2RldGVjdCwKKwkuZmlsbF9tb2RlcwkJPSBkcm1faGVscGVyX3Byb2JlX3Np
bmdsZV9jb25uZWN0b3JfbW9kZXMsCisJLmRlc3Ryb3kJCT0gZHJtX2Nvbm5lY3Rvcl9jbGVhbnVw
LAorCS5hdG9taWNfZHVwbGljYXRlX3N0YXRlCT0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9y
X2R1cGxpY2F0ZV9zdGF0ZSwKKwkuYXRvbWljX2Rlc3Ryb3lfc3RhdGUJPSBkcm1fYXRvbWljX2hl
bHBlcl9jb25uZWN0b3JfZGVzdHJveV9zdGF0ZSwKKwkucmVzZXQJCQk9IGRybV9hdG9taWNfaGVs
cGVyX2Nvbm5lY3Rvcl9yZXNldCwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5l
Y3Rvcl9oZWxwZXJfZnVuY3MKK3p5bnFtcF9kcF9jb25uZWN0b3JfaGVscGVyX2Z1bmNzID0gewor
CS5nZXRfbW9kZXMJPSB6eW5xbXBfZHBfY29ubmVjdG9yX2dldF9tb2RlcywKKwkuYmVzdF9lbmNv
ZGVyCT0genlucW1wX2RwX2Nvbm5lY3Rvcl9iZXN0X2VuY29kZXIsCisJLm1vZGVfdmFsaWQJPSB6
eW5xbXBfZHBfY29ubmVjdG9yX21vZGVfdmFsaWQsCit9OworCisvKiAtLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLQorICogRFJNIEVuY29kZXIKKyAqLworCitzdGF0aWMgdm9pZCB6eW5xbXBfZHBfZW5jb2Rl
cl9lbmFibGUoc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyKQoreworCXN0cnVjdCB6eW5xbXBf
ZHAgKmRwID0gZW5jb2Rlcl90b19kcChlbmNvZGVyKTsKKwl1bnNpZ25lZCBpbnQgaTsKKwlpbnQg
cmV0ID0gMDsKKworCXBtX3J1bnRpbWVfZ2V0X3N5bmMoZHAtPmRldik7CisJZHAtPmVuYWJsZWQg
PSB0cnVlOworCXp5bnFtcF9kcF91cGRhdGVfbWlzYyhkcCk7CisJaWYgKHp5bnFtcF9kaXNwX2F1
ZGlvX2VuYWJsZWQoZHAtPmRwc3ViLT5kaXNwKSkKKwkJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5R
TVBfRFBfVFhfQVVESU9fQ09OVFJPTCwgMSk7CisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBf
RFBfVFhfUEhZX1BPV0VSX0RPV04sIDApOworCWlmIChkcC0+c3RhdHVzID09IGNvbm5lY3Rvcl9z
dGF0dXNfY29ubmVjdGVkKSB7CisJCWZvciAoaSA9IDA7IGkgPCAzOyBpKyspIHsKKwkJCXJldCA9
IGRybV9kcF9kcGNkX3dyaXRlYigmZHAtPmF1eCwgRFBfU0VUX1BPV0VSLAorCQkJCQkJIERQX1NF
VF9QT1dFUl9EMCk7CisJCQlpZiAocmV0ID09IDEpCisJCQkJYnJlYWs7CisJCQl1c2xlZXBfcmFu
Z2UoMzAwLCA1MDApOworCQl9CisJCS8qIFNvbWUgbW9uaXRvcnMgdGFrZSB0aW1lIHRvIHdha2Ug
dXAgcHJvcGVybHkgKi8KKwkJbXNsZWVwKHp5bnFtcF9kcF9wb3dlcl9vbl9kZWxheV9tcyk7CisJ
fQorCWlmIChyZXQgIT0gMSkKKwkJZGV2X2RiZyhkcC0+ZGV2LCAiRFAgYXV4IGZhaWxlZFxuIik7
CisJZWxzZQorCQl6eW5xbXBfZHBfdHJhaW5fbG9vcChkcCk7CisJenlucW1wX2RwX3dyaXRlKGRw
LCBaWU5RTVBfRFBfU09GVFdBUkVfUkVTRVQsCisJCQlaWU5RTVBfRFBfU09GVFdBUkVfUkVTRVRf
QUxMKTsKKwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9FTkFCTEUs
IDEpOworfQorCitzdGF0aWMgdm9pZCB6eW5xbXBfZHBfZW5jb2Rlcl9kaXNhYmxlKHN0cnVjdCBk
cm1fZW5jb2RlciAqZW5jb2RlcikKK3sKKwlzdHJ1Y3QgenlucW1wX2RwICpkcCA9IGVuY29kZXJf
dG9fZHAoZW5jb2Rlcik7CisKKwlkcC0+ZW5hYmxlZCA9IGZhbHNlOworCWNhbmNlbF9kZWxheWVk
X3dvcmsoJmRwLT5ocGRfd29yayk7CisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfTUFJ
Tl9TVFJFQU1fRU5BQkxFLCAwKTsKKwlkcm1fZHBfZHBjZF93cml0ZWIoJmRwLT5hdXgsIERQX1NF
VF9QT1dFUiwgRFBfU0VUX1BPV0VSX0QzKTsKKwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9E
UF9UWF9QSFlfUE9XRVJfRE9XTiwKKwkJCVpZTlFNUF9EUF9UWF9QSFlfUE9XRVJfRE9XTl9BTEwp
OworCWlmICh6eW5xbXBfZGlzcF9hdWRpb19lbmFibGVkKGRwLT5kcHN1Yi0+ZGlzcCkpCisJCXp5
bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX1RYX0FVRElPX0NPTlRST0wsIDApOworCXBtX3J1
bnRpbWVfcHV0X3N5bmMoZHAtPmRldik7Cit9CisKK3N0YXRpYyB2b2lkCit6eW5xbXBfZHBfZW5j
b2Rlcl9hdG9taWNfbW9kZV9zZXQoc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyLAorCQkJCSAg
c3RydWN0IGRybV9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAorCQkJCSAgc3RydWN0IGRybV9jb25u
ZWN0b3Jfc3RhdGUgKmNvbm5lY3Rvcl9zdGF0ZSkKK3sKKwlzdHJ1Y3QgenlucW1wX2RwICpkcCA9
IGVuY29kZXJfdG9fZHAoZW5jb2Rlcik7CisJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUg
PSAmY3J0Y19zdGF0ZS0+bW9kZTsKKwlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRf
bW9kZSA9ICZjcnRjX3N0YXRlLT5hZGp1c3RlZF9tb2RlOworCXU4IG1heF9sYW5lcyA9IGRwLT5s
aW5rX2NvbmZpZy5tYXhfbGFuZXM7CisJdTggYnBwID0gZHAtPmNvbmZpZy5icHA7CisJaW50IHJh
dGUsIG1heF9yYXRlID0gZHAtPmxpbmtfY29uZmlnLm1heF9yYXRlOworCWludCByZXQ7CisKKwl6
eW5xbXBfZHBfc2V0X2Zvcm1hdChkcCwgWllOUU1QX0RQU1VCX0ZPUk1BVF9SR0IsIDgpOworCisJ
LyogQ2hlY2sgYWdhaW4gYXMgYnBwIG9yIGZvcm1hdCBtaWdodCBoYXZlIGJlZW4gY2hhZ25lZCAq
LworCXJhdGUgPSB6eW5xbXBfZHBfbWF4X3JhdGUobWF4X3JhdGUsIG1heF9sYW5lcywgYnBwKTsK
KwlpZiAobW9kZS0+Y2xvY2sgPiByYXRlKSB7CisJCWRldl9lcnIoZHAtPmRldiwgInRoZSBtb2Rl
LCAlcyxoYXMgdG9vIGhpZ2ggcGl4ZWwgcmF0ZVxuIiwKKwkJCW1vZGUtPm5hbWUpOworCQlkcm1f
bW9kZV9kZWJ1Z19wcmludG1vZGVsaW5lKG1vZGUpOworCX0KKworCXJldCA9IHp5bnFtcF9kcF9t
b2RlX2NvbmZpZ3VyZShkcCwgYWRqdXN0ZWRfbW9kZS0+Y2xvY2ssIDApOworCWlmIChyZXQgPCAw
KQorCQlyZXR1cm47CisKKwl6eW5xbXBfZHBfZW5jb2Rlcl9tb2RlX3NldF90cmFuc2Zlcl91bml0
KGRwLCBhZGp1c3RlZF9tb2RlKTsKKwl6eW5xbXBfZHBfZW5jb2Rlcl9tb2RlX3NldF9zdHJlYW0o
ZHAsIGFkanVzdGVkX21vZGUpOworfQorCisjZGVmaW5lIFpZTlFNUF9EUF9NSU5fSF9CQUNLUE9S
Q0gJMjAKKworc3RhdGljIGludAorenlucW1wX2RwX2VuY29kZXJfYXRvbWljX2NoZWNrKHN0cnVj
dCBkcm1fZW5jb2RlciAqZW5jb2RlciwKKwkJCSAgICAgICBzdHJ1Y3QgZHJtX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUsCisJCQkgICAgICAgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5f
c3RhdGUpCit7CisJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUgPSAmY3J0Y19zdGF0ZS0+
bW9kZTsKKwlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZjcnRjX3N0
YXRlLT5hZGp1c3RlZF9tb2RlOworCWludCBkaWZmID0gbW9kZS0+aHRvdGFsIC0gbW9kZS0+aHN5
bmNfZW5kOworCisJLyoKKwkgKiBaeW5xTVAgRFAgcmVxdWlyZXMgaG9yaXpvbnRhbCBiYWNrcG9y
Y2ggdG8gYmUgZ3JlYXRlciB0aGFuIDEyLgorCSAqIFRoaXMgbGltaXRhdGlvbiBtYXkgbm90IGJl
IGNvbXBhdGlibGUgd2l0aCB0aGUgc2luayBkZXZpY2UuCisJICovCisJaWYgKGRpZmYgPCBaWU5R
TVBfRFBfTUlOX0hfQkFDS1BPUkNIKSB7CisJCWludCB2cmVmcmVzaCA9IChhZGp1c3RlZF9tb2Rl
LT5jbG9jayAqIDEwMDApIC8KKwkJCSAgICAgICAoYWRqdXN0ZWRfbW9kZS0+dnRvdGFsICogYWRq
dXN0ZWRfbW9kZS0+aHRvdGFsKTsKKworCQlkZXZfZGJnKGVuY29kZXItPmRldi0+ZGV2LCAiaGJh
Y2twb3JjaCBhZGp1c3RlZDogJWQgdG8gJWQiLAorCQkJZGlmZiwgWllOUU1QX0RQX01JTl9IX0JB
Q0tQT1JDSCAtIGRpZmYpOworCQlkaWZmID0gWllOUU1QX0RQX01JTl9IX0JBQ0tQT1JDSCAtIGRp
ZmY7CisJCWFkanVzdGVkX21vZGUtPmh0b3RhbCArPSBkaWZmOworCQlhZGp1c3RlZF9tb2RlLT5j
bG9jayA9IGFkanVzdGVkX21vZGUtPnZ0b3RhbCAqCisJCQkJICAgICAgIGFkanVzdGVkX21vZGUt
Pmh0b3RhbCAqIHZyZWZyZXNoIC8gMTAwMDsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGlj
IGNvbnN0IHN0cnVjdCBkcm1fZW5jb2Rlcl9mdW5jcyB6eW5xbXBfZHBfZW5jb2Rlcl9mdW5jcyA9
IHsKKwkuZGVzdHJveQkJPSBkcm1fZW5jb2Rlcl9jbGVhbnVwLAorfTsKKworc3RhdGljIGNvbnN0
IHN0cnVjdCBkcm1fZW5jb2Rlcl9oZWxwZXJfZnVuY3MgenlucW1wX2RwX2VuY29kZXJfaGVscGVy
X2Z1bmNzID0geworCS5lbmFibGUJCQk9IHp5bnFtcF9kcF9lbmNvZGVyX2VuYWJsZSwKKwkuZGlz
YWJsZQkJPSB6eW5xbXBfZHBfZW5jb2Rlcl9kaXNhYmxlLAorCS5hdG9taWNfbW9kZV9zZXQJPSB6
eW5xbXBfZHBfZW5jb2Rlcl9hdG9taWNfbW9kZV9zZXQsCisJLmF0b21pY19jaGVjawkJPSB6eW5x
bXBfZHBfZW5jb2Rlcl9hdG9taWNfY2hlY2ssCit9OworCisvKiAtLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LQorICogSW50ZXJydXB0IEhhbmRsaW5nCisgKi8KKworLyoqCisgKiB6eW5xbXBfZHBfZW5hYmxl
X3ZibGFuayAtIEVuYWJsZSB2YmxhbmsKKyAqIEBkcDogRGlzcGxheVBvcnQgSVAgY29yZSBzdHJ1
Y3R1cmUKKyAqCisgKiBFbmFibGUgdmJsYW5rIGludGVycnVwdAorICovCit2b2lkIHp5bnFtcF9k
cF9lbmFibGVfdmJsYW5rKHN0cnVjdCB6eW5xbXBfZHAgKmRwKQoreworCXp5bnFtcF9kcF93cml0
ZShkcCwgWllOUU1QX0RQX0lOVF9FTiwgWllOUU1QX0RQX0lOVF9WQkxBTktfU1RBUlQpOworfQor
CisvKioKKyAqIHp5bnFtcF9kcF9kaXNhYmxlX3ZibGFuayAtIERpc2FibGUgdmJsYW5rCisgKiBA
ZHA6IERpc3BsYXlQb3J0IElQIGNvcmUgc3RydWN0dXJlCisgKgorICogRGlzYWJsZSB2Ymxhbmsg
aW50ZXJydXB0CisgKi8KK3ZvaWQgenlucW1wX2RwX2Rpc2FibGVfdmJsYW5rKHN0cnVjdCB6eW5x
bXBfZHAgKmRwKQoreworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX0lOVF9EUywgWllO
UU1QX0RQX0lOVF9WQkxBTktfU1RBUlQpOworfQorCitzdGF0aWMgdm9pZCB6eW5xbXBfZHBfaHBk
X3dvcmtfZnVuYyhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCit7CisJc3RydWN0IHp5bnFtcF9k
cCAqZHA7CisKKwlkcCA9IGNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3QgenlucW1wX2RwLCBocGRf
d29yay53b3JrKTsKKworCWlmIChkcC0+ZHJtKQorCQlkcm1faGVscGVyX2hwZF9pcnFfZXZlbnQo
ZHAtPmRybSk7Cit9CisKK3N0YXRpYyBpcnFyZXR1cm5fdCB6eW5xbXBfZHBfaXJxX2hhbmRsZXIo
aW50IGlycSwgdm9pZCAqZGF0YSkKK3sKKwlzdHJ1Y3QgenlucW1wX2RwICpkcCA9IChzdHJ1Y3Qg
enlucW1wX2RwICopZGF0YTsKKwl1MzIgc3RhdHVzLCBtYXNrOworCisJc3RhdHVzID0genlucW1w
X2RwX3JlYWQoZHAsIFpZTlFNUF9EUF9JTlRfU1RBVFVTKTsKKwltYXNrID0genlucW1wX2RwX3Jl
YWQoZHAsIFpZTlFNUF9EUF9JTlRfTUFTSyk7CisJaWYgKCEoc3RhdHVzICYgfm1hc2spKQorCQly
ZXR1cm4gSVJRX05PTkU7CisKKwkvKiBkYmcgZm9yIGRpYWdub3N0aWMsIGJ1dCBub3QgbXVjaCB0
aGF0IHRoZSBkcml2ZXIgY2FuIGRvICovCisJaWYgKHN0YXR1cyAmIFpZTlFNUF9EUF9JTlRfQ0hC
VUZfVU5ERVJGTFdfTUFTSykKKwkJZGV2X2RiZ19yYXRlbGltaXRlZChkcC0+ZGV2LCAidW5kZXJm
bG93IGludGVycnVwdFxuIik7CisJaWYgKHN0YXR1cyAmIFpZTlFNUF9EUF9JTlRfQ0hCVUZfT1ZF
UkZMV19NQVNLKQorCQlkZXZfZGJnX3JhdGVsaW1pdGVkKGRwLT5kZXYsICJvdmVyZmxvdyBpbnRl
cnJ1cHRcbiIpOworCisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfSU5UX1NUQVRVUywg
c3RhdHVzKTsKKworCWlmIChzdGF0dXMgJiBaWU5RTVBfRFBfSU5UX1ZCTEFOS19TVEFSVCkKKwkJ
enlucW1wX2Rpc3BfaGFuZGxlX3ZibGFuayhkcC0+ZHBzdWItPmRpc3ApOworCisJaWYgKHN0YXR1
cyAmIFpZTlFNUF9EUF9JTlRfSFBEX0VWRU5UKQorCQlzY2hlZHVsZV9kZWxheWVkX3dvcmsoJmRw
LT5ocGRfd29yaywgMCk7CisKKwlpZiAoc3RhdHVzICYgWllOUU1QX0RQX0lOVF9IUERfSVJRKSB7
CisJCWludCByZXQ7CisJCXU4IHN0YXR1c1tEUF9MSU5LX1NUQVRVU19TSVpFICsgMl07CisKKwkJ
cmV0ID0gZHJtX2RwX2RwY2RfcmVhZCgmZHAtPmF1eCwgRFBfU0lOS19DT1VOVCwgc3RhdHVzLAor
CQkJCSAgICAgICBEUF9MSU5LX1NUQVRVU19TSVpFICsgMik7CisJCWlmIChyZXQgPCAwKQorCQkJ
Z290byBoYW5kbGVkOworCisJCWlmIChzdGF0dXNbNF0gJiBEUF9MSU5LX1NUQVRVU19VUERBVEVE
IHx8CisJCSAgICAhZHJtX2RwX2Nsb2NrX3JlY292ZXJ5X29rKCZzdGF0dXNbMl0sIGRwLT5tb2Rl
LmxhbmVfY250KSB8fAorCQkgICAgIWRybV9kcF9jaGFubmVsX2VxX29rKCZzdGF0dXNbMl0sIGRw
LT5tb2RlLmxhbmVfY250KSkgeworCQkJenlucW1wX2RwX3RyYWluX2xvb3AoZHApOworCQl9CisJ
fQorCitoYW5kbGVkOgorCXJldHVybiBJUlFfSEFORExFRDsKK30KKworLyogLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0KKyAqIEluaXRpYWxpemF0aW9uICYgQ2xlYW51cAorICovCisKK2ludCB6eW5xbXBf
ZHBfaW5pdChzdHJ1Y3QgenlucW1wX2Rwc3ViICpkcHN1Yiwgc3RydWN0IGRybV9kZXZpY2UgKmRy
bSkKK3sKKwlzdHJ1Y3QgenlucW1wX2RwICpkcCA9IGRwc3ViLT5kcDsKKwlzdHJ1Y3QgZHJtX2Vu
Y29kZXIgKmVuY29kZXIgPSAmZHAtPmVuY29kZXI7CisJc3RydWN0IGRybV9jb25uZWN0b3IgKmNv
bm5lY3RvciA9ICZkcC0+Y29ubmVjdG9yOworCWludCByZXQ7CisKKwlkcC0+ZHJtID0gZHJtOwor
CWRwLT5jb25maWcubWlzYzAgJj0gflpZTlFNUF9EUF9NQUlOX1NUUkVBTV9NSVNDMF9TWU5DX0xP
Q0s7CisJenlucW1wX2RwX3NldF9mb3JtYXQoZHAsIFpZTlFNUF9EUFNVQl9GT1JNQVRfUkdCLCA4
KTsKKworCS8qIENyZWF0ZSB0aGUgRFJNIGVuY29kZXIgYW5kIGNvbm5lY3Rvci4gKi8KKwllbmNv
ZGVyLT5wb3NzaWJsZV9jcnRjcyB8PSB6eW5xbXBfZGlzcF9nZXRfY3J0Y19tYXNrKGRwc3ViLT5k
aXNwKTsKKwlkcm1fZW5jb2Rlcl9pbml0KGRybSwgZW5jb2RlciwgJnp5bnFtcF9kcF9lbmNvZGVy
X2Z1bmNzLAorCQkJIERSTV9NT0RFX0VOQ09ERVJfVE1EUywgTlVMTCk7CisJZHJtX2VuY29kZXJf
aGVscGVyX2FkZChlbmNvZGVyLCAmenlucW1wX2RwX2VuY29kZXJfaGVscGVyX2Z1bmNzKTsKKwor
CWNvbm5lY3Rvci0+cG9sbGVkID0gRFJNX0NPTk5FQ1RPUl9QT0xMX0hQRDsKKwlyZXQgPSBkcm1f
Y29ubmVjdG9yX2luaXQoZW5jb2Rlci0+ZGV2LCBjb25uZWN0b3IsCisJCQkJICZ6eW5xbXBfZHBf
Y29ubmVjdG9yX2Z1bmNzLAorCQkJCSBEUk1fTU9ERV9DT05ORUNUT1JfRGlzcGxheVBvcnQpOwor
CWlmIChyZXQpIHsKKwkJZGV2X2VycihkcC0+ZGV2LCAiZmFpbGVkIHRvIGNyZWF0ZSB0aGUgRFJN
IGNvbm5lY3RvclxuIik7CisJCXJldHVybiByZXQ7CisJfQorCisJZHJtX2Nvbm5lY3Rvcl9oZWxw
ZXJfYWRkKGNvbm5lY3RvciwgJnp5bnFtcF9kcF9jb25uZWN0b3JfaGVscGVyX2Z1bmNzKTsKKwlk
cm1fY29ubmVjdG9yX3JlZ2lzdGVyKGNvbm5lY3Rvcik7CisJZHJtX2Nvbm5lY3Rvcl9hdHRhY2hf
ZW5jb2Rlcihjb25uZWN0b3IsIGVuY29kZXIpOworCisJLyogSW5pdGlhbGl6ZSBhbmQgcmVnaXN0
ZXIgdGhlIEFVWCBhZGFwdGVyLiAqLworCXJldCA9IHp5bnFtcF9kcF9hdXhfaW5pdChkcCk7CisJ
aWYgKHJldCkgeworCQlkZXZfZXJyKGRwLT5kZXYsICJmYWlsZWQgdG8gaW5pdGlhbGl6ZSBEUCBh
dXhcbiIpOworCQlyZXR1cm4gcmV0OworCX0KKworCS8qIE5vdyB0aGF0IGluaXRpYWxpc2F0aW9u
IGlzIGNvbXBsZXRlLCBlbmFibGUgaW50ZXJydXB0cy4gKi8KKwl6eW5xbXBfZHBfd3JpdGUoZHAs
IFpZTlFNUF9EUF9JTlRfRU4sIFpZTlFNUF9EUF9JTlRfQUxMKTsKKworCXJldHVybiAwOworfQor
Cit2b2lkIHp5bnFtcF9kcF9jbGVhbnVwKHN0cnVjdCB6eW5xbXBfZHBzdWIgKmRwc3ViKQorewor
CXN0cnVjdCB6eW5xbXBfZHAgKmRwID0gZHBzdWItPmRwOworCisJenlucW1wX2RwX3dyaXRlKGRw
LCBaWU5RTVBfRFBfSU5UX0RTLCBaWU5RTVBfRFBfSU5UX0FMTCk7CisJZGlzYWJsZV9pcnEoZHAt
PmlycSk7CisKKwljYW5jZWxfZGVsYXllZF93b3JrX3N5bmMoJmRwLT5ocGRfd29yayk7CisJenlu
cW1wX2RwX2F1eF9jbGVhbnVwKGRwKTsKK30KKworaW50IHp5bnFtcF9kcF9wcm9iZShzdHJ1Y3Qg
enlucW1wX2Rwc3ViICpkcHN1Yiwgc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKK3sKKwlz
dHJ1Y3QgenlucW1wX2RwICpkcDsKKwlzdHJ1Y3QgcmVzb3VyY2UgKnJlczsKKwlpbnQgcmV0Owor
CisJZHAgPSBkZXZtX2t6YWxsb2MoJnBkZXYtPmRldiwgc2l6ZW9mKCpkcCksIEdGUF9LRVJORUwp
OworCWlmICghZHApCisJCXJldHVybiAtRU5PTUVNOworCisJZHAtPmRldiA9ICZwZGV2LT5kZXY7
CisJZHAtPmRwc3ViID0gZHBzdWI7CisJZHAtPnN0YXR1cyA9IGNvbm5lY3Rvcl9zdGF0dXNfZGlz
Y29ubmVjdGVkOworCisJSU5JVF9ERUxBWUVEX1dPUksoJmRwLT5ocGRfd29yaywgenlucW1wX2Rw
X2hwZF93b3JrX2Z1bmMpOworCisJLyogQWNxdWlyZSBhbGwgcmVzb3VyY2VzIChJT01FTSwgSVJR
IGFuZCBQSFlzKS4gKi8KKwlyZXMgPSBwbGF0Zm9ybV9nZXRfcmVzb3VyY2VfYnluYW1lKHBkZXYs
IElPUkVTT1VSQ0VfTUVNLCAiZHAiKTsKKwlkcC0+aW9tZW0gPSBkZXZtX2lvcmVtYXBfcmVzb3Vy
Y2UoZHAtPmRldiwgcmVzKTsKKwlpZiAoSVNfRVJSKGRwLT5pb21lbSkpCisJCXJldHVybiBQVFJf
RVJSKGRwLT5pb21lbSk7CisKKwlkcC0+aXJxID0gcGxhdGZvcm1fZ2V0X2lycShwZGV2LCAwKTsK
KwlpZiAoZHAtPmlycSA8IDApCisJCXJldHVybiBkcC0+aXJxOworCisJcmV0ID0genlucW1wX2Rw
X3BoeV9wcm9iZShkcCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCS8qIEluaXRpYWxp
emUgdGhlIGhhcmR3YXJlLiAqLworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX1RYX1BI
WV9QT1dFUl9ET1dOLAorCQkJWllOUU1QX0RQX1RYX1BIWV9QT1dFUl9ET1dOX0FMTCk7CisJenlu
cW1wX2RwX3NldChkcCwgWllOUU1QX0RQX1BIWV9SRVNFVCwgWllOUU1QX0RQX1BIWV9SRVNFVF9B
TExfUkVTRVQpOworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX0ZPUkNFX1NDUkFNQkxF
Ul9SRVNFVCwgMSk7CisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfVFJBTlNNSVRURVJf
RU5BQkxFLCAwKTsKKwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9JTlRfRFMsIDB4ZmZm
ZmZmZmYpOworCisJcmV0ID0genlucW1wX2RwX3BoeV9pbml0KGRwKTsKKwlpZiAocmV0KQorCQly
ZXR1cm4gcmV0OworCisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfVFJBTlNNSVRURVJf
RU5BQkxFLCAxKTsKKworCS8qCisJICogTm93IHRoYXQgdGhlIGhhcmR3YXJlIGlzIGluaXRpYWxp
emVkIGFuZCB3b24ndCBnZW5lcmF0ZSBzcHVyaW91cworCSAqIGludGVycnVwdHMsIHJlcXVlc3Qg
dGhlIElSUS4KKwkgKi8KKwlyZXQgPSBkZXZtX3JlcXVlc3RfdGhyZWFkZWRfaXJxKGRwLT5kZXYs
IGRwLT5pcnEsIE5VTEwsCisJCQkJCXp5bnFtcF9kcF9pcnFfaGFuZGxlciwgSVJRRl9PTkVTSE9U
LAorCQkJCQlkZXZfbmFtZShkcC0+ZGV2KSwgZHApOworCWlmIChyZXQgPCAwKQorCQlnb3RvIGVy
cm9yX3BoeTsKKworCWRwc3ViLT5kcCA9IGRwOworCisJZGV2X2RiZyhkcC0+ZGV2LCAiWnlucU1Q
IERpc3BsYXlQb3J0IFR4IHByb2JlZCB3aXRoICV1IGxhbmVzXG4iLAorCQlkcC0+bnVtX2xhbmVz
KTsKKworCXJldHVybiAwOworCitlcnJvcl9waHk6CisJenlucW1wX2RwX3BoeV9leGl0KGRwKTsK
KwlyZXR1cm4gcmV0OworfQorCit2b2lkIHp5bnFtcF9kcF9yZW1vdmUoc3RydWN0IHp5bnFtcF9k
cHN1YiAqZHBzdWIpCit7CisJc3RydWN0IHp5bnFtcF9kcCAqZHAgPSBkcHN1Yi0+ZHA7CisKKwl6
eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9UUkFOU01JVFRFUl9FTkFCTEUsIDApOworCXp5
bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX0lOVF9EUywgMHhmZmZmZmZmZik7CisKKwl6eW5x
bXBfZHBfcGh5X2V4aXQoZHApOworCWRwc3ViLT5kcCA9IE5VTEw7Cit9CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZHAuaCBiL2RyaXZlcnMvZ3B1L2RybS94bG54L3p5
bnFtcF9kcC5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uNWU3NThk
MmI3NmIwCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rw
LmgKQEAgLTAsMCArMSwyOSBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAg
Ki8KKy8qCisgKiBaeW5xTVAgRGlzcGxheVBvcnQgRHJpdmVyCisgKgorICogQ29weXJpZ2h0IChD
KSAyMDE3IC0gMjAxOSBYaWxpbngsIEluYy4KKyAqCisgKiBBdXRob3JzOgorICogLSBIeXVuIFdv
byBLd29uIDxoeXVuLmt3b25AeGlsaW54LmNvbT4KKyAqIC0gTGF1cmVudCBQaW5jaGFydCA8bGF1
cmVudC5waW5jaGFydEBpZGVhc29uYm9hcmQuY29tPgorICovCisKKyNpZm5kZWYgX1pZTlFNUF9E
UF9IXworI2RlZmluZSBfWllOUU1QX0RQX0hfCisKK3N0cnVjdCBkcm1fZGV2aWNlOworc3RydWN0
IHBsYXRmb3JtX2RldmljZTsKK3N0cnVjdCB6eW5xbXBfZHA7CitzdHJ1Y3QgenlucW1wX2Rwc3Vi
OworCit2b2lkIHp5bnFtcF9kcF9lbmFibGVfdmJsYW5rKHN0cnVjdCB6eW5xbXBfZHAgKmRwKTsK
K3ZvaWQgenlucW1wX2RwX2Rpc2FibGVfdmJsYW5rKHN0cnVjdCB6eW5xbXBfZHAgKmRwKTsKKwor
aW50IHp5bnFtcF9kcF9pbml0KHN0cnVjdCB6eW5xbXBfZHBzdWIgKmRwc3ViLCBzdHJ1Y3QgZHJt
X2RldmljZSAqZHJtKTsKK3ZvaWQgenlucW1wX2RwX2NsZWFudXAoc3RydWN0IHp5bnFtcF9kcHN1
YiAqZHBzdWIpOworCitpbnQgenlucW1wX2RwX3Byb2JlKHN0cnVjdCB6eW5xbXBfZHBzdWIgKmRw
c3ViLCBzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KTsKK3ZvaWQgenlucW1wX2RwX3JlbW92
ZShzdHJ1Y3QgenlucW1wX2Rwc3ViICpkcHN1Yik7CisKKyNlbmRpZiAvKiBfWllOUU1QX0RQX0hf
ICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZHBzdWIuYyBiL2Ry
aXZlcnMvZ3B1L2RybS94bG54L3p5bnFtcF9kcHN1Yi5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0Cmlu
ZGV4IDAwMDAwMDAwMDAwMC4uZGNhNjNmN2ZjYjllCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL3hsbngvenlucW1wX2Rwc3ViLmMKQEAgLTAsMCArMSwzMzAgQEAKKy8vIFNQRFgt
TGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisvKgorICogWnlucU1QIERpc3BsYXlQb3J0IFN1
YnN5c3RlbSBEcml2ZXIKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMTcgLSAyMDE5IFhpbGlueCwg
SW5jLgorICoKKyAqIEF1dGhvcnM6CisgKiAtIEh5dW4gV29vIEt3b24gPGh5dW4ua3dvbkB4aWxp
bnguY29tPgorICogLSBMYXVyZW50IFBpbmNoYXJ0IDxsYXVyZW50LnBpbmNoYXJ0QGlkZWFzb25i
b2FyZC5jb20+CisgKi8KKworI2luY2x1ZGUgPGxpbnV4L2Nsay5oPgorI2luY2x1ZGUgPGxpbnV4
L2RtYS1tYXBwaW5nLmg+CisjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+CisjaW5jbHVkZSA8bGlu
dXgvb2ZfcmVzZXJ2ZWRfbWVtLmg+CisjaW5jbHVkZSA8bGludXgvcGxhdGZvcm1fZGV2aWNlLmg+
CisjaW5jbHVkZSA8bGludXgvcG1fcnVudGltZS5oPgorCisjaW5jbHVkZSA8ZHJtL2RybV9hdG9t
aWNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9kZXZpY2UuaD4KKyNpbmNsdWRlIDxkcm0v
ZHJtX2Rydi5oPgorI2luY2x1ZGUgPGRybS9kcm1fZmJfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJt
L2RybV9mb3VyY2MuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2dlbV9jbWFfaGVscGVyLmg+CisjaW5j
bHVkZSA8ZHJtL2RybV9nZW1fZnJhbWVidWZmZXJfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2Ry
bV9tb2RlX2NvbmZpZy5oPgorI2luY2x1ZGUgPGRybS9kcm1fcHJvYmVfaGVscGVyLmg+CisjaW5j
bHVkZSA8ZHJtL2RybV92YmxhbmsuaD4KKworI2luY2x1ZGUgInp5bnFtcF9kaXNwLmgiCisjaW5j
bHVkZSAienlucW1wX2RwLmgiCisjaW5jbHVkZSAienlucW1wX2Rwc3ViLmgiCisKKy8qIC0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tCisgKiBEdW1iIEJ1ZmZlciAmIEZyYW1lYnVmZmVyIEFsbG9jYXRpb24K
KyAqLworCitzdGF0aWMgaW50IHp5bnFtcF9kcHN1Yl9kdW1iX2NyZWF0ZShzdHJ1Y3QgZHJtX2Zp
bGUgKmZpbGVfcHJpdiwKKwkJCQkgICAgc3RydWN0IGRybV9kZXZpY2UgKmRybSwKKwkJCQkgICAg
c3RydWN0IGRybV9tb2RlX2NyZWF0ZV9kdW1iICphcmdzKQoreworCXN0cnVjdCB6eW5xbXBfZHBz
dWIgKmRwc3ViID0gZHJtLT5kZXZfcHJpdmF0ZTsKKwl1bnNpZ25lZCBpbnQgcGl0Y2ggPSBESVZf
Uk9VTkRfVVAoYXJncy0+d2lkdGggKiBhcmdzLT5icHAsIDgpOworCisJLyogRW5mb3JjZSB0aGUg
YWxpZ25tZW50IGNvbnN0cmFpbnRzIG9mIHRoZSBETUEgZW5naW5lLiAqLworCWFyZ3MtPnBpdGNo
ID0gQUxJR04ocGl0Y2gsIGRwc3ViLT5kbWFfYWxpZ24pOworCisJcmV0dXJuIGRybV9nZW1fY21h
X2R1bWJfY3JlYXRlX2ludGVybmFsKGZpbGVfcHJpdiwgZHJtLCBhcmdzKTsKK30KKworc3RhdGlj
IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKgorenlucW1wX2Rwc3ViX2ZiX2NyZWF0ZShzdHJ1Y3Qg
ZHJtX2RldmljZSAqZHJtLCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdiwKKwkJICAgICAgIGNv
bnN0IHN0cnVjdCBkcm1fbW9kZV9mYl9jbWQyICptb2RlX2NtZCkKK3sKKwlzdHJ1Y3QgenlucW1w
X2Rwc3ViICpkcHN1YiA9IGRybS0+ZGV2X3ByaXZhdGU7CisJc3RydWN0IGRybV9tb2RlX2ZiX2Nt
ZDIgY21kID0gKm1vZGVfY21kOworCXVuc2lnbmVkIGludCBpOworCisJLyogRW5mb3JjZSB0aGUg
YWxpZ25tZW50IGNvbnN0cmFpbnRzIG9mIHRoZSBETUEgZW5naW5lLiAqLworCWZvciAoaSA9IDA7
IGkgPCBBUlJBWV9TSVpFKGNtZC5waXRjaGVzKTsgKytpKQorCQljbWQucGl0Y2hlc1tpXSA9IEFM
SUdOKGNtZC5waXRjaGVzW2ldLCBkcHN1Yi0+ZG1hX2FsaWduKTsKKworCXJldHVybiBkcm1fZ2Vt
X2ZiX2NyZWF0ZShkcm0sIGZpbGVfcHJpdiwgJmNtZCk7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1
Y3QgZHJtX21vZGVfY29uZmlnX2Z1bmNzIHp5bnFtcF9kcHN1Yl9tb2RlX2NvbmZpZ19mdW5jcyA9
IHsKKwkuZmJfY3JlYXRlCQk9IHp5bnFtcF9kcHN1Yl9mYl9jcmVhdGUsCisJLmF0b21pY19jaGVj
awkJPSBkcm1fYXRvbWljX2hlbHBlcl9jaGVjaywKKwkuYXRvbWljX2NvbW1pdAkJPSBkcm1fYXRv
bWljX2hlbHBlcl9jb21taXQsCit9OworCisvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICogRFJN
L0tNUyBEcml2ZXIKKyAqLworCitERUZJTkVfRFJNX0dFTV9DTUFfRk9QUyh6eW5xbXBfZHBzdWJf
ZHJtX2ZvcHMpOworCitzdGF0aWMgc3RydWN0IGRybV9kcml2ZXIgenlucW1wX2Rwc3ViX2RybV9k
cml2ZXIgPSB7CisJLmRyaXZlcl9mZWF0dXJlcwkJPSBEUklWRVJfTU9ERVNFVCB8IERSSVZFUl9H
RU0gfAorCQkJCQkgIERSSVZFUl9BVE9NSUMsCisKKwkucHJpbWVfaGFuZGxlX3RvX2ZkCQk9IGRy
bV9nZW1fcHJpbWVfaGFuZGxlX3RvX2ZkLAorCS5wcmltZV9mZF90b19oYW5kbGUJCT0gZHJtX2dl
bV9wcmltZV9mZF90b19oYW5kbGUsCisJLmdlbV9wcmltZV9leHBvcnQJCT0gZHJtX2dlbV9wcmlt
ZV9leHBvcnQsCisJLmdlbV9wcmltZV9pbXBvcnQJCT0gZHJtX2dlbV9wcmltZV9pbXBvcnQsCisJ
LmdlbV9wcmltZV9nZXRfc2dfdGFibGUJCT0gZHJtX2dlbV9jbWFfcHJpbWVfZ2V0X3NnX3RhYmxl
LAorCS5nZW1fcHJpbWVfaW1wb3J0X3NnX3RhYmxlCT0gZHJtX2dlbV9jbWFfcHJpbWVfaW1wb3J0
X3NnX3RhYmxlLAorCS5nZW1fcHJpbWVfdm1hcAkJCT0gZHJtX2dlbV9jbWFfcHJpbWVfdm1hcCwK
KwkuZ2VtX3ByaW1lX3Z1bm1hcAkJPSBkcm1fZ2VtX2NtYV9wcmltZV92dW5tYXAsCisJLmdlbV9w
cmltZV9tbWFwCQkJPSBkcm1fZ2VtX2NtYV9wcmltZV9tbWFwLAorCS5nZW1fZnJlZV9vYmplY3Rf
dW5sb2NrZWQJPSBkcm1fZ2VtX2NtYV9mcmVlX29iamVjdCwKKwkuZ2VtX3ZtX29wcwkJCT0gJmRy
bV9nZW1fY21hX3ZtX29wcywKKwkuZHVtYl9jcmVhdGUJCQk9IHp5bnFtcF9kcHN1Yl9kdW1iX2Ny
ZWF0ZSwKKwkuZHVtYl9kZXN0cm95CQkJPSBkcm1fZ2VtX2R1bWJfZGVzdHJveSwKKworCS5mb3Bz
CQkJCT0gJnp5bnFtcF9kcHN1Yl9kcm1fZm9wcywKKworCS5uYW1lCQkJCT0gInp5bnFtcC1kcHN1
YiIsCisJLmRlc2MJCQkJPSAiWGlsaW54IERpc3BsYXlQb3J0IFN1YnN5c3RlbSBEcml2ZXIiLAor
CS5kYXRlCQkJCT0gIjIwMTMwNTA5IiwKKwkubWFqb3IJCQkJPSAxLAorCS5taW5vcgkJCQk9IDAs
Cit9OworCitzdGF0aWMgdm9pZCB6eW5xbXBfZHBzdWJfZHJtX2NsZWFudXAoc3RydWN0IHp5bnFt
cF9kcHN1YiAqZHBzdWIpCit7CisJc3RydWN0IGRybV9kZXZpY2UgKmRybSA9IGRwc3ViLT5kcm07
CisKKwlkcm1fZGV2X3VucmVnaXN0ZXIoZHJtKTsKKworCXp5bnFtcF9kcF9jbGVhbnVwKGRwc3Vi
KTsKKworCWRybV9rbXNfaGVscGVyX3BvbGxfZmluaShkcm0pOworCWRybV9tb2RlX2NvbmZpZ19j
bGVhbnVwKGRybSk7CisKKwlkcm1fZGV2X3B1dChkcm0pOworfQorCitzdGF0aWMgaW50IHp5bnFt
cF9kcHN1Yl9kcm1faW5pdChzdHJ1Y3QgenlucW1wX2Rwc3ViICpkcHN1YikKK3sKKwlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZHJtOworCWludCByZXQ7CisKKwlkcm0gPSBkcm1fZGV2X2FsbG9jKCZ6eW5x
bXBfZHBzdWJfZHJtX2RyaXZlciwgZHBzdWItPmRldik7CisJaWYgKElTX0VSUihkcm0pKQorCQly
ZXR1cm4gUFRSX0VSUihkcm0pOworCisJZHBzdWItPmRybSA9IGRybTsKKwlkcm0tPmRldl9wcml2
YXRlID0gZHBzdWI7CisKKwkvKiBJbml0aWFsaXplIG1vZGUgY29uZmlnLCB2YmxhbmsgYW5kIHRo
ZSBLTVMgcG9sbCBoZWxwZXIuICovCisJZHJtX21vZGVfY29uZmlnX2luaXQoZHJtKTsKKworCWRy
bS0+bW9kZV9jb25maWcuZnVuY3MgPSAmenlucW1wX2Rwc3ViX21vZGVfY29uZmlnX2Z1bmNzOwor
CWRybS0+bW9kZV9jb25maWcubWluX3dpZHRoID0gMDsKKwlkcm0tPm1vZGVfY29uZmlnLm1pbl9o
ZWlnaHQgPSAwOworCWRybS0+bW9kZV9jb25maWcubWF4X3dpZHRoID0gWllOUU1QX0RJU1BfTUFY
X1dJRFRIOworCWRybS0+bW9kZV9jb25maWcubWF4X2hlaWdodCA9IFpZTlFNUF9ESVNQX01BWF9I
RUlHSFQ7CisKKwlyZXQgPSBkcm1fdmJsYW5rX2luaXQoZHJtLCAxKTsKKwlpZiAocmV0KQorCQln
b3RvIGVycl9tb2RlX2NvbmZpZ19jbGVhbnVwOworCisJZHJtLT5pcnFfZW5hYmxlZCA9IDE7CisK
Kwlkcm1fa21zX2hlbHBlcl9wb2xsX2luaXQoZHJtKTsKKworCS8qCisJICogSW5pdGlhbGl6ZSB0
aGUgRElTUCBhbmQgRFAgY29tcG9uZW50cy4gVGhpcyB3aWxsIGNyZWF0ZXMgcGxhbmVzLAorCSAq
IENSVEMsIGVuY29kZXIgYW5kIGNvbm5lY3Rvci4gVGhlIERJU1Agc2hvdWxkIGJlIGluaXRpYWxp
emVkIGZpcnN0IGFzCisJICogdGhlIERQIGVuY29kZXIgbmVlZHMgdGhlIENSVEMuCisJICovCisJ
cmV0ID0genlucW1wX2Rpc3BfaW5pdChkcHN1YiwgZHJtKTsKKwlpZiAocmV0KQorCQlnb3RvIGVy
cl9wb2xsX2Zpbmk7CisKKwlyZXQgPSB6eW5xbXBfZHBfaW5pdChkcHN1YiwgZHJtKTsKKwlpZiAo
cmV0KQorCQlnb3RvIGVycl9wb2xsX2Zpbmk7CisKKwlkbWFfc2V0X21hc2soZHBzdWItPmRldiwg
RE1BX0JJVF9NQVNLKFpZTlFNUF9ESVNQX01BWF9ETUFfQklUKSk7CisKKwkvKiBSZXNldCBhbGwg
Y29tcG9uZW50cyBhbmQgcmVnaXN0ZXIgdGhlIERSTSBkZXZpY2UuICovCisJZHJtX21vZGVfY29u
ZmlnX3Jlc2V0KGRybSk7CisKKwlyZXQgPSBkcm1fZGV2X3JlZ2lzdGVyKGRybSwgMCk7CisJaWYg
KHJldCA8IDApCisJCWdvdG8gZXJyX2RwX2NsZWFudXA7CisKKwkvKgorCSAqIEluaXRpYWxpemUg
ZmJkZXYgZ2VuZXJpYyBlbXVsYXRpb24uIEZhaWx1cmVzIGFyZSBub3QgZmF0YWwgYXMgdGhlCisJ
ICogRFJNL0tNUyBkZXZpY2UgaXMgc3RpbGwgdXNhYmxlIHdpdGhvdXQgZW11bGF0aW9uIHN1cHBv
cnQuCisJICovCisJcmV0ID0gZHJtX2ZiZGV2X2dlbmVyaWNfc2V0dXAoZHJtLCAyNCk7CisJaWYg
KHJldCA8IDApCisJCWRldl9lcnIoZHBzdWItPmRldiwgIkZhaWxlZCB0byBpbml0aWFsaXplIGZi
ZGV2IGVtdWxhdGlvblxuIik7CisKKwlyZXR1cm4gMDsKKworZXJyX2RwX2NsZWFudXA6CisJenlu
cW1wX2RwX2NsZWFudXAoZHBzdWIpOworZXJyX3BvbGxfZmluaToKKwlkcm1fa21zX2hlbHBlcl9w
b2xsX2ZpbmkoZHJtKTsKK2Vycl9tb2RlX2NvbmZpZ19jbGVhbnVwOgorCWRybV9tb2RlX2NvbmZp
Z19jbGVhbnVwKGRybSk7CisJZHJtX2Rldl9wdXQoZHJtKTsKKwlyZXR1cm4gcmV0OworfQorCisv
KiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICogUG93ZXIgTWFuYWdlbWVudAorICovCisKK3N0YXRp
YyBpbnQgX19tYXliZV91bnVzZWQgenlucW1wX2Rwc3ViX3N1c3BlbmQoc3RydWN0IGRldmljZSAq
ZGV2KQoreworCXN0cnVjdCB6eW5xbXBfZHBzdWIgKmRwc3ViID0gZGV2X2dldF9kcnZkYXRhKGRl
dik7CisKKwlyZXR1cm4gZHJtX21vZGVfY29uZmlnX2hlbHBlcl9zdXNwZW5kKGRwc3ViLT5kcm0p
OworfQorCitzdGF0aWMgaW50IF9fbWF5YmVfdW51c2VkIHp5bnFtcF9kcHN1Yl9yZXN1bWUoc3Ry
dWN0IGRldmljZSAqZGV2KQoreworCXN0cnVjdCB6eW5xbXBfZHBzdWIgKmRwc3ViID0gZGV2X2dl
dF9kcnZkYXRhKGRldik7CisKKwlyZXR1cm4gZHJtX21vZGVfY29uZmlnX2hlbHBlcl9yZXN1bWUo
ZHBzdWItPmRybSk7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZGV2X3BtX29wcyB6eW5xbXBf
ZHBzdWJfcG1fb3BzID0geworCVNFVF9TWVNURU1fU0xFRVBfUE1fT1BTKHp5bnFtcF9kcHN1Yl9z
dXNwZW5kLCB6eW5xbXBfZHBzdWJfcmVzdW1lKQorfTsKKworLyogLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0KKyAqIFByb2JlICYgUmVtb3ZlCisgKi8KKworc3RhdGljIGludCB6eW5xbXBfZHBzdWJfaW5p
dF9jbG9ja3Moc3RydWN0IHp5bnFtcF9kcHN1YiAqZHBzdWIpCit7CisJaW50IHJldDsKKworCWRw
c3ViLT5hcGJfY2xrID0gZGV2bV9jbGtfZ2V0KGRwc3ViLT5kZXYsICJkcF9hcGJfY2xrIik7CisJ
aWYgKElTX0VSUihkcHN1Yi0+YXBiX2NsaykpCisJCXJldHVybiBQVFJfRVJSKGRwc3ViLT5hcGJf
Y2xrKTsKKworCXJldCA9IGNsa19wcmVwYXJlX2VuYWJsZShkcHN1Yi0+YXBiX2Nsayk7CisJaWYg
KHJldCkgeworCQlkZXZfZXJyKGRwc3ViLT5kZXYsICJmYWlsZWQgdG8gZW5hYmxlIHRoZSBBUEIg
Y2xvY2tcbiIpOworCQlyZXR1cm4gcmV0OworCX0KKworCXJldHVybiAwOworfQorCitzdGF0aWMg
aW50IHp5bnFtcF9kcHN1Yl9wcm9iZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQorewor
CXN0cnVjdCB6eW5xbXBfZHBzdWIgKmRwc3ViOworCWludCByZXQ7CisKKwlkcHN1YiA9IGRldm1f
a3phbGxvYygmcGRldi0+ZGV2LCBzaXplb2YoKmRwc3ViKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFk
cHN1YikKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlkcHN1Yi0+ZGV2ID0gJnBkZXYtPmRldjsKKwlw
bGF0Zm9ybV9zZXRfZHJ2ZGF0YShwZGV2LCBkcHN1Yik7CisKKwkvKiBUcnkgdGhlIHJlc2VydmVk
IG1lbW9yeS4gUHJvY2VlZCBpZiB0aGVyZSdzIG5vbmUuICovCisJb2ZfcmVzZXJ2ZWRfbWVtX2Rl
dmljZV9pbml0KCZwZGV2LT5kZXYpOworCisJcmV0ID0genlucW1wX2Rwc3ViX2luaXRfY2xvY2tz
KGRwc3ViKTsKKwlpZiAocmV0IDwgMCkKKwkJZ290byBlcnJfbWVtOworCisJcG1fcnVudGltZV9l
bmFibGUoJnBkZXYtPmRldik7CisKKwkvKgorCSAqIERQIHNob3VsZCBiZSBwcm9iZWQgZmlyc3Qg
c28gdGhhdCB0aGUgenlucW1wX2Rpc3AgY2FuIHNldCB0aGUgb3V0cHV0CisJICogZm9ybWF0IGFj
Y29yZGluZ2x5LgorCSAqLworCXJldCA9IHp5bnFtcF9kcF9wcm9iZShkcHN1YiwgcGRldik7CisJ
aWYgKHJldCkKKwkJZ290byBlcnJfcG07CisKKwlyZXQgPSB6eW5xbXBfZGlzcF9wcm9iZShkcHN1
YiwgcGRldik7CisJaWYgKHJldCkKKwkJZ290byBlcnJfZHA7CisKKwlyZXQgPSB6eW5xbXBfZHBz
dWJfZHJtX2luaXQoZHBzdWIpOworCWlmIChyZXQpCisJCWdvdG8gZXJyX2Rpc3A7CisKKwlkZXZf
aW5mbygmcGRldi0+ZGV2LCAiWnlucU1QIERpc3BsYXlQb3J0IFN1YnN5c3RlbSBkcml2ZXIgcHJv
YmVkIik7CisKKwlyZXR1cm4gMDsKKworZXJyX2Rpc3A6CisJenlucW1wX2Rpc3BfcmVtb3ZlKGRw
c3ViKTsKK2Vycl9kcDoKKwl6eW5xbXBfZHBfcmVtb3ZlKGRwc3ViKTsKK2Vycl9wbToKKwlwbV9y
dW50aW1lX2Rpc2FibGUoJnBkZXYtPmRldik7CisJY2xrX2Rpc2FibGVfdW5wcmVwYXJlKGRwc3Vi
LT5hcGJfY2xrKTsKK2Vycl9tZW06CisJb2ZfcmVzZXJ2ZWRfbWVtX2RldmljZV9yZWxlYXNlKCZw
ZGV2LT5kZXYpOworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgenlucW1wX2Rwc3ViX3Jl
bW92ZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQoreworCXN0cnVjdCB6eW5xbXBfZHBz
dWIgKmRwc3ViID0gcGxhdGZvcm1fZ2V0X2RydmRhdGEocGRldik7CisKKwl6eW5xbXBfZHBzdWJf
ZHJtX2NsZWFudXAoZHBzdWIpOworCisJenlucW1wX2Rpc3BfcmVtb3ZlKGRwc3ViKTsKKwl6eW5x
bXBfZHBfcmVtb3ZlKGRwc3ViKTsKKworCXBtX3J1bnRpbWVfZGlzYWJsZSgmcGRldi0+ZGV2KTsK
KwljbGtfZGlzYWJsZV91bnByZXBhcmUoZHBzdWItPmFwYl9jbGspOworCW9mX3Jlc2VydmVkX21l
bV9kZXZpY2VfcmVsZWFzZSgmcGRldi0+ZGV2KTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMg
dm9pZCB6eW5xbXBfZHBzdWJfc2h1dGRvd24oc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikK
K3sKKwlzdHJ1Y3QgenlucW1wX2Rwc3ViICpkcHN1YiA9IHBsYXRmb3JtX2dldF9kcnZkYXRhKHBk
ZXYpOworCisJZHJtX2F0b21pY19oZWxwZXJfc2h1dGRvd24oZHBzdWItPmRybSk7Cit9CisKK3N0
YXRpYyBjb25zdCBzdHJ1Y3Qgb2ZfZGV2aWNlX2lkIHp5bnFtcF9kcHN1Yl9vZl9tYXRjaFtdID0g
eworCXsgLmNvbXBhdGlibGUgPSAieGxueCx6eW5xbXAtZHBzdWItMS43IiwgfSwKKwl7IC8qIGVu
ZCBvZiB0YWJsZSAqLyB9LAorfTsKK01PRFVMRV9ERVZJQ0VfVEFCTEUob2YsIHp5bnFtcF9kcHN1
Yl9vZl9tYXRjaCk7CisKK3N0YXRpYyBzdHJ1Y3QgcGxhdGZvcm1fZHJpdmVyIHp5bnFtcF9kcHN1
Yl9kcml2ZXIgPSB7CisJLnByb2JlCQkJPSB6eW5xbXBfZHBzdWJfcHJvYmUsCisJLnJlbW92ZQkJ
CT0genlucW1wX2Rwc3ViX3JlbW92ZSwKKwkuc2h1dGRvd24JCT0genlucW1wX2Rwc3ViX3NodXRk
b3duLAorCS5kcml2ZXIJCQk9IHsKKwkJLm5hbWUJCT0gInp5bnFtcC1kaXNwbGF5IiwKKwkJLnBt
CQk9ICZ6eW5xbXBfZHBzdWJfcG1fb3BzLAorCQkub2ZfbWF0Y2hfdGFibGUJPSB6eW5xbXBfZHBz
dWJfb2ZfbWF0Y2gsCisJfSwKK307CisKK21vZHVsZV9wbGF0Zm9ybV9kcml2ZXIoenlucW1wX2Rw
c3ViX2RyaXZlcik7CisKK01PRFVMRV9BVVRIT1IoIlhpbGlueCwgSW5jLiIpOworTU9EVUxFX0RF
U0NSSVBUSU9OKCJaeW5xTVAgRFAgU3Vic3lzdGVtIERyaXZlciIpOworTU9EVUxFX0xJQ0VOU0Uo
IkdQTCB2MiIpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rwc3Vi
LmggYi9kcml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZHBzdWIuaApuZXcgZmlsZSBtb2RlIDEw
MDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjczMmYyOWJkYThkNAotLS0gL2Rldi9udWxsCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS94bG54L3p5bnFtcF9kcHN1Yi5oCkBAIC0wLDAgKzEsNDkgQEAKKy8q
IFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovCisvKgorICogWnlucU1QIERQU1VC
IFN1YnN5c3RlbSBEcml2ZXIKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMTcgLSAyMDE5IFhpbGlu
eCwgSW5jLgorICoKKyAqIEF1dGhvcnM6CisgKiAtIEh5dW4gV29vIEt3b24gPGh5dW4ua3dvbkB4
aWxpbnguY29tPgorICogLSBMYXVyZW50IFBpbmNoYXJ0IDxsYXVyZW50LnBpbmNoYXJ0QGlkZWFz
b25ib2FyZC5jb20+CisgKi8KKworI2lmbmRlZiBfWllOUU1QX0RQU1VCX0hfCisjZGVmaW5lIF9a
WU5RTVBfRFBTVUJfSF8KKworc3RydWN0IGNsazsKK3N0cnVjdCBkZXZpY2U7CitzdHJ1Y3QgZHJt
X2RldmljZTsKK3N0cnVjdCB6eW5xbXBfZGlzcDsKK3N0cnVjdCB6eW5xbXBfZHA7CisKK2VudW0g
enlucW1wX2Rwc3ViX2Zvcm1hdCB7CisJWllOUU1QX0RQU1VCX0ZPUk1BVF9SR0IsCisJWllOUU1Q
X0RQU1VCX0ZPUk1BVF9ZQ1JDQjQ0NCwKKwlaWU5RTVBfRFBTVUJfRk9STUFUX1lDUkNCNDIyLAor
CVpZTlFNUF9EUFNVQl9GT1JNQVRfWU9OTFksCit9OworCisvKioKKyAqIHN0cnVjdCB6eW5xbXBf
ZHBzdWIgLSBaeW5xTVAgRGlzcGxheVBvcnQgU3Vic3lzdGVtCisgKiBAZHJtOiBUaGUgRFJNL0tN
UyBkZXZpY2UKKyAqIEBkZXY6IFRoZSBwaHlzaWNhbCBkZXZpY2UKKyAqIEBhcGJfY2xrOiBUaGUg
QVBCIGNsb2NrCisgKiBAZGlzcDogVGhlIGRpc3BsYXkgY29udHJvbGxlcgorICogQGRwOiBUaGUg
RGlzcGxheVBvcnQgY29udHJvbGxlcgorICogQGRtYV9hbGlnbjogRE1BIGFsaWdubWVudCBjb25z
dHJhaW50IChtdXN0IGJlIGEgcG93ZXIgb2YgMikKKyAqLworc3RydWN0IHp5bnFtcF9kcHN1YiB7
CisJc3RydWN0IGRybV9kZXZpY2UgKmRybTsKKwlzdHJ1Y3QgZGV2aWNlICpkZXY7CisKKwlzdHJ1
Y3QgY2xrICphcGJfY2xrOworCisJc3RydWN0IHp5bnFtcF9kaXNwICpkaXNwOworCXN0cnVjdCB6
eW5xbXBfZHAgKmRwOworCisJdW5zaWduZWQgaW50IGRtYV9hbGlnbjsKK307CisKKyNlbmRpZiAv
KiBfWllOUU1QX0RQU1VCX0hfICovCi0tIApSZWdhcmRzLAoKTGF1cmVudCBQaW5jaGFydAoKX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1h
aWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
