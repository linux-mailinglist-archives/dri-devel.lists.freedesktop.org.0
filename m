Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1827FBBA85
	for <lists+dri-devel@lfdr.de>; Mon, 23 Sep 2019 19:28:34 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 22C906E981;
	Mon, 23 Sep 2019 17:28:31 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1605F6E986
 for <dri-devel@lists.freedesktop.org>; Mon, 23 Sep 2019 17:28:04 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id A10FBB64F;
 Mon, 23 Sep 2019 17:28:00 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: airlied@linux.ie, daniel@ffwll.ch, kraxel@redhat.com, sam@ravnborg.org,
 yc_chen@aspeedtech.com, corbet@lwn.net
Subject: [PATCH v2 09/12] drm/mgag200: Move cursor-image update to
 mgag200_show_cursor()
Date: Mon, 23 Sep 2019 19:27:50 +0200
Message-Id: <20190923172753.26593-10-tzimmermann@suse.de>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190923172753.26593-1-tzimmermann@suse.de>
References: <20190923172753.26593-1-tzimmermann@suse.de>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Zimmermann <tzimmermann@suse.de>, dri-devel@lists.freedesktop.org,
 linux-doc@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

U2VwYXJhdGluZyB0aGUgbWFuYWdlbWVudCBvZiBidWZmZXIgb2JqZWN0cyBmcm9tIHVwZGF0aW5n
IHRoZSBoYXJkd2FyZQpjdXJzb3IgYnVmZmVyIGdpdmVzIHRoZSBjb2RlIG1vcmUgc3RydWN0dXJl
LiBXaGlsZSBkb2luZyB0aGlzLCB3ZSBjYW4KZnVydGhlciBzcGxpdCB0aGUgaW1hZ2UtdXBkYXRl
IGNvZGUgaW50byBjb2RlIGZvciB3cml0aW5nIHRoZSBidWZmZXIsCnNldHRpbmcgdGhlIGJhc2Ug
c2Nhbi1vdXQgYWRkcmVzcywgYW5kIGVuYWJsaW5nIHRoZSBjdXJzb3IuIFRoZSBmaXJzdAp0d28g
b3BlcmF0aW9ucyBhcmUgaW4gZGVkaWNhdGVkIGZ1bmN0aW9ucyB1cGRhdGUoKSBhbmQgc2V0X2Jh
c2UoKS4KClNpZ25lZC1vZmYtYnk6IFRob21hcyBaaW1tZXJtYW5uIDx0emltbWVybWFubkBzdXNl
LmRlPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9tZ2FnMjAwL21nYWcyMDBfY3Vyc29yLmMgfCAyMjEg
KysrKysrKysrKysrKy0tLS0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCAxMjYgaW5zZXJ0aW9ucygr
KSwgOTUgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21nYWcyMDAv
bWdhZzIwMF9jdXJzb3IuYyBiL2RyaXZlcnMvZ3B1L2RybS9tZ2FnMjAwL21nYWcyMDBfY3Vyc29y
LmMKaW5kZXggNjIxOTYwNzIzYTNhLi4xM2RhYTBjZTFjOWUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9tZ2FnMjAwL21nYWcyMDBfY3Vyc29yLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL21n
YWcyMDAvbWdhZzIwMF9jdXJzb3IuYwpAQCAtMTIsNiArMTIsMTI4IEBACiBzdGF0aWMgYm9vbCB3
YXJuX3RyYW5zcGFyZW50ID0gdHJ1ZTsKIHN0YXRpYyBib29sIHdhcm5fcGFsZXR0ZSA9IHRydWU7
CiAKK3N0YXRpYyBpbnQgbWdhZzIwMF9jdXJzb3JfdXBkYXRlKHN0cnVjdCBtZ2FfZGV2aWNlICpt
ZGV2LCB2b2lkICpkc3QsIHZvaWQgKnNyYywKKwkJCQkgdW5zaWduZWQgaW50IHdpZHRoLCB1bnNp
Z25lZCBpbnQgaGVpZ2h0KQoreworCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBtZGV2LT5kZXY7
CisJdW5zaWduZWQgaW50IGksIHJvdywgY29sOworCXVpbnQzMl90IGNvbG91cl9zZXRbMTZdOwor
CXVpbnQzMl90ICpuZXh0X3NwYWNlID0gJmNvbG91cl9zZXRbMF07CisJdWludDMyX3QgKnBhbGV0
dGVfaXRlcjsKKwl1aW50MzJfdCB0aGlzX2NvbG91cjsKKwlib29sIGZvdW5kID0gZmFsc2U7CisJ
aW50IGNvbG91cl9jb3VudCA9IDA7CisJdTggcmVnX2luZGV4OworCXU4IHRoaXNfcm93WzQ4XTsK
KworCW1lbXNldCgmY29sb3VyX3NldFswXSwgMCwgc2l6ZW9mKHVpbnQzMl90KSoxNik7CisJLyog
d2lkdGgqaGVpZ2h0KjQgPSAxNjM4NCAqLworCWZvciAoaSA9IDA7IGkgPCAxNjM4NDsgaSArPSA0
KSB7CisJCXRoaXNfY29sb3VyID0gaW9yZWFkMzIoc3JjICsgaSk7CisJCS8qIE5vIHRyYW5zcGFy
ZW5jeSAqLworCQlpZiAodGhpc19jb2xvdXI+PjI0ICE9IDB4ZmYgJiYKKwkJCXRoaXNfY29sb3Vy
Pj4yNCAhPSAweDApIHsKKwkJCWlmICh3YXJuX3RyYW5zcGFyZW50KSB7CisJCQkJZGV2X2luZm8o
JmRldi0+cGRldi0+ZGV2LCAiVmlkZW8gY2FyZCBkb2Vzbid0IHN1cHBvcnQgY3Vyc29ycyB3aXRo
IHBhcnRpYWwgdHJhbnNwYXJlbmN5LlxuIik7CisJCQkJZGV2X2luZm8oJmRldi0+cGRldi0+ZGV2
LCAiTm90IGVuYWJsaW5nIGhhcmR3YXJlIGN1cnNvci5cbiIpOworCQkJCXdhcm5fdHJhbnNwYXJl
bnQgPSBmYWxzZTsgLyogT25seSB0ZWxsIHRoZSB1c2VyIG9uY2UuICovCisJCQl9CisJCQlyZXR1
cm4gLUVJTlZBTDsKKwkJfQorCQkvKiBEb24ndCBuZWVkIHRvIHN0b3JlIHRyYW5zcGFyZW50IHBp
eGVscyBhcyBjb2xvdXJzICovCisJCWlmICh0aGlzX2NvbG91cj4+MjQgPT0gMHgwKQorCQkJY29u
dGludWU7CisJCWZvdW5kID0gZmFsc2U7CisJCWZvciAocGFsZXR0ZV9pdGVyID0gJmNvbG91cl9z
ZXRbMF07IHBhbGV0dGVfaXRlciAhPSBuZXh0X3NwYWNlOyBwYWxldHRlX2l0ZXIrKykgeworCQkJ
aWYgKCpwYWxldHRlX2l0ZXIgPT0gdGhpc19jb2xvdXIpIHsKKwkJCQlmb3VuZCA9IHRydWU7CisJ
CQkJYnJlYWs7CisJCQl9CisJCX0KKwkJaWYgKGZvdW5kKQorCQkJY29udGludWU7CisJCS8qIFdl
IG9ubHkgc3VwcG9ydCA0Yml0IHBhbGV0dGVkIGN1cnNvcnMgKi8KKwkJaWYgKGNvbG91cl9jb3Vu
dCA+PSAxNikgeworCQkJaWYgKHdhcm5fcGFsZXR0ZSkgeworCQkJCWRldl9pbmZvKCZkZXYtPnBk
ZXYtPmRldiwgIlZpZGVvIGNhcmQgb25seSBzdXBwb3J0cyBjdXJzb3JzIHdpdGggdXAgdG8gMTYg
Y29sb3Vycy5cbiIpOworCQkJCWRldl9pbmZvKCZkZXYtPnBkZXYtPmRldiwgIk5vdCBlbmFibGlu
ZyBoYXJkd2FyZSBjdXJzb3IuXG4iKTsKKwkJCQl3YXJuX3BhbGV0dGUgPSBmYWxzZTsgLyogT25s
eSB0ZWxsIHRoZSB1c2VyIG9uY2UuICovCisJCQl9CisJCQlyZXR1cm4gLUVJTlZBTDsKKwkJfQor
CQkqbmV4dF9zcGFjZSA9IHRoaXNfY29sb3VyOworCQluZXh0X3NwYWNlKys7CisJCWNvbG91cl9j
b3VudCsrOworCX0KKworCS8qIFByb2dyYW0gY29sb3VycyBmcm9tIGN1cnNvciBpY29uIGludG8g
cGFsZXR0ZSAqLworCWZvciAoaSA9IDA7IGkgPCBjb2xvdXJfY291bnQ7IGkrKykgeworCQlpZiAo
aSA8PSAyKQorCQkJcmVnX2luZGV4ID0gMHg4ICsgaSoweDQ7CisJCWVsc2UKKwkJCXJlZ19pbmRl
eCA9IDB4NjAgKyBpKjB4MzsKKwkJV1JFR19EQUMocmVnX2luZGV4LCBjb2xvdXJfc2V0W2ldICYg
MHhmZik7CisJCVdSRUdfREFDKHJlZ19pbmRleCsxLCBjb2xvdXJfc2V0W2ldPj44ICYgMHhmZik7
CisJCVdSRUdfREFDKHJlZ19pbmRleCsyLCBjb2xvdXJfc2V0W2ldPj4xNiAmIDB4ZmYpOworCQlp
ZiAoV0FSTl9PTigoY29sb3VyX3NldFtpXT4+MjQgJiAweGZmKSAhPSAweGZmKSkKKwkJCXJldHVy
biAtRUlOVkFMOworCX0KKworCS8qIG5vdyB3cml0ZSBjb2xvdXIgaW5kaWNlcyBpbnRvIGhhcmR3
YXJlIGN1cnNvciBidWZmZXIgKi8KKwlmb3IgKHJvdyA9IDA7IHJvdyA8IDY0OyByb3crKykgewor
CQltZW1zZXQoJnRoaXNfcm93WzBdLCAwLCA0OCk7CisJCWZvciAoY29sID0gMDsgY29sIDwgNjQ7
IGNvbCsrKSB7CisJCQl0aGlzX2NvbG91ciA9IGlvcmVhZDMyKHNyYyArIDQqKGNvbCArIDY0KnJv
dykpOworCQkJLyogd3JpdGUgdHJhbnNwYXJlbnQgcGl4ZWxzICovCisJCQlpZiAodGhpc19jb2xv
dXI+PjI0ID09IDB4MCkgeworCQkJCXRoaXNfcm93WzQ3IC0gY29sLzhdIHw9IDB4ODA+Pihjb2wl
OCk7CisJCQkJY29udGludWU7CisJCQl9CisKKwkJCS8qIHdyaXRlIGNvbG91ciBpbmRleCBoZXJl
ICovCisJCQlmb3IgKGkgPSAwOyBpIDwgY29sb3VyX2NvdW50OyBpKyspIHsKKwkJCQlpZiAoY29s
b3VyX3NldFtpXSA9PSB0aGlzX2NvbG91cikgeworCQkJCQlpZiAoY29sICUgMikKKwkJCQkJCXRo
aXNfcm93W2NvbC8yXSB8PSBpPDw0OworCQkJCQllbHNlCisJCQkJCQl0aGlzX3Jvd1tjb2wvMl0g
fD0gaTsKKwkJCQkJYnJlYWs7CisJCQkJfQorCQkJfQorCQl9CisJCW1lbWNweV90b2lvKGRzdCAr
IHJvdyo0OCwgJnRoaXNfcm93WzBdLCA0OCk7CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3N0YXRp
YyB2b2lkIG1nYWcyMDBfY3Vyc29yX3NldF9iYXNlKHN0cnVjdCBtZ2FfZGV2aWNlICptZGV2LCB1
NjQgYWRkcmVzcykKK3sKKwl1OCBhZGRybCA9IChhZGRyZXNzID4+IDEwKSAmIDB4ZmY7CisJdTgg
YWRkcmggPSAoYWRkcmVzcyA+PiAxOCkgJiAweDNmOworCisJLyogUHJvZ3JhbSBncHUgYWRkcmVz
cyBvZiBjdXJzb3IgYnVmZmVyICovCisJV1JFR19EQUMoTUdBMTA2NF9DVVJTT1JfQkFTRV9BRFJf
TE9XLCBhZGRybCk7CisJV1JFR19EQUMoTUdBMTA2NF9DVVJTT1JfQkFTRV9BRFJfSEksIGFkZHJo
KTsKK30KKworc3RhdGljIGludCBtZ2FnMjAwX3Nob3dfY3Vyc29yKHN0cnVjdCBtZ2FfZGV2aWNl
ICptZGV2LCB2b2lkICpkc3QsIHZvaWQgKnNyYywKKwkJCSAgICAgICB1bnNpZ25lZCBpbnQgd2lk
dGgsIHVuc2lnbmVkIGludCBoZWlnaHQsCisJCQkgICAgICAgdTY0IGRzdF9ncHUpCit7CisJaW50
IHJldDsKKworCXJldCA9IG1nYWcyMDBfY3Vyc29yX3VwZGF0ZShtZGV2LCBkc3QsIHNyYywgd2lk
dGgsIGhlaWdodCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKwltZ2FnMjAwX2N1cnNvcl9z
ZXRfYmFzZShtZGV2LCBkc3RfZ3B1KTsKKworCS8qIEFkanVzdCBjdXJzb3IgY29udHJvbCByZWdp
c3RlciB0byB0dXJuIG9uIHRoZSBjdXJzb3IgKi8KKwlXUkVHX0RBQyhNR0ExMDY0X0NVUlNPUl9D
VEwsIDQpOyAvKiAxNi1jb2xvdXIgcGFsbGV0aXplZCBjdXJzb3IgbW9kZSAqLworCisJcmV0dXJu
IDA7Cit9CisKIC8qCiAgKiBIaWRlIHRoZSBjdXJzb3Igb2ZmIHNjcmVlbi4gV2UgY2FuJ3QgZGlz
YWJsZSB0aGUgY3Vyc29yIGhhcmR3YXJlIGJlY2F1c2UKICAqIGl0IHRha2VzIHRvbyBsb25nIHRv
IHJlLWFjdGl2YXRlIGFuZCBjYXVzZXMgbW9tZW50YXJ5IGNvcnJ1cHRpb24uCkBAIC04MiwxOSAr
MjA0LDEwIEBAIGludCBtZ2FnMjAwX2NydGNfY3Vyc29yX3NldChzdHJ1Y3QgZHJtX2NydGMgKmNy
dGMsIHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wcml2LAogCXN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2Jq
ZWN0ICpwaXhlbHNfbmV4dDsKIAlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iajsKIAlzdHJ1Y3Qg
ZHJtX2dlbV92cmFtX29iamVjdCAqZ2JvID0gTlVMTDsKLQlpbnQgcmV0ID0gMDsKKwlpbnQgcmV0
OwogCXU4ICpzcmMsICpkc3Q7Ci0JdW5zaWduZWQgaW50IGksIHJvdywgY29sOwotCXVpbnQzMl90
IGNvbG91cl9zZXRbMTZdOwotCXVpbnQzMl90ICpuZXh0X3NwYWNlID0gJmNvbG91cl9zZXRbMF07
Ci0JdWludDMyX3QgKnBhbGV0dGVfaXRlcjsKLQl1aW50MzJfdCB0aGlzX2NvbG91cjsKLQlib29s
IGZvdW5kID0gZmFsc2U7Ci0JaW50IGNvbG91cl9jb3VudCA9IDA7CiAJczY0IGdwdV9hZGRyOwog
CXU2NCBkc3RfZ3B1OwotCXU4IHJlZ19pbmRleDsKLQl1OCB0aGlzX3Jvd1s0OF07CiAKIAlpZiAo
IXBpeGVsc18xIHx8ICFwaXhlbHNfMikgewogCQlXUkVHOChNR0FfQ1VSUE9TWEwsIDApOwpAQCAt
MTU5LDkxICsyNzIsOSBAQCBpbnQgbWdhZzIwMF9jcnRjX2N1cnNvcl9zZXQoc3RydWN0IGRybV9j
cnRjICpjcnRjLCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdiwKIAl9CiAJZHN0X2dwdSA9ICh1
NjQpZ3B1X2FkZHI7CiAKLQltZW1zZXQoJmNvbG91cl9zZXRbMF0sIDAsIHNpemVvZih1aW50MzJf
dCkqMTYpOwotCS8qIHdpZHRoKmhlaWdodCo0ID0gMTYzODQgKi8KLQlmb3IgKGkgPSAwOyBpIDwg
MTYzODQ7IGkgKz0gNCkgewotCQl0aGlzX2NvbG91ciA9IGlvcmVhZDMyKHNyYyArIGkpOwotCQkv
KiBObyB0cmFuc3BhcmVuY3kgKi8KLQkJaWYgKHRoaXNfY29sb3VyPj4yNCAhPSAweGZmICYmCi0J
CQl0aGlzX2NvbG91cj4+MjQgIT0gMHgwKSB7Ci0JCQlpZiAod2Fybl90cmFuc3BhcmVudCkgewot
CQkJCWRldl9pbmZvKCZkZXYtPnBkZXYtPmRldiwgIlZpZGVvIGNhcmQgZG9lc24ndCBzdXBwb3J0
IGN1cnNvcnMgd2l0aCBwYXJ0aWFsIHRyYW5zcGFyZW5jeS5cbiIpOwotCQkJCWRldl9pbmZvKCZk
ZXYtPnBkZXYtPmRldiwgIk5vdCBlbmFibGluZyBoYXJkd2FyZSBjdXJzb3IuXG4iKTsKLQkJCQl3
YXJuX3RyYW5zcGFyZW50ID0gZmFsc2U7IC8qIE9ubHkgdGVsbCB0aGUgdXNlciBvbmNlLiAqLwot
CQkJfQotCQkJcmV0ID0gLUVJTlZBTDsKLQkJCWdvdG8gZXJyX2RybV9nZW1fdnJhbV9rdW5tYXBf
ZHN0OwotCQl9Ci0JCS8qIERvbid0IG5lZWQgdG8gc3RvcmUgdHJhbnNwYXJlbnQgcGl4ZWxzIGFz
IGNvbG91cnMgKi8KLQkJaWYgKHRoaXNfY29sb3VyPj4yNCA9PSAweDApCi0JCQljb250aW51ZTsK
LQkJZm91bmQgPSBmYWxzZTsKLQkJZm9yIChwYWxldHRlX2l0ZXIgPSAmY29sb3VyX3NldFswXTsg
cGFsZXR0ZV9pdGVyICE9IG5leHRfc3BhY2U7IHBhbGV0dGVfaXRlcisrKSB7Ci0JCQlpZiAoKnBh
bGV0dGVfaXRlciA9PSB0aGlzX2NvbG91cikgewotCQkJCWZvdW5kID0gdHJ1ZTsKLQkJCQlicmVh
azsKLQkJCX0KLQkJfQotCQlpZiAoZm91bmQpCi0JCQljb250aW51ZTsKLQkJLyogV2Ugb25seSBz
dXBwb3J0IDRiaXQgcGFsZXR0ZWQgY3Vyc29ycyAqLwotCQlpZiAoY29sb3VyX2NvdW50ID49IDE2
KSB7Ci0JCQlpZiAod2Fybl9wYWxldHRlKSB7Ci0JCQkJZGV2X2luZm8oJmRldi0+cGRldi0+ZGV2
LCAiVmlkZW8gY2FyZCBvbmx5IHN1cHBvcnRzIGN1cnNvcnMgd2l0aCB1cCB0byAxNiBjb2xvdXJz
LlxuIik7Ci0JCQkJZGV2X2luZm8oJmRldi0+cGRldi0+ZGV2LCAiTm90IGVuYWJsaW5nIGhhcmR3
YXJlIGN1cnNvci5cbiIpOwotCQkJCXdhcm5fcGFsZXR0ZSA9IGZhbHNlOyAvKiBPbmx5IHRlbGwg
dGhlIHVzZXIgb25jZS4gKi8KLQkJCX0KLQkJCXJldCA9IC1FSU5WQUw7Ci0JCQlnb3RvIGVycl9k
cm1fZ2VtX3ZyYW1fa3VubWFwX2RzdDsKLQkJfQotCQkqbmV4dF9zcGFjZSA9IHRoaXNfY29sb3Vy
OwotCQluZXh0X3NwYWNlKys7Ci0JCWNvbG91cl9jb3VudCsrOwotCX0KLQotCS8qIFByb2dyYW0g
Y29sb3VycyBmcm9tIGN1cnNvciBpY29uIGludG8gcGFsZXR0ZSAqLwotCWZvciAoaSA9IDA7IGkg
PCBjb2xvdXJfY291bnQ7IGkrKykgewotCQlpZiAoaSA8PSAyKQotCQkJcmVnX2luZGV4ID0gMHg4
ICsgaSoweDQ7Ci0JCWVsc2UKLQkJCXJlZ19pbmRleCA9IDB4NjAgKyBpKjB4MzsKLQkJV1JFR19E
QUMocmVnX2luZGV4LCBjb2xvdXJfc2V0W2ldICYgMHhmZik7Ci0JCVdSRUdfREFDKHJlZ19pbmRl
eCsxLCBjb2xvdXJfc2V0W2ldPj44ICYgMHhmZik7Ci0JCVdSRUdfREFDKHJlZ19pbmRleCsyLCBj
b2xvdXJfc2V0W2ldPj4xNiAmIDB4ZmYpOwotCQlCVUdfT04oKGNvbG91cl9zZXRbaV0+PjI0ICYg
MHhmZikgIT0gMHhmZik7Ci0JfQotCi0JLyogbm93IHdyaXRlIGNvbG91ciBpbmRpY2VzIGludG8g
aGFyZHdhcmUgY3Vyc29yIGJ1ZmZlciAqLwotCWZvciAocm93ID0gMDsgcm93IDwgNjQ7IHJvdysr
KSB7Ci0JCW1lbXNldCgmdGhpc19yb3dbMF0sIDAsIDQ4KTsKLQkJZm9yIChjb2wgPSAwOyBjb2wg
PCA2NDsgY29sKyspIHsKLQkJCXRoaXNfY29sb3VyID0gaW9yZWFkMzIoc3JjICsgNCooY29sICsg
NjQqcm93KSk7Ci0JCQkvKiB3cml0ZSB0cmFuc3BhcmVudCBwaXhlbHMgKi8KLQkJCWlmICh0aGlz
X2NvbG91cj4+MjQgPT0gMHgwKSB7Ci0JCQkJdGhpc19yb3dbNDcgLSBjb2wvOF0gfD0gMHg4MD4+
KGNvbCU4KTsKLQkJCQljb250aW51ZTsKLQkJCX0KLQotCQkJLyogd3JpdGUgY29sb3VyIGluZGV4
IGhlcmUgKi8KLQkJCWZvciAoaSA9IDA7IGkgPCBjb2xvdXJfY291bnQ7IGkrKykgewotCQkJCWlm
IChjb2xvdXJfc2V0W2ldID09IHRoaXNfY29sb3VyKSB7Ci0JCQkJCWlmIChjb2wgJSAyKQotCQkJ
CQkJdGhpc19yb3dbY29sLzJdIHw9IGk8PDQ7Ci0JCQkJCWVsc2UKLQkJCQkJCXRoaXNfcm93W2Nv
bC8yXSB8PSBpOwotCQkJCQlicmVhazsKLQkJCQl9Ci0JCQl9Ci0JCX0KLQkJbWVtY3B5X3RvaW8o
ZHN0ICsgcm93KjQ4LCAmdGhpc19yb3dbMF0sIDQ4KTsKLQl9Ci0KLQkvKiBQcm9ncmFtIGdwdSBh
ZGRyZXNzIG9mIGN1cnNvciBidWZmZXIgKi8KLQlXUkVHX0RBQyhNR0ExMDY0X0NVUlNPUl9CQVNF
X0FEUl9MT1csICh1OCkoKGRzdF9ncHU+PjEwKSAmIDB4ZmYpKTsKLQlXUkVHX0RBQyhNR0ExMDY0
X0NVUlNPUl9CQVNFX0FEUl9ISSwgKHU4KSgoZHN0X2dwdT4+MTgpICYgMHgzZikpOwotCi0JLyog
QWRqdXN0IGN1cnNvciBjb250cm9sIHJlZ2lzdGVyIHRvIHR1cm4gb24gdGhlIGN1cnNvciAqLwot
CVdSRUdfREFDKE1HQTEwNjRfQ1VSU09SX0NUTCwgNCk7IC8qIDE2LWNvbG91ciBwYWxsZXRpemVk
IGN1cnNvciBtb2RlICovCisJcmV0ID0gbWdhZzIwMF9zaG93X2N1cnNvcihtZGV2LCBkc3QsIHNy
Yywgd2lkdGgsIGhlaWdodCwgZHN0X2dwdSk7CisJaWYgKHJldCkKKwkJZ290byBlcnJfZHJtX2dl
bV92cmFtX2t1bm1hcF9kc3Q7CiAKIAkvKiBOb3cgdXBkYXRlIGludGVybmFsIGJ1ZmZlciBwb2lu
dGVycyAqLwogCWlmIChwaXhlbHNfY3VycmVudCkKLS0gCjIuMjMuMAoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApk
cmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Au
b3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
