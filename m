Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 7ADD14B2CC
	for <lists+dri-devel@lfdr.de>; Wed, 19 Jun 2019 09:11:55 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 618246E2DD;
	Wed, 19 Jun 2019 07:11:38 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from onstation.org (onstation.org [52.200.56.107])
 by gabe.freedesktop.org (Postfix) with ESMTPS id CECED6E284;
 Wed, 19 Jun 2019 02:32:15 +0000 (UTC)
Received: from localhost.localdomain (c-98-239-145-235.hsd1.wv.comcast.net
 [98.239.145.235])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested) (Authenticated sender: masneyb)
 by onstation.org (Postfix) with ESMTPSA id C9FD13E9FC;
 Wed, 19 Jun 2019 02:32:14 +0000 (UTC)
From: Brian Masney <masneyb@onstation.org>
To: bjorn.andersson@linaro.org, agross@kernel.org, david.brown@linaro.org,
 robdclark@gmail.com, sean@poorly.run, robh+dt@kernel.org
Subject: [PATCH v2 5/6] soc: qcom: add OCMEM driver
Date: Tue, 18 Jun 2019 22:32:08 -0400
Message-Id: <20190619023209.10036-6-masneyb@onstation.org>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190619023209.10036-1-masneyb@onstation.org>
References: <20190619023209.10036-1-masneyb@onstation.org>
MIME-Version: 1.0
X-Mailman-Approved-At: Wed, 19 Jun 2019 07:10:14 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=onstation.org; s=default; t=1560911535;
 bh=b+YnQQltB5+ZdvU2V51UvFdemgx052LhvqnDqZpurw0=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=UQq04MbIXbWxmpLyVzh+omfEzaNQ4F2jzsgvE5qFKVM/JMXwRqZBNIRivn5Qhrndc
 x/6Zh6liO8epaDOG6383Smgb6rmA5rweDWowWq3u/GaoRqWar9q8siij83bB7vm83x
 FFhOxDmlIkA9UoOfVH5TziB3AofMdjbGj4CzT688=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: mark.rutland@arm.com, devicetree@vger.kernel.org, jonathan@marek.ca,
 airlied@linux.ie, linux-arm-msm@vger.kernel.org, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, freedreno@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIE9DTUVNIGRyaXZlciBoYW5kbGVzIGFsbG9jYXRpb24gYW5kIGNvbmZpZ3VyYXRpb24gb2Yg
dGhlIE9uIENoaXAKTUVNb3J5IHRoYXQgaXMgcHJlc2VudCBvbiBzb21lIFNuYXBkcmFnb24gU29D
cy4KCkRldmljZXMgd2hpY2ggaGF2ZSBPQ01FTSBkbyBub3QgaGF2ZSBHTUVNIGluc2lkZSB0aGUg
R1BVIGNvcmUsIHNvIHRoZQpHUFUgbXVzdCBpbnN0ZWFkIHVzZSBPQ01FTSB0byBiZSBmdW5jdGlv
bmFsLiBTaW5jZSBjdXJyZW50bHkgdGhlIEdQVQppcyB0aGUgb25seSBPQ01FTSB1c2VyIHdpdGgg
YW4gdXBzdHJlYW0gZHJpdmVyLCB0aGlzIGlzIGp1c3QgYSBtaW5pbWFsCmltcGxlbWVudGF0aW9u
IHN1ZmZpY2llbnQgZm9yIHN0YXRpY2FsbHkgYWxsb2NhdGluZyB0byB0aGUgR1BVIGl0J3MKY2h1
bmsgb2YgT0NNRU0uCgpTaWduZWQtb2ZmLWJ5OiBCcmlhbiBNYXNuZXkgPG1hc25leWJAb25zdGF0
aW9uLm9yZz4KQ28tZGV2ZWxvcGVkLWJ5OiBSb2IgQ2xhcmsgPHJvYmRjbGFya0BnbWFpbC5jb20+
ClNpZ25lZC1vZmYtYnk6IFJvYiBDbGFyayA8cm9iZGNsYXJrQGdtYWlsLmNvbT4KLS0tClBheSBh
dHRlbnRpb24gdG8gcWNvbV9zY21fcmVzdG9yZV9zZWNfY2ZnKCkgaW4gdGhlIHByb2JlIGZ1bmN0
aW9uLApzcGVjaWZpY2FsbHkgdGhlIDAgYXMgdGhlIHRoaXJkIHBhcmFtdGVyLiBJJ20gaG9uZXN0
bHkgbm90IHN1cmUgd2hhdAp0byBwdXQgaGVyZS4gSW4gdGhlIHByZXZpb3VzIHZlcnNpb24sIHRo
aXMgZnVuY3Rpb24gd291bGQgc2V0IHRoZSBpZAphbmQgY3R4X2JhbmtfbnVtIHRvIHRoZSBkZXZp
Y2VfaWQuIFRoZSBHUFUgd29ya3MgZWl0aGVyIHdheS4gSSBjb3VsZG4ndApmaW5kIHRoaXMgaW4g
dGhlIGRvd25zdHJlYW0gTVNNIGtlcm5lbCBzb3VyY2VzLgoKQ2hhbmdlcyBzaW5jZSB2MToKLSBv
Y21lbV9hbGxvY2F0ZSgpOiBjaGVjayBmb3IgYWxpZ25tZW50IGFuZCBtaW5pbXVtIGFsbG9jYXRp
b24gc2l6ZS4KICBUaGUgNjRLIHZhbHVlcyBjYW1lIGZyb20gdGhlIGRvd25zdHJlYW0gTVNNIGtl
cm5lbCBzb3VyY2VzLgotIGFkZCBsb2NraW5nIHRvIG1lbW9yeSBhbGxvY2F0aW9ucyBiYXNlZCBv
biB0aGUgY2xpZW50Ci0gdXNlIGNsa19idWxrXyooKSBmdW5jdGlvbnMKLSByZW5hbWUgcWNvbSxv
Y21lbS1tc204OTc0IHRvIHFjb20sbXNtODk3NC1vY21lbQotIHJlbmFtZSByZWctbmFtZXMgdG8g
Y3RybCBhbmQgbWVtCi0gcmVtb3ZlIG9jbWVtLnhtbC5oIGZpbGU7IHVzZSBGSUVMRF9QUkVQKCkg
aW5zdGVhZCBmb3Igc29tZSBuaWNlIGNsZWFudXBzCi0gYWRkIHN0YXRpYyBpbmxpbmUgbm9vcCB2
ZXJzaW9ucyBvZiBwdWJsaWMtZmFjaW5nIGZ1bmN0aW9ucyB3aGVuIG9jbWVtCiAgaXMgZGlzYWJs
ZWQgdG8gcmVtb3ZlICNpZmRlZnMgaW4gYWRyZW51X2dwdS5jCi0gdXNlIHVuc2lnbmVkIGxvbmcg
Zm9yIG1lbW9yeSBhZGRyZXNzZXMKLSBtb3ZlIG9jbWVtX2Rldl9yZW1vdmUoKSBiZWxvdyBfcHJv
YmUoKSBmdW5jdGlvbgotIHJlbW92ZSBlcnJvciBjaGVjayBmcm9tIHBsYXRmb3JtX2dldF9yZXNv
dXJjZV9ieW5hbWUgZm9yIGN0cmwgcmVzb3VyY2UKLSBhZGQgTU9EVUxFX0RFU0NSSVBUSU9OKCkg
YW5kIE1PRFVMRV9MSUNFTlNFKCkKLSBhZGQgZGVzY3JpcHRpb24gdG8gdG9wIG9mIG9jbWVtLltj
aF0KLSBjb3JyZWN0IHRoaW4gbW9kZSBiaXQgaW4gdXBkYXRlX29jbWVtKCkKLSBhZGQgJ1dBUk5f
T04oY2xpZW50ICE9IE9DTUVNX0dSQVBISUNTKScgdG8gZGV2aWNlX2FkZHJlc3MoKQotIG1ha2Ug
b2ZfZ2V0X29jbWVtIHJldHVybiBlcnJvciBjb2RlcyB2aWEgRVJSX1BUUiBpbnN0ZWFkIG9mIE5V
TEwKLSBvY21lbV97YWxsb2NhdGUsZnJlZX0gLSBXQVJOX09OKCkgaWYgY2xpZW50ICE9IE9DTUVN
X0dSQVBISUNTLgogIFNpbXBsaWZ5IGlmIHN0YXRlbWVudHMuCi0gYWxsb3cgTlVMTCB0byBiZSBw
YXNzZWQgaW50byBvY21lbV9mcmVlCi0gcmVtb3ZlIHVubmVjZXNzYXJ5IGluaXRpYWxpemF0aW9u
IG9mIGkgaW4gdXBkYXRlX29jbWVtKCkKLSBhZGQgZGV2X2RiZyB0byBvY21lbV9hbGxvY2F0ZQoK
Q2hhbmdlcyBzaW5jZSBSb2IncyBsYXN0IHZlcnNpb24gb2YgdGhpcyBwYXRjaCBmcm9tIDIwMTU6
Cmh0dHBzOi8vcGF0Y2h3b3JrLmtlcm5lbC5vcmcvcGF0Y2gvNzM3OTgwMS8KLSByZWZvcm1hdHRl
ZCBkcml2ZXIgdG8gYWxsb3cgbXVsdGlwbGUgaW5zdGFuY2VzCi0gdXBkYXRlZCBsb2dnaW5nIG9m
IGVycm9yIHBhdGhzIGR1cmluZyBkZXZpY2UgcHJvYmluZwotIHJlbW92ZSB1bnVzZWQgcHNnc2Nf
Y3RybAotIHJlbW92ZSBfY2xrIGZyb20gY2xvY2sgbmFtZXMKLSBwcm9wYWdhdGUgZXJyb3IgY29k
ZSBmcm9tIGRldm1faW9yZW1hcF9yZXNvdXJjZSgpCi0gdXNlIGRldmljZV9nZXRfbWF0Y2hfZGF0
YSgpCi0gU1BEWCBsaWNlbnNlIHRhZ3MKLSByZW1vdmUgUUNPTV9TTUQgaW4gS2NvbmZpZwotIHNl
bGVjdCBBUkNIX1FDT00gaW4gS2NvbmZpZwotIHNlbGVjdCBBUkNIX1FDT00gaW4gS2NvbmZpZwot
IHNlbGVjdCBRQ09NX1NDTSBpbiBLY29uZmlnCi0gbG9uZ2VyIGRlc2NyaXB0aW9uIGluIEtjb25m
aWcKCiBkcml2ZXJzL3NvYy9xY29tL0tjb25maWcgIHwgIDEwICsKIGRyaXZlcnMvc29jL3Fjb20v
TWFrZWZpbGUgfCAgIDEgKwogZHJpdmVycy9zb2MvcWNvbS9vY21lbS5jICB8IDQzMyArKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKwogaW5jbHVkZS9zb2MvcWNvbS9vY21lbS5o
ICB8ICA2MiArKysrKysKIDQgZmlsZXMgY2hhbmdlZCwgNTA2IGluc2VydGlvbnMoKykKIGNyZWF0
ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL3NvYy9xY29tL29jbWVtLmMKIGNyZWF0ZSBtb2RlIDEwMDY0
NCBpbmNsdWRlL3NvYy9xY29tL29jbWVtLmgKCmRpZmYgLS1naXQgYS9kcml2ZXJzL3NvYy9xY29t
L0tjb25maWcgYi9kcml2ZXJzL3NvYy9xY29tL0tjb25maWcKaW5kZXggYTZkMWJmYjE3Mjc5Li5k
MThlYjgzYjEwZGEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc29jL3Fjb20vS2NvbmZpZworKysgYi9k
cml2ZXJzL3NvYy9xY29tL0tjb25maWcKQEAgLTc0LDYgKzc0LDE2IEBAIGNvbmZpZyBRQ09NX01E
VF9MT0FERVIKIAl0cmlzdGF0ZQogCXNlbGVjdCBRQ09NX1NDTQogCitjb25maWcgUUNPTV9PQ01F
TQorCXRyaXN0YXRlICJRdWFsY29tbSBPbiBDaGlwIE1lbW9yeSAoT0NNRU0pIGRyaXZlciIKKwlk
ZXBlbmRzIG9uIEFSQ0hfUUNPTQorCXNlbGVjdCBRQ09NX1NDTQorCWhlbHAKKyAgICAgICAgICBU
aGUgT24gQ2hpcCBNZW1vcnkgKE9DTUVNKSBhbGxvY2F0b3IgYWxsb3dzIHZhcmlvdXMgY2xpZW50
cyB0bworICAgICAgICAgIGFsbG9jYXRlIG1lbW9yeSBmcm9tIE9DTUVNIGJhc2VkIG9uIHBlcmZv
cm1hbmNlLCBsYXRlbmN5IGFuZCBwb3dlcgorICAgICAgICAgIHJlcXVpcmVtZW50cy4gVGhpcyBp
cyB0eXBpY2FsbHkgdXNlZCBieSB0aGUgR1BVLCBjYW1lcmEvdmlkZW8sIGFuZAorICAgICAgICAg
IGF1ZGlvIGNvbXBvbmVudHMgb24gc29tZSBTbmFwZHJhZ29uIFNvQ3MuCisKIGNvbmZpZyBRQ09N
X1BNCiAJYm9vbCAiUXVhbGNvbW0gUG93ZXIgTWFuYWdlbWVudCIKIAlkZXBlbmRzIG9uIEFSQ0hf
UUNPTSAmJiAhQVJNNjQKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc29jL3Fjb20vTWFrZWZpbGUgYi9k
cml2ZXJzL3NvYy9xY29tL01ha2VmaWxlCmluZGV4IGVlYjA4OGJlYjE1Zi4uZGZjMzc4MDE0YTMz
IDEwMDY0NAotLS0gYS9kcml2ZXJzL3NvYy9xY29tL01ha2VmaWxlCisrKyBiL2RyaXZlcnMvc29j
L3Fjb20vTWFrZWZpbGUKQEAgLTYsNiArNiw3IEBAIG9iai0kKENPTkZJR19RQ09NX0NPTU1BTkRf
REIpICs9IGNtZC1kYi5vCiBvYmotJChDT05GSUdfUUNPTV9HTElOS19TU1IpICs9CWdsaW5rX3Nz
ci5vCiBvYmotJChDT05GSUdfUUNPTV9HU0JJKQkrPQlxY29tX2dzYmkubwogb2JqLSQoQ09ORklH
X1FDT01fTURUX0xPQURFUikJKz0gbWR0X2xvYWRlci5vCitvYmotJChDT05GSUdfUUNPTV9PQ01F
TSkJKz0gb2NtZW0ubwogb2JqLSQoQ09ORklHX1FDT01fUE0pCSs9CXNwbS5vCiBvYmotJChDT05G
SUdfUUNPTV9RTUlfSEVMUEVSUykJKz0gcW1pX2hlbHBlcnMubwogcW1pX2hlbHBlcnMteQkrPSBx
bWlfZW5jZGVjLm8gcW1pX2ludGVyZmFjZS5vCmRpZmYgLS1naXQgYS9kcml2ZXJzL3NvYy9xY29t
L29jbWVtLmMgYi9kcml2ZXJzL3NvYy9xY29tL29jbWVtLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQK
aW5kZXggMDAwMDAwMDAwMDAwLi45MTI1NmUxNjBiOWIKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2
ZXJzL3NvYy9xY29tL29jbWVtLmMKQEAgLTAsMCArMSw0MzMgQEAKKy8vIFNQRFgtTGljZW5zZS1J
ZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkKKy8qCisgKiBUaGUgT24gQ2hpcCBNZW1vcnkgKE9DTUVN
KSBhbGxvY2F0b3IgYWxsb3dzIHZhcmlvdXMgY2xpZW50cyB0byBhbGxvY2F0ZQorICogbWVtb3J5
IGZyb20gT0NNRU0gYmFzZWQgb24gcGVyZm9ybWFuY2UsIGxhdGVuY3kgYW5kIHBvd2VyIHJlcXVp
cmVtZW50cy4KKyAqIFRoaXMgaXMgdHlwaWNhbGx5IHVzZWQgYnkgdGhlIEdQVSwgY2FtZXJhL3Zp
ZGVvLCBhbmQgYXVkaW8gY29tcG9uZW50cyBvbgorICogc29tZSBTbmFwZHJhZ29uIFNvQ3MuCisg
KgorICogQ29weXJpZ2h0IChDKSAyMDE5IEJyaWFuIE1hc25leSA8bWFzbmV5YkBvbnN0YXRpb24u
b3JnPgorICogQ29weXJpZ2h0IChDKSAyMDE1IFJlZCBIYXQuIEF1dGhvcjogUm9iIENsYXJrIDxy
b2JkY2xhcmtAZ21haWwuY29tPgorICovCisKKyNpbmNsdWRlIDxsaW51eC9iaXRmaWVsZC5oPgor
I2luY2x1ZGUgPGxpbnV4L2Nsay5oPgorI2luY2x1ZGUgPGxpbnV4L2lvLmg+CisjaW5jbHVkZSA8
bGludXgva2VybmVsLmg+CisjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+CisjaW5jbHVkZSA8bGlu
dXgvb2ZfZGV2aWNlLmg+CisjaW5jbHVkZSA8bGludXgvcGxhdGZvcm1fZGV2aWNlLmg+CisjaW5j
bHVkZSA8bGludXgvcWNvbV9zY20uaD4KKyNpbmNsdWRlIDxsaW51eC9zaXplcy5oPgorI2luY2x1
ZGUgPGxpbnV4L3NsYWIuaD4KKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgorI2luY2x1ZGUgPHNv
Yy9xY29tL29jbWVtLmg+CisKK2VudW0gcmVnaW9uX21vZGUgeworCVdJREVfTU9ERSA9IDB4MCwK
KwlUSElOX01PREUsCisJTU9ERV9ERUZBVUxUID0gV0lERV9NT0RFLAorfTsKKworZW51bSBvY21l
bV9tYWNyb19zdGF0ZSB7CisJUEFTU1RIUk9VR0ggPSAwLAorCVBFUklfT04gPSAxLAorCUNPUkVf
T04gPSAyLAorCUNMS19PRkYgPSA0LAorfTsKKworc3RydWN0IG9jbWVtX3JlZ2lvbiB7CisJYm9v
bCBpbnRlcmxlYXZlZDsKKwllbnVtIHJlZ2lvbl9tb2RlIG1vZGU7CisJdW5zaWduZWQgaW50IG51
bV9tYWNyb3M7CisJZW51bSBvY21lbV9tYWNyb19zdGF0ZSBtYWNyb19zdGF0ZVs0XTsKKwl1bnNp
Z25lZCBsb25nIG1hY3JvX3NpemU7CisJdW5zaWduZWQgbG9uZyByZWdpb25fc2l6ZTsKK307CisK
K3N0cnVjdCBvY21lbV9jb25maWcgeworCXVpbnQ4X3QgbnVtX3JlZ2lvbnM7CisJdW5zaWduZWQg
bG9uZyBtYWNyb19zaXplOworfTsKKworc3RydWN0IG9jbWVtIHsKKwlzdHJ1Y3QgZGV2aWNlICpk
ZXY7CisJY29uc3Qgc3RydWN0IG9jbWVtX2NvbmZpZyAqY29uZmlnOworCXN0cnVjdCByZXNvdXJj
ZSAqbWVtb3J5OworCXZvaWQgX19pb21lbSAqbW1pbzsKKwl1bnNpZ25lZCBpbnQgbnVtX3BvcnRz
OworCXVuc2lnbmVkIGludCBudW1fbWFjcm9zOworCWJvb2wgaW50ZXJsZWF2ZWQ7CisJc3RydWN0
IG9jbWVtX3JlZ2lvbiAqcmVnaW9uczsKKwl1bnNpZ25lZCBsb25nIGFjdGl2ZV9hbGxvY2F0aW9u
czsKK307CisKKyNkZWZpbmUgT0NNRU1fTUlOX0FMSUdOCQkJCVNaXzY0SworI2RlZmluZSBPQ01F
TV9NSU5fQUxMT0MJCQkJU1pfNjRLCisKKyNkZWZpbmUgT0NNRU1fUkVHX0hXX1ZFUlNJT04JCQkw
eDAwMDAwMDAwCisjZGVmaW5lIE9DTUVNX1JFR19IV19QUk9GSUxFCQkJMHgwMDAwMDAwNAorCisj
ZGVmaW5lIE9DTUVNX1JFR19SRUdJT05fTU9ERV9DVEwJCTB4MDAwMDEwMDAKKyNkZWZpbmUgT0NN
RU1fUkVHSU9OX01PREVfQ1RMX1JFRzBfVEhJTgkJMHgwMDAwMDAwMQorI2RlZmluZSBPQ01FTV9S
RUdJT05fTU9ERV9DVExfUkVHMV9USElOCQkweDAwMDAwMDAyCisjZGVmaW5lIE9DTUVNX1JFR0lP
Tl9NT0RFX0NUTF9SRUcyX1RISU4JCTB4MDAwMDAwMDQKKyNkZWZpbmUgT0NNRU1fUkVHSU9OX01P
REVfQ1RMX1JFRzNfVEhJTgkJMHgwMDAwMDAwOAorCisjZGVmaW5lIE9DTUVNX1JFR19HRlhfTVBV
X1NUQVJUCQkJMHgwMDAwMTAwNAorI2RlZmluZSBPQ01FTV9SRUdfR0ZYX01QVV9FTkQJCQkweDAw
MDAxMDA4CisKKyNkZWZpbmUgT0NNRU1fSFdfUFJPRklMRV9OVU1fUE9SVFModmFsKQkJRklFTERf
UFJFUCgweDAwMDAwMDBmLCAodmFsKSkKKyNkZWZpbmUgT0NNRU1fSFdfUFJPRklMRV9OVU1fTUFD
Uk9TKHZhbCkJRklFTERfUFJFUCgweDAwMDAzZjAwLCAodmFsKSkKKworI2RlZmluZSBPQ01FTV9I
V19QUk9GSUxFX0xBU1RfUkVHTl9IQUxGU0laRQkweDAwMDEwMDAwCisjZGVmaW5lIE9DTUVNX0hX
X1BST0ZJTEVfSU5URVJMRUFWSU5HCQkweDAwMDIwMDAwCisjZGVmaW5lIE9DTUVNX1JFR19HRU5f
U1RBVFVTCQkJMHgwMDAwMDAwYworCisjZGVmaW5lIE9DTUVNX1JFR19QU0dTQ19TVEFUVVMJCQkw
eDAwMDAwMDM4CisjZGVmaW5lIE9DTUVNX1JFR19QU0dTQ19DVEwoaTApCQkJKDB4MDAwMDAwM2Mg
KyAweDEqKGkwKSkKKworI2RlZmluZSBPQ01FTV9QU0dTQ19DVExfTUFDUk8wX01PREUodmFsKQlG
SUVMRF9QUkVQKDB4MDAwMDAwMDcsICh2YWwpKQorI2RlZmluZSBPQ01FTV9QU0dTQ19DVExfTUFD
Uk8xX01PREUodmFsKQlGSUVMRF9QUkVQKDB4MDAwMDAwNzAsICh2YWwpKQorI2RlZmluZSBPQ01F
TV9QU0dTQ19DVExfTUFDUk8yX01PREUodmFsKQlGSUVMRF9QUkVQKDB4MDAwMDA3MDAsICh2YWwp
KQorI2RlZmluZSBPQ01FTV9QU0dTQ19DVExfTUFDUk8zX01PREUodmFsKQlGSUVMRF9QUkVQKDB4
MDAwMDcwMDAsICh2YWwpKQorCisjZGVmaW5lIE9DTUVNX0NMS19DT1JFX0lEWAkJCTAKK3N0YXRp
YyBzdHJ1Y3QgY2xrX2J1bGtfZGF0YSBvY21lbV9jbGtzW10gPSB7CisJeworCQkuaWQgPSAiY29y
ZSIsCisJfSwKKwl7CisJCS5pZCA9ICJpZmFjZSIsCisJfSwKK307CisKK3N0YXRpYyBpbmxpbmUg
dm9pZCBvY21lbV93cml0ZShzdHJ1Y3Qgb2NtZW0gKm9jbWVtLCB1MzIgcmVnLCB1MzIgZGF0YSkK
K3sKKwl3cml0ZWwoZGF0YSwgb2NtZW0tPm1taW8gKyByZWcpOworfQorCitzdGF0aWMgaW5saW5l
IHUzMiBvY21lbV9yZWFkKHN0cnVjdCBvY21lbSAqb2NtZW0sIHUzMiByZWcpCit7CisJcmV0dXJu
IHJlYWRsKG9jbWVtLT5tbWlvICsgcmVnKTsKK30KKworc3RhdGljIHZvaWQgdXBkYXRlX29jbWVt
KHN0cnVjdCBvY21lbSAqb2NtZW0pCit7CisJdWludDMyX3QgcmVnaW9uX21vZGVfY3RybCA9IDB4
MDsKKwlpbnQgaTsKKworCWlmICghcWNvbV9zY21fb2NtZW1fbG9ja19hdmFpbGFibGUoKSkgewor
CQlmb3IgKGkgPSAwOyBpIDwgb2NtZW0tPmNvbmZpZy0+bnVtX3JlZ2lvbnM7IGkrKykgeworCQkJ
c3RydWN0IG9jbWVtX3JlZ2lvbiAqcmVnaW9uID0gJm9jbWVtLT5yZWdpb25zW2ldOworCisJCQlp
ZiAocmVnaW9uLT5tb2RlID09IFRISU5fTU9ERSkKKwkJCQlyZWdpb25fbW9kZV9jdHJsIHw9IEJJ
VChpKTsKKwkJfQorCisJCWRldl9kYmcob2NtZW0tPmRldiwgIm9jbWVtX3JlZ2lvbl9tb2RlX2Nv
bnRyb2wgJXhcbiIsCisJCQlyZWdpb25fbW9kZV9jdHJsKTsKKwkJb2NtZW1fd3JpdGUob2NtZW0s
IE9DTUVNX1JFR19SRUdJT05fTU9ERV9DVEwsIHJlZ2lvbl9tb2RlX2N0cmwpOworCX0KKworCWZv
ciAoaSA9IDA7IGkgPCBvY21lbS0+Y29uZmlnLT5udW1fcmVnaW9uczsgaSsrKSB7CisJCXN0cnVj
dCBvY21lbV9yZWdpb24gKnJlZ2lvbiA9ICZvY21lbS0+cmVnaW9uc1tpXTsKKwkJdTMyIGRhdGE7
CisKKwkJZGF0YSA9IE9DTUVNX1BTR1NDX0NUTF9NQUNSTzBfTU9ERShyZWdpb24tPm1hY3JvX3N0
YXRlWzBdKSB8CisJCQlPQ01FTV9QU0dTQ19DVExfTUFDUk8xX01PREUocmVnaW9uLT5tYWNyb19z
dGF0ZVsxXSkgfAorCQkJT0NNRU1fUFNHU0NfQ1RMX01BQ1JPMl9NT0RFKHJlZ2lvbi0+bWFjcm9f
c3RhdGVbMl0pIHwKKwkJCU9DTUVNX1BTR1NDX0NUTF9NQUNSTzNfTU9ERShyZWdpb24tPm1hY3Jv
X3N0YXRlWzNdKTsKKworCQlvY21lbV93cml0ZShvY21lbSwgT0NNRU1fUkVHX1BTR1NDX0NUTChp
KSwgZGF0YSk7CisJfQorfQorCitzdGF0aWMgdW5zaWduZWQgbG9uZyBwaHlzX3RvX29mZnNldChz
dHJ1Y3Qgb2NtZW0gKm9jbWVtLAorCQkJCSAgICB1bnNpZ25lZCBsb25nIGFkZHIpCit7CisJaWYg
KGFkZHIgPCBvY21lbS0+bWVtb3J5LT5zdGFydCB8fCBhZGRyID49IG9jbWVtLT5tZW1vcnktPmVu
ZCkKKwkJcmV0dXJuIDA7CisKKwlyZXR1cm4gYWRkciAtIG9jbWVtLT5tZW1vcnktPnN0YXJ0Owor
fQorCitzdGF0aWMgdW5zaWduZWQgbG9uZyBkZXZpY2VfYWRkcmVzcyhzdHJ1Y3Qgb2NtZW0gKm9j
bWVtLAorCQkJCSAgICBlbnVtIG9jbWVtX2NsaWVudCBjbGllbnQsCisJCQkJICAgIHVuc2lnbmVk
IGxvbmcgYWRkcikKK3sKKwlXQVJOX09OKGNsaWVudCAhPSBPQ01FTV9HUkFQSElDUyk7CisKKwkv
KiBUT0RPOiBncHUgdXNlcyBwaHlzX3RvX29mZnNldCwgYnV0IG90aGVycyBkbyBub3QuLiAqLwor
CXJldHVybiBwaHlzX3RvX29mZnNldChvY21lbSwgYWRkcik7Cit9CisKK3N0YXRpYyB2b2lkIHVw
ZGF0ZV9yYW5nZShzdHJ1Y3Qgb2NtZW0gKm9jbWVtLCBzdHJ1Y3Qgb2NtZW1fYnVmICpidWYsCisJ
CQkgZW51bSBvY21lbV9tYWNyb19zdGF0ZSBtc3RhdGUsIGVudW0gcmVnaW9uX21vZGUgcm1vZGUp
Cit7CisJdW5zaWduZWQgbG9uZyBvZmZzZXQgPSAwOworCWludCBpLCBqOworCisJZm9yIChpID0g
MDsgaSA8IG9jbWVtLT5jb25maWctPm51bV9yZWdpb25zOyBpKyspIHsKKwkJc3RydWN0IG9jbWVt
X3JlZ2lvbiAqcmVnaW9uID0gJm9jbWVtLT5yZWdpb25zW2ldOworCisJCWlmIChidWYtPm9mZnNl
dCA8PSBvZmZzZXQgJiYgb2Zmc2V0IDwgYnVmLT5vZmZzZXQgKyBidWYtPmxlbikKKwkJCXJlZ2lv
bi0+bW9kZSA9IHJtb2RlOworCisJCWZvciAoaiA9IDA7IGogPCByZWdpb24tPm51bV9tYWNyb3M7
IGorKykgeworCQkJaWYgKGJ1Zi0+b2Zmc2V0IDw9IG9mZnNldCAmJgorCQkJICAgIG9mZnNldCA8
IGJ1Zi0+b2Zmc2V0ICsgYnVmLT5sZW4pCisJCQkJcmVnaW9uLT5tYWNyb19zdGF0ZVtqXSA9IG1z
dGF0ZTsKKworCQkJb2Zmc2V0ICs9IHJlZ2lvbi0+bWFjcm9fc2l6ZTsKKwkJfQorCX0KKworCXVw
ZGF0ZV9vY21lbShvY21lbSk7Cit9CisKK3N0cnVjdCBvY21lbSAqb2ZfZ2V0X29jbWVtKHN0cnVj
dCBkZXZpY2UgKmRldikKK3sKKwlzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2OworCXN0cnVj
dCBkZXZpY2Vfbm9kZSAqZGV2bm9kZTsKKworCWRldm5vZGUgPSBvZl9wYXJzZV9waGFuZGxlKGRl
di0+b2Zfbm9kZSwgIm9jbWVtIiwgMCk7CisJaWYgKCFkZXZub2RlKSB7CisJCWRldl9lcnIoZGV2
LCAiQ2Fubm90IGxvb2sgdXAgb2NtZW0gcGhhbmRsZVxuIik7CisJCXJldHVybiBFUlJfUFRSKC1F
TlhJTyk7CisJfQorCisJcGRldiA9IG9mX2ZpbmRfZGV2aWNlX2J5X25vZGUoZGV2bm9kZSk7CisJ
aWYgKCFwZGV2KSB7CisJCWRldl9lcnIoZGV2LCAiQ2Fubm90IGZpbmQgZGV2aWNlIG5vZGUgJXNc
biIsIGRldm5vZGUtPm5hbWUpOworCQlyZXR1cm4gRVJSX1BUUigtRVBST0JFX0RFRkVSKTsKKwl9
CisKKwlyZXR1cm4gcGxhdGZvcm1fZ2V0X2RydmRhdGEocGRldik7Cit9CitFWFBPUlRfU1lNQk9M
KG9mX2dldF9vY21lbSk7CisKK3N0cnVjdCBvY21lbV9idWYgKm9jbWVtX2FsbG9jYXRlKHN0cnVj
dCBvY21lbSAqb2NtZW0sIGVudW0gb2NtZW1fY2xpZW50IGNsaWVudCwKKwkJCQkgdW5zaWduZWQg
bG9uZyBzaXplKQoreworCXN0cnVjdCBvY21lbV9idWYgKmJ1ZjsKKwlpbnQgcmV0OworCisJLyog
VE9ETzogYWRkIHN1cHBvcnQgZm9yIG90aGVyIGNsaWVudHMuLi4gKi8KKwlpZiAoV0FSTl9PTihj
bGllbnQgIT0gT0NNRU1fR1JBUEhJQ1MpKQorCQlyZXR1cm4gRVJSX1BUUigtRU5PREVWKTsKKwor
CWlmIChzaXplIDwgT0NNRU1fTUlOX0FMTE9DIHx8ICFJU19BTElHTkVEKHNpemUsIE9DTUVNX01J
Tl9BTElHTikpCisJCXJldHVybiBFUlJfUFRSKC1FSU5WQUwpOworCisJaWYgKHRlc3RfYW5kX3Nl
dF9iaXRfbG9jayhCSVQoY2xpZW50KSwgJm9jbWVtLT5hY3RpdmVfYWxsb2NhdGlvbnMpKQorCQly
ZXR1cm4gRVJSX1BUUigtRUJVU1kpOworCisJYnVmID0ga3phbGxvYyhzaXplb2YoKmJ1ZiksIEdG
UF9LRVJORUwpOworCWlmICghYnVmKSB7CisJCXJldCA9IC1FTk9NRU07CisJCWdvdG8gZXJyX3Vu
bG9jazsKKwl9CisKKwlidWYtPm9mZnNldCA9IDA7CisJYnVmLT5hZGRyID0gZGV2aWNlX2FkZHJl
c3Mob2NtZW0sIGNsaWVudCwgYnVmLT5vZmZzZXQpOworCWJ1Zi0+bGVuID0gc2l6ZTsKKworCXVw
ZGF0ZV9yYW5nZShvY21lbSwgYnVmLCBDT1JFX09OLCBXSURFX01PREUpOworCisJaWYgKHFjb21f
c2NtX29jbWVtX2xvY2tfYXZhaWxhYmxlKCkpIHsKKwkJcmV0ID0gcWNvbV9zY21fb2NtZW1fbG9j
ayhRQ09NX1NDTV9PQ01FTV9HUkFQSElDU19JRCwKKwkJCQkJICBidWYtPm9mZnNldCwgYnVmLT5s
ZW4sIFdJREVfTU9ERSk7CisJCWlmIChyZXQpIHsKKwkJCWRldl9lcnIob2NtZW0tPmRldiwgImNv
dWxkIG5vdCBsb2NrOiAlZFxuIiwgcmV0KTsKKwkJCXJldCA9IC1FSU5WQUw7CisJCQlnb3RvIGVy
cl9rZnJlZTsKKwkJfQorCX0gZWxzZSB7CisJCW9jbWVtX3dyaXRlKG9jbWVtLCBPQ01FTV9SRUdf
R0ZYX01QVV9TVEFSVCwgYnVmLT5vZmZzZXQpOworCQlvY21lbV93cml0ZShvY21lbSwgT0NNRU1f
UkVHX0dGWF9NUFVfRU5ELAorCQkJICAgIGJ1Zi0+b2Zmc2V0ICsgYnVmLT5sZW4pOworCX0KKwor
CWRldl9kYmcob2NtZW0tPmRldiwgInVzaW5nICVsZEsgb2YgT0NNRU0gYXQgMHglMDhseCBmb3Ig
Y2xpZW50ICVkXG4iLAorCQlzaXplIC8gMTAyNCwgYnVmLT5hZGRyLCBjbGllbnQpOworCisJcmV0
dXJuIGJ1ZjsKKworZXJyX2tmcmVlOgorCWtmcmVlKGJ1Zik7CitlcnJfdW5sb2NrOgorCWNsZWFy
X2JpdF91bmxvY2soQklUKGNsaWVudCksICZvY21lbS0+YWN0aXZlX2FsbG9jYXRpb25zKTsKKwor
CXJldHVybiBFUlJfUFRSKHJldCk7Cit9CitFWFBPUlRfU1lNQk9MKG9jbWVtX2FsbG9jYXRlKTsK
Kwordm9pZCBvY21lbV9mcmVlKHN0cnVjdCBvY21lbSAqb2NtZW0sIGVudW0gb2NtZW1fY2xpZW50
IGNsaWVudCwKKwkJc3RydWN0IG9jbWVtX2J1ZiAqYnVmKQoreworCS8qIFRPRE86IGFkZCBzdXBw
b3J0IGZvciBvdGhlciBjbGllbnRzLi4uICovCisJaWYgKFdBUk5fT04oY2xpZW50ICE9IE9DTUVN
X0dSQVBISUNTKSkKKwkJcmV0dXJuOworCisJdXBkYXRlX3JhbmdlKG9jbWVtLCBidWYsIENMS19P
RkYsIE1PREVfREVGQVVMVCk7CisKKwlpZiAocWNvbV9zY21fb2NtZW1fbG9ja19hdmFpbGFibGUo
KSkgeworCQlpbnQgcmV0OworCisJCXJldCA9IHFjb21fc2NtX29jbWVtX3VubG9jayhRQ09NX1ND
TV9PQ01FTV9HUkFQSElDU19JRCwKKwkJCQkJICAgIGJ1Zi0+b2Zmc2V0LCBidWYtPmxlbik7CisJ
CWlmIChyZXQpCisJCQlkZXZfZXJyKG9jbWVtLT5kZXYsICJjb3VsZCBub3QgdW5sb2NrOiAlZFxu
IiwgcmV0KTsKKwl9IGVsc2UgeworCQlvY21lbV93cml0ZShvY21lbSwgT0NNRU1fUkVHX0dGWF9N
UFVfU1RBUlQsIDB4MCk7CisJCW9jbWVtX3dyaXRlKG9jbWVtLCBPQ01FTV9SRUdfR0ZYX01QVV9F
TkQsIDB4MCk7CisJfQorCisJa2ZyZWUoYnVmKTsKKworCWNsZWFyX2JpdF91bmxvY2soQklUKGNs
aWVudCksICZvY21lbS0+YWN0aXZlX2FsbG9jYXRpb25zKTsKK30KK0VYUE9SVF9TWU1CT0wob2Nt
ZW1fZnJlZSk7CisKK3N0YXRpYyBpbnQgb2NtZW1fZGV2X3Byb2JlKHN0cnVjdCBwbGF0Zm9ybV9k
ZXZpY2UgKnBkZXYpCit7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJnBkZXYtPmRldjsKKwl1bnNp
Z25lZCBsb25nIHJlZywgcmVnaW9uX3NpemU7CisJaW50IGksIGosIHJldCwgbnVtX2JhbmtzOwor
CXN0cnVjdCByZXNvdXJjZSAqcmVzOworCXN0cnVjdCBvY21lbSAqb2NtZW07CisKKwlpZiAoIXFj
b21fc2NtX2lzX2F2YWlsYWJsZSgpKQorCQlyZXR1cm4gLUVQUk9CRV9ERUZFUjsKKworCW9jbWVt
ID0gZGV2bV9remFsbG9jKGRldiwgc2l6ZW9mKCpvY21lbSksIEdGUF9LRVJORUwpOworCWlmICgh
b2NtZW0pCisJCXJldHVybiAtRU5PTUVNOworCisJb2NtZW0tPmRldiA9IGRldjsKKwlvY21lbS0+
Y29uZmlnID0gZGV2aWNlX2dldF9tYXRjaF9kYXRhKGRldik7CisKKwlyZXQgPSBkZXZtX2Nsa19i
dWxrX2dldChkZXYsIEFSUkFZX1NJWkUob2NtZW1fY2xrcyksIG9jbWVtX2Nsa3MpOworCWlmIChy
ZXQpIHsKKwkJaWYgKHJldCAhPSAtRVBST0JFX0RFRkVSKQorCQkJZGV2X2VycihkZXYsICJVbmFi
bGUgdG8gZ2V0IGNsb2Nrc1xuIik7CisKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXMgPSBwbGF0
Zm9ybV9nZXRfcmVzb3VyY2VfYnluYW1lKHBkZXYsIElPUkVTT1VSQ0VfTUVNLCAiY3RybCIpOwor
CW9jbWVtLT5tbWlvID0gZGV2bV9pb3JlbWFwX3Jlc291cmNlKCZwZGV2LT5kZXYsIHJlcyk7CisJ
aWYgKElTX0VSUihvY21lbS0+bW1pbykpIHsKKwkJZGV2X2VycigmcGRldi0+ZGV2LCAiRmFpbGVk
IHRvIGlvcmVtYXAgb2NtZW1fY3RybCByZXNvdXJjZVxuIik7CisJCXJldHVybiBQVFJfRVJSKG9j
bWVtLT5tbWlvKTsKKwl9CisKKwlvY21lbS0+bWVtb3J5ID0gcGxhdGZvcm1fZ2V0X3Jlc291cmNl
X2J5bmFtZShwZGV2LCBJT1JFU09VUkNFX01FTSwKKwkJCQkJCSAgICAgIm1lbSIpOworCWlmICgh
b2NtZW0tPm1lbW9yeSkgeworCQlkZXZfZXJyKGRldiwgIkNvdWxkIG5vdCBnZXQgbWVtIHJlZ2lv
blxuIik7CisJCXJldHVybiAtRU5YSU87CisJfQorCisJLyogVGhlIGNvcmUgY2xvY2sgaXMgc3lu
Y2hyb25vdXMgd2l0aCBncmFwaGljcyAqLworCVdBUk5fT04oY2xrX3NldF9yYXRlKG9jbWVtX2Ns
a3NbT0NNRU1fQ0xLX0NPUkVfSURYXS5jbGssIDEwMDApIDwgMCk7CisKKwlyZXQgPSBjbGtfYnVs
a19wcmVwYXJlX2VuYWJsZShBUlJBWV9TSVpFKG9jbWVtX2Nsa3MpLCBvY21lbV9jbGtzKTsKKwlp
ZiAocmV0KSB7CisJCWRldl9pbmZvKG9jbWVtLT5kZXYsICJGYWlsZWQgdG8gZW5hYmxlIGNsb2Nr
c1xuIik7CisJCXJldHVybiByZXQ7CisJfQorCisJaWYgKHFjb21fc2NtX3Jlc3RvcmVfc2VjX2Nm
Z19hdmFpbGFibGUoKSkgeworCQlkZXZfZGJnKGRldiwgImNvbmZpZ3VyaW5nIHNjbVxuIik7CisJ
CXJldCA9IHFjb21fc2NtX3Jlc3RvcmVfc2VjX2NmZyhRQ09NX1NDTV9PQ01FTV9ERVZfSUQsIDAp
OworCQlpZiAocmV0KSB7CisJCQlkZXZfZXJyKGRldiwgIkNvdWxkIG5vdCBlbmFibGUgc2VjdXJl
IGNvbmZpZ3VyYXRpb25cbiIpOworCQkJZ290byBlcnJfY2xrX2Rpc2FibGU7CisJCX0KKwl9CisK
KwlyZWcgPSBvY21lbV9yZWFkKG9jbWVtLCBPQ01FTV9SRUdfSFdfUFJPRklMRSk7CisJb2NtZW0t
Pm51bV9wb3J0cyA9IE9DTUVNX0hXX1BST0ZJTEVfTlVNX1BPUlRTKHJlZyk7CisJb2NtZW0tPm51
bV9tYWNyb3MgPSBPQ01FTV9IV19QUk9GSUxFX05VTV9NQUNST1MocmVnKTsKKwlvY21lbS0+aW50
ZXJsZWF2ZWQgPSAhIShyZWcgJiBPQ01FTV9IV19QUk9GSUxFX0lOVEVSTEVBVklORyk7CisKKwlu
dW1fYmFua3MgPSBvY21lbS0+bnVtX3BvcnRzIC8gMjsKKwlyZWdpb25fc2l6ZSA9IG9jbWVtLT5j
b25maWctPm1hY3JvX3NpemUgKiBudW1fYmFua3M7CisKKwlkZXZfaW5mbyhkZXYsICIldSBwb3J0
cywgJXUgcmVnaW9ucywgJXUgbWFjcm9zLCAlc2ludGVybGVhdmVkXG4iLAorCQkgb2NtZW0tPm51
bV9wb3J0cywgb2NtZW0tPmNvbmZpZy0+bnVtX3JlZ2lvbnMsCisJCSBvY21lbS0+bnVtX21hY3Jv
cywgb2NtZW0tPmludGVybGVhdmVkID8gIiIgOiAibm90ICIpOworCisJb2NtZW0tPnJlZ2lvbnMg
PSBkZXZtX2tjYWxsb2MoZGV2LCBvY21lbS0+Y29uZmlnLT5udW1fcmVnaW9ucywKKwkJCQkgICAg
ICBzaXplb2Yoc3RydWN0IG9jbWVtX3JlZ2lvbiksIEdGUF9LRVJORUwpOworCWlmICghb2NtZW0t
PnJlZ2lvbnMpIHsKKwkJcmV0ID0gLUVOT01FTTsKKwkJZ290byBlcnJfY2xrX2Rpc2FibGU7CisJ
fQorCisJZm9yIChpID0gMDsgaSA8IG9jbWVtLT5jb25maWctPm51bV9yZWdpb25zOyBpKyspIHsK
KwkJc3RydWN0IG9jbWVtX3JlZ2lvbiAqcmVnaW9uID0gJm9jbWVtLT5yZWdpb25zW2ldOworCisJ
CWlmIChXQVJOX09OKG51bV9iYW5rcyA+IEFSUkFZX1NJWkUocmVnaW9uLT5tYWNyb19zdGF0ZSkp
KSB7CisJCQlyZXQgPSAtRUlOVkFMOworCQkJZ290byBlcnJfY2xrX2Rpc2FibGU7CisJCX0KKwor
CQlyZWdpb24tPm1vZGUgPSBNT0RFX0RFRkFVTFQ7CisJCXJlZ2lvbi0+bnVtX21hY3JvcyA9IG51
bV9iYW5rczsKKworCQlpZiAoaSA9PSAob2NtZW0tPmNvbmZpZy0+bnVtX3JlZ2lvbnMgLSAxKSAm
JgorCQkgICAgcmVnICYgT0NNRU1fSFdfUFJPRklMRV9MQVNUX1JFR05fSEFMRlNJWkUpIHsKKwkJ
CXJlZ2lvbi0+bWFjcm9fc2l6ZSA9IG9jbWVtLT5jb25maWctPm1hY3JvX3NpemUgLyAyOworCQkJ
cmVnaW9uLT5yZWdpb25fc2l6ZSA9IHJlZ2lvbl9zaXplIC8gMjsKKwkJfSBlbHNlIHsKKwkJCXJl
Z2lvbi0+bWFjcm9fc2l6ZSA9IG9jbWVtLT5jb25maWctPm1hY3JvX3NpemU7CisJCQlyZWdpb24t
PnJlZ2lvbl9zaXplID0gcmVnaW9uX3NpemU7CisJCX0KKworCQlmb3IgKGogPSAwOyBqIDwgQVJS
QVlfU0laRShyZWdpb24tPm1hY3JvX3N0YXRlKTsgaisrKQorCQkJcmVnaW9uLT5tYWNyb19zdGF0
ZVtqXSA9IENMS19PRkY7CisJfQorCisJcGxhdGZvcm1fc2V0X2RydmRhdGEocGRldiwgb2NtZW0p
OworCisJcmV0dXJuIDA7CisKK2Vycl9jbGtfZGlzYWJsZToKKwljbGtfYnVsa19kaXNhYmxlX3Vu
cHJlcGFyZShBUlJBWV9TSVpFKG9jbWVtX2Nsa3MpLCBvY21lbV9jbGtzKTsKKwlyZXR1cm4gcmV0
OworfQorCitzdGF0aWMgaW50IG9jbWVtX2Rldl9yZW1vdmUoc3RydWN0IHBsYXRmb3JtX2Rldmlj
ZSAqcGRldikKK3sKKwljbGtfYnVsa19kaXNhYmxlX3VucHJlcGFyZShBUlJBWV9TSVpFKG9jbWVt
X2Nsa3MpLCBvY21lbV9jbGtzKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgY29uc3Qgc3Ry
dWN0IG9jbWVtX2NvbmZpZyBvY21lbV84OTc0X2NvbmZpZyA9IHsKKwkubnVtX3JlZ2lvbnMgPSAz
LAorCS5tYWNyb19zaXplID0gU1pfMTI4SywKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3Qgb2Zf
ZGV2aWNlX2lkIG9jbWVtX29mX21hdGNoW10gPSB7CisJeyAuY29tcGF0aWJsZSA9ICJxY29tLG1z
bTg5NzQtb2NtZW0iLCAuZGF0YSA9ICZvY21lbV84OTc0X2NvbmZpZyB9LAorCXsgfQorfTsKKwor
TU9EVUxFX0RFVklDRV9UQUJMRShvZiwgb2NtZW1fb2ZfbWF0Y2gpOworCitzdGF0aWMgc3RydWN0
IHBsYXRmb3JtX2RyaXZlciBvY21lbV9kcml2ZXIgPSB7CisJLnByb2JlID0gb2NtZW1fZGV2X3By
b2JlLAorCS5yZW1vdmUgPSBvY21lbV9kZXZfcmVtb3ZlLAorCS5kcml2ZXIgPSB7CisJCS5uYW1l
ID0gIm9jbWVtIiwKKwkJLm9mX21hdGNoX3RhYmxlID0gb2NtZW1fb2ZfbWF0Y2gsCisJfSwKK307
CisKK21vZHVsZV9wbGF0Zm9ybV9kcml2ZXIob2NtZW1fZHJpdmVyKTsKKworTU9EVUxFX0RFU0NS
SVBUSU9OKCJPbiBDaGlwIE1lbW9yeSAoT0NNRU0pIGFsbG9jYXRvciBmb3Igc29tZSBTbmFwZHJh
Z29uIFNvQ3MiKTsKK01PRFVMRV9MSUNFTlNFKCJHUEwiKTsKZGlmZiAtLWdpdCBhL2luY2x1ZGUv
c29jL3Fjb20vb2NtZW0uaCBiL2luY2x1ZGUvc29jL3Fjb20vb2NtZW0uaApuZXcgZmlsZSBtb2Rl
IDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjA2M2Q1MDBmNjUzZgotLS0gL2Rldi9udWxsCisr
KyBiL2luY2x1ZGUvc29jL3Fjb20vb2NtZW0uaApAQCAtMCwwICsxLDYyIEBACisvKiBTUERYLUxp
Y2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5ICovCisvKgorICogVGhlIE9uIENoaXAgTWVt
b3J5IChPQ01FTSkgYWxsb2NhdG9yIGFsbG93cyB2YXJpb3VzIGNsaWVudHMgdG8gYWxsb2NhdGUK
KyAqIG1lbW9yeSBmcm9tIE9DTUVNIGJhc2VkIG9uIHBlcmZvcm1hbmNlLCBsYXRlbmN5IGFuZCBw
b3dlciByZXF1aXJlbWVudHMuCisgKiBUaGlzIGlzIHR5cGljYWxseSB1c2VkIGJ5IHRoZSBHUFUs
IGNhbWVyYS92aWRlbywgYW5kIGF1ZGlvIGNvbXBvbmVudHMgb24KKyAqIHNvbWUgU25hcGRyYWdv
biBTb0NzLgorICoKKyAqIENvcHlyaWdodCAoQykgMjAxOSBCcmlhbiBNYXNuZXkgPG1hc25leWJA
b25zdGF0aW9uLm9yZz4KKyAqIENvcHlyaWdodCAoQykgMjAxNSBSZWQgSGF0LiBBdXRob3I6IFJv
YiBDbGFyayA8cm9iZGNsYXJrQGdtYWlsLmNvbT4KKyAqLworCisjaWZuZGVmIF9fT0NNRU1fSF9f
CisjZGVmaW5lIF9fT0NNRU1fSF9fCisKK2VudW0gb2NtZW1fY2xpZW50IHsKKwkvKiBHTUVNIGNs
aWVudHMgKi8KKwlPQ01FTV9HUkFQSElDUyA9IDB4MCwKKwkvKgorCSAqIFRPRE8gYWRkIG1vcmUg
b25jZSBvY21lbV9hbGxvY2F0ZSgpIGlzIGNsZXZlciBlbm91Z2ggdG8KKwkgKiBkZWFsIHdpdGgg
bXVsdGlwbGUgY2xpZW50cy4KKwkgKi8KKwlPQ01FTV9DTElFTlRfTUFYLAorfTsKKworc3RydWN0
IG9jbWVtOworCitzdHJ1Y3Qgb2NtZW1fYnVmIHsKKwl1bnNpZ25lZCBsb25nIG9mZnNldDsKKwl1
bnNpZ25lZCBsb25nIGFkZHI7CisJdW5zaWduZWQgbG9uZyBsZW47Cit9OworCisjaWYgSVNfRU5B
QkxFRChDT05GSUdfUUNPTV9PQ01FTSkKKworc3RydWN0IG9jbWVtICpvZl9nZXRfb2NtZW0oc3Ry
dWN0IGRldmljZSAqZGV2KTsKK3N0cnVjdCBvY21lbV9idWYgKm9jbWVtX2FsbG9jYXRlKHN0cnVj
dCBvY21lbSAqb2NtZW0sIGVudW0gb2NtZW1fY2xpZW50IGNsaWVudCwKKwkJCQkgdW5zaWduZWQg
bG9uZyBzaXplKTsKK3ZvaWQgb2NtZW1fZnJlZShzdHJ1Y3Qgb2NtZW0gKm9jbWVtLCBlbnVtIG9j
bWVtX2NsaWVudCBjbGllbnQsCisJCXN0cnVjdCBvY21lbV9idWYgKmJ1Zik7CisKKyNlbHNlIC8q
IElTX0VOQUJMRUQoQ09ORklHX1FDT01fT0NNRU0pICovCisKK3N0YXRpYyBpbmxpbmUgc3RydWN0
IG9jbWVtICpvZl9nZXRfb2NtZW0oc3RydWN0IGRldmljZSAqZGV2KQoreworCXJldHVybiBOVUxM
OworfQorCitzdGF0aWMgaW5saW5lIHN0cnVjdCBvY21lbV9idWYgKm9jbWVtX2FsbG9jYXRlKHN0
cnVjdCBvY21lbSAqb2NtZW0sCisJCQkJCSAgICAgICBlbnVtIG9jbWVtX2NsaWVudCBjbGllbnQs
CisJCQkJCSAgICAgICB1bnNpZ25lZCBsb25nIHNpemUpCit7CisJcmV0dXJuIE5VTEw7Cit9CisK
K3N0YXRpYyBpbmxpbmUgdm9pZCBvY21lbV9mcmVlKHN0cnVjdCBvY21lbSAqb2NtZW0sIGVudW0g
b2NtZW1fY2xpZW50IGNsaWVudCwKKwkJCSAgICAgIHN0cnVjdCBvY21lbV9idWYgKmJ1ZikKK3sK
K30KKworI2VuZGlmIC8qIElTX0VOQUJMRUQoQ09ORklHX1FDT01fT0NNRU0pICovCisKKyNlbmRp
ZiAvKiBfX09DTUVNX0hfXyAqLwotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBs
aXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1h
bi9saXN0aW5mby9kcmktZGV2ZWw=
