Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id BD168F0313
	for <lists+dri-devel@lfdr.de>; Tue,  5 Nov 2019 17:33:50 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8D1F56EAEB;
	Tue,  5 Nov 2019 16:33:48 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8B2B66EAEB
 for <dri-devel@lists.freedesktop.org>; Tue,  5 Nov 2019 16:33:46 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id B6203B440;
 Tue,  5 Nov 2019 16:33:44 +0000 (UTC)
Date: Tue, 05 Nov 2019 17:33:44 +0100
Message-ID: <s5hh83ith93.wl-tiwai@suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: Russell King - ARM Linux admin <linux@armlinux.org.uk>
Subject: Re: Incorrect buffer handling in dw-hdmi bridge audio
In-Reply-To: <20191105160215.GQ25745@shell.armlinux.org.uk>
References: <s5heeymbvva.wl-tiwai@suse.de>
 <6ad19121-c0e3-d278-2943-ff93ef80353b@baylibre.com>
 <20191105160215.GQ25745@shell.armlinux.org.uk>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI/1.14.6 (Maruoka)
 FLIM/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL/10.8 Emacs/25.3
 (x86_64-suse-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Jernej Skrabec <jernej.skrabec@siol.net>, Jonas Karlman <jonas@kwiboo.se>,
 Neil Armstrong <narmstrong@baylibre.com>, alsa-devel@alsa-project.org,
 dri-devel@lists.freedesktop.org,
 Laurent Pinchart <Laurent.pinchart@ideasonboard.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gVHVlLCAwNSBOb3YgMjAxOSAxNzowMjoxNSArMDEwMCwKUnVzc2VsbCBLaW5nIC0gQVJNIExp
bnV4IGFkbWluIHdyb3RlOgo+IAo+IE9uIFR1ZSwgTm92IDA1LCAyMDE5IGF0IDA5OjA3OjQzQU0g
KzAxMDAsIE5laWwgQXJtc3Ryb25nIHdyb3RlOgo+ID4gSGksCj4gPiAKPiA+IE9uIDA1LzExLzIw
MTkgMDg6NTUsIFRha2FzaGkgSXdhaSB3cm90ZToKPiA+ID4gSGksCj4gPiA+IAo+ID4gPiB3aGls
ZSByZWNlbnRseSB3b3JraW5nIG9uIHRoZSBBTFNBIG1lbW9yeSBhbGxvY2F0b3IgQVBJIGNsZWFu
dXAsIEkKPiA+ID4gbm90aWNlZCB0aGF0IGR3LWhkbWkgYnJpZGdlIGRyaXZlciBzZWVtcyBkb2lu
ZyB3ZWlyZCBhYm91dCB0aGUgYnVmZmVyCj4gPiA+IG1hbmFnZW1lbnQuICBJdCBwcmUtYWxsb2Nh
dGVzIHRoZSB1c3VhbCBkZXZpY2UgYnVmZmVycyBmdWxseSBhdCB0aGUKPiA+ID4gcHJvYmUgdGlt
ZSwgd2hpbGUgZWFjaCBzdHJlYW0gYWxsb2NhdGVzIHRoZSBidWZmZXIgdmlhIHRoZSB2bWFsbG9j
Cj4gPiA+IGhlbHBlcnMgYW5kIHJlcGxhY2VzIHdpdGggaXQgYXQgZWFjaCBvcGVuLgo+ID4gPiAK
PiA+ID4gSSBndWVzcyBpdCdzIG5vIGV4cGVjdGVkIGJlaGF2aW9yPyAgSXQncyBiYXNpY2FsbHkg
YSBmdWxsIHdhc3RlIG9mCj4gPiA+IHJlc291cmNlcywgYW5kIHRoZSB2bWFsbG9jIGJ1ZmZlciBp
c24ndCBndWFyYW50ZWVkIHRvIHdvcmsgd2VsbCBmb3IKPiA+ID4gbW1hcCBvbiBldmVyeSBhcmNo
aXRlY3R1cmUuCj4gPiA+IAo+ID4gPiBCZWxvdyBpcyB0aGUgcGF0Y2ggdG8gYWRkcmVzcyBpdC4g
IENhbiBhbnlvbmUgY2hlY2sgd2hldGhlciB0aGlzIHN0aWxsCj4gPiA+IHdvcmtzPwo+ID4gCj4g
PiBJIGRvbid0IGhhdmUgdGhlIHNldHVwIHRvIGNoZWNrLCBidXQgdGhpcyBoYXMgYmVlbiBwdXNo
ZWQgYnkgUnVzc2VsbCBJIEFkZGVkIGluIENDLgo+ID4gCj4gPiBJIGFsc28gYWRkZWQgdGhlIGlt
eCBtYWludGFpbmVyIHNpbmNlIGl0J3MgKEFGQUlLKSBvbmx5IHVzZWQgb24gaU1YIFNvQ3MuCj4g
PiAKPiA+IE5laWwKPiA+IAo+ID4gPiAKPiA+ID4gU2luY2UgSSBoYXZlIGEgY2xlYW51cCBzZXJp
ZXMgYW5kIHRoaXMgaXMgaW52b2x2ZWQsIEknZCBsaWtlIHRvIHRha2UKPiA+ID4gdGhlIGZpeCB0
aHJvdWdoIG15IHRyZWUgb25jZSBhZnRlciBpdCdzIGNvbmZpcm1lZCAoYW5kIGdldCBBQ0sgaWYK
PiA+ID4gcG9zc2libGUpLgo+ID4gPiAKPiA+ID4gCj4gPiA+IFRoYW5rcyEKPiA+ID4gCj4gPiA+
IFRha2FzaGkKPiA+ID4gCj4gPiA+IC0tIDg8IC0tCj4gPiA+IEZyb206IFRha2FzaGkgSXdhaSA8
dGl3YWlAc3VzZS5kZT4KPiA+ID4gU3ViamVjdDogW1BBVENIXSBkcm0vYnJpZGdlOiBkdy1oZG1p
OiBGaXggdGhlIGluY29ycmVjdCBidWZmZXIgYWxsb2NhdGlvbnMKPiA+ID4gCj4gPiA+IFRoZSBk
cml2ZXIgc2V0cyB1cCB0aGUgYnVmZmVyIHByZWFsbG9jYXRpb24gd2l0aCBTTkRSVl9ETUFfVFlQ
RV9ERVYsCj4gPiA+IHdoaWxlIGl0IHJlLWFsbG9jYXRlcyBhbmQgcmVsZWFzZXMgdm1hbGxvYyBw
YWdlcy4gIFRoaXMgaXMgbm90IG9ubHkgYQo+ID4gPiBsb3Qgb2Ygd2FzdGUgcmVzb3VyY2VzIGJ1
dCBhbHNvIGNhdXNlcyB0aGUgbW1hcCBtYWxmdW5jdGlvbi4KPiA+ID4gCj4gPiA+IENoYW5nZSAv
IGRyb3AgdGhlIHZtYWxsb2MtcmVsYXRlZCBjb2RlIGFuZCB1c2UgdGhlIHN0YW5kYXJkIGJ1ZmZl
cgo+ID4gPiBhbGxvY2F0aW9uIC8gcmVsZWFzZSBjb2RlIGluc3RlYWQuCj4gCj4gSSB0aGluayBn
ZXR0aW5nIHJpZCBvZiB0aGUgdm1hbGxvYyBjb2RlIGhlcmUgaXMgYSBtaXN0YWtlIC0gSSBzZWVt
IHRvCj4gcmVtZW1iZXIgdXNpbmcgdGhlIHN0YW5kYXJkIGJ1ZmZlciBhbGxvY2F0aW9uIGNhdXNl
cyBmYWlsdXJlcywgZHVlIHRvCj4gbWVtb3J5IGZyYWdtZW50YXRpb24uICBTaW5jZSB0aGUgaGFy
ZHdhcmUgaXMgbGltaXRlZCB0byBETUEgZnJvbSBhdAo+IG1vc3Qgb25lIHBhZ2UsIHRoZXJlIGlz
IG5vIHJlYXNvbiBmb3IgdGhpcyBkcml2ZXIgdG8gcmVxdWlyZSBjb250aWd1b3VzCj4gcGFnZXMs
IGhlbmNlIHdoeSBpdCdzIHVzaW5nIC0gYW5kIHNob3VsZCB1c2UgLSB2bWFsbG9jIHBhZ2VzLiAg
dm1hbGxvYwo+IGlzIHdheSBraW5kZXIgdG8gdGhlIE1NIHN1YnN5c3RlbSB0aGFuIHRyeWluZyB0
byByZXF1ZXN0IGxhcmdlIG9yZGVyCj4gY29udGlndW91cyBwYWdlcy4KPiAKPiBTbywgTkFLIG9u
IHRoaXMgcGF0Y2guCgpPSywgdGhlbiB3ZSBzaG91bGQgZG8gb3RoZXIgd2F5IHJvdW5kLCByYXRo
ZXIgZHJvcCB0aGUgYnVmZmVyCnByZWFsbG9jYXRpb24gaW5zdGVhZC4gIEN1cnJlbnRseSB2bWFs
bG9jIGJ1ZmZlciBpcyBhbHdheXMgYWxsb2NhdGVkCmF0IGVhY2ggb3BlbiBhbmQgb3ZlcnJpZGVz
IHRoZSBwcmVhbGxvY2F0ZWQgYnVmZmVyLCBzbyB0aGUgd2hvbGUgNjRrCmFuZCBtb3JlIGFyZSB3
YXN0ZWQgZm9yIG5vIHVzZS4KCihCVFcsIHRoZSBjdXJyZW50IGNvZGUgaGFzIHRoaXMgc25pcHBl
dDoKCgkvKiBMaW1pdCB0aGUgYnVmZmVyIHNpemUgdG8gdGhlIHNpemUgb2YgdGhlIHByZWFsbG9j
YXRlZCBidWZmZXIgKi8KCXJldCA9IHNuZF9wY21faHdfY29uc3RyYWludF9taW5tYXgocnVudGlt
ZSwKCQkJCQkgICBTTkRSVl9QQ01fSFdfUEFSQU1fQlVGRkVSX1NJWkUsCgkJCQkJICAgMCwgc3Vi
c3RyZWFtLT5kbWFfYnVmZmVyLmJ5dGVzKTsKCi4uLiBhbmQgdGhpcyB3b3VsZCBoYXZlIHRvIGxp
bWl0IHRoZSBidWZmZXIgc2l6ZSBvbmx5IHRvIHRoZQpwcmVhbGxvY2F0ZWQgc2l6ZSAtLSB3aGlj
aCBlc3NlbnRpYWxseSBtYWtlcyB0aGUgYXJndW1lbnQgYWJvdmUKaW52YWxpZC4gIEhvd2V2ZXIs
IHRoaXMgY2hlY2sgbG9va3MgYWN0dWFsbHkgYm9ndXMsIHRoZSBjb25zdHJhaW50CnBhcmFtZXRl
ciBzaG91bGQgYmUgU05EUlZfUENNX0hXX1BBUkFNX0JVRkZFUl9CWVRFUywgbm90IF9TSVpFLiAg
SXQKbWlnaHQgYmUgdGhlIHJlYXNvbiBpdCB3b3JrZWQgc29tZWhvdy4uLikKClNvIGJlbG93IGlz
IHRoZSByZXZpc2VkIHBhdGNoLiAgQ291bGQgeW91IGd1eXMgY2hlY2sgaXQgYWdhaW4/CgpUaGVy
ZSBJIGNvcGllZCB0aGUgY29tbWVudCBhcyBpcywgYWx0aG91Z2ggdGhlIDUxMmsgbWVudGlvbmVk
IHRoZXJlCmxvb2tzIGluY29uc2lzdGVudCB3aXRoIHRoZSBhY3R1YWwgY29kZS4gIFNob3VsZCBp
dCBiZSAxTT8KCgpUaGFua3MhCgpUYWthc2hpCgotLSA4PCAtLQpGcm9tOiBUYWthc2hpIEl3YWkg
PHRpd2FpQHN1c2UuZGU+ClN1YmplY3Q6IFtQQVRDSF0gZHJtL2JyaWRnZTogZHctaGRtaTogQSBj
b3VwbGUgb2YgZml4ZXMgd3J0IGJ1ZmZlciBhbGxvY2F0aW9uCgpUaGUgZHJpdmVyIHNldHMgdXAg
dGhlIGJ1ZmZlciBwcmVhbGxvY2F0aW9uIHdpdGggU05EUlZfRE1BX1RZUEVfREVWLAp3aGlsZSBp
dCBhbHdheXMgcmUtYWxsb2NhdGVzIGFuZCByZWxlYXNlcyB2bWFsbG9jIHBhZ2VzLCBoZW5jZSB0
aGUKcHJlYWxsb2NhdGVkIHBhZ2VzIGFyZSBuZXZlciB1c2VkLiAgQWxzbywgdGhlIGN1cnJlbnQg
Y29kZSBjb250YWlucwp0aGUgaHcgY29uc3RyYWludCB0byBsaW1pdCB0aGUgYnVmZmVyIHNpemUg
dG8gdGhlIHByZWFsbG9jYXRlZCBzaXplLgpJdCBkb2Vzbid0IHdvcmsgYXMgZXhwZWN0ZWQsIGhv
d2V2ZXIsIGJlY2F1c2UgaXQncyBhcHBseWluZyB0byBhbgppbmNvcnJlY3QgcGFyYW1ldGVyIChT
TkRSVl9QQ01fSFdfUEFSQU1fQlVGRkVSX1NJWkUgaW5zdGVhZCBvZgpfQlVGRkVSX0JZVEVTKS4K
ClRoaXMgcGF0Y2ggdHJpZXMgdG8gYWRkcmVzcyB0aGVzZSBpc3N1ZXM6IGRyb3AgdGhlIHVubmVj
ZXNzYXJ5IGJ1ZmZlcgpwcmVhbGxvY2F0aW9uIGFuZCBmaXggdGhlIGh3IGNvbnN0cmFpbnQgdG8g
dGhlIHJpZ2h0IHBhcmFtZXRlci4gIFNpbmNlCnRoZSBidWZmZXIgcHJlYWxsb2NhdGlvbiBpcyBk
cm9wcGVkLCB0aGUgbWF4IGJ1ZmZlciBzaXplIHRoYXQgd2FzCnBhc3NlZCB0byB0aGUgcHJlYWxs
b2NhdGlvbiBpcyBwYXNzZWQgZGlyZWN0bHkgbm93IHRvIHRoZSBodwpjb25zdHJhaW50IGNhbGwu
CgpTaWduZWQtb2ZmLWJ5OiBUYWthc2hpIEl3YWkgPHRpd2FpQHN1c2UuZGU+Ci0tLQogZHJpdmVy
cy9ncHUvZHJtL2JyaWRnZS9zeW5vcHN5cy9kdy1oZG1pLWFoYi1hdWRpby5jIHwgMTcgKysrKysr
Ky0tLS0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA3IGluc2VydGlvbnMoKyksIDEwIGRlbGV0aW9u
cygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2Uvc3lub3BzeXMvZHctaGRt
aS1haGItYXVkaW8uYyBiL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2Uvc3lub3BzeXMvZHctaGRtaS1h
aGItYXVkaW8uYwppbmRleCAyYjc1Mzk3MDFiNDIuLjNlZmJiYzU5OTk0YiAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9zeW5vcHN5cy9kdy1oZG1pLWFoYi1hdWRpby5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9icmlkZ2Uvc3lub3BzeXMvZHctaGRtaS1haGItYXVkaW8uYwpAQCAt
MzM3LDEwICszMzcsMTQgQEAgc3RhdGljIGludCBkd19oZG1pX29wZW4oc3RydWN0IHNuZF9wY21f
c3Vic3RyZWFtICpzdWJzdHJlYW0pCiAJaWYgKHJldCA8IDApCiAJCXJldHVybiByZXQ7CiAKLQkv
KiBMaW1pdCB0aGUgYnVmZmVyIHNpemUgdG8gdGhlIHNpemUgb2YgdGhlIHByZWFsbG9jYXRlZCBi
dWZmZXIgKi8KKwkvKgorCSAqIExpbWl0IHRoZSBidWZmZXIgc2l6ZToKKwkgKiB0byBzdXBwb3J0
IDgtY2hhbm5lbCA5NmtIeiBhdWRpbyByZWxpYWJseSwgd2UgbmVlZCA1MTJrCisJICogdG8gc2F0
aXNmeSBhbHNhIHdpdGggb3VyIHJlc3RyaWN0ZWQgcGVyaW9kIChFUlIwMDQzMjMpLgorCSAqLwog
CXJldCA9IHNuZF9wY21faHdfY29uc3RyYWludF9taW5tYXgocnVudGltZSwKLQkJCQkJICAgU05E
UlZfUENNX0hXX1BBUkFNX0JVRkZFUl9TSVpFLAotCQkJCQkgICAwLCBzdWJzdHJlYW0tPmRtYV9i
dWZmZXIuYnl0ZXMpOworCQkJCQkgICBTTkRSVl9QQ01fSFdfUEFSQU1fQlVGRkVSX0JZVEVTLAor
CQkJCQkgICAwLCAxMDI0ICogMTAyNCk7CiAJaWYgKHJldCA8IDApCiAJCXJldHVybiByZXQ7CiAK
QEAgLTU2MCwxMyArNTY0LDYgQEAgc3RhdGljIGludCBzbmRfZHdfaGRtaV9wcm9iZShzdHJ1Y3Qg
cGxhdGZvcm1fZGV2aWNlICpwZGV2KQogCXN0cmxjcHkocGNtLT5uYW1lLCBEUklWRVJfTkFNRSwg
c2l6ZW9mKHBjbS0+bmFtZSkpOwogCXNuZF9wY21fc2V0X29wcyhwY20sIFNORFJWX1BDTV9TVFJF
QU1fUExBWUJBQ0ssICZzbmRfZHdfaGRtaV9vcHMpOwogCi0JLyoKLQkgKiBUbyBzdXBwb3J0IDgt
Y2hhbm5lbCA5NmtIeiBhdWRpbyByZWxpYWJseSwgd2UgbmVlZCA1MTJrCi0JICogdG8gc2F0aXNm
eSBhbHNhIHdpdGggb3VyIHJlc3RyaWN0ZWQgcGVyaW9kIChFUlIwMDQzMjMpLgotCSAqLwotCXNu
ZF9wY21fbGliX3ByZWFsbG9jYXRlX3BhZ2VzX2Zvcl9hbGwocGNtLCBTTkRSVl9ETUFfVFlQRV9E
RVYsCi0JCQlkZXYsIDEyOCAqIDEwMjQsIDEwMjQgKiAxMDI0KTsKLQogCXJldCA9IHNuZF9jYXJk
X3JlZ2lzdGVyKGNhcmQpOwogCWlmIChyZXQgPCAwKQogCQlnb3RvIGVycjsKLS0gCjIuMTYuNAoK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVs
IG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlz
dHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
