Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id AE93B553EF
	for <lists+dri-devel@lfdr.de>; Tue, 25 Jun 2019 18:05:50 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6FE966E15E;
	Tue, 25 Jun 2019 16:05:47 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ed1-x543.google.com (mail-ed1-x543.google.com
 [IPv6:2a00:1450:4864:20::543])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2C3916E15B
 for <dri-devel@lists.freedesktop.org>; Tue, 25 Jun 2019 16:05:45 +0000 (UTC)
Received: by mail-ed1-x543.google.com with SMTP id w20so20286624edd.2
 for <dri-devel@lists.freedesktop.org>; Tue, 25 Jun 2019 09:05:45 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:sender:date:from:to:cc:subject:message-id
 :references:mime-version:content-disposition
 :content-transfer-encoding:in-reply-to:user-agent;
 bh=sGB9SvuW2hES54dOIeC+whf+4WaMdDb3fW1lYJGfLp8=;
 b=FdoTjM0mFEszmF2CjYUaZ2N2NVmJ+I5EnV1n9fQ0Illg+bkP9dhCjl+m8sNlwtP6Fh
 4tqVkBlR6zCgUIaL31VapTsjzocrzkVhUQeIuq9LE7VJTH60Ch90XKHB3XTb6K85/Lmy
 ZNcPcpb5jbS//WspZWiwbFu3QSHQfWyT1DQhNt7JQyNStoRJ8Ev5zwR91c+4B0Rn7vWv
 7E261SjPZFCgVPogJAk+aos/C5DBukikpnvsH7+ehYN8r4d/yoQTkDitnv9TKKzTPFPe
 kzwwGsqY/9dNO+ofJYKdiGj/xtB+FCFlH9pbeU3wzfEbI3Y+TXkaWihgSQLUYy8VcEU2
 qq5A==
X-Gm-Message-State: APjAAAVhDGwfmGR6NERpDR+vq+zW3g774E9R2CJkzkfY76ab6kazoOpE
 1AVQDFFzulwXoQSJfoi0yA5MtQ==
X-Google-Smtp-Source: APXvYqyGVGkNNrBx8BNe91yprohHeNDmaPakLdMkUUhRZuew6ev1g9k4I31wPE2IV1o3GZ1O4Tut/Q==
X-Received: by 2002:a50:b388:: with SMTP id s8mr103073567edd.15.1561478743639; 
 Tue, 25 Jun 2019 09:05:43 -0700 (PDT)
Received: from phenom.ffwll.local ([2a02:168:569e:0:3106:d637:d723:e855])
 by smtp.gmail.com with ESMTPSA id k1sm2489260eja.35.2019.06.25.09.05.41
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Tue, 25 Jun 2019 09:05:41 -0700 (PDT)
Date: Tue, 25 Jun 2019 18:05:39 +0200
From: Daniel Vetter <daniel@ffwll.ch>
To: Christian =?iso-8859-1?Q?K=F6nig?= <ckoenig.leichtzumerken@gmail.com>
Subject: Re: [Intel-gfx] [PATCH 1/6] dma-buf: add dynamic DMA-buf handling v12
Message-ID: <20190625160539.GB12905@phenom.ffwll.local>
References: <20190625124654.122364-1-christian.koenig@amd.com>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <20190625124654.122364-1-christian.koenig@amd.com>
X-Operating-System: Linux phenom 4.19.0-5-amd64 
User-Agent: Mutt/1.10.1 (2018-07-13)
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ffwll.ch; s=google;
 h=sender:date:from:to:cc:subject:message-id:references:mime-version
 :content-disposition:content-transfer-encoding:in-reply-to
 :user-agent;
 bh=sGB9SvuW2hES54dOIeC+whf+4WaMdDb3fW1lYJGfLp8=;
 b=eg/HexC2TheOQlKu159lUH9kMpji+yRAukArEQEILIZCdz54HkZEBPt62KthyKEI20
 3XcVANw6/zNi4RliUr12+bTmlQxK8qVXn6eVVzRAR9QwwLgqC2s2u78NLISwlwgNW/6J
 JgjgQR+iL2AeBzk6eN5i41psLdXRO61HfgMq8=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: intel-gfx@lists.freedesktop.org, amd-gfx@lists.freedesktop.org,
 dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gVHVlLCBKdW4gMjUsIDIwMTkgYXQgMDI6NDY6NDlQTSArMDIwMCwgQ2hyaXN0aWFuIEvDtm5p
ZyB3cm90ZToKPiBPbiB0aGUgZXhwb3J0ZXIgc2lkZSB3ZSBhZGQgb3B0aW9uYWwgZXhwbGljaXQg
cGlubmluZyBjYWxsYmFja3MuIElmIHRob3NlCj4gY2FsbGJhY2tzIGFyZSBpbXBsZW1lbnRlZCB0
aGUgZnJhbWV3b3JrIG5vIGxvbmdlciBjYWNoZXMgc2cgdGFibGVzIGFuZCB0aGUKPiBtYXAvdW5t
YXAgY2FsbGJhY2tzIGFyZSBhbHdheXMgY2FsbGVkIHdpdGggdGhlIGxvY2sgb2YgdGhlIHJlc2Vy
dmF0aW9uIG9iamVjdAo+IGhlbGQuCj4gCj4gT24gdGhlIGltcG9ydGVyIHNpZGUgd2UgYWRkIGFu
IG9wdGlvbmFsIGludmFsaWRhdGUgY2FsbGJhY2suIFRoaXMgY2FsbGJhY2sgaXMKPiB1c2VkIGJ5
IHRoZSBleHBvcnRlciB0byBpbmZvcm0gdGhlIGltcG9ydGVycyB0aGF0IHRoZWlyIG1hcHBpbmdz
IHNob3VsZCBiZQo+IGRlc3Ryb3llZCBhcyBzb29uIGFzIHBvc3NpYmxlLgo+IAo+IFRoaXMgYWxs
b3dzIHRoZSBleHBvcnRlciB0byBwcm92aWRlIHRoZSBtYXBwaW5ncyB3aXRob3V0IHRoZSBuZWVk
IHRvIHBpbgo+IHRoZSBiYWNraW5nIHN0b3JlLgo+IAo+IHYyOiBkb24ndCB0cnkgdG8gaW52YWxp
ZGF0ZSBtYXBwaW5ncyB3aGVuIHRoZSBjYWxsYmFjayBpcyBOVUxMLAo+ICAgICBsb2NrIHRoZSBy
ZXNlcnZhdGlvbiBvYmogd2hpbGUgdXNpbmcgdGhlIGF0dGFjaG1lbnRzLAo+ICAgICBhZGQgaGVs
cGVyIHRvIHNldCB0aGUgY2FsbGJhY2sKPiB2MzogbW92ZSBmbGFnIGZvciBpbnZhbGlkYXRpb24g
c3VwcG9ydCBpbnRvIHRoZSBETUEtYnVmLAo+ICAgICB1c2UgbmV3IGF0dGFjaF9pbmZvIHN0cnVj
dHVyZSB0byBzZXQgdGhlIGNhbGxiYWNrCj4gdjQ6IHVzZSBpbXBvcnRlcl9wcml2IGZpZWxkIGlu
c3RlYWQgb2YgbWFuZ2xpbmcgZXhwb3J0ZXIgcHJpdi4KPiB2NTogZHJvcCBpbnZhbGlkYXRpb25f
c3VwcG9ydGVkIGZsYWcKPiB2Njogc3F1YXNoIHRvZ2V0aGVyIHdpdGggcGluL3VucGluIGNoYW5n
ZXMKPiB2NzogcGluL3VucGluIHRha2VzIGFuIGF0dGFjaG1lbnQgbm93Cj4gdjg6IG51a2UgZG1h
X2J1Zl9hdHRhY2htZW50XyhtYXB8dW5tYXApX2xvY2tlZCwKPiAgICAgZXZlcnl0aGluZyBpcyBu
b3cgaGFuZGxlZCBiYWNrd2FyZCBjb21wYXRpYmxlCj4gdjk6IGFsd2F5cyBjYWNoZSB3aGVuIGV4
cG9ydC9pbXBvcnRlciBkb24ndCBhZ3JlZSBvbiBkeW5hbWljIGhhbmRsaW5nCj4gdjEwOiBtaW5p
bWFsIHN0eWxlIGNsZWFudXAKPiB2MTE6IGRyb3AgYXV0b21hdGljYWxseSByZS1lbnRyeSBhdm9p
ZGFuY2UKPiB2MTI6IHJlbmFtZSBjYWxsYmFjayB0byBtb3ZlX25vdGlmeQo+IAo+IFNpZ25lZC1v
ZmYtYnk6IENocmlzdGlhbiBLw7ZuaWcgPGNocmlzdGlhbi5rb2VuaWdAYW1kLmNvbT4KCk9uZSB0
aGluZyBJJ3ZlIGZvcmdvdHRlbiwganVzdCBzdHVtYmxlZCBvdmVyIHR0bV9iby0+bW92aW5nLiBG
b3IgcGlubmVkCmJ1ZmZlciBzaGFyaW5nIHRoYXQncyBub3QgbmVlZGVkLCBhbmQgSSB0aGluayBm
b3IgZHluYW1pYyBidWZmZXIgc2hhcmluZwppdCdzIGFsc28gbm90IGdvaW5nIHRvIGJlIHRoZSBw
cmltYXJ5IHJlcXVpcmVtZW50LiBCdXQgSSB0aGluayB0aGVyZSdzIHR3bwpyZWFzb25zIHdlIHNo
b3VsZCBtYXliZSBsb29rIGludG8gbW92aW5nIHRoYXQgZnJvbSB0dG1fYm8gdG8gcmVzdl9vYmo6
CgotIFlvdSBzb3VuZCBsaWtlIHlvdSB3YW50IHRvIHVzZSB0aGlzIGEgbG90IG1vcmUsIGV2ZW4g
aW50ZXJuYWxseSBpbgogIGFtZGdwdS4gRm9yIHRoYXQgSSBkbyB0aGluayB0aGUgc2VwZWFyYXRl
IGRtYV9mZW5jZSBqdXN0IHRvIG1ha2Ugc3VyZQogIHRoZSBidWZmZXIgaXMgYWNjZXNzaWJsZSB3
aWxsIGJlIG5lZWRlZCBpbiByZXN2X29iai4KCi0gT25jZSB3ZSBoYXZlIC0+bW92aW5nIEkgdGhp
bmsgdGhlcmUncyBzb21lIGdvb2QgY2hhbmNlcyB0byBleHRyYWN0IGEgYml0CiAgb2YgdGhlIGV2
aWN0aW9uL3BpcGVsaW5lIGJvIG1vdmUgYm9pbGVycGxhdGUgZnJvbSB0dG0sIGFuZCBtYXliZSB1
c2UgaXQKICBpbiBvdGhlciBkcml2ZXJzLiBpOTE1IGNvdWxkIGFscmVhZHkgbWFrZSB1c2Ugb2Yg
dGhpcyBpbiB1cHN0cmVhbSwgc2luY2UKICB3ZSBhbHJlYWR5IHBpcGVsaW5lIGdldF9wYWdlcyBh
bmQgY2xmbHVzaCBvZiBidWZmZXJzLiBPZmMgb25jZSB3ZSBoYXZlCiAgdnJhbSBzdXBwb3J0LCBl
dmVuIG1vcmUgdXNlZnVsLgoKQW5kIGRvaW5nIHRoYXQgc2xpZ2h0IHNlbWFudGljIGNoYW5nZSBp
cyBtdWNoIGVhc2llciBvbmNlIHdlIG9ubHkgaGF2ZSBhCmZldyBkeW5hbWljIGV4cG9ydGVycy9p
bXBvcnRlcnMuIEFuZCBzaW5jZSBpdCdzIGEgcHVyZSBvcHQtaW4gb3B0aW1pemF0aW9uCih5b3Ug
Y2FuIGFsd2F5cyBmYWxsIGJhY2sgdG8gdGhlIGV4Y2x1c2l2ZSBmZW5jZSkgaXQgc2hvdWxkIGJl
IGVhc3kgdG8Kcm9sbCBvdXQuCgpUaG91Z2h0cyBhYm91dCBtb3ZpbmcgdHRtX2JvLT5tb3Zpbmcg
dG8gcmVzdl9vYmo/IE9mYyBzdHJpY3RseSBvbmx5IGFzIGEKZm9sbG93IHVwLiBQbHVzIG1heWJl
IHdpdGggYSBjbGVhcmVyIG5hbWUgOi0pCgpDaGVlcnMsIERhbmllbAoKPiAtLS0KPiAgZHJpdmVy
cy9kbWEtYnVmL2RtYS1idWYuYyB8IDE3OSArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKystLQo+ICBpbmNsdWRlL2xpbnV4L2RtYS1idWYuaCAgIHwgMTA4ICsrKysrKysrKysrKysr
KysrKysrKy0tCj4gIDIgZmlsZXMgY2hhbmdlZCwgMjczIGluc2VydGlvbnMoKyksIDE0IGRlbGV0
aW9ucygtKQo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2RtYS1idWYvZG1hLWJ1Zi5jIGIvZHJp
dmVycy9kbWEtYnVmL2RtYS1idWYuYwo+IGluZGV4IDZjMTVkZWI1ZDRhZC4uMjE2Zjc2MTA5ZjNm
IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtYnVmLmMKPiArKysgYi9kcml2ZXJz
L2RtYS1idWYvZG1hLWJ1Zi5jCj4gQEAgLTUzMSw2ICs1MzEsOSBAQCBzdHJ1Y3QgZG1hX2J1ZiAq
ZG1hX2J1Zl9leHBvcnQoY29uc3Qgc3RydWN0IGRtYV9idWZfZXhwb3J0X2luZm8gKmV4cF9pbmZv
KQo+ICAJCXJldHVybiBFUlJfUFRSKC1FSU5WQUwpOwo+ICAJfQo+ICAKPiArCWlmIChXQVJOX09O
KGV4cF9pbmZvLT5vcHMtPmNhY2hlX3NndF9tYXBwaW5nICYmIGV4cF9pbmZvLT5vcHMtPnBpbikp
Cj4gKwkJcmV0dXJuIEVSUl9QVFIoLUVJTlZBTCk7Cj4gKwo+ICAJaWYgKCF0cnlfbW9kdWxlX2dl
dChleHBfaW5mby0+b3duZXIpKQo+ICAJCXJldHVybiBFUlJfUFRSKC1FTk9FTlQpOwo+ICAKPiBA
QCAtNjUxLDEwICs2NTQsMTIgQEAgdm9pZCBkbWFfYnVmX3B1dChzdHJ1Y3QgZG1hX2J1ZiAqZG1h
YnVmKQo+ICBFWFBPUlRfU1lNQk9MX0dQTChkbWFfYnVmX3B1dCk7Cj4gIAo+ICAvKioKPiAtICog
ZG1hX2J1Zl9hdHRhY2ggLSBBZGQgdGhlIGRldmljZSB0byBkbWFfYnVmJ3MgYXR0YWNobWVudHMg
bGlzdDsgb3B0aW9uYWxseSwKPiArICogZG1hX2J1Zl9keW5hbWljX2F0dGFjaCAtIEFkZCB0aGUg
ZGV2aWNlIHRvIGRtYV9idWYncyBhdHRhY2htZW50cyBsaXN0OyBvcHRpb25hbGx5LAo+ICAgKiBj
YWxscyBhdHRhY2goKSBvZiBkbWFfYnVmX29wcyB0byBhbGxvdyBkZXZpY2Utc3BlY2lmaWMgYXR0
YWNoIGZ1bmN0aW9uYWxpdHkKPiAtICogQGRtYWJ1ZjoJW2luXQlidWZmZXIgdG8gYXR0YWNoIGRl
dmljZSB0by4KPiAtICogQGRldjoJW2luXQlkZXZpY2UgdG8gYmUgYXR0YWNoZWQuCj4gKyAqIEBk
bWFidWY6CQlbaW5dCWJ1ZmZlciB0byBhdHRhY2ggZGV2aWNlIHRvLgo+ICsgKiBAZGV2OgkJW2lu
XQlkZXZpY2UgdG8gYmUgYXR0YWNoZWQuCj4gKyAqIEBpbXBvcnRlcl9vcHMJW2luXQlpbXBvcnRl
ciBvcGVyYXRpb25zIGZvciB0aGUgYXR0YWNobWVudAo+ICsgKiBAaW1wb3J0ZXJfcHJpdglbaW5d
CWltcG9ydGVyIHByaXZhdGUgcG9pbnRlciBmb3IgdGhlIGF0dGFjaG1lbnQKPiAgICoKPiAgICog
UmV0dXJucyBzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50IHBvaW50ZXIgZm9yIHRoaXMgYXR0YWNo
bWVudC4gQXR0YWNobWVudHMKPiAgICogbXVzdCBiZSBjbGVhbmVkIHVwIGJ5IGNhbGxpbmcgZG1h
X2J1Zl9kZXRhY2goKS4KPiBAQCAtNjY4LDggKzY3MywxMCBAQCBFWFBPUlRfU1lNQk9MX0dQTChk
bWFfYnVmX3B1dCk7Cj4gICAqIGFjY2Vzc2libGUgdG8gQGRldiwgYW5kIGNhbm5vdCBiZSBtb3Zl
ZCB0byBhIG1vcmUgc3VpdGFibGUgcGxhY2UuIFRoaXMgaXMKPiAgICogaW5kaWNhdGVkIHdpdGgg
dGhlIGVycm9yIGNvZGUgLUVCVVNZLgo+ICAgKi8KPiAtc3RydWN0IGRtYV9idWZfYXR0YWNobWVu
dCAqZG1hX2J1Zl9hdHRhY2goc3RydWN0IGRtYV9idWYgKmRtYWJ1ZiwKPiAtCQkJCQkgIHN0cnVj
dCBkZXZpY2UgKmRldikKPiArc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCAqCj4gK2RtYV9idWZf
ZHluYW1pY19hdHRhY2goc3RydWN0IGRtYV9idWYgKmRtYWJ1Ziwgc3RydWN0IGRldmljZSAqZGV2
LAo+ICsJCSAgICAgICBjb25zdCBzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2hfb3BzICppbXBvcnRlcl9v
cHMsCj4gKwkJICAgICAgIHZvaWQgKmltcG9ydGVyX3ByaXYpCj4gIHsKPiAgCXN0cnVjdCBkbWFf
YnVmX2F0dGFjaG1lbnQgKmF0dGFjaDsKPiAgCWludCByZXQ7Cj4gQEAgLTY4Myw2ICs2OTAsOCBA
QCBzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICpkbWFfYnVmX2F0dGFjaChzdHJ1Y3QgZG1hX2J1
ZiAqZG1hYnVmLAo+ICAKPiAgCWF0dGFjaC0+ZGV2ID0gZGV2Owo+ICAJYXR0YWNoLT5kbWFidWYg
PSBkbWFidWY7Cj4gKwlhdHRhY2gtPmltcG9ydGVyX29wcyA9IGltcG9ydGVyX29wczsKPiArCWF0
dGFjaC0+aW1wb3J0ZXJfcHJpdiA9IGltcG9ydGVyX3ByaXY7Cj4gIAo+ICAJbXV0ZXhfbG9jaygm
ZG1hYnVmLT5sb2NrKTsKPiAgCj4gQEAgLTY5MSwxNiArNzAwLDcyIEBAIHN0cnVjdCBkbWFfYnVm
X2F0dGFjaG1lbnQgKmRtYV9idWZfYXR0YWNoKHN0cnVjdCBkbWFfYnVmICpkbWFidWYsCj4gIAkJ
aWYgKHJldCkKPiAgCQkJZ290byBlcnJfYXR0YWNoOwo+ICAJfQo+ICsJcmVzZXJ2YXRpb25fb2Jq
ZWN0X2xvY2soZG1hYnVmLT5yZXN2LCBOVUxMKTsKPiAgCWxpc3RfYWRkKCZhdHRhY2gtPm5vZGUs
ICZkbWFidWYtPmF0dGFjaG1lbnRzKTsKPiArCXJlc2VydmF0aW9uX29iamVjdF91bmxvY2soZG1h
YnVmLT5yZXN2KTsKPiAgCj4gIAltdXRleF91bmxvY2soJmRtYWJ1Zi0+bG9jayk7Cj4gIAo+ICsJ
LyogV2hlbiBlaXRoZXIgdGhlIGltcG9ydGVyIG9yIHRoZSBleHBvcnRlciBjYW4ndCBoYW5kbGUg
ZHluYW1pYwo+ICsJICogbWFwcGluZ3Mgd2UgY2FjaGUgdGhlIG1hcHBpbmcgaGVyZSB0byBhdm9p
ZCBpc3N1ZXMgd2l0aCB0aGUKPiArCSAqIHJlc2VydmF0aW9uIG9iamVjdCBsb2NrLgo+ICsJICov
Cj4gKwlpZiAoZG1hX2J1Zl9hdHRhY2htZW50X2lzX2R5bmFtaWMoYXR0YWNoKSAhPQo+ICsJICAg
IGRtYV9idWZfaXNfZHluYW1pYyhkbWFidWYpKSB7Cj4gKwkJc3RydWN0IHNnX3RhYmxlICpzZ3Q7
Cj4gKwo+ICsJCWlmIChkbWFfYnVmX2lzX2R5bmFtaWMoYXR0YWNoLT5kbWFidWYpKSB7Cj4gKwkJ
CXJlc2VydmF0aW9uX29iamVjdF9sb2NrKGF0dGFjaC0+ZG1hYnVmLT5yZXN2LCBOVUxMKTsKPiAr
CQkJcmV0ID0gZG1hX2J1Zl9waW4oYXR0YWNoKTsKPiArCQkJaWYgKHJldCkKPiArCQkJCWdvdG8g
ZXJyX3VubG9jazsKPiArCQl9Cj4gKwo+ICsJCXNndCA9IGRtYWJ1Zi0+b3BzLT5tYXBfZG1hX2J1
ZihhdHRhY2gsIERNQV9CSURJUkVDVElPTkFMKTsKPiArCQlpZiAoIXNndCkKPiArCQkJc2d0ID0g
RVJSX1BUUigtRU5PTUVNKTsKPiArCQlpZiAoSVNfRVJSKHNndCkpIHsKPiArCQkJcmV0ID0gUFRS
X0VSUihzZ3QpOwo+ICsJCQlnb3RvIGVycl91bnBpbjsKPiArCQl9Cj4gKwkJaWYgKGRtYV9idWZf
aXNfZHluYW1pYyhhdHRhY2gtPmRtYWJ1ZikpCj4gKwkJCXJlc2VydmF0aW9uX29iamVjdF91bmxv
Y2soYXR0YWNoLT5kbWFidWYtPnJlc3YpOwo+ICsJCWF0dGFjaC0+c2d0ID0gc2d0Owo+ICsJCWF0
dGFjaC0+ZGlyID0gRE1BX0JJRElSRUNUSU9OQUw7Cj4gKwl9Cj4gKwo+ICAJcmV0dXJuIGF0dGFj
aDsKPiAgCj4gIGVycl9hdHRhY2g6Cj4gIAlrZnJlZShhdHRhY2gpOwo+ICAJbXV0ZXhfdW5sb2Nr
KCZkbWFidWYtPmxvY2spOwo+ICAJcmV0dXJuIEVSUl9QVFIocmV0KTsKPiArCj4gK2Vycl91bnBp
bjoKPiArCWlmIChkbWFfYnVmX2lzX2R5bmFtaWMoYXR0YWNoLT5kbWFidWYpKQo+ICsJCWRtYV9i
dWZfdW5waW4oYXR0YWNoKTsKPiArCj4gK2Vycl91bmxvY2s6Cj4gKwlpZiAoZG1hX2J1Zl9pc19k
eW5hbWljKGF0dGFjaC0+ZG1hYnVmKSkKPiArCQlyZXNlcnZhdGlvbl9vYmplY3RfdW5sb2NrKGF0
dGFjaC0+ZG1hYnVmLT5yZXN2KTsKPiArCj4gKwlkbWFfYnVmX2RldGFjaChkbWFidWYsIGF0dGFj
aCk7Cj4gKwlyZXR1cm4gRVJSX1BUUihyZXQpOwo+ICt9Cj4gK0VYUE9SVF9TWU1CT0xfR1BMKGRt
YV9idWZfZHluYW1pY19hdHRhY2gpOwo+ICsKPiArLyoqCj4gKyAqIGRtYV9idWZfYXR0YWNoIC0g
V3JhcHBlciBmb3IgZG1hX2J1Zl9keW5hbWljX2F0dGFjaAo+ICsgKiBAZG1hYnVmOglbaW5dCWJ1
ZmZlciB0byBhdHRhY2ggZGV2aWNlIHRvLgo+ICsgKiBAZGV2OglbaW5dCWRldmljZSB0byBiZSBh
dHRhY2hlZC4KPiArICoKPiArICogV3JhcHBlciB0byBjYWxsIGRtYV9idWZfZHluYW1pY19hdHRh
Y2goKSBmb3IgZHJpdmVycyB3aGljaCBzdGlsbCB1c2UgYSBzdGF0aWMKPiArICogbWFwcGluZy4K
PiArICovCj4gK3N0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmRtYV9idWZfYXR0YWNoKHN0cnVj
dCBkbWFfYnVmICpkbWFidWYsCj4gKwkJCQkJICBzdHJ1Y3QgZGV2aWNlICpkZXYpCj4gK3sKPiAr
CXJldHVybiBkbWFfYnVmX2R5bmFtaWNfYXR0YWNoKGRtYWJ1ZiwgZGV2LCBOVUxMLCBOVUxMKTsK
PiAgfQo+ICBFWFBPUlRfU1lNQk9MX0dQTChkbWFfYnVmX2F0dGFjaCk7Cj4gIAo+IEBAIC03MTcs
MTEgKzc4MiwyMiBAQCB2b2lkIGRtYV9idWZfZGV0YWNoKHN0cnVjdCBkbWFfYnVmICpkbWFidWYs
IHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFjaCkKPiAgCWlmIChXQVJOX09OKCFkbWFi
dWYgfHwgIWF0dGFjaCkpCj4gIAkJcmV0dXJuOwo+ICAKPiAtCWlmIChhdHRhY2gtPnNndCkKPiAr
CWlmIChhdHRhY2gtPnNndCkgewo+ICsJCWlmIChkbWFfYnVmX2lzX2R5bmFtaWMoYXR0YWNoLT5k
bWFidWYpKQo+ICsJCQlyZXNlcnZhdGlvbl9vYmplY3RfbG9jayhhdHRhY2gtPmRtYWJ1Zi0+cmVz
diwgTlVMTCk7Cj4gKwo+ICAJCWRtYWJ1Zi0+b3BzLT51bm1hcF9kbWFfYnVmKGF0dGFjaCwgYXR0
YWNoLT5zZ3QsIGF0dGFjaC0+ZGlyKTsKPiAgCj4gKwkJaWYgKGRtYV9idWZfaXNfZHluYW1pYyhh
dHRhY2gtPmRtYWJ1ZikpIHsKPiArCQkJZG1hX2J1Zl91bnBpbihhdHRhY2gpOwo+ICsJCQlyZXNl
cnZhdGlvbl9vYmplY3RfdW5sb2NrKGF0dGFjaC0+ZG1hYnVmLT5yZXN2KTsKPiArCQl9Cj4gKwl9
Cj4gKwo+ICAJbXV0ZXhfbG9jaygmZG1hYnVmLT5sb2NrKTsKPiArCXJlc2VydmF0aW9uX29iamVj
dF9sb2NrKGRtYWJ1Zi0+cmVzdiwgTlVMTCk7Cj4gIAlsaXN0X2RlbCgmYXR0YWNoLT5ub2RlKTsK
PiArCXJlc2VydmF0aW9uX29iamVjdF91bmxvY2soZG1hYnVmLT5yZXN2KTsKPiAgCWlmIChkbWFi
dWYtPm9wcy0+ZGV0YWNoKQo+ICAJCWRtYWJ1Zi0+b3BzLT5kZXRhY2goZG1hYnVmLCBhdHRhY2gp
Owo+ICAKPiBAQCAtNzMwLDYgKzgwNiw0NCBAQCB2b2lkIGRtYV9idWZfZGV0YWNoKHN0cnVjdCBk
bWFfYnVmICpkbWFidWYsIHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFjaCkKPiAgfQo+
ICBFWFBPUlRfU1lNQk9MX0dQTChkbWFfYnVmX2RldGFjaCk7Cj4gIAo+ICsvKioKPiArICogZG1h
X2J1Zl9waW4gLSBMb2NrIGRvd24gdGhlIERNQS1idWYKPiArICoKPiArICogQGF0dGFjaDoJW2lu
XQlhdHRhY2htZW50IHdoaWNoIHNob3VsZCBiZSBwaW5uZWQKPiArICoKPiArICogUmV0dXJuczoK
PiArICogMCBvbiBzdWNjZXNzLCBuZWdhdGl2ZSBlcnJvciBjb2RlIG9uIGZhaWx1cmUuCj4gKyAq
Lwo+ICtpbnQgZG1hX2J1Zl9waW4oc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCAqYXR0YWNoKQo+
ICt7Cj4gKwlzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmID0gYXR0YWNoLT5kbWFidWY7Cj4gKwlpbnQg
cmV0ID0gMDsKPiArCj4gKwlyZXNlcnZhdGlvbl9vYmplY3RfYXNzZXJ0X2hlbGQoZG1hYnVmLT5y
ZXN2KTsKPiArCj4gKwlpZiAoZG1hYnVmLT5vcHMtPnBpbikKPiArCQlyZXQgPSBkbWFidWYtPm9w
cy0+cGluKGF0dGFjaCk7Cj4gKwo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICtFWFBPUlRfU1lNQk9M
X0dQTChkbWFfYnVmX3Bpbik7Cj4gKwo+ICsvKioKPiArICogZG1hX2J1Zl91bnBpbiAtIFJlbW92
ZSBsb2NrIGZyb20gRE1BLWJ1Zgo+ICsgKgo+ICsgKiBAYXR0YWNoOglbaW5dCWF0dGFjaG1lbnQg
d2hpY2ggc2hvdWxkIGJlIHVucGlubmVkCj4gKyAqLwo+ICt2b2lkIGRtYV9idWZfdW5waW4oc3Ry
dWN0IGRtYV9idWZfYXR0YWNobWVudCAqYXR0YWNoKQo+ICt7Cj4gKwlzdHJ1Y3QgZG1hX2J1ZiAq
ZG1hYnVmID0gYXR0YWNoLT5kbWFidWY7Cj4gKwo+ICsJcmVzZXJ2YXRpb25fb2JqZWN0X2Fzc2Vy
dF9oZWxkKGRtYWJ1Zi0+cmVzdik7Cj4gKwo+ICsJaWYgKGRtYWJ1Zi0+b3BzLT51bnBpbikKPiAr
CQlkbWFidWYtPm9wcy0+dW5waW4oYXR0YWNoKTsKPiArfQo+ICtFWFBPUlRfU1lNQk9MX0dQTChk
bWFfYnVmX3VucGluKTsKPiArCj4gIC8qKgo+ICAgKiBkbWFfYnVmX21hcF9hdHRhY2htZW50IC0g
UmV0dXJucyB0aGUgc2NhdHRlcmxpc3QgdGFibGUgb2YgdGhlIGF0dGFjaG1lbnQ7Cj4gICAqIG1h
cHBlZCBpbnRvIF9kZXZpY2VfIGFkZHJlc3Mgc3BhY2UuIElzIGEgd3JhcHBlciBmb3IgbWFwX2Rt
YV9idWYoKSBvZiB0aGUKPiBAQCAtNzQ5LDYgKzg2Myw3IEBAIHN0cnVjdCBzZ190YWJsZSAqZG1h
X2J1Zl9tYXBfYXR0YWNobWVudChzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICphdHRhY2gsCj4g
IAkJCQkJZW51bSBkbWFfZGF0YV9kaXJlY3Rpb24gZGlyZWN0aW9uKQo+ICB7Cj4gIAlzdHJ1Y3Qg
c2dfdGFibGUgKnNnX3RhYmxlOwo+ICsJaW50IHI7Cj4gIAo+ICAJbWlnaHRfc2xlZXAoKTsKPiAg
Cj4gQEAgLTc2NywxMCArODgyLDI5IEBAIHN0cnVjdCBzZ190YWJsZSAqZG1hX2J1Zl9tYXBfYXR0
YWNobWVudChzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICphdHRhY2gsCj4gIAkJcmV0dXJuIGF0
dGFjaC0+c2d0Owo+ICAJfQo+ICAKPiArCWlmIChkbWFfYnVmX2F0dGFjaG1lbnRfaXNfZHluYW1p
YyhhdHRhY2gpKSB7Cj4gKwkJcmVzZXJ2YXRpb25fb2JqZWN0X2Fzc2VydF9oZWxkKGF0dGFjaC0+
ZG1hYnVmLT5yZXN2KTsKPiArCj4gKwl9IGVsc2UgaWYgKGRtYV9idWZfaXNfZHluYW1pYyhhdHRh
Y2gtPmRtYWJ1ZikpIHsKPiArCQlyZXNlcnZhdGlvbl9vYmplY3RfbG9jayhhdHRhY2gtPmRtYWJ1
Zi0+cmVzdiwgTlVMTCk7Cj4gKwkJciA9IGRtYV9idWZfcGluKGF0dGFjaCk7Cj4gKwkJaWYgKHIp
IHsKPiArCQkJcmVzZXJ2YXRpb25fb2JqZWN0X3VubG9jayhhdHRhY2gtPmRtYWJ1Zi0+cmVzdik7
Cj4gKwkJCXJldHVybiBFUlJfUFRSKHIpOwo+ICsJCX0KPiArCX0KPiArCj4gIAlzZ190YWJsZSA9
IGF0dGFjaC0+ZG1hYnVmLT5vcHMtPm1hcF9kbWFfYnVmKGF0dGFjaCwgZGlyZWN0aW9uKTsKPiAg
CWlmICghc2dfdGFibGUpCj4gIAkJc2dfdGFibGUgPSBFUlJfUFRSKC1FTk9NRU0pOwo+ICAKPiAr
CWlmICghZG1hX2J1Zl9hdHRhY2htZW50X2lzX2R5bmFtaWMoYXR0YWNoKSAmJgo+ICsJICAgIGRt
YV9idWZfaXNfZHluYW1pYyhhdHRhY2gtPmRtYWJ1ZikpIHsKPiArCQlpZiAoSVNfRVJSKHNnX3Rh
YmxlKSkKPiArCQkJZG1hX2J1Zl91bnBpbihhdHRhY2gpOwo+ICsJCXJlc2VydmF0aW9uX29iamVj
dF91bmxvY2soYXR0YWNoLT5kbWFidWYtPnJlc3YpOwo+ICsJfQo+ICsKPiAgCWlmICghSVNfRVJS
KHNnX3RhYmxlKSAmJiBhdHRhY2gtPmRtYWJ1Zi0+b3BzLT5jYWNoZV9zZ3RfbWFwcGluZykgewo+
ICAJCWF0dGFjaC0+c2d0ID0gc2dfdGFibGU7Cj4gIAkJYXR0YWNoLT5kaXIgPSBkaXJlY3Rpb247
Cj4gQEAgLTgwMiwxMCArOTM2LDQxIEBAIHZvaWQgZG1hX2J1Zl91bm1hcF9hdHRhY2htZW50KHN0
cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFjaCwKPiAgCWlmIChhdHRhY2gtPnNndCA9PSBz
Z190YWJsZSkKPiAgCQlyZXR1cm47Cj4gIAo+ICsJaWYgKGRtYV9idWZfYXR0YWNobWVudF9pc19k
eW5hbWljKGF0dGFjaCkpCj4gKwkJcmVzZXJ2YXRpb25fb2JqZWN0X2Fzc2VydF9oZWxkKGF0dGFj
aC0+ZG1hYnVmLT5yZXN2KTsKPiArCWVsc2UgaWYgKGRtYV9idWZfaXNfZHluYW1pYyhhdHRhY2gt
PmRtYWJ1ZikpCj4gKwkJcmVzZXJ2YXRpb25fb2JqZWN0X2xvY2soYXR0YWNoLT5kbWFidWYtPnJl
c3YsIE5VTEwpOwo+ICsKPiAgCWF0dGFjaC0+ZG1hYnVmLT5vcHMtPnVubWFwX2RtYV9idWYoYXR0
YWNoLCBzZ190YWJsZSwgZGlyZWN0aW9uKTsKPiArCj4gKwlpZiAoZG1hX2J1Zl9pc19keW5hbWlj
KGF0dGFjaC0+ZG1hYnVmKSAmJgo+ICsJICAgICFkbWFfYnVmX2F0dGFjaG1lbnRfaXNfZHluYW1p
YyhhdHRhY2gpKSB7Cj4gKwkJZG1hX2J1Zl91bnBpbihhdHRhY2gpOwo+ICsJCXJlc2VydmF0aW9u
X29iamVjdF91bmxvY2soYXR0YWNoLT5kbWFidWYtPnJlc3YpOwo+ICsJfQo+ICB9Cj4gIEVYUE9S
VF9TWU1CT0xfR1BMKGRtYV9idWZfdW5tYXBfYXR0YWNobWVudCk7Cj4gIAo+ICsvKioKPiArICog
ZG1hX2J1Zl9tb3ZlX25vdGlmeSAtIG5vdGlmeSBhdHRhY2htZW50cyB0aGF0IERNQS1idWYgaXMg
bW92aW5nCj4gKyAqCj4gKyAqIEBkbWFidWY6CVtpbl0JYnVmZmVyIHdoaWNoIGlzIG1vdmluZwo+
ICsgKgo+ICsgKiBJbmZvcm1zIGFsbCBhdHRhY2htZW5zdCB0aGF0IHRoZXkgbmVlZCB0byBkZXN0
cm95IGFuZCByZWNyZWF0ZWQgYWxsIHRoZWlyCj4gKyAqIG1hcHBpbmdzLgo+ICsgKi8KPiArdm9p
ZCBkbWFfYnVmX21vdmVfbm90aWZ5KHN0cnVjdCBkbWFfYnVmICpkbWFidWYpCj4gK3sKPiArCXN0
cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFjaDsKPiArCj4gKwlyZXNlcnZhdGlvbl9vYmpl
Y3RfYXNzZXJ0X2hlbGQoZG1hYnVmLT5yZXN2KTsKPiArCj4gKwlsaXN0X2Zvcl9lYWNoX2VudHJ5
KGF0dGFjaCwgJmRtYWJ1Zi0+YXR0YWNobWVudHMsIG5vZGUpCj4gKwkJaWYgKGF0dGFjaC0+aW1w
b3J0ZXJfb3BzICYmIGF0dGFjaC0+aW1wb3J0ZXJfb3BzLT5tb3ZlX25vdGlmeSkKPiArCQkJYXR0
YWNoLT5pbXBvcnRlcl9vcHMtPm1vdmVfbm90aWZ5KGF0dGFjaCk7Cj4gK30KPiArRVhQT1JUX1NZ
TUJPTF9HUEwoZG1hX2J1Zl9tb3ZlX25vdGlmeSk7Cj4gKwo+ICAvKioKPiAgICogRE9DOiBjcHUg
YWNjZXNzCj4gICAqCj4gQEAgLTEyMjUsMTAgKzEzOTAsMTIgQEAgc3RhdGljIGludCBkbWFfYnVm
X2RlYnVnX3Nob3coc3RydWN0IHNlcV9maWxlICpzLCB2b2lkICp1bnVzZWQpCj4gIAkJc2VxX3B1
dHMocywgIlx0QXR0YWNoZWQgRGV2aWNlczpcbiIpOwo+ICAJCWF0dGFjaF9jb3VudCA9IDA7Cj4g
IAo+ICsJCXJlc2VydmF0aW9uX29iamVjdF9sb2NrKGJ1Zl9vYmotPnJlc3YsIE5VTEwpOwo+ICAJ
CWxpc3RfZm9yX2VhY2hfZW50cnkoYXR0YWNoX29iaiwgJmJ1Zl9vYmotPmF0dGFjaG1lbnRzLCBu
b2RlKSB7Cj4gIAkJCXNlcV9wcmludGYocywgIlx0JXNcbiIsIGRldl9uYW1lKGF0dGFjaF9vYmot
PmRldikpOwo+ICAJCQlhdHRhY2hfY291bnQrKzsKPiAgCQl9Cj4gKwkJcmVzZXJ2YXRpb25fb2Jq
ZWN0X3VubG9jayhidWZfb2JqLT5yZXN2KTsKPiAgCj4gIAkJc2VxX3ByaW50ZihzLCAiVG90YWwg
JWQgZGV2aWNlcyBhdHRhY2hlZFxuXG4iLAo+ICAJCQkJYXR0YWNoX2NvdW50KTsKPiBkaWZmIC0t
Z2l0IGEvaW5jbHVkZS9saW51eC9kbWEtYnVmLmggYi9pbmNsdWRlL2xpbnV4L2RtYS1idWYuaAo+
IGluZGV4IDAxYWQ1Yjk0MmE2Zi4uY2NhZDJmYzFmNjQwIDEwMDY0NAo+IC0tLSBhL2luY2x1ZGUv
bGludXgvZG1hLWJ1Zi5oCj4gKysrIGIvaW5jbHVkZS9saW51eC9kbWEtYnVmLmgKPiBAQCAtOTIs
MTQgKzkyLDQwIEBAIHN0cnVjdCBkbWFfYnVmX29wcyB7Cj4gIAkgKi8KPiAgCXZvaWQgKCpkZXRh
Y2gpKHN0cnVjdCBkbWFfYnVmICosIHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKik7Cj4gIAo+
ICsJLyoqCj4gKwkgKiBAcGluOgo+ICsJICoKPiArCSAqIFRoaXMgaXMgY2FsbGVkIGJ5IGRtYV9i
dWZfcGluIGFuZCBsZXRzIHRoZSBleHBvcnRlciBrbm93IHRoYXQgdGhlCj4gKwkgKiBETUEtYnVm
IGNhbid0IGJlIG1vdmVkIGFueSBtb3JlLgo+ICsJICoKPiArCSAqIFRoaXMgaXMgY2FsbGVkIHdp
dGggdGhlIGRtYWJ1Zi0+cmVzdiBvYmplY3QgbG9ja2VkLgo+ICsJICoKPiArCSAqIFRoaXMgY2Fs
bGJhY2sgaXMgb3B0aW9uYWwuCj4gKwkgKgo+ICsJICogUmV0dXJuczoKPiArCSAqCj4gKwkgKiAw
IG9uIHN1Y2Nlc3MsIG5lZ2F0aXZlIGVycm9yIGNvZGUgb24gZmFpbHVyZS4KPiArCSAqLwo+ICsJ
aW50ICgqcGluKShzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICphdHRhY2gpOwo+ICsKPiArCS8q
Kgo+ICsJICogQHVucGluOgo+ICsJICoKPiArCSAqIFRoaXMgaXMgY2FsbGVkIGJ5IGRtYV9idWZf
dW5waW4gYW5kIGxldHMgdGhlIGV4cG9ydGVyIGtub3cgdGhhdCB0aGUKPiArCSAqIERNQS1idWYg
Y2FuIGJlIG1vdmVkIGFnYWluLgo+ICsJICoKPiArCSAqIFRoaXMgaXMgY2FsbGVkIHdpdGggdGhl
IGRtYWJ1Zi0+cmVzdiBvYmplY3QgbG9ja2VkLgo+ICsJICoKPiArCSAqIFRoaXMgY2FsbGJhY2sg
aXMgb3B0aW9uYWwuCj4gKwkgKi8KPiArCXZvaWQgKCp1bnBpbikoc3RydWN0IGRtYV9idWZfYXR0
YWNobWVudCAqYXR0YWNoKTsKPiArCj4gIAkvKioKPiAgCSAqIEBtYXBfZG1hX2J1ZjoKPiAgCSAq
Cj4gIAkgKiBUaGlzIGlzIGNhbGxlZCBieSBkbWFfYnVmX21hcF9hdHRhY2htZW50KCkgYW5kIGlz
IHVzZWQgdG8gbWFwIGEKPiAgCSAqIHNoYXJlZCAmZG1hX2J1ZiBpbnRvIGRldmljZSBhZGRyZXNz
IHNwYWNlLCBhbmQgaXQgaXMgbWFuZGF0b3J5LiBJdAo+IC0JICogY2FuIG9ubHkgYmUgY2FsbGVk
IGlmIEBhdHRhY2ggaGFzIGJlZW4gY2FsbGVkIHN1Y2Nlc3NmdWxseS4gVGhpcwo+IC0JICogZXNz
ZW50aWFsbHkgcGlucyB0aGUgRE1BIGJ1ZmZlciBpbnRvIHBsYWNlLCBhbmQgaXQgY2Fubm90IGJl
IG1vdmVkCj4gLQkgKiBhbnkgbW9yZQo+ICsJICogY2FuIG9ubHkgYmUgY2FsbGVkIGlmIEBhdHRh
Y2ggaGFzIGJlZW4gY2FsbGVkIHN1Y2Nlc3NmdWxseS4KPiAgCSAqCj4gIAkgKiBUaGlzIGNhbGwg
bWF5IHNsZWVwLCBlLmcuIHdoZW4gdGhlIGJhY2tpbmcgc3RvcmFnZSBmaXJzdCBuZWVkcyB0byBi
ZQo+ICAJICogYWxsb2NhdGVkLCBvciBtb3ZlZCB0byBhIGxvY2F0aW9uIHN1aXRhYmxlIGZvciBh
bGwgY3VycmVudGx5IGF0dGFjaGVkCj4gQEAgLTEyMCw2ICsxNDYsOSBAQCBzdHJ1Y3QgZG1hX2J1
Zl9vcHMgewo+ICAJICogYW55IG90aGVyIGtpbmQgb2Ygc2hhcmluZyB0aGF0IHRoZSBleHBvcnRl
ciBtaWdodCB3aXNoIHRvIG1ha2UKPiAgCSAqIGF2YWlsYWJsZSB0byBidWZmZXItdXNlcnMuCj4g
IAkgKgo+ICsJICogVGhpcyBpcyBhbHdheXMgY2FsbGVkIHdpdGggdGhlIGRtYWJ1Zi0+cmVzdiBv
YmplY3QgbG9ja2VkIHdoZW4KPiArCSAqIHRoZSBwaW4vdW5waW4gY2FsbGJhY2tzIGFyZSBpbXBs
ZW1lbnRlZC4KPiArCSAqCj4gIAkgKiBSZXR1cm5zOgo+ICAJICoKPiAgCSAqIEEgJnNnX3RhYmxl
IHNjYXR0ZXIgbGlzdCBvZiBvciB0aGUgYmFja2luZyBzdG9yYWdlIG9mIHRoZSBETUEgYnVmZmVy
LAo+IEBAIC0xMzcsOSArMTY2LDYgQEAgc3RydWN0IGRtYV9idWZfb3BzIHsKPiAgCSAqCj4gIAkg
KiBUaGlzIGlzIGNhbGxlZCBieSBkbWFfYnVmX3VubWFwX2F0dGFjaG1lbnQoKSBhbmQgc2hvdWxk
IHVubWFwIGFuZAo+ICAJICogcmVsZWFzZSB0aGUgJnNnX3RhYmxlIGFsbG9jYXRlZCBpbiBAbWFw
X2RtYV9idWYsIGFuZCBpdCBpcyBtYW5kYXRvcnkuCj4gLQkgKiBJdCBzaG91bGQgYWxzbyB1bnBp
biB0aGUgYmFja2luZyBzdG9yYWdlIGlmIHRoaXMgaXMgdGhlIGxhc3QgbWFwcGluZwo+IC0JICog
b2YgdGhlIERNQSBidWZmZXIsIGl0IHRoZSBleHBvcnRlciBzdXBwb3J0cyBiYWNraW5nIHN0b3Jh
Z2UKPiAtCSAqIG1pZ3JhdGlvbi4KPiAgCSAqLwo+ICAJdm9pZCAoKnVubWFwX2RtYV9idWYpKHN0
cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKiwKPiAgCQkJICAgICAgc3RydWN0IHNnX3RhYmxlICos
Cj4gQEAgLTMzMCw2ICszNTYsMzQgQEAgc3RydWN0IGRtYV9idWYgewo+ICAJfSBjYl9leGNsLCBj
Yl9zaGFyZWQ7Cj4gIH07Cj4gIAo+ICsvKioKPiArICogc3RydWN0IGRtYV9idWZfYXR0YWNoX29w
cyAtIGltcG9ydGVyIG9wZXJhdGlvbnMgZm9yIGFuIGF0dGFjaG1lbnQKPiArICogQG1vdmVfbm90
aWZ5OiBbb3B0aW9uYWxdIG5vdGlmaWNhdGlvbiB0aGF0IHRoZSBETUEtYnVmIGlzIG1vdmluZwo+
ICsgKgo+ICsgKiBBdHRhY2htZW50IG9wZXJhdGlvbnMgaW1wbGVtZW50ZWQgYnkgdGhlIGltcG9y
dGVyLgo+ICsgKi8KPiArc3RydWN0IGRtYV9idWZfYXR0YWNoX29wcyB7Cj4gKwkvKioKPiArCSAq
IEBtb3ZlX25vdGlmeQo+ICsJICoKPiArCSAqIElmIHRoaXMgY2FsbGJhY2sgaXMgcHJvdmlkZWQg
dGhlIGZyYW1ld29yayBjYW4gYXZvaWQgcGlubmluZyB0aGUKPiArCSAqIGJhY2tpbmcgc3RvcmUg
d2hpbGUgbWFwcGluZ3MgZXhpc3RzLgo+ICsJICoKPiArCSAqIFRoaXMgY2FsbGJhY2sgaXMgY2Fs
bGVkIHdpdGggdGhlIGxvY2sgb2YgdGhlIHJlc2VydmF0aW9uIG9iamVjdAo+ICsJICogYXNzb2Np
YXRlZCB3aXRoIHRoZSBkbWFfYnVmIGhlbGQgYW5kIHRoZSBtYXBwaW5nIGZ1bmN0aW9uIG11c3Qg
YmUKPiArCSAqIGNhbGxlZCB3aXRoIHRoaXMgbG9jayBoZWxkIGFzIHdlbGwuIFRoaXMgbWFrZXMg
c3VyZSB0aGF0IG5vIG1hcHBpbmcKPiArCSAqIGlzIGNyZWF0ZWQgY29uY3VycmVudGx5IHdpdGgg
YW4gb25nb2luZyBtb3ZlIG9wZXJhdGlvbi4KPiArCSAqCj4gKwkgKiBNYXBwaW5ncyBzdGF5IHZh
bGlkIGFuZCBhcmUgbm90IGRpcmVjdGx5IGFmZmVjdGVkIGJ5IHRoaXMgY2FsbGJhY2suCj4gKwkg
KiBCdXQgdGhlIERNQS1idWYgY2FuIG5vdyBiZSBpbiBhIGRpZmZlcmVudCBwaHlzaWNhbCBsb2Nh
dGlvbiwgc28gYWxsCj4gKwkgKiBtYXBwaW5ncyBzaG91bGQgYmUgZGVzdHJveWVkIGFuZCByZS1j
cmVhdGVkIGFzIHNvb24gYXMgcG9zc2libGUuCj4gKwkgKgo+ICsJICogTmV3IG1hcHBpbmdzIGNh
biBiZSBjcmVhdGVkIGFmdGVyIHRoaXMgY2FsbGJhY2sgcmV0dXJucywgYW5kIHdpbGwKPiArCSAq
IHBvaW50IHRvIHRoZSBuZXcgbG9jYXRpb24gb2YgdGhlIERNQS1idWYuCj4gKwkgKi8KPiArCXZv
aWQgKCptb3ZlX25vdGlmeSkoc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCAqYXR0YWNoKTsKPiAr
fTsKPiArCj4gIC8qKgo+ICAgKiBzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50IC0gaG9sZHMgZGV2
aWNlLWJ1ZmZlciBhdHRhY2htZW50IGRhdGEKPiAgICogQGRtYWJ1ZjogYnVmZmVyIGZvciB0aGlz
IGF0dGFjaG1lbnQuCj4gQEAgLTMzOCw2ICszOTIsOCBAQCBzdHJ1Y3QgZG1hX2J1ZiB7Cj4gICAq
IEBzZ3Q6IGNhY2hlZCBtYXBwaW5nLgo+ICAgKiBAZGlyOiBkaXJlY3Rpb24gb2YgY2FjaGVkIG1h
cHBpbmcuCj4gICAqIEBwcml2OiBleHBvcnRlciBzcGVjaWZpYyBhdHRhY2htZW50IGRhdGEuCj4g
KyAqIEBpbXBvcnRlcl9vcHM6IGltcG9ydGVyIG9wZXJhdGlvbnMgZm9yIHRoaXMgYXR0YWNobWVu
dC4KPiArICogQGltcG9ydGVyX3ByaXY6IGltcG9ydGVyIHNwZWNpZmljIGF0dGFjaG1lbnQgZGF0
YS4KPiAgICoKPiAgICogVGhpcyBzdHJ1Y3R1cmUgaG9sZHMgdGhlIGF0dGFjaG1lbnQgaW5mb3Jt
YXRpb24gYmV0d2VlbiB0aGUgZG1hX2J1ZiBidWZmZXIKPiAgICogYW5kIGl0cyB1c2VyIGRldmlj
ZShzKS4gVGhlIGxpc3QgY29udGFpbnMgb25lIGF0dGFjaG1lbnQgc3RydWN0IHBlciBkZXZpY2UK
PiBAQCAtMzU1LDYgKzQxMSw5IEBAIHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgewo+ICAJc3Ry
dWN0IHNnX3RhYmxlICpzZ3Q7Cj4gIAllbnVtIGRtYV9kYXRhX2RpcmVjdGlvbiBkaXI7Cj4gIAl2
b2lkICpwcml2Owo+ICsKPiArCWNvbnN0IHN0cnVjdCBkbWFfYnVmX2F0dGFjaF9vcHMgKmltcG9y
dGVyX29wczsKPiArCXZvaWQgKmltcG9ydGVyX3ByaXY7Cj4gIH07Cj4gIAo+ICAvKioKPiBAQCAt
NDA1LDEwICs0NjQsNDIgQEAgc3RhdGljIGlubGluZSB2b2lkIGdldF9kbWFfYnVmKHN0cnVjdCBk
bWFfYnVmICpkbWFidWYpCj4gIAlnZXRfZmlsZShkbWFidWYtPmZpbGUpOwo+ICB9Cj4gIAo+ICsv
KioKPiArICogZG1hX2J1Zl9pc19keW5hbWljIC0gY2hlY2sgaWYgYSBETUEtYnVmIHVzZXMgZHlu
YW1pYyBtYXBwaW5ncy4KPiArICogQGRtYWJ1ZjogdGhlIERNQS1idWYgdG8gY2hlY2sKPiArICoK
PiArICogUmV0dXJucyB0cnVlIGlmIGEgRE1BLWJ1ZiBleHBvcnRlciB3YW50cyB0byBjcmVhdGUg
ZHluYW1pYyBzZyB0YWJsZSBtYXBwaW5ncwo+ICsgKiBmb3IgZWFjaCBhdHRhY2htZW50LiBGYWxz
ZSBpZiBvbmx5IGEgc2luZ2xlIHN0YXRpYyBzZyB0YWJsZSBzaG91bGQgYmUgdXNlZC4KPiArICov
Cj4gK3N0YXRpYyBpbmxpbmUgYm9vbCBkbWFfYnVmX2lzX2R5bmFtaWMoc3RydWN0IGRtYV9idWYg
KmRtYWJ1ZikKPiArewo+ICsJcmV0dXJuICEhZG1hYnVmLT5vcHMtPnBpbjsKPiArfQo+ICsKPiAr
LyoqCj4gKyAqIGRtYV9idWZfYXR0YWNobWVudF9pc19keW5hbWljIC0gY2hlY2sgaWYgYSBETUEt
YnVmIGF0dGFjaG1lbnQgdXNlcyBkeW5hbWljCj4gKyAqIG1hcHBpbnNnCj4gKyAqIEBhdHRhY2g6
IHRoZSBETUEtYnVmIGF0dGFjaG1lbnQgdG8gY2hlY2sKPiArICoKPiArICogUmV0dXJucyB0cnVl
IGlmIGEgRE1BLWJ1ZiBpbXBvcnRlciB3YW50cyB0byB1c2UgZHluYW1pYyBzZyB0YWJsZSBtYXBw
aW5ncyBhbmQKPiArICogY2FsbHMgdGhlIG1hcC91bm1hcCBmdW5jdGlvbnMgd2l0aCB0aGUgcmVz
ZXJ2YXRpb24gb2JqZWN0IGxvY2tlZC4KPiArICovCj4gK3N0YXRpYyBpbmxpbmUgYm9vbAo+ICtk
bWFfYnVmX2F0dGFjaG1lbnRfaXNfZHluYW1pYyhzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICph
dHRhY2gpCj4gK3sKPiArCXJldHVybiBhdHRhY2gtPmltcG9ydGVyX29wcyAmJiBhdHRhY2gtPmlt
cG9ydGVyX29wcy0+bW92ZV9ub3RpZnk7Cj4gK30KPiArCj4gIHN0cnVjdCBkbWFfYnVmX2F0dGFj
aG1lbnQgKmRtYV9idWZfYXR0YWNoKHN0cnVjdCBkbWFfYnVmICpkbWFidWYsCj4gLQkJCQkJCQlz
dHJ1Y3QgZGV2aWNlICpkZXYpOwo+ICsJCQkJCSAgc3RydWN0IGRldmljZSAqZGV2KTsKPiArc3Ry
dWN0IGRtYV9idWZfYXR0YWNobWVudCAqCj4gK2RtYV9idWZfZHluYW1pY19hdHRhY2goc3RydWN0
IGRtYV9idWYgKmRtYWJ1Ziwgc3RydWN0IGRldmljZSAqZGV2LAo+ICsJCSAgICAgICBjb25zdCBz
dHJ1Y3QgZG1hX2J1Zl9hdHRhY2hfb3BzICppbXBvcnRlcl9vcHMsCj4gKwkJICAgICAgIHZvaWQg
KmltcG9ydGVyX3ByaXYpOwo+ICB2b2lkIGRtYV9idWZfZGV0YWNoKHN0cnVjdCBkbWFfYnVmICpk
bWFidWYsCj4gLQkJCQlzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICpkbWFidWZfYXR0YWNoKTsK
PiArCQkgICAgc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCAqYXR0YWNoKTsKPiAraW50IGRtYV9i
dWZfcGluKHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFjaCk7Cj4gK3ZvaWQgZG1hX2J1
Zl91bnBpbihzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICphdHRhY2gpOwo+ICAKPiAgc3RydWN0
IGRtYV9idWYgKmRtYV9idWZfZXhwb3J0KGNvbnN0IHN0cnVjdCBkbWFfYnVmX2V4cG9ydF9pbmZv
ICpleHBfaW5mbyk7Cj4gIAo+IEBAIC00MjAsNiArNTExLDcgQEAgc3RydWN0IHNnX3RhYmxlICpk
bWFfYnVmX21hcF9hdHRhY2htZW50KHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKiwKPiAgCQkJ
CQllbnVtIGRtYV9kYXRhX2RpcmVjdGlvbik7Cj4gIHZvaWQgZG1hX2J1Zl91bm1hcF9hdHRhY2ht
ZW50KHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKiwgc3RydWN0IHNnX3RhYmxlICosCj4gIAkJ
CQllbnVtIGRtYV9kYXRhX2RpcmVjdGlvbik7Cj4gK3ZvaWQgZG1hX2J1Zl9tb3ZlX25vdGlmeShz
dHJ1Y3QgZG1hX2J1ZiAqZG1hX2J1Zik7Cj4gIGludCBkbWFfYnVmX2JlZ2luX2NwdV9hY2Nlc3Mo
c3RydWN0IGRtYV9idWYgKmRtYV9idWYsCj4gIAkJCSAgICAgZW51bSBkbWFfZGF0YV9kaXJlY3Rp
b24gZGlyKTsKPiAgaW50IGRtYV9idWZfZW5kX2NwdV9hY2Nlc3Moc3RydWN0IGRtYV9idWYgKmRt
YV9idWYsCj4gLS0gCj4gMi4xNy4xCj4gCj4gX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KPiBJbnRlbC1nZnggbWFpbGluZyBsaXN0Cj4gSW50ZWwtZ2Z4QGxp
c3RzLmZyZWVkZXNrdG9wLm9yZwo+IGh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxt
YW4vbGlzdGluZm8vaW50ZWwtZ2Z4CgotLSAKRGFuaWVsIFZldHRlcgpTb2Z0d2FyZSBFbmdpbmVl
ciwgSW50ZWwgQ29ycG9yYXRpb24KaHR0cDovL2Jsb2cuZmZ3bGwuY2gKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApk
cmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Au
b3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
