Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id DCE0F9E1B4
	for <lists+dri-devel@lfdr.de>; Tue, 27 Aug 2019 10:14:39 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 106DB8908B;
	Tue, 27 Aug 2019 08:14:36 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-wm1-x344.google.com (mail-wm1-x344.google.com
 [IPv6:2a00:1450:4864:20::344])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 781E98992E
 for <dri-devel@lists.freedesktop.org>; Tue, 27 Aug 2019 08:14:32 +0000 (UTC)
Received: by mail-wm1-x344.google.com with SMTP id c5so1977108wmb.5
 for <dri-devel@lists.freedesktop.org>; Tue, 27 Aug 2019 01:14:32 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=D4e7iGHsnMCj/mwiWKJTzKLUGfzuq+WR9rmN1dnOPAE=;
 b=HumfGuqxXwpQlHW09J1sAwgDVdEYUUNoL20vlx7otvEs/fDie6ntenF4aqjDP2fm9N
 1319wAMoVPpXjY7qg8gYkBd3gI8MWyMxJgVGIY1SJ6cWbGWJoeH5LhenZyf7ZPq1FB/Q
 YR5QqLwuKBPgjN9GQjOwNWVGqzfX9QIOSGDXW2ft9Oah6P/qRu2UvpTIedLCVQSkSXwP
 G2nbSlW9F+JcbasfeiRgGmyRVFHYANLSGyyRC2Ko0lsZts3a8rb9tJZ11q92uug3ZKTY
 Hjum8J5wv4QM/vMrwRgsXJ6WiR+TxbchoCRtAkx2iQLTyTKPmwurZZs+QHqJT6m6i5FY
 qoMg==
X-Gm-Message-State: APjAAAUzgak8VGhHVRulc35R2san5wtDsnpFn/L5B6o5G2lD8JW1mazv
 8qr1WWpwV6XuFmK7lRH9VjvIqQ==
X-Google-Smtp-Source: APXvYqzLXBigLBi2lvRnCuJqjyc4AYPGhWY6lt0F37CPz03pQQSr11lfP/riguLWT7NS8aD1+lTn4w==
X-Received: by 2002:a1c:a514:: with SMTP id o20mr27565979wme.149.1566893670659; 
 Tue, 27 Aug 2019 01:14:30 -0700 (PDT)
Received: from bender.baylibre.local
 (lmontsouris-657-1-212-31.w90-63.abo.wanadoo.fr. [90.63.244.31])
 by smtp.gmail.com with ESMTPSA id f18sm11911792wrx.85.2019.08.27.01.14.29
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 27 Aug 2019 01:14:30 -0700 (PDT)
From: Neil Armstrong <narmstrong@baylibre.com>
To: a.hajda@samsung.com, Laurent.pinchart@ideasonboard.com, jonas@kwiboo.se,
 jernej.skrabec@siol.net, boris.brezillon@collabora.com
Subject: [PATCH RFC v2 3/8] drm/bridge: synopsys: dw-hdmi: add bus format
 negociation
Date: Tue, 27 Aug 2019 10:14:20 +0200
Message-Id: <20190827081425.15011-4-narmstrong@baylibre.com>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20190827081425.15011-1-narmstrong@baylibre.com>
References: <20190827081425.15011-1-narmstrong@baylibre.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=baylibre-com.20150623.gappssmtp.com; s=20150623;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=D4e7iGHsnMCj/mwiWKJTzKLUGfzuq+WR9rmN1dnOPAE=;
 b=KWmJrIF5DhACxVfxJuxqoiBamz86vy3kyWZvsEo2ZlNlEFVsiGIFodSwTWpLcX6Fdx
 2VTUDNOipJSYOFR1VAQfxpxk9pGhaat/NPalWshlriMRzGHXauhgP9Wprs6gVW/OS2VB
 YfYrq+8zaQ8mwTufZOC0JrVP3i2RjQZRiBUa5ul3DdUIBra/NTzCZzalP9zNpuE1OJyq
 AKW5d5tq2dQlfXcLHn8DbO7oTNh840c3KKgo2moHwZqjCI6IuL5b05V5Aw/5x/LcNvLd
 90U+TMMR/B61z9ZJZ/tp9q6Kt+dlKFBi9qZcHqZtjFxubtEPajNniiknzSiu6VsapRyJ
 76jA==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: linux-amlogic@lists.infradead.org, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, Neil Armstrong <narmstrong@baylibre.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIHRoZSBhdG9taWNfZ2V0X291dHB1dF9idXNfZm10cywgYXRvbWljX2dldF9pbnB1dF9idXNf
Zm10cyB0byBuZWdvY2lhdGUKdGhlIHBvc3NpYmxlIG91dHB1dCBhbmQgaW5wdXQgZm9ybWF0cyBm
b3IgdGhlIGN1cnJlbnQgbW9kZSBhbmQgbW9uaXRvciwKYW5kIHVzZSB0aGUgbmVnb2NpYXRlZCBm
b3JtYXRzIGluIGEgYmFzaWMgYXRvbWljX2NoZWNrIGNhbGxiYWNrLgoKU2lnbmVkLW9mZi1ieTog
TmVpbCBBcm1zdHJvbmcgPG5hcm1zdHJvbmdAYmF5bGlicmUuY29tPgotLS0KIGRyaXZlcnMvZ3B1
L2RybS9icmlkZ2Uvc3lub3BzeXMvZHctaGRtaS5jIHwgMjQ1ICsrKysrKysrKysrKysrKysrKysr
Ky0KIDEgZmlsZSBjaGFuZ2VkLCAyNDEgaW5zZXJ0aW9ucygrKSwgNCBkZWxldGlvbnMoLSkKCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL3N5bm9wc3lzL2R3LWhkbWkuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9icmlkZ2Uvc3lub3BzeXMvZHctaGRtaS5jCmluZGV4IGJkNjVkMDQ3OTY4
My4uMDBhYWNhZDUxZTI5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL3N5bm9w
c3lzL2R3LWhkbWkuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL3N5bm9wc3lzL2R3LWhk
bWkuYwpAQCAtMTk4NywxMSArMTk4NywxMCBAQCBzdGF0aWMgaW50IGR3X2hkbWlfc2V0dXAoc3Ry
dWN0IGR3X2hkbWkgKmhkbWksIHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlKQogCWhkbWkt
PmhkbWlfZGF0YS52aWRlb19tb2RlLm1waXhlbHJlcGV0aXRpb25vdXRwdXQgPSAwOwogCWhkbWkt
PmhkbWlfZGF0YS52aWRlb19tb2RlLm1waXhlbHJlcGV0aXRpb25pbnB1dCA9IDA7CiAKLQkvKiBU
T0ZJWDogR2V0IGlucHV0IGZvcm1hdCBmcm9tIHBsYXQgZGF0YSBvciBmYWxsYmFjayB0byBSR0I4
ODggKi8KIAlpZiAoaGRtaS0+cGxhdF9kYXRhLT5pbnB1dF9idXNfZm9ybWF0KQogCQloZG1pLT5o
ZG1pX2RhdGEuZW5jX2luX2J1c19mb3JtYXQgPQogCQkJaGRtaS0+cGxhdF9kYXRhLT5pbnB1dF9i
dXNfZm9ybWF0OwotCWVsc2UKKwllbHNlIGlmIChoZG1pLT5oZG1pX2RhdGEuZW5jX2luX2J1c19m
b3JtYXQgPT0gTUVESUFfQlVTX0ZNVF9GSVhFRCkKIAkJaGRtaS0+aGRtaV9kYXRhLmVuY19pbl9i
dXNfZm9ybWF0ID0gTUVESUFfQlVTX0ZNVF9SR0I4ODhfMVgyNDsKIAogCS8qIFRPRklYOiBHZXQg
aW5wdXQgZW5jb2RpbmcgZnJvbSBwbGF0IGRhdGEgb3IgZmFsbGJhY2sgdG8gbm9uZSAqLwpAQCAt
MjAwMSw4ICsyMDAwLDggQEAgc3RhdGljIGludCBkd19oZG1pX3NldHVwKHN0cnVjdCBkd19oZG1p
ICpoZG1pLCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkKIAllbHNlCiAJCWhkbWktPmhk
bWlfZGF0YS5lbmNfaW5fZW5jb2RpbmcgPSBWNEwyX1lDQkNSX0VOQ19ERUZBVUxUOwogCi0JLyog
VE9GSVg6IERlZmF1bHQgdG8gUkdCODg4IG91dHB1dCBmb3JtYXQgKi8KLQloZG1pLT5oZG1pX2Rh
dGEuZW5jX291dF9idXNfZm9ybWF0ID0gTUVESUFfQlVTX0ZNVF9SR0I4ODhfMVgyNDsKKwlpZiAo
aGRtaS0+aGRtaV9kYXRhLmVuY19vdXRfYnVzX2Zvcm1hdCA9PSBNRURJQV9CVVNfRk1UX0ZJWEVE
KQorCQloZG1pLT5oZG1pX2RhdGEuZW5jX291dF9idXNfZm9ybWF0ID0gTUVESUFfQlVTX0ZNVF9S
R0I4ODhfMVgyNDsKIAogCWhkbWktPmhkbWlfZGF0YS5waXhfcmVwZXRfZmFjdG9yID0gMDsKIAlo
ZG1pLT5oZG1pX2RhdGEuaGRjcF9lbmFibGUgPSAwOwpAQCAtMjIyNyw2ICsyMjI2LDI0MCBAQCBz
dGF0aWMgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3JfaGVscGVyX2Z1bmNzIGR3X2hkbWlfY29u
bmVjdG9yX2hlbHBlcl9mdW5jcyA9CiAJLmdldF9tb2RlcyA9IGR3X2hkbWlfY29ubmVjdG9yX2dl
dF9tb2RlcywKIH07CiAKK3N0YXRpYyB2b2lkIGR3X2hkbWlfYnJpZGdlX2F0b21pY19nZXRfb3V0
cHV0X2J1c19mbXRzKHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UsCisJCQkJCXN0cnVjdCBkcm1f
YnJpZGdlX3N0YXRlICpicmlkZ2Vfc3RhdGUsCisJCQkJCXN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSwKKwkJCQkJc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUs
CisJCQkJCXVuc2lnbmVkIGludCAqbnVtX291dHB1dF9mbXRzLAorCQkJCQl1MzIgKm91dHB1dF9m
bXRzKQoreworCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uID0gY29ubl9zdGF0ZS0+Y29ubmVj
dG9yOworCXN0cnVjdCBkcm1fZGlzcGxheV9pbmZvICppbmZvID0gJmNvbm4tPmRpc3BsYXlfaW5m
bzsKKwlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSA9ICZjcnRjX3N0YXRlLT5tb2RlOwor
CWJvb2wgaXNfaGRtaTJfc2luayA9IGluZm8tPmhkbWkuc2NkYy5zdXBwb3J0ZWQ7CQorCWludCBp
ID0gMDsKKworCS8qCisJICogSWYgdGhlIGN1cnJlbnQgbW9kZSBlbmZvcmNlcyA0OjI6MCwgZm9y
Y2UgdGhlIG91dHB1dCBidXQgZm9ybWF0CisJICogdG8gNDoyOjAgYW5kIGRvIG5vdCBhZGQgdGhl
IFlVVjQyMi80NDQvUkdCIGZvcm1hdHMKKwkgKi8KKwlpZiAoZHJtX21vZGVfaXNfNDIwX29ubHko
aW5mbywgbW9kZSkgfHwKKwkgICAgKCFpc19oZG1pMl9zaW5rICYmIGRybV9tb2RlX2lzXzQyMF9h
bHNvKGluZm8sIG1vZGUpKSkgeworCisJCS8qIE9yZGVyIGJ1cyBmb3JtYXRzIGZyb20gMTZiaXQg
dG8gOGJpdCBpZiBzdXBwb3J0ZWQgKi8KKwkJaWYgKGluZm8tPmJwYyA9PSAxNiAmJgorCQkgICAg
KGluZm8tPmhkbWkueTQyMF9kY19tb2RlcyAmIERSTV9FRElEX1lDQkNSNDIwX0RDXzQ4KSkgewor
CQkJaWYgKG91dHB1dF9mbXRzKQorCQkJCW91dHB1dF9mbXRzW2ldID0gTUVESUFfQlVTX0ZNVF9V
WVlWWVkxNl8wXzVYNDg7CisJCQkrK2k7CisJCX0KKworCQlpZiAoaW5mby0+YnBjID49IDEyICYm
CisJCSAgICAoaW5mby0+aGRtaS55NDIwX2RjX21vZGVzICYgRFJNX0VESURfWUNCQ1I0MjBfRENf
MzYpKSB7CisJCQlpZiAob3V0cHV0X2ZtdHMpCisJCQkJb3V0cHV0X2ZtdHNbaV0gPSBNRURJQV9C
VVNfRk1UX1VZWVZZWTEyXzBfNVgzNjsKKwkJCSsraTsKKwkJfQorCisJCWlmIChpbmZvLT5icGMg
Pj0gMTAgJiYKKwkJICAgIChpbmZvLT5oZG1pLnk0MjBfZGNfbW9kZXMgJiBEUk1fRURJRF9ZQ0JD
UjQyMF9EQ18zMCkpIHsKKwkJCWlmIChvdXRwdXRfZm10cykKKwkJCQlvdXRwdXRfZm10c1tpXSA9
IE1FRElBX0JVU19GTVRfVVlZVllZMTBfMF81WDMwOworCQkJKytpOworCQl9CisKKwkJLyogRGVm
YXVsdCA4Yml0IGZhbGxiYWNrICovCisJCWlmIChvdXRwdXRfZm10cykKKwkJCW91dHB1dF9mbXRz
W2ldID0gTUVESUFfQlVTX0ZNVF9VWVlWWVk4XzBfNVgyNDsKKwkJKytpOworCisJCSpudW1fb3V0
cHV0X2ZtdHMgPSBpOworCisJCXJldHVybjsKKwl9CisKKwkvKgorCSAqIE9yZGVyIGJ1cyBmb3Jt
YXRzIGZyb20gMTZiaXQgdG8gOGJpdCBhbmQgZnJvbSBZVVY0MjIgdG8gUkdCCisJICogaWYgc3Vw
cG9ydGVkLiBJbiBhbnkgY2FzZSB0aGUgZGVmYXVsdCBSR0I4ODggZm9ybWF0IGlzIGFkZGVkCisJ
ICovCisKKwlpZiAoaW5mby0+YnBjID09IDE2KSB7CisJCWlmIChpbmZvLT5jb2xvcl9mb3JtYXRz
ICYgRFJNX0NPTE9SX0ZPUk1BVF9ZQ1JDQjQ0NCkgeworCQkJaWYgKG91dHB1dF9mbXRzKQorCQkJ
CW91dHB1dF9mbXRzW2ldID0gTUVESUFfQlVTX0ZNVF9ZVVYxNl8xWDQ4OworCQkJKytpOworCQl9
CisKKwkJaWYgKG91dHB1dF9mbXRzKQorCQkJb3V0cHV0X2ZtdHNbaV0gPSBNRURJQV9CVVNfRk1U
X1JHQjE2MTYxNl8xWDQ4OworCQkrK2k7CisJfQorCisJaWYgKGluZm8tPmJwYyA+PSAxMikgewor
CQlpZiAoaW5mby0+Y29sb3JfZm9ybWF0cyAmIERSTV9DT0xPUl9GT1JNQVRfWUNSQ0I0MjIpIHsK
KwkJCWlmIChvdXRwdXRfZm10cykKKwkJCQlvdXRwdXRfZm10c1tpXSA9IE1FRElBX0JVU19GTVRf
VVlWWTEyXzFYMjQ7CisJCQkrK2k7CisJCX0KKworCQlpZiAoaW5mby0+Y29sb3JfZm9ybWF0cyAm
IERSTV9DT0xPUl9GT1JNQVRfWUNSQ0I0NDQpIHsKKwkJCWlmIChvdXRwdXRfZm10cykKKwkJCQlv
dXRwdXRfZm10c1tpXSA9IE1FRElBX0JVU19GTVRfWVVWMTJfMVgzNjsKKwkJCSsraTsKKwkJfQor
CisJCWlmIChvdXRwdXRfZm10cykKKwkJCW91dHB1dF9mbXRzW2ldID0gTUVESUFfQlVTX0ZNVF9S
R0IxMjEyMTJfMVgzNjsKKwkJKytpOworCX0KKworCWlmIChpbmZvLT5icGMgPj0gMTApIHsKKwkJ
aWYgKGluZm8tPmNvbG9yX2Zvcm1hdHMgJiBEUk1fQ09MT1JfRk9STUFUX1lDUkNCNDIyKSB7CisJ
CQlpZiAob3V0cHV0X2ZtdHMpCisJCQkJb3V0cHV0X2ZtdHNbaV0gPSBNRURJQV9CVVNfRk1UX1VZ
VlkxMF8xWDIwOworCQkJKytpOworCQl9CisKKwkJaWYgKGluZm8tPmNvbG9yX2Zvcm1hdHMgJiBE
Uk1fQ09MT1JfRk9STUFUX1lDUkNCNDQ0KSB7CisJCQlpZiAob3V0cHV0X2ZtdHMpCisJCQkJb3V0
cHV0X2ZtdHNbaV0gPSBNRURJQV9CVVNfRk1UX1lVVjEwXzFYMzA7CisJCQkrK2k7CisJCX0KKwor
CQlpZiAob3V0cHV0X2ZtdHMpCisJCQlvdXRwdXRfZm10c1tpXSA9IE1FRElBX0JVU19GTVRfUkdC
MTAxMDEwXzFYMzA7CisJCSsraTsKKwl9CisKKwlpZiAoaW5mby0+Y29sb3JfZm9ybWF0cyAmIERS
TV9DT0xPUl9GT1JNQVRfWUNSQ0I0MjIpIHsKKwkJaWYgKG91dHB1dF9mbXRzKQorCQkJb3V0cHV0
X2ZtdHNbaV0gPSBNRURJQV9CVVNfRk1UX1VZVlk4XzFYMTY7CisJCSsraTsKKwl9CisKKwlpZiAo
aW5mby0+Y29sb3JfZm9ybWF0cyAmIERSTV9DT0xPUl9GT1JNQVRfWUNSQ0I0NDQpIHsKKwkJaWYg
KG91dHB1dF9mbXRzKQorCQkJb3V0cHV0X2ZtdHNbaV0gPSBNRURJQV9CVVNfRk1UX1lVVjhfMVgy
NDsKKwkJKytpOworCX0KKworCS8qIERlZmF1bHQgOGJpdCBSR0IgZmFsbGJhY2sgKi8KKwlpZiAo
b3V0cHV0X2ZtdHMpCisJCW91dHB1dF9mbXRzW2ldID0gTUVESUFfQlVTX0ZNVF9SR0I4ODhfMVgy
NDsKKwkrK2k7CisKKwkqbnVtX291dHB1dF9mbXRzID0gaTsKK30KKworc3RhdGljIHZvaWQgZHdf
aGRtaV9icmlkZ2VfYXRvbWljX2dldF9pbnB1dF9idXNfZm10cyhzdHJ1Y3QgZHJtX2JyaWRnZSAq
YnJpZGdlLAorCQkJCQlzdHJ1Y3QgZHJtX2JyaWRnZV9zdGF0ZSAqYnJpZGdlX3N0YXRlLAorCQkJ
CQlzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCisJCQkJCXN0cnVjdCBkcm1fY29u
bmVjdG9yX3N0YXRlICpjb25uX3N0YXRlLAorCQkJCQl1MzIgb3V0cHV0X2ZtdCwKKwkJCQkJdW5z
aWduZWQgaW50ICpudW1faW5wdXRfZm10cywKKwkJCQkJdTMyICppbnB1dF9mbXRzKQoreworCWlu
dCBpID0gMDsKKworCXN3aXRjaCAob3V0cHV0X2ZtdCkgeworCQkvKiA4Yml0ICovCisJCWNhc2Ug
TUVESUFfQlVTX0ZNVF9SR0I4ODhfMVgyNDoKKwkJCWlmIChpbnB1dF9mbXRzKQorCQkJCWlucHV0
X2ZtdHNbaV0gPSBNRURJQV9CVVNfRk1UX1JHQjg4OF8xWDI0OworCQkJKytpOworCQkvKiBGYWxs
dGhyb3VnaHQgKi8KKwkJY2FzZSBNRURJQV9CVVNfRk1UX1lVVjhfMVgyNDoKKwkJCWlmIChpbnB1
dF9mbXRzKQorCQkJCWlucHV0X2ZtdHNbaV0gPSBNRURJQV9CVVNfRk1UX1lVVjhfMVgyNDsKKwkJ
CSsraTsKKwkJCWJyZWFrOworCQljYXNlIE1FRElBX0JVU19GTVRfVVlWWThfMVgxNjoKKwkJLyog
RmFsbHRocm91Z2h0ICovCisJCWNhc2UgTUVESUFfQlVTX0ZNVF9VWVlWWVk4XzBfNVgyNDoKKwkJ
CWlmIChpbnB1dF9mbXRzKQorCQkJCWlucHV0X2ZtdHNbaV0gPSBvdXRwdXRfZm10OworCQkJKytp
OworCQkJYnJlYWs7CisKKwkJLyogMTBiaXQgKi8KKwkJY2FzZSBNRURJQV9CVVNfRk1UX1JHQjEw
MTAxMF8xWDMwOgorCQkJaWYgKGlucHV0X2ZtdHMpCisJCQkJaW5wdXRfZm10c1tpXSA9IG91dHB1
dF9mbXQ7CisJCQkrK2k7CisJCS8qIEZhbGx0aHJvdWdodCAqLworCQljYXNlIE1FRElBX0JVU19G
TVRfWVVWMTBfMVgzMDoKKwkJCWlmIChpbnB1dF9mbXRzKQorCQkJCWlucHV0X2ZtdHNbaV0gPSBN
RURJQV9CVVNfRk1UX1lVVjEwXzFYMzA7CisJCQkrK2k7CisJCQlicmVhazsKKwkJY2FzZSBNRURJ
QV9CVVNfRk1UX1VZVlkxMF8xWDIwOgorCQkvKiBGYWxsdGhyb3VnaHQgKi8KKwkJY2FzZSBNRURJ
QV9CVVNfRk1UX1VZWVZZWTEwXzBfNVgzMDoKKwkJCWlmIChpbnB1dF9mbXRzKQorCQkJCWlucHV0
X2ZtdHNbaV0gPSBvdXRwdXRfZm10OworCQkJKytpOworCQkJYnJlYWs7CisKKwkJLyogMTJiaXQg
Ki8KKwkJY2FzZSBNRURJQV9CVVNfRk1UX1JHQjEyMTIxMl8xWDM2OgorCQkJaWYgKGlucHV0X2Zt
dHMpCisJCQkJaW5wdXRfZm10c1tpXSA9IG91dHB1dF9mbXQ7CisJCQkrK2k7CisJCS8qIEZhbGx0
aHJvdWdodCAqLworCQljYXNlIE1FRElBX0JVU19GTVRfWVVWMTJfMVgzNjoKKwkJCWlmIChpbnB1
dF9mbXRzKQorCQkJCWlucHV0X2ZtdHNbaV0gPSBNRURJQV9CVVNfRk1UX1lVVjEyXzFYMzY7CisJ
CQkrK2k7CisJCQlicmVhazsKKwkJY2FzZSBNRURJQV9CVVNfRk1UX1VZVlkxMl8xWDI0OgorCQkv
KiBGYWxsdGhyb3VnaHQgKi8KKwkJY2FzZSBNRURJQV9CVVNfRk1UX1VZWVZZWTEyXzBfNVgzNjoK
KwkJCWlmIChpbnB1dF9mbXRzKQorCQkJCWlucHV0X2ZtdHNbaV0gPSBvdXRwdXRfZm10OworCQkJ
KytpOworCQkJYnJlYWs7CisKKwkJLyogMTZiaXQgKi8KKwkJY2FzZSBNRURJQV9CVVNfRk1UX1JH
QjE2MTYxNl8xWDQ4OgorCQkJaWYgKGlucHV0X2ZtdHMpCisJCQkJaW5wdXRfZm10c1tpXSA9IG91
dHB1dF9mbXQ7CisJCQkrK2k7CisJCS8qIEZhbGx0aHJvdWdodCAqLworCQljYXNlIE1FRElBX0JV
U19GTVRfWVVWMTZfMVg0ODoKKwkJCWlmIChpbnB1dF9mbXRzKQorCQkJCWlucHV0X2ZtdHNbaV0g
PSBNRURJQV9CVVNfRk1UX1lVVjE2XzFYNDg7CisJCQkrK2k7CisJCQlicmVhazsKKwkJY2FzZSBN
RURJQV9CVVNfRk1UX1VZWVZZWTE2XzBfNVg0ODoKKwkJCWlmIChpbnB1dF9mbXRzKQorCQkJCWlu
cHV0X2ZtdHNbaV0gPSBvdXRwdXRfZm10OworCQkJKytpOworCQkJYnJlYWs7CisJfQorCisJKm51
bV9pbnB1dF9mbXRzID0gaTsKK30KKworc3RhdGljIGludCBkd19oZG1pX2JyaWRnZV9hdG9taWNf
Y2hlY2soc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSwKKwkJCQkgICAgICAgc3RydWN0IGRybV9i
cmlkZ2Vfc3RhdGUgKmJyaWRnZV9zdGF0ZSwKKwkJCQkgICAgICAgc3RydWN0IGRybV9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlLAorCQkJCSAgICAgICBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAq
Y29ubl9zdGF0ZSkKK3sKKwlzdHJ1Y3QgZHdfaGRtaSAqaGRtaSA9IGJyaWRnZS0+ZHJpdmVyX3By
aXZhdGU7CisKKwlkZXZfZGJnKGhkbWktPmRldiwgInNlbGVjdGVkIG91dHB1dCBmb3JtYXQgJXhc
biIsCisJCQlicmlkZ2Vfc3RhdGUtPm91dHB1dF9idXNfY2ZnLmZtdCk7CisKKwloZG1pLT5oZG1p
X2RhdGEuZW5jX291dF9idXNfZm9ybWF0ID0gYnJpZGdlX3N0YXRlLT5vdXRwdXRfYnVzX2NmZy5m
bXQ7CisKKwlkZXZfZGJnKGhkbWktPmRldiwgInNlbGVjdGVkIGlucHV0IGZvcm1hdCAleFxuIiwK
KwkJCWJyaWRnZV9zdGF0ZS0+aW5wdXRfYnVzX2NmZy5mbXQpOworCisJaGRtaS0+aGRtaV9kYXRh
LmVuY19pbl9idXNfZm9ybWF0ID0gYnJpZGdlX3N0YXRlLT5pbnB1dF9idXNfY2ZnLmZtdDsKKwor
CXJldHVybiAwOworfQorCiBzdGF0aWMgaW50IGR3X2hkbWlfYnJpZGdlX2F0dGFjaChzdHJ1Y3Qg
ZHJtX2JyaWRnZSAqYnJpZGdlKQogewogCXN0cnVjdCBkd19oZG1pICpoZG1pID0gYnJpZGdlLT5k
cml2ZXJfcHJpdmF0ZTsKQEAgLTIzMjcsNiArMjU2MCw5IEBAIHN0YXRpYyB2b2lkIGR3X2hkbWlf
YnJpZGdlX2VuYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQogc3RhdGljIGNvbnN0IHN0
cnVjdCBkcm1fYnJpZGdlX2Z1bmNzIGR3X2hkbWlfYnJpZGdlX2Z1bmNzID0gewogCS5hdHRhY2gg
PSBkd19oZG1pX2JyaWRnZV9hdHRhY2gsCiAJLmRldGFjaCA9IGR3X2hkbWlfYnJpZGdlX2RldGFj
aCwKKwkuYXRvbWljX2NoZWNrID0gZHdfaGRtaV9icmlkZ2VfYXRvbWljX2NoZWNrLAorCS5hdG9t
aWNfZ2V0X291dHB1dF9idXNfZm10cyA9IGR3X2hkbWlfYnJpZGdlX2F0b21pY19nZXRfb3V0cHV0
X2J1c19mbXRzLAorCS5hdG9taWNfZ2V0X2lucHV0X2J1c19mbXRzID0gZHdfaGRtaV9icmlkZ2Vf
YXRvbWljX2dldF9pbnB1dF9idXNfZm10cywKIAkuZW5hYmxlID0gZHdfaGRtaV9icmlkZ2VfZW5h
YmxlLAogCS5kaXNhYmxlID0gZHdfaGRtaV9icmlkZ2VfZGlzYWJsZSwKIAkubW9kZV9zZXQgPSBk
d19oZG1pX2JyaWRnZV9tb2RlX3NldCwKQEAgLTI3OTAsNiArMzAyNiw3IEBAIF9fZHdfaGRtaV9w
cm9iZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2LAogCiAJaGRtaS0+YnJpZGdlLmRyaXZl
cl9wcml2YXRlID0gaGRtaTsKIAloZG1pLT5icmlkZ2UuZnVuY3MgPSAmZHdfaGRtaV9icmlkZ2Vf
ZnVuY3M7CisKICNpZmRlZiBDT05GSUdfT0YKIAloZG1pLT5icmlkZ2Uub2Zfbm9kZSA9IHBkZXYt
PmRldi5vZl9ub2RlOwogI2VuZGlmCi0tIAoyLjIyLjAKCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVs
QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWls
bWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
