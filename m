Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id B6D4CF1774
	for <lists+dri-devel@lfdr.de>; Wed,  6 Nov 2019 14:41:15 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E03216ED4A;
	Wed,  6 Nov 2019 13:41:12 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from us-smtp-1.mimecast.com (us-smtp-delivery-1.mimecast.com
 [205.139.110.120])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 756A46ED46
 for <dri-devel@lists.freedesktop.org>; Wed,  6 Nov 2019 13:41:11 +0000 (UTC)
Received: from mimecast-mx01.redhat.com (mimecast-mx01.redhat.com
 [209.132.183.4]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-132--hOtL8uHOJqStbIMTCX8Ig-1; Wed, 06 Nov 2019 08:41:08 -0500
Received: from smtp.corp.redhat.com (int-mx08.intmail.prod.int.phx2.redhat.com
 [10.5.11.23])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mimecast-mx01.redhat.com (Postfix) with ESMTPS id 744B81800D6B;
 Wed,  6 Nov 2019 13:41:04 +0000 (UTC)
Received: from jason-ThinkPad-X1-Carbon-6th.redhat.com
 (ovpn-12-193.pek2.redhat.com [10.72.12.193])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 73AAF19756;
 Wed,  6 Nov 2019 13:40:22 +0000 (UTC)
From: Jason Wang <jasowang@redhat.com>
To: kvm@vger.kernel.org, linux-s390@vger.kernel.org,
 linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org,
 intel-gfx@lists.freedesktop.org, intel-gvt-dev@lists.freedesktop.org,
 kwankhede@nvidia.com, alex.williamson@redhat.com, mst@redhat.com,
 tiwei.bie@intel.com
Subject: [PATCH V10 4/6] mdev: introduce virtio device and its device ops
Date: Wed,  6 Nov 2019 21:35:29 +0800
Message-Id: <20191106133531.693-5-jasowang@redhat.com>
In-Reply-To: <20191106133531.693-1-jasowang@redhat.com>
References: <20191106133531.693-1-jasowang@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.23
X-MC-Unique: -hOtL8uHOJqStbIMTCX8Ig-1
X-Mimecast-Spam-Score: 0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=redhat.com; 
 s=mimecast20190719; t=1573047670;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=wtvIi2yIPGS5MLETRkpjvruFht3By2opLcoYExxwXWY=;
 b=GITjHNDUwu1ToM+Nxa0q6x1+NltTTxHStqjHhaUZF2lRRtyR8MOz4dhe2hdQZjdIrnTr3b
 D5GyethY0cee2eY0XwOkHoBJ8goAPdaZqh/fyynnz0VbSzu/7n5Wr0vPbjP46W1xB/gQ/1
 uUhrN/b0iHuYoxH03XqYwcxXmCVJOMo=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: christophe.de.dinechin@gmail.com, sebott@linux.ibm.com, airlied@linux.ie,
 Jason Wang <jasowang@redhat.com>, heiko.carstens@de.ibm.com,
 kevin.tian@intel.com, virtualization@lists.linux-foundation.org,
 rob.miller@broadcom.com, lulu@redhat.com, eperezma@redhat.com,
 pasic@linux.ibm.com, borntraeger@de.ibm.com, haotian.wang@sifive.com,
 zhi.a.wang@intel.com, farman@linux.ibm.com, idos@mellanox.com,
 gor@linux.ibm.com, cunming.liang@intel.com, rodrigo.vivi@intel.com,
 xiao.w.wang@intel.com, freude@linux.ibm.com, parav@mellanox.com,
 zhihong.wang@intel.com, stefanha@redhat.com, akrowiak@linux.ibm.com,
 netdev@vger.kernel.org, cohuck@redhat.com, oberpar@linux.ibm.com,
 maxime.coquelin@redhat.com, lingshan.zhu@intel.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBwYXRjaCBpbXBsZW1lbnRzIGJhc2ljIHN1cHBvcnQgZm9yIG1kZXYgZHJpdmVyIHRoYXQg
c3VwcG9ydHMKdmlydGlvIHRyYW5zcG9ydCBmb3Iga2VybmVsIHZpcnRpbyBkcml2ZXIuCgpSZXZp
ZXdlZC1ieTogQ29ybmVsaWEgSHVjayA8Y29odWNrQHJlZGhhdC5jb20+ClNpZ25lZC1vZmYtYnk6
IEphc29uIFdhbmcgPGphc293YW5nQHJlZGhhdC5jb20+Ci0tLQogTUFJTlRBSU5FUlMgICAgICAg
ICAgICAgICAgICAgICAgfCAgIDEgKwogZHJpdmVycy92ZmlvL21kZXYvbWRldl9jb3JlLmMgICAg
fCAgMjEgKysrKysKIGRyaXZlcnMvdmZpby9tZGV2L21kZXZfcHJpdmF0ZS5oIHwgICAyICsKIGlu
Y2x1ZGUvbGludXgvbWRldi5oICAgICAgICAgICAgIHwgICA2ICsrCiBpbmNsdWRlL2xpbnV4L21k
ZXZfdmlydGlvX29wcy5oICB8IDE0NyArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiA1
IGZpbGVzIGNoYW5nZWQsIDE3NyBpbnNlcnRpb25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgaW5j
bHVkZS9saW51eC9tZGV2X3ZpcnRpb19vcHMuaAoKZGlmZiAtLWdpdCBhL01BSU5UQUlORVJTIGIv
TUFJTlRBSU5FUlMKaW5kZXggZjY2MWQxMzM0NGQ2Li40OTk3OTU3NDQzZGYgMTAwNjQ0Ci0tLSBh
L01BSU5UQUlORVJTCisrKyBiL01BSU5UQUlORVJTCkBAIC0xNzI0OCw2ICsxNzI0OCw3IEBAIEY6
CWluY2x1ZGUvbGludXgvdmlydGlvKi5oCiBGOglpbmNsdWRlL3VhcGkvbGludXgvdmlydGlvXyou
aAogRjoJZHJpdmVycy9jcnlwdG8vdmlydGlvLwogRjoJbW0vYmFsbG9vbl9jb21wYWN0aW9uLmMK
K0Y6CWluY2x1ZGUvbGludXgvbWRldl92aXJ0aW9fb3BzLmgKIAogVklSVElPIEJMT0NLIEFORCBT
Q1NJIERSSVZFUlMKIE06CSJNaWNoYWVsIFMuIFRzaXJraW4iIDxtc3RAcmVkaGF0LmNvbT4KZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvdmZpby9tZGV2L21kZXZfY29yZS5jIGIvZHJpdmVycy92ZmlvL21k
ZXYvbWRldl9jb3JlLmMKaW5kZXggNGU3MGYxOWFjMTQ1Li5jNTgyNTM0MDRlZDUgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvdmZpby9tZGV2L21kZXZfY29yZS5jCisrKyBiL2RyaXZlcnMvdmZpby9tZGV2
L21kZXZfY29yZS5jCkBAIC03OCw2ICs3OCwyNyBAQCBjb25zdCBzdHJ1Y3QgbWRldl92ZmlvX2Rl
dmljZV9vcHMgKm1kZXZfZ2V0X3ZmaW9fb3BzKHN0cnVjdCBtZGV2X2RldmljZSAqbWRldikKIH0K
IEVYUE9SVF9TWU1CT0wobWRldl9nZXRfdmZpb19vcHMpOwogCisvKgorICogU3BlY2lmeSB0aGUg
dmlydGlvIGRldmljZSBvcHMgZm9yIHRoZSBtZGV2IGRldmljZSwgdGhpcworICogbXVzdCBiZSBj
YWxsZWQgZHVyaW5nIGNyZWF0ZSgpIGNhbGxiYWNrIGZvciB2aXJ0aW8gbWRldiBkZXZpY2UuCisg
Ki8KK3ZvaWQgbWRldl9zZXRfdmlydGlvX29wcyhzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYsCisJ
CQkgY29uc3Qgc3RydWN0IG1kZXZfdmlydGlvX2RldmljZV9vcHMgKnZpcnRpb19vcHMpCit7CisJ
bWRldl9zZXRfY2xhc3MobWRldiwgTURFVl9DTEFTU19JRF9WSVJUSU8pOworCW1kZXYtPnZpcnRp
b19vcHMgPSB2aXJ0aW9fb3BzOworfQorRVhQT1JUX1NZTUJPTChtZGV2X3NldF92aXJ0aW9fb3Bz
KTsKKworLyogR2V0IHRoZSB2aXJ0aW8gZGV2aWNlIG9wcyBmb3IgdGhlIG1kZXYgZGV2aWNlLiAq
LworY29uc3Qgc3RydWN0IG1kZXZfdmlydGlvX2RldmljZV9vcHMgKgorbWRldl9nZXRfdmlydGlv
X29wcyhzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYpCit7CisJV0FSTl9PTihtZGV2LT5jbGFzc19p
ZCAhPSBNREVWX0NMQVNTX0lEX1ZJUlRJTyk7CisJcmV0dXJuIG1kZXYtPnZpcnRpb19vcHM7Cit9
CitFWFBPUlRfU1lNQk9MKG1kZXZfZ2V0X3ZpcnRpb19vcHMpOworCiBzdHJ1Y3QgZGV2aWNlICpt
ZGV2X2RldihzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYpCiB7CiAJcmV0dXJuICZtZGV2LT5kZXY7
CmRpZmYgLS1naXQgYS9kcml2ZXJzL3ZmaW8vbWRldi9tZGV2X3ByaXZhdGUuaCBiL2RyaXZlcnMv
dmZpby9tZGV2L21kZXZfcHJpdmF0ZS5oCmluZGV4IDQxMTIyNzM3MzYyNS4uMmM3NGRkMDMyNDA5
IDEwMDY0NAotLS0gYS9kcml2ZXJzL3ZmaW8vbWRldi9tZGV2X3ByaXZhdGUuaAorKysgYi9kcml2
ZXJzL3ZmaW8vbWRldi9tZGV2X3ByaXZhdGUuaApAQCAtMTEsNiArMTEsNyBAQAogI2RlZmluZSBN
REVWX1BSSVZBVEVfSAogCiAjaW5jbHVkZSA8bGludXgvbWRldl92ZmlvX29wcy5oPgorI2luY2x1
ZGUgPGxpbnV4L21kZXZfdmlydGlvX29wcy5oPgogCiBpbnQgIG1kZXZfYnVzX3JlZ2lzdGVyKHZv
aWQpOwogdm9pZCBtZGV2X2J1c191bnJlZ2lzdGVyKHZvaWQpOwpAQCAtMzgsNiArMzksNyBAQCBz
dHJ1Y3QgbWRldl9kZXZpY2UgewogCXUxNiBjbGFzc19pZDsKIAl1bmlvbiB7CiAJCWNvbnN0IHN0
cnVjdCBtZGV2X3ZmaW9fZGV2aWNlX29wcyAqdmZpb19vcHM7CisJCWNvbnN0IHN0cnVjdCBtZGV2
X3ZpcnRpb19kZXZpY2Vfb3BzICp2aXJ0aW9fb3BzOwogCX07CiB9OwogCmRpZmYgLS1naXQgYS9p
bmNsdWRlL2xpbnV4L21kZXYuaCBiL2luY2x1ZGUvbGludXgvbWRldi5oCmluZGV4IDllMzc1MDZk
MTk4Ny4uZjNkNzVhNjBjMmI1IDEwMDY0NAotLS0gYS9pbmNsdWRlL2xpbnV4L21kZXYuaAorKysg
Yi9pbmNsdWRlL2xpbnV4L21kZXYuaApAQCAtMTcsNiArMTcsNyBAQAogCiBzdHJ1Y3QgbWRldl9k
ZXZpY2U7CiBzdHJ1Y3QgbWRldl92ZmlvX2RldmljZV9vcHM7CitzdHJ1Y3QgbWRldl92aXJ0aW9f
ZGV2aWNlX29wczsKIAogLyoKICAqIENhbGxlZCBieSB0aGUgcGFyZW50IGRldmljZSBkcml2ZXIg
dG8gc2V0IHRoZSBkZXZpY2Ugd2hpY2ggcmVwcmVzZW50cwpAQCAtMTEyLDYgKzExMywxMCBAQCB2
b2lkIG1kZXZfc2V0X2NsYXNzKHN0cnVjdCBtZGV2X2RldmljZSAqbWRldiwgdTE2IGlkKTsKIHZv
aWQgbWRldl9zZXRfdmZpb19vcHMoc3RydWN0IG1kZXZfZGV2aWNlICptZGV2LAogCQkgICAgICAg
Y29uc3Qgc3RydWN0IG1kZXZfdmZpb19kZXZpY2Vfb3BzICp2ZmlvX29wcyk7CiBjb25zdCBzdHJ1
Y3QgbWRldl92ZmlvX2RldmljZV9vcHMgKm1kZXZfZ2V0X3ZmaW9fb3BzKHN0cnVjdCBtZGV2X2Rl
dmljZSAqbWRldik7Cit2b2lkIG1kZXZfc2V0X3ZpcnRpb19vcHMoc3RydWN0IG1kZXZfZGV2aWNl
ICptZGV2LAorCQkJIGNvbnN0IHN0cnVjdCBtZGV2X3ZpcnRpb19kZXZpY2Vfb3BzICp2aXJ0aW9f
b3BzKTsKK2NvbnN0IHN0cnVjdCBtZGV2X3ZpcnRpb19kZXZpY2Vfb3BzICoKK21kZXZfZ2V0X3Zp
cnRpb19vcHMoc3RydWN0IG1kZXZfZGV2aWNlICptZGV2KTsKIAogZXh0ZXJuIHN0cnVjdCBidXNf
dHlwZSBtZGV2X2J1c190eXBlOwogCkBAIC0xMjcsNiArMTMyLDcgQEAgc3RydWN0IG1kZXZfZGV2
aWNlICptZGV2X2Zyb21fZGV2KHN0cnVjdCBkZXZpY2UgKmRldik7CiAKIGVudW0gewogCU1ERVZf
Q0xBU1NfSURfVkZJTyA9IDEsCisJTURFVl9DTEFTU19JRF9WSVJUSU8gPSAyLAogCS8qIE5ldyBl
bnRyaWVzIG11c3QgYmUgYWRkZWQgaGVyZSAqLwogfTsKIApkaWZmIC0tZ2l0IGEvaW5jbHVkZS9s
aW51eC9tZGV2X3ZpcnRpb19vcHMuaCBiL2luY2x1ZGUvbGludXgvbWRldl92aXJ0aW9fb3BzLmgK
bmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi44OTUxMzMxYzY2MjkKLS0t
IC9kZXYvbnVsbAorKysgYi9pbmNsdWRlL2xpbnV4L21kZXZfdmlydGlvX29wcy5oCkBAIC0wLDAg
KzEsMTQ3IEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5ICovCisv
KgorICogVmlydGlvIG1lZGlhdGVkIGRldmljZSBkcml2ZXIKKyAqCisgKiBDb3B5cmlnaHQgMjAx
OSwgUmVkIEhhdCBDb3JwLgorICogICAgIEF1dGhvcjogSmFzb24gV2FuZyA8amFzb3dhbmdAcmVk
aGF0LmNvbT4KKyAqLworI2lmbmRlZiBNREVWX1ZJUlRJT19PUFNfSAorI2RlZmluZSBNREVWX1ZJ
UlRJT19PUFNfSAorCisjaW5jbHVkZSA8bGludXgvaW50ZXJydXB0Lmg+CisjaW5jbHVkZSA8bGlu
dXgvbWRldi5oPgorI2luY2x1ZGUgPHVhcGkvbGludXgvdmhvc3QuaD4KKworI2RlZmluZSBWSVJU
SU9fTURFVl9ERVZJQ0VfQVBJX1NUUklORwkJInZpcnRpby1tZGV2IgorCitzdHJ1Y3QgdmlydGlv
X21kZXZfY2FsbGJhY2sgeworCWlycXJldHVybl90ICgqY2FsbGJhY2spKHZvaWQgKmRhdGEpOwor
CXZvaWQgKnByaXZhdGU7Cit9OworCisvKioKKyAqIHN0cnVjdCBtZGV2X3ZpcnRpb19kZXZpY2Vf
b3BzIC0gU3RydWN0dXJlIHRvIGJlIHJlZ2lzdGVyZWQgZm9yIGVhY2gKKyAqIG1kZXYgZGV2aWNl
IHRvIHJlZ2lzdGVyIHRoZSBkZXZpY2UgZm9yIHZpcnRpby92aG9zdCBkcml2ZXJzLgorICoKKyAq
IFRoZSBjYWxsYmFja3MgYXJlIG1hbmRhdG9yeSB1bmxlc3MgZXhwbGljaXRseSBtZW50aW9uZWQu
CisgKgorICogQHNldF92cV9hZGRyZXNzOgkJU2V0IHRoZSBhZGRyZXNzIG9mIHZpcnRxdWV1ZQor
ICoJCQkJQG1kZXY6IG1lZGlhdGVkIGRldmljZQorICoJCQkJQGlkeDogdmlydHF1ZXVlIGluZGV4
CisgKgkJCQlAZGVzY19hcmVhOiBhZGRyZXNzIG9mIGRlc2MgYXJlYQorICoJCQkJQGRyaXZlcl9h
cmVhOiBhZGRyZXNzIG9mIGRyaXZlciBhcmVhCisgKgkJCQlAZGV2aWNlX2FyZWE6IGFkZHJlc3Mg
b2YgZGV2aWNlIGFyZWEKKyAqCQkJCVJldHVybnMgaW50ZWdlcjogc3VjY2VzcyAoMCkgb3IgZXJy
b3IgKDwgMCkKKyAqIEBzZXRfdnFfbnVtOgkJCVNldCB0aGUgc2l6ZSBvZiB2aXJ0cXVldWUKKyAq
CQkJCUBtZGV2OiBtZWRpYXRlZCBkZXZpY2UKKyAqCQkJCUBpZHg6IHZpcnRxdWV1ZSBpbmRleAor
ICoJCQkJQG51bTogdGhlIHNpemUgb2YgdmlydHF1ZXVlCisgKiBAa2lja192cToJCQlLaWNrIHRo
ZSB2aXJ0cXVldWUKKyAqCQkJCUBtZGV2OiBtZWRpYXRlZCBkZXZpY2UKKyAqCQkJCUBpZHg6IHZp
cnRxdWV1ZSBpbmRleAorICogQHNldF92cV9jYjoJCQlTZXQgdGhlIGludGVycnVwdCBjYWxsYmFj
ayBmdW5jdGlvbiBmb3IKKyAqCQkJCWEgdmlydHF1ZXVlCisgKgkJCQlAbWRldjogbWVkaWF0ZWQg
ZGV2aWNlCisgKgkJCQlAaWR4OiB2aXJ0cXVldWUgaW5kZXgKKyAqCQkJCUBjYjogdmlydGlvLW1k
ZXYgaW50ZXJydXB0IGNhbGxiYWNrIHN0cnVjdHVyZQorICogQHNldF92cV9yZWFkeToJCVNldCBy
ZWFkeSBzdGF0dXMgZm9yIGEgdmlydHF1ZXVlCisgKgkJCQlAbWRldjogbWVkaWF0ZWQgZGV2aWNl
CisgKgkJCQlAaWR4OiB2aXJ0cXVldWUgaW5kZXgKKyAqCQkJCUByZWFkeTogcmVhZHkgKHRydWUp
IG5vdCByZWFkeShmYWxzZSkKKyAqIEBnZXRfdnFfcmVhZHk6CQlHZXQgcmVhZHkgc3RhdHVzIGZv
ciBhIHZpcnRxdWV1ZQorICoJCQkJQG1kZXY6IG1lZGlhdGVkIGRldmljZQorICoJCQkJQGlkeDog
dmlydHF1ZXVlIGluZGV4CisgKgkJCQlSZXR1cm5zIGJvb2xlYW46IHJlYWR5ICh0cnVlKSBvciBu
b3QgKGZhbHNlKQorICogQHNldF92cV9zdGF0ZToJCVNldCB0aGUgc3RhdGUgZm9yIGEgdmlydHF1
ZXVlCisgKgkJCQlAbWRldjogbWVkaWF0ZWQgZGV2aWNlCisgKgkJCQlAaWR4OiB2aXJ0cXVldWUg
aW5kZXgKKyAqCQkJCUBzdGF0ZTogdmlydHF1ZXVlIHN0YXRlIChsYXN0X2F2YWlsX2lkeCkKKyAq
CQkJCVJldHVybnMgaW50ZWdlcjogc3VjY2VzcyAoMCkgb3IgZXJyb3IgKDwgMCkKKyAqIEBnZXRf
dnFfc3RhdGU6CQlHZXQgdGhlIHN0YXRlIGZvciBhIHZpcnRxdWV1ZQorICoJCQkJQG1kZXY6IG1l
ZGlhdGVkIGRldmljZQorICoJCQkJQGlkeDogdmlydHF1ZXVlIGluZGV4CisgKgkJCQlSZXR1cm5z
IHZpcnRxdWV1ZSBzdGF0ZSAobGFzdF9hdmFpbF9pZHgpCisgKiBAZ2V0X3ZxX2FsaWduOgkJR2V0
IHRoZSB2aXJ0cXVldWUgYWxpZ24gcmVxdWlyZW1lbnQKKyAqCQkJCWZvciB0aGUgZGV2aWNlCisg
KgkJCQlAbWRldjogbWVkaWF0ZWQgZGV2aWNlCisgKgkJCQlSZXR1cm5zIHZpcnRxdWV1ZSBhbGdp
biByZXF1aXJlbWVudAorICogQGdldF9mZWF0dXJlczoJCUdldCB2aXJ0aW8gZmVhdHVyZXMgc3Vw
cG9ydGVkIGJ5IHRoZSBkZXZpY2UKKyAqCQkJCUBtZGV2OiBtZWRpYXRlZCBkZXZpY2UKKyAqCQkJ
CVJldHVybnMgdGhlIHZpcnRpbyBmZWF0dXJlcyBzdXBwb3J0IGJ5IHRoZQorICoJCQkJZGV2aWNl
CisgKiBAc2V0X2ZlYXR1cmVzOgkJU2V0IHZpcnRpbyBmZWF0dXJlcyBzdXBwb3J0ZWQgYnkgdGhl
IGRyaXZlcgorICoJCQkJQG1kZXY6IG1lZGlhdGVkIGRldmljZQorICoJCQkJQGZlYXR1cmVzOiBm
ZWF0dXJlIHN1cHBvcnQgYnkgdGhlIGRyaXZlcgorICoJCQkJUmV0dXJucyBpbnRlZ2VyOiBzdWNj
ZXNzICgwKSBvciBlcnJvciAoPCAwKQorICogQHNldF9jb25maWdfY2I6CQlTZXQgdGhlIGNvbmZp
ZyBpbnRlcnJ1cHQgY2FsbGJhY2sKKyAqCQkJCUBtZGV2OiBtZWRpYXRlZCBkZXZpY2UKKyAqCQkJ
CUBjYjogdmlydGlvLW1kZXYgaW50ZXJydXB0IGNhbGxiYWNrIHN0cnVjdHVyZQorICogQGdldF92
cV9udW1fbWF4OgkJR2V0IHRoZSBtYXggc2l6ZSBvZiB2aXJ0cXVldWUKKyAqCQkJCUBtZGV2OiBt
ZWRpYXRlZCBkZXZpY2UKKyAqCQkJCVJldHVybnMgdTE2OiBtYXggc2l6ZSBvZiB2aXJ0cXVldWUK
KyAqIEBnZXRfZGV2aWNlX2lkOgkJR2V0IHZpcnRpbyBkZXZpY2UgaWQKKyAqCQkJCUBtZGV2OiBt
ZWRpYXRlZCBkZXZpY2UKKyAqCQkJCVJldHVybnMgdTMyOiB2aXJ0aW8gZGV2aWNlIGlkCisgKiBA
Z2V0X3ZlbmRvcl9pZDoJCUdldCBpZCBmb3IgdGhlIHZlbmRvciB0aGF0IHByb3ZpZGVzIHRoaXMg
ZGV2aWNlCisgKgkJCQlAbWRldjogbWVkaWF0ZWQgZGV2aWNlCisgKgkJCQlSZXR1cm5zIHUzMjog
dmlydGlvIHZlbmRvciBpZAorICogQGdldF9zdGF0dXM6CQkJR2V0IHRoZSBkZXZpY2Ugc3RhdHVz
CisgKgkJCQlAbWRldjogbWVkaWF0ZWQgZGV2aWNlCisgKgkJCQlSZXR1cm5zIHU4OiB2aXJ0aW8g
ZGV2aWNlIHN0YXR1cworICogQHNldF9zdGF0dXM6CQkJU2V0IHRoZSBkZXZpY2Ugc3RhdHVzCisg
KgkJCQlAbWRldjogbWVkaWF0ZWQgZGV2aWNlCisgKgkJCQlAc3RhdHVzOiB2aXJ0aW8gZGV2aWNl
IHN0YXR1cworICogQGdldF9jb25maWc6CQkJUmVhZCBmcm9tIGRldmljZSBzcGVjaWZpYyBjb25m
aWd1cmF0aW9uIHNwYWNlCisgKgkJCQlAbWRldjogbWVkaWF0ZWQgZGV2aWNlCisgKgkJCQlAb2Zm
c2V0OiBvZmZzZXQgZnJvbSB0aGUgYmVnaW5uaW5nIG9mCisgKgkJCQljb25maWd1cmF0aW9uIHNw
YWNlCisgKgkJCQlAYnVmOiBidWZmZXIgdXNlZCB0byByZWFkIHRvCisgKgkJCQlAbGVuOiB0aGUg
bGVuZ3RoIHRvIHJlYWQgZnJvbQorICoJCQkJY29uZmlncmF0aW9uIHNwYWNlCisgKiBAc2V0X2Nv
bmZpZzoJCQlXcml0ZSB0byBkZXZpY2Ugc3BlY2lmaWMgY29uZmlndXJhdGlvbiBzcGFjZQorICoJ
CQkJQG1kZXY6IG1lZGlhdGVkIGRldmljZQorICoJCQkJQG9mZnNldDogb2Zmc2V0IGZyb20gdGhl
IGJlZ2lubmluZyBvZgorICoJCQkJY29uZmlndXJhdGlvbiBzcGFjZQorICoJCQkJQGJ1ZjogYnVm
ZmVyIHVzZWQgdG8gd3JpdGUgZnJvbQorICoJCQkJQGxlbjogdGhlIGxlbmd0aCB0byB3cml0ZSB0
bworICoJCQkJY29uZmlncmF0aW9uIHNwYWNlCisgKiBAZ2V0X2dlbmVyYXRpb246CQlHZXQgZGV2
aWNlIGNvbmZpZyBnZW5lcmF0b24gKG9wdGlvbmFsKQorICoJCQkJQG1kZXY6IG1lZGlhdGVkIGRl
dmljZQorICoJCQkJUmV0dXJucyB1MzI6IGRldmljZSBnZW5lcmF0aW9uCisgKi8KK3N0cnVjdCBt
ZGV2X3ZpcnRpb19kZXZpY2Vfb3BzIHsKKwkvKiBWaXJ0cXVldWUgb3BzICovCisJaW50ICgqc2V0
X3ZxX2FkZHJlc3MpKHN0cnVjdCBtZGV2X2RldmljZSAqbWRldiwKKwkJCSAgICAgIHUxNiBpZHgs
IHU2NCBkZXNjX2FyZWEsIHU2NCBkcml2ZXJfYXJlYSwKKwkJCSAgICAgIHU2NCBkZXZpY2VfYXJl
YSk7CisJdm9pZCAoKnNldF92cV9udW0pKHN0cnVjdCBtZGV2X2RldmljZSAqbWRldiwgdTE2IGlk
eCwgdTMyIG51bSk7CisJdm9pZCAoKmtpY2tfdnEpKHN0cnVjdCBtZGV2X2RldmljZSAqbWRldiwg
dTE2IGlkeCk7CisJdm9pZCAoKnNldF92cV9jYikoc3RydWN0IG1kZXZfZGV2aWNlICptZGV2LCB1
MTYgaWR4LAorCQkJICBzdHJ1Y3QgdmlydGlvX21kZXZfY2FsbGJhY2sgKmNiKTsKKwl2b2lkICgq
c2V0X3ZxX3JlYWR5KShzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYsIHUxNiBpZHgsIGJvb2wgcmVh
ZHkpOworCWJvb2wgKCpnZXRfdnFfcmVhZHkpKHN0cnVjdCBtZGV2X2RldmljZSAqbWRldiwgdTE2
IGlkeCk7CisJaW50ICgqc2V0X3ZxX3N0YXRlKShzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYsIHUx
NiBpZHgsIHU2NCBzdGF0ZSk7CisJdTY0ICgqZ2V0X3ZxX3N0YXRlKShzdHJ1Y3QgbWRldl9kZXZp
Y2UgKm1kZXYsIHUxNiBpZHgpOworCisJLyogVmlydGlvIGRldmljZSBvcHMgKi8KKwl1MTYgKCpn
ZXRfdnFfYWxpZ24pKHN0cnVjdCBtZGV2X2RldmljZSAqbWRldik7CisJdTY0ICgqZ2V0X2ZlYXR1
cmVzKShzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYpOworCWludCAoKnNldF9mZWF0dXJlcykoc3Ry
dWN0IG1kZXZfZGV2aWNlICptZGV2LCB1NjQgZmVhdHVyZXMpOworCXZvaWQgKCpzZXRfY29uZmln
X2NiKShzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYsCisJCQkgICAgICBzdHJ1Y3QgdmlydGlvX21k
ZXZfY2FsbGJhY2sgKmNiKTsKKwl1MTYgKCpnZXRfdnFfbnVtX21heCkoc3RydWN0IG1kZXZfZGV2
aWNlICptZGV2KTsKKwl1MzIgKCpnZXRfZGV2aWNlX2lkKShzdHJ1Y3QgbWRldl9kZXZpY2UgKm1k
ZXYpOworCXUzMiAoKmdldF92ZW5kb3JfaWQpKHN0cnVjdCBtZGV2X2RldmljZSAqbWRldik7CisJ
dTggKCpnZXRfc3RhdHVzKShzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYpOworCXZvaWQgKCpzZXRf
c3RhdHVzKShzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYsIHU4IHN0YXR1cyk7CisJdm9pZCAoKmdl
dF9jb25maWcpKHN0cnVjdCBtZGV2X2RldmljZSAqbWRldiwgdW5zaWduZWQgaW50IG9mZnNldCwK
KwkJCSAgIHZvaWQgKmJ1ZiwgdW5zaWduZWQgaW50IGxlbik7CisJdm9pZCAoKnNldF9jb25maWcp
KHN0cnVjdCBtZGV2X2RldmljZSAqbWRldiwgdW5zaWduZWQgaW50IG9mZnNldCwKKwkJCSAgIGNv
bnN0IHZvaWQgKmJ1ZiwgdW5zaWduZWQgaW50IGxlbik7CisJdTMyICgqZ2V0X2dlbmVyYXRpb24p
KHN0cnVjdCBtZGV2X2RldmljZSAqbWRldik7Cit9OworCit2b2lkIG1kZXZfc2V0X3ZpcnRpb19v
cHMoc3RydWN0IG1kZXZfZGV2aWNlICptZGV2LAorCQkJIGNvbnN0IHN0cnVjdCBtZGV2X3ZpcnRp
b19kZXZpY2Vfb3BzICp2aXJ0aW9fb3BzKTsKKworI2VuZGlmCi0tIAoyLjE5LjEKCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5n
IGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVk
ZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
