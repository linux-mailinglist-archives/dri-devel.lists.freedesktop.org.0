Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id B635C10699C
	for <lists+dri-devel@lfdr.de>; Fri, 22 Nov 2019 11:06:05 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B45CF6F50C;
	Fri, 22 Nov 2019 10:05:52 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id CBB1C6F50F
 for <dri-devel@lists.freedesktop.org>; Fri, 22 Nov 2019 10:05:50 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 73F4BB1B5;
 Fri, 22 Nov 2019 10:05:48 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: patrik.r.jakobsson@gmail.com,
	airlied@linux.ie,
	daniel@ffwll.ch
Subject: [PATCH 6/6] drm/gma500: Remove struct psb_fbdev
Date: Fri, 22 Nov 2019 11:05:45 +0100
Message-Id: <20191122100545.16812-7-tzimmermann@suse.de>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191122100545.16812-1-tzimmermann@suse.de>
References: <20191122100545.16812-1-tzimmermann@suse.de>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Zimmermann <tzimmermann@suse.de>, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

R21hNTAwJ3Mgc3RydWN0IHBzYl9mYmRldiBpcyBhbiwgb3RoZXJ3aXNlIGVtcHR5LCB3cmFwcGVy
IGFyb3VuZApzdHJ1Y3QgZHJtX2ZiX2hlbHBlci4gUmVtb3ZlIGl0LgoKU2lnbmVkLW9mZi1ieTog
VGhvbWFzIFppbW1lcm1hbm4gPHR6aW1tZXJtYW5uQHN1c2UuZGU+Ci0tLQogZHJpdmVycy9ncHUv
ZHJtL2dtYTUwMC9hY2NlbF8yZC5jICAgIHwgMTAgKystLQogZHJpdmVycy9ncHUvZHJtL2dtYTUw
MC9mcmFtZWJ1ZmZlci5jIHwgNzAgKysrKysrKysrKysrKystLS0tLS0tLS0tLS0tLQogZHJpdmVy
cy9ncHUvZHJtL2dtYTUwMC9mcmFtZWJ1ZmZlci5oIHwgIDYgLS0tCiBkcml2ZXJzL2dwdS9kcm0v
Z21hNTAwL3BzYl9kcnYuYyAgICAgfCAgMSArCiBkcml2ZXJzL2dwdS9kcm0vZ21hNTAwL3BzYl9k
cnYuaCAgICAgfCAgOCArKy0tCiA1IGZpbGVzIGNoYW5nZWQsIDQ1IGluc2VydGlvbnMoKyksIDUw
IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9nbWE1MDAvYWNjZWxf
MmQuYyBiL2RyaXZlcnMvZ3B1L2RybS9nbWE1MDAvYWNjZWxfMmQuYwppbmRleCAyYTYwYWRkMTBk
YmQuLmI5ZTVhMzg2MzJmNyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2dtYTUwMC9hY2Nl
bF8yZC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9nbWE1MDAvYWNjZWxfMmQuYwpAQCAtMjEsOSAr
MjEsOSBAQAogCiAjaW5jbHVkZSA8ZHJtL2RybS5oPgogI2luY2x1ZGUgPGRybS9kcm1fY3J0Yy5o
PgorI2luY2x1ZGUgPGRybS9kcm1fZmJfaGVscGVyLmg+CiAjaW5jbHVkZSA8ZHJtL2RybV9mb3Vy
Y2MuaD4KIAotI2luY2x1ZGUgImZyYW1lYnVmZmVyLmgiCiAjaW5jbHVkZSAicHNiX2Rydi5oIgog
I2luY2x1ZGUgInBzYl9yZWcuaCIKIApAQCAtMjI2LDggKzIyNiw4IEBAIHN0YXRpYyBpbnQgcHNi
X2FjY2VsXzJkX2NvcHkoc3RydWN0IGRybV9wc2JfcHJpdmF0ZSAqZGV2X3ByaXYsCiBzdGF0aWMg
dm9pZCBwc2JmYl9jb3B5YXJlYV9hY2NlbChzdHJ1Y3QgZmJfaW5mbyAqaW5mbywKIAkJCQkgY29u
c3Qgc3RydWN0IGZiX2NvcHlhcmVhICphKQogewotCXN0cnVjdCBwc2JfZmJkZXYgKmZiZGV2ID0g
aW5mby0+cGFyOwotCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gZmJkZXYtPnBzYl9mYl9o
ZWxwZXIuZmI7CisJc3RydWN0IGRybV9mYl9oZWxwZXIgKmZiX2hlbHBlciA9IGluZm8tPnBhcjsK
KwlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IGZiX2hlbHBlci0+ZmI7CiAJc3RydWN0IGRy
bV9kZXZpY2UgKmRldiA9IGZiLT5kZXY7CiAJc3RydWN0IGRybV9wc2JfcHJpdmF0ZSAqZGV2X3By
aXYgPSBkZXYtPmRldl9wcml2YXRlOwogCXVpbnQzMl90IG9mZnNldDsKQEAgLTMwOCw4ICszMDgs
OCBAQCB2b2lkIHBzYmZiX2NvcHlhcmVhKHN0cnVjdCBmYl9pbmZvICppbmZvLAogICovCiBpbnQg
cHNiZmJfc3luYyhzdHJ1Y3QgZmJfaW5mbyAqaW5mbykKIHsKLQlzdHJ1Y3QgcHNiX2ZiZGV2ICpm
YmRldiA9IGluZm8tPnBhcjsKLQlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IGZiZGV2LT5w
c2JfZmJfaGVscGVyLmZiOworCXN0cnVjdCBkcm1fZmJfaGVscGVyICpmYl9oZWxwZXIgPSBpbmZv
LT5wYXI7CisJc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBmYl9oZWxwZXItPmZiOwogCXN0
cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBmYi0+ZGV2OwogCXN0cnVjdCBkcm1fcHNiX3ByaXZhdGUg
KmRldl9wcml2ID0gZGV2LT5kZXZfcHJpdmF0ZTsKIAl1bnNpZ25lZCBsb25nIF9lbmQgPSBqaWZm
aWVzICsgSFo7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vZ21hNTAwL2ZyYW1lYnVmZmVy
LmMgYi9kcml2ZXJzL2dwdS9kcm0vZ21hNTAwL2ZyYW1lYnVmZmVyLmMKaW5kZXggMGM0NGJhOGMz
YTc5Li42NzQ1ZTNmNmEyZjAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9nbWE1MDAvZnJh
bWVidWZmZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vZ21hNTAwL2ZyYW1lYnVmZmVyLmMKQEAg
LTQwLDggKzQwLDggQEAgc3RhdGljIGludCBwc2JmYl9zZXRjb2xyZWcodW5zaWduZWQgcmVnbm8s
IHVuc2lnbmVkIHJlZCwgdW5zaWduZWQgZ3JlZW4sCiAJCQkgICB1bnNpZ25lZCBibHVlLCB1bnNp
Z25lZCB0cmFuc3AsCiAJCQkgICBzdHJ1Y3QgZmJfaW5mbyAqaW5mbykKIHsKLQlzdHJ1Y3QgcHNi
X2ZiZGV2ICpmYmRldiA9IGluZm8tPnBhcjsKLQlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9
IGZiZGV2LT5wc2JfZmJfaGVscGVyLmZiOworCXN0cnVjdCBkcm1fZmJfaGVscGVyICpmYl9oZWxw
ZXIgPSBpbmZvLT5wYXI7CisJc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBmYl9oZWxwZXIt
PmZiOwogCXVpbnQzMl90IHY7CiAKIAlpZiAoIWZiKQpAQCAtNzcsOCArNzcsOCBAQCBzdGF0aWMg
aW50IHBzYmZiX3NldGNvbHJlZyh1bnNpZ25lZCByZWdubywgdW5zaWduZWQgcmVkLCB1bnNpZ25l
ZCBncmVlbiwKIAogc3RhdGljIGludCBwc2JmYl9wYW4oc3RydWN0IGZiX3Zhcl9zY3JlZW5pbmZv
ICp2YXIsIHN0cnVjdCBmYl9pbmZvICppbmZvKQogewotCXN0cnVjdCBwc2JfZmJkZXYgKmZiZGV2
ID0gaW5mby0+cGFyOwotCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gZmJkZXYtPnBzYl9m
Yl9oZWxwZXIuZmI7CisJc3RydWN0IGRybV9mYl9oZWxwZXIgKmZiX2hlbHBlciA9IGluZm8tPnBh
cjsKKwlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IGZiX2hlbHBlci0+ZmI7CiAJc3RydWN0
IGRybV9kZXZpY2UgKmRldiA9IGZiLT5kZXY7CiAJc3RydWN0IGd0dF9yYW5nZSAqZ3R0ID0gdG9f
Z3R0X3JhbmdlKGZiLT5vYmpbMF0pOwogCkBAIC0xNDUsOCArMTQ1LDggQEAgc3RhdGljIGNvbnN0
IHN0cnVjdCB2bV9vcGVyYXRpb25zX3N0cnVjdCBwc2JmYl92bV9vcHMgPSB7CiAKIHN0YXRpYyBp
bnQgcHNiZmJfbW1hcChzdHJ1Y3QgZmJfaW5mbyAqaW5mbywgc3RydWN0IHZtX2FyZWFfc3RydWN0
ICp2bWEpCiB7Ci0Jc3RydWN0IHBzYl9mYmRldiAqZmJkZXYgPSBpbmZvLT5wYXI7Ci0Jc3RydWN0
IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBmYmRldi0+cHNiX2ZiX2hlbHBlci5mYjsKKwlzdHJ1Y3Qg
ZHJtX2ZiX2hlbHBlciAqZmJfaGVscGVyID0gaW5mby0+cGFyOworCXN0cnVjdCBkcm1fZnJhbWVi
dWZmZXIgKmZiID0gZmJfaGVscGVyLT5mYjsKIAogCWlmICh2bWEtPnZtX3Bnb2ZmICE9IDApCiAJ
CXJldHVybiAtRUlOVkFMOwpAQCAtMjk4LDEwICsyOTgsMTAgQEAgc3RhdGljIHN0cnVjdCBndHRf
cmFuZ2UgKnBzYmZiX2FsbG9jKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIGludCBhbGlnbmVkX3Np
emUpCiAgKgogICoJQ3JlYXRlIGEgZnJhbWVidWZmZXIgdG8gdGhlIHNwZWNpZmljYXRpb25zIHBy
b3ZpZGVkCiAgKi8KLXN0YXRpYyBpbnQgcHNiZmJfY3JlYXRlKHN0cnVjdCBwc2JfZmJkZXYgKmZi
ZGV2LAorc3RhdGljIGludCBwc2JmYl9jcmVhdGUoc3RydWN0IGRybV9mYl9oZWxwZXIgKmZiX2hl
bHBlciwKIAkJCQlzdHJ1Y3QgZHJtX2ZiX2hlbHBlcl9zdXJmYWNlX3NpemUgKnNpemVzKQogewot
CXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBmYmRldi0+cHNiX2ZiX2hlbHBlci5kZXY7CisJc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiA9IGZiX2hlbHBlci0+ZGV2OwogCXN0cnVjdCBkcm1fcHNiX3By
aXZhdGUgKmRldl9wcml2ID0gZGV2LT5kZXZfcHJpdmF0ZTsKIAlzdHJ1Y3QgZmJfaW5mbyAqaW5m
bzsKIAlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYjsKQEAgLTM2OSw3ICszNjksNyBAQCBzdGF0
aWMgaW50IHBzYmZiX2NyZWF0ZShzdHJ1Y3QgcHNiX2ZiZGV2ICpmYmRldiwKIAogCW1lbXNldChk
ZXZfcHJpdi0+dnJhbV9hZGRyICsgYmFja2luZy0+b2Zmc2V0LCAwLCBzaXplKTsKIAotCWluZm8g
PSBkcm1fZmJfaGVscGVyX2FsbG9jX2ZiaSgmZmJkZXYtPnBzYl9mYl9oZWxwZXIpOworCWluZm8g
PSBkcm1fZmJfaGVscGVyX2FsbG9jX2ZiaShmYl9oZWxwZXIpOwogCWlmIChJU19FUlIoaW5mbykp
IHsKIAkJcmV0ID0gUFRSX0VSUihpbmZvKTsKIAkJZ290byBvdXQ7CkBAIC0zODMsNyArMzgzLDcg
QEAgc3RhdGljIGludCBwc2JmYl9jcmVhdGUoc3RydWN0IHBzYl9mYmRldiAqZmJkZXYsCiAJCWdv
dG8gb3V0OwogCX0KIAotCWZiZGV2LT5wc2JfZmJfaGVscGVyLmZiID0gZmI7CisJZmJfaGVscGVy
LT5mYiA9IGZiOwogCiAJaWYgKGRldl9wcml2LT5vcHMtPmFjY2VsXzJkICYmIHBpdGNoX2xpbmVz
ID4gOCkJLyogMkQgZW5naW5lICovCiAJCWluZm8tPmZib3BzID0gJnBzYmZiX29wczsKQEAgLTQw
Nyw3ICs0MDcsNyBAQCBzdGF0aWMgaW50IHBzYmZiX2NyZWF0ZShzdHJ1Y3QgcHNiX2ZiZGV2ICpm
YmRldiwKIAkJaW5mby0+YXBlcnR1cmVzLT5yYW5nZXNbMF0uc2l6ZSA9IGRldl9wcml2LT5ndHQu
c3RvbGVuX3NpemU7CiAJfQogCi0JZHJtX2ZiX2hlbHBlcl9maWxsX2luZm8oaW5mbywgJmZiZGV2
LT5wc2JfZmJfaGVscGVyLCBzaXplcyk7CisJZHJtX2ZiX2hlbHBlcl9maWxsX2luZm8oaW5mbywg
ZmJfaGVscGVyLCBzaXplcyk7CiAKIAlpbmZvLT5maXgubW1pb19zdGFydCA9IHBjaV9yZXNvdXJj
ZV9zdGFydChkZXYtPnBkZXYsIDApOwogCWluZm8tPmZpeC5tbWlvX2xlbiA9IHBjaV9yZXNvdXJj
ZV9sZW4oZGV2LT5wZGV2LCAwKTsKQEAgLTQ0OCwxMiArNDQ4LDEwIEBAIHN0YXRpYyBzdHJ1Y3Qg
ZHJtX2ZyYW1lYnVmZmVyICpwc2JfdXNlcl9mcmFtZWJ1ZmZlcl9jcmVhdGUKIAlyZXR1cm4gcHNi
X2ZyYW1lYnVmZmVyX2NyZWF0ZShkZXYsIGNtZCwgb2JqKTsKIH0KIAotc3RhdGljIGludCBwc2Jm
Yl9wcm9iZShzdHJ1Y3QgZHJtX2ZiX2hlbHBlciAqaGVscGVyLAotCQkJCXN0cnVjdCBkcm1fZmJf
aGVscGVyX3N1cmZhY2Vfc2l6ZSAqc2l6ZXMpCitzdGF0aWMgaW50IHBzYmZiX3Byb2JlKHN0cnVj
dCBkcm1fZmJfaGVscGVyICpmYl9oZWxwZXIsCisJCSAgICAgICBzdHJ1Y3QgZHJtX2ZiX2hlbHBl
cl9zdXJmYWNlX3NpemUgKnNpemVzKQogewotCXN0cnVjdCBwc2JfZmJkZXYgKnBzYl9mYmRldiA9
Ci0JCWNvbnRhaW5lcl9vZihoZWxwZXIsIHN0cnVjdCBwc2JfZmJkZXYsIHBzYl9mYl9oZWxwZXIp
OwotCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBwc2JfZmJkZXYtPnBzYl9mYl9oZWxwZXIuZGV2
OworCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBmYl9oZWxwZXItPmRldjsKIAlzdHJ1Y3QgZHJt
X3BzYl9wcml2YXRlICpkZXZfcHJpdiA9IGRldi0+ZGV2X3ByaXZhdGU7CiAJaW50IGJ5dGVzcHA7
CiAKQEAgLTQ3MCwyMCArNDY4LDIxIEBAIHN0YXRpYyBpbnQgcHNiZmJfcHJvYmUoc3RydWN0IGRy
bV9mYl9oZWxwZXIgKmhlbHBlciwKICAgICAgICAgICAgICAgICBzaXplcy0+c3VyZmFjZV9kZXB0
aCA9IDE2OwogICAgICAgICB9CiAKLQlyZXR1cm4gcHNiZmJfY3JlYXRlKHBzYl9mYmRldiwgc2l6
ZXMpOworCXJldHVybiBwc2JmYl9jcmVhdGUoZmJfaGVscGVyLCBzaXplcyk7CiB9CiAKIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgZHJtX2ZiX2hlbHBlcl9mdW5jcyBwc2JfZmJfaGVscGVyX2Z1bmNzID0g
ewogCS5mYl9wcm9iZSA9IHBzYmZiX3Byb2JlLAogfTsKIAotc3RhdGljIGludCBwc2JfZmJkZXZf
ZGVzdHJveShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBzdHJ1Y3QgcHNiX2ZiZGV2ICpmYmRldikK
K3N0YXRpYyBpbnQgcHNiX2ZiZGV2X2Rlc3Ryb3koc3RydWN0IGRybV9kZXZpY2UgKmRldiwKKwkJ
CSAgICAgc3RydWN0IGRybV9mYl9oZWxwZXIgKmZiX2hlbHBlcikKIHsKLQlzdHJ1Y3QgZHJtX2Zy
YW1lYnVmZmVyICpmYiA9IGZiZGV2LT5wc2JfZmJfaGVscGVyLmZiOworCXN0cnVjdCBkcm1fZnJh
bWVidWZmZXIgKmZiID0gZmJfaGVscGVyLT5mYjsKIAotCWRybV9mYl9oZWxwZXJfdW5yZWdpc3Rl
cl9mYmkoJmZiZGV2LT5wc2JfZmJfaGVscGVyKTsKKwlkcm1fZmJfaGVscGVyX3VucmVnaXN0ZXJf
ZmJpKGZiX2hlbHBlcik7CiAKLQlkcm1fZmJfaGVscGVyX2ZpbmkoJmZiZGV2LT5wc2JfZmJfaGVs
cGVyKTsKKwlkcm1fZmJfaGVscGVyX2ZpbmkoZmJfaGVscGVyKTsKIAlkcm1fZnJhbWVidWZmZXJf
dW5yZWdpc3Rlcl9wcml2YXRlKGZiKTsKIAlkcm1fZnJhbWVidWZmZXJfY2xlYW51cChmYik7CiAK
QEAgLTQ5Niw0MiArNDk1LDQxIEBAIHN0YXRpYyBpbnQgcHNiX2ZiZGV2X2Rlc3Ryb3koc3RydWN0
IGRybV9kZXZpY2UgKmRldiwgc3RydWN0IHBzYl9mYmRldiAqZmJkZXYpCiAKIGludCBwc2JfZmJk
ZXZfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQogewotCXN0cnVjdCBwc2JfZmJkZXYgKmZi
ZGV2OworCXN0cnVjdCBkcm1fZmJfaGVscGVyICpmYl9oZWxwZXI7CiAJc3RydWN0IGRybV9wc2Jf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBkZXYtPmRldl9wcml2YXRlOwogCWludCByZXQ7CiAKLQlmYmRl
diA9IGt6YWxsb2Moc2l6ZW9mKHN0cnVjdCBwc2JfZmJkZXYpLCBHRlBfS0VSTkVMKTsKLQlpZiAo
IWZiZGV2KSB7CisJZmJfaGVscGVyID0ga3phbGxvYyhzaXplb2YoKmZiX2hlbHBlciksIEdGUF9L
RVJORUwpOworCWlmICghZmJfaGVscGVyKSB7CiAJCWRldl9lcnIoZGV2LT5kZXYsICJubyBtZW1v
cnlcbiIpOwogCQlyZXR1cm4gLUVOT01FTTsKIAl9CiAKLQlkZXZfcHJpdi0+ZmJkZXYgPSBmYmRl
djsKKwlkZXZfcHJpdi0+ZmJfaGVscGVyID0gZmJfaGVscGVyOwogCi0JZHJtX2ZiX2hlbHBlcl9w
cmVwYXJlKGRldiwgJmZiZGV2LT5wc2JfZmJfaGVscGVyLCAmcHNiX2ZiX2hlbHBlcl9mdW5jcyk7
CisJZHJtX2ZiX2hlbHBlcl9wcmVwYXJlKGRldiwgZmJfaGVscGVyLCAmcHNiX2ZiX2hlbHBlcl9m
dW5jcyk7CiAKLQlyZXQgPSBkcm1fZmJfaGVscGVyX2luaXQoZGV2LCAmZmJkZXYtPnBzYl9mYl9o
ZWxwZXIsCi0JCQkJIElOVEVMRkJfQ09OTl9MSU1JVCk7CisJcmV0ID0gZHJtX2ZiX2hlbHBlcl9p
bml0KGRldiwgZmJfaGVscGVyLCBJTlRFTEZCX0NPTk5fTElNSVQpOwogCWlmIChyZXQpCiAJCWdv
dG8gZnJlZTsKIAotCXJldCA9IGRybV9mYl9oZWxwZXJfc2luZ2xlX2FkZF9hbGxfY29ubmVjdG9y
cygmZmJkZXYtPnBzYl9mYl9oZWxwZXIpOworCXJldCA9IGRybV9mYl9oZWxwZXJfc2luZ2xlX2Fk
ZF9hbGxfY29ubmVjdG9ycyhmYl9oZWxwZXIpOwogCWlmIChyZXQpCiAJCWdvdG8gZmluaTsKIAog
CS8qIGRpc2FibGUgYWxsIHRoZSBwb3NzaWJsZSBvdXRwdXRzL2NydGNzIGJlZm9yZSBlbnRlcmlu
ZyBLTVMgbW9kZSAqLwogCWRybV9oZWxwZXJfZGlzYWJsZV91bnVzZWRfZnVuY3Rpb25zKGRldik7
CiAKLQlyZXQgPSBkcm1fZmJfaGVscGVyX2luaXRpYWxfY29uZmlnKCZmYmRldi0+cHNiX2ZiX2hl
bHBlciwgMzIpOworCXJldCA9IGRybV9mYl9oZWxwZXJfaW5pdGlhbF9jb25maWcoZmJfaGVscGVy
LCAzMik7CiAJaWYgKHJldCkKIAkJZ290byBmaW5pOwogCiAJcmV0dXJuIDA7CiAKIGZpbmk6Ci0J
ZHJtX2ZiX2hlbHBlcl9maW5pKCZmYmRldi0+cHNiX2ZiX2hlbHBlcik7CisJZHJtX2ZiX2hlbHBl
cl9maW5pKGZiX2hlbHBlcik7CiBmcmVlOgotCWtmcmVlKGZiZGV2KTsKKwlrZnJlZShmYl9oZWxw
ZXIpOwogCXJldHVybiByZXQ7CiB9CiAKQEAgLTUzOSwxMiArNTM3LDEyIEBAIHN0YXRpYyB2b2lk
IHBzYl9mYmRldl9maW5pKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCiB7CiAJc3RydWN0IGRybV9w
c2JfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkZXYtPmRldl9wcml2YXRlOwogCi0JaWYgKCFkZXZfcHJp
di0+ZmJkZXYpCisJaWYgKCFkZXZfcHJpdi0+ZmJfaGVscGVyKQogCQlyZXR1cm47CiAKLQlwc2Jf
ZmJkZXZfZGVzdHJveShkZXYsIGRldl9wcml2LT5mYmRldik7Ci0Ja2ZyZWUoZGV2X3ByaXYtPmZi
ZGV2KTsKLQlkZXZfcHJpdi0+ZmJkZXYgPSBOVUxMOworCXBzYl9mYmRldl9kZXN0cm95KGRldiwg
ZGV2X3ByaXYtPmZiX2hlbHBlcik7CisJa2ZyZWUoZGV2X3ByaXYtPmZiX2hlbHBlcik7CisJZGV2
X3ByaXYtPmZiX2hlbHBlciA9IE5VTEw7CiB9CiAKIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX21v
ZGVfY29uZmlnX2Z1bmNzIHBzYl9tb2RlX2Z1bmNzID0gewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2dtYTUwMC9mcmFtZWJ1ZmZlci5oIGIvZHJpdmVycy9ncHUvZHJtL2dtYTUwMC9mcmFt
ZWJ1ZmZlci5oCmluZGV4IGM3NWY0OGM0NDkyMS4uMmZiYmE0YjQ4ODQxIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vZ21hNTAwL2ZyYW1lYnVmZmVyLmgKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2dtYTUwMC9mcmFtZWJ1ZmZlci5oCkBAIC05LDE0ICs5LDggQEAKICNpZm5kZWYgX0ZSQU1FQlVG
RkVSX0hfCiAjZGVmaW5lIF9GUkFNRUJVRkZFUl9IXwogCi0jaW5jbHVkZSA8ZHJtL2RybV9mYl9o
ZWxwZXIuaD4KLQogI2luY2x1ZGUgInBzYl9kcnYuaCIKIAotc3RydWN0IHBzYl9mYmRldiB7Ci0J
c3RydWN0IGRybV9mYl9oZWxwZXIgcHNiX2ZiX2hlbHBlcjsgLyogbXVzdCBiZSBmaXJzdCAqLwot
fTsKLQogZXh0ZXJuIGludCBnbWFfY29ubmVjdG9yX2Nsb25lcyhzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2LCBpbnQgdHlwZV9tYXNrKTsKIAogI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vZ21hNTAwL3BzYl9kcnYuYyBiL2RyaXZlcnMvZ3B1L2RybS9nbWE1MDAvcHNiX2Rydi5jCmlu
ZGV4IDcwMDVmOGY2OWM2OC4uMTkyYTM5ZTUyNjE3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vZ21hNTAwL3BzYl9kcnYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vZ21hNTAwL3BzYl9kcnYu
YwpAQCAtMTksNiArMTksNyBAQAogCiAjaW5jbHVkZSA8ZHJtL2RybS5oPgogI2luY2x1ZGUgPGRy
bS9kcm1fZHJ2Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV9mYl9oZWxwZXIuaD4KICNpbmNsdWRlIDxk
cm0vZHJtX2ZpbGUuaD4KICNpbmNsdWRlIDxkcm0vZHJtX2lvY3RsLmg+CiAjaW5jbHVkZSA8ZHJt
L2RybV9pcnEuaD4KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9nbWE1MDAvcHNiX2Rydi5o
IGIvZHJpdmVycy9ncHUvZHJtL2dtYTUwMC9wc2JfZHJ2LmgKaW5kZXggOWIzYzAzZjRhMzhkLi4z
ZDRlZjMwNzFkNDUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9nbWE1MDAvcHNiX2Rydi5o
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9nbWE1MDAvcHNiX2Rydi5oCkBAIC0yMjksNiArMjI5LDgg
QEAgZW51bSB7CiAjZGVmaW5lIEtTRUxfQllQQVNTXzI1IDYKICNkZWZpbmUgS1NFTF9CWVBBU1Nf
ODNfMTAwIDcKIAorc3RydWN0IGRybV9mYl9oZWxwZXI7CisKIHN0cnVjdCBvcHJlZ2lvbl9oZWFk
ZXI7CiBzdHJ1Y3Qgb3ByZWdpb25fYWNwaTsKIHN0cnVjdCBvcHJlZ2lvbl9zd3NjaTsKQEAgLTQz
Miw3ICs0MzQsNyBAQCBzdHJ1Y3QgZHJtX3BzYl9wcml2YXRlIHsKIAlzdHJ1Y3QgcGNpX2RldiAq
bHBjX3BkZXY7IC8qIEN1cnJlbnRseSBvbmx5IHVzZWQgYnkgbXJzdCAqLwogCWNvbnN0IHN0cnVj
dCBwc2Jfb3BzICpvcHM7CiAJY29uc3Qgc3RydWN0IHBzYl9vZmZzZXQgKnJlZ21hcDsKLQkKKwog
CXN0cnVjdCBjaGlsZF9kZXZpY2VfY29uZmlnICpjaGlsZF9kZXY7CiAJaW50IGNoaWxkX2Rldl9u
dW07CiAKQEAgLTU0MCw3ICs1NDIsNyBAQCBzdHJ1Y3QgZHJtX3BzYl9wcml2YXRlIHsKIAogCS8q
IE9ha3RyYWlsIEhETUkgc3RhdGUgKi8KIAlzdHJ1Y3Qgb2FrdHJhaWxfaGRtaV9kZXYgKmhkbWlf
cHJpdjsKLQkKKwogCS8qIFJlZ2lzdGVyIHN0YXRlICovCiAJc3RydWN0IHBzYl9zYXZlX2FyZWEg
cmVnczsKIApAQCAtNTcyLDcgKzU3NCw3IEBAIHN0cnVjdCBkcm1fcHNiX3ByaXZhdGUgewogCXVp
bnQzMl90IGJsY19hZGoxOwogCXVpbnQzMl90IGJsY19hZGoyOwogCi0Jdm9pZCAqZmJkZXY7CisJ
c3RydWN0IGRybV9mYl9oZWxwZXIgKmZiX2hlbHBlcjsKIAogCS8qIDJEIGFjY2VsZXJhdGlvbiAq
LwogCXNwaW5sb2NrX3QgbG9ja18yZDsKLS0gCjIuMjMuMAoKX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2
ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21h
aWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
