Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id B0CB3DDFF0
	for <lists+dri-devel@lfdr.de>; Sun, 20 Oct 2019 20:19:49 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 173E089A4B;
	Sun, 20 Oct 2019 18:19:47 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from us-smtp-1.mimecast.com (us-smtp-delivery-1.mimecast.com
 [207.211.31.120])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 66EE389A56
 for <dri-devel@lists.freedesktop.org>; Sun, 20 Oct 2019 18:19:45 +0000 (UTC)
Received: from mimecast-mx01.redhat.com (mimecast-mx01.redhat.com
 [209.132.183.4]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-295-HhBXooJ3PU61AyvC2dJ_dQ-1; Sun, 20 Oct 2019 14:19:38 -0400
Received: from smtp.corp.redhat.com (int-mx05.intmail.prod.int.phx2.redhat.com
 [10.5.11.15])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mimecast-mx01.redhat.com (Postfix) with ESMTPS id 582B91005500;
 Sun, 20 Oct 2019 18:19:37 +0000 (UTC)
Received: from shalem.localdomain.com (ovpn-116-98.ams2.redhat.com
 [10.36.116.98])
 by smtp.corp.redhat.com (Postfix) with ESMTP id A85AC5D6A3;
 Sun, 20 Oct 2019 18:19:35 +0000 (UTC)
From: Hans de Goede <hdegoede@redhat.com>
To: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
 Jani Nikula <jani.nikula@linux.intel.com>,
 Joonas Lahtinen <joonas.lahtinen@linux.intel.com>,
 Rodrigo Vivi <rodrigo.vivi@intel.com>,
 =?UTF-8?q?Ville=20Syrj=C3=A4l=C3=A4?= <ville.syrjala@linux.intel.com>
Subject: [PATCH] drm/i915: Program LUT before intel_color_commit() if LUT was
 not previously set
Date: Sun, 20 Oct 2019 20:19:33 +0200
Message-Id: <20191020181933.54829-1-hdegoede@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.15
X-MC-Unique: HhBXooJ3PU61AyvC2dJ_dQ-1
X-Mimecast-Spam-Score: 0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=redhat.com; 
 s=mimecast20190719; t=1571595584;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding;
 bh=Vox23DInnqzKWHhCSR/qZP9c9d3PYc2CN3zl60k2Mjw=;
 b=PjjrbGSTgbRmojX/IEOdU9H+o/kMCI3NUU/vaElLPDIhYSgNcs+kpDUNh0Pa7psgKfGxSc
 rz4sCxnm/HHkeqyUCFgNO8zOdIr/qLZHbVCAve2G8g2OIaphn1naDI9UmOeXSGXh3pOlQF
 WiXUUULEMs1rmU8ZzQvREHjvhIptX5c=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Hans de Goede <hdegoede@redhat.com>,
 intel-gfx <intel-gfx@lists.freedesktop.org>, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

U2luY2UgY29tbWl0IDA1MWE2ZDhkM2NhMCAoImRybS9pOTE1OiBNb3ZlIExVVCBwcm9ncmFtbWlu
ZyB0byBoYXBwZW4gYWZ0ZXIKdmJsYW5rIHdhaXRzIiksIEkgYW0gc2VlaW5nIGFuIHVnbHkgY29s
b3JlZCBmbGFzaCBvZiB0aGUgZmlyc3QgZmV3IGRpc3BsYXkKbGluZXMgb24gMiBDaGVycnkgVHJh
aWwgZGV2aWNlcyB3aGVuIHRoZSBnYW1tYSB0YWJsZSBnZXRzIHNldCBmb3IgdGhlIGZpcnN0CnRp
bWUuIEEgYmx1ZSBmbGFzaCBvbiBhIEdQRCB3aW4gYW5kIGEgeWVsbG93IGZsYXNoIG9uIGFuIEFz
dXMgVDEwMEhBLgoKVGhlIHByb2JsZW0gaXMgdGhhdCBzaW5jZSB0aGlzIGNoYW5nZSwgdGhlIExV
VCBpcyBwcm9ncmFtbWVkIGFmdGVyIHRoZQp3cml0ZSAqYW5kIGxhdGNoaW5nKiBvZiB0aGUgZG91
YmxlLWJ1ZmZlcmVkIHJlZ2lzdGVyIHdoaWNoIGNhdXNlcyB0aGUgTFVUCnRvIGJlIHVzZWQgc3Rh
cnRpbmcgYXQgdGhlIG5leHQgZnJhbWUuIFRoaXMgbWVhbnMgdGhhdCB0aGUgb2xkIExVVCBpcyBz
dGlsbAp1c2VkIGZvciB0aGUgZmlyc3QgY291cGxlIG9mIGxpbmVzIG9mIHRoZSBkaXNwbGF5LiBJ
ZiBubyBMVVQgd2FzIGluIHVzZQpiZWZvcmUgdGhlbiB0aGUgTFVUIHJlZ2lzdGVycyBtYXkgY29u
dGFpbiBib2d1cyB2YWx1ZXMuIFRoaXMgbGVhZHMgdG8KbWVzc2VkIHVwIGNvbG9ycyB1bnRpbCB0
aGUgbmV3IExVVCB2YWx1ZXMgYXJlIHdyaXR0ZW4uIEF0IGxlYXN0IG9uIENIVCBEU0kKcGFuZWxz
IHRoaXMgY2F1c2VzIG1lc3NlZCB1cCBjb2xvcnMgb24gdGhlIGZpcnN0IGZldyBsaW5lcy4KClRo
aXMgY29tbWl0IGZpeGVzIHRoaXMgYnkgYWRkaW5nIGEgbG9hZF9sdXRfYmVmb3JlX2NvbW1pdCBi
b29sZWFuLAptb2RpZnlpbmcgaW50ZWxfYmVnaW5fY3J0Y19jb21taXQgdG8gbG9hZCB0aGUgbHV0
cyBlYXJsaWVyIGlmIHRoaXMgaXMgc2V0LAphbmQgc2V0dGluZyB0aGlzIGZyb20gaW50ZWxfY29s
b3JfY2hlY2sgd2hlbiBhIExVVCB0YWJsZSB3YXMgbm90IGluIHVzZQpiZWZvcmUgKGFuZCB0aHVz
IG1heSBjb250YWluIGJvZ3VzIHZhbHVlcyksIG9yIHdoZW4gdGhlIHRhYmxlIHNpemUKY2hhbmdl
cy4KCkZpeGVzOiAwNTFhNmQ4ZDNjYTAgKCJkcm0vaTkxNTogTW92ZSBMVVQgcHJvZ3JhbW1pbmcg
dG8gaGFwcGVuIGFmdGVyIHZibGFuayB3YWl0cyIpClNpZ25lZC1vZmYtYnk6IEhhbnMgZGUgR29l
ZGUgPGhkZWdvZWRlQHJlZGhhdC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9jb2xvci5jICAgIHwgMjYgKysrKysrKysrKysrKysrKysrKwogZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMgIHwgIDcgKysrKysKIC4uLi9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaCAgICB8ICAzICsrKwogMyBmaWxlcyBjaGFu
Z2VkLCAzNiBpbnNlcnRpb25zKCspCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9jb2xvci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9jb2xvci5jCmluZGV4IDcxYTAyMDE0MzdhOS4uMGRhNmRjYzViZWJkIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2NvbG9yLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9jb2xvci5jCkBAIC0xMDUyLDYgKzEwNTIsMzIgQEAg
aW50ZWxfY29sb3JfYWRkX2FmZmVjdGVkX3BsYW5lcyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
bmV3X2NydGNfc3RhdGUpCiAJCW5ld19jcnRjX3N0YXRlLT51cGRhdGVfcGxhbmVzIHw9IEJJVChw
bGFuZS0+aWQpOwogCX0KIAorCS8qCisJICogTm9ybWFsbHkgd2UgbG9hZCB0aGUgTFVUcyBhZnRl
ciB2YmxhbmsgLyBhZnRlciB0aGUgZG91YmxlLWJ1ZmZlcgorCSAqIHJlZ2lzdGVycyB3cml0dGVu
IGJ5IGNvbW1pdCBoYXZlIGJlZW4gbGF0Y2hlZCwgdGhpcyBhdm9pZHMgYQorCSAqIGdhbW1hIGNo
YW5nZSBtaWQtd2F5IHRoZSBzY3JlZW4uIFRoaXMgZG9lcyBtZWFuIHRoYXQgdGhlIGZpcnN0CisJ
ICogZmV3IGxpbmVzIG9mIHRoZSBkaXNwbGF5IHdpbGwgKHNvbWV0aW1lcykgc3RpbGwgdXNlIHRo
ZSBvbGQKKwkgKiB0YWJsZS4gVGhpcyBpcyBmaW5lIHdoZW4gY2hhbmdpbmcgYW4gZXhpc3Rpbmcg
TFVULCBidXQgaWYgdGhpcworCSAqIGlzIHRoZSBmaXJzdCB0aW1lIHRoZSBMVVQgZ2V0cyBsb2Fk
ZWQsIHRoZW4gdGhlIGh3IG1heSBjb250YWluCisJICogcmFuZG9tIHZhbHVlcywgY2F1c2luZyB0
aGUgZmlyc3QgbGluZXMgdG8gaGF2ZSBmdW5reSBjb2xvcnMuCisJICoKKwkgKiBTbyBpZiB3ZXJl
IGVuYWJsaW5nIGEgTFVUIGZvciB0aGUgZmlyc3QgdGltZSBvciBjaGFuZ2luZyB0aGUgdGFibGUK
KwkgKiBzaXplLCB0aGVuIHdlIG11c3QgZG8gdGhpcyBiZWZvcmUgdGhlIGNvbW1pdCB0byBhdm9p
ZCBjb3JydXB0aW5nCisJICogdGhlIGZpcnN0IGxpbmVzIG9mIHRoZSBkaXNwbGF5LgorCSAqLwor
CWlmICghb2xkX2NydGNfc3RhdGUtPmJhc2UuZ2FtbWFfbHV0ICYmIG5ld19jcnRjX3N0YXRlLT5i
YXNlLmdhbW1hX2x1dCkKKwkJbmV3X2NydGNfc3RhdGUtPmxvYWRfbHV0X2JlZm9yZV9jb21taXQg
PSB0cnVlOworCWVsc2UgaWYgKCFvbGRfY3J0Y19zdGF0ZS0+YmFzZS5kZWdhbW1hX2x1dCAmJgor
CQkgbmV3X2NydGNfc3RhdGUtPmJhc2UuZGVnYW1tYV9sdXQpCisJCW5ld19jcnRjX3N0YXRlLT5s
b2FkX2x1dF9iZWZvcmVfY29tbWl0ID0gdHJ1ZTsKKwllbHNlIGlmIChvbGRfY3J0Y19zdGF0ZS0+
YmFzZS5nYW1tYV9sdXQgJiYKKwkJIG5ld19jcnRjX3N0YXRlLT5iYXNlLmdhbW1hX2x1dCAmJgor
CQkgbHV0X2lzX2xlZ2FjeShvbGRfY3J0Y19zdGF0ZS0+YmFzZS5nYW1tYV9sdXQpICE9CisJCQls
dXRfaXNfbGVnYWN5KG5ld19jcnRjX3N0YXRlLT5iYXNlLmdhbW1hX2x1dCkpCisJCW5ld19jcnRj
X3N0YXRlLT5sb2FkX2x1dF9iZWZvcmVfY29tbWl0ID0gdHJ1ZTsKKwllbHNlCisJCW5ld19jcnRj
X3N0YXRlLT5sb2FkX2x1dF9iZWZvcmVfY29tbWl0ID0gZmFsc2U7CisKIAlyZXR1cm4gMDsKIH0K
IApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwppbmRleCBh
YTU0YmIyMjc5NmQuLjIxNDQyYjBkZDEzNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kaXNwbGF5LmMKQEAgLTE0MDMzLDYgKzE0MDMzLDcgQEAgc3RhdGljIHZvaWQg
aW50ZWxfYXRvbWljX2NvbW1pdF90YWlsKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRl
KQogCWZvcl9lYWNoX25ld19pbnRlbF9jcnRjX2luX3N0YXRlKHN0YXRlLCBjcnRjLCBuZXdfY3J0
Y19zdGF0ZSwgaSkgewogCQlpZiAobmV3X2NydGNfc3RhdGUtPmJhc2UuYWN0aXZlICYmCiAJCSAg
ICAhbmVlZHNfbW9kZXNldChuZXdfY3J0Y19zdGF0ZSkgJiYKKwkJICAgICFuZXdfY3J0Y19zdGF0
ZS0+bG9hZF9sdXRfYmVmb3JlX2NvbW1pdCAmJgogCQkgICAgKG5ld19jcnRjX3N0YXRlLT5iYXNl
LmNvbG9yX21nbXRfY2hhbmdlZCB8fAogCQkgICAgIG5ld19jcnRjX3N0YXRlLT51cGRhdGVfcGlw
ZSkpCiAJCQlpbnRlbF9jb2xvcl9sb2FkX2x1dHMobmV3X2NydGNfc3RhdGUpOwpAQCAtMTQ1Mjks
NiArMTQ1MzAsMTIgQEAgc3RhdGljIHZvaWQgaW50ZWxfYmVnaW5fY3J0Y19jb21taXQoc3RydWN0
IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCiAJCWludGVsX2F0b21pY19nZXRfbmV3X2NydGNf
c3RhdGUoc3RhdGUsIGNydGMpOwogCWJvb2wgbW9kZXNldCA9IG5lZWRzX21vZGVzZXQobmV3X2Ny
dGNfc3RhdGUpOwogCisJaWYgKCFtb2Rlc2V0ICYmCisJICAgIG5ld19jcnRjX3N0YXRlLT5sb2Fk
X2x1dF9iZWZvcmVfY29tbWl0ICYmCisJICAgIChuZXdfY3J0Y19zdGF0ZS0+YmFzZS5jb2xvcl9t
Z210X2NoYW5nZWQgfHwKKwkgICAgIG5ld19jcnRjX3N0YXRlLT51cGRhdGVfcGlwZSkpCisJCWlu
dGVsX2NvbG9yX2xvYWRfbHV0cyhuZXdfY3J0Y19zdGF0ZSk7CisKIAkvKiBQZXJmb3JtIHZibGFu
ayBldmFzaW9uIGFyb3VuZCBjb21taXQgb3BlcmF0aW9uICovCiAJaW50ZWxfcGlwZV91cGRhdGVf
c3RhcnQobmV3X2NydGNfc3RhdGUpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oCmluZGV4IDQ0OWFiYWVhNjE5Zi4uYmJkZWIzYmU2
NGU2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3Bs
YXlfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3Bs
YXlfdHlwZXMuaApAQCAtOTczLDYgKzk3Myw5IEBAIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlIHsK
IAkvKiBlbmFibGUgcGlwZSBjc2M/ICovCiAJYm9vbCBjc2NfZW5hYmxlOwogCisJLyogbG9hZCBs
dXRzIGJlZm9yZSBjb2xvciBzZXR0aW5ncyBjb21taXQgKi8KKwlib29sIGxvYWRfbHV0X2JlZm9y
ZV9jb21taXQ7CisKIAkvKiBEaXNwbGF5IFN0cmVhbSBjb21wcmVzc2lvbiBzdGF0ZSAqLwogCXN0
cnVjdCB7CiAJCWJvb2wgY29tcHJlc3Npb25fZW5hYmxlOwotLSAKMi4yMy4wCgpfX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBs
aXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVz
a3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
