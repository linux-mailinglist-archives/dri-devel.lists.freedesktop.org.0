Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id E480F109B84
	for <lists+dri-devel@lfdr.de>; Tue, 26 Nov 2019 10:53:27 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3B82F6E2C0;
	Tue, 26 Nov 2019 09:53:25 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from lelv0142.ext.ti.com (lelv0142.ext.ti.com [198.47.23.249])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A673E6E2B4
 for <dri-devel@lists.freedesktop.org>; Tue, 26 Nov 2019 09:53:19 +0000 (UTC)
Received: from fllv0034.itg.ti.com ([10.64.40.246])
 by lelv0142.ext.ti.com (8.15.2/8.15.2) with ESMTP id xAQ9rEwq006229;
 Tue, 26 Nov 2019 03:53:14 -0600
Received: from DLEE100.ent.ti.com (dlee100.ent.ti.com [157.170.170.30])
 by fllv0034.itg.ti.com (8.15.2/8.15.2) with ESMTPS id xAQ9rEvs087386
 (version=TLSv1.2 cipher=AES256-GCM-SHA384 bits=256 verify=FAIL);
 Tue, 26 Nov 2019 03:53:14 -0600
Received: from DLEE107.ent.ti.com (157.170.170.37) by DLEE100.ent.ti.com
 (157.170.170.30) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P256) id 15.1.1847.3; Tue, 26
 Nov 2019 03:53:13 -0600
Received: from fllv0039.itg.ti.com (10.64.41.19) by DLEE107.ent.ti.com
 (157.170.170.37) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P256) id 15.1.1847.3 via
 Frontend Transport; Tue, 26 Nov 2019 03:53:13 -0600
Received: from jadmar.ti.com (ileax41-snat.itg.ti.com [10.172.224.153])
 by fllv0039.itg.ti.com (8.15.2/8.15.2) with ESMTP id xAQ9r71k044654;
 Tue, 26 Nov 2019 03:53:10 -0600
From: Jyri Sarha <jsarha@ti.com>
To: <dri-devel@lists.freedesktop.org>
Subject: [PATCH 4/5] drm/tidss: New driver for TI Keystone platform Display
 SubSystem
Date: Tue, 26 Nov 2019 11:53:06 +0200
Message-ID: <22b946bd3ad7617f44b3705f785adb21c8593c80.1574760777.git.jsarha@ti.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <cover.1574760777.git.jsarha@ti.com>
References: <cover.1574760777.git.jsarha@ti.com>
MIME-Version: 1.0
X-EXCLAIMER-MD-CONFIG: e1e8a2fd-e40a-4ac6-ac9b-f7e9cc9ee180
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ti.com; s=ti-com-17Q1; t=1574761994;
 bh=SiNNRf49hyP5/C1uvIkBHv+kutvSkRntYv0u/qmURXs=;
 h=From:To:CC:Subject:Date:In-Reply-To:References;
 b=YPGLwCzuUiMJ8NPaYJ5HPyXVyHSnv4PfOBEsnvBpJGbkuzYEzQ0Keg3DnqHQJVkc5
 /FJT8VFAvtvOUERjdl+Vhn1SYVvRsstpKKY8xxF4Kbqz5Ma0Nsj5evwyd/UAQjwiGe
 683iaeI82WKOTnTDV687WzBR9396x4mfvy+sLjHQ=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: yamonkar@cadence.com, praneeth@ti.com, sjakhade@cadence.com,
 peter.ujfalusi@ti.com, tomi.valkeinen@ti.com,
 laurent.pinchart@ideasonboard.com, subhajit_paul@ti.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBwYXRjaCBhZGRzIGEgbmV3IERSTSBkcml2ZXIgZm9yIFRleGFzIEluc3RydW1lbnRzIERT
UyBJUHMgdXNlZCBvbgpUZXhhcyBJbnN0cnVtZW50cyBLZXlzdG9uZSBLMkcsIEFNNjV4LCBhbmQg
SjcyMWUgU29Dcy4gVGhlIG5ldyBEU1MgSVAgaXMKYSBtYWpvciBjaGFuZ2UgdG8gdGhlIG9sZGVy
IERTUyBJUCB2ZXJzaW9ucywgd2hpY2ggYXJlIHN1cHBvcnRlZCBieQp0aGUgb21hcGRybSBkcml2
ZXIuIFdoaWxlIG9uIGhpZ2hlciBsZXZlbCB0aGUgS2V5c3RvbmUgRFNTIHJlc2VtYmxlcwp0aGUg
b2xkZXIgRFNTIHZlcnNpb25zLCB0aGUgcmVnaXN0ZXJzIGFyZSBjb21wbGV0ZWx5IGRpZmZlcmVu
dCBhbmQgdGhlCmludGVybmFsIHBpcGVsaW5lcyBkaWZmZXIgYSBsb3QuCgpEU1MgSVAgZm91bmQg
b24gSzJHIGlzIGFuICJ1bHRyYS1saWdodCIgdmVyc2lvbiwgYW5kIGhhcyBvbmx5IGEgc2luZ2xl
CnBsYW5lIGFuZCBhIHNpbmdsZSBvdXRwdXQuIFRoZSBLZXlzdG9uZSAzIERTUyBJUHMgYXJlIGZv
dW5kIG9uIEFNNjV4CmFuZCBKNzIxRSBTb0NzLiBBTTY1eCBEU1MgaGFzIHR3byB2aWRlbyBwb3J0
cywgb25lIGZ1bGwgdmlkZW8gcGxhbmUsCmFuZCBhbm90aGVyICJsaXRlIiBwbGFuZSB3aXRob3V0
IHNjYWxpbmcgc3VwcG9ydC4gSjcyMUUgaGFzIDQgdmlkZW8KcG9ydHMsIDIgdmlkZW8gcGxhbmVz
IGFuZCAyIGxpdGUgcGxhbmVzLiBBTTY1eCBEU1MgaGFzIGFsc28gaW50ZWdyYXRlZApPTERJIChM
VkRTKSBvdXRwdXQuCgpDby1kZXZlbG9wZWQtYnk6IFRvbWkgVmFsa2VpbmVuIDx0b21pLnZhbGtl
aW5lbkB0aS5jb20+ClNpZ25lZC1vZmYtYnk6IEp5cmkgU2FyaGEgPGpzYXJoYUB0aS5jb20+Ci0t
LQogZHJpdmVycy9ncHUvZHJtL0tjb25maWcgICAgICAgICAgICAgICAgICAgfCAgICAyICsKIGRy
aXZlcnMvZ3B1L2RybS9NYWtlZmlsZSAgICAgICAgICAgICAgICAgIHwgICAgMSArCiBkcml2ZXJz
L2dwdS9kcm0vdGlkc3MvS2NvbmZpZyAgICAgICAgICAgICB8ICAgMTUgKwogZHJpdmVycy9ncHUv
ZHJtL3RpZHNzL01ha2VmaWxlICAgICAgICAgICAgfCAgIDEyICsKIGRyaXZlcnMvZ3B1L2RybS90
aWRzcy90aWRzc19jcnRjLmMgICAgICAgIHwgIDM3MyArKysKIGRyaXZlcnMvZ3B1L2RybS90aWRz
cy90aWRzc19jcnRjLmggICAgICAgIHwgICA0NSArCiBkcml2ZXJzL2dwdS9kcm0vdGlkc3MvdGlk
c3NfZGlzcGMuYyAgICAgICB8IDI2NDUgKysrKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL2dw
dS9kcm0vdGlkc3MvdGlkc3NfZGlzcGMuaCAgICAgICB8ICAxMzIgKwogZHJpdmVycy9ncHUvZHJt
L3RpZHNzL3RpZHNzX2Rpc3BjX3JlZ3MuaCAgfCAgMjQzICsrCiBkcml2ZXJzL2dwdS9kcm0vdGlk
c3MvdGlkc3NfZHJ2LmMgICAgICAgICB8ICAyOTIgKysrCiBkcml2ZXJzL2dwdS9kcm0vdGlkc3Mv
dGlkc3NfZHJ2LmggICAgICAgICB8ICAgNDIgKwogZHJpdmVycy9ncHUvZHJtL3RpZHNzL3RpZHNz
X2VuY29kZXIuYyAgICAgfCAgIDg5ICsKIGRyaXZlcnMvZ3B1L2RybS90aWRzcy90aWRzc19lbmNv
ZGVyLmggICAgIHwgICAxNyArCiBkcml2ZXJzL2dwdS9kcm0vdGlkc3MvdGlkc3NfaXJxLmMgICAg
ICAgICB8ICAxODUgKysKIGRyaXZlcnMvZ3B1L2RybS90aWRzcy90aWRzc19pcnEuaCAgICAgICAg
IHwgICA3MSArCiBkcml2ZXJzL2dwdS9kcm0vdGlkc3MvdGlkc3Nfa21zLmMgICAgICAgICB8ICAy
MzkgKysKIGRyaXZlcnMvZ3B1L2RybS90aWRzcy90aWRzc19rbXMuaCAgICAgICAgIHwgICAxNSAr
CiBkcml2ZXJzL2dwdS9kcm0vdGlkc3MvdGlkc3NfcGxhbmUuYyAgICAgICB8ICAyMTggKysKIGRy
aXZlcnMvZ3B1L2RybS90aWRzcy90aWRzc19wbGFuZS5oICAgICAgIHwgICAyNSArCiBkcml2ZXJz
L2dwdS9kcm0vdGlkc3MvdGlkc3Nfc2NhbGVfY29lZnMuYyB8ICAyMDEgKysKIGRyaXZlcnMvZ3B1
L2RybS90aWRzcy90aWRzc19zY2FsZV9jb2Vmcy5oIHwgICAyMiArCiAyMSBmaWxlcyBjaGFuZ2Vk
LCA0ODg0IGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0v
dGlkc3MvS2NvbmZpZwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS90aWRzcy9N
YWtlZmlsZQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS90aWRzcy90aWRzc19j
cnRjLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vdGlkc3MvdGlkc3NfY3J0
Yy5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL3RpZHNzL3RpZHNzX2Rpc3Bj
LmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vdGlkc3MvdGlkc3NfZGlzcGMu
aAogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS90aWRzcy90aWRzc19kaXNwY19y
ZWdzLmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vdGlkc3MvdGlkc3NfZHJ2
LmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vdGlkc3MvdGlkc3NfZHJ2LmgK
IGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vdGlkc3MvdGlkc3NfZW5jb2Rlci5j
CiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL3RpZHNzL3RpZHNzX2VuY29kZXIu
aAogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS90aWRzcy90aWRzc19pcnEuYwog
Y3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS90aWRzcy90aWRzc19pcnEuaAogY3Jl
YXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS90aWRzcy90aWRzc19rbXMuYwogY3JlYXRl
IG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS90aWRzcy90aWRzc19rbXMuaAogY3JlYXRlIG1v
ZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS90aWRzcy90aWRzc19wbGFuZS5jCiBjcmVhdGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL3RpZHNzL3RpZHNzX3BsYW5lLmgKIGNyZWF0ZSBtb2Rl
IDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vdGlkc3MvdGlkc3Nfc2NhbGVfY29lZnMuYwogY3JlYXRl
IG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS90aWRzcy90aWRzc19zY2FsZV9jb2Vmcy5oCgpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL0tjb25maWcgYi9kcml2ZXJzL2dwdS9kcm0vS2Nv
bmZpZwppbmRleCBlNjdjMTk0YzJhY2EuLjIzM2Q5NGJlODE4MSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL0tjb25maWcKKysrIGIvZHJpdmVycy9ncHUvZHJtL0tjb25maWcKQEAgLTM1OCw2
ICszNTgsOCBAQCBzb3VyY2UgImRyaXZlcnMvZ3B1L2RybS9hc3BlZWQvS2NvbmZpZyIKIAogc291
cmNlICJkcml2ZXJzL2dwdS9kcm0vbWNkZS9LY29uZmlnIgogCitzb3VyY2UgImRyaXZlcnMvZ3B1
L2RybS90aWRzcy9LY29uZmlnIgorCiAjIEtlZXAgbGVnYWN5IGRyaXZlcnMgbGFzdAogCiBtZW51
Y29uZmlnIERSTV9MRUdBQ1kKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9NYWtlZmlsZSBi
L2RyaXZlcnMvZ3B1L2RybS9NYWtlZmlsZQppbmRleCA4MmZmODI2YjMzY2MuLmVkYmExNjNlOWZj
NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL01ha2VmaWxlCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9NYWtlZmlsZQpAQCAtMTIwLDMgKzEyMCw0IEBAIG9iai0kKENPTkZJR19EUk1fTElNQSkg
ICs9IGxpbWEvCiBvYmotJChDT05GSUdfRFJNX1BBTkZST1NUKSArPSBwYW5mcm9zdC8KIG9iai0k
KENPTkZJR19EUk1fQVNQRUVEX0dGWCkgKz0gYXNwZWVkLwogb2JqLSQoQ09ORklHX0RSTV9NQ0RF
KSArPSBtY2RlLworb2JqLSQoQ09ORklHX0RSTV9USURTUykgKz0gdGlkc3MvCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vdGlkc3MvS2NvbmZpZyBiL2RyaXZlcnMvZ3B1L2RybS90aWRzcy9L
Y29uZmlnCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMzNlNTA1MTcz
YmY4Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL3RpZHNzL0tjb25maWcKQEAg
LTAsMCArMSwxNSBAQAorY29uZmlnIERSTV9USURTUworCXRyaXN0YXRlICJEUk0gU3VwcG9ydCBm
b3IgVEkgS2V5c3RvbmUiCisJZGVwZW5kcyBvbiBEUk0gJiYgT0YKKwlkZXBlbmRzIG9uIEFSTSB8
fCBBUk02NCB8fCBDT01QSUxFX1RFU1QKKwlzZWxlY3QgRFJNX0tNU19IRUxQRVIKKwlzZWxlY3Qg
RFJNX0tNU19DTUFfSEVMUEVSCisJc2VsZWN0IERSTV9HRU1fQ01BX0hFTFBFUgorCXNlbGVjdCBW
SURFT01PREVfSEVMUEVSUworCWhlbHAKKwkgIFRoZSBUSSBLZXlzdG9uZSBmYW1pbHkgU29DcyBp
bnRyb2R1Y2VkIGEgbmV3IGdlbmVyYXRpb24gb2YKKwkgIERpc3BsYXkgU3ViU3lzdGVtLiBUaGVy
ZSBpcyBjdXJyZW50bHkgdGhyZWUgS2V5c3RvbmUgZmFtaWx5CisJICBTb0NzIHJlbGVhc2VkIHdp
dGggRFNTLiBFYWNoIHdpdGggc29tZXdoYXQgZGlmZmVyZW50IHZlcnNpb24KKwkgIG9mIGl0LiBU
aGUgU29DcyBhcmUgNjZBSzJHeCwgQU02NXgsIGFuZCBKNzIxRS4gU2V0IHRoaXMgdG8gWQorCSAg
b3IgTSB0byBhZGQgZGlzcGxheSBzdXBwb3J0IGZvciBUSSBLZXlzdG9uZSBmYW1pbHkKKwkgIHBs
YXRmb3Jtcy4KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90aWRzcy9NYWtlZmlsZSBiL2Ry
aXZlcnMvZ3B1L2RybS90aWRzcy9NYWtlZmlsZQpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAw
MDAwMDAwMDAwMDAuLjMxMjY0NTI3MTAxNAotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS90aWRzcy9NYWtlZmlsZQpAQCAtMCwwICsxLDEyIEBACisjIFNQRFgtTGljZW5zZS1JZGVu
dGlmaWVyOiBHUEwtMi4wCisKK3RpZHNzLXkgOj0gdGlkc3NfY3J0Yy5vIFwKKwl0aWRzc19kcnYu
byBcCisJdGlkc3NfZW5jb2Rlci5vIFwKKwl0aWRzc19rbXMubyBcCisJdGlkc3NfaXJxLm8gXAor
CXRpZHNzX3BsYW5lLm8gXAorCXRpZHNzX3NjYWxlX2NvZWZzLm8gXAorCXRpZHNzX2Rpc3BjLm8K
Kworb2JqLSQoQ09ORklHX0RSTV9USURTUykgKz0gdGlkc3MubwpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL3RpZHNzL3RpZHNzX2NydGMuYyBiL2RyaXZlcnMvZ3B1L2RybS90aWRzcy90aWRz
c19jcnRjLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4zZjMzY2Y2
NDQzODMKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vdGlkc3MvdGlkc3NfY3J0
Yy5jCkBAIC0wLDAgKzEsMzczIEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIu
MAorLyoKKyAqIENvcHlyaWdodCAoQykgMjAxOCBUZXhhcyBJbnN0cnVtZW50cyBJbmNvcnBvcmF0
ZWQgLSBodHRwOi8vd3d3LnRpLmNvbS8KKyAqIEF1dGhvcjogVG9taSBWYWxrZWluZW4gPHRvbWku
dmFsa2VpbmVuQHRpLmNvbT4KKyAqLworCisjaW5jbHVkZSA8ZHJtL2RybVAuaD4KKyNpbmNsdWRl
IDxkcm0vZHJtX2F0b21pYy5oPgorI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljX2hlbHBlci5oPgor
I2luY2x1ZGUgPGRybS9kcm1fY3J0Yy5oPgorI2luY2x1ZGUgPGRybS9kcm1fY3J0Y19oZWxwZXIu
aD4KKyNpbmNsdWRlIDxkcm0vZHJtX2ZiX2NtYV9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJt
X2dlbV9jbWFfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wbGFuZV9oZWxwZXIuaD4KKwor
I2luY2x1ZGUgInRpZHNzX2NydGMuaCIKKyNpbmNsdWRlICJ0aWRzc19kaXNwYy5oIgorI2luY2x1
ZGUgInRpZHNzX2Rydi5oIgorI2luY2x1ZGUgInRpZHNzX2lycS5oIgorCisvKiBQYWdlIGZsaXAg
YW5kIGZyYW1lIGRvbmUgSVJRcyAqLworCitzdGF0aWMgdm9pZCB0aWRzc19jcnRjX2ZpbmlzaF9w
YWdlX2ZsaXAoc3RydWN0IHRpZHNzX2NydGMgKnRjcnRjKQoreworCXN0cnVjdCBkcm1fZGV2aWNl
ICpkZGV2ID0gdGNydGMtPmNydGMuZGV2OworCXN0cnVjdCB0aWRzc19kZXZpY2UgKnRpZHNzID0g
ZGRldi0+ZGV2X3ByaXZhdGU7CisJc3RydWN0IGRybV9wZW5kaW5nX3ZibGFua19ldmVudCAqZXZl
bnQ7CisJdW5zaWduZWQgbG9uZyBmbGFnczsKKwlib29sIGJ1c3k7CisKKwlzcGluX2xvY2tfaXJx
c2F2ZSgmZGRldi0+ZXZlbnRfbG9jaywgZmxhZ3MpOworCisJLyoKKwkgKiBOZXcgc2V0dGluZ3Mg
YXJlIHRha2VuIGludG8gdXNlIGF0IFZGUCwgYW5kIEdPIGJpdCBpcyBjbGVhcmVkIGF0CisJICog
dGhlIHNhbWUgdGltZS4gVGhpcyBoYXBwZW5zIGJlZm9yZSB0aGUgdmVydGljYWwgYmxhbmsgaW50
ZXJydXB0LgorCSAqIFNvIHRoZXJlIGlzIGEgc21hbGwgY2hhbmdlIHRoYXQgdGhlIGRyaXZlciBz
ZXRzIEdPIGJpdCBhZnRlciBWRlAsIGJ1dAorCSAqIGJlZm9yZSB2YmxhbmssIGFuZCB3ZSBoYXZl
IHRvIGNoZWNrIGZvciB0aGF0IGNhc2UgaGVyZS4KKwkgKi8KKwlidXN5ID0gZGlzcGNfdnBfZ29f
YnVzeSh0aWRzcy0+ZGlzcGMsIHRjcnRjLT5od192aWRlb3BvcnQpOworCWlmIChidXN5KSB7CisJ
CXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRkZXYtPmV2ZW50X2xvY2ssIGZsYWdzKTsKKwkJcmV0
dXJuOworCX0KKworCWV2ZW50ID0gdGNydGMtPmV2ZW50OworCXRjcnRjLT5ldmVudCA9IE5VTEw7
CisKKwlpZiAoIWV2ZW50KSB7CisJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRkZXYtPmV2ZW50
X2xvY2ssIGZsYWdzKTsKKwkJcmV0dXJuOworCX0KKworCWRybV9jcnRjX3NlbmRfdmJsYW5rX2V2
ZW50KCZ0Y3J0Yy0+Y3J0YywgZXZlbnQpOworCisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZGRl
di0+ZXZlbnRfbG9jaywgZmxhZ3MpOworCisJZHJtX2NydGNfdmJsYW5rX3B1dCgmdGNydGMtPmNy
dGMpOworfQorCit2b2lkIHRpZHNzX2NydGNfdmJsYW5rX2lycShzdHJ1Y3QgZHJtX2NydGMgKmNy
dGMpCit7CisJc3RydWN0IHRpZHNzX2NydGMgKnRjcnRjID0gdG9fdGlkc3NfY3J0YyhjcnRjKTsK
KworCWRybV9jcnRjX2hhbmRsZV92YmxhbmsoY3J0Yyk7CisKKwl0aWRzc19jcnRjX2ZpbmlzaF9w
YWdlX2ZsaXAodGNydGMpOworfQorCit2b2lkIHRpZHNzX2NydGNfZnJhbWVkb25lX2lycShzdHJ1
Y3QgZHJtX2NydGMgKmNydGMpCit7CisJc3RydWN0IHRpZHNzX2NydGMgKnRjcnRjID0gdG9fdGlk
c3NfY3J0YyhjcnRjKTsKKworCWNvbXBsZXRlKCZ0Y3J0Yy0+ZnJhbWVkb25lX2NvbXBsZXRpb24p
OworfQorCit2b2lkIHRpZHNzX2NydGNfZXJyb3JfaXJxKHN0cnVjdCBkcm1fY3J0YyAqY3J0Yywg
dTY0IGlycXN0YXR1cykKK3sKKwlzdHJ1Y3QgdGlkc3NfY3J0YyAqdGNydGMgPSB0b190aWRzc19j
cnRjKGNydGMpOworCisJZGV2X2Vycl9yYXRlbGltaXRlZChjcnRjLT5kZXYtPmRldiwgIkNSVEMl
dSBTWU5DIExPU1Q6IChpcnEgJWxseClcbiIsCisJCQkgICAgdGNydGMtPmh3X3ZpZGVvcG9ydCwg
aXJxc3RhdHVzKTsKK30KKworLyogZHJtX2NydGNfaGVscGVyX2Z1bmNzICovCisKK3N0YXRpYyBp
bnQgdGlkc3NfY3J0Y19hdG9taWNfY2hlY2soc3RydWN0IGRybV9jcnRjICpjcnRjLAorCQkJCSAg
IHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqc3RhdGUpCit7CisJc3RydWN0IGRybV9kZXZpY2UgKmRk
ZXYgPSBjcnRjLT5kZXY7CisJc3RydWN0IHRpZHNzX2RldmljZSAqdGlkc3MgPSBkZGV2LT5kZXZf
cHJpdmF0ZTsKKwlzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYyA9IHRpZHNzLT5kaXNwYzsKKwlz
dHJ1Y3QgdGlkc3NfY3J0YyAqdGNydGMgPSB0b190aWRzc19jcnRjKGNydGMpOworCXUzMiBod192
aWRlb3BvcnQgPSB0Y3J0Yy0+aHdfdmlkZW9wb3J0OworCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxh
eV9tb2RlICptb2RlOworCWVudW0gZHJtX21vZGVfc3RhdHVzIG9rOworCisJZGV2X2RiZyhkZGV2
LT5kZXYsICIlc1xuIiwgX19mdW5jX18pOworCisJaWYgKCFzdGF0ZS0+ZW5hYmxlKQorCQlyZXR1
cm4gMDsKKworCW1vZGUgPSAmc3RhdGUtPmFkanVzdGVkX21vZGU7CisKKwlvayA9IGRpc3BjX3Zw
X21vZGVfdmFsaWQoZGlzcGMsIGh3X3ZpZGVvcG9ydCwgbW9kZSk7CisJaWYgKG9rICE9IE1PREVf
T0spIHsKKwkJZGV2X2RiZyhkZGV2LT5kZXYsICIlczogYmFkIG1vZGU6ICV1eCV1IHBjbGsgJXUg
a0h6XG4iLAorCQkJX19mdW5jX18sIG1vZGUtPmhkaXNwbGF5LCBtb2RlLT52ZGlzcGxheSwgbW9k
ZS0+Y2xvY2spOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlyZXR1cm4gZGlzcGNfdnBfYnVz
X2NoZWNrKGRpc3BjLCBod192aWRlb3BvcnQsIHN0YXRlKTsKK30KKworc3RhdGljIHZvaWQgdGlk
c3NfY3J0Y19hdG9taWNfZmx1c2goc3RydWN0IGRybV9jcnRjICpjcnRjLAorCQkJCSAgICBzdHJ1
Y3QgZHJtX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlKQoreworCXN0cnVjdCB0aWRzc19jcnRj
ICp0Y3J0YyA9IHRvX3RpZHNzX2NydGMoY3J0Yyk7CisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYg
PSBjcnRjLT5kZXY7CisJc3RydWN0IHRpZHNzX2RldmljZSAqdGlkc3MgPSBkZGV2LT5kZXZfcHJp
dmF0ZTsKKwl1bnNpZ25lZCBsb25nIGZsYWdzOworCisJZGV2X2RiZyhkZGV2LT5kZXYsCisJCSIl
czogJXMgZW5hYmxlZCAlZCwgbmVlZHMgbW9kZXNldCAlZCwgZXZlbnQgJXBcbiIsIF9fZnVuY19f
LAorCQljcnRjLT5uYW1lLCBkcm1fYXRvbWljX2NydGNfbmVlZHNfbW9kZXNldChjcnRjLT5zdGF0
ZSksCisJCWNydGMtPnN0YXRlLT5lbmFibGUsIGNydGMtPnN0YXRlLT5ldmVudCk7CisKKwkvKiBU
aGVyZSBpcyBub3RoaW5nIHRvIGRvIGlmIENSVEMgaXMgbm90IGdvaW5nIHRvIGJlIGVuYWJsZWQu
ICovCisJaWYgKCFjcnRjLT5zdGF0ZS0+ZW5hYmxlKQorCQlyZXR1cm47CisKKwkvKiBXcml0ZSBj
b2xvciBtYW5hZ2VtZW50IHByb3BlcnRpZXMgdG8gSFcgaWYgbmVlZGVkLiAqLworCWRpc3BjX3Zw
X3NldHVwKHRpZHNzLT5kaXNwYywgdGNydGMtPmh3X3ZpZGVvcG9ydCwgY3J0Yy0+c3RhdGUpOwor
CisJLyogRmx1c2ggQ1JUQyBjaGFuZ2VzIHdpdGggZ28gYml0IG9ubHkgaWYgbm8gbmV3IG1vZGVz
ZXQgaXMgY29taW5nLiAqLworCWlmIChkcm1fYXRvbWljX2NydGNfbmVlZHNfbW9kZXNldChjcnRj
LT5zdGF0ZSkpCisJCXJldHVybjsKKworCS8qIElmIHRoZSBHTyBiaXQgaXMgc3R1Y2sgd2UgYmV0
dGVyIHF1aXQgaGVyZS4gKi8KKwlpZiAoV0FSTl9PTihkaXNwY192cF9nb19idXN5KHRpZHNzLT5k
aXNwYywgdGNydGMtPmh3X3ZpZGVvcG9ydCkpKQorCQlyZXR1cm47CisKKwkvKiBXZSBzaG91bGQg
aGF2ZSBldmVudCBpZiBDUlRDIGlzIGVuYWJsZWQgdGhyb3VnaCBvdXQgdGhpcyBjb21taXQuICov
CisJaWYgKFdBUk5fT04oIWNydGMtPnN0YXRlLT5ldmVudCkpCisJCXJldHVybjsKKworCVdBUk5f
T04oZHJtX2NydGNfdmJsYW5rX2dldChjcnRjKSAhPSAwKTsKKworCXNwaW5fbG9ja19pcnFzYXZl
KCZkZGV2LT5ldmVudF9sb2NrLCBmbGFncyk7CisJZGlzcGNfdnBfZ28odGlkc3MtPmRpc3BjLCB0
Y3J0Yy0+aHdfdmlkZW9wb3J0KTsKKworCVdBUk5fT04odGNydGMtPmV2ZW50KTsKKworCXRjcnRj
LT5ldmVudCA9IGNydGMtPnN0YXRlLT5ldmVudDsKKwljcnRjLT5zdGF0ZS0+ZXZlbnQgPSBOVUxM
OworCisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZGRldi0+ZXZlbnRfbG9jaywgZmxhZ3MpOwor
fQorCitzdGF0aWMgdm9pZCB0aWRzc19jcnRjX2F0b21pY19lbmFibGUoc3RydWN0IGRybV9jcnRj
ICpjcnRjLAorCQkJCSAgICAgc3RydWN0IGRybV9jcnRjX3N0YXRlICpvbGRfc3RhdGUpCit7CisJ
c3RydWN0IHRpZHNzX2NydGMgKnRjcnRjID0gdG9fdGlkc3NfY3J0YyhjcnRjKTsKKwlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGRldiA9IGNydGMtPmRldjsKKwlzdHJ1Y3QgdGlkc3NfZGV2aWNlICp0aWRz
cyA9IGRkZXYtPmRldl9wcml2YXRlOworCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICpt
b2RlID0gJmNydGMtPnN0YXRlLT5hZGp1c3RlZF9tb2RlOworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7
CisJaW50IHI7CisKKwlkZXZfZGJnKGRkZXYtPmRldiwgIiVzLCBldmVudCAlcFxuIiwgX19mdW5j
X18sIGNydGMtPnN0YXRlLT5ldmVudCk7CisKKwl0aWRzc19ydW50aW1lX2dldCh0aWRzcyk7CisK
KwlyID0gZGlzcGNfdnBfc2V0X2Nsa19yYXRlKHRpZHNzLT5kaXNwYywgdGNydGMtPmh3X3ZpZGVv
cG9ydCwKKwkJCQkgIG1vZGUtPmNsb2NrICogMTAwMCk7CisJaWYgKHIgIT0gMCkKKwkJcmV0dXJu
OworCisJciA9IGRpc3BjX3ZwX2VuYWJsZV9jbGsodGlkc3MtPmRpc3BjLCB0Y3J0Yy0+aHdfdmlk
ZW9wb3J0KTsKKwlpZiAociAhPSAwKQorCQlyZXR1cm47CisKKwlkaXNwY192cF9zZXR1cCh0aWRz
cy0+ZGlzcGMsIHRjcnRjLT5od192aWRlb3BvcnQsIGNydGMtPnN0YXRlKTsKKworCS8qIFR1cm4g
dmVydGljYWwgYmxhbmtpbmcgaW50ZXJydXB0IHJlcG9ydGluZyBvbi4gKi8KKwlkcm1fY3J0Y192
Ymxhbmtfb24oY3J0Yyk7CisKKwlkaXNwY192cF9wcmVwYXJlKHRpZHNzLT5kaXNwYywgdGNydGMt
Pmh3X3ZpZGVvcG9ydCwgY3J0Yy0+c3RhdGUpOworCisJZGlzcGNfdnBfZW5hYmxlKHRpZHNzLT5k
aXNwYywgdGNydGMtPmh3X3ZpZGVvcG9ydCwgY3J0Yy0+c3RhdGUpOworCisJc3Bpbl9sb2NrX2ly
cXNhdmUoJmRkZXYtPmV2ZW50X2xvY2ssIGZsYWdzKTsKKworCWlmIChjcnRjLT5zdGF0ZS0+ZXZl
bnQpIHsKKwkJZHJtX2NydGNfc2VuZF92YmxhbmtfZXZlbnQoY3J0YywgY3J0Yy0+c3RhdGUtPmV2
ZW50KTsKKwkJY3J0Yy0+c3RhdGUtPmV2ZW50ID0gTlVMTDsKKwl9CisKKwlzcGluX3VubG9ja19p
cnFyZXN0b3JlKCZkZGV2LT5ldmVudF9sb2NrLCBmbGFncyk7Cit9CisKK3N0YXRpYyB2b2lkIHRp
ZHNzX2NydGNfYXRvbWljX2Rpc2FibGUoc3RydWN0IGRybV9jcnRjICpjcnRjLAorCQkJCSAgICAg
IHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqb2xkX3N0YXRlKQoreworCXN0cnVjdCB0aWRzc19jcnRj
ICp0Y3J0YyA9IHRvX3RpZHNzX2NydGMoY3J0Yyk7CisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYg
PSBjcnRjLT5kZXY7CisJc3RydWN0IHRpZHNzX2RldmljZSAqdGlkc3MgPSBkZGV2LT5kZXZfcHJp
dmF0ZTsKKwl1bnNpZ25lZCBsb25nIGZsYWdzOworCisJZGV2X2RiZyhkZGV2LT5kZXYsICIlcywg
ZXZlbnQgJXBcbiIsIF9fZnVuY19fLCBjcnRjLT5zdGF0ZS0+ZXZlbnQpOworCisJcmVpbml0X2Nv
bXBsZXRpb24oJnRjcnRjLT5mcmFtZWRvbmVfY29tcGxldGlvbik7CisKKwlkaXNwY192cF9kaXNh
YmxlKHRpZHNzLT5kaXNwYywgdGNydGMtPmh3X3ZpZGVvcG9ydCk7CisKKwlpZiAoIXdhaXRfZm9y
X2NvbXBsZXRpb25fdGltZW91dCgmdGNydGMtPmZyYW1lZG9uZV9jb21wbGV0aW9uLAorCQkJCQkg
bXNlY3NfdG9famlmZmllcyg1MDApKSkKKwkJZGV2X2Vycih0aWRzcy0+ZGV2LCAiVGltZW91dCB3
YWl0aW5nIGZvciBmcmFtZWRvbmUgb24gY3J0YyAlZCIsCisJCQl0Y3J0Yy0+aHdfdmlkZW9wb3J0
KTsKKworCWRpc3BjX3ZwX3VucHJlcGFyZSh0aWRzcy0+ZGlzcGMsIHRjcnRjLT5od192aWRlb3Bv
cnQpOworCisJc3Bpbl9sb2NrX2lycXNhdmUoJmRkZXYtPmV2ZW50X2xvY2ssIGZsYWdzKTsKKwlp
ZiAoY3J0Yy0+c3RhdGUtPmV2ZW50KSB7CisJCWRybV9jcnRjX3NlbmRfdmJsYW5rX2V2ZW50KGNy
dGMsIGNydGMtPnN0YXRlLT5ldmVudCk7CisJCWNydGMtPnN0YXRlLT5ldmVudCA9IE5VTEw7CisJ
fQorCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRkZXYtPmV2ZW50X2xvY2ssIGZsYWdzKTsKKwor
CWRybV9jcnRjX3ZibGFua19vZmYoY3J0Yyk7CisKKwlkaXNwY192cF9kaXNhYmxlX2Nsayh0aWRz
cy0+ZGlzcGMsIHRjcnRjLT5od192aWRlb3BvcnQpOworCisJdGlkc3NfcnVudGltZV9wdXQodGlk
c3MpOworfQorCitzdGF0aWMKK2VudW0gZHJtX21vZGVfc3RhdHVzIHRpZHNzX2NydGNfbW9kZV92
YWxpZChzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCisJCQkJCSAgIGNvbnN0IHN0cnVjdCBkcm1fZGlz
cGxheV9tb2RlICptb2RlKQoreworCXN0cnVjdCB0aWRzc19jcnRjICp0Y3J0YyA9IHRvX3RpZHNz
X2NydGMoY3J0Yyk7CisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYgPSBjcnRjLT5kZXY7CisJc3Ry
dWN0IHRpZHNzX2RldmljZSAqdGlkc3MgPSBkZGV2LT5kZXZfcHJpdmF0ZTsKKworCXJldHVybiBk
aXNwY192cF9tb2RlX3ZhbGlkKHRpZHNzLT5kaXNwYywgdGNydGMtPmh3X3ZpZGVvcG9ydCwgbW9k
ZSk7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2NydGNfaGVscGVyX2Z1bmNzIHRpZHNz
X2NydGNfaGVscGVyX2Z1bmNzID0geworCS5hdG9taWNfY2hlY2sgPSB0aWRzc19jcnRjX2F0b21p
Y19jaGVjaywKKwkuYXRvbWljX2ZsdXNoID0gdGlkc3NfY3J0Y19hdG9taWNfZmx1c2gsCisJLmF0
b21pY19lbmFibGUgPSB0aWRzc19jcnRjX2F0b21pY19lbmFibGUsCisJLmF0b21pY19kaXNhYmxl
ID0gdGlkc3NfY3J0Y19hdG9taWNfZGlzYWJsZSwKKworCS5tb2RlX3ZhbGlkID0gdGlkc3NfY3J0
Y19tb2RlX3ZhbGlkLAorfTsKKworLyogZHJtX2NydGNfZnVuY3MgKi8KKworc3RhdGljIGludCB0
aWRzc19jcnRjX2VuYWJsZV92Ymxhbmsoc3RydWN0IGRybV9jcnRjICpjcnRjKQoreworCXN0cnVj
dCBkcm1fZGV2aWNlICpkZGV2ID0gY3J0Yy0+ZGV2OworCXN0cnVjdCB0aWRzc19kZXZpY2UgKnRp
ZHNzID0gZGRldi0+ZGV2X3ByaXZhdGU7CisKKwlkZXZfZGJnKGRkZXYtPmRldiwgIiVzXG4iLCBf
X2Z1bmNfXyk7CisKKwl0aWRzc19ydW50aW1lX2dldCh0aWRzcyk7CisKKwl0aWRzc19pcnFfZW5h
YmxlX3ZibGFuayhjcnRjKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCB0aWRzc19j
cnRjX2Rpc2FibGVfdmJsYW5rKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykKK3sKKwlzdHJ1Y3QgZHJt
X2RldmljZSAqZGRldiA9IGNydGMtPmRldjsKKwlzdHJ1Y3QgdGlkc3NfZGV2aWNlICp0aWRzcyA9
IGRkZXYtPmRldl9wcml2YXRlOworCisJZGV2X2RiZyhkZGV2LT5kZXYsICIlc1xuIiwgX19mdW5j
X18pOworCisJdGlkc3NfaXJxX2Rpc2FibGVfdmJsYW5rKGNydGMpOworCisJdGlkc3NfcnVudGlt
ZV9wdXQodGlkc3MpOworfQorCitzdGF0aWMgdm9pZCB0aWRzc19jcnRjX3Jlc2V0KHN0cnVjdCBk
cm1fY3J0YyAqY3J0YykKK3sKKwlzdHJ1Y3QgdGlkc3NfY3J0Y19zdGF0ZSAqdGNydGM7CisKKwlp
ZiAoY3J0Yy0+c3RhdGUpCisJCV9fZHJtX2F0b21pY19oZWxwZXJfY3J0Y19kZXN0cm95X3N0YXRl
KGNydGMtPnN0YXRlKTsKKworCWtmcmVlKGNydGMtPnN0YXRlKTsKKworCXRjcnRjID0ga3phbGxv
YyhzaXplb2YoKnRjcnRjKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCF0Y3J0YykgeworCQljcnRjLT5z
dGF0ZSA9IE5VTEw7CisJCXJldHVybjsKKwl9CisKKwljcnRjLT5zdGF0ZSA9ICZ0Y3J0Yy0+YmFz
ZTsKKwljcnRjLT5zdGF0ZS0+Y3J0YyA9IGNydGM7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgZHJtX2Ny
dGNfc3RhdGUgKnRpZHNzX2NydGNfZHVwbGljYXRlX3N0YXRlKHN0cnVjdCBkcm1fY3J0YyAqY3J0
YykKK3sKKwlzdHJ1Y3QgdGlkc3NfY3J0Y19zdGF0ZSAqc3RhdGUsICpjdXJyZW50X3N0YXRlOwor
CisJaWYgKFdBUk5fT04oIWNydGMtPnN0YXRlKSkKKwkJcmV0dXJuIE5VTEw7CisKKwljdXJyZW50
X3N0YXRlID0gdG9fdGlkc3NfY3J0Y19zdGF0ZShjcnRjLT5zdGF0ZSk7CisKKwlzdGF0ZSA9IGtt
YWxsb2Moc2l6ZW9mKCpzdGF0ZSksIEdGUF9LRVJORUwpOworCWlmICghc3RhdGUpCisJCXJldHVy
biBOVUxMOworCisJX19kcm1fYXRvbWljX2hlbHBlcl9jcnRjX2R1cGxpY2F0ZV9zdGF0ZShjcnRj
LCAmc3RhdGUtPmJhc2UpOworCisJc3RhdGUtPmJ1c19mb3JtYXQgPSBjdXJyZW50X3N0YXRlLT5i
dXNfZm9ybWF0OworCXN0YXRlLT5idXNfZmxhZ3MgPSBjdXJyZW50X3N0YXRlLT5idXNfZmxhZ3M7
CisKKwlyZXR1cm4gJnN0YXRlLT5iYXNlOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9j
cnRjX2Z1bmNzIHRpZHNzX2NydGNfZnVuY3MgPSB7CisJLnJlc2V0ID0gdGlkc3NfY3J0Y19yZXNl
dCwKKwkuZGVzdHJveSA9IGRybV9jcnRjX2NsZWFudXAsCisJLnNldF9jb25maWcgPSBkcm1fYXRv
bWljX2hlbHBlcl9zZXRfY29uZmlnLAorCS5wYWdlX2ZsaXAgPSBkcm1fYXRvbWljX2hlbHBlcl9w
YWdlX2ZsaXAsCisJLmF0b21pY19kdXBsaWNhdGVfc3RhdGUgPSB0aWRzc19jcnRjX2R1cGxpY2F0
ZV9zdGF0ZSwKKwkuYXRvbWljX2Rlc3Ryb3lfc3RhdGUgPSBkcm1fYXRvbWljX2hlbHBlcl9jcnRj
X2Rlc3Ryb3lfc3RhdGUsCisJLmVuYWJsZV92YmxhbmsgPSB0aWRzc19jcnRjX2VuYWJsZV92Ymxh
bmssCisJLmRpc2FibGVfdmJsYW5rID0gdGlkc3NfY3J0Y19kaXNhYmxlX3ZibGFuaywKK307CisK
K3N0cnVjdCB0aWRzc19jcnRjICp0aWRzc19jcnRjX2NyZWF0ZShzdHJ1Y3QgdGlkc3NfZGV2aWNl
ICp0aWRzcywKKwkJCQkgICAgIHUzMiBod192aWRlb3BvcnQsCisJCQkJICAgICBzdHJ1Y3QgZHJt
X3BsYW5lICpwcmltYXJ5KQoreworCXN0cnVjdCB0aWRzc19jcnRjICp0Y3J0YzsKKwlzdHJ1Y3Qg
ZHJtX2NydGMgKmNydGM7CisJdW5zaWduZWQgaW50IGdhbW1hX2x1dF9zaXplID0gMDsKKwlib29s
IGhhc19jdG0gPSB0cnVlOworCWludCByZXQ7CisKKwl0Y3J0YyA9IGRldm1fa3phbGxvYyh0aWRz
cy0+ZGV2LCBzaXplb2YoKnRjcnRjKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCF0Y3J0YykKKwkJcmV0
dXJuIEVSUl9QVFIoLUVOT01FTSk7CisKKwl0Y3J0Yy0+aHdfdmlkZW9wb3J0ID0gaHdfdmlkZW9w
b3J0OworCWluaXRfY29tcGxldGlvbigmdGNydGMtPmZyYW1lZG9uZV9jb21wbGV0aW9uKTsKKwor
CWNydGMgPSAgJnRjcnRjLT5jcnRjOworCisJcmV0ID0gZHJtX2NydGNfaW5pdF93aXRoX3BsYW5l
cyh0aWRzcy0+ZGRldiwgY3J0YywgcHJpbWFyeSwKKwkJCQkJTlVMTCwgJnRpZHNzX2NydGNfZnVu
Y3MsIE5VTEwpOworCWlmIChyZXQgPCAwKQorCQlyZXR1cm4gRVJSX1BUUihyZXQpOworCisJZHJt
X2NydGNfaGVscGVyX2FkZChjcnRjLCAmdGlkc3NfY3J0Y19oZWxwZXJfZnVuY3MpOworCisJLyoK
KwkgKiBUaGUgZGlzcGMgZ2FtbWEgZnVuY3Rpb25zIGFkYXB0IHRvIHdoYXQgZXZlciBzaXplIHdl
IGFzaworCSAqIGZyb20gaXQgbm8gbWF0dGVyIHdoYXQgSFcgc3VwcG9ydHMuIFgtc2VydmVyIGFz
c3VtZXMgMjU2CisJICogZWxlbWVudCBnYW1tYSB0YWJsZXMgc28gbGV0cyB1c2UgdGhhdC4KKwkg
Ki8KKwlnYW1tYV9sdXRfc2l6ZSA9IDI1NjsKKworCWRybV9jcnRjX2VuYWJsZV9jb2xvcl9tZ210
KGNydGMsIDAsIGhhc19jdG0sIGdhbW1hX2x1dF9zaXplKTsKKwlpZiAoZ2FtbWFfbHV0X3NpemUp
CisJCWRybV9tb2RlX2NydGNfc2V0X2dhbW1hX3NpemUoY3J0YywgZ2FtbWFfbHV0X3NpemUpOwor
CisJcmV0dXJuIHRjcnRjOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3RpZHNzL3Rp
ZHNzX2NydGMuaCBiL2RyaXZlcnMvZ3B1L2RybS90aWRzcy90aWRzc19jcnRjLmgKbmV3IGZpbGUg
bW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5mNDVhMjdlZDNjNTUKLS0tIC9kZXYvbnVs
bAorKysgYi9kcml2ZXJzL2dwdS9kcm0vdGlkc3MvdGlkc3NfY3J0Yy5oCkBAIC0wLDAgKzEsNDUg
QEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovCisvKgorICogQ29weXJp
Z2h0IChDKSAyMDE4IFRleGFzIEluc3RydW1lbnRzIEluY29ycG9yYXRlZCAtIGh0dHA6Ly93d3cu
dGkuY29tLworICogQXV0aG9yOiBUb21pIFZhbGtlaW5lbiA8dG9taS52YWxrZWluZW5AdGkuY29t
PgorICovCisKKyNpZm5kZWYgX19USURTU19DUlRDX0hfXworI2RlZmluZSBfX1RJRFNTX0NSVENf
SF9fCisKKyNpbmNsdWRlIDxkcm0vZHJtX2NydGMuaD4KKyNpbmNsdWRlIDxsaW51eC9jb21wbGV0
aW9uLmg+CisjaW5jbHVkZSA8bGludXgvd2FpdC5oPgorCisjZGVmaW5lIHRvX3RpZHNzX2NydGMo
YykgY29udGFpbmVyX29mKChjKSwgc3RydWN0IHRpZHNzX2NydGMsIGNydGMpCisKK3N0cnVjdCB0
aWRzc19kZXZpY2U7CisKK3N0cnVjdCB0aWRzc19jcnRjIHsKKwlzdHJ1Y3QgZHJtX2NydGMgY3J0
YzsKKworCXUzMiBod192aWRlb3BvcnQ7CisKKwlzdHJ1Y3QgZHJtX3BlbmRpbmdfdmJsYW5rX2V2
ZW50ICpldmVudDsKKworCXN0cnVjdCBjb21wbGV0aW9uIGZyYW1lZG9uZV9jb21wbGV0aW9uOwor
fTsKKworI2RlZmluZSB0b190aWRzc19jcnRjX3N0YXRlKHgpIGNvbnRhaW5lcl9vZih4LCBzdHJ1
Y3QgdGlkc3NfY3J0Y19zdGF0ZSwgYmFzZSkKKworc3RydWN0IHRpZHNzX2NydGNfc3RhdGUgewor
CS8qIE11c3QgYmUgZmlyc3QuICovCisJc3RydWN0IGRybV9jcnRjX3N0YXRlIGJhc2U7CisKKwl1
MzIgYnVzX2Zvcm1hdDsKKwl1MzIgYnVzX2ZsYWdzOworfTsKKwordm9pZCB0aWRzc19jcnRjX3Zi
bGFua19pcnEoc3RydWN0IGRybV9jcnRjICpjcnRjKTsKK3ZvaWQgdGlkc3NfY3J0Y19mcmFtZWRv
bmVfaXJxKHN0cnVjdCBkcm1fY3J0YyAqY3J0Yyk7Cit2b2lkIHRpZHNzX2NydGNfZXJyb3JfaXJx
KHN0cnVjdCBkcm1fY3J0YyAqY3J0YywgdTY0IGlycXN0YXR1cyk7CisKK3N0cnVjdCB0aWRzc19j
cnRjICp0aWRzc19jcnRjX2NyZWF0ZShzdHJ1Y3QgdGlkc3NfZGV2aWNlICp0aWRzcywKKwkJCQkg
ICAgIHUzMiBod192aWRlb3BvcnQsCisJCQkJICAgICBzdHJ1Y3QgZHJtX3BsYW5lICpwcmltYXJ5
KTsKKyNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3RpZHNzL3RpZHNzX2Rpc3Bj
LmMgYi9kcml2ZXJzL2dwdS9kcm0vdGlkc3MvdGlkc3NfZGlzcGMuYwpuZXcgZmlsZSBtb2RlIDEw
MDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmNkYmIxZWY3NGYyMAotLS0gL2Rldi9udWxsCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS90aWRzcy90aWRzc19kaXNwYy5jCkBAIC0wLDAgKzEsMjY0NSBAQAor
Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAKKy8qCisgKiBDb3B5cmlnaHQgKEMp
IDIwMTYtMjAxOCBUZXhhcyBJbnN0cnVtZW50cyBJbmNvcnBvcmF0ZWQgLSBodHRwOi8vd3d3LnRp
LmNvbS8KKyAqIEF1dGhvcjogSnlyaSBTYXJoYSA8anNhcmhhQHRpLmNvbT4KKyAqLworCisjaW5j
bHVkZSA8bGludXgvY2xrLmg+CisjaW5jbHVkZSA8bGludXgvZGVsYXkuaD4KKyNpbmNsdWRlIDxs
aW51eC9kbWEtbWFwcGluZy5oPgorI2luY2x1ZGUgPGxpbnV4L2Vyci5oPgorI2luY2x1ZGUgPGxp
bnV4L2ludGVycnVwdC5oPgorI2luY2x1ZGUgPGxpbnV4L2lvLmg+CisjaW5jbHVkZSA8bGludXgv
a2VybmVsLmg+CisjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+CisjaW5jbHVkZSA8bGludXgvbWZk
L3N5c2Nvbi5oPgorI2luY2x1ZGUgPGxpbnV4L29mLmg+CisjaW5jbHVkZSA8bGludXgvb2ZfZ3Jh
cGguaD4KKyNpbmNsdWRlIDxsaW51eC9vZl9kZXZpY2UuaD4KKyNpbmNsdWRlIDxsaW51eC9wbGF0
Zm9ybV9kZXZpY2UuaD4KKyNpbmNsdWRlIDxsaW51eC9wbV9ydW50aW1lLmg+CisjaW5jbHVkZSA8
bGludXgvcmVnbWFwLmg+CisKKyNpbmNsdWRlIDxkcm0vZHJtX2ZvdXJjYy5oPgorI2luY2x1ZGUg
PGRybS9kcm1fcGFuZWwuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2ZiX2NtYV9oZWxwZXIuaD4KKyNp
bmNsdWRlIDxkcm0vZHJtX2dlbV9jbWFfaGVscGVyLmg+CisKKyNpbmNsdWRlICJ0aWRzc19kcnYu
aCIKKyNpbmNsdWRlICJ0aWRzc19jcnRjLmgiCisjaW5jbHVkZSAidGlkc3NfcGxhbmUuaCIKKyNp
bmNsdWRlICJ0aWRzc19pcnEuaCIKKworI2luY2x1ZGUgInRpZHNzX3NjYWxlX2NvZWZzLmgiCisj
aW5jbHVkZSAidGlkc3NfZGlzcGNfcmVncy5oIgorCisjaW5jbHVkZSAidGlkc3NfZGlzcGMuaCIK
Kworc3RhdGljIGNvbnN0IHUxNiB0aWRzc19rMmdfY29tbW9uX3JlZ3NbRElTUENfQ09NTU9OX1JF
R19UQUJMRV9MRU5dID0geworCVtEU1NfUkVWSVNJT05fT0ZGXSA9ICAgICAgICAgICAgICAgICAg
ICAweDAwLAorCVtEU1NfU1lTQ09ORklHX09GRl0gPSAgICAgICAgICAgICAgICAgICAweDA0LAor
CVtEU1NfU1lTU1RBVFVTX09GRl0gPSAgICAgICAgICAgICAgICAgICAweDA4LAorCVtESVNQQ19J
UlFfRU9JX09GRl0gPSAgICAgICAgICAgICAgICAgICAweDIwLAorCVtESVNQQ19JUlFTVEFUVVNf
UkFXX09GRl0gPSAgICAgICAgICAgICAweDI0LAorCVtESVNQQ19JUlFTVEFUVVNfT0ZGXSA9ICAg
ICAgICAgICAgICAgICAweDI4LAorCVtESVNQQ19JUlFFTkFCTEVfU0VUX09GRl0gPSAgICAgICAg
ICAgICAweDJjLAorCVtESVNQQ19JUlFFTkFCTEVfQ0xSX09GRl0gPSAgICAgICAgICAgICAweDMw
LAorCisJW0RJU1BDX0dMT0JBTF9NRkxBR19BVFRSSUJVVEVfT0ZGXSA9ICAgIDB4NDAsCisJW0RJ
U1BDX0dMT0JBTF9CVUZGRVJfT0ZGXSA9ICAgICAgICAgICAgIDB4NDQsCisKKwlbRElTUENfREJH
X0NPTlRST0xfT0ZGXSA9ICAgICAgICAgICAgICAgMHg0YywKKwlbRElTUENfREJHX1NUQVRVU19P
RkZdID0gICAgICAgICAgICAgICAgMHg1MCwKKworCVtESVNQQ19DTEtHQVRJTkdfRElTQUJMRV9P
RkZdID0gICAgICAgICAweDU0LAorfTsKKworY29uc3Qgc3RydWN0IGRpc3BjX2ZlYXR1cmVzIGRp
c3BjX2syZ19mZWF0cyA9IHsKKwkubWluX3BjbGtfa0h6ID0gNDM3NSwKKworCS5tYXhfcGNsa19r
SHogPSB7CisJCVtESVNQQ19WUF9EUEldID0gMTUwMDAwLAorCX0sCisKKwkvKgorCSAqIFhYWCBB
Y2NvcmRpbmcgVFJNIHRoZSBSR0IgaW5wdXQgYnVmZmVyIHdpZHRoIHVwIHRvIDI1NjAgc2hvdWxk
CisJICogICAgIHdvcmsgb24gMyB0YXBzLCBidXQgaW4gcHJhY3RpY2UgaXQgb25seSB3b3JrcyB1
cCB0byAxMjgwLgorCSAqLworCS5zY2FsaW5nID0geworCQkuaW5fd2lkdGhfbWF4XzV0YXBfcmdi
ID0gMTI4MCwKKwkJLmluX3dpZHRoX21heF8zdGFwX3JnYiA9IDEyODAsCisJCS5pbl93aWR0aF9t
YXhfNXRhcF95dXYgPSAyNTYwLAorCQkuaW5fd2lkdGhfbWF4XzN0YXBfeXV2ID0gMjU2MCwKKwkJ
LnVwc2NhbGVfbGltaXQgPSAxNiwKKwkJLmRvd25zY2FsZV9saW1pdF81dGFwID0gNCwKKwkJLmRv
d25zY2FsZV9saW1pdF8zdGFwID0gMiwKKwkJLyoKKwkJICogVGhlIG1heCBzdXBwb3J0ZWQgcGl4
ZWwgaW5jIHZhbHVlIGlzIDI1NS4gVGhlIHZhbHVlCisJCSAqIG9mIHBpeGVsIGluYyBpcyBjYWxj
dWxhdGVkIGxpa2UgdGhpczogMSsoeGluYy0xKSpicHAuCisJCSAqIFRoZSBtYXhpbXVtIGJwcCBv
ZiBhbGwgZm9ybWF0cyBzdXBwb3J0ZWQgYnkgdGhlIEhXCisJCSAqIGlzIDguIFNvIHRoZSBtYXhp
bXVtIHN1cHBvcnRlZCB4aW5jIHZhbHVlIGlzIDMyLAorCQkgKiBiZWNhdXNlIDErKDMyLTEpKjgg
PCAyNTUgPCAxKygzMy0xKSo0LgorCQkgKi8KKwkJLnhpbmNfbWF4ID0gMzIsCisJfSwKKworCS5z
dWJyZXYgPSBESVNQQ19LMkcsCisKKwkuY29tbW9uID0gImNvbW1vbiIsCisKKwkuY29tbW9uX3Jl
Z3MgPSB0aWRzc19rMmdfY29tbW9uX3JlZ3MsCisKKwkubnVtX3ZwcyA9IDEsCisJLnZwX25hbWUg
PSB7ICJ2cDEiIH0sCisJLm92cl9uYW1lID0geyAib3ZyMSIgfSwKKwkudnBjbGtfbmFtZSA9ICB7
ICJ2cDEiIH0sCisJLnZwX2J1c190eXBlID0geyBESVNQQ19WUF9EUEkgfSwKKworCS52cF9mZWF0
ID0geyAuY29sb3IgPSB7CisJCQkuaGFzX2N0bSA9IGZhbHNlLCAvKiBYWFggbm8gSzJHIGltcGxl
bWVudGF0aW9uIHlldCAqLworCQkJLmdhbW1hX3NpemUgPSAyNTYsCisJCQkuZ2FtbWFfdHlwZSA9
IFRJRFNTX0dBTU1BXzhCSVQsCisJCX0sCisJfSwKKworCS5udW1fcGxhbmVzID0gMSwKKwkudmlk
X25hbWUgPSB7ICJ2aWQxIiB9LAorCS52aWRfbGl0ZSA9IHsgZmFsc2UgfSwKKwkudmlkX29yZGVy
ID0geyAwIH0sCit9OworCitzdGF0aWMgY29uc3QgdTE2IHRpZHNzX2FtNjV4X2NvbW1vbl9yZWdz
W0RJU1BDX0NPTU1PTl9SRUdfVEFCTEVfTEVOXSA9IHsKKwlbRFNTX1JFVklTSU9OX09GRl0gPQkJ
CTB4NCwKKwlbRFNTX1NZU0NPTkZJR19PRkZdID0JCQkweDgsCisJW0RTU19TWVNTVEFUVVNfT0ZG
XSA9CQkJMHgyMCwKKwlbRElTUENfSVJRX0VPSV9PRkZdID0JCQkweDI0LAorCVtESVNQQ19JUlFT
VEFUVVNfUkFXX09GRl0gPQkJMHgyOCwKKwlbRElTUENfSVJRU1RBVFVTX09GRl0gPQkJCTB4MmMs
CisJW0RJU1BDX0lSUUVOQUJMRV9TRVRfT0ZGXSA9CQkweDMwLAorCVtESVNQQ19JUlFFTkFCTEVf
Q0xSX09GRl0gPQkJMHg0MCwKKwlbRElTUENfVklEX0lSUUVOQUJMRV9PRkZdID0JCTB4NDQsCisJ
W0RJU1BDX1ZJRF9JUlFTVEFUVVNfT0ZGXSA9CQkweDU4LAorCVtESVNQQ19WUF9JUlFFTkFCTEVf
T0ZGXSA9CQkweDcwLAorCVtESVNQQ19WUF9JUlFTVEFUVVNfT0ZGXSA9CQkweDdjLAorCisJW1dC
X0lSUUVOQUJMRV9PRkZdID0JCQkweDg4LAorCVtXQl9JUlFTVEFUVVNfT0ZGXSA9CQkJMHg4YywK
KworCVtESVNQQ19HTE9CQUxfTUZMQUdfQVRUUklCVVRFX09GRl0gPQkweDkwLAorCVtESVNQQ19H
TE9CQUxfT1VUUFVUX0VOQUJMRV9PRkZdID0JMHg5NCwKKwlbRElTUENfR0xPQkFMX0JVRkZFUl9P
RkZdID0JCTB4OTgsCisJW0RTU19DQkFfQ0ZHX09GRl0gPQkJCTB4OWMsCisJW0RJU1BDX0RCR19D
T05UUk9MX09GRl0gPQkJMHhhMCwKKwlbRElTUENfREJHX1NUQVRVU19PRkZdID0JCTB4YTQsCisJ
W0RJU1BDX0NMS0dBVElOR19ESVNBQkxFX09GRl0gPQkJMHhhOCwKKwlbRElTUENfU0VDVVJFX0RJ
U0FCTEVfT0ZGXSA9CQkweGFjLAorfTsKKworY29uc3Qgc3RydWN0IGRpc3BjX2ZlYXR1cmVzIGRp
c3BjX2FtNjV4X2ZlYXRzID0geworCS5tYXhfcGNsa19rSHogPSB7CisJCVtESVNQQ19WUF9EUEld
ID0gMTY1MDAwLAorCQlbRElTUENfVlBfT0xESV0gPSAxNjUwMDAsCisJfSwKKworCS5zY2FsaW5n
ID0geworCQkuaW5fd2lkdGhfbWF4XzV0YXBfcmdiID0gMTI4MCwKKwkJLmluX3dpZHRoX21heF8z
dGFwX3JnYiA9IDI1NjAsCisJCS5pbl93aWR0aF9tYXhfNXRhcF95dXYgPSAyNTYwLAorCQkuaW5f
d2lkdGhfbWF4XzN0YXBfeXV2ID0gNDA5NiwKKwkJLnVwc2NhbGVfbGltaXQgPSAxNiwKKwkJLmRv
d25zY2FsZV9saW1pdF81dGFwID0gNCwKKwkJLmRvd25zY2FsZV9saW1pdF8zdGFwID0gMiwKKwkJ
LyoKKwkJICogVGhlIG1heCBzdXBwb3J0ZWQgcGl4ZWwgaW5jIHZhbHVlIGlzIDI1NS4gVGhlIHZh
bHVlCisJCSAqIG9mIHBpeGVsIGluYyBpcyBjYWxjdWxhdGVkIGxpa2UgdGhpczogMSsoeGluYy0x
KSpicHAuCisJCSAqIFRoZSBtYXhpbXVtIGJwcCBvZiBhbGwgZm9ybWF0cyBzdXBwb3J0ZWQgYnkg
dGhlIEhXCisJCSAqIGlzIDguIFNvIHRoZSBtYXhpbXVtIHN1cHBvcnRlZCB4aW5jIHZhbHVlIGlz
IDMyLAorCQkgKiBiZWNhdXNlIDErKDMyLTEpKjggPCAyNTUgPCAxKygzMy0xKSo0LgorCQkgKi8K
KwkJLnhpbmNfbWF4ID0gMzIsCisJfSwKKworCS5zdWJyZXYgPSBESVNQQ19BTTY1WCwKKworCS5j
b21tb24gPSAiY29tbW9uIiwKKwkuY29tbW9uX3JlZ3MgPSB0aWRzc19hbTY1eF9jb21tb25fcmVn
cywKKworCS5udW1fdnBzID0gMiwKKwkudnBfbmFtZSA9IHsgInZwMSIsICJ2cDIiIH0sCisJLm92
cl9uYW1lID0geyAib3ZyMSIsICJvdnIyIiB9LAorCS52cGNsa19uYW1lID0gIHsgInZwMSIsICJ2
cDIiIH0sCisJLnZwX2J1c190eXBlID0geyBESVNQQ19WUF9PTERJLCBESVNQQ19WUF9EUEkgfSwK
KworCS52cF9mZWF0ID0geyAuY29sb3IgPSB7CisJCQkuaGFzX2N0bSA9IHRydWUsCisJCQkuZ2Ft
bWFfc2l6ZSA9IDI1NiwKKwkJCS5nYW1tYV90eXBlID0gVElEU1NfR0FNTUFfOEJJVCwKKwkJfSwK
Kwl9LAorCisJLm51bV9wbGFuZXMgPSAyLAorCS8qIG5vdGU6IHZpZCBpcyBwbGFuZV9pZCAwIGFu
ZCB2aWRsMSBpcyBwbGFuZV9pZCAxICovCisJLnZpZF9uYW1lID0geyAidmlkIiwgInZpZGwxIiB9
LAorCS52aWRfbGl0ZSA9IHsgZmFsc2UsIHRydWUsIH0sCisJLnZpZF9vcmRlciA9IHsgMSwgMCB9
LAorCisJLmVycmF0YSA9IHsKKwkJLmkyMDAwID0gdHJ1ZSwKKwl9LAorfTsKKworc3RhdGljIGNv
bnN0IHUxNiB0aWRzc19qNzIxZV9jb21tb25fcmVnc1tESVNQQ19DT01NT05fUkVHX1RBQkxFX0xF
Tl0gPSB7CisJW0RTU19SRVZJU0lPTl9PRkZdID0JCQkweDQsCisJW0RTU19TWVNDT05GSUdfT0ZG
XSA9CQkJMHg4LAorCVtEU1NfU1lTU1RBVFVTX09GRl0gPQkJCTB4MjAsCisJW0RJU1BDX0lSUV9F
T0lfT0ZGXSA9CQkJMHg4MCwKKwlbRElTUENfSVJRU1RBVFVTX1JBV19PRkZdID0JCTB4MjgsCisJ
W0RJU1BDX0lSUVNUQVRVU19PRkZdID0JCQkweDJjLAorCVtESVNQQ19JUlFFTkFCTEVfU0VUX09G
Rl0gPQkJMHgzMCwKKwlbRElTUENfSVJRRU5BQkxFX0NMUl9PRkZdID0JCTB4MzQsCisJW0RJU1BD
X1ZJRF9JUlFFTkFCTEVfT0ZGXSA9CQkweDM4LAorCVtESVNQQ19WSURfSVJRU1RBVFVTX09GRl0g
PQkJMHg0OCwKKwlbRElTUENfVlBfSVJRRU5BQkxFX09GRl0gPQkJMHg1OCwKKwlbRElTUENfVlBf
SVJRU1RBVFVTX09GRl0gPQkJMHg2OCwKKworCVtXQl9JUlFFTkFCTEVfT0ZGXSA9CQkJMHg3OCwK
KwlbV0JfSVJRU1RBVFVTX09GRl0gPQkJCTB4N2MsCisKKwlbRElTUENfR0xPQkFMX01GTEFHX0FU
VFJJQlVURV9PRkZdID0JMHg5OCwKKwlbRElTUENfR0xPQkFMX09VVFBVVF9FTkFCTEVfT0ZGXSA9
CTB4OWMsCisJW0RJU1BDX0dMT0JBTF9CVUZGRVJfT0ZGXSA9CQkweGEwLAorCVtEU1NfQ0JBX0NG
R19PRkZdID0JCQkweGE0LAorCVtESVNQQ19EQkdfQ09OVFJPTF9PRkZdID0JCTB4YTgsCisJW0RJ
U1BDX0RCR19TVEFUVVNfT0ZGXSA9CQkweGFjLAorCVtESVNQQ19DTEtHQVRJTkdfRElTQUJMRV9P
RkZdID0JCTB4YjAsCisJW0RJU1BDX1NFQ1VSRV9ESVNBQkxFX09GRl0gPQkJMHg5MCwKKworCVtG
QkRDX1JFVklTSU9OXzFfT0ZGXSA9CQkJMHhiOCwKKwlbRkJEQ19SRVZJU0lPTl8yX09GRl0gPQkJ
CTB4YmMsCisJW0ZCRENfUkVWSVNJT05fM19PRkZdID0JCQkweGMwLAorCVtGQkRDX1JFVklTSU9O
XzRfT0ZGXSA9CQkJMHhjNCwKKwlbRkJEQ19SRVZJU0lPTl81X09GRl0gPQkJCTB4YzgsCisJW0ZC
RENfUkVWSVNJT05fNl9PRkZdID0JCQkweGNjLAorCVtGQkRDX0NPTU1PTl9DT05UUk9MX09GRl0g
PQkJMHhkMCwKKwlbRkJEQ19DT05TVEFOVF9DT0xPUl8wX09GRl0gPQkJMHhkNCwKKwlbRkJEQ19D
T05TVEFOVF9DT0xPUl8xX09GRl0gPQkJMHhkOCwKKwlbRElTUENfQ09OTkVDVElPTlNfT0ZGXSA9
CQkweGU0LAorCVtESVNQQ19NU1NfVlAxX09GRl0gPQkJCTB4ZTgsCisJW0RJU1BDX01TU19WUDNf
T0ZGXSA9CQkJMHhlYywKK307CisKK2NvbnN0IHN0cnVjdCBkaXNwY19mZWF0dXJlcyBkaXNwY19q
NzIxZV9mZWF0cyA9IHsKKwkubWF4X3BjbGtfa0h6ID0geworCQlbRElTUENfVlBfRFBJXSA9IDE3
MDAwMCwKKwkJW0RJU1BDX1ZQX0lOVEVSTkFMXSA9IDYwMDAwMCwKKwl9LAorCisJLnNjYWxpbmcg
PSB7CisJCS5pbl93aWR0aF9tYXhfNXRhcF9yZ2IgPSAyMDQ4LAorCQkuaW5fd2lkdGhfbWF4XzN0
YXBfcmdiID0gNDA5NiwKKwkJLmluX3dpZHRoX21heF81dGFwX3l1diA9IDQwOTYsCisJCS5pbl93
aWR0aF9tYXhfM3RhcF95dXYgPSA0MDk2LAorCQkudXBzY2FsZV9saW1pdCA9IDE2LAorCQkuZG93
bnNjYWxlX2xpbWl0XzV0YXAgPSA0LAorCQkuZG93bnNjYWxlX2xpbWl0XzN0YXAgPSAyLAorCQkv
KgorCQkgKiBUaGUgbWF4IHN1cHBvcnRlZCBwaXhlbCBpbmMgdmFsdWUgaXMgMjU1LiBUaGUgdmFs
dWUKKwkJICogb2YgcGl4ZWwgaW5jIGlzIGNhbGN1bGF0ZWQgbGlrZSB0aGlzOiAxKyh4aW5jLTEp
KmJwcC4KKwkJICogVGhlIG1heGltdW0gYnBwIG9mIGFsbCBmb3JtYXRzIHN1cHBvcnRlZCBieSB0
aGUgSFcKKwkJICogaXMgOC4gU28gdGhlIG1heGltdW0gc3VwcG9ydGVkIHhpbmMgdmFsdWUgaXMg
MzIsCisJCSAqIGJlY2F1c2UgMSsoMzItMSkqOCA8IDI1NSA8IDErKDMzLTEpKjQuCisJCSAqLwor
CQkueGluY19tYXggPSAzMiwKKwl9LAorCisJLnN1YnJldiA9IERJU1BDX0o3MjFFLAorCisJLmNv
bW1vbiA9ICJjb21tb25fbSIsCisJLmNvbW1vbl9yZWdzID0gdGlkc3NfajcyMWVfY29tbW9uX3Jl
Z3MsCisKKwkubnVtX3ZwcyA9IDQsCisJLnZwX25hbWUgPSB7ICJ2cDEiLCAidnAyIiwgInZwMyIs
ICJ2cDQiIH0sCisJLm92cl9uYW1lID0geyAib3ZyMSIsICJvdnIyIiwgIm92cjMiLCAib3ZyNCIg
fSwKKwkudnBjbGtfbmFtZSA9IHsgInZwMSIsICJ2cDIiLCAidnAzIiwgInZwNCIgfSwKKwkvKiBD
dXJyZW50bHkgaGFyZCBjb2RlZCBWUCByb3V0aW5nIChzZWUgZGlzcGNfaW5pdGlhbF9jb25maWco
KSkgKi8KKwkudnBfYnVzX3R5cGUgPQl7IERJU1BDX1ZQX0lOVEVSTkFMLCBESVNQQ19WUF9EUEks
CisJCQkgIERJU1BDX1ZQX0lOVEVSTkFMLCBESVNQQ19WUF9EUEksIH0sCisJLnZwX2ZlYXQgPSB7
IC5jb2xvciA9IHsKKwkJCS5oYXNfY3RtID0gdHJ1ZSwKKwkJCS5nYW1tYV9zaXplID0gMTAyNCwK
KwkJCS5nYW1tYV90eXBlID0gVElEU1NfR0FNTUFfMTBCSVQsCisJCX0sCisJfSwKKwkubnVtX3Bs
YW5lcyA9IDQsCisJLnZpZF9uYW1lID0geyAidmlkMSIsICJ2aWRsMSIsICJ2aWQyIiwgInZpZGwy
IiB9LAorCS52aWRfbGl0ZSA9IHsgMCwgMSwgMCwgMSwgfSwKKwkudmlkX29yZGVyID0geyAxLCAz
LCAwLCAyIH0sCit9OworCisvKgorICogVFJNIGdpdmVzIGJpdGZpZWxkcyBhcyBzdGFydDplbmQs
IHdoZXJlIHN0YXJ0IGlzIHRoZSBoaWdoZXIgYml0CisgKiBudW1iZXIuIEZvciBleGFtcGxlIDc6
MAorICovCisKKyNkZWZpbmUgRkxEX01BU0soc3RhcnQsIGVuZCkJKCgoMSA8PCAoKHN0YXJ0KSAt
IChlbmQpICsgMSkpIC0gMSkgPDwgKGVuZCkpCisjZGVmaW5lIEZMRF9WQUwodmFsLCBzdGFydCwg
ZW5kKSAoKCh2YWwpIDw8IChlbmQpKSAmIEZMRF9NQVNLKHN0YXJ0LCBlbmQpKQorI2RlZmluZSBG
TERfR0VUKHZhbCwgc3RhcnQsIGVuZCkgKCgodmFsKSAmIEZMRF9NQVNLKHN0YXJ0LCBlbmQpKSA+
PiAoZW5kKSkKKyNkZWZpbmUgRkxEX01PRChvcmlnLCB2YWwsIHN0YXJ0LCBlbmQpCQkJCQlcCisJ
KCgob3JpZykgJiB+RkxEX01BU0soc3RhcnQsIGVuZCkpIHwgRkxEX1ZBTCh2YWwsIHN0YXJ0LCBl
bmQpKQorCisjZGVmaW5lIFJFR19HRVQoZGlzcGMsIGlkeCwgc3RhcnQsIGVuZCkJCQlcCisJRkxE
X0dFVChkaXNwY19yZWFkKGRpc3BjLCBpZHgpLCBzdGFydCwgZW5kKQorCisjZGVmaW5lIFJFR19G
TERfTU9EKGRpc3BjLCBpZHgsIHZhbCwgc3RhcnQsIGVuZCkJCQlcCisJZGlzcGNfd3JpdGUoZGlz
cGMsIGlkeCwgRkxEX01PRChkaXNwY19yZWFkKGRpc3BjLCBpZHgpLCB2YWwsIHN0YXJ0LCBlbmQp
KQorCisjZGVmaW5lIFZJRF9SRUdfR0VUKGRpc3BjLCBod19wbGFuZSwgaWR4LCBzdGFydCwgZW5k
KQkJCVwKKwlGTERfR0VUKGRpc3BjX3ZpZF9yZWFkKGRpc3BjLCBod19wbGFuZSwgaWR4KSwgc3Rh
cnQsIGVuZCkKKworI2RlZmluZSBWSURfUkVHX0ZMRF9NT0QoZGlzcGMsIGh3X3BsYW5lLCBpZHgs
IHZhbCwgc3RhcnQsIGVuZCkJCVwKKwlkaXNwY192aWRfd3JpdGUoZGlzcGMsIGh3X3BsYW5lLCBp
ZHgsIEZMRF9NT0QoZGlzcGNfdmlkX3JlYWQoZGlzcGMsIGh3X3BsYW5lLCBpZHgpLCB2YWwsIHN0
YXJ0LCBlbmQpKQorCisjZGVmaW5lIFZQX1JFR19HRVQoZGlzcGMsIHZwLCBpZHgsIHN0YXJ0LCBl
bmQpCQkJXAorCUZMRF9HRVQoZGlzcGNfdnBfcmVhZChkaXNwYywgdnAsIGlkeCksIHN0YXJ0LCBl
bmQpCisKKyNkZWZpbmUgVlBfUkVHX0ZMRF9NT0QoZGlzcGMsIHZwLCBpZHgsIHZhbCwgc3RhcnQs
IGVuZCkJCQlcCisJZGlzcGNfdnBfd3JpdGUoZGlzcGMsIHZwLCBpZHgsIEZMRF9NT0QoZGlzcGNf
dnBfcmVhZChkaXNwYywgdnAsIGlkeCksIHZhbCwgc3RhcnQsIGVuZCkpCisKKyNkZWZpbmUgT1ZS
X1JFR19HRVQoZGlzcGMsIG92ciwgaWR4LCBzdGFydCwgZW5kKQkJXAorCUZMRF9HRVQoZGlzcGNf
b3ZyX3JlYWQoZGlzcGMsIG92ciwgaWR4KSwgc3RhcnQsIGVuZCkKKworI2RlZmluZSBPVlJfUkVH
X0ZMRF9NT0QoZGlzcGMsIG92ciwgaWR4LCB2YWwsIHN0YXJ0LCBlbmQpCQlcCisJZGlzcGNfb3Zy
X3dyaXRlKGRpc3BjLCBvdnIsIGlkeCwgRkxEX01PRChkaXNwY19vdnJfcmVhZChkaXNwYywgb3Zy
LCBpZHgpLCB2YWwsIHN0YXJ0LCBlbmQpKQorCitzdGF0aWMgY29uc3QgdTE2ICpkaXNwY19jb21t
b25fcmVnbWFwOworCitzdHJ1Y3QgZHNzX3ZwX2RhdGEgeworCXUzMiAqZ2FtbWFfdGFibGU7Cit9
OworCitzdHJ1Y3QgZHNzX3BsYW5lX2RhdGEgeworCXUzMiB6b3JkZXI7CisJdTMyIGh3X3ZpZGVv
cG9ydDsKK307CisKK3N0cnVjdCBkaXNwY19kZXZpY2UgeworCXN0cnVjdCB0aWRzc19kZXZpY2Ug
KnRpZHNzOworCXN0cnVjdCBkZXZpY2UgKmRldjsKKworCXZvaWQgX19pb21lbSAqYmFzZV9jb21t
b247CisJdm9pZCBfX2lvbWVtICpiYXNlX3ZpZFtUSURTU19NQVhfUExBTkVTXTsKKwl2b2lkIF9f
aW9tZW0gKmJhc2Vfb3ZyW1RJRFNTX01BWF9QT1JUU107CisJdm9pZCBfX2lvbWVtICpiYXNlX3Zw
W1RJRFNTX01BWF9QT1JUU107CisKKwlzdHJ1Y3QgcmVnbWFwICpvbGRpX2lvX2N0cmw7CisKKwlz
dHJ1Y3QgY2xrICp2cF9jbGtbVElEU1NfTUFYX1BPUlRTXTsKKworCWNvbnN0IHN0cnVjdCBkaXNw
Y19mZWF0dXJlcyAqZmVhdDsKKworCXN0cnVjdCBjbGsgKmZjbGs7CisKKwlib29sIGlzX2VuYWJs
ZWQ7CisKKwlzdHJ1Y3QgZHNzX3ZwX2RhdGEgdnBfZGF0YVtUSURTU19NQVhfUE9SVFNdOworCisJ
c3RydWN0IGRzc19wbGFuZV9kYXRhIHBsYW5lX2RhdGFbVElEU1NfTUFYX1BMQU5FU107CisKKwl1
MzIgKmZvdXJjY3M7CisJdTMyIG51bV9mb3VyY2NzOworCisJdTMyIG1lbW9yeV9iYW5kd2lkdGhf
bGltaXQ7Cit9OworCitzdGF0aWMgdm9pZCBkaXNwY193cml0ZShzdHJ1Y3QgZGlzcGNfZGV2aWNl
ICpkaXNwYywgdTE2IHJlZywgdTMyIHZhbCkKK3sKKwlpb3dyaXRlMzIodmFsLCBkaXNwYy0+YmFz
ZV9jb21tb24gKyByZWcpOworfQorCitzdGF0aWMgdTMyIGRpc3BjX3JlYWQoc3RydWN0IGRpc3Bj
X2RldmljZSAqZGlzcGMsIHUxNiByZWcpCit7CisJcmV0dXJuIGlvcmVhZDMyKGRpc3BjLT5iYXNl
X2NvbW1vbiArIHJlZyk7Cit9CisKK3N0YXRpYyB2b2lkIGRpc3BjX3ZpZF93cml0ZShzdHJ1Y3Qg
ZGlzcGNfZGV2aWNlICpkaXNwYywgdTMyIGh3X3BsYW5lLCB1MTYgcmVnLCB1MzIgdmFsKQorewor
CXZvaWQgX19pb21lbSAqYmFzZSA9IGRpc3BjLT5iYXNlX3ZpZFtod19wbGFuZV07CisKKwlpb3dy
aXRlMzIodmFsLCBiYXNlICsgcmVnKTsKK30KKworc3RhdGljIHUzMiBkaXNwY192aWRfcmVhZChz
dHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYywgdTMyIGh3X3BsYW5lLCB1MTYgcmVnKQoreworCXZv
aWQgX19pb21lbSAqYmFzZSA9IGRpc3BjLT5iYXNlX3ZpZFtod19wbGFuZV07CisKKwlyZXR1cm4g
aW9yZWFkMzIoYmFzZSArIHJlZyk7Cit9CisKK3N0YXRpYyB2b2lkIGRpc3BjX292cl93cml0ZShz
dHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYywgdTMyIGh3X3ZpZGVvcG9ydCwgdTE2IHJlZywgdTMy
IHZhbCkKK3sKKwl2b2lkIF9faW9tZW0gKmJhc2UgPSBkaXNwYy0+YmFzZV9vdnJbaHdfdmlkZW9w
b3J0XTsKKworCWlvd3JpdGUzMih2YWwsIGJhc2UgKyByZWcpOworfQorCitzdGF0aWMgdTMyIGRp
c3BjX292cl9yZWFkKHN0cnVjdCBkaXNwY19kZXZpY2UgKmRpc3BjLCB1MzIgaHdfdmlkZW9wb3J0
LCB1MTYgcmVnKQoreworCXZvaWQgX19pb21lbSAqYmFzZSA9IGRpc3BjLT5iYXNlX292cltod192
aWRlb3BvcnRdOworCisJcmV0dXJuIGlvcmVhZDMyKGJhc2UgKyByZWcpOworfQorCitzdGF0aWMg
dm9pZCBkaXNwY192cF93cml0ZShzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYywgdTMyIGh3X3Zp
ZGVvcG9ydCwgdTE2IHJlZywgdTMyIHZhbCkKK3sKKwl2b2lkIF9faW9tZW0gKmJhc2UgPSBkaXNw
Yy0+YmFzZV92cFtod192aWRlb3BvcnRdOworCisJaW93cml0ZTMyKHZhbCwgYmFzZSArIHJlZyk7
Cit9CisKK3N0YXRpYyB1MzIgZGlzcGNfdnBfcmVhZChzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNw
YywgdTMyIGh3X3ZpZGVvcG9ydCwgdTE2IHJlZykKK3sKKwl2b2lkIF9faW9tZW0gKmJhc2UgPSBk
aXNwYy0+YmFzZV92cFtod192aWRlb3BvcnRdOworCisJcmV0dXJuIGlvcmVhZDMyKGJhc2UgKyBy
ZWcpOworfQorCitzdGF0aWMgZGlzcGNfaXJxX3QgZGlzcGNfdnBfaXJxX2Zyb21fcmF3KHUzMiBz
dGF0LCB1MzIgaHdfdmlkZW9wb3J0KQoreworCWRpc3BjX2lycV90IHZwX3N0YXQgPSAwOworCisJ
aWYgKHN0YXQgJiBCSVQoMCkpCisJCXZwX3N0YXQgfD0gRFNTX0lSUV9WUF9GUkFNRV9ET05FKGh3
X3ZpZGVvcG9ydCk7CisJaWYgKHN0YXQgJiBCSVQoMSkpCisJCXZwX3N0YXQgfD0gRFNTX0lSUV9W
UF9WU1lOQ19FVkVOKGh3X3ZpZGVvcG9ydCk7CisJaWYgKHN0YXQgJiBCSVQoMikpCisJCXZwX3N0
YXQgfD0gRFNTX0lSUV9WUF9WU1lOQ19PREQoaHdfdmlkZW9wb3J0KTsKKwlpZiAoc3RhdCAmIEJJ
VCg0KSkKKwkJdnBfc3RhdCB8PSBEU1NfSVJRX1ZQX1NZTkNfTE9TVChod192aWRlb3BvcnQpOwor
CisJcmV0dXJuIHZwX3N0YXQ7Cit9CisKK3N0YXRpYyB1MzIgZGlzcGNfdnBfaXJxX3RvX3Jhdyhk
aXNwY19pcnFfdCB2cHN0YXQsIHUzMiBod192aWRlb3BvcnQpCit7CisJdTMyIHN0YXQgPSAwOwor
CisJaWYgKHZwc3RhdCAmIERTU19JUlFfVlBfRlJBTUVfRE9ORShod192aWRlb3BvcnQpKQorCQlz
dGF0IHw9IEJJVCgwKTsKKwlpZiAodnBzdGF0ICYgRFNTX0lSUV9WUF9WU1lOQ19FVkVOKGh3X3Zp
ZGVvcG9ydCkpCisJCXN0YXQgfD0gQklUKDEpOworCWlmICh2cHN0YXQgJiBEU1NfSVJRX1ZQX1ZT
WU5DX09ERChod192aWRlb3BvcnQpKQorCQlzdGF0IHw9IEJJVCgyKTsKKwlpZiAodnBzdGF0ICYg
RFNTX0lSUV9WUF9TWU5DX0xPU1QoaHdfdmlkZW9wb3J0KSkKKwkJc3RhdCB8PSBCSVQoNCk7CisK
KwlyZXR1cm4gc3RhdDsKK30KKworc3RhdGljIGRpc3BjX2lycV90IGRpc3BjX3ZpZF9pcnFfZnJv
bV9yYXcodTMyIHN0YXQsIHUzMiBod19wbGFuZSkKK3sKKwlkaXNwY19pcnFfdCB2aWRfc3RhdCA9
IDA7CisKKwlpZiAoc3RhdCAmIEJJVCgwKSkKKwkJdmlkX3N0YXQgfD0gRFNTX0lSUV9QTEFORV9G
SUZPX1VOREVSRkxPVyhod19wbGFuZSk7CisKKwlyZXR1cm4gdmlkX3N0YXQ7Cit9CisKK3N0YXRp
YyB1MzIgZGlzcGNfdmlkX2lycV90b19yYXcoZGlzcGNfaXJxX3Qgdmlkc3RhdCwgdTMyIGh3X3Bs
YW5lKQoreworCXUzMiBzdGF0ID0gMDsKKworCWlmICh2aWRzdGF0ICYgRFNTX0lSUV9QTEFORV9G
SUZPX1VOREVSRkxPVyhod19wbGFuZSkpCisJCXN0YXQgfD0gQklUKDApOworCisJcmV0dXJuIHN0
YXQ7Cit9CisKK3N0YXRpYyBkaXNwY19pcnFfdCBkaXNwY19rMmdfdnBfcmVhZF9pcnFzdGF0dXMo
c3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMsCisJCQkJCSAgICAgICB1MzIgaHdfdmlkZW9wb3J0
KQoreworCXUzMiBzdGF0ID0gZGlzcGNfdnBfcmVhZChkaXNwYywgaHdfdmlkZW9wb3J0LCBESVNQ
Q19WUF9LMkdfSVJRU1RBVFVTKTsKKworCXJldHVybiBkaXNwY192cF9pcnFfZnJvbV9yYXcoc3Rh
dCwgaHdfdmlkZW9wb3J0KTsKK30KKworc3RhdGljIHZvaWQgZGlzcGNfazJnX3ZwX3dyaXRlX2ly
cXN0YXR1cyhzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYywKKwkJCQkJIHUzMiBod192aWRlb3Bv
cnQsIGRpc3BjX2lycV90IHZwc3RhdCkKK3sKKwl1MzIgc3RhdCA9IGRpc3BjX3ZwX2lycV90b19y
YXcodnBzdGF0LCBod192aWRlb3BvcnQpOworCisJZGlzcGNfdnBfd3JpdGUoZGlzcGMsIGh3X3Zp
ZGVvcG9ydCwgRElTUENfVlBfSzJHX0lSUVNUQVRVUywgc3RhdCk7Cit9CisKK3N0YXRpYyBkaXNw
Y19pcnFfdCBkaXNwY19rMmdfdmlkX3JlYWRfaXJxc3RhdHVzKHN0cnVjdCBkaXNwY19kZXZpY2Ug
KmRpc3BjLAorCQkJCQkJdTMyIGh3X3BsYW5lKQoreworCXUzMiBzdGF0ID0gZGlzcGNfdmlkX3Jl
YWQoZGlzcGMsIGh3X3BsYW5lLCBESVNQQ19WSURfSzJHX0lSUVNUQVRVUyk7CisKKwlyZXR1cm4g
ZGlzcGNfdmlkX2lycV9mcm9tX3JhdyhzdGF0LCBod19wbGFuZSk7Cit9CisKK3N0YXRpYyB2b2lk
IGRpc3BjX2syZ192aWRfd3JpdGVfaXJxc3RhdHVzKHN0cnVjdCBkaXNwY19kZXZpY2UgKmRpc3Bj
LAorCQkJCQkgIHUzMiBod19wbGFuZSwgZGlzcGNfaXJxX3Qgdmlkc3RhdCkKK3sKKwl1MzIgc3Rh
dCA9IGRpc3BjX3ZpZF9pcnFfdG9fcmF3KHZpZHN0YXQsIGh3X3BsYW5lKTsKKworCWRpc3BjX3Zp
ZF93cml0ZShkaXNwYywgaHdfcGxhbmUsIERJU1BDX1ZJRF9LMkdfSVJRU1RBVFVTLCBzdGF0KTsK
K30KKworc3RhdGljIGRpc3BjX2lycV90IGRpc3BjX2syZ192cF9yZWFkX2lycWVuYWJsZShzdHJ1
Y3QgZGlzcGNfZGV2aWNlICpkaXNwYywKKwkJCQkJICAgICAgIHUzMiBod192aWRlb3BvcnQpCit7
CisJdTMyIHN0YXQgPSBkaXNwY192cF9yZWFkKGRpc3BjLCBod192aWRlb3BvcnQsIERJU1BDX1ZQ
X0syR19JUlFFTkFCTEUpOworCisJcmV0dXJuIGRpc3BjX3ZwX2lycV9mcm9tX3JhdyhzdGF0LCBo
d192aWRlb3BvcnQpOworfQorCitzdGF0aWMgdm9pZCBkaXNwY19rMmdfdnBfd3JpdGVfaXJxZW5h
YmxlKHN0cnVjdCBkaXNwY19kZXZpY2UgKmRpc3BjLAorCQkJCQkgdTMyIGh3X3ZpZGVvcG9ydCwg
ZGlzcGNfaXJxX3QgdnBzdGF0KQoreworCXUzMiBzdGF0ID0gZGlzcGNfdnBfaXJxX3RvX3Jhdyh2
cHN0YXQsIGh3X3ZpZGVvcG9ydCk7CisKKwlkaXNwY192cF93cml0ZShkaXNwYywgaHdfdmlkZW9w
b3J0LCBESVNQQ19WUF9LMkdfSVJRRU5BQkxFLCBzdGF0KTsKK30KKworc3RhdGljIGRpc3BjX2ly
cV90IGRpc3BjX2syZ192aWRfcmVhZF9pcnFlbmFibGUoc3RydWN0IGRpc3BjX2RldmljZSAqZGlz
cGMsCisJCQkJCQl1MzIgaHdfcGxhbmUpCit7CisJdTMyIHN0YXQgPSBkaXNwY192aWRfcmVhZChk
aXNwYywgaHdfcGxhbmUsIERJU1BDX1ZJRF9LMkdfSVJRRU5BQkxFKTsKKworCXJldHVybiBkaXNw
Y192aWRfaXJxX2Zyb21fcmF3KHN0YXQsIGh3X3BsYW5lKTsKK30KKworc3RhdGljIHZvaWQgZGlz
cGNfazJnX3ZpZF93cml0ZV9pcnFlbmFibGUoc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMsCisJ
CQkJCSAgdTMyIGh3X3BsYW5lLCBkaXNwY19pcnFfdCB2aWRzdGF0KQoreworCXUzMiBzdGF0ID0g
ZGlzcGNfdmlkX2lycV90b19yYXcodmlkc3RhdCwgaHdfcGxhbmUpOworCisJZGlzcGNfdmlkX3dy
aXRlKGRpc3BjLCBod19wbGFuZSwgRElTUENfVklEX0syR19JUlFFTkFCTEUsIHN0YXQpOworfQor
CitzdGF0aWMgdm9pZCBkaXNwY19rMmdfY2xlYXJfaXJxc3RhdHVzKHN0cnVjdCBkaXNwY19kZXZp
Y2UgKmRpc3BjLAorCQkJCSAgICAgIGRpc3BjX2lycV90IG1hc2spCit7CisJZGlzcGNfazJnX3Zw
X3dyaXRlX2lycXN0YXR1cyhkaXNwYywgMCwgbWFzayk7CisJZGlzcGNfazJnX3ZpZF93cml0ZV9p
cnFzdGF0dXMoZGlzcGMsIDAsIG1hc2spOworfQorCitzdGF0aWMKK2Rpc3BjX2lycV90IGRpc3Bj
X2syZ19yZWFkX2FuZF9jbGVhcl9pcnFzdGF0dXMoc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMp
Cit7CisJZGlzcGNfaXJxX3Qgc3RhdCA9IDA7CisKKwkvKiBhbHdheXMgY2xlYXIgdGhlIHRvcCBs
ZXZlbCBpcnFzdGF0dXMgKi8KKwlkaXNwY193cml0ZShkaXNwYywgRElTUENfSVJRU1RBVFVTLAor
CQkgICAgZGlzcGNfcmVhZChkaXNwYywgRElTUENfSVJRU1RBVFVTKSk7CisKKwlzdGF0IHw9IGRp
c3BjX2syZ192cF9yZWFkX2lycXN0YXR1cyhkaXNwYywgMCk7CisJc3RhdCB8PSBkaXNwY19rMmdf
dmlkX3JlYWRfaXJxc3RhdHVzKGRpc3BjLCAwKTsKKworCWRpc3BjX2syZ19jbGVhcl9pcnFzdGF0
dXMoZGlzcGMsIHN0YXQpOworCisJcmV0dXJuIHN0YXQ7Cit9CisKK3N0YXRpYyBkaXNwY19pcnFf
dCBkaXNwY19rMmdfcmVhZF9pcnFlbmFibGUoc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMpCit7
CisJZGlzcGNfaXJxX3Qgc3RhdCA9IDA7CisKKwlzdGF0IHw9IGRpc3BjX2syZ192cF9yZWFkX2ly
cWVuYWJsZShkaXNwYywgMCk7CisJc3RhdCB8PSBkaXNwY19rMmdfdmlkX3JlYWRfaXJxZW5hYmxl
KGRpc3BjLCAwKTsKKworCXJldHVybiBzdGF0OworfQorCitzdGF0aWMgdm9pZCBkaXNwY19rMmdf
d3JpdGVfaXJxZW5hYmxlKHN0cnVjdCBkaXNwY19kZXZpY2UgKmRpc3BjLAorCQkJCSAgICAgIGRp
c3BjX2lycV90IG1hc2spCit7CisJZGlzcGNfaXJxX3Qgb2xkX21hc2sgPSBkaXNwY19rMmdfcmVh
ZF9pcnFlbmFibGUoZGlzcGMpOworCisJLyogY2xlYXIgdGhlIGlycXN0YXR1cyBmb3IgbmV3bHkg
ZW5hYmxlZCBpcnFzICovCisJZGlzcGNfazJnX2NsZWFyX2lycXN0YXR1cyhkaXNwYywgKG1hc2sg
XiBvbGRfbWFzaykgJiBtYXNrKTsKKworCWRpc3BjX2syZ192cF93cml0ZV9pcnFlbmFibGUoZGlz
cGMsIDAsIG1hc2spOworCWRpc3BjX2syZ192aWRfd3JpdGVfaXJxZW5hYmxlKGRpc3BjLCAwLCBt
YXNrKTsKKworCWRpc3BjX3dyaXRlKGRpc3BjLCBESVNQQ19JUlFFTkFCTEVfU0VULCAoMSA8PCAw
KSB8ICgxIDw8IDcpKTsKKworCS8qIGZsdXNoIHBvc3RlZCB3cml0ZSAqLworCWRpc3BjX2syZ19y
ZWFkX2lycWVuYWJsZShkaXNwYyk7Cit9CisKK3N0YXRpYyBkaXNwY19pcnFfdCBkaXNwY19rM192
cF9yZWFkX2lycXN0YXR1cyhzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYywKKwkJCQkJICAgICAg
dTMyIGh3X3ZpZGVvcG9ydCkKK3sKKwl1MzIgc3RhdCA9IGRpc3BjX3JlYWQoZGlzcGMsIERJU1BD
X1ZQX0lSUVNUQVRVUyhod192aWRlb3BvcnQpKTsKKworCXJldHVybiBkaXNwY192cF9pcnFfZnJv
bV9yYXcoc3RhdCwgaHdfdmlkZW9wb3J0KTsKK30KKworc3RhdGljIHZvaWQgZGlzcGNfazNfdnBf
d3JpdGVfaXJxc3RhdHVzKHN0cnVjdCBkaXNwY19kZXZpY2UgKmRpc3BjLAorCQkJCQl1MzIgaHdf
dmlkZW9wb3J0LCBkaXNwY19pcnFfdCB2cHN0YXQpCit7CisJdTMyIHN0YXQgPSBkaXNwY192cF9p
cnFfdG9fcmF3KHZwc3RhdCwgaHdfdmlkZW9wb3J0KTsKKworCWRpc3BjX3dyaXRlKGRpc3BjLCBE
SVNQQ19WUF9JUlFTVEFUVVMoaHdfdmlkZW9wb3J0KSwgc3RhdCk7Cit9CisKK3N0YXRpYyBkaXNw
Y19pcnFfdCBkaXNwY19rM192aWRfcmVhZF9pcnFzdGF0dXMoc3RydWN0IGRpc3BjX2RldmljZSAq
ZGlzcGMsCisJCQkJCSAgICAgICB1MzIgaHdfcGxhbmUpCit7CisJdTMyIHN0YXQgPSBkaXNwY19y
ZWFkKGRpc3BjLCBESVNQQ19WSURfSVJRU1RBVFVTKGh3X3BsYW5lKSk7CisKKwlyZXR1cm4gZGlz
cGNfdmlkX2lycV9mcm9tX3JhdyhzdGF0LCBod19wbGFuZSk7Cit9CisKK3N0YXRpYyB2b2lkIGRp
c3BjX2szX3ZpZF93cml0ZV9pcnFzdGF0dXMoc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMsCisJ
CQkJCSB1MzIgaHdfcGxhbmUsIGRpc3BjX2lycV90IHZpZHN0YXQpCit7CisJdTMyIHN0YXQgPSBk
aXNwY192aWRfaXJxX3RvX3Jhdyh2aWRzdGF0LCBod19wbGFuZSk7CisKKwlkaXNwY193cml0ZShk
aXNwYywgRElTUENfVklEX0lSUVNUQVRVUyhod19wbGFuZSksIHN0YXQpOworfQorCitzdGF0aWMg
ZGlzcGNfaXJxX3QgZGlzcGNfazNfdnBfcmVhZF9pcnFlbmFibGUoc3RydWN0IGRpc3BjX2Rldmlj
ZSAqZGlzcGMsCisJCQkJCSAgICAgIHUzMiBod192aWRlb3BvcnQpCit7CisJdTMyIHN0YXQgPSBk
aXNwY19yZWFkKGRpc3BjLCBESVNQQ19WUF9JUlFFTkFCTEUoaHdfdmlkZW9wb3J0KSk7CisKKwly
ZXR1cm4gZGlzcGNfdnBfaXJxX2Zyb21fcmF3KHN0YXQsIGh3X3ZpZGVvcG9ydCk7Cit9CisKK3N0
YXRpYyB2b2lkIGRpc3BjX2szX3ZwX3dyaXRlX2lycWVuYWJsZShzdHJ1Y3QgZGlzcGNfZGV2aWNl
ICpkaXNwYywKKwkJCQkJdTMyIGh3X3ZpZGVvcG9ydCwgZGlzcGNfaXJxX3QgdnBzdGF0KQorewor
CXUzMiBzdGF0ID0gZGlzcGNfdnBfaXJxX3RvX3Jhdyh2cHN0YXQsIGh3X3ZpZGVvcG9ydCk7CisK
KwlkaXNwY193cml0ZShkaXNwYywgRElTUENfVlBfSVJRRU5BQkxFKGh3X3ZpZGVvcG9ydCksIHN0
YXQpOworfQorCitzdGF0aWMgZGlzcGNfaXJxX3QgZGlzcGNfazNfdmlkX3JlYWRfaXJxZW5hYmxl
KHN0cnVjdCBkaXNwY19kZXZpY2UgKmRpc3BjLAorCQkJCQkgICAgICAgdTMyIGh3X3BsYW5lKQor
eworCXUzMiBzdGF0ID0gZGlzcGNfcmVhZChkaXNwYywgRElTUENfVklEX0lSUUVOQUJMRShod19w
bGFuZSkpOworCisJcmV0dXJuIGRpc3BjX3ZpZF9pcnFfZnJvbV9yYXcoc3RhdCwgaHdfcGxhbmUp
OworfQorCitzdGF0aWMgdm9pZCBkaXNwY19rM192aWRfd3JpdGVfaXJxZW5hYmxlKHN0cnVjdCBk
aXNwY19kZXZpY2UgKmRpc3BjLAorCQkJCQkgdTMyIGh3X3BsYW5lLCBkaXNwY19pcnFfdCB2aWRz
dGF0KQoreworCXUzMiBzdGF0ID0gZGlzcGNfdmlkX2lycV90b19yYXcodmlkc3RhdCwgaHdfcGxh
bmUpOworCisJZGlzcGNfd3JpdGUoZGlzcGMsIERJU1BDX1ZJRF9JUlFFTkFCTEUoaHdfcGxhbmUp
LCBzdGF0KTsKK30KKworc3RhdGljIHZvaWQgZGlzcGNfazNfY2xlYXJfaXJxc3RhdHVzKHN0cnVj
dCBkaXNwY19kZXZpY2UgKmRpc3BjLAorCQkJCSAgICAgZGlzcGNfaXJxX3QgY2xlYXJtYXNrKQor
eworCXVuc2lnbmVkIGludCBpOworCXUzMiB0b3BfY2xlYXIgPSAwOworCisJZm9yIChpID0gMDsg
aSA8IGRpc3BjLT5mZWF0LT5udW1fdnBzOyArK2kpIHsKKwkJaWYgKGNsZWFybWFzayAmIERTU19J
UlFfVlBfTUFTSyhpKSkgeworCQkJZGlzcGNfazNfdnBfd3JpdGVfaXJxc3RhdHVzKGRpc3BjLCBp
LCBjbGVhcm1hc2spOworCQkJdG9wX2NsZWFyIHw9IEJJVChpKTsKKwkJfQorCX0KKwlmb3IgKGkg
PSAwOyBpIDwgZGlzcGMtPmZlYXQtPm51bV9wbGFuZXM7ICsraSkgeworCQlpZiAoY2xlYXJtYXNr
ICYgRFNTX0lSUV9QTEFORV9NQVNLKGkpKSB7CisJCQlkaXNwY19rM192aWRfd3JpdGVfaXJxc3Rh
dHVzKGRpc3BjLCBpLCBjbGVhcm1hc2spOworCQkJdG9wX2NsZWFyIHw9IEJJVCg0ICsgaSk7CisJ
CX0KKwl9CisJaWYgKGRpc3BjLT5mZWF0LT5zdWJyZXYgPT0gRElTUENfSzJHKQorCQlyZXR1cm47
CisKKwlkaXNwY193cml0ZShkaXNwYywgRElTUENfSVJRU1RBVFVTLCB0b3BfY2xlYXIpOworCisJ
LyogRmx1c2ggcG9zdGVkIHdyaXRlcyAqLworCWRpc3BjX3JlYWQoZGlzcGMsIERJU1BDX0lSUVNU
QVRVUyk7Cit9CisKK3N0YXRpYworZGlzcGNfaXJxX3QgZGlzcGNfazNfcmVhZF9hbmRfY2xlYXJf
aXJxc3RhdHVzKHN0cnVjdCBkaXNwY19kZXZpY2UgKmRpc3BjKQoreworCWRpc3BjX2lycV90IHN0
YXR1cyA9IDA7CisJdW5zaWduZWQgaW50IGk7CisKKwlmb3IgKGkgPSAwOyBpIDwgZGlzcGMtPmZl
YXQtPm51bV92cHM7ICsraSkKKwkJc3RhdHVzIHw9IGRpc3BjX2szX3ZwX3JlYWRfaXJxc3RhdHVz
KGRpc3BjLCBpKTsKKworCWZvciAoaSA9IDA7IGkgPCBkaXNwYy0+ZmVhdC0+bnVtX3BsYW5lczsg
KytpKQorCQlzdGF0dXMgfD0gZGlzcGNfazNfdmlkX3JlYWRfaXJxc3RhdHVzKGRpc3BjLCBpKTsK
KworCWRpc3BjX2szX2NsZWFyX2lycXN0YXR1cyhkaXNwYywgc3RhdHVzKTsKKworCXJldHVybiBz
dGF0dXM7Cit9CisKK3N0YXRpYyBkaXNwY19pcnFfdCBkaXNwY19rM19yZWFkX2lycWVuYWJsZShz
dHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYykKK3sKKwlkaXNwY19pcnFfdCBlbmFibGUgPSAwOwor
CXVuc2lnbmVkIGludCBpOworCisJZm9yIChpID0gMDsgaSA8IGRpc3BjLT5mZWF0LT5udW1fdnBz
OyArK2kpCisJCWVuYWJsZSB8PSBkaXNwY19rM192cF9yZWFkX2lycWVuYWJsZShkaXNwYywgaSk7
CisKKwlmb3IgKGkgPSAwOyBpIDwgZGlzcGMtPmZlYXQtPm51bV9wbGFuZXM7ICsraSkKKwkJZW5h
YmxlIHw9IGRpc3BjX2szX3ZpZF9yZWFkX2lycWVuYWJsZShkaXNwYywgaSk7CisKKwlyZXR1cm4g
ZW5hYmxlOworfQorCitzdGF0aWMgdm9pZCBkaXNwY19rM193cml0ZV9pcnFlbmFibGUoc3RydWN0
IGRpc3BjX2RldmljZSAqZGlzcGMsCisJCQkJICAgICBkaXNwY19pcnFfdCBtYXNrKQoreworCXVu
c2lnbmVkIGludCBpOworCXUzMiBtYWluX2VuYWJsZSA9IDAsIG1haW5fZGlzYWJsZSA9IDA7CisJ
ZGlzcGNfaXJxX3Qgb2xkX21hc2s7CisKKwlvbGRfbWFzayA9IGRpc3BjX2szX3JlYWRfaXJxZW5h
YmxlKGRpc3BjKTsKKworCS8qIGNsZWFyIHRoZSBpcnFzdGF0dXMgZm9yIG5ld2x5IGVuYWJsZWQg
aXJxcyAqLworCWRpc3BjX2szX2NsZWFyX2lycXN0YXR1cyhkaXNwYywgKG9sZF9tYXNrIF4gbWFz
aykgJiBtYXNrKTsKKworCWZvciAoaSA9IDA7IGkgPCBkaXNwYy0+ZmVhdC0+bnVtX3ZwczsgKytp
KSB7CisJCWRpc3BjX2szX3ZwX3dyaXRlX2lycWVuYWJsZShkaXNwYywgaSwgbWFzayk7CisJCWlm
IChtYXNrICYgRFNTX0lSUV9WUF9NQVNLKGkpKQorCQkJbWFpbl9lbmFibGUgfD0gQklUKGkpOwkJ
LyogVlAgSVJRICovCisJCWVsc2UKKwkJCW1haW5fZGlzYWJsZSB8PSBCSVQoaSk7CQkvKiBWUCBJ
UlEgKi8KKwl9CisKKwlmb3IgKGkgPSAwOyBpIDwgZGlzcGMtPmZlYXQtPm51bV9wbGFuZXM7ICsr
aSkgeworCQlkaXNwY19rM192aWRfd3JpdGVfaXJxZW5hYmxlKGRpc3BjLCBpLCBtYXNrKTsKKwkJ
aWYgKG1hc2sgJiBEU1NfSVJRX1BMQU5FX01BU0soaSkpCisJCQltYWluX2VuYWJsZSB8PSBCSVQo
aSArIDQpOwkvKiBWSUQgSVJRICovCisJCWVsc2UKKwkJCW1haW5fZGlzYWJsZSB8PSBCSVQoaSAr
IDQpOwkvKiBWSUQgSVJRICovCisJfQorCisJaWYgKG1haW5fZW5hYmxlKQorCQlkaXNwY193cml0
ZShkaXNwYywgRElTUENfSVJRRU5BQkxFX1NFVCwgbWFpbl9lbmFibGUpOworCisJaWYgKG1haW5f
ZGlzYWJsZSkKKwkJZGlzcGNfd3JpdGUoZGlzcGMsIERJU1BDX0lSUUVOQUJMRV9DTFIsIG1haW5f
ZGlzYWJsZSk7CisKKwkvKiBGbHVzaCBwb3N0ZWQgd3JpdGVzICovCisJZGlzcGNfcmVhZChkaXNw
YywgRElTUENfSVJRRU5BQkxFX1NFVCk7Cit9CisKK2Rpc3BjX2lycV90IGRpc3BjX3JlYWRfYW5k
X2NsZWFyX2lycXN0YXR1cyhzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYykKK3sKKwlzd2l0Y2gg
KGRpc3BjLT5mZWF0LT5zdWJyZXYpIHsKKwljYXNlIERJU1BDX0syRzoKKwkJcmV0dXJuIGRpc3Bj
X2syZ19yZWFkX2FuZF9jbGVhcl9pcnFzdGF0dXMoZGlzcGMpOworCWNhc2UgRElTUENfQU02NVg6
CisJY2FzZSBESVNQQ19KNzIxRToKKwkJcmV0dXJuIGRpc3BjX2szX3JlYWRfYW5kX2NsZWFyX2ly
cXN0YXR1cyhkaXNwYyk7CisJZGVmYXVsdDoKKwkJV0FSTl9PTigxKTsKKwkJcmV0dXJuIDA7CisJ
fQorfQorCit2b2lkIGRpc3BjX3dyaXRlX2lycWVuYWJsZShzdHJ1Y3QgZGlzcGNfZGV2aWNlICpk
aXNwYywgZGlzcGNfaXJxX3QgbWFzaykKK3sKKwlzd2l0Y2ggKGRpc3BjLT5mZWF0LT5zdWJyZXYp
IHsKKwljYXNlIERJU1BDX0syRzoKKwkJZGlzcGNfazJnX3dyaXRlX2lycWVuYWJsZShkaXNwYywg
bWFzayk7CisJCWJyZWFrOworCWNhc2UgRElTUENfQU02NVg6CisJY2FzZSBESVNQQ19KNzIxRToK
KwkJZGlzcGNfazNfd3JpdGVfaXJxZW5hYmxlKGRpc3BjLCBtYXNrKTsKKwkJYnJlYWs7CisJZGVm
YXVsdDoKKwkJV0FSTl9PTigxKTsKKwkJYnJlYWs7CisJfQorfQorCitlbnVtIGRpc3BjX29sZGlf
bW9kZV9yZWdfdmFsIHsgU1BXR18xOCA9IDAsIEpFSURBXzI0ID0gMSwgU1BXR18yNCA9IDIgfTsK
Kworc3RydWN0IGRpc3BjX2J1c19mb3JtYXQgeworCXUzMiBidXNfZm10OworCXUzMiBkYXRhX3dp
ZHRoOworCWJvb2wgaXNfb2xkaV9mbXQ7CisJZW51bSBkaXNwY19vbGRpX21vZGVfcmVnX3ZhbCBv
bGRpX21vZGVfcmVnX3ZhbDsKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZGlzcGNfYnVzX2Zv
cm1hdCBkaXNwY19idXNfZm9ybWF0c1tdID0geworCXsgTUVESUFfQlVTX0ZNVF9SR0I0NDRfMVgx
MiwJCTEyLCBmYWxzZSwgMCB9LAorCXsgTUVESUFfQlVTX0ZNVF9SR0I1NjVfMVgxNiwJCTE2LCBm
YWxzZSwgMCB9LAorCXsgTUVESUFfQlVTX0ZNVF9SR0I2NjZfMVgxOCwJCTE4LCBmYWxzZSwgMCB9
LAorCXsgTUVESUFfQlVTX0ZNVF9SR0I4ODhfMVgyNCwJCTI0LCBmYWxzZSwgMCB9LAorCXsgTUVE
SUFfQlVTX0ZNVF9SR0IxMDEwMTBfMVgzMCwJCTMwLCBmYWxzZSwgMCB9LAorCXsgTUVESUFfQlVT
X0ZNVF9SR0IxMjEyMTJfMVgzNiwJCTM2LCBmYWxzZSwgMCB9LAorCXsgTUVESUFfQlVTX0ZNVF9S
R0I2NjZfMVg3WDNfU1BXRywJMTgsIHRydWUsIFNQV0dfMTggfSwKKwl7IE1FRElBX0JVU19GTVRf
UkdCODg4XzFYN1g0X1NQV0csCTI0LCB0cnVlLCBTUFdHXzI0IH0sCisJeyBNRURJQV9CVVNfRk1U
X1JHQjg4OF8xWDdYNF9KRUlEQSwJMjQsIHRydWUsIEpFSURBXzI0IH0sCit9OworCitzdGF0aWMg
Y29uc3QKK3N0cnVjdCBkaXNwY19idXNfZm9ybWF0ICpkaXNwY192cF9maW5kX2J1c19mbXQoc3Ry
dWN0IGRpc3BjX2RldmljZSAqZGlzcGMsCisJCQkJCSAgICAgICB1MzIgaHdfdmlkZW9wb3J0LAor
CQkJCQkgICAgICAgdTMyIGJ1c19mbXQsIHUzMiBidXNfZmxhZ3MpCit7CisJdW5zaWduZWQgaW50
IGk7CisKKwlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShkaXNwY19idXNfZm9ybWF0cyk7ICsr
aSkgeworCQlpZiAoZGlzcGNfYnVzX2Zvcm1hdHNbaV0uYnVzX2ZtdCA9PSBidXNfZm10KQorCQkJ
cmV0dXJuICZkaXNwY19idXNfZm9ybWF0c1tpXTsKKwl9CisKKwlyZXR1cm4gTlVMTDsKK30KKwor
aW50IGRpc3BjX3ZwX2J1c19jaGVjayhzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYywgdTMyIGh3
X3ZpZGVvcG9ydCwKKwkJICAgICAgIGNvbnN0IHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqc3RhdGUp
Cit7CisJY29uc3Qgc3RydWN0IHRpZHNzX2NydGNfc3RhdGUgKnRzdGF0ZSA9IHRvX3RpZHNzX2Ny
dGNfc3RhdGUoc3RhdGUpOworCWNvbnN0IHN0cnVjdCBkaXNwY19idXNfZm9ybWF0ICpmbXQ7CisK
KwlmbXQgPSBkaXNwY192cF9maW5kX2J1c19mbXQoZGlzcGMsIGh3X3ZpZGVvcG9ydCwgdHN0YXRl
LT5idXNfZm9ybWF0LAorCQkJCSAgICB0c3RhdGUtPmJ1c19mbGFncyk7CisJaWYgKCFmbXQpIHsK
KwkJZGV2X2RiZyhkaXNwYy0+ZGV2LCAiJXM6IFVuc3VwcG9ydGVkIGJ1cyBmb3JtYXQ6ICV1XG4i
LAorCQkJX19mdW5jX18sIHRzdGF0ZS0+YnVzX2Zvcm1hdCk7CisJCXJldHVybiAtRUlOVkFMOwor
CX0KKworCWlmIChkaXNwYy0+ZmVhdC0+dnBfYnVzX3R5cGVbaHdfdmlkZW9wb3J0XSAhPSBESVNQ
Q19WUF9PTERJICYmCisJICAgIGZtdC0+aXNfb2xkaV9mbXQpIHsKKwkJZGV2X2RiZyhkaXNwYy0+
ZGV2LCAiJXM6ICVzIGlzIG5vdCBPTERJLXBvcnRcbiIsCisJCQlfX2Z1bmNfXywgZGlzcGMtPmZl
YXQtPnZwX25hbWVbaHdfdmlkZW9wb3J0XSk7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCXJl
dHVybiAwOworfQorCitzdGF0aWMgdm9pZCBkaXNwY19vbGRpX3R4X3Bvd2VyKHN0cnVjdCBkaXNw
Y19kZXZpY2UgKmRpc3BjLCBib29sIHBvd2VyKQoreworCXUzMiB2YWwgPSBwb3dlciA/IDAgOiBP
TERJX1BXUkROX1RYOworCisJaWYgKFdBUk5fT04oIWRpc3BjLT5vbGRpX2lvX2N0cmwpKQorCQly
ZXR1cm47CisKKwlyZWdtYXBfdXBkYXRlX2JpdHMoZGlzcGMtPm9sZGlfaW9fY3RybCwgT0xESV9E
QVQwX0lPX0NUUkwsCisJCQkgICBPTERJX1BXUkROX1RYLCB2YWwpOworCXJlZ21hcF91cGRhdGVf
Yml0cyhkaXNwYy0+b2xkaV9pb19jdHJsLCBPTERJX0RBVDFfSU9fQ1RSTCwKKwkJCSAgIE9MRElf
UFdSRE5fVFgsIHZhbCk7CisJcmVnbWFwX3VwZGF0ZV9iaXRzKGRpc3BjLT5vbGRpX2lvX2N0cmws
IE9MRElfREFUMl9JT19DVFJMLAorCQkJICAgT0xESV9QV1JETl9UWCwgdmFsKTsKKwlyZWdtYXBf
dXBkYXRlX2JpdHMoZGlzcGMtPm9sZGlfaW9fY3RybCwgT0xESV9EQVQzX0lPX0NUUkwsCisJCQkg
ICBPTERJX1BXUkROX1RYLCB2YWwpOworCXJlZ21hcF91cGRhdGVfYml0cyhkaXNwYy0+b2xkaV9p
b19jdHJsLCBPTERJX0NMS19JT19DVFJMLAorCQkJICAgT0xESV9QV1JETl9UWCwgdmFsKTsKK30K
Kworc3RhdGljIHZvaWQgZGlzcGNfc2V0X251bV9kYXRhbGluZXMoc3RydWN0IGRpc3BjX2Rldmlj
ZSAqZGlzcGMsCisJCQkJICAgIHUzMiBod192aWRlb3BvcnQsIGludCBudW1fbGluZXMpCit7CisJ
aW50IHY7CisKKwlzd2l0Y2ggKG51bV9saW5lcykgeworCWNhc2UgMTI6CisJCXYgPSAwOyBicmVh
azsKKwljYXNlIDE2OgorCQl2ID0gMTsgYnJlYWs7CisJY2FzZSAxODoKKwkJdiA9IDI7IGJyZWFr
OworCWNhc2UgMjQ6CisJCXYgPSAzOyBicmVhazsKKwljYXNlIDMwOgorCQl2ID0gNDsgYnJlYWs7
CisJY2FzZSAzNjoKKwkJdiA9IDU7IGJyZWFrOworCWRlZmF1bHQ6CisJCVdBUk5fT04oMSk7CisJ
CXYgPSAzOworCX0KKworCVZQX1JFR19GTERfTU9EKGRpc3BjLCBod192aWRlb3BvcnQsIERJU1BD
X1ZQX0NPTlRST0wsIHYsIDEwLCA4KTsKK30KKworc3RhdGljIHZvaWQgZGlzcGNfZW5hYmxlX29s
ZGkoc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMsIHUzMiBod192aWRlb3BvcnQsCisJCQkgICAg
ICBjb25zdCBzdHJ1Y3QgZGlzcGNfYnVzX2Zvcm1hdCAqZm10KQoreworCXUzMiBvbGRpX2NmZyA9
IDA7CisJdTMyIG9sZGlfcmVzZXRfYml0ID0gQklUKDUgKyBod192aWRlb3BvcnQpOworCWludCBj
b3VudCA9IDA7CisKKwkvKgorCSAqIEZvciB0aGUgbW9tZW50IERVQUxNT0RFU1lOQywgTUFTVEVS
U0xBVkUsIE1PREUsIGFuZCBTUkMKKwkgKiBiaXRzIG9mIERJU1BDX1ZQX0RTU19PTERJX0NGRyBh
cmUgc2V0IHN0YXRpY2FsbHkgdG8gMC4KKwkgKi8KKworCWlmIChmbXQtPmRhdGFfd2lkdGggPT0g
MjQpCisJCW9sZGlfY2ZnIHw9IEJJVCg4KTsgLyogTVNCICovCisJZWxzZSBpZiAoZm10LT5kYXRh
X3dpZHRoICE9IDE4KQorCQlkZXZfd2FybihkaXNwYy0+ZGV2LCAiJXM6ICVkIHBvcnQgd2lkdGgg
bm90IHN1cHBvcnRlZFxuIiwKKwkJCSBfX2Z1bmNfXywgZm10LT5kYXRhX3dpZHRoKTsKKworCW9s
ZGlfY2ZnIHw9IEJJVCg3KTsgLyogREVQT0wgKi8KKworCW9sZGlfY2ZnID0gRkxEX01PRChvbGRp
X2NmZywgZm10LT5vbGRpX21vZGVfcmVnX3ZhbCwgMywgMSk7CisKKwlvbGRpX2NmZyB8PSBCSVQo
MTIpOyAvKiBTT0ZUUlNUICovCisKKwlvbGRpX2NmZyB8PSBCSVQoMCk7IC8qIEVOQUJMRSAqLwor
CisJZGlzcGNfdnBfd3JpdGUoZGlzcGMsIGh3X3ZpZGVvcG9ydCwgRElTUENfVlBfRFNTX09MRElf
Q0ZHLCBvbGRpX2NmZyk7CisKKwl3aGlsZSAoIShvbGRpX3Jlc2V0X2JpdCAmIGRpc3BjX3JlYWQo
ZGlzcGMsIERTU19TWVNTVEFUVVMpKSAmJgorCSAgICAgICBjb3VudCA8IDEwMDAwKQorCQljb3Vu
dCsrOworCisJaWYgKCEob2xkaV9yZXNldF9iaXQgJiBkaXNwY19yZWFkKGRpc3BjLCBEU1NfU1lT
U1RBVFVTKSkpCisJCWRldl93YXJuKGRpc3BjLT5kZXYsICIlczogdGltZW91dCB3YWl0aW5nIE9M
REkgcmVzZXQgZG9uZVxuIiwKKwkJCSBfX2Z1bmNfXyk7Cit9CisKK3ZvaWQgZGlzcGNfdnBfcHJl
cGFyZShzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYywgdTMyIGh3X3ZpZGVvcG9ydCwKKwkJICAg
ICAgY29uc3Qgc3RydWN0IGRybV9jcnRjX3N0YXRlICpzdGF0ZSkKK3sKKwljb25zdCBzdHJ1Y3Qg
dGlkc3NfY3J0Y19zdGF0ZSAqdHN0YXRlID0gdG9fdGlkc3NfY3J0Y19zdGF0ZShzdGF0ZSk7CisJ
Y29uc3Qgc3RydWN0IGRpc3BjX2J1c19mb3JtYXQgKmZtdDsKKworCWZtdCA9IGRpc3BjX3ZwX2Zp
bmRfYnVzX2ZtdChkaXNwYywgaHdfdmlkZW9wb3J0LCB0c3RhdGUtPmJ1c19mb3JtYXQsCisJCQkJ
ICAgIHRzdGF0ZS0+YnVzX2ZsYWdzKTsKKworCWlmIChXQVJOX09OKCFmbXQpKQorCQlyZXR1cm47
CisKKwlpZiAoZGlzcGMtPmZlYXQtPnZwX2J1c190eXBlW2h3X3ZpZGVvcG9ydF0gPT0gRElTUENf
VlBfT0xESSkgeworCQlkaXNwY19vbGRpX3R4X3Bvd2VyKGRpc3BjLCB0cnVlKTsKKworCQlkaXNw
Y19lbmFibGVfb2xkaShkaXNwYywgaHdfdmlkZW9wb3J0LCBmbXQpOworCX0KK30KKwordm9pZCBk
aXNwY192cF9lbmFibGUoc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMsIHUzMiBod192aWRlb3Bv
cnQsCisJCSAgICAgY29uc3Qgc3RydWN0IGRybV9jcnRjX3N0YXRlICpzdGF0ZSkKK3sKKwljb25z
dCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSA9ICZzdGF0ZS0+YWRqdXN0ZWRfbW9kZTsK
Kwljb25zdCBzdHJ1Y3QgdGlkc3NfY3J0Y19zdGF0ZSAqdHN0YXRlID0gdG9fdGlkc3NfY3J0Y19z
dGF0ZShzdGF0ZSk7CisJYm9vbCBhbGlnbiwgb25vZmYsIHJmLCBpZW8sIGlwYywgaWhzLCBpdnM7
CisJY29uc3Qgc3RydWN0IGRpc3BjX2J1c19mb3JtYXQgKmZtdDsKKwl1MzIgaHN3LCBoZnAsIGhi
cCwgdnN3LCB2ZnAsIHZicDsKKworCWZtdCA9IGRpc3BjX3ZwX2ZpbmRfYnVzX2ZtdChkaXNwYywg
aHdfdmlkZW9wb3J0LCB0c3RhdGUtPmJ1c19mb3JtYXQsCisJCQkJICAgIHRzdGF0ZS0+YnVzX2Zs
YWdzKTsKKworCWlmIChXQVJOX09OKCFmbXQpKQorCQlyZXR1cm47CisKKwlkaXNwY19zZXRfbnVt
X2RhdGFsaW5lcyhkaXNwYywgaHdfdmlkZW9wb3J0LCBmbXQtPmRhdGFfd2lkdGgpOworCisJaGZw
ID0gbW9kZS0+aHN5bmNfc3RhcnQgLSBtb2RlLT5oZGlzcGxheTsKKwloc3cgPSBtb2RlLT5oc3lu
Y19lbmQgLSBtb2RlLT5oc3luY19zdGFydDsKKwloYnAgPSBtb2RlLT5odG90YWwgLSBtb2RlLT5o
c3luY19lbmQ7CisKKwl2ZnAgPSBtb2RlLT52c3luY19zdGFydCAtIG1vZGUtPnZkaXNwbGF5Owor
CXZzdyA9IG1vZGUtPnZzeW5jX2VuZCAtIG1vZGUtPnZzeW5jX3N0YXJ0OworCXZicCA9IG1vZGUt
PnZ0b3RhbCAtIG1vZGUtPnZzeW5jX2VuZDsKKworCWRpc3BjX3ZwX3dyaXRlKGRpc3BjLCBod192
aWRlb3BvcnQsIERJU1BDX1ZQX1RJTUlOR19ILAorCQkgICAgICAgRkxEX1ZBTChoc3cgLSAxLCA3
LCAwKSB8CisJCSAgICAgICBGTERfVkFMKGhmcCAtIDEsIDE5LCA4KSB8CisJCSAgICAgICBGTERf
VkFMKGhicCAtIDEsIDMxLCAyMCkpOworCisJZGlzcGNfdnBfd3JpdGUoZGlzcGMsIGh3X3ZpZGVv
cG9ydCwgRElTUENfVlBfVElNSU5HX1YsCisJCSAgICAgICBGTERfVkFMKHZzdyAtIDEsIDcsIDAp
IHwKKwkJICAgICAgIEZMRF9WQUwodmZwLCAxOSwgOCkgfAorCQkgICAgICAgRkxEX1ZBTCh2YnAs
IDMxLCAyMCkpOworCisJaXZzID0gISEobW9kZS0+ZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX05WU1lO
Qyk7CisKKwlpaHMgPSAhIShtb2RlLT5mbGFncyAmIERSTV9NT0RFX0ZMQUdfTkhTWU5DKTsKKwor
CWllbyA9ICEhKHRzdGF0ZS0+YnVzX2ZsYWdzICYgRFJNX0JVU19GTEFHX0RFX0xPVyk7CisKKwlp
cGMgPSAhISh0c3RhdGUtPmJ1c19mbGFncyAmIERSTV9CVVNfRkxBR19QSVhEQVRBX05FR0VER0Up
OworCisJLyogYWx3YXlzIHVzZSB0aGUgJ3JmJyBzZXR0aW5nICovCisJb25vZmYgPSB0cnVlOwor
CisJcmYgPSAhISh0c3RhdGUtPmJ1c19mbGFncyAmIERSTV9CVVNfRkxBR19TWU5DX1BPU0VER0Up
OworCisJLyogYWx3YXlzIHVzZSBhbGlnbmVkIHN5bmNzICovCisJYWxpZ24gPSB0cnVlOworCisJ
LyogYWx3YXlzIHVzZSBERV9ISUdIIGZvciBPTERJICovCisJaWYgKGRpc3BjLT5mZWF0LT52cF9i
dXNfdHlwZVtod192aWRlb3BvcnRdID09IERJU1BDX1ZQX09MREkpCisJCWllbyA9IGZhbHNlOwor
CisJZGlzcGNfdnBfd3JpdGUoZGlzcGMsIGh3X3ZpZGVvcG9ydCwgRElTUENfVlBfUE9MX0ZSRVEs
CisJCSAgICAgICBGTERfVkFMKGFsaWduLCAxOCwgMTgpIHwKKwkJICAgICAgIEZMRF9WQUwob25v
ZmYsIDE3LCAxNykgfAorCQkgICAgICAgRkxEX1ZBTChyZiwgMTYsIDE2KSB8CisJCSAgICAgICBG
TERfVkFMKGllbywgMTUsIDE1KSB8CisJCSAgICAgICBGTERfVkFMKGlwYywgMTQsIDE0KSB8CisJ
CSAgICAgICBGTERfVkFMKGlocywgMTMsIDEzKSB8CisJCSAgICAgICBGTERfVkFMKGl2cywgMTIs
IDEyKSk7CisKKwlkaXNwY192cF93cml0ZShkaXNwYywgaHdfdmlkZW9wb3J0LCBESVNQQ19WUF9T
SVpFX1NDUkVFTiwKKwkJICAgICAgIEZMRF9WQUwobW9kZS0+aGRpc3BsYXkgLSAxLCAxMSwgMCkg
fAorCQkgICAgICAgRkxEX1ZBTChtb2RlLT52ZGlzcGxheSAtIDEsIDI3LCAxNikpOworCisJVlBf
UkVHX0ZMRF9NT0QoZGlzcGMsIGh3X3ZpZGVvcG9ydCwgRElTUENfVlBfQ09OVFJPTCwgMSwgMCwg
MCk7Cit9CisKK3ZvaWQgZGlzcGNfdnBfZGlzYWJsZShzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNw
YywgdTMyIGh3X3ZpZGVvcG9ydCkKK3sKKwlWUF9SRUdfRkxEX01PRChkaXNwYywgaHdfdmlkZW9w
b3J0LCBESVNQQ19WUF9DT05UUk9MLCAwLCAwLCAwKTsKK30KKwordm9pZCBkaXNwY192cF91bnBy
ZXBhcmUoc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMsIHUzMiBod192aWRlb3BvcnQpCit7CisJ
aWYgKGRpc3BjLT5mZWF0LT52cF9idXNfdHlwZVtod192aWRlb3BvcnRdID09IERJU1BDX1ZQX09M
REkpIHsKKwkJZGlzcGNfdnBfd3JpdGUoZGlzcGMsIGh3X3ZpZGVvcG9ydCwgRElTUENfVlBfRFNT
X09MRElfQ0ZHLCAwKTsKKworCQlkaXNwY19vbGRpX3R4X3Bvd2VyKGRpc3BjLCBmYWxzZSk7CisJ
fQorfQorCitib29sIGRpc3BjX3ZwX2dvX2J1c3koc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMs
IHUzMiBod192aWRlb3BvcnQpCit7CisJcmV0dXJuIFZQX1JFR19HRVQoZGlzcGMsIGh3X3ZpZGVv
cG9ydCwgRElTUENfVlBfQ09OVFJPTCwgNSwgNSk7Cit9CisKK3ZvaWQgZGlzcGNfdnBfZ28oc3Ry
dWN0IGRpc3BjX2RldmljZSAqZGlzcGMsIHUzMiBod192aWRlb3BvcnQpCit7CisJV0FSTl9PTihW
UF9SRUdfR0VUKGRpc3BjLCBod192aWRlb3BvcnQsIERJU1BDX1ZQX0NPTlRST0wsIDUsIDUpKTsK
KwlWUF9SRUdfRkxEX01PRChkaXNwYywgaHdfdmlkZW9wb3J0LCBESVNQQ19WUF9DT05UUk9MLCAx
LCA1LCA1KTsKK30KKworZW51bSBjOF90b19jMTJfbW9kZSB7IEM4X1RPX0MxMl9SRVBMSUNBVEUs
IEM4X1RPX0MxMl9NQVgsIEM4X1RPX0MxMl9NSU4gfTsKKworc3RhdGljIHUxNiBjOF90b19jMTIo
dTggYzgsIGVudW0gYzhfdG9fYzEyX21vZGUgbW9kZSkKK3sKKwl1MTYgYzEyOworCisJYzEyID0g
YzggPDwgNDsKKworCXN3aXRjaCAobW9kZSkgeworCWNhc2UgQzhfVE9fQzEyX1JFUExJQ0FURToK
KwkJLyogQ29weSBjOCA0IE1TQiB0byA0IExTQiBmb3IgZnVsbCBzY2FsZSBjMTIgKi8KKwkJYzEy
IHw9IGM4ID4+IDQ7CisJCWJyZWFrOworCWNhc2UgQzhfVE9fQzEyX01BWDoKKwkJYzEyIHw9IDB4
RjsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwljYXNlIEM4X1RPX0MxMl9NSU46CisJCWJyZWFrOwor
CX0KKworCXJldHVybiBjMTI7Cit9CisKK3N0YXRpYyB1NjQgYXJnYjg4ODhfdG9fYXJnYjEyMTIx
MjEyKHUzMiBhcmdiODg4OCwgZW51bSBjOF90b19jMTJfbW9kZSBtKQoreworCXU4IGEsIHIsIGcs
IGI7CisJdTY0IHY7CisKKwlhID0gKGFyZ2I4ODg4ID4+IDI0KSAmIDB4ZmY7CisJciA9IChhcmdi
ODg4OCA+PiAxNikgJiAweGZmOworCWcgPSAoYXJnYjg4ODggPj4gOCkgJiAweGZmOworCWIgPSAo
YXJnYjg4ODggPj4gMCkgJiAweGZmOworCisJdiA9ICgodTY0KWM4X3RvX2MxMihhLCBtKSA8PCAz
NikgfCAoKHU2NCljOF90b19jMTIociwgbSkgPDwgMjQpIHwKKwkJKCh1NjQpYzhfdG9fYzEyKGcs
IG0pIDw8IDEyKSB8ICh1NjQpYzhfdG9fYzEyKGIsIG0pOworCisJcmV0dXJuIHY7Cit9CisKK3N0
YXRpYyB2b2lkIGRpc3BjX3ZwX3NldF9kZWZhdWx0X2NvbG9yKHN0cnVjdCBkaXNwY19kZXZpY2Ug
KmRpc3BjLAorCQkJCSAgICAgICB1MzIgaHdfdmlkZW9wb3J0LCB1MzIgZGVmYXVsdF9jb2xvcikK
K3sKKwl1NjQgdjsKKworCXYgPSBhcmdiODg4OF90b19hcmdiMTIxMjEyMTIoZGVmYXVsdF9jb2xv
ciwgQzhfVE9fQzEyX1JFUExJQ0FURSk7CisKKwlkaXNwY19vdnJfd3JpdGUoZGlzcGMsIGh3X3Zp
ZGVvcG9ydCwKKwkJCURJU1BDX09WUl9ERUZBVUxUX0NPTE9SLCB2ICYgMHhmZmZmZmZmZik7CisJ
ZGlzcGNfb3ZyX3dyaXRlKGRpc3BjLCBod192aWRlb3BvcnQsCisJCQlESVNQQ19PVlJfREVGQVVM
VF9DT0xPUjIsICh2ID4+IDMyKSAmIDB4ZmZmZik7Cit9CisKK2VudW0gZHJtX21vZGVfc3RhdHVz
IGRpc3BjX3ZwX21vZGVfdmFsaWQoc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMsCisJCQkJCSB1
MzIgaHdfdmlkZW9wb3J0LAorCQkJCQkgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1v
ZGUpCit7CisJdTMyIGhzdywgaGZwLCBoYnAsIHZzdywgdmZwLCB2YnA7CisJZW51bSBkaXNwY192
cF9idXNfdHlwZSBidXNfdHlwZTsKKwlpbnQgbWF4X3BjbGs7CisKKwlidXNfdHlwZSA9IGRpc3Bj
LT5mZWF0LT52cF9idXNfdHlwZVtod192aWRlb3BvcnRdOworCisJbWF4X3BjbGsgPSBkaXNwYy0+
ZmVhdC0+bWF4X3BjbGtfa0h6W2J1c190eXBlXTsKKworCWlmIChXQVJOX09OKG1heF9wY2xrID09
IDApKQorCQlyZXR1cm4gTU9ERV9CQUQ7CisKKwlpZiAobW9kZS0+Y2xvY2sgPCBkaXNwYy0+ZmVh
dC0+bWluX3BjbGtfa0h6KQorCQlyZXR1cm4gTU9ERV9DTE9DS19MT1c7CisKKwlpZiAobW9kZS0+
Y2xvY2sgPiBtYXhfcGNsaykKKwkJcmV0dXJuIE1PREVfQ0xPQ0tfSElHSDsKKworCWlmIChtb2Rl
LT5oZGlzcGxheSA+IDQwOTYpCisJCXJldHVybiBNT0RFX0JBRDsKKworCWlmIChtb2RlLT52ZGlz
cGxheSA+IDQwOTYpCisJCXJldHVybiBNT0RFX0JBRDsKKworCS8qIFRPRE86IGFkZCBpbnRlcmxh
Y2Ugc3VwcG9ydCAqLworCWlmIChtb2RlLT5mbGFncyAmIERSTV9NT0RFX0ZMQUdfSU5URVJMQUNF
KQorCQlyZXR1cm4gTU9ERV9OT19JTlRFUkxBQ0U7CisKKwkvKgorCSAqIEVuZm9yY2UgdGhlIG91
dHB1dCB3aWR0aCBpcyBkaXZpc2libGUgYnkgMi4gQWN0dWFsbHkgdGhpcworCSAqIGlzIG9ubHkg
bmVlZGVkIGluIGZvbGxvd2luZyBjYXNlczoKKwkgKiAtIFlVViBvdXRwdXQgc2VsZWN0ZWQgKEJU
NjU2LCBCVDExMjApCisJICogLSBEaXRoZXJpbmcgZW5hYmxlZAorCSAqIC0gVERNIHdpdGggVERN
Q3ljbGVGb3JtYXQgPT0gMworCSAqIEJ1dCBmb3Igc2ltcGxpY2l0eSB3ZSBlbmZvcmNlIHRoYXQg
YWx3YXlzLgorCSAqLworCWlmICgobW9kZS0+aGRpc3BsYXkgJSAyKSAhPSAwKQorCQlyZXR1cm4g
TU9ERV9CQURfSFZBTFVFOworCisJaGZwID0gbW9kZS0+aHN5bmNfc3RhcnQgLSBtb2RlLT5oZGlz
cGxheTsKKwloc3cgPSBtb2RlLT5oc3luY19lbmQgLSBtb2RlLT5oc3luY19zdGFydDsKKwloYnAg
PSBtb2RlLT5odG90YWwgLSBtb2RlLT5oc3luY19lbmQ7CisKKwl2ZnAgPSBtb2RlLT52c3luY19z
dGFydCAtIG1vZGUtPnZkaXNwbGF5OworCXZzdyA9IG1vZGUtPnZzeW5jX2VuZCAtIG1vZGUtPnZz
eW5jX3N0YXJ0OworCXZicCA9IG1vZGUtPnZ0b3RhbCAtIG1vZGUtPnZzeW5jX2VuZDsKKworCWlm
IChoc3cgPCAxIHx8IGhzdyA+IDI1NiB8fAorCSAgICBoZnAgPCAxIHx8IGhmcCA+IDQwOTYgfHwK
KwkgICAgaGJwIDwgMSB8fCBoYnAgPiA0MDk2KQorCQlyZXR1cm4gTU9ERV9CQURfSFZBTFVFOwor
CisJaWYgKHZzdyA8IDEgfHwgdnN3ID4gMjU2IHx8CisJICAgIHZmcCA+IDQwOTUgfHwgdmJwID4g
NDA5NSkKKwkJcmV0dXJuIE1PREVfQkFEX1ZWQUxVRTsKKworCWlmIChkaXNwYy0+bWVtb3J5X2Jh
bmR3aWR0aF9saW1pdCkgeworCQljb25zdCB1bnNpZ25lZCBpbnQgYnBwID0gNDsKKwkJdTY0IGJh
bmR3aWR0aDsKKworCQliYW5kd2lkdGggPSAxMDAwICogbW9kZS0+Y2xvY2s7CisJCWJhbmR3aWR0
aCA9IGJhbmR3aWR0aCAqIG1vZGUtPmhkaXNwbGF5ICogbW9kZS0+dmRpc3BsYXkgKiBicHA7CisJ
CWJhbmR3aWR0aCA9IGRpdl91NjQoYmFuZHdpZHRoLCBtb2RlLT5odG90YWwgKiBtb2RlLT52dG90
YWwpOworCisJCWlmIChkaXNwYy0+bWVtb3J5X2JhbmR3aWR0aF9saW1pdCA8IGJhbmR3aWR0aCkK
KwkJCXJldHVybiBNT0RFX0JBRDsKKwl9CisKKwlyZXR1cm4gTU9ERV9PSzsKK30KKworaW50IGRp
c3BjX3ZwX2VuYWJsZV9jbGsoc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMsIHUzMiBod192aWRl
b3BvcnQpCit7CisJaW50IHJldCA9IGNsa19wcmVwYXJlX2VuYWJsZShkaXNwYy0+dnBfY2xrW2h3
X3ZpZGVvcG9ydF0pOworCisJaWYgKHJldCkKKwkJZGV2X2VycihkaXNwYy0+ZGV2LCAiJXM6IGVu
YWJsaW5nIGNsayBmYWlsZWQ6ICVkXG4iLCBfX2Z1bmNfXywKKwkJCXJldCk7CisKKwlyZXR1cm4g
cmV0OworfQorCit2b2lkIGRpc3BjX3ZwX2Rpc2FibGVfY2xrKHN0cnVjdCBkaXNwY19kZXZpY2Ug
KmRpc3BjLCB1MzIgaHdfdmlkZW9wb3J0KQoreworCWNsa19kaXNhYmxlX3VucHJlcGFyZShkaXNw
Yy0+dnBfY2xrW2h3X3ZpZGVvcG9ydF0pOworfQorCisvKgorICogQ2FsY3VsYXRlIHRoZSBwZXJj
ZW50YWdlIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUgcmVxdWVzdGVkIHBpeGVsIGNsb2NrIHJhdGUK
KyAqIGFuZCB0aGUgZWZmZWN0aXZlIHJhdGUgcmVzdWx0aW5nIGZyb20gY2FsY3VsYXRpbmcgdGhl
IGNsb2NrIGRpdmlkZXIgdmFsdWUuCisgKi8KK3N0YXRpYyB1bnNpZ25lZCBpbnQgZGlzcGNfcGNs
a19kaWZmKHVuc2lnbmVkIGxvbmcgcmF0ZSwKKwkJCQkgICAgdW5zaWduZWQgbG9uZyByZWFsX3Jh
dGUpCit7CisJaW50IHIgPSByYXRlIC8gMTAwLCByciA9IHJlYWxfcmF0ZSAvIDEwMDsKKworCXJl
dHVybiAodW5zaWduZWQgaW50KShhYnMoKChyciAtIHIpICogMTAwKSAvIHIpKTsKK30KKworaW50
IGRpc3BjX3ZwX3NldF9jbGtfcmF0ZShzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYywgdTMyIGh3
X3ZpZGVvcG9ydCwKKwkJCSAgdW5zaWduZWQgbG9uZyByYXRlKQoreworCWludCByOworCXVuc2ln
bmVkIGxvbmcgbmV3X3JhdGU7CisKKwlyID0gY2xrX3NldF9yYXRlKGRpc3BjLT52cF9jbGtbaHdf
dmlkZW9wb3J0XSwgcmF0ZSk7CisJaWYgKHIpIHsKKwkJZGV2X2VycihkaXNwYy0+ZGV2LCAidnAl
ZDogZmFpbGVkIHRvIHNldCBjbGsgcmF0ZSB0byAlbHVcbiIsCisJCQlod192aWRlb3BvcnQsIHJh
dGUpOworCQlyZXR1cm4gcjsKKwl9CisKKwluZXdfcmF0ZSA9IGNsa19nZXRfcmF0ZShkaXNwYy0+
dnBfY2xrW2h3X3ZpZGVvcG9ydF0pOworCisJaWYgKGRpc3BjX3BjbGtfZGlmZihyYXRlLCBuZXdf
cmF0ZSkgPiA1KQorCQlkZXZfd2FybihkaXNwYy0+ZGV2LAorCQkJICJ2cCVkOiBDbG9jayByYXRl
ICVsdSBkaWZmZXJzIG92ZXIgNSUlIGZyb20gcmVxdXN0ZWQgJWx1XG4iLAorCQkJIGh3X3ZpZGVv
cG9ydCwgbmV3X3JhdGUsIHJhdGUpOworCisJZGV2X2RiZyhkaXNwYy0+ZGV2LCAidnAlZDogbmV3
IHJhdGUgJWx1IEh6IChyZXF1ZXN0ZWQgJWx1IEh6KVxuIiwKKwkJaHdfdmlkZW9wb3J0LCBjbGtf
Z2V0X3JhdGUoZGlzcGMtPnZwX2Nsa1tod192aWRlb3BvcnRdKSwgcmF0ZSk7CisKKwlyZXR1cm4g
MDsKK30KKworLyogT1ZSICovCitzdGF0aWMgdm9pZCBkaXNwY19rMmdfb3ZyX3NldF9wbGFuZShz
dHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYywKKwkJCQkgICAgdTMyIGh3X3BsYW5lLCB1MzIgaHdf
dmlkZW9wb3J0LAorCQkJCSAgICB1MzIgeCwgdTMyIHksIHUzMiB6cG9zKQoreworCS8qIE9uIGsy
ZyB0aGVyZSBpcyBvbmx5IG9uZSBwbGFuZSBhbmQgbm8gbmVlZCBmb3Igb3ZyICovCisJZGlzcGNf
dmlkX3dyaXRlKGRpc3BjLCBod19wbGFuZSwgRElTUENfVklEX0syR19QT1NJVElPTiwKKwkJCXgg
fCAoeSA8PCAxNikpOworfQorCitzdGF0aWMgdm9pZCBkaXNwY19hbTY1eF9vdnJfc2V0X3BsYW5l
KHN0cnVjdCBkaXNwY19kZXZpY2UgKmRpc3BjLAorCQkJCSAgICAgIHUzMiBod19wbGFuZSwgdTMy
IGh3X3ZpZGVvcG9ydCwKKwkJCQkgICAgICB1MzIgeCwgdTMyIHksIHUzMiB6cG9zKQoreworCU9W
Ul9SRUdfRkxEX01PRChkaXNwYywgaHdfdmlkZW9wb3J0LCBESVNQQ19PVlJfQVRUUklCVVRFUyh6
cG9zKSwKKwkJCWh3X3BsYW5lLCA0LCAxKTsKKwlPVlJfUkVHX0ZMRF9NT0QoZGlzcGMsIGh3X3Zp
ZGVvcG9ydCwgRElTUENfT1ZSX0FUVFJJQlVURVMoenBvcyksCisJCQl4LCAxNywgNik7CisJT1ZS
X1JFR19GTERfTU9EKGRpc3BjLCBod192aWRlb3BvcnQsIERJU1BDX09WUl9BVFRSSUJVVEVTKHpw
b3MpLAorCQkJeSwgMzAsIDE5KTsKK30KKworc3RhdGljIHZvaWQgZGlzcGNfajcyMWVfb3ZyX3Nl
dF9wbGFuZShzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYywKKwkJCQkgICAgICB1MzIgaHdfcGxh
bmUsIHUzMiBod192aWRlb3BvcnQsCisJCQkJICAgICAgdTMyIHgsIHUzMiB5LCB1MzIgenBvcykK
K3sKKwlPVlJfUkVHX0ZMRF9NT0QoZGlzcGMsIGh3X3ZpZGVvcG9ydCwgRElTUENfT1ZSX0FUVFJJ
QlVURVMoenBvcyksCisJCQlod19wbGFuZSwgNCwgMSk7CisJT1ZSX1JFR19GTERfTU9EKGRpc3Bj
LCBod192aWRlb3BvcnQsIERJU1BDX09WUl9BVFRSSUJVVEVTMih6cG9zKSwKKwkJCXgsIDEzLCAw
KTsKKwlPVlJfUkVHX0ZMRF9NT0QoZGlzcGMsIGh3X3ZpZGVvcG9ydCwgRElTUENfT1ZSX0FUVFJJ
QlVURVMyKHpwb3MpLAorCQkJeSwgMjksIDE2KTsKK30KKworc3RhdGljIHZvaWQgZGlzcGNfb3Zy
X3NldF9wbGFuZShzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYywKKwkJCQl1MzIgaHdfcGxhbmUs
IHUzMiBod192aWRlb3BvcnQsCisJCQkJdTMyIHgsIHUzMiB5LCB1MzIgenBvcykKK3sKKwlzd2l0
Y2ggKGRpc3BjLT5mZWF0LT5zdWJyZXYpIHsKKwljYXNlIERJU1BDX0syRzoKKwkJZGlzcGNfazJn
X292cl9zZXRfcGxhbmUoZGlzcGMsIGh3X3BsYW5lLCBod192aWRlb3BvcnQsCisJCQkJCXgsIHks
IHpwb3MpOworCQlicmVhazsKKwljYXNlIERJU1BDX0FNNjVYOgorCQlkaXNwY19hbTY1eF9vdnJf
c2V0X3BsYW5lKGRpc3BjLCBod19wbGFuZSwgaHdfdmlkZW9wb3J0LAorCQkJCQkgIHgsIHksIHpw
b3MpOworCQlicmVhazsKKwljYXNlIERJU1BDX0o3MjFFOgorCQlkaXNwY19qNzIxZV9vdnJfc2V0
X3BsYW5lKGRpc3BjLCBod19wbGFuZSwgaHdfdmlkZW9wb3J0LAorCQkJCQkgIHgsIHksIHpwb3Mp
OworCQlicmVhazsKKwlkZWZhdWx0OgorCQlXQVJOX09OKDEpOworCQlicmVhazsKKwl9Cit9CisK
K3N0YXRpYyB2b2lkIGRpc3BjX292cl9lbmFibGVfcGxhbmUoc3RydWN0IGRpc3BjX2RldmljZSAq
ZGlzcGMsCisJCQkJICAgdTMyIGh3X3ZpZGVvcG9ydCwgdTMyIHpwb3MsIGJvb2wgZW5hYmxlKQor
eworCU9WUl9SRUdfRkxEX01PRChkaXNwYywgaHdfdmlkZW9wb3J0LCBESVNQQ19PVlJfQVRUUklC
VVRFUyh6cG9zKSwKKwkJCSEhZW5hYmxlLCAwLCAwKTsKK30KKworLyogQ1NDICovCitlbnVtIGNz
Y19jdG0geworCUNTQ19SUiwgQ1NDX1JHLCBDU0NfUkIsCisJQ1NDX0dSLCBDU0NfR0csIENTQ19H
QiwKKwlDU0NfQlIsIENTQ19CRywgQ1NDX0JCLAorfTsKKworZW51bSBjc2NfeXV2MnJnYiB7CisJ
Q1NDX1JZLCBDU0NfUkNiLCBDU0NfUkNyLAorCUNTQ19HWSwgQ1NDX0dDYiwgQ1NDX0dDciwKKwlD
U0NfQlksIENTQ19CQ2IsIENTQ19CQ3IsCit9OworCitlbnVtIGNzY19yZ2IyeXV2IHsKKwlDU0Nf
WVIsICBDU0NfWUcsICBDU0NfWUIsCisJQ1NDX0NiUiwgQ1NDX0NiRywgQ1NDX0NiQiwKKwlDU0Nf
Q3JSLCBDU0NfQ3JHLCBDU0NfQ3JCLAorfTsKKworc3RydWN0IGRpc3BjX2NzY19jb2VmIHsKKwl2
b2lkICgqdG9fcmVndmFsKShjb25zdCBzdHJ1Y3QgZGlzcGNfY3NjX2NvZWYgKmNzYywgdTMyICpy
ZWd2YWwpOworCWludCBtWzldOworCWludCBwcmVvZmZzZXRbM107CisJaW50IHBvc3RvZmZzZXRb
M107CisJZW51bSB7IENMSVBfTElNSVRFRF9SQU5HRSA9IDAsIENMSVBfRlVMTF9SQU5HRSA9IDEs
IH0gY2xpcGluZzsKKwljb25zdCBjaGFyICpuYW1lOworfTsKKworI2RlZmluZSBESVNQQ19DU0Nf
UkVHVkFMX0xFTiA4CisKK3N0YXRpYyB2b2lkIGRpc3BjX2NzY19vZmZzZXRfcmVndmFsKGNvbnN0
IHN0cnVjdCBkaXNwY19jc2NfY29lZiAqY3NjLAorCQkJCSAgICB1MzIgKnJlZ3ZhbCkKK3sKKyNk
ZWZpbmUgT1ZBTCh4LCB5KSAoRkxEX1ZBTCh4LCAxNSwgMykgfCBGTERfVkFMKHksIDMxLCAxOSkp
CisJcmVndmFsWzVdID0gT1ZBTChjc2MtPnByZW9mZnNldFswXSwgY3NjLT5wcmVvZmZzZXRbMV0p
OworCXJlZ3ZhbFs2XSA9IE9WQUwoY3NjLT5wcmVvZmZzZXRbMl0sIGNzYy0+cG9zdG9mZnNldFsw
XSk7CisJcmVndmFsWzddID0gT1ZBTChjc2MtPnBvc3RvZmZzZXRbMV0sIGNzYy0+cG9zdG9mZnNl
dFsyXSk7CisjdW5kZWYgT1ZBTAorfQorCisjZGVmaW5lIENWQUwoeCwgeSkgKEZMRF9WQUwoeCwg
MTAsIDApIHwgRkxEX1ZBTCh5LCAyNiwgMTYpKQorc3RhdGljIHZvaWQgZGlzcGNfY3NjX3l1djJy
Z2JfcmVndmFsKGNvbnN0IHN0cnVjdCBkaXNwY19jc2NfY29lZiAqY3NjLAorCQkJCSAgICAgdTMy
ICpyZWd2YWwpCit7CisJcmVndmFsWzBdID0gQ1ZBTChjc2MtPm1bQ1NDX1JZXSwgY3NjLT5tW0NT
Q19SQ3JdKTsKKwlyZWd2YWxbMV0gPSBDVkFMKGNzYy0+bVtDU0NfUkNiXSwgY3NjLT5tW0NTQ19H
WV0pOworCXJlZ3ZhbFsyXSA9IENWQUwoY3NjLT5tW0NTQ19HQ3JdLCBjc2MtPm1bQ1NDX0dDYl0p
OworCXJlZ3ZhbFszXSA9IENWQUwoY3NjLT5tW0NTQ19CWV0sIGNzYy0+bVtDU0NfQkNyXSk7CisJ
cmVndmFsWzRdID0gQ1ZBTChjc2MtPm1bQ1NDX0JDYl0sIDApOworCisJZGlzcGNfY3NjX29mZnNl
dF9yZWd2YWwoY3NjLCByZWd2YWwpOworfQorCitzdGF0aWMgdm9pZCBfX21heWJlX3VudXNlZCBk
aXNwY19jc2NfcmdiMnl1dl9yZWd2YWwoY29uc3Qgc3RydWN0IGRpc3BjX2NzY19jb2VmICpjc2Ms
CisJCQkJCQkgICAgdTMyICpyZWd2YWwpCit7CisJcmVndmFsWzBdID0gQ1ZBTChjc2MtPm1bQ1ND
X1lSXSwgY3NjLT5tW0NTQ19ZR10pOworCXJlZ3ZhbFsxXSA9IENWQUwoY3NjLT5tW0NTQ19ZQl0s
IGNzYy0+bVtDU0NfQ3JSXSk7CisJcmVndmFsWzJdID0gQ1ZBTChjc2MtPm1bQ1NDX0NyR10sIGNz
Yy0+bVtDU0NfQ3JCXSk7CisJcmVndmFsWzNdID0gQ1ZBTChjc2MtPm1bQ1NDX0NiUl0sIGNzYy0+
bVtDU0NfQ2JHXSk7CisJcmVndmFsWzRdID0gQ1ZBTChjc2MtPm1bQ1NDX0NiQl0sIDApOworCisJ
ZGlzcGNfY3NjX29mZnNldF9yZWd2YWwoY3NjLCByZWd2YWwpOworfQorCitzdGF0aWMgdm9pZCBk
aXNwY19jc2NfY3ByX3JlZ3ZhbChjb25zdCBzdHJ1Y3QgZGlzcGNfY3NjX2NvZWYgKmNzYywKKwkJ
CQkgdTMyICpyZWd2YWwpCit7CisJcmVndmFsWzBdID0gQ1ZBTChjc2MtPm1bQ1NDX1JSXSwgY3Nj
LT5tW0NTQ19SR10pOworCXJlZ3ZhbFsxXSA9IENWQUwoY3NjLT5tW0NTQ19SQl0sIGNzYy0+bVtD
U0NfR1JdKTsKKwlyZWd2YWxbMl0gPSBDVkFMKGNzYy0+bVtDU0NfR0ddLCBjc2MtPm1bQ1NDX0dC
XSk7CisJcmVndmFsWzNdID0gQ1ZBTChjc2MtPm1bQ1NDX0JSXSwgY3NjLT5tW0NTQ19CR10pOwor
CXJlZ3ZhbFs0XSA9IENWQUwoY3NjLT5tW0NTQ19CQl0sIDApOworCisJZGlzcGNfY3NjX29mZnNl
dF9yZWd2YWwoY3NjLCByZWd2YWwpOworfQorCisjdW5kZWYgQ1ZBTAorCitzdGF0aWMgdm9pZCBk
aXNwY19rMmdfdmlkX3dyaXRlX2NzYyhzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYywgdTMyIGh3
X3BsYW5lLAorCQkJCSAgICBjb25zdCBzdHJ1Y3QgZGlzcGNfY3NjX2NvZWYgKmNzYykKK3sKKwlz
dGF0aWMgY29uc3QgdTE2IGRpc3BjX3ZpZF9jc2NfY29lZl9yZWdbXSA9IHsKKwkJRElTUENfVklE
X0NTQ19DT0VGKDApLCBESVNQQ19WSURfQ1NDX0NPRUYoMSksCisJCURJU1BDX1ZJRF9DU0NfQ09F
RigyKSwgRElTUENfVklEX0NTQ19DT0VGKDMpLAorCQlESVNQQ19WSURfQ1NDX0NPRUYoNCksIERJ
U1BDX1ZJRF9DU0NfQ09FRig1KSwKKwkJRElTUENfVklEX0NTQ19DT0VGKDYpLCAvKiBLMkcgaGFz
IG5vIHBvc3Qgb2Zmc2V0IHN1cHBvcnQgKi8KKwl9OworCXUzMiByZWd2YWxbRElTUENfQ1NDX1JF
R1ZBTF9MRU5dOworCXVuc2lnbmVkIGludCBpOworCisJY3NjLT50b19yZWd2YWwoY3NjLCByZWd2
YWwpOworCisJaWYgKHJlZ3ZhbFs3XSAhPSAwKQorCQlkZXZfd2FybihkaXNwYy0+ZGV2LCAiJXM6
IE5vIHBvc3Qgb2Zmc2V0IHN1cHBvcnQgZm9yICVzXG4iLAorCQkJIF9fZnVuY19fLCBjc2MtPm5h
bWUpOworCisJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoZGlzcGNfdmlkX2NzY19jb2VmX3Jl
Zyk7IGkrKykKKwkJZGlzcGNfdmlkX3dyaXRlKGRpc3BjLCBod19wbGFuZSwgZGlzcGNfdmlkX2Nz
Y19jb2VmX3JlZ1tpXSwKKwkJCQlyZWd2YWxbaV0pOworfQorCitzdGF0aWMgdm9pZCBkaXNwY19r
M192aWRfd3JpdGVfY3NjKHN0cnVjdCBkaXNwY19kZXZpY2UgKmRpc3BjLCB1MzIgaHdfcGxhbmUs
CisJCQkJICAgY29uc3Qgc3RydWN0IGRpc3BjX2NzY19jb2VmICpjc2MpCit7CisJc3RhdGljIGNv
bnN0IHUxNiBkaXNwY192aWRfY3NjX2NvZWZfcmVnW0RJU1BDX0NTQ19SRUdWQUxfTEVOXSA9IHsK
KwkJRElTUENfVklEX0NTQ19DT0VGKDApLCBESVNQQ19WSURfQ1NDX0NPRUYoMSksCisJCURJU1BD
X1ZJRF9DU0NfQ09FRigyKSwgRElTUENfVklEX0NTQ19DT0VGKDMpLAorCQlESVNQQ19WSURfQ1ND
X0NPRUYoNCksIERJU1BDX1ZJRF9DU0NfQ09FRig1KSwKKwkJRElTUENfVklEX0NTQ19DT0VGKDYp
LCBESVNQQ19WSURfQ1NDX0NPRUY3LAorCX07CisJdTMyIHJlZ3ZhbFtESVNQQ19DU0NfUkVHVkFM
X0xFTl07CisJdW5zaWduZWQgaW50IGk7CisKKwljc2MtPnRvX3JlZ3ZhbChjc2MsIHJlZ3ZhbCk7
CisKKwlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShkaXNwY192aWRfY3NjX2NvZWZfcmVnKTsg
aSsrKQorCQlkaXNwY192aWRfd3JpdGUoZGlzcGMsIGh3X3BsYW5lLCBkaXNwY192aWRfY3NjX2Nv
ZWZfcmVnW2ldLAorCQkJCXJlZ3ZhbFtpXSk7Cit9CisKKy8qIFlVViAtPiBSR0IsIElUVS1SIEJU
LjYwMSwgZnVsbCByYW5nZSAqLworc3RhdGljIGNvbnN0IHN0cnVjdCBkaXNwY19jc2NfY29lZiBj
c2NfeXV2MnJnYl9idDYwMV9mdWxsID0geworCWRpc3BjX2NzY195dXYycmdiX3JlZ3ZhbCwKKwl7
IDI1NiwgICAwLCAgMzU4LAkvKiByeSwgcmNiLCByY3IgfDEuMDAwICAwLjAwMCAgMS40MDJ8Ki8K
KwkgIDI1NiwgLTg4LCAtMTgyLAkvKiBneSwgZ2NiLCBnY3IgfDEuMDAwIC0wLjM0NCAtMC43MTR8
Ki8KKwkgIDI1NiwgNDUyLCAgICAwLCB9LAkvKiBieSwgYmNiLCBiY3IgfDEuMDAwICAxLjc3MiAg
MC4wMDB8Ki8KKwl7ICAgIDAsIC0yMDQ4LCAtMjA0OCwgfSwJLyogZnVsbCByYW5nZSAqLworCXsg
ICAgMCwgICAgIDAsICAgICAwLCB9LAorCUNMSVBfRlVMTF9SQU5HRSwKKwkiQlQuNjAxIEZ1bGwi
LAorfTsKKworLyogWVVWIC0+IFJHQiwgSVRVLVIgQlQuNjAxLCBsaW1pdGVkIHJhbmdlICovCitz
dGF0aWMgY29uc3Qgc3RydWN0IGRpc3BjX2NzY19jb2VmIGNzY195dXYycmdiX2J0NjAxX2xpbSA9
IHsKKwlkaXNwY19jc2NfeXV2MnJnYl9yZWd2YWwsCisJeyAyOTgsICAgIDAsICA0MDksCS8qIHJ5
LCByY2IsIHJjciB8MS4xNjQgIDAuMDAwICAxLjU5NnwqLworCSAgMjk4LCAtMTAwLCAtMjA4LAkv
KiBneSwgZ2NiLCBnY3IgfDEuMTY0IC0wLjM5MiAtMC44MTN8Ki8KKwkgIDI5OCwgIDUxNiwgICAg
MCwgfSwJLyogYnksIGJjYiwgYmNyIHwxLjE2NCAgMi4wMTcgIDAuMDAwfCovCisJeyAtMjU2LCAt
MjA0OCwgLTIwNDgsIH0sCS8qIGxpbWl0ZWQgcmFuZ2UgKi8KKwl7ICAgIDAsICAgICAwLCAgICAg
MCwgfSwKKwlDTElQX0ZVTExfUkFOR0UsCisJIkJULjYwMSBMaW1pdGVkIiwKK307CisKKy8qIFlV
ViAtPiBSR0IsIElUVS1SIEJULjcwOSwgZnVsbCByYW5nZSAqLworc3RhdGljIGNvbnN0IHN0cnVj
dCBkaXNwY19jc2NfY29lZiBjc2NfeXV2MnJnYl9idDcwOV9mdWxsID0geworCWRpc3BjX2NzY195
dXYycmdiX3JlZ3ZhbCwKKwl7IDI1NiwJICAwLCAgNDAyLAkvKiByeSwgcmNiLCByY3IgfDEuMDAw
CTAuMDAwICAxLjU3MHwqLworCSAgMjU2LCAgLTQ4LCAtMTIwLAkvKiBneSwgZ2NiLCBnY3IgfDEu
MDAwIC0wLjE4NyAtMC40Njd8Ki8KKwkgIDI1NiwgIDQ3NSwgICAgMCwgfSwJLyogYnksIGJjYiwg
YmNyIHwxLjAwMAkxLjg1NiAgMC4wMDB8Ki8KKwl7ICAgIDAsIC0yMDQ4LCAtMjA0OCwgfSwJLyog
ZnVsbCByYW5nZSAqLworCXsgICAgMCwgICAgIDAsICAgICAwLCB9LAorCUNMSVBfRlVMTF9SQU5H
RSwKKwkiQlQuNzA5IEZ1bGwiLAorfTsKKworLyogWVVWIC0+IFJHQiwgSVRVLVIgQlQuNzA5LCBs
aW1pdGVkIHJhbmdlICovCitzdGF0aWMgY29uc3Qgc3RydWN0IGRpc3BjX2NzY19jb2VmIGNzY195
dXYycmdiX2J0NzA5X2xpbSA9IHsKKwlkaXNwY19jc2NfeXV2MnJnYl9yZWd2YWwsCisJeyAyOTgs
ICAgIDAsICA0NTksCS8qIHJ5LCByY2IsIHJjciB8MS4xNjQgIDAuMDAwICAxLjc5M3wqLworCSAg
Mjk4LCAgLTU1LCAtMTM2LAkvKiBneSwgZ2NiLCBnY3IgfDEuMTY0IC0wLjIxMyAtMC41MzN8Ki8K
KwkgIDI5OCwgIDU0MSwgICAgMCwgfSwJLyogYnksIGJjYiwgYmNyIHwxLjE2NCAgMi4xMTIgIDAu
MDAwfCovCisJeyAtMjU2LCAtMjA0OCwgLTIwNDgsIH0sCS8qIGxpbWl0ZWQgcmFuZ2UgKi8KKwl7
ICAgIDAsICAgICAwLCAgICAgMCwgfSwKKwlDTElQX0ZVTExfUkFOR0UsCisJIkJULjcwOSBMaW1p
dGVkIiwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgeworCWVudW0gZHJtX2NvbG9yX2VuY29k
aW5nIGVuY29kaW5nOworCWVudW0gZHJtX2NvbG9yX3JhbmdlIHJhbmdlOworCWNvbnN0IHN0cnVj
dCBkaXNwY19jc2NfY29lZiAqY3NjOworfSBkaXNwY19jc2NfdGFibGVbXSA9IHsKKwl7IERSTV9D
T0xPUl9ZQ0JDUl9CVDYwMSwgRFJNX0NPTE9SX1lDQkNSX0ZVTExfUkFOR0UsCisJICAmY3NjX3l1
djJyZ2JfYnQ2MDFfZnVsbCwgfSwKKwl7IERSTV9DT0xPUl9ZQ0JDUl9CVDYwMSwgRFJNX0NPTE9S
X1lDQkNSX0xJTUlURURfUkFOR0UsCisJICAmY3NjX3l1djJyZ2JfYnQ2MDFfbGltLCB9LAorCXsg
RFJNX0NPTE9SX1lDQkNSX0JUNzA5LCBEUk1fQ09MT1JfWUNCQ1JfRlVMTF9SQU5HRSwKKwkgICZj
c2NfeXV2MnJnYl9idDcwOV9mdWxsLCB9LAorCXsgRFJNX0NPTE9SX1lDQkNSX0JUNzA5LCBEUk1f
Q09MT1JfWUNCQ1JfTElNSVRFRF9SQU5HRSwKKwkgICZjc2NfeXV2MnJnYl9idDcwOV9saW0sIH0s
Cit9OworCitzdGF0aWMgY29uc3QKK3N0cnVjdCBkaXNwY19jc2NfY29lZiAqZGlzcGNfZmluZF9j
c2MoZW51bSBkcm1fY29sb3JfZW5jb2RpbmcgZW5jb2RpbmcsCisJCQkJICAgICAgZW51bSBkcm1f
Y29sb3JfcmFuZ2UgcmFuZ2UpCit7CisJdW5zaWduZWQgaW50IGk7CisKKwlmb3IgKGkgPSAwOyBp
IDwgQVJSQVlfU0laRShkaXNwY19jc2NfdGFibGUpOyBpKyspIHsKKwkJaWYgKGRpc3BjX2NzY190
YWJsZVtpXS5lbmNvZGluZyA9PSBlbmNvZGluZyAmJgorCQkgICAgZGlzcGNfY3NjX3RhYmxlW2ld
LnJhbmdlID09IHJhbmdlKSB7CisJCQlyZXR1cm4gZGlzcGNfY3NjX3RhYmxlW2ldLmNzYzsKKwkJ
fQorCX0KKwlyZXR1cm4gTlVMTDsKK30KKworc3RhdGljIHZvaWQgZGlzcGNfdmlkX2NzY19zZXR1
cChzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYywgdTMyIGh3X3BsYW5lLAorCQkJCWNvbnN0IHN0
cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnN0YXRlKQoreworCXN0YXRpYyBjb25zdCBzdHJ1Y3QgZGlz
cGNfY3NjX2NvZWYgKmNvZWY7CisKKwljb2VmID0gZGlzcGNfZmluZF9jc2Moc3RhdGUtPmNvbG9y
X2VuY29kaW5nLCBzdGF0ZS0+Y29sb3JfcmFuZ2UpOworCWlmICghY29lZikgeworCQlkZXZfZXJy
KGRpc3BjLT5kZXYsICIlczogQ1NDICgldSwldSkgbm90IGZvdW5kXG4iLAorCQkJX19mdW5jX18s
IHN0YXRlLT5jb2xvcl9lbmNvZGluZywgc3RhdGUtPmNvbG9yX3JhbmdlKTsKKwkJcmV0dXJuOwor
CX0KKworCWlmIChkaXNwYy0+ZmVhdC0+c3VicmV2ID09IERJU1BDX0syRykKKwkJZGlzcGNfazJn
X3ZpZF93cml0ZV9jc2MoZGlzcGMsIGh3X3BsYW5lLCBjb2VmKTsKKwllbHNlCisJCWRpc3BjX2sz
X3ZpZF93cml0ZV9jc2MoZGlzcGMsIGh3X3BsYW5lLCBjb2VmKTsKK30KKworc3RhdGljIHZvaWQg
ZGlzcGNfdmlkX2NzY19lbmFibGUoc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMsIHUzMiBod19w
bGFuZSwKKwkJCQkgYm9vbCBlbmFibGUpCit7CisJVklEX1JFR19GTERfTU9EKGRpc3BjLCBod19w
bGFuZSwgRElTUENfVklEX0FUVFJJQlVURVMsICEhZW5hYmxlLCA5LCA5KTsKK30KKworLyogU0NB
TEVSICovCisKK3N0YXRpYyB1MzIgZGlzcGNfY2FsY19maXJfaW5jKHUzMiBpbiwgdTMyIG91dCkK
K3sKKwlyZXR1cm4gKHUzMilkaXZfdTY0KDB4MjAwMDAwdWxsICogaW4sIG91dCk7Cit9CisKK2Vu
dW0gZGlzcGNfdmlkX2Zpcl9jb2VmX3NldCB7CisJRElTUENfVklEX0ZJUl9DT0VGX0hPUklaLAor
CURJU1BDX1ZJRF9GSVJfQ09FRl9IT1JJWl9VViwKKwlESVNQQ19WSURfRklSX0NPRUZfVkVSVCwK
KwlESVNQQ19WSURfRklSX0NPRUZfVkVSVF9VViwKK307CisKK3N0YXRpYyB2b2lkIGRpc3BjX3Zp
ZF93cml0ZV9maXJfY29lZnMoc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMsCisJCQkJICAgICAg
dTMyIGh3X3BsYW5lLAorCQkJCSAgICAgIGVudW0gZGlzcGNfdmlkX2Zpcl9jb2VmX3NldCBjb2Vm
X3NldCwKKwkJCQkgICAgICBjb25zdCBzdHJ1Y3QgdGlkc3Nfc2NhbGVfY29lZnMgKmNvZWZzKQor
eworCXN0YXRpYyBjb25zdCB1MTYgYzBfcmVnc1tdID0geworCQlbRElTUENfVklEX0ZJUl9DT0VG
X0hPUklaXSA9IERJU1BDX1ZJRF9GSVJfQ09FRlNfSDAsCisJCVtESVNQQ19WSURfRklSX0NPRUZf
SE9SSVpfVVZdID0gRElTUENfVklEX0ZJUl9DT0VGU19IMF9DLAorCQlbRElTUENfVklEX0ZJUl9D
T0VGX1ZFUlRdID0gRElTUENfVklEX0ZJUl9DT0VGU19WMCwKKwkJW0RJU1BDX1ZJRF9GSVJfQ09F
Rl9WRVJUX1VWXSA9IERJU1BDX1ZJRF9GSVJfQ09FRlNfVjBfQywKKwl9OworCisJc3RhdGljIGNv
bnN0IHUxNiBjMTJfcmVnc1tdID0geworCQlbRElTUENfVklEX0ZJUl9DT0VGX0hPUklaXSA9IERJ
U1BDX1ZJRF9GSVJfQ09FRlNfSDEyLAorCQlbRElTUENfVklEX0ZJUl9DT0VGX0hPUklaX1VWXSA9
IERJU1BDX1ZJRF9GSVJfQ09FRlNfSDEyX0MsCisJCVtESVNQQ19WSURfRklSX0NPRUZfVkVSVF0g
PSBESVNQQ19WSURfRklSX0NPRUZTX1YxMiwKKwkJW0RJU1BDX1ZJRF9GSVJfQ09FRl9WRVJUX1VW
XSA9IERJU1BDX1ZJRF9GSVJfQ09FRlNfVjEyX0MsCisJfTsKKworCWNvbnN0IHUxNiBjMF9iYXNl
ID0gYzBfcmVnc1tjb2VmX3NldF07CisJY29uc3QgdTE2IGMxMl9iYXNlID0gYzEyX3JlZ3NbY29l
Zl9zZXRdOworCWludCBwaGFzZTsKKworCWlmICghY29lZnMpIHsKKwkJZGV2X2VycihkaXNwYy0+
ZGV2LCAiJXM6IE5vIGNvZWZmaWNpZW50cyBnaXZlbi5cbiIsIF9fZnVuY19fKTsKKwkJcmV0dXJu
OworCX0KKworCWZvciAocGhhc2UgPSAwOyBwaGFzZSA8PSA4OyArK3BoYXNlKSB7CisJCXUxNiBy
ZWcgPSBjMF9iYXNlICsgcGhhc2UgKiA0OworCQl1MTYgYzAgPSBjb2Vmcy0+YzBbcGhhc2VdOwor
CisJCWRpc3BjX3ZpZF93cml0ZShkaXNwYywgaHdfcGxhbmUsIHJlZywgYzApOworCX0KKworCWZv
ciAocGhhc2UgPSAwOyBwaGFzZSA8PSAxNTsgKytwaGFzZSkgeworCQl1MTYgcmVnID0gYzEyX2Jh
c2UgKyBwaGFzZSAqIDQ7CisJCXMxNiBjMSwgYzI7CisJCXUzMiBjMTI7CisKKwkJYzEgPSBjb2Vm
cy0+YzFbcGhhc2VdOworCQljMiA9IGNvZWZzLT5jMltwaGFzZV07CisJCWMxMiA9IEZMRF9WQUwo
YzEsIDE5LCAxMCkgfCBGTERfVkFMKGMyLCAyOSwgMjApOworCisJCWRpc3BjX3ZpZF93cml0ZShk
aXNwYywgaHdfcGxhbmUsIHJlZywgYzEyKTsKKwl9Cit9CisKK3N0YXRpYyBib29sIGRpc3BjX2Zv
dXJjY19pc195dXYodTMyIGZvdXJjYykKK3sKKwlzd2l0Y2ggKGZvdXJjYykgeworCWNhc2UgRFJN
X0ZPUk1BVF9ZVVlWOgorCWNhc2UgRFJNX0ZPUk1BVF9VWVZZOgorCWNhc2UgRFJNX0ZPUk1BVF9O
VjEyOgorCQlyZXR1cm4gdHJ1ZTsKKwlkZWZhdWx0OgorCQlyZXR1cm4gZmFsc2U7CisJfQorfQor
CitzdHJ1Y3QgZGlzcGNfc2NhbGluZ19wYXJhbXMgeworCWludCB4aW5jLCB5aW5jOworCXUzMiBp
bl93LCBpbl9oLCBpbl93X3V2LCBpbl9oX3V2OworCXUzMiBmaXJfeGluYywgZmlyX3lpbmMsIGZp
cl94aW5jX3V2LCBmaXJfeWluY191djsKKwlib29sIHNjYWxlX3gsIHNjYWxlX3k7CisJY29uc3Qg
c3RydWN0IHRpZHNzX3NjYWxlX2NvZWZzICp4Y29lZiwgKnljb2VmLCAqeGNvZWZfdXYsICp5Y29l
Zl91djsKKwlib29sIGZpdmVfdGFwczsKK307CisKK3N0YXRpYyBpbnQgZGlzcGNfdmlkX2NhbGNf
c2NhbGluZyhzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYywKKwkJCQkgIGNvbnN0IHN0cnVjdCBk
cm1fcGxhbmVfc3RhdGUgKnN0YXRlLAorCQkJCSAgc3RydWN0IGRpc3BjX3NjYWxpbmdfcGFyYW1z
ICpzcCwKKwkJCQkgIGJvb2wgbGl0ZV9wbGFuZSkKK3sKKwljb25zdCBzdHJ1Y3QgZGlzcGNfZmVh
dHVyZXNfc2NhbGluZyAqZiA9ICZkaXNwYy0+ZmVhdC0+c2NhbGluZzsKKwl1MzIgZm91cmNjID0g
c3RhdGUtPmZiLT5mb3JtYXQtPmZvcm1hdDsKKwl1MzIgaW5fd2lkdGhfbWF4XzV0YXAgPSBmLT5p
bl93aWR0aF9tYXhfNXRhcF9yZ2I7CisJdTMyIGluX3dpZHRoX21heF8zdGFwID0gZi0+aW5fd2lk
dGhfbWF4XzN0YXBfcmdiOworCXUzMiBkb3duc2NhbGVfbGltaXQ7CisJdTMyIGluX3dpZHRoX21h
eDsKKworCW1lbXNldChzcCwgMCwgc2l6ZW9mKCpzcCkpOworCXNwLT54aW5jID0gc3AtPnlpbmMg
PSAxOworCXNwLT5pbl93ID0gc3AtPmluX3dfdXYgPSBzdGF0ZS0+c3JjX3cgPj4gMTY7CisJc3At
PmluX2ggPSBzcC0+aW5faF91diA9IHN0YXRlLT5zcmNfaCA+PiAxNjsKKworCXNwLT5zY2FsZV94
ID0gc3AtPmluX3cgIT0gc3RhdGUtPmNydGNfdzsKKwlzcC0+c2NhbGVfeSA9IHNwLT5pbl9oICE9
IHN0YXRlLT5jcnRjX2g7CisKKwlpZiAoZGlzcGNfZm91cmNjX2lzX3l1dihmb3VyY2MpKSB7CisJ
CWluX3dpZHRoX21heF81dGFwID0gZi0+aW5fd2lkdGhfbWF4XzV0YXBfeXV2OworCQlpbl93aWR0
aF9tYXhfM3RhcCA9IGYtPmluX3dpZHRoX21heF8zdGFwX3l1djsKKworCQlzcC0+aW5fd191diA+
Pj0gMTsKKwkJc3AtPnNjYWxlX3ggPSB0cnVlOworCisJCWlmIChmb3VyY2MgPT0gRFJNX0ZPUk1B
VF9OVjEyKSB7CisJCQlzcC0+aW5faF91diA+Pj0gMTsKKwkJCXNwLT5zY2FsZV95ID0gdHJ1ZTsK
KwkJfQorCX0KKworCS8qIFNraXAgdGhlIHJlc3QgaWYgbm8gc2NhbGluZyBpcyB1c2VkICovCisJ
aWYgKCghc3AtPnNjYWxlX3ggJiYgIXNwLT5zY2FsZV95KSB8fCBsaXRlX3BsYW5lKQorCQlyZXR1
cm4gMDsKKworCWlmIChzcC0+aW5fdyA+IGluX3dpZHRoX21heF81dGFwKSB7CisJCXNwLT5maXZl
X3RhcHMgPSBmYWxzZTsKKwkJaW5fd2lkdGhfbWF4ID0gaW5fd2lkdGhfbWF4XzN0YXA7CisJCWRv
d25zY2FsZV9saW1pdCA9IGYtPmRvd25zY2FsZV9saW1pdF8zdGFwOworCX0gZWxzZSB7CisJCXNw
LT5maXZlX3RhcHMgPSB0cnVlOworCQlpbl93aWR0aF9tYXggPSBpbl93aWR0aF9tYXhfNXRhcDsK
KwkJZG93bnNjYWxlX2xpbWl0ID0gZi0+ZG93bnNjYWxlX2xpbWl0XzV0YXA7CisJfQorCisJaWYg
KHNwLT5zY2FsZV94KSB7CisJCXNwLT5maXJfeGluYyA9IGRpc3BjX2NhbGNfZmlyX2luYyhzcC0+
aW5fdywgc3RhdGUtPmNydGNfdyk7CisKKwkJaWYgKHNwLT5maXJfeGluYyA8IGRpc3BjX2NhbGNf
ZmlyX2luYygxLCBmLT51cHNjYWxlX2xpbWl0KSkgeworCQkJZGV2X2RiZyhkaXNwYy0+ZGV2LAor
CQkJCSIlczogWC1zY2FsaW5nIGZhY3RvciAldS8ldSA+ICV1XG4iLAorCQkJCV9fZnVuY19fLCBz
dGF0ZS0+Y3J0Y193LCBzdGF0ZS0+c3JjX3cgPj4gMTYsCisJCQkJZi0+dXBzY2FsZV9saW1pdCk7
CisJCQlyZXR1cm4gLUVJTlZBTDsKKwkJfQorCisJCWlmIChzcC0+ZmlyX3hpbmMgPj0gZGlzcGNf
Y2FsY19maXJfaW5jKGRvd25zY2FsZV9saW1pdCwgMSkpIHsKKwkJCXNwLT54aW5jID0gRElWX1JP
VU5EX1VQKERJVl9ST1VORF9VUChzcC0+aW5fdywKKwkJCQkJCQkgICAgIHN0YXRlLT5jcnRjX3cp
LAorCQkJCQkJZG93bnNjYWxlX2xpbWl0KTsKKworCQkJaWYgKHNwLT54aW5jID4gZi0+eGluY19t
YXgpIHsKKwkJCQlkZXZfZGJnKGRpc3BjLT5kZXYsCisJCQkJCSIlczogWC1zY2FsaW5nIGZhY3Rv
ciAldS8ldSA8IDEvJXVcbiIsCisJCQkJCV9fZnVuY19fLCBzdGF0ZS0+Y3J0Y193LAorCQkJCQlz
dGF0ZS0+c3JjX3cgPj4gMTYsCisJCQkJCWRvd25zY2FsZV9saW1pdCAqIGYtPnhpbmNfbWF4KTsK
KwkJCQlyZXR1cm4gLUVJTlZBTDsKKwkJCX0KKworCQkJc3AtPmluX3cgPSAoc3RhdGUtPnNyY193
ID4+IDE2KSAvIHNwLT54aW5jOworCQl9CisKKwkJd2hpbGUgKHNwLT5pbl93ID4gaW5fd2lkdGhf
bWF4KSB7CisJCQlzcC0+eGluYysrOworCQkJc3AtPmluX3cgPSAoc3RhdGUtPnNyY193ID4+IDE2
KSAvIHNwLT54aW5jOworCQl9CisKKwkJaWYgKHNwLT54aW5jID4gZi0+eGluY19tYXgpIHsKKwkJ
CWRldl9kYmcoZGlzcGMtPmRldiwKKwkJCQkiJXM6IFRvbyB3aWRlIGlucHV0IGJ1ZmVyICV1ID4g
JXVcbiIsIF9fZnVuY19fLAorCQkJCXN0YXRlLT5zcmNfdyA+PiAxNiwgaW5fd2lkdGhfbWF4ICog
Zi0+eGluY19tYXgpOworCQkJcmV0dXJuIC1FSU5WQUw7CisJCX0KKworCQkvKgorCQkgKiBXZSBu
ZWVkIGV2ZW4gbGluZSBsZW5ndGggZm9yIFlVViBmb3JtYXRzLiBEZWNpbWF0aW9uCisJCSAqIGNh
biBsZWFkIHRvIG9kZCBsZW5ndGgsIHNvIHdlIG5lZWQgdG8gbWFrZSBpdCBldmVuCisJCSAqIGFn
YWluLgorCQkgKi8KKwkJaWYgKGRpc3BjX2ZvdXJjY19pc195dXYoZm91cmNjKSkKKwkJCXNwLT5p
bl93ICY9IH4xOworCisJCXNwLT5maXJfeGluYyA9IGRpc3BjX2NhbGNfZmlyX2luYyhzcC0+aW5f
dywgc3RhdGUtPmNydGNfdyk7CisJfQorCisJaWYgKHNwLT5zY2FsZV95KSB7CisJCXNwLT5maXJf
eWluYyA9IGRpc3BjX2NhbGNfZmlyX2luYyhzcC0+aW5faCwgc3RhdGUtPmNydGNfaCk7CisKKwkJ
aWYgKHNwLT5maXJfeWluYyA8IGRpc3BjX2NhbGNfZmlyX2luYygxLCBmLT51cHNjYWxlX2xpbWl0
KSkgeworCQkJZGV2X2RiZyhkaXNwYy0+ZGV2LAorCQkJCSIlczogWS1zY2FsaW5nIGZhY3RvciAl
dS8ldSA+ICV1XG4iLAorCQkJCV9fZnVuY19fLCBzdGF0ZS0+Y3J0Y19oLCBzdGF0ZS0+c3JjX2gg
Pj4gMTYsCisJCQkJZi0+dXBzY2FsZV9saW1pdCk7CisJCQlyZXR1cm4gLUVJTlZBTDsKKwkJfQor
CisJCWlmIChzcC0+ZmlyX3lpbmMgPj0gZGlzcGNfY2FsY19maXJfaW5jKGRvd25zY2FsZV9saW1p
dCwgMSkpIHsKKwkJCXNwLT55aW5jID0gRElWX1JPVU5EX1VQKERJVl9ST1VORF9VUChzcC0+aW5f
aCwKKwkJCQkJCQkgICAgIHN0YXRlLT5jcnRjX2gpLAorCQkJCQkJZG93bnNjYWxlX2xpbWl0KTsK
KworCQkJc3AtPmluX2ggLz0gc3AtPnlpbmM7CisJCQlzcC0+ZmlyX3lpbmMgPSBkaXNwY19jYWxj
X2Zpcl9pbmMoc3AtPmluX2gsCisJCQkJCQkJICBzdGF0ZS0+Y3J0Y19oKTsKKwkJfQorCX0KKwor
CWRldl9kYmcoZGlzcGMtPmRldiwKKwkJIiVzOiAldXgldSBkZWNpbSAldXgldSAtPiAldXgldSBm
aXJpbmMgJXUuJTAzdXgldS4lMDN1IHRhcHMgJXUgLT4gJXV4JXVcbiIsCisJCV9fZnVuY19fLCBz
dGF0ZS0+c3JjX3cgPj4gMTYsIHN0YXRlLT5zcmNfaCA+PiAxNiwKKwkJc3AtPnhpbmMsIHNwLT55
aW5jLCBzcC0+aW5fdywgc3AtPmluX2gsCisJCXNwLT5maXJfeGluYyAvIDB4MjAwMDAwdSwKKwkJ
KChzcC0+ZmlyX3hpbmMgJiAweDFGRkZGRnUpICogOTk5dSkgLyAweDFGRkZGRnUsCisJCXNwLT5m
aXJfeWluYyAvIDB4MjAwMDAwdSwKKwkJKChzcC0+ZmlyX3lpbmMgJiAweDFGRkZGRnUpICogOTk5
dSkgLyAweDFGRkZGRnUsCisJCXNwLT5maXZlX3RhcHMgPyA1IDogMywKKwkJc3RhdGUtPmNydGNf
dywgc3RhdGUtPmNydGNfaCk7CisKKwlpZiAoZGlzcGNfZm91cmNjX2lzX3l1dihmb3VyY2MpKSB7
CisJCWlmIChzcC0+c2NhbGVfeCkgeworCQkJc3AtPmluX3dfdXYgLz0gc3AtPnhpbmM7CisJCQlz
cC0+ZmlyX3hpbmNfdXYgPSBkaXNwY19jYWxjX2Zpcl9pbmMoc3AtPmluX3dfdXYsCisJCQkJCQkJ
ICAgICBzdGF0ZS0+Y3J0Y193KTsKKwkJCXNwLT54Y29lZl91diA9IHRpZHNzX2dldF9zY2FsZV9j
b2VmcyhkaXNwYy0+ZGV2LAorCQkJCQkJCSAgICAgc3AtPmZpcl94aW5jX3V2LAorCQkJCQkJCSAg
ICAgdHJ1ZSk7CisJCX0KKwkJaWYgKHNwLT5zY2FsZV95KSB7CisJCQlzcC0+aW5faF91diAvPSBz
cC0+eWluYzsKKwkJCXNwLT5maXJfeWluY191diA9IGRpc3BjX2NhbGNfZmlyX2luYyhzcC0+aW5f
aF91diwKKwkJCQkJCQkgICAgIHN0YXRlLT5jcnRjX2gpOworCQkJc3AtPnljb2VmX3V2ID0gdGlk
c3NfZ2V0X3NjYWxlX2NvZWZzKGRpc3BjLT5kZXYsCisJCQkJCQkJICAgICBzcC0+ZmlyX3lpbmNf
dXYsCisJCQkJCQkJICAgICBzcC0+Zml2ZV90YXBzKTsKKwkJfQorCX0KKworCWlmIChzcC0+c2Nh
bGVfeCkKKwkJc3AtPnhjb2VmID0gdGlkc3NfZ2V0X3NjYWxlX2NvZWZzKGRpc3BjLT5kZXYsIHNw
LT5maXJfeGluYywKKwkJCQkJCSAgdHJ1ZSk7CisKKwlpZiAoc3AtPnNjYWxlX3kpCisJCXNwLT55
Y29lZiA9IHRpZHNzX2dldF9zY2FsZV9jb2VmcyhkaXNwYy0+ZGV2LCBzcC0+ZmlyX3lpbmMsCisJ
CQkJCQkgIHNwLT5maXZlX3RhcHMpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGRp
c3BjX3ZpZF9zZXRfc2NhbGluZyhzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYywKKwkJCQkgIHUz
MiBod19wbGFuZSwKKwkJCQkgIHN0cnVjdCBkaXNwY19zY2FsaW5nX3BhcmFtcyAqc3AsCisJCQkJ
ICB1MzIgZm91cmNjKQoreworCS8qIEhPUklaT05UQUwgUkVTSVpFIEVOQUJMRSAqLworCVZJRF9S
RUdfRkxEX01PRChkaXNwYywgaHdfcGxhbmUsIERJU1BDX1ZJRF9BVFRSSUJVVEVTLAorCQkJc3At
PnNjYWxlX3gsIDcsIDcpOworCisJLyogVkVSVElDQUwgUkVTSVpFIEVOQUJMRSAqLworCVZJRF9S
RUdfRkxEX01PRChkaXNwYywgaHdfcGxhbmUsIERJU1BDX1ZJRF9BVFRSSUJVVEVTLAorCQkJc3At
PnNjYWxlX3ksIDgsIDgpOworCisJLyogU2tpcCB0aGUgcmVzdCBpZiBubyBzY2FsaW5nIGlzIHVz
ZWQgKi8KKwlpZiAoIXNwLT5zY2FsZV94ICYmICFzcC0+c2NhbGVfeSkKKwkJcmV0dXJuOworCisJ
LyogVkVSVElDQUwgNS1UQVBTICAqLworCVZJRF9SRUdfRkxEX01PRChkaXNwYywgaHdfcGxhbmUs
IERJU1BDX1ZJRF9BVFRSSUJVVEVTLAorCQkJc3AtPmZpdmVfdGFwcywgMjEsIDIxKTsKKworCWlm
IChkaXNwY19mb3VyY2NfaXNfeXV2KGZvdXJjYykpIHsKKwkJaWYgKHNwLT5zY2FsZV94KSB7CisJ
CQlkaXNwY192aWRfd3JpdGUoZGlzcGMsIGh3X3BsYW5lLCBESVNQQ19WSURfRklSSDIsCisJCQkJ
CXNwLT5maXJfeGluY191dik7CisJCQlkaXNwY192aWRfd3JpdGVfZmlyX2NvZWZzKGRpc3BjLCBo
d19wbGFuZSwKKwkJCQkJCSAgRElTUENfVklEX0ZJUl9DT0VGX0hPUklaX1VWLAorCQkJCQkJICBz
cC0+eGNvZWZfdXYpOworCQl9CisJCWlmIChzcC0+c2NhbGVfeSkgeworCQkJZGlzcGNfdmlkX3dy
aXRlKGRpc3BjLCBod19wbGFuZSwgRElTUENfVklEX0ZJUlYyLAorCQkJCQlzcC0+ZmlyX3lpbmNf
dXYpOworCQkJZGlzcGNfdmlkX3dyaXRlX2Zpcl9jb2VmcyhkaXNwYywgaHdfcGxhbmUsCisJCQkJ
CQkgIERJU1BDX1ZJRF9GSVJfQ09FRl9WRVJUX1VWLAorCQkJCQkJICBzcC0+eWNvZWZfdXYpOwor
CQl9CisJfQorCisJaWYgKHNwLT5zY2FsZV94KSB7CisJCWRpc3BjX3ZpZF93cml0ZShkaXNwYywg
aHdfcGxhbmUsIERJU1BDX1ZJRF9GSVJILCBzcC0+ZmlyX3hpbmMpOworCQlkaXNwY192aWRfd3Jp
dGVfZmlyX2NvZWZzKGRpc3BjLCBod19wbGFuZSwKKwkJCQkJICBESVNQQ19WSURfRklSX0NPRUZf
SE9SSVosCisJCQkJCSAgc3AtPnhjb2VmKTsKKwl9CisKKwlpZiAoc3AtPnNjYWxlX3kpIHsKKwkJ
ZGlzcGNfdmlkX3dyaXRlKGRpc3BjLCBod19wbGFuZSwgRElTUENfVklEX0ZJUlYsIHNwLT5maXJf
eWluYyk7CisJCWRpc3BjX3ZpZF93cml0ZV9maXJfY29lZnMoZGlzcGMsIGh3X3BsYW5lLAorCQkJ
CQkgIERJU1BDX1ZJRF9GSVJfQ09FRl9WRVJULCBzcC0+eWNvZWYpOworCX0KK30KKworLyogT1RI
RVIgKi8KKworc3RhdGljIGNvbnN0IHN0cnVjdCB7CisJdTMyIGZvdXJjYzsKKwl1OCBkc3NfY29k
ZTsKK30gZGlzcGNfY29sb3JfZm9ybWF0c1tdID0geworCXsgRFJNX0ZPUk1BVF9BUkdCNDQ0NCwg
MHgwLCB9LAorCXsgRFJNX0ZPUk1BVF9BQkdSNDQ0NCwgMHgxLCB9LAorCXsgRFJNX0ZPUk1BVF9S
R0JBNDQ0NCwgMHgyLCB9LAorCisJeyBEUk1fRk9STUFUX1JHQjU2NSwgMHgzLCB9LAorCXsgRFJN
X0ZPUk1BVF9CR1I1NjUsIDB4NCwgfSwKKworCXsgRFJNX0ZPUk1BVF9BUkdCMTU1NSwgMHg1LCB9
LAorCXsgRFJNX0ZPUk1BVF9BQkdSMTU1NSwgMHg2LCB9LAorCisJeyBEUk1fRk9STUFUX0FSR0I4
ODg4LCAweDcsIH0sCisJeyBEUk1fRk9STUFUX0FCR1I4ODg4LCAweDgsIH0sCisJeyBEUk1fRk9S
TUFUX1JHQkE4ODg4LCAweDksIH0sCisJeyBEUk1fRk9STUFUX0JHUkE4ODg4LCAweGEsIH0sCisK
Kwl7IERSTV9GT1JNQVRfUkdCODg4LCAweGIsIH0sCisJeyBEUk1fRk9STUFUX0JHUjg4OCwgMHhj
LCB9LAorCisJeyBEUk1fRk9STUFUX0FSR0IyMTAxMDEwLCAweGUsIH0sCisJeyBEUk1fRk9STUFU
X0FCR1IyMTAxMDEwLCAweGYsIH0sCisKKwl7IERSTV9GT1JNQVRfWFJHQjQ0NDQsIDB4MjAsIH0s
CisJeyBEUk1fRk9STUFUX1hCR1I0NDQ0LCAweDIxLCB9LAorCXsgRFJNX0ZPUk1BVF9SR0JYNDQ0
NCwgMHgyMiwgfSwKKworCXsgRFJNX0ZPUk1BVF9BUkdCMTU1NSwgMHgyNSwgfSwKKwl7IERSTV9G
T1JNQVRfQUJHUjE1NTUsIDB4MjYsIH0sCisKKwl7IERSTV9GT1JNQVRfWFJHQjg4ODgsIDB4Mjcs
IH0sCisJeyBEUk1fRk9STUFUX1hCR1I4ODg4LCAweDI4LCB9LAorCXsgRFJNX0ZPUk1BVF9SR0JY
ODg4OCwgMHgyOSwgfSwKKwl7IERSTV9GT1JNQVRfQkdSWDg4ODgsIDB4MmEsIH0sCisKKwl7IERS
TV9GT1JNQVRfWFJHQjIxMDEwMTAsIDB4MmUsIH0sCisJeyBEUk1fRk9STUFUX1hCR1IyMTAxMDEw
LCAweDJmLCB9LAorCisJeyBEUk1fRk9STUFUX1lVWVYsIDB4M2UsIH0sCisJeyBEUk1fRk9STUFU
X1VZVlksIDB4M2YsIH0sCisKKwl7IERSTV9GT1JNQVRfTlYxMiwgMHgzZCwgfSwKK307CisKK3N0
YXRpYyB2b2lkIGRpc3BjX3BsYW5lX3NldF9waXhlbF9mb3JtYXQoc3RydWN0IGRpc3BjX2Rldmlj
ZSAqZGlzcGMsCisJCQkJCSB1MzIgaHdfcGxhbmUsIHUzMiBmb3VyY2MpCit7CisJdW5zaWduZWQg
aW50IGk7CisKKwlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShkaXNwY19jb2xvcl9mb3JtYXRz
KTsgKytpKSB7CisJCWlmIChkaXNwY19jb2xvcl9mb3JtYXRzW2ldLmZvdXJjYyA9PSBmb3VyY2Mp
IHsKKwkJCVZJRF9SRUdfRkxEX01PRChkaXNwYywgaHdfcGxhbmUsIERJU1BDX1ZJRF9BVFRSSUJV
VEVTLAorCQkJCQlkaXNwY19jb2xvcl9mb3JtYXRzW2ldLmRzc19jb2RlLAorCQkJCQk2LCAxKTsK
KwkJCXJldHVybjsKKwkJfQorCX0KKworCVdBUk5fT04oMSk7Cit9CisKK2NvbnN0IHUzMiAqZGlz
cGNfcGxhbmVfZm9ybWF0cyhzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYywgdW5zaWduZWQgaW50
ICpsZW4pCit7CisJV0FSTl9PTighZGlzcGMtPmZvdXJjY3MpOworCisJKmxlbiA9IGRpc3BjLT5u
dW1fZm91cmNjczsKKworCXJldHVybiBkaXNwYy0+Zm91cmNjczsKK30KKworc3RhdGljIHMzMiBw
aXhpbmMoaW50IHBpeGVscywgdTggcHMpCit7CisJaWYgKHBpeGVscyA9PSAxKQorCQlyZXR1cm4g
MTsKKwllbHNlIGlmIChwaXhlbHMgPiAxKQorCQlyZXR1cm4gMSArIChwaXhlbHMgLSAxKSAqIHBz
OworCWVsc2UgaWYgKHBpeGVscyA8IDApCisJCXJldHVybiAxIC0gKC1waXhlbHMgKyAxKSAqIHBz
OworCisJV0FSTl9PTigxKTsKKwlyZXR1cm4gMDsKK30KKworaW50IGRpc3BjX3BsYW5lX2NoZWNr
KHN0cnVjdCBkaXNwY19kZXZpY2UgKmRpc3BjLCB1MzIgaHdfcGxhbmUsCisJCSAgICAgIGNvbnN0
IHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnN0YXRlLAorCQkgICAgICB1MzIgaHdfdmlkZW9wb3J0
KQoreworCWJvb2wgbGl0ZSA9IGRpc3BjLT5mZWF0LT52aWRfbGl0ZVtod19wbGFuZV07CisJdTMy
IGZvdXJjYyA9IHN0YXRlLT5mYi0+Zm9ybWF0LT5mb3JtYXQ7CisJYm9vbCBuZWVkX3NjYWxpbmcg
PSBzdGF0ZS0+c3JjX3cgPj4gMTYgIT0gc3RhdGUtPmNydGNfdyB8fAorCQlzdGF0ZS0+c3JjX2gg
Pj4gMTYgIT0gc3RhdGUtPmNydGNfaDsKKwlzdHJ1Y3QgZGlzcGNfc2NhbGluZ19wYXJhbXMgc2Nh
bGluZzsKKwlpbnQgcmV0OworCisJaWYgKGRpc3BjX2ZvdXJjY19pc195dXYoZm91cmNjKSkgewor
CQlpZiAoIWRpc3BjX2ZpbmRfY3NjKHN0YXRlLT5jb2xvcl9lbmNvZGluZywKKwkJCQkgICAgc3Rh
dGUtPmNvbG9yX3JhbmdlKSkgeworCQkJZGV2X2RiZyhkaXNwYy0+ZGV2LAorCQkJCSIlczogVW5z
dXBwb3J0ZWQgQ1NDICgldSwldSkgZm9yIEhXIHBsYW5lICV1XG4iLAorCQkJCV9fZnVuY19fLCBz
dGF0ZS0+Y29sb3JfZW5jb2RpbmcsCisJCQkJc3RhdGUtPmNvbG9yX3JhbmdlLCBod19wbGFuZSk7
CisJCQlyZXR1cm4gLUVJTlZBTDsKKwkJfQorCX0KKworCWlmIChuZWVkX3NjYWxpbmcpIHsKKwkJ
aWYgKGxpdGUpIHsKKwkJCWRldl9kYmcoZGlzcGMtPmRldiwKKwkJCQkiJXM6IExpdGUgcGxhbmUg
JXUgY2FuJ3Qgc2NhbGUgJXV4JXUhPSV1eCV1XG4iLAorCQkJCV9fZnVuY19fLCBod19wbGFuZSwK
KwkJCQlzdGF0ZS0+c3JjX3cgPj4gMTYsIHN0YXRlLT5zcmNfaCA+PiAxNiwKKwkJCQlzdGF0ZS0+
Y3J0Y193LCBzdGF0ZS0+Y3J0Y19oKTsKKwkJCXJldHVybiAtRUlOVkFMOworCQl9CisJCXJldCA9
IGRpc3BjX3ZpZF9jYWxjX3NjYWxpbmcoZGlzcGMsIHN0YXRlLCAmc2NhbGluZywgZmFsc2UpOwor
CQlpZiAocmV0KQorCQkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGlj
CitkbWFfYWRkcl90IGRpc3BjX3BsYW5lX3N0YXRlX3BhZGRyKGNvbnN0IHN0cnVjdCBkcm1fcGxh
bmVfc3RhdGUgKnN0YXRlKQoreworCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gc3RhdGUt
PmZiOworCXN0cnVjdCBkcm1fZ2VtX2NtYV9vYmplY3QgKmdlbTsKKwl1MzIgeCA9IHN0YXRlLT5z
cmNfeCA+PiAxNjsKKwl1MzIgeSA9IHN0YXRlLT5zcmNfeSA+PiAxNjsKKworCWdlbSA9IGRybV9m
Yl9jbWFfZ2V0X2dlbV9vYmooc3RhdGUtPmZiLCAwKTsKKworCXJldHVybiBnZW0tPnBhZGRyICsg
ZmItPm9mZnNldHNbMF0gKyB4ICogZmItPmZvcm1hdC0+Y3BwWzBdICsKKwkJeSAqIGZiLT5waXRj
aGVzWzBdOworfQorCitzdGF0aWMKK2RtYV9hZGRyX3QgZGlzcGNfcGxhbmVfc3RhdGVfcF91dl9h
ZGRyKGNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnN0YXRlKQoreworCXN0cnVjdCBkcm1f
ZnJhbWVidWZmZXIgKmZiID0gc3RhdGUtPmZiOworCXN0cnVjdCBkcm1fZ2VtX2NtYV9vYmplY3Qg
KmdlbTsKKwl1MzIgeCA9IHN0YXRlLT5zcmNfeCA+PiAxNjsKKwl1MzIgeSA9IHN0YXRlLT5zcmNf
eSA+PiAxNjsKKworCWlmIChXQVJOX09OKHN0YXRlLT5mYi0+Zm9ybWF0LT5udW1fcGxhbmVzICE9
IDIpKQorCQlyZXR1cm4gMDsKKworCWdlbSA9IGRybV9mYl9jbWFfZ2V0X2dlbV9vYmooZmIsIDEp
OworCisJcmV0dXJuIGdlbS0+cGFkZHIgKyBmYi0+b2Zmc2V0c1sxXSArCisJCSh4ICogZmItPmZv
cm1hdC0+Y3BwWzFdIC8gZmItPmZvcm1hdC0+aHN1YikgKworCQkoeSAqIGZiLT5waXRjaGVzWzFd
IC8gZmItPmZvcm1hdC0+dnN1Yik7Cit9CisKK2ludCBkaXNwY19wbGFuZV9zZXR1cChzdHJ1Y3Qg
ZGlzcGNfZGV2aWNlICpkaXNwYywgdTMyIGh3X3BsYW5lLAorCQkgICAgICBjb25zdCBzdHJ1Y3Qg
ZHJtX3BsYW5lX3N0YXRlICpzdGF0ZSwKKwkJICAgICAgdTMyIGh3X3ZpZGVvcG9ydCkKK3sKKwli
b29sIGxpdGUgPSBkaXNwYy0+ZmVhdC0+dmlkX2xpdGVbaHdfcGxhbmVdOworCXUzMiBmb3VyY2Mg
PSBzdGF0ZS0+ZmItPmZvcm1hdC0+Zm9ybWF0OworCXUxNiBjcHAgPSBzdGF0ZS0+ZmItPmZvcm1h
dC0+Y3BwWzBdOworCXUzMiBmYl93aWR0aCA9IHN0YXRlLT5mYi0+cGl0Y2hlc1swXSAvIGNwcDsK
KwlkbWFfYWRkcl90IHBhZGRyID0gZGlzcGNfcGxhbmVfc3RhdGVfcGFkZHIoc3RhdGUpOworCXN0
cnVjdCBkaXNwY19zY2FsaW5nX3BhcmFtcyBzY2FsZTsKKworCWRpc3BjX3ZpZF9jYWxjX3NjYWxp
bmcoZGlzcGMsIHN0YXRlLCAmc2NhbGUsIGxpdGUpOworCisJZGlzcGNfcGxhbmVfc2V0X3BpeGVs
X2Zvcm1hdChkaXNwYywgaHdfcGxhbmUsIGZvdXJjYyk7CisKKwlkaXNwY192aWRfd3JpdGUoZGlz
cGMsIGh3X3BsYW5lLCBESVNQQ19WSURfQkFfMCwgcGFkZHIgJiAweGZmZmZmZmZmKTsKKwlkaXNw
Y192aWRfd3JpdGUoZGlzcGMsIGh3X3BsYW5lLCBESVNQQ19WSURfQkFfRVhUXzAsICh1NjQpcGFk
ZHIgPj4gMzIpOworCWRpc3BjX3ZpZF93cml0ZShkaXNwYywgaHdfcGxhbmUsIERJU1BDX1ZJRF9C
QV8xLCBwYWRkciAmIDB4ZmZmZmZmZmYpOworCWRpc3BjX3ZpZF93cml0ZShkaXNwYywgaHdfcGxh
bmUsIERJU1BDX1ZJRF9CQV9FWFRfMSwgKHU2NClwYWRkciA+PiAzMik7CisKKwlkaXNwY192aWRf
d3JpdGUoZGlzcGMsIGh3X3BsYW5lLCBESVNQQ19WSURfUElDVFVSRV9TSVpFLAorCQkJKHNjYWxl
LmluX3cgLSAxKSB8ICgoc2NhbGUuaW5faCAtIDEpIDw8IDE2KSk7CisKKwkvKiBGb3IgWVVWNDIy
IGZvcm1hdCB3ZSB1c2UgdGhlIG1hY3JvcGl4ZWwgc2l6ZSBmb3IgcGl4ZWwgaW5jICovCisJaWYg
KGZvdXJjYyA9PSBEUk1fRk9STUFUX1lVWVYgfHwgZm91cmNjID09IERSTV9GT1JNQVRfVVlWWSkK
KwkJZGlzcGNfdmlkX3dyaXRlKGRpc3BjLCBod19wbGFuZSwgRElTUENfVklEX1BJWEVMX0lOQywK
KwkJCQlwaXhpbmMoc2NhbGUueGluYywgY3BwICogMikpOworCWVsc2UKKwkJZGlzcGNfdmlkX3dy
aXRlKGRpc3BjLCBod19wbGFuZSwgRElTUENfVklEX1BJWEVMX0lOQywKKwkJCQlwaXhpbmMoc2Nh
bGUueGluYywgY3BwKSk7CisKKwlkaXNwY192aWRfd3JpdGUoZGlzcGMsIGh3X3BsYW5lLCBESVNQ
Q19WSURfUk9XX0lOQywKKwkJCXBpeGluYygxICsgKHNjYWxlLnlpbmMgKiBmYl93aWR0aCAtCisJ
CQkJICAgIHNjYWxlLnhpbmMgKiBzY2FsZS5pbl93KSwKKwkJCSAgICAgICBjcHApKTsKKworCWlm
IChzdGF0ZS0+ZmItPmZvcm1hdC0+bnVtX3BsYW5lcyA9PSAyKSB7CisJCXUxNiBjcHBfdXYgPSBz
dGF0ZS0+ZmItPmZvcm1hdC0+Y3BwWzFdOworCQl1MzIgZmJfd2lkdGhfdXYgPSBzdGF0ZS0+ZmIt
PnBpdGNoZXNbMV0gLyBjcHBfdXY7CisJCWRtYV9hZGRyX3QgcF91dl9hZGRyID0gZGlzcGNfcGxh
bmVfc3RhdGVfcF91dl9hZGRyKHN0YXRlKTsKKworCQlkaXNwY192aWRfd3JpdGUoZGlzcGMsIGh3
X3BsYW5lLAorCQkJCURJU1BDX1ZJRF9CQV9VVl8wLCBwX3V2X2FkZHIgJiAweGZmZmZmZmZmKTsK
KwkJZGlzcGNfdmlkX3dyaXRlKGRpc3BjLCBod19wbGFuZSwKKwkJCQlESVNQQ19WSURfQkFfVVZf
RVhUXzAsICh1NjQpcF91dl9hZGRyID4+IDMyKTsKKwkJZGlzcGNfdmlkX3dyaXRlKGRpc3BjLCBo
d19wbGFuZSwKKwkJCQlESVNQQ19WSURfQkFfVVZfMSwgcF91dl9hZGRyICYgMHhmZmZmZmZmZik7
CisJCWRpc3BjX3ZpZF93cml0ZShkaXNwYywgaHdfcGxhbmUsCisJCQkJRElTUENfVklEX0JBX1VW
X0VYVF8xLCAodTY0KXBfdXZfYWRkciA+PiAzMik7CisKKwkJZGlzcGNfdmlkX3dyaXRlKGRpc3Bj
LCBod19wbGFuZSwgRElTUENfVklEX1JPV19JTkNfVVYsCisJCQkJcGl4aW5jKDEgKyAoc2NhbGUu
eWluYyAqIGZiX3dpZHRoX3V2IC0KKwkJCQkJICAgIHNjYWxlLnhpbmMgKiBzY2FsZS5pbl93X3V2
KSwKKwkJCQkgICAgICAgY3BwX3V2KSk7CisJfQorCisJaWYgKCFsaXRlKSB7CisJCWRpc3BjX3Zp
ZF93cml0ZShkaXNwYywgaHdfcGxhbmUsIERJU1BDX1ZJRF9TSVpFLAorCQkJCShzdGF0ZS0+Y3J0
Y193IC0gMSkgfAorCQkJCSgoc3RhdGUtPmNydGNfaCAtIDEpIDw8IDE2KSk7CisKKwkJZGlzcGNf
dmlkX3NldF9zY2FsaW5nKGRpc3BjLCBod19wbGFuZSwgJnNjYWxlLCBmb3VyY2MpOworCX0KKwor
CS8qIGVuYWJsZSBZVVYtPlJHQiBjb2xvciBjb252ZXJzaW9uICovCisJaWYgKGRpc3BjX2ZvdXJj
Y19pc195dXYoZm91cmNjKSkgeworCQlkaXNwY192aWRfY3NjX3NldHVwKGRpc3BjLCBod19wbGFu
ZSwgc3RhdGUpOworCQlkaXNwY192aWRfY3NjX2VuYWJsZShkaXNwYywgaHdfcGxhbmUsIHRydWUp
OworCX0gZWxzZSB7CisJCWRpc3BjX3ZpZF9jc2NfZW5hYmxlKGRpc3BjLCBod19wbGFuZSwgZmFs
c2UpOworCX0KKworCWRpc3BjX3ZpZF93cml0ZShkaXNwYywgaHdfcGxhbmUsIERJU1BDX1ZJRF9H
TE9CQUxfQUxQSEEsCisJCQkweEZGICYgKHN0YXRlLT5hbHBoYSA+PiA4KSk7CisKKwlpZiAoc3Rh
dGUtPnBpeGVsX2JsZW5kX21vZGUgPT0gRFJNX01PREVfQkxFTkRfUFJFTVVMVEkpCisJCVZJRF9S
RUdfRkxEX01PRChkaXNwYywgaHdfcGxhbmUsIERJU1BDX1ZJRF9BVFRSSUJVVEVTLCAxLCAyOCwg
MjgpOworCWVsc2UKKwkJVklEX1JFR19GTERfTU9EKGRpc3BjLCBod19wbGFuZSwgRElTUENfVklE
X0FUVFJJQlVURVMsIDAsIDI4LCAyOCk7CisKKwlkaXNwY19vdnJfc2V0X3BsYW5lKGRpc3BjLCBo
d19wbGFuZSwgaHdfdmlkZW9wb3J0LAorCQkJICAgIHN0YXRlLT5jcnRjX3gsIHN0YXRlLT5jcnRj
X3ksCisJCQkgICAgc3RhdGUtPm5vcm1hbGl6ZWRfenBvcyk7CisKKwlkaXNwYy0+cGxhbmVfZGF0
YVtod19wbGFuZV0uem9yZGVyID0gc3RhdGUtPm5vcm1hbGl6ZWRfenBvczsKKwlkaXNwYy0+cGxh
bmVfZGF0YVtod19wbGFuZV0uaHdfdmlkZW9wb3J0ID0gaHdfdmlkZW9wb3J0OworCisJcmV0dXJu
IDA7Cit9CisKK2ludCBkaXNwY19wbGFuZV9lbmFibGUoc3RydWN0IGRpc3BjX2RldmljZSAqZGlz
cGMsIHUzMiBod19wbGFuZSwgYm9vbCBlbmFibGUpCit7CisJZGlzcGNfb3ZyX2VuYWJsZV9wbGFu
ZShkaXNwYywgZGlzcGMtPnBsYW5lX2RhdGFbaHdfcGxhbmVdLmh3X3ZpZGVvcG9ydCwKKwkJCSAg
ICAgICBkaXNwYy0+cGxhbmVfZGF0YVtod19wbGFuZV0uem9yZGVyLCBlbmFibGUpOworCisJVklE
X1JFR19GTERfTU9EKGRpc3BjLCBod19wbGFuZSwgRElTUENfVklEX0FUVFJJQlVURVMsICEhZW5h
YmxlLCAwLCAwKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdTMyIGRpc3BjX3ZpZF9nZXRf
Zmlmb19zaXplKHN0cnVjdCBkaXNwY19kZXZpY2UgKmRpc3BjLCB1MzIgaHdfcGxhbmUpCit7CisJ
cmV0dXJuIFZJRF9SRUdfR0VUKGRpc3BjLCBod19wbGFuZSwgRElTUENfVklEX0JVRl9TSVpFX1NU
QVRVUywgMTUsIDApOworfQorCitzdGF0aWMgdm9pZCBkaXNwY192aWRfc2V0X21mbGFnX3RocmVz
aG9sZChzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYywKKwkJCQkJICB1MzIgaHdfcGxhbmUsIHUz
MiBsb3csIHUzMiBoaWdoKQoreworCWRpc3BjX3ZpZF93cml0ZShkaXNwYywgaHdfcGxhbmUsIERJ
U1BDX1ZJRF9NRkxBR19USFJFU0hPTEQsCisJCQlGTERfVkFMKGhpZ2gsIDMxLCAxNikgfCBGTERf
VkFMKGxvdywgMTUsIDApKTsKK30KKworc3RhdGljIHZvaWQgZGlzcGNfdmlkX3NldF9idWZfdGhy
ZXNob2xkKHN0cnVjdCBkaXNwY19kZXZpY2UgKmRpc3BjLAorCQkJCQl1MzIgaHdfcGxhbmUsIHUz
MiBsb3csIHUzMiBoaWdoKQoreworCWRpc3BjX3ZpZF93cml0ZShkaXNwYywgaHdfcGxhbmUsIERJ
U1BDX1ZJRF9CVUZfVEhSRVNIT0xELAorCQkJRkxEX1ZBTChoaWdoLCAzMSwgMTYpIHwgRkxEX1ZB
TChsb3csIDE1LCAwKSk7Cit9CisKK3N0YXRpYyB2b2lkIGRpc3BjX2syZ19wbGFuZV9pbml0KHN0
cnVjdCBkaXNwY19kZXZpY2UgKmRpc3BjKQoreworCXVuc2lnbmVkIGludCBod19wbGFuZTsKKwor
CWRldl9kYmcoZGlzcGMtPmRldiwgIiVzKClcbiIsIF9fZnVuY19fKTsKKworCS8qIE1GTEFHX0NU
UkwgPSBFTkFCTEVEICovCisJUkVHX0ZMRF9NT0QoZGlzcGMsIERJU1BDX0dMT0JBTF9NRkxBR19B
VFRSSUJVVEUsIDIsIDEsIDApOworCS8qIE1GTEFHX1NUQVJUID0gTUZMQUdOT1JNQUxTVEFSVE1P
REUgKi8KKwlSRUdfRkxEX01PRChkaXNwYywgRElTUENfR0xPQkFMX01GTEFHX0FUVFJJQlVURSwg
MCwgNiwgNik7CisKKwlmb3IgKGh3X3BsYW5lID0gMDsgaHdfcGxhbmUgPCBkaXNwYy0+ZmVhdC0+
bnVtX3BsYW5lczsgaHdfcGxhbmUrKykgeworCQl1MzIgc2l6ZSA9IGRpc3BjX3ZpZF9nZXRfZmlm
b19zaXplKGRpc3BjLCBod19wbGFuZSk7CisJCXUzMiB0aHJfbG93LCB0aHJfaGlnaDsKKwkJdTMy
IG1mbGFnX2xvdywgbWZsYWdfaGlnaDsKKwkJdTMyIHByZWxvYWQ7CisKKwkJdGhyX2hpZ2ggPSBz
aXplIC0gMTsKKwkJdGhyX2xvdyA9IHNpemUgLyAyOworCisJCW1mbGFnX2hpZ2ggPSBzaXplICog
MiAvIDM7CisJCW1mbGFnX2xvdyA9IHNpemUgLyAzOworCisJCXByZWxvYWQgPSB0aHJfbG93Owor
CisJCWRldl9kYmcoZGlzcGMtPmRldiwKKwkJCSIlczogYnVmc2l6ZSAldSwgYnVmX3RocmVzaG9s
ZCAldS8ldSwgbWZsYWcgdGhyZXNob2xkICV1LyV1IHByZWxvYWQgJXVcbiIsCisJCQlkaXNwYy0+
ZmVhdC0+dmlkX25hbWVbaHdfcGxhbmVdLAorCQkJc2l6ZSwKKwkJCXRocl9oaWdoLCB0aHJfbG93
LAorCQkJbWZsYWdfaGlnaCwgbWZsYWdfbG93LAorCQkJcHJlbG9hZCk7CisKKwkJZGlzcGNfdmlk
X3NldF9idWZfdGhyZXNob2xkKGRpc3BjLCBod19wbGFuZSwKKwkJCQkJICAgIHRocl9sb3csIHRo
cl9oaWdoKTsKKwkJZGlzcGNfdmlkX3NldF9tZmxhZ190aHJlc2hvbGQoZGlzcGMsIGh3X3BsYW5l
LAorCQkJCQkgICAgICBtZmxhZ19sb3csIG1mbGFnX2hpZ2gpOworCisJCWRpc3BjX3ZpZF93cml0
ZShkaXNwYywgaHdfcGxhbmUsIERJU1BDX1ZJRF9QUkVMT0FELCBwcmVsb2FkKTsKKworCQkvKiBQ
cmVmZWNoIHVwIHRvIFBSRUxPQUQgdmFsdWUgKi8KKwkJVklEX1JFR19GTERfTU9EKGRpc3BjLCBo
d19wbGFuZSwgRElTUENfVklEX0FUVFJJQlVURVMsIDAsIDE5LCAxOSk7CisJfQorfQorCitzdGF0
aWMgdm9pZCBkaXNwY19rM19wbGFuZV9pbml0KHN0cnVjdCBkaXNwY19kZXZpY2UgKmRpc3BjKQor
eworCXVuc2lnbmVkIGludCBod19wbGFuZTsKKwl1MzIgY2JhX2xvX3ByaSA9IDE7CisJdTMyIGNi
YV9oaV9wcmkgPSAwOworCisJZGV2X2RiZyhkaXNwYy0+ZGV2LCAiJXMoKVxuIiwgX19mdW5jX18p
OworCisJUkVHX0ZMRF9NT0QoZGlzcGMsIERTU19DQkFfQ0ZHLCBjYmFfbG9fcHJpLCAyLCAwKTsK
KwlSRUdfRkxEX01PRChkaXNwYywgRFNTX0NCQV9DRkcsIGNiYV9oaV9wcmksIDUsIDMpOworCisJ
LyogTUZMQUdfQ1RSTCA9IEVOQUJMRUQgKi8KKwlSRUdfRkxEX01PRChkaXNwYywgRElTUENfR0xP
QkFMX01GTEFHX0FUVFJJQlVURSwgMiwgMSwgMCk7CisJLyogTUZMQUdfU1RBUlQgPSBNRkxBR05P
Uk1BTFNUQVJUTU9ERSAqLworCVJFR19GTERfTU9EKGRpc3BjLCBESVNQQ19HTE9CQUxfTUZMQUdf
QVRUUklCVVRFLCAwLCA2LCA2KTsKKworCWZvciAoaHdfcGxhbmUgPSAwOyBod19wbGFuZSA8IGRp
c3BjLT5mZWF0LT5udW1fcGxhbmVzOyBod19wbGFuZSsrKSB7CisJCXUzMiBzaXplID0gZGlzcGNf
dmlkX2dldF9maWZvX3NpemUoZGlzcGMsIGh3X3BsYW5lKTsKKwkJdTMyIHRocl9sb3csIHRocl9o
aWdoOworCQl1MzIgbWZsYWdfbG93LCBtZmxhZ19oaWdoOworCQl1MzIgcHJlbG9hZDsKKworCQl0
aHJfaGlnaCA9IHNpemUgLSAxOworCQl0aHJfbG93ID0gc2l6ZSAvIDI7CisKKwkJbWZsYWdfaGln
aCA9IHNpemUgKiAyIC8gMzsKKwkJbWZsYWdfbG93ID0gc2l6ZSAvIDM7CisKKwkJcHJlbG9hZCA9
IHRocl9sb3c7CisKKwkJZGV2X2RiZyhkaXNwYy0+ZGV2LAorCQkJIiVzOiBidWZzaXplICV1LCBi
dWZfdGhyZXNob2xkICV1LyV1LCBtZmxhZyB0aHJlc2hvbGQgJXUvJXUgcHJlbG9hZCAldVxuIiwK
KwkJCWRpc3BjLT5mZWF0LT52aWRfbmFtZVtod19wbGFuZV0sCisJCQlzaXplLAorCQkJdGhyX2hp
Z2gsIHRocl9sb3csCisJCQltZmxhZ19oaWdoLCBtZmxhZ19sb3csCisJCQlwcmVsb2FkKTsKKwor
CQlkaXNwY192aWRfc2V0X2J1Zl90aHJlc2hvbGQoZGlzcGMsIGh3X3BsYW5lLAorCQkJCQkgICAg
dGhyX2xvdywgdGhyX2hpZ2gpOworCQlkaXNwY192aWRfc2V0X21mbGFnX3RocmVzaG9sZChkaXNw
YywgaHdfcGxhbmUsCisJCQkJCSAgICAgIG1mbGFnX2xvdywgbWZsYWdfaGlnaCk7CisKKwkJZGlz
cGNfdmlkX3dyaXRlKGRpc3BjLCBod19wbGFuZSwgRElTUENfVklEX1BSRUxPQUQsIHByZWxvYWQp
OworCisJCS8qIFByZWZlY2ggdXAgdG8gUFJFTE9BRCB2YWx1ZSAqLworCQlWSURfUkVHX0ZMRF9N
T0QoZGlzcGMsIGh3X3BsYW5lLCBESVNQQ19WSURfQVRUUklCVVRFUywgMCwgMTksIDE5KTsKKwl9
Cit9CisKK3N0YXRpYyB2b2lkIGRpc3BjX3BsYW5lX2luaXQoc3RydWN0IGRpc3BjX2RldmljZSAq
ZGlzcGMpCit7CisJc3dpdGNoIChkaXNwYy0+ZmVhdC0+c3VicmV2KSB7CisJY2FzZSBESVNQQ19L
Mkc6CisJCWRpc3BjX2syZ19wbGFuZV9pbml0KGRpc3BjKTsKKwkJYnJlYWs7CisJY2FzZSBESVNQ
Q19BTTY1WDoKKwljYXNlIERJU1BDX0o3MjFFOgorCQlkaXNwY19rM19wbGFuZV9pbml0KGRpc3Bj
KTsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJV0FSTl9PTigxKTsKKwl9Cit9CisKK3N0YXRpYyB2
b2lkIGRpc3BjX3ZwX2luaXQoc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMpCit7CisJdW5zaWdu
ZWQgaW50IGk7CisKKwlkZXZfZGJnKGRpc3BjLT5kZXYsICIlcygpXG4iLCBfX2Z1bmNfXyk7CisK
KwkvKiBFbmFibGUgdGhlIGdhbW1hIFNoYWRvdyBiaXQtZmllbGQgZm9yIGFsbCBWUHMqLworCWZv
ciAoaSA9IDA7IGkgPCBkaXNwYy0+ZmVhdC0+bnVtX3ZwczsgaSsrKQorCQlWUF9SRUdfRkxEX01P
RChkaXNwYywgaSwgRElTUENfVlBfQ09ORklHLCAxLCAyLCAyKTsKK30KKworc3RhdGljIHZvaWQg
ZGlzcGNfaW5pdGlhbF9jb25maWcoc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMpCit7CisJZGlz
cGNfcGxhbmVfaW5pdChkaXNwYyk7CisJZGlzcGNfdnBfaW5pdChkaXNwYyk7CisKKwkvKiBOb3Rl
OiBIYXJkY29kZWQgRFBJIHJvdXRpbmcgb24gSjcyMUUgZm9yIG5vdyAqLworCWlmIChkaXNwYy0+
ZmVhdC0+c3VicmV2ID09IERJU1BDX0o3MjFFKSB7CisJCWRpc3BjX3dyaXRlKGRpc3BjLCBESVNQ
Q19DT05ORUNUSU9OUywKKwkJCSAgICBGTERfVkFMKDIsIDMsIDApIHwJCS8qIFZQMSB0byBEUEkw
ICovCisJCQkgICAgRkxEX1ZBTCg4LCA3LCA0KQkJLyogVlAzIHRvIERQSTEgKi8KKwkJCSk7CisJ
fQorfQorCitzdGF0aWMgdm9pZCBkaXNwY19rMmdfdnBfd3JpdGVfZ2FtbWFfdGFibGUoc3RydWN0
IGRpc3BjX2RldmljZSAqZGlzcGMsCisJCQkJCSAgIHUzMiBod192aWRlb3BvcnQpCit7CisJdTMy
ICp0YWJsZSA9IGRpc3BjLT52cF9kYXRhW2h3X3ZpZGVvcG9ydF0uZ2FtbWFfdGFibGU7CisJdTMy
IGh3bGVuID0gZGlzcGMtPmZlYXQtPnZwX2ZlYXQuY29sb3IuZ2FtbWFfc2l6ZTsKKwl1bnNpZ25l
ZCBpbnQgaTsKKworCWRldl9kYmcoZGlzcGMtPmRldiwgIiVzOiBod192aWRlb3BvcnQgJWRcbiIs
IF9fZnVuY19fLCBod192aWRlb3BvcnQpOworCisJaWYgKFdBUk5fT04oZGlzcGMtPmZlYXQtPnZw
X2ZlYXQuY29sb3IuZ2FtbWFfdHlwZSAhPSBUSURTU19HQU1NQV84QklUKSkKKwkJcmV0dXJuOwor
CisJZm9yIChpID0gMDsgaSA8IGh3bGVuOyArK2kpIHsKKwkJdTMyIHYgPSB0YWJsZVtpXTsKKwor
CQl2IHw9IGkgPDwgMjQ7CisKKwkJZGlzcGNfdnBfd3JpdGUoZGlzcGMsIGh3X3ZpZGVvcG9ydCwg
RElTUENfVlBfSzJHX0dBTU1BX1RBQkxFLAorCQkJICAgICAgIHYpOworCX0KK30KKworc3RhdGlj
IHZvaWQgZGlzcGNfYW02NXhfdnBfd3JpdGVfZ2FtbWFfdGFibGUoc3RydWN0IGRpc3BjX2Rldmlj
ZSAqZGlzcGMsCisJCQkJCSAgICAgdTMyIGh3X3ZpZGVvcG9ydCkKK3sKKwl1MzIgKnRhYmxlID0g
ZGlzcGMtPnZwX2RhdGFbaHdfdmlkZW9wb3J0XS5nYW1tYV90YWJsZTsKKwl1MzIgaHdsZW4gPSBk
aXNwYy0+ZmVhdC0+dnBfZmVhdC5jb2xvci5nYW1tYV9zaXplOworCXVuc2lnbmVkIGludCBpOwor
CisJZGV2X2RiZyhkaXNwYy0+ZGV2LCAiJXM6IGh3X3ZpZGVvcG9ydCAlZFxuIiwgX19mdW5jX18s
IGh3X3ZpZGVvcG9ydCk7CisKKwlpZiAoV0FSTl9PTihkaXNwYy0+ZmVhdC0+dnBfZmVhdC5jb2xv
ci5nYW1tYV90eXBlICE9IFRJRFNTX0dBTU1BXzhCSVQpKQorCQlyZXR1cm47CisKKwlmb3IgKGkg
PSAwOyBpIDwgaHdsZW47ICsraSkgeworCQl1MzIgdiA9IHRhYmxlW2ldOworCisJCXYgfD0gaSA8
PCAyNDsKKworCQlkaXNwY192cF93cml0ZShkaXNwYywgaHdfdmlkZW9wb3J0LCBESVNQQ19WUF9H
QU1NQV9UQUJMRSwgdik7CisJfQorfQorCitzdGF0aWMgdm9pZCBkaXNwY19qNzIxZV92cF93cml0
ZV9nYW1tYV90YWJsZShzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNwYywKKwkJCQkJICAgICB1MzIg
aHdfdmlkZW9wb3J0KQoreworCXUzMiAqdGFibGUgPSBkaXNwYy0+dnBfZGF0YVtod192aWRlb3Bv
cnRdLmdhbW1hX3RhYmxlOworCXUzMiBod2xlbiA9IGRpc3BjLT5mZWF0LT52cF9mZWF0LmNvbG9y
LmdhbW1hX3NpemU7CisJdW5zaWduZWQgaW50IGk7CisKKwlkZXZfZGJnKGRpc3BjLT5kZXYsICIl
czogaHdfdmlkZW9wb3J0ICVkXG4iLCBfX2Z1bmNfXywgaHdfdmlkZW9wb3J0KTsKKworCWlmIChX
QVJOX09OKGRpc3BjLT5mZWF0LT52cF9mZWF0LmNvbG9yLmdhbW1hX3R5cGUgIT0gVElEU1NfR0FN
TUFfMTBCSVQpKQorCQlyZXR1cm47CisKKwlmb3IgKGkgPSAwOyBpIDwgaHdsZW47ICsraSkgewor
CQl1MzIgdiA9IHRhYmxlW2ldOworCisJCWlmIChpID09IDApCisJCQl2IHw9IDEgPDwgMzE7CisK
KwkJZGlzcGNfdnBfd3JpdGUoZGlzcGMsIGh3X3ZpZGVvcG9ydCwgRElTUENfVlBfR0FNTUFfVEFC
TEUsIHYpOworCX0KK30KKworc3RhdGljIHZvaWQgZGlzcGNfdnBfd3JpdGVfZ2FtbWFfdGFibGUo
c3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMsCisJCQkJICAgICAgIHUzMiBod192aWRlb3BvcnQp
Cit7CisJc3dpdGNoIChkaXNwYy0+ZmVhdC0+c3VicmV2KSB7CisJY2FzZSBESVNQQ19LMkc6CisJ
CWRpc3BjX2syZ192cF93cml0ZV9nYW1tYV90YWJsZShkaXNwYywgaHdfdmlkZW9wb3J0KTsKKwkJ
YnJlYWs7CisJY2FzZSBESVNQQ19BTTY1WDoKKwkJZGlzcGNfYW02NXhfdnBfd3JpdGVfZ2FtbWFf
dGFibGUoZGlzcGMsIGh3X3ZpZGVvcG9ydCk7CisJCWJyZWFrOworCWNhc2UgRElTUENfSjcyMUU6
CisJCWRpc3BjX2o3MjFlX3ZwX3dyaXRlX2dhbW1hX3RhYmxlKGRpc3BjLCBod192aWRlb3BvcnQp
OworCQlicmVhazsKKwlkZWZhdWx0OgorCQlXQVJOX09OKDEpOworCQlicmVhazsKKwl9Cit9CisK
K3N0YXRpYyB2b2lkIGRpc3BjX3Jlc3RvcmVfZ2FtbWFfdGFibGVzKHN0cnVjdCBkaXNwY19kZXZp
Y2UgKmRpc3BjKQoreworCXVuc2lnbmVkIGludCBpOworCisJZGV2X2RiZyhkaXNwYy0+ZGV2LCAi
JXMoKVxuIiwgX19mdW5jX18pOworCisJZm9yIChpID0gMDsgaSA8IGRpc3BjLT5mZWF0LT5udW1f
dnBzOyBpKyspCisJCWRpc3BjX3ZwX3dyaXRlX2dhbW1hX3RhYmxlKGRpc3BjLCBpKTsKK30KKwor
c3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY29sb3JfbHV0IGRpc3BjX3ZwX2dhbW1hX2RlZmF1bHRf
bHV0W10gPSB7CisJeyAucmVkID0gMCwgLmdyZWVuID0gMCwgLmJsdWUgPSAwLCB9LAorCXsgLnJl
ZCA9IFUxNl9NQVgsIC5ncmVlbiA9IFUxNl9NQVgsIC5ibHVlID0gVTE2X01BWCwgfSwKK307CisK
K3N0YXRpYyB2b2lkIGRpc3BjX3ZwX3NldF9nYW1tYShzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNw
YywKKwkJCSAgICAgICB1MzIgaHdfdmlkZW9wb3J0LAorCQkJICAgICAgIGNvbnN0IHN0cnVjdCBk
cm1fY29sb3JfbHV0ICpsdXQsCisJCQkgICAgICAgdW5zaWduZWQgaW50IGxlbmd0aCkKK3sKKwl1
MzIgKnRhYmxlID0gZGlzcGMtPnZwX2RhdGFbaHdfdmlkZW9wb3J0XS5nYW1tYV90YWJsZTsKKwl1
MzIgaHdsZW4gPSBkaXNwYy0+ZmVhdC0+dnBfZmVhdC5jb2xvci5nYW1tYV9zaXplOworCXUzMiBo
d2JpdHM7CisJdW5zaWduZWQgaW50IGk7CisKKwlkZXZfZGJnKGRpc3BjLT5kZXYsICIlczogaHdf
dmlkZW9wb3J0ICVkLCBsdXQgbGVuICV1LCBodyBsZW4gJXVcbiIsCisJCV9fZnVuY19fLCBod192
aWRlb3BvcnQsIGxlbmd0aCwgaHdsZW4pOworCisJaWYgKGRpc3BjLT5mZWF0LT52cF9mZWF0LmNv
bG9yLmdhbW1hX3R5cGUgPT0gVElEU1NfR0FNTUFfMTBCSVQpCisJCWh3Yml0cyA9IDEwOworCWVs
c2UKKwkJaHdiaXRzID0gODsKKworCWlmIChsdXQgPT0gTlVMTCB8fCBsZW5ndGggPCAyKSB7CisJ
CWx1dCA9IGRpc3BjX3ZwX2dhbW1hX2RlZmF1bHRfbHV0OworCQlsZW5ndGggPSBBUlJBWV9TSVpF
KGRpc3BjX3ZwX2dhbW1hX2RlZmF1bHRfbHV0KTsKKwl9CisKKwlmb3IgKGkgPSAwOyBpIDwgbGVu
Z3RoIC0gMTsgKytpKSB7CisJCXVuc2lnbmVkIGludCBmaXJzdCA9IGkgKiAoaHdsZW4gLSAxKSAv
IChsZW5ndGggLSAxKTsKKwkJdW5zaWduZWQgaW50IGxhc3QgPSAoaSArIDEpICogKGh3bGVuIC0g
MSkgLyAobGVuZ3RoIC0gMSk7CisJCXVuc2lnbmVkIGludCB3ID0gbGFzdCAtIGZpcnN0OworCQl1
MTYgciwgZywgYjsKKwkJdW5zaWduZWQgaW50IGo7CisKKwkJaWYgKHcgPT0gMCkKKwkJCWNvbnRp
bnVlOworCisJCWZvciAoaiA9IDA7IGogPD0gdzsgaisrKSB7CisJCQlyID0gKGx1dFtpXS5yZWQg
KiAodyAtIGopICsgbHV0W2kgKyAxXS5yZWQgKiBqKSAvIHc7CisJCQlnID0gKGx1dFtpXS5ncmVl
biAqICh3IC0gaikgKyBsdXRbaSArIDFdLmdyZWVuICogaikgLyB3OworCQkJYiA9IChsdXRbaV0u
Ymx1ZSAqICh3IC0gaikgKyBsdXRbaSArIDFdLmJsdWUgKiBqKSAvIHc7CisKKwkJCXIgPj49IDE2
IC0gaHdiaXRzOworCQkJZyA+Pj0gMTYgLSBod2JpdHM7CisJCQliID4+PSAxNiAtIGh3Yml0czsK
KworCQkJdGFibGVbZmlyc3QgKyBqXSA9IChyIDw8IChod2JpdHMgKiAyKSkgfAorCQkJCShnIDw8
IGh3Yml0cykgfCBiOworCQl9CisJfQorCisJaWYgKGRpc3BjLT5pc19lbmFibGVkKQorCQlkaXNw
Y192cF93cml0ZV9nYW1tYV90YWJsZShkaXNwYywgaHdfdmlkZW9wb3J0KTsKK30KKworc3RhdGlj
IHMxNiBkaXNwY19TMzFfMzJfdG9fczJfOChzNjQgY29lZikKK3sKKwl1NjQgc2lnbl9iaXQgPSAx
VUxMIDw8IDYzOworCXU2NCBjYml0cyA9ICh1NjQpIGNvZWY7CisJczE2IHJldCA9IGNsYW1wX3Zh
bCgoKGNiaXRzICYgfnNpZ25fYml0KSA+PiAyNCksIDAsIDB4MUZGKTsKKworCWlmIChjYml0cyAm
IHNpZ25fYml0KQorCQlyZXQgPSAtcmV0OworCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIHZv
aWQgZGlzcGNfY3ByX2NzY19mcm9tX2N0bShjb25zdCBzdHJ1Y3QgZHJtX2NvbG9yX2N0bSAqY3Rt
LAorCQkJCSAgIHN0cnVjdCBkaXNwY19jc2NfY29lZiAqY3ByKQoreworCW1lbXNldChjcHIsIDAs
IHNpemVvZigqY3ByKSk7CisKKwljcHItPnRvX3JlZ3ZhbCA9IGRpc3BjX2NzY19jcHJfcmVndmFs
OworCWNwci0+bVtDU0NfUlJdID0gZGlzcGNfUzMxXzMyX3RvX3MyXzgoY3RtLT5tYXRyaXhbMF0p
OworCWNwci0+bVtDU0NfUkddID0gZGlzcGNfUzMxXzMyX3RvX3MyXzgoY3RtLT5tYXRyaXhbMV0p
OworCWNwci0+bVtDU0NfUkJdID0gZGlzcGNfUzMxXzMyX3RvX3MyXzgoY3RtLT5tYXRyaXhbMl0p
OworCWNwci0+bVtDU0NfR1JdID0gZGlzcGNfUzMxXzMyX3RvX3MyXzgoY3RtLT5tYXRyaXhbM10p
OworCWNwci0+bVtDU0NfR0ddID0gZGlzcGNfUzMxXzMyX3RvX3MyXzgoY3RtLT5tYXRyaXhbNF0p
OworCWNwci0+bVtDU0NfR0JdID0gZGlzcGNfUzMxXzMyX3RvX3MyXzgoY3RtLT5tYXRyaXhbNV0p
OworCWNwci0+bVtDU0NfQlJdID0gZGlzcGNfUzMxXzMyX3RvX3MyXzgoY3RtLT5tYXRyaXhbNl0p
OworCWNwci0+bVtDU0NfQkddID0gZGlzcGNfUzMxXzMyX3RvX3MyXzgoY3RtLT5tYXRyaXhbN10p
OworCWNwci0+bVtDU0NfQkJdID0gZGlzcGNfUzMxXzMyX3RvX3MyXzgoY3RtLT5tYXRyaXhbOF0p
OworfQorCitzdGF0aWMgdm9pZCBkaXNwY192cF93cml0ZV9jc2Moc3RydWN0IGRpc3BjX2Rldmlj
ZSAqZGlzcGMsIHUzMiBod192aWRlb3BvcnQsCisJCQkgICAgICAgY29uc3Qgc3RydWN0IGRpc3Bj
X2NzY19jb2VmICpjc2MpCit7CisJc3RhdGljIGNvbnN0IHUxNiBkaXNwY192cF9jc2NfY29lZl9y
ZWdbRElTUENfQ1NDX1JFR1ZBTF9MRU5dID0geworCQlESVNQQ19WUF9DU0NfQ09FRjAsIERJU1BD
X1ZQX0NTQ19DT0VGMSwgRElTUENfVlBfQ1NDX0NPRUYyLAorCQlESVNQQ19WUF9DU0NfQ09FRjMs
IERJU1BDX1ZQX0NTQ19DT0VGNCwgRElTUENfVlBfQ1NDX0NPRUY1LAorCQlESVNQQ19WUF9DU0Nf
Q09FRjYsIERJU1BDX1ZQX0NTQ19DT0VGNywKKwl9OworCXUzMiByZWd2YWxbRElTUENfQ1NDX1JF
R1ZBTF9MRU5dOworCXVuc2lnbmVkIGludCBpOworCisJaWYgKCFXQVJOX09OKGRpc3BjLT5mZWF0
LT5zdWJyZXYgPT0gRElTUENfSzJHKSkKKwkJcmV0dXJuOworCisJY3NjLT50b19yZWd2YWwoY3Nj
LCByZWd2YWwpOworCisJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUocmVndmFsKTsgaSsrKQor
CQlkaXNwY192cF93cml0ZShkaXNwYywgaHdfdmlkZW9wb3J0LCBkaXNwY192cF9jc2NfY29lZl9y
ZWdbaV0sCisJCQkgICAgICAgcmVndmFsW2ldKTsKK30KKworc3RhdGljIHZvaWQgZGlzcGNfdnBf
c2V0X2NvbG9yX21nbXQoc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMsCisJCQkJICAgIHUzMiBo
d192aWRlb3BvcnQsCisJCQkJICAgIGNvbnN0IHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqc3RhdGUp
Cit7CisJc3RydWN0IGRybV9jb2xvcl9sdXQgKmx1dCA9IE5VTEw7CisJdW5zaWduZWQgaW50IGxl
bmd0aCA9IDA7CisJYm9vbCBjb2xvcmNvbnZlbmFibGUgPSBmYWxzZTsKKworCWlmICghc3RhdGUt
PmNvbG9yX21nbXRfY2hhbmdlZCkKKwkJcmV0dXJuOworCisJaWYgKHN0YXRlLT5nYW1tYV9sdXQp
IHsKKwkJbHV0ID0gKHN0cnVjdCBkcm1fY29sb3JfbHV0ICopIHN0YXRlLT5nYW1tYV9sdXQtPmRh
dGE7CisJCWxlbmd0aCA9IHN0YXRlLT5nYW1tYV9sdXQtPmxlbmd0aCAvIHNpemVvZigqbHV0KTsK
Kwl9CisKKwlpZiAoc3RhdGUtPmN0bSkgeworCQlzdHJ1Y3QgZHJtX2NvbG9yX2N0bSAqY3RtID0K
KwkJCShzdHJ1Y3QgZHJtX2NvbG9yX2N0bSAqKSBzdGF0ZS0+Y3RtLT5kYXRhOworCQlzdHJ1Y3Qg
ZGlzcGNfY3NjX2NvZWYgY3ByOworCisJCWRpc3BjX2Nwcl9jc2NfZnJvbV9jdG0oY3RtLCAmY3By
KTsKKwkJZGlzcGNfdnBfd3JpdGVfY3NjKGRpc3BjLCBod192aWRlb3BvcnQsICZjcHIpOworCisJ
CWNvbG9yY29udmVuYWJsZSA9IHRydWU7CisJfQorCisJZGlzcGNfdnBfc2V0X2dhbW1hKGRpc3Bj
LCBod192aWRlb3BvcnQsIGx1dCwgbGVuZ3RoKTsKKwlWUF9SRUdfRkxEX01PRChkaXNwYywgaHdf
dmlkZW9wb3J0LCBESVNQQ19WUF9DT05GSUcsCisJCSAgICAgICBjb2xvcmNvbnZlbmFibGUsIDI0
LCAyNCk7Cit9CisKK3ZvaWQgZGlzcGNfdnBfc2V0dXAoc3RydWN0IGRpc3BjX2RldmljZSAqZGlz
cGMsIHUzMiBod192aWRlb3BvcnQsCisJCSAgICBjb25zdCBzdHJ1Y3QgZHJtX2NydGNfc3RhdGUg
KnN0YXRlKQoreworCWRpc3BjX3ZwX3NldF9kZWZhdWx0X2NvbG9yKGRpc3BjLCBod192aWRlb3Bv
cnQsIDApOworCWRpc3BjX3ZwX3NldF9jb2xvcl9tZ210KGRpc3BjLCBod192aWRlb3BvcnQsIHN0
YXRlKTsKK30KKworc3RhdGljIGludCBkaXNwY19pbml0X2dhbW1hX3RhYmxlcyhzdHJ1Y3QgZGlz
cGNfZGV2aWNlICpkaXNwYykKK3sKKwl1bnNpZ25lZCBpbnQgaTsKKworCWRldl9kYmcoZGlzcGMt
PmRldiwgIiVzKClcbiIsIF9fZnVuY19fKTsKKworCWZvciAoaSA9IDA7IGkgPCBkaXNwYy0+ZmVh
dC0+bnVtX3ZwczsgaSsrKQorCQlkaXNwY192cF9zZXRfZ2FtbWEoZGlzcGMsIGksIE5VTEwsIDAp
OworCisJcmV0dXJuIDA7Cit9CisKK2ludCBkaXNwY19ydW50aW1lX3N1c3BlbmQoc3RydWN0IGRp
c3BjX2RldmljZSAqZGlzcGMpCit7CisJZGV2X2RiZyhkaXNwYy0+ZGV2LCAic3VzcGVuZFxuIik7
CisKKwlkaXNwYy0+aXNfZW5hYmxlZCA9IGZhbHNlOworCisJY2xrX2Rpc2FibGVfdW5wcmVwYXJl
KGRpc3BjLT5mY2xrKTsKKworCXJldHVybiAwOworfQorCitpbnQgZGlzcGNfcnVudGltZV9yZXN1
bWUoc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMpCit7CisJZGV2X2RiZyhkaXNwYy0+ZGV2LCAi
cmVzdW1lXG4iKTsKKworCWNsa19wcmVwYXJlX2VuYWJsZShkaXNwYy0+ZmNsayk7CisKKwlpZiAo
UkVHX0dFVChkaXNwYywgRFNTX1NZU1NUQVRVUywgMCwgMCkgPT0gMCkKKwkJZGV2X3dhcm4oZGlz
cGMtPmRldiwgIkRTUyBGVU5DIFJFU0VUIG5vdCBkb25lIVxuIik7CisKKwlkZXZfZGJnKGRpc3Bj
LT5kZXYsICJPTUFQIERTUzcgcmV2IDB4JXhcbiIsCisJCWRpc3BjX3JlYWQoZGlzcGMsIERTU19S
RVZJU0lPTikpOworCisJZGV2X2RiZyhkaXNwYy0+ZGV2LCAiVlAgUkVTRVRET05FICVkLCVkLCVk
XG4iLAorCQlSRUdfR0VUKGRpc3BjLCBEU1NfU1lTU1RBVFVTLCAxLCAxKSwKKwkJUkVHX0dFVChk
aXNwYywgRFNTX1NZU1NUQVRVUywgMiwgMiksCisJCVJFR19HRVQoZGlzcGMsIERTU19TWVNTVEFU
VVMsIDMsIDMpKTsKKworCWlmIChkaXNwYy0+ZmVhdC0+c3VicmV2ID09IERJU1BDX0FNNjVYKQor
CQlkZXZfZGJnKGRpc3BjLT5kZXYsICJPTERJIFJFU0VURE9ORSAlZCwlZCwlZFxuIiwKKwkJCVJF
R19HRVQoZGlzcGMsIERTU19TWVNTVEFUVVMsIDUsIDUpLAorCQkJUkVHX0dFVChkaXNwYywgRFNT
X1NZU1NUQVRVUywgNiwgNiksCisJCQlSRUdfR0VUKGRpc3BjLCBEU1NfU1lTU1RBVFVTLCA3LCA3
KSk7CisKKwlkZXZfZGJnKGRpc3BjLT5kZXYsICJESVNQQyBJRExFICVkXG4iLAorCQlSRUdfR0VU
KGRpc3BjLCBEU1NfU1lTU1RBVFVTLCA5LCA5KSk7CisKKwlkaXNwY19pbml0aWFsX2NvbmZpZyhk
aXNwYyk7CisKKwlkaXNwY19yZXN0b3JlX2dhbW1hX3RhYmxlcyhkaXNwYyk7CisKKwlkaXNwYy0+
aXNfZW5hYmxlZCA9IHRydWU7CisKKwl0aWRzc19pcnFfcmVzdW1lKGRpc3BjLT50aWRzcyk7CisK
KwlyZXR1cm4gMDsKK30KKworCit2b2lkIGRpc3BjX3JlbW92ZShzdHJ1Y3QgdGlkc3NfZGV2aWNl
ICp0aWRzcykKK3sKKwlkZXZfZGJnKHRpZHNzLT5kZXYsICIlc1xuIiwgX19mdW5jX18pOworCisJ
dGlkc3MtPmRpc3BjID0gTlVMTDsKK30KKworc3RhdGljIGludCBkaXNwY19pb21hcF9yZXNvdXJj
ZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2LCBjb25zdCBjaGFyICpuYW1lLAorCQkJCXZv
aWQgX19pb21lbSAqKmJhc2UpCit7CisJc3RydWN0IHJlc291cmNlICpyZXM7CisJdm9pZCBfX2lv
bWVtICpiOworCisJcmVzID0gcGxhdGZvcm1fZ2V0X3Jlc291cmNlX2J5bmFtZShwZGV2LCBJT1JF
U09VUkNFX01FTSwgbmFtZSk7CisJaWYgKCFyZXMpIHsKKwkJZGV2X2VycigmcGRldi0+ZGV2LCAi
Y2Fubm90IGdldCBtZW0gcmVzb3VyY2UgJyVzJ1xuIiwgbmFtZSk7CisJCXJldHVybiAtRUlOVkFM
OworCX0KKworCWIgPSBkZXZtX2lvcmVtYXBfcmVzb3VyY2UoJnBkZXYtPmRldiwgcmVzKTsKKwlp
ZiAoSVNfRVJSKGIpKSB7CisJCWRldl9lcnIoJnBkZXYtPmRldiwgImNhbm5vdCBpb3JlbWFwIHJl
c291cmNlICclcydcbiIsIG5hbWUpOworCQlyZXR1cm4gUFRSX0VSUihiKTsKKwl9CisKKwkqYmFz
ZSA9IGI7CisKKwlyZXR1cm4gMDsKK30KKworaW50IGRpc3BjX2luaXQoc3RydWN0IHRpZHNzX2Rl
dmljZSAqdGlkc3MpCit7CisJc3RydWN0IGRldmljZSAqZGV2ID0gdGlkc3MtPmRldjsKKwlzdHJ1
Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2ID0gdG9fcGxhdGZvcm1fZGV2aWNlKGRldik7CisJc3Ry
dWN0IGRpc3BjX2RldmljZSAqZGlzcGM7CisJY29uc3Qgc3RydWN0IGRpc3BjX2ZlYXR1cmVzICpm
ZWF0OworCXVuc2lnbmVkIGludCBpLCBudW1fZm91cmNjczsKKwlpbnQgciA9IDA7CisKKwlkZXZf
ZGJnKGRldiwgIiVzXG4iLCBfX2Z1bmNfXyk7CisKKwlmZWF0ID0gdGlkc3MtPmZlYXQ7CisKKwlp
ZiAoZmVhdC0+c3VicmV2ICE9IERJU1BDX0syRykgeworCQlyID0gZG1hX3NldF9tYXNrX2FuZF9j
b2hlcmVudChkZXYsIERNQV9CSVRfTUFTSyg0OCkpOworCQlpZiAocikKKwkJCWRldl93YXJuKGRl
diwgImNhbm5vdCBzZXQgRE1BIG1hc2tzIHRvIDQ4LWJpdFxuIik7CisJfQorCisJZGlzcGMgPSBk
ZXZtX2t6YWxsb2MoZGV2LCBzaXplb2YoKmRpc3BjKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFkaXNw
YykKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlkaXNwYy0+Zm91cmNjcyA9IGRldm1fa2NhbGxvYyhk
ZXYsIEFSUkFZX1NJWkUoZGlzcGNfY29sb3JfZm9ybWF0cyksCisJCQkJICAgICAgc2l6ZW9mKCpk
aXNwYy0+Zm91cmNjcyksIEdGUF9LRVJORUwpOworCWlmICghZGlzcGMtPmZvdXJjY3MpCisJCXJl
dHVybiAtRU5PTUVNOworCisJbnVtX2ZvdXJjY3MgPSAwOworCWZvciAoaSA9IDA7IGkgPCBBUlJB
WV9TSVpFKGRpc3BjX2NvbG9yX2Zvcm1hdHMpOyArK2kpIHsKKwkJaWYgKGZlYXQtPmVycmF0YS5p
MjAwMCAmJgorCQkgICAgZGlzcGNfZm91cmNjX2lzX3l1dihkaXNwY19jb2xvcl9mb3JtYXRzW2ld
LmZvdXJjYykpCisJCQljb250aW51ZTsKKwkJZGlzcGMtPmZvdXJjY3NbbnVtX2ZvdXJjY3MrK10g
PSBkaXNwY19jb2xvcl9mb3JtYXRzW2ldLmZvdXJjYzsKKwl9CisJZGlzcGMtPm51bV9mb3VyY2Nz
ID0gbnVtX2ZvdXJjY3M7CisJZGlzcGMtPnRpZHNzID0gdGlkc3M7CisJZGlzcGMtPmRldiA9IGRl
djsKKwlkaXNwYy0+ZmVhdCA9IGZlYXQ7CisKKwlkaXNwY19jb21tb25fcmVnbWFwID0gZGlzcGMt
PmZlYXQtPmNvbW1vbl9yZWdzOworCisJciA9IGRpc3BjX2lvbWFwX3Jlc291cmNlKHBkZXYsIGRp
c3BjLT5mZWF0LT5jb21tb24sCisJCQkJICZkaXNwYy0+YmFzZV9jb21tb24pOworCWlmIChyKQor
CQlyZXR1cm4gcjsKKworCWZvciAoaSA9IDA7IGkgPCBkaXNwYy0+ZmVhdC0+bnVtX3BsYW5lczsg
aSsrKSB7CisJCXIgPSBkaXNwY19pb21hcF9yZXNvdXJjZShwZGV2LCBkaXNwYy0+ZmVhdC0+dmlk
X25hbWVbaV0sCisJCQkJCSAmZGlzcGMtPmJhc2VfdmlkW2ldKTsKKwkJZGV2X2RiZyhkZXYsICIl
czogJXUgJXMgJWRcbiIsIF9fZnVuY19fLAorCQkJaSwgZGlzcGMtPmZlYXQtPnZpZF9uYW1lW2ld
LCByKTsKKwkJaWYgKHIpCisJCQlyZXR1cm4gcjsKKwl9CisKKwlmb3IgKGkgPSAwOyBpIDwgZGlz
cGMtPmZlYXQtPm51bV92cHM7IGkrKykgeworCQlzdHJ1Y3QgY2xrICpjbGs7CisKKwkJciA9IGRp
c3BjX2lvbWFwX3Jlc291cmNlKHBkZXYsIGRpc3BjLT5mZWF0LT5vdnJfbmFtZVtpXSwKKwkJCQkJ
ICZkaXNwYy0+YmFzZV9vdnJbaV0pOworCQlkZXZfZGJnKGRldiwgIiVzOiAldSAlcyAlZFxuIiwg
X19mdW5jX18sCisJCQlpLCBkaXNwYy0+ZmVhdC0+b3ZyX25hbWVbaV0sIHIpOworCQlpZiAocikK
KwkJCXJldHVybiByOworCisJCXIgPSBkaXNwY19pb21hcF9yZXNvdXJjZShwZGV2LCBkaXNwYy0+
ZmVhdC0+dnBfbmFtZVtpXSwKKwkJCQkJICZkaXNwYy0+YmFzZV92cFtpXSk7CisJCWRldl9kYmco
ZGV2LCAiJXM6ICV1ICVzICVkXG4iLCBfX2Z1bmNfXywKKwkJCWksIGRpc3BjLT5mZWF0LT52cF9u
YW1lW2ldLCByKTsKKwkJaWYgKHIpCisJCQlyZXR1cm4gcjsKKworCQljbGsgPSBkZXZtX2Nsa19n
ZXQoZGV2LCBkaXNwYy0+ZmVhdC0+dnBjbGtfbmFtZVtpXSk7CisJCWlmIChJU19FUlIoY2xrKSkg
eworCQkJZGV2X2VycihkZXYsICIlczogRmFpbGVkIHRvIGdldCBjbGsgJXM6JWxkXG4iLCBfX2Z1
bmNfXywKKwkJCQlkaXNwYy0+ZmVhdC0+dnBjbGtfbmFtZVtpXSwgUFRSX0VSUihjbGspKTsKKwkJ
CXJldHVybiBQVFJfRVJSKGNsayk7CisJCX0KKwkJZGlzcGMtPnZwX2Nsa1tpXSA9IGNsazsKKwor
CQlkaXNwYy0+dnBfZGF0YVtpXS5nYW1tYV90YWJsZSA9IGRldm1fa21hbGxvY19hcnJheSgKKwkJ
CWRldiwgZGlzcGMtPmZlYXQtPnZwX2ZlYXQuY29sb3IuZ2FtbWFfc2l6ZSwKKwkJCXNpemVvZigq
ZGlzcGMtPnZwX2RhdGFbaV0uZ2FtbWFfdGFibGUpLCBHRlBfS0VSTkVMKTsKKwkJaWYgKCFkaXNw
Yy0+dnBfZGF0YVtpXS5nYW1tYV90YWJsZSkKKwkJCXJldHVybiAtRU5PTUVNOworCX0KKworCWlm
IChmZWF0LT5zdWJyZXYgPT0gRElTUENfQU02NVgpIHsKKwkJZGlzcGMtPm9sZGlfaW9fY3RybCA9
CisJCQlzeXNjb25fcmVnbWFwX2xvb2t1cF9ieV9waGFuZGxlKGRldi0+b2Zfbm9kZSwKKwkJCQkJ
CQkidGksYW02NXgtb2xkaS1pby1jdHJsIik7CisJCWlmIChQVFJfRVJSKGRpc3BjLT5vbGRpX2lv
X2N0cmwpID09IC1FTk9ERVYpIHsKKwkJCWRpc3BjLT5vbGRpX2lvX2N0cmwgPSBOVUxMOworCQl9
IGVsc2UgaWYgKElTX0VSUihkaXNwYy0+b2xkaV9pb19jdHJsKSkgeworCQkJZGV2X2VycihkZXYs
ICIlczogc3lzY29uX3JlZ21hcF9sb29rdXBfYnlfcGhhbmRsZSBmYWlsZWQgJWxkXG4iLAorCQkJ
CV9fZnVuY19fLCBQVFJfRVJSKGRpc3BjLT5vbGRpX2lvX2N0cmwpKTsKKwkJCXJldHVybiBQVFJf
RVJSKGRpc3BjLT5vbGRpX2lvX2N0cmwpOworCQl9CisJfQorCisJZGlzcGMtPmZjbGsgPSBkZXZt
X2Nsa19nZXQoZGV2LCAiZmNrIik7CisJaWYgKElTX0VSUihkaXNwYy0+ZmNsaykpIHsKKwkJZGV2
X2VycihkZXYsICIlczogRmFpbGVkIHRvIGdldCBmY2xrOiAlbGRcbiIsCisJCQlfX2Z1bmNfXywg
UFRSX0VSUihkaXNwYy0+ZmNsaykpOworCQlyZXR1cm4gUFRSX0VSUihkaXNwYy0+ZmNsayk7CisJ
fQorCWRldl9kYmcoZGV2LCAiRFNTIGZjbGsgJWx1IEh6XG4iLCBjbGtfZ2V0X3JhdGUoZGlzcGMt
PmZjbGspKTsKKworCW9mX3Byb3BlcnR5X3JlYWRfdTMyKGRpc3BjLT5kZXYtPm9mX25vZGUsICJt
YXgtbWVtb3J5LWJhbmR3aWR0aCIsCisJCQkgICAgICZkaXNwYy0+bWVtb3J5X2JhbmR3aWR0aF9s
aW1pdCk7CisKKwlyID0gZGlzcGNfaW5pdF9nYW1tYV90YWJsZXMoZGlzcGMpOworCWlmIChyKQor
CQlyZXR1cm4gcjsKKworCXRpZHNzLT5kaXNwYyA9IGRpc3BjOworCisJcmV0dXJuIDA7Cit9CmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdGlkc3MvdGlkc3NfZGlzcGMuaCBiL2RyaXZlcnMv
Z3B1L2RybS90aWRzcy90aWRzc19kaXNwYy5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAw
MDAwMDAwMDAwMC4uNjE5OTY3MWNhNjQ4Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL3RpZHNzL3RpZHNzX2Rpc3BjLmgKQEAgLTAsMCArMSwxMzIgQEAKKy8qIFNQRFgtTGljZW5z
ZS1JZGVudGlmaWVyOiBHUEwtMi4wICovCisvKgorICogQ29weXJpZ2h0IChDKSAyMDE4IFRleGFz
IEluc3RydW1lbnRzIEluY29ycG9yYXRlZCAtIGh0dHA6Ly93d3cudGkuY29tLworICogQXV0aG9y
OiBUb21pIFZhbGtlaW5lbiA8dG9taS52YWxrZWluZW5AdGkuY29tPgorICovCisKKyNpZm5kZWYg
X19USURTU19ESVNQQ19IX18KKyNkZWZpbmUgX19USURTU19ESVNQQ19IX18KKworI2luY2x1ZGUg
InRpZHNzX2Rydi5oIgorCitzdHJ1Y3QgZGlzcGNfZGV2aWNlOworCitzdHJ1Y3QgZHJtX2NydGNf
c3RhdGU7CisKK2VudW0gdGlkc3NfZ2FtbWFfdHlwZSB7IFRJRFNTX0dBTU1BXzhCSVQsIFRJRFNT
X0dBTU1BXzEwQklUIH07CisKK3N0cnVjdCB0aWRzc192cF9mZWF0IHsKKwlzdHJ1Y3QgdGlkc3Nf
dnBfY29sb3JfZmVhdCB7CisJCXUzMiBnYW1tYV9zaXplOworCQllbnVtIHRpZHNzX2dhbW1hX3R5
cGUgZ2FtbWFfdHlwZTsKKwkJYm9vbCBoYXNfY3RtOworCX0gY29sb3I7Cit9OworCitzdHJ1Y3Qg
dGlkc3NfcGxhbmVfZmVhdCB7CisJc3RydWN0IHRpZHNzX3BsYW5lX2NvbG9yX2ZlYXQgeworCQl1
MzIgZW5jb2RpbmdzOworCQl1MzIgcmFuZ2VzOworCQllbnVtIGRybV9jb2xvcl9lbmNvZGluZyBk
ZWZhdWx0X2VuY29kaW5nOworCQllbnVtIGRybV9jb2xvcl9yYW5nZSBkZWZhdWx0X3JhbmdlOwor
CX0gY29sb3I7CisJc3RydWN0IHRpZHNzX3BsYW5lX2JsZW5kX2ZlYXQgeworCQlib29sIGdsb2Jh
bF9hbHBoYTsKKwl9IGJsZW5kOworfTsKKworc3RydWN0IGRpc3BjX2ZlYXR1cmVzX3NjYWxpbmcg
eworCXUzMiBpbl93aWR0aF9tYXhfNXRhcF9yZ2I7CisJdTMyIGluX3dpZHRoX21heF8zdGFwX3Jn
YjsKKwl1MzIgaW5fd2lkdGhfbWF4XzV0YXBfeXV2OworCXUzMiBpbl93aWR0aF9tYXhfM3RhcF95
dXY7CisJdTMyIHVwc2NhbGVfbGltaXQ7CisJdTMyIGRvd25zY2FsZV9saW1pdF81dGFwOworCXUz
MiBkb3duc2NhbGVfbGltaXRfM3RhcDsKKwl1MzIgeGluY19tYXg7Cit9OworCitzdHJ1Y3QgZGlz
cGNfZXJyYXRhIHsKKwlib29sIGkyMDAwOyAvKiBEU1MgRG9lcyBOb3QgU3VwcG9ydCBZVVYgUGl4
ZWwgRGF0YSBGb3JtYXRzICovCit9OworCitlbnVtIGRpc3BjX3ZwX2J1c190eXBlIHsKKwlESVNQ
Q19WUF9EUEksCQkvKiBEUEkgb3V0cHV0ICovCisJRElTUENfVlBfT0xESSwJCS8qIE9MREkgKExW
RFMpIG91dHB1dCAqLworCURJU1BDX1ZQX0lOVEVSTkFMLAkvKiBTb0MgaW50ZXJuYWwgcm91dGlu
ZyAqLworCURJU1BDX1ZQX01BWF9CVVNfVFlQRSwKK307CisKK2VudW0gZGlzcGNfZHNzX3N1YnJl
dmlzaW9uIHsKKwlESVNQQ19LMkcsCisJRElTUENfQU02NVgsCisJRElTUENfSjcyMUUsCit9Owor
CitzdHJ1Y3QgZGlzcGNfZmVhdHVyZXMgeworCWludCBtaW5fcGNsa19rSHo7CisJaW50IG1heF9w
Y2xrX2tIeltESVNQQ19WUF9NQVhfQlVTX1RZUEVdOworCisJc3RydWN0IGRpc3BjX2ZlYXR1cmVz
X3NjYWxpbmcgc2NhbGluZzsKKworCWVudW0gZGlzcGNfZHNzX3N1YnJldmlzaW9uIHN1YnJldjsK
KworCWNvbnN0IGNoYXIgKmNvbW1vbjsKKwljb25zdCB1MTYgKmNvbW1vbl9yZWdzOworCXUzMiBu
dW1fdnBzOworCWNvbnN0IGNoYXIgKnZwX25hbWVbVElEU1NfTUFYX1BPUlRTXTsgLyogU2hvdWxk
IG1hdGNoIGR0IHJlZyBuYW1lcyAqLworCWNvbnN0IGNoYXIgKm92cl9uYW1lW1RJRFNTX01BWF9Q
T1JUU107IC8qIFNob3VsZCBtYXRjaCBkdCByZWcgbmFtZXMgKi8KKwljb25zdCBjaGFyICp2cGNs
a19uYW1lW1RJRFNTX01BWF9QT1JUU107IC8qIFNob3VsZCBtYXRjaCBkdCBjbGsgbmFtZXMgKi8K
Kwljb25zdCBlbnVtIGRpc3BjX3ZwX2J1c190eXBlIHZwX2J1c190eXBlW1RJRFNTX01BWF9QT1JU
U107CisJc3RydWN0IHRpZHNzX3ZwX2ZlYXQgdnBfZmVhdDsKKwl1MzIgbnVtX3BsYW5lczsKKwlj
b25zdCBjaGFyICp2aWRfbmFtZVtUSURTU19NQVhfUExBTkVTXTsgLyogU2hvdWxkIG1hdGNoIGR0
IHJlZyBuYW1lcyAqLworCWJvb2wgdmlkX2xpdGVbVElEU1NfTUFYX1BMQU5FU107CisJdTMyIHZp
ZF9vcmRlcltUSURTU19NQVhfUExBTkVTXTsKKworCXN0cnVjdCBkaXNwY19lcnJhdGEgZXJyYXRh
OworfTsKKworZXh0ZXJuIGNvbnN0IHN0cnVjdCBkaXNwY19mZWF0dXJlcyBkaXNwY19rMmdfZmVh
dHM7CitleHRlcm4gY29uc3Qgc3RydWN0IGRpc3BjX2ZlYXR1cmVzIGRpc3BjX2FtNjV4X2ZlYXRz
OworZXh0ZXJuIGNvbnN0IHN0cnVjdCBkaXNwY19mZWF0dXJlcyBkaXNwY19qNzIxZV9mZWF0czsK
Kwordm9pZCBkaXNwY193cml0ZV9pcnFlbmFibGUoc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMs
IGRpc3BjX2lycV90IG1hc2spOworZGlzcGNfaXJxX3QgZGlzcGNfcmVhZF9hbmRfY2xlYXJfaXJx
c3RhdHVzKHN0cnVjdCBkaXNwY19kZXZpY2UgKmRpc3BjKTsKKwordm9pZCBkaXNwY192cF9wcmVw
YXJlKHN0cnVjdCBkaXNwY19kZXZpY2UgKmRpc3BjLCB1MzIgaHdfdmlkZW9wb3J0LAorCQkgICAg
ICBjb25zdCBzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKnN0YXRlKTsKK3ZvaWQgZGlzcGNfdnBfZW5h
YmxlKHN0cnVjdCBkaXNwY19kZXZpY2UgKmRpc3BjLCB1MzIgaHdfdmlkZW9wb3J0LAorCQkgICAg
IGNvbnN0IHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqc3RhdGUpOwordm9pZCBkaXNwY192cF9kaXNh
YmxlKHN0cnVjdCBkaXNwY19kZXZpY2UgKmRpc3BjLCB1MzIgaHdfdmlkZW9wb3J0KTsKK3ZvaWQg
ZGlzcGNfdnBfdW5wcmVwYXJlKHN0cnVjdCBkaXNwY19kZXZpY2UgKmRpc3BjLCB1MzIgaHdfdmlk
ZW9wb3J0KTsKK2Jvb2wgZGlzcGNfdnBfZ29fYnVzeShzdHJ1Y3QgZGlzcGNfZGV2aWNlICpkaXNw
YywgdTMyIGh3X3ZpZGVvcG9ydCk7Cit2b2lkIGRpc3BjX3ZwX2dvKHN0cnVjdCBkaXNwY19kZXZp
Y2UgKmRpc3BjLCB1MzIgaHdfdmlkZW9wb3J0KTsKK2ludCBkaXNwY192cF9idXNfY2hlY2soc3Ry
dWN0IGRpc3BjX2RldmljZSAqZGlzcGMsIHUzMiBod192aWRlb3BvcnQsCisJCSAgICAgICBjb25z
dCBzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKnN0YXRlKTsKK2VudW0gZHJtX21vZGVfc3RhdHVzIGRp
c3BjX3ZwX21vZGVfdmFsaWQoc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMsCisJCQkJCSB1MzIg
aHdfdmlkZW9wb3J0LAorCQkJCQkgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUp
OworaW50IGRpc3BjX3ZwX2VuYWJsZV9jbGsoc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMsIHUz
MiBod192aWRlb3BvcnQpOwordm9pZCBkaXNwY192cF9kaXNhYmxlX2NsayhzdHJ1Y3QgZGlzcGNf
ZGV2aWNlICpkaXNwYywgdTMyIGh3X3ZpZGVvcG9ydCk7CitpbnQgZGlzcGNfdnBfc2V0X2Nsa19y
YXRlKHN0cnVjdCBkaXNwY19kZXZpY2UgKmRpc3BjLCB1MzIgaHdfdmlkZW9wb3J0LAorCQkJICB1
bnNpZ25lZCBsb25nIHJhdGUpOwordm9pZCBkaXNwY192cF9zZXR1cChzdHJ1Y3QgZGlzcGNfZGV2
aWNlICpkaXNwYywgdTMyIGh3X3ZpZGVvcG9ydCwKKwkJICAgIGNvbnN0IHN0cnVjdCBkcm1fY3J0
Y19zdGF0ZSAqc3RhdGUpOworCitpbnQgZGlzcGNfcnVudGltZV9zdXNwZW5kKHN0cnVjdCBkaXNw
Y19kZXZpY2UgKmRpc3BjKTsKK2ludCBkaXNwY19ydW50aW1lX3Jlc3VtZShzdHJ1Y3QgZGlzcGNf
ZGV2aWNlICpkaXNwYyk7CisKK2ludCBkaXNwY19wbGFuZV9jaGVjayhzdHJ1Y3QgZGlzcGNfZGV2
aWNlICpkaXNwYywgdTMyIGh3X3BsYW5lLAorCQkgICAgICBjb25zdCBzdHJ1Y3QgZHJtX3BsYW5l
X3N0YXRlICpzdGF0ZSwKKwkJICAgICAgdTMyIGh3X3ZpZGVvcG9ydCk7CitpbnQgZGlzcGNfcGxh
bmVfc2V0dXAoc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMsIHUzMiBod19wbGFuZSwKKwkJICAg
ICAgY29uc3Qgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgIHUzMiBod192
aWRlb3BvcnQpOworaW50IGRpc3BjX3BsYW5lX2VuYWJsZShzdHJ1Y3QgZGlzcGNfZGV2aWNlICpk
aXNwYywgdTMyIGh3X3BsYW5lLCBib29sIGVuYWJsZSk7Citjb25zdCB1MzIgKmRpc3BjX3BsYW5l
X2Zvcm1hdHMoc3RydWN0IGRpc3BjX2RldmljZSAqZGlzcGMsIHVuc2lnbmVkIGludCAqbGVuKTsK
KworaW50IGRpc3BjX2luaXQoc3RydWN0IHRpZHNzX2RldmljZSAqdGlkc3MpOwordm9pZCBkaXNw
Y19yZW1vdmUoc3RydWN0IHRpZHNzX2RldmljZSAqdGlkc3MpOworCisjZW5kaWYKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS90aWRzcy90aWRzc19kaXNwY19yZWdzLmggYi9kcml2ZXJzL2dw
dS9kcm0vdGlkc3MvdGlkc3NfZGlzcGNfcmVncy5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4
IDAwMDAwMDAwMDAwMC4uODhhODNhNDFiNmUzCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9n
cHUvZHJtL3RpZHNzL3RpZHNzX2Rpc3BjX3JlZ3MuaApAQCAtMCwwICsxLDI0MyBAQAorLyogU1BE
WC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAgKi8KKy8qCisgKiBDb3B5cmlnaHQgKEMpIDIw
MTYtMjAxOCBUZXhhcyBJbnN0cnVtZW50cyBJbmNvcnBvcmF0ZWQgLSBodHRwOi8vd3d3LnRpLmNv
bS8KKyAqIEF1dGhvcjogSnlyaSBTYXJoYSA8anNhcmhhQHRpLmNvbT4KKyAqLworCisjaWZuZGVm
IF9fVElEU1NfRElTUENfUkVHU19ICisjZGVmaW5lIF9fVElEU1NfRElTUENfUkVHU19ICisKK2Vu
dW0gZGlzcGNfY29tbW9uX3JlZ3MgeworCU5PVF9BUFBMSUNBQkxFX09GRiA9IDAsCisJRFNTX1JF
VklTSU9OX09GRiwKKwlEU1NfU1lTQ09ORklHX09GRiwKKwlEU1NfU1lTU1RBVFVTX09GRiwKKwlE
SVNQQ19JUlFfRU9JX09GRiwKKwlESVNQQ19JUlFTVEFUVVNfUkFXX09GRiwKKwlESVNQQ19JUlFT
VEFUVVNfT0ZGLAorCURJU1BDX0lSUUVOQUJMRV9TRVRfT0ZGLAorCURJU1BDX0lSUUVOQUJMRV9D
TFJfT0ZGLAorCURJU1BDX1ZJRF9JUlFFTkFCTEVfT0ZGLAorCURJU1BDX1ZJRF9JUlFTVEFUVVNf
T0ZGLAorCURJU1BDX1ZQX0lSUUVOQUJMRV9PRkYsCisJRElTUENfVlBfSVJRU1RBVFVTX09GRiwK
KwlXQl9JUlFFTkFCTEVfT0ZGLAorCVdCX0lSUVNUQVRVU19PRkYsCisJRElTUENfR0xPQkFMX01G
TEFHX0FUVFJJQlVURV9PRkYsCisJRElTUENfR0xPQkFMX09VVFBVVF9FTkFCTEVfT0ZGLAorCURJ
U1BDX0dMT0JBTF9CVUZGRVJfT0ZGLAorCURTU19DQkFfQ0ZHX09GRiwKKwlESVNQQ19EQkdfQ09O
VFJPTF9PRkYsCisJRElTUENfREJHX1NUQVRVU19PRkYsCisJRElTUENfQ0xLR0FUSU5HX0RJU0FC
TEVfT0ZGLAorCURJU1BDX1NFQ1VSRV9ESVNBQkxFX09GRiwKKwlGQkRDX1JFVklTSU9OXzFfT0ZG
LAorCUZCRENfUkVWSVNJT05fMl9PRkYsCisJRkJEQ19SRVZJU0lPTl8zX09GRiwKKwlGQkRDX1JF
VklTSU9OXzRfT0ZGLAorCUZCRENfUkVWSVNJT05fNV9PRkYsCisJRkJEQ19SRVZJU0lPTl82X09G
RiwKKwlGQkRDX0NPTU1PTl9DT05UUk9MX09GRiwKKwlGQkRDX0NPTlNUQU5UX0NPTE9SXzBfT0ZG
LAorCUZCRENfQ09OU1RBTlRfQ09MT1JfMV9PRkYsCisJRElTUENfQ09OTkVDVElPTlNfT0ZGLAor
CURJU1BDX01TU19WUDFfT0ZGLAorCURJU1BDX01TU19WUDNfT0ZGLAorCURJU1BDX0NPTU1PTl9S
RUdfVEFCTEVfTEVOLAorfTsKKworLyoKKyAqIGRpc3BjX2NvbW1vbl9yZWdtYXAgc2hvdWxkIGJl
IGRlZmluZWQgYXMgY29uc3QgdTE2ICogYW5kIHBvaW50aW5nCisgKiB0byBhIHZhbGlkIGRzcyBj
b21tb24gcmVnaXN0ZXIgbWFwIGZvciB0aGUgcGxhdGZvcm0sIGJlZm9yZSB0aGUKKyAqIG1hY3Jv
cyBiZWxsb3cgY2FuIGJlIHVzZWQuCisgKi8KKworI2RlZmluZSBSRUcocikgKGRpc3BjX2NvbW1v
bl9yZWdtYXBbciAjIyBfT0ZGXSkKKworI2RlZmluZSBEU1NfUkVWSVNJT04JCQlSRUcoRFNTX1JF
VklTSU9OKQorI2RlZmluZSBEU1NfU1lTQ09ORklHCQkJUkVHKERTU19TWVNDT05GSUcpCisjZGVm
aW5lIERTU19TWVNTVEFUVVMJCQlSRUcoRFNTX1NZU1NUQVRVUykKKyNkZWZpbmUgRElTUENfSVJR
X0VPSQkJCVJFRyhESVNQQ19JUlFfRU9JKQorI2RlZmluZSBESVNQQ19JUlFTVEFUVVNfUkFXCQlS
RUcoRElTUENfSVJRU1RBVFVTX1JBVykKKyNkZWZpbmUgRElTUENfSVJRU1RBVFVTCQkJUkVHKERJ
U1BDX0lSUVNUQVRVUykKKyNkZWZpbmUgRElTUENfSVJRRU5BQkxFX1NFVAkJUkVHKERJU1BDX0lS
UUVOQUJMRV9TRVQpCisjZGVmaW5lIERJU1BDX0lSUUVOQUJMRV9DTFIJCVJFRyhESVNQQ19JUlFF
TkFCTEVfQ0xSKQorI2RlZmluZSBESVNQQ19WSURfSVJRRU5BQkxFKG4pCQkoUkVHKERJU1BDX1ZJ
RF9JUlFFTkFCTEUpICsgKG4pICogNCkKKyNkZWZpbmUgRElTUENfVklEX0lSUVNUQVRVUyhuKQkJ
KFJFRyhESVNQQ19WSURfSVJRU1RBVFVTKSArIChuKSAqIDQpCisjZGVmaW5lIERJU1BDX1ZQX0lS
UUVOQUJMRShuKQkJKFJFRyhESVNQQ19WUF9JUlFFTkFCTEUpICsgKG4pICogNCkKKyNkZWZpbmUg
RElTUENfVlBfSVJRU1RBVFVTKG4pCQkoUkVHKERJU1BDX1ZQX0lSUVNUQVRVUykgKyAobikgKiA0
KQorI2RlZmluZSBXQl9JUlFFTkFCTEUJCQlSRUcoV0JfSVJRRU5BQkxFKQorI2RlZmluZSBXQl9J
UlFTVEFUVVMJCQlSRUcoV0JfSVJRU1RBVFVTKQorCisjZGVmaW5lIERJU1BDX0dMT0JBTF9NRkxB
R19BVFRSSUJVVEUJUkVHKERJU1BDX0dMT0JBTF9NRkxBR19BVFRSSUJVVEUpCisjZGVmaW5lIERJ
U1BDX0dMT0JBTF9PVVRQVVRfRU5BQkxFCVJFRyhESVNQQ19HTE9CQUxfT1VUUFVUX0VOQUJMRSkK
KyNkZWZpbmUgRElTUENfR0xPQkFMX0JVRkZFUgkJUkVHKERJU1BDX0dMT0JBTF9CVUZGRVIpCisj
ZGVmaW5lIERTU19DQkFfQ0ZHCQkJUkVHKERTU19DQkFfQ0ZHKQorI2RlZmluZSBESVNQQ19EQkdf
Q09OVFJPTAkJUkVHKERJU1BDX0RCR19DT05UUk9MKQorI2RlZmluZSBESVNQQ19EQkdfU1RBVFVT
CQlSRUcoRElTUENfREJHX1NUQVRVUykKKyNkZWZpbmUgRElTUENfQ0xLR0FUSU5HX0RJU0FCTEUJ
CVJFRyhESVNQQ19DTEtHQVRJTkdfRElTQUJMRSkKKyNkZWZpbmUgRElTUENfU0VDVVJFX0RJU0FC
TEUJCVJFRyhESVNQQ19TRUNVUkVfRElTQUJMRSkKKworI2RlZmluZSBGQkRDX1JFVklTSU9OXzEJ
CQlSRUcoRkJEQ19SRVZJU0lPTl8xKQorI2RlZmluZSBGQkRDX1JFVklTSU9OXzIJCQlSRUcoRkJE
Q19SRVZJU0lPTl8yKQorI2RlZmluZSBGQkRDX1JFVklTSU9OXzMJCQlSRUcoRkJEQ19SRVZJU0lP
Tl8zKQorI2RlZmluZSBGQkRDX1JFVklTSU9OXzQJCQlSRUcoRkJEQ19SRVZJU0lPTl80KQorI2Rl
ZmluZSBGQkRDX1JFVklTSU9OXzUJCQlSRUcoRkJEQ19SRVZJU0lPTl81KQorI2RlZmluZSBGQkRD
X1JFVklTSU9OXzYJCQlSRUcoRkJEQ19SRVZJU0lPTl82KQorI2RlZmluZSBGQkRDX0NPTU1PTl9D
T05UUk9MCQlSRUcoRkJEQ19DT01NT05fQ09OVFJPTCkKKyNkZWZpbmUgRkJEQ19DT05TVEFOVF9D
T0xPUl8wCQlSRUcoRkJEQ19DT05TVEFOVF9DT0xPUl8wKQorI2RlZmluZSBGQkRDX0NPTlNUQU5U
X0NPTE9SXzEJCVJFRyhGQkRDX0NPTlNUQU5UX0NPTE9SXzEpCisjZGVmaW5lIERJU1BDX0NPTk5F
Q1RJT05TCQlSRUcoRElTUENfQ09OTkVDVElPTlMpCisjZGVmaW5lIERJU1BDX01TU19WUDEJCQlS
RUcoRElTUENfTVNTX1ZQMSkKKyNkZWZpbmUgRElTUENfTVNTX1ZQMwkJCVJFRyhESVNQQ19NU1Nf
VlAzKQorCisvKiBWSUQgKi8KKworI2RlZmluZSBESVNQQ19WSURfQUNDVUhfMAkJMHgwCisjZGVm
aW5lIERJU1BDX1ZJRF9BQ0NVSF8xCQkweDQKKyNkZWZpbmUgRElTUENfVklEX0FDQ1VIMl8wCQkw
eDgKKyNkZWZpbmUgRElTUENfVklEX0FDQ1VIMl8xCQkweGMKKyNkZWZpbmUgRElTUENfVklEX0FD
Q1VWXzAJCTB4MTAKKyNkZWZpbmUgRElTUENfVklEX0FDQ1VWXzEJCTB4MTQKKyNkZWZpbmUgRElT
UENfVklEX0FDQ1VWMl8wCQkweDE4CisjZGVmaW5lIERJU1BDX1ZJRF9BQ0NVVjJfMQkJMHgxYwor
I2RlZmluZSBESVNQQ19WSURfQVRUUklCVVRFUwkJMHgyMAorI2RlZmluZSBESVNQQ19WSURfQVRU
UklCVVRFUzIJCTB4MjQKKyNkZWZpbmUgRElTUENfVklEX0JBXzAJCQkweDI4CisjZGVmaW5lIERJ
U1BDX1ZJRF9CQV8xCQkJMHgyYworI2RlZmluZSBESVNQQ19WSURfQkFfVVZfMAkJMHgzMAorI2Rl
ZmluZSBESVNQQ19WSURfQkFfVVZfMQkJMHgzNAorI2RlZmluZSBESVNQQ19WSURfQlVGX1NJWkVf
U1RBVFVTCTB4MzgKKyNkZWZpbmUgRElTUENfVklEX0JVRl9USFJFU0hPTEQJCTB4M2MKKyNkZWZp
bmUgRElTUENfVklEX0NTQ19DT0VGKG4pCQkoMHg0MCArIChuKSAqIDQpCisKKyNkZWZpbmUgRElT
UENfVklEX0ZJUkgJCQkweDVjCisjZGVmaW5lIERJU1BDX1ZJRF9GSVJIMgkJCTB4NjAKKyNkZWZp
bmUgRElTUENfVklEX0ZJUlYJCQkweDY0CisjZGVmaW5lIERJU1BDX1ZJRF9GSVJWMgkJCTB4NjgK
KworI2RlZmluZSBESVNQQ19WSURfRklSX0NPRUZTX0gwCQkweDZjCisjZGVmaW5lIERJU1BDX1ZJ
RF9GSVJfQ09FRl9IMChwaGFzZSkJKDB4NmMgKyAocGhhc2UpICogNCkKKyNkZWZpbmUgRElTUENf
VklEX0ZJUl9DT0VGU19IMF9DCTB4OTAKKyNkZWZpbmUgRElTUENfVklEX0ZJUl9DT0VGX0gwX0Mo
cGhhc2UpCSgweDkwICsgKHBoYXNlKSAqIDQpCisKKyNkZWZpbmUgRElTUENfVklEX0ZJUl9DT0VG
U19IMTIJCTB4YjQKKyNkZWZpbmUgRElTUENfVklEX0ZJUl9DT0VGX0gxMihwaGFzZSkJKDB4YjQg
KyAocGhhc2UpICogNCkKKyNkZWZpbmUgRElTUENfVklEX0ZJUl9DT0VGU19IMTJfQwkweGY0Cisj
ZGVmaW5lIERJU1BDX1ZJRF9GSVJfQ09FRl9IMTJfQyhwaGFzZSkJKDB4ZjQgKyAocGhhc2UpICog
NCkKKworI2RlZmluZSBESVNQQ19WSURfRklSX0NPRUZTX1YwCQkweDEzNAorI2RlZmluZSBESVNQ
Q19WSURfRklSX0NPRUZfVjAocGhhc2UpCSgweDEzNCArIChwaGFzZSkgKiA0KQorI2RlZmluZSBE
SVNQQ19WSURfRklSX0NPRUZTX1YwX0MJMHgxNTgKKyNkZWZpbmUgRElTUENfVklEX0ZJUl9DT0VG
X1YwX0MocGhhc2UpCSgweDE1OCArIChwaGFzZSkgKiA0KQorCisjZGVmaW5lIERJU1BDX1ZJRF9G
SVJfQ09FRlNfVjEyCQkweDE3YworI2RlZmluZSBESVNQQ19WSURfRklSX0NPRUZfVjEyKHBoYXNl
KQkoMHgxN2MgKyAocGhhc2UpICogNCkKKyNkZWZpbmUgRElTUENfVklEX0ZJUl9DT0VGU19WMTJf
QwkweDFiYworI2RlZmluZSBESVNQQ19WSURfRklSX0NPRUZfVjEyX0MocGhhc2UpCSgweDFiYyAr
IChwaGFzZSkgKiA0KQorCisjZGVmaW5lIERJU1BDX1ZJRF9HTE9CQUxfQUxQSEEJCTB4MWZjCisj
ZGVmaW5lIERJU1BDX1ZJRF9LMkdfSVJRRU5BQkxFCQkweDIwMCAvKiBLMkcgKi8KKyNkZWZpbmUg
RElTUENfVklEX0syR19JUlFTVEFUVVMJCTB4MjA0IC8qIEsyRyAqLworI2RlZmluZSBESVNQQ19W
SURfTUZMQUdfVEhSRVNIT0xECTB4MjA4CisjZGVmaW5lIERJU1BDX1ZJRF9QSUNUVVJFX1NJWkUJ
CTB4MjBjCisjZGVmaW5lIERJU1BDX1ZJRF9QSVhFTF9JTkMJCTB4MjEwCisjZGVmaW5lIERJU1BD
X1ZJRF9LMkdfUE9TSVRJT04JCTB4MjE0IC8qIEsyRyAqLworI2RlZmluZSBESVNQQ19WSURfUFJF
TE9BRAkJMHgyMTgKKyNkZWZpbmUgRElTUENfVklEX1JPV19JTkMJCTB4MjFjCisjZGVmaW5lIERJ
U1BDX1ZJRF9TSVpFCQkJMHgyMjAKKyNkZWZpbmUgRElTUENfVklEX0JBX0VYVF8wCQkweDIyYwor
I2RlZmluZSBESVNQQ19WSURfQkFfRVhUXzEJCTB4MjMwCisjZGVmaW5lIERJU1BDX1ZJRF9CQV9V
Vl9FWFRfMAkJMHgyMzQKKyNkZWZpbmUgRElTUENfVklEX0JBX1VWX0VYVF8xCQkweDIzOAorI2Rl
ZmluZSBESVNQQ19WSURfQ1NDX0NPRUY3CQkweDIzYworI2RlZmluZSBESVNQQ19WSURfUk9XX0lO
Q19VVgkJMHgyNDgKKyNkZWZpbmUgRElTUENfVklEX0NMVVQJCQkweDI2MAorI2RlZmluZSBESVNQ
Q19WSURfU0FGRVRZX0FUVFJJQlVURVMJMHgyYTAKKyNkZWZpbmUgRElTUENfVklEX1NBRkVUWV9D
QVBUX1NJR05BVFVSRQkweDJhNAorI2RlZmluZSBESVNQQ19WSURfU0FGRVRZX1BPU0lUSU9OCTB4
MmE4CisjZGVmaW5lIERJU1BDX1ZJRF9TQUZFVFlfUkVGX1NJR05BVFVSRQkweDJhYworI2RlZmlu
ZSBESVNQQ19WSURfU0FGRVRZX1NJWkUJCTB4MmIwCisjZGVmaW5lIERJU1BDX1ZJRF9TQUZFVFlf
TEZTUl9TRUVECTB4MmI0CisjZGVmaW5lIERJU1BDX1ZJRF9MVU1BS0VZCQkweDJiOAorI2RlZmlu
ZSBESVNQQ19WSURfRE1BX0JVRlNJWkUJCTB4MmJjIC8qIEo3MjFFICovCisKKy8qIE9WUiAqLwor
CisjZGVmaW5lIERJU1BDX09WUl9DT05GSUcJCTB4MAorI2RlZmluZSBESVNQQ19PVlJfVklSVFZQ
CQkweDQgLyogSjcyMUUgKi8KKyNkZWZpbmUgRElTUENfT1ZSX0RFRkFVTFRfQ09MT1IJCTB4OAor
I2RlZmluZSBESVNQQ19PVlJfREVGQVVMVF9DT0xPUjIJMHhjCisjZGVmaW5lIERJU1BDX09WUl9U
UkFOU19DT0xPUl9NQVgJMHgxMAorI2RlZmluZSBESVNQQ19PVlJfVFJBTlNfQ09MT1JfTUFYMgkw
eDE0CisjZGVmaW5lIERJU1BDX09WUl9UUkFOU19DT0xPUl9NSU4JMHgxOAorI2RlZmluZSBESVNQ
Q19PVlJfVFJBTlNfQ09MT1JfTUlOMgkweDFjCisjZGVmaW5lIERJU1BDX09WUl9BVFRSSUJVVEVT
KG4pCQkoMHgyMCArIChuKSAqIDQpCisjZGVmaW5lIERJU1BDX09WUl9BVFRSSUJVVEVTMihuKQko
MHgzNCArIChuKSAqIDQpIC8qIEo3MjFFICovCisvKiBWUCAqLworCisjZGVmaW5lIERJU1BDX1ZQ
X0NPTkZJRwkJCQkweDAKKyNkZWZpbmUgRElTUENfVlBfQ09OVFJPTAkJCTB4NAorI2RlZmluZSBE
SVNQQ19WUF9DU0NfQ09FRjAJCQkweDgKKyNkZWZpbmUgRElTUENfVlBfQ1NDX0NPRUYxCQkJMHhj
CisjZGVmaW5lIERJU1BDX1ZQX0NTQ19DT0VGMgkJCTB4MTAKKyNkZWZpbmUgRElTUENfVlBfREFU
QV9DWUNMRV8wCQkJMHgxNAorI2RlZmluZSBESVNQQ19WUF9EQVRBX0NZQ0xFXzEJCQkweDE4Cisj
ZGVmaW5lIERJU1BDX1ZQX0syR19HQU1NQV9UQUJMRQkJMHgyMCAvKiBLMkcgKi8KKyNkZWZpbmUg
RElTUENfVlBfSzJHX0lSUUVOQUJMRQkJCTB4M2MgLyogSzJHICovCisjZGVmaW5lIERJU1BDX1ZQ
X0syR19JUlFTVEFUVVMJCQkweDQwIC8qIEsyRyAqLworI2RlZmluZSBESVNQQ19WUF9EQVRBX0NZ
Q0xFXzIJCQkweDFjCisjZGVmaW5lIERJU1BDX1ZQX0xJTkVfTlVNQkVSCQkJMHg0NAorI2RlZmlu
ZSBESVNQQ19WUF9QT0xfRlJFUQkJCTB4NGMKKyNkZWZpbmUgRElTUENfVlBfU0laRV9TQ1JFRU4J
CQkweDUwCisjZGVmaW5lIERJU1BDX1ZQX1RJTUlOR19ICQkJMHg1NAorI2RlZmluZSBESVNQQ19W
UF9USU1JTkdfVgkJCTB4NTgKKyNkZWZpbmUgRElTUENfVlBfQ1NDX0NPRUYzCQkJMHg1YworI2Rl
ZmluZSBESVNQQ19WUF9DU0NfQ09FRjQJCQkweDYwCisjZGVmaW5lIERJU1BDX1ZQX0NTQ19DT0VG
NQkJCTB4NjQKKyNkZWZpbmUgRElTUENfVlBfQ1NDX0NPRUY2CQkJMHg2OAorI2RlZmluZSBESVNQ
Q19WUF9DU0NfQ09FRjcJCQkweDZjCisjZGVmaW5lIERJU1BDX1ZQX1NBRkVUWV9BVFRSSUJVVEVT
XzAJCTB4NzAKKyNkZWZpbmUgRElTUENfVlBfU0FGRVRZX0FUVFJJQlVURVNfMQkJMHg3NAorI2Rl
ZmluZSBESVNQQ19WUF9TQUZFVFlfQVRUUklCVVRFU18yCQkweDc4CisjZGVmaW5lIERJU1BDX1ZQ
X1NBRkVUWV9BVFRSSUJVVEVTXzMJCTB4N2MKKyNkZWZpbmUgRElTUENfVlBfU0FGRVRZX0NBUFRf
U0lHTkFUVVJFXzAJMHg5MAorI2RlZmluZSBESVNQQ19WUF9TQUZFVFlfQ0FQVF9TSUdOQVRVUkVf
MQkweDk0CisjZGVmaW5lIERJU1BDX1ZQX1NBRkVUWV9DQVBUX1NJR05BVFVSRV8yCTB4OTgKKyNk
ZWZpbmUgRElTUENfVlBfU0FGRVRZX0NBUFRfU0lHTkFUVVJFXzMJMHg5YworI2RlZmluZSBESVNQ
Q19WUF9TQUZFVFlfUE9TSVRJT05fMAkJMHhiMAorI2RlZmluZSBESVNQQ19WUF9TQUZFVFlfUE9T
SVRJT05fMQkJMHhiNAorI2RlZmluZSBESVNQQ19WUF9TQUZFVFlfUE9TSVRJT05fMgkJMHhiOAor
I2RlZmluZSBESVNQQ19WUF9TQUZFVFlfUE9TSVRJT05fMwkJMHhiYworI2RlZmluZSBESVNQQ19W
UF9TQUZFVFlfUkVGX1NJR05BVFVSRV8wCQkweGQwCisjZGVmaW5lIERJU1BDX1ZQX1NBRkVUWV9S
RUZfU0lHTkFUVVJFXzEJCTB4ZDQKKyNkZWZpbmUgRElTUENfVlBfU0FGRVRZX1JFRl9TSUdOQVRV
UkVfMgkJMHhkOAorI2RlZmluZSBESVNQQ19WUF9TQUZFVFlfUkVGX1NJR05BVFVSRV8zCQkweGRj
CisjZGVmaW5lIERJU1BDX1ZQX1NBRkVUWV9TSVpFXzAJCQkweGYwCisjZGVmaW5lIERJU1BDX1ZQ
X1NBRkVUWV9TSVpFXzEJCQkweGY0CisjZGVmaW5lIERJU1BDX1ZQX1NBRkVUWV9TSVpFXzIJCQkw
eGY4CisjZGVmaW5lIERJU1BDX1ZQX1NBRkVUWV9TSVpFXzMJCQkweGZjCisjZGVmaW5lIERJU1BD
X1ZQX1NBRkVUWV9MRlNSX1NFRUQJCTB4MTEwCisjZGVmaW5lIERJU1BDX1ZQX0dBTU1BX1RBQkxF
CQkJMHgxMjAKKyNkZWZpbmUgRElTUENfVlBfRFNTX09MRElfQ0ZHCQkJMHgxNjAKKyNkZWZpbmUg
RElTUENfVlBfRFNTX09MRElfU1RBVFVTCQkweDE2NAorI2RlZmluZSBESVNQQ19WUF9EU1NfT0xE
SV9MQgkJCTB4MTY4CisjZGVmaW5lIERJU1BDX1ZQX0RTU19NRVJHRV9TUExJVAkJMHgxNmMgLyog
SjcyMUUgKi8KKyNkZWZpbmUgRElTUENfVlBfRFNTX0RNQV9USFJFQURTSVpFCQkweDE3MCAvKiBK
NzIxRSAqLworI2RlZmluZSBESVNQQ19WUF9EU1NfRE1BX1RIUkVBRFNJWkVfU1RBVFVTCTB4MTc0
IC8qIEo3MjFFICovCisKKy8qCisgKiBPTERJIElPX0NUUkwgcmVnaXN0ZXIgb2Zmc2V0cy4gT24g
QU02NTQgdGhlIHJlZ2lzdGVycyBhcmUgZm91bmQKKyAqIGZyb20gQ1RSTF9NTVIwLCB0aGVyZSB0
aGUgc3lzY29uIHJlZ21hcCBzaG91bGQgbWFwIDB4MTQgYnl0ZXMgZnJvbQorICogQ1RSTE1NUjBQ
MV9PTERJX0RBVDBfSU9fQ1RSTCB0byBDVFJMTU1SMFAxX09MRElfQ0xLX0lPX0NUUkwKKyAqIHJl
Z2lzdGVyIHJhbmdlLgorICovCisjZGVmaW5lIE9MRElfREFUMF9JT19DVFJMCQkJMHgwMAorI2Rl
ZmluZSBPTERJX0RBVDFfSU9fQ1RSTAkJCTB4MDQKKyNkZWZpbmUgT0xESV9EQVQyX0lPX0NUUkwJ
CQkweDA4CisjZGVmaW5lIE9MRElfREFUM19JT19DVFJMCQkJMHgwQworI2RlZmluZSBPTERJX0NM
S19JT19DVFJMCQkJMHgxMAorCisjZGVmaW5lIE9MRElfUFdSRE5fVFgJCQkJQklUKDgpCisKKyNl
bmRpZiAvKiBfX1RJRFNTX0RJU1BDX1JFR1NfSCAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL3RpZHNzL3RpZHNzX2Rydi5jIGIvZHJpdmVycy9ncHUvZHJtL3RpZHNzL3RpZHNzX2Rydi5j
Cm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uYmExM2I1MzAyMTRmCi0t
LSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL3RpZHNzL3RpZHNzX2Rydi5jCkBAIC0w
LDAgKzEsMjkyIEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAorLyoKKyAq
IENvcHlyaWdodCAoQykgMjAxOCBUZXhhcyBJbnN0cnVtZW50cyBJbmNvcnBvcmF0ZWQgLSBodHRw
Oi8vd3d3LnRpLmNvbS8KKyAqIEF1dGhvcjogVG9taSBWYWxrZWluZW4gPHRvbWkudmFsa2VpbmVu
QHRpLmNvbT4KKyAqLworCisjaW5jbHVkZSA8bGludXgvY29uc29sZS5oPgorI2luY2x1ZGUgPGxp
bnV4L29mX2RldmljZS5oPgorI2luY2x1ZGUgPGxpbnV4L3BtX3J1bnRpbWUuaD4KKworI2luY2x1
ZGUgPGRybS9kcm1QLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWMuaD4KKyNpbmNsdWRlIDxk
cm0vZHJtX2F0b21pY19oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2NydGMuaD4KKyNpbmNs
dWRlIDxkcm0vZHJtX2NydGNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9mYl9oZWxwZXIu
aD4KKyNpbmNsdWRlIDxkcm0vZHJtX2dlbV9jbWFfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2Ry
bV9wcm9iZV9oZWxwZXIuaD4KKworI2luY2x1ZGUgInRpZHNzX2Rpc3BjLmgiCisjaW5jbHVkZSAi
dGlkc3NfZHJ2LmgiCisjaW5jbHVkZSAidGlkc3Nfa21zLmgiCisjaW5jbHVkZSAidGlkc3NfaXJx
LmgiCisKKy8qIFBvd2VyIG1hbmFnZW1lbnQgKi8KKworaW50IHRpZHNzX3J1bnRpbWVfZ2V0KHN0
cnVjdCB0aWRzc19kZXZpY2UgKnRpZHNzKQoreworCWludCByOworCisJZGV2X2RiZyh0aWRzcy0+
ZGV2LCAiJXNcbiIsIF9fZnVuY19fKTsKKworCXIgPSBwbV9ydW50aW1lX2dldF9zeW5jKHRpZHNz
LT5kZXYpOworCVdBUk5fT04ociA8IDApOworCXJldHVybiByIDwgMCA/IHIgOiAwOworfQorCit2
b2lkIHRpZHNzX3J1bnRpbWVfcHV0KHN0cnVjdCB0aWRzc19kZXZpY2UgKnRpZHNzKQoreworCWlu
dCByOworCisJZGV2X2RiZyh0aWRzcy0+ZGV2LCAiJXNcbiIsIF9fZnVuY19fKTsKKworCXIgPSBw
bV9ydW50aW1lX3B1dF9zeW5jKHRpZHNzLT5kZXYpOworCVdBUk5fT04ociA8IDApOworfQorCisj
aWZkZWYgQ09ORklHX1BNCisKK3N0YXRpYyBpbnQgdGlkc3NfcG1fcnVudGltZV9zdXNwZW5kKHN0
cnVjdCBkZXZpY2UgKmRldikKK3sKKwlzdHJ1Y3QgdGlkc3NfZGV2aWNlICp0aWRzcyA9IGRldl9n
ZXRfZHJ2ZGF0YShkZXYpOworCisJZGV2X2RiZyhkZXYsICIlc1xuIiwgX19mdW5jX18pOworCisJ
cmV0dXJuIGRpc3BjX3J1bnRpbWVfc3VzcGVuZCh0aWRzcy0+ZGlzcGMpOworfQorCitzdGF0aWMg
aW50IHRpZHNzX3BtX3J1bnRpbWVfcmVzdW1lKHN0cnVjdCBkZXZpY2UgKmRldikKK3sKKwlzdHJ1
Y3QgdGlkc3NfZGV2aWNlICp0aWRzcyA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOworCWludCByOwor
CisJZGV2X2RiZyhkZXYsICIlc1xuIiwgX19mdW5jX18pOworCisJciA9IGRpc3BjX3J1bnRpbWVf
cmVzdW1lKHRpZHNzLT5kaXNwYyk7CisJaWYgKHIpCisJCXJldHVybiByOworCisJcmV0dXJuIDA7
Cit9CisKKyNpZmRlZiBDT05GSUdfUE1fU0xFRVAKK3N0YXRpYyBpbnQgdGlkc3Nfc3VzcGVuZChz
dHJ1Y3QgZGV2aWNlICpkZXYpCit7CisJc3RydWN0IHRpZHNzX2RldmljZSAqdGlkc3MgPSBkZXZf
Z2V0X2RydmRhdGEoZGV2KTsKKworCWRldl9kYmcoZGV2LCAiJXNcbiIsIF9fZnVuY19fKTsKKwor
CXJldHVybiBkcm1fbW9kZV9jb25maWdfaGVscGVyX3N1c3BlbmQodGlkc3MtPmRkZXYpOworfQor
CitzdGF0aWMgaW50IHRpZHNzX3Jlc3VtZShzdHJ1Y3QgZGV2aWNlICpkZXYpCit7CisJc3RydWN0
IHRpZHNzX2RldmljZSAqdGlkc3MgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKKworCWRldl9kYmco
ZGV2LCAiJXNcbiIsIF9fZnVuY19fKTsKKworCXJldHVybiBkcm1fbW9kZV9jb25maWdfaGVscGVy
X3Jlc3VtZSh0aWRzcy0+ZGRldik7Cit9CisjZW5kaWYgLyogQ09ORklHX1BNX1NMRUVQICovCisK
K3N0YXRpYyBjb25zdCBzdHJ1Y3QgZGV2X3BtX29wcyB0aWRzc19wbV9vcHMgPSB7CisJLnJ1bnRp
bWVfc3VzcGVuZCA9IHRpZHNzX3BtX3J1bnRpbWVfc3VzcGVuZCwKKwkucnVudGltZV9yZXN1bWUg
PSB0aWRzc19wbV9ydW50aW1lX3Jlc3VtZSwKKwlTRVRfU1lTVEVNX1NMRUVQX1BNX09QUyh0aWRz
c19zdXNwZW5kLCB0aWRzc19yZXN1bWUpCit9OworCisjZW5kaWYgLyogQ09ORklHX1BNICovCisK
Ky8qIFBsYXRmb3JtIGRyaXZlciAqLworCisvKiBEUk0gZGV2aWNlIEluZm9ybWF0aW9uICovCitE
RUZJTkVfRFJNX0dFTV9DTUFfRk9QUyh0aWRzc19mb3BzKTsKKworc3RhdGljIHN0cnVjdCBkcm1f
ZHJpdmVyIHRpZHNzX2RyaXZlciA9IHsKKwkuZHJpdmVyX2ZlYXR1cmVzCT0gRFJJVkVSX0dFTSB8
IERSSVZFUl9NT0RFU0VUIHwgRFJJVkVSX0FUT01JQyB8CisJCQkJCURSSVZFUl9IQVZFX0lSUSwK
KwkuZ2VtX2ZyZWVfb2JqZWN0X3VubG9ja2VkID0gZHJtX2dlbV9jbWFfZnJlZV9vYmplY3QsCisJ
LmdlbV92bV9vcHMJCT0gJmRybV9nZW1fY21hX3ZtX29wcywKKwkucHJpbWVfaGFuZGxlX3RvX2Zk
CT0gZHJtX2dlbV9wcmltZV9oYW5kbGVfdG9fZmQsCisJLnByaW1lX2ZkX3RvX2hhbmRsZQk9IGRy
bV9nZW1fcHJpbWVfZmRfdG9faGFuZGxlLAorCS5nZW1fcHJpbWVfaW1wb3J0CT0gZHJtX2dlbV9w
cmltZV9pbXBvcnQsCisJLmdlbV9wcmltZV9leHBvcnQJPSBkcm1fZ2VtX3ByaW1lX2V4cG9ydCwK
KwkuZ2VtX3ByaW1lX2dldF9zZ190YWJsZQk9IGRybV9nZW1fY21hX3ByaW1lX2dldF9zZ190YWJs
ZSwKKwkuZ2VtX3ByaW1lX2ltcG9ydF9zZ190YWJsZSA9IGRybV9nZW1fY21hX3ByaW1lX2ltcG9y
dF9zZ190YWJsZSwKKwkuZ2VtX3ByaW1lX3ZtYXAJCT0gZHJtX2dlbV9jbWFfcHJpbWVfdm1hcCwK
KwkuZ2VtX3ByaW1lX3Z1bm1hcAk9IGRybV9nZW1fY21hX3ByaW1lX3Z1bm1hcCwKKwkuZ2VtX3By
aW1lX21tYXAJCT0gZHJtX2dlbV9jbWFfcHJpbWVfbW1hcCwKKwkuZHVtYl9jcmVhdGUJCT0gZHJt
X2dlbV9jbWFfZHVtYl9jcmVhdGUsCisJLmZvcHMJCQk9ICZ0aWRzc19mb3BzLAorCS5uYW1lCQkJ
PSAidGlkc3MiLAorCS5kZXNjCQkJPSAiVEkgS2V5c3RvbmUgRFNTIiwKKwkuZGF0ZQkJCT0gIjIw
MTgwMjE1IiwKKwkubWFqb3IJCQk9IDEsCisJLm1pbm9yCQkJPSAwLAorCisJLmlycV9wcmVpbnN0
YWxsCQk9IHRpZHNzX2lycV9wcmVpbnN0YWxsLAorCS5pcnFfcG9zdGluc3RhbGwJPSB0aWRzc19p
cnFfcG9zdGluc3RhbGwsCisJLmlycV9oYW5kbGVyCQk9IHRpZHNzX2lycV9oYW5kbGVyLAorCS5p
cnFfdW5pbnN0YWxsCQk9IHRpZHNzX2lycV91bmluc3RhbGwsCit9OworCitzdGF0aWMgaW50IHRp
ZHNzX3Byb2JlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpCit7CisJc3RydWN0IGRldmlj
ZSAqZGV2ID0gJnBkZXYtPmRldjsKKwlzdHJ1Y3QgdGlkc3NfZGV2aWNlICp0aWRzczsKKwlzdHJ1
Y3QgZHJtX2RldmljZSAqZGRldjsKKwlpbnQgcmV0OworCWludCBpcnE7CisKKwlkZXZfZGJnKGRl
diwgIiVzXG4iLCBfX2Z1bmNfXyk7CisKKwl0aWRzcyA9IGRldm1fa3phbGxvYyhkZXYsIHNpemVv
ZigqdGlkc3MpLCBHRlBfS0VSTkVMKTsKKwlpZiAodGlkc3MgPT0gTlVMTCkKKwkJcmV0dXJuIC1F
Tk9NRU07CisKKwl0aWRzcy0+ZGV2ID0gZGV2OworCXRpZHNzLT5mZWF0ID0gb2ZfZGV2aWNlX2dl
dF9tYXRjaF9kYXRhKGRldik7CisKKwlwbGF0Zm9ybV9zZXRfZHJ2ZGF0YShwZGV2LCB0aWRzcyk7
CisKKwlkZGV2ID0gZHJtX2Rldl9hbGxvYygmdGlkc3NfZHJpdmVyLCBkZXYpOworCWlmIChJU19F
UlIoZGRldikpCisJCXJldHVybiBQVFJfRVJSKGRkZXYpOworCisJdGlkc3MtPmRkZXYgPSBkZGV2
OworCWRkZXYtPmRldl9wcml2YXRlID0gdGlkc3M7CisKKwlwbV9ydW50aW1lX2VuYWJsZShkZXYp
OworCisJcmV0ID0gZGlzcGNfaW5pdCh0aWRzcyk7CisJaWYgKHJldCkgeworCQlkZXZfZXJyKGRl
diwgImZhaWxlZCB0byBpbml0aWFsaXplIGRpc3BjOiAlZFxuIiwgcmV0KTsKKwkJZ290byBlcnJf
ZGlzYWJsZV9wbTsKKwl9CisKKyNpZm5kZWYgQ09ORklHX1BNCisJLyogSWYgd2UgZG9uJ3QgaGF2
ZSBQTSwgd2UgbmVlZCB0byBjYWxsIHJlc3VtZSBtYW51YWxseSAqLworCWRpc3BjX3J1bnRpbWVf
cmVzdW1lKHRpZHNzLT5kaXNwYyk7CisjZW5kaWYKKworCXJldCA9IHRpZHNzX21vZGVzZXRfaW5p
dCh0aWRzcyk7CisJaWYgKHJldCA8IDApIHsKKwkJaWYgKHJldCAhPSAtRVBST0JFX0RFRkVSKQor
CQkJZGV2X2VycihkZXYsICJmYWlsZWQgdG8gaW5pdCBEUk0vS01TICglZClcbiIsIHJldCk7CisJ
CWdvdG8gZXJyX3J1bnRpbWVfc3VzcGVuZDsKKwl9CisKKwlpcnEgPSBwbGF0Zm9ybV9nZXRfaXJx
KHBkZXYsIDApOworCWlmIChpcnEgPCAwKSB7CisJCXJldCA9IGlycTsKKwkJZ290byBlcnJfbW9k
ZXNldF9jbGVhbnVwOworCX0KKworCXJldCA9IGRybV9pcnFfaW5zdGFsbChkZGV2LCBpcnEpOwor
CWlmIChyZXQpIHsKKwkJZGV2X2VycihkZXYsICJkcm1faXJxX2luc3RhbGwgZmFpbGVkOiAlZFxu
IiwgcmV0KTsKKwkJZ290byBlcnJfbW9kZXNldF9jbGVhbnVwOworCX0KKworCWRybV9rbXNfaGVs
cGVyX3BvbGxfaW5pdChkZGV2KTsKKworCXJldCA9IGRybV9kZXZfcmVnaXN0ZXIoZGRldiwgMCk7
CisJaWYgKHJldCkgeworCQlkZXZfZXJyKGRldiwgImZhaWxlZCB0byByZWdpc3RlciBEUk0gZGV2
aWNlXG4iKTsKKwkJZ290byBlcnJfcG9sbF9maW5pOworCX0KKworCWRybV9mYmRldl9nZW5lcmlj
X3NldHVwKGRkZXYsIDMyKTsKKworCWRldl9kYmcoZGV2LCAiJXMgZG9uZVxuIiwgX19mdW5jX18p
OworCisJcmV0dXJuIDA7CisKK2Vycl9wb2xsX2Zpbmk6CisJZHJtX2ttc19oZWxwZXJfcG9sbF9m
aW5pKGRkZXYpOworCisJZHJtX2F0b21pY19oZWxwZXJfc2h1dGRvd24oZGRldik7CisKKwlkcm1f
aXJxX3VuaW5zdGFsbChkZGV2KTsKKworZXJyX21vZGVzZXRfY2xlYW51cDoKKwl0aWRzc19tb2Rl
c2V0X2NsZWFudXAodGlkc3MpOworCitlcnJfcnVudGltZV9zdXNwZW5kOgorI2lmbmRlZiBDT05G
SUdfUE0KKwkvKiBJZiB3ZSBkb24ndCBoYXZlIFBNLCB3ZSBuZWVkIHRvIGNhbGwgc3VzcGVuZCBt
YW51YWxseSAqLworCWRpc3BjX3J1bnRpbWVfc3VzcGVuZCh0aWRzcy0+ZGlzcGMpOworI2VuZGlm
CisKKwlkaXNwY19yZW1vdmUodGlkc3MpOworCitlcnJfZGlzYWJsZV9wbToKKwlwbV9ydW50aW1l
X2Rpc2FibGUoZGV2KTsKKworCWRybV9kZXZfcHV0KGRkZXYpOworCisJcmV0dXJuIHJldDsKK30K
Kworc3RhdGljIGludCB0aWRzc19yZW1vdmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikK
K3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmcGRldi0+ZGV2OworCXN0cnVjdCB0aWRzc19kZXZp
Y2UgKnRpZHNzID0gcGxhdGZvcm1fZ2V0X2RydmRhdGEocGRldik7CisJc3RydWN0IGRybV9kZXZp
Y2UgKmRkZXYgPSB0aWRzcy0+ZGRldjsKKworCWRldl9kYmcoZGV2LCAiJXNcbiIsIF9fZnVuY19f
KTsKKworCWRybV9kZXZfdW5yZWdpc3RlcihkZGV2KTsKKworCWRybV9rbXNfaGVscGVyX3BvbGxf
ZmluaShkZGV2KTsKKworCWRybV9hdG9taWNfaGVscGVyX3NodXRkb3duKGRkZXYpOworCisJZHJt
X2lycV91bmluc3RhbGwoZGRldik7CisKKwl0aWRzc19tb2Rlc2V0X2NsZWFudXAodGlkc3MpOwor
CisjaWZuZGVmIENPTkZJR19QTQorCS8qIElmIHdlIGRvbid0IGhhdmUgUE0sIHdlIG5lZWQgdG8g
Y2FsbCBzdXNwZW5kIG1hbnVhbGx5ICovCisJZGlzcGNfcnVudGltZV9zdXNwZW5kKHRpZHNzLT5k
aXNwYyk7CisjZW5kaWYKKworCWRpc3BjX3JlbW92ZSh0aWRzcyk7CisKKwlwbV9ydW50aW1lX2Rp
c2FibGUoZGV2KTsKKworCWRybV9kZXZfcHV0KGRkZXYpOworCisJZGV2X2RiZyhkZXYsICIlcyBk
b25lXG4iLCBfX2Z1bmNfXyk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVj
dCBvZl9kZXZpY2VfaWQgdGlkc3Nfb2ZfdGFibGVbXSA9IHsKKwl7IC5jb21wYXRpYmxlID0gInRp
LGsyZy1kc3MiLCAuZGF0YSA9ICZkaXNwY19rMmdfZmVhdHMsIH0sCisJeyAuY29tcGF0aWJsZSA9
ICJ0aSxhbTY1eC1kc3MiLCAuZGF0YSA9ICZkaXNwY19hbTY1eF9mZWF0cywgfSwKKwl7IC5jb21w
YXRpYmxlID0gInRpLGo3MjFlLWRzcyIsIC5kYXRhID0gJmRpc3BjX2o3MjFlX2ZlYXRzLCB9LAor
CXsgfQorfTsKKworTU9EVUxFX0RFVklDRV9UQUJMRShvZiwgdGlkc3Nfb2ZfdGFibGUpOworCitz
dGF0aWMgc3RydWN0IHBsYXRmb3JtX2RyaXZlciB0aWRzc19wbGF0Zm9ybV9kcml2ZXIgPSB7CisJ
LnByb2JlCQk9IHRpZHNzX3Byb2JlLAorCS5yZW1vdmUJCT0gdGlkc3NfcmVtb3ZlLAorCS5kcml2
ZXIJCT0geworCQkubmFtZQk9ICJ0aWRzcyIsCisjaWZkZWYgQ09ORklHX1BNCisJCS5wbQk9ICZ0
aWRzc19wbV9vcHMsCisjZW5kaWYKKwkJLm9mX21hdGNoX3RhYmxlID0gdGlkc3Nfb2ZfdGFibGUs
CisJCS5zdXBwcmVzc19iaW5kX2F0dHJzID0gdHJ1ZSwKKwl9LAorfTsKKworbW9kdWxlX3BsYXRm
b3JtX2RyaXZlcih0aWRzc19wbGF0Zm9ybV9kcml2ZXIpOworCitNT0RVTEVfQVVUSE9SKCJUb21p
IFZhbGtlaW5lbiA8dG9taS52YWxrZWluZW5AdGkuY29tPiIpOworTU9EVUxFX0RFU0NSSVBUSU9O
KCJUSSBLZXlzdG9uZSBEU1MgRHJpdmVyIik7CitNT0RVTEVfTElDRU5TRSgiR1BMIHYyIik7CmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdGlkc3MvdGlkc3NfZHJ2LmggYi9kcml2ZXJzL2dw
dS9kcm0vdGlkc3MvdGlkc3NfZHJ2LmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MDAwMDAwLi5lZjgxNWM4NDBiNDQKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
dGlkc3MvdGlkc3NfZHJ2LmgKQEAgLTAsMCArMSw0MiBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50
aWZpZXI6IEdQTC0yLjAgKi8KKy8qCisgKiBDb3B5cmlnaHQgKEMpIDIwMTggVGV4YXMgSW5zdHJ1
bWVudHMgSW5jb3Jwb3JhdGVkIC0gaHR0cDovL3d3dy50aS5jb20vCisgKiBBdXRob3I6IFRvbWkg
VmFsa2VpbmVuIDx0b21pLnZhbGtlaW5lbkB0aS5jb20+CisgKi8KKworI2lmbmRlZiBfX1RJRFNT
X0RSVl9IX18KKyNkZWZpbmUgX19USURTU19EUlZfSF9fCisKKyNpbmNsdWRlIDxsaW51eC9zcGlu
bG9jay5oPgorCisjZGVmaW5lIFRJRFNTX01BWF9QT1JUUyA0CisjZGVmaW5lIFRJRFNTX01BWF9Q
TEFORVMgNAorCit0eXBlZGVmIHUzMiBkaXNwY19pcnFfdDsKKworc3RydWN0IHRpZHNzX2Rldmlj
ZSB7CisJc3RydWN0IGRldmljZSAqZGV2OwkJLyogVW5kZXJseWluZyBEU1MgZGV2aWNlICovCisJ
c3RydWN0IGRybV9kZXZpY2UgKmRkZXY7CS8qIERSTSBkZXZpY2UgZm9yIERTUyAqLworCisJc3Ry
dWN0IGRybV9mYmRldl9jbWEgKmZiZGV2OworCisJY29uc3Qgc3RydWN0IGRpc3BjX2ZlYXR1cmVz
ICpmZWF0OworCXN0cnVjdCBkaXNwY19kZXZpY2UgKmRpc3BjOworCisJdW5zaWduZWQgaW50IG51
bV9jcnRjczsKKwlzdHJ1Y3QgZHJtX2NydGMgKmNydGNzW1RJRFNTX01BWF9QT1JUU107CisKKwl1
bnNpZ25lZCBpbnQgbnVtX3BsYW5lczsKKwlzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZXNbVElEU1Nf
TUFYX1BMQU5FU107CisKKwlzcGlubG9ja190IHdhaXRfbG9jazsJLyogcHJvdGVjdHMgdGhlIGly
cSBtYXNrcyAqLworCWRpc3BjX2lycV90IGlycV9tYXNrOwkvKiBlbmFibGVkIGlycXMgaW4gYWRk
aXRpb24gdG8gd2FpdF9saXN0ICovCisJZGlzcGNfaXJxX3QgaXJxX3VmX21hc2s7IC8qIHVuZGVy
ZmxvdyBpcnEgYml0cyBmb3IgYWxsIHBsYW5lcyAqLworCisJc3RydWN0IGRybV9hdG9taWNfc3Rh
dGUgKnNhdmVkX3N0YXRlOworfTsKKworaW50IHRpZHNzX3J1bnRpbWVfZ2V0KHN0cnVjdCB0aWRz
c19kZXZpY2UgKnRpZHNzKTsKK3ZvaWQgdGlkc3NfcnVudGltZV9wdXQoc3RydWN0IHRpZHNzX2Rl
dmljZSAqdGlkc3MpOworCisjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90aWRz
cy90aWRzc19lbmNvZGVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vdGlkc3MvdGlkc3NfZW5jb2Rlci5j
Cm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uNzM5MGMwNTZiMjU3Ci0t
LSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL3RpZHNzL3RpZHNzX2VuY29kZXIuYwpA
QCAtMCwwICsxLDg5IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAorLyoK
KyAqIENvcHlyaWdodCAoQykgMjAxOCBUZXhhcyBJbnN0cnVtZW50cyBJbmNvcnBvcmF0ZWQgLSBo
dHRwOi8vd3d3LnRpLmNvbS8KKyAqIEF1dGhvcjogVG9taSBWYWxrZWluZW4gPHRvbWkudmFsa2Vp
bmVuQHRpLmNvbT4KKyAqLworCisjaW5jbHVkZSA8bGludXgvZXhwb3J0Lmg+CisKKyNpbmNsdWRl
IDxkcm0vZHJtUC5oPgorI2luY2x1ZGUgPGRybS9kcm1fY3J0Yy5oPgorI2luY2x1ZGUgPGRybS9k
cm1fY3J0Y19oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3BhbmVsLmg+CisjaW5jbHVkZSA8
ZHJtL2RybV9vZi5oPgorCisjaW5jbHVkZSAidGlkc3NfZHJ2LmgiCisjaW5jbHVkZSAidGlkc3Nf
ZW5jb2Rlci5oIgorI2luY2x1ZGUgInRpZHNzX2NydGMuaCIKKworc3RhdGljIGludCB0aWRzc19l
bmNvZGVyX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIsCisJCQkJICAg
ICAgc3RydWN0IGRybV9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAorCQkJCSAgICAgIHN0cnVjdCBk
cm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQoreworCXN0cnVjdCBkcm1fZGV2aWNlICpk
ZGV2ID0gZW5jb2Rlci0+ZGV2OworCXN0cnVjdCB0aWRzc19jcnRjX3N0YXRlICp0Y3J0Y19zdGF0
ZSA9IHRvX3RpZHNzX2NydGNfc3RhdGUoY3J0Y19zdGF0ZSk7CisJc3RydWN0IGRybV9kaXNwbGF5
X2luZm8gKmRpID0gJmNvbm5fc3RhdGUtPmNvbm5lY3Rvci0+ZGlzcGxheV9pbmZvOworCXN0cnVj
dCBkcm1fYnJpZGdlICpicmlkZ2U7CisJYm9vbCBidXNfZmxhZ3Nfc2V0ID0gZmFsc2U7CisKKwlk
ZXZfZGJnKGRkZXYtPmRldiwgIiVzXG4iLCBfX2Z1bmNfXyk7CisKKwkvKgorCSAqIFRha2UgdGhl
IGJ1c19mbGFncyBmcm9tIHRoZSBmaXJzdCBicmlkZ2UgdGhhdCBkZWZpbmVzCisJICogYnJpZGdl
IHRpbWluZ3MsIG9yIGZyb20gdGhlIGNvbm5lY3RvcidzIGRpc3BsYXlfaW5mbyBpZiBubworCSAq
IGJyaWRnZSBkZWZpbmVzIHRoZSB0aW1pbmdzLgorCSAqLworCWZvciAoYnJpZGdlID0gZW5jb2Rl
ci0+YnJpZGdlOyBicmlkZ2U7IGJyaWRnZSA9IGJyaWRnZS0+bmV4dCkgeworCQlpZiAoIWJyaWRn
ZS0+dGltaW5ncykKKwkJCWNvbnRpbnVlOworCisJCXRjcnRjX3N0YXRlLT5idXNfZmxhZ3MgPSBi
cmlkZ2UtPnRpbWluZ3MtPmlucHV0X2J1c19mbGFnczsKKwkJYnVzX2ZsYWdzX3NldCA9IHRydWU7
CisJCWJyZWFrOworCX0KKworCWlmICghZGktPmJ1c19mb3JtYXRzIHx8IGRpLT5udW1fYnVzX2Zv
cm1hdHMgPT0gMCkgIHsKKwkJZGV2X2VycihkZGV2LT5kZXYsICIlczogTm8gYnVzX2Zvcm1hdHMg
aW4gY29ubmVjdGVkIGRpc3BsYXlcbiIsCisJCQlfX2Z1bmNfXyk7CisJCXJldHVybiAtRUlOVkFM
OworCX0KKworCS8vIFhYWCBhbnkgY2xlYW5lciB3YXkgdG8gc2V0IGJ1cyBmb3JtYXQgYW5kIGZs
YWdzPworCXRjcnRjX3N0YXRlLT5idXNfZm9ybWF0ID0gZGktPmJ1c19mb3JtYXRzWzBdOworCWlm
ICghYnVzX2ZsYWdzX3NldCkKKwkJdGNydGNfc3RhdGUtPmJ1c19mbGFncyA9IGRpLT5idXNfZmxh
Z3M7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZW5jb2Rlcl9o
ZWxwZXJfZnVuY3MgZW5jb2Rlcl9oZWxwZXJfZnVuY3MgPSB7CisJLmF0b21pY19jaGVjayA9IHRp
ZHNzX2VuY29kZXJfYXRvbWljX2NoZWNrLAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1f
ZW5jb2Rlcl9mdW5jcyBlbmNvZGVyX2Z1bmNzID0geworCS5kZXN0cm95ID0gZHJtX2VuY29kZXJf
Y2xlYW51cCwKK307CisKK3N0cnVjdCBkcm1fZW5jb2RlciAqdGlkc3NfZW5jb2Rlcl9jcmVhdGUo
c3RydWN0IHRpZHNzX2RldmljZSAqdGlkc3MsCisJCQkJCSB1MzIgZW5jb2Rlcl90eXBlLCB1MzIg
cG9zc2libGVfY3J0Y3MpCit7CisJc3RydWN0IGRybV9lbmNvZGVyICplbmM7CisJaW50IHJldDsK
KworCWVuYyA9IGRldm1fa3phbGxvYyh0aWRzcy0+ZGV2LCBzaXplb2YoKmVuYyksIEdGUF9LRVJO
RUwpOworCWlmICghZW5jKQorCQlyZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKKworCWVuYy0+cG9z
c2libGVfY3J0Y3MgPSBwb3NzaWJsZV9jcnRjczsKKworCXJldCA9IGRybV9lbmNvZGVyX2luaXQo
dGlkc3MtPmRkZXYsIGVuYywgJmVuY29kZXJfZnVuY3MsCisJCQkgICAgICAgZW5jb2Rlcl90eXBl
LCBOVUxMKTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0dXJuIEVSUl9QVFIocmV0KTsKKworCWRybV9l
bmNvZGVyX2hlbHBlcl9hZGQoZW5jLCAmZW5jb2Rlcl9oZWxwZXJfZnVuY3MpOworCisJZGV2X2Ri
Zyh0aWRzcy0+ZGV2LCAiRW5jb2RlciBjcmVhdGUgZG9uZVxuIik7CisKKwlyZXR1cm4gZW5jOwor
fQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3RpZHNzL3RpZHNzX2VuY29kZXIuaCBiL2Ry
aXZlcnMvZ3B1L2RybS90aWRzcy90aWRzc19lbmNvZGVyLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQK
aW5kZXggMDAwMDAwMDAwMDAwLi4wNjg1NGQ2NmU3ZTYKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2
ZXJzL2dwdS9kcm0vdGlkc3MvdGlkc3NfZW5jb2Rlci5oCkBAIC0wLDAgKzEsMTcgQEAKKy8qIFNQ
RFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovCisvKgorICogQ29weXJpZ2h0IChDKSAy
MDE4IFRleGFzIEluc3RydW1lbnRzIEluY29ycG9yYXRlZCAtIGh0dHA6Ly93d3cudGkuY29tLwor
ICogQXV0aG9yOiBUb21pIFZhbGtlaW5lbiA8dG9taS52YWxrZWluZW5AdGkuY29tPgorICovCisK
KyNpZm5kZWYgX19USURTU19FTkNPREVSX0hfXworI2RlZmluZSBfX1RJRFNTX0VOQ09ERVJfSF9f
CisKKyNpbmNsdWRlIDxkcm0vZHJtX2VuY29kZXIuaD4KKworc3RydWN0IHRpZHNzX2RldmljZTsK
Kworc3RydWN0IGRybV9lbmNvZGVyICp0aWRzc19lbmNvZGVyX2NyZWF0ZShzdHJ1Y3QgdGlkc3Nf
ZGV2aWNlICp0aWRzcywKKwkJCQkJIHUzMiBlbmNvZGVyX3R5cGUsIHUzMiBwb3NzaWJsZV9jcnRj
cyk7CisKKyNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3RpZHNzL3RpZHNzX2ly
cS5jIGIvZHJpdmVycy9ncHUvZHJtL3RpZHNzL3RpZHNzX2lycS5jCm5ldyBmaWxlIG1vZGUgMTAw
NjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMDAxY2FjN2MxMzU1Ci0tLSAvZGV2L251bGwKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL3RpZHNzL3RpZHNzX2lycS5jCkBAIC0wLDAgKzEsMTg1IEBACisvLyBT
UERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAorLyoKKyAqIENvcHlyaWdodCAoQykgMjAx
OCBUZXhhcyBJbnN0cnVtZW50cyBJbmNvcnBvcmF0ZWQgLSBodHRwOi8vd3d3LnRpLmNvbS8KKyAq
IEF1dGhvcjogVG9taSBWYWxrZWluZW4gPHRvbWkudmFsa2VpbmVuQHRpLmNvbT4KKyAqLworCisj
aW5jbHVkZSA8ZHJtL2RybVAuaD4KKworI2luY2x1ZGUgInRpZHNzX2lycS5oIgorI2luY2x1ZGUg
InRpZHNzX2Rydi5oIgorI2luY2x1ZGUgInRpZHNzX2Rpc3BjLmgiCisjaW5jbHVkZSAidGlkc3Nf
Y3J0Yy5oIgorI2luY2x1ZGUgInRpZHNzX3BsYW5lLmgiCisKKy8qIGNhbGwgd2l0aCB3YWl0X2xv
Y2sgYW5kIGRpc3BjIHJ1bnRpbWUgaGVsZCAqLworc3RhdGljIHZvaWQgdGlkc3NfaXJxX3VwZGF0
ZShzdHJ1Y3QgdGlkc3NfZGV2aWNlICp0aWRzcykKK3sKKwlhc3NlcnRfc3Bpbl9sb2NrZWQoJnRp
ZHNzLT53YWl0X2xvY2spOworCisJZGlzcGNfd3JpdGVfaXJxZW5hYmxlKHRpZHNzLT5kaXNwYywg
dGlkc3MtPmlycV9tYXNrKTsKK30KKwordm9pZCB0aWRzc19pcnFfZW5hYmxlX3ZibGFuayhzdHJ1
Y3QgZHJtX2NydGMgKmNydGMpCit7CisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYgPSBjcnRjLT5k
ZXY7CisJc3RydWN0IHRpZHNzX2RldmljZSAqdGlkc3MgPSBkZGV2LT5kZXZfcHJpdmF0ZTsKKwlz
dHJ1Y3QgdGlkc3NfY3J0YyAqdGNydGMgPSB0b190aWRzc19jcnRjKGNydGMpOworCXUzMiBod192
aWRlb3BvcnQgPSB0Y3J0Yy0+aHdfdmlkZW9wb3J0OworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisK
KwlzcGluX2xvY2tfaXJxc2F2ZSgmdGlkc3MtPndhaXRfbG9jaywgZmxhZ3MpOworCXRpZHNzLT5p
cnFfbWFzayB8PSBEU1NfSVJRX1ZQX1ZTWU5DX0VWRU4oaHdfdmlkZW9wb3J0KSB8CisJCQkgICBE
U1NfSVJRX1ZQX1ZTWU5DX09ERChod192aWRlb3BvcnQpOworCXRpZHNzX2lycV91cGRhdGUodGlk
c3MpOworCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnRpZHNzLT53YWl0X2xvY2ssIGZsYWdzKTsK
K30KKwordm9pZCB0aWRzc19pcnFfZGlzYWJsZV92Ymxhbmsoc3RydWN0IGRybV9jcnRjICpjcnRj
KQoreworCXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gY3J0Yy0+ZGV2OworCXN0cnVjdCB0aWRz
c19kZXZpY2UgKnRpZHNzID0gZGRldi0+ZGV2X3ByaXZhdGU7CisJc3RydWN0IHRpZHNzX2NydGMg
KnRjcnRjID0gdG9fdGlkc3NfY3J0YyhjcnRjKTsKKwl1MzIgaHdfdmlkZW9wb3J0ID0gdGNydGMt
Pmh3X3ZpZGVvcG9ydDsKKwl1bnNpZ25lZCBsb25nIGZsYWdzOworCisJc3Bpbl9sb2NrX2lycXNh
dmUoJnRpZHNzLT53YWl0X2xvY2ssIGZsYWdzKTsKKwl0aWRzcy0+aXJxX21hc2sgJj0gfihEU1Nf
SVJRX1ZQX1ZTWU5DX0VWRU4oaHdfdmlkZW9wb3J0KSB8CisJCQkgICAgIERTU19JUlFfVlBfVlNZ
TkNfT0REKGh3X3ZpZGVvcG9ydCkpOworCXRpZHNzX2lycV91cGRhdGUodGlkc3MpOworCXNwaW5f
dW5sb2NrX2lycXJlc3RvcmUoJnRpZHNzLT53YWl0X2xvY2ssIGZsYWdzKTsKK30KKworc3RhdGlj
IHZvaWQgdGlkc3NfaXJxX2ZpZm9fdW5kZXJmbG93KHN0cnVjdCB0aWRzc19kZXZpY2UgKnRpZHNz
LAorCQkJCSAgICAgZGlzcGNfaXJxX3QgaXJxc3RhdHVzKQoreworCXN0YXRpYyBERUZJTkVfUkFU
RUxJTUlUX1NUQVRFKF9ycywgREVGQVVMVF9SQVRFTElNSVRfSU5URVJWQUwsCisJCQkJICAgICAg
REVGQVVMVF9SQVRFTElNSVRfQlVSU1QpOworCWRpc3BjX2lycV90IG1hc2tlZDsKKwl1bnNpZ25l
ZCBpbnQgaTsKKworCXNwaW5fbG9jaygmdGlkc3MtPndhaXRfbG9jayk7CisJbWFza2VkID0gaXJx
c3RhdHVzICYgdGlkc3MtPmlycV91Zl9tYXNrICYgdGlkc3MtPmlycV9tYXNrOworCXNwaW5fdW5s
b2NrKCZ0aWRzcy0+d2FpdF9sb2NrKTsKKworCWlmICghbWFza2VkKQorCQlyZXR1cm47CisKKwlp
ZiAoIV9fcmF0ZWxpbWl0KCZfcnMpKQorCQlyZXR1cm47CisKKwlEUk1fRVJST1IoIkZJRk8gdW5k
ZXJmbG93IG9uICIpOworCisJZm9yIChpID0gMDsgaSA8IFRJRFNTX01BWF9QTEFORVM7ICsraSkg
eworCQlpZiAobWFza2VkICYgRFNTX0lSUV9QTEFORV9GSUZPX1VOREVSRkxPVyhpKSkKKwkJCXBy
X2NvbnQoIiV1OiVzICIsIGksIHRpZHNzLT5mZWF0LT52aWRfbmFtZVtpXSk7CisJfQorCisJcHJf
Y29udCgiKCUwOHgpXG4iLCBpcnFzdGF0dXMpOworfQorCitpcnFyZXR1cm5fdCB0aWRzc19pcnFf
aGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcpCit7CisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYg
PSAoc3RydWN0IGRybV9kZXZpY2UgKikgYXJnOworCXN0cnVjdCB0aWRzc19kZXZpY2UgKnRpZHNz
ID0gZGRldi0+ZGV2X3ByaXZhdGU7CisJdW5zaWduZWQgaW50IGlkOworCWRpc3BjX2lycV90IGly
cXN0YXR1czsKKworCWlmIChXQVJOX09OKCFkZGV2LT5pcnFfZW5hYmxlZCkpCisJCXJldHVybiBJ
UlFfTk9ORTsKKworCWlycXN0YXR1cyA9IGRpc3BjX3JlYWRfYW5kX2NsZWFyX2lycXN0YXR1cyh0
aWRzcy0+ZGlzcGMpOworCisJZm9yIChpZCA9IDA7IGlkIDwgdGlkc3MtPm51bV9jcnRjczsgaWQr
KykgeworCQlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSB0aWRzcy0+Y3J0Y3NbaWRdOworCQlzdHJ1
Y3QgdGlkc3NfY3J0YyAqdGNydGMgPSB0b190aWRzc19jcnRjKGNydGMpOworCQl1MzIgaHdfdmlk
ZW9wb3J0ID0gdGNydGMtPmh3X3ZpZGVvcG9ydDsKKworCQlpZiAoaXJxc3RhdHVzICYgKERTU19J
UlFfVlBfVlNZTkNfRVZFTihod192aWRlb3BvcnQpIHwKKwkJCQkgRFNTX0lSUV9WUF9WU1lOQ19P
REQoaHdfdmlkZW9wb3J0KSkpCisJCQl0aWRzc19jcnRjX3ZibGFua19pcnEoY3J0Yyk7CisKKwkJ
aWYgKGlycXN0YXR1cyAmIChEU1NfSVJRX1ZQX0ZSQU1FX0RPTkUoaHdfdmlkZW9wb3J0KSkpCisJ
CQl0aWRzc19jcnRjX2ZyYW1lZG9uZV9pcnEoY3J0Yyk7CisKKwkJaWYgKGlycXN0YXR1cyAmIERT
U19JUlFfVlBfU1lOQ19MT1NUKGh3X3ZpZGVvcG9ydCkpCisJCQl0aWRzc19jcnRjX2Vycm9yX2ly
cShjcnRjLCBpcnFzdGF0dXMpOworCX0KKworCWlmIChpcnFzdGF0dXMgJiBEU1NfSVJRX0RFVklD
RV9PQ1BfRVJSKQorCQlkZXZfZXJyX3JhdGVsaW1pdGVkKHRpZHNzLT5kZXYsICJPQ1AgZXJyb3Jc
biIpOworCWlmIChpcnFzdGF0dXMgJiB0aWRzcy0+aXJxX3VmX21hc2spCisJCXRpZHNzX2lycV9m
aWZvX3VuZGVyZmxvdyh0aWRzcywgaXJxc3RhdHVzKTsKKworCXJldHVybiBJUlFfSEFORExFRDsK
K30KKwordm9pZCB0aWRzc19pcnFfcmVzdW1lKHN0cnVjdCB0aWRzc19kZXZpY2UgKnRpZHNzKQor
eworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmdGlkc3MtPndh
aXRfbG9jaywgZmxhZ3MpOworCXRpZHNzX2lycV91cGRhdGUodGlkc3MpOworCXNwaW5fdW5sb2Nr
X2lycXJlc3RvcmUoJnRpZHNzLT53YWl0X2xvY2ssIGZsYWdzKTsKK30KKwordm9pZCB0aWRzc19p
cnFfcHJlaW5zdGFsbChzdHJ1Y3QgZHJtX2RldmljZSAqZGRldikKK3sKKwlzdHJ1Y3QgdGlkc3Nf
ZGV2aWNlICp0aWRzcyA9IGRkZXYtPmRldl9wcml2YXRlOworCisJc3Bpbl9sb2NrX2luaXQoJnRp
ZHNzLT53YWl0X2xvY2spOworCisJdGlkc3NfcnVudGltZV9nZXQodGlkc3MpOworCisJZGlzcGNf
d3JpdGVfaXJxZW5hYmxlKHRpZHNzLT5kaXNwYywgMCk7CisJZGlzcGNfcmVhZF9hbmRfY2xlYXJf
aXJxc3RhdHVzKHRpZHNzLT5kaXNwYyk7CisKKwl0aWRzc19ydW50aW1lX3B1dCh0aWRzcyk7Cit9
CisKK2ludCB0aWRzc19pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9kZXZpY2UgKmRkZXYpCit7
CisJc3RydWN0IHRpZHNzX2RldmljZSAqdGlkc3MgPSBkZGV2LT5kZXZfcHJpdmF0ZTsKKwl1bnNp
Z25lZCBsb25nIGZsYWdzOworCXVuc2lnbmVkIGludCBpOworCisJdGlkc3NfcnVudGltZV9nZXQo
dGlkc3MpOworCisJc3Bpbl9sb2NrX2lycXNhdmUoJnRpZHNzLT53YWl0X2xvY2ssIGZsYWdzKTsK
KworCXRpZHNzLT5pcnFfbWFzayA9IERTU19JUlFfREVWSUNFX09DUF9FUlI7CisKKwl0aWRzcy0+
aXJxX3VmX21hc2sgPSAwOworCWZvciAoaSA9IDA7IGkgPCB0aWRzcy0+bnVtX3BsYW5lczsgKytp
KSB7CisJCXN0cnVjdCB0aWRzc19wbGFuZSAqdHBsYW5lID0gdG9fdGlkc3NfcGxhbmUodGlkc3Mt
PnBsYW5lc1tpXSk7CisKKwkJdGlkc3MtPmlycV91Zl9tYXNrIHw9CisJCQlEU1NfSVJRX1BMQU5F
X0ZJRk9fVU5ERVJGTE9XKHRwbGFuZS0+aHdfcGxhbmVfaWQpOworCX0KKwl0aWRzcy0+aXJxX21h
c2sgfD0gdGlkc3MtPmlycV91Zl9tYXNrOworCisJZm9yIChpID0gMDsgaSA8IHRpZHNzLT5udW1f
Y3J0Y3M7ICsraSkgeworCQlzdHJ1Y3QgdGlkc3NfY3J0YyAqdGNydGMgPSB0b190aWRzc19jcnRj
KHRpZHNzLT5jcnRjc1tpXSk7CisKKwkJdGlkc3MtPmlycV9tYXNrIHw9IERTU19JUlFfVlBfU1lO
Q19MT1NUKHRjcnRjLT5od192aWRlb3BvcnQpOworCisJCXRpZHNzLT5pcnFfbWFzayB8PSBEU1Nf
SVJRX1ZQX0ZSQU1FX0RPTkUodGNydGMtPmh3X3ZpZGVvcG9ydCk7CisJfQorCisJdGlkc3NfaXJx
X3VwZGF0ZSh0aWRzcyk7CisKKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZ0aWRzcy0+d2FpdF9s
b2NrLCBmbGFncyk7CisKKwl0aWRzc19ydW50aW1lX3B1dCh0aWRzcyk7CisKKwlyZXR1cm4gMDsK
K30KKwordm9pZCB0aWRzc19pcnFfdW5pbnN0YWxsKHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2KQor
eworCXN0cnVjdCB0aWRzc19kZXZpY2UgKnRpZHNzID0gZGRldi0+ZGV2X3ByaXZhdGU7CisKKwl0
aWRzc19ydW50aW1lX2dldCh0aWRzcyk7CisJZGlzcGNfd3JpdGVfaXJxZW5hYmxlKHRpZHNzLT5k
aXNwYywgMCk7CisJdGlkc3NfcnVudGltZV9wdXQodGlkc3MpOworfQpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL3RpZHNzL3RpZHNzX2lycS5oIGIvZHJpdmVycy9ncHUvZHJtL3RpZHNzL3Rp
ZHNzX2lycS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uYThkZmNh
YmZhMjRlCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL3RpZHNzL3RpZHNzX2ly
cS5oCkBAIC0wLDAgKzEsNzEgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4w
ICovCisvKgorICogQ29weXJpZ2h0IChDKSAyMDE4IFRleGFzIEluc3RydW1lbnRzIEluY29ycG9y
YXRlZCAtIGh0dHA6Ly93d3cudGkuY29tLworICogQXV0aG9yOiBUb21pIFZhbGtlaW5lbiA8dG9t
aS52YWxrZWluZW5AdGkuY29tPgorICovCisKKyNpZm5kZWYgX19USURTU19JUlFfSF9fCisjZGVm
aW5lIF9fVElEU1NfSVJRX0hfXworCisjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KKyNpbmNsdWRl
ICJ0aWRzc19kcnYuaCIKKworLyoKKyAqIFRoZSBJUlEgc3RhdHVzIGZyb20gdmFyaW91cyBESVNQ
QyBJUlEgcmVnaXN0ZXJzIGFyZSBwYWNrZWQgaW50byBhIHNpbmdsZQorICogdmFsdWUsIHdoZXJl
IHRoZSBiaXRzIGFyZSBkZWZpbmVkIGFzIGZvbGxvd3M6CisgKgorICogYml0IGdyb3VwIHxkZXZ8
d2IgfG1yZzB8bXJnMXxtcmcyfG1yZzN8cGxhbmUwLTN8IDx1bnVzZWQ+IHwKKyAqIGJpdCB1c2Ug
ICB8RCAgfGZvdXxGRU9MfEZFT0x8RkVPTHxGRU9MfCAgVVVVVSAgfCAgICAgICAgICB8CisgKiBi
aXQgbnVtYmVyfDAgIHwxLTN8NC03IHw4LTExfCAgMTItMTkgIHwgMjAtMjMgIHwgIDI0LTMxICAg
fAorICoKKyAqIGRldmljZSBiaXRzOglEID0gT0NQIGVycm9yCisgKiBXQiBiaXRzOglmID0gZnJh
bWUgZG9uZSB3YiwgbyA9IHdiIGJ1ZmZlciBvdmVyZmxvdywKKyAqCQl1ID0gd2IgYnVmZmVyIHVu
Y29tcGxldGUKKyAqIHZwIGJpdHM6CUYgPSBmcmFtZSBkb25lLCBFID0gdnN5bmMgZXZlbiwgTyA9
IHZzeW5jIG9kZCwgTCA9IHN5bmMgbG9zdAorICogcGxhbmUgYml0czoJVSA9IGZpZm8gdW5kZXJm
bG93CisgKi8KKworI2RlZmluZSBEU1NfSVJRX0RFVklDRV9PQ1BfRVJSCQkJQklUX1VMTCgwKQor
CisjZGVmaW5lIERTU19JUlFfREVWSUNFX0ZSQU1FRE9ORVdCCQlCSVRfVUxMKDEpCisjZGVmaW5l
IERTU19JUlFfREVWSUNFX1dCQlVGRkVST1ZFUkZMT1cJCUJJVF9VTEwoMikKKyNkZWZpbmUgRFNT
X0lSUV9ERVZJQ0VfV0JVTkNPTVBMRVRFRVJST1IJQklUX1VMTCgzKQorI2RlZmluZSBEU1NfSVJR
X0RFVklDRV9XQl9NQVNLCQkJR0VOTUFTS19VTEwoMywgMSkKKworI2RlZmluZSBEU1NfSVJRX1ZQ
X0JJVF9OKGNoLCBiaXQpCSg0ICsgNCAqIChjaCkgKyAoYml0KSkKKyNkZWZpbmUgRFNTX0lSUV9Q
TEFORV9CSVRfTihwbGFuZSwgYml0KSBcCisJKERTU19JUlFfVlBfQklUX04oVElEU1NfTUFYX1BP
UlRTLCAwKSArIDEgKiAocGxhbmUpICsgKGJpdCkpCisKKyNkZWZpbmUgRFNTX0lSUV9WUF9CSVQo
Y2gsIGJpdCkJQklUX1VMTChEU1NfSVJRX1ZQX0JJVF9OKChjaCksIChiaXQpKSkKKyNkZWZpbmUg
RFNTX0lSUV9QTEFORV9CSVQocGxhbmUsIGJpdCkgXAorCUJJVF9VTEwoRFNTX0lSUV9QTEFORV9C
SVRfTigocGxhbmUpLCAoYml0KSkpCisKKyNkZWZpbmUgRFNTX0lSUV9WUF9NQVNLKGNoKSBcCisJ
R0VOTUFTS19VTEwoRFNTX0lSUV9WUF9CSVRfTigoY2gpLCAzKSwgRFNTX0lSUV9WUF9CSVRfTigo
Y2gpLCAwKSkKKyNkZWZpbmUgRFNTX0lSUV9QTEFORV9NQVNLKHBsYW5lKSBcCisJR0VOTUFTS19V
TEwoRFNTX0lSUV9QTEFORV9CSVRfTigocGxhbmUpLCAwKSwgXAorCQkgICAgRFNTX0lSUV9QTEFO
RV9CSVRfTigocGxhbmUpLCAwKSkKKworI2RlZmluZSBEU1NfSVJRX1ZQX0ZSQU1FX0RPTkUoY2gp
CURTU19JUlFfVlBfQklUKChjaCksIDApCisjZGVmaW5lIERTU19JUlFfVlBfVlNZTkNfRVZFTihj
aCkJRFNTX0lSUV9WUF9CSVQoKGNoKSwgMSkKKyNkZWZpbmUgRFNTX0lSUV9WUF9WU1lOQ19PREQo
Y2gpCURTU19JUlFfVlBfQklUKChjaCksIDIpCisjZGVmaW5lIERTU19JUlFfVlBfU1lOQ19MT1NU
KGNoKQlEU1NfSVJRX1ZQX0JJVCgoY2gpLCAzKQorCisjZGVmaW5lIERTU19JUlFfUExBTkVfRklG
T19VTkRFUkZMT1cocGxhbmUpCURTU19JUlFfUExBTkVfQklUKChwbGFuZSksIDApCisKK3N0cnVj
dCBkcm1fY3J0YzsKK3N0cnVjdCBkcm1fZGV2aWNlOworCitzdHJ1Y3QgdGlkc3NfZGV2aWNlOwor
Cit2b2lkIHRpZHNzX2lycV9lbmFibGVfdmJsYW5rKHN0cnVjdCBkcm1fY3J0YyAqY3J0Yyk7Cit2
b2lkIHRpZHNzX2lycV9kaXNhYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2NydGMgKmNydGMpOworCit2
b2lkIHRpZHNzX2lycV9wcmVpbnN0YWxsKHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2KTsKK2ludCB0
aWRzc19pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9kZXZpY2UgKmRkZXYpOwordm9pZCB0aWRz
c19pcnFfdW5pbnN0YWxsKHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2KTsKK2lycXJldHVybl90IHRp
ZHNzX2lycV9oYW5kbGVyKGludCBpcnEsIHZvaWQgKmFyZyk7CisKK3ZvaWQgdGlkc3NfaXJxX3Jl
c3VtZShzdHJ1Y3QgdGlkc3NfZGV2aWNlICp0aWRzcyk7CisKKyNlbmRpZgpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL3RpZHNzL3RpZHNzX2ttcy5jIGIvZHJpdmVycy9ncHUvZHJtL3RpZHNz
L3RpZHNzX2ttcy5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMzEz
NzM2MzY0ZGU3Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL3RpZHNzL3RpZHNz
X2ttcy5jCkBAIC0wLDAgKzEsMjM5IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BM
LTIuMAorLyoKKyAqIENvcHlyaWdodCAoQykgMjAxOCBUZXhhcyBJbnN0cnVtZW50cyBJbmNvcnBv
cmF0ZWQgLSBodHRwOi8vd3d3LnRpLmNvbS8KKyAqIEF1dGhvcjogVG9taSBWYWxrZWluZW4gPHRv
bWkudmFsa2VpbmVuQHRpLmNvbT4KKyAqLworCisjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWMuaD4K
KyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pY19oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2Ny
dGNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9mYl9jbWFfaGVscGVyLmg+CisjaW5jbHVk
ZSA8ZHJtL2RybV9mYl9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2dlbV9mcmFtZWJ1ZmZl
cl9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX29mLmg+CisjaW5jbHVkZSA8ZHJtL2RybV92
YmxhbmsuaD4KKworI2luY2x1ZGUgInRpZHNzX2NydGMuaCIKKyNpbmNsdWRlICJ0aWRzc19wbGFu
ZS5oIgorI2luY2x1ZGUgInRpZHNzX2Rydi5oIgorI2luY2x1ZGUgInRpZHNzX2VuY29kZXIuaCIK
KyNpbmNsdWRlICJ0aWRzc19rbXMuaCIKKworI2luY2x1ZGUgInRpZHNzX2Rpc3BjLmgiCisKK3N0
YXRpYyB2b2lkIHRpZHNzX2F0b21pY19jb21taXRfdGFpbChzdHJ1Y3QgZHJtX2F0b21pY19zdGF0
ZSAqb2xkX3N0YXRlKQoreworCXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gb2xkX3N0YXRlLT5k
ZXY7CisJc3RydWN0IHRpZHNzX2RldmljZSAqdGlkc3MgPSBkZGV2LT5kZXZfcHJpdmF0ZTsKKwor
CWRldl9kYmcoZGRldi0+ZGV2LCAiJXNcbiIsIF9fZnVuY19fKTsKKworCXRpZHNzX3J1bnRpbWVf
Z2V0KHRpZHNzKTsKKworCWRybV9hdG9taWNfaGVscGVyX2NvbW1pdF9tb2Rlc2V0X2Rpc2FibGVz
KGRkZXYsIG9sZF9zdGF0ZSk7CisJZHJtX2F0b21pY19oZWxwZXJfY29tbWl0X3BsYW5lcyhkZGV2
LCBvbGRfc3RhdGUsIDApOworCWRybV9hdG9taWNfaGVscGVyX2NvbW1pdF9tb2Rlc2V0X2VuYWJs
ZXMoZGRldiwgb2xkX3N0YXRlKTsKKworCWRybV9hdG9taWNfaGVscGVyX2NvbW1pdF9od19kb25l
KG9sZF9zdGF0ZSk7CisJZHJtX2F0b21pY19oZWxwZXJfd2FpdF9mb3JfZmxpcF9kb25lKGRkZXYs
IG9sZF9zdGF0ZSk7CisKKwlkcm1fYXRvbWljX2hlbHBlcl9jbGVhbnVwX3BsYW5lcyhkZGV2LCBv
bGRfc3RhdGUpOworCisJdGlkc3NfcnVudGltZV9wdXQodGlkc3MpOworfQorCitzdGF0aWMgY29u
c3Qgc3RydWN0IGRybV9tb2RlX2NvbmZpZ19oZWxwZXJfZnVuY3MgbW9kZV9jb25maWdfaGVscGVy
X2Z1bmNzID0geworCS5hdG9taWNfY29tbWl0X3RhaWwgPSB0aWRzc19hdG9taWNfY29tbWl0X3Rh
aWwsCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9tb2RlX2NvbmZpZ19mdW5jcyBtb2Rl
X2NvbmZpZ19mdW5jcyA9IHsKKwkuZmJfY3JlYXRlID0gZHJtX2dlbV9mYl9jcmVhdGUsCisJLmF0
b21pY19jaGVjayA9IGRybV9hdG9taWNfaGVscGVyX2NoZWNrLAorCS5hdG9taWNfY29tbWl0ID0g
ZHJtX2F0b21pY19oZWxwZXJfY29tbWl0LAorfTsKKworc3RhdGljIGludCB0aWRzc19kaXNwY19t
b2Rlc2V0X2luaXQoc3RydWN0IHRpZHNzX2RldmljZSAqdGlkc3MpCit7CisJc3RydWN0IGRldmlj
ZSAqZGV2ID0gdGlkc3MtPmRldjsKKwl1bnNpZ25lZCBpbnQgZm91cmNjc19sZW47CisJY29uc3Qg
dTMyICpmb3VyY2NzID0gZGlzcGNfcGxhbmVfZm9ybWF0cyh0aWRzcy0+ZGlzcGMsICZmb3VyY2Nz
X2xlbik7CisJdW5zaWduZWQgaW50IGk7CisKKwlzdHJ1Y3QgcGlwZSB7CisJCXUzMiBod192aWRl
b3BvcnQ7CisJCXN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2U7CisJCXUzMiBlbmNfdHlwZTsKKwl9
OworCisJY29uc3Qgc3RydWN0IGRpc3BjX2ZlYXR1cmVzICpmZWF0ID0gdGlkc3MtPmZlYXQ7CisJ
dTMyIG1heF92cHMgPSBmZWF0LT5udW1fdnBzOworCXUzMiBtYXhfcGxhbmVzID0gZmVhdC0+bnVt
X3BsYW5lczsKKworCXN0cnVjdCBwaXBlIHBpcGVzW1RJRFNTX01BWF9QT1JUU107CisJdTMyIG51
bV9waXBlcyA9IDA7CisJdTMyIGNydGNfbWFzazsKKworCS8qIGZpcnN0IGZpbmQgYWxsIHRoZSBj
b25uZWN0ZWQgcGFuZWxzICYgYnJpZGdlcyAqLworCisJZm9yIChpID0gMDsgaSA8IG1heF92cHM7
IGkrKykgeworCQlzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbDsKKwkJc3RydWN0IGRybV9icmlkZ2Ug
KmJyaWRnZTsKKwkJdTMyIGVuY190eXBlID0gRFJNX01PREVfRU5DT0RFUl9OT05FOworCQlpbnQg
cmV0OworCisJCXJldCA9IGRybV9vZl9maW5kX3BhbmVsX29yX2JyaWRnZShkZXYtPm9mX25vZGUs
IGksIDAsCisJCQkJCQkgICZwYW5lbCwgJmJyaWRnZSk7CisJCWlmIChyZXQgPT0gLUVOT0RFVikg
eworCQkJZGV2X2RiZyhkZXYsICJubyBwYW5lbC9icmlkZ2UgZm9yIHBvcnQgJWRcbiIsIGkpOwor
CQkJY29udGludWU7CisJCX0gZWxzZSBpZiAocmV0KSB7CisJCQlkZXZfZGJnKGRldiwgInBvcnQg
JWQgcHJvYmUgcmV0dXJuZWQgJWRcbiIsIGksIHJldCk7CisJCQlyZXR1cm4gcmV0OworCQl9CisK
KwkJaWYgKHBhbmVsKSB7CisJCQl1MzIgY29ubl90eXBlOworCisJCQlkZXZfZGJnKGRldiwgIlNl
dHRpbmcgdXAgcGFuZWwgZm9yIHBvcnQgJWRcbiIsIGkpOworCisJCQlzd2l0Y2ggKGZlYXQtPnZw
X2J1c190eXBlW2ldKSB7CisJCQljYXNlIERJU1BDX1ZQX09MREk6CisJCQkJZW5jX3R5cGUgPSBE
Uk1fTU9ERV9FTkNPREVSX0xWRFM7CisJCQkJY29ubl90eXBlID0gRFJNX01PREVfQ09OTkVDVE9S
X0xWRFM7CisJCQkJYnJlYWs7CisJCQljYXNlIERJU1BDX1ZQX0RQSToKKwkJCQllbmNfdHlwZSA9
IERSTV9NT0RFX0VOQ09ERVJfRFBJOworCQkJCWNvbm5fdHlwZSA9IERSTV9NT0RFX0NPTk5FQ1RP
Ul9EUEk7CisJCQkJYnJlYWs7CisJCQlkZWZhdWx0OgorCQkJCWNvbm5fdHlwZSA9IERSTV9NT0RF
X0NPTk5FQ1RPUl9Vbmtub3duOworCQkJCWJyZWFrOworCQkJfQorCisJCQlicmlkZ2UgPSBkZXZt
X2RybV9wYW5lbF9icmlkZ2VfYWRkKGRldiwgcGFuZWwsCisJCQkJCQkJICAgY29ubl90eXBlKTsK
KwkJCWlmIChJU19FUlIoYnJpZGdlKSkgeworCQkJCWRldl9lcnIoZGV2LCAiZmFpbGVkIHRvIHNl
dCB1cCBwYW5lbCBicmlkZ2UgZm9yIHBvcnQgJWRcbiIsIGkpOworCQkJCXJldHVybiBQVFJfRVJS
KGJyaWRnZSk7CisJCQl9CisJCX0KKworCQlwaXBlc1tudW1fcGlwZXNdLmh3X3ZpZGVvcG9ydCA9
IGk7CisJCXBpcGVzW251bV9waXBlc10uYnJpZGdlID0gYnJpZGdlOworCQlwaXBlc1tudW1fcGlw
ZXNdLmVuY190eXBlID0gZW5jX3R5cGU7CisJCW51bV9waXBlcysrOworCX0KKworCS8qIGFsbCBw
bGFuZXMgY2FuIGJlIG9uIGFueSBjcnRjICovCisJY3J0Y19tYXNrID0gKDEgPDwgbnVtX3BpcGVz
KSAtIDE7CisKKwkvKiB0aGVuIGNyZWF0ZSBhIHBsYW5lLCBhIGNydGMgYW5kIGFuIGVuY29kZXIg
Zm9yIGVhY2ggcGFuZWwvYnJpZGdlICovCisKKwlmb3IgKGkgPSAwOyBpIDwgbnVtX3BpcGVzOyAr
K2kpIHsKKwkJc3RydWN0IHRpZHNzX3BsYW5lICp0cGxhbmU7CisJCXN0cnVjdCB0aWRzc19jcnRj
ICp0Y3J0YzsKKwkJc3RydWN0IGRybV9lbmNvZGVyICplbmM7CisJCXUzMiBod19wbGFuZV9pZCA9
IGZlYXQtPnZpZF9vcmRlclt0aWRzcy0+bnVtX3BsYW5lc107CisJCWludCByZXQ7CisKKwkJdHBs
YW5lID0gdGlkc3NfcGxhbmVfY3JlYXRlKHRpZHNzLCBod19wbGFuZV9pZCwKKwkJCQkJICAgIERS
TV9QTEFORV9UWVBFX1BSSU1BUlksIGNydGNfbWFzaywKKwkJCQkJICAgIGZvdXJjY3MsIGZvdXJj
Y3NfbGVuKTsKKwkJaWYgKElTX0VSUih0cGxhbmUpKSB7CisJCQlkZXZfZXJyKHRpZHNzLT5kZXYs
ICJwbGFuZSBjcmVhdGUgZmFpbGVkXG4iKTsKKwkJCXJldHVybiBQVFJfRVJSKHRwbGFuZSk7CisJ
CX0KKworCQl0aWRzcy0+cGxhbmVzW3RpZHNzLT5udW1fcGxhbmVzKytdID0gJnRwbGFuZS0+cGxh
bmU7CisKKwkJdGNydGMgPSB0aWRzc19jcnRjX2NyZWF0ZSh0aWRzcywgcGlwZXNbaV0uaHdfdmlk
ZW9wb3J0LAorCQkJCQkgICZ0cGxhbmUtPnBsYW5lKTsKKwkJaWYgKElTX0VSUih0Y3J0YykpIHsK
KwkJCWRldl9lcnIodGlkc3MtPmRldiwgImNydGMgY3JlYXRlIGZhaWxlZFxuIik7CisJCQlyZXR1
cm4gUFRSX0VSUih0Y3J0Yyk7CisJCX0KKworCQl0aWRzcy0+Y3J0Y3NbdGlkc3MtPm51bV9jcnRj
cysrXSA9ICZ0Y3J0Yy0+Y3J0YzsKKworCQllbmMgPSB0aWRzc19lbmNvZGVyX2NyZWF0ZSh0aWRz
cywgcGlwZXNbaV0uZW5jX3R5cGUsCisJCQkJCSAgIDEgPDwgdGNydGMtPmNydGMuaW5kZXgpOwor
CQlpZiAoSVNfRVJSKGVuYykpIHsKKwkJCWRldl9lcnIodGlkc3MtPmRldiwgImVuY29kZXIgY3Jl
YXRlIGZhaWxlZFxuIik7CisJCQlyZXR1cm4gUFRSX0VSUihlbmMpOworCQl9CisKKwkJcmV0ID0g
ZHJtX2JyaWRnZV9hdHRhY2goZW5jLCBwaXBlc1tpXS5icmlkZ2UsIE5VTEwpOworCQlpZiAocmV0
KSB7CisJCQlkZXZfZXJyKHRpZHNzLT5kZXYsICJicmlkZ2UgYXR0YWNoIGZhaWxlZDogJWRcbiIs
IHJldCk7CisJCQlyZXR1cm4gcmV0OworCQl9CisJfQorCisJLyogY3JlYXRlIG92ZXJsYXkgcGxh
bmVzIG9mIHRoZSBsZWZ0b3ZlciBwbGFuZXMgKi8KKworCXdoaWxlICh0aWRzcy0+bnVtX3BsYW5l
cyA8IG1heF9wbGFuZXMpIHsKKwkJc3RydWN0IHRpZHNzX3BsYW5lICp0cGxhbmU7CisJCXUzMiBo
d19wbGFuZV9pZCA9IGZlYXQtPnZpZF9vcmRlclt0aWRzcy0+bnVtX3BsYW5lc107CisKKwkJdHBs
YW5lID0gdGlkc3NfcGxhbmVfY3JlYXRlKHRpZHNzLCBod19wbGFuZV9pZCwKKwkJCQkJICAgIERS
TV9QTEFORV9UWVBFX09WRVJMQVksIGNydGNfbWFzaywKKwkJCQkJICAgIGZvdXJjY3MsIGZvdXJj
Y3NfbGVuKTsKKworCQlpZiAoSVNfRVJSKHRwbGFuZSkpIHsKKwkJCWRldl9lcnIodGlkc3MtPmRl
diwgInBsYW5lIGNyZWF0ZSBmYWlsZWRcbiIpOworCQkJcmV0dXJuIFBUUl9FUlIodHBsYW5lKTsK
KwkJfQorCisJCXRpZHNzLT5wbGFuZXNbdGlkc3MtPm51bV9wbGFuZXMrK10gPSAmdHBsYW5lLT5w
bGFuZTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworaW50IHRpZHNzX21vZGVzZXRfaW5pdChzdHJ1
Y3QgdGlkc3NfZGV2aWNlICp0aWRzcykKK3sKKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9IHRp
ZHNzLT5kZGV2OworCXVuc2lnbmVkIGludCBpOworCWludCByZXQ7CisKKwlkZXZfZGJnKHRpZHNz
LT5kZXYsICIlc1xuIiwgX19mdW5jX18pOworCisJZHJtX21vZGVfY29uZmlnX2luaXQoZGRldik7
CisKKwlkZGV2LT5tb2RlX2NvbmZpZy5taW5fd2lkdGggPSA4OworCWRkZXYtPm1vZGVfY29uZmln
Lm1pbl9oZWlnaHQgPSA4OworCWRkZXYtPm1vZGVfY29uZmlnLm1heF93aWR0aCA9IDgwOTY7CisJ
ZGRldi0+bW9kZV9jb25maWcubWF4X2hlaWdodCA9IDgwOTY7CisJZGRldi0+bW9kZV9jb25maWcu
bm9ybWFsaXplX3pwb3MgPSB0cnVlOworCWRkZXYtPm1vZGVfY29uZmlnLmZ1bmNzID0gJm1vZGVf
Y29uZmlnX2Z1bmNzOworCWRkZXYtPm1vZGVfY29uZmlnLmhlbHBlcl9wcml2YXRlID0gJm1vZGVf
Y29uZmlnX2hlbHBlcl9mdW5jczsKKworCXJldCA9IHRpZHNzX2Rpc3BjX21vZGVzZXRfaW5pdCh0
aWRzcyk7CisJaWYgKHJldCkKKwkJZ290byBlcnJfbW9kZV9jb25maWdfY2xlYW51cDsKKworCXJl
dCA9IGRybV92YmxhbmtfaW5pdChkZGV2LCB0aWRzcy0+bnVtX2NydGNzKTsKKwlpZiAocmV0KQor
CQlnb3RvIGVycl9tb2RlX2NvbmZpZ19jbGVhbnVwOworCisJLyogU3RhcnQgd2l0aCB2ZXJ0aWNh
bCBibGFua2luZyBpbnRlcnJ1cHQgcmVwb3J0aW5nIGRpc2FibGVkLiAqLworCWZvciAoaSA9IDA7
IGkgPCB0aWRzcy0+bnVtX2NydGNzOyArK2kpCisJCWRybV9jcnRjX3ZibGFua19yZXNldCh0aWRz
cy0+Y3J0Y3NbaV0pOworCisJZHJtX21vZGVfY29uZmlnX3Jlc2V0KGRkZXYpOworCisJZGV2X2Ri
Zyh0aWRzcy0+ZGV2LCAiJXMgZG9uZVxuIiwgX19mdW5jX18pOworCisJcmV0dXJuIDA7CisKK2Vy
cl9tb2RlX2NvbmZpZ19jbGVhbnVwOgorCWRybV9tb2RlX2NvbmZpZ19jbGVhbnVwKGRkZXYpOwor
CXJldHVybiByZXQ7Cit9CisKK3ZvaWQgdGlkc3NfbW9kZXNldF9jbGVhbnVwKHN0cnVjdCB0aWRz
c19kZXZpY2UgKnRpZHNzKQoreworCXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gdGlkc3MtPmRk
ZXY7CisKKwlkcm1fbW9kZV9jb25maWdfY2xlYW51cChkZGV2KTsKK30KZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS90aWRzcy90aWRzc19rbXMuaCBiL2RyaXZlcnMvZ3B1L2RybS90aWRzcy90
aWRzc19rbXMuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmRkYTU2
MjVkMDEyOAotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90aWRzcy90aWRzc19r
bXMuaApAQCAtMCwwICsxLDE1IEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIu
MCAqLworLyoKKyAqIENvcHlyaWdodCAoQykgMjAxOCBUZXhhcyBJbnN0cnVtZW50cyBJbmNvcnBv
cmF0ZWQgLSBodHRwOi8vd3d3LnRpLmNvbS8KKyAqIEF1dGhvcjogVG9taSBWYWxrZWluZW4gPHRv
bWkudmFsa2VpbmVuQHRpLmNvbT4KKyAqLworCisjaWZuZGVmIF9fVElEU1NfS01TX0hfXworI2Rl
ZmluZSBfX1RJRFNTX0tNU19IX18KKworc3RydWN0IHRpZHNzX2RldmljZTsKKworaW50IHRpZHNz
X21vZGVzZXRfaW5pdChzdHJ1Y3QgdGlkc3NfZGV2aWNlICp0aWRzcyk7Cit2b2lkIHRpZHNzX21v
ZGVzZXRfY2xlYW51cChzdHJ1Y3QgdGlkc3NfZGV2aWNlICp0aWRzcyk7CisKKyNlbmRpZgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3RpZHNzL3RpZHNzX3BsYW5lLmMgYi9kcml2ZXJzL2dw
dS9kcm0vdGlkc3MvdGlkc3NfcGxhbmUuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAw
MDAwMDAwMDAuLjc4NmYzNDBmZWVkYgotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS90aWRzcy90aWRzc19wbGFuZS5jCkBAIC0wLDAgKzEsMjE4IEBACisvLyBTUERYLUxpY2Vuc2Ut
SWRlbnRpZmllcjogR1BMLTIuMAorLyoKKyAqIENvcHlyaWdodCAoQykgMjAxOCBUZXhhcyBJbnN0
cnVtZW50cyBJbmNvcnBvcmF0ZWQgLSBodHRwOi8vd3d3LnRpLmNvbS8KKyAqIEF1dGhvcjogVG9t
aSBWYWxrZWluZW4gPHRvbWkudmFsa2VpbmVuQHRpLmNvbT4KKyAqLworCisjaW5jbHVkZSA8ZHJt
L2RybVAuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pYy5oPgorI2luY2x1ZGUgPGRybS9kcm1f
YXRvbWljX2hlbHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fY3J0Yy5oPgorI2luY2x1ZGUgPGRy
bS9kcm1fY3J0Y19oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2ZiX2NtYV9oZWxwZXIuaD4K
KworI2luY2x1ZGUgInRpZHNzX2NydGMuaCIKKyNpbmNsdWRlICJ0aWRzc19kcnYuaCIKKyNpbmNs
dWRlICJ0aWRzc19wbGFuZS5oIgorCisjaW5jbHVkZSAidGlkc3NfZGlzcGMuaCIKKworLyogZHJt
X3BsYW5lX2hlbHBlcl9mdW5jcyAqLworCitzdGF0aWMgaW50IHRpZHNzX3BsYW5lX2F0b21pY19j
aGVjayhzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKKwkJCQkgICAgc3RydWN0IGRybV9wbGFuZV9z
dGF0ZSAqc3RhdGUpCit7CisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYgPSBwbGFuZS0+ZGV2Owor
CXN0cnVjdCB0aWRzc19kZXZpY2UgKnRpZHNzID0gZGRldi0+ZGV2X3ByaXZhdGU7CisJc3RydWN0
IHRpZHNzX3BsYW5lICp0cGxhbmUgPSB0b190aWRzc19wbGFuZShwbGFuZSk7CisJY29uc3Qgc3Ry
dWN0IGRybV9mb3JtYXRfaW5mbyAqZmluZm87CisJc3RydWN0IGRybV9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlOworCXUzMiBod19wbGFuZSA9IHRwbGFuZS0+aHdfcGxhbmVfaWQ7CisJdTMyIGh3X3Zp
ZGVvcG9ydDsKKwlpbnQgcmV0OworCisJZGV2X2RiZyhkZGV2LT5kZXYsICIlc1xuIiwgX19mdW5j
X18pOworCisJaWYgKCFzdGF0ZS0+Y3J0YykgeworCQkvKgorCQkgKiBUaGUgdmlzaWJsZSBmaWVs
ZCBpcyBub3QgcmVzZXQgYnkgdGhlIERSTSBjb3JlIGJ1dCBvbmx5CisJCSAqIHVwZGF0ZWQgYnkg
ZHJtX3BsYW5lX2hlbHBlcl9jaGVja19zdGF0ZSgpLCBzZXQgaXQgbWFudWFsbHkuCisJCSAqLwor
CQlzdGF0ZS0+dmlzaWJsZSA9IGZhbHNlOworCQlyZXR1cm4gMDsKKwl9CisKKwljcnRjX3N0YXRl
ID0gZHJtX2F0b21pY19nZXRfY3J0Y19zdGF0ZShzdGF0ZS0+c3RhdGUsIHN0YXRlLT5jcnRjKTsK
KwlpZiAoSVNfRVJSKGNydGNfc3RhdGUpKQorCQlyZXR1cm4gUFRSX0VSUihjcnRjX3N0YXRlKTsK
KworCXJldCA9IGRybV9hdG9taWNfaGVscGVyX2NoZWNrX3BsYW5lX3N0YXRlKHN0YXRlLCBjcnRj
X3N0YXRlLCAwLAorCQkJCQkJICBJTlRfTUFYLCB0cnVlLCB0cnVlKTsKKwlpZiAocmV0IDwgMCkK
KwkJcmV0dXJuIHJldDsKKworCS8qCisJICogVGhlIEhXIGlzIG9ubHkgYWJsZSB0byBzdGFydCBk
cmF3aW5nIGF0IHN1YnBpeGVsIGJvdW5kYXJ5CisJICogKHRoZSB0d28gZmlyc3QgY2hlY2tzIGJl
bGxvdykuIEF0IHRoZSBlbmQgb2YgYSByb3cgdGhlIEhXCisJICogY2FuIG9ubHkganVtcCBpbnRl
Z2VyIG51bWJlciBvZiBzdWJwaXhlbHMgZm9yd2FyZCB0byB0aGUKKwkgKiBiZWdpbm5pbmcgb2Yg
dGhlIG5leHQgcm93LiBTbyB3ZSBjYW4gb25seSBzaG93IHBpY3R1cmUgd2l0aAorCSAqIGludGVn
ZXIgc3VicGl4ZWwgd2lkdGggKHRoZSB0aGlyZCBjaGVjaykuIEhvd2V2ZXIsIGFmdGVyCisJICog
cmVhY2hpbmcgdGhlIGVuZCBvZiB0aGUgZHJhd24gcGljdHVyZSB0aGUgZHJhd2luZyBzdGFydHMK
KwkgKiBhZ2FpbiBhdCB0aGUgYWJzb2x1dGUgbWVtb3J5IGFkZHJlc3Mgd2hlcmUgdG9wIGxlZnQg
Y29ybmVyCisJICogcG9zaXRpb24gb2YgdGhlIGRyYXduIHBpY3R1cmUgaXMgKHNvIHRoZXJlIGlz
IG5vIG5lZWQgdG8KKwkgKiBjaGVjayBmb3Igb2RkIGhlaWdodCkuCisJICovCisKKwlmaW5mbyA9
IGRybV9mb3JtYXRfaW5mbyhzdGF0ZS0+ZmItPmZvcm1hdC0+Zm9ybWF0KTsKKworCWlmICgoc3Rh
dGUtPnNyY194ID4+IDE2KSAlIGZpbmZvLT5oc3ViICE9IDApIHsKKwkJZGV2X2RiZyhkZGV2LT5k
ZXYsCisJCQkiJXM6IHgtcG9zaXRpb24gJXUgbm90IGRpdmlzaWJsZSBzdWJwaXhlbCBzaXplICV1
XG4iLAorCQkJX19mdW5jX18sIChzdGF0ZS0+c3JjX3ggPj4gMTYpLCBmaW5mby0+aHN1Yik7CisJ
CXJldHVybiAtRUlOVkFMOworCX0KKworCWlmICgoc3RhdGUtPnNyY195ID4+IDE2KSAlIGZpbmZv
LT52c3ViICE9IDApIHsKKwkJZGV2X2RiZyhkZGV2LT5kZXYsCisJCQkiJXM6IHktcG9zaXRpb24g
JXUgbm90IGRpdmlzaWJsZSBzdWJwaXhlbCBzaXplICV1XG4iLAorCQkJX19mdW5jX18sIChzdGF0
ZS0+c3JjX3kgPj4gMTYpLCBmaW5mby0+dnN1Yik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKwor
CWlmICgoc3RhdGUtPnNyY193ID4+IDE2KSAlIGZpbmZvLT5oc3ViICE9IDApIHsKKwkJZGV2X2Ri
ZyhkZGV2LT5kZXYsCisJCQkiJXM6IHNyYyB3aWR0aCAldSBub3QgZGl2aXNpYmxlIGJ5IHN1YnBp
eGVsIHNpemUgJXVcbiIsCisJCQkgX19mdW5jX18sIChzdGF0ZS0+c3JjX3cgPj4gMTYpLCBmaW5m
by0+aHN1Yik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCWlmICghc3RhdGUtPnZpc2libGUp
CisJCXJldHVybiAwOworCisJaHdfdmlkZW9wb3J0ID0gdG9fdGlkc3NfY3J0YyhzdGF0ZS0+Y3J0
YyktPmh3X3ZpZGVvcG9ydDsKKworCXJldCA9IGRpc3BjX3BsYW5lX2NoZWNrKHRpZHNzLT5kaXNw
YywgaHdfcGxhbmUsIHN0YXRlLCBod192aWRlb3BvcnQpOworCWlmIChyZXQpCisJCXJldHVybiBy
ZXQ7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgdGlkc3NfcGxhbmVfYXRvbWljX3Vw
ZGF0ZShzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKKwkJCQkgICAgICBzdHJ1Y3QgZHJtX3BsYW5l
X3N0YXRlICpvbGRfc3RhdGUpCit7CisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYgPSBwbGFuZS0+
ZGV2OworCXN0cnVjdCB0aWRzc19kZXZpY2UgKnRpZHNzID0gZGRldi0+ZGV2X3ByaXZhdGU7CisJ
c3RydWN0IHRpZHNzX3BsYW5lICp0cGxhbmUgPSB0b190aWRzc19wbGFuZShwbGFuZSk7CisJc3Ry
dWN0IGRybV9wbGFuZV9zdGF0ZSAqc3RhdGUgPSBwbGFuZS0+c3RhdGU7CisJdTMyIGh3X3ZpZGVv
cG9ydDsKKwlpbnQgcmV0OworCisJZGV2X2RiZyhkZGV2LT5kZXYsICIlc1xuIiwgX19mdW5jX18p
OworCisJaWYgKCFzdGF0ZS0+dmlzaWJsZSkgeworCQlkaXNwY19wbGFuZV9lbmFibGUodGlkc3Mt
PmRpc3BjLCB0cGxhbmUtPmh3X3BsYW5lX2lkLCBmYWxzZSk7CisJCXJldHVybjsKKwl9CisKKwlo
d192aWRlb3BvcnQgPSB0b190aWRzc19jcnRjKHN0YXRlLT5jcnRjKS0+aHdfdmlkZW9wb3J0Owor
CisJcmV0ID0gZGlzcGNfcGxhbmVfc2V0dXAodGlkc3MtPmRpc3BjLCB0cGxhbmUtPmh3X3BsYW5l
X2lkLAorCQkJCXN0YXRlLCBod192aWRlb3BvcnQpOworCisJaWYgKHJldCkgeworCQlkZXZfZXJy
KHBsYW5lLT5kZXYtPmRldiwgIiVzOiBGYWlsZWQgdG8gc2V0dXAgcGxhbmUgJWRcbiIsCisJCQlf
X2Z1bmNfXywgdHBsYW5lLT5od19wbGFuZV9pZCk7CisJCWRpc3BjX3BsYW5lX2VuYWJsZSh0aWRz
cy0+ZGlzcGMsIHRwbGFuZS0+aHdfcGxhbmVfaWQsIGZhbHNlKTsKKwkJcmV0dXJuOworCX0KKwor
CWRpc3BjX3BsYW5lX2VuYWJsZSh0aWRzcy0+ZGlzcGMsIHRwbGFuZS0+aHdfcGxhbmVfaWQsIHRy
dWUpOworfQorCitzdGF0aWMgdm9pZCB0aWRzc19wbGFuZV9hdG9taWNfZGlzYWJsZShzdHJ1Y3Qg
ZHJtX3BsYW5lICpwbGFuZSwKKwkJCQkgICAgICAgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqb2xk
X3N0YXRlKQoreworCXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gcGxhbmUtPmRldjsKKwlzdHJ1
Y3QgdGlkc3NfZGV2aWNlICp0aWRzcyA9IGRkZXYtPmRldl9wcml2YXRlOworCXN0cnVjdCB0aWRz
c19wbGFuZSAqdHBsYW5lID0gdG9fdGlkc3NfcGxhbmUocGxhbmUpOworCisJZGV2X2RiZyhkZGV2
LT5kZXYsICIlc1xuIiwgX19mdW5jX18pOworCisJZGlzcGNfcGxhbmVfZW5hYmxlKHRpZHNzLT5k
aXNwYywgdHBsYW5lLT5od19wbGFuZV9pZCwgZmFsc2UpOworfQorCitzdGF0aWMgY29uc3Qgc3Ry
dWN0IGRybV9wbGFuZV9oZWxwZXJfZnVuY3MgdGlkc3NfcGxhbmVfaGVscGVyX2Z1bmNzID0gewor
CS5hdG9taWNfY2hlY2sgPSB0aWRzc19wbGFuZV9hdG9taWNfY2hlY2ssCisJLmF0b21pY191cGRh
dGUgPSB0aWRzc19wbGFuZV9hdG9taWNfdXBkYXRlLAorCS5hdG9taWNfZGlzYWJsZSA9IHRpZHNz
X3BsYW5lX2F0b21pY19kaXNhYmxlLAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fcGxh
bmVfZnVuY3MgdGlkc3NfcGxhbmVfZnVuY3MgPSB7CisJLnVwZGF0ZV9wbGFuZSA9IGRybV9hdG9t
aWNfaGVscGVyX3VwZGF0ZV9wbGFuZSwKKwkuZGlzYWJsZV9wbGFuZSA9IGRybV9hdG9taWNfaGVs
cGVyX2Rpc2FibGVfcGxhbmUsCisJLnJlc2V0ID0gZHJtX2F0b21pY19oZWxwZXJfcGxhbmVfcmVz
ZXQsCisJLmRlc3Ryb3kgPSBkcm1fcGxhbmVfY2xlYW51cCwKKwkuYXRvbWljX2R1cGxpY2F0ZV9z
dGF0ZSA9IGRybV9hdG9taWNfaGVscGVyX3BsYW5lX2R1cGxpY2F0ZV9zdGF0ZSwKKwkuYXRvbWlj
X2Rlc3Ryb3lfc3RhdGUgPSBkcm1fYXRvbWljX2hlbHBlcl9wbGFuZV9kZXN0cm95X3N0YXRlLAor
fTsKKworc3RydWN0IHRpZHNzX3BsYW5lICp0aWRzc19wbGFuZV9jcmVhdGUoc3RydWN0IHRpZHNz
X2RldmljZSAqdGlkc3MsCisJCQkJICAgICAgIHUzMiBod19wbGFuZV9pZCwgdTMyIHBsYW5lX3R5
cGUsCisJCQkJICAgICAgIHUzMiBjcnRjX21hc2ssIGNvbnN0IHUzMiAqZm9ybWF0cywKKwkJCQkg
ICAgICAgdTMyIG51bV9mb3JtYXRzKQoreworCXN0cnVjdCB0aWRzc19wbGFuZSAqdHBsYW5lOwor
CWVudW0gZHJtX3BsYW5lX3R5cGUgdHlwZTsKKwl1MzIgcG9zc2libGVfY3J0Y3M7CisJdTMyIG51
bV9wbGFuZXMgPSB0aWRzcy0+ZmVhdC0+bnVtX3BsYW5lczsKKwl1MzIgY29sb3JfZW5jb2Rpbmdz
ID0gKEJJVChEUk1fQ09MT1JfWUNCQ1JfQlQ2MDEpIHwKKwkJCSAgICAgICBCSVQoRFJNX0NPTE9S
X1lDQkNSX0JUNzA5KSk7CisJdTMyIGNvbG9yX3JhbmdlcyA9IChCSVQoRFJNX0NPTE9SX1lDQkNS
X0ZVTExfUkFOR0UpIHwKKwkJCSAgICBCSVQoRFJNX0NPTE9SX1lDQkNSX0xJTUlURURfUkFOR0Up
KTsKKwl1MzIgZGVmYXVsdF9lbmNvZGluZyA9IERSTV9DT0xPUl9ZQ0JDUl9CVDYwMTsKKwl1MzIg
ZGVmYXVsdF9yYW5nZSA9IERSTV9DT0xPUl9ZQ0JDUl9GVUxMX1JBTkdFOworCXUzMiBibGVuZF9t
b2RlcyA9IChCSVQoRFJNX01PREVfQkxFTkRfUFJFTVVMVEkpIHwKKwkJCSAgIEJJVChEUk1fTU9E
RV9CTEVORF9DT1ZFUkFHRSkpOworCWludCByZXQ7CisKKwl0cGxhbmUgPSBkZXZtX2t6YWxsb2Mo
dGlkc3MtPmRldiwgc2l6ZW9mKCp0cGxhbmUpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIXRwbGFuZSkK
KwkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7CisKKwl0cGxhbmUtPmh3X3BsYW5lX2lkID0gaHdf
cGxhbmVfaWQ7CisKKwlwb3NzaWJsZV9jcnRjcyA9IGNydGNfbWFzazsKKwl0eXBlID0gcGxhbmVf
dHlwZTsKKworCXJldCA9IGRybV91bml2ZXJzYWxfcGxhbmVfaW5pdCh0aWRzcy0+ZGRldiwgJnRw
bGFuZS0+cGxhbmUsCisJCQkJICAgICAgIHBvc3NpYmxlX2NydGNzLAorCQkJCSAgICAgICAmdGlk
c3NfcGxhbmVfZnVuY3MsCisJCQkJICAgICAgIGZvcm1hdHMsIG51bV9mb3JtYXRzLAorCQkJCSAg
ICAgICBOVUxMLCB0eXBlLCBOVUxMKTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0dXJuIEVSUl9QVFIo
cmV0KTsKKworCWRybV9wbGFuZV9oZWxwZXJfYWRkKCZ0cGxhbmUtPnBsYW5lLCAmdGlkc3NfcGxh
bmVfaGVscGVyX2Z1bmNzKTsKKworCWRybV9wbGFuZV9jcmVhdGVfenBvc19wcm9wZXJ0eSgmdHBs
YW5lLT5wbGFuZSwgaHdfcGxhbmVfaWQsIDAsCisJCQkJICAgICAgIG51bV9wbGFuZXMgLSAxKTsK
KworCXJldCA9IGRybV9wbGFuZV9jcmVhdGVfY29sb3JfcHJvcGVydGllcygmdHBsYW5lLT5wbGFu
ZSwKKwkJCQkJCWNvbG9yX2VuY29kaW5ncywKKwkJCQkJCWNvbG9yX3JhbmdlcywKKwkJCQkJCWRl
ZmF1bHRfZW5jb2RpbmcsCisJCQkJCQlkZWZhdWx0X3JhbmdlKTsKKwlpZiAocmV0KQorCQlyZXR1
cm4gRVJSX1BUUihyZXQpOworCisJcmV0ID0gZHJtX3BsYW5lX2NyZWF0ZV9hbHBoYV9wcm9wZXJ0
eSgmdHBsYW5lLT5wbGFuZSk7CisJaWYgKHJldCkKKwkJcmV0dXJuIEVSUl9QVFIocmV0KTsKKwor
CXJldCA9IGRybV9wbGFuZV9jcmVhdGVfYmxlbmRfbW9kZV9wcm9wZXJ0eSgmdHBsYW5lLT5wbGFu
ZSwgYmxlbmRfbW9kZXMpOworCWlmIChyZXQpCisJCXJldHVybiBFUlJfUFRSKHJldCk7CisKKwly
ZXR1cm4gdHBsYW5lOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3RpZHNzL3RpZHNz
X3BsYW5lLmggYi9kcml2ZXJzL2dwdS9kcm0vdGlkc3MvdGlkc3NfcGxhbmUuaApuZXcgZmlsZSBt
b2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjgwZmYxYzVhMjUzNQotLS0gL2Rldi9udWxs
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS90aWRzcy90aWRzc19wbGFuZS5oCkBAIC0wLDAgKzEsMjUg
QEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovCisvKgorICogQ29weXJp
Z2h0IChDKSAyMDE4IFRleGFzIEluc3RydW1lbnRzIEluY29ycG9yYXRlZCAtIGh0dHA6Ly93d3cu
dGkuY29tLworICogQXV0aG9yOiBUb21pIFZhbGtlaW5lbiA8dG9taS52YWxrZWluZW5AdGkuY29t
PgorICovCisKKyNpZm5kZWYgX19USURTU19QTEFORV9IX18KKyNkZWZpbmUgX19USURTU19QTEFO
RV9IX18KKworI2RlZmluZSB0b190aWRzc19wbGFuZShwKSBjb250YWluZXJfb2YoKHApLCBzdHJ1
Y3QgdGlkc3NfcGxhbmUsIHBsYW5lKQorCitzdHJ1Y3QgdGlkc3NfZGV2aWNlOworCitzdHJ1Y3Qg
dGlkc3NfcGxhbmUgeworCXN0cnVjdCBkcm1fcGxhbmUgcGxhbmU7CisKKwl1MzIgaHdfcGxhbmVf
aWQ7Cit9OworCitzdHJ1Y3QgdGlkc3NfcGxhbmUgKnRpZHNzX3BsYW5lX2NyZWF0ZShzdHJ1Y3Qg
dGlkc3NfZGV2aWNlICp0aWRzcywKKwkJCQkgICAgICAgdTMyIGh3X3BsYW5lX2lkLCB1MzIgcGxh
bmVfdHlwZSwKKwkJCQkgICAgICAgdTMyIGNydGNfbWFzaywgY29uc3QgdTMyICpmb3JtYXRzLAor
CQkJCSAgICAgICB1MzIgbnVtX2Zvcm1hdHMpOworCisjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS90aWRzcy90aWRzc19zY2FsZV9jb2Vmcy5jIGIvZHJpdmVycy9ncHUvZHJtL3Rp
ZHNzL3RpZHNzX3NjYWxlX2NvZWZzLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MDAwMDAwLi4zNTMwNmY4MjlkODgKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
dGlkc3MvdGlkc3Nfc2NhbGVfY29lZnMuYwpAQCAtMCwwICsxLDIwMSBAQAorLy8gU1BEWC1MaWNl
bnNlLUlkZW50aWZpZXI6IEdQTC0yLjAKKy8qCisgKiBDb3B5cmlnaHQgKEMpIDIwMTggVGV4YXMg
SW5zdHJ1bWVudHMgSW5jb3Jwb3JhdGVkIC0gaHR0cDovL3d3dy50aS5jb20vCisgKiBBdXRob3I6
IEp5cmkgU2FyaGEgPGpzYXJoYUB0aS5jb20+CisgKi8KKworI2luY2x1ZGUgPGxpbnV4L2tlcm5l
bC5oPgorI2luY2x1ZGUgPGxpbnV4L2RldmljZS5oPgorI2luY2x1ZGUgInRpZHNzX3NjYWxlX2Nv
ZWZzLmgiCisKKy8qCisgKiBUaGVzZSBhcmUgaW50ZXJwb2xhdGVkIHdpdGggYSBjdXN0b20gcHl0
aG9uIHNjcmlwdCBmcm9tIERTUzUKKyAqIChkcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kc3MvZGlz
cGNfY29lZi5jKSBjb2VmZmljaWVudHMuCisgKi8KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgdGlkc3Nf
c2NhbGVfY29lZnMgY29lZjVfTTMyID0geworCS5jMiA9IHsgMjgsIDM0LCA0MCwgNDYsIDUyLCA1
OCwgNjQsIDcwLCAwLCAyLCA0LCA4LCAxMiwgMTYsIDIwLCAyNCwgfSwKKwkuYzEgPSB7IDEzMiwg
MTM4LCAxNDQsIDE1MCwgMTU2LCAxNjIsIDE2OCwgMTc0LCA3NiwgODQsIDkyLCA5OCwgMTA0LCAx
MTAsIDExNiwgMTI0LCB9LAorCS5jMCA9IHsgMTkyLCAxOTIsIDE5MiwgMTkwLCAxODgsIDE4Niwg
MTg0LCAxODIsIDE4MCwgfSwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgdGlkc3Nfc2NhbGVf
Y29lZnMgY29lZjVfTTI2ID0geworCS5jMiA9IHsgMjQsIDI4LCAzMiwgMzgsIDQ0LCA1MCwgNTYs
IDY0LCAwLCAyLCA0LCA2LCA4LCAxMiwgMTYsIDIwLCB9LAorCS5jMSA9IHsgMTMyLCAxMzgsIDE0
NCwgMTUyLCAxNjAsIDE2NiwgMTcyLCAxNzgsIDcyLCA4MCwgODgsIDk0LCAxMDAsIDEwOCwgMTE2
LCAxMjQsIH0sCisJLmMwID0geyAyMDAsIDIwMiwgMjA0LCAyMDIsIDIwMCwgMTk2LCAxOTIsIDE4
OCwgMTg0LCB9LAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCB0aWRzc19zY2FsZV9jb2VmcyBj
b2VmNV9NMjIgPSB7CisJLmMyID0geyAxNiwgMjAsIDI0LCAzMCwgMzYsIDQyLCA0OCwgNTYsIDAs
IDAsIDAsIDIsIDQsIDgsIDEyLCAxNCwgfSwKKwkuYzEgPSB7IDEzMiwgMTQwLCAxNDgsIDE1Niwg
MTY0LCAxNzIsIDE4MCwgMTg2LCA2NCwgNzIsIDgwLCA4OCwgOTYsIDEwNCwgMTEyLCAxMjIsIH0s
CisJLmMwID0geyAyMTYsIDIxNiwgMjE2LCAyMTQsIDIxMiwgMjA4LCAyMDQsIDE5OCwgMTkyLCB9
LAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCB0aWRzc19zY2FsZV9jb2VmcyBjb2VmNV9NMTkg
PSB7CisJLmMyID0geyAxMiwgMTQsIDE2LCAyMiwgMjgsIDM0LCA0MCwgNDgsIDAsIDAsIDAsIDIs
IDQsIDQsIDQsIDgsIH0sCisJLmMxID0geyAxMjgsIDE0MCwgMTUyLCAxNjAsIDE2OCwgMTc2LCAx
ODQsIDE5MiwgNTYsIDY0LCA3MiwgODIsIDkyLCAxMDAsIDEwOCwgMTE4LCB9LAorCS5jMCA9IHsg
MjMyLCAyMzIsIDIzMiwgMjI2LCAyMjAsIDIxOCwgMjE2LCAyMDgsIDIwMCwgfSwKK307CisKK3N0
YXRpYyBjb25zdCBzdHJ1Y3QgdGlkc3Nfc2NhbGVfY29lZnMgY29lZjVfTTE2ID0geworCS5jMiA9
IHsgMCwgMiwgNCwgOCwgMTIsIDE4LCAyNCwgMzIsIDAsIDAsIDAsIC0yLCAtNCwgLTQsIC00LCAt
MiwgfSwKKwkuYzEgPSB7IDEyNCwgMTM4LCAxNTIsIDE2NCwgMTc2LCAxODYsIDE5NiwgMjA2LCA0
MCwgNDgsIDU2LCA2OCwgODAsIDkwLCAxMDAsIDExMiwgfSwKKwkuYzAgPSB7IDI2NCwgMjYyLCAy
NjAsIDI1NCwgMjQ4LCAyNDIsIDIzNiwgMjI2LCAyMTYsIH0sCit9OworCitzdGF0aWMgY29uc3Qg
c3RydWN0IHRpZHNzX3NjYWxlX2NvZWZzIGNvZWY1X00xNCA9IHsKKwkuYzIgPSB7IC04LCAtNiwg
LTQsIC0yLCAwLCA2LCAxMiwgMTgsIDAsIC0yLCAtNCwgLTYsIC04LCAtOCwgLTgsIC04LCB9LAor
CS5jMSA9IHsgMTIwLCAxMzQsIDE0OCwgMTY0LCAxODAsIDE5NCwgMjA4LCAyMjAsIDI0LCAzMiwg
NDAsIDUyLCA2NCwgNzgsIDkyLCAxMDYsIH0sCisJLmMwID0geyAyODgsIDI4NiwgMjg0LCAyODAs
IDI3NiwgMjY2LCAyNTYsIDI0NCwgMjMyLCB9LAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCB0
aWRzc19zY2FsZV9jb2VmcyBjb2VmNV9NMTMgPSB7CisJLmMyID0geyAtMTIsIC0xMiwgLTEyLCAt
MTAsIC04LCAtNCwgMCwgNiwgMCwgLTIsIC00LCAtNiwgLTgsIC0xMCwgLTEyLCAtMTIsIH0sCisJ
LmMxID0geyAxMTIsIDEzMCwgMTQ4LCAxNjQsIDE4MCwgMTk2LCAyMTIsIDIyOCwgMTIsIDIyLCAz
MiwgNDQsIDU2LCA3MCwgODQsIDk4LCB9LAorCS5jMCA9IHsgMzEyLCAzMDgsIDMwNCwgMjk4LCAy
OTIsIDI4MiwgMjcyLCAyNTgsIDI0NCwgfSwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgdGlk
c3Nfc2NhbGVfY29lZnMgY29lZjVfTTEyID0geworCS5jMiA9IHsgLTE2LCAtMTgsIC0yMCwgLTE4
LCAtMTYsIC0xNCwgLTEyLCAtNiwgMCwgLTIsIC00LCAtNiwgLTgsIC0xMCwgLTEyLCAtMTQsIH0s
CisJLmMxID0geyAxMDQsIDEyNCwgMTQ0LCAxNjQsIDE4NCwgMjAyLCAyMjAsIDIzOCwgMCwgMTAs
IDIwLCAzMCwgNDAsIDU2LCA3MiwgODgsIH0sCisJLmMwID0geyAzMzYsIDMzMiwgMzI4LCAzMjAs
IDMxMiwgMzAwLCAyODgsIDI3MiwgMjU2LCB9LAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCB0
aWRzc19zY2FsZV9jb2VmcyBjb2VmNV9NMTEgPSB7CisJLmMyID0geyAtMjAsIC0yMiwgLTI0LCAt
MjQsIC0yNCwgLTI0LCAtMjQsIC0yMCwgMCwgLTIsIC00LCAtNiwgLTgsIC0xMCwgLTEyLCAtMTYs
IH0sCisJLmMxID0geyA5MiwgMTE0LCAxMzYsIDE1OCwgMTgwLCAyMDQsIDIyOCwgMjUwLCAtMTYs
IC04LCAwLCAxMiwgMjQsIDM4LCA1MiwgNzIsIH0sCisJLmMwID0geyAzNjgsIDM2NCwgMzYwLCAz
NTAsIDM0MCwgMzI2LCAzMTIsIDI5MiwgMjcyLCB9LAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVj
dCB0aWRzc19zY2FsZV9jb2VmcyBjb2VmNV9NMTAgPSB7CisJLmMyID0geyAtMTYsIC0yMCwgLTI0
LCAtMjgsIC0zMiwgLTM0LCAtMzYsIC0zNCwgMCwgMCwgMCwgLTIsIC00LCAtOCwgLTEyLCAtMTQs
IH0sCisJLmMxID0geyA3MiwgOTYsIDEyMCwgMTQ4LCAxNzYsIDIwNCwgMjMyLCAyNjAsIC0zMiwg
LTI2LCAtMjAsIC0xMCwgMCwgMTYsIDMyLCA1MiwgfSwKKwkuYzAgPSB7IDQwMCwgMzk4LCAzOTYs
IDM4NCwgMzcyLCAzNTQsIDMzNiwgMzEyLCAyODgsIH0sCit9OworCitzdGF0aWMgY29uc3Qgc3Ry
dWN0IHRpZHNzX3NjYWxlX2NvZWZzIGNvZWY1X005ID0geworCS5jMiA9IHsgLTEyLCAtMTgsIC0y
NCwgLTI4LCAtMzIsIC0zOCwgLTQ0LCAtNDYsIDAsIDIsIDQsIDIsIDAsIC0yLCAtNCwgLTgsIH0s
CisJLmMxID0geyA0MCwgNjgsIDk2LCAxMjgsIDE2MCwgMTk2LCAyMzIsIDI2OCwgLTQ4LCAtNDYs
IC00NCwgLTM2LCAtMjgsIC0xNCwgMCwgMjAsIH0sCisJLmMwID0geyA0NTYsIDQ1MCwgNDQ0LCA0
MjgsIDQxMiwgMzg4LCAzNjQsIDMzNCwgMzA0LCB9LAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVj
dCB0aWRzc19zY2FsZV9jb2VmcyBjb2VmNV9NOCA9IHsKKwkuYzIgPSB7IDAsIC00LCAtOCwgLTE2
LCAtMjQsIC0zMiwgLTQwLCAtNDgsIDAsIDIsIDQsIDYsIDgsIDYsIDQsIDIsIH0sCisJLmMxID0g
eyAwLCAyOCwgNTYsIDk0LCAxMzIsIDE3NiwgMjIwLCAyNjYsIC01NiwgLTYwLCAtNjQsIC02Miwg
LTYwLCAtNTAsIC00MCwgLTIwLCB9LAorCS5jMCA9IHsgNTEyLCA1MDYsIDUwMCwgNDc4LCA0NTYs
IDQyNCwgMzkyLCAzNTIsIDMxMiwgfSwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgdGlkc3Nf
c2NhbGVfY29lZnMgY29lZjNfTTMyID0geworCS5jMSA9IHsgMTA4LCA5MiwgNzYsIDYyLCA0OCwg
MzYsIDI0LCAxNDAsIDI1NiwgMjM2LCAyMTYsIDE5OCwgMTgwLCAxNjIsIDE0NCwgMTI2LCB9LAor
CS5jMCA9IHsgMjk2LCAyOTQsIDI5MiwgMjg4LCAyODQsIDI3OCwgMjcyLCAxMzYsIDI1NiwgfSwK
K307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgdGlkc3Nfc2NhbGVfY29lZnMgY29lZjNfTTI2ID0g
eworCS5jMSA9IHsgMTA0LCA5MCwgNzYsIDYwLCA0NCwgMzIsIDIwLCAxMzgsIDI1NiwgMjM2LCAy
MTYsIDE5OCwgMTgwLCAxNjAsIDE0MCwgMTIyLCB9LAorCS5jMCA9IHsgMzA0LCAzMDAsIDI5Niwg
MjkyLCAyODgsIDI4MiwgMjc2LCAxMzgsIDI1NiwgfSwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1
Y3QgdGlkc3Nfc2NhbGVfY29lZnMgY29lZjNfTTIyID0geworCS5jMSA9IHsgMTAwLCA4NCwgNjgs
IDU0LCA0MCwgMzAsIDIwLCAxMzgsIDI1NiwgMjM2LCAyMTYsIDE5NiwgMTc2LCAxNTYsIDEzNiwg
MTE4LCB9LAorCS5jMCA9IHsgMzEyLCAzMTAsIDMwOCwgMzAyLCAyOTYsIDI4NiwgMjc2LCAxMzgs
IDI1NiwgfSwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgdGlkc3Nfc2NhbGVfY29lZnMgY29l
ZjNfTTE5ID0geworCS5jMSA9IHsgOTYsIDgwLCA2NCwgNTAsIDM2LCAyNiwgMTYsIDEzNiwgMjU2
LCAyMzYsIDIxNiwgMTk0LCAxNzIsIDE1MiwgMTMyLCAxMTQsIH0sCisJLmMwID0geyAzMjAsIDMx
OCwgMzE2LCAzMTAsIDMwNCwgMjkyLCAyODAsIDE0MCwgMjU2LCB9LAorfTsKKworc3RhdGljIGNv
bnN0IHN0cnVjdCB0aWRzc19zY2FsZV9jb2VmcyBjb2VmM19NMTYgPSB7CisJLmMxID0geyA4OCwg
NzIsIDU2LCA0NCwgMzIsIDIyLCAxMiwgMTM0LCAyNTYsIDIzNCwgMjEyLCAxOTAsIDE2OCwgMTQ4
LCAxMjgsIDEwOCwgfSwKKwkuYzAgPSB7IDMzNiwgMzMyLCAzMjgsIDMyMCwgMzEyLCAzMDAsIDI4
OCwgMTQ0LCAyNTYsIH0sCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IHRpZHNzX3NjYWxlX2Nv
ZWZzIGNvZWYzX00xNCA9IHsKKwkuYzEgPSB7IDgwLCA2NCwgNDgsIDM2LCAyNCwgMTYsIDgsIDEz
MiwgMjU2LCAyMzIsIDIwOCwgMTg2LCAxNjQsIDE0MiwgMTIwLCAxMDAsIH0sCisJLmMwID0geyAz
NTIsIDM0OCwgMzQ0LCAzMzQsIDMyNCwgMzEwLCAyOTYsIDE0OCwgMjU2LCB9LAorfTsKKworc3Rh
dGljIGNvbnN0IHN0cnVjdCB0aWRzc19zY2FsZV9jb2VmcyBjb2VmM19NMTMgPSB7CisJLmMxID0g
eyA3MiwgNTYsIDQwLCAzMCwgMjAsIDEyLCA0LCAxMzAsIDI1NiwgMjMyLCAyMDgsIDE4NCwgMTYw
LCAxMzYsIDExMiwgOTIsIH0sCisJLmMwID0geyAzNjgsIDM2NCwgMzYwLCAzNDYsIDMzMiwgMzE2
LCAzMDAsIDE1MCwgMjU2LCB9LAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCB0aWRzc19zY2Fs
ZV9jb2VmcyBjb2VmM19NMTIgPSB7CisJLmMxID0geyA2NCwgNTAsIDM2LCAyNiwgMTYsIDEwLCA0
LCAxMzAsIDI1NiwgMjMwLCAyMDQsIDE3OCwgMTUyLCAxMjgsIDEwNCwgODQsIH0sCisJLmMwID0g
eyAzODQsIDM3OCwgMzcyLCAzNTgsIDM0NCwgMzI0LCAzMDQsIDE1MiwgMjU2LCB9LAorfTsKKwor
c3RhdGljIGNvbnN0IHN0cnVjdCB0aWRzc19zY2FsZV9jb2VmcyBjb2VmM19NMTEgPSB7CisJLmMx
ID0geyA1NiwgNDAsIDI0LCAxNiwgOCwgNCwgMCwgMTI4LCAyNTYsIDIyOCwgMjAwLCAxNzIsIDE0
NCwgMTIwLCA5NiwgNzYsIH0sCisJLmMwID0geyA0MDAsIDM5NiwgMzkyLCAzNzYsIDM2MCwgMzM2
LCAzMTIsIDE1NiwgMjU2LCB9LAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCB0aWRzc19zY2Fs
ZV9jb2VmcyBjb2VmM19NMTAgPSB7CisJLmMxID0geyA0MCwgMjYsIDEyLCA2LCAwLCAtMiwgLTQs
IDEyNiwgMjU2LCAyMjYsIDE5NiwgMTY2LCAxMzYsIDExMCwgODQsIDYyLCB9LAorCS5jMCA9IHsg
NDMyLCA0MjQsIDQxNiwgMzk2LCAzNzYsIDM0OCwgMzIwLCAxNjAsIDI1NiwgfSwKK307CisKK3N0
YXRpYyBjb25zdCBzdHJ1Y3QgdGlkc3Nfc2NhbGVfY29lZnMgY29lZjNfTTkgPSB7CisJLmMxID0g
eyAyNCwgMTIsIDAsIC00LCAtOCwgLTgsIC04LCAxMjQsIDI1NiwgMjIyLCAxODgsIDE1NCwgMTIw
LCA5MiwgNjQsIDQ0LCB9LAorCS5jMCA9IHsgNDY0LCA0NTYsIDQ0OCwgNDI0LCA0MDAsIDM2Niwg
MzMyLCAxNjYsIDI1NiwgfSwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgdGlkc3Nfc2NhbGVf
Y29lZnMgY29lZjNfTTggPSB7CisJLmMxID0geyAwLCAtOCwgLTE2LCAtMTYsIC0xNiwgLTEyLCAt
OCwgMTI0LCAyNTYsIDIxNCwgMTcyLCAxMzQsIDk2LCA2NiwgMzYsIDE4LCB9LAorCS5jMCA9IHsg
NTEyLCA1MDIsIDQ5MiwgNDYyLCA0MzIsIDM5MCwgMzQ4LCAxNzQsIDI1NiwgfSwKK307CisKK2Nv
bnN0IHN0cnVjdCB0aWRzc19zY2FsZV9jb2VmcyAqdGlkc3NfZ2V0X3NjYWxlX2NvZWZzKHN0cnVj
dCBkZXZpY2UgKmRldiwKKwkJCQkJCSAgICAgIHUzMiBmaXJpbmMsCisJCQkJCQkgICAgICBib29s
IGZpdmVfdGFwcykKK3sKKwlpbnQgaTsKKwlpbnQgaW5jOworCXN0YXRpYyBjb25zdCBzdHJ1Y3Qg
eworCQlpbnQgTW1pbjsKKwkJaW50IE1tYXg7CisJCWNvbnN0IHN0cnVjdCB0aWRzc19zY2FsZV9j
b2VmcyAqY29lZjM7CisJCWNvbnN0IHN0cnVjdCB0aWRzc19zY2FsZV9jb2VmcyAqY29lZjU7CisJ
CWNvbnN0IGNoYXIgKm5hbWU7CisJfSBjb2Vmc1tdID0geworCQl7IDI3LCAzMiwgJmNvZWYzX00z
MiwgJmNvZWY1X00zMiwgIk0zMiIgfSwKKwkJeyAyMywgMjYsICZjb2VmM19NMjYsICZjb2VmNV9N
MjYsICJNMjYiIH0sCisJCXsgMjAsIDIyLCAmY29lZjNfTTIyLCAmY29lZjVfTTIyLCAiTTIyIiB9
LAorCQl7IDE3LCAxOSwgJmNvZWYzX00xOSwgJmNvZWY1X00xOSwgIk0xOSIgfSwKKwkJeyAxNSwg
MTYsICZjb2VmM19NMTYsICZjb2VmNV9NMTYsICJNMTYiIH0sCisJCXsgMTQsIDE0LCAmY29lZjNf
TTE0LCAmY29lZjVfTTE0LCAiTTE0IiB9LAorCQl7IDEzLCAxMywgJmNvZWYzX00xMywgJmNvZWY1
X00xMywgIk0xMyIgfSwKKwkJeyAxMiwgMTIsICZjb2VmM19NMTIsICZjb2VmNV9NMTIsICJNMTIi
IH0sCisJCXsgMTEsIDExLCAmY29lZjNfTTExLCAmY29lZjVfTTExLCAiTTExIiB9LAorCQl7IDEw
LCAxMCwgJmNvZWYzX00xMCwgJmNvZWY1X00xMCwgIk0xMCIgfSwKKwkJeyAgOSwgIDksICZjb2Vm
M19NOSwgJmNvZWY1X005LCAiTTkiIH0sCisJCXsgIDQsICA4LCAmY29lZjNfTTgsICZjb2VmNV9N
OCwgIk04IiB9LAorCQkvKgorCQkgKiBXaGVuIHVwc2NhbGluZyBtb3JlIHRoYW4gdHdvIHRpbWVz
LCBibG9ja2luZXNzIGFuZCBvdXRsaW5lcworCQkgKiBhcm91bmQgdGhlIGltYWdlIGFyZSBvYnNl
cnZlZCB3aGVuIE04IHRhYmxlcyBhcmUgdXNlZC4gTTExLAorCQkgKiBNMTYgYW5kIE0xOSB0YWJs
ZXMgYXJlIHVzZWQgdG8gcHJldmVudCB0aGlzLgorCQkgKi8KKwkJeyAgMywgIDMsICZjb2VmM19N
MTEsICZjb2VmNV9NMTEsICJNMTEiIH0sCisJCXsgIDIsICAyLCAmY29lZjNfTTE2LCAmY29lZjVf
TTE2LCAiTTE2IiB9LAorCQl7ICAwLCAgMSwgJmNvZWYzX00xOSwgJmNvZWY1X00xOSwgIk0xOSIg
fSwKKwl9OworCisJLyoKKwkgKiBpbmMgaXMgcmVzdWx0IG9mIDB4MjAwMDAwICogaW5fc2l6ZSAv
IG91dF9zaXplLiBUaGlzIGRpdmlkaW5nCisJICogYnkgMHg0MDAwMCBzY2FsZXMgaXQgZG93biB0
byA4ICogaW5fc2l6ZSAvIG91dF9zaXplLiBBZnRlcgorCSAqIGRpdmlzaW9uIHRoZSBhY3R1YWwg
c2NhbGluZyBmYWN0b3IgaXMgOC9pbmMuCisJICovCisJaW5jID0gZmlyaW5jIC8gMHg0MDAwMDsK
Kwlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShjb2Vmcyk7ICsraSkgeworCQlpZiAoaW5jID49
IGNvZWZzW2ldLk1taW4gJiYgaW5jIDw9IGNvZWZzW2ldLk1tYXgpIHsKKwkJCWlmIChmaXZlX3Rh
cHMpCisJCQkJcmV0dXJuIGNvZWZzW2ldLmNvZWY1OworCQkJZWxzZQorCQkJCXJldHVybiBjb2Vm
c1tpXS5jb2VmMzsKKwkJfQorCX0KKworCWRldl9lcnIoZGV2LCAiJXM6IENvZWZmaWNpZW50cyBu
b3QgZm91bmQgZm9yIGZpcmluYyAweCUwOHgsIGluYyAlZFxuIiwKKwkJX19mdW5jX18sIGZpcmlu
YywgaW5jKTsKKworCXJldHVybiBOVUxMOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L3RpZHNzL3RpZHNzX3NjYWxlX2NvZWZzLmggYi9kcml2ZXJzL2dwdS9kcm0vdGlkc3MvdGlkc3Nf
c2NhbGVfY29lZnMuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjY0
YjVhZjViNTM2MQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90aWRzcy90aWRz
c19zY2FsZV9jb2Vmcy5oCkBAIC0wLDAgKzEsMjIgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlm
aWVyOiBHUEwtMi4wICovCisvKgorICogQ29weXJpZ2h0IChDKSAyMDE4IFRleGFzIEluc3RydW1l
bnRzIEluY29ycG9yYXRlZCAtIGh0dHA6Ly93d3cudGkuY29tLworICogQXV0aG9yOiBKeXJpIFNh
cmhhIDxqc2FyaGFAdGkuY29tPgorICovCisKKyNpZm5kZWYgX19USURTU19ESVNQQ19DT0VGX0hf
XworI2RlZmluZSBfX1RJRFNTX0RJU1BDX0NPRUZfSF9fCisKKyNpbmNsdWRlIDxsaW51eC90eXBl
cy5oPgorCitzdHJ1Y3QgdGlkc3Nfc2NhbGVfY29lZnMgeworCXMxNiBjMlsxNl07CisJczE2IGMx
WzE2XTsKKwl1MTYgYzBbOV07Cit9OworCitjb25zdCBzdHJ1Y3QgdGlkc3Nfc2NhbGVfY29lZnMg
KnRpZHNzX2dldF9zY2FsZV9jb2VmcyhzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkJCQkgICAgICB1
MzIgZmlyaW5jLAorCQkJCQkJICAgICAgYm9vbCBmaXZlX3RhcHMpOworCisjZW5kaWYKLS0gClRl
eGFzIEluc3RydW1lbnRzIEZpbmxhbmQgT3ksIFBvcmtrYWxhbmthdHUgMjIsIDAwMTgwIEhlbHNp
bmtpLiBZLXR1bm51cy9CdXNpbmVzcyBJRDogMDYxNTUyMS00LiBLb3RpcGFpa2thL0RvbWljaWxl
OiBIZWxzaW5raQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
Cmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
