Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 5F3C533C631
	for <lists+dri-devel@lfdr.de>; Mon, 15 Mar 2021 19:54:35 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B651189B3B;
	Mon, 15 Mar 2021 18:54:32 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-qt1-x830.google.com (mail-qt1-x830.google.com
 [IPv6:2607:f8b0:4864:20::830])
 by gabe.freedesktop.org (Postfix) with ESMTPS id ED04E89B3B
 for <dri-devel@lists.freedesktop.org>; Mon, 15 Mar 2021 18:54:31 +0000 (UTC)
Received: by mail-qt1-x830.google.com with SMTP id s2so9894391qtx.10
 for <dri-devel@lists.freedesktop.org>; Mon, 15 Mar 2021 11:54:31 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc:content-transfer-encoding;
 bh=bvP1fntey3WMbeDmkK/4rMKZBCSUqzdNjDtF7wnMzHU=;
 b=twiUnkEeqEH8TT74pnXWRA6nxxqqOMflHO4A5R4k7tBmZh83haoOILsA5ocY3H45Tb
 geHA9r0CqG9cRJfSY+I3W9+7egiVE4J440viMlJpYX1kLydME1d2FN6Fep/e7KtVvRdl
 ba7ONB5ts/la1wvSZZiYOfXPw6ibt/uITAAV/xgvSL51pp5yFkygtxL91ca1SzR91Owa
 oc16ObmFjZaBc9M/Rs+6hh/bnQ4/rJCe6FsJk6eBW9IIzhgi2vomQPIQPmn5ipjopt99
 g4SURkHqKsmJittV4HTRcCPgghOkYRZaXAlDsdqdSq1Sctor9WMIjScyduZa57AeFgpf
 E2NA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc:content-transfer-encoding;
 bh=bvP1fntey3WMbeDmkK/4rMKZBCSUqzdNjDtF7wnMzHU=;
 b=IHOqMsjQtlWGvNJcV/9LfIYuwNzB3eEgCp30D0VIqIKKwnqSKh2jMahkAVdPreoFVz
 5il6e+bJcCswzkUaphDzmPR+Zqk/VbcVRutnR00coKl0N7Rct20qC7ZMutrrA81ky/UH
 ULIEbvm1DcFemoZzB2DQ/P4QWOoKhqcKMqVCcrrMC+gf+45kbSUUShYQK0AoOOJ625Fb
 EvwwZ8ZrBx36j3dhs1lH+j/OdzUnJyl79sQTJdTSujZkdMXIpjxTZSPBLvHelvKKszuM
 XPN27s/HlTQfwHUxa2nevMvKzftcM5w73HidkG9yMRt0IcvbyYvhTC0iMMVTk/OJpUwN
 9QNg==
X-Gm-Message-State: AOAM530KEyHyTyC5SkwvB7LjDsuPGiNVLCZsrnpMssGy67BrUE+9uQ76
 hi0tX7RxYrNZCa2jZjEfax9r/0SYgc4l4D8QmF4=
X-Google-Smtp-Source: ABdhPJzakZ5tdNseADETOvIQsJSNdgBnpbSfABF+kXwwSxCmcZ5kB0QjHKyjpE3B1KZZu9rF+9xwIE2623fGbRu9PaM=
X-Received: by 2002:aed:314f:: with SMTP id 73mr24299955qtg.95.1615834470957; 
 Mon, 15 Mar 2021 11:54:30 -0700 (PDT)
MIME-Version: 1.0
References: <20210315160422.152528-1-christian.koenig@amd.com>
 <20210315160422.152528-2-christian.koenig@amd.com>
In-Reply-To: <20210315160422.152528-2-christian.koenig@amd.com>
From: Matthew Auld <matthew.william.auld@gmail.com>
Date: Mon, 15 Mar 2021 18:54:04 +0000
Message-ID: <CAM0jSHO6L+t8fK_2Ww94vhc0+AZ9KA-9j7razmo92UZKoa1_Lg@mail.gmail.com>
Subject: Re: [PATCH 2/3] drm/ttm: remove swap LRU v2
To: =?UTF-8?Q?Christian_K=C3=B6nig?= <ckoenig.leichtzumerken@gmail.com>
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: ray.huang@amd.com, ML dri-devel <dri-devel@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gTW9uLCAxNSBNYXIgMjAyMSBhdCAxNjowNCwgQ2hyaXN0aWFuIEvDtm5pZwo8Y2tvZW5pZy5s
ZWljaHR6dW1lcmtlbkBnbWFpbC5jb20+IHdyb3RlOgo+Cj4gSW5zdGVhZCBldmljdCByb3VuZCBy
b2JpbiBmcm9tIGVhY2ggZGV2aWNlcyBTWVNURU0gYW5kIFRUIGRvbWFpbi4KPgo+IHYyOiByZW9y
ZGVyIG51bV9wYWdlcyBhY2Nlc3MgcmVwb3J0ZWQgYnkgRGFuJ3Mgc2NyaXB0Cj4KPiBTaWduZWQt
b2ZmLWJ5OiBDaHJpc3RpYW4gS8O2bmlnIDxjaHJpc3RpYW4ua29lbmlnQGFtZC5jb20+Cj4gLS0t
Cj4gIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvLmMgICAgICAgIHwgMzMgKystLS0tLS0tLS0t
LS0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGlsLmMgICB8ICAxIC0KPiAgZHJp
dmVycy9ncHUvZHJtL3R0bS90dG1fZGV2aWNlLmMgICAgfCA2MCArKysrKysrKysrKysrKysrKysr
KystLS0tLS0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9kcnYuYyB8ICAyICst
Cj4gIGluY2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmggICAgICAgIHwgIDEgLQo+ICBpbmNsdWRl
L2RybS90dG0vdHRtX2JvX2RyaXZlci5oICAgICB8ICAxIC0KPiAgaW5jbHVkZS9kcm0vdHRtL3R0
bV9kZXZpY2UuaCAgICAgICAgfCAgNyArLS0tCj4gIDcgZmlsZXMgY2hhbmdlZCwgNTIgaW5zZXJ0
aW9ucygrKSwgNTMgZGVsZXRpb25zKC0pCj4KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L3R0bS90dG1fYm8uYyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvLmMKPiBpbmRleCA1NmQy
ZTM4YWYyNzMuLmExYmU4OGJlMzU3YiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRt
L3R0bV9iby5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm8uYwo+IEBAIC03Myw3
ICs3Myw2IEBAIHN0YXRpYyB2b2lkIHR0bV9ib19kZWxfZnJvbV9scnUoc3RydWN0IHR0bV9idWZm
ZXJfb2JqZWN0ICpibykKPiAgewo+ICAgICAgICAgc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYgPSBi
by0+YmRldjsKPgo+IC0gICAgICAgbGlzdF9kZWxfaW5pdCgmYm8tPnN3YXApOwo+ICAgICAgICAg
bGlzdF9kZWxfaW5pdCgmYm8tPmxydSk7Cj4KPiAgICAgICAgIGlmIChiZGV2LT5mdW5jcy0+ZGVs
X2Zyb21fbHJ1X25vdGlmeSkKPiBAQCAtMTA0LDE2ICsxMDMsNiBAQCB2b2lkIHR0bV9ib19tb3Zl
X3RvX2xydV90YWlsKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCj4KPiAgICAgICAgIG1h
biA9IHR0bV9tYW5hZ2VyX3R5cGUoYmRldiwgbWVtLT5tZW1fdHlwZSk7Cj4gICAgICAgICBsaXN0
X21vdmVfdGFpbCgmYm8tPmxydSwgJm1hbi0+bHJ1W2JvLT5wcmlvcml0eV0pOwo+IC0gICAgICAg
aWYgKG1hbi0+dXNlX3R0ICYmIGJvLT50dG0gJiYKPiAtICAgICAgICAgICAhKGJvLT50dG0tPnBh
Z2VfZmxhZ3MgJiAoVFRNX1BBR0VfRkxBR19TRyB8Cj4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFRUTV9QQUdFX0ZMQUdfU1dBUFBFRCkpKSB7Cj4gLSAgICAgICAgICAgICAg
IHN0cnVjdCBsaXN0X2hlYWQgKnN3YXA7Cj4gLQo+IC0gICAgICAgICAgICAgICBzd2FwID0gJnR0
bV9nbG9iLnN3YXBfbHJ1W2JvLT5wcmlvcml0eV07Cj4gLSAgICAgICAgICAgICAgIGxpc3RfbW92
ZV90YWlsKCZiby0+c3dhcCwgc3dhcCk7Cj4gLSAgICAgICB9IGVsc2Ugewo+IC0gICAgICAgICAg
ICAgICBsaXN0X2RlbF9pbml0KCZiby0+c3dhcCk7Cj4gLSAgICAgICB9Cj4KPiAgICAgICAgIGlm
IChiZGV2LT5mdW5jcy0+ZGVsX2Zyb21fbHJ1X25vdGlmeSkKPiAgICAgICAgICAgICAgICAgYmRl
di0+ZnVuY3MtPmRlbF9mcm9tX2xydV9ub3RpZnkoYm8pOwo+IEBAIC0xMjgsOSArMTE3LDYgQEAg
dm9pZCB0dG1fYm9fbW92ZV90b19scnVfdGFpbChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJv
LAo+ICAgICAgICAgICAgICAgICAgICAgICAgIHR0bV9ib19idWxrX21vdmVfc2V0X3BvcygmYnVs
ay0+dnJhbVtiby0+cHJpb3JpdHldLCBibyk7Cj4gICAgICAgICAgICAgICAgICAgICAgICAgYnJl
YWs7Cj4gICAgICAgICAgICAgICAgIH0KPiAtICAgICAgICAgICAgICAgaWYgKGJvLT50dG0gJiYg
IShiby0+dHRtLT5wYWdlX2ZsYWdzICYKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAoVFRNX1BBR0VfRkxBR19TRyB8IFRUTV9QQUdFX0ZMQUdfU1dBUFBFRCkpKQo+IC0gICAgICAg
ICAgICAgICAgICAgICAgIHR0bV9ib19idWxrX21vdmVfc2V0X3BvcygmYnVsay0+c3dhcFtiby0+
cHJpb3JpdHldLCBibyk7Cj4gICAgICAgICB9Cj4gIH0KPiAgRVhQT1JUX1NZTUJPTCh0dG1fYm9f
bW92ZV90b19scnVfdGFpbCk7Cj4gQEAgLTE2OCwyMCArMTU0LDYgQEAgdm9pZCB0dG1fYm9fYnVs
a19tb3ZlX2xydV90YWlsKHN0cnVjdCB0dG1fbHJ1X2J1bGtfbW92ZSAqYnVsaykKPiAgICAgICAg
ICAgICAgICAgbGlzdF9idWxrX21vdmVfdGFpbCgmbWFuLT5scnVbaV0sICZwb3MtPmZpcnN0LT5s
cnUsCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJnBvcy0+bGFzdC0+bHJ1
KTsKPiAgICAgICAgIH0KPiAtCj4gLSAgICAgICBmb3IgKGkgPSAwOyBpIDwgVFRNX01BWF9CT19Q
UklPUklUWTsgKytpKSB7Cj4gLSAgICAgICAgICAgICAgIHN0cnVjdCB0dG1fbHJ1X2J1bGtfbW92
ZV9wb3MgKnBvcyA9ICZidWxrLT5zd2FwW2ldOwo+IC0gICAgICAgICAgICAgICBzdHJ1Y3QgbGlz
dF9oZWFkICpscnU7Cj4gLQo+IC0gICAgICAgICAgICAgICBpZiAoIXBvcy0+Zmlyc3QpCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgY29udGludWU7Cj4gLQo+IC0gICAgICAgICAgICAgICBkbWFf
cmVzdl9hc3NlcnRfaGVsZChwb3MtPmZpcnN0LT5iYXNlLnJlc3YpOwo+IC0gICAgICAgICAgICAg
ICBkbWFfcmVzdl9hc3NlcnRfaGVsZChwb3MtPmxhc3QtPmJhc2UucmVzdik7Cj4gLQo+IC0gICAg
ICAgICAgICAgICBscnUgPSAmdHRtX2dsb2Iuc3dhcF9scnVbaV07Cj4gLSAgICAgICAgICAgICAg
IGxpc3RfYnVsa19tb3ZlX3RhaWwobHJ1LCAmcG9zLT5maXJzdC0+c3dhcCwgJnBvcy0+bGFzdC0+
c3dhcCk7Cj4gLSAgICAgICB9Cj4gIH0KPiAgRVhQT1JUX1NZTUJPTCh0dG1fYm9fYnVsa19tb3Zl
X2xydV90YWlsKTsKPgo+IEBAIC0xMDU4LDcgKzEwMzAsNiBAQCBpbnQgdHRtX2JvX2luaXRfcmVz
ZXJ2ZWQoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsCj4gICAgICAgICBrcmVmX2luaXQoJmJvLT5r
cmVmKTsKPiAgICAgICAgIElOSVRfTElTVF9IRUFEKCZiby0+bHJ1KTsKPiAgICAgICAgIElOSVRf
TElTVF9IRUFEKCZiby0+ZGRlc3Ryb3kpOwo+IC0gICAgICAgSU5JVF9MSVNUX0hFQUQoJmJvLT5z
d2FwKTsKPiAgICAgICAgIGJvLT5iZGV2ID0gYmRldjsKPiAgICAgICAgIGJvLT50eXBlID0gdHlw
ZTsKPiAgICAgICAgIGJvLT5tZW0ubWVtX3R5cGUgPSBUVE1fUExfU1lTVEVNOwo+IEBAIC0xMTkz
LDYgKzExNjQsMTAgQEAgaW50IHR0bV9ib19zd2Fwb3V0KHN0cnVjdCB0dG1fYnVmZmVyX29iamVj
dCAqYm8sIHN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0eCAqY3R4LAo+ICAgICAgICAgYm9vbCBsb2Nr
ZWQ7Cj4gICAgICAgICBpbnQgcmV0Owo+Cj4gKyAgICAgICBpZiAoIWJvLT50dG0gfHwgYm8tPnR0
bS0+cGFnZV9mbGFncyAmIChUVE1fUEFHRV9GTEFHX1NHIHwKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRUTV9QQUdFX0ZMQUdfU1dBUFBFRCkpCj4gKyAg
ICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKPiArCgpyZXR1cm4gMDsgPwoKU2VlbXMgaW5jb25z
aXN0ZW50IHRvIHJldHVybiB6ZXJvIGhlcmUgYW5kIG5vdCBkcm9wIHRoZSBscnUgbG9jaz8gT3IK
bWF5YmUgdHVybiB0aGlzIGludG8gYSBwcm9ncmFtbWVyIGVycm9yLCBzaW5jZSB0aGUgY3VycmVu
dCBjYWxsZXIKYWxyZWFkeSBjaGVja3MgZm9yIHRoZSBhYm92ZT8KCj4gICAgICAgICBpZiAoIXR0
bV9ib19ldmljdF9zd2Fwb3V0X2FsbG93YWJsZShibywgY3R4LCAmbG9ja2VkLCBOVUxMKSkKPiAg
ICAgICAgICAgICAgICAgcmV0dXJuIC1FQlVTWTsKPgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vdHRtL3R0bV9ib191dGlsLmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGls
LmMKPiBpbmRleCAwMzFlNTgxOWZlYzQuLmEyYTE3Yzg0Y2ViMyAxMDA2NDQKPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGlsLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vdHRt
L3R0bV9ib191dGlsLmMKPiBAQCAtMzAzLDcgKzMwMyw2IEBAIHN0YXRpYyBpbnQgdHRtX2J1ZmZl
cl9vYmplY3RfdHJhbnNmZXIoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKPiAgICAgICAg
IGF0b21pY19pbmMoJnR0bV9nbG9iLmJvX2NvdW50KTsKPiAgICAgICAgIElOSVRfTElTVF9IRUFE
KCZmYm8tPmJhc2UuZGRlc3Ryb3kpOwo+ICAgICAgICAgSU5JVF9MSVNUX0hFQUQoJmZiby0+YmFz
ZS5scnUpOwo+IC0gICAgICAgSU5JVF9MSVNUX0hFQUQoJmZiby0+YmFzZS5zd2FwKTsKPiAgICAg
ICAgIGZiby0+YmFzZS5tb3ZpbmcgPSBOVUxMOwo+ICAgICAgICAgZHJtX3ZtYV9ub2RlX3Jlc2V0
KCZmYm8tPmJhc2UuYmFzZS52bWFfbm9kZSk7Cj4KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL3R0bS90dG1fZGV2aWNlLmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9kZXZpY2UuYwo+
IGluZGV4IGRmYzJhN2U0ZTQ5MC4uMmMyODBmYjFlOTkyIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS90dG0vdHRtX2RldmljZS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1f
ZGV2aWNlLmMKPiBAQCAtNjcsNyArNjcsNiBAQCBzdGF0aWMgaW50IHR0bV9nbG9iYWxfaW5pdCh2
b2lkKQo+ICAgICAgICAgdW5zaWduZWQgbG9uZyBudW1fcGFnZXM7Cj4gICAgICAgICBzdHJ1Y3Qg
c3lzaW5mbyBzaTsKPiAgICAgICAgIGludCByZXQgPSAwOwo+IC0gICAgICAgdW5zaWduZWQgaTsK
Pgo+ICAgICAgICAgbXV0ZXhfbG9jaygmdHRtX2dsb2JhbF9tdXRleCk7Cj4gICAgICAgICBpZiAo
Kyt0dG1fZ2xvYl91c2VfY291bnQgPiAxKQo+IEBAIC05MCw4ICs4OSw2IEBAIHN0YXRpYyBpbnQg
dHRtX2dsb2JhbF9pbml0KHZvaWQpCj4gICAgICAgICAgICAgICAgIGdvdG8gb3V0Owo+ICAgICAg
ICAgfQo+Cj4gLSAgICAgICBmb3IgKGkgPSAwOyBpIDwgVFRNX01BWF9CT19QUklPUklUWTsgKytp
KQo+IC0gICAgICAgICAgICAgICBJTklUX0xJU1RfSEVBRCgmZ2xvYi0+c3dhcF9scnVbaV0pOwo+
ICAgICAgICAgSU5JVF9MSVNUX0hFQUQoJmdsb2ItPmRldmljZV9saXN0KTsKPiAgICAgICAgIGF0
b21pY19zZXQoJmdsb2ItPmJvX2NvdW50LCAwKTsKPgo+IEBAIC0xMDksMjcgKzEwNiw2MCBAQCBz
dGF0aWMgaW50IHR0bV9nbG9iYWxfaW5pdCh2b2lkKQo+ICBsb25nIHR0bV9nbG9iYWxfc3dhcG91
dChzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHggKmN0eCwgZ2ZwX3QgZ2ZwX2ZsYWdzKQo+ICB7Cj4g
ICAgICAgICBzdHJ1Y3QgdHRtX2dsb2JhbCAqZ2xvYiA9ICZ0dG1fZ2xvYjsKPiArICAgICAgIHN0
cnVjdCB0dG1fZGV2aWNlICpiZGV2Owo+ICsgICAgICAgaW50IHJldCA9IC1FQlVTWTsKPiArCj4g
KyAgICAgICBtdXRleF9sb2NrKCZ0dG1fZ2xvYmFsX211dGV4KTsKPiArICAgICAgIGxpc3RfZm9y
X2VhY2hfZW50cnkoYmRldiwgJmdsb2ItPmRldmljZV9saXN0LCBkZXZpY2VfbGlzdCkgewo+ICsg
ICAgICAgICAgICAgICByZXQgPSB0dG1fZGV2aWNlX3N3YXBvdXQoYmRldiwgY3R4LCBnZnBfZmxh
Z3MpOwoKTWl4aW5nIGludCBhbmQgbG9uZyBmb3IgbnVtX3BhZ2VzLgoKRG9lcyB0dG0gZW5mb3Jj
ZSBhIG1heGltdW0gcGFnZSBjb3VudCBzb21ld2hlcmUgZm9yIG9iamVjdCBzaXplcz8KU29tZXRo
aW5nIGxpa2UgSU5UX01BWCwgc2luY2UgaXQgZG9lc24ndCBsb29rIGxpa2UgdHRtIGlzIGNvbnNp
c3RlbnRseQp1c2luZyB0aGUgc2FtZSB0eXBlKHVuc2lnbmVkIGxvbmc/KSB3aGVuIHJlcHJlc2Vu
dGluZyB0aGUgbnVtYmVyIG9mCnBhZ2VzIGZvciBhbiBvYmplY3Q/Cgo+ICsgICAgICAgICAgICAg
ICBpZiAocmV0ID4gMCkgewo+ICsgICAgICAgICAgICAgICAgICAgICAgIGxpc3RfbW92ZV90YWls
KCZiZGV2LT5kZXZpY2VfbGlzdCwgJmdsb2ItPmRldmljZV9saXN0KTsKPiArICAgICAgICAgICAg
ICAgICAgICAgICBicmVhazsKPiArICAgICAgICAgICAgICAgfQo+ICsgICAgICAgfQo+ICsgICAg
ICAgbXV0ZXhfdW5sb2NrKCZ0dG1fZ2xvYmFsX211dGV4KTsKPiArICAgICAgIHJldHVybiByZXQ7
Cj4gK30KPiArRVhQT1JUX1NZTUJPTCh0dG1fZ2xvYmFsX3N3YXBvdXQpOwo+ICsKPiArbG9uZyB0
dG1fZGV2aWNlX3N3YXBvdXQoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fb3Bl
cmF0aW9uX2N0eCAqY3R4LAo+ICsgICAgICAgICAgICAgICAgICAgICAgIGdmcF90IGdmcF9mbGFn
cykKPiArewo+ICsgICAgICAgc3RydWN0IHR0bV9nbG9iYWwgKmdsb2IgPSAmdHRtX2dsb2I7Cj4g
KyAgICAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbjsKPiAgICAgICAgIHN0cnVj
dCB0dG1fYnVmZmVyX29iamVjdCAqYm87Cj4gLSAgICAgICB1bnNpZ25lZCBpOwo+ICsgICAgICAg
dW5zaWduZWQgaSwgajsKPiAgICAgICAgIGludCByZXQ7Cj4KPiAgICAgICAgIHNwaW5fbG9jaygm
Z2xvYi0+bHJ1X2xvY2spOwo+IC0gICAgICAgZm9yIChpID0gMDsgaSA8IFRUTV9NQVhfQk9fUFJJ
T1JJVFk7ICsraSkgewo+IC0gICAgICAgICAgICAgICBsaXN0X2Zvcl9lYWNoX2VudHJ5KGJvLCAm
Z2xvYi0+c3dhcF9scnVbaV0sIHN3YXApIHsKPiAtICAgICAgICAgICAgICAgICAgICAgICB1aW50
MzJfdCBudW1fcGFnZXMgPSBiby0+dHRtLT5udW1fcGFnZXM7Cj4gLQo+IC0gICAgICAgICAgICAg
ICAgICAgICAgIHJldCA9IHR0bV9ib19zd2Fwb3V0KGJvLCBjdHgsIGdmcF9mbGFncyk7Cj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgLyogdHRtX2JvX3N3YXBvdXQgaGFzIGRyb3BwZWQgdGhlIGxy
dV9sb2NrICovCj4gLSAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXQpCj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVtX3BhZ2VzOwo+IC0gICAgICAgICAgICAg
ICAgICAgICAgIGlmIChyZXQgIT0gLUVCVVNZKQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgcmV0dXJuIHJldDsKPiArICAgICAgIGZvciAoaSA9IFRUTV9QTF9TWVNURU07IGkgPCBU
VE1fTlVNX01FTV9UWVBFUzsgKytpKSB7Cj4gKyAgICAgICAgICAgICAgIG1hbiA9IHR0bV9tYW5h
Z2VyX3R5cGUoYmRldiwgaSk7Cj4gKyAgICAgICAgICAgICAgIGlmICghbWFuIHx8ICFtYW4tPnVz
ZV90dCkKPiArICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKPiArCj4gKyAgICAgICAg
ICAgICAgIGZvciAoaiA9IDA7IGogPCBUVE1fTUFYX0JPX1BSSU9SSVRZOyArK2opIHsKPiArICAg
ICAgICAgICAgICAgICAgICAgICBsaXN0X2Zvcl9lYWNoX2VudHJ5KGJvLCAmbWFuLT5scnVbal0s
IGxydSkgewo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9uZyBudW1fcGFnZXM7
Cj4gKwo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiby0+dHRtIHx8Cj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm8tPnR0bS0+cGFnZV9mbGFncyAm
IFRUTV9QQUdFX0ZMQUdfU0cgfHwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBiby0+dHRtLT5wYWdlX2ZsYWdzICYgVFRNX1BBR0VfRkxBR19TV0FQUEVEKQo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKPiArCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBudW1fcGFnZXMgPSBiby0+dHRtLT5udW1fcGFnZXM7Cj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXQgPSB0dG1fYm9fc3dhcG91dChibywg
Y3R4LCBnZnBfZmxhZ3MpOwo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogdHRt
X2JvX3N3YXBvdXQgaGFzIGRyb3BwZWQgdGhlIGxydV9sb2NrICovCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBpZiAoIXJldCkKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgcmV0dXJuIG51bV9wYWdlczsKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGlmIChyZXQgIT0gLUVCVVNZKQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICByZXR1cm4gcmV0Owo+ICsgICAgICAgICAgICAgICAgICAgICAgIH0KPiAgICAg
ICAgICAgICAgICAgfQo+ICAgICAgICAgfQo+ICAgICAgICAgc3Bpbl91bmxvY2soJmdsb2ItPmxy
dV9sb2NrKTsKPiAgICAgICAgIHJldHVybiAwOwo+ICB9Cj4gLUVYUE9SVF9TWU1CT0wodHRtX2ds
b2JhbF9zd2Fwb3V0KTsKPiArRVhQT1JUX1NZTUJPTCh0dG1fZGV2aWNlX3N3YXBvdXQpOwo+Cj4g
IHN0YXRpYyB2b2lkIHR0bV9pbml0X3N5c21hbihzdHJ1Y3QgdHRtX2RldmljZSAqYmRldikKPiAg
ewo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9kcnYuYyBiL2Ry
aXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2Rydi5jCj4gaW5kZXggYjk5MTQyMmUxNTZjLi4w
ZTgyYjA2NjJkOWUgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhf
ZHJ2LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9kcnYuYwo+IEBAIC0x
MzcxLDcgKzEzNzEsNyBAQCBzdGF0aWMgaW50IHZtd19wbV9mcmVlemUoc3RydWN0IGRldmljZSAq
a2RldikKPiAgICAgICAgIHZtd19leGVjYnVmX3JlbGVhc2VfcGlubmVkX2JvKGRldl9wcml2KTsK
PiAgICAgICAgIHZtd19yZXNvdXJjZV9ldmljdF9hbGwoZGV2X3ByaXYpOwo+ICAgICAgICAgdm13
X3JlbGVhc2VfZGV2aWNlX2Vhcmx5KGRldl9wcml2KTsKPiAtICAgICAgIHdoaWxlICh0dG1fZ2xv
YmFsX3N3YXBvdXQoJmN0eCwgR0ZQX0tFUk5FTCkgPiAwKTsKPiArICAgICAgIHdoaWxlICh0dG1f
ZGV2aWNlX3N3YXBvdXQoJmRldl9wcml2LT5iZGV2LCAmY3R4LCBHRlBfS0VSTkVMKSA9PSAwKTsK
CklzIHRoaXMgdGhlIGludGVuZGVkIGJlaGF2aW91cj8gdHRtX2RldmljZV9zd2Fwb3V0KCkgc3Rp
bGwganVzdApyZXR1cm5zIG51bV9wYWdlcyBpZiBpdCBzd2FwcGVkIHNvbWV0aGluZyBvdXQuIEkg
YXNzdW1lIHRoaXMgd2FudHMgdG8Ka2VlcCBzd2FwcGluZyBzdHVmZiBvdXQsIHVudGlsIGl0IGNh
bid0IGFueW1vcmUuIE9yIGFtIEkgbWlzc2luZwpzb21ldGhpbmc/Cgo+ICAgICAgICAgaWYgKGRl
dl9wcml2LT5lbmFibGVfZmIpCj4gICAgICAgICAgICAgICAgIHZtd19maWZvX3Jlc291cmNlX2Rl
YyhkZXZfcHJpdik7Cj4gICAgICAgICBpZiAoYXRvbWljX3JlYWQoJmRldl9wcml2LT5udW1fZmlm
b19yZXNvdXJjZXMpICE9IDApIHsKPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0vdHRtL3R0bV9i
b19hcGkuaCBiL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmgKPiBpbmRleCA1MDQ0YWMzMzA4
NTguLjM1ODdmNjYwZThmNCAxMDA2NDQKPiAtLS0gYS9pbmNsdWRlL2RybS90dG0vdHRtX2JvX2Fw
aS5oCj4gKysrIGIvaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19hcGkuaAo+IEBAIC0xNDQsNyArMTQ0
LDYgQEAgc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0IHsKPgo+ICAgICAgICAgc3RydWN0IGxpc3Rf
aGVhZCBscnU7Cj4gICAgICAgICBzdHJ1Y3QgbGlzdF9oZWFkIGRkZXN0cm95Owo+IC0gICAgICAg
c3RydWN0IGxpc3RfaGVhZCBzd2FwOwo+Cj4gICAgICAgICAvKioKPiAgICAgICAgICAqIE1lbWJl
cnMgcHJvdGVjdGVkIGJ5IGEgYm8gcmVzZXJ2YXRpb24uCj4gZGlmZiAtLWdpdCBhL2luY2x1ZGUv
ZHJtL3R0bS90dG1fYm9fZHJpdmVyLmggYi9pbmNsdWRlL2RybS90dG0vdHRtX2JvX2RyaXZlci5o
Cj4gaW5kZXggODk1OWMwMDc1Y2ZkLi5kMDA3ZmVlZjc2NzYgMTAwNjQ0Cj4gLS0tIGEvaW5jbHVk
ZS9kcm0vdHRtL3R0bV9ib19kcml2ZXIuaAo+ICsrKyBiL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9f
ZHJpdmVyLmgKPiBAQCAtNjksNyArNjksNiBAQCBzdHJ1Y3QgdHRtX2xydV9idWxrX21vdmVfcG9z
IHsKPiAgc3RydWN0IHR0bV9scnVfYnVsa19tb3ZlIHsKPiAgICAgICAgIHN0cnVjdCB0dG1fbHJ1
X2J1bGtfbW92ZV9wb3MgdHRbVFRNX01BWF9CT19QUklPUklUWV07Cj4gICAgICAgICBzdHJ1Y3Qg
dHRtX2xydV9idWxrX21vdmVfcG9zIHZyYW1bVFRNX01BWF9CT19QUklPUklUWV07Cj4gLSAgICAg
ICBzdHJ1Y3QgdHRtX2xydV9idWxrX21vdmVfcG9zIHN3YXBbVFRNX01BWF9CT19QUklPUklUWV07
Cj4gIH07Cj4KPiAgLyoKPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0vdHRtL3R0bV9kZXZpY2Uu
aCBiL2luY2x1ZGUvZHJtL3R0bS90dG1fZGV2aWNlLmgKPiBpbmRleCA2YTBiMjY3ZDRmZTYuLmNk
YTZlZmI0YzM0YiAxMDA2NDQKPiAtLS0gYS9pbmNsdWRlL2RybS90dG0vdHRtX2RldmljZS5oCj4g
KysrIGIvaW5jbHVkZS9kcm0vdHRtL3R0bV9kZXZpY2UuaAo+IEBAIC02MywxMSArNjMsNiBAQCBl
eHRlcm4gc3RydWN0IHR0bV9nbG9iYWwgewo+ICAgICAgICAgICovCj4gICAgICAgICBzdHJ1Y3Qg
bGlzdF9oZWFkIGRldmljZV9saXN0Owo+Cj4gLSAgICAgICAvKioKPiAtICAgICAgICAqIFByb3Rl
Y3RlZCBieSB0aGUgbHJ1X2xvY2suCj4gLSAgICAgICAgKi8KPiAtICAgICAgIHN0cnVjdCBsaXN0
X2hlYWQgc3dhcF9scnVbVFRNX01BWF9CT19QUklPUklUWV07Cj4gLQo+ICAgICAgICAgLyoqCj4g
ICAgICAgICAgKiBJbnRlcm5hbCBwcm90ZWN0aW9uLgo+ICAgICAgICAgICovCj4gQEAgLTI5OCw2
ICsyOTMsOCBAQCBzdHJ1Y3QgdHRtX2RldmljZSB7Cj4gIH07Cj4KPiAgbG9uZyB0dG1fZ2xvYmFs
X3N3YXBvdXQoc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4ICpjdHgsIGdmcF90IGdmcF9mbGFncyk7
Cj4gK2xvbmcgdHRtX2RldmljZV9zd2Fwb3V0KHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LCBzdHJ1
Y3QgdHRtX29wZXJhdGlvbl9jdHggKmN0eCwKPiArICAgICAgICAgICAgICAgICAgICAgIGdmcF90
IGdmcF9mbGFncyk7Cj4KPiAgc3RhdGljIGlubGluZSBzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFn
ZXIgKgo+ICB0dG1fbWFuYWdlcl90eXBlKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LCBpbnQgbWVt
X3R5cGUpCj4gLS0KPiAyLjI1LjEKPgo+IF9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fCj4gZHJpLWRldmVsIG1haWxpbmcgbGlzdAo+IGRyaS1kZXZlbEBsaXN0
cy5mcmVlZGVza3RvcC5vcmcKPiBodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFu
L2xpc3RpbmZvL2RyaS1kZXZlbApfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVz
a3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9k
cmktZGV2ZWwK
