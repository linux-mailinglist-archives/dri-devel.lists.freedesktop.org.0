Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 15D9287946
	for <lists+dri-devel@lfdr.de>; Fri,  9 Aug 2019 14:04:33 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6D43489341;
	Fri,  9 Aug 2019 12:04:29 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from metis.ext.pengutronix.de (metis.ext.pengutronix.de
 [IPv6:2001:67c:670:201:290:27ff:fe1d:cc33])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0825D89565
 for <dri-devel@lists.freedesktop.org>; Fri,  9 Aug 2019 12:04:28 +0000 (UTC)
Received: from dude02.hi.pengutronix.de ([2001:67c:670:100:1d::28]
 helo=dude02.pengutronix.de.)
 by metis.ext.pengutronix.de with esmtp (Exim 4.92)
 (envelope-from <l.stach@pengutronix.de>)
 id 1hw3dA-00055N-9s; Fri, 09 Aug 2019 14:04:24 +0200
From: Lucas Stach <l.stach@pengutronix.de>
To: etnaviv@lists.freedesktop.org
Subject: [PATCH v3 3/8] drm/etnaviv: share a single cmdbuf suballoc region
 across all GPUs
Date: Fri,  9 Aug 2019 14:04:19 +0200
Message-Id: <20190809120424.32679-3-l.stach@pengutronix.de>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190809120424.32679-1-l.stach@pengutronix.de>
References: <20190809120424.32679-1-l.stach@pengutronix.de>
MIME-Version: 1.0
X-SA-Exim-Connect-IP: 2001:67c:670:100:1d::28
X-SA-Exim-Mail-From: l.stach@pengutronix.de
X-SA-Exim-Scanned: No (on metis.ext.pengutronix.de);
 SAEximRunCond expanded to false
X-PTX-Original-Recipient: dri-devel@lists.freedesktop.org
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: patchwork-lst@pengutronix.de, kernel@pengutronix.de,
 dri-devel@lists.freedesktop.org, Russell King <linux+etnaviv@armlinux.org.uk>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlcmUgaXMgbm8gbmVlZCBmb3IgZWFjaCBHUFUgdG8gaGF2ZSBpdCdzIG93biBjbWRidWYgc3Vi
YWxsb2NhdGlvbgpyZWdpb24uIE9ubHkgYWxsb2NhdGUgYSBzaW5nbGUgb25lIGZvciB0aGUgdGhl
IGV0bmF2aXYgdmlydHVhbCBkZXZpY2UKYW5kIHNoYXJlIGl0IGFjcm9zcyBhbGwgR1BVcy4KCkFz
IHRoZSBzdWJhbGxvYyBzcGFjZSBpcyBub3cgcG90ZW50aWFsbHkgc2hhcmVkIGJ5IG1vcmUgaGFy
ZHdhcmUgam9icwpydW5uaW5nIGluIHBhcmFsbGVsLCBkb3VibGUgaXRzIHNpemUgdG8gNTEyS0Ig
dG8gYXZvaWQgY29udGVudGlvbi4KClNpZ25lZC1vZmYtYnk6IEx1Y2FzIFN0YWNoIDxsLnN0YWNo
QHBlbmd1dHJvbml4LmRlPgpSZXZpZXdlZC1ieTogUGhpbGlwcCBaYWJlbCA8cC56YWJlbEBwZW5n
dXRyb25peC5kZT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2NtZGJ1Zi5j
ICAgICB8IDE0ICsrKysrKystLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2
X2NtZGJ1Zi5oICAgICB8ICA0ICsrLS0KIGRyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZf
ZHJ2LmMgICAgICAgIHwgMTkgKysrKysrKysrKysrKysrLS0tLQogZHJpdmVycy9ncHUvZHJtL2V0
bmF2aXYvZXRuYXZpdl9kcnYuaCAgICAgICAgfCAgMiArKwogZHJpdmVycy9ncHUvZHJtL2V0bmF2
aXYvZXRuYXZpdl9nZW1fc3VibWl0LmMgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYv
ZXRuYXZpdl9ncHUuYyAgICAgICAgfCAxNyArKysrLS0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUv
ZHJtL2V0bmF2aXYvZXRuYXZpdl9ncHUuaCAgICAgICAgfCAgMSAtCiA3IGZpbGVzIGNoYW5nZWQs
IDMxIGluc2VydGlvbnMoKyksIDI4IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9ldG5hdml2L2V0bmF2aXZfY21kYnVmLmMgYi9kcml2ZXJzL2dwdS9kcm0vZXRuYXZp
di9ldG5hdml2X2NtZGJ1Zi5jCmluZGV4IGU4NDJkOTg4ZWRkNC4uYjBiYWJjMGY3MjMwIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2NtZGJ1Zi5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfY21kYnVmLmMKQEAgLTEzLDEzICsxMywxMyBA
QAogI2luY2x1ZGUgImV0bmF2aXZfbW11LmgiCiAjaW5jbHVkZSAiZXRuYXZpdl9wZXJmbW9uLmgi
CiAKLSNkZWZpbmUgU1VCQUxMT0NfU0laRQkJU1pfMjU2SworI2RlZmluZSBTVUJBTExPQ19TSVpF
CQlTWl81MTJLCiAjZGVmaW5lIFNVQkFMTE9DX0dSQU5VTEUJU1pfNEsKICNkZWZpbmUgU1VCQUxM
T0NfR1JBTlVMRVMJKFNVQkFMTE9DX1NJWkUgLyBTVUJBTExPQ19HUkFOVUxFKQogCiBzdHJ1Y3Qg
ZXRuYXZpdl9jbWRidWZfc3ViYWxsb2MgewogCS8qIHN1YmFsbG9jYXRlZCBkbWEgYnVmZmVyIHBy
b3BlcnRpZXMgKi8KLQlzdHJ1Y3QgZXRuYXZpdl9ncHUgKmdwdTsKKwlzdHJ1Y3QgZGV2aWNlICpk
ZXY7CiAJdm9pZCAqdmFkZHI7CiAJZG1hX2FkZHJfdCBwYWRkcjsKIApAQCAtMzEsNyArMzEsNyBA
QCBzdHJ1Y3QgZXRuYXZpdl9jbWRidWZfc3ViYWxsb2MgewogfTsKIAogc3RydWN0IGV0bmF2aXZf
Y21kYnVmX3N1YmFsbG9jICoKLWV0bmF2aXZfY21kYnVmX3N1YmFsbG9jX25ldyhzdHJ1Y3QgZXRu
YXZpdl9ncHUgKiBncHUpCitldG5hdml2X2NtZGJ1Zl9zdWJhbGxvY19uZXcoc3RydWN0IGRldmlj
ZSAqZGV2KQogewogCXN0cnVjdCBldG5hdml2X2NtZGJ1Zl9zdWJhbGxvYyAqc3ViYWxsb2M7CiAJ
aW50IHJldDsKQEAgLTQwLDExICs0MCwxMSBAQCBldG5hdml2X2NtZGJ1Zl9zdWJhbGxvY19uZXco
c3RydWN0IGV0bmF2aXZfZ3B1ICogZ3B1KQogCWlmICghc3ViYWxsb2MpCiAJCXJldHVybiBFUlJf
UFRSKC1FTk9NRU0pOwogCi0Jc3ViYWxsb2MtPmdwdSA9IGdwdTsKKwlzdWJhbGxvYy0+ZGV2ID0g
ZGV2OwogCW11dGV4X2luaXQoJnN1YmFsbG9jLT5sb2NrKTsKIAlpbml0X3dhaXRxdWV1ZV9oZWFk
KCZzdWJhbGxvYy0+ZnJlZV9ldmVudCk7CiAKLQlzdWJhbGxvYy0+dmFkZHIgPSBkbWFfYWxsb2Nf
d2MoZ3B1LT5kZXYsIFNVQkFMTE9DX1NJWkUsCisJc3ViYWxsb2MtPnZhZGRyID0gZG1hX2FsbG9j
X3djKGRldiwgU1VCQUxMT0NfU0laRSwKIAkJCQkgICAgICAgJnN1YmFsbG9jLT5wYWRkciwgR0ZQ
X0tFUk5FTCk7CiAJaWYgKCFzdWJhbGxvYy0+dmFkZHIpIHsKIAkJcmV0ID0gLUVOT01FTTsKQEAg
LTc2LDcgKzc2LDcgQEAgdm9pZCBldG5hdml2X2NtZGJ1Zl9zdWJhbGxvY191bm1hcChzdHJ1Y3Qg
ZXRuYXZpdl9pb21tdSAqbW11LAogCiB2b2lkIGV0bmF2aXZfY21kYnVmX3N1YmFsbG9jX2Rlc3Ry
b3koc3RydWN0IGV0bmF2aXZfY21kYnVmX3N1YmFsbG9jICpzdWJhbGxvYykKIHsKLQlkbWFfZnJl
ZV93YyhzdWJhbGxvYy0+Z3B1LT5kZXYsIFNVQkFMTE9DX1NJWkUsIHN1YmFsbG9jLT52YWRkciwK
KwlkbWFfZnJlZV93YyhzdWJhbGxvYy0+ZGV2LCBTVUJBTExPQ19TSVpFLCBzdWJhbGxvYy0+dmFk
ZHIsCiAJCSAgICBzdWJhbGxvYy0+cGFkZHIpOwogCWtmcmVlKHN1YmFsbG9jKTsKIH0KQEAgLTEw
MSw3ICsxMDEsNyBAQCBpbnQgZXRuYXZpdl9jbWRidWZfaW5pdChzdHJ1Y3QgZXRuYXZpdl9jbWRi
dWZfc3ViYWxsb2MgKnN1YmFsbG9jLAogCQkJCQkJICAgICAgIHN1YmFsbG9jLT5mcmVlX3NwYWNl
LAogCQkJCQkJICAgICAgIG1zZWNzX3RvX2ppZmZpZXMoMTAgKiAxMDAwKSk7CiAJCWlmICghcmV0
KSB7Ci0JCQlkZXZfZXJyKHN1YmFsbG9jLT5ncHUtPmRldiwKKwkJCWRldl9lcnIoc3ViYWxsb2Mt
PmRldiwKIAkJCQkiVGltZW91dCB3YWl0aW5nIGZvciBjbWRidWYgc3BhY2VcbiIpOwogCQkJcmV0
dXJuIC1FVElNRURPVVQ7CiAJCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2
L2V0bmF2aXZfY21kYnVmLmggYi9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2NtZGJ1
Zi5oCmluZGV4IDU4M2Y1NmJmMDExYy4uYTI4NjY4ZTQ2ZTI2IDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2NtZGJ1Zi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9l
dG5hdml2L2V0bmF2aXZfY21kYnVmLmgKQEAgLTgsNyArOCw3IEBACiAKICNpbmNsdWRlIDxsaW51
eC90eXBlcy5oPgogCi1zdHJ1Y3QgZXRuYXZpdl9ncHU7CitzdHJ1Y3QgZGV2aWNlOwogc3RydWN0
IGV0bmF2aXZfaW9tbXU7CiBzdHJ1Y3QgZXRuYXZpdl92cmFtX21hcHBpbmc7CiBzdHJ1Y3QgZXRu
YXZpdl9jbWRidWZfc3ViYWxsb2M7CkBAIC0yNSw3ICsyNSw3IEBAIHN0cnVjdCBldG5hdml2X2Nt
ZGJ1ZiB7CiB9OwogCiBzdHJ1Y3QgZXRuYXZpdl9jbWRidWZfc3ViYWxsb2MgKgotZXRuYXZpdl9j
bWRidWZfc3ViYWxsb2NfbmV3KHN0cnVjdCBldG5hdml2X2dwdSAqIGdwdSk7CitldG5hdml2X2Nt
ZGJ1Zl9zdWJhbGxvY19uZXcoc3RydWN0IGRldmljZSAqZGV2KTsKIHZvaWQgZXRuYXZpdl9jbWRi
dWZfc3ViYWxsb2NfZGVzdHJveShzdHJ1Y3QgZXRuYXZpdl9jbWRidWZfc3ViYWxsb2MgKnN1YmFs
bG9jKTsKIGludCBldG5hdml2X2NtZGJ1Zl9zdWJhbGxvY19tYXAoc3RydWN0IGV0bmF2aXZfY21k
YnVmX3N1YmFsbG9jICpzdWJhbGxvYywKIAkJCQlzdHJ1Y3QgZXRuYXZpdl9pb21tdSAqbW11LApk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9kcnYuYyBiL2RyaXZl
cnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZHJ2LmMKaW5kZXggOWQ0NDA0NzIzNDg5Li41ZmEz
YWE3YmRiYzUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZHJ2
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9kcnYuYwpAQCAtNTMwLDIz
ICs1MzAsMzIgQEAgc3RhdGljIGludCBldG5hdml2X2JpbmQoc3RydWN0IGRldmljZSAqZGV2KQog
CUlOSVRfTElTVF9IRUFEKCZwcml2LT5nZW1fbGlzdCk7CiAJcHJpdi0+bnVtX2dwdXMgPSAwOwog
CisJcHJpdi0+Y21kYnVmX3N1YmFsbG9jID0gZXRuYXZpdl9jbWRidWZfc3ViYWxsb2NfbmV3KGRy
bS0+ZGV2KTsKKwlpZiAoSVNfRVJSKHByaXYtPmNtZGJ1Zl9zdWJhbGxvYykpIHsKKwkJZGV2X2Vy
cihkcm0tPmRldiwgIkZhaWxlZCB0byBjcmVhdGUgY21kYnVmIHN1YmFsbG9jYXRvclxuIik7CisJ
CXJldCA9IFBUUl9FUlIocHJpdi0+Y21kYnVmX3N1YmFsbG9jKTsKKwkJZ290byBvdXRfZnJlZV9w
cml2OworCX0KKwogCWRldl9zZXRfZHJ2ZGF0YShkZXYsIGRybSk7CiAKIAlyZXQgPSBjb21wb25l
bnRfYmluZF9hbGwoZGV2LCBkcm0pOwogCWlmIChyZXQgPCAwKQotCQlnb3RvIG91dF9iaW5kOwor
CQlnb3RvIG91dF9kZXN0cm95X3N1YmFsbG9jOwogCiAJbG9hZF9ncHUoZHJtKTsKIAogCXJldCA9
IGRybV9kZXZfcmVnaXN0ZXIoZHJtLCAwKTsKIAlpZiAocmV0KQotCQlnb3RvIG91dF9yZWdpc3Rl
cjsKKwkJZ290byBvdXRfdW5iaW5kOwogCiAJcmV0dXJuIDA7CiAKLW91dF9yZWdpc3RlcjoKK291
dF91bmJpbmQ6CiAJY29tcG9uZW50X3VuYmluZF9hbGwoZGV2LCBkcm0pOwotb3V0X2JpbmQ6Citv
dXRfZGVzdHJveV9zdWJhbGxvYzoKKwlldG5hdml2X2NtZGJ1Zl9zdWJhbGxvY19kZXN0cm95KHBy
aXYtPmNtZGJ1Zl9zdWJhbGxvYyk7CitvdXRfZnJlZV9wcml2OgogCWtmcmVlKHByaXYpOwogb3V0
X3B1dDoKIAlkcm1fZGV2X3B1dChkcm0pOwpAQCAtNTY1LDYgKzU3NCw4IEBAIHN0YXRpYyB2b2lk
IGV0bmF2aXZfdW5iaW5kKHN0cnVjdCBkZXZpY2UgKmRldikKIAogCWRldi0+ZG1hX3Bhcm1zID0g
TlVMTDsKIAorCWV0bmF2aXZfY21kYnVmX3N1YmFsbG9jX2Rlc3Ryb3kocHJpdi0+Y21kYnVmX3N1
YmFsbG9jKTsKKwogCWRybS0+ZGV2X3ByaXZhdGUgPSBOVUxMOwogCWtmcmVlKHByaXYpOwogCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2Rydi5oIGIvZHJpdmVy
cy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9kcnYuaAppbmRleCBlYWJlMzk0YzRlMjUuLmUwNTJk
N2RiNjZhZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9kcnYu
aAorKysgYi9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2Rydi5oCkBAIC0zNiw2ICsz
Niw4IEBAIHN0cnVjdCBldG5hdml2X2RybV9wcml2YXRlIHsKIAlzdHJ1Y3QgZGV2aWNlX2RtYV9w
YXJhbWV0ZXJzIGRtYV9wYXJtczsKIAlzdHJ1Y3QgZXRuYXZpdl9ncHUgKmdwdVtFVE5BX01BWF9Q
SVBFU107CiAKKwlzdHJ1Y3QgZXRuYXZpdl9jbWRidWZfc3ViYWxsb2MgKmNtZGJ1Zl9zdWJhbGxv
YzsKKwogCS8qIGxpc3Qgb2YgR0VNIG9iamVjdHM6ICovCiAJc3RydWN0IG11dGV4IGdlbV9sb2Nr
OwogCXN0cnVjdCBsaXN0X2hlYWQgZ2VtX2xpc3Q7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vZXRuYXZpdi9ldG5hdml2X2dlbV9zdWJtaXQuYyBiL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2
L2V0bmF2aXZfZ2VtX3N1Ym1pdC5jCmluZGV4IGY1MzVhNjI3ZjI5Ny4uM2Y0ZjZhYjM4OGRlIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2dlbV9zdWJtaXQuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2dlbV9zdWJtaXQuYwpAQCAtNDk2
LDcgKzQ5Niw3IEBAIGludCBldG5hdml2X2lvY3RsX2dlbV9zdWJtaXQoc3RydWN0IGRybV9kZXZp
Y2UgKmRldiwgdm9pZCAqZGF0YSwKIAkJZ290byBlcnJfc3VibWl0X3d3X2FjcXVpcmU7CiAJfQog
Ci0JcmV0ID0gZXRuYXZpdl9jbWRidWZfaW5pdChncHUtPmNtZGJ1Zl9zdWJhbGxvYywgJnN1Ym1p
dC0+Y21kYnVmLAorCXJldCA9IGV0bmF2aXZfY21kYnVmX2luaXQocHJpdi0+Y21kYnVmX3N1YmFs
bG9jLCAmc3VibWl0LT5jbWRidWYsCiAJCQkJICBBTElHTihhcmdzLT5zdHJlYW1fc2l6ZSwgOCkg
KyA4KTsKIAlpZiAocmV0KQogCQlnb3RvIGVycl9zdWJtaXRfb2JqZWN0czsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZ3B1LmMgYi9kcml2ZXJzL2dwdS9kcm0v
ZXRuYXZpdi9ldG5hdml2X2dwdS5jCmluZGV4IGYwMDU0N2I4OGExMy4uMTc5YmM2YzU0NGNhIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2dwdS5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZ3B1LmMKQEAgLTY5Myw2ICs2OTMsNyBAQCBz
dGF0aWMgdm9pZCBldG5hdml2X2dwdV9od19pbml0KHN0cnVjdCBldG5hdml2X2dwdSAqZ3B1KQog
CiBpbnQgZXRuYXZpdl9ncHVfaW5pdChzdHJ1Y3QgZXRuYXZpdl9ncHUgKmdwdSkKIHsKKwlzdHJ1
Y3QgZXRuYXZpdl9kcm1fcHJpdmF0ZSAqcHJpdiA9IGdwdS0+ZHJtLT5kZXZfcHJpdmF0ZTsKIAlp
bnQgcmV0LCBpOwogCiAJcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhncHUtPmRldik7CkBAIC03
NjAsMjMgKzc2MSwxNiBAQCBpbnQgZXRuYXZpdl9ncHVfaW5pdChzdHJ1Y3QgZXRuYXZpdl9ncHUg
KmdwdSkKIAkJZ290byBmYWlsOwogCX0KIAotCWdwdS0+Y21kYnVmX3N1YmFsbG9jID0gZXRuYXZp
dl9jbWRidWZfc3ViYWxsb2NfbmV3KGdwdSk7Ci0JaWYgKElTX0VSUihncHUtPmNtZGJ1Zl9zdWJh
bGxvYykpIHsKLQkJZGV2X2VycihncHUtPmRldiwgIkZhaWxlZCB0byBjcmVhdGUgY21kYnVmIHN1
YmFsbG9jYXRvclxuIik7Ci0JCXJldCA9IFBUUl9FUlIoZ3B1LT5jbWRidWZfc3ViYWxsb2MpOwot
CQlnb3RvIGRlc3Ryb3lfaW9tbXU7Ci0JfQotCi0JcmV0ID0gZXRuYXZpdl9jbWRidWZfc3ViYWxs
b2NfbWFwKGdwdS0+Y21kYnVmX3N1YmFsbG9jLCBncHUtPm1tdSwKKwlyZXQgPSBldG5hdml2X2Nt
ZGJ1Zl9zdWJhbGxvY19tYXAocHJpdi0+Y21kYnVmX3N1YmFsbG9jLCBncHUtPm1tdSwKIAkJCQkJ
ICAmZ3B1LT5jbWRidWZfbWFwcGluZywKIAkJCQkJICBncHUtPm1lbW9yeV9iYXNlKTsKIAlpZiAo
cmV0KSB7CiAJCWRldl9lcnIoZ3B1LT5kZXYsICJmYWlsZWQgdG8gbWFwIGNtZGJ1ZiBzdWJhbGxv
Y1xuIik7Ci0JCWdvdG8gZGVzdHJveV9zdWJhbGxvYzsKKwkJZ290byBkZXN0cm95X2lvbW11Owog
CX0KIAogCS8qIENyZWF0ZSBidWZmZXI6ICovCi0JcmV0ID0gZXRuYXZpdl9jbWRidWZfaW5pdChn
cHUtPmNtZGJ1Zl9zdWJhbGxvYywgJmdwdS0+YnVmZmVyLAorCXJldCA9IGV0bmF2aXZfY21kYnVm
X2luaXQocHJpdi0+Y21kYnVmX3N1YmFsbG9jLCAmZ3B1LT5idWZmZXIsCiAJCQkJICBQQUdFX1NJ
WkUpOwogCWlmIChyZXQpIHsKIAkJZGV2X2VycihncHUtPmRldiwgImNvdWxkIG5vdCBjcmVhdGUg
Y29tbWFuZCBidWZmZXJcbiIpOwpAQCAtODE1LDggKzgwOSw2IEBAIGludCBldG5hdml2X2dwdV9p
bml0KHN0cnVjdCBldG5hdml2X2dwdSAqZ3B1KQogCWV0bmF2aXZfY21kYnVmX2ZyZWUoJmdwdS0+
YnVmZmVyKTsKIHVubWFwX3N1YmFsbG9jOgogCWV0bmF2aXZfY21kYnVmX3N1YmFsbG9jX3VubWFw
KGdwdS0+bW11LCAmZ3B1LT5jbWRidWZfbWFwcGluZyk7Ci1kZXN0cm95X3N1YmFsbG9jOgotCWV0
bmF2aXZfY21kYnVmX3N1YmFsbG9jX2Rlc3Ryb3koZ3B1LT5jbWRidWZfc3ViYWxsb2MpOwogZGVz
dHJveV9pb21tdToKIAlldG5hdml2X2lvbW11X2Rlc3Ryb3koZ3B1LT5tbXUpOwogZmFpbDoKQEAg
LTE2OTIsNyArMTY4NCw2IEBAIHN0YXRpYyB2b2lkIGV0bmF2aXZfZ3B1X3VuYmluZChzdHJ1Y3Qg
ZGV2aWNlICpkZXYsIHN0cnVjdCBkZXZpY2UgKm1hc3RlciwKIAlpZiAoZ3B1LT5pbml0aWFsaXpl
ZCkgewogCQlldG5hdml2X2NtZGJ1Zl9mcmVlKCZncHUtPmJ1ZmZlcik7CiAJCWV0bmF2aXZfY21k
YnVmX3N1YmFsbG9jX3VubWFwKGdwdS0+bW11LCAmZ3B1LT5jbWRidWZfbWFwcGluZyk7Ci0JCWV0
bmF2aXZfY21kYnVmX3N1YmFsbG9jX2Rlc3Ryb3koZ3B1LT5jbWRidWZfc3ViYWxsb2MpOwogCQll
dG5hdml2X2lvbW11X2Rlc3Ryb3koZ3B1LT5tbXUpOwogCQlncHUtPmluaXRpYWxpemVkID0gZmFs
c2U7CiAJfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9ncHUu
aCBiL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZ3B1LmgKaW5kZXggNmE2YWRkMzUw
ZDJkLi45MzNjOGQwMTZmMTEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0
bmF2aXZfZ3B1LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9ncHUuaApA
QCAtMTM3LDcgKzEzNyw2IEBAIHN0cnVjdCBldG5hdml2X2dwdSB7CiAJaW50IGlycTsKIAogCXN0
cnVjdCBldG5hdml2X2lvbW11ICptbXU7Ci0Jc3RydWN0IGV0bmF2aXZfY21kYnVmX3N1YmFsbG9j
ICpjbWRidWZfc3ViYWxsb2M7CiAKIAkvKiBQb3dlciBDb250cm9sOiAqLwogCXN0cnVjdCBjbGsg
KmNsa19idXM7Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVk
ZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZv
L2RyaS1kZXZlbA==
