Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id C7E1CD2125
	for <lists+dri-devel@lfdr.de>; Thu, 10 Oct 2019 08:55:25 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1794E6EA9F;
	Thu, 10 Oct 2019 06:55:17 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from NAM04-CO1-obe.outbound.protection.outlook.com
 (mail-eopbgr690127.outbound.protection.outlook.com [40.107.69.127])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5990B6E949
 for <dri-devel@lists.freedesktop.org>; Wed,  9 Oct 2019 09:28:06 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=eZpWI6lE/RqAHPDv2+gJnBlHh774l5OeDPD1M3JKmxYDUpbftQE+v9bVBkfwr2RM9pltwOig3deYBlUh8xtfYOWctXxZwjWeNMFFYJ9r+OD/Hhnunzp9SxKWn5exScKSbYF2USbVycA/XftU3cJ1W0OA5w6U4enlHWd0uS8Rb7psO/pWxR0q7nKMdPYf/04NN9aSquckxLdm/Kb85cDxDuqcqG7JOopRg75uwmVIa3ddsxJBJ5SEye4kfcWtaYQBwP5m3RNDUCJcRd8LmKptEQXmKs4aJzq5WnbHFq8SL7XdSvHZqErJZnkTPcgqdtVup33c0Yxpc2/kHKSb2iBLrg==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=A+E2wNBkd9UoQf+XCtKEXfNeAj84Urn/Hjmraj/cMRc=;
 b=B2BvisL99Ddp3S05pkFSFSO8xxNI6SSpOl1mOfn1KG3Yqy97LEy3VHOgvUxpmwe+0VfpaQ69fdYyOTlhpL8lIqEtV3SzwktN4O09ThHTireoLQatNXtbxjvZPBkfJYnhAxWVwmg0COqA/ZAggsa8JJ+BXB3L07eOIXdNB/Pw7NrBMJduGgTOOvijrgFSuytEv7CvfNiu6Dla1No6dKC9n+YsffLiQBBbbbSNM1MkPXoeumq9W7sWeUh3ySERNOs0levPHEMv3LbPa/Hog9FvqIvYbQ8OClv3BIgmFkVSjVh2+cqlx3S354HBfs66xCsJDfCszKMB/CTHDK3C/8fmOg==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=analogixsemi.com; dmarc=pass action=none
 header.from=analogixsemi.com; dkim=pass header.d=analogixsemi.com; arc=none
Received: from SN6PR04MB4543.namprd04.prod.outlook.com (52.135.120.29) by
 SN6PR04MB4189.namprd04.prod.outlook.com (52.135.71.139) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2327.24; Wed, 9 Oct 2019 09:28:02 +0000
Received: from SN6PR04MB4543.namprd04.prod.outlook.com
 ([fe80::c55e:6c70:adbb:cf87]) by SN6PR04MB4543.namprd04.prod.outlook.com
 ([fe80::c55e:6c70:adbb:cf87%5]) with mapi id 15.20.2347.016; Wed, 9 Oct 2019
 09:28:02 +0000
From: Xin Ji <xji@analogixsemi.com>
To: "devel@driverdev.osuosl.org" <devel@driverdev.osuosl.org>, Laurent
 Pinchart <laurent.pinchart@ideasonboard.com>, Andrzej Hajda
 <a.hajda@samsung.com>
Subject: [PATCH v2 2/2] drm/bridge: anx7625: Add anx7625 MIPI DSI/DPI to DP
 bridge driver
Thread-Topic: [PATCH v2 2/2] drm/bridge: anx7625: Add anx7625 MIPI DSI/DPI to
 DP bridge driver
Thread-Index: AQHVfoPZsDTKCGgGvEaBZzoEPcILlw==
Date: Wed, 9 Oct 2019 09:28:02 +0000
Message-ID: <6ad16e52cd7591d320001a842fc357d976006ef7.1570588741.git.xji@analogixsemi.com>
References: <cover.1570588741.git.xji@analogixsemi.com>
In-Reply-To: <cover.1570588741.git.xji@analogixsemi.com>
Accept-Language: zh-CN, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: HK0PR01CA0027.apcprd01.prod.exchangelabs.com
 (2603:1096:203:3e::15) To SN6PR04MB4543.namprd04.prod.outlook.com
 (2603:10b6:805:a8::29)
x-ms-exchange-messagesentrepresentingtype: 1
x-originating-ip: [114.247.245.252]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 41b51e75-75d8-468b-6ee5-08d74c9afb2e
x-ms-traffictypediagnostic: SN6PR04MB4189:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <SN6PR04MB418938EA1D2CCFAA06097756C7950@SN6PR04MB4189.namprd04.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:5516;
x-forefront-prvs: 018577E36E
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10019020)(366004)(376002)(39850400004)(346002)(396003)(136003)(199004)(189003)(478600001)(64756008)(66476007)(486006)(446003)(26005)(66946007)(66556008)(66446008)(2906002)(186003)(86362001)(11346002)(2616005)(476003)(52116002)(7736002)(66066001)(71200400001)(71190400001)(76176011)(99286004)(305945005)(54906003)(118296001)(6486002)(14444005)(5024004)(561924002)(6436002)(8676002)(30864003)(25786009)(7416002)(81156014)(81166006)(8936002)(107886003)(6512007)(102836004)(14454004)(316002)(5660300002)(386003)(6506007)(110136005)(3846002)(4326008)(6116002)(36756003)(2501003)(256004)(579004)(559001)(569006);
 DIR:OUT; SFP:1102; SCL:1; SRVR:SN6PR04MB4189;
 H:SN6PR04MB4543.namprd04.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: analogixsemi.com does not
 designate permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: alyqRrsA8pMWAiQ75GkBhEjnqGlfj9aFH9YcxLWZJzSGnE0PvZXxQAs7FA6dOKME03wDOWVVhcsa38TEZKBjCNncXJpqsmi717fycF3ieEjHZQbgpskFHIjKv57dkP9kxK9/H4DJ6TVU2sBzX4YKTPyUC7Hm5zwhRpjGv0FAz05ifr0/Nz2eZ9Goq7adJuDB5JJ60Fdj/Iltq1Glwv/ESIL+QImGR9mZf8Y9A14dck3RrqIGI0lPzfzFzdx+2D6682ZEI/FLwqskAqKWebI4Hg+RhHLeFKYktEYqBdbQ05xkGNxh55eUeekBiQsuJFstT/KgbFyc+qXXanU6O9R8Qqi5O4Jg9mTElXDU86YtoxthIbR1n38kfrwkCfGFWJfLbZbP2yQoHJyv1RIut5LFp+9SXNP8rCc/P1Nqdt7xHGU=
Content-ID: <4AA4C0D0C532CA419FEEFFFC0A5D7B57@namprd04.prod.outlook.com>
MIME-Version: 1.0
X-OriginatorOrg: analogixsemi.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 41b51e75-75d8-468b-6ee5-08d74c9afb2e
X-MS-Exchange-CrossTenant-originalarrivaltime: 09 Oct 2019 09:28:02.5629 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: b099b0b4-f26c-4cf5-9a0f-d5be9acab205
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: iIAczN4lLk3IErHrHp7E/YJCHQqe0Od6ffMBExfzhUiZnRd1IjHjseZ/z/ElpK/y8MyFE80CsFjOYG1kPwMdLQ==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: SN6PR04MB4189
X-Mailman-Approved-At: Thu, 10 Oct 2019 06:55:06 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=Analogixsemi.onmicrosoft.com; s=selector2-Analogixsemi-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=A+E2wNBkd9UoQf+XCtKEXfNeAj84Urn/Hjmraj/cMRc=;
 b=HAhZ6NKfXxlAo/7yGrimry/3zwzz08Y/WJVwDHn9uJF2c1SQ1YzWYbIOgO0QOGadW68qMpXweEQWu0yZwozNTNccCi6TdA19jHVezDjv0TgtSOET+2/c4Q3quYJCCravUmawJKoPKfQK8/cjCG4hqRfnmoal7i+JdPclLZiaik0=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=xji@analogixsemi.com; 
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Jernej Skrabec <jernej.skrabec@siol.net>,
 Nicolas Boichat <drinkcat@chromium.org>, Jonas Karlman <jonas@kwiboo.se>,
 David Airlie <airlied@linux.ie>, Neil Armstrong <narmstrong@baylibre.com>,
 "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
 "dri-devel@lists.freedesktop.org" <dri-devel@lists.freedesktop.org>,
 Sheng Pan <span@analogixsemi.com>, Dan Carpenter <dan.carpenter@oracle.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIEFOWDc2MjUgaXMgYW4gdWx0cmEtbG93IHBvd2VyIDRLIE1vYmlsZSBIRCBUcmFuc21pdHRl
ciBkZXNpZ25lZApmb3IgcG9ydGFibGUgZGV2aWNlLiBJdCBjb252ZXJ0cyBNSVBJIERTSS9EUEkg
dG8gRGlzcGxheVBvcnQgMS4zIDRLLgoKVGhlIEFOWDc2MjUgY2FuIHN1cHBvcnQgYm90aCBVU0Ig
VHlwZS1DIFBEIGZlYXR1cmUgYW5kIE1JUEkgRFNJL0RQSQp0byBEUCBmZWF0dXJlLiBUaGlzIGRy
aXZlciBvbmx5IGVuYWJsZWQgTUlQSSBEU0kvRFBJIHRvIERQIGZlYXR1cmUuCgpTaWduZWQtb2Zm
LWJ5OiBYaW4gSmkgPHhqaUBhbmFsb2dpeHNlbWkuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9i
cmlkZ2UvTWFrZWZpbGUgICAgICAgICAgIHwgICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2JyaWRn
ZS9hbmFsb2dpeC9LY29uZmlnICAgfCAgICA2ICsKIGRyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5h
bG9naXgvTWFrZWZpbGUgIHwgICAgMSArCiBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4
L2FueDc2MjUuYyB8IDIxMzIgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIGRyaXZlcnMv
Z3B1L2RybS9icmlkZ2UvYW5hbG9naXgvYW54NzYyNS5oIHwgIDQwNSArKysrKysKIDUgZmlsZXMg
Y2hhbmdlZCwgMjU0NSBpbnNlcnRpb25zKCspLCAxIGRlbGV0aW9uKC0pCiBjcmVhdGUgbW9kZSAx
MDA2NDQgZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9hbng3NjI1LmMKIGNyZWF0ZSBt
b2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L2FueDc2MjUuaAoKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9k
cm0vYnJpZGdlL01ha2VmaWxlCmluZGV4IDQ5MzRmY2YuLmJjZDM4OGEgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9icmlkZ2UvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRn
ZS9NYWtlZmlsZQpAQCAtMTIsOCArMTIsOCBAQCBvYmotJChDT05GSUdfRFJNX1NJSTkyMzQpICs9
IHNpaTkyMzQubwogb2JqLSQoQ09ORklHX0RSTV9USElORV9USEM2M0xWRDEwMjQpICs9IHRoYzYz
bHZkMTAyNC5vCiBvYmotJChDT05GSUdfRFJNX1RPU0hJQkFfVEMzNTg3NjQpICs9IHRjMzU4NzY0
Lm8KIG9iai0kKENPTkZJR19EUk1fVE9TSElCQV9UQzM1ODc2NykgKz0gdGMzNTg3Njcubwotb2Jq
LSQoQ09ORklHX0RSTV9BTkFMT0dJWF9EUCkgKz0gYW5hbG9naXgvCiBvYmotJChDT05GSUdfRFJN
X0kyQ19BRFY3NTExKSArPSBhZHY3NTExLwogb2JqLSQoQ09ORklHX0RSTV9USV9TTjY1RFNJODYp
ICs9IHRpLXNuNjVkc2k4Ni5vCiBvYmotJChDT05GSUdfRFJNX1RJX1RGUDQxMCkgKz0gdGktdGZw
NDEwLm8KK29iai15ICs9IGFuYWxvZ2l4Lwogb2JqLXkgKz0gc3lub3BzeXMvCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L0tjb25maWcgYi9kcml2ZXJzL2dwdS9k
cm0vYnJpZGdlL2FuYWxvZ2l4L0tjb25maWcKaW5kZXggZTkzMGZmOS4uYjJmMTI3ZSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9LY29uZmlnCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvS2NvbmZpZwpAQCAtMiwzICsyLDkgQEAKIGNvbmZp
ZyBEUk1fQU5BTE9HSVhfRFAKIAl0cmlzdGF0ZQogCWRlcGVuZHMgb24gRFJNCisKK2NvbmZpZyBB
TkFMT0dJWF9BTlg3NjI1CisJdHJpc3RhdGUgIkFuYWxvZ2l4IE1JUEkgdG8gRFAgaW50ZXJmYWNl
IHN1cHBvcnQiCisJaGVscAorCQlBTlg3NjI1IGlzIGFuIHVsdHJhLWxvdyBwb3dlciA0SyBtb2Jp
bGUgSEQgdHJhbnNtaXR0ZXIgZGVzaWduZWQKKwkJZm9yIHBvcnRhYmxlIGRldmljZXMuIEl0IGNv
bnZlcnRzIE1JUEkvRFBJIHRvIERpc3BsYXlQb3J0MS4zIDRLLgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9icmlk
Z2UvYW5hbG9naXgvTWFrZWZpbGUKaW5kZXggZmRiZjNmZC4uOGE1Mjg2NyAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2dw
dS9kcm0vYnJpZGdlL2FuYWxvZ2l4L01ha2VmaWxlCkBAIC0xLDMgKzEsNCBAQAogIyBTUERYLUxp
Y2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5CitvYmotJChDT05GSUdfQU5BTE9HSVhfQU5Y
NzYyNSkgKz0gYW54NzYyNS5vCiBhbmFsb2dpeF9kcC1vYmpzIDo9IGFuYWxvZ2l4X2RwX2NvcmUu
byBhbmFsb2dpeF9kcF9yZWcubwogb2JqLSQoQ09ORklHX0RSTV9BTkFMT0dJWF9EUCkgKz0gYW5h
bG9naXhfZHAubwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9h
bng3NjI1LmMgYi9kcml2ZXJzL2dwdS9kcm0vYnJpZGdlL2FuYWxvZ2l4L2FueDc2MjUuYwpuZXcg
ZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi43YmI0ZTE3Ci0tLSAvZGV2L251bGwKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9hbng3NjI1LmMKQEAgLTAsMCArMSwy
MTMyIEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5CisvKgorICog
Q29weXJpZ2h0KGMpIDIwMTYsIEFuYWxvZ2l4IFNlbWljb25kdWN0b3IuIEFsbCByaWdodHMgcmVz
ZXJ2ZWQuCisgKgorICovCisjaW5jbHVkZSA8bGludXgvZXh0Y29uLmg+CisjaW5jbHVkZSA8bGlu
dXgvZ2NkLmg+CisjaW5jbHVkZSA8bGludXgvZ3Bpby9jb25zdW1lci5oPgorI2luY2x1ZGUgPGxp
bnV4L2kyYy5oPgorI2luY2x1ZGUgPGxpbnV4L2ludGVycnVwdC5oPgorI2luY2x1ZGUgPGxpbnV4
L2lvcG9sbC5oPgorI2luY2x1ZGUgPGxpbnV4L2tlcm5lbC5oPgorI2luY2x1ZGUgPGxpbnV4L21v
ZHVsZS5oPgorI2luY2x1ZGUgPGxpbnV4L211dGV4Lmg+CisjaW5jbHVkZSA8bGludXgvc2xhYi5o
PgorI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CisjaW5jbHVkZSA8bGludXgvd29ya3F1ZXVlLmg+
CisKKyNpbmNsdWRlIDxsaW51eC9vZl9ncGlvLmg+CisjaW5jbHVkZSA8bGludXgvb2ZfZ3JhcGgu
aD4KKyNpbmNsdWRlIDxsaW51eC9vZl9wbGF0Zm9ybS5oPgorCisjaW5jbHVkZSA8ZHJtL2RybV9h
dG9taWNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9icmlkZ2UuaD4KKyNpbmNsdWRlIDxk
cm0vZHJtX2NydGNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9kcF9oZWxwZXIuaD4KKyNp
bmNsdWRlIDxkcm0vZHJtX2VkaWQuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX21pcGlfZHNpLmg+Cisj
aW5jbHVkZSA8ZHJtL2RybV9wYW5lbC5oPgorI2luY2x1ZGUgPGRybS9kcm1fcHJpbnQuaD4KKyNp
bmNsdWRlIDxkcm0vZHJtX3Byb2JlX2hlbHBlci5oPgorCisjaW5jbHVkZSA8dmlkZW8vZGlzcGxh
eV90aW1pbmcuaD4KKworI2luY2x1ZGUgImFueDc2MjUuaCIKKworLyoKKyAqIHRoZXJlIGlzIGEg
c3luYyBpc3N1ZSB3aGlsZSBhY2Nlc3MgSTJDIHJlZ2lzdGVyIGJldHdlZW4gQVAoQ1BVKSBhbmQK
KyAqIGludGVybmFsIGZpcm13YXJlKE9DTSksIHRvIGF2b2lkIHRoZSByYWNlIGNvbmRpdGlvbiwg
QVAgc2hvdWxkIGFjY2VzcworICogdGhlIHJlc2VydmVkIHNsYXZlIGFkZHJlc3MgYmVmb3JlIHNs
YXZlIGFkZHJlc3Mgb2NjdXJzIGNoYW5nZXMuCisgKi8KK3N0YXRpYyBpbnQgaTJjX2FjY2Vzc193
b3JrYXJvdW5kKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKKwkJCQkgc3RydWN0IGkyY19jbGll
bnQgKmNsaWVudCkKK3sKKwl1OCBvZmZzZXQ7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmNsaWVu
dC0+ZGV2OworCXN0cnVjdCBpMmNfY2xpZW50ICpsYXN0X2NsaWVudCA9IGN0eC0+bGFzdF9jbGll
bnQ7CisJaW50IHJldCA9IDA7CisKKwlpZiAoY2xpZW50ICE9IGxhc3RfY2xpZW50KSB7CisJCWN0
eC0+bGFzdF9jbGllbnQgPSBjbGllbnQ7CisKKwkJaWYgKGNsaWVudCA9PSBjdHgtPmkyYy50Y3Bj
X2NsaWVudCkKKwkJCW9mZnNldCA9IFJTVkRfMDBfQUREUjsKKwkJZWxzZSBpZiAoY2xpZW50ID09
IGN0eC0+aTJjLnR4X3AwX2NsaWVudCkKKwkJCW9mZnNldCA9IFJTVkRfRDFfQUREUjsKKwkJZWxz
ZSBpZiAoY2xpZW50ID09IGN0eC0+aTJjLnR4X3AxX2NsaWVudCkKKwkJCW9mZnNldCA9IFJTVkRf
NjBfQUREUjsKKwkJZWxzZSBpZiAoY2xpZW50ID09IGN0eC0+aTJjLnJ4X3AwX2NsaWVudCkKKwkJ
CW9mZnNldCA9IFJTVkRfMzlfQUREUjsKKwkJZWxzZSBpZiAoY2xpZW50ID09IGN0eC0+aTJjLnJ4
X3AxX2NsaWVudCkKKwkJCW9mZnNldCA9IFJTVkRfN0ZfQUREUjsKKwkJZWxzZQorCQkJb2Zmc2V0
ID0gUlNWRF8wMF9BRERSOworCisJCXJldCA9IGkyY19zbWJ1c193cml0ZV9ieXRlX2RhdGEoY2xp
ZW50LCBvZmZzZXQsIDB4MDApOworCQlpZiAocmV0IDwgMCkKKwkJCURSTV9ERVZfRVJST1IoZGV2
LAorCQkJCSAgICAgICJmYWlsZWQgdG8gYWNjZXNzIGkyYyBpZD0leFxuOiV4IiwKKwkJCQkgICAg
ICBjbGllbnQtPmFkZHIsIG9mZnNldCk7CisJfQorCisJcmV0dXJuIHJldDsKK30KKworc3RhdGlj
IGludCBhbng3NjI1X3JlZ19yZWFkKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKKwkJCSAgICBz
dHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50LCB1OCByZWdfYWRkcikKK3sKKwlpbnQgcmV0OworCXN0
cnVjdCBkZXZpY2UgKmRldiA9ICZjbGllbnQtPmRldjsKKworCWkyY19hY2Nlc3Nfd29ya2Fyb3Vu
ZChjdHgsIGNsaWVudCk7CisKKwlyZXQgPSBpMmNfc21idXNfcmVhZF9ieXRlX2RhdGEoY2xpZW50
LCByZWdfYWRkcik7CisJaWYgKHJldCA8IDApCisJCURSTV9ERVZfRVJST1IoZGV2LCAicmVhZCBp
MmMgZmFpbGVkIGlkPSV4OiV4XG4iLAorCQkJICAgICAgY2xpZW50LT5hZGRyLCByZWdfYWRkcik7
CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IGFueDc2MjVfcmVnX2Jsb2NrX3JlYWQo
c3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAorCQkJCSAgc3RydWN0IGkyY19jbGllbnQgKmNsaWVu
dCwKKwkJCQkgIHU4IHJlZ19hZGRyLCB1OCBsZW4sIHU4ICpidWYpCit7CisJaW50IHJldDsKKwlz
dHJ1Y3QgZGV2aWNlICpkZXYgPSAmY2xpZW50LT5kZXY7CisKKwlpMmNfYWNjZXNzX3dvcmthcm91
bmQoY3R4LCBjbGllbnQpOworCisJcmV0ID0gaTJjX3NtYnVzX3JlYWRfaTJjX2Jsb2NrX2RhdGEo
Y2xpZW50LCByZWdfYWRkciwgbGVuLCBidWYpOworCWlmIChyZXQgPCAwKQorCQlEUk1fREVWX0VS
Uk9SKGRldiwgInJlYWQgaTJjIGJsb2NrIGZhaWxlZCBpZD0leDoleFxuIiwKKwkJCSAgICAgIGNs
aWVudC0+YWRkciwgcmVnX2FkZHIpOworCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBh
bng3NjI1X3JlZ193cml0ZShzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCisJCQkgICAgIHN0cnVj
dCBpMmNfY2xpZW50ICpjbGllbnQsCisJCQkgICAgIHU4IHJlZ19hZGRyLCB1OCByZWdfdmFsKQor
eworCWludCByZXQ7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmNsaWVudC0+ZGV2OworCisJaTJj
X2FjY2Vzc193b3JrYXJvdW5kKGN0eCwgY2xpZW50KTsKKworCXJldCA9IGkyY19zbWJ1c193cml0
ZV9ieXRlX2RhdGEoY2xpZW50LCByZWdfYWRkciwgcmVnX3ZhbCk7CisKKwlpZiAocmV0IDwgMCkK
KwkJRFJNX0RFVl9FUlJPUihkZXYsICJmYWlsZWQgdG8gd3JpdGUgaTJjIGlkPSV4XG46JXgiLAor
CQkJICAgICAgY2xpZW50LT5hZGRyLCByZWdfYWRkcik7CisKKwlyZXR1cm4gcmV0OworfQorCitz
dGF0aWMgaW50IGFueDc2MjVfd3JpdGVfb3Ioc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAorCQkJ
ICAgIHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQsCisJCQkgICAgdTggb2Zmc2V0LCB1OCBtYXNr
KQoreworCWludCB2YWwgPSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY2xpZW50LCBvZmZzZXQpOwor
CisJcmV0dXJuICh2YWwgPCAwKSA/IHZhbCA6CisJCWFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY2xp
ZW50LCBvZmZzZXQsICh2YWwgfCAobWFzaykpKTsKK30KKworc3RhdGljIGludCBhbng3NjI1X3dy
aXRlX2FuZChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCisJCQkgICAgIHN0cnVjdCBpMmNfY2xp
ZW50ICpjbGllbnQsCisJCQkgICAgIHU4IG9mZnNldCwgdTggbWFzaykKK3sKKwlpbnQgdmFsID0g
YW54NzYyNV9yZWdfcmVhZChjdHgsIGNsaWVudCwgb2Zmc2V0KTsKKworCXJldHVybiAodmFsIDwg
MCkgPyB2YWwgOgorCQlhbng3NjI1X3JlZ193cml0ZShjdHgsIGNsaWVudCwgb2Zmc2V0LCAodmFs
ICYgKG1hc2spKSk7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV93cml0ZV9hbmRfb3Ioc3RydWN0
IGFueDc2MjVfZGF0YSAqY3R4LAorCQkJCXN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQsCisJCQkJ
dTggb2Zmc2V0LCB1OCBhbmRfbWFzaywgdTggb3JfbWFzaykKK3sKKwlpbnQgdmFsID0gYW54NzYy
NV9yZWdfcmVhZChjdHgsIGNsaWVudCwgb2Zmc2V0KTsKKworCXJldHVybiAodmFsIDwgMCkgPyB2
YWwgOgorCQlhbng3NjI1X3JlZ193cml0ZShjdHgsIGNsaWVudCwgb2Zmc2V0LAorCQkJCSAgKHZh
bCAmIGFuZF9tYXNrKSB8IChvcl9tYXNrKSk7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV9jb25m
aWdfYml0X21hdHJpeChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJaW50IGksIHJldDsK
KworCXJldCA9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMudHhfcDJfY2xpZW50LAor
CQkJCUFVRElPX0NPTlRST0xfUkVHSVNURVIsIDB4ODApOworCWZvciAoaSA9IDA7IGkgPCAxMzsg
aSsrKQorCQlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy50eF9wMl9jbGll
bnQsCisJCQkJCSBWSURFT19CSVRfTUFUUklYXzEyICsgaSwKKwkJCQkJIDB4MTggKyBpKTsKKwor
CXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV9yZWFkX2N0cmxfc3RhdHVzX3Aw
KHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sKKwlyZXR1cm4gYW54NzYyNV9yZWdfcmVhZChj
dHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwgQVBfQVVYX0NUUkxfU1RBVFVTKTsKK30KKworc3Rh
dGljIGludCB3YWl0X2F1eF9vcF9maW5pc2goc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQorewor
CWludCB2YWw7CisJaW50IHJldDsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQt
PmRldjsKKworCXJldCA9IHJlYWR4X3BvbGxfdGltZW91dChhbng3NjI1X3JlYWRfY3RybF9zdGF0
dXNfcDAsCisJCQkJIGN0eCwgdmFsLAorCQkJCSAoISh2YWwgJiBBUF9BVVhfQ1RSTF9PUF9FTikg
fHwgKHZhbCA8IDApKSwKKwkJCQkgMjAwMCwKKwkJCQkgMjAwMCAqIDE1MCk7CisJaWYgKHJldCkg
eworCQlEUk1fREVWX0VSUk9SKGRldiwgImF1eCBvcGVyYXRpb24gZmFpbGVkIVxuIik7CisJCXZh
bCA9IC1FSU87CisJfSBlbHNlIHsKKwkJdmFsID0gYW54NzYyNV9yZWdfcmVhZChjdHgsIGN0eC0+
aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkgICAgICAgQVBfQVVYX0NUUkxfU1RBVFVTKTsKKwkJaWYg
KHZhbCA8IDAgfHwgKHZhbCAmIDB4MEYpKSB7CisJCQlEUk1fREVWX0VSUk9SKGRldiwgImF1eCBz
dGF0dXMgJTAyeFxuIiwgdmFsKTsKKwkJCXZhbCA9IC1FSU87CisJCX0KKwl9CisKKwlyZXR1cm4g
dmFsOworfQorCitzdGF0aWMgaW50IHdyaXRlX2RwY2RfYWRkcihzdHJ1Y3QgYW54NzYyNV9kYXRh
ICpjdHgsCisJCQkgICB1OCBhZGRyaCwgdTggYWRkcm0sIHU4IGFkZHJsKQoreworCWludCByZXQ7
CisKKwlyZXQgPSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwK
KwkJCQlBUF9BVVhfQUREUl83XzAsICh1OClhZGRybCk7CisJcmV0IHw9IGFueDc2MjVfcmVnX3dy
aXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCSBBUF9BVVhfQUREUl8xNV84LCAo
dTgpYWRkcm0pOworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3Aw
X2NsaWVudCwKKwkJCQkgQVBfQVVYX0FERFJfMTlfMTYsICh1OClhZGRyaCk7CisKKwlyZXR1cm4g
cmV0OworfQorCitzdGF0aWMgaW50IHNwX3R4X2F1eF9kcGNkcmVhZF9ieXRlcyhzdHJ1Y3QgYW54
NzYyNV9kYXRhICpjdHgsCisJCQkJICAgIHU4IGFkZHJoLCB1OCBhZGRybSwKKwkJCQkgICAgdTgg
YWRkcmwsIHU4IGNvdW50LAorCQkJCSAgICB1OCAqYnVmKQoreworCXU4IGM7CisJaW50IHJldDsK
KwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKworCWlmIChXQVJOX09O
KGNvdW50ID4gKHNpemVfdClNQVhfRFBDRF9CVUZGRVJfU0laRSkpCisJCXJldHVybiAtRTJCSUc7
CisKKwkvKiBjb21tYW5kIGFuZCBsZW5ndGggKi8KKwljID0gKChjb3VudCAtIDEpIDw8IDQpIHwg
MHgwOTsKKwlyZXQgPSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVu
dCwgQVBfQVVYX0NPTU1BTkQsIGMpOworCS8qIGFkZHJlc3MgKi8KKwlyZXQgfD0gd3JpdGVfZHBj
ZF9hZGRyKGN0eCwgYWRkcmgsIGFkZHJtLCBhZGRybCk7CisJLyogYXV4IGVuICovCisJcmV0IHw9
IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsIEFQX0FVWF9DVFJM
X1NUQVRVUywKKwkJCQlBUF9BVVhfQ1RSTF9PUF9FTik7CisJaWYgKHJldCA8IDApIHsKKwkJRFJN
X0RFVl9FUlJPUihkZXYsICJhdXggZW5hYmxlIGZhaWxlZC5cbiIpOworCQlyZXR1cm4gcmV0Owor
CX0KKworCXVzbGVlcF9yYW5nZSgyMDAwLCAyMTAwKTsKKworCXJldCA9IHdhaXRfYXV4X29wX2Zp
bmlzaChjdHgpOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9ERVZfRVJST1IoZGV2LCAiYXV4IHJl
YWQgZmFpbGVkXG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXR1cm4gYW54NzYyNV9yZWdf
YmxvY2tfcmVhZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCUFQX0FVWF9CVUZGX1NU
QVJULCBjb3VudCwgYnVmKTsKK30KKworc3RhdGljIGludCBhbng3NjI1X3ZpZGVvX211dGVfY29u
dHJvbChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgsCisJCQkJICAgICAgdTggc3RhdHVzKQorewor
CWludCByZXQ7CisKKwlpZiAoc3RhdHVzKSB7IC8qIG11dGUgb24gKi8KKwkJLyogc2V0IG11dGUg
ZmxhZyAqLworCQlyZXQgPSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xp
ZW50LAorCQkJCSAgICAgICBBUF9BVl9TVEFUVVMsIEFQX01JUElfTVVURSk7CisJCS8qIGNsZWFy
IG1pcGkgUlggZW4gKi8KKwkJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMu
cnhfcDBfY2xpZW50LAorCQkJCQkgQVBfQVZfU1RBVFVTLCAodTgpfkFQX01JUElfUlhfRU4pOwor
CX0gZWxzZSB7IC8qIG11dGUgb2ZmICovCisJCS8qIGNsZWFyIG11dGUgZmxhZyAqLworCQlyZXQg
PSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkJQVBf
QVZfU1RBVFVTLCAodTgpfkFQX01JUElfTVVURSk7CisJCS8qIHNldCBNSVBJIFJYIEVOICovCisJ
CXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJ
CQlBUF9BVl9TVEFUVVMsIEFQX01JUElfUlhfRU4pOworCX0KKworCXJldHVybiByZXQ7Cit9CisK
K3N0YXRpYyBpbnQgYW54NzYyNV9jb25maWdfYXVkaW9faW5wdXQoc3RydWN0IGFueDc2MjVfZGF0
YSAqY3R4KQoreworCWludCByZXQ7CisKKwkvKiBjaGFubmVsIG51bSAqLworCXJldCA9IGFueDc2
MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMudHhfcDJfY2xpZW50LAorCQkJCUFVRElPX0NIQU5O
RUxfU1RBVFVTXzYsIEkyU19DSF8yIDw8IDUpOworCS8qIGxheW91dCAqLworCS8qIGFzIEkyUyBj
aGFubmVsIGlzIDIsIG5vIG5lZWQgdG8gc2V0IGxheW91dCAqLworCisJLyogRlMgKi8KKwlyZXQg
fD0gYW54NzYyNV93cml0ZV9hbmRfb3IoY3R4LCBjdHgtPmkyYy50eF9wMl9jbGllbnQsCisJCQkJ
ICAgIEFVRElPX0NIQU5ORUxfU1RBVFVTXzQsCisJCQkJICAgIDB4ZjAsIEFVRElPX0ZTXzQ4Syk7
CisJLyogd29yZCBsZW5ndGggKi8KKwlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmRfb3IoY3R4LCBj
dHgtPmkyYy50eF9wMl9jbGllbnQsCisJCQkJICAgIEFVRElPX0NIQU5ORUxfU1RBVFVTXzUsCisJ
CQkJICAgIDB4ZjAsIEFVRElPX1dfTEVOXzI0XzI0TUFYKTsKKwkvKiBJMlMgKi8KKwlyZXQgfD0g
YW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnR4X3AyX2NsaWVudCwKKwkJCQlBVURJT19D
SEFOTkVMX1NUQVRVU182LCBJMlNfU0xBVkVfTU9ERSk7CisJcmV0IHw9IGFueDc2MjVfd3JpdGVf
YW5kKGN0eCwgY3R4LT5pMmMudHhfcDJfY2xpZW50LAorCQkJCSBBVURJT19DT05UUk9MX1JFR0lT
VEVSLCB+VERNX1RJTUlOR19NT0RFKTsKKwkvKiBhdWRpbyBjaGFuZ2UgZmxhZyAqLworCXJldCB8
PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCUFQX0FW
X1NUQVRVUywgQVBfQVVESU9fQ0hHKTsKKworCWlmIChyZXQgPCAwKQorCQlEUk1fRVJST1IoImZh
aWxlZCB0byBjb25maWcgYXVkaW8uXG4iKTsKKworCXJldHVybiByZXQ7Cit9CisKKy8qIHJlZHVj
dGlvbiBvZiBmcmFjdGlvbiBhL2IgKi8KK3N0YXRpYyB2b2lkIGFueDc2MjVfcmVkdWN0aW9uX29m
X2FfZnJhY3Rpb24odW5zaWduZWQgbG9uZyAqYSwgdW5zaWduZWQgbG9uZyAqYikKK3sKKwl1bnNp
Z25lZCBsb25nIGdjZF9udW07CisJdW5zaWduZWQgbG9uZyB0bXBfYSwgdG1wX2I7CisJdTMyIGkg
PSAxOworCisJZ2NkX251bSA9IGdjZCgqYSwgKmIpOworCSphIC89IGdjZF9udW07CisJKmIgLz0g
Z2NkX251bTsKKworCXRtcF9hID0gKmE7CisJdG1wX2IgPSAqYjsKKworCXdoaWxlICgoKmEgPiBN
QVhfVU5TSUdORURfMjRCSVQpIHx8ICgqYiA+IE1BWF9VTlNJR05FRF8yNEJJVCkpIHsKKwkJaSsr
OworCQkqYSA9IHRtcF9hIC8gaTsKKwkJKmIgPSB0bXBfYiAvIGk7CisJfQorCisJLyoKKwkgKiBp
biB0aGUgZW5kLCBtYWtlIGEsIGIgbGFyZ2VyIHRvIGhhdmUgaGlnaGVyIE9ERkMgUExMCisJICog
b3V0cHV0IGZyZXF1ZW5jeSBhY2N1cmFjeQorCSAqLworCXdoaWxlICgoKmEgPCBNQVhfVU5TSUdO
RURfMjRCSVQpICYmICgqYiA8IE1BWF9VTlNJR05FRF8yNEJJVCkpIHsKKwkJKmEgPDw9IDE7CisJ
CSpiIDw8PSAxOworCX0KKworCSphID4+PSAxOworCSpiID4+PSAxOworfQorCitzdGF0aWMgaW50
IGFueDc2MjVfY2FsY3VsYXRlX21fbih1MzIgcGl4ZWxjbG9jaywKKwkJCQkgdW5zaWduZWQgbG9u
ZyAqbSwKKwkJCQkgdW5zaWduZWQgbG9uZyAqbiwKKwkJCQkgdTggKnBvc3RfZGl2aWRlcikKK3sK
KwlpZiAocGl4ZWxjbG9jayA+IFBMTF9PVVRfRlJFUV9BQlNfTUFYIC8gUE9TVF9ESVZJREVSX01J
TikgeworCQkvKiBwaXhlbCBjbG9jayBmcmVxdWVuY3kgaXMgdG9vIGhpZ2ggKi8KKwkJRFJNX0VS
Uk9SKCJwaXhlbGNsb2NrIHRvbyBoaWdoLCBhY3QoJWQpLCBtYXhpbXVtKCVsdSlcbiIsCisJCQkg
IHBpeGVsY2xvY2ssCisJCQkgIFBMTF9PVVRfRlJFUV9BQlNfTUFYIC8gUE9TVF9ESVZJREVSX01J
Tik7CisJCXJldHVybiAtRURPTTsKKwl9CisKKwlpZiAocGl4ZWxjbG9jayA8IFBMTF9PVVRfRlJF
UV9BQlNfTUlOIC8gUE9TVF9ESVZJREVSX01BWCkgeworCQkvKiBwaXhlbCBjbG9jayBmcmVxdWVu
Y3kgaXMgdG9vIGxvdyAqLworCQlEUk1fRVJST1IoInBpeGVsY2xvY2sgdG9vIGxvdywgYWN0KCVk
KSwgbWF4aW11bSglbHUpXG4iLAorCQkJICBwaXhlbGNsb2NrLAorCQkJICBQTExfT1VUX0ZSRVFf
QUJTX01JTiAvIFBPU1RfRElWSURFUl9NQVgpOworCQlyZXR1cm4gLUVET007CisJfQorCisJKnBv
c3RfZGl2aWRlciA9IDE7CisKKwlmb3IgKCpwb3N0X2RpdmlkZXIgPSAxOworCQlwaXhlbGNsb2Nr
IDwgKFBMTF9PVVRfRlJFUV9NSU4gLyAoKnBvc3RfZGl2aWRlcikpOykKKwkJKnBvc3RfZGl2aWRl
ciArPSAxOworCisJaWYgKCpwb3N0X2RpdmlkZXIgPiBQT1NUX0RJVklERVJfTUFYKSB7CisJCWZv
ciAoKnBvc3RfZGl2aWRlciA9IDE7CisJCQkocGl4ZWxjbG9jayA8CisJCQkgKFBMTF9PVVRfRlJF
UV9BQlNfTUlOIC8gKCpwb3N0X2RpdmlkZXIpKSk7KQorCQkJKnBvc3RfZGl2aWRlciArPSAxOwor
CisJCWlmICgqcG9zdF9kaXZpZGVyID4gUE9TVF9ESVZJREVSX01BWCkgeworCQkJRFJNX0VSUk9S
KCJjYW5ub3QgZmluZCBwcm9wZXJ0eSBwb3N0X2RpdmlkZXIoJWQpXG4iLAorCQkJCSAgKnBvc3Rf
ZGl2aWRlcik7CisJCQlyZXR1cm4gLUVET007CisJCX0KKwl9CisKKwkvKiBwYXRjaCB0byBpbXBy
b3ZlIHRoZSBhY2N1cmFjeSAqLworCWlmICgqcG9zdF9kaXZpZGVyID09IDcpIHsKKwkJLyogMjcs
MDAwLDAwMCBpcyBub3QgZGl2aXNpYmxlIGJ5IDcgKi8KKwkJKnBvc3RfZGl2aWRlciA9IDg7CisJ
fSBlbHNlIGlmICgqcG9zdF9kaXZpZGVyID09IDExKSB7CisJCS8qIDI3LDAwMCwwMDAgaXMgbm90
IGRpdmlzaWJsZSBieSAxMSAqLworCQkqcG9zdF9kaXZpZGVyID0gMTI7CisJfSBlbHNlIGlmICgo
KnBvc3RfZGl2aWRlciA9PSAxMykgfHwgKCpwb3N0X2RpdmlkZXIgPT0gMTQpKSB7CisJCS8qMjcs
MDAwLDAwMCBpcyBub3QgZGl2aXNpYmxlIGJ5IDEzIG9yIDE0Ki8KKwkJKnBvc3RfZGl2aWRlciA9
IDE1OworCX0KKworCWlmIChwaXhlbGNsb2NrICogKCpwb3N0X2RpdmlkZXIpID4gUExMX09VVF9G
UkVRX0FCU19NQVgpIHsKKwkJRFJNX0VSUk9SKCJhY3QgY2xvY2soJXUpIGxhcmdlIHRoYW4gbWF4
aW11bSglbHUpXG4iLAorCQkJICBwaXhlbGNsb2NrICogKCpwb3N0X2RpdmlkZXIpLAorCQkJICBQ
TExfT1VUX0ZSRVFfQUJTX01BWCk7CisJCXJldHVybiAtRURPTTsKKwl9CisKKwkqbSA9IHBpeGVs
Y2xvY2s7CisJKm4gPSBYVEFMX0ZSUSAvICgqcG9zdF9kaXZpZGVyKTsKKworCWFueDc2MjVfcmVk
dWN0aW9uX29mX2FfZnJhY3Rpb24obSwgbik7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGlu
dCBhbng3NjI1X29kZmNfY29uZmlnKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKKwkJCSAgICAg
ICB1OCBwb3N0X2RpdmlkZXIpCit7CisJaW50IHJldDsKKworCS8qIGNvbmZpZyBpbnB1dCByZWZl
cmVuY2UgY2xvY2sgZnJlcXVlbmN5IDI3TUh6LzE5LjJNSHogKi8KKwlyZXQgPSBhbng3NjI1X3dy
aXRlX2FuZChjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9ESUdJVEFMX1BMTF8xNiwK
KwkJCQl+KFJFRl9DTEtfMjcwMDBLSFogPDwgTUlQSV9GUkVGX0RfSU5EKSk7CisJcmV0IHw9IGFu
eDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIE1JUElfRElHSVRBTF9Q
TExfMTYsCisJCQkJKFJFRl9DTEtfMjcwMDBLSFogPDwgTUlQSV9GUkVGX0RfSU5EKSk7CisJLyog
cG9zdCBkaXZpZGVyICovCisJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMu
cnhfcDFfY2xpZW50LAorCQkJCSBNSVBJX0RJR0lUQUxfUExMXzgsIDB4MGYpOworCXJldCB8PSBh
bng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCBNSVBJX0RJR0lUQUxf
UExMXzgsCisJCQkJcG9zdF9kaXZpZGVyIDw8IDQpOworCisJLyogYWRkIHBhdGNoIGZvciBNSVMy
LTEyNSAoNXBjcyBBTlg3NjI1IGZhaWwgQVRFIE1CSVNUIHRlc3QpICovCisJcmV0IHw9IGFueDc2
MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCBNSVBJX0RJR0lUQUxfUExM
XzcsCisJCQkJIH5NSVBJX1BMTF9WQ09fVFVORV9SRUdfVkFMKTsKKworCS8qIHJlc2V0IE9ERkMg
UExMICovCisJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xp
ZW50LCBNSVBJX0RJR0lUQUxfUExMXzcsCisJCQkJIH5NSVBJX1BMTF9SRVNFVF9OKTsKKwlyZXQg
fD0gYW54NzYyNV93cml0ZV9vcihjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9ESUdJ
VEFMX1BMTF83LAorCQkJCU1JUElfUExMX1JFU0VUX04pOworCisJaWYgKHJldCA8IDApCisJCURS
TV9FUlJPUigiSU8gZXJyb3IuXG4iKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQg
YW54NzYyNV9kc2lfdmlkZW9fdGltaW5nX2NvbmZpZyhzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgp
Cit7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisJdW5zaWduZWQg
bG9uZyBtLCBuOworCXUxNiBodG90YWw7CisJaW50IHJldDsKKwl1OCBwb3N0X2RpdmlkZXIgPSAw
OworCisJcmV0ID0gYW54NzYyNV9jYWxjdWxhdGVfbV9uKGN0eC0+ZHQucGl4ZWxjbG9jay5taW4g
KiAxMDAwLAorCQkJCSAgICAmbSwgJm4sICZwb3N0X2RpdmlkZXIpOworCisJaWYgKHJldCAhPSAw
KSB7CisJCURSTV9FUlJPUigiY2Fubm90IGdldCBwcm9wZXJ0eSBtIG4gdmFsdWUuXG4iKTsKKwkJ
cmV0dXJuIC1FSU5WQUw7CisJfQorCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiY29tcHV0
ZSBNKCVsdSksIE4oJWx1KSwgZGl2aWRlciglZCkuXG4iLAorCQkJICAgICBtLCBuLCBwb3N0X2Rp
dmlkZXIpOworCisJLyogY29uZmlndXJlIHBpeGVsIGNsb2NrICovCisJcmV0ID0gYW54NzYyNV9y
ZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsIFBJWEVMX0NMT0NLX0wsCisJCQkJ
KGN0eC0+ZHQucGl4ZWxjbG9jay5taW4gLyAxMDAwKSAmIDB4RkYpOworCXJldCB8PSBhbng3NjI1
X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwgUElYRUxfQ0xPQ0tfSCwKKwkJ
CQkgKGN0eC0+ZHQucGl4ZWxjbG9jay5taW4gLyAxMDAwKSA+PiA4KTsKKwkvKiBsYW5lIGNvdW50
ICovCisJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50
LAorCQkJTUlQSV9MQU5FX0NUUkxfMCwgMHhmYyk7CisJcmV0IHw9IGFueDc2MjVfd3JpdGVfb3Io
Y3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCisJCQkJTUlQSV9MQU5FX0NUUkxfMCwgMyk7CisK
KwkvKiBIdG90YWwgKi8KKwlodG90YWwgPSBjdHgtPmR0LmhhY3RpdmUubWluICsgY3R4LT5kdC5o
ZnJvbnRfcG9yY2gubWluICsKKwkJY3R4LT5kdC5oYmFja19wb3JjaC5taW4gKyBjdHgtPmR0Lmhz
eW5jX2xlbi5taW47CisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhf
cDJfY2xpZW50LAorCQkJSE9SSVpPTlRBTF9UT1RBTF9QSVhFTFNfTCwgaHRvdGFsICYgMHhGRik7
CisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAor
CQkJSE9SSVpPTlRBTF9UT1RBTF9QSVhFTFNfSCwgaHRvdGFsID4+IDgpOworCS8qIEhhY3RpdmUg
Ki8KKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQs
CisJCQlIT1JJWk9OVEFMX0FDVElWRV9QSVhFTFNfTCwgY3R4LT5kdC5oYWN0aXZlLm1pbiAmIDB4
RkYpOworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVu
dCwKKwkJCUhPUklaT05UQUxfQUNUSVZFX1BJWEVMU19ILCBjdHgtPmR0LmhhY3RpdmUubWluID4+
IDgpOworCS8qIEhGUCAqLworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJj
LnJ4X3AyX2NsaWVudCwKKwkJCUhPUklaT05UQUxfRlJPTlRfUE9SQ0hfTCwgY3R4LT5kdC5oZnJv
bnRfcG9yY2gubWluKTsKKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5y
eF9wMl9jbGllbnQsCisJCQlIT1JJWk9OVEFMX0ZST05UX1BPUkNIX0gsCisJCQljdHgtPmR0Lmhm
cm9udF9wb3JjaC5taW4gPj4gOCk7CisJLyogSFdTICovCisJcmV0IHw9IGFueDc2MjVfcmVnX3dy
aXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAorCQkJSE9SSVpPTlRBTF9TWU5DX1dJRFRI
X0wsIGN0eC0+ZHQuaHN5bmNfbGVuLm1pbik7CisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0
eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAorCQkJSE9SSVpPTlRBTF9TWU5DX1dJRFRIX0gsIGN0
eC0+ZHQuaHN5bmNfbGVuLm1pbiA+PiA4KTsKKwkvKiBIQlAgKi8KKwlyZXQgfD0gYW54NzYyNV9y
ZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMl9jbGllbnQsCisJCQlIT1JJWk9OVEFMX0JBQ0tf
UE9SQ0hfTCwgY3R4LT5kdC5oYmFja19wb3JjaC5taW4pOworCXJldCB8PSBhbng3NjI1X3JlZ193
cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwKKwkJCUhPUklaT05UQUxfQkFDS19QT1JD
SF9ILCBjdHgtPmR0LmhiYWNrX3BvcmNoLm1pbiA+PiA4KTsKKwkvKiBWYWN0aXZlICovCisJcmV0
IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LCBBQ1RJVkVf
TElORVNfTCwKKwkJCWN0eC0+ZHQudmFjdGl2ZS5taW4pOworCXJldCB8PSBhbng3NjI1X3JlZ193
cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwgQUNUSVZFX0xJTkVTX0gsCisJCQljdHgt
PmR0LnZhY3RpdmUubWluID4+IDgpOworCS8qIFZGUCAqLworCXJldCB8PSBhbng3NjI1X3JlZ193
cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwKKwkJCVZFUlRJQ0FMX0ZST05UX1BPUkNI
LCBjdHgtPmR0LnZmcm9udF9wb3JjaC5taW4pOworCS8qIFZXUyAqLworCXJldCB8PSBhbng3NjI1
X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AyX2NsaWVudCwKKwkJCVZFUlRJQ0FMX1NZTkNf
V0lEVEgsIGN0eC0+ZHQudnN5bmNfbGVuLm1pbik7CisJLyogVkJQICovCisJcmV0IHw9IGFueDc2
MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDJfY2xpZW50LAorCQkJVkVSVElDQUxfQkFD
S19QT1JDSCwgY3R4LT5kdC52YmFja19wb3JjaC5taW4pOworCS8qIE0gdmFsdWUgKi8KKwlyZXQg
fD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCisJCQlNSVBJ
X1BMTF9NX05VTV8yM18xNiwgKG0gPj4gMTYpICYgMHhmZik7CisJcmV0IHw9IGFueDc2MjVfcmVn
X3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAorCQkJTUlQSV9QTExfTV9OVU1fMTVf
OCwgKG0gPj4gOCkgJiAweGZmKTsKKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgt
PmkyYy5yeF9wMV9jbGllbnQsCisJCQlNSVBJX1BMTF9NX05VTV83XzAsIChtICYgMHhmZikpOwor
CS8qIE4gdmFsdWUgKi8KKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5y
eF9wMV9jbGllbnQsCisJCQlNSVBJX1BMTF9OX05VTV8yM18xNiwgKG4gPj4gMTYpICYgMHhmZik7
CisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LAor
CQkJTUlQSV9QTExfTl9OVU1fMTVfOCwgKG4gPj4gOCkgJiAweGZmKTsKKwlyZXQgfD0gYW54NzYy
NV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIE1JUElfUExMX05fTlVNXzdf
MCwKKwkJCShuICYgMHhmZikpOworCS8qIGRpZmYgKi8KKwlyZXQgfD0gYW54NzYyNV9yZWdfd3Jp
dGUoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCisJCQlNSVBJX0RJR0lUQUxfQURKXzEsIDB4
MzcpOworCisJcmV0IHw9IGFueDc2MjVfb2RmY19jb25maWcoY3R4LCBwb3N0X2RpdmlkZXIgLSAx
KTsKKworCWlmIChyZXQgPCAwKQorCQlEUk1fRVJST1IoIm1pcGkgZHNpIHNldHVwIElPIGVycm9y
LlxuIik7CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IGFueDc2MjVfc3dhcF9kc2lf
bGFuZTMoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCWludCB2YWw7CisKKwkvKiBzd2Fw
IE1JUEktRFNJIGRhdGEgbGFuZSAzIFAgYW5kIE4gKi8KKwl2YWwgPSBhbng3NjI1X3JlZ19yZWFk
KGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCBNSVBJX1NXQVApOworCWlmICh2YWwgPCAwKSB7
CisJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBhY2Nlc3MgTUlQSV9TV0FQLlxuIik7CisJCXJldHVy
biAtRUlPOworCX0KKworCXZhbCB8PSAoMSA8PCBNSVBJX1NXQVBfQ0gzKTsKKwlyZXR1cm4gYW54
NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIE1JUElfU1dBUCwgdmFs
KTsKK30KKworc3RhdGljIGludCBhbng3NjI1X2FwaV9kc2lfY29uZmlnKHN0cnVjdCBhbng3NjI1
X2RhdGEgKmN0eCkKKworeworCWludCB2YWwsIHJldDsKKworCS8qIHN3YXAgTUlQSS1EU0kgZGF0
YSBsYW5lIDMgUCBhbmQgTiAqLworCXJldCA9IGFueDc2MjVfc3dhcF9kc2lfbGFuZTMoY3R4KTsK
KwlpZiAocmV0IDwgMCkgeworCQlEUk1fRVJST1IoIklPIGVycm9yIDogc3dhcCBkc2kgbGFuZSAz
IGZhaWxlZC5cbiIpOworCQlyZXR1cm4gcmV0OworCX0KKworCS8qIERTSSBjbG9jayBzZXR0aW5n
cyAqLworCXZhbCA9ICgwIDw8IE1JUElfSFNfUFdEX0NMSykJCXwKKwkJKDAgPDwgTUlQSV9IU19S
VF9DTEspCQl8CisJCSgwIDw8IE1JUElfUERfQ0xLKQkJfAorCQkoMSA8PCBNSVBJX0NMS19SVF9N
QU5VQUxfUERfRU4pCXwKKwkJKDEgPDwgTUlQSV9DTEtfSFNfTUFOVUFMX1BEX0VOKQl8CisJCSgw
IDw8IE1JUElfQ0xLX0RFVF9ERVRfQllQQVNTKQl8CisJCSgwIDw8IE1JUElfQ0xLX01JU1NfQ1RS
TCkJfAorCQkoMCA8PCBNSVBJX1BEX0xQVFhfQ0hfTUFOVUFMX1BEX0VOKTsKKwlyZXQgPSBhbng3
NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKKwkJCQlNSVBJX1BIWV9D
T05UUk9MXzMsIHZhbCk7CisKKwkvKgorCSAqIERlY3JlYXNlZCBIUyBwcmVwYXJlIHRpbWluZyBk
ZWxheSBmcm9tIDE2MG5zIHRvIDgwbnMgd29yayB3aXRoCisJICogICAgIGEpIERyYWdvbiBib2Fy
ZCA4MTAgc2VyaWVzIChRdWFsY29tbSBBUCkKKwkgKiAgICAgYikgTW92aW5nIFBpeGVsIERTSSBz
b3VyY2UgKFBHM0EgcGF0dGVybiBnZW5lcmF0b3IgKworCSAqCVAzMzIgRC1QSFkgUHJvYmUpIGRl
ZmF1bHQgRC1QSFkgdGltaW5nCisJICoJNW5zL3N0ZXAKKwkgKi8KKwlyZXQgfD0gYW54NzYyNV9y
ZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCisJCQkJIE1JUElfVElNRV9IU19Q
UlBSLCAweDEwKTsKKworCS8qIGVuYWJsZSBEU0kgbW9kZSovCisJcmV0IHw9IGFueDc2MjVfd3Jp
dGVfb3IoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIE1JUElfRElHSVRBTF9QTExfMTgsCisJ
CQkJU0VMRUNUX0RTSSA8PCBNSVBJX0RQSV9TRUxFQ1QpOworCisJcmV0IHw9IGFueDc2MjVfZHNp
X3ZpZGVvX3RpbWluZ19jb25maWcoY3R4KTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fRVJST1Io
ImRzaSB2aWRlbyB0aW1pbmcgY29uZmlnIGZhaWxlZFxuIik7CisJCXJldHVybiByZXQ7CisJfQor
CisJLyogdG9nZ2xlIG0sIG4gcmVhZHkgKi8KKwlyZXQgPSBhbng3NjI1X3dyaXRlX2FuZChjdHgs
IGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgTUlQSV9ESUdJVEFMX1BMTF82LAorCQkJCX4oTUlQSV9N
X05VTV9SRUFEWSB8IE1JUElfTl9OVU1fUkVBRFkpKTsKKwl1c2xlZXBfcmFuZ2UoMTAwMCwgMTEw
MCk7CisJcmV0IHw9IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQs
IE1JUElfRElHSVRBTF9QTExfNiwKKwkJCQlNSVBJX01fTlVNX1JFQURZIHwgTUlQSV9OX05VTV9S
RUFEWSk7CisKKwkvKiBjb25maWd1cmUgaW50ZWdlciBzdGFibGUgcmVnaXN0ZXIgKi8KKwlyZXQg
fD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsCisJCQkJIE1J
UElfVklERU9fU1RBQkxFX0NOVCwgMHgwMik7CisJLyogcG93ZXIgb24gTUlQSSBSWCAqLworCXJl
dCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKKwkJCQkg
TUlQSV9MQU5FX0NUUkxfMTAsIDB4MDApOworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgs
IGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwKKwkJCQkgTUlQSV9MQU5FX0NUUkxfMTAsIDB4ODApOwor
CisJaWYgKHJldCA8IDApCisJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBtaXBpIGRzaSBlbmFibGUg
aW5pdCBmYWlsZWQuXG4iKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYy
NV9kc2lfY29uZmlnKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sKKwlzdHJ1Y3QgZGV2aWNl
ICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKwlpbnQgcmV0OworCisJRFJNX0RFVl9ERUJVR19E
UklWRVIoZGV2LCAiY29uZmlnIGRzaS5cbiIpOworCisJLyogRFNDIGRpc2FibGUgKi8KKwlyZXQg
PSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQlSX0RT
Q19DVFJMXzAsIH5EU0NfRU4pOworCisJcmV0IHw9IGFueDc2MjVfYXBpX2RzaV9jb25maWcoY3R4
KTsKKworCWlmIChyZXQgPCAwKSB7CisJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBhcGkgZHNpIGNv
bmZpZyBlcnJvci5cbiIpOworCX0gZWxzZSB7CisJCS8qIHNldCBNSVBJIFJYIEVOICovCisJCXJl
dCA9IGFueDc2MjVfd3JpdGVfb3IoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJICAg
ICAgIEFQX0FWX1NUQVRVUywgQVBfTUlQSV9SWF9FTik7CisJCS8qIGNsZWFyIG11dGUgZmxhZyAq
LworCQlyZXQgfD0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQs
CisJCQkJCSBBUF9BVl9TVEFUVVMsICh1OCl+QVBfTUlQSV9NVVRFKTsKKwkJaWYgKHJldCA8IDAp
CisJCQlEUk1fRVJST1IoIklPIGVycm9yIDogZW5hYmxlIG1pcGkgcnggZmFpbGVkLlxuIik7CisJ
CWVsc2UKKwkJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgInN1Y2Nlc3MgdG8gY29uZmlnIERT
SVxuIik7CisJfQorCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBhbng3NjI1X2FwaV9k
cGlfY29uZmlnKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sKKwl1MTYgZnJlcSA9IGN0eC0+
ZHQucGl4ZWxjbG9jay5taW4gLyAxMDAwOworCWludCByZXQ7CisKKwkvKiBjb25maWd1cmUgcGl4
ZWwgY2xvY2sgKi8KKwlyZXQgPSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3Aw
X2NsaWVudCwKKwkJCQlQSVhFTF9DTE9DS19MLCBmcmVxICYgMHhGRik7CisJcmV0IHw9IGFueDc2
MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCSBQSVhFTF9DTE9D
S19ILCAoZnJlcSA+PiA4KSk7CisKKwkvKiBzZXQgRFBJIG1vZGUgKi8KKwkvKiBzZXQgdG8gRFBJ
IFBMTCBtb2R1bGUgc2VsICovCisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5p
MmMucnhfcDFfY2xpZW50LAorCQkJCSBNSVBJX0RJR0lUQUxfUExMXzksIDB4MjApOworCS8qIHBv
d2VyIGRvd24gTUlQSSAqLworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJj
LnJ4X3AxX2NsaWVudCwKKwkJCQkgTUlQSV9MQU5FX0NUUkxfMTAsIDB4MDgpOworCS8qIGVuYWJs
ZSBEUEkgbW9kZSAqLworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4
X3AxX2NsaWVudCwKKwkJCQkgTUlQSV9ESUdJVEFMX1BMTF8xOCwgMHgxQyk7CisJLyogc2V0IGZp
cnN0IGVkZ2UgKi8KKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy50eF9w
Ml9jbGllbnQsCisJCQkJIFZJREVPX0NPTlRST0xfMCwgMHgwNSk7CisJaWYgKHJldCA8IDApCisJ
CURSTV9FUlJPUigiSU8gZXJyb3IgOiBkcGkgcGh5IHNldCBmYWlsZWQuXG4iKTsKKworCXJldHVy
biByZXQ7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV9kcGlfY29uZmlnKHN0cnVjdCBhbng3NjI1
X2RhdGEgKmN0eCkKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsK
KwlpbnQgcmV0OworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiY29uZmlnIGRwaVxuIik7
CisKKwkvKiBEU0MgZGlzYWJsZSAqLworCXJldCA9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4
LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCVJfRFNDX0NUUkxfMCwgfkRTQ19FTik7CisJaWYgKHJl
dCA8IDApIHsKKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGRpc2FibGUgZHNjIGZhaWxlZC5cbiIp
OworCQlyZXR1cm4gcmV0OworCX0KKworCXJldCA9IGFueDc2MjVfY29uZmlnX2JpdF9tYXRyaXgo
Y3R4KTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fRVJST1IoImNvbmZpZyBiaXQgbWF0cml4IGZh
aWxlZC5cbiIpOworCQlyZXR1cm4gcmV0OworCX0KKworCXJldCA9IGFueDc2MjVfYXBpX2RwaV9j
b25maWcoY3R4KTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fRVJST1IoIm1pcGkgcGh5KGRwaSkg
c2V0dXAgZmFpbGVkLlxuIik7CisJCXJldHVybiByZXQ7CisJfQorCisJLyogc2V0IE1JUEkgUlgg
RU4gKi8KKwlyZXQgPSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50
LAorCQkJICAgICAgIEFQX0FWX1NUQVRVUywgQVBfTUlQSV9SWF9FTik7CisJLyogY2xlYXIgbXV0
ZSBmbGFnICovCisJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDBf
Y2xpZW50LAorCQkJCSBBUF9BVl9TVEFUVVMsICh1OCl+QVBfTUlQSV9NVVRFKTsKKwlpZiAocmV0
IDwgMCkKKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGVuYWJsZSBtaXBpIHJ4IGZhaWxlZC5cbiIp
OworCisJcmV0dXJuIHJldDsKK30KKworY29uc3QgdTggQU5YX09VSVszXSA9IHsgMHgwMCwgMHgy
MiwgMHhCOSB9Oworc3RhdGljIGludCBpc19hbnhfZG9uZ2xlKHN0cnVjdCBhbng3NjI1X2RhdGEg
KmN0eCkKK3sKKwl1OCBidWZbM107CisKKwkvKiAweDA1MDB+MHgwNTAyOiBCUkFOQ0hfSUVFRV9P
VUkgKi8KKwlzcF90eF9hdXhfZHBjZHJlYWRfYnl0ZXMoY3R4LCAweDAwLCAweDA1LCAweDAwLCBz
aXplb2YoYnVmKSwgYnVmKTsKKwlpZiAobWVtY21wKGJ1ZiwgQU5YX09VSSwgc2l6ZW9mKGJ1Zikp
ID09IDApCisJCXJldHVybiAwOworCisJcmV0dXJuIC1FTlhJTzsKK30KKworc3RhdGljIHZvaWQg
c3BfdHhfZ2V0X3J4X2J3KHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwgdTggKmJ3KQoreworCXU4
IGRhdGFfYnVmWzRdOworCS8qCisJICogV2hlbiBBTlggZG9uZ2xlIGNvbm5lY3RlZCwgaWYgQ0hJ
UF9JRCA9IDB4Nzc1MCwgYmFuZHdpZHRoIGlzIDYuNzVHLAorCSAqIGJlY2F1c2UgQU5YNzc1MCBE
UENEIDB4MDUyeCB3YXMgbm90IGF2YWlsYWJsZS4KKwkgKi8KKwlpZiAoIWlzX2FueF9kb25nbGUo
Y3R4KSkgeworCQlzcF90eF9hdXhfZHBjZHJlYWRfYnl0ZXMoY3R4LCAweDAwLCAweDA1LCAweDAz
LCAweDA0LCBkYXRhX2J1Zik7CisJCWlmIChkYXRhX2J1ZlswXSA9PSAweDM3ICYmIGRhdGFfYnVm
WzFdID09IDB4MzcgJiYKKwkJICAgIGRhdGFfYnVmWzJdID09IDB4MzUgJiYgZGF0YV9idWZbM10g
PT0gMHgzMCkgeworCQkJLyogMHgxOSA6IDYuNzVHICovCisJCQkqYncgPSAweDE5OworCQl9IGVs
c2UgeworCQkJc3BfdHhfYXV4X2RwY2RyZWFkX2J5dGVzKGN0eCwgMHgwMCwgMHgwNSwgMHgyMSwg
MSwgYncpOworCQkJLyoKKwkJCSAqIHNvbWUgQU5YIGRvbmdsZSByZWFkIG91dCB2YWx1ZSAwLAor
CQkJICogcmV0cnkgc3RhbmRhcmQgcmVnaXN0ZXIuCisJCQkgKi8KKwkJCWlmICgoKCpidykgPT0g
MCkgfHwgKCgqYncpID09IDB4ZmYpKQorCQkJCXNwX3R4X2F1eF9kcGNkcmVhZF9ieXRlcyhjdHgs
IDB4MDAsIDB4MDAsCisJCQkJCQkJIERQQ0RfTUFYX0xJTktfUkFURSwKKwkJCQkJCQkgMSwgYncp
OworCQl9CisJfSBlbHNlIHsKKwkJc3BfdHhfYXV4X2RwY2RyZWFkX2J5dGVzKGN0eCwgMHgwMCwg
MHgwMCwKKwkJCQkJIERQQ0RfTUFYX0xJTktfUkFURSwgMSwgYncpOworCX0KK30KKworc3RhdGlj
IHZvaWQgYW54NzYyNV9kcF9zdGFydChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJaW50
IHJldDsKKworCWlmICghY3R4LT5kaXNwbGF5X3RpbWluZ192YWxpZCkgeworCQlEUk1fRVJST1Io
Im1pcGkgZHJtIGhhdmVuJ3Qgc2V0IGRpc3BsYXkgdGltaW5nIHlldC5cbiIpOworCQlyZXR1cm47
CisJfQorCisJcmV0ID0gYW54NzYyNV9jb25maWdfYXVkaW9faW5wdXQoY3R4KTsKKwlpZiAocmV0
IDwgMCkKKwkJRFJNX0VSUk9SKCJjb25maWcgYXVkaW8gaW5wdXQgZmFpbGVkLlxuIik7CisKKwlp
ZiAoY3R4LT5wZGF0YS5kc2lfc3VwcG9ydGVkKQorCQlyZXQgPSBhbng3NjI1X2RzaV9jb25maWco
Y3R4KTsKKwllbHNlCisJCXJldCA9IGFueDc2MjVfZHBpX2NvbmZpZyhjdHgpOworCisJaWYgKHJl
dCA8IDApCisJCURSTV9FUlJPUigiTUlQSSBwaHkgc2V0dXAgZXJyb3IuXG4iKTsKK30KKworc3Rh
dGljIHZvaWQgYW54NzYyNV9kcF9zdG9wKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sKKwlz
dHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKwlpbnQgcmV0OworCisJRFJN
X0RFVl9ERUJVR19EUklWRVIoZGV2LCAic3RvcCBkcCBvdXRwdXRcbiIpOworCisJLyoKKwkgKiB2
aWRlbyBkaXNhYmxlOiAweDcyOjA4IGJpdCA3ID0gMDsKKwkgKiBhdWRpbyBkaXNhYmxlOiAweDcw
Ojg3IGJpdCAwID0gMDsKKwkgKi8KKwlyZXQgPSBhbng3NjI1X3dyaXRlX2FuZChjdHgsIGN0eC0+
aTJjLnR4X3AwX2NsaWVudCwgMHg4NywgMHhmZSk7CisJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5k
KGN0eCwgY3R4LT5pMmMudHhfcDJfY2xpZW50LCAweDA4LCAweDdmKTsKKworCXJldCB8PSBhbng3
NjI1X3ZpZGVvX211dGVfY29udHJvbChjdHgsIDEpOworCWlmIChyZXQgPCAwKQorCQlEUk1fRVJS
T1IoIklPIGVycm9yIDogbXV0ZSB2aWRlbyBmYWlsZWRcbiIpOworfQorCitzdGF0aWMgaW50IHNw
X3R4X3JzdF9hdXgoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCWludCByZXQ7CisKKwly
ZXQgPSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMudHhfcDJfY2xpZW50LCBSU1RfQ1RS
TDIsCisJCQkgICAgICAgQVVYX1JTVCk7CisJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwg
Y3R4LT5pMmMudHhfcDJfY2xpZW50LCBSU1RfQ1RSTDIsCisJCQkJIH5BVVhfUlNUKTsKKwlyZXR1
cm4gcmV0OworfQorCitzdGF0aWMgaW50IHNwX3R4X2F1eF93cihzdHJ1Y3QgYW54NzYyNV9kYXRh
ICpjdHgsIHU4IG9mZnNldCkKK3sKKwlpbnQgcmV0OworCisJcmV0ID0gYW54NzYyNV9yZWdfd3Jp
dGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJQVBfQVVYX0JVRkZfU1RBUlQsIG9m
ZnNldCk7CisJcmV0IHw9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xp
ZW50LAorCQkJCSBBUF9BVVhfQ09NTUFORCwgMHgwNCk7CisJcmV0IHw9IGFueDc2MjVfd3JpdGVf
b3IoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJQVBfQVVYX0NUUkxfU1RBVFVTLCBB
UF9BVVhfQ1RSTF9PUF9FTik7CisJcmV0dXJuIChyZXQgfCB3YWl0X2F1eF9vcF9maW5pc2goY3R4
KSk7Cit9CisKK3N0YXRpYyBpbnQgc3BfdHhfYXV4X3JkKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0
eCwgdTggbGVuX2NtZCkKK3sKKwlpbnQgcmV0OworCisJcmV0ID0gYW54NzYyNV9yZWdfd3JpdGUo
Y3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJQVBfQVVYX0NPTU1BTkQsIGxlbl9jbWQp
OworCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAor
CQkJCUFQX0FVWF9DVFJMX1NUQVRVUywgQVBfQVVYX0NUUkxfT1BfRU4pOworCXJldHVybiAocmV0
IHwgd2FpdF9hdXhfb3BfZmluaXNoKGN0eCkpOworfQorCitzdGF0aWMgaW50IHNwX3R4X2dldF9l
ZGlkX2Jsb2NrKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sKKwlpbnQgYyA9IDA7CisJc3Ry
dWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisKKwlzcF90eF9hdXhfd3IoY3R4
LCAweDdlKTsKKwlzcF90eF9hdXhfcmQoY3R4LCAweDAxKTsKKwljID0gYW54NzYyNV9yZWdfcmVh
ZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwgQVBfQVVYX0JVRkZfU1RBUlQpOworCWlmIChj
IDwgMCkgeworCQlEUk1fRVJST1IoIklPIGVycm9yIDogYWNjZXNzIEFVWCBCVUZGLlxuIik7CisJ
CXJldHVybiAtRUlPOworCX0KKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIiBFRElEIEJs
b2NrID0gJWRcbiIsIGMgKyAxKTsKKworCWlmIChjID4gMykKKwkJYyA9IDE7CisKKwlyZXR1cm4g
YzsKK30KKworc3RhdGljIGludCBlZGlkX3JlYWQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LAor
CQkgICAgIHU4IG9mZnNldCwgdTggKnBibG9ja19idWYpCit7CisJdTggYywgY250ID0gMDsKKwlz
dHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKworCWMgPSAwOworCWZvciAo
Y250ID0gMDsgY250IDwgMzsgY250KyspIHsKKwkJc3BfdHhfYXV4X3dyKGN0eCwgb2Zmc2V0KTsK
KwkJLyogc2V0IEkyQyByZWFkIGNvbSAweDAxIG1vdCA9IDAgYW5kIHJlYWQgMTYgYnl0ZXMgKi8K
KwkJYyA9IHNwX3R4X2F1eF9yZChjdHgsIDB4ZjEpOworCisJCWlmIChjID09IDEpIHsKKwkJCXNw
X3R4X3JzdF9hdXgoY3R4KTsKKwkJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImVkaWQgcmVh
ZCBmYWlsZWQsIHJlc2V0IVxuIik7CisJCQljbnQrKzsKKwkJfSBlbHNlIHsKKwkJCWFueDc2MjVf
cmVnX2Jsb2NrX3JlYWQoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJCSAgICAgICBB
UF9BVVhfQlVGRl9TVEFSVCwKKwkJCQkJICAgICAgIE1BWF9EUENEX0JVRkZFUl9TSVpFLAorCQkJ
CQkgICAgICAgcGJsb2NrX2J1Zik7CisJCQlyZXR1cm4gMDsKKwkJfQorCX0KKworCXJldHVybiAt
RUlPOworfQorCitzdGF0aWMgaW50IHNlZ21lbnRzX2VkaWRfcmVhZChzdHJ1Y3QgYW54NzYyNV9k
YXRhICpjdHgsCisJCQkgICAgICB1OCBzZWdtZW50LCB1OCAqYnVmLCB1OCBvZmZzZXQpCit7CisJ
dTggYywgY250ID0gMDsKKwlpbnQgcmV0OworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNs
aWVudC0+ZGV2OworCisJLyogd3JpdGUgYWRkcmVzcyBvbmx5ICovCisJcmV0ID0gYW54NzYyNV9y
ZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJQVBfQVVYX0FERFJfN18w
LCAweDMwKTsKKwlyZXQgfD0gYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9j
bGllbnQsCisJCQkJIEFQX0FVWF9DT01NQU5ELCAweDA0KTsKKwlyZXQgfD0gYW54NzYyNV9yZWdf
d3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJIEFQX0FVWF9DVFJMX1NUQVRV
UywKKwkJCQkgQVBfQVVYX0NUUkxfQUREUk9OTFkgfCBBUF9BVVhfQ1RSTF9PUF9FTik7CisKKwly
ZXQgfD0gd2FpdF9hdXhfb3BfZmluaXNoKGN0eCk7CisJLyogd3JpdGUgc2VnbWVudCBhZGRyZXNz
ICovCisJcmV0IHw9IHNwX3R4X2F1eF93cihjdHgsIHNlZ21lbnQpOworCS8qIGRhdGEgcmVhZCAq
LworCXJldCB8PSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwK
KwkJCQkgQVBfQVVYX0FERFJfN18wLCAweDUwKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fRVJS
T1IoIklPIGVycm9yIDogYXV4IGluaXRpYWwgZmFpbGVkLlxuIik7CisJCXJldHVybiByZXQ7CisJ
fQorCisJZm9yIChjbnQgPSAwOyBjbnQgPCAzOyBjbnQrKykgeworCQlzcF90eF9hdXhfd3IoY3R4
LCBvZmZzZXQpOworCQkvKiBzZXQgSTJDIHJlYWQgY29tIDB4MDEgbW90ID0gMCBhbmQgcmVhZCAx
NiBieXRlcyAqLworCQljID0gc3BfdHhfYXV4X3JkKGN0eCwgMHhmMSk7CisKKwkJaWYgKGMgPT0g
MSkgeworCQkJcmV0ID0gc3BfdHhfcnN0X2F1eChjdHgpOworCQkJRFJNX0RFVl9FUlJPUihkZXYs
ICJzZWdtZW50IHJlYWQgZmFpbGVkLCByZXNldCFcbiIpOworCQkJY250Kys7CisJCX0gZWxzZSB7
CisJCQlyZXQgPSBhbng3NjI1X3JlZ19ibG9ja19yZWFkKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xp
ZW50LAorCQkJCQkJICAgICBBUF9BVVhfQlVGRl9TVEFSVCwKKwkJCQkJCSAgICAgTUFYX0RQQ0Rf
QlVGRkVSX1NJWkUsIGJ1Zik7CisJCQlyZXR1cm4gcmV0OworCQl9CisJfQorCisJcmV0dXJuIHJl
dDsKK30KKworc3RhdGljIGludCBzcF90eF9lZGlkX3JlYWQoc3RydWN0IGFueDc2MjVfZGF0YSAq
Y3R4LAorCQkJICAgdTggKnBlZGlkX2Jsb2Nrc19idWYpCit7CisJdTggb2Zmc2V0LCBlZGlkX3Bv
czsKKwlpbnQgY291bnQsIGJsb2Nrc19udW07CisJdTggcGJsb2NrX2J1ZltNQVhfRFBDRF9CVUZG
RVJfU0laRV07CisJdTggaSwgajsKKwl1OCBnX2VkaWRfYnJlYWsgPSAwOworCWludCByZXQ7CisJ
c3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisKKwkvKiBhZGRyZXNzIGlu
aXRpYWwgKi8KKwlyZXQgPSBhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2Ns
aWVudCwKKwkJCQlBUF9BVVhfQUREUl83XzAsIDB4NTApOworCXJldCB8PSBhbng3NjI1X3JlZ193
cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkgQVBfQVVYX0FERFJfMTVfOCwg
MCk7CisJcmV0IHw9IGFueDc2MjVfd3JpdGVfYW5kKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50
LAorCQkJCSBBUF9BVVhfQUREUl8xOV8xNiwgMHhmMCk7CisJaWYgKHJldCA8IDApIHsKKwkJRFJN
X0VSUk9SKCJhY2Nlc3MgYXV4IGNoYW5uZWwgSU8gZXJyb3IuXG4iKTsKKwkJcmV0dXJuIC1FSU87
CisJfQorCisJYmxvY2tzX251bSA9IHNwX3R4X2dldF9lZGlkX2Jsb2NrKGN0eCk7CisJaWYgKGJs
b2Nrc19udW0gPCAwKQorCQlyZXR1cm4gYmxvY2tzX251bTsKKworCWNvdW50ID0gMDsKKworCWRv
IHsKKwkJc3dpdGNoIChjb3VudCkgeworCQljYXNlIDA6CisJCWNhc2UgMToKKwkJCWZvciAoaSA9
IDA7IGkgPCA4OyBpKyspIHsKKwkJCQlvZmZzZXQgPSAoaSArIGNvdW50ICogOCkgKiBNQVhfRFBD
RF9CVUZGRVJfU0laRTsKKwkJCQlnX2VkaWRfYnJlYWsgPSBlZGlkX3JlYWQoY3R4LCBvZmZzZXQs
CisJCQkJCQkJIHBibG9ja19idWYpOworCisJCQkJaWYgKGdfZWRpZF9icmVhaykKKwkJCQkJYnJl
YWs7CisKKwkJCQltZW1jcHkoJnBlZGlkX2Jsb2Nrc19idWZbb2Zmc2V0XSwKKwkJCQkgICAgICAg
cGJsb2NrX2J1ZiwKKwkJCQkgICAgICAgTUFYX0RQQ0RfQlVGRkVSX1NJWkUpOworCQkJfQorCisJ
CQlicmVhazsKKwkJY2FzZSAyOgorCQkJb2Zmc2V0ID0gMHgwMDsKKworCQkJZm9yIChqID0gMDsg
aiA8IDg7IGorKykgeworCQkJCWVkaWRfcG9zID0gKGogKyBjb3VudCAqIDgpICoKKwkJCQkJTUFY
X0RQQ0RfQlVGRkVSX1NJWkU7CisKKwkJCQlpZiAoZ19lZGlkX2JyZWFrID09IDEpCisJCQkJCWJy
ZWFrOworCisJCQkJc2VnbWVudHNfZWRpZF9yZWFkKGN0eCwgY291bnQgLyAyLAorCQkJCQkJICAg
cGJsb2NrX2J1Ziwgb2Zmc2V0KTsKKwkJCQltZW1jcHkoJnBlZGlkX2Jsb2Nrc19idWZbZWRpZF9w
b3NdLAorCQkJCSAgICAgICBwYmxvY2tfYnVmLAorCQkJCSAgICAgICBNQVhfRFBDRF9CVUZGRVJf
U0laRSk7CisJCQkJb2Zmc2V0ID0gb2Zmc2V0ICsgMHgxMDsKKwkJCX0KKworCQkJYnJlYWs7CisJ
CWNhc2UgMzoKKwkJCW9mZnNldCA9IDB4ODA7CisKKwkJCWZvciAoaiA9IDA7IGogPCA4OyBqKysp
IHsKKwkJCQllZGlkX3BvcyA9IChqICsgY291bnQgKiA4KSAqCisJCQkJCU1BWF9EUENEX0JVRkZF
Ul9TSVpFOworCQkJCWlmIChnX2VkaWRfYnJlYWsgPT0gMSkKKwkJCQkJYnJlYWs7CisKKwkJCQlz
ZWdtZW50c19lZGlkX3JlYWQoY3R4LCBjb3VudCAvIDIsCisJCQkJCQkgICBwYmxvY2tfYnVmLCBv
ZmZzZXQpOworCQkJCW1lbWNweSgmcGVkaWRfYmxvY2tzX2J1ZltlZGlkX3Bvc10sCisJCQkJICAg
ICAgIHBibG9ja19idWYsCisJCQkJICAgICAgIE1BWF9EUENEX0JVRkZFUl9TSVpFKTsKKwkJCQlv
ZmZzZXQgPSBvZmZzZXQgKyAweDEwOworCQkJfQorCisJCQlicmVhazsKKwkJZGVmYXVsdDoKKwkJ
CWJyZWFrOworCQl9CisKKwkJY291bnQrKzsKKworCX0gd2hpbGUgKGJsb2Nrc19udW0gPj0gY291
bnQpOworCisJLyogY2hlY2sgZWRpZCBkYXRhICovCisJaWYgKGRybV9lZGlkX2lzX3ZhbGlkKChz
dHJ1Y3QgZWRpZCAqKXBlZGlkX2Jsb2Nrc19idWYpID09IGZhbHNlKQorCQlEUk1fREVWX0VSUk9S
KGRldiwgIldBUk5JTkchIGVkaWQgY2hlY2sgZmFpbGVkIVxuIik7CisKKwkvKiByZXNldCBhdXgg
Y2hhbm5lbCAqLworCXNwX3R4X3JzdF9hdXgoY3R4KTsKKworCXJldHVybiAoYmxvY2tzX251bSAr
IDEpOworfQorCitzdGF0aWMgdm9pZCBhbng3NjI1X3Bvd2VyX29uKHN0cnVjdCBhbng3NjI1X2Rh
dGEgKmN0eCkKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKwor
CWlmIChjdHgtPnBkYXRhLmxvd19wb3dlcl9tb2RlKSB7CisJCS8qIHBvd2VyIG9uIHBpbiBlbmFi
bGUgKi8KKwkJZ3Bpb2Rfc2V0X3ZhbHVlKGN0eC0+cGRhdGEuZ3Bpb19wX29uLCAxKTsKKwkJdXNs
ZWVwX3JhbmdlKDEwMDAwLCAxMTAwMCk7CisJCS8qIHBvd2VyIHJlc2V0IHBpbiBlbmFibGUgKi8K
KwkJZ3Bpb2Rfc2V0X3ZhbHVlKGN0eC0+cGRhdGEuZ3Bpb19yZXNldCwgMSk7CisJCXVzbGVlcF9y
YW5nZSgxMDAwMCwgMTEwMDApOworCisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIkFueDc2
MjUgcG93ZXIgb24gIVxuIik7CisJfSBlbHNlIHsKKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2
LCAiQW54NzYyNSBub3QgbG93IHBvd2VyIG1vZGUhXG4iKTsKKwl9Cit9CisKK3N0YXRpYyB2b2lk
IGFueDc2MjVfcG93ZXJfc3RhbmRieShzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJc3Ry
dWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisKKwlpZiAoY3R4LT5wZGF0YS5s
b3dfcG93ZXJfbW9kZSkgeworCQlncGlvZF9zZXRfdmFsdWUoY3R4LT5wZGF0YS5ncGlvX3Jlc2V0
LCAwKTsKKwkJdXNsZWVwX3JhbmdlKDEwMDAsIDExMDApOworCQlncGlvZF9zZXRfdmFsdWUoY3R4
LT5wZGF0YS5ncGlvX3Bfb24sIDApOworCQl1c2xlZXBfcmFuZ2UoMTAwMCwgMTEwMCk7CisJCURS
TV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImFueDc2MjUgcG93ZXIgZG93blxuIik7CisJfSBlbHNl
IHsKKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiYW54NzYyNSBub3QgbG93IHBvd2VyIG1v
ZGUhXG4iKTsKKwl9Cit9CisKKy8qIGJhc2ljIGNvbmZpZ3VyYXRpb25zIG9mIEFOWDc2MjUgKi8K
K3N0YXRpYyB2b2lkIGFueDc2MjVfY29uZmlnKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sK
Kwlhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCSAgWFRB
TF9GUlFfU0VMLCBYVEFMX0ZSUV8yN00pOworfQorCitzdGF0aWMgdm9pZCBhbng3NjI1X2Rpc2Fi
bGVfcGRfcHJvdG9jb2woc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCXN0cnVjdCBkZXZp
Y2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2OworCWludCByZXQ7CisKKwkvKiByZXNldCBtYWlu
IG9jbSAqLworCXJldCA9IGFueDc2MjVfcmVnX3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xp
ZW50LCAweDg4LCAweDQwKTsKKwkvKiBEaXNhYmxlIFBEICovCisJcmV0IHw9IGFueDc2MjVfcmVn
X3dyaXRlKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCSBBUF9BVl9TVEFUVVMsIEFQ
X0RJU0FCTEVfUEQpOworCS8qIHJlbGVhc2UgbWFpbiBvY20gKi8KKwlyZXQgfD0gYW54NzYyNV9y
ZWdfd3JpdGUoY3R4LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsIDB4ODgsIDB4MDApOworCisJaWYg
KHJldCA8IDApCisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRpc2FibGUgUEQgZmVhdHVy
ZSBmYWlsZWQuXG4iKTsKKwllbHNlCisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRpc2Fi
bGUgUEQgZmVhdHVyZSBzdWNjZWVkZWQuXG4iKTsKK30KKworc3RhdGljIHZvaWQgYW54NzYyNV9w
b3dlcl9vbl9pbml0KHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sKKwlpbnQgcmV0cnlfY291
bnQsIGk7CisJaW50IHJldCA9IDA7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50
LT5kZXY7CisKKwlmb3IgKHJldHJ5X2NvdW50ID0gMDsgcmV0cnlfY291bnQgPCAzOyByZXRyeV9j
b3VudCsrKSB7CisJCWFueDc2MjVfcG93ZXJfb24oY3R4KTsKKwkJYW54NzYyNV9jb25maWcoY3R4
KTsKKworCQlmb3IgKGkgPSAwOyBpIDwgT0NNX0xPQURJTkdfVElNRTsgaSsrKSB7CisJCQkvKiBj
aGVjayBpbnRlcmZhY2Ugd29ya2FibGUgKi8KKwkJCXJldCA9IGFueDc2MjVfcmVnX3JlYWQoY3R4
LCBjdHgtPmkyYy5yeF9wMF9jbGllbnQsCisJCQkJCSAgICAgICBGTEFTSF9MT0FEX1NUQSk7CisJ
CQlpZiAocmV0IDwgMCkgeworCQkJCURSTV9FUlJPUigiSU8gZXJyb3IgOiBhY2Nlc3MgZmxhc2gg
bG9hZC5cbiIpOworCQkJCXJldHVybjsKKwkJCX0KKwkJCWlmICgocmV0ICYgRkxBU0hfTE9BRF9T
VEFfQ0hLKSA9PSBGTEFTSF9MT0FEX1NUQV9DSEspIHsKKwkJCQlhbng3NjI1X2Rpc2FibGVfcGRf
cHJvdG9jb2woY3R4KTsKKwkJCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsCisJCQkJCQkgICAg
ICJGaXJtd2FyZSB2ZXIgJTAyeCUwMngsIiwKKwkJCQkJYW54NzYyNV9yZWdfcmVhZChjdHgsCisJ
CQkJCQkJIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkJCQkgT0NNX0ZXX1ZFUlNJT04pLAor
CQkJCQlhbng3NjI1X3JlZ19yZWFkKGN0eCwKKwkJCQkJCQkgY3R4LT5pMmMucnhfcDBfY2xpZW50
LAorCQkJCQkJCSBPQ01fRldfUkVWRVJTSU9OKSk7CisJCQkJRFJNX0RFVl9ERUJVR19EUklWRVIo
ZGV2LCAiRHJpdmVyIHZlcnNpb24gJXNcbiIsCisJCQkJCQkgICAgIEFOWDc2MjVfRFJWX1ZFUlNJ
T04pOworCisJCQkJcmV0dXJuOworCQkJfQorCQkJdXNsZWVwX3JhbmdlKDEwMDAsIDExMDApOwor
CQl9CisJCWFueDc2MjVfcG93ZXJfc3RhbmRieShjdHgpOworCX0KK30KKworc3RhdGljIGludCBh
bng3NjI1X2V4dGNvbl9ub3RpZmllcihzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgKm5iLAorCQkJCSAg
IHVuc2lnbmVkIGxvbmcgZXZlbnQsIHZvaWQgKnB0cikKK3sKKwlzdHJ1Y3QgYW54NzYyNV9kYXRh
ICpjdHggPQorCQljb250YWluZXJfb2YobmIsIHN0cnVjdCBhbng3NjI1X2RhdGEsIGV2ZW50X25i
KTsKKworCXNjaGVkdWxlX3dvcmsoJmN0eC0+ZXh0Y29uX3dxKTsKKwlyZXR1cm4gTk9USUZZX0RP
TkU7Cit9CisKK3N0YXRpYyB2b2lkIGFueDc2MjVfY2hpcF9jb250cm9sKHN0cnVjdCBhbng3NjI1
X2RhdGEgKmN0eCwgaW50IHN0YXRlKQoreworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNs
aWVudC0+ZGV2OworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiYmVmb3JlIHNldCwgcG93
ZXJfc3RhdGUoJWQpLlxuIiwKKwkJCSAgICAgYXRvbWljX3JlYWQoJmN0eC0+cG93ZXJfc3RhdHVz
KSk7CisJaWYgKGN0eC0+cGRhdGEubG93X3Bvd2VyX21vZGUpIHsKKwkJaWYgKHN0YXRlKSB7CisJ
CQlhdG9taWNfaW5jKCZjdHgtPnBvd2VyX3N0YXR1cyk7CisJCQlpZiAoYXRvbWljX3JlYWQoJmN0
eC0+cG93ZXJfc3RhdHVzKSA9PSAxKQorCQkJCWFueDc2MjVfcG93ZXJfb25faW5pdChjdHgpOwor
CQl9IGVsc2UgeworCQkJaWYgKGF0b21pY19yZWFkKCZjdHgtPnBvd2VyX3N0YXR1cykpIHsKKwkJ
CQlhdG9taWNfZGVjKCZjdHgtPnBvd2VyX3N0YXR1cyk7CisKKwkJCQlpZiAoYXRvbWljX3JlYWQo
JmN0eC0+cG93ZXJfc3RhdHVzKSA9PSAwKQorCQkJCQlhbng3NjI1X3Bvd2VyX3N0YW5kYnkoY3R4
KTsKKwkJCX0KKwkJfQorCX0KKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImFmdGVyIHNl
dCwgcG93ZXJfc3RhdGUoJWQpLlxuIiwKKwkJCSAgICAgYXRvbWljX3JlYWQoJmN0eC0+cG93ZXJf
c3RhdHVzKSk7Cit9CisKK3N0YXRpYyB2b2lkIGFueDc2MjVfZXh0Y29uX3dvcmsoc3RydWN0IHdv
cmtfc3RydWN0ICp3b3JrKQoreworCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCA9CisJCWNvbnRh
aW5lcl9vZih3b3JrLCBzdHJ1Y3QgYW54NzYyNV9kYXRhLCBleHRjb25fd3EpOworCWludCBzdGF0
ZSA9IGV4dGNvbl9nZXRfc3RhdGUoY3R4LT5leHRjb24sIEVYVENPTl9ESVNQX0RQKTsKKworCW11
dGV4X2xvY2soJmN0eC0+bG9jayk7CisJYW54NzYyNV9jaGlwX2NvbnRyb2woY3R4LCBzdGF0ZSk7
CisJbXV0ZXhfdW5sb2NrKCZjdHgtPmxvY2spOworfQorCitzdGF0aWMgaW50IGFueDc2MjVfZXh0
Y29uX25vdGlmaWVyX2luaXQoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCWludCByZXQ7
CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisKKwljdHgtPmV2ZW50
X25iLm5vdGlmaWVyX2NhbGwgPSBhbng3NjI1X2V4dGNvbl9ub3RpZmllcjsKKwlJTklUX1dPUkso
JmN0eC0+ZXh0Y29uX3dxLCBhbng3NjI1X2V4dGNvbl93b3JrKTsKKwlyZXQgPSBkZXZtX2V4dGNv
bl9yZWdpc3Rlcl9ub3RpZmllcigmY3R4LT5jbGllbnQtPmRldiwgY3R4LT5leHRjb24sCisJCQkJ
CSAgICBFWFRDT05fRElTUF9EUCwgJmN0eC0+ZXZlbnRfbmIpOworCWlmIChyZXQpIHsKKwkJRFJN
X0RFVl9FUlJPUihkZXYsICJmYWlsZWQgdG8gcmVnaXN0ZXIgbm90aWZpZXIgZm9yIERQIik7CisJ
CXJldHVybiByZXQ7CisJfQorCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBhbng3NjI1X2lu
aXRfZ3BpbyhzdHJ1Y3QgYW54NzYyNV9kYXRhICpwbGF0Zm9ybSkKK3sKKwlzdHJ1Y3QgZGV2aWNl
ICpkZXYgPSAmcGxhdGZvcm0tPmNsaWVudC0+ZGV2OworCisJRFJNX0RFVl9ERUJVR19EUklWRVIo
ZGV2LCAiYW54NzYyNSBpbml0IGdwaW9cbiIpOworCisJLyogZ3BpbyBmb3IgY2hpcCBwb3dlciBl
bmFibGUgKi8KKwlwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19wX29uID0KKwkJZGV2bV9ncGlvZF9nZXRf
b3B0aW9uYWwoZGV2LCAiZW5hYmxlIiwgR1BJT0RfT1VUX0xPVyk7CisJLyogZ3BpbyBmb3IgY2hp
cCByZXNldCAqLworCXBsYXRmb3JtLT5wZGF0YS5ncGlvX3Jlc2V0ID0KKwkJZGV2bV9ncGlvZF9n
ZXRfb3B0aW9uYWwoZGV2LCAicmVzZXQiLCBHUElPRF9PVVRfTE9XKTsKKworCWlmIChwbGF0Zm9y
bS0+cGRhdGEuZ3Bpb19wX29uICYmIHBsYXRmb3JtLT5wZGF0YS5ncGlvX3Jlc2V0KSB7CisJCXBs
YXRmb3JtLT5wZGF0YS5sb3dfcG93ZXJfbW9kZSA9IDE7CisJCURSTV9ERVZfREVCVUdfRFJJVkVS
KGRldiwgImxvdyBwb3dlciBtb2RlLCBwb24gJWQsIHJlc2V0ICVkLlxuIiwKKwkJCQkgICAgIGRl
c2NfdG9fZ3BpbyhwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19wX29uKSwKKwkJCQkgICAgIGRlc2NfdG9f
Z3BpbyhwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19yZXNldCkpOworCX0gZWxzZSB7CisJCXBsYXRmb3Jt
LT5wZGF0YS5sb3dfcG93ZXJfbW9kZSA9IDA7CisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwg
Im5vdCBsb3cgcG93ZXIgbW9kZS5cbiIpOworCX0KKworCXBsYXRmb3JtLT5wZGF0YS5ncGlvX2lu
dHJfaHBkID0KKwkJZGV2bV9ncGlvZF9nZXRfb3B0aW9uYWwoZGV2LCAiaHBkIiwgR1BJT0RfSU4p
OworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiaHBkIGdwaW8gJWQuXG4iLAorCQkJICAg
ICAoIXBsYXRmb3JtLT5wZGF0YS5ncGlvX2ludHJfaHBkKSA/IDAgOgorCQkJICAgICBkZXNjX3Rv
X2dwaW8ocGxhdGZvcm0tPnBkYXRhLmdwaW9faW50cl9ocGQpKTsKK30KKworc3RhdGljIHZvaWQg
YW54NzYyNV9zdG9wX2RwX3dvcmsoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCWN0eC0+
aHBkX3N0YXR1cyA9IDA7CisJY3R4LT5ocGRfaGlnaF9jbnQgPSAwOworCWN0eC0+ZGlzcGxheV90
aW1pbmdfdmFsaWQgPSAwOworCisJY3R4LT5zbGltcG9ydF9lZGlkX3AuZWRpZF9ibG9ja19udW0g
PSAtMTsKKworCWlmIChjdHgtPnBkYXRhLmxvd19wb3dlcl9tb2RlID09IDApCisJCWFueDc2MjVf
ZGlzYWJsZV9wZF9wcm90b2NvbChjdHgpOworfQorCitzdGF0aWMgdm9pZCBhbng3NjI1X3N0YXJ0
X2RwX3dvcmsoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4KQoreworCWludCByZXQ7CisJdTggYnVm
W01BWF9EUENEX0JVRkZFUl9TSVpFXTsKKwl1OCBoZGNwX2NhcDsKKwlzdHJ1Y3QgZGV2aWNlICpk
ZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKworCXU4IHNwX3R4X2J3OyAvKiBsaW5rdHJhaW5pbmcg
YmFud2lkdGggKi8KKwl1OCBzcF90eF9sYW5lX2NvdW50OyAvKiBsaW5rIHRyYWluaW5nIGxhbmUg
Y291bnQgKi8KKworCWlmIChjdHgtPmhwZF9oaWdoX2NudCA+PSAyKSB7CisJCURSTV9ERVZfREVC
VUdfRFJJVkVSKGRldiwgImFueDc2MjUgZmlsdGVyIHVzZWxlc3MgSFBEXG4iKTsKKwkJcmV0dXJu
OworCX0KKworCWN0eC0+aHBkX2hpZ2hfY250Kys7CisKKwlzcF90eF9nZXRfcnhfYncoY3R4LCAm
c3BfdHhfYncpOworCisJc3BfdHhfYXV4X2RwY2RyZWFkX2J5dGVzKGN0eCwgMHgwMCwgMHgwMCwg
RFBDRF9NQVhfTEFORV9DT1VOVCwKKwkJCQkgMSwgJnNwX3R4X2xhbmVfY291bnQpOworCisJc3Bf
dHhfbGFuZV9jb3VudCA9IHNwX3R4X2xhbmVfY291bnQgJiAweDFmOworCXNwX3R4X2F1eF9kcGNk
cmVhZF9ieXRlcyhjdHgsIDB4MDYsIDB4ODAsIDB4MjgsIDEsIGJ1Zik7LyogcmVhZCBCY2FwICov
CisKKwloZGNwX2NhcCA9IGJ1ZlswXSAmIDB4MDE7CisKKwkvKiBub3Qgc3VwcG9ydCBIRENQICov
CisJcmV0ID0gYW54NzYyNV93cml0ZV9hbmQoY3R4LCBjdHgtPmkyYy5yeF9wMV9jbGllbnQsIDB4
ZWUsIDB4OWYpOworCisJaWYgKGhkY3BfY2FwID09IDB4MDEpCisJCURSTV9ERVZfREVCVUdfRFJJ
VkVSKGRldiwgIkhEQ1AxLjRcbiIpOworCisJLyogdHJ5IGF1dGggZmxhZyAqLworCXJldCB8PSBh
bng3NjI1X3dyaXRlX29yKGN0eCwgY3R4LT5pMmMucnhfcDFfY2xpZW50LCAweGVjLCAweDEwKTsK
KwkvKiBpbnRlcnJ1cHQgZm9yIERSTSAqLworCXJldCB8PSBhbng3NjI1X3dyaXRlX29yKGN0eCwg
Y3R4LT5pMmMucnhfcDFfY2xpZW50LCAweGZmLCAweDAxKTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0
dXJuOworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIk1BWCBCVz0lMDJ4LCBNQVggTGFuZSBj
bnQ9JTAyeCwgSERDUD0lMDJ4XG4iLAorCQkJICAgICAodTMyKXNwX3R4X2J3LAorCQkJICAgICAo
dTMyKXNwX3R4X2xhbmVfY291bnQsCisJCQkgICAgICh1MzIpaGRjcF9jYXApOworCisJcmV0ID0g
YW54NzYyNV9yZWdfcmVhZChjdHgsIGN0eC0+aTJjLnJ4X3AxX2NsaWVudCwgMHg4Nik7CisJaWYg
KHJldCA8IDApCisJCXJldHVybjsKKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIlNlY3Vy
ZSBPQ00gdmVyc2lvbj0lMDJ4XG4iLCByZXQpOworfQorCitzdGF0aWMgaW50IGFueDc2MjVfcmVh
ZF9ocGRfc3RhdHVzX3AwKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sKKwlyZXR1cm4gYW54
NzYyNV9yZWdfcmVhZChjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwgU1lTVEVNX1NUU1RVUyk7
Cit9CisKK3N0YXRpYyB2b2lkIGFueDc2MjVfaHBkX3BvbGxpbmcoc3RydWN0IGFueDc2MjVfZGF0
YSAqY3R4KQoreworCWludCByZXQsIHZhbDsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5j
bGllbnQtPmRldjsKKworCWlmIChhdG9taWNfcmVhZCgmY3R4LT5wb3dlcl9zdGF0dXMpICE9IDEp
IHsKKwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiTm8gbmVlZCB0byBwb2xpbmcgSFBEIHN0
YXR1cy5cbiIpOworCQlyZXR1cm47CisJfQorCisJcmV0ID0gcmVhZHhfcG9sbF90aW1lb3V0KGFu
eDc2MjVfcmVhZF9ocGRfc3RhdHVzX3AwLAorCQkJCSBjdHgsIHZhbCwKKwkJCQkgKCh2YWwgJiBI
UERfU1RBVFVTKSB8fCAodmFsIDwgMCkpLAorCQkJCSA1MDAwLAorCQkJCSA1MDAwICogMTAwKTsK
KwlpZiAocmV0KSB7CisJCURSTV9ERVZfRVJST1IoZGV2LCAiSFBEIHBvbGxpbmcgdGltZW91dCFc
biIpOworCX0gZWxzZSB7CisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIkhQRCByYWlzZSB1
cC5cbiIpOworCQlhbng3NjI1X3JlZ193cml0ZShjdHgsIGN0eC0+aTJjLnRjcGNfY2xpZW50LAor
CQkJCSAgSU5UUl9BTEVSVF8xLCAweEZGKTsKKwkJYW54NzYyNV9yZWdfd3JpdGUoY3R4LCBjdHgt
PmkyYy5yeF9wMF9jbGllbnQsCisJCQkJICBJTlRFUkZBQ0VfQ0hBTkdFX0lOVCwgMCk7CisJfQor
CisJYW54NzYyNV9zdGFydF9kcF93b3JrKGN0eCk7Cit9CisKK3N0YXRpYyB2b2lkIGFueDc2MjVf
ZGlzY29ubmVjdF9jaGVjayhzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJaWYgKGF0b21p
Y19yZWFkKCZjdHgtPnBvd2VyX3N0YXR1cykgPT0gMCkKKwkJYW54NzYyNV9zdG9wX2RwX3dvcmso
Y3R4KTsKK30KKworc3RhdGljIHZvaWQgYW54NzYyNV9sb3dfcG93ZXJfbW9kZV9jaGVjayhzdHJ1
Y3QgYW54NzYyNV9kYXRhICpjdHgsCisJCQkJCSBpbnQgc3RhdGUpCit7CisJc3RydWN0IGRldmlj
ZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYs
ICJsb3cgcG93ZXIgbW9kZSBjaGVjaywgc3RhdGUoJWQpLlxuIiwgc3RhdGUpOworCisJaWYgKGN0
eC0+cGRhdGEubG93X3Bvd2VyX21vZGUpIHsKKwkJYW54NzYyNV9jaGlwX2NvbnRyb2woY3R4LCBz
dGF0ZSk7CisJCWlmIChzdGF0ZSkKKwkJCWFueDc2MjVfaHBkX3BvbGxpbmcoY3R4KTsKKwkJZWxz
ZQorCQkJYW54NzYyNV9kaXNjb25uZWN0X2NoZWNrKGN0eCk7CisJfQorfQorCitzdGF0aWMgdm9p
ZCBkcF9ocGRfY2hhbmdlX2hhbmRsZXIoc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4LCBib29sIG9u
KQoreworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2OworCisJLyogaHBk
IGNoYW5nZWQgKi8KKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJkcF9ocGRfY2hhbmdlX2Rl
ZmF1bHRfZnVuYzogJWRcbiIsCisJCQkgICAgICh1MzIpb24pOworCisJaWYgKG9uID09IDApIHsK
KwkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiIEhQRCBsb3dcbiIpOworCQlhbng3NjI1X3N0
b3BfZHBfd29yayhjdHgpOworCX0gZWxzZSB7CisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwg
IiBIUEQgaGlnaFxuIik7CisJCWFueDc2MjVfc3RhcnRfZHBfd29yayhjdHgpOworCX0KKworCWN0
eC0+aHBkX3N0YXR1cyA9IDE7Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV9ocGRfY2hhbmdlX2Rl
dGVjdChzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJaW50IGludHJfdmVjdG9yLCBzdGF0
dXM7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisKKwlEUk1fREVW
X0RFQlVHX0RSSVZFUihkZXYsICJwb3dlcl9zdGF0dXM9JWRcbiIsCisJCQkgICAgICh1MzIpYXRv
bWljX3JlYWQoJmN0eC0+cG93ZXJfc3RhdHVzKSk7CisKKwlzdGF0dXMgPSBhbng3NjI1X3JlZ193
cml0ZShjdHgsIGN0eC0+aTJjLnRjcGNfY2xpZW50LAorCQkJCSAgIElOVFJfQUxFUlRfMSwgMHhG
Rik7CisJaWYgKHN0YXR1cyA8IDApIHsKKwkJRFJNX0VSUk9SKCJJTyBlcnJvciA6IGNsZWFyIGFs
ZXJ0IHJlZ2lzdGVyLlxuIik7CisJCXJldHVybiBzdGF0dXM7CisJfQorCisJaW50cl92ZWN0b3Ig
PSBhbng3NjI1X3JlZ19yZWFkKGN0eCwgY3R4LT5pMmMucnhfcDBfY2xpZW50LAorCQkJCSAgICAg
ICBJTlRFUkZBQ0VfQ0hBTkdFX0lOVCk7CisJaWYgKGludHJfdmVjdG9yIDwgMCkgeworCQlEUk1f
RVJST1IoIklPIGVycm9yIDogYWNjZXNzIGludGVycnVwdCBjaGFuZ2UgcmVnaXN0ZXIuXG4iKTsK
KwkJcmV0dXJuIGludHJfdmVjdG9yOworCX0KKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICIw
eDdlOjB4NDQ9JXhcbiIsIGludHJfdmVjdG9yKTsKKwlzdGF0dXMgPSBhbng3NjI1X3JlZ193cml0
ZShjdHgsIGN0eC0+aTJjLnJ4X3AwX2NsaWVudCwKKwkJCQkgICBJTlRFUkZBQ0VfQ0hBTkdFX0lO
VCwKKwkJCQkgICBpbnRyX3ZlY3RvciAmICh+aW50cl92ZWN0b3IpKTsKKwlpZiAoc3RhdHVzIDwg
MCkgeworCQlEUk1fRVJST1IoIklPIGVycm9yIDogY2xlYXIgaW50ZXJydXB0IGNoYW5nZSByZWdp
c3Rlci5cbiIpOworCQlyZXR1cm4gc3RhdHVzOworCX0KKworCWlmIChpbnRyX3ZlY3RvciAmIEhQ
RF9TVEFUVVNfQ0hBTkdFKSB7CisJCXN0YXR1cyA9IGFueDc2MjVfcmVnX3JlYWQoY3R4LCBjdHgt
PmkyYy5yeF9wMF9jbGllbnQsCisJCQkJCSAgU1lTVEVNX1NUU1RVUyk7CisJCWlmIChzdGF0dXMg
PCAwKSB7CisJCQlEUk1fRVJST1IoIklPIGVycm9yIDogY2xlYXIgaW50ZXJydXB0IHN0YXR1cy5c
biIpOworCQkJcmV0dXJuIHN0YXR1czsKKwkJfQorCisJCURSTV9ERVZfREVCVUdfRFJJVkVSKGRl
diwgIjB4N2U6MHg0NT0leFxuIiwgc3RhdHVzKTsKKwkJZHBfaHBkX2NoYW5nZV9oYW5kbGVyKGN0
eCwgc3RhdHVzICYgSFBEX1NUQVRVUyk7CisJCXJldHVybiAwOworCX0KKworCXJldHVybiAtRU5P
RU5UOworfQorCitzdGF0aWMgdm9pZCBhbng3NjI1X3dvcmtfZnVuYyhzdHJ1Y3Qgd29ya19zdHJ1
Y3QgKndvcmspCit7CisJaW50IGV2ZW50OworCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCA9IGNv
bnRhaW5lcl9vZih3b3JrLAorCQkJCQkJc3RydWN0IGFueDc2MjVfZGF0YSwgd29yayk7CisKKwlt
dXRleF9sb2NrKCZjdHgtPmxvY2spOworCWV2ZW50ID0gYW54NzYyNV9ocGRfY2hhbmdlX2RldGVj
dChjdHgpOworCW11dGV4X3VubG9jaygmY3R4LT5sb2NrKTsKKworCWlmIChldmVudCA8IDApCisJ
CXJldHVybjsKKworCWlmIChjdHgtPmJyaWRnZV9hdHRhY2hlZCkKKwkJZHJtX2hlbHBlcl9ocGRf
aXJxX2V2ZW50KGN0eC0+Y29ubmVjdG9yLmRldik7Cit9CisKK3N0YXRpYyBpcnFyZXR1cm5fdCBh
bng3NjI1X2ludHJfaHBkX2lzcihpbnQgaXJxLCB2b2lkICpkYXRhKQoreworCXN0cnVjdCBhbng3
NjI1X2RhdGEgKmN0eCA9IChzdHJ1Y3QgYW54NzYyNV9kYXRhICopZGF0YTsKKworCWlmIChhdG9t
aWNfcmVhZCgmY3R4LT5wb3dlcl9zdGF0dXMpICE9IDEpCisJCXJldHVybiBJUlFfTk9ORTsKKwor
CXF1ZXVlX3dvcmsoY3R4LT53b3JrcXVldWUsICZjdHgtPndvcmspOworCisJcmV0dXJuIElSUV9I
QU5ETEVEOworfQorCisjaWZkZWYgQ09ORklHX09GCitzdGF0aWMgaW50IGFueDc2MjVfcGFyc2Vf
ZHQoc3RydWN0IGRldmljZSAqZGV2LAorCQkJICAgIHN0cnVjdCBhbng3NjI1X3BsYXRmb3JtX2Rh
dGEgKnBkYXRhKQoreworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqbnAgPSBkZXYtPm9mX25vZGU7CisJ
c3RydWN0IGRldmljZV9ub2RlICptaXBpX2hvc3Rfbm9kZTsKKwlzdHJ1Y3QgZGV2aWNlX25vZGUg
KnBhbmVsX25vZGUsICpvdXRfZXA7CisKKwlwZGF0YS0+bm9kZS5taXBpX2RzaV9ob3N0X25vZGUg
PSBvZl9ncmFwaF9nZXRfcmVtb3RlX25vZGUobnAsIDAsIDApOworCWlmIChwZGF0YS0+bm9kZS5t
aXBpX2RzaV9ob3N0X25vZGUpIHsKKwkJb2Zfbm9kZV9wdXQocGRhdGEtPm5vZGUubWlwaV9kc2lf
aG9zdF9ub2RlKTsKKwkJcGRhdGEtPmRzaV9zdXBwb3J0ZWQgPSAxOworCQltaXBpX2hvc3Rfbm9k
ZSA9IHBkYXRhLT5ub2RlLm1pcGlfZHNpX2hvc3Rfbm9kZTsKKwl9IGVsc2UgeworCQlwZGF0YS0+
bm9kZS5taXBpX2RwaV9ob3N0X25vZGUgPQorCQkJb2ZfZ3JhcGhfZ2V0X3JlbW90ZV9ub2RlKG5w
LCAxLCAwKTsKKwkJaWYgKCFwZGF0YS0+bm9kZS5taXBpX2RwaV9ob3N0X25vZGUpCisJCQlEUk1f
RVJST1IoImNhbm5vdCByZXNvbHZlIGFueSBNSVBJIGhvc3Qgbm9kZS5cbiIpOworCQllbHNlCisJ
CQlvZl9ub2RlX3B1dChwZGF0YS0+bm9kZS5taXBpX2RwaV9ob3N0X25vZGUpOworCisJCW1pcGlf
aG9zdF9ub2RlID0gcGRhdGEtPm5vZGUubWlwaV9kcGlfaG9zdF9ub2RlOworCX0KKworCURSTV9E
RVZfREVCVUdfRFJJVkVSKGRldiwgImRzaV9zdXBwb3J0ZWQgOiAlZFxuIiwgcGRhdGEtPmRzaV9z
dXBwb3J0ZWQpOworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIm1pcGkgaG9zdCBub2RlICVz
IGV4aXN0XG4iLAorCQkJICAgICAoIW1pcGlfaG9zdF9ub2RlKSA/ICJub3QiIDogIiAiKTsKKwor
CXBkYXRhLT5ub2RlLmV4dGNvbl9ub2RlID0gb2ZfZ3JhcGhfZ2V0X3BvcnRfYnlfaWQobnAsIDIp
OworCXBkYXRhLT5ub2RlLmludGVybmFsX3BhbmVsX25vZGUgPSBvZl9ncmFwaF9nZXRfcG9ydF9i
eV9pZChucCwgMyk7CisJcGRhdGEtPm5vZGUuZWRwX25vZGUgPSBvZl9ncmFwaF9nZXRfcG9ydF9i
eV9pZChucCwgNCk7CisJaWYgKHBkYXRhLT5ub2RlLmV4dGNvbl9ub2RlKQorCQlwZGF0YS0+ZXh0
Y29uX3N1cHBvcnRlZCA9IDE7CisKKwlpZiAocGRhdGEtPm5vZGUuaW50ZXJuYWxfcGFuZWxfbm9k
ZSkgeworCQlwZGF0YS0+aW50ZXJuYWxfcGFuZWwgPSAxOworCQlvZl9ub2RlX3B1dChwZGF0YS0+
bm9kZS5pbnRlcm5hbF9wYW5lbF9ub2RlKTsKKwkJb3V0X2VwID0gb2ZfZ2V0X2NoaWxkX2J5X25h
bWUocGRhdGEtPm5vZGUuaW50ZXJuYWxfcGFuZWxfbm9kZSwKKwkJCQkJICAgICAgImVuZHBvaW50
Iik7CisJCWlmIChvdXRfZXApIHsKKwkJCXBhbmVsX25vZGUgPSBvZl9ncmFwaF9nZXRfcmVtb3Rl
X3BvcnRfcGFyZW50KG91dF9lcCk7CisJCQlvZl9ub2RlX3B1dChvdXRfZXApOworCisJCQlwZGF0
YS0+cGFuZWwgPSBvZl9kcm1fZmluZF9wYW5lbChwYW5lbF9ub2RlKTsKKwkJCURSTV9ERVZfREVC
VUdfRFJJVkVSKGRldiwgImdldCBwYW5lbCBub2RlLlxuIik7CisJCQlvZl9ub2RlX3B1dChwYW5l
bF9ub2RlKTsKKwkJCWlmIChJU19FUlJfT1JfTlVMTChwZGF0YS0+cGFuZWwpKQorCQkJCXJldHVy
biAtRVBST0JFX0RFRkVSOworCQl9IGVsc2UgeworCQkJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2
LCAiY2Fubm90IGdldCBlbmRwb2ludC5cbiIpOworCQkJcmV0dXJuIC1FUFJPQkVfREVGRVI7CisJ
CX0KKwl9CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICIlcyBzdXBwb3J0IGV4dGNvbiwg
JXMgaW50ZXJuYWwgcGFuZWxcbiIsCisJCQkgICAgIHBkYXRhLT5leHRjb25fc3VwcG9ydGVkID8g
IiIgOiAibm90IiwKKwkJCSAgICAgcGRhdGEtPmludGVybmFsX3BhbmVsID8gImhhcyIgOiAibm8i
KTsKKworCXJldHVybiAwOworfQorI2Vsc2UKK3N0YXRpYyBpbnQgYW54NzYyNV9wYXJzZV9kdChz
dHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkgICAgc3RydWN0IGFueDc2MjVfcGxhdGZvcm1fZGF0YSAq
cGRhdGEpCit7CisJcmV0dXJuIC1FTk9ERVY7Cit9CisjZW5kaWYKKworc3RhdGljIGlubGluZSBz
dHJ1Y3QgYW54NzYyNV9kYXRhICpjb25uZWN0b3JfdG9fYW54NzYyNShzdHJ1Y3QgZHJtX2Nvbm5l
Y3RvciAqYykKK3sKKwlyZXR1cm4gY29udGFpbmVyX29mKGMsIHN0cnVjdCBhbng3NjI1X2RhdGEs
IGNvbm5lY3Rvcik7Cit9CisKK3N0YXRpYyBpbmxpbmUgc3RydWN0IGFueDc2MjVfZGF0YSAqYnJp
ZGdlX3RvX2FueDc2MjUoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSkKK3sKKwlyZXR1cm4gY29u
dGFpbmVyX29mKGJyaWRnZSwgc3RydWN0IGFueDc2MjVfZGF0YSwgYnJpZGdlKTsKK30KKworc3Rh
dGljIHZvaWQgYW54NzYyNV9wb3N0X2Rpc2FibGUoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSkK
K3sKKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHggPSBicmlkZ2VfdG9fYW54NzYyNShicmlkZ2Up
OworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2OworCWludCByZXQ7CisK
KwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJwb3N0IGRpc2FibGVcbiIpOworCWlmIChjdHgt
PnBkYXRhLnBhbmVsKSB7CisJCXJldCA9IGRybV9wYW5lbF91bnByZXBhcmUoY3R4LT5wZGF0YS5w
YW5lbCk7CisJCWlmIChyZXQpCisJCQlEUk1fRVJST1IoImZhaWxlZCB0byB1bnByZXBhcmUgcGFu
ZWw6ICVkXG4iLCByZXQpOworCQllbHNlCisJCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJi
YWNrbGlnaHQgdW5wcmVwYXJlZC5cbiIpOworCisJCWF0b21pY19zZXQoJmN0eC0+cGFuZWxfcG93
ZXIsIDApOworCX0KK30KKworc3RhdGljIHZvaWQgYW54NzYyNV9wcmVfZW5hYmxlKHN0cnVjdCBk
cm1fYnJpZGdlICpicmlkZ2UpCit7CisJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0gYnJpZGdl
X3RvX2FueDc2MjUoYnJpZGdlKTsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQt
PmRldjsKKwlpbnQgcmV0OworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAicHJlIGVuYWJs
ZVxuIik7CisJaWYgKGN0eC0+cGRhdGEucGFuZWwpIHsKKwkJcmV0ID0gZHJtX3BhbmVsX3ByZXBh
cmUoY3R4LT5wZGF0YS5wYW5lbCk7CisJCWlmIChyZXQgPCAwKQorCQkJRFJNX0VSUk9SKCJmYWls
ZWQgdG8gcHJlcGFyZSBwYW5lbDogJWRcbiIsIHJldCk7CisJCWVsc2UKKwkJCURSTV9ERVZfREVC
VUdfRFJJVkVSKGRldiwgImJhY2tsaWdodCBwcmVwYXJlZC5cbiIpOworCQlhdG9taWNfc2V0KCZj
dHgtPnBhbmVsX3Bvd2VyLCAxKTsKKwl9Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV9nZXRfbW9k
ZXMoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKK3sKKwlzdHJ1Y3QgYW54NzYyNV9k
YXRhICpjdHggPSBjb25uZWN0b3JfdG9fYW54NzYyNShjb25uZWN0b3IpOworCWludCBlcnIsIG51
bV9tb2RlcyA9IDA7CisJaW50IHR1cm5fb2ZmX2ZsYWcgPSAwOworCXN0cnVjdCBzX2VkaWRfZGF0
YSAqcF9lZGlkID0gJmN0eC0+c2xpbXBvcnRfZWRpZF9wOworCXN0cnVjdCBkZXZpY2UgKmRldiA9
ICZjdHgtPmNsaWVudC0+ZGV2OworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZHJtIGdl
dCBtb2Rlc1xuIik7CisKKwlpZiAoY3R4LT5zbGltcG9ydF9lZGlkX3AuZWRpZF9ibG9ja19udW0g
PiAwKQorCQlnb3RvIG91dDsKKworCW11dGV4X2xvY2soJmN0eC0+bG9jayk7CisKKwlpZiAoY3R4
LT5wZGF0YS5wYW5lbCAmJiBhdG9taWNfcmVhZCgmY3R4LT5wYW5lbF9wb3dlcikgPT0gMCkgewor
CQl0dXJuX29mZl9mbGFnID0gMTsKKwkJYW54NzYyNV9wcmVfZW5hYmxlKCZjdHgtPmJyaWRnZSk7
CisJfQorCisJYW54NzYyNV9sb3dfcG93ZXJfbW9kZV9jaGVjayhjdHgsIDEpOworCisJcF9lZGlk
LT5lZGlkX2Jsb2NrX251bSA9IHNwX3R4X2VkaWRfcmVhZChjdHgsIHBfZWRpZC0+ZWRpZF9yYXdf
ZGF0YSk7CisKKwllcnIgPSAtRUlPOworCWlmIChwX2VkaWQtPmVkaWRfYmxvY2tfbnVtIDwgMCkg
eworCQlEUk1fRVJST1IoIkZhaWxlZCB0byByZWFkIEVESUQuXG4iKTsKKwkJZ290byBmYWlsOwor
CX0KKworCWVyciA9IGRybV9jb25uZWN0b3JfdXBkYXRlX2VkaWRfcHJvcGVydHkoY29ubmVjdG9y
LAorCQkJCQkJIChzdHJ1Y3QgZWRpZCAqKQorCQkJCQkJICZwX2VkaWQtPmVkaWRfcmF3X2RhdGEp
OworCisJaWYgKGVycikKKwkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gdXBkYXRlIEVESUQgcHJvcGVy
dHk6ICVkXG4iLCBlcnIpOworCitmYWlsOgorCW11dGV4X3VubG9jaygmY3R4LT5sb2NrKTsKKwlh
bng3NjI1X2xvd19wb3dlcl9tb2RlX2NoZWNrKGN0eCwgMCk7CisJaWYgKGN0eC0+cGRhdGEucGFu
ZWwgJiYgdHVybl9vZmZfZmxhZyA9PSAxKQorCQlhbng3NjI1X3Bvc3RfZGlzYWJsZSgmY3R4LT5i
cmlkZ2UpOworCisJaWYgKGVycikKKwkJcmV0dXJuIGVycjsKKworb3V0OgorCW51bV9tb2RlcyA9
IGRybV9hZGRfZWRpZF9tb2Rlcyhjb25uZWN0b3IsCisJCQkJICAgICAgIChzdHJ1Y3QgZWRpZCAq
KSZwX2VkaWQtPmVkaWRfcmF3X2RhdGEpOworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgIm51
bV9tb2RlcyglZClcbiIsIG51bV9tb2Rlcyk7CisKKwlyZXR1cm4gbnVtX21vZGVzOworfQorCitz
dGF0aWMgZW51bSBkcm1fbW9kZV9zdGF0dXMKK2FueDc2MjVfY29ubmVjdG9yX21vZGVfdmFsaWQo
c3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKKwkJCSAgICAgc3RydWN0IGRybV9kaXNw
bGF5X21vZGUgKm1vZGUpCit7CisJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0gY29ubmVjdG9y
X3RvX2FueDc2MjUoY29ubmVjdG9yKTsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGll
bnQtPmRldjsKKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRybSBtb2RlcyB2YWxpZCB2
ZXJpZnlcbiIpOworCisJaWYgKG1vZGUtPmNsb2NrID4gMzAwMDAwKQorCQlyZXR1cm4gTU9ERV9D
TE9DS19ISUdIOworCisJcmV0dXJuIE1PREVfT0s7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgZHJtX2Nv
bm5lY3Rvcl9oZWxwZXJfZnVuY3MgYW54NzYyNV9jb25uZWN0b3JfaGVscGVyX2Z1bmNzID0gewor
CS5nZXRfbW9kZXMgPSBhbng3NjI1X2dldF9tb2RlcywKKwkubW9kZV92YWxpZCA9IGFueDc2MjVf
Y29ubmVjdG9yX21vZGVfdmFsaWQsCit9OworCitzdGF0aWMgZW51bSBkcm1fY29ubmVjdG9yX3N0
YXR1cyBhbng3NjI1X2RldGVjdChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAorCQkJ
CQkJYm9vbCBmb3JjZSkKK3sKKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHggPSBjb25uZWN0b3Jf
dG9fYW54NzYyNShjb25uZWN0b3IpOworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVu
dC0+ZGV2OworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZHJtIGRldGVjdFxuIik7CisK
KwlpZiAoY3R4LT5wZGF0YS5pbnRlcm5hbF9wYW5lbCkKKwkJcmV0dXJuIGNvbm5lY3Rvcl9zdGF0
dXNfY29ubmVjdGVkOworCisJaWYgKCFjdHgtPmhwZF9zdGF0dXMpCisJCXJldHVybiBjb25uZWN0
b3Jfc3RhdHVzX2Rpc2Nvbm5lY3RlZDsKKworCXJldHVybiBjb25uZWN0b3Jfc3RhdHVzX2Nvbm5l
Y3RlZDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX2Z1bmNzIGFueDc2
MjVfY29ubmVjdG9yX2Z1bmNzID0geworCS5maWxsX21vZGVzID0gZHJtX2hlbHBlcl9wcm9iZV9z
aW5nbGVfY29ubmVjdG9yX21vZGVzLAorCS5kZXRlY3QgPSBhbng3NjI1X2RldGVjdCwKKwkuZGVz
dHJveSA9IGRybV9jb25uZWN0b3JfY2xlYW51cCwKKwkucmVzZXQgPSBkcm1fYXRvbWljX2hlbHBl
cl9jb25uZWN0b3JfcmVzZXQsCisJLmF0b21pY19kdXBsaWNhdGVfc3RhdGUgPSBkcm1fYXRvbWlj
X2hlbHBlcl9jb25uZWN0b3JfZHVwbGljYXRlX3N0YXRlLAorCS5hdG9taWNfZGVzdHJveV9zdGF0
ZSA9IGRybV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9kZXN0cm95X3N0YXRlLAorfTsKKworc3Rh
dGljIHZvaWQgYW54NzYyNV9hdHRhY2hfZHNpKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCkKK3sK
KwlzdHJ1Y3QgbWlwaV9kc2lfaG9zdCAqaG9zdDsKKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpk
c2k7CisJc3RydWN0IGRldmljZV9ub2RlICptaXBpX2hvc3Rfbm9kZTsKKwlzdHJ1Y3QgZGV2aWNl
ICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKwljb25zdCBzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNl
X2luZm8gaW5mbyA9IHsKKwkJLnR5cGUgPSAiYW54NzYyNSIsCisJCS5jaGFubmVsID0gMCwKKwkJ
Lm5vZGUgPSBOVUxMLAorCX07CisKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJhdHRhY2gg
ZHNpXG4iKTsKKworCWlmIChjdHgtPnBkYXRhLmRzaV9zdXBwb3J0ZWQpCisJCW1pcGlfaG9zdF9u
b2RlID0gY3R4LT5wZGF0YS5ub2RlLm1pcGlfZHNpX2hvc3Rfbm9kZTsKKwllbHNlCisJCW1pcGlf
aG9zdF9ub2RlID0gY3R4LT5wZGF0YS5ub2RlLm1pcGlfZHBpX2hvc3Rfbm9kZTsKKworCWlmICgh
bWlwaV9ob3N0X25vZGUpIHsKKwkJRFJNX0VSUk9SKCJkc2kgaG9zdCBpcyBub3QgY29uZmlndXJl
ZC5cbiIpOworCQlyZXR1cm47CisJfQorCisJaG9zdCA9IG9mX2ZpbmRfbWlwaV9kc2lfaG9zdF9i
eV9ub2RlKG1pcGlfaG9zdF9ub2RlKTsKKwlpZiAoIWhvc3QpIHsKKwkJRFJNX0VSUk9SKCJmYWls
ZWQgdG8gZmluZCBkc2kgaG9zdC5cbiIpOworCQlyZXR1cm47CisJfQorCisJZHNpID0gbWlwaV9k
c2lfZGV2aWNlX3JlZ2lzdGVyX2Z1bGwoaG9zdCwgJmluZm8pOworCWlmIChJU19FUlIoZHNpKSkg
eworCQlEUk1fRVJST1IoImZhaWxlZCB0byBjcmVhdGUgZHNpIGRldmljZS5cbiIpOworCQlyZXR1
cm47CisJfQorCisJZHNpLT5sYW5lcyA9IDQ7CisJZHNpLT5mb3JtYXQgPSBNSVBJX0RTSV9GTVRf
UkdCODg4OworCWRzaS0+bW9kZV9mbGFncyA9IE1JUElfRFNJX01PREVfVklERU8JfAorCQlNSVBJ
X0RTSV9NT0RFX1ZJREVPX1NZTkNfUFVMU0UJfAorCQlNSVBJX0RTSV9NT0RFX0VPVF9QQUNLRVQJ
fAorCQlNSVBJX0RTSV9NT0RFX1ZJREVPX0hTRTsKKworCWlmIChtaXBpX2RzaV9hdHRhY2goZHNp
KSA8IDApIHsKKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gYXR0YWNoIGRzaSB0byBob3N0LlxuIik7
CisJCW1pcGlfZHNpX2RldmljZV91bnJlZ2lzdGVyKGRzaSk7CisJCXJldHVybjsKKwl9CisKKwlj
dHgtPmRzaSA9IGRzaTsKKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImF0dGFjaCBkc2kg
c3VjY2VlZGVkLlxuIik7Cit9CisKK3N0YXRpYyB2b2lkIGFueDc2MjVfZGV0YWNoX2RzaShzdHJ1
Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJaWYgKGN0eC0+ZHNpKSB7CisJCW1pcGlfZHNpX2Rl
dGFjaChjdHgtPmRzaSk7CisJCW1pcGlfZHNpX2RldmljZV91bnJlZ2lzdGVyKGN0eC0+ZHNpKTsK
Kwl9Cit9CisKK3N0YXRpYyBpbnQgYW54NzYyNV9icmlkZ2VfYXR0YWNoKHN0cnVjdCBkcm1fYnJp
ZGdlICpicmlkZ2UpCit7CisJc3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0gYnJpZGdlX3RvX2Fu
eDc2MjUoYnJpZGdlKTsKKwlpbnQgZXJyOworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNs
aWVudC0+ZGV2OworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZHJtIGF0dGFjaFxuIik7
CisJaWYgKCFicmlkZ2UtPmVuY29kZXIpIHsKKwkJRFJNX0VSUk9SKCJQYXJlbnQgZW5jb2RlciBv
YmplY3Qgbm90IGZvdW5kIik7CisJCXJldHVybiAtRU5PREVWOworCX0KKworCWVyciA9IGRybV9j
b25uZWN0b3JfaW5pdChicmlkZ2UtPmRldiwgJmN0eC0+Y29ubmVjdG9yLAorCQkJCSAmYW54NzYy
NV9jb25uZWN0b3JfZnVuY3MsCisJCQkJIERSTV9NT0RFX0NPTk5FQ1RPUl9EaXNwbGF5UG9ydCk7
CisJaWYgKGVycikgeworCQlEUk1fRVJST1IoIkZhaWxlZCB0byBpbml0aWFsaXplIGNvbm5lY3Rv
cjogJWRcbiIsIGVycik7CisJCXJldHVybiBlcnI7CisJfQorCisJZHJtX2Nvbm5lY3Rvcl9oZWxw
ZXJfYWRkKCZjdHgtPmNvbm5lY3RvciwKKwkJCQkgJmFueDc2MjVfY29ubmVjdG9yX2hlbHBlcl9m
dW5jcyk7CisKKwllcnIgPSBkcm1fY29ubmVjdG9yX3JlZ2lzdGVyKCZjdHgtPmNvbm5lY3Rvcik7
CisJaWYgKGVycikgeworCQlEUk1fRVJST1IoIkZhaWxlZCB0byByZWdpc3RlciBjb25uZWN0b3I6
ICVkXG4iLCBlcnIpOworCQlyZXR1cm4gZXJyOworCX0KKworCWN0eC0+Y29ubmVjdG9yLnBvbGxl
ZCA9IERSTV9DT05ORUNUT1JfUE9MTF9IUEQ7CisKKwllcnIgPSBkcm1fY29ubmVjdG9yX2F0dGFj
aF9lbmNvZGVyKCZjdHgtPmNvbm5lY3RvciwgYnJpZGdlLT5lbmNvZGVyKTsKKwlpZiAoZXJyKSB7
CisJCURSTV9FUlJPUigiRmFpbGVkIHRvIGxpbmsgdXAgY29ubmVjdG9yIHRvIGVuY29kZXI6ICVk
XG4iLCBlcnIpOworCQlkcm1fY29ubmVjdG9yX3VucmVnaXN0ZXIoJmN0eC0+Y29ubmVjdG9yKTsK
KwkJcmV0dXJuIGVycjsKKwl9CisKKwlhbng3NjI1X2F0dGFjaF9kc2koY3R4KTsKKworCWN0eC0+
YnJpZGdlX2F0dGFjaGVkID0gMTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgZW51bSBkcm1f
bW9kZV9zdGF0dXMKK2FueDc2MjVfYnJpZGdlX21vZGVfdmFsaWQoc3RydWN0IGRybV9icmlkZ2Ug
KmJyaWRnZSwKKwkJCSAgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUpCit7CisJ
c3RydWN0IGFueDc2MjVfZGF0YSAqY3R4ID0gYnJpZGdlX3RvX2FueDc2MjUoYnJpZGdlKTsKKwlz
dHJ1Y3QgZGV2aWNlICpkZXYgPSAmY3R4LT5jbGllbnQtPmRldjsKKworCURSTV9ERVZfREVCVUdf
RFJJVkVSKGRldiwgImRybSBtb2RlIGNoZWNraW5nXG4iKTsKKworCS8qIE1heCAxMjAwcCBhdCA1
LjQgR2h6LCBvbmUgbGFuZSwgcGl4ZWwgY2xvY2sgMzAwTSAqLworCWlmIChtb2RlLT5jbG9jayA+
IDMwMDAwMCkgeworCQlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsCisJCQkJICAgICAiZHJtIG1v
ZGUgaW52YWxpZCwgcGl4ZWxjbG9jayB0b28gaGlnaC5cbiIpOworCQlyZXR1cm4gTU9ERV9DTE9D
S19ISUdIOworCX0KKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRybSBtb2RlIHZhbGlk
LlxuIik7CisKKwlyZXR1cm4gTU9ERV9PSzsKK30KKworc3RhdGljIHZvaWQgYW54NzYyNV9icmlk
Z2VfbW9kZV9zZXQoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSwKKwkJCQkgICAgY29uc3Qgc3Ry
dWN0IGRybV9kaXNwbGF5X21vZGUgKm9sZF9tb2RlLAorCQkJCSAgICBjb25zdCBzdHJ1Y3QgZHJt
X2Rpc3BsYXlfbW9kZSAqbW9kZSkKK3sKKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHggPSBicmlk
Z2VfdG9fYW54NzYyNShicmlkZ2UpOworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVu
dC0+ZGV2OworCisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiZHJtIG1vZGUgc2V0XG4iKTsK
KworCW11dGV4X2xvY2soJmN0eC0+bG9jayk7CisKKwljdHgtPmR0LnBpeGVsY2xvY2subWluID0g
bW9kZS0+Y2xvY2s7CisJY3R4LT5kdC5oYWN0aXZlLm1pbiA9IG1vZGUtPmhkaXNwbGF5OworCWN0
eC0+ZHQuaHN5bmNfbGVuLm1pbiA9IG1vZGUtPmhzeW5jX2VuZCAtIG1vZGUtPmhzeW5jX3N0YXJ0
OworCWN0eC0+ZHQuaGZyb250X3BvcmNoLm1pbiA9IG1vZGUtPmhzeW5jX3N0YXJ0IC0gbW9kZS0+
aGRpc3BsYXk7CisJY3R4LT5kdC5oYmFja19wb3JjaC5taW4gPSBtb2RlLT5odG90YWwgLSBtb2Rl
LT5oc3luY19lbmQ7CisJY3R4LT5kdC52YWN0aXZlLm1pbiA9IG1vZGUtPnZkaXNwbGF5OworCWN0
eC0+ZHQudnN5bmNfbGVuLm1pbiA9IG1vZGUtPnZzeW5jX2VuZCAtIG1vZGUtPnZzeW5jX3N0YXJ0
OworCWN0eC0+ZHQudmZyb250X3BvcmNoLm1pbiA9IG1vZGUtPnZzeW5jX3N0YXJ0IC0gbW9kZS0+
dmRpc3BsYXk7CisJY3R4LT5kdC52YmFja19wb3JjaC5taW4gPSBtb2RlLT52dG90YWwgLSBtb2Rl
LT52c3luY19lbmQ7CisKKwljdHgtPmRpc3BsYXlfdGltaW5nX3ZhbGlkID0gMTsKKworCURSTV9E
RVZfREVCVUdfRFJJVkVSKGRldiwgInBpeGVsY2xvY2soJWQpLlxuIiwgY3R4LT5kdC5waXhlbGNs
b2NrLm1pbik7CisJRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiaGFjdGl2ZSglZCksIGhzeW5j
KCVkKSwgaGZwKCVkKSwgaGJwKCVkKVxuIiwKKwkJCSAgICAgY3R4LT5kdC5oYWN0aXZlLm1pbiwK
KwkJCSAgICAgY3R4LT5kdC5oc3luY19sZW4ubWluLAorCQkJICAgICBjdHgtPmR0Lmhmcm9udF9w
b3JjaC5taW4sCisJCQkgICAgIGN0eC0+ZHQuaGJhY2tfcG9yY2gubWluKTsKKwlEUk1fREVWX0RF
QlVHX0RSSVZFUihkZXYsICJ2YWN0aXZlKCVkKSwgdnN5bmMoJWQpLCB2ZnAoJWQpLCB2YnAoJWQp
XG4iLAorCQkJICAgICBjdHgtPmR0LnZhY3RpdmUubWluLAorCQkJICAgICBjdHgtPmR0LnZzeW5j
X2xlbi5taW4sCisJCQkgICAgIGN0eC0+ZHQudmZyb250X3BvcmNoLm1pbiwKKwkJCSAgICAgY3R4
LT5kdC52YmFja19wb3JjaC5taW4pOworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImhkaXNw
bGF5KCVkKSxoc3luY19zdGFydCglZCkuXG4iLAorCQkJICAgICBtb2RlLT5oZGlzcGxheSwKKwkJ
CSAgICAgbW9kZS0+aHN5bmNfc3RhcnQpOworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImhz
eW5jX2VuZCglZCksaHRvdGFsKCVkKS5cbiIsCisJCQkgICAgIG1vZGUtPmhzeW5jX2VuZCwKKwkJ
CSAgICAgbW9kZS0+aHRvdGFsKTsKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJ2ZGlzcGxh
eSglZCksdnN5bmNfc3RhcnQoJWQpLlxuIiwKKwkJCSAgICAgbW9kZS0+dmRpc3BsYXksCisJCQkg
ICAgIG1vZGUtPnZzeW5jX3N0YXJ0KTsKKwlEUk1fREVWX0RFQlVHX0RSSVZFUihkZXYsICJ2c3lu
Y19lbmQoJWQpLHZ0b3RhbCglZCkuXG4iLAorCQkJICAgICBtb2RlLT52c3luY19lbmQsCisJCQkg
ICAgIG1vZGUtPnZ0b3RhbCk7CisKKwltdXRleF91bmxvY2soJmN0eC0+bG9jayk7Cit9CisKK3N0
YXRpYyB2b2lkIGFueDc2MjVfYnJpZGdlX2VuYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdl
KQoreworCXN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCA9IGJyaWRnZV90b19hbng3NjI1KGJyaWRn
ZSk7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJmN0eC0+Y2xpZW50LT5kZXY7CisJaW50IHJldDsK
KworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRybSBlbmFibGVcbiIpOworCisJYW54NzYy
NV9sb3dfcG93ZXJfbW9kZV9jaGVjayhjdHgsIDEpOworCisJaWYgKFdBUk5fT04oIWF0b21pY19y
ZWFkKCZjdHgtPnBvd2VyX3N0YXR1cykpKQorCQlyZXR1cm47CisKKwlpZiAoY3R4LT5wZGF0YS5w
YW5lbCkgeworCQlyZXQgPSBkcm1fcGFuZWxfZW5hYmxlKGN0eC0+cGRhdGEucGFuZWwpOworCQlp
ZiAocmV0IDwgMCkgeworCQkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gZW5hYmxlIHBhbmVsOiAlZC5c
biIsIHJldCk7CisJCQlyZXR1cm47CisJCX0KKwl9CisKKwltdXRleF9sb2NrKCZjdHgtPmxvY2sp
OworCWFueDc2MjVfZHBfc3RhcnQoY3R4KTsKKwltdXRleF91bmxvY2soJmN0eC0+bG9jayk7Cit9
CisKK3N0YXRpYyB2b2lkIGFueDc2MjVfYnJpZGdlX2Rpc2FibGUoc3RydWN0IGRybV9icmlkZ2Ug
KmJyaWRnZSkKK3sKKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHggPSBicmlkZ2VfdG9fYW54NzYy
NShicmlkZ2UpOworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZjdHgtPmNsaWVudC0+ZGV2OworCWlu
dCByZXQ7CisKKwlpZiAoV0FSTl9PTighYXRvbWljX3JlYWQoJmN0eC0+cG93ZXJfc3RhdHVzKSkp
CisJCXJldHVybjsKKworCURSTV9ERVZfREVCVUdfRFJJVkVSKGRldiwgImRybSBkaXNhYmxlXG4i
KTsKKworCWlmIChjdHgtPnBkYXRhLnBhbmVsKSB7CisJCXJldCA9IGRybV9wYW5lbF9kaXNhYmxl
KGN0eC0+cGRhdGEucGFuZWwpOworCQlpZiAocmV0IDwgMCkKKwkJCURSTV9FUlJPUigiZmFpbGVk
IHRvIGRpc2FibGUgcGFuZWw6ICVkLlxuIiwgcmV0KTsKKwl9CisKKwlEUk1fREVWX0RFQlVHX0RS
SVZFUihkZXYsICJkcm0gZGlzYWJsZVxuIik7CisJbXV0ZXhfbG9jaygmY3R4LT5sb2NrKTsKKwor
CWFueDc2MjVfZHBfc3RvcChjdHgpOworCisJYW54NzYyNV9sb3dfcG93ZXJfbW9kZV9jaGVjayhj
dHgsIDApOworCisJbXV0ZXhfdW5sb2NrKCZjdHgtPmxvY2spOworfQorCitzdGF0aWMgY29uc3Qg
c3RydWN0IGRybV9icmlkZ2VfZnVuY3MgYW54NzYyNV9icmlkZ2VfZnVuY3MgPSB7CisJLmF0dGFj
aCA9IGFueDc2MjVfYnJpZGdlX2F0dGFjaCwKKwkuZGlzYWJsZSA9IGFueDc2MjVfYnJpZGdlX2Rp
c2FibGUsCisJLnBvc3RfZGlzYWJsZSA9IGFueDc2MjVfcG9zdF9kaXNhYmxlLAorCS5wcmVfZW5h
YmxlID0gYW54NzYyNV9wcmVfZW5hYmxlLAorCS5tb2RlX3ZhbGlkID0gYW54NzYyNV9icmlkZ2Vf
bW9kZV92YWxpZCwKKwkubW9kZV9zZXQgPSBhbng3NjI1X2JyaWRnZV9tb2RlX3NldCwKKwkuZW5h
YmxlID0gYW54NzYyNV9icmlkZ2VfZW5hYmxlLAorfTsKKworc3RhdGljIGludCBhbng3NjI1X3Jl
Z2lzdGVyX2kyY19kdW1teV9jbGllbnRzKHN0cnVjdCBhbng3NjI1X2RhdGEgKmN0eCwKKwkJCQkJ
ICAgICAgc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCkKK3sKKwljdHgtPmkyYy50eF9wMF9jbGll
bnQgPSBpMmNfbmV3X2R1bW15KGNsaWVudC0+YWRhcHRlciwKKwkJCQkJICAgICAgVFhfUDBfQURE
UiA+PiAxKTsKKwljdHgtPmkyYy50eF9wMV9jbGllbnQgPSBpMmNfbmV3X2R1bW15KGNsaWVudC0+
YWRhcHRlciwKKwkJCQkJICAgICAgVFhfUDFfQUREUiA+PiAxKTsKKwljdHgtPmkyYy50eF9wMl9j
bGllbnQgPSBpMmNfbmV3X2R1bW15KGNsaWVudC0+YWRhcHRlciwKKwkJCQkJICAgICAgVFhfUDJf
QUREUiA+PiAxKTsKKworCWN0eC0+aTJjLnJ4X3AwX2NsaWVudCA9IGkyY19uZXdfZHVtbXkoY2xp
ZW50LT5hZGFwdGVyLAorCQkJCQkgICAgICBSWF9QMF9BRERSID4+IDEpOworCWN0eC0+aTJjLnJ4
X3AxX2NsaWVudCA9IGkyY19uZXdfZHVtbXkoY2xpZW50LT5hZGFwdGVyLAorCQkJCQkgICAgICBS
WF9QMV9BRERSID4+IDEpOworCWN0eC0+aTJjLnJ4X3AyX2NsaWVudCA9IGkyY19uZXdfZHVtbXko
Y2xpZW50LT5hZGFwdGVyLAorCQkJCQkgICAgICBSWF9QMl9BRERSID4+IDEpOworCisJY3R4LT5p
MmMudGNwY19jbGllbnQgPSBpMmNfbmV3X2R1bW15KGNsaWVudC0+YWRhcHRlciwKKwkJCQkJICAg
ICBUQ1BDX0lOVEVSRkFDRV9BRERSID4+IDEpOworCisJaWYgKCghY3R4LT5pMmMudHhfcDBfY2xp
ZW50IHwKKwkgICAgICFjdHgtPmkyYy50eF9wMV9jbGllbnQgfAorCSAgICAgIWN0eC0+aTJjLnR4
X3AyX2NsaWVudCB8CisJICAgICAhY3R4LT5pMmMucnhfcDBfY2xpZW50IHwKKwkgICAgICFjdHgt
PmkyYy5yeF9wMV9jbGllbnQgfAorCSAgICAgIWN0eC0+aTJjLnJ4X3AyX2NsaWVudCB8CisJICAg
ICAhY3R4LT5pMmMudGNwY19jbGllbnQpICE9IDApCisJCXJldHVybiAtRUlPOworCisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyB2b2lkIGFueDc2MjVfdW5yZWdpc3Rlcl9pMmNfZHVtbXlfY2xpZW50
cyhzdHJ1Y3QgYW54NzYyNV9kYXRhICpjdHgpCit7CisJaTJjX3VucmVnaXN0ZXJfZGV2aWNlKGN0
eC0+aTJjLnR4X3AwX2NsaWVudCk7CisJaTJjX3VucmVnaXN0ZXJfZGV2aWNlKGN0eC0+aTJjLnR4
X3AxX2NsaWVudCk7CisJaTJjX3VucmVnaXN0ZXJfZGV2aWNlKGN0eC0+aTJjLnR4X3AyX2NsaWVu
dCk7CisJaTJjX3VucmVnaXN0ZXJfZGV2aWNlKGN0eC0+aTJjLnJ4X3AxX2NsaWVudCk7CisJaTJj
X3VucmVnaXN0ZXJfZGV2aWNlKGN0eC0+aTJjLnJ4X3AyX2NsaWVudCk7CisJaTJjX3VucmVnaXN0
ZXJfZGV2aWNlKGN0eC0+aTJjLnJ4X3AzX2NsaWVudCk7CisJaTJjX3VucmVnaXN0ZXJfZGV2aWNl
KGN0eC0+aTJjLnRjcGNfY2xpZW50KTsKK30KKworc3RhdGljIGludCBhbng3NjI1X2kyY19wcm9i
ZShzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50LAorCQkJICAgICBjb25zdCBzdHJ1Y3QgaTJjX2Rl
dmljZV9pZCAqaWQpCit7CisJc3RydWN0IGFueDc2MjVfZGF0YSAqcGxhdGZvcm07CisJc3RydWN0
IGFueDc2MjVfcGxhdGZvcm1fZGF0YSAqcGRhdGE7CisJaW50IHJldCA9IDA7CisJc3RydWN0IGRl
dmljZSAqZGV2ID0gJmNsaWVudC0+ZGV2OworCisJaWYgKCFpMmNfY2hlY2tfZnVuY3Rpb25hbGl0
eShjbGllbnQtPmFkYXB0ZXIsCisJCQkJICAgICBJMkNfRlVOQ19TTUJVU19JMkNfQkxPQ0spKSB7
CisJCURSTV9ERVZfRVJST1IoZGV2LCAiYW54NzYyNSdzIGkyYyBidXMgZG9lc24ndCBzdXBwb3J0
XG4iKTsKKwkJcmV0ID0gLUVOT0RFVjsKKwkJZ290byBleGl0OworCX0KKworCXBsYXRmb3JtID0g
a3phbGxvYyhzaXplb2YoKnBsYXRmb3JtKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFwbGF0Zm9ybSkg
eworCQlEUk1fREVWX0VSUk9SKGRldiwgImZhaWxlZCB0byBhbGxvY2F0ZSBkcml2ZXIgZGF0YVxu
Iik7CisJCXJldCA9IC1FTk9NRU07CisJCWdvdG8gZXhpdDsKKwl9CisKKwlwZGF0YSA9ICZwbGF0
Zm9ybS0+cGRhdGE7CisKKwkvKiBkZXZpY2UgdHJlZSBwYXJzaW5nIGZ1bmN0aW9uIGNhbGwgKi8K
KwlyZXQgPSBhbng3NjI1X3BhcnNlX2R0KCZjbGllbnQtPmRldiwgcGRhdGEpOworCWlmIChyZXQg
IT0gMCkJLyogaWYgb2NjdXJzIGVycm9yICovCisJCWdvdG8gZXJyMDsKKworCWFueDc2MjVfaW5p
dF9ncGlvKHBsYXRmb3JtKTsKKworCS8qIHRvIGFjY2VzcyBnbG9iYWwgcGxhdGZvcm0gZGF0YSAq
LworCXBsYXRmb3JtLT5jbGllbnQgPSBjbGllbnQ7CisJaTJjX3NldF9jbGllbnRkYXRhKGNsaWVu
dCwgcGxhdGZvcm0pOworCisJaWYgKHBsYXRmb3JtLT5wZGF0YS5leHRjb25fc3VwcG9ydGVkKSB7
CisJCS8qIGdldCBleHRjb24gZGV2aWNlIGZyb20gRFRTICovCisJCXBsYXRmb3JtLT5leHRjb24g
PSBleHRjb25fZ2V0X2VkZXZfYnlfcGhhbmRsZSgmY2xpZW50LT5kZXYsIDApOworCQlpZiAoUFRS
X0VSUihwbGF0Zm9ybS0+ZXh0Y29uKSA9PSAtRVBST0JFX0RFRkVSKQorCQkJZ290byBlcnIwOwor
CQlpZiAoSVNfRVJSKHBsYXRmb3JtLT5leHRjb24pKSB7CisJCQlEUk1fREVWX0VSUk9SKCZjbGll
bnQtPmRldiwKKwkJCQkgICAgICAiY2FuIG5vdCBnZXQgZXh0Y29uIGRldmljZSEiKTsKKwkJCWdv
dG8gZXJyMDsKKwkJfQorCisJCXJldCA9IGFueDc2MjVfZXh0Y29uX25vdGlmaWVyX2luaXQocGxh
dGZvcm0pOworCQlpZiAocmV0IDwgMCkKKwkJCWdvdG8gZXJyMDsKKwl9CisKKwlhdG9taWNfc2V0
KCZwbGF0Zm9ybS0+cG93ZXJfc3RhdHVzLCAwKTsKKworCW11dGV4X2luaXQoJnBsYXRmb3JtLT5s
b2NrKTsKKworCWlmIChwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19pbnRyX2hwZCkgeworCQlJTklUX1dP
UksoJnBsYXRmb3JtLT53b3JrLCBhbng3NjI1X3dvcmtfZnVuYyk7CisJCXBsYXRmb3JtLT53b3Jr
cXVldWUgPSBjcmVhdGVfd29ya3F1ZXVlKCJhbng3NjI1X3dvcmsiKTsKKwkJaWYgKCFwbGF0Zm9y
bS0+d29ya3F1ZXVlKSB7CisJCQlEUk1fREVWX0VSUk9SKGRldiwgImZhaWxlZCB0byBjcmVhdGUg
d29yayBxdWV1ZVxuIik7CisJCQlyZXQgPSAtRU5PTUVNOworCQkJZ290byBlcnIxOworCQl9CisK
KwkJcGxhdGZvcm0tPnBkYXRhLmhwZF9pcnEgPQorCQkJZ3Bpb2RfdG9faXJxKHBsYXRmb3JtLT5w
ZGF0YS5ncGlvX2ludHJfaHBkKTsKKwkJaWYgKHBsYXRmb3JtLT5wZGF0YS5ocGRfaXJxIDwgMCkg
eworCQkJRFJNX0RFVl9FUlJPUihkZXYsICJmYWlsZWQgdG8gZ2V0IGdwaW8gaXJxXG4iKTsKKwkJ
CWdvdG8gZXJyMTsKKwkJfQorCisJCXJldCA9IHJlcXVlc3RfdGhyZWFkZWRfaXJxKHBsYXRmb3Jt
LT5wZGF0YS5ocGRfaXJxLAorCQkJCQkgICBOVUxMLCBhbng3NjI1X2ludHJfaHBkX2lzciwKKwkJ
CQkJICAgSVJRRl9UUklHR0VSX0ZBTExJTkcgfAorCQkJCQkgICBJUlFGX1RSSUdHRVJfUklTSU5H
IHwKKwkJCQkJICAgSVJRRl9PTkVTSE9ULAorCQkJCQkgICAiYW54NzYyNS1ocGQiLCBwbGF0Zm9y
bSk7CisJCWlmIChyZXQgPCAwKSB7CisJCQlEUk1fREVWX0VSUk9SKGRldiwgImZhaWxlZCB0byBy
ZXF1ZXN0IGlycVxuIik7CisJCQlnb3RvIGVycjE7CisJCX0KKworCQlyZXQgPSBpcnFfc2V0X2ly
cV93YWtlKHBsYXRmb3JtLT5wZGF0YS5ocGRfaXJxLCAxKTsKKwkJaWYgKHJldCA8IDApIHsKKwkJ
CURSTV9ERVZfRVJST1IoZGV2LCAiUmVxdWVzdCBpcnEgZm9yIGhwZCIpOworCQkJRFJNX0RFVl9F
UlJPUihkZXYsICJpbnRlcnJ1cHQgd2FrZSBzZXQgZmFpbFxuIik7CisJCQlnb3RvIGVycjE7CisJ
CX0KKworCQlyZXQgPSBlbmFibGVfaXJxX3dha2UocGxhdGZvcm0tPnBkYXRhLmhwZF9pcnEpOwor
CQlpZiAocmV0IDwgMCkgeworCQkJRFJNX0RFVl9FUlJPUihkZXYsICJFbmFibGUgaXJxIGZvciBI
UEQiKTsKKwkJCURSTV9ERVZfRVJST1IoZGV2LCAiaW50ZXJydXB0IHdha2UgZW5hYmxlIGZhaWxc
biIpOworCQkJZ290byBlcnIxOworCQl9CisJfQorCisJaWYgKGFueDc2MjVfcmVnaXN0ZXJfaTJj
X2R1bW15X2NsaWVudHMocGxhdGZvcm0sIGNsaWVudCkgIT0gMCkgeworCQlyZXQgPSAtRU5PTUVN
OworCQlEUk1fRVJST1IoIkZhaWxlZCB0byByZXNlcnZlIEkyQyBidXMuXG4iKTsKKwkJZ290byBl
cnIyOworCX0KKworCWlmIChwbGF0Zm9ybS0+cGRhdGEubG93X3Bvd2VyX21vZGUgPT0gMCkgewor
CQlhbng3NjI1X2Rpc2FibGVfcGRfcHJvdG9jb2wocGxhdGZvcm0pOworCQlhdG9taWNfc2V0KCZw
bGF0Zm9ybS0+cG93ZXJfc3RhdHVzLCAxKTsKKwl9CisKKwkvKiBhZGQgd29yayBmdW5jdGlvbiAq
LworCWlmIChwbGF0Zm9ybS0+cGRhdGEuZ3Bpb19pbnRyX2hwZCkKKwkJcXVldWVfd29yayhwbGF0
Zm9ybS0+d29ya3F1ZXVlLCAmcGxhdGZvcm0tPndvcmspOworCisJcGxhdGZvcm0tPmJyaWRnZS5m
dW5jcyA9ICZhbng3NjI1X2JyaWRnZV9mdW5jczsKKyNpZiBJU19FTkFCTEVEKENPTkZJR19PRikK
KwlwbGF0Zm9ybS0+YnJpZGdlLm9mX25vZGUgPSBjbGllbnQtPmRldi5vZl9ub2RlOworI2VuZGlm
CisJZHJtX2JyaWRnZV9hZGQoJnBsYXRmb3JtLT5icmlkZ2UpOworCisJRFJNX0RFVl9ERUJVR19E
UklWRVIoZGV2LCAicHJvYmUgZG9uZVxuIik7CisJZ290byBleGl0OworCitlcnIyOgorCWFueDc2
MjVfdW5yZWdpc3Rlcl9pMmNfZHVtbXlfY2xpZW50cyhwbGF0Zm9ybSk7CitlcnIxOgorCWlmIChw
bGF0Zm9ybS0+cGRhdGEuZ3Bpb19pbnRyX2hwZCkKKwkJZGVzdHJveV93b3JrcXVldWUocGxhdGZv
cm0tPndvcmtxdWV1ZSk7CitlcnIwOgorCWtmcmVlKHBsYXRmb3JtKTsKK2V4aXQ6CisJcmV0dXJu
IHJldDsKK30KKworc3RhdGljIGludCBhbng3NjI1X2kyY19yZW1vdmUoc3RydWN0IGkyY19jbGll
bnQgKmNsaWVudCkKK3sKKwlzdHJ1Y3QgYW54NzYyNV9kYXRhICpwbGF0Zm9ybSA9IGkyY19nZXRf
Y2xpZW50ZGF0YShjbGllbnQpOworCisJZHJtX2JyaWRnZV9yZW1vdmUoJnBsYXRmb3JtLT5icmlk
Z2UpOworCisJaWYgKHBsYXRmb3JtLT5wZGF0YS5ncGlvX2ludHJfaHBkKQorCQlkZXN0cm95X3dv
cmtxdWV1ZShwbGF0Zm9ybS0+d29ya3F1ZXVlKTsKKworCWlmIChwbGF0Zm9ybS0+cGRhdGEuZXh0
Y29uX3N1cHBvcnRlZCkgeworCQlkZXZtX2V4dGNvbl91bnJlZ2lzdGVyX25vdGlmaWVyKCZwbGF0
Zm9ybS0+Y2xpZW50LT5kZXYsCisJCQkJCQlwbGF0Zm9ybS0+ZXh0Y29uLAorCQkJCQkJRVhUQ09O
X0RJU1BfRFAsCisJCQkJCQkmcGxhdGZvcm0tPmV2ZW50X25iKTsKKwkJZmx1c2hfd29yaygmcGxh
dGZvcm0tPmV4dGNvbl93cSk7CisJfQorCisJYW54NzYyNV9kZXRhY2hfZHNpKHBsYXRmb3JtKTsK
KworCWlmIChwbGF0Zm9ybS0+YnJpZGdlX2F0dGFjaGVkKQorCQlkcm1fY29ubmVjdG9yX3VucmVn
aXN0ZXIoJnBsYXRmb3JtLT5jb25uZWN0b3IpOworCisJYW54NzYyNV91bnJlZ2lzdGVyX2kyY19k
dW1teV9jbGllbnRzKHBsYXRmb3JtKTsKKworCWtmcmVlKHBsYXRmb3JtKTsKKwlyZXR1cm4gMDsK
K30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBpMmNfZGV2aWNlX2lkIGFueDc2MjVfaWRbXSA9IHsK
Kwl7ImFueDc2MjUiLCAwfSwKKwl7fQorfTsKKworTU9EVUxFX0RFVklDRV9UQUJMRShpMmMsIGFu
eDc2MjVfaWQpOworCisjaWZkZWYgQ09ORklHX09GCitzdGF0aWMgY29uc3Qgc3RydWN0IG9mX2Rl
dmljZV9pZCBhbnhfbWF0Y2hfdGFibGVbXSA9IHsKKwl7LmNvbXBhdGlibGUgPSAiYW5hbG9naXgs
YW54NzYyNSIsfSwKKwl7fSwKK307CisjZW5kaWYKKworc3RhdGljIHN0cnVjdCBpMmNfZHJpdmVy
IGFueDc2MjVfZHJpdmVyID0geworCS5kcml2ZXIgPSB7CisJCS5uYW1lID0gImFueDc2MjUiLAor
I2lmZGVmIENPTkZJR19PRgorCQkub2ZfbWF0Y2hfdGFibGUgPSBhbnhfbWF0Y2hfdGFibGUsCisj
ZW5kaWYKKwl9LAorCS5wcm9iZSA9IGFueDc2MjVfaTJjX3Byb2JlLAorCS5yZW1vdmUgPSBhbng3
NjI1X2kyY19yZW1vdmUsCisKKwkuaWRfdGFibGUgPSBhbng3NjI1X2lkLAorfTsKKworbW9kdWxl
X2kyY19kcml2ZXIoYW54NzYyNV9kcml2ZXIpOworCitNT0RVTEVfREVTQ1JJUFRJT04oIk1JUEky
RFAgYW54NzYyNSBkcml2ZXIiKTsKK01PRFVMRV9BVVRIT1IoIlhpbiBKaSA8eGppQGFuYWxvZ2l4
c2VtaS5jb20+Iik7CitNT0RVTEVfTElDRU5TRSgiR1BMIHYyIik7CitNT0RVTEVfVkVSU0lPTihB
Tlg3NjI1X0RSVl9WRVJTSU9OKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2Uv
YW5hbG9naXgvYW54NzYyNS5oIGIvZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9hbmFsb2dpeC9hbng3
NjI1LmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uZGVlOWQxYQotLS0gL2Rl
di9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9icmlkZ2UvYW5hbG9naXgvYW54NzYyNS5oCkBA
IC0wLDAgKzEsNDA1IEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5
ICovCisvKgorICogQ29weXJpZ2h0KGMpIDIwMTYsIEFuYWxvZ2l4IFNlbWljb25kdWN0b3IuIEFs
bCByaWdodHMgcmVzZXJ2ZWQuCisgKgorICovCisKKyNpZm5kZWYgX19BTlg3NjI1X0hfXworI2Rl
ZmluZSBfX0FOWDc2MjVfSF9fCisKKyNpZm5kZWYgTE9HX1RBRworI2RlZmluZSBMT0dfVEFHICJh
bng3NjI1ZHAiCisjZW5kaWYKKworI2RlZmluZSBBTlg3NjI1X0RSVl9WRVJTSU9OICIwLjEuMDQi
CisKKy8qIExvYWRpbmcgT0NNIHJlLXRyeWluZyB0aW1lcyAqLworI2RlZmluZSBPQ01fTE9BRElO
R19USU1FIDEwCisKKy8qKioqKioqKiogIEFOWDc2MjUgUmVnaXN0ZXIgICoqKioqKioqKiovCisj
ZGVmaW5lIFRYX1AwX0FERFIJCQkJMHg3MAorI2RlZmluZSBUWF9QMV9BRERSCQkJCTB4N0EKKyNk
ZWZpbmUgVFhfUDJfQUREUgkJCQkweDcyCisKKyNkZWZpbmUgUlhfUDBfQUREUgkJCQkweDdlCisj
ZGVmaW5lIFJYX1AxX0FERFIJCQkJMHg4NAorI2RlZmluZSBSWF9QMl9BRERSCQkJCTB4NTQKKwor
I2RlZmluZSBSU1ZEXzAwX0FERFIJCQkJMHgwMAorI2RlZmluZSBSU1ZEX0QxX0FERFIJCQkJMHhE
MQorI2RlZmluZSBSU1ZEXzYwX0FERFIJCQkJMHg2MAorI2RlZmluZSBSU1ZEXzM5X0FERFIJCQkJ
MHgzOQorI2RlZmluZSBSU1ZEXzdGX0FERFIJCQkJMHg3RgorCisjZGVmaW5lIFRDUENfSU5URVJG
QUNFX0FERFIJCQkweDU4CisKKy8qIGFueDc2MjUgY2xvY2sgZnJlcXVlbmN5IGluIEh6ICovCisj
ZGVmaW5lIFhUQUxfRlJRICAgICAgICAoMjcgKiAxMDAwMDAwKQorCisjZGVmaW5lICBQT1NUX0RJ
VklERVJfTUlOCTEKKyNkZWZpbmUgIFBPU1RfRElWSURFUl9NQVgJMTYKKyNkZWZpbmUgIFBMTF9P
VVRfRlJFUV9NSU4JNTIwMDAwMDAwVUwKKyNkZWZpbmUgIFBMTF9PVVRfRlJFUV9NQVgJNzMwMDAw
MDAwVUwKKyNkZWZpbmUgIFBMTF9PVVRfRlJFUV9BQlNfTUlOCTMwMDAwMDAwMFVMCisjZGVmaW5l
ICBQTExfT1VUX0ZSRVFfQUJTX01BWAk4MDAwMDAwMDBVTAorI2RlZmluZSAgTUFYX1VOU0lHTkVE
XzI0QklUCTE2Nzc3MjE1VUwKKworLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KKy8qIFJlZ2lzdGVyIGRlZmluaXRpb24gb2Yg
ZGV2aWNlIGFkZHJlc3MgMHg1OCAqLworCisjZGVmaW5lIFBST0RVQ1RfSURfTCAweDAyCisjZGVm
aW5lIFBST0RVQ1RfSURfSCAweDAzCisKKyNkZWZpbmUgSU5UUl9BTEVSVF8xICAweENDCisjZGVm
aW5lIElOVFJfU09GVFdBUkVfSU5UIEJJVCgzKQorI2RlZmluZSBJTlRSX1JFQ0VJVkVEX01TRyBC
SVQoNSkKKworI2RlZmluZSBTWVNURU1fU1RTVFVTIDB4NDUKKyNkZWZpbmUgSU5URVJGQUNFX0NI
QU5HRV9JTlQgMHg0NAorI2RlZmluZSBIUERfU1RBVFVTX0NIQU5HRSAweDgwCisjZGVmaW5lIEhQ
RF9TVEFUVVMgMHg4MAorCisvKioqKioqKiogRU5EIG9mIEkyQyBBZGRyZXNzIDB4NTggKioqKioq
KiovCisKKy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKiovCisvKiBSZWdpc3RlciBkZWZpbml0aW9uIG9mIGRldmljZSBhZGRyZXNz
IDB4NzAgKi8KKyNkZWZpbmUgIEkyQ19BRERSXzcwX0RQVFggICAgICAgICAgICAgIDB4NzAKKwor
I2RlZmluZSBTUF9UWF9MSU5LX0JXX1NFVF9SRUcgMHhBMAorI2RlZmluZSBTUF9UWF9MQU5FX0NP
VU5UX1NFVF9SRUcgMHhBMQorCisjZGVmaW5lIE1fVklEXzAgMHhDMAorI2RlZmluZSBNX1ZJRF8x
IDB4QzEKKyNkZWZpbmUgTV9WSURfMiAweEMyCisjZGVmaW5lIE5fVklEXzAgMHhDMworI2RlZmlu
ZSBOX1ZJRF8xIDB4QzQKKyNkZWZpbmUgTl9WSURfMiAweEM1CisKKy8qKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCisvKiBSZWdp
c3RlciBkZWZpbml0aW9uIG9mIGRldmljZSBhZGRyZXNzIDB4NzIgKi8KKyNkZWZpbmUgQVVYX1JT
VAkweDA0CisjZGVmaW5lIFJTVF9DVFJMMiAweDA3CisKKyNkZWZpbmUgU1BfVFhfVE9UQUxfTElO
RV9TVEFfTCAweDI0CisjZGVmaW5lIFNQX1RYX1RPVEFMX0xJTkVfU1RBX0ggMHgyNQorI2RlZmlu
ZSBTUF9UWF9BQ1RfTElORV9TVEFfTCAweDI2CisjZGVmaW5lIFNQX1RYX0FDVF9MSU5FX1NUQV9I
IDB4MjcKKyNkZWZpbmUgU1BfVFhfVl9GX1BPUkNIX1NUQSAweDI4CisjZGVmaW5lIFNQX1RYX1Zf
U1lOQ19TVEEgMHgyOQorI2RlZmluZSBTUF9UWF9WX0JfUE9SQ0hfU1RBIDB4MkEKKyNkZWZpbmUg
U1BfVFhfVE9UQUxfUElYRUxfU1RBX0wgMHgyQgorI2RlZmluZSBTUF9UWF9UT1RBTF9QSVhFTF9T
VEFfSCAweDJDCisjZGVmaW5lIFNQX1RYX0FDVF9QSVhFTF9TVEFfTCAweDJECisjZGVmaW5lIFNQ
X1RYX0FDVF9QSVhFTF9TVEFfSCAweDJFCisjZGVmaW5lIFNQX1RYX0hfRl9QT1JDSF9TVEFfTCAw
eDJGCisjZGVmaW5lIFNQX1RYX0hfRl9QT1JDSF9TVEFfSCAweDMwCisjZGVmaW5lIFNQX1RYX0hf
U1lOQ19TVEFfTCAweDMxCisjZGVmaW5lIFNQX1RYX0hfU1lOQ19TVEFfSCAweDMyCisjZGVmaW5l
IFNQX1RYX0hfQl9QT1JDSF9TVEFfTCAweDMzCisjZGVmaW5lIFNQX1RYX0hfQl9QT1JDSF9TVEFf
SCAweDM0CisKKyNkZWZpbmUgU1BfVFhfVklEX0NUUkwgMHg4NAorI2RlZmluZSBTUF9UWF9CUENf
TUFTSyAweEUwCisjZGVmaW5lIFNQX1RYX0JQQ182ICAgIDB4MDAKKyNkZWZpbmUgU1BfVFhfQlBD
XzggICAgMHgyMAorI2RlZmluZSBTUF9UWF9CUENfMTAgICAweDQwCisjZGVmaW5lIFNQX1RYX0JQ
Q18xMiAgIDB4NjAKKworI2RlZmluZSBWSURFT19CSVRfTUFUUklYXzEyIDB4NGMKKworI2RlZmlu
ZSBBVURJT19DSEFOTkVMX1NUQVRVU18xIDB4ZDAKKyNkZWZpbmUgQVVESU9fQ0hBTk5FTF9TVEFU
VVNfMiAweGQxCisjZGVmaW5lIEFVRElPX0NIQU5ORUxfU1RBVFVTXzMgMHhkMgorI2RlZmluZSBB
VURJT19DSEFOTkVMX1NUQVRVU180IDB4ZDMKKyNkZWZpbmUgQVVESU9fQ0hBTk5FTF9TVEFUVVNf
NSAweGQ0CisjZGVmaW5lIEFVRElPX0NIQU5ORUxfU1RBVFVTXzYgMHhkNQorI2RlZmluZSBURE1f
U0xBVkVfTU9ERSAweDEwCisjZGVmaW5lIEkyU19TTEFWRV9NT0RFIDB4MDgKKworI2RlZmluZSBB
VURJT19DT05UUk9MX1JFR0lTVEVSIDB4ZTYKKyNkZWZpbmUgVERNX1RJTUlOR19NT0RFIDB4MDgK
KworI2RlZmluZSAgSTJDX0FERFJfNzJfRFBUWCAgICAgICAgICAgICAgMHg3MgorCisjZGVmaW5l
ICBWSURFT19DT05UUk9MXzAgIDB4MDgKKworI2RlZmluZSAgQUNUSVZFX0xJTkVTX0wgICAgICAg
ICAweDE0CisjZGVmaW5lICBBQ1RJVkVfTElORVNfSCAgICAgICAgIDB4MTUgIC8qIG5vdGU6IGJp
dFs3OjZdIGFyZSByZXNlcnZlZCAqLworI2RlZmluZSAgVkVSVElDQUxfRlJPTlRfUE9SQ0ggICAw
eDE2CisjZGVmaW5lICBWRVJUSUNBTF9TWU5DX1dJRFRIICAgIDB4MTcKKyNkZWZpbmUgIFZFUlRJ
Q0FMX0JBQ0tfUE9SQ0ggICAgMHgxOAorCisjZGVmaW5lICBIT1JJWk9OVEFMX1RPVEFMX1BJWEVM
U19MICAgIDB4MTkKKyNkZWZpbmUgIEhPUklaT05UQUxfVE9UQUxfUElYRUxTX0ggICAgMHgxQSAg
Lyogbm90ZTogYml0Wzc6Nl0gYXJlIHJlc2VydmVkICovCisjZGVmaW5lICBIT1JJWk9OVEFMX0FD
VElWRV9QSVhFTFNfTCAgIDB4MUIKKyNkZWZpbmUgIEhPUklaT05UQUxfQUNUSVZFX1BJWEVMU19I
ICAgMHgxQyAgLyogbm90ZTogYml0Wzc6Nl0gYXJlIHJlc2VydmVkICovCisjZGVmaW5lICBIT1JJ
Wk9OVEFMX0ZST05UX1BPUkNIX0wgICAgIDB4MUQKKyNkZWZpbmUgIEhPUklaT05UQUxfRlJPTlRf
UE9SQ0hfSCAgICAgMHgxRSAgLyogbm90ZTogYml0Wzc6NF0gYXJlIHJlc2VydmVkICovCisjZGVm
aW5lICBIT1JJWk9OVEFMX1NZTkNfV0lEVEhfTCAgICAgIDB4MUYKKyNkZWZpbmUgIEhPUklaT05U
QUxfU1lOQ19XSURUSF9IICAgICAgMHgyMCAgLyogbm90ZTogYml0Wzc6NF0gYXJlIHJlc2VydmVk
ICovCisjZGVmaW5lICBIT1JJWk9OVEFMX0JBQ0tfUE9SQ0hfTCAgICAgIDB4MjEKKyNkZWZpbmUg
IEhPUklaT05UQUxfQkFDS19QT1JDSF9IICAgICAgMHgyMiAgLyogbm90ZTogYml0Wzc6NF0gYXJl
IHJlc2VydmVkICovCisKKy8qKioqKioqKiBFTkQgb2YgSTJDIEFkZHJlc3MgMHg3MiAqKioqKioq
KiovCisvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqLworLyogUmVnaXN0ZXIgZGVmaW5pdGlvbiBvZiBkZXZpY2UgYWRkcmVzcyAw
eDdlICovCisKKyNkZWZpbmUgIEkyQ19BRERSXzdFX0ZMQVNIX0NPTlRST0xMRVIgIDB4N0UKKwor
I2RlZmluZSBGTEFTSF9MT0FEX1NUQSAweDA1CisjZGVmaW5lIEZMQVNIX0xPQURfU1RBX0NISwlC
SVQoNykKKworI2RlZmluZSAgWFRBTF9GUlFfU0VMICAgIDB4M0YKKy8qIGJpdCBmaWVsZCBwb3Np
dGlvbnMgKi8KKyNkZWZpbmUgIFhUQUxfRlJRX1NFTF9QT1MgICAgNQorLyogYml0IGZpZWxkIHZh
bHVlcyAqLworI2RlZmluZSAgWFRBTF9GUlFfMTlNMiAgICgwIDw8IFhUQUxfRlJRX1NFTF9QT1Mp
CisjZGVmaW5lICBYVEFMX0ZSUV8yN00gICAgKDQgPDwgWFRBTF9GUlFfU0VMX1BPUykKKworI2Rl
ZmluZSAgUl9EU0NfQ1RSTF8wICAgIDB4NDAKKyNkZWZpbmUgIFJFQURfU1RBVFVTX0VOICA3Cisj
ZGVmaW5lICBDTEtfMU1FR19SQiAgICAgNiAgLyogMU1IeiBjbG9jayByZXNldDsgMD1yZXNldCwg
MD1yZXNldCByZWxlYXNlICovCisjZGVmaW5lICBEU0NfQklTVF9ET05FICAgMSAgLyogYml0WzU6
MV06IDE9RFNDIE1CSVNUIHBhc3MgKi8KKyNkZWZpbmUgIERTQ19FTiAgICAgICAgICAweDAxICAv
KiAxPURTQyBlbmFibGVkLCAwPURTQyBkaXNhYmxlZCAqLworCisjZGVmaW5lIE9DTV9GV19WRVJT
SU9OICAgMHgzMQorI2RlZmluZSBPQ01fRldfUkVWRVJTSU9OIDB4MzIKKworI2RlZmluZSBBUF9B
VVhfQUREUl83XzAgICAweDExCisjZGVmaW5lIEFQX0FVWF9BRERSXzE1XzggIDB4MTIKKyNkZWZp
bmUgQVBfQVVYX0FERFJfMTlfMTYgMHgxMworCisvKiBub3RlOiBiaXRbMDozXSBBVVggc3RhdHVz
LCBiaXQgNCBvcF9lbiwgYml0IDUgYWRkcmVzcyBvbmx5ICovCisjZGVmaW5lIEFQX0FVWF9DVFJM
X1NUQVRVUyAweDE0CisjZGVmaW5lIEFQX0FVWF9DVFJMX09QX0VOIDB4MTAKKyNkZWZpbmUgQVBf
QVVYX0NUUkxfQUREUk9OTFkgMHgyMAorCisjZGVmaW5lIEFQX0FVWF9CVUZGX1NUQVJUIDB4MTUK
KyNkZWZpbmUgUElYRUxfQ0xPQ0tfTCAweDI1CisjZGVmaW5lIFBJWEVMX0NMT0NLX0ggMHgyNgor
CisjZGVmaW5lIEFQX0FVWF9DT01NQU5EIDB4MjcgIC8qIGNvbStsZW4gKi8KKy8qIGJpdCAwJjE6
IDNEIHZpZGVvIHN0cnVjdHVyZSAqLworLyogMHgwMTogZnJhbWUgcGFja2luZywgIDB4MDI6TGlu
ZSBhbHRlcm5hdGl2ZSwgMHgwMzpTaWRlLWJ5LXNpZGUoZnVsbCkgKi8KKyNkZWZpbmUgQVBfQVZf
U1RBVFVTIDB4MjgKKyNkZWZpbmUgQVBfVklERU9fQ0hHICBCSVQoMikKKyNkZWZpbmUgQVBfQVVE
SU9fQ0hHICBCSVQoMykKKyNkZWZpbmUgQVBfTUlQSV9NVVRFICBCSVQoNCkgLyogMTpNSVBJIGlu
cHV0IG11dGUsIDA6IHVtbXV0ZSAqLworI2RlZmluZSBBUF9NSVBJX1JYX0VOIEJJVCg1KSAvKiAx
OiBNSVBJIFJYIGlucHV0IGluICAwOiBubyBSWCBpbiAqLworI2RlZmluZSBBUF9ESVNBQkxFX1BE
IEJJVCg2KQorI2RlZmluZSBBUF9ESVNBQkxFX0RJU1BMQVkgQklUKDcpCisvKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLworLyog
UmVnaXN0ZXIgZGVmaW5pdGlvbiBvZiBkZXZpY2UgYWRkcmVzcyAweDg0ICovCisjZGVmaW5lICBN
SVBJX1BIWV9DT05UUk9MXzMgICAgICAgICAgICAweDAzCisjZGVmaW5lICBNSVBJX0hTX1BXRF9D
TEsgICAgICAgICAgICAgICA3CisjZGVmaW5lICBNSVBJX0hTX1JUX0NMSyAgICAgICAgICAgICAg
ICA2CisjZGVmaW5lICBNSVBJX1BEX0NMSyAgICAgICAgICAgICAgICAgICA1CisjZGVmaW5lICBN
SVBJX0NMS19SVF9NQU5VQUxfUERfRU4gICAgICA0CisjZGVmaW5lICBNSVBJX0NMS19IU19NQU5V
QUxfUERfRU4gICAgICAzCisjZGVmaW5lICBNSVBJX0NMS19ERVRfREVUX0JZUEFTUyAgICAgICAy
CisjZGVmaW5lICBNSVBJX0NMS19NSVNTX0NUUkwgICAgICAgICAgICAxCisjZGVmaW5lICBNSVBJ
X1BEX0xQVFhfQ0hfTUFOVUFMX1BEX0VOICAwCisKKyNkZWZpbmUgIE1JUElfTEFORV9DVFJMXzAJ
CTB4MDUKKyNkZWZpbmUgIE1JUElfVElNRV9IU19QUlBSCQkweDA4CisKKy8qIEFmdGVyIE1JUEkg
UlggcHJvdG9jb2wgbGF5ZXIgcmVjZWl2ZWQgdGhpcyBtYW55IHZpZGVvIGZyYW1lcywgKi8KKy8q
IHByb3RvY29sIGxheWVyIHN0YXJ0cyB0byByZWNvbnN0cnVjdCB2aWRlbyBzdHJlYW0gZnJvbSBQ
SFkgKi8KKyNkZWZpbmUgIE1JUElfVklERU9fU1RBQkxFX0NOVCAgICAgICAgICAgMHgwQQorCisj
ZGVmaW5lICBNSVBJX0xBTkVfQ1RSTF8xMCAgICAgICAgICAgICAgIDB4MEYKKyNkZWZpbmUgIE1J
UElfRElHSVRBTF9BREpfMSAgIDB4MUIKKworI2RlZmluZSAgTUlQSV9QTExfTV9OVU1fMjNfMTYg
ICAweDFFCisjZGVmaW5lICBNSVBJX1BMTF9NX05VTV8xNV84ICAgIDB4MUYKKyNkZWZpbmUgIE1J
UElfUExMX01fTlVNXzdfMCAgICAgMHgyMAorI2RlZmluZSAgTUlQSV9QTExfTl9OVU1fMjNfMTYg
ICAweDIxCisjZGVmaW5lICBNSVBJX1BMTF9OX05VTV8xNV84ICAgIDB4MjIKKyNkZWZpbmUgIE1J
UElfUExMX05fTlVNXzdfMCAgICAgMHgyMworCisjZGVmaW5lICBNSVBJX0RJR0lUQUxfUExMXzYg
ICAgIDB4MkEKKy8qIGJpdFs3OjZdOiBWQ08gYmFuZCBjb250cm9sLCBvbmx5IGVmZmVjdGl2ZSAq
LworLyogd2hlbiBNSVBJX1BMTF9GT1JDRV9CQU5EX0VOICgweDg0OjB4MkJbNl0pIGlzIDEgKi8K
KyNkZWZpbmUgIE1JUElfTV9OVU1fUkVBRFkgICAgICAgIDB4MTAKKyNkZWZpbmUgIE1JUElfTl9O
VU1fUkVBRFkgICAgICAgIDB4MDgKKyNkZWZpbmUgIFNUQUJMRV9JTlRFR0VSX0NOVF9FTiAgIDB4
MDQKKyNkZWZpbmUgIE1JUElfUExMX1RFU1RfQklUICAgICAgIDAKKy8qIGJpdFsxOjBdOiB0ZXN0
IHBvaW50IG91dHB1dCBzZWxlY3QgLSAqLworLyogMDA6IFZDTyBwb3dlciwgMDE6IGR2ZGRfcGR0
LCAxMDogZHZkZCwgMTE6IHZjb3ggKi8KKworI2RlZmluZSAgTUlQSV9ESUdJVEFMX1BMTF83ICAg
ICAgMHgyQgorI2RlZmluZSAgTUlQSV9QTExfRk9SQ0VfTl9FTiAgICAgNworI2RlZmluZSAgTUlQ
SV9QTExfRk9SQ0VfQkFORF9FTiAgNgorCisjZGVmaW5lICBNSVBJX1BMTF9WQ09fVFVORV9SRUcg
ICA0CisvKiBiaXRbNTo0XTogVkNPIG1ldGFsIGNhcGFjaXRhbmNlIC0gKi8KKy8qIDAwOiArMjAl
IGZhc3QsIDAxOiArMTAlIGZhc3QgKGRlZmF1bHQpLCAxMDogdHlwaWNhbCwgMTE6IC0xMCUgc2xv
dyAqLworI2RlZmluZSAgTUlQSV9QTExfVkNPX1RVTkVfUkVHX1ZBTCAgIDB4MzAKKworI2RlZmlu
ZSAgTUlQSV9QTExfUExMX0xET19CSVQgICAgMgorLyogYml0WzM6Ml06IHZjb192MmkgcG93ZXIg
LSAqLworLyogMDA6IDEuNDBWLCAwMTogMS40NVYgKGRlZmF1bHQpLCAxMDogMS41MFYsIDExOiAx
LjU1ViAqLworI2RlZmluZSAgTUlQSV9QTExfUkVTRVRfTiAgICAgICAgMHgwMgorI2RlZmluZSAg
TUlQSV9GUlFfRk9SQ0VfTkRFVCAgICAgMAorCisjZGVmaW5lICBNSVBJX0FMRVJUX0NMUl8wICAg
ICAgICAweDJECisjZGVmaW5lICBIU19saW5rX2Vycm9yX2NsZWFyICAgICA3CisvKiBUaGlzIGJp
dCBpdHNlbGYgaXMgUy9DLCBhbmQgaXQgY2xlYXJzIDB4ODQ6MHgzMVs3XSAqLworCisjZGVmaW5l
ICBNSVBJX0FMRVJUX09VVF8wICAgICAgICAweDMxCisjZGVmaW5lICBjaGVja19zdW1fZXJyX2hz
X3N5bmMgICA3CisvKiBUaGlzIGJpdCBpcyBjbGVhcmVkIGJ5IDB4ODQ6MHgyRFs3XSAqLworCisj
ZGVmaW5lICBNSVBJX0RJR0lUQUxfUExMXzggICAgMHgzMworI2RlZmluZSAgTUlQSV9QT1NUX0RJ
Vl9WQUwgICAgIDQKKy8qIG4gbWVhbnMgZGl2aWRlZCBieSAobisxKSwgbiA9IDB+MTUgKi8KKyNk
ZWZpbmUgIE1JUElfRU5fTE9DS19GUlogICAgICAzCisjZGVmaW5lICBNSVBJX0ZSUV9DT1VOVEVS
X1JTVCAgMgorI2RlZmluZSAgTUlQSV9GUlFfU0VUX1JFR184ICAgIDEKKy8qIGJpdCAwIGlzIHJl
c2VydmVkICovCisKKyNkZWZpbmUgIE1JUElfRElHSVRBTF9QTExfOSAgICAweDM0CisKKyNkZWZp
bmUgIE1JUElfRElHSVRBTF9QTExfMTYgICAweDNCCisjZGVmaW5lICBNSVBJX0ZSUV9GUkVFWkVf
TkRFVCAgICAgICAgICA3CisjZGVmaW5lICBNSVBJX0ZSUV9SRUdfU0VUX0VOQUJMRSAgICAgICA2
CisjZGVmaW5lICBNSVBJX1JFR19GT1JDRV9TRUxfRU4gICAgICAgICA1CisjZGVmaW5lICBNSVBJ
X1JFR19TRUxfRElWX1JFRyAgICAgICAgICA0CisjZGVmaW5lICBNSVBJX1JFR19GT1JDRV9QUkVf
RElWX0VOICAgICAzCisvKiBiaXQgMiBpcyByZXNlcnZlZCAqLworI2RlZmluZSAgTUlQSV9GUkVG
X0RfSU5EICAgICAgICAgICAgICAgMQorI2RlZmluZSAgUkVGX0NMS18yNzAwMEtIWiAgICAxCisj
ZGVmaW5lICBSRUZfQ0xLXzE5MjAwS0haICAgIDAKKyNkZWZpbmUgIE1JUElfUkVHX1BMTF9QTExf
VEVTVF9FTkFCTEUgIDAKKworI2RlZmluZSAgTUlQSV9ESUdJVEFMX1BMTF8xOCAgMHgzRAorI2Rl
ZmluZSAgRlJRX0NPVU5UX1JCX1NFTCAgICAgICA3CisjZGVmaW5lICBSRUdfRk9SQ0VfUE9TVF9E
SVZfRU4gIDYKKyNkZWZpbmUgIE1JUElfRFBJX1NFTEVDVCAgICAgICAgNQorI2RlZmluZSAgU0VM
RUNUX0RTSSAgMQorI2RlZmluZSAgU0VMRUNUX0RQSSAgMAorI2RlZmluZSAgUkVHX0JBVURfRElW
X1JBVElPICAgICAwCisKKyNkZWZpbmUgIEhfQkxBTktfTCAgICAgICAgICAgIDB4M0UKKy8qIGZv
ciBEU0Mgb25seSAqLworI2RlZmluZSAgSF9CTEFOS19IICAgICAgICAgICAgMHgzRgorLyogZm9y
IERTQyBvbmx5OyBub3RlOiBiaXRbNzo2XSBhcmUgcmVzZXJ2ZWQgKi8KKyNkZWZpbmUgIE1JUElf
U1dBUCAgMHg0QQorI2RlZmluZSAgTUlQSV9TV0FQX0NIMCAgICA3CisjZGVmaW5lICBNSVBJX1NX
QVBfQ0gxICAgIDYKKyNkZWZpbmUgIE1JUElfU1dBUF9DSDIgICAgNQorI2RlZmluZSAgTUlQSV9T
V0FQX0NIMyAgICA0CisjZGVmaW5lICBNSVBJX1NXQVBfQ0xLICAgIDMKKy8qIGJpdFsyOjBdIGFy
ZSByZXNlcnZlZCAqLworCisvKioqKioqKiogRU5EIG9mIEkyQyBBZGRyZXNzIDB4ODQgKioqKioq
KioqLworCisvKiBEUENEIHJlZ3MgKi8KKyNkZWZpbmUgRFBDRF9EUENEX1JFViAgICAgICAgICAg
ICAgICAgIDB4MDAKKyNkZWZpbmUgRFBDRF9NQVhfTElOS19SQVRFICAgICAgICAgICAgIDB4MDEK
KyNkZWZpbmUgRFBDRF9NQVhfTEFORV9DT1VOVCAgICAgICAgICAgIDB4MDIKKworLyoqKioqKioq
KiAgQU5YNzYyNSBSZWdpc3RlciBFbmQgICoqKioqKioqKiovCisKKy8qKioqKioqKioqKioqKioq
KiAgRGlzcGxheSAqKioqKioqKioqKioqKioqKi8KK2VudW0gYXVkaW9fZnMgeworCUFVRElPX0ZT
XzQ0MUsgID0gMHgwMCwKKwlBVURJT19GU180OEsgICA9IDB4MDIsCisJQVVESU9fRlNfMzJLICAg
PSAweDAzLAorCUFVRElPX0ZTXzg4MksgID0gMHgwOCwKKwlBVURJT19GU185NksgICA9IDB4MGEs
CisJQVVESU9fRlNfMTc2NEsgPSAweDBjLAorCUFVRElPX0ZTXzE5MksgID0gMHgwZQorfTsKKwor
ZW51bSBhdWRpb193ZF9sZW4geworCUFVRElPX1dfTEVOXzE2XzIwTUFYID0gMHgwMiwKKwlBVURJ
T19XX0xFTl8xOF8yME1BWCA9IDB4MDQsCisJQVVESU9fV19MRU5fMTdfMjBNQVggPSAweDBjLAor
CUFVRElPX1dfTEVOXzE5XzIwTUFYID0gMHgwOCwKKwlBVURJT19XX0xFTl8yMF8yME1BWCA9IDB4
MGEsCisJQVVESU9fV19MRU5fMjBfMjRNQVggPSAweDAzLAorCUFVRElPX1dfTEVOXzIyXzI0TUFY
ID0gMHgwNSwKKwlBVURJT19XX0xFTl8yMV8yNE1BWCA9IDB4MGQsCisJQVVESU9fV19MRU5fMjNf
MjRNQVggPSAweDA5LAorCUFVRElPX1dfTEVOXzI0XzI0TUFYID0gMHgwYgorfTsKKworI2RlZmlu
ZSBJMlNfQ0hfMgkweDAxCisjZGVmaW5lIFRETV9DSF80CTB4MDMKKyNkZWZpbmUgVERNX0NIXzYJ
MHgwNQorI2RlZmluZSBURE1fQ0hfOAkweDA3CisKKyNkZWZpbmUgTUFYX0RQQ0RfQlVGRkVSX1NJ
WkUJMTYKKworI2RlZmluZSBPTkVfQkxPQ0tfU0laRSAgICAgIDEyOAorI2RlZmluZSBGT1VSX0JM
T0NLX1NJWkUgICAgICgxMjggKiA0KQorCitzdHJ1Y3Qgc19lZGlkX2RhdGEgeworCWludCBlZGlk
X2Jsb2NrX251bTsKKwl1OCBlZGlkX3Jhd19kYXRhW0ZPVVJfQkxPQ0tfU0laRV07Cit9OworCisv
KioqKioqKioqKioqKioqKiogIERpc3BsYXkgRW5kICoqKioqKioqKioqKioqKioqLworCitzdHJ1
Y3QgYW54NzYyNV9kZXZpY2Vfbm9kZSB7CisJc3RydWN0IGRldmljZV9ub2RlICptaXBpX2RzaV9o
b3N0X25vZGU7CisJc3RydWN0IGRldmljZV9ub2RlICptaXBpX2RwaV9ob3N0X25vZGU7CisJc3Ry
dWN0IGRldmljZV9ub2RlICpleHRjb25fbm9kZTsKKwlzdHJ1Y3QgZGV2aWNlX25vZGUgKmludGVy
bmFsX3BhbmVsX25vZGU7CisJc3RydWN0IGRldmljZV9ub2RlICplZHBfbm9kZTsKK307CisKK3N0
cnVjdCBhbng3NjI1X3BsYXRmb3JtX2RhdGEgeworCXN0cnVjdCBncGlvX2Rlc2MgKmdwaW9fcF9v
bjsKKwlzdHJ1Y3QgZ3Bpb19kZXNjICpncGlvX3Jlc2V0OworCXN0cnVjdCBncGlvX2Rlc2MgKmdw
aW9faW50cl9ocGQ7CisJc3RydWN0IGRybV9wYW5lbCAqcGFuZWw7CisJaW50IGhwZF9pcnE7CisJ
dTMyIGxvd19wb3dlcl9tb2RlOworCXUzMiBkc2lfc3VwcG9ydGVkOworCXUzMiBpbnRlcm5hbF9w
YW5lbDsKKwl1MzIgZXh0Y29uX3N1cHBvcnRlZDsKKwlzdHJ1Y3QgYW54NzYyNV9kZXZpY2Vfbm9k
ZSBub2RlOworfTsKKworc3RydWN0IGFueDc2MjVfaTJjX2NsaWVudCB7CisJc3RydWN0IGkyY19j
bGllbnQgKnR4X3AwX2NsaWVudDsKKwlzdHJ1Y3QgaTJjX2NsaWVudCAqdHhfcDFfY2xpZW50Owor
CXN0cnVjdCBpMmNfY2xpZW50ICp0eF9wMl9jbGllbnQ7CisJc3RydWN0IGkyY19jbGllbnQgKnJ4
X3AwX2NsaWVudDsKKwlzdHJ1Y3QgaTJjX2NsaWVudCAqcnhfcDFfY2xpZW50OworCXN0cnVjdCBp
MmNfY2xpZW50ICpyeF9wMl9jbGllbnQ7CisJc3RydWN0IGkyY19jbGllbnQgKnJ4X3AzX2NsaWVu
dDsKKwlzdHJ1Y3QgaTJjX2NsaWVudCAqdGNwY19jbGllbnQ7Cit9OworCitzdHJ1Y3QgYW54NzYy
NV9kYXRhIHsKKwlzdHJ1Y3QgYW54NzYyNV9wbGF0Zm9ybV9kYXRhIHBkYXRhOworCWF0b21pY190
IHBvd2VyX3N0YXR1czsKKwlhdG9taWNfdCBwYW5lbF9wb3dlcjsKKwlpbnQgaHBkX3N0YXR1czsK
KwlpbnQgaHBkX2hpZ2hfY250OworCXN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQ7CisJc3RydWN0
IGFueDc2MjVfaTJjX2NsaWVudCBpMmM7CisJc3RydWN0IGkyY19jbGllbnQgKmxhc3RfY2xpZW50
OworCXN0cnVjdCBzX2VkaWRfZGF0YSBzbGltcG9ydF9lZGlkX3A7CisJc3RydWN0IHdvcmtfc3Ry
dWN0IHdvcms7CisJc3RydWN0IHdvcmtxdWV1ZV9zdHJ1Y3QgKndvcmtxdWV1ZTsKKwkvKiBkcm0g
YnJpZGdlIG11dGV4IGxvY2sgKi8KKwlzdHJ1Y3QgbXV0ZXggbG9jazsKKwljaGFyIGVkaWRfYmxv
Y2s7CisJc3RydWN0IGRpc3BsYXlfdGltaW5nIGR0OworCXU4IGRpc3BsYXlfdGltaW5nX3ZhbGlk
OworCXN0cnVjdCBkcm1fYnJpZGdlIGJyaWRnZTsKKwl1OCBicmlkZ2VfYXR0YWNoZWQ7CisJc3Ry
dWN0IGRybV9jb25uZWN0b3IgY29ubmVjdG9yOworCXN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRz
aTsKKwlzdHJ1Y3QgZHJtX2RwX2xpbmsgbGluazsKKwlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSB2
aWRfaW5mbzsKKwlzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgZXZlbnRfbmI7CisJc3RydWN0IGV4dGNv
bl9kZXYgKmV4dGNvbjsKKwlzdHJ1Y3Qgd29ya19zdHJ1Y3QgZXh0Y29uX3dxOworfTsKKworI2Vu
ZGlmICAvKiBfX0FOWDc2MjVfSF9fICovCi0tIAoyLjcuNAoKX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2
ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21h
aWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
