Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 6A547A326A
	for <lists+dri-devel@lfdr.de>; Fri, 30 Aug 2019 10:30:01 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C003C6E2B6;
	Fri, 30 Aug 2019 08:29:21 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from inva021.nxp.com (inva021.nxp.com [92.121.34.21])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5A6316E0A0
 for <dri-devel@lists.freedesktop.org>; Thu, 29 Aug 2019 11:30:24 +0000 (UTC)
Received: from inva021.nxp.com (localhost [127.0.0.1])
 by inva021.eu-rdc02.nxp.com (Postfix) with ESMTP id 22995200338;
 Thu, 29 Aug 2019 13:30:23 +0200 (CEST)
Received: from inva024.eu-rdc02.nxp.com (inva024.eu-rdc02.nxp.com
 [134.27.226.22])
 by inva021.eu-rdc02.nxp.com (Postfix) with ESMTP id 1416520032E;
 Thu, 29 Aug 2019 13:30:23 +0200 (CEST)
Received: from fsr-ub1664-120.ea.freescale.net
 (fsr-ub1664-120.ea.freescale.net [10.171.82.81])
 by inva024.eu-rdc02.nxp.com (Postfix) with ESMTP id 61B2520613;
 Thu, 29 Aug 2019 13:30:22 +0200 (CEST)
From: Robert Chiras <robert.chiras@nxp.com>
To: =?UTF-8?q?Guido=20G=C3=BCnther?= <agx@sigxcpu.org>,
 Marek Vasut <marex@denx.de>, Stefan Agner <stefan@agner.ch>,
 David Airlie <airlied@linux.ie>, Daniel Vetter <daniel@ffwll.ch>,
 Rob Herring <robh+dt@kernel.org>, Mark Rutland <mark.rutland@arm.com>,
 Shawn Guo <shawnguo@kernel.org>, Sascha Hauer <s.hauer@pengutronix.de>,
 Fabio Estevam <festevam@gmail.com>
Subject: [PATCH v4 06/14] drm/mxsfb: Update mxsfb with additional pixel formats
Date: Thu, 29 Aug 2019 14:30:07 +0300
Message-Id: <1567078215-31601-7-git-send-email-robert.chiras@nxp.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1567078215-31601-1-git-send-email-robert.chiras@nxp.com>
References: <1567078215-31601-1-git-send-email-robert.chiras@nxp.com>
MIME-Version: 1.0
X-Virus-Scanned: ClamAV using ClamSMTP
X-Mailman-Approved-At: Fri, 30 Aug 2019 08:29:17 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: devicetree@vger.kernel.org, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, NXP Linux Team <linux-imx@nxp.com>,
 Pengutronix Kernel Team <kernel@pengutronix.de>,
 linux-arm-kernel@lists.infradead.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

U2luY2UgdmVyc2lvbiA0IG9mIGVMQ0RJRiwgdGhlcmUgYXJlIHNvbWUgcmVnaXN0ZXJzIHRoYXQg
Y2FuIGRvCnRyYW5zZm9ybWF0aW9ucyBvbiB0aGUgaW5wdXQgZGF0YSwgbGlrZSByZS1hcnJhbmdp
bmcgdGhlIHBpeGVsCmNvbXBvbmVudHMuIEJ5IGRvaW5nIHRoYXQsIHdlIGNhbiBzdXBwb3J0IG1v
cmUgcGl4ZWwgZm9ybWF0cy4KVGhpcyBwYXRjaCBhZGRzIHN1cHBvcnQgZm9yIFgvQUJHUiBhbmQg
UkdCWC9BLiBBbHRob3VnaCwgdGhlIGxvY2FsIGFscGhhCmlzIG5vdCBzdXBwb3J0ZWQgYnkgZUxD
RElGLCB0aGUgYWxwaGEgcGl4ZWwgZm9ybWF0cyB3ZXJlIGFkZGVkIHRvIHRoZQpzdXBwb3J0ZWQg
cGl4ZWwgZm9ybWF0cyBidXQgaXQgd2lsbCBiZSBpZ25vcmVkLiBUaGlzIHdhcyBuZWNlc3Nhcnkg
c2luY2UKdGhlcmUgYXJlIHN5c3RlbXMgKGxpa2UgQW5kcm9pZCkgdGhhdCByZXF1aXJlcyBzdWNo
IHBpeGVsIGZvcm1hdHMuCgpBbHNvLCBhZGQgc3VwcG9ydCBmb3IgdGhlIGZvbGxvd2luZyBwaXhl
bCBmb3JtYXRzOgogICAgICAgICAgICAxNiBicHA6IFJHMTYgLEJHMTYsIFhSMTUsIFhCMTUsIEFS
MTUsIEFCMTUKClNldCB0aGUgYnVzIGZvcm1hdCBiYXNlZCBvbiBpbnB1dCBmcm9tIHRoZSB1c2Vy
IGFuZCBwYW5lbApjYXBhYmlsaXRpZXMuClNhdmUgdGhlIGJ1cyBmb3JtYXQgaW4gY3J0Yy0+bW9k
ZS5wcml2YXRlX2ZsYWdzLCBzbyB0aGUgYnJpZGdlIGNhbgp1c2UgaXQuCgpTaWduZWQtb2ZmLWJ5
OiBSb2JlcnQgQ2hpcmFzIDxyb2JlcnQuY2hpcmFzQG54cC5jb20+ClNpZ25lZC1vZmYtYnk6IE1p
cmVsYSBSYWJ1bGVhIDxtaXJlbGEucmFidWxlYUBueHAuY29tPgpUZXN0ZWQtYnk6IEd1aWRvIEfD
vG50aGVyIDxhZ3hAc2lneGNwdS5vcmc+Ci0tLQogZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2Zi
X2NydGMuYyB8IDE0NyArKysrKysrKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tCiBkcml2
ZXJzL2dwdS9kcm0vbXhzZmIvbXhzZmJfZHJ2LmMgIHwgIDMwICsrKysrKy0tCiBkcml2ZXJzL2dw
dS9kcm0vbXhzZmIvbXhzZmJfZHJ2LmggIHwgICAzICstCiBkcml2ZXJzL2dwdS9kcm0vbXhzZmIv
bXhzZmJfcmVncy5oIHwgIDE1ICsrKysKIDQgZmlsZXMgY2hhbmdlZCwgMTYzIGluc2VydGlvbnMo
KyksIDMyIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9teHNmYi9t
eHNmYl9jcnRjLmMgYi9kcml2ZXJzL2dwdS9kcm0vbXhzZmIvbXhzZmJfY3J0Yy5jCmluZGV4IDVl
NDRmNTcuLjFiZTI5ZjUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9teHNmYi9teHNmYl9j
cnRjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX2NydGMuYwpAQCAtNDMsMTQg
KzQzLDE3IEBAIHN0YXRpYyB1MzIgc2V0X2hzeW5jX3B1bHNlX3dpZHRoKHN0cnVjdCBteHNmYl9k
cm1fcHJpdmF0ZSAqbXhzZmIsIHUzMiB2YWwpCiB9CiAKIC8qIFNldHVwIHRoZSBNWFNGQiByZWdp
c3RlcnMgZm9yIGRlY29kaW5nIHRoZSBwaXhlbHMgb3V0IG9mIHRoZSBmcmFtZWJ1ZmZlciAqLwot
c3RhdGljIGludCBteHNmYl9zZXRfcGl4ZWxfZm10KHN0cnVjdCBteHNmYl9kcm1fcHJpdmF0ZSAq
bXhzZmIpCitzdGF0aWMgaW50IG14c2ZiX3NldF9waXhlbF9mbXQoc3RydWN0IG14c2ZiX2RybV9w
cml2YXRlICpteHNmYiwgYm9vbCB1cGRhdGUpCiB7CiAJc3RydWN0IGRybV9jcnRjICpjcnRjID0g
Jm14c2ZiLT5waXBlLmNydGM7CiAJc3RydWN0IGRybV9kZXZpY2UgKmRybSA9IGNydGMtPmRldjsK
IAljb25zdCB1MzIgZm9ybWF0ID0gY3J0Yy0+cHJpbWFyeS0+c3RhdGUtPmZiLT5mb3JtYXQtPmZv
cm1hdDsKLQl1MzIgY3RybCwgY3RybDE7CisJdTMyIGN0cmwgPSAwLCBjdHJsMSA9IDA7CisJYm9v
bCBiZ3JfZm9ybWF0ID0gdHJ1ZTsKKwlzdHJ1Y3QgZHJtX2Zvcm1hdF9uYW1lX2J1ZiBmb3JtYXRf
bmFtZV9idWY7CiAKLQljdHJsID0gQ1RSTF9CWVBBU1NfQ09VTlQgfCBDVFJMX01BU1RFUjsKKwlp
ZiAoIXVwZGF0ZSkKKwkJY3RybCA9IENUUkxfQllQQVNTX0NPVU5UIHwgQ1RSTF9NQVNURVI7CiAK
IAkvKgogCSAqIFdBUk5JTkc6IFRoZSBidXMgd2lkdGgsIENUUkxfU0VUX0JVU19XSURUSCgpLCBp
cyBjb25maWd1cmVkIHRvCkBAIC01OSw2NCArNjIsMTU4IEBAIHN0YXRpYyBpbnQgbXhzZmJfc2V0
X3BpeGVsX2ZtdChzdHJ1Y3QgbXhzZmJfZHJtX3ByaXZhdGUgKm14c2ZiKQogCSAqIHRvIGFyYml0
cmFyeSB2YWx1ZS4gVGhpcyBsaW1pdGF0aW9uIHNob3VsZCBub3QgcG9zZSBhbiBpc3N1ZS4KIAkg
Ki8KIAotCS8qIENUUkwxIGNvbnRhaW5zIElSUSBjb25maWcgYW5kIHN0YXR1cyBiaXRzLCBwcmVz
ZXJ2ZSB0aG9zZS4gKi8KLQljdHJsMSA9IHJlYWRsKG14c2ZiLT5iYXNlICsgTENEQ19DVFJMMSk7
Ci0JY3RybDEgJj0gQ1RSTDFfQ1VSX0ZSQU1FX0RPTkVfSVJRX0VOIHwgQ1RSTDFfQ1VSX0ZSQU1F
X0RPTkVfSVJROworCWlmICghdXBkYXRlKSB7CisJCS8qIENUUkwxIGNvbnRhaW5zIElSUSBjb25m
aWcgYW5kIHN0YXR1cyBiaXRzLCBwcmVzZXJ2ZSB0aG9zZS4gKi8KKwkJY3RybDEgPSByZWFkbCht
eHNmYi0+YmFzZSArIExDRENfQ1RSTDEpOworCQljdHJsMSAmPSBDVFJMMV9DVVJfRlJBTUVfRE9O
RV9JUlFfRU4gfCBDVFJMMV9DVVJfRlJBTUVfRE9ORV9JUlE7CisJfQorCisJRFJNX0RFVl9ERUJV
R19EUklWRVIoZHJtLT5kZXYsICJTZXR0aW5nIHVwICVzIG1vZGVcbiIsCisJCQkgICAgIGRybV9n
ZXRfZm9ybWF0X25hbWUoZm9ybWF0LCAmZm9ybWF0X25hbWVfYnVmKSk7CisKKwkvKiBEbyBzb21l
IGNsZWFuLXVwIHRoYXQgd2UgbWlnaHQgaGF2ZSBmcm9tIGEgcHJldmlvdXMgbW9kZSAqLworCWN0
cmwgJj0gfkNUUkxfU0hJRlRfRElSKDEpOworCWN0cmwgJj0gfkNUUkxfU0hJRlRfTlVNKDB4M2Yp
OworCWlmIChteHNmYi0+ZGV2ZGF0YS0+aXB2ZXJzaW9uID49IDQpCisJCXdyaXRlbChDVFJMMl9P
RERfTElORV9QQVRURVJOKENUUkwyX0xJTkVfUEFUVEVSTl9DTFIpIHwKKwkJICAgICAgIENUUkwy
X0VWRU5fTElORV9QQVRURVJOKENUUkwyX0xJTkVfUEFUVEVSTl9DTFIpLAorCQkgICAgICAgbXhz
ZmItPmJhc2UgKyBMQ0RDX1Y0X0NUUkwyICsgUkVHX0NMUik7CiAKIAlzd2l0Y2ggKGZvcm1hdCkg
ewotCWNhc2UgRFJNX0ZPUk1BVF9SR0I1NjU6Ci0JCWRldl9kYmcoZHJtLT5kZXYsICJTZXR0aW5n
IHVwIFJHQjU2NSBtb2RlXG4iKTsKKwljYXNlIERSTV9GT1JNQVRfQkdSNTY1OiAvKiBCRzE2ICov
CisJCWlmIChteHNmYi0+ZGV2ZGF0YS0+aXB2ZXJzaW9uIDwgNCkKKwkJCWdvdG8gZXJyOworCQl3
cml0ZWwoQ1RSTDJfT0REX0xJTkVfUEFUVEVSTihDVFJMMl9MSU5FX1BBVFRFUk5fQkdSKSB8CisJ
CQlDVFJMMl9FVkVOX0xJTkVfUEFUVEVSTihDVFJMMl9MSU5FX1BBVFRFUk5fQkdSKSwKKwkJCW14
c2ZiLT5iYXNlICsgTENEQ19WNF9DVFJMMiArIFJFR19TRVQpOworCQkvKiBGYWxsIHRocm91Z2gg
Ki8KKwljYXNlIERSTV9GT1JNQVRfUkdCNTY1OiAvKiBSRzE2ICovCisJCWN0cmwgfD0gQ1RSTF9T
RVRfV09SRF9MRU5HVEgoMCk7CisJCWN0cmwgJj0gfkNUUkxfREYxNjsKKwkJY3RybDEgfD0gQ1RS
TDFfU0VUX0JZVEVfUEFDS0FHSU5HKDB4Zik7CisJCWJyZWFrOworCWNhc2UgRFJNX0ZPUk1BVF9Y
QkdSMTU1NTogLyogWEIxNSAqLworCWNhc2UgRFJNX0ZPUk1BVF9BQkdSMTU1NTogLyogQUIxNSAq
LworCQlpZiAobXhzZmItPmRldmRhdGEtPmlwdmVyc2lvbiA8IDQpCisJCQlnb3RvIGVycjsKKwkJ
d3JpdGVsKENUUkwyX09ERF9MSU5FX1BBVFRFUk4oQ1RSTDJfTElORV9QQVRURVJOX0JHUikgfAor
CQkJQ1RSTDJfRVZFTl9MSU5FX1BBVFRFUk4oQ1RSTDJfTElORV9QQVRURVJOX0JHUiksCisJCQlt
eHNmYi0+YmFzZSArIExDRENfVjRfQ1RSTDIgKyBSRUdfU0VUKTsKKwkJLyogRmFsbCB0aHJvdWdo
ICovCisJY2FzZSBEUk1fRk9STUFUX1hSR0IxNTU1OiAvKiBYUjE1ICovCisJY2FzZSBEUk1fRk9S
TUFUX0FSR0IxNTU1OiAvKiBBUjE1ICovCiAJCWN0cmwgfD0gQ1RSTF9TRVRfV09SRF9MRU5HVEgo
MCk7CisJCWN0cmwgfD0gQ1RSTF9ERjE2OwogCQljdHJsMSB8PSBDVFJMMV9TRVRfQllURV9QQUNL
QUdJTkcoMHhmKTsKIAkJYnJlYWs7Ci0JY2FzZSBEUk1fRk9STUFUX1hSR0I4ODg4OgotCQlkZXZf
ZGJnKGRybS0+ZGV2LCAiU2V0dGluZyB1cCBYUkdCODg4OCBtb2RlXG4iKTsKKwljYXNlIERSTV9G
T1JNQVRfUkdCWDg4ODg6IC8qIFJYMjQgKi8KKwljYXNlIERSTV9GT1JNQVRfUkdCQTg4ODg6IC8q
IFJBMjQgKi8KKwkJLyogUkdCWCAtID4gMFJHQiAqLworCQljdHJsIHw9IENUUkxfU0hJRlRfRElS
KDEpOworCQljdHJsIHw9IENUUkxfU0hJRlRfTlVNKDgpOworCQliZ3JfZm9ybWF0ID0gZmFsc2U7
CisJCS8qIEZhbGwgdGhyb3VnaCAqLworCWNhc2UgRFJNX0ZPUk1BVF9YQkdSODg4ODogLyogWEIy
NCAqLworCWNhc2UgRFJNX0ZPUk1BVF9BQkdSODg4ODogLyogQUIyNCAqLworCQlpZiAoYmdyX2Zv
cm1hdCkgeworCQkJaWYgKG14c2ZiLT5kZXZkYXRhLT5pcHZlcnNpb24gPCA0KQorCQkJCWdvdG8g
ZXJyOworCQkJd3JpdGVsKENUUkwyX09ERF9MSU5FX1BBVFRFUk4oQ1RSTDJfTElORV9QQVRURVJO
X0JHUikgfAorCQkJICAgICAgIENUUkwyX0VWRU5fTElORV9QQVRURVJOKENUUkwyX0xJTkVfUEFU
VEVSTl9CR1IpLAorCQkJICAgICAgIG14c2ZiLT5iYXNlICsgTENEQ19WNF9DVFJMMiArIFJFR19T
RVQpOworCQl9CisJCS8qIEZhbGwgdGhyb3VnaCAqLworCWNhc2UgRFJNX0ZPUk1BVF9YUkdCODg4
ODogLyogWFIyNCAqLworCWNhc2UgRFJNX0ZPUk1BVF9BUkdCODg4ODogLyogQVIyNCAqLwogCQlj
dHJsIHw9IENUUkxfU0VUX1dPUkRfTEVOR1RIKDMpOwogCQkvKiBEbyBub3QgdXNlIHBhY2tlZCBw
aXhlbHMgPSBvbmUgcGl4ZWwgcGVyIHdvcmQgaW5zdGVhZC4gKi8KIAkJY3RybDEgfD0gQ1RSTDFf
U0VUX0JZVEVfUEFDS0FHSU5HKDB4Nyk7CiAJCWJyZWFrOwogCWRlZmF1bHQ6Ci0JCWRldl9lcnIo
ZHJtLT5kZXYsICJVbmhhbmRsZWQgcGl4ZWwgZm9ybWF0ICUwOHhcbiIsIGZvcm1hdCk7Ci0JCXJl
dHVybiAtRUlOVkFMOworCQlnb3RvIGVycjsKIAl9CiAKLQl3cml0ZWwoY3RybDEsIG14c2ZiLT5i
YXNlICsgTENEQ19DVFJMMSk7Ci0Jd3JpdGVsKGN0cmwsIG14c2ZiLT5iYXNlICsgTENEQ19DVFJM
KTsKKwlpZiAodXBkYXRlKSB7CisJCXdyaXRlbChjdHJsLCBteHNmYi0+YmFzZSArIExDRENfQ1RS
TCArIFJFR19TRVQpOworCQl3cml0ZWwoY3RybDEsIG14c2ZiLT5iYXNlICsgTENEQ19DVFJMMSAr
IFJFR19TRVQpOworCX0gZWxzZSB7CisJCXdyaXRlbChjdHJsLCBteHNmYi0+YmFzZSArIExDRENf
Q1RSTCk7CisJCXdyaXRlbChjdHJsMSwgbXhzZmItPmJhc2UgKyBMQ0RDX0NUUkwxKTsKKwl9CiAK
IAlyZXR1cm4gMDsKKworZXJyOgorCURSTV9ERVZfRVJST1IoZHJtLT5kZXYsICJVbmhhbmRsZWQg
cGl4ZWwgZm9ybWF0OiAlc1xuIiwKKwkJICAgICAgZHJtX2dldF9mb3JtYXRfbmFtZShmb3JtYXQs
ICZmb3JtYXRfbmFtZV9idWYpKTsKKworCXJldHVybiAtRUlOVkFMOworfQorCitzdGF0aWMgdTMy
IGdldF9idXNfZm9ybWF0X2Zyb21fYnBwKHUzMiBicHApCit7CisJc3dpdGNoIChicHApIHsKKwlj
YXNlIDE2OgorCQlyZXR1cm4gTUVESUFfQlVTX0ZNVF9SR0I1NjVfMVgxNjsKKwljYXNlIDE4Ogor
CQlyZXR1cm4gTUVESUFfQlVTX0ZNVF9SR0I2NjZfMVgxODsKKwljYXNlIDI0OgorCQlyZXR1cm4g
TUVESUFfQlVTX0ZNVF9SR0I4ODhfMVgyNDsKKwlkZWZhdWx0OgorCQlyZXR1cm4gTUVESUFfQlVT
X0ZNVF9SR0I4ODhfMVgyNDsKKwl9CiB9CiAKIHN0YXRpYyB2b2lkIG14c2ZiX3NldF9idXNfZm10
KHN0cnVjdCBteHNmYl9kcm1fcHJpdmF0ZSAqbXhzZmIpCiB7CiAJc3RydWN0IGRybV9jcnRjICpj
cnRjID0gJm14c2ZiLT5waXBlLmNydGM7CisJdW5zaWduZWQgaW50IGJpdHNfcGVyX3BpeGVsID0g
Y3J0Yy0+cHJpbWFyeS0+c3RhdGUtPmZiLT5mb3JtYXQtPmRlcHRoOwogCXN0cnVjdCBkcm1fZGV2
aWNlICpkcm0gPSBjcnRjLT5kZXY7CiAJdTMyIGJ1c19mb3JtYXQgPSBNRURJQV9CVVNfRk1UX1JH
Qjg4OF8xWDI0OwotCXUzMiByZWc7Ci0KLQlyZWcgPSByZWFkbChteHNmYi0+YmFzZSArIExDRENf
Q1RSTCk7CisJaW50IG51bV9idXNfZm9ybWF0cyA9IG14c2ZiLT5jb25uZWN0b3ItPmRpc3BsYXlf
aW5mby5udW1fYnVzX2Zvcm1hdHM7CisJY29uc3QgdTMyICpidXNfZm9ybWF0cyA9IG14c2ZiLT5j
b25uZWN0b3ItPmRpc3BsYXlfaW5mby5idXNfZm9ybWF0czsKKwl1MzIgcmVnID0gMDsKKwlpbnQg
aSA9IDA7CisKKwkvKiBtYXRjaCB0aGUgdXNlciByZXF1ZXN0ZWQgYnVzX2Zvcm1hdCB0byBvbmUg
c3VwcG9ydGVkIGJ5IHRoZSBwYW5lbCAqLworCWlmIChudW1fYnVzX2Zvcm1hdHMpIHsKKwkJdTMy
IHVzZXJfYnVzX2Zvcm1hdCA9IGdldF9idXNfZm9ybWF0X2Zyb21fYnBwKGJpdHNfcGVyX3BpeGVs
KTsKKworCQlidXNfZm9ybWF0ID0gYnVzX2Zvcm1hdHNbMF07CisJCWZvciAoaSA9IDA7IGkgPCBu
dW1fYnVzX2Zvcm1hdHM7IGkrKykgeworCQkJaWYgKHVzZXJfYnVzX2Zvcm1hdCA9PSBidXNfZm9y
bWF0c1tpXSkgeworCQkJCWJ1c19mb3JtYXQgPSB1c2VyX2J1c19mb3JtYXQ7CisJCQkJYnJlYWs7
CisJCQl9CisJCX0KKwl9CiAKLQlpZiAobXhzZmItPmNvbm5lY3Rvci0+ZGlzcGxheV9pbmZvLm51
bV9idXNfZm9ybWF0cykKLQkJYnVzX2Zvcm1hdCA9IG14c2ZiLT5jb25uZWN0b3ItPmRpc3BsYXlf
aW5mby5idXNfZm9ybWF0c1swXTsKKwkvKgorCSAqIENSVEMgd2lsbCBkaWN0YXRlIHRoZSBidXMg
Zm9ybWF0IHZpYSBwcml2YXRlX2ZsYWdzWzE2OjFdCisJICogYW5kIHByaXZhdGVfZmxhZ3NbMF0g
d2lsbCBzaWduYWwgYSBidXMgZm9ybWF0IGNoYW5nZQorCSAqLworCWNydGMtPm1vZGUucHJpdmF0
ZV9mbGFncyAmPSB+MHgxRkZGRjsgLyogY2xlYXIgYnVzIGZvcm1hdCAqLworCWNydGMtPm1vZGUu
cHJpdmF0ZV9mbGFncyB8PSAoYnVzX2Zvcm1hdCA8PCAxKTsgLyogc2V0IGJ1cyBmb3JtYXQgKi8K
KwljcnRjLT5tb2RlLnByaXZhdGVfZmxhZ3MgfD0gMHgxOyAvKiBidXMgZm9ybWF0IGNoYW5nZSBp
bmRpY2F0aW9uKi8KIAogCURSTV9ERVZfREVCVUdfRFJJVkVSKGRybS0+ZGV2LCAiVXNpbmcgYnVz
X2Zvcm1hdDogMHglMDhYXG4iLAogCQkJICAgICBidXNfZm9ybWF0KTsKIAotCXJlZyAmPSB+Q1RS
TF9CVVNfV0lEVEhfTUFTSzsKIAlzd2l0Y2ggKGJ1c19mb3JtYXQpIHsKIAljYXNlIE1FRElBX0JV
U19GTVRfUkdCNTY1XzFYMTY6Ci0JCXJlZyB8PSBDVFJMX1NFVF9CVVNfV0lEVEgoU1RNTENESUZf
MTZCSVQpOworCQlyZWcgPSBDVFJMX1NFVF9CVVNfV0lEVEgoU1RNTENESUZfMTZCSVQpOwogCQli
cmVhazsKIAljYXNlIE1FRElBX0JVU19GTVRfUkdCNjY2XzFYMTg6Ci0JCXJlZyB8PSBDVFJMX1NF
VF9CVVNfV0lEVEgoU1RNTENESUZfMThCSVQpOworCQlyZWcgPSBDVFJMX1NFVF9CVVNfV0lEVEgo
U1RNTENESUZfMThCSVQpOwogCQlicmVhazsKIAljYXNlIE1FRElBX0JVU19GTVRfUkdCODg4XzFY
MjQ6Ci0JCXJlZyB8PSBDVFJMX1NFVF9CVVNfV0lEVEgoU1RNTENESUZfMjRCSVQpOworCQlyZWcg
PSBDVFJMX1NFVF9CVVNfV0lEVEgoU1RNTENESUZfMjRCSVQpOwogCQlicmVhazsKIAlkZWZhdWx0
OgogCQlkZXZfZXJyKGRybS0+ZGV2LCAiVW5rbm93biBtZWRpYSBidXMgZm9ybWF0ICVkXG4iLCBi
dXNfZm9ybWF0KTsKIAkJYnJlYWs7CiAJfQotCXdyaXRlbChyZWcsIG14c2ZiLT5iYXNlICsgTENE
Q19DVFJMKTsKKwl3cml0ZWwocmVnLCBteHNmYi0+YmFzZSArIExDRENfQ1RSTCArIFJFR19TRVQp
OwogfQogCiBzdGF0aWMgdm9pZCBteHNmYl9lbmFibGVfY29udHJvbGxlcihzdHJ1Y3QgbXhzZmJf
ZHJtX3ByaXZhdGUgKm14c2ZiKQpAQCAtMjM4LDcgKzMzNSw3IEBAIHN0YXRpYyB2b2lkIG14c2Zi
X2NydGNfbW9kZV9zZXRfbm9mYihzdHJ1Y3QgbXhzZmJfZHJtX3ByaXZhdGUgKm14c2ZiKQogCS8q
IENsZWFyIHRoZSBGSUZPcyAqLwogCXdyaXRlbChDVFJMMV9GSUZPX0NMRUFSLCBteHNmYi0+YmFz
ZSArIExDRENfQ1RSTDEgKyBSRUdfU0VUKTsKIAotCWVyciA9IG14c2ZiX3NldF9waXhlbF9mbXQo
bXhzZmIpOworCWVyciA9IG14c2ZiX3NldF9waXhlbF9mbXQobXhzZmIsIGZhbHNlKTsKIAlpZiAo
ZXJyKQogCQlyZXR1cm47CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9teHNmYi9teHNm
Yl9kcnYuYyBiL2RyaXZlcnMvZ3B1L2RybS9teHNmYi9teHNmYl9kcnYuYwppbmRleCA0OTdjZjQ0
Li4yMzAyN2E5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbXhzZmIvbXhzZmJfZHJ2LmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX2Rydi5jCkBAIC00Myw2ICs0MywyNyBA
QCBlbnVtIG14c2ZiX2RldnR5cGUgewogCU1YU0ZCX1Y0LAogfTsKIAorLyoKKyAqIFdoZW4gYWRk
aW5nIG5ldyBmb3JtYXRzLCBtYWtlIHN1cmUgdG8gdXBkYXRlIHRoZSBudW1fZm9ybWF0cyBmcm9t
CisgKiBteHNmYl9kZXZkYXRhIGJlbG93LgorICovCitzdGF0aWMgY29uc3QgdTMyIG14c2ZiX2Zv
cm1hdHNbXSA9IHsKKwkvKiBNWFNGQl9WMyAqLworCURSTV9GT1JNQVRfWFJHQjg4ODgsCisJRFJN
X0ZPUk1BVF9BUkdCODg4OCwKKwlEUk1fRk9STUFUX1JHQjU2NSwKKwkvKiBNWFNGQl9WNCAqLwor
CURSTV9GT1JNQVRfWEJHUjg4ODgsCisJRFJNX0ZPUk1BVF9BQkdSODg4OCwKKwlEUk1fRk9STUFU
X1JHQlg4ODg4LAorCURSTV9GT1JNQVRfUkdCQTg4ODgsCisJRFJNX0ZPUk1BVF9BUkdCMTU1NSwK
KwlEUk1fRk9STUFUX1hSR0IxNTU1LAorCURSTV9GT1JNQVRfQUJHUjE1NTUsCisJRFJNX0ZPUk1B
VF9YQkdSMTU1NSwKKwlEUk1fRk9STUFUX0JHUjU2NQorfTsKKwogc3RhdGljIGNvbnN0IHN0cnVj
dCBteHNmYl9kZXZkYXRhIG14c2ZiX2RldmRhdGFbXSA9IHsKIAlbTVhTRkJfVjNdID0gewogCQku
dHJhbnNmZXJfY291bnQJPSBMQ0RDX1YzX1RSQU5TRkVSX0NPVU5ULApAQCAtNTIsNiArNzMsNyBA
QCBzdGF0aWMgY29uc3Qgc3RydWN0IG14c2ZiX2RldmRhdGEgbXhzZmJfZGV2ZGF0YVtdID0gewog
CQkuaHNfd2R0aF9tYXNrCT0gMHhmZiwKIAkJLmhzX3dkdGhfc2hpZnQJPSAyNCwKIAkJLmlwdmVy
c2lvbgk9IDMsCisJCS5udW1fZm9ybWF0cwk9IDMsCiAJfSwKIAlbTVhTRkJfVjRdID0gewogCQku
dHJhbnNmZXJfY291bnQJPSBMQ0RDX1Y0X1RSQU5TRkVSX0NPVU5ULApAQCAtNjEsMTQgKzgzLDEw
IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgbXhzZmJfZGV2ZGF0YSBteHNmYl9kZXZkYXRhW10gPSB7
CiAJCS5oc193ZHRoX21hc2sJPSAweDNmZmYsCiAJCS5oc193ZHRoX3NoaWZ0CT0gMTgsCiAJCS5p
cHZlcnNpb24JPSA0LAorCQkubnVtX2Zvcm1hdHMJPSBBUlJBWV9TSVpFKG14c2ZiX2Zvcm1hdHMp
LAogCX0sCiB9OwogCi1zdGF0aWMgY29uc3QgdWludDMyX3QgbXhzZmJfZm9ybWF0c1tdID0gewot
CURSTV9GT1JNQVRfWFJHQjg4ODgsCi0JRFJNX0ZPUk1BVF9SR0I1NjUKLX07Ci0KIHN0YXRpYyBz
dHJ1Y3QgbXhzZmJfZHJtX3ByaXZhdGUgKgogZHJtX3BpcGVfdG9fbXhzZmJfZHJtX3ByaXZhdGUo
c3RydWN0IGRybV9zaW1wbGVfZGlzcGxheV9waXBlICpwaXBlKQogewpAQCAtMjQ0LDcgKzI2Miw3
IEBAIHN0YXRpYyBpbnQgbXhzZmJfbG9hZChzdHJ1Y3QgZHJtX2RldmljZSAqZHJtLCB1bnNpZ25l
ZCBsb25nIGZsYWdzKQogCX0KIAogCXJldCA9IGRybV9zaW1wbGVfZGlzcGxheV9waXBlX2luaXQo
ZHJtLCAmbXhzZmItPnBpcGUsICZteHNmYl9mdW5jcywKLQkJCW14c2ZiX2Zvcm1hdHMsIEFSUkFZ
X1NJWkUobXhzZmJfZm9ybWF0cyksIE5VTEwsCisJCQlteHNmYl9mb3JtYXRzLCBteHNmYi0+ZGV2
ZGF0YS0+bnVtX2Zvcm1hdHMsIE5VTEwsCiAJCQlteHNmYi0+Y29ubmVjdG9yKTsKIAlpZiAocmV0
IDwgMCkgewogCQlkZXZfZXJyKGRybS0+ZGV2LCAiQ2Fubm90IHNldHVwIHNpbXBsZSBkaXNwbGF5
IHBpcGVcbiIpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX2Rydi5o
IGIvZHJpdmVycy9ncHUvZHJtL214c2ZiL214c2ZiX2Rydi5oCmluZGV4IDBiNjViNTEuLjhmYjY1
ZDMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9teHNmYi9teHNmYl9kcnYuaAorKysgYi9k
cml2ZXJzL2dwdS9kcm0vbXhzZmIvbXhzZmJfZHJ2LmgKQEAgLTE2LDYgKzE2LDcgQEAgc3RydWN0
IG14c2ZiX2RldmRhdGEgewogCXVuc2lnbmVkIGludAkgaHNfd2R0aF9tYXNrOwogCXVuc2lnbmVk
IGludAkgaHNfd2R0aF9zaGlmdDsKIAl1bnNpZ25lZCBpbnQJIGlwdmVyc2lvbjsKKwl1bnNpZ25l
ZCBpbnQJIG51bV9mb3JtYXRzOwogfTsKIAogc3RydWN0IG14c2ZiX2RybV9wcml2YXRlIHsKQEAg
LTQyLDYgKzQzLDYgQEAgdm9pZCBteHNmYl9kaXNhYmxlX2F4aV9jbGsoc3RydWN0IG14c2ZiX2Ry
bV9wcml2YXRlICpteHNmYik7CiB2b2lkIG14c2ZiX2NydGNfZW5hYmxlKHN0cnVjdCBteHNmYl9k
cm1fcHJpdmF0ZSAqbXhzZmIpOwogdm9pZCBteHNmYl9jcnRjX2Rpc2FibGUoc3RydWN0IG14c2Zi
X2RybV9wcml2YXRlICpteHNmYik7CiB2b2lkIG14c2ZiX3BsYW5lX2F0b21pY191cGRhdGUoc3Ry
dWN0IG14c2ZiX2RybV9wcml2YXRlICpteHNmYiwKLQkJCSAgICAgICBzdHJ1Y3QgZHJtX3BsYW5l
X3N0YXRlICpzdGF0ZSk7CisJCQkgICAgICAgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqb2xkX3N0
YXRlKTsKIAogI2VuZGlmIC8qIF9fTVhTRkJfRFJWX0hfXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL214c2ZiL214c2ZiX3JlZ3MuaCBiL2RyaXZlcnMvZ3B1L2RybS9teHNmYi9teHNm
Yl9yZWdzLmgKaW5kZXggOWZjYjFkYi4uZGM0ZGFhMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL214c2ZiL214c2ZiX3JlZ3MuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbXhzZmIvbXhzZmJf
cmVncy5oCkBAIC00NCw2ICs0NCwxMSBAQAogI2RlZmluZSBSRUdfUFVUKHgsIGgsIGwpICgoKHgp
IDw8IChsKSkgJiBHRU5NQVNLKGgsIGwpKQogI2RlZmluZSBSRUdfR0VUKHgsIGgsIGwpICgoKHgp
ICYgR0VOTUFTSyhoLCBsKSkgPj4gKGwpKQogCisjZGVmaW5lIFNXSVpaTEVfTEUJCTAgLyogTGl0
dGxlLUVuZGlhbiBvciBObyBzd2FwICovCisjZGVmaW5lIFNXSVpaTEVfQkUJCTEgLyogQmlnLUVu
ZGlhbiBvciBzd2FwIGFsbCAqLworI2RlZmluZSBTV0laWkxFX0hXRAkJMiAvKiBTd2FwIGhhbGYt
d29yZHMgKi8KKyNkZWZpbmUgU1dJWlpMRV9IV0RfQllURQkzIC8qIFN3YXAgYnl0ZXMgd2l0aGlu
IGVhY2ggaGFsZi13b3JkICovCisKICNkZWZpbmUgQ1RSTF9TRlRSU1QJCQlCSVQoMzEpCiAjZGVm
aW5lIENUUkxfQ0xLR0FURQkJCUJJVCgzMCkKICNkZWZpbmUgQ1RSTF9TSElGVF9ESVIoeCkJCVJF
R19QVVQoKHgpLCAyNiwgMjYpCkBAIC05Myw2ICs5OCwxNiBAQAogI2RlZmluZSBSRVFfOAkzCiAj
ZGVmaW5lIFJFUV8xNgk0CiAKKyNkZWZpbmUgQ1RSTDJfT0REX0xJTkVfUEFUVEVSTih4KQlSRUdf
UFVUKCh4KSwgMTgsIDE2KQorI2RlZmluZSBDVFJMMl9FVkVOX0xJTkVfUEFUVEVSTih4KQlSRUdf
UFVUKCh4KSwgMTQsIDEyKQorI2RlZmluZSBDVFJMMl9MSU5FX1BBVFRFUk5fUkdCCTAKKyNkZWZp
bmUgQ1RSTDJfTElORV9QQVRURVJOX1JCRwkxCisjZGVmaW5lIENUUkwyX0xJTkVfUEFUVEVSTl9H
QlIJMgorI2RlZmluZSBDVFJMMl9MSU5FX1BBVFRFUk5fR1JCCTMKKyNkZWZpbmUgQ1RSTDJfTElO
RV9QQVRURVJOX0JSRwk0CisjZGVmaW5lIENUUkwyX0xJTkVfUEFUVEVSTl9CR1IJNQorI2RlZmlu
ZSBDVFJMMl9MSU5FX1BBVFRFUk5fQ0xSCTcKKwogI2RlZmluZSBUUkFOU0ZFUl9DT1VOVF9TRVRf
VkNPVU5UKHgpCVJFR19QVVQoKHgpLCAzMSwgMTYpCiAjZGVmaW5lIFRSQU5TRkVSX0NPVU5UX0dF
VF9WQ09VTlQoeCkJUkVHX0dFVCgoeCksIDMxLCAxNikKICNkZWZpbmUgVFJBTlNGRVJfQ09VTlRf
U0VUX0hDT1VOVCh4KQlSRUdfUFVUKCh4KSwgMTUsIDApCi0tIAoyLjcuNAoKX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlz
dApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0
b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
