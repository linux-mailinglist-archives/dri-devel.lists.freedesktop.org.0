Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 97737108B5
	for <lists+dri-devel@lfdr.de>; Wed,  1 May 2019 16:03:17 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D31018930F;
	Wed,  1 May 2019 14:03:07 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mga09.intel.com (mga09.intel.com [134.134.136.24])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5883C8930F;
 Wed,  1 May 2019 14:03:06 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga008.fm.intel.com ([10.253.24.58])
 by orsmga102.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 01 May 2019 07:03:06 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.60,417,1549958400"; d="scan'208";a="145141415"
Received: from nperf12.hd.intel.com ([10.127.88.161])
 by fmsmga008.fm.intel.com with ESMTP; 01 May 2019 07:03:04 -0700
From: Brian Welty <brian.welty@intel.com>
To: cgroups@vger.kernel.org, Tejun Heo <tj@kernel.org>,
 Li Zefan <lizefan@huawei.com>, Johannes Weiner <hannes@cmpxchg.org>,
 linux-mm@kvack.org, Michal Hocko <mhocko@kernel.org>,
 Vladimir Davydov <vdavydov.dev@gmail.com>, dri-devel@lists.freedesktop.org,
 David Airlie <airlied@linux.ie>, Daniel Vetter <daniel@ffwll.ch>,
 intel-gfx@lists.freedesktop.org, Jani Nikula <jani.nikula@linux.intel.com>,
 Joonas Lahtinen <joonas.lahtinen@linux.intel.com>,
 Rodrigo Vivi <rodrigo.vivi@intel.com>,
 =?UTF-8?q?Christian=20K=C3=B6nig?= <christian.koenig@amd.com>,
 Alex Deucher <alexander.deucher@amd.com>,
 ChunMing Zhou <David1.Zhou@amd.com>,
 =?UTF-8?q?J=C3=A9r=C3=B4me=20Glisse?= <jglisse@redhat.com>
Subject: [RFC PATCH 4/5] drm: Add memory cgroup registration and
 DRIVER_CGROUPS feature bit
Date: Wed,  1 May 2019 10:04:37 -0400
Message-Id: <20190501140438.9506-5-brian.welty@intel.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190501140438.9506-1-brian.welty@intel.com>
References: <20190501140438.9506-1-brian.welty@intel.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

V2l0aCBuZXcgY2dyb3VwcyBwZXItZGV2aWNlIGZyYW1ld29yaywgcmVnaXN0cmF0aW9uIHdpdGgg
bWVtb3J5IGNncm91cApzdWJzeXN0ZW0gY2FuIGFsbG93IHVzIHRvIGVuZm9yY2UgbGltaXQgZm9y
IGFsbG9jYXRpb24gb2YgZGV2aWNlIG1lbW9yeQphZ2FpbnN0IHByb2Nlc3MgY2dyb3Vwcy4KClRo
aXMgcGF0Y2ggYWRkcyBuZXcgZHJpdmVyIGZlYXR1cmUgYml0LCBEUklWRVJfQ0dST1VQUywgc3Vj
aCB0aGF0IERSTQp3aWxsIHJlZ2lzdGVyIHRoZSBkZXZpY2Ugd2l0aCBjZ3JvdXBzLiBEb2luZyBz
byBhbGxvd3MgZGV2aWNlIGRyaXZlcnMgdG8KY2hhcmdlIG1lbW9yeSBhbGxvY2F0aW9ucyB0byBk
ZXZpY2Utc3BlY2lmaWMgc3RhdGUgd2l0aGluIHRoZSBjZ3JvdXAuCgpOb3RlLCB0aGlzIGlzIG9u
bHkgZm9yIEdFTSBvYmplY3RzIGFsbG9jYXRlZCBmcm9tIGRldmljZSBtZW1vcnkuCk1lbW9yeSBj
aGFyZ2luZyBmb3IgR0VNIG9iamVjdHMgdXNpbmcgc3lzdGVtIG1lbW9yeSBpcyBhbHJlYWR5IGhh
bmRsZWQKYnkgdGhlIG1tIHN1YnN5c3RlbSBjaGFyaW5nIHRoZSBub3JtYWwgKG5vbi1kZXZpY2Up
IG1lbW9yeSBjZ3JvdXAuCgpUbyBjaGFyZ2UgZGV2aWNlIG1lbW9yeSBhbGxvY2F0aW9ucywgd2Ug
bmVlZCB0byAoMSkgaWRlbnRpZnkgYXBwcm9wcmlhdGUKY2dyb3VwIHRvIGNoYXJnZSAoY3VycmVu
dGx5IGRlY2lkZWQgYXQgb2JqZWN0IGNyZWF0aW9uIHRpbWUpLCBhbmQgKDIpCm1ha2UgdGhlIGNo
YXJnaW5nIGNhbGwgYXQgdGhlIHRpbWUgdGhhdCBtZW1vcnkgcGFnZXMgYXJlIGJlaW5nIGFsbG9j
YXRlZC4KQWJvdmUgaXMgb25lIHBvbGljeSwgYW5kIHRoaXMgaXMgb3BlbiBmb3IgZGViYXRlIGlm
IHRoaXMgaXMgdGhlIHJpZ2h0CmNob2ljZS4KCkZvciAoMSksIHdlIGFzc29jaWF0ZSB0aGUgY3Vy
cmVudCB0YXNrJ3MgY2dyb3VwIHdpdGggR0VNIG9iamVjdHMgYXMgdGhleQphcmUgY3JlYXRlZC4g
IFRoYXQgY2dyb3VwIHdpbGwgYmUgY2hhcmdlZC91bmNoYXJnZWQgZm9yIGFsbCBwYWdpbmcKYWN0
aXZpdHkgYWdhaW5zdCB0aGUgR0VNIG9iamVjdC4gIE5vdGUsIGlmIHRoZSBwcm9jZXNzIGlzIG5v
dCBwYXJ0IG9mIGEKbWVtb3J5IGNncm91cCwgdGhlbiB0aGlzIHJldHVybnMgTlVMTCBhbmQgbm8g
Y2hhcmdpbmcgd2lsbCBvY2N1ci4KRm9yIHNoYXJlZCBvYmplY3RzLCB0aGlzIG1heSBtYWtlIHRo
ZSBjaGFyZ2UgYWdhaW5zdCBhIGNncm91cCB0aGF0IGlzCnBvdGVudGlhbGx5IG5vdCB0aGUgc2Ft
ZSBjZ3JvdXAgYXMgdGhlIHByb2Nlc3MgdXNpbmcgdGhlIG1lbW9yeS4gIEJhc2VkCm9uIHRoZSBt
ZW1vcnkgY2dyb3VwJ3MgZGlzY3Vzc2lvbiBvZiAibWVtb3J5IG93bmVyc2hpcCIsIHRoaXMgc2Vl
bXMKYWNjZXB0YWJsZSBbMV0uICBGb3IgKDIpLCB0aGlzIGlzIGZvciBkZXZpY2UgZHJpdmVycyB0
byBpbXBsZW1lbnQgd2l0aGluCmFwcHJvcHJpYXRlIHBhZ2UgYWxsb2NhdGlvbiBsb2dpYy4KClsx
XSBodHRwczovL3d3dy5rZXJuZWwub3JnL2RvYy9Eb2N1bWVudGF0aW9uL2Nncm91cC12Mi50eHQs
ICJNZW1vcnkgT3duZXJzaGlwIgoKQ2M6IGNncm91cHNAdmdlci5rZXJuZWwub3JnCkNjOiBsaW51
eC1tbUBrdmFjay5vcmcKQ2M6IGRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKQ2M6IE1h
dHQgUm9wZXIgPG1hdHRoZXcuZC5yb3BlckBpbnRlbC5jb20+ClNpZ25lZC1vZmYtYnk6IEJyaWFu
IFdlbHR5IDxicmlhbi53ZWx0eUBpbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2RybV9k
cnYuYyB8IDEyICsrKysrKysrKysrKwogZHJpdmVycy9ncHUvZHJtL2RybV9nZW0uYyB8ICA3ICsr
KysrKysKIGluY2x1ZGUvZHJtL2RybV9kZXZpY2UuaCAgfCAgMyArKysKIGluY2x1ZGUvZHJtL2Ry
bV9kcnYuaCAgICAgfCAgOCArKysrKysrKwogaW5jbHVkZS9kcm0vZHJtX2dlbS5oICAgICB8IDEx
ICsrKysrKysrKysrCiA1IGZpbGVzIGNoYW5nZWQsIDQxIGluc2VydGlvbnMoKykKCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2Rydi5jIGIvZHJpdmVycy9ncHUvZHJtL2RybV9kcnYu
YwppbmRleCA4NjI2MjE0OTRhOTMuLjg5MGJkM2MwZTYzZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2RybV9kcnYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX2Rydi5jCkBAIC0yOCw2
ICsyOCw3IEBACiAKICNpbmNsdWRlIDxsaW51eC9kZWJ1Z2ZzLmg+CiAjaW5jbHVkZSA8bGludXgv
ZnMuaD4KKyNpbmNsdWRlIDxsaW51eC9tZW1jb250cm9sLmg+CiAjaW5jbHVkZSA8bGludXgvbW9k
dWxlLmg+CiAjaW5jbHVkZSA8bGludXgvbW9kdWxlcGFyYW0uaD4KICNpbmNsdWRlIDxsaW51eC9t
b3VudC5oPgpAQCAtOTg3LDYgKzk4OCwxMiBAQCBpbnQgZHJtX2Rldl9yZWdpc3RlcihzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2LCB1bnNpZ25lZCBsb25nIGZsYWdzKQogCWlmIChyZXQpCiAJCWdvdG8g
ZXJyX21pbm9yczsKIAorCWlmIChkZXYtPmRldiAmJiBkcm1fY29yZV9jaGVja19mZWF0dXJlKGRl
diwgRFJJVkVSX0NHUk9VUFMpKSB7CisJCXJldCA9IG1lbV9jZ3JvdXBfZGV2aWNlX3JlZ2lzdGVy
KGRldi0+ZGV2LCAmZGV2LT5tZW1jZ19pZCk7CisJCWlmIChyZXQpCisJCQlnb3RvIGVycl9taW5v
cnM7CisJfQorCiAJZGV2LT5yZWdpc3RlcmVkID0gdHJ1ZTsKIAogCWlmIChkZXYtPmRyaXZlci0+
bG9hZCkgewpAQCAtMTAwOSw2ICsxMDE2LDggQEAgaW50IGRybV9kZXZfcmVnaXN0ZXIoc3RydWN0
IGRybV9kZXZpY2UgKmRldiwgdW5zaWduZWQgbG9uZyBmbGFncykKIAlnb3RvIG91dF91bmxvY2s7
CiAKIGVycl9taW5vcnM6CisJaWYgKGRldi0+bWVtY2dfaWQpCisJCW1lbV9jZ3JvdXBfZGV2aWNl
X3VucmVnaXN0ZXIoZGV2LT5tZW1jZ19pZCk7CiAJcmVtb3ZlX2NvbXBhdF9jb250cm9sX2xpbmso
ZGV2KTsKIAlkcm1fbWlub3JfdW5yZWdpc3RlcihkZXYsIERSTV9NSU5PUl9QUklNQVJZKTsKIAlk
cm1fbWlub3JfdW5yZWdpc3RlcihkZXYsIERSTV9NSU5PUl9SRU5ERVIpOwpAQCAtMTA1Miw2ICsx
MDYxLDkgQEAgdm9pZCBkcm1fZGV2X3VucmVnaXN0ZXIoc3RydWN0IGRybV9kZXZpY2UgKmRldikK
IAogCWRybV9sZWdhY3lfcm1tYXBzKGRldik7CiAKKwlpZiAoZGV2LT5tZW1jZ19pZCkKKwkJbWVt
X2Nncm91cF9kZXZpY2VfdW5yZWdpc3RlcihkZXYtPm1lbWNnX2lkKTsKKwogCXJlbW92ZV9jb21w
YXRfY29udHJvbF9saW5rKGRldik7CiAJZHJtX21pbm9yX3VucmVnaXN0ZXIoZGV2LCBEUk1fTUlO
T1JfUFJJTUFSWSk7CiAJZHJtX21pbm9yX3VucmVnaXN0ZXIoZGV2LCBEUk1fTUlOT1JfUkVOREVS
KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtLmMgYi9kcml2ZXJzL2dwdS9k
cm0vZHJtX2dlbS5jCmluZGV4IDUwZGUxMzhjODllMC4uOTY2ZmJkNzAxZGViIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vZHJtX2dlbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2Vt
LmMKQEAgLTM4LDYgKzM4LDcgQEAKICNpbmNsdWRlIDxsaW51eC9kbWEtYnVmLmg+CiAjaW5jbHVk
ZSA8bGludXgvbWVtX2VuY3J5cHQuaD4KICNpbmNsdWRlIDxsaW51eC9wYWdldmVjLmg+CisjaW5j
bHVkZSA8bGludXgvbWVtY29udHJvbC5oPgogI2luY2x1ZGUgPGRybS9kcm1QLmg+CiAjaW5jbHVk
ZSA8ZHJtL2RybV92bWFfbWFuYWdlci5oPgogI2luY2x1ZGUgPGRybS9kcm1fZ2VtLmg+CkBAIC0y
ODEsNiArMjgyLDkgQEAgZHJtX2dlbV9oYW5kbGVfZGVsZXRlKHN0cnVjdCBkcm1fZmlsZSAqZmls
cCwgdTMyIGhhbmRsZSkKIAlpZiAoSVNfRVJSX09SX05VTEwob2JqKSkKIAkJcmV0dXJuIC1FSU5W
QUw7CiAKKwkvKiBSZWxlYXNlIHJlZmVyZW5jZSBvbiBjZ3JvdXAgdXNlZCB3aXRoIEdFTSBvYmpl
Y3QgY2hhcmdpbmcgKi8KKwltZW1fY2dyb3VwX3B1dChvYmotPm1lbWNnKTsKKwogCS8qIFJlbGVh
c2UgZHJpdmVyJ3MgcmVmZXJlbmNlIGFuZCBkZWNyZW1lbnQgcmVmY291bnQuICovCiAJZHJtX2dl
bV9vYmplY3RfcmVsZWFzZV9oYW5kbGUoaGFuZGxlLCBvYmosIGZpbHApOwogCkBAIC00MTAsNiAr
NDE0LDkgQEAgZHJtX2dlbV9oYW5kbGVfY3JlYXRlX3RhaWwoc3RydWN0IGRybV9maWxlICpmaWxl
X3ByaXYsCiAJCQlnb3RvIGVycl9yZXZva2U7CiAJfQogCisJLyogQWNxdWlyZSByZWZlcmVuY2Ug
b24gY2dyb3VwIGZvciBjaGFyZ2luZyBHRU0gbWVtb3J5IGFsbG9jYXRpb25zICovCisJb2JqLT5t
ZW1jZyA9IG1lbV9jZ3JvdXBfZGV2aWNlX2Zyb21fdGFzayhkZXYtPm1lbWNnX2lkLCBjdXJyZW50
KTsKKwogCSpoYW5kbGVwID0gaGFuZGxlOwogCXJldHVybiAwOwogCmRpZmYgLS1naXQgYS9pbmNs
dWRlL2RybS9kcm1fZGV2aWNlLmggYi9pbmNsdWRlL2RybS9kcm1fZGV2aWNlLmgKaW5kZXggN2Y5
ZWY3MDliMmI2Li45ODU5ZjIyODkwNjYgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvZHJtL2RybV9kZXZp
Y2UuaAorKysgYi9pbmNsdWRlL2RybS9kcm1fZGV2aWNlLmgKQEAgLTE5MCw2ICsxOTAsOSBAQCBz
dHJ1Y3QgZHJtX2RldmljZSB7CiAJICovCiAJaW50IGlycTsKIAorCS8qIEBtZW1jZ19pZDogY2dy
b3VwIHN1YnN5cyAobWVtY2cpIGluZGV4IGZvciBvdXIgZGV2aWNlIHN0YXRlICovCisJdW5zaWdu
ZWQgbG9uZyBtZW1jZ19pZDsKKwogCS8qKgogCSAqIEB2YmxhbmtfZGlzYWJsZV9pbW1lZGlhdGU6
CiAJICoKZGlmZiAtLWdpdCBhL2luY2x1ZGUvZHJtL2RybV9kcnYuaCBiL2luY2x1ZGUvZHJtL2Ry
bV9kcnYuaAppbmRleCA1Y2M3ZjcyOGVjNzMuLjEzYjBlMGI5NTI3ZiAxMDA2NDQKLS0tIGEvaW5j
bHVkZS9kcm0vZHJtX2Rydi5oCisrKyBiL2luY2x1ZGUvZHJtL2RybV9kcnYuaApAQCAtOTIsNiAr
OTIsMTQgQEAgZW51bSBkcm1fZHJpdmVyX2ZlYXR1cmUgewogCSAqLwogCURSSVZFUl9TWU5DT0JK
ICAgICAgICAgICAgICAgICAgPSBCSVQoNSksCiAKKwkvKioKKwkgKiBARFJJVkVSX0NHUk9VUFM6
CisJICoKKwkgKiBEcml2ZXIgc3VwcG9ydHMgYW5kIHJlcXVlc3RzIERSTSB0byByZWdpc3RlciB3
aXRoIGNncm91cHMgZHVyaW5nCisJICogZHJtX2Rldl9yZWdpc3RlcigpLgorCSAqLworCURSSVZF
Ul9DR1JPVVBTCQkJPSBCSVQoNiksCisKIAkvKiBJTVBPUlRBTlQ6IEJlbG93IGFyZSBhbGwgdGhl
IGxlZ2FjeSBmbGFncywgYWRkIG5ldyBvbmVzIGFib3ZlLiAqLwogCiAJLyoqCmRpZmYgLS1naXQg
YS9pbmNsdWRlL2RybS9kcm1fZ2VtLmggYi9pbmNsdWRlL2RybS9kcm1fZ2VtLmgKaW5kZXggNTA0
N2M3ZWUyNWY1Li5jYTkwZWE1MTJlNDUgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvZHJtL2RybV9nZW0u
aAorKysgYi9pbmNsdWRlL2RybS9kcm1fZ2VtLmgKQEAgLTM0LDYgKzM0LDcgQEAKICAqIE9USEVS
IERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4KICAqLwogCisjaW5jbHVkZSA8bGludXgvbWVtY29u
dHJvbC5oPgogI2luY2x1ZGUgPGxpbnV4L2tyZWYuaD4KICNpbmNsdWRlIDxsaW51eC9yZXNlcnZh
dGlvbi5oPgogCkBAIC0yMDIsNiArMjAzLDE2IEBAIHN0cnVjdCBkcm1fZ2VtX29iamVjdCB7CiAJ
ICovCiAJc3RydWN0IGZpbGUgKmZpbHA7CiAKKwkvKioKKwkgKiBAbWVtY2c6CisJICoKKwkgKiBj
Z3JvdXAgdXNlZCBmb3IgY2hhcmdpbmcgR0VNIG9iamVjdCBwYWdlIGFsbG9jYXRpb25zIGFnYWlu
c3QuIFRoaXMKKwkgKiBpcyBzZXQgdG8gdGhlIGN1cnJlbnQgY2dyb3VwIGR1cmluZyBHRU0gb2Jq
ZWN0IGNyZWF0aW9uLgorCSAqIENoYXJnaW5nIHBvbGljeSBpcyB1cCB0byBlYWNoIERSTSBkcml2
ZXIgdG8gZGVjaWRlLCBidXQgaW50ZW50IGlzIHRvCisJICogY2hhcmdlIGR1cmluZyBwYWdlIGFs
bG9jYXRpb24gYW5kIHVzZSBmb3IgZGV2aWNlIG1lbW9yeSBvbmx5LgorCSAqLworCXN0cnVjdCBt
ZW1fY2dyb3VwICptZW1jZzsKKwogCS8qKgogCSAqIEB2bWFfbm9kZToKIAkgKgotLSAKMi4yMS4w
CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2
ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9s
aXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
