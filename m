Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id F2A8DFF925
	for <lists+dri-devel@lfdr.de>; Sun, 17 Nov 2019 12:46:30 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1FC236E37F;
	Sun, 17 Nov 2019 11:45:23 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from bhuna.collabora.co.uk (bhuna.collabora.co.uk [46.235.227.227])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7CEE16E1D7
 for <dri-devel@lists.freedesktop.org>; Sun, 17 Nov 2019 02:41:50 +0000 (UTC)
Received: from [127.0.0.1] (localhost [127.0.0.1]) (Authenticated sender: sre)
 with ESMTPSA id F292C28F76A
Received: by earth.universe (Postfix, from userid 1000)
 id C92143C0C85; Sun, 17 Nov 2019 03:41:39 +0100 (CET)
From: Sebastian Reichel <sebastian.reichel@collabora.com>
To: Sebastian Reichel <sre@kernel.org>,
 Laurent Pinchart <laurent.pinchart@ideasonboard.com>,
 Tomi Valkeinen <tomi.valkeinen@ti.com>
Subject: [RFCv1 13/42] drm/omap: panel-dsi-cm: use DSI helpers
Date: Sun, 17 Nov 2019 03:39:59 +0100
Message-Id: <20191117024028.2233-14-sebastian.reichel@collabora.com>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191117024028.2233-1-sebastian.reichel@collabora.com>
References: <20191117024028.2233-1-sebastian.reichel@collabora.com>
MIME-Version: 1.0
X-Mailman-Approved-At: Sun, 17 Nov 2019 11:44:18 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: kernel@collabora.com, Tony Lindgren <tony@atomide.com>,
 "H. Nikolaus Schaller" <hns@goldelico.com>, Merlijn Wajer <merlijn@wizzup.org>,
 Sebastian Reichel <sebastian.reichel@collabora.com>,
 dri-devel@lists.freedesktop.org, linux-omap@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWZ0ZXIgY29udmVydGluZyB0aGUgZHJpdmVyIHRvIG1pcGlfZHNpX2RldmljZSB3ZSBjYW4gdXNl
IHRoZSBnZW5lcmljCm1lc3NhZ2UgaGVscGVycyB0byBzaW1wbGlmeSB0aGUgZHJpdmVyIGEgbG90
LgoKU2lnbmVkLW9mZi1ieTogU2ViYXN0aWFuIFJlaWNoZWwgPHNlYmFzdGlhbi5yZWljaGVsQGNv
bGxhYm9yYS5jb20+Ci0tLQogLi4uL2dwdS9kcm0vb21hcGRybS9kaXNwbGF5cy9wYW5lbC1kc2kt
Y20uYyAgIHwgMTI2ICsrKy0tLS0tLS0tLS0tLS0tLQogMSBmaWxlIGNoYW5nZWQsIDE4IGluc2Vy
dGlvbnMoKyksIDEwOCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
b21hcGRybS9kaXNwbGF5cy9wYW5lbC1kc2ktY20uYyBiL2RyaXZlcnMvZ3B1L2RybS9vbWFwZHJt
L2Rpc3BsYXlzL3BhbmVsLWRzaS1jbS5jCmluZGV4IGUyZTU2Y2MxY2Q2MS4uZTZjMGE2ZTVhYTFk
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kaXNwbGF5cy9wYW5lbC1kc2kt
Y20uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vb21hcGRybS9kaXNwbGF5cy9wYW5lbC1kc2ktY20u
YwpAQCAtMTM4LDYyICsxMzgsMjIgQEAgc3RhdGljIHZvaWQgaHdfZ3VhcmRfd2FpdChzdHJ1Y3Qg
cGFuZWxfZHJ2X2RhdGEgKmRkYXRhKQogCiBzdGF0aWMgaW50IGRzaWNtX2Rjc19yZWFkXzEoc3Ry
dWN0IHBhbmVsX2Rydl9kYXRhICpkZGF0YSwgdTggZGNzX2NtZCwgdTggKmRhdGEpCiB7Ci0Jc3Ry
dWN0IG1pcGlfZHNpX2RldmljZSAqZHNpID0gZGRhdGEtPmRzaTsKLQljb25zdCBzdHJ1Y3QgbWlw
aV9kc2lfbXNnIG1zZyA9IHsKLQkJLmNoYW5uZWwgPSBkZGF0YS0+Y2hhbm5lbCwKLQkJLnR5cGUg
PSBNSVBJX0RTSV9EQ1NfUkVBRCwKLQkJLnR4X2xlbiA9IDEsCi0JCS50eF9idWYgPSAmZGNzX2Nt
ZCwKLQkJLnJ4X2xlbiA9IDEsCi0JCS5yeF9idWYgPSBkYXRhCi0JfTsKLQotCXJldHVybiBkc2kt
Pmhvc3QtPm9wcy0+dHJhbnNmZXIoZHNpLT5ob3N0LCAmbXNnKTsKLX0KLQotc3RhdGljIGludCBk
c2ljbV9kY3Nfd3JpdGVfMChzdHJ1Y3QgcGFuZWxfZHJ2X2RhdGEgKmRkYXRhLCB1OCBkY3NfY21k
KQotewotCXN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSA9IGRkYXRhLT5kc2k7Ci0JY29uc3Qg
c3RydWN0IG1pcGlfZHNpX21zZyBtc2cgPSB7Ci0JCS5jaGFubmVsID0gZGRhdGEtPmNoYW5uZWws
Ci0JCS50eXBlID0gTUlQSV9EU0lfRENTX1NIT1JUX1dSSVRFLAotCQkudHhfYnVmID0gJmRjc19j
bWQsCi0JCS50eF9sZW4gPSAxLAotCX07Ci0KLQlyZXR1cm4gZHNpLT5ob3N0LT5vcHMtPnRyYW5z
ZmVyKGRzaS0+aG9zdCwgJm1zZyk7CisJcmV0dXJuIG1pcGlfZHNpX2Rjc19yZWFkKGRkYXRhLT5k
c2ksIGRjc19jbWQsIGRhdGEsIDEpOwogfQogCiBzdGF0aWMgaW50IGRzaWNtX2Rjc193cml0ZV8x
KHN0cnVjdCBwYW5lbF9kcnZfZGF0YSAqZGRhdGEsIHU4IGRjc19jbWQsIHU4IHBhcmFtKQogewot
CXN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSA9IGRkYXRhLT5kc2k7Ci0JY29uc3QgdTggYnVm
W10gPSB7IGRjc19jbWQsIHBhcmFtIH07Ci0JY29uc3Qgc3RydWN0IG1pcGlfZHNpX21zZyBtc2cg
PSB7Ci0JCS5jaGFubmVsID0gZGRhdGEtPmNoYW5uZWwsCi0JCS50eXBlID0gTUlQSV9EU0lfRENT
X1NIT1JUX1dSSVRFX1BBUkFNLAotCQkudHhfYnVmID0gJmJ1ZiwKLQkJLnR4X2xlbiA9IDIsCi0J
fTsKLQotCXJldHVybiBkc2ktPmhvc3QtPm9wcy0+dHJhbnNmZXIoZHNpLT5ob3N0LCAmbXNnKTsK
KwlyZXR1cm4gbWlwaV9kc2lfZGNzX3dyaXRlKGRkYXRhLT5kc2ksIGRjc19jbWQsICZwYXJhbSwg
MSk7CiB9CiAKIHN0YXRpYyBpbnQgZHNpY21fc2xlZXBfaW4oc3RydWN0IHBhbmVsX2Rydl9kYXRh
ICpkZGF0YSkKIAogewotCXN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSA9IGRkYXRhLT5kc2k7
CiAJaW50IHI7Ci0JY29uc3QgdTggY21kID0gTUlQSV9EQ1NfRU5URVJfU0xFRVBfTU9ERTsKLQlj
b25zdCBzdHJ1Y3QgbWlwaV9kc2lfbXNnIG1zZyA9IHsKLQkJLmNoYW5uZWwgPSBkZGF0YS0+Y2hh
bm5lbCwKLQkJLnR5cGUgPSBNSVBJX0RTSV9EQ1NfU0hPUlRfV1JJVEUsCi0JCS50eF9idWYgPSAm
Y21kLAotCQkudHhfbGVuID0gMSwKLQl9OwogCiAJaHdfZ3VhcmRfd2FpdChkZGF0YSk7CiAKLQly
ID0gZHNpLT5ob3N0LT5vcHMtPnRyYW5zZmVyKGRzaS0+aG9zdCwgJm1zZyk7CisJciA9IG1pcGlf
ZHNpX2Rjc19lbnRlcl9zbGVlcF9tb2RlKGRkYXRhLT5kc2kpOwogCWlmIChyKQogCQlyZXR1cm4g
cjsKIApAQCAtMjEwLDcgKzE3MCw3IEBAIHN0YXRpYyBpbnQgZHNpY21fc2xlZXBfb3V0KHN0cnVj
dCBwYW5lbF9kcnZfZGF0YSAqZGRhdGEpCiAKIAlod19ndWFyZF93YWl0KGRkYXRhKTsKIAotCXIg
PSBkc2ljbV9kY3Nfd3JpdGVfMChkZGF0YSwgTUlQSV9EQ1NfRVhJVF9TTEVFUF9NT0RFKTsKKwly
ID0gbWlwaV9kc2lfZGNzX2V4aXRfc2xlZXBfbW9kZShkZGF0YS0+ZHNpKTsKIAlpZiAocikKIAkJ
cmV0dXJuIHI7CiAKQEAgLTI0OCw0NiArMjA4LDE1IEBAIHN0YXRpYyBpbnQgZHNpY21fc2V0X3Vw
ZGF0ZV93aW5kb3coc3RydWN0IHBhbmVsX2Rydl9kYXRhICpkZGF0YSwKIAl1MTYgeTEgPSB5Owog
CXUxNiB5MiA9IHkgKyBoIC0gMTsKIAotCWNvbnN0IHU4IHBhcmFtWFtdID0gewotCQlNSVBJX0RD
U19TRVRfQ09MVU1OX0FERFJFU1MsCi0JCSh4MSA+PiA4KSAmIDB4ZmYsCi0JCSh4MSA+PiAwKSAm
IDB4ZmYsCi0JCSh4MiA+PiA4KSAmIDB4ZmYsCi0JCSh4MiA+PiAwKSAmIDB4ZmYsCi0JfTsKLQot
CWNvbnN0IHN0cnVjdCBtaXBpX2RzaV9tc2cgbXNnWCA9IHsKLQkJLmNoYW5uZWwgPSBkZGF0YS0+
Y2hhbm5lbCwKLQkJLnR5cGUgPSBNSVBJX0RTSV9HRU5FUklDX0xPTkdfV1JJVEUsCi0JCS50eF9i
dWYgPSBwYXJhbVgsCi0JCS50eF9sZW4gPSA1LAotCX07Ci0KLQljb25zdCB1OCBwYXJhbVlbXSA9
IHsKLQkJTUlQSV9EQ1NfU0VUX1BBR0VfQUREUkVTUywKLQkJKHkxID4+IDgpICYgMHhmZiwKLQkJ
KHkxID4+IDApICYgMHhmZiwKLQkJKHkyID4+IDgpICYgMHhmZiwKLQkJKHkyID4+IDApICYgMHhm
ZiwKLQl9OwotCi0JY29uc3Qgc3RydWN0IG1pcGlfZHNpX21zZyBtc2dZID0gewotCQkuY2hhbm5l
bCA9IGRkYXRhLT5jaGFubmVsLAotCQkudHlwZSA9IE1JUElfRFNJX0dFTkVSSUNfTE9OR19XUklU
RSwKLQkJLnR4X2J1ZiA9IHBhcmFtWSwKLQkJLnR4X2xlbiA9IDUsCi0JfTsKLQotCi0JciA9IGRz
aS0+aG9zdC0+b3BzLT50cmFuc2Zlcihkc2ktPmhvc3QsICZtc2dYKTsKLQlpZiAocikKKwlyID0g
bWlwaV9kc2lfZGNzX3NldF9jb2x1bW5fYWRkcmVzcyhkc2ksIHgxLCB4Mik7CisJaWYgKHIgPCAw
KQogCQlyZXR1cm4gcjsKIAotCXIgPSBkc2ktPmhvc3QtPm9wcy0+dHJhbnNmZXIoZHNpLT5ob3N0
LCAmbXNnWSk7Ci0JaWYgKHIpCisJciA9IG1pcGlfZHNpX2Rjc19zZXRfcGFnZV9hZGRyZXNzKGRz
aSwgeTEsIHkyKTsKKwlpZiAociA8IDApCiAJCXJldHVybiByOwogCi0JcmV0dXJuIHI7CisJcmV0
dXJuIDA7CiB9CiAKIHN0YXRpYyB2b2lkIGRzaWNtX3F1ZXVlX3VscHNfd29yayhzdHJ1Y3QgcGFu
ZWxfZHJ2X2RhdGEgKmRkYXRhKQpAQCAtNjgxLDEyICs2MTAsMTEgQEAgc3RhdGljIGludCBkc2lj
bV9wb3dlcl9vbihzdHJ1Y3QgcGFuZWxfZHJ2X2RhdGEgKmRkYXRhKQogCWlmIChyKQogCQlnb3Rv
IGVycjsKIAotCXIgPSBkc2ljbV9kY3Nfd3JpdGVfMShkZGF0YSwgTUlQSV9EQ1NfU0VUX1BJWEVM
X0ZPUk1BVCwKLQkJTUlQSV9EQ1NfUElYRUxfRk1UXzI0QklUKTsKKwlyID0gbWlwaV9kc2lfZGNz
X3NldF9waXhlbF9mb3JtYXQoZGRhdGEtPmRzaSwgTUlQSV9EQ1NfUElYRUxfRk1UXzI0QklUKTsK
IAlpZiAocikKIAkJZ290byBlcnI7CiAKLQlyID0gZHNpY21fZGNzX3dyaXRlXzAoZGRhdGEsIE1J
UElfRENTX1NFVF9ESVNQTEFZX09OKTsKKwlyID0gbWlwaV9kc2lfZGNzX3NldF9kaXNwbGF5X29u
KGRkYXRhLT5kc2kpOwogCWlmIChyKQogCQlnb3RvIGVycjsKIApAQCAtNzMyLDcgKzY2MCw3IEBA
IHN0YXRpYyB2b2lkIGRzaWNtX3Bvd2VyX29mZihzdHJ1Y3QgcGFuZWxfZHJ2X2RhdGEgKmRkYXRh
KQogCiAJc3JjLT5vcHMtPmRzaS5kaXNhYmxlX3ZpZGVvX291dHB1dChzcmMsIGRkYXRhLT5jaGFu
bmVsKTsKIAotCXIgPSBkc2ljbV9kY3Nfd3JpdGVfMChkZGF0YSwgTUlQSV9EQ1NfU0VUX0RJU1BM
QVlfT0ZGKTsKKwlyID0gbWlwaV9kc2lfZGNzX3NldF9kaXNwbGF5X29mZihkZGF0YS0+ZHNpKTsK
IAlpZiAoIXIpCiAJCXIgPSBkc2ljbV9zbGVlcF9pbihkZGF0YSk7CiAKQEAgLTk1MCwxMiArODc4
LDEzIEBAIHN0YXRpYyBpbnQgZHNpY21fc3luYyhzdHJ1Y3Qgb21hcF9kc3NfZGV2aWNlICpkc3Nk
ZXYpCiBzdGF0aWMgaW50IF9kc2ljbV9lbmFibGVfdGUoc3RydWN0IHBhbmVsX2Rydl9kYXRhICpk
ZGF0YSwgYm9vbCBlbmFibGUpCiB7CiAJc3RydWN0IG9tYXBfZHNzX2RldmljZSAqc3JjID0gZGRh
dGEtPnNyYzsKKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kgPSBkZGF0YS0+ZHNpOwogCWlu
dCByOwogCiAJaWYgKGVuYWJsZSkKLQkJciA9IGRzaWNtX2Rjc193cml0ZV8xKGRkYXRhLCBNSVBJ
X0RDU19TRVRfVEVBUl9PTiwgMCk7CisJCXIgPSBtaXBpX2RzaV9kY3Nfc2V0X3RlYXJfb24oZHNp
LCBNSVBJX0RTSV9EQ1NfVEVBUl9NT0RFX1ZCTEFOSyk7CiAJZWxzZQotCQlyID0gZHNpY21fZGNz
X3dyaXRlXzAoZGRhdGEsIE1JUElfRENTX1NFVF9URUFSX09GRik7CisJCXIgPSBtaXBpX2RzaV9k
Y3Nfc2V0X3RlYXJfb2ZmKGRzaSk7CiAKIAlpZiAoIWRkYXRhLT5leHRfdGVfZ3BpbykKIAkJc3Jj
LT5vcHMtPmRzaS5lbmFibGVfdGUoc3JjLCBlbmFibGUpOwpAQCAtMTAyMSwxOSArOTUwLDcgQEAg
c3RhdGljIGludCBkc2ljbV9zZXRfbWF4X3J4X3BhY2tldF9zaXplKHN0cnVjdCBvbWFwX2Rzc19k
ZXZpY2UgKmRzc2RldiwKIAlzdHJ1Y3QgcGFuZWxfZHJ2X2RhdGEgKmRkYXRhID0gdG9fcGFuZWxf
ZGF0YShkc3NkZXYpOwogCXN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSA9IGRkYXRhLT5kc2k7
CiAKLQljb25zdCB1OCBidWZbXSA9IHsKLQkJc2l6ZSAmIDB4ZmYsCi0JCXNpemUgPj4gOCAmIDB4
ZmYsCi0JfTsKLQotCWNvbnN0IHN0cnVjdCBtaXBpX2RzaV9tc2cgbXNnID0gewotCQkuY2hhbm5l
bCA9IGRkYXRhLT5jaGFubmVsLAotCQkudHlwZSA9IE1JUElfRFNJX1NFVF9NQVhJTVVNX1JFVFVS
Tl9QQUNLRVRfU0laRSwKLQkJLnR4X2J1ZiA9IGJ1ZiwKLQkJLnR4X2xlbiA9IDIsCi0JfTsKLQot
CXJldHVybiBkc2ktPmhvc3QtPm9wcy0+dHJhbnNmZXIoZHNpLT5ob3N0LCAmbXNnKTsKKwlyZXR1
cm4gbWlwaV9kc2lfc2V0X21heGltdW1fcmV0dXJuX3BhY2tldF9zaXplKGRzaSwgc2l6ZSk7CiB9
CiAKIHN0YXRpYyBpbnQgZHNpY21fbWVtb3J5X3JlYWQoc3RydWN0IG9tYXBfZHNzX2RldmljZSAq
ZHNzZGV2LApAQCAtMTA4MywxNyArMTAwMCwxMCBAQCBzdGF0aWMgaW50IGRzaWNtX21lbW9yeV9y
ZWFkKHN0cnVjdCBvbWFwX2Rzc19kZXZpY2UgKmRzc2RldiwKIAogCXdoaWxlIChidWZfdXNlZCA8
IHNpemUpIHsKIAkJdTggZGNzX2NtZCA9IGZpcnN0ID8gMHgyZSA6IDB4M2U7Ci0JCWNvbnN0IHN0
cnVjdCBtaXBpX2RzaV9tc2cgbXNnID0gewotCQkJLmNoYW5uZWwgPSBkZGF0YS0+Y2hhbm5lbCwK
LQkJCS50eXBlID0gTUlQSV9EU0lfRENTX1JFQUQsCi0JCQkudHhfYnVmID0gJmRjc19jbWQsCi0J
CQkudHhfbGVuID0gMSwKLQkJCS5yeF9idWYgPSBidWYgKyBidWZfdXNlZCwKLQkJCS5yeF9sZW4g
PSBzaXplIC0gYnVmX3VzZWQsCi0JCX07CiAJCWZpcnN0ID0gMDsKIAotCQlyID0gZHNpLT5ob3N0
LT5vcHMtPnRyYW5zZmVyKGRzaS0+aG9zdCwgJm1zZyk7CisJCXIgPSBtaXBpX2RzaV9kY3NfcmVh
ZChkc2ksIGRjc19jbWQsCisJCQkJICAgICAgYnVmICsgYnVmX3VzZWQsIHNpemUgLSBidWZfdXNl
ZCk7CiAJCWlmIChyIDwgMCkgewogCQkJZGV2X2Vycihkc3NkZXYtPmRldiwgInJlYWQgZXJyb3Jc
biIpOwogCQkJZ290byBlcnIzOwotLSAKMi4yNC4wCgpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBs
aXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1h
bi9saXN0aW5mby9kcmktZGV2ZWw=
