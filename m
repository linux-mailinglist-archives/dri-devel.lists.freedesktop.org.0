Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 157B688EC4
	for <lists+dri-devel@lfdr.de>; Sun, 11 Aug 2019 01:11:14 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 733206E1CE;
	Sat, 10 Aug 2019 23:11:07 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from perceval.ideasonboard.com (perceval.ideasonboard.com
 [213.167.242.64])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 479786E181
 for <dri-devel@lists.freedesktop.org>; Sat, 10 Aug 2019 23:11:03 +0000 (UTC)
Received: from pendragon.bb.dnainternet.fi
 (dfj612yhrgyx302h3jwwy-3.rev.dnainternet.fi
 [IPv6:2001:14ba:21f5:5b00:ce28:277f:58d7:3ca4])
 by perceval.ideasonboard.com (Postfix) with ESMTPSA id A389E14E8;
 Sun, 11 Aug 2019 01:10:59 +0200 (CEST)
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v2 7/9] drm/panel: Add driver for the Sony ACX565AKM panel
Date: Sun, 11 Aug 2019 02:10:46 +0300
Message-Id: <20190810231048.1921-8-laurent.pinchart@ideasonboard.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190810231048.1921-1-laurent.pinchart@ideasonboard.com>
References: <20190810231048.1921-1-laurent.pinchart@ideasonboard.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=ideasonboard.com; s=mail; t=1565478660;
 bh=yXyfvlcAdulHn7Pp+yuaESraIFqUqw0rlU1kEK5C9w8=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=hIUEfEaJETkQxM7VFaR1KhpQNahkP0QNtMdQNv6a3Jx5Wze13apMlBqKI/aR0N70j
 /JeiQd6NKEwOZljYQxnN/l/nl/XetdyrlriQ32WaBLFv8pG6rFTP6flc0ufL0ZpUzG
 wMSNh6VO17pBQYMDSJjU6gjUquGGMYimEjvXVdig=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thierry Reding <thierry.reding@gmail.com>, Sam Ravnborg <sam@ravnborg.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBwYW5lbCBpcyB1c2VkIG9uIHRoZSBOb2tpYSBOOTAwLgoKVGhlIGNvZGUgaXMgYmFzZWQg
b24gdGhlIG9tYXBkcm0tc3BlY2lmaWMgcGFuZWwtc29ueS1hY3g1NjVha20gZHJpdmVyLgoKU2ln
bmVkLW9mZi1ieTogTGF1cmVudCBQaW5jaGFydCA8bGF1cmVudC5waW5jaGFydEBpZGVhc29uYm9h
cmQuY29tPgotLS0KQ2hhbmdlcyBzaW5jZSB2MToKCi0gTWVudGlvbiBib2FyZHMgdXNpbmcgdGhl
IHBhbmVsIGluIEtjb25maWcKLSBSZW5hbWVkIGFjeDU2NWFrbV9kZXZpY2UgdG8gYWN4NTY1YWtt
X3BhbmVsCi0gQ29tbWVudHMgdXBkYXRlcwotIFN0b3JlIHdpZHRoX21tIGFuZCBoZWlnaHRfbW0g
aW4gZHJtX2Rpc3BsYXlfbW9kZQotIFVzZSBkcm1fcGFuZWxfZGlzYWJsZSgpIGluIC5yZW1vdmUo
KSBoYW5kbGVyCi0tLQogZHJpdmVycy9ncHUvZHJtL3BhbmVsL0tjb25maWcgICAgICAgICAgICAg
ICAgfCAgIDggKwogZHJpdmVycy9ncHUvZHJtL3BhbmVsL01ha2VmaWxlICAgICAgICAgICAgICAg
fCAgIDEgKwogZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLXNvbnktYWN4NTY1YWttLmMgfCA2
OTMgKysrKysrKysrKysrKysrKysrKwogMyBmaWxlcyBjaGFuZ2VkLCA3MDIgaW5zZXJ0aW9ucygr
KQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1zb255LWFj
eDU2NWFrbS5jCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmVsL0tjb25maWcgYi9k
cml2ZXJzL2dwdS9kcm0vcGFuZWwvS2NvbmZpZwppbmRleCA4ZDlhOGNkYjcwNGUuLmIwNTY0OWIz
MTE4YSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3BhbmVsL0tjb25maWcKKysrIGIvZHJp
dmVycy9ncHUvZHJtL3BhbmVsL0tjb25maWcKQEAgLTMxNiw2ICszMTYsMTQgQEAgY29uZmlnIERS
TV9QQU5FTF9TSVRST05JWF9TVDc3ODlWCiAJICBTYXkgWSBoZXJlIGlmIHlvdSB3YW50IHRvIGVu
YWJsZSBzdXBwb3J0IGZvciB0aGUgU2l0cm9uaXgKIAkgIFNUNzc4OVYgY29udHJvbGxlciBmb3Ig
MjQweDMyMCBMQ0QgcGFuZWxzCiAKK2NvbmZpZyBEUk1fUEFORUxfU09OWV9BQ1g1NjVBS00KKwl0
cmlzdGF0ZSAiU29ueSBBQ1g1NjVBS00gcGFuZWwiCisJZGVwZW5kcyBvbiBHUElPTElCICYmIE9G
ICYmIFNQSQorCWRlcGVuZHMgb24gQkFDS0xJR0hUX0NMQVNTX0RFVklDRQorCWhlbHAKKwkgIFNh
eSBZIGhlcmUgaWYgeW91IHdhbnQgdG8gZW5hYmxlIHN1cHBvcnQgZm9yIHRoZSBTb255IEFDWDU2
NUFLTQorCSAgODAweDYwMCAzLjUiIHBhbmVsIChmb3VuZCBvbiB0aGUgTm9raWEgTjkwMCkuCisK
IGNvbmZpZyBEUk1fUEFORUxfVFBPX1RQRzExMAogCXRyaXN0YXRlICJUUE8gVFBHIDgwMHg0MDAg
cGFuZWwiCiAJZGVwZW5kcyBvbiBPRiAmJiBTUEkgJiYgR1BJT0xJQgpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL3BhbmVsL01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL3BhbmVsL01ha2Vm
aWxlCmluZGV4IDE0ZDFjNDllZjNhYi4uMjhjZjIzMzJmZDA2IDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vcGFuZWwvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmVsL01ha2Vm
aWxlCkBAIC0zMyw1ICszMyw2IEBAIG9iai0kKENPTkZJR19EUk1fUEFORUxfU0hBUlBfTFMwMzdW
N0RXMDEpICs9IHBhbmVsLXNoYXJwLWxzMDM3djdkdzAxLm8KIG9iai0kKENPTkZJR19EUk1fUEFO
RUxfU0hBUlBfTFMwNDNUMUxFMDEpICs9IHBhbmVsLXNoYXJwLWxzMDQzdDFsZTAxLm8KIG9iai0k
KENPTkZJR19EUk1fUEFORUxfU0lUUk9OSVhfU1Q3NzAxKSArPSBwYW5lbC1zaXRyb25peC1zdDc3
MDEubwogb2JqLSQoQ09ORklHX0RSTV9QQU5FTF9TSVRST05JWF9TVDc3ODlWKSArPSBwYW5lbC1z
aXRyb25peC1zdDc3ODl2Lm8KK29iai0kKENPTkZJR19EUk1fUEFORUxfU09OWV9BQ1g1NjVBS00p
ICs9IHBhbmVsLXNvbnktYWN4NTY1YWttLm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfVFBPX1RQ
RzExMCkgKz0gcGFuZWwtdHBvLXRwZzExMC5vCiBvYmotJChDT05GSUdfRFJNX1BBTkVMX1RSVUxZ
X05UMzU1OTdfV1FYR0EpICs9IHBhbmVsLXRydWx5LW50MzU1OTcubwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLXNvbnktYWN4NTY1YWttLmMgYi9kcml2ZXJzL2dwdS9k
cm0vcGFuZWwvcGFuZWwtc29ueS1hY3g1NjVha20uYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRl
eCAwMDAwMDAwMDAwMDAuLmEwZGUyOTA2OTU4MQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9wYW5lbC9wYW5lbC1zb255LWFjeDU2NWFrbS5jCkBAIC0wLDAgKzEsNjkzIEBACisv
LyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAorLyoKKyAqIFNvbnkgQUNYNTY1QUtN
IExDRCBQYW5lbCBkcml2ZXIKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMTkgVGV4YXMgSW5zdHJ1
bWVudHMgSW5jb3Jwb3JhdGVkCisgKgorICogQmFzZWQgb24gdGhlIG9tYXBkcm0tc3BlY2lmaWMg
cGFuZWwtc29ueS1hY3g1NjVha20gZHJpdmVyCisgKgorICogQ29weXJpZ2h0IChDKSAyMDEwIE5v
a2lhIENvcnBvcmF0aW9uCisgKiBBdXRob3I6IEltcmUgRGVhayA8aW1yZS5kZWFrQG5va2lhLmNv
bT4KKyAqLworCisjaW5jbHVkZSA8bGludXgvYmFja2xpZ2h0Lmg+CisjaW5jbHVkZSA8bGludXgv
ZGVsYXkuaD4KKyNpbmNsdWRlIDxsaW51eC9ncGlvL2NvbnN1bWVyLmg+CisjaW5jbHVkZSA8bGlu
dXgvamlmZmllcy5oPgorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgorI2luY2x1ZGUgPGxpbnV4
L211dGV4Lmg+CisjaW5jbHVkZSA8bGludXgvc2NoZWQuaD4KKyNpbmNsdWRlIDxsaW51eC9zcGkv
c3BpLmg+CisjaW5jbHVkZSA8dmlkZW8vbWlwaV9kaXNwbGF5Lmg+CisKKyNpbmNsdWRlIDxkcm0v
ZHJtX2Nvbm5lY3Rvci5oPgorI2luY2x1ZGUgPGRybS9kcm1fbW9kZXMuaD4KKyNpbmNsdWRlIDxk
cm0vZHJtX3BhbmVsLmg+CisKKyNkZWZpbmUgQ1RSTF9ESVNQX0JSSUdIVE5FU1NfQ1RSTF9PTgkJ
KDEgPDwgNSkKKyNkZWZpbmUgQ1RSTF9ESVNQX0FNQklFTlRfTElHSFRfQ1RSTF9PTgkJKDEgPDwg
NCkKKyNkZWZpbmUgQ1RSTF9ESVNQX0JBQ0tMSUdIVF9PTgkJCSgxIDw8IDIpCisjZGVmaW5lIENU
UkxfRElTUF9BVVRPX0JSSUdIVE5FU1NfT04JCSgxIDw8IDEpCisKKyNkZWZpbmUgTUlQSURfQ01E
X1dSSVRFX0NBQkMJCTB4NTUKKyNkZWZpbmUgTUlQSURfQ01EX1JFQURfQ0FCQwkJMHg1NgorCisj
ZGVmaW5lIE1JUElEX1ZFUl9MUEg4OTIzCQkzCisjZGVmaW5lIE1JUElEX1ZFUl9MUzA0MVkzCQk0
CisjZGVmaW5lIE1JUElEX1ZFUl9MNEYwMDMxMQkJOAorI2RlZmluZSBNSVBJRF9WRVJfQUNYNTY1
QUtNCQk5CisKK3N0cnVjdCBhY3g1NjVha21fcGFuZWwgeworCXN0cnVjdCBkcm1fcGFuZWwgcGFu
ZWw7CisKKwlzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpOworCXN0cnVjdCBncGlvX2Rlc2MgKnJlc2V0
X2dwaW87CisJc3RydWN0IGJhY2tsaWdodF9kZXZpY2UgKmJhY2tsaWdodDsKKworCXN0cnVjdCBt
dXRleCBtdXRleDsKKworCWNvbnN0IGNoYXIgKm5hbWU7CisJdTggZGlzcGxheV9pZFszXTsKKwlp
bnQgbW9kZWw7CisJaW50IHJldmlzaW9uOworCWJvb2wgaGFzX2JjOworCWJvb2wgaGFzX2NhYmM7
CisKKwlib29sIGVuYWJsZWQ7CisJdW5zaWduZWQgaW50IGNhYmNfbW9kZTsKKwkvKgorCSAqIE5l
eHQgdmFsdWUgb2YgamlmZmllcyB3aGVuIHdlIGNhbiBpc3N1ZSB0aGUgbmV4dCBzbGVlcCBpbi9v
dXQKKwkgKiBjb21tYW5kLgorCSAqLworCXVuc2lnbmVkIGxvbmcgaHdfZ3VhcmRfZW5kOworCXVu
c2lnbmVkIGxvbmcgaHdfZ3VhcmRfd2FpdDsJCS8qIG1heCBndWFyZCB0aW1lIGluIGppZmZpZXMg
Ki8KK307CisKKyNkZWZpbmUgdG9fYWN4NTY1YWttX2RldmljZShwKSBjb250YWluZXJfb2YocCwg
c3RydWN0IGFjeDU2NWFrbV9wYW5lbCwgcGFuZWwpCisKK3N0YXRpYyB2b2lkIGFjeDU2NWFrbV90
cmFuc2ZlcihzdHJ1Y3QgYWN4NTY1YWttX3BhbmVsICpsY2QsIGludCBjbWQsCisJCQkgICAgICBj
b25zdCB1OCAqd2J1ZiwgaW50IHdsZW4sIHU4ICpyYnVmLCBpbnQgcmxlbikKK3sKKwlzdHJ1Y3Qg
c3BpX21lc3NhZ2UJbTsKKwlzdHJ1Y3Qgc3BpX3RyYW5zZmVyCSp4LCB4ZmVyWzVdOworCWludAkJ
CXJldDsKKworCXNwaV9tZXNzYWdlX2luaXQoJm0pOworCisJbWVtc2V0KHhmZXIsIDAsIHNpemVv
Zih4ZmVyKSk7CisJeCA9ICZ4ZmVyWzBdOworCisJY21kICY9ICAweGZmOworCXgtPnR4X2J1ZiA9
ICZjbWQ7CisJeC0+Yml0c19wZXJfd29yZCA9IDk7CisJeC0+bGVuID0gMjsKKworCWlmIChybGVu
ID4gMSAmJiB3bGVuID09IDApIHsKKwkJLyoKKwkJICogQmV0d2VlbiB0aGUgY29tbWFuZCBhbmQg
dGhlIHJlc3BvbnNlIGRhdGEgdGhlcmUgaXMgYQorCQkgKiBkdW1teSBjbG9jayBjeWNsZS4gQWRk
IGFuIGV4dHJhIGJpdCBhZnRlciB0aGUgY29tbWFuZAorCQkgKiB3b3JkIHRvIGFjY291bnQgZm9y
IHRoaXMuCisJCSAqLworCQl4LT5iaXRzX3Blcl93b3JkID0gMTA7CisJCWNtZCA8PD0gMTsKKwl9
CisJc3BpX21lc3NhZ2VfYWRkX3RhaWwoeCwgJm0pOworCisJaWYgKHdsZW4pIHsKKwkJeCsrOwor
CQl4LT50eF9idWYgPSB3YnVmOworCQl4LT5sZW4gPSB3bGVuOworCQl4LT5iaXRzX3Blcl93b3Jk
ID0gOTsKKwkJc3BpX21lc3NhZ2VfYWRkX3RhaWwoeCwgJm0pOworCX0KKworCWlmIChybGVuKSB7
CisJCXgrKzsKKwkJeC0+cnhfYnVmCT0gcmJ1ZjsKKwkJeC0+bGVuCQk9IHJsZW47CisJCXNwaV9t
ZXNzYWdlX2FkZF90YWlsKHgsICZtKTsKKwl9CisKKwlyZXQgPSBzcGlfc3luYyhsY2QtPnNwaSwg
Jm0pOworCWlmIChyZXQgPCAwKQorCQlkZXZfZGJnKCZsY2QtPnNwaS0+ZGV2LCAic3BpX3N5bmMg
JWRcbiIsIHJldCk7Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBhY3g1NjVha21fY21kKHN0cnVj
dCBhY3g1NjVha21fcGFuZWwgKmxjZCwgaW50IGNtZCkKK3sKKwlhY3g1NjVha21fdHJhbnNmZXIo
bGNkLCBjbWQsIE5VTEwsIDAsIE5VTEwsIDApOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQgYWN4
NTY1YWttX3dyaXRlKHN0cnVjdCBhY3g1NjVha21fcGFuZWwgKmxjZCwKKwkJCSAgICAgICBpbnQg
cmVnLCBjb25zdCB1OCAqYnVmLCBpbnQgbGVuKQoreworCWFjeDU2NWFrbV90cmFuc2ZlcihsY2Qs
IHJlZywgYnVmLCBsZW4sIE5VTEwsIDApOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQgYWN4NTY1
YWttX3JlYWQoc3RydWN0IGFjeDU2NWFrbV9wYW5lbCAqbGNkLAorCQkJICAgICAgaW50IHJlZywg
dTggKmJ1ZiwgaW50IGxlbikKK3sKKwlhY3g1NjVha21fdHJhbnNmZXIobGNkLCByZWcsIE5VTEws
IDAsIGJ1ZiwgbGVuKTsKK30KKworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqIEF1dG8gQnJp
Z2h0bmVzcyBDb250cm9sIFZpYSBzeXNmcworICovCisKK3N0YXRpYyB1bnNpZ25lZCBpbnQgYWN4
NTY1YWttX2dldF9jYWJjX21vZGUoc3RydWN0IGFjeDU2NWFrbV9wYW5lbCAqbGNkKQoreworCXJl
dHVybiBsY2QtPmNhYmNfbW9kZTsKK30KKworc3RhdGljIHZvaWQgYWN4NTY1YWttX3NldF9jYWJj
X21vZGUoc3RydWN0IGFjeDU2NWFrbV9wYW5lbCAqbGNkLAorCQkJCSAgICB1bnNpZ25lZCBpbnQg
bW9kZSkKK3sKKwl1MTYgY2FiY19jdHJsOworCisJbGNkLT5jYWJjX21vZGUgPSBtb2RlOworCWlm
ICghbGNkLT5lbmFibGVkKQorCQlyZXR1cm47CisJY2FiY19jdHJsID0gMDsKKwlhY3g1NjVha21f
cmVhZChsY2QsIE1JUElEX0NNRF9SRUFEX0NBQkMsICh1OCAqKSZjYWJjX2N0cmwsIDEpOworCWNh
YmNfY3RybCAmPSB+MzsKKwljYWJjX2N0cmwgfD0gKDEgPDwgOCkgfCAobW9kZSAmIDMpOworCWFj
eDU2NWFrbV93cml0ZShsY2QsIE1JUElEX0NNRF9XUklURV9DQUJDLCAodTggKikmY2FiY19jdHJs
LCAyKTsKK30KKworc3RhdGljIHVuc2lnbmVkIGludCBhY3g1NjVha21fZ2V0X2h3X2NhYmNfbW9k
ZShzdHJ1Y3QgYWN4NTY1YWttX3BhbmVsICpsY2QpCit7CisJdTggY2FiY19jdHJsOworCisJYWN4
NTY1YWttX3JlYWQobGNkLCBNSVBJRF9DTURfUkVBRF9DQUJDLCAmY2FiY19jdHJsLCAxKTsKKwly
ZXR1cm4gY2FiY19jdHJsICYgMzsKK30KKworc3RhdGljIGNvbnN0IGNoYXIgKiBjb25zdCBhY3g1
NjVha21fY2FiY19tb2Rlc1tdID0geworCSJvZmYiLAkJLyogYWx3YXlzIHVzZWQgd2hlbiBDQUJD
IGlzIG5vdCBzdXBwb3J0ZWQgKi8KKwkidWkiLAorCSJzdGlsbC1pbWFnZSIsCisJIm1vdmluZy1p
bWFnZSIsCit9OworCitzdGF0aWMgc3NpemVfdCBjYWJjX21vZGVfc2hvdyhzdHJ1Y3QgZGV2aWNl
ICpkZXYsCisJCQkgICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKKwkJCSAgICAg
IGNoYXIgKmJ1ZikKK3sKKwlzdHJ1Y3QgYWN4NTY1YWttX3BhbmVsICpsY2QgPSBkZXZfZ2V0X2Ry
dmRhdGEoZGV2KTsKKwljb25zdCBjaGFyICptb2RlX3N0cjsKKwlpbnQgbW9kZTsKKworCWlmICgh
bGNkLT5oYXNfY2FiYykKKwkJbW9kZSA9IDA7CisJZWxzZQorCQltb2RlID0gYWN4NTY1YWttX2dl
dF9jYWJjX21vZGUobGNkKTsKKworCW1vZGVfc3RyID0gInVua25vd24iOworCWlmIChtb2RlID49
IDAgJiYgbW9kZSA8IEFSUkFZX1NJWkUoYWN4NTY1YWttX2NhYmNfbW9kZXMpKQorCQltb2RlX3N0
ciA9IGFjeDU2NWFrbV9jYWJjX21vZGVzW21vZGVdOworCisJcmV0dXJuIHNwcmludGYoYnVmLCAi
JXNcbiIsIG1vZGVfc3RyKTsKK30KKworc3RhdGljIHNzaXplX3QgY2FiY19tb2RlX3N0b3JlKHN0
cnVjdCBkZXZpY2UgKmRldiwKKwkJCSAgICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0
ciwKKwkJCSAgICAgICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBjb3VudCkKK3sKKwlzdHJ1Y3Qg
YWN4NTY1YWttX3BhbmVsICpsY2QgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKKwl1bnNpZ25lZCBp
bnQgaTsKKworCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGFjeDU2NWFrbV9jYWJjX21vZGVz
KTsgaSsrKSB7CisJCWNvbnN0IGNoYXIgKm1vZGVfc3RyID0gYWN4NTY1YWttX2NhYmNfbW9kZXNb
aV07CisJCWludCBjbXBfbGVuID0gc3RybGVuKG1vZGVfc3RyKTsKKworCQlpZiAoY291bnQgPiAw
ICYmIGJ1Zltjb3VudCAtIDFdID09ICdcbicpCisJCQljb3VudC0tOworCQlpZiAoY291bnQgIT0g
Y21wX2xlbikKKwkJCWNvbnRpbnVlOworCisJCWlmIChzdHJuY21wKGJ1ZiwgbW9kZV9zdHIsIGNt
cF9sZW4pID09IDApCisJCQlicmVhazsKKwl9CisKKwlpZiAoaSA9PSBBUlJBWV9TSVpFKGFjeDU2
NWFrbV9jYWJjX21vZGVzKSkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlpZiAoIWxjZC0+aGFzX2Nh
YmMgJiYgaSAhPSAwKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCW11dGV4X2xvY2soJmxjZC0+bXV0
ZXgpOworCWFjeDU2NWFrbV9zZXRfY2FiY19tb2RlKGxjZCwgaSk7CisJbXV0ZXhfdW5sb2NrKCZs
Y2QtPm11dGV4KTsKKworCXJldHVybiBjb3VudDsKK30KKworc3RhdGljIHNzaXplX3QgY2FiY19h
dmFpbGFibGVfbW9kZXNfc2hvdyhzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkJCSBzdHJ1Y3QgZGV2
aWNlX2F0dHJpYnV0ZSAqYXR0ciwKKwkJCQkJIGNoYXIgKmJ1ZikKK3sKKwlzdHJ1Y3QgYWN4NTY1
YWttX3BhbmVsICpsY2QgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKKwl1bnNpZ25lZCBpbnQgaTsK
KwlzaXplX3QgbGVuID0gMDsKKworCWlmICghbGNkLT5oYXNfY2FiYykKKwkJcmV0dXJuIHNwcmlu
dGYoYnVmLCAiJXNcbiIsIGFjeDU2NWFrbV9jYWJjX21vZGVzWzBdKTsKKworCWZvciAoaSA9IDA7
IGkgPCBBUlJBWV9TSVpFKGFjeDU2NWFrbV9jYWJjX21vZGVzKTsgaSsrKQorCQlsZW4gKz0gc3By
aW50ZigmYnVmW2xlbl0sICIlcyVzIiwgaSA/ICIgIiA6ICIiLAorCQkJICAgICAgIGFjeDU2NWFr
bV9jYWJjX21vZGVzW2ldKTsKKworCWJ1ZltsZW4rK10gPSAnXG4nOworCisJcmV0dXJuIGxlbjsK
K30KKworc3RhdGljIERFVklDRV9BVFRSX1JXKGNhYmNfbW9kZSk7CitzdGF0aWMgREVWSUNFX0FU
VFJfUk8oY2FiY19hdmFpbGFibGVfbW9kZXMpOworCitzdGF0aWMgc3RydWN0IGF0dHJpYnV0ZSAq
YWN4NTY1YWttX2NhYmNfYXR0cnNbXSA9IHsKKwkmZGV2X2F0dHJfY2FiY19tb2RlLmF0dHIsCisJ
JmRldl9hdHRyX2NhYmNfYXZhaWxhYmxlX21vZGVzLmF0dHIsCisJTlVMTCwKK307CisKK3N0YXRp
YyBjb25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwIGFjeDU2NWFrbV9jYWJjX2F0dHJfZ3JvdXAg
PSB7CisJLmF0dHJzID0gYWN4NTY1YWttX2NhYmNfYXR0cnMsCit9OworCisvKiAtLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLQorICogQmFja2xpZ2h0IERldmljZQorICovCisKK3N0YXRpYyBpbnQgYWN4NTY1
YWttX2dldF9hY3R1YWxfYnJpZ2h0bmVzcyhzdHJ1Y3QgYWN4NTY1YWttX3BhbmVsICpsY2QpCit7
CisJdTggYnY7CisKKwlhY3g1NjVha21fcmVhZChsY2QsIE1JUElfRENTX0dFVF9ESVNQTEFZX0JS
SUdIVE5FU1MsICZidiwgMSk7CisKKwlyZXR1cm4gYnY7Cit9CisKK3N0YXRpYyB2b2lkIGFjeDU2
NWFrbV9zZXRfYnJpZ2h0bmVzcyhzdHJ1Y3QgYWN4NTY1YWttX3BhbmVsICpsY2QsIGludCBsZXZl
bCkKK3sKKwl1MTYgY3RybDsKKwlpbnQgYnY7CisKKwlidiA9IGxldmVsIHwgKDEgPDwgOCk7CisJ
YWN4NTY1YWttX3dyaXRlKGxjZCwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlfQlJJR0hUTkVTUywgKHU4
ICopJmJ2LCAyKTsKKworCWFjeDU2NWFrbV9yZWFkKGxjZCwgTUlQSV9EQ1NfR0VUX0NPTlRST0xf
RElTUExBWSwgKHU4ICopJmN0cmwsIDEpOworCWlmIChsZXZlbCkKKwkJY3RybCB8PSBDVFJMX0RJ
U1BfQlJJR0hUTkVTU19DVFJMX09OIHwKKwkJCUNUUkxfRElTUF9CQUNLTElHSFRfT047CisJZWxz
ZQorCQljdHJsICY9IH4oQ1RSTF9ESVNQX0JSSUdIVE5FU1NfQ1RSTF9PTiB8CisJCQkgIENUUkxf
RElTUF9CQUNLTElHSFRfT04pOworCisJY3RybCB8PSAxIDw8IDg7CisJYWN4NTY1YWttX3dyaXRl
KGxjZCwgTUlQSV9EQ1NfV1JJVEVfQ09OVFJPTF9ESVNQTEFZLCAodTggKikmY3RybCwgMik7Cit9
CisKK3N0YXRpYyBpbnQgYWN4NTY1YWttX2JsX3VwZGF0ZV9zdGF0dXNfbG9ja2VkKHN0cnVjdCBi
YWNrbGlnaHRfZGV2aWNlICpkZXYpCit7CisJc3RydWN0IGFjeDU2NWFrbV9wYW5lbCAqbGNkID0g
ZGV2X2dldF9kcnZkYXRhKCZkZXYtPmRldik7CisJaW50IGxldmVsOworCisJaWYgKGRldi0+cHJv
cHMuZmJfYmxhbmsgPT0gRkJfQkxBTktfVU5CTEFOSyAmJgorCSAgICBkZXYtPnByb3BzLnBvd2Vy
ID09IEZCX0JMQU5LX1VOQkxBTkspCisJCWxldmVsID0gZGV2LT5wcm9wcy5icmlnaHRuZXNzOwor
CWVsc2UKKwkJbGV2ZWwgPSAwOworCisJYWN4NTY1YWttX3NldF9icmlnaHRuZXNzKGxjZCwgbGV2
ZWwpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgYWN4NTY1YWttX2JsX3VwZGF0ZV9z
dGF0dXMoc3RydWN0IGJhY2tsaWdodF9kZXZpY2UgKmRldikKK3sKKwlzdHJ1Y3QgYWN4NTY1YWtt
X3BhbmVsICpsY2QgPSBkZXZfZ2V0X2RydmRhdGEoJmRldi0+ZGV2KTsKKwlpbnQgcmV0OworCisJ
bXV0ZXhfbG9jaygmbGNkLT5tdXRleCk7CisJcmV0ID0gYWN4NTY1YWttX2JsX3VwZGF0ZV9zdGF0
dXNfbG9ja2VkKGRldik7CisJbXV0ZXhfdW5sb2NrKCZsY2QtPm11dGV4KTsKKworCXJldHVybiBy
ZXQ7Cit9CisKK3N0YXRpYyBpbnQgYWN4NTY1YWttX2JsX2dldF9pbnRlbnNpdHkoc3RydWN0IGJh
Y2tsaWdodF9kZXZpY2UgKmRldikKK3sKKwlzdHJ1Y3QgYWN4NTY1YWttX3BhbmVsICpsY2QgPSBk
ZXZfZ2V0X2RydmRhdGEoJmRldi0+ZGV2KTsKKwl1bnNpZ25lZCBpbnQgaW50ZW5zaXR5OworCisJ
bXV0ZXhfbG9jaygmbGNkLT5tdXRleCk7CisKKwlpZiAoZGV2LT5wcm9wcy5mYl9ibGFuayA9PSBG
Ql9CTEFOS19VTkJMQU5LICYmCisJICAgIGRldi0+cHJvcHMucG93ZXIgPT0gRkJfQkxBTktfVU5C
TEFOSykKKwkJaW50ZW5zaXR5ID0gYWN4NTY1YWttX2dldF9hY3R1YWxfYnJpZ2h0bmVzcyhsY2Qp
OworCWVsc2UKKwkJaW50ZW5zaXR5ID0gMDsKKworCW11dGV4X3VubG9jaygmbGNkLT5tdXRleCk7
CisKKwlyZXR1cm4gaW50ZW5zaXR5OworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGJhY2tsaWdo
dF9vcHMgYWN4NTY1YWttX2JsX29wcyA9IHsKKwkuZ2V0X2JyaWdodG5lc3MgPSBhY3g1NjVha21f
YmxfZ2V0X2ludGVuc2l0eSwKKwkudXBkYXRlX3N0YXR1cyAgPSBhY3g1NjVha21fYmxfdXBkYXRl
X3N0YXR1cywKK307CisKK3N0YXRpYyBpbnQgYWN4NTY1YWttX2JhY2tsaWdodF9pbml0KHN0cnVj
dCBhY3g1NjVha21fcGFuZWwgKmxjZCkKK3sKKwlzdHJ1Y3QgYmFja2xpZ2h0X3Byb3BlcnRpZXMg
cHJvcHMgPSB7CisJCS5mYl9ibGFuayA9IEZCX0JMQU5LX1VOQkxBTkssCisJCS5wb3dlciA9IEZC
X0JMQU5LX1VOQkxBTkssCisJCS50eXBlID0gQkFDS0xJR0hUX1JBVywKKwl9OworCWludCByZXQ7
CisKKwlsY2QtPmJhY2tsaWdodCA9IGJhY2tsaWdodF9kZXZpY2VfcmVnaXN0ZXIobGNkLT5uYW1l
LCAmbGNkLT5zcGktPmRldiwKKwkJCQkJCSAgIGxjZCwgJmFjeDU2NWFrbV9ibF9vcHMsCisJCQkJ
CQkgICAmcHJvcHMpOworCWlmIChJU19FUlIobGNkLT5iYWNrbGlnaHQpKSB7CisJCXJldCA9IFBU
Ul9FUlIobGNkLT5iYWNrbGlnaHQpOworCQlsY2QtPmJhY2tsaWdodCA9IE5VTEw7CisJCXJldHVy
biByZXQ7CisJfQorCisJaWYgKGxjZC0+aGFzX2NhYmMpIHsKKwkJcmV0ID0gc3lzZnNfY3JlYXRl
X2dyb3VwKCZsY2QtPmJhY2tsaWdodC0+ZGV2LmtvYmosCisJCQkJCSAmYWN4NTY1YWttX2NhYmNf
YXR0cl9ncm91cCk7CisJCWlmIChyZXQgPCAwKSB7CisJCQlkZXZfZXJyKCZsY2QtPnNwaS0+ZGV2
LAorCQkJCSIlcyBmYWlsZWQgdG8gY3JlYXRlIHN5c2ZzIGZpbGVzXG4iLCBfX2Z1bmNfXyk7CisJ
CQliYWNrbGlnaHRfZGV2aWNlX3VucmVnaXN0ZXIobGNkLT5iYWNrbGlnaHQpOworCQkJcmV0dXJu
IHJldDsKKwkJfQorCisJCWxjZC0+Y2FiY19tb2RlID0gYWN4NTY1YWttX2dldF9od19jYWJjX21v
ZGUobGNkKTsKKwl9CisKKwlsY2QtPmJhY2tsaWdodC0+cHJvcHMubWF4X2JyaWdodG5lc3MgPSAy
NTU7CisJbGNkLT5iYWNrbGlnaHQtPnByb3BzLmJyaWdodG5lc3MgPSBhY3g1NjVha21fZ2V0X2Fj
dHVhbF9icmlnaHRuZXNzKGxjZCk7CisKKwlhY3g1NjVha21fYmxfdXBkYXRlX3N0YXR1c19sb2Nr
ZWQobGNkLT5iYWNrbGlnaHQpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGFjeDU2
NWFrbV9iYWNrbGlnaHRfY2xlYW51cChzdHJ1Y3QgYWN4NTY1YWttX3BhbmVsICpsY2QpCit7CisJ
aWYgKGxjZC0+aGFzX2NhYmMpCisJCXN5c2ZzX3JlbW92ZV9ncm91cCgmbGNkLT5iYWNrbGlnaHQt
PmRldi5rb2JqLAorCQkJCSAgICZhY3g1NjVha21fY2FiY19hdHRyX2dyb3VwKTsKKworCWJhY2ts
aWdodF9kZXZpY2VfdW5yZWdpc3RlcihsY2QtPmJhY2tsaWdodCk7Cit9CisKKy8qIC0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tCisgKiBEUk0gQnJpZGdlIE9wZXJhdGlvbnMKKyAqLworCitzdGF0aWMgdm9p
ZCBhY3g1NjVha21fc2V0X3NsZWVwX21vZGUoc3RydWN0IGFjeDU2NWFrbV9wYW5lbCAqbGNkLCBp
bnQgb24pCit7CisJaW50IGNtZCA9IG9uID8gTUlQSV9EQ1NfRU5URVJfU0xFRVBfTU9ERSA6IE1J
UElfRENTX0VYSVRfU0xFRVBfTU9ERTsKKwl1bnNpZ25lZCBsb25nIHdhaXQ7CisKKwkvKgorCSAq
IFdlIGhhdmUgdG8ga2VlcCAxMjBtc2VjIGJldHdlZW4gc2xlZXAgaW4vb3V0IGNvbW1hbmRzLgor
CSAqICg4LjIuMTUsIDguMi4xNikuCisJICovCisJd2FpdCA9IGxjZC0+aHdfZ3VhcmRfZW5kIC0g
amlmZmllczsKKwlpZiAoKGxvbmcpd2FpdCA+IDAgJiYgd2FpdCA8PSBsY2QtPmh3X2d1YXJkX3dh
aXQpIHsKKwkJc2V0X2N1cnJlbnRfc3RhdGUoVEFTS19VTklOVEVSUlVQVElCTEUpOworCQlzY2hl
ZHVsZV90aW1lb3V0KHdhaXQpOworCX0KKworCWFjeDU2NWFrbV9jbWQobGNkLCBjbWQpOworCisJ
bGNkLT5od19ndWFyZF93YWl0ID0gbXNlY3NfdG9famlmZmllcygxMjApOworCWxjZC0+aHdfZ3Vh
cmRfZW5kID0gamlmZmllcyArIGxjZC0+aHdfZ3VhcmRfd2FpdDsKK30KKworc3RhdGljIHZvaWQg
YWN4NTY1YWttX3NldF9kaXNwbGF5X3N0YXRlKHN0cnVjdCBhY3g1NjVha21fcGFuZWwgKmxjZCwK
KwkJCQkJaW50IGVuYWJsZWQpCit7CisJaW50IGNtZCA9IGVuYWJsZWQgPyBNSVBJX0RDU19TRVRf
RElTUExBWV9PTiA6IE1JUElfRENTX1NFVF9ESVNQTEFZX09GRjsKKworCWFjeDU2NWFrbV9jbWQo
bGNkLCBjbWQpOworfQorCitzdGF0aWMgaW50IGFjeDU2NWFrbV9wb3dlcl9vbihzdHJ1Y3QgYWN4
NTY1YWttX3BhbmVsICpsY2QpCit7CisJLypGSVhNRSB0d2VhayBtZSAqLworCW1zbGVlcCg1MCk7
CisKKwlncGlvZF9zZXRfdmFsdWUobGNkLT5yZXNldF9ncGlvLCAxKTsKKworCWlmIChsY2QtPmVu
YWJsZWQpIHsKKwkJZGV2X2RiZygmbGNkLT5zcGktPmRldiwgInBhbmVsIGFscmVhZHkgZW5hYmxl
ZFxuIik7CisJCXJldHVybiAwOworCX0KKworCS8qCisJICogV2UgaGF2ZSB0byBtZWV0IGFsbCB0
aGUgZm9sbG93aW5nIGRlbGF5IHJlcXVpcmVtZW50czoKKwkgKiAxLiB0Ulc6IHJlc2V0IHB1bHNl
IHdpZHRoIDEwdXNlYyAoNy4xMi4xKQorCSAqIDIuIHRSVDogcmVzZXQgY2FuY2VsIHRpbWUgNW1z
ZWMgKDcuMTIuMSkKKwkgKiAzLiBQcm92aWRpbmcgUENMSyxIUyxWUyBzaWduYWxzIGZvciAyIGZy
YW1lcyA9IH41MG1zZWMgd29yc3QKKwkgKiAgICBjYXNlICg3LjYuMikKKwkgKiA0LiAxMjBtc2Vj
IGJlZm9yZSB0aGUgc2xlZXAgb3V0IGNvbW1hbmQgKDcuMTIuMSkKKwkgKi8KKwltc2xlZXAoMTIw
KTsKKworCWFjeDU2NWFrbV9zZXRfc2xlZXBfbW9kZShsY2QsIDApOworCWxjZC0+ZW5hYmxlZCA9
IHRydWU7CisKKwkvKiA1bXNlYyBiZXR3ZWVuIHNsZWVwIG91dCBhbmQgdGhlIG5leHQgY29tbWFu
ZC4gKDguMi4xNikgKi8KKwl1c2xlZXBfcmFuZ2UoNTAwMCwgMTAwMDApOworCWFjeDU2NWFrbV9z
ZXRfZGlzcGxheV9zdGF0ZShsY2QsIDEpOworCWFjeDU2NWFrbV9zZXRfY2FiY19tb2RlKGxjZCwg
bGNkLT5jYWJjX21vZGUpOworCisJcmV0dXJuIGFjeDU2NWFrbV9ibF91cGRhdGVfc3RhdHVzX2xv
Y2tlZChsY2QtPmJhY2tsaWdodCk7Cit9CisKK3N0YXRpYyB2b2lkIGFjeDU2NWFrbV9wb3dlcl9v
ZmYoc3RydWN0IGFjeDU2NWFrbV9wYW5lbCAqbGNkKQoreworCWlmICghbGNkLT5lbmFibGVkKQor
CQlyZXR1cm47CisKKwlhY3g1NjVha21fc2V0X2Rpc3BsYXlfc3RhdGUobGNkLCAwKTsKKwlhY3g1
NjVha21fc2V0X3NsZWVwX21vZGUobGNkLCAxKTsKKwlsY2QtPmVuYWJsZWQgPSBmYWxzZTsKKwkv
KgorCSAqIFdlIGhhdmUgdG8gcHJvdmlkZSBQQ0xLLEhTLFZTIHNpZ25hbHMgZm9yIDIgZnJhbWVz
ICh3b3JzdCBjYXNlCisJICogfjUwbXNlYykgYWZ0ZXIgc2VuZGluZyB0aGUgc2xlZXAgaW4gY29t
bWFuZCBhbmQgYXNzZXJ0aW5nIHRoZQorCSAqIHJlc2V0IHNpZ25hbC4gV2UgcHJvYmFibHkgY291
bGQgYXNzZXJ0IHRoZSByZXNldCB3L28gdGhlIGRlbGF5CisJICogYnV0IHdlIHN0aWxsIGRlbGF5
IHRvIGF2b2lkIHBvc3NpYmxlIGFydGlmYWN0cy4gKDcuNi4xKQorCSAqLworCW1zbGVlcCg1MCk7
CisKKwlncGlvZF9zZXRfdmFsdWUobGNkLT5yZXNldF9ncGlvLCAwKTsKKworCS8qIEZJWE1FIG5l
ZWQgdG8gdHdlYWsgdGhpcyBkZWxheSAqLworCW1zbGVlcCgxMDApOworfQorCitzdGF0aWMgaW50
IGFjeDU2NWFrbV9kaXNhYmxlKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQoreworCXN0cnVjdCBh
Y3g1NjVha21fcGFuZWwgKmxjZCA9IHRvX2FjeDU2NWFrbV9kZXZpY2UocGFuZWwpOworCisJbXV0
ZXhfbG9jaygmbGNkLT5tdXRleCk7CisJYWN4NTY1YWttX3Bvd2VyX29mZihsY2QpOworCW11dGV4
X3VubG9jaygmbGNkLT5tdXRleCk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBhY3g1
NjVha21fZW5hYmxlKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQoreworCXN0cnVjdCBhY3g1NjVh
a21fcGFuZWwgKmxjZCA9IHRvX2FjeDU2NWFrbV9kZXZpY2UocGFuZWwpOworCisJbXV0ZXhfbG9j
aygmbGNkLT5tdXRleCk7CisJYWN4NTY1YWttX3Bvd2VyX29uKGxjZCk7CisJbXV0ZXhfdW5sb2Nr
KCZsY2QtPm11dGV4KTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRy
bV9kaXNwbGF5X21vZGUgYWN4NTY1YWttX21vZGUgPSB7CisJLmNsb2NrID0gMjQwMDAsCisJLmhk
aXNwbGF5ID0gODAwLAorCS5oc3luY19zdGFydCA9IDgwMCArIDI4LAorCS5oc3luY19lbmQgPSA4
MDAgKyAyOCArIDQsCisJLmh0b3RhbCA9IDgwMCArIDI4ICsgNCArIDI0LAorCS52ZGlzcGxheSA9
IDQ4MCwKKwkudnN5bmNfc3RhcnQgPSA0ODAgKyAzLAorCS52c3luY19lbmQgPSA0ODAgKyAzICsg
MywKKwkudnRvdGFsID0gNDgwICsgMyArIDMgKyA0LAorCS52cmVmcmVzaCA9IDU3LAorCS50eXBl
ID0gRFJNX01PREVfVFlQRV9EUklWRVIgfCBEUk1fTU9ERV9UWVBFX1BSRUZFUlJFRCwKKwkuZmxh
Z3MgPSBEUk1fTU9ERV9GTEFHX05IU1lOQyB8IERSTV9NT0RFX0ZMQUdfTlZTWU5DLAorCS53aWR0
aF9tbSA9IDc3LAorCS5oZWlnaHRfbW0gPSA0NiwKK307CisKK3N0YXRpYyBpbnQgYWN4NTY1YWtt
X2dldF9tb2RlcyhzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKK3sKKwlzdHJ1Y3QgZHJtX2Nvbm5l
Y3RvciAqY29ubmVjdG9yID0gcGFuZWwtPmNvbm5lY3RvcjsKKwlzdHJ1Y3QgZHJtX2Rpc3BsYXlf
bW9kZSAqbW9kZTsKKworCW1vZGUgPSBkcm1fbW9kZV9kdXBsaWNhdGUocGFuZWwtPmRybSwgJmFj
eDU2NWFrbV9tb2RlKTsKKwlpZiAoIW1vZGUpCisJCXJldHVybiAtRU5PTUVNOworCisJZHJtX21v
ZGVfc2V0X25hbWUobW9kZSk7CisJZHJtX21vZGVfcHJvYmVkX2FkZChjb25uZWN0b3IsIG1vZGUp
OworCisJY29ubmVjdG9yLT5kaXNwbGF5X2luZm8ud2lkdGhfbW0gPSBhY3g1NjVha21fbW9kZS53
aWR0aF9tbTsKKwljb25uZWN0b3ItPmRpc3BsYXlfaW5mby5oZWlnaHRfbW0gPSBhY3g1NjVha21f
bW9kZS5oZWlnaHRfbW07CisJY29ubmVjdG9yLT5kaXNwbGF5X2luZm8uYnVzX2ZsYWdzID0gRFJN
X0JVU19GTEFHX0RFX0hJR0gKKwkJCQkJICB8IERSTV9CVVNfRkxBR19TWU5DX1NBTVBMRV9QT1NF
REdFCisJCQkJCSAgfCBEUk1fQlVTX0ZMQUdfUElYREFUQV9TQU1QTEVfTkVHRURHRTsKKworCXJl
dHVybiAxOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9wYW5lbF9mdW5jcyBhY3g1NjVh
a21fZnVuY3MgPSB7CisJLmRpc2FibGUgPSBhY3g1NjVha21fZGlzYWJsZSwKKwkuZW5hYmxlID0g
YWN4NTY1YWttX2VuYWJsZSwKKwkuZ2V0X21vZGVzID0gYWN4NTY1YWttX2dldF9tb2RlcywKK307
CisKKy8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisgKiBQcm9iZSwgRGV0ZWN0IGFuZCBSZW1vdmUK
KyAqLworCitzdGF0aWMgaW50IGFjeDU2NWFrbV9kZXRlY3Qoc3RydWN0IGFjeDU2NWFrbV9wYW5l
bCAqbGNkKQoreworCV9fYmUzMiB2YWx1ZTsKKwl1MzIgc3RhdHVzOworCWludCByZXQgPSAwOwor
CisJLyoKKwkgKiBBZnRlciBiZWluZyB0YWtlbiBvdXQgb2YgcmVzZXQgdGhlIHBhbmVsIG5lZWRz
IDVtcyBiZWZvcmUgdGhlIGZpcnN0CisJICogY29tbWFuZCBjYW4gYmUgc2VudC4KKwkgKi8KKwln
cGlvZF9zZXRfdmFsdWUobGNkLT5yZXNldF9ncGlvLCAxKTsKKwl1c2xlZXBfcmFuZ2UoNTAwMCwg
MTAwMDApOworCisJYWN4NTY1YWttX3JlYWQobGNkLCBNSVBJX0RDU19HRVRfRElTUExBWV9TVEFU
VVMsICh1OCAqKSZ2YWx1ZSwgNCk7CisJc3RhdHVzID0gX19iZTMyX3RvX2NwdSh2YWx1ZSk7CisJ
bGNkLT5lbmFibGVkID0gKHN0YXR1cyAmICgxIDw8IDE3KSkgJiYgKHN0YXR1cyAmICgxIDw8IDEw
KSk7CisKKwlkZXZfZGJnKCZsY2QtPnNwaS0+ZGV2LAorCQkiTENEIHBhbmVsICVzIGJ5IGJvb3Rs
b2FkZXIgKHN0YXR1cyAweCUwNHgpXG4iLAorCQlsY2QtPmVuYWJsZWQgPyAiZW5hYmxlZCIgOiAi
ZGlzYWJsZWQgIiwgc3RhdHVzKTsKKworCWFjeDU2NWFrbV9yZWFkKGxjZCwgTUlQSV9EQ1NfR0VU
X0RJU1BMQVlfSUQsIGxjZC0+ZGlzcGxheV9pZCwgMyk7CisJZGV2X2RiZygmbGNkLT5zcGktPmRl
diwgIk1JUEkgZGlzcGxheSBJRDogJTAyeCUwMnglMDJ4XG4iLAorCQlsY2QtPmRpc3BsYXlfaWRb
MF0sIGxjZC0+ZGlzcGxheV9pZFsxXSwgbGNkLT5kaXNwbGF5X2lkWzJdKTsKKworCXN3aXRjaCAo
bGNkLT5kaXNwbGF5X2lkWzBdKSB7CisJY2FzZSAweDEwOgorCQlsY2QtPm1vZGVsID0gTUlQSURf
VkVSX0FDWDU2NUFLTTsKKwkJbGNkLT5uYW1lID0gImFjeDU2NWFrbSI7CisJCWxjZC0+aGFzX2Jj
ID0gMTsKKwkJbGNkLT5oYXNfY2FiYyA9IDE7CisJCWJyZWFrOworCWNhc2UgMHgyOToKKwkJbGNk
LT5tb2RlbCA9IE1JUElEX1ZFUl9MNEYwMDMxMTsKKwkJbGNkLT5uYW1lID0gImw0ZjAwMzExIjsK
KwkJYnJlYWs7CisJY2FzZSAweDQ1OgorCQlsY2QtPm1vZGVsID0gTUlQSURfVkVSX0xQSDg5MjM7
CisJCWxjZC0+bmFtZSA9ICJscGg4OTIzIjsKKwkJYnJlYWs7CisJY2FzZSAweDgzOgorCQlsY2Qt
Pm1vZGVsID0gTUlQSURfVkVSX0xTMDQxWTM7CisJCWxjZC0+bmFtZSA9ICJsczA0MXkzIjsKKwkJ
YnJlYWs7CisJZGVmYXVsdDoKKwkJbGNkLT5uYW1lID0gInVua25vd24iOworCQlkZXZfZXJyKCZs
Y2QtPnNwaS0+ZGV2LCAidW5rbm93biBkaXNwbGF5IElEXG4iKTsKKwkJcmV0ID0gLUVOT0RFVjsK
KwkJZ290byBkb25lOworCX0KKworCWxjZC0+cmV2aXNpb24gPSBsY2QtPmRpc3BsYXlfaWRbMV07
CisKKwlkZXZfaW5mbygmbGNkLT5zcGktPmRldiwgIiVzIHJldiAlMDJ4IHBhbmVsIGRldGVjdGVk
XG4iLAorCQkgbGNkLT5uYW1lLCBsY2QtPnJldmlzaW9uKTsKKworZG9uZToKKwlpZiAoIWxjZC0+
ZW5hYmxlZCkKKwkJZ3Bpb2Rfc2V0X3ZhbHVlKGxjZC0+cmVzZXRfZ3BpbywgMCk7CisKKwlyZXR1
cm4gcmV0OworfQorCitzdGF0aWMgaW50IGFjeDU2NWFrbV9wcm9iZShzdHJ1Y3Qgc3BpX2Rldmlj
ZSAqc3BpKQoreworCXN0cnVjdCBhY3g1NjVha21fcGFuZWwgKmxjZDsKKwlpbnQgcmV0OworCisJ
bGNkID0gZGV2bV9remFsbG9jKCZzcGktPmRldiwgc2l6ZW9mKCpsY2QpLCBHRlBfS0VSTkVMKTsK
KwlpZiAobGNkID09IE5VTEwpCisJCXJldHVybiAtRU5PTUVNOworCisJc3BpX3NldF9kcnZkYXRh
KHNwaSwgbGNkKTsKKwlzcGktPm1vZGUgPSBTUElfTU9ERV8zOworCisJbGNkLT5zcGkgPSBzcGk7
CisJbXV0ZXhfaW5pdCgmbGNkLT5tdXRleCk7CisKKwlsY2QtPnJlc2V0X2dwaW8gPSBkZXZtX2dw
aW9kX2dldCgmc3BpLT5kZXYsICJyZXNldCIsIEdQSU9EX09VVF9MT1cpOworCWlmIChJU19FUlIo
bGNkLT5yZXNldF9ncGlvKSkgeworCQlkZXZfZXJyKCZzcGktPmRldiwgImZhaWxlZCB0byBnZXQg
cmVzZXQgR1BJT1xuIik7CisJCXJldHVybiBQVFJfRVJSKGxjZC0+cmVzZXRfZ3Bpbyk7CisJfQor
CisJcmV0ID0gYWN4NTY1YWttX2RldGVjdChsY2QpOworCWlmIChyZXQgPCAwKSB7CisJCWRldl9l
cnIoJnNwaS0+ZGV2LCAicGFuZWwgZGV0ZWN0aW9uIGZhaWxlZFxuIik7CisJCXJldHVybiByZXQ7
CisJfQorCisJaWYgKGxjZC0+aGFzX2JjKSB7CisJCXJldCA9IGFjeDU2NWFrbV9iYWNrbGlnaHRf
aW5pdChsY2QpOworCQlpZiAocmV0IDwgMCkKKwkJCXJldHVybiByZXQ7CisJfQorCisJZHJtX3Bh
bmVsX2luaXQoJmxjZC0+cGFuZWwpOworCWxjZC0+cGFuZWwuZGV2ID0gJmxjZC0+c3BpLT5kZXY7
CisJbGNkLT5wYW5lbC5mdW5jcyA9ICZhY3g1NjVha21fZnVuY3M7CisKKwlyZXQgPSBkcm1fcGFu
ZWxfYWRkKCZsY2QtPnBhbmVsKTsKKwlpZiAocmV0IDwgMCkgeworCQlpZiAobGNkLT5oYXNfYmMp
CisJCQlhY3g1NjVha21fYmFja2xpZ2h0X2NsZWFudXAobGNkKTsKKwkJcmV0dXJuIHJldDsKKwl9
CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBhY3g1NjVha21fcmVtb3ZlKHN0cnVjdCBz
cGlfZGV2aWNlICpzcGkpCit7CisJc3RydWN0IGFjeDU2NWFrbV9wYW5lbCAqbGNkID0gc3BpX2dl
dF9kcnZkYXRhKHNwaSk7CisKKwlkcm1fcGFuZWxfcmVtb3ZlKCZsY2QtPnBhbmVsKTsKKworCWlm
IChsY2QtPmhhc19iYykKKwkJYWN4NTY1YWttX2JhY2tsaWdodF9jbGVhbnVwKGxjZCk7CisKKwlk
cm1fcGFuZWxfZGlzYWJsZSgmbGNkLT5wYW5lbCk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGlj
IGNvbnN0IHN0cnVjdCBvZl9kZXZpY2VfaWQgYWN4NTY1YWttX29mX21hdGNoW10gPSB7CisJeyAu
Y29tcGF0aWJsZSA9ICJzb255LGFjeDU2NWFrbSIsIH0sCisJeyAvKiBzZW50aW5lbCAqLyB9LAor
fTsKKworTU9EVUxFX0RFVklDRV9UQUJMRShvZiwgYWN4NTY1YWttX29mX21hdGNoKTsKKworc3Rh
dGljIHN0cnVjdCBzcGlfZHJpdmVyIGFjeDU2NWFrbV9kcml2ZXIgPSB7CisJLnByb2JlCQk9IGFj
eDU2NWFrbV9wcm9iZSwKKwkucmVtb3ZlCQk9IGFjeDU2NWFrbV9yZW1vdmUsCisJLmRyaXZlcgkJ
PSB7CisJCS5uYW1lCT0gInBhbmVsLXNvbnktYWN4NTY1YWttIiwKKwkJLm9mX21hdGNoX3RhYmxl
ID0gYWN4NTY1YWttX29mX21hdGNoLAorCX0sCit9OworCittb2R1bGVfc3BpX2RyaXZlcihhY3g1
NjVha21fZHJpdmVyKTsKKworTU9EVUxFX0FMSUFTKCJzcGk6c29ueSxhY3g1NjVha20iKTsKK01P
RFVMRV9BVVRIT1IoIk5va2lhIENvcnBvcmF0aW9uIik7CitNT0RVTEVfREVTQ1JJUFRJT04oIlNv
bnkgQUNYNTY1QUtNIExDRCBQYW5lbCBEcml2ZXIiKTsKK01PRFVMRV9MSUNFTlNFKCJHUEwiKTsK
LS0gClJlZ2FyZHMsCgpMYXVyZW50IFBpbmNoYXJ0CgpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBs
aXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1h
bi9saXN0aW5mby9kcmktZGV2ZWw=
