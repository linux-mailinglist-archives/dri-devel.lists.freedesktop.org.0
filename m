Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id EE4CC70277
	for <lists+dri-devel@lfdr.de>; Mon, 22 Jul 2019 16:38:43 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 34ED589913;
	Mon, 22 Jul 2019 14:38:41 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-40132.protonmail.ch (mail-40132.protonmail.ch
 [185.70.40.132])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 32DDB89913
 for <dri-devel@lists.freedesktop.org>; Mon, 22 Jul 2019 14:38:40 +0000 (UTC)
Date: Mon, 22 Jul 2019 14:38:34 +0000
To: dri-devel@lists.freedesktop.org
From: Simon Ser <contact@emersion.fr>
Subject: [PATCH] drm: fix out-of-bounds access with short VSDB blocks
Message-ID: <I1AvHeOKt0LxZk5YfvzAd_iDpe5NWuhHNYueQ3Ubp3ilF-69Q8u5Nn_I-mqJt2zPKq1aoy2UsgT5hFUM1KMKVj8qXQHPqlvuVSulRLe1EAI=@emersion.fr>
Feedback-ID: FsVprHBOgyvh0T8bxcZ0CmvJCosWkwVUg658e_lOUQMnA9qynD8O1lGeniuBDfPSkDAUuhiKfOIXUZBfarMyvA==:Ext:ProtonMail
MIME-Version: 1.0
X-Spam-Status: No, score=-1.2 required=7.0 tests=ALL_TRUSTED,DKIM_SIGNED,
 DKIM_VALID,DKIM_VALID_AU,DKIM_VALID_EF autolearn=ham
 autolearn_force=no version=3.4.2
X-Spam-Checker-Version: SpamAssassin 3.4.2 (2018-09-13) on mail.protonmail.ch
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=emersion.fr; s=protonmail; t=1563806317;
 bh=gF5AVJ06iLehcqvhoe1pzYx/ymZ7c1phxxZ+5dcbZnA=;
 h=Date:To:From:Cc:Reply-To:Subject:Feedback-ID:From;
 b=JWyJ2i3acYrZsQwsu29J2bUZn7aDVdYuZRfhSRZjyxH+tWDmf8oSZ+4wIcdkxBzJw
 Nt3uw5AdFlmMF3aZcgujDCIkx2oZ9B6wgxzRDMiRJw6HhUyw1DB36kwrCMVZRhIRDL
 t3NLnAEmGxbLLxwZFIvtgKQJ5myDyQNp0T/mjclg=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Reply-To: Simon Ser <contact@emersion.fr>
Cc: Simon Ser <simon.ser@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogU2ltb24gU2VyIDxzaW1vbi5zZXJAaW50ZWwuY29tPgoKVGhlIFZTREIgcGFyc2luZyBj
b2RlIGNvbnRhaW5zIGEgZmV3IGxlbiA+PSBOIGNoZWNrcywgYWNjZXNzaW5nIGRiW05dIG9uCnN1
Y2Nlc3MuIEhvd2V2ZXIgaWYgbGVuID09IE4sIGRiW05dIGlzIG91dC1vZi1ib3VuZHMuCgpUaGlz
IGNvbW1pdCBjaGFuZ2VzIHRoZSBjaGVja3MgdG8gdGVzdCBmb3IgbGVuID4gTi4KClNpZ25lZC1v
ZmYtYnk6IFNpbW9uIFNlciA8Y29udGFjdEBlbWVyc2lvbi5mcj4KLS0tCiBkcml2ZXJzL2dwdS9k
cm0vZHJtX2VkaWQuYyB8IDI0ICsrKysrKysrKysrKy0tLS0tLS0tLS0tLQogMSBmaWxlIGNoYW5n
ZWQsIDEyIGluc2VydGlvbnMoKyksIDEyIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9kcm1fZWRpZC5jIGIvZHJpdmVycy9ncHUvZHJtL2RybV9lZGlkLmMKaW5kZXgg
ODJhNGNlZWQzZmNmLi4xM2Q2MzJmMTQxNzIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9k
cm1fZWRpZC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fZWRpZC5jCkBAIC0zNTY5LDcgKzM1
NjksNyBAQCBkb19oZG1pX3ZzZGJfbW9kZXMoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3Rv
ciwgY29uc3QgdTggKmRiLCB1OCBsZW4sCiAJdmljX2xlbiA9IGRiWzggKyBvZmZzZXRdID4+IDU7
CiAJaGRtaV8zZF9sZW4gPSBkYls4ICsgb2Zmc2V0XSAmIDB4MWY7CgotCWZvciAoaSA9IDA7IGkg
PCB2aWNfbGVuICYmIGxlbiA+PSAoOSArIG9mZnNldCArIGkpOyBpKyspIHsKKwlmb3IgKGkgPSAw
OyBpIDwgdmljX2xlbiAmJiBsZW4gPiAoOSArIG9mZnNldCArIGkpOyBpKyspIHsKIAkJdTggdmlj
OwoKIAkJdmljID0gZGJbOSArIG9mZnNldCArIGldOwpAQCAtMzk3MSwxMSArMzk3MSwxMSBAQCBk
cm1fcGFyc2VfaGRyX21ldGFkYXRhX2Jsb2NrKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0
b3IsIGNvbnN0IHU4ICpkYikKIAljb25uZWN0b3ItPmhkcl9zaW5rX21ldGFkYXRhLmhkbWlfdHlw
ZTEubWV0YWRhdGFfdHlwZSA9CiAJCQkJCQloZHJfbWV0YWRhdGFfdHlwZShkYik7CgotCWlmIChs
ZW4gPj0gNCkKKwlpZiAobGVuID4gNCkKIAkJY29ubmVjdG9yLT5oZHJfc2lua19tZXRhZGF0YS5o
ZG1pX3R5cGUxLm1heF9jbGwgPSBkYls0XTsKLQlpZiAobGVuID49IDUpCisJaWYgKGxlbiA+IDUp
CiAJCWNvbm5lY3Rvci0+aGRyX3NpbmtfbWV0YWRhdGEuaGRtaV90eXBlMS5tYXhfZmFsbCA9IGRi
WzVdOwotCWlmIChsZW4gPj0gNikKKwlpZiAobGVuID4gNikKIAkJY29ubmVjdG9yLT5oZHJfc2lu
a19tZXRhZGF0YS5oZG1pX3R5cGUxLm1pbl9jbGwgPSBkYls2XTsKIH0KCkBAIC0zOTg0LDE5ICsz
OTg0LDE5IEBAIGRybV9wYXJzZV9oZG1pX3ZzZGJfYXVkaW8oc3RydWN0IGRybV9jb25uZWN0b3Ig
KmNvbm5lY3RvciwgY29uc3QgdTggKmRiKQogewogCXU4IGxlbiA9IGNlYV9kYl9wYXlsb2FkX2xl
bihkYik7CgotCWlmIChsZW4gPj0gNiAmJiAoZGJbNl0gJiAoMSA8PCA3KSkpCisJaWYgKGxlbiA+
IDYgJiYgKGRiWzZdICYgKDEgPDwgNykpKQogCQljb25uZWN0b3ItPmVsZFtEUk1fRUxEX1NBRF9D
T1VOVF9DT05OX1RZUEVdIHw9IERSTV9FTERfU1VQUE9SVFNfQUk7Ci0JaWYgKGxlbiA+PSA4KSB7
CisJaWYgKGxlbiA+IDgpIHsKIAkJY29ubmVjdG9yLT5sYXRlbmN5X3ByZXNlbnRbMF0gPSBkYls4
XSA+PiA3OwogCQljb25uZWN0b3ItPmxhdGVuY3lfcHJlc2VudFsxXSA9IChkYls4XSA+PiA2KSAm
IDE7CiAJfQotCWlmIChsZW4gPj0gOSkKKwlpZiAobGVuID4gOSkKIAkJY29ubmVjdG9yLT52aWRl
b19sYXRlbmN5WzBdID0gZGJbOV07Ci0JaWYgKGxlbiA+PSAxMCkKKwlpZiAobGVuID4gMTApCiAJ
CWNvbm5lY3Rvci0+YXVkaW9fbGF0ZW5jeVswXSA9IGRiWzEwXTsKLQlpZiAobGVuID49IDExKQor
CWlmIChsZW4gPiAxMSkKIAkJY29ubmVjdG9yLT52aWRlb19sYXRlbmN5WzFdID0gZGJbMTFdOwot
CWlmIChsZW4gPj0gMTIpCisJaWYgKGxlbiA+IDEyKQogCQljb25uZWN0b3ItPmF1ZGlvX2xhdGVu
Y3lbMV0gPSBkYlsxMl07CgogCURSTV9ERUJVR19LTVMoIkhETUk6IGxhdGVuY3kgcHJlc2VudCAl
ZCAlZCwgIgpAQCAtNDU1OSw5ICs0NTU5LDkgQEAgZHJtX3BhcnNlX2hkbWlfdnNkYl92aWRlbyhz
dHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBjb25zdCB1OCAqZGIpCiAJc3RydWN0IGRy
bV9kaXNwbGF5X2luZm8gKmluZm8gPSAmY29ubmVjdG9yLT5kaXNwbGF5X2luZm87CiAJdTggbGVu
ID0gY2VhX2RiX3BheWxvYWRfbGVuKGRiKTsKCi0JaWYgKGxlbiA+PSA2KQorCWlmIChsZW4gPiA2
KQogCQlpbmZvLT5kdmlfZHVhbCA9IGRiWzZdICYgMTsKLQlpZiAobGVuID49IDcpCisJaWYgKGxl
biA+IDcpCiAJCWluZm8tPm1heF90bWRzX2Nsb2NrID0gZGJbN10gKiA1MDAwOwoKIAlEUk1fREVC
VUdfS01TKCJIRE1JOiBEVkkgZHVhbCAlZCwgIgotLQoyLjIyLjAKCgpfX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRy
aS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5v
cmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
