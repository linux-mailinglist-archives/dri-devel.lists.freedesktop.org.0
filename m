Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id DEDCB31F8C5
	for <lists+dri-devel@lfdr.de>; Fri, 19 Feb 2021 13:00:58 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8D6FE6EB15;
	Fri, 19 Feb 2021 12:00:56 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from new2-smtp.messagingengine.com (new2-smtp.messagingengine.com
 [66.111.4.224])
 by gabe.freedesktop.org (Postfix) with ESMTPS id EE1B76EB0C;
 Fri, 19 Feb 2021 12:00:52 +0000 (UTC)
Received: from compute1.internal (compute1.nyi.internal [10.202.2.41])
 by mailnew.nyi.internal (Postfix) with ESMTP id 632BE5803B6;
 Fri, 19 Feb 2021 07:00:52 -0500 (EST)
Received: from mailfrontend2 ([10.202.2.163])
 by compute1.internal (MEProxy); Fri, 19 Feb 2021 07:00:52 -0500
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=cerno.tech; h=
 from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-type:content-transfer-encoding; s=fm2; bh=
 8SiuRJvmDBxHkppOl7XNYlYL81u802Dvun023WYT7VU=; b=DkpTg+I/R5IM2VIh
 8GygxQO13JiX997ohIsmFTIRfQc/Lr+CdTruqK9Tuio5Wlt3jLTl2uT9LFjjIbV+
 OXtBQUs+gNKLIaauIYxjTxP3ycl9/p5yf2TBjELUHjaToybW9/qfdwZqGzQhpD/3
 75GQeuOAwVZFsxS9KsxQ6ScJJyJflOekOx3dub61BVGYMZW6nv3V7AvjKhAwI1Ne
 CBZAM4HVofYyjfrnPkcq0MpUvXoIGu/sWj+EcTWLZqRHPSUmjEv6UmxFixb1HrIn
 4KZH4uCJlRTsDk3e8gDomQZQpD5Ps34C0YtmjVWDJK+4s0ZP7xalRo6vZDkKvF74
 T1qYwQ==
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=
 messagingengine.com; h=cc:content-transfer-encoding:content-type
 :date:from:in-reply-to:message-id:mime-version:references
 :subject:to:x-me-proxy:x-me-proxy:x-me-sender:x-me-sender
 :x-sasl-enc; s=fm2; bh=8SiuRJvmDBxHkppOl7XNYlYL81u802Dvun023WYT7
 VU=; b=t892QCGn2e6UUSzmdd7un9ZIOVN5CgA5ztWWMEBViq1lrSuxl+D/s0T/c
 SM6X88okWpW8C98rXzRbUiYUSGtMJWquGH8P+bIGDj1F1T/YZADWEIPrqTYMiIBl
 mPJSjkJNUAe48RCrs/MoRej/mkkaU8l3k92QZLOgTwaZaYFnSSB6wc28DGhOW5pl
 gvo1PlxLeJ89lyHiwGlJoJQqJhUSnc/Z9uKUEmsGiYzSR79L37seZ0i+4BHvOvHt
 JB/Kbdq637ySFJbF4WZK4SjRKagzs0WC59KFgh6SgyaiWTMj2jrX2vh4kreDGCSb
 kbZamBKzoUH/eD4uXcQiIgZsXfbwQ==
X-ME-Sender: <xms:c6gvYCQQvnhiuX7Zibxn9J6U1wRvLRuRq8Ho_Z5Xi40PEbt0xmVcMw>
 <xme:c6gvYNlJ9onAXWsP1qDHrIfuBMhtM6FZgxpLYG8AXJazRucYDpF-Kwez5M7fvOTbl
 YVsc9X2gc1p8QtZ-qg>
X-ME-Proxy-Cause: gggruggvucftvghtrhhoucdtuddrgeduledrjeeigdefhecutefuodetggdotefrodftvf
 curfhrohhfihhlvgemucfhrghsthforghilhdpqfgfvfdpuffrtefokffrpgfnqfghnecu
 uegrihhlohhuthemuceftddtnecusecvtfgvtghiphhivghnthhsucdlqddutddtmdenuc
 fjughrpefhvffufffkofgjfhggtgfgsehtkeertdertdejnecuhfhrohhmpeforgigihhm
 vgcutfhiphgrrhguuceomhgrgihimhgvsegtvghrnhhordhtvggthheqnecuggftrfgrth
 htvghrnhepjeeugfegkeffgfeuvedtvddufffhjeffjeejvddvudduteehhfefhfefgeei
 keeknecukfhppeeltddrkeelrdeikedrjeeinecuvehluhhsthgvrhfuihiivgeptdenuc
 frrghrrghmpehmrghilhhfrhhomhepmhgrgihimhgvsegtvghrnhhordhtvggthh
X-ME-Proxy: <xmx:c6gvYFKhwo1DrLPmgO7-C4lqhYNj2h9OtGL4f90gq5ae06m_dAkykA>
 <xmx:c6gvYIWhQc-YMc79ikXcGdleik9v8qaAp5ia0_D2QQXwXbxvbfBggA>
 <xmx:c6gvYCE6Chv_wrU0-s5YlnEVK-bpOkwrjOA120QQeN2oCKutBtgR-A>
 <xmx:dKgvYIXFbFyZbCuC88G8wrZiDwCXiiXXP6m__kSRrc7O50J9L_xmZA>
Received: from localhost (lfbn-tou-1-1502-76.w90-89.abo.wanadoo.fr
 [90.89.68.76])
 by mail.messagingengine.com (Postfix) with ESMTPA id DF7651080057;
 Fri, 19 Feb 2021 07:00:50 -0500 (EST)
From: Maxime Ripard <maxime@cerno.tech>
To: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
 Thomas Zimmermann <tzimmermann@suse.de>, Maxime Ripard <maxime@cerno.tech>,
 Daniel Vetter <daniel.vetter@intel.com>, David Airlie <airlied@linux.ie>
Subject: [PATCH v3 06/11] drm: Use state helper instead of plane state pointer
 in atomic_check
Date: Fri, 19 Feb 2021 13:00:26 +0100
Message-Id: <20210219120032.260676-6-maxime@cerno.tech>
X-Mailer: git-send-email 2.29.2
In-Reply-To: <20210219120032.260676-1-maxime@cerno.tech>
References: <20210219120032.260676-1-maxime@cerno.tech>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Sean Paul <sean@poorly.run>, freedreno@lists.freedesktop.org,
 Tomi Valkeinen <tomba@kernel.org>, Sascha Hauer <s.hauer@pengutronix.de>,
 Jyri Sarha <jyri.sarha@iki.fi>, dri-devel@lists.freedesktop.org,
 linux-kernel@vger.kernel.org, Paul Cercueil <paul@crapouillou.net>,
 NXP Linux Team <linux-imx@nxp.com>, linux-arm-msm@vger.kernel.org,
 linux-mips@vger.kernel.org, Shawn Guo <shawnguo@kernel.org>,
 Pengutronix Kernel Team <kernel@pengutronix.de>,
 linux-arm-kernel@lists.infradead.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

TWFueSBkcml2ZXJzIHJlZmVyZW5jZSB0aGUgcGxhbmUtPnN0YXRlIHBvaW50ZXIgaW4gb3JkZXIg
dG8gZ2V0IHRoZQpjdXJyZW50IHBsYW5lIHN0YXRlIGluIHRoZWlyIGF0b21pY19jaGVjayBob29r
LCB3aGljaCB3b3VsZCBiZSB0aGUgb2xkCnBsYW5lIHN0YXRlIGluIHRoZSBnbG9iYWwgYXRvbWlj
IHN0YXRlIHNpbmNlIF9zd2FwX3N0YXRlIGhhc24ndCBoYXBwZW5lZAp3aGVuIGF0b21pY19jaGVj
ayBpcyBydW4uCgpVc2UgdGhlIGRybV9hdG9taWNfZ2V0X29sZF9wbGFuZV9zdGF0ZSBoZWxwZXIg
dG8gZ2V0IHRoYXQgc3RhdGUgdG8gbWFrZQppdCBtb3JlIG9idmlvdXMuCgpUaGlzIHdhcyBtYWRl
IHVzaW5nIHRoZSBjb2NjaW5lbGxlIHNjcmlwdCBiZWxvdzoKCkAgcGxhbmVfYXRvbWljX2Z1bmMg
QAppZGVudGlmaWVyIGhlbHBlcnM7CmlkZW50aWZpZXIgZnVuYzsKQEAKCnN0YXRpYyBzdHJ1Y3Qg
ZHJtX3BsYW5lX2hlbHBlcl9mdW5jcyBoZWxwZXJzID0gewoJLi4uLAoJLmF0b21pY19jaGVjayA9
IGZ1bmMsCgkuLi4sCn07CgpAIHJlcGxhY2VzX29sZF9zdGF0ZSBACmlkZW50aWZpZXIgcGxhbmVf
YXRvbWljX2Z1bmMuZnVuYzsKaWRlbnRpZmllciBwbGFuZSwgc3RhdGUsIHBsYW5lX3N0YXRlOwpA
QAoKIGZ1bmMoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRl
ICpzdGF0ZSkgewogCS4uLgotCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlID0g
cGxhbmUtPnN0YXRlOworCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlID0gZHJt
X2F0b21pY19nZXRfb2xkX3BsYW5lX3N0YXRlKHN0YXRlLCBwbGFuZSk7CiAJLi4uCiB9CgpAQApp
ZGVudGlmaWVyIHBsYW5lX2F0b21pY19mdW5jLmZ1bmM7CmlkZW50aWZpZXIgcGxhbmUsIHN0YXRl
LCBwbGFuZV9zdGF0ZTsKQEAKCiBmdW5jKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLCBzdHJ1Y3Qg
ZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpIHsKIAlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpwbGFu
ZV9zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X29sZF9wbGFuZV9zdGF0ZShzdGF0ZSwgcGxhbmUpOwog
CTwuLi4KLQlwbGFuZS0+c3RhdGUKKwlwbGFuZV9zdGF0ZQogCS4uLj4KIH0KCkAgYWRkc19vbGRf
c3RhdGUgQAppZGVudGlmaWVyIHBsYW5lX2F0b21pY19mdW5jLmZ1bmM7CmlkZW50aWZpZXIgcGxh
bmUsIHN0YXRlOwpAQAoKIGZ1bmMoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsIHN0cnVjdCBkcm1f
YXRvbWljX3N0YXRlICpzdGF0ZSkgeworCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9sZF9wbGFu
ZV9zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X29sZF9wbGFuZV9zdGF0ZShzdGF0ZSwgcGxhbmUpOwog
CTwuLi4KLQlwbGFuZS0+c3RhdGUKKwlvbGRfcGxhbmVfc3RhdGUKIAkuLi4+CiB9CgpAIGluY2x1
ZGUgZGVwZW5kcyBvbiBhZGRzX29sZF9zdGF0ZSB8fCByZXBsYWNlc19vbGRfc3RhdGUgQApAQAoK
ICNpbmNsdWRlIDxkcm0vZHJtX2F0b21pYy5oPgoKQCBub19pbmNsdWRlIGRlcGVuZHMgb24gIWlu
Y2x1ZGUgJiYgKGFkZHNfb2xkX3N0YXRlIHx8IHJlcGxhY2VzX29sZF9zdGF0ZSkgQApAQAoKKyAj
aW5jbHVkZSA8ZHJtL2RybV9hdG9taWMuaD4KICAjaW5jbHVkZSA8ZHJtLy4uLj4KClJldmlld2Vk
LWJ5OiBWaWxsZSBTeXJqw6Rsw6QgPHZpbGxlLnN5cmphbGFAbGludXguaW50ZWwuY29tPgpTaWdu
ZWQtb2ZmLWJ5OiBNYXhpbWUgUmlwYXJkIDxtYXhpbWVAY2Vybm8udGVjaD4KCi0tLQoKQ2hhbmdl
cyBmcm9tIHYyOgogIC0gcy8uLi4vPC4uLi8gaW4gdGhlIGNvY2NpbmVsbGUgc2NyaXB0IGFzIHN1
Z2dlc3RlZCBieSBWaWxsZQotLS0KIGRyaXZlcnMvZ3B1L2RybS9pbXgvaXB1djMtcGxhbmUuYyAg
ICAgICAgICB8ICAzICsrLQogZHJpdmVycy9ncHUvZHJtL2luZ2VuaWMvaW5nZW5pYy1kcm0tZHJ2
LmMgIHwgMTYgKysrKysrKysrLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2luZ2VuaWMvaW5nZW5p
Yy1pcHUuYyAgICAgIHwgIDggKysrKystLS0KIGRyaXZlcnMvZ3B1L2RybS9tc20vZGlzcC9tZHA1
L21kcDVfcGxhbmUuYyB8ICA0ICsrKy0KIGRyaXZlcnMvZ3B1L2RybS90aWxjZGMvdGlsY2RjX3Bs
YW5lLmMgICAgICB8ICAzICsrLQogNSBmaWxlcyBjaGFuZ2VkLCAyMSBpbnNlcnRpb25zKCspLCAx
MyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaW14L2lwdXYzLXBs
YW5lLmMgYi9kcml2ZXJzL2dwdS9kcm0vaW14L2lwdXYzLXBsYW5lLmMKaW5kZXggYjVmNjEyMzg1
MGJiLi42NDg0NTkyZTNmODYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pbXgvaXB1djMt
cGxhbmUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaW14L2lwdXYzLXBsYW5lLmMKQEAgLTM0MSw3
ICszNDEsOCBAQCBzdGF0aWMgaW50IGlwdV9wbGFuZV9hdG9taWNfY2hlY2soc3RydWN0IGRybV9w
bGFuZSAqcGxhbmUsCiB7CiAJc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqbmV3X3N0YXRlID0gZHJt
X2F0b21pY19nZXRfbmV3X3BsYW5lX3N0YXRlKHN0YXRlLAogCQkJCQkJCQkJICAgcGxhbmUpOwot
CXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9sZF9zdGF0ZSA9IHBsYW5lLT5zdGF0ZTsKKwlzdHJ1
Y3QgZHJtX3BsYW5lX3N0YXRlICpvbGRfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9vbGRfcGxhbmVf
c3RhdGUoc3RhdGUsCisJCQkJCQkJCQkgICBwbGFuZSk7CiAJc3RydWN0IGRybV9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlOwogCXN0cnVjdCBkZXZpY2UgKmRldiA9IHBsYW5lLT5kZXYtPmRldjsKIAlz
dHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IG5ld19zdGF0ZS0+ZmI7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaW5nZW5pYy9pbmdlbmljLWRybS1kcnYuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pbmdlbmljL2luZ2VuaWMtZHJtLWRydi5jCmluZGV4IGU2ZDdkMGEwNGRkYi4uYzAyMmQ5ZjFl
NzM3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaW5nZW5pYy9pbmdlbmljLWRybS1kcnYu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaW5nZW5pYy9pbmdlbmljLWRybS1kcnYuYwpAQCAtMzYx
LDExICszNjEsMTMgQEAgc3RhdGljIHZvaWQgaW5nZW5pY19kcm1fY3J0Y19hdG9taWNfZmx1c2go
c3RydWN0IGRybV9jcnRjICpjcnRjLAogc3RhdGljIGludCBpbmdlbmljX2RybV9wbGFuZV9hdG9t
aWNfY2hlY2soc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsCiAJCQkJCSAgc3RydWN0IGRybV9hdG9t
aWNfc3RhdGUgKnN0YXRlKQogeworCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9sZF9wbGFuZV9z
dGF0ZSA9IGRybV9hdG9taWNfZ2V0X29sZF9wbGFuZV9zdGF0ZShzdGF0ZSwKKwkJCQkJCQkJCQkg
cGxhbmUpOwogCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm5ld19wbGFuZV9zdGF0ZSA9IGRybV9h
dG9taWNfZ2V0X25ld19wbGFuZV9zdGF0ZShzdGF0ZSwKIAkJCQkJCQkJCQkgcGxhbmUpOwogCXN0
cnVjdCBpbmdlbmljX2RybSAqcHJpdiA9IGRybV9kZXZpY2VfZ2V0X3ByaXYocGxhbmUtPmRldik7
CiAJc3RydWN0IGRybV9jcnRjX3N0YXRlICpjcnRjX3N0YXRlOwotCXN0cnVjdCBkcm1fY3J0YyAq
Y3J0YyA9IG5ld19wbGFuZV9zdGF0ZS0+Y3J0YyA/OiBwbGFuZS0+c3RhdGUtPmNydGM7CisJc3Ry
dWN0IGRybV9jcnRjICpjcnRjID0gbmV3X3BsYW5lX3N0YXRlLT5jcnRjID86IG9sZF9wbGFuZV9z
dGF0ZS0+Y3J0YzsKIAlpbnQgcmV0OwogCiAJaWYgKCFjcnRjKQpAQCAtMzk5LDEyICs0MDEsMTIg
QEAgc3RhdGljIGludCBpbmdlbmljX2RybV9wbGFuZV9hdG9taWNfY2hlY2soc3RydWN0IGRybV9w
bGFuZSAqcGxhbmUsCiAJICogaXRzIHBvc2l0aW9uLCBzaXplIG9yIGRlcHRoLgogCSAqLwogCWlm
IChwcml2LT5zb2NfaW5mby0+aGFzX29zZCAmJgotCSAgICAoIXBsYW5lLT5zdGF0ZS0+ZmIgfHwg
IW5ld19wbGFuZV9zdGF0ZS0+ZmIgfHwKLQkgICAgIHBsYW5lLT5zdGF0ZS0+Y3J0Y194ICE9IG5l
d19wbGFuZV9zdGF0ZS0+Y3J0Y194IHx8Ci0JICAgICBwbGFuZS0+c3RhdGUtPmNydGNfeSAhPSBu
ZXdfcGxhbmVfc3RhdGUtPmNydGNfeSB8fAotCSAgICAgcGxhbmUtPnN0YXRlLT5jcnRjX3cgIT0g
bmV3X3BsYW5lX3N0YXRlLT5jcnRjX3cgfHwKLQkgICAgIHBsYW5lLT5zdGF0ZS0+Y3J0Y19oICE9
IG5ld19wbGFuZV9zdGF0ZS0+Y3J0Y19oIHx8Ci0JICAgICBwbGFuZS0+c3RhdGUtPmZiLT5mb3Jt
YXQtPmZvcm1hdCAhPSBuZXdfcGxhbmVfc3RhdGUtPmZiLT5mb3JtYXQtPmZvcm1hdCkpCisJICAg
ICghb2xkX3BsYW5lX3N0YXRlLT5mYiB8fCAhbmV3X3BsYW5lX3N0YXRlLT5mYiB8fAorCSAgICAg
b2xkX3BsYW5lX3N0YXRlLT5jcnRjX3ggIT0gbmV3X3BsYW5lX3N0YXRlLT5jcnRjX3ggfHwKKwkg
ICAgIG9sZF9wbGFuZV9zdGF0ZS0+Y3J0Y195ICE9IG5ld19wbGFuZV9zdGF0ZS0+Y3J0Y195IHx8
CisJICAgICBvbGRfcGxhbmVfc3RhdGUtPmNydGNfdyAhPSBuZXdfcGxhbmVfc3RhdGUtPmNydGNf
dyB8fAorCSAgICAgb2xkX3BsYW5lX3N0YXRlLT5jcnRjX2ggIT0gbmV3X3BsYW5lX3N0YXRlLT5j
cnRjX2ggfHwKKwkgICAgIG9sZF9wbGFuZV9zdGF0ZS0+ZmItPmZvcm1hdC0+Zm9ybWF0ICE9IG5l
d19wbGFuZV9zdGF0ZS0+ZmItPmZvcm1hdC0+Zm9ybWF0KSkKIAkJY3J0Y19zdGF0ZS0+bW9kZV9j
aGFuZ2VkID0gdHJ1ZTsKIAogCXJldHVybiAwOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2luZ2VuaWMvaW5nZW5pYy1pcHUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pbmdlbmljL2luZ2VuaWMt
aXB1LmMKaW5kZXggMWUxYjBmZTA5NWJkLi4zZDA3MmIyNWUxYzQgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pbmdlbmljL2luZ2VuaWMtaXB1LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2lu
Z2VuaWMvaW5nZW5pYy1pcHUuYwpAQCAtNTE2LDExICs1MTYsMTMgQEAgc3RhdGljIHZvaWQgaW5n
ZW5pY19pcHVfcGxhbmVfYXRvbWljX3VwZGF0ZShzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKIHN0
YXRpYyBpbnQgaW5nZW5pY19pcHVfcGxhbmVfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fcGxhbmUg
KnBsYW5lLAogCQkJCQkgIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKIHsKKwlzdHJ1
Y3QgZHJtX3BsYW5lX3N0YXRlICpvbGRfcGxhbmVfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9vbGRf
cGxhbmVfc3RhdGUoc3RhdGUsCisJCQkJCQkJCQkJIHBsYW5lKTsKIAlzdHJ1Y3QgZHJtX3BsYW5l
X3N0YXRlICpuZXdfcGxhbmVfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9uZXdfcGxhbmVfc3RhdGUo
c3RhdGUsCiAJCQkJCQkJCQkJIHBsYW5lKTsKIAl1bnNpZ25lZCBpbnQgbnVtX3csIGRlbm9tX3cs
IG51bV9oLCBkZW5vbV9oLCB4cmVzLCB5cmVzLCBtYXhfdywgbWF4X2g7CiAJc3RydWN0IGluZ2Vu
aWNfaXB1ICppcHUgPSBwbGFuZV90b19pbmdlbmljX2lwdShwbGFuZSk7Ci0Jc3RydWN0IGRybV9j
cnRjICpjcnRjID0gbmV3X3BsYW5lX3N0YXRlLT5jcnRjID86IHBsYW5lLT5zdGF0ZS0+Y3J0YzsK
KwlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSBuZXdfcGxhbmVfc3RhdGUtPmNydGMgPzogb2xkX3Bs
YW5lX3N0YXRlLT5jcnRjOwogCXN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZTsKIAog
CWlmICghY3J0YykKQEAgLTUzMSw3ICs1MzMsNyBAQCBzdGF0aWMgaW50IGluZ2VuaWNfaXB1X3Bs
YW5lX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKIAkJcmV0dXJuIC1FSU5W
QUw7CiAKIAkvKiBSZXF1ZXN0IGEgZnVsbCBtb2Rlc2V0IGlmIHdlIGFyZSBlbmFibGluZyBvciBk
aXNhYmxpbmcgdGhlIElQVS4gKi8KLQlpZiAoIXBsYW5lLT5zdGF0ZS0+Y3J0YyBeICFuZXdfcGxh
bmVfc3RhdGUtPmNydGMpCisJaWYgKCFvbGRfcGxhbmVfc3RhdGUtPmNydGMgXiAhbmV3X3BsYW5l
X3N0YXRlLT5jcnRjKQogCQljcnRjX3N0YXRlLT5tb2RlX2NoYW5nZWQgPSB0cnVlOwogCiAJaWYg
KCFuZXdfcGxhbmVfc3RhdGUtPmNydGMgfHwKQEAgLTU1Miw3ICs1NTQsNyBAQCBzdGF0aWMgaW50
IGluZ2VuaWNfaXB1X3BsYW5lX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwK
IAlpZiAoKChuZXdfcGxhbmVfc3RhdGUtPnNyY193ID4+IDE2KSAmIDEpIHx8IChuZXdfcGxhbmVf
c3RhdGUtPmNydGNfdyAmIDEpKQogCQlyZXR1cm4gLUVJTlZBTDsKIAotCWlmICghb3NkX2NoYW5n
ZWQobmV3X3BsYW5lX3N0YXRlLCBwbGFuZS0+c3RhdGUpKQorCWlmICghb3NkX2NoYW5nZWQobmV3
X3BsYW5lX3N0YXRlLCBvbGRfcGxhbmVfc3RhdGUpKQogCQlyZXR1cm4gMDsKIAogCWNydGNfc3Rh
dGUtPm1vZGVfY2hhbmdlZCA9IHRydWU7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbXNt
L2Rpc3AvbWRwNS9tZHA1X3BsYW5lLmMgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL2Rpc3AvbWRwNS9t
ZHA1X3BsYW5lLmMKaW5kZXggNGFhYzYyMTdhNWFkLi42Y2U2Y2UwOWZlY2MgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9tc20vZGlzcC9tZHA1L21kcDVfcGxhbmUuYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vbXNtL2Rpc3AvbWRwNS9tZHA1X3BsYW5lLmMKQEAgLTQwNiwxMiArNDA2LDE0IEBA
IHN0YXRpYyBpbnQgbWRwNV9wbGFuZV9hdG9taWNfY2hlY2tfd2l0aF9zdGF0ZShzdHJ1Y3QgZHJt
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiBzdGF0aWMgaW50IG1kcDVfcGxhbmVfYXRvbWljX2No
ZWNrKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLAogCQkJCSAgIHN0cnVjdCBkcm1fYXRvbWljX3N0
YXRlICpzdGF0ZSkKIHsKKwlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpvbGRfcGxhbmVfc3RhdGUg
PSBkcm1fYXRvbWljX2dldF9vbGRfcGxhbmVfc3RhdGUoc3RhdGUsCisJCQkJCQkJCQkJIHBsYW5l
KTsKIAlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpuZXdfcGxhbmVfc3RhdGUgPSBkcm1fYXRvbWlj
X2dldF9uZXdfcGxhbmVfc3RhdGUoc3RhdGUsCiAJCQkJCQkJCQkJIHBsYW5lKTsKIAlzdHJ1Y3Qg
ZHJtX2NydGMgKmNydGM7CiAJc3RydWN0IGRybV9jcnRjX3N0YXRlICpjcnRjX3N0YXRlOwogCi0J
Y3J0YyA9IG5ld19wbGFuZV9zdGF0ZS0+Y3J0YyA/IG5ld19wbGFuZV9zdGF0ZS0+Y3J0YyA6IHBs
YW5lLT5zdGF0ZS0+Y3J0YzsKKwljcnRjID0gbmV3X3BsYW5lX3N0YXRlLT5jcnRjID8gbmV3X3Bs
YW5lX3N0YXRlLT5jcnRjIDogb2xkX3BsYW5lX3N0YXRlLT5jcnRjOwogCWlmICghY3J0YykKIAkJ
cmV0dXJuIDA7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90aWxjZGMvdGlsY2RjX3Bs
YW5lLmMgYi9kcml2ZXJzL2dwdS9kcm0vdGlsY2RjL3RpbGNkY19wbGFuZS5jCmluZGV4IGViZGQ0
MmRjYWY4Mi4uYzg2MjU4MTMyNDMyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdGlsY2Rj
L3RpbGNkY19wbGFuZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90aWxjZGMvdGlsY2RjX3BsYW5l
LmMKQEAgLTI2LDcgKzI2LDggQEAgc3RhdGljIGludCB0aWxjZGNfcGxhbmVfYXRvbWljX2NoZWNr
KHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLAogCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm5ld19z
dGF0ZSA9IGRybV9hdG9taWNfZ2V0X25ld19wbGFuZV9zdGF0ZShzdGF0ZSwKIAkJCQkJCQkJCSAg
IHBsYW5lKTsKIAlzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKmNydGNfc3RhdGU7Ci0Jc3RydWN0IGRy
bV9wbGFuZV9zdGF0ZSAqb2xkX3N0YXRlID0gcGxhbmUtPnN0YXRlOworCXN0cnVjdCBkcm1fcGxh
bmVfc3RhdGUgKm9sZF9zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X29sZF9wbGFuZV9zdGF0ZShzdGF0
ZSwKKwkJCQkJCQkJCSAgIHBsYW5lKTsKIAl1bnNpZ25lZCBpbnQgcGl0Y2g7CiAKIAlpZiAoIW5l
d19zdGF0ZS0+Y3J0YykKLS0gCjIuMjkuMgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlz
dGluZm8vZHJpLWRldmVsCg==
