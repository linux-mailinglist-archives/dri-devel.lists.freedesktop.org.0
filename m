Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id F396C10FD1
	for <lists+dri-devel@lfdr.de>; Thu,  2 May 2019 01:04:33 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EBE5789312;
	Wed,  1 May 2019 23:04:31 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ot1-x349.google.com (mail-ot1-x349.google.com
 [IPv6:2607:f8b0:4864:20::349])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6C2C289312
 for <dri-devel@lists.freedesktop.org>; Wed,  1 May 2019 23:04:31 +0000 (UTC)
Received: by mail-ot1-x349.google.com with SMTP id d11so274493otp.22
 for <dri-devel@lists.freedesktop.org>; Wed, 01 May 2019 16:04:31 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:date:in-reply-to:message-id:mime-version
 :references:subject:from:to:cc;
 bh=OvFsjJX2Uyffa7cEX+3tzIASfZRboLmkTB5evz5SdF8=;
 b=MYVWghnz7+hVNsSGsL7Vk9wb04kmeAT4cbYUuI8GFktI7nrFXX5qUIW8Jchx4Ejk3y
 1bZqJhsOWXbJt5kQu3vrUysfyO1rgoIrnpijK7NntI0+aTsEvawxlvmKR7/k9RAIiQ+u
 3h+XRRasokt7xqNbhfb0RpQMDsZ0CoCqEdI6IfFdWGh/xvAzK2vYOulJnhblUaI3MBA9
 WAPXWxxS7lczanJcoXO0lJEu8xjROATsspRtalqJjqr6GdhrvpXtIqfVOZnwxpdOt+Wn
 Ueg11QUtWJDoKl6BboCU0ZJbPB2WA3fz0RAyyyo5G6QzPvyb6Yovb/RVMGD/cilw54pw
 tjBw==
X-Gm-Message-State: APjAAAXAAEk3RddrwBl5ZztSMjHxug4Q5XWCR+pilidmqaYaWCEIyDrd
 LHU1+y2rdPVn46ZX3vv/10F8/1hF6EZ7A+Al5LMrrA==
X-Google-Smtp-Source: APXvYqwURwsTc0EBmXs/5Frvf/VNd5IIE0WpLM5wqVrJUnNg2ceQ9OXpweFVzu+hmZ8XaVWtbRFH9X4o3/ZG9dzoOx/vwg==
X-Received: by 2002:aca:d557:: with SMTP id m84mr506901oig.50.1556751870612;
 Wed, 01 May 2019 16:04:30 -0700 (PDT)
Date: Wed,  1 May 2019 16:01:20 -0700
In-Reply-To: <20190501230126.229218-1-brendanhiggins@google.com>
Message-Id: <20190501230126.229218-12-brendanhiggins@google.com>
Mime-Version: 1.0
References: <20190501230126.229218-1-brendanhiggins@google.com>
X-Mailer: git-send-email 2.21.0.593.g511ec345e18-goog
Subject: [PATCH v2 11/17] kunit: test: add test managed resource tests
From: Brendan Higgins <brendanhiggins@google.com>
To: frowand.list@gmail.com, gregkh@linuxfoundation.org, keescook@google.com, 
 kieran.bingham@ideasonboard.com, mcgrof@kernel.org, robh@kernel.org, 
 sboyd@kernel.org, shuah@kernel.org
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=google.com; s=20161025;
 h=date:in-reply-to:message-id:mime-version:references:subject:from:to
 :cc;
 bh=OvFsjJX2Uyffa7cEX+3tzIASfZRboLmkTB5evz5SdF8=;
 b=qPlP4wtsZ4AQcatp9BF+OrCpLj05h8DEI/0tQy+x1kv62wInQV0ExwEGLaSfmw4wfx
 vw6ztQSToC85b77HPNuG6YPhcRe0VFLQbcP0C/R1n6r629R/7oepiRk83g6gb7uqUAJU
 x14XDp7hhyem57L5ZmWaQpCTC4n6fOPvcu7bARwPtL5iDm7KlAjijzVRvklVx5yPNctL
 XBOagQedBEK5DjJEdzWuRUIWOF/83Nj815rfBHZy2kbBvKLDAanbKfijUzWAe9klznKB
 RZeGENHbw5NMnYDuLHKUvQCi3lF7/v6gdZ3ySbcQdAiu336KQzA3HXAE7rqRLgY7Ls3v
 J8lw==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: pmladek@suse.com, linux-doc@vger.kernel.org, amir73il@gmail.com,
 Brendan Higgins <brendanhiggins@google.com>, dri-devel@lists.freedesktop.org,
 Alexander.Levin@microsoft.com, linux-kselftest@vger.kernel.org,
 linux-nvdimm@lists.01.org, khilman@baylibre.com, knut.omang@oracle.com,
 wfg@linux.intel.com, joel@jms.id.au, rientjes@google.com, jdike@addtoit.com,
 dan.carpenter@oracle.com, devicetree@vger.kernel.org,
 linux-kbuild@vger.kernel.org, Tim.Bird@sony.com,
 Avinash Kondareddy <akndr41@gmail.com>, linux-um@lists.infradead.org,
 rostedt@goodmis.org, julia.lawall@lip6.fr, dan.j.williams@intel.com,
 kunit-dev@googlegroups.com, richard@nod.at, linux-kernel@vger.kernel.org,
 mpe@ellerman.id.au, linux-fsdevel@vger.kernel.org, logang@deltatee.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogQXZpbmFzaCBLb25kYXJlZGR5IDxha25kcjQxQGdtYWlsLmNvbT4KClRlc3RzIGhvdyB0
ZXN0cyBpbnRlcmFjdCB3aXRoIHRlc3QgbWFuYWdlZCByZXNvdXJjZXMgaW4gdGhlaXIgbGlmZXRp
bWUuCgpTaWduZWQtb2ZmLWJ5OiBBdmluYXNoIEtvbmRhcmVkZHkgPGFrbmRyNDFAZ21haWwuY29t
PgpTaWduZWQtb2ZmLWJ5OiBCcmVuZGFuIEhpZ2dpbnMgPGJyZW5kYW5oaWdnaW5zQGdvb2dsZS5j
b20+Ci0tLQoga3VuaXQvdGVzdC10ZXN0LmMgfCAxMjIgKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKwogMSBmaWxlIGNoYW5nZWQsIDEyMiBpbnNlcnRpb25zKCsp
CgpkaWZmIC0tZ2l0IGEva3VuaXQvdGVzdC10ZXN0LmMgYi9rdW5pdC90ZXN0LXRlc3QuYwppbmRl
eCA0YmQ3YTM0ZDBhNmNiLi41NGFkZDhjYTQxOGEwIDEwMDY0NAotLS0gYS9rdW5pdC90ZXN0LXRl
c3QuYworKysgYi9rdW5pdC90ZXN0LXRlc3QuYwpAQCAtMTM1LDMgKzEzNSwxMjUgQEAgc3RhdGlj
IHN0cnVjdCBrdW5pdF9tb2R1bGUga3VuaXRfdHJ5X2NhdGNoX3Rlc3RfbW9kdWxlID0gewogCS50
ZXN0X2Nhc2VzID0ga3VuaXRfdHJ5X2NhdGNoX3Rlc3RfY2FzZXMsCiB9OwogbW9kdWxlX3Rlc3Qo
a3VuaXRfdHJ5X2NhdGNoX3Rlc3RfbW9kdWxlKTsKKworLyoKKyAqIENvbnRleHQgZm9yIHRlc3Rp
bmcgdGVzdCBtYW5hZ2VkIHJlc291cmNlcworICogaXNfcmVzb3VyY2VfaW5pdGlhbGl6ZWQgaXMg
dXNlZCB0byB0ZXN0IGFyYml0cmFyeSByZXNvdXJjZXMKKyAqLworc3RydWN0IGt1bml0X3Rlc3Rf
cmVzb3VyY2VfY29udGV4dCB7CisJc3RydWN0IGt1bml0IHRlc3Q7CisJYm9vbCBpc19yZXNvdXJj
ZV9pbml0aWFsaXplZDsKK307CisKK3N0YXRpYyBpbnQgZmFrZV9yZXNvdXJjZV9pbml0KHN0cnVj
dCBrdW5pdF9yZXNvdXJjZSAqcmVzLCB2b2lkICpjb250ZXh0KQoreworCXN0cnVjdCBrdW5pdF90
ZXN0X3Jlc291cmNlX2NvbnRleHQgKmN0eCA9IGNvbnRleHQ7CisKKwlyZXMtPmFsbG9jYXRpb24g
PSAmY3R4LT5pc19yZXNvdXJjZV9pbml0aWFsaXplZDsKKwljdHgtPmlzX3Jlc291cmNlX2luaXRp
YWxpemVkID0gdHJ1ZTsKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgZmFrZV9yZXNvdXJj
ZV9mcmVlKHN0cnVjdCBrdW5pdF9yZXNvdXJjZSAqcmVzKQoreworCWJvb2wgKmlzX3Jlc291cmNl
X2luaXRpYWxpemVkID0gcmVzLT5hbGxvY2F0aW9uOworCisJKmlzX3Jlc291cmNlX2luaXRpYWxp
emVkID0gZmFsc2U7Cit9CisKK3N0YXRpYyB2b2lkIGt1bml0X3Jlc291cmNlX3Rlc3RfaW5pdF9y
ZXNvdXJjZXMoc3RydWN0IGt1bml0ICp0ZXN0KQoreworCXN0cnVjdCBrdW5pdF90ZXN0X3Jlc291
cmNlX2NvbnRleHQgKmN0eCA9IHRlc3QtPnByaXY7CisKKwlrdW5pdF9pbml0X3Rlc3QoJmN0eC0+
dGVzdCwgInRlc3RpbmdfdGVzdF9pbml0X3Rlc3QiKTsKKworCUtVTklUX0VYUEVDVF9UUlVFKHRl
c3QsIGxpc3RfZW1wdHkoJmN0eC0+dGVzdC5yZXNvdXJjZXMpKTsKK30KKworc3RhdGljIHZvaWQg
a3VuaXRfcmVzb3VyY2VfdGVzdF9hbGxvY19yZXNvdXJjZShzdHJ1Y3Qga3VuaXQgKnRlc3QpCit7
CisJc3RydWN0IGt1bml0X3Rlc3RfcmVzb3VyY2VfY29udGV4dCAqY3R4ID0gdGVzdC0+cHJpdjsK
KwlzdHJ1Y3Qga3VuaXRfcmVzb3VyY2UgKnJlczsKKwlrdW5pdF9yZXNvdXJjZV9mcmVlX3QgZnJl
ZSA9IGZha2VfcmVzb3VyY2VfZnJlZTsKKworCXJlcyA9IGt1bml0X2FsbG9jX3Jlc291cmNlKCZj
dHgtPnRlc3QsCisJCQkJICAgZmFrZV9yZXNvdXJjZV9pbml0LAorCQkJCSAgIGZha2VfcmVzb3Vy
Y2VfZnJlZSwKKwkJCQkgICBjdHgpOworCisJS1VOSVRfQVNTRVJUX05PVF9FUlJfT1JfTlVMTCh0
ZXN0LCByZXMpOworCUtVTklUX0VYUEVDVF9FUSh0ZXN0LCAmY3R4LT5pc19yZXNvdXJjZV9pbml0
aWFsaXplZCwgcmVzLT5hbGxvY2F0aW9uKTsKKwlLVU5JVF9FWFBFQ1RfVFJVRSh0ZXN0LCBsaXN0
X2lzX2xhc3QoJnJlcy0+bm9kZSwgJmN0eC0+dGVzdC5yZXNvdXJjZXMpKTsKKwlLVU5JVF9FWFBF
Q1RfRVEodGVzdCwgZnJlZSwgcmVzLT5mcmVlKTsKK30KKworc3RhdGljIHZvaWQga3VuaXRfcmVz
b3VyY2VfdGVzdF9mcmVlX3Jlc291cmNlKHN0cnVjdCBrdW5pdCAqdGVzdCkKK3sKKwlzdHJ1Y3Qg
a3VuaXRfdGVzdF9yZXNvdXJjZV9jb250ZXh0ICpjdHggPSB0ZXN0LT5wcml2OworCXN0cnVjdCBr
dW5pdF9yZXNvdXJjZSAqcmVzID0ga3VuaXRfYWxsb2NfcmVzb3VyY2UoJmN0eC0+dGVzdCwKKwkJ
CQkJCQkgIGZha2VfcmVzb3VyY2VfaW5pdCwKKwkJCQkJCQkgIGZha2VfcmVzb3VyY2VfZnJlZSwK
KwkJCQkJCQkgIGN0eCk7CisKKwlrdW5pdF9mcmVlX3Jlc291cmNlKCZjdHgtPnRlc3QsIHJlcyk7
CisKKwlLVU5JVF9FWFBFQ1RfRVEodGVzdCwgZmFsc2UsIGN0eC0+aXNfcmVzb3VyY2VfaW5pdGlh
bGl6ZWQpOworCUtVTklUX0VYUEVDVF9UUlVFKHRlc3QsIGxpc3RfZW1wdHkoJmN0eC0+dGVzdC5y
ZXNvdXJjZXMpKTsKK30KKworc3RhdGljIHZvaWQga3VuaXRfcmVzb3VyY2VfdGVzdF9jbGVhbnVw
X3Jlc291cmNlcyhzdHJ1Y3Qga3VuaXQgKnRlc3QpCit7CisJaW50IGk7CisJc3RydWN0IGt1bml0
X3Rlc3RfcmVzb3VyY2VfY29udGV4dCAqY3R4ID0gdGVzdC0+cHJpdjsKKwlzdHJ1Y3Qga3VuaXRf
cmVzb3VyY2UgKnJlc291cmNlc1s1XTsKKworCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKHJl
c291cmNlcyk7IGkrKykgeworCQlyZXNvdXJjZXNbaV0gPSBrdW5pdF9hbGxvY19yZXNvdXJjZSgm
Y3R4LT50ZXN0LAorCQkJCQkJICAgIGZha2VfcmVzb3VyY2VfaW5pdCwKKwkJCQkJCSAgICBmYWtl
X3Jlc291cmNlX2ZyZWUsCisJCQkJCQkgICAgY3R4KTsKKwl9CisKKwlrdW5pdF9jbGVhbnVwKCZj
dHgtPnRlc3QpOworCisJS1VOSVRfRVhQRUNUX1RSVUUodGVzdCwgbGlzdF9lbXB0eSgmY3R4LT50
ZXN0LnJlc291cmNlcykpOworfQorCitzdGF0aWMgaW50IGt1bml0X3Jlc291cmNlX3Rlc3RfaW5p
dChzdHJ1Y3Qga3VuaXQgKnRlc3QpCit7CisJc3RydWN0IGt1bml0X3Rlc3RfcmVzb3VyY2VfY29u
dGV4dCAqY3R4ID0KKwkJCWt6YWxsb2Moc2l6ZW9mKCpjdHgpLCBHRlBfS0VSTkVMKTsKKworCWlm
ICghY3R4KQorCQlyZXR1cm4gLUVOT01FTTsKKworCXRlc3QtPnByaXYgPSBjdHg7CisKKwlrdW5p
dF9pbml0X3Rlc3QoJmN0eC0+dGVzdCwgInRlc3RfdGVzdF9jb250ZXh0Iik7CisKKwlyZXR1cm4g
MDsKK30KKworc3RhdGljIHZvaWQga3VuaXRfcmVzb3VyY2VfdGVzdF9leGl0KHN0cnVjdCBrdW5p
dCAqdGVzdCkKK3sKKwlzdHJ1Y3Qga3VuaXRfdGVzdF9yZXNvdXJjZV9jb250ZXh0ICpjdHggPSB0
ZXN0LT5wcml2OworCisJa3VuaXRfY2xlYW51cCgmY3R4LT50ZXN0KTsKKwlrZnJlZShjdHgpOwor
fQorCitzdGF0aWMgc3RydWN0IGt1bml0X2Nhc2Uga3VuaXRfcmVzb3VyY2VfdGVzdF9jYXNlc1td
ID0geworCUtVTklUX0NBU0Uoa3VuaXRfcmVzb3VyY2VfdGVzdF9pbml0X3Jlc291cmNlcyksCisJ
S1VOSVRfQ0FTRShrdW5pdF9yZXNvdXJjZV90ZXN0X2FsbG9jX3Jlc291cmNlKSwKKwlLVU5JVF9D
QVNFKGt1bml0X3Jlc291cmNlX3Rlc3RfZnJlZV9yZXNvdXJjZSksCisJS1VOSVRfQ0FTRShrdW5p
dF9yZXNvdXJjZV90ZXN0X2NsZWFudXBfcmVzb3VyY2VzKSwKKwl7fSwKK307CisKK3N0YXRpYyBz
dHJ1Y3Qga3VuaXRfbW9kdWxlIGt1bml0X3Jlc291cmNlX3Rlc3RfbW9kdWxlID0geworCS5uYW1l
ID0gImt1bml0LXJlc291cmNlLXRlc3QiLAorCS5pbml0ID0ga3VuaXRfcmVzb3VyY2VfdGVzdF9p
bml0LAorCS5leGl0ID0ga3VuaXRfcmVzb3VyY2VfdGVzdF9leGl0LAorCS50ZXN0X2Nhc2VzID0g
a3VuaXRfcmVzb3VyY2VfdGVzdF9jYXNlcywKK307Cittb2R1bGVfdGVzdChrdW5pdF9yZXNvdXJj
ZV90ZXN0X21vZHVsZSk7Ci0tIAoyLjIxLjAuNTkzLmc1MTFlYzM0NWUxOC1nb29nCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGlu
ZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
