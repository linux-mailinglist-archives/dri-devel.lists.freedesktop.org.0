Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 7A639280F2F
	for <lists+dri-devel@lfdr.de>; Fri,  2 Oct 2020 10:47:21 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D57FC6E245;
	Fri,  2 Oct 2020 08:47:14 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ej1-x642.google.com (mail-ej1-x642.google.com
 [IPv6:2a00:1450:4864:20::642])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A4FA76E245
 for <dri-devel@lists.freedesktop.org>; Fri,  2 Oct 2020 08:47:13 +0000 (UTC)
Received: by mail-ej1-x642.google.com with SMTP id q13so843207ejo.9
 for <dri-devel@lists.freedesktop.org>; Fri, 02 Oct 2020 01:47:13 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=51Iktpuhwy/IEGb/LCYxnWiQ9U6jowEQSrJEqanFeCU=;
 b=C143rGSv76X3ssRo15//0h70s77PG+vfVwJRJWy5jZElW9ofTxHpcfEDeBSXBj4Hjg
 DmWsh1tj5tADgwnfz4asm0ckIJtuaHrsHDshx3PjMYOz/WkQwHoX/JVNI6rw61R/tNDr
 xEBT7bGHPlx2y/r0WyCx5iZ15OhhDkAeB3rDU1L36rV176HFu7H8KLZ0TQUEneaRzdhQ
 pCi0rMbNrSogah1mhp350K+gLBcpbWBJrCrs35yTORSsRfP111gMwVUGGUN7/4xSy/qb
 ZW+H6EYJkcXQ9Dc6EYoSPsioF/kGkQE0LGH4s/y9Uitg8MGduEY2TSCZ520DKWfSJz6g
 JcXA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=51Iktpuhwy/IEGb/LCYxnWiQ9U6jowEQSrJEqanFeCU=;
 b=fK0hJwLAKqL05zfuwxtLyw7Ju40Ms5yTsyg0FIhoQ0ML7Caw838dzzlocCb8zp+PBT
 5iZGwrui09vOaqYfBL8XCO5PGF6j+9yKwLtkNwrbCLIM1wOOf3dpnDJfHxv5raEFutGx
 OjBDK4Lgt1keDfzIR4JOsYCkAkv+1yXU3pV9q+0WDeNk+bON5IDkeeikuDhcrUUzm67M
 FdmhlFyUx2WQB58GrAHL5rbuqElW6yU6eZItjlYaRl2W+GKm9F4H7W065G+BvGzLZ+lx
 eetHKyHZfkO5JhsTrJjDWx7E4XfRTMEOkZezX2d5Mr7nRu2sP6+EADqUJqNm14Sr9QoF
 aS5g==
X-Gm-Message-State: AOAM531mPKdvLWgkBuW4Ybp4OUsryzubT1bxhn2sXVqFIvzsMZTo3uQS
 +4fq19HHeVtWCysXgu8Aue3XubmWbXY=
X-Google-Smtp-Source: ABdhPJzShJAt1TpaKXrdzppXb7d5++YCTPw1boLvd2Zlc7X9O+LMKGun2CXhQ+4pG93WLK9kRAN2+g==
X-Received: by 2002:a17:906:e15:: with SMTP id
 l21mr1206605eji.509.1601628429673; 
 Fri, 02 Oct 2020 01:47:09 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:b0ce:8a95:8e6:b4f4])
 by smtp.gmail.com with ESMTPSA id t10sm659153edw.86.2020.10.02.01.47.08
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 02 Oct 2020 01:47:08 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: dri-devel@lists.freedesktop.org, ray.huang@amd.com, airlied@gmail.com,
 daniel@ffwll.ch
Subject: [PATCH 1/4] drm/ttm: device naming cleanup
Date: Fri,  2 Oct 2020 10:47:04 +0200
Message-Id: <20201002084707.2203-1-christian.koenig@amd.com>
X-Mailer: git-send-email 2.17.1
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

UmVuYW1lIHR0bV9ib19kZXZpY2UgdG8gdHRtX2RldmljZS4KUmVuYW1lIHR0bV9ib19kcml2ZXIg
dG8gdHRtX2RldmljZV9mdW5jcy4KUmVuYW1lIHR0bV9ib19nbG9iYWwgdG8gdHRtX2dsb2JhbC4K
Ck1vdmUgZ2xvYmFsIGFuZCBkZXZpY2UgcmVsYXRlZCBmdW5jdGlvbnMgdG8gdHRtX2RldmljZS5b
Y2hdLgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpc3RpYW4gS8O2
bmlnIDxjaHJpc3RpYW4ua29lbmlnQGFtZC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1LmggICAgICAgICAgIHwgICAyICstCiAuLi4vZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdV9hbWRrZmRfZmVuY2UuYyAgfCAgIDYgKy0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV9nYXJ0LmMgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X3R0bS5jICAgICAgIHwgIDI0ICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfdHRtLmggICAgICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdV92bS5jICAgICAgICB8ICAgOCArLQogZHJpdmVycy9ncHUvZHJtL2RybV9nZW1fdnJh
bV9oZWxwZXIuYyAgICAgICAgIHwgIDE0ICstCiBkcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2
ZWF1X2JvLmMgICAgICAgICAgfCAgMTggKy0KIGRyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZl
YXVfYm8uaCAgICAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVh
dV9kcnYuaCAgICAgICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1
X3NnZG1hLmMgICAgICAgfCAgIDYgKy0KIGRyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVf
dHRtLmMgICAgICAgICB8ICAgNCArLQogZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV90
dG0uaCAgICAgICAgIHwgICA4ICstCiBkcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF9kcnYuaCAgICAg
ICAgICAgICAgICAgfCAgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9xeGwvcXhsX3JlbGVhc2UuYyAg
ICAgICAgICAgICB8ICAgNiArLQogZHJpdmVycy9ncHUvZHJtL3F4bC9xeGxfdHRtLmMgICAgICAg
ICAgICAgICAgIHwgIDE2ICstCiBkcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbi5oICAgICAg
ICAgICAgICAgfCAgIDYgKy0KIGRyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX3R0bS5jICAg
ICAgICAgICB8ICAzNCArLQogZHJpdmVycy9ncHUvZHJtL3R0bS9NYWtlZmlsZSAgICAgICAgICAg
ICAgICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9hZ3BfYmFja2VuZC5jICAg
ICAgICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvLmMgICAgICAgICAgICAg
ICAgICB8IDMwOCArKystLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3V0
aWwuYyAgICAgICAgICAgICB8ICAyNCArLQogZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm9fdm0u
YyAgICAgICAgICAgICAgIHwgIDI0ICstCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9kZXZpY2Uu
YyAgICAgICAgICAgICAgfCAyMjIgKysrKysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRt
X2V4ZWNidWZfdXRpbC5jICAgICAgICB8ICAgOCArLQogZHJpdmVycy9ncHUvZHJtL3R0bS90dG1f
bWVtb3J5LmMgICAgICAgICAgICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9y
YW5nZV9tYW5hZ2VyLmMgICAgICAgfCAgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3Jl
c291cmNlLmMgICAgICAgICAgICB8ICAgNCArLQogZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fdHQu
YyAgICAgICAgICAgICAgICAgIHwgIDI2ICstCiBkcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dm
eF9ibGl0LmMgICAgICAgICAgfCAgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4
X2JvLmMgICAgICAgICAgICB8ICAgNCArLQogZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhf
ZHJ2LmMgICAgICAgICAgIHwgICA2ICstCiBkcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9k
cnYuaCAgICAgICAgICAgfCAgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3Jl
c291cmNlLmMgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfdHRt
X2J1ZmZlci5jICAgIHwgIDE0ICstCiBpbmNsdWRlL2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmgg
ICAgICAgICAgICAgfCAgIDYgKy0KIGluY2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmggICAgICAg
ICAgICAgICAgICB8ICA0NCArLS0KIGluY2x1ZGUvZHJtL3R0bS90dG1fYm9fZHJpdmVyLmggICAg
ICAgICAgICAgICB8IDM1NyArLS0tLS0tLS0tLS0tLS0tLQogaW5jbHVkZS9kcm0vdHRtL3R0bV9k
ZXZpY2UuaCAgICAgICAgICAgICAgICAgIHwgMzY2ICsrKysrKysrKysrKysrKysrKwogaW5jbHVk
ZS9kcm0vdHRtL3R0bV9yZXNvdXJjZS5oICAgICAgICAgICAgICAgIHwgICA0ICstCiBpbmNsdWRl
L2RybS90dG0vdHRtX3R0LmggICAgICAgICAgICAgICAgICAgICAgfCAgMTIgKy0KIDQxIGZpbGVz
IGNoYW5nZWQsIDgzMyBpbnNlcnRpb25zKCspLCA3ODAgZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fZGV2aWNlLmMKIGNyZWF0ZSBtb2RlIDEw
MDY0NCBpbmNsdWRlL2RybS90dG0vdHRtX2RldmljZS5oCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1LmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9h
bWRncHUuaAppbmRleCA0MDA5ZDJlMzA3MjcuLmEwM2Y5YmQzZWE0YiAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1LmgKQEAgLTk5OSw3ICs5OTksNyBAQCBzdGF0aWMgaW5saW5lIHN0cnVj
dCBkcm1fZGV2aWNlICphZGV2X3RvX2RybShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKIAly
ZXR1cm4gJmFkZXYtPmRkZXY7CiB9CiAKLXN0YXRpYyBpbmxpbmUgc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFtZGdwdV90dG1fYWRldihzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldikKK3N0YXRpYyBp
bmxpbmUgc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFtZGdwdV90dG1fYWRldihzdHJ1Y3QgdHRtX2Rl
dmljZSAqYmRldikKIHsKIAlyZXR1cm4gY29udGFpbmVyX29mKGJkZXYsIHN0cnVjdCBhbWRncHVf
ZGV2aWNlLCBtbWFuLmJkZXYpOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X2FtZGtmZF9mZW5jZS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X2FtZGtmZF9mZW5jZS5jCmluZGV4IDMxMDdiOTU3NTkyOS4uNWFmNDY0OTMzOTc2IDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfYW1ka2ZkX2ZlbmNl
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9mZW5jZS5j
CkBAIC00MCwxMyArNDAsMTMgQEAgc3RhdGljIGF0b21pY190IGZlbmNlX3NlcSA9IEFUT01JQ19J
TklUKDApOwogICogQWxsIHRoZSBCT3MgaW4gYSBwcm9jZXNzIHNoYXJlIGFuIGV2aWN0aW9uIGZl
bmNlLiBXaGVuIHByb2Nlc3MgWCB3YW50cwogICogdG8gbWFwIFZSQU0gbWVtb3J5IGJ1dCBUVE0g
Y2FuJ3QgZmluZCBlbm91Z2ggc3BhY2UsIFRUTSB3aWxsIGF0dGVtcHQgdG8KICAqIGV2aWN0IEJP
cyBmcm9tIGl0cyBMUlUgbGlzdC4gVFRNIGNoZWNrcyBpZiB0aGUgQk8gaXMgdmFsdWFibGUgdG8g
ZXZpY3QKLSAqIGJ5IGNhbGxpbmcgdHRtX2JvX2RyaXZlci0+ZXZpY3Rpb25fdmFsdWFibGUoKS4K
KyAqIGJ5IGNhbGxpbmcgdHRtX2RldmljZV9mdW5jcy0+ZXZpY3Rpb25fdmFsdWFibGUoKS4KICAq
Ci0gKiB0dG1fYm9fZHJpdmVyLT5ldmljdGlvbl92YWx1YWJsZSgpIC0gd2lsbCByZXR1cm4gZmFs
c2UgaWYgdGhlIEJPIGJlbG9uZ3MKKyAqIHR0bV9kZXZpY2VfZnVuY3MtPmV2aWN0aW9uX3ZhbHVh
YmxlKCkgLSB3aWxsIHJldHVybiBmYWxzZSBpZiB0aGUgQk8gYmVsb25ncwogICogIHRvIHByb2Nl
c3MgWC4gT3RoZXJ3aXNlLCBpdCB3aWxsIHJldHVybiB0cnVlIHRvIGluZGljYXRlIEJPIGNhbiBi
ZQogICogIGV2aWN0ZWQgYnkgVFRNLgogICoKLSAqIElmIHR0bV9ib19kcml2ZXItPmV2aWN0aW9u
X3ZhbHVhYmxlIHJldHVybnMgdHJ1ZSwgdGhlbiBUVE0gd2lsbCBjb250aW51ZQorICogSWYgdHRt
X2RldmljZV9mdW5jcy0+ZXZpY3Rpb25fdmFsdWFibGUgcmV0dXJucyB0cnVlLCB0aGVuIFRUTSB3
aWxsIGNvbnRpbnVlCiAgKiB0aGUgZXZjaXRpb24gcHJvY2VzcyBmb3IgdGhhdCBCTyBieSBjYWxs
aW5nIHR0bV9ib19ldmljdCAtLT4gYW1kZ3B1X2JvX21vdmUKICAqIC0tPiBhbWRncHVfY29weV9i
dWZmZXIoKS4gVGhpcyBzZXRzIHVwIGpvYiBpbiBHUFUgc2NoZWR1bGVyLgogICoKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nYXJ0LmMgYi9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZ2FydC5jCmluZGV4IGUwMWU2ODFkMmE2MC4uN2YyNWYy
YzBkZTM4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZ2Fy
dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nYXJ0LmMKQEAgLTcx
LDcgKzcxLDcgQEAKICAqLwogc3RhdGljIGludCBhbWRncHVfZ2FydF9kdW1teV9wYWdlX2luaXQo
c3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCiB7Ci0Jc3RydWN0IHBhZ2UgKmR1bW15X3BhZ2Ug
PSB0dG1fYm9fZ2xvYi5kdW1teV9yZWFkX3BhZ2U7CisJc3RydWN0IHBhZ2UgKmR1bW15X3BhZ2Ug
PSB0dG1fZ2xvYi5kdW1teV9yZWFkX3BhZ2U7CiAKIAlpZiAoYWRldi0+ZHVtbXlfcGFnZV9hZGRy
KQogCQlyZXR1cm4gMDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV90dG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYwppbmRl
eCA4Y2RlYzU4YjkxMDYuLjA4OGRjZmNlNmJjYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdV90dG0uYwpAQCAtNjMsNyArNjMsNyBAQAogCiAjZGVmaW5lIEFNREdQVV9UVE1fVlJB
TV9NQVhfRFdfUkVBRAkoc2l6ZV90KTEyOAogCi1zdGF0aWMgaW50IGFtZGdwdV90dG1fYmFja2Vu
ZF9iaW5kKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAorc3RhdGljIGludCBhbWRncHVfdHRt
X2JhY2tlbmRfYmluZChzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwKIAkJCQkgICBzdHJ1Y3QgdHRt
X3R0ICp0dG0sCiAJCQkJICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqYm9fbWVtKTsKIApAQCAtNzM1
LDcgKzczNSw3IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2JvX21vdmUoc3RydWN0IHR0bV9idWZmZXJf
b2JqZWN0ICpibywgYm9vbCBldmljdCwKICAqCiAgKiBDYWxsZWQgYnkgdHRtX21lbV9pb19yZXNl
cnZlKCkgdWx0aW1hdGVseSB2aWEgdHRtX2JvX3ZtX2ZhdWx0KCkKICAqLwotc3RhdGljIGludCBh
bWRncHVfdHRtX2lvX21lbV9yZXNlcnZlKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LCBzdHJ1
Y3QgdHRtX3Jlc291cmNlICptZW0pCitzdGF0aWMgaW50IGFtZGdwdV90dG1faW9fbWVtX3Jlc2Vy
dmUoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fcmVzb3VyY2UgKm1lbSkKIHsK
IAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGFtZGdwdV90dG1fYWRldihiZGV2KTsKIAlz
dHJ1Y3QgZHJtX21tX25vZGUgKm1tX25vZGUgPSBtZW0tPm1tX25vZGU7CkBAIC05ODIsNyArOTgy
LDcgQEAgdm9pZCBhbWRncHVfdHRtX3R0X3NldF91c2VyX3BhZ2VzKHN0cnVjdCB0dG1fdHQgKnR0
bSwgc3RydWN0IHBhZ2UgKipwYWdlcykKICAqCiAgKiBDYWxsZWQgYnkgYW1kZ3B1X3R0bV9iYWNr
ZW5kX2JpbmQoKQogICoqLwotc3RhdGljIGludCBhbWRncHVfdHRtX3R0X3Bpbl91c2VycHRyKHN0
cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAorc3RhdGljIGludCBhbWRncHVfdHRtX3R0X3Bpbl91
c2VycHRyKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LAogCQkJCSAgICAgc3RydWN0IHR0bV90dCAq
dHRtKQogewogCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gYW1kZ3B1X3R0bV9hZGV2KGJk
ZXYpOwpAQCAtMTAxOSw3ICsxMDE5LDcgQEAgc3RhdGljIGludCBhbWRncHVfdHRtX3R0X3Bpbl91
c2VycHRyKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAogLyoqCiAgKiBhbWRncHVfdHRtX3R0
X3VucGluX3VzZXJwdHIgLSBVbnBpbiBhbmQgdW5tYXAgdXNlcnB0ciBwYWdlcwogICovCi1zdGF0
aWMgdm9pZCBhbWRncHVfdHRtX3R0X3VucGluX3VzZXJwdHIoc3RydWN0IHR0bV9ib19kZXZpY2Ug
KmJkZXYsCitzdGF0aWMgdm9pZCBhbWRncHVfdHRtX3R0X3VucGluX3VzZXJwdHIoc3RydWN0IHR0
bV9kZXZpY2UgKmJkZXYsCiAJCQkJCXN0cnVjdCB0dG1fdHQgKnR0bSkKIHsKIAlzdHJ1Y3QgYW1k
Z3B1X2RldmljZSAqYWRldiA9IGFtZGdwdV90dG1fYWRldihiZGV2KTsKQEAgLTExMDMsNyArMTEw
Myw3IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X3R0bV9nYXJ0X2JpbmQoc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYsCiAgKiBDYWxsZWQgYnkgdHRtX3R0X2JpbmQoKSBvbiBiZWhhbGYgb2YgdHRtX2Jv
X2hhbmRsZV9tb3ZlX21lbSgpLgogICogVGhpcyBoYW5kbGVzIGJpbmRpbmcgR1RUIG1lbW9yeSB0
byB0aGUgZGV2aWNlIGFkZHJlc3Mgc3BhY2UuCiAgKi8KLXN0YXRpYyBpbnQgYW1kZ3B1X3R0bV9i
YWNrZW5kX2JpbmQoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCitzdGF0aWMgaW50IGFtZGdw
dV90dG1fYmFja2VuZF9iaW5kKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LAogCQkJCSAgIHN0cnVj
dCB0dG1fdHQgKnR0bSwKIAkJCQkgICBzdHJ1Y3QgdHRtX3Jlc291cmNlICpib19tZW0pCiB7CkBA
IC0xMjM4LDcgKzEyMzgsNyBAQCBpbnQgYW1kZ3B1X3R0bV9yZWNvdmVyX2dhcnQoc3RydWN0IHR0
bV9idWZmZXJfb2JqZWN0ICp0Ym8pCiAgKiBDYWxsZWQgYnkgdHRtX3R0X3VuYmluZCgpIG9uIGJl
aGFsZiBvZiB0dG1fYm9fbW92ZV90dG0oKSBhbmQKICAqIHR0bV90dF9kZXN0cm95KCkuCiAgKi8K
LXN0YXRpYyB2b2lkIGFtZGdwdV90dG1fYmFja2VuZF91bmJpbmQoc3RydWN0IHR0bV9ib19kZXZp
Y2UgKmJkZXYsCitzdGF0aWMgdm9pZCBhbWRncHVfdHRtX2JhY2tlbmRfdW5iaW5kKHN0cnVjdCB0
dG1fZGV2aWNlICpiZGV2LAogCQkJCSAgICAgIHN0cnVjdCB0dG1fdHQgKnR0bSkKIHsKIAlzdHJ1
Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGFtZGdwdV90dG1fYWRldihiZGV2KTsKQEAgLTEyNjMs
NyArMTI2Myw3IEBAIHN0YXRpYyB2b2lkIGFtZGdwdV90dG1fYmFja2VuZF91bmJpbmQoc3RydWN0
IHR0bV9ib19kZXZpY2UgKmJkZXYsCiAJZ3R0LT5ib3VuZCA9IGZhbHNlOwogfQogCi1zdGF0aWMg
dm9pZCBhbWRncHVfdHRtX2JhY2tlbmRfZGVzdHJveShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRl
diwKK3N0YXRpYyB2b2lkIGFtZGdwdV90dG1fYmFja2VuZF9kZXN0cm95KHN0cnVjdCB0dG1fZGV2
aWNlICpiZGV2LAogCQkJCSAgICAgICBzdHJ1Y3QgdHRtX3R0ICp0dG0pCiB7CiAJc3RydWN0IGFt
ZGdwdV90dG1fdHQgKmd0dCA9ICh2b2lkICopdHRtOwpAQCAtMTMxNiw3ICsxMzE2LDcgQEAgc3Rh
dGljIHN0cnVjdCB0dG1fdHQgKmFtZGdwdV90dG1fdHRfY3JlYXRlKHN0cnVjdCB0dG1fYnVmZmVy
X29iamVjdCAqYm8sCiAgKiBNYXAgdGhlIHBhZ2VzIG9mIGEgdHRtX3R0IG9iamVjdCB0byBhbiBh
ZGRyZXNzIHNwYWNlIHZpc2libGUKICAqIHRvIHRoZSB1bmRlcmx5aW5nIGRldmljZS4KICAqLwot
c3RhdGljIGludCBhbWRncHVfdHRtX3R0X3BvcHVsYXRlKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpi
ZGV2LAorc3RhdGljIGludCBhbWRncHVfdHRtX3R0X3BvcHVsYXRlKHN0cnVjdCB0dG1fZGV2aWNl
ICpiZGV2LAogCQkJCSAgc3RydWN0IHR0bV90dCAqdHRtLAogCQkJCSAgc3RydWN0IHR0bV9vcGVy
YXRpb25fY3R4ICpjdHgpCiB7CkBAIC0xMzcxLDcgKzEzNzEsNyBAQCBzdGF0aWMgaW50IGFtZGdw
dV90dG1fdHRfcG9wdWxhdGUoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCiAgKiBVbm1hcHMg
cGFnZXMgb2YgYSB0dG1fdHQgb2JqZWN0IGZyb20gdGhlIGRldmljZSBhZGRyZXNzIHNwYWNlIGFu
ZAogICogdW5wb3B1bGF0ZXMgdGhlIHBhZ2UgYXJyYXkgYmFja2luZyBpdC4KICAqLwotc3RhdGlj
IHZvaWQgYW1kZ3B1X3R0bV90dF91bnBvcHVsYXRlKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2
LCBzdHJ1Y3QgdHRtX3R0ICp0dG0pCitzdGF0aWMgdm9pZCBhbWRncHVfdHRtX3R0X3VucG9wdWxh
dGUoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSkKIHsKIAlzdHJ1
Y3QgYW1kZ3B1X3R0bV90dCAqZ3R0ID0gKHZvaWQgKil0dG07CiAJc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXY7CkBAIC0xNjk3LDcgKzE2OTcsNyBAQCBzdGF0aWMgaW50IGFtZGdwdV90dG1fYWNj
ZXNzX21lbW9yeShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCXJldHVybiByZXQ7CiB9
CiAKLXN0YXRpYyBzdHJ1Y3QgdHRtX2JvX2RyaXZlciBhbWRncHVfYm9fZHJpdmVyID0geworc3Rh
dGljIHN0cnVjdCB0dG1fZGV2aWNlX2Z1bmNzIGFtZGdwdV9ib19kcml2ZXIgPSB7CiAJLnR0bV90
dF9jcmVhdGUgPSAmYW1kZ3B1X3R0bV90dF9jcmVhdGUsCiAJLnR0bV90dF9wb3B1bGF0ZSA9ICZh
bWRncHVfdHRtX3R0X3BvcHVsYXRlLAogCS50dG1fdHRfdW5wb3B1bGF0ZSA9ICZhbWRncHVfdHRt
X3R0X3VucG9wdWxhdGUsCkBAIC0xODgxLDcgKzE4ODEsNyBAQCBpbnQgYW1kZ3B1X3R0bV9pbml0
KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQogCW11dGV4X2luaXQoJmFkZXYtPm1tYW4uZ3R0
X3dpbmRvd19sb2NrKTsKIAogCS8qIE5vIG90aGVycyB1c2VyIG9mIGFkZHJlc3Mgc3BhY2Ugc28g
c2V0IGl0IHRvIDAgKi8KLQlyID0gdHRtX2JvX2RldmljZV9pbml0KCZhZGV2LT5tbWFuLmJkZXYs
CisJciA9IHR0bV9kZXZpY2VfaW5pdCgmYWRldi0+bW1hbi5iZGV2LAogCQkJICAgICAgICZhbWRn
cHVfYm9fZHJpdmVyLAogCQkJICAgICAgIGFkZXZfdG9fZHJtKGFkZXYpLT5hbm9uX2lub2RlLT5p
X21hcHBpbmcsCiAJCQkgICAgICAgYWRldl90b19kcm0oYWRldiktPnZtYV9vZmZzZXRfbWFuYWdl
ciwKQEAgLTIwMzYsNyArMjAzNiw3IEBAIHZvaWQgYW1kZ3B1X3R0bV9maW5pKHN0cnVjdCBhbWRn
cHVfZGV2aWNlICphZGV2KQogCXR0bV9yYW5nZV9tYW5fZmluaSgmYWRldi0+bW1hbi5iZGV2LCBB
TURHUFVfUExfR0RTKTsKIAl0dG1fcmFuZ2VfbWFuX2ZpbmkoJmFkZXYtPm1tYW4uYmRldiwgQU1E
R1BVX1BMX0dXUyk7CiAJdHRtX3JhbmdlX21hbl9maW5pKCZhZGV2LT5tbWFuLmJkZXYsIEFNREdQ
VV9QTF9PQSk7Ci0JdHRtX2JvX2RldmljZV9yZWxlYXNlKCZhZGV2LT5tbWFuLmJkZXYpOworCXR0
bV9kZXZpY2VfcmVsZWFzZSgmYWRldi0+bW1hbi5iZGV2KTsKIAlhZGV2LT5tbWFuLmluaXRpYWxp
emVkID0gZmFsc2U7CiAJRFJNX0lORk8oImFtZGdwdTogdHRtIGZpbmFsaXplZFxuIik7CiB9CmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmggYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmgKaW5kZXggYTg3OTUxYjJmMDZkLi5l
NWQ2MTI0MTVlZmYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV90dG0uaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmgKQEAg
LTUzLDcgKzUzLDcgQEAgc3RydWN0IGFtZGdwdV9ndHRfbWdyIHsKIH07CiAKIHN0cnVjdCBhbWRn
cHVfbW1hbiB7Ci0Jc3RydWN0IHR0bV9ib19kZXZpY2UJCWJkZXY7CisJc3RydWN0IHR0bV9kZXZp
Y2UJCWJkZXY7CiAJYm9vbAkJCQltZW1fZ2xvYmFsX3JlZmVyZW5jZWQ7CiAJYm9vbAkJCQlpbml0
aWFsaXplZDsKIAl2b2lkIF9faW9tZW0JCQkqYXBlcl9iYXNlX2thZGRyOwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZtLmMgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfdm0uYwppbmRleCAzZTYyNDM2MjMwODIuLmRmYmI5YjAyNTY1NCAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZtLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZtLmMKQEAgLTYzOCwxNSArNjM4LDE1
IEBAIHZvaWQgYW1kZ3B1X3ZtX21vdmVfdG9fbHJ1X3RhaWwoc3RydWN0IGFtZGdwdV9kZXZpY2Ug
KmFkZXYsCiAJc3RydWN0IGFtZGdwdV92bV9ib19iYXNlICpib19iYXNlOwogCiAJaWYgKHZtLT5i
dWxrX21vdmVhYmxlKSB7Ci0JCXNwaW5fbG9jaygmdHRtX2JvX2dsb2IubHJ1X2xvY2spOworCQlz
cGluX2xvY2soJnR0bV9nbG9iLmxydV9sb2NrKTsKIAkJdHRtX2JvX2J1bGtfbW92ZV9scnVfdGFp
bCgmdm0tPmxydV9idWxrX21vdmUpOwotCQlzcGluX3VubG9jaygmdHRtX2JvX2dsb2IubHJ1X2xv
Y2spOworCQlzcGluX3VubG9jaygmdHRtX2dsb2IubHJ1X2xvY2spOwogCQlyZXR1cm47CiAJfQog
CiAJbWVtc2V0KCZ2bS0+bHJ1X2J1bGtfbW92ZSwgMCwgc2l6ZW9mKHZtLT5scnVfYnVsa19tb3Zl
KSk7CiAKLQlzcGluX2xvY2soJnR0bV9ib19nbG9iLmxydV9sb2NrKTsKKwlzcGluX2xvY2soJnR0
bV9nbG9iLmxydV9sb2NrKTsKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5KGJvX2Jhc2UsICZ2bS0+aWRs
ZSwgdm1fc3RhdHVzKSB7CiAJCXN0cnVjdCBhbWRncHVfYm8gKmJvID0gYm9fYmFzZS0+Ym87CiAK
QEAgLTY1OCw3ICs2NTgsNyBAQCB2b2lkIGFtZGdwdV92bV9tb3ZlX3RvX2xydV90YWlsKHN0cnVj
dCBhbWRncHVfZGV2aWNlICphZGV2LAogCQkJdHRtX2JvX21vdmVfdG9fbHJ1X3RhaWwoJmJvLT5z
aGFkb3ctPnRibywKIAkJCQkJCSZ2bS0+bHJ1X2J1bGtfbW92ZSk7CiAJfQotCXNwaW5fdW5sb2Nr
KCZ0dG1fYm9fZ2xvYi5scnVfbG9jayk7CisJc3Bpbl91bmxvY2soJnR0bV9nbG9iLmxydV9sb2Nr
KTsKIAogCXZtLT5idWxrX21vdmVhYmxlID0gdHJ1ZTsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX2dlbV92
cmFtX2hlbHBlci5jCmluZGV4IGI5YzBlYTcyMGVmZC4uZjdhMDI3MTIzOTc1IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vZHJtX2dlbV92cmFtX2hlbHBlci5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmMKQEAgLTE4Nyw3ICsxODcsNyBAQCBzdHJ1Y3QgZHJt
X2dlbV92cmFtX29iamVjdCAqZHJtX2dlbV92cmFtX2NyZWF0ZShzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2LAogCXN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm87CiAJc3RydWN0IGRybV9nZW1f
b2JqZWN0ICpnZW07CiAJc3RydWN0IGRybV92cmFtX21tICp2bW0gPSBkZXYtPnZyYW1fbW07Ci0J
c3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXY7CisJc3RydWN0IHR0bV9kZXZpY2UgKmJkZXY7CiAJ
aW50IHJldDsKIAlzaXplX3QgYWNjX3NpemU7CiAKQEAgLTU1NSw3ICs1NTUsNyBAQCBpbnQgZHJt
X2dlbV92cmFtX2ZpbGxfY3JlYXRlX2R1bWIoc3RydWN0IGRybV9maWxlICpmaWxlLAogRVhQT1JU
X1NZTUJPTChkcm1fZ2VtX3ZyYW1fZmlsbF9jcmVhdGVfZHVtYik7CiAKIC8qCi0gKiBIZWxwZXJz
IGZvciBzdHJ1Y3QgdHRtX2JvX2RyaXZlcgorICogSGVscGVycyBmb3Igc3RydWN0IHR0bV9kZXZp
Y2VfZnVuY3MKICAqLwogCiBzdGF0aWMgYm9vbCBkcm1faXNfZ2VtX3ZyYW0oc3RydWN0IHR0bV9i
dWZmZXJfb2JqZWN0ICpibykKQEAgLTg4Niw3ICs4ODYsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0
IGRybV9nZW1fb2JqZWN0X2Z1bmNzIGRybV9nZW1fdnJhbV9vYmplY3RfZnVuY3MgPSB7CiAgKiBU
VE0gVFQKICAqLwogCi1zdGF0aWMgdm9pZCBib19kcml2ZXJfdHRtX3R0X2Rlc3Ryb3koc3RydWN0
IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0KQorc3RhdGljIHZvaWQgYm9f
ZHJpdmVyX3R0bV90dF9kZXN0cm95KHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LCBzdHJ1Y3QgdHRt
X3R0ICp0dCkKIHsKIAl0dG1fdHRfZGVzdHJveV9jb21tb24oYmRldiwgdHQpOwogCXR0bV90dF9m
aW5pKHR0KTsKQEAgLTk0Nyw3ICs5NDcsNyBAQCBzdGF0aWMgdm9pZCBib19kcml2ZXJfbW92ZV9u
b3RpZnkoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAlkcm1fZ2VtX3ZyYW1fYm9fZHJp
dmVyX21vdmVfbm90aWZ5KGdibywgZXZpY3QsIG5ld19tZW0pOwogfQogCi1zdGF0aWMgaW50IGJv
X2RyaXZlcl9pb19tZW1fcmVzZXJ2ZShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKK3N0YXRp
YyBpbnQgYm9fZHJpdmVyX2lvX21lbV9yZXNlcnZlKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LAog
CQkJCSAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0pCiB7CiAJc3RydWN0IGRybV92cmFtX21t
ICp2bW0gPSBkcm1fdnJhbV9tbV9vZl9iZGV2KGJkZXYpOwpAQCAtOTY3LDcgKzk2Nyw3IEBAIHN0
YXRpYyBpbnQgYm9fZHJpdmVyX2lvX21lbV9yZXNlcnZlKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpi
ZGV2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgc3RydWN0IHR0bV9ib19kcml2ZXIgYm9fZHJp
dmVyID0geworc3RhdGljIHN0cnVjdCB0dG1fZGV2aWNlX2Z1bmNzIGJvX2RyaXZlciA9IHsKIAku
dHRtX3R0X2NyZWF0ZSA9IGJvX2RyaXZlcl90dG1fdHRfY3JlYXRlLAogCS50dG1fdHRfZGVzdHJv
eSA9IGJvX2RyaXZlcl90dG1fdHRfZGVzdHJveSwKIAkuZXZpY3Rpb25fdmFsdWFibGUgPSB0dG1f
Ym9fZXZpY3Rpb25fdmFsdWFibGUsCkBAIC0xMDE3LDcgKzEwMTcsNyBAQCBzdGF0aWMgaW50IGRy
bV92cmFtX21tX2luaXQoc3RydWN0IGRybV92cmFtX21tICp2bW0sIHN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYsCiAJdm1tLT52cmFtX2Jhc2UgPSB2cmFtX2Jhc2U7CiAJdm1tLT52cmFtX3NpemUgPSB2
cmFtX3NpemU7CiAKLQlyZXQgPSB0dG1fYm9fZGV2aWNlX2luaXQoJnZtbS0+YmRldiwgJmJvX2Ry
aXZlciwKKwlyZXQgPSB0dG1fZGV2aWNlX2luaXQoJnZtbS0+YmRldiwgJmJvX2RyaXZlciwKIAkJ
CQkgZGV2LT5hbm9uX2lub2RlLT5pX21hcHBpbmcsCiAJCQkJIGRldi0+dm1hX29mZnNldF9tYW5h
Z2VyLAogCQkJCSB0cnVlKTsKQEAgLTEwMzUsNyArMTAzNSw3IEBAIHN0YXRpYyBpbnQgZHJtX3Zy
YW1fbW1faW5pdChzdHJ1Y3QgZHJtX3ZyYW1fbW0gKnZtbSwgc3RydWN0IGRybV9kZXZpY2UgKmRl
diwKIHN0YXRpYyB2b2lkIGRybV92cmFtX21tX2NsZWFudXAoc3RydWN0IGRybV92cmFtX21tICp2
bW0pCiB7CiAJdHRtX3JhbmdlX21hbl9maW5pKCZ2bW0tPmJkZXYsIFRUTV9QTF9WUkFNKTsKLQl0
dG1fYm9fZGV2aWNlX3JlbGVhc2UoJnZtbS0+YmRldik7CisJdHRtX2RldmljZV9yZWxlYXNlKCZ2
bW0tPmJkZXYpOwogfQogCiAvKgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUv
bm91dmVhdV9iby5jIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9iby5jCmluZGV4
IGIzN2RmZDEyYzdiOS4uOTEyYmMzMjA0YzRlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
bm91dmVhdS9ub3V2ZWF1X2JvLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVh
dV9iby5jCkBAIC00NCw3ICs0NCw3IEBACiAjaW5jbHVkZSA8bnZpZi9pZjUwMGIuaD4KICNpbmNs
dWRlIDxudmlmL2lmOTAwYi5oPgogCi1zdGF0aWMgaW50IG5vdXZlYXVfdHRtX3R0X2JpbmQoc3Ry
dWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSwKK3N0YXRpYyBpbnQg
bm91dmVhdV90dG1fdHRfYmluZChzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV90
dCAqdHRtLAogCQkJICAgICAgIHN0cnVjdCB0dG1fcmVzb3VyY2UgKnJlZyk7CiAKIC8qCkBAIC02
NzQsNyArNjc0LDcgQEAgbm91dmVhdV90dG1fdHRfY3JlYXRlKHN0cnVjdCB0dG1fYnVmZmVyX29i
amVjdCAqYm8sIHVpbnQzMl90IHBhZ2VfZmxhZ3MpCiB9CiAKIHN0YXRpYyBpbnQKLW5vdXZlYXVf
dHRtX3R0X2JpbmQoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0
bSwKK25vdXZlYXVfdHRtX3R0X2JpbmQoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIHN0cnVjdCB0
dG1fdHQgKnR0bSwKIAkJICAgIHN0cnVjdCB0dG1fcmVzb3VyY2UgKnJlZykKIHsKICNpZiBJU19F
TkFCTEVEKENPTkZJR19BR1ApCkBAIC02OTAsNyArNjkwLDcgQEAgbm91dmVhdV90dG1fdHRfYmlu
ZChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV90dCAqdHRtLAogfQogCiBz
dGF0aWMgdm9pZAotbm91dmVhdV90dG1fdHRfdW5iaW5kKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpi
ZGV2LCBzdHJ1Y3QgdHRtX3R0ICp0dG0pCitub3V2ZWF1X3R0bV90dF91bmJpbmQoc3RydWN0IHR0
bV9kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSkKIHsKICNpZiBJU19FTkFCTEVEKENP
TkZJR19BR1ApCiAJc3RydWN0IG5vdXZlYXVfZHJtICpkcm0gPSBub3V2ZWF1X2JkZXYoYmRldik7
CkBAIC0xMTAxLDcgKzExMDEsNyBAQCBub3V2ZWF1X3R0bV9pb19tZW1fZnJlZV9sb2NrZWQoc3Ry
dWN0IG5vdXZlYXVfZHJtICpkcm0sCiB9CiAKIHN0YXRpYyBpbnQKLW5vdXZlYXVfdHRtX2lvX21l
bV9yZXNlcnZlKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LCBzdHJ1Y3QgdHRtX3Jlc291cmNl
ICpyZWcpCitub3V2ZWF1X3R0bV9pb19tZW1fcmVzZXJ2ZShzdHJ1Y3QgdHRtX2RldmljZSAqYmRl
diwgc3RydWN0IHR0bV9yZXNvdXJjZSAqcmVnKQogewogCXN0cnVjdCBub3V2ZWF1X2RybSAqZHJt
ID0gbm91dmVhdV9iZGV2KGJkZXYpOwogCXN0cnVjdCBudmttX2RldmljZSAqZGV2aWNlID0gbnZ4
eF9kZXZpY2UoJmRybS0+Y2xpZW50LmRldmljZSk7CkBAIC0xMjEwLDcgKzEyMTAsNyBAQCBub3V2
ZWF1X3R0bV9pb19tZW1fcmVzZXJ2ZShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwgc3RydWN0
IHR0bV9yZXNvdXJjZSAqcmVnKQogfQogCiBzdGF0aWMgdm9pZAotbm91dmVhdV90dG1faW9fbWVt
X2ZyZWUoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fcmVzb3VyY2UgKnJl
ZykKK25vdXZlYXVfdHRtX2lvX21lbV9mcmVlKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LCBzdHJ1
Y3QgdHRtX3Jlc291cmNlICpyZWcpCiB7CiAJc3RydWN0IG5vdXZlYXVfZHJtICpkcm0gPSBub3V2
ZWF1X2JkZXYoYmRldik7CiAKQEAgLTEyNzAsNyArMTI3MCw3IEBAIHZtX2ZhdWx0X3Qgbm91dmVh
dV90dG1fZmF1bHRfcmVzZXJ2ZV9ub3RpZnkoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibykK
IH0KIAogc3RhdGljIGludAotbm91dmVhdV90dG1fdHRfcG9wdWxhdGUoc3RydWN0IHR0bV9ib19k
ZXZpY2UgKmJkZXYsCitub3V2ZWF1X3R0bV90dF9wb3B1bGF0ZShzdHJ1Y3QgdHRtX2RldmljZSAq
YmRldiwKIAkJCXN0cnVjdCB0dG1fdHQgKnR0bSwgc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4ICpj
dHgpCiB7CiAJc3RydWN0IHR0bV9kbWFfdHQgKnR0bV9kbWEgPSAodm9pZCAqKXR0bTsKQEAgLTEz
MDcsNyArMTMwNyw3IEBAIG5vdXZlYXVfdHRtX3R0X3BvcHVsYXRlKHN0cnVjdCB0dG1fYm9fZGV2
aWNlICpiZGV2LAogfQogCiBzdGF0aWMgdm9pZAotbm91dmVhdV90dG1fdHRfdW5wb3B1bGF0ZShz
dHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKK25vdXZlYXVfdHRtX3R0X3VucG9wdWxhdGUoc3Ry
dWN0IHR0bV9kZXZpY2UgKmJkZXYsCiAJCQkgIHN0cnVjdCB0dG1fdHQgKnR0bSkKIHsKIAlzdHJ1
Y3QgdHRtX2RtYV90dCAqdHRtX2RtYSA9ICh2b2lkICopdHRtOwpAQCAtMTMzOSw3ICsxMzM5LDcg
QEAgbm91dmVhdV90dG1fdHRfdW5wb3B1bGF0ZShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwK
IH0KIAogc3RhdGljIHZvaWQKLW5vdXZlYXVfdHRtX3R0X2Rlc3Ryb3koc3RydWN0IHR0bV9ib19k
ZXZpY2UgKmJkZXYsCitub3V2ZWF1X3R0bV90dF9kZXN0cm95KHN0cnVjdCB0dG1fZGV2aWNlICpi
ZGV2LAogCQkgICAgICAgc3RydWN0IHR0bV90dCAqdHRtKQogewogI2lmIElTX0VOQUJMRUQoQ09O
RklHX0FHUCkKQEAgLTEzNjUsNyArMTM2NSw3IEBAIG5vdXZlYXVfYm9fZmVuY2Uoc3RydWN0IG5v
dXZlYXVfYm8gKm52Ym8sIHN0cnVjdCBub3V2ZWF1X2ZlbmNlICpmZW5jZSwgYm9vbCBleGNsCiAJ
CWRtYV9yZXN2X2FkZF9zaGFyZWRfZmVuY2UocmVzdiwgJmZlbmNlLT5iYXNlKTsKIH0KIAotc3Ry
dWN0IHR0bV9ib19kcml2ZXIgbm91dmVhdV9ib19kcml2ZXIgPSB7CitzdHJ1Y3QgdHRtX2Rldmlj
ZV9mdW5jcyBub3V2ZWF1X2JvX2RyaXZlciA9IHsKIAkudHRtX3R0X2NyZWF0ZSA9ICZub3V2ZWF1
X3R0bV90dF9jcmVhdGUsCiAJLnR0bV90dF9wb3B1bGF0ZSA9ICZub3V2ZWF1X3R0bV90dF9wb3B1
bGF0ZSwKIAkudHRtX3R0X3VucG9wdWxhdGUgPSAmbm91dmVhdV90dG1fdHRfdW5wb3B1bGF0ZSwK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfYm8uaCBiL2RyaXZl
cnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfYm8uaAppbmRleCA2NDFlZjYyOThhMGUuLjJmZWU3
ZDUwZWYwOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9iby5o
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfYm8uaApAQCAtNzAsNyArNzAs
NyBAQCBub3V2ZWF1X2JvX3JlZihzdHJ1Y3Qgbm91dmVhdV9ibyAqcmVmLCBzdHJ1Y3Qgbm91dmVh
dV9ibyAqKnBudmJvKQogCXJldHVybiAwOwogfQogCi1leHRlcm4gc3RydWN0IHR0bV9ib19kcml2
ZXIgbm91dmVhdV9ib19kcml2ZXI7CitleHRlcm4gc3RydWN0IHR0bV9kZXZpY2VfZnVuY3Mgbm91
dmVhdV9ib19kcml2ZXI7CiAKIHZvaWQgbm91dmVhdV9ib19tb3ZlX2luaXQoc3RydWN0IG5vdXZl
YXVfZHJtICopOwogc3RydWN0IG5vdXZlYXVfYm8gKm5vdXZlYXVfYm9fYWxsb2Moc3RydWN0IG5v
dXZlYXVfY2xpICosIHU2NCAqc2l6ZSwgaW50ICphbGlnbiwKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfZHJ2LmggYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9u
b3V2ZWF1X2Rydi5oCmluZGV4IGI4MDI1NTA3YTllNC4uMGNkZTE2MjExZTQwIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9ub3V2ZWF1L25vdXZlYXVfZHJ2LmgKQEAgLTE1Myw3ICsxNTMsNyBAQCBzdHJ1Y3Qgbm91
dmVhdV9kcm0gewogCiAJLyogVFRNIGludGVyZmFjZSBzdXBwb3J0ICovCiAJc3RydWN0IHsKLQkJ
c3RydWN0IHR0bV9ib19kZXZpY2UgYmRldjsKKwkJc3RydWN0IHR0bV9kZXZpY2UgYmRldjsKIAkJ
YXRvbWljX3QgdmFsaWRhdGVfc2VxdWVuY2U7CiAJCWludCAoKm1vdmUpKHN0cnVjdCBub3V2ZWF1
X2NoYW5uZWwgKiwKIAkJCSAgICBzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKiwKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfc2dkbWEuYyBiL2RyaXZlcnMvZ3B1
L2RybS9ub3V2ZWF1L25vdXZlYXVfc2dkbWEuYwppbmRleCBjZDZmZGViYWU3OTUuLjA0MDBiYjQz
ZmFjNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9zZ2RtYS5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfc2dkbWEuYwpAQCAtMTYsNyAr
MTYsNyBAQCBzdHJ1Y3Qgbm91dmVhdV9zZ2RtYV9iZSB7CiB9OwogCiB2b2lkCi1ub3V2ZWF1X3Nn
ZG1hX2Rlc3Ryb3koc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0
bSkKK25vdXZlYXVfc2dkbWFfZGVzdHJveShzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwgc3RydWN0
IHR0bV90dCAqdHRtKQogewogCXN0cnVjdCBub3V2ZWF1X3NnZG1hX2JlICpudmJlID0gKHN0cnVj
dCBub3V2ZWF1X3NnZG1hX2JlICopdHRtOwogCkBAIC0yOSw3ICsyOSw3IEBAIG5vdXZlYXVfc2dk
bWFfZGVzdHJveShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV90dCAqdHRt
KQogfQogCiBpbnQKLW5vdXZlYXVfc2dkbWFfYmluZChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRl
diwgc3RydWN0IHR0bV90dCAqdHRtLCBzdHJ1Y3QgdHRtX3Jlc291cmNlICpyZWcpCitub3V2ZWF1
X3NnZG1hX2JpbmQoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSwg
c3RydWN0IHR0bV9yZXNvdXJjZSAqcmVnKQogewogCXN0cnVjdCBub3V2ZWF1X3NnZG1hX2JlICpu
dmJlID0gKHN0cnVjdCBub3V2ZWF1X3NnZG1hX2JlICopdHRtOwogCXN0cnVjdCBub3V2ZWF1X2Ry
bSAqZHJtID0gbm91dmVhdV9iZGV2KGJkZXYpOwpAQCAtNTYsNyArNTYsNyBAQCBub3V2ZWF1X3Nn
ZG1hX2JpbmQoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSwg
c3RydWN0IHR0bV9yZQogfQogCiB2b2lkCi1ub3V2ZWF1X3NnZG1hX3VuYmluZChzdHJ1Y3QgdHRt
X2JvX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV90dCAqdHRtKQorbm91dmVhdV9zZ2RtYV91bmJp
bmQoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSkKIHsKIAlzdHJ1
Y3Qgbm91dmVhdV9zZ2RtYV9iZSAqbnZiZSA9IChzdHJ1Y3Qgbm91dmVhdV9zZ2RtYV9iZSAqKXR0
bTsKIAlpZiAobnZiZS0+bWVtKSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVh
dS9ub3V2ZWF1X3R0bS5jIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV90dG0uYwpp
bmRleCBlZGYzYmI4OWE0N2YuLjJmYjEyN2RhMDIwOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL25vdXZlYXUvbm91dmVhdV90dG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9u
b3V2ZWF1X3R0bS5jCkBAIC0zMTUsNyArMzE1LDcgQEAgbm91dmVhdV90dG1faW5pdChzdHJ1Y3Qg
bm91dmVhdV9kcm0gKmRybSkKIAkJZHJtLT5hZ3AuY21hID0gcGNpLT5hZ3AuY21hOwogCX0KIAot
CXJldCA9IHR0bV9ib19kZXZpY2VfaW5pdCgmZHJtLT50dG0uYmRldiwKKwlyZXQgPSB0dG1fZGV2
aWNlX2luaXQoJmRybS0+dHRtLmJkZXYsCiAJCQkJICAmbm91dmVhdV9ib19kcml2ZXIsCiAJCQkJ
ICBkZXYtPmFub25faW5vZGUtPmlfbWFwcGluZywKIAkJCQkgIGRldi0+dm1hX29mZnNldF9tYW5h
Z2VyLApAQCAtMzY5LDcgKzM2OSw3IEBAIG5vdXZlYXVfdHRtX2Zpbmkoc3RydWN0IG5vdXZlYXVf
ZHJtICpkcm0pCiAJbm91dmVhdV90dG1fZmluaV92cmFtKGRybSk7CiAJbm91dmVhdV90dG1fZmlu
aV9ndHQoZHJtKTsKIAotCXR0bV9ib19kZXZpY2VfcmVsZWFzZSgmZHJtLT50dG0uYmRldik7CisJ
dHRtX2RldmljZV9yZWxlYXNlKCZkcm0tPnR0bS5iZGV2KTsKIAogCWFyY2hfcGh5c193Y19kZWwo
ZHJtLT50dG0ubXRycik7CiAJZHJtLT50dG0ubXRyciA9IDA7CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X3R0bS5oIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUv
bm91dmVhdV90dG0uaAppbmRleCA2OTU1MjA0OWJiOTYuLmRiZjZkYzIzOGVmZCAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV90dG0uaAorKysgYi9kcml2ZXJzL2dw
dS9kcm0vbm91dmVhdS9ub3V2ZWF1X3R0bS5oCkBAIC0zLDcgKzMsNyBAQAogI2RlZmluZSBfX05P
VVZFQVVfVFRNX0hfXwogCiBzdGF0aWMgaW5saW5lIHN0cnVjdCBub3V2ZWF1X2RybSAqCi1ub3V2
ZWF1X2JkZXYoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkKQorbm91dmVhdV9iZGV2KHN0cnVjdCB0
dG1fZGV2aWNlICpiZCkKIHsKIAlyZXR1cm4gY29udGFpbmVyX29mKGJkLCBzdHJ1Y3Qgbm91dmVh
dV9kcm0sIHR0bS5iZGV2KTsKIH0KQEAgLTIyLDcgKzIyLDcgQEAgaW50ICBub3V2ZWF1X3R0bV9t
bWFwKHN0cnVjdCBmaWxlICosIHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqKTsKIGludCAgbm91dmVh
dV90dG1fZ2xvYmFsX2luaXQoc3RydWN0IG5vdXZlYXVfZHJtICopOwogdm9pZCBub3V2ZWF1X3R0
bV9nbG9iYWxfcmVsZWFzZShzdHJ1Y3Qgbm91dmVhdV9kcm0gKik7CiAKLWludCBub3V2ZWF1X3Nn
ZG1hX2JpbmQoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSwg
c3RydWN0IHR0bV9yZXNvdXJjZSAqcmVnKTsKLXZvaWQgbm91dmVhdV9zZ2RtYV91bmJpbmQoc3Ry
dWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSk7Ci12b2lkIG5vdXZl
YXVfc2dkbWFfZGVzdHJveShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV90
dCAqdHRtKTsKK2ludCBub3V2ZWF1X3NnZG1hX2JpbmQoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYs
IHN0cnVjdCB0dG1fdHQgKnR0bSwgc3RydWN0IHR0bV9yZXNvdXJjZSAqcmVnKTsKK3ZvaWQgbm91
dmVhdV9zZ2RtYV91bmJpbmQoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQg
KnR0bSk7Cit2b2lkIG5vdXZlYXVfc2dkbWFfZGVzdHJveShzdHJ1Y3QgdHRtX2RldmljZSAqYmRl
diwgc3RydWN0IHR0bV90dCAqdHRtKTsKICNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL3F4bC9xeGxfZHJ2LmggYi9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF9kcnYuaAppbmRleCAz
NjAyZThiMzQxODkuLjc4YzA5NjllMDQwMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3F4
bC9xeGxfZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL3F4bC9xeGxfZHJ2LmgKQEAgLTEyMyw3
ICsxMjMsNyBAQCBzdHJ1Y3QgcXhsX291dHB1dCB7CiAjZGVmaW5lIGRybV9lbmNvZGVyX3RvX3F4
bF9vdXRwdXQoeCkgY29udGFpbmVyX29mKHgsIHN0cnVjdCBxeGxfb3V0cHV0LCBlbmMpCiAKIHN0
cnVjdCBxeGxfbW1hbiB7Ci0Jc3RydWN0IHR0bV9ib19kZXZpY2UJCWJkZXY7CisJc3RydWN0IHR0
bV9kZXZpY2UJCWJkZXY7CiB9OwogCiBzdHJ1Y3QgcXhsX21lbXNsb3QgewpAQCAtMzQ4LDcgKzM0
OCw3IEBAIGludCBxeGxfbW9kZV9kdW1iX21tYXAoc3RydWN0IGRybV9maWxlICpmaWxwLAogLyog
cXhsIHR0bSAqLwogaW50IHF4bF90dG1faW5pdChzdHJ1Y3QgcXhsX2RldmljZSAqcWRldik7CiB2
b2lkIHF4bF90dG1fZmluaShzdHJ1Y3QgcXhsX2RldmljZSAqcWRldik7Ci1pbnQgcXhsX3R0bV9p
b19tZW1fcmVzZXJ2ZShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKK2ludCBxeGxfdHRtX2lv
X21lbV9yZXNlcnZlKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LAogCQkJICAgc3RydWN0IHR0bV9y
ZXNvdXJjZSAqbWVtKTsKIAogLyogcXhsIGltYWdlICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vcXhsL3F4bF9yZWxlYXNlLmMgYi9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF9yZWxlYXNl
LmMKaW5kZXggZTc1ZTM2NDY1NWI4Li45YTkwZjRlMzNmMDggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9xeGwvcXhsX3JlbGVhc2UuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF9y
ZWxlYXNlLmMKQEAgLTQyOSw3ICs0MjksNyBAQCB2b2lkIHF4bF9yZWxlYXNlX3VubWFwKHN0cnVj
dCBxeGxfZGV2aWNlICpxZGV2LAogdm9pZCBxeGxfcmVsZWFzZV9mZW5jZV9idWZmZXJfb2JqZWN0
cyhzdHJ1Y3QgcXhsX3JlbGVhc2UgKnJlbGVhc2UpCiB7CiAJc3RydWN0IHR0bV9idWZmZXJfb2Jq
ZWN0ICpibzsKLQlzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldjsKKwlzdHJ1Y3QgdHRtX2Rldmlj
ZSAqYmRldjsKIAlzdHJ1Y3QgdHRtX3ZhbGlkYXRlX2J1ZmZlciAqZW50cnk7CiAJc3RydWN0IHF4
bF9kZXZpY2UgKnFkZXY7CiAKQEAgLTQ1MCw3ICs0NTAsNyBAQCB2b2lkIHF4bF9yZWxlYXNlX2Zl
bmNlX2J1ZmZlcl9vYmplY3RzKHN0cnVjdCBxeGxfcmVsZWFzZSAqcmVsZWFzZSkKIAkJICAgICAg
IHJlbGVhc2UtPmlkIHwgMHhmMDAwMDAwMCwgcmVsZWFzZS0+YmFzZS5zZXFubyk7CiAJdHJhY2Vf
ZG1hX2ZlbmNlX2VtaXQoJnJlbGVhc2UtPmJhc2UpOwogCi0Jc3Bpbl9sb2NrKCZ0dG1fYm9fZ2xv
Yi5scnVfbG9jayk7CisJc3Bpbl9sb2NrKCZ0dG1fZ2xvYi5scnVfbG9jayk7CiAKIAlsaXN0X2Zv
cl9lYWNoX2VudHJ5KGVudHJ5LCAmcmVsZWFzZS0+Ym9zLCBoZWFkKSB7CiAJCWJvID0gZW50cnkt
PmJvOwpAQCAtNDU5LDcgKzQ1OSw3IEBAIHZvaWQgcXhsX3JlbGVhc2VfZmVuY2VfYnVmZmVyX29i
amVjdHMoc3RydWN0IHF4bF9yZWxlYXNlICpyZWxlYXNlKQogCQl0dG1fYm9fbW92ZV90b19scnVf
dGFpbChibywgTlVMTCk7CiAJCWRtYV9yZXN2X3VubG9jayhiby0+YmFzZS5yZXN2KTsKIAl9Ci0J
c3Bpbl91bmxvY2soJnR0bV9ib19nbG9iLmxydV9sb2NrKTsKKwlzcGluX3VubG9jaygmdHRtX2ds
b2IubHJ1X2xvY2spOwogCXd3X2FjcXVpcmVfZmluaSgmcmVsZWFzZS0+dGlja2V0KTsKIH0KIApk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3F4bC9xeGxfdHRtLmMgYi9kcml2ZXJzL2dwdS9k
cm0vcXhsL3F4bF90dG0uYwppbmRleCBkNTM1ZTgzNmJlNzIuLjliNzA3YWY3ZGZkMCAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL3F4bC9xeGxfdHRtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L3F4bC9xeGxfdHRtLmMKQEAgLTM4LDcgKzM4LDcgQEAKICNpbmNsdWRlICJxeGxfZHJ2LmgiCiAj
aW5jbHVkZSAicXhsX29iamVjdC5oIgogCi1zdGF0aWMgc3RydWN0IHF4bF9kZXZpY2UgKnF4bF9n
ZXRfcWRldihzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldikKK3N0YXRpYyBzdHJ1Y3QgcXhsX2Rl
dmljZSAqcXhsX2dldF9xZGV2KHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2KQogewogCXN0cnVjdCBx
eGxfbW1hbiAqbW1hbjsKIAlzdHJ1Y3QgcXhsX2RldmljZSAqcWRldjsKQEAgLTcxLDcgKzcxLDcg
QEAgc3RhdGljIHZvaWQgcXhsX2V2aWN0X2ZsYWdzKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAq
Ym8sCiAJKnBsYWNlbWVudCA9IHFiby0+cGxhY2VtZW50OwogfQogCi1pbnQgcXhsX3R0bV9pb19t
ZW1fcmVzZXJ2ZShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKK2ludCBxeGxfdHRtX2lvX21l
bV9yZXNlcnZlKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LAogCQkJICAgc3RydWN0IHR0bV9yZXNv
dXJjZSAqbWVtKQogewogCXN0cnVjdCBxeGxfZGV2aWNlICpxZGV2ID0gcXhsX2dldF9xZGV2KGJk
ZXYpOwpAQCAtMTA2LDcgKzEwNiw3IEBAIHN0cnVjdCBxeGxfdHRtX3R0IHsKIAl1NjQJCQkJb2Zm
c2V0OwogfTsKIAotc3RhdGljIGludCBxeGxfdHRtX2JhY2tlbmRfYmluZChzdHJ1Y3QgdHRtX2Jv
X2RldmljZSAqYmRldiwKK3N0YXRpYyBpbnQgcXhsX3R0bV9iYWNrZW5kX2JpbmQoc3RydWN0IHR0
bV9kZXZpY2UgKmJkZXYsCiAJCQkJc3RydWN0IHR0bV90dCAqdHRtLAogCQkJCXN0cnVjdCB0dG1f
cmVzb3VyY2UgKmJvX21lbSkKIHsKQEAgLTEyMSwxMyArMTIxLDEzIEBAIHN0YXRpYyBpbnQgcXhs
X3R0bV9iYWNrZW5kX2JpbmQoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCiAJcmV0dXJuIC0x
OwogfQogCi1zdGF0aWMgdm9pZCBxeGxfdHRtX2JhY2tlbmRfdW5iaW5kKHN0cnVjdCB0dG1fYm9f
ZGV2aWNlICpiZGV2LAorc3RhdGljIHZvaWQgcXhsX3R0bV9iYWNrZW5kX3VuYmluZChzdHJ1Y3Qg
dHRtX2RldmljZSAqYmRldiwKIAkJCQkgICBzdHJ1Y3QgdHRtX3R0ICp0dG0pCiB7CiAJLyogTm90
IGltcGxlbWVudGVkICovCiB9CiAKLXN0YXRpYyB2b2lkIHF4bF90dG1fYmFja2VuZF9kZXN0cm95
KHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAorc3RhdGljIHZvaWQgcXhsX3R0bV9iYWNrZW5k
X2Rlc3Ryb3koc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsCiAJCQkJICAgIHN0cnVjdCB0dG1fdHQg
KnR0bSkKIHsKIAlzdHJ1Y3QgcXhsX3R0bV90dCAqZ3R0ID0gKHZvaWQgKil0dG07CkBAIC0xODks
NyArMTg5LDcgQEAgc3RhdGljIHZvaWQgcXhsX2JvX21vdmVfbm90aWZ5KHN0cnVjdCB0dG1fYnVm
ZmVyX29iamVjdCAqYm8sCiAJCXF4bF9zdXJmYWNlX2V2aWN0KHFkZXYsIHFibywgbmV3X21lbSA/
IHRydWUgOiBmYWxzZSk7CiB9CiAKLXN0YXRpYyBzdHJ1Y3QgdHRtX2JvX2RyaXZlciBxeGxfYm9f
ZHJpdmVyID0geworc3RhdGljIHN0cnVjdCB0dG1fZGV2aWNlX2Z1bmNzIHF4bF9ib19kcml2ZXIg
PSB7CiAJLnR0bV90dF9jcmVhdGUgPSAmcXhsX3R0bV90dF9jcmVhdGUsCiAJLnR0bV90dF9iaW5k
ID0gJnF4bF90dG1fYmFja2VuZF9iaW5kLAogCS50dG1fdHRfZGVzdHJveSA9ICZxeGxfdHRtX2Jh
Y2tlbmRfZGVzdHJveSwKQEAgLTIxNCw3ICsyMTQsNyBAQCBpbnQgcXhsX3R0bV9pbml0KHN0cnVj
dCBxeGxfZGV2aWNlICpxZGV2KQogCWludCBudW1faW9fcGFnZXM7IC8qICE9IHJvbS0+bnVtX2lv
X3BhZ2VzLCB3ZSBpbmNsdWRlIHN1cmZhY2UwICovCiAKIAkvKiBObyBvdGhlcnMgdXNlciBvZiBh
ZGRyZXNzIHNwYWNlIHNvIHNldCBpdCB0byAwICovCi0JciA9IHR0bV9ib19kZXZpY2VfaW5pdCgm
cWRldi0+bW1hbi5iZGV2LAorCXIgPSB0dG1fZGV2aWNlX2luaXQoJnFkZXYtPm1tYW4uYmRldiwK
IAkJCSAgICAgICAmcXhsX2JvX2RyaXZlciwKIAkJCSAgICAgICBxZGV2LT5kZGV2LmFub25faW5v
ZGUtPmlfbWFwcGluZywKIAkJCSAgICAgICBxZGV2LT5kZGV2LnZtYV9vZmZzZXRfbWFuYWdlciwK
QEAgLTI0OSw3ICsyNDksNyBAQCB2b2lkIHF4bF90dG1fZmluaShzdHJ1Y3QgcXhsX2RldmljZSAq
cWRldikKIHsKIAl0dG1fcmFuZ2VfbWFuX2ZpbmkoJnFkZXYtPm1tYW4uYmRldiwgVFRNX1BMX1ZS
QU0pOwogCXR0bV9yYW5nZV9tYW5fZmluaSgmcWRldi0+bW1hbi5iZGV2LCBUVE1fUExfUFJJVik7
Ci0JdHRtX2JvX2RldmljZV9yZWxlYXNlKCZxZGV2LT5tbWFuLmJkZXYpOworCXR0bV9kZXZpY2Vf
cmVsZWFzZSgmcWRldi0+bW1hbi5iZGV2KTsKIAlEUk1fSU5GTygicXhsOiB0dG0gZmluYWxpemVk
XG4iKTsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb24uaCBi
L2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uLmgKaW5kZXggNWQ1NGJjY2ViZDRkLi43NzU1
NzY0NzBlNzggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uLmgKKysr
IGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb24uaApAQCAtNDUyLDcgKzQ1Miw3IEBAIHN0
cnVjdCByYWRlb25fc3VyZmFjZV9yZWcgewogICogVFRNLgogICovCiBzdHJ1Y3QgcmFkZW9uX21t
YW4gewotCXN0cnVjdCB0dG1fYm9fZGV2aWNlCQliZGV2OworCXN0cnVjdCB0dG1fZGV2aWNlCQli
ZGV2OwogCWJvb2wJCQkJaW5pdGlhbGl6ZWQ7CiAKICNpZiBkZWZpbmVkKENPTkZJR19ERUJVR19G
UykKQEAgLTI4MTksNyArMjgxOSw3IEBAIGV4dGVybiBpbnQgcmFkZW9uX3R0bV90dF9zZXRfdXNl
cnB0cihzdHJ1Y3QgcmFkZW9uX2RldmljZSAqcmRldiwKIAkJCQkgICAgIHVpbnQzMl90IGZsYWdz
KTsKIGV4dGVybiBib29sIHJhZGVvbl90dG1fdHRfaGFzX3VzZXJwdHIoc3RydWN0IHJhZGVvbl9k
ZXZpY2UgKnJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSk7CiBleHRlcm4gYm9vbCByYWRlb25fdHRt
X3R0X2lzX3JlYWRvbmx5KHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2LCBzdHJ1Y3QgdHRtX3R0
ICp0dG0pOwotYm9vbCByYWRlb25fdHRtX3R0X2lzX2JvdW5kKHN0cnVjdCB0dG1fYm9fZGV2aWNl
ICpiZGV2LCBzdHJ1Y3QgdHRtX3R0ICp0dG0pOworYm9vbCByYWRlb25fdHRtX3R0X2lzX2JvdW5k
KHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LCBzdHJ1Y3QgdHRtX3R0ICp0dG0pOwogZXh0ZXJuIHZv
aWQgcmFkZW9uX3ZyYW1fbG9jYXRpb24oc3RydWN0IHJhZGVvbl9kZXZpY2UgKnJkZXYsIHN0cnVj
dCByYWRlb25fbWMgKm1jLCB1NjQgYmFzZSk7CiBleHRlcm4gdm9pZCByYWRlb25fZ3R0X2xvY2F0
aW9uKHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2LCBzdHJ1Y3QgcmFkZW9uX21jICptYyk7CiBl
eHRlcm4gaW50IHJhZGVvbl9yZXN1bWVfa21zKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIGJvb2wg
cmVzdW1lLCBib29sIGZiY29uKTsKQEAgLTI4MjksNyArMjgyOSw3IEBAIGV4dGVybiB2b2lkIHJh
ZGVvbl90dG1fc2V0X2FjdGl2ZV92cmFtX3NpemUoc3RydWN0IHJhZGVvbl9kZXZpY2UgKnJkZXYs
IHU2NCBzaXplCiBleHRlcm4gdm9pZCByYWRlb25fcHJvZ3JhbV9yZWdpc3Rlcl9zZXF1ZW5jZShz
dHJ1Y3QgcmFkZW9uX2RldmljZSAqcmRldiwKIAkJCQkJICAgICBjb25zdCB1MzIgKnJlZ2lzdGVy
cywKIAkJCQkJICAgICBjb25zdCB1MzIgYXJyYXlfc2l6ZSk7Ci1zdHJ1Y3QgcmFkZW9uX2Rldmlj
ZSAqcmFkZW9uX2dldF9yZGV2KHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2KTsKK3N0cnVjdCBy
YWRlb25fZGV2aWNlICpyYWRlb25fZ2V0X3JkZXYoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYpOwog
CiAvKgogICogdm0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX3R0
bS5jIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fdHRtLmMKaW5kZXggZDZmNDJmYmM4
MWY0Li4zODM1Yzk0NTdjMDYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFk
ZW9uX3R0bS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX3R0bS5jCkBAIC01
NiwxMSArNTYsMTEgQEAKIHN0YXRpYyBpbnQgcmFkZW9uX3R0bV9kZWJ1Z2ZzX2luaXQoc3RydWN0
IHJhZGVvbl9kZXZpY2UgKnJkZXYpOwogc3RhdGljIHZvaWQgcmFkZW9uX3R0bV9kZWJ1Z2ZzX2Zp
bmkoc3RydWN0IHJhZGVvbl9kZXZpY2UgKnJkZXYpOwogCi1zdGF0aWMgaW50IHJhZGVvbl90dG1f
dHRfYmluZChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKK3N0YXRpYyBpbnQgcmFkZW9uX3R0
bV90dF9iaW5kKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LAogCQkJICAgICAgc3RydWN0IHR0bV90
dCAqdHRtLAogCQkJICAgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqYm9fbWVtKTsKIAotc3RydWN0
IHJhZGVvbl9kZXZpY2UgKnJhZGVvbl9nZXRfcmRldihzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRl
dikKK3N0cnVjdCByYWRlb25fZGV2aWNlICpyYWRlb25fZ2V0X3JkZXYoc3RydWN0IHR0bV9kZXZp
Y2UgKmJkZXYpCiB7CiAJc3RydWN0IHJhZGVvbl9tbWFuICptbWFuOwogCXN0cnVjdCByYWRlb25f
ZGV2aWNlICpyZGV2OwpAQCAtMzUxLDcgKzM1MSw3IEBAIHN0YXRpYyBpbnQgcmFkZW9uX2JvX21v
dmUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywgYm9vbCBldmljdCwKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCByYWRlb25fdHRtX2lvX21lbV9yZXNlcnZlKHN0cnVjdCB0dG1fYm9f
ZGV2aWNlICpiZGV2LCBzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0pCitzdGF0aWMgaW50IHJhZGVv
bl90dG1faW9fbWVtX3Jlc2VydmUoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1f
cmVzb3VyY2UgKm1lbSkKIHsKIAlzdHJ1Y3QgcmFkZW9uX2RldmljZSAqcmRldiA9IHJhZGVvbl9n
ZXRfcmRldihiZGV2KTsKIAlzaXplX3QgYnVzX3NpemUgPSAoc2l6ZV90KW1lbS0+bnVtX3BhZ2Vz
IDw8IFBBR0VfU0hJRlQ7CkBAIC00MTgsNyArNDE4LDcgQEAgc3RydWN0IHJhZGVvbl90dG1fdHQg
ewogfTsKIAogLyogcHJlcGFyZSB0aGUgc2cgdGFibGUgd2l0aCB0aGUgdXNlciBwYWdlcyAqLwot
c3RhdGljIGludCByYWRlb25fdHRtX3R0X3Bpbl91c2VycHRyKHN0cnVjdCB0dG1fYm9fZGV2aWNl
ICpiZGV2LCBzdHJ1Y3QgdHRtX3R0ICp0dG0pCitzdGF0aWMgaW50IHJhZGVvbl90dG1fdHRfcGlu
X3VzZXJwdHIoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSkKIHsK
IAlzdHJ1Y3QgcmFkZW9uX2RldmljZSAqcmRldiA9IHJhZGVvbl9nZXRfcmRldihiZGV2KTsKIAlz
dHJ1Y3QgcmFkZW9uX3R0bV90dCAqZ3R0ID0gKHZvaWQgKil0dG07CkBAIC00NzksNyArNDc5LDcg
QEAgc3RhdGljIGludCByYWRlb25fdHRtX3R0X3Bpbl91c2VycHRyKHN0cnVjdCB0dG1fYm9fZGV2
aWNlICpiZGV2LCBzdHJ1Y3QgdHRtX3R0ICoKIAlyZXR1cm4gcjsKIH0KIAotc3RhdGljIHZvaWQg
cmFkZW9uX3R0bV90dF91bnBpbl91c2VycHRyKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LCBz
dHJ1Y3QgdHRtX3R0ICp0dG0pCitzdGF0aWMgdm9pZCByYWRlb25fdHRtX3R0X3VucGluX3VzZXJw
dHIoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSkKIHsKIAlzdHJ1
Y3QgcmFkZW9uX2RldmljZSAqcmRldiA9IHJhZGVvbl9nZXRfcmRldihiZGV2KTsKIAlzdHJ1Y3Qg
cmFkZW9uX3R0bV90dCAqZ3R0ID0gKHZvaWQgKil0dG07CkBAIC01MTUsNyArNTE1LDcgQEAgc3Rh
dGljIGJvb2wgcmFkZW9uX3R0bV9iYWNrZW5kX2lzX2JvdW5kKHN0cnVjdCB0dG1fdHQgKnR0bSkK
IAlyZXR1cm4gKGd0dC0+Ym91bmQpOwogfQogCi1zdGF0aWMgaW50IHJhZGVvbl90dG1fYmFja2Vu
ZF9iaW5kKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAorc3RhdGljIGludCByYWRlb25fdHRt
X2JhY2tlbmRfYmluZChzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwKIAkJCQkgICBzdHJ1Y3QgdHRt
X3R0ICp0dG0sCiAJCQkJICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqYm9fbWVtKQogewpAQCAtNTUx
LDcgKzU1MSw3IEBAIHN0YXRpYyBpbnQgcmFkZW9uX3R0bV9iYWNrZW5kX2JpbmQoc3RydWN0IHR0
bV9ib19kZXZpY2UgKmJkZXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyB2b2lkIHJhZGVvbl90
dG1fYmFja2VuZF91bmJpbmQoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1f
dHQgKnR0bSkKK3N0YXRpYyB2b2lkIHJhZGVvbl90dG1fYmFja2VuZF91bmJpbmQoc3RydWN0IHR0
bV9kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSkKIHsKIAlzdHJ1Y3QgcmFkZW9uX3R0
bV90dCAqZ3R0ID0gKHZvaWQgKil0dG07CiAJc3RydWN0IHJhZGVvbl9kZXZpY2UgKnJkZXYgPSBy
YWRlb25fZ2V0X3JkZXYoYmRldik7CkBAIC01NjYsNyArNTY2LDcgQEAgc3RhdGljIHZvaWQgcmFk
ZW9uX3R0bV9iYWNrZW5kX3VuYmluZChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwgc3RydWN0
IHR0bV90dAogCWd0dC0+Ym91bmQgPSBmYWxzZTsKIH0KIAotc3RhdGljIHZvaWQgcmFkZW9uX3R0
bV9iYWNrZW5kX2Rlc3Ryb3koc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1f
dHQgKnR0bSkKK3N0YXRpYyB2b2lkIHJhZGVvbl90dG1fYmFja2VuZF9kZXN0cm95KHN0cnVjdCB0
dG1fZGV2aWNlICpiZGV2LCBzdHJ1Y3QgdHRtX3R0ICp0dG0pCiB7CiAJc3RydWN0IHJhZGVvbl90
dG1fdHQgKmd0dCA9ICh2b2lkICopdHRtOwogCkBAIC02MjcsNyArNjI3LDcgQEAgc3RhdGljIHN0
cnVjdCByYWRlb25fdHRtX3R0ICpyYWRlb25fdHRtX3R0X3RvX2d0dChzdHJ1Y3QgcmFkZW9uX2Rl
dmljZSAqcmRldiwKIAlyZXR1cm4gY29udGFpbmVyX29mKHR0bSwgc3RydWN0IHJhZGVvbl90dG1f
dHQsIHR0bS50dG0pOwogfQogCi1zdGF0aWMgaW50IHJhZGVvbl90dG1fdHRfcG9wdWxhdGUoc3Ry
dWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCitzdGF0aWMgaW50IHJhZGVvbl90dG1fdHRfcG9wdWxh
dGUoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsCiAJCQkJICBzdHJ1Y3QgdHRtX3R0ICp0dG0sCiAJ
CQkJICBzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHggKmN0eCkKIHsKQEAgLTY2Nyw3ICs2NjcsNyBA
QCBzdGF0aWMgaW50IHJhZGVvbl90dG1fdHRfcG9wdWxhdGUoc3RydWN0IHR0bV9ib19kZXZpY2Ug
KmJkZXYsCiAJcmV0dXJuIHR0bV9wb3B1bGF0ZV9hbmRfbWFwX3BhZ2VzKHJkZXYtPmRldiwgJmd0
dC0+dHRtLCBjdHgpOwogfQogCi1zdGF0aWMgdm9pZCByYWRlb25fdHRtX3R0X3VucG9wdWxhdGUo
c3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSkKK3N0YXRpYyB2
b2lkIHJhZGVvbl90dG1fdHRfdW5wb3B1bGF0ZShzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwgc3Ry
dWN0IHR0bV90dCAqdHRtKQogewogCXN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2ID0gcmFkZW9u
X2dldF9yZGV2KGJkZXYpOwogCXN0cnVjdCByYWRlb25fdHRtX3R0ICpndHQgPSByYWRlb25fdHRt
X3R0X3RvX2d0dChyZGV2LCB0dG0pOwpAQCAtNzE0LDcgKzcxNCw3IEBAIGludCByYWRlb25fdHRt
X3R0X3NldF91c2VycHRyKHN0cnVjdCByYWRlb25fZGV2aWNlICpyZGV2LAogCXJldHVybiAwOwog
fQogCi1ib29sIHJhZGVvbl90dG1fdHRfaXNfYm91bmQoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJk
ZXYsCitib29sIHJhZGVvbl90dG1fdHRfaXNfYm91bmQoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYs
CiAJCQkgICAgc3RydWN0IHR0bV90dCAqdHRtKQogewogI2lmIElTX0VOQUJMRUQoQ09ORklHX0FH
UCkKQEAgLTcyNSw3ICs3MjUsNyBAQCBib29sIHJhZGVvbl90dG1fdHRfaXNfYm91bmQoc3RydWN0
IHR0bV9ib19kZXZpY2UgKmJkZXYsCiAJcmV0dXJuIHJhZGVvbl90dG1fYmFja2VuZF9pc19ib3Vu
ZCh0dG0pOwogfQogCi1zdGF0aWMgaW50IHJhZGVvbl90dG1fdHRfYmluZChzdHJ1Y3QgdHRtX2Jv
X2RldmljZSAqYmRldiwKK3N0YXRpYyBpbnQgcmFkZW9uX3R0bV90dF9iaW5kKHN0cnVjdCB0dG1f
ZGV2aWNlICpiZGV2LAogCQkJICAgICAgc3RydWN0IHR0bV90dCAqdHRtLAogCQkJICAgICAgc3Ry
dWN0IHR0bV9yZXNvdXJjZSAqYm9fbWVtKQogewpAQCAtNzQzLDcgKzc0Myw3IEBAIHN0YXRpYyBp
bnQgcmFkZW9uX3R0bV90dF9iaW5kKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAogCXJldHVy
biByYWRlb25fdHRtX2JhY2tlbmRfYmluZChiZGV2LCB0dG0sIGJvX21lbSk7CiB9CiAKLXN0YXRp
YyB2b2lkIHJhZGVvbl90dG1fdHRfdW5iaW5kKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAor
c3RhdGljIHZvaWQgcmFkZW9uX3R0bV90dF91bmJpbmQoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYs
CiAJCQkJIHN0cnVjdCB0dG1fdHQgKnR0bSkKIHsKICNpZiBJU19FTkFCTEVEKENPTkZJR19BR1Ap
CkBAIC03NTcsNyArNzU3LDcgQEAgc3RhdGljIHZvaWQgcmFkZW9uX3R0bV90dF91bmJpbmQoc3Ry
dWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCiAJcmFkZW9uX3R0bV9iYWNrZW5kX3VuYmluZChiZGV2
LCB0dG0pOwogfQogCi1zdGF0aWMgdm9pZCByYWRlb25fdHRtX3R0X2Rlc3Ryb3koc3RydWN0IHR0
bV9ib19kZXZpY2UgKmJkZXYsCitzdGF0aWMgdm9pZCByYWRlb25fdHRtX3R0X2Rlc3Ryb3koc3Ry
dWN0IHR0bV9kZXZpY2UgKmJkZXYsCiAJCQkJICBzdHJ1Y3QgdHRtX3R0ICp0dG0pCiB7CiAjaWYg
SVNfRU5BQkxFRChDT05GSUdfQUdQKQpAQCAtNzk1LDcgKzc5NSw3IEBAIGJvb2wgcmFkZW9uX3R0
bV90dF9pc19yZWFkb25seShzdHJ1Y3QgcmFkZW9uX2RldmljZSAqcmRldiwKIAlyZXR1cm4gISEo
Z3R0LT51c2VyZmxhZ3MgJiBSQURFT05fR0VNX1VTRVJQVFJfUkVBRE9OTFkpOwogfQogCi1zdGF0
aWMgc3RydWN0IHR0bV9ib19kcml2ZXIgcmFkZW9uX2JvX2RyaXZlciA9IHsKK3N0YXRpYyBzdHJ1
Y3QgdHRtX2RldmljZV9mdW5jcyByYWRlb25fYm9fZHJpdmVyID0gewogCS50dG1fdHRfY3JlYXRl
ID0gJnJhZGVvbl90dG1fdHRfY3JlYXRlLAogCS50dG1fdHRfcG9wdWxhdGUgPSAmcmFkZW9uX3R0
bV90dF9wb3B1bGF0ZSwKIAkudHRtX3R0X3VucG9wdWxhdGUgPSAmcmFkZW9uX3R0bV90dF91bnBv
cHVsYXRlLApAQCAtODE1LDcgKzgxNSw3IEBAIGludCByYWRlb25fdHRtX2luaXQoc3RydWN0IHJh
ZGVvbl9kZXZpY2UgKnJkZXYpCiAJaW50IHI7CiAKIAkvKiBObyBvdGhlcnMgdXNlciBvZiBhZGRy
ZXNzIHNwYWNlIHNvIHNldCBpdCB0byAwICovCi0JciA9IHR0bV9ib19kZXZpY2VfaW5pdCgmcmRl
di0+bW1hbi5iZGV2LAorCXIgPSB0dG1fZGV2aWNlX2luaXQoJnJkZXYtPm1tYW4uYmRldiwKIAkJ
CSAgICAgICAmcmFkZW9uX2JvX2RyaXZlciwKIAkJCSAgICAgICByZGV2LT5kZGV2LT5hbm9uX2lu
b2RlLT5pX21hcHBpbmcsCiAJCQkgICAgICAgcmRldi0+ZGRldi0+dm1hX29mZnNldF9tYW5hZ2Vy
LApAQCAtODg1LDcgKzg4NSw3IEBAIHZvaWQgcmFkZW9uX3R0bV9maW5pKHN0cnVjdCByYWRlb25f
ZGV2aWNlICpyZGV2KQogCX0KIAl0dG1fcmFuZ2VfbWFuX2ZpbmkoJnJkZXYtPm1tYW4uYmRldiwg
VFRNX1BMX1ZSQU0pOwogCXR0bV9yYW5nZV9tYW5fZmluaSgmcmRldi0+bW1hbi5iZGV2LCBUVE1f
UExfVFQpOwotCXR0bV9ib19kZXZpY2VfcmVsZWFzZSgmcmRldi0+bW1hbi5iZGV2KTsKKwl0dG1f
ZGV2aWNlX3JlbGVhc2UoJnJkZXYtPm1tYW4uYmRldik7CiAJcmFkZW9uX2dhcnRfZmluaShyZGV2
KTsKIAlyZGV2LT5tbWFuLmluaXRpYWxpemVkID0gZmFsc2U7CiAJRFJNX0lORk8oInJhZGVvbjog
dHRtIGZpbmFsaXplZFxuIik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdHRtL01ha2Vm
aWxlIGIvZHJpdmVycy9ncHUvZHJtL3R0bS9NYWtlZmlsZQppbmRleCA5MGMwZGE4OGNjOTguLjdh
NDc0ZTg4ZDQ3ZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0bS9NYWtlZmlsZQorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vdHRtL01ha2VmaWxlCkBAIC01LDcgKzUsNyBAQAogdHRtLXkgOj0g
dHRtX21lbW9yeS5vIHR0bV90dC5vIHR0bV9iby5vIFwKIAl0dG1fYm9fdXRpbC5vIHR0bV9ib192
bS5vIHR0bV9tb2R1bGUubyBcCiAJdHRtX2V4ZWNidWZfdXRpbC5vIHR0bV9wYWdlX2FsbG9jLm8g
dHRtX3JhbmdlX21hbmFnZXIubyBcCi0JdHRtX3Jlc291cmNlLm8KKwl0dG1fcmVzb3VyY2UubyB0
dG1fZGV2aWNlLm8KIHR0bS0kKENPTkZJR19BR1ApICs9IHR0bV9hZ3BfYmFja2VuZC5vCiB0dG0t
JChDT05GSUdfRFJNX1RUTV9ETUFfUEFHRV9QT09MKSArPSB0dG1fcGFnZV9hbGxvY19kbWEubwog
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9hZ3BfYmFja2VuZC5jIGIvZHJp
dmVycy9ncHUvZHJtL3R0bS90dG1fYWdwX2JhY2tlbmQuYwppbmRleCA0Zjc2YzkyODcxNTkuLmIz
ODJkOTE0MTRhMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYWdwX2JhY2tl
bmQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9hZ3BfYmFja2VuZC5jCkBAIC01MSw3
ICs1MSw3IEBAIHN0cnVjdCB0dG1fYWdwX2JhY2tlbmQgewogaW50IHR0bV9hZ3BfYmluZChzdHJ1
Y3QgdHRtX3R0ICp0dG0sIHN0cnVjdCB0dG1fcmVzb3VyY2UgKmJvX21lbSkKIHsKIAlzdHJ1Y3Qg
dHRtX2FncF9iYWNrZW5kICphZ3BfYmUgPSBjb250YWluZXJfb2YodHRtLCBzdHJ1Y3QgdHRtX2Fn
cF9iYWNrZW5kLCB0dG0pOwotCXN0cnVjdCBwYWdlICpkdW1teV9yZWFkX3BhZ2UgPSB0dG1fYm9f
Z2xvYi5kdW1teV9yZWFkX3BhZ2U7CisJc3RydWN0IHBhZ2UgKmR1bW15X3JlYWRfcGFnZSA9IHR0
bV9nbG9iLmR1bW15X3JlYWRfcGFnZTsKIAlzdHJ1Y3QgZHJtX21tX25vZGUgKm5vZGUgPSBib19t
ZW0tPm1tX25vZGU7CiAJc3RydWN0IGFncF9tZW1vcnkgKm1lbTsKIAlpbnQgcmV0LCBjYWNoZWQg
PSB0dG0tPmNhY2hpbmcgPT0gdHRtX2NhY2hlZDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS90dG0vdHRtX2JvLmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5jCmluZGV4IDJmZTRj
YmVmZGUyOC4uNDBkMWFjOTFjOWJmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0
bV9iby5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvLmMKQEAgLTQzLDIxICs0Myw2
IEBACiAjaW5jbHVkZSA8bGludXgvYXRvbWljLmg+CiAjaW5jbHVkZSA8bGludXgvZG1hLXJlc3Yu
aD4KIAotc3RhdGljIHZvaWQgdHRtX2JvX2dsb2JhbF9rb2JqX3JlbGVhc2Uoc3RydWN0IGtvYmpl
Y3QgKmtvYmopOwotCi0vKioKLSAqIHR0bV9nbG9iYWxfbXV0ZXggLSBwcm90ZWN0aW5nIHRoZSBn
bG9iYWwgQk8gc3RhdGUKLSAqLwotREVGSU5FX01VVEVYKHR0bV9nbG9iYWxfbXV0ZXgpOwotdW5z
aWduZWQgdHRtX2JvX2dsb2JfdXNlX2NvdW50Owotc3RydWN0IHR0bV9ib19nbG9iYWwgdHRtX2Jv
X2dsb2I7Ci1FWFBPUlRfU1lNQk9MKHR0bV9ib19nbG9iKTsKLQotc3RhdGljIHN0cnVjdCBhdHRy
aWJ1dGUgdHRtX2JvX2NvdW50ID0gewotCS5uYW1lID0gImJvX2NvdW50IiwKLQkubW9kZSA9IFNf
SVJVR08KLX07Ci0KIC8qIGRlZmF1bHQgZGVzdHJ1Y3RvciAqLwogc3RhdGljIHZvaWQgdHRtX2Jv
X2RlZmF1bHRfZGVzdHJveShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvKQogewpAQCAtODMs
MzYgKzY4LDEwIEBAIHN0YXRpYyB2b2lkIHR0bV9ib19tZW1fc3BhY2VfZGVidWcoc3RydWN0IHR0
bV9idWZmZXJfb2JqZWN0ICpibywKIAl9CiB9CiAKLXN0YXRpYyBzc2l6ZV90IHR0bV9ib19nbG9i
YWxfc2hvdyhzdHJ1Y3Qga29iamVjdCAqa29iaiwKLQkJCQkgIHN0cnVjdCBhdHRyaWJ1dGUgKmF0
dHIsCi0JCQkJICBjaGFyICpidWZmZXIpCi17Ci0Jc3RydWN0IHR0bV9ib19nbG9iYWwgKmdsb2Ig
PQotCQljb250YWluZXJfb2Yoa29iaiwgc3RydWN0IHR0bV9ib19nbG9iYWwsIGtvYmopOwotCi0J
cmV0dXJuIHNucHJpbnRmKGJ1ZmZlciwgUEFHRV9TSVpFLCAiJWRcbiIsCi0JCQkJYXRvbWljX3Jl
YWQoJmdsb2ItPmJvX2NvdW50KSk7Ci19Ci0KLXN0YXRpYyBzdHJ1Y3QgYXR0cmlidXRlICp0dG1f
Ym9fZ2xvYmFsX2F0dHJzW10gPSB7Ci0JJnR0bV9ib19jb3VudCwKLQlOVUxMCi19OwotCi1zdGF0
aWMgY29uc3Qgc3RydWN0IHN5c2ZzX29wcyB0dG1fYm9fZ2xvYmFsX29wcyA9IHsKLQkuc2hvdyA9
ICZ0dG1fYm9fZ2xvYmFsX3Nob3cKLX07Ci0KLXN0YXRpYyBzdHJ1Y3Qga29ial90eXBlIHR0bV9i
b19nbG9iX2tvYmpfdHlwZSAgPSB7Ci0JLnJlbGVhc2UgPSAmdHRtX2JvX2dsb2JhbF9rb2JqX3Jl
bGVhc2UsCi0JLnN5c2ZzX29wcyA9ICZ0dG1fYm9fZ2xvYmFsX29wcywKLQkuZGVmYXVsdF9hdHRy
cyA9IHR0bV9ib19nbG9iYWxfYXR0cnMKLX07Ci0KIHN0YXRpYyB2b2lkIHR0bV9ib19hZGRfbWVt
X3RvX2xydShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQkJCSAgc3RydWN0IHR0bV9y
ZXNvdXJjZSAqbWVtKQogewotCXN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2ID0gYm8tPmJkZXY7
CisJc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYgPSBiby0+YmRldjsKIAlzdHJ1Y3QgdHRtX3Jlc291
cmNlX21hbmFnZXIgKm1hbjsKIAogCWlmICghbGlzdF9lbXB0eSgmYm8tPmxydSkgfHwgYm8tPnBp
bl9jb3VudCkKQEAgLTEyNCwxMyArODMsMTMgQEAgc3RhdGljIHZvaWQgdHRtX2JvX2FkZF9tZW1f
dG9fbHJ1KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJaWYgKG1hbi0+dXNlX3R0ICYm
IGJvLT50dG0gJiYKIAkgICAgIShiby0+dHRtLT5wYWdlX2ZsYWdzICYgKFRUTV9QQUdFX0ZMQUdf
U0cgfAogCQkJCSAgICAgVFRNX1BBR0VfRkxBR19TV0FQUEVEKSkpIHsKLQkJbGlzdF9hZGRfdGFp
bCgmYm8tPnN3YXAsICZ0dG1fYm9fZ2xvYi5zd2FwX2xydVtiby0+cHJpb3JpdHldKTsKKwkJbGlz
dF9hZGRfdGFpbCgmYm8tPnN3YXAsICZ0dG1fZ2xvYi5zd2FwX2xydVtiby0+cHJpb3JpdHldKTsK
IAl9CiB9CiAKIHN0YXRpYyB2b2lkIHR0bV9ib19kZWxfZnJvbV9scnUoc3RydWN0IHR0bV9idWZm
ZXJfb2JqZWN0ICpibykKIHsKLQlzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiA9IGJvLT5iZGV2
OworCXN0cnVjdCB0dG1fZGV2aWNlICpiZGV2ID0gYm8tPmJkZXY7CiAJYm9vbCBub3RpZnkgPSBm
YWxzZTsKIAogCWlmICghbGlzdF9lbXB0eSgmYm8tPnN3YXApKSB7CkBAIC0xNDIsOCArMTAxLDgg
QEAgc3RhdGljIHZvaWQgdHRtX2JvX2RlbF9mcm9tX2xydShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmpl
Y3QgKmJvKQogCQlub3RpZnkgPSB0cnVlOwogCX0KIAotCWlmIChub3RpZnkgJiYgYmRldi0+ZHJp
dmVyLT5kZWxfZnJvbV9scnVfbm90aWZ5KQotCQliZGV2LT5kcml2ZXItPmRlbF9mcm9tX2xydV9u
b3RpZnkoYm8pOworCWlmIChub3RpZnkgJiYgYmRldi0+ZnVuY3MtPmRlbF9mcm9tX2xydV9ub3Rp
ZnkpCisJCWJkZXYtPmZ1bmNzLT5kZWxfZnJvbV9scnVfbm90aWZ5KGJvKTsKIH0KIAogc3RhdGlj
IHZvaWQgdHRtX2JvX2J1bGtfbW92ZV9zZXRfcG9zKHN0cnVjdCB0dG1fbHJ1X2J1bGtfbW92ZV9w
b3MgKnBvcywKQEAgLTIyMyw3ICsxODIsNyBAQCB2b2lkIHR0bV9ib19idWxrX21vdmVfbHJ1X3Rh
aWwoc3RydWN0IHR0bV9scnVfYnVsa19tb3ZlICpidWxrKQogCQlkbWFfcmVzdl9hc3NlcnRfaGVs
ZChwb3MtPmZpcnN0LT5iYXNlLnJlc3YpOwogCQlkbWFfcmVzdl9hc3NlcnRfaGVsZChwb3MtPmxh
c3QtPmJhc2UucmVzdik7CiAKLQkJbHJ1ID0gJnR0bV9ib19nbG9iLnN3YXBfbHJ1W2ldOworCQls
cnUgPSAmdHRtX2dsb2Iuc3dhcF9scnVbaV07CiAJCWxpc3RfYnVsa19tb3ZlX3RhaWwobHJ1LCAm
cG9zLT5maXJzdC0+c3dhcCwgJnBvcy0+bGFzdC0+c3dhcCk7CiAJfQogfQpAQCAtMjMzLDcgKzE5
Miw3IEBAIHN0YXRpYyBpbnQgdHRtX2JvX2hhbmRsZV9tb3ZlX21lbShzdHJ1Y3QgdHRtX2J1ZmZl
cl9vYmplY3QgKmJvLAogCQkJCSAgc3RydWN0IHR0bV9yZXNvdXJjZSAqbWVtLCBib29sIGV2aWN0
LAogCQkJCSAgc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4ICpjdHgpCiB7Ci0Jc3RydWN0IHR0bV9i
b19kZXZpY2UgKmJkZXYgPSBiby0+YmRldjsKKwlzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiA9IGJv
LT5iZGV2OwogCXN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqb2xkX21hbiA9IHR0bV9tYW5h
Z2VyX3R5cGUoYmRldiwgYm8tPm1lbS5tZW1fdHlwZSk7CiAJc3RydWN0IHR0bV9yZXNvdXJjZV9t
YW5hZ2VyICpuZXdfbWFuID0gdHRtX21hbmFnZXJfdHlwZShiZGV2LCBtZW0tPm1lbV90eXBlKTsK
IAlpbnQgcmV0OwpAQCAtMjYzLDggKzIyMiw4IEBAIHN0YXRpYyBpbnQgdHRtX2JvX2hhbmRsZV9t
b3ZlX21lbShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQl9CiAJfQogCi0JaWYgKGJk
ZXYtPmRyaXZlci0+bW92ZV9ub3RpZnkpCi0JCWJkZXYtPmRyaXZlci0+bW92ZV9ub3RpZnkoYm8s
IGV2aWN0LCBtZW0pOworCWlmIChiZGV2LT5mdW5jcy0+bW92ZV9ub3RpZnkpCisJCWJkZXYtPmZ1
bmNzLT5tb3ZlX25vdGlmeShibywgZXZpY3QsIG1lbSk7CiAKIAlpZiAob2xkX21hbi0+dXNlX3R0
ICYmIG5ld19tYW4tPnVzZV90dCkgewogCQlpZiAoYm8tPm1lbS5tZW1fdHlwZSA9PSBUVE1fUExf
U1lTVEVNKSB7CkBAIC0yNzIsMTYgKzIzMSwxNiBAQCBzdGF0aWMgaW50IHR0bV9ib19oYW5kbGVf
bW92ZV9tZW0oc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAkJCXJldCA9IDA7CiAJCX0g
ZWxzZQogCQkJcmV0ID0gdHRtX2JvX21vdmVfdHRtKGJvLCBjdHgsIG1lbSk7Ci0JfSBlbHNlIGlm
IChiZGV2LT5kcml2ZXItPm1vdmUpIHsKLQkJcmV0ID0gYmRldi0+ZHJpdmVyLT5tb3ZlKGJvLCBl
dmljdCwgY3R4LCBtZW0pOworCX0gZWxzZSBpZiAoYmRldi0+ZnVuY3MtPm1vdmUpIHsKKwkJcmV0
ID0gYmRldi0+ZnVuY3MtPm1vdmUoYm8sIGV2aWN0LCBjdHgsIG1lbSk7CiAJfSBlbHNlIHsKIAkJ
cmV0ID0gdHRtX2JvX21vdmVfbWVtY3B5KGJvLCBjdHgsIG1lbSk7CiAJfQogCiAJaWYgKHJldCkg
ewotCQlpZiAoYmRldi0+ZHJpdmVyLT5tb3ZlX25vdGlmeSkgeworCQlpZiAoYmRldi0+ZnVuY3Mt
Pm1vdmVfbm90aWZ5KSB7CiAJCQlzd2FwKCptZW0sIGJvLT5tZW0pOwotCQkJYmRldi0+ZHJpdmVy
LT5tb3ZlX25vdGlmeShibywgZmFsc2UsIG1lbSk7CisJCQliZGV2LT5mdW5jcy0+bW92ZV9ub3Rp
ZnkoYm8sIGZhbHNlLCBtZW0pOwogCQkJc3dhcCgqbWVtLCBiby0+bWVtKTsKIAkJfQogCkBAIC0z
MDksOCArMjY4LDggQEAgc3RhdGljIGludCB0dG1fYm9faGFuZGxlX21vdmVfbWVtKHN0cnVjdCB0
dG1fYnVmZmVyX29iamVjdCAqYm8sCiAKIHN0YXRpYyB2b2lkIHR0bV9ib19jbGVhbnVwX21lbXR5
cGVfdXNlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8pCiB7Ci0JaWYgKGJvLT5iZGV2LT5k
cml2ZXItPm1vdmVfbm90aWZ5KQotCQliby0+YmRldi0+ZHJpdmVyLT5tb3ZlX25vdGlmeShibywg
ZmFsc2UsIE5VTEwpOworCWlmIChiby0+YmRldi0+ZnVuY3MtPm1vdmVfbm90aWZ5KQorCQliby0+
YmRldi0+ZnVuY3MtPm1vdmVfbm90aWZ5KGJvLCBmYWxzZSwgTlVMTCk7CiAKIAl0dG1fYm9fdHRf
ZGVzdHJveShibyk7CiAJdHRtX3Jlc291cmNlX2ZyZWUoYm8sICZiby0+bWVtKTsKQEAgLTMzNSw5
ICsyOTQsOSBAQCBzdGF0aWMgaW50IHR0bV9ib19pbmRpdmlkdWFsaXplX3Jlc3Yoc3RydWN0IHR0
bV9idWZmZXJfb2JqZWN0ICpibykKIAkJICogcmVmZXJlbmNlIGl0IGFueSBtb3JlLiBUaGUgb25s
eSB0cmlja3kgY2FzZSBpcyB0aGUgdHJ5bG9jayBvbgogCQkgKiB0aGUgcmVzdiBvYmplY3Qgd2hp
bGUgaG9sZGluZyB0aGUgbHJ1X2xvY2suCiAJCSAqLwotCQlzcGluX2xvY2soJnR0bV9ib19nbG9i
LmxydV9sb2NrKTsKKwkJc3Bpbl9sb2NrKCZ0dG1fZ2xvYi5scnVfbG9jayk7CiAJCWJvLT5iYXNl
LnJlc3YgPSAmYm8tPmJhc2UuX3Jlc3Y7Ci0JCXNwaW5fdW5sb2NrKCZ0dG1fYm9fZ2xvYi5scnVf
bG9jayk7CisJCXNwaW5fdW5sb2NrKCZ0dG1fZ2xvYi5scnVfbG9jayk7CiAJfQogCiAJcmV0dXJu
IHI7CkBAIC0zOTUsNyArMzU0LDcgQEAgc3RhdGljIGludCB0dG1fYm9fY2xlYW51cF9yZWZzKHN0
cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAKIAkJaWYgKHVubG9ja19yZXN2KQogCQkJZG1h
X3Jlc3ZfdW5sb2NrKGJvLT5iYXNlLnJlc3YpOwotCQlzcGluX3VubG9jaygmdHRtX2JvX2dsb2Iu
bHJ1X2xvY2spOworCQlzcGluX3VubG9jaygmdHRtX2dsb2IubHJ1X2xvY2spOwogCiAJCWxyZXQg
PSBkbWFfcmVzdl93YWl0X3RpbWVvdXRfcmN1KHJlc3YsIHRydWUsIGludGVycnVwdGlibGUsCiAJ
CQkJCQkgMzAgKiBIWik7CkBAIC00MDUsNyArMzY0LDcgQEAgc3RhdGljIGludCB0dG1fYm9fY2xl
YW51cF9yZWZzKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJCWVsc2UgaWYgKGxyZXQg
PT0gMCkKIAkJCXJldHVybiAtRUJVU1k7CiAKLQkJc3Bpbl9sb2NrKCZ0dG1fYm9fZ2xvYi5scnVf
bG9jayk7CisJCXNwaW5fbG9jaygmdHRtX2dsb2IubHJ1X2xvY2spOwogCQlpZiAodW5sb2NrX3Jl
c3YgJiYgIWRtYV9yZXN2X3RyeWxvY2soYm8tPmJhc2UucmVzdikpIHsKIAkJCS8qCiAJCQkgKiBX
ZSByYWNlZCwgYW5kIGxvc3QsIHNvbWVvbmUgZWxzZSBob2xkcyB0aGUgcmVzZXJ2YXRpb24gbm93
LApAQCAtNDE1LDcgKzM3NCw3IEBAIHN0YXRpYyBpbnQgdHRtX2JvX2NsZWFudXBfcmVmcyhzdHJ1
Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQkJICogZGVsYXllZCBkZXN0cnVjdGlvbiB3b3Vs
ZCBzdWNjZWVkLCBzbyBqdXN0IHJldHVybiBzdWNjZXNzCiAJCQkgKiBoZXJlLgogCQkJICovCi0J
CQlzcGluX3VubG9jaygmdHRtX2JvX2dsb2IubHJ1X2xvY2spOworCQkJc3Bpbl91bmxvY2soJnR0
bV9nbG9iLmxydV9sb2NrKTsKIAkJCXJldHVybiAwOwogCQl9CiAJCXJldCA9IDA7CkBAIC00MjQs
MTMgKzM4MywxMyBAQCBzdGF0aWMgaW50IHR0bV9ib19jbGVhbnVwX3JlZnMoc3RydWN0IHR0bV9i
dWZmZXJfb2JqZWN0ICpibywKIAlpZiAocmV0IHx8IHVubGlrZWx5KGxpc3RfZW1wdHkoJmJvLT5k
ZGVzdHJveSkpKSB7CiAJCWlmICh1bmxvY2tfcmVzdikKIAkJCWRtYV9yZXN2X3VubG9jayhiby0+
YmFzZS5yZXN2KTsKLQkJc3Bpbl91bmxvY2soJnR0bV9ib19nbG9iLmxydV9sb2NrKTsKKwkJc3Bp
bl91bmxvY2soJnR0bV9nbG9iLmxydV9sb2NrKTsKIAkJcmV0dXJuIHJldDsKIAl9CiAKIAl0dG1f
Ym9fZGVsX2Zyb21fbHJ1KGJvKTsKIAlsaXN0X2RlbF9pbml0KCZiby0+ZGRlc3Ryb3kpOwotCXNw
aW5fdW5sb2NrKCZ0dG1fYm9fZ2xvYi5scnVfbG9jayk7CisJc3Bpbl91bmxvY2soJnR0bV9nbG9i
LmxydV9sb2NrKTsKIAl0dG1fYm9fY2xlYW51cF9tZW10eXBlX3VzZShibyk7CiAKIAlpZiAodW5s
b2NrX3Jlc3YpCkBAIC00NDUsOSArNDA0LDkgQEAgc3RhdGljIGludCB0dG1fYm9fY2xlYW51cF9y
ZWZzKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAgKiBUcmF2ZXJzZSB0aGUgZGVsYXll
ZCBsaXN0LCBhbmQgY2FsbCB0dG1fYm9fY2xlYW51cF9yZWZzIG9uIGFsbAogICogZW5jb3VudGVy
ZWQgYnVmZmVycy4KICAqLwotc3RhdGljIGJvb2wgdHRtX2JvX2RlbGF5ZWRfZGVsZXRlKHN0cnVj
dCB0dG1fYm9fZGV2aWNlICpiZGV2LCBib29sIHJlbW92ZV9hbGwpCitib29sIHR0bV9ib19kZWxh
eWVkX2RlbGV0ZShzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwgYm9vbCByZW1vdmVfYWxsKQogewot
CXN0cnVjdCB0dG1fYm9fZ2xvYmFsICpnbG9iID0gJnR0bV9ib19nbG9iOworCXN0cnVjdCB0dG1f
Z2xvYmFsICpnbG9iID0gJnR0bV9nbG9iOwogCXN0cnVjdCBsaXN0X2hlYWQgcmVtb3ZlZDsKIAli
b29sIGVtcHR5OwogCkBAIC00ODYsMjEgKzQ0NSwxMSBAQCBzdGF0aWMgYm9vbCB0dG1fYm9fZGVs
YXllZF9kZWxldGUoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIGJvb2wgcmVtb3ZlX2FsbCkK
IAlyZXR1cm4gZW1wdHk7CiB9CiAKLXN0YXRpYyB2b2lkIHR0bV9ib19kZWxheWVkX3dvcmtxdWV1
ZShzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCi17Ci0Jc3RydWN0IHR0bV9ib19kZXZpY2UgKmJk
ZXYgPQotCSAgICBjb250YWluZXJfb2Yod29yaywgc3RydWN0IHR0bV9ib19kZXZpY2UsIHdxLndv
cmspOwotCi0JaWYgKCF0dG1fYm9fZGVsYXllZF9kZWxldGUoYmRldiwgZmFsc2UpKQotCQlzY2hl
ZHVsZV9kZWxheWVkX3dvcmsoJmJkZXYtPndxLAotCQkJCSAgICAgICgoSFogLyAxMDApIDwgMSkg
PyAxIDogSFogLyAxMDApOwotfQotCiBzdGF0aWMgdm9pZCB0dG1fYm9fcmVsZWFzZShzdHJ1Y3Qg
a3JlZiAqa3JlZikKIHsKIAlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvID0KIAkgICAgY29u
dGFpbmVyX29mKGtyZWYsIHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCwga3JlZik7Ci0Jc3RydWN0
IHR0bV9ib19kZXZpY2UgKmJkZXYgPSBiby0+YmRldjsKKwlzdHJ1Y3QgdHRtX2RldmljZSAqYmRl
diA9IGJvLT5iZGV2OwogCXNpemVfdCBhY2Nfc2l6ZSA9IGJvLT5hY2Nfc2l6ZTsKIAlpbnQgcmV0
OwogCkBAIC01MTQsOCArNDYzLDggQEAgc3RhdGljIHZvaWQgdHRtX2JvX3JlbGVhc2Uoc3RydWN0
IGtyZWYgKmtyZWYpCiAJCQkJCQkgIDMwICogSFopOwogCQl9CiAKLQkJaWYgKGJvLT5iZGV2LT5k
cml2ZXItPnJlbGVhc2Vfbm90aWZ5KQotCQkJYm8tPmJkZXYtPmRyaXZlci0+cmVsZWFzZV9ub3Rp
ZnkoYm8pOworCQlpZiAoYm8tPmJkZXYtPmZ1bmNzLT5yZWxlYXNlX25vdGlmeSkKKwkJCWJvLT5i
ZGV2LT5mdW5jcy0+cmVsZWFzZV9ub3RpZnkoYm8pOwogCiAJCWRybV92bWFfb2Zmc2V0X3JlbW92
ZShiZGV2LT52bWFfbWFuYWdlciwgJmJvLT5iYXNlLnZtYV9ub2RlKTsKIAkJdHRtX21lbV9pb19m
cmVlKGJkZXYsICZiby0+bWVtKTsKQEAgLTUyNyw3ICs0NzYsNyBAQCBzdGF0aWMgdm9pZCB0dG1f
Ym9fcmVsZWFzZShzdHJ1Y3Qga3JlZiAqa3JlZikKIAkJdHRtX2JvX2ZsdXNoX2FsbF9mZW5jZXMo
Ym8pOwogCQliby0+ZGVsZXRlZCA9IHRydWU7CiAKLQkJc3Bpbl9sb2NrKCZ0dG1fYm9fZ2xvYi5s
cnVfbG9jayk7CisJCXNwaW5fbG9jaygmdHRtX2dsb2IubHJ1X2xvY2spOwogCiAJCS8qCiAJCSAq
IE1ha2UgcGlubmVkIGJvcyBpbW1lZGlhdGVseSBhdmFpbGFibGUgdG8KQEAgLTU0MiwyMiArNDkx
LDIyIEBAIHN0YXRpYyB2b2lkIHR0bV9ib19yZWxlYXNlKHN0cnVjdCBrcmVmICprcmVmKQogCiAJ
CWtyZWZfaW5pdCgmYm8tPmtyZWYpOwogCQlsaXN0X2FkZF90YWlsKCZiby0+ZGRlc3Ryb3ksICZi
ZGV2LT5kZGVzdHJveSk7Ci0JCXNwaW5fdW5sb2NrKCZ0dG1fYm9fZ2xvYi5scnVfbG9jayk7CisJ
CXNwaW5fdW5sb2NrKCZ0dG1fZ2xvYi5scnVfbG9jayk7CiAKIAkJc2NoZWR1bGVfZGVsYXllZF93
b3JrKCZiZGV2LT53cSwKIAkJCQkgICAgICAoKEhaIC8gMTAwKSA8IDEpID8gMSA6IEhaIC8gMTAw
KTsKIAkJcmV0dXJuOwogCX0KIAotCXNwaW5fbG9jaygmdHRtX2JvX2dsb2IubHJ1X2xvY2spOwor
CXNwaW5fbG9jaygmdHRtX2dsb2IubHJ1X2xvY2spOwogCXR0bV9ib19kZWxfZnJvbV9scnUoYm8p
OwogCWxpc3RfZGVsKCZiby0+ZGRlc3Ryb3kpOwotCXNwaW5fdW5sb2NrKCZ0dG1fYm9fZ2xvYi5s
cnVfbG9jayk7CisJc3Bpbl91bmxvY2soJnR0bV9nbG9iLmxydV9sb2NrKTsKIAogCXR0bV9ib19j
bGVhbnVwX21lbXR5cGVfdXNlKGJvKTsKIAlkbWFfcmVzdl91bmxvY2soYm8tPmJhc2UucmVzdik7
CiAKLQlhdG9taWNfZGVjKCZ0dG1fYm9fZ2xvYi5ib19jb3VudCk7CisJYXRvbWljX2RlYygmdHRt
X2dsb2IuYm9fY291bnQpOwogCWRtYV9mZW5jZV9wdXQoYm8tPm1vdmluZyk7CiAJaWYgKCF0dG1f
Ym9fdXNlc19lbWJlZGRlZF9nZW1fb2JqZWN0KGJvKSkKIAkJZG1hX3Jlc3ZfZmluaSgmYm8tPmJh
c2UuX3Jlc3YpOwpAQCAtNTcxLDEzICs1MjAsMTMgQEAgdm9pZCB0dG1fYm9fcHV0KHN0cnVjdCB0
dG1fYnVmZmVyX29iamVjdCAqYm8pCiB9CiBFWFBPUlRfU1lNQk9MKHR0bV9ib19wdXQpOwogCi1p
bnQgdHRtX2JvX2xvY2tfZGVsYXllZF93b3JrcXVldWUoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJk
ZXYpCitpbnQgdHRtX2JvX2xvY2tfZGVsYXllZF93b3JrcXVldWUoc3RydWN0IHR0bV9kZXZpY2Ug
KmJkZXYpCiB7CiAJcmV0dXJuIGNhbmNlbF9kZWxheWVkX3dvcmtfc3luYygmYmRldi0+d3EpOwog
fQogRVhQT1JUX1NZTUJPTCh0dG1fYm9fbG9ja19kZWxheWVkX3dvcmtxdWV1ZSk7CiAKLXZvaWQg
dHRtX2JvX3VubG9ja19kZWxheWVkX3dvcmtxdWV1ZShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRl
diwgaW50IHJlc2NoZWQpCit2b2lkIHR0bV9ib191bmxvY2tfZGVsYXllZF93b3JrcXVldWUoc3Ry
dWN0IHR0bV9kZXZpY2UgKmJkZXYsIGludCByZXNjaGVkKQogewogCWlmIChyZXNjaGVkKQogCQlz
Y2hlZHVsZV9kZWxheWVkX3dvcmsoJmJkZXYtPndxLApAQCAtNTg4LDcgKzUzNyw3IEBAIEVYUE9S
VF9TWU1CT0wodHRtX2JvX3VubG9ja19kZWxheWVkX3dvcmtxdWV1ZSk7CiBzdGF0aWMgaW50IHR0
bV9ib19ldmljdChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQkJc3RydWN0IHR0bV9v
cGVyYXRpb25fY3R4ICpjdHgpCiB7Ci0Jc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYgPSBiby0+
YmRldjsKKwlzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiA9IGJvLT5iZGV2OwogCXN0cnVjdCB0dG1f
cmVzb3VyY2UgZXZpY3RfbWVtOwogCXN0cnVjdCB0dG1fcGxhY2VtZW50IHBsYWNlbWVudDsKIAlp
bnQgcmV0ID0gMDsKQEAgLTU5Nyw3ICs1NDYsNyBAQCBzdGF0aWMgaW50IHR0bV9ib19ldmljdChz
dHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCiAJcGxhY2VtZW50Lm51bV9wbGFjZW1lbnQg
PSAwOwogCXBsYWNlbWVudC5udW1fYnVzeV9wbGFjZW1lbnQgPSAwOwotCWJkZXYtPmRyaXZlci0+
ZXZpY3RfZmxhZ3MoYm8sICZwbGFjZW1lbnQpOworCWJkZXYtPmZ1bmNzLT5ldmljdF9mbGFncyhi
bywgJnBsYWNlbWVudCk7CiAKIAlpZiAoIXBsYWNlbWVudC5udW1fcGxhY2VtZW50ICYmICFwbGFj
ZW1lbnQubnVtX2J1c3lfcGxhY2VtZW50KSB7CiAJCXR0bV9ib193YWl0KGJvLCBmYWxzZSwgZmFs
c2UpOwpAQCAtNzEyLDcgKzY2MSw3IEBAIHN0YXRpYyBpbnQgdHRtX21lbV9ldmljdF93YWl0X2J1
c3koc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpidXN5X2JvLAogCXJldHVybiByID09IC1FREVB
RExLID8gLUVCVVNZIDogcjsKIH0KIAotaW50IHR0bV9tZW1fZXZpY3RfZmlyc3Qoc3RydWN0IHR0
bV9ib19kZXZpY2UgKmJkZXYsCitpbnQgdHRtX21lbV9ldmljdF9maXJzdChzdHJ1Y3QgdHRtX2Rl
dmljZSAqYmRldiwKIAkJCXN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuLAogCQkJY29u
c3Qgc3RydWN0IHR0bV9wbGFjZSAqcGxhY2UsCiAJCQlzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHgg
KmN0eCwKQEAgLTcyMyw3ICs2NzIsNyBAQCBpbnQgdHRtX21lbV9ldmljdF9maXJzdChzdHJ1Y3Qg
dHRtX2JvX2RldmljZSAqYmRldiwKIAl1bnNpZ25lZCBpOwogCWludCByZXQ7CiAKLQlzcGluX2xv
Y2soJnR0bV9ib19nbG9iLmxydV9sb2NrKTsKKwlzcGluX2xvY2soJnR0bV9nbG9iLmxydV9sb2Nr
KTsKIAlmb3IgKGkgPSAwOyBpIDwgVFRNX01BWF9CT19QUklPUklUWTsgKytpKSB7CiAJCWxpc3Rf
Zm9yX2VhY2hfZW50cnkoYm8sICZtYW4tPmxydVtpXSwgbHJ1KSB7CiAJCQlib29sIGJ1c3k7CkBA
IC03MzYsNyArNjg1LDcgQEAgaW50IHR0bV9tZW1fZXZpY3RfZmlyc3Qoc3RydWN0IHR0bV9ib19k
ZXZpY2UgKmJkZXYsCiAJCQkJY29udGludWU7CiAJCQl9CiAKLQkJCWlmIChwbGFjZSAmJiAhYmRl
di0+ZHJpdmVyLT5ldmljdGlvbl92YWx1YWJsZShibywKKwkJCWlmIChwbGFjZSAmJiAhYmRldi0+
ZnVuY3MtPmV2aWN0aW9uX3ZhbHVhYmxlKGJvLAogCQkJCQkJCQkgICAgICBwbGFjZSkpIHsKIAkJ
CQlpZiAobG9ja2VkKQogCQkJCQlkbWFfcmVzdl91bmxvY2soYm8tPmJhc2UucmVzdik7CkBAIC03
NjAsNyArNzA5LDcgQEAgaW50IHR0bV9tZW1fZXZpY3RfZmlyc3Qoc3RydWN0IHR0bV9ib19kZXZp
Y2UgKmJkZXYsCiAJaWYgKCFibykgewogCQlpZiAoYnVzeV9ibyAmJiAhdHRtX2JvX2dldF91bmxl
c3NfemVybyhidXN5X2JvKSkKIAkJCWJ1c3lfYm8gPSBOVUxMOwotCQlzcGluX3VubG9jaygmdHRt
X2JvX2dsb2IubHJ1X2xvY2spOworCQlzcGluX3VubG9jaygmdHRtX2dsb2IubHJ1X2xvY2spOwog
CQlyZXQgPSB0dG1fbWVtX2V2aWN0X3dhaXRfYnVzeShidXN5X2JvLCBjdHgsIHRpY2tldCk7CiAJ
CWlmIChidXN5X2JvKQogCQkJdHRtX2JvX3B1dChidXN5X2JvKTsKQEAgLTc3NCw3ICs3MjMsNyBA
QCBpbnQgdHRtX21lbV9ldmljdF9maXJzdChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKIAkJ
cmV0dXJuIHJldDsKIAl9CiAKLQlzcGluX3VubG9jaygmdHRtX2JvX2dsb2IubHJ1X2xvY2spOwor
CXNwaW5fdW5sb2NrKCZ0dG1fZ2xvYi5scnVfbG9jayk7CiAKIAlyZXQgPSB0dG1fYm9fZXZpY3Qo
Ym8sIGN0eCk7CiAJaWYgKGxvY2tlZCkKQEAgLTgyOSw3ICs3NzgsNyBAQCBzdGF0aWMgaW50IHR0
bV9ib19tZW1fZm9yY2Vfc3BhY2Uoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAkJCQkg
IHN0cnVjdCB0dG1fcmVzb3VyY2UgKm1lbSwKIAkJCQkgIHN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0
eCAqY3R4KQogewotCXN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2ID0gYm8tPmJkZXY7CisJc3Ry
dWN0IHR0bV9kZXZpY2UgKmJkZXYgPSBiby0+YmRldjsKIAlzdHJ1Y3QgdHRtX3Jlc291cmNlX21h
bmFnZXIgKm1hbiA9IHR0bV9tYW5hZ2VyX3R5cGUoYmRldiwgbWVtLT5tZW1fdHlwZSk7CiAJc3Ry
dWN0IHd3X2FjcXVpcmVfY3R4ICp0aWNrZXQ7CiAJaW50IHJldDsKQEAgLTg2Niw3ICs4MTUsNyBA
QCBzdGF0aWMgaW50IHR0bV9ib19tZW1fcGxhY2VtZW50KHN0cnVjdCB0dG1fYnVmZmVyX29iamVj
dCAqYm8sCiAJCQkJc3RydWN0IHR0bV9yZXNvdXJjZSAqbWVtLAogCQkJCXN0cnVjdCB0dG1fb3Bl
cmF0aW9uX2N0eCAqY3R4KQogewotCXN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2ID0gYm8tPmJk
ZXY7CisJc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYgPSBiby0+YmRldjsKIAlzdHJ1Y3QgdHRtX3Jl
c291cmNlX21hbmFnZXIgKm1hbjsKIAogCW1hbiA9IHR0bV9tYW5hZ2VyX3R5cGUoYmRldiwgcGxh
Y2UtPm1lbV90eXBlKTsKQEAgLTg3NiwxMCArODI1LDEwIEBAIHN0YXRpYyBpbnQgdHRtX2JvX21l
bV9wbGFjZW1lbnQoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAltZW0tPm1lbV90eXBl
ID0gcGxhY2UtPm1lbV90eXBlOwogCW1lbS0+cGxhY2VtZW50ID0gcGxhY2UtPmZsYWdzOwogCi0J
c3Bpbl9sb2NrKCZ0dG1fYm9fZ2xvYi5scnVfbG9jayk7CisJc3Bpbl9sb2NrKCZ0dG1fZ2xvYi5s
cnVfbG9jayk7CiAJdHRtX2JvX2RlbF9mcm9tX2xydShibyk7CiAJdHRtX2JvX2FkZF9tZW1fdG9f
bHJ1KGJvLCBtZW0pOwotCXNwaW5fdW5sb2NrKCZ0dG1fYm9fZ2xvYi5scnVfbG9jayk7CisJc3Bp
bl91bmxvY2soJnR0bV9nbG9iLmxydV9sb2NrKTsKIAogCXJldHVybiAwOwogfQpAQCAtODk3LDcg
Kzg0Niw3IEBAIGludCB0dG1fYm9fbWVtX3NwYWNlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAq
Ym8sCiAJCQlzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0sCiAJCQlzdHJ1Y3QgdHRtX29wZXJhdGlv
bl9jdHggKmN0eCkKIHsKLQlzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiA9IGJvLT5iZGV2Owor
CXN0cnVjdCB0dG1fZGV2aWNlICpiZGV2ID0gYm8tPmJkZXY7CiAJYm9vbCB0eXBlX2ZvdW5kID0g
ZmFsc2U7CiAJaW50IGksIHJldDsKIApAQCAtMTA3NCw3ICsxMDIzLDcgQEAgaW50IHR0bV9ib192
YWxpZGF0ZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogfQogRVhQT1JUX1NZTUJPTCh0
dG1fYm9fdmFsaWRhdGUpOwogCi1pbnQgdHRtX2JvX2luaXRfcmVzZXJ2ZWQoc3RydWN0IHR0bV9i
b19kZXZpY2UgKmJkZXYsCitpbnQgdHRtX2JvX2luaXRfcmVzZXJ2ZWQoc3RydWN0IHR0bV9kZXZp
Y2UgKmJkZXYsCiAJCQkgc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAkJCSB1bnNpZ25l
ZCBsb25nIHNpemUsCiAJCQkgZW51bSB0dG1fYm9fdHlwZSB0eXBlLApAQCAtMTE0Niw3ICsxMDk1
LDcgQEAgaW50IHR0bV9ib19pbml0X3Jlc2VydmVkKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2
LAogCQlkbWFfcmVzdl9pbml0KCZiby0+YmFzZS5fcmVzdik7CiAJCWRybV92bWFfbm9kZV9yZXNl
dCgmYm8tPmJhc2Uudm1hX25vZGUpOwogCX0KLQlhdG9taWNfaW5jKCZ0dG1fYm9fZ2xvYi5ib19j
b3VudCk7CisJYXRvbWljX2luYygmdHRtX2dsb2IuYm9fY291bnQpOwogCiAJLyoKIAkgKiBGb3Ig
dHRtX2JvX3R5cGVfZGV2aWNlIGJ1ZmZlcnMsIGFsbG9jYXRlCkBAIC0xMTgyLDcgKzExMzEsNyBA
QCBpbnQgdHRtX2JvX2luaXRfcmVzZXJ2ZWQoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCiB9
CiBFWFBPUlRfU1lNQk9MKHR0bV9ib19pbml0X3Jlc2VydmVkKTsKIAotaW50IHR0bV9ib19pbml0
KHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAoraW50IHR0bV9ib19pbml0KHN0cnVjdCB0dG1f
ZGV2aWNlICpiZGV2LAogCQlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQl1bnNpZ25l
ZCBsb25nIHNpemUsCiAJCWVudW0gdHRtX2JvX3R5cGUgdHlwZSwKQEAgLTEyMTAsNyArMTE1OSw3
IEBAIGludCB0dG1fYm9faW5pdChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKIH0KIEVYUE9S
VF9TWU1CT0wodHRtX2JvX2luaXQpOwogCi1zaXplX3QgdHRtX2JvX2RtYV9hY2Nfc2l6ZShzdHJ1
Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKK3NpemVfdCB0dG1fYm9fZG1hX2FjY19zaXplKHN0cnVj
dCB0dG1fZGV2aWNlICpiZGV2LAogCQkJICAgdW5zaWduZWQgbG9uZyBib19zaXplLAogCQkJICAg
dW5zaWduZWQgc3RydWN0X3NpemUpCiB7CkBAIC0xMjI0LDcgKzExNzMsNyBAQCBzaXplX3QgdHRt
X2JvX2RtYV9hY2Nfc2l6ZShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKIH0KIEVYUE9SVF9T
WU1CT0wodHRtX2JvX2RtYV9hY2Nfc2l6ZSk7CiAKLWludCB0dG1fYm9fZXZpY3RfbW0oc3RydWN0
IHR0bV9ib19kZXZpY2UgKmJkZXYsIHVuc2lnbmVkIG1lbV90eXBlKQoraW50IHR0bV9ib19ldmlj
dF9tbShzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwgdW5zaWduZWQgbWVtX3R5cGUpCiB7CiAJc3Ry
dWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYW4gPSB0dG1fbWFuYWdlcl90eXBlKGJkZXYsIG1l
bV90eXBlKTsKIApAQCAtMTI0MiwxNTQgKzExOTEsMTMgQEAgaW50IHR0bV9ib19ldmljdF9tbShz
dHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwgdW5zaWduZWQgbWVtX3R5cGUpCiB9CiBFWFBPUlRf
U1lNQk9MKHR0bV9ib19ldmljdF9tbSk7CiAKLXN0YXRpYyB2b2lkIHR0bV9ib19nbG9iYWxfa29i
al9yZWxlYXNlKHN0cnVjdCBrb2JqZWN0ICprb2JqKQotewotCXN0cnVjdCB0dG1fYm9fZ2xvYmFs
ICpnbG9iID0KLQkJY29udGFpbmVyX29mKGtvYmosIHN0cnVjdCB0dG1fYm9fZ2xvYmFsLCBrb2Jq
KTsKLQotCV9fZnJlZV9wYWdlKGdsb2ItPmR1bW15X3JlYWRfcGFnZSk7Ci19Ci0KLXN0YXRpYyB2
b2lkIHR0bV9ib19nbG9iYWxfcmVsZWFzZSh2b2lkKQotewotCXN0cnVjdCB0dG1fYm9fZ2xvYmFs
ICpnbG9iID0gJnR0bV9ib19nbG9iOwotCi0JbXV0ZXhfbG9jaygmdHRtX2dsb2JhbF9tdXRleCk7
Ci0JaWYgKC0tdHRtX2JvX2dsb2JfdXNlX2NvdW50ID4gMCkKLQkJZ290byBvdXQ7Ci0KLQlrb2Jq
ZWN0X2RlbCgmZ2xvYi0+a29iaik7Ci0Ja29iamVjdF9wdXQoJmdsb2ItPmtvYmopOwotCXR0bV9t
ZW1fZ2xvYmFsX3JlbGVhc2UoJnR0bV9tZW1fZ2xvYik7Ci0JbWVtc2V0KGdsb2IsIDAsIHNpemVv
ZigqZ2xvYikpOwotb3V0OgotCW11dGV4X3VubG9jaygmdHRtX2dsb2JhbF9tdXRleCk7Ci19Ci0K
LXN0YXRpYyBpbnQgdHRtX2JvX2dsb2JhbF9pbml0KHZvaWQpCi17Ci0Jc3RydWN0IHR0bV9ib19n
bG9iYWwgKmdsb2IgPSAmdHRtX2JvX2dsb2I7Ci0JaW50IHJldCA9IDA7Ci0JdW5zaWduZWQgaTsK
LQotCW11dGV4X2xvY2soJnR0bV9nbG9iYWxfbXV0ZXgpOwotCWlmICgrK3R0bV9ib19nbG9iX3Vz
ZV9jb3VudCA+IDEpCi0JCWdvdG8gb3V0OwotCi0JcmV0ID0gdHRtX21lbV9nbG9iYWxfaW5pdCgm
dHRtX21lbV9nbG9iKTsKLQlpZiAocmV0KQotCQlnb3RvIG91dDsKLQotCXNwaW5fbG9ja19pbml0
KCZnbG9iLT5scnVfbG9jayk7Ci0JZ2xvYi0+ZHVtbXlfcmVhZF9wYWdlID0gYWxsb2NfcGFnZShf
X0dGUF9aRVJPIHwgR0ZQX0RNQTMyKTsKLQotCWlmICh1bmxpa2VseShnbG9iLT5kdW1teV9yZWFk
X3BhZ2UgPT0gTlVMTCkpIHsKLQkJcmV0ID0gLUVOT01FTTsKLQkJZ290byBvdXQ7Ci0JfQotCi0J
Zm9yIChpID0gMDsgaSA8IFRUTV9NQVhfQk9fUFJJT1JJVFk7ICsraSkKLQkJSU5JVF9MSVNUX0hF
QUQoJmdsb2ItPnN3YXBfbHJ1W2ldKTsKLQlJTklUX0xJU1RfSEVBRCgmZ2xvYi0+ZGV2aWNlX2xp
c3QpOwotCWF0b21pY19zZXQoJmdsb2ItPmJvX2NvdW50LCAwKTsKLQotCXJldCA9IGtvYmplY3Rf
aW5pdF9hbmRfYWRkKAotCQkmZ2xvYi0+a29iaiwgJnR0bV9ib19nbG9iX2tvYmpfdHlwZSwgdHRt
X2dldF9rb2JqKCksICJidWZmZXJfb2JqZWN0cyIpOwotCWlmICh1bmxpa2VseShyZXQgIT0gMCkp
Ci0JCWtvYmplY3RfcHV0KCZnbG9iLT5rb2JqKTsKLW91dDoKLQltdXRleF91bmxvY2soJnR0bV9n
bG9iYWxfbXV0ZXgpOwotCXJldHVybiByZXQ7Ci19Ci0KLWludCB0dG1fYm9fZGV2aWNlX3JlbGVh
c2Uoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYpCi17Ci0Jc3RydWN0IHR0bV9ib19nbG9iYWwg
Kmdsb2IgPSAmdHRtX2JvX2dsb2I7Ci0JaW50IHJldCA9IDA7Ci0JdW5zaWduZWQgaTsKLQlzdHJ1
Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbjsKLQotCW1hbiA9IHR0bV9tYW5hZ2VyX3R5cGUo
YmRldiwgVFRNX1BMX1NZU1RFTSk7Ci0JdHRtX3Jlc291cmNlX21hbmFnZXJfc2V0X3VzZWQobWFu
LCBmYWxzZSk7Ci0JdHRtX3NldF9kcml2ZXJfbWFuYWdlcihiZGV2LCBUVE1fUExfU1lTVEVNLCBO
VUxMKTsKLQotCW11dGV4X2xvY2soJnR0bV9nbG9iYWxfbXV0ZXgpOwotCWxpc3RfZGVsKCZiZGV2
LT5kZXZpY2VfbGlzdCk7Ci0JbXV0ZXhfdW5sb2NrKCZ0dG1fZ2xvYmFsX211dGV4KTsKLQotCWNh
bmNlbF9kZWxheWVkX3dvcmtfc3luYygmYmRldi0+d3EpOwotCi0JaWYgKHR0bV9ib19kZWxheWVk
X2RlbGV0ZShiZGV2LCB0cnVlKSkKLQkJcHJfZGVidWcoIkRlbGF5ZWQgZGVzdHJveSBsaXN0IHdh
cyBjbGVhblxuIik7Ci0KLQlzcGluX2xvY2soJmdsb2ItPmxydV9sb2NrKTsKLQlmb3IgKGkgPSAw
OyBpIDwgVFRNX01BWF9CT19QUklPUklUWTsgKytpKQotCQlpZiAobGlzdF9lbXB0eSgmbWFuLT5s
cnVbMF0pKQotCQkJcHJfZGVidWcoIlN3YXAgbGlzdCAlZCB3YXMgY2xlYW5cbiIsIGkpOwotCXNw
aW5fdW5sb2NrKCZnbG9iLT5scnVfbG9jayk7Ci0KLQlpZiAoIXJldCkKLQkJdHRtX2JvX2dsb2Jh
bF9yZWxlYXNlKCk7Ci0KLQlyZXR1cm4gcmV0OwotfQotRVhQT1JUX1NZTUJPTCh0dG1fYm9fZGV2
aWNlX3JlbGVhc2UpOwotCi1zdGF0aWMgdm9pZCB0dG1fYm9faW5pdF9zeXNtYW4oc3RydWN0IHR0
bV9ib19kZXZpY2UgKmJkZXYpCi17Ci0Jc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYW4g
PSAmYmRldi0+c3lzbWFuOwotCi0JLyoKLQkgKiBJbml0aWFsaXplIHRoZSBzeXN0ZW0gbWVtb3J5
IGJ1ZmZlciB0eXBlLgotCSAqIE90aGVyIHR5cGVzIG5lZWQgdG8gYmUgZHJpdmVyIC8gSU9DVEwg
aW5pdGlhbGl6ZWQuCi0JICovCi0JbWFuLT51c2VfdHQgPSB0cnVlOwotCi0JdHRtX3Jlc291cmNl
X21hbmFnZXJfaW5pdChtYW4sIDApOwotCXR0bV9zZXRfZHJpdmVyX21hbmFnZXIoYmRldiwgVFRN
X1BMX1NZU1RFTSwgbWFuKTsKLQl0dG1fcmVzb3VyY2VfbWFuYWdlcl9zZXRfdXNlZChtYW4sIHRy
dWUpOwotfQotCi1pbnQgdHRtX2JvX2RldmljZV9pbml0KHN0cnVjdCB0dG1fYm9fZGV2aWNlICpi
ZGV2LAotCQkgICAgICAgc3RydWN0IHR0bV9ib19kcml2ZXIgKmRyaXZlciwKLQkJICAgICAgIHN0
cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5nLAotCQkgICAgICAgc3RydWN0IGRybV92bWFfb2Zm
c2V0X21hbmFnZXIgKnZtYV9tYW5hZ2VyLAotCQkgICAgICAgYm9vbCBuZWVkX2RtYTMyKQotewot
CXN0cnVjdCB0dG1fYm9fZ2xvYmFsICpnbG9iID0gJnR0bV9ib19nbG9iOwotCWludCByZXQ7Ci0K
LQlpZiAoV0FSTl9PTih2bWFfbWFuYWdlciA9PSBOVUxMKSkKLQkJcmV0dXJuIC1FSU5WQUw7Ci0K
LQlyZXQgPSB0dG1fYm9fZ2xvYmFsX2luaXQoKTsKLQlpZiAocmV0KQotCQlyZXR1cm4gcmV0Owot
Ci0JYmRldi0+ZHJpdmVyID0gZHJpdmVyOwotCi0JdHRtX2JvX2luaXRfc3lzbWFuKGJkZXYpOwot
Ci0JYmRldi0+dm1hX21hbmFnZXIgPSB2bWFfbWFuYWdlcjsKLQlJTklUX0RFTEFZRURfV09SSygm
YmRldi0+d3EsIHR0bV9ib19kZWxheWVkX3dvcmtxdWV1ZSk7Ci0JSU5JVF9MSVNUX0hFQUQoJmJk
ZXYtPmRkZXN0cm95KTsKLQliZGV2LT5kZXZfbWFwcGluZyA9IG1hcHBpbmc7Ci0JYmRldi0+bmVl
ZF9kbWEzMiA9IG5lZWRfZG1hMzI7Ci0JbXV0ZXhfbG9jaygmdHRtX2dsb2JhbF9tdXRleCk7Ci0J
bGlzdF9hZGRfdGFpbCgmYmRldi0+ZGV2aWNlX2xpc3QsICZnbG9iLT5kZXZpY2VfbGlzdCk7Ci0J
bXV0ZXhfdW5sb2NrKCZ0dG1fZ2xvYmFsX211dGV4KTsKLQotCXJldHVybiAwOwotfQotRVhQT1JU
X1NZTUJPTCh0dG1fYm9fZGV2aWNlX2luaXQpOwotCiAvKgogICogYnVmZmVyIG9iamVjdCB2bSBm
dW5jdGlvbnMuCiAgKi8KIAogdm9pZCB0dG1fYm9fdW5tYXBfdmlydHVhbChzdHJ1Y3QgdHRtX2J1
ZmZlcl9vYmplY3QgKmJvKQogewotCXN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2ID0gYm8tPmJk
ZXY7CisJc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYgPSBiby0+YmRldjsKIAogCWRybV92bWFfbm9k
ZV91bm1hcCgmYm8tPmJhc2Uudm1hX25vZGUsIGJkZXYtPmRldl9tYXBwaW5nKTsKIAl0dG1fbWVt
X2lvX2ZyZWUoYmRldiwgJmJvLT5tZW0pOwpAQCAtMTQyNSw3ICsxMjMzLDcgQEAgRVhQT1JUX1NZ
TUJPTCh0dG1fYm9fd2FpdCk7CiAgKiBBIGJ1ZmZlciBvYmplY3Qgc2hyaW5rIG1ldGhvZCB0aGF0
IHRyaWVzIHRvIHN3YXAgb3V0IHRoZSBmaXJzdAogICogYnVmZmVyIG9iamVjdCBvbiB0aGUgYm9f
Z2xvYmFsOjpzd2FwX2xydSBsaXN0LgogICovCi1pbnQgdHRtX2JvX3N3YXBvdXQoc3RydWN0IHR0
bV9ib19nbG9iYWwgKmdsb2IsIHN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0eCAqY3R4KQoraW50IHR0
bV9ib19zd2Fwb3V0KHN0cnVjdCB0dG1fZ2xvYmFsICpnbG9iLCBzdHJ1Y3QgdHRtX29wZXJhdGlv
bl9jdHggKmN0eCkKIHsKIAlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvOwogCWludCByZXQg
PSAtRUJVU1k7CkBAIC0xNDk5LDggKzEzMDcsOCBAQCBpbnQgdHRtX2JvX3N3YXBvdXQoc3RydWN0
IHR0bV9ib19nbG9iYWwgKmdsb2IsIHN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0eCAqY3R4KQogCSAq
IGFueW9uZSB0cmllcyB0byBhY2Nlc3MgYSB0dG0gcGFnZS4KIAkgKi8KIAotCWlmIChiby0+YmRl
di0+ZHJpdmVyLT5zd2FwX25vdGlmeSkKLQkJYm8tPmJkZXYtPmRyaXZlci0+c3dhcF9ub3RpZnko
Ym8pOworCWlmIChiby0+YmRldi0+ZnVuY3MtPnN3YXBfbm90aWZ5KQorCQliby0+YmRldi0+ZnVu
Y3MtPnN3YXBfbm90aWZ5KGJvKTsKIAogCXJldCA9IHR0bV90dF9zd2Fwb3V0KGJvLT5iZGV2LCBi
by0+dHRtKTsKIG91dDoKQEAgLTE1MjQsNyArMTMzMiw3IEBAIHZvaWQgdHRtX2JvX3N3YXBvdXRf
YWxsKHZvaWQpCiAJCS5ub193YWl0X2dwdSA9IGZhbHNlCiAJfTsKIAotCXdoaWxlICh0dG1fYm9f
c3dhcG91dCgmdHRtX2JvX2dsb2IsICZjdHgpID09IDApOworCXdoaWxlICh0dG1fYm9fc3dhcG91
dCgmdHRtX2dsb2IsICZjdHgpID09IDApOwogfQogRVhQT1JUX1NZTUJPTCh0dG1fYm9fc3dhcG91
dF9hbGwpOwogCkBAIC0xNTM5LDEwICsxMzQ3LDEwIEBAIHZvaWQgdHRtX2JvX3R0X2Rlc3Ryb3ko
c3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibykKIAogaW50IHR0bV9ib190dF9iaW5kKHN0cnVj
dCB0dG1fYnVmZmVyX29iamVjdCAqYm8sIHN0cnVjdCB0dG1fcmVzb3VyY2UgKm1lbSkKIHsKLQly
ZXR1cm4gYm8tPmJkZXYtPmRyaXZlci0+dHRtX3R0X2JpbmQoYm8tPmJkZXYsIGJvLT50dG0sIG1l
bSk7CisJcmV0dXJuIGJvLT5iZGV2LT5mdW5jcy0+dHRtX3R0X2JpbmQoYm8tPmJkZXYsIGJvLT50
dG0sIG1lbSk7CiB9CiAKIHZvaWQgdHRtX2JvX3R0X3VuYmluZChzdHJ1Y3QgdHRtX2J1ZmZlcl9v
YmplY3QgKmJvKQogewotCWJvLT5iZGV2LT5kcml2ZXItPnR0bV90dF91bmJpbmQoYm8tPmJkZXYs
IGJvLT50dG0pOworCWJvLT5iZGV2LT5mdW5jcy0+dHRtX3R0X3VuYmluZChiby0+YmRldiwgYm8t
PnR0bSk7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGlsLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGlsLmMKaW5kZXggYmE3YWI1ZWQ4NWQwLi4x
NzkwM2YwZTIxMWYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3V0aWwu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGlsLmMKQEAgLTg4LDMzICs4OCwz
MyBAQCBpbnQgdHRtX2JvX21vdmVfdHRtKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiB9
CiBFWFBPUlRfU1lNQk9MKHR0bV9ib19tb3ZlX3R0bSk7CiAKLWludCB0dG1fbWVtX2lvX3Jlc2Vy
dmUoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCitpbnQgdHRtX21lbV9pb19yZXNlcnZlKHN0
cnVjdCB0dG1fZGV2aWNlICpiZGV2LAogCQkgICAgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqbWVt
KQogewogCWlmIChtZW0tPmJ1cy5vZmZzZXQgfHwgbWVtLT5idXMuYWRkcikKIAkJcmV0dXJuIDA7
CiAKIAltZW0tPmJ1cy5pc19pb21lbSA9IGZhbHNlOwotCWlmICghYmRldi0+ZHJpdmVyLT5pb19t
ZW1fcmVzZXJ2ZSkKKwlpZiAoIWJkZXYtPmZ1bmNzLT5pb19tZW1fcmVzZXJ2ZSkKIAkJcmV0dXJu
IDA7CiAKLQlyZXR1cm4gYmRldi0+ZHJpdmVyLT5pb19tZW1fcmVzZXJ2ZShiZGV2LCBtZW0pOwor
CXJldHVybiBiZGV2LT5mdW5jcy0+aW9fbWVtX3Jlc2VydmUoYmRldiwgbWVtKTsKIH0KIAotdm9p
ZCB0dG1fbWVtX2lvX2ZyZWUoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCit2b2lkIHR0bV9t
ZW1faW9fZnJlZShzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwKIAkJICAgICBzdHJ1Y3QgdHRtX3Jl
c291cmNlICptZW0pCiB7CiAJaWYgKCFtZW0tPmJ1cy5vZmZzZXQgJiYgIW1lbS0+YnVzLmFkZHIp
CiAJCXJldHVybjsKIAotCWlmIChiZGV2LT5kcml2ZXItPmlvX21lbV9mcmVlKQotCQliZGV2LT5k
cml2ZXItPmlvX21lbV9mcmVlKGJkZXYsIG1lbSk7CisJaWYgKGJkZXYtPmZ1bmNzLT5pb19tZW1f
ZnJlZSkKKwkJYmRldi0+ZnVuY3MtPmlvX21lbV9mcmVlKGJkZXYsIG1lbSk7CiAKIAltZW0tPmJ1
cy5vZmZzZXQgPSAwOwogCW1lbS0+YnVzLmFkZHIgPSBOVUxMOwogfQogCi1zdGF0aWMgaW50IHR0
bV9yZXNvdXJjZV9pb3JlbWFwKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAorc3RhdGljIGlu
dCB0dG1fcmVzb3VyY2VfaW9yZW1hcChzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwKIAkJCSAgICAg
ICBzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0sCiAJCQkgICAgICAgdm9pZCAqKnZpcnR1YWwpCiB7
CkBAIC0xNDQsNyArMTQ0LDcgQEAgc3RhdGljIGludCB0dG1fcmVzb3VyY2VfaW9yZW1hcChzdHJ1
Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIHZvaWQgdHRt
X3Jlc291cmNlX2lvdW5tYXAoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCitzdGF0aWMgdm9p
ZCB0dG1fcmVzb3VyY2VfaW91bm1hcChzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwKIAkJCQlzdHJ1
Y3QgdHRtX3Jlc291cmNlICptZW0sCiAJCQkJdm9pZCAqdmlydHVhbCkKIHsKQEAgLTIxNCw3ICsy
MTQsNyBAQCBpbnQgdHRtX2JvX21vdmVfbWVtY3B5KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAq
Ym8sCiAJCSAgICAgICBzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHggKmN0eCwKIAkJICAgICAgIHN0
cnVjdCB0dG1fcmVzb3VyY2UgKm5ld19tZW0pCiB7Ci0Jc3RydWN0IHR0bV9ib19kZXZpY2UgKmJk
ZXYgPSBiby0+YmRldjsKKwlzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiA9IGJvLT5iZGV2OwogCXN0
cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuID0gdHRtX21hbmFnZXJfdHlwZShiZGV2LCBu
ZXdfbWVtLT5tZW1fdHlwZSk7CiAJc3RydWN0IHR0bV90dCAqdHRtID0gYm8tPnR0bTsKIAlzdHJ1
Y3QgdHRtX3Jlc291cmNlICpvbGRfbWVtID0gJmJvLT5tZW07CkBAIC0zNTUsNyArMzU1LDcgQEAg
c3RhdGljIGludCB0dG1fYnVmZmVyX29iamVjdF90cmFuc2ZlcihzdHJ1Y3QgdHRtX2J1ZmZlcl9v
YmplY3QgKmJvLAogCSAqIFRPRE86IEV4cGxpY2l0IG1lbWJlciBjb3B5IHdvdWxkIHByb2JhYmx5
IGJlIGJldHRlciBoZXJlLgogCSAqLwogCi0JYXRvbWljX2luYygmdHRtX2JvX2dsb2IuYm9fY291
bnQpOworCWF0b21pY19pbmMoJnR0bV9nbG9iLmJvX2NvdW50KTsKIAlJTklUX0xJU1RfSEVBRCgm
ZmJvLT5iYXNlLmRkZXN0cm95KTsKIAlJTklUX0xJU1RfSEVBRCgmZmJvLT5iYXNlLmxydSk7CiAJ
SU5JVF9MSVNUX0hFQUQoJmZiby0+YmFzZS5zd2FwKTsKQEAgLTU4NCw3ICs1ODQsNyBAQCBzdGF0
aWMgaW50IHR0bV9ib19tb3ZlX3RvX2dob3N0KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8s
CiBzdGF0aWMgdm9pZCB0dG1fYm9fbW92ZV9waXBlbGluZV9ldmljdChzdHJ1Y3QgdHRtX2J1ZmZl
cl9vYmplY3QgKmJvLAogCQkJCSAgICAgICBzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSkKIHsKLQlz
dHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiA9IGJvLT5iZGV2OworCXN0cnVjdCB0dG1fZGV2aWNl
ICpiZGV2ID0gYm8tPmJkZXY7CiAJc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICpmcm9tID0g
dHRtX21hbmFnZXJfdHlwZShiZGV2LCBiby0+bWVtLm1lbV90eXBlKTsKIAogCS8qKgpAQCAtNjEw
LDcgKzYxMCw3IEBAIGludCB0dG1fYm9fbW92ZV9hY2NlbF9jbGVhbnVwKHN0cnVjdCB0dG1fYnVm
ZmVyX29iamVjdCAqYm8sCiAJCQkgICAgICBib29sIHBpcGVsaW5lLAogCQkJICAgICAgc3RydWN0
IHR0bV9yZXNvdXJjZSAqbmV3X21lbSkKIHsKLQlzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiA9
IGJvLT5iZGV2OworCXN0cnVjdCB0dG1fZGV2aWNlICpiZGV2ID0gYm8tPmJkZXY7CiAJc3RydWN0
IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICpmcm9tID0gdHRtX21hbmFnZXJfdHlwZShiZGV2LCBiby0+
bWVtLm1lbV90eXBlKTsKIAlzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiA9IHR0bV9t
YW5hZ2VyX3R5cGUoYmRldiwgbmV3X21lbS0+bWVtX3R5cGUpOwogCWludCByZXQgPSAwOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm9fdm0uYyBiL2RyaXZlcnMvZ3B1L2Ry
bS90dG0vdHRtX2JvX3ZtLmMKaW5kZXggZWVhY2E1ZDFlZmUzLi42OTdjMDg4ZDEwNjMgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3ZtLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL3R0bS90dG1fYm9fdm0uYwpAQCAtOTYsMTAgKzk2LDEwIEBAIHN0YXRpYyB2bV9mYXVsdF90
IHR0bV9ib192bV9mYXVsdF9pZGxlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiBzdGF0
aWMgdW5zaWduZWQgbG9uZyB0dG1fYm9faW9fbWVtX3BmbihzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmpl
Y3QgKmJvLAogCQkJCSAgICAgICB1bnNpZ25lZCBsb25nIHBhZ2Vfb2Zmc2V0KQogewotCXN0cnVj
dCB0dG1fYm9fZGV2aWNlICpiZGV2ID0gYm8tPmJkZXY7CisJc3RydWN0IHR0bV9kZXZpY2UgKmJk
ZXYgPSBiby0+YmRldjsKIAotCWlmIChiZGV2LT5kcml2ZXItPmlvX21lbV9wZm4pCi0JCXJldHVy
biBiZGV2LT5kcml2ZXItPmlvX21lbV9wZm4oYm8sIHBhZ2Vfb2Zmc2V0KTsKKwlpZiAoYmRldi0+
ZnVuY3MtPmlvX21lbV9wZm4pCisJCXJldHVybiBiZGV2LT5mdW5jcy0+aW9fbWVtX3Bmbihibywg
cGFnZV9vZmZzZXQpOwogCiAJcmV0dXJuIChiby0+bWVtLmJ1cy5vZmZzZXQgPj4gUEFHRV9TSElG
VCkgKyBwYWdlX29mZnNldDsKIH0KQEAgLTIxNyw3ICsyMTcsNyBAQCBzdGF0aWMgdm1fZmF1bHRf
dCB0dG1fYm9fdm1faW5zZXJ0X2h1Z2Uoc3RydWN0IHZtX2ZhdWx0ICp2bWYsCiAJCQlpZiAocGFn
ZV90b19wZm4odHRtLT5wYWdlc1twYWdlX29mZnNldCArIGldKSAhPSBwZm4gKyBpKQogCQkJCWdv
dG8gb3V0X2ZhbGxiYWNrOwogCQl9Ci0JfSBlbHNlIGlmIChiby0+YmRldi0+ZHJpdmVyLT5pb19t
ZW1fcGZuKSB7CisJfSBlbHNlIGlmIChiby0+YmRldi0+ZnVuY3MtPmlvX21lbV9wZm4pIHsKIAkJ
Zm9yIChpID0gMTsgaSA8IGZhdWx0X3BhZ2Vfc2l6ZTsgKytpKSB7CiAJCQlpZiAodHRtX2JvX2lv
X21lbV9wZm4oYm8sIHBhZ2Vfb2Zmc2V0ICsgaSkgIT0gcGZuICsgaSkKIAkJCQlnb3RvIG91dF9m
YWxsYmFjazsKQEAgLTI3OSw3ICsyNzksNyBAQCB2bV9mYXVsdF90IHR0bV9ib192bV9mYXVsdF9y
ZXNlcnZlZChzdHJ1Y3Qgdm1fZmF1bHQgKnZtZiwKIHsKIAlzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3Qg
KnZtYSA9IHZtZi0+dm1hOwogCXN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8gPSB2bWEtPnZt
X3ByaXZhdGVfZGF0YTsKLQlzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiA9IGJvLT5iZGV2Owor
CXN0cnVjdCB0dG1fZGV2aWNlICpiZGV2ID0gYm8tPmJkZXY7CiAJdW5zaWduZWQgbG9uZyBwYWdl
X29mZnNldDsKIAl1bnNpZ25lZCBsb25nIHBhZ2VfbGFzdDsKIAl1bnNpZ25lZCBsb25nIHBmbjsK
QEAgLTQ5MCw4ICs0OTAsOCBAQCBpbnQgdHRtX2JvX3ZtX2FjY2VzcyhzdHJ1Y3Qgdm1fYXJlYV9z
dHJ1Y3QgKnZtYSwgdW5zaWduZWQgbG9uZyBhZGRyLAogCQlyZXQgPSB0dG1fYm9fdm1fYWNjZXNz
X2ttYXAoYm8sIG9mZnNldCwgYnVmLCBsZW4sIHdyaXRlKTsKIAkJYnJlYWs7CiAJZGVmYXVsdDoK
LQkJaWYgKGJvLT5iZGV2LT5kcml2ZXItPmFjY2Vzc19tZW1vcnkpCi0JCQlyZXQgPSBiby0+YmRl
di0+ZHJpdmVyLT5hY2Nlc3NfbWVtb3J5KAorCQlpZiAoYm8tPmJkZXYtPmZ1bmNzLT5hY2Nlc3Nf
bWVtb3J5KQorCQkJcmV0ID0gYm8tPmJkZXYtPmZ1bmNzLT5hY2Nlc3NfbWVtb3J5KAogCQkJCWJv
LCBvZmZzZXQsIGJ1ZiwgbGVuLCB3cml0ZSk7CiAJCWVsc2UKIAkJCXJldCA9IC1FSU87CkBAIC01
MTAsNyArNTEwLDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2bV9vcGVyYXRpb25zX3N0cnVjdCB0
dG1fYm9fdm1fb3BzID0gewogCS5hY2Nlc3MgPSB0dG1fYm9fdm1fYWNjZXNzLAogfTsKIAotc3Rh
dGljIHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqdHRtX2JvX3ZtX2xvb2t1cChzdHJ1Y3QgdHRt
X2JvX2RldmljZSAqYmRldiwKK3N0YXRpYyBzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKnR0bV9i
b192bV9sb29rdXAoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsCiAJCQkJCQkgIHVuc2lnbmVkIGxv
bmcgb2Zmc2V0LAogCQkJCQkJICB1bnNpZ25lZCBsb25nIHBhZ2VzKQogewpAQCAtNTU3LDkgKzU1
Nyw4IEBAIHN0YXRpYyB2b2lkIHR0bV9ib19tbWFwX3ZtYV9zZXR1cChzdHJ1Y3QgdHRtX2J1ZmZl
cl9vYmplY3QgKmJvLCBzdHJ1Y3Qgdm1fYXJlYV9zCiB9CiAKIGludCB0dG1fYm9fbW1hcChzdHJ1
Y3QgZmlsZSAqZmlscCwgc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsCi0JCXN0cnVjdCB0dG1f
Ym9fZGV2aWNlICpiZGV2KQorCQlzdHJ1Y3QgdHRtX2RldmljZSAqYmRldikKIHsKLQlzdHJ1Y3Qg
dHRtX2JvX2RyaXZlciAqZHJpdmVyOwogCXN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm87CiAJ
aW50IHJldDsKIApAQCAtNTcwLDEyICs1NjksMTEgQEAgaW50IHR0bV9ib19tbWFwKHN0cnVjdCBm
aWxlICpmaWxwLCBzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSwKIAlpZiAodW5saWtlbHkoIWJv
KSkKIAkJcmV0dXJuIC1FSU5WQUw7CiAKLQlkcml2ZXIgPSBiby0+YmRldi0+ZHJpdmVyOwotCWlm
ICh1bmxpa2VseSghZHJpdmVyLT52ZXJpZnlfYWNjZXNzKSkgeworCWlmICh1bmxpa2VseSghYm8t
PmJkZXYtPmZ1bmNzLT52ZXJpZnlfYWNjZXNzKSkgewogCQlyZXQgPSAtRVBFUk07CiAJCWdvdG8g
b3V0X3VucmVmOwogCX0KLQlyZXQgPSBkcml2ZXItPnZlcmlmeV9hY2Nlc3MoYm8sIGZpbHApOwor
CXJldCA9IGJvLT5iZGV2LT5mdW5jcy0+dmVyaWZ5X2FjY2VzcyhibywgZmlscCk7CiAJaWYgKHVu
bGlrZWx5KHJldCAhPSAwKSkKIAkJZ290byBvdXRfdW5yZWY7CiAKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS90dG0vdHRtX2RldmljZS5jIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fZGV2
aWNlLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi42NWFhNmU0ZjVj
NmMKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9kZXZpY2UuYwpA
QCAtMCwwICsxLDIyMiBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAgT1Ig
TUlUICovCisKKy8qCisgKiBDb3B5cmlnaHQgKGMpIDIwMDYtMjAwOSBWTXdhcmUsIEluYy4sIFBh
bG8gQWx0bywgQ0EuLCBVU0EKKyAqIENvcHlyaWdodCAyMDIwIEFkdmFuY2VkIE1pY3JvIERldmlj
ZXMsIEluYy4KKyAqCisgKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNo
YXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQorICogY29weSBvZiB0aGlzIHNvZnR3YXJl
IGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwKKyAq
IHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3
aXRob3V0IGxpbWl0YXRpb24KKyAqIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1l
cmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLAorICogYW5kL29yIHNlbGwgY29w
aWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlCisg
KiBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2lu
ZyBjb25kaXRpb25zOgorICoKKyAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlz
IHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluCisgKiBhbGwgY29waWVzIG9y
IHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KKyAqCisgKiBUSEUgU09GVFdB
UkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQ
UkVTUyBPUgorICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FS
UkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksCisgKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIg
UFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwKKyAqIFRIRSBD
T1BZUklHSFQgSE9MREVSKFMpIE9SIEFVVEhPUihTKSBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwg
REFNQUdFUyBPUgorICogT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBD
T05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsCisgKiBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJ
TiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IKKyAqIE9USEVSIERF
QUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4KKyAqCisgKiBBdXRob3JzOiBDaHJpc3RpYW4gS8O2bmln
CisgKi8KKworI2RlZmluZSBwcl9mbXQoZm10KSAiW1RUTSBERVZJQ0VdICIgZm10CisKKyNpbmNs
dWRlIDxkcm0vdHRtL3R0bV9tb2R1bGUuaD4KKyNpbmNsdWRlIDxkcm0vdHRtL3R0bV9kZXZpY2Uu
aD4KKyNpbmNsdWRlIDxkcm0vdHRtL3R0bV9tZW1vcnkuaD4KKyNpbmNsdWRlIDxkcm0vdHRtL3R0
bV9wbGFjZW1lbnQuaD4KKworLyoqCisgKiB0dG1fZ2xvYmFsX211dGV4IC0gcHJvdGVjdGluZyB0
aGUgZ2xvYmFsIHN0YXRlCisgKi8KK0RFRklORV9NVVRFWCh0dG1fZ2xvYmFsX211dGV4KTsKK3Vu
c2lnbmVkIHR0bV9nbG9iX3VzZV9jb3VudDsKK3N0cnVjdCB0dG1fZ2xvYmFsIHR0bV9nbG9iOwor
RVhQT1JUX1NZTUJPTCh0dG1fZ2xvYik7CisKK3N0YXRpYyBzdHJ1Y3QgYXR0cmlidXRlIHR0bV9i
b19jb3VudCA9IHsKKwkubmFtZSA9ICJib19jb3VudCIsCisJLm1vZGUgPSBTX0lSVUdPCit9Owor
CitzdGF0aWMgdm9pZCB0dG1fZ2xvYmFsX2tvYmpfcmVsZWFzZShzdHJ1Y3Qga29iamVjdCAqa29i
aik7CisKK3N0YXRpYyBzc2l6ZV90IHR0bV9nbG9iYWxfc2hvdyhzdHJ1Y3Qga29iamVjdCAqa29i
aiwgc3RydWN0IGF0dHJpYnV0ZSAqYXR0ciwKKwkJCSAgICAgICBjaGFyICpidWZmZXIpCit7CisJ
c3RydWN0IHR0bV9nbG9iYWwgKmdsb2IgPSBjb250YWluZXJfb2Yoa29iaiwgc3RydWN0IHR0bV9n
bG9iYWwsIGtvYmopOworCisJcmV0dXJuIHNucHJpbnRmKGJ1ZmZlciwgUEFHRV9TSVpFLCAiJWRc
biIsCisJCQkJYXRvbWljX3JlYWQoJmdsb2ItPmJvX2NvdW50KSk7Cit9CisKK3N0YXRpYyBzdHJ1
Y3QgYXR0cmlidXRlICp0dG1fZ2xvYmFsX2F0dHJzW10gPSB7CisJJnR0bV9ib19jb3VudCwKKwlO
VUxMCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IHN5c2ZzX29wcyB0dG1fZ2xvYmFsX29wcyA9
IHsKKwkuc2hvdyA9ICZ0dG1fZ2xvYmFsX3Nob3cKK307CisKK3N0YXRpYyBzdHJ1Y3Qga29ial90
eXBlIHR0bV9nbG9iX2tvYmpfdHlwZSAgPSB7CisJLnJlbGVhc2UgPSAmdHRtX2dsb2JhbF9rb2Jq
X3JlbGVhc2UsCisJLnN5c2ZzX29wcyA9ICZ0dG1fZ2xvYmFsX29wcywKKwkuZGVmYXVsdF9hdHRy
cyA9IHR0bV9nbG9iYWxfYXR0cnMKK307CisKK3N0YXRpYyB2b2lkIHR0bV9nbG9iYWxfa29ial9y
ZWxlYXNlKHN0cnVjdCBrb2JqZWN0ICprb2JqKQoreworCXN0cnVjdCB0dG1fZ2xvYmFsICpnbG9i
ID0KKwkJY29udGFpbmVyX29mKGtvYmosIHN0cnVjdCB0dG1fZ2xvYmFsLCBrb2JqKTsKKworCV9f
ZnJlZV9wYWdlKGdsb2ItPmR1bW15X3JlYWRfcGFnZSk7Cit9CisKK3N0YXRpYyB2b2lkIHR0bV9n
bG9iYWxfcmVsZWFzZSh2b2lkKQoreworCXN0cnVjdCB0dG1fZ2xvYmFsICpnbG9iID0gJnR0bV9n
bG9iOworCisJbXV0ZXhfbG9jaygmdHRtX2dsb2JhbF9tdXRleCk7CisJaWYgKC0tdHRtX2dsb2Jf
dXNlX2NvdW50ID4gMCkKKwkJZ290byBvdXQ7CisKKwlrb2JqZWN0X2RlbCgmZ2xvYi0+a29iaik7
CisJa29iamVjdF9wdXQoJmdsb2ItPmtvYmopOworCXR0bV9tZW1fZ2xvYmFsX3JlbGVhc2UoJnR0
bV9tZW1fZ2xvYik7CisJbWVtc2V0KGdsb2IsIDAsIHNpemVvZigqZ2xvYikpOworb3V0OgorCW11
dGV4X3VubG9jaygmdHRtX2dsb2JhbF9tdXRleCk7Cit9CisKK3N0YXRpYyBpbnQgdHRtX2dsb2Jh
bF9pbml0KHZvaWQpCit7CisJc3RydWN0IHR0bV9nbG9iYWwgKmdsb2IgPSAmdHRtX2dsb2I7CisJ
aW50IHJldCA9IDA7CisJdW5zaWduZWQgaTsKKworCW11dGV4X2xvY2soJnR0bV9nbG9iYWxfbXV0
ZXgpOworCWlmICgrK3R0bV9nbG9iX3VzZV9jb3VudCA+IDEpCisJCWdvdG8gb3V0OworCisJcmV0
ID0gdHRtX21lbV9nbG9iYWxfaW5pdCgmdHRtX21lbV9nbG9iKTsKKwlpZiAocmV0KQorCQlnb3Rv
IG91dDsKKworCXNwaW5fbG9ja19pbml0KCZnbG9iLT5scnVfbG9jayk7CisJZ2xvYi0+ZHVtbXlf
cmVhZF9wYWdlID0gYWxsb2NfcGFnZShfX0dGUF9aRVJPIHwgR0ZQX0RNQTMyKTsKKworCWlmICh1
bmxpa2VseShnbG9iLT5kdW1teV9yZWFkX3BhZ2UgPT0gTlVMTCkpIHsKKwkJcmV0ID0gLUVOT01F
TTsKKwkJZ290byBvdXQ7CisJfQorCisJZm9yIChpID0gMDsgaSA8IFRUTV9NQVhfQk9fUFJJT1JJ
VFk7ICsraSkKKwkJSU5JVF9MSVNUX0hFQUQoJmdsb2ItPnN3YXBfbHJ1W2ldKTsKKwlJTklUX0xJ
U1RfSEVBRCgmZ2xvYi0+ZGV2aWNlX2xpc3QpOworCWF0b21pY19zZXQoJmdsb2ItPmJvX2NvdW50
LCAwKTsKKworCXJldCA9IGtvYmplY3RfaW5pdF9hbmRfYWRkKAorCQkmZ2xvYi0+a29iaiwgJnR0
bV9nbG9iX2tvYmpfdHlwZSwgdHRtX2dldF9rb2JqKCksICJidWZmZXJfb2JqZWN0cyIpOworCWlm
ICh1bmxpa2VseShyZXQgIT0gMCkpCisJCWtvYmplY3RfcHV0KCZnbG9iLT5rb2JqKTsKK291dDoK
KwltdXRleF91bmxvY2soJnR0bV9nbG9iYWxfbXV0ZXgpOworCXJldHVybiByZXQ7Cit9CisKK3N0
YXRpYyB2b2lkIHR0bV9pbml0X3N5c21hbihzdHJ1Y3QgdHRtX2RldmljZSAqYmRldikKK3sKKwlz
dHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiA9ICZiZGV2LT5zeXNtYW47CisKKwkvKgor
CSAqIEluaXRpYWxpemUgdGhlIHN5c3RlbSBtZW1vcnkgYnVmZmVyIHR5cGUuCisJICogT3RoZXIg
dHlwZXMgbmVlZCB0byBiZSBkcml2ZXIgLyBJT0NUTCBpbml0aWFsaXplZC4KKwkgKi8KKwltYW4t
PnVzZV90dCA9IHRydWU7CisKKwl0dG1fcmVzb3VyY2VfbWFuYWdlcl9pbml0KG1hbiwgMCk7CisJ
dHRtX3NldF9kcml2ZXJfbWFuYWdlcihiZGV2LCBUVE1fUExfU1lTVEVNLCBtYW4pOworCXR0bV9y
ZXNvdXJjZV9tYW5hZ2VyX3NldF91c2VkKG1hbiwgdHJ1ZSk7Cit9CisKK3N0YXRpYyB2b2lkIHR0
bV9kZXZpY2VfZGVsYXllZF93b3JrcXVldWUoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQorewor
CXN0cnVjdCB0dG1fZGV2aWNlICpiZGV2ID0KKwkJY29udGFpbmVyX29mKHdvcmssIHN0cnVjdCB0
dG1fZGV2aWNlLCB3cS53b3JrKTsKKworCWlmICghdHRtX2JvX2RlbGF5ZWRfZGVsZXRlKGJkZXYs
IGZhbHNlKSkKKwkJc2NoZWR1bGVfZGVsYXllZF93b3JrKCZiZGV2LT53cSwKKwkJCQkgICAgICAo
KEhaIC8gMTAwKSA8IDEpID8gMSA6IEhaIC8gMTAwKTsKK30KKworaW50IHR0bV9kZXZpY2VfaW5p
dChzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV9kZXZpY2VfZnVuY3MgKmZ1bmNz
LAorCQkgICAgc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcsCisJCSAgICBzdHJ1Y3QgZHJt
X3ZtYV9vZmZzZXRfbWFuYWdlciAqdm1hX21hbmFnZXIsCisJCSAgICBib29sIG5lZWRfZG1hMzIp
Cit7CisJc3RydWN0IHR0bV9nbG9iYWwgKmdsb2IgPSAmdHRtX2dsb2I7CisJaW50IHJldDsKKwor
CWlmIChXQVJOX09OKHZtYV9tYW5hZ2VyID09IE5VTEwpKQorCQlyZXR1cm4gLUVJTlZBTDsKKwor
CXJldCA9IHR0bV9nbG9iYWxfaW5pdCgpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwli
ZGV2LT5mdW5jcyA9IGZ1bmNzOworCisJdHRtX2luaXRfc3lzbWFuKGJkZXYpOworCisJYmRldi0+
dm1hX21hbmFnZXIgPSB2bWFfbWFuYWdlcjsKKwlJTklUX0RFTEFZRURfV09SSygmYmRldi0+d3Es
IHR0bV9kZXZpY2VfZGVsYXllZF93b3JrcXVldWUpOworCUlOSVRfTElTVF9IRUFEKCZiZGV2LT5k
ZGVzdHJveSk7CisJYmRldi0+ZGV2X21hcHBpbmcgPSBtYXBwaW5nOworCWJkZXYtPm5lZWRfZG1h
MzIgPSBuZWVkX2RtYTMyOworCW11dGV4X2xvY2soJnR0bV9nbG9iYWxfbXV0ZXgpOworCWxpc3Rf
YWRkX3RhaWwoJmJkZXYtPmRldmljZV9saXN0LCAmZ2xvYi0+ZGV2aWNlX2xpc3QpOworCW11dGV4
X3VubG9jaygmdHRtX2dsb2JhbF9tdXRleCk7CisKKwlyZXR1cm4gMDsKK30KK0VYUE9SVF9TWU1C
T0wodHRtX2RldmljZV9pbml0KTsKKworaW50IHR0bV9kZXZpY2VfcmVsZWFzZShzdHJ1Y3QgdHRt
X2RldmljZSAqYmRldikKK3sKKwlzdHJ1Y3QgdHRtX2dsb2JhbCAqZ2xvYiA9ICZ0dG1fZ2xvYjsK
KwlzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbjsKKwlpbnQgcmV0ID0gMDsKKwl1bnNp
Z25lZCBpOworCisJbWFuID0gdHRtX21hbmFnZXJfdHlwZShiZGV2LCBUVE1fUExfU1lTVEVNKTsK
Kwl0dG1fcmVzb3VyY2VfbWFuYWdlcl9zZXRfdXNlZChtYW4sIGZhbHNlKTsKKwl0dG1fc2V0X2Ry
aXZlcl9tYW5hZ2VyKGJkZXYsIFRUTV9QTF9TWVNURU0sIE5VTEwpOworCisJbXV0ZXhfbG9jaygm
dHRtX2dsb2JhbF9tdXRleCk7CisJbGlzdF9kZWwoJmJkZXYtPmRldmljZV9saXN0KTsKKwltdXRl
eF91bmxvY2soJnR0bV9nbG9iYWxfbXV0ZXgpOworCisJY2FuY2VsX2RlbGF5ZWRfd29ya19zeW5j
KCZiZGV2LT53cSk7CisKKwlpZiAodHRtX2JvX2RlbGF5ZWRfZGVsZXRlKGJkZXYsIHRydWUpKQor
CQlwcl9kZWJ1ZygiRGVsYXllZCBkZXN0cm95IGxpc3Qgd2FzIGNsZWFuXG4iKTsKKworCXNwaW5f
bG9jaygmZ2xvYi0+bHJ1X2xvY2spOworCWZvciAoaSA9IDA7IGkgPCBUVE1fTUFYX0JPX1BSSU9S
SVRZOyArK2kpCisJCWlmIChsaXN0X2VtcHR5KCZtYW4tPmxydVswXSkpCisJCQlwcl9kZWJ1Zygi
U3dhcCBsaXN0ICVkIHdhcyBjbGVhblxuIiwgaSk7CisJc3Bpbl91bmxvY2soJmdsb2ItPmxydV9s
b2NrKTsKKworCWlmICghcmV0KQorCQl0dG1fZ2xvYmFsX3JlbGVhc2UoKTsKKworCXJldHVybiBy
ZXQ7Cit9CitFWFBPUlRfU1lNQk9MKHR0bV9kZXZpY2VfcmVsZWFzZSk7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9leGVjYnVmX3V0aWwuYyBiL2RyaXZlcnMvZ3B1L2RybS90
dG0vdHRtX2V4ZWNidWZfdXRpbC5jCmluZGV4IDhhOGYxYTZhODNhNi4uYjk4ZWI0YzFlNWVjIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9leGVjYnVmX3V0aWwuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9leGVjYnVmX3V0aWwuYwpAQCAtNTEsMTQgKzUxLDE0IEBA
IHZvaWQgdHRtX2V1X2JhY2tvZmZfcmVzZXJ2YXRpb24oc3RydWN0IHd3X2FjcXVpcmVfY3R4ICp0
aWNrZXQsCiAJaWYgKGxpc3RfZW1wdHkobGlzdCkpCiAJCXJldHVybjsKIAotCXNwaW5fbG9jaygm
dHRtX2JvX2dsb2IubHJ1X2xvY2spOworCXNwaW5fbG9jaygmdHRtX2dsb2IubHJ1X2xvY2spOwog
CWxpc3RfZm9yX2VhY2hfZW50cnkoZW50cnksIGxpc3QsIGhlYWQpIHsKIAkJc3RydWN0IHR0bV9i
dWZmZXJfb2JqZWN0ICpibyA9IGVudHJ5LT5ibzsKIAogCQl0dG1fYm9fbW92ZV90b19scnVfdGFp
bChibywgTlVMTCk7CiAJCWRtYV9yZXN2X3VubG9jayhiby0+YmFzZS5yZXN2KTsKIAl9Ci0Jc3Bp
bl91bmxvY2soJnR0bV9ib19nbG9iLmxydV9sb2NrKTsKKwlzcGluX3VubG9jaygmdHRtX2dsb2Iu
bHJ1X2xvY2spOwogCiAJaWYgKHRpY2tldCkKIAkJd3dfYWNxdWlyZV9maW5pKHRpY2tldCk7CkBA
IC0xNTQsNyArMTU0LDcgQEAgdm9pZCB0dG1fZXVfZmVuY2VfYnVmZmVyX29iamVjdHMoc3RydWN0
IHd3X2FjcXVpcmVfY3R4ICp0aWNrZXQsCiAJaWYgKGxpc3RfZW1wdHkobGlzdCkpCiAJCXJldHVy
bjsKIAotCXNwaW5fbG9jaygmdHRtX2JvX2dsb2IubHJ1X2xvY2spOworCXNwaW5fbG9jaygmdHRt
X2dsb2IubHJ1X2xvY2spOwogCWxpc3RfZm9yX2VhY2hfZW50cnkoZW50cnksIGxpc3QsIGhlYWQp
IHsKIAkJc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibyA9IGVudHJ5LT5ibzsKIApAQCAtMTY1
LDcgKzE2NSw3IEBAIHZvaWQgdHRtX2V1X2ZlbmNlX2J1ZmZlcl9vYmplY3RzKHN0cnVjdCB3d19h
Y3F1aXJlX2N0eCAqdGlja2V0LAogCQl0dG1fYm9fbW92ZV90b19scnVfdGFpbChibywgTlVMTCk7
CiAJCWRtYV9yZXN2X3VubG9jayhiby0+YmFzZS5yZXN2KTsKIAl9Ci0Jc3Bpbl91bmxvY2soJnR0
bV9ib19nbG9iLmxydV9sb2NrKTsKKwlzcGluX3VubG9jaygmdHRtX2dsb2IubHJ1X2xvY2spOwog
CWlmICh0aWNrZXQpCiAJCXd3X2FjcXVpcmVfZmluaSh0aWNrZXQpOwogfQpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fbWVtb3J5LmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0
bV9tZW1vcnkuYwppbmRleCA4OWQ1MGYzOGMwZjIuLjZhNmMxMDcyZDgzMSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fbWVtb3J5LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3R0
bS90dG1fbWVtb3J5LmMKQEAgLTI3NSw3ICsyNzUsNyBAQCBzdGF0aWMgdm9pZCB0dG1fc2hyaW5r
KHN0cnVjdCB0dG1fbWVtX2dsb2JhbCAqZ2xvYiwgYm9vbCBmcm9tX3dxLAogCiAJd2hpbGUgKHR0
bV96b25lc19hYm92ZV9zd2FwX3RhcmdldChnbG9iLCBmcm9tX3dxLCBleHRyYSkpIHsKIAkJc3Bp
bl91bmxvY2soJmdsb2ItPmxvY2spOwotCQlyZXQgPSB0dG1fYm9fc3dhcG91dCgmdHRtX2JvX2ds
b2IsIGN0eCk7CisJCXJldCA9IHR0bV9ib19zd2Fwb3V0KCZ0dG1fZ2xvYiwgY3R4KTsKIAkJc3Bp
bl9sb2NrKCZnbG9iLT5sb2NrKTsKIAkJaWYgKHVubGlrZWx5KHJldCAhPSAwKSkKIAkJCWJyZWFr
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fcmFuZ2VfbWFuYWdlci5jIGIv
ZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fcmFuZ2VfbWFuYWdlci5jCmluZGV4IDFkYTBlMjc3YzUx
MS4uYmQzYzZjNmI0MzI4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9yYW5n
ZV9tYW5hZ2VyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fcmFuZ2VfbWFuYWdlci5j
CkBAIC0xMTIsNyArMTEyLDcgQEAgc3RhdGljIHZvaWQgdHRtX3JhbmdlX21hbl9mcmVlKHN0cnVj
dCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuLAogCiBzdGF0aWMgY29uc3Qgc3RydWN0IHR0bV9y
ZXNvdXJjZV9tYW5hZ2VyX2Z1bmMgdHRtX3JhbmdlX21hbmFnZXJfZnVuYzsKIAotaW50IHR0bV9y
YW5nZV9tYW5faW5pdChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKK2ludCB0dG1fcmFuZ2Vf
bWFuX2luaXQoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsCiAJCSAgICAgICB1bnNpZ25lZCB0eXBl
LCBib29sIHVzZV90dCwKIAkJICAgICAgIHVuc2lnbmVkIGxvbmcgcF9zaXplKQogewpAQCAtMTM5
LDcgKzEzOSw3IEBAIGludCB0dG1fcmFuZ2VfbWFuX2luaXQoc3RydWN0IHR0bV9ib19kZXZpY2Ug
KmJkZXYsCiB9CiBFWFBPUlRfU1lNQk9MKHR0bV9yYW5nZV9tYW5faW5pdCk7CiAKLWludCB0dG1f
cmFuZ2VfbWFuX2Zpbmkoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCitpbnQgdHRtX3Jhbmdl
X21hbl9maW5pKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LAogCQkgICAgICAgdW5zaWduZWQgdHlw
ZSkKIHsKIAlzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiA9IHR0bV9tYW5hZ2VyX3R5
cGUoYmRldiwgdHlwZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9yZXNv
dXJjZS5jIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fcmVzb3VyY2UuYwppbmRleCBiMzI1Yjky
NjQyMDMuLjdmYWE0YTZhZTI4ZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1f
cmVzb3VyY2UuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9yZXNvdXJjZS5jCkBAIC04
Myw3ICs4Myw3IEBAIEVYUE9SVF9TWU1CT0wodHRtX3Jlc291cmNlX21hbmFnZXJfaW5pdCk7CiAg
KiBGb3JjZSBhbGwgdGhlIG9iamVjdHMgb3V0IG9mIGEgbWVtb3J5IG1hbmFnZXIgdW50aWwgY2xl
YW4uCiAgKiBQYXJ0IG9mIG1lbW9yeSBtYW5hZ2VyIGNsZWFudXAgc2VxdWVuY2UuCiAgKi8KLWlu
dCB0dG1fcmVzb3VyY2VfbWFuYWdlcl9mb3JjZV9saXN0X2NsZWFuKHN0cnVjdCB0dG1fYm9fZGV2
aWNlICpiZGV2LAoraW50IHR0bV9yZXNvdXJjZV9tYW5hZ2VyX2ZvcmNlX2xpc3RfY2xlYW4oc3Ry
dWN0IHR0bV9kZXZpY2UgKmJkZXYsCiAJCQkJCSAgc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2Vy
ICptYW4pCiB7CiAJc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4IGN0eCA9IHsKQEAgLTkxLDcgKzkx
LDcgQEAgaW50IHR0bV9yZXNvdXJjZV9tYW5hZ2VyX2ZvcmNlX2xpc3RfY2xlYW4oc3RydWN0IHR0
bV9ib19kZXZpY2UgKmJkZXYsCiAJCS5ub193YWl0X2dwdSA9IGZhbHNlLAogCQkuZmxhZ3MgPSBU
VE1fT1BUX0ZMQUdfRk9SQ0VfQUxMT0MKIAl9OwotCXN0cnVjdCB0dG1fYm9fZ2xvYmFsICpnbG9i
ID0gJnR0bV9ib19nbG9iOworCXN0cnVjdCB0dG1fZ2xvYmFsICpnbG9iID0gJnR0bV9nbG9iOwog
CXN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlOwogCWludCByZXQ7CiAJdW5zaWduZWQgaTsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3R0LmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRt
L3R0bV90dC5jCmluZGV4IDNlNWRkNjI3MWQ0Yy4uOTVkZmZlZTgyOTlkIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vdHRtL3R0bV90dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRt
X3R0LmMKQEAgLTQ0LDcgKzQ0LDcgQEAKICAqLwogaW50IHR0bV90dF9jcmVhdGUoc3RydWN0IHR0
bV9idWZmZXJfb2JqZWN0ICpibywgYm9vbCB6ZXJvX2FsbG9jKQogewotCXN0cnVjdCB0dG1fYm9f
ZGV2aWNlICpiZGV2ID0gYm8tPmJkZXY7CisJc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYgPSBiby0+
YmRldjsKIAl1aW50MzJfdCBwYWdlX2ZsYWdzID0gMDsKIAogCWRtYV9yZXN2X2Fzc2VydF9oZWxk
KGJvLT5iYXNlLnJlc3YpOwpAQCAtNzMsNyArNzMsNyBAQCBpbnQgdHRtX3R0X2NyZWF0ZShzdHJ1
Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLCBib29sIHplcm9fYWxsb2MpCiAJCXJldHVybiAtRUlO
VkFMOwogCX0KIAotCWJvLT50dG0gPSBiZGV2LT5kcml2ZXItPnR0bV90dF9jcmVhdGUoYm8sIHBh
Z2VfZmxhZ3MpOworCWJvLT50dG0gPSBiZGV2LT5mdW5jcy0+dHRtX3R0X2NyZWF0ZShibywgcGFn
ZV9mbGFncyk7CiAJaWYgKHVubGlrZWx5KGJvLT50dG0gPT0gTlVMTCkpCiAJCXJldHVybiAtRU5P
TUVNOwogCkBAIC0xMTQsNyArMTE0LDcgQEAgc3RhdGljIGludCB0dG1fc2dfdHRfYWxsb2NfcGFn
ZV9kaXJlY3Rvcnkoc3RydWN0IHR0bV9kbWFfdHQgKnR0bSkKIAlyZXR1cm4gMDsKIH0KIAotdm9p
ZCB0dG1fdHRfZGVzdHJveV9jb21tb24oc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVj
dCB0dG1fdHQgKnR0bSkKK3ZvaWQgdHRtX3R0X2Rlc3Ryb3lfY29tbW9uKHN0cnVjdCB0dG1fZGV2
aWNlICpiZGV2LCBzdHJ1Y3QgdHRtX3R0ICp0dG0pCiB7CiAJdHRtX3R0X3VucG9wdWxhdGUoYmRl
diwgdHRtKTsKIApAQCAtMTI1LDkgKzEyNSw5IEBAIHZvaWQgdHRtX3R0X2Rlc3Ryb3lfY29tbW9u
KHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LCBzdHJ1Y3QgdHRtX3R0ICp0dG0pCiB9CiBFWFBP
UlRfU1lNQk9MKHR0bV90dF9kZXN0cm95X2NvbW1vbik7CiAKLXZvaWQgdHRtX3R0X2Rlc3Ryb3ko
c3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSkKK3ZvaWQgdHRt
X3R0X2Rlc3Ryb3koc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSkK
IHsKLQliZGV2LT5kcml2ZXItPnR0bV90dF9kZXN0cm95KGJkZXYsIHR0bSk7CisJYmRldi0+ZnVu
Y3MtPnR0bV90dF9kZXN0cm95KGJkZXYsIHR0bSk7CiB9CiAKIHN0YXRpYyB2b2lkIHR0bV90dF9p
bml0X2ZpZWxkcyhzdHJ1Y3QgdHRtX3R0ICp0dG0sCkBAIC0yNTgsNyArMjU4LDcgQEAgaW50IHR0
bV90dF9zd2FwaW4oc3RydWN0IHR0bV90dCAqdHRtKQogCXJldHVybiByZXQ7CiB9CiAKLWludCB0
dG1fdHRfc3dhcG91dChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV90dCAq
dHRtKQoraW50IHR0bV90dF9zd2Fwb3V0KHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LCBzdHJ1Y3Qg
dHRtX3R0ICp0dG0pCiB7CiAJc3RydWN0IGFkZHJlc3Nfc3BhY2UgKnN3YXBfc3BhY2U7CiAJc3Ry
dWN0IGZpbGUgKnN3YXBfc3RvcmFnZTsKQEAgLTMwOCw3ICszMDgsNyBAQCBpbnQgdHRtX3R0X3N3
YXBvdXQoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSkKIAly
ZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgdm9pZCB0dG1fdHRfYWRkX21hcHBpbmcoc3RydWN0IHR0
bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSkKK3N0YXRpYyB2b2lkIHR0bV90
dF9hZGRfbWFwcGluZyhzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV90dCAqdHRt
KQogewogCXBnb2ZmX3QgaTsKIApAQCAtMzE5LDcgKzMxOSw3IEBAIHN0YXRpYyB2b2lkIHR0bV90
dF9hZGRfbWFwcGluZyhzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV90dCAq
dHRtKQogCQl0dG0tPnBhZ2VzW2ldLT5tYXBwaW5nID0gYmRldi0+ZGV2X21hcHBpbmc7CiB9CiAK
LWludCB0dG1fdHRfcG9wdWxhdGUoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCitpbnQgdHRt
X3R0X3BvcHVsYXRlKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LAogCQkgICAgc3RydWN0IHR0bV90
dCAqdHRtLCBzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHggKmN0eCkKIHsKIAlpbnQgcmV0OwpAQCAt
MzMwLDggKzMzMCw4IEBAIGludCB0dG1fdHRfcG9wdWxhdGUoc3RydWN0IHR0bV9ib19kZXZpY2Ug
KmJkZXYsCiAJaWYgKHR0bV90dF9pc19wb3B1bGF0ZWQodHRtKSkKIAkJcmV0dXJuIDA7CiAKLQlp
ZiAoYmRldi0+ZHJpdmVyLT50dG1fdHRfcG9wdWxhdGUpCi0JCXJldCA9IGJkZXYtPmRyaXZlci0+
dHRtX3R0X3BvcHVsYXRlKGJkZXYsIHR0bSwgY3R4KTsKKwlpZiAoYmRldi0+ZnVuY3MtPnR0bV90
dF9wb3B1bGF0ZSkKKwkJcmV0ID0gYmRldi0+ZnVuY3MtPnR0bV90dF9wb3B1bGF0ZShiZGV2LCB0
dG0sIGN0eCk7CiAJZWxzZQogCQlyZXQgPSB0dG1fcG9vbF9wb3B1bGF0ZSh0dG0sIGN0eCk7CiAJ
aWYgKCFyZXQpCkBAIC0zNTQsMTUgKzM1NCwxNSBAQCBzdGF0aWMgdm9pZCB0dG1fdHRfY2xlYXJf
bWFwcGluZyhzdHJ1Y3QgdHRtX3R0ICp0dG0pCiAJfQogfQogCi12b2lkIHR0bV90dF91bnBvcHVs
YXRlKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAordm9pZCB0dG1fdHRfdW5wb3B1bGF0ZShz
dHJ1Y3QgdHRtX2RldmljZSAqYmRldiwKIAkJICAgICAgIHN0cnVjdCB0dG1fdHQgKnR0bSkKIHsK
IAlpZiAoIXR0bV90dF9pc19wb3B1bGF0ZWQodHRtKSkKIAkJcmV0dXJuOwogCiAJdHRtX3R0X2Ns
ZWFyX21hcHBpbmcodHRtKTsKLQlpZiAoYmRldi0+ZHJpdmVyLT50dG1fdHRfdW5wb3B1bGF0ZSkK
LQkJYmRldi0+ZHJpdmVyLT50dG1fdHRfdW5wb3B1bGF0ZShiZGV2LCB0dG0pOworCWlmIChiZGV2
LT5mdW5jcy0+dHRtX3R0X3VucG9wdWxhdGUpCisJCWJkZXYtPmZ1bmNzLT50dG1fdHRfdW5wb3B1
bGF0ZShiZGV2LCB0dG0pOwogCWVsc2UKIAkJdHRtX3Bvb2xfdW5wb3B1bGF0ZSh0dG0pOwogfQpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfYmxpdC5jIGIvZHJpdmVy
cy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfYmxpdC5jCmluZGV4IGYyMTg4MWUwODdkYi4uZDAyMjhl
YjE2MTQ3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9ibGl0LmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfYmxpdC5jCkBAIC00NjUsMTMgKzQ2
NSwxMyBAQCBpbnQgdm13X2JvX2NwdV9ibGl0KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqZHN0
LAogCQlkbWFfcmVzdl9hc3NlcnRfaGVsZChzcmMtPmJhc2UucmVzdik7CiAKIAlpZiAoIXR0bV90
dF9pc19wb3B1bGF0ZWQoZHN0LT50dG0pKSB7Ci0JCXJldCA9IGRzdC0+YmRldi0+ZHJpdmVyLT50
dG1fdHRfcG9wdWxhdGUoZHN0LT5iZGV2LCBkc3QtPnR0bSwgJmN0eCk7CisJCXJldCA9IGRzdC0+
YmRldi0+ZnVuY3MtPnR0bV90dF9wb3B1bGF0ZShkc3QtPmJkZXYsIGRzdC0+dHRtLCAmY3R4KTsK
IAkJaWYgKHJldCkKIAkJCXJldHVybiByZXQ7CiAJfQogCiAJaWYgKCF0dG1fdHRfaXNfcG9wdWxh
dGVkKHNyYy0+dHRtKSkgewotCQlyZXQgPSBzcmMtPmJkZXYtPmRyaXZlci0+dHRtX3R0X3BvcHVs
YXRlKHNyYy0+YmRldiwgc3JjLT50dG0sICZjdHgpOworCQlyZXQgPSBzcmMtPmJkZXYtPmZ1bmNz
LT50dG1fdHRfcG9wdWxhdGUoc3JjLT5iZGV2LCBzcmMtPnR0bSwgJmN0eCk7CiAJCWlmIChyZXQp
CiAJCQlyZXR1cm4gcmV0OwogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngv
dm13Z2Z4X2JvLmMgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9iby5jCmluZGV4IDlh
NjZiYTI1NDMyNi4uY2Y4ZDlmMTE0NWRlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdm13
Z2Z4L3Ztd2dmeF9iby5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2JvLmMK
QEAgLTU0Niw3ICs1NDYsNyBAQCBpbnQgdm13X2JvX2luaXQoc3RydWN0IHZtd19wcml2YXRlICpk
ZXZfcHJpdiwKIAkJdm9pZCAoKmJvX2ZyZWUpKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8p
KQogewogCXN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0eCBjdHggPSB7IGludGVycnVwdGlibGUsIGZh
bHNlIH07Ci0Jc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYgPSAmZGV2X3ByaXYtPmJkZXY7CisJ
c3RydWN0IHR0bV9kZXZpY2UgKmJkZXYgPSAmZGV2X3ByaXYtPmJkZXY7CiAJc2l6ZV90IGFjY19z
aXplOwogCWludCByZXQ7CiAJYm9vbCB1c2VyID0gKGJvX2ZyZWUgPT0gJnZtd191c2VyX2JvX2Rl
c3Ryb3kpOwpAQCAtMTA1OCw3ICsxMDU4LDcgQEAgaW50IHZtd191c2VyX2JvX3JlZmVyZW5jZShz
dHJ1Y3QgdHRtX29iamVjdF9maWxlICp0ZmlsZSwKIHZvaWQgdm13X2JvX2ZlbmNlX3NpbmdsZShz
dHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQkJIHN0cnVjdCB2bXdfZmVuY2Vfb2JqICpm
ZW5jZSkKIHsKLQlzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiA9IGJvLT5iZGV2OworCXN0cnVj
dCB0dG1fZGV2aWNlICpiZGV2ID0gYm8tPmJkZXY7CiAKIAlzdHJ1Y3Qgdm13X3ByaXZhdGUgKmRl
dl9wcml2ID0KIAkJY29udGFpbmVyX29mKGJkZXYsIHN0cnVjdCB2bXdfcHJpdmF0ZSwgYmRldik7
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9kcnYuYyBiL2RyaXZl
cnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2Rydi5jCmluZGV4IGJkYjdhNWU5NjU2MC4uZmNkYTNi
NzZlMGRmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9kcnYuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9kcnYuYwpAQCAtODcyLDcgKzg3Miw3
IEBAIHN0YXRpYyBpbnQgdm13X2RyaXZlcl9sb2FkKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHVu
c2lnbmVkIGxvbmcgY2hpcHNldCkKIAlkcm1fdm1hX29mZnNldF9tYW5hZ2VyX2luaXQoJmRldl9w
cml2LT52bWFfbWFuYWdlciwKIAkJCQkgICAgRFJNX0ZJTEVfUEFHRV9PRkZTRVRfU1RBUlQsCiAJ
CQkJICAgIERSTV9GSUxFX1BBR0VfT0ZGU0VUX1NJWkUpOwotCXJldCA9IHR0bV9ib19kZXZpY2Vf
aW5pdCgmZGV2X3ByaXYtPmJkZXYsCisJcmV0ID0gdHRtX2RldmljZV9pbml0KCZkZXZfcHJpdi0+
YmRldiwKIAkJCQkgJnZtd19ib19kcml2ZXIsCiAJCQkJIGRldi0+YW5vbl9pbm9kZS0+aV9tYXBw
aW5nLAogCQkJCSAmZGV2X3ByaXYtPnZtYV9tYW5hZ2VyLApAQCAtOTkzLDcgKzk5Myw3IEBAIHN0
YXRpYyBpbnQgdm13X2RyaXZlcl9sb2FkKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHVuc2lnbmVk
IGxvbmcgY2hpcHNldCkKIAkJdm13X2dtcmlkX21hbl9maW5pKGRldl9wcml2LCBWTVdfUExfR01S
KTsKIAl2bXdfdnJhbV9tYW5hZ2VyX2ZpbmkoZGV2X3ByaXYpOwogb3V0X25vX3ZyYW06Ci0JKHZv
aWQpdHRtX2JvX2RldmljZV9yZWxlYXNlKCZkZXZfcHJpdi0+YmRldik7CisJKHZvaWQpdHRtX2Rl
dmljZV9yZWxlYXNlKCZkZXZfcHJpdi0+YmRldik7CiBvdXRfbm9fYmRldjoKIAl2bXdfZmVuY2Vf
bWFuYWdlcl90YWtlZG93bihkZXZfcHJpdi0+Zm1hbik7CiBvdXRfbm9fZm1hbjoKQEAgLTEwNDUs
NyArMTA0NSw3IEBAIHN0YXRpYyB2b2lkIHZtd19kcml2ZXJfdW5sb2FkKHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYpCiAJaWYgKGRldl9wcml2LT5oYXNfbW9iKQogCQl2bXdfZ21yaWRfbWFuX2Zpbmko
ZGV2X3ByaXYsIFZNV19QTF9NT0IpOwogCXZtd192cmFtX21hbmFnZXJfZmluaShkZXZfcHJpdik7
Ci0JKHZvaWQpIHR0bV9ib19kZXZpY2VfcmVsZWFzZSgmZGV2X3ByaXYtPmJkZXYpOworCSh2b2lk
KSB0dG1fZGV2aWNlX3JlbGVhc2UoJmRldl9wcml2LT5iZGV2KTsKIAlkcm1fdm1hX29mZnNldF9t
YW5hZ2VyX2Rlc3Ryb3koJmRldl9wcml2LT52bWFfbWFuYWdlcik7CiAJdm13X3JlbGVhc2VfZGV2
aWNlX2xhdGUoZGV2X3ByaXYpOwogCXZtd19mZW5jZV9tYW5hZ2VyX3Rha2Vkb3duKGRldl9wcml2
LT5mbWFuKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2Rydi5o
IGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfZHJ2LmgKaW5kZXggYjQ1YmVjYmIwMGY4
Li5jOGQzZTNlZWVkNDAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4
X2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2Rydi5oCkBAIC00OTAs
NyArNDkwLDcgQEAgZW51bSB2bXdfc21fdHlwZSB7CiB9OwogCiBzdHJ1Y3Qgdm13X3ByaXZhdGUg
ewotCXN0cnVjdCB0dG1fYm9fZGV2aWNlIGJkZXY7CisJc3RydWN0IHR0bV9kZXZpY2UgYmRldjsK
IAogCXN0cnVjdCB2bXdfZmlmb19zdGF0ZSBmaWZvOwogCkBAIC0xMDE0LDcgKzEwMTQsNyBAQCBl
eHRlcm4gc3RydWN0IHR0bV9wbGFjZW1lbnQgdm13X2V2aWN0YWJsZV9wbGFjZW1lbnQ7CiBleHRl
cm4gc3RydWN0IHR0bV9wbGFjZW1lbnQgdm13X3NyZl9wbGFjZW1lbnQ7CiBleHRlcm4gc3RydWN0
IHR0bV9wbGFjZW1lbnQgdm13X21vYl9wbGFjZW1lbnQ7CiBleHRlcm4gc3RydWN0IHR0bV9wbGFj
ZW1lbnQgdm13X25vbmZpeGVkX3BsYWNlbWVudDsKLWV4dGVybiBzdHJ1Y3QgdHRtX2JvX2RyaXZl
ciB2bXdfYm9fZHJpdmVyOworZXh0ZXJuIHN0cnVjdCB0dG1fZGV2aWNlX2Z1bmNzIHZtd19ib19k
cml2ZXI7CiBleHRlcm4gY29uc3Qgc3RydWN0IHZtd19zZ190YWJsZSAqCiB2bXdfYm9fc2dfdGFi
bGUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibyk7CiBleHRlcm4gaW50IHZtd19ib19jcmVh
dGVfYW5kX3BvcHVsYXRlKHN0cnVjdCB2bXdfcHJpdmF0ZSAqZGV2X3ByaXYsCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9yZXNvdXJjZS5jIGIvZHJpdmVycy9ncHUv
ZHJtL3Ztd2dmeC92bXdnZnhfcmVzb3VyY2UuYwppbmRleCA1ZTkyMmQ5ZDVmMmMuLjIwNTQyNDAx
N2UyMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfcmVzb3VyY2Uu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9yZXNvdXJjZS5jCkBAIC04NTgs
NyArODU4LDcgQEAgdm9pZCB2bXdfcXVlcnlfbW92ZV9ub3RpZnkoc3RydWN0IHR0bV9idWZmZXJf
b2JqZWN0ICpibywKIAkJCSAgIHN0cnVjdCB0dG1fcmVzb3VyY2UgKm1lbSkKIHsKIAlzdHJ1Y3Qg
dm13X2J1ZmZlcl9vYmplY3QgKmR4X3F1ZXJ5X21vYjsKLQlzdHJ1Y3QgdHRtX2JvX2RldmljZSAq
YmRldiA9IGJvLT5iZGV2OworCXN0cnVjdCB0dG1fZGV2aWNlICpiZGV2ID0gYm8tPmJkZXY7CiAJ
c3RydWN0IHZtd19wcml2YXRlICpkZXZfcHJpdjsKIAogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vdm13Z2Z4L3Ztd2dmeF90dG1fYnVmZmVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4
L3Ztd2dmeF90dG1fYnVmZmVyLmMKaW5kZXggOTc1ZDA2YzJlMzVlLi44MWFlY2Q3MmE5NzEgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X3R0bV9idWZmZXIuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF90dG1fYnVmZmVyLmMKQEAgLTQ4OSw3ICs0
ODksNyBAQCBjb25zdCBzdHJ1Y3Qgdm13X3NnX3RhYmxlICp2bXdfYm9fc2dfdGFibGUoc3RydWN0
IHR0bV9idWZmZXJfb2JqZWN0ICpibykKIH0KIAogCi1zdGF0aWMgaW50IHZtd190dG1fYmluZChz
dHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKK3N0YXRpYyBpbnQgdm13X3R0bV9iaW5kKHN0cnVj
dCB0dG1fZGV2aWNlICpiZGV2LAogCQkJc3RydWN0IHR0bV90dCAqdHRtLCBzdHJ1Y3QgdHRtX3Jl
c291cmNlICpib19tZW0pCiB7CiAJc3RydWN0IHZtd190dG1fdHQgKnZtd19iZSA9CkBAIC01MzMs
NyArNTMzLDcgQEAgc3RhdGljIGludCB2bXdfdHRtX2JpbmQoc3RydWN0IHR0bV9ib19kZXZpY2Ug
KmJkZXYsCiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIHZvaWQgdm13X3R0bV91bmJpbmQoc3Ry
dWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCitzdGF0aWMgdm9pZCB2bXdfdHRtX3VuYmluZChzdHJ1
Y3QgdHRtX2RldmljZSAqYmRldiwKIAkJCSAgIHN0cnVjdCB0dG1fdHQgKnR0bSkKIHsKIAlzdHJ1
Y3Qgdm13X3R0bV90dCAqdm13X2JlID0KQEAgLTU1OSw3ICs1NTksNyBAQCBzdGF0aWMgdm9pZCB2
bXdfdHRtX3VuYmluZChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKIH0KIAogCi1zdGF0aWMg
dm9pZCB2bXdfdHRtX2Rlc3Ryb3koc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0
dG1fdHQgKnR0bSkKK3N0YXRpYyB2b2lkIHZtd190dG1fZGVzdHJveShzdHJ1Y3QgdHRtX2Rldmlj
ZSAqYmRldiwgc3RydWN0IHR0bV90dCAqdHRtKQogewogCXN0cnVjdCB2bXdfdHRtX3R0ICp2bXdf
YmUgPQogCQljb250YWluZXJfb2YodHRtLCBzdHJ1Y3Qgdm13X3R0bV90dCwgZG1hX3R0bS50dG0p
OwpAQCAtNTc5LDcgKzU3OSw3IEBAIHN0YXRpYyB2b2lkIHZtd190dG1fZGVzdHJveShzdHJ1Y3Qg
dHRtX2JvX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV90dCAqdHRtKQogfQogCiAKLXN0YXRpYyBp
bnQgdm13X3R0bV9wb3B1bGF0ZShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKK3N0YXRpYyBp
bnQgdm13X3R0bV9wb3B1bGF0ZShzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwKIAkJCSAgICBzdHJ1
Y3QgdHRtX3R0ICp0dG0sIHN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0eCAqY3R4KQogewogCXN0cnVj
dCB2bXdfdHRtX3R0ICp2bXdfdHQgPQpAQCAtNjA4LDcgKzYwOCw3IEBAIHN0YXRpYyBpbnQgdm13
X3R0bV9wb3B1bGF0ZShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKIAlyZXR1cm4gcmV0Owog
fQogCi1zdGF0aWMgdm9pZCB2bXdfdHRtX3VucG9wdWxhdGUoc3RydWN0IHR0bV9ib19kZXZpY2Ug
KmJkZXYsCitzdGF0aWMgdm9pZCB2bXdfdHRtX3VucG9wdWxhdGUoc3RydWN0IHR0bV9kZXZpY2Ug
KmJkZXYsCiAJCQkgICAgICAgc3RydWN0IHR0bV90dCAqdHRtKQogewogCXN0cnVjdCB2bXdfdHRt
X3R0ICp2bXdfdHQgPSBjb250YWluZXJfb2YodHRtLCBzdHJ1Y3Qgdm13X3R0bV90dCwKQEAgLTY3
NSw3ICs2NzUsNyBAQCBzdGF0aWMgaW50IHZtd192ZXJpZnlfYWNjZXNzKHN0cnVjdCB0dG1fYnVm
ZmVyX29iamVjdCAqYm8sIHN0cnVjdCBmaWxlICpmaWxwKQogCXJldHVybiB2bXdfdXNlcl9ib192
ZXJpZnlfYWNjZXNzKGJvLCB0ZmlsZSk7CiB9CiAKLXN0YXRpYyBpbnQgdm13X3R0bV9pb19tZW1f
cmVzZXJ2ZShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV9yZXNvdXJjZSAq
bWVtKQorc3RhdGljIGludCB2bXdfdHRtX2lvX21lbV9yZXNlcnZlKHN0cnVjdCB0dG1fZGV2aWNl
ICpiZGV2LCBzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0pCiB7CiAJc3RydWN0IHZtd19wcml2YXRl
ICpkZXZfcHJpdiA9IGNvbnRhaW5lcl9vZihiZGV2LCBzdHJ1Y3Qgdm13X3ByaXZhdGUsIGJkZXYp
OwogCkBAIC03MjcsNyArNzI3LDcgQEAgc3RhdGljIHZvaWQgdm13X3N3YXBfbm90aWZ5KHN0cnVj
dCB0dG1fYnVmZmVyX29iamVjdCAqYm8pCiB9CiAKIAotc3RydWN0IHR0bV9ib19kcml2ZXIgdm13
X2JvX2RyaXZlciA9IHsKK3N0cnVjdCB0dG1fZGV2aWNlX2Z1bmNzIHZtd19ib19kcml2ZXIgPSB7
CiAJLnR0bV90dF9jcmVhdGUgPSAmdm13X3R0bV90dF9jcmVhdGUsCiAJLnR0bV90dF9wb3B1bGF0
ZSA9ICZ2bXdfdHRtX3BvcHVsYXRlLAogCS50dG1fdHRfdW5wb3B1bGF0ZSA9ICZ2bXdfdHRtX3Vu
cG9wdWxhdGUsCmRpZmYgLS1naXQgYS9pbmNsdWRlL2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmgg
Yi9pbmNsdWRlL2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmgKaW5kZXggMTI4Zjg4MTc0ZDMyLi41
ZTkyZDcwMTQxMjUgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvZHJtL2RybV9nZW1fdnJhbV9oZWxwZXIu
aAorKysgYi9pbmNsdWRlL2RybS9kcm1fZ2VtX3ZyYW1faGVscGVyLmgKQEAgLTE3MiwxOSArMTcy
LDE5IEBAIHN0cnVjdCBkcm1fdnJhbV9tbSB7CiAJdWludDY0X3QgdnJhbV9iYXNlOwogCXNpemVf
dCB2cmFtX3NpemU7CiAKLQlzdHJ1Y3QgdHRtX2JvX2RldmljZSBiZGV2OworCXN0cnVjdCB0dG1f
ZGV2aWNlIGJkZXY7CiB9OwogCiAvKioKICAqIGRybV92cmFtX21tX29mX2JkZXYoKSAtIFwKLQlS
ZXR1cm5zIHRoZSBjb250YWluZXIgb2YgdHlwZSAmc3RydWN0IHR0bV9ib19kZXZpY2UgZm9yIGZp
ZWxkIGJkZXYuCisJUmV0dXJucyB0aGUgY29udGFpbmVyIG9mIHR5cGUgJnN0cnVjdCB0dG1fZGV2
aWNlIGZvciBmaWVsZCBiZGV2LgogICogQGJkZXY6CXRoZSBUVE0gQk8gZGV2aWNlCiAgKgogICog
UmV0dXJuczoKICAqIFRoZSBjb250YWluaW5nIGluc3RhbmNlIG9mICZzdHJ1Y3QgZHJtX3ZyYW1f
bW0KICAqLwogc3RhdGljIGlubGluZSBzdHJ1Y3QgZHJtX3ZyYW1fbW0gKmRybV92cmFtX21tX29m
X2JkZXYoCi0Jc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYpCisJc3RydWN0IHR0bV9kZXZpY2Ug
KmJkZXYpCiB7CiAJcmV0dXJuIGNvbnRhaW5lcl9vZihiZGV2LCBzdHJ1Y3QgZHJtX3ZyYW1fbW0s
IGJkZXYpOwogfQpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0vdHRtL3R0bV9ib19hcGkuaCBiL2lu
Y2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmgKaW5kZXggYzk2YTI1ZDU3MWM4Li5hMDI5MzVlMGQx
MjEgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fYXBpLmgKKysrIGIvaW5jbHVk
ZS9kcm0vdHRtL3R0bV9ib19hcGkuaApAQCAtNDQsOSArNDQsOSBAQAogCiAjaW5jbHVkZSAidHRt
X3Jlc291cmNlLmgiCiAKLXN0cnVjdCB0dG1fYm9fZ2xvYmFsOworc3RydWN0IHR0bV9nbG9iYWw7
CiAKLXN0cnVjdCB0dG1fYm9fZGV2aWNlOworc3RydWN0IHR0bV9kZXZpY2U7CiAKIHN0cnVjdCBk
cm1fbW1fbm9kZTsKIApAQCAtMTIwLDcgKzEyMCw3IEBAIHN0cnVjdCB0dG1fYnVmZmVyX29iamVj
dCB7CiAJICogTWVtYmVycyBjb25zdGFudCBhdCBpbml0LgogCSAqLwogCi0Jc3RydWN0IHR0bV9i
b19kZXZpY2UgKmJkZXY7CisJc3RydWN0IHR0bV9kZXZpY2UgKmJkZXY7CiAJZW51bSB0dG1fYm9f
dHlwZSB0eXBlOwogCXZvaWQgKCpkZXN0cm95KSAoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICop
OwogCXVuc2lnbmVkIGxvbmcgbnVtX3BhZ2VzOwpAQCAtMzEwLDcgKzMxMCw3IEBAIHZvaWQgdHRt
X2JvX3B1dChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvKTsKICAqIEBidWxrOiBvcHRpb25h
bCBidWxrIG1vdmUgc3RydWN0dXJlIHRvIHJlbWVtYmVyIEJPIHBvc2l0aW9ucwogICoKICAqIE1v
dmUgdGhpcyBCTyB0byB0aGUgdGFpbCBvZiBhbGwgbHJ1IGxpc3RzIHVzZWQgdG8gbG9va3VwIGFu
ZCByZXNlcnZlIGFuCi0gKiBvYmplY3QuIFRoaXMgZnVuY3Rpb24gbXVzdCBiZSBjYWxsZWQgd2l0
aCBzdHJ1Y3QgdHRtX2JvX2dsb2JhbDo6bHJ1X2xvY2sKKyAqIG9iamVjdC4gVGhpcyBmdW5jdGlv
biBtdXN0IGJlIGNhbGxlZCB3aXRoIHN0cnVjdCB0dG1fZ2xvYmFsOjpscnVfbG9jawogICogaGVs
ZCwgYW5kIGlzIHVzZWQgdG8gbWFrZSBhIEJPIGxlc3MgbGlrZWx5IHRvIGJlIGNvbnNpZGVyZWQg
Zm9yIGV2aWN0aW9uLgogICovCiB2b2lkIHR0bV9ib19tb3ZlX3RvX2xydV90YWlsKHN0cnVjdCB0
dG1fYnVmZmVyX29iamVjdCAqYm8sCkBAIC0zMjIsNyArMzIyLDcgQEAgdm9pZCB0dG1fYm9fbW92
ZV90b19scnVfdGFpbChzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogICogQGJ1bGs6IGJ1
bGsgbW92ZSBzdHJ1Y3R1cmUKICAqCiAgKiBCdWxrIG1vdmUgQk9zIHRvIHRoZSBMUlUgdGFpbCwg
b25seSB2YWxpZCB0byB1c2Ugd2hlbiBkcml2ZXIgbWFrZXMgc3VyZSB0aGF0Ci0gKiBCTyBvcmRl
ciBuZXZlciBjaGFuZ2VzLiBTaG91bGQgYmUgY2FsbGVkIHdpdGggdHRtX2JvX2dsb2JhbDo6bHJ1
X2xvY2sgaGVsZC4KKyAqIEJPIG9yZGVyIG5ldmVyIGNoYW5nZXMuIFNob3VsZCBiZSBjYWxsZWQg
d2l0aCB0dG1fZ2xvYmFsOjpscnVfbG9jayBoZWxkLgogICovCiB2b2lkIHR0bV9ib19idWxrX21v
dmVfbHJ1X3RhaWwoc3RydWN0IHR0bV9scnVfYnVsa19tb3ZlICpidWxrKTsKIApAQCAtMzMzLDE0
ICszMzMsMTQgQEAgdm9pZCB0dG1fYm9fYnVsa19tb3ZlX2xydV90YWlsKHN0cnVjdCB0dG1fbHJ1
X2J1bGtfbW92ZSAqYnVsayk7CiAgKiBSZXR1cm5zCiAgKiBUcnVlIGlmIHRoZSB3b3JrcXVldWUg
d2FzIHF1ZXVlZCBhdCB0aGUgdGltZQogICovCi1pbnQgdHRtX2JvX2xvY2tfZGVsYXllZF93b3Jr
cXVldWUoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYpOworaW50IHR0bV9ib19sb2NrX2RlbGF5
ZWRfd29ya3F1ZXVlKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2KTsKIAogLyoqCiAgKiB0dG1fYm9f
dW5sb2NrX2RlbGF5ZWRfd29ya3F1ZXVlCiAgKgogICogQWxsb3dzIHRoZSBkZWxheWVkIHdvcmtx
dWV1ZSB0byBydW4uCiAgKi8KLXZvaWQgdHRtX2JvX3VubG9ja19kZWxheWVkX3dvcmtxdWV1ZShz
dHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwgaW50IHJlc2NoZWQpOwordm9pZCB0dG1fYm9fdW5s
b2NrX2RlbGF5ZWRfd29ya3F1ZXVlKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LCBpbnQgcmVzY2hl
ZCk7CiAKIC8qKgogICogdHRtX2JvX2V2aWN0aW9uX3ZhbHVhYmxlCkBAIC0zNTMsMTQgKzM1Mywx
NCBAQCB2b2lkIHR0bV9ib191bmxvY2tfZGVsYXllZF93b3JrcXVldWUoc3RydWN0IHR0bV9ib19k
ZXZpY2UgKmJkZXYsIGludCByZXNjaGVkKTsKIGJvb2wgdHRtX2JvX2V2aWN0aW9uX3ZhbHVhYmxl
KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJCQkgICAgICBjb25zdCBzdHJ1Y3QgdHRt
X3BsYWNlICpwbGFjZSk7CiAKLXNpemVfdCB0dG1fYm9fZG1hX2FjY19zaXplKHN0cnVjdCB0dG1f
Ym9fZGV2aWNlICpiZGV2LAorc2l6ZV90IHR0bV9ib19kbWFfYWNjX3NpemUoc3RydWN0IHR0bV9k
ZXZpY2UgKmJkZXYsCiAJCQkgICB1bnNpZ25lZCBsb25nIGJvX3NpemUsCiAJCQkgICB1bnNpZ25l
ZCBzdHJ1Y3Rfc2l6ZSk7CiAKIC8qKgogICogdHRtX2JvX2luaXRfcmVzZXJ2ZWQKICAqCi0gKiBA
YmRldjogUG9pbnRlciB0byBhIHR0bV9ib19kZXZpY2Ugc3RydWN0LgorICogQGJkZXY6IFBvaW50
ZXIgdG8gYSB0dG1fZGV2aWNlIHN0cnVjdC4KICAqIEBibzogUG9pbnRlciB0byBhIHR0bV9idWZm
ZXJfb2JqZWN0IHRvIGJlIGluaXRpYWxpemVkLgogICogQHNpemU6IFJlcXVlc3RlZCBzaXplIG9m
IGJ1ZmZlciBvYmplY3QuCiAgKiBAdHlwZTogUmVxdWVzdGVkIHR5cGUgb2YgYnVmZmVyIG9iamVj
dC4KQEAgLTM5Miw3ICszOTIsNyBAQCBzaXplX3QgdHRtX2JvX2RtYV9hY2Nfc2l6ZShzdHJ1Y3Qg
dHRtX2JvX2RldmljZSAqYmRldiwKICAqIC1FUkVTVEFSVFNZUzogSW50ZXJydXB0ZWQgYnkgc2ln
bmFsIHdoaWxlIHNsZWVwaW5nIHdhaXRpbmcgZm9yIHJlc291cmNlcy4KICAqLwogCi1pbnQgdHRt
X2JvX2luaXRfcmVzZXJ2ZWQoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCitpbnQgdHRtX2Jv
X2luaXRfcmVzZXJ2ZWQoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsCiAJCQkgc3RydWN0IHR0bV9i
dWZmZXJfb2JqZWN0ICpibywKIAkJCSB1bnNpZ25lZCBsb25nIHNpemUsCiAJCQkgZW51bSB0dG1f
Ym9fdHlwZSB0eXBlLApAQCAtNDA3LDcgKzQwNyw3IEBAIGludCB0dG1fYm9faW5pdF9yZXNlcnZl
ZChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKIC8qKgogICogdHRtX2JvX2luaXQKICAqCi0g
KiBAYmRldjogUG9pbnRlciB0byBhIHR0bV9ib19kZXZpY2Ugc3RydWN0LgorICogQGJkZXY6IFBv
aW50ZXIgdG8gYSB0dG1fZGV2aWNlIHN0cnVjdC4KICAqIEBibzogUG9pbnRlciB0byBhIHR0bV9i
dWZmZXJfb2JqZWN0IHRvIGJlIGluaXRpYWxpemVkLgogICogQHNpemU6IFJlcXVlc3RlZCBzaXpl
IG9mIGJ1ZmZlciBvYmplY3QuCiAgKiBAdHlwZTogUmVxdWVzdGVkIHR5cGUgb2YgYnVmZmVyIG9i
amVjdC4KQEAgLTQ0MSw3ICs0NDEsNyBAQCBpbnQgdHRtX2JvX2luaXRfcmVzZXJ2ZWQoc3RydWN0
IHR0bV9ib19kZXZpY2UgKmJkZXYsCiAgKiAtRUlOVkFMOiBJbnZhbGlkIHBsYWNlbWVudCBmbGFn
cy4KICAqIC1FUkVTVEFSVFNZUzogSW50ZXJydXB0ZWQgYnkgc2lnbmFsIHdoaWxlIHNsZWVwaW5n
IHdhaXRpbmcgZm9yIHJlc291cmNlcy4KICAqLwotaW50IHR0bV9ib19pbml0KHN0cnVjdCB0dG1f
Ym9fZGV2aWNlICpiZGV2LCBzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAoraW50IHR0bV9i
b19pbml0KHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LCBzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3Qg
KmJvLAogCQl1bnNpZ25lZCBsb25nIHNpemUsIGVudW0gdHRtX2JvX3R5cGUgdHlwZSwKIAkJc3Ry
dWN0IHR0bV9wbGFjZW1lbnQgKnBsYWNlbWVudCwKIAkJdWludDMyX3QgcGFnZV9hbGlnbm1lbnQs
IGJvb2wgaW50ZXJydWJ0aWJsZSwgc2l6ZV90IGFjY19zaXplLApAQCAtNDUxLDcgKzQ1MSw3IEBA
IGludCB0dG1fYm9faW5pdChzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV9i
dWZmZXJfb2JqZWN0ICpibywKIC8qKgogICogdHRtX2JvX2V2aWN0X21tCiAgKgotICogQGJkZXY6
IFBvaW50ZXIgdG8gYSB0dG1fYm9fZGV2aWNlIHN0cnVjdC4KKyAqIEBiZGV2OiBQb2ludGVyIHRv
IGEgdHRtX2RldmljZSBzdHJ1Y3QuCiAgKiBAbWVtX3R5cGU6IFRoZSBtZW1vcnkgdHlwZS4KICAq
CiAgKiBFdmljdHMgYWxsIGJ1ZmZlcnMgb24gdGhlIGxydSBsaXN0IG9mIHRoZSBtZW1vcnkgdHlw
ZS4KQEAgLTQ1OSwxNCArNDU5LDE0IEBAIGludCB0dG1fYm9faW5pdChzdHJ1Y3QgdHRtX2JvX2Rl
dmljZSAqYmRldiwgc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKICAqIG91dC1vZi1tZW1v
cnktc3BhY2UtZHVlLXRvLWZyYWdtZW50YXRpb24gaGFuZGxlci4KICAqIFRoZSBjYWxsZXIgbXVz
dCBtYWtlIHN1cmUgdGhhdCB0aGVyZSBhcmUgbm8gb3RoZXIgcHJvY2Vzc2VzCiAgKiBjdXJyZW50
bHkgdmFsaWRhdGluZyBidWZmZXJzLCBhbmQgY2FuIGRvIHRoYXQgYnkgdGFraW5nIHRoZQotICog
c3RydWN0IHR0bV9ib19kZXZpY2U6OnR0bV9sb2NrIGluIHdyaXRlIG1vZGUuCisgKiBzdHJ1Y3Qg
dHRtX2RldmljZTo6dHRtX2xvY2sgaW4gd3JpdGUgbW9kZS4KICAqCiAgKiBSZXR1cm5zOgogICog
LUVJTlZBTDogSW52YWxpZCBvciB1bmluaXRpYWxpemVkIG1lbW9yeSB0eXBlLgogICogLUVSRVNU
QVJUU1lTOiBUaGUgY2FsbCB3YXMgaW50ZXJydXB0ZWQgYnkgYSBzaWduYWwgd2hpbGUgd2FpdGlu
ZyB0bwogICogZXZpY3QgYSBidWZmZXIuCiAgKi8KLWludCB0dG1fYm9fZXZpY3RfbW0oc3RydWN0
IHR0bV9ib19kZXZpY2UgKmJkZXYsIHVuc2lnbmVkIG1lbV90eXBlKTsKK2ludCB0dG1fYm9fZXZp
Y3RfbW0oc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIHVuc2lnbmVkIG1lbV90eXBlKTsKIAogLyoq
CiAgKiB0dG1fa21hcF9vYmpfdmlydHVhbApAQCAtNTI5LDE4ICs1MjksMTggQEAgaW50IHR0bV9i
b19tbWFwX29iaihzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSwgc3RydWN0IHR0bV9idWZmZXJf
b2JqZWN0ICpibyk7CiAgKgogICogQGZpbHA6ICAgICAgZmlscCBhcyBpbnB1dCBmcm9tIHRoZSBt
bWFwIG1ldGhvZC4KICAqIEB2bWE6ICAgICAgIHZtYSBhcyBpbnB1dCBmcm9tIHRoZSBtbWFwIG1l
dGhvZC4KLSAqIEBiZGV2OiAgICAgIFBvaW50ZXIgdG8gdGhlIHR0bV9ib19kZXZpY2Ugd2l0aCB0
aGUgYWRkcmVzcyBzcGFjZSBtYW5hZ2VyLgorICogQGJkZXY6ICAgICAgUG9pbnRlciB0byB0aGUg
dHRtX2RldmljZSB3aXRoIHRoZSBhZGRyZXNzIHNwYWNlIG1hbmFnZXIuCiAgKgogICogVGhpcyBm
dW5jdGlvbiBpcyBpbnRlbmRlZCB0byBiZSBjYWxsZWQgYnkgdGhlIGRldmljZSBtbWFwIG1ldGhv
ZC4KICAqIGlmIHRoZSBkZXZpY2UgYWRkcmVzcyBzcGFjZSBpcyB0byBiZSBiYWNrZWQgYnkgdGhl
IGJvIG1hbmFnZXIuCiAgKi8KIGludCB0dG1fYm9fbW1hcChzdHJ1Y3QgZmlsZSAqZmlscCwgc3Ry
dWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsCi0JCXN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2KTsK
KwkJc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYpOwogCiAvKioKICAqIHR0bV9ib19pbwogICoKLSAq
IEBiZGV2OiAgICAgIFBvaW50ZXIgdG8gdGhlIHN0cnVjdCB0dG1fYm9fZGV2aWNlLgorICogQGJk
ZXY6ICAgICAgUG9pbnRlciB0byB0aGUgc3RydWN0IHR0bV9kZXZpY2UuCiAgKiBAZmlscDogICAg
ICBQb2ludGVyIHRvIHRoZSBzdHJ1Y3QgZmlsZSBhdHRlbXB0aW5nIHRvIHJlYWQgLyB3cml0ZS4K
ICAqIEB3YnVmOiAgICAgIFVzZXItc3BhY2UgcG9pbnRlciB0byBhZGRyZXNzIG9mIGJ1ZmZlciB0
byB3cml0ZS4gTlVMTCBvbiByZWFkLgogICogQHJidWY6ICAgICAgVXNlci1zcGFjZSBwb2ludGVy
IHRvIGFkZHJlc3Mgb2YgYnVmZmVyIHRvIHJlYWQgaW50by4KQEAgLTU1NywxMiArNTU3LDExIEBA
IGludCB0dG1fYm9fbW1hcChzdHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0IHZtX2FyZWFfc3RydWN0
ICp2bWEsCiAgKiB0aGUgZnVuY3Rpb24gbWF5IHJldHVybiAtRVJFU1RBUlRTWVMgaWYKICAqIGlu
dGVycnVwdGVkIGJ5IGEgc2lnbmFsLgogICovCi1zc2l6ZV90IHR0bV9ib19pbyhzdHJ1Y3QgdHRt
X2JvX2RldmljZSAqYmRldiwgc3RydWN0IGZpbGUgKmZpbHAsCitzc2l6ZV90IHR0bV9ib19pbyhz
dHJ1Y3QgdHRtX2RldmljZSAqYmRldiwgc3RydWN0IGZpbGUgKmZpbHAsCiAJCSAgY29uc3QgY2hh
ciBfX3VzZXIgKndidWYsIGNoYXIgX191c2VyICpyYnVmLAogCQkgIHNpemVfdCBjb3VudCwgbG9m
Zl90ICpmX3BvcywgYm9vbCB3cml0ZSk7CiAKLWludCB0dG1fYm9fc3dhcG91dChzdHJ1Y3QgdHRt
X2JvX2dsb2JhbCAqZ2xvYiwKLQkJCXN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0eCAqY3R4KTsKK2lu
dCB0dG1fYm9fc3dhcG91dChzdHJ1Y3QgdHRtX2dsb2JhbCAqZ2xvYiwgc3RydWN0IHR0bV9vcGVy
YXRpb25fY3R4ICpjdHgpOwogdm9pZCB0dG1fYm9fc3dhcG91dF9hbGwodm9pZCk7CiAKIC8qKgpA
QCAtNjA5LDcgKzYwOCw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCB0dG1fYm9fdW5waW4oc3RydWN0
IHR0bV9idWZmZXJfb2JqZWN0ICpibykKIAktLWJvLT5waW5fY291bnQ7CiB9CiAKLWludCB0dG1f
bWVtX2V2aWN0X2ZpcnN0KHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAoraW50IHR0bV9tZW1f
ZXZpY3RfZmlyc3Qoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsCiAJCQlzdHJ1Y3QgdHRtX3Jlc291
cmNlX21hbmFnZXIgKm1hbiwKIAkJCWNvbnN0IHN0cnVjdCB0dG1fcGxhY2UgKnBsYWNlLAogCQkJ
c3RydWN0IHR0bV9vcGVyYXRpb25fY3R4ICpjdHgsCkBAIC02MzQsNSArNjMzLDYgQEAgdm9pZCB0
dG1fYm9fdm1fY2xvc2Uoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEpOwogCiBpbnQgdHRtX2Jv
X3ZtX2FjY2VzcyhzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSwgdW5zaWduZWQgbG9uZyBhZGRy
LAogCQkgICAgIHZvaWQgKmJ1ZiwgaW50IGxlbiwgaW50IHdyaXRlKTsKK2Jvb2wgdHRtX2JvX2Rl
bGF5ZWRfZGVsZXRlKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LCBib29sIHJlbW92ZV9hbGwpOwog
CiAjZW5kaWYKZGlmZiAtLWdpdCBhL2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fZHJpdmVyLmggYi9p
bmNsdWRlL2RybS90dG0vdHRtX2JvX2RyaXZlci5oCmluZGV4IGEwMjhiNDE4YzZiNC4uNjM4MDFm
YTllOTkzIDEwMDY0NAotLS0gYS9pbmNsdWRlL2RybS90dG0vdHRtX2JvX2RyaXZlci5oCisrKyBi
L2luY2x1ZGUvZHJtL3R0bS90dG1fYm9fZHJpdmVyLmgKQEAgLTM3LDMzMSArMzcsMTQgQEAKICNp
bmNsdWRlIDxsaW51eC9zcGlubG9jay5oPgogI2luY2x1ZGUgPGxpbnV4L2RtYS1yZXN2Lmg+CiAK
KyNpbmNsdWRlIDxkcm0vdHRtL3R0bV9kZXZpY2UuaD4KKwogI2luY2x1ZGUgInR0bV9ib19hcGku
aCIKICNpbmNsdWRlICJ0dG1fbWVtb3J5LmgiCiAjaW5jbHVkZSAidHRtX21vZHVsZS5oIgogI2lu
Y2x1ZGUgInR0bV9wbGFjZW1lbnQuaCIKICNpbmNsdWRlICJ0dG1fdHQuaCIKIAotLyoqCi0gKiBz
dHJ1Y3QgdHRtX2JvX2RyaXZlcgotICoKLSAqIEBjcmVhdGVfdHRtX2JhY2tlbmRfZW50cnk6IENh
bGxiYWNrIHRvIGNyZWF0ZSBhIHN0cnVjdCB0dG1fYmFja2VuZC4KLSAqIEBldmljdF9mbGFnczog
Q2FsbGJhY2sgdG8gb2J0YWluIHBsYWNlbWVudCBmbGFncyB3aGVuIGEgYnVmZmVyIGlzIGV2aWN0
ZWQuCi0gKiBAbW92ZTogQ2FsbGJhY2sgZm9yIGEgZHJpdmVyIHRvIGhvb2sgaW4gYWNjZWxlcmF0
ZWQgZnVuY3Rpb25zIHRvCi0gKiBtb3ZlIGEgYnVmZmVyLgotICogSWYgc2V0IHRvIE5VTEwsIGEg
cG90ZW50aWFsbHkgc2xvdyBtZW1jcHkoKSBtb3ZlIGlzIHVzZWQuCi0gKi8KLQotc3RydWN0IHR0
bV9ib19kcml2ZXIgewotCS8qKgotCSAqIHR0bV90dF9jcmVhdGUKLQkgKgotCSAqIEBibzogVGhl
IGJ1ZmZlciBvYmplY3QgdG8gY3JlYXRlIHRoZSB0dG0gZm9yLgotCSAqIEBwYWdlX2ZsYWdzOiBQ
YWdlIGZsYWdzIGFzIGlkZW50aWZpZWQgYnkgVFRNX1BBR0VfRkxBR19YWCBmbGFncy4KLQkgKgot
CSAqIENyZWF0ZSBhIHN0cnVjdCB0dG1fdHQgdG8gYmFjayBkYXRhIHdpdGggc3lzdGVtIG1lbW9y
eSBwYWdlcy4KLQkgKiBObyBwYWdlcyBhcmUgYWN0dWFsbHkgYWxsb2NhdGVkLgotCSAqIFJldHVy
bnM6Ci0JICogTlVMTDogT3V0IG9mIG1lbW9yeS4KLQkgKi8KLQlzdHJ1Y3QgdHRtX3R0ICooKnR0
bV90dF9jcmVhdGUpKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCi0JCQkJCXVpbnQzMl90
IHBhZ2VfZmxhZ3MpOwotCi0JLyoqCi0JICogdHRtX3R0X3BvcHVsYXRlCi0JICoKLQkgKiBAdHRt
OiBUaGUgc3RydWN0IHR0bV90dCB0byBjb250YWluIHRoZSBiYWNraW5nIHBhZ2VzLgotCSAqCi0J
ICogQWxsb2NhdGUgYWxsIGJhY2tpbmcgcGFnZXMKLQkgKiBSZXR1cm5zOgotCSAqIC1FTk9NRU06
IE91dCBvZiBtZW1vcnkuCi0JICovCi0JaW50ICgqdHRtX3R0X3BvcHVsYXRlKShzdHJ1Y3QgdHRt
X2JvX2RldmljZSAqYmRldiwKLQkJCSAgICAgICBzdHJ1Y3QgdHRtX3R0ICp0dG0sCi0JCQkgICAg
ICAgc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4ICpjdHgpOwotCi0JLyoqCi0JICogdHRtX3R0X3Vu
cG9wdWxhdGUKLQkgKgotCSAqIEB0dG06IFRoZSBzdHJ1Y3QgdHRtX3R0IHRvIGNvbnRhaW4gdGhl
IGJhY2tpbmcgcGFnZXMuCi0JICoKLQkgKiBGcmVlIGFsbCBiYWNraW5nIHBhZ2UKLQkgKi8KLQl2
b2lkICgqdHRtX3R0X3VucG9wdWxhdGUpKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LCBzdHJ1
Y3QgdHRtX3R0ICp0dG0pOwotCi0JLyoqCi0JICogdHRtX3R0X2JpbmQKLQkgKgotCSAqIEBiZGV2
OiBQb2ludGVyIHRvIGEgdHRtIGRldmljZQotCSAqIEB0dG06IFBvaW50ZXIgdG8gYSBzdHJ1Y3Qg
dHRtX3R0LgotCSAqIEBib19tZW06IFBvaW50ZXIgdG8gYSBzdHJ1Y3QgdHRtX3Jlc291cmNlIGRl
c2NyaWJpbmcgdGhlCi0JICogbWVtb3J5IHR5cGUgYW5kIGxvY2F0aW9uIGZvciBiaW5kaW5nLgot
CSAqCi0JICogQmluZCB0aGUgYmFja2VuZCBwYWdlcyBpbnRvIHRoZSBhcGVydHVyZSBpbiB0aGUg
bG9jYXRpb24KLQkgKiBpbmRpY2F0ZWQgYnkgQGJvX21lbS4gVGhpcyBmdW5jdGlvbiBzaG91bGQg
YmUgYWJsZSB0byBoYW5kbGUKLQkgKiBkaWZmZXJlbmNlcyBiZXR3ZWVuIGFwZXJ0dXJlIGFuZCBz
eXN0ZW0gcGFnZSBzaXplcy4KLQkgKi8KLQlpbnQgKCp0dG1fdHRfYmluZCkoc3RydWN0IHR0bV9i
b19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSwgc3RydWN0IHR0bV9yZXNvdXJjZSAq
Ym9fbWVtKTsKLQotCS8qKgotCSAqIHR0bV90dF91bmJpbmQKLQkgKgotCSAqIEBiZGV2OiBQb2lu
dGVyIHRvIGEgdHRtIGRldmljZQotCSAqIEB0dG06IFBvaW50ZXIgdG8gYSBzdHJ1Y3QgdHRtX3R0
LgotCSAqCi0JICogVW5iaW5kIHByZXZpb3VzbHkgYm91bmQgYmFja2VuZCBwYWdlcy4gVGhpcyBm
dW5jdGlvbiBzaG91bGQgYmUKLQkgKiBhYmxlIHRvIGhhbmRsZSBkaWZmZXJlbmNlcyBiZXR3ZWVu
IGFwZXJ0dXJlIGFuZCBzeXN0ZW0gcGFnZSBzaXplcy4KLQkgKi8KLQl2b2lkICgqdHRtX3R0X3Vu
YmluZCkoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSk7Ci0K
LQkvKioKLQkgKiB0dG1fdHRfZGVzdHJveQotCSAqCi0JICogQGJkZXY6IFBvaW50ZXIgdG8gYSB0
dG0gZGV2aWNlCi0JICogQHR0bTogUG9pbnRlciB0byBhIHN0cnVjdCB0dG1fdHQuCi0JICoKLQkg
KiBEZXN0cm95IHRoZSBiYWNrZW5kLiBUaGlzIHdpbGwgYmUgY2FsbCBiYWNrIGZyb20gdHRtX3R0
X2Rlc3Ryb3kgc28KLQkgKiBkb24ndCBjYWxsIHR0bV90dF9kZXN0cm95IGZyb20gdGhlIGNhbGxi
YWNrIG9yIGluZmluaXRlIGxvb3AuCi0JICovCi0Jdm9pZCAoKnR0bV90dF9kZXN0cm95KShzdHJ1
Y3QgdHRtX2JvX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV90dCAqdHRtKTsKLQotCS8qKgotCSAq
IHN0cnVjdCB0dG1fYm9fZHJpdmVyIG1lbWJlciBldmljdGlvbl92YWx1YWJsZQotCSAqCi0JICog
QGJvOiB0aGUgYnVmZmVyIG9iamVjdCB0byBiZSBldmljdGVkCi0JICogQHBsYWNlOiBwbGFjZW1l
bnQgd2UgbmVlZCByb29tIGZvcgotCSAqCi0JICogQ2hlY2sgd2l0aCB0aGUgZHJpdmVyIGlmIGl0
IGlzIHZhbHVhYmxlIHRvIGV2aWN0IGEgQk8gdG8gbWFrZSByb29tCi0JICogZm9yIGEgY2VydGFp
biBwbGFjZW1lbnQuCi0JICovCi0JYm9vbCAoKmV2aWN0aW9uX3ZhbHVhYmxlKShzdHJ1Y3QgdHRt
X2J1ZmZlcl9vYmplY3QgKmJvLAotCQkJCSAgY29uc3Qgc3RydWN0IHR0bV9wbGFjZSAqcGxhY2Up
OwotCS8qKgotCSAqIHN0cnVjdCB0dG1fYm9fZHJpdmVyIG1lbWJlciBldmljdF9mbGFnczoKLQkg
KgotCSAqIEBibzogdGhlIGJ1ZmZlciBvYmplY3QgdG8gYmUgZXZpY3RlZAotCSAqCi0JICogUmV0
dXJuIHRoZSBibyBmbGFncyBmb3IgYSBidWZmZXIgd2hpY2ggaXMgbm90IG1hcHBlZCB0byB0aGUg
aGFyZHdhcmUuCi0JICogVGhlc2Ugd2lsbCBiZSBwbGFjZWQgaW4gcHJvcG9zZWRfZmxhZ3Mgc28g
dGhhdCB3aGVuIHRoZSBtb3ZlIGlzCi0JICogZmluaXNoZWQsIHRoZXknbGwgZW5kIHVwIGluIGJv
LT5tZW0uZmxhZ3MKLQkgKi8KLQotCXZvaWQgKCpldmljdF9mbGFncykoc3RydWN0IHR0bV9idWZm
ZXJfb2JqZWN0ICpibywKLQkJCSAgICBzdHJ1Y3QgdHRtX3BsYWNlbWVudCAqcGxhY2VtZW50KTsK
LQotCS8qKgotCSAqIHN0cnVjdCB0dG1fYm9fZHJpdmVyIG1lbWJlciBtb3ZlOgotCSAqCi0JICog
QGJvOiB0aGUgYnVmZmVyIHRvIG1vdmUKLQkgKiBAZXZpY3Q6IHdoZXRoZXIgdGhpcyBtb3Rpb24g
aXMgZXZpY3RpbmcgdGhlIGJ1ZmZlciBmcm9tCi0JICogdGhlIGdyYXBoaWNzIGFkZHJlc3Mgc3Bh
Y2UKLQkgKiBAY3R4OiBjb250ZXh0IGZvciB0aGlzIG1vdmUgd2l0aCBwYXJhbWV0ZXJzCi0JICog
QG5ld19tZW06IHRoZSBuZXcgbWVtb3J5IHJlZ2lvbiByZWNlaXZpbmcgdGhlIGJ1ZmZlcgotCSAq
Ci0JICogTW92ZSBhIGJ1ZmZlciBiZXR3ZWVuIHR3byBtZW1vcnkgcmVnaW9ucy4KLQkgKi8KLQlp
bnQgKCptb3ZlKShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLCBib29sIGV2aWN0LAotCQkg
ICAgc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4ICpjdHgsCi0JCSAgICBzdHJ1Y3QgdHRtX3Jlc291
cmNlICpuZXdfbWVtKTsKLQotCS8qKgotCSAqIHN0cnVjdCB0dG1fYm9fZHJpdmVyX21lbWJlciB2
ZXJpZnlfYWNjZXNzCi0JICoKLQkgKiBAYm86IFBvaW50ZXIgdG8gYSBidWZmZXIgb2JqZWN0Lgot
CSAqIEBmaWxwOiBQb2ludGVyIHRvIGEgc3RydWN0IGZpbGUgdHJ5aW5nIHRvIGFjY2VzcyB0aGUg
b2JqZWN0LgotCSAqCi0JICogQ2FsbGVkIGZyb20gdGhlIG1hcCAvIHdyaXRlIC8gcmVhZCBtZXRo
b2RzIHRvIHZlcmlmeSB0aGF0IHRoZQotCSAqIGNhbGxlciBpcyBwZXJtaXR0ZWQgdG8gYWNjZXNz
IHRoZSBidWZmZXIgb2JqZWN0LgotCSAqIFRoaXMgbWVtYmVyIG1heSBiZSBzZXQgdG8gTlVMTCwg
d2hpY2ggd2lsbCByZWZ1c2UgdGhpcyBraW5kIG9mCi0JICogYWNjZXNzIGZvciBhbGwgYnVmZmVy
IG9iamVjdHMuCi0JICogVGhpcyBmdW5jdGlvbiBzaG91bGQgcmV0dXJuIDAgaWYgYWNjZXNzIGlz
IGdyYW50ZWQsIC1FUEVSTSBvdGhlcndpc2UuCi0JICovCi0JaW50ICgqdmVyaWZ5X2FjY2Vzcyko
c3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKLQkJCSAgICAgc3RydWN0IGZpbGUgKmZpbHAp
OwotCi0JLyoqCi0JICogSG9vayB0byBub3RpZnkgZHJpdmVyIGFib3V0IGEgZHJpdmVyIG1vdmUg
c28gaXQKLQkgKiBjYW4gZG8gdGlsaW5nIHRoaW5ncyBhbmQgYm9vay1rZWVwaW5nLgotCSAqCi0J
ICogQGV2aWN0OiB3aGV0aGVyIHRoaXMgbW92ZSBpcyBldmljdGluZyB0aGUgYnVmZmVyIGZyb20g
dGhlIGdyYXBoaWNzCi0JICogYWRkcmVzcyBzcGFjZQotCSAqLwotCXZvaWQgKCptb3ZlX25vdGlm
eSkoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKLQkJCSAgICBib29sIGV2aWN0LAotCQkJ
ICAgIHN0cnVjdCB0dG1fcmVzb3VyY2UgKm5ld19tZW0pOwotCi0JLyoqCi0JICogbm90aWZ5IHRo
ZSBkcml2ZXIgdGhhdCB3ZSdyZSBhYm91dCB0byBzd2FwIG91dCB0aGlzIGJvCi0JICovCi0Jdm9p
ZCAoKnN3YXBfbm90aWZ5KShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvKTsKLQotCS8qKgot
CSAqIERyaXZlciBjYWxsYmFjayBvbiB3aGVuIG1hcHBpbmcgaW8gbWVtb3J5IChmb3IgYm9fbW92
ZV9tZW1jcHkKLQkgKiBmb3IgaW5zdGFuY2UpLiBUVE0gd2lsbCB0YWtlIGNhcmUgdG8gY2FsbCBp
b19tZW1fZnJlZSB3aGVuZXZlcgotCSAqIHRoZSBtYXBwaW5nIGlzIG5vdCB1c2UgYW55bW9yZS4g
aW9fbWVtX3Jlc2VydmUgJiBpb19tZW1fZnJlZQotCSAqIGFyZSBiYWxhbmNlZC4KLQkgKi8KLQlp
bnQgKCppb19tZW1fcmVzZXJ2ZSkoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCi0JCQkgICAg
ICBzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0pOwotCXZvaWQgKCppb19tZW1fZnJlZSkoc3RydWN0
IHR0bV9ib19kZXZpY2UgKmJkZXYsCi0JCQkgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqbWVtKTsK
LQotCS8qKgotCSAqIFJldHVybiB0aGUgcGZuIGZvciBhIGdpdmVuIHBhZ2Vfb2Zmc2V0IGluc2lk
ZSB0aGUgQk8uCi0JICoKLQkgKiBAYm86IHRoZSBCTyB0byBsb29rIHVwIHRoZSBwZm4gZm9yCi0J
ICogQHBhZ2Vfb2Zmc2V0OiB0aGUgb2Zmc2V0IHRvIGxvb2sgdXAKLQkgKi8KLQl1bnNpZ25lZCBs
b25nICgqaW9fbWVtX3Bmbikoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKLQkJCQkgICAg
dW5zaWduZWQgbG9uZyBwYWdlX29mZnNldCk7Ci0KLQkvKioKLQkgKiBSZWFkL3dyaXRlIG1lbW9y
eSBidWZmZXJzIGZvciBwdHJhY2UgYWNjZXNzCi0JICoKLQkgKiBAYm86IHRoZSBCTyB0byBhY2Nl
c3MKLQkgKiBAb2Zmc2V0OiB0aGUgb2Zmc2V0IGZyb20gdGhlIHN0YXJ0IG9mIHRoZSBCTwotCSAq
IEBidWY6IHBvaW50ZXIgdG8gc291cmNlL2Rlc3RpbmF0aW9uIGJ1ZmZlcgotCSAqIEBsZW46IG51
bWJlciBvZiBieXRlcyB0byBjb3B5Ci0JICogQHdyaXRlOiB3aGV0aGVyIHRvIHJlYWQgKDApIGZy
b20gb3Igd3JpdGUgKG5vbi0wKSB0byBCTwotCSAqCi0JICogSWYgc3VjY2Vzc2Z1bCwgdGhpcyBm
dW5jdGlvbiBzaG91bGQgcmV0dXJuIHRoZSBudW1iZXIgb2YKLQkgKiBieXRlcyBjb3BpZWQsIC1F
SU8gb3RoZXJ3aXNlLiBJZiB0aGUgbnVtYmVyIG9mIGJ5dGVzCi0JICogcmV0dXJuZWQgaXMgPCBs
ZW4sIHRoZSBmdW5jdGlvbiBtYXkgYmUgY2FsbGVkIGFnYWluIHdpdGgKLQkgKiB0aGUgcmVtYWlu
ZGVyIG9mIHRoZSBidWZmZXIgdG8gY29weS4KLQkgKi8KLQlpbnQgKCphY2Nlc3NfbWVtb3J5KShz
dHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLCB1bnNpZ25lZCBsb25nIG9mZnNldCwKLQkJCSAg
ICAgdm9pZCAqYnVmLCBpbnQgbGVuLCBpbnQgd3JpdGUpOwotCi0JLyoqCi0JICogc3RydWN0IHR0
bV9ib19kcml2ZXIgbWVtYmVyIGRlbF9mcm9tX2xydV9ub3RpZnkKLQkgKgotCSAqIEBibzogdGhl
IGJ1ZmZlciBvYmplY3QgZGVsZXRlZCBmcm9tIGxydQotCSAqCi0JICogbm90aWZ5IGRyaXZlciB0
aGF0IGEgQk8gd2FzIGRlbGV0ZWQgZnJvbSBMUlUuCi0JICovCi0Jdm9pZCAoKmRlbF9mcm9tX2xy
dV9ub3RpZnkpKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8pOwotCi0JLyoqCi0JICogTm90
aWZ5IHRoZSBkcml2ZXIgdGhhdCB3ZSdyZSBhYm91dCB0byByZWxlYXNlIGEgQk8KLQkgKgotCSAq
IEBibzogQk8gdGhhdCBpcyBhYm91dCB0byBiZSByZWxlYXNlZAotCSAqCi0JICogR2l2ZXMgdGhl
IGRyaXZlciBhIGNoYW5jZSB0byBkbyBhbnkgY2xlYW51cCwgaW5jbHVkaW5nCi0JICogYWRkaW5n
IGZlbmNlcyB0aGF0IG1heSBmb3JjZSBhIGRlbGF5ZWQgZGVsZXRlCi0JICovCi0Jdm9pZCAoKnJl
bGVhc2Vfbm90aWZ5KShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvKTsKLX07Ci0KLS8qKgot
ICogc3RydWN0IHR0bV9ib19nbG9iYWwgLSBCdWZmZXIgb2JqZWN0IGRyaXZlciBnbG9iYWwgZGF0
YS4KLSAqCi0gKiBAZHVtbXlfcmVhZF9wYWdlOiBQb2ludGVyIHRvIGEgZHVtbXkgcGFnZSB1c2Vk
IGZvciBtYXBwaW5nIHJlcXVlc3RzCi0gKiBvZiB1bnBvcHVsYXRlZCBwYWdlcy4KLSAqIEBzaHJp
bms6IEEgc2hyaW5rIGNhbGxiYWNrIG9iamVjdCB1c2VkIGZvciBidWZmZXIgb2JqZWN0IHN3YXAu
Ci0gKiBAZGV2aWNlX2xpc3RfbXV0ZXg6IE11dGV4IHByb3RlY3RpbmcgdGhlIGRldmljZSBsaXN0
LgotICogVGhpcyBtdXRleCBpcyBoZWxkIHdoaWxlIHRyYXZlcnNpbmcgdGhlIGRldmljZSBsaXN0
IGZvciBwbSBvcHRpb25zLgotICogQGxydV9sb2NrOiBTcGlubG9jayBwcm90ZWN0aW5nIHRoZSBi
byBzdWJzeXN0ZW0gbHJ1IGxpc3RzLgotICogQGRldmljZV9saXN0OiBMaXN0IG9mIGJ1ZmZlciBv
YmplY3QgZGV2aWNlcy4KLSAqIEBzd2FwX2xydTogTHJ1IGxpc3Qgb2YgYnVmZmVyIG9iamVjdHMg
dXNlZCBmb3Igc3dhcHBpbmcuCi0gKi8KLQotZXh0ZXJuIHN0cnVjdCB0dG1fYm9fZ2xvYmFsIHsK
LQotCS8qKgotCSAqIENvbnN0YW50IGFmdGVyIGluaXQuCi0JICovCi0KLQlzdHJ1Y3Qga29iamVj
dCBrb2JqOwotCXN0cnVjdCBwYWdlICpkdW1teV9yZWFkX3BhZ2U7Ci0Jc3BpbmxvY2tfdCBscnVf
bG9jazsKLQotCS8qKgotCSAqIFByb3RlY3RlZCBieSB0dG1fZ2xvYmFsX211dGV4LgotCSAqLwot
CXN0cnVjdCBsaXN0X2hlYWQgZGV2aWNlX2xpc3Q7Ci0KLQkvKioKLQkgKiBQcm90ZWN0ZWQgYnkg
dGhlIGxydV9sb2NrLgotCSAqLwotCXN0cnVjdCBsaXN0X2hlYWQgc3dhcF9scnVbVFRNX01BWF9C
T19QUklPUklUWV07Ci0KLQkvKioKLQkgKiBJbnRlcm5hbCBwcm90ZWN0aW9uLgotCSAqLwotCWF0
b21pY190IGJvX2NvdW50OwotfSB0dG1fYm9fZ2xvYjsKLQotCi0jZGVmaW5lIFRUTV9OVU1fTUVN
X1RZUEVTIDgKLQotLyoqCi0gKiBzdHJ1Y3QgdHRtX2JvX2RldmljZSAtIEJ1ZmZlciBvYmplY3Qg
ZHJpdmVyIGRldmljZS1zcGVjaWZpYyBkYXRhLgotICoKLSAqIEBkcml2ZXI6IFBvaW50ZXIgdG8g
YSBzdHJ1Y3QgdHRtX2JvX2RyaXZlciBzdHJ1Y3Qgc2V0dXAgYnkgdGhlIGRyaXZlci4KLSAqIEBt
YW46IEFuIGFycmF5IG9mIHJlc291cmNlX21hbmFnZXJzLgotICogQHZtYV9tYW5hZ2VyOiBBZGRy
ZXNzIHNwYWNlIG1hbmFnZXIgKHBvaW50ZXIpCi0gKiBscnVfbG9jazogU3BpbmxvY2sgdGhhdCBw
cm90ZWN0cyB0aGUgYnVmZmVyK2RldmljZSBscnUgbGlzdHMgYW5kCi0gKiBkZGVzdHJveSBsaXN0
cy4KLSAqIEBkZXZfbWFwcGluZzogQSBwb2ludGVyIHRvIHRoZSBzdHJ1Y3QgYWRkcmVzc19zcGFj
ZSByZXByZXNlbnRpbmcgdGhlCi0gKiBkZXZpY2UgYWRkcmVzcyBzcGFjZS4KLSAqIEB3cTogV29y
ayBxdWV1ZSBzdHJ1Y3R1cmUgZm9yIHRoZSBkZWxheWVkIGRlbGV0ZSB3b3JrcXVldWUuCi0gKiBA
bm9fcmV0cnk6IERvbid0IHJldHJ5IGFsbG9jYXRpb24gaWYgaXQgZmFpbHMKLSAqCi0gKi8KLQot
c3RydWN0IHR0bV9ib19kZXZpY2UgewotCi0JLyoKLQkgKiBDb25zdGFudCBhZnRlciBibyBkZXZp
Y2UgaW5pdCAvIGF0b21pYy4KLQkgKi8KLQlzdHJ1Y3QgbGlzdF9oZWFkIGRldmljZV9saXN0Owot
CXN0cnVjdCB0dG1fYm9fZHJpdmVyICpkcml2ZXI7Ci0JLyoKLQkgKiBhY2Nlc3MgdmlhIHR0bV9t
YW5hZ2VyX3R5cGUuCi0JICovCi0Jc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyIHN5c21hbjsK
LQlzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbl9kcnZbVFRNX05VTV9NRU1fVFlQRVNd
OwotCS8qCi0JICogUHJvdGVjdGVkIGJ5IGludGVybmFsIGxvY2tzLgotCSAqLwotCXN0cnVjdCBk
cm1fdm1hX29mZnNldF9tYW5hZ2VyICp2bWFfbWFuYWdlcjsKLQotCS8qCi0JICogUHJvdGVjdGVk
IGJ5IHRoZSBnbG9iYWw6bHJ1IGxvY2suCi0JICovCi0Jc3RydWN0IGxpc3RfaGVhZCBkZGVzdHJv
eTsKLQotCS8qCi0JICogUHJvdGVjdGVkIGJ5IGxvYWQgLyBmaXJzdG9wZW4gLyBsYXN0Y2xvc2Ug
L3VubG9hZCBzeW5jLgotCSAqLwotCi0Jc3RydWN0IGFkZHJlc3Nfc3BhY2UgKmRldl9tYXBwaW5n
OwotCi0JLyoKLQkgKiBJbnRlcm5hbCBwcm90ZWN0aW9uLgotCSAqLwotCi0Jc3RydWN0IGRlbGF5
ZWRfd29yayB3cTsKLQotCWJvb2wgbmVlZF9kbWEzMjsKLQotCWJvb2wgbm9fcmV0cnk7Ci19Owot
Ci1zdGF0aWMgaW5saW5lIHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqdHRtX21hbmFnZXJf
dHlwZShzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKLQkJCQkJCQkgICAgaW50IG1lbV90eXBl
KQotewotCXJldHVybiBiZGV2LT5tYW5fZHJ2W21lbV90eXBlXTsKLX0KLQotc3RhdGljIGlubGlu
ZSB2b2lkIHR0bV9zZXRfZHJpdmVyX21hbmFnZXIoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYs
Ci0JCQkJCSAgaW50IHR5cGUsCi0JCQkJCSAgc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICpt
YW5hZ2VyKQotewotCWJkZXYtPm1hbl9kcnZbdHlwZV0gPSBtYW5hZ2VyOwotfQotCiAvKioKICAq
IHN0cnVjdCB0dG1fbHJ1X2J1bGtfbW92ZV9wb3MKICAqCkBAIC00MTgsMzAgKzEwMSw2IEBAIGlu
dCB0dG1fYm9fbWVtX3NwYWNlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAJCSAgICAg
c3RydWN0IHR0bV9yZXNvdXJjZSAqbWVtLAogCQkgICAgIHN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0
eCAqY3R4KTsKIAotaW50IHR0bV9ib19kZXZpY2VfcmVsZWFzZShzdHJ1Y3QgdHRtX2JvX2Rldmlj
ZSAqYmRldik7Ci0KLS8qKgotICogdHRtX2JvX2RldmljZV9pbml0Ci0gKgotICogQGJkZXY6IEEg
cG9pbnRlciB0byBhIHN0cnVjdCB0dG1fYm9fZGV2aWNlIHRvIGluaXRpYWxpemUuCi0gKiBAZ2xv
YjogQSBwb2ludGVyIHRvIGFuIGluaXRpYWxpemVkIHN0cnVjdCB0dG1fYm9fZ2xvYmFsLgotICog
QGRyaXZlcjogQSBwb2ludGVyIHRvIGEgc3RydWN0IHR0bV9ib19kcml2ZXIgc2V0IHVwIGJ5IHRo
ZSBjYWxsZXIuCi0gKiBAbWFwcGluZzogVGhlIGFkZHJlc3Mgc3BhY2UgdG8gdXNlIGZvciB0aGlz
IGJvLgotICogQHZtYV9tYW5hZ2VyOiBBIHBvaW50ZXIgdG8gYSB2bWEgbWFuYWdlci4KLSAqIEBm
aWxlX3BhZ2Vfb2Zmc2V0OiBPZmZzZXQgaW50byB0aGUgZGV2aWNlIGFkZHJlc3Mgc3BhY2UgdGhh
dCBpcyBhdmFpbGFibGUKLSAqIGZvciBidWZmZXIgZGF0YS4gVGhpcyBlbnN1cmVzIGNvbXBhdGli
aWxpdHkgd2l0aCBvdGhlciB1c2VycyBvZiB0aGUKLSAqIGFkZHJlc3Mgc3BhY2UuCi0gKgotICog
SW5pdGlhbGl6ZXMgYSBzdHJ1Y3QgdHRtX2JvX2RldmljZToKLSAqIFJldHVybnM6Ci0gKiAhMDog
RmFpbHVyZS4KLSAqLwotaW50IHR0bV9ib19kZXZpY2VfaW5pdChzdHJ1Y3QgdHRtX2JvX2Rldmlj
ZSAqYmRldiwKLQkJICAgICAgIHN0cnVjdCB0dG1fYm9fZHJpdmVyICpkcml2ZXIsCi0JCSAgICAg
ICBzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZywKLQkJICAgICAgIHN0cnVjdCBkcm1fdm1h
X29mZnNldF9tYW5hZ2VyICp2bWFfbWFuYWdlciwKLQkJICAgICAgIGJvb2wgbmVlZF9kbWEzMik7
Ci0KIC8qKgogICogdHRtX2JvX3VubWFwX3ZpcnR1YWwKICAqCkBAIC01MzEsOSArMTkwLDkgQEAg
c3RhdGljIGlubGluZSBpbnQgdHRtX2JvX3Jlc2VydmVfc2xvd3BhdGgoc3RydWN0IHR0bV9idWZm
ZXJfb2JqZWN0ICpibywKIAogc3RhdGljIGlubGluZSB2b2lkIHR0bV9ib19tb3ZlX3RvX2xydV90
YWlsX3VubG9ja2VkKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8pCiB7Ci0Jc3Bpbl9sb2Nr
KCZ0dG1fYm9fZ2xvYi5scnVfbG9jayk7CisJc3Bpbl9sb2NrKCZ0dG1fZ2xvYi5scnVfbG9jayk7
CiAJdHRtX2JvX21vdmVfdG9fbHJ1X3RhaWwoYm8sIE5VTEwpOwotCXNwaW5fdW5sb2NrKCZ0dG1f
Ym9fZ2xvYi5scnVfbG9jayk7CisJc3Bpbl91bmxvY2soJnR0bV9nbG9iLmxydV9sb2NrKTsKIH0K
IAogc3RhdGljIGlubGluZSB2b2lkIHR0bV9ib19hc3NpZ25fbWVtKHN0cnVjdCB0dG1fYnVmZmVy
X29iamVjdCAqYm8sCkBAIC01NzYsOSArMjM1LDkgQEAgc3RhdGljIGlubGluZSB2b2lkIHR0bV9i
b191bnJlc2VydmUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibykKICAqIHR0bV9ib191dGls
LmMKICAqLwogCi1pbnQgdHRtX21lbV9pb19yZXNlcnZlKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpi
ZGV2LAoraW50IHR0bV9tZW1faW9fcmVzZXJ2ZShzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwKIAkJ
ICAgICAgIHN0cnVjdCB0dG1fcmVzb3VyY2UgKm1lbSk7Ci12b2lkIHR0bV9tZW1faW9fZnJlZShz
dHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwKK3ZvaWQgdHRtX21lbV9pb19mcmVlKHN0cnVjdCB0
dG1fZGV2aWNlICpiZGV2LAogCQkgICAgIHN0cnVjdCB0dG1fcmVzb3VyY2UgKm1lbSk7CiAvKioK
ICAqIHR0bV9ib19tb3ZlX3R0bQpAQCAtNzA2LDcgKzM2NSw3IEBAIHZvaWQgdHRtX2JvX3R0X2Rl
c3Ryb3koc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibyk7CiAgKiBJbml0aWFsaXNlIGEgZ2Vu
ZXJpYyByYW5nZSBtYW5hZ2VyIGZvciB0aGUgc2VsZWN0ZWQgbWVtb3J5IHR5cGUuCiAgKiBUaGUg
cmFuZ2UgbWFuYWdlciBpcyBpbnN0YWxsZWQgZm9yIHRoaXMgZGV2aWNlIGluIHRoZSB0eXBlIHNs
b3QuCiAgKi8KLWludCB0dG1fcmFuZ2VfbWFuX2luaXQoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJk
ZXYsCitpbnQgdHRtX3JhbmdlX21hbl9pbml0KHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LAogCQkg
ICAgICAgdW5zaWduZWQgdHlwZSwgYm9vbCB1c2VfdHQsCiAJCSAgICAgICB1bnNpZ25lZCBsb25n
IHBfc2l6ZSk7CiAKQEAgLTcxOCw3ICszNzcsNyBAQCBpbnQgdHRtX3JhbmdlX21hbl9pbml0KHN0
cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LAogICoKICAqIFJlbW92ZSB0aGUgZ2VuZXJpYyByYW5n
ZSBtYW5hZ2VyIGZyb20gYSBzbG90IGFuZCB0ZWFyIGl0IGRvd24uCiAgKi8KLWludCB0dG1fcmFu
Z2VfbWFuX2Zpbmkoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCitpbnQgdHRtX3JhbmdlX21h
bl9maW5pKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LAogCQkgICAgICAgdW5zaWduZWQgdHlwZSk7
CiAKICNlbmRpZgpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0vdHRtL3R0bV9kZXZpY2UuaCBiL2lu
Y2x1ZGUvZHJtL3R0bS90dG1fZGV2aWNlLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAw
MDAwMDAwMDAwLi43NWZlZGQzNzhlOGYKLS0tIC9kZXYvbnVsbAorKysgYi9pbmNsdWRlL2RybS90
dG0vdHRtX2RldmljZS5oCkBAIC0wLDAgKzEsMzY2IEBACisvKgorICogQ29weXJpZ2h0IDIwMjAg
QWR2YW5jZWQgTWljcm8gRGV2aWNlcywgSW5jLgorICoKKyAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5
IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCisgKiBj
b3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAo
dGhlICJTb2Z0d2FyZSIpLAorICogdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0
cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbgorICogdGhlIHJpZ2h0cyB0byB1
c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2Us
CisgKiBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBl
cnNvbnMgdG8gd2hvbSB0aGUKKyAqIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3Vi
amVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6CisgKgorICogVGhlIGFib3ZlIGNvcHly
aWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQg
aW4KKyAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJl
LgorICoKKyAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJB
TlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SCisgKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5P
VCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKKyAqIEZJVE5F
U1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBF
VkVOVCBTSEFMTAorICogVEhFIENPUFlSSUdIVCBIT0xERVIoUykgT1IgQVVUSE9SKFMpIEJFIExJ
QUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SCisgKiBPVEhFUiBMSUFCSUxJVFksIFdIRVRI
RVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwKKyAqIEFSSVNJ
TkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhF
IFVTRSBPUgorICogT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgorICoKKyAqIEF1dGhv
cnM6IENocmlzdGlhbiBLw7ZuaWcKKyAqLworCisjaWZuZGVmIF9UVE1fREVWSUNFX0hfCisjZGVm
aW5lIF9UVE1fREVWSUNFX0hfCisKKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgorI2luY2x1ZGUg
PGxpbnV4L3dvcmtxdWV1ZS5oPgorI2luY2x1ZGUgPGRybS90dG0vdHRtX3Jlc291cmNlLmg+CisK
KyNkZWZpbmUgVFRNX05VTV9NRU1fVFlQRVMgOAorCitzdHJ1Y3QgdHRtX2RldmljZTsKK3N0cnVj
dCB0dG1fcmVzb3VyY2U7CitzdHJ1Y3QgdHRtX3BsYWNlbWVudDsKK3N0cnVjdCB0dG1fYnVmZmVy
X29iamVjdDsKK3N0cnVjdCB0dG1fb3BlcmF0aW9uX2N0eDsKKworLyoqCisgKiBzdHJ1Y3QgdHRt
X2JvX2dsb2JhbCAtIEJ1ZmZlciBvYmplY3QgZHJpdmVyIGdsb2JhbCBkYXRhLgorICoKKyAqIEBk
dW1teV9yZWFkX3BhZ2U6IFBvaW50ZXIgdG8gYSBkdW1teSBwYWdlIHVzZWQgZm9yIG1hcHBpbmcg
cmVxdWVzdHMKKyAqIG9mIHVucG9wdWxhdGVkIHBhZ2VzLgorICogQHNocmluazogQSBzaHJpbmsg
Y2FsbGJhY2sgb2JqZWN0IHVzZWQgZm9yIGJ1ZmZlciBvYmplY3Qgc3dhcC4KKyAqIEBkZXZpY2Vf
bGlzdF9tdXRleDogTXV0ZXggcHJvdGVjdGluZyB0aGUgZGV2aWNlIGxpc3QuCisgKiBUaGlzIG11
dGV4IGlzIGhlbGQgd2hpbGUgdHJhdmVyc2luZyB0aGUgZGV2aWNlIGxpc3QgZm9yIHBtIG9wdGlv
bnMuCisgKiBAbHJ1X2xvY2s6IFNwaW5sb2NrIHByb3RlY3RpbmcgdGhlIGJvIHN1YnN5c3RlbSBs
cnUgbGlzdHMuCisgKiBAZGV2aWNlX2xpc3Q6IExpc3Qgb2YgYnVmZmVyIG9iamVjdCBkZXZpY2Vz
LgorICogQHN3YXBfbHJ1OiBMcnUgbGlzdCBvZiBidWZmZXIgb2JqZWN0cyB1c2VkIGZvciBzd2Fw
cGluZy4KKyAqLworZXh0ZXJuIHN0cnVjdCB0dG1fZ2xvYmFsIHsKKworCS8qKgorCSAqIENvbnN0
YW50IGFmdGVyIGluaXQuCisJICovCisKKwlzdHJ1Y3Qga29iamVjdCBrb2JqOworCXN0cnVjdCBw
YWdlICpkdW1teV9yZWFkX3BhZ2U7CisJc3BpbmxvY2tfdCBscnVfbG9jazsKKworCS8qKgorCSAq
IFByb3RlY3RlZCBieSB0dG1fZ2xvYmFsX211dGV4LgorCSAqLworCXN0cnVjdCBsaXN0X2hlYWQg
ZGV2aWNlX2xpc3Q7CisKKwkvKioKKwkgKiBQcm90ZWN0ZWQgYnkgdGhlIGxydV9sb2NrLgorCSAq
LworCXN0cnVjdCBsaXN0X2hlYWQgc3dhcF9scnVbVFRNX01BWF9CT19QUklPUklUWV07CisKKwkv
KioKKwkgKiBJbnRlcm5hbCBwcm90ZWN0aW9uLgorCSAqLworCWF0b21pY190IGJvX2NvdW50Owor
fSB0dG1fZ2xvYjsKKworc3RydWN0IHR0bV9kZXZpY2VfZnVuY3MgeworCS8qKgorCSAqIHR0bV90
dF9jcmVhdGUKKwkgKgorCSAqIEBibzogVGhlIGJ1ZmZlciBvYmplY3QgdG8gY3JlYXRlIHRoZSB0
dG0gZm9yLgorCSAqIEBwYWdlX2ZsYWdzOiBQYWdlIGZsYWdzIGFzIGlkZW50aWZpZWQgYnkgVFRN
X1BBR0VfRkxBR19YWCBmbGFncy4KKwkgKgorCSAqIENyZWF0ZSBhIHN0cnVjdCB0dG1fdHQgdG8g
YmFjayBkYXRhIHdpdGggc3lzdGVtIG1lbW9yeSBwYWdlcy4KKwkgKiBObyBwYWdlcyBhcmUgYWN0
dWFsbHkgYWxsb2NhdGVkLgorCSAqIFJldHVybnM6CisJICogTlVMTDogT3V0IG9mIG1lbW9yeS4K
KwkgKi8KKwlzdHJ1Y3QgdHRtX3R0ICooKnR0bV90dF9jcmVhdGUpKHN0cnVjdCB0dG1fYnVmZmVy
X29iamVjdCAqYm8sCisJCQkJCXVpbnQzMl90IHBhZ2VfZmxhZ3MpOworCisJLyoqCisJICogdHRt
X3R0X3BvcHVsYXRlCisJICoKKwkgKiBAdHRtOiBUaGUgc3RydWN0IHR0bV90dCB0byBjb250YWlu
IHRoZSBiYWNraW5nIHBhZ2VzLgorCSAqCisJICogQWxsb2NhdGUgYWxsIGJhY2tpbmcgcGFnZXMK
KwkgKiBSZXR1cm5zOgorCSAqIC1FTk9NRU06IE91dCBvZiBtZW1vcnkuCisJICovCisJaW50ICgq
dHRtX3R0X3BvcHVsYXRlKShzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwKKwkJCSAgICAgICBzdHJ1
Y3QgdHRtX3R0ICp0dG0sCisJCQkgICAgICAgc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4ICpjdHgp
OworCisJLyoqCisJICogdHRtX3R0X3VucG9wdWxhdGUKKwkgKgorCSAqIEB0dG06IFRoZSBzdHJ1
Y3QgdHRtX3R0IHRvIGNvbnRhaW4gdGhlIGJhY2tpbmcgcGFnZXMuCisJICoKKwkgKiBGcmVlIGFs
bCBiYWNraW5nIHBhZ2UKKwkgKi8KKwl2b2lkICgqdHRtX3R0X3VucG9wdWxhdGUpKHN0cnVjdCB0
dG1fZGV2aWNlICpiZGV2LAorCQkJCSAgc3RydWN0IHR0bV90dCAqdHRtKTsKKworCS8qKgorCSAq
IHR0bV90dF9iaW5kCisJICoKKwkgKiBAYmRldjogUG9pbnRlciB0byBhIHR0bSBkZXZpY2UKKwkg
KiBAdHRtOiBQb2ludGVyIHRvIGEgc3RydWN0IHR0bV90dC4KKwkgKiBAYm9fbWVtOiBQb2ludGVy
IHRvIGEgc3RydWN0IHR0bV9yZXNvdXJjZSBkZXNjcmliaW5nIHRoZQorCSAqIG1lbW9yeSB0eXBl
IGFuZCBsb2NhdGlvbiBmb3IgYmluZGluZy4KKwkgKgorCSAqIEJpbmQgdGhlIGJhY2tlbmQgcGFn
ZXMgaW50byB0aGUgYXBlcnR1cmUgaW4gdGhlIGxvY2F0aW9uCisJICogaW5kaWNhdGVkIGJ5IEBi
b19tZW0uIFRoaXMgZnVuY3Rpb24gc2hvdWxkIGJlIGFibGUgdG8gaGFuZGxlCisJICogZGlmZmVy
ZW5jZXMgYmV0d2VlbiBhcGVydHVyZSBhbmQgc3lzdGVtIHBhZ2Ugc2l6ZXMuCisJICovCisJaW50
ICgqdHRtX3R0X2JpbmQpKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LCBzdHJ1Y3QgdHRtX3R0ICp0
dG0sCisJCQkgICBzdHJ1Y3QgdHRtX3Jlc291cmNlICpib19tZW0pOworCisJLyoqCisJICogdHRt
X3R0X3VuYmluZAorCSAqCisJICogQGJkZXY6IFBvaW50ZXIgdG8gYSB0dG0gZGV2aWNlCisJICog
QHR0bTogUG9pbnRlciB0byBhIHN0cnVjdCB0dG1fdHQuCisJICoKKwkgKiBVbmJpbmQgcHJldmlv
dXNseSBib3VuZCBiYWNrZW5kIHBhZ2VzLiBUaGlzIGZ1bmN0aW9uIHNob3VsZCBiZQorCSAqIGFi
bGUgdG8gaGFuZGxlIGRpZmZlcmVuY2VzIGJldHdlZW4gYXBlcnR1cmUgYW5kIHN5c3RlbSBwYWdl
IHNpemVzLgorCSAqLworCXZvaWQgKCp0dG1fdHRfdW5iaW5kKShzdHJ1Y3QgdHRtX2RldmljZSAq
YmRldiwgc3RydWN0IHR0bV90dCAqdHRtKTsKKworCS8qKgorCSAqIHR0bV90dF9kZXN0cm95CisJ
ICoKKwkgKiBAYmRldjogUG9pbnRlciB0byBhIHR0bSBkZXZpY2UKKwkgKiBAdHRtOiBQb2ludGVy
IHRvIGEgc3RydWN0IHR0bV90dC4KKwkgKgorCSAqIERlc3Ryb3kgdGhlIGJhY2tlbmQuIFRoaXMg
d2lsbCBiZSBjYWxsIGJhY2sgZnJvbSB0dG1fdHRfZGVzdHJveSBzbworCSAqIGRvbid0IGNhbGwg
dHRtX3R0X2Rlc3Ryb3kgZnJvbSB0aGUgY2FsbGJhY2sgb3IgaW5maW5pdGUgbG9vcC4KKwkgKi8K
Kwl2b2lkICgqdHRtX3R0X2Rlc3Ryb3kpKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LCBzdHJ1Y3Qg
dHRtX3R0ICp0dG0pOworCisJLyoqCisJICogc3RydWN0IHR0bV9ib19kcml2ZXIgbWVtYmVyIGV2
aWN0aW9uX3ZhbHVhYmxlCisJICoKKwkgKiBAYm86IHRoZSBidWZmZXIgb2JqZWN0IHRvIGJlIGV2
aWN0ZWQKKwkgKiBAcGxhY2U6IHBsYWNlbWVudCB3ZSBuZWVkIHJvb20gZm9yCisJICoKKwkgKiBD
aGVjayB3aXRoIHRoZSBkcml2ZXIgaWYgaXQgaXMgdmFsdWFibGUgdG8gZXZpY3QgYSBCTyB0byBt
YWtlIHJvb20KKwkgKiBmb3IgYSBjZXJ0YWluIHBsYWNlbWVudC4KKwkgKi8KKwlib29sICgqZXZp
Y3Rpb25fdmFsdWFibGUpKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCisJCQkJICBjb25z
dCBzdHJ1Y3QgdHRtX3BsYWNlICpwbGFjZSk7CisJLyoqCisJICogc3RydWN0IHR0bV9ib19kcml2
ZXIgbWVtYmVyIGV2aWN0X2ZsYWdzOgorCSAqCisJICogQGJvOiB0aGUgYnVmZmVyIG9iamVjdCB0
byBiZSBldmljdGVkCisJICoKKwkgKiBSZXR1cm4gdGhlIGJvIGZsYWdzIGZvciBhIGJ1ZmZlciB3
aGljaCBpcyBub3QgbWFwcGVkIHRvIHRoZSBoYXJkd2FyZS4KKwkgKiBUaGVzZSB3aWxsIGJlIHBs
YWNlZCBpbiBwcm9wb3NlZF9mbGFncyBzbyB0aGF0IHdoZW4gdGhlIG1vdmUgaXMKKwkgKiBmaW5p
c2hlZCwgdGhleSdsbCBlbmQgdXAgaW4gYm8tPm1lbS5mbGFncworCSAqLworCisJdm9pZCAoKmV2
aWN0X2ZsYWdzKShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAorCQkJICAgIHN0cnVjdCB0
dG1fcGxhY2VtZW50ICpwbGFjZW1lbnQpOworCisJLyoqCisJICogc3RydWN0IHR0bV9ib19kcml2
ZXIgbWVtYmVyIG1vdmU6CisJICoKKwkgKiBAYm86IHRoZSBidWZmZXIgdG8gbW92ZQorCSAqIEBl
dmljdDogd2hldGhlciB0aGlzIG1vdGlvbiBpcyBldmljdGluZyB0aGUgYnVmZmVyIGZyb20KKwkg
KiB0aGUgZ3JhcGhpY3MgYWRkcmVzcyBzcGFjZQorCSAqIEBjdHg6IGNvbnRleHQgZm9yIHRoaXMg
bW92ZSB3aXRoIHBhcmFtZXRlcnMKKwkgKiBAbmV3X21lbTogdGhlIG5ldyBtZW1vcnkgcmVnaW9u
IHJlY2VpdmluZyB0aGUgYnVmZmVyCisJICoKKwkgKiBNb3ZlIGEgYnVmZmVyIGJldHdlZW4gdHdv
IG1lbW9yeSByZWdpb25zLgorCSAqLworCWludCAoKm1vdmUpKHN0cnVjdCB0dG1fYnVmZmVyX29i
amVjdCAqYm8sIGJvb2wgZXZpY3QsCisJCSAgICBzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHggKmN0
eCwKKwkJICAgIHN0cnVjdCB0dG1fcmVzb3VyY2UgKm5ld19tZW0pOworCisJLyoqCisJICogc3Ry
dWN0IHR0bV9ib19kcml2ZXJfbWVtYmVyIHZlcmlmeV9hY2Nlc3MKKwkgKgorCSAqIEBibzogUG9p
bnRlciB0byBhIGJ1ZmZlciBvYmplY3QuCisJICogQGZpbHA6IFBvaW50ZXIgdG8gYSBzdHJ1Y3Qg
ZmlsZSB0cnlpbmcgdG8gYWNjZXNzIHRoZSBvYmplY3QuCisJICoKKwkgKiBDYWxsZWQgZnJvbSB0
aGUgbWFwIC8gd3JpdGUgLyByZWFkIG1ldGhvZHMgdG8gdmVyaWZ5IHRoYXQgdGhlCisJICogY2Fs
bGVyIGlzIHBlcm1pdHRlZCB0byBhY2Nlc3MgdGhlIGJ1ZmZlciBvYmplY3QuCisJICogVGhpcyBt
ZW1iZXIgbWF5IGJlIHNldCB0byBOVUxMLCB3aGljaCB3aWxsIHJlZnVzZSB0aGlzIGtpbmQgb2YK
KwkgKiBhY2Nlc3MgZm9yIGFsbCBidWZmZXIgb2JqZWN0cy4KKwkgKiBUaGlzIGZ1bmN0aW9uIHNo
b3VsZCByZXR1cm4gMCBpZiBhY2Nlc3MgaXMgZ3JhbnRlZCwgLUVQRVJNIG90aGVyd2lzZS4KKwkg
Ki8KKwlpbnQgKCp2ZXJpZnlfYWNjZXNzKShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAor
CQkJICAgICBzdHJ1Y3QgZmlsZSAqZmlscCk7CisKKwkvKioKKwkgKiBIb29rIHRvIG5vdGlmeSBk
cml2ZXIgYWJvdXQgYSBkcml2ZXIgbW92ZSBzbyBpdAorCSAqIGNhbiBkbyB0aWxpbmcgdGhpbmdz
IGFuZCBib29rLWtlZXBpbmcuCisJICoKKwkgKiBAZXZpY3Q6IHdoZXRoZXIgdGhpcyBtb3ZlIGlz
IGV2aWN0aW5nIHRoZSBidWZmZXIgZnJvbSB0aGUgZ3JhcGhpY3MKKwkgKiBhZGRyZXNzIHNwYWNl
CisJICovCisJdm9pZCAoKm1vdmVfbm90aWZ5KShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJv
LAorCQkJICAgIGJvb2wgZXZpY3QsCisJCQkgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqbmV3X21l
bSk7CisKKwkvKioKKwkgKiBub3RpZnkgdGhlIGRyaXZlciB0aGF0IHdlJ3JlIGFib3V0IHRvIHN3
YXAgb3V0IHRoaXMgYm8KKwkgKi8KKwl2b2lkICgqc3dhcF9ub3RpZnkpKHN0cnVjdCB0dG1fYnVm
ZmVyX29iamVjdCAqYm8pOworCisJLyoqCisJICogRHJpdmVyIGNhbGxiYWNrIG9uIHdoZW4gbWFw
cGluZyBpbyBtZW1vcnkgKGZvciBib19tb3ZlX21lbWNweQorCSAqIGZvciBpbnN0YW5jZSkuIFRU
TSB3aWxsIHRha2UgY2FyZSB0byBjYWxsIGlvX21lbV9mcmVlIHdoZW5ldmVyCisJICogdGhlIG1h
cHBpbmcgaXMgbm90IHVzZSBhbnltb3JlLiBpb19tZW1fcmVzZXJ2ZSAmIGlvX21lbV9mcmVlCisJ
ICogYXJlIGJhbGFuY2VkLgorCSAqLworCWludCAoKmlvX21lbV9yZXNlcnZlKShzdHJ1Y3QgdHRt
X2RldmljZSAqYmRldiwKKwkJCSAgICAgIHN0cnVjdCB0dG1fcmVzb3VyY2UgKm1lbSk7CisJdm9p
ZCAoKmlvX21lbV9mcmVlKShzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwKKwkJCSAgICBzdHJ1Y3Qg
dHRtX3Jlc291cmNlICptZW0pOworCisJLyoqCisJICogUmV0dXJuIHRoZSBwZm4gZm9yIGEgZ2l2
ZW4gcGFnZV9vZmZzZXQgaW5zaWRlIHRoZSBCTy4KKwkgKgorCSAqIEBibzogdGhlIEJPIHRvIGxv
b2sgdXAgdGhlIHBmbiBmb3IKKwkgKiBAcGFnZV9vZmZzZXQ6IHRoZSBvZmZzZXQgdG8gbG9vayB1
cAorCSAqLworCXVuc2lnbmVkIGxvbmcgKCppb19tZW1fcGZuKShzdHJ1Y3QgdHRtX2J1ZmZlcl9v
YmplY3QgKmJvLAorCQkJCSAgICB1bnNpZ25lZCBsb25nIHBhZ2Vfb2Zmc2V0KTsKKworCS8qKgor
CSAqIFJlYWQvd3JpdGUgbWVtb3J5IGJ1ZmZlcnMgZm9yIHB0cmFjZSBhY2Nlc3MKKwkgKgorCSAq
IEBibzogdGhlIEJPIHRvIGFjY2VzcworCSAqIEBvZmZzZXQ6IHRoZSBvZmZzZXQgZnJvbSB0aGUg
c3RhcnQgb2YgdGhlIEJPCisJICogQGJ1ZjogcG9pbnRlciB0byBzb3VyY2UvZGVzdGluYXRpb24g
YnVmZmVyCisJICogQGxlbjogbnVtYmVyIG9mIGJ5dGVzIHRvIGNvcHkKKwkgKiBAd3JpdGU6IHdo
ZXRoZXIgdG8gcmVhZCAoMCkgZnJvbSBvciB3cml0ZSAobm9uLTApIHRvIEJPCisJICoKKwkgKiBJ
ZiBzdWNjZXNzZnVsLCB0aGlzIGZ1bmN0aW9uIHNob3VsZCByZXR1cm4gdGhlIG51bWJlciBvZgor
CSAqIGJ5dGVzIGNvcGllZCwgLUVJTyBvdGhlcndpc2UuIElmIHRoZSBudW1iZXIgb2YgYnl0ZXMK
KwkgKiByZXR1cm5lZCBpcyA8IGxlbiwgdGhlIGZ1bmN0aW9uIG1heSBiZSBjYWxsZWQgYWdhaW4g
d2l0aAorCSAqIHRoZSByZW1haW5kZXIgb2YgdGhlIGJ1ZmZlciB0byBjb3B5LgorCSAqLworCWlu
dCAoKmFjY2Vzc19tZW1vcnkpKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sIHVuc2lnbmVk
IGxvbmcgb2Zmc2V0LAorCQkJICAgICB2b2lkICpidWYsIGludCBsZW4sIGludCB3cml0ZSk7CisK
KwkvKioKKwkgKiBzdHJ1Y3QgdHRtX2JvX2RyaXZlciBtZW1iZXIgZGVsX2Zyb21fbHJ1X25vdGlm
eQorCSAqCisJICogQGJvOiB0aGUgYnVmZmVyIG9iamVjdCBkZWxldGVkIGZyb20gbHJ1CisJICoK
KwkgKiBub3RpZnkgZHJpdmVyIHRoYXQgYSBCTyB3YXMgZGVsZXRlZCBmcm9tIExSVS4KKwkgKi8K
Kwl2b2lkICgqZGVsX2Zyb21fbHJ1X25vdGlmeSkoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpi
byk7CisKKwkvKioKKwkgKiBOb3RpZnkgdGhlIGRyaXZlciB0aGF0IHdlJ3JlIGFib3V0IHRvIHJl
bGVhc2UgYSBCTworCSAqCisJICogQGJvOiBCTyB0aGF0IGlzIGFib3V0IHRvIGJlIHJlbGVhc2Vk
CisJICoKKwkgKiBHaXZlcyB0aGUgZHJpdmVyIGEgY2hhbmNlIHRvIGRvIGFueSBjbGVhbnVwLCBp
bmNsdWRpbmcKKwkgKiBhZGRpbmcgZmVuY2VzIHRoYXQgbWF5IGZvcmNlIGEgZGVsYXllZCBkZWxl
dGUKKwkgKi8KKwl2b2lkICgqcmVsZWFzZV9ub3RpZnkpKHN0cnVjdCB0dG1fYnVmZmVyX29iamVj
dCAqYm8pOworfTsKKworLyoqCisgKiBzdHJ1Y3QgdHRtX2RldmljZSAtIEJ1ZmZlciBvYmplY3Qg
ZHJpdmVyIGRldmljZS1zcGVjaWZpYyBkYXRhLgorICoKKyAqIEBkcml2ZXI6IFBvaW50ZXIgdG8g
YSBzdHJ1Y3QgdHRtX2JvX2RyaXZlciBzdHJ1Y3Qgc2V0dXAgYnkgdGhlIGRyaXZlci4KKyAqIEBt
YW46IEFuIGFycmF5IG9mIHJlc291cmNlX21hbmFnZXJzLgorICogQHZtYV9tYW5hZ2VyOiBBZGRy
ZXNzIHNwYWNlIG1hbmFnZXIgKHBvaW50ZXIpCisgKiBscnVfbG9jazogU3BpbmxvY2sgdGhhdCBw
cm90ZWN0cyB0aGUgYnVmZmVyK2RldmljZSBscnUgbGlzdHMgYW5kCisgKiBkZGVzdHJveSBsaXN0
cy4KKyAqIEBkZXZfbWFwcGluZzogQSBwb2ludGVyIHRvIHRoZSBzdHJ1Y3QgYWRkcmVzc19zcGFj
ZSByZXByZXNlbnRpbmcgdGhlCisgKiBkZXZpY2UgYWRkcmVzcyBzcGFjZS4KKyAqIEB3cTogV29y
ayBxdWV1ZSBzdHJ1Y3R1cmUgZm9yIHRoZSBkZWxheWVkIGRlbGV0ZSB3b3JrcXVldWUuCisgKiBA
bm9fcmV0cnk6IERvbid0IHJldHJ5IGFsbG9jYXRpb24gaWYgaXQgZmFpbHMKKyAqCisgKi8KK3N0
cnVjdCB0dG1fZGV2aWNlIHsKKworCS8qCisJICogQ29uc3RhbnQgYWZ0ZXIgYm8gZGV2aWNlIGlu
aXQgLyBhdG9taWMuCisJICovCisJc3RydWN0IGxpc3RfaGVhZCBkZXZpY2VfbGlzdDsKKwlzdHJ1
Y3QgdHRtX2RldmljZV9mdW5jcyAqZnVuY3M7CisKKwkvKgorCSAqIGFjY2VzcyB2aWEgdHRtX21h
bmFnZXJfdHlwZS4KKwkgKi8KKwlzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgc3lzbWFuOwor
CXN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuX2RydltUVE1fTlVNX01FTV9UWVBFU107
CisKKwkvKgorCSAqIFByb3RlY3RlZCBieSBpbnRlcm5hbCBsb2Nrcy4KKwkgKi8KKwlzdHJ1Y3Qg
ZHJtX3ZtYV9vZmZzZXRfbWFuYWdlciAqdm1hX21hbmFnZXI7CisKKwkvKgorCSAqIFByb3RlY3Rl
ZCBieSB0aGUgZ2xvYmFsOmxydSBsb2NrLgorCSAqLworCXN0cnVjdCBsaXN0X2hlYWQgZGRlc3Ry
b3k7CisKKwkvKgorCSAqIFByb3RlY3RlZCBieSBsb2FkIC8gZmlyc3RvcGVuIC8gbGFzdGNsb3Nl
IC91bmxvYWQgc3luYy4KKwkgKi8KKworCXN0cnVjdCBhZGRyZXNzX3NwYWNlICpkZXZfbWFwcGlu
ZzsKKworCS8qCisJICogSW50ZXJuYWwgcHJvdGVjdGlvbi4KKwkgKi8KKworCXN0cnVjdCBkZWxh
eWVkX3dvcmsgd3E7CisKKwlib29sIG5lZWRfZG1hMzI7CisJYm9vbCBub19yZXRyeTsKK307CisK
K3N0YXRpYyBpbmxpbmUgc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICoKK3R0bV9tYW5hZ2Vy
X3R5cGUoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIGludCBtZW1fdHlwZSkKK3sKKwlyZXR1cm4g
YmRldi0+bWFuX2RydlttZW1fdHlwZV07Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZAordHRtX3Nl
dF9kcml2ZXJfbWFuYWdlcihzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwgaW50IHR5cGUsCisJCSAg
ICAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbmFnZXIpCit7CisJYmRldi0+bWFu
X2Rydlt0eXBlXSA9IG1hbmFnZXI7Cit9CisKKy8qKgorICogdHRtX2RldmljZV9pbml0CisgKgor
ICogQGJkZXY6IEEgcG9pbnRlciB0byBhIHN0cnVjdCB0dG1fZGV2aWNlIHRvIGluaXRpYWxpemUu
CisgKiBAZnVuY3M6IEEgcG9pbnRlciB0byBhIHN0cnVjdCB0dG1fYm9fZHJpdmVyIHNldCB1cCBi
eSB0aGUgY2FsbGVyLgorICogQG1hcHBpbmc6IFRoZSBhZGRyZXNzIHNwYWNlIHRvIHVzZSBmb3Ig
dGhpcyBiby4KKyAqIEB2bWFfbWFuYWdlcjogQSBwb2ludGVyIHRvIGEgdm1hIG1hbmFnZXIuCisg
KiBAbmVlZF9kbWEzMjogaWYgcGFnZSBhbGxvY2F0aW9ucyBzaG91bGQgdXNlIERNQTMyCisgKgor
ICogSW5pdGlhbGl6ZXMgYSBzdHJ1Y3QgdHRtX2RldmljZToKKyAqIFJldHVybnM6CisgKiAhMDog
RmFpbHVyZS4KKyAqLworaW50IHR0bV9kZXZpY2VfaW5pdChzdHJ1Y3QgdHRtX2RldmljZSAqYmRl
diwgc3RydWN0IHR0bV9kZXZpY2VfZnVuY3MgKmZ1bmNzLAorCQkgICAgc3RydWN0IGFkZHJlc3Nf
c3BhY2UgKm1hcHBpbmcsCisJCSAgICBzdHJ1Y3QgZHJtX3ZtYV9vZmZzZXRfbWFuYWdlciAqdm1h
X21hbmFnZXIsCisJCSAgICBib29sIG5lZWRfZG1hMzIpOworaW50IHR0bV9kZXZpY2VfcmVsZWFz
ZShzdHJ1Y3QgdHRtX2RldmljZSAqYmRldik7CisKKyNlbmRpZgpkaWZmIC0tZ2l0IGEvaW5jbHVk
ZS9kcm0vdHRtL3R0bV9yZXNvdXJjZS5oIGIvaW5jbHVkZS9kcm0vdHRtL3R0bV9yZXNvdXJjZS5o
CmluZGV4IDkxYjY3Y2VjYzZiNi4uYTYwZmZlNDA5YjYwIDEwMDY0NAotLS0gYS9pbmNsdWRlL2Ry
bS90dG0vdHRtX3Jlc291cmNlLmgKKysrIGIvaW5jbHVkZS9kcm0vdHRtL3R0bV9yZXNvdXJjZS5o
CkBAIC0zMyw3ICszMyw3IEBACiAKICNkZWZpbmUgVFRNX01BWF9CT19QUklPUklUWQk0VQogCi1z
dHJ1Y3QgdHRtX2JvX2RldmljZTsKK3N0cnVjdCB0dG1fZGV2aWNlOwogc3RydWN0IHR0bV9yZXNv
dXJjZV9tYW5hZ2VyOwogc3RydWN0IHR0bV9yZXNvdXJjZTsKIHN0cnVjdCB0dG1fcGxhY2U7CkBA
IC0yMzAsNyArMjMwLDcgQEAgdm9pZCB0dG1fcmVzb3VyY2VfZnJlZShzdHJ1Y3QgdHRtX2J1ZmZl
cl9vYmplY3QgKmJvLCBzdHJ1Y3QgdHRtX3Jlc291cmNlICpyZXMpOwogdm9pZCB0dG1fcmVzb3Vy
Y2VfbWFuYWdlcl9pbml0KHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuLAogCQkJICAg
ICAgIHVuc2lnbmVkIGxvbmcgcF9zaXplKTsKIAotaW50IHR0bV9yZXNvdXJjZV9tYW5hZ2VyX2Zv
cmNlX2xpc3RfY2xlYW4oc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsCitpbnQgdHRtX3Jlc291
cmNlX21hbmFnZXJfZm9yY2VfbGlzdF9jbGVhbihzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwKIAkJ
CQkJICBzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbik7CiAKIHZvaWQgdHRtX3Jlc291
cmNlX21hbmFnZXJfZGVidWcoc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYW4sCmRpZmYg
LS1naXQgYS9pbmNsdWRlL2RybS90dG0vdHRtX3R0LmggYi9pbmNsdWRlL2RybS90dG0vdHRtX3R0
LmgKaW5kZXggZTA0MmRlYzVlNmMxLi5hNTYwNjc4MTlhNTggMTAwNjQ0Ci0tLSBhL2luY2x1ZGUv
ZHJtL3R0bS90dG1fdHQuaAorKysgYi9pbmNsdWRlL2RybS90dG0vdHRtX3R0LmgKQEAgLTQ4LDcg
KzQ4LDcgQEAgc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4OwogICoKICAqIEBwYWdlczogQXJyYXkg
b2YgcGFnZXMgYmFja2luZyB0aGUgZGF0YS4KICAqIEBudW1fcGFnZXM6IE51bWJlciBvZiBwYWdl
cyBpbiB0aGUgcGFnZSBhcnJheS4KLSAqIEBiZGV2OiBQb2ludGVyIHRvIHRoZSBjdXJyZW50IHN0
cnVjdCB0dG1fYm9fZGV2aWNlLgorICogQGJkZXY6IFBvaW50ZXIgdG8gdGhlIGN1cnJlbnQgc3Ry
dWN0IHR0bV9kZXZpY2UuCiAgKiBAYmU6IFBvaW50ZXIgdG8gdGhlIHR0bSBiYWNrZW5kLgogICog
QHN3YXBfc3RvcmFnZTogUG9pbnRlciB0byBzaG1lbSBzdHJ1Y3QgZmlsZSBmb3Igc3dhcCBzdG9y
YWdlLgogICogQGNhY2hpbmdfc3RhdGU6IFRoZSBjdXJyZW50IGNhY2hpbmcgc3RhdGUgb2YgdGhl
IHBhZ2VzLgpAQCAtMTQ3LDE0ICsxNDcsMTQgQEAgdm9pZCB0dG1fZG1hX3R0X2Zpbmkoc3RydWN0
IHR0bV9kbWFfdHQgKnR0bV9kbWEpOwogICoKICAqIFVuYmluZCwgdW5wb3B1bGF0ZSBhbmQgZGVz
dHJveSBjb21tb24gc3RydWN0IHR0bV90dC4KICAqLwotdm9pZCB0dG1fdHRfZGVzdHJveShzdHJ1
Y3QgdHRtX2JvX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV90dCAqdHRtKTsKK3ZvaWQgdHRtX3R0
X2Rlc3Ryb3koc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSk7CiAK
IC8qKgogICogdHRtX3R0X2Rlc3Ryb3lfY29tbW9uOgogICoKICAqIENhbGxlZCBmcm9tIGRyaXZl
ciB0byBkZXN0cm95IGNvbW1vbiBwYXRoLgogICovCi12b2lkIHR0bV90dF9kZXN0cm95X2NvbW1v
bihzdHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV90dCAqdHRtKTsKK3ZvaWQg
dHRtX3R0X2Rlc3Ryb3lfY29tbW9uKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LCBzdHJ1Y3QgdHRt
X3R0ICp0dG0pOwogCiAvKioKICAqIHR0bV90dF9zd2FwaW46CkBAIC0xNjQsNyArMTY0LDcgQEAg
dm9pZCB0dG1fdHRfZGVzdHJveV9jb21tb24oc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0
cnVjdCB0dG1fdHQgKnR0bSk7CiAgKiBTd2FwIGluIGEgcHJldmlvdXNseSBzd2FwIG91dCB0dG1f
dHQuCiAgKi8KIGludCB0dG1fdHRfc3dhcGluKHN0cnVjdCB0dG1fdHQgKnR0bSk7Ci1pbnQgdHRt
X3R0X3N3YXBvdXQoc3RydWN0IHR0bV9ib19kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0
bSk7CitpbnQgdHRtX3R0X3N3YXBvdXQoc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIHN0cnVjdCB0
dG1fdHQgKnR0bSk7CiAKIC8qKgogICogdHRtX3R0X3BvcHVsYXRlIC0gYWxsb2NhdGUgcGFnZXMg
Zm9yIGEgdHRtCkBAIC0xNzMsNyArMTczLDcgQEAgaW50IHR0bV90dF9zd2Fwb3V0KHN0cnVjdCB0
dG1fYm9fZGV2aWNlICpiZGV2LCBzdHJ1Y3QgdHRtX3R0ICp0dG0pOwogICoKICAqIENhbGxzIHRo
ZSBkcml2ZXIgbWV0aG9kIHRvIGFsbG9jYXRlIHBhZ2VzIGZvciBhIHR0bQogICovCi1pbnQgdHRt
X3R0X3BvcHVsYXRlKHN0cnVjdCB0dG1fYm9fZGV2aWNlICpiZGV2LCBzdHJ1Y3QgdHRtX3R0ICp0
dG0sIHN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0eCAqY3R4KTsKK2ludCB0dG1fdHRfcG9wdWxhdGUo
c3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSwgc3RydWN0IHR0bV9v
cGVyYXRpb25fY3R4ICpjdHgpOwogCiAvKioKICAqIHR0bV90dF91bnBvcHVsYXRlIC0gZnJlZSBw
YWdlcyBmcm9tIGEgdHRtCkBAIC0xODIsNyArMTgyLDcgQEAgaW50IHR0bV90dF9wb3B1bGF0ZShz
dHJ1Y3QgdHRtX2JvX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV90dCAqdHRtLCBzdHJ1Y3QgdHRt
X28KICAqCiAgKiBDYWxscyB0aGUgZHJpdmVyIG1ldGhvZCB0byBmcmVlIGFsbCBwYWdlcyBmcm9t
IGEgdHRtCiAgKi8KLXZvaWQgdHRtX3R0X3VucG9wdWxhdGUoc3RydWN0IHR0bV9ib19kZXZpY2Ug
KmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0bSk7Cit2b2lkIHR0bV90dF91bnBvcHVsYXRlKHN0cnVj
dCB0dG1fZGV2aWNlICpiZGV2LCBzdHJ1Y3QgdHRtX3R0ICp0dG0pOwogCiAjaWYgSVNfRU5BQkxF
RChDT05GSUdfQUdQKQogI2luY2x1ZGUgPGxpbnV4L2FncF9iYWNrZW5kLmg+Ci0tIAoyLjE3LjEK
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZl
bCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xp
c3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbAo=
