Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id A8C3ABD90A
	for <lists+dri-devel@lfdr.de>; Wed, 25 Sep 2019 09:20:46 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7E27E6EB2E;
	Wed, 25 Sep 2019 07:20:37 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B10EE6EAEB;
 Tue, 24 Sep 2019 18:12:56 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 3CDFFABBD;
 Tue, 24 Sep 2019 18:12:55 +0000 (UTC)
From: Nicolas Saenz Julienne <nsaenzjulienne@suse.de>
To: robh+dt@kernel.org, devicetree@vger.kernel.org, frowand.list@gmail.com,
 linux-arm-kernel@lists.infradead.org, linux-wireless@vger.kernel.org,
 linux-kernel@vger.kernel.org, linux-arm-msm@vger.kernel.org,
 dmaengine@vger.kernel.org, etnaviv@lists.freedesktop.org,
 dri-devel@lists.freedesktop.org, xen-devel@lists.xenproject.org,
 linux-tegra@vger.kernel.org, linux-media@vger.kernel.org,
 linux-pci@vger.kernel.org
Subject: [PATCH 04/11] of: address: introduce of_translate_dma_address_parent()
Date: Tue, 24 Sep 2019 20:12:35 +0200
Message-Id: <20190924181244.7159-5-nsaenzjulienne@suse.de>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190924181244.7159-1-nsaenzjulienne@suse.de>
References: <20190924181244.7159-1-nsaenzjulienne@suse.de>
MIME-Version: 1.0
X-Mailman-Approved-At: Wed, 25 Sep 2019 07:19:29 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: f.fainelli@gmail.com, mbrugger@suse.com, wahrenst@gmx.net,
 james.quinlan@broadcom.com, robin.murphy@arm.com,
 Nicolas Saenz Julienne <nsaenzjulienne@suse.de>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

U29tZSBkZXZpY2VzIG1pZ2h0IG5vdCBoYXZlIGEgRFQgbm9kZSBvZiB0aGVpciBvd24sIGJ1dCBt
aWdodCBzdGlsbCBuZWVkCnRvIHRyYW5zbGF0ZSBETUEgYWRkcmVzc2VzIGJhc2VkIG9uIHRoZWly
IGJ1cyBEVCBub2RlLgoKVXBkYXRlIG9mX3RyYW5zbGF0ZV9kbWFfYWRkcmVzcygpIHRvIG9ubHkg
ZGVwZW5kIG9uIHRoZSBwYXJlbnQgRFQgbm9kZS4KUmVuYW1lIGl0IHRvIG9mX3RyYW5zbGF0ZV9k
bWFfYWRkcmVzc19wYXJlbnQoKS4gVGhlIGxhdGVyIHdpbGwgYmUgc3RpbGwKYXZhaWxhYmxlIGFz
IGEgd3JhcHBlciBhcm91bmQgdGhlIG5ldyBmdW5jdGlvbi4KClNpZ25lZC1vZmYtYnk6IE5pY29s
YXMgU2FlbnogSnVsaWVubmUgPG5zYWVuemp1bGllbm5lQHN1c2UuZGU+Ci0tLQoKIGRyaXZlcnMv
b2YvYWRkcmVzcy5jIHwgNjAgKysrKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0tLS0t
LS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCAzNiBpbnNlcnRpb25zKCspLCAyNCBkZWxldGlvbnMoLSkK
CmRpZmYgLS1naXQgYS9kcml2ZXJzL29mL2FkZHJlc3MuYyBiL2RyaXZlcnMvb2YvYWRkcmVzcy5j
CmluZGV4IDljMWU2MzhmYThlYS4uYzllYjRlYmNjMmU5IDEwMDY0NAotLS0gYS9kcml2ZXJzL29m
L2FkZHJlc3MuYworKysgYi9kcml2ZXJzL29mL2FkZHJlc3MuYwpAQCAtNTcwLDMzICs1NzAsMzIg
QEAgc3RhdGljIGludCBvZl90cmFuc2xhdGVfb25lKHN0cnVjdCBkZXZpY2Vfbm9kZSAqcGFyZW50
LCBzdHJ1Y3Qgb2ZfYnVzICpidXMsCiAgKiBkZXZpY2UgdGhhdCBoYWQgcmVnaXN0ZXJlZCBsb2dp
Y2FsIFBJTyBtYXBwaW5nLCBhbmQgdGhlIHJldHVybiBjb2RlIGlzCiAgKiByZWxhdGl2ZSB0byB0
aGF0IG5vZGUuCiAgKi8KLXN0YXRpYyB1NjQgX19vZl90cmFuc2xhdGVfYWRkcmVzcyhzdHJ1Y3Qg
ZGV2aWNlX25vZGUgKmRldiwKLQkJCQkgIHN0cnVjdCBkZXZpY2Vfbm9kZSAqKCpnZXRfcGFyZW50
KShjb25zdCBzdHJ1Y3QgZGV2aWNlX25vZGUgKiksCi0JCQkJICBjb25zdCBfX2JlMzIgKmluX2Fk
ZHIsIGNvbnN0IGNoYXIgKnJwcm9wLAotCQkJCSAgc3RydWN0IGRldmljZV9ub2RlICoqaG9zdCkK
K3N0YXRpYyB1NjQgX19vZl90cmFuc2xhdGVfYWRkcmVzc19wYXJlbnQoc3RydWN0IGRldmljZV9u
b2RlICpwYXJlbnQsCisJCQkJCSBzdHJ1Y3QgZGV2aWNlX25vZGUgKigqZ2V0X3BhcmVudCkKKwkJ
CQkJCShjb25zdCBzdHJ1Y3QgZGV2aWNlX25vZGUgKiksCisJCQkJCSBjb25zdCBfX2JlMzIgKmlu
X2FkZHIsCisJCQkJCSBjb25zdCBjaGFyICpycHJvcCwKKwkJCQkJIHN0cnVjdCBkZXZpY2Vfbm9k
ZSAqKmhvc3QpCiB7Ci0Jc3RydWN0IGRldmljZV9ub2RlICpwYXJlbnQgPSBOVUxMOworCXN0cnVj
dCBkZXZpY2Vfbm9kZSAqZGV2ID0gTlVMTDsKIAlzdHJ1Y3Qgb2ZfYnVzICpidXMsICpwYnVzOwog
CV9fYmUzMiBhZGRyW09GX01BWF9BRERSX0NFTExTXTsKIAlpbnQgbmEsIG5zLCBwbmEsIHBuczsK
IAl1NjQgcmVzdWx0ID0gT0ZfQkFEX0FERFI7CiAKLQlwcl9kZWJ1ZygiKiogdHJhbnNsYXRpb24g
Zm9yIGRldmljZSAlcE9GICoqXG4iLCBkZXYpOwotCi0JLyogSW5jcmVhc2UgcmVmY291bnQgYXQg
Y3VycmVudCBsZXZlbCAqLwotCW9mX25vZGVfZ2V0KGRldik7Ci0KIAkqaG9zdCA9IE5VTEw7Ci0J
LyogR2V0IHBhcmVudCAmIG1hdGNoIGJ1cyB0eXBlICovCi0JcGFyZW50ID0gZ2V0X3BhcmVudChk
ZXYpOwotCWlmIChwYXJlbnQgPT0gTlVMTCkKKworCWlmICghcGFyZW50KQogCQlnb3RvIGJhaWw7
CisKKwkvKiBJbmNyZWFzZSByZWZjb3VudCBhdCBjdXJyZW50IGxldmVsIGFuZCBtYXRjaCBidXMg
dHlwZSAqLworCW9mX25vZGVfZ2V0KHBhcmVudCk7CiAJYnVzID0gb2ZfbWF0Y2hfYnVzKHBhcmVu
dCk7CiAKIAkvKiBDb3VudCBhZGRyZXNzIGNlbGxzICYgY29weSBhZGRyZXNzIGxvY2FsbHkgKi8K
IAlidXMtPmNvdW50X2NlbGxzKHBhcmVudCwgJm5hLCAmbnMpOwogCWlmICghT0ZfQ0hFQ0tfQ09V
TlRTKG5hLCBucykpIHsKLQkJcHJfZGVidWcoIkJhZCBjZWxsIGNvdW50IGZvciAlcE9GXG4iLCBk
ZXYpOworCQlwcl9kZWJ1ZygiQmFkIGNlbGwgY291bnQgZm9yICVwT0ZcbiIsIHBhcmVudCk7CiAJ
CWdvdG8gYmFpbDsKIAl9CiAJbWVtY3B5KGFkZHIsIGluX2FkZHIsIG5hICogNCk7CkBAIC02MTAs
OSArNjA5LDggQEAgc3RhdGljIHU2NCBfX29mX3RyYW5zbGF0ZV9hZGRyZXNzKHN0cnVjdCBkZXZp
Y2Vfbm9kZSAqZGV2LAogCQlzdHJ1Y3QgbG9naWNfcGlvX2h3YWRkciAqaW9yYW5nZTsKIAogCQkv
KiBTd2l0Y2ggdG8gcGFyZW50IGJ1cyAqLwotCQlvZl9ub2RlX3B1dChkZXYpOwogCQlkZXYgPSBw
YXJlbnQ7Ci0JCXBhcmVudCA9IGdldF9wYXJlbnQoZGV2KTsKKwkJcGFyZW50ID0gZ2V0X3BhcmVu
dChwYXJlbnQpOwogCiAJCS8qIElmIHJvb3QsIHdlIGhhdmUgZmluaXNoZWQgKi8KIAkJaWYgKHBh
cmVudCA9PSBOVUxMKSB7CkBAIC02NTAsNiArNjQ4LDggQEAgc3RhdGljIHU2NCBfX29mX3RyYW5z
bGF0ZV9hZGRyZXNzKHN0cnVjdCBkZXZpY2Vfbm9kZSAqZGV2LAogCQkJYnJlYWs7CiAKIAkJLyog
Q29tcGxldGUgdGhlIG1vdmUgdXAgb25lIGxldmVsICovCisJCW9mX25vZGVfcHV0KGRldik7CisJ
CWRldiA9IHBhcmVudDsKIAkJbmEgPSBwbmE7CiAJCW5zID0gcG5zOwogCQlidXMgPSBwYnVzOwpA
QCAtNjY4LDggKzY2OCwxMCBAQCB1NjQgb2ZfdHJhbnNsYXRlX2FkZHJlc3Moc3RydWN0IGRldmlj
ZV9ub2RlICpkZXYsIGNvbnN0IF9fYmUzMiAqaW5fYWRkcikKIAlzdHJ1Y3QgZGV2aWNlX25vZGUg
Kmhvc3Q7CiAJdTY0IHJldDsKIAotCXJldCA9IF9fb2ZfdHJhbnNsYXRlX2FkZHJlc3MoZGV2LCBv
Zl9nZXRfcGFyZW50LAotCQkJCSAgICAgaW5fYWRkciwgInJhbmdlcyIsICZob3N0KTsKKwlwcl9k
ZWJ1ZygiKiogdHJhbnNsYXRpb24gZm9yIGRldmljZSAlcE9GICoqXG4iLCBkZXYpOworCisJcmV0
ID0gX19vZl90cmFuc2xhdGVfYWRkcmVzc19wYXJlbnQoZGV2LT5wYXJlbnQsIG9mX2dldF9wYXJl
bnQsCisJCQkJCSAgICBpbl9hZGRyLCAicmFuZ2VzIiwgJmhvc3QpOwogCWlmIChob3N0KSB7CiAJ
CW9mX25vZGVfcHV0KGhvc3QpOwogCQlyZXR1cm4gT0ZfQkFEX0FERFI7CkBAIC02OTcsMTQgKzY5
OSwxNCBAQCBzdGF0aWMgc3RydWN0IGRldmljZV9ub2RlICpfX29mX2dldF9kbWFfcGFyZW50KGNv
bnN0IHN0cnVjdCBkZXZpY2Vfbm9kZSAqbnApCiAJcmV0dXJuIG9mX25vZGVfZ2V0KGFyZ3MubnAp
OwogfQogCi11NjQgb2ZfdHJhbnNsYXRlX2RtYV9hZGRyZXNzKHN0cnVjdCBkZXZpY2Vfbm9kZSAq
ZGV2LCBjb25zdCBfX2JlMzIgKmluX2FkZHIpCitzdGF0aWMgdTY0IG9mX3RyYW5zbGF0ZV9kbWFf
YWRkcmVzc19wYXJlbnQoc3RydWN0IGRldmljZV9ub2RlICpwYXJlbnQsCisJCQkJCSAgIGNvbnN0
IF9fYmUzMiAqaW5fYWRkcikKIHsKIAlzdHJ1Y3QgZGV2aWNlX25vZGUgKmhvc3Q7CiAJdTY0IHJl
dDsKIAotCXJldCA9IF9fb2ZfdHJhbnNsYXRlX2FkZHJlc3MoZGV2LCBfX29mX2dldF9kbWFfcGFy
ZW50LAotCQkJCSAgICAgaW5fYWRkciwgImRtYS1yYW5nZXMiLCAmaG9zdCk7Ci0KKwlyZXQgPSBf
X29mX3RyYW5zbGF0ZV9hZGRyZXNzX3BhcmVudChwYXJlbnQsIF9fb2ZfZ2V0X2RtYV9wYXJlbnQs
IGluX2FkZHIsCisJCQkJCSAgICAiZG1hLXJhbmdlcyIsICZob3N0KTsKIAlpZiAoaG9zdCkgewog
CQlvZl9ub2RlX3B1dChob3N0KTsKIAkJcmV0dXJuIE9GX0JBRF9BRERSOwpAQCAtNzEyLDYgKzcx
NCwxNCBAQCB1NjQgb2ZfdHJhbnNsYXRlX2RtYV9hZGRyZXNzKHN0cnVjdCBkZXZpY2Vfbm9kZSAq
ZGV2LCBjb25zdCBfX2JlMzIgKmluX2FkZHIpCiAKIAlyZXR1cm4gcmV0OwogfQorCit1NjQgb2Zf
dHJhbnNsYXRlX2RtYV9hZGRyZXNzKHN0cnVjdCBkZXZpY2Vfbm9kZSAqZGV2LCBjb25zdCBfX2Jl
MzIgKmluX2FkZHIpCit7CisJcHJfZGVidWcoIioqIHRyYW5zbGF0aW9uIGZvciBkZXZpY2UgJXBP
RiAqKlxuIiwgZGV2KTsKKworCXJldHVybiBvZl90cmFuc2xhdGVfZG1hX2FkZHJlc3NfcGFyZW50
KF9fb2ZfZ2V0X2RtYV9wYXJlbnQoZGV2LT5wYXJlbnQpLAorCQkJCQkgICAgICAgaW5fYWRkcik7
Cit9CiBFWFBPUlRfU1lNQk9MKG9mX3RyYW5zbGF0ZV9kbWFfYWRkcmVzcyk7CiAKIGNvbnN0IF9f
YmUzMiAqb2ZfZ2V0X2FkZHJlc3Moc3RydWN0IGRldmljZV9ub2RlICpkZXYsIGludCBpbmRleCwg
dTY0ICpzaXplLApAQCAtNzU5LDggKzc2OSwxMCBAQCBzdGF0aWMgdTY0IG9mX3RyYW5zbGF0ZV9p
b3BvcnQoc3RydWN0IGRldmljZV9ub2RlICpkZXYsIGNvbnN0IF9fYmUzMiAqaW5fYWRkciwKIAl1
bnNpZ25lZCBsb25nIHBvcnQ7CiAJc3RydWN0IGRldmljZV9ub2RlICpob3N0OwogCi0JdGFkZHIg
PSBfX29mX3RyYW5zbGF0ZV9hZGRyZXNzKGRldiwgb2ZfZ2V0X3BhcmVudCwKLQkJCQkgICAgICAg
aW5fYWRkciwgInJhbmdlcyIsICZob3N0KTsKKwlwcl9kZWJ1ZygiKiogdHJhbnNsYXRpb24gZm9y
IGRldmljZSAlcE9GICoqXG4iLCBkZXYpOworCisJdGFkZHIgPSBfX29mX3RyYW5zbGF0ZV9hZGRy
ZXNzX3BhcmVudChkZXYtPnBhcmVudCwgb2ZfZ2V0X3BhcmVudCwKKwkJCQkJICAgICAgaW5fYWRk
ciwgInJhbmdlcyIsICZob3N0KTsKIAlpZiAoaG9zdCkgewogCQkvKiBob3N0LXNwZWNpZmljIHBv
cnQgYWNjZXNzICovCiAJCXBvcnQgPSBsb2dpY19waW9fdHJhbnNfaHdhZGRyKCZob3N0LT5md25v
ZGUsIHRhZGRyLCBzaXplKTsKLS0gCjIuMjMuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlz
dHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4v
bGlzdGluZm8vZHJpLWRldmVs
