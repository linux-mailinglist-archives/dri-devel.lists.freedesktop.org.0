Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id CD885796CD
	for <lists+dri-devel@lfdr.de>; Mon, 29 Jul 2019 21:55:54 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 00BF589D44;
	Mon, 29 Jul 2019 19:55:49 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from smtp.domeneshop.no (smtp.domeneshop.no
 [IPv6:2a01:5b40:0:3005::1])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A9E796E1D3
 for <dri-devel@lists.freedesktop.org>; Mon, 29 Jul 2019 19:55:48 +0000 (UTC)
Received: from 211.81-166-168.customer.lyse.net ([81.166.168.211]:57528
 helo=localhost.localdomain)
 by smtp.domeneshop.no with esmtpsa (TLS1.2:ECDHE_RSA_AES_128_CBC_SHA1:128)
 (Exim 4.84_2) (envelope-from <noralf@tronnes.org>)
 id 1hsBkI-0003F7-Gn; Mon, 29 Jul 2019 21:55:46 +0200
From: =?UTF-8?q?Noralf=20Tr=C3=B8nnes?= <noralf@tronnes.org>
To: dri-devel@lists.freedesktop.org
Subject: [RFC 1/4] drm/panel: Add Ilitek ILI9341 parallel RGB panel driver
Date: Mon, 29 Jul 2019 21:55:23 +0200
Message-Id: <20190729195526.13337-2-noralf@tronnes.org>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190729195526.13337-1-noralf@tronnes.org>
References: <20190729195526.13337-1-noralf@tronnes.org>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; d=tronnes.org; s=ds201810; 
 h=Content-Transfer-Encoding:MIME-Version:References:In-Reply-To:Message-Id:Date:Subject:Cc:To:From;
 bh=fLDNm0MClzrUfYGoDZi/cTIJXrji1H53LUAwEmmMHK4=; 
 b=dyNWSF41RFs3LJfmlNPLPFM9i3DyPfUms2NyRTkSzg6VfjMzFJCBJigVDiSyE7UQbo5qHh0OC4ZN0jzPVXmAOlqfw9DnEF53w6pNRb/mxTQThUSEvNoMV+0VyvOtVW81IiQQS+enAUhxY9JLUPb1Pf1Qzj6r86RCI34to51UWNBk4aOO0rN61+Q+nKcxD4Uric15Vj6BK/Xq4N9ufQWKL/u7+uy2re0NKaelQEz6pa1QlyaY/dydBAD2gZrcHeCjQdZ2NQx32FTbxjPPIYEmHH55Q7MuKADzDvBWQmw03Th9ttRss2t3PdM+7rHj6W5BWjGboO2YbpHwx/8SxXaVbg==;
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: daniel.vetter@ffwll.ch, josef@lusticky.cz, thierry.reding@gmail.com,
 laurent.pinchart@ideasonboard.com, sam@ravnborg.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogSm9zZWYgTHVzdGlja3kgPGpvc2VmQGx1c3RpY2t5LmN6PgoKQWRkIGRyaXZlciBmb3Ig
SWxpdGVrIElMSTkzNDEgcGFuZWxzIGluIHBhcmFsbGVsIFJHQiBtb2RlCgpTaWduZWQtb2ZmLWJ5
OiBKb3NlZiBMdXN0aWNreSA8am9zZWZAbHVzdGlja3kuY3o+Ci0tLQogTUFJTlRBSU5FUlMgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDYgKwogZHJpdmVycy9ncHUvZHJtL3Bh
bmVsL0tjb25maWcgICAgICAgICAgICAgICAgfCAgIDkgKwogZHJpdmVycy9ncHUvZHJtL3BhbmVs
L01ha2VmaWxlICAgICAgICAgICAgICAgfCAgIDEgKwogZHJpdmVycy9ncHUvZHJtL3BhbmVsL3Bh
bmVsLWlsaXRlay1pbGk5MzQxLmMgfCAyOTEgKysrKysrKysrKysrKysrKysrKwogNCBmaWxlcyBj
aGFuZ2VkLCAzMDcgaW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1
L2RybS9wYW5lbC9wYW5lbC1pbGl0ZWstaWxpOTM0MS5jCgpkaWZmIC0tZ2l0IGEvTUFJTlRBSU5F
UlMgYi9NQUlOVEFJTkVSUwppbmRleCAwNjBmZmU2MzU4MzIuLjFmNjM4ZDk2MTEzYiAxMDA2NDQK
LS0tIGEvTUFJTlRBSU5FUlMKKysrIGIvTUFJTlRBSU5FUlMKQEAgLTUxMTUsNiArNTExNSwxMiBA
QCBTOglNYWludGFpbmVkCiBGOglkcml2ZXJzL2dwdS9kcm0vdGlueWRybS9oeDgzNTdkLmMKIEY6
CURvY3VtZW50YXRpb24vZGV2aWNldHJlZS9iaW5kaW5ncy9kaXNwbGF5L2hpbWF4LGh4ODM1N2Qu
dHh0CiAKK0RSTSBEUklWRVIgRk9SIElMSVRFSyBJTEk5MzQxIFBBTkVMUworTToJSm9zZWYgTHVz
dGlja3kgPGpvc2VmQGx1c3RpY2t5LmN6PgorUzoJTWFpbnRhaW5lZAorRjoJZHJpdmVycy9ncHUv
ZHJtL3BhbmVsL3BhbmVsLWlsaXRlay1pbGk5MzQxLmMKK0Y6CURvY3VtZW50YXRpb24vZGV2aWNl
dHJlZS9iaW5kaW5ncy9kaXNwbGF5L3BhbmVsL2lsaXRlayxpbGk5MzQxLnR4dAorCiBEUk0gRFJJ
VkVSIEZPUiBJTlRFTCBJODEwIFZJREVPIENBUkRTCiBTOglPcnBoYW4gLyBPYnNvbGV0ZQogRjoJ
ZHJpdmVycy9ncHUvZHJtL2k4MTAvCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcGFuZWwv
S2NvbmZpZyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9LY29uZmlnCmluZGV4IGVhZWNkNDBjYzMy
ZS4uMzRhNWIyNjJmOTI0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvS2NvbmZp
ZworKysgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvS2NvbmZpZwpAQCAtNTYsNiArNTYsMTUgQEAg
Y29uZmlnIERSTV9QQU5FTF9JTElURUtfSUw5MzIyCiAJICBTYXkgWSBoZXJlIGlmIHlvdSB3YW50
IHRvIGVuYWJsZSBzdXBwb3J0IGZvciBJbGl0ZWsgSUw5MzIyCiAJICBRVkdBICgzMjB4MjQwKSBS
R0IsIFlVViBhbmQgSVRVLVQgQlQuNjU2IHBhbmVscy4KIAorY29uZmlnIERSTV9QQU5FTF9JTElU
RUtfSUxJOTM0MQorCXRyaXN0YXRlICJJbGl0ZWsgSUxJOTM0MSAyNDB4MzIwIHBhbmVscyIKKwlk
ZXBlbmRzIG9uIE9GICYmIFNQSQorCWRlcGVuZHMgb24gQkFDS0xJR0hUX0NMQVNTX0RFVklDRQor
CXNlbGVjdCBUSU5ZRFJNX01JUElfREJJCisJaGVscAorCSAgU2F5IFkgaGVyZSBpZiB5b3Ugd2Fu
dCB0byBlbmFibGUgc3VwcG9ydCBmb3IgSWxpdGVrIElMSTkzNDEKKwkgIFFWR0EgKDI0MHgzMjAp
IFJHQiBwYW5lbC4KKwogY29uZmlnIERSTV9QQU5FTF9JTElURUtfSUxJOTg4MUMKIAl0cmlzdGF0
ZSAiSWxpdGVrIElMSTk4ODFDLWJhc2VkIHBhbmVscyIKIAlkZXBlbmRzIG9uIE9GCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vcGFu
ZWwvTWFrZWZpbGUKaW5kZXggNjJkYWU0NWY4Zjc0Li5iYTRhMzAzYzFhNjYgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2dwdS9kcm0vcGFu
ZWwvTWFrZWZpbGUKQEAgLTQsNiArNCw3IEBAIG9iai0kKENPTkZJR19EUk1fUEFORUxfTFZEUykg
Kz0gcGFuZWwtbHZkcy5vCiBvYmotJChDT05GSUdfRFJNX1BBTkVMX1NJTVBMRSkgKz0gcGFuZWwt
c2ltcGxlLm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfRkVJWUFOR19GWTA3MDI0REkyNkEzMEQp
ICs9IHBhbmVsLWZlaXlhbmctZnkwNzAyNGRpMjZhMzBkLm8KIG9iai0kKENPTkZJR19EUk1fUEFO
RUxfSUxJVEVLX0lMOTMyMikgKz0gcGFuZWwtaWxpdGVrLWlsaTkzMjIubworb2JqLSQoQ09ORklH
X0RSTV9QQU5FTF9JTElURUtfSUxJOTM0MSkgKz0gcGFuZWwtaWxpdGVrLWlsaTkzNDEubwogb2Jq
LSQoQ09ORklHX0RSTV9QQU5FTF9JTElURUtfSUxJOTg4MUMpICs9IHBhbmVsLWlsaXRlay1pbGk5
ODgxYy5vCiBvYmotJChDT05GSUdfRFJNX1BBTkVMX0lOTk9MVVhfUDA3OVpDQSkgKz0gcGFuZWwt
aW5ub2x1eC1wMDc5emNhLm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfSkRJX0xUMDcwTUUwNTAw
MCkgKz0gcGFuZWwtamRpLWx0MDcwbWUwNTAwMC5vCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vcGFuZWwvcGFuZWwtaWxpdGVrLWlsaTkzNDEuYyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9w
YW5lbC1pbGl0ZWstaWxpOTM0MS5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAw
MDAwMC4uMGM3MDBiMTcxMDI1Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL3Bh
bmVsL3BhbmVsLWlsaXRlay1pbGk5MzQxLmMKQEAgLTAsMCArMSwyOTEgQEAKKy8vIFNQRFgtTGlj
ZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wKworLyoKKyAqIElsaXRlayBJTEk5MzQxIGRybV9wYW5l
bCBkcml2ZXIKKyAqIDI0MFJHQngzMjAgZG90cyByZXNvbHV0aW9uIFRGVCBMQ0QgZGlzcGxheQor
ICoKKyAqIFRoaXMgZHJpdmVyIHN1cHBvcnRzIHRoZSBmb2xsb3dpbmcgcGFuZWwgY29uZmlndXJh
dGlvbnM6CisgKiAtIENvbW1hbmQgaW50ZXJmYWNlOgorICogICAgIC0gTUlQSS1EQkkgVHlwZSAz
IE9wdGlvbiAxCisgKiAgICAgICAoOS1iaXQgU1BJIHdpdGggRGF0YS9Db21tYW5kIGJpdCAgLSBJ
TVszOjBdID0gMTEwMSkKKyAqICAgICAtIE1JUEktREJJIFR5cGUgMyBPcHRpb24gMworICogICAg
ICAgKDgtYml0IFNQSSB3aXRoIERhdGEvQ29tbWFuZCBHUElPIC0gSU1bMzowXSA9IDExMTApCisg
KiAtIEdyYXBoaWNhbCBkYXRhIGludGVyZmFjZToKKyAqICAgICAtIE1JUEktRFBJIDE4LWJpdCBw
YXJhbGxlbCBSR0IgaW50ZXJmYWNlCisgKgorICogQ29weXJpZ2h0IChDKSAyMDE5IEpvc2VmIEx1
c3RpY2t5IDxqb3NlZkBsdXN0aWNreS5jej4KKyAqCisgKi8KKworI2luY2x1ZGUgPGxpbnV4L2Jh
Y2tsaWdodC5oPgorI2luY2x1ZGUgPGxpbnV4L2RlbGF5Lmg+CisjaW5jbHVkZSA8bGludXgvZ3Bp
by9jb25zdW1lci5oPgorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgorI2luY2x1ZGUgPGxpbnV4
L29mX2RldmljZS5oPgorI2luY2x1ZGUgPGxpbnV4L3NwaS9zcGkuaD4KKworI2luY2x1ZGUgPHZp
ZGVvL21pcGlfZGlzcGxheS5oPgorCisjaW5jbHVkZSA8ZHJtL2RybV9tb2Rlcy5oPgorI2luY2x1
ZGUgPGRybS9kcm1fcGFuZWwuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3ByaW50Lmg+CisjaW5jbHVk
ZSA8ZHJtL3Rpbnlkcm0vbWlwaS1kYmkuaD4KKworLyogSUxJOTM0MSBleHRlbmRlZCByZWdpc3Rl
ciBzZXQgKFZlbmRvciBDb21tYW5kIFNldCkgKi8KKyNkZWZpbmUgSUxJOTM0MV9JRk1PREUgICAg
ICAgICAweEIwIC8vIGNsb2NrIHBvbGFyaXR5CisjZGVmaW5lIElMSTkzNDFfSUZDVEwgICAgICAg
ICAgMHhGNiAvLyBpbnRlcmZhY2UgY29ucm9sCisjZGVmaW5lIElMSTkzNDFfUEdBTUNUUkwgICAg
ICAgMHhFMCAvLyBwb3NpdGl2ZSBnYW1tYSBjb250cm9sCisjZGVmaW5lIElMSTkzNDFfTkdBTUNU
UkwgICAgICAgMHhFMSAvLyBuZWdhdGl2ZSBnYW1tYSBjb250cm9sCisKKyNkZWZpbmUgSUxJOTM0
MV9NQURDVExfTVYgICAgICBCSVQoNSkKKyNkZWZpbmUgSUxJOTM0MV9NQURDVExfTVggICAgICBC
SVQoNikKKyNkZWZpbmUgSUxJOTM0MV9NQURDVExfTVkgICAgICBCSVQoNykKKworLyoqCisgKiBz
dHJ1Y3QgaWxpOTM0MV9jb25maWcgLSB0aGUgZGlzcGxheSBzcGVjaWZpYyBjb25maWd1cmF0aW9u
CisgKiBAd2lkdGhfbW06IHBoeXNpY2FsIHBhbmVsIHdpZHRoIFttbV0KKyAqIEBoZWlnaHRfbW06
IHBoeXNpY2FsIHBhbmVsIGhlaWdodCBbbW1dCisgKi8KK3N0cnVjdCBpbGk5MzQxX2NvbmZpZyB7
CisJdTMyIHdpZHRoX21tOworCXUzMiBoZWlnaHRfbW07Cit9OworCitzdHJ1Y3QgaWxpOTM0MSB7
CisJc3RydWN0IGRybV9wYW5lbCBwYW5lbDsKKwlzdHJ1Y3QgbWlwaV9kYmkgKm1pcGk7CisJY29u
c3Qgc3RydWN0IGlsaTkzNDFfY29uZmlnICpjb25mOworfTsKKworc3RhdGljIGlubGluZSBzdHJ1
Y3QgaWxpOTM0MSAqcGFuZWxfdG9faWxpOTM0MShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKK3sK
KwlyZXR1cm4gY29udGFpbmVyX29mKHBhbmVsLCBzdHJ1Y3QgaWxpOTM0MSwgcGFuZWwpOworfQor
CitzdGF0aWMgaW50IGlsaTkzNDFfZGVpbml0KHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsLCBzdHJ1
Y3QgaWxpOTM0MSAqaWxpKQoreworCW1pcGlfZGJpX2NvbW1hbmQoaWxpLT5taXBpLCBNSVBJX0RD
U19TRVRfRElTUExBWV9PRkYpOworCW1pcGlfZGJpX2NvbW1hbmQoaWxpLT5taXBpLCBNSVBJX0RD
U19FTlRFUl9TTEVFUF9NT0RFKTsKKwltc2xlZXAoNSk7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRp
YyBpbnQgaWxpOTM0MV9pbml0KHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsLCBzdHJ1Y3QgaWxpOTM0
MSAqaWxpKQoreworCS8qIEhXIC8gU1cgUmVzZXQgZGlzcGxheSBhbmQgd2FpdCAqLworCWlmIChp
bGktPm1pcGktPnJlc2V0KQorCQltaXBpX2RiaV9od19yZXNldChpbGktPm1pcGkpOworCisJbWlw
aV9kYmlfY29tbWFuZChpbGktPm1pcGksIE1JUElfRENTX1NPRlRfUkVTRVQpOworCW1zbGVlcCgx
MjApOworCisJLyogUG9sYXJpdHkgKi8KKwltaXBpX2RiaV9jb21tYW5kKGlsaS0+bWlwaSwgSUxJ
OTM0MV9JRk1PREUsIDB4QzApOworCisJLyogSW50ZXJmYWNlIGNvbnRyb2wgKi8KKwltaXBpX2Ri
aV9jb21tYW5kKGlsaS0+bWlwaSwgSUxJOTM0MV9JRkNUTCwgMHgwOSwgMHgwMSwgMHgyNik7CisK
KwkvKiBQaXhlbCBmb3JtYXQgKi8KKwltaXBpX2RiaV9jb21tYW5kKGlsaS0+bWlwaSwgTUlQSV9E
Q1NfU0VUX1BJWEVMX0ZPUk1BVCwgTUlQSV9EQ1NfUElYRUxfRk1UXzE4QklUIDw8IDQpOworCisJ
LyogR2FtbWEgKi8KKwltaXBpX2RiaV9jb21tYW5kKGlsaS0+bWlwaSwgTUlQSV9EQ1NfU0VUX0dB
TU1BX0NVUlZFLCAweDAxKTsKKwltaXBpX2RiaV9jb21tYW5kKGlsaS0+bWlwaSwgSUxJOTM0MV9Q
R0FNQ1RSTCwKKwkJMHgwZiwgMHgzMSwgMHgyYiwgMHgwYywgMHgwZSwgMHgwOCwgMHg0ZSwgMHhm
MSwKKwkJMHgzNywgMHgwNywgMHgxMCwgMHgwMywgMHgwZSwgMHgwOSwgMHgwMCk7CisJbWlwaV9k
YmlfY29tbWFuZChpbGktPm1pcGksIElMSTkzNDFfTkdBTUNUUkwsCisJCTB4MDAsIDB4MGUsIDB4
MTQsIDB4MDMsIDB4MTEsIDB4MDcsIDB4MzEsIDB4YzEsCisJCTB4NDgsIDB4MDgsIDB4MGYsIDB4
MGMsIDB4MzEsIDB4MzYsIDB4MGYpOworCisJLyogUm90YXRpb24gKi8KKwltaXBpX2RiaV9jb21t
YW5kKGlsaS0+bWlwaSwgTUlQSV9EQ1NfU0VUX0FERFJFU1NfTU9ERSwgSUxJOTM0MV9NQURDVExf
TVgpOworCisJLyogRXhpdCBzbGVlcCBtb2RlICovCisJbWlwaV9kYmlfY29tbWFuZChpbGktPm1p
cGksIE1JUElfRENTX0VYSVRfU0xFRVBfTU9ERSk7CisJbXNsZWVwKDEyMCk7CisKKwltaXBpX2Ri
aV9jb21tYW5kKGlsaS0+bWlwaSwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlfT04pOworCisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyBpbnQgaWxpOTM0MV91bnByZXBhcmUoc3RydWN0IGRybV9wYW5lbCAq
cGFuZWwpCit7CisJc3RydWN0IGlsaTkzNDEgKmlsaSA9IHBhbmVsX3RvX2lsaTkzNDEocGFuZWwp
OworCisJcmV0dXJuIGlsaTkzNDFfZGVpbml0KHBhbmVsLCBpbGkpOworfQorCitzdGF0aWMgaW50
IGlsaTkzNDFfcHJlcGFyZShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKK3sKKwlzdHJ1Y3QgaWxp
OTM0MSAqaWxpID0gcGFuZWxfdG9faWxpOTM0MShwYW5lbCk7CisJaW50IHJldDsKKworCXJldCA9
IGlsaTkzNDFfaW5pdChwYW5lbCwgaWxpKTsKKwlpZiAocmV0IDwgMCkKKwkJaWxpOTM0MV91bnBy
ZXBhcmUocGFuZWwpOworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgaWxpOTM0MV9lbmFi
bGUoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwpCit7CisJc3RydWN0IGlsaTkzNDEgKmlsaSA9IHBh
bmVsX3RvX2lsaTkzNDEocGFuZWwpOworCisJcmV0dXJuIGJhY2tsaWdodF9lbmFibGUoaWxpLT5t
aXBpLT5iYWNrbGlnaHQpOworfQorCitzdGF0aWMgaW50IGlsaTkzNDFfZGlzYWJsZShzdHJ1Y3Qg
ZHJtX3BhbmVsICpwYW5lbCkKK3sKKwlzdHJ1Y3QgaWxpOTM0MSAqaWxpID0gcGFuZWxfdG9faWxp
OTM0MShwYW5lbCk7CisKKwlyZXR1cm4gYmFja2xpZ2h0X2Rpc2FibGUoaWxpLT5taXBpLT5iYWNr
bGlnaHQpOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgcHJnYl8y
NDB4MzIwX21vZGUgPSB7CisJLmNsb2NrID0gNjM1MCwKKworCS5oZGlzcGxheSA9IDI0MCwKKwku
aHN5bmNfc3RhcnQgPSAyNDAgKyAxMCwKKwkuaHN5bmNfZW5kID0gMjQwICsgMTAgKyAxMCwKKwku
aHRvdGFsID0gMjQwICsgMTAgKyAxMCArIDIwLAorCisJLnZkaXNwbGF5ID0gMzIwLAorCS52c3lu
Y19zdGFydCA9IDMyMCArIDQsCisJLnZzeW5jX2VuZCA9IDMyMCArIDQgKyAyLAorCS52dG90YWwg
PSAzMjAgKyA0ICsgMiArIDIsCisKKwkuZmxhZ3MgPSBEUk1fTU9ERV9GTEFHX05IU1lOQyB8IERS
TV9NT0RFX0ZMQUdfTlZTWU5DLAorCS50eXBlID0gRFJNX01PREVfVFlQRV9EUklWRVIgfCBEUk1f
TU9ERV9UWVBFX1BSRUZFUlJFRAorfTsKKworc3RhdGljIGludCBpbGk5MzQxX2dldF9tb2Rlcyhz
dHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKK3sKKwlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVj
dG9yID0gcGFuZWwtPmNvbm5lY3RvcjsKKwlzdHJ1Y3QgaWxpOTM0MSAqaWxpID0gcGFuZWxfdG9f
aWxpOTM0MShwYW5lbCk7CisJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGU7CisKKwltb2Rl
ID0gZHJtX21vZGVfZHVwbGljYXRlKHBhbmVsLT5kcm0sICZwcmdiXzI0MHgzMjBfbW9kZSk7CisJ
aWYgKCFtb2RlKSB7CisJCURSTV9ERVZfRVJST1IocGFuZWwtPmRybS0+ZGV2LCAiYmFkIG1vZGUg
b3IgZmFpbGVkIHRvIGFkZCBtb2RlXG4iKTsKKwkJcmV0dXJuIC1FTk9NRU07CisJfQorCisJZHJt
X21vZGVfc2V0X25hbWUobW9kZSk7CisKKwltb2RlLT53aWR0aF9tbSA9IGlsaS0+Y29uZi0+d2lk
dGhfbW07CisJbW9kZS0+aGVpZ2h0X21tID0gaWxpLT5jb25mLT5oZWlnaHRfbW07CisKKwljb25u
ZWN0b3ItPmRpc3BsYXlfaW5mby53aWR0aF9tbSA9IG1vZGUtPndpZHRoX21tOworCWNvbm5lY3Rv
ci0+ZGlzcGxheV9pbmZvLmhlaWdodF9tbSA9IG1vZGUtPmhlaWdodF9tbTsKKwljb25uZWN0b3It
PmRpc3BsYXlfaW5mby5idXNfZmxhZ3MgfD0gRFJNX0JVU19GTEFHX0RFX0hJR0ggfAorCQlEUk1f
QlVTX0ZMQUdfUElYREFUQV9QT1NFREdFIHwgRFJNX0JVU19GTEFHX1NZTkNfTkVHRURHRTsKKwor
CWRybV9tb2RlX3Byb2JlZF9hZGQoY29ubmVjdG9yLCBtb2RlKTsKKworCXJldHVybiAxOyAvKiBO
dW1iZXIgb2YgbW9kZXMgKi8KK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fcGFuZWxfZnVu
Y3MgaWxpOTM0MV9kcm1fZnVuY3MgPSB7CisJLmRpc2FibGUgPSBpbGk5MzQxX2Rpc2FibGUsCisJ
LnVucHJlcGFyZSA9IGlsaTkzNDFfdW5wcmVwYXJlLAorCS5wcmVwYXJlID0gaWxpOTM0MV9wcmVw
YXJlLAorCS5lbmFibGUgPSBpbGk5MzQxX2VuYWJsZSwKKwkuZ2V0X21vZGVzID0gaWxpOTM0MV9n
ZXRfbW9kZXMsCit9OworCitzdGF0aWMgaW50IGlsaTkzNDFfcHJvYmUoc3RydWN0IHNwaV9kZXZp
Y2UgKnNwaSkKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmc3BpLT5kZXY7CisJc3RydWN0IGls
aTkzNDEgKmlsaTsKKwlzdHJ1Y3QgbWlwaV9kYmkgKm1pcGk7CisJc3RydWN0IGdwaW9fZGVzYyAq
ZGNfZ3BpbzsKKwlpbnQgcmV0OworCisJbWlwaSA9IGRldm1fa3phbGxvYyhkZXYsIHNpemVvZigq
bWlwaSksIEdGUF9LRVJORUwpOworCWlmICghbWlwaSkKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlp
bGkgPSBkZXZtX2t6YWxsb2MoZGV2LCBzaXplb2YoKmlsaSksIEdGUF9LRVJORUwpOworCWlmICgh
aWxpKQorCQlyZXR1cm4gLUVOT01FTTsKKworCWlsaS0+bWlwaSA9IG1pcGk7CisKKwlzcGlfc2V0
X2RydmRhdGEoc3BpLCBpbGkpOworCisJLyoKKwkgKiBFdmVyeSBuZXcgaW5jYXJuYXRpb24gb2Yg
dGhpcyBkaXNwbGF5IG11c3QgaGF2ZSBhIHVuaXF1ZQorCSAqIGRhdGEgZW50cnkgZm9yIHRoZSBz
eXN0ZW0gaW4gdGhpcyBkcml2ZXIuCisJICovCisJaWxpLT5jb25mID0gb2ZfZGV2aWNlX2dldF9t
YXRjaF9kYXRhKGRldik7CisJaWYgKCFpbGktPmNvbmYpIHsKKwkJRFJNX0RFVl9FUlJPUihkZXYs
ICJtaXNzaW5nIGRldmljZSBjb25maWd1cmF0aW9uXG4iKTsKKwkJcmV0dXJuIC1FTk9ERVY7CisJ
fQorCisJaWxpLT5taXBpLT5yZXNldCA9IGRldm1fZ3Bpb2RfZ2V0X29wdGlvbmFsKGRldiwgInJl
c2V0IiwgR1BJT0RfT1VUX0hJR0gpOworCWlmIChJU19FUlIoaWxpLT5taXBpLT5yZXNldCkpIHsK
KwkJRFJNX0RFVl9FUlJPUihkZXYsICJmYWlsZWQgdG8gZ2V0IGdwaW8gJ3Jlc2V0J1xuIik7CisJ
CXJldHVybiBQVFJfRVJSKGlsaS0+bWlwaS0+cmVzZXQpOworCX0KKworCWlsaS0+bWlwaS0+YmFj
a2xpZ2h0ID0gZGV2bV9vZl9maW5kX2JhY2tsaWdodChkZXYpOworCWlmIChJU19FUlIoaWxpLT5t
aXBpLT5iYWNrbGlnaHQpKSB7CisJCURSTV9ERVZfRVJST1IoZGV2LCAiZmFpbGVkIHRvIGdldCBi
YWNrbGlnaHRcbiIpOworCQlyZXR1cm4gUFRSX0VSUihpbGktPm1pcGktPmJhY2tsaWdodCk7CisJ
fQorCisJZGNfZ3BpbyA9IGRldm1fZ3Bpb2RfZ2V0X29wdGlvbmFsKGRldiwgImRjIiwgR1BJT0Rf
T1VUX0xPVyk7CisJaWYgKElTX0VSUihkY19ncGlvKSkgeworCQlEUk1fREVWX0VSUk9SKGRldiwg
ImZhaWxlZCB0byBnZXQgZ3BpbyAnZGMnXG4iKTsKKwkJcmV0dXJuIFBUUl9FUlIoZGNfZ3Bpbyk7
CisJfQorCisJcmV0ID0gbWlwaV9kYmlfc3BpX2luaXQoc3BpLCBpbGktPm1pcGksIGRjX2dwaW8p
OworCWlmIChyZXQpIHsKKwkJRFJNX0RFVl9FUlJPUihkZXYsICJNSVBJLURCSSBTUEkgc2V0dXAg
ZmFpbGVkXG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlkcm1fcGFuZWxfaW5pdCgmaWxpLT5w
YW5lbCk7CisJaWxpLT5wYW5lbC5kZXYgPSBkZXY7CisJaWxpLT5wYW5lbC5mdW5jcyA9ICZpbGk5
MzQxX2RybV9mdW5jczsKKworCXJldHVybiBkcm1fcGFuZWxfYWRkKCZpbGktPnBhbmVsKTsKK30K
Kworc3RhdGljIGludCBpbGk5MzQxX3JlbW92ZShzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpKQorewor
CXN0cnVjdCBpbGk5MzQxICppbGkgPSBzcGlfZ2V0X2RydmRhdGEoc3BpKTsKKworCWRybV9wYW5l
bF9yZW1vdmUoJmlsaS0+cGFuZWwpOworCisJaWxpOTM0MV9kaXNhYmxlKCZpbGktPnBhbmVsKTsK
KwlpbGk5MzQxX3VucHJlcGFyZSgmaWxpLT5wYW5lbCk7CisKKwlyZXR1cm4gMDsKK30KKworc3Rh
dGljIGNvbnN0IHN0cnVjdCBpbGk5MzQxX2NvbmZpZyBkdDAyNGN0ZnRfZGF0YSA9IHsKKwkud2lk
dGhfbW0gPSAzNywKKwkuaGVpZ2h0X21tID0gNDksCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0
IG9mX2RldmljZV9pZCBpbGk5MzQxX29mX21hdGNoW10gPSB7CisJeyAuY29tcGF0aWJsZSA9ICJk
aXNwbGF5dGVjaCxkdDAyNGN0ZnQiLCAuZGF0YSA9ICZkdDAyNGN0ZnRfZGF0YSB9LAorCXsgLyog
c2VudGluZWwgKi8gfQorfTsKK01PRFVMRV9ERVZJQ0VfVEFCTEUob2YsIGlsaTkzNDFfb2ZfbWF0
Y2gpOworCitzdGF0aWMgc3RydWN0IHNwaV9kcml2ZXIgaWxpOTM0MV9kcml2ZXIgPSB7CisJLnBy
b2JlID0gaWxpOTM0MV9wcm9iZSwKKwkucmVtb3ZlID0gaWxpOTM0MV9yZW1vdmUsCisJLmRyaXZl
ciA9IHsKKwkJLm5hbWUgPSAicGFuZWwtaWxpdGVrLWlsaTkzNDEiLAorCQkub2ZfbWF0Y2hfdGFi
bGUgPSBpbGk5MzQxX29mX21hdGNoLAorCX0sCit9OworbW9kdWxlX3NwaV9kcml2ZXIoaWxpOTM0
MV9kcml2ZXIpOworCitNT0RVTEVfQVVUSE9SKCJKb3NlZiBMdXN0aWNreSA8am9zZWZAbHVzdGlj
a3kuY3o+Iik7CitNT0RVTEVfREVTQ1JJUFRJT04oIklMSTkzNDEgTENEIHBhbmVsIGRyaXZlciIp
OworTU9EVUxFX0xJQ0VOU0UoIkdQTCIpOwotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1k
ZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcv
bWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
