Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id E8FBAD6300
	for <lists+dri-devel@lfdr.de>; Mon, 14 Oct 2019 14:51:06 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D6D816E2B8;
	Mon, 14 Oct 2019 12:51:03 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-wm1-x341.google.com (mail-wm1-x341.google.com
 [IPv6:2a00:1450:4864:20::341])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 172896E2B2
 for <dri-devel@lists.freedesktop.org>; Mon, 14 Oct 2019 12:51:02 +0000 (UTC)
Received: by mail-wm1-x341.google.com with SMTP id v17so16626384wml.4
 for <dri-devel@lists.freedesktop.org>; Mon, 14 Oct 2019 05:51:01 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=xXohOh2PNnJ9mf9YhRZwip9mBy/jBn3bFjciUpmeUw4=;
 b=cYq86FuQU8eyxds/0Bw9s7VTfVcCgpkgSDo0eG+8EVuCTUhjfGhigDNOKzuQ0ZODs3
 FVdl3bbY/Qi77XVH3nqaxKi5sNhRhCLyRujkOzm3DtPpSlDHjmdYkmy1pmxIg2Soeeuq
 8HtaV1lUgrtlg0wKivK4fkVhvxMPyR0ZV6vBH9NSvG173L2Fh1dWksJ5PdPKKguMpNT+
 641LNnJ/wrhrEbKzsyI/UG2Qb9MaklaZ5GMf0kmwI9/O4CeyaXVhTnnLBDzkXypJUCEF
 Jdj03orAeySBPGGoF7j/bPnPVmf+lLz0Ye53Veje6prA0js2/R54Fr06DPn7xv4/m2ko
 FqMw==
X-Gm-Message-State: APjAAAW+d71Ecw7Q7Pwi2ycoDItBj/3O+Qj4SSSZcUgyZ2SU+8y/hgac
 w/vgWLm4UUu6x1+Yg3x2bYg=
X-Google-Smtp-Source: APXvYqzTwE5O9n8rJ9WGhkeHV5xRAZeMlsQ8CheFaxYiNfkPbL/58F5cNEHWnAoT0s/oSzkIM0NdxQ==
X-Received: by 2002:a1c:444:: with SMTP id 65mr15464247wme.84.1571057460214;
 Mon, 14 Oct 2019 05:51:00 -0700 (PDT)
Received: from localhost (p2E5BE2CE.dip0.t-ipconnect.de. [46.91.226.206])
 by smtp.gmail.com with ESMTPSA id z142sm28384710wmc.24.2019.10.14.05.50.58
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 14 Oct 2019 05:50:59 -0700 (PDT)
From: Thierry Reding <thierry.reding@gmail.com>
To: Thierry Reding <thierry.reding@gmail.com>
Subject: [PATCH 04/14] gpu: host1x: Request channels for clients, not devices
Date: Mon, 14 Oct 2019 14:50:39 +0200
Message-Id: <20191014125049.425101-5-thierry.reding@gmail.com>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191014125049.425101-1-thierry.reding@gmail.com>
References: <20191014125049.425101-1-thierry.reding@gmail.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=xXohOh2PNnJ9mf9YhRZwip9mBy/jBn3bFjciUpmeUw4=;
 b=KPpOwIQJCJ/ifOquBzI/rkkIhBfyPSn3Xrf5co8hRO4y6AhugJc5FSEci2erN/IVsX
 YmtK/lOh1oJdzNY4r8SJyTs+Z68b/uXeX6RA3958EWxYqb8jr0d6a/a6wUsgfTJWxb+H
 nCjvRoQxT2YzHt195lsXp+/sI+LQySt1kBX420UXTGz8fowz7BX3++U4GnhJl/lJjCj7
 TpPrsWMR349iXic1FEwtrTK1h7w0opSi1PVdFoZtRR2bqbb2WY33xk9mGK7cYP3Jvt1s
 CtKLE1rhPzv+PbGqVbENyqhz4AXLP5bl3jYF9+6X0qQVkAUcnVbKLpTspwG/zetvCs6L
 WzwA==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: linux-tegra@vger.kernel.org, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogVGhpZXJyeSBSZWRpbmcgPHRyZWRpbmdAbnZpZGlhLmNvbT4KCkEgc3RydWN0IGRldmlj
ZSBkb2Vzbid0IGNhcnJ5IG11Y2ggaW5mb3JtYXRpb24gdGhhdCBhIGNoYW5uZWwgbWlnaHQgYmUK
aW50ZXJlc3RlZCBpbiwgYnV0IHRoZSBjbGllbnQgdmVyeSBtdWNoIGRvZXMuIFJlcXVlc3QgY2hh
bm5lbHMgZm9yIHRoZQpjbGllbnRzIHJhdGhlciB0aGFuIHRoZWlyIHBhcmVudCBkZXZpY2VzIGFu
ZCBzdG9yZSBhIHBvaW50ZXIgdG8gdGhlbQppbiBvcmRlciB0byBoYXZlIHRoYXQgaW5mb3JtYXRp
b24gYXZhaWxhYmxlIHdoZW4gbmVlZGVkLgoKU2lnbmVkLW9mZi1ieTogVGhpZXJyeSBSZWRpbmcg
PHRyZWRpbmdAbnZpZGlhLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vdGVncmEvZ3IyZC5jIHwg
IDIgKy0KIGRyaXZlcnMvZ3B1L2RybS90ZWdyYS9ncjNkLmMgfCAgMiArLQogZHJpdmVycy9ncHUv
ZHJtL3RlZ3JhL3ZpYy5jICB8ICAyICstCiBkcml2ZXJzL2dwdS9ob3N0MXgvY2hhbm5lbC5jIHwg
MTMgKysrKysrKy0tLS0tLQogZHJpdmVycy9ncHUvaG9zdDF4L2NoYW5uZWwuaCB8ICAxICsKIGlu
Y2x1ZGUvbGludXgvaG9zdDF4LmggICAgICAgfCAgMiArLQogNiBmaWxlcyBjaGFuZ2VkLCAxMiBp
bnNlcnRpb25zKCspLCAxMCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vdGVncmEvZ3IyZC5jIGIvZHJpdmVycy9ncHUvZHJtL3RlZ3JhL2dyMmQuYwppbmRleCA2NDEy
OTljYzg1YjguLjNjYmI0YTAyOWM0MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3RlZ3Jh
L2dyMmQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdGVncmEvZ3IyZC5jCkBAIC00MCw3ICs0MCw3
IEBAIHN0YXRpYyBpbnQgZ3IyZF9pbml0KHN0cnVjdCBob3N0MXhfY2xpZW50ICpjbGllbnQpCiAJ
c3RydWN0IGdyMmQgKmdyMmQgPSB0b19ncjJkKGRybSk7CiAJaW50IGVycjsKIAotCWdyMmQtPmNo
YW5uZWwgPSBob3N0MXhfY2hhbm5lbF9yZXF1ZXN0KGNsaWVudC0+ZGV2KTsKKwlncjJkLT5jaGFu
bmVsID0gaG9zdDF4X2NoYW5uZWxfcmVxdWVzdChjbGllbnQpOwogCWlmICghZ3IyZC0+Y2hhbm5l
bCkKIAkJcmV0dXJuIC1FTk9NRU07CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90ZWdy
YS9ncjNkLmMgYi9kcml2ZXJzL2dwdS9kcm0vdGVncmEvZ3IzZC5jCmluZGV4IDhiOWEzNWIxY2Ji
My4uODdhMzg2MTM0Y2M0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdGVncmEvZ3IzZC5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS90ZWdyYS9ncjNkLmMKQEAgLTQ5LDcgKzQ5LDcgQEAgc3Rh
dGljIGludCBncjNkX2luaXQoc3RydWN0IGhvc3QxeF9jbGllbnQgKmNsaWVudCkKIAlzdHJ1Y3Qg
Z3IzZCAqZ3IzZCA9IHRvX2dyM2QoZHJtKTsKIAlpbnQgZXJyOwogCi0JZ3IzZC0+Y2hhbm5lbCA9
IGhvc3QxeF9jaGFubmVsX3JlcXVlc3QoY2xpZW50LT5kZXYpOworCWdyM2QtPmNoYW5uZWwgPSBo
b3N0MXhfY2hhbm5lbF9yZXF1ZXN0KGNsaWVudCk7CiAJaWYgKCFncjNkLT5jaGFubmVsKQogCQly
ZXR1cm4gLUVOT01FTTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3RlZ3JhL3ZpYy5j
IGIvZHJpdmVycy9ncHUvZHJtL3RlZ3JhL3ZpYy5jCmluZGV4IGNkMDM5OWZkOGM2My4uYzk3YTYx
Yzg3N2FmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdGVncmEvdmljLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL3RlZ3JhL3ZpYy5jCkBAIC0xOTgsNyArMTk4LDcgQEAgc3RhdGljIGludCB2
aWNfaW5pdChzdHJ1Y3QgaG9zdDF4X2NsaWVudCAqY2xpZW50KQogCQl2aWMtPmRvbWFpbiA9IHRl
Z3JhLT5kb21haW47CiAJfQogCi0JdmljLT5jaGFubmVsID0gaG9zdDF4X2NoYW5uZWxfcmVxdWVz
dChjbGllbnQtPmRldik7CisJdmljLT5jaGFubmVsID0gaG9zdDF4X2NoYW5uZWxfcmVxdWVzdChj
bGllbnQpOwogCWlmICghdmljLT5jaGFubmVsKSB7CiAJCWVyciA9IC1FTk9NRU07CiAJCWdvdG8g
ZGV0YWNoOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvaG9zdDF4L2NoYW5uZWwuYyBiL2RyaXZl
cnMvZ3B1L2hvc3QxeC9jaGFubmVsLmMKaW5kZXggMTQzNjI5NWFhNDUwLi40Y2QyMTJiYjU3MGQg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2hvc3QxeC9jaGFubmVsLmMKKysrIGIvZHJpdmVycy9n
cHUvaG9zdDF4L2NoYW5uZWwuYwpAQCAtMTE1LDE0ICsxMTUsMTQgQEAgc3RhdGljIHN0cnVjdCBo
b3N0MXhfY2hhbm5lbCAqYWNxdWlyZV91bnVzZWRfY2hhbm5lbChzdHJ1Y3QgaG9zdDF4ICpob3N0
KQogCiAvKioKICAqIGhvc3QxeF9jaGFubmVsX3JlcXVlc3QoKSAtIEFsbG9jYXRlIGEgY2hhbm5l
bAotICogQGRldmljZTogSG9zdDF4IHVuaXQgdGhpcyBjaGFubmVsIHdpbGwgYmUgdXNlZCB0byBz
ZW5kIGNvbW1hbmRzIHRvCisgKiBAY2xpZW50OiBIb3N0MXggY2xpZW50IHRoaXMgY2hhbm5lbCB3
aWxsIGJlIHVzZWQgdG8gc2VuZCBjb21tYW5kcyB0bwogICoKLSAqIEFsbG9jYXRlcyBhIG5ldyBo
b3N0MXggY2hhbm5lbCBmb3IgQGRldmljZS4gTWF5IHJldHVybiBOVUxMIGlmIENETUEKKyAqIEFs
bG9jYXRlcyBhIG5ldyBob3N0MXggY2hhbm5lbCBmb3IgQGNsaWVudC4gTWF5IHJldHVybiBOVUxM
IGlmIENETUEKICAqIGluaXRpYWxpemF0aW9uIGZhaWxzLgogICovCi1zdHJ1Y3QgaG9zdDF4X2No
YW5uZWwgKmhvc3QxeF9jaGFubmVsX3JlcXVlc3Qoc3RydWN0IGRldmljZSAqZGV2KQorc3RydWN0
IGhvc3QxeF9jaGFubmVsICpob3N0MXhfY2hhbm5lbF9yZXF1ZXN0KHN0cnVjdCBob3N0MXhfY2xp
ZW50ICpjbGllbnQpCiB7Ci0Jc3RydWN0IGhvc3QxeCAqaG9zdCA9IGRldl9nZXRfZHJ2ZGF0YShk
ZXYtPnBhcmVudCk7CisJc3RydWN0IGhvc3QxeCAqaG9zdCA9IGRldl9nZXRfZHJ2ZGF0YShjbGll
bnQtPmRldi0+cGFyZW50KTsKIAlzdHJ1Y3QgaG9zdDF4X2NoYW5uZWxfbGlzdCAqY2hsaXN0ID0g
Jmhvc3QtPmNoYW5uZWxfbGlzdDsKIAlzdHJ1Y3QgaG9zdDF4X2NoYW5uZWwgKmNoYW5uZWw7CiAJ
aW50IGVycjsKQEAgLTEzMyw3ICsxMzMsOCBAQCBzdHJ1Y3QgaG9zdDF4X2NoYW5uZWwgKmhvc3Qx
eF9jaGFubmVsX3JlcXVlc3Qoc3RydWN0IGRldmljZSAqZGV2KQogCiAJa3JlZl9pbml0KCZjaGFu
bmVsLT5yZWZjb3VudCk7CiAJbXV0ZXhfaW5pdCgmY2hhbm5lbC0+c3VibWl0bG9jayk7Ci0JY2hh
bm5lbC0+ZGV2ID0gZGV2OworCWNoYW5uZWwtPmNsaWVudCA9IGNsaWVudDsKKwljaGFubmVsLT5k
ZXYgPSBjbGllbnQtPmRldjsKIAogCWVyciA9IGhvc3QxeF9od19jaGFubmVsX2luaXQoaG9zdCwg
Y2hhbm5lbCwgY2hhbm5lbC0+aWQpOwogCWlmIChlcnIgPCAwKQpAQCAtMTQ4LDcgKzE0OSw3IEBA
IHN0cnVjdCBob3N0MXhfY2hhbm5lbCAqaG9zdDF4X2NoYW5uZWxfcmVxdWVzdChzdHJ1Y3QgZGV2
aWNlICpkZXYpCiBmYWlsOgogCWNsZWFyX2JpdChjaGFubmVsLT5pZCwgY2hsaXN0LT5hbGxvY2F0
ZWRfY2hhbm5lbHMpOwogCi0JZGV2X2VycihkZXYsICJmYWlsZWQgdG8gaW5pdGlhbGl6ZSBjaGFu
bmVsXG4iKTsKKwlkZXZfZXJyKGNsaWVudC0+ZGV2LCAiZmFpbGVkIHRvIGluaXRpYWxpemUgY2hh
bm5lbFxuIik7CiAKIAlyZXR1cm4gTlVMTDsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2hv
c3QxeC9jaGFubmVsLmggYi9kcml2ZXJzL2dwdS9ob3N0MXgvY2hhbm5lbC5oCmluZGV4IDRmZDY5
NDgzNGY3NC4uMzkwNDRmZjZjM2FhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9ob3N0MXgvY2hh
bm5lbC5oCisrKyBiL2RyaXZlcnMvZ3B1L2hvc3QxeC9jaGFubmVsLmgKQEAgLTI2LDYgKzI2LDcg
QEAgc3RydWN0IGhvc3QxeF9jaGFubmVsIHsKIAl1bnNpZ25lZCBpbnQgaWQ7CiAJc3RydWN0IG11
dGV4IHN1Ym1pdGxvY2s7CiAJdm9pZCBfX2lvbWVtICpyZWdzOworCXN0cnVjdCBob3N0MXhfY2xp
ZW50ICpjbGllbnQ7CiAJc3RydWN0IGRldmljZSAqZGV2OwogCXN0cnVjdCBob3N0MXhfY2RtYSBj
ZG1hOwogfTsKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvaG9zdDF4LmggYi9pbmNsdWRlL2xp
bnV4L2hvc3QxeC5oCmluZGV4IGU2ZWVhNDVlMTE1NC4uNDM5NmNkNTY2YTMzIDEwMDY0NAotLS0g
YS9pbmNsdWRlL2xpbnV4L2hvc3QxeC5oCisrKyBiL2luY2x1ZGUvbGludXgvaG9zdDF4LmgKQEAg
LTE1OCw3ICsxNTgsNyBAQCB1MzIgaG9zdDF4X3N5bmNwdF9iYXNlX2lkKHN0cnVjdCBob3N0MXhf
c3luY3B0X2Jhc2UgKmJhc2UpOwogc3RydWN0IGhvc3QxeF9jaGFubmVsOwogc3RydWN0IGhvc3Qx
eF9qb2I7CiAKLXN0cnVjdCBob3N0MXhfY2hhbm5lbCAqaG9zdDF4X2NoYW5uZWxfcmVxdWVzdChz
dHJ1Y3QgZGV2aWNlICpkZXYpOworc3RydWN0IGhvc3QxeF9jaGFubmVsICpob3N0MXhfY2hhbm5l
bF9yZXF1ZXN0KHN0cnVjdCBob3N0MXhfY2xpZW50ICpjbGllbnQpOwogc3RydWN0IGhvc3QxeF9j
aGFubmVsICpob3N0MXhfY2hhbm5lbF9nZXQoc3RydWN0IGhvc3QxeF9jaGFubmVsICpjaGFubmVs
KTsKIHZvaWQgaG9zdDF4X2NoYW5uZWxfcHV0KHN0cnVjdCBob3N0MXhfY2hhbm5lbCAqY2hhbm5l
bCk7CiBpbnQgaG9zdDF4X2pvYl9zdWJtaXQoc3RydWN0IGhvc3QxeF9qb2IgKmpvYik7Ci0tIAoy
LjIzLjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRy
aS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRw
czovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
