Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id BF5B444C3C
	for <lists+dri-devel@lfdr.de>; Thu, 13 Jun 2019 21:36:47 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3998F8990D;
	Thu, 13 Jun 2019 19:36:45 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-vs1-f68.google.com (mail-vs1-f68.google.com
 [209.85.217.68])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 29A448990D
 for <dri-devel@lists.freedesktop.org>; Thu, 13 Jun 2019 19:36:44 +0000 (UTC)
Received: by mail-vs1-f68.google.com with SMTP id k9so212784vso.5
 for <dri-devel@lists.freedesktop.org>; Thu, 13 Jun 2019 12:36:44 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=o+i+eiasTkfYEcrQ2dOj0ucttuZAxRNcehcSsjgb96s=;
 b=YxiydGmRAbhFyLOK3Sl95M/5gST9OPIFaNJgb5Hpzbqaus0knVXlrDcaavYniVR0t0
 FcpjrCwW6IAYvoXqLcjHJQnua3s2GmedxMDFWL920JQQ3KfW9iwsk2FyB56Y/Sw6XadE
 1v5SO/zdLGJ5I9DYQBiN0rsFQWbzAmPQMh/wT4UtJWE9ct5zy0p61aNkb8Ae7MFWvYZV
 yIOFOmChPQ5VZYXIdroXR/2oteKNhTzo6tZ3ZSEMfbLKpk+crAINeHUGOjjv3eXaTQXi
 kNaXocpsgSBgakmG3/B0r7GNLMuVEIqZVMvPtB9l4Ej0dHb9mJs3S9eNkz0f8KtKaasA
 V+pw==
X-Gm-Message-State: APjAAAU5QWpq0uzsBqd/3QcKWJKS+4o5S0415wqqKXlMRNF3HivRJjK9
 it4mR1hBYMeuTJ/p0i/6Hn1A6ojx+ZkrH/fB0dY=
X-Google-Smtp-Source: APXvYqxeeMtqe7NcF5oHjInGzrCJEEiYq7W7Xoy2Y3UhZeJeSsPQSLGyNN0HDvz7tp1wj1nJ2OakxecrX5T6GP4Hd2k=
X-Received: by 2002:a67:ea42:: with SMTP id r2mr39029274vso.207.1560454603137; 
 Thu, 13 Jun 2019 12:36:43 -0700 (PDT)
MIME-Version: 1.0
References: <20190613192244.5447-1-ezequiel@collabora.com>
In-Reply-To: <20190613192244.5447-1-ezequiel@collabora.com>
From: Ilia Mirkin <imirkin@alum.mit.edu>
Date: Thu, 13 Jun 2019 15:36:32 -0400
Message-ID: <CAKb7UvhxnysEPrw2javE=OK8qop=3LPuRphbu_WQKvgCJYU6Kg@mail.gmail.com>
Subject: Re: [RFC/WIP] drm/rockchip: Support CRTC gamma LUT
To: Ezequiel Garcia <ezequiel@collabora.com>
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Douglas Anderson <dianders@chromium.org>,
 dri-devel <dri-devel@lists.freedesktop.org>,
 linux-rockchip@lists.infradead.org,
 Boris Brezillon <boris.brezillon@collabora.com>,
 Sean Paul <seanpaul@chromium.org>, kernel@collabora.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

Tm90ZSB0aGF0IHVzZXJzcGFjZSBtYXkgcHJvdmlkZSBhbnkgc2l6ZSBvZiBnYW1tYSBsdXQuIEhh
dmUgYSBsb29rIGF0Cmk5MTUvaW50ZWxfY29sb3IuYzppbnRlbF9jb2xvcl9jaGVjayB3aGljaCBm
aWx0ZXJzIG91dCBvbmx5IHRoZQphbGxvd2VkIHNpemVzLiBDb25zaWRlciBoYXZpbmcgYSBzcGVj
aWFsIGFsbG93YW5jZSBmb3IgMjU2LXNpemVkIExVVHMKc2luY2UgdGhhdCdzIHdoYXQgbW9zdCBs
ZWdhY3kgdXNlcnNwYWNlIHdpbGwgc2V0LCBhbmQgaXQgc2VlbXMgbGlrZSBhCndhc3RlIHRvIGNy
ZWF0ZSBhIDEwLWJpdCBMVVQgZm9yIFJHQkE4IGNvbG9yLgoKICAtaWxpYQoKT24gVGh1LCBKdW4g
MTMsIDIwMTkgYXQgMzoyMyBQTSBFemVxdWllbCBHYXJjaWEgPGV6ZXF1aWVsQGNvbGxhYm9yYS5j
b20+IHdyb3RlOgo+Cj4gQWRkIENSVEMgZ2FtbWEgTFVUIGNvbmZpZ3VyYXRpb24gb24gUkszMjg4
IGFuZCBSSzMzOTkuCj4KPiBTaWduZWQtb2ZmLWJ5OiBFemVxdWllbCBHYXJjaWEgPGV6ZXF1aWVs
QGNvbGxhYm9yYS5jb20+Cj4gLS0tCj4gVGhpcyBwYXRjaCBzZWVtcyB0byB3b3JrIHdlbGwgb24g
UkszMjg4LCBidXQgcHJvZHVjZXMKPiBhIGRpc3RvcnRlZCBvdXRwdXQgb24gUkszMzk5LiBJIHdh
cyBob3BpbmcKPiBzb21lb25lIGNvdWxkIGhhdmUgYW55IGlkZWEsIHNvIHdlIGNhbiBzdXBwb3J0
IGJvdGgKPiBwbGF0Zm9ybXMuCj4KPiAgZHJpdmVycy9ncHUvZHJtL3JvY2tjaGlwL3JvY2tjaGlw
X2RybV92b3AuYyB8IDg3ICsrKysrKysrKysrKysrKysrKysrKwo+ICBkcml2ZXJzL2dwdS9kcm0v
cm9ja2NoaXAvcm9ja2NoaXBfZHJtX3ZvcC5oIHwgIDIgKwo+ICBkcml2ZXJzL2dwdS9kcm0vcm9j
a2NoaXAvcm9ja2NoaXBfdm9wX3JlZy5jIHwgIDQgKwo+ICBkcml2ZXJzL2dwdS9kcm0vcm9ja2No
aXAvcm9ja2NoaXBfdm9wX3JlZy5oIHwgIDEgKwo+ICA0IGZpbGVzIGNoYW5nZWQsIDk0IGluc2Vy
dGlvbnMoKykKPgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcm9ja2NoaXAvcm9ja2No
aXBfZHJtX3ZvcC5jIGIvZHJpdmVycy9ncHUvZHJtL3JvY2tjaGlwL3JvY2tjaGlwX2RybV92b3Au
Ywo+IGluZGV4IDEyZWQ1MjY1YTkwYi4uODM4MTY3OWMxMDQ1IDEwMDY0NAo+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9yb2NrY2hpcC9yb2NrY2hpcF9kcm1fdm9wLmMKPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vcm9ja2NoaXAvcm9ja2NoaXBfZHJtX3ZvcC5jCj4gQEAgLTM4LDYgKzM4LDggQEAKPiAg
I2luY2x1ZGUgInJvY2tjaGlwX2RybV92b3AuaCIKPiAgI2luY2x1ZGUgInJvY2tjaGlwX3JnYi5o
Igo+Cj4gKyNkZWZpbmUgVk9QX0dBTU1BX0xVVF9TSVpFIDEwMjQKPiArCj4gICNkZWZpbmUgVk9Q
X1dJTl9TRVQodm9wLCB3aW4sIG5hbWUsIHYpIFwKPiAgICAgICAgICAgICAgICAgdm9wX3JlZ19z
ZXQodm9wLCAmd2luLT5waHktPm5hbWUsIHdpbi0+YmFzZSwgfjAsIHYsICNuYW1lKQo+ICAjZGVm
aW5lIFZPUF9TQ0xfU0VUKHZvcCwgd2luLCBuYW1lLCB2KSBcCj4gQEAgLTEzNyw2ICsxMzksNyBA
QCBzdHJ1Y3Qgdm9wIHsKPgo+ICAgICAgICAgdWludDMyX3QgKnJlZ3NiYWs7Cj4gICAgICAgICB2
b2lkIF9faW9tZW0gKnJlZ3M7Cj4gKyAgICAgICB2b2lkIF9faW9tZW0gKmx1dF9yZWdzOwo+Cj4g
ICAgICAgICAvKiBwaHlzaWNhbCBtYXAgbGVuZ3RoIG9mIHZvcCByZWdpc3RlciAqLwo+ICAgICAg
ICAgdWludDMyX3QgbGVuOwo+IEBAIC0xMTUzLDYgKzExNTYsNDYgQEAgc3RhdGljIHZvaWQgdm9w
X3dhaXRfZm9yX2lycV9oYW5kbGVyKHN0cnVjdCB2b3AgKnZvcCkKPiAgICAgICAgIHN5bmNocm9u
aXplX2lycSh2b3AtPmlycSk7Cj4gIH0KPgo+ICtzdGF0aWMgYm9vbCB2b3BfZHNwX2x1dF9pc19l
bmFibGUoc3RydWN0IHZvcCAqdm9wKQo+ICt7Cj4gKyAgICAgICByZXR1cm4gdm9wX3JlYWRfcmVn
KHZvcCwgMCwgJnZvcC0+ZGF0YS0+Y29tbW9uLT5kc3BfbHV0X2VuKTsKPiArfQo+ICsKPiArc3Rh
dGljIHZvaWQgdm9wX2NydGNfZ2FtbWFfc2V0KHN0cnVjdCB2b3AgKnZvcCwgc3RydWN0IGRybV9j
cnRjICpjcnRjLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgZHJtX2Ny
dGNfc3RhdGUgKnN0YXRlKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX2NvbG9yX2x1dCAqbHV0
Owo+ICsgICAgICAgaW50IGksIGlkbGUsIHJldDsKPiArCj4gKyAgICAgICBpZiAoIXN0YXRlLT5n
YW1tYV9sdXQpCj4gKyAgICAgICAgICAgICAgIHJldHVybjsKPiArICAgICAgIGx1dCA9IHN0YXRl
LT5nYW1tYV9sdXQtPmRhdGE7Cj4gKwo+ICsgICAgICAgc3Bpbl9sb2NrKCZ2b3AtPnJlZ19sb2Nr
KTsKPiArICAgICAgIFZPUF9SRUdfU0VUKHZvcCwgY29tbW9uLCBkc3BfbHV0X2VuLCAwKTsKPiAr
ICAgICAgIHZvcF9jZmdfZG9uZSh2b3ApOwo+ICsgICAgICAgc3Bpbl91bmxvY2soJnZvcC0+cmVn
X2xvY2spOwo+ICsKPiArICAgICAgIHJldCA9IHJlYWR4X3BvbGxfdGltZW91dCh2b3BfZHNwX2x1
dF9pc19lbmFibGUsIHZvcCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICBpZGxlLCAhaWRs
ZSwgNSwgMTAgKiAzMDAwMCk7Cj4gKyAgICAgICBpZiAocmV0KQo+ICsgICAgICAgICAgICAgICBy
ZXR1cm47Cj4gKwo+ICsgICAgICAgc3Bpbl9sb2NrKCZ2b3AtPnJlZ19sb2NrKTsKPiArICAgICAg
IGZvciAoaSA9IDA7IGkgPCBjcnRjLT5nYW1tYV9zaXplOyBpKyspIHsKPiArICAgICAgICAgICAg
ICAgdTMyIHdvcmQ7Cj4gKwo+ICsgICAgICAgICAgICAgICB3b3JkID0gKGRybV9jb2xvcl9sdXRf
ZXh0cmFjdChsdXRbaV0ucmVkLCAxMCkgPDwgMjApIHwKPiArICAgICAgICAgICAgICAgICAgICAg
IChkcm1fY29sb3JfbHV0X2V4dHJhY3QobHV0W2ldLmdyZWVuLCAxMCkgPDwgMTApIHwKPiArICAg
ICAgICAgICAgICAgICAgICAgICBkcm1fY29sb3JfbHV0X2V4dHJhY3QobHV0W2ldLmJsdWUsIDEw
KTsKPiArICAgICAgICAgICAgICAgd3JpdGVsKHdvcmQsIHZvcC0+bHV0X3JlZ3MgKyBpICogNCk7
Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgVk9QX1JFR19TRVQodm9wLCBjb21tb24sIGRzcF9s
dXRfZW4sIDEpOwo+ICsgICAgICAgdm9wX2NmZ19kb25lKHZvcCk7Cj4gKyAgICAgICBzcGluX3Vu
bG9jaygmdm9wLT5yZWdfbG9jayk7Cj4gK30KPiArCj4gIHN0YXRpYyB2b2lkIHZvcF9jcnRjX2F0
b21pY19mbHVzaChzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUpCj4gIHsK
PiBAQCAtMTIwMSw2ICsxMjQ0LDkgQEAgc3RhdGljIHZvaWQgdm9wX2NydGNfYXRvbWljX2ZsdXNo
KHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKPiAgICAgICAgICAgICAgICAgZHJtX2ZsaXBfd29ya19x
dWV1ZSgmdm9wLT5mYl91bnJlZl93b3JrLCBvbGRfcGxhbmVfc3RhdGUtPmZiKTsKPiAgICAgICAg
ICAgICAgICAgc2V0X2JpdChWT1BfUEVORElOR19GQl9VTlJFRiwgJnZvcC0+cGVuZGluZyk7Cj4g
ICAgICAgICB9Cj4gKwo+ICsgICAgICAgaWYgKHZvcC0+bHV0X3JlZ3MgJiYgY3J0Yy0+c3RhdGUt
PmNvbG9yX21nbXRfY2hhbmdlZCkKPiArICAgICAgICAgICAgICAgdm9wX2NydGNfZ2FtbWFfc2V0
KHZvcCwgY3J0YywgY3J0Yy0+c3RhdGUpOwo+ICB9Cj4KPiAgc3RhdGljIGNvbnN0IHN0cnVjdCBk
cm1fY3J0Y19oZWxwZXJfZnVuY3Mgdm9wX2NydGNfaGVscGVyX2Z1bmNzID0gewo+IEBAIC0xMzIz
LDYgKzEzNjksNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9jcnRjX2Z1bmNzIHZvcF9jcnRj
X2Z1bmNzID0gewo+ICAgICAgICAgLmRpc2FibGVfdmJsYW5rID0gdm9wX2NydGNfZGlzYWJsZV92
YmxhbmssCj4gICAgICAgICAuc2V0X2NyY19zb3VyY2UgPSB2b3BfY3J0Y19zZXRfY3JjX3NvdXJj
ZSwKPiAgICAgICAgIC52ZXJpZnlfY3JjX3NvdXJjZSA9IHZvcF9jcnRjX3ZlcmlmeV9jcmNfc291
cmNlLAo+ICsgICAgICAgLmdhbW1hX3NldCA9IGRybV9hdG9taWNfaGVscGVyX2xlZ2FjeV9nYW1t
YV9zZXQsCj4gIH07Cj4KPiAgc3RhdGljIHZvaWQgdm9wX2ZiX3VucmVmX3dvcmtlcihzdHJ1Y3Qg
ZHJtX2ZsaXBfd29yayAqd29yaywgdm9pZCAqdmFsKQo+IEBAIC0xNDgwLDYgKzE1MjcsOCBAQCBz
dGF0aWMgaW50IHZvcF9jcmVhdGVfY3J0YyhzdHJ1Y3Qgdm9wICp2b3ApCj4gICAgICAgICAgICAg
ICAgIGdvdG8gZXJyX2NsZWFudXBfcGxhbmVzOwo+Cj4gICAgICAgICBkcm1fY3J0Y19oZWxwZXJf
YWRkKGNydGMsICZ2b3BfY3J0Y19oZWxwZXJfZnVuY3MpOwo+ICsgICAgICAgZHJtX21vZGVfY3J0
Y19zZXRfZ2FtbWFfc2l6ZShjcnRjLCBWT1BfR0FNTUFfTFVUX1NJWkUpOwo+ICsgICAgICAgZHJt
X2NydGNfZW5hYmxlX2NvbG9yX21nbXQoY3J0YywgMCwgZmFsc2UsIFZPUF9HQU1NQV9MVVRfU0la
RSk7Cj4KPiAgICAgICAgIC8qCj4gICAgICAgICAgKiBDcmVhdGUgZHJtX3BsYW5lcyBmb3Igb3Zl
cmxheSB3aW5kb3dzIHdpdGggcG9zc2libGVfY3J0Y3MgcmVzdHJpY3RlZAo+IEBAIC0xNzQ0LDYg
KzE3OTMsNDEgQEAgaW50IHJvY2tjaGlwX2RybV93YWl0X3ZhY3RfZW5kKHN0cnVjdCBkcm1fY3J0
YyAqY3J0YywgdW5zaWduZWQgaW50IG1zdGltZW91dCkKPiAgfQo+ICBFWFBPUlRfU1lNQk9MKHJv
Y2tjaGlwX2RybV93YWl0X3ZhY3RfZW5kKTsKPgo+ICtzdGF0aWMgaW50IHZvcF9nYW1tYV9sdXRf
cmVxdWVzdChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc3RydWN0IHJlc291cmNlICpyZXMsIHN0cnVjdCB2b3AgKnZvcCkKPiArewo+ICsgICAg
ICAgcmVzb3VyY2Vfc2l6ZV90IG9mZnNldCA9IHZvcC0+ZGF0YS0+Z2FtbWFfbHV0X2FkZHJfb2Zm
Owo+ICsgICAgICAgcmVzb3VyY2Vfc2l6ZV90IHNpemUgPSBWT1BfR0FNTUFfTFVUX1NJWkUgKiA0
Owo+ICsKPiArICAgICAgIC8qCj4gKyAgICAgICAgKiBTb21lIFNvQ3MgKGUuZy4gUkszMjg4KSBo
YXZlIHRoZSBnYW1tYSBMVVQgYWRkcmVzcyBhZnRlcgo+ICsgICAgICAgICogdGhlIE1NVSByZWdp
c3RlcnMsIHdoaWNoIG1lYW5zIHdlIGNhbid0IHJlcXVlc3QgYW5kIGlvcmVtYXAKPiArICAgICAg
ICAqIHRoZSBlbnRpcmUgcmVnaXN0ZXIgc2V0LiBPdGhlciAoZS5nLiBSSzMzOTkpIGhhdmUgZ2Ft
bWEgTFVUCj4gKyAgICAgICAgKiBhZGRyZXNzIGJlZm9yZSBNTVUuCj4gKyAgICAgICAgKgo+ICsg
ICAgICAgICogVGhlcmVmb3JlLCB3ZSBuZWVkIHRvIHJlcXVlc3QgYW5kIGlvcmVtYXAgdGhvc2Ug
dGhhdCBoYXZlbid0Cj4gKyAgICAgICAgKiBiZWVuIGFscmVhZHkuCj4gKyAgICAgICAgKi8KPiAr
ICAgICAgIGlmICh2b3AtPmxlbiA+PSAob2Zmc2V0ICsgc2l6ZSkpIHsKPiArICAgICAgICAgICAg
ICAgdm9wLT5sdXRfcmVncyA9IHZvcC0+cmVncyArIG9mZnNldDsKPiArICAgICAgICAgICAgICAg
cmV0dXJuIDA7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgaWYgKCFkZXZtX3JlcXVlc3RfbWVt
X3JlZ2lvbihkZXYsIHJlcy0+c3RhcnQgKyBvZmZzZXQsCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHNpemUsIGRldl9uYW1lKGRldikpKSB7Cj4gKyAgICAgICAgICAgICAg
IGRldl93YXJuKGRldiwgImNhbid0IHJlcXVlc3QgZ2FtbWEgbHV0IHJlZ2lvblxuIik7Cj4gKyAg
ICAgICAgICAgICAgIHJldHVybiAtRUJVU1k7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgdm9w
LT5sdXRfcmVncyA9IGRldm1faW9yZW1hcChkZXYsIHJlcy0+c3RhcnQgKyBvZmZzZXQsIHNpemUp
Owo+ICsgICAgICAgaWYgKCF2b3AtPmx1dF9yZWdzKSB7Cj4gKyAgICAgICAgICAgICAgIGRldl9l
cnIoZGV2LCAiY2FuJ3QgaW9yZW1hcCBnYW1tYSBsdXQgYWRkcmVzc1xuIik7Cj4gKyAgICAgICAg
ICAgICAgIGRldm1fcmVsZWFzZV9tZW1fcmVnaW9uKGRldiwgcmVzLT5zdGFydCArIG9mZnNldCwg
c2l6ZSk7Cj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwo+ICsgICAgICAgfQo+ICsg
ICAgICAgcmV0dXJuIDA7Cj4gK30KPiArCj4gIHN0YXRpYyBpbnQgdm9wX2JpbmQoc3RydWN0IGRl
dmljZSAqZGV2LCBzdHJ1Y3QgZGV2aWNlICptYXN0ZXIsIHZvaWQgKmRhdGEpCj4gIHsKPiAgICAg
ICAgIHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYgPSB0b19wbGF0Zm9ybV9kZXZpY2UoZGV2
KTsKPiBAQCAtMTc3Niw2ICsxODYwLDkgQEAgc3RhdGljIGludCB2b3BfYmluZChzdHJ1Y3QgZGV2
aWNlICpkZXYsIHN0cnVjdCBkZXZpY2UgKm1hc3Rlciwgdm9pZCAqZGF0YSkKPiAgICAgICAgIGlm
IChJU19FUlIodm9wLT5yZWdzKSkKPiAgICAgICAgICAgICAgICAgcmV0dXJuIFBUUl9FUlIodm9w
LT5yZWdzKTsKPgo+ICsgICAgICAgaWYgKHZvcC0+ZGF0YS0+Z2FtbWFfbHV0X2FkZHJfb2ZmKQo+
ICsgICAgICAgICAgICAgICB2b3BfZ2FtbWFfbHV0X3JlcXVlc3QoZGV2LCByZXMsIHZvcCk7Cj4g
Kwo+ICAgICAgICAgdm9wLT5yZWdzYmFrID0gZGV2bV9remFsbG9jKGRldiwgdm9wLT5sZW4sIEdG
UF9LRVJORUwpOwo+ICAgICAgICAgaWYgKCF2b3AtPnJlZ3NiYWspCj4gICAgICAgICAgICAgICAg
IHJldHVybiAtRU5PTUVNOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcm9ja2NoaXAv
cm9ja2NoaXBfZHJtX3ZvcC5oIGIvZHJpdmVycy9ncHUvZHJtL3JvY2tjaGlwL3JvY2tjaGlwX2Ry
bV92b3AuaAo+IGluZGV4IDIxNDlhODg5YzI5ZC4uMTJkNWJkZTBkMGJjIDEwMDY0NAo+IC0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9yb2NrY2hpcC9yb2NrY2hpcF9kcm1fdm9wLmgKPiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vcm9ja2NoaXAvcm9ja2NoaXBfZHJtX3ZvcC5oCj4gQEAgLTY3LDYgKzY3LDcg
QEAgc3RydWN0IHZvcF9jb21tb24gewo+ICAgICAgICAgc3RydWN0IHZvcF9yZWcgZGl0aGVyX2Rv
d25fbW9kZTsKPiAgICAgICAgIHN0cnVjdCB2b3BfcmVnIGRpdGhlcl9kb3duX2VuOwo+ICAgICAg
ICAgc3RydWN0IHZvcF9yZWcgZGl0aGVyX3VwOwo+ICsgICAgICAgc3RydWN0IHZvcF9yZWcgZHNw
X2x1dF9lbjsKPiAgICAgICAgIHN0cnVjdCB2b3BfcmVnIGdhdGVfZW47Cj4gICAgICAgICBzdHJ1
Y3Qgdm9wX3JlZyBtbXVfZW47Cj4gICAgICAgICBzdHJ1Y3Qgdm9wX3JlZyBvdXRfbW9kZTsKPiBA
QCAtMTcwLDYgKzE3MSw3IEBAIHN0cnVjdCB2b3BfZGF0YSB7Cj4gICAgICAgICBjb25zdCBzdHJ1
Y3Qgdm9wX3dpbl95dXYyeXV2X2RhdGEgKndpbl95dXYyeXV2Owo+ICAgICAgICAgY29uc3Qgc3Ry
dWN0IHZvcF93aW5fZGF0YSAqd2luOwo+ICAgICAgICAgdW5zaWduZWQgaW50IHdpbl9zaXplOwo+
ICsgICAgICAgb2ZmX3QgZ2FtbWFfbHV0X2FkZHJfb2ZmOwo+Cj4gICNkZWZpbmUgVk9QX0ZFQVRV
UkVfT1VUUFVUX1JHQjEwICAgICAgIEJJVCgwKQo+ICAjZGVmaW5lIFZPUF9GRUFUVVJFX0lOVEVS
TkFMX1JHQiAgICAgICBCSVQoMSkKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JvY2tj
aGlwL3JvY2tjaGlwX3ZvcF9yZWcuYyBiL2RyaXZlcnMvZ3B1L2RybS9yb2NrY2hpcC9yb2NrY2hp
cF92b3BfcmVnLmMKPiBpbmRleCA3YjljNzQ3NTBmNmQuLjYzZmJiMzg0ODkzYiAxMDA2NDQKPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vcm9ja2NoaXAvcm9ja2NoaXBfdm9wX3JlZy5jCj4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL3JvY2tjaGlwL3JvY2tjaGlwX3ZvcF9yZWcuYwo+IEBAIC01OTMsNiAr
NTkzLDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2b3BfY29tbW9uIHJrMzI4OF9jb21tb24gPSB7
Cj4gICAgICAgICAuZGl0aGVyX2Rvd25fZW4gPSBWT1BfUkVHKFJLMzI4OF9EU1BfQ1RSTDEsIDB4
MSwgMiksCj4gICAgICAgICAucHJlX2RpdGhlcl9kb3duID0gVk9QX1JFRyhSSzMyODhfRFNQX0NU
UkwxLCAweDEsIDEpLAo+ICAgICAgICAgLmRpdGhlcl91cCA9IFZPUF9SRUcoUkszMjg4X0RTUF9D
VFJMMSwgMHgxLCA2KSwKPiArICAgICAgIC5kc3BfbHV0X2VuID0gVk9QX1JFRyhSSzMyODhfRFNQ
X0NUUkwxLCAweDEsIDApLAo+ICAgICAgICAgLmRhdGFfYmxhbmsgPSBWT1BfUkVHKFJLMzI4OF9E
U1BfQ1RSTDAsIDB4MSwgMTkpLAo+ICAgICAgICAgLmRzcF9ibGFuayA9IFZPUF9SRUcoUkszMjg4
X0RTUF9DVFJMMCwgMHgzLCAxOCksCj4gICAgICAgICAub3V0X21vZGUgPSBWT1BfUkVHKFJLMzI4
OF9EU1BfQ1RSTDAsIDB4ZiwgMCksCj4gQEAgLTY0MSw2ICs2NDIsNyBAQCBzdGF0aWMgY29uc3Qg
c3RydWN0IHZvcF9kYXRhIHJrMzI4OF92b3AgPSB7Cj4gICAgICAgICAub3V0cHV0ID0gJnJrMzI4
OF9vdXRwdXQsCj4gICAgICAgICAud2luID0gcmszMjg4X3ZvcF93aW5fZGF0YSwKPiAgICAgICAg
IC53aW5fc2l6ZSA9IEFSUkFZX1NJWkUocmszMjg4X3ZvcF93aW5fZGF0YSksCj4gKyAgICAgICAu
Z2FtbWFfbHV0X2FkZHJfb2ZmID0gUkszMjg4X0dBTU1BX0xVVF9BRERSLAo+ICB9Owo+Cj4gIHN0
YXRpYyBjb25zdCBpbnQgcmszMzY4X3ZvcF9pbnRyc1tdID0gewo+IEBAIC04MTEsNiArODEzLDcg
QEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2b3BfZGF0YSByazMzOTlfdm9wX2JpZyA9IHsKPiAgICAg
ICAgIC53aW4gPSByazMzNjhfdm9wX3dpbl9kYXRhLAo+ICAgICAgICAgLndpbl9zaXplID0gQVJS
QVlfU0laRShyazMzNjhfdm9wX3dpbl9kYXRhKSwKPiAgICAgICAgIC53aW5feXV2Mnl1diA9IHJr
MzM5OV92b3BfYmlnX3dpbl95dXYyeXV2X2RhdGEsCj4gKyAgICAgICAuZ2FtbWFfbHV0X2FkZHJf
b2ZmID0gUkszMzk5X0dBTU1BX0xVVF9BRERSLAo+ICB9Owo+Cj4gIHN0YXRpYyBjb25zdCBzdHJ1
Y3Qgdm9wX3dpbl9kYXRhIHJrMzM5OV92b3BfbGl0X3dpbl9kYXRhW10gPSB7Cj4gQEAgLTgzNiw2
ICs4MzksNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHZvcF9kYXRhIHJrMzM5OV92b3BfbGl0ID0g
ewo+ICAgICAgICAgLndpbiA9IHJrMzM5OV92b3BfbGl0X3dpbl9kYXRhLAo+ICAgICAgICAgLndp
bl9zaXplID0gQVJSQVlfU0laRShyazMzOTlfdm9wX2xpdF93aW5fZGF0YSksCj4gICAgICAgICAu
d2luX3l1djJ5dXYgPSByazMzOTlfdm9wX2xpdF93aW5feXV2Mnl1dl9kYXRhLAo+ICsgICAgICAg
LmdhbW1hX2x1dF9hZGRyX29mZiA9IFJLMzM5OV9HQU1NQV9MVVRfQUREUiwKPiAgfTsKPgo+ICBz
dGF0aWMgY29uc3Qgc3RydWN0IHZvcF93aW5fZGF0YSByazMyMjhfdm9wX3dpbl9kYXRhW10gPSB7
Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yb2NrY2hpcC9yb2NrY2hpcF92b3BfcmVn
LmggYi9kcml2ZXJzL2dwdS9kcm0vcm9ja2NoaXAvcm9ja2NoaXBfdm9wX3JlZy5oCj4gaW5kZXgg
NmU5ZmE1ODE1ZDRkLi40OTAzMTgzODJmNzQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJt
L3JvY2tjaGlwL3JvY2tjaGlwX3ZvcF9yZWcuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9yb2Nr
Y2hpcC9yb2NrY2hpcF92b3BfcmVnLmgKPiBAQCAtMTEzLDYgKzExMyw3IEBACj4gICNkZWZpbmUg
UkszMjg4X0RTUF9WQUNUX1NUX0VORCAgICAgICAgICAgICAgICAgMHgwMTk0Cj4gICNkZWZpbmUg
UkszMjg4X0RTUF9WU19TVF9FTkRfRjEgICAgICAgICAgICAgICAgICAgICAgICAweDAxOTgKPiAg
I2RlZmluZSBSSzMyODhfRFNQX1ZBQ1RfU1RfRU5EX0YxICAgICAgICAgICAgICAweDAxOWMKPiAr
I2RlZmluZSBSSzMyODhfR0FNTUFfTFVUX0FERFIgICAgICAgICAgICAgICAgICAweDEwMDAKPiAg
LyogcmVnaXN0ZXIgZGVmaW5pdGlvbiBlbmQgKi8KPgo+ICAvKiByazMzNjggcmVnaXN0ZXIgZGVm
aW5pdGlvbiAqLwo+IC0tCj4gMi4yMC4xCj4KPiBfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwo+IGRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKPiBkcmktZGV2ZWxA
bGlzdHMuZnJlZWRlc2t0b3Aub3JnCj4gaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFp
bG1hbi9saXN0aW5mby9kcmktZGV2ZWwKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGlu
Zm8vZHJpLWRldmVs
