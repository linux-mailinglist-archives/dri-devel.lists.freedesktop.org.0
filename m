Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id E23946C485
	for <lists+dri-devel@lfdr.de>; Thu, 18 Jul 2019 03:45:08 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8CC8E6E2E0;
	Thu, 18 Jul 2019 01:45:04 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9CEF66E2CE
 for <dri-devel@lists.freedesktop.org>; Thu, 18 Jul 2019 01:44:54 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx08.intmail.prod.int.phx2.redhat.com
 [10.5.11.23])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 208C63082E42;
 Thu, 18 Jul 2019 01:44:54 +0000 (UTC)
Received: from whitewolf.redhat.com (ovpn-120-112.rdu2.redhat.com
 [10.10.120.112])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 96F3419C67;
 Thu, 18 Jul 2019 01:44:52 +0000 (UTC)
From: Lyude Paul <lyude@redhat.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 20/26] drm/dp_mst: Don't forget to update port->input in
 drm_dp_mst_handle_conn_stat()
Date: Wed, 17 Jul 2019 21:42:43 -0400
Message-Id: <20190718014329.8107-21-lyude@redhat.com>
In-Reply-To: <20190718014329.8107-1-lyude@redhat.com>
References: <20190718014329.8107-1-lyude@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.23
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.46]); Thu, 18 Jul 2019 01:44:54 +0000 (UTC)
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Maxime Ripard <maxime.ripard@bootlin.com>, Sean Paul <sean@poorly.run>,
 linux-kernel@vger.kernel.org, David Airlie <airlied@linux.ie>,
 Juston Li <juston.li@intel.com>, Harry Wentland <hwentlan@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhpcyBwcm9iYWJseSBoYXNuJ3QgY2F1c2VkIGFueSBwcm9ibGVtcyB1cCB1bnRpbCBub3cgc2lu
Y2UgaXQncwpwcm9iYWJseSBuZWFybHkgaW1wb3NzaWJsZSB0byBlbmNvdW50ZXIgdGhpcyBpbiB0
aGUgd2lsZCwgaG93ZXZlciBpZiB3ZQp3ZXJlIHRvIHJlY2VpdmUgYSBjb25uZWN0aW9uIHN0YXR1
cyBub3RpZmljYXRpb24gZnJvbSB0aGUgTVNUIGh1YiBhZnRlcgpyZXN1bWUgd2hpbGUgd2UncmUg
aW4gdGhlIG1pZGRsZSBvZiByZXByb2JpbmcgdGhlIGxpbmsgYWRkcmVzc2VzIGZvciBhCnRvcG9s
b2d5IHRoZW4gdGhlcmUncyBhIG11Y2ggbGFyZ2VyIGNoYW5jZSB0aGF0IGEgcG9ydCBjb3VsZCBo
YXZlCmNoYW5nZWQgZnJvbSBiZWluZyBhbiBvdXRwdXQgcG9ydCB0byBpbnB1dCBwb3J0IChvciB2
aWNlIHZlcnNhKS4gSWYgd2UKZm9yZ2V0IHRvIHVwZGF0ZSB0aGlzIGJpdCBvZiBpbmZvcm1hdGlv
biwgd2UnbGwgcG90ZW50aWFsbHkgaWdub3JlIGEKdmFsaWQgUERUIGNoYW5nZSBvbiBhIGRvd25z
dHJlYW0gcG9ydCBiZWNhdXNlIHdlIHRoaW5rIGl0J3MgYW4gaW5wdXQKcG9ydC4KClNvLCBtYWtl
IHN1cmUgd2UgcmVhZCB0aGUgaW5wdXRfcG9ydCBmaWVsZCBpbiBjb25uZWN0aW9uIHN0YXR1cwpu
b3RpZmljYXRpb25zIGluIGRybV9kcF9tc3RfaGFuZGxlX2Nvbm5fc3RhdCgpIHRvIHByZXZlbnQg
dGhpcyBmcm9tCmhhcHBlbmluZyBvbmNlIHdlJ3ZlIGltcGxlbWVudGVkIHN1c3BlbmQvcmVzdW1l
IHJlcHJvYmluZy4KCkNjOiBKdXN0b24gTGkgPGp1c3Rvbi5saUBpbnRlbC5jb20+CkNjOiBJbXJl
IERlYWsgPGltcmUuZGVha0BpbnRlbC5jb20+CkNjOiBWaWxsZSBTeXJqw6Rsw6QgPHZpbGxlLnN5
cmphbGFAbGludXguaW50ZWwuY29tPgpDYzogSGFycnkgV2VudGxhbmQgPGh3ZW50bGFuQGFtZC5j
b20+ClNpZ25lZC1vZmYtYnk6IEx5dWRlIFBhdWwgPGx5dWRlQHJlZGhhdC5jb20+Ci0tLQogZHJp
dmVycy9ncHUvZHJtL2RybV9kcF9tc3RfdG9wb2xvZ3kuYyB8IDUxICsrKysrKysrKysrKysrKysr
KystLS0tLS0tLQogMSBmaWxlIGNoYW5nZWQsIDM3IGluc2VydGlvbnMoKyksIDE0IGRlbGV0aW9u
cygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9kcm1fZHBfbXN0X3RvcG9sb2d5LmMg
Yi9kcml2ZXJzL2dwdS9kcm0vZHJtX2RwX21zdF90b3BvbG9neS5jCmluZGV4IGRmZmQ4MGYzMTUz
Ny4uMTI2ZGIzNmM5MzM3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2RwX21zdF90
b3BvbG9neS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fZHBfbXN0X3RvcG9sb2d5LmMKQEAg
LTE5ODksMTggKzE5ODksMjMgQEAgc3RhdGljIHZvaWQKIGRybV9kcF9tc3RfaGFuZGxlX2Nvbm5f
c3RhdChzdHJ1Y3QgZHJtX2RwX21zdF9icmFuY2ggKm1zdGIsCiAJCQkgICAgc3RydWN0IGRybV9k
cF9jb25uZWN0aW9uX3N0YXR1c19ub3RpZnkgKmNvbm5fc3RhdCkKIHsKLQlzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2ID0gbXN0Yi0+bWdyLT5kZXY7CisJc3RydWN0IGRybV9kcF9tc3RfdG9wb2xvZ3lf
bWdyICptZ3IgPSBtc3RiLT5tZ3I7CisJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IG1nci0+ZGV2
OwogCXN0cnVjdCBkcm1fZHBfbXN0X3BvcnQgKnBvcnQ7Ci0JaW50IG9sZF9kZHBzOwotCWJvb2wg
ZG93b3JrID0gZmFsc2U7CisJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3Rvcl90b19kZXN0
cm95ID0gTlVMTDsKKwlpbnQgb2xkX2RkcHMsIHJldDsKKwl1OCBuZXdfcGR0OworCWJvb2wgZG93
b3JrID0gZmFsc2UsIGNyZWF0ZV9jb25uZWN0b3IgPSBmYWxzZTsKIAogCXBvcnQgPSBkcm1fZHBf
Z2V0X3BvcnQobXN0YiwgY29ubl9zdGF0LT5wb3J0X251bWJlcik7CiAJaWYgKCFwb3J0KQogCQly
ZXR1cm47CiAKKwltdXRleF9sb2NrKCZwb3J0LT5sb2NrKTsKIAlkcm1fbW9kZXNldF9sb2NrKCZk
ZXYtPm1vZGVfY29uZmlnLmNvbm5lY3Rpb25fbXV0ZXgsIE5VTEwpOwogCiAJb2xkX2RkcHMgPSBw
b3J0LT5kZHBzOworCXBvcnQtPmlucHV0ID0gY29ubl9zdGF0LT5pbnB1dF9wb3J0OwogCXBvcnQt
Pm1jcyA9IGNvbm5fc3RhdC0+bWVzc2FnZV9jYXBhYmlsaXR5X3N0YXR1czsKIAlwb3J0LT5sZHBz
ID0gY29ubl9zdGF0LT5sZWdhY3lfZGV2aWNlX3BsdWdfc3RhdHVzOwogCXBvcnQtPmRkcHMgPSBj
b25uX3N0YXQtPmRpc3BsYXlwb3J0X2RldmljZV9wbHVnX3N0YXR1czsKQEAgLTIwMTMsMjMgKzIw
MTgsNDEgQEAgZHJtX2RwX21zdF9oYW5kbGVfY29ubl9zdGF0KHN0cnVjdCBkcm1fZHBfbXN0X2Jy
YW5jaCAqbXN0YiwKIAkJfQogCX0KIAotCWlmICghcG9ydC0+aW5wdXQpIHsKLQkJaW50IHJldCA9
IGRybV9kcF9wb3J0X3NldF9wZHQocG9ydCwKLQkJCQkJICAgICAgY29ubl9zdGF0LT5wZWVyX2Rl
dmljZV90eXBlKTsKLQkJaWYgKHJldCA9PSAxKSB7Ci0JCQlkb3dvcmsgPSB0cnVlOwotCQl9IGVs
c2UgaWYgKHJldCA8IDApIHsKLQkJCURSTV9FUlJPUigiRmFpbGVkIHRvIGNoYW5nZSBQRFQgZm9y
IHBvcnQgJXA6ICVkXG4iLAotCQkJCSAgcG9ydCwgcmV0KTsKLQkJCWRvd29yayA9IGZhbHNlOwot
CQl9CisJbmV3X3BkdCA9IHBvcnQtPmlucHV0ID8gRFBfUEVFUl9ERVZJQ0VfTk9ORSA6IGNvbm5f
c3RhdC0+cGVlcl9kZXZpY2VfdHlwZTsKKworCXJldCA9IGRybV9kcF9wb3J0X3NldF9wZHQocG9y
dCwgbmV3X3BkdCk7CisJaWYgKHJldCA9PSAxKSB7CisJCWRvd29yayA9IHRydWU7CisJfSBlbHNl
IGlmIChyZXQgPCAwKSB7CisJCURSTV9FUlJPUigiRmFpbGVkIHRvIGNoYW5nZSBQRFQgZm9yIHBv
cnQgJXA6ICVkXG4iLAorCQkJICBwb3J0LCByZXQpOworCQlkb3dvcmsgPSBmYWxzZTsKKwl9CisK
KwkvKgorCSAqIFdlIHVuc2V0IHBvcnQtPmNvbm5lY3RvciBiZWZvcmUgZHJvcHBpbmcgY29ubmVj
dGlvbl9tdXRleCBzbyB0aGF0CisJICogdGhlcmUncyBubyBjaGFuY2UgYW55IG9mIHRoZSBhdG9t
aWMgTVNUIGhlbHBlcnMgY2FuIGFjY2lkZW50YWxseQorCSAqIGFzc29jaWF0ZSBhIHRvLWJlLWRl
c3Ryb3llZCBjb25uZWN0b3Igd2l0aCBhIHBvcnQuCisJICovCisJaWYgKHBvcnQtPmNvbm5lY3Rv
ciAmJiBwb3J0LT5pbnB1dCkgeworCQljb25uZWN0b3JfdG9fZGVzdHJveSA9IHBvcnQtPmNvbm5l
Y3RvcjsKKwkJcG9ydC0+Y29ubmVjdG9yID0gTlVMTDsKKwl9IGVsc2UgaWYgKCFwb3J0LT5jb25u
ZWN0b3IgJiYgIXBvcnQtPmlucHV0KSB7CisJCWNyZWF0ZV9jb25uZWN0b3IgPSB0cnVlOwogCX0K
IAogCWRybV9tb2Rlc2V0X3VubG9jaygmZGV2LT5tb2RlX2NvbmZpZy5jb25uZWN0aW9uX211dGV4
KTsKKworCWlmIChjb25uZWN0b3JfdG9fZGVzdHJveSkKKwkJbWdyLT5jYnMtPmRlc3Ryb3lfY29u
bmVjdG9yKG1nciwgY29ubmVjdG9yX3RvX2Rlc3Ryb3kpOworCWVsc2UgaWYgKGNyZWF0ZV9jb25u
ZWN0b3IpCisJCWRybV9kcF9tc3RfcG9ydF9hZGRfY29ubmVjdG9yKG1zdGIsIHBvcnQpOworCisJ
bXV0ZXhfdW5sb2NrKCZwb3J0LT5sb2NrKTsKKwogCWRybV9kcF9tc3RfdG9wb2xvZ3lfcHV0X3Bv
cnQocG9ydCk7CiAJaWYgKGRvd29yaykKIAkJcXVldWVfd29yayhzeXN0ZW1fbG9uZ193cSwgJm1z
dGItPm1nci0+d29yayk7Ci0KIH0KIAogc3RhdGljIHN0cnVjdCBkcm1fZHBfbXN0X2JyYW5jaCAq
ZHJtX2RwX2dldF9tc3RfYnJhbmNoX2RldmljZShzdHJ1Y3QgZHJtX2RwX21zdF90b3BvbG9neV9t
Z3IgKm1nciwKLS0gCjIuMjEuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRl
c2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8v
ZHJpLWRldmVs
