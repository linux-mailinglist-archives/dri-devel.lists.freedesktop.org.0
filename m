Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 6E777BB064
	for <lists+dri-devel@lfdr.de>; Mon, 23 Sep 2019 11:03:32 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8F2776E2BD;
	Mon, 23 Sep 2019 09:03:27 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-pl1-x64a.google.com (mail-pl1-x64a.google.com
 [IPv6:2607:f8b0:4864:20::64a])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 82FB46E2A9
 for <dri-devel@lists.freedesktop.org>; Mon, 23 Sep 2019 09:03:24 +0000 (UTC)
Received: by mail-pl1-x64a.google.com with SMTP id a6so8204284pls.20
 for <dri-devel@lists.freedesktop.org>; Mon, 23 Sep 2019 02:03:24 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:date:in-reply-to:message-id:mime-version
 :references:subject:from:to:cc;
 bh=XEXF0aWtRP7hmX6yjkpnHC7BrzYVm/zOhA0NZRgvhNA=;
 b=hrU5Ex00cudtmB33q64j85tK74vSBVXeLFkJYVwAOruOqc3M37/M1tZqkaoLNNHOFT
 I53idoGVOxUxuVFCuKn+anfwxEh4Z+P9D+WKj6PQry6gtlVr9XT8xsAWx/H4lm6CMgJ/
 JnxLDNMDIdscGPUuQYH42u6M0160woFon0343RapQ7VBaRVCLwq35BiqnVS7Y2iZUOl5
 cxHIuA4U4DIQDJhz4G5EkOiePltJvxV2N1okq1yc52sOpL2FCUt3MA9NC4ezdkvqvY36
 CCPuHaPyqWTwVu2WioFOIU6hB6RPOrbNRrWaFcHD9CefTdv/1yHpYEIs4BoWSTfpaEyb
 Uvvw==
X-Gm-Message-State: APjAAAVyIgJ3XuCHJYaRiYw25mKpsJYvKW7VtswbpAVtigw2OH4H+Bzq
 yMUbAE6VLhq4v7iDuyF8HNkD3oyEXifjdm/sQGdAkg==
X-Google-Smtp-Source: APXvYqwoNlZIBiD7ccShfy95ZUYTs8Eq6luOqCPYhDEbhfnMf8RhPrIzmn0+8KFw80WkfsacFfShAd3W7y/g/r3pymJBQQ==
X-Received: by 2002:a63:e511:: with SMTP id r17mr13650199pgh.374.1569229401911; 
 Mon, 23 Sep 2019 02:03:21 -0700 (PDT)
Date: Mon, 23 Sep 2019 02:02:40 -0700
In-Reply-To: <20190923090249.127984-1-brendanhiggins@google.com>
Message-Id: <20190923090249.127984-11-brendanhiggins@google.com>
Mime-Version: 1.0
References: <20190923090249.127984-1-brendanhiggins@google.com>
X-Mailer: git-send-email 2.23.0.351.gc4317032e6-goog
Subject: [PATCH v18 10/19] kunit: test: add tests for kunit test abort
From: Brendan Higgins <brendanhiggins@google.com>
To: frowand.list@gmail.com, gregkh@linuxfoundation.org, jpoimboe@redhat.com, 
 keescook@google.com, kieran.bingham@ideasonboard.com, mcgrof@kernel.org, 
 peterz@infradead.org, robh@kernel.org, sboyd@kernel.org, shuah@kernel.org, 
 tytso@mit.edu, yamada.masahiro@socionext.com
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=google.com; s=20161025;
 h=date:in-reply-to:message-id:mime-version:references:subject:from:to
 :cc;
 bh=XEXF0aWtRP7hmX6yjkpnHC7BrzYVm/zOhA0NZRgvhNA=;
 b=avuaBKWx8PoB4Hzgn9+GUkzO7BRfJ+LAAVVvdR2OY1KnHl9JHlmSSKe3dF6j+fPRdL
 ADIG1IT9WFOT5UbSeyPP+qMgbwgh75M0dOyPZYUwCpexFm6I5MsC4CribK2iW8u1nnAT
 580hLjInlArZmc9vH5bgN3yN26kZ7pq63Rxh/OubQfvXSp/ChTzbefGN6MA+Xd9Ky1YZ
 5m+63a1JqoPO1cPkb2Lt9liXl2m+G/pbgNM/cNDRJ1ttyPVrCp54miuQprTvlnaIkAmh
 7heou8tBnjN428wcn22soq89f62IC6hf+w/GPbGoerVZTbkbF9cZhAxwEU9cr8HNSopc
 ihhg==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: pmladek@suse.com, linux-doc@vger.kernel.org, amir73il@gmail.com,
 Brendan Higgins <brendanhiggins@google.com>, dri-devel@lists.freedesktop.org,
 Alexander.Levin@microsoft.com, linux-kselftest@vger.kernel.org,
 linux-nvdimm@lists.01.org, khilman@baylibre.com, knut.omang@oracle.com,
 wfg@linux.intel.com, joel@jms.id.au, rientjes@google.com, jdike@addtoit.com,
 dan.carpenter@oracle.com, devicetree@vger.kernel.org,
 linux-kbuild@vger.kernel.org, Tim.Bird@sony.com, linux-um@lists.infradead.org,
 rostedt@goodmis.org, julia.lawall@lip6.fr, kunit-dev@googlegroups.com,
 richard@nod.at, torvalds@linux-foundation.org, rdunlap@infradead.org,
 linux-kernel@vger.kernel.org, mpe@ellerman.id.au,
 linux-fsdevel@vger.kernel.org, logang@deltatee.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIEtVbml0IHRlc3RzIGZvciB0aGUgS1VuaXQgdGVzdCBhYm9ydCBtZWNoYW5pc20gKHNlZSBw
cmVjZWRpbmcKY29tbWl0KS4gQWRkIHRlc3RzIGJvdGggZm9yIGdlbmVyYWwgdHJ5IGNhdGNoIG1l
Y2hhbmlzbSBhcyB3ZWxsIGFzCm5vbi1hcmNoaXRlY3R1cmUgc3BlY2lmaWMgbWVjaGFuaXNtLgoK
U2lnbmVkLW9mZi1ieTogQnJlbmRhbiBIaWdnaW5zIDxicmVuZGFuaGlnZ2luc0Bnb29nbGUuY29t
PgpSZXZpZXdlZC1ieTogR3JlZyBLcm9haC1IYXJ0bWFuIDxncmVna2hAbGludXhmb3VuZGF0aW9u
Lm9yZz4KUmV2aWV3ZWQtYnk6IExvZ2FuIEd1bnRob3JwZSA8bG9nYW5nQGRlbHRhdGVlLmNvbT4K
UmV2aWV3ZWQtYnk6IFN0ZXBoZW4gQm95ZCA8c2JveWRAa2VybmVsLm9yZz4KLS0tCiBsaWIva3Vu
aXQvTWFrZWZpbGUgICAgfCAgIDMgKy0KIGxpYi9rdW5pdC90ZXN0LXRlc3QuYyB8IDEwNiArKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIDIgZmlsZXMgY2hhbmdlZCwg
MTA4IGluc2VydGlvbnMoKyksIDEgZGVsZXRpb24oLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBsaWIv
a3VuaXQvdGVzdC10ZXN0LmMKCmRpZmYgLS1naXQgYS9saWIva3VuaXQvTWFrZWZpbGUgYi9saWIv
a3VuaXQvTWFrZWZpbGUKaW5kZXggYzkxNzZjOWM1NzhjLi43NjlkOTQwMmI1ZDMgMTAwNjQ0Ci0t
LSBhL2xpYi9rdW5pdC9NYWtlZmlsZQorKysgYi9saWIva3VuaXQvTWFrZWZpbGUKQEAgLTMsNiAr
Myw3IEBAIG9iai0kKENPTkZJR19LVU5JVCkgKz0JCQl0ZXN0Lm8gXAogCQkJCQlhc3NlcnQubyBc
CiAJCQkJCXRyeS1jYXRjaC5vCiAKLW9iai0kKENPTkZJR19LVU5JVF9URVNUKSArPQkJc3RyaW5n
LXN0cmVhbS10ZXN0Lm8KK29iai0kKENPTkZJR19LVU5JVF9URVNUKSArPQkJdGVzdC10ZXN0Lm8g
XAorCQkJCQlzdHJpbmctc3RyZWFtLXRlc3QubwogCiBvYmotJChDT05GSUdfS1VOSVRfRVhBTVBM
RV9URVNUKSArPQlleGFtcGxlLXRlc3QubwpkaWZmIC0tZ2l0IGEvbGliL2t1bml0L3Rlc3QtdGVz
dC5jIGIvbGliL2t1bml0L3Rlc3QtdGVzdC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAw
MDAwMDAwMDAwMC4uMDZkMzRkMzZiMTAzCi0tLSAvZGV2L251bGwKKysrIGIvbGliL2t1bml0L3Rl
c3QtdGVzdC5jCkBAIC0wLDAgKzEsMTA2IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjog
R1BMLTIuMAorLyoKKyAqIEtVbml0IHRlc3QgZm9yIGNvcmUgdGVzdCBpbmZyYXN0cnVjdHVyZS4K
KyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMTksIEdvb2dsZSBMTEMuCisgKiBBdXRob3I6IEJyZW5k
YW4gSGlnZ2lucyA8YnJlbmRhbmhpZ2dpbnNAZ29vZ2xlLmNvbT4KKyAqLworI2luY2x1ZGUgPGt1
bml0L3Rlc3QuaD4KKworc3RydWN0IGt1bml0X3RyeV9jYXRjaF90ZXN0X2NvbnRleHQgeworCXN0
cnVjdCBrdW5pdF90cnlfY2F0Y2ggKnRyeV9jYXRjaDsKKwlib29sIGZ1bmN0aW9uX2NhbGxlZDsK
K307CisKK3N0YXRpYyB2b2lkIGt1bml0X3Rlc3Rfc3VjY2Vzc2Z1bF90cnkodm9pZCAqZGF0YSkK
K3sKKwlzdHJ1Y3Qga3VuaXQgKnRlc3QgPSBkYXRhOworCXN0cnVjdCBrdW5pdF90cnlfY2F0Y2hf
dGVzdF9jb250ZXh0ICpjdHggPSB0ZXN0LT5wcml2OworCisJY3R4LT5mdW5jdGlvbl9jYWxsZWQg
PSB0cnVlOworfQorCitzdGF0aWMgdm9pZCBrdW5pdF90ZXN0X25vX2NhdGNoKHZvaWQgKmRhdGEp
Cit7CisJc3RydWN0IGt1bml0ICp0ZXN0ID0gZGF0YTsKKworCUtVTklUX0ZBSUwodGVzdCwgIkNh
dGNoIHNob3VsZCBub3QgYmUgY2FsbGVkXG4iKTsKK30KKworc3RhdGljIHZvaWQga3VuaXRfdGVz
dF90cnlfY2F0Y2hfc3VjY2Vzc2Z1bF90cnlfbm9fY2F0Y2goc3RydWN0IGt1bml0ICp0ZXN0KQor
eworCXN0cnVjdCBrdW5pdF90cnlfY2F0Y2hfdGVzdF9jb250ZXh0ICpjdHggPSB0ZXN0LT5wcml2
OworCXN0cnVjdCBrdW5pdF90cnlfY2F0Y2ggKnRyeV9jYXRjaCA9IGN0eC0+dHJ5X2NhdGNoOwor
CisJa3VuaXRfdHJ5X2NhdGNoX2luaXQodHJ5X2NhdGNoLAorCQkJICAgICB0ZXN0LAorCQkJICAg
ICBrdW5pdF90ZXN0X3N1Y2Nlc3NmdWxfdHJ5LAorCQkJICAgICBrdW5pdF90ZXN0X25vX2NhdGNo
KTsKKwlrdW5pdF90cnlfY2F0Y2hfcnVuKHRyeV9jYXRjaCwgdGVzdCk7CisKKwlLVU5JVF9FWFBF
Q1RfVFJVRSh0ZXN0LCBjdHgtPmZ1bmN0aW9uX2NhbGxlZCk7Cit9CisKK3N0YXRpYyB2b2lkIGt1
bml0X3Rlc3RfdW5zdWNjZXNzZnVsX3RyeSh2b2lkICpkYXRhKQoreworCXN0cnVjdCBrdW5pdCAq
dGVzdCA9IGRhdGE7CisJc3RydWN0IGt1bml0X3RyeV9jYXRjaF90ZXN0X2NvbnRleHQgKmN0eCA9
IHRlc3QtPnByaXY7CisJc3RydWN0IGt1bml0X3RyeV9jYXRjaCAqdHJ5X2NhdGNoID0gY3R4LT50
cnlfY2F0Y2g7CisKKwlrdW5pdF90cnlfY2F0Y2hfdGhyb3codHJ5X2NhdGNoKTsKKwlLVU5JVF9G
QUlMKHRlc3QsICJUaGlzIGxpbmUgc2hvdWxkIG5ldmVyIGJlIHJlYWNoZWRcbiIpOworfQorCitz
dGF0aWMgdm9pZCBrdW5pdF90ZXN0X2NhdGNoKHZvaWQgKmRhdGEpCit7CisJc3RydWN0IGt1bml0
ICp0ZXN0ID0gZGF0YTsKKwlzdHJ1Y3Qga3VuaXRfdHJ5X2NhdGNoX3Rlc3RfY29udGV4dCAqY3R4
ID0gdGVzdC0+cHJpdjsKKworCWN0eC0+ZnVuY3Rpb25fY2FsbGVkID0gdHJ1ZTsKK30KKworc3Rh
dGljIHZvaWQga3VuaXRfdGVzdF90cnlfY2F0Y2hfdW5zdWNjZXNzZnVsX3RyeV9kb2VzX2NhdGNo
KHN0cnVjdCBrdW5pdCAqdGVzdCkKK3sKKwlzdHJ1Y3Qga3VuaXRfdHJ5X2NhdGNoX3Rlc3RfY29u
dGV4dCAqY3R4ID0gdGVzdC0+cHJpdjsKKwlzdHJ1Y3Qga3VuaXRfdHJ5X2NhdGNoICp0cnlfY2F0
Y2ggPSBjdHgtPnRyeV9jYXRjaDsKKworCWt1bml0X3RyeV9jYXRjaF9pbml0KHRyeV9jYXRjaCwK
KwkJCSAgICAgdGVzdCwKKwkJCSAgICAga3VuaXRfdGVzdF91bnN1Y2Nlc3NmdWxfdHJ5LAorCQkJ
ICAgICBrdW5pdF90ZXN0X2NhdGNoKTsKKwlrdW5pdF90cnlfY2F0Y2hfcnVuKHRyeV9jYXRjaCwg
dGVzdCk7CisKKwlLVU5JVF9FWFBFQ1RfVFJVRSh0ZXN0LCBjdHgtPmZ1bmN0aW9uX2NhbGxlZCk7
Cit9CisKK3N0YXRpYyBpbnQga3VuaXRfdHJ5X2NhdGNoX3Rlc3RfaW5pdChzdHJ1Y3Qga3VuaXQg
KnRlc3QpCit7CisJc3RydWN0IGt1bml0X3RyeV9jYXRjaF90ZXN0X2NvbnRleHQgKmN0eDsKKwor
CWN0eCA9IGt1bml0X2t6YWxsb2ModGVzdCwgc2l6ZW9mKCpjdHgpLCBHRlBfS0VSTkVMKTsKKwlp
ZiAoIWN0eCkKKwkJcmV0dXJuIC1FTk9NRU07CisKKwl0ZXN0LT5wcml2ID0gY3R4OworCisJY3R4
LT50cnlfY2F0Y2ggPSBrdW5pdF9rbWFsbG9jKHRlc3QsCisJCQkJICAgICAgIHNpemVvZigqY3R4
LT50cnlfY2F0Y2gpLAorCQkJCSAgICAgICBHRlBfS0VSTkVMKTsKKwlpZiAoIWN0eC0+dHJ5X2Nh
dGNoKQorCQlyZXR1cm4gLUVOT01FTTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgc3RydWN0
IGt1bml0X2Nhc2Uga3VuaXRfdHJ5X2NhdGNoX3Rlc3RfY2FzZXNbXSA9IHsKKwlLVU5JVF9DQVNF
KGt1bml0X3Rlc3RfdHJ5X2NhdGNoX3N1Y2Nlc3NmdWxfdHJ5X25vX2NhdGNoKSwKKwlLVU5JVF9D
QVNFKGt1bml0X3Rlc3RfdHJ5X2NhdGNoX3Vuc3VjY2Vzc2Z1bF90cnlfZG9lc19jYXRjaCksCisJ
e30KK307CisKK3N0YXRpYyBzdHJ1Y3Qga3VuaXRfc3VpdGUga3VuaXRfdHJ5X2NhdGNoX3Rlc3Rf
c3VpdGUgPSB7CisJLm5hbWUgPSAia3VuaXQtdHJ5LWNhdGNoLXRlc3QiLAorCS5pbml0ID0ga3Vu
aXRfdHJ5X2NhdGNoX3Rlc3RfaW5pdCwKKwkudGVzdF9jYXNlcyA9IGt1bml0X3RyeV9jYXRjaF90
ZXN0X2Nhc2VzLAorfTsKK2t1bml0X3Rlc3Rfc3VpdGUoa3VuaXRfdHJ5X2NhdGNoX3Rlc3Rfc3Vp
dGUpOwotLSAKMi4yMy4wLjM1MS5nYzQzMTcwMzJlNi1nb29nCgpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1k
ZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcv
bWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
