Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 3C1E010EB39
	for <lists+dri-devel@lfdr.de>; Mon,  2 Dec 2019 15:02:56 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EFA3189E86;
	Mon,  2 Dec 2019 14:02:53 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
X-Greylist: delayed 865 seconds by postgrey-1.36 at gabe;
 Mon, 02 Dec 2019 14:02:53 UTC
Received: from a27-11.smtp-out.us-west-2.amazonses.com
 (a27-11.smtp-out.us-west-2.amazonses.com [54.240.27.11])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2BB8389E86;
 Mon,  2 Dec 2019 14:02:53 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on
 aws-us-west-2-caf-mail-1.web.codeaurora.org
X-Spam-Level: 
X-Spam-Status: No, score=-1.0 required=2.0 tests=ALL_TRUSTED,SPF_NONE,
 URIBL_BLOCKED autolearn=unavailable autolearn_force=no version=3.4.0
DMARC-Filter: OpenDMARC Filter v1.3.2 smtp.codeaurora.org F2568C774B4
From: Chandan Uddaraju <chandanu@codeaurora.org>
To: freedreno@lists.freedesktop.org, linux-arm-msm@vger.kernel.org,
 devicetree@vger.kernel.org, seanpaul@chromium.org
Subject: [DPU PATCH v3 4/5] drm/msm/dp: add support for DP PLL driver
Date: Mon, 2 Dec 2019 13:48:27 +0000
Message-ID: <0101016ec6de9b5b-cd61a0a2-9ae4-4ca1-a3a4-0ad2e8783e20-000000@us-west-2.amazonses.com>
X-Mailer: git-send-email 1.9.1
In-Reply-To: <1575294437-6129-1-git-send-email-chandanu@codeaurora.org>
References: <1575294437-6129-1-git-send-email-chandanu@codeaurora.org>
X-SES-Outgoing: 2019.12.02-54.240.27.11
Feedback-ID: 1.us-west-2.CZuq2qbDmUIuT3qdvXlRHZZCpfZqZ4GtG9v3VKgRyF0=:AmazonSES
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/simple; 
 s=zsmsymrwgfyinv5wlfyidntwsjeeldzt; d=codeaurora.org; t=1575294508;
 h=From:To:Cc:Subject:Date:Message-Id:In-Reply-To:References;
 bh=sa3Or5xwTZHioktKY6J9zRVdDuR8198XnsZmL/vJKaI=;
 b=MJLUwL96bSPtnZSBex7RHmZdxlIT0uOGYp5wd/xfNElDOEO9DxPjZv/CHxzREGOh
 5I8WckOO0l3aenDaCEe35rlYVuzEv60XNMGQKlnbmanrrQioDaD4abtsIL7e5iy5ump
 3/LeyTKVZf55UthO3WWPts602SlGEk77RgSu0/I8=
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/simple; 
 s=gdwg2y3kokkkj5a55z2ilkup5wp5hhxx; d=amazonses.com; t=1575294508;
 h=From:To:Cc:Subject:Date:Message-Id:In-Reply-To:References:Feedback-ID;
 bh=sa3Or5xwTZHioktKY6J9zRVdDuR8198XnsZmL/vJKaI=;
 b=Ir6AH/VtfbXrVXJplGz3EIZxI1455I9ObazAkC8brFJKSdkCPg4nHXrHA3B+Ys2j
 iOCc4zIISH+8QC/yt/B8G3XXLJhjlIayDa2rZdQXvqw/aae6elWxkp34f56GXaXq338
 OBpA4P14o6Y/FRsYlVwb113F/ZmHZBpA/mShonoU=
X-Mailman-Original-Authentication-Results: aws-us-west-2-caf-mail-1.web.codeaurora.org;
 dmarc=none (p=none dis=none) header.from=codeaurora.org
X-Mailman-Original-Authentication-Results: aws-us-west-2-caf-mail-1.web.codeaurora.org;
 spf=none smtp.mailfrom=chandanu@codeaurora.org
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: abhinavk@codeaurora.org, hoegsberg@google.com,
 dri-devel@lists.freedesktop.org, Chandan Uddaraju <chandanu@codeaurora.org>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIHRoZSBuZWVkZWQgRFAgUExMIHNwZWNpZmljIGZpbGVzIHRvIHN1cHBvcnQKZGlzcGxheSBw
b3J0IGludGVyZmFjZSBvbiBtc20gdGFyZ2V0cy4KClRoZSBEUCBkcml2ZXIgY2FsbHMgdGhlIERQ
IFBMTCBkcml2ZXIgcmVnaXN0cmF0aW9uLgpUaGUgRFAgZHJpdmVyIHNldHMgdGhlIGxpbmsgYW5k
IHBpeGVsIGNsb2NrIHNvdXJjZXMuCgpDaGFuZ2VzIGluIHYyOgotLSBVcGRhdGUgY29weXJpZ2h0
IG1hcmtpbmdzIG9uIGFsbCByZWxldmFudCBmaWxlcy4KLS0gVXNlIERSTV9ERUJVR19EUCBmb3Ig
ZGVidWcgbXNncy4KClNpZ25lZC1vZmYtYnk6IENoYW5kYW4gVWRkYXJhanUgPGNoYW5kYW51QGNv
ZGVhdXJvcmEub3JnPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9tc20vS2NvbmZpZyAgICAgICAgICAg
ICAgICAgICB8ICAxMyArCiBkcml2ZXJzL2dwdS9kcm0vbXNtL01ha2VmaWxlICAgICAgICAgICAg
ICAgICAgfCAgIDQgKwogZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9kaXNwbGF5LmMgICAgICAg
ICAgIHwgIDQ4ICsrKwogZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9kaXNwbGF5LmggICAgICAg
ICAgIHwgICAzICsKIGRyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfcGFyc2VyLmggICAgICAgICAg
ICB8ICAgNCArCiBkcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX3Bvd2VyLmggICAgICAgICAgICAg
fCAgIDEgLQogZHJpdmVycy9ncHUvZHJtL21zbS9kcC9wbGwvZHBfcGxsLmMgICAgICAgICAgIHwg
MTM1ICsrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9tc20vZHAvcGxsL2RwX3BsbC5oICAgICAgICAg
ICB8ICA1NyArKysKIGRyaXZlcnMvZ3B1L2RybS9tc20vZHAvcGxsL2RwX3BsbF8xMG5tLmMgICAg
ICB8IDQwMSArKysrKysrKysrKysrKysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9tc20vZHAvcGxs
L2RwX3BsbF8xMG5tLmggICAgICB8ICA4NiArKysrKwogZHJpdmVycy9ncHUvZHJtL21zbS9kcC9w
bGwvZHBfcGxsXzEwbm1fdXRpbC5jIHwgNDk0ICsrKysrKysrKysrKysrKysrKysrKysrKysrCiAx
MSBmaWxlcyBjaGFuZ2VkLCAxMjQ1IGluc2VydGlvbnMoKyksIDEgZGVsZXRpb24oLSkKIGNyZWF0
ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbXNtL2RwL3BsbC9kcF9wbGwuYwogY3JlYXRl
IG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9tc20vZHAvcGxsL2RwX3BsbC5oCiBjcmVhdGUg
bW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL21zbS9kcC9wbGwvZHBfcGxsXzEwbm0uYwogY3Jl
YXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9tc20vZHAvcGxsL2RwX3BsbF8xMG5tLmgK
IGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbXNtL2RwL3BsbC9kcF9wbGxfMTBu
bV91dGlsLmMKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbXNtL0tjb25maWcgYi9kcml2
ZXJzL2dwdS9kcm0vbXNtL0tjb25maWcKaW5kZXggNzk0NmNiMS4uZTczYWQyMyAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL21zbS9LY29uZmlnCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9tc20v
S2NvbmZpZwpAQCAtNjYsNiArNjYsMTkgQEAgY29uZmlnIERSTV9NU01fRFAKIAkgIGRpc3BsYXkg
c3VwcG9ydCBpcyBlbmFibGVkIHRocm91Z2ggdGhpcyBjb25maWcgb3B0aW9uLiBJdCBjYW4KIAkg
IGJlIHByaW1hcnkgb3Igc2Vjb25kYXJ5IGRpc3BsYXkgb24gZGV2aWNlLgogCitjb25maWcgRFJN
X01TTV9EUF9QTEwKKwlib29sICJFbmFibGUgRFAgUExMIGRyaXZlciBpbiBNU00gRFJNIgorCWRl
cGVuZHMgb24gRFJNX01TTV9EUCAmJiBDT01NT05fQ0xLCisJaGVscAorCSAgQ2hvb3NlIHRoaXMg
b3B0aW9uIHRvIGVuYWJsZSBEUCBQTEwgZHJpdmVyIHdoaWNoIHByb3ZpZGVzIERQCisJICBzb3Vy
Y2UgY2xvY2tzIHVuZGVyIGNvbW1vbiBjbG9jayBmcmFtZXdvcmsuCisKK2NvbmZpZyBEUk1fTVNN
X0RQXzEwTk1fUExMCisJYm9vbCAiRW5hYmxlIERQIDEwbm0gUExMIGRyaXZlciBpbiBNU00gRFJN
ICh1c2VkIGJ5IFNETTg0NSkiCisJZGVwZW5kcyBvbiBEUk1fTVNNX0RQX1BMTAorCWhlbHAKKwkg
IENob29zZSB0aGlzIG9wdGlvbiBpZiBEUCBQTEwgb24gU0RNODQ1IGlzIHVzZWQgb24gdGhlIHBs
YXRmb3JtLgorCiBjb25maWcgRFJNX01TTV9EU0kKIAlib29sICJFbmFibGUgRFNJIHN1cHBvcnQg
aW4gTVNNIERSTSBkcml2ZXIiCiAJZGVwZW5kcyBvbiBEUk1fTVNNCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vbXNtL01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL21zbS9NYWtlZmlsZQpp
bmRleCA1OTM5ZjQxLi4zYmEwYzhiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbXNtL01h
a2VmaWxlCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vTWFrZWZpbGUKQEAgLTE0MCw0ICsxNDAs
OCBAQCBtc20tJChDT05GSUdfRFJNX01TTV9EU0lfMTROTV9QSFkpICs9IGRzaS9wbGwvZHNpX3Bs
bF8xNG5tLm8KIG1zbS0kKENPTkZJR19EUk1fTVNNX0RTSV8xME5NX1BIWSkgKz0gZHNpL3BsbC9k
c2lfcGxsXzEwbm0ubwogZW5kaWYKIAorbXNtLSQoQ09ORklHX0RSTV9NU01fRFBfUExMKSs9IGRw
L3BsbC9kcF9wbGwubworbXNtLSQoQ09ORklHX0RSTV9NU01fRFBfMTBOTV9QTEwpKz0gZHAvcGxs
L2RwX3BsbF8xMG5tLm8gXAorCWRwL3BsbC9kcF9wbGxfMTBubV91dGlsLm8KKwogb2JqLSQoQ09O
RklHX0RSTV9NU00pCSs9IG1zbS5vCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbXNtL2Rw
L2RwX2Rpc3BsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfZGlzcGxheS5jCmluZGV4
IGE4OTM1NDIuLmI1N2E4YzEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBf
ZGlzcGxheS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfZGlzcGxheS5jCkBAIC02
MSw2ICs2MSw0OCBAQCBzdHJ1Y3QgZHBfZGlzcGxheV9wcml2YXRlIHsKIAl7fQogfTsKIAorc3Rh
dGljIGludCBkcF9nZXRfcGxsKHN0cnVjdCBkcF9kaXNwbGF5X3ByaXZhdGUgKmRwX3ByaXYpCit7
CisJc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldiA9IE5VTEw7CisJc3RydWN0IHBsYXRmb3Jt
X2RldmljZSAqcGxsX3BkZXY7CisJc3RydWN0IGRldmljZV9ub2RlICpwbGxfbm9kZTsKKwlzdHJ1
Y3QgZHBfcGFyc2VyICpkcF9wYXJzZXIgPSBOVUxMOworCisJaWYgKCFkcF9wcml2KSB7CisJCURS
TV9FUlJPUigiSW52YWxpZCBBcmd1bWVudHNcbiIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisK
KwlwZGV2ID0gZHBfcHJpdi0+cGRldjsKKwlkcF9wYXJzZXIgPSBkcF9wcml2LT5wYXJzZXI7CisK
KwlpZiAoIWRwX3BhcnNlcikgeworCQlEUk1fREVWX0VSUk9SKCZwZGV2LT5kZXYsICIlczogUGFy
c2VyIG5vdCBpbml0aWFsaXplZFxuIiwgX19mdW5jX18pOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9
CisKKwlwbGxfbm9kZSA9IG9mX3BhcnNlX3BoYW5kbGUocGRldi0+ZGV2Lm9mX25vZGUsICJwbGwt
bm9kZSIsIDApOworCWlmICghcGxsX25vZGUpIHsKKwkJRFJNX0RFVl9FUlJPUigmcGRldi0+ZGV2
LCAiJXM6IGNhbm5vdCBmaW5kIHBsbCBkZXZpY2VcbiIsIF9fZnVuY19fKTsKKwkJcmV0dXJuIC1F
TlhJTzsKKwl9CisKKwlwbGxfcGRldiA9IG9mX2ZpbmRfZGV2aWNlX2J5X25vZGUocGxsX25vZGUp
OworCWlmIChwbGxfcGRldikKKwkJZHBfcGFyc2VyLT5wbGwgPSBwbGF0Zm9ybV9nZXRfZHJ2ZGF0
YShwbGxfcGRldik7CisKKwlvZl9ub2RlX3B1dChwbGxfbm9kZSk7CisKKwlpZiAoIXBsbF9wZGV2
IHx8ICFkcF9wYXJzZXItPnBsbCkgeworCQlEUk1fREVWX0VSUk9SKCZwZGV2LT5kZXYsICIlczog
cGxsIGRyaXZlciBpcyBub3QgcmVhZHlcbiIsIF9fZnVuY19fKTsKKwkJcmV0dXJuIC1FUFJPQkVf
REVGRVI7CisJfQorCisJZHBfcGFyc2VyLT5wbGxfZGV2ID0gZ2V0X2RldmljZSgmcGxsX3BkZXYt
PmRldik7CisKKwlyZXR1cm4gMDsKK30KKwogc3RhdGljIGlycXJldHVybl90IGRwX2Rpc3BsYXlf
aXJxKGludCBpcnEsIHZvaWQgKmRldl9pZCkKIHsKIAlzdHJ1Y3QgZHBfZGlzcGxheV9wcml2YXRl
ICpkcCA9IGRldl9pZDsKQEAgLTExNCw2ICsxNTYsMTAgQEAgc3RhdGljIGludCBkcF9kaXNwbGF5
X2JpbmQoc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1Y3QgZGV2aWNlICptYXN0ZXIsCiAJCWdvdG8g
ZW5kOwogCX0KIAorCXJjID0gZHBfZ2V0X3BsbChkcCk7CisJaWYgKHJjKQorCQlnb3RvIGVuZDsK
KwogCXJjID0gZHBfYXV4X3JlZ2lzdGVyKGRwLT5hdXgpOwogCWlmIChyYykgewogCQlEUk1fRVJS
T1IoIkRSTSBEUCBBVVggcmVnaXN0ZXIgZmFpbGVkXG4iKTsKQEAgLTgxMiw2ICs4NTgsNyBAQCBp
bnQgX19pbml0IG1zbV9kcF9yZWdpc3Rlcih2b2lkKQogewogCWludCByZXQ7CiAKKwltc21fZHBf
cGxsX2RyaXZlcl9yZWdpc3RlcigpOwogCXJldCA9IHBsYXRmb3JtX2RyaXZlcl9yZWdpc3Rlcigm
ZHBfZGlzcGxheV9kcml2ZXIpOwogCWlmIChyZXQpIHsKIAkJRFJNX0VSUk9SKCJkcml2ZXIgcmVn
aXN0ZXIgZmFpbGVkIik7CkBAIC04MjMsNiArODcwLDcgQEAgaW50IF9faW5pdCBtc21fZHBfcmVn
aXN0ZXIodm9pZCkKIAogdm9pZCBfX2V4aXQgbXNtX2RwX3VucmVnaXN0ZXIodm9pZCkKIHsKKwlt
c21fZHBfcGxsX2RyaXZlcl91bnJlZ2lzdGVyKCk7CiAJcGxhdGZvcm1fZHJpdmVyX3VucmVnaXN0
ZXIoJmRwX2Rpc3BsYXlfZHJpdmVyKTsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L21zbS9kcC9kcF9kaXNwbGF5LmggYi9kcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX2Rpc3BsYXku
aAppbmRleCBjOTE2NDA4Li5mNTc1ZDJjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbXNt
L2RwL2RwX2Rpc3BsYXkuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX2Rpc3BsYXku
aApAQCAtMjYsNCArMjYsNyBAQCBpbnQgZHBfZGlzcGxheV9nZXRfbW9kZXMoc3RydWN0IG1zbV9k
cCAqZHBfZGlzcGxheSwKIGJvb2wgZHBfZGlzcGxheV9jaGVja192aWRlb190ZXN0KHN0cnVjdCBt
c21fZHAgKmRwX2Rpc3BsYXkpOwogaW50IGRwX2Rpc3BsYXlfZ2V0X3Rlc3RfYnBwKHN0cnVjdCBt
c21fZHAgKmRwX2Rpc3BsYXkpOwogCit2b2lkIF9faW5pdCBtc21fZHBfcGxsX2RyaXZlcl9yZWdp
c3Rlcih2b2lkKTsKK3ZvaWQgX19leGl0IG1zbV9kcF9wbGxfZHJpdmVyX3VucmVnaXN0ZXIodm9p
ZCk7CisKICNlbmRpZiAvKiBfRFBfRElTUExBWV9IXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL21zbS9kcC9kcF9wYXJzZXIuaCBiL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfcGFy
c2VyLmgKaW5kZXggYjYwNmI0MC4uMGU5ZTM4MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L21zbS9kcC9kcF9wYXJzZXIuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX3BhcnNl
ci5oCkBAIC02LDYgKzYsOCBAQAogI2lmbmRlZiBfRFBfUEFSU0VSX0hfCiAjZGVmaW5lIF9EUF9Q
QVJTRVJfSF8KIAorI2luY2x1ZGUgInBsbC9kcF9wbGwuaCIKKwogI2RlZmluZSBEUF9MQUJFTCAi
TURTUyBEUCBESVNQTEFZIgogI2RlZmluZSBBVVhfQ0ZHX0xFTgkxMAogI2RlZmluZSBEUF9NQVhf
UElYRUxfQ0xLX0tIWgk2NzUwMDAKQEAgLTE5Miw2ICsxOTQsOCBAQCBzdHJ1Y3QgZHBfcGFyc2Vy
IHsKIAlib29sIGNvbWJvX3BoeV9lbjsKIAlzdHJ1Y3QgZHBfaW8gaW87CiAJc3RydWN0IGRwX2Rp
c3BsYXlfZGF0YSBkaXNwX2RhdGE7CisJc3RydWN0IG1zbV9kcF9wbGwgKnBsbDsKKwlzdHJ1Y3Qg
ZGV2aWNlICpwbGxfZGV2OwogCWNvbnN0IHN0cnVjdCBkcF9yZWd1bGF0b3JfY2ZnICpyZWd1bGF0
b3JfY2ZnOwogCXU4IGxfbWFwWzRdOwogCXN0cnVjdCBkcF9hdXhfY2ZnIGF1eF9jZmdbQVVYX0NG
R19MRU5dOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9wb3dlci5oIGIv
ZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9wb3dlci5oCmluZGV4IDQwZDdlNzMuLjc2ZTJkM2Ig
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfcG93ZXIuaAorKysgYi9kcml2
ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX3Bvd2VyLmgKQEAgLTE0LDcgKzE0LDYgQEAKICAqIEBpbml0
OiBpbml0aWFsaXplcyB0aGUgcmVndWxhdG9ycy9jb3JlIGNsb2Nrcy9HUElPcy9waW5jdHJsCiAg
KiBAZGVpbml0OiB0dXJucyBvZmYgdGhlIHJlZ3VsYXRvcnMvY29yZSBjbG9ja3MvR1BJT3MvcGlu
Y3RybAogICogQGNsa19lbmFibGU6IGVuYWJsZS9kaXNhYmxlIHRoZSBEUCBjbG9ja3MKLSAqIEBz
ZXRfbGlua19jbGtfcGFyZW50OiBzZXQgdGhlIHBhcmVudCBvZiBEUCBsaW5rIGNsb2NrCiAgKiBA
c2V0X3BpeGVsX2Nsa19wYXJlbnQ6IHNldCB0aGUgcGFyZW50IG9mIERQIHBpeGVsIGNsb2NrCiAg
Ki8KIHN0cnVjdCBkcF9wb3dlciB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbXNtL2Rw
L3BsbC9kcF9wbGwuYyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvcGxsL2RwX3BsbC5jCm5ldyBm
aWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjMzZmFlYTgKLS0tIC9kZXYvbnVsbAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vbXNtL2RwL3BsbC9kcF9wbGwuYwpAQCAtMCwwICsxLDEzNSBAQAor
Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seQorLyoKKyAqIENvcHlyaWdo
dCAoYykgMjAxNi0yMDE5LCBUaGUgTGludXggRm91bmRhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZl
ZC4KKyAqLworCisjaW5jbHVkZSAiZHBfcGxsLmgiCisKK2ludCBtc21fZHBfcGxsX3V0aWxfcGFy
c2VfZHRfY2xvY2soc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldiwKKwkJCQkJc3RydWN0IG1z
bV9kcF9wbGwgKnBsbCkKK3sKKwl1MzIgaSA9IDAsIHJjID0gMDsKKwlzdHJ1Y3QgZHNzX21vZHVs
ZV9wb3dlciAqbXAgPSAmcGxsLT5tcDsKKwljb25zdCBjaGFyICpjbG9ja19uYW1lOworCXUzMiBj
bG9ja19yYXRlOworCisJbXAtPm51bV9jbGsgPSBvZl9wcm9wZXJ0eV9jb3VudF9zdHJpbmdzKHBk
ZXYtPmRldi5vZl9ub2RlLAorCQkJCQkJCSJjbG9jay1uYW1lcyIpOworCWlmIChtcC0+bnVtX2Ns
ayA8PSAwKSB7CisJCURSTV9ERVZfRVJST1IoJnBkZXYtPmRldiwgIiVzOmNsb2NrcyBhcmUgbm90
IGRlZmluZWRcbiIsIF9fZnVuY19fKTsKKwkJZ290byBjbGtfZXJyOworCX0KKworCW1wLT5jbGtf
Y29uZmlnID0gZGV2bV9remFsbG9jKCZwZGV2LT5kZXYsCisJCQlzaXplb2Yoc3RydWN0IGRzc19j
bGspICogbXAtPm51bV9jbGssIEdGUF9LRVJORUwpOworCWlmICghbXAtPmNsa19jb25maWcpIHsK
KwkJcmMgPSAtRU5PTUVNOworCQltcC0+bnVtX2NsayA9IDA7CisJCWdvdG8gY2xrX2VycjsKKwl9
CisKKwlmb3IgKGkgPSAwOyBpIDwgbXAtPm51bV9jbGs7IGkrKykgeworCQlvZl9wcm9wZXJ0eV9y
ZWFkX3N0cmluZ19pbmRleChwZGV2LT5kZXYub2Zfbm9kZSwgImNsb2NrLW5hbWVzIiwKKwkJCQkJ
CQlpLCAmY2xvY2tfbmFtZSk7CisJCXN0cmxjcHkobXAtPmNsa19jb25maWdbaV0uY2xrX25hbWUs
IGNsb2NrX25hbWUsCisJCQkJc2l6ZW9mKG1wLT5jbGtfY29uZmlnW2ldLmNsa19uYW1lKSk7CisK
KwkJb2ZfcHJvcGVydHlfcmVhZF91MzJfaW5kZXgocGRldi0+ZGV2Lm9mX25vZGUsICJjbG9jay1y
YXRlIiwKKwkJCQkJCQlpLCAmY2xvY2tfcmF0ZSk7CisJCW1wLT5jbGtfY29uZmlnW2ldLnJhdGUg
PSBjbG9ja19yYXRlOworCisJCWlmICghY2xvY2tfcmF0ZSkKKwkJCW1wLT5jbGtfY29uZmlnW2ld
LnR5cGUgPSBEU1NfQ0xLX0FIQjsKKwkJZWxzZQorCQkJbXAtPmNsa19jb25maWdbaV0udHlwZSA9
IERTU19DTEtfUENMSzsKKwl9CisKK2Nsa19lcnI6CisJcmV0dXJuIHJjOworfQorCitzdHJ1Y3Qg
bXNtX2RwX3BsbCAqbXNtX2RwX3BsbF9pbml0KHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYs
CisJCQllbnVtIG1zbV9kcF9wbGxfdHlwZSB0eXBlLCBpbnQgaWQpCit7CisJc3RydWN0IGRldmlj
ZSAqZGV2ID0gJnBkZXYtPmRldjsKKwlzdHJ1Y3QgbXNtX2RwX3BsbCAqcGxsOworCisJc3dpdGNo
ICh0eXBlKSB7CisJY2FzZSBNU01fRFBfUExMXzEwTk06CisJCXBsbCA9IG1zbV9kcF9wbGxfMTBu
bV9pbml0KHBkZXYsIGlkKTsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJcGxsID0gRVJSX1BUUigt
RU5YSU8pOworCQlicmVhazsKKwl9CisKKwlpZiAoSVNfRVJSKHBsbCkpIHsKKwkJRFJNX0RFVl9F
UlJPUihkZXYsICIlczogZmFpbGVkIHRvIGluaXQgRFAgUExMXG4iLCBfX2Z1bmNfXyk7CisJCXJl
dHVybiBwbGw7CisJfQorCisJcGxsLT50eXBlID0gdHlwZTsKKworCURSTV9ERUJVR19EUCgiRFA6
JWQgUExMIHJlZ2lzdGVyZWQiLCBpZCk7CisKKwlyZXR1cm4gcGxsOworfQorCitzdGF0aWMgY29u
c3Qgc3RydWN0IG9mX2RldmljZV9pZCBkcF9wbGxfZHRfbWF0Y2hbXSA9IHsKKwl7IC5jb21wYXRp
YmxlID0gInFjb20sZHAtcGxsLTEwbm0iIH0sCit9OworCitzdGF0aWMgaW50IGRwX3BsbF9kcml2
ZXJfcHJvYmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKK3sKKwlzdHJ1Y3QgbXNtX2Rw
X3BsbCAqcGxsOworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZwZGV2LT5kZXY7CisJY29uc3Qgc3Ry
dWN0IG9mX2RldmljZV9pZCAqbWF0Y2g7CisKKwltYXRjaCA9IG9mX21hdGNoX25vZGUoZHBfcGxs
X2R0X21hdGNoLCBkZXYtPm9mX25vZGUpOworCWlmICghbWF0Y2gpCisJCXJldHVybiAtRU5PREVW
OworCisJLyogQ3VycmVudGx5IHN1cHBvcnRpbmcgb25seSAxMG5tLURQIFBMTCAqLworCXBsbCA9
IG1zbV9kcF9wbGxfaW5pdChwZGV2LCBNU01fRFBfUExMXzEwTk0sIDApOworCWlmIChJU19FUlJf
T1JfTlVMTChwbGwpKSB7CisJCURSTV9ERVZfRVJST1IoZGV2LAorCQkJIiVzOiBwbGwgaW5pdCBm
YWlsZWQ6ICVsZCwgbmVlZCBzZXBhcmF0ZSBwbGwgY2xrIGRyaXZlclxuIiwKKwkJCV9fZnVuY19f
LCBQVFJfRVJSKHBsbCkpOworCQlyZXR1cm4gLUVOT0RFVjsKKwl9CisKKwlwbGF0Zm9ybV9zZXRf
ZHJ2ZGF0YShwZGV2LCBwbGwpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgZHBfcGxs
X2RyaXZlcl9yZW1vdmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKK3sKKwlzdHJ1Y3Qg
bXNtX2RwX3BsbCAqcGxsID0gcGxhdGZvcm1fZ2V0X2RydmRhdGEocGRldik7CisKKwlpZiAocGxs
KQorCQlwbGwgPSBOVUxMOworCisJcGxhdGZvcm1fc2V0X2RydmRhdGEocGRldiwgTlVMTCk7CisK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIHN0cnVjdCBwbGF0Zm9ybV9kcml2ZXIgZHBfcGxsX3Bs
YXRmb3JtX2RyaXZlciA9IHsKKwkucHJvYmUgICAgICA9IGRwX3BsbF9kcml2ZXJfcHJvYmUsCisJ
LnJlbW92ZSAgICAgPSBkcF9wbGxfZHJpdmVyX3JlbW92ZSwKKwkuZHJpdmVyICAgICA9IHsKKwkJ
Lm5hbWUgICA9ICJtc21fZHBfcGxsIiwKKwkJLm9mX21hdGNoX3RhYmxlID0gZHBfcGxsX2R0X21h
dGNoLAorCX0sCit9OworCit2b2lkIF9faW5pdCBtc21fZHBfcGxsX2RyaXZlcl9yZWdpc3Rlcih2
b2lkKQoreworCXBsYXRmb3JtX2RyaXZlcl9yZWdpc3RlcigmZHBfcGxsX3BsYXRmb3JtX2RyaXZl
cik7Cit9CisKK3ZvaWQgX19leGl0IG1zbV9kcF9wbGxfZHJpdmVyX3VucmVnaXN0ZXIodm9pZCkK
K3sKKwlwbGF0Zm9ybV9kcml2ZXJfdW5yZWdpc3RlcigmZHBfcGxsX3BsYXRmb3JtX2RyaXZlcik7
Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbXNtL2RwL3BsbC9kcF9wbGwuaCBiL2Ry
aXZlcnMvZ3B1L2RybS9tc20vZHAvcGxsL2RwX3BsbC5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0Cmlu
ZGV4IDAwMDAwMDAuLjA3Y2U4MjIKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
bXNtL2RwL3BsbC9kcF9wbGwuaApAQCAtMCwwICsxLDU3IEBACisvKiBTUERYLUxpY2Vuc2UtSWRl
bnRpZmllcjogR1BMLTIuMC1vbmx5ICovCisvKgorICogQ29weXJpZ2h0IChjKSAyMDE2LTIwMTks
IFRoZSBMaW51eCBGb3VuZGF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLgorICovCisKKyNpZm5k
ZWYgX19EUF9QTExfSAorI2RlZmluZSBfX0RQX1BMTF9ICisKKyNpbmNsdWRlIDxsaW51eC9jbGsu
aD4KKyNpbmNsdWRlIDxsaW51eC9jbGstcHJvdmlkZXIuaD4KKyNpbmNsdWRlIDxsaW51eC9wbGF0
Zm9ybV9kZXZpY2UuaD4KKworI2luY2x1ZGUgImRwdV9pb191dGlsLmgiCisjaW5jbHVkZSAibXNt
X2Rydi5oIgorCisjZGVmaW5lIFBMTF9SRUdfVyhiYXNlLCBvZmZzZXQsIGRhdGEpCVwKKwkJCQl3
cml0ZWwoKGRhdGEpLCAoYmFzZSkgKyAob2Zmc2V0KSkKKyNkZWZpbmUgUExMX1JFR19SKGJhc2Us
IG9mZnNldCkJcmVhZGwoKGJhc2UpICsgKG9mZnNldCkpCisKK2VudW0gbXNtX2RwX3BsbF90eXBl
IHsKKwlNU01fRFBfUExMXzEwTk0sCisJTVNNX0RQX1BMTF9NQVgKK307CisKK3N0cnVjdCBtc21f
ZHBfcGxsIHsKKwllbnVtIG1zbV9kcF9wbGxfdHlwZSB0eXBlOworCXN0cnVjdCBjbGtfaHcgY2xr
X2h3OworCXVuc2lnbmVkIGxvbmcJcmF0ZTsJCS8qIGN1cnJlbnQgdmNvIHJhdGUgKi8KKwl1NjQJ
CW1pbl9yYXRlOwkvKiBtaW4gdmNvIHJhdGUgKi8KKwl1NjQJCW1heF9yYXRlOwkvKiBtYXggdmNv
IHJhdGUgKi8KKwlib29sCQlwbGxfb247CisJdm9pZAkJKnByaXY7CisJLyogUGxsIHNwZWNpZmlj
IHJlc291cmNlcyBsaWtlIEdQSU8sIHBvd2VyIHN1cHBseSwgY2xvY2tzLCBldGMqLworCXN0cnVj
dCBkc3NfbW9kdWxlX3Bvd2VyIG1wOworCWludCAoKmdldF9wcm92aWRlcikoc3RydWN0IG1zbV9k
cF9wbGwgKnBsbCwKKwkJCXN0cnVjdCBjbGsgKipsaW5rX2Nsa19wcm92aWRlciwKKwkJCXN0cnVj
dCBjbGsgKipwaXhlbF9jbGtfcHJvdmlkZXIpOworfTsKKworI2RlZmluZSBod19jbGtfdG9fcGxs
KHgpIGNvbnRhaW5lcl9vZih4LCBzdHJ1Y3QgbXNtX2RwX3BsbCwgY2xrX2h3KQorCitzdHJ1Y3Qg
bXNtX2RwX3BsbCAqbXNtX2RwX3BsbF9pbml0KHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYs
CisJCQkJZW51bSBtc21fZHBfcGxsX3R5cGUgdHlwZSwgaW50IGlkKTsKKworaW50IG1zbV9kcF9w
bGxfdXRpbF9wYXJzZV9kdF9jbG9jayhzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2LAorCQkJ
CXN0cnVjdCBtc21fZHBfcGxsICpwbGwpOworCisjaWZkZWYgQ09ORklHX0RSTV9NU01fRFBfMTBO
TV9QTEwKK3N0cnVjdCBtc21fZHBfcGxsICptc21fZHBfcGxsXzEwbm1faW5pdChzdHJ1Y3QgcGxh
dGZvcm1fZGV2aWNlICpwZGV2LCBpbnQgaWQpOworI2Vsc2UKK3N0YXRpYyBpbmxpbmUgc3RydWN0
IG1zbV9kcF9wbGwgKm1zbV9kcF9wbGxfMTBubV9pbml0CisJCQkJKHN0cnVjdCBwbGF0Zm9ybV9k
ZXZpY2UgKnBkZXYsIGludCBpZCkKK3sKKwlyZXR1cm4gRVJSX1BUUigtRU5PREVWKTsKK30KKyNl
bmRpZgorI2VuZGlmIC8qIF9fRFBfUExMX0ggKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9tc20vZHAvcGxsL2RwX3BsbF8xMG5tLmMgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL2RwL3BsbC9k
cF9wbGxfMTBubS5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjZlZjI0OTIK
LS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL2RwL3BsbC9kcF9wbGxfMTBu
bS5jCkBAIC0wLDAgKzEsNDAxIEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIu
MC1vbmx5CisvKgorICogQ29weXJpZ2h0IChjKSAyMDE2LTIwMTksIFRoZSBMaW51eCBGb3VuZGF0
aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLgorICovCisKKy8qCisgKiBEaXNwbGF5IFBvcnQgUExM
IGRyaXZlciBibG9jayBkaWFncmFtIGZvciBicmFuY2ggY2xvY2tzCisgKgorICogICAgICAgICAg
ICAgICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rCisgKiAgICAgICAgICAgICAgfCAg
ICAgICAgIERQX1ZDT19DTEsgICAgICAgICAgIHwKKyAqICAgICAgICAgICAgICB8ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgfAorICogICAgICAgICAgICAgIHwgICAgKy0tLS0tLS0tLS0t
LS0tLS0tLS0rICAgICB8CisgKiAgICAgICAgICAgICAgfCAgICB8ICAgKERQIFBMTC9WQ08pICAg
IHwgICAgIHwKKyAqICAgICAgICAgICAgICB8ICAgICstLS0tLS0tLS0rLS0tLS0tLS0tKyAgICAg
fAorICogICAgICAgICAgICAgIHwgICAgICAgICAgICAgIHYgICAgICAgICAgICAgICB8CisgKiAg
ICAgICAgICAgICAgfCAgICstLS0tLS0tLS0tKy0tLS0tLS0tLS0tKyAgIHwKKyAqICAgICAgICAg
ICAgICB8ICAgfCBoc2Nsa19kaXZzZWxfY2xrX3NyYyB8ICAgfAorICogICAgICAgICAgICAgIHwg
ICArLS0tLS0tLS0tLSstLS0tLS0tLS0tLSsgICB8CisgKiAgICAgICAgICAgICAgKy0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsKKyAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
fAorICogICAgICAgICAgKy0tLS0tLS0tLTwtLS0tLS0tLS12LS0tLS0tLS0tLS0tPi0tLS0tLS0t
LS0rCisgKiAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHwKKyAqICstLS0tLS0tLXYtLS0tLS0tLS0rICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgfAorICogfCBkcF9saW5rX2Nsa19zcmMgIHwgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB8CisgKiB8ICAgIGRpdnNlbF90ZW4gICAgfCAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHwKKyAqICstLS0tLS0tLSstLS0tLS0tLS0rICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgfAorICogICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB8CisgKiAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHwKKyAqICAgICAgICAgIHYgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdgorICogSW5wdXQgdG8gRElTUENDIGJsb2NrICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB8CisgKiBmb3IgbGluayBjbGssIGNyeXB0byBjbGsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHwKKyAqIGFuZCBpbnRlcmZhY2UgY2xvY2sgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgfAorICogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB8CisgKiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwKKyAqICAgICAgKy0tLS0tLS0tPC0tLS0tLS0t
LS0tLSstLS0tLS0tLS0tLS0tLS0tLSstLS08LS0tKworICogICAgICB8ICAgICAgICAgICAgICAg
ICAgICAgfCAgICAgICAgICAgICAgICAgfAorICogKy0tLS12LS0tLS0tLS0tKyAgKy0tLS0tLS0t
di0tLS0tKyAgKy0tLS0tLS0tdi0tLS0tLSsKKyAqIHwgdmNvX2RpdmlkZWQgIHwgIHwgdmNvX2Rp
dmlkZWQgIHwgIHwgdmNvX2RpdmlkZWQgICB8CisgKiB8ICAgIF9jbGtfc3JjICB8ICB8ICAgIF9j
bGtfc3JjICB8ICB8ICAgIF9jbGtfc3JjICAgfAorICogfCAgICAgICAgICAgICAgfCAgfCAgICAg
ICAgICAgICAgfCAgfCAgICAgICAgICAgICAgIHwKKyAqIHxkaXZzZWxfc2l4ICAgIHwgIHwgIGRp
dnNlbF90d28gIHwgIHwgIGRpdnNlbF9mb3VyICB8CisgKiArLS0tLS0tLSstLS0tLS0rICArLS0t
LS0rLS0tLS0tLS0rICArLS0tLS0tLS0rLS0tLS0tKworICogICAgICAgICB8ICAgICAgICAgICAg
ICAgICB8ICAgICAgICAgICAgICAgICAgfAorICogICAgICAgICB2LS0tLT4tLS0tLS0tLS0tdi0t
LS0tLS0tLS0tLS08LS0tLS0tdgorICogICAgICAgICAgICAgICAgICAgICAgICAgfAorICogICAg
ICAgICAgICAgICstLS0tLS0tLS0tKy0tLS0tLS0tLSsKKyAqICAgICAgICAgICAgICB8ICAgdmNv
X2RpdmlkZWRfY2xrICB8CisgKiAgICAgICAgICAgICAgfCAgICAgICBfc3JjX211eCAgICAgfAor
ICogICAgICAgICAgICAgICstLS0tLS0tLS0rLS0tLS0tLS0tLSsKKyAqICAgICAgICAgICAgICAg
ICAgICAgICAgfAorICogICAgICAgICAgICAgICAgICAgICAgICB2CisgKiAgICAgICAgICAgICAg
SW5wdXQgdG8gRElTUENDIGJsb2NrCisgKiAgICAgICAgICAgICAgZm9yIERQIHBpeGVsIGNsb2Nr
CisgKgorICovCisKKyNpbmNsdWRlIDxsaW51eC9jbGsuaD4KKyNpbmNsdWRlIDxsaW51eC9kZWxh
eS5oPgorI2luY2x1ZGUgPGxpbnV4L2Vyci5oPgorI2luY2x1ZGUgPGxpbnV4L2tlcm5lbC5oPgor
I2luY2x1ZGUgPGxpbnV4L3JlZ21hcC5oPgorCisjaW5jbHVkZSAiZHBfcGxsXzEwbm0uaCIKKwor
I2RlZmluZSBOVU1fUFJPVklERURfQ0xLUwkJMgorCisjZGVmaW5lIERQX0xJTktfQ0xLX1NSQwkJ
CTAKKyNkZWZpbmUgRFBfUElYRUxfQ0xLX1NSQwkJMQorCitzdGF0aWMgc3RydWN0IGRwX3BsbF8x
MG5tICpkcF9wZGI7CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgY2xrX29wcyBkcF8xMG5tX3Zjb19j
bGtfb3BzID0geworCS5yZWNhbGNfcmF0ZSA9IGRwX3Zjb19yZWNhbGNfcmF0ZV8xMG5tLAorCS5z
ZXRfcmF0ZSA9IGRwX3Zjb19zZXRfcmF0ZV8xMG5tLAorCS5yb3VuZF9yYXRlID0gZHBfdmNvX3Jv
dW5kX3JhdGVfMTBubSwKKwkucHJlcGFyZSA9IGRwX3Zjb19wcmVwYXJlXzEwbm0sCisJLnVucHJl
cGFyZSA9IGRwX3Zjb191bnByZXBhcmVfMTBubSwKK307CisKK3N0cnVjdCBkcF9wbGxfMTBubV9w
Y2xrc2VsIHsKKwlzdHJ1Y3QgY2xrX2h3IGh3OworCisJLyogZGl2aWRlciBwYXJhbXMgKi8KKwl1
OCBzaGlmdDsKKwl1OCB3aWR0aDsKKwl1OCBmbGFnczsgLyogc2FtZSBmbGFncyBhcyB1c2VkIGJ5
IGNsa19kaXZpZGVyIHN0cnVjdCAqLworCisJc3RydWN0IGRwX3BsbF8xMG5tICpwbGw7Cit9Owor
I2RlZmluZSB0b19wbGxfMTBubV9wY2xrc2VsKF9odykgY29udGFpbmVyX29mKF9odywgc3RydWN0
IGRwX3BsbF8xMG5tX3BjbGtzZWwsIGh3KQorCitzdGF0aWMgaW50IGRwX211eF9zZXRfcGFyZW50
XzEwbm0oc3RydWN0IGNsa19odyAqaHcsIHU4IHZhbCkKK3sKKwlzdHJ1Y3QgZHBfcGxsXzEwbm1f
cGNsa3NlbCAqcGNsa3NlbCA9IHRvX3BsbF8xMG5tX3BjbGtzZWwoaHcpOworCXN0cnVjdCBkcF9w
bGxfMTBubSAqZHBfcmVzID0gcGNsa3NlbC0+cGxsOworCXUzMiBhdXhjbGtfZGl2OworCisJYXV4
Y2xrX2RpdiA9IFBMTF9SRUdfUihkcF9yZXMtPnBoeV9iYXNlLCBSRUdfRFBfUEhZX1ZDT19ESVYp
OworCWF1eGNsa19kaXYgJj0gfjB4MDM7CS8qIGJpdHMgMCB0byAxICovCisKKwlpZiAodmFsID09
IDApIC8qIG11eCBwYXJlbnQgaW5kZXggPSAwICovCisJCWF1eGNsa19kaXYgfD0gMTsKKwllbHNl
IGlmICh2YWwgPT0gMSkgLyogbXV4IHBhcmVudCBpbmRleCA9IDEgKi8KKwkJYXV4Y2xrX2RpdiB8
PSAyOworCWVsc2UgaWYgKHZhbCA9PSAyKSAvKiBtdXggcGFyZW50IGluZGV4ID0gMiAqLworCQlh
dXhjbGtfZGl2IHw9IDA7CisKKwlQTExfUkVHX1coZHBfcmVzLT5waHlfYmFzZSwKKwkJCVJFR19E
UF9QSFlfVkNPX0RJViwgYXV4Y2xrX2Rpdik7CisJRFJNX0RFQlVHX0RQKCIlczogbXV4PSVkIGF1
eGNsa19kaXY9JXhcbiIsIF9fZnVuY19fLCB2YWwsIGF1eGNsa19kaXYpOworCisJcmV0dXJuIDA7
Cit9CisKK3N0YXRpYyB1OCBkcF9tdXhfZ2V0X3BhcmVudF8xMG5tKHN0cnVjdCBjbGtfaHcgKmh3
KQoreworCXUzMiBhdXhjbGtfZGl2ID0gMDsKKwlzdHJ1Y3QgZHBfcGxsXzEwbm1fcGNsa3NlbCAq
cGNsa3NlbCA9IHRvX3BsbF8xMG5tX3BjbGtzZWwoaHcpOworCXN0cnVjdCBkcF9wbGxfMTBubSAq
ZHBfcmVzID0gcGNsa3NlbC0+cGxsOworCXU4IHZhbCA9IDA7CisKKwlEUk1fRVJST1IoImNsa19o
dy0+aW5pdC0+bmFtZSA9ICVzXG4iLCBody0+aW5pdC0+bmFtZSk7CisJYXV4Y2xrX2RpdiA9IFBM
TF9SRUdfUihkcF9yZXMtPnBoeV9iYXNlLCBSRUdfRFBfUEhZX1ZDT19ESVYpOworCWF1eGNsa19k
aXYgJj0gMHgwMzsKKworCWlmIChhdXhjbGtfZGl2ID09IDEpIC8qIERlZmF1bHQgZGl2aWRlciAq
LworCQl2YWwgPSAwOworCWVsc2UgaWYgKGF1eGNsa19kaXYgPT0gMikKKwkJdmFsID0gMTsKKwll
bHNlIGlmIChhdXhjbGtfZGl2ID09IDApCisJCXZhbCA9IDI7CisKKwlEUk1fREVCVUdfRFAoIiVz
OiBhdXhjbGtfZGl2PSVkLCB2YWw9JWRcbiIsIF9fZnVuY19fLCBhdXhjbGtfZGl2LCB2YWwpOwor
CisJcmV0dXJuIHZhbDsKK30KKworc3RhdGljIGludCBjbGtfbXV4X2RldGVybWluZV9yYXRlKHN0
cnVjdCBjbGtfaHcgKmh3LAorCQkJCSAgICAgc3RydWN0IGNsa19yYXRlX3JlcXVlc3QgKnJlcSkK
K3sKKwl1bnNpZ25lZCBsb25nIHJhdGUgPSAwOworCWludCByZXQgPSAwOworCisJcmF0ZSA9IGNs
a19nZXRfcmF0ZShody0+Y2xrKTsKKworCWlmIChyYXRlIDw9IDApIHsKKwkJRFJNX0VSUk9SKCJS
YXRlIGlzIG5vdCBzZXQgcHJvcGVybHlcbiIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwly
ZXEtPnJhdGUgPSByYXRlOworCisJRFJNX0RFQlVHX0RQKCIlczogcmF0ZT0lbGRcbiIsIF9fZnVu
Y19fLCByZXEtPnJhdGUpOworCS8qIFNldCB0aGUgbmV3IHBhcmVudCBvZiBtdXggaWYgdGhlcmUg
aXMgYSBuZXcgdmFsaWQgcGFyZW50ICovCisJaWYgKGh3LT5jbGsgJiYgcmVxLT5iZXN0X3BhcmVu
dF9ody0+Y2xrKSB7CisJCXJldCA9IGNsa19zZXRfcGFyZW50KGh3LT5jbGssIHJlcS0+YmVzdF9w
YXJlbnRfaHctPmNsayk7CisJCWlmIChyZXQpIHsKKwkJCURSTV9FUlJPUigiJXM6IGNsa19zZXRf
cGFyZW50IGZhaWxlZDogcmV0PSVkXG4iLCBfX2Z1bmNfXywgcmV0KTsKKwkJCXJldHVybiByZXQ7
CisJCX0KKwl9CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB1bnNpZ25lZCBsb25nIG11eF9yZWNh
bGNfcmF0ZShzdHJ1Y3QgY2xrX2h3ICpodywKKwkJCQkJdW5zaWduZWQgbG9uZyBwYXJlbnRfcmF0
ZSkKK3sKKwlzdHJ1Y3QgY2xrICpkaXZfY2xrID0gTlVMTCwgKnZjb19jbGsgPSBOVUxMOworCXN0
cnVjdCBtc21fZHBfcGxsICp2Y28gPSBOVUxMOworCisJZGl2X2NsayA9IGNsa19nZXRfcGFyZW50
KGh3LT5jbGspOworCWlmICghZGl2X2NsaykKKwkJcmV0dXJuIDA7CisKKwl2Y29fY2xrID0gY2xr
X2dldF9wYXJlbnQoZGl2X2Nsayk7CisJaWYgKCF2Y29fY2xrKQorCQlyZXR1cm4gMDsKKworCXZj
byA9IGh3X2Nsa190b19wbGwoX19jbGtfZ2V0X2h3KHZjb19jbGspKTsKKwlpZiAoIXZjbykKKwkJ
cmV0dXJuIDA7CisKKwlpZiAodmNvLT5yYXRlID09IERQX1ZDT19IU0NMS19SQVRFXzgxMDBNSFpE
SVYxMDAwKQorCQlyZXR1cm4gKHZjby0+cmF0ZSAvIDYpOworCWVsc2UgaWYgKHZjby0+cmF0ZSA9
PSBEUF9WQ09fSFNDTEtfUkFURV81NDAwTUhaRElWMTAwMCkKKwkJcmV0dXJuICh2Y28tPnJhdGUg
LyA0KTsKKwllbHNlCisJCXJldHVybiAodmNvLT5yYXRlIC8gMik7Cit9CisKK3N0YXRpYyBpbnQg
ZHBfcGxsXzEwbm1fZ2V0X3Byb3ZpZGVyKHN0cnVjdCBtc21fZHBfcGxsICpwbGwsCisJCQkJICAg
ICBzdHJ1Y3QgY2xrICoqbGlua19jbGtfcHJvdmlkZXIsCisJCQkJICAgICBzdHJ1Y3QgY2xrICoq
cGl4ZWxfY2xrX3Byb3ZpZGVyKQoreworCXN0cnVjdCBkcF9wbGxfMTBubSAqcGxsXzEwbm0gPSB0
b19kcF9wbGxfMTBubShwbGwpOworCXN0cnVjdCBjbGtfaHdfb25lY2VsbF9kYXRhICpod19kYXRh
ID0gcGxsXzEwbm0tPmh3X2RhdGE7CisKKwlpZiAobGlua19jbGtfcHJvdmlkZXIpCisJCSpsaW5r
X2Nsa19wcm92aWRlciA9IGh3X2RhdGEtPmh3c1tEUF9MSU5LX0NMS19TUkNdLT5jbGs7CisJaWYg
KHBpeGVsX2Nsa19wcm92aWRlcikKKwkJKnBpeGVsX2Nsa19wcm92aWRlciA9IGh3X2RhdGEtPmh3
c1tEUF9QSVhFTF9DTEtfU1JDXS0+Y2xrOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBjb25z
dCBzdHJ1Y3QgY2xrX29wcyBkcF8xMG5tX3BjbGtzZWxfY2xrX29wcyA9IHsKKwkuZ2V0X3BhcmVu
dCA9IGRwX211eF9nZXRfcGFyZW50XzEwbm0sCisJLnNldF9wYXJlbnQgPSBkcF9tdXhfc2V0X3Bh
cmVudF8xMG5tLAorCS5yZWNhbGNfcmF0ZSA9IG11eF9yZWNhbGNfcmF0ZSwKKwkuZGV0ZXJtaW5l
X3JhdGUgPSBjbGtfbXV4X2RldGVybWluZV9yYXRlLAorfTsKKworc3RhdGljIHN0cnVjdCBjbGtf
aHcgKmRwX3BsbF8xMG5tX3BpeGVsX2Nsa19zZWwoc3RydWN0IGRwX3BsbF8xMG5tICpwbGxfMTBu
bSkKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmcGxsXzEwbm0tPnBkZXYtPmRldjsKKwlzdHJ1
Y3QgZHBfcGxsXzEwbm1fcGNsa3NlbCAqcGxsX3BjbGtzZWw7CisJc3RydWN0IGNsa19pbml0X2Rh
dGEgcGNsa3NlbF9pbml0ID0geworCQkucGFyZW50X25hbWVzID0gKGNvbnN0IGNoYXIgKltdKXsK
KwkJCQkiZHBfdmNvX2RpdnNlbF90d29fY2xrX3NyYyIsCisJCQkJImRwX3Zjb19kaXZzZWxfZm91
cl9jbGtfc3JjIiwKKwkJCQkiZHBfdmNvX2RpdnNlbF9zaXhfY2xrX3NyYyIgfSwKKwkJLm51bV9w
YXJlbnRzID0gMywKKwkJLm5hbWUgPSAiZHBfdmNvX2RpdmlkZWRfY2xrX3NyY19tdXgiLAorCQku
ZmxhZ3MgPSBDTEtfSUdOT1JFX1VOVVNFRCwKKwkJLm9wcyA9ICZkcF8xMG5tX3BjbGtzZWxfY2xr
X29wcywKKwl9OworCWludCByZXQ7CisKKwlwbGxfcGNsa3NlbCA9IGRldm1fa3phbGxvYyhkZXYs
IHNpemVvZigqcGxsX3BjbGtzZWwpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIXBsbF9wY2xrc2VsKQor
CQlyZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKKworCXBsbF9wY2xrc2VsLT5wbGwgPSBwbGxfMTBu
bTsKKwlwbGxfcGNsa3NlbC0+c2hpZnQgPSAwOworCXBsbF9wY2xrc2VsLT53aWR0aCA9IDQ7CisJ
cGxsX3BjbGtzZWwtPmZsYWdzID0gQ0xLX0RJVklERVJfT05FX0JBU0VEOworCXBsbF9wY2xrc2Vs
LT5ody5pbml0ID0gJnBjbGtzZWxfaW5pdDsKKworCXJldCA9IGNsa19od19yZWdpc3RlcihkZXYs
ICZwbGxfcGNsa3NlbC0+aHcpOworCWlmIChyZXQpCisJCXJldHVybiBFUlJfUFRSKHJldCk7CisK
KwlyZXR1cm4gJnBsbF9wY2xrc2VsLT5odzsKK30KKworc3RhdGljIGludCBkcF9wbGxfMTBubV9y
ZWdpc3RlcihzdHJ1Y3QgZHBfcGxsXzEwbm0gKnBsbF8xMG5tKQoreworCWNoYXIgY2xrX25hbWVb
MzJdLCBwYXJlbnRbMzJdLCB2Y29fbmFtZVszMl07CisJc3RydWN0IGNsa19pbml0X2RhdGEgdmNv
X2luaXQgPSB7CisJCS5wYXJlbnRfbmFtZXMgPSAoY29uc3QgY2hhciAqW10peyAiYmlfdGN4byIg
fSwKKwkJLm51bV9wYXJlbnRzID0gMSwKKwkJLm5hbWUgPSB2Y29fbmFtZSwKKwkJLmZsYWdzID0g
Q0xLX0lHTk9SRV9VTlVTRUQsCisJCS5vcHMgPSAmZHBfMTBubV92Y29fY2xrX29wcywKKwl9Owor
CXN0cnVjdCBkZXZpY2UgKmRldiA9ICZwbGxfMTBubS0+cGRldi0+ZGV2OworCXN0cnVjdCBjbGtf
aHcgKipod3MgPSBwbGxfMTBubS0+aHdzOworCXN0cnVjdCBjbGtfaHdfb25lY2VsbF9kYXRhICpo
d19kYXRhOworCXN0cnVjdCBjbGtfaHcgKmh3OworCWludCBudW0gPSAwOworCWludCByZXQ7CisK
KwlEUk1fREVCVUdfRFAoIkRQLT5pZCA9ICVkIiwgcGxsXzEwbm0tPmlkKTsKKworCWh3X2RhdGEg
PSBkZXZtX2t6YWxsb2MoZGV2LCBzaXplb2YoKmh3X2RhdGEpICsKKwkJCSAgICAgICBOVU1fUFJP
VklERURfQ0xLUyAqIHNpemVvZihzdHJ1Y3QgY2xrX2h3ICopLAorCQkJICAgICAgIEdGUF9LRVJO
RUwpOworCWlmICghaHdfZGF0YSkKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlzbnByaW50Zih2Y29f
bmFtZSwgMzIsICJkcF92Y29fY2xrIik7CisJcGxsXzEwbm0tPmJhc2UuY2xrX2h3LmluaXQgPSAm
dmNvX2luaXQ7CisJcmV0ID0gY2xrX2h3X3JlZ2lzdGVyKGRldiwgJnBsbF8xMG5tLT5iYXNlLmNs
a19odyk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKwlod3NbbnVtKytdID0gJnBsbF8xMG5t
LT5iYXNlLmNsa19odzsKKworCXNucHJpbnRmKGNsa19uYW1lLCAzMiwgImRwX2xpbmtfY2xrX2Rp
dnNlbF90ZW4iKTsKKwlzbnByaW50ZihwYXJlbnQsIDMyLCAiZHBfdmNvX2NsayIpOworCWh3ID0g
Y2xrX2h3X3JlZ2lzdGVyX2ZpeGVkX2ZhY3RvcihkZXYsIGNsa19uYW1lLCBwYXJlbnQsCisJCQkJ
CSAgQ0xLX1NFVF9SQVRFX1BBUkVOVCwgMSwgMTApOworCWlmIChJU19FUlIoaHcpKQorCQlyZXR1
cm4gUFRSX0VSUihodyk7CisJaHdzW251bSsrXSA9IGh3OworCWh3X2RhdGEtPmh3c1tEUF9MSU5L
X0NMS19TUkNdID0gaHc7CisKKwlzbnByaW50ZihjbGtfbmFtZSwgMzIsICJkcF92Y29fZGl2c2Vs
X3R3b19jbGtfc3JjIik7CisJc25wcmludGYocGFyZW50LCAzMiwgImRwX3Zjb19jbGsiKTsKKwlo
dyA9IGNsa19od19yZWdpc3Rlcl9maXhlZF9mYWN0b3IoZGV2LCBjbGtfbmFtZSwgcGFyZW50LAor
CQkJCQkgIDAsIDEsIDIpOworCWlmIChJU19FUlIoaHcpKQorCQlyZXR1cm4gUFRSX0VSUihodyk7
CisJaHdzW251bSsrXSA9IGh3OworCisJc25wcmludGYoY2xrX25hbWUsIDMyLCAiZHBfdmNvX2Rp
dnNlbF9mb3VyX2Nsa19zcmMiKTsKKwlzbnByaW50ZihwYXJlbnQsIDMyLCAiZHBfdmNvX2NsayIp
OworCWh3ID0gY2xrX2h3X3JlZ2lzdGVyX2ZpeGVkX2ZhY3RvcihkZXYsIGNsa19uYW1lLCBwYXJl
bnQsCisJCQkJCSAgMCwgMSwgNCk7CisJaWYgKElTX0VSUihodykpCisJCXJldHVybiBQVFJfRVJS
KGh3KTsKKwlod3NbbnVtKytdID0gaHc7CisKKwlzbnByaW50ZihjbGtfbmFtZSwgMzIsICJkcF92
Y29fZGl2c2VsX3NpeF9jbGtfc3JjIik7CisJc25wcmludGYocGFyZW50LCAzMiwgImRwX3Zjb19j
bGsiKTsKKwlodyA9IGNsa19od19yZWdpc3Rlcl9maXhlZF9mYWN0b3IoZGV2LCBjbGtfbmFtZSwg
cGFyZW50LAorCQkJCQkgIDAsIDEsIDYpOworCWlmIChJU19FUlIoaHcpKQorCQlyZXR1cm4gUFRS
X0VSUihodyk7CisJaHdzW251bSsrXSA9IGh3OworCisJaHcgPSBkcF9wbGxfMTBubV9waXhlbF9j
bGtfc2VsKHBsbF8xMG5tKTsKKwlpZiAoSVNfRVJSKGh3KSkKKwkJcmV0dXJuIFBUUl9FUlIoaHcp
OworCisJaHdzW251bSsrXSA9IGh3OworCWh3X2RhdGEtPmh3c1tEUF9QSVhFTF9DTEtfU1JDXSA9
IGh3OworCisJcGxsXzEwbm0tPm51bV9od3MgPSBudW07CisKKwlod19kYXRhLT5udW0gPSBOVU1f
UFJPVklERURfQ0xLUzsKKwlwbGxfMTBubS0+aHdfZGF0YSA9IGh3X2RhdGE7CisKKwlyZXQgPSBv
Zl9jbGtfYWRkX2h3X3Byb3ZpZGVyKGRldi0+b2Zfbm9kZSwgb2ZfY2xrX2h3X29uZWNlbGxfZ2V0
LAorCQkJCSAgICAgcGxsXzEwbm0tPmh3X2RhdGEpOworCWlmIChyZXQpIHsKKwkJRFJNX0RFVl9F
UlJPUihkZXYsICJmYWlsZWQgdG8gcmVnaXN0ZXIgY2xrIHByb3ZpZGVyOiAlZFxuIiwgcmV0KTsK
KwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXR1cm4gcmV0OworfQorCitzdHJ1Y3QgbXNtX2RwX3Bs
bCAqbXNtX2RwX3BsbF8xMG5tX2luaXQoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldiwgaW50
IGlkKQoreworCXN0cnVjdCBkcF9wbGxfMTBubSAqZHBfMTBubV9wbGw7CisJc3RydWN0IG1zbV9k
cF9wbGwgKnBsbDsKKwlpbnQgcmV0OworCisJaWYgKCFwZGV2KQorCQlyZXR1cm4gRVJSX1BUUigt
RU5PREVWKTsKKworCWRwXzEwbm1fcGxsID0gZGV2bV9remFsbG9jKCZwZGV2LT5kZXYsIHNpemVv
ZigqZHBfMTBubV9wbGwpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWRwXzEwbm1fcGxsKQorCQlyZXR1
cm4gRVJSX1BUUigtRU5PTUVNKTsKKworCURSTV9ERUJVR19EUCgiRFAgUExMJWQiLCBpZCk7CisK
KwlkcF8xMG5tX3BsbC0+cGRldiA9IHBkZXY7CisJZHBfMTBubV9wbGwtPmlkID0gaWQ7CisJZHBf
cGRiID0gZHBfMTBubV9wbGw7CisKKwlkcF8xMG5tX3BsbC0+cGxsX2Jhc2UgPSBtc21faW9yZW1h
cChwZGV2LCAicGxsX2Jhc2UiLCAiRFBfUExMIik7CisJaWYgKElTX0VSUl9PUl9OVUxMKGRwXzEw
bm1fcGxsLT5wbGxfYmFzZSkpIHsKKwkJRFJNX0RFVl9FUlJPUigmcGRldi0+ZGV2LCAiZmFpbGVk
IHRvIG1hcCBDTU4gUExMIGJhc2VcbiIpOworCQlyZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKKwl9
CisKKwlkcF8xMG5tX3BsbC0+cGh5X2Jhc2UgPSBtc21faW9yZW1hcChwZGV2LCAicGh5X2Jhc2Ui
LCAiRFBfUEhZIik7CisJaWYgKElTX0VSUl9PUl9OVUxMKGRwXzEwbm1fcGxsLT5waHlfYmFzZSkp
IHsKKwkJRFJNX0RFVl9FUlJPUigmcGRldi0+ZGV2LCAiZmFpbGVkIHRvIG1hcCBDTU4gUEhZIGJh
c2VcbiIpOworCQlyZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKKwl9CisKKwlkcF8xMG5tX3BsbC0+
bG5fdHgwX2Jhc2UgPSBtc21faW9yZW1hcChwZGV2LCAibG5fdHgwX2Jhc2UiLCAiRFBfTE5fVFgw
Iik7CisJaWYgKElTX0VSUl9PUl9OVUxMKGRwXzEwbm1fcGxsLT5sbl90eDBfYmFzZSkpIHsKKwkJ
RFJNX0RFVl9FUlJPUigmcGRldi0+ZGV2LCAiZmFpbGVkIHRvIG1hcCBDTU4gTE5fVFgwIGJhc2Vc
biIpOworCQlyZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKKwl9CisKKwlkcF8xMG5tX3BsbC0+bG5f
dHgxX2Jhc2UgPSBtc21faW9yZW1hcChwZGV2LCAibG5fdHgxX2Jhc2UiLCAiRFBfTE5fVFgxIik7
CisJaWYgKElTX0VSUl9PUl9OVUxMKGRwXzEwbm1fcGxsLT5sbl90eDFfYmFzZSkpIHsKKwkJRFJN
X0RFVl9FUlJPUigmcGRldi0+ZGV2LCAiZmFpbGVkIHRvIG1hcCBDTU4gTE5fVFgxIGJhc2VcbiIp
OworCQlyZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKKwl9CisKKwlyZXQgPSBvZl9wcm9wZXJ0eV9y
ZWFkX3UzMihwZGV2LT5kZXYub2Zfbm9kZSwgImNlbGwtaW5kZXgiLAorCQkJCSZkcF8xMG5tX3Bs
bC0+aW5kZXgpOworCWlmIChyZXQpIHsKKwkJRFJNX0VSUk9SKCJVbmFibGUgdG8gZ2V0IHRoZSBj
ZWxsLWluZGV4IHJldD0lZFxuIiwgcmV0KTsKKwkJZHBfMTBubV9wbGwtPmluZGV4ID0gMDsKKwl9
CisKKwlyZXQgPSBtc21fZHBfcGxsX3V0aWxfcGFyc2VfZHRfY2xvY2socGRldiwgJmRwXzEwbm1f
cGxsLT5iYXNlKTsKKwlpZiAocmV0KSB7CisJCURSTV9FUlJPUigiVW5hYmxlIHRvIHBhcnNlIGR0
IGNsb2NrcyByZXQ9JWRcbiIsIHJldCk7CisJCXJldHVybiBFUlJfUFRSKHJldCk7CisJfQorCisJ
cmV0ID0gZHBfcGxsXzEwbm1fcmVnaXN0ZXIoZHBfMTBubV9wbGwpOworCWlmIChyZXQpIHsKKwkJ
RFJNX0RFVl9FUlJPUigmcGRldi0+ZGV2LCAiZmFpbGVkIHRvIHJlZ2lzdGVyIFBMTDogJWRcbiIs
IHJldCk7CisJCXJldHVybiBFUlJfUFRSKHJldCk7CisJfQorCisJcGxsID0gJmRwXzEwbm1fcGxs
LT5iYXNlOworCXBsbC0+bWluX3JhdGUgPSBEUF9WQ09fSFNDTEtfUkFURV8xNjIwTUhaRElWMTAw
MDsKKwlwbGwtPm1heF9yYXRlID0gRFBfVkNPX0hTQ0xLX1JBVEVfODEwME1IWkRJVjEwMDA7CisJ
cGxsLT5nZXRfcHJvdmlkZXIgPSBkcF9wbGxfMTBubV9nZXRfcHJvdmlkZXI7CisKKwlyZXR1cm4g
cGxsOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21zbS9kcC9wbGwvZHBfcGxsXzEw
bm0uaCBiL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvcGxsL2RwX3BsbF8xMG5tLmgKbmV3IGZpbGUg
bW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uZTJhNTMzNwotLS0gL2Rldi9udWxsCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9tc20vZHAvcGxsL2RwX3BsbF8xMG5tLmgKQEAgLTAsMCArMSw4NiBAQAor
LyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seSAqLworLyoKKyAqIENvcHly
aWdodCAoYykgMjAxNi0yMDE5LCBUaGUgTGludXggRm91bmRhdGlvbi4gQWxsIHJpZ2h0cyByZXNl
cnZlZC4KKyAqLworCisjaWZuZGVmIF9fRFBfUExMXzEwTk1fSAorI2RlZmluZSBfX0RQX1BMTF8x
ME5NX0gKKworI2luY2x1ZGUgImRwX3BsbC5oIgorI2luY2x1ZGUgImRwX3JlZy5oIgorCisjZGVm
aW5lIERQX1ZDT19IU0NMS19SQVRFXzE2MjBNSFpESVYxMDAwCTE2MjAwMDBVTAorI2RlZmluZSBE
UF9WQ09fSFNDTEtfUkFURV8yNzAwTUhaRElWMTAwMAkyNzAwMDAwVUwKKyNkZWZpbmUgRFBfVkNP
X0hTQ0xLX1JBVEVfNTQwME1IWkRJVjEwMDAJNTQwMDAwMFVMCisjZGVmaW5lIERQX1ZDT19IU0NM
S19SQVRFXzgxMDBNSFpESVYxMDAwCTgxMDAwMDBVTAorCisjZGVmaW5lIE5VTV9EUF9DTE9DS1Nf
TUFYCQkJNgorCisjZGVmaW5lIERQX1BIWV9QTExfUE9MTF9TTEVFUF9VUwkJNTAwCisjZGVmaW5l
IERQX1BIWV9QTExfUE9MTF9USU1FT1VUX1VTCQkxMDAwMAorCisjZGVmaW5lIERQX1ZDT19SQVRF
XzgxMDBNSFpESVYxMDAwCQk4MTAwMDAwVUwKKyNkZWZpbmUgRFBfVkNPX1JBVEVfOTcyME1IWkRJ
VjEwMDAJCTk3MjAwMDBVTAorI2RlZmluZSBEUF9WQ09fUkFURV8xMDgwME1IWkRJVjEwMDAJCTEw
ODAwMDAwVUwKKworc3RydWN0IGRwX3BsbF8xMG5tIHsKKwlzdHJ1Y3QgbXNtX2RwX3BsbCBiYXNl
OworCisJaW50IGlkOworCXN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXY7CisKKwl2b2lkIF9f
aW9tZW0gKnBsbF9iYXNlOworCXZvaWQgX19pb21lbSAqcGh5X2Jhc2U7CisJdm9pZCBfX2lvbWVt
ICpsbl90eDBfYmFzZTsKKwl2b2lkIF9faW9tZW0gKmxuX3R4MV9iYXNlOworCisJLyogcHJpdmF0
ZSBjbG9ja3M6ICovCisJc3RydWN0IGNsa19odyAqaHdzW05VTV9EUF9DTE9DS1NfTUFYXTsKKwl1
MzIgbnVtX2h3czsKKworCS8qIGNsb2NrLXByb3ZpZGVyOiAqLworCXN0cnVjdCBjbGtfaHdfb25l
Y2VsbF9kYXRhICpod19kYXRhOworCisJLyogbGFuZSBhbmQgb3JpZW50YXRpb24gc2V0dGluZ3Mg
Ki8KKwl1OCBsYW5lX2NudDsKKwl1OCBvcmllbnRhdGlvbjsKKworCS8qIENPTSBQSFkgc2V0dGlu
Z3MgKi8KKwl1MzIgaHNjbGtfc2VsOworCXUzMiBkZWNfc3RhcnRfbW9kZTA7CisJdTMyIGRpdl9m
cmFjX3N0YXJ0MV9tb2RlMDsKKwl1MzIgZGl2X2ZyYWNfc3RhcnQyX21vZGUwOworCXUzMiBkaXZf
ZnJhY19zdGFydDNfbW9kZTA7CisJdTMyIGludGVnbG9vcF9nYWluMF9tb2RlMDsKKwl1MzIgaW50
ZWdsb29wX2dhaW4xX21vZGUwOworCXUzMiB2Y29fdHVuZV9tYXA7CisJdTMyIGxvY2tfY21wMV9t
b2RlMDsKKwl1MzIgbG9ja19jbXAyX21vZGUwOworCXUzMiBsb2NrX2NtcDNfbW9kZTA7CisJdTMy
IGxvY2tfY21wX2VuOworCisJLyogUEhZIHZjbyBkaXZpZGVyICovCisJdTMyIHBoeV92Y29fZGl2
OworCS8qCisJICogQ2VydGFpbiBwbGwncyBuZWVkcyB0byB1cGRhdGUgdGhlIHNhbWUgdmNvIHJh
dGUgYWZ0ZXIgcmVzdW1lIGluCisJICogc3VzcGVuZC9yZXN1bWUgc2NlbmFyaW8uIENhY2hlZCB0
aGUgdmNvIHJhdGUgZm9yIHN1Y2ggcGxscy4KKwkgKi8KKwl1bnNpZ25lZCBsb25nCXZjb19jYWNo
ZWRfcmF0ZTsKKwl1MzIJCWNhY2hlZF9jZmcwOworCXUzMgkJY2FjaGVkX2NmZzE7CisJdTMyCQlj
YWNoZWRfb3V0ZGl2OworCisJdWludDMyX3QgaW5kZXg7Cit9OworCisjZGVmaW5lIHRvX2RwX3Bs
bF8xMG5tKHgpCWNvbnRhaW5lcl9vZih4LCBzdHJ1Y3QgZHBfcGxsXzEwbm0sIGJhc2UpCisKK2lu
dCBkcF92Y29fc2V0X3JhdGVfMTBubShzdHJ1Y3QgY2xrX2h3ICpodywgdW5zaWduZWQgbG9uZyBy
YXRlLAorCQkJCXVuc2lnbmVkIGxvbmcgcGFyZW50X3JhdGUpOwordW5zaWduZWQgbG9uZyBkcF92
Y29fcmVjYWxjX3JhdGVfMTBubShzdHJ1Y3QgY2xrX2h3ICpodywKKwkJCQl1bnNpZ25lZCBsb25n
IHBhcmVudF9yYXRlKTsKK2xvbmcgZHBfdmNvX3JvdW5kX3JhdGVfMTBubShzdHJ1Y3QgY2xrX2h3
ICpodywgdW5zaWduZWQgbG9uZyByYXRlLAorCQkJCXVuc2lnbmVkIGxvbmcgKnBhcmVudF9yYXRl
KTsKK2ludCBkcF92Y29fcHJlcGFyZV8xMG5tKHN0cnVjdCBjbGtfaHcgKmh3KTsKK3ZvaWQgZHBf
dmNvX3VucHJlcGFyZV8xMG5tKHN0cnVjdCBjbGtfaHcgKmh3KTsKKyNlbmRpZiAvKiBfX0RQX1BM
TF8xME5NX0ggKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvcGxsL2RwX3Bs
bF8xMG5tX3V0aWwuYyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vZHAvcGxsL2RwX3BsbF8xMG5tX3V0
aWwuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi5iOGY3ZGVmCi0tLSAvZGV2
L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL21zbS9kcC9wbGwvZHBfcGxsXzEwbm1fdXRpbC5j
CkBAIC0wLDAgKzEsNDk0IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1v
bmx5CisvKgorICogQ29weXJpZ2h0IChjKSAyMDE2LTIwMTksIFRoZSBMaW51eCBGb3VuZGF0aW9u
LiBBbGwgcmlnaHRzIHJlc2VydmVkLgorICovCisKKyNkZWZpbmUgcHJfZm10KGZtdCkJIiVzOiAi
IGZtdCwgX19mdW5jX18KKworI2luY2x1ZGUgPGxpbnV4L2RlbGF5Lmg+CisjaW5jbHVkZSA8bGlu
dXgvZXJyLmg+CisjaW5jbHVkZSA8bGludXgvaW9wb2xsLmg+CisjaW5jbHVkZSA8bGludXgva2Vy
bmVsLmg+CisKKyNpbmNsdWRlICJkcF9leHRjb24uaCIKKyNpbmNsdWRlICJkcF9wbGwuaCIKKyNp
bmNsdWRlICJkcF9wbGxfMTBubS5oIgorCitzdGF0aWMgaW50IGRwX3Zjb19wbGxfaW5pdF9kYl8x
MG5tKHN0cnVjdCBtc21fZHBfcGxsICpwbGwsCisJCXVuc2lnbmVkIGxvbmcgcmF0ZSkKK3sKKwlz
dHJ1Y3QgZHBfcGxsXzEwbm0gKmRwX3JlcyA9IHRvX2RwX3BsbF8xMG5tKHBsbCk7CisJdTMyIHNw
YXJlX3ZhbHVlID0gMDsKKworCXNwYXJlX3ZhbHVlID0gUExMX1JFR19SKGRwX3Jlcy0+cGh5X2Jh
c2UsIFJFR19EUF9QSFlfU1BBUkUwKTsKKwlkcF9yZXMtPmxhbmVfY250ID0gc3BhcmVfdmFsdWUg
JiAweDBGOworCWRwX3Jlcy0+b3JpZW50YXRpb24gPSAoc3BhcmVfdmFsdWUgJiAweEYwKSA+PiA0
OworCisJRFJNX0RFQlVHX0RQKCIlczogc3BhcmVfdmFsdWU9MHgleCwgbG5fY250PTB4JXgsIG9y
aWVudGF0aW9uPTB4JXhcbiIsCisJCQlfX2Z1bmNfXywgc3BhcmVfdmFsdWUsIGRwX3Jlcy0+bGFu
ZV9jbnQsIGRwX3Jlcy0+b3JpZW50YXRpb24pOworCisJc3dpdGNoIChyYXRlKSB7CisJY2FzZSBE
UF9WQ09fSFNDTEtfUkFURV8xNjIwTUhaRElWMTAwMDoKKwkJRFJNX0RFQlVHX0RQKCIlczogVkNP
IHJhdGU6ICVsZFxuIiwgX19mdW5jX18sCisJCQkJRFBfVkNPX1JBVEVfOTcyME1IWkRJVjEwMDAp
OworCQlkcF9yZXMtPmhzY2xrX3NlbCA9IDB4MGM7CisJCWRwX3Jlcy0+ZGVjX3N0YXJ0X21vZGUw
ID0gMHg2OTsKKwkJZHBfcmVzLT5kaXZfZnJhY19zdGFydDFfbW9kZTAgPSAweDAwOworCQlkcF9y
ZXMtPmRpdl9mcmFjX3N0YXJ0Ml9tb2RlMCA9IDB4ODA7CisJCWRwX3Jlcy0+ZGl2X2ZyYWNfc3Rh
cnQzX21vZGUwID0gMHgwNzsKKwkJZHBfcmVzLT5pbnRlZ2xvb3BfZ2FpbjBfbW9kZTAgPSAweDNm
OworCQlkcF9yZXMtPmludGVnbG9vcF9nYWluMV9tb2RlMCA9IDB4MDA7CisJCWRwX3Jlcy0+dmNv
X3R1bmVfbWFwID0gMHgwMDsKKwkJZHBfcmVzLT5sb2NrX2NtcDFfbW9kZTAgPSAweDZmOworCQlk
cF9yZXMtPmxvY2tfY21wMl9tb2RlMCA9IDB4MDg7CisJCWRwX3Jlcy0+bG9ja19jbXAzX21vZGUw
ID0gMHgwMDsKKwkJZHBfcmVzLT5waHlfdmNvX2RpdiA9IDB4MTsKKwkJZHBfcmVzLT5sb2NrX2Nt
cF9lbiA9IDB4MDA7CisJCWJyZWFrOworCWNhc2UgRFBfVkNPX0hTQ0xLX1JBVEVfMjcwME1IWkRJ
VjEwMDA6CisJCURSTV9ERUJVR19EUCgiJXM6IFZDTyByYXRlOiAlbGRcbiIsIF9fZnVuY19fLAor
CQkJCURQX1ZDT19SQVRFXzEwODAwTUhaRElWMTAwMCk7CisJCWRwX3Jlcy0+aHNjbGtfc2VsID0g
MHgwNDsKKwkJZHBfcmVzLT5kZWNfc3RhcnRfbW9kZTAgPSAweDY5OworCQlkcF9yZXMtPmRpdl9m
cmFjX3N0YXJ0MV9tb2RlMCA9IDB4MDA7CisJCWRwX3Jlcy0+ZGl2X2ZyYWNfc3RhcnQyX21vZGUw
ID0gMHg4MDsKKwkJZHBfcmVzLT5kaXZfZnJhY19zdGFydDNfbW9kZTAgPSAweDA3OworCQlkcF9y
ZXMtPmludGVnbG9vcF9nYWluMF9tb2RlMCA9IDB4M2Y7CisJCWRwX3Jlcy0+aW50ZWdsb29wX2dh
aW4xX21vZGUwID0gMHgwMDsKKwkJZHBfcmVzLT52Y29fdHVuZV9tYXAgPSAweDAwOworCQlkcF9y
ZXMtPmxvY2tfY21wMV9tb2RlMCA9IDB4MGY7CisJCWRwX3Jlcy0+bG9ja19jbXAyX21vZGUwID0g
MHgwZTsKKwkJZHBfcmVzLT5sb2NrX2NtcDNfbW9kZTAgPSAweDAwOworCQlkcF9yZXMtPnBoeV92
Y29fZGl2ID0gMHgxOworCQlkcF9yZXMtPmxvY2tfY21wX2VuID0gMHgwMDsKKwkJYnJlYWs7CisJ
Y2FzZSBEUF9WQ09fSFNDTEtfUkFURV81NDAwTUhaRElWMTAwMDoKKwkJRFJNX0RFQlVHX0RQKCIl
czogVkNPIHJhdGU6ICVsZFxuIiwgX19mdW5jX18sCisJCQkJRFBfVkNPX1JBVEVfMTA4MDBNSFpE
SVYxMDAwKTsKKwkJZHBfcmVzLT5oc2Nsa19zZWwgPSAweDAwOworCQlkcF9yZXMtPmRlY19zdGFy
dF9tb2RlMCA9IDB4OGM7CisJCWRwX3Jlcy0+ZGl2X2ZyYWNfc3RhcnQxX21vZGUwID0gMHgwMDsK
KwkJZHBfcmVzLT5kaXZfZnJhY19zdGFydDJfbW9kZTAgPSAweDAwOworCQlkcF9yZXMtPmRpdl9m
cmFjX3N0YXJ0M19tb2RlMCA9IDB4MGE7CisJCWRwX3Jlcy0+aW50ZWdsb29wX2dhaW4wX21vZGUw
ID0gMHgzZjsKKwkJZHBfcmVzLT5pbnRlZ2xvb3BfZ2FpbjFfbW9kZTAgPSAweDAwOworCQlkcF9y
ZXMtPnZjb190dW5lX21hcCA9IDB4MDA7CisJCWRwX3Jlcy0+bG9ja19jbXAxX21vZGUwID0gMHgx
ZjsKKwkJZHBfcmVzLT5sb2NrX2NtcDJfbW9kZTAgPSAweDFjOworCQlkcF9yZXMtPmxvY2tfY21w
M19tb2RlMCA9IDB4MDA7CisJCWRwX3Jlcy0+cGh5X3Zjb19kaXYgPSAweDI7CisJCWRwX3Jlcy0+
bG9ja19jbXBfZW4gPSAweDAwOworCQlicmVhazsKKwljYXNlIERQX1ZDT19IU0NMS19SQVRFXzgx
MDBNSFpESVYxMDAwOgorCQlEUk1fREVCVUdfRFAoIiVzOiBWQ08gcmF0ZTogJWxkXG4iLCBfX2Z1
bmNfXywKKwkJCQlEUF9WQ09fUkFURV84MTAwTUhaRElWMTAwMCk7CisJCWRwX3Jlcy0+aHNjbGtf
c2VsID0gMHgwMzsKKwkJZHBfcmVzLT5kZWNfc3RhcnRfbW9kZTAgPSAweDY5OworCQlkcF9yZXMt
PmRpdl9mcmFjX3N0YXJ0MV9tb2RlMCA9IDB4MDA7CisJCWRwX3Jlcy0+ZGl2X2ZyYWNfc3RhcnQy
X21vZGUwID0gMHg4MDsKKwkJZHBfcmVzLT5kaXZfZnJhY19zdGFydDNfbW9kZTAgPSAweDA3Owor
CQlkcF9yZXMtPmludGVnbG9vcF9nYWluMF9tb2RlMCA9IDB4M2Y7CisJCWRwX3Jlcy0+aW50ZWds
b29wX2dhaW4xX21vZGUwID0gMHgwMDsKKwkJZHBfcmVzLT52Y29fdHVuZV9tYXAgPSAweDAwOwor
CQlkcF9yZXMtPmxvY2tfY21wMV9tb2RlMCA9IDB4MmY7CisJCWRwX3Jlcy0+bG9ja19jbXAyX21v
ZGUwID0gMHgyYTsKKwkJZHBfcmVzLT5sb2NrX2NtcDNfbW9kZTAgPSAweDAwOworCQlkcF9yZXMt
PnBoeV92Y29fZGl2ID0gMHgwOworCQlkcF9yZXMtPmxvY2tfY21wX2VuID0gMHgwODsKKwkJYnJl
YWs7CisJZGVmYXVsdDoKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCXJldHVybiAwOworfQorCitz
dGF0aWMgaW50IGRwX2NvbmZpZ192Y29fcmF0ZV8xMG5tKHN0cnVjdCBtc21fZHBfcGxsICpwbGws
CisJCXVuc2lnbmVkIGxvbmcgcmF0ZSkKK3sKKwl1MzIgcmVzID0gMDsKKwlzdHJ1Y3QgZHBfcGxs
XzEwbm0gKmRwX3JlcyA9IHRvX2RwX3BsbF8xMG5tKHBsbCk7CisKKwlyZXMgPSBkcF92Y29fcGxs
X2luaXRfZGJfMTBubShwbGwsIHJhdGUpOworCWlmIChyZXMpIHsKKwkJRFJNX0VSUk9SKCJWQ08g
SW5pdCBEQiBmYWlsZWRcbiIpOworCQlyZXR1cm4gcmVzOworCX0KKworCWlmIChkcF9yZXMtPmxh
bmVfY250ICE9IDQpIHsKKwkJaWYgKGRwX3Jlcy0+b3JpZW50YXRpb24gPT0gT1JJRU5UQVRJT05f
Q0MyKQorCQkJUExMX1JFR19XKGRwX3Jlcy0+cGh5X2Jhc2UsIFJFR19EUF9QSFlfUERfQ1RMLCAw
eDZkKTsKKwkJZWxzZQorCQkJUExMX1JFR19XKGRwX3Jlcy0+cGh5X2Jhc2UsIFJFR19EUF9QSFlf
UERfQ1RMLCAweDc1KTsKKwl9IGVsc2UgeworCQlQTExfUkVHX1coZHBfcmVzLT5waHlfYmFzZSwg
UkVHX0RQX1BIWV9QRF9DVEwsIDB4N2QpOworCX0KKworCVBMTF9SRUdfVyhkcF9yZXMtPnBsbF9i
YXNlLCBRU0VSREVTX0NPTV9TVlNfTU9ERV9DTEtfU0VMLCAweDAxKTsKKwlQTExfUkVHX1coZHBf
cmVzLT5wbGxfYmFzZSwgUVNFUkRFU19DT01fU1lTQ0xLX0VOX1NFTCwgMHgzNyk7CisJUExMX1JF
R19XKGRwX3Jlcy0+cGxsX2Jhc2UsIFFTRVJERVNfQ09NX1NZU19DTEtfQ1RSTCwgMHgwMik7CisJ
UExMX1JFR19XKGRwX3Jlcy0+cGxsX2Jhc2UsIFFTRVJERVNfQ09NX0NMS19FTkFCTEUxLCAweDBl
KTsKKwlQTExfUkVHX1coZHBfcmVzLT5wbGxfYmFzZSwgUVNFUkRFU19DT01fU1lTQ0xLX0JVRl9F
TkFCTEUsIDB4MDYpOworCVBMTF9SRUdfVyhkcF9yZXMtPnBsbF9iYXNlLCBRU0VSREVTX0NPTV9D
TEtfU0VMLCAweDMwKTsKKwlQTExfUkVHX1coZHBfcmVzLT5wbGxfYmFzZSwgUVNFUkRFU19DT01f
Q01OX0NPTkZJRywgMHgwMik7CisKKwkvKiBEaWZmZXJlbnQgZm9yIGVhY2ggY2xvY2sgcmF0ZXMg
Ki8KKwlQTExfUkVHX1coZHBfcmVzLT5wbGxfYmFzZSwKKwkJUVNFUkRFU19DT01fSFNDTEtfU0VM
LCBkcF9yZXMtPmhzY2xrX3NlbCk7CisJUExMX1JFR19XKGRwX3Jlcy0+cGxsX2Jhc2UsCisJCVFT
RVJERVNfQ09NX0RFQ19TVEFSVF9NT0RFMCwgZHBfcmVzLT5kZWNfc3RhcnRfbW9kZTApOworCVBM
TF9SRUdfVyhkcF9yZXMtPnBsbF9iYXNlLAorCQlRU0VSREVTX0NPTV9ESVZfRlJBQ19TVEFSVDFf
TU9ERTAsIGRwX3Jlcy0+ZGl2X2ZyYWNfc3RhcnQxX21vZGUwKTsKKwlQTExfUkVHX1coZHBfcmVz
LT5wbGxfYmFzZSwKKwkJUVNFUkRFU19DT01fRElWX0ZSQUNfU1RBUlQyX01PREUwLCBkcF9yZXMt
PmRpdl9mcmFjX3N0YXJ0Ml9tb2RlMCk7CisJUExMX1JFR19XKGRwX3Jlcy0+cGxsX2Jhc2UsCisJ
CVFTRVJERVNfQ09NX0RJVl9GUkFDX1NUQVJUM19NT0RFMCwgZHBfcmVzLT5kaXZfZnJhY19zdGFy
dDNfbW9kZTApOworCVBMTF9SRUdfVyhkcF9yZXMtPnBsbF9iYXNlLAorCQlRU0VSREVTX0NPTV9J
TlRFR0xPT1BfR0FJTjBfTU9ERTAsIGRwX3Jlcy0+aW50ZWdsb29wX2dhaW4wX21vZGUwKTsKKwlQ
TExfUkVHX1coZHBfcmVzLT5wbGxfYmFzZSwKKwkJUVNFUkRFU19DT01fSU5URUdMT09QX0dBSU4x
X01PREUwLCBkcF9yZXMtPmludGVnbG9vcF9nYWluMV9tb2RlMCk7CisJUExMX1JFR19XKGRwX3Jl
cy0+cGxsX2Jhc2UsCisJCVFTRVJERVNfQ09NX1ZDT19UVU5FX01BUCwgZHBfcmVzLT52Y29fdHVu
ZV9tYXApOworCVBMTF9SRUdfVyhkcF9yZXMtPnBsbF9iYXNlLAorCQlRU0VSREVTX0NPTV9MT0NL
X0NNUDFfTU9ERTAsIGRwX3Jlcy0+bG9ja19jbXAxX21vZGUwKTsKKwlQTExfUkVHX1coZHBfcmVz
LT5wbGxfYmFzZSwKKwkJUVNFUkRFU19DT01fTE9DS19DTVAyX01PREUwLCBkcF9yZXMtPmxvY2tf
Y21wMl9tb2RlMCk7CisJUExMX1JFR19XKGRwX3Jlcy0+cGxsX2Jhc2UsCisJCVFTRVJERVNfQ09N
X0xPQ0tfQ01QM19NT0RFMCwgZHBfcmVzLT5sb2NrX2NtcDNfbW9kZTApOworCisJUExMX1JFR19X
KGRwX3Jlcy0+cGxsX2Jhc2UsIFFTRVJERVNfQ09NX0JHX1RJTUVSLCAweDBhKTsKKwlQTExfUkVH
X1coZHBfcmVzLT5wbGxfYmFzZSwgUVNFUkRFU19DT01fQ09SRUNMS19ESVZfTU9ERTAsIDB4MGEp
OworCVBMTF9SRUdfVyhkcF9yZXMtPnBsbF9iYXNlLCBRU0VSREVTX0NPTV9WQ09fVFVORV9DVFJM
LCAweDAwKTsKKwlQTExfUkVHX1coZHBfcmVzLT5wbGxfYmFzZSwgUVNFUkRFU19DT01fQklBU19F
Tl9DTEtCVUZMUl9FTiwgMHgzZik7CisJUExMX1JFR19XKGRwX3Jlcy0+cGxsX2Jhc2UsIFFTRVJE
RVNfQ09NX0NPUkVfQ0xLX0VOLCAweDFmKTsKKwlQTExfUkVHX1coZHBfcmVzLT5wbGxfYmFzZSwg
UVNFUkRFU19DT01fUExMX0lWQ08sIDB4MDcpOworCVBMTF9SRUdfVyhkcF9yZXMtPnBsbF9iYXNl
LAorCQlRU0VSREVTX0NPTV9MT0NLX0NNUF9FTiwgZHBfcmVzLT5sb2NrX2NtcF9lbik7CisJUExM
X1JFR19XKGRwX3Jlcy0+cGxsX2Jhc2UsIFFTRVJERVNfQ09NX1BMTF9DQ1RSTF9NT0RFMCwgMHgz
Nik7CisJUExMX1JFR19XKGRwX3Jlcy0+cGxsX2Jhc2UsIFFTRVJERVNfQ09NX1BMTF9SQ1RSTF9N
T0RFMCwgMHgxNik7CisJUExMX1JFR19XKGRwX3Jlcy0+cGxsX2Jhc2UsIFFTRVJERVNfQ09NX0NQ
X0NUUkxfTU9ERTAsIDB4MDYpOworCisJaWYgKGRwX3Jlcy0+b3JpZW50YXRpb24gPT0gT1JJRU5U
QVRJT05fQ0MyKQorCQlQTExfUkVHX1coZHBfcmVzLT5waHlfYmFzZSwgUkVHX0RQX1BIWV9NT0RF
LCAweDRjKTsKKwllbHNlCisJCVBMTF9SRUdfVyhkcF9yZXMtPnBoeV9iYXNlLCBSRUdfRFBfUEhZ
X01PREUsIDB4NWMpOworCisJLyogVFggTGFuZSBjb25maWd1cmF0aW9uICovCisJUExMX1JFR19X
KGRwX3Jlcy0+cGh5X2Jhc2UsCisJCQlSRUdfRFBfUEhZX1RYMF9UWDFfTEFORV9DVEwsIDB4MDUp
OworCVBMTF9SRUdfVyhkcF9yZXMtPnBoeV9iYXNlLAorCQkJUkVHX0RQX1BIWV9UWDJfVFgzX0xB
TkVfQ1RMLCAweDA1KTsKKworCS8qIFRYLTAgcmVnaXN0ZXIgY29uZmlndXJhdGlvbiAqLworCVBM
TF9SRUdfVyhkcF9yZXMtPmxuX3R4MF9iYXNlLCBSRUdfRFBfUEhZX1RYbl9UUkFOU0NFSVZFUl9C
SUFTX0VOLCAweDFhKTsKKwlQTExfUkVHX1coZHBfcmVzLT5sbl90eDBfYmFzZSwgUkVHX0RQX1BI
WV9UWG5fVk1PREVfQ1RSTDEsIDB4NDApOworCVBMTF9SRUdfVyhkcF9yZXMtPmxuX3R4MF9iYXNl
LCBSRUdfRFBfUEhZX1RYbl9QUkVfU1RBTExfTERPX0JPT1NUX0VOLCAweDMwKTsKKwlQTExfUkVH
X1coZHBfcmVzLT5sbl90eDBfYmFzZSwgUkVHX0RQX1BIWV9UWG5fSU5URVJGQUNFX1NFTEVDVCwg
MHgzZCk7CisJUExMX1JFR19XKGRwX3Jlcy0+bG5fdHgwX2Jhc2UsIFJFR19EUF9QSFlfVFhuX0NM
S0JVRl9FTkFCTEUsIDB4MGYpOworCVBMTF9SRUdfVyhkcF9yZXMtPmxuX3R4MF9iYXNlLCBSRUdf
RFBfUEhZX1RYbl9SRVNFVF9UU1lOQ19FTiwgMHgwMyk7CisJUExMX1JFR19XKGRwX3Jlcy0+bG5f
dHgwX2Jhc2UsIFJFR19EUF9QSFlfVFhuX1RSQU5fRFJWUl9FTVBfRU4sIDB4MDMpOworCVBMTF9S
RUdfVyhkcF9yZXMtPmxuX3R4MF9iYXNlLAorCQlSRUdfRFBfUEhZX1RYbl9QQVJSQVRFX1JFQ19E
RVRFQ1RfSURMRV9FTiwgMHgwMCk7CisJUExMX1JFR19XKGRwX3Jlcy0+bG5fdHgwX2Jhc2UsIFJF
R19EUF9QSFlfVFhuX1RYX0lOVEVSRkFDRV9NT0RFLCAweDAwKTsKKwlQTExfUkVHX1coZHBfcmVz
LT5sbl90eDBfYmFzZSwgUkVHX0RQX1BIWV9UWG5fVFhfQkFORCwgMHg0KTsKKworCS8qIFRYLTEg
cmVnaXN0ZXIgY29uZmlndXJhdGlvbiAqLworCVBMTF9SRUdfVyhkcF9yZXMtPmxuX3R4MV9iYXNl
LCBSRUdfRFBfUEhZX1RYbl9UUkFOU0NFSVZFUl9CSUFTX0VOLCAweDFhKTsKKwlQTExfUkVHX1co
ZHBfcmVzLT5sbl90eDFfYmFzZSwgUkVHX0RQX1BIWV9UWG5fVk1PREVfQ1RSTDEsIDB4NDApOwor
CVBMTF9SRUdfVyhkcF9yZXMtPmxuX3R4MV9iYXNlLCBSRUdfRFBfUEhZX1RYbl9QUkVfU1RBTExf
TERPX0JPT1NUX0VOLCAweDMwKTsKKwlQTExfUkVHX1coZHBfcmVzLT5sbl90eDFfYmFzZSwgUkVH
X0RQX1BIWV9UWG5fSU5URVJGQUNFX1NFTEVDVCwgMHgzZCk7CisJUExMX1JFR19XKGRwX3Jlcy0+
bG5fdHgxX2Jhc2UsIFJFR19EUF9QSFlfVFhuX0NMS0JVRl9FTkFCTEUsIDB4MGYpOworCVBMTF9S
RUdfVyhkcF9yZXMtPmxuX3R4MV9iYXNlLCBSRUdfRFBfUEhZX1RYbl9SRVNFVF9UU1lOQ19FTiwg
MHgwMyk7CisJUExMX1JFR19XKGRwX3Jlcy0+bG5fdHgxX2Jhc2UsIFJFR19EUF9QSFlfVFhuX1RS
QU5fRFJWUl9FTVBfRU4sIDB4MDMpOworCVBMTF9SRUdfVyhkcF9yZXMtPmxuX3R4MV9iYXNlLAor
CQlSRUdfRFBfUEhZX1RYbl9QQVJSQVRFX1JFQ19ERVRFQ1RfSURMRV9FTiwgMHgwMCk7CisJUExM
X1JFR19XKGRwX3Jlcy0+bG5fdHgxX2Jhc2UsIFJFR19EUF9QSFlfVFhuX1RYX0lOVEVSRkFDRV9N
T0RFLCAweDAwKTsKKwlQTExfUkVHX1coZHBfcmVzLT5sbl90eDFfYmFzZSwgUkVHX0RQX1BIWV9U
WG5fVFhfQkFORCwgMHg0KTsKKworCS8qIGRlcGVuZGVudCBvbiB0aGUgdmNvIGZyZXF1ZW5jeSAq
LworCVBMTF9SRUdfVyhkcF9yZXMtPnBoeV9iYXNlLCBSRUdfRFBfUEhZX1ZDT19ESVYsIGRwX3Jl
cy0+cGh5X3Zjb19kaXYpOworCisJcmV0dXJuIHJlczsKK30KKworc3RhdGljIGJvb2wgZHBfMTBu
bV9wbGxfbG9ja19zdGF0dXMoc3RydWN0IGRwX3BsbF8xMG5tICpkcF9yZXMpCit7CisJdTMyIHN0
YXR1czsKKwlib29sIHBsbF9sb2NrZWQ7CisKKwkvKiBwb2xsIGZvciBQTEwgbG9jayBzdGF0dXMg
Ki8KKwlpZiAocmVhZGxfcG9sbF90aW1lb3V0X2F0b21pYygoZHBfcmVzLT5wbGxfYmFzZSArCisJ
CQlRU0VSREVTX0NPTV9DX1JFQURZX1NUQVRVUyksCisJCQlzdGF0dXMsCisJCQkoKHN0YXR1cyAm
IEJJVCgwKSkgPiAwKSwKKwkJCURQX1BIWV9QTExfUE9MTF9TTEVFUF9VUywKKwkJCURQX1BIWV9Q
TExfUE9MTF9USU1FT1VUX1VTKSkgeworCQlEUk1fRVJST1IoIiVzOiBDX1JFQURZIHN0YXR1cyBp
cyBub3QgaGlnaC4gU3RhdHVzPSV4XG4iLAorCQkJCV9fZnVuY19fLCBzdGF0dXMpOworCQlwbGxf
bG9ja2VkID0gZmFsc2U7CisJfSBlbHNlIHsKKwkJcGxsX2xvY2tlZCA9IHRydWU7CisJfQorCisJ
cmV0dXJuIHBsbF9sb2NrZWQ7Cit9CisKK3N0YXRpYyBib29sIGRwXzEwbm1fcGh5X3JkeV9zdGF0
dXMoc3RydWN0IGRwX3BsbF8xMG5tICpkcF9yZXMpCit7CisJdTMyIHN0YXR1czsKKwlib29sIHBo
eV9yZWFkeSA9IHRydWU7CisKKwkvKiBwb2xsIGZvciBQSFkgcmVhZHkgc3RhdHVzICovCisJaWYg
KHJlYWRsX3BvbGxfdGltZW91dF9hdG9taWMoKGRwX3Jlcy0+cGh5X2Jhc2UgKworCQkJUkVHX0RQ
X1BIWV9TVEFUVVMpLAorCQkJc3RhdHVzLAorCQkJKChzdGF0dXMgJiAoQklUKDEpKSkgPiAwKSwK
KwkJCURQX1BIWV9QTExfUE9MTF9TTEVFUF9VUywKKwkJCURQX1BIWV9QTExfUE9MTF9USU1FT1VU
X1VTKSkgeworCQlEUk1fRVJST1IoIiVzOiBQaHlfcmVhZHkgaXMgbm90IGhpZ2guIFN0YXR1cz0l
eFxuIiwKKwkJCQlfX2Z1bmNfXywgc3RhdHVzKTsKKwkJcGh5X3JlYWR5ID0gZmFsc2U7CisJfQor
CisJcmV0dXJuIHBoeV9yZWFkeTsKK30KKworc3RhdGljIGludCBkcF9wbGxfZW5hYmxlXzEwbm0o
c3RydWN0IGNsa19odyAqaHcpCit7CisJaW50IHJjID0gMDsKKwlzdHJ1Y3QgbXNtX2RwX3BsbCAq
cGxsID0gaHdfY2xrX3RvX3BsbChodyk7CisJc3RydWN0IGRwX3BsbF8xMG5tICpkcF9yZXMgPSB0
b19kcF9wbGxfMTBubShwbGwpOworCXUzMiBiaWFzX2VuLCBkcnZyX2VuOworCisJUExMX1JFR19X
KGRwX3Jlcy0+cGh5X2Jhc2UsIFJFR19EUF9QSFlfQVVYX0NGRzIsIDB4MDQpOworCVBMTF9SRUdf
VyhkcF9yZXMtPnBoeV9iYXNlLCBSRUdfRFBfUEhZX0NGRywgMHgwMSk7CisJUExMX1JFR19XKGRw
X3Jlcy0+cGh5X2Jhc2UsIFJFR19EUF9QSFlfQ0ZHLCAweDA1KTsKKwlQTExfUkVHX1coZHBfcmVz
LT5waHlfYmFzZSwgUkVHX0RQX1BIWV9DRkcsIDB4MDEpOworCVBMTF9SRUdfVyhkcF9yZXMtPnBo
eV9iYXNlLCBSRUdfRFBfUEhZX0NGRywgMHgwOSk7CisKKwlQTExfUkVHX1coZHBfcmVzLT5wbGxf
YmFzZSwgUVNFUkRFU19DT01fUkVTRVRTTV9DTlRSTCwgMHgyMCk7CisKKwlpZiAoIWRwXzEwbm1f
cGxsX2xvY2tfc3RhdHVzKGRwX3JlcykpIHsKKwkJcmMgPSAtRUlOVkFMOworCQlnb3RvIGxvY2tf
ZXJyOworCX0KKworCVBMTF9SRUdfVyhkcF9yZXMtPnBoeV9iYXNlLCBSRUdfRFBfUEhZX0NGRywg
MHgxOSk7CisJLyogcG9sbCBmb3IgUEhZIHJlYWR5IHN0YXR1cyAqLworCWlmICghZHBfMTBubV9w
aHlfcmR5X3N0YXR1cyhkcF9yZXMpKSB7CisJCXJjID0gLUVJTlZBTDsKKwkJZ290byBsb2NrX2Vy
cjsKKwl9CisKKwlEUk1fREVCVUdfRFAoIiVzOiBQTEwgaXMgbG9ja2VkXG4iLCBfX2Z1bmNfXyk7
CisKKwlpZiAoZHBfcmVzLT5sYW5lX2NudCA9PSAxKSB7CisJCWJpYXNfZW4gPSAweDNlOworCQlk
cnZyX2VuID0gMHgxMzsKKwl9IGVsc2UgeworCQliaWFzX2VuID0gMHgzZjsKKwkJZHJ2cl9lbiA9
IDB4MTA7CisJfQorCisJaWYgKGRwX3Jlcy0+bGFuZV9jbnQgIT0gNCkgeworCQlpZiAoZHBfcmVz
LT5vcmllbnRhdGlvbiA9PSBPUklFTlRBVElPTl9DQzEpIHsKKwkJCVBMTF9SRUdfVyhkcF9yZXMt
PmxuX3R4MV9iYXNlLAorCQkJCVJFR19EUF9QSFlfVFhuX0hJR0haX0RSVlJfRU4sIGRydnJfZW4p
OworCQkJUExMX1JFR19XKGRwX3Jlcy0+bG5fdHgxX2Jhc2UsCisJCQkJUkVHX0RQX1BIWV9UWG5f
VFJBTlNDRUlWRVJfQklBU19FTiwgYmlhc19lbik7CisJCX0gZWxzZSB7CisJCQlQTExfUkVHX1co
ZHBfcmVzLT5sbl90eDBfYmFzZSwKKwkJCQlSRUdfRFBfUEhZX1RYbl9ISUdIWl9EUlZSX0VOLCBk
cnZyX2VuKTsKKwkJCVBMTF9SRUdfVyhkcF9yZXMtPmxuX3R4MF9iYXNlLAorCQkJCVJFR19EUF9Q
SFlfVFhuX1RSQU5TQ0VJVkVSX0JJQVNfRU4sIGJpYXNfZW4pOworCQl9CisJfSBlbHNlIHsKKwkJ
UExMX1JFR19XKGRwX3Jlcy0+bG5fdHgwX2Jhc2UsIFJFR19EUF9QSFlfVFhuX0hJR0haX0RSVlJf
RU4sIGRydnJfZW4pOworCQlQTExfUkVHX1coZHBfcmVzLT5sbl90eDBfYmFzZSwKKwkJCVJFR19E
UF9QSFlfVFhuX1RSQU5TQ0VJVkVSX0JJQVNfRU4sIGJpYXNfZW4pOworCQlQTExfUkVHX1coZHBf
cmVzLT5sbl90eDFfYmFzZSwgUkVHX0RQX1BIWV9UWG5fSElHSFpfRFJWUl9FTiwgZHJ2cl9lbik7
CisJCVBMTF9SRUdfVyhkcF9yZXMtPmxuX3R4MV9iYXNlLAorCQkJUkVHX0RQX1BIWV9UWG5fVFJB
TlNDRUlWRVJfQklBU19FTiwgYmlhc19lbik7CisJfQorCisJUExMX1JFR19XKGRwX3Jlcy0+bG5f
dHgwX2Jhc2UsIFJFR19EUF9QSFlfVFhuX1RYX1BPTF9JTlYsIDB4MGEpOworCVBMTF9SRUdfVyhk
cF9yZXMtPmxuX3R4MV9iYXNlLCBSRUdfRFBfUEhZX1RYbl9UWF9QT0xfSU5WLCAweDBhKTsKKwlQ
TExfUkVHX1coZHBfcmVzLT5waHlfYmFzZSwgUkVHX0RQX1BIWV9DRkcsIDB4MTgpOworCXVkZWxh
eSgyMDAwKTsKKworCVBMTF9SRUdfVyhkcF9yZXMtPnBoeV9iYXNlLCBSRUdfRFBfUEhZX0NGRywg
MHgxOSk7CisKKwkvKiBwb2xsIGZvciBQSFkgcmVhZHkgc3RhdHVzICovCisJaWYgKCFkcF8xMG5t
X3BoeV9yZHlfc3RhdHVzKGRwX3JlcykpIHsKKwkJcmMgPSAtRUlOVkFMOworCQlnb3RvIGxvY2tf
ZXJyOworCX0KKworCVBMTF9SRUdfVyhkcF9yZXMtPmxuX3R4MF9iYXNlLCBSRUdfRFBfUEhZX1RY
bl9UWF9EUlZfTFZMLCAweDM4KTsKKwlQTExfUkVHX1coZHBfcmVzLT5sbl90eDFfYmFzZSwgUkVH
X0RQX1BIWV9UWG5fVFhfRFJWX0xWTCwgMHgzOCk7CisJUExMX1JFR19XKGRwX3Jlcy0+bG5fdHgw
X2Jhc2UsIFJFR19EUF9QSFlfVFhuX1RYX0VNUF9QT1NUMV9MVkwsIDB4MjApOworCVBMTF9SRUdf
VyhkcF9yZXMtPmxuX3R4MV9iYXNlLCBSRUdfRFBfUEhZX1RYbl9UWF9FTVBfUE9TVDFfTFZMLCAw
eDIwKTsKKwlQTExfUkVHX1coZHBfcmVzLT5sbl90eDBfYmFzZSwgUkVHX0RQX1BIWV9UWG5fUkVT
X0NPREVfTEFORV9PRkZTRVRfVFgsIDB4MDYpOworCVBMTF9SRUdfVyhkcF9yZXMtPmxuX3R4MV9i
YXNlLCBSRUdfRFBfUEhZX1RYbl9SRVNfQ09ERV9MQU5FX09GRlNFVF9UWCwgMHgwNik7CisJUExM
X1JFR19XKGRwX3Jlcy0+bG5fdHgwX2Jhc2UsIFJFR19EUF9QSFlfVFhuX1JFU19DT0RFX0xBTkVf
T0ZGU0VUX1JYLCAweDA3KTsKKwlQTExfUkVHX1coZHBfcmVzLT5sbl90eDFfYmFzZSwgUkVHX0RQ
X1BIWV9UWG5fUkVTX0NPREVfTEFORV9PRkZTRVRfUlgsIDB4MDcpOworCitsb2NrX2VycjoKKwly
ZXR1cm4gcmM7Cit9CisKK3N0YXRpYyBpbnQgZHBfcGxsX2Rpc2FibGVfMTBubShzdHJ1Y3QgY2xr
X2h3ICpodykKK3sKKwlpbnQgcmMgPSAwOworCXN0cnVjdCBtc21fZHBfcGxsICpwbGwgPSBod19j
bGtfdG9fcGxsKGh3KTsKKwlzdHJ1Y3QgZHBfcGxsXzEwbm0gKmRwX3JlcyA9IHRvX2RwX3BsbF8x
MG5tKHBsbCk7CisKKwkvKiBBc3NlcnQgRFAgUEhZIHBvd2VyIGRvd24gKi8KKwlQTExfUkVHX1co
ZHBfcmVzLT5waHlfYmFzZSwgUkVHX0RQX1BIWV9QRF9DVEwsIDB4Mik7CisKKwlyZXR1cm4gcmM7
Cit9CisKKworaW50IGRwX3Zjb19wcmVwYXJlXzEwbm0oc3RydWN0IGNsa19odyAqaHcpCit7CisJ
aW50IHJjID0gMDsKKwlzdHJ1Y3QgbXNtX2RwX3BsbCAqcGxsID0gaHdfY2xrX3RvX3BsbChodyk7
CisJc3RydWN0IGRwX3BsbF8xMG5tICpkcF9yZXMgPSB0b19kcF9wbGxfMTBubShwbGwpOworCisJ
RFJNX0RFQlVHX0RQKCIlczogcmF0ZSA9ICVsZFxuIiwgX19mdW5jX18sIHBsbC0+cmF0ZSk7CisJ
aWYgKChkcF9yZXMtPnZjb19jYWNoZWRfcmF0ZSAhPSAwKQorCQkmJiAoZHBfcmVzLT52Y29fY2Fj
aGVkX3JhdGUgPT0gcGxsLT5yYXRlKSkgeworCQlyYyA9IGRwX3Zjb19zZXRfcmF0ZV8xMG5tKGh3
LAorCQkJZHBfcmVzLT52Y29fY2FjaGVkX3JhdGUsIGRwX3Jlcy0+dmNvX2NhY2hlZF9yYXRlKTsK
KwkJaWYgKHJjKSB7CisJCQlEUk1fRVJST1IoImluZGV4PSVkIHZjb19zZXRfcmF0ZSBmYWlsZWQu
IHJjPSVkXG4iLAorCQkJCXJjLCBkcF9yZXMtPmluZGV4KTsKKwkJCWdvdG8gZXJyb3I7CisJCX0K
Kwl9CisKKwlyYyA9IGRwX3BsbF9lbmFibGVfMTBubShodyk7CisJaWYgKHJjKSB7CisJCURSTV9F
UlJPUigibmR4PSVkIGZhaWxlZCB0byBlbmFibGUgZHAgcGxsXG4iLAorCQkJCQlkcF9yZXMtPmlu
ZGV4KTsKKwkJZ290byBlcnJvcjsKKwl9CisKKwlwbGwtPnBsbF9vbiA9IHRydWU7CitlcnJvcjoK
KwlyZXR1cm4gcmM7Cit9CisKK3ZvaWQgZHBfdmNvX3VucHJlcGFyZV8xMG5tKHN0cnVjdCBjbGtf
aHcgKmh3KQoreworCXN0cnVjdCBtc21fZHBfcGxsICpwbGwgPSBod19jbGtfdG9fcGxsKGh3KTsK
KwlzdHJ1Y3QgZHBfcGxsXzEwbm0gKmRwX3JlcyA9IHRvX2RwX3BsbF8xMG5tKHBsbCk7CisKKwlp
ZiAoIWRwX3JlcykgeworCQlEUk1fRVJST1IoIkludmFsaWQgaW5wdXQgcGFyYW1ldGVyXG4iKTsK
KwkJcmV0dXJuOworCX0KKworCWlmICghcGxsLT5wbGxfb24pIHsKKwkJRFJNX0VSUk9SKCJwbGwg
cmVzb3VyY2UgY2FuJ3QgYmUgZW5hYmxlZFxuIik7CisJCXJldHVybjsKKwl9CisJZHBfcmVzLT52
Y29fY2FjaGVkX3JhdGUgPSBwbGwtPnJhdGU7CisJZHBfcGxsX2Rpc2FibGVfMTBubShodyk7CisK
KwlwbGwtPnBsbF9vbiA9IGZhbHNlOworfQorCitpbnQgZHBfdmNvX3NldF9yYXRlXzEwbm0oc3Ry
dWN0IGNsa19odyAqaHcsIHVuc2lnbmVkIGxvbmcgcmF0ZSwKKwkJCQkJdW5zaWduZWQgbG9uZyBw
YXJlbnRfcmF0ZSkKK3sKKwlzdHJ1Y3QgbXNtX2RwX3BsbCAqcGxsID0gaHdfY2xrX3RvX3BsbCho
dyk7CisJaW50IHJjOworCisJRFJNX0RFQlVHX0RQKCJEUCBsYW5lIENMSyByYXRlPSVsZFxuIiwg
cmF0ZSk7CisKKwlyYyA9IGRwX2NvbmZpZ192Y29fcmF0ZV8xMG5tKHBsbCwgcmF0ZSk7CisJaWYg
KHJjKQorCQlEUk1fRVJST1IoIiVzOiBGYWlsZWQgdG8gc2V0IGNsayByYXRlXG4iLCBfX2Z1bmNf
Xyk7CisKKwlwbGwtPnJhdGUgPSByYXRlOworCisJcmV0dXJuIDA7Cit9CisKK3Vuc2lnbmVkIGxv
bmcgZHBfdmNvX3JlY2FsY19yYXRlXzEwbm0oc3RydWN0IGNsa19odyAqaHcsCisJCQkJCXVuc2ln
bmVkIGxvbmcgcGFyZW50X3JhdGUpCit7CisJc3RydWN0IG1zbV9kcF9wbGwgKnBsbCA9IGh3X2Ns
a190b19wbGwoaHcpOworCXN0cnVjdCBkcF9wbGxfMTBubSAqZHBfcmVzID0gdG9fZHBfcGxsXzEw
bm0ocGxsKTsKKwl1MzIgZGl2LCBoc2Nsa19kaXYsIGxpbmtfY2xrX2RpdiA9IDA7CisJdTY0IHZj
b19yYXRlOworCisJZGl2ID0gUExMX1JFR19SKGRwX3Jlcy0+cGxsX2Jhc2UsIFFTRVJERVNfQ09N
X0hTQ0xLX1NFTCk7CisJZGl2ICY9IDB4MGY7CisKKwlpZiAoZGl2ID09IDEyKQorCQloc2Nsa19k
aXYgPSA2OyAvKiBEZWZhdWx0ICovCisJZWxzZSBpZiAoZGl2ID09IDQpCisJCWhzY2xrX2RpdiA9
IDQ7CisJZWxzZSBpZiAoZGl2ID09IDApCisJCWhzY2xrX2RpdiA9IDI7CisJZWxzZSBpZiAoZGl2
ID09IDMpCisJCWhzY2xrX2RpdiA9IDE7CisJZWxzZSB7CisJCURSTV9ERUJVR19EUCgidW5rbm93
biBkaXZpZGVyLiBmb3JjaW5nIHRvIGRlZmF1bHRcbiIpOworCQloc2Nsa19kaXYgPSA1OworCX0K
KworCWRpdiA9IFBMTF9SRUdfUihkcF9yZXMtPnBoeV9iYXNlLCBSRUdfRFBfUEhZX0FVWF9DRkcy
KTsKKwlkaXYgPj49IDI7CisKKwlpZiAoKGRpdiAmIDB4MykgPT0gMCkKKwkJbGlua19jbGtfZGl2
ID0gNTsKKwllbHNlIGlmICgoZGl2ICYgMHgzKSA9PSAxKQorCQlsaW5rX2Nsa19kaXYgPSAxMDsK
KwllbHNlIGlmICgoZGl2ICYgMHgzKSA9PSAyKQorCQlsaW5rX2Nsa19kaXYgPSAyMDsKKwllbHNl
CisJCURSTV9FUlJPUigiJXM6IHVuc3VwcG9ydGVkIGRpdi4gUGh5X21vZGU6ICVkXG4iLCBfX2Z1
bmNfXywgZGl2KTsKKworCWlmIChsaW5rX2Nsa19kaXYgPT0gMjApIHsKKwkJdmNvX3JhdGUgPSBE
UF9WQ09fSFNDTEtfUkFURV8yNzAwTUhaRElWMTAwMDsKKwl9IGVsc2UgeworCQlpZiAoaHNjbGtf
ZGl2ID09IDYpCisJCQl2Y29fcmF0ZSA9IERQX1ZDT19IU0NMS19SQVRFXzE2MjBNSFpESVYxMDAw
OworCQllbHNlIGlmIChoc2Nsa19kaXYgPT0gNCkKKwkJCXZjb19yYXRlID0gRFBfVkNPX0hTQ0xL
X1JBVEVfMjcwME1IWkRJVjEwMDA7CisJCWVsc2UgaWYgKGhzY2xrX2RpdiA9PSAyKQorCQkJdmNv
X3JhdGUgPSBEUF9WQ09fSFNDTEtfUkFURV81NDAwTUhaRElWMTAwMDsKKwkJZWxzZQorCQkJdmNv
X3JhdGUgPSBEUF9WQ09fSFNDTEtfUkFURV84MTAwTUhaRElWMTAwMDsKKwl9CisKKwlEUk1fREVC
VUdfRFAoInJldHVybmluZyB2Y28gcmF0ZSA9ICVsdVxuIiwgKHVuc2lnbmVkIGxvbmcpdmNvX3Jh
dGUpOworCisJZHBfcmVzLT52Y29fY2FjaGVkX3JhdGUgPSBwbGwtPnJhdGUgPSB2Y29fcmF0ZTsK
KwlyZXR1cm4gKHVuc2lnbmVkIGxvbmcpdmNvX3JhdGU7Cit9CisKK2xvbmcgZHBfdmNvX3JvdW5k
X3JhdGVfMTBubShzdHJ1Y3QgY2xrX2h3ICpodywgdW5zaWduZWQgbG9uZyByYXRlLAorCQkJdW5z
aWduZWQgbG9uZyAqcGFyZW50X3JhdGUpCit7CisJdW5zaWduZWQgbG9uZyBycmF0ZSA9IHJhdGU7
CisJc3RydWN0IG1zbV9kcF9wbGwgKnBsbCA9IGh3X2Nsa190b19wbGwoaHcpOworCisJaWYgKHJh
dGUgPD0gcGxsLT5taW5fcmF0ZSkKKwkJcnJhdGUgPSBwbGwtPm1pbl9yYXRlOworCWVsc2UgaWYg
KHJhdGUgPD0gRFBfVkNPX0hTQ0xLX1JBVEVfMjcwME1IWkRJVjEwMDApCisJCXJyYXRlID0gRFBf
VkNPX0hTQ0xLX1JBVEVfMjcwME1IWkRJVjEwMDA7CisJZWxzZSBpZiAocmF0ZSA8PSBEUF9WQ09f
SFNDTEtfUkFURV81NDAwTUhaRElWMTAwMCkKKwkJcnJhdGUgPSBEUF9WQ09fSFNDTEtfUkFURV81
NDAwTUhaRElWMTAwMDsKKwllbHNlCisJCXJyYXRlID0gcGxsLT5tYXhfcmF0ZTsKKworCURSTV9E
RUJVR19EUCgiJXM6IHJyYXRlPSVsZFxuIiwgX19mdW5jX18sIHJyYXRlKTsKKworCSpwYXJlbnRf
cmF0ZSA9IHJyYXRlOworCXJldHVybiBycmF0ZTsKK30KKwotLSAKVGhlIFF1YWxjb21tIElubm92
YXRpb24gQ2VudGVyLCBJbmMuIGlzIGEgbWVtYmVyIG9mIHRoZSBDb2RlIEF1cm9yYSBGb3J1bSwK
YSBMaW51eCBGb3VuZGF0aW9uIENvbGxhYm9yYXRpdmUgUHJvamVjdAoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApk
cmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Au
b3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVs
