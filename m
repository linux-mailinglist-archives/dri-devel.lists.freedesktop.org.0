Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 755C2C01FB
	for <lists+dri-devel@lfdr.de>; Fri, 27 Sep 2019 11:13:24 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E78036EED1;
	Fri, 27 Sep 2019 09:13:21 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 85C056EEC6
 for <dri-devel@lists.freedesktop.org>; Fri, 27 Sep 2019 09:13:05 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 0C898AFE1;
 Fri, 27 Sep 2019 09:13:04 +0000 (UTC)
From: Thomas Zimmermann <tzimmermann@suse.de>
To: airlied@linux.ie,
	daniel@ffwll.ch,
	kraxel@redhat.com,
	sam@ravnborg.org
Subject: [PATCH v3 4/7] drm/mgag200: Move cursor-image update to
 mgag200_show_cursor()
Date: Fri, 27 Sep 2019 11:12:58 +0200
Message-Id: <20190927091301.10574-5-tzimmermann@suse.de>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190927091301.10574-1-tzimmermann@suse.de>
References: <20190927091301.10574-1-tzimmermann@suse.de>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Thomas Zimmermann <tzimmermann@suse.de>, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

U2VwYXJhdGluZyB0aGUgbWFuYWdlbWVudCBvZiBidWZmZXIgb2JqZWN0cyBmcm9tIHVwZGF0aW5n
IHRoZSBoYXJkd2FyZQpjdXJzb3IgYnVmZmVyIGdpdmVzIHRoZSBjb2RlIG1vcmUgc3RydWN0dXJl
LiBXaGlsZSBkb2luZyB0aGlzLCB3ZSBjYW4KZnVydGhlciBzcGxpdCB0aGUgaW1hZ2UtdXBkYXRl
IGNvZGUgaW50byBjb2RlIGZvciB3cml0aW5nIHRoZSBidWZmZXIsCnNldHRpbmcgdGhlIGJhc2Ug
c2Nhbi1vdXQgYWRkcmVzcywgYW5kIGVuYWJsaW5nIHRoZSBjdXJzb3IuIFRoZSBmaXJzdAp0d28g
b3BlcmF0aW9ucyBhcmUgaW4gZGVkaWNhdGVkIGZ1bmN0aW9ucyB1cGRhdGUoKSBhbmQgc2V0X2Jh
c2UoKS4KClNpZ25lZC1vZmYtYnk6IFRob21hcyBaaW1tZXJtYW5uIDx0emltbWVybWFubkBzdXNl
LmRlPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9tZ2FnMjAwL21nYWcyMDBfY3Vyc29yLmMgfCAyMjAg
KysrKysrKysrKysrKy0tLS0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCAxMjUgaW5zZXJ0aW9ucygr
KSwgOTUgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21nYWcyMDAv
bWdhZzIwMF9jdXJzb3IuYyBiL2RyaXZlcnMvZ3B1L2RybS9tZ2FnMjAwL21nYWcyMDBfY3Vyc29y
LmMKaW5kZXggNjIxOTYwNzIzYTNhLi41ZmM0N2FiMGU4ZmQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9tZ2FnMjAwL21nYWcyMDBfY3Vyc29yLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL21n
YWcyMDAvbWdhZzIwMF9jdXJzb3IuYwpAQCAtMTIsNiArMTIsMTI3IEBACiBzdGF0aWMgYm9vbCB3
YXJuX3RyYW5zcGFyZW50ID0gdHJ1ZTsKIHN0YXRpYyBib29sIHdhcm5fcGFsZXR0ZSA9IHRydWU7
CiAKK3N0YXRpYyBpbnQgbWdhZzIwMF9jdXJzb3JfdXBkYXRlKHN0cnVjdCBtZ2FfZGV2aWNlICpt
ZGV2LCB2b2lkICpkc3QsIHZvaWQgKnNyYywKKwkJCQkgdW5zaWduZWQgaW50IHdpZHRoLCB1bnNp
Z25lZCBpbnQgaGVpZ2h0KQoreworCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBtZGV2LT5kZXY7
CisJdW5zaWduZWQgaW50IGksIHJvdywgY29sOworCXVpbnQzMl90IGNvbG91cl9zZXRbMTZdOwor
CXVpbnQzMl90ICpuZXh0X3NwYWNlID0gJmNvbG91cl9zZXRbMF07CisJdWludDMyX3QgKnBhbGV0
dGVfaXRlcjsKKwl1aW50MzJfdCB0aGlzX2NvbG91cjsKKwlib29sIGZvdW5kID0gZmFsc2U7CisJ
aW50IGNvbG91cl9jb3VudCA9IDA7CisJdTggcmVnX2luZGV4OworCXU4IHRoaXNfcm93WzQ4XTsK
KworCW1lbXNldCgmY29sb3VyX3NldFswXSwgMCwgc2l6ZW9mKHVpbnQzMl90KSoxNik7CisJLyog
d2lkdGgqaGVpZ2h0KjQgPSAxNjM4NCAqLworCWZvciAoaSA9IDA7IGkgPCAxNjM4NDsgaSArPSA0
KSB7CisJCXRoaXNfY29sb3VyID0gaW9yZWFkMzIoc3JjICsgaSk7CisJCS8qIE5vIHRyYW5zcGFy
ZW5jeSAqLworCQlpZiAodGhpc19jb2xvdXI+PjI0ICE9IDB4ZmYgJiYKKwkJCXRoaXNfY29sb3Vy
Pj4yNCAhPSAweDApIHsKKwkJCWlmICh3YXJuX3RyYW5zcGFyZW50KSB7CisJCQkJZGV2X2luZm8o
JmRldi0+cGRldi0+ZGV2LCAiVmlkZW8gY2FyZCBkb2Vzbid0IHN1cHBvcnQgY3Vyc29ycyB3aXRo
IHBhcnRpYWwgdHJhbnNwYXJlbmN5LlxuIik7CisJCQkJZGV2X2luZm8oJmRldi0+cGRldi0+ZGV2
LCAiTm90IGVuYWJsaW5nIGhhcmR3YXJlIGN1cnNvci5cbiIpOworCQkJCXdhcm5fdHJhbnNwYXJl
bnQgPSBmYWxzZTsgLyogT25seSB0ZWxsIHRoZSB1c2VyIG9uY2UuICovCisJCQl9CisJCQlyZXR1
cm4gLUVJTlZBTDsKKwkJfQorCQkvKiBEb24ndCBuZWVkIHRvIHN0b3JlIHRyYW5zcGFyZW50IHBp
eGVscyBhcyBjb2xvdXJzICovCisJCWlmICh0aGlzX2NvbG91cj4+MjQgPT0gMHgwKQorCQkJY29u
dGludWU7CisJCWZvdW5kID0gZmFsc2U7CisJCWZvciAocGFsZXR0ZV9pdGVyID0gJmNvbG91cl9z
ZXRbMF07IHBhbGV0dGVfaXRlciAhPSBuZXh0X3NwYWNlOyBwYWxldHRlX2l0ZXIrKykgeworCQkJ
aWYgKCpwYWxldHRlX2l0ZXIgPT0gdGhpc19jb2xvdXIpIHsKKwkJCQlmb3VuZCA9IHRydWU7CisJ
CQkJYnJlYWs7CisJCQl9CisJCX0KKwkJaWYgKGZvdW5kKQorCQkJY29udGludWU7CisJCS8qIFdl
IG9ubHkgc3VwcG9ydCA0Yml0IHBhbGV0dGVkIGN1cnNvcnMgKi8KKwkJaWYgKGNvbG91cl9jb3Vu
dCA+PSAxNikgeworCQkJaWYgKHdhcm5fcGFsZXR0ZSkgeworCQkJCWRldl9pbmZvKCZkZXYtPnBk
ZXYtPmRldiwgIlZpZGVvIGNhcmQgb25seSBzdXBwb3J0cyBjdXJzb3JzIHdpdGggdXAgdG8gMTYg
Y29sb3Vycy5cbiIpOworCQkJCWRldl9pbmZvKCZkZXYtPnBkZXYtPmRldiwgIk5vdCBlbmFibGlu
ZyBoYXJkd2FyZSBjdXJzb3IuXG4iKTsKKwkJCQl3YXJuX3BhbGV0dGUgPSBmYWxzZTsgLyogT25s
eSB0ZWxsIHRoZSB1c2VyIG9uY2UuICovCisJCQl9CisJCQlyZXR1cm4gLUVJTlZBTDsKKwkJfQor
CQkqbmV4dF9zcGFjZSA9IHRoaXNfY29sb3VyOworCQluZXh0X3NwYWNlKys7CisJCWNvbG91cl9j
b3VudCsrOworCX0KKworCS8qIFByb2dyYW0gY29sb3VycyBmcm9tIGN1cnNvciBpY29uIGludG8g
cGFsZXR0ZSAqLworCWZvciAoaSA9IDA7IGkgPCBjb2xvdXJfY291bnQ7IGkrKykgeworCQlpZiAo
aSA8PSAyKQorCQkJcmVnX2luZGV4ID0gMHg4ICsgaSoweDQ7CisJCWVsc2UKKwkJCXJlZ19pbmRl
eCA9IDB4NjAgKyBpKjB4MzsKKwkJV1JFR19EQUMocmVnX2luZGV4LCBjb2xvdXJfc2V0W2ldICYg
MHhmZik7CisJCVdSRUdfREFDKHJlZ19pbmRleCsxLCBjb2xvdXJfc2V0W2ldPj44ICYgMHhmZik7
CisJCVdSRUdfREFDKHJlZ19pbmRleCsyLCBjb2xvdXJfc2V0W2ldPj4xNiAmIDB4ZmYpOworCQlC
VUdfT04oKGNvbG91cl9zZXRbaV0+PjI0ICYgMHhmZikgIT0gMHhmZik7CisJfQorCisJLyogbm93
IHdyaXRlIGNvbG91ciBpbmRpY2VzIGludG8gaGFyZHdhcmUgY3Vyc29yIGJ1ZmZlciAqLworCWZv
ciAocm93ID0gMDsgcm93IDwgNjQ7IHJvdysrKSB7CisJCW1lbXNldCgmdGhpc19yb3dbMF0sIDAs
IDQ4KTsKKwkJZm9yIChjb2wgPSAwOyBjb2wgPCA2NDsgY29sKyspIHsKKwkJCXRoaXNfY29sb3Vy
ID0gaW9yZWFkMzIoc3JjICsgNCooY29sICsgNjQqcm93KSk7CisJCQkvKiB3cml0ZSB0cmFuc3Bh
cmVudCBwaXhlbHMgKi8KKwkJCWlmICh0aGlzX2NvbG91cj4+MjQgPT0gMHgwKSB7CisJCQkJdGhp
c19yb3dbNDcgLSBjb2wvOF0gfD0gMHg4MD4+KGNvbCU4KTsKKwkJCQljb250aW51ZTsKKwkJCX0K
KworCQkJLyogd3JpdGUgY29sb3VyIGluZGV4IGhlcmUgKi8KKwkJCWZvciAoaSA9IDA7IGkgPCBj
b2xvdXJfY291bnQ7IGkrKykgeworCQkJCWlmIChjb2xvdXJfc2V0W2ldID09IHRoaXNfY29sb3Vy
KSB7CisJCQkJCWlmIChjb2wgJSAyKQorCQkJCQkJdGhpc19yb3dbY29sLzJdIHw9IGk8PDQ7CisJ
CQkJCWVsc2UKKwkJCQkJCXRoaXNfcm93W2NvbC8yXSB8PSBpOworCQkJCQlicmVhazsKKwkJCQl9
CisJCQl9CisJCX0KKwkJbWVtY3B5X3RvaW8oZHN0ICsgcm93KjQ4LCAmdGhpc19yb3dbMF0sIDQ4
KTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgbWdhZzIwMF9jdXJzb3Jfc2V0
X2Jhc2Uoc3RydWN0IG1nYV9kZXZpY2UgKm1kZXYsIHU2NCBhZGRyZXNzKQoreworCXU4IGFkZHJs
ID0gKGFkZHJlc3MgPj4gMTApICYgMHhmZjsKKwl1OCBhZGRyaCA9IChhZGRyZXNzID4+IDE4KSAm
IDB4M2Y7CisKKwkvKiBQcm9ncmFtIGdwdSBhZGRyZXNzIG9mIGN1cnNvciBidWZmZXIgKi8KKwlX
UkVHX0RBQyhNR0ExMDY0X0NVUlNPUl9CQVNFX0FEUl9MT1csIGFkZHJsKTsKKwlXUkVHX0RBQyhN
R0ExMDY0X0NVUlNPUl9CQVNFX0FEUl9ISSwgYWRkcmgpOworfQorCitzdGF0aWMgaW50IG1nYWcy
MDBfc2hvd19jdXJzb3Ioc3RydWN0IG1nYV9kZXZpY2UgKm1kZXYsIHZvaWQgKmRzdCwgdm9pZCAq
c3JjLAorCQkJICAgICAgIHVuc2lnbmVkIGludCB3aWR0aCwgdW5zaWduZWQgaW50IGhlaWdodCwK
KwkJCSAgICAgICB1NjQgZHN0X2dwdSkKK3sKKwlpbnQgcmV0OworCisJcmV0ID0gbWdhZzIwMF9j
dXJzb3JfdXBkYXRlKG1kZXYsIGRzdCwgc3JjLCB3aWR0aCwgaGVpZ2h0KTsKKwlpZiAocmV0KQor
CQlyZXR1cm4gcmV0OworCW1nYWcyMDBfY3Vyc29yX3NldF9iYXNlKG1kZXYsIGRzdF9ncHUpOwor
CisJLyogQWRqdXN0IGN1cnNvciBjb250cm9sIHJlZ2lzdGVyIHRvIHR1cm4gb24gdGhlIGN1cnNv
ciAqLworCVdSRUdfREFDKE1HQTEwNjRfQ1VSU09SX0NUTCwgNCk7IC8qIDE2LWNvbG91ciBwYWxs
ZXRpemVkIGN1cnNvciBtb2RlICovCisKKwlyZXR1cm4gMDsKK30KKwogLyoKICAqIEhpZGUgdGhl
IGN1cnNvciBvZmYgc2NyZWVuLiBXZSBjYW4ndCBkaXNhYmxlIHRoZSBjdXJzb3IgaGFyZHdhcmUg
YmVjYXVzZQogICogaXQgdGFrZXMgdG9vIGxvbmcgdG8gcmUtYWN0aXZhdGUgYW5kIGNhdXNlcyBt
b21lbnRhcnkgY29ycnVwdGlvbi4KQEAgLTgyLDE5ICsyMDMsMTAgQEAgaW50IG1nYWcyMDBfY3J0
Y19jdXJzb3Jfc2V0KHN0cnVjdCBkcm1fY3J0YyAqY3J0Yywgc3RydWN0IGRybV9maWxlICpmaWxl
X3ByaXYsCiAJc3RydWN0IGRybV9nZW1fdnJhbV9vYmplY3QgKnBpeGVsc19uZXh0OwogCXN0cnVj
dCBkcm1fZ2VtX29iamVjdCAqb2JqOwogCXN0cnVjdCBkcm1fZ2VtX3ZyYW1fb2JqZWN0ICpnYm8g
PSBOVUxMOwotCWludCByZXQgPSAwOworCWludCByZXQ7CiAJdTggKnNyYywgKmRzdDsKLQl1bnNp
Z25lZCBpbnQgaSwgcm93LCBjb2w7Ci0JdWludDMyX3QgY29sb3VyX3NldFsxNl07Ci0JdWludDMy
X3QgKm5leHRfc3BhY2UgPSAmY29sb3VyX3NldFswXTsKLQl1aW50MzJfdCAqcGFsZXR0ZV9pdGVy
OwotCXVpbnQzMl90IHRoaXNfY29sb3VyOwotCWJvb2wgZm91bmQgPSBmYWxzZTsKLQlpbnQgY29s
b3VyX2NvdW50ID0gMDsKIAlzNjQgZ3B1X2FkZHI7CiAJdTY0IGRzdF9ncHU7Ci0JdTggcmVnX2lu
ZGV4OwotCXU4IHRoaXNfcm93WzQ4XTsKIAogCWlmICghcGl4ZWxzXzEgfHwgIXBpeGVsc18yKSB7
CiAJCVdSRUc4KE1HQV9DVVJQT1NYTCwgMCk7CkBAIC0xNTksOTEgKzI3MSw5IEBAIGludCBtZ2Fn
MjAwX2NydGNfY3Vyc29yX3NldChzdHJ1Y3QgZHJtX2NydGMgKmNydGMsIHN0cnVjdCBkcm1fZmls
ZSAqZmlsZV9wcml2LAogCX0KIAlkc3RfZ3B1ID0gKHU2NClncHVfYWRkcjsKIAotCW1lbXNldCgm
Y29sb3VyX3NldFswXSwgMCwgc2l6ZW9mKHVpbnQzMl90KSoxNik7Ci0JLyogd2lkdGgqaGVpZ2h0
KjQgPSAxNjM4NCAqLwotCWZvciAoaSA9IDA7IGkgPCAxNjM4NDsgaSArPSA0KSB7Ci0JCXRoaXNf
Y29sb3VyID0gaW9yZWFkMzIoc3JjICsgaSk7Ci0JCS8qIE5vIHRyYW5zcGFyZW5jeSAqLwotCQlp
ZiAodGhpc19jb2xvdXI+PjI0ICE9IDB4ZmYgJiYKLQkJCXRoaXNfY29sb3VyPj4yNCAhPSAweDAp
IHsKLQkJCWlmICh3YXJuX3RyYW5zcGFyZW50KSB7Ci0JCQkJZGV2X2luZm8oJmRldi0+cGRldi0+
ZGV2LCAiVmlkZW8gY2FyZCBkb2Vzbid0IHN1cHBvcnQgY3Vyc29ycyB3aXRoIHBhcnRpYWwgdHJh
bnNwYXJlbmN5LlxuIik7Ci0JCQkJZGV2X2luZm8oJmRldi0+cGRldi0+ZGV2LCAiTm90IGVuYWJs
aW5nIGhhcmR3YXJlIGN1cnNvci5cbiIpOwotCQkJCXdhcm5fdHJhbnNwYXJlbnQgPSBmYWxzZTsg
LyogT25seSB0ZWxsIHRoZSB1c2VyIG9uY2UuICovCi0JCQl9Ci0JCQlyZXQgPSAtRUlOVkFMOwot
CQkJZ290byBlcnJfZHJtX2dlbV92cmFtX2t1bm1hcF9kc3Q7Ci0JCX0KLQkJLyogRG9uJ3QgbmVl
ZCB0byBzdG9yZSB0cmFuc3BhcmVudCBwaXhlbHMgYXMgY29sb3VycyAqLwotCQlpZiAodGhpc19j
b2xvdXI+PjI0ID09IDB4MCkKLQkJCWNvbnRpbnVlOwotCQlmb3VuZCA9IGZhbHNlOwotCQlmb3Ig
KHBhbGV0dGVfaXRlciA9ICZjb2xvdXJfc2V0WzBdOyBwYWxldHRlX2l0ZXIgIT0gbmV4dF9zcGFj
ZTsgcGFsZXR0ZV9pdGVyKyspIHsKLQkJCWlmICgqcGFsZXR0ZV9pdGVyID09IHRoaXNfY29sb3Vy
KSB7Ci0JCQkJZm91bmQgPSB0cnVlOwotCQkJCWJyZWFrOwotCQkJfQotCQl9Ci0JCWlmIChmb3Vu
ZCkKLQkJCWNvbnRpbnVlOwotCQkvKiBXZSBvbmx5IHN1cHBvcnQgNGJpdCBwYWxldHRlZCBjdXJz
b3JzICovCi0JCWlmIChjb2xvdXJfY291bnQgPj0gMTYpIHsKLQkJCWlmICh3YXJuX3BhbGV0dGUp
IHsKLQkJCQlkZXZfaW5mbygmZGV2LT5wZGV2LT5kZXYsICJWaWRlbyBjYXJkIG9ubHkgc3VwcG9y
dHMgY3Vyc29ycyB3aXRoIHVwIHRvIDE2IGNvbG91cnMuXG4iKTsKLQkJCQlkZXZfaW5mbygmZGV2
LT5wZGV2LT5kZXYsICJOb3QgZW5hYmxpbmcgaGFyZHdhcmUgY3Vyc29yLlxuIik7Ci0JCQkJd2Fy
bl9wYWxldHRlID0gZmFsc2U7IC8qIE9ubHkgdGVsbCB0aGUgdXNlciBvbmNlLiAqLwotCQkJfQot
CQkJcmV0ID0gLUVJTlZBTDsKLQkJCWdvdG8gZXJyX2RybV9nZW1fdnJhbV9rdW5tYXBfZHN0Owot
CQl9Ci0JCSpuZXh0X3NwYWNlID0gdGhpc19jb2xvdXI7Ci0JCW5leHRfc3BhY2UrKzsKLQkJY29s
b3VyX2NvdW50Kys7Ci0JfQotCi0JLyogUHJvZ3JhbSBjb2xvdXJzIGZyb20gY3Vyc29yIGljb24g
aW50byBwYWxldHRlICovCi0JZm9yIChpID0gMDsgaSA8IGNvbG91cl9jb3VudDsgaSsrKSB7Ci0J
CWlmIChpIDw9IDIpCi0JCQlyZWdfaW5kZXggPSAweDggKyBpKjB4NDsKLQkJZWxzZQotCQkJcmVn
X2luZGV4ID0gMHg2MCArIGkqMHgzOwotCQlXUkVHX0RBQyhyZWdfaW5kZXgsIGNvbG91cl9zZXRb
aV0gJiAweGZmKTsKLQkJV1JFR19EQUMocmVnX2luZGV4KzEsIGNvbG91cl9zZXRbaV0+PjggJiAw
eGZmKTsKLQkJV1JFR19EQUMocmVnX2luZGV4KzIsIGNvbG91cl9zZXRbaV0+PjE2ICYgMHhmZik7
Ci0JCUJVR19PTigoY29sb3VyX3NldFtpXT4+MjQgJiAweGZmKSAhPSAweGZmKTsKLQl9Ci0KLQkv
KiBub3cgd3JpdGUgY29sb3VyIGluZGljZXMgaW50byBoYXJkd2FyZSBjdXJzb3IgYnVmZmVyICov
Ci0JZm9yIChyb3cgPSAwOyByb3cgPCA2NDsgcm93KyspIHsKLQkJbWVtc2V0KCZ0aGlzX3Jvd1sw
XSwgMCwgNDgpOwotCQlmb3IgKGNvbCA9IDA7IGNvbCA8IDY0OyBjb2wrKykgewotCQkJdGhpc19j
b2xvdXIgPSBpb3JlYWQzMihzcmMgKyA0Kihjb2wgKyA2NCpyb3cpKTsKLQkJCS8qIHdyaXRlIHRy
YW5zcGFyZW50IHBpeGVscyAqLwotCQkJaWYgKHRoaXNfY29sb3VyPj4yNCA9PSAweDApIHsKLQkJ
CQl0aGlzX3Jvd1s0NyAtIGNvbC84XSB8PSAweDgwPj4oY29sJTgpOwotCQkJCWNvbnRpbnVlOwot
CQkJfQotCi0JCQkvKiB3cml0ZSBjb2xvdXIgaW5kZXggaGVyZSAqLwotCQkJZm9yIChpID0gMDsg
aSA8IGNvbG91cl9jb3VudDsgaSsrKSB7Ci0JCQkJaWYgKGNvbG91cl9zZXRbaV0gPT0gdGhpc19j
b2xvdXIpIHsKLQkJCQkJaWYgKGNvbCAlIDIpCi0JCQkJCQl0aGlzX3Jvd1tjb2wvMl0gfD0gaTw8
NDsKLQkJCQkJZWxzZQotCQkJCQkJdGhpc19yb3dbY29sLzJdIHw9IGk7Ci0JCQkJCWJyZWFrOwot
CQkJCX0KLQkJCX0KLQkJfQotCQltZW1jcHlfdG9pbyhkc3QgKyByb3cqNDgsICZ0aGlzX3Jvd1sw
XSwgNDgpOwotCX0KLQotCS8qIFByb2dyYW0gZ3B1IGFkZHJlc3Mgb2YgY3Vyc29yIGJ1ZmZlciAq
LwotCVdSRUdfREFDKE1HQTEwNjRfQ1VSU09SX0JBU0VfQURSX0xPVywgKHU4KSgoZHN0X2dwdT4+
MTApICYgMHhmZikpOwotCVdSRUdfREFDKE1HQTEwNjRfQ1VSU09SX0JBU0VfQURSX0hJLCAodTgp
KChkc3RfZ3B1Pj4xOCkgJiAweDNmKSk7Ci0KLQkvKiBBZGp1c3QgY3Vyc29yIGNvbnRyb2wgcmVn
aXN0ZXIgdG8gdHVybiBvbiB0aGUgY3Vyc29yICovCi0JV1JFR19EQUMoTUdBMTA2NF9DVVJTT1Jf
Q1RMLCA0KTsgLyogMTYtY29sb3VyIHBhbGxldGl6ZWQgY3Vyc29yIG1vZGUgKi8KKwlyZXQgPSBt
Z2FnMjAwX3Nob3dfY3Vyc29yKG1kZXYsIGRzdCwgc3JjLCB3aWR0aCwgaGVpZ2h0LCBkc3RfZ3B1
KTsKKwlpZiAocmV0KQorCQlnb3RvIGVycl9kcm1fZ2VtX3ZyYW1fa3VubWFwX2RzdDsKIAogCS8q
IE5vdyB1cGRhdGUgaW50ZXJuYWwgYnVmZmVyIHBvaW50ZXJzICovCiAJaWYgKHBpeGVsc19jdXJy
ZW50KQotLSAKMi4yMy4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3Rv
cC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmkt
ZGV2ZWw=
