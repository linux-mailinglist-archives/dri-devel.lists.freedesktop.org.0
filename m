Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 808A3BB420
	for <lists+dri-devel@lfdr.de>; Mon, 23 Sep 2019 14:46:53 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2024C6E8A2;
	Mon, 23 Sep 2019 12:46:51 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
X-Greylist: delayed 315 seconds by postgrey-1.36 at gabe;
 Mon, 23 Sep 2019 12:46:45 UTC
Received: from smtphy.263.net (syd-smtp02.263.net [13.237.61.158])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 067D76E8A6;
 Mon, 23 Sep 2019 12:46:44 +0000 (UTC)
Received: from regular2.263xmail.com (unknown [211.157.147.163])
 by smtphy.263.net (Postfix) with ESMTP id 29A921200E1;
 Mon, 23 Sep 2019 20:41:26 +0800 (CST)
Received: from regular1.263xmail.com (unknown [192.168.165.235])
 by regular2.263xmail.com (Postfix) with ESMTP id 5E50922C;
 Mon, 23 Sep 2019 20:40:08 +0800 (CST)
Received: from hjc?rock-chips.com (unknown [192.168.167.32])
 by regular1.263xmail.com (Postfix) with ESMTP id DC29D36A;
 Mon, 23 Sep 2019 20:40:02 +0800 (CST)
X-263anti-spam: KSV:0;BIG:0;
X-MAIL-GRAY: 0
X-MAIL-DELIVERY: 1
X-KSVirus-check: 0
X-ADDR-CHECKED4: 1
X-ABS-CHECKED: 1
X-SKE-CHECKED: 1
X-ANTISPAM-LEVEL: 2
Received: from localhost.localdomain (unknown [58.22.7.114])
 by smtp.263.net (postfix) whith ESMTP id
 P10893T140454720919296S1569242369031174_; 
 Mon, 23 Sep 2019 20:40:01 +0800 (CST)
X-IP-DOMAINF: 1
X-UNIQUE-TAG: <0fd37b72fe62d59ebbe910ed58dc72ff>
X-RL-SENDER: hjc@rock-chips.com
X-SENDER: hjc@rock-chips.com
X-LOGIN-NAME: hjc@rock-chips.com
X-FST-TO: dri-devel@lists.freedesktop.org
X-SENDER-IP: 58.22.7.114
X-ATTACHMENT-NUM: 0
X-DNS-TYPE: 0
From: Sandy Huang <hjc@rock-chips.com>
To: dri-devel@lists.freedesktop.org, Jani Nikula <jani.nikula@linux.intel.com>,
 Joonas Lahtinen <joonas.lahtinen@linux.intel.com>,
 Rodrigo Vivi <rodrigo.vivi@intel.com>, David Airlie <airlied@linux.ie>,
 Daniel Vetter <daniel@ffwll.ch>,
 =?UTF-8?q?Ville=20Syrj=C3=A4l=C3=A4?= <ville.syrjala@linux.intel.com>,
 Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
 Matt Roper <matthew.d.roper@intel.com>,
 Chris Wilson <chris@chris-wilson.co.uk>, Sandy Huang <hjc@rock-chips.com>,
 Sam Ravnborg <sam@ravnborg.org>,
 =?UTF-8?q?Jos=C3=A9=20Roberto=20de=20Souza?= <jose.souza@intel.com>,
 Daniel Drake <drake@endlessm.com>,
 Lucas De Marchi <lucas.demarchi@intel.com>, Lyude Paul <lyude@redhat.com>,
 Dave Airlie <airlied@redhat.com>
Subject: [PATCH 03/36] drm/i915: use bpp instead of cpp for drm_format_info
Date: Mon, 23 Sep 2019 20:38:52 +0800
Message-Id: <1569242365-182133-4-git-send-email-hjc@rock-chips.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1569242365-182133-1-git-send-email-hjc@rock-chips.com>
References: <1569242365-182133-1-git-send-email-hjc@rock-chips.com>
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Jani Nikula <jani.nikula@intel.com>, Daniel Vetter <daniel.vetter@ffwll.ch>,
 intel-gfx@lists.freedesktop.org, linux-kernel@vger.kernel.org,
 Juha-Pekka Heikkila <juhapekka.heikkila@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

Y3BwW0J5dGVQZXJQbGFuZV0gY2FuJ3QgZGVzY3JpYmUgdGhlIDEwYml0IGRhdGEgZm9ybWF0IGNv
cnJlY3RseSwKU28gd2UgdXNlIGJwcFtCaXRQZXJQbGFuZV0gdG8gaW5zdGVhZCBjcHAuCgpTaWdu
ZWQtb2ZmLWJ5OiBTYW5keSBIdWFuZyA8aGpjQHJvY2stY2hpcHMuY29tPgotLS0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljX3BsYW5lLmMgfCAgMiArLQogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMgICAgICB8IDI4ICsrKysrKysr
KysrLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2ZiYy5j
ICAgICAgICAgIHwgIDggKysrLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9mYmRldi5jICAgICAgICB8ICA2ICsrLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX3Nwcml0ZS5jICAgICAgIHwgIDQgKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kZWJ1Z2ZzLmMgICAgICAgICAgICAgICB8ICA0ICsrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX3BtLmMgICAgICAgICAgICAgICAgICAgfCAyOCArKysrKysrKysrKy0tLS0tLS0tLS0t
LQogNyBmaWxlcyBjaGFuZ2VkLCA0MCBpbnNlcnRpb25zKCspLCA0MCBkZWxldGlvbnMoLSkKCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0b21pY19wbGFu
ZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9taWNfcGxhbmUuYwpp
bmRleCAzMGJkNGU3Li4yZTkzMjM0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2F0b21pY19wbGFuZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfYXRvbWljX3BsYW5lLmMKQEAgLTEyMyw3ICsxMjMsNyBAQCB1bnNpZ25lZCBp
bnQgaW50ZWxfcGxhbmVfZGF0YV9yYXRlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAogCWlmICghcGxhbmVfc3RhdGUtPmJhc2UudmlzaWJsZSkKIAkJcmV0dXJuIDA7
CiAKLQljcHAgPSBmYi0+Zm9ybWF0LT5jcHBbMF07CisJY3BwID0gZmItPmZvcm1hdC0+YnBwWzBd
IC8gODsKIAogCS8qCiAJICogQmFzZWQgb24gSFNEIzoxNDA4NzE1NDkzCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCmluZGV4IDIxYzcxZmQuLjczMmRiM2Yg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCkBAIC0x
OTEyLDcgKzE5MTIsNyBAQCBzdGF0aWMgdW5zaWduZWQgaW50CiBpbnRlbF90aWxlX3dpZHRoX2J5
dGVzKGNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLCBpbnQgY29sb3JfcGxhbmUpCiB7
CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShmYi0+ZGV2KTsK
LQl1bnNpZ25lZCBpbnQgY3BwID0gZmItPmZvcm1hdC0+Y3BwW2NvbG9yX3BsYW5lXTsKKwl1bnNp
Z25lZCBpbnQgY3BwID0gZmItPmZvcm1hdC0+YnBwW2NvbG9yX3BsYW5lXSAvIDg7CiAKIAlzd2l0
Y2ggKGZiLT5tb2RpZmllcikgewogCWNhc2UgRFJNX0ZPUk1BVF9NT0RfTElORUFSOgpAQCAtMTk2
OSw3ICsxOTY5LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfdGlsZV9kaW1zKGNvbnN0IHN0cnVjdCBk
cm1fZnJhbWVidWZmZXIgKmZiLCBpbnQgY29sb3JfcGxhbmUsCiAJCQkgICAgdW5zaWduZWQgaW50
ICp0aWxlX2hlaWdodCkKIHsKIAl1bnNpZ25lZCBpbnQgdGlsZV93aWR0aF9ieXRlcyA9IGludGVs
X3RpbGVfd2lkdGhfYnl0ZXMoZmIsIGNvbG9yX3BsYW5lKTsKLQl1bnNpZ25lZCBpbnQgY3BwID0g
ZmItPmZvcm1hdC0+Y3BwW2NvbG9yX3BsYW5lXTsKKwl1bnNpZ25lZCBpbnQgY3BwID0gZmItPmZv
cm1hdC0+YnBwW2NvbG9yX3BsYW5lXSAvIDg7CiAKIAkqdGlsZV93aWR0aCA9IHRpbGVfd2lkdGhf
Ynl0ZXMgLyBjcHA7CiAJKnRpbGVfaGVpZ2h0ID0gaW50ZWxfdGlsZV9zaXplKHRvX2k5MTUoZmIt
PmRldikpIC8gdGlsZV93aWR0aF9ieXRlczsKQEAgLTIyMDcsNyArMjIwNyw3IEBAIHUzMiBpbnRl
bF9mYl94eV90b19saW5lYXIoaW50IHgsIGludCB5LAogCQkJICBpbnQgY29sb3JfcGxhbmUpCiB7
CiAJY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBzdGF0ZS0+YmFzZS5mYjsKLQl1
bnNpZ25lZCBpbnQgY3BwID0gZmItPmZvcm1hdC0+Y3BwW2NvbG9yX3BsYW5lXTsKKwl1bnNpZ25l
ZCBpbnQgY3BwID0gZmItPmZvcm1hdC0+YnBwW2NvbG9yX3BsYW5lXSAvIDg7CiAJdW5zaWduZWQg
aW50IHBpdGNoID0gc3RhdGUtPmNvbG9yX3BsYW5lW2NvbG9yX3BsYW5lXS5zdHJpZGU7CiAKIAly
ZXR1cm4geSAqIHBpdGNoICsgeCAqIGNwcDsKQEAgLTIyNjcsNyArMjI2Nyw3IEBAIHN0YXRpYyB1
MzIgaW50ZWxfYWRqdXN0X2FsaWduZWRfb2Zmc2V0KGludCAqeCwgaW50ICp5LAogCQkJCSAgICAg
ICB1MzIgb2xkX29mZnNldCwgdTMyIG5ld19vZmZzZXQpCiB7CiAJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShmYi0+ZGV2KTsKLQl1bnNpZ25lZCBpbnQgY3BwID0g
ZmItPmZvcm1hdC0+Y3BwW2NvbG9yX3BsYW5lXTsKKwl1bnNpZ25lZCBpbnQgY3BwID0gZmItPmZv
cm1hdC0+YnBwW2NvbG9yX3BsYW5lXSAvIDg7CiAKIAlXQVJOX09OKG5ld19vZmZzZXQgPiBvbGRf
b2Zmc2V0KTsKIApAQCAtMjMzNSw3ICsyMzM1LDcgQEAgc3RhdGljIHUzMiBpbnRlbF9jb21wdXRl
X2FsaWduZWRfb2Zmc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAkJCQkJ
dW5zaWduZWQgaW50IHJvdGF0aW9uLAogCQkJCQl1MzIgYWxpZ25tZW50KQogewotCXVuc2lnbmVk
IGludCBjcHAgPSBmYi0+Zm9ybWF0LT5jcHBbY29sb3JfcGxhbmVdOworCXVuc2lnbmVkIGludCBj
cHAgPSBmYi0+Zm9ybWF0LT5icHBbY29sb3JfcGxhbmVdIC8gODsKIAl1MzIgb2Zmc2V0LCBvZmZz
ZXRfYWxpZ25lZDsKIAogCWlmIChhbGlnbm1lbnQpCkBAIC0yNjU1LDcgKzI2NTUsNyBAQCBpbnRl
bF9maWxsX2ZiX2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogCQlpbnQg
eCwgeTsKIAkJaW50IHJldDsKIAotCQljcHAgPSBmYi0+Zm9ybWF0LT5jcHBbaV07CisJCWNwcCA9
IGZiLT5mb3JtYXQtPmJwcFtpXSAvIDg7CiAJCXdpZHRoID0gZHJtX2ZyYW1lYnVmZmVyX3BsYW5l
X3dpZHRoKGZiLT53aWR0aCwgZmIsIGkpOwogCQloZWlnaHQgPSBkcm1fZnJhbWVidWZmZXJfcGxh
bmVfaGVpZ2h0KGZiLT5oZWlnaHQsIGZiLCBpKTsKIApAQCAtMjg0MCw3ICsyODQwLDcgQEAgaW50
ZWxfcGxhbmVfcmVtYXBfZ3R0KHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUp
CiAJZm9yIChpID0gMDsgaSA8IG51bV9wbGFuZXM7IGkrKykgewogCQl1bnNpZ25lZCBpbnQgaHN1
YiA9IGkgPyBmYi0+Zm9ybWF0LT5oc3ViIDogMTsKIAkJdW5zaWduZWQgaW50IHZzdWIgPSBpID8g
ZmItPmZvcm1hdC0+dnN1YiA6IDE7Ci0JCXVuc2lnbmVkIGludCBjcHAgPSBmYi0+Zm9ybWF0LT5j
cHBbaV07CisJCXVuc2lnbmVkIGludCBjcHAgPSBmYi0+Zm9ybWF0LT5icHBbaV0gLyA4OwogCQl1
bnNpZ25lZCBpbnQgdGlsZV93aWR0aCwgdGlsZV9oZWlnaHQ7CiAJCXVuc2lnbmVkIGludCB3aWR0
aCwgaGVpZ2h0OwogCQl1bnNpZ25lZCBpbnQgcGl0Y2hfdGlsZXM7CkBAIC0zMjg2LDcgKzMyODYs
NyBAQCBzdGF0aWMgaW50IHNrbF9tYXhfcGxhbmVfd2lkdGgoY29uc3Qgc3RydWN0IGRybV9mcmFt
ZWJ1ZmZlciAqZmIsCiAJCQkgICAgICAgaW50IGNvbG9yX3BsYW5lLAogCQkJICAgICAgIHVuc2ln
bmVkIGludCByb3RhdGlvbikKIHsKLQlpbnQgY3BwID0gZmItPmZvcm1hdC0+Y3BwW2NvbG9yX3Bs
YW5lXTsKKwlpbnQgY3BwID0gZmItPmZvcm1hdC0+YnBwW2NvbG9yX3BsYW5lXSAvIDg7CiAKIAlz
d2l0Y2ggKGZiLT5tb2RpZmllcikgewogCWNhc2UgRFJNX0ZPUk1BVF9NT0RfTElORUFSOgpAQCAt
MzMxMSw3ICszMzExLDcgQEAgc3RhdGljIGludCBnbGtfbWF4X3BsYW5lX3dpZHRoKGNvbnN0IHN0
cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLAogCQkJICAgICAgIGludCBjb2xvcl9wbGFuZSwKIAkJ
CSAgICAgICB1bnNpZ25lZCBpbnQgcm90YXRpb24pCiB7Ci0JaW50IGNwcCA9IGZiLT5mb3JtYXQt
PmNwcFtjb2xvcl9wbGFuZV07CisJaW50IGNwcCA9IGZiLT5mb3JtYXQtPmJwcFtjb2xvcl9wbGFu
ZV0gLyA4OwogCiAJc3dpdGNoIChmYi0+bW9kaWZpZXIpIHsKIAljYXNlIERSTV9GT1JNQVRfTU9E
X0xJTkVBUjoKQEAgLTM0MjYsNyArMzQyNiw3IEBAIHN0YXRpYyBpbnQgc2tsX2NoZWNrX21haW5f
c3VyZmFjZShzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQogCSAqIFRPRE86
IGxpbmVhciBhbmQgWS10aWxlZCBzZWVtIGZpbmUsIFlmIHVudGVzdGVkLAogCSAqLwogCWlmIChm
Yi0+bW9kaWZpZXIgPT0gSTkxNV9GT1JNQVRfTU9EX1hfVElMRUQpIHsKLQkJaW50IGNwcCA9IGZi
LT5mb3JtYXQtPmNwcFswXTsKKwkJaW50IGNwcCA9IGZiLT5mb3JtYXQtPmJwcFswXSAvIDg7CiAK
IAkJd2hpbGUgKCh4ICsgdykgKiBjcHAgPiBwbGFuZV9zdGF0ZS0+Y29sb3JfcGxhbmVbMF0uc3Ry
aWRlKSB7CiAJCQlpZiAob2Zmc2V0ID09IDApIHsKQEAgLTg1MTMsNyArODUxMyw3IEBAIGk5eHhf
Z2V0X2luaXRpYWxfcGxhbmVfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAogCiAJRFJN
X0RFQlVHX0tNUygiJXMvJXMgd2l0aCBmYjogc2l6ZT0lZHglZEAlZCwgb2Zmc2V0PSV4LCBwaXRj
aCAlZCwgc2l6ZSAweCV4XG4iLAogCQkgICAgICBjcnRjLT5iYXNlLm5hbWUsIHBsYW5lLT5iYXNl
Lm5hbWUsIGZiLT53aWR0aCwgZmItPmhlaWdodCwKLQkJICAgICAgZmItPmZvcm1hdC0+Y3BwWzBd
ICogOCwgYmFzZSwgZmItPnBpdGNoZXNbMF0sCisJCSAgICAgIGZiLT5mb3JtYXQtPmJwcFswXSwg
YmFzZSwgZmItPnBpdGNoZXNbMF0sCiAJCSAgICAgIHBsYW5lX2NvbmZpZy0+c2l6ZSk7CiAKIAlw
bGFuZV9jb25maWctPmZiID0gaW50ZWxfZmI7CkBAIC05NzUzLDcgKzk3NTMsNyBAQCBza3lsYWtl
X2dldF9pbml0aWFsX3BsYW5lX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKIAogCURS
TV9ERUJVR19LTVMoIiVzLyVzIHdpdGggZmI6IHNpemU9JWR4JWRAJWQsIG9mZnNldD0leCwgcGl0
Y2ggJWQsIHNpemUgMHgleFxuIiwKIAkJICAgICAgY3J0Yy0+YmFzZS5uYW1lLCBwbGFuZS0+YmFz
ZS5uYW1lLCBmYi0+d2lkdGgsIGZiLT5oZWlnaHQsCi0JCSAgICAgIGZiLT5mb3JtYXQtPmNwcFsw
XSAqIDgsIGJhc2UsIGZiLT5waXRjaGVzWzBdLAorCQkgICAgICBmYi0+Zm9ybWF0LT5icHBbMF0s
IGJhc2UsIGZiLT5waXRjaGVzWzBdLAogCQkgICAgICBwbGFuZV9jb25maWctPnNpemUpOwogCiAJ
cGxhbmVfY29uZmlnLT5mYiA9IGludGVsX2ZiOwpAQCAtMTAzNTAsNyArMTAzNTAsNyBAQCBzdGF0
aWMgdTMyIGludGVsX2N1cnNvcl9iYXNlKGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAq
cGxhbmVfc3RhdGUpCiAJaWYgKEhBU19HTUNIKGRldl9wcml2KSAmJgogCSAgICBwbGFuZV9zdGF0
ZS0+YmFzZS5yb3RhdGlvbiAmIERSTV9NT0RFX1JPVEFURV8xODApCiAJCWJhc2UgKz0gKHBsYW5l
X3N0YXRlLT5iYXNlLmNydGNfaCAqCi0JCQkgcGxhbmVfc3RhdGUtPmJhc2UuY3J0Y193IC0gMSkg
KiBmYi0+Zm9ybWF0LT5jcHBbMF07CisJCQkgcGxhbmVfc3RhdGUtPmJhc2UuY3J0Y193IC0gMSkg
KiBmYi0+Zm9ybWF0LT5icHBbMF0gLyA4OwogCiAJcmV0dXJuIGJhc2U7CiB9CkBAIC0xMDcyOCw3
ICsxMDcyOCw3IEBAIHN0YXRpYyBpbnQgaTl4eF9jaGVja19jdXJzb3Ioc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJV0FSTl9PTihwbGFuZV9zdGF0ZS0+YmFzZS52aXNpYmxl
ICYmCiAJCXBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVswXS5zdHJpZGUgIT0gZmItPnBpdGNoZXNb
MF0pOwogCi0JaWYgKGZiLT5waXRjaGVzWzBdICE9IHBsYW5lX3N0YXRlLT5iYXNlLmNydGNfdyAq
IGZiLT5mb3JtYXQtPmNwcFswXSkgeworCWlmIChmYi0+cGl0Y2hlc1swXSAhPSBwbGFuZV9zdGF0
ZS0+YmFzZS5jcnRjX3cgKiBmYi0+Zm9ybWF0LT5icHBbMF0gLyA4KSB7CiAJCURSTV9ERUJVR19L
TVMoIkludmFsaWQgY3Vyc29yIHN0cmlkZSAoJXUpIChjdXJzb3Igd2lkdGggJWQpXG4iLAogCQkJ
ICAgICAgZmItPnBpdGNoZXNbMF0sIHBsYW5lX3N0YXRlLT5iYXNlLmNydGNfdyk7CiAJCXJldHVy
biAtRUlOVkFMOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9mYmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZmJjLmMKaW5kZXgg
ZDM2Y2FkYS4uNzkxMWM0OSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9mYmMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Zi
Yy5jCkBAIC0xNzIsNyArMTcyLDcgQEAgc3RhdGljIHZvaWQgZzR4X2ZiY19hY3RpdmF0ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJdTMyIGRwZmNfY3RsOwogCiAJZHBmY19j
dGwgPSBEUEZDX0NUTF9QTEFORShwYXJhbXMtPmNydGMuaTl4eF9wbGFuZSkgfCBEUEZDX1NSX0VO
OwotCWlmIChwYXJhbXMtPmZiLmZvcm1hdC0+Y3BwWzBdID09IDIpCisJaWYgKHBhcmFtcy0+ZmIu
Zm9ybWF0LT5icHBbMF0gPT0gMTYpCiAJCWRwZmNfY3RsIHw9IERQRkNfQ1RMX0xJTUlUXzJYOwog
CWVsc2UKIAkJZHBmY19jdGwgfD0gRFBGQ19DVExfTElNSVRfMVg7CkBAIC0yMTksNyArMjE5LDcg
QEAgc3RhdGljIHZvaWQgaWxrX2ZiY19hY3RpdmF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCiAJaW50IHRocmVzaG9sZCA9IGRldl9wcml2LT5mYmMudGhyZXNob2xkOwogCiAJ
ZHBmY19jdGwgPSBEUEZDX0NUTF9QTEFORShwYXJhbXMtPmNydGMuaTl4eF9wbGFuZSk7Ci0JaWYg
KHBhcmFtcy0+ZmIuZm9ybWF0LT5jcHBbMF0gPT0gMikKKwlpZiAocGFyYW1zLT5mYi5mb3JtYXQt
PmJwcFswXSA9PSAxNikKIAkJdGhyZXNob2xkKys7CiAKIAlzd2l0Y2ggKHRocmVzaG9sZCkgewpA
QCAtMzAyLDcgKzMwMiw3IEBAIHN0YXRpYyB2b2lkIGdlbjdfZmJjX2FjdGl2YXRlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlpZiAoSVNfSVZZQlJJREdFKGRldl9wcml2KSkK
IAkJZHBmY19jdGwgfD0gSVZCX0RQRkNfQ1RMX1BMQU5FKHBhcmFtcy0+Y3J0Yy5pOXh4X3BsYW5l
KTsKIAotCWlmIChwYXJhbXMtPmZiLmZvcm1hdC0+Y3BwWzBdID09IDIpCisJaWYgKHBhcmFtcy0+
ZmIuZm9ybWF0LT5icHBbMF0gPT0gMTYpCiAJCXRocmVzaG9sZCsrOwogCiAJc3dpdGNoICh0aHJl
c2hvbGQpIHsKQEAgLTQ5OCw3ICs0OTgsNyBAQCBzdGF0aWMgaW50IGludGVsX2ZiY19hbGxvY19j
ZmIoc3RydWN0IGludGVsX2NydGMgKmNydGMpCiAJV0FSTl9PTihkcm1fbW1fbm9kZV9hbGxvY2F0
ZWQoJmZiYy0+Y29tcHJlc3NlZF9mYikpOwogCiAJc2l6ZSA9IGludGVsX2ZiY19jYWxjdWxhdGVf
Y2ZiX3NpemUoZGV2X3ByaXYsICZmYmMtPnN0YXRlX2NhY2hlKTsKLQlmYl9jcHAgPSBmYmMtPnN0
YXRlX2NhY2hlLmZiLmZvcm1hdC0+Y3BwWzBdOworCWZiX2NwcCA9IGZiYy0+c3RhdGVfY2FjaGUu
ZmIuZm9ybWF0LT5icHBbMF0gLyA4OwogCiAJcmV0ID0gZmluZF9jb21wcmVzc2lvbl90aHJlc2hv
bGQoZGV2X3ByaXYsICZmYmMtPmNvbXByZXNzZWRfZmIsCiAJCQkJCSBzaXplLCBmYl9jcHApOwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mYmRldi5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mYmRldi5jCmluZGV4IDFlZGQ0NGUu
LmFlOTgwNjMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZmJkZXYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2ZiZGV2LmMK
QEAgLTM3Myw3ICszNzMsNyBAQCBzdGF0aWMgYm9vbCBpbnRlbF9mYmRldl9pbml0X2Jpb3Moc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiwKIAkJICogcmF0aGVyIHRoYW4gdGhlIGN1cnJlbnQgcGlwZSdz
LCBzaW5jZSB0aGV5IGRpZmZlci4KIAkJICovCiAJCWN1cl9zaXplID0gY3J0Yy0+c3RhdGUtPmFk
anVzdGVkX21vZGUuY3J0Y19oZGlzcGxheTsKLQkJY3VyX3NpemUgPSBjdXJfc2l6ZSAqIGZiLT5i
YXNlLmZvcm1hdC0+Y3BwWzBdOworCQljdXJfc2l6ZSA9IGN1cl9zaXplICogZmItPmJhc2UuZm9y
bWF0LT5icHBbMF0gLyA4OwogCQlpZiAoZmItPmJhc2UucGl0Y2hlc1swXSA8IGN1cl9zaXplKSB7
CiAJCQlEUk1fREVCVUdfS01TKCJmYiBub3Qgd2lkZSBlbm91Z2ggZm9yIHBsYW5lICVjICglZCB2
cyAlZClcbiIsCiAJCQkJICAgICAgcGlwZV9uYW1lKGludGVsX2NydGMtPnBpcGUpLApAQCAtMzg5
LDcgKzM4OSw3IEBAIHN0YXRpYyBib29sIGludGVsX2ZiZGV2X2luaXRfYmlvcyhzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2LAogCQkJICAgICAgcGlwZV9uYW1lKGludGVsX2NydGMtPnBpcGUpLAogCQkJ
ICAgICAgY3J0Yy0+c3RhdGUtPmFkanVzdGVkX21vZGUuY3J0Y19oZGlzcGxheSwKIAkJCSAgICAg
IGNydGMtPnN0YXRlLT5hZGp1c3RlZF9tb2RlLmNydGNfdmRpc3BsYXksCi0JCQkgICAgICBmYi0+
YmFzZS5mb3JtYXQtPmNwcFswXSAqIDgsCisJCQkgICAgICBmYi0+YmFzZS5mb3JtYXQtPmJwcFsw
XSwKIAkJCSAgICAgIGN1cl9zaXplKTsKIAogCQlpZiAoY3VyX3NpemUgPiBtYXhfc2l6ZSkgewpA
QCAtNDEwLDcgKzQxMCw3IEBAIHN0YXRpYyBib29sIGludGVsX2ZiZGV2X2luaXRfYmlvcyhzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2LAogCQlnb3RvIG91dDsKIAl9CiAKLQlpZmJkZXYtPnByZWZlcnJl
ZF9icHAgPSBmYi0+YmFzZS5mb3JtYXQtPmNwcFswXSAqIDg7CisJaWZiZGV2LT5wcmVmZXJyZWRf
YnBwID0gZmItPmJhc2UuZm9ybWF0LT5icHBbMF07CiAJaWZiZGV2LT5mYiA9IGZiOwogCiAJZHJt
X2ZyYW1lYnVmZmVyX2dldCgmaWZiZGV2LT5mYi0+YmFzZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nwcml0ZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUuYwppbmRleCAwMDRiNTIwLi5iZGNkYmU0IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nwcml0ZS5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmMKQEAgLTMzNiw3ICszMzYs
NyBAQCBza2xfcGxhbmVfbWF4X3N0cmlkZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAogCQkg
ICAgIHVuc2lnbmVkIGludCByb3RhdGlvbikKIHsKIAljb25zdCBzdHJ1Y3QgZHJtX2Zvcm1hdF9p
bmZvICppbmZvID0gZHJtX2Zvcm1hdF9pbmZvKHBpeGVsX2Zvcm1hdCk7Ci0JaW50IGNwcCA9IGlu
Zm8tPmNwcFswXTsKKwlpbnQgY3BwID0gaW5mby0+YnBwWzBdIC8gODsKIAogCS8qCiAJICogIlRo
ZSBzdHJpZGUgaW4gYnl0ZXMgbXVzdCBub3QgZXhjZWVkIHRoZQpAQCAtMTM1MCw3ICsxMzUwLDcg
QEAgZzR4X3Nwcml0ZV9jaGVja19zY2FsaW5nKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlLAogCWludCBzcmNfeCwgc3JjX3ksIHNyY193LCBzcmNfaCwgY3J0Y193LCBjcnRjX2g7
CiAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQogCQkmY3J0
Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwotCXVuc2lnbmVkIGludCBjcHAgPSBmYi0+Zm9y
bWF0LT5jcHBbMF07CisJdW5zaWduZWQgaW50IGNwcCA9IGZiLT5mb3JtYXQtPmJwcFswXSAvIDg7
CiAJdW5zaWduZWQgaW50IHdpZHRoX2J5dGVzOwogCWludCBtaW5fd2lkdGgsIG1pbl9oZWlnaHQ7
CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKaW5kZXggNjJjZjM0ZC4uYTUxZWQ4NSAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKQEAgLTE2MzEsNyArMTYzMSw3IEBAIHN0
YXRpYyBpbnQgaTkxNV9nZW1fZnJhbWVidWZmZXJfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZv
aWQgKmRhdGEpCiAJCQkgICBmYmRldl9mYi0+YmFzZS53aWR0aCwKIAkJCSAgIGZiZGV2X2ZiLT5i
YXNlLmhlaWdodCwKIAkJCSAgIGZiZGV2X2ZiLT5iYXNlLmZvcm1hdC0+ZGVwdGgsCi0JCQkgICBm
YmRldl9mYi0+YmFzZS5mb3JtYXQtPmNwcFswXSAqIDgsCisJCQkgICBmYmRldl9mYi0+YmFzZS5m
b3JtYXQtPmJwcFswXSwKIAkJCSAgIGZiZGV2X2ZiLT5iYXNlLm1vZGlmaWVyLAogCQkJICAgZHJt
X2ZyYW1lYnVmZmVyX3JlYWRfcmVmY291bnQoJmZiZGV2X2ZiLT5iYXNlKSk7CiAJCWRlc2NyaWJl
X29iaihtLCBpbnRlbF9mYl9vYmooJmZiZGV2X2ZiLT5iYXNlKSk7CkBAIC0xNjQ5LDcgKzE2NDks
NyBAQCBzdGF0aWMgaW50IGk5MTVfZ2VtX2ZyYW1lYnVmZmVyX2luZm8oc3RydWN0IHNlcV9maWxl
ICptLCB2b2lkICpkYXRhKQogCQkJICAgZmItPmJhc2Uud2lkdGgsCiAJCQkgICBmYi0+YmFzZS5o
ZWlnaHQsCiAJCQkgICBmYi0+YmFzZS5mb3JtYXQtPmRlcHRoLAotCQkJICAgZmItPmJhc2UuZm9y
bWF0LT5jcHBbMF0gKiA4LAorCQkJICAgZmItPmJhc2UuZm9ybWF0LT5icHBbMF0sCiAJCQkgICBm
Yi0+YmFzZS5tb2RpZmllciwKIAkJCSAgIGRybV9mcmFtZWJ1ZmZlcl9yZWFkX3JlZmNvdW50KCZm
Yi0+YmFzZSkpOwogCQlkZXNjcmliZV9vYmoobSwgaW50ZWxfZmJfb2JqKCZmYi0+YmFzZSkpOwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX3BtLmMKaW5kZXggZDlhN2ExMy4uYTcwYjM3MiAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9wbS5jCkBAIC04NzMsNyArODczLDcgQEAgc3RhdGljIHZvaWQgcGluZXZpZXdfdXBk
YXRlX3dtKHN0cnVjdCBpbnRlbF9jcnRjICp1bnVzZWRfY3J0YykKIAkJCSZjcnRjLT5jb25maWct
PmJhc2UuYWRqdXN0ZWRfbW9kZTsKIAkJY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIg
PQogCQkJY3J0Yy0+YmFzZS5wcmltYXJ5LT5zdGF0ZS0+ZmI7Ci0JCWludCBjcHAgPSBmYi0+Zm9y
bWF0LT5jcHBbMF07CisJCWludCBjcHAgPSBmYi0+Zm9ybWF0LT5icHBbMF0gLyA4OwogCQlpbnQg
Y2xvY2sgPSBhZGp1c3RlZF9tb2RlLT5jcnRjX2Nsb2NrOwogCiAJCS8qIERpc3BsYXkgU1IgKi8K
QEAgLTExMzEsNyArMTEzMSw3IEBAIHN0YXRpYyB1MTYgZzR4X2NvbXB1dGVfd20oY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJICAgIGxldmVsICE9IEc0WF9XTV9M
RVZFTF9OT1JNQUwpCiAJCWNwcCA9IDQ7CiAJZWxzZQotCQljcHAgPSBwbGFuZV9zdGF0ZS0+YmFz
ZS5mYi0+Zm9ybWF0LT5jcHBbMF07CisJCWNwcCA9IHBsYW5lX3N0YXRlLT5iYXNlLmZiLT5mb3Jt
YXQtPmJwcFswXSAvIDg7CiAKIAljbG9jayA9IGFkanVzdGVkX21vZGUtPmNydGNfY2xvY2s7CiAJ
aHRvdGFsID0gYWRqdXN0ZWRfbW9kZS0+Y3J0Y19odG90YWw7CkBAIC0xNjI0LDcgKzE2MjQsNyBA
QCBzdGF0aWMgdTE2IHZsdl9jb21wdXRlX3dtX2xldmVsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlLAogCWlmICghaW50ZWxfd21fcGxhbmVfdmlzaWJsZShjcnRjX3N0
YXRlLCBwbGFuZV9zdGF0ZSkpCiAJCXJldHVybiAwOwogCi0JY3BwID0gcGxhbmVfc3RhdGUtPmJh
c2UuZmItPmZvcm1hdC0+Y3BwWzBdOworCWNwcCA9IHBsYW5lX3N0YXRlLT5iYXNlLmZiLT5mb3Jt
YXQtPmJwcFswXSAvIDg7CiAJY2xvY2sgPSBhZGp1c3RlZF9tb2RlLT5jcnRjX2Nsb2NrOwogCWh0
b3RhbCA9IGFkanVzdGVkX21vZGUtPmNydGNfaHRvdGFsOwogCXdpZHRoID0gY3J0Y19zdGF0ZS0+
cGlwZV9zcmNfdzsKQEAgLTIyMTYsNyArMjIxNiw3IEBAIHN0YXRpYyB2b2lkIGk5NjVfdXBkYXRl
X3dtKHN0cnVjdCBpbnRlbF9jcnRjICp1bnVzZWRfY3J0YykKIAkJaW50IGNsb2NrID0gYWRqdXN0
ZWRfbW9kZS0+Y3J0Y19jbG9jazsKIAkJaW50IGh0b3RhbCA9IGFkanVzdGVkX21vZGUtPmNydGNf
aHRvdGFsOwogCQlpbnQgaGRpc3BsYXkgPSBjcnRjLT5jb25maWctPnBpcGVfc3JjX3c7Ci0JCWlu
dCBjcHAgPSBmYi0+Zm9ybWF0LT5jcHBbMF07CisJCWludCBjcHAgPSBmYi0+Zm9ybWF0LT5icHBb
MF0gLyA4OwogCQlpbnQgZW50cmllczsKIAogCQllbnRyaWVzID0gaW50ZWxfd21fbWV0aG9kMihj
bG9jaywgaHRvdGFsLApAQCAtMjI5OSw3ICsyMjk5LDcgQEAgc3RhdGljIHZvaWQgaTl4eF91cGRh
dGVfd20oc3RydWN0IGludGVsX2NydGMgKnVudXNlZF9jcnRjKQogCQlpZiAoSVNfR0VOKGRldl9w
cml2LCAyKSkKIAkJCWNwcCA9IDQ7CiAJCWVsc2UKLQkJCWNwcCA9IGZiLT5mb3JtYXQtPmNwcFsw
XTsKKwkJCWNwcCA9IGZiLT5mb3JtYXQtPmJwcFswXSAvIDg7CiAKIAkJcGxhbmVhX3dtID0gaW50
ZWxfY2FsY3VsYXRlX3dtKGFkanVzdGVkX21vZGUtPmNydGNfY2xvY2ssCiAJCQkJCSAgICAgICB3
bV9pbmZvLCBmaWZvX3NpemUsIGNwcCwKQEAgLTIzMjYsNyArMjMyNiw3IEBAIHN0YXRpYyB2b2lk
IGk5eHhfdXBkYXRlX3dtKHN0cnVjdCBpbnRlbF9jcnRjICp1bnVzZWRfY3J0YykKIAkJaWYgKElT
X0dFTihkZXZfcHJpdiwgMikpCiAJCQljcHAgPSA0OwogCQllbHNlCi0JCQljcHAgPSBmYi0+Zm9y
bWF0LT5jcHBbMF07CisJCQljcHAgPSBmYi0+Zm9ybWF0LT5icHBbMF0gLyA4OwogCiAJCXBsYW5l
Yl93bSA9IGludGVsX2NhbGN1bGF0ZV93bShhZGp1c3RlZF9tb2RlLT5jcnRjX2Nsb2NrLAogCQkJ
CQkgICAgICAgd21faW5mbywgZmlmb19zaXplLCBjcHAsCkBAIC0yMzc4LDcgKzIzNzgsNyBAQCBz
dGF0aWMgdm9pZCBpOXh4X3VwZGF0ZV93bShzdHJ1Y3QgaW50ZWxfY3J0YyAqdW51c2VkX2NydGMp
CiAJCWlmIChJU19JOTE1R00oZGV2X3ByaXYpIHx8IElTX0k5NDVHTShkZXZfcHJpdikpCiAJCQlj
cHAgPSA0OwogCQllbHNlCi0JCQljcHAgPSBmYi0+Zm9ybWF0LT5jcHBbMF07CisJCQljcHAgPSBm
Yi0+Zm9ybWF0LT5icHBbMF0gLyA4OwogCiAJCWVudHJpZXMgPSBpbnRlbF93bV9tZXRob2QyKGNs
b2NrLCBodG90YWwsIGhkaXNwbGF5LCBjcHAsCiAJCQkJCSAgIHNyX2xhdGVuY3lfbnMgLyAxMDAp
OwpAQCAtMjUwNiw3ICsyNTA2LDcgQEAgc3RhdGljIHUzMiBpbGtfY29tcHV0ZV9wcmlfd20oY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKIAlpZiAoIWludGVsX3dtX3BsYW5l
X3Zpc2libGUoY3N0YXRlLCBwc3RhdGUpKQogCQlyZXR1cm4gMDsKIAotCWNwcCA9IHBzdGF0ZS0+
YmFzZS5mYi0+Zm9ybWF0LT5jcHBbMF07CisJY3BwID0gcHN0YXRlLT5iYXNlLmZiLT5mb3JtYXQt
PmJwcFswXSAvIDg7CiAKIAltZXRob2QxID0gaWxrX3dtX21ldGhvZDEoY3N0YXRlLT5waXhlbF9y
YXRlLCBjcHAsIG1lbV92YWx1ZSk7CiAKQEAgLTI1MzgsNyArMjUzOCw3IEBAIHN0YXRpYyB1MzIg
aWxrX2NvbXB1dGVfc3ByX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUs
CiAJaWYgKCFpbnRlbF93bV9wbGFuZV92aXNpYmxlKGNzdGF0ZSwgcHN0YXRlKSkKIAkJcmV0dXJu
IDA7CiAKLQljcHAgPSBwc3RhdGUtPmJhc2UuZmItPmZvcm1hdC0+Y3BwWzBdOworCWNwcCA9IHBz
dGF0ZS0+YmFzZS5mYi0+Zm9ybWF0LT5icHBbMF0gLyA4OwogCiAJbWV0aG9kMSA9IGlsa193bV9t
ZXRob2QxKGNzdGF0ZS0+cGl4ZWxfcmF0ZSwgY3BwLCBtZW1fdmFsdWUpOwogCW1ldGhvZDIgPSBp
bGtfd21fbWV0aG9kMihjc3RhdGUtPnBpeGVsX3JhdGUsCkBAIC0yNTY0LDcgKzI1NjQsNyBAQCBz
dGF0aWMgdTMyIGlsa19jb21wdXRlX2N1cl93bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3N0YXRlLAogCWlmICghaW50ZWxfd21fcGxhbmVfdmlzaWJsZShjc3RhdGUsIHBzdGF0ZSkp
CiAJCXJldHVybiAwOwogCi0JY3BwID0gcHN0YXRlLT5iYXNlLmZiLT5mb3JtYXQtPmNwcFswXTsK
KwljcHAgPSBwc3RhdGUtPmJhc2UuZmItPmZvcm1hdC0+YnBwWzBdIC8gODsKIAogCXJldHVybiBp
bGtfd21fbWV0aG9kMihjc3RhdGUtPnBpeGVsX3JhdGUsCiAJCQkgICAgICBjc3RhdGUtPmJhc2Uu
YWRqdXN0ZWRfbW9kZS5jcnRjX2h0b3RhbCwKQEAgLTI1ODEsNyArMjU4MSw3IEBAIHN0YXRpYyB1
MzIgaWxrX2NvbXB1dGVfZmJjX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3Rh
dGUsCiAJaWYgKCFpbnRlbF93bV9wbGFuZV92aXNpYmxlKGNzdGF0ZSwgcHN0YXRlKSkKIAkJcmV0
dXJuIDA7CiAKLQljcHAgPSBwc3RhdGUtPmJhc2UuZmItPmZvcm1hdC0+Y3BwWzBdOworCWNwcCA9
IHBzdGF0ZS0+YmFzZS5mYi0+Zm9ybWF0LT5icHBbMF0gLyA4OwogCiAJcmV0dXJuIGlsa193bV9m
YmMocHJpX3ZhbCwgZHJtX3JlY3Rfd2lkdGgoJnBzdGF0ZS0+YmFzZS5kc3QpLCBjcHApOwogfQpA
QCAtNDE2OCw3ICs0MTY4LDcgQEAgaW50IHNrbF9jaGVja19waXBlX21heF9waXhlbF9yYXRlKHN0
cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjLAogCQlpbnRlbF9wc3RhdGUgPSB0b19pbnRlbF9w
bGFuZV9zdGF0ZShwc3RhdGUpOwogCQlwbGFuZV9kb3duc2NhbGUgPSBza2xfcGxhbmVfZG93bnNj
YWxlX2Ftb3VudChjc3RhdGUsCiAJCQkJCQkJICAgICBpbnRlbF9wc3RhdGUpOwotCQlicHAgPSBw
c3RhdGUtPmZiLT5mb3JtYXQtPmNwcFswXSAqIDg7CisJCWJwcCA9IHBzdGF0ZS0+ZmItPmZvcm1h
dC0+YnBwWzBdOwogCQlpZiAoYnBwID09IDY0KQogCQkJcGxhbmVfZG93bnNjYWxlID0gbXVsX2Zp
eGVkMTYocGxhbmVfZG93bnNjYWxlLAogCQkJCQkJICAgICAgZnBfOV9kaXZfOCk7CkBAIC00MjQw
LDcgKzQyNDAsNyBAQCBza2xfcGxhbmVfcmVsYXRpdmVfZGF0YV9yYXRlKGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjc3RhdGUsCiAKIAlyYXRlID0gbXVsX3JvdW5kX3VwX3UzMl9maXhl
ZDE2KGRhdGFfcmF0ZSwgZG93bl9zY2FsZV9hbW91bnQpOwogCi0JcmF0ZSAqPSBmYi0+Zm9ybWF0
LT5jcHBbcGxhbmVdOworCXJhdGUgKj0gZmItPmZvcm1hdC0+YnBwW3BsYW5lXSAvIDg7CiAJcmV0
dXJuIHJhdGU7CiB9CiAKQEAgLTQ2NzEsNyArNDY3MSw3IEBAIHNrbF9jb21wdXRlX3dtX3BhcmFt
cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAlpZiAoY29sb3Jf
cGxhbmUgPT0gMSAmJiB3cC0+aXNfcGxhbmFyKQogCQl3cC0+d2lkdGggLz0gMjsKIAotCXdwLT5j
cHAgPSBmb3JtYXQtPmNwcFtjb2xvcl9wbGFuZV07CisJd3AtPmNwcCA9IGZvcm1hdC0+YnBwW2Nv
bG9yX3BsYW5lXSAvIDg7CiAJd3AtPnBsYW5lX3BpeGVsX3JhdGUgPSBwbGFuZV9waXhlbF9yYXRl
OwogCiAJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEgJiYKLS0gCjIuNy40CgoKCl9fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWls
aW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZy
ZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
