Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 757D636F7CD
	for <lists+dri-devel@lfdr.de>; Fri, 30 Apr 2021 11:25:16 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 963F66F503;
	Fri, 30 Apr 2021 09:25:12 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ej1-x634.google.com (mail-ej1-x634.google.com
 [IPv6:2a00:1450:4864:20::634])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 84E796F503
 for <dri-devel@lists.freedesktop.org>; Fri, 30 Apr 2021 09:25:11 +0000 (UTC)
Received: by mail-ej1-x634.google.com with SMTP id f24so5677074ejc.6
 for <dri-devel@lists.freedesktop.org>; Fri, 30 Apr 2021 02:25:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=P4e0Y6+hS4/K3bhBW/GEn8l7kXdxRUpzJe3iWfonmPI=;
 b=bN+rvQ+EZVIs37ULX/Wxq+iagkQeoveQOYYwYvlMQTWeyOicaz0uXPLdgDCSf5Ss8x
 JYE7K4zuSPMID/G8hCw1hoJmxX6V8XPTLbdoNh6E6Gyn+xTQsokYlfqg7sQjiZVdc4Nk
 keEUQSFk2FSnQx+37t6FzeD7BmAwuo1ifZ9zDz84OOKuH+U659DV5OWDQTqK+EeVBCqV
 g/F7jVY2JKgtky7xYBaavjUSrHPd9aMpZ9yOnroOkVgMOUmCVB9iGT+uGWbo3Zdoz8xK
 +rZH2bVFrXj7WSHGh11jLKYwjwx2g+qRrQoEjFKjbjHVSPYhVkYUFh5ibGovxwopMpfL
 Izhw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=P4e0Y6+hS4/K3bhBW/GEn8l7kXdxRUpzJe3iWfonmPI=;
 b=J55EG6rMvWcEhQgsmKkDyLn4xnLJabq254sDANAFVpBcGFJzsPbuelHK42d+X4sM8M
 uJv6qxOV0OYGTfBuW6MLwtjAYQIwHm7m2ziXziLuJpsNjaPdqNcbNOyLa15NRqWtMmUp
 s+RJvyeuNNzsJNE4v3XcMacIFG9ek2Xnk2cW5SXqlQtiz3l6nLbkyG95ZnZvma4TADA4
 SFkGeABuHS+37Vpoh1iDQ06pst1+HjfU0lXgjm2GI5gjLZkbzg3p1cKjP0rcO0EdrOUB
 p/NNRrMCJ6rWqYKRhGE+q1VJmjzhSpoVzkESFe7fufL1JkOhqQm4TawgkCKSoihF95tE
 jXwA==
X-Gm-Message-State: AOAM530RPidIEonJsYsujkWTH4tnzTVK0XWvtxDiw3vgpfzB9pQJVDJr
 BRMyCCEMJZn0cYpYmbuzUSyduIGSDSo=
X-Google-Smtp-Source: ABdhPJxAFlmmVjQA2Zs15vq4kgy4D0lzyX4FeG4hGCxYlGMF/SLah5toxg99niZbwt8Kyf3ayzYabg==
X-Received: by 2002:a17:906:7ac9:: with SMTP id
 k9mr3290062ejo.229.1619774710164; 
 Fri, 30 Apr 2021 02:25:10 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:d08c:9633:b7a2:37e2])
 by smtp.gmail.com with ESMTPSA id h23sm1550959ejx.90.2021.04.30.02.25.09
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 30 Apr 2021 02:25:09 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 01/13] drm/ttm: add ttm_sys_manager v2
Date: Fri, 30 Apr 2021 11:24:56 +0200
Message-Id: <20210430092508.60710-1-christian.koenig@amd.com>
X-Mailer: git-send-email 2.25.1
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: daniel.vetter@ffwll.ch, matthew.william.auld@gmail.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIGEgc2VwYXJhdGUgbWFuYWdlciBmb3IgdGhlIHN5c3RlbSBkb21haW4gYW5kIG1ha2UgZnVu
Y3Rpb24gdGFibGVzCm1hbmRhdG9yeS4KCnYyOiBkZWJ1ZyBpcyBzdGlsbCBvcHRpb25hbAoKU2ln
bmVkLW9mZi1ieTogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0aWFuLmtvZW5pZ0BhbWQuY29tPgot
LS0KIGRyaXZlcnMvZ3B1L2RybS90dG0vTWFrZWZpbGUgICAgICAgICAgfCAgMiArLQogZHJpdmVy
cy9ncHUvZHJtL3R0bS90dG1fZGV2aWNlLmMgICAgICB8IDE3ICstLS0tLS0tLS0tLQogZHJpdmVy
cy9ncHUvZHJtL3R0bS90dG1fbW9kdWxlLmggICAgICB8ICAzICsrCiBkcml2ZXJzL2dwdS9kcm0v
dHRtL3R0bV9yZXNvdXJjZS5jICAgIHwgMTEgKystLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS90dG0v
dHRtX3N5c19tYW5hZ2VyLmMgfCA0MCArKysrKysrKysrKysrKysrKysrKysrKysrKysKIDUgZmls
ZXMgY2hhbmdlZCwgNDggaW5zZXJ0aW9ucygrKSwgMjUgZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fc3lzX21hbmFnZXIuYwoKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS90dG0vTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL01h
a2VmaWxlCmluZGV4IDQwZTVlOWRhNzk1My4uZjkwNmIyMjk1OWNmIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vdHRtL01ha2VmaWxlCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vTWFrZWZp
bGUKQEAgLTQsNyArNCw3IEBACiAKIHR0bS15IDo9IHR0bV90dC5vIHR0bV9iby5vIHR0bV9ib191
dGlsLm8gdHRtX2JvX3ZtLm8gdHRtX21vZHVsZS5vIFwKIAl0dG1fZXhlY2J1Zl91dGlsLm8gdHRt
X3JhbmdlX21hbmFnZXIubyB0dG1fcmVzb3VyY2UubyB0dG1fcG9vbC5vIFwKLQl0dG1fZGV2aWNl
Lm8KKwl0dG1fZGV2aWNlLm8gdHRtX3N5c19tYW5hZ2VyLm8KIHR0bS0kKENPTkZJR19BR1ApICs9
IHR0bV9hZ3BfYmFja2VuZC5vCiAKIG9iai0kKENPTkZJR19EUk1fVFRNKSArPSB0dG0ubwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fZGV2aWNlLmMgYi9kcml2ZXJzL2dwdS9k
cm0vdHRtL3R0bV9kZXZpY2UuYwppbmRleCBiMTY5ZTlhNGY1ZDQuLjQ2MDk1M2RjYWQxMSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fZGV2aWNlLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL3R0bS90dG1fZGV2aWNlLmMKQEAgLTE2NSwyMSArMTY1LDYgQEAgaW50IHR0bV9kZXZp
Y2Vfc3dhcG91dChzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV9vcGVyYXRpb25f
Y3R4ICpjdHgsCiB9CiBFWFBPUlRfU1lNQk9MKHR0bV9kZXZpY2Vfc3dhcG91dCk7CiAKLXN0YXRp
YyB2b2lkIHR0bV9pbml0X3N5c21hbihzdHJ1Y3QgdHRtX2RldmljZSAqYmRldikKLXsKLQlzdHJ1
Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiA9ICZiZGV2LT5zeXNtYW47Ci0KLQkvKgotCSAq
IEluaXRpYWxpemUgdGhlIHN5c3RlbSBtZW1vcnkgYnVmZmVyIHR5cGUuCi0JICogT3RoZXIgdHlw
ZXMgbmVlZCB0byBiZSBkcml2ZXIgLyBJT0NUTCBpbml0aWFsaXplZC4KLQkgKi8KLQltYW4tPnVz
ZV90dCA9IHRydWU7Ci0KLQl0dG1fcmVzb3VyY2VfbWFuYWdlcl9pbml0KG1hbiwgMCk7Ci0JdHRt
X3NldF9kcml2ZXJfbWFuYWdlcihiZGV2LCBUVE1fUExfU1lTVEVNLCBtYW4pOwotCXR0bV9yZXNv
dXJjZV9tYW5hZ2VyX3NldF91c2VkKG1hbiwgdHJ1ZSk7Ci19Ci0KIHN0YXRpYyB2b2lkIHR0bV9k
ZXZpY2VfZGVsYXllZF93b3JrcXVldWUoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQogewogCXN0
cnVjdCB0dG1fZGV2aWNlICpiZGV2ID0KQEAgLTIyMiw3ICsyMDcsNyBAQCBpbnQgdHRtX2Rldmlj
ZV9pbml0KHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LCBzdHJ1Y3QgdHRtX2RldmljZV9mdW5jcyAq
ZnVuY3MsCiAKIAliZGV2LT5mdW5jcyA9IGZ1bmNzOwogCi0JdHRtX2luaXRfc3lzbWFuKGJkZXYp
OworCXR0bV9zeXNfbWFuX2luaXQoYmRldik7CiAJdHRtX3Bvb2xfaW5pdCgmYmRldi0+cG9vbCwg
ZGV2LCB1c2VfZG1hX2FsbG9jLCB1c2VfZG1hMzIpOwogCiAJYmRldi0+dm1hX21hbmFnZXIgPSB2
bWFfbWFuYWdlcjsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX21vZHVsZS5o
IGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fbW9kdWxlLmgKaW5kZXggZDdjYWM1ZDRiODM1Li4y
NjU2NGE5ODk1OGYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX21vZHVsZS5o
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX21vZHVsZS5oCkBAIC0zNCw3ICszNCwxMCBA
QAogI2RlZmluZSBUVE1fUEZYICJbVFRNXSAiCiAKIHN0cnVjdCBkZW50cnk7CitzdHJ1Y3QgdHRt
X2RldmljZTsKIAogZXh0ZXJuIHN0cnVjdCBkZW50cnkgKnR0bV9kZWJ1Z2ZzX3Jvb3Q7CiAKK2lu
dCB0dG1fc3lzX21hbl9pbml0KHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2KTsKKwogI2VuZGlmIC8q
IF9UVE1fTU9EVUxFX0hfICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9y
ZXNvdXJjZS5jIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fcmVzb3VyY2UuYwppbmRleCAwNGYy
ZWVmNjUzYWIuLmZjMzUxNzAwZDAzNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0bS90
dG1fcmVzb3VyY2UuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9yZXNvdXJjZS5jCkBA
IC0zMyw5ICszMyw2IEBAIGludCB0dG1fcmVzb3VyY2VfYWxsb2Moc3RydWN0IHR0bV9idWZmZXJf
b2JqZWN0ICpibywKIAkJdHRtX21hbmFnZXJfdHlwZShiby0+YmRldiwgcmVzLT5tZW1fdHlwZSk7
CiAKIAlyZXMtPm1tX25vZGUgPSBOVUxMOwotCWlmICghbWFuLT5mdW5jIHx8ICFtYW4tPmZ1bmMt
PmFsbG9jKQotCQlyZXR1cm4gMDsKLQogCXJldHVybiBtYW4tPmZ1bmMtPmFsbG9jKG1hbiwgYm8s
IHBsYWNlLCByZXMpOwogfQogCkBAIC00NCw5ICs0MSw3IEBAIHZvaWQgdHRtX3Jlc291cmNlX2Zy
ZWUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywgc3RydWN0IHR0bV9yZXNvdXJjZSAqcmVz
KQogCXN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuID0KIAkJdHRtX21hbmFnZXJfdHlw
ZShiby0+YmRldiwgcmVzLT5tZW1fdHlwZSk7CiAKLQlpZiAobWFuLT5mdW5jICYmIG1hbi0+ZnVu
Yy0+ZnJlZSkKLQkJbWFuLT5mdW5jLT5mcmVlKG1hbiwgcmVzKTsKLQorCW1hbi0+ZnVuYy0+ZnJl
ZShtYW4sIHJlcyk7CiAJcmVzLT5tbV9ub2RlID0gTlVMTDsKIAlyZXMtPm1lbV90eXBlID0gVFRN
X1BMX1NZU1RFTTsKIH0KQEAgLTEzOSw3ICsxMzQsNyBAQCB2b2lkIHR0bV9yZXNvdXJjZV9tYW5h
Z2VyX2RlYnVnKHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuLAogCWRybV9wcmludGYo
cCwgIiAgdXNlX3R5cGU6ICVkXG4iLCBtYW4tPnVzZV90eXBlKTsKIAlkcm1fcHJpbnRmKHAsICIg
IHVzZV90dDogJWRcbiIsIG1hbi0+dXNlX3R0KTsKIAlkcm1fcHJpbnRmKHAsICIgIHNpemU6ICVs
bHVcbiIsIG1hbi0+c2l6ZSk7Ci0JaWYgKG1hbi0+ZnVuYyAmJiBtYW4tPmZ1bmMtPmRlYnVnKQot
CQkoKm1hbi0+ZnVuYy0+ZGVidWcpKG1hbiwgcCk7CisJaWYgKG1hbi0+ZnVuYy0+ZGVidWcpCisJ
CW1hbi0+ZnVuYy0+ZGVidWcobWFuLCBwKTsKIH0KIEVYUE9SVF9TWU1CT0wodHRtX3Jlc291cmNl
X21hbmFnZXJfZGVidWcpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fc3lz
X21hbmFnZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3N5c19tYW5hZ2VyLmMKbmV3IGZp
bGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5lZDkyNjE1MjE0ZTMKLS0tIC9kZXYv
bnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9zeXNfbWFuYWdlci5jCkBAIC0wLDAg
KzEsNDAgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wIE9SIE1JVCAqLwor
CisjaW5jbHVkZSA8ZHJtL3R0bS90dG1fcmVzb3VyY2UuaD4KKyNpbmNsdWRlIDxkcm0vdHRtL3R0
bV9kZXZpY2UuaD4KKyNpbmNsdWRlIDxkcm0vdHRtL3R0bV9wbGFjZW1lbnQuaD4KKworc3RhdGlj
IGludCB0dG1fc3lzX21hbl9hbGxvYyhzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiwK
KwkJCSAgICAgc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKKwkJCSAgICAgY29uc3Qgc3Ry
dWN0IHR0bV9wbGFjZSAqcGxhY2UsCisJCQkgICAgIHN0cnVjdCB0dG1fcmVzb3VyY2UgKm1lbSkK
K3sKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgdHRtX3N5c19tYW5fZnJlZShzdHJ1Y3Qg
dHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiwKKwkJCSAgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAq
bWVtKQoreworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyX2Z1
bmMgdHRtX3N5c19tYW5hZ2VyX2Z1bmMgPSB7CisJLmFsbG9jID0gdHRtX3N5c19tYW5fYWxsb2Ms
CisJLmZyZWUgPSB0dG1fc3lzX21hbl9mcmVlLAorfTsKKworaW50IHR0bV9zeXNfbWFuX2luaXQo
c3RydWN0IHR0bV9kZXZpY2UgKmJkZXYpCit7CisJc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2Vy
ICptYW4gPSAmYmRldi0+c3lzbWFuOworCisJLyoKKwkgKiBJbml0aWFsaXplIHRoZSBzeXN0ZW0g
bWVtb3J5IGJ1ZmZlciB0eXBlLgorCSAqIE90aGVyIHR5cGVzIG5lZWQgdG8gYmUgZHJpdmVyIC8g
SU9DVEwgaW5pdGlhbGl6ZWQuCisJICovCisJbWFuLT51c2VfdHQgPSB0cnVlOworCW1hbi0+ZnVu
YyA9ICZ0dG1fc3lzX21hbmFnZXJfZnVuYzsKKworCXR0bV9yZXNvdXJjZV9tYW5hZ2VyX2luaXQo
bWFuLCAwKTsKKwl0dG1fc2V0X2RyaXZlcl9tYW5hZ2VyKGJkZXYsIFRUTV9QTF9TWVNURU0sIG1h
bik7CisJdHRtX3Jlc291cmNlX21hbmFnZXJfc2V0X3VzZWQobWFuLCB0cnVlKTsKKwlyZXR1cm4g
MDsKK30KLS0gCjIuMjUuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0
b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJp
LWRldmVsCg==
