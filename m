Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8CCD449223
	for <lists+dri-devel@lfdr.de>; Mon, 17 Jun 2019 23:10:21 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2EC5B6E0B4;
	Mon, 17 Jun 2019 21:10:17 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from perceval.ideasonboard.com (perceval.ideasonboard.com
 [213.167.242.64])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0A9716E0AC
 for <dri-devel@lists.freedesktop.org>; Mon, 17 Jun 2019 21:10:00 +0000 (UTC)
Received: from pendragon.bb.dnainternet.fi
 (dfj612yhrgyx302h3jwwy-3.rev.dnainternet.fi
 [IPv6:2001:14ba:21f5:5b00:ce28:277f:58d7:3ca4])
 by perceval.ideasonboard.com (Postfix) with ESMTPSA id C7F751217;
 Mon, 17 Jun 2019 23:09:55 +0200 (CEST)
From: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v3 09/10] drm: rcar-du: Perform group setup from the atomic
 tail handler
Date: Tue, 18 Jun 2019 00:09:29 +0300
Message-Id: <20190617210930.6054-10-laurent.pinchart+renesas@ideasonboard.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190617210930.6054-1-laurent.pinchart+renesas@ideasonboard.com>
References: <20190617210930.6054-1-laurent.pinchart+renesas@ideasonboard.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=ideasonboard.com; s=mail; t=1560805796;
 bh=09tZsVSx072b7Ql590jhy7bvmtHSpCR6J3rF+0Dhypo=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=DFI49PEZyLKX0TsHJePcfOSDZiPX0rPBA4VnLL7ULo5M4VYHc1KiI6nW9BlP1hPBK
 E8Xu2i7xEEdJov67vNs0K6zmqRyLHze6tLPW3J97HVgXtXVCK7kR02CC8qfgh6AZK+
 u6TM/e7hDvo0DQISAoHbZE7kMQ0cxPg5dQgJ2VDE=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: linux-renesas-soc@vger.kernel.org,
 Kieran Bingham <kieran.bingham@ideasonboard.com>, linux-media@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogS2llcmFuIEJpbmdoYW0gPGtpZXJhbi5iaW5naGFtK3JlbmVzYXNAaWRlYXNvbmJvYXJk
LmNvbT4KCkNyZWF0ZSByY2FyX2R1X2dyb3VwX2F0b21pY19jaGVjaygpIGFuZCByY2FyX2R1X2dy
b3VwX2F0b21pY19zZXR1cCgpCmZ1bmN0aW9ucyB0byB0cmFjayBhbmQgYXBwbHkgZ3JvdXAgc3Rh
dGUgdGhyb3VnaCB0aGUgRFJNIGF0b21pYyBzdGF0ZS4KVGhlIHVzZV9jb3VudCBmaWVsZCBpcyBt
b3ZlZCBmcm9tIHRoZSByY2FyX2R1X2dyb3VwIHN0cnVjdHVyZSB0byBhbgplbmFibGVkIGZpZWxk
IGluIHRoZSByY2FyX2R1X2dyb3VwX3N0YXRlIHN0cnVjdHVyZS4KClRoaXMgYWxsb3dzIHNlcGFy
YXRpbmcgZ3JvdXAgc2V0dXAgZnJvbSB0aGUgY29uZmlndXJhdGlvbiBvZiB0aGUgQ1JUQ3MKdGhh
dCBhcmUgcGFydCBvZiB0aGUgZ3JvdXAsIHNpbXBsaWZ5aW5nIHRoZSBDUlRDIGNvZGUgYW5kIGlt
cHJvdmluZwpvdmVyYWxsIHJlYWRhYmlsaXR5LiBUaGUgZXhpc3RpbmcgcmNhcl9kdV9ncm91cF97
Z2V0LHB1dH0oKSBmdW5jdGlvbnMKYXJlIG5vdyByZWR1bmRhbnQgYW5kIHJlbW92ZWQuCgpUaGUg
Z3JvdXBzIHNoYXJlIGNsb2NraW5nIHdpdGggdGhlIENSVENzIHdpdGhpbiB0aGUgZ3JvdXAsIGFu
ZCBzbyBhcmUKYWNjZXNzaWJsZSBvbmx5IHdoZW4gb25lIG9mIGl0cyBDUlRDcyBoYXMgYmVlbiBw
b3dlcmVkIHRocm91Z2gKcmNhcl9kdV9jcnRjX2F0b21pY19leGl0X3N0YW5kYnkoKS4KClNpZ25l
ZC1vZmYtYnk6IEtpZXJhbiBCaW5naGFtIDxraWVyYW4uYmluZ2hhbStyZW5lc2FzQGlkZWFzb25i
b2FyZC5jb20+ClNpZ25lZC1vZmYtYnk6IExhdXJlbnQgUGluY2hhcnQgPGxhdXJlbnQucGluY2hh
cnQrcmVuZXNhc0BpZGVhc29uYm9hcmQuY29tPgotLS0KQ2hhbmdlcyBzaW5jZSB2MjoKCi0gU2lt
cGxpZnkgZXJyb3IgaGFuZGxpbmcgaW4gcmNhcl9kdV9jcnRjX2VuYWJsZSgpCi0gUmVuYW1lIHJj
YXJfZHVfZ3JvdXBfYXRvbWljX3ByZV9jb21taXQoKSB0bwogIHJjYXJfZHVfZ3JvdXBfYXRvbWlj
X3NldHVwKCkgYW5kIHR1cm4gaXQgaW50byBhIHZvaWQgZnVuY3Rpb24KLSBSZW1vdmUgcmNhcl9k
dV9ncm91cF9hdG9taWNfcG9zdF9jb21taXQoKQotIFJlcGxhY2UgZ3JvdXAgc3RhdGUgdXNlX2Nv
dW50IGZpZWxkIGJ5IGVuYWJsZWQKLSBSZW5hbWUgZ3JvdXAgc3RhdGUgdmFyaWFibGUgZnJvbSBy
c3RhdGUgdG8gZ3N0YXRlCgpDaGFuZ2VzIHNpbmNlIHYxOgoKLSBBbGwgcmVnaXN0ZXIgc2VxdWVu
Y2VzIG5vdyBtYWludGFpbmVkLgotIENsb2NrIG1hbmFnZW1lbnQgaXMgbm8gbG9uZ2VyIGhhbmRs
ZWQgYnkgdGhlIGdyb3VwCiAgKF9jcnRjX3tleGl0LGVudGVyfV9zdGFuZGJ5IGhhbmRsZXMgdGhp
cyBmb3IgdXMpCi0tLQogZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9jcnRjLmMgIHwg
MTggKystLS0KIGRyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfZ3JvdXAuYyB8IDkxICsr
KysrKysrKysrKysrKystLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVf
Z3JvdXAuaCB8IDEyICsrLS0KIGRyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfa21zLmMg
ICB8ICA1ICsrCiA0IGZpbGVzIGNoYW5nZWQsIDc2IGluc2VydGlvbnMoKyksIDUwIGRlbGV0aW9u
cygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfY3J0Yy5j
IGIvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9jcnRjLmMKaW5kZXggZDExYTQ3NGY2
ZjcyLi5hYjVjMjg4ZjlkMDkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3Jj
YXJfZHVfY3J0Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfY3J0Yy5j
CkBAIC00ODcsMTIgKzQ4NywxMCBAQCBzdGF0aWMgaW50IHJjYXJfZHVfY3J0Y19leGl0X3N0YW5k
Ynkoc3RydWN0IHJjYXJfZHVfY3J0YyAqcmNydGMpCiAJCXJldHVybiByZXQ7CiAKIAlyZXQgPSBj
bGtfcHJlcGFyZV9lbmFibGUocmNydGMtPmV4dGNsb2NrKTsKLQlpZiAocmV0IDwgMCkKLQkJZ290
byBlcnJvcl9jbG9jazsKLQotCXJldCA9IHJjYXJfZHVfZ3JvdXBfZ2V0KHJjcnRjLT5ncm91cCk7
Ci0JaWYgKHJldCA8IDApCi0JCWdvdG8gZXJyb3JfZ3JvdXA7CisJaWYgKHJldCA8IDApIHsKKwkJ
Y2xrX2Rpc2FibGVfdW5wcmVwYXJlKHJjcnRjLT5jbG9jayk7CisJCXJldHVybiByZXQ7CisJfQog
CiAJLyogU2V0IGRpc3BsYXkgb2ZmIGFuZCBiYWNrZ3JvdW5kIHRvIGJsYWNrLiAqLwogCXJjYXJf
ZHVfY3J0Y193cml0ZShyY3J0YywgRE9PUiwgRE9PUl9SR0IoMCwgMCwgMCkpOwpAQCAtNTAyLDE4
ICs1MDAsMTAgQEAgc3RhdGljIGludCByY2FyX2R1X2NydGNfZXhpdF9zdGFuZGJ5KHN0cnVjdCBy
Y2FyX2R1X2NydGMgKnJjcnRjKQogCXJjYXJfZHVfZ3JvdXBfd3JpdGUocmNydGMtPmdyb3VwLCBy
Y3J0Yy0+aW5kZXggJSAyID8gRFMyUFIgOiBEUzFQUiwgMCk7CiAKIAlyZXR1cm4gMDsKLQotZXJy
b3JfZ3JvdXA6Ci0JY2xrX2Rpc2FibGVfdW5wcmVwYXJlKHJjcnRjLT5leHRjbG9jayk7Ci1lcnJv
cl9jbG9jazoKLQljbGtfZGlzYWJsZV91bnByZXBhcmUocmNydGMtPmNsb2NrKTsKLQlyZXR1cm4g
cmV0OwogfQogCiBzdGF0aWMgdm9pZCByY2FyX2R1X2NydGNfZW50ZXJfc3RhbmRieShzdHJ1Y3Qg
cmNhcl9kdV9jcnRjICpyY3J0YykKIHsKLQlyY2FyX2R1X2dyb3VwX3B1dChyY3J0Yy0+Z3JvdXAp
OwotCiAJY2xrX2Rpc2FibGVfdW5wcmVwYXJlKHJjcnRjLT5leHRjbG9jayk7CiAJY2xrX2Rpc2Fi
bGVfdW5wcmVwYXJlKHJjcnRjLT5jbG9jayk7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vcmNhci1kdS9yY2FyX2R1X2dyb3VwLmMgYi9kcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2Fy
X2R1X2dyb3VwLmMKaW5kZXggOGUxMmJkNDI4OTBlLi43YzkxNDU3Nzg1NjcgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfZ3JvdXAuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vcmNhci1kdS9yY2FyX2R1X2dyb3VwLmMKQEAgLTI0LDYgKzI0LDcgQEAKICAqLwogCiAj
aW5jbHVkZSA8bGludXgvY2xrLmg+CisjaW5jbHVkZSA8bGludXgvZXJyLmg+CiAjaW5jbHVkZSA8
bGludXgvaW8uaD4KICNpbmNsdWRlIDxsaW51eC9zbGFiLmg+CiAKQEAgLTE3MywzOCArMTc0LDYg
QEAgc3RhdGljIHZvaWQgcmNhcl9kdV9ncm91cF9zZXR1cChzdHJ1Y3QgcmNhcl9kdV9ncm91cCAq
cmdycCkKIAltdXRleF91bmxvY2soJnJncnAtPmxvY2spOwogfQogCi0vKgotICogcmNhcl9kdV9n
cm91cF9nZXQgLSBBY3F1aXJlIGEgcmVmZXJlbmNlIHRvIHRoZSBEVSBjaGFubmVscyBncm91cAot
ICoKLSAqIEFjcXVpcmluZyB0aGUgZmlyc3QgcmVmZXJlbmNlIHNldHVwcyBjb3JlIHJlZ2lzdGVy
cy4gQSByZWZlcmVuY2UgbXVzdCBiZSBoZWxkCi0gKiBiZWZvcmUgYWNjZXNzaW5nIGFueSBoYXJk
d2FyZSByZWdpc3RlcnMuCi0gKgotICogVGhpcyBmdW5jdGlvbiBtdXN0IGJlIGNhbGxlZCB3aXRo
IHRoZSBEUk0gbW9kZV9jb25maWcgbG9jayBoZWxkLgotICoKLSAqIFJldHVybiAwIGluIGNhc2Ug
b2Ygc3VjY2VzcyBvciBhIG5lZ2F0aXZlIGVycm9yIGNvZGUgb3RoZXJ3aXNlLgotICovCi1pbnQg
cmNhcl9kdV9ncm91cF9nZXQoc3RydWN0IHJjYXJfZHVfZ3JvdXAgKnJncnApCi17Ci0JaWYgKHJn
cnAtPnVzZV9jb3VudCkKLQkJZ290byBkb25lOwotCi0JcmNhcl9kdV9ncm91cF9zZXR1cChyZ3Jw
KTsKLQotZG9uZToKLQlyZ3JwLT51c2VfY291bnQrKzsKLQlyZXR1cm4gMDsKLX0KLQotLyoKLSAq
IHJjYXJfZHVfZ3JvdXBfcHV0IC0gUmVsZWFzZSBhIHJlZmVyZW5jZSB0byB0aGUgRFUKLSAqCi0g
KiBUaGlzIGZ1bmN0aW9uIG11c3QgYmUgY2FsbGVkIHdpdGggdGhlIERSTSBtb2RlX2NvbmZpZyBs
b2NrIGhlbGQuCi0gKi8KLXZvaWQgcmNhcl9kdV9ncm91cF9wdXQoc3RydWN0IHJjYXJfZHVfZ3Jv
dXAgKnJncnApCi17Ci0JLS1yZ3JwLT51c2VfY291bnQ7Ci19Ci0KIHN0YXRpYyB2b2lkIF9fcmNh
cl9kdV9ncm91cF9zdGFydF9zdG9wKHN0cnVjdCByY2FyX2R1X2dyb3VwICpyZ3JwLCBib29sIHN0
YXJ0KQogewogCXN0cnVjdCByY2FyX2R1X2RldmljZSAqcmNkdSA9IHJncnAtPmRldjsKQEAgLTM4
OSw2ICszNTgsMjMgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fcHJpdmF0ZV9zdGF0ZV9mdW5j
cyByY2FyX2R1X2dyb3VwX3N0YXRlX2Z1bmNzID0gewogCS5hdG9taWNfZGVzdHJveV9zdGF0ZSA9
IHJjYXJfZHVfZ3JvdXBfYXRvbWljX2Rlc3Ryb3lfc3RhdGUsCiB9OwogCisjZGVmaW5lIGZvcl9l
YWNoX29sZG5ld19ncm91cF9pbl9zdGF0ZShfX3N0YXRlLCBfX29iaiwgX19vbGRfc3RhdGUsIF9f
bmV3X3N0YXRlLCBfX2kpIFwKKwlmb3JfZWFjaF9vbGRuZXdfcHJpdmF0ZV9vYmpfaW5fc3RhdGUo
KF9fc3RhdGUpLCAoX19vYmopLCAoX19vbGRfc3RhdGUpLCAoX19uZXdfc3RhdGUpLCAoX19pKSkg
XAorCQlmb3JfZWFjaF9pZigoX19vYmopLT5mdW5jcyA9PSAmcmNhcl9kdV9ncm91cF9zdGF0ZV9m
dW5jcykKKworc3RhdGljIHN0cnVjdCByY2FyX2R1X2dyb3VwX3N0YXRlICoKK3JjYXJfZHVfZ2V0
X2dyb3VwX3N0YXRlKHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSwKKwkJCXN0cnVjdCBy
Y2FyX2R1X2dyb3VwICpyZ3JwKQoreworCXN0cnVjdCBkcm1fcHJpdmF0ZV9zdGF0ZSAqcHN0YXRl
OworCisJcHN0YXRlID0gZHJtX2F0b21pY19nZXRfcHJpdmF0ZV9vYmpfc3RhdGUoc3RhdGUsICZy
Z3JwLT5wcml2YXRlKTsKKwlpZiAoSVNfRVJSKHBzdGF0ZSkpCisJCXJldHVybiBFUlJfQ0FTVChw
c3RhdGUpOworCisJcmV0dXJuIHRvX3JjYXJfZ3JvdXBfc3RhdGUocHN0YXRlKTsKK30KKwogLyoq
CiAgKiByY2FyX2R1X2dldF9vbGRfZ3JvdXBfc3RhdGUgLSBnZXQgb2xkIGdyb3VwIHN0YXRlLCBp
ZiBpdCBleGlzdHMKICAqIEBzdGF0ZTogZ2xvYmFsIGF0b21pYyBzdGF0ZSBvYmplY3QKQEAgLTQ0
MSw2ICs0MjcsNDcgQEAgcmNhcl9kdV9nZXRfbmV3X2dyb3VwX3N0YXRlKHN0cnVjdCBkcm1fYXRv
bWljX3N0YXRlICpzdGF0ZSwKIAlyZXR1cm4gTlVMTDsKIH0KIAoraW50IHJjYXJfZHVfZ3JvdXBf
YXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCisJCQkgICAgICAgc3RydWN0IGRy
bV9hdG9taWNfc3RhdGUgKnN0YXRlKQoreworCXN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZTsKKwlzdHJ1Y3QgZHJtX2NydGMgKmNydGM7CisJdW5zaWduZWQgaW50IGk7CisKKwlmb3Jf
ZWFjaF9uZXdfY3J0Y19pbl9zdGF0ZShzdGF0ZSwgY3J0YywgY3J0Y19zdGF0ZSwgaSkgeworCQlz
dHJ1Y3QgcmNhcl9kdV9jcnRjICpyY3J0YyA9IHRvX3JjYXJfY3J0YyhjcnRjKTsKKwkJc3RydWN0
IHJjYXJfZHVfZ3JvdXBfc3RhdGUgKmdzdGF0ZTsKKworCQlnc3RhdGUgPSByY2FyX2R1X2dldF9n
cm91cF9zdGF0ZShzdGF0ZSwgcmNydGMtPmdyb3VwKTsKKwkJaWYgKElTX0VSUihnc3RhdGUpKQor
CQkJcmV0dXJuIFBUUl9FUlIoZ3N0YXRlKTsKKworCQlpZiAoY3J0Y19zdGF0ZS0+YWN0aXZlKQor
CQkJZ3N0YXRlLT5lbmFibGVkID0gdHJ1ZTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKwordm9pZCBy
Y2FyX2R1X2dyb3VwX2F0b21pY19zZXR1cChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAorCQkJCXN0
cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKK3sKKwlzdHJ1Y3QgZHJtX3ByaXZhdGVfc3Rh
dGUgKm9sZF9wc3RhdGUsICpuZXdfcHN0YXRlOworCXN0cnVjdCBkcm1fcHJpdmF0ZV9vYmogKm9i
ajsKKwl1bnNpZ25lZCBpbnQgaTsKKworCWZvcl9lYWNoX29sZG5ld19ncm91cF9pbl9zdGF0ZShz
dGF0ZSwgb2JqLCBvbGRfcHN0YXRlLCBuZXdfcHN0YXRlLCBpKSB7CisJCXN0cnVjdCByY2FyX2R1
X2dyb3VwICpyZ3JwID0gdG9fcmNhcl9ncm91cChvYmopOworCQlzdHJ1Y3QgcmNhcl9kdV9ncm91
cF9zdGF0ZSAqb2xkX3N0YXRlLCAqbmV3X3N0YXRlOworCisJCW9sZF9zdGF0ZSA9IHRvX3JjYXJf
Z3JvdXBfc3RhdGUob2xkX3BzdGF0ZSk7CisJCW5ld19zdGF0ZSA9IHRvX3JjYXJfZ3JvdXBfc3Rh
dGUobmV3X3BzdGF0ZSk7CisKKwkJaWYgKCFvbGRfc3RhdGUtPmVuYWJsZWQgJiYgbmV3X3N0YXRl
LT5lbmFibGVkKQorCQkJcmNhcl9kdV9ncm91cF9zZXR1cChyZ3JwKTsKKwl9Cit9CisKIC8qIC0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tCiAgKiBJbml0IGFuZCBDbGVhbnVwCiAgKi8KZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfZ3JvdXAuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9yY2FyLWR1L3JjYXJfZHVfZ3JvdXAuaAppbmRleCBmOTk2MWY4OWZkOTcuLjIwZWZkMjI1MWVj
NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9ncm91cC5oCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfZ3JvdXAuaApAQCAtMjYsNyArMjYs
NiBAQCBzdHJ1Y3QgcmNhcl9kdV9kZXZpY2U7CiAgKiBAaW5kZXg6IGdyb3VwIGluZGV4CiAgKiBA
Y2hhbm5lbHNfbWFzazogYml0bWFzayBvZiBwb3B1bGF0ZWQgRFUgY2hhbm5lbHMgaW4gdGhpcyBn
cm91cAogICogQG51bV9jcnRjczogbnVtYmVyIG9mIENSVENzIGluIHRoaXMgZ3JvdXAgKDEgb3Ig
MikKLSAqIEB1c2VfY291bnQ6IG51bWJlciBvZiB1c2VycyBvZiB0aGUgZ3JvdXAgKHJjYXJfZHVf
Z3JvdXBfKGdldHxwdXQpKQogICogQHVzZWRfY3J0Y3M6IG51bWJlciBvZiBDUlRDcyBjdXJyZW50
bHkgaW4gdXNlCiAgKiBAbG9jazogcHJvdGVjdHMgdGhlIGRwdHNyX3BsYW5lcyBmaWVsZCBhbmQg
dGhlIERQVFNSIHJlZ2lzdGVyCiAgKiBAZHB0c3JfcGxhbmVzOiBiaXRtYXNrIG9mIHBsYW5lcyBk
cml2ZW4gYnkgZG90LWNsb2NrIGFuZCB0aW1pbmcgZ2VuZXJhdG9yIDEKQEAgLTQzLDcgKzQyLDYg
QEAgc3RydWN0IHJjYXJfZHVfZ3JvdXAgewogCiAJdW5zaWduZWQgaW50IGNoYW5uZWxzX21hc2s7
CiAJdW5zaWduZWQgaW50IG51bV9jcnRjczsKLQl1bnNpZ25lZCBpbnQgdXNlX2NvdW50OwogCXVu
c2lnbmVkIGludCB1c2VkX2NydGNzOwogCiAJc3RydWN0IG11dGV4IGxvY2s7CkBAIC01OSw5ICs1
NywxMiBAQCBzdHJ1Y3QgcmNhcl9kdV9ncm91cCB7CiAvKioKICAqIHN0cnVjdCByY2FyX2R1X2dy
b3VwX3N0YXRlIC0gRHJpdmVyLXNwZWNpZmljIGdyb3VwIHN0YXRlCiAgKiBAc3RhdGU6IGJhc2Ug
RFJNIHByaXZhdGUgc3RhdGUKKyAqIEBlbmFibGVkOiB0cnVlIGlmIGF0IGxlYXN0IG9uZSBDUlRD
IGluIHRoZSBncm91cCBpcyBlbmFibGVkCiAgKi8KIHN0cnVjdCByY2FyX2R1X2dyb3VwX3N0YXRl
IHsKIAlzdHJ1Y3QgZHJtX3ByaXZhdGVfc3RhdGUgc3RhdGU7CisKKwlib29sIGVuYWJsZWQ7CiB9
OwogCiAjZGVmaW5lIHRvX3JjYXJfZ3JvdXBfc3RhdGUocykgXApAQCAtNzAsOCArNzEsNiBAQCBz
dHJ1Y3QgcmNhcl9kdV9ncm91cF9zdGF0ZSB7CiB1MzIgcmNhcl9kdV9ncm91cF9yZWFkKHN0cnVj
dCByY2FyX2R1X2dyb3VwICpyZ3JwLCB1MzIgcmVnKTsKIHZvaWQgcmNhcl9kdV9ncm91cF93cml0
ZShzdHJ1Y3QgcmNhcl9kdV9ncm91cCAqcmdycCwgdTMyIHJlZywgdTMyIGRhdGEpOwogCi1pbnQg
cmNhcl9kdV9ncm91cF9nZXQoc3RydWN0IHJjYXJfZHVfZ3JvdXAgKnJncnApOwotdm9pZCByY2Fy
X2R1X2dyb3VwX3B1dChzdHJ1Y3QgcmNhcl9kdV9ncm91cCAqcmdycCk7CiB2b2lkIHJjYXJfZHVf
Z3JvdXBfc3RhcnRfc3RvcChzdHJ1Y3QgcmNhcl9kdV9ncm91cCAqcmdycCwgYm9vbCBzdGFydCk7
CiB2b2lkIHJjYXJfZHVfZ3JvdXBfcmVzdGFydChzdHJ1Y3QgcmNhcl9kdV9ncm91cCAqcmdycCk7
CiBpbnQgcmNhcl9kdV9ncm91cF9zZXRfcm91dGluZyhzdHJ1Y3QgcmNhcl9kdV9ncm91cCAqcmdy
cCk7CkBAIC04NSw2ICs4NCwxMSBAQCBzdHJ1Y3QgcmNhcl9kdV9ncm91cF9zdGF0ZSAqCiByY2Fy
X2R1X2dldF9uZXdfZ3JvdXBfc3RhdGUoc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlLAog
CQkJICAgIHN0cnVjdCByY2FyX2R1X2dyb3VwICpyZ3JwKTsKIAoraW50IHJjYXJfZHVfZ3JvdXBf
YXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCisJCQkgICAgICAgc3RydWN0IGRy
bV9hdG9taWNfc3RhdGUgKnN0YXRlKTsKK3ZvaWQgcmNhcl9kdV9ncm91cF9hdG9taWNfc2V0dXAo
c3RydWN0IGRybV9kZXZpY2UgKmRldiwKKwkJCQlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3Rh
dGUpOworCiBpbnQgcmNhcl9kdV9ncm91cF9pbml0KHN0cnVjdCByY2FyX2R1X2RldmljZSAqcmNk
dSwgc3RydWN0IHJjYXJfZHVfZ3JvdXAgKnJncnAsCiAJCSAgICAgICB1bnNpZ25lZCBpbnQgaW5k
ZXgpOwogdm9pZCByY2FyX2R1X2dyb3VwX2NsZWFudXAoc3RydWN0IHJjYXJfZHVfZ3JvdXAgKnJn
cnApOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9rbXMuYyBi
L2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfa21zLmMKaW5kZXggZjU3YTAzNWE5NGVl
Li42NTM5NjEzNGZiYTEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJf
ZHVfa21zLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9rbXMuYwpAQCAt
Mzc3LDYgKzM3NywxMCBAQCBzdGF0aWMgaW50IHJjYXJfZHVfYXRvbWljX2NoZWNrKHN0cnVjdCBk
cm1fZGV2aWNlICpkZXYsCiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIAorCXJldCA9IHJjYXJf
ZHVfZ3JvdXBfYXRvbWljX2NoZWNrKGRldiwgc3RhdGUpOworCWlmIChyZXQpCisJCXJldHVybiBy
ZXQ7CisKIAlpZiAocmNhcl9kdV9oYXMocmNkdSwgUkNBUl9EVV9GRUFUVVJFX1ZTUDFfU09VUkNF
KSkKIAkJcmV0dXJuIDA7CiAKQEAgLTQxMSw2ICs0MTUsNyBAQCBzdGF0aWMgdm9pZCByY2FyX2R1
X2F0b21pY19jb21taXRfdGFpbChzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqb2xkX3N0YXRlKQog
CiAJLyogQXBwbHkgdGhlIGF0b21pYyB1cGRhdGUuICovCiAJcmNhcl9kdV9jcnRjX2F0b21pY19l
eGl0X3N0YW5kYnkoZGV2LCBvbGRfc3RhdGUpOworCXJjYXJfZHVfZ3JvdXBfYXRvbWljX3NldHVw
KGRldiwgb2xkX3N0YXRlKTsKIAogCWRybV9hdG9taWNfaGVscGVyX2NvbW1pdF9tb2Rlc2V0X2Rp
c2FibGVzKGRldiwgb2xkX3N0YXRlKTsKIAlyY2FyX2R1X2NydGNfYXRvbWljX21vZGVzZXQoZGV2
LCBvbGRfc3RhdGUpOwotLSAKUmVnYXJkcywKCkxhdXJlbnQgUGluY2hhcnQKCl9fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxp
c3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNr
dG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
