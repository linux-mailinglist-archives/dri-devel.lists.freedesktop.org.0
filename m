Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id E80204560A
	for <lists+dri-devel@lfdr.de>; Fri, 14 Jun 2019 09:24:45 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EAD8E898AA;
	Fri, 14 Jun 2019 07:22:47 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from pandora.armlinux.org.uk (pandora.armlinux.org.uk
 [IPv6:2001:4d48:ad52:3201:214:fdff:fe10:1be6])
 by gabe.freedesktop.org (Postfix) with ESMTPS id DC8A889AF3
 for <dri-devel@lists.freedesktop.org>; Thu, 13 Jun 2019 15:03:29 +0000 (UTC)
Received: from e0022681537dd.dyn.armlinux.org.uk
 ([2002:4e20:1eda:1:222:68ff:fe15:37dd]:44854 helo=rmk-PC.armlinux.org.uk)
 by pandora.armlinux.org.uk with esmtpsa
 (TLSv1.2:ECDHE-RSA-AES128-GCM-SHA256:128) (Exim 4.90_1)
 (envelope-from <rmk@armlinux.org.uk>)
 id 1hbRFd-0003km-AU; Thu, 13 Jun 2019 16:02:53 +0100
Received: from rmk by rmk-PC.armlinux.org.uk with local (Exim
 4.82_1-5b7a7c0-XX) (envelope-from <rmk@armlinux.org.uk>)
 id 1hbRFZ-00008L-36; Thu, 13 Jun 2019 16:02:49 +0100
In-Reply-To: <20190613150114.xqkyb7j7w4ve4yvr@shell.armlinux.org.uk>
References: <20190613150114.xqkyb7j7w4ve4yvr@shell.armlinux.org.uk>
From: Russell King <rmk+kernel@armlinux.org.uk>
To: dri-devel@lists.freedesktop.org, linux-arm-kernel@lists.infradead.org
Subject: [PATCH 13/18] drm/armada: improve Dove clock selection
MIME-Version: 1.0
Content-Disposition: inline
Message-Id: <E1hbRFZ-00008L-36@rmk-PC.armlinux.org.uk>
Date: Thu, 13 Jun 2019 16:02:49 +0100
X-Mailman-Approved-At: Fri, 14 Jun 2019 07:21:24 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; 
 d=armlinux.org.uk; s=pandora-2019; h=Date:Sender:Message-Id:Content-Type:
 Content-Transfer-Encoding:MIME-Version:Subject:Cc:To:From:References:
 In-Reply-To:Reply-To:Content-ID:Content-Description:Resent-Date:Resent-From:
 Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:List-Id:List-Help:
 List-Unsubscribe:List-Subscribe:List-Post:List-Owner:List-Archive;
 bh=QaNyTOoRmFwSjLpLESLHbdGOvEIixP7VeQTJvY6fxEM=; b=xC2q2l+gV1nKrlwrs7xcbqgbbY
 gZOOVjeaIAZTN1QeMQyTwVL5Hq7PoryKRDN0KkEroGTRSf4KPIHTCuH/HBektQZWZkslcRM3SmGK1
 +iH9gVxP2hwbBLdxSo5ViCPs/l6ZhZNnBzXGyNm1uLIEFupohJK906w34GRSGwVTk83dJwbV7XbK8
 HQ+wKypOIPtKPo+E4PkfunOXl7QvdKBxlKcDA02MsRBSLrqTdXkHJy5EXHtjdn1nMyaV1+0jysCYD
 AEeoS655izaF5QE2FcaAqxe/pfC3TQ1y1RikUFbR2Tr/r4tRn7BK6WX/rNT4f3x7RVWDc1iLNKtop
 tbBibVog==;
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: David Airlie <airlied@linux.ie>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SW1wcm92ZSB0aGUgRG92ZSAoQXJtYWRhIDUxMCkgTENEIGNsb2NrIHNlbGVjdGlvbiBhbmQgZGl2
aWRlcgpjYWxjdWxhdGlvbiwgbGltaXRpbmcgdG8gdGhlIHZhbGlkIGRpdmlzb3IgdmFsdWVzLCBh
bmQgcmVwb3J0aW5nIGFuCmVycm9yIGlmIHRoZSBjbG9jayBpcyBub3QgYWNoaWV2YWJsZSB3aXRo
aW4gdGhlIGJvdW5kcyBvZiBIRE1JCmNsb2NraW5nIHJlcXVpcmVtZW50cy4KClNpZ25lZC1vZmYt
Ynk6IFJ1c3NlbGwgS2luZyA8cm1rK2tlcm5lbEBhcm1saW51eC5vcmcudWs+Ci0tLQogZHJpdmVy
cy9ncHUvZHJtL2FybWFkYS9hcm1hZGFfNTEwLmMgIHwgMTIxICsrKysrKysrKysrKysrKysrKysr
KysrKystLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vYXJtYWRhL2FybWFkYV9jcnRjLmMgfCAg
NzggKysrKysrKysrKysrKysrKysrKysrLQogZHJpdmVycy9ncHUvZHJtL2FybWFkYS9hcm1hZGFf
Y3J0Yy5oIHwgIDIxICsrKysrLQogMyBmaWxlcyBjaGFuZ2VkLCAxODMgaW5zZXJ0aW9ucygrKSwg
MzcgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FybWFkYS9hcm1h
ZGFfNTEwLmMgYi9kcml2ZXJzL2dwdS9kcm0vYXJtYWRhL2FybWFkYV81MTAuYwppbmRleCAzNzBj
NDIyZjY0ZTMuLjZmOGFkOGZiMTlmMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FybWFk
YS9hcm1hZGFfNTEwLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FybWFkYS9hcm1hZGFfNTEwLmMK
QEAgLTE0LDE1ICsxNCw1NCBAQAogI2luY2x1ZGUgImFybWFkYV9kcm0uaCIKICNpbmNsdWRlICJh
cm1hZGFfaHcuaCIKIAorc3RydWN0IGFybWFkYTUxMF92YXJpYW50X2RhdGEgeworCXN0cnVjdCBj
bGsgKmNsa3NbNF07CisJc3RydWN0IGNsayAqc2VsX2NsazsKK307CisKIHN0YXRpYyBpbnQgYXJt
YWRhNTEwX2NydGNfaW5pdChzdHJ1Y3QgYXJtYWRhX2NydGMgKmRjcnRjLCBzdHJ1Y3QgZGV2aWNl
ICpkZXYpCiB7CisJc3RydWN0IGFybWFkYTUxMF92YXJpYW50X2RhdGEgKnY7CiAJc3RydWN0IGNs
ayAqY2xrOwotCi0JY2xrID0gZGV2bV9jbGtfZ2V0KGRldiwgImV4dF9yZWZfY2xrMSIpOwotCWlm
IChJU19FUlIoY2xrKSkKLQkJcmV0dXJuIFBUUl9FUlIoY2xrKSA9PSAtRU5PRU5UID8gLUVQUk9C
RV9ERUZFUiA6IFBUUl9FUlIoY2xrKTsKLQotCWRjcnRjLT5leHRjbGtbMF0gPSBjbGs7CisJaW50
IGlkeDsKKworCXYgPSBkZXZtX2t6YWxsb2MoZGV2LCBzaXplb2YoKnYpLCBHRlBfS0VSTkVMKTsK
KwlpZiAoIXYpCisJCXJldHVybiAtRU5PTUVNOworCisJZGNydGMtPnZhcmlhbnRfZGF0YSA9IHY7
CisKKwlpZiAoZGV2LT5vZl9ub2RlKSB7CisJCXN0cnVjdCBwcm9wZXJ0eSAqcHJvcDsKKwkJY29u
c3QgY2hhciAqczsKKworCQlvZl9wcm9wZXJ0eV9mb3JfZWFjaF9zdHJpbmcoZGV2LT5vZl9ub2Rl
LCAiY2xvY2stbmFtZXMiLCBwcm9wLAorCQkJCQkgICAgcykgeworCQkJaWYgKCFzdHJjbXAocywg
ImV4dF9yZWZfY2xrMCIpKQorCQkJCWlkeCA9IDA7CisJCQllbHNlIGlmICghc3RyY21wKHMsICJl
eHRfcmVmX2NsazEiKSkKKwkJCQlpZHggPSAxOworCQkJZWxzZSBpZiAoIXN0cmNtcChzLCAicGxs
ZGl2aWRlciIpKQorCQkJCWlkeCA9IDI7CisJCQllbHNlIGlmICghc3RyY21wKHMsICJheGlidXMi
KSkKKwkJCQlpZHggPSAzOworCQkJZWxzZQorCQkJCWNvbnRpbnVlOworCisJCQljbGsgPSBkZXZt
X2Nsa19nZXQoZGV2LCBzKTsKKwkJCWlmIChJU19FUlIoY2xrKSkKKwkJCQlyZXR1cm4gUFRSX0VS
UihjbGspID09IC1FTk9FTlQgPyAtRVBST0JFX0RFRkVSIDoKKwkJCQkJUFRSX0VSUihjbGspOwor
CQkJdi0+Y2xrc1tpZHhdID0gY2xrOworCQl9CisJfSBlbHNlIHsKKwkJY2xrID0gZGV2bV9jbGtf
Z2V0KGRldiwgImV4dF9yZWZfY2xrMSIpOworCQlpZiAoSVNfRVJSKGNsaykpCisJCQlyZXR1cm4g
UFRSX0VSUihjbGspID09IC1FTk9FTlQgPyAtRVBST0JFX0RFRkVSIDoKKwkJCQlQVFJfRVJSKGNs
ayk7CisKKwkJdi0+Y2xrc1sxXSA9IGNsazsKKwl9CiAKIAkvKgogCSAqIExvd2VyIHRoZSB3YXRl
cm1hcmsgc28gdG8gZWxpbWluYXRlIGppdHRlciBhdCBoaWdoZXIgYmFuZHdpZHRocy4KQEAgLTM5
LDY1ICs3OCw3NyBAQCBzdGF0aWMgaW50IGFybWFkYTUxMF9jcnRjX2luaXQoc3RydWN0IGFybWFk
YV9jcnRjICpkY3J0Yywgc3RydWN0IGRldmljZSAqZGV2KQogCXJldHVybiAwOwogfQogCitzdGF0
aWMgY29uc3QgdTMyIGFybWFkYTUxMF9jbGtfc2Vsc1tdID0geworCVNDTEtfNTEwX0VYVENMSzAs
CisJU0NMS181MTBfRVhUQ0xLMSwKKwlTQ0xLXzUxMF9QTEwsCisJU0NMS181MTBfQVhJLAorfTsK
Kworc3RhdGljIGNvbnN0IHN0cnVjdCBhcm1hZGFfY2xvY2tpbmdfcGFyYW1zIGFybWFkYTUxMF9j
bG9ja2luZyA9IHsKKwkvKiBIRE1JIHJlcXVpcmVzIC0wLjYlLi4rMC41JSAqLworCS5wZXJtaWxs
YWdlX21pbiA9IDk5NCwKKwkucGVybWlsbGFnZV9tYXggPSAxMDA1LAorCS5zZXR0YWJsZSA9IEJJ
VCgwKSB8IEJJVCgxKSwKKwkuZGl2X21heCA9IFNDTEtfNTEwX0lOVF9ESVZfTUFTSywKK307CisK
IC8qCiAgKiBBcm1hZGE1MTAgc3BlY2lmaWMgU0NMSyByZWdpc3RlciBzZWxlY3Rpb24uCiAgKiBU
aGlzIGdldHMgY2FsbGVkIHdpdGggc2NsayA9IE5VTEwgdG8gdGVzdCB3aGV0aGVyIHRoZSBtb2Rl
IGlzCiAgKiBzdXBwb3J0YWJsZSwgYW5kIGFnYWluIHdpdGggc2NsayAhPSBOVUxMIHRvIHNldCB0
aGUgY2xvY2tzIHVwIGZvcgogICogdGhhdC4gIFRoZSBmb3JtZXIgY2FuIHJldHVybiBhbiBlcnJv
ciwgYnV0IHRoZSBsYXR0ZXIgaXMgZXhwZWN0ZWQKICAqIG5vdCB0by4KLSAqCi0gKiBXZSBjdXJy
ZW50bHkgYXJlIHByZXR0eSBydWRpbWVudGFyeSBoZXJlLCBhbHdheXMgc2VsZWN0aW5nCi0gKiBF
WFRfUkVGX0NMS18xIGZvciBMQ0QwIGFuZCBlcnJvcmluZyBMQ0QxLiAgVGhpcyBuZWVkcyBpbXBy
b3ZlbWVudCEKICAqLwogc3RhdGljIGludCBhcm1hZGE1MTBfY3J0Y19jb21wdXRlX2Nsb2NrKHN0
cnVjdCBhcm1hZGFfY3J0YyAqZGNydGMsCiAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUg
Km1vZGUsIHVpbnQzMl90ICpzY2xrKQogewotCXN0cnVjdCBjbGsgKmNsayA9IGRjcnRjLT5leHRj
bGtbMF07Ci0JaW50IHJldDsKKwlzdHJ1Y3QgYXJtYWRhNTEwX3ZhcmlhbnRfZGF0YSAqdiA9IGRj
cnRjLT52YXJpYW50X2RhdGE7CisJdW5zaWduZWQgbG9uZyBkZXNpcmVkX2toeiA9IG1vZGUtPmNy
dGNfY2xvY2s7CisJc3RydWN0IGFybWFkYV9jbGtfcmVzdWx0IHJlczsKKwlpbnQgcmV0LCBpZHg7
CiAKLQlpZiAoZGNydGMtPm51bSA9PSAxKQotCQlyZXR1cm4gLUVJTlZBTDsKKwlpZHggPSBhcm1h
ZGFfY3J0Y19zZWxlY3RfY2xvY2soZGNydGMsICZyZXMsICZhcm1hZGE1MTBfY2xvY2tpbmcsCisJ
CQkJICAgICAgIHYtPmNsa3MsIEFSUkFZX1NJWkUodi0+Y2xrcyksCisJCQkJICAgICAgIGRlc2ly
ZWRfa2h6KTsKKwlpZiAoaWR4IDwgMCkKKwkJcmV0dXJuIGlkeDsKIAotCWlmIChJU19FUlIoY2xr
KSkKLQkJcmV0dXJuIFBUUl9FUlIoY2xrKTsKLQotCWlmIChkY3J0Yy0+Y2xrICE9IGNsaykgewot
CQlyZXQgPSBjbGtfcHJlcGFyZV9lbmFibGUoY2xrKTsKLQkJaWYgKHJldCkKLQkJCXJldHVybiBy
ZXQ7Ci0JCWRjcnRjLT5jbGsgPSBjbGs7Ci0JfQorCXJldCA9IGNsa19wcmVwYXJlX2VuYWJsZShy
ZXMuY2xrKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OwogCiAJaWYgKHNjbGspIHsKLQkJdWlu
dDMyX3QgcmF0ZSwgcmVmLCBkaXY7CisJCWNsa19zZXRfcmF0ZShyZXMuY2xrLCByZXMuZGVzaXJl
ZF9jbGtfaHopOwogCi0JCXJhdGUgPSBtb2RlLT5jbG9jayAqIDEwMDA7Ci0JCXJlZiA9IGNsa19y
b3VuZF9yYXRlKGNsaywgcmF0ZSk7Ci0JCWRpdiA9IERJVl9ST1VORF9VUChyZWYsIHJhdGUpOwot
CQlpZiAoZGl2IDwgMSkKLQkJCWRpdiA9IDE7CisJCSpzY2xrID0gcmVzLmRpdiB8IGFybWFkYTUx
MF9jbGtfc2Vsc1tpZHhdOwogCi0JCWNsa19zZXRfcmF0ZShjbGssIHJlZik7Ci0JCSpzY2xrID0g
ZGl2IHwgU0NMS181MTBfRVhUQ0xLMTsKKwkJLyogV2UgYXJlIG5vdyB1c2luZyB0aGlzIGNsb2Nr
ICovCisJCXYtPnNlbF9jbGsgPSByZXMuY2xrOworCQlzd2FwKGRjcnRjLT5jbGssIHJlcy5jbGsp
OwogCX0KIAorCWNsa19kaXNhYmxlX3VucHJlcGFyZShyZXMuY2xrKTsKKwogCXJldHVybiAwOwog
fQogCiBzdGF0aWMgdm9pZCBhcm1hZGE1MTBfY3J0Y19kaXNhYmxlKHN0cnVjdCBhcm1hZGFfY3J0
YyAqZGNydGMpCiB7Ci0JaWYgKCFJU19FUlIoZGNydGMtPmNsaykpIHsKKwlpZiAoZGNydGMtPmNs
aykgewogCQljbGtfZGlzYWJsZV91bnByZXBhcmUoZGNydGMtPmNsayk7Ci0JCWRjcnRjLT5jbGsg
PSBFUlJfUFRSKC1FSU5WQUwpOworCQlkY3J0Yy0+Y2xrID0gTlVMTDsKIAl9CiB9CiAKIHN0YXRp
YyB2b2lkIGFybWFkYTUxMF9jcnRjX2VuYWJsZShzdHJ1Y3QgYXJtYWRhX2NydGMgKmRjcnRjLAog
CWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlKQogewotCWlmIChJU19FUlIoZGNy
dGMtPmNsaykpIHsKLQkJZGNydGMtPmNsayA9IGRjcnRjLT5leHRjbGtbMF07Ci0JCVdBUk5fT04o
Y2xrX3ByZXBhcmVfZW5hYmxlKGRjcnRjLT5jbGspKTsKKwlzdHJ1Y3QgYXJtYWRhNTEwX3Zhcmlh
bnRfZGF0YSAqdiA9IGRjcnRjLT52YXJpYW50X2RhdGE7CisKKwlpZiAoIWRjcnRjLT5jbGsgJiYg
di0+c2VsX2NsaykgeworCQlpZiAoIVdBUk5fT04oY2xrX3ByZXBhcmVfZW5hYmxlKHYtPnNlbF9j
bGspKSkKKwkJCWRjcnRjLT5jbGsgPSB2LT5zZWxfY2xrOwogCX0KIH0KIApkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2FybWFkYS9hcm1hZGFfY3J0Yy5jIGIvZHJpdmVycy9ncHUvZHJtL2Fy
bWFkYS9hcm1hZGFfY3J0Yy5jCmluZGV4IGVkY2U3NGY2MDE5OC4uOTQ5YWNjODI0MDZiIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYXJtYWRhL2FybWFkYV9jcnRjLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2FybWFkYS9hcm1hZGFfY3J0Yy5jCkBAIC04MDEsNiArODAxLDgzIEBAIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgZHJtX2NydGNfZnVuY3MgYXJtYWRhX2NydGNfZnVuY3MgPSB7CiAJLmRp
c2FibGVfdmJsYW5rCT0gYXJtYWRhX2RybV9jcnRjX2Rpc2FibGVfdmJsYW5rLAogfTsKIAoraW50
IGFybWFkYV9jcnRjX3NlbGVjdF9jbG9jayhzdHJ1Y3QgYXJtYWRhX2NydGMgKmRjcnRjLAorCQkJ
ICAgICBzdHJ1Y3QgYXJtYWRhX2Nsa19yZXN1bHQgKnJlcywKKwkJCSAgICAgY29uc3Qgc3RydWN0
IGFybWFkYV9jbG9ja2luZ19wYXJhbXMgKnBhcmFtcywKKwkJCSAgICAgc3RydWN0IGNsayAqY2xr
c1tdLCBzaXplX3QgbnVtX2Nsa3MsCisJCQkgICAgIHVuc2lnbmVkIGxvbmcgZGVzaXJlZF9raHop
Cit7CisJdW5zaWduZWQgbG9uZyBkZXNpcmVkX2h6ID0gZGVzaXJlZF9raHogKiAxMDAwOworCXVu
c2lnbmVkIGxvbmcgZGVzaXJlZF9jbGtfaHo7CS8vIHJlcXVlc3RlZCBjbGsgaW5wdXQKKwl1bnNp
Z25lZCBsb25nIHJlYWxfY2xrX2h6OwkvLyBhY3R1YWwgY2xrIGlucHV0CisJdW5zaWduZWQgbG9u
ZyByZWFsX2h6OwkJLy8gYWN0dWFsIHBpeGVsIGNsaworCXVuc2lnbmVkIGxvbmcgcGVybWlsbGFn
ZTsKKwlzdHJ1Y3QgY2xrICpjbGs7CisJdTMyIGRpdjsKKwlpbnQgaTsKKworCURSTV9ERUJVR19L
TVMoIltDUlRDOiV1OiVzXSBkZXNpcmVkIGNsb2NrPSVsdUh6XG4iLAorCQkgICAgICBkY3J0Yy0+
Y3J0Yy5iYXNlLmlkLCBkY3J0Yy0+Y3J0Yy5uYW1lLCBkZXNpcmVkX2h6KTsKKworCWZvciAoaSA9
IDA7IGkgPCBudW1fY2xrczsgaSsrKSB7CisJCWNsayA9IGNsa3NbaV07CisJCWlmICghY2xrKQor
CQkJY29udGludWU7CisKKwkJaWYgKHBhcmFtcy0+c2V0dGFibGUgJiBCSVQoaSkpIHsKKwkJCXJl
YWxfY2xrX2h6ID0gY2xrX3JvdW5kX3JhdGUoY2xrLCBkZXNpcmVkX2h6KTsKKwkJCWRlc2lyZWRf
Y2xrX2h6ID0gZGVzaXJlZF9oejsKKwkJfSBlbHNlIHsKKwkJCXJlYWxfY2xrX2h6ID0gY2xrX2dl
dF9yYXRlKGNsayk7CisJCQlkZXNpcmVkX2Nsa19oeiA9IHJlYWxfY2xrX2h6OworCQl9CisKKwkJ
LyogSWYgdGhlIGNsb2NrIGNhbiBkbyBleGFjdGx5IHRoZSBkZXNpcmVkIHJhdGUsIHdlJ3JlIGRv
bmUgKi8KKwkJaWYgKHJlYWxfY2xrX2h6ID09IGRlc2lyZWRfaHopIHsKKwkJCXJlYWxfaHogPSBy
ZWFsX2Nsa19oejsKKwkJCWRpdiA9IDE7CisJCQlicmVhazsKKwkJfQorCisJCS8qIENhbGN1bGF0
ZSB0aGUgZGl2aWRlciAtIGlmIGludmFsaWQsIHdlIGNhbid0IGRvIHRoaXMgcmF0ZSAqLworCQlk
aXYgPSBESVZfUk9VTkRfQ0xPU0VTVChyZWFsX2Nsa19oeiwgZGVzaXJlZF9oeik7CisJCWlmIChk
aXYgPT0gMCB8fCBkaXYgPiBwYXJhbXMtPmRpdl9tYXgpCisJCQljb250aW51ZTsKKworCQkvKiBD
YWxjdWxhdGUgdGhlIGFjdHVhbCByYXRlIC0gSERNSSByZXF1aXJlcyAtMC42JS4uKzAuNSUgKi8K
KwkJcmVhbF9oeiA9IERJVl9ST1VORF9DTE9TRVNUKHJlYWxfY2xrX2h6LCBkaXYpOworCisJCURS
TV9ERUJVR19LTVMoIltDUlRDOiV1OiVzXSBjbGs9JXUgJWx1SHogZGl2PSV1IHJlYWw9JWx1SHpc
biIsCisJCQlkY3J0Yy0+Y3J0Yy5iYXNlLmlkLCBkY3J0Yy0+Y3J0Yy5uYW1lLAorCQkJaSwgcmVh
bF9jbGtfaHosIGRpdiwgcmVhbF9oeik7CisKKwkJLyogQXZvaWQgcmVwZWF0ZWQgZGl2aXNpb24g
Ki8KKwkJaWYgKHJlYWxfaHogPCBkZXNpcmVkX2h6KSB7CisJCQlwZXJtaWxsYWdlID0gcmVhbF9o
eiAvIGRlc2lyZWRfa2h6OworCQkJaWYgKHBlcm1pbGxhZ2UgPCBwYXJhbXMtPnBlcm1pbGxhZ2Vf
bWluKQorCQkJCWNvbnRpbnVlOworCQl9IGVsc2UgeworCQkJcGVybWlsbGFnZSA9IERJVl9ST1VO
RF9VUChyZWFsX2h6LCBkZXNpcmVkX2toeik7CisJCQlpZiAocGVybWlsbGFnZSA+IHBhcmFtcy0+
cGVybWlsbGFnZV9tYXgpCisJCQkJY29udGludWU7CisJCX0KKwkJYnJlYWs7CisJfQorCisJaWYg
KGkgPT0gNCkKKwkJcmV0dXJuIC1FUkFOR0U7CisKKwlEUk1fREVCVUdfS01TKCJbQ1JUQzoldTol
c10gc2VsZWN0ZWQgY2xrPSV1ICVsdUh6IGRpdj0ldSByZWFsPSVsdUh6XG4iLAorCQlkY3J0Yy0+
Y3J0Yy5iYXNlLmlkLCBkY3J0Yy0+Y3J0Yy5uYW1lLAorCQlpLCByZWFsX2Nsa19oeiwgZGl2LCBy
ZWFsX2h6KTsKKworCXJlcy0+ZGVzaXJlZF9jbGtfaHogPSBkZXNpcmVkX2Nsa19oejsKKwlyZXMt
PmNsayA9IGNsazsKKwlyZXMtPmRpdiA9IGRpdjsKKworCXJldHVybiBpOworfQorCiBzdGF0aWMg
aW50IGFybWFkYV9kcm1fY3J0Y19jcmVhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRybSwgc3RydWN0
IGRldmljZSAqZGV2LAogCXN0cnVjdCByZXNvdXJjZSAqcmVzLCBpbnQgaXJxLCBjb25zdCBzdHJ1
Y3QgYXJtYWRhX3ZhcmlhbnQgKnZhcmlhbnQsCiAJc3RydWN0IGRldmljZV9ub2RlICpwb3J0KQpA
QCAtODI3LDcgKzkwNCw2IEBAIHN0YXRpYyBpbnQgYXJtYWRhX2RybV9jcnRjX2NyZWF0ZShzdHJ1
Y3QgZHJtX2RldmljZSAqZHJtLCBzdHJ1Y3QgZGV2aWNlICpkZXYsCiAJZGNydGMtPnZhcmlhbnQg
PSB2YXJpYW50OwogCWRjcnRjLT5iYXNlID0gYmFzZTsKIAlkY3J0Yy0+bnVtID0gZHJtLT5tb2Rl
X2NvbmZpZy5udW1fY3J0YzsKLQlkY3J0Yy0+Y2xrID0gRVJSX1BUUigtRUlOVkFMKTsKIAlkY3J0
Yy0+Y2ZnX2R1bWJfY3RybCA9IERVTUIyNF9SR0I4ODhfMDsKIAlkY3J0Yy0+c3B1X2lvcGFkX2N0
cmwgPSBDRkdfVlNDQUxFX0xOX0VOIHwgQ0ZHX0lPUEFEX0RVTUIyNDsKIAlzcGluX2xvY2tfaW5p
dCgmZGNydGMtPmlycV9sb2NrKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hcm1hZGEv
YXJtYWRhX2NydGMuaCBiL2RyaXZlcnMvZ3B1L2RybS9hcm1hZGEvYXJtYWRhX2NydGMuaAppbmRl
eCAwODc2MWZmMDE3MzkuLmZiNGFhNDhkYTYwYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2FybWFkYS9hcm1hZGFfY3J0Yy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hcm1hZGEvYXJtYWRh
X2NydGMuaApAQCAtMzksMTAgKzM5LDEwIEBAIHN0cnVjdCBhcm1hZGFfdmFyaWFudDsKIHN0cnVj
dCBhcm1hZGFfY3J0YyB7CiAJc3RydWN0IGRybV9jcnRjCQljcnRjOwogCWNvbnN0IHN0cnVjdCBh
cm1hZGFfdmFyaWFudCAqdmFyaWFudDsKKwl2b2lkCQkJKnZhcmlhbnRfZGF0YTsKIAl1bnNpZ25l
ZAkJbnVtOwogCXZvaWQgX19pb21lbQkJKmJhc2U7CiAJc3RydWN0IGNsawkJKmNsazsKLQlzdHJ1
Y3QgY2xrCQkqZXh0Y2xrWzJdOwogCXN0cnVjdCB7CiAJCXVpbnQzMl90CXNwdV92X2hfdG90YWw7
CiAJCXVpbnQzMl90CXNwdV92X3BvcmNoOwpAQCAtNzUsNiArNzUsMjUgQEAgc3RydWN0IGFybWFk
YV9jcnRjIHsKIAogdm9pZCBhcm1hZGFfZHJtX2NydGNfdXBkYXRlX3JlZ3Moc3RydWN0IGFybWFk
YV9jcnRjICosIHN0cnVjdCBhcm1hZGFfcmVncyAqKTsKIAorc3RydWN0IGFybWFkYV9jbG9ja2lu
Z19wYXJhbXMgeworCXVuc2lnbmVkIGxvbmcgcGVybWlsbGFnZV9taW47CisJdW5zaWduZWQgbG9u
ZyBwZXJtaWxsYWdlX21heDsKKwl1MzIgc2V0dGFibGU7CisJdTMyIGRpdl9tYXg7Cit9OworCitz
dHJ1Y3QgYXJtYWRhX2Nsa19yZXN1bHQgeworCXVuc2lnbmVkIGxvbmcgZGVzaXJlZF9jbGtfaHo7
CisJc3RydWN0IGNsayAqY2xrOworCXUzMiBkaXY7Cit9OworCitpbnQgYXJtYWRhX2NydGNfc2Vs
ZWN0X2Nsb2NrKHN0cnVjdCBhcm1hZGFfY3J0YyAqZGNydGMsCisJCQkgICAgIHN0cnVjdCBhcm1h
ZGFfY2xrX3Jlc3VsdCAqcmVzLAorCQkJICAgICBjb25zdCBzdHJ1Y3QgYXJtYWRhX2Nsb2NraW5n
X3BhcmFtcyAqcGFyYW1zLAorCQkJICAgICBzdHJ1Y3QgY2xrICpjbGtzW10sIHNpemVfdCBudW1f
Y2xrcywKKwkJCSAgICAgdW5zaWduZWQgbG9uZyBkZXNpcmVkX2toeik7CisKIGV4dGVybiBzdHJ1
Y3QgcGxhdGZvcm1fZHJpdmVyIGFybWFkYV9sY2RfcGxhdGZvcm1fZHJpdmVyOwogCiAjZW5kaWYK
LS0gCjIuNy40CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
XwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcK
aHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
