Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id B46E6CB53D
	for <lists+dri-devel@lfdr.de>; Fri,  4 Oct 2019 09:39:40 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id BCA1C6EAD9;
	Fri,  4 Oct 2019 07:38:55 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3D70F6EA7D
 for <dri-devel@lists.freedesktop.org>; Thu,  3 Oct 2019 20:20:29 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id BBEC5B04F;
 Thu,  3 Oct 2019 20:20:27 +0000 (UTC)
From: Davidlohr Bueso <dave@stgolabs.net>
To: akpm@linux-foundation.org
Subject: [PATCH 07/11] vhost: convert vhost_umem_interval_tree to half closed
 intervals
Date: Thu,  3 Oct 2019 13:18:54 -0700
Message-Id: <20191003201858.11666-8-dave@stgolabs.net>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20191003201858.11666-1-dave@stgolabs.net>
References: <20191003201858.11666-1-dave@stgolabs.net>
X-Mailman-Approved-At: Fri, 04 Oct 2019 07:38:50 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: dave@stgolabs.net, Davidlohr Bueso <dbueso@suse.de>,
	peterz@infradead.org, Jason Wang <jasowang@redhat.com>,
	Michael@freedesktop.org, linux-kernel@vger.kernel.org,
	dri-devel@lists.freedesktop.org,
	virtualization@lists.linux-foundation.org, linux-mm@kvack.org,
	walken@google.com, linux-rdma@vger.kernel.org
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIHZob3N0X3VtZW0gaW50ZXJ2YWwgdHJlZSByZWFsbHkgd2FudHMgW2EsIGIpIGludGVydmFs
cywKbm90IGZ1bGx5IGNsb3NlZCBhcyBjdXJyZW50bHkuIEFzIHN1Y2ggY29udmVydCBpdCB0byB1
c2UgdGhlCm5ldyBpbnRlcnZhbF90cmVlX2dlbi5oLCBhbmQgYWxzbyByZW5hbWUgdGhlICdsYXN0
JyBlbmRwb2ludAppbiB0aGUgbm9kZSB0byAnZW5kJywgd2hpY2ggYm90aCBhIG1vcmUgc3VpdGFi
bGUgbmFtZSBmb3IKdGhlIGhhbGYgY2xvc2VkIGludGVydmFsIGFuZCBhbHNvIHJlZHVjZXMgdGhl
IGNoYW5jZXMgb2Ygc29tZQpjYWxsZXIgYmVpbmcgbWlzc2VkLgoKQ2M6IE1pY2hhZWwgUy4gVHNp
cmtpbiIgPG1zdEByZWRoYXQuY29tPgpDYzogSmFzb24gV2FuZyA8amFzb3dhbmdAcmVkaGF0LmNv
bT4KQ2M6IHZpcnR1YWxpemF0aW9uQGxpc3RzLmxpbnV4LWZvdW5kYXRpb24ub3JnClNpZ25lZC1v
ZmYtYnk6IERhdmlkbG9ociBCdWVzbyA8ZGJ1ZXNvQHN1c2UuZGU+Ci0tLQogZHJpdmVycy92aG9z
dC92aG9zdC5jIHwgMTkgKysrKysrKysrLS0tLS0tLS0tLQogZHJpdmVycy92aG9zdC92aG9zdC5o
IHwgIDQgKystLQogMiBmaWxlcyBjaGFuZ2VkLCAxMSBpbnNlcnRpb25zKCspLCAxMiBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL3Zob3N0L3Zob3N0LmMgYi9kcml2ZXJzL3Zob3N0
L3Zob3N0LmMKaW5kZXggMzZjYTJjZjQxOWJmLi44MGMzY2NhMjRkYzcgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvdmhvc3Qvdmhvc3QuYworKysgYi9kcml2ZXJzL3Zob3N0L3Zob3N0LmMKQEAgLTI4LDcg
KzI4LDcgQEAKICNpbmNsdWRlIDxsaW51eC9zb3J0Lmg+CiAjaW5jbHVkZSA8bGludXgvc2NoZWQv
bW0uaD4KICNpbmNsdWRlIDxsaW51eC9zY2hlZC9zaWduYWwuaD4KLSNpbmNsdWRlIDxsaW51eC9p
bnRlcnZhbF90cmVlX2dlbmVyaWMuaD4KKyNpbmNsdWRlIDxsaW51eC9pbnRlcnZhbF90cmVlX2dl
bi5oPgogI2luY2x1ZGUgPGxpbnV4L25vc3BlYy5oPgogCiAjaW5jbHVkZSAidmhvc3QuaCIKQEAg
LTUxLDcgKzUxLDcgQEAgZW51bSB7CiAKIElOVEVSVkFMX1RSRUVfREVGSU5FKHN0cnVjdCB2aG9z
dF91bWVtX25vZGUsCiAJCSAgICAgcmIsIF9fdTY0LCBfX3N1YnRyZWVfbGFzdCwKLQkJICAgICBT
VEFSVCwgTEFTVCwgc3RhdGljIGlubGluZSwgdmhvc3RfdW1lbV9pbnRlcnZhbF90cmVlKTsKKwkJ
ICAgICBTVEFSVCwgRU5ELCBzdGF0aWMgaW5saW5lLCB2aG9zdF91bWVtX2ludGVydmFsX3RyZWUp
OwogCiAjaWZkZWYgQ09ORklHX1ZIT1NUX0NST1NTX0VORElBTl9MRUdBQ1kKIHN0YXRpYyB2b2lk
IHZob3N0X2Rpc2FibGVfY3Jvc3NfZW5kaWFuKHN0cnVjdCB2aG9zdF92aXJ0cXVldWUgKnZxKQpA
QCAtMTAzNCw3ICsxMDM0LDcgQEAgc3RhdGljIGludCB2aG9zdF9uZXdfdW1lbV9yYW5nZShzdHJ1
Y3Qgdmhvc3RfdW1lbSAqdW1lbSwKIAogCW5vZGUtPnN0YXJ0ID0gc3RhcnQ7CiAJbm9kZS0+c2l6
ZSA9IHNpemU7Ci0Jbm9kZS0+bGFzdCA9IGVuZDsKKwlub2RlLT5lbmQgPSBlbmQ7CiAJbm9kZS0+
dXNlcnNwYWNlX2FkZHIgPSB1c2Vyc3BhY2VfYWRkcjsKIAlub2RlLT5wZXJtID0gcGVybTsKIAlJ
TklUX0xJU1RfSEVBRCgmbm9kZS0+bGluayk7CkBAIC0xMTEyLDcgKzExMTIsNyBAQCBzdGF0aWMg
aW50IHZob3N0X3Byb2Nlc3NfaW90bGJfbXNnKHN0cnVjdCB2aG9zdF9kZXYgKmRldiwKIAkJfQog
CQl2aG9zdF92cV9tZXRhX3Jlc2V0KGRldik7CiAJCWlmICh2aG9zdF9uZXdfdW1lbV9yYW5nZShk
ZXYtPmlvdGxiLCBtc2ctPmlvdmEsIG1zZy0+c2l6ZSwKLQkJCQkJIG1zZy0+aW92YSArIG1zZy0+
c2l6ZSAtIDEsCisJCQkJCSBtc2ctPmlvdmEgKyBtc2ctPnNpemUsCiAJCQkJCSBtc2ctPnVhZGRy
LCBtc2ctPnBlcm0pKSB7CiAJCQlyZXQgPSAtRU5PTUVNOwogCQkJYnJlYWs7CkBAIC0xMTI2LDcg
KzExMjYsNyBAQCBzdGF0aWMgaW50IHZob3N0X3Byb2Nlc3NfaW90bGJfbXNnKHN0cnVjdCB2aG9z
dF9kZXYgKmRldiwKIAkJfQogCQl2aG9zdF92cV9tZXRhX3Jlc2V0KGRldik7CiAJCXZob3N0X2Rl
bF91bWVtX3JhbmdlKGRldi0+aW90bGIsIG1zZy0+aW92YSwKLQkJCQkgICAgIG1zZy0+aW92YSAr
IG1zZy0+c2l6ZSAtIDEpOworCQkJCSAgICAgbXNnLT5pb3ZhICsgbXNnLT5zaXplKTsKIAkJYnJl
YWs7CiAJZGVmYXVsdDoKIAkJcmV0ID0gLUVJTlZBTDsKQEAgLTEzMjAsMTUgKzEzMjAsMTQgQEAg
c3RhdGljIGJvb2wgaW90bGJfYWNjZXNzX29rKHN0cnVjdCB2aG9zdF92aXJ0cXVldWUgKnZxLAog
ewogCWNvbnN0IHN0cnVjdCB2aG9zdF91bWVtX25vZGUgKm5vZGU7CiAJc3RydWN0IHZob3N0X3Vt
ZW0gKnVtZW0gPSB2cS0+aW90bGI7Ci0JdTY0IHMgPSAwLCBzaXplLCBvcmlnX2FkZHIgPSBhZGRy
LCBsYXN0ID0gYWRkciArIGxlbiAtIDE7CisJdTY0IHMgPSAwLCBzaXplLCBvcmlnX2FkZHIgPSBh
ZGRyLCBsYXN0ID0gYWRkciArIGxlbjsKIAogCWlmICh2aG9zdF92cV9tZXRhX2ZldGNoKHZxLCBh
ZGRyLCBsZW4sIHR5cGUpKQogCQlyZXR1cm4gdHJ1ZTsKIAogCXdoaWxlIChsZW4gPiBzKSB7CiAJ
CW5vZGUgPSB2aG9zdF91bWVtX2ludGVydmFsX3RyZWVfaXRlcl9maXJzdCgmdW1lbS0+dW1lbV90
cmVlLAotCQkJCQkJCSAgIGFkZHIsCi0JCQkJCQkJICAgbGFzdCk7CisJCQkJCQkJICAgYWRkciwg
bGFzdCk7CiAJCWlmIChub2RlID09IE5VTEwgfHwgbm9kZS0+c3RhcnQgPiBhZGRyKSB7CiAJCQl2
aG9zdF9pb3RsYl9taXNzKHZxLCBhZGRyLCBhY2Nlc3MpOwogCQkJcmV0dXJuIGZhbHNlOwpAQCAt
MTQ1NSw3ICsxNDU0LDcgQEAgc3RhdGljIGxvbmcgdmhvc3Rfc2V0X21lbW9yeShzdHJ1Y3Qgdmhv
c3RfZGV2ICpkLCBzdHJ1Y3Qgdmhvc3RfbWVtb3J5IF9fdXNlciAqbSkKIAkJCQkJIHJlZ2lvbi0+
Z3Vlc3RfcGh5c19hZGRyLAogCQkJCQkgcmVnaW9uLT5tZW1vcnlfc2l6ZSwKIAkJCQkJIHJlZ2lv
bi0+Z3Vlc3RfcGh5c19hZGRyICsKLQkJCQkJIHJlZ2lvbi0+bWVtb3J5X3NpemUgLSAxLAorCQkJ
CQkgcmVnaW9uLT5tZW1vcnlfc2l6ZSwKIAkJCQkJIHJlZ2lvbi0+dXNlcnNwYWNlX2FkZHIsCiAJ
CQkJCSBWSE9TVF9BQ0NFU1NfUlcpKQogCQkJZ290byBlcnI7CkBAIC0yMDU1LDcgKzIwNTQsNyBA
QCBzdGF0aWMgaW50IHRyYW5zbGF0ZV9kZXNjKHN0cnVjdCB2aG9zdF92aXJ0cXVldWUgKnZxLCB1
NjQgYWRkciwgdTMyIGxlbiwKIAkJfQogCiAJCW5vZGUgPSB2aG9zdF91bWVtX2ludGVydmFsX3Ry
ZWVfaXRlcl9maXJzdCgmdW1lbS0+dW1lbV90cmVlLAotCQkJCQkJCWFkZHIsIGFkZHIgKyBsZW4g
LSAxKTsKKwkJCQkJCQkgICBhZGRyLCBhZGRyICsgbGVuKTsKIAkJaWYgKG5vZGUgPT0gTlVMTCB8
fCBub2RlLT5zdGFydCA+IGFkZHIpIHsKIAkJCWlmICh1bWVtICE9IGRldi0+aW90bGIpIHsKIAkJ
CQlyZXQgPSAtRUZBVUxUOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy92aG9zdC92aG9zdC5oIGIvZHJp
dmVycy92aG9zdC92aG9zdC5oCmluZGV4IGU5ZWQyNzIyYjYzMy4uYmIzNmNiOWVkNWVjIDEwMDY0
NAotLS0gYS9kcml2ZXJzL3Zob3N0L3Zob3N0LmgKKysrIGIvZHJpdmVycy92aG9zdC92aG9zdC5o
CkBAIC01MywxMyArNTMsMTMgQEAgc3RydWN0IHZob3N0X2xvZyB7CiB9OwogCiAjZGVmaW5lIFNU
QVJUKG5vZGUpICgobm9kZSktPnN0YXJ0KQotI2RlZmluZSBMQVNUKG5vZGUpICgobm9kZSktPmxh
c3QpCisjZGVmaW5lIEVORChub2RlKSAoKG5vZGUpLT5lbmQpCiAKIHN0cnVjdCB2aG9zdF91bWVt
X25vZGUgewogCXN0cnVjdCByYl9ub2RlIHJiOwogCXN0cnVjdCBsaXN0X2hlYWQgbGluazsKIAlf
X3U2NCBzdGFydDsKLQlfX3U2NCBsYXN0OworCV9fdTY0IGVuZDsKIAlfX3U2NCBzaXplOwogCV9f
dTY0IHVzZXJzcGFjZV9hZGRyOwogCV9fdTMyIHBlcm07Ci0tIAoyLjE2LjQKCl9fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxp
c3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNr
dG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
