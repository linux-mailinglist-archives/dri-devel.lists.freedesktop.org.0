Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id A2A0AF0DC1
	for <lists+dri-devel@lfdr.de>; Wed,  6 Nov 2019 05:23:18 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0C6506EBEE;
	Wed,  6 Nov 2019 04:23:16 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-pl1-x644.google.com (mail-pl1-x644.google.com
 [IPv6:2607:f8b0:4864:20::644])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 161406EBEB
 for <dri-devel@lists.freedesktop.org>; Wed,  6 Nov 2019 04:23:08 +0000 (UTC)
Received: by mail-pl1-x644.google.com with SMTP id l4so5565050plt.13
 for <dri-devel@lists.freedesktop.org>; Tue, 05 Nov 2019 20:23:08 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references;
 bh=UtTKts7n6PwB/KSUdkueiRv1jM81Y5uAXuxP+Ek2MAU=;
 b=PF2qKXvrG4KjunxL2wfgV6S5PO48smswco0RNFPyhMoy6XTU5iEnGr8eZHGOFUn4gH
 WVGAY/KSYeLnW8uRnI+iBqh+eBPMnkxjzfz+NeqvK+no9fL+1+BB31saSJrY0wWoxXHO
 1bceKmzL2ATtf0Yu1HAWH/wOJ7DqINx/SCTG1+0ETEs5LBlinNiu8+QCAdx1w7tyqU0j
 QiD+bTuWaPRIwyNOxXYkvN1ra6R3mLPV/9+cDIkz+4/nSrZY/m30YTe21tAg/cM+VFho
 cdbDAvlYLWWhK3V1TmrroAJkAg0IB580aRuxG2xrdRH7v8jRoKiYmFvddzdDwfBITXMQ
 6hFw==
X-Gm-Message-State: APjAAAWYYDK7Fta/VRBTus6MmCwiF5zTCA/235jR9vMyAgEs+2X0o9+S
 9fUGrLVWtH9UCBBFRuVEudsaqg==
X-Google-Smtp-Source: APXvYqxyDRrtA0GraHS6OeTmC5cm+tpYnMLVkj2j3n9+AfoWSwLV4JEpLjaz2cTZIBShxeGJcOfftA==
X-Received: by 2002:a17:902:322:: with SMTP id 31mr409718pld.293.1573014187513; 
 Tue, 05 Nov 2019 20:23:07 -0800 (PST)
Received: from localhost.localdomain (c-67-170-172-113.hsd1.or.comcast.net.
 [67.170.172.113])
 by smtp.gmail.com with ESMTPSA id n15sm23730289pfq.146.2019.11.05.20.23.06
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 05 Nov 2019 20:23:07 -0800 (PST)
From: John Stultz <john.stultz@linaro.org>
To: lkml <linux-kernel@vger.kernel.org>
Subject: [PATCH v15 5/5] kselftests: Add dma-heap test
Date: Wed,  6 Nov 2019 04:22:52 +0000
Message-Id: <20191106042252.72452-6-john.stultz@linaro.org>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20191106042252.72452-1-john.stultz@linaro.org>
References: <20191106042252.72452-1-john.stultz@linaro.org>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=linaro.org; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references;
 bh=UtTKts7n6PwB/KSUdkueiRv1jM81Y5uAXuxP+Ek2MAU=;
 b=TNerTCHdR/xBMOsoi2KWvCd5wto/Yno6XdqjK6FABEeKXtahodPeaWep+1SW5Quiln
 jt8R0OrM42dMW7h/4Xytu+ifBAwjfK/K+xaB4StGggJSl/GFeE1A15UV+qc7dRgOONge
 KFvX1PM2VGgAT1hk9v39Ox3ZxNhmYPkG3HCGUhEQWba/ym5/r+Pq6x0azkUfrxLfv4QE
 dw24QAOTz0Vp3B4DyjXBbJdwA7K6lXpNDZuXY3WE+kbcjJq8XqhJ3vgSSC5gXIQ4AzMj
 3+Z50L/ucPOlBlvmJu7S88huuIfH4sqevRAfC1h4s7ohHH0O4C6naJKXgB4BTHWIp4D8
 xhSA==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Hillf Danton <hdanton@sina.com>, Sandeep Patil <sspatil@google.com>,
 Vincent Donnefort <Vincent.Donnefort@arm.com>, Chenbo Feng <fengc@google.com>,
 Alistair Strachan <astrachan@google.com>, Liam Mark <lmark@codeaurora.org>,
 Christoph Hellwig <hch@infradead.org>, dri-devel@lists.freedesktop.org,
 "Andrew F . Davis" <afd@ti.com>, Hridya Valsaraju <hridya@google.com>,
 Sudipto Paul <Sudipto.Paul@arm.com>, Pratik Patel <pratikp@codeaurora.org>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIHZlcnkgdHJpdmlhbCBhbGxvY2F0aW9uIGFuZCBpbXBvcnQgdGVzdCBmb3IgZG1hLWhlYXBz
LAp1dGlsaXppbmcgdGhlIHZnZW0gZHJpdmVyIGFzIGEgdGVzdCBpbXBvcnRlci4KCkEgZ29vZCBj
aHVuayBvZiB0aGlzIGNvZGUgdGFrZW4gZnJvbToKICB0b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9h
bmRyb2lkL2lvbi9pb25tYXBfdGVzdC5jCiAgT3JpZ2luYWxseSBieSBMYXVyYSBBYmJvdHQgPGxh
YmJvdHRAcmVkaGF0LmNvbT4KCkNjOiBCZW5qYW1pbiBHYWlnbmFyZCA8YmVuamFtaW4uZ2FpZ25h
cmRAbGluYXJvLm9yZz4KQ2M6IFN1bWl0IFNlbXdhbCA8c3VtaXQuc2Vtd2FsQGxpbmFyby5vcmc+
CkNjOiBMaWFtIE1hcmsgPGxtYXJrQGNvZGVhdXJvcmEub3JnPgpDYzogUHJhdGlrIFBhdGVsIDxw
cmF0aWtwQGNvZGVhdXJvcmEub3JnPgpDYzogQnJpYW4gU3RhcmtleSA8QnJpYW4uU3RhcmtleUBh
cm0uY29tPgpDYzogVmluY2VudCBEb25uZWZvcnQgPFZpbmNlbnQuRG9ubmVmb3J0QGFybS5jb20+
CkNjOiBTdWRpcHRvIFBhdWwgPFN1ZGlwdG8uUGF1bEBhcm0uY29tPgpDYzogQW5kcmV3IEYuIERh
dmlzIDxhZmRAdGkuY29tPgpDYzogQ2hyaXN0b3BoIEhlbGx3aWcgPGhjaEBpbmZyYWRlYWQub3Jn
PgpDYzogQ2hlbmJvIEZlbmcgPGZlbmdjQGdvb2dsZS5jb20+CkNjOiBBbGlzdGFpciBTdHJhY2hh
biA8YXN0cmFjaGFuQGdvb2dsZS5jb20+CkNjOiBIcmlkeWEgVmFsc2FyYWp1IDxocmlkeWFAZ29v
Z2xlLmNvbT4KQ2M6IFNhbmRlZXAgUGF0aWwgPHNzcGF0aWxAZ29vZ2xlLmNvbT4KQ2M6IEhpbGxm
IERhbnRvbiA8aGRhbnRvbkBzaW5hLmNvbT4KQ2M6IERhdmUgQWlybGllIDxhaXJsaWVkQGdtYWls
LmNvbT4KQ2M6IGRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKUmV2aWV3ZWQtYnk6IEJl
bmphbWluIEdhaWduYXJkIDxiZW5qYW1pbi5nYWlnbmFyZEBsaW5hcm8ub3JnPgpSZXZpZXdlZC1i
eTogQnJpYW4gU3RhcmtleSA8YnJpYW4uc3RhcmtleUBhcm0uY29tPgpBY2tlZC1ieTogU2FuZGVl
cCBQYXRpbCA8c3NwYXRpbEBhbmRyb2lkLmNvbT4KQWNrZWQtYnk6IExhdXJhIEFiYm90dCA8bGFi
Ym90dEByZWRoYXQuY29tPgpUZXN0ZWQtYnk6IEF5YW4gS3VtYXIgSGFsZGVyIDxheWFuLmhhbGRl
ckBhcm0uY29tPgpTaWduZWQtb2ZmLWJ5OiBKb2huIFN0dWx0eiA8am9obi5zdHVsdHpAbGluYXJv
Lm9yZz4KLS0tCnYyOgoqIFN3aXRjaGVkIHRvIHVzZSByZXdvcmtlZCBkbWEtaGVhcCBhcGlzCnYz
OgoqIEFkZCBzaW1wbGUgbW1hcAoqIFV0aWxpemUgZG1hLWJ1ZiB0ZXN0ZGV2IHRvIHRlc3QgaW1w
b3J0aW5nCnY0OgoqIFJld29yayB0byB1c2UgdmdlbQoqIFBhc3MgaW4gZmRfZmxhZ3MgdG8gbWF0
Y2ggaW50ZXJmYWNlIGNoYW5nZXMKKiBTa2lwIC4gYW5kIC4uIGRpcnMKdjY6CiogTnVtYmVyIG9m
IHN0eWxlL2NsZWFudXBzIHN1Z2dlc3RlZCBieSBCcmlhbgp2NzoKKiBXaGl0ZXNwYWNlIGZpeHVw
IGZvciBjaGVja3BhdGNoCnY4OgoqIE1vcmUgY2hlY2twYXRjaCB3aGl0ZXNwYWNlIGZpeHVwcwp2
OToKKiBCZXR0ZXIgaGFuZGxpbmcgZXJyb3IgcmV0dXJucyBvdXQgdG8gbWFpbiwgc3VnZ2VzdGVk
CiAgYnkgQnJpYW4gU3RhcmtleQoqIFN3aXRjaCB0byB1c2luZyBzbnByaW50Ziwgc3VnZ2VzdGVk
IGJ5IEJyaWFuCnYxNDoKKiBGaXggYSBtaXNzaW5nIHJldHVybiB2YWx1ZQoqIEFkZCBjYWxscyB0
byB0ZXN0IHRoZSBHRVRfRkVBVFVSRVMgaW9jdGwKKiBCdWlsZCBmaXggcmVwb3J0ZWQgYnkga2Vy
bmVsIHRlc3Qgcm9ib3QgPGxrcEBpbnRlbC5jb20+CiAgYW5kIGZpeGVkIGJ5IFhpYW8gWWFuZyA8
aWNlX3lhbmd4aWFvQDE2My5jb20+CiogTWlub3IgTWFrZWZpbGUgY2xlYW51cHMKdjE1OgoqIFJl
bW92ZSB1c2FnZSBvZiBkcm9wcGVkIGdldF9mZWF0dXJlcyBpb2N0bAotLS0KIHRvb2xzL3Rlc3Rp
bmcvc2VsZnRlc3RzL2RtYWJ1Zi1oZWFwcy9NYWtlZmlsZSB8ICAgNiArCiAuLi4vc2VsZnRlc3Rz
L2RtYWJ1Zi1oZWFwcy9kbWFidWYtaGVhcC5jICAgICAgfCAyMzggKysrKysrKysrKysrKysrKysr
CiAyIGZpbGVzIGNoYW5nZWQsIDI0NCBpbnNlcnRpb25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQg
dG9vbHMvdGVzdGluZy9zZWxmdGVzdHMvZG1hYnVmLWhlYXBzL01ha2VmaWxlCiBjcmVhdGUgbW9k
ZSAxMDA2NDQgdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMvZG1hYnVmLWhlYXBzL2RtYWJ1Zi1oZWFw
LmMKCmRpZmYgLS1naXQgYS90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9kbWFidWYtaGVhcHMvTWFr
ZWZpbGUgYi90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9kbWFidWYtaGVhcHMvTWFrZWZpbGUKbmV3
IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi42MDdjMmFjZDIwODIKLS0tIC9k
ZXYvbnVsbAorKysgYi90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9kbWFidWYtaGVhcHMvTWFrZWZp
bGUKQEAgLTAsMCArMSw2IEBACisjIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCitD
RkxBR1MgKz0gLXN0YXRpYyAtTzMgLVdsLC1uby1hcy1uZWVkZWQgLVdhbGwgLUkuLi8uLi8uLi8u
Li91c3IvaW5jbHVkZQorCitURVNUX0dFTl9QUk9HUyA9IGRtYWJ1Zi1oZWFwCisKK2luY2x1ZGUg
Li4vbGliLm1rCmRpZmYgLS1naXQgYS90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9kbWFidWYtaGVh
cHMvZG1hYnVmLWhlYXAuYyBiL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2RtYWJ1Zi1oZWFwcy9k
bWFidWYtaGVhcC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uZWZj
YTA2N2JhOTZjCi0tLSAvZGV2L251bGwKKysrIGIvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMvZG1h
YnVmLWhlYXBzL2RtYWJ1Zi1oZWFwLmMKQEAgLTAsMCArMSwyMzggQEAKKy8vIFNQRFgtTGljZW5z
ZS1JZGVudGlmaWVyOiBHUEwtMi4wCisKKyNpbmNsdWRlIDxkaXJlbnQuaD4KKyNpbmNsdWRlIDxl
cnJuby5oPgorI2luY2x1ZGUgPGZjbnRsLmg+CisjaW5jbHVkZSA8c3RkaW8uaD4KKyNpbmNsdWRl
IDxzdGRsaWIuaD4KKyNpbmNsdWRlIDxzdGRpbnQuaD4KKyNpbmNsdWRlIDxzdHJpbmcuaD4KKyNp
bmNsdWRlIDx1bmlzdGQuaD4KKyNpbmNsdWRlIDxzeXMvaW9jdGwuaD4KKyNpbmNsdWRlIDxzeXMv
bW1hbi5oPgorI2luY2x1ZGUgPHN5cy90eXBlcy5oPgorCisjaW5jbHVkZSA8bGludXgvZG1hLWJ1
Zi5oPgorI2luY2x1ZGUgPGRybS9kcm0uaD4KKworI2luY2x1ZGUgIi4uLy4uLy4uLy4uL2luY2x1
ZGUvdWFwaS9saW51eC9kbWEtaGVhcC5oIgorCisjZGVmaW5lIERFVlBBVEggIi9kZXYvZG1hX2hl
YXAiCisKK3N0YXRpYyBpbnQgY2hlY2tfdmdlbShpbnQgZmQpCit7CisJZHJtX3ZlcnNpb25fdCB2
ZXJzaW9uID0geyAwIH07CisJY2hhciBuYW1lWzVdOworCWludCByZXQ7CisKKwl2ZXJzaW9uLm5h
bWVfbGVuID0gNDsKKwl2ZXJzaW9uLm5hbWUgPSBuYW1lOworCisJcmV0ID0gaW9jdGwoZmQsIERS
TV9JT0NUTF9WRVJTSU9OLCAmdmVyc2lvbik7CisJaWYgKHJldCkKKwkJcmV0dXJuIDA7CisKKwly
ZXR1cm4gIXN0cmNtcChuYW1lLCAidmdlbSIpOworfQorCitzdGF0aWMgaW50IG9wZW5fdmdlbSh2
b2lkKQoreworCWludCBpLCBmZDsKKwljb25zdCBjaGFyICpkcm1zdHIgPSAiL2Rldi9kcmkvY2Fy
ZCI7CisKKwlmZCA9IC0xOworCWZvciAoaSA9IDA7IGkgPCAxNjsgaSsrKSB7CisJCWNoYXIgbmFt
ZVs4MF07CisKKwkJc25wcmludGYobmFtZSwgODAsICIlcyV1IiwgZHJtc3RyLCBpKTsKKworCQlm
ZCA9IG9wZW4obmFtZSwgT19SRFdSKTsKKwkJaWYgKGZkIDwgMCkKKwkJCWNvbnRpbnVlOworCisJ
CWlmICghY2hlY2tfdmdlbShmZCkpIHsKKwkJCWNsb3NlKGZkKTsKKwkJCWZkID0gLTE7CisJCQlj
b250aW51ZTsKKwkJfSBlbHNlIHsKKwkJCWJyZWFrOworCQl9CisJfQorCXJldHVybiBmZDsKK30K
Kworc3RhdGljIGludCBpbXBvcnRfdmdlbV9mZChpbnQgdmdlbV9mZCwgaW50IGRtYV9idWZfZmQs
IHVpbnQzMl90ICpoYW5kbGUpCit7CisJc3RydWN0IGRybV9wcmltZV9oYW5kbGUgaW1wb3J0X2hh
bmRsZSA9IHsKKwkJLmZkID0gZG1hX2J1Zl9mZCwKKwkJLmZsYWdzID0gMCwKKwkJLmhhbmRsZSA9
IDAsCisJIH07CisJaW50IHJldDsKKworCXJldCA9IGlvY3RsKHZnZW1fZmQsIERSTV9JT0NUTF9Q
UklNRV9GRF9UT19IQU5ETEUsICZpbXBvcnRfaGFuZGxlKTsKKwlpZiAocmV0ID09IDApCisJCSpo
YW5kbGUgPSBpbXBvcnRfaGFuZGxlLmhhbmRsZTsKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMg
dm9pZCBjbG9zZV9oYW5kbGUoaW50IHZnZW1fZmQsIHVpbnQzMl90IGhhbmRsZSkKK3sKKwlzdHJ1
Y3QgZHJtX2dlbV9jbG9zZSBjbG9zZSA9IHsKKwkJLmhhbmRsZSA9IGhhbmRsZSwKKwl9OworCisJ
aW9jdGwodmdlbV9mZCwgRFJNX0lPQ1RMX0dFTV9DTE9TRSwgJmNsb3NlKTsKK30KKworc3RhdGlj
IGludCBkbWFidWZfaGVhcF9vcGVuKGNoYXIgKm5hbWUpCit7CisJaW50IHJldCwgZmQ7CisJY2hh
ciBidWZbMjU2XTsKKworCXJldCA9IHNucHJpbnRmKGJ1ZiwgMjU2LCAiJXMvJXMiLCBERVZQQVRI
LCBuYW1lKTsKKwlpZiAocmV0IDwgMCkgeworCQlwcmludGYoInNucHJpbnRmIGZhaWxlZCFcbiIp
OworCQlyZXR1cm4gcmV0OworCX0KKworCWZkID0gb3BlbihidWYsIE9fUkRXUik7CisJaWYgKGZk
IDwgMCkKKwkJcHJpbnRmKCJvcGVuICVzIGZhaWxlZCFcbiIsIGJ1Zik7CisJcmV0dXJuIGZkOwor
fQorCitzdGF0aWMgaW50IGRtYWJ1Zl9oZWFwX2FsbG9jKGludCBmZCwgc2l6ZV90IGxlbiwgdW5z
aWduZWQgaW50IGZsYWdzLAorCQkJICAgICBpbnQgKmRtYWJ1Zl9mZCkKK3sKKwlzdHJ1Y3QgZG1h
X2hlYXBfYWxsb2NhdGlvbl9kYXRhIGRhdGEgPSB7CisJCS5sZW4gPSBsZW4sCisJCS5mZF9mbGFn
cyA9IE9fUkRXUiB8IE9fQ0xPRVhFQywKKwkJLmhlYXBfZmxhZ3MgPSBmbGFncywKKwl9OworCWlu
dCByZXQ7CisKKwlpZiAoIWRtYWJ1Zl9mZCkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlyZXQgPSBp
b2N0bChmZCwgRE1BX0hFQVBfSU9DX0FMTE9DLCAmZGF0YSk7CisJaWYgKHJldCA8IDApCisJCXJl
dHVybiByZXQ7CisJKmRtYWJ1Zl9mZCA9IChpbnQpZGF0YS5mZDsKKwlyZXR1cm4gcmV0OworfQor
CitzdGF0aWMgdm9pZCBkbWFidWZfc3luYyhpbnQgZmQsIGludCBzdGFydF9zdG9wKQoreworCXN0
cnVjdCBkbWFfYnVmX3N5bmMgc3luYyA9IHsKKwkJLmZsYWdzID0gc3RhcnRfc3RvcCB8IERNQV9C
VUZfU1lOQ19SVywKKwl9OworCWludCByZXQ7CisKKwlyZXQgPSBpb2N0bChmZCwgRE1BX0JVRl9J
T0NUTF9TWU5DLCAmc3luYyk7CisJaWYgKHJldCkKKwkJcHJpbnRmKCJzeW5jIGZhaWxlZCAlZFxu
IiwgZXJybm8pOworfQorCisjZGVmaW5lIE9ORV9NRUcgKDEwMjQgKiAxMDI0KQorCitzdGF0aWMg
aW50IGRvX3Rlc3QoY2hhciAqaGVhcF9uYW1lKQoreworCWludCBoZWFwX2ZkID0gLTEsIGRtYWJ1
Zl9mZCA9IC0xLCBpbXBvcnRlcl9mZCA9IC0xOworCXVpbnQzMl90IGhhbmRsZSA9IDA7CisJdm9p
ZCAqcCA9IE5VTEw7CisJaW50IHJldDsKKworCXByaW50ZigiVGVzdGluZyBoZWFwOiAlc1xuIiwg
aGVhcF9uYW1lKTsKKworCWhlYXBfZmQgPSBkbWFidWZfaGVhcF9vcGVuKGhlYXBfbmFtZSk7CisJ
aWYgKGhlYXBfZmQgPCAwKQorCQlyZXR1cm4gLTE7CisKKwlwcmludGYoIkFsbG9jYXRpbmcgMSBN
RUdcbiIpOworCXJldCA9IGRtYWJ1Zl9oZWFwX2FsbG9jKGhlYXBfZmQsIE9ORV9NRUcsIDAsICZk
bWFidWZfZmQpOworCWlmIChyZXQpIHsKKwkJcHJpbnRmKCJBbGxvY2F0aW9uIEZhaWxlZCFcbiIp
OworCQlyZXQgPSAtMTsKKwkJZ290byBvdXQ7CisJfQorCS8qIG1tYXAgYW5kIHdyaXRlIGEgc2lt
cGxlIHBhdHRlcm4gKi8KKwlwID0gbW1hcChOVUxMLAorCQkgT05FX01FRywKKwkJIFBST1RfUkVB
RCB8IFBST1RfV1JJVEUsCisJCSBNQVBfU0hBUkVELAorCQkgZG1hYnVmX2ZkLAorCQkgMCk7CisJ
aWYgKHAgPT0gTUFQX0ZBSUxFRCkgeworCQlwcmludGYoIm1tYXAoKSBmYWlsZWQ6ICVtXG4iKTsK
KwkJcmV0ID0gLTE7CisJCWdvdG8gb3V0OworCX0KKwlwcmludGYoIm1tYXAgcGFzc2VkXG4iKTsK
KworCWRtYWJ1Zl9zeW5jKGRtYWJ1Zl9mZCwgRE1BX0JVRl9TWU5DX1NUQVJUKTsKKwltZW1zZXQo
cCwgMSwgT05FX01FRyAvIDIpOworCW1lbXNldCgoY2hhciAqKXAgKyBPTkVfTUVHIC8gMiwgMCwg
T05FX01FRyAvIDIpOworCWRtYWJ1Zl9zeW5jKGRtYWJ1Zl9mZCwgRE1BX0JVRl9TWU5DX0VORCk7
CisKKwlpbXBvcnRlcl9mZCA9IG9wZW5fdmdlbSgpOworCWlmIChpbXBvcnRlcl9mZCA8IDApIHsK
KwkJcmV0ID0gaW1wb3J0ZXJfZmQ7CisJCXByaW50ZigiRmFpbGVkIHRvIG9wZW4gdmdlbVxuIik7
CisJCWdvdG8gb3V0OworCX0KKworCXJldCA9IGltcG9ydF92Z2VtX2ZkKGltcG9ydGVyX2ZkLCBk
bWFidWZfZmQsICZoYW5kbGUpOworCWlmIChyZXQgPCAwKSB7CisJCXByaW50ZigiRmFpbGVkIHRv
IGltcG9ydCBidWZmZXJcbiIpOworCQlnb3RvIG91dDsKKwl9CisJcHJpbnRmKCJpbXBvcnQgcGFz
c2VkXG4iKTsKKworCWRtYWJ1Zl9zeW5jKGRtYWJ1Zl9mZCwgRE1BX0JVRl9TWU5DX1NUQVJUKTsK
KwltZW1zZXQocCwgMHhmZiwgT05FX01FRyk7CisJZG1hYnVmX3N5bmMoZG1hYnVmX2ZkLCBETUFf
QlVGX1NZTkNfRU5EKTsKKwlwcmludGYoInN5bmNzIHBhc3NlZFxuIik7CisKKwljbG9zZV9oYW5k
bGUoaW1wb3J0ZXJfZmQsIGhhbmRsZSk7CisJcmV0ID0gMDsKKworb3V0OgorCWlmIChwKQorCQlt
dW5tYXAocCwgT05FX01FRyk7CisJaWYgKGltcG9ydGVyX2ZkID49IDApCisJCWNsb3NlKGltcG9y
dGVyX2ZkKTsKKwlpZiAoZG1hYnVmX2ZkID49IDApCisJCWNsb3NlKGRtYWJ1Zl9mZCk7CisJaWYg
KGhlYXBfZmQgPj0gMCkKKwkJY2xvc2UoaGVhcF9mZCk7CisKKwlyZXR1cm4gcmV0OworfQorCitp
bnQgbWFpbih2b2lkKQoreworCURJUiAqZDsKKwlzdHJ1Y3QgZGlyZW50ICpkaXI7CisJaW50IHJl
dCA9IC0xOworCisJZCA9IG9wZW5kaXIoREVWUEFUSCk7CisJaWYgKCFkKSB7CisJCXByaW50Zigi
Tm8gJXMgZGlyZWN0b3J5P1xuIiwgREVWUEFUSCk7CisJCXJldHVybiAtMTsKKwl9CisKKwl3aGls
ZSAoKGRpciA9IHJlYWRkaXIoZCkpICE9IE5VTEwpIHsKKwkJaWYgKCFzdHJuY21wKGRpci0+ZF9u
YW1lLCAiLiIsIDIpKQorCQkJY29udGludWU7CisJCWlmICghc3RybmNtcChkaXItPmRfbmFtZSwg
Ii4uIiwgMykpCisJCQljb250aW51ZTsKKworCQlyZXQgPSBkb190ZXN0KGRpci0+ZF9uYW1lKTsK
KwkJaWYgKHJldCkKKwkJCWJyZWFrOworCX0KKwljbG9zZWRpcihkKTsKKworCXJldHVybiByZXQ7
Cit9Ci0tIAoyLjE3LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9w
Lm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1k
ZXZlbA==
