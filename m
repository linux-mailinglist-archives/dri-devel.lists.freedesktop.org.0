Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 278F7122C8
	for <lists+dri-devel@lfdr.de>; Thu,  2 May 2019 21:50:24 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 11FF189815;
	Thu,  2 May 2019 19:50:22 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-qt1-x841.google.com (mail-qt1-x841.google.com
 [IPv6:2607:f8b0:4864:20::841])
 by gabe.freedesktop.org (Postfix) with ESMTPS id C0BE489815
 for <dri-devel@lists.freedesktop.org>; Thu,  2 May 2019 19:50:20 +0000 (UTC)
Received: by mail-qt1-x841.google.com with SMTP id j6so4108865qtq.1
 for <dri-devel@lists.freedesktop.org>; Thu, 02 May 2019 12:50:20 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=xXRjMMNgMJ7AR2t39ARJeKFFNMtttw1Pb6pW3nWpIeo=;
 b=YnSbisScy8zXtaCOF9s/qk1d1iNUcANy7fvuD8C+6kCmi5et1kxHd0Pnekc8FFz3yg
 QHb2Z1nLKNNJh7sv1bnfHJe4gfW2Hf4HdzYF5dNDxqxxVWfqgBrO9MneNLSNLmD95aRn
 3sqjkRK5PZlESMGeNiqkIUqtZVLxOSAYhyXwqE96RnTqdWsxGgEgN6tlB+N7XnaNPQgL
 IJ9Vql0lsFWlRhqDLsjhjWgZR+stJzB25Flv40qy+j0MVn3w0k94G7bMhF7L4KXsq52g
 bkNpqWcFLsUWtlvdJPw+5SOyj9mLlSdrCCCeHZeyoK7IcMCtk6uBs/YscSOlMJsviBRy
 mFgg==
X-Gm-Message-State: APjAAAW7vM8Bt1PjgF5M5pgYnyUK3j5vczTvT6ir4tBv11txn3ZLQrrg
 5zbyy2jWz2w9uvX5TLwv69LUZr4D+Kc=
X-Google-Smtp-Source: APXvYqzWq5f7dg4chyhc8zhSywRQMasOAeaYaXAtFzVut/t+aNoPXXx9mn7F3d8OSMUcDa/VuWMd3g==
X-Received: by 2002:a0c:ff21:: with SMTP id x1mr4814780qvt.30.1556826619691;
 Thu, 02 May 2019 12:50:19 -0700 (PDT)
Received: from rosewood.cam.corp.google.com
 ([2620:0:1013:11:89c6:2139:5435:371d])
 by smtp.gmail.com with ESMTPSA id k36sm34366qtc.52.2019.05.02.12.50.18
 (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
 Thu, 02 May 2019 12:50:19 -0700 (PDT)
From: Sean Paul <sean@poorly.run>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v3 03/10] drm: Add atomic variants for bridge enable/disable
Date: Thu,  2 May 2019 15:49:45 -0400
Message-Id: <20190502194956.218441-4-sean@poorly.run>
X-Mailer: git-send-email 2.21.0.593.g511ec345e18-goog
In-Reply-To: <20190502194956.218441-1-sean@poorly.run>
References: <20190502194956.218441-1-sean@poorly.run>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=poorly.run; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=xXRjMMNgMJ7AR2t39ARJeKFFNMtttw1Pb6pW3nWpIeo=;
 b=CG2fV4o5E0VsgIzVpLdO9WU6LS3o8P2C48qJUjmPnYfDrmg84QHO0QIQOJnK8kPYU4
 WA+BhLJ1wZ4AdvT8WN9gG8qZY44ljZM9LeAdeJOXmWkcL7SuDfwmZYcTyQ7k8pB44HMo
 Np+rEOV30AH23gmvihg2oC2E8NN8N1QkZa21B4uAdDtrP0lhcQ/HGiZC4g4Sw/bKz4zi
 j2XMVV2DFtAwJ5K4kFGEZtwc9KyZ24EFhC4qXkLV7M00oIgr68pOCBvT8SHkRaMryZCQ
 s0y0oMBLA+nMXiZ5o//+ZekDzXYRmFkD3lXmS1IgOmvU4me41NkTWG2u7jV450M/UrmD
 Hl6w==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Maxime Ripard <maxime.ripard@bootlin.com>, linux-kernel@vger.kernel.org,
 David Airlie <airlied@linux.ie>, Sean Paul <seanpaul@chromium.org>,
 Sean Paul <sean@poorly.run>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogU2VhbiBQYXVsIDxzZWFucGF1bEBjaHJvbWl1bS5vcmc+CgpUaGlzIHBhdGNoIGFkZHMg
YXRvbWljIHZhcmlhbnRzIGZvciBhbGwgb2YKcHJlX2VuYWJsZS9lbmFibGUvZGlzYWJsZS9wb3N0
X2Rpc2FibGUgYnJpZGdlIGZ1bmN0aW9ucy4gVGhlc2Ugd2lsbCBiZQpjYWxsZWQgZnJvbSB0aGUg
YXBwcm9wcmlhdGUgYXRvbWljIGhlbHBlciBmdW5jdGlvbnMuIElmIHRoZSBicmlkZ2UKZHJpdmVy
IGRvZXNuJ3QgaW1wbGVtZW50IHRoZSBhdG9taWMgdmVyc2lvbiBvZiB0aGUgZnVuY3Rpb24sIHdl
IHdpbGwKZmFsbCBiYWNrIHRvIHRoZSB2YW5pbGxhIGltcGxlbWVudGF0aW9uLgoKTm90ZSB0aGF0
IHNvbWUgZHJpdmVycyBjYWxsIGRybV9icmlkZ2VfZGlzYWJsZSBkaXJlY3RseSwgYW5kIHRoZXNl
IGNhc2VzCmFyZSBub3QgY292ZXJlZC4gSXQncyB1cCB0byB0aGUgZHJpdmVyIHRvIGRlY2lkZSB3
aGV0aGVyIHRvIGltcGxlbWVudApib3RoIGF0b21pY19kaXNhYmxlIGFuZCBkaXNhYmxlLCBvciBp
ZiBpdCdzIG5vdCBuZWNlc3NhcnkuCgpDaGFuZ2VzIGluIHYzOgotIEFkZGVkIHRvIHRoZSBwYXRj
aHNldAoKQ2M6IERhbmllbCBWZXR0ZXIgPGRhbmllbEBmZndsbC5jaD4KQ2M6IFZpbGxlIFN5cmrD
pGzDpCA8dmlsbGUuc3lyamFsYUBsaW51eC5pbnRlbC5jb20+ClNpZ25lZC1vZmYtYnk6IFNlYW4g
UGF1bCA8c2VhbnBhdWxAY2hyb21pdW0ub3JnPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9kcm1fYXRv
bWljX2hlbHBlci5jIHwgICA4ICstCiBkcml2ZXJzL2dwdS9kcm0vZHJtX2JyaWRnZS5jICAgICAg
ICB8IDExMCArKysrKysrKysrKysrKysrKysrKysrKysrKysKIGluY2x1ZGUvZHJtL2RybV9icmlk
Z2UuaCAgICAgICAgICAgIHwgMTE0ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysKIDMgZmls
ZXMgY2hhbmdlZCwgMjI4IGluc2VydGlvbnMoKyksIDQgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2RybV9hdG9taWNfaGVscGVyLmMgYi9kcml2ZXJzL2dwdS9kcm0v
ZHJtX2F0b21pY19oZWxwZXIuYwppbmRleCAxZjgxY2E4ZGFhZDcuLjlkOWU0NzI3NjgzOSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2RybV9hdG9taWNfaGVscGVyLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2RybV9hdG9taWNfaGVscGVyLmMKQEAgLTk5NSw3ICs5OTUsNyBAQCBkaXNhYmxl
X291dHB1dHMoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgc3RydWN0IGRybV9hdG9taWNfc3RhdGUg
Km9sZF9zdGF0ZSkKIAkJICogRWFjaCBlbmNvZGVyIGhhcyBhdCBtb3N0IG9uZSBjb25uZWN0b3Ig
KHNpbmNlIHdlIGFsd2F5cyBzdGVhbAogCQkgKiBpdCBhd2F5KSwgc28gd2Ugd29uJ3QgY2FsbCBk
aXNhYmxlIGhvb2tzIHR3aWNlLgogCQkgKi8KLQkJZHJtX2JyaWRnZV9kaXNhYmxlKGVuY29kZXIt
PmJyaWRnZSk7CisJCWRybV9hdG9taWNfYnJpZGdlX2Rpc2FibGUoZW5jb2Rlci0+YnJpZGdlLCBv
bGRfc3RhdGUpOwogCiAJCS8qIFJpZ2h0IGZ1bmN0aW9uIGRlcGVuZHMgdXBvbiB0YXJnZXQgc3Rh
dGUuICovCiAJCWlmIChmdW5jcykgewpAQCAtMTAwOSw3ICsxMDA5LDcgQEAgZGlzYWJsZV9vdXRw
dXRzKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpvbGRf
c3RhdGUpCiAJCQkJZnVuY3MtPmRwbXMoZW5jb2RlciwgRFJNX01PREVfRFBNU19PRkYpOwogCQl9
CiAKLQkJZHJtX2JyaWRnZV9wb3N0X2Rpc2FibGUoZW5jb2Rlci0+YnJpZGdlKTsKKwkJZHJtX2F0
b21pY19icmlkZ2VfcG9zdF9kaXNhYmxlKGVuY29kZXItPmJyaWRnZSwgb2xkX3N0YXRlKTsKIAl9
CiAKIAlmb3JfZWFjaF9vbGRuZXdfY3J0Y19pbl9zdGF0ZShvbGRfc3RhdGUsIGNydGMsIG9sZF9j
cnRjX3N0YXRlLCBuZXdfY3J0Y19zdGF0ZSwgaSkgewpAQCAtMTMwOCw3ICsxMzA4LDcgQEAgdm9p
ZCBkcm1fYXRvbWljX2hlbHBlcl9jb21taXRfbW9kZXNldF9lbmFibGVzKHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYsCiAJCSAqIEVhY2ggZW5jb2RlciBoYXMgYXQgbW9zdCBvbmUgY29ubmVjdG9yIChz
aW5jZSB3ZSBhbHdheXMgc3RlYWwKIAkJICogaXQgYXdheSksIHNvIHdlIHdvbid0IGNhbGwgZW5h
YmxlIGhvb2tzIHR3aWNlLgogCQkgKi8KLQkJZHJtX2JyaWRnZV9wcmVfZW5hYmxlKGVuY29kZXIt
PmJyaWRnZSk7CisJCWRybV9hdG9taWNfYnJpZGdlX3ByZV9lbmFibGUoZW5jb2Rlci0+YnJpZGdl
LCBvbGRfc3RhdGUpOwogCiAJCWlmIChmdW5jcykgewogCQkJaWYgKGZ1bmNzLT5hdG9taWNfZW5h
YmxlKQpAQCAtMTMxOSw3ICsxMzE5LDcgQEAgdm9pZCBkcm1fYXRvbWljX2hlbHBlcl9jb21taXRf
bW9kZXNldF9lbmFibGVzKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJCQkJZnVuY3MtPmNvbW1p
dChlbmNvZGVyKTsKIAkJfQogCi0JCWRybV9icmlkZ2VfZW5hYmxlKGVuY29kZXItPmJyaWRnZSk7
CisJCWRybV9hdG9taWNfYnJpZGdlX2VuYWJsZShlbmNvZGVyLT5icmlkZ2UsIG9sZF9zdGF0ZSk7
CiAJfQogCiAJZHJtX2F0b21pY19oZWxwZXJfY29tbWl0X3dyaXRlYmFja3MoZGV2LCBvbGRfc3Rh
dGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2RybV9icmlkZ2UuYyBiL2RyaXZlcnMv
Z3B1L2RybS9kcm1fYnJpZGdlLmMKaW5kZXggMTM4YjI3MTFkMzg5Li5hY2NjY2I1ODZhZGYgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9kcm1fYnJpZGdlLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2RybV9icmlkZ2UuYwpAQCAtMzUyLDYgKzM1MiwxMTYgQEAgdm9pZCBkcm1fYnJpZGdlX2Vu
YWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKQogfQogRVhQT1JUX1NZTUJPTChkcm1fYnJp
ZGdlX2VuYWJsZSk7CiAKKy8qKgorICogZHJtX2F0b21pY19icmlkZ2VfZGlzYWJsZSAtIGRpc2Fi
bGVzIGFsbCBicmlkZ2VzIGluIHRoZSBlbmNvZGVyIGNoYWluCisgKiBAYnJpZGdlOiBicmlkZ2Ug
Y29udHJvbCBzdHJ1Y3R1cmUKKyAqIEBzdGF0ZTogYXRvbWljIHN0YXRlIGJlaW5nIGNvbW1pdHRl
ZAorICoKKyAqIENhbGxzICZkcm1fYnJpZGdlX2Z1bmNzLmF0b21pY19kaXNhYmxlIChmYWxscyBi
YWNrIG9uCisgKiAmZHJtX2JyaWRnZV9mdW5jcy5kaXNhYmxlKSBvcCBmb3IgYWxsIHRoZSBicmlk
Z2VzIGluIHRoZSBlbmNvZGVyIGNoYWluLAorICogc3RhcnRpbmcgZnJvbSB0aGUgbGFzdCBicmlk
Z2UgdG8gdGhlIGZpcnN0LiBUaGVzZSBhcmUgY2FsbGVkIGJlZm9yZSBjYWxsaW5nCisgKiB0aGUg
ZW5jb2RlcidzIHByZXBhcmUgb3AuCisgKgorICogTm90ZTogdGhlIGJyaWRnZSBwYXNzZWQgc2hv
dWxkIGJlIHRoZSBvbmUgY2xvc2VzdCB0byB0aGUgZW5jb2RlcgorICovCit2b2lkIGRybV9hdG9t
aWNfYnJpZGdlX2Rpc2FibGUoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSwKKwkJCSAgICAgICBz
dHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpCit7CisJaWYgKCFicmlkZ2UpCisJCXJldHVy
bjsKKworCWRybV9hdG9taWNfYnJpZGdlX2Rpc2FibGUoYnJpZGdlLT5uZXh0LCBzdGF0ZSk7CisK
KwlpZiAoYnJpZGdlLT5mdW5jcy0+YXRvbWljX2Rpc2FibGUpCisJCWJyaWRnZS0+ZnVuY3MtPmF0
b21pY19kaXNhYmxlKGJyaWRnZSwgc3RhdGUpOworCWVsc2UgaWYgKGJyaWRnZS0+ZnVuY3MtPmRp
c2FibGUpCisJCWJyaWRnZS0+ZnVuY3MtPmRpc2FibGUoYnJpZGdlKTsKK30KK0VYUE9SVF9TWU1C
T0woZHJtX2F0b21pY19icmlkZ2VfZGlzYWJsZSk7CisKKy8qKgorICogZHJtX2F0b21pY19icmlk
Z2VfcG9zdF9kaXNhYmxlIC0gY2xlYW5zIHVwIGFmdGVyIGRpc2FibGluZyBhbGwgYnJpZGdlcyBp
biB0aGUKKyAqCQkJCSAgICBlbmNvZGVyIGNoYWluCisgKiBAYnJpZGdlOiBicmlkZ2UgY29udHJv
bCBzdHJ1Y3R1cmUKKyAqIEBzdGF0ZTogYXRvbWljIHN0YXRlIGJlaW5nIGNvbW1pdHRlZAorICoK
KyAqIENhbGxzICZkcm1fYnJpZGdlX2Z1bmNzLmF0b21pY19wb3N0X2Rpc2FibGUgKGZhbGxzIGJh
Y2sgb24KKyAqICZkcm1fYnJpZGdlX2Z1bmNzLnBvc3RfZGlzYWJsZSkgb3AgZm9yIGFsbCB0aGUg
YnJpZGdlcyBpbiB0aGUgZW5jb2RlciBjaGFpbiwKKyAqIHN0YXJ0aW5nIGZyb20gdGhlIGZpcnN0
IGJyaWRnZSB0byB0aGUgbGFzdC4gVGhlc2UgYXJlIGNhbGxlZCBhZnRlciBjb21wbGV0aW5nCisg
KiB0aGUgZW5jb2RlcidzIHByZXBhcmUgb3AuCisgKgorICogTm90ZTogdGhlIGJyaWRnZSBwYXNz
ZWQgc2hvdWxkIGJlIHRoZSBvbmUgY2xvc2VzdCB0byB0aGUgZW5jb2RlcgorICovCit2b2lkIGRy
bV9hdG9taWNfYnJpZGdlX3Bvc3RfZGlzYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAor
CQkJCSAgICBzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpCit7CisJaWYgKCFicmlkZ2Up
CisJCXJldHVybjsKKworCWlmIChicmlkZ2UtPmZ1bmNzLT5hdG9taWNfcG9zdF9kaXNhYmxlKQor
CQlicmlkZ2UtPmZ1bmNzLT5hdG9taWNfcG9zdF9kaXNhYmxlKGJyaWRnZSwgc3RhdGUpOworCWVs
c2UgaWYgKGJyaWRnZS0+ZnVuY3MtPnBvc3RfZGlzYWJsZSkKKwkJYnJpZGdlLT5mdW5jcy0+cG9z
dF9kaXNhYmxlKGJyaWRnZSk7CisKKwlkcm1fYXRvbWljX2JyaWRnZV9wb3N0X2Rpc2FibGUoYnJp
ZGdlLT5uZXh0LCBzdGF0ZSk7Cit9CitFWFBPUlRfU1lNQk9MKGRybV9hdG9taWNfYnJpZGdlX3Bv
c3RfZGlzYWJsZSk7CisKKy8qKgorICogZHJtX2JyaWRnZV9wcmVfZW5hYmxlIC0gcHJlcGFyZXMg
Zm9yIGVuYWJsaW5nIGFsbCBicmlkZ2VzIGluIHRoZSBlbmNvZGVyCisgKgkJCSAgIGNoYWluCisg
KiBAYnJpZGdlOiBicmlkZ2UgY29udHJvbCBzdHJ1Y3R1cmUKKyAqIEBzdGF0ZTogYXRvbWljIHN0
YXRlIGJlaW5nIGNvbW1pdHRlZAorICoKKyAqIENhbGxzICZkcm1fYnJpZGdlX2Z1bmNzLnByZV9l
bmFibGUgKGZhbGxzIGJhY2sgb24KKyAqICZkcm1fYnJpZGdlX2Z1bmNzLnByZV9lbmFibGUpIG9w
IGZvciBhbGwgdGhlIGJyaWRnZXMgaW4gdGhlIGVuY29kZXIgY2hhaW4sCisgKiBzdGFydGluZyBm
cm9tIHRoZSBsYXN0IGJyaWRnZSB0byB0aGUgZmlyc3QuIFRoZXNlIGFyZSBjYWxsZWQgYmVmb3Jl
IGNhbGxpbmcKKyAqIHRoZSBlbmNvZGVyJ3MgY29tbWl0IG9wLgorICoKKyAqIE5vdGU6IHRoZSBi
cmlkZ2UgcGFzc2VkIHNob3VsZCBiZSB0aGUgb25lIGNsb3Nlc3QgdG8gdGhlIGVuY29kZXIKKyAq
Lwordm9pZCBkcm1fYXRvbWljX2JyaWRnZV9wcmVfZW5hYmxlKHN0cnVjdCBkcm1fYnJpZGdlICpi
cmlkZ2UsCisJCQkJICBzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpCit7CisJaWYgKCFi
cmlkZ2UpCisJCXJldHVybjsKKworCWRybV9hdG9taWNfYnJpZGdlX3ByZV9lbmFibGUoYnJpZGdl
LT5uZXh0LCBzdGF0ZSk7CisKKwlpZiAoYnJpZGdlLT5mdW5jcy0+YXRvbWljX3ByZV9lbmFibGUp
CisJCWJyaWRnZS0+ZnVuY3MtPmF0b21pY19wcmVfZW5hYmxlKGJyaWRnZSwgc3RhdGUpOworCWVs
c2UgaWYgKGJyaWRnZS0+ZnVuY3MtPnByZV9lbmFibGUpCisJCWJyaWRnZS0+ZnVuY3MtPnByZV9l
bmFibGUoYnJpZGdlKTsKK30KK0VYUE9SVF9TWU1CT0woZHJtX2F0b21pY19icmlkZ2VfcHJlX2Vu
YWJsZSk7CisKKy8qKgorICogZHJtX2F0b21pY19icmlkZ2VfZW5hYmxlIC0gZW5hYmxlcyBhbGwg
YnJpZGdlcyBpbiB0aGUgZW5jb2RlciBjaGFpbgorICogQGJyaWRnZTogYnJpZGdlIGNvbnRyb2wg
c3RydWN0dXJlCisgKiBAc3RhdGU6IGF0b21pYyBzdGF0ZSBiZWluZyBjb21taXR0ZWQKKyAqCisg
KiBDYWxscyAmZHJtX2JyaWRnZV9mdW5jcy5hdG9taWNfZW5hYmxlIChmYWxscyBiYWNrIG9uCisg
KiAmZHJtX2JyaWRnZV9mdW5jcy5lbmFibGUpIG9wIGZvciBhbGwgdGhlIGJyaWRnZXMgaW4gdGhl
IGVuY29kZXIgY2hhaW4sCisgKiBzdGFydGluZyBmcm9tIHRoZSBmaXJzdCBicmlkZ2UgdG8gdGhl
IGxhc3QuIFRoZXNlIGFyZSBjYWxsZWQgYWZ0ZXIgY29tcGxldGluZworICogdGhlIGVuY29kZXIn
cyBjb21taXQgb3AuCisgKgorICogTm90ZTogdGhlIGJyaWRnZSBwYXNzZWQgc2hvdWxkIGJlIHRo
ZSBvbmUgY2xvc2VzdCB0byB0aGUgZW5jb2RlcgorICovCit2b2lkIGRybV9hdG9taWNfYnJpZGdl
X2VuYWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAorCQkJICAgICAgc3RydWN0IGRybV9h
dG9taWNfc3RhdGUgKnN0YXRlKQoreworCWlmICghYnJpZGdlKQorCQlyZXR1cm47CisKKwlpZiAo
YnJpZGdlLT5mdW5jcy0+YXRvbWljX2VuYWJsZSkKKwkJYnJpZGdlLT5mdW5jcy0+YXRvbWljX2Vu
YWJsZShicmlkZ2UsIHN0YXRlKTsKKwllbHNlIGlmIChicmlkZ2UtPmZ1bmNzLT5lbmFibGUpCisJ
CWJyaWRnZS0+ZnVuY3MtPmVuYWJsZShicmlkZ2UpOworCisJZHJtX2F0b21pY19icmlkZ2VfZW5h
YmxlKGJyaWRnZS0+bmV4dCwgc3RhdGUpOworfQorRVhQT1JUX1NZTUJPTChkcm1fYXRvbWljX2Jy
aWRnZV9lbmFibGUpOworCiAjaWZkZWYgQ09ORklHX09GCiAvKioKICAqIG9mX2RybV9maW5kX2Jy
aWRnZSAtIGZpbmQgdGhlIGJyaWRnZSBjb3JyZXNwb25kaW5nIHRvIHRoZSBkZXZpY2Ugbm9kZSBp
bgpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kcm0vZHJtX2JyaWRnZS5oIGIvaW5jbHVkZS9kcm0vZHJt
X2JyaWRnZS5oCmluZGV4IGQ0NDI4OTEzYTRlMS4uODZmNDM2ODk1YzdiIDEwMDY0NAotLS0gYS9p
bmNsdWRlL2RybS9kcm1fYnJpZGdlLmgKKysrIGIvaW5jbHVkZS9kcm0vZHJtX2JyaWRnZS5oCkBA
IC0yMzcsNiArMjM3LDExMSBAQCBzdHJ1Y3QgZHJtX2JyaWRnZV9mdW5jcyB7CiAJICogVGhlIGVu
YWJsZSBjYWxsYmFjayBpcyBvcHRpb25hbC4KIAkgKi8KIAl2b2lkICgqZW5hYmxlKShzdHJ1Y3Qg
ZHJtX2JyaWRnZSAqYnJpZGdlKTsKKworCS8qKgorCSAqIEBhdG9taWNfcHJlX2VuYWJsZToKKwkg
KgorCSAqIFRoaXMgY2FsbGJhY2sgc2hvdWxkIGVuYWJsZSB0aGUgYnJpZGdlLiBJdCBpcyBjYWxs
ZWQgcmlnaHQgYmVmb3JlCisJICogdGhlIHByZWNlZGluZyBlbGVtZW50IGluIHRoZSBkaXNwbGF5
IHBpcGUgaXMgZW5hYmxlZC4gSWYgdGhlCisJICogcHJlY2VkaW5nIGVsZW1lbnQgaXMgYSBicmlk
Z2UgdGhpcyBtZWFucyBpdCdzIGNhbGxlZCBiZWZvcmUgdGhhdAorCSAqIGJyaWRnZSdzIEBhdG9t
aWNfcHJlX2VuYWJsZSBvciBAcHJlX2VuYWJsZSBmdW5jdGlvbi4gSWYgdGhlIHByZWNlZGluZwor
CSAqIGVsZW1lbnQgaXMgYSAmZHJtX2VuY29kZXIgaXQncyBjYWxsZWQgcmlnaHQgYmVmb3JlIHRo
ZSBlbmNvZGVyJ3MKKwkgKiAmZHJtX2VuY29kZXJfaGVscGVyX2Z1bmNzLmF0b21pY19lbmFibGUs
CisJICogJmRybV9lbmNvZGVyX2hlbHBlcl9mdW5jcy5lbmFibGUsICZkcm1fZW5jb2Rlcl9oZWxw
ZXJfZnVuY3MuY29tbWl0IG9yCisJICogJmRybV9lbmNvZGVyX2hlbHBlcl9mdW5jcy5kcG1zIGhv
b2suCisJICoKKwkgKiBUaGUgZGlzcGxheSBwaXBlIChpLmUuIGNsb2NrcyBhbmQgdGltaW5nIHNp
Z25hbHMpIGZlZWRpbmcgdGhpcyBicmlkZ2UKKwkgKiB3aWxsIG5vdCB5ZXQgYmUgcnVubmluZyB3
aGVuIHRoaXMgY2FsbGJhY2sgaXMgY2FsbGVkLiBUaGUgYnJpZGdlIG11c3QKKwkgKiBub3QgZW5h
YmxlIHRoZSBkaXNwbGF5IGxpbmsgZmVlZGluZyB0aGUgbmV4dCBicmlkZ2UgaW4gdGhlIGNoYWlu
IChpZgorCSAqIHRoZXJlIGlzIG9uZSkgd2hlbiB0aGlzIGNhbGxiYWNrIGlzIGNhbGxlZC4KKwkg
KgorCSAqIE5vdGUgdGhhdCB0aGlzIGZ1bmN0aW9uIHdpbGwgb25seSBiZSBpbnZva2VkIGluIHRo
ZSBjb250ZXh0IG9mIGFuCisJICogYXRvbWljIGNvbW1pdC4gSXQgd2lsbCBub3QgYmUgaW52b2tl
ZCBmcm9tICZkcm1fYnJpZGdlX3ByZV9lbmFibGUuIEl0CisJICogd291bGQgYmUgcHJ1ZGVudCB0
byBhbHNvIHByb3ZpZGUgYW4gaW1wbGVtZW50YXRpb24gb2YgQHByZV9lbmFibGUgaWYKKwkgKiB5
b3UgYXJlIGV4cGVjdGluZyBkcml2ZXIgY2FsbHMgaW50byAmZHJtX2JyaWRnZV9wcmVfZW5hYmxl
LgorCSAqCisJICogVGhlIEBhdG9taWNfcHJlX2VuYWJsZSBjYWxsYmFjayBpcyBvcHRpb25hbC4K
KwkgKi8KKwl2b2lkICgqYXRvbWljX3ByZV9lbmFibGUpKHN0cnVjdCBkcm1fYnJpZGdlICpicmlk
Z2UsCisJCQkJICBzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpOworCisJLyoqCisJICog
QGF0b21pY19lbmFibGU6CisJICoKKwkgKiBUaGlzIGNhbGxiYWNrIHNob3VsZCBlbmFibGUgdGhl
IGJyaWRnZS4gSXQgaXMgY2FsbGVkIHJpZ2h0IGFmdGVyCisJICogdGhlIHByZWNlZGluZyBlbGVt
ZW50IGluIHRoZSBkaXNwbGF5IHBpcGUgaXMgZW5hYmxlZC4gSWYgdGhlCisJICogcHJlY2VkaW5n
IGVsZW1lbnQgaXMgYSBicmlkZ2UgdGhpcyBtZWFucyBpdCdzIGNhbGxlZCBhZnRlciB0aGF0CisJ
ICogYnJpZGdlJ3MgQGF0b21pY19lbmFibGUgb3IgQGVuYWJsZSBmdW5jdGlvbi4gSWYgdGhlIHBy
ZWNlZGluZyBlbGVtZW50CisJICogaXMgYSAmZHJtX2VuY29kZXIgaXQncyBjYWxsZWQgcmlnaHQg
YWZ0ZXIgdGhlIGVuY29kZXIncworCSAqICZkcm1fZW5jb2Rlcl9oZWxwZXJfZnVuY3MuYXRvbWlj
X2VuYWJsZSwKKwkgKiAmZHJtX2VuY29kZXJfaGVscGVyX2Z1bmNzLmVuYWJsZSwgJmRybV9lbmNv
ZGVyX2hlbHBlcl9mdW5jcy5jb21taXQgb3IKKwkgKiAmZHJtX2VuY29kZXJfaGVscGVyX2Z1bmNz
LmRwbXMgaG9vay4KKwkgKgorCSAqIFRoZSBicmlkZ2UgY2FuIGFzc3VtZSB0aGF0IHRoZSBkaXNw
bGF5IHBpcGUgKGkuZS4gY2xvY2tzIGFuZCB0aW1pbmcKKwkgKiBzaWduYWxzKSBmZWVkaW5nIGl0
IGlzIHJ1bm5pbmcgd2hlbiB0aGlzIGNhbGxiYWNrIGlzIGNhbGxlZC4gVGhpcworCSAqIGNhbGxi
YWNrIG11c3QgZW5hYmxlIHRoZSBkaXNwbGF5IGxpbmsgZmVlZGluZyB0aGUgbmV4dCBicmlkZ2Ug
aW4gdGhlCisJICogY2hhaW4gaWYgdGhlcmUgaXMgb25lLgorCSAqCisJICogTm90ZSB0aGF0IHRo
aXMgZnVuY3Rpb24gd2lsbCBvbmx5IGJlIGludm9rZWQgaW4gdGhlIGNvbnRleHQgb2YgYW4KKwkg
KiBhdG9taWMgY29tbWl0LiBJdCB3aWxsIG5vdCBiZSBpbnZva2VkIGZyb20gJmRybV9icmlkZ2Vf
ZW5hYmxlLiBJdAorCSAqIHdvdWxkIGJlIHBydWRlbnQgdG8gYWxzbyBwcm92aWRlIGFuIGltcGxl
bWVudGF0aW9uIG9mIEBlbmFibGUgaWYKKwkgKiB5b3UgYXJlIGV4cGVjdGluZyBkcml2ZXIgY2Fs
bHMgaW50byAmZHJtX2JyaWRnZV9lbmFibGUuCisJICoKKwkgKiBUaGUgZW5hYmxlIGNhbGxiYWNr
IGlzIG9wdGlvbmFsLgorCSAqLworCXZvaWQgKCphdG9taWNfZW5hYmxlKShzdHJ1Y3QgZHJtX2Jy
aWRnZSAqYnJpZGdlLAorCQkJICAgICAgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKTsK
KwkvKioKKwkgKiBAYXRvbWljX2Rpc2FibGU6CisJICoKKwkgKiBUaGlzIGNhbGxiYWNrIHNob3Vs
ZCBkaXNhYmxlIHRoZSBicmlkZ2UuIEl0IGlzIGNhbGxlZCByaWdodCBiZWZvcmUKKwkgKiB0aGUg
cHJlY2VkaW5nIGVsZW1lbnQgaW4gdGhlIGRpc3BsYXkgcGlwZSBpcyBkaXNhYmxlZC4gSWYgdGhl
CisJICogcHJlY2VkaW5nIGVsZW1lbnQgaXMgYSBicmlkZ2UgdGhpcyBtZWFucyBpdCdzIGNhbGxl
ZCBiZWZvcmUgdGhhdAorCSAqIGJyaWRnZSdzIEBhdG9taWNfZGlzYWJsZSBvciBAZGlzYWJsZSB2
ZnVuYy4gSWYgdGhlIHByZWNlZGluZyBlbGVtZW50CisJICogaXMgYSAmZHJtX2VuY29kZXIgaXQn
cyBjYWxsZWQgcmlnaHQgYmVmb3JlIHRoZQorCSAqICZkcm1fZW5jb2Rlcl9oZWxwZXJfZnVuY3Mu
YXRvbWljX2Rpc2FibGUsCisJICogJmRybV9lbmNvZGVyX2hlbHBlcl9mdW5jcy5kaXNhYmxlLCAm
ZHJtX2VuY29kZXJfaGVscGVyX2Z1bmNzLnByZXBhcmUKKwkgKiBvciAmZHJtX2VuY29kZXJfaGVs
cGVyX2Z1bmNzLmRwbXMgaG9vay4KKwkgKgorCSAqIFRoZSBicmlkZ2UgY2FuIGFzc3VtZSB0aGF0
IHRoZSBkaXNwbGF5IHBpcGUgKGkuZS4gY2xvY2tzIGFuZCB0aW1pbmcKKwkgKiBzaWduYWxzKSBm
ZWVkaW5nIGl0IGlzIHN0aWxsIHJ1bm5pbmcgd2hlbiB0aGlzIGNhbGxiYWNrIGlzIGNhbGxlZC4K
KwkgKgorCSAqIE5vdGUgdGhhdCB0aGlzIGZ1bmN0aW9uIHdpbGwgb25seSBiZSBpbnZva2VkIGlu
IHRoZSBjb250ZXh0IG9mIGFuCisJICogYXRvbWljIGNvbW1pdC4gSXQgd2lsbCBub3QgYmUgaW52
b2tlZCBmcm9tICZkcm1fYnJpZGdlX2Rpc2FibGUuIEl0CisJICogd291bGQgYmUgcHJ1ZGVudCB0
byBhbHNvIHByb3ZpZGUgYW4gaW1wbGVtZW50YXRpb24gb2YgQGRpc2FibGUgaWYKKwkgKiB5b3Ug
YXJlIGV4cGVjdGluZyBkcml2ZXIgY2FsbHMgaW50byAmZHJtX2JyaWRnZV9kaXNhYmxlLgorCSAq
CisJICogVGhlIGRpc2FibGUgY2FsbGJhY2sgaXMgb3B0aW9uYWwuCisJICovCisJdm9pZCAoKmF0
b21pY19kaXNhYmxlKShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAorCQkJICAgICAgIHN0cnVj
dCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSk7CisKKwkvKioKKwkgKiBAYXRvbWljX3Bvc3RfZGlz
YWJsZToKKwkgKgorCSAqIFRoaXMgY2FsbGJhY2sgc2hvdWxkIGRpc2FibGUgdGhlIGJyaWRnZS4g
SXQgaXMgY2FsbGVkIHJpZ2h0IGFmdGVyIHRoZQorCSAqIHByZWNlZGluZyBlbGVtZW50IGluIHRo
ZSBkaXNwbGF5IHBpcGUgaXMgZGlzYWJsZWQuIElmIHRoZSBwcmVjZWRpbmcKKwkgKiBlbGVtZW50
IGlzIGEgYnJpZGdlIHRoaXMgbWVhbnMgaXQncyBjYWxsZWQgYWZ0ZXIgdGhhdCBicmlkZ2Uncwor
CSAqIEBhdG9taWNfcG9zdF9kaXNhYmxlIG9yIEBwb3N0X2Rpc2FibGUgZnVuY3Rpb24uIElmIHRo
ZSBwcmVjZWRpbmcKKwkgKiBlbGVtZW50IGlzIGEgJmRybV9lbmNvZGVyIGl0J3MgY2FsbGVkIHJp
Z2h0IGFmdGVyIHRoZSBlbmNvZGVyJ3MKKwkgKiAmZHJtX2VuY29kZXJfaGVscGVyX2Z1bmNzLmF0
b21pY19kaXNhYmxlLAorCSAqICZkcm1fZW5jb2Rlcl9oZWxwZXJfZnVuY3MuZGlzYWJsZSwgJmRy
bV9lbmNvZGVyX2hlbHBlcl9mdW5jcy5wcmVwYXJlCisJICogb3IgJmRybV9lbmNvZGVyX2hlbHBl
cl9mdW5jcy5kcG1zIGhvb2suCisJICoKKwkgKiBUaGUgYnJpZGdlIG11c3QgYXNzdW1lIHRoYXQg
dGhlIGRpc3BsYXkgcGlwZSAoaS5lLiBjbG9ja3MgYW5kIHRpbWluZworCSAqIHNpbmdhbHMpIGZl
ZWRpbmcgaXQgaXMgbm8gbG9uZ2VyIHJ1bm5pbmcgd2hlbiB0aGlzIGNhbGxiYWNrIGlzCisJICog
Y2FsbGVkLgorCSAqCisJICogTm90ZSB0aGF0IHRoaXMgZnVuY3Rpb24gd2lsbCBvbmx5IGJlIGlu
dm9rZWQgaW4gdGhlIGNvbnRleHQgb2YgYW4KKwkgKiBhdG9taWMgY29tbWl0LiBJdCB3aWxsIG5v
dCBiZSBpbnZva2VkIGZyb20gJmRybV9icmlkZ2VfcG9zdF9kaXNhYmxlLgorCSAqIEl0IHdvdWxk
IGJlIHBydWRlbnQgdG8gYWxzbyBwcm92aWRlIGFuIGltcGxlbWVudGF0aW9uIG9mCisJICogQHBv
c3RfZGlzYWJsZSBpZiB5b3UgYXJlIGV4cGVjdGluZyBkcml2ZXIgY2FsbHMgaW50bworCSAqICZk
cm1fYnJpZGdlX3Bvc3RfZGlzYWJsZS4KKwkgKgorCSAqIFRoZSBwb3N0X2Rpc2FibGUgY2FsbGJh
Y2sgaXMgb3B0aW9uYWwuCisJICovCisJdm9pZCAoKmF0b21pY19wb3N0X2Rpc2FibGUpKHN0cnVj
dCBkcm1fYnJpZGdlICpicmlkZ2UsCisJCQkJICAgIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpz
dGF0ZSk7CiB9OwogCiAvKioKQEAgLTMxNCw2ICs0MTksMTUgQEAgdm9pZCBkcm1fYnJpZGdlX21v
ZGVfc2V0KHN0cnVjdCBkcm1fYnJpZGdlICpicmlkZ2UsCiB2b2lkIGRybV9icmlkZ2VfcHJlX2Vu
YWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlKTsKIHZvaWQgZHJtX2JyaWRnZV9lbmFibGUo
c3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSk7CiAKK3ZvaWQgZHJtX2F0b21pY19icmlkZ2VfZGlz
YWJsZShzdHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAorCQkJICAgICAgIHN0cnVjdCBkcm1fYXRv
bWljX3N0YXRlICpzdGF0ZSk7Cit2b2lkIGRybV9hdG9taWNfYnJpZGdlX3Bvc3RfZGlzYWJsZShz
dHJ1Y3QgZHJtX2JyaWRnZSAqYnJpZGdlLAorCQkJCSAgICBzdHJ1Y3QgZHJtX2F0b21pY19zdGF0
ZSAqc3RhdGUpOwordm9pZCBkcm1fYXRvbWljX2JyaWRnZV9wcmVfZW5hYmxlKHN0cnVjdCBkcm1f
YnJpZGdlICpicmlkZ2UsCisJCQkJICBzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpOwor
dm9pZCBkcm1fYXRvbWljX2JyaWRnZV9lbmFibGUoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSwK
KwkJCSAgICAgIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSk7CisKICNpZmRlZiBDT05G
SUdfRFJNX1BBTkVMX0JSSURHRQogc3RydWN0IGRybV9icmlkZ2UgKmRybV9wYW5lbF9icmlkZ2Vf
YWRkKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsLAogCQkJCQl1MzIgY29ubmVjdG9yX3R5cGUpOwot
LSAKU2VhbiBQYXVsLCBTb2Z0d2FyZSBFbmdpbmVlciwgR29vZ2xlIC8gQ2hyb21pdW0gT1MKCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBt
YWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3Rz
LmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
