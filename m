Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 3F3A7FD7A1
	for <lists+dri-devel@lfdr.de>; Fri, 15 Nov 2019 09:06:01 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0686B6E127;
	Fri, 15 Nov 2019 08:05:46 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from alexa-out-blr-01.qualcomm.com (alexa-out-blr-01.qualcomm.com
 [103.229.18.197])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B03F16E5D9;
 Thu, 14 Nov 2019 10:23:13 +0000 (UTC)
Received: from ironmsg02-blr.qualcomm.com ([10.86.208.131])
 by alexa-out-blr-01.qualcomm.com with ESMTP/TLS/AES256-SHA;
 14 Nov 2019 15:46:57 +0530
IronPort-SDR: Ytnd3Uq1VHA7z6C3NJVdXUW7Hl2PVU5WKEjFj7v2oPk4qgDhNTO0RPTtXc9RmMN8sML/qv2SBU
 yO6aVvYjYuly0ky4Ps2aRUVMsJgpQVVHYGtFGxV5o1BXzTzQyUW3fyBeeJMMKfnLg8tjDBcNeB
 p1Ltw/Y69smJSLUYaLWFZVR/cwXt/LzixasnEITmlksXuzIiWdzEeRfwBULEv5RbIe+oJ7dJOl
 T2mKI2y/01Ua6ntod62p00LHmjlXhtSpIcSEihVBWQsHftmLzFkOuylutT9lgEXrZquSaFmOFi
 NIDFKcOhRnihMdPRk4kSU7ME
Received: from harigovi-linux.qualcomm.com ([10.204.66.147])
 by ironmsg02-blr.qualcomm.com with ESMTP; 14 Nov 2019 15:46:36 +0530
Received: by harigovi-linux.qualcomm.com (Postfix, from userid 2332695)
 id 9EE3026FF; Thu, 14 Nov 2019 15:46:35 +0530 (IST)
From: Harigovindan P <harigovi@codeaurora.org>
To: dri-devel@lists.freedesktop.org, linux-arm-msm@vger.kernel.org,
 freedreno@lists.freedesktop.org, devicetree@vger.kernel.org
Subject: [PATCH v1 1/2] drm/panel: add support for rm69299 visionox panel
 driver
Date: Thu, 14 Nov 2019 15:46:27 +0530
Message-Id: <1573726588-18897-2-git-send-email-harigovi@codeaurora.org>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1573726588-18897-1-git-send-email-harigovi@codeaurora.org>
References: <1573726588-18897-1-git-send-email-harigovi@codeaurora.org>
X-Mailman-Approved-At: Fri, 15 Nov 2019 08:05:26 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Harigovindan P <harigovi@codeaurora.org>, abhinavk@codeaurora.org,
 linux-kernel@vger.kernel.org, seanpaul@chromium.org, hoegsberg@chromium.org,
 chandanu@codeaurora.org
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIHN1cHBvcnQgZm9yIFZpc2lvbm94IHBhbmVsIGRyaXZlci4KClNpZ25lZC1vZmYtYnk6IEhh
cmlnb3ZpbmRhbiBQIDxoYXJpZ292aUBjb2RlYXVyb3JhLm9yZz4KLS0tCiBkcml2ZXJzL2dwdS9k
cm0vcGFuZWwvS2NvbmZpZyAgICAgICAgICAgICAgICAgIHwgICA5ICsKIGRyaXZlcnMvZ3B1L2Ry
bS9wYW5lbC9NYWtlZmlsZSAgICAgICAgICAgICAgICAgfCAgIDEgKwogZHJpdmVycy9ncHUvZHJt
L3BhbmVsL3BhbmVsLXZpc2lvbm94LXJtNjkyOTkuYyB8IDQ3OCArKysrKysrKysrKysrKysrKysr
KysrKysrCiAzIGZpbGVzIGNoYW5nZWQsIDQ4OCBpbnNlcnRpb25zKCspCiBjcmVhdGUgbW9kZSAx
MDA2NDQgZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLXZpc2lvbm94LXJtNjkyOTkuYwoKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9LY29uZmlnIGIvZHJpdmVycy9ncHUvZHJt
L3BhbmVsL0tjb25maWcKaW5kZXggZjE1MmJjNC4uYzA2YzQwMyAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL3BhbmVsL0tjb25maWcKKysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmVsL0tjb25m
aWcKQEAgLTM1NSw0ICszNTUsMTMgQEAgY29uZmlnIERSTV9QQU5FTF9UUlVMWV9OVDM1NTk3X1dR
WEdBCiAJaGVscAogCSAgU2F5IFkgaGVyZSBpZiB5b3Ugd2FudCB0byBlbmFibGUgc3VwcG9ydCBm
b3IgVHJ1bHkgTlQzNTU5NyBXUVhHQSBEdWFsIERTSQogCSAgVmlkZW8gTW9kZSBwYW5lbAorCitj
b25maWcgRFJNX1BBTkVMX1ZJU0lPTk9YX1JNNjkyOTkKKwl0cmlzdGF0ZSAiVmlzaW9ub3ggUk02
OTI5OSIKKwlkZXBlbmRzIG9uIE9GCisJZGVwZW5kcyBvbiBEUk1fTUlQSV9EU0kKKwloZWxwCisJ
ICBTYXkgWSBoZXJlIGlmIHlvdSB3YW50IHRvIGVuYWJsZSBzdXBwb3J0IGZvciBWaXNpb25veAor
CSAgUk02OTI5OSAgRFNJIFZpZGVvIE1vZGUgcGFuZWwuCisKIGVuZG1lbnUKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9N
YWtlZmlsZQppbmRleCBiNmNkMzlmLi42ZjFlNGM2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vcGFuZWwvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmVsL01ha2VmaWxlCkBA
IC0zOCwzICszOCw0IEBAIG9iai0kKENPTkZJR19EUk1fUEFORUxfVFBPX1REMDI4VFRFQzEpICs9
IHBhbmVsLXRwby10ZDAyOHR0ZWMxLm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfVFBPX1REMDQz
TVRFQTEpICs9IHBhbmVsLXRwby10ZDA0M210ZWExLm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxf
VFBPX1RQRzExMCkgKz0gcGFuZWwtdHBvLXRwZzExMC5vCiBvYmotJChDT05GSUdfRFJNX1BBTkVM
X1RSVUxZX05UMzU1OTdfV1FYR0EpICs9IHBhbmVsLXRydWx5LW50MzU1OTcubworb2JqLSQoQ09O
RklHX0RSTV9QQU5FTF9WSVNJT05PWF9STTY5Mjk5KSArPSBwYW5lbC12aXNpb25veC1ybTY5Mjk5
Lm8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC12aXNpb25veC1ybTY5
Mjk5LmMgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvcGFuZWwtdmlzaW9ub3gtcm02OTI5OS5jCm5l
dyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLmZhZjZkMDUKLS0tIC9kZXYvbnVsbAor
KysgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvcGFuZWwtdmlzaW9ub3gtcm02OTI5OS5jCkBAIC0w
LDAgKzEsNDc4IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAorLyoKKyAq
IENvcHlyaWdodCAoYykgMjAxOSwgVGhlIExpbnV4IEZvdW5kYXRpb24uIEFsbCByaWdodHMgcmVz
ZXJ2ZWQuCisgKi8KKworI2luY2x1ZGUgPGRybS9kcm1fcGFuZWwuaD4KKyNpbmNsdWRlIDxkcm0v
ZHJtX21pcGlfZHNpLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9tb2Rlcy5oPgorI2luY2x1ZGUgPGRy
bS9kcm1fcGFuZWwuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3ByaW50Lmg+CisKKyNpbmNsdWRlIDxs
aW51eC9vZl9ncGlvLmg+CisjaW5jbHVkZSA8bGludXgvZ3Bpby9jb25zdW1lci5oPgorI2luY2x1
ZGUgPGxpbnV4L29mX2RldmljZS5oPgorI2luY2x1ZGUgPGxpbnV4L29mX2dyYXBoLmg+CisjaW5j
bHVkZSA8bGludXgvcGluY3RybC9jb25zdW1lci5oPgorI2luY2x1ZGUgPGxpbnV4L3JlZ3VsYXRv
ci9jb25zdW1lci5oPgorI2luY2x1ZGUgPGxpbnV4L2JhY2tsaWdodC5oPgorI2luY2x1ZGUgPGxp
bnV4L21vZHVsZS5oPgorI2luY2x1ZGUgPGxpbnV4L2RlbGF5Lmg+CisKKyNpbmNsdWRlIDx2aWRl
by9taXBpX2Rpc3BsYXkuaD4KKworc3RhdGljIGNvbnN0IGNoYXIgKiBjb25zdCByZWd1bGF0b3Jf
bmFtZXNbXSA9IHsKKwkidmRkYSIsCisJInZkZDNwMyIsCit9OworCitzdGF0aWMgdW5zaWduZWQg
bG9uZyBjb25zdCByZWd1bGF0b3JfZW5hYmxlX2xvYWRzW10gPSB7CisJMzIwMDAsCisJMTMyMDAs
Cit9OworCitzdGF0aWMgdW5zaWduZWQgbG9uZyBjb25zdCByZWd1bGF0b3JfZGlzYWJsZV9sb2Fk
c1tdID0geworCTgwLAorCTgwLAorfTsKKworc3RydWN0IGNtZF9zZXQgeworCXU4IGNvbW1hbmRz
WzRdOworCXU4IHNpemU7Cit9OworCitzdHJ1Y3Qgcm02OTI5OV9jb25maWcgeworCXUzMiB3aWR0
aF9tbTsKKwl1MzIgaGVpZ2h0X21tOworCWNvbnN0IGNoYXIgKnBhbmVsX25hbWU7CisJY29uc3Qg
c3RydWN0IGNtZF9zZXQgKnBhbmVsX29uX2NtZHM7CisJdTMyIG51bV9vbl9jbWRzOworCWNvbnN0
IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICpkbTsKK307CisKK3N0cnVjdCB2aXNpb25veF9ybTY5
Mjk5IHsKKwlzdHJ1Y3QgZGV2aWNlICpkZXY7CisJc3RydWN0IGRybV9wYW5lbCBwYW5lbDsKKwor
CXN0cnVjdCByZWd1bGF0b3JfYnVsa19kYXRhIHN1cHBsaWVzW0FSUkFZX1NJWkUocmVndWxhdG9y
X25hbWVzKV07CisKKwlzdHJ1Y3QgZ3Bpb19kZXNjICpyZXNldF9ncGlvOworCisJc3RydWN0IGJh
Y2tsaWdodF9kZXZpY2UgKmJhY2tsaWdodDsKKworCXN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRz
aTsKKwljb25zdCBzdHJ1Y3Qgcm02OTI5OV9jb25maWcgKmNvbmZpZzsKKwlib29sIHByZXBhcmVk
OworCWJvb2wgZW5hYmxlZDsKK307CisKK3N0YXRpYyBpbmxpbmUgc3RydWN0IHZpc2lvbm94X3Jt
NjkyOTkgKnBhbmVsX3RvX2N0eChzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKK3sKKwlyZXR1cm4g
Y29udGFpbmVyX29mKHBhbmVsLCBzdHJ1Y3QgdmlzaW9ub3hfcm02OTI5OSwgcGFuZWwpOworfQor
CitzdGF0aWMgY29uc3Qgc3RydWN0IGNtZF9zZXQgcWNvbV9ybTY5Mjk5XzEwODBwX3BhbmVsX21h
Z2ljX2NtZHNbXSA9IHsKKwl7IHsgMHhmZSwgMHgwMCB9LCAyIH0sCisJeyB7IDB4YzIsIDB4MDgg
fSwgMiB9LAorCXsgeyAweDM1LCAweDAwIH0sIDIgfSwKKwl7IHsgMHg1MSwgMHhmZiB9LCAyIH0s
Cit9OworCitzdGF0aWMgaW50IHZpc2lvbm94X2Rjc193cml0ZShzdHJ1Y3QgZHJtX3BhbmVsICpw
YW5lbCwgdTMyIGNvbW1hbmQpCit7CisJc3RydWN0IHZpc2lvbm94X3JtNjkyOTkgKmN0eCA9IHBh
bmVsX3RvX2N0eChwYW5lbCk7CisJaW50IGkgPSAwLCByZXQ7CisKKwlyZXQgPSBtaXBpX2RzaV9k
Y3Nfd3JpdGUoY3R4LT5kc2ksIGNvbW1hbmQsIE5VTEwsIDApOworCWlmIChyZXQgPCAwKSB7CisJ
CURSTV9ERVZfRVJST1IoY3R4LT5kZXYsCisJCQkiY21kIDB4JXggZmFpbGVkIGZvciBkc2kgPSAl
ZFxuIiwKKwkJCWNvbW1hbmQsIGkpOworCX0KKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBp
bnQgdmlzaW9ub3hfZGNzX3dyaXRlX2J1ZihzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCwKKwl1MzIg
c2l6ZSwgY29uc3QgdTggKmJ1ZikKK3sKKwlzdHJ1Y3QgdmlzaW9ub3hfcm02OTI5OSAqY3R4ID0g
cGFuZWxfdG9fY3R4KHBhbmVsKTsKKwlpbnQgcmV0ID0gMDsKKwlpbnQgaSA9IDA7CisKKwlyZXQg
PSBtaXBpX2RzaV9kY3Nfd3JpdGVfYnVmZmVyKGN0eC0+ZHNpLCBidWYsIHNpemUpOworCWlmIChy
ZXQgPCAwKSB7CisJCURSTV9ERVZfRVJST1IoY3R4LT5kZXYsCisJCQkiZmFpbGVkIHRvIHR4IGNt
ZCBbJWRdLCBlcnI6ICVkXG4iLCBpLCByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKworCXJldHVy
biByZXQ7Cit9CisKK3N0YXRpYyBpbnQgdmlzaW9ub3hfMzU1OTdfcG93ZXJfb24oc3RydWN0IHZp
c2lvbm94X3JtNjkyOTkgKmN0eCkKK3sKKwlpbnQgcmV0LCBpOworCWZvciAoaSA9IDA7IGkgPCBB
UlJBWV9TSVpFKGN0eC0+c3VwcGxpZXMpOyBpKyspIHsKKwkJcmV0ID0gcmVndWxhdG9yX3NldF9s
b2FkKGN0eC0+c3VwcGxpZXNbaV0uY29uc3VtZXIsCisJCQkJCXJlZ3VsYXRvcl9lbmFibGVfbG9h
ZHNbaV0pOworCQlpZiAocmV0KQorCQkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXQgPSByZWd1bGF0
b3JfYnVsa19lbmFibGUoQVJSQVlfU0laRShjdHgtPnN1cHBsaWVzKSwgY3R4LT5zdXBwbGllcyk7
CisJaWYgKHJldCA8IDApCisJCXJldHVybiByZXQ7CisKKwkvKgorCSAqIFJlc2V0IHNlcXVlbmNl
IG9mIHZpc2lvbm94IHBhbmVsIHJlcXVpcmVzIHRoZSBwYW5lbCB0byBiZQorCSAqIG91dCBvZiBy
ZXNldCBmb3IgMTBtcywgZm9sbG93ZWQgYnkgYmVpbmcgaGVsZCBpbiByZXNldAorCSAqIGZvciAx
MG1zIGFuZCB0aGVuIG91dCBhZ2FpbgorCSAqLworCWdwaW9kX3NldF92YWx1ZShjdHgtPnJlc2V0
X2dwaW8sIDEpOworCXVzbGVlcF9yYW5nZSgxMDAwMCwgMjAwMDApOworCWdwaW9kX3NldF92YWx1
ZShjdHgtPnJlc2V0X2dwaW8sIDApOworCXVzbGVlcF9yYW5nZSgxMDAwMCwgMjAwMDApOworCWdw
aW9kX3NldF92YWx1ZShjdHgtPnJlc2V0X2dwaW8sIDEpOworCXVzbGVlcF9yYW5nZSgxMDAwMCwg
MjAwMDApOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgdmlzaW9ub3hfcm02OTI5OV9w
b3dlcl9vZmYoc3RydWN0IHZpc2lvbm94X3JtNjkyOTkgKmN0eCkKK3sKKwlpbnQgcmV0ID0gMDsK
KwlpbnQgaTsKKworCWdwaW9kX3NldF92YWx1ZShjdHgtPnJlc2V0X2dwaW8sIDApOworCisJZm9y
IChpID0gMDsgaSA8IEFSUkFZX1NJWkUoY3R4LT5zdXBwbGllcyk7IGkrKykgeworCQlyZXQgPSBy
ZWd1bGF0b3Jfc2V0X2xvYWQoY3R4LT5zdXBwbGllc1tpXS5jb25zdW1lciwKKwkJCQlyZWd1bGF0
b3JfZGlzYWJsZV9sb2Fkc1tpXSk7CisJCWlmIChyZXQpIHsKKwkJCURSTV9ERVZfRVJST1IoY3R4
LT5kZXYsCisJCQkJInJlZ3VsYXRvcl9zZXRfbG9hZCBmYWlsZWQgJWRcbiIsIHJldCk7CisJCQly
ZXR1cm4gcmV0OworCQl9CisJfQorCisJcmV0ID0gcmVndWxhdG9yX2J1bGtfZGlzYWJsZShBUlJB
WV9TSVpFKGN0eC0+c3VwcGxpZXMpLCBjdHgtPnN1cHBsaWVzKTsKKwlpZiAocmV0KSB7CisJCURS
TV9ERVZfRVJST1IoY3R4LT5kZXYsCisJCQkicmVndWxhdG9yX2J1bGtfZGlzYWJsZSBmYWlsZWQg
JWRcbiIsIHJldCk7CisJfQorCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgdmlzaW9ub3hf
cm02OTI5OV9kaXNhYmxlKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQoreworCXN0cnVjdCB2aXNp
b25veF9ybTY5Mjk5ICpjdHggPSBwYW5lbF90b19jdHgocGFuZWwpOworCWludCByZXQ7CisKKwlp
ZiAoIWN0eC0+ZW5hYmxlZCkKKwkJcmV0dXJuIDA7CisKKwlpZiAoY3R4LT5iYWNrbGlnaHQpIHsK
KwkJcmV0ID0gYmFja2xpZ2h0X2Rpc2FibGUoY3R4LT5iYWNrbGlnaHQpOworCQlpZiAocmV0IDwg
MCkKKwkJCURSTV9ERVZfRVJST1IoY3R4LT5kZXYsICJiYWNrbGlnaHQgZGlzYWJsZSBmYWlsZWQg
JWRcbiIsCisJCQkJcmV0KTsKKwl9CisKKwljdHgtPmVuYWJsZWQgPSBmYWxzZTsKKwlyZXR1cm4g
MDsKK30KKworc3RhdGljIGludCB2aXNpb25veF9ybTY5Mjk5X3VucHJlcGFyZShzdHJ1Y3QgZHJt
X3BhbmVsICpwYW5lbCkKK3sKKwlzdHJ1Y3QgdmlzaW9ub3hfcm02OTI5OSAqY3R4ID0gcGFuZWxf
dG9fY3R4KHBhbmVsKTsKKwlpbnQgcmV0ID0gMDsKKworCWlmICghY3R4LT5wcmVwYXJlZCkKKwkJ
cmV0dXJuIDA7CisKKwljdHgtPmRzaS0+bW9kZV9mbGFncyA9IDA7CisKKwlyZXQgPSB2aXNpb25v
eF9kY3Nfd3JpdGUocGFuZWwsIE1JUElfRENTX1NFVF9ESVNQTEFZX09GRik7CisJaWYgKHJldCA8
IDApIHsKKwkJRFJNX0RFVl9FUlJPUihjdHgtPmRldiwKKwkJCSJzZXRfZGlzcGxheV9vZmYgY21k
IGZhaWxlZCByZXQgPSAlZFxuIiwKKwkJCXJldCk7CisJfQorCisJLyogMTIwbXMgZGVsYXkgcmVx
dWlyZWQgaGVyZSBhcyBwZXIgRENTIHNwZWMgKi8KKwltc2xlZXAoMTIwKTsKKworCXJldCA9IHZp
c2lvbm94X2Rjc193cml0ZShwYW5lbCwgTUlQSV9EQ1NfRU5URVJfU0xFRVBfTU9ERSk7CisJaWYg
KHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihjdHgtPmRldiwKKwkJCSJlbnRlcl9zbGVlcCBj
bWQgZmFpbGVkIHJldCA9ICVkXG4iLCByZXQpOworCX0KKworCXJldCA9IHZpc2lvbm94X3JtNjky
OTlfcG93ZXJfb2ZmKGN0eCk7CisJaWYgKHJldCA8IDApCisJCURSTV9ERVZfRVJST1IoY3R4LT5k
ZXYsICJwb3dlcl9vZmYgZmFpbGVkIHJldCA9ICVkXG4iLCByZXQpOworCisJY3R4LT5wcmVwYXJl
ZCA9IGZhbHNlOworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgdmlzaW9ub3hfcm02OTI5
OV9wcmVwYXJlKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQoreworCXN0cnVjdCB2aXNpb25veF9y
bTY5Mjk5ICpjdHggPSBwYW5lbF90b19jdHgocGFuZWwpOworCWludCByZXQ7CisJaW50IGk7CisJ
Y29uc3Qgc3RydWN0IGNtZF9zZXQgKnBhbmVsX29uX2NtZHM7CisJY29uc3Qgc3RydWN0IHJtNjky
OTlfY29uZmlnICpjb25maWc7CisJdTMyIG51bV9jbWRzOworCisJaWYgKGN0eC0+cHJlcGFyZWQp
CisJCXJldHVybiAwOworCisJcmV0ID0gdmlzaW9ub3hfMzU1OTdfcG93ZXJfb24oY3R4KTsKKwlp
ZiAocmV0IDwgMCkKKwkJcmV0dXJuIHJldDsKKworCWN0eC0+ZHNpLT5tb2RlX2ZsYWdzIHw9IE1J
UElfRFNJX01PREVfTFBNOworCisJY29uZmlnID0gY3R4LT5jb25maWc7CisJcGFuZWxfb25fY21k
cyA9IGNvbmZpZy0+cGFuZWxfb25fY21kczsKKwludW1fY21kcyA9IGNvbmZpZy0+bnVtX29uX2Nt
ZHM7CisKKwlmb3IgKGkgPSAwOyBpIDwgbnVtX2NtZHM7IGkrKykgeworCQlyZXQgPSB2aXNpb25v
eF9kY3Nfd3JpdGVfYnVmKHBhbmVsLAorCQkJCXBhbmVsX29uX2NtZHNbaV0uc2l6ZSwKKwkJCQkJ
cGFuZWxfb25fY21kc1tpXS5jb21tYW5kcyk7CisJCWlmIChyZXQgPCAwKSB7CisJCQlEUk1fREVW
X0VSUk9SKGN0eC0+ZGV2LAorCQkJCSJjbWQgc2V0IHR4IGZhaWxlZCBpID0gJWQgcmV0ID0gJWRc
biIsCisJCQkJCWksIHJldCk7CisJCQlnb3RvIHBvd2VyX29mZjsKKwkJfQorCX0KKworCXJldCA9
IHZpc2lvbm94X2Rjc193cml0ZShwYW5lbCwgTUlQSV9EQ1NfRVhJVF9TTEVFUF9NT0RFKTsKKwlp
ZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGN0eC0+ZGV2LAorCQkJImV4aXRfc2xlZXBf
bW9kZSBjbWQgZmFpbGVkIHJldCA9ICVkXG4iLAorCQkJcmV0KTsKKwkJZ290byBwb3dlcl9vZmY7
CisJfQorCisJLyogUGVyIERTSSBzcGVjIHdhaXQgMTIwbXMgYWZ0ZXIgc2VuZGluZyBleGl0IHNs
ZWVwIERDUyBjb21tYW5kICovCisJbXNsZWVwKDEyMCk7CisKKwlyZXQgPSB2aXNpb25veF9kY3Nf
d3JpdGUocGFuZWwsIE1JUElfRENTX1NFVF9ESVNQTEFZX09OKTsKKwlpZiAocmV0IDwgMCkgewor
CQlEUk1fREVWX0VSUk9SKGN0eC0+ZGV2LAorCQkJInNldF9kaXNwbGF5X29uIGNtZCBmYWlsZWQg
cmV0ID0gJWRcbiIsIHJldCk7CisJCWdvdG8gcG93ZXJfb2ZmOworCX0KKworCS8qIFBlciBEU0kg
c3BlYyB3YWl0IDEyMG1zIGFmdGVyIHNlbmRpbmcgc2V0X2Rpc3BsYXlfb24gRENTIGNvbW1hbmQg
Ki8KKwltc2xlZXAoMTIwKTsKKworCWN0eC0+cHJlcGFyZWQgPSB0cnVlOworCisJcmV0dXJuIDA7
CisKK3Bvd2VyX29mZjoKKwlpZiAodmlzaW9ub3hfcm02OTI5OV9wb3dlcl9vZmYoY3R4KSkKKwkJ
RFJNX0RFVl9FUlJPUihjdHgtPmRldiwgInBvd2VyX29mZiBmYWlsZWRcbiIpOworCXJldHVybiBy
ZXQ7Cit9CisKK3N0YXRpYyBpbnQgdmlzaW9ub3hfcm02OTI5OV9lbmFibGUoc3RydWN0IGRybV9w
YW5lbCAqcGFuZWwpCit7CisJc3RydWN0IHZpc2lvbm94X3JtNjkyOTkgKmN0eCA9IHBhbmVsX3Rv
X2N0eChwYW5lbCk7CisJaW50IHJldDsKKworCWlmIChjdHgtPmVuYWJsZWQpCisJCXJldHVybiAw
OworCisJaWYgKGN0eC0+YmFja2xpZ2h0KSB7CisJCXJldCA9IGJhY2tsaWdodF9lbmFibGUoY3R4
LT5iYWNrbGlnaHQpOworCQlpZiAocmV0IDwgMCkKKwkJCURSTV9ERVZfRVJST1IoY3R4LT5kZXYs
ICJiYWNrbGlnaHQgZW5hYmxlIGZhaWxlZCAlZFxuIiwKKwkJCQkJCSAgcmV0KTsKKwl9CisKKwlj
dHgtPmVuYWJsZWQgPSB0cnVlOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgdmlzaW9u
b3hfcm02OTI5OV9nZXRfbW9kZXMoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwpCit7CisJc3RydWN0
IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciA9IHBhbmVsLT5jb25uZWN0b3I7CisJc3RydWN0IHZp
c2lvbm94X3JtNjkyOTkgKmN0eCA9IHBhbmVsX3RvX2N0eChwYW5lbCk7CisJc3RydWN0IGRybV9k
aXNwbGF5X21vZGUgKm1vZGU7CisJY29uc3Qgc3RydWN0IHJtNjkyOTlfY29uZmlnICpjb25maWc7
CisKKwljb25maWcgPSBjdHgtPmNvbmZpZzsKKwltb2RlID0gZHJtX21vZGVfY3JlYXRlKGNvbm5l
Y3Rvci0+ZGV2KTsKKwlpZiAoIW1vZGUpIHsKKwkJRFJNX0RFVl9FUlJPUihjdHgtPmRldiwKKwkJ
CSJmYWlsZWQgdG8gY3JlYXRlIGEgbmV3IGRpc3BsYXkgbW9kZVxuIik7CisJCXJldHVybiAwOwor
CX0KKworCWNvbm5lY3Rvci0+ZGlzcGxheV9pbmZvLndpZHRoX21tID0gY29uZmlnLT53aWR0aF9t
bTsKKwljb25uZWN0b3ItPmRpc3BsYXlfaW5mby5oZWlnaHRfbW0gPSBjb25maWctPmhlaWdodF9t
bTsKKwlkcm1fbW9kZV9jb3B5KG1vZGUsIGNvbmZpZy0+ZG0pOworCW1vZGUtPnR5cGUgPSBEUk1f
TU9ERV9UWVBFX0RSSVZFUiB8IERSTV9NT0RFX1RZUEVfUFJFRkVSUkVEOworCWRybV9tb2RlX3By
b2JlZF9hZGQoY29ubmVjdG9yLCBtb2RlKTsKKworCXJldHVybiAxOworfQorCitzdGF0aWMgY29u
c3Qgc3RydWN0IGRybV9wYW5lbF9mdW5jcyB2aXNpb25veF9ybTY5Mjk5X2RybV9mdW5jcyA9IHsK
KwkuZGlzYWJsZSA9IHZpc2lvbm94X3JtNjkyOTlfZGlzYWJsZSwKKwkudW5wcmVwYXJlID0gdmlz
aW9ub3hfcm02OTI5OV91bnByZXBhcmUsCisJLnByZXBhcmUgPSB2aXNpb25veF9ybTY5Mjk5X3By
ZXBhcmUsCisJLmVuYWJsZSA9IHZpc2lvbm94X3JtNjkyOTlfZW5hYmxlLAorCS5nZXRfbW9kZXMg
PSB2aXNpb25veF9ybTY5Mjk5X2dldF9tb2RlcywKK307CisKK3N0YXRpYyBpbnQgdmlzaW9ub3hf
cm02OTI5OV9wYW5lbF9hZGQoc3RydWN0IHZpc2lvbm94X3JtNjkyOTkgKmN0eCkKK3sKKwlzdHJ1
Y3QgZGV2aWNlICpkZXYgPSBjdHgtPmRldjsKKwlpbnQgcmV0LCBpOworCWNvbnN0IHN0cnVjdCBy
bTY5Mjk5X2NvbmZpZyAqY29uZmlnOworCisJY29uZmlnID0gY3R4LT5jb25maWc7CisJZm9yIChp
ID0gMDsgaSA8IEFSUkFZX1NJWkUoY3R4LT5zdXBwbGllcyk7IGkrKykKKwkJY3R4LT5zdXBwbGll
c1tpXS5zdXBwbHkgPSByZWd1bGF0b3JfbmFtZXNbaV07CisKKwlyZXQgPSBkZXZtX3JlZ3VsYXRv
cl9idWxrX2dldChkZXYsIEFSUkFZX1NJWkUoY3R4LT5zdXBwbGllcyksCisJCQkJICAgICAgY3R4
LT5zdXBwbGllcyk7CisJaWYgKHJldCA8IDApCisJCXJldHVybiByZXQ7CisKKwljdHgtPnJlc2V0
X2dwaW8gPSBkZXZtX2dwaW9kX2dldChkZXYsICJyZXNldCIsIEdQSU9EX09VVF9MT1cpOworCWlm
IChJU19FUlIoY3R4LT5yZXNldF9ncGlvKSkgeworCQlEUk1fREVWX0VSUk9SKGRldiwgImNhbm5v
dCBnZXQgcmVzZXQgZ3BpbyAlbGRcbiIsCisJCQlQVFJfRVJSKGN0eC0+cmVzZXRfZ3BpbykpOwor
CQlyZXR1cm4gUFRSX0VSUihjdHgtPnJlc2V0X2dwaW8pOworCX0KKworCXJldCA9IGdwaW9kX2Rp
cmVjdGlvbl9vdXRwdXQoY3R4LT5yZXNldF9ncGlvLCAwKTsKKwlpZihyZXQgPCAwKSB7CisJCXBy
X2VycigiZGlyZWN0aW9uIG91dHB1dCBmYWlsZWQgXG4iKTsKKwl9CisKKwlkcm1fcGFuZWxfaW5p
dCgmY3R4LT5wYW5lbCk7CisJY3R4LT5wYW5lbC5kZXYgPSBkZXY7CisJY3R4LT5wYW5lbC5mdW5j
cyA9ICZ2aXNpb25veF9ybTY5Mjk5X2RybV9mdW5jczsKKwlkcm1fcGFuZWxfYWRkKCZjdHgtPnBh
bmVsKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5
X21vZGUgcWNvbV9zYzcxODBfbXRwXzEwODBwX21vZGUgPSB7CisJLm5hbWUgPSAiMTA4MHgyMjQ4
IiwKKwkuY2xvY2sgPSAxNTg2OTUsCisJLmhkaXNwbGF5ID0gMTA4MCwKKwkuaHN5bmNfc3RhcnQg
PSAxMDgwICsgMjYsCisJLmhzeW5jX2VuZCA9IDEwODAgKyAyNiArIDIsCisJLmh0b3RhbCA9IDEw
ODAgKyAyNiArIDIgKyAzNiwKKwkudmRpc3BsYXkgPSAyMjQ4LAorCS52c3luY19zdGFydCA9IDIy
NDggKyA1NiwKKwkudnN5bmNfZW5kID0gMjI0OCArIDU2ICsgNCwKKwkudnRvdGFsID0gMjI0OCAr
IDU2ICsgNCArIDQsCisJLnZyZWZyZXNoID0gNjAsCisJLmZsYWdzID0gMCwKK307CisKK3N0YXRp
YyBjb25zdCBzdHJ1Y3Qgcm02OTI5OV9jb25maWcgcm02OTI5OV9kaXIgPSB7CisJLndpZHRoX21t
ID0gNzQsCisJLmhlaWdodF9tbSA9IDEzMSwKKwkucGFuZWxfbmFtZSA9ICJxY29tX3NjNzE4MF9t
dHBfMTA4MHBfcGFuZWwiLAorCS5kbSA9ICZxY29tX3NjNzE4MF9tdHBfMTA4MHBfbW9kZSwKKwku
cGFuZWxfb25fY21kcyA9IHFjb21fcm02OTI5OV8xMDgwcF9wYW5lbF9tYWdpY19jbWRzLAorCS5u
dW1fb25fY21kcyA9IEFSUkFZX1NJWkUocWNvbV9ybTY5Mjk5XzEwODBwX3BhbmVsX21hZ2ljX2Nt
ZHMpLAorfTsKKworc3RhdGljIGludCB2aXNpb25veF9ybTY5Mjk5X3Byb2JlKHN0cnVjdCBtaXBp
X2RzaV9kZXZpY2UgKmRzaSkKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmZHNpLT5kZXY7CisJ
c3RydWN0IHZpc2lvbm94X3JtNjkyOTkgKmN0eDsKKwlpbnQgcmV0ID0gMDsKKworCWN0eCA9IGRl
dm1fa3phbGxvYyhkZXYsIHNpemVvZigqY3R4KSwgR0ZQX0tFUk5FTCk7CisKKwlpZiAoIWN0eCkK
KwkJcmV0dXJuIC1FTk9NRU07CisKKwljdHgtPmNvbmZpZyA9IG9mX2RldmljZV9nZXRfbWF0Y2hf
ZGF0YShkZXYpOworCisJaWYgKCFjdHgtPmNvbmZpZykgeworCQlkZXZfZXJyKGRldiwgIm1pc3Np
bmcgZGV2aWNlIGNvbmZpZ3VyYXRpb25cbiIpOworCQlyZXR1cm4gLUVOT0RFVjsKKwl9CisKKwlt
aXBpX2RzaV9zZXRfZHJ2ZGF0YShkc2ksIGN0eCk7CisKKwljdHgtPmRldiA9IGRldjsKKwljdHgt
PmRzaSA9IGRzaTsKKworCXJldCA9IHZpc2lvbm94X3JtNjkyOTlfcGFuZWxfYWRkKGN0eCk7CisJ
aWYgKHJldCkgeworCQlEUk1fREVWX0VSUk9SKGRldiwgImZhaWxlZCB0byBhZGQgcGFuZWxcbiIp
OworCQlnb3RvIGVycl9wYW5lbF9hZGQ7CisJfQorCisJZHNpLT5sYW5lcyA9IDQ7CisJZHNpLT5m
b3JtYXQgPSBNSVBJX0RTSV9GTVRfUkdCODg4OworCWRzaS0+bW9kZV9mbGFncyA9IE1JUElfRFNJ
X01PREVfVklERU8gfCBNSVBJX0RTSV9NT0RFX0xQTSB8CisJCU1JUElfRFNJX0NMT0NLX05PTl9D
T05USU5VT1VTOworCXJldCA9IG1pcGlfZHNpX2F0dGFjaChkc2kpOworCWlmIChyZXQgPCAwKSB7
CisJCURSTV9ERVZfRVJST1IoZGV2LAorCQkJImRzaSBhdHRhY2ggZmFpbGVkIHJldCA9ICVkXG4i
LCByZXQpOworCQlnb3RvIGVycl9kc2lfYXR0YWNoOworCX0KKworCXJldHVybiAwOworCitlcnJf
ZHNpX2F0dGFjaDoKKwlkcm1fcGFuZWxfcmVtb3ZlKCZjdHgtPnBhbmVsKTsKK2Vycl9wYW5lbF9h
ZGQ6CisJbWlwaV9kc2lfZGV2aWNlX3VucmVnaXN0ZXIoZHNpKTsKKwlyZXR1cm4gcmV0OworfQor
CitzdGF0aWMgaW50IHZpc2lvbm94X3JtNjkyOTlfcmVtb3ZlKHN0cnVjdCBtaXBpX2RzaV9kZXZp
Y2UgKmRzaSkKK3sKKwlzdHJ1Y3QgdmlzaW9ub3hfcm02OTI5OSAqY3R4ID0gbWlwaV9kc2lfZ2V0
X2RydmRhdGEoZHNpKTsKKworCWlmIChjdHgtPmRzaSkgeworCQltaXBpX2RzaV9kZXRhY2goY3R4
LT5kc2kpOworCQltaXBpX2RzaV9kZXZpY2VfdW5yZWdpc3RlcihjdHgtPmRzaSk7CisJfQorCisJ
ZHJtX3BhbmVsX3JlbW92ZSgmY3R4LT5wYW5lbCk7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBj
b25zdCBzdHJ1Y3Qgb2ZfZGV2aWNlX2lkIHZpc2lvbm94X3JtNjkyOTlfb2ZfbWF0Y2hbXSA9IHsK
Kwl7CisJCS5jb21wYXRpYmxlID0gInZpc2lvbm94LHJtNjkyOTktMTA4MHAtZGlzcGxheSIsCisJ
CS5kYXRhID0gJnJtNjkyOTlfZGlyLAorCX0sCisJeyB9Cit9OworTU9EVUxFX0RFVklDRV9UQUJM
RShvZiwgdmlzaW9ub3hfcm02OTI5OV9vZl9tYXRjaCk7CisKK3N0YXRpYyBzdHJ1Y3QgbWlwaV9k
c2lfZHJpdmVyIHZpc2lvbm94X3JtNjkyOTlfZHJpdmVyID0geworCS5kcml2ZXIgPSB7CisJCS5u
YW1lID0gInBhbmVsLXZpc2lvbm94LXJtNjkyOTkiLAorCQkub2ZfbWF0Y2hfdGFibGUgPSB2aXNp
b25veF9ybTY5Mjk5X29mX21hdGNoLAorCX0sCisJLnByb2JlID0gdmlzaW9ub3hfcm02OTI5OV9w
cm9iZSwKKwkucmVtb3ZlID0gdmlzaW9ub3hfcm02OTI5OV9yZW1vdmUsCit9OworbW9kdWxlX21p
cGlfZHNpX2RyaXZlcih2aXNpb25veF9ybTY5Mjk5X2RyaXZlcik7CisKK01PRFVMRV9ERVNDUklQ
VElPTigiVklTSU9OT1ggUk02OTI5OSBEU0kgUGFuZWwgRHJpdmVyIik7CitNT0RVTEVfTElDRU5T
RSgiR1BMIHYyIik7Ci0tIAoyLjcuNAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGlu
Zm8vZHJpLWRldmVs
