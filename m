Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 4BF8635E0A4
	for <lists+dri-devel@lfdr.de>; Tue, 13 Apr 2021 15:53:00 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 52A7089DEA;
	Tue, 13 Apr 2021 13:52:55 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ej1-x636.google.com (mail-ej1-x636.google.com
 [IPv6:2a00:1450:4864:20::636])
 by gabe.freedesktop.org (Postfix) with ESMTPS id D4EDB89E03
 for <dri-devel@lists.freedesktop.org>; Tue, 13 Apr 2021 13:52:53 +0000 (UTC)
Received: by mail-ej1-x636.google.com with SMTP id g5so19362023ejx.0
 for <dri-devel@lists.freedesktop.org>; Tue, 13 Apr 2021 06:52:53 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=YhF3+PbKMp/xTqIY/GqindXAkPhT5tM2EPwWLiZ1FMk=;
 b=c7AWoKAWnSZbusnvv5cvaR77B+uFOR+KzRimUz1BLRu7svrBzIqjp7KqYFxN7Nuc5F
 EMtVOnnE6ii8JdKX4oR73QhXqtvLZm4K7tM0YlczzX22x/gS/XLmm+DFtnrCLnHmMmTG
 MeEHEpwyYnB81ljIFjdHxQ0/RMNXDVRUwH7B5R3vy4Jfi+2vkKMoObwOjaFvbUXfylNt
 Vpwk+5mNx8OCQDXXSYkynPFOWcr85nwonEjghNhKAJQvxAXCi6gbpCPCYQpIeLI5EX8v
 A6+EryMQH/PJ9kcvPfWHDsjJ5cHX1+JTxM2zdX1y2LtGfbQc068uVK7FByEG9KGsWBMO
 ohVQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=YhF3+PbKMp/xTqIY/GqindXAkPhT5tM2EPwWLiZ1FMk=;
 b=j7h7oZQQi4BCLHePhAlCme6ObD1ea/aK2xjnxmKSp85Ctp0AFLJqwG0rrXePtVevzU
 iUouEcBLFxussVu/Y3cEnRDA8c2mHcKpej2EEFOKR5X/0FY2SB+5bqeODIH6604PiCOh
 OegEICrBzVCkDZgJKpBxskeIp4r4aegvlXN/07RzfG+c2XNT79KsLAVX/g7ugy7e5TEc
 kqBYfFzX9bv8wA1ZonFKMKV7txJfvxFdO/FQr3E8ev4T5liyWfzBBh+7qUGR0LupI3Qi
 eU2rLATPXF8MFzAAKvHxQM8hadH2qsGjklWSygjgL/5vuvCOxJkNzSq1U23FwxOzS/9w
 A4rw==
X-Gm-Message-State: AOAM531DU0KuiYdDS5pX2He7k1pM3fdXNhl/tr9bFj2dbqIuxE4WKBzK
 pA24F39wlfEuCvg3Wz05o2hyTlNlZrw=
X-Google-Smtp-Source: ABdhPJywaEW8jo6NoXl5AJE08ASZZrzlxpqhNlB+xwJfoMBxiiPQq28Hzc7GbxKG8IkFcW2YDOF2yA==
X-Received: by 2002:a17:906:cc48:: with SMTP id
 mm8mr6412292ejb.58.1618321972558; 
 Tue, 13 Apr 2021 06:52:52 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:a061:9101:8418:4794])
 by smtp.gmail.com with ESMTPSA id m10sm491465ejc.32.2021.04.13.06.52.51
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 13 Apr 2021 06:52:52 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH 5/7] drm/ttm: add ttm_sys_manager
Date: Tue, 13 Apr 2021 15:52:46 +0200
Message-Id: <20210413135248.1266-5-christian.koenig@amd.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20210413135248.1266-1-christian.koenig@amd.com>
References: <20210413135248.1266-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: daniel.vetter@ffwll.ch, thomas.hellstrom@linux.intel.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

QWRkIGEgc2VwYXJhdGUgbWFuYWdlciBmb3IgdGhlIHN5c3RlbSBkb21haW4gYW5kIG1ha2UgZnVu
Y3Rpb24gdGFibGVzCm1hbmRhdG9yeS4KClNpZ25lZC1vZmYtYnk6IENocmlzdGlhbiBLw7ZuaWcg
PGNocmlzdGlhbi5rb2VuaWdAYW1kLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vdHRtL01ha2Vm
aWxlICAgICAgICAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2RldmljZS5jICAg
ICAgfCAxNyArLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9tb2R1bGUuaCAgICAg
IHwgIDMgKysKIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3Jlc291cmNlLmMgICAgfCAxMCArKy0t
LS0KIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3N5c19tYW5hZ2VyLmMgfCA0NiArKysrKysrKysr
KysrKysrKysrKysrKysrKysKIDUgZmlsZXMgY2hhbmdlZCwgNTMgaW5zZXJ0aW9ucygrKSwgMjUg
ZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL3R0bS90dG1f
c3lzX21hbmFnZXIuYwoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90dG0vTWFrZWZpbGUg
Yi9kcml2ZXJzL2dwdS9kcm0vdHRtL01ha2VmaWxlCmluZGV4IDQwZTVlOWRhNzk1My4uZjkwNmIy
Mjk1OWNmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRtL01ha2VmaWxlCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS90dG0vTWFrZWZpbGUKQEAgLTQsNyArNCw3IEBACiAKIHR0bS15IDo9IHR0
bV90dC5vIHR0bV9iby5vIHR0bV9ib191dGlsLm8gdHRtX2JvX3ZtLm8gdHRtX21vZHVsZS5vIFwK
IAl0dG1fZXhlY2J1Zl91dGlsLm8gdHRtX3JhbmdlX21hbmFnZXIubyB0dG1fcmVzb3VyY2UubyB0
dG1fcG9vbC5vIFwKLQl0dG1fZGV2aWNlLm8KKwl0dG1fZGV2aWNlLm8gdHRtX3N5c19tYW5hZ2Vy
Lm8KIHR0bS0kKENPTkZJR19BR1ApICs9IHR0bV9hZ3BfYmFja2VuZC5vCiAKIG9iai0kKENPTkZJ
R19EUk1fVFRNKSArPSB0dG0ubwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1f
ZGV2aWNlLmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9kZXZpY2UuYwppbmRleCAxZjIwMjQx
NjRkNzIuLjM5OTU2ZTA4YjRjMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1f
ZGV2aWNlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fZGV2aWNlLmMKQEAgLTE2NSwy
MSArMTY1LDYgQEAgaW50IHR0bV9kZXZpY2Vfc3dhcG91dChzdHJ1Y3QgdHRtX2RldmljZSAqYmRl
diwgc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4ICpjdHgsCiB9CiBFWFBPUlRfU1lNQk9MKHR0bV9k
ZXZpY2Vfc3dhcG91dCk7CiAKLXN0YXRpYyB2b2lkIHR0bV9pbml0X3N5c21hbihzdHJ1Y3QgdHRt
X2RldmljZSAqYmRldikKLXsKLQlzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiA9ICZi
ZGV2LT5zeXNtYW47Ci0KLQkvKgotCSAqIEluaXRpYWxpemUgdGhlIHN5c3RlbSBtZW1vcnkgYnVm
ZmVyIHR5cGUuCi0JICogT3RoZXIgdHlwZXMgbmVlZCB0byBiZSBkcml2ZXIgLyBJT0NUTCBpbml0
aWFsaXplZC4KLQkgKi8KLQltYW4tPnVzZV90dCA9IHRydWU7Ci0KLQl0dG1fcmVzb3VyY2VfbWFu
YWdlcl9pbml0KG1hbiwgMCk7Ci0JdHRtX3NldF9kcml2ZXJfbWFuYWdlcihiZGV2LCBUVE1fUExf
U1lTVEVNLCBtYW4pOwotCXR0bV9yZXNvdXJjZV9tYW5hZ2VyX3NldF91c2VkKG1hbiwgdHJ1ZSk7
Ci19Ci0KIHN0YXRpYyB2b2lkIHR0bV9kZXZpY2VfZGVsYXllZF93b3JrcXVldWUoc3RydWN0IHdv
cmtfc3RydWN0ICp3b3JrKQogewogCXN0cnVjdCB0dG1fZGV2aWNlICpiZGV2ID0KQEAgLTIyMiw3
ICsyMDcsNyBAQCBpbnQgdHRtX2RldmljZV9pbml0KHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LCBz
dHJ1Y3QgdHRtX2RldmljZV9mdW5jcyAqZnVuY3MsCiAKIAliZGV2LT5mdW5jcyA9IGZ1bmNzOwog
Ci0JdHRtX2luaXRfc3lzbWFuKGJkZXYpOworCXR0bV9zeXNfbWFuX2luaXQoYmRldik7CiAJdHRt
X3Bvb2xfaW5pdCgmYmRldi0+cG9vbCwgZGV2LCB1c2VfZG1hX2FsbG9jLCB1c2VfZG1hMzIpOwog
CiAJYmRldi0+dm1hX21hbmFnZXIgPSB2bWFfbWFuYWdlcjsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS90dG0vdHRtX21vZHVsZS5oIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fbW9kdWxl
LmgKaW5kZXggZDdjYWM1ZDRiODM1Li4yNjU2NGE5ODk1OGYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS90dG0vdHRtX21vZHVsZS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX21v
ZHVsZS5oCkBAIC0zNCw3ICszNCwxMCBAQAogI2RlZmluZSBUVE1fUEZYICJbVFRNXSAiCiAKIHN0
cnVjdCBkZW50cnk7CitzdHJ1Y3QgdHRtX2RldmljZTsKIAogZXh0ZXJuIHN0cnVjdCBkZW50cnkg
KnR0bV9kZWJ1Z2ZzX3Jvb3Q7CiAKK2ludCB0dG1fc3lzX21hbl9pbml0KHN0cnVjdCB0dG1fZGV2
aWNlICpiZGV2KTsKKwogI2VuZGlmIC8qIF9UVE1fTU9EVUxFX0hfICovCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9yZXNvdXJjZS5jIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90
dG1fcmVzb3VyY2UuYwppbmRleCAwNGYyZWVmNjUzYWIuLmE2OTAwYjgyZjMxYSAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fcmVzb3VyY2UuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vdHRtL3R0bV9yZXNvdXJjZS5jCkBAIC0zMyw5ICszMyw2IEBAIGludCB0dG1fcmVzb3VyY2Vf
YWxsb2Moc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAkJdHRtX21hbmFnZXJfdHlwZShi
by0+YmRldiwgcmVzLT5tZW1fdHlwZSk7CiAKIAlyZXMtPm1tX25vZGUgPSBOVUxMOwotCWlmICgh
bWFuLT5mdW5jIHx8ICFtYW4tPmZ1bmMtPmFsbG9jKQotCQlyZXR1cm4gMDsKLQogCXJldHVybiBt
YW4tPmZ1bmMtPmFsbG9jKG1hbiwgYm8sIHBsYWNlLCByZXMpOwogfQogCkBAIC00NCw5ICs0MSw3
IEBAIHZvaWQgdHRtX3Jlc291cmNlX2ZyZWUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywg
c3RydWN0IHR0bV9yZXNvdXJjZSAqcmVzKQogCXN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAq
bWFuID0KIAkJdHRtX21hbmFnZXJfdHlwZShiby0+YmRldiwgcmVzLT5tZW1fdHlwZSk7CiAKLQlp
ZiAobWFuLT5mdW5jICYmIG1hbi0+ZnVuYy0+ZnJlZSkKLQkJbWFuLT5mdW5jLT5mcmVlKG1hbiwg
cmVzKTsKLQorCW1hbi0+ZnVuYy0+ZnJlZShtYW4sIHJlcyk7CiAJcmVzLT5tbV9ub2RlID0gTlVM
TDsKIAlyZXMtPm1lbV90eXBlID0gVFRNX1BMX1NZU1RFTTsKIH0KQEAgLTEzOSw3ICsxMzQsNiBA
QCB2b2lkIHR0bV9yZXNvdXJjZV9tYW5hZ2VyX2RlYnVnKHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFu
YWdlciAqbWFuLAogCWRybV9wcmludGYocCwgIiAgdXNlX3R5cGU6ICVkXG4iLCBtYW4tPnVzZV90
eXBlKTsKIAlkcm1fcHJpbnRmKHAsICIgIHVzZV90dDogJWRcbiIsIG1hbi0+dXNlX3R0KTsKIAlk
cm1fcHJpbnRmKHAsICIgIHNpemU6ICVsbHVcbiIsIG1hbi0+c2l6ZSk7Ci0JaWYgKG1hbi0+ZnVu
YyAmJiBtYW4tPmZ1bmMtPmRlYnVnKQotCQkoKm1hbi0+ZnVuYy0+ZGVidWcpKG1hbiwgcCk7CisJ
bWFuLT5mdW5jLT5kZWJ1ZyhtYW4sIHApOwogfQogRVhQT1JUX1NZTUJPTCh0dG1fcmVzb3VyY2Vf
bWFuYWdlcl9kZWJ1Zyk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9zeXNf
bWFuYWdlci5jIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fc3lzX21hbmFnZXIuYwpuZXcgZmls
ZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjMyYmMxNmYwMjJmOQotLS0gL2Rldi9u
dWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX3N5c19tYW5hZ2VyLmMKQEAgLTAsMCAr
MSw0NiBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAgT1IgTUlUICovCisK
KyNpbmNsdWRlIDxkcm0vdHRtL3R0bV9yZXNvdXJjZS5oPgorI2luY2x1ZGUgPGRybS90dG0vdHRt
X2RldmljZS5oPgorI2luY2x1ZGUgPGRybS90dG0vdHRtX3BsYWNlbWVudC5oPgorCitzdGF0aWMg
aW50IHR0bV9zeXNfbWFuX2FsbG9jKHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuLAor
CQkJICAgICBzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAorCQkJICAgICBjb25zdCBzdHJ1
Y3QgdHRtX3BsYWNlICpwbGFjZSwKKwkJCSAgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqbWVtKQor
eworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCB0dG1fc3lzX21hbl9mcmVlKHN0cnVjdCB0
dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuLAorCQkJICAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlICpt
ZW0pCit7Cit9CisKK3N0YXRpYyB2b2lkIHR0bV9zeXNfbWFuX2RlYnVnKHN0cnVjdCB0dG1fcmVz
b3VyY2VfbWFuYWdlciAqbWFuLAorCQkJICAgICAgc3RydWN0IGRybV9wcmludGVyICpwcmludGVy
KQoreworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyX2Z1bmMg
dHRtX3N5c19tYW5hZ2VyX2Z1bmMgPSB7CisJLmFsbG9jID0gdHRtX3N5c19tYW5fYWxsb2MsCisJ
LmZyZWUgPSB0dG1fc3lzX21hbl9mcmVlLAorCS5kZWJ1ZyA9IHR0bV9zeXNfbWFuX2RlYnVnCit9
OworCitpbnQgdHRtX3N5c19tYW5faW5pdChzdHJ1Y3QgdHRtX2RldmljZSAqYmRldikKK3sKKwlz
dHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiA9ICZiZGV2LT5zeXNtYW47CisKKwkvKgor
CSAqIEluaXRpYWxpemUgdGhlIHN5c3RlbSBtZW1vcnkgYnVmZmVyIHR5cGUuCisJICogT3RoZXIg
dHlwZXMgbmVlZCB0byBiZSBkcml2ZXIgLyBJT0NUTCBpbml0aWFsaXplZC4KKwkgKi8KKwltYW4t
PnVzZV90dCA9IHRydWU7CisJbWFuLT5mdW5jID0gJnR0bV9zeXNfbWFuYWdlcl9mdW5jOworCisJ
dHRtX3Jlc291cmNlX21hbmFnZXJfaW5pdChtYW4sIDApOworCXR0bV9zZXRfZHJpdmVyX21hbmFn
ZXIoYmRldiwgVFRNX1BMX1NZU1RFTSwgbWFuKTsKKwl0dG1fcmVzb3VyY2VfbWFuYWdlcl9zZXRf
dXNlZChtYW4sIHRydWUpOworCXJldHVybiAwOworfQotLSAKMi4yNS4xCgpfX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0
CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3Rv
cC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWwK
