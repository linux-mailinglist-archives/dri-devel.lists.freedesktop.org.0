Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id D3B572450FF
	for <lists+dri-devel@lfdr.de>; Sat, 15 Aug 2020 14:54:40 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 88C5C6E102;
	Sat, 15 Aug 2020 12:54:30 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-lj1-x241.google.com (mail-lj1-x241.google.com
 [IPv6:2a00:1450:4864:20::241])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 501466E358
 for <dri-devel@lists.freedesktop.org>; Sat, 15 Aug 2020 12:54:28 +0000 (UTC)
Received: by mail-lj1-x241.google.com with SMTP id g6so12629477ljn.11
 for <dri-devel@lists.freedesktop.org>; Sat, 15 Aug 2020 05:54:28 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=sender:from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=P6t9Q+tnYCd2UZsp9IleZtK4GJRtBbIqS2dMUyt5rgo=;
 b=dr/UcwJsQZI/Xj0n8SH9WW2kIbySaKefVmb6nge5ecLj+Gnb8FomjXtFPnLnZZ5/DX
 wobiCOxaLsDtIklVdTOGPt7Ugz7x/kBIfQ0hcjb71PYEDIevv+45v0akPtpzSvJFuFR7
 KhXFzadPqNYBmcvwig+vWcriyaPvkiyytwjuFZlZ98jqo9cNL0HiRQofgLTjv48mzipF
 7p7DkiSW6WQ4oqp9YqRvmlZTqSDLj71UV7jRoNIsE3bvFuFMt1Rb6g23QVvqeNbHhXSa
 SOfuwMbgeKFlcLmmwenN2aEy2PrrQmEyxIX0sGkNXQpmhBQdo4Fuiru7sqbX19rou264
 l4hg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:sender:from:to:cc:subject:date:message-id
 :in-reply-to:references:mime-version:content-transfer-encoding;
 bh=P6t9Q+tnYCd2UZsp9IleZtK4GJRtBbIqS2dMUyt5rgo=;
 b=hgU0rodBnjC64kpD3V0M2DYfOFxvXX9ryfG7ahG0RV5PQL3poRg0VWcKkB97U+8EdS
 2MXwsBfpBeDDuxwBN0yv72bktxFoYkqaA9Hflx9Ie8vkC1ML8eKqjk7Eb29g/OWhtmtg
 FgyI6nDW4lPu3ZntmS5EiYzSl4PpTRmaClP7w0W1jVb27r6h0bRd9G0HBnsjpxG0bvUm
 w9mDbakH2FmzjthB7NTGL8UGYNoJ3flrPw5pqqK7PIdYUQdKw5wChYj+KsubcTuSCwkQ
 cuXtBsZqkw/0LCatccL+OFrIEDwMZVxa1+tKc0LdBg9ZkHZjsPUmMwK8jlZdKzBQPP0M
 sIRg==
X-Gm-Message-State: AOAM532QiXM1JZlG+cE8QvZ9e3Pk/OBktUGaspu5y4ie5QPZ2sb2uup7
 dTrkUDHmel/49kqMXiCHwWALKHtBPara4Q==
X-Google-Smtp-Source: ABdhPJzMZWfJSWD/X/c9BETtbvPGkG2P38IUPmHcoJ7in6uTcV42Pl7WpGid3/q6iH9UhIlPxFF50Q==
X-Received: by 2002:a2e:2a86:: with SMTP id q128mr3181664ljq.116.1597496066161; 
 Sat, 15 Aug 2020 05:54:26 -0700 (PDT)
Received: from saturn.lan ([2a00:fd00:805f:db00:402:93d8:3e64:6121])
 by smtp.gmail.com with ESMTPSA id e29sm2396322ljp.136.2020.08.15.05.54.25
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Sat, 15 Aug 2020 05:54:25 -0700 (PDT)
From: Sam Ravnborg <sam@ravnborg.org>
To: dri-devel@lists.freedesktop.org, Thierry Reding <thierry.reding@gmail.com>
Subject: [PATCH v1 5/5] drm/panel: Use dev_ based logging
Date: Sat, 15 Aug 2020 14:54:06 +0200
Message-Id: <20200815125406.1153224-6-sam@ravnborg.org>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20200815125406.1153224-1-sam@ravnborg.org>
References: <20200815125406.1153224-1-sam@ravnborg.org>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Laurent Pinchart <laurent.pinchart@ideasonboard.com>,
 David Airlie <airlied@linux.ie>,
 =?UTF-8?q?Guido=20G=C3=BCnther?= <agx@sigxcpu.org>,
 Jerry Han <hanxu5@huaqin.corp-partner.google.com>,
 Jani Nikula <jani.nikula@intel.com>, Jagan Teki <jagan@amarulasolutions.com>,
 Robert Chiras <robert.chiras@nxp.com>, Sam Ravnborg <sam@ravnborg.org>,
 Icenowy Zheng <icenowy@aosc.io>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

U3RhbmRhcmRpemUgb24gdGhlIGRldl8gYmFzZWQgbG9nZ2luZyBhbmQgZHJvcCB0aGUgaW5jbHVk
ZSBvZiBkcm1fcHJpbnQuaC4KRml4IGEgZmV3IGNhc2VzIHdoZXJlICJ4QCIgd2FzIHVzZWQgd2hl
biBwcmludGluZyB0aGUgbW9kZS4KClNpZ25lZC1vZmYtYnk6IFNhbSBSYXZuYm9yZyA8c2FtQHJh
dm5ib3JnLm9yZz4KQ2M6IEplcnJ5IEhhbiA8aGFueHU1QGh1YXFpbi5jb3JwLXBhcnRuZXIuZ29v
Z2xlLmNvbT4KQ2M6IFRoaWVycnkgUmVkaW5nIDx0aGllcnJ5LnJlZGluZ0BnbWFpbC5jb20+CkNj
OiBTYW0gUmF2bmJvcmcgPHNhbUByYXZuYm9yZy5vcmc+CkNjOiBJY2Vub3d5IFpoZW5nIDxpY2Vu
b3d5QGFvc2MuaW8+CkNjOiBKYWdhbiBUZWtpIDxqYWdhbkBhbWFydWxhc29sdXRpb25zLmNvbT4K
Q2M6IExpbnVzIFdhbGxlaWogPGxpbnVzLndhbGxlaWpAbGluYXJvLm9yZz4KQ2M6IEd1aWRvIEfD
vG50aGVyIDxhZ3hAc2lneGNwdS5vcmc+CkNjOiBMYXVyZW50IFBpbmNoYXJ0IDxsYXVyZW50LnBp
bmNoYXJ0QGlkZWFzb25ib2FyZC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVs
LWJvZS1oaW1heDgyNzlkLmMgIHwgNDQgKysrKy0tLS0tLQogZHJpdmVycy9ncHUvZHJtL3BhbmVs
L3BhbmVsLWVsaWRhLWtkMzV0MTMzLmMgIHwgNTEgKysrKystLS0tLS0tCiAuLi4vZ3B1L2RybS9w
YW5lbC9wYW5lbC1mZWl4aW4tazEwMS1pbTJiYTAyLmMgfCAxOSArKy0tLQogLi4uL2RybS9wYW5l
bC9wYW5lbC1mZWl5YW5nLWZ5MDcwMjRkaTI2YTMwZC5jIHwgMjEgKysrLS0KIGRyaXZlcnMvZ3B1
L2RybS9wYW5lbC9wYW5lbC1pbGl0ZWstaWxpOTMyMi5jICB8ICAzICstCiBkcml2ZXJzL2dwdS9k
cm0vcGFuZWwvcGFuZWwtaW5ub2x1eC1wMDc5emNhLmMgfCAzMSArKystLS0tCiAuLi4vZHJtL3Bh
bmVsL3BhbmVsLWtpbmdkaXNwbGF5LWtkMDk3ZDA0LmMgICAgfCAzMyArKystLS0tLQogZHJpdmVy
cy9ncHUvZHJtL3BhbmVsL3BhbmVsLW5vdmF0ZWstbnQzNTUxMC5jIHwgNDAgKysrKy0tLS0tCiAu
Li4vZ3B1L2RybS9wYW5lbC9wYW5lbC1vcmlzZXRlY2gtb3RtODAwOWEuYyAgfCAxMyArKy0KIGRy
aXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1yb25iby1yYjA3MGQzMC5jICB8IDE2ICsrLS0KIGRy
aXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1zb255LWFjeDQyNGFrcC5jICB8IDgxICsrKysrKyst
LS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC10cG8tdHBnMTEwLmMgICAg
ICB8IDM4ICsrKystLS0tLQogZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLXRydWx5LW50MzU1
OTcuYyAgIHwgNjMgKysrKystLS0tLS0tLS0tCiAuLi4vZ3B1L2RybS9wYW5lbC9wYW5lbC12aXNp
b25veC1ybTY5Mjk5LmMgICAgfCA0MSArKystLS0tLS0tCiAuLi4vZ3B1L2RybS9wYW5lbC9wYW5l
bC14aW5wZW5nLXhwcDA1NWMyNzIuYyAgfCA1MSArKysrKy0tLS0tLS0KIDE1IGZpbGVzIGNoYW5n
ZWQsIDIwMCBpbnNlcnRpb25zKCspLCAzNDUgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLWJvZS1oaW1heDgyNzlkLmMgYi9kcml2ZXJzL2dwdS9k
cm0vcGFuZWwvcGFuZWwtYm9lLWhpbWF4ODI3OWQuYwppbmRleCBkNjc2YjRjMmE4ZmEuLjQyODU0
YmQzN2ZkNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLWJvZS1oaW1h
eDgyNzlkLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLWJvZS1oaW1heDgyNzlk
LmMKQEAgLTE5LDcgKzE5LDYgQEAKICNpbmNsdWRlIDxkcm0vZHJtX21pcGlfZHNpLmg+CiAjaW5j
bHVkZSA8ZHJtL2RybV9tb2Rlcy5oPgogI2luY2x1ZGUgPGRybS9kcm1fcGFuZWwuaD4KLSNpbmNs
dWRlIDxkcm0vZHJtX3ByaW50Lmg+CiAKICNpbmNsdWRlIDx2aWRlby9taXBpX2Rpc3BsYXkuaD4K
IApAQCAtOTMsOCArOTIsNyBAQCBzdGF0aWMgaW50IGJvZV9wYW5lbF9kaXNhYmxlKHN0cnVjdCBk
cm1fcGFuZWwgKnBhbmVsKQogCiAJZXJyID0gbWlwaV9kc2lfZGNzX3NldF9kaXNwbGF5X29mZihw
aW5mby0+bGluayk7CiAJaWYgKGVyciA8IDApIHsKLQkJRFJNX0RFVl9FUlJPUihwYW5lbC0+ZGV2
LCAiZmFpbGVkIHRvIHNldCBkaXNwbGF5IG9mZjogJWRcbiIsCi0JCQkgICAgICBlcnIpOworCQlk
ZXZfZXJyKHBhbmVsLT5kZXYsICJmYWlsZWQgdG8gc2V0IGRpc3BsYXkgb2ZmOiAlZFxuIiwgZXJy
KTsKIAkJcmV0dXJuIGVycjsKIAl9CiAKQEAgLTExMywxMyArMTExLDExIEBAIHN0YXRpYyBpbnQg
Ym9lX3BhbmVsX3VucHJlcGFyZShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKIAogCWVyciA9IG1p
cGlfZHNpX2Rjc19zZXRfZGlzcGxheV9vZmYocGluZm8tPmxpbmspOwogCWlmIChlcnIgPCAwKQot
CQlEUk1fREVWX0VSUk9SKHBhbmVsLT5kZXYsICJmYWlsZWQgdG8gc2V0IGRpc3BsYXkgb2ZmOiAl
ZFxuIiwKLQkJCSAgICAgIGVycik7CisJCWRldl9lcnIocGFuZWwtPmRldiwgImZhaWxlZCB0byBz
ZXQgZGlzcGxheSBvZmY6ICVkXG4iLCBlcnIpOwogCiAJZXJyID0gbWlwaV9kc2lfZGNzX2VudGVy
X3NsZWVwX21vZGUocGluZm8tPmxpbmspOwogCWlmIChlcnIgPCAwKQotCQlEUk1fREVWX0VSUk9S
KHBhbmVsLT5kZXYsICJmYWlsZWQgdG8gZW50ZXIgc2xlZXAgbW9kZTogJWRcbiIsCi0JCQkgICAg
ICBlcnIpOworCQlkZXZfZXJyKHBhbmVsLT5kZXYsICJmYWlsZWQgdG8gZW50ZXIgc2xlZXAgbW9k
ZTogJWRcbiIsIGVycik7CiAKIAkvKiBzbGVlcF9tb2RlX2RlbGF5OiAxbXMgLSAybXMgKi8KIAl1
c2xlZXBfcmFuZ2UoMTAwMCwgMjAwMCk7CkBAIC0xNjMsMTUgKzE1OSwxMyBAQCBzdGF0aWMgaW50
IGJvZV9wYW5lbF9wcmVwYXJlKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQogCS8qIHNlbmQgaW5p
dCBjb2RlICovCiAJZXJyID0gc2VuZF9taXBpX2NtZHMocGFuZWwsIHBpbmZvLT5kZXNjLT5vbl9j
bWRzKTsKIAlpZiAoZXJyIDwgMCkgewotCQlEUk1fREVWX0VSUk9SKHBhbmVsLT5kZXYsICJmYWls
ZWQgdG8gc2VuZCBEQ1MgSW5pdCBDb2RlOiAlZFxuIiwKLQkJCSAgICAgIGVycik7CisJCWRldl9l
cnIocGFuZWwtPmRldiwgImZhaWxlZCB0byBzZW5kIERDUyBJbml0IENvZGU6ICVkXG4iLCBlcnIp
OwogCQlnb3RvIHBvd2Vyb2ZmOwogCX0KIAogCWVyciA9IG1pcGlfZHNpX2Rjc19leGl0X3NsZWVw
X21vZGUocGluZm8tPmxpbmspOwogCWlmIChlcnIgPCAwKSB7Ci0JCURSTV9ERVZfRVJST1IocGFu
ZWwtPmRldiwgImZhaWxlZCB0byBleGl0IHNsZWVwIG1vZGU6ICVkXG4iLAotCQkJICAgICAgZXJy
KTsKKwkJZGV2X2VycihwYW5lbC0+ZGV2LCAiZmFpbGVkIHRvIGV4aXQgc2xlZXAgbW9kZTogJWRc
biIsIGVycik7CiAJCWdvdG8gcG93ZXJvZmY7CiAJfQogCkBAIC0xODAsOCArMTc0LDcgQEAgc3Rh
dGljIGludCBib2VfcGFuZWxfcHJlcGFyZShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKIAogCWVy
ciA9IG1pcGlfZHNpX2Rjc19zZXRfZGlzcGxheV9vbihwaW5mby0+bGluayk7CiAJaWYgKGVyciA8
IDApIHsKLQkJRFJNX0RFVl9FUlJPUihwYW5lbC0+ZGV2LCAiZmFpbGVkIHRvIHNldCBkaXNwbGF5
IG9uOiAlZFxuIiwKLQkJCSAgICAgIGVycik7CisJCWRldl9lcnIocGFuZWwtPmRldiwgImZhaWxl
ZCB0byBzZXQgZGlzcGxheSBvbjogJWRcbiIsIGVycik7CiAJCWdvdG8gcG93ZXJvZmY7CiAJfQog
CkBAIC0yMDksOCArMjAyLDcgQEAgc3RhdGljIGludCBib2VfcGFuZWxfZW5hYmxlKHN0cnVjdCBk
cm1fcGFuZWwgKnBhbmVsKQogCiAJcmV0ID0gbWlwaV9kc2lfZGNzX3NldF9kaXNwbGF5X29uKHBp
bmZvLT5saW5rKTsKIAlpZiAocmV0IDwgMCkgewotCQlEUk1fREVWX0VSUk9SKHBhbmVsLT5kZXYs
ICJmYWlsZWQgdG8gc2V0IGRpc3BsYXkgb246ICVkXG4iLAotCQkJICAgICAgcmV0KTsKKwkJZGV2
X2VycihwYW5lbC0+ZGV2LCAiZmFpbGVkIHRvIHNldCBkaXNwbGF5IG9uOiAlZFxuIiwgcmV0KTsK
IAkJcmV0dXJuIHJldDsKIAl9CiAKQEAgLTIyOCw4ICsyMjAsOCBAQCBzdGF0aWMgaW50IGJvZV9w
YW5lbF9nZXRfbW9kZXMoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwsCiAKIAltb2RlID0gZHJtX21v
ZGVfZHVwbGljYXRlKGNvbm5lY3Rvci0+ZGV2LCBtKTsKIAlpZiAoIW1vZGUpIHsKLQkJRFJNX0RF
Vl9FUlJPUihwaW5mby0+YmFzZS5kZXYsICJmYWlsZWQgdG8gYWRkIG1vZGUgJXV4JXVAJXVcbiIs
Ci0JCQkgICAgICBtLT5oZGlzcGxheSwgbS0+dmRpc3BsYXksIGRybV9tb2RlX3ZyZWZyZXNoKG0p
KTsKKwkJZGV2X2VycihwaW5mby0+YmFzZS5kZXYsICJmYWlsZWQgdG8gYWRkIG1vZGUgJXV4JXVA
JXVcbiIsCisJCQltLT5oZGlzcGxheSwgbS0+dmRpc3BsYXksIGRybV9tb2RlX3ZyZWZyZXNoKG0p
KTsKIAkJcmV0dXJuIC1FTk9NRU07CiAJfQogCkBAIC04NjUsOCArODU3LDcgQEAgc3RhdGljIGlu
dCBwYW5lbF9hZGQoc3RydWN0IHBhbmVsX2luZm8gKnBpbmZvKQogCWlmIChJU19FUlIocGluZm8t
PnBwMThfZ3BpbykpIHsKIAkJcmV0ID0gUFRSX0VSUihwaW5mby0+cHAxOF9ncGlvKTsKIAkJaWYg
KHJldCAhPSAtRVBST0JFX0RFRkVSKQotCQkJRFJNX0RFVl9FUlJPUihkZXYsICJmYWlsZWQgdG8g
Z2V0IHBwMTggZ3BpbzogJWRcbiIsCi0JCQkJICAgICAgcmV0KTsKKwkJCWRldl9lcnIoZGV2LCAi
ZmFpbGVkIHRvIGdldCBwcDE4IGdwaW86ICVkXG4iLCByZXQpOwogCQlyZXR1cm4gcmV0OwogCX0K
IApAQCAtODc0LDggKzg2NSw3IEBAIHN0YXRpYyBpbnQgcGFuZWxfYWRkKHN0cnVjdCBwYW5lbF9p
bmZvICpwaW5mbykKIAlpZiAoSVNfRVJSKHBpbmZvLT5wcDMzX2dwaW8pKSB7CiAJCXJldCA9IFBU
Ul9FUlIocGluZm8tPnBwMzNfZ3Bpbyk7CiAJCWlmIChyZXQgIT0gLUVQUk9CRV9ERUZFUikKLQkJ
CURSTV9ERVZfRVJST1IoZGV2LCAiZmFpbGVkIHRvIGdldCBwcDMzIGdwaW86ICVkXG4iLAotCQkJ
CSAgICAgIHJldCk7CisJCQlkZXZfZXJyKGRldiwgImZhaWxlZCB0byBnZXQgcHAzMyBncGlvOiAl
ZFxuIiwgcmV0KTsKIAkJcmV0dXJuIHJldDsKIAl9CiAKQEAgLTg4Myw4ICs4NzMsNyBAQCBzdGF0
aWMgaW50IHBhbmVsX2FkZChzdHJ1Y3QgcGFuZWxfaW5mbyAqcGluZm8pCiAJaWYgKElTX0VSUihw
aW5mby0+ZW5hYmxlX2dwaW8pKSB7CiAJCXJldCA9IFBUUl9FUlIocGluZm8tPmVuYWJsZV9ncGlv
KTsKIAkJaWYgKHJldCAhPSAtRVBST0JFX0RFRkVSKQotCQkJRFJNX0RFVl9FUlJPUihkZXYsICJm
YWlsZWQgdG8gZ2V0IGVuYWJsZSBncGlvOiAlZFxuIiwKLQkJCQkgICAgICByZXQpOworCQkJZGV2
X2VycihkZXYsICJmYWlsZWQgdG8gZ2V0IGVuYWJsZSBncGlvOiAlZFxuIiwgcmV0KTsKIAkJcmV0
dXJuIHJldDsKIAl9CiAKQEAgLTkzNywxOCArOTI2LDE1IEBAIHN0YXRpYyBpbnQgcGFuZWxfcmVt
b3ZlKHN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSkKIAogCWVyciA9IGJvZV9wYW5lbF9kaXNh
YmxlKCZwaW5mby0+YmFzZSk7CiAJaWYgKGVyciA8IDApCi0JCURSTV9ERVZfRVJST1IoJmRzaS0+
ZGV2LCAiZmFpbGVkIHRvIGRpc2FibGUgcGFuZWw6ICVkXG4iLAotCQkJICAgICAgZXJyKTsKKwkJ
ZGV2X2VycigmZHNpLT5kZXYsICJmYWlsZWQgdG8gZGlzYWJsZSBwYW5lbDogJWRcbiIsIGVycik7
CiAKIAllcnIgPSBib2VfcGFuZWxfdW5wcmVwYXJlKCZwaW5mby0+YmFzZSk7CiAJaWYgKGVyciA8
IDApCi0JCURSTV9ERVZfRVJST1IoJmRzaS0+ZGV2LCAiZmFpbGVkIHRvIHVucHJlcGFyZSBwYW5l
bDogJWRcbiIsCi0JCQkgICAgICBlcnIpOworCQlkZXZfZXJyKCZkc2ktPmRldiwgImZhaWxlZCB0
byB1bnByZXBhcmUgcGFuZWw6ICVkXG4iLCBlcnIpOwogCiAJZXJyID0gbWlwaV9kc2lfZGV0YWNo
KGRzaSk7CiAJaWYgKGVyciA8IDApCi0JCURSTV9ERVZfRVJST1IoJmRzaS0+ZGV2LCAiZmFpbGVk
IHRvIGRldGFjaCBmcm9tIERTSSBob3N0OiAlZFxuIiwKLQkJCSAgICAgIGVycik7CisJCWRldl9l
cnIoJmRzaS0+ZGV2LCAiZmFpbGVkIHRvIGRldGFjaCBmcm9tIERTSSBob3N0OiAlZFxuIiwgZXJy
KTsKIAogCWRybV9wYW5lbF9yZW1vdmUoJnBpbmZvLT5iYXNlKTsKIApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLWVsaWRhLWtkMzV0MTMzLmMgYi9kcml2ZXJzL2dwdS9k
cm0vcGFuZWwvcGFuZWwtZWxpZGEta2QzNXQxMzMuYwppbmRleCBlOTY3NTUxNGQ3N2IuLmJjMzZh
YTNjMTEyMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLWVsaWRhLWtk
MzV0MTMzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLWVsaWRhLWtkMzV0MTMz
LmMKQEAgLTIyLDcgKzIyLDYgQEAKICNpbmNsdWRlIDxkcm0vZHJtX21pcGlfZHNpLmg+CiAjaW5j
bHVkZSA8ZHJtL2RybV9tb2Rlcy5oPgogI2luY2x1ZGUgPGRybS9kcm1fcGFuZWwuaD4KLSNpbmNs
dWRlIDxkcm0vZHJtX3ByaW50Lmg+CiAKIC8qIE1hbnVmYWN0dXJlciBzcGVjaWZpYyBDb21tYW5k
cyBzZW5kIHZpYSBEU0kgKi8KICNkZWZpbmUgS0QzNVQxMzNfQ01EX0lOVEVSRkFDRU1PREVDVFJM
CQkweGIwCkBAIC04OSw3ICs4OCw3IEBAIHN0YXRpYyBpbnQga2QzNXQxMzNfaW5pdF9zZXF1ZW5j
ZShzdHJ1Y3Qga2QzNXQxMzMgKmN0eCkKIAkJCSAgMHhhOSwgMHg1MSwgMHgyYywgMHg4Mik7CiAJ
bWlwaV9kc2lfZGNzX3dyaXRlKGRzaSwgTUlQSV9EQ1NfRU5URVJfSU5WRVJUX01PREUsIE5VTEws
IDApOwogCi0JRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiUGFuZWwgaW5pdCBzZXF1ZW5jZSBk
b25lXG4iKTsKKwlkZXZfZGJnKGRldiwgIlBhbmVsIGluaXQgc2VxdWVuY2UgZG9uZVxuIik7CiAJ
cmV0dXJuIDA7CiB9CiAKQEAgLTEwNCwxMyArMTAzLDExIEBAIHN0YXRpYyBpbnQga2QzNXQxMzNf
dW5wcmVwYXJlKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQogCiAJcmV0ID0gbWlwaV9kc2lfZGNz
X3NldF9kaXNwbGF5X29mZihkc2kpOwogCWlmIChyZXQgPCAwKQotCQlEUk1fREVWX0VSUk9SKGN0
eC0+ZGV2LCAiZmFpbGVkIHRvIHNldCBkaXNwbGF5IG9mZjogJWRcbiIsCi0JCQkgICAgICByZXQp
OworCQlkZXZfZXJyKGN0eC0+ZGV2LCAiZmFpbGVkIHRvIHNldCBkaXNwbGF5IG9mZjogJWRcbiIs
IHJldCk7CiAKIAlyZXQgPSBtaXBpX2RzaV9kY3NfZW50ZXJfc2xlZXBfbW9kZShkc2kpOwogCWlm
IChyZXQgPCAwKSB7Ci0JCURSTV9ERVZfRVJST1IoY3R4LT5kZXYsICJmYWlsZWQgdG8gZW50ZXIg
c2xlZXAgbW9kZTogJWRcbiIsCi0JCQkgICAgICByZXQpOworCQlkZXZfZXJyKGN0eC0+ZGV2LCAi
ZmFpbGVkIHRvIGVudGVyIHNsZWVwIG1vZGU6ICVkXG4iLCByZXQpOwogCQlyZXR1cm4gcmV0Owog
CX0KIApAQCAtMTMxLDE4ICsxMjgsMTYgQEAgc3RhdGljIGludCBrZDM1dDEzM19wcmVwYXJlKHN0
cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQogCWlmIChjdHgtPnByZXBhcmVkKQogCQlyZXR1cm4gMDsK
IAotCURSTV9ERVZfREVCVUdfRFJJVkVSKGN0eC0+ZGV2LCAiUmVzZXR0aW5nIHRoZSBwYW5lbFxu
Iik7CisJZGV2X2RiZyhjdHgtPmRldiwgIlJlc2V0dGluZyB0aGUgcGFuZWxcbiIpOwogCXJldCA9
IHJlZ3VsYXRvcl9lbmFibGUoY3R4LT52ZGQpOwogCWlmIChyZXQgPCAwKSB7Ci0JCURSTV9ERVZf
RVJST1IoY3R4LT5kZXYsCi0JCQkgICAgICAiRmFpbGVkIHRvIGVuYWJsZSB2ZGQgc3VwcGx5OiAl
ZFxuIiwgcmV0KTsKKwkJZGV2X2VycihjdHgtPmRldiwgIkZhaWxlZCB0byBlbmFibGUgdmRkIHN1
cHBseTogJWRcbiIsIHJldCk7CiAJCXJldHVybiByZXQ7CiAJfQogCiAJcmV0ID0gcmVndWxhdG9y
X2VuYWJsZShjdHgtPmlvdmNjKTsKIAlpZiAocmV0IDwgMCkgewotCQlEUk1fREVWX0VSUk9SKGN0
eC0+ZGV2LAotCQkJICAgICAgIkZhaWxlZCB0byBlbmFibGUgaW92Y2Mgc3VwcGx5OiAlZFxuIiwg
cmV0KTsKKwkJZGV2X2VycihjdHgtPmRldiwgIkZhaWxlZCB0byBlbmFibGUgaW92Y2Mgc3VwcGx5
OiAlZFxuIiwgcmV0KTsKIAkJZ290byBkaXNhYmxlX3ZkZDsKIAl9CiAKQEAgLTE1Niw3ICsxNTEs
NyBAQCBzdGF0aWMgaW50IGtkMzV0MTMzX3ByZXBhcmUoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwp
CiAKIAlyZXQgPSBtaXBpX2RzaV9kY3NfZXhpdF9zbGVlcF9tb2RlKGRzaSk7CiAJaWYgKHJldCA8
IDApIHsKLQkJRFJNX0RFVl9FUlJPUihjdHgtPmRldiwgIkZhaWxlZCB0byBleGl0IHNsZWVwIG1v
ZGU6ICVkXG4iLCByZXQpOworCQlkZXZfZXJyKGN0eC0+ZGV2LCAiRmFpbGVkIHRvIGV4aXQgc2xl
ZXAgbW9kZTogJWRcbiIsIHJldCk7CiAJCWdvdG8gZGlzYWJsZV9pb3ZjYzsKIAl9CiAKQEAgLTE2
NCwxNCArMTU5LDEzIEBAIHN0YXRpYyBpbnQga2QzNXQxMzNfcHJlcGFyZShzdHJ1Y3QgZHJtX3Bh
bmVsICpwYW5lbCkKIAogCXJldCA9IGtkMzV0MTMzX2luaXRfc2VxdWVuY2UoY3R4KTsKIAlpZiAo
cmV0IDwgMCkgewotCQlEUk1fREVWX0VSUk9SKGN0eC0+ZGV2LCAiUGFuZWwgaW5pdCBzZXF1ZW5j
ZSBmYWlsZWQ6ICVkXG4iLAotCQkJICAgICAgcmV0KTsKKwkJZGV2X2VycihjdHgtPmRldiwgIlBh
bmVsIGluaXQgc2VxdWVuY2UgZmFpbGVkOiAlZFxuIiwgcmV0KTsKIAkJZ290byBkaXNhYmxlX2lv
dmNjOwogCX0KIAogCXJldCA9IG1pcGlfZHNpX2Rjc19zZXRfZGlzcGxheV9vbihkc2kpOwogCWlm
IChyZXQgPCAwKSB7Ci0JCURSTV9ERVZfRVJST1IoY3R4LT5kZXYsICJGYWlsZWQgdG8gc2V0IGRp
c3BsYXkgb246ICVkXG4iLCByZXQpOworCQlkZXZfZXJyKGN0eC0+ZGV2LCAiRmFpbGVkIHRvIHNl
dCBkaXNwbGF5IG9uOiAlZFxuIiwgcmV0KTsKIAkJZ290byBkaXNhYmxlX2lvdmNjOwogCX0KIApA
QCAtMjEwLDkgKzIwNCw5IEBAIHN0YXRpYyBpbnQga2QzNXQxMzNfZ2V0X21vZGVzKHN0cnVjdCBk
cm1fcGFuZWwgKnBhbmVsLAogCiAJbW9kZSA9IGRybV9tb2RlX2R1cGxpY2F0ZShjb25uZWN0b3It
PmRldiwgJmRlZmF1bHRfbW9kZSk7CiAJaWYgKCFtb2RlKSB7Ci0JCURSTV9ERVZfRVJST1IoY3R4
LT5kZXYsICJGYWlsZWQgdG8gYWRkIG1vZGUgJXV4JXVAJXVcbiIsCi0JCQkgICAgICBkZWZhdWx0
X21vZGUuaGRpc3BsYXksIGRlZmF1bHRfbW9kZS52ZGlzcGxheSwKLQkJCSAgICAgIGRybV9tb2Rl
X3ZyZWZyZXNoKCZkZWZhdWx0X21vZGUpKTsKKwkJZGV2X2VycihjdHgtPmRldiwgIkZhaWxlZCB0
byBhZGQgbW9kZSAldXgldUAldVxuIiwKKwkJCWRlZmF1bHRfbW9kZS5oZGlzcGxheSwgZGVmYXVs
dF9tb2RlLnZkaXNwbGF5LAorCQkJZHJtX21vZGVfdnJlZnJlc2goJmRlZmF1bHRfbW9kZSkpOwog
CQlyZXR1cm4gLUVOT01FTTsKIAl9CiAKQEAgLTI0NCw3ICsyMzgsNyBAQCBzdGF0aWMgaW50IGtk
MzV0MTMzX3Byb2JlKHN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSkKIAogCWN0eC0+cmVzZXRf
Z3BpbyA9IGRldm1fZ3Bpb2RfZ2V0X29wdGlvbmFsKGRldiwgInJlc2V0IiwgR1BJT0RfT1VUX0xP
Vyk7CiAJaWYgKElTX0VSUihjdHgtPnJlc2V0X2dwaW8pKSB7Ci0JCURSTV9ERVZfRVJST1IoZGV2
LCAiY2Fubm90IGdldCByZXNldCBncGlvXG4iKTsKKwkJZGV2X2VycihkZXYsICJjYW5ub3QgZ2V0
IHJlc2V0IGdwaW9cbiIpOwogCQlyZXR1cm4gUFRSX0VSUihjdHgtPnJlc2V0X2dwaW8pOwogCX0K
IApAQCAtMjUyLDkgKzI0Niw3IEBAIHN0YXRpYyBpbnQga2QzNXQxMzNfcHJvYmUoc3RydWN0IG1p
cGlfZHNpX2RldmljZSAqZHNpKQogCWlmIChJU19FUlIoY3R4LT52ZGQpKSB7CiAJCXJldCA9IFBU
Ul9FUlIoY3R4LT52ZGQpOwogCQlpZiAocmV0ICE9IC1FUFJPQkVfREVGRVIpCi0JCQlEUk1fREVW
X0VSUk9SKGRldiwKLQkJCQkgICAgICAiRmFpbGVkIHRvIHJlcXVlc3QgdmRkIHJlZ3VsYXRvcjog
JWRcbiIsCi0JCQkJICAgICAgcmV0KTsKKwkJCWRldl9lcnIoZGV2LCAiRmFpbGVkIHRvIHJlcXVl
c3QgdmRkIHJlZ3VsYXRvcjogJWRcbiIsIHJldCk7CiAJCXJldHVybiByZXQ7CiAJfQogCkBAIC0y
NjIsOSArMjU0LDcgQEAgc3RhdGljIGludCBrZDM1dDEzM19wcm9iZShzdHJ1Y3QgbWlwaV9kc2lf
ZGV2aWNlICpkc2kpCiAJaWYgKElTX0VSUihjdHgtPmlvdmNjKSkgewogCQlyZXQgPSBQVFJfRVJS
KGN0eC0+aW92Y2MpOwogCQlpZiAocmV0ICE9IC1FUFJPQkVfREVGRVIpCi0JCQlEUk1fREVWX0VS
Uk9SKGRldiwKLQkJCQkgICAgICAiRmFpbGVkIHRvIHJlcXVlc3QgaW92Y2MgcmVndWxhdG9yOiAl
ZFxuIiwKLQkJCQkgICAgICByZXQpOworCQkJZGV2X2VycihkZXYsICJGYWlsZWQgdG8gcmVxdWVz
dCBpb3ZjYyByZWd1bGF0b3I6ICVkXG4iLCByZXQpOwogCQlyZXR1cm4gcmV0OwogCX0KIApAQCAt
Mjg4LDcgKzI3OCw3IEBAIHN0YXRpYyBpbnQga2QzNXQxMzNfcHJvYmUoc3RydWN0IG1pcGlfZHNp
X2RldmljZSAqZHNpKQogCiAJcmV0ID0gbWlwaV9kc2lfYXR0YWNoKGRzaSk7CiAJaWYgKHJldCA8
IDApIHsKLQkJRFJNX0RFVl9FUlJPUihkZXYsICJtaXBpX2RzaV9hdHRhY2ggZmFpbGVkOiAlZFxu
IiwgcmV0KTsKKwkJZGV2X2VycihkZXYsICJtaXBpX2RzaV9hdHRhY2ggZmFpbGVkOiAlZFxuIiwg
cmV0KTsKIAkJZHJtX3BhbmVsX3JlbW92ZSgmY3R4LT5wYW5lbCk7CiAJCXJldHVybiByZXQ7CiAJ
fQpAQCAtMzAzLDEzICsyOTMsMTEgQEAgc3RhdGljIHZvaWQga2QzNXQxMzNfc2h1dGRvd24oc3Ry
dWN0IG1pcGlfZHNpX2RldmljZSAqZHNpKQogCiAJcmV0ID0gZHJtX3BhbmVsX3VucHJlcGFyZSgm
Y3R4LT5wYW5lbCk7CiAJaWYgKHJldCA8IDApCi0JCURSTV9ERVZfRVJST1IoJmRzaS0+ZGV2LCAi
RmFpbGVkIHRvIHVucHJlcGFyZSBwYW5lbDogJWRcbiIsCi0JCQkgICAgICByZXQpOworCQlkZXZf
ZXJyKCZkc2ktPmRldiwgIkZhaWxlZCB0byB1bnByZXBhcmUgcGFuZWw6ICVkXG4iLCByZXQpOwog
CiAJcmV0ID0gZHJtX3BhbmVsX2Rpc2FibGUoJmN0eC0+cGFuZWwpOwogCWlmIChyZXQgPCAwKQot
CQlEUk1fREVWX0VSUk9SKCZkc2ktPmRldiwgIkZhaWxlZCB0byBkaXNhYmxlIHBhbmVsOiAlZFxu
IiwKLQkJCSAgICAgIHJldCk7CisJCWRldl9lcnIoJmRzaS0+ZGV2LCAiRmFpbGVkIHRvIGRpc2Fi
bGUgcGFuZWw6ICVkXG4iLCByZXQpOwogfQogCiBzdGF0aWMgaW50IGtkMzV0MTMzX3JlbW92ZShz
dHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kpCkBAIC0zMjEsOCArMzA5LDcgQEAgc3RhdGljIGlu
dCBrZDM1dDEzM19yZW1vdmUoc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpKQogCiAJcmV0ID0g
bWlwaV9kc2lfZGV0YWNoKGRzaSk7CiAJaWYgKHJldCA8IDApCi0JCURSTV9ERVZfRVJST1IoJmRz
aS0+ZGV2LCAiRmFpbGVkIHRvIGRldGFjaCBmcm9tIERTSSBob3N0OiAlZFxuIiwKLQkJCSAgICAg
IHJldCk7CisJCWRldl9lcnIoJmRzaS0+ZGV2LCAiRmFpbGVkIHRvIGRldGFjaCBmcm9tIERTSSBo
b3N0OiAlZFxuIiwgcmV0KTsKIAogCWRybV9wYW5lbF9yZW1vdmUoJmN0eC0+cGFuZWwpOwogCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvcGFuZWwtZmVpeGluLWsxMDEtaW0yYmEw
Mi5jIGIvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLWZlaXhpbi1rMTAxLWltMmJhMDIuYwpp
bmRleCAwYjdlODJlNWJhNGUuLjJhNjAyYWVlNjFjMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL3BhbmVsL3BhbmVsLWZlaXhpbi1rMTAxLWltMmJhMDIuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vcGFuZWwvcGFuZWwtZmVpeGluLWsxMDEtaW0yYmEwMi5jCkBAIC0xMyw3ICsxMyw2IEBACiAj
aW5jbHVkZSA8ZHJtL2RybV9taXBpX2RzaS5oPgogI2luY2x1ZGUgPGRybS9kcm1fbW9kZXMuaD4K
ICNpbmNsdWRlIDxkcm0vZHJtX3BhbmVsLmg+Ci0jaW5jbHVkZSA8ZHJtL2RybV9wcmludC5oPgog
CiAjZGVmaW5lIEsxMDFfSU0yQkEwMl9JTklUX0NNRF9MRU4JMgogCkBAIC0zNzQsMTMgKzM3Mywx
MSBAQCBzdGF0aWMgaW50IGsxMDFfaW0yYmEwMl91bnByZXBhcmUoc3RydWN0IGRybV9wYW5lbCAq
cGFuZWwpCiAKIAlyZXQgPSBtaXBpX2RzaV9kY3Nfc2V0X2Rpc3BsYXlfb2ZmKGN0eC0+ZHNpKTsK
IAlpZiAocmV0IDwgMCkKLQkJRFJNX0RFVl9FUlJPUihwYW5lbC0+ZGV2LCAiZmFpbGVkIHRvIHNl
dCBkaXNwbGF5IG9mZjogJWRcbiIsCi0JCQkgICAgICByZXQpOworCQlkZXZfZXJyKHBhbmVsLT5k
ZXYsICJmYWlsZWQgdG8gc2V0IGRpc3BsYXkgb2ZmOiAlZFxuIiwgcmV0KTsKIAogCXJldCA9IG1p
cGlfZHNpX2Rjc19lbnRlcl9zbGVlcF9tb2RlKGN0eC0+ZHNpKTsKIAlpZiAocmV0IDwgMCkKLQkJ
RFJNX0RFVl9FUlJPUihwYW5lbC0+ZGV2LCAiZmFpbGVkIHRvIGVudGVyIHNsZWVwIG1vZGU6ICVk
XG4iLAotCQkJICAgICAgcmV0KTsKKwkJZGV2X2VycihwYW5lbC0+ZGV2LCAiZmFpbGVkIHRvIGVu
dGVyIHNsZWVwIG1vZGU6ICVkXG4iLCByZXQpOwogCiAJbXNsZWVwKDIwMCk7CiAKQEAgLTQxNiwx
MCArNDEzLDEwIEBAIHN0YXRpYyBpbnQgazEwMV9pbTJiYTAyX2dldF9tb2RlcyhzdHJ1Y3QgZHJt
X3BhbmVsICpwYW5lbCwKIAogCW1vZGUgPSBkcm1fbW9kZV9kdXBsaWNhdGUoY29ubmVjdG9yLT5k
ZXYsICZrMTAxX2ltMmJhMDJfZGVmYXVsdF9tb2RlKTsKIAlpZiAoIW1vZGUpIHsKLQkJRFJNX0RF
Vl9FUlJPUigmY3R4LT5kc2ktPmRldiwgImZhaWxlZCB0byBhZGQgbW9kZSAldXgldXhAJXVcbiIs
Ci0JCQkgICAgICBrMTAxX2ltMmJhMDJfZGVmYXVsdF9tb2RlLmhkaXNwbGF5LAotCQkJICAgICAg
azEwMV9pbTJiYTAyX2RlZmF1bHRfbW9kZS52ZGlzcGxheSwKLQkJCSAgICAgIGRybV9tb2RlX3Zy
ZWZyZXNoKCZrMTAxX2ltMmJhMDJfZGVmYXVsdF9tb2RlKSk7CisJCWRldl9lcnIoJmN0eC0+ZHNp
LT5kZXYsICJmYWlsZWQgdG8gYWRkIG1vZGUgJXV4JXVAJXVcbiIsCisJCQlrMTAxX2ltMmJhMDJf
ZGVmYXVsdF9tb2RlLmhkaXNwbGF5LAorCQkJazEwMV9pbTJiYTAyX2RlZmF1bHRfbW9kZS52ZGlz
cGxheSwKKwkJCWRybV9tb2RlX3ZyZWZyZXNoKCZrMTAxX2ltMmJhMDJfZGVmYXVsdF9tb2RlKSk7
CiAJCXJldHVybiAtRU5PTUVNOwogCX0KIApAQCAtNDYwLDEzICs0NTcsMTMgQEAgc3RhdGljIGlu
dCBrMTAxX2ltMmJhMDJfZHNpX3Byb2JlKHN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSkKIAly
ZXQgPSBkZXZtX3JlZ3VsYXRvcl9idWxrX2dldCgmZHNpLT5kZXYsIEFSUkFZX1NJWkUoY3R4LT5z
dXBwbGllcyksCiAJCQkJICAgICAgY3R4LT5zdXBwbGllcyk7CiAJaWYgKHJldCA8IDApIHsKLQkJ
RFJNX0RFVl9FUlJPUigmZHNpLT5kZXYsICJDb3VsZG4ndCBnZXQgcmVndWxhdG9yc1xuIik7CisJ
CWRldl9lcnIoJmRzaS0+ZGV2LCAiQ291bGRuJ3QgZ2V0IHJlZ3VsYXRvcnNcbiIpOwogCQlyZXR1
cm4gcmV0OwogCX0KIAogCWN0eC0+cmVzZXQgPSBkZXZtX2dwaW9kX2dldCgmZHNpLT5kZXYsICJy
ZXNldCIsIEdQSU9EX09VVF9MT1cpOwogCWlmIChJU19FUlIoY3R4LT5yZXNldCkpIHsKLQkJRFJN
X0RFVl9FUlJPUigmZHNpLT5kZXYsICJDb3VsZG4ndCBnZXQgb3VyIHJlc2V0IEdQSU9cbiIpOwor
CQlkZXZfZXJyKCZkc2ktPmRldiwgIkNvdWxkbid0IGdldCBvdXIgcmVzZXQgR1BJT1xuIik7CiAJ
CXJldHVybiBQVFJfRVJSKGN0eC0+cmVzZXQpOwogCX0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL3BhbmVsL3BhbmVsLWZlaXlhbmctZnkwNzAyNGRpMjZhMzBkLmMgYi9kcml2ZXJzL2dw
dS9kcm0vcGFuZWwvcGFuZWwtZmVpeWFuZy1meTA3MDI0ZGkyNmEzMGQuYwppbmRleCBmOWVkZWU2
OWZlYTQuLjU4MTY2MWI1MDZmOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3Bh
bmVsLWZlaXlhbmctZnkwNzAyNGRpMjZhMzBkLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmVs
L3BhbmVsLWZlaXlhbmctZnkwNzAyNGRpMjZhMzBkLmMKQEAgLTcsNyArNyw2IEBACiAjaW5jbHVk
ZSA8ZHJtL2RybV9taXBpX2RzaS5oPgogI2luY2x1ZGUgPGRybS9kcm1fbW9kZXMuaD4KICNpbmNs
dWRlIDxkcm0vZHJtX3BhbmVsLmg+Ci0jaW5jbHVkZSA8ZHJtL2RybV9wcmludC5oPgogCiAjaW5j
bHVkZSA8bGludXgvZ3Bpby9jb25zdW1lci5oPgogI2luY2x1ZGUgPGxpbnV4L2RlbGF5Lmg+CkBA
IC0xMTgsMTMgKzExNywxMSBAQCBzdGF0aWMgaW50IGZlaXlhbmdfdW5wcmVwYXJlKHN0cnVjdCBk
cm1fcGFuZWwgKnBhbmVsKQogCiAJcmV0ID0gbWlwaV9kc2lfZGNzX3NldF9kaXNwbGF5X29mZihj
dHgtPmRzaSk7CiAJaWYgKHJldCA8IDApCi0JCURSTV9ERVZfRVJST1IocGFuZWwtPmRldiwgImZh
aWxlZCB0byBzZXQgZGlzcGxheSBvZmY6ICVkXG4iLAotCQkJICAgICAgcmV0KTsKKwkJZGV2X2Vy
cihwYW5lbC0+ZGV2LCAiZmFpbGVkIHRvIHNldCBkaXNwbGF5IG9mZjogJWRcbiIsIHJldCk7CiAK
IAlyZXQgPSBtaXBpX2RzaV9kY3NfZW50ZXJfc2xlZXBfbW9kZShjdHgtPmRzaSk7CiAJaWYgKHJl
dCA8IDApCi0JCURSTV9ERVZfRVJST1IocGFuZWwtPmRldiwgImZhaWxlZCB0byBlbnRlciBzbGVl
cCBtb2RlOiAlZFxuIiwKLQkJCSAgICAgIHJldCk7CisJCWRldl9lcnIocGFuZWwtPmRldiwgImZh
aWxlZCB0byBlbnRlciBzbGVlcCBtb2RlOiAlZFxuIiwgcmV0KTsKIAogCS8qIFQxMyAoYmFja2xp
Z2h0IGZhbGwgKyB2aWRlbyAmIGxvZ2ljIHNpZ25hbCBmYWxsKSBUMTMgPj0gMjAwbXMgKi8KIAlt
c2xlZXAoMjAwKTsKQEAgLTE2NSwxMCArMTYyLDEwIEBAIHN0YXRpYyBpbnQgZmVpeWFuZ19nZXRf
bW9kZXMoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwsCiAKIAltb2RlID0gZHJtX21vZGVfZHVwbGlj
YXRlKGNvbm5lY3Rvci0+ZGV2LCAmZmVpeWFuZ19kZWZhdWx0X21vZGUpOwogCWlmICghbW9kZSkg
ewotCQlEUk1fREVWX0VSUk9SKCZjdHgtPmRzaS0+ZGV2LCAiZmFpbGVkIHRvIGFkZCBtb2RlICV1
eCV1eEAldVxuIiwKLQkJCSAgICAgIGZlaXlhbmdfZGVmYXVsdF9tb2RlLmhkaXNwbGF5LAotCQkJ
ICAgICAgZmVpeWFuZ19kZWZhdWx0X21vZGUudmRpc3BsYXksCi0JCQkgICAgICBkcm1fbW9kZV92
cmVmcmVzaCgmZmVpeWFuZ19kZWZhdWx0X21vZGUpKTsKKwkJZGV2X2VycigmY3R4LT5kc2ktPmRl
diwgImZhaWxlZCB0byBhZGQgbW9kZSAldXgldUAldVxuIiwKKwkJCWZlaXlhbmdfZGVmYXVsdF9t
b2RlLmhkaXNwbGF5LAorCQkJZmVpeWFuZ19kZWZhdWx0X21vZGUudmRpc3BsYXksCisJCQlkcm1f
bW9kZV92cmVmcmVzaCgmZmVpeWFuZ19kZWZhdWx0X21vZGUpKTsKIAkJcmV0dXJuIC1FTk9NRU07
CiAJfQogCkBAIC0yMDQsMTkgKzIwMSwxOSBAQCBzdGF0aWMgaW50IGZlaXlhbmdfZHNpX3Byb2Jl
KHN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSkKIAogCWN0eC0+ZHZkZCA9IGRldm1fcmVndWxh
dG9yX2dldCgmZHNpLT5kZXYsICJkdmRkIik7CiAJaWYgKElTX0VSUihjdHgtPmR2ZGQpKSB7Ci0J
CURSTV9ERVZfRVJST1IoJmRzaS0+ZGV2LCAiQ291bGRuJ3QgZ2V0IGR2ZGQgcmVndWxhdG9yXG4i
KTsKKwkJZGV2X2VycigmZHNpLT5kZXYsICJDb3VsZG4ndCBnZXQgZHZkZCByZWd1bGF0b3JcbiIp
OwogCQlyZXR1cm4gUFRSX0VSUihjdHgtPmR2ZGQpOwogCX0KIAogCWN0eC0+YXZkZCA9IGRldm1f
cmVndWxhdG9yX2dldCgmZHNpLT5kZXYsICJhdmRkIik7CiAJaWYgKElTX0VSUihjdHgtPmF2ZGQp
KSB7Ci0JCURSTV9ERVZfRVJST1IoJmRzaS0+ZGV2LCAiQ291bGRuJ3QgZ2V0IGF2ZGQgcmVndWxh
dG9yXG4iKTsKKwkJZGV2X2VycigmZHNpLT5kZXYsICJDb3VsZG4ndCBnZXQgYXZkZCByZWd1bGF0
b3JcbiIpOwogCQlyZXR1cm4gUFRSX0VSUihjdHgtPmF2ZGQpOwogCX0KIAogCWN0eC0+cmVzZXQg
PSBkZXZtX2dwaW9kX2dldCgmZHNpLT5kZXYsICJyZXNldCIsIEdQSU9EX09VVF9MT1cpOwogCWlm
IChJU19FUlIoY3R4LT5yZXNldCkpIHsKLQkJRFJNX0RFVl9FUlJPUigmZHNpLT5kZXYsICJDb3Vs
ZG4ndCBnZXQgb3VyIHJlc2V0IEdQSU9cbiIpOworCQlkZXZfZXJyKCZkc2ktPmRldiwgIkNvdWxk
bid0IGdldCBvdXIgcmVzZXQgR1BJT1xuIik7CiAJCXJldHVybiBQVFJfRVJSKGN0eC0+cmVzZXQp
OwogCX0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLWlsaXRlay1p
bGk5MzIyLmMgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvcGFuZWwtaWxpdGVrLWlsaTkzMjIuYwpp
bmRleCA5Njg4NDU4OTQ3MjUuLjA3NGUxODU1OWI5ZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL3BhbmVsL3BhbmVsLWlsaXRlay1pbGk5MzIyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3Bh
bmVsL3BhbmVsLWlsaXRlay1pbGk5MzIyLmMKQEAgLTMzLDcgKzMzLDYgQEAKIAogI2luY2x1ZGUg
PGRybS9kcm1fbW9kZXMuaD4KICNpbmNsdWRlIDxkcm0vZHJtX3BhbmVsLmg+Ci0jaW5jbHVkZSA8
ZHJtL2RybV9wcmludC5oPgogCiAjZGVmaW5lIElMSTkzMjJfQ0hJUF9JRAkJCTB4MDAKICNkZWZp
bmUgSUxJOTMyMl9DSElQX0lEX01BR0lDCQkweDk2CkBAIC02ODMsNyArNjgyLDcgQEAgc3RhdGlj
IGludCBpbGk5MzIyX2dldF9tb2RlcyhzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCwKIAkJYnJlYWs7
CiAJfQogCWlmICghbW9kZSkgewotCQlEUk1fRVJST1IoImJhZCBtb2RlIG9yIGZhaWxlZCB0byBh
ZGQgbW9kZVxuIik7CisJCWRldl9lcnIocGFuZWwtPmRldiwgImJhZCBtb2RlIG9yIGZhaWxlZCB0
byBhZGQgbW9kZVxuIik7CiAJCXJldHVybiAtRUlOVkFMOwogCX0KIAlkcm1fbW9kZV9zZXRfbmFt
ZShtb2RlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1pbm5vbHV4
LXAwNzl6Y2EuYyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1pbm5vbHV4LXAwNzl6Y2Eu
YwppbmRleCAxYThlNjljNjQxMjUuLmFlYTMxNjIyNTM5MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL3BhbmVsL3BhbmVsLWlubm9sdXgtcDA3OXpjYS5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9wYW5lbC9wYW5lbC1pbm5vbHV4LXAwNzl6Y2EuYwpAQCAtMTcsNyArMTcsNiBAQAogI2luY2x1
ZGUgPGRybS9kcm1fbWlwaV9kc2kuaD4KICNpbmNsdWRlIDxkcm0vZHJtX21vZGVzLmg+CiAjaW5j
bHVkZSA8ZHJtL2RybV9wYW5lbC5oPgotI2luY2x1ZGUgPGRybS9kcm1fcHJpbnQuaD4KIAogc3Ry
dWN0IHBhbmVsX2luaXRfY21kIHsKIAlzaXplX3QgbGVuOwpAQCAtODUsMTMgKzg0LDExIEBAIHN0
YXRpYyBpbnQgaW5ub2x1eF9wYW5lbF91bnByZXBhcmUoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwp
CiAKIAllcnIgPSBtaXBpX2RzaV9kY3Nfc2V0X2Rpc3BsYXlfb2ZmKGlubm9sdXgtPmxpbmspOwog
CWlmIChlcnIgPCAwKQotCQlEUk1fREVWX0VSUk9SKHBhbmVsLT5kZXYsICJmYWlsZWQgdG8gc2V0
IGRpc3BsYXkgb2ZmOiAlZFxuIiwKLQkJCSAgICAgIGVycik7CisJCWRldl9lcnIocGFuZWwtPmRl
diwgImZhaWxlZCB0byBzZXQgZGlzcGxheSBvZmY6ICVkXG4iLCBlcnIpOwogCiAJZXJyID0gbWlw
aV9kc2lfZGNzX2VudGVyX3NsZWVwX21vZGUoaW5ub2x1eC0+bGluayk7CiAJaWYgKGVyciA8IDAp
IHsKLQkJRFJNX0RFVl9FUlJPUihwYW5lbC0+ZGV2LCAiZmFpbGVkIHRvIGVudGVyIHNsZWVwIG1v
ZGU6ICVkXG4iLAotCQkJICAgICAgZXJyKTsKKwkJZGV2X2VycihwYW5lbC0+ZGV2LCAiZmFpbGVk
IHRvIGVudGVyIHNsZWVwIG1vZGU6ICVkXG4iLCBlcnIpOwogCQlyZXR1cm4gZXJyOwogCX0KIApA
QCAtMTQ3LDggKzE0NCw3IEBAIHN0YXRpYyBpbnQgaW5ub2x1eF9wYW5lbF9wcmVwYXJlKHN0cnVj
dCBkcm1fcGFuZWwgKnBhbmVsKQogCQkJZXJyID0gbWlwaV9kc2lfZ2VuZXJpY193cml0ZShpbm5v
bHV4LT5saW5rLCBjbWQtPmRhdGEsCiAJCQkJCQkgICAgIGNtZC0+bGVuKTsKIAkJCWlmIChlcnIg
PCAwKSB7Ci0JCQkJZGV2X2VycihwYW5lbC0+ZGV2LAotCQkJCQkiZmFpbGVkIHRvIHdyaXRlIGNv
bW1hbmQgJXVcbiIsIGkpOworCQkJCWRldl9lcnIocGFuZWwtPmRldiwgImZhaWxlZCB0byB3cml0
ZSBjb21tYW5kICV1XG4iLCBpKTsKIAkJCQlnb3RvIHBvd2Vyb2ZmOwogCQkJfQogCkBAIC0xNTks
OCArMTU1LDcgQEAgc3RhdGljIGludCBpbm5vbHV4X3BhbmVsX3ByZXBhcmUoc3RydWN0IGRybV9w
YW5lbCAqcGFuZWwpCiAJCQkgKi8KIAkJCWVyciA9IG1pcGlfZHNpX2Rjc19ub3AoaW5ub2x1eC0+
bGluayk7CiAJCQlpZiAoZXJyIDwgMCkgewotCQkJCWRldl9lcnIocGFuZWwtPmRldiwKLQkJCQkJ
ImZhaWxlZCB0byBzZW5kIERDUyBub3A6ICVkXG4iLCBlcnIpOworCQkJCWRldl9lcnIocGFuZWwt
PmRldiwgImZhaWxlZCB0byBzZW5kIERDUyBub3A6ICVkXG4iLCBlcnIpOwogCQkJCWdvdG8gcG93
ZXJvZmY7CiAJCQl9CiAJCX0KQEAgLTE2OCw4ICsxNjMsNyBAQCBzdGF0aWMgaW50IGlubm9sdXhf
cGFuZWxfcHJlcGFyZShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKIAogCWVyciA9IG1pcGlfZHNp
X2Rjc19leGl0X3NsZWVwX21vZGUoaW5ub2x1eC0+bGluayk7CiAJaWYgKGVyciA8IDApIHsKLQkJ
RFJNX0RFVl9FUlJPUihwYW5lbC0+ZGV2LCAiZmFpbGVkIHRvIGV4aXQgc2xlZXAgbW9kZTogJWRc
biIsCi0JCQkgICAgICBlcnIpOworCQlkZXZfZXJyKHBhbmVsLT5kZXYsICJmYWlsZWQgdG8gZXhp
dCBzbGVlcCBtb2RlOiAlZFxuIiwgZXJyKTsKIAkJZ290byBwb3dlcm9mZjsKIAl9CiAKQEAgLTE3
OCw4ICsxNzIsNyBAQCBzdGF0aWMgaW50IGlubm9sdXhfcGFuZWxfcHJlcGFyZShzdHJ1Y3QgZHJt
X3BhbmVsICpwYW5lbCkKIAogCWVyciA9IG1pcGlfZHNpX2Rjc19zZXRfZGlzcGxheV9vbihpbm5v
bHV4LT5saW5rKTsKIAlpZiAoZXJyIDwgMCkgewotCQlEUk1fREVWX0VSUk9SKHBhbmVsLT5kZXYs
ICJmYWlsZWQgdG8gc2V0IGRpc3BsYXkgb246ICVkXG4iLAotCQkJICAgICAgZXJyKTsKKwkJZGV2
X2VycihwYW5lbC0+ZGV2LCAiZmFpbGVkIHRvIHNldCBkaXNwbGF5IG9uOiAlZFxuIiwgZXJyKTsK
IAkJZ290byBwb3dlcm9mZjsKIAl9CiAKQEAgLTM5OCw4ICszOTEsOCBAQCBzdGF0aWMgaW50IGlu
bm9sdXhfcGFuZWxfZ2V0X21vZGVzKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsLAogCiAJbW9kZSA9
IGRybV9tb2RlX2R1cGxpY2F0ZShjb25uZWN0b3ItPmRldiwgbSk7CiAJaWYgKCFtb2RlKSB7Ci0J
CURSTV9ERVZfRVJST1IocGFuZWwtPmRldiwgImZhaWxlZCB0byBhZGQgbW9kZSAldXgldXhAJXVc
biIsCi0JCQkgICAgICBtLT5oZGlzcGxheSwgbS0+dmRpc3BsYXksIGRybV9tb2RlX3ZyZWZyZXNo
KG0pKTsKKwkJZGV2X2VycihwYW5lbC0+ZGV2LCAiZmFpbGVkIHRvIGFkZCBtb2RlICV1eCV1QCV1
XG4iLAorCQkJbS0+aGRpc3BsYXksIG0tPnZkaXNwbGF5LCBkcm1fbW9kZV92cmVmcmVzaChtKSk7
CiAJCXJldHVybiAtRU5PTUVNOwogCX0KIApAQCAtNTEyLDE3ICs1MDUsMTUgQEAgc3RhdGljIGlu
dCBpbm5vbHV4X3BhbmVsX3JlbW92ZShzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kpCiAKIAll
cnIgPSBkcm1fcGFuZWxfdW5wcmVwYXJlKCZpbm5vbHV4LT5iYXNlKTsKIAlpZiAoZXJyIDwgMCkK
LQkJRFJNX0RFVl9FUlJPUigmZHNpLT5kZXYsICJmYWlsZWQgdG8gdW5wcmVwYXJlIHBhbmVsOiAl
ZFxuIiwKLQkJCSAgICAgIGVycik7CisJCWRldl9lcnIoJmRzaS0+ZGV2LCAiZmFpbGVkIHRvIHVu
cHJlcGFyZSBwYW5lbDogJWRcbiIsIGVycik7CiAKIAllcnIgPSBkcm1fcGFuZWxfZGlzYWJsZSgm
aW5ub2x1eC0+YmFzZSk7CiAJaWYgKGVyciA8IDApCi0JCURSTV9ERVZfRVJST1IoJmRzaS0+ZGV2
LCAiZmFpbGVkIHRvIGRpc2FibGUgcGFuZWw6ICVkXG4iLCBlcnIpOworCQlkZXZfZXJyKCZkc2kt
PmRldiwgImZhaWxlZCB0byBkaXNhYmxlIHBhbmVsOiAlZFxuIiwgZXJyKTsKIAogCWVyciA9IG1p
cGlfZHNpX2RldGFjaChkc2kpOwogCWlmIChlcnIgPCAwKQotCQlEUk1fREVWX0VSUk9SKCZkc2kt
PmRldiwgImZhaWxlZCB0byBkZXRhY2ggZnJvbSBEU0kgaG9zdDogJWRcbiIsCi0JCQkgICAgICBl
cnIpOworCQlkZXZfZXJyKCZkc2ktPmRldiwgImZhaWxlZCB0byBkZXRhY2ggZnJvbSBEU0kgaG9z
dDogJWRcbiIsIGVycik7CiAKIAlpbm5vbHV4X3BhbmVsX2RlbChpbm5vbHV4KTsKIApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLWtpbmdkaXNwbGF5LWtkMDk3ZDA0LmMg
Yi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvcGFuZWwta2luZ2Rpc3BsYXkta2QwOTdkMDQuYwppbmRl
eCBmNDJkYzJjZWViMDcuLjg2ZTQyMTNlOGJiMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L3BhbmVsL3BhbmVsLWtpbmdkaXNwbGF5LWtkMDk3ZDA0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L3BhbmVsL3BhbmVsLWtpbmdkaXNwbGF5LWtkMDk3ZDA0LmMKQEAgLTE2LDcgKzE2LDYgQEAKICNp
bmNsdWRlIDxkcm0vZHJtX21pcGlfZHNpLmg+CiAjaW5jbHVkZSA8ZHJtL2RybV9tb2Rlcy5oPgog
I2luY2x1ZGUgPGRybS9kcm1fcGFuZWwuaD4KLSNpbmNsdWRlIDxkcm0vZHJtX3ByaW50Lmg+CiAK
IHN0cnVjdCBraW5nZGlzcGxheV9wYW5lbCB7CiAJc3RydWN0IGRybV9wYW5lbCBiYXNlOwpAQCAt
MTkxLDggKzE5MCw3IEBAIHN0YXRpYyBpbnQga2luZ2Rpc3BsYXlfcGFuZWxfZGlzYWJsZShzdHJ1
Y3QgZHJtX3BhbmVsICpwYW5lbCkKIAogCWVyciA9IG1pcGlfZHNpX2Rjc19zZXRfZGlzcGxheV9v
ZmYoa2luZ2Rpc3BsYXktPmxpbmspOwogCWlmIChlcnIgPCAwKQotCQlEUk1fREVWX0VSUk9SKHBh
bmVsLT5kZXYsICJmYWlsZWQgdG8gc2V0IGRpc3BsYXkgb2ZmOiAlZFxuIiwKLQkJCSAgICAgIGVy
cik7CisJCWRldl9lcnIocGFuZWwtPmRldiwgImZhaWxlZCB0byBzZXQgZGlzcGxheSBvZmY6ICVk
XG4iLCBlcnIpOwogCiAJa2luZ2Rpc3BsYXktPmVuYWJsZWQgPSBmYWxzZTsKIApAQCAtMjA5LDgg
KzIwNyw3IEBAIHN0YXRpYyBpbnQga2luZ2Rpc3BsYXlfcGFuZWxfdW5wcmVwYXJlKHN0cnVjdCBk
cm1fcGFuZWwgKnBhbmVsKQogCiAJZXJyID0gbWlwaV9kc2lfZGNzX2VudGVyX3NsZWVwX21vZGUo
a2luZ2Rpc3BsYXktPmxpbmspOwogCWlmIChlcnIgPCAwKSB7Ci0JCURSTV9ERVZfRVJST1IocGFu
ZWwtPmRldiwgImZhaWxlZCB0byBlbnRlciBzbGVlcCBtb2RlOiAlZFxuIiwKLQkJCSAgICAgIGVy
cik7CisJCWRldl9lcnIocGFuZWwtPmRldiwgImZhaWxlZCB0byBlbnRlciBzbGVlcCBtb2RlOiAl
ZFxuIiwgZXJyKTsKIAkJcmV0dXJuIGVycjsKIAl9CiAKQEAgLTI1NSwxNiArMjUyLDE0IEBAIHN0
YXRpYyBpbnQga2luZ2Rpc3BsYXlfcGFuZWxfcHJlcGFyZShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5l
bCkKIAkJZXJyID0gbWlwaV9kc2lfZ2VuZXJpY193cml0ZShraW5nZGlzcGxheS0+bGluaywgJmlu
aXRfY29kZVtpXSwKIAkJCQkJc2l6ZW9mKHN0cnVjdCBraW5nZGlzcGxheV9wYW5lbF9jbWQpKTsK
IAkJaWYgKGVyciA8IDApIHsKLQkJCURSTV9ERVZfRVJST1IocGFuZWwtPmRldiwgImZhaWxlZCB3
cml0ZSBpbml0IGNtZHM6ICVkXG4iLAotCQkJCSAgICAgIGVycik7CisJCQlkZXZfZXJyKHBhbmVs
LT5kZXYsICJmYWlsZWQgd3JpdGUgaW5pdCBjbWRzOiAlZFxuIiwgZXJyKTsKIAkJCWdvdG8gcG93
ZXJvZmY7CiAJCX0KIAl9CiAKIAllcnIgPSBtaXBpX2RzaV9kY3NfZXhpdF9zbGVlcF9tb2RlKGtp
bmdkaXNwbGF5LT5saW5rKTsKIAlpZiAoZXJyIDwgMCkgewotCQlEUk1fREVWX0VSUk9SKHBhbmVs
LT5kZXYsICJmYWlsZWQgdG8gZXhpdCBzbGVlcCBtb2RlOiAlZFxuIiwKLQkJCSAgICAgIGVycik7
CisJCWRldl9lcnIocGFuZWwtPmRldiwgImZhaWxlZCB0byBleGl0IHNsZWVwIG1vZGU6ICVkXG4i
LCBlcnIpOwogCQlnb3RvIHBvd2Vyb2ZmOwogCX0KIApAQCAtMjczLDggKzI2OCw3IEBAIHN0YXRp
YyBpbnQga2luZ2Rpc3BsYXlfcGFuZWxfcHJlcGFyZShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkK
IAogCWVyciA9IG1pcGlfZHNpX2Rjc19zZXRfZGlzcGxheV9vbihraW5nZGlzcGxheS0+bGluayk7
CiAJaWYgKGVyciA8IDApIHsKLQkJRFJNX0RFVl9FUlJPUihwYW5lbC0+ZGV2LCAiZmFpbGVkIHRv
IHNldCBkaXNwbGF5IG9uOiAlZFxuIiwKLQkJCSAgICAgIGVycik7CisJCWRldl9lcnIocGFuZWwt
PmRldiwgImZhaWxlZCB0byBzZXQgZGlzcGxheSBvbjogJWRcbiIsIGVycik7CiAJCWdvdG8gcG93
ZXJvZmY7CiAJfQogCkBAIC0yOTAsOCArMjg0LDcgQEAgc3RhdGljIGludCBraW5nZGlzcGxheV9w
YW5lbF9wcmVwYXJlKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQogCiAJcmVndWxhdG9yX2VyciA9
IHJlZ3VsYXRvcl9kaXNhYmxlKGtpbmdkaXNwbGF5LT5zdXBwbHkpOwogCWlmIChyZWd1bGF0b3Jf
ZXJyKQotCQlEUk1fREVWX0VSUk9SKHBhbmVsLT5kZXYsICJmYWlsZWQgdG8gZGlzYWJsZSByZWd1
bGF0b3I6ICVkXG4iLAotCQkJICAgICAgcmVndWxhdG9yX2Vycik7CisJCWRldl9lcnIocGFuZWwt
PmRldiwgImZhaWxlZCB0byBkaXNhYmxlIHJlZ3VsYXRvcjogJWRcbiIsIHJlZ3VsYXRvcl9lcnIp
OwogCiAJcmV0dXJuIGVycjsKIH0KQEAgLTMyNyw5ICszMjAsOSBAQCBzdGF0aWMgaW50IGtpbmdk
aXNwbGF5X3BhbmVsX2dldF9tb2RlcyhzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCwKIAogCW1vZGUg
PSBkcm1fbW9kZV9kdXBsaWNhdGUoY29ubmVjdG9yLT5kZXYsICZkZWZhdWx0X21vZGUpOwogCWlm
ICghbW9kZSkgewotCQlEUk1fREVWX0VSUk9SKHBhbmVsLT5kZXYsICJmYWlsZWQgdG8gYWRkIG1v
ZGUgJXV4JXV4QCV1XG4iLAotCQkJICAgICAgZGVmYXVsdF9tb2RlLmhkaXNwbGF5LCBkZWZhdWx0
X21vZGUudmRpc3BsYXksCi0JCQkgICAgICBkcm1fbW9kZV92cmVmcmVzaCgmZGVmYXVsdF9tb2Rl
KSk7CisJCWRldl9lcnIocGFuZWwtPmRldiwgImZhaWxlZCB0byBhZGQgbW9kZSAldXgldUAldVxu
IiwKKwkJCWRlZmF1bHRfbW9kZS5oZGlzcGxheSwgZGVmYXVsdF9tb2RlLnZkaXNwbGF5LAorCQkJ
ZHJtX21vZGVfdnJlZnJlc2goJmRlZmF1bHRfbW9kZSkpOwogCQlyZXR1cm4gLUVOT01FTTsKIAl9
CiAKQEAgLTQyMywxNyArNDE2LDE1IEBAIHN0YXRpYyBpbnQga2luZ2Rpc3BsYXlfcGFuZWxfcmVt
b3ZlKHN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSkKIAogCWVyciA9IGRybV9wYW5lbF91bnBy
ZXBhcmUoJmtpbmdkaXNwbGF5LT5iYXNlKTsKIAlpZiAoZXJyIDwgMCkKLQkJRFJNX0RFVl9FUlJP
UigmZHNpLT5kZXYsICJmYWlsZWQgdG8gdW5wcmVwYXJlIHBhbmVsOiAlZFxuIiwKLQkJCSAgICAg
IGVycik7CisJCWRldl9lcnIoJmRzaS0+ZGV2LCAiZmFpbGVkIHRvIHVucHJlcGFyZSBwYW5lbDog
JWRcbiIsIGVycik7CiAKIAllcnIgPSBkcm1fcGFuZWxfZGlzYWJsZSgma2luZ2Rpc3BsYXktPmJh
c2UpOwogCWlmIChlcnIgPCAwKQotCQlEUk1fREVWX0VSUk9SKCZkc2ktPmRldiwgImZhaWxlZCB0
byBkaXNhYmxlIHBhbmVsOiAlZFxuIiwgZXJyKTsKKwkJZGV2X2VycigmZHNpLT5kZXYsICJmYWls
ZWQgdG8gZGlzYWJsZSBwYW5lbDogJWRcbiIsIGVycik7CiAKIAllcnIgPSBtaXBpX2RzaV9kZXRh
Y2goZHNpKTsKIAlpZiAoZXJyIDwgMCkKLQkJRFJNX0RFVl9FUlJPUigmZHNpLT5kZXYsICJmYWls
ZWQgdG8gZGV0YWNoIGZyb20gRFNJIGhvc3Q6ICVkXG4iLAotCQkJICAgICAgZXJyKTsKKwkJZGV2
X2VycigmZHNpLT5kZXYsICJmYWlsZWQgdG8gZGV0YWNoIGZyb20gRFNJIGhvc3Q6ICVkXG4iLCBl
cnIpOwogCiAJa2luZ2Rpc3BsYXlfcGFuZWxfZGVsKGtpbmdkaXNwbGF5KTsKIApkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLW5vdmF0ZWstbnQzNTUxMC5jIGIvZHJpdmVy
cy9ncHUvZHJtL3BhbmVsL3BhbmVsLW5vdmF0ZWstbnQzNTUxMC5jCmluZGV4IDY0YzhjZjJiYWU3
Yy4uYjlhMGU1NmYzM2UyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvcGFuZWwt
bm92YXRlay1udDM1NTEwLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLW5vdmF0
ZWstbnQzNTUxMC5jCkBAIC0zNSw3ICszNSw2IEBACiAjaW5jbHVkZSA8ZHJtL2RybV9taXBpX2Rz
aS5oPgogI2luY2x1ZGUgPGRybS9kcm1fbW9kZXMuaD4KICNpbmNsdWRlIDxkcm0vZHJtX3BhbmVs
Lmg+Ci0jaW5jbHVkZSA8ZHJtL2RybV9wcmludC5oPgogCiAjZGVmaW5lIE1DU19DTURfTUFVQ0NU
UgkJMHhGMCAvKiBNYW51ZmFjdHVyZXIgY29tbWFuZCBlbmFibGUgKi8KICNkZWZpbmUgTUNTX0NN
RF9SRUFEX0lEMQkweERBCkBAIC00MDQsOSArNDAzLDcgQEAgc3RhdGljIGludCBudDM1NTEwX3Nl
bmRfbG9uZyhzdHJ1Y3QgbnQzNTUxMCAqbnQsIHN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSwK
IAkJY2h1bmsgPSAxNTsKIAlyZXQgPSBtaXBpX2RzaV9kY3Nfd3JpdGUoZHNpLCBjbWQsIHNlcXAs
IGNodW5rKTsKIAlpZiAocmV0IDwgMCkgewotCQlEUk1fREVWX0VSUk9SKG50LT5kZXYsCi0JCQkg
ICAgICAiZXJyb3Igc2VuZGluZyBEQ1MgY29tbWFuZCBzZXEgY21kICUwMnhcbiIsCi0JCQkgICAg
ICBjbWQpOworCQlkZXZfZXJyKG50LT5kZXYsICJlcnJvciBzZW5kaW5nIERDUyBjb21tYW5kIHNl
cSBjbWQgJTAyeFxuIiwgY21kKTsKIAkJcmV0dXJuIHJldDsKIAl9CiAJY21kd3JpdHRlbiArPSBj
aHVuazsKQEAgLTQxOCwxNiArNDE1LDEzIEBAIHN0YXRpYyBpbnQgbnQzNTUxMF9zZW5kX2xvbmco
c3RydWN0IG50MzU1MTAgKm50LCBzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2ksCiAJCQljaHVu
ayA9IDE1OwogCQlyZXQgPSBtaXBpX2RzaV9nZW5lcmljX3dyaXRlKGRzaSwgc2VxcCwgY2h1bmsp
OwogCQlpZiAocmV0IDwgMCkgewotCQkJRFJNX0RFVl9FUlJPUihudC0+ZGV2LAotCQkJCSAgICAg
ICJlcnJvciBzZW5kaW5nIGdlbmVyaWMgd3JpdGUgc2VxICUwMnhcbiIsCi0JCQkJICAgICAgY21k
KTsKKwkJCWRldl9lcnIobnQtPmRldiwgImVycm9yIHNlbmRpbmcgZ2VuZXJpYyB3cml0ZSBzZXEg
JTAyeFxuIiwgY21kKTsKIAkJCXJldHVybiByZXQ7CiAJCX0KIAkJY21kd3JpdHRlbiArPSBjaHVu
azsKIAkJc2VxcCArPSBjaHVuazsKIAl9Ci0JRFJNX0RFVl9ERUJVRyhudC0+ZGV2LCAic2VudCBj
b21tYW5kICUwMnggJTAyeCBieXRlc1xuIiwKLQkJICAgICAgY21kLCBjbWRsZW4pOworCWRldl9k
YmcobnQtPmRldiwgInNlbnQgY29tbWFuZCAlMDJ4ICUwMnggYnl0ZXNcbiIsIGNtZCwgY21kbGVu
KTsKIAlyZXR1cm4gMDsKIH0KIApAQCAtNDM5LDE3ICs0MzMsMTcgQEAgc3RhdGljIGludCBudDM1
NTEwX3JlYWRfaWQoc3RydWN0IG50MzU1MTAgKm50KQogCiAJcmV0ID0gbWlwaV9kc2lfZGNzX3Jl
YWQoZHNpLCBNQ1NfQ01EX1JFQURfSUQxLCAmaWQxLCAxKTsKIAlpZiAocmV0IDwgMCkgewotCQlE
Uk1fREVWX0VSUk9SKG50LT5kZXYsICJjb3VsZCBub3QgcmVhZCBNVFAgSUQxXG4iKTsKKwkJZGV2
X2VycihudC0+ZGV2LCAiY291bGQgbm90IHJlYWQgTVRQIElEMVxuIik7CiAJCXJldHVybiByZXQ7
CiAJfQogCXJldCA9IG1pcGlfZHNpX2Rjc19yZWFkKGRzaSwgTUNTX0NNRF9SRUFEX0lEMiwgJmlk
MiwgMSk7CiAJaWYgKHJldCA8IDApIHsKLQkJRFJNX0RFVl9FUlJPUihudC0+ZGV2LCAiY291bGQg
bm90IHJlYWQgTVRQIElEMlxuIik7CisJCWRldl9lcnIobnQtPmRldiwgImNvdWxkIG5vdCByZWFk
IE1UUCBJRDJcbiIpOwogCQlyZXR1cm4gcmV0OwogCX0KIAlyZXQgPSBtaXBpX2RzaV9kY3NfcmVh
ZChkc2ksIE1DU19DTURfUkVBRF9JRDMsICZpZDMsIDEpOwogCWlmIChyZXQgPCAwKSB7Ci0JCURS
TV9ERVZfRVJST1IobnQtPmRldiwgImNvdWxkIG5vdCByZWFkIE1UUCBJRDNcbiIpOworCQlkZXZf
ZXJyKG50LT5kZXYsICJjb3VsZCBub3QgcmVhZCBNVFAgSUQzXG4iKTsKIAkJcmV0dXJuIHJldDsK
IAl9CiAKQEAgLTQ1OCw5ICs0NTIsNyBAQCBzdGF0aWMgaW50IG50MzU1MTBfcmVhZF9pZChzdHJ1
Y3QgbnQzNTUxMCAqbnQpCiAJICogSUQgKGUuZy4gSHlkaXMgMHg1NSksIGRyaXZlciBJRCAoZS5n
LiBOVDM1NTEwIDB4YzApIGFuZAogCSAqIHZlcnNpb24uCiAJICovCi0JRFJNX0RFVl9JTkZPKG50
LT5kZXYsCi0JCSAgICAgIk1UUCBJRCBtYW51ZmFjdHVyZXI6ICUwMnggdmVyc2lvbjogJTAyeCBk
cml2ZXI6ICUwMnhcbiIsCi0JCSAgICAgaWQxLCBpZDIsIGlkMyk7CisJZGV2X2luZm8obnQtPmRl
diwgIk1UUCBJRCBtYW51ZmFjdHVyZXI6ICUwMnggdmVyc2lvbjogJTAyeCBkcml2ZXI6ICUwMnhc
biIsIGlkMSwgaWQyLCBpZDMpOwogCiAJcmV0dXJuIDA7CiB9CkBAIC02NjEsNyArNjUzLDcgQEAg
c3RhdGljIGludCBudDM1NTEwX3NldF9icmlnaHRuZXNzKHN0cnVjdCBiYWNrbGlnaHRfZGV2aWNl
ICpibCkKIAl1OCBicmlnaHRuZXNzID0gYmwtPnByb3BzLmJyaWdodG5lc3M7CiAJaW50IHJldDsK
IAotCURSTV9ERVZfREVCVUcobnQtPmRldiwgInNldCBicmlnaHRuZXNzICVkXG4iLCBicmlnaHRu
ZXNzKTsKKwlkZXZfZGJnKG50LT5kZXYsICJzZXQgYnJpZ2h0bmVzcyAlZFxuIiwgYnJpZ2h0bmVz
cyk7CiAJcmV0ID0gbWlwaV9kc2lfZGNzX3dyaXRlKGRzaSwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlf
QlJJR0hUTkVTUywKIAkJCQkgJmJyaWdodG5lc3MsCiAJCQkJIHNpemVvZihicmlnaHRuZXNzKSk7
CkBAIC03OTYsOCArNzg4LDcgQEAgc3RhdGljIGludCBudDM1NTEwX3VucHJlcGFyZShzdHJ1Y3Qg
ZHJtX3BhbmVsICpwYW5lbCkKIAogCXJldCA9IG1pcGlfZHNpX2Rjc19zZXRfZGlzcGxheV9vZmYo
ZHNpKTsKIAlpZiAocmV0KSB7Ci0JCURSTV9ERVZfRVJST1IobnQtPmRldiwgImZhaWxlZCB0byB0
dXJuIGRpc3BsYXkgb2ZmICglZClcbiIsCi0JCQkgICAgICByZXQpOworCQlkZXZfZXJyKG50LT5k
ZXYsICJmYWlsZWQgdG8gdHVybiBkaXNwbGF5IG9mZiAoJWQpXG4iLCByZXQpOwogCQlyZXR1cm4g
cmV0OwogCX0KIAl1c2xlZXBfcmFuZ2UoMTAwMDAsIDIwMDAwKTsKQEAgLTgwNSw4ICs3OTYsNyBA
QCBzdGF0aWMgaW50IG50MzU1MTBfdW5wcmVwYXJlKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQog
CS8qIEVudGVyIHNsZWVwIG1vZGUgKi8KIAlyZXQgPSBtaXBpX2RzaV9kY3NfZW50ZXJfc2xlZXBf
bW9kZShkc2kpOwogCWlmIChyZXQpIHsKLQkJRFJNX0RFVl9FUlJPUihudC0+ZGV2LCAiZmFpbGVk
IHRvIGVudGVyIHNsZWVwIG1vZGUgKCVkKVxuIiwKLQkJCSAgICAgIHJldCk7CisJCWRldl9lcnIo
bnQtPmRldiwgImZhaWxlZCB0byBlbnRlciBzbGVlcCBtb2RlICglZClcbiIsIHJldCk7CiAJCXJl
dHVybiByZXQ7CiAJfQogCkBAIC04MzMsOCArODIzLDcgQEAgc3RhdGljIGludCBudDM1NTEwX3By
ZXBhcmUoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwpCiAJLyogRXhpdCBzbGVlcCBtb2RlICovCiAJ
cmV0ID0gbWlwaV9kc2lfZGNzX2V4aXRfc2xlZXBfbW9kZShkc2kpOwogCWlmIChyZXQpIHsKLQkJ
RFJNX0RFVl9FUlJPUihudC0+ZGV2LCAiZmFpbGVkIHRvIGV4aXQgc2xlZXAgbW9kZSAoJWQpXG4i
LAotCQkJICAgICAgcmV0KTsKKwkJZGV2X2VycihudC0+ZGV2LCAiZmFpbGVkIHRvIGV4aXQgc2xl
ZXAgbW9kZSAoJWQpXG4iLCByZXQpOwogCQlyZXR1cm4gcmV0OwogCX0KIAkvKiBVcCB0byAxMjAg
bXMgKi8KQEAgLTg0Miw4ICs4MzEsNyBAQCBzdGF0aWMgaW50IG50MzU1MTBfcHJlcGFyZShzdHJ1
Y3QgZHJtX3BhbmVsICpwYW5lbCkKIAogCXJldCA9IG1pcGlfZHNpX2Rjc19zZXRfZGlzcGxheV9v
bihkc2kpOwogCWlmIChyZXQpIHsKLQkJRFJNX0RFVl9FUlJPUihudC0+ZGV2LCAiZmFpbGVkIHRv
IHR1cm4gZGlzcGxheSBvbiAoJWQpXG4iLAotCQkJICAgICAgcmV0KTsKKwkJZGV2X2VycihudC0+
ZGV2LCAiZmFpbGVkIHRvIHR1cm4gZGlzcGxheSBvbiAoJWQpXG4iLCByZXQpOwogCQlyZXR1cm4g
cmV0OwogCX0KIAkvKiBTb21lIDEwIG1zICovCkBAIC04NjQsNyArODUyLDcgQEAgc3RhdGljIGlu
dCBudDM1NTEwX2dldF9tb2RlcyhzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCwKIAlpbmZvLT5oZWln
aHRfbW0gPSBudC0+Y29uZi0+aGVpZ2h0X21tOwogCW1vZGUgPSBkcm1fbW9kZV9kdXBsaWNhdGUo
Y29ubmVjdG9yLT5kZXYsICZudC0+Y29uZi0+bW9kZSk7CiAJaWYgKCFtb2RlKSB7Ci0JCURSTV9F
UlJPUigiYmFkIG1vZGUgb3IgZmFpbGVkIHRvIGFkZCBtb2RlXG4iKTsKKwkJZGV2X2VycihwYW5l
bC0+ZGV2LCAiYmFkIG1vZGUgb3IgZmFpbGVkIHRvIGFkZCBtb2RlXG4iKTsKIAkJcmV0dXJuIC1F
SU5WQUw7CiAJfQogCWRybV9tb2RlX3NldF9uYW1lKG1vZGUpOwpAQCAtOTYzLDcgKzk1MSw3IEBA
IHN0YXRpYyBpbnQgbnQzNTUxMF9wcm9iZShzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kpCiAJ
CWJsID0gZGV2bV9iYWNrbGlnaHRfZGV2aWNlX3JlZ2lzdGVyKGRldiwgIm50MzU1MTAiLCBkZXYs
IG50LAogCQkJCQkJICAgICZudDM1NTEwX2JsX29wcywgTlVMTCk7CiAJCWlmIChJU19FUlIoYmwp
KSB7Ci0JCQlEUk1fREVWX0VSUk9SKGRldiwgImZhaWxlZCB0byByZWdpc3RlciBiYWNrbGlnaHQg
ZGV2aWNlXG4iKTsKKwkJCWRldl9lcnIoZGV2LCAiZmFpbGVkIHRvIHJlZ2lzdGVyIGJhY2tsaWdo
dCBkZXZpY2VcbiIpOwogCQkJcmV0dXJuIFBUUl9FUlIoYmwpOwogCQl9CiAJCWJsLT5wcm9wcy5t
YXhfYnJpZ2h0bmVzcyA9IDI1NTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9w
YW5lbC1vcmlzZXRlY2gtb3RtODAwOWEuYyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1v
cmlzZXRlY2gtb3RtODAwOWEuYwppbmRleCBkOTU2NTIyZjMyZWUuLmI2ZTM3N2FhMTEzMSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLW9yaXNldGVjaC1vdG04MDA5YS5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1vcmlzZXRlY2gtb3RtODAwOWEuYwpA
QCAtMTcsNyArMTcsNiBAQAogI2luY2x1ZGUgPGRybS9kcm1fbWlwaV9kc2kuaD4KICNpbmNsdWRl
IDxkcm0vZHJtX21vZGVzLmg+CiAjaW5jbHVkZSA8ZHJtL2RybV9wYW5lbC5oPgotI2luY2x1ZGUg
PGRybS9kcm1fcHJpbnQuaD4KIAogI2RlZmluZSBPVE04MDA5QV9CQUNLTElHSFRfREVGQVVMVAky
NDAKICNkZWZpbmUgT1RNODAwOUFfQkFDS0xJR0hUX01BWAkJMjU1CkBAIC05Nyw3ICs5Niw3IEBA
IHN0YXRpYyB2b2lkIG90bTgwMDlhX2Rjc193cml0ZV9idWYoc3RydWN0IG90bTgwMDlhICpjdHgs
IGNvbnN0IHZvaWQgKmRhdGEsCiAJc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpID0gdG9fbWlw
aV9kc2lfZGV2aWNlKGN0eC0+ZGV2KTsKIAogCWlmIChtaXBpX2RzaV9kY3Nfd3JpdGVfYnVmZmVy
KGRzaSwgZGF0YSwgbGVuKSA8IDApCi0JCURSTV9XQVJOKCJtaXBpIGRzaSBkY3Mgd3JpdGUgYnVm
ZmVyIGZhaWxlZFxuIik7CisJCWRldl93YXJuKGN0eC0+ZGV2LCAibWlwaSBkc2kgZGNzIHdyaXRl
IGJ1ZmZlciBmYWlsZWRcbiIpOwogfQogCiBzdGF0aWMgdm9pZCBvdG04MDA5YV9kY3Nfd3JpdGVf
YnVmX2hzKHN0cnVjdCBvdG04MDA5YSAqY3R4LCBjb25zdCB2b2lkICpkYXRhLApAQCAtMzEzLDcg
KzMxMiw3IEBAIHN0YXRpYyBpbnQgb3RtODAwOWFfcHJlcGFyZShzdHJ1Y3QgZHJtX3BhbmVsICpw
YW5lbCkKIAogCXJldCA9IHJlZ3VsYXRvcl9lbmFibGUoY3R4LT5zdXBwbHkpOwogCWlmIChyZXQg
PCAwKSB7Ci0JCURSTV9FUlJPUigiZmFpbGVkIHRvIGVuYWJsZSBzdXBwbHk6ICVkXG4iLCByZXQp
OworCQlkZXZfZXJyKHBhbmVsLT5kZXYsICJmYWlsZWQgdG8gZW5hYmxlIHN1cHBseTogJWRcbiIs
IHJldCk7CiAJCXJldHVybiByZXQ7CiAJfQogCkBAIC0zNTUsOSArMzU0LDkgQEAgc3RhdGljIGlu
dCBvdG04MDA5YV9nZXRfbW9kZXMoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwsCiAKIAltb2RlID0g
ZHJtX21vZGVfZHVwbGljYXRlKGNvbm5lY3Rvci0+ZGV2LCAmZGVmYXVsdF9tb2RlKTsKIAlpZiAo
IW1vZGUpIHsKLQkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gYWRkIG1vZGUgJXV4JXV4QCV1XG4iLAot
CQkJICBkZWZhdWx0X21vZGUuaGRpc3BsYXksIGRlZmF1bHRfbW9kZS52ZGlzcGxheSwKLQkJCSAg
ZHJtX21vZGVfdnJlZnJlc2goJmRlZmF1bHRfbW9kZSkpOworCQlkZXZfZXJyKHBhbmVsLT5kZXYs
ICJmYWlsZWQgdG8gYWRkIG1vZGUgJXV4JXVAJXVcbiIsCisJCQlkZWZhdWx0X21vZGUuaGRpc3Bs
YXksIGRlZmF1bHRfbW9kZS52ZGlzcGxheSwKKwkJCWRybV9tb2RlX3ZyZWZyZXNoKCZkZWZhdWx0
X21vZGUpKTsKIAkJcmV0dXJuIC1FTk9NRU07CiAJfQogCkBAIC0zOTAsNyArMzg5LDcgQEAgc3Rh
dGljIGludCBvdG04MDA5YV9iYWNrbGlnaHRfdXBkYXRlX3N0YXR1cyhzdHJ1Y3QgYmFja2xpZ2h0
X2RldmljZSAqYmQpCiAJdTggZGF0YVsyXTsKIAogCWlmICghY3R4LT5wcmVwYXJlZCkgewotCQlE
Uk1fREVCVUcoImxjZCBub3QgcmVhZHkgeWV0IGZvciBzZXR0aW5nIGl0cyBiYWNrbGlnaHQhXG4i
KTsKKwkJZGV2X2RiZygmYmQtPmRldiwgImxjZCBub3QgcmVhZHkgeWV0IGZvciBzZXR0aW5nIGl0
cyBiYWNrbGlnaHQhXG4iKTsKIAkJcmV0dXJuIC1FTlhJTzsKIAl9CiAKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1yb25iby1yYjA3MGQzMC5jIGIvZHJpdmVycy9ncHUv
ZHJtL3BhbmVsL3BhbmVsLXJvbmJvLXJiMDcwZDMwLmMKaW5kZXggZWE3NDk1OGQ3NTQ0Li41MzVj
OGQxY2NhMjEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1yb25iby1y
YjA3MGQzMC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1yb25iby1yYjA3MGQz
MC5jCkBAIC0yMyw3ICsyMyw2IEBACiAjaW5jbHVkZSA8ZHJtL2RybV9taXBpX2RzaS5oPgogI2lu
Y2x1ZGUgPGRybS9kcm1fbW9kZXMuaD4KICNpbmNsdWRlIDxkcm0vZHJtX3BhbmVsLmg+Ci0jaW5j
bHVkZSA8ZHJtL2RybV9wcmludC5oPgogCiBzdHJ1Y3QgcmIwNzBkMzBfcGFuZWwgewogCXN0cnVj
dCBkcm1fcGFuZWwgcGFuZWw7CkBAIC01MCw3ICs0OSw3IEBAIHN0YXRpYyBpbnQgcmIwNzBkMzBf
cGFuZWxfcHJlcGFyZShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKIAogCXJldCA9IHJlZ3VsYXRv
cl9lbmFibGUoY3R4LT5zdXBwbHkpOwogCWlmIChyZXQgPCAwKSB7Ci0JCURSTV9ERVZfRVJST1Io
JmN0eC0+ZHNpLT5kZXYsICJGYWlsZWQgdG8gZW5hYmxlIHN1cHBseTogJWRcbiIsIHJldCk7CisJ
CWRldl9lcnIoJmN0eC0+ZHNpLT5kZXYsICJGYWlsZWQgdG8gZW5hYmxlIHN1cHBseTogJWRcbiIs
IHJldCk7CiAJCXJldHVybiByZXQ7CiAJfQogCkBAIC0xMTcsOSArMTE2LDggQEAgc3RhdGljIGlu
dCByYjA3MGQzMF9wYW5lbF9nZXRfbW9kZXMoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwsCiAKIAlt
b2RlID0gZHJtX21vZGVfZHVwbGljYXRlKGNvbm5lY3Rvci0+ZGV2LCAmZGVmYXVsdF9tb2RlKTsK
IAlpZiAoIW1vZGUpIHsKLQkJRFJNX0RFVl9FUlJPUigmY3R4LT5kc2ktPmRldiwKLQkJCSAgICAg
ICJGYWlsZWQgdG8gYWRkIG1vZGUgIiBEUk1fTU9ERV9GTVQgIlxuIiwKLQkJCSAgICAgIERSTV9N
T0RFX0FSRygmZGVmYXVsdF9tb2RlKSk7CisJCWRldl9lcnIoJmN0eC0+ZHNpLT5kZXYsICJGYWls
ZWQgdG8gYWRkIG1vZGUgIiBEUk1fTU9ERV9GTVQgIlxuIiwKKwkJCURSTV9NT0RFX0FSRygmZGVm
YXVsdF9tb2RlKSk7CiAJCXJldHVybiAtRUlOVkFMOwogCX0KIApAQCAtMTY2LDEzICsxNjQsMTMg
QEAgc3RhdGljIGludCByYjA3MGQzMF9wYW5lbF9kc2lfcHJvYmUoc3RydWN0IG1pcGlfZHNpX2Rl
dmljZSAqZHNpKQogCiAJY3R4LT5ncGlvcy5yZXNldCA9IGRldm1fZ3Bpb2RfZ2V0KCZkc2ktPmRl
diwgInJlc2V0IiwgR1BJT0RfT1VUX0xPVyk7CiAJaWYgKElTX0VSUihjdHgtPmdwaW9zLnJlc2V0
KSkgewotCQlEUk1fREVWX0VSUk9SKCZkc2ktPmRldiwgIkNvdWxkbid0IGdldCBvdXIgcmVzZXQg
R1BJT1xuIik7CisJCWRldl9lcnIoJmRzaS0+ZGV2LCAiQ291bGRuJ3QgZ2V0IG91ciByZXNldCBH
UElPXG4iKTsKIAkJcmV0dXJuIFBUUl9FUlIoY3R4LT5ncGlvcy5yZXNldCk7CiAJfQogCiAJY3R4
LT5ncGlvcy5wb3dlciA9IGRldm1fZ3Bpb2RfZ2V0KCZkc2ktPmRldiwgInBvd2VyIiwgR1BJT0Rf
T1VUX0xPVyk7CiAJaWYgKElTX0VSUihjdHgtPmdwaW9zLnBvd2VyKSkgewotCQlEUk1fREVWX0VS
Uk9SKCZkc2ktPmRldiwgIkNvdWxkbid0IGdldCBvdXIgcG93ZXIgR1BJT1xuIik7CisJCWRldl9l
cnIoJmRzaS0+ZGV2LCAiQ291bGRuJ3QgZ2V0IG91ciBwb3dlciBHUElPXG4iKTsKIAkJcmV0dXJu
IFBUUl9FUlIoY3R4LT5ncGlvcy5wb3dlcik7CiAJfQogCkBAIC0xODIsNyArMTgwLDcgQEAgc3Rh
dGljIGludCByYjA3MGQzMF9wYW5lbF9kc2lfcHJvYmUoc3RydWN0IG1pcGlfZHNpX2RldmljZSAq
ZHNpKQogCSAqLwogCWN0eC0+Z3Bpb3MudXBkbiA9IGRldm1fZ3Bpb2RfZ2V0KCZkc2ktPmRldiwg
InVwZG4iLCBHUElPRF9PVVRfTE9XKTsKIAlpZiAoSVNfRVJSKGN0eC0+Z3Bpb3MudXBkbikpIHsK
LQkJRFJNX0RFVl9FUlJPUigmZHNpLT5kZXYsICJDb3VsZG4ndCBnZXQgb3VyIHVwZG4gR1BJT1xu
Iik7CisJCWRldl9lcnIoJmRzaS0+ZGV2LCAiQ291bGRuJ3QgZ2V0IG91ciB1cGRuIEdQSU9cbiIp
OwogCQlyZXR1cm4gUFRSX0VSUihjdHgtPmdwaW9zLnVwZG4pOwogCX0KIApAQCAtMTkyLDcgKzE5
MCw3IEBAIHN0YXRpYyBpbnQgcmIwNzBkMzBfcGFuZWxfZHNpX3Byb2JlKHN0cnVjdCBtaXBpX2Rz
aV9kZXZpY2UgKmRzaSkKIAkgKi8KIAljdHgtPmdwaW9zLnNobHIgPSBkZXZtX2dwaW9kX2dldCgm
ZHNpLT5kZXYsICJzaGxyIiwgR1BJT0RfT1VUX0xPVyk7CiAJaWYgKElTX0VSUihjdHgtPmdwaW9z
LnNobHIpKSB7Ci0JCURSTV9ERVZfRVJST1IoJmRzaS0+ZGV2LCAiQ291bGRuJ3QgZ2V0IG91ciBz
aGxyIEdQSU9cbiIpOworCQlkZXZfZXJyKCZkc2ktPmRldiwgIkNvdWxkbid0IGdldCBvdXIgc2hs
ciBHUElPXG4iKTsKIAkJcmV0dXJuIFBUUl9FUlIoY3R4LT5ncGlvcy5zaGxyKTsKIAl9CiAKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1zb255LWFjeDQyNGFrcC5jIGIv
ZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLXNvbnktYWN4NDI0YWtwLmMKaW5kZXggNTc1NzVj
NDBmMmFhLi4wNjVlZmFlMjEzZjUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9w
YW5lbC1zb255LWFjeDQyNGFrcC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1z
b255LWFjeDQyNGFrcC5jCkBAIC0yMCw3ICsyMCw2IEBACiAjaW5jbHVkZSA8ZHJtL2RybV9taXBp
X2RzaS5oPgogI2luY2x1ZGUgPGRybS9kcm1fbW9kZXMuaD4KICNpbmNsdWRlIDxkcm0vZHJtX3Bh
bmVsLmg+Ci0jaW5jbHVkZSA8ZHJtL2RybV9wcmludC5oPgogCiAjZGVmaW5lIEFDWDQyNF9EQ1Nf
UkVBRF9JRDEJCTB4REEKICNkZWZpbmUgQUNYNDI0X0RDU19SRUFEX0lEMgkJMHhEQgpAQCAtMTEw
LDEzICsxMDksMTEgQEAgc3RhdGljIGludCBhY3g0MjRha3Bfc2V0X2JyaWdodG5lc3Moc3RydWN0
IGJhY2tsaWdodF9kZXZpY2UgKmJsKQogCQkgICAgICBTQ0FMRV9GQUNUT1JfTlNfRElWX01IWik7
CiAKIAkvKiBTZXQgdXAgUFdNIGR1dHljeWNsZSBPTkUgYnl0ZSAoZGlmZmVycyBmcm9tIHRoZSBz
dGFuZGFyZCkgKi8KLQlEUk1fREVWX0RFQlVHKGFjeC0+ZGV2LCAiY2FsY3VsYXRlZCBkdXR5IGN5
Y2xlICUwMnhcbiIsIHB3bV9yYXRpbyk7CisJZGV2X2RiZyhhY3gtPmRldiwgImNhbGN1bGF0ZWQg
ZHV0eSBjeWNsZSAlMDJ4XG4iLCBwd21fcmF0aW8pOwogCXJldCA9IG1pcGlfZHNpX2Rjc193cml0
ZShkc2ksIE1JUElfRENTX1NFVF9ESVNQTEFZX0JSSUdIVE5FU1MsCiAJCQkJICZwd21fcmF0aW8s
IDEpOwogCWlmIChyZXQgPCAwKSB7Ci0JCURSTV9ERVZfRVJST1IoYWN4LT5kZXYsCi0JCQkgICAg
ICAiZmFpbGVkIHRvIHNldCBkaXNwbGF5IFBXTSByYXRpbyAoJWQpXG4iLAotCQkJICAgICAgcmV0
KTsKKwkJZGV2X2VycihhY3gtPmRldiwgImZhaWxlZCB0byBzZXQgZGlzcGxheSBQV00gcmF0aW8g
KCVkKVxuIiwgcmV0KTsKIAkJcmV0dXJuIHJldDsKIAl9CiAKQEAgLTEzMiw0MCArMTI5LDMwIEBA
IHN0YXRpYyBpbnQgYWN4NDI0YWtwX3NldF9icmlnaHRuZXNzKHN0cnVjdCBiYWNrbGlnaHRfZGV2
aWNlICpibCkKIAlwYXIgPSAweGFhOwogCXJldCA9IG1pcGlfZHNpX2Rjc193cml0ZShkc2ksIDB4
ZjMsICZwYXIsIDEpOwogCWlmIChyZXQgPCAwKSB7Ci0JCURSTV9ERVZfRVJST1IoYWN4LT5kZXYs
Ci0JCQkgICAgICAiZmFpbGVkIHRvIHVubG9jayBDTUQgMiAoJWQpXG4iLAotCQkJICAgICAgcmV0
KTsKKwkJZGV2X2VycihhY3gtPmRldiwgImZhaWxlZCB0byB1bmxvY2sgQ01EIDIgKCVkKVxuIiwg
cmV0KTsKIAkJcmV0dXJuIHJldDsKIAl9CiAJcGFyID0gMHgwMTsKIAlyZXQgPSBtaXBpX2RzaV9k
Y3Nfd3JpdGUoZHNpLCAweDAwLCAmcGFyLCAxKTsKIAlpZiAocmV0IDwgMCkgewotCQlEUk1fREVW
X0VSUk9SKGFjeC0+ZGV2LAotCQkJICAgICAgImZhaWxlZCB0byBlbnRlciBwYWdlIDEgKCVkKVxu
IiwKLQkJCSAgICAgIHJldCk7CisJCWRldl9lcnIoYWN4LT5kZXYsICJmYWlsZWQgdG8gZW50ZXIg
cGFnZSAxICglZClcbiIsIHJldCk7CiAJCXJldHVybiByZXQ7CiAJfQogCXBhciA9IDB4MDE7CiAJ
cmV0ID0gbWlwaV9kc2lfZGNzX3dyaXRlKGRzaSwgMHg3ZCwgJnBhciwgMSk7CiAJaWYgKHJldCA8
IDApIHsKLQkJRFJNX0RFVl9FUlJPUihhY3gtPmRldiwKLQkJCSAgICAgICJmYWlsZWQgdG8gZGlz
YWJsZSBNVFAgcmVsb2FkICglZClcbiIsCi0JCQkgICAgICByZXQpOworCQlkZXZfZXJyKGFjeC0+
ZGV2LCAiZmFpbGVkIHRvIGRpc2FibGUgTVRQIHJlbG9hZCAoJWQpXG4iLCByZXQpOwogCQlyZXR1
cm4gcmV0OwogCX0KIAlyZXQgPSBtaXBpX2RzaV9kY3Nfd3JpdGUoZHNpLCAweDIyLCAmcHdtX2Rp
diwgMSk7CiAJaWYgKHJldCA8IDApIHsKLQkJRFJNX0RFVl9FUlJPUihhY3gtPmRldiwKLQkJCSAg
ICAgICJmYWlsZWQgdG8gc2V0IFBXTSBkaXZpc29yICglZClcbiIsCi0JCQkgICAgICByZXQpOwor
CQlkZXZfZXJyKGFjeC0+ZGV2LCAiZmFpbGVkIHRvIHNldCBQV00gZGl2aXNvciAoJWQpXG4iLCBy
ZXQpOwogCQlyZXR1cm4gcmV0OwogCX0KIAlwYXIgPSAweGFhOwogCXJldCA9IG1pcGlfZHNpX2Rj
c193cml0ZShkc2ksIDB4N2YsICZwYXIsIDEpOwogCWlmIChyZXQgPCAwKSB7Ci0JCURSTV9ERVZf
RVJST1IoYWN4LT5kZXYsCi0JCQkgICAgICAiZmFpbGVkIHRvIGxvY2sgQ01EIDIgKCVkKVxuIiwK
LQkJCSAgICAgIHJldCk7CisJCWRldl9lcnIoYWN4LT5kZXYsICJmYWlsZWQgdG8gbG9jayBDTUQg
MiAoJWQpXG4iLCByZXQpOwogCQlyZXR1cm4gcmV0OwogCX0KIApAQCAtMTc0LDkgKzE2MSw3IEBA
IHN0YXRpYyBpbnQgYWN4NDI0YWtwX3NldF9icmlnaHRuZXNzKHN0cnVjdCBiYWNrbGlnaHRfZGV2
aWNlICpibCkKIAlyZXQgPSBtaXBpX2RzaV9kY3Nfd3JpdGUoZHNpLCBNSVBJX0RDU19XUklURV9D
T05UUk9MX0RJU1BMQVksCiAJCQkJICZwYXIsIDEpOwogCWlmIChyZXQgPCAwKSB7Ci0JCURSTV9E
RVZfRVJST1IoYWN4LT5kZXYsCi0JCQkgICAgICAiZmFpbGVkIHRvIGVuYWJsZSBkaXNwbGF5IGJh
Y2tsaWdodCAoJWQpXG4iLAotCQkJICAgICAgcmV0KTsKKwkJZGV2X2VycihhY3gtPmRldiwgImZh
aWxlZCB0byBlbmFibGUgZGlzcGxheSBiYWNrbGlnaHQgKCVkKVxuIiwgcmV0KTsKIAkJcmV0dXJu
IHJldDsKIAl9CiAKQEAgLTE5NiwyMiArMTgxLDIyIEBAIHN0YXRpYyBpbnQgYWN4NDI0YWtwX3Jl
YWRfaWQoc3RydWN0IGFjeDQyNGFrcCAqYWN4KQogCiAJcmV0ID0gbWlwaV9kc2lfZGNzX3JlYWQo
ZHNpLCBBQ1g0MjRfRENTX1JFQURfSUQxLCAmdmVuZG9yLCAxKTsKIAlpZiAocmV0IDwgMCkgewot
CQlEUk1fREVWX0VSUk9SKGFjeC0+ZGV2LCAiY291bGQgbm90IHZlbmRvciBJRCBieXRlXG4iKTsK
KwkJZGV2X2VycihhY3gtPmRldiwgImNvdWxkIG5vdCB2ZW5kb3IgSUQgYnl0ZVxuIik7CiAJCXJl
dHVybiByZXQ7CiAJfQogCXJldCA9IG1pcGlfZHNpX2Rjc19yZWFkKGRzaSwgQUNYNDI0X0RDU19S
RUFEX0lEMiwgJnZlcnNpb24sIDEpOwogCWlmIChyZXQgPCAwKSB7Ci0JCURSTV9ERVZfRVJST1Io
YWN4LT5kZXYsICJjb3VsZCBub3QgcmVhZCBkZXZpY2UgdmVyc2lvbiBieXRlXG4iKTsKKwkJZGV2
X2VycihhY3gtPmRldiwgImNvdWxkIG5vdCByZWFkIGRldmljZSB2ZXJzaW9uIGJ5dGVcbiIpOwog
CQlyZXR1cm4gcmV0OwogCX0KIAlyZXQgPSBtaXBpX2RzaV9kY3NfcmVhZChkc2ksIEFDWDQyNF9E
Q1NfUkVBRF9JRDMsICZwYW5lbCwgMSk7CiAJaWYgKHJldCA8IDApIHsKLQkJRFJNX0RFVl9FUlJP
UihhY3gtPmRldiwgImNvdWxkIG5vdCByZWFkIHBhbmVsIElEIGJ5dGVcbiIpOworCQlkZXZfZXJy
KGFjeC0+ZGV2LCAiY291bGQgbm90IHJlYWQgcGFuZWwgSUQgYnl0ZVxuIik7CiAJCXJldHVybiBy
ZXQ7CiAJfQogCiAJaWYgKHZlbmRvciA9PSAweDAwKSB7Ci0JCURSTV9ERVZfRVJST1IoYWN4LT5k
ZXYsICJkZXZpY2UgdmVuZG9yIElEIGlzIHplcm9cbiIpOworCQlkZXZfZXJyKGFjeC0+ZGV2LCAi
ZGV2aWNlIHZlbmRvciBJRCBpcyB6ZXJvXG4iKTsKIAkJcmV0dXJuIC1FTk9ERVY7CiAJfQogCkBA
IC0yMjAsMTQgKzIwNSwxMiBAQCBzdGF0aWMgaW50IGFjeDQyNGFrcF9yZWFkX2lkKHN0cnVjdCBh
Y3g0MjRha3AgKmFjeCkKIAljYXNlIERJU1BMQVlfU09OWV9BQ1g0MjRBS1BfSUQxOgogCWNhc2Ug
RElTUExBWV9TT05ZX0FDWDQyNEFLUF9JRDI6CiAJY2FzZSBESVNQTEFZX1NPTllfQUNYNDI0QUtQ
X0lEMzoKLQkJRFJNX0RFVl9JTkZPKGFjeC0+ZGV2LAotCQkJICAgICAiTVRQIHZlbmRvcjogJTAy
eCwgdmVyc2lvbjogJTAyeCwgcGFuZWw6ICUwMnhcbiIsCi0JCQkgICAgIHZlbmRvciwgdmVyc2lv
biwgcGFuZWwpOworCQlkZXZfaW5mbyhhY3gtPmRldiwgIk1UUCB2ZW5kb3I6ICUwMngsIHZlcnNp
b246ICUwMngsIHBhbmVsOiAlMDJ4XG4iLAorCQkJIHZlbmRvciwgdmVyc2lvbiwgcGFuZWwpOwog
CQlicmVhazsKIAlkZWZhdWx0OgotCQlEUk1fREVWX0lORk8oYWN4LT5kZXYsCi0JCQkgICAgICJ1
bmtub3duIHZlbmRvcjogJTAyeCwgdmVyc2lvbjogJTAyeCwgcGFuZWw6ICUwMnhcbiIsCi0JCQkg
ICAgIHZlbmRvciwgdmVyc2lvbiwgcGFuZWwpOworCQlkZXZfaW5mbyhhY3gtPmRldiwgInVua25v
d24gdmVuZG9yOiAlMDJ4LCB2ZXJzaW9uOiAlMDJ4LCBwYW5lbDogJTAyeFxuIiwKKwkJCSB2ZW5k
b3IsIHZlcnNpb24sIHBhbmVsKTsKIAkJYnJlYWs7CiAJfQogCkBAIC0yNDAsNyArMjIzLDcgQEAg
c3RhdGljIGludCBhY3g0MjRha3BfcG93ZXJfb24oc3RydWN0IGFjeDQyNGFrcCAqYWN4KQogCiAJ
cmV0ID0gcmVndWxhdG9yX2VuYWJsZShhY3gtPnN1cHBseSk7CiAJaWYgKHJldCkgewotCQlEUk1f
REVWX0VSUk9SKGFjeC0+ZGV2LCAiZmFpbGVkIHRvIGVuYWJsZSBzdXBwbHkgKCVkKVxuIiwgcmV0
KTsKKwkJZGV2X2VycihhY3gtPmRldiwgImZhaWxlZCB0byBlbmFibGUgc3VwcGx5ICglZClcbiIs
IHJldCk7CiAJCXJldHVybiByZXQ7CiAJfQogCkBAIC0yNzYsNyArMjU5LDcgQEAgc3RhdGljIGlu
dCBhY3g0MjRha3BfcHJlcGFyZShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKIAogCXJldCA9IGFj
eDQyNGFrcF9yZWFkX2lkKGFjeCk7CiAJaWYgKHJldCkgewotCQlEUk1fREVWX0VSUk9SKGFjeC0+
ZGV2LCAiZmFpbGVkIHRvIHJlYWQgcGFuZWwgSUQgKCVkKVxuIiwgcmV0KTsKKwkJZGV2X2Vycihh
Y3gtPmRldiwgImZhaWxlZCB0byByZWFkIHBhbmVsIElEICglZClcbiIsIHJldCk7CiAJCWdvdG8g
ZXJyX3Bvd2VyX29mZjsKIAl9CiAKQEAgLTI4NCw4ICsyNjcsNyBAQCBzdGF0aWMgaW50IGFjeDQy
NGFrcF9wcmVwYXJlKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQogCXJldCA9IG1pcGlfZHNpX2Rj
c19zZXRfdGVhcl9vbihkc2ksCiAJCQkJICAgICAgIE1JUElfRFNJX0RDU19URUFSX01PREVfVkJM
QU5LKTsKIAlpZiAocmV0KSB7Ci0JCURSTV9ERVZfRVJST1IoYWN4LT5kZXYsICJmYWlsZWQgdG8g
ZW5hYmxlIHZibGFuayBURSAoJWQpXG4iLAotCQkJICAgICAgcmV0KTsKKwkJZGV2X2VycihhY3gt
PmRldiwgImZhaWxlZCB0byBlbmFibGUgdmJsYW5rIFRFICglZClcbiIsIHJldCk7CiAJCWdvdG8g
ZXJyX3Bvd2VyX29mZjsKIAl9CiAKQEAgLTMwMiwyMyArMjg0LDIxIEBAIHN0YXRpYyBpbnQgYWN4
NDI0YWtwX3ByZXBhcmUoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwpCiAJcmV0ID0gbWlwaV9kc2lf
ZGNzX3dyaXRlKGRzaSwgQUNYNDI0X0RDU19TRVRfTURESSwKIAkJCQkgJm1kZGksIHNpemVvZiht
ZGRpKSk7CiAJaWYgKHJldCA8IDApIHsKLQkJRFJNX0RFVl9FUlJPUihhY3gtPmRldiwgImZhaWxl
ZCB0byBzZXQgTURESSAoJWQpXG4iLCByZXQpOworCQlkZXZfZXJyKGFjeC0+ZGV2LCAiZmFpbGVk
IHRvIHNldCBNRERJICglZClcbiIsIHJldCk7CiAJCWdvdG8gZXJyX3Bvd2VyX29mZjsKIAl9CiAK
IAkvKiBFeGl0IHNsZWVwIG1vZGUgKi8KIAlyZXQgPSBtaXBpX2RzaV9kY3NfZXhpdF9zbGVlcF9t
b2RlKGRzaSk7CiAJaWYgKHJldCkgewotCQlEUk1fREVWX0VSUk9SKGFjeC0+ZGV2LCAiZmFpbGVk
IHRvIGV4aXQgc2xlZXAgbW9kZSAoJWQpXG4iLAotCQkJICAgICAgcmV0KTsKKwkJZGV2X2Vycihh
Y3gtPmRldiwgImZhaWxlZCB0byBleGl0IHNsZWVwIG1vZGUgKCVkKVxuIiwgcmV0KTsKIAkJZ290
byBlcnJfcG93ZXJfb2ZmOwogCX0KIAltc2xlZXAoMTQwKTsKIAogCXJldCA9IG1pcGlfZHNpX2Rj
c19zZXRfZGlzcGxheV9vbihkc2kpOwogCWlmIChyZXQpIHsKLQkJRFJNX0RFVl9FUlJPUihhY3gt
PmRldiwgImZhaWxlZCB0byB0dXJuIGRpc3BsYXkgb24gKCVkKVxuIiwKLQkJCSAgICAgIHJldCk7
CisJCWRldl9lcnIoYWN4LT5kZXYsICJmYWlsZWQgdG8gdHVybiBkaXNwbGF5IG9uICglZClcbiIs
IHJldCk7CiAJCWdvdG8gZXJyX3Bvd2VyX29mZjsKIAl9CiAJaWYgKGFjeC0+dmlkZW9fbW9kZSkg
ewpAQCAtMzUxLDI0ICszMzEsMjAgQEAgc3RhdGljIGludCBhY3g0MjRha3BfdW5wcmVwYXJlKHN0
cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQogCXJldCA9IG1pcGlfZHNpX2Rjc193cml0ZShkc2ksIE1J
UElfRENTX1dSSVRFX0NPTlRST0xfRElTUExBWSwKIAkJCQkgJnBhciwgMSk7CiAJaWYgKHJldCkg
ewotCQlEUk1fREVWX0VSUk9SKGFjeC0+ZGV2LAotCQkJICAgICAgImZhaWxlZCB0byBkaXNhYmxl
IGRpc3BsYXkgYmFja2xpZ2h0ICglZClcbiIsCi0JCQkgICAgICByZXQpOworCQlkZXZfZXJyKGFj
eC0+ZGV2LCAiZmFpbGVkIHRvIGRpc2FibGUgZGlzcGxheSBiYWNrbGlnaHQgKCVkKVxuIiwgcmV0
KTsKIAkJcmV0dXJuIHJldDsKIAl9CiAKIAlyZXQgPSBtaXBpX2RzaV9kY3Nfc2V0X2Rpc3BsYXlf
b2ZmKGRzaSk7CiAJaWYgKHJldCkgewotCQlEUk1fREVWX0VSUk9SKGFjeC0+ZGV2LCAiZmFpbGVk
IHRvIHR1cm4gZGlzcGxheSBvZmYgKCVkKVxuIiwKLQkJCSAgICAgIHJldCk7CisJCWRldl9lcnIo
YWN4LT5kZXYsICJmYWlsZWQgdG8gdHVybiBkaXNwbGF5IG9mZiAoJWQpXG4iLCByZXQpOwogCQly
ZXR1cm4gcmV0OwogCX0KIAogCS8qIEVudGVyIHNsZWVwIG1vZGUgKi8KIAlyZXQgPSBtaXBpX2Rz
aV9kY3NfZW50ZXJfc2xlZXBfbW9kZShkc2kpOwogCWlmIChyZXQpIHsKLQkJRFJNX0RFVl9FUlJP
UihhY3gtPmRldiwgImZhaWxlZCB0byBlbnRlciBzbGVlcCBtb2RlICglZClcbiIsCi0JCQkgICAg
ICByZXQpOworCQlkZXZfZXJyKGFjeC0+ZGV2LCAiZmFpbGVkIHRvIGVudGVyIHNsZWVwIG1vZGUg
KCVkKVxuIiwgcmV0KTsKIAkJcmV0dXJuIHJldDsKIAl9CiAJbXNsZWVwKDg1KTsKQEAgLTQxOCw3
ICszOTQsNyBAQCBzdGF0aWMgaW50IGFjeDQyNGFrcF9nZXRfbW9kZXMoc3RydWN0IGRybV9wYW5l
bCAqcGFuZWwsCiAJCW1vZGUgPSBkcm1fbW9kZV9kdXBsaWNhdGUoY29ubmVjdG9yLT5kZXYsCiAJ
CQkJCSAgJnNvbnlfYWN4NDI0YWtwX2NtZF9tb2RlKTsKIAlpZiAoIW1vZGUpIHsKLQkJRFJNX0VS
Uk9SKCJiYWQgbW9kZSBvciBmYWlsZWQgdG8gYWRkIG1vZGVcbiIpOworCQlkZXZfZXJyKHBhbmVs
LT5kZXYsICJiYWQgbW9kZSBvciBmYWlsZWQgdG8gYWRkIG1vZGVcbiIpOwogCQlyZXR1cm4gLUVJ
TlZBTDsKIAl9CiAJZHJtX21vZGVfc2V0X25hbWUobW9kZSk7CkBAIC00ODYsOCArNDYyLDcgQEAg
c3RhdGljIGludCBhY3g0MjRha3BfcHJvYmUoc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpKQog
CWlmIChJU19FUlIoYWN4LT5yZXNldF9ncGlvKSkgewogCQlyZXQgPSBQVFJfRVJSKGFjeC0+cmVz
ZXRfZ3Bpbyk7CiAJCWlmIChyZXQgIT0gLUVQUk9CRV9ERUZFUikKLQkJCURSTV9ERVZfRVJST1Io
ZGV2LCAiZmFpbGVkIHRvIHJlcXVlc3QgR1BJTyAoJWQpXG4iLAotCQkJCSAgICAgIHJldCk7CisJ
CQlkZXZfZXJyKGRldiwgImZhaWxlZCB0byByZXF1ZXN0IEdQSU8gKCVkKVxuIiwgcmV0KTsKIAkJ
cmV0dXJuIHJldDsKIAl9CiAKQEAgLTQ5Nyw3ICs0NzIsNyBAQCBzdGF0aWMgaW50IGFjeDQyNGFr
cF9wcm9iZShzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kpCiAJYWN4LT5ibCA9IGRldm1fYmFj
a2xpZ2h0X2RldmljZV9yZWdpc3RlcihkZXYsICJhY3g0MjRha3AiLCBkZXYsIGFjeCwKIAkJCQkJ
CSAmYWN4NDI0YWtwX2JsX29wcywgTlVMTCk7CiAJaWYgKElTX0VSUihhY3gtPmJsKSkgewotCQlE
Uk1fREVWX0VSUk9SKGRldiwgImZhaWxlZCB0byByZWdpc3RlciBiYWNrbGlnaHQgZGV2aWNlXG4i
KTsKKwkJZGV2X2VycihkZXYsICJmYWlsZWQgdG8gcmVnaXN0ZXIgYmFja2xpZ2h0IGRldmljZVxu
Iik7CiAJCXJldHVybiBQVFJfRVJSKGFjeC0+YmwpOwogCX0KIAlhY3gtPmJsLT5wcm9wcy5tYXhf
YnJpZ2h0bmVzcyA9IDEwMjM7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvcGFu
ZWwtdHBvLXRwZzExMC5jIGIvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLXRwby10cGcxMTAu
YwppbmRleCBjZDAwY2ZhNmJhMTQuLmQ1N2VkNzVhOTc3YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL3BhbmVsL3BhbmVsLXRwby10cGcxMTAuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vcGFu
ZWwvcGFuZWwtdHBvLXRwZzExMC5jCkBAIC0xMiw3ICsxMiw2IEBACiAgKi8KICNpbmNsdWRlIDxk
cm0vZHJtX21vZGVzLmg+CiAjaW5jbHVkZSA8ZHJtL2RybV9wYW5lbC5oPgotI2luY2x1ZGUgPGRy
bS9kcm1fcHJpbnQuaD4KIAogI2luY2x1ZGUgPGxpbnV4L2JpdG9wcy5oPgogI2luY2x1ZGUgPGxp
bnV4L2RlbGF5Lmg+CkBAIC0yMzgsNyArMjM3LDcgQEAgc3RhdGljIHU4IHRwZzExMF9yZWFkd3Jp
dGVfcmVnKHN0cnVjdCB0cGcxMTAgKnRwZywgYm9vbCB3cml0ZSwKIAlzcGlfbWVzc2FnZV9hZGRf
dGFpbCgmdFsxXSwgJm0pOwogCXJldCA9IHNwaV9zeW5jKHRwZy0+c3BpLCAmbSk7CiAJaWYgKHJl
dCkgewotCQlEUk1fREVWX0VSUk9SKHRwZy0+ZGV2LCAiU1BJIG1lc3NhZ2UgZXJyb3IgJWRcbiIs
IHJldCk7CisJCWRldl9lcnIodHBnLT5kZXYsICJTUEkgbWVzc2FnZSBlcnJvciAlZFxuIiwgcmV0
KTsKIAkJcmV0dXJuIHJldDsKIAl9CiAJaWYgKHdyaXRlKQpAQCAtMjY1LDE4ICsyNjQsMTggQEAg
c3RhdGljIGludCB0cGcxMTBfc3RhcnR1cChzdHJ1Y3QgdHBnMTEwICp0cGcpCiAJLyogRGUtYXNz
ZXJ0IHRoZSByZXNldCBzaWduYWwgKi8KIAlncGlvZF9zZXRfdmFsdWVfY2Fuc2xlZXAodHBnLT5n
cmVzdGIsIDApOwogCXVzbGVlcF9yYW5nZSgxMDAwLCAyMDAwKTsKLQlEUk1fREVWX0RFQlVHKHRw
Zy0+ZGV2LCAiZGUtYXNzZXJ0ZWQgR1JFU1RCXG4iKTsKKwlkZXZfZGJnKHRwZy0+ZGV2LCAiZGUt
YXNzZXJ0ZWQgR1JFU1RCXG4iKTsKIAogCS8qIFRlc3QgZGlzcGxheSBjb21tdW5pY2F0aW9uICov
CiAJdHBnMTEwX3dyaXRlX3JlZyh0cGcsIFRQRzExMF9URVNULCAweDU1KTsKIAl2YWwgPSB0cGcx
MTBfcmVhZF9yZWcodHBnLCBUUEcxMTBfVEVTVCk7CiAJaWYgKHZhbCAhPSAweDU1KSB7Ci0JCURS
TV9ERVZfRVJST1IodHBnLT5kZXYsICJmYWlsZWQgY29tbXVuaWNhdGlvbiB0ZXN0XG4iKTsKKwkJ
ZGV2X2Vycih0cGctPmRldiwgImZhaWxlZCBjb21tdW5pY2F0aW9uIHRlc3RcbiIpOwogCQlyZXR1
cm4gLUVOT0RFVjsKIAl9CiAKIAl2YWwgPSB0cGcxMTBfcmVhZF9yZWcodHBnLCBUUEcxMTBfQ0hJ
UElEKTsKLQlEUk1fREVWX0lORk8odHBnLT5kZXYsICJUUEcxMTAgY2hpcCBJRDogJWQgdmVyc2lv
bjogJWRcbiIsCisJZGV2X2luZm8odHBnLT5kZXYsICJUUEcxMTAgY2hpcCBJRDogJWQgdmVyc2lv
bjogJWRcbiIsCiAJCSB2YWwgPj4gNCwgdmFsICYgMHgwZik7CiAKIAkvKiBTaG93IGRpc3BsYXkg
cmVzb2x1dGlvbiAqLwpAQCAtMjg0LDI3ICsyODMsMjUgQEAgc3RhdGljIGludCB0cGcxMTBfc3Rh
cnR1cChzdHJ1Y3QgdHBnMTEwICp0cGcpCiAJdmFsICY9IFRQRzExMF9SRVNfTUFTSzsKIAlzd2l0
Y2ggKHZhbCkgewogCWNhc2UgVFBHMTEwX1JFU180MDBYMjQwX0Q6Ci0JCURSTV9ERVZfSU5GTyh0
cGctPmRldiwKLQkJCSAiSU4gNDAweDI0MCBSR0IgLT4gT1VUIDgwMHg0ODAgUkdCIChkdWFsIHNj
YW4pXG4iKTsKKwkJZGV2X2luZm8odHBnLT5kZXYsICJJTiA0MDB4MjQwIFJHQiAtPiBPVVQgODAw
eDQ4MCBSR0IgKGR1YWwgc2NhbilcbiIpOwogCQlicmVhazsKIAljYXNlIFRQRzExMF9SRVNfNDgw
WDI3Ml9EOgotCQlEUk1fREVWX0lORk8odHBnLT5kZXYsCi0JCQkgIklOIDQ4MHgyNzIgUkdCIC0+
IE9VVCA4MDB4NDgwIFJHQiAoZHVhbCBzY2FuKVxuIik7CisJCWRldl9pbmZvKHRwZy0+ZGV2LCAi
SU4gNDgweDI3MiBSR0IgLT4gT1VUIDgwMHg0ODAgUkdCIChkdWFsIHNjYW4pXG4iKTsKIAkJYnJl
YWs7CiAJY2FzZSBUUEcxMTBfUkVTXzQ4MFg2NDA6Ci0JCURSTV9ERVZfSU5GTyh0cGctPmRldiwg
IjQ4MHg2NDAgUkdCXG4iKTsKKwkJZGV2X2luZm8odHBnLT5kZXYsICI0ODB4NjQwIFJHQlxuIik7
CiAJCWJyZWFrOwogCWNhc2UgVFBHMTEwX1JFU180ODBYMjcyOgotCQlEUk1fREVWX0lORk8odHBn
LT5kZXYsICI0ODB4MjcyIFJHQlxuIik7CisJCWRldl9pbmZvKHRwZy0+ZGV2LCAiNDgweDI3MiBS
R0JcbiIpOwogCQlicmVhazsKIAljYXNlIFRQRzExMF9SRVNfNjQwWDQ4MDoKLQkJRFJNX0RFVl9J
TkZPKHRwZy0+ZGV2LCAiNjQweDQ4MCBSR0JcbiIpOworCQlkZXZfaW5mbyh0cGctPmRldiwgIjY0
MHg0ODAgUkdCXG4iKTsKIAkJYnJlYWs7CiAJY2FzZSBUUEcxMTBfUkVTXzgwMFg0ODA6Ci0JCURS
TV9ERVZfSU5GTyh0cGctPmRldiwgIjgwMHg0ODAgUkdCXG4iKTsKKwkJZGV2X2luZm8odHBnLT5k
ZXYsICI4MDB4NDgwIFJHQlxuIik7CiAJCWJyZWFrOwogCWRlZmF1bHQ6Ci0JCURSTV9ERVZfRVJS
T1IodHBnLT5kZXYsICJJTExFR0FMIFJFU09MVVRJT04gMHglMDJ4XG4iLCB2YWwpOworCQlkZXZf
ZXJyKHRwZy0+ZGV2LCAiSUxMRUdBTCBSRVNPTFVUSU9OIDB4JTAyeFxuIiwgdmFsKTsKIAkJYnJl
YWs7CiAJfQogCkBAIC0zMjIsMTMgKzMxOSwxMiBAQCBzdGF0aWMgaW50IHRwZzExMF9zdGFydHVw
KHN0cnVjdCB0cGcxMTAgKnRwZykKIAkJfQogCX0KIAlpZiAoaSA9PSBBUlJBWV9TSVpFKHRwZzEx
MF9tb2RlcykpIHsKLQkJRFJNX0RFVl9FUlJPUih0cGctPmRldiwgInVuc3VwcG9ydGVkIG1vZGUg
KCUwMngpIGRldGVjdGVkXG4iLAotCQkJdmFsKTsKKwkJZGV2X2Vycih0cGctPmRldiwgInVuc3Vw
cG9ydGVkIG1vZGUgKCUwMngpIGRldGVjdGVkXG4iLCB2YWwpOwogCQlyZXR1cm4gLUVOT0RFVjsK
IAl9CiAKIAl2YWwgPSB0cGcxMTBfcmVhZF9yZWcodHBnLCBUUEcxMTBfQ1RSTDIpOwotCURSTV9E
RVZfSU5GTyh0cGctPmRldiwgInJlc29sdXRpb24gYW5kIHN0YW5kYnkgaXMgY29udHJvbGxlZCBi
eSAlc1xuIiwKKwlkZXZfaW5mbyh0cGctPmRldiwgInJlc29sdXRpb24gYW5kIHN0YW5kYnkgaXMg
Y29udHJvbGxlZCBieSAlc1xuIiwKIAkJICh2YWwgJiBUUEcxMTBfQ1RSTDJfUkVTX1BNX0NUUkwp
ID8gInNvZnR3YXJlIiA6ICJoYXJkd2FyZSIpOwogCS8qIFRha2UgY29udHJvbCBvdmVyIHJlc29s
dXRpb24gYW5kIHN0YW5kYnkgKi8KIAl2YWwgfD0gVFBHMTEwX0NUUkwyX1JFU19QTV9DVFJMOwpA
QCAtNDE0LDE1ICs0MTAsMTUgQEAgc3RhdGljIGludCB0cGcxMTBfcHJvYmUoc3RydWN0IHNwaV9k
ZXZpY2UgKnNwaSkKIAkvKiBXZSBnZXQgdGhlIHBoeXNpY2FsIGRpc3BsYXkgZGltZW5zaW9ucyBm
cm9tIHRoZSBEVCAqLwogCXJldCA9IG9mX3Byb3BlcnR5X3JlYWRfdTMyKG5wLCAid2lkdGgtbW0i
LCAmdHBnLT53aWR0aCk7CiAJaWYgKHJldCkKLQkJRFJNX0RFVl9FUlJPUihkZXYsICJubyBwYW5l
bCB3aWR0aCBzcGVjaWZpZWRcbiIpOworCQlkZXZfZXJyKGRldiwgIm5vIHBhbmVsIHdpZHRoIHNw
ZWNpZmllZFxuIik7CiAJcmV0ID0gb2ZfcHJvcGVydHlfcmVhZF91MzIobnAsICJoZWlnaHQtbW0i
LCAmdHBnLT5oZWlnaHQpOwogCWlmIChyZXQpCi0JCURSTV9ERVZfRVJST1IoZGV2LCAibm8gcGFu
ZWwgaGVpZ2h0IHNwZWNpZmllZFxuIik7CisJCWRldl9lcnIoZGV2LCAibm8gcGFuZWwgaGVpZ2h0
IHNwZWNpZmllZFxuIik7CiAKIAkvKiBUaGlzIGFzc2VydHMgdGhlIEdSRVNUQiBzaWduYWwsIHB1
dHRpbmcgdGhlIGRpc3BsYXkgaW50byByZXNldCAqLwogCXRwZy0+Z3Jlc3RiID0gZGV2bV9ncGlv
ZF9nZXQoZGV2LCAiZ3Jlc3RiIiwgR1BJT0RfT1VUX0hJR0gpOwogCWlmIChJU19FUlIodHBnLT5n
cmVzdGIpKSB7Ci0JCURSTV9ERVZfRVJST1IoZGV2LCAibm8gR1JFU1RCIEdQSU9cbiIpOworCQlk
ZXZfZXJyKGRldiwgIm5vIEdSRVNUQiBHUElPXG4iKTsKIAkJcmV0dXJuIC1FTk9ERVY7CiAJfQog
CkBAIC00MzAsNyArNDI2LDcgQEAgc3RhdGljIGludCB0cGcxMTBfcHJvYmUoc3RydWN0IHNwaV9k
ZXZpY2UgKnNwaSkKIAlzcGktPm1vZGUgfD0gU1BJXzNXSVJFX0hJWjsKIAlyZXQgPSBzcGlfc2V0
dXAoc3BpKTsKIAlpZiAocmV0IDwgMCkgewotCQlEUk1fREVWX0VSUk9SKGRldiwgInNwaSBzZXR1
cCBmYWlsZWQuXG4iKTsKKwkJZGV2X2VycihkZXYsICJzcGkgc2V0dXAgZmFpbGVkLlxuIik7CiAJ
CXJldHVybiByZXQ7CiAJfQogCXRwZy0+c3BpID0gc3BpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL3BhbmVsL3BhbmVsLXRydWx5LW50MzU1OTcuYyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5l
bC9wYW5lbC10cnVseS1udDM1NTk3LmMKaW5kZXggOWI5YzE2N2I4ZGM4Li5iMjRiOTJkOTNlYTUg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC10cnVseS1udDM1NTk3LmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLXRydWx5LW50MzU1OTcuYwpAQCAtMTcs
NyArMTcsNiBAQAogI2luY2x1ZGUgPGRybS9kcm1fbWlwaV9kc2kuaD4KICNpbmNsdWRlIDxkcm0v
ZHJtX21vZGVzLmg+CiAjaW5jbHVkZSA8ZHJtL2RybV9wYW5lbC5oPgotI2luY2x1ZGUgPGRybS9k
cm1fcHJpbnQuaD4KIAogc3RhdGljIGNvbnN0IGNoYXIgKiBjb25zdCByZWd1bGF0b3JfbmFtZXNb
XSA9IHsKIAkidmRkYSIsCkBAIC0yMzEsOSArMjMwLDcgQEAgc3RhdGljIGludCB0cnVseV9kY3Nf
d3JpdGUoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwsIHUzMiBjb21tYW5kKQogCWZvciAoaSA9IDA7
IGkgPCBBUlJBWV9TSVpFKGN0eC0+ZHNpKTsgaSsrKSB7CiAJCXJldCA9IG1pcGlfZHNpX2Rjc193
cml0ZShjdHgtPmRzaVtpXSwgY29tbWFuZCwgTlVMTCwgMCk7CiAJCWlmIChyZXQgPCAwKSB7Ci0J
CQlEUk1fREVWX0VSUk9SKGN0eC0+ZGV2LAotCQkJCSJjbWQgMHgleCBmYWlsZWQgZm9yIGRzaSA9
ICVkXG4iLAotCQkJCWNvbW1hbmQsIGkpOworCQkJZGV2X2VycihjdHgtPmRldiwgImNtZCAweCV4
IGZhaWxlZCBmb3IgZHNpID0gJWRcbiIsIGNvbW1hbmQsIGkpOwogCQl9CiAJfQogCkBAIC0yNTAs
OCArMjQ3LDcgQEAgc3RhdGljIGludCB0cnVseV9kY3Nfd3JpdGVfYnVmKHN0cnVjdCBkcm1fcGFu
ZWwgKnBhbmVsLAogCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGN0eC0+ZHNpKTsgaSsrKSB7
CiAJCXJldCA9IG1pcGlfZHNpX2Rjc193cml0ZV9idWZmZXIoY3R4LT5kc2lbaV0sIGJ1Ziwgc2l6
ZSk7CiAJCWlmIChyZXQgPCAwKSB7Ci0JCQlEUk1fREVWX0VSUk9SKGN0eC0+ZGV2LAotCQkJCSJm
YWlsZWQgdG8gdHggY21kIFslZF0sIGVycjogJWRcbiIsIGksIHJldCk7CisJCQlkZXZfZXJyKGN0
eC0+ZGV2LCAiZmFpbGVkIHRvIHR4IGNtZCBbJWRdLCBlcnI6ICVkXG4iLCBpLCByZXQpOwogCQkJ
cmV0dXJuIHJldDsKIAkJfQogCX0KQEAgLTMwMCwxNiArMjk2LDE0IEBAIHN0YXRpYyBpbnQgdHJ1
bHlfbnQzNTU5N19wb3dlcl9vZmYoc3RydWN0IHRydWx5X250MzU1OTcgKmN0eCkKIAkJcmV0ID0g
cmVndWxhdG9yX3NldF9sb2FkKGN0eC0+c3VwcGxpZXNbaV0uY29uc3VtZXIsCiAJCQkJcmVndWxh
dG9yX2Rpc2FibGVfbG9hZHNbaV0pOwogCQlpZiAocmV0KSB7Ci0JCQlEUk1fREVWX0VSUk9SKGN0
eC0+ZGV2LAotCQkJCSJyZWd1bGF0b3Jfc2V0X2xvYWQgZmFpbGVkICVkXG4iLCByZXQpOworCQkJ
ZGV2X2VycihjdHgtPmRldiwgInJlZ3VsYXRvcl9zZXRfbG9hZCBmYWlsZWQgJWRcbiIsIHJldCk7
CiAJCQlyZXR1cm4gcmV0OwogCQl9CiAJfQogCiAJcmV0ID0gcmVndWxhdG9yX2J1bGtfZGlzYWJs
ZShBUlJBWV9TSVpFKGN0eC0+c3VwcGxpZXMpLCBjdHgtPnN1cHBsaWVzKTsKIAlpZiAocmV0KSB7
Ci0JCURSTV9ERVZfRVJST1IoY3R4LT5kZXYsCi0JCQkicmVndWxhdG9yX2J1bGtfZGlzYWJsZSBm
YWlsZWQgJWRcbiIsIHJldCk7CisJCWRldl9lcnIoY3R4LT5kZXYsICJyZWd1bGF0b3JfYnVsa19k
aXNhYmxlIGZhaWxlZCAlZFxuIiwgcmV0KTsKIAl9CiAJcmV0dXJuIHJldDsKIH0KQEAgLTMyNSw4
ICszMTksNyBAQCBzdGF0aWMgaW50IHRydWx5X250MzU1OTdfZGlzYWJsZShzdHJ1Y3QgZHJtX3Bh
bmVsICpwYW5lbCkKIAlpZiAoY3R4LT5iYWNrbGlnaHQpIHsKIAkJcmV0ID0gYmFja2xpZ2h0X2Rp
c2FibGUoY3R4LT5iYWNrbGlnaHQpOwogCQlpZiAocmV0IDwgMCkKLQkJCURSTV9ERVZfRVJST1Io
Y3R4LT5kZXYsICJiYWNrbGlnaHQgZGlzYWJsZSBmYWlsZWQgJWRcbiIsCi0JCQkJcmV0KTsKKwkJ
CWRldl9lcnIoY3R4LT5kZXYsICJiYWNrbGlnaHQgZGlzYWJsZSBmYWlsZWQgJWRcbiIsIHJldCk7
CiAJfQogCiAJY3R4LT5lbmFibGVkID0gZmFsc2U7CkBAIC0zNDYsOSArMzM5LDcgQEAgc3RhdGlj
IGludCB0cnVseV9udDM1NTk3X3VucHJlcGFyZShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKIAog
CXJldCA9IHRydWx5X2Rjc193cml0ZShwYW5lbCwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlfT0ZGKTsK
IAlpZiAocmV0IDwgMCkgewotCQlEUk1fREVWX0VSUk9SKGN0eC0+ZGV2LAotCQkJInNldF9kaXNw
bGF5X29mZiBjbWQgZmFpbGVkIHJldCA9ICVkXG4iLAotCQkJcmV0KTsKKwkJZGV2X2VycihjdHgt
PmRldiwgInNldF9kaXNwbGF5X29mZiBjbWQgZmFpbGVkIHJldCA9ICVkXG4iLCByZXQpOwogCX0K
IAogCS8qIDEyMG1zIGRlbGF5IHJlcXVpcmVkIGhlcmUgYXMgcGVyIERDUyBzcGVjICovCkBAIC0z
NTYsMTMgKzM0NywxMiBAQCBzdGF0aWMgaW50IHRydWx5X250MzU1OTdfdW5wcmVwYXJlKHN0cnVj
dCBkcm1fcGFuZWwgKnBhbmVsKQogCiAJcmV0ID0gdHJ1bHlfZGNzX3dyaXRlKHBhbmVsLCBNSVBJ
X0RDU19FTlRFUl9TTEVFUF9NT0RFKTsKIAlpZiAocmV0IDwgMCkgewotCQlEUk1fREVWX0VSUk9S
KGN0eC0+ZGV2LAotCQkJImVudGVyX3NsZWVwIGNtZCBmYWlsZWQgcmV0ID0gJWRcbiIsIHJldCk7
CisJCWRldl9lcnIoY3R4LT5kZXYsICJlbnRlcl9zbGVlcCBjbWQgZmFpbGVkIHJldCA9ICVkXG4i
LCByZXQpOwogCX0KIAogCXJldCA9IHRydWx5X250MzU1OTdfcG93ZXJfb2ZmKGN0eCk7CiAJaWYg
KHJldCA8IDApCi0JCURSTV9ERVZfRVJST1IoY3R4LT5kZXYsICJwb3dlcl9vZmYgZmFpbGVkIHJl
dCA9ICVkXG4iLCByZXQpOworCQlkZXZfZXJyKGN0eC0+ZGV2LCAicG93ZXJfb2ZmIGZhaWxlZCBy
ZXQgPSAlZFxuIiwgcmV0KTsKIAogCWN0eC0+cHJlcGFyZWQgPSBmYWxzZTsKIAlyZXR1cm4gcmV0
OwpAQCAtMzk2LDE4ICszODYsMTQgQEAgc3RhdGljIGludCB0cnVseV9udDM1NTk3X3ByZXBhcmUo
c3RydWN0IGRybV9wYW5lbCAqcGFuZWwpCiAJCQkJcGFuZWxfb25fY21kc1tpXS5zaXplLAogCQkJ
CQlwYW5lbF9vbl9jbWRzW2ldLmNvbW1hbmRzKTsKIAkJaWYgKHJldCA8IDApIHsKLQkJCURSTV9E
RVZfRVJST1IoY3R4LT5kZXYsCi0JCQkJImNtZCBzZXQgdHggZmFpbGVkIGkgPSAlZCByZXQgPSAl
ZFxuIiwKLQkJCQkJaSwgcmV0KTsKKwkJCWRldl9lcnIoY3R4LT5kZXYsICJjbWQgc2V0IHR4IGZh
aWxlZCBpID0gJWQgcmV0ID0gJWRcbiIsIGksIHJldCk7CiAJCQlnb3RvIHBvd2VyX29mZjsKIAkJ
fQogCX0KIAogCXJldCA9IHRydWx5X2Rjc193cml0ZShwYW5lbCwgTUlQSV9EQ1NfRVhJVF9TTEVF
UF9NT0RFKTsKIAlpZiAocmV0IDwgMCkgewotCQlEUk1fREVWX0VSUk9SKGN0eC0+ZGV2LAotCQkJ
ImV4aXRfc2xlZXBfbW9kZSBjbWQgZmFpbGVkIHJldCA9ICVkXG4iLAotCQkJcmV0KTsKKwkJZGV2
X2VycihjdHgtPmRldiwgImV4aXRfc2xlZXBfbW9kZSBjbWQgZmFpbGVkIHJldCA9ICVkXG4iLCBy
ZXQpOwogCQlnb3RvIHBvd2VyX29mZjsKIAl9CiAKQEAgLTQxNiw4ICs0MDIsNyBAQCBzdGF0aWMg
aW50IHRydWx5X250MzU1OTdfcHJlcGFyZShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKIAogCXJl
dCA9IHRydWx5X2Rjc193cml0ZShwYW5lbCwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlfT04pOwogCWlm
IChyZXQgPCAwKSB7Ci0JCURSTV9ERVZfRVJST1IoY3R4LT5kZXYsCi0JCQkic2V0X2Rpc3BsYXlf
b24gY21kIGZhaWxlZCByZXQgPSAlZFxuIiwgcmV0KTsKKwkJZGV2X2VycihjdHgtPmRldiwgInNl
dF9kaXNwbGF5X29uIGNtZCBmYWlsZWQgcmV0ID0gJWRcbiIsIHJldCk7CiAJCWdvdG8gcG93ZXJf
b2ZmOwogCX0KIApAQCAtNDMwLDcgKzQxNSw3IEBAIHN0YXRpYyBpbnQgdHJ1bHlfbnQzNTU5N19w
cmVwYXJlKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQogCiBwb3dlcl9vZmY6CiAJaWYgKHRydWx5
X250MzU1OTdfcG93ZXJfb2ZmKGN0eCkpCi0JCURSTV9ERVZfRVJST1IoY3R4LT5kZXYsICJwb3dl
cl9vZmYgZmFpbGVkXG4iKTsKKwkJZGV2X2VycihjdHgtPmRldiwgInBvd2VyX29mZiBmYWlsZWRc
biIpOwogCXJldHVybiByZXQ7CiB9CiAKQEAgLTQ0NSw4ICs0MzAsNyBAQCBzdGF0aWMgaW50IHRy
dWx5X250MzU1OTdfZW5hYmxlKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsKQogCWlmIChjdHgtPmJh
Y2tsaWdodCkgewogCQlyZXQgPSBiYWNrbGlnaHRfZW5hYmxlKGN0eC0+YmFja2xpZ2h0KTsKIAkJ
aWYgKHJldCA8IDApCi0JCQlEUk1fREVWX0VSUk9SKGN0eC0+ZGV2LCAiYmFja2xpZ2h0IGVuYWJs
ZSBmYWlsZWQgJWRcbiIsCi0JCQkJCQkgIHJldCk7CisJCQlkZXZfZXJyKGN0eC0+ZGV2LCAiYmFj
a2xpZ2h0IGVuYWJsZSBmYWlsZWQgJWRcbiIsIHJldCk7CiAJfQogCiAJY3R4LT5lbmFibGVkID0g
dHJ1ZTsKQEAgLTQ2NCw4ICs0NDgsNyBAQCBzdGF0aWMgaW50IHRydWx5X250MzU1OTdfZ2V0X21v
ZGVzKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVsLAogCWNvbmZpZyA9IGN0eC0+Y29uZmlnOwogCW1v
ZGUgPSBkcm1fbW9kZV9jcmVhdGUoY29ubmVjdG9yLT5kZXYpOwogCWlmICghbW9kZSkgewotCQlE
Uk1fREVWX0VSUk9SKGN0eC0+ZGV2LAotCQkJImZhaWxlZCB0byBjcmVhdGUgYSBuZXcgZGlzcGxh
eSBtb2RlXG4iKTsKKwkJZGV2X2VycihjdHgtPmRldiwgImZhaWxlZCB0byBjcmVhdGUgYSBuZXcg
ZGlzcGxheSBtb2RlXG4iKTsKIAkJcmV0dXJuIDA7CiAJfQogCkBAIC01MDEsMTUgKzQ4NCwxMyBA
QCBzdGF0aWMgaW50IHRydWx5X250MzU1OTdfcGFuZWxfYWRkKHN0cnVjdCB0cnVseV9udDM1NTk3
ICpjdHgpCiAKIAljdHgtPnJlc2V0X2dwaW8gPSBkZXZtX2dwaW9kX2dldChkZXYsICJyZXNldCIs
IEdQSU9EX09VVF9MT1cpOwogCWlmIChJU19FUlIoY3R4LT5yZXNldF9ncGlvKSkgewotCQlEUk1f
REVWX0VSUk9SKGRldiwgImNhbm5vdCBnZXQgcmVzZXQgZ3BpbyAlbGRcbiIsCi0JCQlQVFJfRVJS
KGN0eC0+cmVzZXRfZ3BpbykpOworCQlkZXZfZXJyKGRldiwgImNhbm5vdCBnZXQgcmVzZXQgZ3Bp
byAlbGRcbiIsIFBUUl9FUlIoY3R4LT5yZXNldF9ncGlvKSk7CiAJCXJldHVybiBQVFJfRVJSKGN0
eC0+cmVzZXRfZ3Bpbyk7CiAJfQogCiAJY3R4LT5tb2RlX2dwaW8gPSBkZXZtX2dwaW9kX2dldChk
ZXYsICJtb2RlIiwgR1BJT0RfT1VUX0xPVyk7CiAJaWYgKElTX0VSUihjdHgtPm1vZGVfZ3Bpbykp
IHsKLQkJRFJNX0RFVl9FUlJPUihkZXYsICJjYW5ub3QgZ2V0IG1vZGUgZ3BpbyAlbGRcbiIsCi0J
CQlQVFJfRVJSKGN0eC0+bW9kZV9ncGlvKSk7CisJCWRldl9lcnIoZGV2LCAiY2Fubm90IGdldCBt
b2RlIGdwaW8gJWxkXG4iLCBQVFJfRVJSKGN0eC0+bW9kZV9ncGlvKSk7CiAJCXJldHVybiBQVFJf
RVJSKGN0eC0+bW9kZV9ncGlvKTsKIAl9CiAKQEAgLTU4NCwyMiArNTY1LDIxIEBAIHN0YXRpYyBp
bnQgdHJ1bHlfbnQzNTU5N19wcm9iZShzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kpCiAKIAlk
c2kxID0gb2ZfZ3JhcGhfZ2V0X3JlbW90ZV9ub2RlKGRzaS0+ZGV2Lm9mX25vZGUsIDEsIC0xKTsK
IAlpZiAoIWRzaTEpIHsKLQkJRFJNX0RFVl9FUlJPUihkZXYsCi0JCQkiZmFpbGVkIHRvIGdldCBy
ZW1vdGUgbm9kZSBmb3IgZHNpMV9kZXZpY2VcbiIpOworCQlkZXZfZXJyKGRldiwgImZhaWxlZCB0
byBnZXQgcmVtb3RlIG5vZGUgZm9yIGRzaTFfZGV2aWNlXG4iKTsKIAkJcmV0dXJuIC1FTk9ERVY7
CiAJfQogCiAJZHNpMV9ob3N0ID0gb2ZfZmluZF9taXBpX2RzaV9ob3N0X2J5X25vZGUoZHNpMSk7
CiAJb2Zfbm9kZV9wdXQoZHNpMSk7CiAJaWYgKCFkc2kxX2hvc3QpIHsKLQkJRFJNX0RFVl9FUlJP
UihkZXYsICJmYWlsZWQgdG8gZmluZCBkc2kgaG9zdFxuIik7CisJCWRldl9lcnIoZGV2LCAiZmFp
bGVkIHRvIGZpbmQgZHNpIGhvc3RcbiIpOwogCQlyZXR1cm4gLUVQUk9CRV9ERUZFUjsKIAl9CiAK
IAkvKiByZWdpc3RlciB0aGUgc2Vjb25kIERTSSBkZXZpY2UgKi8KIAlkc2kxX2RldmljZSA9IG1p
cGlfZHNpX2RldmljZV9yZWdpc3Rlcl9mdWxsKGRzaTFfaG9zdCwgJmluZm8pOwogCWlmIChJU19F
UlIoZHNpMV9kZXZpY2UpKSB7Ci0JCURSTV9ERVZfRVJST1IoZGV2LCAiZmFpbGVkIHRvIGNyZWF0
ZSBkc2kgZGV2aWNlXG4iKTsKKwkJZGV2X2VycihkZXYsICJmYWlsZWQgdG8gY3JlYXRlIGRzaSBk
ZXZpY2VcbiIpOwogCQlyZXR1cm4gUFRSX0VSUihkc2kxX2RldmljZSk7CiAJfQogCkBAIC02MTEs
NyArNTkxLDcgQEAgc3RhdGljIGludCB0cnVseV9udDM1NTk3X3Byb2JlKHN0cnVjdCBtaXBpX2Rz
aV9kZXZpY2UgKmRzaSkKIAogCXJldCA9IHRydWx5X250MzU1OTdfcGFuZWxfYWRkKGN0eCk7CiAJ
aWYgKHJldCkgewotCQlEUk1fREVWX0VSUk9SKGRldiwgImZhaWxlZCB0byBhZGQgcGFuZWxcbiIp
OworCQlkZXZfZXJyKGRldiwgImZhaWxlZCB0byBhZGQgcGFuZWxcbiIpOwogCQlnb3RvIGVycl9w
YW5lbF9hZGQ7CiAJfQogCkBAIC02MjMsOCArNjAzLDcgQEAgc3RhdGljIGludCB0cnVseV9udDM1
NTk3X3Byb2JlKHN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSkKIAkJCU1JUElfRFNJX0NMT0NL
X05PTl9DT05USU5VT1VTOwogCQlyZXQgPSBtaXBpX2RzaV9hdHRhY2goZHNpX2Rldik7CiAJCWlm
IChyZXQgPCAwKSB7Ci0JCQlEUk1fREVWX0VSUk9SKGRldiwKLQkJCQkiZHNpIGF0dGFjaCBmYWls
ZWQgaSA9ICVkXG4iLCBpKTsKKwkJCWRldl9lcnIoZGV2LCAiZHNpIGF0dGFjaCBmYWlsZWQgaSA9
ICVkXG4iLCBpKTsKIAkJCWdvdG8gZXJyX2RzaV9hdHRhY2g7CiAJCX0KIAl9CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvcGFuZWwtdmlzaW9ub3gtcm02OTI5OS5jIGIvZHJpdmVy
cy9ncHUvZHJtL3BhbmVsL3BhbmVsLXZpc2lvbm94LXJtNjkyOTkuYwppbmRleCBhMTI5NzZiNDk3
Y2UuLmViNDM1MDNlYzk3YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVs
LXZpc2lvbm94LXJtNjkyOTkuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvcGFuZWwtdmlz
aW9ub3gtcm02OTI5OS5jCkBAIC0xNCw3ICsxNCw2IEBACiAjaW5jbHVkZSA8ZHJtL2RybV9taXBp
X2RzaS5oPgogI2luY2x1ZGUgPGRybS9kcm1fbW9kZXMuaD4KICNpbmNsdWRlIDxkcm0vZHJtX3Bh
bmVsLmg+Ci0jaW5jbHVkZSA8ZHJtL2RybV9wcmludC5oPgogCiBzdHJ1Y3QgdmlzaW9ub3hfcm02
OTI5OSB7CiAJc3RydWN0IGRybV9wYW5lbCBwYW5lbDsKQEAgLTY5LDE2ICs2OCwxNCBAQCBzdGF0
aWMgaW50IHZpc2lvbm94X3JtNjkyOTlfdW5wcmVwYXJlKHN0cnVjdCBkcm1fcGFuZWwgKnBhbmVs
KQogCiAJcmV0ID0gbWlwaV9kc2lfZGNzX3dyaXRlKGN0eC0+ZHNpLCBNSVBJX0RDU19TRVRfRElT
UExBWV9PRkYsIE5VTEwsIDApOwogCWlmIChyZXQgPCAwKQotCQlEUk1fREVWX0VSUk9SKGN0eC0+
cGFuZWwuZGV2LAotCQkJICAgICAgInNldF9kaXNwbGF5X29mZiBjbWQgZmFpbGVkIHJldCA9ICVk
XG4iLCByZXQpOworCQlkZXZfZXJyKGN0eC0+cGFuZWwuZGV2LCAic2V0X2Rpc3BsYXlfb2ZmIGNt
ZCBmYWlsZWQgcmV0ID0gJWRcbiIsIHJldCk7CiAKIAkvKiAxMjBtcyBkZWxheSByZXF1aXJlZCBo
ZXJlIGFzIHBlciBEQ1Mgc3BlYyAqLwogCW1zbGVlcCgxMjApOwogCiAJcmV0ID0gbWlwaV9kc2lf
ZGNzX3dyaXRlKGN0eC0+ZHNpLCBNSVBJX0RDU19FTlRFUl9TTEVFUF9NT0RFLCBOVUxMLCAwKTsK
IAlpZiAocmV0IDwgMCkgewotCQlEUk1fREVWX0VSUk9SKGN0eC0+cGFuZWwuZGV2LAotCQkJICAg
ICAgImVudGVyX3NsZWVwIGNtZCBmYWlsZWQgcmV0ID0gJWRcbiIsIHJldCk7CisJCWRldl9lcnIo
Y3R4LT5wYW5lbC5kZXYsICJlbnRlcl9zbGVlcCBjbWQgZmFpbGVkIHJldCA9ICVkXG4iLCByZXQp
OwogCX0KIAogCXJldCA9IHZpc2lvbm94X3JtNjkyOTlfcG93ZXJfb2ZmKGN0eCk7CkBAIC0xMDMs
MzYgKzEwMCwzMSBAQCBzdGF0aWMgaW50IHZpc2lvbm94X3JtNjkyOTlfcHJlcGFyZShzdHJ1Y3Qg
ZHJtX3BhbmVsICpwYW5lbCkKIAogCXJldCA9IG1pcGlfZHNpX2Rjc193cml0ZV9idWZmZXIoY3R4
LT5kc2ksICh1OFtdKSB7IDB4ZmUsIDB4MDAgfSwgMik7CiAJaWYgKHJldCA8IDApIHsKLQkJRFJN
X0RFVl9FUlJPUihjdHgtPnBhbmVsLmRldiwKLQkJCSAgICAgICJjbWQgc2V0IHR4IDAgZmFpbGVk
LCByZXQgPSAlZFxuIiwgcmV0KTsKKwkJZGV2X2VycihjdHgtPnBhbmVsLmRldiwgImNtZCBzZXQg
dHggMCBmYWlsZWQsIHJldCA9ICVkXG4iLCByZXQpOwogCQlnb3RvIHBvd2VyX29mZjsKIAl9CiAK
IAlyZXQgPSBtaXBpX2RzaV9kY3Nfd3JpdGVfYnVmZmVyKGN0eC0+ZHNpLCAodThbXSkgeyAweGMy
LCAweDA4IH0sIDIpOwogCWlmIChyZXQgPCAwKSB7Ci0JCURSTV9ERVZfRVJST1IoY3R4LT5wYW5l
bC5kZXYsCi0JCQkgICAgICAiY21kIHNldCB0eCAxIGZhaWxlZCwgcmV0ID0gJWRcbiIsIHJldCk7
CisJCWRldl9lcnIoY3R4LT5wYW5lbC5kZXYsICJjbWQgc2V0IHR4IDEgZmFpbGVkLCByZXQgPSAl
ZFxuIiwgcmV0KTsKIAkJZ290byBwb3dlcl9vZmY7CiAJfQogCiAJcmV0ID0gbWlwaV9kc2lfZGNz
X3dyaXRlX2J1ZmZlcihjdHgtPmRzaSwgKHU4W10pIHsgMHgzNSwgMHgwMCB9LCAyKTsKIAlpZiAo
cmV0IDwgMCkgewotCQlEUk1fREVWX0VSUk9SKGN0eC0+cGFuZWwuZGV2LAotCQkJICAgICAgImNt
ZCBzZXQgdHggMiBmYWlsZWQsIHJldCA9ICVkXG4iLCByZXQpOworCQlkZXZfZXJyKGN0eC0+cGFu
ZWwuZGV2LCAiY21kIHNldCB0eCAyIGZhaWxlZCwgcmV0ID0gJWRcbiIsIHJldCk7CiAJCWdvdG8g
cG93ZXJfb2ZmOwogCX0KIAogCXJldCA9IG1pcGlfZHNpX2Rjc193cml0ZV9idWZmZXIoY3R4LT5k
c2ksICh1OFtdKSB7IDB4NTEsIDB4ZmYgfSwgMik7CiAJaWYgKHJldCA8IDApIHsKLQkJRFJNX0RF
Vl9FUlJPUihjdHgtPnBhbmVsLmRldiwKLQkJCSAgICAgICJjbWQgc2V0IHR4IDMgZmFpbGVkLCBy
ZXQgPSAlZFxuIiwgcmV0KTsKKwkJZGV2X2VycihjdHgtPnBhbmVsLmRldiwgImNtZCBzZXQgdHgg
MyBmYWlsZWQsIHJldCA9ICVkXG4iLCByZXQpOwogCQlnb3RvIHBvd2VyX29mZjsKIAl9CiAKIAly
ZXQgPSBtaXBpX2RzaV9kY3Nfd3JpdGUoY3R4LT5kc2ksIE1JUElfRENTX0VYSVRfU0xFRVBfTU9E
RSwgTlVMTCwgMCk7CiAJaWYgKHJldCA8IDApIHsKLQkJRFJNX0RFVl9FUlJPUihjdHgtPnBhbmVs
LmRldiwKLQkJCSAgICAgICJleGl0X3NsZWVwX21vZGUgY21kIGZhaWxlZCByZXQgPSAlZFxuIiwg
cmV0KTsKKwkJZGV2X2VycihjdHgtPnBhbmVsLmRldiwgImV4aXRfc2xlZXBfbW9kZSBjbWQgZmFp
bGVkIHJldCA9ICVkXG4iLCByZXQpOwogCQlnb3RvIHBvd2VyX29mZjsKIAl9CiAKQEAgLTE0MSw4
ICsxMzMsNyBAQCBzdGF0aWMgaW50IHZpc2lvbm94X3JtNjkyOTlfcHJlcGFyZShzdHJ1Y3QgZHJt
X3BhbmVsICpwYW5lbCkKIAogCXJldCA9IG1pcGlfZHNpX2Rjc193cml0ZShjdHgtPmRzaSwgTUlQ
SV9EQ1NfU0VUX0RJU1BMQVlfT04sIE5VTEwsIDApOwogCWlmIChyZXQgPCAwKSB7Ci0JCURSTV9E
RVZfRVJST1IoY3R4LT5wYW5lbC5kZXYsCi0JCQkgICAgICAic2V0X2Rpc3BsYXlfb24gY21kIGZh
aWxlZCByZXQgPSAlZFxuIiwgcmV0KTsKKwkJZGV2X2VycihjdHgtPnBhbmVsLmRldiwgInNldF9k
aXNwbGF5X29uIGNtZCBmYWlsZWQgcmV0ID0gJWRcbiIsIHJldCk7CiAJCWdvdG8gcG93ZXJfb2Zm
OwogCX0KIApAQCAtMTc5LDggKzE3MCw3IEBAIHN0YXRpYyBpbnQgdmlzaW9ub3hfcm02OTI5OV9n
ZXRfbW9kZXMoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwsCiAKIAltb2RlID0gZHJtX21vZGVfY3Jl
YXRlKGNvbm5lY3Rvci0+ZGV2KTsKIAlpZiAoIW1vZGUpIHsKLQkJRFJNX0RFVl9FUlJPUihjdHgt
PnBhbmVsLmRldiwKLQkJCSAgICAgICJmYWlsZWQgdG8gY3JlYXRlIGEgbmV3IGRpc3BsYXkgbW9k
ZVxuIik7CisJCWRldl9lcnIoY3R4LT5wYW5lbC5kZXYsICJmYWlsZWQgdG8gY3JlYXRlIGEgbmV3
IGRpc3BsYXkgbW9kZVxuIik7CiAJCXJldHVybiAwOwogCX0KIApAQCAtMjI1LDggKzIxNSw3IEBA
IHN0YXRpYyBpbnQgdmlzaW9ub3hfcm02OTI5OV9wcm9iZShzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNl
ICpkc2kpCiAJY3R4LT5yZXNldF9ncGlvID0gZGV2bV9ncGlvZF9nZXQoY3R4LT5wYW5lbC5kZXYs
CiAJCQkJCSAicmVzZXQiLCBHUElPRF9PVVRfTE9XKTsKIAlpZiAoSVNfRVJSKGN0eC0+cmVzZXRf
Z3BpbykpIHsKLQkJRFJNX0RFVl9FUlJPUihkZXYsICJjYW5ub3QgZ2V0IHJlc2V0IGdwaW8gJWxk
XG4iLAotCQkJICAgICAgUFRSX0VSUihjdHgtPnJlc2V0X2dwaW8pKTsKKwkJZGV2X2VycihkZXYs
ICJjYW5ub3QgZ2V0IHJlc2V0IGdwaW8gJWxkXG4iLCBQVFJfRVJSKGN0eC0+cmVzZXRfZ3Bpbykp
OwogCQlyZXR1cm4gUFRSX0VSUihjdHgtPnJlc2V0X2dwaW8pOwogCX0KIApAQCAtMjQyLDIzICsy
MzEsMTkgQEAgc3RhdGljIGludCB2aXNpb25veF9ybTY5Mjk5X3Byb2JlKHN0cnVjdCBtaXBpX2Rz
aV9kZXZpY2UgKmRzaSkKIAkJCSAgTUlQSV9EU0lfQ0xPQ0tfTk9OX0NPTlRJTlVPVVM7CiAJcmV0
ID0gbWlwaV9kc2lfYXR0YWNoKGRzaSk7CiAJaWYgKHJldCA8IDApIHsKLQkJRFJNX0RFVl9FUlJP
UihkZXYsICJkc2kgYXR0YWNoIGZhaWxlZCByZXQgPSAlZFxuIiwgcmV0KTsKKwkJZGV2X2Vycihk
ZXYsICJkc2kgYXR0YWNoIGZhaWxlZCByZXQgPSAlZFxuIiwgcmV0KTsKIAkJZ290byBlcnJfZHNp
X2F0dGFjaDsKIAl9CiAKIAlyZXQgPSByZWd1bGF0b3Jfc2V0X2xvYWQoY3R4LT5zdXBwbGllc1sw
XS5jb25zdW1lciwgMzIwMDApOwogCWlmIChyZXQpIHsKLQkJRFJNX0RFVl9FUlJPUihkZXYsCi0J
CQkgICAgICAicmVndWxhdG9yIHNldCBsb2FkIGZhaWxlZCBmb3IgdmRkYSBzdXBwbHkgcmV0ID0g
JWRcbiIsCi0JCQkgICAgICByZXQpOworCQlkZXZfZXJyKGRldiwgInJlZ3VsYXRvciBzZXQgbG9h
ZCBmYWlsZWQgZm9yIHZkZGEgc3VwcGx5IHJldCA9ICVkXG4iLCByZXQpOwogCQlnb3RvIGVycl9z
ZXRfbG9hZDsKIAl9CiAKIAlyZXQgPSByZWd1bGF0b3Jfc2V0X2xvYWQoY3R4LT5zdXBwbGllc1sx
XS5jb25zdW1lciwgMTMyMDApOwogCWlmIChyZXQpIHsKLQkJRFJNX0RFVl9FUlJPUihkZXYsCi0J
CQkgICAgICAicmVndWxhdG9yIHNldCBsb2FkIGZhaWxlZCBmb3IgdmRkM3AzIHN1cHBseSByZXQg
PSAlZFxuIiwKLQkJCSAgICAgIHJldCk7CisJCWRldl9lcnIoZGV2LCAicmVndWxhdG9yIHNldCBs
b2FkIGZhaWxlZCBmb3IgdmRkM3AzIHN1cHBseSByZXQgPSAlZFxuIiwgcmV0KTsKIAkJZ290byBl
cnJfc2V0X2xvYWQ7CiAJfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvcGFu
ZWwteGlucGVuZy14cHAwNTVjMjcyLmMgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvcGFuZWwteGlu
cGVuZy14cHAwNTVjMjcyLmMKaW5kZXggMDYzNDFkZWI2MGNhLi41NTE3MmQ2M2E5MjIgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC14aW5wZW5nLXhwcDA1NWMyNzIuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvcGFuZWwteGlucGVuZy14cHAwNTVjMjcyLmMKQEAg
LTEyLDcgKzEyLDYgQEAKICNpbmNsdWRlIDxkcm0vZHJtX21pcGlfZHNpLmg+CiAjaW5jbHVkZSA8
ZHJtL2RybV9tb2Rlcy5oPgogI2luY2x1ZGUgPGRybS9kcm1fcGFuZWwuaD4KLSNpbmNsdWRlIDxk
cm0vZHJtX3ByaW50Lmg+CiAKICNpbmNsdWRlIDx2aWRlby9kaXNwbGF5X3RpbWluZy5oPgogI2lu
Y2x1ZGUgPHZpZGVvL21pcGlfZGlzcGxheS5oPgpAQCAtMTM1LDcgKzEzNCw3IEBAIHN0YXRpYyBp
bnQgeHBwMDU1YzI3Ml9pbml0X3NlcXVlbmNlKHN0cnVjdCB4cHAwNTVjMjcyICpjdHgpCiAKIAlt
c2xlZXAoNjApOwogCi0JRFJNX0RFVl9ERUJVR19EUklWRVIoZGV2LCAiUGFuZWwgaW5pdCBzZXF1
ZW5jZSBkb25lXG4iKTsKKwlkZXZfZGJnKGRldiwgIlBhbmVsIGluaXQgc2VxdWVuY2UgZG9uZVxu
Iik7CiAJcmV0dXJuIDA7CiB9CiAKQEAgLTE1MCwxMyArMTQ5LDExIEBAIHN0YXRpYyBpbnQgeHBw
MDU1YzI3Ml91bnByZXBhcmUoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwpCiAKIAlyZXQgPSBtaXBp
X2RzaV9kY3Nfc2V0X2Rpc3BsYXlfb2ZmKGRzaSk7CiAJaWYgKHJldCA8IDApCi0JCURSTV9ERVZf
RVJST1IoY3R4LT5kZXYsICJmYWlsZWQgdG8gc2V0IGRpc3BsYXkgb2ZmOiAlZFxuIiwKLQkJCSAg
ICAgIHJldCk7CisJCWRldl9lcnIoY3R4LT5kZXYsICJmYWlsZWQgdG8gc2V0IGRpc3BsYXkgb2Zm
OiAlZFxuIiwgcmV0KTsKIAogCW1pcGlfZHNpX2Rjc19lbnRlcl9zbGVlcF9tb2RlKGRzaSk7CiAJ
aWYgKHJldCA8IDApIHsKLQkJRFJNX0RFVl9FUlJPUihjdHgtPmRldiwgImZhaWxlZCB0byBlbnRl
ciBzbGVlcCBtb2RlOiAlZFxuIiwKLQkJCSAgICAgIHJldCk7CisJCWRldl9lcnIoY3R4LT5kZXYs
ICJmYWlsZWQgdG8gZW50ZXIgc2xlZXAgbW9kZTogJWRcbiIsIHJldCk7CiAJCXJldHVybiByZXQ7
CiAJfQogCkBAIC0xNzcsMTcgKzE3NCwxNSBAQCBzdGF0aWMgaW50IHhwcDA1NWMyNzJfcHJlcGFy
ZShzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKIAlpZiAoY3R4LT5wcmVwYXJlZCkKIAkJcmV0dXJu
IDA7CiAKLQlEUk1fREVWX0RFQlVHX0RSSVZFUihjdHgtPmRldiwgIlJlc2V0dGluZyB0aGUgcGFu
ZWxcbiIpOworCWRldl9kYmcoY3R4LT5kZXYsICJSZXNldHRpbmcgdGhlIHBhbmVsXG4iKTsKIAly
ZXQgPSByZWd1bGF0b3JfZW5hYmxlKGN0eC0+dmNpKTsKIAlpZiAocmV0IDwgMCkgewotCQlEUk1f
REVWX0VSUk9SKGN0eC0+ZGV2LAotCQkJICAgICAgIkZhaWxlZCB0byBlbmFibGUgdmNpIHN1cHBs
eTogJWRcbiIsIHJldCk7CisJCWRldl9lcnIoY3R4LT5kZXYsICJGYWlsZWQgdG8gZW5hYmxlIHZj
aSBzdXBwbHk6ICVkXG4iLCByZXQpOwogCQlyZXR1cm4gcmV0OwogCX0KIAlyZXQgPSByZWd1bGF0
b3JfZW5hYmxlKGN0eC0+aW92Y2MpOwogCWlmIChyZXQgPCAwKSB7Ci0JCURSTV9ERVZfRVJST1Io
Y3R4LT5kZXYsCi0JCQkgICAgICAiRmFpbGVkIHRvIGVuYWJsZSBpb3ZjYyBzdXBwbHk6ICVkXG4i
LCByZXQpOworCQlkZXZfZXJyKGN0eC0+ZGV2LCAiRmFpbGVkIHRvIGVuYWJsZSBpb3ZjYyBzdXBw
bHk6ICVkXG4iLCByZXQpOwogCQlnb3RvIGRpc2FibGVfdmNpOwogCX0KIApAQCAtMjAxLDE0ICsx
OTYsMTMgQEAgc3RhdGljIGludCB4cHAwNTVjMjcyX3ByZXBhcmUoc3RydWN0IGRybV9wYW5lbCAq
cGFuZWwpCiAKIAlyZXQgPSB4cHAwNTVjMjcyX2luaXRfc2VxdWVuY2UoY3R4KTsKIAlpZiAocmV0
IDwgMCkgewotCQlEUk1fREVWX0VSUk9SKGN0eC0+ZGV2LCAiUGFuZWwgaW5pdCBzZXF1ZW5jZSBm
YWlsZWQ6ICVkXG4iLAotCQkJICAgICAgcmV0KTsKKwkJZGV2X2VycihjdHgtPmRldiwgIlBhbmVs
IGluaXQgc2VxdWVuY2UgZmFpbGVkOiAlZFxuIiwgcmV0KTsKIAkJZ290byBkaXNhYmxlX2lvdmNj
OwogCX0KIAogCXJldCA9IG1pcGlfZHNpX2Rjc19leGl0X3NsZWVwX21vZGUoZHNpKTsKIAlpZiAo
cmV0IDwgMCkgewotCQlEUk1fREVWX0VSUk9SKGN0eC0+ZGV2LCAiRmFpbGVkIHRvIGV4aXQgc2xl
ZXAgbW9kZTogJWRcbiIsIHJldCk7CisJCWRldl9lcnIoY3R4LT5kZXYsICJGYWlsZWQgdG8gZXhp
dCBzbGVlcCBtb2RlOiAlZFxuIiwgcmV0KTsKIAkJZ290byBkaXNhYmxlX2lvdmNjOwogCX0KIApA
QCAtMjE3LDcgKzIxMSw3IEBAIHN0YXRpYyBpbnQgeHBwMDU1YzI3Ml9wcmVwYXJlKHN0cnVjdCBk
cm1fcGFuZWwgKnBhbmVsKQogCiAJcmV0ID0gbWlwaV9kc2lfZGNzX3NldF9kaXNwbGF5X29uKGRz
aSk7CiAJaWYgKHJldCA8IDApIHsKLQkJRFJNX0RFVl9FUlJPUihjdHgtPmRldiwgIkZhaWxlZCB0
byBzZXQgZGlzcGxheSBvbjogJWRcbiIsIHJldCk7CisJCWRldl9lcnIoY3R4LT5kZXYsICJGYWls
ZWQgdG8gc2V0IGRpc3BsYXkgb246ICVkXG4iLCByZXQpOwogCQlnb3RvIGRpc2FibGVfaW92Y2M7
CiAJfQogCkBAIC0yNTYsOSArMjUwLDkgQEAgc3RhdGljIGludCB4cHAwNTVjMjcyX2dldF9tb2Rl
cyhzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCwKIAogCW1vZGUgPSBkcm1fbW9kZV9kdXBsaWNhdGUo
Y29ubmVjdG9yLT5kZXYsICZkZWZhdWx0X21vZGUpOwogCWlmICghbW9kZSkgewotCQlEUk1fREVW
X0VSUk9SKGN0eC0+ZGV2LCAiRmFpbGVkIHRvIGFkZCBtb2RlICV1eCV1QCV1XG4iLAotCQkJICAg
ICAgZGVmYXVsdF9tb2RlLmhkaXNwbGF5LCBkZWZhdWx0X21vZGUudmRpc3BsYXksCi0JCQkgICAg
ICBkcm1fbW9kZV92cmVmcmVzaCgmZGVmYXVsdF9tb2RlKSk7CisJCWRldl9lcnIoY3R4LT5kZXYs
ICJGYWlsZWQgdG8gYWRkIG1vZGUgJXV4JXVAJXVcbiIsCisJCQlkZWZhdWx0X21vZGUuaGRpc3Bs
YXksIGRlZmF1bHRfbW9kZS52ZGlzcGxheSwKKwkJCWRybV9tb2RlX3ZyZWZyZXNoKCZkZWZhdWx0
X21vZGUpKTsKIAkJcmV0dXJuIC1FTk9NRU07CiAJfQogCkBAIC0yOTAsNyArMjg0LDcgQEAgc3Rh
dGljIGludCB4cHAwNTVjMjcyX3Byb2JlKHN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSkKIAog
CWN0eC0+cmVzZXRfZ3BpbyA9IGRldm1fZ3Bpb2RfZ2V0X29wdGlvbmFsKGRldiwgInJlc2V0Iiwg
R1BJT0RfT1VUX0xPVyk7CiAJaWYgKElTX0VSUihjdHgtPnJlc2V0X2dwaW8pKSB7Ci0JCURSTV9E
RVZfRVJST1IoZGV2LCAiY2Fubm90IGdldCByZXNldCBncGlvXG4iKTsKKwkJZGV2X2VycihkZXYs
ICJjYW5ub3QgZ2V0IHJlc2V0IGdwaW9cbiIpOwogCQlyZXR1cm4gUFRSX0VSUihjdHgtPnJlc2V0
X2dwaW8pOwogCX0KIApAQCAtMjk4LDkgKzI5Miw3IEBAIHN0YXRpYyBpbnQgeHBwMDU1YzI3Ml9w
cm9iZShzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kpCiAJaWYgKElTX0VSUihjdHgtPnZjaSkp
IHsKIAkJcmV0ID0gUFRSX0VSUihjdHgtPnZjaSk7CiAJCWlmIChyZXQgIT0gLUVQUk9CRV9ERUZF
UikKLQkJCURSTV9ERVZfRVJST1IoZGV2LAotCQkJCSAgICAgICJGYWlsZWQgdG8gcmVxdWVzdCB2
Y2kgcmVndWxhdG9yOiAlZFxuIiwKLQkJCQkgICAgICByZXQpOworCQkJZGV2X2VycihkZXYsICJG
YWlsZWQgdG8gcmVxdWVzdCB2Y2kgcmVndWxhdG9yOiAlZFxuIiwgcmV0KTsKIAkJcmV0dXJuIHJl
dDsKIAl9CiAKQEAgLTMwOCw5ICszMDAsNyBAQCBzdGF0aWMgaW50IHhwcDA1NWMyNzJfcHJvYmUo
c3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpKQogCWlmIChJU19FUlIoY3R4LT5pb3ZjYykpIHsK
IAkJcmV0ID0gUFRSX0VSUihjdHgtPmlvdmNjKTsKIAkJaWYgKHJldCAhPSAtRVBST0JFX0RFRkVS
KQotCQkJRFJNX0RFVl9FUlJPUihkZXYsCi0JCQkJICAgICAgIkZhaWxlZCB0byByZXF1ZXN0IGlv
dmNjIHJlZ3VsYXRvcjogJWRcbiIsCi0JCQkJICAgICAgcmV0KTsKKwkJCWRldl9lcnIoZGV2LCAi
RmFpbGVkIHRvIHJlcXVlc3QgaW92Y2MgcmVndWxhdG9yOiAlZFxuIiwgcmV0KTsKIAkJcmV0dXJu
IHJldDsKIAl9CiAKQEAgLTMzNCw3ICszMjQsNyBAQCBzdGF0aWMgaW50IHhwcDA1NWMyNzJfcHJv
YmUoc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpKQogCiAJcmV0ID0gbWlwaV9kc2lfYXR0YWNo
KGRzaSk7CiAJaWYgKHJldCA8IDApIHsKLQkJRFJNX0RFVl9FUlJPUihkZXYsICJtaXBpX2RzaV9h
dHRhY2ggZmFpbGVkOiAlZFxuIiwgcmV0KTsKKwkJZGV2X2VycihkZXYsICJtaXBpX2RzaV9hdHRh
Y2ggZmFpbGVkOiAlZFxuIiwgcmV0KTsKIAkJZHJtX3BhbmVsX3JlbW92ZSgmY3R4LT5wYW5lbCk7
CiAJCXJldHVybiByZXQ7CiAJfQpAQCAtMzQ5LDEzICszMzksMTEgQEAgc3RhdGljIHZvaWQgeHBw
MDU1YzI3Ml9zaHV0ZG93bihzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kpCiAKIAlyZXQgPSBk
cm1fcGFuZWxfdW5wcmVwYXJlKCZjdHgtPnBhbmVsKTsKIAlpZiAocmV0IDwgMCkKLQkJRFJNX0RF
Vl9FUlJPUigmZHNpLT5kZXYsICJGYWlsZWQgdG8gdW5wcmVwYXJlIHBhbmVsOiAlZFxuIiwKLQkJ
CSAgICAgIHJldCk7CisJCWRldl9lcnIoJmRzaS0+ZGV2LCAiRmFpbGVkIHRvIHVucHJlcGFyZSBw
YW5lbDogJWRcbiIsIHJldCk7CiAKIAlyZXQgPSBkcm1fcGFuZWxfZGlzYWJsZSgmY3R4LT5wYW5l
bCk7CiAJaWYgKHJldCA8IDApCi0JCURSTV9ERVZfRVJST1IoJmRzaS0+ZGV2LCAiRmFpbGVkIHRv
IGRpc2FibGUgcGFuZWw6ICVkXG4iLAotCQkJICAgICAgcmV0KTsKKwkJZGV2X2VycigmZHNpLT5k
ZXYsICJGYWlsZWQgdG8gZGlzYWJsZSBwYW5lbDogJWRcbiIsIHJldCk7CiB9CiAKIHN0YXRpYyBp
bnQgeHBwMDU1YzI3Ml9yZW1vdmUoc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpKQpAQCAtMzY3
LDggKzM1NSw3IEBAIHN0YXRpYyBpbnQgeHBwMDU1YzI3Ml9yZW1vdmUoc3RydWN0IG1pcGlfZHNp
X2RldmljZSAqZHNpKQogCiAJcmV0ID0gbWlwaV9kc2lfZGV0YWNoKGRzaSk7CiAJaWYgKHJldCA8
IDApCi0JCURSTV9ERVZfRVJST1IoJmRzaS0+ZGV2LCAiRmFpbGVkIHRvIGRldGFjaCBmcm9tIERT
SSBob3N0OiAlZFxuIiwKLQkJCSAgICAgIHJldCk7CisJCWRldl9lcnIoJmRzaS0+ZGV2LCAiRmFp
bGVkIHRvIGRldGFjaCBmcm9tIERTSSBob3N0OiAlZFxuIiwgcmV0KTsKIAogCWRybV9wYW5lbF9y
ZW1vdmUoJmN0eC0+cGFuZWwpOwogCi0tIAoyLjI1LjEKCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVs
QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWls
bWFuL2xpc3RpbmZvL2RyaS1kZXZlbAo=
