Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 24C2C22054
	for <lists+dri-devel@lfdr.de>; Sat, 18 May 2019 00:32:01 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 420C0898BF;
	Fri, 17 May 2019 22:31:55 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from perceval.ideasonboard.com (perceval.ideasonboard.com
 [IPv6:2001:4b98:dc2:55:216:3eff:fef7:d647])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4B9F289533
 for <dri-devel@lists.freedesktop.org>; Fri, 17 May 2019 22:31:51 +0000 (UTC)
Received: from localhost.localdomain
 (cpc89242-aztw30-2-0-cust488.18-1.cable.virginm.net [86.31.129.233])
 by perceval.ideasonboard.com (Postfix) with ESMTPSA id 16CEE549;
 Sat, 18 May 2019 00:31:49 +0200 (CEST)
From: Kieran Bingham <kieran.bingham+renesas@ideasonboard.com>
To: Laurent Pinchart <laurent.pinchart@ideasonboard.com>,
 linux-renesas-soc@vger.kernel.org, linux-media@vger.kernel.org,
 dri-devel@lists.freedesktop.org
Subject: [PATCH 2/3] drm: rcar-du: Convert to the new VSP atomic API
Date: Fri, 17 May 2019 23:31:42 +0100
Message-Id: <20190517223143.26251-3-kieran.bingham+renesas@ideasonboard.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190517223143.26251-1-kieran.bingham+renesas@ideasonboard.com>
References: <20190517223143.26251-1-kieran.bingham+renesas@ideasonboard.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=ideasonboard.com; s=mail; t=1558132309;
 bh=m8pNlj4zqsyuv9W9pVXYGEPtsCI08Dhmq286NFQVPG8=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=lBko5H38L1/SV/wZ/MqNitQ6Lt17MAiHI2uQDamCQUOx2X4IZukWhTJzVhhf68tGi
 KHiz1oRK29TQkoy+I4OGUYoT/V/GNop1wob2j0lEdNJbCb8p5HGZcE8ba9YDTZXXG0
 PgJERArOHTgM5IRi9k7c5JoZtV9dISc5eqevzCYA=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: David Airlie <airlied@linux.ie>,
 Kieran Bingham <kieran.bingham+renesas@ideasonboard.com>,
 open list <linux-kernel@vger.kernel.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIGNvbmZpZ3VyYXRpb24gQVBJIGJldHdlZW4gdGhlIFZTUCBhbmQgdGhlIERVIGhhcyBiZWVu
IHVwZGF0ZWQgdG8KcHJvdmlkZSBmaW5lciBncmFpbiBjb250cm9sIG92ZXIgbW9kZXNldHRpbmcs
IGFuZCBlbmFibGVtZW50LgoKU3BsaXQgcmNhcl9kdV92c3BfZW5hYmxlKCkgaW50byByY2FyX2R1
X3ZzcF9tb2Rlc2V0KCkgYW5kCnJjYXJfZHVfdnNwX2VuYWJsZSgpIGFjY29yZGluZ2x5LCBhbmQg
dXBkYXRlIGVhY2ggZnVuY3Rpb24gdG8gdXNlIHRoZQpuZXcgVlNQIEFQSS4KClRoZXJlIGFyZSBu
byBmdXJ0aGVyIHVzZXJzIG9mIHRoZSBkZXByZWNhdGVkIHZzcDFfZHVfc2V0dXBfbGlmKCkgd2hp
Y2gKY2FuIG5vdyBiZSByZW1vdmVkLgoKU2lnbmVkLW9mZi1ieTogS2llcmFuIEJpbmdoYW0gPGtp
ZXJhbi5iaW5naGFtK3JlbmVzYXNAaWRlYXNvbmJvYXJkLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9k
cm0vcmNhci1kdS9yY2FyX2R1X2NydGMuYyB8ICA0ICsrKy0KIGRyaXZlcnMvZ3B1L2RybS9yY2Fy
LWR1L3JjYXJfZHVfdnNwLmMgIHwgMjEgKysrKysrKysrKysrKysrLS0tLS0tCiBkcml2ZXJzL2dw
dS9kcm0vcmNhci1kdS9yY2FyX2R1X3ZzcC5oICB8ICAyICsrCiAzIGZpbGVzIGNoYW5nZWQsIDIw
IGluc2VydGlvbnMoKyksIDcgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL3JjYXItZHUvcmNhcl9kdV9jcnRjLmMgYi9kcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2Fy
X2R1X2NydGMuYwppbmRleCAyZGE0NmUzZGM0YWUuLmNjY2Q2ZmU4NTc0OSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV9jcnRjLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL3JjYXItZHUvcmNhcl9kdV9jcnRjLmMKQEAgLTQ5Miw4ICs0OTIsMTAgQEAgc3RhdGljIHZv
aWQgcmNhcl9kdV9jcnRjX3NldHVwKHN0cnVjdCByY2FyX2R1X2NydGMgKnJjcnRjKQogCXJjYXJf
ZHVfZ3JvdXBfd3JpdGUocmNydGMtPmdyb3VwLCByY3J0Yy0+aW5kZXggJSAyID8gRFMyUFIgOiBE
UzFQUiwgMCk7CiAKIAkvKiBFbmFibGUgdGhlIFZTUCBjb21wb3NpdG9yLiAqLwotCWlmIChyY2Fy
X2R1X2hhcyhyY3J0Yy0+ZGV2LCBSQ0FSX0RVX0ZFQVRVUkVfVlNQMV9TT1VSQ0UpKQorCWlmIChy
Y2FyX2R1X2hhcyhyY3J0Yy0+ZGV2LCBSQ0FSX0RVX0ZFQVRVUkVfVlNQMV9TT1VSQ0UpKSB7CisJ
CXJjYXJfZHVfdnNwX21vZGVzZXQocmNydGMpOwogCQlyY2FyX2R1X3ZzcF9lbmFibGUocmNydGMp
OworCX0KIAogCS8qIFR1cm4gdmVydGljYWwgYmxhbmtpbmcgaW50ZXJydXB0IHJlcG9ydGluZyBv
bi4gKi8KIAlkcm1fY3J0Y192Ymxhbmtfb24oJnJjcnRjLT5jcnRjKTsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfdnNwLmMgYi9kcml2ZXJzL2dwdS9kcm0vcmNh
ci1kdS9yY2FyX2R1X3ZzcC5jCmluZGV4IDVlNGZhZjI1OGMzMS4uYzE3MDQyN2ZjYWQ5IDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcmNhci1kdS9yY2FyX2R1X3ZzcC5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfdnNwLmMKQEAgLTQ0LDE2ICs0NCwxNCBAQCBzdGF0
aWMgdm9pZCByY2FyX2R1X3ZzcF9jb21wbGV0ZSh2b2lkICpwcml2YXRlLCB1bnNpZ25lZCBpbnQg
c3RhdHVzLCB1MzIgY3JjKQogCWRybV9jcnRjX2FkZF9jcmNfZW50cnkoJmNydGMtPmNydGMsIGZh
bHNlLCAwLCAmY3JjKTsKIH0KIAotdm9pZCByY2FyX2R1X3ZzcF9lbmFibGUoc3RydWN0IHJjYXJf
ZHVfY3J0YyAqY3J0YykKK3ZvaWQgcmNhcl9kdV92c3BfbW9kZXNldChzdHJ1Y3QgcmNhcl9kdV9j
cnRjICpjcnRjKQogewogCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlID0gJmNy
dGMtPmNydGMuc3RhdGUtPmFkanVzdGVkX21vZGU7CiAJc3RydWN0IHJjYXJfZHVfZGV2aWNlICpy
Y2R1ID0gY3J0Yy0+ZGV2OwotCXN0cnVjdCB2c3AxX2R1X2xpZl9jb25maWcgY2ZnID0geworCXN0
cnVjdCB2c3AxX2R1X21vZGVzZXRfY29uZmlnIGNmZyA9IHsKIAkJLndpZHRoID0gbW9kZS0+aGRp
c3BsYXksCiAJCS5oZWlnaHQgPSBtb2RlLT52ZGlzcGxheSwKIAkJLmludGVybGFjZWQgPSBtb2Rl
LT5mbGFncyAmIERSTV9NT0RFX0ZMQUdfSU5URVJMQUNFLAotCQkuY2FsbGJhY2sgPSByY2FyX2R1
X3ZzcF9jb21wbGV0ZSwKLQkJLmNhbGxiYWNrX2RhdGEgPSBjcnRjLAogCX07CiAJc3RydWN0IHJj
YXJfZHVfcGxhbmVfc3RhdGUgc3RhdGUgPSB7CiAJCS5zdGF0ZSA9IHsKQEAgLTkwLDEyICs4OCwy
MyBAQCB2b2lkIHJjYXJfZHVfdnNwX2VuYWJsZShzdHJ1Y3QgcmNhcl9kdV9jcnRjICpjcnRjKQog
CSAqLwogCWNydGMtPmdyb3VwLT5uZWVkX3Jlc3RhcnQgPSB0cnVlOwogCi0JdnNwMV9kdV9zZXR1
cF9saWYoY3J0Yy0+dnNwLT52c3AsIGNydGMtPnZzcF9waXBlLCAmY2ZnKTsKKworCXZzcDFfZHVf
YXRvbWljX21vZGVzZXQoY3J0Yy0+dnNwLT52c3AsIGNydGMtPnZzcF9waXBlLCAmY2ZnKTsKK30K
Kwordm9pZCByY2FyX2R1X3ZzcF9lbmFibGUoc3RydWN0IHJjYXJfZHVfY3J0YyAqY3J0YykKK3sK
KwlzdHJ1Y3QgdnNwMV9kdV9lbmFibGVfY29uZmlnIGNmZyA9IHsKKwkJLmNhbGxiYWNrID0gcmNh
cl9kdV92c3BfY29tcGxldGUsCisJCS5jYWxsYmFja19kYXRhID0gY3J0YywKKwl9OworCisJdnNw
MV9kdV9hdG9taWNfZW5hYmxlKGNydGMtPnZzcC0+dnNwLCBjcnRjLT52c3BfcGlwZSwgJmNmZyk7
CiB9CiAKIHZvaWQgcmNhcl9kdV92c3BfZGlzYWJsZShzdHJ1Y3QgcmNhcl9kdV9jcnRjICpjcnRj
KQogewotCXZzcDFfZHVfc2V0dXBfbGlmKGNydGMtPnZzcC0+dnNwLCBjcnRjLT52c3BfcGlwZSwg
TlVMTCk7CisJdnNwMV9kdV9hdG9taWNfZGlzYWJsZShjcnRjLT52c3AtPnZzcCwgY3J0Yy0+dnNw
X3BpcGUpOwogfQogCiB2b2lkIHJjYXJfZHVfdnNwX2F0b21pY19iZWdpbihzdHJ1Y3QgcmNhcl9k
dV9jcnRjICpjcnRjKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9k
dV92c3AuaCBiL2RyaXZlcnMvZ3B1L2RybS9yY2FyLWR1L3JjYXJfZHVfdnNwLmgKaW5kZXggOWI0
NzI0MTU5Mzc4Li5hNmY2YmI0NjkwZjIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yY2Fy
LWR1L3JjYXJfZHVfdnNwLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL3JjYXItZHUvcmNhcl9kdV92
c3AuaApAQCAtNTgsNiArNTgsNyBAQCB0b19yY2FyX3ZzcF9wbGFuZV9zdGF0ZShzdHJ1Y3QgZHJt
X3BsYW5lX3N0YXRlICpzdGF0ZSkKICNpZmRlZiBDT05GSUdfRFJNX1JDQVJfVlNQCiBpbnQgcmNh
cl9kdV92c3BfaW5pdChzdHJ1Y3QgcmNhcl9kdV92c3AgKnZzcCwgc3RydWN0IGRldmljZV9ub2Rl
ICpucCwKIAkJICAgICB1bnNpZ25lZCBpbnQgY3J0Y3MpOwordm9pZCByY2FyX2R1X3ZzcF9tb2Rl
c2V0KHN0cnVjdCByY2FyX2R1X2NydGMgKmNydGMpOwogdm9pZCByY2FyX2R1X3ZzcF9lbmFibGUo
c3RydWN0IHJjYXJfZHVfY3J0YyAqY3J0Yyk7CiB2b2lkIHJjYXJfZHVfdnNwX2Rpc2FibGUoc3Ry
dWN0IHJjYXJfZHVfY3J0YyAqY3J0Yyk7CiB2b2lkIHJjYXJfZHVfdnNwX2F0b21pY19iZWdpbihz
dHJ1Y3QgcmNhcl9kdV9jcnRjICpjcnRjKTsKQEAgLTczLDYgKzc0LDcgQEAgc3RhdGljIGlubGlu
ZSBpbnQgcmNhcl9kdV92c3BfaW5pdChzdHJ1Y3QgcmNhcl9kdV92c3AgKnZzcCwKIHsKIAlyZXR1
cm4gLUVOWElPOwogfQorc3RhdGljIGlubGluYyB2b2lkIHJjYXJfZHVfdnNwX21vZGVzZXQoc3Ry
dWN0IHJjYXJfZHVfY3J0YyAqY3J0YykgeyB9Owogc3RhdGljIGlubGluZSB2b2lkIHJjYXJfZHVf
dnNwX2VuYWJsZShzdHJ1Y3QgcmNhcl9kdV9jcnRjICpjcnRjKSB7IH07CiBzdGF0aWMgaW5saW5l
IHZvaWQgcmNhcl9kdV92c3BfZGlzYWJsZShzdHJ1Y3QgcmNhcl9kdV9jcnRjICpjcnRjKSB7IH07
CiBzdGF0aWMgaW5saW5lIHZvaWQgcmNhcl9kdV92c3BfYXRvbWljX2JlZ2luKHN0cnVjdCByY2Fy
X2R1X2NydGMgKmNydGMpIHsgfTsKLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxA
bGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxt
YW4vbGlzdGluZm8vZHJpLWRldmVs
