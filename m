Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 3EB6F88BA3
	for <lists+dri-devel@lfdr.de>; Sat, 10 Aug 2019 15:55:26 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 35B486E416;
	Sat, 10 Aug 2019 13:55:14 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from foss.arm.com (foss.arm.com [217.140.110.172])
 by gabe.freedesktop.org (Postfix) with ESMTP id 557626EDFE
 for <dri-devel@lists.freedesktop.org>; Fri,  9 Aug 2019 12:36:19 +0000 (UTC)
Received: from usa-sjc-imap-foss1.foss.arm.com (unknown [10.121.207.14])
 by usa-sjc-mx-foss1.foss.arm.com (Postfix) with ESMTP id E856F1596;
 Fri,  9 Aug 2019 05:36:18 -0700 (PDT)
Received: from [10.1.196.133] (e112269-lin.cambridge.arm.com [10.1.196.133])
 by usa-sjc-imap-foss1.foss.arm.com (Postfix) with ESMTPSA id F39523F706;
 Fri,  9 Aug 2019 05:36:17 -0700 (PDT)
Subject: Re: [PATCH] drm/panfrost: Implement per FD address spaces
To: Rob Herring <robh@kernel.org>, dri-devel@lists.freedesktop.org
References: <20190808222918.15153-1-robh@kernel.org>
From: Steven Price <steven.price@arm.com>
Message-ID: <2ee6ef1f-7b73-3361-cfdd-6c021b7fe1b0@arm.com>
Date: Fri, 9 Aug 2019 13:36:16 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <20190808222918.15153-1-robh@kernel.org>
Content-Language: en-GB
X-Mailman-Approved-At: Sat, 10 Aug 2019 13:55:11 +0000
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: David Airlie <airlied@linux.ie>, Robin Murphy <robin.murphy@arm.com>,
 Alyssa Rosenzweig <alyssa.rosenzweig@collabora.com>,
 Tomeu Vizoso <tomeu.vizoso@collabora.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gMDgvMDgvMjAxOSAyMzoyOSwgUm9iIEhlcnJpbmcgd3JvdGU6Cj4gVXAgdW50aWwgbm93LCBh
IHNpbmdsZSBzaGFyZWQgR1BVIGFkZHJlc3Mgc3BhY2Ugd2FzIHVzZWQuIFRoaXMgaXMgbm90Cj4g
aWRlYWwgYXMgdGhlcmUncyBubyBwcm90ZWN0aW9uIGJldHdlZW4gcHJvY2Vzc2VzIGFuZCBkb2Vz
bid0IHdvcmsgZm9yCj4gc3VwcG9ydGluZyB0aGUgc2FtZSBHUFUvQ1BVIFZBIGZlYXR1cmUuIE1v
c3QgaW1wb3J0YW50bHksIHRoaXMgd2lsbAo+IGhvcGVmdWxseSBtaXRpZ2F0ZSBBbHlzc2EncyBm
ZWFyIG9mIFdlYkdMLCB3aGF0ZXZlciB0aGF0IGlzLgo+IAo+IE1vc3Qgb2YgdGhlIGNoYW5nZXMg
aGVyZSBhcmUgbW92aW5nIHN0cnVjdCBkcm1fbW0gYW5kIHN0cnVjdAo+IHBhbmZyb3N0X21tdSBv
YmplY3RzIGZyb20gdGhlIHBlciBkZXZpY2Ugc3RydWN0IHRvIHRoZSBwZXIgRkQgc3RydWN0Lgo+
IFRoZSBjcml0aWNhbCBmdW5jdGlvbiBpcyBwYW5mcm9zdF9tbXVfYXNfZ2V0KCkgd2hpY2ggaGFu
ZGxlcyBhbGxvY2F0aW5nCj4gYW5kIHN3aXRjaGluZyB0aGUgaC93IGFkZHJlc3Mgc3BhY2VzLgo+
IAo+IENjOiBUb21ldSBWaXpvc28gPHRvbWV1LnZpem9zb0Bjb2xsYWJvcmEuY29tPgo+IENjOiBE
YXZpZCBBaXJsaWUgPGFpcmxpZWRAbGludXguaWU+Cj4gQ2M6IERhbmllbCBWZXR0ZXIgPGRhbmll
bEBmZndsbC5jaD4KPiBDYzogUm9iaW4gTXVycGh5IDxyb2Jpbi5tdXJwaHlAYXJtLmNvbT4KPiBD
YzogU3RldmVuIFByaWNlIDxzdGV2ZW4ucHJpY2VAYXJtLmNvbT4KPiBDYzogQWx5c3NhIFJvc2Vu
endlaWcgPGFseXNzYS5yb3Nlbnp3ZWlnQGNvbGxhYm9yYS5jb20+Cj4gU2lnbmVkLW9mZi1ieTog
Um9iIEhlcnJpbmcgPHJvYmhAa2VybmVsLm9yZz4KPiAtLS0KPiBUaGlzIGRlcGVuZHMgb24gbWFk
dmlzZSBzdXBwb3J0IChub3cgaW4gZHJtLW1pc2MpIGFuZCB0aGUgaGVhcC9uby1leGVjIAo+IHNl
cmllcyAoanVzdCB0aGUgcmV3b3JrKS4gU2VlZW1zIHRvIGJlIHdvcmtpbmcgcHJldHR5IHdlbGwg
Zm9yIG1lLCBidXQgCj4gbW9yZSB0ZXN0aW5nIHdvdWxkIGJlIGhlbHBmdWwuIEkndmUgcnVuIG11
bHRpcGxlICdnbG1hcmsyLWVzMi1kcm0gCj4gLS1vZmYtc2NyZWVuJyBpbnN0YW5jZXMgYW5kIEdu
b21lIFNoZWxsLiBSdW5uaW5nIG1vcmUgdGhhbiA4IGNsaWVudHMgKGF0IAo+IGxlYXN0IGZvciBU
ODYwKSB3aWxsIGhpdCB0aGUgYWRkcmVzcyBzcGFjZSBzd2l0Y2ggY29kZSBwYXRocy4KPiAKPiBS
b2IKPiAKPiAgZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L1RPRE8gICAgICAgICAgICAgIHwgICA0
IC0KPiAgZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2RldmljZS5jIHwgICAyICsK
PiAgZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2RldmljZS5oIHwgIDI0ICsrLQo+
ICBkcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZHJ2LmMgICAgfCAgMzEgKystCj4g
IGRyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9nZW0uYyAgICB8ICAxNSArLQo+ICBk
cml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZ2VtLmggICAgfCAgIDMgKwo+ICBkcml2
ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3Rfam9iLmMgICAgfCAgMTIgKy0KPiAgZHJpdmVy
cy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X21tdS5jICAgIHwgMjIwICsrKysrKysrKysrKysr
Ky0tLS0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfbW11LmggICAgfCAg
IDggKwo+ICA5IGZpbGVzIGNoYW5nZWQsIDIzOSBpbnNlcnRpb25zKCspLCA4MCBkZWxldGlvbnMo
LSkKPiAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L1RPRE8gYi9kcml2
ZXJzL2dwdS9kcm0vcGFuZnJvc3QvVE9ETwo+IGluZGV4IGU3NzI3YjI5MjM1NS4uNTM2YTBkNGY4
ZDI5IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9UT0RPCj4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L1RPRE8KPiBAQCAtNiwxMCArNiw2IEBACj4gICAgLSBC
aWZyb3N0IHNwZWNpZmljIGZlYXR1cmUgYW5kIGlzc3VlIGhhbmRsaW5nCj4gICAgLSBDb2hlcmVu
dCBETUEgc3VwcG9ydAo+ICAKPiAtLSBQZXIgRkQgYWRkcmVzcyBzcGFjZSBzdXBwb3J0LiBUaGUg
aC93IHN1cHBvcnRzIG11bHRpcGxlIGFkZHJlc3NlcyBzcGFjZXMuCj4gLSAgVGhlIGhhcmQgcGFy
dCBpcyBoYW5kbGluZyB3aGVuIG1vcmUgYWRkcmVzcyBzcGFjZXMgYXJlIG5lZWRlZCB0aGFuIHdo
YXQKPiAtICB0aGUgaC93IHByb3ZpZGVzLgo+IC0KPiAgLSBTdXBwb3J0IHVzZXJzcGFjZSBjb250
cm9sbGVkIEdQVSB2aXJ0dWFsIGFkZHJlc3Nlcy4gTmVlZGVkIGZvciBWdWxrYW4uIChUb21ldSkK
PiAgCj4gIC0gQ29tcHV0ZSBqb2Igc3VwcG9ydC4gU28gY2FsbGVkICdjb21wdXRlIG9ubHknIGpv
YnMgbmVlZCB0byBiZSBwbHVtYmVkIHVwIHRvCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9wYW5mcm9zdC9wYW5mcm9zdF9kZXZpY2UuYyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9w
YW5mcm9zdF9kZXZpY2UuYwo+IGluZGV4IDk4MTRmNGNjYmQyNi4uNGRhNzFiYjU2YzIwIDEwMDY0
NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9kZXZpY2UuYwo+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9kZXZpY2UuYwo+IEBAIC0xMjMs
OCArMTIzLDEwIEBAIGludCBwYW5mcm9zdF9kZXZpY2VfaW5pdChzdHJ1Y3QgcGFuZnJvc3RfZGV2
aWNlICpwZmRldikKPiAgCW11dGV4X2luaXQoJnBmZGV2LT5zY2hlZF9sb2NrKTsKPiAgCW11dGV4
X2luaXQoJnBmZGV2LT5yZXNldF9sb2NrKTsKPiAgCUlOSVRfTElTVF9IRUFEKCZwZmRldi0+c2No
ZWR1bGVkX2pvYnMpOwo+ICsJSU5JVF9MSVNUX0hFQUQoJnBmZGV2LT5hc19scnVfbGlzdCk7Cj4g
IAo+ICAJc3Bpbl9sb2NrX2luaXQoJnBmZGV2LT5od2FjY2Vzc19sb2NrKTsKPiArCXNwaW5fbG9j
a19pbml0KCZwZmRldi0+YXNfbG9jayk7Cj4gIAo+ICAJZXJyID0gcGFuZnJvc3RfY2xrX2luaXQo
cGZkZXYpOwo+ICAJaWYgKGVycikgewo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcGFu
ZnJvc3QvcGFuZnJvc3RfZGV2aWNlLmggYi9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJv
c3RfZGV2aWNlLmgKPiBpbmRleCA0ZTU2NDFkYjljN2UuLmY1MDNjNTY2ZTk5ZiAxMDA2NDQKPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZGV2aWNlLmgKPiArKysgYi9k
cml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZGV2aWNlLmgKPiBAQCAtNSw2ICs1LDgg
QEAKPiAgI2lmbmRlZiBfX1BBTkZST1NUX0RFVklDRV9IX18KPiAgI2RlZmluZSBfX1BBTkZST1NU
X0RFVklDRV9IX18KPiAgCj4gKyNpbmNsdWRlIDxsaW51eC9hdG9taWMuaD4KPiArI2luY2x1ZGUg
PGxpbnV4L2lvLXBndGFibGUuaD4KPiAgI2luY2x1ZGUgPGxpbnV4L3NwaW5sb2NrLmg+Cj4gICNp
bmNsdWRlIDxkcm0vZHJtX2RldmljZS5oPgo+ICAjaW5jbHVkZSA8ZHJtL2RybV9tbS5oPgo+IEBA
IC02Myw5ICs2NSw2IEBAIHN0cnVjdCBwYW5mcm9zdF9kZXZpY2Ugewo+ICAKPiAgCXNwaW5sb2Nr
X3QgaHdhY2Nlc3NfbG9jazsKPiAgCj4gLQlzdHJ1Y3QgZHJtX21tIG1tOwo+IC0Jc3BpbmxvY2tf
dCBtbV9sb2NrOwo+IC0KPiAgCXZvaWQgX19pb21lbSAqaW9tZW07Cj4gIAlzdHJ1Y3QgY2xrICpj
bG9jazsKPiAgCXN0cnVjdCBjbGsgKmJ1c19jbG9jazsKPiBAQCAtNzQsNyArNzMsMTEgQEAgc3Ry
dWN0IHBhbmZyb3N0X2RldmljZSB7Cj4gIAo+ICAJc3RydWN0IHBhbmZyb3N0X2ZlYXR1cmVzIGZl
YXR1cmVzOwo+ICAKPiAtCXN0cnVjdCBwYW5mcm9zdF9tbXUgKm1tdTsKPiArCXNwaW5sb2NrX3Qg
YXNfbG9jazsKPiArCXVuc2lnbmVkIGxvbmcgYXNfaW5fdXNlX21hc2s7Cj4gKwl1bnNpZ25lZCBs
b25nIGFzX2FsbG9jX21hc2s7Cj4gKwlzdHJ1Y3QgbGlzdF9oZWFkIGFzX2xydV9saXN0Owo+ICsK
PiAgCXN0cnVjdCBwYW5mcm9zdF9qb2Jfc2xvdCAqanM7Cj4gIAo+ICAJc3RydWN0IHBhbmZyb3N0
X2pvYiAqam9ic1tOVU1fSk9CX1NMT1RTXTsKPiBAQCAtOTgsMTAgKzEwMSwyMyBAQCBzdHJ1Y3Qg
cGFuZnJvc3RfZGV2aWNlIHsKPiAgCX0gZGV2ZnJlcTsKPiAgfTsKPiAgCj4gK3N0cnVjdCBwYW5m
cm9zdF9tbXUgewo+ICsJc3RydWN0IGlvX3BndGFibGVfY2ZnIHBndGJsX2NmZzsKPiArCXN0cnVj
dCBpb19wZ3RhYmxlX29wcyAqcGd0Ymxfb3BzOwo+ICsJc3RydWN0IG11dGV4IGxvY2s7Cj4gKwlp
bnQgYXM7Cj4gKwlhdG9taWNfdCBhc19jb3VudDsKPiArCXN0cnVjdCBsaXN0X2hlYWQgbGlzdDsK
PiArfTsKPiArCj4gIHN0cnVjdCBwYW5mcm9zdF9maWxlX3ByaXYgewo+ICAJc3RydWN0IHBhbmZy
b3N0X2RldmljZSAqcGZkZXY7Cj4gIAo+ICAJc3RydWN0IGRybV9zY2hlZF9lbnRpdHkgc2NoZWRf
ZW50aXR5W05VTV9KT0JfU0xPVFNdOwo+ICsKPiArCXN0cnVjdCBwYW5mcm9zdF9tbXUgbW11Owo+
ICsJc3RydWN0IGRybV9tbSBtbTsKPiArCXNwaW5sb2NrX3QgbW1fbG9jazsKPiAgfTsKPiAgCj4g
IHN0YXRpYyBpbmxpbmUgc3RydWN0IHBhbmZyb3N0X2RldmljZSAqdG9fcGFuZnJvc3RfZGV2aWNl
KHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2KQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
cGFuZnJvc3QvcGFuZnJvc3RfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJv
c3RfZHJ2LmMKPiBpbmRleCBhMTM1Mjc1MDk4NGMuLjdjOGFhMWE4MDU0ZiAxMDA2NDQKPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZHJ2LmMKPiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZHJ2LmMKPiBAQCAtNDAzLDYgKzQwMyw3IEBAIHN0
YXRpYyB2b2lkIHBhbmZyb3N0X2RybV9tbV9jb2xvcl9hZGp1c3QoY29uc3Qgc3RydWN0IGRybV9t
bV9ub2RlICpub2RlLAo+ICBzdGF0aWMgaW50Cj4gIHBhbmZyb3N0X29wZW4oc3RydWN0IGRybV9k
ZXZpY2UgKmRldiwgc3RydWN0IGRybV9maWxlICpmaWxlKQo+ICB7Cj4gKwlpbnQgcmV0Owo+ICAJ
c3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYgPSBkZXYtPmRldl9wcml2YXRlOwo+ICAJc3Ry
dWN0IHBhbmZyb3N0X2ZpbGVfcHJpdiAqcGFuZnJvc3RfcHJpdjsKPiAgCj4gQEAgLTQxMyw3ICs0
MTQsMjggQEAgcGFuZnJvc3Rfb3BlbihzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBzdHJ1Y3QgZHJt
X2ZpbGUgKmZpbGUpCj4gIAlwYW5mcm9zdF9wcml2LT5wZmRldiA9IHBmZGV2Owo+ICAJZmlsZS0+
ZHJpdmVyX3ByaXYgPSBwYW5mcm9zdF9wcml2Owo+ICAKPiAtCXJldHVybiBwYW5mcm9zdF9qb2Jf
b3BlbihwYW5mcm9zdF9wcml2KTsKPiArCXNwaW5fbG9ja19pbml0KCZwYW5mcm9zdF9wcml2LT5t
bV9sb2NrKTsKPiArCj4gKwkvKiA0RyBlbm91Z2ggZm9yIG5vdy4gY2FuIGJlIDQ4LWJpdCAqLwo+
ICsJcGFuZnJvc3RfcHJpdi0+bW0uY29sb3JfYWRqdXN0ID0gcGFuZnJvc3RfZHJtX21tX2NvbG9y
X2FkanVzdDsKPiArCWRybV9tbV9pbml0KCZwYW5mcm9zdF9wcml2LT5tbSwgU1pfMzJNID4+IFBB
R0VfU0hJRlQsIChTWl80RyAtIFNaXzMyTSkgPj4gUEFHRV9TSElGVCk7Cj4gKwo+ICsJcmV0ID0g
cGFuZnJvc3RfbW11X3BndGFibGVfYWxsb2MocGFuZnJvc3RfcHJpdik7Cj4gKwlpZiAocmV0KQo+
ICsJCWdvdG8gZXJyX3BndGFibGU7Cj4gKwo+ICsJcmV0ID0gcGFuZnJvc3Rfam9iX29wZW4ocGFu
ZnJvc3RfcHJpdik7Cj4gKwlpZiAocmV0KQo+ICsJCWdvdG8gZXJyX2pvYjsKPiArCj4gKwlyZXR1
cm4gMDsKPiArCj4gK2Vycl9qb2I6Cj4gKwlwYW5mcm9zdF9tbXVfcGd0YWJsZV9mcmVlKHBhbmZy
b3N0X3ByaXYpOwo+ICtlcnJfcGd0YWJsZToKPiArCWRybV9tbV90YWtlZG93bigmcGFuZnJvc3Rf
cHJpdi0+bW0pOwo+ICsJa2ZyZWUocGFuZnJvc3RfcHJpdik7CgpMb29rcyBsaWtlIHRoaXMga2Zy
ZWUgd2FzIG1pc3NpbmcgYmVmb3JlLi4uIDopCgo+ICsJcmV0dXJuIHJldDsKPiAgfQo+ICAKPiAg
c3RhdGljIHZvaWQKPiBAQCAtNDI0LDYgKzQ0Niw4IEBAIHBhbmZyb3N0X3Bvc3RjbG9zZShzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2LCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCj4gIAlwYW5mcm9zdF9w
ZXJmY250X2Nsb3NlKHBhbmZyb3N0X3ByaXYpOwo+ICAJcGFuZnJvc3Rfam9iX2Nsb3NlKHBhbmZy
b3N0X3ByaXYpOwo+ICAKPiArCXBhbmZyb3N0X21tdV9wZ3RhYmxlX2ZyZWUocGFuZnJvc3RfcHJp
dik7Cj4gKwlkcm1fbW1fdGFrZWRvd24oJnBhbmZyb3N0X3ByaXYtPm1tKTsKPiAgCWtmcmVlKHBh
bmZyb3N0X3ByaXYpOwo+ICB9Cj4gIAo+IEBAIC00OTYsMTQgKzUyMCw5IEBAIHN0YXRpYyBpbnQg
cGFuZnJvc3RfcHJvYmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKPiAgCWRkZXYtPmRl
dl9wcml2YXRlID0gcGZkZXY7Cj4gIAlwZmRldi0+ZGRldiA9IGRkZXY7Cj4gIAo+IC0Jc3Bpbl9s
b2NrX2luaXQoJnBmZGV2LT5tbV9sb2NrKTsKPiAgCW11dGV4X2luaXQoJnBmZGV2LT5zaHJpbmtl
cl9sb2NrKTsKPiAgCUlOSVRfTElTVF9IRUFEKCZwZmRldi0+c2hyaW5rZXJfbGlzdCk7Cj4gIAo+
IC0JLyogNEcgZW5vdWdoIGZvciBub3cuIGNhbiBiZSA0OC1iaXQgKi8KPiAtCWRybV9tbV9pbml0
KCZwZmRldi0+bW0sIFNaXzMyTSA+PiBQQUdFX1NISUZULCAoU1pfNEcgLSBTWl8zMk0pID4+IFBB
R0VfU0hJRlQpOwo+IC0JcGZkZXYtPm1tLmNvbG9yX2FkanVzdCA9IHBhbmZyb3N0X2RybV9tbV9j
b2xvcl9hZGp1c3Q7Cj4gLQo+ICAJcG1fcnVudGltZV91c2VfYXV0b3N1c3BlbmQocGZkZXYtPmRl
dik7Cj4gIAlwbV9ydW50aW1lX3NldF9hdXRvc3VzcGVuZF9kZWxheShwZmRldi0+ZGV2LCA1MCk7
IC8qIH4zIGZyYW1lcyAqLwo+ICAJcG1fcnVudGltZV9lbmFibGUocGZkZXYtPmRldik7Cj4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9nZW0uYyBiL2RyaXZl
cnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9nZW0uYwo+IGluZGV4IDM3YTNhNmVkNDYxNy4u
OTMyMDRiNDRlZjkwIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5m
cm9zdF9nZW0uYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9nZW0u
Ywo+IEBAIC00Nyw4ICs0Nyw4IEBAIHN0YXRpYyBpbnQgcGFuZnJvc3RfZ2VtX29wZW4oc3RydWN0
IGRybV9nZW1fb2JqZWN0ICpvYmosIHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wCj4gIAlzaXplX3Qg
c2l6ZSA9IG9iai0+c2l6ZTsKPiAgCXU2NCBhbGlnbjsKPiAgCXN0cnVjdCBwYW5mcm9zdF9nZW1f
b2JqZWN0ICpibyA9IHRvX3BhbmZyb3N0X2JvKG9iaik7Cj4gLQlzdHJ1Y3QgcGFuZnJvc3RfZGV2
aWNlICpwZmRldiA9IG9iai0+ZGV2LT5kZXZfcHJpdmF0ZTsKPiAgCXVuc2lnbmVkIGxvbmcgY29s
b3IgPSBiby0+bm9leGVjID8gUEFORlJPU1RfQk9fTk9FWEVDIDogMDsKPiArCXN0cnVjdCBwYW5m
cm9zdF9maWxlX3ByaXYgKnByaXYgPSBmaWxlX3ByaXYtPmRyaXZlcl9wcml2Owo+ICAKPiAgCS8q
Cj4gIAkgKiBFeGVjdXRhYmxlIGJ1ZmZlcnMgY2Fubm90IGNyb3NzIGEgMTZNQiBib3VuZGFyeSBh
cyB0aGUgcHJvZ3JhbQo+IEBAIC02MSw4ICs2MSw5IEBAIHN0YXRpYyBpbnQgcGFuZnJvc3RfZ2Vt
X29wZW4oc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmosIHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9w
Cj4gIAllbHNlCj4gIAkJYWxpZ24gPSBzaXplID49IFNaXzJNID8gU1pfMk0gPj4gUEFHRV9TSElG
VCA6IDA7Cj4gIAo+IC0Jc3Bpbl9sb2NrKCZwZmRldi0+bW1fbG9jayk7Cj4gLQlyZXQgPSBkcm1f
bW1faW5zZXJ0X25vZGVfZ2VuZXJpYygmcGZkZXYtPm1tLCAmYm8tPm5vZGUsCj4gKwliby0+bW11
ID0gJnByaXYtPm1tdTsKPiArCXNwaW5fbG9jaygmcHJpdi0+bW1fbG9jayk7Cj4gKwlyZXQgPSBk
cm1fbW1faW5zZXJ0X25vZGVfZ2VuZXJpYygmcHJpdi0+bW0sICZiby0+bm9kZSwKPiAgCQkJCQkg
c2l6ZSA+PiBQQUdFX1NISUZULCBhbGlnbiwgY29sb3IsIDApOwo+ICAJaWYgKHJldCkKPiAgCQln
b3RvIG91dDsKPiBAQCAtNzMsMjIgKzc0LDIyIEBAIHN0YXRpYyBpbnQgcGFuZnJvc3RfZ2VtX29w
ZW4oc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmosIHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wCj4g
IAkJCWRybV9tbV9yZW1vdmVfbm9kZSgmYm8tPm5vZGUpOwo+ICAJfQo+ICBvdXQ6Cj4gLQlzcGlu
X3VubG9jaygmcGZkZXYtPm1tX2xvY2spOwo+ICsJc3Bpbl91bmxvY2soJnByaXYtPm1tX2xvY2sp
Owo+ICAJcmV0dXJuIHJldDsKPiAgfQo+ICAKPiAgc3RhdGljIHZvaWQgcGFuZnJvc3RfZ2VtX2Ns
b3NlKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqLCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJp
dikKPiAgewo+ICAJc3RydWN0IHBhbmZyb3N0X2dlbV9vYmplY3QgKmJvID0gdG9fcGFuZnJvc3Rf
Ym8ob2JqKTsKPiAtCXN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2ID0gb2JqLT5kZXYtPmRl
dl9wcml2YXRlOwo+ICsJc3RydWN0IHBhbmZyb3N0X2ZpbGVfcHJpdiAqcHJpdiA9IGZpbGVfcHJp
di0+ZHJpdmVyX3ByaXY7Cj4gIAo+ICAJaWYgKGJvLT5pc19tYXBwZWQpCj4gIAkJcGFuZnJvc3Rf
bW11X3VubWFwKGJvKTsKPiAgCj4gLQlzcGluX2xvY2soJnBmZGV2LT5tbV9sb2NrKTsKPiArCXNw
aW5fbG9jaygmcHJpdi0+bW1fbG9jayk7Cj4gIAlpZiAoZHJtX21tX25vZGVfYWxsb2NhdGVkKCZi
by0+bm9kZSkpCj4gIAkJZHJtX21tX3JlbW92ZV9ub2RlKCZiby0+bm9kZSk7Cj4gLQlzcGluX3Vu
bG9jaygmcGZkZXYtPm1tX2xvY2spOwo+ICsJc3Bpbl91bmxvY2soJnByaXYtPm1tX2xvY2spOwo+
ICB9Cj4gIAo+ICBzdGF0aWMgaW50IHBhbmZyb3N0X2dlbV9waW4oc3RydWN0IGRybV9nZW1fb2Jq
ZWN0ICpvYmopCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9z
dF9nZW0uaCBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9nZW0uaAo+IGluZGV4
IGUxMGY1ODMxNjkxNS4uNTA5MjA4MTljYzE2IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9wYW5mcm9zdC9wYW5mcm9zdF9nZW0uaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9z
dC9wYW5mcm9zdF9nZW0uaAo+IEBAIC03LDEwICs3LDEzIEBACj4gICNpbmNsdWRlIDxkcm0vZHJt
X2dlbV9zaG1lbV9oZWxwZXIuaD4KPiAgI2luY2x1ZGUgPGRybS9kcm1fbW0uaD4KPiAgCj4gK3N0
cnVjdCBwYW5mcm9zdF9tbXU7Cj4gKwo+ICBzdHJ1Y3QgcGFuZnJvc3RfZ2VtX29iamVjdCB7Cj4g
IAlzdHJ1Y3QgZHJtX2dlbV9zaG1lbV9vYmplY3QgYmFzZTsKPiAgCXN0cnVjdCBzZ190YWJsZSAq
c2d0czsKPiAgCj4gKwlzdHJ1Y3QgcGFuZnJvc3RfbW11ICptbXU7Cj4gIAlzdHJ1Y3QgZHJtX21t
X25vZGUgbm9kZTsKPiAgCWJvb2wgaXNfbWFwcGVkCQk6MTsKPiAgCWJvb2wgbm9leGVjCQk6MTsK
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2pvYi5jIGIv
ZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2pvYi5jCj4gaW5kZXggZDU2N2NlOTg0
OTRjLi5hZWE4NDYxMGI4Y2QgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0
L3BhbmZyb3N0X2pvYi5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0
X2pvYi5jCj4gQEAgLTE1Myw2ICsxNTMsOCBAQCBzdGF0aWMgdm9pZCBwYW5mcm9zdF9qb2JfaHdf
c3VibWl0KHN0cnVjdCBwYW5mcm9zdF9qb2IgKmpvYiwgaW50IGpzKQo+ICAJaWYgKFdBUk5fT04o
am9iX3JlYWQocGZkZXYsIEpTX0NPTU1BTkRfTkVYVChqcykpKSkKPiAgCQlnb3RvIGVuZDsKPiAg
Cj4gKwljZmcgPSBwYW5mcm9zdF9tbXVfYXNfZ2V0KHBmZGV2LCAmam9iLT5maWxlX3ByaXYtPm1t
dSk7Cj4gKwo+ICAJcGFuZnJvc3RfZGV2ZnJlcV9yZWNvcmRfdHJhbnNpdGlvbihwZmRldiwganMp
Owo+ICAJc3Bpbl9sb2NrX2lycXNhdmUoJnBmZGV2LT5od2FjY2Vzc19sb2NrLCBmbGFncyk7Cj4g
IAo+IEBAIC0xNjMsOCArMTY1LDcgQEAgc3RhdGljIHZvaWQgcGFuZnJvc3Rfam9iX2h3X3N1Ym1p
dChzdHJ1Y3QgcGFuZnJvc3Rfam9iICpqb2IsIGludCBqcykKPiAgCj4gIAkvKiBzdGFydCBNTVUs
IG1lZGl1bSBwcmlvcml0eSwgY2FjaGUgY2xlYW4vZmx1c2ggb24gZW5kLCBjbGVhbi9mbHVzaCBv
bgo+ICAJICogc3RhcnQgKi8KPiAtCS8qIFRPRE86IGRpZmZlcmVudCBhZGRyZXNzIHNwYWNlcyAq
Lwo+IC0JY2ZnID0gSlNfQ09ORklHX1RIUkVBRF9QUkkoOCkgfAo+ICsJY2ZnIHw9IEpTX0NPTkZJ
R19USFJFQURfUFJJKDgpIHwKPiAgCQlKU19DT05GSUdfU1RBUlRfRkxVU0hfQ0xFQU5fSU5WQUxJ
REFURSB8Cj4gIAkJSlNfQ09ORklHX0VORF9GTFVTSF9DTEVBTl9JTlZBTElEQVRFOwo+ICAKPiBA
QCAtMjgwLDYgKzI4MSw5IEBAIHN0YXRpYyB2b2lkIHBhbmZyb3N0X2pvYl9jbGVhbnVwKHN0cnVj
dCBrcmVmICpyZWYpCj4gIAkJa3ZmcmVlKGpvYi0+Ym9zKTsKPiAgCX0KPiAgCj4gKwlmb3IgKGkg
PSAwOyBpIDwgTlVNX0pPQl9TTE9UUzsgaSsrKQo+ICsJCWlmIChqb2IgPT0gam9iLT5wZmRldi0+
am9ic1tpXSkKPiArCQkJam9iLT5wZmRldi0+am9ic1tpXSA9IE5VTEw7CgpJJ20gYSBiaXQgd29y
cmllZCBhYm91dCB0aGlzLiBBcyBmYXIgYXMgSSBjYW4gc2VlIHByZXZpb3VzbHkgdGhlIGpvYnMK
YXJyYXkgd291bGQganVzdCBjb250YWluIGRhbmdsaW5nIHBvaW50ZXJzIC0gd2hpY2ggYWRtaXR0
ZWRseSB3YXNuJ3QKaWRlYWwuIEhvd2V2ZXIgZG8gd2UgaGF2ZSBzdWZmaWNpZW50IGxvY2tzIGhl
cmUgdG8gZW5zdXJlIHRoYXQgdGhpcwpjb3VsZCBiZSByYWNpbmcgd2l0aCBhIHBhbmZyb3N0X2pv
Yl9ydW4oKSBvbiB0aGUgc2FtZSBzbG90PyBJJ20gd29ycmllZAp0aGF0IGJldHdlZW4gdGhlIGNo
ZWNrIGFuZCB0aGUgYXNzaWdubWVudCB0byBOVUxMIGl0IGlzIHBvc3NpYmxlCihhZG1pdHRlZGx5
IHZlcnkgdW5saWtlbHkpIGZvciBwYW5mcm9zdF9qb2JfcnVuKCkgdG8gYXNzaWduIGEgbmV3CnBv
aW50ZXIgd2hpY2ggd291bGQgdGhlbiBiZSBjbG9iYmVyZWQuCgo+ICAJa2ZyZWUoam9iKTsKPiAg
fQo+ICAKPiBAQCAtMzc3LDggKzM4MSw5IEBAIHN0YXRpYyB2b2lkIHBhbmZyb3N0X2pvYl90aW1l
ZG91dChzdHJ1Y3QgZHJtX3NjaGVkX2pvYiAqc2NoZWRfam9iKQo+ICAJaWYgKGRtYV9mZW5jZV9p
c19zaWduYWxlZChqb2ItPmRvbmVfZmVuY2UpKQo+ICAJCXJldHVybjsKPiAgCj4gLQlkZXZfZXJy
KHBmZGV2LT5kZXYsICJncHUgc2NoZWQgdGltZW91dCwganM9JWQsIHN0YXR1cz0weCV4LCBoZWFk
PTB4JXgsIHRhaWw9MHgleCwgc2NoZWRfam9iPSVwIiwKPiArCWRldl9lcnIocGZkZXYtPmRldiwg
ImdwdSBzY2hlZCB0aW1lb3V0LCBqcz0lZCwgY29uZmlnPTB4JXgsIHN0YXR1cz0weCV4LCBoZWFk
PTB4JXgsIHRhaWw9MHgleCwgc2NoZWRfam9iPSVwIiwKPiAgCQlqcywKPiArCQlqb2JfcmVhZChw
ZmRldiwgSlNfQ09ORklHKGpzKSksCj4gIAkJam9iX3JlYWQocGZkZXYsIEpTX1NUQVRVUyhqcykp
LAo+ICAJCWpvYl9yZWFkKHBmZGV2LCBKU19IRUFEX0xPKGpzKSksCj4gIAkJam9iX3JlYWQocGZk
ZXYsIEpTX1RBSUxfTE8oanMpKSwKPiBAQCAtNDQ4LDYgKzQ1Myw3IEBAIHN0YXRpYyBpcnFyZXR1
cm5fdCBwYW5mcm9zdF9qb2JfaXJxX2hhbmRsZXIoaW50IGlycSwgdm9pZCAqZGF0YSkKPiAgCQl9
Cj4gIAo+ICAJCWlmIChzdGF0dXMgJiBKT0JfSU5UX01BU0tfRE9ORShqKSkgewo+ICsJCQlwYW5m
cm9zdF9tbXVfYXNfcHV0KHBmZGV2LCAmcGZkZXYtPmpvYnNbal0tPmZpbGVfcHJpdi0+bW11KTsK
PiAgCQkJcGFuZnJvc3RfZGV2ZnJlcV9yZWNvcmRfdHJhbnNpdGlvbihwZmRldiwgaik7Cj4gIAkJ
CWRtYV9mZW5jZV9zaWduYWwocGZkZXYtPmpvYnNbal0tPmRvbmVfZmVuY2UpOwo+ICAJCX0KPiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X21tdS5jIGIvZHJp
dmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X21tdS5jCj4gaW5kZXggMmVkNDExZjA5ZDgw
Li5mOGRhNzU1N2QxYmUgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3Bh
bmZyb3N0X21tdS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X21t
dS5jCj4gQEAgLTEsNSArMSw2IEBACj4gIC8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOglHUEwt
Mi4wCj4gIC8qIENvcHlyaWdodCAyMDE5IExpbmFybywgTHRkLCBSb2IgSGVycmluZyA8cm9iaEBr
ZXJuZWwub3JnPiAqLwo+ICsjaW5jbHVkZSA8bGludXgvYXRvbWljLmg+Cj4gICNpbmNsdWRlIDxs
aW51eC9iaXRmaWVsZC5oPgo+ICAjaW5jbHVkZSA8bGludXgvZGVsYXkuaD4KPiAgI2luY2x1ZGUg
PGxpbnV4L2RtYS1tYXBwaW5nLmg+Cj4gQEAgLTIyLDEyICsyMyw2IEBACj4gICNkZWZpbmUgbW11
X3dyaXRlKGRldiwgcmVnLCBkYXRhKSB3cml0ZWwoZGF0YSwgZGV2LT5pb21lbSArIHJlZykKPiAg
I2RlZmluZSBtbXVfcmVhZChkZXYsIHJlZykgcmVhZGwoZGV2LT5pb21lbSArIHJlZykKPiAgCj4g
LXN0cnVjdCBwYW5mcm9zdF9tbXUgewo+IC0Jc3RydWN0IGlvX3BndGFibGVfY2ZnIHBndGJsX2Nm
ZzsKPiAtCXN0cnVjdCBpb19wZ3RhYmxlX29wcyAqcGd0Ymxfb3BzOwo+IC0Jc3RydWN0IG11dGV4
IGxvY2s7Cj4gLX07Cj4gLQo+ICBzdGF0aWMgaW50IHdhaXRfcmVhZHkoc3RydWN0IHBhbmZyb3N0
X2RldmljZSAqcGZkZXYsIHUzMiBhc19ucikKPiAgewo+ICAJaW50IHJldDsKPiBAQCAtOTEsNiAr
ODYsOSBAQCBzdGF0aWMgaW50IG1tdV9od19kb19vcGVyYXRpb24oc3RydWN0IHBhbmZyb3N0X2Rl
dmljZSAqcGZkZXYsIHUzMiBhc19uciwKPiAgCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gIAlpbnQg
cmV0Owo+ICAKPiArCWlmIChhc19uciA8IDApCj4gKwkJcmV0dXJuIDA7Cj4gKwoKRG8gd2UgbmVl
ZCBhbnkgc3luY2hyb25pc2F0aW9uIHdpdGggcGFuZnJvc3RfbW11X2FzX2dldCgpIGZvciB0aGlz
IHRvIGJlCnJlbGlhYmxlPyBBcyBmYXIgYXMgSSBjYW4gc2VlIHRoaXMgY2hlY2sgY2FuIHJhY2Ug
d2l0aCB0aGUgYXNzaWdubWVudCBvZgphbiBhZGRyZXNzIHNwYWNlLiBQZXJoYXBzIHBhbmZyb3N0
X21tdV9hc19nZXQoKSAob3IgbWF5YmUKcGFuZnJvc3RfbW11X2VuYWJsZSkgc2hvdWxkIGhvbGQg
bW11LT5sb2NrPwoKPiAgCXNwaW5fbG9ja19pcnFzYXZlKCZwZmRldi0+aHdhY2Nlc3NfbG9jaywg
ZmxhZ3MpOwo+ICAKPiAgCWlmIChvcCAhPSBBU19DT01NQU5EX1VOTE9DSykKPiBAQCAtMTA3LDkg
KzEwNSwxMCBAQCBzdGF0aWMgaW50IG1tdV9od19kb19vcGVyYXRpb24oc3RydWN0IHBhbmZyb3N0
X2RldmljZSAqcGZkZXYsIHUzMiBhc19uciwKPiAgCXJldHVybiByZXQ7Cj4gIH0KPiAgCj4gLXN0
YXRpYyB2b2lkIHBhbmZyb3N0X21tdV9lbmFibGUoc3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZk
ZXYsIHUzMiBhc19ucikKPiArc3RhdGljIHZvaWQgcGFuZnJvc3RfbW11X2VuYWJsZShzdHJ1Y3Qg
cGFuZnJvc3RfZGV2aWNlICpwZmRldiwgc3RydWN0IHBhbmZyb3N0X21tdSAqbW11KQo+ICB7Cj4g
LQlzdHJ1Y3QgaW9fcGd0YWJsZV9jZmcgKmNmZyA9ICZwZmRldi0+bW11LT5wZ3RibF9jZmc7Cj4g
KwlpbnQgYXNfbnIgPSBtbXUtPmFzOwo+ICsJc3RydWN0IGlvX3BndGFibGVfY2ZnICpjZmcgPSAm
bW11LT5wZ3RibF9jZmc7Cj4gIAl1NjQgdHJhbnN0YWIgPSBjZmctPmFybV9tYWxpX2xwYWVfY2Zn
LnRyYW5zdGFiOwo+ICAJdTY0IG1lbWF0dHIgPSBjZmctPmFybV9tYWxpX2xwYWVfY2ZnLm1lbWF0
dHI7Cj4gIAo+IEBAIC0xMzYsOSArMTM1LDg3IEBAIHN0YXRpYyB2b2lkIG1tdV9kaXNhYmxlKHN0
cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2LCB1MzIgYXNfbnIpCj4gIAl3cml0ZV9jbWQocGZk
ZXYsIGFzX25yLCBBU19DT01NQU5EX1VQREFURSk7Cj4gIH0KPiAgCj4gK3UzMiBwYW5mcm9zdF9t
bXVfYXNfZ2V0KHN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2LCBzdHJ1Y3QgcGFuZnJvc3Rf
bW11ICptbXUpCj4gK3sKPiArCWludCBhcyA9IG1tdS0+YXM7Cj4gKwo+ICsJc3Bpbl9sb2NrKCZw
ZmRldi0+YXNfbG9jayk7Cj4gKwo+ICsJYXMgPSBtbXUtPmFzOwo+ICsJaWYgKGFzID49IDApIHsK
PiArCQlpbnQgZW4gPSBhdG9taWNfZmV0Y2hfaW5jKCZtbXUtPmFzX2NvdW50KTsKPiArCQlXQVJO
X09OKGVuID4gMik7Cj4gKwo+ICsJCWxpc3RfbW92ZSgmbW11LT5saXN0LCAmcGZkZXYtPmFzX2xy
dV9saXN0KTsKPiArCQlzcGluX3VubG9jaygmcGZkZXYtPmFzX2xvY2spOwo+ICsJCWlmICghZW4p
Cj4gKwkJCXBhbmZyb3N0X21tdV9lbmFibGUocGZkZXYsIG1tdSk7CgpJIGRvbid0IHNlZSB3aHkg
d2UgbmVlZCB0byByZS1lbmFibGUgaGVyZSAtIGlmIChhcyA+PSAwKSB0aGVuIHRoZSBBUwpzaG91
bGQgYmUgcHJlc2VudCBvbiB0aGUgR1BVIGFuZCBtbXVfaHdfZG9fb3BlcmF0aW9uKCkgd2lsbCBo
YXZlIGJlZW4KZG9pbmcgYW55IG5lY2Vzc2FyeSBNTVUgY29tbWFuZHMuCgo+ICsJCXJldHVybiBh
czsKPiArCX0KPiArCj4gKwkvKiBDaGVjayBmb3IgYSBmcmVlIEFTICovCj4gKwlhcyA9IGZmeihw
ZmRldi0+YXNfYWxsb2NfbWFzayk7Cj4gKwlpZiAoIShCSVQoYXMpICYgcGZkZXYtPmZlYXR1cmVz
LmFzX3ByZXNlbnQpKSB7Cj4gKwkJc3RydWN0IHBhbmZyb3N0X21tdSAqbHJ1X21tdTsKPiArCj4g
KwkJbGlzdF9mb3JfZWFjaF9lbnRyeV9yZXZlcnNlKGxydV9tbXUsICZwZmRldi0+YXNfbHJ1X2xp
c3QsIGxpc3QpIHsKPiArCQkJaWYgKCFhdG9taWNfcmVhZCgmbHJ1X21tdS0+YXNfY291bnQpKQo+
ICsJCQkJYnJlYWs7Cj4gKwkJfQo+ICsJCVdBUk5fT04oIWxydV9tbXUpOwo+ICsKPiArCQlsaXN0
X2RlbF9pbml0KCZscnVfbW11LT5saXN0KTsKPiArCQlhcyA9IGxydV9tbXUtPmFzOwo+ICsKPiAr
CQlXQVJOX09OKGFzIDwgMCk7Cj4gKwkJbHJ1X21tdS0+YXMgPSAtMTsKClRoaXMgc2hvdWxkIGJl
IGhvbGRpbmcgYSBsb2NrIHRvIHN5bmNocm9uaXNlIHdpdGggdGhlIG1tdV9od19kb19vcGVyYXRp
b24oKS4KCj4gKwl9Cj4gKwo+ICsJLyogQXNzaWduIHRoZSBmcmVlIG9yIHJlY2xhaW1lZCBBUyB0
byB0aGUgICovCj4gKwltbXUtPmFzID0gYXM7Cj4gKwlzZXRfYml0KGFzLCAmcGZkZXYtPmFzX2Fs
bG9jX21hc2spOwo+ICsJYXRvbWljX3NldCgmbW11LT5hc19jb3VudCwgMSk7Cj4gKwlsaXN0X2Fk
ZCgmbW11LT5saXN0LCAmcGZkZXYtPmFzX2xydV9saXN0KTsKPiArCj4gKwlkZXZfZGJnKHBmZGV2
LT5kZXYsICJBc3NpZ25lZCBBUyVkIHRvIG1tdSAlcCwgYWxsb2NfbWFzaz0lbHgiLCBhcywgbW11
LCBwZmRldi0+YXNfYWxsb2NfbWFzayk7Cj4gKwo+ICsJc3Bpbl91bmxvY2soJnBmZGV2LT5hc19s
b2NrKTsKPiArCj4gKwlwYW5mcm9zdF9tbXVfZW5hYmxlKHBmZGV2LCBtbXUpOwo+ICsJcmV0dXJu
IGFzOwo+ICt9Cj4gKwo+ICt2b2lkIHBhbmZyb3N0X21tdV9hc19wdXQoc3RydWN0IHBhbmZyb3N0
X2RldmljZSAqcGZkZXYsIHN0cnVjdCBwYW5mcm9zdF9tbXUgKm1tdSkKPiArewo+ICsJYXRvbWlj
X2RlYygmbW11LT5hc19jb3VudCk7Cj4gKwlXQVJOX09OKGF0b21pY19yZWFkKCZtbXUtPmFzX2Nv
dW50KSA8IDApOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBwYW5mcm9zdF9tbXVfYXNfcmVzZXQo
c3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYsIHN0cnVjdCBwYW5mcm9zdF9tbXUgKm1tdSkK
PiArewo+ICsJc3Bpbl9sb2NrKCZwZmRldi0+YXNfbG9jayk7Cj4gKwo+ICsJYXRvbWljX3NldCgm
bW11LT5hc19jb3VudCwgMCk7Cj4gKwlpZiAobW11LT5hcyA+PSAwKSB7Cj4gKwkJY2xlYXJfYml0
KG1tdS0+YXMsICZwZmRldi0+YXNfYWxsb2NfbWFzayk7Cj4gKwkJbGlzdF9kZWxfaW5pdCgmbW11
LT5saXN0KTsKPiArCQltbXUtPmFzID0gLTE7Cj4gKwl9Cj4gKwo+ICsJc3Bpbl91bmxvY2soJnBm
ZGV2LT5hc19sb2NrKTsKPiArfQo+ICsKPiAgdm9pZCBwYW5mcm9zdF9tbXVfcmVzZXQoc3RydWN0
IHBhbmZyb3N0X2RldmljZSAqcGZkZXYpCj4gIHsKPiAtCXBhbmZyb3N0X21tdV9lbmFibGUocGZk
ZXYsIDApOwo+ICsJc3RydWN0IGRybV9maWxlICpmaWxlOwo+ICsKPiArCW11dGV4X2xvY2soJnBm
ZGV2LT5kZGV2LT5maWxlbGlzdF9tdXRleCk7Cj4gKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KGZpbGUs
ICZwZmRldi0+ZGRldi0+ZmlsZWxpc3QsIGxoZWFkKSB7Cj4gKwkJc3RydWN0IHBhbmZyb3N0X2Zp
bGVfcHJpdiAqcHJpdiA9IGZpbGUtPmRyaXZlcl9wcml2Owo+ICsKPiArCQlwYW5mcm9zdF9tbXVf
YXNfcmVzZXQocGZkZXYsICZwcml2LT5tbXUpOwo+ICsJfQo+ICsJbXV0ZXhfdW5sb2NrKCZwZmRl
di0+ZGRldi0+ZmlsZWxpc3RfbXV0ZXgpOwo+ICAKPiAgCW1tdV93cml0ZShwZmRldiwgTU1VX0lO
VF9DTEVBUiwgfjApOwo+ICAJbW11X3dyaXRlKHBmZGV2LCBNTVVfSU5UX01BU0ssIH4wKTsKPiBA
QCAtMTUyLDIxICsyMjksMjEgQEAgc3RhdGljIHNpemVfdCBnZXRfcGdzaXplKHU2NCBhZGRyLCBz
aXplX3Qgc2l6ZSkKPiAgCXJldHVybiBTWl8yTTsKPiAgfQo+ICAKPiAtc3RhdGljIGludCBtbXVf
bWFwX3NnKHN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2LCB1NjQgaW92YSwKPiAtCQkgICAg
ICBpbnQgcHJvdCwgc3RydWN0IHNnX3RhYmxlICpzZ3QpCj4gK3N0YXRpYyBpbnQgbW11X21hcF9z
ZyhzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldiwgc3RydWN0IHBhbmZyb3N0X21tdSAqbW11
LAo+ICsJCSAgICAgIHU2NCBpb3ZhLCBpbnQgcHJvdCwgc3RydWN0IHNnX3RhYmxlICpzZ3QpCj4g
IHsKPiAgCXVuc2lnbmVkIGludCBjb3VudDsKPiAgCXN0cnVjdCBzY2F0dGVybGlzdCAqc2dsOwo+
IC0Jc3RydWN0IGlvX3BndGFibGVfb3BzICpvcHMgPSBwZmRldi0+bW11LT5wZ3RibF9vcHM7Cj4g
KwlzdHJ1Y3QgaW9fcGd0YWJsZV9vcHMgKm9wcyA9IG1tdS0+cGd0Ymxfb3BzOwo+ICAJdTY0IHN0
YXJ0X2lvdmEgPSBpb3ZhOwo+ICAKPiAtCW11dGV4X2xvY2soJnBmZGV2LT5tbXUtPmxvY2spOwo+
ICsJbXV0ZXhfbG9jaygmbW11LT5sb2NrKTsKPiAgCj4gIAlmb3JfZWFjaF9zZyhzZ3QtPnNnbCwg
c2dsLCBzZ3QtPm5lbnRzLCBjb3VudCkgewo+ICAJCXVuc2lnbmVkIGxvbmcgcGFkZHIgPSBzZ19k
bWFfYWRkcmVzcyhzZ2wpOwo+ICAJCXNpemVfdCBsZW4gPSBzZ19kbWFfbGVuKHNnbCk7Cj4gIAo+
IC0JCWRldl9kYmcocGZkZXYtPmRldiwgIm1hcDogaW92YT0lbGx4LCBwYWRkcj0lbHgsIGxlbj0l
engiLCBpb3ZhLCBwYWRkciwgbGVuKTsKPiArCQlkZXZfZGJnKHBmZGV2LT5kZXYsICJtYXA6IGFz
PSVkLCBpb3ZhPSVsbHgsIHBhZGRyPSVseCwgbGVuPSV6eCIsIG1tdS0+YXMsIGlvdmEsIHBhZGRy
LCBsZW4pOwo+ICAKPiAgCQl3aGlsZSAobGVuKSB7Cj4gIAkJCXNpemVfdCBwZ3NpemUgPSBnZXRf
cGdzaXplKGlvdmEgfCBwYWRkciwgbGVuKTsKPiBAQCAtMTc4LDEwICsyNTUsMTAgQEAgc3RhdGlj
IGludCBtbXVfbWFwX3NnKHN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2LCB1NjQgaW92YSwK
PiAgCQl9Cj4gIAl9Cj4gIAo+IC0JbW11X2h3X2RvX29wZXJhdGlvbihwZmRldiwgMCwgc3RhcnRf
aW92YSwgaW92YSAtIHN0YXJ0X2lvdmEsCj4gKwltbXVfaHdfZG9fb3BlcmF0aW9uKHBmZGV2LCBt
bXUtPmFzLCBzdGFydF9pb3ZhLCBpb3ZhIC0gc3RhcnRfaW92YSwKPiAgCQkJICAgIEFTX0NPTU1B
TkRfRkxVU0hfUFQpOwo+ICAKPiAtCW11dGV4X3VubG9jaygmcGZkZXYtPm1tdS0+bG9jayk7Cj4g
KwltdXRleF91bmxvY2soJm1tdS0+bG9jayk7Cj4gIAo+ICAJcmV0dXJuIDA7Cj4gIH0KPiBAQCAt
MjA4LDcgKzI4NSw3IEBAIGludCBwYW5mcm9zdF9tbXVfbWFwKHN0cnVjdCBwYW5mcm9zdF9nZW1f
b2JqZWN0ICpibykKPiAgCWlmIChyZXQgPCAwKQo+ICAJCXJldHVybiByZXQ7Cj4gIAo+IC0JbW11
X21hcF9zZyhwZmRldiwgYm8tPm5vZGUuc3RhcnQgPDwgUEFHRV9TSElGVCwgcHJvdCwgc2d0KTsK
PiArCW1tdV9tYXBfc2cocGZkZXYsIGJvLT5tbXUsIGJvLT5ub2RlLnN0YXJ0IDw8IFBBR0VfU0hJ
RlQsIHByb3QsIHNndCk7Cj4gIAo+ICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShwZmRldi0+
ZGV2KTsKPiAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKHBmZGV2LT5kZXYpOwo+IEBAIC0y
MjEsNyArMjk4LDcgQEAgdm9pZCBwYW5mcm9zdF9tbXVfdW5tYXAoc3RydWN0IHBhbmZyb3N0X2dl
bV9vYmplY3QgKmJvKQo+ICB7Cj4gIAlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iaiA9ICZiby0+
YmFzZS5iYXNlOwo+ICAJc3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYgPSB0b19wYW5mcm9z
dF9kZXZpY2Uob2JqLT5kZXYpOwo+IC0Jc3RydWN0IGlvX3BndGFibGVfb3BzICpvcHMgPSBwZmRl
di0+bW11LT5wZ3RibF9vcHM7Cj4gKwlzdHJ1Y3QgaW9fcGd0YWJsZV9vcHMgKm9wcyA9IGJvLT5t
bXUtPnBndGJsX29wczsKPiAgCXU2NCBpb3ZhID0gYm8tPm5vZGUuc3RhcnQgPDwgUEFHRV9TSElG
VDsKPiAgCXNpemVfdCBsZW4gPSBiby0+bm9kZS5zaXplIDw8IFBBR0VfU0hJRlQ7Cj4gIAlzaXpl
X3QgdW5tYXBwZWRfbGVuID0gMDsKPiBAQCAtMjMwLDEzICszMDcsMTMgQEAgdm9pZCBwYW5mcm9z
dF9tbXVfdW5tYXAoc3RydWN0IHBhbmZyb3N0X2dlbV9vYmplY3QgKmJvKQo+ICAJaWYgKFdBUk5f
T04oIWJvLT5pc19tYXBwZWQpKQo+ICAJCXJldHVybjsKPiAgCj4gLQlkZXZfZGJnKHBmZGV2LT5k
ZXYsICJ1bm1hcDogaW92YT0lbGx4LCBsZW49JXp4IiwgaW92YSwgbGVuKTsKPiArCWRldl9kYmco
cGZkZXYtPmRldiwgInVubWFwOiBhcz0lZCwgaW92YT0lbGx4LCBsZW49JXp4IiwgYm8tPm1tdS0+
YXMsIGlvdmEsIGxlbik7Cj4gIAo+ICAJcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhwZmRldi0+
ZGV2KTsKPiAgCWlmIChyZXQgPCAwKQo+ICAJCXJldHVybjsKPiAgCj4gLQltdXRleF9sb2NrKCZw
ZmRldi0+bW11LT5sb2NrKTsKPiArCW11dGV4X2xvY2soJmJvLT5tbXUtPmxvY2spOwo+ICAKPiAg
CXdoaWxlICh1bm1hcHBlZF9sZW4gPCBsZW4pIHsKPiAgCQlzaXplX3QgdW5tYXBwZWRfcGFnZTsK
PiBAQCAtMjUwLDEwICszMjcsMTAgQEAgdm9pZCBwYW5mcm9zdF9tbXVfdW5tYXAoc3RydWN0IHBh
bmZyb3N0X2dlbV9vYmplY3QgKmJvKQo+ICAJCXVubWFwcGVkX2xlbiArPSBwZ3NpemU7Cj4gIAl9
Cj4gIAo+IC0JbW11X2h3X2RvX29wZXJhdGlvbihwZmRldiwgMCwgYm8tPm5vZGUuc3RhcnQgPDwg
UEFHRV9TSElGVCwKPiArCW1tdV9od19kb19vcGVyYXRpb24ocGZkZXYsIGJvLT5tbXUtPmFzLCBi
by0+bm9kZS5zdGFydCA8PCBQQUdFX1NISUZULAo+ICAJCQkgICAgYm8tPm5vZGUuc2l6ZSA8PCBQ
QUdFX1NISUZULCBBU19DT01NQU5EX0ZMVVNIX1BUKTsKPiAgCj4gLQltdXRleF91bmxvY2soJnBm
ZGV2LT5tbXUtPmxvY2spOwo+ICsJbXV0ZXhfdW5sb2NrKCZiby0+bW11LT5sb2NrKTsKPiAgCj4g
IAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KHBmZGV2LT5kZXYpOwo+ICAJcG1fcnVudGltZV9w
dXRfYXV0b3N1c3BlbmQocGZkZXYtPmRldik7Cj4gQEAgLTI2Miw5ICszMzksMTAgQEAgdm9pZCBw
YW5mcm9zdF9tbXVfdW5tYXAoc3RydWN0IHBhbmZyb3N0X2dlbV9vYmplY3QgKmJvKQo+ICAKPiAg
c3RhdGljIHZvaWQgbW11X3RsYl9pbnZfY29udGV4dF9zMSh2b2lkICpjb29raWUpCj4gIHsKPiAt
CXN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2ID0gY29va2llOwo+ICsJc3RydWN0IHBhbmZy
b3N0X2ZpbGVfcHJpdiAqcHJpdiA9IGNvb2tpZTsKPiAgCj4gLQltbXVfaHdfZG9fb3BlcmF0aW9u
KHBmZGV2LCAwLCAwLCB+MFVMLCBBU19DT01NQU5EX0ZMVVNIX01FTSk7Cj4gKwkvKiBPbmx5IGZs
dXNoIGlmIHdlIGhhdmUgYW4gYXNzaWduZWQgQVMgKi8KCkknbSBub3Qgc3VyZSBpZiB0aGlzIGNv
bW1lbnQgbWFrZXMgc2Vuc2UgaGVyZSAtIHNlZW1zIGxpa2UgaXQgYmVsb25ncyBpbgptbXVfaHdf
ZG9fb3BlcmF0aW9uKCkKCj4gKwltbXVfaHdfZG9fb3BlcmF0aW9uKHByaXYtPnBmZGV2LCBwcml2
LT5tbXUuYXMsIDAsIH4wVUwsIEFTX0NPTU1BTkRfRkxVU0hfTUVNKTsKPiAgfQo+ICAKPiAgc3Rh
dGljIHZvaWQgbW11X3RsYl9pbnZfcmFuZ2Vfbm9zeW5jKHVuc2lnbmVkIGxvbmcgaW92YSwgc2l6
ZV90IHNpemUsCj4gQEAgLTI4MywxNiArMzYxLDY5IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaW9t
bXVfZ2F0aGVyX29wcyBtbXVfdGxiX29wcyA9IHsKPiAgCS50bGJfc3luYwk9IG1tdV90bGJfc3lu
Y19jb250ZXh0LAo+ICB9Owo+ICAKPiAraW50IHBhbmZyb3N0X21tdV9wZ3RhYmxlX2FsbG9jKHN0
cnVjdCBwYW5mcm9zdF9maWxlX3ByaXYgKnByaXYpCj4gK3sKPiArCXN0cnVjdCBwYW5mcm9zdF9t
bXUgKm1tdSA9ICZwcml2LT5tbXU7Cj4gKwlzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldiA9
IHByaXYtPnBmZGV2Owo+ICsKPiArCW11dGV4X2luaXQoJm1tdS0+bG9jayk7Cj4gKwlJTklUX0xJ
U1RfSEVBRCgmbW11LT5saXN0KTsKPiArCW1tdS0+YXMgPSAtMTsKPiArCj4gKwltbXUtPnBndGJs
X2NmZyA9IChzdHJ1Y3QgaW9fcGd0YWJsZV9jZmcpIHsKPiArCQkucGdzaXplX2JpdG1hcAk9IFNa
XzRLIHwgU1pfMk0sCj4gKwkJLmlhcwkJPSBGSUVMRF9HRVQoMHhmZiwgcGZkZXYtPmZlYXR1cmVz
Lm1tdV9mZWF0dXJlcyksCj4gKwkJLm9hcwkJPSBGSUVMRF9HRVQoMHhmZjAwLCBwZmRldi0+ZmVh
dHVyZXMubW11X2ZlYXR1cmVzKSwKPiArCQkudGxiCQk9ICZtbXVfdGxiX29wcywKPiArCQkuaW9t
bXVfZGV2CT0gcGZkZXYtPmRldiwKPiArCX07Cj4gKwo+ICsJbW11LT5wZ3RibF9vcHMgPSBhbGxv
Y19pb19wZ3RhYmxlX29wcyhBUk1fTUFMSV9MUEFFLCAmbW11LT5wZ3RibF9jZmcsCj4gKwkJCQkJ
ICAgICAgcHJpdik7Cj4gKwlpZiAoIW1tdS0+cGd0Ymxfb3BzKQo+ICsJCXJldHVybiAtRUlOVkFM
Owo+ICsKPiArCXJldHVybiAwOwo+ICt9Cj4gKwo+ICt2b2lkIHBhbmZyb3N0X21tdV9wZ3RhYmxl
X2ZyZWUoc3RydWN0IHBhbmZyb3N0X2ZpbGVfcHJpdiAqcHJpdikKPiArewo+ICsJc3RydWN0IHBh
bmZyb3N0X2RldmljZSAqcGZkZXYgPSBwcml2LT5wZmRldjsKPiArCXN0cnVjdCBwYW5mcm9zdF9t
bXUgKm1tdSA9ICZwcml2LT5tbXU7Cj4gKwo+ICsJc3Bpbl9sb2NrKCZwZmRldi0+YXNfbG9jayk7
Cj4gKwlpZiAobW11LT5hcyA+PSAwKSB7Cj4gKwkJY2xlYXJfYml0KG1tdS0+YXMsICZwZmRldi0+
YXNfYWxsb2NfbWFzayk7Cj4gKwkJY2xlYXJfYml0KG1tdS0+YXMsICZwZmRldi0+YXNfaW5fdXNl
X21hc2spOwo+ICsJCWxpc3RfZGVsKCZtbXUtPmxpc3QpOwo+ICsJfQo+ICsJc3Bpbl91bmxvY2so
JnBmZGV2LT5hc19sb2NrKTsKPiArCj4gKwlmcmVlX2lvX3BndGFibGVfb3BzKG1tdS0+cGd0Ymxf
b3BzKTsKPiArfQo+ICsKPiAgc3RhdGljIHN0cnVjdCBkcm1fbW1fbm9kZSAqYWRkcl90b19kcm1f
bW1fbm9kZShzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldiwgaW50IGFzLCB1NjQgYWRkcikK
PiAgewo+IC0Jc3RydWN0IGRybV9tbV9ub2RlICpub2RlOwo+ICsJc3RydWN0IGRybV9tbV9ub2Rl
ICpub2RlID0gTlVMTDsKPiAgCXU2NCBvZmZzZXQgPSBhZGRyID4+IFBBR0VfU0hJRlQ7Cj4gKwlz
dHJ1Y3QgZHJtX2ZpbGUgKmZpbGU7Cj4gIAo+IC0JZHJtX21tX2Zvcl9lYWNoX25vZGUobm9kZSwg
JnBmZGV2LT5tbSkgewo+IC0JCWlmIChvZmZzZXQgPj0gbm9kZS0+c3RhcnQgJiYgb2Zmc2V0IDwg
KG5vZGUtPnN0YXJ0ICsgbm9kZS0+c2l6ZSkpCj4gLQkJCXJldHVybiBub2RlOwo+ICsJbXV0ZXhf
bG9jaygmcGZkZXYtPmRkZXYtPmZpbGVsaXN0X211dGV4KTsKPiArCWxpc3RfZm9yX2VhY2hfZW50
cnkoZmlsZSwgJnBmZGV2LT5kZGV2LT5maWxlbGlzdCwgbGhlYWQpIHsKCllvdSBjb3VsZCB3YWxr
IGFzX2xydV9saXN0IHJhdGhlciB0aGFuIGV2ZXJ5IGZpbGUgYXMgeW91IGtub3cgeW91IGFyZQps
b29raW5nIGZvciBhIGZkIHdoaWNoIGlzIGFzc2lnbmVkIGFuIGFkZHJlc3Mgc3BhY2UuCgo+ICsJ
CXN0cnVjdCBwYW5mcm9zdF9maWxlX3ByaXYgKnByaXYgPSBmaWxlLT5kcml2ZXJfcHJpdjsKPiAr
Cj4gKwkJaWYgKGFzICE9IHByaXYtPm1tdS5hcykKPiArCQkJY29udGludWU7Cj4gKwo+ICsJCWRy
bV9tbV9mb3JfZWFjaF9ub2RlKG5vZGUsICZwcml2LT5tbSkgewo+ICsJCQlpZiAob2Zmc2V0ID49
IG5vZGUtPnN0YXJ0ICYmIG9mZnNldCA8IChub2RlLT5zdGFydCArIG5vZGUtPnNpemUpKQo+ICsJ
CQkJZ290byBvdXQ7Cj4gKwkJfQo+ICAJfQo+IC0JcmV0dXJuIE5VTEw7Cj4gKwo+ICtvdXQ6Cj4g
KwltdXRleF91bmxvY2soJnBmZGV2LT5kZGV2LT5maWxlbGlzdF9tdXRleCk7Cj4gKwlyZXR1cm4g
bm9kZTsKPiAgfQo+ICAKPiAgI2RlZmluZSBOVU1fRkFVTFRfUEFHRVMgKFNaXzJNIC8gUEFHRV9T
SVpFKQo+IEBAIC0zMTcsNiArNDQ4LDggQEAgaW50IHBhbmZyb3N0X21tdV9tYXBfZmF1bHRfYWRk
cihzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldiwgaW50IGFzLCB1NjQgYWRkcikKPiAgCQkJ
IG5vZGUtPnN0YXJ0IDw8IFBBR0VfU0hJRlQpOwo+ICAJCXJldHVybiAtRUlOVkFMOwo+ICAJfQo+
ICsJV0FSTl9PTihiby0+bW11LT5hcyA9PSAtMSk7CgpZb3UgY291bGQgc3RyZW5ndGhlbiB0aGlz
IHRvIFdBUk5fT04oYm8tPm1tdS0+YXMgIT0gYXMpCgo+ICsKPiAgCS8qIEFzc3VtZSAyTUIgYWxp
Z25tZW50IGFuZCBzaXplIG11bHRpcGxlICovCj4gIAlhZGRyICY9IH4oKHU2NClTWl8yTSAtIDEp
Owo+ICAJcGFnZV9vZmZzZXQgPSBhZGRyID4+IFBBR0VfU0hJRlQ7Cj4gQEAgLTM2NywxMSArNTAw
LDExIEBAIGludCBwYW5mcm9zdF9tbXVfbWFwX2ZhdWx0X2FkZHIoc3RydWN0IHBhbmZyb3N0X2Rl
dmljZSAqcGZkZXYsIGludCBhcywgdTY0IGFkZHIpCj4gIAkJZ290byBlcnJfbWFwOwo+ICAJfQo+
ICAKPiAtCW1tdV9tYXBfc2cocGZkZXYsIGFkZHIsIElPTU1VX1dSSVRFIHwgSU9NTVVfUkVBRCB8
IElPTU1VX05PRVhFQywgc2d0KTsKPiArCW1tdV9tYXBfc2cocGZkZXYsIGJvLT5tbXUsIGFkZHIs
IElPTU1VX1dSSVRFIHwgSU9NTVVfUkVBRCB8IElPTU1VX05PRVhFQywgc2d0KTsKPiAgCj4gIAli
by0+aXNfbWFwcGVkID0gdHJ1ZTsKPiAgCj4gLQlkZXZfZGJnKHBmZGV2LT5kZXYsICJtYXBwZWQg
cGFnZSBmYXVsdCBAICVsbHgiLCBhZGRyKTsKPiArCWRldl9kYmcocGZkZXYtPmRldiwgIm1hcHBl
ZCBwYWdlIGZhdWx0IEAgQVMlZCAlbGx4IiwgYm8tPm1tdS0+YXMsIGFkZHIpOwoKQXNzdW1pbmcg
dGhlIGFib3ZlIFdBUk5fT04gc3RyZW5ndGhpbmcgdGhlbjogcy9iby0+bW11LT5hcy9hcy8KClN0
ZXZlCgo+ICAKPiAgCXJldHVybiAwOwo+ICAKPiBAQCAtNDgwLDE1ICs2MTMsOCBAQCBzdGF0aWMg
aXJxcmV0dXJuX3QgcGFuZnJvc3RfbW11X2lycV9oYW5kbGVyX3RocmVhZChpbnQgaXJxLCB2b2lk
ICpkYXRhKQo+ICAKPiAgaW50IHBhbmZyb3N0X21tdV9pbml0KHN0cnVjdCBwYW5mcm9zdF9kZXZp
Y2UgKnBmZGV2KQo+ICB7Cj4gLQlzdHJ1Y3QgaW9fcGd0YWJsZV9vcHMgKnBndGJsX29wczsKPiAg
CWludCBlcnIsIGlycTsKPiAgCj4gLQlwZmRldi0+bW11ID0gZGV2bV9remFsbG9jKHBmZGV2LT5k
ZXYsIHNpemVvZigqcGZkZXYtPm1tdSksIEdGUF9LRVJORUwpOwo+IC0JaWYgKCFwZmRldi0+bW11
KQo+IC0JCXJldHVybiAtRU5PTUVNOwo+IC0KPiAtCW11dGV4X2luaXQoJnBmZGV2LT5tbXUtPmxv
Y2spOwo+IC0KPiAgCWlycSA9IHBsYXRmb3JtX2dldF9pcnFfYnluYW1lKHRvX3BsYXRmb3JtX2Rl
dmljZShwZmRldi0+ZGV2KSwgIm1tdSIpOwo+ICAJaWYgKGlycSA8PSAwKQo+ICAJCXJldHVybiAt
RU5PREVWOwo+IEBAIC01MDEsMjIgKzYyNyw2IEBAIGludCBwYW5mcm9zdF9tbXVfaW5pdChzdHJ1
Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldikKPiAgCQlkZXZfZXJyKHBmZGV2LT5kZXYsICJmYWls
ZWQgdG8gcmVxdWVzdCBtbXUgaXJxIik7Cj4gIAkJcmV0dXJuIGVycjsKPiAgCX0KPiAtCXBmZGV2
LT5tbXUtPnBndGJsX2NmZyA9IChzdHJ1Y3QgaW9fcGd0YWJsZV9jZmcpIHsKPiAtCQkucGdzaXpl
X2JpdG1hcAk9IFNaXzRLIHwgU1pfMk0sCj4gLQkJLmlhcwkJPSBGSUVMRF9HRVQoMHhmZiwgcGZk
ZXYtPmZlYXR1cmVzLm1tdV9mZWF0dXJlcyksCj4gLQkJLm9hcwkJPSBGSUVMRF9HRVQoMHhmZjAw
LCBwZmRldi0+ZmVhdHVyZXMubW11X2ZlYXR1cmVzKSwKPiAtCQkudGxiCQk9ICZtbXVfdGxiX29w
cywKPiAtCQkuaW9tbXVfZGV2CT0gcGZkZXYtPmRldiwKPiAtCX07Cj4gLQo+IC0JcGd0Ymxfb3Bz
ID0gYWxsb2NfaW9fcGd0YWJsZV9vcHMoQVJNX01BTElfTFBBRSwgJnBmZGV2LT5tbXUtPnBndGJs
X2NmZywKPiAtCQkJCQkgcGZkZXYpOwo+IC0JaWYgKCFwZ3RibF9vcHMpCj4gLQkJcmV0dXJuIC1F
Tk9NRU07Cj4gLQo+IC0JcGZkZXYtPm1tdS0+cGd0Ymxfb3BzID0gcGd0Ymxfb3BzOwo+IC0KPiAt
CXBhbmZyb3N0X21tdV9lbmFibGUocGZkZXYsIDApOwo+ICAKPiAgCXJldHVybiAwOwo+ICB9Cj4g
QEAgLTUyNSw2ICs2MzUsNCBAQCB2b2lkIHBhbmZyb3N0X21tdV9maW5pKHN0cnVjdCBwYW5mcm9z
dF9kZXZpY2UgKnBmZGV2KQo+ICB7Cj4gIAltbXVfd3JpdGUocGZkZXYsIE1NVV9JTlRfTUFTSywg
MCk7Cj4gIAltbXVfZGlzYWJsZShwZmRldiwgMCk7Cj4gLQo+IC0JZnJlZV9pb19wZ3RhYmxlX29w
cyhwZmRldi0+bW11LT5wZ3RibF9vcHMpOwo+ICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9tbXUuaCBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9w
YW5mcm9zdF9tbXUuaAo+IGluZGV4IGQ1ZjliMjQ1MzdkYi4uN2M1YjY3NzVhZTIzIDEwMDY0NAo+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9tbXUuaAo+ICsrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9tbXUuaAo+IEBAIC01LDYgKzUsOCBAQAo+
ICAjZGVmaW5lIF9fUEFORlJPU1RfTU1VX0hfXwo+ICAKPiAgc3RydWN0IHBhbmZyb3N0X2dlbV9v
YmplY3Q7Cj4gK3N0cnVjdCBwYW5mcm9zdF9maWxlX3ByaXY7Cj4gK3N0cnVjdCBwYW5mcm9zdF9t
bXU7Cj4gIAo+ICBpbnQgcGFuZnJvc3RfbW11X21hcChzdHJ1Y3QgcGFuZnJvc3RfZ2VtX29iamVj
dCAqYm8pOwo+ICB2b2lkIHBhbmZyb3N0X21tdV91bm1hcChzdHJ1Y3QgcGFuZnJvc3RfZ2VtX29i
amVjdCAqYm8pOwo+IEBAIC0xMyw0ICsxNSwxMCBAQCBpbnQgcGFuZnJvc3RfbW11X2luaXQoc3Ry
dWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYpOwo+ICB2b2lkIHBhbmZyb3N0X21tdV9maW5pKHN0
cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2KTsKPiAgdm9pZCBwYW5mcm9zdF9tbXVfcmVzZXQo
c3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYpOwo+ICAKPiArdTMyIHBhbmZyb3N0X21tdV9h
c19nZXQoc3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYsIHN0cnVjdCBwYW5mcm9zdF9tbXUg
Km1tdSk7Cj4gK3ZvaWQgcGFuZnJvc3RfbW11X2FzX3B1dChzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNl
ICpwZmRldiwgc3RydWN0IHBhbmZyb3N0X21tdSAqbW11KTsKPiArCj4gK2ludCBwYW5mcm9zdF9t
bXVfcGd0YWJsZV9hbGxvYyhzdHJ1Y3QgcGFuZnJvc3RfZmlsZV9wcml2ICpwcml2KTsKPiArdm9p
ZCBwYW5mcm9zdF9tbXVfcGd0YWJsZV9mcmVlKHN0cnVjdCBwYW5mcm9zdF9maWxlX3ByaXYgKnBy
aXYpOwo+ICsKPiAgI2VuZGlmCj4gCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVl
ZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5m
by9kcmktZGV2ZWw=
