Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 54F51A527F
	for <lists+dri-devel@lfdr.de>; Mon,  2 Sep 2019 11:06:56 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 28F4289AB9;
	Mon,  2 Sep 2019 09:06:54 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-lf1-x144.google.com (mail-lf1-x144.google.com
 [IPv6:2a00:1450:4864:20::144])
 by gabe.freedesktop.org (Postfix) with ESMTPS id F114A89AB9
 for <dri-devel@lists.freedesktop.org>; Mon,  2 Sep 2019 09:06:50 +0000 (UTC)
Received: by mail-lf1-x144.google.com with SMTP id z21so9887591lfe.1
 for <dri-devel@lists.freedesktop.org>; Mon, 02 Sep 2019 02:06:50 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=Vmr/ht5IYIBUcs9L8LKGf97yXpVO4QhW+1CQmiiyIqw=;
 b=P+nbOEUw36MIVSs3MVK3Gu1qMKa4NwvNcok3HxX4otK4Wj4bS6S256evRJqgTSUE6x
 chaI7pPyyVRZxrkw9lyHzRLl/2V3P290xpRr44/FTsnjvSzjmOj+yA0/19BKtRDC893D
 pBO3EpRpEAqCxGN21qO2BixknWz/6rumaBqBAwJLWQlTwJByueyBoSVdskDkrdrhenq9
 K+UEiVEPjia9hKuR75SQ8IPaNWCnKI33SdYC0zixFj1WfGt+ybFrL7SIYcgJ70NMvfBD
 epvs+GEBjjuDIkoKd8c7H55ZoJOlDu5xWYydMEpEFXi4T+NsbreRDa5REIJL7mqqfqzT
 K3Iw==
X-Gm-Message-State: APjAAAWgGpwj4oO8eZZ/kuW7YeBuXkjTQhq5TDpNW/tOgbMaxllndiFQ
 gCWL6kmaFEC8ux3Gj7Tig6NWyA==
X-Google-Smtp-Source: APXvYqyeHM2IuvRnIvNXNWXKERi/+/9NYsbit60YQMjHH0eGVGWKkLbl4ywNPWxPsJZ71gmTGlSqgw==
X-Received: by 2002:a19:a407:: with SMTP id q7mr15021178lfc.166.1567415209183; 
 Mon, 02 Sep 2019 02:06:49 -0700 (PDT)
Received: from genomnajs.ideon.se ([85.235.10.227])
 by smtp.gmail.com with ESMTPSA id m3sm725034ljc.29.2019.09.02.02.06.47
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 02 Sep 2019 02:06:47 -0700 (PDT)
From: Linus Walleij <linus.walleij@linaro.org>
To: Thierry Reding <thierry.reding@gmail.com>, Sam Ravnborg <sam@ravnborg.org>,
 dri-devel@lists.freedesktop.org
Subject: [PATCH 2/2] drm/panel: Add driver for Sony ACX424AKP panel
Date: Mon,  2 Sep 2019 11:06:33 +0200
Message-Id: <20190902090633.24239-2-linus.walleij@linaro.org>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190902090633.24239-1-linus.walleij@linaro.org>
References: <20190902090633.24239-1-linus.walleij@linaro.org>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=linaro.org; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=Vmr/ht5IYIBUcs9L8LKGf97yXpVO4QhW+1CQmiiyIqw=;
 b=NoS4TCrL0VIz4GKLS6X9n6ghT8AAc494lGb+yiXg3MWlN119lyrmOz/P0mE2qlkEK0
 Ce9P1r5L11u0njtw+1eXsLzG/smjBNtswcbD4TGRRHm4rt3ooLvhIrxr5qLRSeoClz2H
 JRTKkKK6bhfbUMZoUQ0A9MovJZenmSooEIvGdxytgBrHvmqUaWf+5ssh2owhKV+C5Awq
 7LKF+KZoyeBuA+GJgLIN3/6gwOBGUOjM4i92j7W0DMSw/uF5cWM6rUf5ewHOuKk+Vdru
 bnTnuvjHPnMNekzbkL+K7HCuNh8oY8j/esp5wdcVMSoHu1+VBKy3nkaBs9ECxEP9aDKP
 uS+w==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

VGhlIFNvbnkgQUNYNDI0QUtQIGlzIGEgY29tbWFuZC92aWRlb21vZGUgRFNJIHBhbmVsIGZvcgpt
b2JpbGUgZGV2aWNlcy4gSXQgaXMgdXNlZCBvbiB0aGUgU1QtRXJpY3Nzb24gSFJFRjUyMApyZWZl
cmVuY2UgZGVzaWduLiBXZSBzdXBwb3J0IHZpZGVvIG1vZGUgYnkgZGVmYXVsdCwgYnV0Cml0IGlz
IHBvc3NpYmxlIHRvIHN3aXRjaCB0aGUgcGFuZWwgaW50byBjb21tYW5kIG1vZGUKYnkgdXNpbmcg
dGhlIGJvb2wgcHJvcGVydHkgImRzaS1jb21tYW5kLW1vZGUiLgoKU2lnbmVkLW9mZi1ieTogTGlu
dXMgV2FsbGVpaiA8bGludXMud2FsbGVpakBsaW5hcm8ub3JnPgotLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9wYW5lbC9LY29uZmlnICAgICAgICAgICAgICAgIHwgICA3ICsKIGRyaXZlcnMvZ3B1L2RybS9w
YW5lbC9NYWtlZmlsZSAgICAgICAgICAgICAgIHwgICAxICsKIGRyaXZlcnMvZ3B1L2RybS9wYW5l
bC9wYW5lbC1zb255LWFjeDQyNGFrcC5jIHwgNTMwICsrKysrKysrKysrKysrKysrKysKIDMgZmls
ZXMgY2hhbmdlZCwgNTM4IGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJz
L2dwdS9kcm0vcGFuZWwvcGFuZWwtc29ueS1hY3g0MjRha3AuYwoKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9wYW5lbC9LY29uZmlnIGIvZHJpdmVycy9ncHUvZHJtL3BhbmVsL0tjb25maWcK
aW5kZXggZDlkOTMxYWE2ZTI2Li40MzUzODhhODc0ZTIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9wYW5lbC9LY29uZmlnCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9LY29uZmlnCkBA
IC0yNzUsNiArMjc1LDEzIEBAIGNvbmZpZyBEUk1fUEFORUxfU0lUUk9OSVhfU1Q3Nzg5VgogCSAg
U2F5IFkgaGVyZSBpZiB5b3Ugd2FudCB0byBlbmFibGUgc3VwcG9ydCBmb3IgdGhlIFNpdHJvbml4
CiAJICBTVDc3ODlWIGNvbnRyb2xsZXIgZm9yIDI0MHgzMjAgTENEIHBhbmVscwogCitjb25maWcg
RFJNX1BBTkVMX1NPTllfQUNYNDI0QUtQCisJdHJpc3RhdGUgIlNvbnkgQUNYNDI0QUtQIERTSSBj
b21tYW5kIG1vZGUgcGFuZWwiCisJZGVwZW5kcyBvbiBPRgorCWRlcGVuZHMgb24gRFJNX01JUElf
RFNJCisJZGVwZW5kcyBvbiBCQUNLTElHSFRfQ0xBU1NfREVWSUNFCisJc2VsZWN0IFZJREVPTU9E
RV9IRUxQRVJTCisKIGNvbmZpZyBEUk1fUEFORUxfVFBPX1RQRzExMAogCXRyaXN0YXRlICJUUE8g
VFBHIDgwMHg0MDAgcGFuZWwiCiAJZGVwZW5kcyBvbiBPRiAmJiBTUEkgJiYgR1BJT0xJQgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmVsL01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJt
L3BhbmVsL01ha2VmaWxlCmluZGV4IGZiMGNiM2FhYTllNi4uOWVkNGQ4NTMyNjdlIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vcGFuZWwvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJt
L3BhbmVsL01ha2VmaWxlCkBAIC0yOCw1ICsyOCw2IEBAIG9iai0kKENPTkZJR19EUk1fUEFORUxf
U0hBUlBfTFExMDFSMVNYMDEpICs9IHBhbmVsLXNoYXJwLWxxMTAxcjFzeDAxLm8KIG9iai0kKENP
TkZJR19EUk1fUEFORUxfU0hBUlBfTFMwNDNUMUxFMDEpICs9IHBhbmVsLXNoYXJwLWxzMDQzdDFs
ZTAxLm8KIG9iai0kKENPTkZJR19EUk1fUEFORUxfU0lUUk9OSVhfU1Q3NzAxKSArPSBwYW5lbC1z
aXRyb25peC1zdDc3MDEubwogb2JqLSQoQ09ORklHX0RSTV9QQU5FTF9TSVRST05JWF9TVDc3ODlW
KSArPSBwYW5lbC1zaXRyb25peC1zdDc3ODl2Lm8KK29iai0kKENPTkZJR19EUk1fUEFORUxfU09O
WV9BQ1g0MjRBS1ApICs9IHBhbmVsLXNvbnktYWN4NDI0YWtwLm8KIG9iai0kKENPTkZJR19EUk1f
UEFORUxfVFBPX1RQRzExMCkgKz0gcGFuZWwtdHBvLXRwZzExMC5vCiBvYmotJChDT05GSUdfRFJN
X1BBTkVMX1RSVUxZX05UMzU1OTdfV1FYR0EpICs9IHBhbmVsLXRydWx5LW50MzU1OTcubwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3BhbmVsL3BhbmVsLXNvbnktYWN4NDI0YWtwLmMgYi9k
cml2ZXJzL2dwdS9kcm0vcGFuZWwvcGFuZWwtc29ueS1hY3g0MjRha3AuYwpuZXcgZmlsZSBtb2Rl
IDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjgwNzU2MGQyYThlYwotLS0gL2Rldi9udWxsCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5lbC9wYW5lbC1zb255LWFjeDQyNGFrcC5jCkBAIC0wLDAg
KzEsNTMwIEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCsKKy8qCisgKiBN
SVBJLURTSSBTb255IEFDWDQyNEFLUCBwYW5lbCBkcml2ZXIuIFRoaXMgaXMgYSA0ODB4ODY0Cisg
KiBBTU9MRUQgcGFuZWwgd2l0aCBhIGNvbW1hbmQtb25seSBEU0kgaW50ZXJmYWNlLgorICoKKyAq
IENvcHlyaWdodCAoQykgTGluYXJvIEx0ZC4gMjAxOQorICogQXV0aG9yOiBMaW51cyBXYWxsZWlq
CisgKiBCYXNlZCBvbiBjb2RlIGFuZCBrbm93LWhvdyBmcm9tIE1hcmN1cyBMb3JlbnR6b24KKyAq
IENvcHlyaWdodCAoQykgU1QtRXJpY3Nzb24gU0EgMjAxMAorICovCisKKyNpbmNsdWRlIDxkcm0v
ZHJtX21vZGVzLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9taXBpX2RzaS5oPgorI2luY2x1ZGUgPGRy
bS9kcm1fcGFuZWwuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3ByaW50Lmg+CisjaW5jbHVkZSA8dmlk
ZW8vbWlwaV9kaXNwbGF5Lmg+CisKKyNpbmNsdWRlIDxsaW51eC9ncGlvL2NvbnN1bWVyLmg+Cisj
aW5jbHVkZSA8bGludXgvcmVndWxhdG9yL2NvbnN1bWVyLmg+CisjaW5jbHVkZSA8bGludXgvZGVs
YXkuaD4KKyNpbmNsdWRlIDxsaW51eC9vZi5oPgorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgor
I2luY2x1ZGUgPGxpbnV4L2JhY2tsaWdodC5oPgorCisvKiBGSVhNRTogbW92ZSB0byA8dmlkZW8v
bWlwaV9kaXNwbGF5Lmg+ID8gKi8KKyNkZWZpbmUgTUlQSV9EU0lfRENTX1NFVF9NRERJIDB4QUUK
KworI2RlZmluZSBESVNQTEFZX1NPTllfQUNYNDI0QUtQX0lEMQkweDFiODEKKyNkZWZpbmUgRElT
UExBWV9TT05ZX0FDWDQyNEFLUF9JRDIJMHgxYTgxCisjZGVmaW5lIERJU1BMQVlfU09OWV9BQ1g0
MjRBS1BfSUQzCTB4MDA4MAorCitzdHJ1Y3QgYWN4NDI0YWtwIHsKKwlzdHJ1Y3QgZGV2aWNlICpk
ZXY7CisJc3RydWN0IGRybV9wYW5lbCBwYW5lbDsKKwlzdHJ1Y3QgYmFja2xpZ2h0X2RldmljZSAq
Ymw7CisJc3RydWN0IHJlZ3VsYXRvciAqc3VwcGx5OworCXN0cnVjdCBncGlvX2Rlc2MgKnJlc2V0
X2dwaW87CisJdTE2IGlkOworCWJvb2wgdmlkZW9fbW9kZTsKK307CisKK3N0YXRpYyBjb25zdCBz
dHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSBzb255X2FjeDQyNGFrcF92aWRfbW9kZSA9IHsKKwkuY2xv
Y2sgPSAzMzAwMDAsCisJLmhkaXNwbGF5ID0gNDgwLAorCS5oc3luY19zdGFydCA9IDQ4MCArIDE1
LAorCS5oc3luY19lbmQgPSA0ODAgKyAxNSArIDAsCisJLmh0b3RhbCA9IDQ4MCArIDE1ICsgMCAr
IDE1LAorCS52ZGlzcGxheSA9IDg2NCwKKwkudnN5bmNfc3RhcnQgPSA4NjQgKyAxNCwKKwkudnN5
bmNfZW5kID0gODY0ICsgMTQgKyAxLAorCS52dG90YWwgPSA4NjQgKyAxNCArIDEgKyAxMSwKKwku
dnJlZnJlc2ggPSA2MCwKKwkud2lkdGhfbW0gPSA0OCwKKwkuaGVpZ2h0X21tID0gODQsCisJLmZs
YWdzID0gRFJNX01PREVfRkxBR19QVlNZTkMsCit9OworCisvKgorICogVGhlIHRpbWluZ3MgYXJl
IG5vdCB2ZXJ5IGhlbHBmdWwgYXMgdGhlIGRpc3BsYXkgaXMgdXNlZCBpbgorICogY29tbWFuZCBt
b2RlLgorICovCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgc29ueV9hY3g0
MjRha3BfY21kX21vZGUgPSB7CisJLyogSFMgY2xvY2ssIChodG90YWwqdnRvdGFsKnZyZWZyZXNo
KS8xMDAwICovCisJLmNsb2NrID0gNDIwMTYwLAorCS5oZGlzcGxheSA9IDQ4MCwKKwkuaHN5bmNf
c3RhcnQgPSA0ODAgKyAxNTQsCisJLmhzeW5jX2VuZCA9IDQ4MCArIDE1NCArIDE2LAorCS5odG90
YWwgPSA0ODAgKyAxNTQgKyAxNiArIDMyLAorCS52ZGlzcGxheSA9IDg2NCwKKwkudnN5bmNfc3Rh
cnQgPSA4NjQgKyAxLAorCS52c3luY19lbmQgPSA4NjQgKyAxICsgMSwKKwkudnRvdGFsID0gODY0
ICsgMSArIDEgKyAxLAorCS8qCisJICogVGhpcyBkZXBlbmRzIG9uIHRoZSBjbG9ja2luZyBIUyB2
cyBMUCByYXRlLCB0aGlzIHZhbHVlCisJICogaXMgY2FsY3VsYXRlZCBhczoKKwkgKiB2cmVmcmVz
aCA9IChjbG9jayAqIDEwMDApIC8gKGh0b3RhbCp2dG90YWwpCisJICovCisJLnZyZWZyZXNoID0g
ODE2LAorCS53aWR0aF9tbSA9IDQ4LAorCS5oZWlnaHRfbW0gPSA4NCwKK307CisKK3N0YXRpYyBp
bmxpbmUgc3RydWN0IGFjeDQyNGFrcCAqcGFuZWxfdG9fYWN4NDI0YWtwKHN0cnVjdCBkcm1fcGFu
ZWwgKnBhbmVsKQoreworCXJldHVybiBjb250YWluZXJfb2YocGFuZWwsIHN0cnVjdCBhY3g0MjRh
a3AsIHBhbmVsKTsKK30KKworI2RlZmluZSBGT1NDCQkJMjAgLyogMjBNaHogKi8KKyNkZWZpbmUg
U0NBTEVfRkFDVE9SX05TX0RJVl9NSFoJMTAwMAorCitzdGF0aWMgaW50IGFjeDQyNGFrcF9zZXRf
YnJpZ2h0bmVzcyhzdHJ1Y3QgYmFja2xpZ2h0X2RldmljZSAqYmwpCit7CisJc3RydWN0IGFjeDQy
NGFrcCAqYWN4ID0gYmxfZ2V0X2RhdGEoYmwpOworCXN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRz
aSA9IHRvX21pcGlfZHNpX2RldmljZShhY3gtPmRldik7CisJaW50IHBlcmlvZF9ucyA9IDEwMjM7
CisJaW50IGR1dHlfbnMgPSBibC0+cHJvcHMuYnJpZ2h0bmVzczsKKwl1OCBwd21fcmF0aW87CisJ
dTggcHdtX2RpdjsKKwl1OCBwYXI7CisJaW50IHJldDsKKworCS8qIENhbGN1bGF0ZSB0aGUgUFdN
IGR1dHkgY3ljbGUgaW4gbi8yNTYncyAqLworCXB3bV9yYXRpbyA9IG1heCgoKGR1dHlfbnMgKiAy
NTYpIC8gcGVyaW9kX25zKSAtIDEsIDEpOworCXB3bV9kaXYgPSBtYXgoMSwKKwkJICAgICAgKChG
T1NDICogcGVyaW9kX25zKSAvIDI1NikgLworCQkgICAgICBTQ0FMRV9GQUNUT1JfTlNfRElWX01I
Wik7CisKKwkvKiBTZXQgdXAgUFdNIGR1dHljeWNsZSBPTkUgYnl0ZSAoZGlmZmVycyBmcm9tIHRo
ZSBzdGFuZGFyZCkgKi8KKwlEUk1fREVWX0RFQlVHKGFjeC0+ZGV2LCAiY2FsY3VsYXRlZCBkdXR5
IGN5Y2xlICUwMnhcbiIsIHB3bV9yYXRpbyk7CisJcmV0ID0gbWlwaV9kc2lfZGNzX3dyaXRlKGRz
aSwgTUlQSV9EQ1NfU0VUX0RJU1BMQVlfQlJJR0hUTkVTUywKKwkJCQkgJnB3bV9yYXRpbywgMSk7
CisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihhY3gtPmRldiwKKwkJCSAgICAgICJm
YWlsZWQgdG8gc2V0IGRpc3BsYXkgUFdNIHJhdGlvICglZClcbiIsCisJCQkgICAgICByZXQpOwor
CQlyZXR1cm4gcmV0OworCX0KKworCS8qCisJICogU2VxdWVuY2UgdG8gd3JpdGUgUFdNRElWOgor
CSAqCWFkZHJlc3MJCWRhdGEKKwkgKgkweEYzCQkweEFBICAgQ01EMiBVbmxvY2sKKwkgKgkweDAw
CQkweDAxICAgRW50ZXIgQ01EMiBwYWdlIDAKKwkgKgkwWDdECQkweDAxICAgTm8gcmVsb2FkIE1U
UCBvZiBDTUQyIFAxCisJICoJMHgyMgkJUFdNRElWCisJICoJMHg3RgkJMHhBQSAgIENNRDIgcGFn
ZSAxIGxvY2sKKwkgKi8KKwlwYXIgPSAweGFhOworCXJldCA9IG1pcGlfZHNpX2Rjc193cml0ZShk
c2ksIDB4ZjMsICZwYXIsIDEpOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9ERVZfRVJST1IoYWN4
LT5kZXYsCisJCQkgICAgICAiZmFpbGVkIHRvIHVubG9jayBDTUQgMiAoJWQpXG4iLAorCQkJICAg
ICAgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisJcGFyID0gMHgwMTsKKwlyZXQgPSBtaXBpX2Rz
aV9kY3Nfd3JpdGUoZHNpLCAweDAwLCAmcGFyLCAxKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1f
REVWX0VSUk9SKGFjeC0+ZGV2LAorCQkJICAgICAgImZhaWxlZCB0byBlbnRlciBwYWdlIDEgKCVk
KVxuIiwKKwkJCSAgICAgIHJldCk7CisJCXJldHVybiByZXQ7CisJfQorCXBhciA9IDB4MDE7CisJ
cmV0ID0gbWlwaV9kc2lfZGNzX3dyaXRlKGRzaSwgMHg3ZCwgJnBhciwgMSk7CisJaWYgKHJldCA8
IDApIHsKKwkJRFJNX0RFVl9FUlJPUihhY3gtPmRldiwKKwkJCSAgICAgICJmYWlsZWQgdG8gZGlz
YWJsZSBNVFAgcmVsb2FkICglZClcbiIsCisJCQkgICAgICByZXQpOworCQlyZXR1cm4gcmV0Owor
CX0KKwlyZXQgPSBtaXBpX2RzaV9kY3Nfd3JpdGUoZHNpLCAweDIyLCAmcHdtX2RpdiwgMSk7CisJ
aWYgKHJldCA8IDApIHsKKwkJRFJNX0RFVl9FUlJPUihhY3gtPmRldiwKKwkJCSAgICAgICJmYWls
ZWQgdG8gc2V0IFBXTSBkaXZpc29yICglZClcbiIsCisJCQkgICAgICByZXQpOworCQlyZXR1cm4g
cmV0OworCX0KKwlwYXIgPSAweGFhOworCXJldCA9IG1pcGlfZHNpX2Rjc193cml0ZShkc2ksIDB4
N2YsICZwYXIsIDEpOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9ERVZfRVJST1IoYWN4LT5kZXYs
CisJCQkgICAgICAiZmFpbGVkIHRvIGxvY2sgQ01EIDIgKCVkKVxuIiwKKwkJCSAgICAgIHJldCk7
CisJCXJldHVybiByZXQ7CisJfQorCisJLyogRW5hYmxlIGJhY2tsaWdodCAqLworCXBhciA9IDB4
MjQ7CisJcmV0ID0gbWlwaV9kc2lfZGNzX3dyaXRlKGRzaSwgTUlQSV9EQ1NfV1JJVEVfQ09OVFJP
TF9ESVNQTEFZLAorCQkJCSAmcGFyLCAxKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VS
Uk9SKGFjeC0+ZGV2LAorCQkJICAgICAgImZhaWxlZCB0byBlbmFibGUgZGlzcGxheSBiYWNrbGln
aHQgKCVkKVxuIiwKKwkJCSAgICAgIHJldCk7CisJCXJldHVybiByZXQ7CisJfQorCisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgYmFja2xpZ2h0X29wcyBhY3g0MjRha3BfYmxf
b3BzID0geworCS51cGRhdGVfc3RhdHVzID0gYWN4NDI0YWtwX3NldF9icmlnaHRuZXNzLAorfTsK
Kworc3RhdGljIGludCBhY3g0MjRha3BfcmVhZF9pZChzdHJ1Y3QgYWN4NDI0YWtwICphY3gpCit7
CisJc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpID0gdG9fbWlwaV9kc2lfZGV2aWNlKGFjeC0+
ZGV2KTsKKwl1OCBpZDEsIGlkMiwgaWQzOworCXUxNiB2YWw7CisJc2l6ZV90IGxlbjsKKwlpbnQg
cmV0OworCisJbGVuID0gMTsKKworCXJldCA9IG1pcGlfZHNpX2Rjc19yZWFkKGRzaSwgMHhkYSwg
JmlkMSwgbGVuKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGFjeC0+ZGV2LCAi
Y291bGQgbm90IHJlYWQgZGV2aWNlIElEIGJ5dGUgMVxuIik7CisJCXJldHVybiByZXQ7CisJfQor
CXJldCA9IG1pcGlfZHNpX2Rjc19yZWFkKGRzaSwgMHhkYiwgJmlkMiwgbGVuKTsKKwlpZiAocmV0
IDwgMCkgeworCQlEUk1fREVWX0VSUk9SKGFjeC0+ZGV2LCAiY291bGQgbm90IHJlYWQgZGV2aWNl
IElEIGJ5dGUgMlxuIik7CisJCXJldHVybiByZXQ7CisJfQorCXJldCA9IG1pcGlfZHNpX2Rjc19y
ZWFkKGRzaSwgMHhkYywgJmlkMywgbGVuKTsKKwlpZiAocmV0IDwgMCkgeworCQlEUk1fREVWX0VS
Uk9SKGFjeC0+ZGV2LCAiY291bGQgbm90IHJlYWQgZGV2aWNlIElEIGJ5dGUgM1xuIik7CisJCXJl
dHVybiByZXQ7CisJfQorCisJdmFsID0gKGlkMyA8PCA4KSB8IGlkMjsKKworCXN3aXRjaCAodmFs
KSB7CisJY2FzZSBESVNQTEFZX1NPTllfQUNYNDI0QUtQX0lEMToKKwljYXNlIERJU1BMQVlfU09O
WV9BQ1g0MjRBS1BfSUQyOgorCWNhc2UgRElTUExBWV9TT05ZX0FDWDQyNEFLUF9JRDM6CisJCURS
TV9ERVZfSU5GTyhhY3gtPmRldiwgInBhbmVsIElEOiAlMDR4XG4iLCB2YWwpOworCQlicmVhazsK
KwlkZWZhdWx0OgorCQlEUk1fREVWX0VSUk9SKGFjeC0+ZGV2LCAidW5rbm93biBwYW5lbCBJRDog
JTA0eFxuIiwgdmFsKTsKKwkJYnJlYWs7CisJfTsKKwlhY3gtPmlkID0gdmFsOworCisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyBpbnQgYWN4NDI0YWtwX3Bvd2VyX29uKHN0cnVjdCBhY3g0MjRha3Ag
KmFjeCkKK3sKKwlpbnQgcmV0OworCisJcmV0ID0gcmVndWxhdG9yX2VuYWJsZShhY3gtPnN1cHBs
eSk7CisJaWYgKHJldCkgeworCQlEUk1fREVWX0VSUk9SKGFjeC0+ZGV2LCAiZmFpbGVkIHRvIGVu
YWJsZSBzdXBwbHkgKCVkKVxuIiwgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwkvKiBBc3Nl
cnQgUkVTRVQgKi8KKwlncGlvZF9zZXRfdmFsdWVfY2Fuc2xlZXAoYWN4LT5yZXNldF9ncGlvLCAx
KTsKKwl1ZGVsYXkoMjApOworCS8qIERlLWFzc2VydCBSRVNFVCAqLworCWdwaW9kX3NldF92YWx1
ZV9jYW5zbGVlcChhY3gtPnJlc2V0X2dwaW8sIDApOworCW1zbGVlcCgxMSk7CisKKwlyZXR1cm4g
MDsKK30KKworc3RhdGljIGludCBhY3g0MjRha3BfcHJlcGFyZShzdHJ1Y3QgZHJtX3BhbmVsICpw
YW5lbCkKK3sKKwlzdHJ1Y3QgYWN4NDI0YWtwICphY3ggPSBwYW5lbF90b19hY3g0MjRha3AocGFu
ZWwpOworCXN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaSA9IHRvX21pcGlfZHNpX2RldmljZShh
Y3gtPmRldik7CisJY29uc3QgdTggbWRkaSA9IDM7CisJaW50IHJldDsKKworCXJldCA9IGFjeDQy
NGFrcF9wb3dlcl9vbihhY3gpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwkvKiBFbmFi
ZSB0ZWFyaW5nIG1vZGU6IHNlbmQgVEUgKHRlYXJpbmcgZWZmZWN0KSBhdCBWQkxBTksgKi8KKwly
ZXQgPSBtaXBpX2RzaV9kY3Nfc2V0X3RlYXJfb24oZHNpLAorCQkJCSAgICAgICBNSVBJX0RTSV9E
Q1NfVEVBUl9NT0RFX1ZCTEFOSyk7CisJaWYgKHJldCkgeworCQlEUk1fREVWX0VSUk9SKGFjeC0+
ZGV2LCAiZmFpbGVkIHRvIGVuYWJsZSB2YmxhbmsgVEUgKCVkKVxuIiwKKwkJCSAgICAgIHJldCk7
CisJCXJldHVybiByZXQ7CisJfQorCisJLyogU2V0IE1EREkgLSBkb2Vzbid0IHNlZW0gdG8gd29y
az8gKi8KKwlyZXQgPSBtaXBpX2RzaV9kY3Nfd3JpdGUoZHNpLCBNSVBJX0RTSV9EQ1NfU0VUX01E
REksCisJCQkJICZtZGRpLCBzaXplb2YobWRkaSkpOworCWlmIChyZXQgPCAwKSB7CisJCURSTV9E
RVZfRVJST1IoYWN4LT5kZXYsICJmYWlsZWQgdG8gc2V0IE1EREkgKCVkKVxuIiwgcmV0KTsKKwkJ
cmV0dXJuIHJldDsKKwl9CisKKwlhY3gtPmJsLT5wcm9wcy5wb3dlciA9IEZCX0JMQU5LX05PUk1B
TDsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBhY3g0MjRha3BfcG93ZXJfb2ZmKHN0
cnVjdCBhY3g0MjRha3AgKmFjeCkKK3sKKwkvKiBBc3NlcnQgUkVTRVQgKi8KKwlncGlvZF9zZXRf
dmFsdWVfY2Fuc2xlZXAoYWN4LT5yZXNldF9ncGlvLCAxKTsKKwltc2xlZXAoMTEpOworCisJcmVn
dWxhdG9yX2Rpc2FibGUoYWN4LT5zdXBwbHkpOworfQorCitzdGF0aWMgaW50IGFjeDQyNGFrcF91
bnByZXBhcmUoc3RydWN0IGRybV9wYW5lbCAqcGFuZWwpCit7CisJc3RydWN0IGFjeDQyNGFrcCAq
YWN4ID0gcGFuZWxfdG9fYWN4NDI0YWtwKHBhbmVsKTsKKworCWFjeDQyNGFrcF9wb3dlcl9vZmYo
YWN4KTsKKwlhY3gtPmJsLT5wcm9wcy5wb3dlciA9IEZCX0JMQU5LX1BPV0VSRE9XTjsKKworCXJl
dHVybiAwOworfQorCitzdGF0aWMgaW50IGFjeDQyNGFrcF9lbmFibGUoc3RydWN0IGRybV9wYW5l
bCAqcGFuZWwpCit7CisJc3RydWN0IGFjeDQyNGFrcCAqYWN4ID0gcGFuZWxfdG9fYWN4NDI0YWtw
KHBhbmVsKTsKKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kgPSB0b19taXBpX2RzaV9kZXZp
Y2UoYWN4LT5kZXYpOworCWludCByZXQ7CisKKwkvKiBFeGl0IHNsZWVwIG1vZGUgKi8KKwlyZXQg
PSBtaXBpX2RzaV9kY3NfZXhpdF9zbGVlcF9tb2RlKGRzaSk7CisJaWYgKHJldCkgeworCQlEUk1f
REVWX0VSUk9SKGFjeC0+ZGV2LCAiZmFpbGVkIHRvIGV4aXQgc2xlZXAgbW9kZSAoJWQpXG4iLAor
CQkJICAgICAgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisJbXNsZWVwKDE0MCk7CisKKwlyZXQg
PSBtaXBpX2RzaV9kY3Nfc2V0X2Rpc3BsYXlfb24oZHNpKTsKKwlpZiAocmV0KSB7CisJCURSTV9E
RVZfRVJST1IoYWN4LT5kZXYsICJmYWlsZWQgdG8gdHVybiBkaXNwbGF5IG9uICglZClcbiIsCisJ
CQkgICAgICByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKwlpZiAoYWN4LT52aWRlb19tb2RlKSB7
CisJCS8qIEluIHZpZGVvIG1vZGUgdHVybiBwZXJpcGhlcmFsIG9uICovCisJCXJldCA9IG1pcGlf
ZHNpX3R1cm5fb25fcGVyaXBoZXJhbChkc2kpOworCQlpZiAocmV0KSB7CisJCQlkZXZfZXJyKGFj
eC0+ZGV2LCAiZmFpbGVkIHRvIHR1cm4gb24gcGVyaXBoZXJhbFxuIik7CisJCQlyZXR1cm4gcmV0
OworCQl9CisJfQorCisJYWN4LT5ibC0+cHJvcHMucG93ZXIgPSBGQl9CTEFOS19VTkJMQU5LOwor
CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgYWN4NDI0YWtwX2Rpc2FibGUoc3RydWN0IGRy
bV9wYW5lbCAqcGFuZWwpCit7CisJc3RydWN0IGFjeDQyNGFrcCAqYWN4ID0gcGFuZWxfdG9fYWN4
NDI0YWtwKHBhbmVsKTsKKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kgPSB0b19taXBpX2Rz
aV9kZXZpY2UoYWN4LT5kZXYpOworCXU4IHBhcjsKKwlpbnQgcmV0OworCisJLyogRGlzYWJsZSBi
YWNrbGlnaHQgKi8KKwlwYXIgPSAweDAwOworCXJldCA9IG1pcGlfZHNpX2Rjc193cml0ZShkc2ks
IE1JUElfRENTX1dSSVRFX0NPTlRST0xfRElTUExBWSwKKwkJCQkgJnBhciwgMSk7CisJaWYgKHJl
dCkgeworCQlEUk1fREVWX0VSUk9SKGFjeC0+ZGV2LAorCQkJICAgICAgImZhaWxlZCB0byBkaXNh
YmxlIGRpc3BsYXkgYmFja2xpZ2h0ICglZClcbiIsCisJCQkgICAgICByZXQpOworCQlyZXR1cm4g
cmV0OworCX0KKworCXJldCA9IG1pcGlfZHNpX2Rjc19zZXRfZGlzcGxheV9vZmYoZHNpKTsKKwlp
ZiAocmV0KSB7CisJCURSTV9ERVZfRVJST1IoYWN4LT5kZXYsICJmYWlsZWQgdG8gdHVybiBkaXNw
bGF5IG9mZiAoJWQpXG4iLAorCQkJICAgICAgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwkv
KiBFbnRlciBzbGVlcCBtb2RlICovCisJcmV0ID0gbWlwaV9kc2lfZGNzX2VudGVyX3NsZWVwX21v
ZGUoZHNpKTsKKwlpZiAocmV0KSB7CisJCURSTV9ERVZfRVJST1IoYWN4LT5kZXYsICJmYWlsZWQg
dG8gZW50ZXIgc2xlZXAgbW9kZSAoJWQpXG4iLAorCQkJICAgICAgcmV0KTsKKwkJcmV0dXJuIHJl
dDsKKwl9CisJbXNsZWVwKDg1KTsKKworCWFjeC0+YmwtPnByb3BzLnBvd2VyID0gRkJfQkxBTktf
Tk9STUFMOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgYWN4NDI0YWtwX2dldF9tb2Rl
cyhzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbCkKK3sKKwlzdHJ1Y3QgYWN4NDI0YWtwICphY3ggPSBw
YW5lbF90b19hY3g0MjRha3AocGFuZWwpOworCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0
b3IgPSBwYW5lbC0+Y29ubmVjdG9yOworCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlOwor
CisJaWYgKGFjeC0+dmlkZW9fbW9kZSkKKwkJbW9kZSA9IGRybV9tb2RlX2R1cGxpY2F0ZShwYW5l
bC0+ZHJtLAorCQkJCQkgICZzb255X2FjeDQyNGFrcF92aWRfbW9kZSk7CisJZWxzZQorCQltb2Rl
ID0gZHJtX21vZGVfZHVwbGljYXRlKHBhbmVsLT5kcm0sCisJCQkJCSAgJnNvbnlfYWN4NDI0YWtw
X2NtZF9tb2RlKTsKKwlpZiAoIW1vZGUpIHsKKwkJRFJNX0VSUk9SKCJiYWQgbW9kZSBvciBmYWls
ZWQgdG8gYWRkIG1vZGVcbiIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisJZHJtX21vZGVfc2V0
X25hbWUobW9kZSk7CisJbW9kZS0+dHlwZSA9IERSTV9NT0RFX1RZUEVfRFJJVkVSIHwgRFJNX01P
REVfVFlQRV9QUkVGRVJSRUQ7CisKKwljb25uZWN0b3ItPmRpc3BsYXlfaW5mby53aWR0aF9tbSA9
IG1vZGUtPndpZHRoX21tOworCWNvbm5lY3Rvci0+ZGlzcGxheV9pbmZvLmhlaWdodF9tbSA9IG1v
ZGUtPmhlaWdodF9tbTsKKworCWRybV9tb2RlX3Byb2JlZF9hZGQoY29ubmVjdG9yLCBtb2RlKTsK
KworCXJldHVybiAxOyAvKiBOdW1iZXIgb2YgbW9kZXMgKi8KK30KKworc3RhdGljIGNvbnN0IHN0
cnVjdCBkcm1fcGFuZWxfZnVuY3MgYWN4NDI0YWtwX2RybV9mdW5jcyA9IHsKKwkuZGlzYWJsZSA9
IGFjeDQyNGFrcF9kaXNhYmxlLAorCS51bnByZXBhcmUgPSBhY3g0MjRha3BfdW5wcmVwYXJlLAor
CS5wcmVwYXJlID0gYWN4NDI0YWtwX3ByZXBhcmUsCisJLmVuYWJsZSA9IGFjeDQyNGFrcF9lbmFi
bGUsCisJLmdldF9tb2RlcyA9IGFjeDQyNGFrcF9nZXRfbW9kZXMsCit9OworCitzdGF0aWMgaW50
IGFjeDQyNGFrcF9wcm9iZShzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kpCit7CisJc3RydWN0
IGRldmljZSAqZGV2ID0gJmRzaS0+ZGV2OworCXN0cnVjdCBhY3g0MjRha3AgKmFjeDsKKwlpbnQg
cmV0OworCWludCBpOworCisJYWN4ID0gZGV2bV9remFsbG9jKGRldiwgc2l6ZW9mKHN0cnVjdCBh
Y3g0MjRha3ApLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWFjeCkKKwkJcmV0dXJuIC1FTk9NRU07CisJ
YWN4LT52aWRlb19tb2RlID0gIW9mX3Byb3BlcnR5X3JlYWRfYm9vbChkZXYtPm9mX25vZGUsCisJ
CQkJCQkgImRzaS1jb21tYW5kLW1vZGUiKTsKKworCW1pcGlfZHNpX3NldF9kcnZkYXRhKGRzaSwg
YWN4KTsKKwlhY3gtPmRldiA9IGRldjsKKworCWRzaS0+bGFuZXMgPSAyOworCWRzaS0+Zm9ybWF0
ID0gTUlQSV9EU0lfRk1UX1JHQjg4ODsKKwlkc2ktPmhzX3JhdGUgPSA0MjAxNjAwMDA7CisJZHNp
LT5scF9yYXRlID0gMTkyMDAwMDA7CisKKwlpZiAoYWN4LT52aWRlb19tb2RlKQorCQlkc2ktPm1v
ZGVfZmxhZ3MgPQorCQkJTUlQSV9EU0lfTU9ERV9WSURFTyB8CisJCQlNSVBJX0RTSV9NT0RFX1ZJ
REVPX0JVUlNUIHwKKwkJCU1JUElfRFNJX01PREVfVklERU9fU1lOQ19QVUxTRTsKKwllbHNlCisJ
CWRzaS0+bW9kZV9mbGFncyA9CisJCQlNSVBJX0RTSV9DTE9DS19OT05fQ09OVElOVU9VUyB8CisJ
CQlNSVBJX0RTSV9NT0RFX0VPVF9QQUNLRVQ7CisKKworCWFjeC0+c3VwcGx5ID0gZGV2bV9yZWd1
bGF0b3JfZ2V0KGRldiwgInZkZGkiKTsKKwlpZiAoSVNfRVJSKGFjeC0+c3VwcGx5KSkKKwkJcmV0
dXJuIFBUUl9FUlIoYWN4LT5zdXBwbHkpOworCisJLyogVGhpcyBhc3NlcnRzIFJFU0VUIGJ5IGRl
ZmF1bHQgKi8KKwlhY3gtPnJlc2V0X2dwaW8gPSBkZXZtX2dwaW9kX2dldF9vcHRpb25hbChkZXYs
ICJyZXNldCIsCisJCQkJCQkgR1BJT0RfT1VUX0hJR0gpOworCWlmIChJU19FUlIoYWN4LT5yZXNl
dF9ncGlvKSkgeworCQlyZXQgPSBQVFJfRVJSKGFjeC0+cmVzZXRfZ3Bpbyk7CisJCWlmIChyZXQg
IT0gLUVQUk9CRV9ERUZFUikKKwkJCURSTV9ERVZfRVJST1IoZGV2LCAiZmFpbGVkIHRvIHJlcXVl
c3QgR1BJTyAoJWQpXG4iLAorCQkJCSAgICAgIHJldCk7CisJCXJldHVybiByZXQ7CisJfQorCisJ
ZHJtX3BhbmVsX2luaXQoJmFjeC0+cGFuZWwpOworCWFjeC0+cGFuZWwuZGV2ID0gZGV2OworCWFj
eC0+cGFuZWwuZnVuY3MgPSAmYWN4NDI0YWtwX2RybV9mdW5jczsKKworCWFjeC0+YmwgPSBkZXZt
X2JhY2tsaWdodF9kZXZpY2VfcmVnaXN0ZXIoZGV2LCAiYWN4NDI0YWtwIiwgZGV2LCBhY3gsCisJ
CQkJCQkgJmFjeDQyNGFrcF9ibF9vcHMsIE5VTEwpOworCWlmIChJU19FUlIoYWN4LT5ibCkpIHsK
KwkJRFJNX0RFVl9FUlJPUihkZXYsICJmYWlsZWQgdG8gcmVnaXN0ZXIgYmFja2xpZ2h0IGRldmlj
ZVxuIik7CisJCXJldHVybiBQVFJfRVJSKGFjeC0+YmwpOworCX0KKwlhY3gtPmJsLT5wcm9wcy5t
YXhfYnJpZ2h0bmVzcyA9IDEwMjM7CisJYWN4LT5ibC0+cHJvcHMuYnJpZ2h0bmVzcyA9IDUxMjsK
KwlhY3gtPmJsLT5wcm9wcy5wb3dlciA9IEZCX0JMQU5LX1BPV0VSRE9XTjsKKworCXJldCA9IGRy
bV9wYW5lbF9hZGQoJmFjeC0+cGFuZWwpOworCWlmIChyZXQgPCAwKQorCQlyZXR1cm4gcmV0Owor
CisJcmV0ID0gYWN4NDI0YWtwX3Bvd2VyX29uKGFjeCk7CisJaWYgKHJldCkgeworCQlEUk1fREVW
X0VSUk9SKGRldiwgImZhaWxlZCB0byBwb3dlciB1cCBkaXNwbGF5XG4iKTsKKwkJcmV0dXJuIHJl
dDsKKwl9CisKKwkvKiBSZWFkIGRldmljZSBJRCAqLworCWkgPSAwOworCWRvIHsKKwkJcmV0ID0g
YWN4NDI0YWtwX3JlYWRfaWQoYWN4KTsKKwkJaWYgKHJldCkKKwkJCWNvbnRpbnVlOworCX0gd2hp
bGUgKHJldCAmJiBpKysgPCA1KTsKKworCWlmIChyZXQpIHsKKwkJRFJNX0RFVl9FUlJPUihhY3gt
PmRldiwgImZhaWxlZCB0byByZWFkIHBhbmVsIElEICglZClcbiIsIHJldCk7CisJCXJldHVybiBy
ZXQ7CisJfQorCWFjeDQyNGFrcF9wb3dlcl9vZmYoYWN4KTsKKworCXJldCA9IG1pcGlfZHNpX2F0
dGFjaChkc2kpOworCWlmIChyZXQgPCAwKQorCQlkcm1fcGFuZWxfcmVtb3ZlKCZhY3gtPnBhbmVs
KTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgYWN4NDI0YWtwX3JlbW92ZShzdHJ1
Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2kpCit7CisJc3RydWN0IGFjeDQyNGFrcCAqYWN4ID0gbWlw
aV9kc2lfZ2V0X2RydmRhdGEoZHNpKTsKKworCW1pcGlfZHNpX2RldGFjaChkc2kpOworCWRybV9w
YW5lbF9yZW1vdmUoJmFjeC0+cGFuZWwpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBjb25z
dCBzdHJ1Y3Qgb2ZfZGV2aWNlX2lkIGFjeDQyNGFrcF9vZl9tYXRjaFtdID0geworCXsgLmNvbXBh
dGlibGUgPSAic29ueSxhY3g0MjRha3AiIH0sCisJeyB9Cit9OworTU9EVUxFX0RFVklDRV9UQUJM
RShvZiwgYWN4NDI0YWtwX29mX21hdGNoKTsKKworc3RhdGljIHN0cnVjdCBtaXBpX2RzaV9kcml2
ZXIgYWN4NDI0YWtwX2RyaXZlciA9IHsKKwkucHJvYmUgPSBhY3g0MjRha3BfcHJvYmUsCisJLnJl
bW92ZSA9IGFjeDQyNGFrcF9yZW1vdmUsCisJLmRyaXZlciA9IHsKKwkJLm5hbWUgPSAicGFuZWwt
c29ueS1hY3g0MjRha3AiLAorCQkub2ZfbWF0Y2hfdGFibGUgPSBhY3g0MjRha3Bfb2ZfbWF0Y2gs
CisJfSwKK307Cittb2R1bGVfbWlwaV9kc2lfZHJpdmVyKGFjeDQyNGFrcF9kcml2ZXIpOworCitN
T0RVTEVfQVVUSE9SKCJMaW51cyBXYWxsZWkgPGxpbnVzLndhbGxlaWpAbGluYXJvLm9yZz4iKTsK
K01PRFVMRV9ERVNDUklQVElPTigiTUlQSS1EU0kgU29ueSBhY3g0MjRha3AgUGFuZWwgRHJpdmVy
Iik7CitNT0RVTEVfTElDRU5TRSgiR1BMIHYyIik7Ci0tIAoyLjIxLjAKCl9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QK
ZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9w
Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
