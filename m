Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 183EE6CA07
	for <lists+dri-devel@lfdr.de>; Thu, 18 Jul 2019 09:40:01 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B0CB86E31E;
	Thu, 18 Jul 2019 07:39:57 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-ot1-x341.google.com (mail-ot1-x341.google.com
 [IPv6:2607:f8b0:4864:20::341])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1FC226E2E3
 for <dri-devel@lists.freedesktop.org>; Thu, 18 Jul 2019 02:08:23 +0000 (UTC)
Received: by mail-ot1-x341.google.com with SMTP id j11so3051395otp.10
 for <dri-devel@lists.freedesktop.org>; Wed, 17 Jul 2019 19:08:23 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references;
 bh=hL+k5Im3uh952ZOrihQ2/8mde372zwiWCzRaHKkBNGc=;
 b=V+xrOMsYeqD+aZyKrtN7f7nSF2uZrDbSpixE2M7To/gXK5eM2dOKoAEvUWuihshZcQ
 k6g83kP4r8KoZOfetb8UiY5YjSvJIqRX3MSrBmQurBcLgdFQEAapAY8/HLpCNk1WMNbX
 WS/YIXx8AKD1816vgxY0jWL+4ivFYFwdquKhcglMOyNZh2B67bunsDLAMO407EKxVB6p
 AOBopir3x41BGoVMIyb4jHxKWXKDhb1Ru9HrulZOcIpC4jSxWyxMbtNxRyGGn4dDE9Qg
 1YXj0MGSXM6tCP8FjT5nrkTHJghz2cXVpbQbtE7hH6Gi/CMjg9RMJwTTkOApkWG4S/pb
 4TnA==
X-Gm-Message-State: APjAAAWVZXRYs+N0bVwDXqFhk9tnUOdVzsVP+hwsgqixNHGYHmSfMLMb
 tfShuM0kzWICy4Yl7fOXIW4=
X-Google-Smtp-Source: APXvYqx3izBR3WnOYVatXcx+F3gPyvKWovUudg7XLajAO1CB59vsr2GJL0qbbZRuIXG+H6ev2LT61g==
X-Received: by 2002:a05:6830:93:: with SMTP id
 a19mr8818431oto.127.1563415702285; 
 Wed, 17 Jul 2019 19:08:22 -0700 (PDT)
Received: from linux.fredlawl.com ([2600:1700:18a0:11d0:18af:e893:6cb0:139a])
 by smtp.gmail.com with ESMTPSA id
 65sm9730308otw.2.2019.07.17.19.08.21
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Wed, 17 Jul 2019 19:08:21 -0700 (PDT)
From: Frederick Lawler <fred@fredlawl.com>
To: airlied@linux.ie,
	daniel@ffwll.ch
Subject: [PATCH] drm/amdgpu: Prefer pcie_capability_read_word()
Date: Wed, 17 Jul 2019 21:07:37 -0500
Message-Id: <20190718020745.8867-2-fred@fredlawl.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190718020745.8867-1-fred@fredlawl.com>
References: <20190718020745.8867-1-fred@fredlawl.com>
X-Mailman-Approved-At: Thu, 18 Jul 2019 07:39:55 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=fredlawl-com.20150623.gappssmtp.com; s=20150623;
 h=from:to:cc:subject:date:message-id:in-reply-to:references;
 bh=hL+k5Im3uh952ZOrihQ2/8mde372zwiWCzRaHKkBNGc=;
 b=KSr/6TW7nHHUxCNQAtotKzWUAVIVIcNmYLyJCZo8tjaV75rp2CP3t4xTs2RRSAnHrN
 jeoaDwhtFFBH41vJw+PKQnDdP6jrmdTvDpUoJUm5dk3SLVa9c6wtG/N+V+gy4RpRoZMu
 U79SesiiqpKoiyyOuxo62NR0BlP8w3HZ73HWnZ1wQShdAUamAJxsfeHTvNZPIg/Xe8c6
 G57rKj+6tTrIM+7Q7d+ydNyfL9Q9vI+zXx2C0cSZQUNvmS4+rApYSVQwsJH5MGvADfKF
 3VeNX4+3VdJQDkfvGcC74uIB1xgdj+VdS2frKcY9twMQU8TnKL8BI1I5hN+NAi5ndkQ/
 +smA==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: bhelgaas@google.com, dri-devel@lists.freedesktop.org,
 amd-gfx@lists.freedesktop.org, Frederick Lawler <fred@fredlawl.com>,
 linux-kernel@vger.kernel.org
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

Q29tbWl0IDhjMGQzYTAyYzEzMCAoIlBDSTogQWRkIGFjY2Vzc29ycyBmb3IgUENJIEV4cHJlc3Mg
Q2FwYWJpbGl0eSIpCmFkZGVkIGFjY2Vzc29ycyBmb3IgdGhlIFBDSSBFeHByZXNzIENhcGFiaWxp
dHkgc28gdGhhdCBkcml2ZXJzIGRpZG4ndApuZWVkIHRvIGJlIGF3YXJlIG9mIGRpZmZlcmVuY2Vz
IGJldHdlZW4gdjEgYW5kIHYyIG9mIHRoZSBQQ0kKRXhwcmVzcyBDYXBhYmlsaXR5LgoKUmVwbGFj
ZSBwY2lfcmVhZF9jb25maWdfd29yZCgpIGFuZCBwY2lfd3JpdGVfY29uZmlnX3dvcmQoKSBjYWxs
cyB3aXRoCnBjaWVfY2FwYWJpbGl0eV9yZWFkX3dvcmQoKSBhbmQgcGNpZV9jYXBhYmlsaXR5X3dy
aXRlX3dvcmQoKS4KClNpZ25lZC1vZmYtYnk6IEZyZWRlcmljayBMYXdsZXIgPGZyZWRAZnJlZGxh
d2wuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Npay5jIHwgNzAgKysrKysr
KysrKysrKysrKysrKystLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3Np
LmMgIHwgNzAgKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0tLS0KIDIgZmlsZXMgY2hhbmdl
ZCwgODggaW5zZXJ0aW9ucygrKSwgNTIgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvY2lrLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9j
aWsuYwppbmRleCAwN2MxZjIzOWU5YzMuLjJmMzNkZDBmN2ExMSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvY2lrLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvY2lrLmMKQEAgLTEzNzcsNyArMTM3Nyw2IEBAIHN0YXRpYyBpbnQgY2lrX3NldF92Y2VfY2xv
Y2tzKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCB1MzIgZXZjbGssIHUzMiBlY2NsaykKIHN0
YXRpYyB2b2lkIGNpa19wY2llX2dlbjNfZW5hYmxlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2
KQogewogCXN0cnVjdCBwY2lfZGV2ICpyb290ID0gYWRldi0+cGRldi0+YnVzLT5zZWxmOwotCWlu
dCBicmlkZ2VfcG9zLCBncHVfcG9zOwogCXUzMiBzcGVlZF9jbnRsLCBjdXJyZW50X2RhdGFfcmF0
ZTsKIAlpbnQgaTsKIAl1MTYgdG1wMTY7CkBAIC0xNDEyLDEyICsxNDExLDcgQEAgc3RhdGljIHZv
aWQgY2lrX3BjaWVfZ2VuM19lbmFibGUoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCiAJCURS
TV9JTkZPKCJlbmFibGluZyBQQ0lFIGdlbiAyIGxpbmsgc3BlZWRzLCBkaXNhYmxlIHdpdGggYW1k
Z3B1LnBjaWVfZ2VuMj0wXG4iKTsKIAl9CiAKLQlicmlkZ2VfcG9zID0gcGNpX3BjaWVfY2FwKHJv
b3QpOwotCWlmICghYnJpZGdlX3BvcykKLQkJcmV0dXJuOwotCi0JZ3B1X3BvcyA9IHBjaV9wY2ll
X2NhcChhZGV2LT5wZGV2KTsKLQlpZiAoIWdwdV9wb3MpCisJaWYgKCFwY2lfaXNfcGNpZShyb290
KSB8fCAhcGNpX2lzX3BjaWUoYWRldi0+cGRldikpCiAJCXJldHVybjsKIAogCWlmIChhZGV2LT5w
bS5wY2llX2dlbl9tYXNrICYgQ0FJTF9QQ0lFX0xJTktfU1BFRURfU1VQUE9SVF9HRU4zKSB7CkBA
IC0xNDI3LDE0ICsxNDIxLDE3IEBAIHN0YXRpYyB2b2lkIGNpa19wY2llX2dlbjNfZW5hYmxlKHN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQogCQkJdTE2IGJyaWRnZV9jZmcyLCBncHVfY2ZnMjsK
IAkJCXUzMiBtYXhfbHcsIGN1cnJlbnRfbHcsIHRtcDsKIAotCQkJcGNpX3JlYWRfY29uZmlnX3dv
cmQocm9vdCwgYnJpZGdlX3BvcyArIFBDSV9FWFBfTE5LQ1RMLCAmYnJpZGdlX2NmZyk7Ci0JCQlw
Y2lfcmVhZF9jb25maWdfd29yZChhZGV2LT5wZGV2LCBncHVfcG9zICsgUENJX0VYUF9MTktDVEws
ICZncHVfY2ZnKTsKKwkJCXBjaWVfY2FwYWJpbGl0eV9yZWFkX3dvcmQocm9vdCwgUENJX0VYUF9M
TktDVEwsCisJCQkJCQkgICZicmlkZ2VfY2ZnKTsKKwkJCXBjaWVfY2FwYWJpbGl0eV9yZWFkX3dv
cmQoYWRldi0+cGRldiwgUENJX0VYUF9MTktDVEwsCisJCQkJCQkgICZncHVfY2ZnKTsKIAogCQkJ
dG1wMTYgPSBicmlkZ2VfY2ZnIHwgUENJX0VYUF9MTktDVExfSEFXRDsKLQkJCXBjaV93cml0ZV9j
b25maWdfd29yZChyb290LCBicmlkZ2VfcG9zICsgUENJX0VYUF9MTktDVEwsIHRtcDE2KTsKKwkJ
CXBjaWVfY2FwYWJpbGl0eV93cml0ZV93b3JkKHJvb3QsIFBDSV9FWFBfTE5LQ1RMLCB0bXAxNik7
CiAKIAkJCXRtcDE2ID0gZ3B1X2NmZyB8IFBDSV9FWFBfTE5LQ1RMX0hBV0Q7Ci0JCQlwY2lfd3Jp
dGVfY29uZmlnX3dvcmQoYWRldi0+cGRldiwgZ3B1X3BvcyArIFBDSV9FWFBfTE5LQ1RMLCB0bXAx
Nik7CisJCQlwY2llX2NhcGFiaWxpdHlfd3JpdGVfd29yZChhZGV2LT5wZGV2LCBQQ0lfRVhQX0xO
S0NUTCwKKwkJCQkJCSAgIHRtcDE2KTsKIAogCQkJdG1wID0gUlJFRzMyX1BDSUUoaXhQQ0lFX0xD
X1NUQVRVUzEpOwogCQkJbWF4X2x3ID0gKHRtcCAmIFBDSUVfTENfU1RBVFVTMV9fTENfREVURUNU
RURfTElOS19XSURUSF9NQVNLKSA+PgpAQCAtMTQ1OCwxNSArMTQ1NSwyMyBAQCBzdGF0aWMgdm9p
ZCBjaWtfcGNpZV9nZW4zX2VuYWJsZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKIAogCQkJ
Zm9yIChpID0gMDsgaSA8IDEwOyBpKyspIHsKIAkJCQkvKiBjaGVjayBzdGF0dXMgKi8KLQkJCQlw
Y2lfcmVhZF9jb25maWdfd29yZChhZGV2LT5wZGV2LCBncHVfcG9zICsgUENJX0VYUF9ERVZTVEEs
ICZ0bXAxNik7CisJCQkJcGNpZV9jYXBhYmlsaXR5X3JlYWRfd29yZChhZGV2LT5wZGV2LAorCQkJ
CQkJCSAgUENJX0VYUF9ERVZTVEEsCisJCQkJCQkJICAmdG1wMTYpOwogCQkJCWlmICh0bXAxNiAm
IFBDSV9FWFBfREVWU1RBX1RSUE5EKQogCQkJCQlicmVhazsKIAotCQkJCXBjaV9yZWFkX2NvbmZp
Z193b3JkKHJvb3QsIGJyaWRnZV9wb3MgKyBQQ0lfRVhQX0xOS0NUTCwgJmJyaWRnZV9jZmcpOwot
CQkJCXBjaV9yZWFkX2NvbmZpZ193b3JkKGFkZXYtPnBkZXYsIGdwdV9wb3MgKyBQQ0lfRVhQX0xO
S0NUTCwgJmdwdV9jZmcpOworCQkJCXBjaWVfY2FwYWJpbGl0eV9yZWFkX3dvcmQocm9vdCwgUENJ
X0VYUF9MTktDVEwsCisJCQkJCQkJICAmYnJpZGdlX2NmZyk7CisJCQkJcGNpZV9jYXBhYmlsaXR5
X3JlYWRfd29yZChhZGV2LT5wZGV2LAorCQkJCQkJCSAgUENJX0VYUF9MTktDVEwsCisJCQkJCQkJ
ICAmZ3B1X2NmZyk7CiAKLQkJCQlwY2lfcmVhZF9jb25maWdfd29yZChyb290LCBicmlkZ2VfcG9z
ICsgUENJX0VYUF9MTktDVEwyLCAmYnJpZGdlX2NmZzIpOwotCQkJCXBjaV9yZWFkX2NvbmZpZ193
b3JkKGFkZXYtPnBkZXYsIGdwdV9wb3MgKyBQQ0lfRVhQX0xOS0NUTDIsICZncHVfY2ZnMik7CisJ
CQkJcGNpZV9jYXBhYmlsaXR5X3JlYWRfd29yZChyb290LCBQQ0lfRVhQX0xOS0NUTDIsCisJCQkJ
CQkJICAmYnJpZGdlX2NmZzIpOworCQkJCXBjaWVfY2FwYWJpbGl0eV9yZWFkX3dvcmQoYWRldi0+
cGRldiwKKwkJCQkJCQkgIFBDSV9FWFBfTE5LQ1RMMiwKKwkJCQkJCQkgICZncHVfY2ZnMik7CiAK
IAkJCQl0bXAgPSBSUkVHMzJfUENJRShpeFBDSUVfTENfQ05UTDQpOwogCQkJCXRtcCB8PSBQQ0lF
X0xDX0NOVEw0X19MQ19TRVRfUVVJRVNDRV9NQVNLOwpAQCAtMTQ3OSwyNiArMTQ4NCwzOSBAQCBz
dGF0aWMgdm9pZCBjaWtfcGNpZV9nZW4zX2VuYWJsZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
dikKIAkJCQltc2xlZXAoMTAwKTsKIAogCQkJCS8qIGxpbmtjdGwgKi8KLQkJCQlwY2lfcmVhZF9j
b25maWdfd29yZChyb290LCBicmlkZ2VfcG9zICsgUENJX0VYUF9MTktDVEwsICZ0bXAxNik7CisJ
CQkJcGNpZV9jYXBhYmlsaXR5X3JlYWRfd29yZChyb290LCBQQ0lfRVhQX0xOS0NUTCwKKwkJCQkJ
CQkgICZ0bXAxNik7CiAJCQkJdG1wMTYgJj0gflBDSV9FWFBfTE5LQ1RMX0hBV0Q7CiAJCQkJdG1w
MTYgfD0gKGJyaWRnZV9jZmcgJiBQQ0lfRVhQX0xOS0NUTF9IQVdEKTsKLQkJCQlwY2lfd3JpdGVf
Y29uZmlnX3dvcmQocm9vdCwgYnJpZGdlX3BvcyArIFBDSV9FWFBfTE5LQ1RMLCB0bXAxNik7CisJ
CQkJcGNpZV9jYXBhYmlsaXR5X3dyaXRlX3dvcmQocm9vdCwgUENJX0VYUF9MTktDVEwsCisJCQkJ
CQkJICAgdG1wMTYpOwogCi0JCQkJcGNpX3JlYWRfY29uZmlnX3dvcmQoYWRldi0+cGRldiwgZ3B1
X3BvcyArIFBDSV9FWFBfTE5LQ1RMLCAmdG1wMTYpOworCQkJCXBjaWVfY2FwYWJpbGl0eV9yZWFk
X3dvcmQoYWRldi0+cGRldiwKKwkJCQkJCQkgIFBDSV9FWFBfTE5LQ1RMLAorCQkJCQkJCSAgJnRt
cDE2KTsKIAkJCQl0bXAxNiAmPSB+UENJX0VYUF9MTktDVExfSEFXRDsKIAkJCQl0bXAxNiB8PSAo
Z3B1X2NmZyAmIFBDSV9FWFBfTE5LQ1RMX0hBV0QpOwotCQkJCXBjaV93cml0ZV9jb25maWdfd29y
ZChhZGV2LT5wZGV2LCBncHVfcG9zICsgUENJX0VYUF9MTktDVEwsIHRtcDE2KTsKKwkJCQlwY2ll
X2NhcGFiaWxpdHlfd3JpdGVfd29yZChhZGV2LT5wZGV2LAorCQkJCQkJCSAgIFBDSV9FWFBfTE5L
Q1RMLAorCQkJCQkJCSAgIHRtcDE2KTsKIAogCQkJCS8qIGxpbmtjdGwyICovCi0JCQkJcGNpX3Jl
YWRfY29uZmlnX3dvcmQocm9vdCwgYnJpZGdlX3BvcyArIFBDSV9FWFBfTE5LQ1RMMiwgJnRtcDE2
KTsKKwkJCQlwY2llX2NhcGFiaWxpdHlfcmVhZF93b3JkKHJvb3QsIFBDSV9FWFBfTE5LQ1RMMiwK
KwkJCQkJCQkgICZ0bXAxNik7CiAJCQkJdG1wMTYgJj0gfigoMSA8PCA0KSB8ICg3IDw8IDkpKTsK
IAkJCQl0bXAxNiB8PSAoYnJpZGdlX2NmZzIgJiAoKDEgPDwgNCkgfCAoNyA8PCA5KSkpOwotCQkJ
CXBjaV93cml0ZV9jb25maWdfd29yZChyb290LCBicmlkZ2VfcG9zICsgUENJX0VYUF9MTktDVEwy
LCB0bXAxNik7CisJCQkJcGNpZV9jYXBhYmlsaXR5X3dyaXRlX3dvcmQocm9vdCwKKwkJCQkJCQkg
ICBQQ0lfRVhQX0xOS0NUTDIsCisJCQkJCQkJICAgdG1wMTYpOwogCi0JCQkJcGNpX3JlYWRfY29u
ZmlnX3dvcmQoYWRldi0+cGRldiwgZ3B1X3BvcyArIFBDSV9FWFBfTE5LQ1RMMiwgJnRtcDE2KTsK
KwkJCQlwY2llX2NhcGFiaWxpdHlfcmVhZF93b3JkKGFkZXYtPnBkZXYsCisJCQkJCQkJICBQQ0lf
RVhQX0xOS0NUTDIsCisJCQkJCQkJICAmdG1wMTYpOwogCQkJCXRtcDE2ICY9IH4oKDEgPDwgNCkg
fCAoNyA8PCA5KSk7CiAJCQkJdG1wMTYgfD0gKGdwdV9jZmcyICYgKCgxIDw8IDQpIHwgKDcgPDwg
OSkpKTsKLQkJCQlwY2lfd3JpdGVfY29uZmlnX3dvcmQoYWRldi0+cGRldiwgZ3B1X3BvcyArIFBD
SV9FWFBfTE5LQ1RMMiwgdG1wMTYpOworCQkJCXBjaWVfY2FwYWJpbGl0eV93cml0ZV93b3JkKGFk
ZXYtPnBkZXYsCisJCQkJCQkJICAgUENJX0VYUF9MTktDVEwyLAorCQkJCQkJCSAgIHRtcDE2KTsK
IAogCQkJCXRtcCA9IFJSRUczMl9QQ0lFKGl4UENJRV9MQ19DTlRMNCk7CiAJCQkJdG1wICY9IH5Q
Q0lFX0xDX0NOVEw0X19MQ19TRVRfUVVJRVNDRV9NQVNLOwpAQCAtMTUxMyw3ICsxNTMxLDcgQEAg
c3RhdGljIHZvaWQgY2lrX3BjaWVfZ2VuM19lbmFibGUoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFk
ZXYpCiAJc3BlZWRfY250bCAmPSB+UENJRV9MQ19TUEVFRF9DTlRMX19MQ19GT1JDRV9ESVNfU1df
U1BFRURfQ0hBTkdFX01BU0s7CiAJV1JFRzMyX1BDSUUoaXhQQ0lFX0xDX1NQRUVEX0NOVEwsIHNw
ZWVkX2NudGwpOwogCi0JcGNpX3JlYWRfY29uZmlnX3dvcmQoYWRldi0+cGRldiwgZ3B1X3BvcyAr
IFBDSV9FWFBfTE5LQ1RMMiwgJnRtcDE2KTsKKwlwY2llX2NhcGFiaWxpdHlfcmVhZF93b3JkKGFk
ZXYtPnBkZXYsIFBDSV9FWFBfTE5LQ1RMMiwgJnRtcDE2KTsKIAl0bXAxNiAmPSB+MHhmOwogCWlm
IChhZGV2LT5wbS5wY2llX2dlbl9tYXNrICYgQ0FJTF9QQ0lFX0xJTktfU1BFRURfU1VQUE9SVF9H
RU4zKQogCQl0bXAxNiB8PSAzOyAvKiBnZW4zICovCkBAIC0xNTIxLDcgKzE1MzksNyBAQCBzdGF0
aWMgdm9pZCBjaWtfcGNpZV9nZW4zX2VuYWJsZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikK
IAkJdG1wMTYgfD0gMjsgLyogZ2VuMiAqLwogCWVsc2UKIAkJdG1wMTYgfD0gMTsgLyogZ2VuMSAq
LwotCXBjaV93cml0ZV9jb25maWdfd29yZChhZGV2LT5wZGV2LCBncHVfcG9zICsgUENJX0VYUF9M
TktDVEwyLCB0bXAxNik7CisJcGNpZV9jYXBhYmlsaXR5X3dyaXRlX3dvcmQoYWRldi0+cGRldiwg
UENJX0VYUF9MTktDVEwyLCB0bXAxNik7CiAKIAlzcGVlZF9jbnRsID0gUlJFRzMyX1BDSUUoaXhQ
Q0lFX0xDX1NQRUVEX0NOVEwpOwogCXNwZWVkX2NudGwgfD0gUENJRV9MQ19TUEVFRF9DTlRMX19M
Q19JTklUSUFURV9MSU5LX1NQRUVEX0NIQU5HRV9NQVNLOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvc2kuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3NpLmMK
aW5kZXggOWQ4ZGY2ODg5M2I5Li40ZDZkOTk3MGQ0NDEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L3NpLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvc2ku
YwpAQCAtMTYxMiw3ICsxNjEyLDYgQEAgc3RhdGljIHZvaWQgc2lfaW5pdF9nb2xkZW5fcmVnaXN0
ZXJzKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQogc3RhdGljIHZvaWQgc2lfcGNpZV9nZW4z
X2VuYWJsZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKIHsKIAlzdHJ1Y3QgcGNpX2RldiAq
cm9vdCA9IGFkZXYtPnBkZXYtPmJ1cy0+c2VsZjsKLQlpbnQgYnJpZGdlX3BvcywgZ3B1X3BvczsK
IAl1MzIgc3BlZWRfY250bCwgY3VycmVudF9kYXRhX3JhdGU7CiAJaW50IGk7CiAJdTE2IHRtcDE2
OwpAQCAtMTY0NywxMiArMTY0Niw3IEBAIHN0YXRpYyB2b2lkIHNpX3BjaWVfZ2VuM19lbmFibGUo
c3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCiAJCURSTV9JTkZPKCJlbmFibGluZyBQQ0lFIGdl
biAyIGxpbmsgc3BlZWRzLCBkaXNhYmxlIHdpdGggYW1kZ3B1LnBjaWVfZ2VuMj0wXG4iKTsKIAl9
CiAKLQlicmlkZ2VfcG9zID0gcGNpX3BjaWVfY2FwKHJvb3QpOwotCWlmICghYnJpZGdlX3BvcykK
LQkJcmV0dXJuOwotCi0JZ3B1X3BvcyA9IHBjaV9wY2llX2NhcChhZGV2LT5wZGV2KTsKLQlpZiAo
IWdwdV9wb3MpCisJaWYgKCFwY2lfaXNfcGNpZShyb290KSB8fCAhcGNpX2lzX3BjaWUoYWRldi0+
cGRldikpCiAJCXJldHVybjsKIAogCWlmIChhZGV2LT5wbS5wY2llX2dlbl9tYXNrICYgQ0FJTF9Q
Q0lFX0xJTktfU1BFRURfU1VQUE9SVF9HRU4zKSB7CkBAIC0xNjYxLDE0ICsxNjU1LDE3IEBAIHN0
YXRpYyB2b2lkIHNpX3BjaWVfZ2VuM19lbmFibGUoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYp
CiAJCQl1MTYgYnJpZGdlX2NmZzIsIGdwdV9jZmcyOwogCQkJdTMyIG1heF9sdywgY3VycmVudF9s
dywgdG1wOwogCi0JCQlwY2lfcmVhZF9jb25maWdfd29yZChyb290LCBicmlkZ2VfcG9zICsgUENJ
X0VYUF9MTktDVEwsICZicmlkZ2VfY2ZnKTsKLQkJCXBjaV9yZWFkX2NvbmZpZ193b3JkKGFkZXYt
PnBkZXYsIGdwdV9wb3MgKyBQQ0lfRVhQX0xOS0NUTCwgJmdwdV9jZmcpOworCQkJcGNpZV9jYXBh
YmlsaXR5X3JlYWRfd29yZChyb290LCBQQ0lfRVhQX0xOS0NUTCwKKwkJCQkJCSAgJmJyaWRnZV9j
ZmcpOworCQkJcGNpZV9jYXBhYmlsaXR5X3JlYWRfd29yZChhZGV2LT5wZGV2LCBQQ0lfRVhQX0xO
S0NUTCwKKwkJCQkJCSAgJmdwdV9jZmcpOwogCiAJCQl0bXAxNiA9IGJyaWRnZV9jZmcgfCBQQ0lf
RVhQX0xOS0NUTF9IQVdEOwotCQkJcGNpX3dyaXRlX2NvbmZpZ193b3JkKHJvb3QsIGJyaWRnZV9w
b3MgKyBQQ0lfRVhQX0xOS0NUTCwgdG1wMTYpOworCQkJcGNpZV9jYXBhYmlsaXR5X3dyaXRlX3dv
cmQocm9vdCwgUENJX0VYUF9MTktDVEwsIHRtcDE2KTsKIAogCQkJdG1wMTYgPSBncHVfY2ZnIHwg
UENJX0VYUF9MTktDVExfSEFXRDsKLQkJCXBjaV93cml0ZV9jb25maWdfd29yZChhZGV2LT5wZGV2
LCBncHVfcG9zICsgUENJX0VYUF9MTktDVEwsIHRtcDE2KTsKKwkJCXBjaWVfY2FwYWJpbGl0eV93
cml0ZV93b3JkKGFkZXYtPnBkZXYsIFBDSV9FWFBfTE5LQ1RMLAorCQkJCQkJICAgdG1wMTYpOwog
CiAJCQl0bXAgPSBSUkVHMzJfUENJRShQQ0lFX0xDX1NUQVRVUzEpOwogCQkJbWF4X2x3ID0gKHRt
cCAmIExDX0RFVEVDVEVEX0xJTktfV0lEVEhfTUFTSykgPj4gTENfREVURUNURURfTElOS19XSURU
SF9TSElGVDsKQEAgLTE2ODUsMTUgKzE2ODIsMjMgQEAgc3RhdGljIHZvaWQgc2lfcGNpZV9nZW4z
X2VuYWJsZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKIAkJCX0KIAogCQkJZm9yIChpID0g
MDsgaSA8IDEwOyBpKyspIHsKLQkJCQlwY2lfcmVhZF9jb25maWdfd29yZChhZGV2LT5wZGV2LCBn
cHVfcG9zICsgUENJX0VYUF9ERVZTVEEsICZ0bXAxNik7CisJCQkJcGNpZV9jYXBhYmlsaXR5X3Jl
YWRfd29yZChhZGV2LT5wZGV2LAorCQkJCQkJCSAgUENJX0VYUF9ERVZTVEEsCisJCQkJCQkJICAm
dG1wMTYpOwogCQkJCWlmICh0bXAxNiAmIFBDSV9FWFBfREVWU1RBX1RSUE5EKQogCQkJCQlicmVh
azsKIAotCQkJCXBjaV9yZWFkX2NvbmZpZ193b3JkKHJvb3QsIGJyaWRnZV9wb3MgKyBQQ0lfRVhQ
X0xOS0NUTCwgJmJyaWRnZV9jZmcpOwotCQkJCXBjaV9yZWFkX2NvbmZpZ193b3JkKGFkZXYtPnBk
ZXYsIGdwdV9wb3MgKyBQQ0lfRVhQX0xOS0NUTCwgJmdwdV9jZmcpOworCQkJCXBjaWVfY2FwYWJp
bGl0eV9yZWFkX3dvcmQocm9vdCwgUENJX0VYUF9MTktDVEwsCisJCQkJCQkJICAmYnJpZGdlX2Nm
Zyk7CisJCQkJcGNpZV9jYXBhYmlsaXR5X3JlYWRfd29yZChhZGV2LT5wZGV2LAorCQkJCQkJCSAg
UENJX0VYUF9MTktDVEwsCisJCQkJCQkJICAmZ3B1X2NmZyk7CiAKLQkJCQlwY2lfcmVhZF9jb25m
aWdfd29yZChyb290LCBicmlkZ2VfcG9zICsgUENJX0VYUF9MTktDVEwyLCAmYnJpZGdlX2NmZzIp
OwotCQkJCXBjaV9yZWFkX2NvbmZpZ193b3JkKGFkZXYtPnBkZXYsIGdwdV9wb3MgKyBQQ0lfRVhQ
X0xOS0NUTDIsICZncHVfY2ZnMik7CisJCQkJcGNpZV9jYXBhYmlsaXR5X3JlYWRfd29yZChyb290
LCBQQ0lfRVhQX0xOS0NUTDIsCisJCQkJCQkJICAmYnJpZGdlX2NmZzIpOworCQkJCXBjaWVfY2Fw
YWJpbGl0eV9yZWFkX3dvcmQoYWRldi0+cGRldiwKKwkJCQkJCQkgIFBDSV9FWFBfTE5LQ1RMMiwK
KwkJCQkJCQkgICZncHVfY2ZnMik7CiAKIAkJCQl0bXAgPSBSUkVHMzJfUENJRV9QT1JUKFBDSUVf
TENfQ05UTDQpOwogCQkJCXRtcCB8PSBMQ19TRVRfUVVJRVNDRTsKQEAgLTE3MDUsMjUgKzE3MTAs
MzggQEAgc3RhdGljIHZvaWQgc2lfcGNpZV9nZW4zX2VuYWJsZShzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqYWRldikKIAogCQkJCW1kZWxheSgxMDApOwogCi0JCQkJcGNpX3JlYWRfY29uZmlnX3dvcmQo
cm9vdCwgYnJpZGdlX3BvcyArIFBDSV9FWFBfTE5LQ1RMLCAmdG1wMTYpOworCQkJCXBjaWVfY2Fw
YWJpbGl0eV9yZWFkX3dvcmQocm9vdCwgUENJX0VYUF9MTktDVEwsCisJCQkJCQkJICAmdG1wMTYp
OwogCQkJCXRtcDE2ICY9IH5QQ0lfRVhQX0xOS0NUTF9IQVdEOwogCQkJCXRtcDE2IHw9IChicmlk
Z2VfY2ZnICYgUENJX0VYUF9MTktDVExfSEFXRCk7Ci0JCQkJcGNpX3dyaXRlX2NvbmZpZ193b3Jk
KHJvb3QsIGJyaWRnZV9wb3MgKyBQQ0lfRVhQX0xOS0NUTCwgdG1wMTYpOworCQkJCXBjaWVfY2Fw
YWJpbGl0eV93cml0ZV93b3JkKHJvb3QsIFBDSV9FWFBfTE5LQ1RMLAorCQkJCQkJCSAgIHRtcDE2
KTsKIAotCQkJCXBjaV9yZWFkX2NvbmZpZ193b3JkKGFkZXYtPnBkZXYsIGdwdV9wb3MgKyBQQ0lf
RVhQX0xOS0NUTCwgJnRtcDE2KTsKKwkJCQlwY2llX2NhcGFiaWxpdHlfcmVhZF93b3JkKGFkZXYt
PnBkZXYsCisJCQkJCQkJICBQQ0lfRVhQX0xOS0NUTCwKKwkJCQkJCQkgICZ0bXAxNik7CiAJCQkJ
dG1wMTYgJj0gflBDSV9FWFBfTE5LQ1RMX0hBV0Q7CiAJCQkJdG1wMTYgfD0gKGdwdV9jZmcgJiBQ
Q0lfRVhQX0xOS0NUTF9IQVdEKTsKLQkJCQlwY2lfd3JpdGVfY29uZmlnX3dvcmQoYWRldi0+cGRl
diwgZ3B1X3BvcyArIFBDSV9FWFBfTE5LQ1RMLCB0bXAxNik7CisJCQkJcGNpZV9jYXBhYmlsaXR5
X3dyaXRlX3dvcmQoYWRldi0+cGRldiwKKwkJCQkJCQkgICBQQ0lfRVhQX0xOS0NUTCwKKwkJCQkJ
CQkgICB0bXAxNik7CiAKLQkJCQlwY2lfcmVhZF9jb25maWdfd29yZChyb290LCBicmlkZ2VfcG9z
ICsgUENJX0VYUF9MTktDVEwyLCAmdG1wMTYpOworCQkJCXBjaWVfY2FwYWJpbGl0eV9yZWFkX3dv
cmQocm9vdCwgUENJX0VYUF9MTktDVEwyLAorCQkJCQkJCSAgJnRtcDE2KTsKIAkJCQl0bXAxNiAm
PSB+KCgxIDw8IDQpIHwgKDcgPDwgOSkpOwogCQkJCXRtcDE2IHw9IChicmlkZ2VfY2ZnMiAmICgo
MSA8PCA0KSB8ICg3IDw8IDkpKSk7Ci0JCQkJcGNpX3dyaXRlX2NvbmZpZ193b3JkKHJvb3QsIGJy
aWRnZV9wb3MgKyBQQ0lfRVhQX0xOS0NUTDIsIHRtcDE2KTsKKwkJCQlwY2llX2NhcGFiaWxpdHlf
d3JpdGVfd29yZChyb290LAorCQkJCQkJCSAgIFBDSV9FWFBfTE5LQ1RMMiwKKwkJCQkJCQkgICB0
bXAxNik7CiAKLQkJCQlwY2lfcmVhZF9jb25maWdfd29yZChhZGV2LT5wZGV2LCBncHVfcG9zICsg
UENJX0VYUF9MTktDVEwyLCAmdG1wMTYpOworCQkJCXBjaWVfY2FwYWJpbGl0eV9yZWFkX3dvcmQo
YWRldi0+cGRldiwKKwkJCQkJCQkgIFBDSV9FWFBfTE5LQ1RMMiwKKwkJCQkJCQkgICZ0bXAxNik7
CiAJCQkJdG1wMTYgJj0gfigoMSA8PCA0KSB8ICg3IDw8IDkpKTsKIAkJCQl0bXAxNiB8PSAoZ3B1
X2NmZzIgJiAoKDEgPDwgNCkgfCAoNyA8PCA5KSkpOwotCQkJCXBjaV93cml0ZV9jb25maWdfd29y
ZChhZGV2LT5wZGV2LCBncHVfcG9zICsgUENJX0VYUF9MTktDVEwyLCB0bXAxNik7CisJCQkJcGNp
ZV9jYXBhYmlsaXR5X3dyaXRlX3dvcmQoYWRldi0+cGRldiwKKwkJCQkJCQkgICBQQ0lfRVhQX0xO
S0NUTDIsCisJCQkJCQkJICAgdG1wMTYpOwogCiAJCQkJdG1wID0gUlJFRzMyX1BDSUVfUE9SVChQ
Q0lFX0xDX0NOVEw0KTsKIAkJCQl0bXAgJj0gfkxDX1NFVF9RVUlFU0NFOwpAQCAtMTczNiw3ICsx
NzU0LDcgQEAgc3RhdGljIHZvaWQgc2lfcGNpZV9nZW4zX2VuYWJsZShzdHJ1Y3QgYW1kZ3B1X2Rl
dmljZSAqYWRldikKIAlzcGVlZF9jbnRsICY9IH5MQ19GT1JDRV9ESVNfU1dfU1BFRURfQ0hBTkdF
OwogCVdSRUczMl9QQ0lFX1BPUlQoUENJRV9MQ19TUEVFRF9DTlRMLCBzcGVlZF9jbnRsKTsKIAot
CXBjaV9yZWFkX2NvbmZpZ193b3JkKGFkZXYtPnBkZXYsIGdwdV9wb3MgKyBQQ0lfRVhQX0xOS0NU
TDIsICZ0bXAxNik7CisJcGNpZV9jYXBhYmlsaXR5X3JlYWRfd29yZChhZGV2LT5wZGV2LCBQQ0lf
RVhQX0xOS0NUTDIsICZ0bXAxNik7CiAJdG1wMTYgJj0gfjB4ZjsKIAlpZiAoYWRldi0+cG0ucGNp
ZV9nZW5fbWFzayAmIENBSUxfUENJRV9MSU5LX1NQRUVEX1NVUFBPUlRfR0VOMykKIAkJdG1wMTYg
fD0gMzsKQEAgLTE3NDQsNyArMTc2Miw3IEBAIHN0YXRpYyB2b2lkIHNpX3BjaWVfZ2VuM19lbmFi
bGUoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCiAJCXRtcDE2IHw9IDI7CiAJZWxzZQogCQl0
bXAxNiB8PSAxOwotCXBjaV93cml0ZV9jb25maWdfd29yZChhZGV2LT5wZGV2LCBncHVfcG9zICsg
UENJX0VYUF9MTktDVEwyLCB0bXAxNik7CisJcGNpZV9jYXBhYmlsaXR5X3dyaXRlX3dvcmQoYWRl
di0+cGRldiwgUENJX0VYUF9MTktDVEwyLCB0bXAxNik7CiAKIAlzcGVlZF9jbnRsID0gUlJFRzMy
X1BDSUVfUE9SVChQQ0lFX0xDX1NQRUVEX0NOVEwpOwogCXNwZWVkX2NudGwgfD0gTENfSU5JVElB
VEVfTElOS19TUEVFRF9DSEFOR0U7Ci0tIAoyLjE3LjEKCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWlsaW5nIGxpc3QKZHJpLWRldmVs
QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWls
bWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
