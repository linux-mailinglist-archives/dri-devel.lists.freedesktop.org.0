Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 35D97CE5CE5
	for <lists+dri-devel@lfdr.de>; Mon, 29 Dec 2025 04:15:30 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F097710EFDA;
	Mon, 29 Dec 2025 03:15:26 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from outboundhk.mxmail.xiaomi.com (outboundhk.mxmail.xiaomi.com
 [207.226.244.123])
 by gabe.freedesktop.org (Postfix) with ESMTP id 756F810EFDA
 for <dri-devel@lists.freedesktop.org>; Mon, 29 Dec 2025 03:15:24 +0000 (UTC)
X-CSE-ConnectionGUID: gL00neweRmGMHNuZpWUtJA==
X-CSE-MsgGUID: sCW06OhsSCmG/p9PJhmsGw==
X-IronPort-AV: E=Sophos;i="6.21,184,1763395200"; 
 d="scan'208,217";a="162630051"
From: =?gb2312?B?uN/P6A==?= <gaoxiang17@xiaomi.com>
To: Steven Rostedt <rostedt@goodmis.org>, Xiang Gao <gxxa03070307@gmail.com>
CC: "sumit.semwal@linaro.org" <sumit.semwal@linaro.org>,
 "christian.koenig@amd.com" <christian.koenig@amd.com>, "mhiramat@kernel.org"
 <mhiramat@kernel.org>, "linux-media@vger.kernel.org"
 <linux-media@vger.kernel.org>, "dri-devel@lists.freedesktop.org"
 <dri-devel@lists.freedesktop.org>, "linux-kernel@vger.kernel.org"
 <linux-kernel@vger.kernel.org>, "mathieu.desnoyers@efficios.com"
 <mathieu.desnoyers@efficios.com>, "dhowells@redhat.com"
 <dhowells@redhat.com>, "kuba@kernel.org" <kuba@kernel.org>,
 "brauner@kernel.org" <brauner@kernel.org>, "akpm@linux-foundation.org"
 <akpm@linux-foundation.org>, "linux-trace-kernel@vger.kernel.org"
 <linux-trace-kernel@vger.kernel.org>
Subject: =?gb2312?B?tPC4tDogW0V4dGVybmFsIE1haWxdUmU6IFtQQVRDSCB2MTFdIGRtYS1idWY6?=
 =?gb2312?Q?_add_some_tracepoints_to_debug.?=
Thread-Topic: [External Mail]Re: [PATCH v11] dma-buf: add some tracepoints to
 debug.
Thread-Index: AQHcdoadv7XiotU3gUS1tHSqz05co7U2wCPa
Date: Mon, 29 Dec 2025 03:15:19 +0000
Message-ID: <131e4734fe2b4b08bf9ee75cdc27b259@xiaomi.com>
References: <20251225121119.2194228-1-gxxa03070307@gmail.com>,
 <20251226114215.02be95a3@gandalf.local.home>
In-Reply-To: <20251226114215.02be95a3@gandalf.local.home>
Accept-Language: zh-CN, en-US
Content-Language: zh-CN
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [10.237.8.163]
Content-Type: multipart/alternative;
 boundary="_000_131e4734fe2b4b08bf9ee75cdc27b259xiaomicom_"
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

--_000_131e4734fe2b4b08bf9ee75cdc27b259xiaomicom_
Content-Type: text/plain; charset="gb2312"
Content-Transfer-Encoding: base64

DQpvaywgdGhhbmsgeW91IGZvciB5b3VyIGd1aWRhbmNlLg0KDQpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXw0Kt6K8/sjLOiBTdGV2ZW4gUm9zdGVkdCA8cm9zdGVkdEBnb29kbWlzLm9y
Zz4NCreiy83KsbzkOiAyMDI1xOoxMtTCMjfI1SAwOjQyOjE1DQrK1bz+yMs6IFhpYW5nIEdhbw0K
s63LzTogc3VtaXQuc2Vtd2FsQGxpbmFyby5vcmc7IGNocmlzdGlhbi5rb2VuaWdAYW1kLmNvbTsg
bWhpcmFtYXRAa2VybmVsLm9yZzsgbGludXgtbWVkaWFAdmdlci5rZXJuZWwub3JnOyBkcmktZGV2
ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnOyBsaW51eC1rZXJuZWxAdmdlci5rZXJuZWwub3JnOyBt
YXRoaWV1LmRlc25veWVyc0BlZmZpY2lvcy5jb207IGRob3dlbGxzQHJlZGhhdC5jb207IGt1YmFA
a2VybmVsLm9yZzsgYnJhdW5lckBrZXJuZWwub3JnOyBha3BtQGxpbnV4LWZvdW5kYXRpb24ub3Jn
OyBsaW51eC10cmFjZS1rZXJuZWxAdmdlci5rZXJuZWwub3JnOyC438/oDQrW98ziOiBbRXh0ZXJu
YWwgTWFpbF1SZTogW1BBVENIIHYxMV0gZG1hLWJ1ZjogYWRkIHNvbWUgdHJhY2Vwb2ludHMgdG8g
ZGVidWcuDQoNClvN4rK/08q8/l0gtMvTyrz+wLTUtNPa0KHD17mry77N4rK/o6zH6733yfe0psDt
oaPI9LbU08q8/rCyyKvQ1LTm0smjrMfrvavTyrz+16q3orj4bWlzZWNAeGlhb21pLmNvbb340NC3
tMChDQoNCk9uIFRodSwgMjUgRGVjIDIwMjUgMjA6MTE6MTkgKzA4MDANClhpYW5nIEdhbyA8Z3h4
YTAzMDcwMzA3QGdtYWlsLmNvbT4gd3JvdGU6DQoNCj4gRnJvbTogZ2FveGlhbmcxNyA8Z2FveGlh
bmcxN0B4aWFvbWkuY29tPg0KPg0KPiBTaW5jZSB3ZSBjYW4gb25seSBpbnNwZWN0IGRtYWJ1ZiBi
eSBpdGVyYXRpbmcgb3ZlciBwcm9jZXNzIEZEcyBvciB0aGUNCj4gZG1hYnVmX2xpc3QsIHdlIG5l
ZWQgdG8gYWRkIG91ciBvd24gdHJhY2Vwb2ludHMgdG8gdHJhY2sgaXRzIHN0YXR1cyBpbg0KPiBy
ZWFsIHRpbWUgaW4gcHJvZHVjdGlvbi4NCj4NCj4gRm9yIGV4YW1wbGU6DQo+ICAgIGJpbmRlcjoz
MDE2XzEtMzEwMiAgICBbMDA2XSAuLi4xLiAgIDI1NS4xMjY1MjE6IGRtYV9idWZfZXhwb3J0OiBl
eHBfbmFtZT1xY29tLHN5c3RlbSBzaXplPTEyNjg1MzEyIGlubz0yNzM4DQo+ICAgIGJpbmRlcjoz
MDE2XzEtMzEwMiAgICBbMDA2XSAuLi4xLiAgIDI1NS4xMjY1Mjg6IGRtYV9idWZfZmQ6IGV4cF9u
YW1lPXFjb20sc3lzdGVtIHNpemU9MTI2ODUzMTIgaW5vPTI3MzggZmQ9OA0KPiAgICBiaW5kZXI6
MzAxNl8xLTMxMDIgICAgWzAwNl0gLi4uMS4gICAyNTUuMTI2NjQyOiBkbWFfYnVmX21tYXBfaW50
ZXJuYWw6IGV4cF9uYW1lPXFjb20sc3lzdGVtIHNpemU9Mjg2NzIgaW5vPTI3MzkNCj4gICAgICBr
d29ya2VyLzY6MS04NiAgICAgIFswMDZdIC4uLjEuICAgMjU1LjEyNzE5NDogZG1hX2J1Zl9wdXQ6
IGV4cF9uYW1lPXFjb20sc3lzdGVtIHNpemU9MTI2ODUzMTIgaW5vPTI3MzgNCj4gICAgIFJlbmRl
clRocmVhZC05MjkzICAgIFswMDZdIC4uLjEuICAgMzE2LjYxODE3OTogZG1hX2J1Zl9nZXQ6IGV4
cF9uYW1lPXFjb20sc3lzdGVtIHNpemU9MTI3NzEzMjggaW5vPTI3NjIgZmQ9MTc2DQo+ICAgICBS
ZW5kZXJUaHJlYWQtOTI5MyAgICBbMDA2XSAuLi4xLiAgIDMxNi42MTgxOTU6IGRtYV9idWZfZHlu
YW1pY19hdHRhY2g6IGV4cF9uYW1lPXFjb20sc3lzdGVtIHNpemU9MTI3NzEzMjggaW5vPTI3NjIg
YXR0YWNobWVudDpmZmZmZmY4ODBhMThkZDAwIGlzX2R5bmFtaWM9MCBkZXZfbmFtZT1rZ3NsLTNk
MA0KPiAgICAgUmVuZGVyVGhyZWFkLTkyOTMgICAgWzAwNl0gLi4uMS4gICAzMTguODc4MjIwOiBk
bWFfYnVmX2RldGFjaDogZXhwX25hbWU9cWNvbSxzeXN0ZW0gc2l6ZT0xMjc3MTMyOCBpbm89Mjc2
MiBhdHRhY2htZW50OmZmZmZmZjg4MGExOGRkMDAgaXNfZHluYW1pYz0wIGRldl9uYW1lPWtnc2wt
M2QwDQo+DQo+IFNpZ25lZC1vZmYtYnk6IFhpYW5nIEdhbyA8Z2FveGlhbmcxN0B4aWFvbWkuY29t
Pg0KPiAtLS0NCj4NCj4gQ2hhbmdlcyBzaW5jZSB2MTA6IGh0dHBzOi8vbG9yZS5rZXJuZWwub3Jn
L2FsbC8yMDI1MTIyNDAxMzQ1NS4xNjQ5ODc5LTEtZ3h4YTAzMDcwMzA3QGdtYWlsLmNvbS8NCg0K
WW91IG9ubHkgbmVlZCB0byBzaG93IHRoZSBsYXN0IHJldmlzaW9uIChidXQgc2luY2UgeW91IGhh
dmVuJ3Qgc2hvd2VkIHRoZQ0Kb3RoZXJzLCBiZWZvcmUgaXQncyBnb29kIHRvIHNob3cgdGhlbSBu
b3cpLiBCdXQgeW91IGFsc28gd2FudCB0byBzYXkgIndoYXQgY2hhbmdlZCINCg0KRm9yIGV4YW1w
bGU6DQoNCi0gVXNlZCBERUZJTkVfRVZFTlRfQ09ORElUSU9OKCkgdG8gbW92ZSB0aGUgY29uZGl0
aW9uIGJyYW5jaCBpbnRvIHRoZSB0cmFjZXBvaW50Lg0KDQoNCj4gQ2hhbmdlcyBzaW5jZSB2OTog
aHR0cHM6Ly9sb3JlLmtlcm5lbC5vcmcvYWxsLzIwMjUxMjIzMDMyNzQ5LjEzNzE5MTMtMS1neHhh
MDMwNzAzMDdAZ21haWwuY29tLw0KPiBDaGFuZ2VzIHNpbmNlIHY4OiBodHRwczovL2xvcmUua2Vy
bmVsLm9yZy9hbGwvMjAyNTEyMTgwNjI4NTMuODE5NzQ0LTEtZ3h4YTAzMDcwMzA3QGdtYWlsLmNv
bS8NCj4gQ2hhbmdlcyBzaW5jZSB2NzogaHR0cHM6Ly9sb3JlLmtlcm5lbC5vcmcvYWxsLzIwMjUx
MjE3MTA1MTMyLjY0MzMwMC0xLWd4eGEwMzA3MDMwN0BnbWFpbC5jb20vDQo+IENoYW5nZXMgc2lu
Y2UgdjY6IGh0dHBzOi8vbG9yZS5rZXJuZWwub3JnL2FsbC8yMDI1MTIxNjA2Mzk1Mi41MTYzNjQt
MS1neHhhMDMwNzAzMDdAZ21haWwuY29tLw0KPiBDaGFuZ2VzIHNpbmNlIHY1OiBodHRwczovL2xv
cmUua2VybmVsLm9yZy9hbGwvMjAyNTEyMDExMTIxNDguODQzNTcyLTEtZ3h4YTAzMDcwMzA3QGdt
YWlsLmNvbS8NCj4gQ2hhbmdlcyBzaW5jZSB2NDogaHR0cHM6Ly9sb3JlLmtlcm5lbC5vcmcvYWxs
LzIwMjUxMTI4MDg1MjE1LjU1MDEwMC0xLWd4eGEwMzA3MDMwN0BnbWFpbC5jb20vDQo+IENoYW5n
ZXMgc2luY2UgdjM6IGh0dHBzOi8vbG9yZS5rZXJuZWwub3JnL2FsbC8yMDI1MTEyNzAwNDM1Mi4z
NzYzMDctMS1neHhhMDMwNzAzMDdAZ21haWwuY29tLw0KPiBDaGFuZ2VzIHNpbmNlIHYyOiBodHRw
czovL2xvcmUua2VybmVsLm9yZy9hbGwvMjAyNTExMjUxNjI5NDkuMjIwNDg4LTEtZ3h4YTAzMDcw
MzA3QGdtYWlsLmNvbS8NCj4gQ2hhbmdlcyBzaW5jZSB2MTogaHR0cHM6Ly9sb3JlLmtlcm5lbC5v
cmcvYWxsLzIwMjUxMTI0MTMzNjQ4LjcyNjY4LTEtZ3h4YTAzMDcwMzA3QGdtYWlsLmNvbS8NCj4N
Cj4gIGRyaXZlcnMvZG1hLWJ1Zi9kbWEtYnVmLmMgICAgICB8ICA0OCArKysrKysrKystDQo+ICBp
bmNsdWRlL3RyYWNlL2V2ZW50cy9kbWFfYnVmLmggfCAxNTkgKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrDQo+ICAyIGZpbGVzIGNoYW5nZWQsIDIwNSBpbnNlcnRpb25zKCspLCAyIGRl
bGV0aW9ucygtKQ0KPiAgY3JlYXRlIG1vZGUgMTAwNjQ0IGluY2x1ZGUvdHJhY2UvZXZlbnRzL2Rt
YV9idWYuaA0KPg0KDQoNCj4gKy8qDQo+ICsgKiBkbWFidWYtPm5hbWUgbXVzdCBiZSBhY2Nlc3Nl
ZCB3aXRoIGhvbGRpbmcgZG1hYnVmLT5uYW1lX2xvY2suDQo+ICsgKiB3ZSBuZWVkIHRvIHRha2Ug
dGhlIGxvY2sgYXJvdW5kIHRoZSB0cmFjZXBvaW50IGNhbGwgaXRzZWxmIHdoZXJlDQo+ICsgKiBp
dCBpcyBjYWxsZWQgaW4gdGhlIGNvZGUuDQo+ICsgKg0KPiArICogTm90ZTogRlVOQyMjX2VuYWJs
ZWQoKSBpcyBhIHN0YXRpYyBicmFuY2ggdGhhdCB3aWxsIG9ubHkNCj4gKyAqICAgICAgIGJlIHNl
dCB3aGVuIHRoZSB0cmFjZSBldmVudCBpcyBlbmFibGVkLg0KPiArICovDQo+ICsjZGVmaW5lIERN
QV9CVUZfVFJBQ0UoRlVOQywgLi4uKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBcDQo+ICsgICAgIGRvIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBcDQo+ICsgICAgICAgICAgICAgLyogQWx3YXlzIGV4cG9zZSBs
b2NrIGlmIGxvY2tkZXAgaXMgZW5hYmxlZCAqLyAgICAgICAgICBcDQo+ICsgICAgICAgICAgICAg
aWYgKElTX0VOQUJMRUQoQ09ORklHX0xPQ0tERVApIHx8IEZVTkMjI19lbmFibGVkKCkpIHsgICBc
DQo+ICsgICAgICAgICAgICAgICAgICAgICBndWFyZChzcGlubG9jaykoJmRtYWJ1Zi0+bmFtZV9s
b2NrKTsgICAgICAgICAgICBcDQo+ICsgICAgICAgICAgICAgICAgICAgICBGVU5DKF9fVkFfQVJH
U19fKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcDQo+ICsgICAgICAgICAgICAgfSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcDQo+
ICsgICAgIH0gd2hpbGUgKDApDQo+ICsNCj4gIHN0YXRpYyBpbmxpbmUgaW50IGlzX2RtYV9idWZf
ZmlsZShzdHJ1Y3QgZmlsZSAqKTsNCj4NCg0KPiArDQo+ICtERUZJTkVfRVZFTlRfQ09ORElUSU9O
KGRtYV9idWZfZmQsIGRtYV9idWZfZmQsDQo+ICsNCj4gKyAgICAgVFBfUFJPVE8oc3RydWN0IGRt
YV9idWYgKmRtYWJ1ZiwgaW50IGZkKSwNCj4gKw0KPiArICAgICBUUF9BUkdTKGRtYWJ1ZiwgZmQp
LA0KPiArDQo+ICsgICAgIFRQX0NPTkRJVElPTihmZCA+PSAwKQ0KPiArKTsNCj4gKw0KDQoNCkZy
b20gYSB0cmFjaW5nIHBvaW50IG9mIHZpZXcgKEl0J3MgdXAgdG8gdGhlIGRtYSBtYWludGFpbmVy
cyB0byBkZWNpZGUgdG8NCnRha2UgdGhpcyBwYXRjaCk6DQoNClJldmlld2VkLWJ5OiBTdGV2ZW4g
Um9zdGVkdCAoR29vZ2xlKSA8cm9zdGVkdEBnb29kbWlzLm9yZz4NCg0KLS0gU3RldmUNCg==

--_000_131e4734fe2b4b08bf9ee75cdc27b259xiaomicom_
Content-Type: text/html; charset="gb2312"
Content-Transfer-Encoding: quoted-printable

<html>
<head>
<meta http-equiv=3D"Content-Type" content=3D"text/html; charset=3Dgb2312">
<style type=3D"text/css" style=3D"display:none;"><!-- P {margin-top:0;margi=
n-bottom:0;} --></style>
</head>
<body dir=3D"ltr">
<div id=3D"divtagdefaultwrapper" style=3D"font-size:12pt;color:#000000;font=
-family:Calibri,Helvetica,sans-serif;" dir=3D"ltr">
<p><br>
</p>
<meta content=3D"text/html; charset=3DUTF-8">
<div dir=3D"ltr">
<div id=3D"x_divtagdefaultwrapper" dir=3D"ltr" style=3D"font-size: 12pt; co=
lor: rgb(0, 0, 0); font-family: Calibri, Helvetica, sans-serif, EmojiFont, =
&quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, NotoColorEmoji, =
&quot;Segoe UI Symbol&quot;, &quot;Android Emoji&quot;, EmojiSymbols;">
<p>ok, t<span>hank you for your guidance.</span></p>
</div>
<hr tabindex=3D"-1" style=3D"display:inline-block; width:98%">
<div id=3D"x_divRplyFwdMsg" dir=3D"ltr"><font face=3D"Calibri, sans-serif" =
color=3D"#000000" style=3D"font-size:11pt"><b>=B7=A2=BC=FE=C8=CB:</b> Steve=
n Rostedt &lt;rostedt@goodmis.org&gt;<br>
<b>=B7=A2=CB=CD=CA=B1=BC=E4:</b> 2025=C4=EA12=D4=C227=C8=D5 0:42:15<br>
<b>=CA=D5=BC=FE=C8=CB:</b> Xiang Gao<br>
<b>=B3=AD=CB=CD:</b> sumit.semwal@linaro.org; christian.koenig@amd.com; mhi=
ramat@kernel.org; linux-media@vger.kernel.org; dri-devel@lists.freedesktop.=
org; linux-kernel@vger.kernel.org; mathieu.desnoyers@efficios.com; dhowells=
@redhat.com; kuba@kernel.org; brauner@kernel.org;
 akpm@linux-foundation.org; linux-trace-kernel@vger.kernel.org; =B8=DF=CF=
=E8<br>
<b>=D6=F7=CC=E2:</b> [External Mail]Re: [PATCH v11] dma-buf: add some trace=
points to debug.</font>
<div>&nbsp;</div>
</div>
</div>
<font size=3D"2"><span style=3D"font-size:10pt">
<div class=3D"PlainText">[=CD=E2=B2=BF=D3=CA=BC=FE] =B4=CB=D3=CA=BC=FE=C0=
=B4=D4=B4=D3=DA=D0=A1=C3=D7=B9=AB=CB=BE=CD=E2=B2=BF=A3=AC=C7=EB=BD=F7=C9=F7=
=B4=A6=C0=ED=A1=A3=C8=F4=B6=D4=D3=CA=BC=FE=B0=B2=C8=AB=D0=D4=B4=E6=D2=C9=A3=
=AC=C7=EB=BD=AB=D3=CA=BC=FE=D7=AA=B7=A2=B8=F8misec@xiaomi.com=BD=F8=D0=D0=
=B7=B4=C0=A1<br>
<br>
On Thu, 25 Dec 2025 20:11:19 &#43;0800<br>
Xiang Gao &lt;gxxa03070307@gmail.com&gt; wrote:<br>
<br>
&gt; From: gaoxiang17 &lt;gaoxiang17@xiaomi.com&gt;<br>
&gt;<br>
&gt; Since we can only inspect dmabuf by iterating over process FDs or the<=
br>
&gt; dmabuf_list, we need to add our own tracepoints to track its status in=
<br>
&gt; real time in production.<br>
&gt;<br>
&gt; For example:<br>
&gt;&nbsp;&nbsp;&nbsp; binder:3016_1-3102&nbsp;&nbsp;&nbsp; [006] ...1.&nbs=
p;&nbsp; 255.126521: dma_buf_export: exp_name=3Dqcom,system size=3D12685312=
 ino=3D2738<br>
&gt;&nbsp;&nbsp;&nbsp; binder:3016_1-3102&nbsp;&nbsp;&nbsp; [006] ...1.&nbs=
p;&nbsp; 255.126528: dma_buf_fd: exp_name=3Dqcom,system size=3D12685312 ino=
=3D2738 fd=3D8<br>
&gt;&nbsp;&nbsp;&nbsp; binder:3016_1-3102&nbsp;&nbsp;&nbsp; [006] ...1.&nbs=
p;&nbsp; 255.126642: dma_buf_mmap_internal: exp_name=3Dqcom,system size=3D2=
8672 ino=3D2739<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; kworker/6:1-86&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp; [006] ...1.&nbsp;&nbsp; 255.127194: dma_buf_put: exp_name=3Dqcom,syste=
m size=3D12685312 ino=3D2738<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp; RenderThread-9293&nbsp;&nbsp;&nbsp; [006] ...1=
.&nbsp;&nbsp; 316.618179: dma_buf_get: exp_name=3Dqcom,system size=3D127713=
28 ino=3D2762 fd=3D176<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp; RenderThread-9293&nbsp;&nbsp;&nbsp; [006] ...1=
.&nbsp;&nbsp; 316.618195: dma_buf_dynamic_attach: exp_name=3Dqcom,system si=
ze=3D12771328 ino=3D2762 attachment:ffffff880a18dd00 is_dynamic=3D0 dev_nam=
e=3Dkgsl-3d0<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp; RenderThread-9293&nbsp;&nbsp;&nbsp; [006] ...1=
.&nbsp;&nbsp; 318.878220: dma_buf_detach: exp_name=3Dqcom,system size=3D127=
71328 ino=3D2762 attachment:ffffff880a18dd00 is_dynamic=3D0 dev_name=3Dkgsl=
-3d0<br>
&gt;<br>
&gt; Signed-off-by: Xiang Gao &lt;gaoxiang17@xiaomi.com&gt;<br>
&gt; ---<br>
&gt;<br>
&gt; Changes since v10: <a href=3D"https://lore.kernel.org/all/202512240134=
55.1649879-1-gxxa03070307@gmail.com/" id=3D"LPlnk126232">
https://lore.kernel.org/all/20251224013455.1649879-1-gxxa03070307@gmail.com=
/</a><br>
<br>
You only need to show the last revision (but since you haven't showed the<b=
r>
others, before it's good to show them now). But you also want to say &quot;=
what changed&quot;<br>
<br>
For example:<br>
<br>
- Used DEFINE_EVENT_CONDITION() to move the condition branch into the trace=
point.<br>
<br>
<br>
&gt; Changes since v9: <a href=3D"https://lore.kernel.org/all/2025122303274=
9.1371913-1-gxxa03070307@gmail.com/">
https://lore.kernel.org/all/20251223032749.1371913-1-gxxa03070307@gmail.com=
/</a><br>
&gt; Changes since v8: <a href=3D"https://lore.kernel.org/all/2025121806285=
3.819744-1-gxxa03070307@gmail.com/">
https://lore.kernel.org/all/20251218062853.819744-1-gxxa03070307@gmail.com/=
</a><br>
&gt; Changes since v7: <a href=3D"https://lore.kernel.org/all/2025121710513=
2.643300-1-gxxa03070307@gmail.com/">
https://lore.kernel.org/all/20251217105132.643300-1-gxxa03070307@gmail.com/=
</a><br>
&gt; Changes since v6: <a href=3D"https://lore.kernel.org/all/2025121606395=
2.516364-1-gxxa03070307@gmail.com/">
https://lore.kernel.org/all/20251216063952.516364-1-gxxa03070307@gmail.com/=
</a><br>
&gt; Changes since v5: <a href=3D"https://lore.kernel.org/all/2025120111214=
8.843572-1-gxxa03070307@gmail.com/">
https://lore.kernel.org/all/20251201112148.843572-1-gxxa03070307@gmail.com/=
</a><br>
&gt; Changes since v4: <a href=3D"https://lore.kernel.org/all/2025112808521=
5.550100-1-gxxa03070307@gmail.com/">
https://lore.kernel.org/all/20251128085215.550100-1-gxxa03070307@gmail.com/=
</a><br>
&gt; Changes since v3: <a href=3D"https://lore.kernel.org/all/2025112700435=
2.376307-1-gxxa03070307@gmail.com/">
https://lore.kernel.org/all/20251127004352.376307-1-gxxa03070307@gmail.com/=
</a><br>
&gt; Changes since v2: <a href=3D"https://lore.kernel.org/all/2025112516294=
9.220488-1-gxxa03070307@gmail.com/">
https://lore.kernel.org/all/20251125162949.220488-1-gxxa03070307@gmail.com/=
</a><br>
&gt; Changes since v1: <a href=3D"https://lore.kernel.org/all/2025112413364=
8.72668-1-gxxa03070307@gmail.com/">
https://lore.kernel.org/all/20251124133648.72668-1-gxxa03070307@gmail.com/<=
/a><br>
&gt;<br>
&gt;&nbsp; drivers/dma-buf/dma-buf.c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; =
48 &#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;-<br>
&gt;&nbsp; include/trace/events/dma_buf.h | 159 &#43;&#43;&#43;&#43;&#43;&#=
43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#=
43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;<br>
&gt;&nbsp; 2 files changed, 205 insertions(&#43;), 2 deletions(-)<br>
&gt;&nbsp; create mode 100644 include/trace/events/dma_buf.h<br>
&gt;<br>
<br>
<br>
&gt; &#43;/*<br>
&gt; &#43; * dmabuf-&gt;name must be accessed with holding dmabuf-&gt;name_=
lock.<br>
&gt; &#43; * we need to take the lock around the tracepoint call itself whe=
re<br>
&gt; &#43; * it is called in the code.<br>
&gt; &#43; *<br>
&gt; &#43; * Note: FUNC##_enabled() is a static branch that will only<br>
&gt; &#43; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; be set when the trace even=
t is enabled.<br>
&gt; &#43; */<br>
&gt; &#43;#define DMA_BUF_TRACE(FUNC, ...)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \<br>
&gt; &#43;&nbsp;&nbsp;&nbsp;&nbsp; do {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp; \<br>
&gt; &#43;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp; /* Always expose lock if lockdep is enabled */&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \<br>
&gt; &#43;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp; if (IS_ENABLED(CONFIG_LOCKDEP) || FUNC##_enabled()) {&nbsp;&nbsp; \=
<br>
&gt; &#43;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; guard(spinlock)(&am=
p;dmabuf-&gt;name_lock);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp; \<br>
&gt; &#43;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FUNC(__VA_ARGS__);&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp; \<br>
&gt; &#43;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp; }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \<br>
&gt; &#43;&nbsp;&nbsp;&nbsp;&nbsp; } while (0)<br>
&gt; &#43;<br>
&gt;&nbsp; static inline int is_dma_buf_file(struct file *);<br>
&gt;<br>
<br>
&gt; &#43;<br>
&gt; &#43;DEFINE_EVENT_CONDITION(dma_buf_fd, dma_buf_fd,<br>
&gt; &#43;<br>
&gt; &#43;&nbsp;&nbsp;&nbsp;&nbsp; TP_PROTO(struct dma_buf *dmabuf, int fd)=
,<br>
&gt; &#43;<br>
&gt; &#43;&nbsp;&nbsp;&nbsp;&nbsp; TP_ARGS(dmabuf, fd),<br>
&gt; &#43;<br>
&gt; &#43;&nbsp;&nbsp;&nbsp;&nbsp; TP_CONDITION(fd &gt;=3D 0)<br>
&gt; &#43;);<br>
&gt; &#43;<br>
<br>
<br>
From a tracing point of view (It's up to the dma maintainers to decide to<b=
r>
take this patch):<br>
<br>
Reviewed-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;<br>
<br>
-- Steve<br>
</div>
</span></font></div>
</body>
</html>

--_000_131e4734fe2b4b08bf9ee75cdc27b259xiaomicom_--
