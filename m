Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id A69D52AD844
	for <lists+dri-devel@lfdr.de>; Tue, 10 Nov 2020 15:08:21 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 17FC289A8C;
	Tue, 10 Nov 2020 14:08:17 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from foss.arm.com (foss.arm.com [217.140.110.172])
 by gabe.freedesktop.org (Postfix) with ESMTP id 9172D89AC0
 for <dri-devel@lists.freedesktop.org>; Tue, 10 Nov 2020 14:08:15 +0000 (UTC)
Received: from usa-sjc-imap-foss1.foss.arm.com (unknown [10.121.207.14])
 by usa-sjc-mx-foss1.foss.arm.com (Postfix) with ESMTP id AAB091063;
 Tue, 10 Nov 2020 06:08:14 -0800 (PST)
Received: from e110455-lin.cambridge.arm.com (usa-sjc-imap-foss1.foss.arm.com
 [10.121.207.14])
 by usa-sjc-imap-foss1.foss.arm.com (Postfix) with ESMTPSA id 6FE283F718;
 Tue, 10 Nov 2020 06:08:14 -0800 (PST)
Received: by e110455-lin.cambridge.arm.com (Postfix, from userid 1000)
 id 26BB768324F; Tue, 10 Nov 2020 14:08:13 +0000 (GMT)
Date: Tue, 10 Nov 2020 14:08:13 +0000
From: Liviu Dudau <liviu.dudau@arm.com>
To: Maxime Ripard <maxime@cerno.tech>
Subject: Re: [PATCH v2] drm: Use state helper instead of CRTC state pointer
Message-ID: <20201110140813.GY1008493@e110455-lin.cambridge.arm.com>
References: <20201105164518.392891-1-maxime@cerno.tech>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <20201105164518.392891-1-maxime@cerno.tech>
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Chun-Kuang Hu <chunkuang.hu@kernel.org>, David Airlie <airlied@linux.ie>,
 Russell King <linux@armlinux.org.uk>, dri-devel@lists.freedesktop.org,
 Sandy Huang <hjc@rock-chips.com>, Paul Cercueil <paul@crapouillou.net>,
 Thierry Reding <thierry.reding@gmail.com>,
 "James \(Qian\) Wang" <james.qian.wang@arm.com>,
 Gerd Hoffmann <kraxel@redhat.com>, Thomas Zimmermann <tzimmermann@suse.de>,
 Daniel Vetter <daniel.vetter@intel.com>,
 Mihail Atanassov <mihail.atanassov@arm.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gVGh1LCBOb3YgMDUsIDIwMjAgYXQgMDU6NDU6MThQTSArMDEwMCwgTWF4aW1lIFJpcGFyZCB3
cm90ZToKPiBNYW55IGRyaXZlcnMgcmVmZXJlbmNlIHRoZSBjcnRjLT5wb2ludGVyIGluIG9yZGVy
IHRvIGdldCB0aGUgY3VycmVudCBDUlRDCj4gc3RhdGUgaW4gdGhlaXIgYXRvbWljX2JlZ2luIG9y
IGF0b21pY19mbHVzaCBob29rcywgd2hpY2ggd291bGQgYmUgdGhlIG5ldwo+IENSVEMgc3RhdGUg
aW4gdGhlIGdsb2JhbCBhdG9taWMgc3RhdGUgc2luY2UgX3N3YXBfc3RhdGUgaGFwcGVuZWQgd2hl
biB0aG9zZQo+IGhvb2tzIGFyZSBydW4uCj4gCj4gVXNlIHRoZSBkcm1fYXRvbWljX2dldF9uZXdf
Y3J0Y19zdGF0ZSBoZWxwZXIgdG8gZ2V0IHRoYXQgc3RhdGUgdG8gbWFrZSBpdAo+IG1vcmUgb2J2
aW91cy4KPiAKPiBUaGlzIHdhcyBtYWRlIHVzaW5nIHRoZSBjb2NjaW5lbGxlIHNjcmlwdCBiZWxv
dzoKPiAKPiBAIGNydGNfYXRvbWljX2Z1bmMgQAo+IGlkZW50aWZpZXIgaGVscGVyczsKPiBpZGVu
dGlmaWVyIGZ1bmM7Cj4gQEAKPiAKPiAoCj4gc3RhdGljIHN0cnVjdCBkcm1fY3J0Y19oZWxwZXJf
ZnVuY3MgaGVscGVycyA9IHsKPiAJLi4uLAo+IAkuYXRvbWljX2JlZ2luID0gZnVuYywKPiAJLi4u
LAo+IH07Cj4gfAo+IHN0YXRpYyBzdHJ1Y3QgZHJtX2NydGNfaGVscGVyX2Z1bmNzIGhlbHBlcnMg
PSB7Cj4gCS4uLiwKPiAJLmF0b21pY19mbHVzaCA9IGZ1bmMsCj4gCS4uLiwKPiB9Owo+ICkKPiAK
PiBAQAo+IGlkZW50aWZpZXIgY3J0Y19hdG9taWNfZnVuYy5mdW5jOwo+IGlkZW50aWZpZXIgY3J0
Yywgc3RhdGU7Cj4gc3ltYm9sIGNydGNfc3RhdGU7Cj4gZXhwcmVzc2lvbiBlOwo+IEBACj4gCj4g
ICBmdW5jKHN0cnVjdCBkcm1fY3J0YyAqY3J0Yywgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0
YXRlKSB7Cj4gICAuLi4KPiAtIHN0cnVjdCB0ZWdyYV9kY19zdGF0ZSAqY3J0Y19zdGF0ZSA9IGU7
Cj4gKyBzdHJ1Y3QgdGVncmFfZGNfc3RhdGUgKmRjX3N0YXRlID0gZTsKPiAgIDwrLi4uCj4gLSAg
ICAgICBjcnRjX3N0YXRlCj4gKwlkY19zdGF0ZQo+ICAgLi4uKz4KPiAgIH0KPiAKPiBAQAo+IGlk
ZW50aWZpZXIgY3J0Y19hdG9taWNfZnVuYy5mdW5jOwo+IGlkZW50aWZpZXIgY3J0Yywgc3RhdGU7
Cj4gc3ltYm9sIGNydGNfc3RhdGU7Cj4gZXhwcmVzc2lvbiBlOwo+IEBACj4gCj4gICBmdW5jKHN0
cnVjdCBkcm1fY3J0YyAqY3J0Yywgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKSB7Cj4g
ICAuLi4KPiAtIHN0cnVjdCBtdGtfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9IGU7Cj4gKyBzdHJ1
Y3QgbXRrX2NydGNfc3RhdGUgKm10a19jcnRjX3N0YXRlID0gZTsKPiAgIDwrLi4uCj4gLSAgICAg
ICBjcnRjX3N0YXRlCj4gKwltdGtfY3J0Y19zdGF0ZQo+ICAgLi4uKz4KPiAgIH0KPiAKPiBAIHJl
cGxhY2VzX25ld19zdGF0ZSBACj4gaWRlbnRpZmllciBjcnRjX2F0b21pY19mdW5jLmZ1bmM7Cj4g
aWRlbnRpZmllciBjcnRjLCBzdGF0ZSwgY3J0Y19zdGF0ZTsKPiBAQAo+IAo+ICAgZnVuYyhzdHJ1
Y3QgZHJtX2NydGMgKmNydGMsIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkgewo+ICAg
Li4uCj4gLSBzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKmNydGNfc3RhdGUgPSBjcnRjLT5zdGF0ZTsK
PiArIHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X25l
d19jcnRjX3N0YXRlKHN0YXRlLCBjcnRjKTsKPiAgIC4uLgo+ICB9Cj4gCj4gQEAKPiBpZGVudGlm
aWVyIGNydGNfYXRvbWljX2Z1bmMuZnVuYzsKPiBpZGVudGlmaWVyIGNydGMsIHN0YXRlLCBjcnRj
X3N0YXRlOwo+IEBACj4gCj4gICBmdW5jKHN0cnVjdCBkcm1fY3J0YyAqY3J0Yywgc3RydWN0IGRy
bV9hdG9taWNfc3RhdGUgKnN0YXRlKSB7Cj4gICBzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUgPSBkcm1fYXRvbWljX2dldF9uZXdfY3J0Y19zdGF0ZShzdGF0ZSwgY3J0Yyk7Cj4gICAu
Li4KPiAtIGNydGMtPnN0YXRlCj4gKyBjcnRjX3N0YXRlCj4gICAuLi4KPiAgfQo+IAo+IEAgYWRk
c19uZXdfc3RhdGUgQAo+IGlkZW50aWZpZXIgY3J0Y19hdG9taWNfZnVuYy5mdW5jOwo+IGlkZW50
aWZpZXIgY3J0Yywgc3RhdGU7Cj4gQEAKPiAKPiAgIGZ1bmMoc3RydWN0IGRybV9jcnRjICpjcnRj
LCBzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpIHsKPiArIHN0cnVjdCBkcm1fY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X25ld19jcnRjX3N0YXRlKHN0YXRlLCBj
cnRjKTsKPiAgIC4uLgo+IC0gY3J0Yy0+c3RhdGUKPiArIGNydGNfc3RhdGUKPiAgIC4uLgo+ICB9
Cj4gCj4gQCBpbmNsdWRlIGRlcGVuZHMgb24gYWRkc19uZXdfc3RhdGUgfHwgcmVwbGFjZXNfbmV3
X3N0YXRlIEAKPiBAQAo+IAo+ICAjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWMuaD4KPiAKPiBAIG5v
X2luY2x1ZGUgZGVwZW5kcyBvbiAhaW5jbHVkZSAmJiAoYWRkc19uZXdfc3RhdGUgfHwgcmVwbGFj
ZXNfbmV3X3N0YXRlKSBACj4gQEAKPiAKPiArICNpbmNsdWRlIDxkcm0vZHJtX2F0b21pYy5oPgo+
ICAgI2luY2x1ZGUgPGRybS8uLi4+Cj4gCj4gQ2M6ICJKYW1lcyAoUWlhbikgV2FuZyIgPGphbWVz
LnFpYW4ud2FuZ0Bhcm0uY29tPgo+IENjOiBMaXZpdSBEdWRhdSA8bGl2aXUuZHVkYXVAYXJtLmNv
bT4KPiBDYzogTWloYWlsIEF0YW5hc3NvdiA8bWloYWlsLmF0YW5hc3NvdkBhcm0uY29tPgo+IENj
OiBCcmlhbiBTdGFya2V5IDxicmlhbi5zdGFya2V5QGFybS5jb20+Cj4gQ2M6IFJ1c3NlbGwgS2lu
ZyA8bGludXhAYXJtbGludXgub3JnLnVrPgo+IENjOiBQYXVsIENlcmN1ZWlsIDxwYXVsQGNyYXBv
dWlsbG91Lm5ldD4KPiBDYzogQ2h1bi1LdWFuZyBIdSA8Y2h1bmt1YW5nLmh1QGtlcm5lbC5vcmc+
Cj4gQ2M6IFBoaWxpcHAgWmFiZWwgPHAuemFiZWxAcGVuZ3V0cm9uaXguZGU+Cj4gQ2M6IFNhbmR5
IEh1YW5nIDxoamNAcm9jay1jaGlwcy5jb20+Cj4gQ2M6ICJIZWlrbyBTdMO8Ym5lciIgPGhlaWtv
QHNudGVjaC5kZT4KPiBDYzogVGhpZXJyeSBSZWRpbmcgPHRoaWVycnkucmVkaW5nQGdtYWlsLmNv
bT4KPiBDYzogR2VyZCBIb2ZmbWFubiA8a3JheGVsQHJlZGhhdC5jb20+Cj4gUmV2aWV3ZWQtYnk6
IFZpbGxlIFN5cmrDpGzDpCA8dmlsbGUuc3lyamFsYUBsaW51eC5pbnRlbC5jb20+Cj4gU3VnZ2Vz
dGVkLWJ5OiBWaWxsZSBTeXJqw6Rsw6QgPHZpbGxlLnN5cmphbGFAbGludXguaW50ZWwuY29tPgo+
IFNpZ25lZC1vZmYtYnk6IE1heGltZSBSaXBhcmQgPG1heGltZUBjZXJuby50ZWNoPgo+IAo+IC0t
LQo+IAo+IENoYW5nZXMgZnJvbSB2MToKPiAgIC0gRml4ZWQgY2hlY2twYXRjaCB3YXJuaW5ncwo+
IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vYXJtL2Rpc3BsYXkva29tZWRhL2tvbWVkYV9jcnRjLmMg
fCAgNCArKystCj4gIGRyaXZlcnMvZ3B1L2RybS9hcm1hZGEvYXJtYWRhX2NydGMuYyAgICAgICAg
ICAgICB8ICA4ICsrKysrKy0tCj4gIGRyaXZlcnMvZ3B1L2RybS9hc3QvYXN0X21vZGUuYyAgICAg
ICAgICAgICAgICAgICB8ICA0ICsrKy0KPiAgZHJpdmVycy9ncHUvZHJtL2luZ2VuaWMvaW5nZW5p
Yy1kcm0tZHJ2LmMgICAgICAgIHwgIDcgKysrKystLQo+ICBkcml2ZXJzL2dwdS9kcm0vbWVkaWF0
ZWsvbXRrX2RybV9jcnRjLmMgICAgICAgICAgfCAxNSArKysrKysrKystLS0tLS0KPiAgZHJpdmVy
cy9ncHUvZHJtL3JvY2tjaGlwL3JvY2tjaGlwX2RybV92b3AuYyAgICAgIHwgIDYgKysrKy0tCj4g
IGRyaXZlcnMvZ3B1L2RybS90ZWdyYS9kYy5jICAgICAgICAgICAgICAgICAgICAgICB8ICA4ICsr
KysrLS0tCj4gIGRyaXZlcnMvZ3B1L2RybS92aXJ0aW8vdmlydGdwdV9kaXNwbGF5LmMgICAgICAg
ICB8ICA0ICsrKy0KPiAgOCBmaWxlcyBjaGFuZ2VkLCAzOCBpbnNlcnRpb25zKCspLCAxOCBkZWxl
dGlvbnMoLSkKPiAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FybS9kaXNwbGF5L2tv
bWVkYS9rb21lZGFfY3J0Yy5jIGIvZHJpdmVycy9ncHUvZHJtL2FybS9kaXNwbGF5L2tvbWVkYS9r
b21lZGFfY3J0Yy5jCj4gaW5kZXggZGYwYjllZWI4OTMzLi40YjQ4NWViNTEyZTIgMTAwNjQ0Cj4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2FybS9kaXNwbGF5L2tvbWVkYS9rb21lZGFfY3J0Yy5jCj4g
KysrIGIvZHJpdmVycy9ncHUvZHJtL2FybS9kaXNwbGF5L2tvbWVkYS9rb21lZGFfY3J0Yy5jCj4g
QEAgLTM4NywxMCArMzg3LDEyIEBAIHN0YXRpYyB2b2lkCj4gIGtvbWVkYV9jcnRjX2F0b21pY19m
bHVzaChzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gIAkJCSBzdHJ1Y3QgZHJtX2F0b21pY19zdGF0
ZSAqc3RhdGUpCj4gIHsKPiArCXN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9IGRy
bV9hdG9taWNfZ2V0X25ld19jcnRjX3N0YXRlKHN0YXRlLAo+ICsJCQkJCQkJCQkgIGNydGMpOwo+
ICAJc3RydWN0IGRybV9jcnRjX3N0YXRlICpvbGQgPSBkcm1fYXRvbWljX2dldF9vbGRfY3J0Y19z
dGF0ZShzdGF0ZSwKPiAgCQkJCQkJCQkgICBjcnRjKTsKPiAgCS8qIGNvbW1pdCB3aXRoIG1vZGVz
ZXQgd2lsbCBiZSBoYW5kbGVkIGluIGVuYWJsZS9kaXNhYmxlICovCj4gLQlpZiAoZHJtX2F0b21p
Y19jcnRjX25lZWRzX21vZGVzZXQoY3J0Yy0+c3RhdGUpKQo+ICsJaWYgKGRybV9hdG9taWNfY3J0
Y19uZWVkc19tb2Rlc2V0KGNydGNfc3RhdGUpKQo+ICAJCXJldHVybjsKPiAgCj4gIAlrb21lZGFf
Y3J0Y19kb19mbHVzaChjcnRjLCBvbGQpOwoKRm9yIHRoZSBrb21lZGEgcGFydDoKCkFja2VkLWJ5
OiBMaXZpdSBEdWRhdSA8bGl2aXVAZHVkYXUuY28udWs+CgoKPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FybWFkYS9hcm1hZGFfY3J0Yy5jIGIvZHJpdmVycy9ncHUvZHJtL2FybWFkYS9h
cm1hZGFfY3J0Yy5jCj4gaW5kZXggY2E2NDNmNGUyMDY0Li4zZWJjZjVhNTJjOGIgMTAwNjQ0Cj4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2FybWFkYS9hcm1hZGFfY3J0Yy5jCj4gKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2FybWFkYS9hcm1hZGFfY3J0Yy5jCj4gQEAgLTQzMSwxMSArNDMxLDEzIEBAIHN0
YXRpYyBpbnQgYXJtYWRhX2RybV9jcnRjX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX2NydGMgKmNy
dGMsCj4gIHN0YXRpYyB2b2lkIGFybWFkYV9kcm1fY3J0Y19hdG9taWNfYmVnaW4oc3RydWN0IGRy
bV9jcnRjICpjcnRjLAo+ICAJCQkJCSBzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4g
IHsKPiArCXN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9IGRybV9hdG9taWNfZ2V0
X25ld19jcnRjX3N0YXRlKHN0YXRlLAo+ICsJCQkJCQkJCQkgIGNydGMpOwo+ICAJc3RydWN0IGFy
bWFkYV9jcnRjICpkY3J0YyA9IGRybV90b19hcm1hZGFfY3J0YyhjcnRjKTsKPiAgCj4gIAlEUk1f
REVCVUdfS01TKCJbQ1JUQzolZDolc11cbiIsIGNydGMtPmJhc2UuaWQsIGNydGMtPm5hbWUpOwo+
ICAKPiAtCWlmIChjcnRjLT5zdGF0ZS0+Y29sb3JfbWdtdF9jaGFuZ2VkKQo+ICsJaWYgKGNydGNf
c3RhdGUtPmNvbG9yX21nbXRfY2hhbmdlZCkKPiAgCQlhcm1hZGFfZHJtX3VwZGF0ZV9nYW1tYShj
cnRjKTsKPiAgCj4gIAlkY3J0Yy0+cmVnc19pZHggPSAwOwo+IEBAIC00NDUsNiArNDQ3LDggQEAg
c3RhdGljIHZvaWQgYXJtYWRhX2RybV9jcnRjX2F0b21pY19iZWdpbihzdHJ1Y3QgZHJtX2NydGMg
KmNydGMsCj4gIHN0YXRpYyB2b2lkIGFybWFkYV9kcm1fY3J0Y19hdG9taWNfZmx1c2goc3RydWN0
IGRybV9jcnRjICpjcnRjLAo+ICAJCQkJCSBzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUp
Cj4gIHsKPiArCXN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9IGRybV9hdG9taWNf
Z2V0X25ld19jcnRjX3N0YXRlKHN0YXRlLAo+ICsJCQkJCQkJCQkgIGNydGMpOwo+ICAJc3RydWN0
IGFybWFkYV9jcnRjICpkY3J0YyA9IGRybV90b19hcm1hZGFfY3J0YyhjcnRjKTsKPiAgCj4gIAlE
Uk1fREVCVUdfS01TKCJbQ1JUQzolZDolc11cbiIsIGNydGMtPmJhc2UuaWQsIGNydGMtPm5hbWUp
Owo+IEBAIC00NTUsNyArNDU5LDcgQEAgc3RhdGljIHZvaWQgYXJtYWRhX2RybV9jcnRjX2F0b21p
Y19mbHVzaChzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gIAkgKiBJZiB3ZSBhcmVuJ3QgZG9pbmcg
YSBmdWxsIG1vZGVzZXQsIHRoZW4gd2UgbmVlZCB0byBxdWV1ZQo+ICAJICogdGhlIGV2ZW50IGhl
cmUuCj4gIAkgKi8KPiAtCWlmICghZHJtX2F0b21pY19jcnRjX25lZWRzX21vZGVzZXQoY3J0Yy0+
c3RhdGUpKSB7Cj4gKwlpZiAoIWRybV9hdG9taWNfY3J0Y19uZWVkc19tb2Rlc2V0KGNydGNfc3Rh
dGUpKSB7Cj4gIAkJZGNydGMtPnVwZGF0ZV9wZW5kaW5nID0gdHJ1ZTsKPiAgCQlhcm1hZGFfZHJt
X2NydGNfcXVldWVfc3RhdGVfZXZlbnQoY3J0Yyk7Cj4gIAkJc3Bpbl9sb2NrX2lycSgmZGNydGMt
PmlycV9sb2NrKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FzdC9hc3RfbW9kZS5j
IGIvZHJpdmVycy9ncHUvZHJtL2FzdC9hc3RfbW9kZS5jCj4gaW5kZXggMjJmMGU2NWZiZTlhLi45
ZGIzNzFmNDA1NGYgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FzdC9hc3RfbW9kZS5j
Cj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FzdC9hc3RfbW9kZS5jCj4gQEAgLTc4MiwxMCArNzgy
LDEyIEBAIHN0YXRpYyB2b2lkCj4gIGFzdF9jcnRjX2hlbHBlcl9hdG9taWNfZmx1c2goc3RydWN0
IGRybV9jcnRjICpjcnRjLAo+ICAJCQkgICAgIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0
ZSkKPiAgewo+ICsJc3RydWN0IGRybV9jcnRjX3N0YXRlICpjcnRjX3N0YXRlID0gZHJtX2F0b21p
Y19nZXRfbmV3X2NydGNfc3RhdGUoc3RhdGUsCj4gKwkJCQkJCQkJCSAgY3J0Yyk7Cj4gIAlzdHJ1
Y3QgZHJtX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlID0gZHJtX2F0b21pY19nZXRfb2xkX2Ny
dGNfc3RhdGUoc3RhdGUsCj4gIAkJCQkJCQkJCSAgICAgIGNydGMpOwo+ICAJc3RydWN0IGFzdF9w
cml2YXRlICphc3QgPSB0b19hc3RfcHJpdmF0ZShjcnRjLT5kZXYpOwo+IC0Jc3RydWN0IGFzdF9j
cnRjX3N0YXRlICphc3RfY3J0Y19zdGF0ZSA9IHRvX2FzdF9jcnRjX3N0YXRlKGNydGMtPnN0YXRl
KTsKPiArCXN0cnVjdCBhc3RfY3J0Y19zdGF0ZSAqYXN0X2NydGNfc3RhdGUgPSB0b19hc3RfY3J0
Y19zdGF0ZShjcnRjX3N0YXRlKTsKPiAgCXN0cnVjdCBhc3RfY3J0Y19zdGF0ZSAqb2xkX2FzdF9j
cnRjX3N0YXRlID0gdG9fYXN0X2NydGNfc3RhdGUob2xkX2NydGNfc3RhdGUpOwo+ICAKPiAgCS8q
Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pbmdlbmljL2luZ2VuaWMtZHJtLWRydi5j
IGIvZHJpdmVycy9ncHUvZHJtL2luZ2VuaWMvaW5nZW5pYy1kcm0tZHJ2LmMKPiBpbmRleCBiOWMx
NTZlMTMxNTYuLjc2MDNmODZkZDBkMSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaW5n
ZW5pYy9pbmdlbmljLWRybS1kcnYuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pbmdlbmljL2lu
Z2VuaWMtZHJtLWRydi5jCj4gQEAgLTMwNSwxMSArMzA1LDEzIEBAIGluZ2VuaWNfZHJtX2NydGNf
bW9kZV92YWxpZChzdHJ1Y3QgZHJtX2NydGMgKmNydGMsIGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxh
eV9tb2RlCj4gIHN0YXRpYyB2b2lkIGluZ2VuaWNfZHJtX2NydGNfYXRvbWljX2JlZ2luKHN0cnVj
dCBkcm1fY3J0YyAqY3J0YywKPiAgCQkJCQkgIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0
ZSkKPiAgewo+ICsJc3RydWN0IGRybV9jcnRjX3N0YXRlICpjcnRjX3N0YXRlID0gZHJtX2F0b21p
Y19nZXRfbmV3X2NydGNfc3RhdGUoc3RhdGUsCj4gKwkJCQkJCQkJCSAgY3J0Yyk7Cj4gIAlzdHJ1
Y3QgaW5nZW5pY19kcm0gKnByaXYgPSBkcm1fY3J0Y19nZXRfcHJpdihjcnRjKTsKPiAgCXUzMiBj
dHJsID0gMDsKPiAgCj4gIAlpZiAocHJpdi0+c29jX2luZm8tPmhhc19vc2QgJiYKPiAtCSAgICBk
cm1fYXRvbWljX2NydGNfbmVlZHNfbW9kZXNldChjcnRjLT5zdGF0ZSkpIHsKPiArCSAgICBkcm1f
YXRvbWljX2NydGNfbmVlZHNfbW9kZXNldChjcnRjX3N0YXRlKSkgewo+ICAJCS8qCj4gIAkJICog
SWYgSVBVIHBsYW5lIGlzIGVuYWJsZWQsIGVuYWJsZSBJUFUgYXMgc291cmNlIGZvciB0aGUgRjEK
PiAgCQkgKiBwbGFuZTsgb3RoZXJ3aXNlIHVzZSByZWd1bGFyIERNQS4KPiBAQCAtMzI2LDcgKzMy
OCw4IEBAIHN0YXRpYyB2b2lkIGluZ2VuaWNfZHJtX2NydGNfYXRvbWljX2ZsdXNoKHN0cnVjdCBk
cm1fY3J0YyAqY3J0YywKPiAgCQkJCQkgIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkK
PiAgewo+ICAJc3RydWN0IGluZ2VuaWNfZHJtICpwcml2ID0gZHJtX2NydGNfZ2V0X3ByaXYoY3J0
Yyk7Cj4gLQlzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKmNydGNfc3RhdGUgPSBjcnRjLT5zdGF0ZTsK
PiArCXN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X25l
d19jcnRjX3N0YXRlKHN0YXRlLAo+ICsJCQkJCQkJCQkgIGNydGMpOwo+ICAJc3RydWN0IGRybV9w
ZW5kaW5nX3ZibGFua19ldmVudCAqZXZlbnQgPSBjcnRjX3N0YXRlLT5ldmVudDsKPiAgCj4gIAlp
ZiAoZHJtX2F0b21pY19jcnRjX25lZWRzX21vZGVzZXQoY3J0Y19zdGF0ZSkpIHsKPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fY3J0Yy5jIGIvZHJpdmVycy9n
cHUvZHJtL21lZGlhdGVrL210a19kcm1fY3J0Yy5jCj4gaW5kZXggMjNmNWMxMGIwYzY3Li4xOTM4
NDhmZDc1MTUgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1f
Y3J0Yy5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL21lZGlhdGVrL210a19kcm1fY3J0Yy5jCj4g
QEAgLTExLDYgKzExLDcgQEAKPiAgI2luY2x1ZGUgPGFzbS9iYXJyaWVyLmg+Cj4gICNpbmNsdWRl
IDxzb2MvbWVkaWF0ZWsvc21pLmg+Cj4gIAo+ICsjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWMuaD4K
PiAgI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljX2hlbHBlci5oPgo+ICAjaW5jbHVkZSA8ZHJtL2Ry
bV9wbGFuZV9oZWxwZXIuaD4KPiAgI2luY2x1ZGUgPGRybS9kcm1fcHJvYmVfaGVscGVyLmg+Cj4g
QEAgLTU3NywxNyArNTc4LDE5IEBAIHN0YXRpYyB2b2lkIG10a19kcm1fY3J0Y19hdG9taWNfZGlz
YWJsZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gIHN0YXRpYyB2b2lkIG10a19kcm1fY3J0Y19h
dG9taWNfYmVnaW4oc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ICAJCQkJICAgICAgc3RydWN0IGRy
bV9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgbXRrX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUgPSB0b19tdGtfY3J0Y19zdGF0ZShjcnRjLT5zdGF0ZSk7Cj4gKwlzdHJ1Y3QgZHJt
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9uZXdfY3J0Y19zdGF0ZShz
dGF0ZSwKPiArCQkJCQkJCQkJICBjcnRjKTsKPiArCXN0cnVjdCBtdGtfY3J0Y19zdGF0ZSAqbXRr
X2NydGNfc3RhdGUgPSB0b19tdGtfY3J0Y19zdGF0ZShjcnRjX3N0YXRlKTsKPiAgCXN0cnVjdCBt
dGtfZHJtX2NydGMgKm10a19jcnRjID0gdG9fbXRrX2NydGMoY3J0Yyk7Cj4gIAo+IC0JaWYgKG10
a19jcnRjLT5ldmVudCAmJiBjcnRjX3N0YXRlLT5iYXNlLmV2ZW50KQo+ICsJaWYgKG10a19jcnRj
LT5ldmVudCAmJiBtdGtfY3J0Y19zdGF0ZS0+YmFzZS5ldmVudCkKPiAgCQlEUk1fRVJST1IoIm5l
dyBldmVudCB3aGlsZSB0aGVyZSBpcyBzdGlsbCBhIHBlbmRpbmcgZXZlbnRcbiIpOwo+ICAKPiAt
CWlmIChjcnRjX3N0YXRlLT5iYXNlLmV2ZW50KSB7Cj4gLQkJY3J0Y19zdGF0ZS0+YmFzZS5ldmVu
dC0+cGlwZSA9IGRybV9jcnRjX2luZGV4KGNydGMpOwo+ICsJaWYgKG10a19jcnRjX3N0YXRlLT5i
YXNlLmV2ZW50KSB7Cj4gKwkJbXRrX2NydGNfc3RhdGUtPmJhc2UuZXZlbnQtPnBpcGUgPSBkcm1f
Y3J0Y19pbmRleChjcnRjKTsKPiAgCQlXQVJOX09OKGRybV9jcnRjX3ZibGFua19nZXQoY3J0Yykg
IT0gMCk7Cj4gLQkJbXRrX2NydGMtPmV2ZW50ID0gY3J0Y19zdGF0ZS0+YmFzZS5ldmVudDsKPiAt
CQljcnRjX3N0YXRlLT5iYXNlLmV2ZW50ID0gTlVMTDsKPiArCQltdGtfY3J0Yy0+ZXZlbnQgPSBt
dGtfY3J0Y19zdGF0ZS0+YmFzZS5ldmVudDsKPiArCQltdGtfY3J0Y19zdGF0ZS0+YmFzZS5ldmVu
dCA9IE5VTEw7Cj4gIAl9Cj4gIH0KPiAgCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9y
b2NrY2hpcC9yb2NrY2hpcF9kcm1fdm9wLmMgYi9kcml2ZXJzL2dwdS9kcm0vcm9ja2NoaXAvcm9j
a2NoaXBfZHJtX3ZvcC5jCj4gaW5kZXggOGNkMzlmY2E4MWEzLi5kMWUwNTQ4MjY0MWIgMTAwNjQ0
Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL3JvY2tjaGlwL3JvY2tjaGlwX2RybV92b3AuYwo+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9yb2NrY2hpcC9yb2NrY2hpcF9kcm1fdm9wLmMKPiBAQCAtMTI0
OCw2ICsxMjQ4LDggQEAgc3RhdGljIHZvaWQgdm9wX2NydGNfZ2FtbWFfc2V0KHN0cnVjdCB2b3Ag
KnZvcCwgc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ICBzdGF0aWMgdm9pZCB2b3BfY3J0Y19hdG9t
aWNfYmVnaW4oc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ICAJCQkJICBzdHJ1Y3QgZHJtX2F0b21p
Y19zdGF0ZSAqc3RhdGUpCj4gIHsKPiArCXN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSA9IGRybV9hdG9taWNfZ2V0X25ld19jcnRjX3N0YXRlKHN0YXRlLAo+ICsJCQkJCQkJCQkgIGNy
dGMpOwo+ICAJc3RydWN0IGRybV9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSA9IGRybV9hdG9t
aWNfZ2V0X29sZF9jcnRjX3N0YXRlKHN0YXRlLAo+ICAJCQkJCQkJCQkgICAgICBjcnRjKTsKPiAg
CXN0cnVjdCB2b3AgKnZvcCA9IHRvX3ZvcChjcnRjKTsKPiBAQCAtMTI1Niw4ICsxMjU4LDggQEAg
c3RhdGljIHZvaWQgdm9wX2NydGNfYXRvbWljX2JlZ2luKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywK
PiAgCSAqIE9ubHkgdXBkYXRlIEdBTU1BIGlmIHRoZSAnYWN0aXZlJyBmbGFnIGlzIG5vdCBjaGFu
Z2VkLAo+ICAJICogb3RoZXJ3aXNlIGl0J3MgdXBkYXRlZCBieSAuYXRvbWljX2VuYWJsZS4KPiAg
CSAqLwo+IC0JaWYgKGNydGMtPnN0YXRlLT5jb2xvcl9tZ210X2NoYW5nZWQgJiYKPiAtCSAgICAh
Y3J0Yy0+c3RhdGUtPmFjdGl2ZV9jaGFuZ2VkKQo+ICsJaWYgKGNydGNfc3RhdGUtPmNvbG9yX21n
bXRfY2hhbmdlZCAmJgo+ICsJICAgICFjcnRjX3N0YXRlLT5hY3RpdmVfY2hhbmdlZCkKPiAgCQl2
b3BfY3J0Y19nYW1tYV9zZXQodm9wLCBjcnRjLCBvbGRfY3J0Y19zdGF0ZSk7Cj4gIH0KPiAgCj4g
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90ZWdyYS9kYy5jIGIvZHJpdmVycy9ncHUvZHJt
L3RlZ3JhL2RjLmMKPiBpbmRleCAyZDg2NjI3YjBkNGUuLjg1ZGQ3MTMxNTUzYSAxMDA2NDQKPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vdGVncmEvZGMuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS90
ZWdyYS9kYy5jCj4gQEAgLTE5MzksMTUgKzE5MzksMTcgQEAgc3RhdGljIHZvaWQgdGVncmFfY3J0
Y19hdG9taWNfYmVnaW4oc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ICBzdGF0aWMgdm9pZCB0ZWdy
YV9jcnRjX2F0b21pY19mbHVzaChzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gIAkJCQkgICAgc3Ry
dWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgdGVncmFfZGNfc3Rh
dGUgKmNydGNfc3RhdGUgPSB0b19kY19zdGF0ZShjcnRjLT5zdGF0ZSk7Cj4gKwlzdHJ1Y3QgZHJt
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9uZXdfY3J0Y19zdGF0ZShz
dGF0ZSwKPiArCQkJCQkJCQkJICBjcnRjKTsKPiArCXN0cnVjdCB0ZWdyYV9kY19zdGF0ZSAqZGNf
c3RhdGUgPSB0b19kY19zdGF0ZShjcnRjX3N0YXRlKTsKPiAgCXN0cnVjdCB0ZWdyYV9kYyAqZGMg
PSB0b190ZWdyYV9kYyhjcnRjKTsKPiAgCXUzMiB2YWx1ZTsKPiAgCj4gLQl2YWx1ZSA9IGNydGNf
c3RhdGUtPnBsYW5lcyA8PCA4IHwgR0VORVJBTF9VUERBVEU7Cj4gKwl2YWx1ZSA9IGRjX3N0YXRl
LT5wbGFuZXMgPDwgOCB8IEdFTkVSQUxfVVBEQVRFOwo+ICAJdGVncmFfZGNfd3JpdGVsKGRjLCB2
YWx1ZSwgRENfQ01EX1NUQVRFX0NPTlRST0wpOwo+ICAJdmFsdWUgPSB0ZWdyYV9kY19yZWFkbChk
YywgRENfQ01EX1NUQVRFX0NPTlRST0wpOwo+ICAKPiAtCXZhbHVlID0gY3J0Y19zdGF0ZS0+cGxh
bmVzIHwgR0VORVJBTF9BQ1RfUkVROwo+ICsJdmFsdWUgPSBkY19zdGF0ZS0+cGxhbmVzIHwgR0VO
RVJBTF9BQ1RfUkVROwo+ICAJdGVncmFfZGNfd3JpdGVsKGRjLCB2YWx1ZSwgRENfQ01EX1NUQVRF
X0NPTlRST0wpOwo+ICAJdmFsdWUgPSB0ZWdyYV9kY19yZWFkbChkYywgRENfQ01EX1NUQVRFX0NP
TlRST0wpOwo+ICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92aXJ0aW8vdmlydGdw
dV9kaXNwbGF5LmMgYi9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfZGlzcGxheS5jCj4g
aW5kZXggNGJmNzQ4MzZiZDUzLi5hNmNhZWJkNGEwZGQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL3ZpcnRpby92aXJ0Z3B1X2Rpc3BsYXkuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS92
aXJ0aW8vdmlydGdwdV9kaXNwbGF5LmMKPiBAQCAtMTE5LDYgKzExOSw4IEBAIHN0YXRpYyBpbnQg
dmlydGlvX2dwdV9jcnRjX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gIHN0
YXRpYyB2b2lkIHZpcnRpb19ncHVfY3J0Y19hdG9taWNfZmx1c2goc3RydWN0IGRybV9jcnRjICpj
cnRjLAo+ICAJCQkJCSBzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gIHsKPiArCXN0
cnVjdCBkcm1fY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X25ld19jcnRj
X3N0YXRlKHN0YXRlLAo+ICsJCQkJCQkJCQkgIGNydGMpOwo+ICAJc3RydWN0IHZpcnRpb19ncHVf
b3V0cHV0ICpvdXRwdXQgPSBkcm1fY3J0Y190b192aXJ0aW9fZ3B1X291dHB1dChjcnRjKTsKPiAg
Cj4gIAkvKgo+IEBAIC0xMjcsNyArMTI5LDcgQEAgc3RhdGljIHZvaWQgdmlydGlvX2dwdV9jcnRj
X2F0b21pY19mbHVzaChzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gIAkgKiBpbiB0aGUgcGxhbmUg
dXBkYXRlIGNhbGxiYWNrLCBhbmQgaGVyZSB3ZSBqdXN0IGNoZWNrCj4gIAkgKiB3aGVuZXZlciB3
ZSBtdXN0IGZvcmNlIHRoZSBtb2Rlc2V0Lgo+ICAJICovCj4gLQlpZiAoZHJtX2F0b21pY19jcnRj
X25lZWRzX21vZGVzZXQoY3J0Yy0+c3RhdGUpKSB7Cj4gKwlpZiAoZHJtX2F0b21pY19jcnRjX25l
ZWRzX21vZGVzZXQoY3J0Y19zdGF0ZSkpIHsKPiAgCQlvdXRwdXQtPm5lZWRzX21vZGVzZXQgPSB0
cnVlOwo+ICAJfQo+ICB9Cj4gLS0gCj4gMi4yOC4wCj4gCgotLSAKPT09PT09PT09PT09PT09PT09
PT0KfCBJIHdvdWxkIGxpa2UgdG8gfAp8IGZpeCB0aGUgd29ybGQsICB8CnwgYnV0IHRoZXkncmUg
bm90IHwKfCBnaXZpbmcgbWUgdGhlICAgfAogXCBzb3VyY2UgY29kZSEgIC8KICAtLS0tLS0tLS0t
LS0tLS0KICAgIMKvXF8o44OEKV8vwq8KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlzdApkcmktZGV2ZWxAbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGlu
Zm8vZHJpLWRldmVsCg==
