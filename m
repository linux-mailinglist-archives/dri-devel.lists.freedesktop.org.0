Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 07B0122475F
	for <lists+dri-devel@lfdr.de>; Sat, 18 Jul 2020 02:14:13 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 088C06E356;
	Sat, 18 Jul 2020 00:14:08 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from perceval.ideasonboard.com (perceval.ideasonboard.com
 [213.167.242.64])
 by gabe.freedesktop.org (Postfix) with ESMTPS id DA3596E332
 for <dri-devel@lists.freedesktop.org>; Sat, 18 Jul 2020 00:14:05 +0000 (UTC)
Received: from pendragon.bb.dnainternet.fi (81-175-216-236.bb.dnainternet.fi
 [81.175.216.236])
 by perceval.ideasonboard.com (Postfix) with ESMTPSA id C4749B2E;
 Sat, 18 Jul 2020 02:14:02 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=ideasonboard.com;
 s=mail; t=1595031243;
 bh=oKEN8hsHOmUVKxH4HLk9wNewph0AdW3XN+Q1uIRzi3Q=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=cEPbG3DLnM6hnxcIOEqjNRWXZDWlEAJXU0cbuHor/xka54/vZFU7UHzmK5pyebHjf
 ag9AlEpaYjOApbInRk1D24xiCS6a9OqrdvIJUYVCOzSfMzwL97P9T7dLuaWZiT0mrt
 kfLDhERIaNC++rirKTe0eWFypAQP/atQO4o8G4FQ=
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH v12 2/2] drm: xlnx: DRM/KMS driver for Xilinx ZynqMP
 DisplayPort Subsystem
Date: Sat, 18 Jul 2020 03:13:47 +0300
Message-Id: <20200718001347.25451-3-laurent.pinchart@ideasonboard.com>
X-Mailer: git-send-email 2.27.0
In-Reply-To: <20200718001347.25451-1-laurent.pinchart@ideasonboard.com>
References: <20200718001347.25451-1-laurent.pinchart@ideasonboard.com>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Michal Simek <michal.simek@xilinx.com>, Hyun Kwon <hyun.kwon@xilinx.com>,
 Satish Kumar Nagireddy <SATISHNA@xilinx.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogSHl1biBLd29uIDxoeXVuLmt3b25AeGlsaW54LmNvbT4KClRoZSBYaWxpbnggWnlucU1Q
IFNvQyBoYXMgYSBoYXJkZW5lZCBkaXNwbGF5IHBpcGVsaW5lIG5hbWVkIERpc3BsYXlQb3J0ClN1
YnN5c3RlbS4gSXQgaW5jbHVkZXMgYSBidWZmZXIgbWFuYWdlciwgYSB2aWRlbyBwaXBlbGluZSBy
ZW5kZXJlcgooYmxlbmRlciksIGFuIGF1ZGlvIG1peGVyIGFuZCBhIERpc3BsYXlQb3J0IHNvdXJj
ZSBjb250cm9sbGVyCih0cmFuc21pdHRlcikuIFRoZSBETUEgZW5naW5lIHRoZSBwcm92aWRlIGRh
dGEgdG8gdGhlIGJ1ZmZlciBtYW5hZ2VyLCBhcwp3ZWxsIGFzIHRoZSBEaXNwbGF5UG9ydCBQSFlz
IHRoYXQgZHJpdmUgdGhlIGxhbmVzLCBhcmUgZXh0ZXJuYWwgdG8gdGhlCnN1YnN5c3RlbSBhbmQg
aW50ZXJmYWNlZCB1c2luZyB0aGUgRE1BIGVuZ2luZSBhbmQgUEhZIEFQSXMgcmVzcGVjdGl2ZWx5
LgoKVGhpcyBkcml2ZXIgc3VwcG9ydHMgdGhlIERpc3BsYXlQb3J0IFN1YnN5c3RlbSBhbmQgaW1w
bGVtZW50cwoKLSBUd28gcGxhbmVzLCBmb3IgZ3JhcGhpY3MgYW5kIHZpZGVvCi0gT25lIENSVEMg
dGhhdCBzdXBwb3J0cyBhbHBoYSBibGVuZGluZwotIE9uZSBlbmNvZGVyIGZvciB0aGUgRGlzcGxh
eVBvcnQgdHJhbnNtaXR0ZXIKLSBPbmUgY29ubmVjdG9yIGZvciBhbiBleHRlcm5hbCBtb25pdG9y
CgpJdCBjdXJyZW50bHkgZG9lc24ndCBzdXBwb3J0CgotIENvbG9yIGtleWluZwotIFRlc3QgcGF0
dGVybiBnZW5lcmF0aW9uCi0gQXVkaW8KLSBMaXZlIGlucHV0IGZyb20gdGhlIFByb2dyYW1tYWJs
ZSBMb2dpYyAoRlBHQSkKLSBPdXRwdXQgdG8gdGhlIFByb2dyYW1tYWJsZSBMb2dpYyAoRlBHQSkK
ClNpZ25lZC1vZmYtYnk6IEh5dW4gS3dvbiA8aHl1bi5rd29uQHhpbGlueC5jb20+ClNpZ25lZC1v
ZmYtYnk6IExhdXJlbnQgUGluY2hhcnQgPGxhdXJlbnQucGluY2hhcnRAaWRlYXNvbmJvYXJkLmNv
bT4KLS0tCiBNQUlOVEFJTkVSUyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICA5ICsK
IGRyaXZlcnMvZ3B1L2RybS9LY29uZmlnICAgICAgICAgICAgICAgICB8ICAgIDIgKwogZHJpdmVy
cy9ncHUvZHJtL01ha2VmaWxlICAgICAgICAgICAgICAgIHwgICAgMSArCiBkcml2ZXJzL2dwdS9k
cm0veGxueC9LY29uZmlnICAgICAgICAgICAgfCAgIDEzICsKIGRyaXZlcnMvZ3B1L2RybS94bG54
L01ha2VmaWxlICAgICAgICAgICB8ICAgIDIgKwogZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1w
X2Rpc3AuYyAgICAgIHwgMTY5NyArKysrKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9k
cm0veGxueC96eW5xbXBfZGlzcC5oICAgICAgfCAgIDQyICsKIGRyaXZlcnMvZ3B1L2RybS94bG54
L3p5bnFtcF9kaXNwX3JlZ3MuaCB8ICAyMDEgKysrCiBkcml2ZXJzL2dwdS9kcm0veGxueC96eW5x
bXBfZHAuYyAgICAgICAgfCAxNzM0ICsrKysrKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL2dw
dS9kcm0veGxueC96eW5xbXBfZHAuaCAgICAgICAgfCAgIDI3ICsKIGRyaXZlcnMvZ3B1L2RybS94
bG54L3p5bnFtcF9kcHN1Yi5jICAgICB8ICAzMjIgKysrKysKIGRyaXZlcnMvZ3B1L2RybS94bG54
L3p5bnFtcF9kcHN1Yi5oICAgICB8ICAgNTQgKwogMTIgZmlsZXMgY2hhbmdlZCwgNDEwNCBpbnNl
cnRpb25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL3hsbngvS2NvbmZp
ZwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS94bG54L01ha2VmaWxlCiBjcmVh
dGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rpc3AuYwogY3JlYXRl
IG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS94bG54L3p5bnFtcF9kaXNwLmgKIGNyZWF0ZSBt
b2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZGlzcF9yZWdzLmgKIGNyZWF0
ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZHAuYwogY3JlYXRlIG1v
ZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS94bG54L3p5bnFtcF9kcC5oCiBjcmVhdGUgbW9kZSAx
MDA2NDQgZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rwc3ViLmMKIGNyZWF0ZSBtb2RlIDEw
MDY0NCBkcml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZHBzdWIuaAoKZGlmZiAtLWdpdCBhL01B
SU5UQUlORVJTIGIvTUFJTlRBSU5FUlMKaW5kZXggNmMyMGE2ZDMzOGYwLi42NzA5NGVhNTI5YmEg
MTAwNjQ0Ci0tLSBhL01BSU5UQUlORVJTCisrKyBiL01BSU5UQUlORVJTCkBAIC01ODQzLDYgKzU4
NDMsMTUgQEAgVDoJZ2l0IGdpdDovL2Fub25naXQuZnJlZWRlc2t0b3Aub3JnL2RybS9kcm0tbWlz
YwogRjoJRG9jdW1lbnRhdGlvbi9ncHUveGVuLWZyb250LnJzdAogRjoJZHJpdmVycy9ncHUvZHJt
L3hlbi8KIAorRFJNIERSSVZFUlMgRk9SIFhJTElOWAorTToJSHl1biBLd29uIDxoeXVuLmt3b25A
eGlsaW54LmNvbT4KK006CUxhdXJlbnQgUGluY2hhcnQgPGxhdXJlbnQucGluY2hhcnRAaWRlYXNv
bmJvYXJkLmNvbT4KK0w6CWRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKK1M6CU1haW50
YWluZWQKK1Q6CWdpdCBnaXQ6Ly9hbm9uZ2l0LmZyZWVkZXNrdG9wLm9yZy9kcm0vZHJtLW1pc2MK
K0Y6CURvY3VtZW50YXRpb24vZGV2aWNldHJlZS9iaW5kaW5ncy9kaXNwbGF5L3hsbngvCitGOglk
cml2ZXJzL2dwdS9kcm0veGxueC8KKwogRFJNIERSSVZFUlMgRk9SIFpURSBaWAogTToJU2hhd24g
R3VvIDxzaGF3bmd1b0BrZXJuZWwub3JnPgogTDoJZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9w
Lm9yZwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL0tjb25maWcgYi9kcml2ZXJzL2dwdS9k
cm0vS2NvbmZpZwppbmRleCBjNGZkNTdkOGI3MTcuLjE0N2Q2MWI5Njc0ZSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL0tjb25maWcKKysrIGIvZHJpdmVycy9ncHUvZHJtL0tjb25maWcKQEAg
LTM4Niw2ICszODYsOCBAQCBzb3VyY2UgImRyaXZlcnMvZ3B1L2RybS9tY2RlL0tjb25maWciCiAK
IHNvdXJjZSAiZHJpdmVycy9ncHUvZHJtL3RpZHNzL0tjb25maWciCiAKK3NvdXJjZSAiZHJpdmVy
cy9ncHUvZHJtL3hsbngvS2NvbmZpZyIKKwogIyBLZWVwIGxlZ2FjeSBkcml2ZXJzIGxhc3QKIAog
bWVudWNvbmZpZyBEUk1fTEVHQUNZCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vTWFrZWZp
bGUgYi9kcml2ZXJzL2dwdS9kcm0vTWFrZWZpbGUKaW5kZXggMmMwZTVhN2U1OTUzLi4xNDY1Yjc0
NmYxZjMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9NYWtlZmlsZQorKysgYi9kcml2ZXJz
L2dwdS9kcm0vTWFrZWZpbGUKQEAgLTEyMywzICsxMjMsNCBAQCBvYmotJChDT05GSUdfRFJNX1BB
TkZST1NUKSArPSBwYW5mcm9zdC8KIG9iai0kKENPTkZJR19EUk1fQVNQRUVEX0dGWCkgKz0gYXNw
ZWVkLwogb2JqLSQoQ09ORklHX0RSTV9NQ0RFKSArPSBtY2RlLwogb2JqLSQoQ09ORklHX0RSTV9U
SURTUykgKz0gdGlkc3MvCitvYmoteQkJCSs9IHhsbngvCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0veGxueC9LY29uZmlnIGIvZHJpdmVycy9ncHUvZHJtL3hsbngvS2NvbmZpZwpuZXcgZmls
ZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmFhNmNkODg5YmQxMQotLS0gL2Rldi9u
dWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS94bG54L0tjb25maWcKQEAgLTAsMCArMSwxMyBAQAor
Y29uZmlnIERSTV9aWU5RTVBfRFBTVUIKKwl0cmlzdGF0ZSAiWnlucU1QIERpc3BsYXlQb3J0IENv
bnRyb2xsZXIgRHJpdmVyIgorCWRlcGVuZHMgb24gQVJDSF9aWU5RTVAgfHwgQ09NUElMRV9URVNU
CisJZGVwZW5kcyBvbiBDT01NT05fQ0xLICYmIERSTSAmJiBPRgorCXNlbGVjdCBETUFfRU5HSU5F
CisJc2VsZWN0IERSTV9HRU1fQ01BX0hFTFBFUgorCXNlbGVjdCBEUk1fS01TX0NNQV9IRUxQRVIK
KwlzZWxlY3QgRFJNX0tNU19IRUxQRVIKKwlzZWxlY3QgR0VORVJJQ19QSFkKKwloZWxwCisJICBU
aGlzIGlzIGEgRFJNL0tNUyBkcml2ZXIgZm9yIFp5bnFNUCBEaXNwbGF5UG9ydCBjb250cm9sbGVy
LiBDaG9vc2UKKwkgIHRoaXMgb3B0aW9uIGlmIHlvdSBoYXZlIGEgWGlsaW54IFp5bnFNUCBTb0Mg
d2l0aCBEaXNwbGF5UG9ydAorCSAgc3Vic3lzdGVtLgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL3hsbngvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0veGxueC9NYWtlZmlsZQpuZXcgZmls
ZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjUxYzI0YjcyMjE3YgotLS0gL2Rldi9u
dWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS94bG54L01ha2VmaWxlCkBAIC0wLDAgKzEsMiBAQAor
enlucW1wLWRwc3ViLXkgOj0genlucW1wX2Rpc3AubyB6eW5xbXBfZHBzdWIubyB6eW5xbXBfZHAu
bworb2JqLSQoQ09ORklHX0RSTV9aWU5RTVBfRFBTVUIpICs9IHp5bnFtcC1kcHN1Yi5vCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZGlzcC5jIGIvZHJpdmVycy9ncHUv
ZHJtL3hsbngvenlucW1wX2Rpc3AuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAw
MDAwMDAuLmE0NTVjZmMxYmVlNQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS94
bG54L3p5bnFtcF9kaXNwLmMKQEAgLTAsMCArMSwxNjk3IEBACisvLyBTUERYLUxpY2Vuc2UtSWRl
bnRpZmllcjogR1BMLTIuMAorLyoKKyAqIFp5bnFNUCBEaXNwbGF5IENvbnRyb2xsZXIgRHJpdmVy
CisgKgorICogQ29weXJpZ2h0IChDKSAyMDE3IC0gMjAyMCBYaWxpbngsIEluYy4KKyAqCisgKiBB
dXRob3JzOgorICogLSBIeXVuIFdvbyBLd29uIDxoeXVuLmt3b25AeGlsaW54LmNvbT4KKyAqIC0g
TGF1cmVudCBQaW5jaGFydCA8bGF1cmVudC5waW5jaGFydEBpZGVhc29uYm9hcmQuY29tPgorICov
CisKKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pYy5oPgorI2luY2x1ZGUgPGRybS9kcm1fYXRvbWlj
X2hlbHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljX3VhcGkuaD4KKyNpbmNsdWRlIDxk
cm0vZHJtX2NydGMuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2RldmljZS5oPgorI2luY2x1ZGUgPGRy
bS9kcm1fZmJfY21hX2hlbHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fZm91cmNjLmg+CisjaW5j
bHVkZSA8ZHJtL2RybV9mcmFtZWJ1ZmZlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fbWFuYWdlZC5o
PgorI2luY2x1ZGUgPGRybS9kcm1fcGxhbmUuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3BsYW5lX2hl
bHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fdmJsYW5rLmg+CisKKyNpbmNsdWRlIDxsaW51eC9j
bGsuaD4KKyNpbmNsdWRlIDxsaW51eC9kZWxheS5oPgorI2luY2x1ZGUgPGxpbnV4L2RtYS1tYXBw
aW5nLmg+CisjaW5jbHVkZSA8bGludXgvZG1hZW5naW5lLmg+CisjaW5jbHVkZSA8bGludXgvbW9k
dWxlLmg+CisjaW5jbHVkZSA8bGludXgvb2YuaD4KKyNpbmNsdWRlIDxsaW51eC9vZl9kbWEuaD4K
KyNpbmNsdWRlIDxsaW51eC9wbGF0Zm9ybV9kZXZpY2UuaD4KKyNpbmNsdWRlIDxsaW51eC9wbV9y
dW50aW1lLmg+CisjaW5jbHVkZSA8bGludXgvc3BpbmxvY2suaD4KKworI2luY2x1ZGUgInp5bnFt
cF9kaXNwLmgiCisjaW5jbHVkZSAienlucW1wX2Rpc3BfcmVncy5oIgorI2luY2x1ZGUgInp5bnFt
cF9kcC5oIgorI2luY2x1ZGUgInp5bnFtcF9kcHN1Yi5oIgorCisvKgorICogT3ZlcnZpZXcKKyAq
IC0tLS0tLS0tCisgKgorICogVGhlIGRpc3BsYXkgY29udHJvbGxlciBwYXJ0IG9mIFp5bnFNUCBE
UCBzdWJzeXN0ZW0sIG1hZGUgb2YgdGhlIEF1ZGlvL1ZpZGVvCisgKiBCdWZmZXIgTWFuYWdlciwg
dGhlIFZpZGVvIFJlbmRlcmluZyBQaXBlbGluZSAoYmxlbmRlcikgYW5kIHRoZSBBdWRpbyBNaXhl
ci4KKyAqCisgKiAgICAgICAgICAgICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsKKyAqICstLS0tLS0tLSsgICB8ICstLS0tLS0t
LS0tLS0tLS0tKyAgICAgKy0tLS0tLS0tLS0tKyAgICAgICAgICAgICAgICAgICAgICAgfAorICog
fCBEUERNQSAgfCAtLS0+fCAgICAgICAgICAgICAgICB8IC0tPiB8ICAgVmlkZW8gICB8IFZpZGVv
ICstLS0tLS0tLS0tLS0tKyB8CisgKiB8IDR4IHZpZCB8ICAgfCB8ICAgICAgICAgICAgICAgIHwg
ICAgIHwgUmVuZGVyaW5nIHwgLSstLT4gfCAgICAgICAgICAgICB8IHwgICArLS0tLS0tKworICog
fCAyeCBhdWQgfCAgIHwgfCAgQXVkaW8vVmlkZW8gICB8IC0tPiB8IFBpcGVsaW5lICB8ICB8ICAg
IHwgRGlzcGxheVBvcnQgfC0tLT4gfCBQSFkwIHwKKyAqICstLS0tLS0tLSsgICB8IHwgQnVmZmVy
IE1hbmFnZXIgfCAgICAgKy0tLS0tLS0tLS0tKyAgfCAgICB8ICAgU291cmNlICAgIHwgfCAgICst
LS0tLS0rCisgKiAgICAgICAgICAgICAgfCB8ICAgIGFuZCBTVEMgICAgIHwgICAgICstLS0tLS0t
LS0tLSsgIHwgICAgfCBDb250cm9sbGVyICB8IHwgICArLS0tLS0tKworICogTGl2ZSBWaWRlbyAt
LS0+fCAgICAgICAgICAgICAgICB8IC0tPiB8ICAgQXVkaW8gICB8IEF1ZGlvIHwgICAgICAgICAg
ICAgfC0tLT4gfCBQSFkxIHwKKyAqICAgICAgICAgICAgICB8IHwgICAgICAgICAgICAgICAgfCAg
ICAgfCAgIE1peGVyICAgfCAtLSstPiB8ICAgICAgICAgICAgIHwgfCAgICstLS0tLS0rCisgKiBM
aXZlIEF1ZGlvIC0tLT58ICAgICAgICAgICAgICAgIHwgLS0+IHwgICAgICAgICAgIHwgIHx8ICAg
Ky0tLS0tLS0tLS0tLS0rIHwKKyAqICAgICAgICAgICAgICB8ICstLS0tLS0tLS0tLS0tLS0tKyAg
ICAgKy0tLS0tLS0tLS0tKyAgfHwgICAgICAgICAgICAgICAgICAgfAorICogICAgICAgICAgICAg
ICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fC0tLS0tLS0tLS0tLS0t
LS0tLS0rCisgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHZ2CisgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIEJsZW5kZWQgVmlkZW8gYW5kCisgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIE1peGVkIEF1ZGlvIHRvIFBMCisgKgorICogT25seSBub24tbGl2ZSBp
bnB1dCBmcm9tIHRoZSBEUERNQSBhbmQgb3V0cHV0IHRvIHRoZSBEaXNwbGF5UG9ydCBTb3VyY2UK
KyAqIENvbnRyb2xsZXIgYXJlIGN1cnJlbnRseSBzdXBwb3J0ZWQuIEludGVyZmFjZSB3aXRoIHRo
ZSBwcm9ncmFtbWFibGUgbG9naWMKKyAqIGZvciBsaXZlIHN0cmVhbXMgaXMgbm90IGltcGxlbWVu
dGVkLgorICoKKyAqIFRoZSBkaXNwbGF5IGNvbnRyb2xsZXIgY29kZSBjcmVhdGVzIHBsYW5lcyBm
b3IgdGhlIERQRE1BIHZpZGVvIGFuZCBncmFwaGljcworICogbGF5ZXJzLCBhbmQgYSBDUlRDIGZv
ciB0aGUgVmlkZW8gUmVuZGVyaW5nIFBpcGVsaW5lLgorICovCisKKyNkZWZpbmUgWllOUU1QX0RJ
U1BfQVZfQlVGX05VTV9WSURfR0ZYX0JVRkZFUlMJCTQKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZf
QlVGX05VTV9CVUZGRVJTCQkJNgorCisjZGVmaW5lIFpZTlFNUF9ESVNQX05VTV9MQVlFUlMJCQkJ
MgorI2RlZmluZSBaWU5RTVBfRElTUF9NQVhfTlVNX1NVQl9QTEFORVMJCQkzCisKKy8qKgorICog
c3RydWN0IHp5bnFtcF9kaXNwX2Zvcm1hdCAtIERpc3BsYXkgc3Vic3lzdGVtIGZvcm1hdCBpbmZv
cm1hdGlvbgorICogQGRybV9mbXQ6IERSTSBmb3JtYXQgKDRDQykKKyAqIEBidWZfZm10OiBBViBi
dWZmZXIgZm9ybWF0CisgKiBAYnVzX2ZtdDogTWVkaWEgYnVzIGZvcm1hdHMgKGxpdmUgZm9ybWF0
cykKKyAqIEBzd2FwOiBGbGFnIHRvIHN3YXAgUiAmIEIgZm9yIFJHQiBmb3JtYXRzLCBhbmQgVSAm
IFYgZm9yIFlVViBmb3JtYXRzCisgKiBAc2Y6IFNjYWxpbmcgZmFjdG9ycyBmb3IgY29sb3IgY29t
cG9uZW50cworICovCitzdHJ1Y3QgenlucW1wX2Rpc3BfZm9ybWF0IHsKKwl1MzIgZHJtX2ZtdDsK
Kwl1MzIgYnVmX2ZtdDsKKwl1MzIgYnVzX2ZtdDsKKwlib29sIHN3YXA7CisJY29uc3QgdTMyICpz
ZjsKK307CisKKy8qKgorICogZW51bSB6eW5xbXBfZGlzcF9pZCAtIExheWVyIGlkZW50aWZpZXIK
KyAqIEBaWU5RTVBfRElTUF9MQVlFUl9WSUQ6IFZpZGVvIGxheWVyCisgKiBAWllOUU1QX0RJU1Bf
TEFZRVJfR0ZYOiBHcmFwaGljcyBsYXllcgorICovCitlbnVtIHp5bnFtcF9kaXNwX2xheWVyX2lk
IHsKKwlaWU5RTVBfRElTUF9MQVlFUl9WSUQsCisJWllOUU1QX0RJU1BfTEFZRVJfR0ZYCit9Owor
CisvKioKKyAqIGVudW0genlucW1wX2Rpc3BfbGF5ZXJfbW9kZSAtIExheWVyIG1vZGUKKyAqIEBa
WU5RTVBfRElTUF9MQVlFUl9OT05MSVZFOiBub24tbGl2ZSAobWVtb3J5KSBtb2RlCisgKiBAWllO
UU1QX0RJU1BfTEFZRVJfTElWRTogbGl2ZSAoc3RyZWFtKSBtb2RlCisgKi8KK2VudW0genlucW1w
X2Rpc3BfbGF5ZXJfbW9kZSB7CisJWllOUU1QX0RJU1BfTEFZRVJfTk9OTElWRSwKKwlaWU5RTVBf
RElTUF9MQVlFUl9MSVZFCit9OworCisvKioKKyAqIHN0cnVjdCB6eW5xbXBfZGlzcF9sYXllcl9k
bWEgLSBETUEgY2hhbm5lbCBmb3Igb25lIGRhdGEgcGxhbmUgb2YgYSBsYXllcgorICogQGNoYW46
IERNQSBjaGFubmVsCisgKiBAeHQ6IEludGVybGVhdmVkIERNQSBkZXNjcmlwdG9yIHRlbXBsYXRl
CisgKiBAc2dsOiBEYXRhIGNodW5rIGZvciBkbWFfaW50ZXJsZWF2ZWRfdGVtcGxhdGUKKyAqLwor
c3RydWN0IHp5bnFtcF9kaXNwX2xheWVyX2RtYSB7CisJc3RydWN0IGRtYV9jaGFuICpjaGFuOwor
CXN0cnVjdCBkbWFfaW50ZXJsZWF2ZWRfdGVtcGxhdGUgeHQ7CisJc3RydWN0IGRhdGFfY2h1bmsg
c2dsOworfTsKKworLyoqCisgKiBzdHJ1Y3QgenlucW1wX2Rpc3BfbGF5ZXJfaW5mbyAtIFN0YXRp
YyBsYXllciBpbmZvcm1hdGlvbgorICogQGZvcm1hdHM6IEFycmF5IG9mIHN1cHBvcnRlZCBmb3Jt
YXRzCisgKiBAbnVtX2Zvcm1hdHM6IE51bWJlciBvZiBmb3JtYXRzIGluIEBmb3JtYXRzIGFycmF5
CisgKiBAbnVtX2NoYW5uZWxzOiBOdW1iZXIgb2YgRE1BIGNoYW5uZWxzCisgKi8KK3N0cnVjdCB6
eW5xbXBfZGlzcF9sYXllcl9pbmZvIHsKKwljb25zdCBzdHJ1Y3QgenlucW1wX2Rpc3BfZm9ybWF0
ICpmb3JtYXRzOworCXVuc2lnbmVkIGludCBudW1fZm9ybWF0czsKKwl1bnNpZ25lZCBpbnQgbnVt
X2NoYW5uZWxzOworfTsKKworLyoqCisgKiBzdHJ1Y3QgenlucW1wX2Rpc3BfbGF5ZXIgLSBEaXNw
bGF5IGxheWVyIChEUk0gcGxhbmUpCisgKiBAcGxhbmU6IERSTSBwbGFuZQorICogQGlkOiBMYXll
ciBJRAorICogQGRpc3A6IEJhY2sgcG9pbnRlciB0byBzdHJ1Y3QgenlucW1wX2Rpc3AKKyAqIEBp
bmZvOiBTdGF0aWMgbGF5ZXIgaW5mb3JtYXRpb24KKyAqIEBkbWFzOiBETUEgY2hhbm5lbHMKKyAq
IEBkaXNwX2ZtdDogQ3VycmVudCBmb3JtYXQgaW5mb3JtYXRpb24KKyAqIEBkcm1fZm10OiBDdXJy
ZW50IERSTSBmb3JtYXQgaW5mb3JtYXRpb24KKyAqIEBtb2RlOiBDdXJyZW50IG9wZXJhdGlvbiBt
b2RlCisgKi8KK3N0cnVjdCB6eW5xbXBfZGlzcF9sYXllciB7CisJc3RydWN0IGRybV9wbGFuZSBw
bGFuZTsKKwllbnVtIHp5bnFtcF9kaXNwX2xheWVyX2lkIGlkOworCXN0cnVjdCB6eW5xbXBfZGlz
cCAqZGlzcDsKKwljb25zdCBzdHJ1Y3QgenlucW1wX2Rpc3BfbGF5ZXJfaW5mbyAqaW5mbzsKKwor
CXN0cnVjdCB6eW5xbXBfZGlzcF9sYXllcl9kbWEgZG1hc1taWU5RTVBfRElTUF9NQVhfTlVNX1NV
Ql9QTEFORVNdOworCisJY29uc3Qgc3RydWN0IHp5bnFtcF9kaXNwX2Zvcm1hdCAqZGlzcF9mbXQ7
CisJY29uc3Qgc3RydWN0IGRybV9mb3JtYXRfaW5mbyAqZHJtX2ZtdDsKKwllbnVtIHp5bnFtcF9k
aXNwX2xheWVyX21vZGUgbW9kZTsKK307CisKKy8qKgorICogc3RydWN0IHp5bnFtcF9kaXNwX2Js
ZW5kIC0gQmxlbmRlcgorICogQGJhc2U6IFJlZ2lzdGVycyBJL08gYmFzZSBhZGRyZXNzCisgKi8K
K3N0cnVjdCB6eW5xbXBfZGlzcF9ibGVuZCB7CisJdm9pZCBfX2lvbWVtICpiYXNlOworfTsKKwor
LyoqCisgKiBzdHJ1Y3QgenlucW1wX2Rpc3BfYXZidWYgLSBBdWRpby92aWRlbyBidWZmZXIgbWFu
YWdlcgorICogQGJhc2U6IFJlZ2lzdGVycyBJL08gYmFzZSBhZGRyZXNzCisgKi8KK3N0cnVjdCB6
eW5xbXBfZGlzcF9hdmJ1ZiB7CisJdm9pZCBfX2lvbWVtICpiYXNlOworfTsKKworLyoqCisgKiBz
dHJ1Y3QgenlucW1wX2Rpc3BfYXVkaW8gLSBBdWRpbyBtaXhlcgorICogQGJhc2U6IFJlZ2lzdGVy
cyBJL08gYmFzZSBhZGRyZXNzCisgKiBAY2xrOiBBdWRpbyBjbG9jaworICogQGNsa19mcm9tX3Bz
OiBUcnVlIG9mIHRoZSBhdWRpbyBjbG9jayBjb21lcyBmcm9tIFBTLCBmYWxzZSBmcm9tIFBMCisg
Ki8KK3N0cnVjdCB6eW5xbXBfZGlzcF9hdWRpbyB7CisJdm9pZCBfX2lvbWVtICpiYXNlOworCXN0
cnVjdCBjbGsgKmNsazsKKwlib29sIGNsa19mcm9tX3BzOworfTsKKworLyoqCisgKiBzdHJ1Y3Qg
enlucW1wX2Rpc3AgLSBEaXNwbGF5IGNvbnRyb2xsZXIKKyAqIEBkZXY6IERldmljZSBzdHJ1Y3R1
cmUKKyAqIEBkcm06IERSTSBjb3JlCisgKiBAZHBzdWI6IERpc3BsYXkgc3Vic3lzdGVtCisgKiBA
Y3J0YzogRFJNIENSVEMKKyAqIEBibGVuZDogQmxlbmRlciAodmlkZW8gcmVuZGVyaW5nIHBpcGVs
aW5lKQorICogQGF2YnVmOiBBdWRpby92aWRlbyBidWZmZXIgbWFuYWdlcgorICogQGF1ZGlvOiBB
dWRpbyBtaXhlcgorICogQGxheWVyczogTGF5ZXJzIChwbGFuZXMpCisgKiBAZXZlbnQ6IFBlbmRp
bmcgdmJsYW5rIGV2ZW50IHJlcXVlc3QKKyAqIEBwY2xrOiBQaXhlbCBjbG9jaworICogQHBjbGtf
ZnJvbV9wczogVHJ1ZSBvZiB0aGUgdmlkZW8gY2xvY2sgY29tZXMgZnJvbSBQUywgZmFsc2UgZnJv
bSBQTAorICovCitzdHJ1Y3QgenlucW1wX2Rpc3AgeworCXN0cnVjdCBkZXZpY2UgKmRldjsKKwlz
dHJ1Y3QgZHJtX2RldmljZSAqZHJtOworCXN0cnVjdCB6eW5xbXBfZHBzdWIgKmRwc3ViOworCisJ
c3RydWN0IGRybV9jcnRjIGNydGM7CisKKwlzdHJ1Y3QgenlucW1wX2Rpc3BfYmxlbmQgYmxlbmQ7
CisJc3RydWN0IHp5bnFtcF9kaXNwX2F2YnVmIGF2YnVmOworCXN0cnVjdCB6eW5xbXBfZGlzcF9h
dWRpbyBhdWRpbzsKKworCXN0cnVjdCB6eW5xbXBfZGlzcF9sYXllciBsYXllcnNbWllOUU1QX0RJ
U1BfTlVNX0xBWUVSU107CisKKwlzdHJ1Y3QgZHJtX3BlbmRpbmdfdmJsYW5rX2V2ZW50ICpldmVu
dDsKKworCXN0cnVjdCBjbGsgKnBjbGs7CisJYm9vbCBwY2xrX2Zyb21fcHM7Cit9OworCisvKiAt
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLQorICogQXVkaW8vVmlkZW8gQnVmZmVyIE1hbmFnZXIKKyAqLwor
CitzdGF0aWMgY29uc3QgdTMyIHNjYWxpbmdfZmFjdG9yc180NDRbXSA9IHsKKwlaWU5RTVBfRElT
UF9BVl9CVUZfNEJJVF9TRiwKKwlaWU5RTVBfRElTUF9BVl9CVUZfNEJJVF9TRiwKKwlaWU5RTVBf
RElTUF9BVl9CVUZfNEJJVF9TRiwKK307CisKK3N0YXRpYyBjb25zdCB1MzIgc2NhbGluZ19mYWN0
b3JzXzU1NVtdID0geworCVpZTlFNUF9ESVNQX0FWX0JVRl81QklUX1NGLAorCVpZTlFNUF9ESVNQ
X0FWX0JVRl81QklUX1NGLAorCVpZTlFNUF9ESVNQX0FWX0JVRl81QklUX1NGLAorfTsKKworc3Rh
dGljIGNvbnN0IHUzMiBzY2FsaW5nX2ZhY3RvcnNfNTY1W10gPSB7CisJWllOUU1QX0RJU1BfQVZf
QlVGXzVCSVRfU0YsCisJWllOUU1QX0RJU1BfQVZfQlVGXzZCSVRfU0YsCisJWllOUU1QX0RJU1Bf
QVZfQlVGXzVCSVRfU0YsCit9OworCitzdGF0aWMgY29uc3QgdTMyIHNjYWxpbmdfZmFjdG9yc182
NjZbXSA9IHsKKwlaWU5RTVBfRElTUF9BVl9CVUZfNkJJVF9TRiwKKwlaWU5RTVBfRElTUF9BVl9C
VUZfNkJJVF9TRiwKKwlaWU5RTVBfRElTUF9BVl9CVUZfNkJJVF9TRiwKK307CisKK3N0YXRpYyBj
b25zdCB1MzIgc2NhbGluZ19mYWN0b3JzXzg4OFtdID0geworCVpZTlFNUF9ESVNQX0FWX0JVRl84
QklUX1NGLAorCVpZTlFNUF9ESVNQX0FWX0JVRl84QklUX1NGLAorCVpZTlFNUF9ESVNQX0FWX0JV
Rl84QklUX1NGLAorfTsKKworc3RhdGljIGNvbnN0IHUzMiBzY2FsaW5nX2ZhY3RvcnNfMTAxMDEw
W10gPSB7CisJWllOUU1QX0RJU1BfQVZfQlVGXzEwQklUX1NGLAorCVpZTlFNUF9ESVNQX0FWX0JV
Rl8xMEJJVF9TRiwKKwlaWU5RTVBfRElTUF9BVl9CVUZfMTBCSVRfU0YsCit9OworCisvKiBMaXN0
IG9mIHZpZGVvIGxheWVyIGZvcm1hdHMgKi8KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgenlucW1wX2Rp
c3BfZm9ybWF0IGF2YnVmX3ZpZF9mbXRzW10gPSB7CisJeworCQkuZHJtX2ZtdAk9IERSTV9GT1JN
QVRfVllVWSwKKwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9WWVVZ
LAorCQkuc3dhcAkJPSB0cnVlLAorCQkuc2YJCT0gc2NhbGluZ19mYWN0b3JzXzg4OCwKKwl9LCB7
CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9VWVZZLAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQ
X0FWX0JVRl9GTVRfTkxfVklEX1ZZVVksCisJCS5zd2FwCQk9IGZhbHNlLAorCQkuc2YJCT0gc2Nh
bGluZ19mYWN0b3JzXzg4OCwKKwl9LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9ZVVlWLAor
CQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1lVWVYsCisJCS5zd2Fw
CQk9IGZhbHNlLAorCQkuc2YJCT0gc2NhbGluZ19mYWN0b3JzXzg4OCwKKwl9LCB7CisJCS5kcm1f
Zm10CT0gRFJNX0ZPUk1BVF9ZVllVLAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9G
TVRfTkxfVklEX1lVWVYsCisJCS5zd2FwCQk9IHRydWUsCisJCS5zZgkJPSBzY2FsaW5nX2ZhY3Rv
cnNfODg4LAorCX0sIHsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFUX1lVVjQyMiwKKwkJLmJ1Zl9m
bXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9ZVjE2LAorCQkuc3dhcAkJPSBmYWxz
ZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc184ODgsCisJfSwgeworCQkuZHJtX2ZtdAk9IERS
TV9GT1JNQVRfWVZVNDIyLAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxf
VklEX1lWMTYsCisJCS5zd2FwCQk9IHRydWUsCisJCS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNfODg4
LAorCX0sIHsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFUX1lVVjQ0NCwKKwkJLmJ1Zl9mbXQJPSBa
WU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9ZVjI0LAorCQkuc3dhcAkJPSBmYWxzZSwKKwkJ
LnNmCQk9IHNjYWxpbmdfZmFjdG9yc184ODgsCisJfSwgeworCQkuZHJtX2ZtdAk9IERSTV9GT1JN
QVRfWVZVNDQ0LAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1lW
MjQsCisJCS5zd2FwCQk9IHRydWUsCisJCS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNfODg4LAorCX0s
IHsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFUX05WMTYsCisJCS5idWZfZm10CT0gWllOUU1QX0RJ
U1BfQVZfQlVGX0ZNVF9OTF9WSURfWVYxNkNJLAorCQkuc3dhcAkJPSBmYWxzZSwKKwkJLnNmCQk9
IHNjYWxpbmdfZmFjdG9yc184ODgsCisJfSwgeworCQkuZHJtX2ZtdAk9IERSTV9GT1JNQVRfTlY2
MSwKKwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9ZVjE2Q0ksCisJ
CS5zd2FwCQk9IHRydWUsCisJCS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNfODg4LAorCX0sIHsKKwkJ
LmRybV9mbXQJPSBEUk1fRk9STUFUX0JHUjg4OCwKKwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9B
Vl9CVUZfRk1UX05MX1ZJRF9SR0I4ODgsCisJCS5zd2FwCQk9IGZhbHNlLAorCQkuc2YJCT0gc2Nh
bGluZ19mYWN0b3JzXzg4OCwKKwl9LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9SR0I4ODgs
CisJCS5idWZfZm10CT0gWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfUkdCODg4LAorCQku
c3dhcAkJPSB0cnVlLAorCQkuc2YJCT0gc2NhbGluZ19mYWN0b3JzXzg4OCwKKwl9LCB7CisJCS5k
cm1fZm10CT0gRFJNX0ZPUk1BVF9YQkdSODg4OCwKKwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9B
Vl9CVUZfRk1UX05MX1ZJRF9SR0JBODg4MCwKKwkJLnN3YXAJCT0gZmFsc2UsCisJCS5zZgkJPSBz
Y2FsaW5nX2ZhY3RvcnNfODg4LAorCX0sIHsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFUX1hSR0I4
ODg4LAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1JHQkE4ODgw
LAorCQkuc3dhcAkJPSB0cnVlLAorCQkuc2YJCT0gc2NhbGluZ19mYWN0b3JzXzg4OCwKKwl9LCB7
CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9YQkdSMjEwMTAxMCwKKwkJLmJ1Zl9mbXQJPSBaWU5R
TVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9SR0I4ODhfMTAsCisJCS5zd2FwCQk9IGZhbHNlLAor
CQkuc2YJCT0gc2NhbGluZ19mYWN0b3JzXzEwMTAxMCwKKwl9LCB7CisJCS5kcm1fZm10CT0gRFJN
X0ZPUk1BVF9YUkdCMjEwMTAxMCwKKwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1U
X05MX1ZJRF9SR0I4ODhfMTAsCisJCS5zd2FwCQk9IHRydWUsCisJCS5zZgkJPSBzY2FsaW5nX2Zh
Y3RvcnNfMTAxMDEwLAorCX0sIHsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFUX1lVVjQyMCwKKwkJ
LmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9ZVjE2XzQyMCwKKwkJLnN3
YXAJCT0gZmFsc2UsCisJCS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNfODg4LAorCX0sIHsKKwkJLmRy
bV9mbXQJPSBEUk1fRk9STUFUX1lWVTQyMCwKKwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9C
VUZfRk1UX05MX1ZJRF9ZVjE2XzQyMCwKKwkJLnN3YXAJCT0gdHJ1ZSwKKwkJLnNmCQk9IHNjYWxp
bmdfZmFjdG9yc184ODgsCisJfSwgeworCQkuZHJtX2ZtdAk9IERSTV9GT1JNQVRfTlYxMiwKKwkJ
LmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9ZVjE2Q0lfNDIwLAorCQku
c3dhcAkJPSBmYWxzZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc184ODgsCisJfSwgeworCQku
ZHJtX2ZtdAk9IERSTV9GT1JNQVRfTlYyMSwKKwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9C
VUZfRk1UX05MX1ZJRF9ZVjE2Q0lfNDIwLAorCQkuc3dhcAkJPSB0cnVlLAorCQkuc2YJCT0gc2Nh
bGluZ19mYWN0b3JzXzg4OCwKKwl9LAorfTsKKworLyogTGlzdCBvZiBncmFwaGljcyBsYXllciBm
b3JtYXRzICovCitzdGF0aWMgY29uc3Qgc3RydWN0IHp5bnFtcF9kaXNwX2Zvcm1hdCBhdmJ1Zl9n
ZnhfZm10c1tdID0geworCXsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFUX0FCR1I4ODg4LAorCQku
YnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfR0ZYX1JHQkE4ODg4LAorCQkuc3dh
cAkJPSBmYWxzZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc184ODgsCisJfSwgeworCQkuZHJt
X2ZtdAk9IERSTV9GT1JNQVRfQVJHQjg4ODgsCisJCS5idWZfZm10CT0gWllOUU1QX0RJU1BfQVZf
QlVGX0ZNVF9OTF9HRlhfUkdCQTg4ODgsCisJCS5zd2FwCQk9IHRydWUsCisJCS5zZgkJPSBzY2Fs
aW5nX2ZhY3RvcnNfODg4LAorCX0sIHsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFUX1JHQkE4ODg4
LAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfR0ZYX0FCR1I4ODg4LAor
CQkuc3dhcAkJPSBmYWxzZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc184ODgsCisJfSwgewor
CQkuZHJtX2ZtdAk9IERSTV9GT1JNQVRfQkdSQTg4ODgsCisJCS5idWZfZm10CT0gWllOUU1QX0RJ
U1BfQVZfQlVGX0ZNVF9OTF9HRlhfQUJHUjg4ODgsCisJCS5zd2FwCQk9IHRydWUsCisJCS5zZgkJ
PSBzY2FsaW5nX2ZhY3RvcnNfODg4LAorCX0sIHsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFUX0JH
Ujg4OCwKKwkJLmJ1Zl9mbXQJPSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX0dGWF9SR0I4ODgs
CisJCS5zd2FwCQk9IGZhbHNlLAorCQkuc2YJCT0gc2NhbGluZ19mYWN0b3JzXzg4OCwKKwl9LCB7
CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9SR0I4ODgsCisJCS5idWZfZm10CT0gWllOUU1QX0RJ
U1BfQVZfQlVGX0ZNVF9OTF9HRlhfQkdSODg4LAorCQkuc3dhcAkJPSBmYWxzZSwKKwkJLnNmCQk9
IHNjYWxpbmdfZmFjdG9yc184ODgsCisJfSwgeworCQkuZHJtX2ZtdAk9IERSTV9GT1JNQVRfUkdC
QTU1NTEsCisJCS5idWZfZm10CT0gWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9HRlhfUkdCQTU1
NTEsCisJCS5zd2FwCQk9IGZhbHNlLAorCQkuc2YJCT0gc2NhbGluZ19mYWN0b3JzXzU1NSwKKwl9
LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9CR1JBNTU1MSwKKwkJLmJ1Zl9mbXQJPSBaWU5R
TVBfRElTUF9BVl9CVUZfRk1UX05MX0dGWF9SR0JBNTU1MSwKKwkJLnN3YXAJCT0gdHJ1ZSwKKwkJ
LnNmCQk9IHNjYWxpbmdfZmFjdG9yc181NTUsCisJfSwgeworCQkuZHJtX2ZtdAk9IERSTV9GT1JN
QVRfUkdCQTQ0NDQsCisJCS5idWZfZm10CT0gWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9HRlhf
UkdCQTQ0NDQsCisJCS5zd2FwCQk9IGZhbHNlLAorCQkuc2YJCT0gc2NhbGluZ19mYWN0b3JzXzQ0
NCwKKwl9LCB7CisJCS5kcm1fZm10CT0gRFJNX0ZPUk1BVF9CR1JBNDQ0NCwKKwkJLmJ1Zl9mbXQJ
PSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX0dGWF9SR0JBNDQ0NCwKKwkJLnN3YXAJCT0gdHJ1
ZSwKKwkJLnNmCQk9IHNjYWxpbmdfZmFjdG9yc180NDQsCisJfSwgeworCQkuZHJtX2ZtdAk9IERS
TV9GT1JNQVRfUkdCNTY1LAorCQkuYnVmX2ZtdAk9IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxf
R0ZYX1JHQjU2NSwKKwkJLnN3YXAJCT0gZmFsc2UsCisJCS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNf
NTY1LAorCX0sIHsKKwkJLmRybV9mbXQJPSBEUk1fRk9STUFUX0JHUjU2NSwKKwkJLmJ1Zl9mbXQJ
PSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX0dGWF9SR0I1NjUsCisJCS5zd2FwCQk9IHRydWUs
CisJCS5zZgkJPSBzY2FsaW5nX2ZhY3RvcnNfNTY1LAorCX0sCit9OworCitzdGF0aWMgdTMyIHp5
bnFtcF9kaXNwX2F2YnVmX3JlYWQoc3RydWN0IHp5bnFtcF9kaXNwX2F2YnVmICphdmJ1ZiwgaW50
IHJlZykKK3sKKwlyZXR1cm4gcmVhZGwoYXZidWYtPmJhc2UgKyByZWcpOworfQorCitzdGF0aWMg
dm9pZCB6eW5xbXBfZGlzcF9hdmJ1Zl93cml0ZShzdHJ1Y3QgenlucW1wX2Rpc3BfYXZidWYgKmF2
YnVmLAorCQkJCSAgICBpbnQgcmVnLCB1MzIgdmFsKQoreworCXdyaXRlbCh2YWwsIGF2YnVmLT5i
YXNlICsgcmVnKTsKK30KKworLyoqCisgKiB6eW5xbXBfZGlzcF9hdmJ1Zl9zZXRfZm9ybWF0IC0g
U2V0IHRoZSBpbnB1dCBmb3JtYXQgZm9yIGEgbGF5ZXIKKyAqIEBhdmJ1ZjogQXVkaW8vdmlkZW8g
YnVmZmVyIG1hbmFnZXIKKyAqIEBsYXllcjogVGhlIGxheWVyIElECisgKiBAZm10OiBUaGUgZm9y
bWF0IGluZm9ybWF0aW9uCisgKgorICogU2V0IHRoZSB2aWRlbyBidWZmZXIgbWFuYWdlciBmb3Jt
YXQgZm9yIEBsYXllciB0byBAZm10LgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9hdmJ1
Zl9zZXRfZm9ybWF0KHN0cnVjdCB6eW5xbXBfZGlzcF9hdmJ1ZiAqYXZidWYsCisJCQkJCSBlbnVt
IHp5bnFtcF9kaXNwX2xheWVyX2lkIGxheWVyLAorCQkJCQkgY29uc3Qgc3RydWN0IHp5bnFtcF9k
aXNwX2Zvcm1hdCAqZm10KQoreworCXVuc2lnbmVkIGludCBpOworCXUzMiB2YWw7CisKKwl2YWwg
PSB6eW5xbXBfZGlzcF9hdmJ1Zl9yZWFkKGF2YnVmLCBaWU5RTVBfRElTUF9BVl9CVUZfRk1UKTsK
Kwl2YWwgJj0gbGF5ZXIgPT0gWllOUU1QX0RJU1BfTEFZRVJfVklECisJICAgID8gflpZTlFNUF9E
SVNQX0FWX0JVRl9GTVRfTkxfVklEX01BU0sKKwkgICAgOiB+WllOUU1QX0RJU1BfQVZfQlVGX0ZN
VF9OTF9HRlhfTUFTSzsKKwl2YWwgfD0gZm10LT5idWZfZm10OworCXp5bnFtcF9kaXNwX2F2YnVm
X3dyaXRlKGF2YnVmLCBaWU5RTVBfRElTUF9BVl9CVUZfRk1ULCB2YWwpOworCisJZm9yIChpID0g
MDsgaSA8IFpZTlFNUF9ESVNQX0FWX0JVRl9OVU1fU0Y7IGkrKykgeworCQl1bnNpZ25lZCBpbnQg
cmVnID0gbGF5ZXIgPT0gWllOUU1QX0RJU1BfTEFZRVJfVklECisJCQkJID8gWllOUU1QX0RJU1Bf
QVZfQlVGX1ZJRF9DT01QX1NGKGkpCisJCQkJIDogWllOUU1QX0RJU1BfQVZfQlVGX0dGWF9DT01Q
X1NGKGkpOworCisJCXp5bnFtcF9kaXNwX2F2YnVmX3dyaXRlKGF2YnVmLCByZWcsIGZtdC0+c2Zb
aV0pOworCX0KK30KKworLyoqCisgKiB6eW5xbXBfZGlzcF9hdmJ1Zl9zZXRfY2xvY2tzX3NvdXJj
ZXMgLSBTZXQgdGhlIGNsb2NrcyBzb3VyY2VzCisgKiBAYXZidWY6IEF1ZGlvL3ZpZGVvIGJ1ZmZl
ciBtYW5hZ2VyCisgKiBAdmlkZW9fZnJvbV9wczogVHJ1ZSBpZiB0aGUgdmlkZW8gY2xvY2sgb3Jp
Z2luYXRlcyBmcm9tIHRoZSBQUworICogQGF1ZGlvX2Zyb21fcHM6IFRydWUgaWYgdGhlIGF1ZGlv
IGNsb2NrIG9yaWdpbmF0ZXMgZnJvbSB0aGUgUFMKKyAqIEB0aW1pbmdzX2ludGVybmFsOiBUcnVl
IGlmIHZpZGVvIHRpbWluZ3MgYXJlIGdlbmVyYXRlZCBpbnRlcm5hbGx5CisgKgorICogU2V0IHRo
ZSBzb3VyY2UgZm9yIHRoZSB2aWRlbyBhbmQgYXVkaW8gY2xvY2tzLCBhcyB3ZWxsIGFzIGZvciB0
aGUgdmlkZW8KKyAqIHRpbWluZ3MuIENsb2NrcyBjYW4gb3JpZ2luYXRlIGZyb20gdGhlIFBTIG9y
IFBMLCBhbmQgdGltaW5ncyBjYW4gYmUKKyAqIGdlbmVyYXRlZCBpbnRlcm5hbGx5IG9yIGV4dGVy
bmFsbHkuCisgKi8KK3N0YXRpYyB2b2lkCit6eW5xbXBfZGlzcF9hdmJ1Zl9zZXRfY2xvY2tzX3Nv
dXJjZXMoc3RydWN0IHp5bnFtcF9kaXNwX2F2YnVmICphdmJ1ZiwKKwkJCQkgICAgIGJvb2wgdmlk
ZW9fZnJvbV9wcywgYm9vbCBhdWRpb19mcm9tX3BzLAorCQkJCSAgICAgYm9vbCB0aW1pbmdzX2lu
dGVybmFsKQoreworCXUzMiB2YWwgPSAwOworCisJaWYgKHZpZGVvX2Zyb21fcHMpCisJCXZhbCB8
PSBaWU5RTVBfRElTUF9BVl9CVUZfQ0xLX1NSQ19WSURfRlJPTV9QUzsKKwlpZiAoYXVkaW9fZnJv
bV9wcykKKwkJdmFsIHw9IFpZTlFNUF9ESVNQX0FWX0JVRl9DTEtfU1JDX0FVRF9GUk9NX1BTOwor
CWlmICh0aW1pbmdzX2ludGVybmFsKQorCQl2YWwgfD0gWllOUU1QX0RJU1BfQVZfQlVGX0NMS19T
UkNfVklEX0lOVEVSTkFMX1RJTUlORzsKKworCXp5bnFtcF9kaXNwX2F2YnVmX3dyaXRlKGF2YnVm
LCBaWU5RTVBfRElTUF9BVl9CVUZfQ0xLX1NSQywgdmFsKTsKK30KKworLyoqCisgKiB6eW5xbXBf
ZGlzcF9hdmJ1Zl9lbmFibGVfY2hhbm5lbHMgLSBFbmFibGUgYnVmZmVyIGNoYW5uZWxzCisgKiBA
YXZidWY6IEF1ZGlvL3ZpZGVvIGJ1ZmZlciBtYW5hZ2VyCisgKgorICogRW5hYmxlIGFsbCAodmlk
ZW8gYW5kIGF1ZGlvKSBidWZmZXIgY2hhbm5lbHMuCisgKi8KK3N0YXRpYyB2b2lkIHp5bnFtcF9k
aXNwX2F2YnVmX2VuYWJsZV9jaGFubmVscyhzdHJ1Y3QgenlucW1wX2Rpc3BfYXZidWYgKmF2YnVm
KQoreworCXVuc2lnbmVkIGludCBpOworCXUzMiB2YWw7CisKKwl2YWwgPSBaWU5RTVBfRElTUF9B
Vl9CVUZfQ0hCVUZfRU4gfAorCSAgICAgIChaWU5RTVBfRElTUF9BVl9CVUZfQ0hCVUZfQlVSU1Rf
TEVOX01BWCA8PAorCSAgICAgICBaWU5RTVBfRElTUF9BVl9CVUZfQ0hCVUZfQlVSU1RfTEVOX1NI
SUZUKTsKKworCWZvciAoaSA9IDA7IGkgPCBaWU5RTVBfRElTUF9BVl9CVUZfTlVNX1ZJRF9HRlhf
QlVGRkVSUzsgaSsrKQorCQl6eW5xbXBfZGlzcF9hdmJ1Zl93cml0ZShhdmJ1ZiwgWllOUU1QX0RJ
U1BfQVZfQlVGX0NIQlVGKGkpLAorCQkJCQl2YWwpOworCisJdmFsID0gWllOUU1QX0RJU1BfQVZf
QlVGX0NIQlVGX0VOIHwKKwkgICAgICAoWllOUU1QX0RJU1BfQVZfQlVGX0NIQlVGX0JVUlNUX0xF
Tl9BVURfTUFYIDw8CisJICAgICAgIFpZTlFNUF9ESVNQX0FWX0JVRl9DSEJVRl9CVVJTVF9MRU5f
U0hJRlQpOworCisJZm9yICg7IGkgPCBaWU5RTVBfRElTUF9BVl9CVUZfTlVNX0JVRkZFUlM7IGkr
KykKKwkJenlucW1wX2Rpc3BfYXZidWZfd3JpdGUoYXZidWYsIFpZTlFNUF9ESVNQX0FWX0JVRl9D
SEJVRihpKSwKKwkJCQkJdmFsKTsKK30KKworLyoqCisgKiB6eW5xbXBfZGlzcF9hdmJ1Zl9kaXNh
YmxlX2NoYW5uZWxzIC0gRGlzYWJsZSBidWZmZXIgY2hhbm5lbHMKKyAqIEBhdmJ1ZjogQXVkaW8v
dmlkZW8gYnVmZmVyIG1hbmFnZXIKKyAqCisgKiBEaXNhYmxlIGFsbCAodmlkZW8gYW5kIGF1ZGlv
KSBidWZmZXIgY2hhbm5lbHMuCisgKi8KK3N0YXRpYyB2b2lkIHp5bnFtcF9kaXNwX2F2YnVmX2Rp
c2FibGVfY2hhbm5lbHMoc3RydWN0IHp5bnFtcF9kaXNwX2F2YnVmICphdmJ1ZikKK3sKKwl1bnNp
Z25lZCBpbnQgaTsKKworCWZvciAoaSA9IDA7IGkgPCBaWU5RTVBfRElTUF9BVl9CVUZfTlVNX0JV
RkZFUlM7IGkrKykKKwkJenlucW1wX2Rpc3BfYXZidWZfd3JpdGUoYXZidWYsIFpZTlFNUF9ESVNQ
X0FWX0JVRl9DSEJVRihpKSwKKwkJCQkJWllOUU1QX0RJU1BfQVZfQlVGX0NIQlVGX0ZMVVNIKTsK
K30KKworLyoqCisgKiB6eW5xbXBfZGlzcF9hdmJ1Zl9lbmFibGVfYXVkaW8gLSBFbmFibGUgYXVk
aW8KKyAqIEBhdmJ1ZjogQXVkaW8vdmlkZW8gYnVmZmVyIG1hbmFnZXIKKyAqCisgKiBFbmFibGUg
YWxsIGF1ZGlvIGJ1ZmZlcnMgd2l0aCBhIG5vbi1saXZlIChtZW1vcnkpIHNvdXJjZS4KKyAqLwor
c3RhdGljIHZvaWQgenlucW1wX2Rpc3BfYXZidWZfZW5hYmxlX2F1ZGlvKHN0cnVjdCB6eW5xbXBf
ZGlzcF9hdmJ1ZiAqYXZidWYpCit7CisJdTMyIHZhbDsKKworCXZhbCA9IHp5bnFtcF9kaXNwX2F2
YnVmX3JlYWQoYXZidWYsIFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVQpOworCXZhbCAmPSB+WllO
UU1QX0RJU1BfQVZfQlVGX09VVFBVVF9BVUQxX01BU0s7CisJdmFsIHw9IFpZTlFNUF9ESVNQX0FW
X0JVRl9PVVRQVVRfQVVEMV9NRU07CisJdmFsIHw9IFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRf
QVVEMl9FTjsKKwl6eW5xbXBfZGlzcF9hdmJ1Zl93cml0ZShhdmJ1ZiwgWllOUU1QX0RJU1BfQVZf
QlVGX09VVFBVVCwgdmFsKTsKK30KKworLyoqCisgKiB6eW5xbXBfZGlzcF9hdmJ1Zl9kaXNhYmxl
X2F1ZGlvIC0gRGlzYWJsZSBhdWRpbworICogQGF2YnVmOiBBdWRpby92aWRlbyBidWZmZXIgbWFu
YWdlcgorICoKKyAqIERpc2FibGUgYWxsIGF1ZGlvIGJ1ZmZlcnMuCisgKi8KK3N0YXRpYyB2b2lk
IHp5bnFtcF9kaXNwX2F2YnVmX2Rpc2FibGVfYXVkaW8oc3RydWN0IHp5bnFtcF9kaXNwX2F2YnVm
ICphdmJ1ZikKK3sKKwl1MzIgdmFsOworCisJdmFsID0genlucW1wX2Rpc3BfYXZidWZfcmVhZChh
dmJ1ZiwgWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVCk7CisJdmFsICY9IH5aWU5RTVBfRElTUF9B
Vl9CVUZfT1VUUFVUX0FVRDFfTUFTSzsKKwl2YWwgfD0gWllOUU1QX0RJU1BfQVZfQlVGX09VVFBV
VF9BVUQxX0RJU0FCTEU7CisJdmFsICY9IH5aWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVUX0FVRDJf
RU47CisJenlucW1wX2Rpc3BfYXZidWZfd3JpdGUoYXZidWYsIFpZTlFNUF9ESVNQX0FWX0JVRl9P
VVRQVVQsIHZhbCk7Cit9CisKKy8qKgorICogenlucW1wX2Rpc3BfYXZidWZfZW5hYmxlX3ZpZGVv
IC0gRW5hYmxlIGEgdmlkZW8gbGF5ZXIKKyAqIEBhdmJ1ZjogQXVkaW8vdmlkZW8gYnVmZmVyIG1h
bmFnZXIKKyAqIEBsYXllcjogVGhlIGxheWVyIElECisgKiBAbW9kZTogT3BlcmF0aW5nIG1vZGUg
b2YgbGF5ZXIKKyAqCisgKiBFbmFibGUgdGhlIHZpZGVvL2dyYXBoaWNzIGJ1ZmZlciBmb3IgQGxh
eWVyLgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9hdmJ1Zl9lbmFibGVfdmlkZW8oc3Ry
dWN0IHp5bnFtcF9kaXNwX2F2YnVmICphdmJ1ZiwKKwkJCQkJICAgZW51bSB6eW5xbXBfZGlzcF9s
YXllcl9pZCBsYXllciwKKwkJCQkJICAgZW51bSB6eW5xbXBfZGlzcF9sYXllcl9tb2RlIG1vZGUp
Cit7CisJdTMyIHZhbDsKKworCXZhbCA9IHp5bnFtcF9kaXNwX2F2YnVmX3JlYWQoYXZidWYsIFpZ
TlFNUF9ESVNQX0FWX0JVRl9PVVRQVVQpOworCWlmIChsYXllciA9PSBaWU5RTVBfRElTUF9MQVlF
Ul9WSUQpIHsKKwkJdmFsICY9IH5aWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVUX1ZJRDFfTUFTSzsK
KwkJaWYgKG1vZGUgPT0gWllOUU1QX0RJU1BfTEFZRVJfTk9OTElWRSkKKwkJCXZhbCB8PSBaWU5R
TVBfRElTUF9BVl9CVUZfT1VUUFVUX1ZJRDFfTUVNOworCQllbHNlCisJCQl2YWwgfD0gWllOUU1Q
X0RJU1BfQVZfQlVGX09VVFBVVF9WSUQxX0xJVkU7CisJfSBlbHNlIHsKKwkJdmFsICY9IH5aWU5R
TVBfRElTUF9BVl9CVUZfT1VUUFVUX1ZJRDJfTUFTSzsKKwkJdmFsIHw9IFpZTlFNUF9ESVNQX0FW
X0JVRl9PVVRQVVRfVklEMl9NRU07CisJCWlmIChtb2RlID09IFpZTlFNUF9ESVNQX0xBWUVSX05P
TkxJVkUpCisJCQl2YWwgfD0gWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9WSUQyX01FTTsKKwkJ
ZWxzZQorCQkJdmFsIHw9IFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfVklEMl9MSVZFOworCX0K
Kwl6eW5xbXBfZGlzcF9hdmJ1Zl93cml0ZShhdmJ1ZiwgWllOUU1QX0RJU1BfQVZfQlVGX09VVFBV
VCwgdmFsKTsKK30KKworLyoqCisgKiB6eW5xbXBfZGlzcF9hdmJ1Zl9kaXNhYmxlX3ZpZGVvIC0g
RGlzYWJsZSBhIHZpZGVvIGxheWVyCisgKiBAYXZidWY6IEF1ZGlvL3ZpZGVvIGJ1ZmZlciBtYW5h
Z2VyCisgKiBAbGF5ZXI6IFRoZSBsYXllciBJRAorICoKKyAqIERpc2FibGUgdGhlIHZpZGVvL2dy
YXBoaWNzIGJ1ZmZlciBmb3IgQGxheWVyLgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9h
dmJ1Zl9kaXNhYmxlX3ZpZGVvKHN0cnVjdCB6eW5xbXBfZGlzcF9hdmJ1ZiAqYXZidWYsCisJCQkJ
CSAgICBlbnVtIHp5bnFtcF9kaXNwX2xheWVyX2lkIGxheWVyKQoreworCXUzMiB2YWw7CisKKwl2
YWwgPSB6eW5xbXBfZGlzcF9hdmJ1Zl9yZWFkKGF2YnVmLCBaWU5RTVBfRElTUF9BVl9CVUZfT1VU
UFVUKTsKKwlpZiAobGF5ZXIgPT0gWllOUU1QX0RJU1BfTEFZRVJfVklEKSB7CisJCXZhbCAmPSB+
WllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9WSUQxX01BU0s7CisJCXZhbCB8PSBaWU5RTVBfRElT
UF9BVl9CVUZfT1VUUFVUX1ZJRDFfTk9ORTsKKwl9IGVsc2UgeworCQl2YWwgJj0gflpZTlFNUF9E
SVNQX0FWX0JVRl9PVVRQVVRfVklEMl9NQVNLOworCQl2YWwgfD0gWllOUU1QX0RJU1BfQVZfQlVG
X09VVFBVVF9WSUQyX0RJU0FCTEU7CisJfQorCXp5bnFtcF9kaXNwX2F2YnVmX3dyaXRlKGF2YnVm
LCBaWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVULCB2YWwpOworfQorCisvKioKKyAqIHp5bnFtcF9k
aXNwX2F2YnVmX2VuYWJsZSAtIEVuYWJsZSB0aGUgdmlkZW8gcGlwZQorICogQGF2YnVmOiBBdWRp
by92aWRlbyBidWZmZXIgbWFuYWdlcgorICoKKyAqIERlLWFzc2VydCB0aGUgdmlkZW8gcGlwZSBy
ZXNldC4KKyAqLworc3RhdGljIHZvaWQgenlucW1wX2Rpc3BfYXZidWZfZW5hYmxlKHN0cnVjdCB6
eW5xbXBfZGlzcF9hdmJ1ZiAqYXZidWYpCit7CisJenlucW1wX2Rpc3BfYXZidWZfd3JpdGUoYXZi
dWYsIFpZTlFNUF9ESVNQX0FWX0JVRl9TUlNUX1JFRywgMCk7Cit9CisKKy8qKgorICogenlucW1w
X2Rpc3BfYXZidWZfZGlzYWJsZSAtIERpc2FibGUgdGhlIHZpZGVvIHBpcGUKKyAqIEBhdmJ1Zjog
QXVkaW8vdmlkZW8gYnVmZmVyIG1hbmFnZXIKKyAqCisgKiBBc3NlcnQgdGhlIHZpZGVvIHBpcGUg
cmVzZXQuCisgKi8KK3N0YXRpYyB2b2lkIHp5bnFtcF9kaXNwX2F2YnVmX2Rpc2FibGUoc3RydWN0
IHp5bnFtcF9kaXNwX2F2YnVmICphdmJ1ZikKK3sKKwl6eW5xbXBfZGlzcF9hdmJ1Zl93cml0ZShh
dmJ1ZiwgWllOUU1QX0RJU1BfQVZfQlVGX1NSU1RfUkVHLAorCQkJCVpZTlFNUF9ESVNQX0FWX0JV
Rl9TUlNUX1JFR19WSURfUlNUKTsKK30KKworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqIEJs
ZW5kZXIgKFZpZGVvIFBpcGVsaW5lKQorICovCisKK3N0YXRpYyB2b2lkIHp5bnFtcF9kaXNwX2Js
ZW5kX3dyaXRlKHN0cnVjdCB6eW5xbXBfZGlzcF9ibGVuZCAqYmxlbmQsCisJCQkJICAgIGludCBy
ZWcsIHUzMiB2YWwpCit7CisJd3JpdGVsKHZhbCwgYmxlbmQtPmJhc2UgKyByZWcpOworfQorCisv
KgorICogQ29sb3JzcGFjZSBjb252ZXJzaW9uIG1hdHJpY2VzLgorICoKKyAqIEhhcmRjb2RlIFJH
QiA8LT4gWVVWIGNvbnZlcnNpb24gdG8gZnVsbC1yYW5nZSBTRFRWIGZvciBub3cuCisgKi8KK3N0
YXRpYyBjb25zdCB1MTYgY3NjX3plcm9fbWF0cml4W10gPSB7CisJMHgwLCAgICAweDAsICAgIDB4
MCwKKwkweDAsICAgIDB4MCwgICAgMHgwLAorCTB4MCwgICAgMHgwLCAgICAweDAKK307CisKK3N0
YXRpYyBjb25zdCB1MTYgY3NjX2lkZW50aXR5X21hdHJpeFtdID0geworCTB4MTAwMCwgMHgwLCAg
ICAweDAsCisJMHgwLCAgICAweDEwMDAsIDB4MCwKKwkweDAsICAgIDB4MCwgICAgMHgxMDAwCit9
OworCitzdGF0aWMgY29uc3QgdTMyIGNzY196ZXJvX29mZnNldHNbXSA9IHsKKwkwLCAwLCAwCit9
OworCitzdGF0aWMgY29uc3QgdTE2IGNzY19yZ2JfdG9fc2R0dl9tYXRyaXhbXSA9IHsKKwkweDRj
OSwgIDB4ODY0LCAgMHgxZDMsCisJMHg3ZDRkLCAweDdhYjMsIDB4ODAwLAorCTB4ODAwLCAgMHg3
OTRkLCAweDdlYjMKK307CisKK3N0YXRpYyBjb25zdCB1MzIgY3NjX3JnYl90b19zZHR2X29mZnNl
dHNbXSA9IHsKKwkweDAsIDB4ODAwMDAwMCwgMHg4MDAwMDAwCit9OworCitzdGF0aWMgY29uc3Qg
dTE2IGNzY19zZHR2X3RvX3JnYl9tYXRyaXhbXSA9IHsKKwkweDEwMDAsIDB4MTY2ZiwgMHgwLAor
CTB4MTAwMCwgMHg3NDgzLCAweDdhN2YsCisJMHgxMDAwLCAweDAsICAgIDB4MWM1YQorfTsKKwor
c3RhdGljIGNvbnN0IHUzMiBjc2Nfc2R0dl90b19yZ2Jfb2Zmc2V0c1tdID0geworCTB4MCwgMHgx
ODAwLCAweDE4MDAKK307CisKKy8qKgorICogenlucW1wX2Rpc3BfYmxlbmRfc2V0X291dHB1dF9m
b3JtYXQgLSBTZXQgdGhlIG91dHB1dCBmb3JtYXQgb2YgdGhlIGJsZW5kZXIKKyAqIEBibGVuZDog
QmxlbmRlciBvYmplY3QKKyAqIEBmb3JtYXQ6IE91dHB1dCBmb3JtYXQKKyAqCisgKiBTZXQgdGhl
IG91dHB1dCBmb3JtYXQgb2YgdGhlIGJsZW5kZXIgdG8gQGZvcm1hdC4KKyAqLworc3RhdGljIHZv
aWQgenlucW1wX2Rpc3BfYmxlbmRfc2V0X291dHB1dF9mb3JtYXQoc3RydWN0IHp5bnFtcF9kaXNw
X2JsZW5kICpibGVuZCwKKwkJCQkJCWVudW0genlucW1wX2Rwc3ViX2Zvcm1hdCBmb3JtYXQpCit7
CisJc3RhdGljIGNvbnN0IHVuc2lnbmVkIGludCBibGVuZF9vdXRwdXRfZm10c1tdID0geworCQlb
WllOUU1QX0RQU1VCX0ZPUk1BVF9SR0JdID0gWllOUU1QX0RJU1BfVl9CTEVORF9PVVRQVVRfVklE
X0ZNVF9SR0IsCisJCVtaWU5RTVBfRFBTVUJfRk9STUFUX1lDUkNCNDQ0XSA9IFpZTlFNUF9ESVNQ
X1ZfQkxFTkRfT1VUUFVUX1ZJRF9GTVRfWUNCQ1I0NDQsCisJCVtaWU5RTVBfRFBTVUJfRk9STUFU
X1lDUkNCNDIyXSA9IFpZTlFNUF9ESVNQX1ZfQkxFTkRfT1VUUFVUX1ZJRF9GTVRfWUNCQ1I0MjIK
KwkJCQkJICAgICAgIHwgWllOUU1QX0RJU1BfVl9CTEVORF9PVVRQVVRfVklEX0ZNVF9FTl9ET1dO
U0FNUExFLAorCQlbWllOUU1QX0RQU1VCX0ZPUk1BVF9ZT05MWV0gPSBaWU5RTVBfRElTUF9WX0JM
RU5EX09VVFBVVF9WSURfRk1UX1lPTkxZLAorCX07CisKKwl1MzIgZm10ID0gYmxlbmRfb3V0cHV0
X2ZtdHNbZm9ybWF0XTsKKwljb25zdCB1MTYgKmNvZWZmczsKKwljb25zdCB1MzIgKm9mZnNldHM7
CisJdW5zaWduZWQgaW50IGk7CisKKwl6eW5xbXBfZGlzcF9ibGVuZF93cml0ZShibGVuZCwgWllO
UU1QX0RJU1BfVl9CTEVORF9PVVRQVVRfVklEX0ZNVCwgZm10KTsKKwlpZiAoZm10ID09IFpZTlFN
UF9ESVNQX1ZfQkxFTkRfT1VUUFVUX1ZJRF9GTVRfUkdCKSB7CisJCWNvZWZmcyA9IGNzY19pZGVu
dGl0eV9tYXRyaXg7CisJCW9mZnNldHMgPSBjc2NfemVyb19vZmZzZXRzOworCX0gZWxzZSB7CisJ
CWNvZWZmcyA9IGNzY19yZ2JfdG9fc2R0dl9tYXRyaXg7CisJCW9mZnNldHMgPSBjc2NfcmdiX3Rv
X3NkdHZfb2Zmc2V0czsKKwl9CisKKwlmb3IgKGkgPSAwOyBpIDwgWllOUU1QX0RJU1BfVl9CTEVO
RF9OVU1fQ09FRkY7IGkrKykKKwkJenlucW1wX2Rpc3BfYmxlbmRfd3JpdGUoYmxlbmQsCisJCQkJ
CVpZTlFNUF9ESVNQX1ZfQkxFTkRfUkdCMllDQkNSX0NPRUZGKGkpLAorCQkJCQljb2VmZnNbaV0p
OworCisJZm9yIChpID0gMDsgaSA8IFpZTlFNUF9ESVNQX1ZfQkxFTkRfTlVNX09GRlNFVDsgaSsr
KQorCQl6eW5xbXBfZGlzcF9ibGVuZF93cml0ZShibGVuZCwKKwkJCQkJWllOUU1QX0RJU1BfVl9C
TEVORF9PVVRDU0NfT0ZGU0VUKGkpLAorCQkJCQlvZmZzZXRzW2ldKTsKK30KKworLyoqCisgKiB6
eW5xbXBfZGlzcF9ibGVuZF9zZXRfYmdfY29sb3IgLSBTZXQgdGhlIGJhY2tncm91bmQgY29sb3IK
KyAqIEBibGVuZDogQmxlbmRlciBvYmplY3QKKyAqIEByY3I6IFJlZC9DciBjb2xvciBjb21wb25l
bnQKKyAqIEBneTogR3JlZW4vWSBjb2xvciBjb21wb25lbnQKKyAqIEBiY2I6IEJsdWUvQ2IgY29s
b3IgY29tcG9uZW50CisgKgorICogU2V0IHRoZSBiYWNrZ3JvdW5kIGNvbG9yIHRvIChAcmNyLCBA
Z3ksIEBiY2IpLCBjb3JyZXNwb25kaW5nIHRvIHRoZSBSLCBHIGFuZAorICogQiBvciBDciwgWSBh
bmQgQ2IgY29tcG9uZW50cyByZXNwZWN0aXZlbHkgZGVwZW5kaW5nIG9uIHRoZSBzZWxlY3RlZCBv
dXRwdXQKKyAqIGZvcm1hdC4KKyAqLworc3RhdGljIHZvaWQgenlucW1wX2Rpc3BfYmxlbmRfc2V0
X2JnX2NvbG9yKHN0cnVjdCB6eW5xbXBfZGlzcF9ibGVuZCAqYmxlbmQsCisJCQkJCSAgIHUzMiBy
Y3IsIHUzMiBneSwgdTMyIGJjYikKK3sKKwl6eW5xbXBfZGlzcF9ibGVuZF93cml0ZShibGVuZCwg
WllOUU1QX0RJU1BfVl9CTEVORF9CR19DTFJfMCwgcmNyKTsKKwl6eW5xbXBfZGlzcF9ibGVuZF93
cml0ZShibGVuZCwgWllOUU1QX0RJU1BfVl9CTEVORF9CR19DTFJfMSwgZ3kpOworCXp5bnFtcF9k
aXNwX2JsZW5kX3dyaXRlKGJsZW5kLCBaWU5RTVBfRElTUF9WX0JMRU5EX0JHX0NMUl8yLCBiY2Ip
OworfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2JsZW5kX3NldF9nbG9iYWxfYWxwaGEgLSBDb25m
aWd1cmUgZ2xvYmFsIGFscGhhIGJsZW5kaW5nCisgKiBAYmxlbmQ6IEJsZW5kZXIgb2JqZWN0Cisg
KiBAZW5hYmxlOiBUcnVlIHRvIGVuYWJsZSBnbG9iYWwgYWxwaGEgYmxlbmRpbmcKKyAqIEBhbHBo
YTogR2xvYmFsIGFscGhhIHZhbHVlIChpZ25vcmVkIGlmIEBlbmFibGVkIGlzIGZhbHNlKQorICov
CitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9ibGVuZF9zZXRfZ2xvYmFsX2FscGhhKHN0cnVjdCB6
eW5xbXBfZGlzcF9ibGVuZCAqYmxlbmQsCisJCQkJCSAgICAgICBib29sIGVuYWJsZSwgdTMyIGFs
cGhhKQoreworCXp5bnFtcF9kaXNwX2JsZW5kX3dyaXRlKGJsZW5kLCBaWU5RTVBfRElTUF9WX0JM
RU5EX1NFVF9HTE9CQUxfQUxQSEEsCisJCQkJWllOUU1QX0RJU1BfVl9CTEVORF9TRVRfR0xPQkFM
X0FMUEhBX1ZBTFVFKGFscGhhKSB8CisJCQkJKGVuYWJsZSA/IFpZTlFNUF9ESVNQX1ZfQkxFTkRf
U0VUX0dMT0JBTF9BTFBIQV9FTiA6IDApKTsKK30KKworLyoqCisgKiB6eW5xbXBfZGlzcF9ibGVu
ZF9sYXllcl9zZXRfY3NjIC0gQ29uZmlndXJlIGNvbG9yc3BhY2UgY29udmVyc2lvbiBmb3IgbGF5
ZXIKKyAqIEBibGVuZDogQmxlbmRlciBvYmplY3QKKyAqIEBsYXllcjogVGhlIGxheWVyCisgKiBA
Y29lZmZzOiBDb2xvcnNwYWNlIGNvbnZlcnNpb24gbWF0cml4CisgKiBAb2Zmc2V0czogQ29sb3Jz
cGFjZSBjb252ZXJzaW9uIG9mZnNldHMKKyAqCisgKiBDb25maWd1cmUgdGhlIGlucHV0IGNvbG9y
c3BhY2UgY29udmVyc2lvbiBtYXRyaXggYW5kIG9mZnNldHMgZm9yIHRoZSBAbGF5ZXIuCisgKiBD
b2x1bW5zIG9mIHRoZSBtYXRyaXggYXJlIGF1dG9tYXRpY2FsbHkgc3dhcHBlZCBiYXNlZCBvbiB0
aGUgaW5wdXQgZm9ybWF0IHRvCisgKiBoYW5kbGUgUkdCIGFuZCBZQ3JDYiBjb21wb25lbnRzIHBl
cm11dGF0aW9ucy4KKyAqLworc3RhdGljIHZvaWQgenlucW1wX2Rpc3BfYmxlbmRfbGF5ZXJfc2V0
X2NzYyhzdHJ1Y3QgenlucW1wX2Rpc3BfYmxlbmQgKmJsZW5kLAorCQkJCQkgICAgc3RydWN0IHp5
bnFtcF9kaXNwX2xheWVyICpsYXllciwKKwkJCQkJICAgIGNvbnN0IHUxNiAqY29lZmZzLAorCQkJ
CQkgICAgY29uc3QgdTMyICpvZmZzZXRzKQoreworCXVuc2lnbmVkIGludCBzd2FwWzNdID0geyAw
LCAxLCAyIH07CisJdW5zaWduZWQgaW50IHJlZzsKKwl1bnNpZ25lZCBpbnQgaTsKKworCWlmIChs
YXllci0+ZGlzcF9mbXQtPnN3YXApIHsKKwkJaWYgKGxheWVyLT5kcm1fZm10LT5pc195dXYpIHsK
KwkJCS8qIFN3YXAgVSBhbmQgVi4gKi8KKwkJCXN3YXBbMV0gPSAyOworCQkJc3dhcFsyXSA9IDE7
CisJCX0gZWxzZSB7CisJCQkvKiBTd2FwIFIgYW5kIEIuICovCisJCQlzd2FwWzBdID0gMjsKKwkJ
CXN3YXBbMl0gPSAwOworCQl9CisJfQorCisJaWYgKGxheWVyLT5pZCA9PSBaWU5RTVBfRElTUF9M
QVlFUl9WSUQpCisJCXJlZyA9IFpZTlFNUF9ESVNQX1ZfQkxFTkRfSU4xQ1NDX0NPRUZGKDApOwor
CWVsc2UKKwkJcmVnID0gWllOUU1QX0RJU1BfVl9CTEVORF9JTjJDU0NfQ09FRkYoMCk7CisKKwlm
b3IgKGkgPSAwOyBpIDwgWllOUU1QX0RJU1BfVl9CTEVORF9OVU1fQ09FRkY7IGkgKz0gMywgcmVn
ICs9IDEyKSB7CisJCXp5bnFtcF9kaXNwX2JsZW5kX3dyaXRlKGJsZW5kLCByZWcgKyAwLCBjb2Vm
ZnNbaSArIHN3YXBbMF1dKTsKKwkJenlucW1wX2Rpc3BfYmxlbmRfd3JpdGUoYmxlbmQsIHJlZyAr
IDQsIGNvZWZmc1tpICsgc3dhcFsxXV0pOworCQl6eW5xbXBfZGlzcF9ibGVuZF93cml0ZShibGVu
ZCwgcmVnICsgOCwgY29lZmZzW2kgKyBzd2FwWzJdXSk7CisJfQorCisJaWYgKGxheWVyLT5pZCA9
PSBaWU5RTVBfRElTUF9MQVlFUl9WSUQpCisJCXJlZyA9IFpZTlFNUF9ESVNQX1ZfQkxFTkRfSU4x
Q1NDX09GRlNFVCgwKTsKKwllbHNlCisJCXJlZyA9IFpZTlFNUF9ESVNQX1ZfQkxFTkRfSU4yQ1ND
X09GRlNFVCgwKTsKKworCWZvciAoaSA9IDA7IGkgPCBaWU5RTVBfRElTUF9WX0JMRU5EX05VTV9P
RkZTRVQ7IGkrKykKKwkJenlucW1wX2Rpc3BfYmxlbmRfd3JpdGUoYmxlbmQsIHJlZyArIGkgKiA0
LCBvZmZzZXRzW2ldKTsKK30KKworLyoqCisgKiB6eW5xbXBfZGlzcF9ibGVuZF9sYXllcl9lbmFi
bGUgLSBFbmFibGUgYSBsYXllcgorICogQGJsZW5kOiBCbGVuZGVyIG9iamVjdAorICogQGxheWVy
OiBUaGUgbGF5ZXIKKyAqLworc3RhdGljIHZvaWQgenlucW1wX2Rpc3BfYmxlbmRfbGF5ZXJfZW5h
YmxlKHN0cnVjdCB6eW5xbXBfZGlzcF9ibGVuZCAqYmxlbmQsCisJCQkJCSAgIHN0cnVjdCB6eW5x
bXBfZGlzcF9sYXllciAqbGF5ZXIpCit7CisJY29uc3QgdTE2ICpjb2VmZnM7CisJY29uc3QgdTMy
ICpvZmZzZXRzOworCXUzMiB2YWw7CisKKwl2YWwgPSAobGF5ZXItPmRybV9mbXQtPmlzX3l1diA/
CisJICAgICAgIDAgOiBaWU5RTVBfRElTUF9WX0JMRU5EX0xBWUVSX0NPTlRST0xfUkdCKSB8CisJ
ICAgICAgKGxheWVyLT5kcm1fZm10LT5oc3ViID4gMSA/CisJICAgICAgIFpZTlFNUF9ESVNQX1Zf
QkxFTkRfTEFZRVJfQ09OVFJPTF9FTl9VUyA6IDApOworCisJenlucW1wX2Rpc3BfYmxlbmRfd3Jp
dGUoYmxlbmQsCisJCQkJWllOUU1QX0RJU1BfVl9CTEVORF9MQVlFUl9DT05UUk9MKGxheWVyLT5p
ZCksCisJCQkJdmFsKTsKKworCWlmIChsYXllci0+ZHJtX2ZtdC0+aXNfeXV2KSB7CisJCWNvZWZm
cyA9IGNzY19zZHR2X3RvX3JnYl9tYXRyaXg7CisJCW9mZnNldHMgPSBjc2Nfc2R0dl90b19yZ2Jf
b2Zmc2V0czsKKwl9IGVsc2UgeworCQljb2VmZnMgPSBjc2NfaWRlbnRpdHlfbWF0cml4OworCQlv
ZmZzZXRzID0gY3NjX3plcm9fb2Zmc2V0czsKKwl9CisKKwl6eW5xbXBfZGlzcF9ibGVuZF9sYXll
cl9zZXRfY3NjKGJsZW5kLCBsYXllciwgY29lZmZzLCBvZmZzZXRzKTsKK30KKworLyoqCisgKiB6
eW5xbXBfZGlzcF9ibGVuZF9sYXllcl9kaXNhYmxlIC0gRGlzYWJsZSBhIGxheWVyCisgKiBAYmxl
bmQ6IEJsZW5kZXIgb2JqZWN0CisgKiBAbGF5ZXI6IFRoZSBsYXllcgorICovCitzdGF0aWMgdm9p
ZCB6eW5xbXBfZGlzcF9ibGVuZF9sYXllcl9kaXNhYmxlKHN0cnVjdCB6eW5xbXBfZGlzcF9ibGVu
ZCAqYmxlbmQsCisJCQkJCSAgICBzdHJ1Y3QgenlucW1wX2Rpc3BfbGF5ZXIgKmxheWVyKQorewor
CXp5bnFtcF9kaXNwX2JsZW5kX3dyaXRlKGJsZW5kLAorCQkJCVpZTlFNUF9ESVNQX1ZfQkxFTkRf
TEFZRVJfQ09OVFJPTChsYXllci0+aWQpLAorCQkJCTApOworCisJenlucW1wX2Rpc3BfYmxlbmRf
bGF5ZXJfc2V0X2NzYyhibGVuZCwgbGF5ZXIsIGNzY196ZXJvX21hdHJpeCwKKwkJCQkJY3NjX3pl
cm9fb2Zmc2V0cyk7Cit9CisKKy8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisgKiBBdWRpbyBNaXhl
cgorICovCisKK3N0YXRpYyB2b2lkIHp5bnFtcF9kaXNwX2F1ZGlvX3dyaXRlKHN0cnVjdCB6eW5x
bXBfZGlzcF9hdWRpbyAqYXVkaW8sCisJCQkJICBpbnQgcmVnLCB1MzIgdmFsKQoreworCXdyaXRl
bCh2YWwsIGF1ZGlvLT5iYXNlICsgcmVnKTsKK30KKworLyoqCisgKiB6eW5xbXBfZGlzcF9hdWRp
b19lbmFibGUgLSBFbmFibGUgdGhlIGF1ZGlvIG1peGVyCisgKiBAYXVkaW86IEF1ZGlvIG1peGVy
CisgKgorICogRW5hYmxlIHRoZSBhdWRpbyBtaXhlciBieSBkZS1hc3NlcnRpbmcgdGhlIHNvZnQg
cmVzZXQuIFRoZSBhdWRpbyBzdGF0ZSBpcyBzZXQgdG8KKyAqIGRlZmF1bHQgdmFsdWVzIGJ5IHRo
ZSByZXNldCwgc2V0IHRoZSBkZWZhdWx0IG1peGVyIHZvbHVtZSBleHBsaWNpdGx5LgorICovCitz
dGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9hdWRpb19lbmFibGUoc3RydWN0IHp5bnFtcF9kaXNwX2F1
ZGlvICphdWRpbykKK3sKKwkvKiBDbGVhciB0aGUgYXVkaW8gc29mdCByZXNldCByZWdpc3RlciBh
cyBpdCdzIGFuIG5vbi1yZXNldCBmbG9wLiAqLworCXp5bnFtcF9kaXNwX2F1ZGlvX3dyaXRlKGF1
ZGlvLCBaWU5RTVBfRElTUF9BVURfU09GVF9SRVNFVCwgMCk7CisJenlucW1wX2Rpc3BfYXVkaW9f
d3JpdGUoYXVkaW8sIFpZTlFNUF9ESVNQX0FVRF9NSVhFUl9WT0xVTUUsCisJCQkJWllOUU1QX0RJ
U1BfQVVEX01JWEVSX1ZPTFVNRV9OT19TQ0FMRSk7Cit9CisKKy8qKgorICogenlucW1wX2Rpc3Bf
YXVkaW9fZGlzYWJsZSAtIERpc2FibGUgdGhlIGF1ZGlvIG1peGVyCisgKiBAYXVkaW86IEF1ZGlv
IG1peGVyCisgKgorICogRGlzYWJsZSB0aGUgYXVkaW8gbWl4ZXIgYnkgYXNzZXJ0aW5nIGl0cyBz
b2Z0IHJlc2V0LgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9hdWRpb19kaXNhYmxlKHN0
cnVjdCB6eW5xbXBfZGlzcF9hdWRpbyAqYXVkaW8pCit7CisJenlucW1wX2Rpc3BfYXVkaW9fd3Jp
dGUoYXVkaW8sIFpZTlFNUF9ESVNQX0FVRF9TT0ZUX1JFU0VULAorCQkJCVpZTlFNUF9ESVNQX0FV
RF9TT0ZUX1JFU0VUX0FVRF9TUlNUKTsKK30KKworc3RhdGljIHZvaWQgenlucW1wX2Rpc3BfYXVk
aW9faW5pdChzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkJICAgc3RydWN0IHp5bnFtcF9kaXNwX2F1
ZGlvICphdWRpbykKK3sKKwkvKiBUcnkgdGhlIGxpdmUgUEwgYXVkaW8gY2xvY2suICovCisJYXVk
aW8tPmNsayA9IGRldm1fY2xrX2dldChkZXYsICJkcF9saXZlX2F1ZGlvX2FjbGsiKTsKKwlpZiAo
IUlTX0VSUihhdWRpby0+Y2xrKSkgeworCQlhdWRpby0+Y2xrX2Zyb21fcHMgPSBmYWxzZTsKKwkJ
cmV0dXJuOworCX0KKworCS8qIElmIHRoZSBsaXZlIFBMIGF1ZGlvIGNsb2NrIGlzIG5vdCB2YWxp
ZCwgZmFsbCBiYWNrIHRvIFBTIGNsb2NrLiAqLworCWF1ZGlvLT5jbGsgPSBkZXZtX2Nsa19nZXQo
ZGV2LCAiZHBfYXVkX2NsayIpOworCWlmICghSVNfRVJSKGF1ZGlvLT5jbGspKSB7CisJCWF1ZGlv
LT5jbGtfZnJvbV9wcyA9IHRydWU7CisJCXJldHVybjsKKwl9CisKKwlkZXZfZXJyKGRldiwgImF1
ZGlvIGRpc2FibGVkIGR1ZSB0byBtaXNzaW5nIGNsb2NrXG4iKTsKK30KKworLyogLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0KKyAqIFp5bnFNUCBEaXNwbGF5IGV4dGVybmFsIGZ1bmN0aW9ucyBmb3Igenlu
cW1wX2RwCisgKi8KKworLyoqCisgKiB6eW5xbXBfZGlzcF9oYW5kbGVfdmJsYW5rIC0gSGFuZGxl
IHRoZSB2YmxhbmsgZXZlbnQKKyAqIEBkaXNwOiBEaXNwbGF5IGNvbnRyb2xsZXIKKyAqCisgKiBU
aGlzIGZ1bmN0aW9uIGhhbmRsZXMgdGhlIHZibGFuayBpbnRlcnJ1cHQsIGFuZCBzZW5kcyBhbiBl
dmVudCB0bworICogQ1JUQyBvYmplY3QuIFRoaXMgd2lsbCBiZSBjYWxsZWQgYnkgdGhlIERQIHZi
bGFuayBpbnRlcnJ1cHQgaGFuZGxlci4KKyAqLwordm9pZCB6eW5xbXBfZGlzcF9oYW5kbGVfdmJs
YW5rKHN0cnVjdCB6eW5xbXBfZGlzcCAqZGlzcCkKK3sKKwlzdHJ1Y3QgZHJtX2NydGMgKmNydGMg
PSAmZGlzcC0+Y3J0YzsKKworCWRybV9jcnRjX2hhbmRsZV92YmxhbmsoY3J0Yyk7Cit9CisKKy8q
KgorICogenlucW1wX2Rpc3BfYXVkaW9fZW5hYmxlZCAtIElmIHRoZSBhdWRpbyBpcyBlbmFibGVk
CisgKiBAZGlzcDogRGlzcGxheSBjb250cm9sbGVyCisgKgorICogUmV0dXJuIGlmIHRoZSBhdWRp
byBpcyBlbmFibGVkIGRlcGVuZGluZyBvbiB0aGUgYXVkaW8gY2xvY2suCisgKgorICogUmV0dXJu
OiB0cnVlIGlmIGF1ZGlvIGlzIGVuYWJsZWQsIG9yIGZhbHNlLgorICovCitib29sIHp5bnFtcF9k
aXNwX2F1ZGlvX2VuYWJsZWQoc3RydWN0IHp5bnFtcF9kaXNwICpkaXNwKQoreworCXJldHVybiAh
IWRpc3AtPmF1ZGlvLmNsazsKK30KKworLyoqCisgKiB6eW5xbXBfZGlzcF9nZXRfYXVkaW9fY2xr
X3JhdGUgLSBHZXQgdGhlIGN1cnJlbnQgYXVkaW8gY2xvY2sgcmF0ZQorICogQGRpc3A6IERpc3Bs
YXkgY29udHJvbGxlcgorICoKKyAqIFJldHVybjogdGhlIGN1cnJlbnQgYXVkaW8gY2xvY2sgcmF0
ZS4KKyAqLwordW5zaWduZWQgaW50IHp5bnFtcF9kaXNwX2dldF9hdWRpb19jbGtfcmF0ZShzdHJ1
Y3QgenlucW1wX2Rpc3AgKmRpc3ApCit7CisJaWYgKHp5bnFtcF9kaXNwX2F1ZGlvX2VuYWJsZWQo
ZGlzcCkpCisJCXJldHVybiAwOworCXJldHVybiBjbGtfZ2V0X3JhdGUoZGlzcC0+YXVkaW8uY2xr
KTsKK30KKworLyoqCisgKiB6eW5xbXBfZGlzcF9nZXRfY3J0Y19tYXNrIC0gUmV0dXJuIHRoZSBD
UlRDIGJpdCBtYXNrCisgKiBAZGlzcDogRGlzcGxheSBjb250cm9sbGVyCisgKgorICogUmV0dXJu
OiB0aGUgY3J0YyBtYXNrIG9mIHRoZSB6eXFubXBfZGlzcCBDUlRDLgorICovCit1aW50MzJfdCB6
eW5xbXBfZGlzcF9nZXRfY3J0Y19tYXNrKHN0cnVjdCB6eW5xbXBfZGlzcCAqZGlzcCkKK3sKKwly
ZXR1cm4gZHJtX2NydGNfbWFzaygmZGlzcC0+Y3J0Yyk7Cit9CisKKy8qIC0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tCisgKiBaeW5xTVAgRGlzcGxheSBMYXllciAmIERSTSBQbGFuZQorICovCisKKy8qKgor
ICogenlucW1wX2Rpc3BfbGF5ZXJfZmluZF9mb3JtYXQgLSBGaW5kIGZvcm1hdCBpbmZvcm1hdGlv
biBmb3IgYSBEUk0gZm9ybWF0CisgKiBAbGF5ZXI6IFRoZSBsYXllcgorICogQGRybV9mbXQ6IERS
TSBmb3JtYXQgdG8gc2VhcmNoCisgKgorICogU2VhcmNoIGRpc3BsYXkgc3Vic3lzdGVtIGZvcm1h
dCBpbmZvcm1hdGlvbiBjb3JyZXNwb25kaW5nIHRvIHRoZSBnaXZlbiBEUk0KKyAqIGZvcm1hdCBA
ZHJtX2ZtdCBmb3IgdGhlIEBsYXllciwgYW5kIHJldHVybiBhIHBvaW50ZXIgdG8gdGhlIGZvcm1h
dAorICogZGVzY3JpcHRvci4KKyAqCisgKiBSZXR1cm46IEEgcG9pbnRlciB0byB0aGUgZm9ybWF0
IGRlc2NyaXB0b3IgaWYgZm91bmQsIE5VTEwgb3RoZXJ3aXNlCisgKi8KK3N0YXRpYyBjb25zdCBz
dHJ1Y3QgenlucW1wX2Rpc3BfZm9ybWF0ICoKK3p5bnFtcF9kaXNwX2xheWVyX2ZpbmRfZm9ybWF0
KHN0cnVjdCB6eW5xbXBfZGlzcF9sYXllciAqbGF5ZXIsCisJCQkgICAgICB1MzIgZHJtX2ZtdCkK
K3sKKwl1bnNpZ25lZCBpbnQgaTsKKworCWZvciAoaSA9IDA7IGkgPCBsYXllci0+aW5mby0+bnVt
X2Zvcm1hdHM7IGkrKykgeworCQlpZiAobGF5ZXItPmluZm8tPmZvcm1hdHNbaV0uZHJtX2ZtdCA9
PSBkcm1fZm10KQorCQkJcmV0dXJuICZsYXllci0+aW5mby0+Zm9ybWF0c1tpXTsKKwl9CisKKwly
ZXR1cm4gTlVMTDsKK30KKworLyoqCisgKiB6eW5xbXBfZGlzcF9sYXllcl9lbmFibGUgLSBFbmFi
bGUgYSBsYXllcgorICogQGxheWVyOiBUaGUgbGF5ZXIKKyAqCisgKiBFbmFibGUgdGhlIEBsYXll
ciBpbiB0aGUgYXVkaW8vdmlkZW8gYnVmZmVyIG1hbmFnZXIgYW5kIHRoZSBibGVuZGVyLiBETUEK
KyAqIGNoYW5uZWxzIGFyZSBzdGFydGVkIHNlcGFyYXRlbHkgYnkgenlucW1wX2Rpc3BfbGF5ZXJf
dXBkYXRlKCkuCisgKi8KK3N0YXRpYyB2b2lkIHp5bnFtcF9kaXNwX2xheWVyX2VuYWJsZShzdHJ1
Y3QgenlucW1wX2Rpc3BfbGF5ZXIgKmxheWVyKQoreworCXp5bnFtcF9kaXNwX2F2YnVmX2VuYWJs
ZV92aWRlbygmbGF5ZXItPmRpc3AtPmF2YnVmLCBsYXllci0+aWQsCisJCQkJICAgICAgIFpZTlFN
UF9ESVNQX0xBWUVSX05PTkxJVkUpOworCXp5bnFtcF9kaXNwX2JsZW5kX2xheWVyX2VuYWJsZSgm
bGF5ZXItPmRpc3AtPmJsZW5kLCBsYXllcik7CisKKwlsYXllci0+bW9kZSA9IFpZTlFNUF9ESVNQ
X0xBWUVSX05PTkxJVkU7Cit9CisKKy8qKgorICogenlucW1wX2Rpc3BfbGF5ZXJfZGlzYWJsZSAt
IERpc2FibGUgdGhlIGxheWVyCisgKiBAbGF5ZXI6IFRoZSBsYXllcgorICoKKyAqIERpc2FibGUg
dGhlIGxheWVyIGJ5IHN0b3BwaW5nIGl0cyBETUEgY2hhbm5lbHMgYW5kIGRpc2FibGluZyBpdCBp
biB0aGUKKyAqIGF1ZGlvL3ZpZGVvIGJ1ZmZlciBtYW5hZ2VyIGFuZCB0aGUgYmxlbmRlci4KKyAq
Lworc3RhdGljIHZvaWQgenlucW1wX2Rpc3BfbGF5ZXJfZGlzYWJsZShzdHJ1Y3QgenlucW1wX2Rp
c3BfbGF5ZXIgKmxheWVyKQoreworCXVuc2lnbmVkIGludCBpOworCisJZm9yIChpID0gMDsgaSA8
IGxheWVyLT5kcm1fZm10LT5udW1fcGxhbmVzOyBpKyspCisJCWRtYWVuZ2luZV90ZXJtaW5hdGVf
c3luYyhsYXllci0+ZG1hc1tpXS5jaGFuKTsKKworCXp5bnFtcF9kaXNwX2F2YnVmX2Rpc2FibGVf
dmlkZW8oJmxheWVyLT5kaXNwLT5hdmJ1ZiwgbGF5ZXItPmlkKTsKKwl6eW5xbXBfZGlzcF9ibGVu
ZF9sYXllcl9kaXNhYmxlKCZsYXllci0+ZGlzcC0+YmxlbmQsIGxheWVyKTsKK30KKworLyoqCisg
KiB6eW5xbXBfZGlzcF9sYXllcl9zZXRfZm9ybWF0IC0gU2V0IHRoZSBsYXllciBmb3JtYXQKKyAq
IEBsYXllcjogVGhlIGxheWVyCisgKiBAc3RhdGU6IFRoZSBwbGFuZSBzdGF0ZQorICoKKyAqIFNl
dCB0aGUgZm9ybWF0IGZvciBAbGF5ZXIgYmFzZWQgb24gQHN0YXRlLT5mYi0+Zm9ybWF0LiBUaGUg
bGF5ZXIgbXVzdCBiZQorICogZGlzYWJsZWQuCisgKi8KK3N0YXRpYyB2b2lkIHp5bnFtcF9kaXNw
X2xheWVyX3NldF9mb3JtYXQoc3RydWN0IHp5bnFtcF9kaXNwX2xheWVyICpsYXllciwKKwkJCQkJ
IHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnN0YXRlKQoreworCWNvbnN0IHN0cnVjdCBkcm1fZm9y
bWF0X2luZm8gKmluZm8gPSBzdGF0ZS0+ZmItPmZvcm1hdDsKKwl1bnNpZ25lZCBpbnQgaTsKKwor
CWxheWVyLT5kaXNwX2ZtdCA9IHp5bnFtcF9kaXNwX2xheWVyX2ZpbmRfZm9ybWF0KGxheWVyLCBp
bmZvLT5mb3JtYXQpOworCWxheWVyLT5kcm1fZm10ID0gaW5mbzsKKworCXp5bnFtcF9kaXNwX2F2
YnVmX3NldF9mb3JtYXQoJmxheWVyLT5kaXNwLT5hdmJ1ZiwgbGF5ZXItPmlkLAorCQkJCSAgICAg
bGF5ZXItPmRpc3BfZm10KTsKKworCS8qCisJICogU2V0IHNsYXZlX2lkIGZvciBlYWNoIERNQSBj
aGFubmVsIHRvIGluZGljYXRlIHRoZXkncmUgcGFydCBvZiBhCisJICogdmlkZW8gZ3JvdXAuCisJ
ICovCisJZm9yIChpID0gMDsgaSA8IGluZm8tPm51bV9wbGFuZXM7IGkrKykgeworCQlzdHJ1Y3Qg
enlucW1wX2Rpc3BfbGF5ZXJfZG1hICpkbWEgPSAmbGF5ZXItPmRtYXNbaV07CisJCXN0cnVjdCBk
bWFfc2xhdmVfY29uZmlnIGNvbmZpZyA9IHsKKwkJCS5kaXJlY3Rpb24gPSBETUFfTUVNX1RPX0RF
ViwKKwkJCS5zbGF2ZV9pZCA9IDEsCisJCX07CisKKwkJZG1hZW5naW5lX3NsYXZlX2NvbmZpZyhk
bWEtPmNoYW4sICZjb25maWcpOworCX0KK30KKworLyoqCisgKiB6eW5xbXBfZGlzcF9sYXllcl91
cGRhdGUgLSBVcGRhdGUgdGhlIGxheWVyIGZyYW1lYnVmZmVyCisgKiBAbGF5ZXI6IFRoZSBsYXll
cgorICogQHN0YXRlOiBUaGUgcGxhbmUgc3RhdGUKKyAqCisgKiBVcGRhdGUgdGhlIGZyYW1lYnVm
ZmVyIGZvciB0aGUgbGF5ZXIgYnkgaXNzdWluZyBhIG5ldyBETUEgZW5naW5lIHRyYW5zYWN0aW9u
CisgKiBmb3IgdGhlIG5ldyBmcmFtZWJ1ZmZlci4KKyAqCisgKiBSZXR1cm46IDAgb24gc3VjY2Vz
cywgb3IgdGhlIERNQSBkZXNjcmlwdG9yIGZhaWx1cmUgZXJyb3Igb3RoZXJ3aXNlCisgKi8KK3N0
YXRpYyBpbnQgenlucW1wX2Rpc3BfbGF5ZXJfdXBkYXRlKHN0cnVjdCB6eW5xbXBfZGlzcF9sYXll
ciAqbGF5ZXIsCisJCQkJICAgIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnN0YXRlKQoreworCWNv
bnN0IHN0cnVjdCBkcm1fZm9ybWF0X2luZm8gKmluZm8gPSBsYXllci0+ZHJtX2ZtdDsKKwl1bnNp
Z25lZCBpbnQgaTsKKworCWZvciAoaSA9IDA7IGkgPCBsYXllci0+ZHJtX2ZtdC0+bnVtX3BsYW5l
czsgaSsrKSB7CisJCXVuc2lnbmVkIGludCB3aWR0aCA9IHN0YXRlLT5jcnRjX3cgLyAoaSA/IGlu
Zm8tPmhzdWIgOiAxKTsKKwkJdW5zaWduZWQgaW50IGhlaWdodCA9IHN0YXRlLT5jcnRjX2ggLyAo
aSA/IGluZm8tPnZzdWIgOiAxKTsKKwkJc3RydWN0IHp5bnFtcF9kaXNwX2xheWVyX2RtYSAqZG1h
ID0gJmxheWVyLT5kbWFzW2ldOworCQlzdHJ1Y3QgZG1hX2FzeW5jX3R4X2Rlc2NyaXB0b3IgKmRl
c2M7CisJCWRtYV9hZGRyX3QgcGFkZHI7CisKKwkJcGFkZHIgPSBkcm1fZmJfY21hX2dldF9nZW1f
YWRkcihzdGF0ZS0+ZmIsIHN0YXRlLCBpKTsKKworCQlkbWEtPnh0Lm51bWYgPSBoZWlnaHQ7CisJ
CWRtYS0+c2dsLnNpemUgPSB3aWR0aCAqIGluZm8tPmNwcFtpXTsKKwkJZG1hLT5zZ2wuaWNnID0g
c3RhdGUtPmZiLT5waXRjaGVzW2ldIC0gZG1hLT5zZ2wuc2l6ZTsKKwkJZG1hLT54dC5zcmNfc3Rh
cnQgPSBwYWRkcjsKKwkJZG1hLT54dC5mcmFtZV9zaXplID0gMTsKKwkJZG1hLT54dC5kaXIgPSBE
TUFfTUVNX1RPX0RFVjsKKwkJZG1hLT54dC5zcmNfc2dsID0gdHJ1ZTsKKwkJZG1hLT54dC5kc3Rf
c2dsID0gZmFsc2U7CisKKwkJZGVzYyA9IGRtYWVuZ2luZV9wcmVwX2ludGVybGVhdmVkX2RtYShk
bWEtPmNoYW4sICZkbWEtPnh0LAorCQkJCQkJICAgICAgRE1BX0NUUkxfQUNLIHwKKwkJCQkJCSAg
ICAgIERNQV9QUkVQX1JFUEVBVCB8CisJCQkJCQkgICAgICBETUFfUFJFUF9MT0FEX0VPVCk7CisJ
CWlmICghZGVzYykgeworCQkJZGV2X2VycihsYXllci0+ZGlzcC0+ZGV2LAorCQkJCSJmYWlsZWQg
dG8gcHJlcGFyZSBETUEgZGVzY3JpcHRvclxuIik7CisJCQlyZXR1cm4gLUVOT01FTTsKKwkJfQor
CisJCWRtYWVuZ2luZV9zdWJtaXQoZGVzYyk7CisJCWRtYV9hc3luY19pc3N1ZV9wZW5kaW5nKGRt
YS0+Y2hhbik7CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbmxpbmUgc3RydWN0IHp5
bnFtcF9kaXNwX2xheWVyICpwbGFuZV90b19sYXllcihzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSkK
K3sKKwlyZXR1cm4gY29udGFpbmVyX29mKHBsYW5lLCBzdHJ1Y3QgenlucW1wX2Rpc3BfbGF5ZXIs
IHBsYW5lKTsKK30KKworc3RhdGljIGludAorenlucW1wX2Rpc3BfcGxhbmVfYXRvbWljX2NoZWNr
KHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLAorCQkJICAgICAgIHN0cnVjdCBkcm1fcGxhbmVfc3Rh
dGUgKnN0YXRlKQoreworCXN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZTsKKworCWlm
ICghc3RhdGUtPmNydGMpCisJCXJldHVybiAwOworCisJY3J0Y19zdGF0ZSA9IGRybV9hdG9taWNf
Z2V0X2NydGNfc3RhdGUoc3RhdGUtPnN0YXRlLCBzdGF0ZS0+Y3J0Yyk7CisJaWYgKElTX0VSUihj
cnRjX3N0YXRlKSkKKwkJcmV0dXJuIFBUUl9FUlIoY3J0Y19zdGF0ZSk7CisKKwlyZXR1cm4gZHJt
X2F0b21pY19oZWxwZXJfY2hlY2tfcGxhbmVfc3RhdGUoc3RhdGUsIGNydGNfc3RhdGUsCisJCQkJ
CQkgICBEUk1fUExBTkVfSEVMUEVSX05PX1NDQUxJTkcsCisJCQkJCQkgICBEUk1fUExBTkVfSEVM
UEVSX05PX1NDQUxJTkcsCisJCQkJCQkgICBmYWxzZSwgZmFsc2UpOworfQorCitzdGF0aWMgdm9p
ZAorenlucW1wX2Rpc3BfcGxhbmVfYXRvbWljX2Rpc2FibGUoc3RydWN0IGRybV9wbGFuZSAqcGxh
bmUsCisJCQkJIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9sZF9zdGF0ZSkKK3sKKwlzdHJ1Y3Qg
enlucW1wX2Rpc3BfbGF5ZXIgKmxheWVyID0gcGxhbmVfdG9fbGF5ZXIocGxhbmUpOworCisJaWYg
KCFvbGRfc3RhdGUtPmZiKQorCQlyZXR1cm47CisKKwl6eW5xbXBfZGlzcF9sYXllcl9kaXNhYmxl
KGxheWVyKTsKK30KKworc3RhdGljIHZvaWQKK3p5bnFtcF9kaXNwX3BsYW5lX2F0b21pY191cGRh
dGUoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsCisJCQkJc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAq
b2xkX3N0YXRlKQoreworCXN0cnVjdCB6eW5xbXBfZGlzcF9sYXllciAqbGF5ZXIgPSBwbGFuZV90
b19sYXllcihwbGFuZSk7CisJYm9vbCBmb3JtYXRfY2hhbmdlZCA9IGZhbHNlOworCisJaWYgKCFv
bGRfc3RhdGUtPmZiIHx8CisJICAgIG9sZF9zdGF0ZS0+ZmItPmZvcm1hdC0+Zm9ybWF0ICE9IHBs
YW5lLT5zdGF0ZS0+ZmItPmZvcm1hdC0+Zm9ybWF0KQorCQlmb3JtYXRfY2hhbmdlZCA9IHRydWU7
CisKKwkvKgorCSAqIElmIHRoZSBmb3JtYXQgaGFzIGNoYW5nZWQgKGluY2x1ZGluZyBnb2luZyBm
cm9tIGEgcHJldmlvdXNseQorCSAqIGRpc2FibGVkIHN0YXRlIHRvIGFueSBmb3JtYXQpLCByZWNv
bmZpZ3VyZSB0aGUgZm9ybWF0LiBEaXNhYmxlIHRoZQorCSAqIHBsYW5lIGZpcnN0IGlmIG5lZWRl
ZC4KKwkgKi8KKwlpZiAoZm9ybWF0X2NoYW5nZWQpIHsKKwkJaWYgKG9sZF9zdGF0ZS0+ZmIpCisJ
CQl6eW5xbXBfZGlzcF9sYXllcl9kaXNhYmxlKGxheWVyKTsKKworCQl6eW5xbXBfZGlzcF9sYXll
cl9zZXRfZm9ybWF0KGxheWVyLCBwbGFuZS0+c3RhdGUpOworCX0KKworCXp5bnFtcF9kaXNwX2xh
eWVyX3VwZGF0ZShsYXllciwgcGxhbmUtPnN0YXRlKTsKKworCS8qIEVuYWJsZSBvciByZS1lbmFi
bGUgdGhlIHBsYW5lIGlzIHRoZSBmb3JtYXQgaGFzIGNoYW5nZWQuICovCisJaWYgKGZvcm1hdF9j
aGFuZ2VkKQorCQl6eW5xbXBfZGlzcF9sYXllcl9lbmFibGUobGF5ZXIpOworfQorCitzdGF0aWMg
Y29uc3Qgc3RydWN0IGRybV9wbGFuZV9oZWxwZXJfZnVuY3MgenlucW1wX2Rpc3BfcGxhbmVfaGVs
cGVyX2Z1bmNzID0geworCS5hdG9taWNfY2hlY2sJCT0genlucW1wX2Rpc3BfcGxhbmVfYXRvbWlj
X2NoZWNrLAorCS5hdG9taWNfdXBkYXRlCQk9IHp5bnFtcF9kaXNwX3BsYW5lX2F0b21pY191cGRh
dGUsCisJLmF0b21pY19kaXNhYmxlCQk9IHp5bnFtcF9kaXNwX3BsYW5lX2F0b21pY19kaXNhYmxl
LAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfZnVuY3MgenlucW1wX2Rpc3Bf
cGxhbmVfZnVuY3MgPSB7CisJLnVwZGF0ZV9wbGFuZQkJPSBkcm1fYXRvbWljX2hlbHBlcl91cGRh
dGVfcGxhbmUsCisJLmRpc2FibGVfcGxhbmUJCT0gZHJtX2F0b21pY19oZWxwZXJfZGlzYWJsZV9w
bGFuZSwKKwkuZGVzdHJveQkJPSBkcm1fcGxhbmVfY2xlYW51cCwKKwkucmVzZXQJCQk9IGRybV9h
dG9taWNfaGVscGVyX3BsYW5lX3Jlc2V0LAorCS5hdG9taWNfZHVwbGljYXRlX3N0YXRlCT0gZHJt
X2F0b21pY19oZWxwZXJfcGxhbmVfZHVwbGljYXRlX3N0YXRlLAorCS5hdG9taWNfZGVzdHJveV9z
dGF0ZQk9IGRybV9hdG9taWNfaGVscGVyX3BsYW5lX2Rlc3Ryb3lfc3RhdGUsCit9OworCitzdGF0
aWMgaW50IHp5bnFtcF9kaXNwX2NyZWF0ZV9wbGFuZXMoc3RydWN0IHp5bnFtcF9kaXNwICpkaXNw
KQoreworCXVuc2lnbmVkIGludCBpLCBqOworCWludCByZXQ7CisKKwlmb3IgKGkgPSAwOyBpIDwg
WllOUU1QX0RJU1BfTlVNX0xBWUVSUzsgaSsrKSB7CisJCXN0cnVjdCB6eW5xbXBfZGlzcF9sYXll
ciAqbGF5ZXIgPSAmZGlzcC0+bGF5ZXJzW2ldOworCQllbnVtIGRybV9wbGFuZV90eXBlIHR5cGU7
CisJCXUzMiAqZHJtX2Zvcm1hdHM7CisKKwkJZHJtX2Zvcm1hdHMgPSBkcm1tX2tjYWxsb2MoZGlz
cC0+ZHJtLCBzaXplb2YoKmRybV9mb3JtYXRzKSwKKwkJCQkJICAgbGF5ZXItPmluZm8tPm51bV9m
b3JtYXRzLAorCQkJCQkgICBHRlBfS0VSTkVMKTsKKwkJaWYgKCFkcm1fZm9ybWF0cykKKwkJCXJl
dHVybiAtRU5PTUVNOworCisJCWZvciAoaiA9IDA7IGogPCBsYXllci0+aW5mby0+bnVtX2Zvcm1h
dHM7ICsraikKKwkJCWRybV9mb3JtYXRzW2pdID0gbGF5ZXItPmluZm8tPmZvcm1hdHNbal0uZHJt
X2ZtdDsKKworCQkvKiBHcmFwaGljcyBsYXllciBpcyBwcmltYXJ5LCBhbmQgdmlkZW8gbGF5ZXIg
aXMgb3ZlcmxheS4gKi8KKwkJdHlwZSA9IGkgPT0gWllOUU1QX0RJU1BfTEFZRVJfR0ZYCisJCSAg
ICAgPyBEUk1fUExBTkVfVFlQRV9QUklNQVJZIDogRFJNX1BMQU5FX1RZUEVfT1ZFUkxBWTsKKwkJ
cmV0ID0gZHJtX3VuaXZlcnNhbF9wbGFuZV9pbml0KGRpc3AtPmRybSwgJmxheWVyLT5wbGFuZSwg
MCwKKwkJCQkJICAgICAgICZ6eW5xbXBfZGlzcF9wbGFuZV9mdW5jcywKKwkJCQkJICAgICAgIGRy
bV9mb3JtYXRzLAorCQkJCQkgICAgICAgbGF5ZXItPmluZm8tPm51bV9mb3JtYXRzLAorCQkJCQkg
ICAgICAgTlVMTCwgdHlwZSwgTlVMTCk7CisJCWlmIChyZXQpCisJCQlyZXR1cm4gcmV0OworCisJ
CWRybV9wbGFuZV9oZWxwZXJfYWRkKCZsYXllci0+cGxhbmUsCisJCQkJICAgICAmenlucW1wX2Rp
c3BfcGxhbmVfaGVscGVyX2Z1bmNzKTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworLyoqCisgKiB6
eW5xbXBfZGlzcF9sYXllcl9yZWxlYXNlX2RtYSAtIFJlbGVhc2UgRE1BIGNoYW5uZWxzIGZvciBh
IGxheWVyCisgKiBAZGlzcDogRGlzcGxheSBjb250cm9sbGVyCisgKiBAbGF5ZXI6IFRoZSBsYXll
cgorICoKKyAqIFJlbGVhc2UgdGhlIERNQSBjaGFubmVscyBhc3NvY2lhdGVkIHdpdGggQGxheWVy
LgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9sYXllcl9yZWxlYXNlX2RtYShzdHJ1Y3Qg
enlucW1wX2Rpc3AgKmRpc3AsCisJCQkJCSAgc3RydWN0IHp5bnFtcF9kaXNwX2xheWVyICpsYXll
cikKK3sKKwl1bnNpZ25lZCBpbnQgaTsKKworCWlmICghbGF5ZXItPmluZm8pCisJCXJldHVybjsK
KworCWZvciAoaSA9IDA7IGkgPCBsYXllci0+aW5mby0+bnVtX2NoYW5uZWxzOyBpKyspIHsKKwkJ
c3RydWN0IHp5bnFtcF9kaXNwX2xheWVyX2RtYSAqZG1hID0gJmxheWVyLT5kbWFzW2ldOworCisJ
CWlmICghZG1hLT5jaGFuKQorCQkJY29udGludWU7CisKKwkJLyogTWFrZSBzdXJlIHRoZSBjaGFu
bmVsIGlzIHRlcm1pbmF0ZWQgYmVmb3JlIHJlbGVhc2UuICovCisJCWRtYWVuZ2luZV90ZXJtaW5h
dGVfc3luYyhkbWEtPmNoYW4pOworCQlkbWFfcmVsZWFzZV9jaGFubmVsKGRtYS0+Y2hhbik7CisJ
fQorfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2Rlc3Ryb3lfbGF5ZXJzIC0gRGVzdHJveSBhbGwg
bGF5ZXJzCisgKiBAZGlzcDogRGlzcGxheSBjb250cm9sbGVyCisgKi8KK3N0YXRpYyB2b2lkIHp5
bnFtcF9kaXNwX2Rlc3Ryb3lfbGF5ZXJzKHN0cnVjdCB6eW5xbXBfZGlzcCAqZGlzcCkKK3sKKwl1
bnNpZ25lZCBpbnQgaTsKKworCWZvciAoaSA9IDA7IGkgPCBaWU5RTVBfRElTUF9OVU1fTEFZRVJT
OyBpKyspCisJCXp5bnFtcF9kaXNwX2xheWVyX3JlbGVhc2VfZG1hKGRpc3AsICZkaXNwLT5sYXll
cnNbaV0pOworfQorCisvKioKKyAqIHp5bnFtcF9kaXNwX2xheWVyX3JlcXVlc3RfZG1hIC0gUmVx
dWVzdCBETUEgY2hhbm5lbHMgZm9yIGEgbGF5ZXIKKyAqIEBkaXNwOiBEaXNwbGF5IGNvbnRyb2xs
ZXIKKyAqIEBsYXllcjogVGhlIGxheWVyCisgKgorICogUmVxdWVzdCBhbGwgRE1BIGVuZ2luZSBj
aGFubmVscyBuZWVkZWQgYnkgQGxheWVyLgorICoKKyAqIFJldHVybjogMCBvbiBzdWNjZXNzLCBv
ciB0aGUgRE1BIGNoYW5uZWwgcmVxdWVzdCBlcnJvciBvdGhlcndpc2UKKyAqLworc3RhdGljIGlu
dCB6eW5xbXBfZGlzcF9sYXllcl9yZXF1ZXN0X2RtYShzdHJ1Y3QgenlucW1wX2Rpc3AgKmRpc3As
CisJCQkJCSBzdHJ1Y3QgenlucW1wX2Rpc3BfbGF5ZXIgKmxheWVyKQoreworCXN0YXRpYyBjb25z
dCBjaGFyICogY29uc3QgZG1hX25hbWVzW10gPSB7ICJ2aWQiLCAiZ2Z4IiB9OworCXVuc2lnbmVk
IGludCBpOworCWludCByZXQ7CisKKwlmb3IgKGkgPSAwOyBpIDwgbGF5ZXItPmluZm8tPm51bV9j
aGFubmVsczsgaSsrKSB7CisJCXN0cnVjdCB6eW5xbXBfZGlzcF9sYXllcl9kbWEgKmRtYSA9ICZs
YXllci0+ZG1hc1tpXTsKKwkJY2hhciBkbWFfY2hhbm5lbF9uYW1lWzE2XTsKKworCQlzbnByaW50
ZihkbWFfY2hhbm5lbF9uYW1lLCBzaXplb2YoZG1hX2NoYW5uZWxfbmFtZSksCisJCQkgIiVzJXUi
LCBkbWFfbmFtZXNbbGF5ZXItPmlkXSwgaSk7CisJCWRtYS0+Y2hhbiA9IG9mX2RtYV9yZXF1ZXN0
X3NsYXZlX2NoYW5uZWwoZGlzcC0+ZGV2LT5vZl9ub2RlLAorCQkJCQkJCSBkbWFfY2hhbm5lbF9u
YW1lKTsKKwkJaWYgKElTX0VSUihkbWEtPmNoYW4pKSB7CisJCQlkZXZfZXJyKGRpc3AtPmRldiwg
ImZhaWxlZCB0byByZXF1ZXN0IGRtYSBjaGFubmVsXG4iKTsKKwkJCXJldCA9IFBUUl9FUlIoZG1h
LT5jaGFuKTsKKwkJCWRtYS0+Y2hhbiA9IE5VTEw7CisJCQlyZXR1cm4gcmV0OworCQl9CisJfQor
CisJcmV0dXJuIDA7Cit9CisKKy8qKgorICogenlucW1wX2Rpc3BfY3JlYXRlX2xheWVycyAtIENy
ZWF0ZSBhbmQgaW5pdGlhbGl6ZSBhbGwgbGF5ZXJzCisgKiBAZGlzcDogRGlzcGxheSBjb250cm9s
bGVyCisgKgorICogUmV0dXJuOiAwIG9uIHN1Y2Nlc3MsIG9yIHRoZSBETUEgY2hhbm5lbCByZXF1
ZXN0IGVycm9yIG90aGVyd2lzZQorICovCitzdGF0aWMgaW50IHp5bnFtcF9kaXNwX2NyZWF0ZV9s
YXllcnMoc3RydWN0IHp5bnFtcF9kaXNwICpkaXNwKQoreworCXN0YXRpYyBjb25zdCBzdHJ1Y3Qg
enlucW1wX2Rpc3BfbGF5ZXJfaW5mbyBsYXllcl9pbmZvW10gPSB7CisJCVtaWU5RTVBfRElTUF9M
QVlFUl9WSURdID0geworCQkJLmZvcm1hdHMgPSBhdmJ1Zl92aWRfZm10cywKKwkJCS5udW1fZm9y
bWF0cyA9IEFSUkFZX1NJWkUoYXZidWZfdmlkX2ZtdHMpLAorCQkJLm51bV9jaGFubmVscyA9IDMs
CisJCX0sCisJCVtaWU5RTVBfRElTUF9MQVlFUl9HRlhdID0geworCQkJLmZvcm1hdHMgPSBhdmJ1
Zl9nZnhfZm10cywKKwkJCS5udW1fZm9ybWF0cyA9IEFSUkFZX1NJWkUoYXZidWZfZ2Z4X2ZtdHMp
LAorCQkJLm51bV9jaGFubmVscyA9IDEsCisJCX0sCisJfTsKKworCXVuc2lnbmVkIGludCBpOwor
CWludCByZXQ7CisKKwlmb3IgKGkgPSAwOyBpIDwgWllOUU1QX0RJU1BfTlVNX0xBWUVSUzsgaSsr
KSB7CisJCXN0cnVjdCB6eW5xbXBfZGlzcF9sYXllciAqbGF5ZXIgPSAmZGlzcC0+bGF5ZXJzW2ld
OworCisJCWxheWVyLT5pZCA9IGk7CisJCWxheWVyLT5kaXNwID0gZGlzcDsKKwkJbGF5ZXItPmlu
Zm8gPSAmbGF5ZXJfaW5mb1tpXTsKKworCQlyZXQgPSB6eW5xbXBfZGlzcF9sYXllcl9yZXF1ZXN0
X2RtYShkaXNwLCBsYXllcik7CisJCWlmIChyZXQpCisJCQlnb3RvIGVycjsKKwl9CisKKwlyZXR1
cm4gMDsKKworZXJyOgorCXp5bnFtcF9kaXNwX2Rlc3Ryb3lfbGF5ZXJzKGRpc3ApOworCXJldHVy
biByZXQ7Cit9CisKKy8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisgKiBaeW5xTVAgRGlzcGxheSAm
IERSTSBDUlRDCisgKi8KKworLyoqCisgKiB6eW5xbXBfZGlzcF9lbmFibGUgLSBFbmFibGUgdGhl
IGRpc3BsYXkgY29udHJvbGxlcgorICogQGRpc3A6IERpc3BsYXkgY29udHJvbGxlcgorICovCitz
dGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9lbmFibGUoc3RydWN0IHp5bnFtcF9kaXNwICpkaXNwKQor
eworCXp5bnFtcF9kaXNwX2F2YnVmX2VuYWJsZSgmZGlzcC0+YXZidWYpOworCS8qIENob29zZSBj
bG9jayBzb3VyY2UgYmFzZWQgb24gdGhlIERUIGNsb2NrIGhhbmRsZS4gKi8KKwl6eW5xbXBfZGlz
cF9hdmJ1Zl9zZXRfY2xvY2tzX3NvdXJjZXMoJmRpc3AtPmF2YnVmLCBkaXNwLT5wY2xrX2Zyb21f
cHMsCisJCQkJCSAgICAgZGlzcC0+YXVkaW8uY2xrX2Zyb21fcHMsIHRydWUpOworCXp5bnFtcF9k
aXNwX2F2YnVmX2VuYWJsZV9jaGFubmVscygmZGlzcC0+YXZidWYpOworCXp5bnFtcF9kaXNwX2F2
YnVmX2VuYWJsZV9hdWRpbygmZGlzcC0+YXZidWYpOworCisJenlucW1wX2Rpc3BfYXVkaW9fZW5h
YmxlKCZkaXNwLT5hdWRpbyk7Cit9CisKKy8qKgorICogenlucW1wX2Rpc3BfZGlzYWJsZSAtIERp
c2FibGUgdGhlIGRpc3BsYXkgY29udHJvbGxlcgorICogQGRpc3A6IERpc3BsYXkgY29udHJvbGxl
cgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9kaXNhYmxlKHN0cnVjdCB6eW5xbXBfZGlz
cCAqZGlzcCkKK3sKKwlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSAmZGlzcC0+Y3J0YzsKKworCXp5
bnFtcF9kaXNwX2F1ZGlvX2Rpc2FibGUoJmRpc3AtPmF1ZGlvKTsKKworCXp5bnFtcF9kaXNwX2F2
YnVmX2Rpc2FibGVfYXVkaW8oJmRpc3AtPmF2YnVmKTsKKwl6eW5xbXBfZGlzcF9hdmJ1Zl9kaXNh
YmxlX2NoYW5uZWxzKCZkaXNwLT5hdmJ1Zik7CisJenlucW1wX2Rpc3BfYXZidWZfZGlzYWJsZSgm
ZGlzcC0+YXZidWYpOworCisJLyogTWFyayB0aGUgZmxpcCBpcyBkb25lIGFzIGNydGMgaXMgZGlz
YWJsZWQgYW55d2F5ICovCisJaWYgKGNydGMtPnN0YXRlLT5ldmVudCkgeworCQljb21wbGV0ZV9h
bGwoY3J0Yy0+c3RhdGUtPmV2ZW50LT5iYXNlLmNvbXBsZXRpb24pOworCQljcnRjLT5zdGF0ZS0+
ZXZlbnQgPSBOVUxMOworCX0KK30KKworc3RhdGljIGlubGluZSBzdHJ1Y3QgenlucW1wX2Rpc3Ag
KmNydGNfdG9fZGlzcChzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCit7CisJcmV0dXJuIGNvbnRhaW5l
cl9vZihjcnRjLCBzdHJ1Y3QgenlucW1wX2Rpc3AsIGNydGMpOworfQorCitzdGF0aWMgaW50IHp5
bnFtcF9kaXNwX2NydGNfc2V0dXBfY2xvY2soc3RydWN0IGRybV9jcnRjICpjcnRjLAorCQkJCQlz
dHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSkKK3sKKwlzdHJ1Y3QgenlucW1w
X2Rpc3AgKmRpc3AgPSBjcnRjX3RvX2Rpc3AoY3J0Yyk7CisJdW5zaWduZWQgbG9uZyBtb2RlX2Ns
b2NrID0gYWRqdXN0ZWRfbW9kZS0+Y2xvY2sgKiAxMDAwOworCXVuc2lnbmVkIGxvbmcgcmF0ZTsK
Kwlsb25nIGRpZmY7CisJaW50IHJldDsKKworCXJldCA9IGNsa19zZXRfcmF0ZShkaXNwLT5wY2xr
LCBtb2RlX2Nsb2NrKTsKKwlpZiAocmV0KSB7CisJCWRldl9lcnIoZGlzcC0+ZGV2LCAiZmFpbGVk
IHRvIHNldCBhIHBpeGVsIGNsb2NrXG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyYXRlID0g
Y2xrX2dldF9yYXRlKGRpc3AtPnBjbGspOworCWRpZmYgPSByYXRlIC0gbW9kZV9jbG9jazsKKwlp
ZiAoYWJzKGRpZmYpID4gbW9kZV9jbG9jayAvIDIwKQorCQlkZXZfaW5mbyhkaXNwLT5kZXYsCisJ
CQkgInJlcXVlc3RlZCBwaXhlbCByYXRlOiAlbHUgYWN0dWFsIHJhdGU6ICVsdVxuIiwKKwkJCSBt
b2RlX2Nsb2NrLCByYXRlKTsKKwllbHNlCisJCWRldl9kYmcoZGlzcC0+ZGV2LAorCQkJInJlcXVl
c3RlZCBwaXhlbCByYXRlOiAlbHUgYWN0dWFsIHJhdGU6ICVsdVxuIiwKKwkJCW1vZGVfY2xvY2ss
IHJhdGUpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkCit6eW5xbXBfZGlzcF9jcnRj
X2F0b21pY19lbmFibGUoc3RydWN0IGRybV9jcnRjICpjcnRjLAorCQkJICAgICAgIHN0cnVjdCBk
cm1fY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUpCit7CisJc3RydWN0IHp5bnFtcF9kaXNwICpk
aXNwID0gY3J0Y190b19kaXNwKGNydGMpOworCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1
c3RlZF9tb2RlID0gJmNydGMtPnN0YXRlLT5hZGp1c3RlZF9tb2RlOworCWludCByZXQsIHZyZWZy
ZXNoOworCisJenlucW1wX2Rpc3BfY3J0Y19zZXR1cF9jbG9jayhjcnRjLCBhZGp1c3RlZF9tb2Rl
KTsKKworCXBtX3J1bnRpbWVfZ2V0X3N5bmMoZGlzcC0+ZGV2KTsKKwlyZXQgPSBjbGtfcHJlcGFy
ZV9lbmFibGUoZGlzcC0+cGNsayk7CisJaWYgKHJldCkgeworCQlkZXZfZXJyKGRpc3AtPmRldiwg
ImZhaWxlZCB0byBlbmFibGUgYSBwaXhlbCBjbG9ja1xuIik7CisJCXBtX3J1bnRpbWVfcHV0X3N5
bmMoZGlzcC0+ZGV2KTsKKwkJcmV0dXJuOworCX0KKworCXp5bnFtcF9kaXNwX2JsZW5kX3NldF9v
dXRwdXRfZm9ybWF0KCZkaXNwLT5ibGVuZCwKKwkJCQkJICAgIFpZTlFNUF9EUFNVQl9GT1JNQVRf
UkdCKTsKKwl6eW5xbXBfZGlzcF9ibGVuZF9zZXRfYmdfY29sb3IoJmRpc3AtPmJsZW5kLCAwLCAw
LCAwKTsKKwl6eW5xbXBfZGlzcF9ibGVuZF9zZXRfZ2xvYmFsX2FscGhhKCZkaXNwLT5ibGVuZCwg
ZmFsc2UsIDApOworCisJenlucW1wX2Rpc3BfZW5hYmxlKGRpc3ApOworCisJLyogRGVsYXkgb2Yg
MyB2YmxhbmsgaW50ZXJ2YWxzIGZvciB0aW1pbmcgZ2VuIHRvIGJlIHN0YWJsZSAqLworCXZyZWZy
ZXNoID0gKGFkanVzdGVkX21vZGUtPmNsb2NrICogMTAwMCkgLworCQkgICAoYWRqdXN0ZWRfbW9k
ZS0+dnRvdGFsICogYWRqdXN0ZWRfbW9kZS0+aHRvdGFsKTsKKwltc2xlZXAoMyAqIDEwMDAgLyB2
cmVmcmVzaCk7Cit9CisKK3N0YXRpYyB2b2lkCit6eW5xbXBfZGlzcF9jcnRjX2F0b21pY19kaXNh
YmxlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKKwkJCQlzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKm9s
ZF9jcnRjX3N0YXRlKQoreworCXN0cnVjdCB6eW5xbXBfZGlzcCAqZGlzcCA9IGNydGNfdG9fZGlz
cChjcnRjKTsKKwlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpvbGRfcGxhbmVfc3RhdGU7CisKKwkv
KgorCSAqIERpc2FibGUgdGhlIHBsYW5lIGlmIGFjdGl2ZS4gVGhlIG9sZCBwbGFuZSBzdGF0ZSBj
YW4gYmUgTlVMTCBpbiB0aGUKKwkgKiAuc2h1dGRvd24oKSBwYXRoIGlmIHRoZSBwbGFuZSBpcyBh
bHJlYWR5IGRpc2FibGVkLCBza2lwCisJICogenlucW1wX2Rpc3BfcGxhbmVfYXRvbWljX2Rpc2Fi
bGUoKSBpbiB0aGF0IGNhc2UuCisJICovCisJb2xkX3BsYW5lX3N0YXRlID0gZHJtX2F0b21pY19n
ZXRfb2xkX3BsYW5lX3N0YXRlKG9sZF9jcnRjX3N0YXRlLT5zdGF0ZSwKKwkJCQkJCQkgY3J0Yy0+
cHJpbWFyeSk7CisJaWYgKG9sZF9wbGFuZV9zdGF0ZSkKKwkJenlucW1wX2Rpc3BfcGxhbmVfYXRv
bWljX2Rpc2FibGUoY3J0Yy0+cHJpbWFyeSwgb2xkX3BsYW5lX3N0YXRlKTsKKworCXp5bnFtcF9k
aXNwX2Rpc2FibGUoZGlzcCk7CisKKwlkcm1fY3J0Y192Ymxhbmtfb2ZmKCZkaXNwLT5jcnRjKTsK
KworCWNsa19kaXNhYmxlX3VucHJlcGFyZShkaXNwLT5wY2xrKTsKKwlwbV9ydW50aW1lX3B1dF9z
eW5jKGRpc3AtPmRldik7Cit9CisKK3N0YXRpYyBpbnQgenlucW1wX2Rpc3BfY3J0Y19hdG9taWNf
Y2hlY2soc3RydWN0IGRybV9jcnRjICpjcnRjLAorCQkJCQkgc3RydWN0IGRybV9jcnRjX3N0YXRl
ICpzdGF0ZSkKK3sKKwlyZXR1cm4gZHJtX2F0b21pY19hZGRfYWZmZWN0ZWRfcGxhbmVzKHN0YXRl
LT5zdGF0ZSwgY3J0Yyk7Cit9CisKK3N0YXRpYyB2b2lkCit6eW5xbXBfZGlzcF9jcnRjX2F0b21p
Y19iZWdpbihzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCisJCQkgICAgICBzdHJ1Y3QgZHJtX2NydGNf
c3RhdGUgKm9sZF9jcnRjX3N0YXRlKQoreworCWRybV9jcnRjX3ZibGFua19vbihjcnRjKTsKK30K
Kworc3RhdGljIHZvaWQKK3p5bnFtcF9kaXNwX2NydGNfYXRvbWljX2ZsdXNoKHN0cnVjdCBkcm1f
Y3J0YyAqY3J0YywKKwkJCSAgICAgIHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3Rh
dGUpCit7CisJaWYgKGNydGMtPnN0YXRlLT5ldmVudCkgeworCQlzdHJ1Y3QgZHJtX3BlbmRpbmdf
dmJsYW5rX2V2ZW50ICpldmVudDsKKworCQkvKiBDb25zdW1lIHRoZSBmbGlwX2RvbmUgZXZlbnQg
ZnJvbSBhdG9taWMgaGVscGVyLiAqLworCQlldmVudCA9IGNydGMtPnN0YXRlLT5ldmVudDsKKwkJ
Y3J0Yy0+c3RhdGUtPmV2ZW50ID0gTlVMTDsKKworCQlldmVudC0+cGlwZSA9IGRybV9jcnRjX2lu
ZGV4KGNydGMpOworCisJCVdBUk5fT04oZHJtX2NydGNfdmJsYW5rX2dldChjcnRjKSAhPSAwKTsK
KworCQlzcGluX2xvY2tfaXJxKCZjcnRjLT5kZXYtPmV2ZW50X2xvY2spOworCQlkcm1fY3J0Y19h
cm1fdmJsYW5rX2V2ZW50KGNydGMsIGV2ZW50KTsKKwkJc3Bpbl91bmxvY2tfaXJxKCZjcnRjLT5k
ZXYtPmV2ZW50X2xvY2spOworCX0KK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY3J0Y19o
ZWxwZXJfZnVuY3MgenlucW1wX2Rpc3BfY3J0Y19oZWxwZXJfZnVuY3MgPSB7CisJLmF0b21pY19l
bmFibGUJPSB6eW5xbXBfZGlzcF9jcnRjX2F0b21pY19lbmFibGUsCisJLmF0b21pY19kaXNhYmxl
CT0genlucW1wX2Rpc3BfY3J0Y19hdG9taWNfZGlzYWJsZSwKKwkuYXRvbWljX2NoZWNrCT0genlu
cW1wX2Rpc3BfY3J0Y19hdG9taWNfY2hlY2ssCisJLmF0b21pY19iZWdpbgk9IHp5bnFtcF9kaXNw
X2NydGNfYXRvbWljX2JlZ2luLAorCS5hdG9taWNfZmx1c2gJPSB6eW5xbXBfZGlzcF9jcnRjX2F0
b21pY19mbHVzaCwKK307CisKK3N0YXRpYyBpbnQgenlucW1wX2Rpc3BfY3J0Y19lbmFibGVfdmJs
YW5rKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykKK3sKKwlzdHJ1Y3QgenlucW1wX2Rpc3AgKmRpc3Ag
PSBjcnRjX3RvX2Rpc3AoY3J0Yyk7CisKKwl6eW5xbXBfZHBfZW5hYmxlX3ZibGFuayhkaXNwLT5k
cHN1Yi0+ZHApOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIHp5bnFtcF9kaXNwX2Ny
dGNfZGlzYWJsZV92Ymxhbmsoc3RydWN0IGRybV9jcnRjICpjcnRjKQoreworCXN0cnVjdCB6eW5x
bXBfZGlzcCAqZGlzcCA9IGNydGNfdG9fZGlzcChjcnRjKTsKKworCXp5bnFtcF9kcF9kaXNhYmxl
X3ZibGFuayhkaXNwLT5kcHN1Yi0+ZHApOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9j
cnRjX2Z1bmNzIHp5bnFtcF9kaXNwX2NydGNfZnVuY3MgPSB7CisJLmRlc3Ryb3kJCT0gZHJtX2Ny
dGNfY2xlYW51cCwKKwkuc2V0X2NvbmZpZwkJPSBkcm1fYXRvbWljX2hlbHBlcl9zZXRfY29uZmln
LAorCS5wYWdlX2ZsaXAJCT0gZHJtX2F0b21pY19oZWxwZXJfcGFnZV9mbGlwLAorCS5yZXNldAkJ
CT0gZHJtX2F0b21pY19oZWxwZXJfY3J0Y19yZXNldCwKKwkuYXRvbWljX2R1cGxpY2F0ZV9zdGF0
ZQk9IGRybV9hdG9taWNfaGVscGVyX2NydGNfZHVwbGljYXRlX3N0YXRlLAorCS5hdG9taWNfZGVz
dHJveV9zdGF0ZQk9IGRybV9hdG9taWNfaGVscGVyX2NydGNfZGVzdHJveV9zdGF0ZSwKKwkuZW5h
YmxlX3ZibGFuawkJPSB6eW5xbXBfZGlzcF9jcnRjX2VuYWJsZV92YmxhbmssCisJLmRpc2FibGVf
dmJsYW5rCQk9IHp5bnFtcF9kaXNwX2NydGNfZGlzYWJsZV92YmxhbmssCit9OworCitzdGF0aWMg
aW50IHp5bnFtcF9kaXNwX2NyZWF0ZV9jcnRjKHN0cnVjdCB6eW5xbXBfZGlzcCAqZGlzcCkKK3sK
KwlzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSA9ICZkaXNwLT5sYXllcnNbWllOUU1QX0RJU1BfTEFZ
RVJfR0ZYXS5wbGFuZTsKKwlpbnQgcmV0OworCisJcmV0ID0gZHJtX2NydGNfaW5pdF93aXRoX3Bs
YW5lcyhkaXNwLT5kcm0sICZkaXNwLT5jcnRjLCBwbGFuZSwKKwkJCQkJTlVMTCwgJnp5bnFtcF9k
aXNwX2NydGNfZnVuY3MsIE5VTEwpOworCWlmIChyZXQgPCAwKQorCQlyZXR1cm4gcmV0OworCisJ
ZHJtX2NydGNfaGVscGVyX2FkZCgmZGlzcC0+Y3J0YywgJnp5bnFtcF9kaXNwX2NydGNfaGVscGVy
X2Z1bmNzKTsKKworCS8qIFN0YXJ0IHdpdGggdmVydGljYWwgYmxhbmtpbmcgaW50ZXJydXB0IHJl
cG9ydGluZyBkaXNhYmxlZC4gKi8KKwlkcm1fY3J0Y192Ymxhbmtfb2ZmKCZkaXNwLT5jcnRjKTsK
KworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCB6eW5xbXBfZGlzcF9tYXBfY3J0Y190b19w
bGFuZShzdHJ1Y3QgenlucW1wX2Rpc3AgKmRpc3ApCit7CisJdTMyIHBvc3NpYmxlX2NydGNzID0g
ZHJtX2NydGNfbWFzaygmZGlzcC0+Y3J0Yyk7CisJdW5zaWduZWQgaW50IGk7CisKKwlmb3IgKGkg
PSAwOyBpIDwgWllOUU1QX0RJU1BfTlVNX0xBWUVSUzsgaSsrKQorCQlkaXNwLT5sYXllcnNbaV0u
cGxhbmUucG9zc2libGVfY3J0Y3MgPSBwb3NzaWJsZV9jcnRjczsKK30KKworLyogLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0KKyAqIEluaXRpYWxpemF0aW9uICYgQ2xlYW51cAorICovCisKK2ludCB6eW5x
bXBfZGlzcF9kcm1faW5pdChzdHJ1Y3QgenlucW1wX2Rwc3ViICpkcHN1YikKK3sKKwlzdHJ1Y3Qg
enlucW1wX2Rpc3AgKmRpc3AgPSBkcHN1Yi0+ZGlzcDsKKwlpbnQgcmV0OworCisJcmV0ID0genlu
cW1wX2Rpc3BfY3JlYXRlX3BsYW5lcyhkaXNwKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0Owor
CisJcmV0ID0genlucW1wX2Rpc3BfY3JlYXRlX2NydGMoZGlzcCk7CisJaWYgKHJldCA8IDApCisJ
CXJldHVybiByZXQ7CisKKwl6eW5xbXBfZGlzcF9tYXBfY3J0Y190b19wbGFuZShkaXNwKTsKKwor
CXJldHVybiAwOworfQorCitpbnQgenlucW1wX2Rpc3BfcHJvYmUoc3RydWN0IHp5bnFtcF9kcHN1
YiAqZHBzdWIsIHN0cnVjdCBkcm1fZGV2aWNlICpkcm0pCit7CisJc3RydWN0IHBsYXRmb3JtX2Rl
dmljZSAqcGRldiA9IHRvX3BsYXRmb3JtX2RldmljZShkcHN1Yi0+ZGV2KTsKKwlzdHJ1Y3Qgenlu
cW1wX2Rpc3AgKmRpc3A7CisJc3RydWN0IHp5bnFtcF9kaXNwX2xheWVyICpsYXllcjsKKwlzdHJ1
Y3QgcmVzb3VyY2UgKnJlczsKKwlpbnQgcmV0OworCisJZGlzcCA9IGRybW1fa3phbGxvYyhkcm0s
IHNpemVvZigqZGlzcCksIEdGUF9LRVJORUwpOworCWlmICghZGlzcCkKKwkJcmV0dXJuIC1FTk9N
RU07CisKKwlkaXNwLT5kZXYgPSAmcGRldi0+ZGV2OworCWRpc3AtPmRwc3ViID0gZHBzdWI7CisJ
ZGlzcC0+ZHJtID0gZHJtOworCisJZHBzdWItPmRpc3AgPSBkaXNwOworCisJcmVzID0gcGxhdGZv
cm1fZ2V0X3Jlc291cmNlX2J5bmFtZShwZGV2LCBJT1JFU09VUkNFX01FTSwgImJsZW5kIik7CisJ
ZGlzcC0+YmxlbmQuYmFzZSA9IGRldm1faW9yZW1hcF9yZXNvdXJjZShkaXNwLT5kZXYsIHJlcyk7
CisJaWYgKElTX0VSUihkaXNwLT5ibGVuZC5iYXNlKSkKKwkJcmV0dXJuIFBUUl9FUlIoZGlzcC0+
YmxlbmQuYmFzZSk7CisKKwlyZXMgPSBwbGF0Zm9ybV9nZXRfcmVzb3VyY2VfYnluYW1lKHBkZXYs
IElPUkVTT1VSQ0VfTUVNLCAiYXZfYnVmIik7CisJZGlzcC0+YXZidWYuYmFzZSA9IGRldm1faW9y
ZW1hcF9yZXNvdXJjZShkaXNwLT5kZXYsIHJlcyk7CisJaWYgKElTX0VSUihkaXNwLT5hdmJ1Zi5i
YXNlKSkKKwkJcmV0dXJuIFBUUl9FUlIoZGlzcC0+YXZidWYuYmFzZSk7CisKKwlyZXMgPSBwbGF0
Zm9ybV9nZXRfcmVzb3VyY2VfYnluYW1lKHBkZXYsIElPUkVTT1VSQ0VfTUVNLCAiYXVkIik7CisJ
ZGlzcC0+YXVkaW8uYmFzZSA9IGRldm1faW9yZW1hcF9yZXNvdXJjZShkaXNwLT5kZXYsIHJlcyk7
CisJaWYgKElTX0VSUihkaXNwLT5hdWRpby5iYXNlKSkKKwkJcmV0dXJuIFBUUl9FUlIoZGlzcC0+
YXVkaW8uYmFzZSk7CisKKwkvKiBUcnkgdGhlIGxpdmUgUEwgdmlkZW8gY2xvY2sgKi8KKwlkaXNw
LT5wY2xrID0gZGV2bV9jbGtfZ2V0KGRpc3AtPmRldiwgImRwX2xpdmVfdmlkZW9faW5fY2xrIik7
CisJaWYgKCFJU19FUlIoZGlzcC0+cGNsaykpCisJCWRpc3AtPnBjbGtfZnJvbV9wcyA9IGZhbHNl
OworCWVsc2UgaWYgKFBUUl9FUlIoZGlzcC0+cGNsaykgPT0gLUVQUk9CRV9ERUZFUikKKwkJcmV0
dXJuIFBUUl9FUlIoZGlzcC0+cGNsayk7CisKKwkvKiBJZiB0aGUgbGl2ZSBQTCB2aWRlbyBjbG9j
ayBpcyBub3QgdmFsaWQsIGZhbGwgYmFjayB0byBQUyBjbG9jayAqLworCWlmIChJU19FUlJfT1Jf
TlVMTChkaXNwLT5wY2xrKSkgeworCQlkaXNwLT5wY2xrID0gZGV2bV9jbGtfZ2V0KGRpc3AtPmRl
diwgImRwX3Z0Y19waXhlbF9jbGtfaW4iKTsKKwkJaWYgKElTX0VSUihkaXNwLT5wY2xrKSkgewor
CQkJZGV2X2VycihkaXNwLT5kZXYsICJmYWlsZWQgdG8gaW5pdCBhbnkgdmlkZW8gY2xvY2tcbiIp
OworCQkJcmV0dXJuIFBUUl9FUlIoZGlzcC0+cGNsayk7CisJCX0KKwkJZGlzcC0+cGNsa19mcm9t
X3BzID0gdHJ1ZTsKKwl9CisKKwl6eW5xbXBfZGlzcF9hdWRpb19pbml0KGRpc3AtPmRldiwgJmRp
c3AtPmF1ZGlvKTsKKworCXJldCA9IHp5bnFtcF9kaXNwX2NyZWF0ZV9sYXllcnMoZGlzcCk7CisJ
aWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCWxheWVyID0gJmRpc3AtPmxheWVyc1taWU5RTVBf
RElTUF9MQVlFUl9WSURdOworCWRwc3ViLT5kbWFfYWxpZ24gPSAxIDw8IGxheWVyLT5kbWFzWzBd
LmNoYW4tPmRldmljZS0+Y29weV9hbGlnbjsKKworCXJldHVybiAwOworfQorCit2b2lkIHp5bnFt
cF9kaXNwX3JlbW92ZShzdHJ1Y3QgenlucW1wX2Rwc3ViICpkcHN1YikKK3sKKwlzdHJ1Y3Qgenlu
cW1wX2Rpc3AgKmRpc3AgPSBkcHN1Yi0+ZGlzcDsKKworCXp5bnFtcF9kaXNwX2Rlc3Ryb3lfbGF5
ZXJzKGRpc3ApOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rp
c3AuaCBiL2RyaXZlcnMvZ3B1L2RybS94bG54L3p5bnFtcF9kaXNwLmgKbmV3IGZpbGUgbW9kZSAx
MDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5mNDAyOTAxYWZiMjMKLS0tIC9kZXYvbnVsbAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZGlzcC5oCkBAIC0wLDAgKzEsNDIgQEAKKy8q
IFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovCisvKgorICogWnlucU1QIERpc3Bs
YXkgRHJpdmVyCisgKgorICogQ29weXJpZ2h0IChDKSAyMDE3IC0gMjAyMCBYaWxpbngsIEluYy4K
KyAqCisgKiBBdXRob3JzOgorICogLSBIeXVuIFdvbyBLd29uIDxoeXVuLmt3b25AeGlsaW54LmNv
bT4KKyAqIC0gTGF1cmVudCBQaW5jaGFydCA8bGF1cmVudC5waW5jaGFydEBpZGVhc29uYm9hcmQu
Y29tPgorICovCisKKyNpZm5kZWYgX1pZTlFNUF9ESVNQX0hfCisjZGVmaW5lIF9aWU5RTVBfRElT
UF9IXworCisjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KKworLyoKKyAqIDM4NDB4MjE2MCBpcyBh
ZHZlcnRpc2VkIGFzIHRoZSBtYXhpbXVtIHJlc29sdXRpb24sIGJ1dCBhbG1vc3QgYW55CisgKiBy
ZXNvbHV0aW9ucyB1bmRlciBhIDMwME1oeiBwaXhlbCByYXRlIHdvdWxkIHdvcmsuIFBpY2sgNDA5
Nng0MDk2LgorICovCisjZGVmaW5lIFpZTlFNUF9ESVNQX01BWF9XSURUSAkJCQk0MDk2CisjZGVm
aW5lIFpZTlFNUF9ESVNQX01BWF9IRUlHSFQJCQkJNDA5NgorCisvKiBUaGUgRFBETUEgaXMgbGlt
aXRlZCB0byA0NCBiaXQgYWRkcmVzc2luZy4gKi8KKyNkZWZpbmUgWllOUU1QX0RJU1BfTUFYX0RN
QV9CSVQJCQkJNDQKKworc3RydWN0IGRldmljZTsKK3N0cnVjdCBkcm1fZGV2aWNlOworc3RydWN0
IHBsYXRmb3JtX2RldmljZTsKK3N0cnVjdCB6eW5xbXBfZGlzcDsKK3N0cnVjdCB6eW5xbXBfZHBz
dWI7CisKK3ZvaWQgenlucW1wX2Rpc3BfaGFuZGxlX3ZibGFuayhzdHJ1Y3QgenlucW1wX2Rpc3Ag
KmRpc3ApOworYm9vbCB6eW5xbXBfZGlzcF9hdWRpb19lbmFibGVkKHN0cnVjdCB6eW5xbXBfZGlz
cCAqZGlzcCk7Cit1bnNpZ25lZCBpbnQgenlucW1wX2Rpc3BfZ2V0X2F1ZGlvX2Nsa19yYXRlKHN0
cnVjdCB6eW5xbXBfZGlzcCAqZGlzcCk7Cit1aW50MzJfdCB6eW5xbXBfZGlzcF9nZXRfY3J0Y19t
YXNrKHN0cnVjdCB6eW5xbXBfZGlzcCAqZGlzcCk7CisKK2ludCB6eW5xbXBfZGlzcF9kcm1faW5p
dChzdHJ1Y3QgenlucW1wX2Rwc3ViICpkcHN1Yik7CitpbnQgenlucW1wX2Rpc3BfcHJvYmUoc3Ry
dWN0IHp5bnFtcF9kcHN1YiAqZHBzdWIsIHN0cnVjdCBkcm1fZGV2aWNlICpkcm0pOwordm9pZCB6
eW5xbXBfZGlzcF9yZW1vdmUoc3RydWN0IHp5bnFtcF9kcHN1YiAqZHBzdWIpOworCisjZW5kaWYg
LyogX1pZTlFNUF9ESVNQX0hfICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0veGxueC96
eW5xbXBfZGlzcF9yZWdzLmggYi9kcml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZGlzcF9yZWdz
LmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5mOTJhMDA2ZDUwNzAK
LS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBfZGlzcF9yZWdz
LmgKQEAgLTAsMCArMSwyMDEgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4w
ICovCisvKgorICogWnlucU1QIERpc3BsYXkgQ29udHJvbGxlciBEcml2ZXIgLSBSZWdpc3RlciBE
ZWZpbml0aW9ucworICoKKyAqIENvcHlyaWdodCAoQykgMjAxNyAtIDIwMjAgWGlsaW54LCBJbmMu
CisgKgorICogQXV0aG9yczoKKyAqIC0gSHl1biBXb28gS3dvbiA8aHl1bi5rd29uQHhpbGlueC5j
b20+CisgKiAtIExhdXJlbnQgUGluY2hhcnQgPGxhdXJlbnQucGluY2hhcnRAaWRlYXNvbmJvYXJk
LmNvbT4KKyAqLworCisjaWZuZGVmIF9aWU5RTVBfRElTUF9SRUdTX0hfCisjZGVmaW5lIF9aWU5R
TVBfRElTUF9SRUdTX0hfCisKKyNpbmNsdWRlIDxsaW51eC9iaXRzLmg+CisKKy8qIEJsZW5kZXIg
cmVnaXN0ZXJzICovCisjZGVmaW5lIFpZTlFNUF9ESVNQX1ZfQkxFTkRfQkdfQ0xSXzAJCQkweDAK
KyNkZWZpbmUgWllOUU1QX0RJU1BfVl9CTEVORF9CR19DTFJfMQkJCTB4NAorI2RlZmluZSBaWU5R
TVBfRElTUF9WX0JMRU5EX0JHX0NMUl8yCQkJMHg4CisjZGVmaW5lIFpZTlFNUF9ESVNQX1ZfQkxF
TkRfQkdfTUFYCQkJMHhmZmYKKyNkZWZpbmUgWllOUU1QX0RJU1BfVl9CTEVORF9TRVRfR0xPQkFM
X0FMUEhBCQkweGMKKyNkZWZpbmUgWllOUU1QX0RJU1BfVl9CTEVORF9TRVRfR0xPQkFMX0FMUEhB
X1ZBTFVFKG4pCSgobikgPDwgMSkKKyNkZWZpbmUgWllOUU1QX0RJU1BfVl9CTEVORF9TRVRfR0xP
QkFMX0FMUEhBX0VOCQlCSVQoMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfVl9CTEVORF9PVVRQVVRf
VklEX0ZNVAkJMHgxNAorI2RlZmluZSBaWU5RTVBfRElTUF9WX0JMRU5EX09VVFBVVF9WSURfRk1U
X1JHQgkJMHgwCisjZGVmaW5lIFpZTlFNUF9ESVNQX1ZfQkxFTkRfT1VUUFVUX1ZJRF9GTVRfWUNC
Q1I0NDQJMHgxCisjZGVmaW5lIFpZTlFNUF9ESVNQX1ZfQkxFTkRfT1VUUFVUX1ZJRF9GTVRfWUNC
Q1I0MjIJMHgyCisjZGVmaW5lIFpZTlFNUF9ESVNQX1ZfQkxFTkRfT1VUUFVUX1ZJRF9GTVRfWU9O
TFkJMHgzCisjZGVmaW5lIFpZTlFNUF9ESVNQX1ZfQkxFTkRfT1VUUFVUX1ZJRF9GTVRfWFZZQ0MJ
MHg0CisjZGVmaW5lIFpZTlFNUF9ESVNQX1ZfQkxFTkRfT1VUUFVUX1ZJRF9GTVRfRU5fRE9XTlNB
TVBMRQlCSVQoNCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfVl9CTEVORF9MQVlFUl9DT05UUk9MKG4p
CQkoMHgxOCArICgobikgKiA0KSkKKyNkZWZpbmUgWllOUU1QX0RJU1BfVl9CTEVORF9MQVlFUl9D
T05UUk9MX0VOX1VTCQlCSVQoMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfVl9CTEVORF9MQVlFUl9D
T05UUk9MX1JHQgkJQklUKDEpCisjZGVmaW5lIFpZTlFNUF9ESVNQX1ZfQkxFTkRfTEFZRVJfQ09O
VFJPTF9CWVBBU1MJQklUKDgpCisjZGVmaW5lIFpZTlFNUF9ESVNQX1ZfQkxFTkRfTlVNX0NPRUZG
CQkJOQorI2RlZmluZSBaWU5RTVBfRElTUF9WX0JMRU5EX05VTV9PRkZTRVQJCQkzCisjZGVmaW5l
IFpZTlFNUF9ESVNQX1ZfQkxFTkRfUkdCMllDQkNSX0NPRUZGKG4pCQkoMHgyMCArICgobikgKiA0
KSkKKyNkZWZpbmUgWllOUU1QX0RJU1BfVl9CTEVORF9JTjFDU0NfQ09FRkYobikJCSgweDQ0ICsg
KChuKSAqIDQpKQorI2RlZmluZSBaWU5RTVBfRElTUF9WX0JMRU5EX0lOMUNTQ19PRkZTRVQobikJ
CSgweDY4ICsgKChuKSAqIDQpKQorI2RlZmluZSBaWU5RTVBfRElTUF9WX0JMRU5EX09VVENTQ19P
RkZTRVQobikJCSgweDc0ICsgKChuKSAqIDQpKQorI2RlZmluZSBaWU5RTVBfRElTUF9WX0JMRU5E
X0lOMkNTQ19DT0VGRihuKQkJKDB4ODAgKyAoKG4pICogNCkpCisjZGVmaW5lIFpZTlFNUF9ESVNQ
X1ZfQkxFTkRfSU4yQ1NDX09GRlNFVChuKQkJKDB4YTQgKyAoKG4pICogNCkpCisjZGVmaW5lIFpZ
TlFNUF9ESVNQX1ZfQkxFTkRfQ0hST01BX0tFWV9FTkFCTEUJCTB4MWQwCisjZGVmaW5lIFpZTlFN
UF9ESVNQX1ZfQkxFTkRfQ0hST01BX0tFWV9DT01QMQkJMHgxZDQKKyNkZWZpbmUgWllOUU1QX0RJ
U1BfVl9CTEVORF9DSFJPTUFfS0VZX0NPTVAyCQkweDFkOAorI2RlZmluZSBaWU5RTVBfRElTUF9W
X0JMRU5EX0NIUk9NQV9LRVlfQ09NUDMJCTB4MWRjCisKKy8qIEFWIGJ1ZmZlciBtYW5hZ2VyIHJl
Z2lzdGVycyAqLworI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UCQkJCTB4MAorI2RlZmlu
ZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJRF9TSElGVAkJMAorI2RlZmluZSBaWU5RTVBf
RElTUF9BVl9CVUZfRk1UX05MX1ZJRF9NQVNLCQkoMHgxZiA8PCAwKQorI2RlZmluZSBaWU5RTVBf
RElTUF9BVl9CVUZfRk1UX05MX1ZJRF9VWVZZCQkoMCA8PCAwKQorI2RlZmluZSBaWU5RTVBfRElT
UF9BVl9CVUZfRk1UX05MX1ZJRF9WWVVZCQkoMSA8PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9B
Vl9CVUZfRk1UX05MX1ZJRF9ZVllVCQkoMiA8PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9C
VUZfRk1UX05MX1ZJRF9ZVVlWCQkoMyA8PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZf
Rk1UX05MX1ZJRF9ZVjE2CQkoNCA8PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1U
X05MX1ZJRF9ZVjI0CQkoNSA8PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05M
X1ZJRF9ZVjE2Q0kJCSg2IDw8IDApCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxf
VklEX01PTk8JCSg3IDw8IDApCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklE
X1lWMTZDSTIJCSg4IDw8IDApCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklE
X1lVVjQ0NAkJKDkgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURf
UkdCODg4CQkoMTAgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURf
UkdCQTg4ODAJCSgxMSA8PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX1ZJ
RF9SR0I4ODhfMTAJCSgxMiA8PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05M
X1ZJRF9ZVVY0NDRfMTAJCSgxMyA8PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1U
X05MX1ZJRF9ZVjE2Q0kyXzEwCSgxNCA8PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZf
Rk1UX05MX1ZJRF9ZVjE2Q0lfMTAJCSgxNSA8PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9C
VUZfRk1UX05MX1ZJRF9ZVjE2XzEwCQkoMTYgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZf
QlVGX0ZNVF9OTF9WSURfWVYyNF8xMAkJKDE3IDw8IDApCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FW
X0JVRl9GTVRfTkxfVklEX1lPTkxZXzEwCQkoMTggPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1Bf
QVZfQlVGX0ZNVF9OTF9WSURfWVYxNl80MjAJCSgxOSA8PCAwKQorI2RlZmluZSBaWU5RTVBfRElT
UF9BVl9CVUZfRk1UX05MX1ZJRF9ZVjE2Q0lfNDIwCSgyMCA8PCAwKQorI2RlZmluZSBaWU5RTVBf
RElTUF9BVl9CVUZfRk1UX05MX1ZJRF9ZVjE2Q0kyXzQyMAkoMjEgPDwgMCkKKyNkZWZpbmUgWllO
UU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9WSURfWVYxNl80MjBfMTAJKDIyIDw8IDApCisjZGVmaW5l
IFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1lWMTZDSV80MjBfMTAJKDIzIDw8IDApCisj
ZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfVklEX1lWMTZDSTJfNDIwXzEwCSgyNCA8
PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX0dGWF9TSElGVAkJOAorI2Rl
ZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX0dGWF9NQVNLCQkoMHhmIDw8IDgpCisjZGVm
aW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfR0ZYX1JHQkE4ODg4CQkoMCA8PCA4KQorI2Rl
ZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX0dGWF9BQkdSODg4OAkJKDEgPDwgOCkKKyNk
ZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9HRlhfUkdCODg4CQkoMiA8PCA4KQorI2Rl
ZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX0dGWF9CR1I4ODgJCSgzIDw8IDgpCisjZGVm
aW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9GTVRfTkxfR0ZYX1JHQkE1NTUxCQkoNCA8PCA4KQorI2Rl
ZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX0dGWF9SR0JBNDQ0NAkJKDUgPDwgOCkKKyNk
ZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0ZNVF9OTF9HRlhfUkdCNTY1CQkoNiA8PCA4KQorI2Rl
ZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX0dGWF84QlBQCQkoNyA8PCA4KQorI2RlZmlu
ZSBaWU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX0dGWF80QlBQCQkoOCA8PCA4KQorI2RlZmluZSBa
WU5RTVBfRElTUF9BVl9CVUZfRk1UX05MX0dGWF8yQlBQCQkoOSA8PCA4KQorI2RlZmluZSBaWU5R
TVBfRElTUF9BVl9CVUZfRk1UX05MX0dGWF8xQlBQCQkoMTAgPDwgOCkKKyNkZWZpbmUgWllOUU1Q
X0RJU1BfQVZfQlVGX05PTl9MSVZFX0xBVEVOQ1kJCTB4OAorI2RlZmluZSBaWU5RTVBfRElTUF9B
Vl9CVUZfQ0hCVUYobikJCQkoMHgxMCArICgobikgKiA0KSkKKyNkZWZpbmUgWllOUU1QX0RJU1Bf
QVZfQlVGX0NIQlVGX0VOCQkJQklUKDApCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9DSEJV
Rl9GTFVTSAkJCUJJVCgxKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfQ0hCVUZfQlVSU1Rf
TEVOX1NISUZUCTIKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0NIQlVGX0JVUlNUX0xFTl9N
QVNLCQkoMHhmIDw8IDIpCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9DSEJVRl9CVVJTVF9M
RU5fTUFYCQkweGYKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0NIQlVGX0JVUlNUX0xFTl9B
VURfTUFYCTB4MworI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfU1RBVFVTCQkJMHgyOAorI2Rl
ZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfU1RDX0NUUkwJCQkweDJjCisjZGVmaW5lIFpZTlFNUF9E
SVNQX0FWX0JVRl9TVENfQ1RSTF9FTgkJCUJJVCgwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9C
VUZfU1RDX0NUUkxfRVZFTlRfU0hJRlQJCTEKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX1NU
Q19DVFJMX0VWRU5UX0VYX1ZTWU5DCTAKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX1NUQ19D
VFJMX0VWRU5UX0VYX1ZJRAkxCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9TVENfQ1RSTF9F
VkVOVF9FWF9BVUQJMgorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfU1RDX0NUUkxfRVZFTlRf
SU5UX1ZTWU5DCTMKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX1NUQ19JTklUX1ZBTFVFMAkJ
MHgzMAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfU1RDX0lOSVRfVkFMVUUxCQkweDM0Cisj
ZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9TVENfQURKCQkJMHgzOAorI2RlZmluZSBaWU5RTVBf
RElTUF9BVl9CVUZfU1RDX1ZJRF9WU1lOQ19UUzAJCTB4M2MKKyNkZWZpbmUgWllOUU1QX0RJU1Bf
QVZfQlVGX1NUQ19WSURfVlNZTkNfVFMxCQkweDQwCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JV
Rl9TVENfRVhUX1ZTWU5DX1RTMAkJMHg0NAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfU1RD
X0VYVF9WU1lOQ19UUzEJCTB4NDgKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX1NUQ19DVVNU
T01fRVZFTlRfVFMwCQkweDRjCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9TVENfQ1VTVE9N
X0VWRU5UX1RTMQkJMHg1MAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfU1RDX0NVU1RPTV9F
VkVOVDJfVFMwCTB4NTQKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX1NUQ19DVVNUT01fRVZF
TlQyX1RTMQkweDU4CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9TVENfU05BUFNIT1QwCQkw
eDYwCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9TVENfU05BUFNIT1QxCQkweDY0CisjZGVm
aW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVQJCQkweDcwCisjZGVmaW5lIFpZTlFNUF9ESVNQ
X0FWX0JVRl9PVVRQVVRfVklEMV9TSElGVAkJMAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZf
T1VUUFVUX1ZJRDFfTUFTSwkJKDB4MyA8PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZf
T1VUUFVUX1ZJRDFfTElWRQkJKDAgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX09V
VFBVVF9WSUQxX01FTQkJKDEgPDwgMCkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX09VVFBV
VF9WSUQxX1BBVFRFUk4JCSgyIDw8IDApCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQ
VVRfVklEMV9OT05FCQkoMyA8PCAwKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVU
X1ZJRDJfU0hJRlQJCTIKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9WSUQyX01B
U0sJCSgweDMgPDwgMikKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9WSUQyX0RJ
U0FCTEUJCSgwIDw8IDIpCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfVklEMl9N
RU0JCSgxIDw8IDIpCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfVklEMl9MSVZF
CQkoMiA8PCAyKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVUX1ZJRDJfTk9ORQkJ
KDMgPDwgMikKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9BVUQxX1NISUZUCQk0
CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfQVVEMV9NQVNLCQkoMHgzIDw8IDQp
CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfQVVEMV9QTAkJKDAgPDwgNCkKKyNk
ZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9BVUQxX01FTQkJKDEgPDwgNCkKKyNkZWZp
bmUgWllOUU1QX0RJU1BfQVZfQlVGX09VVFBVVF9BVUQxX1BBVFRFUk4JCSgyIDw8IDQpCisjZGVm
aW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9PVVRQVVRfQVVEMV9ESVNBQkxFCQkoMyA8PCA0KQorI2Rl
ZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfT1VUUFVUX0FVRDJfRU4JCUJJVCg2KQorI2RlZmluZSBa
WU5RTVBfRElTUF9BVl9CVUZfSENPVU5UX1ZDT1VOVF9JTlQwCQkweDc0CisjZGVmaW5lIFpZTlFN
UF9ESVNQX0FWX0JVRl9IQ09VTlRfVkNPVU5UX0lOVDEJCTB4NzgKKyNkZWZpbmUgWllOUU1QX0RJ
U1BfQVZfQlVGX1BBVFRFUk5fR0VOX1NFTEVDVAkJMHgxMDAKKyNkZWZpbmUgWllOUU1QX0RJU1Bf
QVZfQlVGX0NMS19TUkMJCQkweDEyMAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfQ0xLX1NS
Q19WSURfRlJPTV9QUwkJQklUKDApCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9DTEtfU1JD
X0FVRF9GUk9NX1BTCQlCSVQoMSkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX0NMS19TUkNf
VklEX0lOVEVSTkFMX1RJTUlORwlCSVQoMikKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX1NS
U1RfUkVHCQkJMHgxMjQKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX1NSU1RfUkVHX1ZJRF9S
U1QJCUJJVCgxKQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfQVVESU9fQ0hfQ09ORklHCQkw
eDEyYworI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfR0ZYX0NPTVBfU0YobikJCSgweDIwMCAr
ICgobikgKiA0KSkKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGX1ZJRF9DT01QX1NGKG4pCQko
MHgyMGMgKyAoKG4pICogNCkpCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9MSVZEX1ZJRF9D
T01QX1NGKG4pCQkoMHgyMTggKyAoKG4pICogNCkpCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JV
Rl9MSVZFX1ZJRF9DT05GSUcJCTB4MjI0CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl9MSVZE
X0dGWF9DT01QX1NGKG4pCQkoMHgyMjggKyAoKG4pICogNCkpCisjZGVmaW5lIFpZTlFNUF9ESVNQ
X0FWX0JVRl9MSVZFX0dGWF9DT05GSUcJCTB4MjM0CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JV
Rl80QklUX1NGCQkJMHgxMTExMQorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfNUJJVF9TRgkJ
CTB4MTA4NDIKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVGXzZCSVRfU0YJCQkweDEwNDEwCisj
ZGVmaW5lIFpZTlFNUF9ESVNQX0FWX0JVRl84QklUX1NGCQkJMHgxMDEwMQorI2RlZmluZSBaWU5R
TVBfRElTUF9BVl9CVUZfMTBCSVRfU0YJCQkweDEwMDQwCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FW
X0JVRl9OVUxMX1NGCQkJMAorI2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfTlVNX1NGCQkJMwor
I2RlZmluZSBaWU5RTVBfRElTUF9BVl9CVUZfTElWRV9DT05GSUdfQlBDXzYJCTB4MAorI2RlZmlu
ZSBaWU5RTVBfRElTUF9BVl9CVUZfTElWRV9DT05GSUdfQlBDXzgJCTB4MQorI2RlZmluZSBaWU5R
TVBfRElTUF9BVl9CVUZfTElWRV9DT05GSUdfQlBDXzEwCQkweDIKKyNkZWZpbmUgWllOUU1QX0RJ
U1BfQVZfQlVGX0xJVkVfQ09ORklHX0JQQ18xMgkJMHgzCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FW
X0JVRl9MSVZFX0NPTkZJR19CUENfTUFTSwkJR0VOTUFTSygyLCAwKQorI2RlZmluZSBaWU5RTVBf
RElTUF9BVl9CVUZfTElWRV9DT05GSUdfRk1UX1JHQgkJMHgwCisjZGVmaW5lIFpZTlFNUF9ESVNQ
X0FWX0JVRl9MSVZFX0NPTkZJR19GTVRfWVVWNDQ0CTB4MQorI2RlZmluZSBaWU5RTVBfRElTUF9B
Vl9CVUZfTElWRV9DT05GSUdfRk1UX1lVVjQyMgkweDIKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZf
QlVGX0xJVkVfQ09ORklHX0ZNVF9ZT05MWQkweDMKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVZfQlVG
X0xJVkVfQ09ORklHX0ZNVF9NQVNLCQlHRU5NQVNLKDUsIDQpCisjZGVmaW5lIFpZTlFNUF9ESVNQ
X0FWX0JVRl9MSVZFX0NPTkZJR19DQl9GSVJTVAkJQklUKDgpCisjZGVmaW5lIFpZTlFNUF9ESVNQ
X0FWX0JVRl9QQUxFVFRFX01FTU9SWQkJMHg0MDAKKworLyogQXVkaW8gcmVnaXN0ZXJzICovCisj
ZGVmaW5lIFpZTlFNUF9ESVNQX0FVRF9NSVhFUl9WT0xVTUUJCQkweDAKKyNkZWZpbmUgWllOUU1Q
X0RJU1BfQVVEX01JWEVSX1ZPTFVNRV9OT19TQ0FMRQkJMHgyMDAwMjAwMAorI2RlZmluZSBaWU5R
TVBfRElTUF9BVURfTUlYRVJfTUVUQV9EQVRBCQkJMHg0CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FV
RF9DSF9TVEFUVVMwCQkJMHg4CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FVRF9DSF9TVEFUVVMxCQkJ
MHhjCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FVRF9DSF9TVEFUVVMyCQkJMHgxMAorI2RlZmluZSBa
WU5RTVBfRElTUF9BVURfQ0hfU1RBVFVTMwkJCTB4MTQKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVVE
X0NIX1NUQVRVUzQJCQkweDE4CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FVRF9DSF9TVEFUVVM1CQkJ
MHgxYworI2RlZmluZSBaWU5RTVBfRElTUF9BVURfQ0hfQV9EQVRBMAkJCTB4MjAKKyNkZWZpbmUg
WllOUU1QX0RJU1BfQVVEX0NIX0FfREFUQTEJCQkweDI0CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FV
RF9DSF9BX0RBVEEyCQkJMHgyOAorI2RlZmluZSBaWU5RTVBfRElTUF9BVURfQ0hfQV9EQVRBMwkJ
CTB4MmMKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVVEX0NIX0FfREFUQTQJCQkweDMwCisjZGVmaW5l
IFpZTlFNUF9ESVNQX0FVRF9DSF9BX0RBVEE1CQkJMHgzNAorI2RlZmluZSBaWU5RTVBfRElTUF9B
VURfQ0hfQl9EQVRBMAkJCTB4MzgKKyNkZWZpbmUgWllOUU1QX0RJU1BfQVVEX0NIX0JfREFUQTEJ
CQkweDNjCisjZGVmaW5lIFpZTlFNUF9ESVNQX0FVRF9DSF9CX0RBVEEyCQkJMHg0MAorI2RlZmlu
ZSBaWU5RTVBfRElTUF9BVURfQ0hfQl9EQVRBMwkJCTB4NDQKKyNkZWZpbmUgWllOUU1QX0RJU1Bf
QVVEX0NIX0JfREFUQTQJCQkweDQ4CisjZGVmaW5lIFpZTlFNUF9ESVNQX0FVRF9DSF9CX0RBVEE1
CQkJMHg0YworI2RlZmluZSBaWU5RTVBfRElTUF9BVURfU09GVF9SRVNFVAkJCTB4YzAwCisjZGVm
aW5lIFpZTlFNUF9ESVNQX0FVRF9TT0ZUX1JFU0VUX0FVRF9TUlNUCQlCSVQoMCkKKworI2VuZGlm
IC8qIF9aWU5RTVBfRElTUF9SRUdTX0hfICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
eGxueC96eW5xbXBfZHAuYyBiL2RyaXZlcnMvZ3B1L2RybS94bG54L3p5bnFtcF9kcC5jCm5ldyBm
aWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uODIxZjdhNzFlMTgyCi0tLSAvZGV2
L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2RwLmMKQEAgLTAsMCArMSwx
NzM0IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAorLyoKKyAqIFp5bnFN
UCBEaXNwbGF5UG9ydCBEcml2ZXIKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMTcgLSAyMDIwIFhp
bGlueCwgSW5jLgorICoKKyAqIEF1dGhvcnM6CisgKiAtIEh5dW4gV29vIEt3b24gPGh5dW4ua3dv
bkB4aWxpbnguY29tPgorICogLSBMYXVyZW50IFBpbmNoYXJ0IDxsYXVyZW50LnBpbmNoYXJ0QGlk
ZWFzb25ib2FyZC5jb20+CisgKi8KKworI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljX2hlbHBlci5o
PgorI2luY2x1ZGUgPGRybS9kcm1fY29ubmVjdG9yLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9jcnRj
Lmg+CisjaW5jbHVkZSA8ZHJtL2RybV9kZXZpY2UuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2RwX2hl
bHBlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fZWRpZC5oPgorI2luY2x1ZGUgPGRybS9kcm1fZW5j
b2Rlci5oPgorI2luY2x1ZGUgPGRybS9kcm1fbWFuYWdlZC5oPgorI2luY2x1ZGUgPGRybS9kcm1f
bW9kZXMuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX29mLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wcm9i
ZV9oZWxwZXIuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3NpbXBsZV9rbXNfaGVscGVyLmg+CisKKyNp
bmNsdWRlIDxsaW51eC9jbGsuaD4KKyNpbmNsdWRlIDxsaW51eC9kZWxheS5oPgorI2luY2x1ZGUg
PGxpbnV4L2RldmljZS5oPgorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgorI2luY2x1ZGUgPGxp
bnV4L3BsYXRmb3JtX2RldmljZS5oPgorI2luY2x1ZGUgPGxpbnV4L3BtX3J1bnRpbWUuaD4KKyNp
bmNsdWRlIDxsaW51eC9waHkvcGh5Lmg+CisjaW5jbHVkZSA8bGludXgvcmVzZXQuaD4KKworI2lu
Y2x1ZGUgInp5bnFtcF9kaXNwLmgiCisjaW5jbHVkZSAienlucW1wX2RwLmgiCisjaW5jbHVkZSAi
enlucW1wX2Rwc3ViLmgiCisKK3N0YXRpYyB1aW50IHp5bnFtcF9kcF9hdXhfdGltZW91dF9tcyA9
IDUwOworbW9kdWxlX3BhcmFtX25hbWVkKGF1eF90aW1lb3V0X21zLCB6eW5xbXBfZHBfYXV4X3Rp
bWVvdXRfbXMsIHVpbnQsIDA0NDQpOworTU9EVUxFX1BBUk1fREVTQyhhdXhfdGltZW91dF9tcywg
IkRQIGF1eCB0aW1lb3V0IHZhbHVlIGluIG1zZWMgKGRlZmF1bHQ6IDUwKSIpOworCisvKgorICog
U29tZSBzaW5rIHJlcXVpcmVzIGEgZGVsYXkgYWZ0ZXIgcG93ZXIgb24gcmVxdWVzdAorICovCitz
dGF0aWMgdWludCB6eW5xbXBfZHBfcG93ZXJfb25fZGVsYXlfbXMgPSA0OworbW9kdWxlX3BhcmFt
X25hbWVkKHBvd2VyX29uX2RlbGF5X21zLCB6eW5xbXBfZHBfcG93ZXJfb25fZGVsYXlfbXMsIHVp
bnQsIDA0NDQpOworTU9EVUxFX1BBUk1fREVTQyhhdXhfdGltZW91dF9tcywgIkRQIHBvd2VyIG9u
IGRlbGF5IGluIG1zZWMgKGRlZmF1bHQ6IDQpIik7CisKKy8qIExpbmsgY29uZmlndXJhdGlvbiBy
ZWdpc3RlcnMgKi8KKyNkZWZpbmUgWllOUU1QX0RQX0xJTktfQldfU0VUCQkJCTB4MAorI2RlZmlu
ZSBaWU5RTVBfRFBfTEFORV9DT1VOVF9TRVQJCQkweDQKKyNkZWZpbmUgWllOUU1QX0RQX0VOSEFO
Q0VEX0ZSQU1FX0VOCQkJMHg4CisjZGVmaW5lIFpZTlFNUF9EUF9UUkFJTklOR19QQVRURVJOX1NF
VAkJCTB4YworI2RlZmluZSBaWU5RTVBfRFBfU0NSQU1CTElOR19ESVNBQkxFCQkJMHgxNAorI2Rl
ZmluZSBaWU5RTVBfRFBfRE9XTlNQUkVBRF9DVEwJCQkweDE4CisjZGVmaW5lIFpZTlFNUF9EUF9T
T0ZUV0FSRV9SRVNFVAkJCTB4MWMKKyNkZWZpbmUgWllOUU1QX0RQX1NPRlRXQVJFX1JFU0VUX1NU
UkVBTTEJCUJJVCgwKQorI2RlZmluZSBaWU5RTVBfRFBfU09GVFdBUkVfUkVTRVRfU1RSRUFNMgkJ
QklUKDEpCisjZGVmaW5lIFpZTlFNUF9EUF9TT0ZUV0FSRV9SRVNFVF9TVFJFQU0zCQlCSVQoMikK
KyNkZWZpbmUgWllOUU1QX0RQX1NPRlRXQVJFX1JFU0VUX1NUUkVBTTQJCUJJVCgzKQorI2RlZmlu
ZSBaWU5RTVBfRFBfU09GVFdBUkVfUkVTRVRfQVVYCQkJQklUKDcpCisjZGVmaW5lIFpZTlFNUF9E
UF9TT0ZUV0FSRV9SRVNFVF9BTEwJCQkoWllOUU1QX0RQX1NPRlRXQVJFX1JFU0VUX1NUUkVBTTEg
fCBcCisJCQkJCQkJIFpZTlFNUF9EUF9TT0ZUV0FSRV9SRVNFVF9TVFJFQU0yIHwgXAorCQkJCQkJ
CSBaWU5RTVBfRFBfU09GVFdBUkVfUkVTRVRfU1RSRUFNMyB8IFwKKwkJCQkJCQkgWllOUU1QX0RQ
X1NPRlRXQVJFX1JFU0VUX1NUUkVBTTQgfCBcCisJCQkJCQkJIFpZTlFNUF9EUF9TT0ZUV0FSRV9S
RVNFVF9BVVgpCisKKy8qIENvcmUgZW5hYmxlIHJlZ2lzdGVycyAqLworI2RlZmluZSBaWU5RTVBf
RFBfVFJBTlNNSVRURVJfRU5BQkxFCQkJMHg4MAorI2RlZmluZSBaWU5RTVBfRFBfTUFJTl9TVFJF
QU1fRU5BQkxFCQkJMHg4NAorI2RlZmluZSBaWU5RTVBfRFBfRk9SQ0VfU0NSQU1CTEVSX1JFU0VU
CQkJMHhjMAorI2RlZmluZSBaWU5RTVBfRFBfVkVSU0lPTgkJCQkweGY4CisjZGVmaW5lIFpZTlFN
UF9EUF9WRVJTSU9OX01BSk9SX01BU0sJCQlHRU5NQVNLKDMxLCAyNCkKKyNkZWZpbmUgWllOUU1Q
X0RQX1ZFUlNJT05fTUFKT1JfU0hJRlQJCQkyNAorI2RlZmluZSBaWU5RTVBfRFBfVkVSU0lPTl9N
SU5PUl9NQVNLCQkJR0VOTUFTSygyMywgMTYpCisjZGVmaW5lIFpZTlFNUF9EUF9WRVJTSU9OX01J
Tk9SX1NISUZUCQkJMTYKKyNkZWZpbmUgWllOUU1QX0RQX1ZFUlNJT05fUkVWSVNJT05fTUFTSwkJ
CUdFTk1BU0soMTUsIDEyKQorI2RlZmluZSBaWU5RTVBfRFBfVkVSU0lPTl9SRVZJU0lPTl9TSElG
VAkJMTIKKyNkZWZpbmUgWllOUU1QX0RQX1ZFUlNJT05fUEFUQ0hfTUFTSwkJCUdFTk1BU0soMTEs
IDgpCisjZGVmaW5lIFpZTlFNUF9EUF9WRVJTSU9OX1BBVENIX1NISUZUCQkJOAorI2RlZmluZSBa
WU5RTVBfRFBfVkVSU0lPTl9JTlRFUk5BTF9NQVNLCQkJR0VOTUFTSyg3LCAwKQorI2RlZmluZSBa
WU5RTVBfRFBfVkVSU0lPTl9JTlRFUk5BTF9TSElGVAkJMAorCisvKiBDb3JlIElEIHJlZ2lzdGVy
cyAqLworI2RlZmluZSBaWU5RTVBfRFBfQ09SRV9JRAkJCQkweGZjCisjZGVmaW5lIFpZTlFNUF9E
UF9DT1JFX0lEX01BSk9SX01BU0sJCQlHRU5NQVNLKDMxLCAyNCkKKyNkZWZpbmUgWllOUU1QX0RQ
X0NPUkVfSURfTUFKT1JfU0hJRlQJCQkyNAorI2RlZmluZSBaWU5RTVBfRFBfQ09SRV9JRF9NSU5P
Ul9NQVNLCQkJR0VOTUFTSygyMywgMTYpCisjZGVmaW5lIFpZTlFNUF9EUF9DT1JFX0lEX01JTk9S
X1NISUZUCQkJMTYKKyNkZWZpbmUgWllOUU1QX0RQX0NPUkVfSURfUkVWSVNJT05fTUFTSwkJCUdF
Tk1BU0soMTUsIDgpCisjZGVmaW5lIFpZTlFNUF9EUF9DT1JFX0lEX1JFVklTSU9OX1NISUZUCQk4
CisjZGVmaW5lIFpZTlFNUF9EUF9DT1JFX0lEX0RJUkVDVElPTgkJCUdFTk1BU0soMSkKKworLyog
QVVYIGNoYW5uZWwgaW50ZXJmYWNlIHJlZ2lzdGVycyAqLworI2RlZmluZSBaWU5RTVBfRFBfQVVY
X0NPTU1BTkQJCQkJMHgxMDAKKyNkZWZpbmUgWllOUU1QX0RQX0FVWF9DT01NQU5EX0NNRF9TSElG
VAkJCTgKKyNkZWZpbmUgWllOUU1QX0RQX0FVWF9DT01NQU5EX0FERFJFU1NfT05MWQkJQklUKDEy
KQorI2RlZmluZSBaWU5RTVBfRFBfQVVYX0NPTU1BTkRfQllURVNfU0hJRlQJCTAKKyNkZWZpbmUg
WllOUU1QX0RQX0FVWF9XUklURV9GSUZPCQkJMHgxMDQKKyNkZWZpbmUgWllOUU1QX0RQX0FVWF9B
RERSRVNTCQkJCTB4MTA4CisjZGVmaW5lIFpZTlFNUF9EUF9BVVhfQ0xLX0RJVklERVIJCQkweDEw
YworI2RlZmluZSBaWU5RTVBfRFBfQVVYX0NMS19ESVZJREVSX0FVWF9GSUxURVJfU0hJRlQJOAor
I2RlZmluZSBaWU5RTVBfRFBfSU5URVJSVVBUX1NJR05BTF9TVEFURQkJMHgxMzAKKyNkZWZpbmUg
WllOUU1QX0RQX0lOVEVSUlVQVF9TSUdOQUxfU1RBVEVfSFBECQlCSVQoMCkKKyNkZWZpbmUgWllO
UU1QX0RQX0lOVEVSUlVQVF9TSUdOQUxfU1RBVEVfUkVRVUVTVAlCSVQoMSkKKyNkZWZpbmUgWllO
UU1QX0RQX0lOVEVSUlVQVF9TSUdOQUxfU1RBVEVfUkVQTFkJCUJJVCgyKQorI2RlZmluZSBaWU5R
TVBfRFBfSU5URVJSVVBUX1NJR05BTF9TVEFURV9SRVBMWV9USU1FT1VUCUJJVCgzKQorI2RlZmlu
ZSBaWU5RTVBfRFBfQVVYX1JFUExZX0RBVEEJCQkweDEzNAorI2RlZmluZSBaWU5RTVBfRFBfQVVY
X1JFUExZX0NPREUJCQkweDEzOAorI2RlZmluZSBaWU5RTVBfRFBfQVVYX1JFUExZX0NPREVfQVVY
X0FDSwkJKDApCisjZGVmaW5lIFpZTlFNUF9EUF9BVVhfUkVQTFlfQ09ERV9BVVhfTkFDSwkJQklU
KDApCisjZGVmaW5lIFpZTlFNUF9EUF9BVVhfUkVQTFlfQ09ERV9BVVhfREVGRVIJCUJJVCgxKQor
I2RlZmluZSBaWU5RTVBfRFBfQVVYX1JFUExZX0NPREVfSTJDX0FDSwkJKDApCisjZGVmaW5lIFpZ
TlFNUF9EUF9BVVhfUkVQTFlfQ09ERV9JMkNfTkFDSwkJQklUKDIpCisjZGVmaW5lIFpZTlFNUF9E
UF9BVVhfUkVQTFlfQ09ERV9JMkNfREVGRVIJCUJJVCgzKQorI2RlZmluZSBaWU5RTVBfRFBfQVVY
X1JFUExZX0NPVU5UCQkJMHgxM2MKKyNkZWZpbmUgWllOUU1QX0RQX1JFUExZX0RBVEFfQ09VTlQJ
CQkweDE0OAorI2RlZmluZSBaWU5RTVBfRFBfUkVQTFlfREFUQV9DT1VOVF9NQVNLCQkJMHhmZgor
I2RlZmluZSBaWU5RTVBfRFBfSU5UX1NUQVRVUwkJCQkweDNhMAorI2RlZmluZSBaWU5RTVBfRFBf
SU5UX01BU0sJCQkJMHgzYTQKKyNkZWZpbmUgWllOUU1QX0RQX0lOVF9FTgkJCQkweDNhOAorI2Rl
ZmluZSBaWU5RTVBfRFBfSU5UX0RTCQkJCTB4M2FjCisjZGVmaW5lIFpZTlFNUF9EUF9JTlRfSFBE
X0lSUQkJCQlCSVQoMCkKKyNkZWZpbmUgWllOUU1QX0RQX0lOVF9IUERfRVZFTlQJCQkJQklUKDEp
CisjZGVmaW5lIFpZTlFNUF9EUF9JTlRfUkVQTFlfUkVDRUlWRUQJCQlCSVQoMikKKyNkZWZpbmUg
WllOUU1QX0RQX0lOVF9SRVBMWV9USU1FT1VUCQkJQklUKDMpCisjZGVmaW5lIFpZTlFNUF9EUF9J
TlRfSFBEX1BVTFNFX0RFVAkJCUJJVCg0KQorI2RlZmluZSBaWU5RTVBfRFBfSU5UX0VYVF9QS1Rf
VFhECQkJQklUKDUpCisjZGVmaW5lIFpZTlFNUF9EUF9JTlRfTElWX0FCVUZfVU5EUkZMVwkJCUJJ
VCgxMikKKyNkZWZpbmUgWllOUU1QX0RQX0lOVF9WQkxBTktfU1RBUlQJCQlCSVQoMTMpCisjZGVm
aW5lIFpZTlFNUF9EUF9JTlRfUElYRUwxX01BVENICQkJQklUKDE0KQorI2RlZmluZSBaWU5RTVBf
RFBfSU5UX1BJWEVMMF9NQVRDSAkJCUJJVCgxNSkKKyNkZWZpbmUgWllOUU1QX0RQX0lOVF9DSEJV
Rl9VTkRFUkZMV19NQVNLCQkweDNmMDAwMAorI2RlZmluZSBaWU5RTVBfRFBfSU5UX0NIQlVGX09W
RVJGTFdfTUFTSwkJMHhmYzAwMDAwCisjZGVmaW5lIFpZTlFNUF9EUF9JTlRfQ1VTVF9UU18yCQkJ
CUJJVCgyOCkKKyNkZWZpbmUgWllOUU1QX0RQX0lOVF9DVVNUX1RTCQkJCUJJVCgyOSkKKyNkZWZp
bmUgWllOUU1QX0RQX0lOVF9FWFRfVlNZTkNfVFMJCQlCSVQoMzApCisjZGVmaW5lIFpZTlFNUF9E
UF9JTlRfVlNZTkNfVFMJCQkJQklUKDMxKQorI2RlZmluZSBaWU5RTVBfRFBfSU5UX0FMTAkJCQko
WllOUU1QX0RQX0lOVF9IUERfSVJRIHwgXAorCQkJCQkJCSBaWU5RTVBfRFBfSU5UX0hQRF9FVkVO
VCB8IFwKKwkJCQkJCQkgWllOUU1QX0RQX0lOVF9DSEJVRl9VTkRFUkZMV19NQVNLIHwgXAorCQkJ
CQkJCSBaWU5RTVBfRFBfSU5UX0NIQlVGX09WRVJGTFdfTUFTSykKKworLyogTWFpbiBzdHJlYW0g
YXR0cmlidXRlIHJlZ2lzdGVycyAqLworI2RlZmluZSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fSFRP
VEFMCQkJMHgxODAKKyNkZWZpbmUgWllOUU1QX0RQX01BSU5fU1RSRUFNX1ZUT1RBTAkJCTB4MTg0
CisjZGVmaW5lIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9QT0xBUklUWQkJCTB4MTg4CisjZGVmaW5l
IFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9QT0xBUklUWV9IU1lOQ19TSElGVAkwCisjZGVmaW5lIFpZ
TlFNUF9EUF9NQUlOX1NUUkVBTV9QT0xBUklUWV9WU1lOQ19TSElGVAkxCisjZGVmaW5lIFpZTlFN
UF9EUF9NQUlOX1NUUkVBTV9IU1dJRFRICQkJMHgxOGMKKyNkZWZpbmUgWllOUU1QX0RQX01BSU5f
U1RSRUFNX1ZTV0lEVEgJCQkweDE5MAorI2RlZmluZSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fSFJF
UwkJCTB4MTk0CisjZGVmaW5lIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9WUkVTCQkJMHgxOTgKKyNk
ZWZpbmUgWllOUU1QX0RQX01BSU5fU1RSRUFNX0hTVEFSVAkJCTB4MTljCisjZGVmaW5lIFpZTlFN
UF9EUF9NQUlOX1NUUkVBTV9WU1RBUlQJCQkweDFhMAorI2RlZmluZSBaWU5RTVBfRFBfTUFJTl9T
VFJFQU1fTUlTQzAJCQkweDFhNAorI2RlZmluZSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fTUlTQzBf
U1lOQ19MT0NLCQlCSVQoMCkKKyNkZWZpbmUgWllOUU1QX0RQX01BSU5fU1RSRUFNX01JU0MwX0NP
TVBfRk9STUFUX1JHQgkoMCA8PCAxKQorI2RlZmluZSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fTUlT
QzBfQ09NUF9GT1JNQVRfWUNSQ0JfNDIyCSg1IDw8IDEpCisjZGVmaW5lIFpZTlFNUF9EUF9NQUlO
X1NUUkVBTV9NSVNDMF9DT01QX0ZPUk1BVF9ZQ1JDQl80NDQJKDYgPDwgMSkKKyNkZWZpbmUgWllO
UU1QX0RQX01BSU5fU1RSRUFNX01JU0MwX0NPTVBfRk9STUFUX01BU0sJKDcgPDwgMSkKKyNkZWZp
bmUgWllOUU1QX0RQX01BSU5fU1RSRUFNX01JU0MwX0RZTkFNSUNfUkFOR0UJQklUKDMpCisjZGVm
aW5lIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9NSVNDMF9ZQ0JDUl9DT0xSCQlCSVQoNCkKKyNkZWZp
bmUgWllOUU1QX0RQX01BSU5fU1RSRUFNX01JU0MwX0JQQ182CQkoMCA8PCA1KQorI2RlZmluZSBa
WU5RTVBfRFBfTUFJTl9TVFJFQU1fTUlTQzBfQlBDXzgJCSgxIDw8IDUpCisjZGVmaW5lIFpZTlFN
UF9EUF9NQUlOX1NUUkVBTV9NSVNDMF9CUENfMTAJCSgyIDw8IDUpCisjZGVmaW5lIFpZTlFNUF9E
UF9NQUlOX1NUUkVBTV9NSVNDMF9CUENfMTIJCSgzIDw8IDUpCisjZGVmaW5lIFpZTlFNUF9EUF9N
QUlOX1NUUkVBTV9NSVNDMF9CUENfMTYJCSg0IDw8IDUpCisjZGVmaW5lIFpZTlFNUF9EUF9NQUlO
X1NUUkVBTV9NSVNDMF9CUENfTUFTSwkJKDcgPDwgNSkKKyNkZWZpbmUgWllOUU1QX0RQX01BSU5f
U1RSRUFNX01JU0MxCQkJMHgxYTgKKyNkZWZpbmUgWllOUU1QX0RQX01BSU5fU1RSRUFNX01JU0Mx
X1lfT05MWV9FTgkJQklUKDcpCisjZGVmaW5lIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9NX1ZJRAkJ
CTB4MWFjCisjZGVmaW5lIFpZTlFNUF9EUF9NU0FfVFJBTlNGRVJfVU5JVF9TSVpFCQkweDFiMAor
I2RlZmluZSBaWU5RTVBfRFBfTVNBX1RSQU5TRkVSX1VOSVRfU0laRV9UVV9TSVpFX0RFRgk2NAor
I2RlZmluZSBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fTl9WSUQJCQkweDFiNAorI2RlZmluZSBaWU5R
TVBfRFBfVVNFUl9QSVhfV0lEVEgJCQkweDFiOAorI2RlZmluZSBaWU5RTVBfRFBfVVNFUl9EQVRB
X0NPVU5UX1BFUl9MQU5FCQkweDFiYworI2RlZmluZSBaWU5RTVBfRFBfTUlOX0JZVEVTX1BFUl9U
VQkJCTB4MWM0CisjZGVmaW5lIFpZTlFNUF9EUF9GUkFDX0JZVEVTX1BFUl9UVQkJCTB4MWM4Cisj
ZGVmaW5lIFpZTlFNUF9EUF9JTklUX1dBSVQJCQkJMHgxY2MKKworLyogUEhZIGNvbmZpZ3VyYXRp
b24gYW5kIHN0YXR1cyByZWdpc3RlcnMgKi8KKyNkZWZpbmUgWllOUU1QX0RQX1BIWV9SRVNFVAkJ
CQkweDIwMAorI2RlZmluZSBaWU5RTVBfRFBfUEhZX1JFU0VUX1BIWV9SRVNFVAkJCUJJVCgwKQor
I2RlZmluZSBaWU5RTVBfRFBfUEhZX1JFU0VUX0dUVFhfUkVTRVQJCQlCSVQoMSkKKyNkZWZpbmUg
WllOUU1QX0RQX1BIWV9SRVNFVF9QSFlfUE1BX1JFU0VUCQlCSVQoOCkKKyNkZWZpbmUgWllOUU1Q
X0RQX1BIWV9SRVNFVF9QSFlfUENTX1JFU0VUCQlCSVQoOSkKKyNkZWZpbmUgWllOUU1QX0RQX1BI
WV9SRVNFVF9BTExfUkVTRVQJCQkoWllOUU1QX0RQX1BIWV9SRVNFVF9QSFlfUkVTRVQgfCBcCisJ
CQkJCQkJIFpZTlFNUF9EUF9QSFlfUkVTRVRfR1RUWF9SRVNFVCB8IFwKKwkJCQkJCQkgWllOUU1Q
X0RQX1BIWV9SRVNFVF9QSFlfUE1BX1JFU0VUIHwgXAorCQkJCQkJCSBaWU5RTVBfRFBfUEhZX1JF
U0VUX1BIWV9QQ1NfUkVTRVQpCisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfUFJFRU1QSEFTSVNfTEFO
RV8wCQkweDIxMAorI2RlZmluZSBaWU5RTVBfRFBfUEhZX1BSRUVNUEhBU0lTX0xBTkVfMQkJMHgy
MTQKKyNkZWZpbmUgWllOUU1QX0RQX1BIWV9QUkVFTVBIQVNJU19MQU5FXzIJCTB4MjE4CisjZGVm
aW5lIFpZTlFNUF9EUF9QSFlfUFJFRU1QSEFTSVNfTEFORV8zCQkweDIxYworI2RlZmluZSBaWU5R
TVBfRFBfUEhZX1ZPTFRBR0VfRElGRl9MQU5FXzAJCTB4MjIwCisjZGVmaW5lIFpZTlFNUF9EUF9Q
SFlfVk9MVEFHRV9ESUZGX0xBTkVfMQkJMHgyMjQKKyNkZWZpbmUgWllOUU1QX0RQX1BIWV9WT0xU
QUdFX0RJRkZfTEFORV8yCQkweDIyOAorI2RlZmluZSBaWU5RTVBfRFBfUEhZX1ZPTFRBR0VfRElG
Rl9MQU5FXzMJCTB4MjJjCisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfQ0xPQ0tfU0VMRUNUCQkJMHgy
MzQKKyNkZWZpbmUgWllOUU1QX0RQX1BIWV9DTE9DS19TRUxFQ1RfMV82MkcJCTB4MQorI2RlZmlu
ZSBaWU5RTVBfRFBfUEhZX0NMT0NLX1NFTEVDVF8yXzcwRwkJMHgzCisjZGVmaW5lIFpZTlFNUF9E
UF9QSFlfQ0xPQ0tfU0VMRUNUXzVfNDBHCQkweDUKKyNkZWZpbmUgWllOUU1QX0RQX1RYX1BIWV9Q
T1dFUl9ET1dOCQkJMHgyMzgKKyNkZWZpbmUgWllOUU1QX0RQX1RYX1BIWV9QT1dFUl9ET1dOX0xB
TkVfMAkJQklUKDApCisjZGVmaW5lIFpZTlFNUF9EUF9UWF9QSFlfUE9XRVJfRE9XTl9MQU5FXzEJ
CUJJVCgxKQorI2RlZmluZSBaWU5RTVBfRFBfVFhfUEhZX1BPV0VSX0RPV05fTEFORV8yCQlCSVQo
MikKKyNkZWZpbmUgWllOUU1QX0RQX1RYX1BIWV9QT1dFUl9ET1dOX0xBTkVfMwkJQklUKDMpCisj
ZGVmaW5lIFpZTlFNUF9EUF9UWF9QSFlfUE9XRVJfRE9XTl9BTEwJCQkweGYKKyNkZWZpbmUgWllO
UU1QX0RQX1BIWV9QUkVDVVJTT1JfTEFORV8wCQkJMHgyM2MKKyNkZWZpbmUgWllOUU1QX0RQX1BI
WV9QUkVDVVJTT1JfTEFORV8xCQkJMHgyNDAKKyNkZWZpbmUgWllOUU1QX0RQX1BIWV9QUkVDVVJT
T1JfTEFORV8yCQkJMHgyNDQKKyNkZWZpbmUgWllOUU1QX0RQX1BIWV9QUkVDVVJTT1JfTEFORV8z
CQkJMHgyNDgKKyNkZWZpbmUgWllOUU1QX0RQX1BIWV9QT1NUQ1VSU09SX0xBTkVfMAkJCTB4MjRj
CisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfUE9TVENVUlNPUl9MQU5FXzEJCQkweDI1MAorI2RlZmlu
ZSBaWU5RTVBfRFBfUEhZX1BPU1RDVVJTT1JfTEFORV8yCQkJMHgyNTQKKyNkZWZpbmUgWllOUU1Q
X0RQX1BIWV9QT1NUQ1VSU09SX0xBTkVfMwkJCTB4MjU4CisjZGVmaW5lIFpZTlFNUF9EUF9TVUJf
VFhfUEhZX1BSRUNVUlNPUl9MQU5FXzAJCTB4MjRjCisjZGVmaW5lIFpZTlFNUF9EUF9TVUJfVFhf
UEhZX1BSRUNVUlNPUl9MQU5FXzEJCTB4MjUwCisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfU1RBVFVT
CQkJCTB4MjgwCisjZGVmaW5lIFpZTlFNUF9EUF9QSFlfU1RBVFVTX1BMTF9MT0NLRURfU0hJRlQJ
CTQKKyNkZWZpbmUgWllOUU1QX0RQX1BIWV9TVEFUVVNfRlBHQV9QTExfTE9DS0VECQlCSVQoNikK
KworLyogQXVkaW8gcmVnaXN0ZXJzICovCisjZGVmaW5lIFpZTlFNUF9EUF9UWF9BVURJT19DT05U
Uk9MCQkJMHgzMDAKKyNkZWZpbmUgWllOUU1QX0RQX1RYX0FVRElPX0NIQU5ORUxTCQkJMHgzMDQK
KyNkZWZpbmUgWllOUU1QX0RQX1RYX0FVRElPX0lORk9fREFUQQkJCTB4MzA4CisjZGVmaW5lIFpZ
TlFNUF9EUF9UWF9NX0FVRAkJCQkweDMyOAorI2RlZmluZSBaWU5RTVBfRFBfVFhfTl9BVUQJCQkJ
MHgzMmMKKyNkZWZpbmUgWllOUU1QX0RQX1RYX0FVRElPX0VYVF9EQVRBCQkJMHgzMzAKKworI2Rl
ZmluZSBaWU5RTVBfRFBfTUFYX0xBTkVTCQkJCTIKKyNkZWZpbmUgWllOUU1QX01BWF9GUkVRCQkJ
CQkzMDAwMDAwCisKKyNkZWZpbmUgRFBfUkVEVUNFRF9CSVRfUkFURQkJCQkxNjIwMDAKKyNkZWZp
bmUgRFBfSElHSF9CSVRfUkFURQkJCQkyNzAwMDAKKyNkZWZpbmUgRFBfSElHSF9CSVRfUkFURTIJ
CQkJNTQwMDAwCisjZGVmaW5lIERQX01BWF9UUkFJTklOR19UUklFUwkJCQk1CisjZGVmaW5lIERQ
X1YxXzIJCQkJCQkweDEyCisKKy8qKgorICogc3RydWN0IHp5bnFtcF9kcF9saW5rX2NvbmZpZyAt
IENvbW1vbiBsaW5rIGNvbmZpZyBiZXR3ZWVuIHNvdXJjZSBhbmQgc2luaworICogQG1heF9yYXRl
OiBtYXhpbXVtIGxpbmsgcmF0ZQorICogQG1heF9sYW5lczogbWF4aW11bSBudW1iZXIgb2YgbGFu
ZXMKKyAqLworc3RydWN0IHp5bnFtcF9kcF9saW5rX2NvbmZpZyB7CisJaW50IG1heF9yYXRlOwor
CXU4IG1heF9sYW5lczsKK307CisKKy8qKgorICogc3RydWN0IHp5bnFtcF9kcF9tb2RlIC0gQ29u
ZmlndXJlZCBtb2RlIG9mIERpc3BsYXlQb3J0CisgKiBAYndfY29kZTogY29kZSBmb3IgYmFuZHdp
ZHRoKGxpbmsgcmF0ZSkKKyAqIEBsYW5lX2NudDogbnVtYmVyIG9mIGxhbmVzCisgKiBAcGNsb2Nr
OiBwaXhlbCBjbG9jayBmcmVxdWVuY3kgb2YgY3VycmVudCBtb2RlCisgKiBAZm10OiBmb3JtYXQg
aWRlbnRpZmllciBzdHJpbmcKKyAqLworc3RydWN0IHp5bnFtcF9kcF9tb2RlIHsKKwl1OCBid19j
b2RlOworCXU4IGxhbmVfY250OworCWludCBwY2xvY2s7CisJY29uc3QgY2hhciAqZm10OworfTsK
KworLyoqCisgKiBzdHJ1Y3QgenlucW1wX2RwX2NvbmZpZyAtIENvbmZpZ3VyYXRpb24gb2YgRGlz
cGxheVBvcnQgZnJvbSBEVFMKKyAqIEBtaXNjMDogbWlzYzAgY29uZmlndXJhdGlvbiAocGVyIERQ
IHYxLjIgc3BlYykKKyAqIEBtaXNjMTogbWlzYzEgY29uZmlndXJhdGlvbiAocGVyIERQIHYxLjIg
c3BlYykKKyAqIEBicHA6IGJpdHMgcGVyIHBpeGVsCisgKi8KK3N0cnVjdCB6eW5xbXBfZHBfY29u
ZmlnIHsKKwl1OCBtaXNjMDsKKwl1OCBtaXNjMTsKKwl1OCBicHA7Cit9OworCisvKioKKyAqIHN0
cnVjdCB6eW5xbXBfZHAgLSBYaWxpbnggRGlzcGxheVBvcnQgY29yZQorICogQGVuY29kZXI6IHRo
ZSBkcm0gZW5jb2RlciBzdHJ1Y3R1cmUKKyAqIEBjb25uZWN0b3I6IHRoZSBkcm0gY29ubmVjdG9y
IHN0cnVjdHVyZQorICogQGRldjogZGV2aWNlIHN0cnVjdHVyZQorICogQGRwc3ViOiBEaXNwbGF5
IHN1YnN5c3RlbQorICogQGRybTogRFJNIGNvcmUKKyAqIEBpb21lbTogZGV2aWNlIEkvTyBtZW1v
cnkgZm9yIHJlZ2lzdGVyIGFjY2VzcworICogQHJlc2V0OiByZXNldCBjb250cm9sbGVyCisgKiBA
aXJxOiBpcnEKKyAqIEBjb25maWc6IElQIGNvcmUgY29uZmlndXJhdGlvbiBmcm9tIERUUworICog
QGF1eDogYXV4IGNoYW5uZWwKKyAqIEBwaHk6IFBIWSBoYW5kbGVzIGZvciBEUCBsYW5lcworICog
QG51bV9sYW5lczogbnVtYmVyIG9mIGVuYWJsZWQgcGh5IGxhbmVzCisgKiBAaHBkX3dvcms6IGhv
dCBwbHVnIGRldGVjdGlvbiB3b3JrZXIKKyAqIEBzdGF0dXM6IGNvbm5lY3Rpb24gc3RhdHVzCisg
KiBAZW5hYmxlZDogZmxhZyB0byBpbmRpY2F0ZSBpZiB0aGUgZGV2aWNlIGlzIGVuYWJsZWQKKyAq
IEBkcGNkOiBEUCBjb25maWd1cmF0aW9uIGRhdGEgZnJvbSBjdXJyZW50bHkgY29ubmVjdGVkIHNp
bmsgZGV2aWNlCisgKiBAbGlua19jb25maWc6IGNvbW1vbiBsaW5rIGNvbmZpZ3VyYXRpb24gYmV0
d2VlbiBJUCBjb3JlIGFuZCBzaW5rIGRldmljZQorICogQG1vZGU6IGN1cnJlbnQgbW9kZSBiZXR3
ZWVuIElQIGNvcmUgYW5kIHNpbmsgZGV2aWNlCisgKiBAdHJhaW5fc2V0OiBzZXQgb2YgdHJhaW5p
bmcgZGF0YQorICovCitzdHJ1Y3QgenlucW1wX2RwIHsKKwlzdHJ1Y3QgZHJtX2VuY29kZXIgZW5j
b2RlcjsKKwlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciBjb25uZWN0b3I7CisJc3RydWN0IGRldmljZSAq
ZGV2OworCXN0cnVjdCB6eW5xbXBfZHBzdWIgKmRwc3ViOworCXN0cnVjdCBkcm1fZGV2aWNlICpk
cm07CisJdm9pZCBfX2lvbWVtICppb21lbTsKKwlzdHJ1Y3QgcmVzZXRfY29udHJvbCAqcmVzZXQ7
CisJaW50IGlycTsKKworCXN0cnVjdCB6eW5xbXBfZHBfY29uZmlnIGNvbmZpZzsKKwlzdHJ1Y3Qg
ZHJtX2RwX2F1eCBhdXg7CisJc3RydWN0IHBoeSAqcGh5W1pZTlFNUF9EUF9NQVhfTEFORVNdOwor
CXU4IG51bV9sYW5lczsKKwlzdHJ1Y3QgZGVsYXllZF93b3JrIGhwZF93b3JrOworCWVudW0gZHJt
X2Nvbm5lY3Rvcl9zdGF0dXMgc3RhdHVzOworCWJvb2wgZW5hYmxlZDsKKworCXU4IGRwY2RbRFBf
UkVDRUlWRVJfQ0FQX1NJWkVdOworCXN0cnVjdCB6eW5xbXBfZHBfbGlua19jb25maWcgbGlua19j
b25maWc7CisJc3RydWN0IHp5bnFtcF9kcF9tb2RlIG1vZGU7CisJdTggdHJhaW5fc2V0W1pZTlFN
UF9EUF9NQVhfTEFORVNdOworfTsKKworc3RhdGljIGlubGluZSBzdHJ1Y3QgenlucW1wX2RwICpl
bmNvZGVyX3RvX2RwKHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcikKK3sKKwlyZXR1cm4gY29u
dGFpbmVyX29mKGVuY29kZXIsIHN0cnVjdCB6eW5xbXBfZHAsIGVuY29kZXIpOworfQorCitzdGF0
aWMgaW5saW5lIHN0cnVjdCB6eW5xbXBfZHAgKmNvbm5lY3Rvcl90b19kcChzdHJ1Y3QgZHJtX2Nv
bm5lY3RvciAqY29ubmVjdG9yKQoreworCXJldHVybiBjb250YWluZXJfb2YoY29ubmVjdG9yLCBz
dHJ1Y3QgenlucW1wX2RwLCBjb25uZWN0b3IpOworfQorCitzdGF0aWMgdm9pZCB6eW5xbXBfZHBf
d3JpdGUoc3RydWN0IHp5bnFtcF9kcCAqZHAsIGludCBvZmZzZXQsIHUzMiB2YWwpCit7CisJd3Jp
dGVsKHZhbCwgZHAtPmlvbWVtICsgb2Zmc2V0KTsKK30KKworc3RhdGljIHUzMiB6eW5xbXBfZHBf
cmVhZChzdHJ1Y3QgenlucW1wX2RwICpkcCwgaW50IG9mZnNldCkKK3sKKwlyZXR1cm4gcmVhZGwo
ZHAtPmlvbWVtICsgb2Zmc2V0KTsKK30KKworc3RhdGljIHZvaWQgenlucW1wX2RwX2NscihzdHJ1
Y3QgenlucW1wX2RwICpkcCwgaW50IG9mZnNldCwgdTMyIGNscikKK3sKKwl6eW5xbXBfZHBfd3Jp
dGUoZHAsIG9mZnNldCwgenlucW1wX2RwX3JlYWQoZHAsIG9mZnNldCkgJiB+Y2xyKTsKK30KKwor
c3RhdGljIHZvaWQgenlucW1wX2RwX3NldChzdHJ1Y3QgenlucW1wX2RwICpkcCwgaW50IG9mZnNl
dCwgdTMyIHNldCkKK3sKKwl6eW5xbXBfZHBfd3JpdGUoZHAsIG9mZnNldCwgenlucW1wX2RwX3Jl
YWQoZHAsIG9mZnNldCkgfCBzZXQpOworfQorCisvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICog
UEhZIEhhbmRsaW5nCisgKi8KKworI2RlZmluZSBSU1RfVElNRU9VVF9NUwkJCTEwMDAKKworc3Rh
dGljIGludCB6eW5xbXBfZHBfcmVzZXQoc3RydWN0IHp5bnFtcF9kcCAqZHAsIGJvb2wgYXNzZXJ0
KQoreworCXVuc2lnbmVkIGxvbmcgdGltZW91dDsKKworCWlmIChhc3NlcnQpCisJCXJlc2V0X2Nv
bnRyb2xfYXNzZXJ0KGRwLT5yZXNldCk7CisJZWxzZQorCQlyZXNldF9jb250cm9sX2RlYXNzZXJ0
KGRwLT5yZXNldCk7CisKKwkvKiBXYWl0IGZvciB0aGUgKGRlKWFzc2VydCB0byBjb21wbGV0ZS4g
Ki8KKwl0aW1lb3V0ID0gamlmZmllcyArIG1zZWNzX3RvX2ppZmZpZXMoUlNUX1RJTUVPVVRfTVMp
OworCXdoaWxlICghdGltZV9hZnRlcl9lcShqaWZmaWVzLCB0aW1lb3V0KSkgeworCQlib29sIHN0
YXR1cyA9ICEhcmVzZXRfY29udHJvbF9zdGF0dXMoZHAtPnJlc2V0KTsKKworCQlpZiAoYXNzZXJ0
ID09IHN0YXR1cykKKwkJCXJldHVybiAwOworCisJCWNwdV9yZWxheCgpOworCX0KKworCWRldl9l
cnIoZHAtPmRldiwgInJlc2V0ICVzIHRpbWVvdXRcbiIsIGFzc2VydCA/ICJhc3NlcnQiIDogImRl
YXNzZXJ0Iik7CisJcmV0dXJuIC1FVElNRURPVVQ7Cit9CisKKy8qKgorICogenlucW1wX2RwX3Bo
eV9pbml0IC0gSW5pdGlhbGl6ZSB0aGUgcGh5CisgKiBAZHA6IERpc3BsYXlQb3J0IElQIGNvcmUg
c3RydWN0dXJlCisgKgorICogSW5pdGlhbGl6ZSB0aGUgcGh5LgorICoKKyAqIFJldHVybjogMCBp
ZiB0aGUgcGh5IGluc3RhbmNlcyBhcmUgaW5pdGlhbGl6ZWQgY29ycmVjdGx5LCBvciB0aGUgZXJy
b3IgY29kZQorICogcmV0dXJuZWQgZnJvbSB0aGUgY2FsbGVlIGZ1bmN0aW9ucy4KKyAqLworc3Rh
dGljIGludCB6eW5xbXBfZHBfcGh5X2luaXQoc3RydWN0IHp5bnFtcF9kcCAqZHApCit7CisJaW50
IHJldDsKKwlpbnQgaTsKKworCWZvciAoaSA9IDA7IGkgPCBkcC0+bnVtX2xhbmVzOyBpKyspIHsK
KwkJcmV0ID0gcGh5X2luaXQoZHAtPnBoeVtpXSk7CisJCWlmIChyZXQpIHsKKwkJCWRldl9lcnIo
ZHAtPmRldiwgImZhaWxlZCB0byBpbml0IHBoeSBsYW5lICVkXG4iLCBpKTsKKwkJCXJldHVybiBy
ZXQ7CisJCX0KKwl9CisKKwlyZXQgPSB6eW5xbXBfZHBfcmVzZXQoZHAsIGZhbHNlKTsKKwlpZiAo
cmV0IDwgMCkKKwkJcmV0dXJuIHJldDsKKworCXp5bnFtcF9kcF9jbHIoZHAsIFpZTlFNUF9EUF9Q
SFlfUkVTRVQsIFpZTlFNUF9EUF9QSFlfUkVTRVRfQUxMX1JFU0VUKTsKKworCS8qCisJICogUG93
ZXIgb24gbGFuZXMgaW4gcmV2ZXJzZSBvcmRlciBhcyBvbmx5IGxhbmUgMCB3YWl0cyBmb3IgdGhl
IFBMTCB0bworCSAqIGxvY2suCisJICovCisJZm9yIChpID0gZHAtPm51bV9sYW5lcyAtIDE7IGkg
Pj0gMDsgaS0tKSB7CisJCXJldCA9IHBoeV9wb3dlcl9vbihkcC0+cGh5W2ldKTsKKwkJaWYgKHJl
dCkgeworCQkJZGV2X2VycihkcC0+ZGV2LCAiZmFpbGVkIHRvIHBvd2VyIG9uIHBoeSBsYW5lICVk
XG4iLCBpKTsKKwkJCXJldHVybiByZXQ7CisJCX0KKwl9CisKKwlyZXR1cm4gMDsKK30KKworLyoq
CisgKiB6eW5xbXBfZHBfcGh5X2V4aXQgLSBFeGl0IHRoZSBwaHkKKyAqIEBkcDogRGlzcGxheVBv
cnQgSVAgY29yZSBzdHJ1Y3R1cmUKKyAqCisgKiBFeGl0IHRoZSBwaHkuCisgKi8KK3N0YXRpYyB2
b2lkIHp5bnFtcF9kcF9waHlfZXhpdChzdHJ1Y3QgenlucW1wX2RwICpkcCkKK3sKKwl1bnNpZ25l
ZCBpbnQgaTsKKwlpbnQgcmV0OworCisJZm9yIChpID0gMDsgaSA8IGRwLT5udW1fbGFuZXM7IGkr
KykgeworCQlyZXQgPSBwaHlfcG93ZXJfb2ZmKGRwLT5waHlbaV0pOworCQlpZiAocmV0KQorCQkJ
ZGV2X2VycihkcC0+ZGV2LCAiZmFpbGVkIHRvIHBvd2VyIG9mZiBwaHkoJWQpICVkXG4iLCBpLAor
CQkJCXJldCk7CisJfQorCisJenlucW1wX2RwX3Jlc2V0KGRwLCB0cnVlKTsKKworCWZvciAoaSA9
IDA7IGkgPCBkcC0+bnVtX2xhbmVzOyBpKyspIHsKKwkJcmV0ID0gcGh5X2V4aXQoZHAtPnBoeVtp
XSk7CisJCWlmIChyZXQpCisJCQlkZXZfZXJyKGRwLT5kZXYsICJmYWlsZWQgdG8gZXhpdCBwaHko
JWQpICVkXG4iLCBpLCByZXQpOworCX0KK30KKworLyoqCisgKiB6eW5xbXBfZHBfcGh5X3Byb2Jl
IC0gUHJvYmUgdGhlIFBIWXMKKyAqIEBkcDogRGlzcGxheVBvcnQgSVAgY29yZSBzdHJ1Y3R1cmUK
KyAqCisgKiBQcm9iZSBQSFlzIGZvciBhbGwgbGFuZXMuIExlc3MgUEhZcyBtYXkgYmUgYXZhaWxh
YmxlIHRoYW4gdGhlIG51bWJlciBvZgorICogbGFuZXMsIHdoaWNoIGlzIG5vdCBjb25zaWRlcmVk
IGFuIGVycm9yIGFzIGxvbmcgYXMgYXQgbGVhc3Qgb25lIFBIWSBpcworICogZm91bmQuIFRoZSBj
YWxsZXIgY2FuIGNoZWNrIGRwLT5udW1fbGFuZXMgdG8gY2hlY2sgaG93IG1hbnkgUEhZcyB3ZXJl
IGZvdW5kLgorICoKKyAqIFJldHVybjoKKyAqICogMAkJCQktIFN1Y2Nlc3MKKyAqICogLUVOWElP
CQkJLSBObyBQSFkgZm91bmQKKyAqICogLUVQUk9CRV9ERUZFUgkJLSBQcm9iZSBkZWZlcnJhbCBy
ZXF1ZXN0ZWQKKyAqICogT3RoZXIgbmVnYXRpdmUgdmFsdWUJLSBQSFkgcmV0cmlldmFsIGZhaWx1
cmUKKyAqLworc3RhdGljIGludCB6eW5xbXBfZHBfcGh5X3Byb2JlKHN0cnVjdCB6eW5xbXBfZHAg
KmRwKQoreworCXVuc2lnbmVkIGludCBpOworCisJZm9yIChpID0gMDsgaSA8IFpZTlFNUF9EUF9N
QVhfTEFORVM7IGkrKykgeworCQljaGFyIHBoeV9uYW1lWzE2XTsKKwkJc3RydWN0IHBoeSAqcGh5
OworCisJCXNucHJpbnRmKHBoeV9uYW1lLCBzaXplb2YocGh5X25hbWUpLCAiZHAtcGh5JWQiLCBp
KTsKKwkJcGh5ID0gZGV2bV9waHlfZ2V0KGRwLT5kZXYsIHBoeV9uYW1lKTsKKworCQlpZiAoSVNf
RVJSKHBoeSkpIHsKKwkJCXN3aXRjaCAoUFRSX0VSUihwaHkpKSB7CisJCQljYXNlIC1FTk9ERVY6
CisJCQkJaWYgKGRwLT5udW1fbGFuZXMpCisJCQkJCXJldHVybiAwOworCisJCQkJZGV2X2Vycihk
cC0+ZGV2LCAibm8gUEhZIGZvdW5kXG4iKTsKKwkJCQlyZXR1cm4gLUVOWElPOworCisJCQljYXNl
IC1FUFJPQkVfREVGRVI6CisJCQkJcmV0dXJuIC1FUFJPQkVfREVGRVI7CisKKwkJCWRlZmF1bHQ6
CisJCQkJZGV2X2VycihkcC0+ZGV2LCAiZmFpbGVkIHRvIGdldCBQSFkgbGFuZSAldVxuIiwKKwkJ
CQkJaSk7CisJCQkJcmV0dXJuIFBUUl9FUlIocGh5KTsKKwkJCX0KKwkJfQorCisJCWRwLT5waHlb
aV0gPSBwaHk7CisJCWRwLT5udW1fbGFuZXMrKzsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworLyoq
CisgKiB6eW5xbXBfZHBfcGh5X3JlYWR5IC0gQ2hlY2sgaWYgUEhZIGlzIHJlYWR5CisgKiBAZHA6
IERpc3BsYXlQb3J0IElQIGNvcmUgc3RydWN0dXJlCisgKgorICogQ2hlY2sgaWYgUEhZIGlzIHJl
YWR5LiBJZiBQSFkgaXMgbm90IHJlYWR5LCB3YWl0IDFtcyB0byBjaGVjayBmb3IgMTAwIHRpbWVz
LgorICogVGhpcyBhbW91bnQgb2YgZGVsYXkgd2FzIHN1Z2dlc3RlZCBieSBJUCBkZXNpZ25lci4K
KyAqCisgKiBSZXR1cm46IDAgaWYgUEhZIGlzIHJlYWR5LCBvciAtRU5PREVWIGlmIFBIWSBpcyBu
b3QgcmVhZHkuCisgKi8KK3N0YXRpYyBpbnQgenlucW1wX2RwX3BoeV9yZWFkeShzdHJ1Y3Qgenlu
cW1wX2RwICpkcCkKK3sKKwl1MzIgaSwgcmVnLCByZWFkeTsKKworCXJlYWR5ID0gKDEgPDwgZHAt
Pm51bV9sYW5lcykgLSAxOworCisJLyogV2FpdCBmb3IgMTAwICogMW1zLiBUaGlzIHNob3VsZCBi
ZSBlbm91Z2ggdGltZSBmb3IgUEhZIHRvIGJlIHJlYWR5ICovCisJZm9yIChpID0gMDsgOyBpKysp
IHsKKwkJcmVnID0genlucW1wX2RwX3JlYWQoZHAsIFpZTlFNUF9EUF9QSFlfU1RBVFVTKTsKKwkJ
aWYgKChyZWcgJiByZWFkeSkgPT0gcmVhZHkpCisJCQlyZXR1cm4gMDsKKworCQlpZiAoaSA9PSAx
MDApIHsKKwkJCWRldl9lcnIoZHAtPmRldiwgIlBIWSBpc24ndCByZWFkeVxuIik7CisJCQlyZXR1
cm4gLUVOT0RFVjsKKwkJfQorCisJCXVzbGVlcF9yYW5nZSgxMDAwLCAxMTAwKTsKKwl9CisKKwly
ZXR1cm4gMDsKK30KKworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqIERpc3BsYXlQb3J0IExp
bmsgVHJhaW5pbmcKKyAqLworCisvKioKKyAqIHp5bnFtcF9kcF9tYXhfcmF0ZSAtIENhbGN1bGF0
ZSBhbmQgcmV0dXJuIGF2YWlsYWJsZSBtYXggcGl4ZWwgY2xvY2sKKyAqIEBsaW5rX3JhdGU6IGxp
bmsgcmF0ZSAoS2lsby1ieXRlcyAvIHNlYykKKyAqIEBsYW5lX251bTogbnVtYmVyIG9mIGxhbmVz
CisgKiBAYnBwOiBiaXRzIHBlciBwaXhlbAorICoKKyAqIFJldHVybjogbWF4IHBpeGVsIGNsb2Nr
IChLSHopIHN1cHBvcnRlZCBieSBjdXJyZW50IGxpbmsgY29uZmlnLgorICovCitzdGF0aWMgaW5s
aW5lIGludCB6eW5xbXBfZHBfbWF4X3JhdGUoaW50IGxpbmtfcmF0ZSwgdTggbGFuZV9udW0sIHU4
IGJwcCkKK3sKKwlyZXR1cm4gbGlua19yYXRlICogbGFuZV9udW0gKiA4IC8gYnBwOworfQorCisv
KioKKyAqIHp5bnFtcF9kcF9tb2RlX2NvbmZpZ3VyZSAtIENvbmZpZ3VyZSB0aGUgbGluayB2YWx1
ZXMKKyAqIEBkcDogRGlzcGxheVBvcnQgSVAgY29yZSBzdHJ1Y3R1cmUKKyAqIEBwY2xvY2s6IHBp
eGVsIGNsb2NrIGZvciByZXF1ZXN0ZWQgZGlzcGxheSBtb2RlCisgKiBAY3VycmVudF9idzogY3Vy
cmVudCBsaW5rIHJhdGUKKyAqCisgKiBGaW5kIHRoZSBsaW5rIGNvbmZpZ3VyYXRpb24gdmFsdWVz
LCByYXRlIGFuZCBsYW5lIGNvdW50IGZvciByZXF1ZXN0ZWQgcGl4ZWwKKyAqIGNsb2NrIEBwY2xv
Y2suIFRoZSBAcGNsb2NrIGlzIHN0b3JlZCBpbiB0aGUgbW9kZSB0byBiZSB1c2VkIGluIG90aGVy
CisgKiBmdW5jdGlvbnMgbGF0ZXIuIFRoZSByZXR1cm5lZCByYXRlIGlzIGRvd25zaGlmdGVkIGZy
b20gdGhlIGN1cnJlbnQgcmF0ZQorICogQGN1cnJlbnRfYncuCisgKgorICogUmV0dXJuOiBDdXJy
ZW50IGxpbmsgcmF0ZSBjb2RlLCBvciAtRUlOVkFMLgorICovCitzdGF0aWMgaW50IHp5bnFtcF9k
cF9tb2RlX2NvbmZpZ3VyZShzdHJ1Y3QgenlucW1wX2RwICpkcCwgaW50IHBjbG9jaywKKwkJCQkg
ICAgdTggY3VycmVudF9idykKK3sKKwlpbnQgbWF4X3JhdGUgPSBkcC0+bGlua19jb25maWcubWF4
X3JhdGU7CisJdTggYndzWzNdID0geyBEUF9MSU5LX0JXXzFfNjIsIERQX0xJTktfQldfMl83LCBE
UF9MSU5LX0JXXzVfNCB9OworCXU4IG1heF9sYW5lcyA9IGRwLT5saW5rX2NvbmZpZy5tYXhfbGFu
ZXM7CisJdTggbWF4X2xpbmtfcmF0ZV9jb2RlID0gZHJtX2RwX2xpbmtfcmF0ZV90b19id19jb2Rl
KG1heF9yYXRlKTsKKwl1OCBicHAgPSBkcC0+Y29uZmlnLmJwcDsKKwl1OCBsYW5lX2NudDsKKwlz
OCBpOworCisJaWYgKGN1cnJlbnRfYncgPT0gRFBfTElOS19CV18xXzYyKSB7CisJCWRldl9lcnIo
ZHAtPmRldiwgImNhbid0IGRvd25zaGlmdC4gYWxyZWFkeSBsb3dlc3QgbGluayByYXRlXG4iKTsK
KwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJZm9yIChpID0gQVJSQVlfU0laRShid3MpIC0gMTsg
aSA+PSAwOyBpLS0pIHsKKwkJaWYgKGN1cnJlbnRfYncgJiYgYndzW2ldID49IGN1cnJlbnRfYncp
CisJCQljb250aW51ZTsKKworCQlpZiAoYndzW2ldIDw9IG1heF9saW5rX3JhdGVfY29kZSkKKwkJ
CWJyZWFrOworCX0KKworCWZvciAobGFuZV9jbnQgPSAxOyBsYW5lX2NudCA8PSBtYXhfbGFuZXM7
IGxhbmVfY250IDw8PSAxKSB7CisJCWludCBidzsKKwkJdTMyIHJhdGU7CisKKwkJYncgPSBkcm1f
ZHBfYndfY29kZV90b19saW5rX3JhdGUoYndzW2ldKTsKKwkJcmF0ZSA9IHp5bnFtcF9kcF9tYXhf
cmF0ZShidywgbGFuZV9jbnQsIGJwcCk7CisJCWlmIChwY2xvY2sgPD0gcmF0ZSkgeworCQkJZHAt
Pm1vZGUuYndfY29kZSA9IGJ3c1tpXTsKKwkJCWRwLT5tb2RlLmxhbmVfY250ID0gbGFuZV9jbnQ7
CisJCQlkcC0+bW9kZS5wY2xvY2sgPSBwY2xvY2s7CisJCQlyZXR1cm4gZHAtPm1vZGUuYndfY29k
ZTsKKwkJfQorCX0KKworCWRldl9lcnIoZHAtPmRldiwgImZhaWxlZCB0byBjb25maWd1cmUgbGlu
ayB2YWx1ZXNcbiIpOworCisJcmV0dXJuIC1FSU5WQUw7Cit9CisKKy8qKgorICogenlucW1wX2Rw
X2FkanVzdF90cmFpbiAtIEFkanVzdCB0cmFpbiB2YWx1ZXMKKyAqIEBkcDogRGlzcGxheVBvcnQg
SVAgY29yZSBzdHJ1Y3R1cmUKKyAqIEBsaW5rX3N0YXR1czogbGluayBzdGF0dXMgZnJvbSBzaW5r
IHdoaWNoIGNvbnRhaW5zIHJlcXVlc3RlZCB0cmFpbmluZyB2YWx1ZXMKKyAqLworc3RhdGljIHZv
aWQgenlucW1wX2RwX2FkanVzdF90cmFpbihzdHJ1Y3QgenlucW1wX2RwICpkcCwKKwkJCQkgICB1
OCBsaW5rX3N0YXR1c1tEUF9MSU5LX1NUQVRVU19TSVpFXSkKK3sKKwl1OCAqdHJhaW5fc2V0ID0g
ZHAtPnRyYWluX3NldDsKKwl1OCB2b2x0YWdlID0gMCwgcHJlZW1waGFzaXMgPSAwOworCXU4IGk7
CisKKwlmb3IgKGkgPSAwOyBpIDwgZHAtPm1vZGUubGFuZV9jbnQ7IGkrKykgeworCQl1OCB2ID0g
ZHJtX2RwX2dldF9hZGp1c3RfcmVxdWVzdF92b2x0YWdlKGxpbmtfc3RhdHVzLCBpKTsKKwkJdTgg
cCA9IGRybV9kcF9nZXRfYWRqdXN0X3JlcXVlc3RfcHJlX2VtcGhhc2lzKGxpbmtfc3RhdHVzLCBp
KTsKKworCQlpZiAodiA+IHZvbHRhZ2UpCisJCQl2b2x0YWdlID0gdjsKKworCQlpZiAocCA+IHBy
ZWVtcGhhc2lzKQorCQkJcHJlZW1waGFzaXMgPSBwOworCX0KKworCWlmICh2b2x0YWdlID49IERQ
X1RSQUlOX1ZPTFRBR0VfU1dJTkdfTEVWRUxfMykKKwkJdm9sdGFnZSB8PSBEUF9UUkFJTl9NQVhf
U1dJTkdfUkVBQ0hFRDsKKworCWlmIChwcmVlbXBoYXNpcyA+PSBEUF9UUkFJTl9QUkVfRU1QSF9M
RVZFTF8yKQorCQlwcmVlbXBoYXNpcyB8PSBEUF9UUkFJTl9NQVhfUFJFX0VNUEhBU0lTX1JFQUNI
RUQ7CisKKwlmb3IgKGkgPSAwOyBpIDwgZHAtPm1vZGUubGFuZV9jbnQ7IGkrKykKKwkJdHJhaW5f
c2V0W2ldID0gdm9sdGFnZSB8IHByZWVtcGhhc2lzOworfQorCisvKioKKyAqIHp5bnFtcF9kcF91
cGRhdGVfdnNfZW1waCAtIFVwZGF0ZSB0aGUgdHJhaW5pbmcgdmFsdWVzCisgKiBAZHA6IERpc3Bs
YXlQb3J0IElQIGNvcmUgc3RydWN0dXJlCisgKgorICogVXBkYXRlIHRoZSB0cmFpbmluZyB2YWx1
ZXMgYmFzZWQgb24gdGhlIHJlcXVlc3QgZnJvbSBzaW5rLiBUaGUgbWFwcGVkIHZhbHVlcworICog
YXJlIHByZWRlZmluZWQsIGFuZCB2YWx1ZXModnMsIHBlLCBwYykgYXJlIGZyb20gdGhlIGRldmlj
ZSBtYW51YWwuCisgKgorICogUmV0dXJuOiAwIGlmIHZzIGFuZCBlbXBoIGFyZSB1cGRhdGVkIHN1
Y2Nlc3NmdWxseSwgb3IgdGhlIGVycm9yIGNvZGUgcmV0dXJuZWQKKyAqIGJ5IGRybV9kcF9kcGNk
X3dyaXRlKCkuCisgKi8KK3N0YXRpYyBpbnQgenlucW1wX2RwX3VwZGF0ZV92c19lbXBoKHN0cnVj
dCB6eW5xbXBfZHAgKmRwKQoreworCXVuc2lnbmVkIGludCBpOworCWludCByZXQ7CisKKwlyZXQg
PSBkcm1fZHBfZHBjZF93cml0ZSgmZHAtPmF1eCwgRFBfVFJBSU5JTkdfTEFORTBfU0VULCBkcC0+
dHJhaW5fc2V0LAorCQkJCWRwLT5tb2RlLmxhbmVfY250KTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0
dXJuIHJldDsKKworCWZvciAoaSA9IDA7IGkgPCBkcC0+bW9kZS5sYW5lX2NudDsgaSsrKSB7CisJ
CXUzMiByZWcgPSBaWU5RTVBfRFBfU1VCX1RYX1BIWV9QUkVDVVJTT1JfTEFORV8wICsgaSAqIDQ7
CisJCXVuaW9uIHBoeV9jb25maWd1cmVfb3B0cyBvcHRzID0geyAwIH07CisJCXU4IHRyYWluID0g
ZHAtPnRyYWluX3NldFtpXTsKKworCQlvcHRzLmRwLnZvbHRhZ2VbMF0gPSAodHJhaW4gJiBEUF9U
UkFJTl9WT0xUQUdFX1NXSU5HX01BU0spCisJCQkJICAgPj4gRFBfVFJBSU5fVk9MVEFHRV9TV0lO
R19TSElGVDsKKwkJb3B0cy5kcC5wcmVbMF0gPSAodHJhaW4gJiBEUF9UUkFJTl9QUkVfRU1QSEFT
SVNfTUFTSykKKwkJCSAgICAgICA+PiBEUF9UUkFJTl9QUkVfRU1QSEFTSVNfU0hJRlQ7CisKKwkJ
cGh5X2NvbmZpZ3VyZShkcC0+cGh5W2ldLCAmb3B0cyk7CisKKwkJenlucW1wX2RwX3dyaXRlKGRw
LCByZWcsIDB4Mik7CisJfQorCisJcmV0dXJuIDA7Cit9CisKKy8qKgorICogenlucW1wX2RwX2xp
bmtfdHJhaW5fY3IgLSBUcmFpbiBjbG9jayByZWNvdmVyeQorICogQGRwOiBEaXNwbGF5UG9ydCBJ
UCBjb3JlIHN0cnVjdHVyZQorICoKKyAqIFJldHVybjogMCBpZiBjbG9jayByZWNvdmVyeSB0cmFp
biBpcyBkb25lIHN1Y2Nlc3NmdWxseSwgb3IgY29ycmVzcG9uZGluZworICogZXJyb3IgY29kZS4K
KyAqLworc3RhdGljIGludCB6eW5xbXBfZHBfbGlua190cmFpbl9jcihzdHJ1Y3QgenlucW1wX2Rw
ICpkcCkKK3sKKwl1OCBsaW5rX3N0YXR1c1tEUF9MSU5LX1NUQVRVU19TSVpFXTsKKwl1OCBsYW5l
X2NudCA9IGRwLT5tb2RlLmxhbmVfY250OworCXU4IHZzID0gMCwgdHJpZXMgPSAwOworCXUxNiBt
YXhfdHJpZXMsIGk7CisJYm9vbCBjcl9kb25lOworCWludCByZXQ7CisKKwl6eW5xbXBfZHBfd3Jp
dGUoZHAsIFpZTlFNUF9EUF9UUkFJTklOR19QQVRURVJOX1NFVCwKKwkJCURQX1RSQUlOSU5HX1BB
VFRFUk5fMSk7CisJcmV0ID0gZHJtX2RwX2RwY2Rfd3JpdGViKCZkcC0+YXV4LCBEUF9UUkFJTklO
R19QQVRURVJOX1NFVCwKKwkJCQkgRFBfVFJBSU5JTkdfUEFUVEVSTl8xIHwKKwkJCQkgRFBfTElO
S19TQ1JBTUJMSU5HX0RJU0FCTEUpOworCWlmIChyZXQgPCAwKQorCQlyZXR1cm4gcmV0OworCisJ
LyoKKwkgKiAyNTYgbG9vcHMgc2hvdWxkIGJlIG1heGltdW0gaXRlcmF0aW9ucyBmb3IgNCBsYW5l
cyBhbmQgNCB2YWx1ZXMuCisJICogU28sIFRoaXMgbG9vcCBzaG91bGQgZXhpdCBiZWZvcmUgNTEy
IGl0ZXJhdGlvbnMKKwkgKi8KKwlmb3IgKG1heF90cmllcyA9IDA7IG1heF90cmllcyA8IDUxMjsg
bWF4X3RyaWVzKyspIHsKKwkJcmV0ID0genlucW1wX2RwX3VwZGF0ZV92c19lbXBoKGRwKTsKKwkJ
aWYgKHJldCkKKwkJCXJldHVybiByZXQ7CisKKwkJZHJtX2RwX2xpbmtfdHJhaW5fY2xvY2tfcmVj
b3ZlcnlfZGVsYXkoZHAtPmRwY2QpOworCQlyZXQgPSBkcm1fZHBfZHBjZF9yZWFkX2xpbmtfc3Rh
dHVzKCZkcC0+YXV4LCBsaW5rX3N0YXR1cyk7CisJCWlmIChyZXQgPCAwKQorCQkJcmV0dXJuIHJl
dDsKKworCQljcl9kb25lID0gZHJtX2RwX2Nsb2NrX3JlY292ZXJ5X29rKGxpbmtfc3RhdHVzLCBs
YW5lX2NudCk7CisJCWlmIChjcl9kb25lKQorCQkJYnJlYWs7CisKKwkJZm9yIChpID0gMDsgaSA8
IGxhbmVfY250OyBpKyspCisJCQlpZiAoIShkcC0+dHJhaW5fc2V0W2ldICYgRFBfVFJBSU5fTUFY
X1NXSU5HX1JFQUNIRUQpKQorCQkJCWJyZWFrOworCQlpZiAoaSA9PSBsYW5lX2NudCkKKwkJCWJy
ZWFrOworCisJCWlmICgoZHAtPnRyYWluX3NldFswXSAmIERQX1RSQUlOX1ZPTFRBR0VfU1dJTkdf
TUFTSykgPT0gdnMpCisJCQl0cmllcysrOworCQllbHNlCisJCQl0cmllcyA9IDA7CisKKwkJaWYg
KHRyaWVzID09IERQX01BWF9UUkFJTklOR19UUklFUykKKwkJCWJyZWFrOworCisJCXZzID0gZHAt
PnRyYWluX3NldFswXSAmIERQX1RSQUlOX1ZPTFRBR0VfU1dJTkdfTUFTSzsKKwkJenlucW1wX2Rw
X2FkanVzdF90cmFpbihkcCwgbGlua19zdGF0dXMpOworCX0KKworCWlmICghY3JfZG9uZSkKKwkJ
cmV0dXJuIC1FSU87CisKKwlyZXR1cm4gMDsKK30KKworLyoqCisgKiB6eW5xbXBfZHBfbGlua190
cmFpbl9jZSAtIFRyYWluIGNoYW5uZWwgZXF1YWxpemF0aW9uCisgKiBAZHA6IERpc3BsYXlQb3J0
IElQIGNvcmUgc3RydWN0dXJlCisgKgorICogUmV0dXJuOiAwIGlmIGNoYW5uZWwgZXF1YWxpemF0
aW9uIHRyYWluIGlzIGRvbmUgc3VjY2Vzc2Z1bGx5LCBvcgorICogY29ycmVzcG9uZGluZyBlcnJv
ciBjb2RlLgorICovCitzdGF0aWMgaW50IHp5bnFtcF9kcF9saW5rX3RyYWluX2NlKHN0cnVjdCB6
eW5xbXBfZHAgKmRwKQoreworCXU4IGxpbmtfc3RhdHVzW0RQX0xJTktfU1RBVFVTX1NJWkVdOwor
CXU4IGxhbmVfY250ID0gZHAtPm1vZGUubGFuZV9jbnQ7CisJdTMyIHBhdCwgdHJpZXM7CisJaW50
IHJldDsKKwlib29sIGNlX2RvbmU7CisKKwlpZiAoZHAtPmRwY2RbRFBfRFBDRF9SRVZdID49IERQ
X1YxXzIgJiYKKwkgICAgZHAtPmRwY2RbRFBfTUFYX0xBTkVfQ09VTlRdICYgRFBfVFBTM19TVVBQ
T1JURUQpCisJCXBhdCA9IERQX1RSQUlOSU5HX1BBVFRFUk5fMzsKKwllbHNlCisJCXBhdCA9IERQ
X1RSQUlOSU5HX1BBVFRFUk5fMjsKKworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX1RS
QUlOSU5HX1BBVFRFUk5fU0VULCBwYXQpOworCXJldCA9IGRybV9kcF9kcGNkX3dyaXRlYigmZHAt
PmF1eCwgRFBfVFJBSU5JTkdfUEFUVEVSTl9TRVQsCisJCQkJIHBhdCB8IERQX0xJTktfU0NSQU1C
TElOR19ESVNBQkxFKTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0dXJuIHJldDsKKworCWZvciAodHJp
ZXMgPSAwOyB0cmllcyA8IERQX01BWF9UUkFJTklOR19UUklFUzsgdHJpZXMrKykgeworCQlyZXQg
PSB6eW5xbXBfZHBfdXBkYXRlX3ZzX2VtcGgoZHApOworCQlpZiAocmV0KQorCQkJcmV0dXJuIHJl
dDsKKworCQlkcm1fZHBfbGlua190cmFpbl9jaGFubmVsX2VxX2RlbGF5KGRwLT5kcGNkKTsKKwkJ
cmV0ID0gZHJtX2RwX2RwY2RfcmVhZF9saW5rX3N0YXR1cygmZHAtPmF1eCwgbGlua19zdGF0dXMp
OworCQlpZiAocmV0IDwgMCkKKwkJCXJldHVybiByZXQ7CisKKwkJY2VfZG9uZSA9IGRybV9kcF9j
aGFubmVsX2VxX29rKGxpbmtfc3RhdHVzLCBsYW5lX2NudCk7CisJCWlmIChjZV9kb25lKQorCQkJ
YnJlYWs7CisKKwkJenlucW1wX2RwX2FkanVzdF90cmFpbihkcCwgbGlua19zdGF0dXMpOworCX0K
KworCWlmICghY2VfZG9uZSkKKwkJcmV0dXJuIC1FSU87CisKKwlyZXR1cm4gMDsKK30KKworLyoq
CisgKiB6eW5xbXBfZHBfbGlua190cmFpbiAtIFRyYWluIHRoZSBsaW5rCisgKiBAZHA6IERpc3Bs
YXlQb3J0IElQIGNvcmUgc3RydWN0dXJlCisgKgorICogUmV0dXJuOiAwIGlmIGFsbCB0cmFpbnMg
YXJlIGRvbmUgc3VjY2Vzc2Z1bGx5LCBvciBjb3JyZXNwb25kaW5nIGVycm9yIGNvZGUuCisgKi8K
K3N0YXRpYyBpbnQgenlucW1wX2RwX3RyYWluKHN0cnVjdCB6eW5xbXBfZHAgKmRwKQoreworCXUz
MiByZWc7CisJdTggYndfY29kZSA9IGRwLT5tb2RlLmJ3X2NvZGU7CisJdTggbGFuZV9jbnQgPSBk
cC0+bW9kZS5sYW5lX2NudDsKKwl1OCBhdXhfbGFuZV9jbnQgPSBsYW5lX2NudDsKKwlib29sIGVu
aGFuY2VkOworCWludCByZXQ7CisKKwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9MQU5F
X0NPVU5UX1NFVCwgbGFuZV9jbnQpOworCWVuaGFuY2VkID0gZHJtX2RwX2VuaGFuY2VkX2ZyYW1l
X2NhcChkcC0+ZHBjZCk7CisJaWYgKGVuaGFuY2VkKSB7CisJCXp5bnFtcF9kcF93cml0ZShkcCwg
WllOUU1QX0RQX0VOSEFOQ0VEX0ZSQU1FX0VOLCAxKTsKKwkJYXV4X2xhbmVfY250IHw9IERQX0xB
TkVfQ09VTlRfRU5IQU5DRURfRlJBTUVfRU47CisJfQorCisJaWYgKGRwLT5kcGNkWzNdICYgMHgx
KSB7CisJCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX0RPV05TUFJFQURfQ1RMLCAxKTsK
KwkJZHJtX2RwX2RwY2Rfd3JpdGViKCZkcC0+YXV4LCBEUF9ET1dOU1BSRUFEX0NUUkwsCisJCQkJ
ICAgRFBfU1BSRUFEX0FNUF8wXzUpOworCX0gZWxzZSB7CisJCXp5bnFtcF9kcF93cml0ZShkcCwg
WllOUU1QX0RQX0RPV05TUFJFQURfQ1RMLCAwKTsKKwkJZHJtX2RwX2RwY2Rfd3JpdGViKCZkcC0+
YXV4LCBEUF9ET1dOU1BSRUFEX0NUUkwsIDApOworCX0KKworCXJldCA9IGRybV9kcF9kcGNkX3dy
aXRlYigmZHAtPmF1eCwgRFBfTEFORV9DT1VOVF9TRVQsIGF1eF9sYW5lX2NudCk7CisJaWYgKHJl
dCA8IDApIHsKKwkJZGV2X2VycihkcC0+ZGV2LCAiZmFpbGVkIHRvIHNldCBsYW5lIGNvdW50XG4i
KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXQgPSBkcm1fZHBfZHBjZF93cml0ZWIoJmRwLT5h
dXgsIERQX01BSU5fTElOS19DSEFOTkVMX0NPRElOR19TRVQsCisJCQkJIERQX1NFVF9BTlNJXzhC
MTBCKTsKKwlpZiAocmV0IDwgMCkgeworCQlkZXZfZXJyKGRwLT5kZXYsICJmYWlsZWQgdG8gc2V0
IEFOU0kgOEIvMTBCIGVuY29kaW5nXG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXQgPSBk
cm1fZHBfZHBjZF93cml0ZWIoJmRwLT5hdXgsIERQX0xJTktfQldfU0VULCBid19jb2RlKTsKKwlp
ZiAocmV0IDwgMCkgeworCQlkZXZfZXJyKGRwLT5kZXYsICJmYWlsZWQgdG8gc2V0IERQIGJhbmR3
aWR0aFxuIik7CisJCXJldHVybiByZXQ7CisJfQorCisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5R
TVBfRFBfTElOS19CV19TRVQsIGJ3X2NvZGUpOworCXN3aXRjaCAoYndfY29kZSkgeworCWNhc2Ug
RFBfTElOS19CV18xXzYyOgorCQlyZWcgPSBaWU5RTVBfRFBfUEhZX0NMT0NLX1NFTEVDVF8xXzYy
RzsKKwkJYnJlYWs7CisJY2FzZSBEUF9MSU5LX0JXXzJfNzoKKwkJcmVnID0gWllOUU1QX0RQX1BI
WV9DTE9DS19TRUxFQ1RfMl83MEc7CisJCWJyZWFrOworCWNhc2UgRFBfTElOS19CV181XzQ6CisJ
ZGVmYXVsdDoKKwkJcmVnID0gWllOUU1QX0RQX1BIWV9DTE9DS19TRUxFQ1RfNV80MEc7CisJCWJy
ZWFrOworCX0KKworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX1BIWV9DTE9DS19TRUxF
Q1QsIHJlZyk7CisJcmV0ID0genlucW1wX2RwX3BoeV9yZWFkeShkcCk7CisJaWYgKHJldCA8IDAp
CisJCXJldHVybiByZXQ7CisKKwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9TQ1JBTUJM
SU5HX0RJU0FCTEUsIDEpOworCW1lbXNldChkcC0+dHJhaW5fc2V0LCAwLCA0KTsKKwlyZXQgPSB6
eW5xbXBfZHBfbGlua190cmFpbl9jcihkcCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKwor
CXJldCA9IHp5bnFtcF9kcF9saW5rX3RyYWluX2NlKGRwKTsKKwlpZiAocmV0KQorCQlyZXR1cm4g
cmV0OworCisJcmV0ID0gZHJtX2RwX2RwY2Rfd3JpdGViKCZkcC0+YXV4LCBEUF9UUkFJTklOR19Q
QVRURVJOX1NFVCwKKwkJCQkgRFBfVFJBSU5JTkdfUEFUVEVSTl9ESVNBQkxFKTsKKwlpZiAocmV0
IDwgMCkgeworCQlkZXZfZXJyKGRwLT5kZXYsICJmYWlsZWQgdG8gZGlzYWJsZSB0cmFpbmluZyBw
YXR0ZXJuXG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5R
TVBfRFBfVFJBSU5JTkdfUEFUVEVSTl9TRVQsCisJCQlEUF9UUkFJTklOR19QQVRURVJOX0RJU0FC
TEUpOworCisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfU0NSQU1CTElOR19ESVNBQkxF
LCAwKTsKKworCXJldHVybiAwOworfQorCisvKioKKyAqIHp5bnFtcF9kcF90cmFpbl9sb29wIC0g
RG93bnNoaWZ0IHRoZSBsaW5rIHJhdGUgZHVyaW5nIHRyYWluaW5nCisgKiBAZHA6IERpc3BsYXlQ
b3J0IElQIGNvcmUgc3RydWN0dXJlCisgKgorICogVHJhaW4gdGhlIGxpbmsgYnkgZG93bnNoaWZ0
aW5nIHRoZSBsaW5rIHJhdGUgaWYgdHJhaW5pbmcgaXMgbm90IHN1Y2Nlc3NmdWwuCisgKi8KK3N0
YXRpYyB2b2lkIHp5bnFtcF9kcF90cmFpbl9sb29wKHN0cnVjdCB6eW5xbXBfZHAgKmRwKQorewor
CXN0cnVjdCB6eW5xbXBfZHBfbW9kZSAqbW9kZSA9ICZkcC0+bW9kZTsKKwl1OCBidyA9IG1vZGUt
PmJ3X2NvZGU7CisJaW50IHJldDsKKworCWRvIHsKKwkJaWYgKGRwLT5zdGF0dXMgPT0gY29ubmVj
dG9yX3N0YXR1c19kaXNjb25uZWN0ZWQgfHwKKwkJICAgICFkcC0+ZW5hYmxlZCkKKwkJCXJldHVy
bjsKKworCQlyZXQgPSB6eW5xbXBfZHBfdHJhaW4oZHApOworCQlpZiAoIXJldCkKKwkJCXJldHVy
bjsKKworCQlyZXQgPSB6eW5xbXBfZHBfbW9kZV9jb25maWd1cmUoZHAsIG1vZGUtPnBjbG9jaywg
YncpOworCQlpZiAocmV0IDwgMCkKKwkJCWdvdG8gZXJyX291dDsKKworCQlidyA9IHJldDsKKwl9
IHdoaWxlIChidyA+PSBEUF9MSU5LX0JXXzFfNjIpOworCitlcnJfb3V0OgorCWRldl9lcnIoZHAt
PmRldiwgImZhaWxlZCB0byB0cmFpbiB0aGUgRFAgbGlua1xuIik7Cit9CisKKy8qIC0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tCisgKiBEaXNwbGF5UG9ydCBBVVgKKyAqLworCisjZGVmaW5lIEFVWF9SRUFE
X0JJVAkweDEKKworLyoqCisgKiB6eW5xbXBfZHBfYXV4X2NtZF9zdWJtaXQgLSBTdWJtaXQgYXV4
IGNvbW1hbmQKKyAqIEBkcDogRGlzcGxheVBvcnQgSVAgY29yZSBzdHJ1Y3R1cmUKKyAqIEBjbWQ6
IGF1eCBjb21tYW5kCisgKiBAYWRkcjogYXV4IGFkZHJlc3MKKyAqIEBidWY6IGJ1ZmZlciBmb3Ig
Y29tbWFuZCBkYXRhCisgKiBAYnl0ZXM6IG51bWJlciBvZiBieXRlcyBmb3IgQGJ1ZgorICogQHJl
cGx5OiByZXBseSBjb2RlIHRvIGJlIHJldHVybmVkCisgKgorICogU3VibWl0IGFuIGF1eCBjb21t
YW5kLiBBbGwgYXV4IHJlbGF0ZWQgY29tbWFuZHMsIG5hdGl2ZSBvciBpMmMgYXV4CisgKiByZWFk
L3dyaXRlLCBhcmUgc3VibWl0dGVkIHRocm91Z2ggdGhpcyBmdW5jdGlvbi4gVGhlIGZ1bmN0aW9u
IGlzIG1hcHBlZCB0bworICogdGhlIHRyYW5zZmVyIGZ1bmN0aW9uIG9mIHN0cnVjdCBkcm1fZHBf
YXV4LiBUaGlzIGZ1bmN0aW9uIGludm9sdmVzIGluCisgKiBtdWx0aXBsZSByZWdpc3RlciByZWFk
cy93cml0ZXMsIHRodXMgc3luY2hyb25pemF0aW9uIGlzIG5lZWRlZCwgYW5kIGl0IGlzCisgKiBk
b25lIGJ5IGRybV9kcF9oZWxwZXIgdXNpbmcgQGh3X211dGV4LiBUaGUgY2FsbGluZyB0aHJlYWQg
Z29lcyBpbnRvIHNsZWVwCisgKiBpZiB0aGVyZSdzIG5vIGltbWVkaWF0ZSByZXBseSB0byB0aGUg
Y29tbWFuZCBzdWJtaXNzaW9uLiBUaGUgcmVwbHkgY29kZSBpcworICogcmV0dXJuZWQgYXQgQHJl
cGx5IGlmIEByZXBseSAhPSBOVUxMLgorICoKKyAqIFJldHVybjogMCBpZiB0aGUgY29tbWFuZCBp
cyBzdWJtaXR0ZWQgcHJvcGVybHksIG9yIGNvcnJlc3BvbmRpbmcgZXJyb3IgY29kZToKKyAqIC1F
QlVTWSB3aGVuIHRoZXJlIGlzIGFueSByZXF1ZXN0IGFscmVhZHkgYmVpbmcgcHJvY2Vzc2VkCisg
KiAtRVRJTUVET1VUIHdoZW4gcmVjZWl2aW5nIHJlcGx5IGlzIHRpbWVkIG91dAorICogLUVJTyB3
aGVuIHJlY2VpdmVkIGJ5dGVzIGFyZSBsZXNzIHRoYW4gcmVxdWVzdGVkCisgKi8KK3N0YXRpYyBp
bnQgenlucW1wX2RwX2F1eF9jbWRfc3VibWl0KHN0cnVjdCB6eW5xbXBfZHAgKmRwLCB1MzIgY21k
LCB1MTYgYWRkciwKKwkJCQkgICAgdTggKmJ1ZiwgdTggYnl0ZXMsIHU4ICpyZXBseSkKK3sKKwli
b29sIGlzX3JlYWQgPSAoY21kICYgQVVYX1JFQURfQklUKSA/IHRydWUgOiBmYWxzZTsKKwl1MzIg
cmVnLCBpOworCisJcmVnID0genlucW1wX2RwX3JlYWQoZHAsIFpZTlFNUF9EUF9JTlRFUlJVUFRf
U0lHTkFMX1NUQVRFKTsKKwlpZiAocmVnICYgWllOUU1QX0RQX0lOVEVSUlVQVF9TSUdOQUxfU1RB
VEVfUkVRVUVTVCkKKwkJcmV0dXJuIC1FQlVTWTsKKworCXp5bnFtcF9kcF93cml0ZShkcCwgWllO
UU1QX0RQX0FVWF9BRERSRVNTLCBhZGRyKTsKKwlpZiAoIWlzX3JlYWQpCisJCWZvciAoaSA9IDA7
IGkgPCBieXRlczsgaSsrKQorCQkJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfQVVYX1dS
SVRFX0ZJRk8sCisJCQkJCWJ1ZltpXSk7CisKKwlyZWcgPSBjbWQgPDwgWllOUU1QX0RQX0FVWF9D
T01NQU5EX0NNRF9TSElGVDsKKwlpZiAoIWJ1ZiB8fCAhYnl0ZXMpCisJCXJlZyB8PSBaWU5RTVBf
RFBfQVVYX0NPTU1BTkRfQUREUkVTU19PTkxZOworCWVsc2UKKwkJcmVnIHw9IChieXRlcyAtIDEp
IDw8IFpZTlFNUF9EUF9BVVhfQ09NTUFORF9CWVRFU19TSElGVDsKKwl6eW5xbXBfZHBfd3JpdGUo
ZHAsIFpZTlFNUF9EUF9BVVhfQ09NTUFORCwgcmVnKTsKKworCS8qIFdhaXQgZm9yIHJlcGx5IHRv
IGJlIGRlbGl2ZXJlZCB1cHRvIDJtcyAqLworCWZvciAoaSA9IDA7IDsgaSsrKSB7CisJCXJlZyA9
IHp5bnFtcF9kcF9yZWFkKGRwLCBaWU5RTVBfRFBfSU5URVJSVVBUX1NJR05BTF9TVEFURSk7CisJ
CWlmIChyZWcgJiBaWU5RTVBfRFBfSU5URVJSVVBUX1NJR05BTF9TVEFURV9SRVBMWSkKKwkJCWJy
ZWFrOworCisJCWlmIChyZWcgJiBaWU5RTVBfRFBfSU5URVJSVVBUX1NJR05BTF9TVEFURV9SRVBM
WV9USU1FT1VUIHx8CisJCSAgICBpID09IDIpCisJCQlyZXR1cm4gLUVUSU1FRE9VVDsKKworCQl1
c2xlZXBfcmFuZ2UoMTAwMCwgMTEwMCk7CisJfQorCisJcmVnID0genlucW1wX2RwX3JlYWQoZHAs
IFpZTlFNUF9EUF9BVVhfUkVQTFlfQ09ERSk7CisJaWYgKHJlcGx5KQorCQkqcmVwbHkgPSByZWc7
CisKKwlpZiAoaXNfcmVhZCAmJgorCSAgICAocmVnID09IFpZTlFNUF9EUF9BVVhfUkVQTFlfQ09E
RV9BVVhfQUNLIHx8CisJICAgICByZWcgPT0gWllOUU1QX0RQX0FVWF9SRVBMWV9DT0RFX0kyQ19B
Q0spKSB7CisJCXJlZyA9IHp5bnFtcF9kcF9yZWFkKGRwLCBaWU5RTVBfRFBfUkVQTFlfREFUQV9D
T1VOVCk7CisJCWlmICgocmVnICYgWllOUU1QX0RQX1JFUExZX0RBVEFfQ09VTlRfTUFTSykgIT0g
Ynl0ZXMpCisJCQlyZXR1cm4gLUVJTzsKKworCQlmb3IgKGkgPSAwOyBpIDwgYnl0ZXM7IGkrKykK
KwkJCWJ1ZltpXSA9IHp5bnFtcF9kcF9yZWFkKGRwLCBaWU5RTVBfRFBfQVVYX1JFUExZX0RBVEEp
OworCX0KKworCXJldHVybiAwOworfQorCitzdGF0aWMgc3NpemVfdAorenlucW1wX2RwX2F1eF90
cmFuc2ZlcihzdHJ1Y3QgZHJtX2RwX2F1eCAqYXV4LCBzdHJ1Y3QgZHJtX2RwX2F1eF9tc2cgKm1z
ZykKK3sKKwlzdHJ1Y3QgenlucW1wX2RwICpkcCA9IGNvbnRhaW5lcl9vZihhdXgsIHN0cnVjdCB6
eW5xbXBfZHAsIGF1eCk7CisJaW50IHJldDsKKwl1bnNpZ25lZCBpbnQgaSwgaXRlcjsKKworCS8q
IE51bWJlciBvZiBsb29wcyA9IHRpbWVvdXQgaW4gbXNlYyAvIGF1eCBkZWxheSAoNDAwIHVzZWMp
ICovCisJaXRlciA9IHp5bnFtcF9kcF9hdXhfdGltZW91dF9tcyAqIDEwMDAgLyA0MDA7CisJaXRl
ciA9IGl0ZXIgPyBpdGVyIDogMTsKKworCWZvciAoaSA9IDA7IGkgPCBpdGVyOyBpKyspIHsKKwkJ
cmV0ID0genlucW1wX2RwX2F1eF9jbWRfc3VibWl0KGRwLCBtc2ctPnJlcXVlc3QsIG1zZy0+YWRk
cmVzcywKKwkJCQkJICAgICAgIG1zZy0+YnVmZmVyLCBtc2ctPnNpemUsCisJCQkJCSAgICAgICAm
bXNnLT5yZXBseSk7CisJCWlmICghcmV0KSB7CisJCQlkZXZfZGJnKGRwLT5kZXYsICJhdXggJWQg
cmV0cmllc1xuIiwgaSk7CisJCQlyZXR1cm4gbXNnLT5zaXplOworCQl9CisKKwkJaWYgKGRwLT5z
dGF0dXMgPT0gY29ubmVjdG9yX3N0YXR1c19kaXNjb25uZWN0ZWQpIHsKKwkJCWRldl9kYmcoZHAt
PmRldiwgIm5vIGNvbm5lY3RlZCBhdXggZGV2aWNlXG4iKTsKKwkJCXJldHVybiAtRU5PREVWOwor
CQl9CisKKwkJdXNsZWVwX3JhbmdlKDQwMCwgNTAwKTsKKwl9CisKKwlkZXZfZGJnKGRwLT5kZXYs
ICJmYWlsZWQgdG8gZG8gYXV4IHRyYW5zZmVyICglZClcbiIsIHJldCk7CisKKwlyZXR1cm4gcmV0
OworfQorCisvKioKKyAqIHp5bnFtcF9kcF9hdXhfaW5pdCAtIEluaXRpYWxpemUgYW5kIHJlZ2lz
dGVyIHRoZSBEUCBBVVgKKyAqIEBkcDogRGlzcGxheVBvcnQgSVAgY29yZSBzdHJ1Y3R1cmUKKyAq
CisgKiBQcm9ncmFtIHRoZSBBVVggY2xvY2sgZGl2aWRlciBhbmQgZmlsdGVyIGFuZCByZWdpc3Rl
ciB0aGUgRFAgQVVYIGFkYXB0ZXIuCisgKgorICogUmV0dXJuOiAwIG9uIHN1Y2Nlc3MsIGVycm9y
IHZhbHVlIG90aGVyd2lzZQorICovCitzdGF0aWMgaW50IHp5bnFtcF9kcF9hdXhfaW5pdChzdHJ1
Y3QgenlucW1wX2RwICpkcCkKK3sKKwl1bnNpZ25lZCBsb25nIHJhdGU7CisJdW5zaWduZWQgaW50
IHc7CisKKwkvKgorCSAqIFRoZSBBVVhfU0lHTkFMX1dJRFRIX0ZJTFRFUiBpcyB0aGUgbnVtYmVy
IG9mIEFQQiBjbG9jayBjeWNsZXMKKwkgKiBjb3JyZXNwb25kaW5nIHRvIHRoZSBBVVggcHVsc2Uu
IEFsbG93YWJsZSB2YWx1ZXMgYXJlIDgsIDE2LCAyNCwgMzIsCisJICogNDAgYW5kIDQ4LiBUaGUg
QVVYIHB1bHNlIHdpZHRoIG11c3QgYmUgYmV0d2VlbiAwLjTCtXMgYW5kIDAuNsK1cywKKwkgKiBj
b21wdXRlIHRoZSB3IC8gOCB2YWx1ZSBjb3JyZXNwb25kaW5nIHRvIDAuNMK1cyByb3VuZGVkIHVw
LCBhbmQgbWFrZQorCSAqIHN1cmUgaXQgc3RheXMgYmVsb3cgMC42wrVzIGFuZCB3aXRoaW4gdGhl
IGFsbG93YWJsZSB2YWx1ZXMuCisJICovCisJcmF0ZSA9IGNsa19nZXRfcmF0ZShkcC0+ZHBzdWIt
PmFwYl9jbGspOworCXcgPSBESVZfUk9VTkRfVVAoNCAqIHJhdGUsIDEwMDAgKiAxMDAwICogMTAg
KiA4KSAqIDg7CisJaWYgKHcgPiA2ICogcmF0ZSAvICgxMDAwICogMTAwMCAqIDEwKSB8fCB3ID4g
NDgpIHsKKwkJZGV2X2VycihkcC0+ZGV2LCAiYWNsayBmcmVxdWVuY3kgdG9vIGhpZ2hcbiIpOwor
CQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9B
VVhfQ0xLX0RJVklERVIsCisJCQkodyA8PCBaWU5RTVBfRFBfQVVYX0NMS19ESVZJREVSX0FVWF9G
SUxURVJfU0hJRlQpIHwKKwkJCShyYXRlIC8gKDEwMDAgKiAxMDAwKSkpOworCisJZHAtPmF1eC5u
YW1lID0gIlp5bnFNUCBEUCBBVVgiOworCWRwLT5hdXguZGV2ID0gZHAtPmRldjsKKwlkcC0+YXV4
LnRyYW5zZmVyID0genlucW1wX2RwX2F1eF90cmFuc2ZlcjsKKworCXJldHVybiBkcm1fZHBfYXV4
X3JlZ2lzdGVyKCZkcC0+YXV4KTsKK30KKworLyoqCisgKiB6eW5xbXBfZHBfYXV4X2NsZWFudXAg
LSBDbGVhbnVwIHRoZSBEUCBBVVgKKyAqIEBkcDogRGlzcGxheVBvcnQgSVAgY29yZSBzdHJ1Y3R1
cmUKKyAqCisgKiBVbnJlZ2lzdGVyIHRoZSBEUCBBVVggYWRhcHRlci4KKyAqLworc3RhdGljIHZv
aWQgenlucW1wX2RwX2F1eF9jbGVhbnVwKHN0cnVjdCB6eW5xbXBfZHAgKmRwKQoreworCWRybV9k
cF9hdXhfdW5yZWdpc3RlcigmZHAtPmF1eCk7Cit9CisKKy8qIC0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
CisgKiBEaXNwbGF5UG9ydCBHZW5lcmljIFN1cHBvcnQKKyAqLworCisvKioKKyAqIHp5bnFtcF9k
cF91cGRhdGVfbWlzYyAtIFdyaXRlIHRoZSBtaXNjIHJlZ2lzdGVycworICogQGRwOiBEaXNwbGF5
UG9ydCBJUCBjb3JlIHN0cnVjdHVyZQorICoKKyAqIFRoZSBtaXNjIHJlZ2lzdGVyIHZhbHVlcyBh
cmUgc3RvcmVkIGluIHRoZSBzdHJ1Y3R1cmUsIGFuZCB0aGlzCisgKiBmdW5jdGlvbiBhcHBsaWVz
IHRoZSB2YWx1ZXMgaW50byB0aGUgcmVnaXN0ZXJzLgorICovCitzdGF0aWMgdm9pZCB6eW5xbXBf
ZHBfdXBkYXRlX21pc2Moc3RydWN0IHp5bnFtcF9kcCAqZHApCit7CisJenlucW1wX2RwX3dyaXRl
KGRwLCBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fTUlTQzAsIGRwLT5jb25maWcubWlzYzApOworCXp5
bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX01BSU5fU1RSRUFNX01JU0MxLCBkcC0+Y29uZmln
Lm1pc2MxKTsKK30KKworLyoqCisgKiB6eW5xbXBfZHBfc2V0X2Zvcm1hdCAtIFNldCB0aGUgaW5w
dXQgZm9ybWF0CisgKiBAZHA6IERpc3BsYXlQb3J0IElQIGNvcmUgc3RydWN0dXJlCisgKiBAZm9y
bWF0OiBpbnB1dCBmb3JtYXQKKyAqIEBicGM6IGJpdHMgcGVyIGNvbXBvbmVudAorICoKKyAqIFVw
ZGF0ZSBtaXNjIHJlZ2lzdGVyIHZhbHVlcyBiYXNlZCBvbiBpbnB1dCBAZm9ybWF0IGFuZCBAYnBj
LgorICoKKyAqIFJldHVybjogMCBvbiBzdWNjZXNzLCBvciAtRUlOVkFMLgorICovCitzdGF0aWMg
aW50IHp5bnFtcF9kcF9zZXRfZm9ybWF0KHN0cnVjdCB6eW5xbXBfZHAgKmRwLAorCQkJCWVudW0g
enlucW1wX2Rwc3ViX2Zvcm1hdCBmb3JtYXQsCisJCQkJdW5zaWduZWQgaW50IGJwYykKK3sKKwlz
dGF0aWMgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X2luZm8gKmRpc3BsYXk7CisJc3RydWN0IHp5
bnFtcF9kcF9jb25maWcgKmNvbmZpZyA9ICZkcC0+Y29uZmlnOworCXVuc2lnbmVkIGludCBudW1f
Y29sb3JzOworCisJY29uZmlnLT5taXNjMCAmPSB+WllOUU1QX0RQX01BSU5fU1RSRUFNX01JU0Mw
X0NPTVBfRk9STUFUX01BU0s7CisJY29uZmlnLT5taXNjMSAmPSB+WllOUU1QX0RQX01BSU5fU1RS
RUFNX01JU0MxX1lfT05MWV9FTjsKKworCXN3aXRjaCAoZm9ybWF0KSB7CisJY2FzZSBaWU5RTVBf
RFBTVUJfRk9STUFUX1JHQjoKKwkJY29uZmlnLT5taXNjMCB8PSBaWU5RTVBfRFBfTUFJTl9TVFJF
QU1fTUlTQzBfQ09NUF9GT1JNQVRfUkdCOworCQludW1fY29sb3JzID0gMzsKKwkJYnJlYWs7CisK
KwljYXNlIFpZTlFNUF9EUFNVQl9GT1JNQVRfWUNSQ0I0NDQ6CisJCWNvbmZpZy0+bWlzYzAgfD0g
WllOUU1QX0RQX01BSU5fU1RSRUFNX01JU0MwX0NPTVBfRk9STUFUX1lDUkNCXzQ0NDsKKwkJbnVt
X2NvbG9ycyA9IDM7CisJCWJyZWFrOworCisJY2FzZSBaWU5RTVBfRFBTVUJfRk9STUFUX1lDUkNC
NDIyOgorCQljb25maWctPm1pc2MwIHw9IFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9NSVNDMF9DT01Q
X0ZPUk1BVF9ZQ1JDQl80MjI7CisJCW51bV9jb2xvcnMgPSAyOworCQlicmVhazsKKworCWNhc2Ug
WllOUU1QX0RQU1VCX0ZPUk1BVF9ZT05MWToKKwkJY29uZmlnLT5taXNjMSB8PSBaWU5RTVBfRFBf
TUFJTl9TVFJFQU1fTUlTQzFfWV9PTkxZX0VOOworCQludW1fY29sb3JzID0gMTsKKwkJYnJlYWs7
CisKKwlkZWZhdWx0OgorCQlkZXZfZXJyKGRwLT5kZXYsICJJbnZhbGlkIGNvbG9ybWV0cnkgaW4g
RFRcbiIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlkaXNwbGF5ID0gJmRwLT5jb25uZWN0
b3IuZGlzcGxheV9pbmZvOworCWlmIChkaXNwbGF5LT5icGMgJiYgYnBjID4gZGlzcGxheS0+YnBj
KSB7CisJCWRldl93YXJuKGRwLT5kZXYsCisJCQkgImRvd25ncmFkaW5nIHJlcXVlc3RlZCAldWJw
YyB0byBkaXNwbGF5IGxpbWl0ICV1YnBjXG4iLAorCQkJIGJwYywgZGlzcGxheS0+YnBjKTsKKwkJ
YnBjID0gZGlzcGxheS0+YnBjOworCX0KKworCWNvbmZpZy0+bWlzYzAgJj0gflpZTlFNUF9EUF9N
QUlOX1NUUkVBTV9NSVNDMF9CUENfTUFTSzsKKworCXN3aXRjaCAoYnBjKSB7CisJY2FzZSA2Ogor
CQljb25maWctPm1pc2MwIHw9IFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9NSVNDMF9CUENfNjsKKwkJ
YnJlYWs7CisJY2FzZSA4OgorCQljb25maWctPm1pc2MwIHw9IFpZTlFNUF9EUF9NQUlOX1NUUkVB
TV9NSVNDMF9CUENfODsKKwkJYnJlYWs7CisJY2FzZSAxMDoKKwkJY29uZmlnLT5taXNjMCB8PSBa
WU5RTVBfRFBfTUFJTl9TVFJFQU1fTUlTQzBfQlBDXzEwOworCQlicmVhazsKKwljYXNlIDEyOgor
CQljb25maWctPm1pc2MwIHw9IFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9NSVNDMF9CUENfMTI7CisJ
CWJyZWFrOworCWNhc2UgMTY6CisJCWNvbmZpZy0+bWlzYzAgfD0gWllOUU1QX0RQX01BSU5fU1RS
RUFNX01JU0MwX0JQQ18xNjsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJZGV2X3dhcm4oZHAtPmRl
diwgIk5vdCBzdXBwb3J0ZWQgYnBjICgldSkuIGZhbGwgYmFjayB0byA4YnBjXG4iLAorCQkJIGJw
Yyk7CisJCWNvbmZpZy0+bWlzYzAgfD0gWllOUU1QX0RQX01BSU5fU1RSRUFNX01JU0MwX0JQQ184
OworCQlicGMgPSA4OworCQlicmVhazsKKwl9CisKKwkvKiBVcGRhdGUgdGhlIGN1cnJlbnQgYnBw
IGJhc2VkIG9uIHRoZSBmb3JtYXQuICovCisJY29uZmlnLT5icHAgPSBicGMgKiBudW1fY29sb3Jz
OworCisJcmV0dXJuIDA7Cit9CisKKy8qKgorICogenlucW1wX2RwX2VuY29kZXJfbW9kZV9zZXRf
dHJhbnNmZXJfdW5pdCAtIFNldCB0aGUgdHJhbnNmZXIgdW5pdCB2YWx1ZXMKKyAqIEBkcDogRGlz
cGxheVBvcnQgSVAgY29yZSBzdHJ1Y3R1cmUKKyAqIEBtb2RlOiByZXF1ZXN0ZWQgZGlzcGxheSBt
b2RlCisgKgorICogU2V0IHRoZSB0cmFuc2ZlciB1bml0LCBhbmQgY2FsY3VsYXRlIGFsbCB0cmFu
c2ZlciB1bml0IHNpemUgcmVsYXRlZCB2YWx1ZXMuCisgKiBDYWxjdWxhdGlvbiBpcyBiYXNlZCBv
biBEUCBhbmQgSVAgY29yZSBzcGVjaWZpY2F0aW9uLgorICovCitzdGF0aWMgdm9pZAorenlucW1w
X2RwX2VuY29kZXJfbW9kZV9zZXRfdHJhbnNmZXJfdW5pdChzdHJ1Y3QgenlucW1wX2RwICpkcCwK
KwkJCQkJIHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlKQoreworCXUzMiB0dSA9IFpZTlFN
UF9EUF9NU0FfVFJBTlNGRVJfVU5JVF9TSVpFX1RVX1NJWkVfREVGOworCXUzMiBidywgdmlkX2ti
eXRlcywgYXZnX2J5dGVzX3Blcl90dSwgaW5pdF93YWl0OworCisJLyogVXNlIHRoZSBtYXggdHJh
bnNmZXIgdW5pdCBzaXplIChkZWZhdWx0KSAqLworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1Q
X0RQX01TQV9UUkFOU0ZFUl9VTklUX1NJWkUsIHR1KTsKKworCXZpZF9rYnl0ZXMgPSBtb2RlLT5j
bG9jayAqIChkcC0+Y29uZmlnLmJwcCAvIDgpOworCWJ3ID0gZHJtX2RwX2J3X2NvZGVfdG9fbGlu
a19yYXRlKGRwLT5tb2RlLmJ3X2NvZGUpOworCWF2Z19ieXRlc19wZXJfdHUgPSB2aWRfa2J5dGVz
ICogdHUgLyAoZHAtPm1vZGUubGFuZV9jbnQgKiBidyAvIDEwMDApOworCXp5bnFtcF9kcF93cml0
ZShkcCwgWllOUU1QX0RQX01JTl9CWVRFU19QRVJfVFUsCisJCQlhdmdfYnl0ZXNfcGVyX3R1IC8g
MTAwMCk7CisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfRlJBQ19CWVRFU19QRVJfVFUs
CisJCQlhdmdfYnl0ZXNfcGVyX3R1ICUgMTAwMCk7CisKKwkvKiBDb25maWd1cmUgdGhlIGluaXRp
YWwgd2FpdCBjeWNsZSBiYXNlZCBvbiB0cmFuc2ZlciB1bml0IHNpemUgKi8KKwlpZiAodHUgPCAo
YXZnX2J5dGVzX3Blcl90dSAvIDEwMDApKQorCQlpbml0X3dhaXQgPSAwOworCWVsc2UgaWYgKChh
dmdfYnl0ZXNfcGVyX3R1IC8gMTAwMCkgPD0gNCkKKwkJaW5pdF93YWl0ID0gdHU7CisJZWxzZQor
CQlpbml0X3dhaXQgPSB0dSAtIGF2Z19ieXRlc19wZXJfdHUgLyAxMDAwOworCisJenlucW1wX2Rw
X3dyaXRlKGRwLCBaWU5RTVBfRFBfSU5JVF9XQUlULCBpbml0X3dhaXQpOworfQorCisvKioKKyAq
IHp5bnFtcF9kcF9lbmNvZGVyX21vZGVfc2V0X3N0cmVhbSAtIENvbmZpZ3VyZSB0aGUgbWFpbiBz
dHJlYW0KKyAqIEBkcDogRGlzcGxheVBvcnQgSVAgY29yZSBzdHJ1Y3R1cmUKKyAqIEBtb2RlOiBy
ZXF1ZXN0ZWQgZGlzcGxheSBtb2RlCisgKgorICogQ29uZmlndXJlIHRoZSBtYWluIHN0cmVhbSBi
YXNlZCBvbiB0aGUgcmVxdWVzdGVkIG1vZGUgQG1vZGUuIENhbGN1bGF0aW9uIGlzCisgKiBiYXNl
ZCBvbiBJUCBjb3JlIHNwZWNpZmljYXRpb24uCisgKi8KK3N0YXRpYyB2b2lkIHp5bnFtcF9kcF9l
bmNvZGVyX21vZGVfc2V0X3N0cmVhbShzdHJ1Y3QgenlucW1wX2RwICpkcCwKKwkJCQkJICAgICAg
Y29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUpCit7CisJdTggbGFuZV9jbnQgPSBk
cC0+bW9kZS5sYW5lX2NudDsKKwl1MzIgcmVnLCB3cGw7CisJdW5zaWduZWQgaW50IHJhdGU7CisK
Kwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9IVE9UQUwsIG1vZGUt
Pmh0b3RhbCk7CisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fVlRP
VEFMLCBtb2RlLT52dG90YWwpOworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX01BSU5f
U1RSRUFNX1BPTEFSSVRZLAorCQkJKCEhKG1vZGUtPmZsYWdzICYgRFJNX01PREVfRkxBR19QVlNZ
TkMpIDw8CisJCQkgWllOUU1QX0RQX01BSU5fU1RSRUFNX1BPTEFSSVRZX1ZTWU5DX1NISUZUKSB8
CisJCQkoISEobW9kZS0+ZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX1BIU1lOQykgPDwKKwkJCSBaWU5R
TVBfRFBfTUFJTl9TVFJFQU1fUE9MQVJJVFlfSFNZTkNfU0hJRlQpKTsKKwl6eW5xbXBfZHBfd3Jp
dGUoZHAsIFpZTlFNUF9EUF9NQUlOX1NUUkVBTV9IU1dJRFRILAorCQkJbW9kZS0+aHN5bmNfZW5k
IC0gbW9kZS0+aHN5bmNfc3RhcnQpOworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX01B
SU5fU1RSRUFNX1ZTV0lEVEgsCisJCQltb2RlLT52c3luY19lbmQgLSBtb2RlLT52c3luY19zdGFy
dCk7CisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fSFJFUywgbW9k
ZS0+aGRpc3BsYXkpOworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX01BSU5fU1RSRUFN
X1ZSRVMsIG1vZGUtPnZkaXNwbGF5KTsKKwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9N
QUlOX1NUUkVBTV9IU1RBUlQsCisJCQltb2RlLT5odG90YWwgLSBtb2RlLT5oc3luY19zdGFydCk7
CisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfTUFJTl9TVFJFQU1fVlNUQVJULAorCQkJ
bW9kZS0+dnRvdGFsIC0gbW9kZS0+dnN5bmNfc3RhcnQpOworCisJLyogSW4gc3luY2hyb25vdXMg
bW9kZSwgc2V0IHRoZSBkaXZpZXJzICovCisJaWYgKGRwLT5jb25maWcubWlzYzAgJiBaWU5RTVBf
RFBfTUFJTl9TVFJFQU1fTUlTQzBfU1lOQ19MT0NLKSB7CisJCXJlZyA9IGRybV9kcF9id19jb2Rl
X3RvX2xpbmtfcmF0ZShkcC0+bW9kZS5id19jb2RlKTsKKwkJenlucW1wX2RwX3dyaXRlKGRwLCBa
WU5RTVBfRFBfTUFJTl9TVFJFQU1fTl9WSUQsIHJlZyk7CisJCXp5bnFtcF9kcF93cml0ZShkcCwg
WllOUU1QX0RQX01BSU5fU1RSRUFNX01fVklELCBtb2RlLT5jbG9jayk7CisJCXJhdGUgPSB6eW5x
bXBfZGlzcF9nZXRfYXVkaW9fY2xrX3JhdGUoZHAtPmRwc3ViLT5kaXNwKTsKKwkJaWYgKHJhdGUp
IHsKKwkJCWRldl9kYmcoZHAtPmRldiwgIkF1ZGlvIHJhdGU6ICVkXG4iLCByYXRlIC8gNTEyKTsK
KwkJCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX1RYX05fQVVELCByZWcpOworCQkJenlu
cW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfVFhfTV9BVUQsIHJhdGUgLyAxMDAwKTsKKwkJfQor
CX0KKworCS8qIE9ubHkgMiBjaGFubmVsIGF1ZGlvIGlzIHN1cHBvcnRlZCBub3cgKi8KKwlpZiAo
enlucW1wX2Rpc3BfYXVkaW9fZW5hYmxlZChkcC0+ZHBzdWItPmRpc3ApKQorCQl6eW5xbXBfZHBf
d3JpdGUoZHAsIFpZTlFNUF9EUF9UWF9BVURJT19DSEFOTkVMUywgMSk7CisKKwl6eW5xbXBfZHBf
d3JpdGUoZHAsIFpZTlFNUF9EUF9VU0VSX1BJWF9XSURUSCwgMSk7CisKKwkvKiBUcmFuc2xhdGUg
dG8gdGhlIG5hdGl2ZSAxNiBiaXQgZGF0YXBhdGggYmFzZWQgb24gSVAgY29yZSBzcGVjICovCisJ
d3BsID0gKG1vZGUtPmhkaXNwbGF5ICogZHAtPmNvbmZpZy5icHAgKyAxNSkgLyAxNjsKKwlyZWcg
PSB3cGwgKyB3cGwgJSBsYW5lX2NudCAtIGxhbmVfY250OworCXp5bnFtcF9kcF93cml0ZShkcCwg
WllOUU1QX0RQX1VTRVJfREFUQV9DT1VOVF9QRVJfTEFORSwgcmVnKTsKK30KKworLyogLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0KKyAqIERSTSBDb25uZWN0b3IKKyAqLworCitzdGF0aWMgZW51bSBkcm1f
Y29ubmVjdG9yX3N0YXR1cworenlucW1wX2RwX2Nvbm5lY3Rvcl9kZXRlY3Qoc3RydWN0IGRybV9j
b25uZWN0b3IgKmNvbm5lY3RvciwgYm9vbCBmb3JjZSkKK3sKKwlzdHJ1Y3QgenlucW1wX2RwICpk
cCA9IGNvbm5lY3Rvcl90b19kcChjb25uZWN0b3IpOworCXN0cnVjdCB6eW5xbXBfZHBfbGlua19j
b25maWcgKmxpbmtfY29uZmlnID0gJmRwLT5saW5rX2NvbmZpZzsKKwl1MzIgc3RhdGUsIGk7CisJ
aW50IHJldDsKKworCS8qCisJICogVGhpcyBpcyBmcm9tIGhldXJpc3RpYy4gSXQgdGFrZXMgc29t
ZSBkZWxheSAoZXgsIDEwMCB+IDUwMCBtc2VjKSB0bworCSAqIGdldCB0aGUgSFBEIHNpZ25hbCB3
aXRoIHNvbWUgbW9uaXRvcnMuCisJICovCisJZm9yIChpID0gMDsgaSA8IDEwOyBpKyspIHsKKwkJ
c3RhdGUgPSB6eW5xbXBfZHBfcmVhZChkcCwgWllOUU1QX0RQX0lOVEVSUlVQVF9TSUdOQUxfU1RB
VEUpOworCQlpZiAoc3RhdGUgJiBaWU5RTVBfRFBfSU5URVJSVVBUX1NJR05BTF9TVEFURV9IUEQp
CisJCQlicmVhazsKKwkJbXNsZWVwKDEwMCk7CisJfQorCisJaWYgKHN0YXRlICYgWllOUU1QX0RQ
X0lOVEVSUlVQVF9TSUdOQUxfU1RBVEVfSFBEKSB7CisJCXJldCA9IGRybV9kcF9kcGNkX3JlYWQo
JmRwLT5hdXgsIDB4MCwgZHAtPmRwY2QsCisJCQkJICAgICAgIHNpemVvZihkcC0+ZHBjZCkpOwor
CQlpZiAocmV0IDwgMCkgeworCQkJZGV2X2RiZyhkcC0+ZGV2LCAiRFBDRCByZWFkIGZhaWxlcyIp
OworCQkJZ290byBkaXNjb25uZWN0ZWQ7CisJCX0KKworCQlsaW5rX2NvbmZpZy0+bWF4X3JhdGUg
PSBtaW5fdChpbnQsCisJCQkJCSAgICAgIGRybV9kcF9tYXhfbGlua19yYXRlKGRwLT5kcGNkKSwK
KwkJCQkJICAgICAgRFBfSElHSF9CSVRfUkFURTIpOworCQlsaW5rX2NvbmZpZy0+bWF4X2xhbmVz
ID0gbWluX3QodTgsCisJCQkJCSAgICAgICBkcm1fZHBfbWF4X2xhbmVfY291bnQoZHAtPmRwY2Qp
LAorCQkJCQkgICAgICAgZHAtPm51bV9sYW5lcyk7CisKKwkJZHAtPnN0YXR1cyA9IGNvbm5lY3Rv
cl9zdGF0dXNfY29ubmVjdGVkOworCQlyZXR1cm4gY29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQ7
CisJfQorCitkaXNjb25uZWN0ZWQ6CisJZHAtPnN0YXR1cyA9IGNvbm5lY3Rvcl9zdGF0dXNfZGlz
Y29ubmVjdGVkOworCXJldHVybiBjb25uZWN0b3Jfc3RhdHVzX2Rpc2Nvbm5lY3RlZDsKK30KKwor
c3RhdGljIGludCB6eW5xbXBfZHBfY29ubmVjdG9yX2dldF9tb2RlcyhzdHJ1Y3QgZHJtX2Nvbm5l
Y3RvciAqY29ubmVjdG9yKQoreworCXN0cnVjdCB6eW5xbXBfZHAgKmRwID0gY29ubmVjdG9yX3Rv
X2RwKGNvbm5lY3Rvcik7CisJc3RydWN0IGVkaWQgKmVkaWQ7CisJaW50IHJldDsKKworCWVkaWQg
PSBkcm1fZ2V0X2VkaWQoY29ubmVjdG9yLCAmZHAtPmF1eC5kZGMpOworCWlmICghZWRpZCkKKwkJ
cmV0dXJuIDA7CisKKwlkcm1fY29ubmVjdG9yX3VwZGF0ZV9lZGlkX3Byb3BlcnR5KGNvbm5lY3Rv
ciwgZWRpZCk7CisJcmV0ID0gZHJtX2FkZF9lZGlkX21vZGVzKGNvbm5lY3RvciwgZWRpZCk7CisJ
a2ZyZWUoZWRpZCk7CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgc3RydWN0IGRybV9lbmNv
ZGVyICoKK3p5bnFtcF9kcF9jb25uZWN0b3JfYmVzdF9lbmNvZGVyKHN0cnVjdCBkcm1fY29ubmVj
dG9yICpjb25uZWN0b3IpCit7CisJc3RydWN0IHp5bnFtcF9kcCAqZHAgPSBjb25uZWN0b3JfdG9f
ZHAoY29ubmVjdG9yKTsKKworCXJldHVybiAmZHAtPmVuY29kZXI7Cit9CisKK3N0YXRpYyBpbnQg
enlucW1wX2RwX2Nvbm5lY3Rvcl9tb2RlX3ZhbGlkKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25u
ZWN0b3IsCisJCQkJCSAgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUpCit7CisJc3RydWN0
IHp5bnFtcF9kcCAqZHAgPSBjb25uZWN0b3JfdG9fZHAoY29ubmVjdG9yKTsKKwl1OCBtYXhfbGFu
ZXMgPSBkcC0+bGlua19jb25maWcubWF4X2xhbmVzOworCXU4IGJwcCA9IGRwLT5jb25maWcuYnBw
OworCWludCBtYXhfcmF0ZSA9IGRwLT5saW5rX2NvbmZpZy5tYXhfcmF0ZTsKKwlpbnQgcmF0ZTsK
KworCWlmIChtb2RlLT5jbG9jayA+IFpZTlFNUF9NQVhfRlJFUSkgeworCQlkZXZfZGJnKGRwLT5k
ZXYsICJmaWx0ZXJlZCB0aGUgbW9kZSwgJXMsZm9yIGhpZ2ggcGl4ZWwgcmF0ZVxuIiwKKwkJCW1v
ZGUtPm5hbWUpOworCQlkcm1fbW9kZV9kZWJ1Z19wcmludG1vZGVsaW5lKG1vZGUpOworCQlyZXR1
cm4gTU9ERV9DTE9DS19ISUdIOworCX0KKworCS8qIENoZWNrIHdpdGggbGluayByYXRlIGFuZCBs
YW5lIGNvdW50ICovCisJcmF0ZSA9IHp5bnFtcF9kcF9tYXhfcmF0ZShtYXhfcmF0ZSwgbWF4X2xh
bmVzLCBicHApOworCWlmIChtb2RlLT5jbG9jayA+IHJhdGUpIHsKKwkJZGV2X2RiZyhkcC0+ZGV2
LCAiZmlsdGVyZWQgdGhlIG1vZGUsICVzLGZvciBoaWdoIHBpeGVsIHJhdGVcbiIsCisJCQltb2Rl
LT5uYW1lKTsKKwkJZHJtX21vZGVfZGVidWdfcHJpbnRtb2RlbGluZShtb2RlKTsKKwkJcmV0dXJu
IE1PREVfQ0xPQ0tfSElHSDsKKwl9CisKKwlyZXR1cm4gTU9ERV9PSzsKK30KKworc3RhdGljIGNv
bnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX2Z1bmNzIHp5bnFtcF9kcF9jb25uZWN0b3JfZnVuY3Mg
PSB7CisJLmRldGVjdAkJCT0genlucW1wX2RwX2Nvbm5lY3Rvcl9kZXRlY3QsCisJLmZpbGxfbW9k
ZXMJCT0gZHJtX2hlbHBlcl9wcm9iZV9zaW5nbGVfY29ubmVjdG9yX21vZGVzLAorCS5kZXN0cm95
CQk9IGRybV9jb25uZWN0b3JfY2xlYW51cCwKKwkuYXRvbWljX2R1cGxpY2F0ZV9zdGF0ZQk9IGRy
bV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9kdXBsaWNhdGVfc3RhdGUsCisJLmF0b21pY19kZXN0
cm95X3N0YXRlCT0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2Rlc3Ryb3lfc3RhdGUsCisJ
LnJlc2V0CQkJPSBkcm1fYXRvbWljX2hlbHBlcl9jb25uZWN0b3JfcmVzZXQsCit9OworCitzdGF0
aWMgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3JfaGVscGVyX2Z1bmNzCit6eW5xbXBfZHBfY29u
bmVjdG9yX2hlbHBlcl9mdW5jcyA9IHsKKwkuZ2V0X21vZGVzCT0genlucW1wX2RwX2Nvbm5lY3Rv
cl9nZXRfbW9kZXMsCisJLmJlc3RfZW5jb2Rlcgk9IHp5bnFtcF9kcF9jb25uZWN0b3JfYmVzdF9l
bmNvZGVyLAorCS5tb2RlX3ZhbGlkCT0genlucW1wX2RwX2Nvbm5lY3Rvcl9tb2RlX3ZhbGlkLAor
fTsKKworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqIERSTSBFbmNvZGVyCisgKi8KKworc3Rh
dGljIHZvaWQgenlucW1wX2RwX2VuY29kZXJfZW5hYmxlKHN0cnVjdCBkcm1fZW5jb2RlciAqZW5j
b2RlcikKK3sKKwlzdHJ1Y3QgenlucW1wX2RwICpkcCA9IGVuY29kZXJfdG9fZHAoZW5jb2Rlcik7
CisJdW5zaWduZWQgaW50IGk7CisJaW50IHJldCA9IDA7CisKKwlwbV9ydW50aW1lX2dldF9zeW5j
KGRwLT5kZXYpOworCWRwLT5lbmFibGVkID0gdHJ1ZTsKKwl6eW5xbXBfZHBfdXBkYXRlX21pc2Mo
ZHApOworCWlmICh6eW5xbXBfZGlzcF9hdWRpb19lbmFibGVkKGRwLT5kcHN1Yi0+ZGlzcCkpCisJ
CXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX1RYX0FVRElPX0NPTlRST0wsIDEpOworCXp5
bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX1RYX1BIWV9QT1dFUl9ET1dOLCAwKTsKKwlpZiAo
ZHAtPnN0YXR1cyA9PSBjb25uZWN0b3Jfc3RhdHVzX2Nvbm5lY3RlZCkgeworCQlmb3IgKGkgPSAw
OyBpIDwgMzsgaSsrKSB7CisJCQlyZXQgPSBkcm1fZHBfZHBjZF93cml0ZWIoJmRwLT5hdXgsIERQ
X1NFVF9QT1dFUiwKKwkJCQkJCSBEUF9TRVRfUE9XRVJfRDApOworCQkJaWYgKHJldCA9PSAxKQor
CQkJCWJyZWFrOworCQkJdXNsZWVwX3JhbmdlKDMwMCwgNTAwKTsKKwkJfQorCQkvKiBTb21lIG1v
bml0b3JzIHRha2UgdGltZSB0byB3YWtlIHVwIHByb3Blcmx5ICovCisJCW1zbGVlcCh6eW5xbXBf
ZHBfcG93ZXJfb25fZGVsYXlfbXMpOworCX0KKwlpZiAocmV0ICE9IDEpCisJCWRldl9kYmcoZHAt
PmRldiwgIkRQIGF1eCBmYWlsZWRcbiIpOworCWVsc2UKKwkJenlucW1wX2RwX3RyYWluX2xvb3Ao
ZHApOworCXp5bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX1NPRlRXQVJFX1JFU0VULAorCQkJ
WllOUU1QX0RQX1NPRlRXQVJFX1JFU0VUX0FMTCk7CisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5R
TVBfRFBfTUFJTl9TVFJFQU1fRU5BQkxFLCAxKTsKK30KKworc3RhdGljIHZvaWQgenlucW1wX2Rw
X2VuY29kZXJfZGlzYWJsZShzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIpCit7CisJc3RydWN0
IHp5bnFtcF9kcCAqZHAgPSBlbmNvZGVyX3RvX2RwKGVuY29kZXIpOworCisJZHAtPmVuYWJsZWQg
PSBmYWxzZTsKKwljYW5jZWxfZGVsYXllZF93b3JrKCZkcC0+aHBkX3dvcmspOworCXp5bnFtcF9k
cF93cml0ZShkcCwgWllOUU1QX0RQX01BSU5fU1RSRUFNX0VOQUJMRSwgMCk7CisJZHJtX2RwX2Rw
Y2Rfd3JpdGViKCZkcC0+YXV4LCBEUF9TRVRfUE9XRVIsIERQX1NFVF9QT1dFUl9EMyk7CisJenlu
cW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfVFhfUEhZX1BPV0VSX0RPV04sCisJCQlaWU5RTVBf
RFBfVFhfUEhZX1BPV0VSX0RPV05fQUxMKTsKKwlpZiAoenlucW1wX2Rpc3BfYXVkaW9fZW5hYmxl
ZChkcC0+ZHBzdWItPmRpc3ApKQorCQl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9UWF9B
VURJT19DT05UUk9MLCAwKTsKKwlwbV9ydW50aW1lX3B1dF9zeW5jKGRwLT5kZXYpOworfQorCitz
dGF0aWMgdm9pZAorenlucW1wX2RwX2VuY29kZXJfYXRvbWljX21vZGVfc2V0KHN0cnVjdCBkcm1f
ZW5jb2RlciAqZW5jb2RlciwKKwkJCQkgIHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSwKKwkJCQkgIHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uZWN0b3Jfc3RhdGUpCit7
CisJc3RydWN0IHp5bnFtcF9kcCAqZHAgPSBlbmNvZGVyX3RvX2RwKGVuY29kZXIpOworCXN0cnVj
dCBkcm1fZGlzcGxheV9tb2RlICptb2RlID0gJmNydGNfc3RhdGUtPm1vZGU7CisJc3RydWN0IGRy
bV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmY3J0Y19zdGF0ZS0+YWRqdXN0ZWRfbW9k
ZTsKKwl1OCBtYXhfbGFuZXMgPSBkcC0+bGlua19jb25maWcubWF4X2xhbmVzOworCXU4IGJwcCA9
IGRwLT5jb25maWcuYnBwOworCWludCByYXRlLCBtYXhfcmF0ZSA9IGRwLT5saW5rX2NvbmZpZy5t
YXhfcmF0ZTsKKwlpbnQgcmV0OworCisJenlucW1wX2RwX3NldF9mb3JtYXQoZHAsIFpZTlFNUF9E
UFNVQl9GT1JNQVRfUkdCLCA4KTsKKworCS8qIENoZWNrIGFnYWluIGFzIGJwcCBvciBmb3JtYXQg
bWlnaHQgaGF2ZSBiZWVuIGNoYWduZWQgKi8KKwlyYXRlID0genlucW1wX2RwX21heF9yYXRlKG1h
eF9yYXRlLCBtYXhfbGFuZXMsIGJwcCk7CisJaWYgKG1vZGUtPmNsb2NrID4gcmF0ZSkgeworCQlk
ZXZfZXJyKGRwLT5kZXYsICJ0aGUgbW9kZSwgJXMsaGFzIHRvbyBoaWdoIHBpeGVsIHJhdGVcbiIs
CisJCQltb2RlLT5uYW1lKTsKKwkJZHJtX21vZGVfZGVidWdfcHJpbnRtb2RlbGluZShtb2RlKTsK
Kwl9CisKKwlyZXQgPSB6eW5xbXBfZHBfbW9kZV9jb25maWd1cmUoZHAsIGFkanVzdGVkX21vZGUt
PmNsb2NrLCAwKTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0dXJuOworCisJenlucW1wX2RwX2VuY29k
ZXJfbW9kZV9zZXRfdHJhbnNmZXJfdW5pdChkcCwgYWRqdXN0ZWRfbW9kZSk7CisJenlucW1wX2Rw
X2VuY29kZXJfbW9kZV9zZXRfc3RyZWFtKGRwLCBhZGp1c3RlZF9tb2RlKTsKK30KKworI2RlZmlu
ZSBaWU5RTVBfRFBfTUlOX0hfQkFDS1BPUkNICTIwCisKK3N0YXRpYyBpbnQKK3p5bnFtcF9kcF9l
bmNvZGVyX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIsCisJCQkgICAg
ICAgc3RydWN0IGRybV9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAorCQkJICAgICAgIHN0cnVjdCBk
cm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQoreworCXN0cnVjdCBkcm1fZGlzcGxheV9t
b2RlICptb2RlID0gJmNydGNfc3RhdGUtPm1vZGU7CisJc3RydWN0IGRybV9kaXNwbGF5X21vZGUg
KmFkanVzdGVkX21vZGUgPSAmY3J0Y19zdGF0ZS0+YWRqdXN0ZWRfbW9kZTsKKwlpbnQgZGlmZiA9
IG1vZGUtPmh0b3RhbCAtIG1vZGUtPmhzeW5jX2VuZDsKKworCS8qCisJICogWnlucU1QIERQIHJl
cXVpcmVzIGhvcml6b250YWwgYmFja3BvcmNoIHRvIGJlIGdyZWF0ZXIgdGhhbiAxMi4KKwkgKiBU
aGlzIGxpbWl0YXRpb24gbWF5IG5vdCBiZSBjb21wYXRpYmxlIHdpdGggdGhlIHNpbmsgZGV2aWNl
LgorCSAqLworCWlmIChkaWZmIDwgWllOUU1QX0RQX01JTl9IX0JBQ0tQT1JDSCkgeworCQlpbnQg
dnJlZnJlc2ggPSAoYWRqdXN0ZWRfbW9kZS0+Y2xvY2sgKiAxMDAwKSAvCisJCQkgICAgICAgKGFk
anVzdGVkX21vZGUtPnZ0b3RhbCAqIGFkanVzdGVkX21vZGUtPmh0b3RhbCk7CisKKwkJZGV2X2Ri
ZyhlbmNvZGVyLT5kZXYtPmRldiwgImhiYWNrcG9yY2ggYWRqdXN0ZWQ6ICVkIHRvICVkIiwKKwkJ
CWRpZmYsIFpZTlFNUF9EUF9NSU5fSF9CQUNLUE9SQ0ggLSBkaWZmKTsKKwkJZGlmZiA9IFpZTlFN
UF9EUF9NSU5fSF9CQUNLUE9SQ0ggLSBkaWZmOworCQlhZGp1c3RlZF9tb2RlLT5odG90YWwgKz0g
ZGlmZjsKKwkJYWRqdXN0ZWRfbW9kZS0+Y2xvY2sgPSBhZGp1c3RlZF9tb2RlLT52dG90YWwgKgor
CQkJCSAgICAgICBhZGp1c3RlZF9tb2RlLT5odG90YWwgKiB2cmVmcmVzaCAvIDEwMDA7CisJfQor
CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2VuY29kZXJfaGVscGVy
X2Z1bmNzIHp5bnFtcF9kcF9lbmNvZGVyX2hlbHBlcl9mdW5jcyA9IHsKKwkuZW5hYmxlCQkJPSB6
eW5xbXBfZHBfZW5jb2Rlcl9lbmFibGUsCisJLmRpc2FibGUJCT0genlucW1wX2RwX2VuY29kZXJf
ZGlzYWJsZSwKKwkuYXRvbWljX21vZGVfc2V0CT0genlucW1wX2RwX2VuY29kZXJfYXRvbWljX21v
ZGVfc2V0LAorCS5hdG9taWNfY2hlY2sJCT0genlucW1wX2RwX2VuY29kZXJfYXRvbWljX2NoZWNr
LAorfTsKKworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqIEludGVycnVwdCBIYW5kbGluZwor
ICovCisKKy8qKgorICogenlucW1wX2RwX2VuYWJsZV92YmxhbmsgLSBFbmFibGUgdmJsYW5rCisg
KiBAZHA6IERpc3BsYXlQb3J0IElQIGNvcmUgc3RydWN0dXJlCisgKgorICogRW5hYmxlIHZibGFu
ayBpbnRlcnJ1cHQKKyAqLwordm9pZCB6eW5xbXBfZHBfZW5hYmxlX3ZibGFuayhzdHJ1Y3Qgenlu
cW1wX2RwICpkcCkKK3sKKwl6eW5xbXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9JTlRfRU4sIFpZ
TlFNUF9EUF9JTlRfVkJMQU5LX1NUQVJUKTsKK30KKworLyoqCisgKiB6eW5xbXBfZHBfZGlzYWJs
ZV92YmxhbmsgLSBEaXNhYmxlIHZibGFuaworICogQGRwOiBEaXNwbGF5UG9ydCBJUCBjb3JlIHN0
cnVjdHVyZQorICoKKyAqIERpc2FibGUgdmJsYW5rIGludGVycnVwdAorICovCit2b2lkIHp5bnFt
cF9kcF9kaXNhYmxlX3ZibGFuayhzdHJ1Y3QgenlucW1wX2RwICpkcCkKK3sKKwl6eW5xbXBfZHBf
d3JpdGUoZHAsIFpZTlFNUF9EUF9JTlRfRFMsIFpZTlFNUF9EUF9JTlRfVkJMQU5LX1NUQVJUKTsK
K30KKworc3RhdGljIHZvaWQgenlucW1wX2RwX2hwZF93b3JrX2Z1bmMoc3RydWN0IHdvcmtfc3Ry
dWN0ICp3b3JrKQoreworCXN0cnVjdCB6eW5xbXBfZHAgKmRwOworCisJZHAgPSBjb250YWluZXJf
b2Yod29yaywgc3RydWN0IHp5bnFtcF9kcCwgaHBkX3dvcmsud29yayk7CisKKwlpZiAoZHAtPmRy
bSkKKwkJZHJtX2hlbHBlcl9ocGRfaXJxX2V2ZW50KGRwLT5kcm0pOworfQorCitzdGF0aWMgaXJx
cmV0dXJuX3QgenlucW1wX2RwX2lycV9oYW5kbGVyKGludCBpcnEsIHZvaWQgKmRhdGEpCit7CisJ
c3RydWN0IHp5bnFtcF9kcCAqZHAgPSAoc3RydWN0IHp5bnFtcF9kcCAqKWRhdGE7CisJdTMyIHN0
YXR1cywgbWFzazsKKworCXN0YXR1cyA9IHp5bnFtcF9kcF9yZWFkKGRwLCBaWU5RTVBfRFBfSU5U
X1NUQVRVUyk7CisJbWFzayA9IHp5bnFtcF9kcF9yZWFkKGRwLCBaWU5RTVBfRFBfSU5UX01BU0sp
OworCWlmICghKHN0YXR1cyAmIH5tYXNrKSkKKwkJcmV0dXJuIElSUV9OT05FOworCisJLyogZGJn
IGZvciBkaWFnbm9zdGljLCBidXQgbm90IG11Y2ggdGhhdCB0aGUgZHJpdmVyIGNhbiBkbyAqLwor
CWlmIChzdGF0dXMgJiBaWU5RTVBfRFBfSU5UX0NIQlVGX1VOREVSRkxXX01BU0spCisJCWRldl9k
YmdfcmF0ZWxpbWl0ZWQoZHAtPmRldiwgInVuZGVyZmxvdyBpbnRlcnJ1cHRcbiIpOworCWlmIChz
dGF0dXMgJiBaWU5RTVBfRFBfSU5UX0NIQlVGX09WRVJGTFdfTUFTSykKKwkJZGV2X2RiZ19yYXRl
bGltaXRlZChkcC0+ZGV2LCAib3ZlcmZsb3cgaW50ZXJydXB0XG4iKTsKKworCXp5bnFtcF9kcF93
cml0ZShkcCwgWllOUU1QX0RQX0lOVF9TVEFUVVMsIHN0YXR1cyk7CisKKwlpZiAoc3RhdHVzICYg
WllOUU1QX0RQX0lOVF9WQkxBTktfU1RBUlQpCisJCXp5bnFtcF9kaXNwX2hhbmRsZV92Ymxhbmso
ZHAtPmRwc3ViLT5kaXNwKTsKKworCWlmIChzdGF0dXMgJiBaWU5RTVBfRFBfSU5UX0hQRF9FVkVO
VCkKKwkJc2NoZWR1bGVfZGVsYXllZF93b3JrKCZkcC0+aHBkX3dvcmssIDApOworCisJaWYgKHN0
YXR1cyAmIFpZTlFNUF9EUF9JTlRfSFBEX0lSUSkgeworCQlpbnQgcmV0OworCQl1OCBzdGF0dXNb
RFBfTElOS19TVEFUVVNfU0laRSArIDJdOworCisJCXJldCA9IGRybV9kcF9kcGNkX3JlYWQoJmRw
LT5hdXgsIERQX1NJTktfQ09VTlQsIHN0YXR1cywKKwkJCQkgICAgICAgRFBfTElOS19TVEFUVVNf
U0laRSArIDIpOworCQlpZiAocmV0IDwgMCkKKwkJCWdvdG8gaGFuZGxlZDsKKworCQlpZiAoc3Rh
dHVzWzRdICYgRFBfTElOS19TVEFUVVNfVVBEQVRFRCB8fAorCQkgICAgIWRybV9kcF9jbG9ja19y
ZWNvdmVyeV9vaygmc3RhdHVzWzJdLCBkcC0+bW9kZS5sYW5lX2NudCkgfHwKKwkJICAgICFkcm1f
ZHBfY2hhbm5lbF9lcV9vaygmc3RhdHVzWzJdLCBkcC0+bW9kZS5sYW5lX2NudCkpIHsKKwkJCXp5
bnFtcF9kcF90cmFpbl9sb29wKGRwKTsKKwkJfQorCX0KKworaGFuZGxlZDoKKwlyZXR1cm4gSVJR
X0hBTkRMRUQ7Cit9CisKKy8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisgKiBJbml0aWFsaXphdGlv
biAmIENsZWFudXAKKyAqLworCitpbnQgenlucW1wX2RwX2RybV9pbml0KHN0cnVjdCB6eW5xbXBf
ZHBzdWIgKmRwc3ViKQoreworCXN0cnVjdCB6eW5xbXBfZHAgKmRwID0gZHBzdWItPmRwOworCXN0
cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlciA9ICZkcC0+ZW5jb2RlcjsKKwlzdHJ1Y3QgZHJtX2Nv
bm5lY3RvciAqY29ubmVjdG9yID0gJmRwLT5jb25uZWN0b3I7CisJaW50IHJldDsKKworCWRwLT5j
b25maWcubWlzYzAgJj0gflpZTlFNUF9EUF9NQUlOX1NUUkVBTV9NSVNDMF9TWU5DX0xPQ0s7CisJ
enlucW1wX2RwX3NldF9mb3JtYXQoZHAsIFpZTlFNUF9EUFNVQl9GT1JNQVRfUkdCLCA4KTsKKwor
CS8qIENyZWF0ZSB0aGUgRFJNIGVuY29kZXIgYW5kIGNvbm5lY3Rvci4gKi8KKwllbmNvZGVyLT5w
b3NzaWJsZV9jcnRjcyB8PSB6eW5xbXBfZGlzcF9nZXRfY3J0Y19tYXNrKGRwc3ViLT5kaXNwKTsK
Kwlkcm1fc2ltcGxlX2VuY29kZXJfaW5pdChkcC0+ZHJtLCBlbmNvZGVyLCBEUk1fTU9ERV9FTkNP
REVSX1RNRFMpOworCWRybV9lbmNvZGVyX2hlbHBlcl9hZGQoZW5jb2RlciwgJnp5bnFtcF9kcF9l
bmNvZGVyX2hlbHBlcl9mdW5jcyk7CisKKwljb25uZWN0b3ItPnBvbGxlZCA9IERSTV9DT05ORUNU
T1JfUE9MTF9IUEQ7CisJcmV0ID0gZHJtX2Nvbm5lY3Rvcl9pbml0KGVuY29kZXItPmRldiwgY29u
bmVjdG9yLAorCQkJCSAmenlucW1wX2RwX2Nvbm5lY3Rvcl9mdW5jcywKKwkJCQkgRFJNX01PREVf
Q09OTkVDVE9SX0Rpc3BsYXlQb3J0KTsKKwlpZiAocmV0KSB7CisJCWRldl9lcnIoZHAtPmRldiwg
ImZhaWxlZCB0byBjcmVhdGUgdGhlIERSTSBjb25uZWN0b3JcbiIpOworCQlyZXR1cm4gcmV0Owor
CX0KKworCWRybV9jb25uZWN0b3JfaGVscGVyX2FkZChjb25uZWN0b3IsICZ6eW5xbXBfZHBfY29u
bmVjdG9yX2hlbHBlcl9mdW5jcyk7CisJZHJtX2Nvbm5lY3Rvcl9yZWdpc3Rlcihjb25uZWN0b3Ip
OworCWRybV9jb25uZWN0b3JfYXR0YWNoX2VuY29kZXIoY29ubmVjdG9yLCBlbmNvZGVyKTsKKwor
CS8qIEluaXRpYWxpemUgYW5kIHJlZ2lzdGVyIHRoZSBBVVggYWRhcHRlci4gKi8KKwlyZXQgPSB6
eW5xbXBfZHBfYXV4X2luaXQoZHApOworCWlmIChyZXQpIHsKKwkJZGV2X2VycihkcC0+ZGV2LCAi
ZmFpbGVkIHRvIGluaXRpYWxpemUgRFAgYXV4XG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwkv
KiBOb3cgdGhhdCBpbml0aWFsaXNhdGlvbiBpcyBjb21wbGV0ZSwgZW5hYmxlIGludGVycnVwdHMu
ICovCisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfSU5UX0VOLCBaWU5RTVBfRFBfSU5U
X0FMTCk7CisKKwlyZXR1cm4gMDsKK30KKworaW50IHp5bnFtcF9kcF9wcm9iZShzdHJ1Y3Qgenlu
cW1wX2Rwc3ViICpkcHN1Yiwgc3RydWN0IGRybV9kZXZpY2UgKmRybSkKK3sKKwlzdHJ1Y3QgcGxh
dGZvcm1fZGV2aWNlICpwZGV2ID0gdG9fcGxhdGZvcm1fZGV2aWNlKGRwc3ViLT5kZXYpOworCXN0
cnVjdCB6eW5xbXBfZHAgKmRwOworCXN0cnVjdCByZXNvdXJjZSAqcmVzOworCWludCByZXQ7CisK
KwlkcCA9IGRybW1fa3phbGxvYyhkcm0sIHNpemVvZigqZHApLCBHRlBfS0VSTkVMKTsKKwlpZiAo
IWRwKQorCQlyZXR1cm4gLUVOT01FTTsKKworCWRwLT5kZXYgPSAmcGRldi0+ZGV2OworCWRwLT5k
cHN1YiA9IGRwc3ViOworCWRwLT5zdGF0dXMgPSBjb25uZWN0b3Jfc3RhdHVzX2Rpc2Nvbm5lY3Rl
ZDsKKwlkcC0+ZHJtID0gZHJtOworCisJSU5JVF9ERUxBWUVEX1dPUksoJmRwLT5ocGRfd29yaywg
enlucW1wX2RwX2hwZF93b3JrX2Z1bmMpOworCisJZHBzdWItPmRwID0gZHA7CisKKwkvKiBBY3F1
aXJlIGFsbCByZXNvdXJjZXMgKElPTUVNLCBJUlEgYW5kIFBIWXMpLiAqLworCXJlcyA9IHBsYXRm
b3JtX2dldF9yZXNvdXJjZV9ieW5hbWUocGRldiwgSU9SRVNPVVJDRV9NRU0sICJkcCIpOworCWRw
LT5pb21lbSA9IGRldm1faW9yZW1hcF9yZXNvdXJjZShkcC0+ZGV2LCByZXMpOworCWlmIChJU19F
UlIoZHAtPmlvbWVtKSkKKwkJcmV0dXJuIFBUUl9FUlIoZHAtPmlvbWVtKTsKKworCWRwLT5pcnEg
PSBwbGF0Zm9ybV9nZXRfaXJxKHBkZXYsIDApOworCWlmIChkcC0+aXJxIDwgMCkKKwkJcmV0dXJu
IGRwLT5pcnE7CisKKwlkcC0+cmVzZXQgPSBkZXZtX3Jlc2V0X2NvbnRyb2xfZ2V0KGRwLT5kZXYs
IE5VTEwpOworCWlmIChJU19FUlIoZHAtPnJlc2V0KSkgeworCQlpZiAoUFRSX0VSUihkcC0+cmVz
ZXQpICE9IC1FUFJPQkVfREVGRVIpCisJCQlkZXZfZXJyKGRwLT5kZXYsICJmYWlsZWQgdG8gZ2V0
IHJlc2V0OiAlbGRcbiIsCisJCQkJUFRSX0VSUihkcC0+cmVzZXQpKTsKKwkJcmV0dXJuIFBUUl9F
UlIoZHAtPnJlc2V0KTsKKwl9CisKKwlyZXQgPSB6eW5xbXBfZHBfcGh5X3Byb2JlKGRwKTsKKwlp
ZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJLyogSW5pdGlhbGl6ZSB0aGUgaGFyZHdhcmUuICov
CisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfVFhfUEhZX1BPV0VSX0RPV04sCisJCQla
WU5RTVBfRFBfVFhfUEhZX1BPV0VSX0RPV05fQUxMKTsKKwl6eW5xbXBfZHBfc2V0KGRwLCBaWU5R
TVBfRFBfUEhZX1JFU0VULCBaWU5RTVBfRFBfUEhZX1JFU0VUX0FMTF9SRVNFVCk7CisJenlucW1w
X2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfRk9SQ0VfU0NSQU1CTEVSX1JFU0VULCAxKTsKKwl6eW5x
bXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9UUkFOU01JVFRFUl9FTkFCTEUsIDApOworCXp5bnFt
cF9kcF93cml0ZShkcCwgWllOUU1QX0RQX0lOVF9EUywgMHhmZmZmZmZmZik7CisKKwlyZXQgPSB6
eW5xbXBfZHBfcGh5X2luaXQoZHApOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwl6eW5x
bXBfZHBfd3JpdGUoZHAsIFpZTlFNUF9EUF9UUkFOU01JVFRFUl9FTkFCTEUsIDEpOworCisJLyoK
KwkgKiBOb3cgdGhhdCB0aGUgaGFyZHdhcmUgaXMgaW5pdGlhbGl6ZWQgYW5kIHdvbid0IGdlbmVy
YXRlIHNwdXJpb3VzCisJICogaW50ZXJydXB0cywgcmVxdWVzdCB0aGUgSVJRLgorCSAqLworCXJl
dCA9IGRldm1fcmVxdWVzdF90aHJlYWRlZF9pcnEoZHAtPmRldiwgZHAtPmlycSwgTlVMTCwKKwkJ
CQkJenlucW1wX2RwX2lycV9oYW5kbGVyLCBJUlFGX09ORVNIT1QsCisJCQkJCWRldl9uYW1lKGRw
LT5kZXYpLCBkcCk7CisJaWYgKHJldCA8IDApCisJCWdvdG8gZXJyb3I7CisKKwlkZXZfZGJnKGRw
LT5kZXYsICJaeW5xTVAgRGlzcGxheVBvcnQgVHggcHJvYmVkIHdpdGggJXUgbGFuZXNcbiIsCisJ
CWRwLT5udW1fbGFuZXMpOworCisJcmV0dXJuIDA7CisKK2Vycm9yOgorCXp5bnFtcF9kcF9waHlf
ZXhpdChkcCk7CisJcmV0dXJuIHJldDsKK30KKwordm9pZCB6eW5xbXBfZHBfcmVtb3ZlKHN0cnVj
dCB6eW5xbXBfZHBzdWIgKmRwc3ViKQoreworCXN0cnVjdCB6eW5xbXBfZHAgKmRwID0gZHBzdWIt
PmRwOworCisJenlucW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfSU5UX0RTLCBaWU5RTVBfRFBf
SU5UX0FMTCk7CisJZGlzYWJsZV9pcnEoZHAtPmlycSk7CisKKwljYW5jZWxfZGVsYXllZF93b3Jr
X3N5bmMoJmRwLT5ocGRfd29yayk7CisJenlucW1wX2RwX2F1eF9jbGVhbnVwKGRwKTsKKworCXp5
bnFtcF9kcF93cml0ZShkcCwgWllOUU1QX0RQX1RSQU5TTUlUVEVSX0VOQUJMRSwgMCk7CisJenlu
cW1wX2RwX3dyaXRlKGRwLCBaWU5RTVBfRFBfSU5UX0RTLCAweGZmZmZmZmZmKTsKKworCXp5bnFt
cF9kcF9waHlfZXhpdChkcCk7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0veGxueC96
eW5xbXBfZHAuaCBiL2RyaXZlcnMvZ3B1L2RybS94bG54L3p5bnFtcF9kcC5oCm5ldyBmaWxlIG1v
ZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uNDUwNzc0MDA5M2Y2Ci0tLSAvZGV2L251bGwK
KysrIGIvZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2RwLmgKQEAgLTAsMCArMSwyNyBAQAor
LyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAgKi8KKy8qCisgKiBaeW5xTVAgRGlz
cGxheVBvcnQgRHJpdmVyCisgKgorICogQ29weXJpZ2h0IChDKSAyMDE3IC0gMjAyMCBYaWxpbngs
IEluYy4KKyAqCisgKiBBdXRob3JzOgorICogLSBIeXVuIFdvbyBLd29uIDxoeXVuLmt3b25AeGls
aW54LmNvbT4KKyAqIC0gTGF1cmVudCBQaW5jaGFydCA8bGF1cmVudC5waW5jaGFydEBpZGVhc29u
Ym9hcmQuY29tPgorICovCisKKyNpZm5kZWYgX1pZTlFNUF9EUF9IXworI2RlZmluZSBfWllOUU1Q
X0RQX0hfCisKK3N0cnVjdCBkcm1fZGV2aWNlOworc3RydWN0IHBsYXRmb3JtX2RldmljZTsKK3N0
cnVjdCB6eW5xbXBfZHA7CitzdHJ1Y3QgenlucW1wX2Rwc3ViOworCit2b2lkIHp5bnFtcF9kcF9l
bmFibGVfdmJsYW5rKHN0cnVjdCB6eW5xbXBfZHAgKmRwKTsKK3ZvaWQgenlucW1wX2RwX2Rpc2Fi
bGVfdmJsYW5rKHN0cnVjdCB6eW5xbXBfZHAgKmRwKTsKKworaW50IHp5bnFtcF9kcF9kcm1faW5p
dChzdHJ1Y3QgenlucW1wX2Rwc3ViICpkcHN1Yik7CitpbnQgenlucW1wX2RwX3Byb2JlKHN0cnVj
dCB6eW5xbXBfZHBzdWIgKmRwc3ViLCBzdHJ1Y3QgZHJtX2RldmljZSAqZHJtKTsKK3ZvaWQgenlu
cW1wX2RwX3JlbW92ZShzdHJ1Y3QgenlucW1wX2Rwc3ViICpkcHN1Yik7CisKKyNlbmRpZiAvKiBf
WllOUU1QX0RQX0hfICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0veGxueC96eW5xbXBf
ZHBzdWIuYyBiL2RyaXZlcnMvZ3B1L2RybS94bG54L3p5bnFtcF9kcHN1Yi5jCm5ldyBmaWxlIG1v
ZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMjYzMjhjNzYzMDViCi0tLSAvZGV2L251bGwK
KysrIGIvZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rwc3ViLmMKQEAgLTAsMCArMSwzMjIg
QEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisvKgorICogWnlucU1QIERp
c3BsYXlQb3J0IFN1YnN5c3RlbSBEcml2ZXIKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMTcgLSAy
MDIwIFhpbGlueCwgSW5jLgorICoKKyAqIEF1dGhvcnM6CisgKiAtIEh5dW4gV29vIEt3b24gPGh5
dW4ua3dvbkB4aWxpbnguY29tPgorICogLSBMYXVyZW50IFBpbmNoYXJ0IDxsYXVyZW50LnBpbmNo
YXJ0QGlkZWFzb25ib2FyZC5jb20+CisgKi8KKworI2luY2x1ZGUgPGxpbnV4L2Nsay5oPgorI2lu
Y2x1ZGUgPGxpbnV4L2RtYS1tYXBwaW5nLmg+CisjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+Cisj
aW5jbHVkZSA8bGludXgvb2ZfcmVzZXJ2ZWRfbWVtLmg+CisjaW5jbHVkZSA8bGludXgvcGxhdGZv
cm1fZGV2aWNlLmg+CisjaW5jbHVkZSA8bGludXgvcG1fcnVudGltZS5oPgorCisjaW5jbHVkZSA8
ZHJtL2RybV9hdG9taWNfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9kZXZpY2UuaD4KKyNp
bmNsdWRlIDxkcm0vZHJtX2Rydi5oPgorI2luY2x1ZGUgPGRybS9kcm1fZmJfaGVscGVyLmg+Cisj
aW5jbHVkZSA8ZHJtL2RybV9mb3VyY2MuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX2dlbV9jbWFfaGVs
cGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9nZW1fZnJhbWVidWZmZXJfaGVscGVyLmg+CisjaW5j
bHVkZSA8ZHJtL2RybV9tYW5hZ2VkLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9tb2RlX2NvbmZpZy5o
PgorI2luY2x1ZGUgPGRybS9kcm1fcHJvYmVfaGVscGVyLmg+CisjaW5jbHVkZSA8ZHJtL2RybV92
YmxhbmsuaD4KKworI2luY2x1ZGUgInp5bnFtcF9kaXNwLmgiCisjaW5jbHVkZSAienlucW1wX2Rw
LmgiCisjaW5jbHVkZSAienlucW1wX2Rwc3ViLmgiCisKKy8qIC0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
CisgKiBEdW1iIEJ1ZmZlciAmIEZyYW1lYnVmZmVyIEFsbG9jYXRpb24KKyAqLworCitzdGF0aWMg
aW50IHp5bnFtcF9kcHN1Yl9kdW1iX2NyZWF0ZShzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdiwK
KwkJCQkgICAgc3RydWN0IGRybV9kZXZpY2UgKmRybSwKKwkJCQkgICAgc3RydWN0IGRybV9tb2Rl
X2NyZWF0ZV9kdW1iICphcmdzKQoreworCXN0cnVjdCB6eW5xbXBfZHBzdWIgKmRwc3ViID0gdG9f
enlucW1wX2Rwc3ViKGRybSk7CisJdW5zaWduZWQgaW50IHBpdGNoID0gRElWX1JPVU5EX1VQKGFy
Z3MtPndpZHRoICogYXJncy0+YnBwLCA4KTsKKworCS8qIEVuZm9yY2UgdGhlIGFsaWdubWVudCBj
b25zdHJhaW50cyBvZiB0aGUgRE1BIGVuZ2luZS4gKi8KKwlhcmdzLT5waXRjaCA9IEFMSUdOKHBp
dGNoLCBkcHN1Yi0+ZG1hX2FsaWduKTsKKworCXJldHVybiBkcm1fZ2VtX2NtYV9kdW1iX2NyZWF0
ZV9pbnRlcm5hbChmaWxlX3ByaXYsIGRybSwgYXJncyk7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgZHJt
X2ZyYW1lYnVmZmVyICoKK3p5bnFtcF9kcHN1Yl9mYl9jcmVhdGUoc3RydWN0IGRybV9kZXZpY2Ug
KmRybSwgc3RydWN0IGRybV9maWxlICpmaWxlX3ByaXYsCisJCSAgICAgICBjb25zdCBzdHJ1Y3Qg
ZHJtX21vZGVfZmJfY21kMiAqbW9kZV9jbWQpCit7CisJc3RydWN0IHp5bnFtcF9kcHN1YiAqZHBz
dWIgPSB0b196eW5xbXBfZHBzdWIoZHJtKTsKKwlzdHJ1Y3QgZHJtX21vZGVfZmJfY21kMiBjbWQg
PSAqbW9kZV9jbWQ7CisJdW5zaWduZWQgaW50IGk7CisKKwkvKiBFbmZvcmNlIHRoZSBhbGlnbm1l
bnQgY29uc3RyYWludHMgb2YgdGhlIERNQSBlbmdpbmUuICovCisJZm9yIChpID0gMDsgaSA8IEFS
UkFZX1NJWkUoY21kLnBpdGNoZXMpOyArK2kpCisJCWNtZC5waXRjaGVzW2ldID0gQUxJR04oY21k
LnBpdGNoZXNbaV0sIGRwc3ViLT5kbWFfYWxpZ24pOworCisJcmV0dXJuIGRybV9nZW1fZmJfY3Jl
YXRlKGRybSwgZmlsZV9wcml2LCAmY21kKTsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1f
bW9kZV9jb25maWdfZnVuY3MgenlucW1wX2Rwc3ViX21vZGVfY29uZmlnX2Z1bmNzID0geworCS5m
Yl9jcmVhdGUJCT0genlucW1wX2Rwc3ViX2ZiX2NyZWF0ZSwKKwkuYXRvbWljX2NoZWNrCQk9IGRy
bV9hdG9taWNfaGVscGVyX2NoZWNrLAorCS5hdG9taWNfY29tbWl0CQk9IGRybV9hdG9taWNfaGVs
cGVyX2NvbW1pdCwKK307CisKKy8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisgKiBEUk0vS01TIERy
aXZlcgorICovCisKK0RFRklORV9EUk1fR0VNX0NNQV9GT1BTKHp5bnFtcF9kcHN1Yl9kcm1fZm9w
cyk7CisKK3N0YXRpYyBzdHJ1Y3QgZHJtX2RyaXZlciB6eW5xbXBfZHBzdWJfZHJtX2RyaXZlciA9
IHsKKwkuZHJpdmVyX2ZlYXR1cmVzCQk9IERSSVZFUl9NT0RFU0VUIHwgRFJJVkVSX0dFTSB8CisJ
CQkJCSAgRFJJVkVSX0FUT01JQywKKworCS5wcmltZV9oYW5kbGVfdG9fZmQJCT0gZHJtX2dlbV9w
cmltZV9oYW5kbGVfdG9fZmQsCisJLnByaW1lX2ZkX3RvX2hhbmRsZQkJPSBkcm1fZ2VtX3ByaW1l
X2ZkX3RvX2hhbmRsZSwKKwkuZ2VtX3ByaW1lX2V4cG9ydAkJPSBkcm1fZ2VtX3ByaW1lX2V4cG9y
dCwKKwkuZ2VtX3ByaW1lX2ltcG9ydAkJPSBkcm1fZ2VtX3ByaW1lX2ltcG9ydCwKKwkuZ2VtX3By
aW1lX2dldF9zZ190YWJsZQkJPSBkcm1fZ2VtX2NtYV9wcmltZV9nZXRfc2dfdGFibGUsCisJLmdl
bV9wcmltZV9pbXBvcnRfc2dfdGFibGUJPSBkcm1fZ2VtX2NtYV9wcmltZV9pbXBvcnRfc2dfdGFi
bGUsCisJLmdlbV9wcmltZV92bWFwCQkJPSBkcm1fZ2VtX2NtYV9wcmltZV92bWFwLAorCS5nZW1f
cHJpbWVfdnVubWFwCQk9IGRybV9nZW1fY21hX3ByaW1lX3Z1bm1hcCwKKwkuZ2VtX3ByaW1lX21t
YXAJCQk9IGRybV9nZW1fY21hX3ByaW1lX21tYXAsCisJLmdlbV9mcmVlX29iamVjdF91bmxvY2tl
ZAk9IGRybV9nZW1fY21hX2ZyZWVfb2JqZWN0LAorCS5nZW1fdm1fb3BzCQkJPSAmZHJtX2dlbV9j
bWFfdm1fb3BzLAorCS5kdW1iX2NyZWF0ZQkJCT0genlucW1wX2Rwc3ViX2R1bWJfY3JlYXRlLAor
CS5kdW1iX2Rlc3Ryb3kJCQk9IGRybV9nZW1fZHVtYl9kZXN0cm95LAorCisJLmZvcHMJCQkJPSAm
enlucW1wX2Rwc3ViX2RybV9mb3BzLAorCisJLm5hbWUJCQkJPSAienlucW1wLWRwc3ViIiwKKwku
ZGVzYwkJCQk9ICJYaWxpbnggRGlzcGxheVBvcnQgU3Vic3lzdGVtIERyaXZlciIsCisJLmRhdGUJ
CQkJPSAiMjAxMzA1MDkiLAorCS5tYWpvcgkJCQk9IDEsCisJLm1pbm9yCQkJCT0gMCwKK307CisK
K3N0YXRpYyBpbnQgenlucW1wX2Rwc3ViX2RybV9pbml0KHN0cnVjdCB6eW5xbXBfZHBzdWIgKmRw
c3ViKQoreworCXN0cnVjdCBkcm1fZGV2aWNlICpkcm0gPSAmZHBzdWItPmRybTsKKwlpbnQgcmV0
OworCisJLyogSW5pdGlhbGl6ZSBtb2RlIGNvbmZpZywgdmJsYW5rIGFuZCB0aGUgS01TIHBvbGwg
aGVscGVyLiAqLworCXJldCA9IGRybW1fbW9kZV9jb25maWdfaW5pdChkcm0pOworCWlmIChyZXQg
PCAwKQorCQlnb3RvIGVycl9kZXZfcHV0OworCisJZHJtLT5tb2RlX2NvbmZpZy5mdW5jcyA9ICZ6
eW5xbXBfZHBzdWJfbW9kZV9jb25maWdfZnVuY3M7CisJZHJtLT5tb2RlX2NvbmZpZy5taW5fd2lk
dGggPSAwOworCWRybS0+bW9kZV9jb25maWcubWluX2hlaWdodCA9IDA7CisJZHJtLT5tb2RlX2Nv
bmZpZy5tYXhfd2lkdGggPSBaWU5RTVBfRElTUF9NQVhfV0lEVEg7CisJZHJtLT5tb2RlX2NvbmZp
Zy5tYXhfaGVpZ2h0ID0gWllOUU1QX0RJU1BfTUFYX0hFSUdIVDsKKworCXJldCA9IGRybV92Ymxh
bmtfaW5pdChkcm0sIDEpOworCWlmIChyZXQpCisJCWdvdG8gZXJyX2Rldl9wdXQ7CisKKwlkcm0t
PmlycV9lbmFibGVkID0gMTsKKworCWRybV9rbXNfaGVscGVyX3BvbGxfaW5pdChkcm0pOworCisJ
LyoKKwkgKiBJbml0aWFsaXplIHRoZSBESVNQIGFuZCBEUCBjb21wb25lbnRzLiBUaGlzIHdpbGwg
Y3JlYXRlcyBwbGFuZXMsCisJICogQ1JUQywgZW5jb2RlciBhbmQgY29ubmVjdG9yLiBUaGUgRElT
UCBzaG91bGQgYmUgaW5pdGlhbGl6ZWQgZmlyc3QgYXMKKwkgKiB0aGUgRFAgZW5jb2RlciBuZWVk
cyB0aGUgQ1JUQy4KKwkgKi8KKwlyZXQgPSB6eW5xbXBfZGlzcF9kcm1faW5pdChkcHN1Yik7CisJ
aWYgKHJldCkKKwkJZ290byBlcnJfcG9sbF9maW5pOworCisJcmV0ID0genlucW1wX2RwX2RybV9p
bml0KGRwc3ViKTsKKwlpZiAocmV0KQorCQlnb3RvIGVycl9wb2xsX2Zpbmk7CisKKwkvKiBSZXNl
dCBhbGwgY29tcG9uZW50cyBhbmQgcmVnaXN0ZXIgdGhlIERSTSBkZXZpY2UuICovCisJZHJtX21v
ZGVfY29uZmlnX3Jlc2V0KGRybSk7CisKKwlyZXQgPSBkcm1fZGV2X3JlZ2lzdGVyKGRybSwgMCk7
CisJaWYgKHJldCA8IDApCisJCWdvdG8gZXJyX3BvbGxfZmluaTsKKworCS8qIEluaXRpYWxpemUg
ZmJkZXYgZ2VuZXJpYyBlbXVsYXRpb24uICovCisJZHJtX2ZiZGV2X2dlbmVyaWNfc2V0dXAoZHJt
LCAyNCk7CisKKwlyZXR1cm4gMDsKKworZXJyX3BvbGxfZmluaToKKwlkcm1fa21zX2hlbHBlcl9w
b2xsX2ZpbmkoZHJtKTsKK2Vycl9kZXZfcHV0OgorCWRybV9kZXZfcHV0KGRybSk7CisJcmV0dXJu
IHJldDsKK30KKworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqIFBvd2VyIE1hbmFnZW1lbnQK
KyAqLworCitzdGF0aWMgaW50IF9fbWF5YmVfdW51c2VkIHp5bnFtcF9kcHN1Yl9zdXNwZW5kKHN0
cnVjdCBkZXZpY2UgKmRldikKK3sKKwlzdHJ1Y3QgenlucW1wX2Rwc3ViICpkcHN1YiA9IGRldl9n
ZXRfZHJ2ZGF0YShkZXYpOworCisJcmV0dXJuIGRybV9tb2RlX2NvbmZpZ19oZWxwZXJfc3VzcGVu
ZCgmZHBzdWItPmRybSk7Cit9CisKK3N0YXRpYyBpbnQgX19tYXliZV91bnVzZWQgenlucW1wX2Rw
c3ViX3Jlc3VtZShzdHJ1Y3QgZGV2aWNlICpkZXYpCit7CisJc3RydWN0IHp5bnFtcF9kcHN1YiAq
ZHBzdWIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKKworCXJldHVybiBkcm1fbW9kZV9jb25maWdf
aGVscGVyX3Jlc3VtZSgmZHBzdWItPmRybSk7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZGV2
X3BtX29wcyB6eW5xbXBfZHBzdWJfcG1fb3BzID0geworCVNFVF9TWVNURU1fU0xFRVBfUE1fT1BT
KHp5bnFtcF9kcHN1Yl9zdXNwZW5kLCB6eW5xbXBfZHBzdWJfcmVzdW1lKQorfTsKKworLyogLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0KKyAqIFByb2JlICYgUmVtb3ZlCisgKi8KKworc3RhdGljIGludCB6
eW5xbXBfZHBzdWJfaW5pdF9jbG9ja3Moc3RydWN0IHp5bnFtcF9kcHN1YiAqZHBzdWIpCit7CisJ
aW50IHJldDsKKworCWRwc3ViLT5hcGJfY2xrID0gZGV2bV9jbGtfZ2V0KGRwc3ViLT5kZXYsICJk
cF9hcGJfY2xrIik7CisJaWYgKElTX0VSUihkcHN1Yi0+YXBiX2NsaykpCisJCXJldHVybiBQVFJf
RVJSKGRwc3ViLT5hcGJfY2xrKTsKKworCXJldCA9IGNsa19wcmVwYXJlX2VuYWJsZShkcHN1Yi0+
YXBiX2Nsayk7CisJaWYgKHJldCkgeworCQlkZXZfZXJyKGRwc3ViLT5kZXYsICJmYWlsZWQgdG8g
ZW5hYmxlIHRoZSBBUEIgY2xvY2tcbiIpOworCQlyZXR1cm4gcmV0OworCX0KKworCXJldHVybiAw
OworfQorCitzdGF0aWMgaW50IHp5bnFtcF9kcHN1Yl9wcm9iZShzdHJ1Y3QgcGxhdGZvcm1fZGV2
aWNlICpwZGV2KQoreworCXN0cnVjdCB6eW5xbXBfZHBzdWIgKmRwc3ViOworCWludCByZXQ7CisK
KwkvKiBBbGxvY2F0ZSBwcml2YXRlIGRhdGEuICovCisJZHBzdWIgPSBremFsbG9jKHNpemVvZigq
ZHBzdWIpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWRwc3ViKQorCQlyZXR1cm4gLUVOT01FTTsKKwor
CWRwc3ViLT5kZXYgPSAmcGRldi0+ZGV2OworCXBsYXRmb3JtX3NldF9kcnZkYXRhKHBkZXYsIGRw
c3ViKTsKKworCWRtYV9zZXRfbWFzayhkcHN1Yi0+ZGV2LCBETUFfQklUX01BU0soWllOUU1QX0RJ
U1BfTUFYX0RNQV9CSVQpKTsKKworCS8qCisJICogSW5pdGlhbGl6ZSB0aGUgRFJNIGRldmljZSBl
YXJseSwgYXMgdGhlIERSTSBjb3JlIG1hbmRhdGVzIHVzYWdlIG9mCisJICogdGhlIG1hbmFnZWQg
bWVtb3J5IGhlbHBlcnMgdGllZCB0byB0aGUgRFJNIGRldmljZS4KKwkgKi8KKwlyZXQgPSBkcm1f
ZGV2X2luaXQoJmRwc3ViLT5kcm0sICZ6eW5xbXBfZHBzdWJfZHJtX2RyaXZlciwgJnBkZXYtPmRl
dik7CisJaWYgKHJldCA8IDApIHsKKwkJa2ZyZWUoZHBzdWIpOworCQlyZXR1cm4gcmV0OworCX0K
KworCWRybW1fYWRkX2ZpbmFsX2tmcmVlKCZkcHN1Yi0+ZHJtLCBkcHN1Yik7CisKKwkvKiBUcnkg
dGhlIHJlc2VydmVkIG1lbW9yeS4gUHJvY2VlZCBpZiB0aGVyZSdzIG5vbmUuICovCisJb2ZfcmVz
ZXJ2ZWRfbWVtX2RldmljZV9pbml0KCZwZGV2LT5kZXYpOworCisJcmV0ID0genlucW1wX2Rwc3Vi
X2luaXRfY2xvY2tzKGRwc3ViKTsKKwlpZiAocmV0IDwgMCkKKwkJZ290byBlcnJfbWVtOworCisJ
cG1fcnVudGltZV9lbmFibGUoJnBkZXYtPmRldik7CisKKwkvKgorCSAqIERQIHNob3VsZCBiZSBw
cm9iZWQgZmlyc3Qgc28gdGhhdCB0aGUgenlucW1wX2Rpc3AgY2FuIHNldCB0aGUgb3V0cHV0CisJ
ICogZm9ybWF0IGFjY29yZGluZ2x5LgorCSAqLworCXJldCA9IHp5bnFtcF9kcF9wcm9iZShkcHN1
YiwgJmRwc3ViLT5kcm0pOworCWlmIChyZXQpCisJCWdvdG8gZXJyX3BtOworCisJcmV0ID0genlu
cW1wX2Rpc3BfcHJvYmUoZHBzdWIsICZkcHN1Yi0+ZHJtKTsKKwlpZiAocmV0KQorCQlnb3RvIGVy
cl9kcDsKKworCXJldCA9IHp5bnFtcF9kcHN1Yl9kcm1faW5pdChkcHN1Yik7CisJaWYgKHJldCkK
KwkJZ290byBlcnJfZGlzcDsKKworCWRldl9pbmZvKCZwZGV2LT5kZXYsICJaeW5xTVAgRGlzcGxh
eVBvcnQgU3Vic3lzdGVtIGRyaXZlciBwcm9iZWQiKTsKKworCXJldHVybiAwOworCitlcnJfZGlz
cDoKKwl6eW5xbXBfZGlzcF9yZW1vdmUoZHBzdWIpOworZXJyX2RwOgorCXp5bnFtcF9kcF9yZW1v
dmUoZHBzdWIpOworZXJyX3BtOgorCXBtX3J1bnRpbWVfZGlzYWJsZSgmcGRldi0+ZGV2KTsKKwlj
bGtfZGlzYWJsZV91bnByZXBhcmUoZHBzdWItPmFwYl9jbGspOworZXJyX21lbToKKwlvZl9yZXNl
cnZlZF9tZW1fZGV2aWNlX3JlbGVhc2UoJnBkZXYtPmRldik7CisJcmV0dXJuIHJldDsKK30KKwor
c3RhdGljIGludCB6eW5xbXBfZHBzdWJfcmVtb3ZlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBk
ZXYpCit7CisJc3RydWN0IHp5bnFtcF9kcHN1YiAqZHBzdWIgPSBwbGF0Zm9ybV9nZXRfZHJ2ZGF0
YShwZGV2KTsKKwlzdHJ1Y3QgZHJtX2RldmljZSAqZHJtID0gJmRwc3ViLT5kcm07CisKKwlkcm1f
ZGV2X3VucmVnaXN0ZXIoZHJtKTsKKwlkcm1fYXRvbWljX2hlbHBlcl9zaHV0ZG93bihkcm0pOwor
CWRybV9rbXNfaGVscGVyX3BvbGxfZmluaShkcm0pOworCisJenlucW1wX2Rpc3BfcmVtb3ZlKGRw
c3ViKTsKKwl6eW5xbXBfZHBfcmVtb3ZlKGRwc3ViKTsKKworCXBtX3J1bnRpbWVfZGlzYWJsZSgm
cGRldi0+ZGV2KTsKKwljbGtfZGlzYWJsZV91bnByZXBhcmUoZHBzdWItPmFwYl9jbGspOworCW9m
X3Jlc2VydmVkX21lbV9kZXZpY2VfcmVsZWFzZSgmcGRldi0+ZGV2KTsKKworCWRybV9kZXZfcHV0
KGRybSk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgenlucW1wX2Rwc3ViX3NodXRk
b3duKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpCit7CisJc3RydWN0IHp5bnFtcF9kcHN1
YiAqZHBzdWIgPSBwbGF0Zm9ybV9nZXRfZHJ2ZGF0YShwZGV2KTsKKworCWRybV9hdG9taWNfaGVs
cGVyX3NodXRkb3duKCZkcHN1Yi0+ZHJtKTsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBvZl9k
ZXZpY2VfaWQgenlucW1wX2Rwc3ViX29mX21hdGNoW10gPSB7CisJeyAuY29tcGF0aWJsZSA9ICJ4
bG54LHp5bnFtcC1kcHN1Yi0xLjciLCB9LAorCXsgLyogZW5kIG9mIHRhYmxlICovIH0sCit9Owor
TU9EVUxFX0RFVklDRV9UQUJMRShvZiwgenlucW1wX2Rwc3ViX29mX21hdGNoKTsKKworc3RhdGlj
IHN0cnVjdCBwbGF0Zm9ybV9kcml2ZXIgenlucW1wX2Rwc3ViX2RyaXZlciA9IHsKKwkucHJvYmUJ
CQk9IHp5bnFtcF9kcHN1Yl9wcm9iZSwKKwkucmVtb3ZlCQkJPSB6eW5xbXBfZHBzdWJfcmVtb3Zl
LAorCS5zaHV0ZG93bgkJPSB6eW5xbXBfZHBzdWJfc2h1dGRvd24sCisJLmRyaXZlcgkJCT0gewor
CQkubmFtZQkJPSAienlucW1wLWRwc3ViIiwKKwkJLnBtCQk9ICZ6eW5xbXBfZHBzdWJfcG1fb3Bz
LAorCQkub2ZfbWF0Y2hfdGFibGUJPSB6eW5xbXBfZHBzdWJfb2ZfbWF0Y2gsCisJfSwKK307CisK
K21vZHVsZV9wbGF0Zm9ybV9kcml2ZXIoenlucW1wX2Rwc3ViX2RyaXZlcik7CisKK01PRFVMRV9B
VVRIT1IoIlhpbGlueCwgSW5jLiIpOworTU9EVUxFX0RFU0NSSVBUSU9OKCJaeW5xTVAgRFAgU3Vi
c3lzdGVtIERyaXZlciIpOworTU9EVUxFX0xJQ0VOU0UoIkdQTCB2MiIpOwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL3hsbngvenlucW1wX2Rwc3ViLmggYi9kcml2ZXJzL2dwdS9kcm0veGxu
eC96eW5xbXBfZHBzdWIuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAu
LmMwNDAyNmQ4MjYzOQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS94bG54L3p5
bnFtcF9kcHN1Yi5oCkBAIC0wLDAgKzEsNTQgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVy
OiBHUEwtMi4wICovCisvKgorICogWnlucU1QIERQU1VCIFN1YnN5c3RlbSBEcml2ZXIKKyAqCisg
KiBDb3B5cmlnaHQgKEMpIDIwMTcgLSAyMDIwIFhpbGlueCwgSW5jLgorICoKKyAqIEF1dGhvcnM6
CisgKiAtIEh5dW4gV29vIEt3b24gPGh5dW4ua3dvbkB4aWxpbnguY29tPgorICogLSBMYXVyZW50
IFBpbmNoYXJ0IDxsYXVyZW50LnBpbmNoYXJ0QGlkZWFzb25ib2FyZC5jb20+CisgKi8KKworI2lm
bmRlZiBfWllOUU1QX0RQU1VCX0hfCisjZGVmaW5lIF9aWU5RTVBfRFBTVUJfSF8KKworc3RydWN0
IGNsazsKK3N0cnVjdCBkZXZpY2U7CitzdHJ1Y3QgZHJtX2RldmljZTsKK3N0cnVjdCB6eW5xbXBf
ZGlzcDsKK3N0cnVjdCB6eW5xbXBfZHA7CisKK2VudW0genlucW1wX2Rwc3ViX2Zvcm1hdCB7CisJ
WllOUU1QX0RQU1VCX0ZPUk1BVF9SR0IsCisJWllOUU1QX0RQU1VCX0ZPUk1BVF9ZQ1JDQjQ0NCwK
KwlaWU5RTVBfRFBTVUJfRk9STUFUX1lDUkNCNDIyLAorCVpZTlFNUF9EUFNVQl9GT1JNQVRfWU9O
TFksCit9OworCisvKioKKyAqIHN0cnVjdCB6eW5xbXBfZHBzdWIgLSBaeW5xTVAgRGlzcGxheVBv
cnQgU3Vic3lzdGVtCisgKiBAZHJtOiBUaGUgRFJNL0tNUyBkZXZpY2UKKyAqIEBkZXY6IFRoZSBw
aHlzaWNhbCBkZXZpY2UKKyAqIEBhcGJfY2xrOiBUaGUgQVBCIGNsb2NrCisgKiBAZGlzcDogVGhl
IGRpc3BsYXkgY29udHJvbGxlcgorICogQGRwOiBUaGUgRGlzcGxheVBvcnQgY29udHJvbGxlcgor
ICogQGRtYV9hbGlnbjogRE1BIGFsaWdubWVudCBjb25zdHJhaW50IChtdXN0IGJlIGEgcG93ZXIg
b2YgMikKKyAqLworc3RydWN0IHp5bnFtcF9kcHN1YiB7CisJc3RydWN0IGRybV9kZXZpY2UgZHJt
OworCXN0cnVjdCBkZXZpY2UgKmRldjsKKworCXN0cnVjdCBjbGsgKmFwYl9jbGs7CisKKwlzdHJ1
Y3QgenlucW1wX2Rpc3AgKmRpc3A7CisJc3RydWN0IHp5bnFtcF9kcCAqZHA7CisKKwl1bnNpZ25l
ZCBpbnQgZG1hX2FsaWduOworfTsKKworc3RhdGljIGlubGluZSBzdHJ1Y3QgenlucW1wX2Rwc3Vi
ICp0b196eW5xbXBfZHBzdWIoc3RydWN0IGRybV9kZXZpY2UgKmRybSkKK3sKKwlyZXR1cm4gY29u
dGFpbmVyX29mKGRybSwgc3RydWN0IHp5bnFtcF9kcHN1YiwgZHJtKTsKK30KKworI2VuZGlmIC8q
IF9aWU5RTVBfRFBTVUJfSF8gKi8KLS0gClJlZ2FyZHMsCgpMYXVyZW50IFBpbmNoYXJ0CgpfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFp
bGluZyBsaXN0CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5m
cmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWwK
