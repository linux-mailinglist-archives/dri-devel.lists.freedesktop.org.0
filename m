Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id B3BE496CFA
	for <lists+dri-devel@lfdr.de>; Wed, 21 Aug 2019 01:15:23 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 410786E8C4;
	Tue, 20 Aug 2019 23:15:21 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-pf1-x443.google.com (mail-pf1-x443.google.com
 [IPv6:2607:f8b0:4864:20::443])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 23ADE88894;
 Tue, 20 Aug 2019 23:15:20 +0000 (UTC)
Received: by mail-pf1-x443.google.com with SMTP id b24so113876pfp.1;
 Tue, 20 Aug 2019 16:15:20 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=P4DqP7QEK94+1Gku+4oxR+UEtdt6lfhW9qrWkYTmrm0=;
 b=eZv6txRdrH/nQQz6W9pobuKSz6yWxzPQoVBwRSRf8SoZwiwZnxySDNqylkujVKbhBK
 gG0GPeSn/Fx3JmXZKyVMlV4wYyqWmCtFKMTBqaUu489/po5+MZdahzj6N3INmmlV+np4
 1CsNDJLQL2ycJq5CyBTiPHQ6Qn0sccPOdzHars89Fdldgjj7ld40tFm17WajGDcLh4JP
 6R6IyYTNWawjrRp4PrV564EykObDnGFybu07Hx3Vek5APUPnAp3HVr7ONgtiQIHUNWBU
 7r+NORDbLVjlQ202xRjtYDjubYBoN/r/5Ffqem4fu/7eX9K6vLyogIPTUhbKRUwlS6WN
 mXwQ==
X-Gm-Message-State: APjAAAUh/gnrZo5VzSDqvrZ4OOrOt2NDJJ39LS84lp8cHBql1eAxUkkh
 0qN79jW3yLC+aeG6gjRd7Y7g0MyOrCI=
X-Google-Smtp-Source: APXvYqw3byR+E/rFXK0tamYcHiDaVtGc/wXLE5AD1XLZECK+RZL9p3RB4bJ/1eDgmu+NgWnNYPZpWg==
X-Received: by 2002:a63:5648:: with SMTP id g8mr26329980pgm.81.1566342919199; 
 Tue, 20 Aug 2019 16:15:19 -0700 (PDT)
Received: from localhost ([100.118.89.196])
 by smtp.gmail.com with ESMTPSA id k22sm21887604pfk.157.2019.08.20.16.15.18
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 20 Aug 2019 16:15:18 -0700 (PDT)
From: Rob Clark <robdclark@gmail.com>
To: dri-devel@lists.freedesktop.org
Subject: [PATCH] drm/msm/dpu: fix "frame done" timeouts
Date: Tue, 20 Aug 2019 16:12:28 -0700
Message-Id: <20190820231301.28445-1-robdclark@gmail.com>
X-Mailer: git-send-email 2.21.0
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=P4DqP7QEK94+1Gku+4oxR+UEtdt6lfhW9qrWkYTmrm0=;
 b=l1Jlh9v8yFIh1I4x00eju6HVusBfXMpANMF0wTStBschH9ne2Lx8J8F4XSW9uNfAJl
 SyzPyL/7vxXH3JiNV4z/mZVZsdH273B6gE3q7efnj/UJl8QNktzpktZ26K5OlOc5zJuv
 NS/JU7P8RDey83Z6UPYXlzDAWyFJvlJVb15OcxzffkAEjQLpJwN9GAoudWtxYtVPab8j
 lQwwnn/7H7tB3kMx8ntEIJn7HPr6ko0pFu7nn5fOoKfk4w9PuFw4Th0Byj5Gpds0+0Bh
 R9apU5q6EszwqxtXghPjdW2JvHY38mkPhU9gVVsBNnDx9P8rAhF7q5fPtc1rdKzuaF9B
 U6/g==
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Rob Clark <robdclark@chromium.org>, Bruce Wang <bzwang@chromium.org>,
 Fritz Koenig <frkoenig@google.com>, David Airlie <airlied@linux.ie>,
 linux-arm-msm@vger.kernel.org, Abhinav Kumar <abhinavk@codeaurora.org>,
 linux-kernel@vger.kernel.org, Jayant Shekhar <jshekhar@codeaurora.org>,
 Sean Paul <seanpaul@chromium.org>, freedreno@lists.freedesktop.org,
 Sean Paul <sean@poorly.run>, Sravanthi Kollukuduru <skolluku@codeaurora.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogUm9iIENsYXJrIDxyb2JkY2xhcmtAY2hyb21pdW0ub3JnPgoKUHJldmlvdXNseSwgZHB1
X2NydGNfZnJhbWVfZXZlbnRfd29yaygpIHdvdWxkIHRyeSB0byBhcXVpcmUgYWxsIHRoZQptb2Rl
c2V0IGxvY2tzIGluIG9yZGVyIHRvIGNoZWNrIHdoZXRoZXIgaXQgY2FuIHJlbGVhc2UgYmFuZHdp
ZHRoLiAgKElmCndlIG9ubHkgaGF2ZSBjbWQtbW9kZSBkaXNwbGF5LCBiYW5kd2lkdGggY2FuIGJl
IHJlbGVhc2VkIGF0IGZyYW1lLWRvbmUKdGltZS4pCgpUaGUgcHJvYmxlbSB3aXRoIHRoaXMgaXMg
dGhhdCBpdCBpcyBhbHNvIHJlc3BvbnNpYmxlIGZvciBzaWduYWxsaW5nCmZyYW1lX2RvbmVfY29t
cCwgd2hpY2ggZHB1X2NydGNfY29tbWl0X2tpY2tvZmYoKSB3YWl0cyBvbiBpZiB0aGVyZSBpcwph
bHJlYWR5IGEgZnJhbWUgcGVuZGluZy4gIFRoaXMgaXMgY2FsbGVkIGluIHRoZSBtc21fYXRvbWlj
X2NvbW1pdF90YWlsKCkKcGF0aC4uIHdoaWNoIG1lYW5zIHRoYXQgZm9yIG5vbi1ub25ibG9jayBj
b21taXRzLCBhdCBsZWFzdCBzb21lIG9mIHRoZQptb2Rlc2V0IGxvY2tzIGFyZSBhbHJlYWR5IGhl
bGQuCgpSZS13b3JrIHRoaXMgc2NoZW1lIHRvIHVzZSBhIHJlZmVyZW5jZSBjb3VudCB0byB0cmFj
ayBvdXIgbmVlZCB0byBoYXZlCmNsb2NrcyBlbmFibGVkLiAgSXQgaXMgaW5jcmVtZW50ZWQgZm9y
IGVhY2ggYXRvbWljIGNvbW1pdCwgYW5kCmRlY3JlbWVudGVkIGluIHRoZSBjb3JyZXNwb25kaW5n
IGZyYW1lLWRvbmUuICBBZGRpdGlvbmFsbHksIGFueSBjcnRjCnVzZWQgaW4gdmlkZW8gbW9kZSBo
b2xkIGFuIGV4dHJhIHJlZmVyZW5jZSB3aGlsZSB0aGV5IGFyZSBlbmFibGVkLiAgVGhlCm5ldCBl
ZmZlY3QgaXMgdGhhdCB3ZSBjYW4gZGV0ZXJtaW5lIGluIGZyYW1lLWRvbmUgd2hldGhlciBpdCBp
cyBzYWZlIHRvCmRyb3AgYmFuZHdpZHRoIHdpdGhvdXQgbmVlZGluZyB0byBhcXVpcmUgYW55IG1v
ZGVzZXQgbG9ja3MuCgpTaWduZWQtb2ZmLWJ5OiBSb2IgQ2xhcmsgPHJvYmRjbGFya0BjaHJvbWl1
bS5vcmc+Ci0tLQogZHJpdmVycy9ncHUvZHJtL21zbS9kaXNwL2RwdTEvZHB1X2NvcmVfcGVyZi5j
IHwgMTYgKy0tLS0tLQogZHJpdmVycy9ncHUvZHJtL21zbS9kaXNwL2RwdTEvZHB1X2NydGMuYyAg
ICAgIHwgNDUgKysrKysrKysrKystLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL21zbS9kaXNwL2Rw
dTEvZHB1X2ttcy5jICAgICAgIHwgIDIgKwogZHJpdmVycy9ncHUvZHJtL21zbS9kaXNwL2RwdTEv
ZHB1X2ttcy5oICAgICAgIHwgIDggKysrKwogNCBmaWxlcyBjaGFuZ2VkLCAzOCBpbnNlcnRpb25z
KCspLCAzMyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbXNtL2Rp
c3AvZHB1MS9kcHVfY29yZV9wZXJmLmMgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL2Rpc3AvZHB1MS9k
cHVfY29yZV9wZXJmLmMKaW5kZXggNWNkYTk2ODc1ZTAzLi4wOWE0OWI1OWJiNWIgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9tc20vZGlzcC9kcHUxL2RwdV9jb3JlX3BlcmYuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vbXNtL2Rpc3AvZHB1MS9kcHVfY29yZV9wZXJmLmMKQEAgLTIxNCw3ICsy
MTQsNiBAQCBzdGF0aWMgaW50IF9kcHVfY29yZV9wZXJmX2NydGNfdXBkYXRlX2J1cyhzdHJ1Y3Qg
ZHB1X2ttcyAqa21zLAogICovCiB2b2lkIGRwdV9jb3JlX3BlcmZfY3J0Y19yZWxlYXNlX2J3KHN0
cnVjdCBkcm1fY3J0YyAqY3J0YykKIHsKLQlzdHJ1Y3QgZHJtX2NydGMgKnRtcF9jcnRjOwogCXN0
cnVjdCBkcHVfY3J0YyAqZHB1X2NydGM7CiAJc3RydWN0IGRwdV9jcnRjX3N0YXRlICpkcHVfY3N0
YXRlOwogCXN0cnVjdCBkcHVfa21zICprbXM7CkBAIC0yMzMsMjIgKzIzMiw5IEBAIHZvaWQgZHB1
X2NvcmVfcGVyZl9jcnRjX3JlbGVhc2VfYncoc3RydWN0IGRybV9jcnRjICpjcnRjKQogCWRwdV9j
cnRjID0gdG9fZHB1X2NydGMoY3J0Yyk7CiAJZHB1X2NzdGF0ZSA9IHRvX2RwdV9jcnRjX3N0YXRl
KGNydGMtPnN0YXRlKTsKIAotCS8qIG9ubHkgZG8gdGhpcyBmb3IgY29tbWFuZCBtb2RlIHJ0IGNs
aWVudCAqLwotCWlmIChkcHVfY3J0Y19nZXRfaW50Zl9tb2RlKGNydGMpICE9IElOVEZfTU9ERV9D
TUQpCisJaWYgKGF0b21pY19kZWNfcmV0dXJuKCZrbXMtPmJhbmR3aWR0aF9yZWYpID4gMCkKIAkJ
cmV0dXJuOwogCi0JLyoKLQkgKiBJZiB2aWRlbyBpbnRlcmZhY2UgcHJlc2VudCwgY21kIHBhbmVs
IGJhbmR3aWR0aCBjYW5ub3QgYmUKLQkgKiByZWxlYXNlZC4KLQkgKi8KLQlpZiAoZHB1X2NydGNf
Z2V0X2ludGZfbW9kZShjcnRjKSA9PSBJTlRGX01PREVfQ01EKQotCQlkcm1fZm9yX2VhY2hfY3J0
Yyh0bXBfY3J0YywgY3J0Yy0+ZGV2KSB7Ci0JCQlpZiAodG1wX2NydGMtPmVuYWJsZWQgJiYKLQkJ
CQlkcHVfY3J0Y19nZXRfaW50Zl9tb2RlKHRtcF9jcnRjKSA9PQotCQkJCQkJSU5URl9NT0RFX1ZJ
REVPKQotCQkJCXJldHVybjsKLQkJfQotCiAJLyogUmVsZWFzZSB0aGUgYmFuZHdpZHRoICovCiAJ
aWYgKGttcy0+cGVyZi5lbmFibGVfYndfcmVsZWFzZSkgewogCQl0cmFjZV9kcHVfY21kX3JlbGVh
c2VfYncoY3J0Yy0+YmFzZS5pZCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbXNtL2Rp
c3AvZHB1MS9kcHVfY3J0Yy5jIGIvZHJpdmVycy9ncHUvZHJtL21zbS9kaXNwL2RwdTEvZHB1X2Ny
dGMuYwppbmRleCBiMzQxN2Q1NjAzMmQuLjRlNTQ1NTBjNGE4MCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL21zbS9kaXNwL2RwdTEvZHB1X2NydGMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
bXNtL2Rpc3AvZHB1MS9kcHVfY3J0Yy5jCkBAIC0yOTIsMTkgKzI5Miw2IEBAIHZvaWQgZHB1X2Ny
dGNfdmJsYW5rX2NhbGxiYWNrKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykKIAl0cmFjZV9kcHVfY3J0
Y192YmxhbmtfY2IoRFJNSUQoY3J0YykpOwogfQogCi1zdGF0aWMgdm9pZCBkcHVfY3J0Y19yZWxl
YXNlX2J3X3VubG9ja2VkKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykKLXsKLQlpbnQgcmV0ID0gMDsK
LQlzdHJ1Y3QgZHJtX21vZGVzZXRfYWNxdWlyZV9jdHggY3R4OwotCi0JRFJNX01PREVTRVRfTE9D
S19BTExfQkVHSU4oY3J0Yy0+ZGV2LCBjdHgsIDAsIHJldCk7Ci0JZHB1X2NvcmVfcGVyZl9jcnRj
X3JlbGVhc2VfYncoY3J0Yyk7Ci0JRFJNX01PREVTRVRfTE9DS19BTExfRU5EKGN0eCwgcmV0KTsK
LQlpZiAocmV0KQotCQlEUk1fRVJST1IoIkZhaWxlZCB0byBhY3F1aXJlIG1vZGVzZXQgbG9ja3Mg
dG8gcmVsZWFzZSBidywgJWRcbiIsCi0JCQkgIHJldCk7Ci19Ci0KIHN0YXRpYyB2b2lkIGRwdV9j
cnRjX2ZyYW1lX2V2ZW50X3dvcmsoc3RydWN0IGt0aHJlYWRfd29yayAqd29yaykKIHsKIAlzdHJ1
Y3QgZHB1X2NydGNfZnJhbWVfZXZlbnQgKmZldmVudCA9IGNvbnRhaW5lcl9vZih3b3JrLApAQCAt
MzM0LDcgKzMyMSw3IEBAIHN0YXRpYyB2b2lkIGRwdV9jcnRjX2ZyYW1lX2V2ZW50X3dvcmsoc3Ry
dWN0IGt0aHJlYWRfd29yayAqd29yaykKIAkJCS8qIHJlbGVhc2UgYmFuZHdpZHRoIGFuZCBvdGhl
ciByZXNvdXJjZXMgKi8KIAkJCXRyYWNlX2RwdV9jcnRjX2ZyYW1lX2V2ZW50X2RvbmUoRFJNSUQo
Y3J0YyksCiAJCQkJCQkJZmV2ZW50LT5ldmVudCk7Ci0JCQlkcHVfY3J0Y19yZWxlYXNlX2J3X3Vu
bG9ja2VkKGNydGMpOworCQkJZHB1X2NvcmVfcGVyZl9jcnRjX3JlbGVhc2VfYncoY3J0Yyk7CiAJ
CX0gZWxzZSB7CiAJCQl0cmFjZV9kcHVfY3J0Y19mcmFtZV9ldmVudF9tb3JlX3BlbmRpbmcoRFJN
SUQoY3J0YyksCiAJCQkJCQkJCWZldmVudC0+ZXZlbnQpOwpAQCAtNjUwLDcgKzYzNyw3IEBAIHZv
aWQgZHB1X2NydGNfY29tbWl0X2tpY2tvZmYoc3RydWN0IGRybV9jcnRjICpjcnRjLCBib29sIGFz
eW5jKQogCQlkcHVfZW5jb2Rlcl9wcmVwYXJlX2Zvcl9raWNrb2ZmKGVuY29kZXIsIGFzeW5jKTsK
IAogCWlmICghYXN5bmMpIHsKLQkJLyogd2FpdCBmb3IgZnJhbWVfZXZlbnRfZG9uZSBjb21wbGV0
aW9uICovCisJCS8qIHdhaXQgZm9yIHByZXZpb3VzIGZyYW1lX2V2ZW50X2RvbmUgY29tcGxldGlv
biAqLwogCQlEUFVfQVRSQUNFX0JFR0lOKCJ3YWl0X2Zvcl9mcmFtZV9kb25lX2V2ZW50Iik7CiAJ
CXJldCA9IF9kcHVfY3J0Y193YWl0X2Zvcl9mcmFtZV9kb25lKGNydGMpOwogCQlEUFVfQVRSQUNF
X0VORCgid2FpdF9mb3JfZnJhbWVfZG9uZV9ldmVudCIpOwpAQCAtNzI5LDYgKzcxNiw3IEBAIHN0
YXRpYyB2b2lkIGRwdV9jcnRjX2Rpc2FibGUoc3RydWN0IGRybV9jcnRjICpjcnRjLAogCXN0cnVj
dCBkcm1fZW5jb2RlciAqZW5jb2RlcjsKIAlzdHJ1Y3QgbXNtX2RybV9wcml2YXRlICpwcml2Owog
CXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisJYm9vbCByZWxlYXNlX2JhbmR3aWR0aCA9IGZhbHNlOwog
CiAJaWYgKCFjcnRjIHx8ICFjcnRjLT5kZXYgfHwgIWNydGMtPmRldi0+ZGV2X3ByaXZhdGUgfHwg
IWNydGMtPnN0YXRlKSB7CiAJCURQVV9FUlJPUigiaW52YWxpZCBjcnRjXG4iKTsKQEAgLTc0NSw4
ICs3MzMsMTUgQEAgc3RhdGljIHZvaWQgZHB1X2NydGNfZGlzYWJsZShzdHJ1Y3QgZHJtX2NydGMg
KmNydGMsCiAJZHJtX2NydGNfdmJsYW5rX29mZihjcnRjKTsKIAogCWRybV9mb3JfZWFjaF9lbmNv
ZGVyX21hc2soZW5jb2RlciwgY3J0Yy0+ZGV2LAotCQkJCSAgb2xkX2NydGNfc3RhdGUtPmVuY29k
ZXJfbWFzaykKKwkJCQkgIG9sZF9jcnRjX3N0YXRlLT5lbmNvZGVyX21hc2spIHsKKwkJLyogaW4g
dmlkZW8gbW9kZSwgd2UgaG9sZCBhbiBleHRyYSBiYW5kd2lkdGggcmVmZXJlbmNlCisJCSAqIGFz
IHdlIGNhbm5vdCBkcm9wIGJhbmR3aWR0aCBhdCBmcmFtZS1kb25lIGlmIGFueQorCQkgKiBjcnRj
IGlzIGJlaW5nIHVzZWQgaW4gdmlkZW8gbW9kZS4KKwkJICovCisJCWlmIChkcHVfZW5jb2Rlcl9n
ZXRfaW50Zl9tb2RlKGVuY29kZXIpID09IElOVEZfTU9ERV9WSURFTykKKwkJCXJlbGVhc2VfYmFu
ZHdpZHRoID0gdHJ1ZTsKIAkJZHB1X2VuY29kZXJfYXNzaWduX2NydGMoZW5jb2RlciwgTlVMTCk7
CisJfQogCiAJLyogd2FpdCBmb3IgZnJhbWVfZXZlbnRfZG9uZSBjb21wbGV0aW9uICovCiAJaWYg
KF9kcHVfY3J0Y193YWl0X2Zvcl9mcmFtZV9kb25lKGNydGMpKQpAQCAtNzYwLDcgKzc1NSw4IEBA
IHN0YXRpYyB2b2lkIGRwdV9jcnRjX2Rpc2FibGUoc3RydWN0IGRybV9jcnRjICpjcnRjLAogCWlm
IChhdG9taWNfcmVhZCgmZHB1X2NydGMtPmZyYW1lX3BlbmRpbmcpKSB7CiAJCXRyYWNlX2RwdV9j
cnRjX2Rpc2FibGVfZnJhbWVfcGVuZGluZyhEUk1JRChjcnRjKSwKIAkJCQkgICAgIGF0b21pY19y
ZWFkKCZkcHVfY3J0Yy0+ZnJhbWVfcGVuZGluZykpOwotCQlkcHVfY29yZV9wZXJmX2NydGNfcmVs
ZWFzZV9idyhjcnRjKTsKKwkJaWYgKHJlbGVhc2VfYmFuZHdpZHRoKQorCQkJZHB1X2NvcmVfcGVy
Zl9jcnRjX3JlbGVhc2VfYncoY3J0Yyk7CiAJCWF0b21pY19zZXQoJmRwdV9jcnRjLT5mcmFtZV9w
ZW5kaW5nLCAwKTsKIAl9CiAKQEAgLTc5Miw2ICs3ODgsNyBAQCBzdGF0aWMgdm9pZCBkcHVfY3J0
Y19lbmFibGUoc3RydWN0IGRybV9jcnRjICpjcnRjLAogCXN0cnVjdCBkcHVfY3J0YyAqZHB1X2Ny
dGM7CiAJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyOwogCXN0cnVjdCBtc21fZHJtX3ByaXZh
dGUgKnByaXY7CisJYm9vbCByZXF1ZXN0X2JhbmR3aWR0aDsKIAogCWlmICghY3J0YyB8fCAhY3J0
Yy0+ZGV2IHx8ICFjcnRjLT5kZXYtPmRldl9wcml2YXRlKSB7CiAJCURQVV9FUlJPUigiaW52YWxp
ZCBjcnRjXG4iKTsKQEAgLTgwNCw5ICs4MDEsMTkgQEAgc3RhdGljIHZvaWQgZHB1X2NydGNfZW5h
YmxlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKIAlEUk1fREVCVUdfS01TKCJjcnRjJWRcbiIsIGNy
dGMtPmJhc2UuaWQpOwogCWRwdV9jcnRjID0gdG9fZHB1X2NydGMoY3J0Yyk7CiAKLQlkcm1fZm9y
X2VhY2hfZW5jb2Rlcl9tYXNrKGVuY29kZXIsIGNydGMtPmRldiwgY3J0Yy0+c3RhdGUtPmVuY29k
ZXJfbWFzaykKKwlkcm1fZm9yX2VhY2hfZW5jb2Rlcl9tYXNrKGVuY29kZXIsIGNydGMtPmRldiwg
Y3J0Yy0+c3RhdGUtPmVuY29kZXJfbWFzaykgeworCQkvKiBpbiB2aWRlbyBtb2RlLCB3ZSBob2xk
IGFuIGV4dHJhIGJhbmR3aWR0aCByZWZlcmVuY2UKKwkJICogYXMgd2UgY2Fubm90IGRyb3AgYmFu
ZHdpZHRoIGF0IGZyYW1lLWRvbmUgaWYgYW55CisJCSAqIGNydGMgaXMgYmVpbmcgdXNlZCBpbiB2
aWRlbyBtb2RlLgorCQkgKi8KKwkJaWYgKGRwdV9lbmNvZGVyX2dldF9pbnRmX21vZGUoZW5jb2Rl
cikgPT0gSU5URl9NT0RFX1ZJREVPKQorCQkJcmVxdWVzdF9iYW5kd2lkdGggPSB0cnVlOwogCQlk
cHVfZW5jb2Rlcl9yZWdpc3Rlcl9mcmFtZV9ldmVudF9jYWxsYmFjayhlbmNvZGVyLAogCQkJCWRw
dV9jcnRjX2ZyYW1lX2V2ZW50X2NiLCAodm9pZCAqKWNydGMpOworCX0KKworCWlmIChyZXF1ZXN0
X2JhbmR3aWR0aCkKKwkJYXRvbWljX2luYygmX2RwdV9jcnRjX2dldF9rbXMoY3J0YyktPmJhbmR3
aWR0aF9yZWYpOwogCiAJdHJhY2VfZHB1X2NydGNfZW5hYmxlKERSTUlEKGNydGMpLCB0cnVlLCBk
cHVfY3J0Yyk7CiAJZHB1X2NydGMtPmVuYWJsZWQgPSB0cnVlOwpAQCAtOTgxLDYgKzk4OCw4IEBA
IHN0YXRpYyBpbnQgZHB1X2NydGNfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywK
IAkJfQogCX0KIAorCWF0b21pY19pbmMoJl9kcHVfY3J0Y19nZXRfa21zKGNydGMpLT5iYW5kd2lk
dGhfcmVmKTsKKwogCXJjID0gZHB1X2NvcmVfcGVyZl9jcnRjX2NoZWNrKGNydGMsIHN0YXRlKTsK
IAlpZiAocmMpIHsKIAkJRFBVX0VSUk9SKCJjcnRjJWQgZmFpbGVkIHBlcmZvcm1hbmNlIGNoZWNr
ICVkXG4iLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21zbS9kaXNwL2RwdTEvZHB1X2tt
cy5jIGIvZHJpdmVycy9ncHUvZHJtL21zbS9kaXNwL2RwdTEvZHB1X2ttcy5jCmluZGV4IDk5ZDBi
ZDU2OWMzOC4uNjgxOTU1ZWIyODZmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbXNtL2Rp
c3AvZHB1MS9kcHVfa21zLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL21zbS9kaXNwL2RwdTEvZHB1
X2ttcy5jCkBAIC04MDAsNiArODAwLDggQEAgc3RhdGljIGludCBkcHVfa21zX2h3X2luaXQoc3Ry
dWN0IG1zbV9rbXMgKmttcykKIAkJcmV0dXJuIHJjOwogCX0KIAorCWF0b21pY19zZXQoJmRwdV9r
bXMtPmJhbmR3aWR0aF9yZWYsIDApOworCiAJZHB1X2ttcy0+bW1pbyA9IG1zbV9pb3JlbWFwKGRw
dV9rbXMtPnBkZXYsICJtZHAiLCAibWRwIik7CiAJaWYgKElTX0VSUihkcHVfa21zLT5tbWlvKSkg
ewogCQlyYyA9IFBUUl9FUlIoZHB1X2ttcy0+bW1pbyk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vbXNtL2Rpc3AvZHB1MS9kcHVfa21zLmggYi9kcml2ZXJzL2dwdS9kcm0vbXNtL2Rpc3Av
ZHB1MS9kcHVfa21zLmgKaW5kZXggOWU0MGY1NTljNTFmLi5mZGVmMDE2ZjVjYTMgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9tc20vZGlzcC9kcHUxL2RwdV9rbXMuaAorKysgYi9kcml2ZXJz
L2dwdS9kcm0vbXNtL2Rpc3AvZHB1MS9kcHVfa21zLmgKQEAgLTEyMCw2ICsxMjAsMTQgQEAgc3Ry
dWN0IGRwdV9rbXMgewogCXN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXY7CiAJYm9vbCBycG1f
ZW5hYmxlZDsKIAlzdHJ1Y3QgZHNzX21vZHVsZV9wb3dlciBtcDsKKworCS8qIHJlZmVyZW5jZSBj
b3VudCBiYW5kd2lkdGggcmVxdWVzdHMsIHNvIHdlIGtub3cgd2hlbiB3ZSBjYW4KKwkgKiByZWxl
YXNlIGJhbmR3aWR0aC4gIEVhY2ggYXRvbWljIHVwZGF0ZSBpbmNyZW1lbnRzLCBhbmQgZnJhbWUt
CisJICogZG9uZSBldmVudCBkZWNyZW1lbnRzLiAgQWRkaXRpb25hbGx5LCBmb3IgdmlkZW8gbW9k
ZSwgdGhlCisJICogcmVmZXJlbmNlIGlzIGluY3JlbWVudGVkIHdoZW4gY3J0YyBpcyBlbmFibGVk
LCBhbmQgZGVjcmVtZW50ZWQKKwkgKiB3aGVuIGRpc2FibGVkLgorCSAqLworCWF0b21pY190IGJh
bmR3aWR0aF9yZWY7CiB9OwogCiBzdHJ1Y3QgdnN5bmNfaW5mbyB7Ci0tIAoyLjIxLjAKCl9fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZlbCBtYWls
aW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZy
ZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
