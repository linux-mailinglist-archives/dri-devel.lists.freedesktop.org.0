Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id EF95EB4449
	for <lists+dri-devel@lfdr.de>; Tue, 17 Sep 2019 00:53:28 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 23F326EAA5;
	Mon, 16 Sep 2019 22:53:26 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail.kernel.org (mail.kernel.org [198.145.29.99])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 25EA96EAA5
 for <dri-devel@lists.freedesktop.org>; Mon, 16 Sep 2019 22:53:23 +0000 (UTC)
Received: from mail-qt1-f180.google.com (mail-qt1-f180.google.com
 [209.85.160.180])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id B089F216C8
 for <dri-devel@lists.freedesktop.org>; Mon, 16 Sep 2019 22:53:23 +0000 (UTC)
Received: by mail-qt1-f180.google.com with SMTP id j1so2014970qth.1
 for <dri-devel@lists.freedesktop.org>; Mon, 16 Sep 2019 15:53:23 -0700 (PDT)
X-Gm-Message-State: APjAAAX+u36eSjeju7TNiIAWv8vsdd6T8BYGAQEHOzxwyRpbj0FWvwsi
 BY1n246+/45NTPxLDG9FCGSsd51Mk36bkrqeww==
X-Google-Smtp-Source: APXvYqwuEuHrXOmlu17UIy25Xr1b2cyMEojb0tWxCjpyaaD0/HsxQ2/AjpbU1oZxTTIE15gAQpaovXbELVesBVu5rao=
X-Received: by 2002:ac8:100d:: with SMTP id z13mr855289qti.224.1568674402842; 
 Mon, 16 Sep 2019 15:53:22 -0700 (PDT)
MIME-Version: 1.0
References: <20190905121141.42820-1-steven.price@arm.com>
 <20190913172454.GA5387@kevin>
In-Reply-To: <20190913172454.GA5387@kevin>
From: Rob Herring <robh@kernel.org>
Date: Mon, 16 Sep 2019 17:53:11 -0500
X-Gmail-Original-Message-ID: <CAL_JsqJDgNQ2gAwd+u4t0pv=dDbZoOmcu-WP+TZw+ocvtSMuQA@mail.gmail.com>
Message-ID: <CAL_JsqJDgNQ2gAwd+u4t0pv=dDbZoOmcu-WP+TZw+ocvtSMuQA@mail.gmail.com>
Subject: Re: [PATCH] drm/panfrost: Prevent race when handling page fault
To: Alyssa Rosenzweig <alyssa.rosenzweig@collabora.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=kernel.org; s=default; t=1568674403;
 bh=ddYW2WBNl6Oh0ApGXgrtqJ/jr4/K95r+xpG2bEP8o2g=;
 h=References:In-Reply-To:From:Date:Subject:To:Cc:From;
 b=UuJgjc27C9RwRkRzuYf9lOnNw77Cv037TE0Pdsl2FfGMCEO20DTER8ccUwFil+zuB
 Xb/kOcQb6ptFfJVyXYYApbx0y+eqTikYLhk1GK7KsJm4UDH8Jy4B0iaYkq+/J7ymD9
 ouDcOiYnJB9quB3wu5dcGAyrmcBxJFRO1i2J+Ji4=
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Tomeu Vizoso <tomeu.vizoso@collabora.com>, David Airlie <airlied@linux.ie>,
 "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
 dri-devel <dri-devel@lists.freedesktop.org>,
 Steven Price <steven.price@arm.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

T24gRnJpLCBTZXAgMTMsIDIwMTkgYXQgMTI6MjUgUE0gQWx5c3NhIFJvc2VuendlaWcKPGFseXNz
YS5yb3Nlbnp3ZWlnQGNvbGxhYm9yYS5jb20+IHdyb3RlOgo+Cj4gSSdtIGNvbmZsaWN0ZWQgb24g
dGhpcyBzZXJpZXMuCj4KPiBPbiB0aGUgb25lIGhhbmQsIHVzZXJzcGFjZSBzaG91bGQgb2J2aW91
c2x5IG5vdCBiZSBhYmxlIHRvIGNyYXNoIHRoZQo+IGtlcm5lbC4gU28gdGhlIGNyYXNoIHNob3Vs
ZCBiZSBmaXhlZCBpbiBvbmUgd2F5IG9yIGFub3RoZXIuCj4KPiBPbiB0aGUgb3RoZXIgaGFuZCwg
dXNlcnNwYWNlIHJlYWxseSBoYXMgdG8gc3VwcGx5IGFsbCB0aGUgQk9zIGl0IHVzZXMKPiBmb3Ig
Y29ycmVjdG5lc3MuIEkgcmVhbGl6ZSB0aGUgRERLIGRvZXNuJ3QgZG8gdGhpcyBidXQuLi4gaXQg
cHJvYmFibHkKPiBzaG91bGQsIHVtbS4uLgo+Cj4gV291bGQgaXQgYmUgcG9zc2libGUgdG8gY2hl
Y2sgZm9yIHRoZSBOVUxMIHBvaW50ZXIgaW4gdGhlIGtlcm5lbCBhbmQKPiBza2lwIHByaW50aW5n
IGluZm9ybWF0aW9uIHRoYXQgd291bGQgcmVxdWlyZSBhIGRlcmVmZXJlbmNlPyAoV2l0aG91dAo+
IGhhdmluZyB0byBwbGF5IGdhbWVzIHdpdGggcmVmZXJlbmNlIGNvdW50cykuIFByZXN1bWFibHkg
dGhhdCBtaWdodCBmaXgKPiBjcmFzaGVzIGluIG90aGVyIGNvcm5lciBjYXNlcy4KCkkgZG9uJ3Qg
dGhpbmsgdGhhdCBwcmV2ZW50cyB0aGUgdXNlIGFmdGVyIGZyZWUuIEkgdGhpbmsgdGhlIE5VTEwg
aXMgYQpwb2ludGVyIHdpdGhpbiB0aGUgQk8sIG5vdCB0aGUgQk8uIFNvIHdlJ2Qgc3RpbGwgYmUg
cmV0cmlldmluZyB0aGUKTlVMTCBwdHIgZnJvbSBhIGZyZWVkIG9iamVjdC4KClJvYgoKPgo+IE9u
IFRodSwgU2VwIDA1LCAyMDE5IGF0IDAxOjExOjQxUE0gKzAxMDAsIFN0ZXZlbiBQcmljZSB3cm90
ZToKPiA+IFdoZW4gaGFuZGxpbmcgYSBHUFUgcGFnZSBmYXVsdCBhZGRyX3RvX2RybV9tbV9ub2Rl
KCkgaXMgdXNlZCB0bwo+ID4gdHJhbnNsYXRlIHRoZSBHUFUgYWRkcmVzcyB0byBhIGJ1ZmZlciBv
YmplY3QuIEhvd2V2ZXIgaXQgaXMgcG9zc2libGUgZm9yCj4gPiB0aGUgYnVmZmVyIG9iamVjdCB0
byBiZSBmcmVlZCBhZnRlciB0aGUgZnVuY3Rpb24gaGFzIHJldHVybmVkIHJlc3VsdGluZwo+ID4g
aW4gYSB1c2UtYWZ0ZXItZnJlZSBvZiB0aGUgQk8uCj4gPgo+ID4gQ2hhbmdlIGFkZHJfdG9fZHJt
X21tX25vZGUgdG8gcmV0dXJuIHRoZSBwYW5mcm9zdF9nZW1fb2JqZWN0IHdpdGggYW4KPiA+IGV4
dHJhIHJlZmVyZW5jZSBvbiBpdCwgcHJldmVudGluZyB0aGUgQk8gZnJvbSBiZWluZyBmcmVlZCB1
bnRpbCBhZnRlcgo+ID4gdGhlIHBhZ2UgZmF1bHQgaGFzIGJlZW4gaGFuZGxlZC4KPiA+Cj4gPiBT
aWduZWQtb2ZmLWJ5OiBTdGV2ZW4gUHJpY2UgPHN0ZXZlbi5wcmljZUBhcm0uY29tPgo+ID4gLS0t
Cj4gPgo+ID4gSSd2ZSBtYW5hZ2VkIHRvIHRyaWdnZXIgdGhpcywgZ2VuZXJhdGluZyB0aGUgZm9s
bG93aW5nIHN0YWNrIHRyYWNlLgo+ID4KPiA+IFVuYWJsZSB0byBoYW5kbGUga2VybmVsIE5VTEwg
cG9pbnRlciBkZXJlZmVyZW5jZSBhdCB2aXJ0dWFsIGFkZHJlc3MgMDAwMDAwOTAKPiA+IHBnZCA9
IDMzYTZhMTgxCj4gPiBbMDAwMDAwOTBdICpwZ2Q9MDAwMDAwMDAKPiA+IEludGVybmFsIGVycm9y
OiBPb3BzOiA1IFsjMV0gU01QIEFSTQo+ID4gTW9kdWxlcyBsaW5rZWQgaW46Cj4gPiBDUFU6IDAg
UElEOiA4MSBDb21tOiBpcnEvNjAtbW11IE5vdCB0YWludGVkIDUuMy4wLXJjMSsgIzQKPiA+IEhh
cmR3YXJlIG5hbWU6IFJvY2tjaGlwIChEZXZpY2UgVHJlZSkKPiA+IFBDIGlzIGF0IHBhbmZyb3N0
X21tdV9tYXBfZmF1bHRfYWRkcisweDE0MC8weDNhMAo+ID4gTFIgaXMgYXQgX3Jhd19zcGluX3Vu
bG9jaysweDIwLzB4M2MKPiA+IHBjIDogWzxjMDUwODk0ND5dICAgIGxyIDogWzxjMDdjZWQxMD5d
ICAgIHBzcjogMjAwMzAwMTMKPiA+IHNwIDogZWM2NDNlODggIGlwIDogZWE3MGNlMjQgIGZwIDog
ZWM1ZmU4NDAKPiA+IHIxMDogMDAwMDAwMDEgIHI5IDogMDAwMDAwMDAgIHI4IDogMDAwMTc4YzkK
PiA+IHI3IDogMDAwMDAwMDAgIHI2IDogMTc4YzlmMDAgIHI1IDogZWM1ZmU5NDAgIHI0IDogZWE3
MGNlMDgKPiA+IHIzIDogMDAwMDAwMDAgIHIyIDogMDAwMDAwMDAgIHIxIDogZWM2NDBlMDAgIHIw
IDogZWM1ZmU5NDAKPiA+IEZsYWdzOiBuekN2ICBJUlFzIG9uICBGSVFzIG9uICBNb2RlIFNWQ18z
MiAgSVNBIEFSTSAgU2VnbWVudCBub25lCj4gPiBDb250cm9sOiAxMGM1Mzg3ZCAgVGFibGU6IDI5
Zjg0MDZhICBEQUM6IDAwMDAwMDUxCj4gPiBQcm9jZXNzIGlycS82MC1tbXUgKHBpZDogODEsIHN0
YWNrIGxpbWl0ID0gMHg0YjkwNzEwNikKPiA+IFN0YWNrOiAoMHhlYzY0M2U4OCB0byAweGVjNjQ0
MDAwKQo+ID4gM2U4MDogICAgICAgICAgICAgICAgICAgZWM2NDBlMDAgYzA3Y2VkZTAgYzBjMGIy
MDAgZWM2NDBlMDAgMDAwMDAwMDAgMDAwMDAwMDAKPiA+IDNlYTA6IDAwMDE3OGM5IDAwMDAwMDAw
IGMwYzBiMjAwIGMwN2NlZGUwIGVlZjkxMDQwIGVjNWZlODQwIDAwMDAwMDAxIDAwMDAwMDAwCj4g
PiAzZWMwOiAwMDAxMDAwMSAwMTAwMDNjMyAwMDAwMDBjMyAwMDAwMDAwMSAxNzhjOWYwMCBjMDUw
OGM5OCBlZWY5MTA1MCAwMDAwMDAwMAo+ID4gM2VlMDogZWM2NDNmMzQgYzA3YzkxODggMDAwMDAw
MDEgYzAxNjc4NTQgMDAwMDAwMDAgZWM2NDNlZjggYzBjMDg0NDggYzA3YzkzM2MKPiA+IDNmMDA6
IDAwMDAwMDAwIGVjNjQzZjA0IGZmZmVmZmZlIDNkMTgyYjE3IGVlMTkzNDY4IGVlMTkzNDAwIGVj
NWRiM2MwIGVjNWRiM2MwCj4gPiAzZjIwOiBjMDE4Mzg0MCBlYzVkYjNlNCBjMGNiMjg3NCBjMDE4
M2IwOCAwMDAwMDAwMSBjMDE4Mzg1YyBmZmZmZTAwMCBlZTE5MzQwMAo+ID4gM2Y0MDogZWM1ZGIz
YzAgYzAxODNiOGMgYzBjMDg0NDggMDAwMDAwMDAgNjAwMDAwMTMgMDAwMDAwMDAgYzAxODM5Yjgg
M2QxODJiMTcKPiA+IDNmNjA6IGZmZmZlMDAwIGVjNWQwNTAwIGVjNWRiMzgwIGVjNjQyMDAwIGVj
NWRiM2MwIGMwMTgzYTY0IDAwMDAwMDAwIGVkMDI1Y2Q4Cj4gPiAzZjgwOiBlYzVkMDUzOCBjMDE0
NmNmYyBlYzY0MjAwMCBlYzVkYjM4MCBjMDE0NmJjMCAwMDAwMDAwMCAwMDAwMDAwMCAwMDAwMDAw
MAo+ID4gM2ZhMDogMDAwMDAwMDAgMDAwMDAwMDAgMDAwMDAwMDAgYzAxMDEwYjQgMDAwMDAwMDAg
MDAwMDAwMDAgMDAwMDAwMDAgMDAwMDAwMDAKPiA+IDNmYzA6IDAwMDAwMDAwIDAwMDAwMDAwIDAw
MDAwMDAwIDAwMDAwMDAwIDAwMDAwMDAwIDAwMDAwMDAwIDAwMDAwMDAwIDAwMDAwMDAwCj4gPiAz
ZmUwOiAwMDAwMDAwMCAwMDAwMDAwMCAwMDAwMDAwMCAwMDAwMDAwMCAwMDAwMDAxMyAwMDAwMDAw
MCAwMDAwMDAwMCAwMDAwMDAwMAo+ID4gWzxjMDUwODk0ND5dIChwYW5mcm9zdF9tbXVfbWFwX2Zh
dWx0X2FkZHIpIGZyb20gWzxjMDUwOGM5OD5dIChwYW5mcm9zdF9tbXVfaXJxX2hhbmRsZXJfdGhy
ZWFkKzB4ZjQvMHgyNDgpCj4gPiBbPGMwNTA4Yzk4Pl0gKHBhbmZyb3N0X21tdV9pcnFfaGFuZGxl
cl90aHJlYWQpIGZyb20gWzxjMDE4Mzg1Yz5dIChpcnFfdGhyZWFkX2ZuKzB4MWMvMHg1OCkKPiA+
IFs8YzAxODM4NWM+XSAoaXJxX3RocmVhZF9mbikgZnJvbSBbPGMwMTgzYjhjPl0gKGlycV90aHJl
YWQrMHgxMjgvMHgyNDApCj4gPiBbPGMwMTgzYjhjPl0gKGlycV90aHJlYWQpIGZyb20gWzxjMDE0
NmNmYz5dIChrdGhyZWFkKzB4MTNjLzB4MTU0KQo+ID4gWzxjMDE0NmNmYz5dIChrdGhyZWFkKSBm
cm9tIFs8YzAxMDEwYjQ+XSAocmV0X2Zyb21fZm9yaysweDE0LzB4MjApCj4gPiBFeGNlcHRpb24g
c3RhY2soMHhlYzY0M2ZiMCB0byAweGVjNjQzZmY4KQo+ID4gM2ZhMDogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgMDAwMDAwMDAgMDAwMDAwMDAgMDAwMDAwMDAgMDAwMDAwMDAK
PiA+IDNmYzA6IDAwMDAwMDAwIDAwMDAwMDAwIDAwMDAwMDAwIDAwMDAwMDAwIDAwMDAwMDAwIDAw
MDAwMDAwIDAwMDAwMDAwIDAwMDAwMDAwCj4gPiAzZmUwOiAwMDAwMDAwMCAwMDAwMDAwMCAwMDAw
MDAwMCAwMDAwMDAwMCAwMDAwMDAxMyAwMDAwMDAwMAo+ID4gQ29kZTogMWFmZmZmZWMgZWFmZmZm
ZTggZTUxNDMwMDQgZTU5ZDIwMTQgKGU1OTMzMDkwKQo+ID4gLS0tWyBlbmQgdHJhY2UgMDRlYWRj
MzAwOWI4ZjUwNyBdLS0tCj4gPiAtLS0KPiA+ICBkcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFu
ZnJvc3RfbW11LmMgfCAzOCArKysrKysrKysrKysrKysrLS0tLS0tLS0tCj4gPiAgMSBmaWxlIGNo
YW5nZWQsIDI0IGluc2VydGlvbnMoKyksIDE0IGRlbGV0aW9ucygtKQo+ID4KPiA+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfbW11LmMgYi9kcml2ZXJzL2dw
dS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfbW11LmMKPiA+IGluZGV4IDg0MmJkZDdjZjZiZS4uMTE1
OTI1ZTc0NjBhIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZy
b3N0X21tdS5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfbW11
LmMKPiA+IEBAIC0zOTIsOSArMzkyLDExIEBAIHZvaWQgcGFuZnJvc3RfbW11X3BndGFibGVfZnJl
ZShzdHJ1Y3QgcGFuZnJvc3RfZmlsZV9wcml2ICpwcml2KQo+ID4gICAgICAgZnJlZV9pb19wZ3Rh
YmxlX29wcyhtbXUtPnBndGJsX29wcyk7Cj4gPiAgfQo+ID4KPiA+IC1zdGF0aWMgc3RydWN0IGRy
bV9tbV9ub2RlICphZGRyX3RvX2RybV9tbV9ub2RlKHN0cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBm
ZGV2LCBpbnQgYXMsIHU2NCBhZGRyKQo+ID4gK3N0YXRpYyBzdHJ1Y3QgcGFuZnJvc3RfZ2VtX29i
amVjdCAqCj4gPiArYWRkcl90b19kcm1fbW1fbm9kZShzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpw
ZmRldiwgaW50IGFzLCB1NjQgYWRkcikKPiA+ICB7Cj4gPiAtICAgICBzdHJ1Y3QgZHJtX21tX25v
ZGUgKm5vZGUgPSBOVUxMOwo+ID4gKyAgICAgc3RydWN0IHBhbmZyb3N0X2dlbV9vYmplY3QgKmJv
ID0gTlVMTDsKPiA+ICsgICAgIHN0cnVjdCBkcm1fbW1fbm9kZSAqbm9kZTsKPiA+ICAgICAgIHU2
NCBvZmZzZXQgPSBhZGRyID4+IFBBR0VfU0hJRlQ7Cj4gPiAgICAgICBzdHJ1Y3QgcGFuZnJvc3Rf
bW11ICptbXU7Cj4gPgo+ID4gQEAgLTQwNiwxNCArNDA4LDE3IEBAIHN0YXRpYyBzdHJ1Y3QgZHJt
X21tX25vZGUgKmFkZHJfdG9fZHJtX21tX25vZGUoc3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZk
ZXYsIGluCj4gPgo+ID4gICAgICAgICAgICAgICBwcml2ID0gY29udGFpbmVyX29mKG1tdSwgc3Ry
dWN0IHBhbmZyb3N0X2ZpbGVfcHJpdiwgbW11KTsKPiA+ICAgICAgICAgICAgICAgZHJtX21tX2Zv
cl9lYWNoX25vZGUobm9kZSwgJnByaXYtPm1tKSB7Cj4gPiAtICAgICAgICAgICAgICAgICAgICAg
aWYgKG9mZnNldCA+PSBub2RlLT5zdGFydCAmJiBvZmZzZXQgPCAobm9kZS0+c3RhcnQgKyBub2Rl
LT5zaXplKSkKPiA+ICsgICAgICAgICAgICAgICAgICAgICBpZiAob2Zmc2V0ID49IG5vZGUtPnN0
YXJ0ICYmCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCA8IChub2RlLT5zdGFy
dCArIG5vZGUtPnNpemUpKSB7Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibyA9
IGRybV9tbV9ub2RlX3RvX3BhbmZyb3N0X2JvKG5vZGUpOwo+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgZHJtX2dlbV9vYmplY3RfZ2V0KCZiby0+YmFzZS5iYXNlKTsKPiA+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0Owo+ID4gKyAgICAgICAgICAgICAgICAg
ICAgIH0KPiA+ICAgICAgICAgICAgICAgfQo+ID4gICAgICAgfQo+ID4gLQo+ID4gIG91dDoKPiA+
ICAgICAgIHNwaW5fdW5sb2NrKCZwZmRldi0+YXNfbG9jayk7Cj4gPiAtICAgICByZXR1cm4gbm9k
ZTsKPiA+ICsgICAgIHJldHVybiBibzsKPiA+ICB9Cj4gPgo+ID4gICNkZWZpbmUgTlVNX0ZBVUxU
X1BBR0VTIChTWl8yTSAvIFBBR0VfU0laRSkKPiA+IEBAIC00MjEsMjkgKzQyNiwyOCBAQCBzdGF0
aWMgc3RydWN0IGRybV9tbV9ub2RlICphZGRyX3RvX2RybV9tbV9ub2RlKHN0cnVjdCBwYW5mcm9z
dF9kZXZpY2UgKnBmZGV2LCBpbgo+ID4gIGludCBwYW5mcm9zdF9tbXVfbWFwX2ZhdWx0X2FkZHIo
c3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYsIGludCBhcywgdTY0IGFkZHIpCj4gPiAgewo+
ID4gICAgICAgaW50IHJldCwgaTsKPiA+IC0gICAgIHN0cnVjdCBkcm1fbW1fbm9kZSAqbm9kZTsK
PiA+ICAgICAgIHN0cnVjdCBwYW5mcm9zdF9nZW1fb2JqZWN0ICpibzsKPiA+ICAgICAgIHN0cnVj
dCBhZGRyZXNzX3NwYWNlICptYXBwaW5nOwo+ID4gICAgICAgcGdvZmZfdCBwYWdlX29mZnNldDsK
PiA+ICAgICAgIHN0cnVjdCBzZ190YWJsZSAqc2d0Owo+ID4gICAgICAgc3RydWN0IHBhZ2UgKipw
YWdlczsKPiA+Cj4gPiAtICAgICBub2RlID0gYWRkcl90b19kcm1fbW1fbm9kZShwZmRldiwgYXMs
IGFkZHIpOwo+ID4gLSAgICAgaWYgKCFub2RlKQo+ID4gKyAgICAgYm8gPSBhZGRyX3RvX2RybV9t
bV9ub2RlKHBmZGV2LCBhcywgYWRkcik7Cj4gPiArICAgICBpZiAoIWJvKQo+ID4gICAgICAgICAg
ICAgICByZXR1cm4gLUVOT0VOVDsKPiA+Cj4gPiAtICAgICBibyA9IGRybV9tbV9ub2RlX3RvX3Bh
bmZyb3N0X2JvKG5vZGUpOwo+ID4gICAgICAgaWYgKCFiby0+aXNfaGVhcCkgewo+ID4gICAgICAg
ICAgICAgICBkZXZfV0FSTihwZmRldi0+ZGV2LCAibWF0Y2hpbmcgQk8gaXMgbm90IGhlYXAgdHlw
ZSAoR1BVIFZBID0gJWxseCkiLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICBub2RlLT5zdGFy
dCA8PCBQQUdFX1NISUZUKTsKPiA+IC0gICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgIGJvLT5ub2RlLnN0YXJ0IDw8IFBBR0VfU0hJRlQpOwo+ID4g
KyAgICAgICAgICAgICByZXQgPSAtRUlOVkFMOwo+ID4gKyAgICAgICAgICAgICBnb3RvIGVycl9i
bzsKPiA+ICAgICAgIH0KPiA+ICAgICAgIFdBUk5fT04oYm8tPm1tdS0+YXMgIT0gYXMpOwo+ID4K
PiA+ICAgICAgIC8qIEFzc3VtZSAyTUIgYWxpZ25tZW50IGFuZCBzaXplIG11bHRpcGxlICovCj4g
PiAgICAgICBhZGRyICY9IH4oKHU2NClTWl8yTSAtIDEpOwo+ID4gICAgICAgcGFnZV9vZmZzZXQg
PSBhZGRyID4+IFBBR0VfU0hJRlQ7Cj4gPiAtICAgICBwYWdlX29mZnNldCAtPSBub2RlLT5zdGFy
dDsKPiA+ICsgICAgIHBhZ2Vfb2Zmc2V0IC09IGJvLT5ub2RlLnN0YXJ0Owo+ID4KPiA+ICAgICAg
IG11dGV4X2xvY2soJmJvLT5iYXNlLnBhZ2VzX2xvY2spOwo+ID4KPiA+IEBAIC00NTIsNyArNDU2
LDggQEAgaW50IHBhbmZyb3N0X21tdV9tYXBfZmF1bHRfYWRkcihzdHJ1Y3QgcGFuZnJvc3RfZGV2
aWNlICpwZmRldiwgaW50IGFzLCB1NjQgYWRkcikKPiA+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc2l6ZW9mKHN0cnVjdCBzZ190YWJsZSksIEdGUF9LRVJORUwgfCBfX0dGUF9a
RVJPKTsKPiA+ICAgICAgICAgICAgICAgaWYgKCFiby0+c2d0cykgewo+ID4gICAgICAgICAgICAg
ICAgICAgICAgIG11dGV4X3VubG9jaygmYm8tPmJhc2UucGFnZXNfbG9jayk7Cj4gPiAtICAgICAg
ICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gPiArICAgICAgICAgICAgICAgICAgICAg
cmV0ID0gLUVOT01FTTsKPiA+ICsgICAgICAgICAgICAgICAgICAgICBnb3RvIGVycl9ibzsKPiA+
ICAgICAgICAgICAgICAgfQo+ID4KPiA+ICAgICAgICAgICAgICAgcGFnZXMgPSBrdm1hbGxvY19h
cnJheShiby0+YmFzZS5iYXNlLnNpemUgPj4gUEFHRV9TSElGVCwKPiA+IEBAIC00NjEsNyArNDY2
LDggQEAgaW50IHBhbmZyb3N0X21tdV9tYXBfZmF1bHRfYWRkcihzdHJ1Y3QgcGFuZnJvc3RfZGV2
aWNlICpwZmRldiwgaW50IGFzLCB1NjQgYWRkcikKPiA+ICAgICAgICAgICAgICAgICAgICAgICBr
ZnJlZShiby0+c2d0cyk7Cj4gPiAgICAgICAgICAgICAgICAgICAgICAgYm8tPnNndHMgPSBOVUxM
Owo+ID4gICAgICAgICAgICAgICAgICAgICAgIG11dGV4X3VubG9jaygmYm8tPmJhc2UucGFnZXNf
bG9jayk7Cj4gPiAtICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gPiArICAg
ICAgICAgICAgICAgICAgICAgcmV0ID0gLUVOT01FTTsKPiA+ICsgICAgICAgICAgICAgICAgICAg
ICBnb3RvIGVycl9ibzsKPiA+ICAgICAgICAgICAgICAgfQo+ID4gICAgICAgICAgICAgICBiby0+
YmFzZS5wYWdlcyA9IHBhZ2VzOwo+ID4gICAgICAgICAgICAgICBiby0+YmFzZS5wYWdlc191c2Vf
Y291bnQgPSAxOwo+ID4gQEAgLTQ5OSwxMiArNTA1LDE2IEBAIGludCBwYW5mcm9zdF9tbXVfbWFw
X2ZhdWx0X2FkZHIoc3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXYsIGludCBhcywgdTY0IGFk
ZHIpCj4gPgo+ID4gICAgICAgZGV2X2RiZyhwZmRldi0+ZGV2LCAibWFwcGVkIHBhZ2UgZmF1bHQg
QCBBUyVkICVsbHgiLCBhcywgYWRkcik7Cj4gPgo+ID4gKyAgICAgZHJtX2dlbV9vYmplY3RfcHV0
X3VubG9ja2VkKCZiby0+YmFzZS5iYXNlKTsKPiA+ICsKPiA+ICAgICAgIHJldHVybiAwOwo+ID4K
PiA+ICBlcnJfbWFwOgo+ID4gICAgICAgc2dfZnJlZV90YWJsZShzZ3QpOwo+ID4gIGVycl9wYWdl
czoKPiA+ICAgICAgIGRybV9nZW1fc2htZW1fcHV0X3BhZ2VzKCZiby0+YmFzZSk7Cj4gPiArZXJy
X2JvOgo+ID4gKyAgICAgZHJtX2dlbV9vYmplY3RfcHV0X3VubG9ja2VkKCZiby0+YmFzZS5iYXNl
KTsKPiA+ICAgICAgIHJldHVybiByZXQ7Cj4gPiAgfQo+ID4KPiA+IC0tCj4gPiAyLjIwLjEKPiA+
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRyaS1kZXZl
bCBtYWlsaW5nIGxpc3QKZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xp
c3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaS1kZXZlbA==
