Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id E40992C30DD
	for <lists+dri-devel@lfdr.de>; Tue, 24 Nov 2020 20:44:24 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2AB376E542;
	Tue, 24 Nov 2020 19:44:22 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from mail-wm1-x341.google.com (mail-wm1-x341.google.com
 [IPv6:2a00:1450:4864:20::341])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 85DC46E53C
 for <dri-devel@lists.freedesktop.org>; Tue, 24 Nov 2020 19:44:10 +0000 (UTC)
Received: by mail-wm1-x341.google.com with SMTP id h21so95861wmb.2
 for <dri-devel@lists.freedesktop.org>; Tue, 24 Nov 2020 11:44:10 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=linaro.org; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=IIqYcckPAUIuPzz9N0d48R4/Xp44qFtxBobvViiQxSs=;
 b=FWwlELgbpuhWp7fuDZ4mpudOUfTNDvRd/0peRh0Nn70tWsFpHlDh2E2OV84IoJSBP6
 2Uj8i2Wx5vDBRH3kcOq9sIa9/dRGNpbeUM1/5DIWaN9OELfj9Z6EHhk1u49iiaRk8zMc
 WIKMdhDyyPblEjIwTRqqrgOryFb/KbjTw1pSd0moXcTdLrrGZmgu1iirv6JX8O3zBwfx
 iXQ6pTAQp0wXas6WdV7EjcFlfxW6gg88FFJ7nCtKvFr4t7UCuKLDQCu3ET2B0KsuK1Cn
 2AoC7KGWm6/LxYdIb3xlJyoNbnhbhZMBIPZDvbZlv3wHE41vq+RuD7OByq5zoB9CRk3D
 +t1A==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=IIqYcckPAUIuPzz9N0d48R4/Xp44qFtxBobvViiQxSs=;
 b=XBwXEDnJ0Rl2FY7/WbJgePZZwZdmz9E/1hi2Mq6HKYBNFtFZIE6OHX77nW3nYJYHVL
 pPJbvuc+TevmObMmeGDxsmmoz0UorWRIUes2sdQe2vcK4SB6gd6yW+Q3McLNbGNe0yX5
 1Ok5fP3fJJmlAcRTEAgNLene6KEA45viScdrlNVKU6uOT5xWz55scf5R0mEubfpBhDzo
 nbbNC/ph1gxqAvPOM8Q6Cp1tA+clMRTP+uW/RyrawqGQtQ/1WenXV45turd0CRFSS1DJ
 wCnI9TaUPlf7G6gE7io3xZwpa1wHUwbz6HfDUxrEsCCIcIYHUtB25nS6uQvqqs6Na1E6
 QkNw==
X-Gm-Message-State: AOAM5331Dh1uVu38em+n+NkvvvPJ7awdFAgq8nZ9br2x3OTHHR6cVXua
 LE7l4TPC11+hKMrDrfHxs6iEpg==
X-Google-Smtp-Source: ABdhPJz/JGn2c1GYmeUUgiyHVk84UlHkbQ+4gnOrvjRURWlsS6NTPycNLSlaRyjCz1N6U6vpoA1Daw==
X-Received: by 2002:a1c:32c6:: with SMTP id y189mr148837wmy.133.1606247049102; 
 Tue, 24 Nov 2020 11:44:09 -0800 (PST)
Received: from dell.default ([91.110.221.235])
 by smtp.gmail.com with ESMTPSA id d134sm200511wmd.8.2020.11.24.11.44.07
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 24 Nov 2020 11:44:08 -0800 (PST)
From: Lee Jones <lee.jones@linaro.org>
To: lee.jones@linaro.org
Subject: [PATCH 08/40] drm/msm/dp/dp_ctrl: Move 'tu' from the stack to the heap
Date: Tue, 24 Nov 2020 19:37:52 +0000
Message-Id: <20201124193824.1118741-9-lee.jones@linaro.org>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20201124193824.1118741-1-lee.jones@linaro.org>
References: <20201124193824.1118741-1-lee.jones@linaro.org>
MIME-Version: 1.0
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: freedreno@lists.freedesktop.org, David Airlie <airlied@linux.ie>,
 linux-arm-msm@vger.kernel.org, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, Kuogee Hsieh <khsieh@codeaurora.org>,
 Sean Paul <sean@poorly.run>, Chandan Uddaraju <chandanu@codeaurora.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

J3N0cnVjdCB0dV9hbGdvX2RhdGEnIGlzIGh1Z2UgfjQwMCBCeXRlcy4KCkZpeGVzIHRoZSBmb2xs
b3dpbmcgVz0xIGtlcm5lbCBidWlsZCB3YXJuaW5nKHMpOgoKIGRyaXZlcnMvZ3B1L2RybS9tc20v
ZHAvZHBfY3RybC5jOiBJbiBmdW5jdGlvbiDigJhfZHBfY3RybF9jYWxjX3R1LmNvbnN0cHJvcOKA
mToKIGRyaXZlcnMvZ3B1L2RybS9tc20vZHAvZHBfY3RybC5jOjkzODoxOiB3YXJuaW5nOiB0aGUg
ZnJhbWUgc2l6ZSBvZiAxMTg0IGJ5dGVzIGlzIGxhcmdlciB0aGFuIDEwMjQgYnl0ZXMgWy1XZnJh
bWUtbGFyZ2VyLXRoYW49XQoKQ2M6IFJvYiBDbGFyayA8cm9iZGNsYXJrQGdtYWlsLmNvbT4KQ2M6
IFNlYW4gUGF1bCA8c2VhbkBwb29ybHkucnVuPgpDYzogRGF2aWQgQWlybGllIDxhaXJsaWVkQGxp
bnV4LmllPgpDYzogRGFuaWVsIFZldHRlciA8ZGFuaWVsQGZmd2xsLmNoPgpDYzogQ2hhbmRhbiBV
ZGRhcmFqdSA8Y2hhbmRhbnVAY29kZWF1cm9yYS5vcmc+CkNjOiBLdW9nZWUgSHNpZWggPGtoc2ll
aEBjb2RlYXVyb3JhLm9yZz4KQ2M6IGxpbnV4LWFybS1tc21Admdlci5rZXJuZWwub3JnCkNjOiBk
cmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCkNjOiBmcmVlZHJlbm9AbGlzdHMuZnJlZWRl
c2t0b3Aub3JnClNpZ25lZC1vZmYtYnk6IExlZSBKb25lcyA8bGVlLmpvbmVzQGxpbmFyby5vcmc+
Ci0tLQogZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9jdHJsLmMgfCAzMzggKysrKysrKysrKysr
KysrKy0tLS0tLS0tLS0tLS0tLQogMSBmaWxlIGNoYW5nZWQsIDE3MSBpbnNlcnRpb25zKCspLCAx
NjcgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21zbS9kcC9kcF9j
dHJsLmMgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX2N0cmwuYwppbmRleCBjNTY5ZTk3Yzgy
YTZjLi5lMzQ2MmY1ZDk2ZDc1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2Rw
X2N0cmwuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL2RwL2RwX2N0cmwuYwpAQCAtNjE0LDcg
KzYxNCw3IEBAIHN0YXRpYyB2b2lkIF90dV92YWxpZF9ib3VuZGFyeV9jYWxjKHN0cnVjdCB0dV9h
bGdvX2RhdGEgKnR1KQogc3RhdGljIHZvaWQgX2RwX2N0cmxfY2FsY190dShzdHJ1Y3QgZHBfdHVf
Y2FsY19pbnB1dCAqaW4sCiAJCQkJICAgc3RydWN0IGRwX3ZjX3R1X21hcHBpbmdfdGFibGUgKnR1
X3RhYmxlKQogewotCXN0cnVjdCB0dV9hbGdvX2RhdGEgdHU7CisJc3RydWN0IHR1X2FsZ29fZGF0
YSAqdHU7CiAJaW50IGNvbXBhcmVfcmVzdWx0XzEsIGNvbXBhcmVfcmVzdWx0XzI7CiAJdTY0IHRl
bXAgPSAwOwogCXM2NCB0ZW1wX2ZwID0gMCwgdGVtcDFfZnAgPSAwLCB0ZW1wMl9mcCA9IDA7CkBA
IC02MjksMjk4ICs2MjksMzAwIEBAIHN0YXRpYyB2b2lkIF9kcF9jdHJsX2NhbGNfdHUoc3RydWN0
IGRwX3R1X2NhbGNfaW5wdXQgKmluLAogCXVpbnQgRVhUUkFfUElYQ0xLX0NZQ0xFX0RFTEFZID0g
NDsKIAl1aW50IEhCTEFOS19NQVJHSU4gPSA0OwogCi0JbWVtc2V0KCZ0dSwgMCwgc2l6ZW9mKHR1
KSk7CisJdHUgPSBremFsbG9jKHNpemVvZigqdHUpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIXR1KQor
CQlyZXR1cm4KIAotCWRwX3BhbmVsX3VwZGF0ZV90dV90aW1pbmdzKGluLCAmdHUpOworCWRwX3Bh
bmVsX3VwZGF0ZV90dV90aW1pbmdzKGluLCB0dSk7CiAKLQl0dS5lcnJfZnAgPSBkcm1fZml4cF9m
cm9tX2ZyYWN0aW9uKDEwMDAsIDEpOyAvKiAxMDAwICovCisJdHUtPmVycl9mcCA9IGRybV9maXhw
X2Zyb21fZnJhY3Rpb24oMTAwMCwgMSk7IC8qIDEwMDAgKi8KIAogCXRlbXAxX2ZwID0gZHJtX2Zp
eHBfZnJvbV9mcmFjdGlvbig0LCAxKTsKLQl0ZW1wMl9mcCA9IGRybV9maXhwX211bCh0ZW1wMV9m
cCwgdHUubGNsa19mcCk7Ci0JdGVtcF9mcCA9IGRybV9maXhwX2Rpdih0ZW1wMl9mcCwgdHUucGNs
a19mcCk7Ci0JdHUuZXh0cmFfYnVmZmVyX21hcmdpbiA9IGRybV9maXhwMmludF9jZWlsKHRlbXBf
ZnApOworCXRlbXAyX2ZwID0gZHJtX2ZpeHBfbXVsKHRlbXAxX2ZwLCB0dS0+bGNsa19mcCk7CisJ
dGVtcF9mcCA9IGRybV9maXhwX2Rpdih0ZW1wMl9mcCwgdHUtPnBjbGtfZnApOworCXR1LT5leHRy
YV9idWZmZXJfbWFyZ2luID0gZHJtX2ZpeHAyaW50X2NlaWwodGVtcF9mcCk7CiAKLQl0ZW1wMV9m
cCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24odHUuYnBwLCA4KTsKLQl0ZW1wMl9mcCA9IGRybV9m
aXhwX211bCh0dS5wY2xrX2ZwLCB0ZW1wMV9mcCk7Ci0JdGVtcDFfZnAgPSBkcm1fZml4cF9mcm9t
X2ZyYWN0aW9uKHR1Lm5sYW5lcywgMSk7CisJdGVtcDFfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0
aW9uKHR1LT5icHAsIDgpOworCXRlbXAyX2ZwID0gZHJtX2ZpeHBfbXVsKHR1LT5wY2xrX2ZwLCB0
ZW1wMV9mcCk7CisJdGVtcDFfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHR1LT5ubGFuZXMs
IDEpOwogCXRlbXAyX2ZwID0gZHJtX2ZpeHBfZGl2KHRlbXAyX2ZwLCB0ZW1wMV9mcCk7Ci0JdHUu
cmF0aW9fZnAgPSBkcm1fZml4cF9kaXYodGVtcDJfZnAsIHR1LmxjbGtfZnApOwotCi0JdHUub3Jp
Z2luYWxfcmF0aW9fZnAgPSB0dS5yYXRpb19mcDsKLQl0dS5ib3VuZGFyeV9tb2RlcmF0aW9uX2Vu
ID0gZmFsc2U7Ci0JdHUudXBwZXJfYm91bmRhcnlfY291bnQgPSAwOwotCXR1Lmxvd2VyX2JvdW5k
YXJ5X2NvdW50ID0gMDsKLQl0dS5pX3VwcGVyX2JvdW5kYXJ5X2NvdW50ID0gMDsKLQl0dS5pX2xv
d2VyX2JvdW5kYXJ5X2NvdW50ID0gMDsKLQl0dS52YWxpZF9sb3dlcl9ib3VuZGFyeV9saW5rID0g
MDsKLQl0dS5ldmVuX2Rpc3RyaWJ1dGlvbl9CRiA9IDA7Ci0JdHUuZXZlbl9kaXN0cmlidXRpb25f
bGVnYWN5ID0gMDsKLQl0dS5ldmVuX2Rpc3RyaWJ1dGlvbiA9IDA7Ci0JdHUuZGVsYXlfc3RhcnRf
dGltZV9mcCA9IDA7Ci0KLQl0dS5lcnJfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKDEwMDAs
IDEpOwotCXR1Lm5fZXJyX2ZwID0gMDsKLQl0dS5uX25fZXJyX2ZwID0gMDsKLQotCXR1LnJhdGlv
ID0gZHJtX2ZpeHAyaW50KHR1LnJhdGlvX2ZwKTsKLQl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21f
ZnJhY3Rpb24odHUubmxhbmVzLCAxKTsKLQlkaXY2NF91NjRfcmVtKHR1Lmx3aWR0aF9mcCwgdGVt
cDFfZnAsICZ0ZW1wMl9mcCk7CisJdHUtPnJhdGlvX2ZwID0gZHJtX2ZpeHBfZGl2KHRlbXAyX2Zw
LCB0dS0+bGNsa19mcCk7CisKKwl0dS0+b3JpZ2luYWxfcmF0aW9fZnAgPSB0dS0+cmF0aW9fZnA7
CisJdHUtPmJvdW5kYXJ5X21vZGVyYXRpb25fZW4gPSBmYWxzZTsKKwl0dS0+dXBwZXJfYm91bmRh
cnlfY291bnQgPSAwOworCXR1LT5sb3dlcl9ib3VuZGFyeV9jb3VudCA9IDA7CisJdHUtPmlfdXBw
ZXJfYm91bmRhcnlfY291bnQgPSAwOworCXR1LT5pX2xvd2VyX2JvdW5kYXJ5X2NvdW50ID0gMDsK
Kwl0dS0+dmFsaWRfbG93ZXJfYm91bmRhcnlfbGluayA9IDA7CisJdHUtPmV2ZW5fZGlzdHJpYnV0
aW9uX0JGID0gMDsKKwl0dS0+ZXZlbl9kaXN0cmlidXRpb25fbGVnYWN5ID0gMDsKKwl0dS0+ZXZl
bl9kaXN0cmlidXRpb24gPSAwOworCXR1LT5kZWxheV9zdGFydF90aW1lX2ZwID0gMDsKKworCXR1
LT5lcnJfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKDEwMDAsIDEpOworCXR1LT5uX2Vycl9m
cCA9IDA7CisJdHUtPm5fbl9lcnJfZnAgPSAwOworCisJdHUtPnJhdGlvID0gZHJtX2ZpeHAyaW50
KHR1LT5yYXRpb19mcCk7CisJdGVtcDFfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHR1LT5u
bGFuZXMsIDEpOworCWRpdjY0X3U2NF9yZW0odHUtPmx3aWR0aF9mcCwgdGVtcDFfZnAsICZ0ZW1w
Ml9mcCk7CiAJaWYgKHRlbXAyX2ZwICE9IDAgJiYKLQkJCSF0dS5yYXRpbyAmJiB0dS5kc2NfZW4g
PT0gMCkgewotCQl0dS5yYXRpb19mcCA9IGRybV9maXhwX211bCh0dS5yYXRpb19mcCwgUkFUSU9f
U0NBTEVfZnApOwotCQl0dS5yYXRpbyA9IGRybV9maXhwMmludCh0dS5yYXRpb19mcCk7Ci0JCWlm
ICh0dS5yYXRpbykKLQkJCXR1LnJhdGlvX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbigxLCAx
KTsKKwkJCSF0dS0+cmF0aW8gJiYgdHUtPmRzY19lbiA9PSAwKSB7CisJCXR1LT5yYXRpb19mcCA9
IGRybV9maXhwX211bCh0dS0+cmF0aW9fZnAsIFJBVElPX1NDQUxFX2ZwKTsKKwkJdHUtPnJhdGlv
ID0gZHJtX2ZpeHAyaW50KHR1LT5yYXRpb19mcCk7CisJCWlmICh0dS0+cmF0aW8pCisJCQl0dS0+
cmF0aW9fZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKDEsIDEpOwogCX0KIAotCWlmICh0dS5y
YXRpbyA+IDEpCi0JCXR1LnJhdGlvID0gMTsKKwlpZiAodHUtPnJhdGlvID4gMSkKKwkJdHUtPnJh
dGlvID0gMTsKIAotCWlmICh0dS5yYXRpbyA9PSAxKQorCWlmICh0dS0+cmF0aW8gPT0gMSkKIAkJ
Z290byB0dV9zaXplX2NhbGM7CiAKLQljb21wYXJlX3Jlc3VsdF8xID0gX3R1X3BhcmFtX2NvbXBh
cmUodHUucmF0aW9fZnAsIGNvbnN0X3A0OV9mcCk7CisJY29tcGFyZV9yZXN1bHRfMSA9IF90dV9w
YXJhbV9jb21wYXJlKHR1LT5yYXRpb19mcCwgY29uc3RfcDQ5X2ZwKTsKIAlpZiAoIWNvbXBhcmVf
cmVzdWx0XzEgfHwgY29tcGFyZV9yZXN1bHRfMSA9PSAxKQogCQljb21wYXJlX3Jlc3VsdF8xID0g
MTsKIAllbHNlCiAJCWNvbXBhcmVfcmVzdWx0XzEgPSAwOwogCi0JY29tcGFyZV9yZXN1bHRfMiA9
IF90dV9wYXJhbV9jb21wYXJlKHR1LnJhdGlvX2ZwLCBjb25zdF9wNTZfZnApOworCWNvbXBhcmVf
cmVzdWx0XzIgPSBfdHVfcGFyYW1fY29tcGFyZSh0dS0+cmF0aW9fZnAsIGNvbnN0X3A1Nl9mcCk7
CiAJaWYgKCFjb21wYXJlX3Jlc3VsdF8yIHx8IGNvbXBhcmVfcmVzdWx0XzIgPT0gMikKIAkJY29t
cGFyZV9yZXN1bHRfMiA9IDE7CiAJZWxzZQogCQljb21wYXJlX3Jlc3VsdF8yID0gMDsKIAotCWlm
ICh0dS5kc2NfZW4gJiYgY29tcGFyZV9yZXN1bHRfMSAmJiBjb21wYXJlX3Jlc3VsdF8yKSB7CisJ
aWYgKHR1LT5kc2NfZW4gJiYgY29tcGFyZV9yZXN1bHRfMSAmJiBjb21wYXJlX3Jlc3VsdF8yKSB7
CiAJCUhCTEFOS19NQVJHSU4gKz0gNDsKIAkJRFJNX0RFQlVHX0RQKCJJbmZvOiBpbmNyZWFzZSBI
QkxBTktfTUFSR0lOIHRvICVkXG4iLAogCQkJCUhCTEFOS19NQVJHSU4pOwogCX0KIAogdHVfc2l6
ZV9jYWxjOgotCWZvciAodHUudHVfc2l6ZSA9IDMyOyB0dS50dV9zaXplIDw9IDY0OyB0dS50dV9z
aXplKyspIHsKLQkJdGVtcDFfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHR1LnR1X3NpemUs
IDEpOwotCQl0ZW1wMl9mcCA9IGRybV9maXhwX211bCh0dS5yYXRpb19mcCwgdGVtcDFfZnApOwor
CWZvciAodHUtPnR1X3NpemUgPSAzMjsgdHUtPnR1X3NpemUgPD0gNjQ7IHR1LT50dV9zaXplKysp
IHsKKwkJdGVtcDFfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHR1LT50dV9zaXplLCAxKTsK
KwkJdGVtcDJfZnAgPSBkcm1fZml4cF9tdWwodHUtPnJhdGlvX2ZwLCB0ZW1wMV9mcCk7CiAJCXRl
bXAgPSBkcm1fZml4cDJpbnRfY2VpbCh0ZW1wMl9mcCk7CiAJCXRlbXAxX2ZwID0gZHJtX2ZpeHBf
ZnJvbV9mcmFjdGlvbih0ZW1wLCAxKTsKLQkJdHUubl9lcnJfZnAgPSB0ZW1wMV9mcCAtIHRlbXAy
X2ZwOworCQl0dS0+bl9lcnJfZnAgPSB0ZW1wMV9mcCAtIHRlbXAyX2ZwOwogCi0JCWlmICh0dS5u
X2Vycl9mcCA8IHR1LmVycl9mcCkgewotCQkJdHUuZXJyX2ZwID0gdHUubl9lcnJfZnA7Ci0JCQl0
dS50dV9zaXplX2Rlc2lyZWQgPSB0dS50dV9zaXplOworCQlpZiAodHUtPm5fZXJyX2ZwIDwgdHUt
PmVycl9mcCkgeworCQkJdHUtPmVycl9mcCA9IHR1LT5uX2Vycl9mcDsKKwkJCXR1LT50dV9zaXpl
X2Rlc2lyZWQgPSB0dS0+dHVfc2l6ZTsKIAkJfQogCX0KIAotCXR1LnR1X3NpemVfbWludXMxID0g
dHUudHVfc2l6ZV9kZXNpcmVkIC0gMTsKKwl0dS0+dHVfc2l6ZV9taW51czEgPSB0dS0+dHVfc2l6
ZV9kZXNpcmVkIC0gMTsKIAotCXRlbXAxX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbih0dS50
dV9zaXplX2Rlc2lyZWQsIDEpOwotCXRlbXAyX2ZwID0gZHJtX2ZpeHBfbXVsKHR1LnJhdGlvX2Zw
LCB0ZW1wMV9mcCk7Ci0JdHUudmFsaWRfYm91bmRhcnlfbGluayA9IGRybV9maXhwMmludF9jZWls
KHRlbXAyX2ZwKTsKKwl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24odHUtPnR1X3Np
emVfZGVzaXJlZCwgMSk7CisJdGVtcDJfZnAgPSBkcm1fZml4cF9tdWwodHUtPnJhdGlvX2ZwLCB0
ZW1wMV9mcCk7CisJdHUtPnZhbGlkX2JvdW5kYXJ5X2xpbmsgPSBkcm1fZml4cDJpbnRfY2VpbCh0
ZW1wMl9mcCk7CiAKLQl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24odHUuYnBwLCA4
KTsKLQl0ZW1wMl9mcCA9IHR1Lmx3aWR0aF9mcDsKKwl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21f
ZnJhY3Rpb24odHUtPmJwcCwgOCk7CisJdGVtcDJfZnAgPSB0dS0+bHdpZHRoX2ZwOwogCXRlbXAy
X2ZwID0gZHJtX2ZpeHBfbXVsKHRlbXAyX2ZwLCB0ZW1wMV9mcCk7CiAKLQl0ZW1wMV9mcCA9IGRy
bV9maXhwX2Zyb21fZnJhY3Rpb24odHUudmFsaWRfYm91bmRhcnlfbGluaywgMSk7CisJdGVtcDFf
ZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHR1LT52YWxpZF9ib3VuZGFyeV9saW5rLCAxKTsK
IAl0ZW1wMl9mcCA9IGRybV9maXhwX2Rpdih0ZW1wMl9mcCwgdGVtcDFfZnApOwotCXR1Lm5fdHVz
ID0gZHJtX2ZpeHAyaW50KHRlbXAyX2ZwKTsKKwl0dS0+bl90dXMgPSBkcm1fZml4cDJpbnQodGVt
cDJfZnApOwogCWlmICgodGVtcDJfZnAgJiAweEZGRkZGRkZGKSA+IDB4RkZGRkYwMDApCi0JCXR1
Lm5fdHVzICs9IDE7CisJCXR1LT5uX3R1cyArPSAxOwogCi0JdHUuZXZlbl9kaXN0cmlidXRpb25f
bGVnYWN5ID0gdHUubl90dXMgJSB0dS5ubGFuZXMgPT0gMCA/IDEgOiAwOworCXR1LT5ldmVuX2Rp
c3RyaWJ1dGlvbl9sZWdhY3kgPSB0dS0+bl90dXMgJSB0dS0+bmxhbmVzID09IDAgPyAxIDogMDsK
IAlEUk1fREVCVUdfRFAoIkluZm86IG5fc3ltID0gJWQsIG51bV9vZl90dXMgPSAlZFxuIiwKLQkJ
dHUudmFsaWRfYm91bmRhcnlfbGluaywgdHUubl90dXMpOworCQl0dS0+dmFsaWRfYm91bmRhcnlf
bGluaywgdHUtPm5fdHVzKTsKIAotCXRlbXAxX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbih0
dS50dV9zaXplX2Rlc2lyZWQsIDEpOwotCXRlbXAyX2ZwID0gZHJtX2ZpeHBfbXVsKHR1Lm9yaWdp
bmFsX3JhdGlvX2ZwLCB0ZW1wMV9mcCk7Ci0JdGVtcDFfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0
aW9uKHR1LnZhbGlkX2JvdW5kYXJ5X2xpbmssIDEpOworCXRlbXAxX2ZwID0gZHJtX2ZpeHBfZnJv
bV9mcmFjdGlvbih0dS0+dHVfc2l6ZV9kZXNpcmVkLCAxKTsKKwl0ZW1wMl9mcCA9IGRybV9maXhw
X211bCh0dS0+b3JpZ2luYWxfcmF0aW9fZnAsIHRlbXAxX2ZwKTsKKwl0ZW1wMV9mcCA9IGRybV9m
aXhwX2Zyb21fZnJhY3Rpb24odHUtPnZhbGlkX2JvdW5kYXJ5X2xpbmssIDEpOwogCXRlbXAyX2Zw
ID0gdGVtcDFfZnAgLSB0ZW1wMl9mcDsKLQl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rp
b24odHUubl90dXMgKyAxLCAxKTsKKwl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24o
dHUtPm5fdHVzICsgMSwgMSk7CiAJdGVtcDJfZnAgPSBkcm1fZml4cF9tdWwodGVtcDFfZnAsIHRl
bXAyX2ZwKTsKIAogCXRlbXAgPSBkcm1fZml4cDJpbnQodGVtcDJfZnApOwogCWlmICh0ZW1wICYm
IHRlbXAyX2ZwKQotCQl0dS5leHRyYV9ieXRlcyA9IGRybV9maXhwMmludF9jZWlsKHRlbXAyX2Zw
KTsKKwkJdHUtPmV4dHJhX2J5dGVzID0gZHJtX2ZpeHAyaW50X2NlaWwodGVtcDJfZnApOwogCWVs
c2UKLQkJdHUuZXh0cmFfYnl0ZXMgPSAwOworCQl0dS0+ZXh0cmFfYnl0ZXMgPSAwOwogCi0JdGVt
cDFfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHR1LmV4dHJhX2J5dGVzLCAxKTsKLQl0ZW1w
Ml9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24oOCwgdHUuYnBwKTsKKwl0ZW1wMV9mcCA9IGRy
bV9maXhwX2Zyb21fZnJhY3Rpb24odHUtPmV4dHJhX2J5dGVzLCAxKTsKKwl0ZW1wMl9mcCA9IGRy
bV9maXhwX2Zyb21fZnJhY3Rpb24oOCwgdHUtPmJwcCk7CiAJdGVtcDFfZnAgPSBkcm1fZml4cF9t
dWwodGVtcDFfZnAsIHRlbXAyX2ZwKTsKIAogCWlmICh0ZW1wICYmIHRlbXAxX2ZwKQotCQl0dS5l
eHRyYV9wY2xrX2N5Y2xlcyA9IGRybV9maXhwMmludF9jZWlsKHRlbXAxX2ZwKTsKKwkJdHUtPmV4
dHJhX3BjbGtfY3ljbGVzID0gZHJtX2ZpeHAyaW50X2NlaWwodGVtcDFfZnApOwogCWVsc2UKLQkJ
dHUuZXh0cmFfcGNsa19jeWNsZXMgPSBkcm1fZml4cDJpbnQodGVtcDFfZnApOworCQl0dS0+ZXh0
cmFfcGNsa19jeWNsZXMgPSBkcm1fZml4cDJpbnQodGVtcDFfZnApOwogCi0JdGVtcDFfZnAgPSBk
cm1fZml4cF9kaXYodHUubGNsa19mcCwgdHUucGNsa19mcCk7Ci0JdGVtcDJfZnAgPSBkcm1fZml4
cF9mcm9tX2ZyYWN0aW9uKHR1LmV4dHJhX3BjbGtfY3ljbGVzLCAxKTsKKwl0ZW1wMV9mcCA9IGRy
bV9maXhwX2Rpdih0dS0+bGNsa19mcCwgdHUtPnBjbGtfZnApOworCXRlbXAyX2ZwID0gZHJtX2Zp
eHBfZnJvbV9mcmFjdGlvbih0dS0+ZXh0cmFfcGNsa19jeWNsZXMsIDEpOwogCXRlbXAxX2ZwID0g
ZHJtX2ZpeHBfbXVsKHRlbXAyX2ZwLCB0ZW1wMV9mcCk7CiAKIAlpZiAodGVtcDFfZnApCi0JCXR1
LmV4dHJhX3BjbGtfY3ljbGVzX2luX2xpbmtfY2xrID0gZHJtX2ZpeHAyaW50X2NlaWwodGVtcDFf
ZnApOworCQl0dS0+ZXh0cmFfcGNsa19jeWNsZXNfaW5fbGlua19jbGsgPSBkcm1fZml4cDJpbnRf
Y2VpbCh0ZW1wMV9mcCk7CiAJZWxzZQotCQl0dS5leHRyYV9wY2xrX2N5Y2xlc19pbl9saW5rX2Ns
ayA9IGRybV9maXhwMmludCh0ZW1wMV9mcCk7CisJCXR1LT5leHRyYV9wY2xrX2N5Y2xlc19pbl9s
aW5rX2NsayA9IGRybV9maXhwMmludCh0ZW1wMV9mcCk7CiAKLQl0dS5maWxsZXJfc2l6ZSA9IHR1
LnR1X3NpemVfZGVzaXJlZCAtIHR1LnZhbGlkX2JvdW5kYXJ5X2xpbms7CisJdHUtPmZpbGxlcl9z
aXplID0gdHUtPnR1X3NpemVfZGVzaXJlZCAtIHR1LT52YWxpZF9ib3VuZGFyeV9saW5rOwogCi0J
dGVtcDFfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHR1LnR1X3NpemVfZGVzaXJlZCwgMSk7
Ci0JdHUucmF0aW9fYnlfdHVfZnAgPSBkcm1fZml4cF9tdWwodHUucmF0aW9fZnAsIHRlbXAxX2Zw
KTsKKwl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24odHUtPnR1X3NpemVfZGVzaXJl
ZCwgMSk7CisJdHUtPnJhdGlvX2J5X3R1X2ZwID0gZHJtX2ZpeHBfbXVsKHR1LT5yYXRpb19mcCwg
dGVtcDFfZnApOwogCi0JdHUuZGVsYXlfc3RhcnRfbGluayA9IHR1LmV4dHJhX3BjbGtfY3ljbGVz
X2luX2xpbmtfY2xrICsKLQkJCQl0dS5maWxsZXJfc2l6ZSArIHR1LmV4dHJhX2J1ZmZlcl9tYXJn
aW47CisJdHUtPmRlbGF5X3N0YXJ0X2xpbmsgPSB0dS0+ZXh0cmFfcGNsa19jeWNsZXNfaW5fbGlu
a19jbGsgKworCQkJCXR1LT5maWxsZXJfc2l6ZSArIHR1LT5leHRyYV9idWZmZXJfbWFyZ2luOwog
Ci0JdHUucmVzdWx0aW5nX3ZhbGlkX2ZwID0KLQkJCWRybV9maXhwX2Zyb21fZnJhY3Rpb24odHUu
dmFsaWRfYm91bmRhcnlfbGluaywgMSk7CisJdHUtPnJlc3VsdGluZ192YWxpZF9mcCA9CisJCQlk
cm1fZml4cF9mcm9tX2ZyYWN0aW9uKHR1LT52YWxpZF9ib3VuZGFyeV9saW5rLCAxKTsKIAotCXRl
bXAxX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbih0dS50dV9zaXplX2Rlc2lyZWQsIDEpOwot
CXRlbXAyX2ZwID0gZHJtX2ZpeHBfZGl2KHR1LnJlc3VsdGluZ192YWxpZF9mcCwgdGVtcDFfZnAp
OwotCXR1LlRVX3JhdGlvX2Vycl9mcCA9IHRlbXAyX2ZwIC0gdHUub3JpZ2luYWxfcmF0aW9fZnA7
CisJdGVtcDFfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHR1LT50dV9zaXplX2Rlc2lyZWQs
IDEpOworCXRlbXAyX2ZwID0gZHJtX2ZpeHBfZGl2KHR1LT5yZXN1bHRpbmdfdmFsaWRfZnAsIHRl
bXAxX2ZwKTsKKwl0dS0+VFVfcmF0aW9fZXJyX2ZwID0gdGVtcDJfZnAgLSB0dS0+b3JpZ2luYWxf
cmF0aW9fZnA7CiAKIAl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24oSEJMQU5LX01B
UkdJTiwgMSk7Ci0JdGVtcDFfZnAgPSB0dS5oYnBfcmVsYXRpdmVfdG9fcGNsa19mcCAtIHRlbXAx
X2ZwOwotCXR1LmhicF90aW1lX2ZwID0gZHJtX2ZpeHBfZGl2KHRlbXAxX2ZwLCB0dS5wY2xrX2Zw
KTsKKwl0ZW1wMV9mcCA9IHR1LT5oYnBfcmVsYXRpdmVfdG9fcGNsa19mcCAtIHRlbXAxX2ZwOwor
CXR1LT5oYnBfdGltZV9mcCA9IGRybV9maXhwX2Rpdih0ZW1wMV9mcCwgdHUtPnBjbGtfZnApOwog
Ci0JdGVtcDFfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHR1LmRlbGF5X3N0YXJ0X2xpbmss
IDEpOwotCXR1LmRlbGF5X3N0YXJ0X3RpbWVfZnAgPSBkcm1fZml4cF9kaXYodGVtcDFfZnAsIHR1
LmxjbGtfZnApOworCXRlbXAxX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbih0dS0+ZGVsYXlf
c3RhcnRfbGluaywgMSk7CisJdHUtPmRlbGF5X3N0YXJ0X3RpbWVfZnAgPSBkcm1fZml4cF9kaXYo
dGVtcDFfZnAsIHR1LT5sY2xrX2ZwKTsKIAotCWNvbXBhcmVfcmVzdWx0XzEgPSBfdHVfcGFyYW1f
Y29tcGFyZSh0dS5oYnBfdGltZV9mcCwKLQkJCQkJdHUuZGVsYXlfc3RhcnRfdGltZV9mcCk7CisJ
Y29tcGFyZV9yZXN1bHRfMSA9IF90dV9wYXJhbV9jb21wYXJlKHR1LT5oYnBfdGltZV9mcCwKKwkJ
CQkJdHUtPmRlbGF5X3N0YXJ0X3RpbWVfZnApOwogCWlmIChjb21wYXJlX3Jlc3VsdF8xID09IDIp
IC8qIGlmIChoYnBfdGltZV9mcCA8IGRlbGF5X3N0YXJ0X3RpbWVfZnApICovCi0JCXR1Lm1pbl9o
YmxhbmtfdmlvbGF0ZWQgPSAxOworCQl0dS0+bWluX2hibGFua192aW9sYXRlZCA9IDE7CiAKLQl0
dS5oYWN0aXZlX3RpbWVfZnAgPSBkcm1fZml4cF9kaXYodHUubHdpZHRoX2ZwLCB0dS5wY2xrX2Zw
KTsKKwl0dS0+aGFjdGl2ZV90aW1lX2ZwID0gZHJtX2ZpeHBfZGl2KHR1LT5sd2lkdGhfZnAsIHR1
LT5wY2xrX2ZwKTsKIAotCWNvbXBhcmVfcmVzdWx0XzIgPSBfdHVfcGFyYW1fY29tcGFyZSh0dS5o
YWN0aXZlX3RpbWVfZnAsCi0JCQkJCQl0dS5kZWxheV9zdGFydF90aW1lX2ZwKTsKKwljb21wYXJl
X3Jlc3VsdF8yID0gX3R1X3BhcmFtX2NvbXBhcmUodHUtPmhhY3RpdmVfdGltZV9mcCwKKwkJCQkJ
CXR1LT5kZWxheV9zdGFydF90aW1lX2ZwKTsKIAlpZiAoY29tcGFyZV9yZXN1bHRfMiA9PSAyKQot
CQl0dS5taW5faGJsYW5rX3Zpb2xhdGVkID0gMTsKKwkJdHUtPm1pbl9oYmxhbmtfdmlvbGF0ZWQg
PSAxOwogCi0JdHUuZGVsYXlfc3RhcnRfdGltZV9mcCA9IDA7CisJdHUtPmRlbGF5X3N0YXJ0X3Rp
bWVfZnAgPSAwOwogCiAJLyogYnJ1dGUgZm9yY2UgKi8KIAotCXR1LmRlbGF5X3N0YXJ0X2xpbmtf
ZXh0cmFfcGl4Y2xrID0gRVhUUkFfUElYQ0xLX0NZQ0xFX0RFTEFZOwotCXR1LmRpZmZfYWJzX2Zw
ID0gdHUucmVzdWx0aW5nX3ZhbGlkX2ZwIC0gdHUucmF0aW9fYnlfdHVfZnA7CisJdHUtPmRlbGF5
X3N0YXJ0X2xpbmtfZXh0cmFfcGl4Y2xrID0gRVhUUkFfUElYQ0xLX0NZQ0xFX0RFTEFZOworCXR1
LT5kaWZmX2Fic19mcCA9IHR1LT5yZXN1bHRpbmdfdmFsaWRfZnAgLSB0dS0+cmF0aW9fYnlfdHVf
ZnA7CiAKLQl0ZW1wID0gZHJtX2ZpeHAyaW50KHR1LmRpZmZfYWJzX2ZwKTsKLQlpZiAoIXRlbXAg
JiYgdHUuZGlmZl9hYnNfZnAgPD0gMHhmZmZmKQotCQl0dS5kaWZmX2Fic19mcCA9IDA7CisJdGVt
cCA9IGRybV9maXhwMmludCh0dS0+ZGlmZl9hYnNfZnApOworCWlmICghdGVtcCAmJiB0dS0+ZGlm
Zl9hYnNfZnAgPD0gMHhmZmZmKQorCQl0dS0+ZGlmZl9hYnNfZnAgPSAwOwogCiAJLyogaWYoZGlm
Zl9hYnMgPCAwKSBkaWZmX2FicyAqPSAtMSAqLwotCWlmICh0dS5kaWZmX2Fic19mcCA8IDApCi0J
CXR1LmRpZmZfYWJzX2ZwID0gZHJtX2ZpeHBfbXVsKHR1LmRpZmZfYWJzX2ZwLCAtMSk7CisJaWYg
KHR1LT5kaWZmX2Fic19mcCA8IDApCisJCXR1LT5kaWZmX2Fic19mcCA9IGRybV9maXhwX211bCh0
dS0+ZGlmZl9hYnNfZnAsIC0xKTsKIAotCXR1LmJvdW5kYXJ5X21vZF9sb3dlcl9lcnIgPSAwOwot
CWlmICgodHUuZGlmZl9hYnNfZnAgIT0gMCAmJgotCQkJKCh0dS5kaWZmX2Fic19mcCA+IEJSVVRF
X0ZPUkNFX1RIUkVTSE9MRF9mcCkgfHwKLQkJCSAodHUuZXZlbl9kaXN0cmlidXRpb25fbGVnYWN5
ID09IDApIHx8CisJdHUtPmJvdW5kYXJ5X21vZF9sb3dlcl9lcnIgPSAwOworCWlmICgodHUtPmRp
ZmZfYWJzX2ZwICE9IDAgJiYKKwkJCSgodHUtPmRpZmZfYWJzX2ZwID4gQlJVVEVfRk9SQ0VfVEhS
RVNIT0xEX2ZwKSB8fAorCQkJICh0dS0+ZXZlbl9kaXN0cmlidXRpb25fbGVnYWN5ID09IDApIHx8
CiAJCQkgKERQX0JSVVRFX0ZPUkNFID09IDEpKSkgfHwKLQkJCSh0dS5taW5faGJsYW5rX3Zpb2xh
dGVkID09IDEpKSB7CisJCQkodHUtPm1pbl9oYmxhbmtfdmlvbGF0ZWQgPT0gMSkpIHsKIAkJZG8g
ewotCQkJdHUuZXJyX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbigxMDAwLCAxKTsKKwkJCXR1
LT5lcnJfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKDEwMDAsIDEpOwogCi0JCQl0ZW1wMV9m
cCA9IGRybV9maXhwX2Rpdih0dS5sY2xrX2ZwLCB0dS5wY2xrX2ZwKTsKKwkJCXRlbXAxX2ZwID0g
ZHJtX2ZpeHBfZGl2KHR1LT5sY2xrX2ZwLCB0dS0+cGNsa19mcCk7CiAJCQl0ZW1wMl9mcCA9IGRy
bV9maXhwX2Zyb21fZnJhY3Rpb24oCi0JCQkJCXR1LmRlbGF5X3N0YXJ0X2xpbmtfZXh0cmFfcGl4
Y2xrLCAxKTsKKwkJCQkJdHUtPmRlbGF5X3N0YXJ0X2xpbmtfZXh0cmFfcGl4Y2xrLCAxKTsKIAkJ
CXRlbXAxX2ZwID0gZHJtX2ZpeHBfbXVsKHRlbXAyX2ZwLCB0ZW1wMV9mcCk7CiAKIAkJCWlmICh0
ZW1wMV9mcCkKLQkJCQl0dS5leHRyYV9idWZmZXJfbWFyZ2luID0KKwkJCQl0dS0+ZXh0cmFfYnVm
ZmVyX21hcmdpbiA9CiAJCQkJCWRybV9maXhwMmludF9jZWlsKHRlbXAxX2ZwKTsKIAkJCWVsc2UK
LQkJCQl0dS5leHRyYV9idWZmZXJfbWFyZ2luID0gMDsKKwkJCQl0dS0+ZXh0cmFfYnVmZmVyX21h
cmdpbiA9IDA7CiAKLQkJCXRlbXAxX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbih0dS5icHAs
IDgpOwotCQkJdGVtcDFfZnAgPSBkcm1fZml4cF9tdWwodHUubHdpZHRoX2ZwLCB0ZW1wMV9mcCk7
CisJCQl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24odHUtPmJwcCwgOCk7CisJCQl0
ZW1wMV9mcCA9IGRybV9maXhwX211bCh0dS0+bHdpZHRoX2ZwLCB0ZW1wMV9mcCk7CiAKIAkJCWlm
ICh0ZW1wMV9mcCkKLQkJCQl0dS5uX3N5bWJvbHMgPSBkcm1fZml4cDJpbnRfY2VpbCh0ZW1wMV9m
cCk7CisJCQkJdHUtPm5fc3ltYm9scyA9IGRybV9maXhwMmludF9jZWlsKHRlbXAxX2ZwKTsKIAkJ
CWVsc2UKLQkJCQl0dS5uX3N5bWJvbHMgPSAwOwotCi0JCQlmb3IgKHR1LnR1X3NpemUgPSAzMjsg
dHUudHVfc2l6ZSA8PSA2NDsgdHUudHVfc2l6ZSsrKSB7Ci0JCQkJZm9yICh0dS5pX3VwcGVyX2Jv
dW5kYXJ5X2NvdW50ID0gMTsKLQkJCQkJdHUuaV91cHBlcl9ib3VuZGFyeV9jb3VudCA8PSAxNTsK
LQkJCQkJdHUuaV91cHBlcl9ib3VuZGFyeV9jb3VudCsrKSB7Ci0JCQkJCWZvciAodHUuaV9sb3dl
cl9ib3VuZGFyeV9jb3VudCA9IDE7Ci0JCQkJCQl0dS5pX2xvd2VyX2JvdW5kYXJ5X2NvdW50IDw9
IDE1OwotCQkJCQkJdHUuaV9sb3dlcl9ib3VuZGFyeV9jb3VudCsrKSB7Ci0JCQkJCQlfdHVfdmFs
aWRfYm91bmRhcnlfY2FsYygmdHUpOworCQkJCXR1LT5uX3N5bWJvbHMgPSAwOworCisJCQlmb3Ig
KHR1LT50dV9zaXplID0gMzI7IHR1LT50dV9zaXplIDw9IDY0OyB0dS0+dHVfc2l6ZSsrKSB7CisJ
CQkJZm9yICh0dS0+aV91cHBlcl9ib3VuZGFyeV9jb3VudCA9IDE7CisJCQkJCXR1LT5pX3VwcGVy
X2JvdW5kYXJ5X2NvdW50IDw9IDE1OworCQkJCQl0dS0+aV91cHBlcl9ib3VuZGFyeV9jb3VudCsr
KSB7CisJCQkJCWZvciAodHUtPmlfbG93ZXJfYm91bmRhcnlfY291bnQgPSAxOworCQkJCQkJdHUt
PmlfbG93ZXJfYm91bmRhcnlfY291bnQgPD0gMTU7CisJCQkJCQl0dS0+aV9sb3dlcl9ib3VuZGFy
eV9jb3VudCsrKSB7CisJCQkJCQlfdHVfdmFsaWRfYm91bmRhcnlfY2FsYyh0dSk7CiAJCQkJCX0K
IAkJCQl9CiAJCQl9Ci0JCQl0dS5kZWxheV9zdGFydF9saW5rX2V4dHJhX3BpeGNsay0tOwotCQl9
IHdoaWxlICh0dS5ib3VuZGFyeV9tb2RlcmF0aW9uX2VuICE9IHRydWUgJiYKLQkJCXR1LmJvdW5k
YXJ5X21vZF9sb3dlcl9lcnIgPT0gMSAmJgotCQkJdHUuZGVsYXlfc3RhcnRfbGlua19leHRyYV9w
aXhjbGsgIT0gMCk7CisJCQl0dS0+ZGVsYXlfc3RhcnRfbGlua19leHRyYV9waXhjbGstLTsKKwkJ
fSB3aGlsZSAodHUtPmJvdW5kYXJ5X21vZGVyYXRpb25fZW4gIT0gdHJ1ZSAmJgorCQkJdHUtPmJv
dW5kYXJ5X21vZF9sb3dlcl9lcnIgPT0gMSAmJgorCQkJdHUtPmRlbGF5X3N0YXJ0X2xpbmtfZXh0
cmFfcGl4Y2xrICE9IDApOwogCi0JCWlmICh0dS5ib3VuZGFyeV9tb2RlcmF0aW9uX2VuID09IHRy
dWUpIHsKKwkJaWYgKHR1LT5ib3VuZGFyeV9tb2RlcmF0aW9uX2VuID09IHRydWUpIHsKIAkJCXRl
bXAxX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbigKLQkJCQkJKHR1LnVwcGVyX2JvdW5kYXJ5
X2NvdW50ICoKLQkJCQkJdHUudmFsaWRfYm91bmRhcnlfbGluayArCi0JCQkJCXR1Lmxvd2VyX2Jv
dW5kYXJ5X2NvdW50ICoKLQkJCQkJKHR1LnZhbGlkX2JvdW5kYXJ5X2xpbmsgLSAxKSksIDEpOwor
CQkJCQkodHUtPnVwcGVyX2JvdW5kYXJ5X2NvdW50ICoKKwkJCQkJdHUtPnZhbGlkX2JvdW5kYXJ5
X2xpbmsgKworCQkJCQl0dS0+bG93ZXJfYm91bmRhcnlfY291bnQgKgorCQkJCQkodHUtPnZhbGlk
X2JvdW5kYXJ5X2xpbmsgLSAxKSksIDEpOwogCQkJdGVtcDJfZnAgPSBkcm1fZml4cF9mcm9tX2Zy
YWN0aW9uKAotCQkJCQkodHUudXBwZXJfYm91bmRhcnlfY291bnQgKwotCQkJCQl0dS5sb3dlcl9i
b3VuZGFyeV9jb3VudCksIDEpOwotCQkJdHUucmVzdWx0aW5nX3ZhbGlkX2ZwID0KKwkJCQkJKHR1
LT51cHBlcl9ib3VuZGFyeV9jb3VudCArCisJCQkJCXR1LT5sb3dlcl9ib3VuZGFyeV9jb3VudCks
IDEpOworCQkJdHUtPnJlc3VsdGluZ192YWxpZF9mcCA9CiAJCQkJCWRybV9maXhwX2Rpdih0ZW1w
MV9mcCwgdGVtcDJfZnApOwogCiAJCQl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24o
Ci0JCQkJCXR1LnR1X3NpemVfZGVzaXJlZCwgMSk7Ci0JCQl0dS5yYXRpb19ieV90dV9mcCA9Ci0J
CQkJZHJtX2ZpeHBfbXVsKHR1Lm9yaWdpbmFsX3JhdGlvX2ZwLCB0ZW1wMV9mcCk7CisJCQkJCXR1
LT50dV9zaXplX2Rlc2lyZWQsIDEpOworCQkJdHUtPnJhdGlvX2J5X3R1X2ZwID0KKwkJCQlkcm1f
Zml4cF9tdWwodHUtPm9yaWdpbmFsX3JhdGlvX2ZwLCB0ZW1wMV9mcCk7CiAKLQkJCXR1LnZhbGlk
X2xvd2VyX2JvdW5kYXJ5X2xpbmsgPQotCQkJCXR1LnZhbGlkX2JvdW5kYXJ5X2xpbmsgLSAxOwor
CQkJdHUtPnZhbGlkX2xvd2VyX2JvdW5kYXJ5X2xpbmsgPQorCQkJCXR1LT52YWxpZF9ib3VuZGFy
eV9saW5rIC0gMTsKIAotCQkJdGVtcDFfZnAgPSBkcm1fZml4cF9mcm9tX2ZyYWN0aW9uKHR1LmJw
cCwgOCk7Ci0JCQl0ZW1wMV9mcCA9IGRybV9maXhwX211bCh0dS5sd2lkdGhfZnAsIHRlbXAxX2Zw
KTsKKwkJCXRlbXAxX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbih0dS0+YnBwLCA4KTsKKwkJ
CXRlbXAxX2ZwID0gZHJtX2ZpeHBfbXVsKHR1LT5sd2lkdGhfZnAsIHRlbXAxX2ZwKTsKIAkJCXRl
bXAyX2ZwID0gZHJtX2ZpeHBfZGl2KHRlbXAxX2ZwLAotCQkJCQkJdHUucmVzdWx0aW5nX3ZhbGlk
X2ZwKTsKLQkJCXR1Lm5fdHVzID0gZHJtX2ZpeHAyaW50KHRlbXAyX2ZwKTsKKwkJCQkJCXR1LT5y
ZXN1bHRpbmdfdmFsaWRfZnApOworCQkJdHUtPm5fdHVzID0gZHJtX2ZpeHAyaW50KHRlbXAyX2Zw
KTsKIAotCQkJdHUudHVfc2l6ZV9taW51czEgPSB0dS50dV9zaXplX2Rlc2lyZWQgLSAxOwotCQkJ
dHUuZXZlbl9kaXN0cmlidXRpb25fQkYgPSAxOworCQkJdHUtPnR1X3NpemVfbWludXMxID0gdHUt
PnR1X3NpemVfZGVzaXJlZCAtIDE7CisJCQl0dS0+ZXZlbl9kaXN0cmlidXRpb25fQkYgPSAxOwog
CiAJCQl0ZW1wMV9mcCA9Ci0JCQkJZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbih0dS50dV9zaXplX2Rl
c2lyZWQsIDEpOworCQkJCWRybV9maXhwX2Zyb21fZnJhY3Rpb24odHUtPnR1X3NpemVfZGVzaXJl
ZCwgMSk7CiAJCQl0ZW1wMl9mcCA9Ci0JCQkJZHJtX2ZpeHBfZGl2KHR1LnJlc3VsdGluZ192YWxp
ZF9mcCwgdGVtcDFfZnApOwotCQkJdHUuVFVfcmF0aW9fZXJyX2ZwID0gdGVtcDJfZnAgLSB0dS5v
cmlnaW5hbF9yYXRpb19mcDsKKwkJCQlkcm1fZml4cF9kaXYodHUtPnJlc3VsdGluZ192YWxpZF9m
cCwgdGVtcDFfZnApOworCQkJdHUtPlRVX3JhdGlvX2Vycl9mcCA9IHRlbXAyX2ZwIC0gdHUtPm9y
aWdpbmFsX3JhdGlvX2ZwOwogCQl9CiAJfQogCi0JdGVtcDJfZnAgPSBkcm1fZml4cF9tdWwoTENM
S19GQVNUX1NLRVdfZnAsIHR1Lmx3aWR0aF9mcCk7CisJdGVtcDJfZnAgPSBkcm1fZml4cF9tdWwo
TENMS19GQVNUX1NLRVdfZnAsIHR1LT5sd2lkdGhfZnApOwogCiAJaWYgKHRlbXAyX2ZwKQogCQl0
ZW1wID0gZHJtX2ZpeHAyaW50X2NlaWwodGVtcDJfZnApOwogCWVsc2UKIAkJdGVtcCA9IDA7CiAK
LQl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rpb24odHUubmxhbmVzLCAxKTsKLQl0ZW1w
Ml9mcCA9IGRybV9maXhwX211bCh0dS5vcmlnaW5hbF9yYXRpb19mcCwgdGVtcDFfZnApOwotCXRl
bXAxX2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbih0dS5icHAsIDgpOworCXRlbXAxX2ZwID0g
ZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbih0dS0+bmxhbmVzLCAxKTsKKwl0ZW1wMl9mcCA9IGRybV9m
aXhwX211bCh0dS0+b3JpZ2luYWxfcmF0aW9fZnAsIHRlbXAxX2ZwKTsKKwl0ZW1wMV9mcCA9IGRy
bV9maXhwX2Zyb21fZnJhY3Rpb24odHUtPmJwcCwgOCk7CiAJdGVtcDJfZnAgPSBkcm1fZml4cF9k
aXYodGVtcDFfZnAsIHRlbXAyX2ZwKTsKIAl0ZW1wMV9mcCA9IGRybV9maXhwX2Zyb21fZnJhY3Rp
b24odGVtcCwgMSk7CiAJdGVtcDJfZnAgPSBkcm1fZml4cF9tdWwodGVtcDFfZnAsIHRlbXAyX2Zw
KTsKIAl0ZW1wID0gZHJtX2ZpeHAyaW50KHRlbXAyX2ZwKTsKIAotCWlmICh0dS5hc3luY19lbikK
LQkJdHUuZGVsYXlfc3RhcnRfbGluayArPSAoaW50KXRlbXA7CisJaWYgKHR1LT5hc3luY19lbikK
KwkJdHUtPmRlbGF5X3N0YXJ0X2xpbmsgKz0gKGludCl0ZW1wOwogCi0JdGVtcDFfZnAgPSBkcm1f
Zml4cF9mcm9tX2ZyYWN0aW9uKHR1LmRlbGF5X3N0YXJ0X2xpbmssIDEpOwotCXR1LmRlbGF5X3N0
YXJ0X3RpbWVfZnAgPSBkcm1fZml4cF9kaXYodGVtcDFfZnAsIHR1LmxjbGtfZnApOworCXRlbXAx
X2ZwID0gZHJtX2ZpeHBfZnJvbV9mcmFjdGlvbih0dS0+ZGVsYXlfc3RhcnRfbGluaywgMSk7CisJ
dHUtPmRlbGF5X3N0YXJ0X3RpbWVfZnAgPSBkcm1fZml4cF9kaXYodGVtcDFfZnAsIHR1LT5sY2xr
X2ZwKTsKIAogCS8qIE9VVFBVVFMgKi8KLQl0dV90YWJsZS0+dmFsaWRfYm91bmRhcnlfbGluayAg
ICAgICA9IHR1LnZhbGlkX2JvdW5kYXJ5X2xpbms7Ci0JdHVfdGFibGUtPmRlbGF5X3N0YXJ0X2xp
bmsgICAgICAgICAgPSB0dS5kZWxheV9zdGFydF9saW5rOwotCXR1X3RhYmxlLT5ib3VuZGFyeV9t
b2RlcmF0aW9uX2VuICAgID0gdHUuYm91bmRhcnlfbW9kZXJhdGlvbl9lbjsKLQl0dV90YWJsZS0+
dmFsaWRfbG93ZXJfYm91bmRhcnlfbGluayA9IHR1LnZhbGlkX2xvd2VyX2JvdW5kYXJ5X2xpbms7
Ci0JdHVfdGFibGUtPnVwcGVyX2JvdW5kYXJ5X2NvdW50ICAgICAgPSB0dS51cHBlcl9ib3VuZGFy
eV9jb3VudDsKLQl0dV90YWJsZS0+bG93ZXJfYm91bmRhcnlfY291bnQgICAgICA9IHR1Lmxvd2Vy
X2JvdW5kYXJ5X2NvdW50OwotCXR1X3RhYmxlLT50dV9zaXplX21pbnVzMSAgICAgICAgICAgID0g
dHUudHVfc2l6ZV9taW51czE7CisJdHVfdGFibGUtPnZhbGlkX2JvdW5kYXJ5X2xpbmsgICAgICAg
PSB0dS0+dmFsaWRfYm91bmRhcnlfbGluazsKKwl0dV90YWJsZS0+ZGVsYXlfc3RhcnRfbGluayAg
ICAgICAgICA9IHR1LT5kZWxheV9zdGFydF9saW5rOworCXR1X3RhYmxlLT5ib3VuZGFyeV9tb2Rl
cmF0aW9uX2VuICAgID0gdHUtPmJvdW5kYXJ5X21vZGVyYXRpb25fZW47CisJdHVfdGFibGUtPnZh
bGlkX2xvd2VyX2JvdW5kYXJ5X2xpbmsgPSB0dS0+dmFsaWRfbG93ZXJfYm91bmRhcnlfbGluazsK
Kwl0dV90YWJsZS0+dXBwZXJfYm91bmRhcnlfY291bnQgICAgICA9IHR1LT51cHBlcl9ib3VuZGFy
eV9jb3VudDsKKwl0dV90YWJsZS0+bG93ZXJfYm91bmRhcnlfY291bnQgICAgICA9IHR1LT5sb3dl
cl9ib3VuZGFyeV9jb3VudDsKKwl0dV90YWJsZS0+dHVfc2l6ZV9taW51czEgICAgICAgICAgICA9
IHR1LT50dV9zaXplX21pbnVzMTsKIAogCURSTV9ERUJVR19EUCgiVFU6IHZhbGlkX2JvdW5kYXJ5
X2xpbms6ICVkXG4iLAogCQkJCXR1X3RhYmxlLT52YWxpZF9ib3VuZGFyeV9saW5rKTsKQEAgLTkz
NSw2ICs5MzcsOCBAQCBzdGF0aWMgdm9pZCBfZHBfY3RybF9jYWxjX3R1KHN0cnVjdCBkcF90dV9j
YWxjX2lucHV0ICppbiwKIAlEUk1fREVCVUdfRFAoIlRVOiBsb3dlcl9ib3VuZGFyeV9jb3VudDog
JWRcbiIsCiAJCQl0dV90YWJsZS0+bG93ZXJfYm91bmRhcnlfY291bnQpOwogCURSTV9ERUJVR19E
UCgiVFU6IHR1X3NpemVfbWludXMxOiAlZFxuIiwgdHVfdGFibGUtPnR1X3NpemVfbWludXMxKTsK
KworCWtmcmVlKHR1KTsKIH0KIAogc3RhdGljIHZvaWQgZHBfY3RybF9jYWxjX3R1X3BhcmFtZXRl
cnMoc3RydWN0IGRwX2N0cmxfcHJpdmF0ZSAqY3RybCwKLS0gCjIuMjUuMQoKX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZHJpLWRldmVsIG1haWxpbmcgbGlz
dApkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0
b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZHJpLWRldmVsCg==
