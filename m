Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 4C0FEDCE1A
	for <lists+dri-devel@lfdr.de>; Fri, 18 Oct 2019 20:38:06 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1626B6EB8F;
	Fri, 18 Oct 2019 18:37:48 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from smtp.codeaurora.org (smtp.codeaurora.org [198.145.29.96])
 by gabe.freedesktop.org (Postfix) with ESMTPS id CDB856E91D
 for <dri-devel@lists.freedesktop.org>; Wed, 16 Oct 2019 10:14:39 +0000 (UTC)
Received: by smtp.codeaurora.org (Postfix, from userid 1000)
 id 431D460D51; Wed, 16 Oct 2019 10:14:38 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on
 pdx-caf-mail.web.codeaurora.org
X-Spam-Level: 
X-Spam-Status: No, score=-2.7 required=2.0 tests=ALL_TRUSTED,BAYES_00,
 DKIM_INVALID,DKIM_SIGNED,SPF_NONE autolearn=no autolearn_force=no
 version=3.4.0
Received: from kgunda-linux.qualcomm.com
 (blr-c-bdr-fw-01_globalnat_allzones-outside.qualcomm.com [103.229.19.19])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-SHA256 (128/128 bits))
 (No client certificate requested)
 (Authenticated sender: kgunda@smtp.codeaurora.org)
 by smtp.codeaurora.org (Postfix) with ESMTPSA id 138A860D51;
 Wed, 16 Oct 2019 10:14:30 +0000 (UTC)
DMARC-Filter: OpenDMARC Filter v1.3.2 smtp.codeaurora.org 138A860D51
From: Kiran Gunda <kgunda@codeaurora.org>
To: bjorn.andersson@linaro.org, jingoohan1@gmail.com, lee.jones@linaro.org,
 b.zolnierkie@samsung.com, dri-devel@lists.freedesktop.org,
 daniel.thompson@linaro.org, jacek.anaszewski@gmail.com, pavel@ucw.cz,
 robh+dt@kernel.org, mark.rutland@arm.com, linux-leds@vger.kernel.org,
 devicetree@vger.kernel.org, linux-kernel@vger.kernel.org,
 Andy Gross <agross@kernel.org>, linux-arm-msm@vger.kernel.org,
 linux-fbdev@vger.kernel.org
Subject: [PATCH V7 5/6] backlight: qcom-wled: add support for short circuit
 handling.
Date: Wed, 16 Oct 2019 15:43:45 +0530
Message-Id: <1571220826-7740-6-git-send-email-kgunda@codeaurora.org>
X-Mailer: git-send-email 1.9.1
In-Reply-To: <1571220826-7740-1-git-send-email-kgunda@codeaurora.org>
References: <1571220826-7740-1-git-send-email-kgunda@codeaurora.org>
X-Mailman-Approved-At: Fri, 18 Oct 2019 18:37:46 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=codeaurora.org; s=default; t=1571220879;
 bh=5zb85KINuKlrWxu6vDV6/WfkyxaBX09gjB3C9D+9E/E=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=AjFAQBtayIy3Y8FETXWdXRw40nCBm0LDecBGloYcAESwd2Z7iFSWgIFxAYOBWjgmg
 hh/HsUw+jZuSnbOxSjMH1JbxscEC/YNeYBlMv/Qpaobv16/KAuPttXgHY0gYzkib7H
 EQfnjrw7cNcZ2ZWTRwzBwce9A/MEMsDdzNtZPhFE=
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=codeaurora.org; s=default; t=1571220876;
 bh=5zb85KINuKlrWxu6vDV6/WfkyxaBX09gjB3C9D+9E/E=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=lNFLA20NLMhQQELCvmvMQafHjjIaq8NxPetxWGubkdxhYrRMKnZMcakdwZTuM2Mta
 6tXJjBkqT0W3VhV2Sym/8LBI89RXs2Q2MMIoYxtMp/+gtFxdacRgTDUp0lrc8R2n9m
 +yYH22hhBWCkgTfqOm8n7UNGniWjvN29FVS7wBRU=
X-Mailman-Original-Authentication-Results: pdx-caf-mail.web.codeaurora.org;
 dmarc=none (p=none dis=none)
 header.from=codeaurora.org
X-Mailman-Original-Authentication-Results: pdx-caf-mail.web.codeaurora.org;
 spf=none
 smtp.mailfrom=kgunda@codeaurora.org
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Kiran Gunda <kgunda@codeaurora.org>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

SGFuZGxlIHRoZSBzaG9ydCBjaXJjdWl0IGludGVycnVwdCBhbmQgY2hlY2sgaWYgdGhlIHNob3J0
IGNpcmN1aXQKaW50ZXJydXB0IGlzIHZhbGlkLiBSZS1lbmFibGUgdGhlIG1vZHVsZSB0byBjaGVj
ayBpZiBpdCBnb2VzCmF3YXkuIERpc2FibGUgdGhlIG1vZHVsZSBhbHRvZ2V0aGVyIGlmIHRoZSBz
aG9ydCBjaXJjdWl0IGV2ZW50CnBlcnNpc3RzLgoKU2lnbmVkLW9mZi1ieTogS2lyYW4gR3VuZGEg
PGtndW5kYUBjb2RlYXVyb3JhLm9yZz4KUmV2aWV3ZWQtYnk6IEJqb3JuIEFuZGVyc3NvbiA8Ympv
cm4uYW5kZXJzc29uQGxpbmFyby5vcmc+Ci0tLQogZHJpdmVycy92aWRlby9iYWNrbGlnaHQvcWNv
bS13bGVkLmMgfCAxMzIgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tCiAxIGZp
bGUgY2hhbmdlZCwgMTI4IGluc2VydGlvbnMoKyksIDQgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0
IGEvZHJpdmVycy92aWRlby9iYWNrbGlnaHQvcWNvbS13bGVkLmMgYi9kcml2ZXJzL3ZpZGVvL2Jh
Y2tsaWdodC9xY29tLXdsZWQuYwppbmRleCAyODA3YjRiLi5iNWIxMjVjIDEwMDY0NAotLS0gYS9k
cml2ZXJzL3ZpZGVvL2JhY2tsaWdodC9xY29tLXdsZWQuYworKysgYi9kcml2ZXJzL3ZpZGVvL2Jh
Y2tsaWdodC9xY29tLXdsZWQuYwpAQCAtMiw2ICsyLDkgQEAKIC8qIENvcHlyaWdodCAoYykgMjAx
NSwgU29ueSBNb2JpbGUgQ29tbXVuaWNhdGlvbnMsIEFCLgogICovCiAKKyNpbmNsdWRlIDxsaW51
eC9kZWxheS5oPgorI2luY2x1ZGUgPGxpbnV4L2ludGVycnVwdC5oPgorI2luY2x1ZGUgPGxpbnV4
L2t0aW1lLmg+CiAjaW5jbHVkZSA8bGludXgva2VybmVsLmg+CiAjaW5jbHVkZSA8bGludXgvYmFj
a2xpZ2h0Lmg+CiAjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+CkBAIC01Niw2ICs1OSwxNiBAQAog
I2RlZmluZSBXTEVEM19TSU5LX1JFR19TVFJfQ0FCQyhuKQkJCSgweDY2ICsgKG4gKiAweDEwKSkK
ICNkZWZpbmUgIFdMRUQzX1NJTktfUkVHX1NUUl9DQUJDX01BU0sJCQlCSVQoNykKIAorLyogV0xF
RDQgc3BlY2lmaWMgY29udHJvbCByZWdpc3RlcnMgKi8KKyNkZWZpbmUgV0xFRDRfQ1RSTF9SRUdf
U0hPUlRfUFJPVEVDVAkJCTB4NWUKKyNkZWZpbmUgIFdMRUQ0X0NUUkxfUkVHX1NIT1JUX0VOX01B
U0sJCQlCSVQoNykKKworI2RlZmluZSBXTEVENF9DVFJMX1JFR19TRUNfQUNDRVNTCQkJMHhkMAor
I2RlZmluZSAgV0xFRDRfQ1RSTF9SRUdfU0VDX1VOTE9DSwkJCTB4YTUKKworI2RlZmluZSBXTEVE
NF9DVFJMX1JFR19URVNUMQkJCQkweGUyCisjZGVmaW5lICBXTEVENF9DVFJMX1JFR19URVNUMV9F
WFRfRkVUX0RURVNUMgkJMHgwOQorCiAvKiBXTEVENCBzcGVjaWZpYyBzaW5rIHJlZ2lzdGVycyAq
LwogI2RlZmluZSBXTEVENF9TSU5LX1JFR19DVVJSX1NJTksJCQkweDQ2CiAjZGVmaW5lICBXTEVE
NF9TSU5LX1JFR19DVVJSX1NJTktfTUFTSwkJCUdFTk1BU0soNywgNCkKQEAgLTEwNSwxNyArMTE4
LDIzIEBAIHN0cnVjdCB3bGVkX2NvbmZpZyB7CiAJYm9vbCBjc19vdXRfZW47CiAJYm9vbCBleHRf
Z2VuOwogCWJvb2wgY2FiYzsKKwlib29sIGV4dGVybmFsX3BmZXQ7CiB9OwogCiBzdHJ1Y3Qgd2xl
ZCB7CiAJY29uc3QgY2hhciAqbmFtZTsKIAlzdHJ1Y3QgZGV2aWNlICpkZXY7CiAJc3RydWN0IHJl
Z21hcCAqcmVnbWFwOworCXN0cnVjdCBtdXRleCBsb2NrOwkvKiBMb2NrIHRvIGF2b2lkIHJhY2Ug
ZnJvbSB0aHJlYWQgaXJxIGhhbmRsZXIgKi8KKwlrdGltZV90IGxhc3Rfc2hvcnRfZXZlbnQ7CiAJ
dTE2IGN0cmxfYWRkcjsKIAl1MTYgc2lua19hZGRyOwogCXUxNiBtYXhfc3RyaW5nX2NvdW50Owog
CXUzMiBicmlnaHRuZXNzOwogCXUzMiBtYXhfYnJpZ2h0bmVzczsKKwl1MzIgc2hvcnRfY291bnQ7
CisJYm9vbCBkaXNhYmxlZF9ieV9zaG9ydDsKKwlib29sIGhhc19zaG9ydF9kZXRlY3Q7CiAKIAlz
dHJ1Y3Qgd2xlZF9jb25maWcgY2ZnOwogCWludCAoKndsZWRfc2V0X2JyaWdodG5lc3MpKHN0cnVj
dCB3bGVkICp3bGVkLCB1MTYgYnJpZ2h0bmVzcyk7CkBAIC0xNjYsNiArMTg1LDkgQEAgc3RhdGlj
IGludCB3bGVkX21vZHVsZV9lbmFibGUoc3RydWN0IHdsZWQgKndsZWQsIGludCB2YWwpCiB7CiAJ
aW50IHJjOwogCisJaWYgKHdsZWQtPmRpc2FibGVkX2J5X3Nob3J0KQorCQlyZXR1cm4gLUVOWElP
OworCiAJcmMgPSByZWdtYXBfdXBkYXRlX2JpdHMod2xlZC0+cmVnbWFwLCB3bGVkLT5jdHJsX2Fk
ZHIgKwogCQkJCVdMRUQzX0NUUkxfUkVHX01PRF9FTiwKIAkJCQlXTEVEM19DVFJMX1JFR19NT0Rf
RU5fTUFTSywKQEAgLTIwMiwxOCArMjI0LDE5IEBAIHN0YXRpYyBpbnQgd2xlZF91cGRhdGVfc3Rh
dHVzKHN0cnVjdCBiYWNrbGlnaHRfZGV2aWNlICpibCkKIAkgICAgYmwtPnByb3BzLnN0YXRlICYg
QkxfQ09SRV9GQkJMQU5LKQogCQlicmlnaHRuZXNzID0gMDsKIAorCW11dGV4X2xvY2soJndsZWQt
PmxvY2spOwogCWlmIChicmlnaHRuZXNzKSB7CiAJCXJjID0gd2xlZC0+d2xlZF9zZXRfYnJpZ2h0
bmVzcyh3bGVkLCBicmlnaHRuZXNzKTsKIAkJaWYgKHJjIDwgMCkgewogCQkJZGV2X2Vycih3bGVk
LT5kZXYsICJ3bGVkIGZhaWxlZCB0byBzZXQgYnJpZ2h0bmVzcyByYzolZFxuIiwKIAkJCQlyYyk7
Ci0JCQlyZXR1cm4gcmM7CisJCQlnb3RvIHVubG9ja19tdXRleDsKIAkJfQogCiAJCXJjID0gd2xl
ZF9zeW5jX3RvZ2dsZSh3bGVkKTsKIAkJaWYgKHJjIDwgMCkgewogCQkJZGV2X2Vycih3bGVkLT5k
ZXYsICJ3bGVkIHN5bmMgZmFpbGVkIHJjOiVkXG4iLCByYyk7Ci0JCQlyZXR1cm4gcmM7CisJCQln
b3RvIHVubG9ja19tdXRleDsKIAkJfQogCX0KIApAQCAtMjIxLDE1ICsyNDQsNjEgQEAgc3RhdGlj
IGludCB3bGVkX3VwZGF0ZV9zdGF0dXMoc3RydWN0IGJhY2tsaWdodF9kZXZpY2UgKmJsKQogCQly
YyA9IHdsZWRfbW9kdWxlX2VuYWJsZSh3bGVkLCAhIWJyaWdodG5lc3MpOwogCQlpZiAocmMgPCAw
KSB7CiAJCQlkZXZfZXJyKHdsZWQtPmRldiwgIndsZWQgZW5hYmxlIGZhaWxlZCByYzolZFxuIiwg
cmMpOwotCQkJcmV0dXJuIHJjOworCQkJZ290byB1bmxvY2tfbXV0ZXg7CiAJCX0KIAl9CiAKIAl3
bGVkLT5icmlnaHRuZXNzID0gYnJpZ2h0bmVzczsKIAordW5sb2NrX211dGV4OgorCW11dGV4X3Vu
bG9jaygmd2xlZC0+bG9jayk7CisKIAlyZXR1cm4gcmM7CiB9CiAKKyNkZWZpbmUgV0xFRF9TSE9S
VF9ETFlfTVMJCQkyMAorI2RlZmluZSBXTEVEX1NIT1JUX0NOVF9NQVgJCQk1CisjZGVmaW5lIFdM
RURfU0hPUlRfUkVTRVRfQ05UX0RMWV9VUwkJVVNFQ19QRVJfU0VDCisKK3N0YXRpYyBpcnFyZXR1
cm5fdCB3bGVkX3Nob3J0X2lycV9oYW5kbGVyKGludCBpcnEsIHZvaWQgKl93bGVkKQoreworCXN0
cnVjdCB3bGVkICp3bGVkID0gX3dsZWQ7CisJaW50IHJjOworCXM2NCBlbGFwc2VkX3RpbWU7CisK
Kwl3bGVkLT5zaG9ydF9jb3VudCsrOworCW11dGV4X2xvY2soJndsZWQtPmxvY2spOworCXJjID0g
d2xlZF9tb2R1bGVfZW5hYmxlKHdsZWQsIGZhbHNlKTsKKwlpZiAocmMgPCAwKSB7CisJCWRldl9l
cnIod2xlZC0+ZGV2LCAid2xlZCBkaXNhYmxlIGZhaWxlZCByYzolZFxuIiwgcmMpOworCQlnb3Rv
IHVubG9ja19tdXRleDsKKwl9CisKKwllbGFwc2VkX3RpbWUgPSBrdGltZV91c19kZWx0YShrdGlt
ZV9nZXQoKSwKKwkJCQkgICAgICB3bGVkLT5sYXN0X3Nob3J0X2V2ZW50KTsKKwlpZiAoZWxhcHNl
ZF90aW1lID4gV0xFRF9TSE9SVF9SRVNFVF9DTlRfRExZX1VTKQorCQl3bGVkLT5zaG9ydF9jb3Vu
dCA9IDE7CisKKwlpZiAod2xlZC0+c2hvcnRfY291bnQgPiBXTEVEX1NIT1JUX0NOVF9NQVgpIHsK
KwkJZGV2X2Vycih3bGVkLT5kZXYsICJTaG9ydCB0cmlnZ2VkICVkIHRpbWVzLCBkaXNhYmxpbmcg
V0xFRCBmb3JldmVyIVxuIiwKKwkJCXdsZWQtPnNob3J0X2NvdW50KTsKKwkJd2xlZC0+ZGlzYWJs
ZWRfYnlfc2hvcnQgPSB0cnVlOworCQlnb3RvIHVubG9ja19tdXRleDsKKwl9CisKKwl3bGVkLT5s
YXN0X3Nob3J0X2V2ZW50ID0ga3RpbWVfZ2V0KCk7CisKKwltc2xlZXAoV0xFRF9TSE9SVF9ETFlf
TVMpOworCXJjID0gd2xlZF9tb2R1bGVfZW5hYmxlKHdsZWQsIHRydWUpOworCWlmIChyYyA8IDAp
CisJCWRldl9lcnIod2xlZC0+ZGV2LCAid2xlZCBlbmFibGUgZmFpbGVkIHJjOiVkXG4iLCByYyk7
CisKK3VubG9ja19tdXRleDoKKwltdXRleF91bmxvY2soJndsZWQtPmxvY2spOworCisJcmV0dXJu
IElSUV9IQU5ETEVEOworfQorCiBzdGF0aWMgaW50IHdsZWQzX3NldHVwKHN0cnVjdCB3bGVkICp3
bGVkKQogewogCXUxNiBhZGRyOwpAQCAtMzE4LDcgKzM4Nyw3IEBAIHN0YXRpYyBpbnQgd2xlZDRf
c2V0dXAoc3RydWN0IHdsZWQgKndsZWQpCiAJaW50IHJjLCB0ZW1wLCBpLCBqOwogCXUxNiBhZGRy
OwogCXU4IHNpbmtfZW4gPSAwOwotCXUzMiBzaW5rX2NmZyA9IDA7CisJdTMyIHNpbmtfY2ZnOwog
CiAJcmMgPSByZWdtYXBfdXBkYXRlX2JpdHMod2xlZC0+cmVnbWFwLAogCQkJCXdsZWQtPmN0cmxf
YWRkciArIFdMRUQzX0NUUkxfUkVHX09WUCwKQEAgLTM0MCw2ICs0MDksMjEgQEAgc3RhdGljIGlu
dCB3bGVkNF9zZXR1cChzdHJ1Y3Qgd2xlZCAqd2xlZCkKIAlpZiAocmMgPCAwKQogCQlyZXR1cm4g
cmM7CiAKKwlpZiAod2xlZC0+Y2ZnLmV4dGVybmFsX3BmZXQpIHsKKwkJLyogVW5sb2NrIHRoZSBz
ZWN1cmUgcmVnaXN0ZXIgYWNjZXNzICovCisJCXJjID0gcmVnbWFwX3dyaXRlKHdsZWQtPnJlZ21h
cCwgd2xlZC0+Y3RybF9hZGRyICsKKwkJCQkgIFdMRUQ0X0NUUkxfUkVHX1NFQ19BQ0NFU1MsCisJ
CQkJICBXTEVENF9DVFJMX1JFR19TRUNfVU5MT0NLKTsKKwkJaWYgKHJjIDwgMCkKKwkJCXJldHVy
biByYzsKKworCQlyYyA9IHJlZ21hcF93cml0ZSh3bGVkLT5yZWdtYXAsCisJCQkJICB3bGVkLT5j
dHJsX2FkZHIgKyBXTEVENF9DVFJMX1JFR19URVNUMSwKKwkJCQkgIFdMRUQ0X0NUUkxfUkVHX1RF
U1QxX0VYVF9GRVRfRFRFU1QyKTsKKwkJaWYgKHJjIDwgMCkKKwkJCXJldHVybiByYzsKKwl9CisK
IAlyYyA9IHJlZ21hcF9yZWFkKHdsZWQtPnJlZ21hcCwgd2xlZC0+c2lua19hZGRyICsKIAkJCSBX
TEVENF9TSU5LX1JFR19DVVJSX1NJTkssICZzaW5rX2NmZyk7CiAJaWYgKHJjIDwgMCkKQEAgLTQy
NSw2ICs1MDksNyBAQCBzdGF0aWMgaW50IHdsZWQ0X3NldHVwKHN0cnVjdCB3bGVkICp3bGVkKQog
CS5udW1fc3RyaW5ncyA9IDQsCiAJLnN3aXRjaF9mcmVxID0gMTEsCiAJLmNhYmMgPSBmYWxzZSwK
KwkuZXh0ZXJuYWxfcGZldCA9IGZhbHNlLAogfTsKIAogc3RhdGljIGNvbnN0IHUzMiB3bGVkM19i
b29zdF9pX2xpbWl0X3ZhbHVlc1tdID0gewpAQCAtNTkwLDYgKzY3NSw3IEBAIHN0YXRpYyBpbnQg
d2xlZF9jb25maWd1cmUoc3RydWN0IHdsZWQgKndsZWQsIGludCB2ZXJzaW9uKQogCQl7ICJxY29t
LGNzLW91dCIsICZjZmctPmNzX291dF9lbiwgfSwKIAkJeyAicWNvbSxleHQtZ2VuIiwgJmNmZy0+
ZXh0X2dlbiwgfSwKIAkJeyAicWNvbSxjYWJjIiwgJmNmZy0+Y2FiYywgfSwKKwkJeyAicWNvbSxl
eHRlcm5hbC1wZmV0IiwgJmNmZy0+ZXh0ZXJuYWxfcGZldCwgfSwKIAl9OwogCiAJcHJvcF9hZGRy
ID0gb2ZfZ2V0X2FkZHJlc3MoZGV2LT5vZl9ub2RlLCAwLCBOVUxMLCBOVUxMKTsKQEAgLTY3OCw2
ICs3NjQsMzggQEAgc3RhdGljIGludCB3bGVkX2NvbmZpZ3VyZShzdHJ1Y3Qgd2xlZCAqd2xlZCwg
aW50IHZlcnNpb24pCiAJcmV0dXJuIDA7CiB9CiAKK3N0YXRpYyBpbnQgd2xlZF9jb25maWd1cmVf
c2hvcnRfaXJxKHN0cnVjdCB3bGVkICp3bGVkLAorCQkJCSAgICBzdHJ1Y3QgcGxhdGZvcm1fZGV2
aWNlICpwZGV2KQoreworCWludCByYywgc2hvcnRfaXJxOworCisJaWYgKCF3bGVkLT5oYXNfc2hv
cnRfZGV0ZWN0KQorCQlyZXR1cm4gMDsKKworCXJjID0gcmVnbWFwX3VwZGF0ZV9iaXRzKHdsZWQt
PnJlZ21hcCwgd2xlZC0+Y3RybF9hZGRyICsKKwkJCQlXTEVENF9DVFJMX1JFR19TSE9SVF9QUk9U
RUNULAorCQkJCVdMRUQ0X0NUUkxfUkVHX1NIT1JUX0VOX01BU0ssCisJCQkJV0xFRDRfQ1RSTF9S
RUdfU0hPUlRfRU5fTUFTSyk7CisJaWYgKHJjIDwgMCkKKwkJcmV0dXJuIHJjOworCisJc2hvcnRf
aXJxID0gcGxhdGZvcm1fZ2V0X2lycV9ieW5hbWUocGRldiwgInNob3J0Iik7CisJaWYgKHNob3J0
X2lycSA8IDApIHsKKwkJZGV2X2RiZygmcGRldi0+ZGV2LCAic2hvcnQgaXJxIGlzIG5vdCB1c2Vk
XG4iKTsKKwkJcmV0dXJuIDA7CisJfQorCisJcmMgPSBkZXZtX3JlcXVlc3RfdGhyZWFkZWRfaXJx
KHdsZWQtPmRldiwgc2hvcnRfaXJxLAorCQkJCSAgICAgICBOVUxMLCB3bGVkX3Nob3J0X2lycV9o
YW5kbGVyLAorCQkJCSAgICAgICBJUlFGX09ORVNIT1QsCisJCQkJICAgICAgICJ3bGVkX3Nob3J0
X2lycSIsIHdsZWQpOworCWlmIChyYyA8IDApCisJCWRldl9lcnIod2xlZC0+ZGV2LCAiVW5hYmxl
IHRvIHJlcXVlc3Qgc2hvcnRfaXJxIChlcnI6JWQpXG4iLAorCQkJcmMpOworCisJcmV0dXJuIHJj
OworfQorCiBzdGF0aWMgY29uc3Qgc3RydWN0IGJhY2tsaWdodF9vcHMgd2xlZF9vcHMgPSB7CiAJ
LnVwZGF0ZV9zdGF0dXMgPSB3bGVkX3VwZGF0ZV9zdGF0dXMsCiB9OwpAQCAtNzExLDYgKzgyOSw3
IEBAIHN0YXRpYyBpbnQgd2xlZF9wcm9iZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQog
CQlyZXR1cm4gLUVOT0RFVjsKIAl9CiAKKwltdXRleF9pbml0KCZ3bGVkLT5sb2NrKTsKIAlyYyA9
IHdsZWRfY29uZmlndXJlKHdsZWQsIHZlcnNpb24pOwogCWlmIChyYykKIAkJcmV0dXJuIHJjOwpA
QCAtNzI1LDYgKzg0NCw3IEBAIHN0YXRpYyBpbnQgd2xlZF9wcm9iZShzdHJ1Y3QgcGxhdGZvcm1f
ZGV2aWNlICpwZGV2KQogCQlicmVhazsKIAogCWNhc2UgNDoKKwkJd2xlZC0+aGFzX3Nob3J0X2Rl
dGVjdCA9IHRydWU7CiAJCXJjID0gd2xlZDRfc2V0dXAod2xlZCk7CiAJCWlmIChyYykgewogCQkJ
ZGV2X2VycigmcGRldi0+ZGV2LCAid2xlZDRfc2V0dXAgZmFpbGVkXG4iKTsKQEAgLTczNyw2ICs4
NTcsMTAgQEAgc3RhdGljIGludCB3bGVkX3Byb2JlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBk
ZXYpCiAJCWJyZWFrOwogCX0KIAorCXJjID0gd2xlZF9jb25maWd1cmVfc2hvcnRfaXJxKHdsZWQs
IHBkZXYpOworCWlmIChyYyA8IDApCisJCXJldHVybiByYzsKKwogCXZhbCA9IFdMRURfREVGQVVM
VF9CUklHSFRORVNTOwogCW9mX3Byb3BlcnR5X3JlYWRfdTMyKHBkZXYtPmRldi5vZl9ub2RlLCAi
ZGVmYXVsdC1icmlnaHRuZXNzIiwgJnZhbCk7CiAKLS0gClRoZSBRdWFsY29tbSBJbm5vdmF0aW9u
IENlbnRlciwgSW5jLiBpcyBhIG1lbWJlciBvZiB0aGUgQ29kZSBBdXJvcmEgRm9ydW0sCiBhIExp
bnV4IEZvdW5kYXRpb24gQ29sbGFib3JhdGl2ZSBQcm9qZWN0CgpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0CmRyaS1k
ZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcv
bWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
