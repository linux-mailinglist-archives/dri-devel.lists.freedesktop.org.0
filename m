Return-Path: <dri-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+dri-devel@lfdr.de
Delivered-To: lists+dri-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 074C3C3A37
	for <lists+dri-devel@lfdr.de>; Tue,  1 Oct 2019 18:17:55 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8D12F6E851;
	Tue,  1 Oct 2019 16:17:38 +0000 (UTC)
X-Original-To: dri-devel@lists.freedesktop.org
Delivered-To: dri-devel@lists.freedesktop.org
Received: from NAM02-CY1-obe.outbound.protection.outlook.com
 (mail-eopbgr760079.outbound.protection.outlook.com [40.107.76.79])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 262A56E844;
 Tue,  1 Oct 2019 16:17:31 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=Ul8vW1ScFiNIkWEOFw25/bdeNSShHwl8XE072MzXEIbddaieWdGD/icPWg6XlygzbddW/3LPdESxoo2BUn2kuI747gyxDPRoonRqvHEkAz2kwbLgaxjiCUcFFTS7ABltPY7yUpJ+4RO6TKcI+xmh0l6IHMMYOXHQ6dnmM90trbf8SowQg31p0uG+uIVPXOrGcdgmR5Ih4modUR1bgVCimtBE0PBbf9kD107Yj9fKUA657hHIqulOwLQpoLP5FBJwZLori2nzcSi0iOTKHRtRcg1OXXW+WceOHz9AISa1PbawSK1GA7fyETG6tE3hEY8teBD7R27UhWcAnlLRg6hoUQ==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=vaMfOZTD4+FHTnydunpCCEvtjmfnLYURPrXrogyVLhw=;
 b=VLZzS8Y0rQWvAZ3VQUjOeq4THaGB1FhIUIYG1MBZJZXYzRQ4bgpzQmOLzfDMbBfruFsgQ3z4DFlx+BmDBUVdzuYfzHMRqglekkvA6CutpwExTWOboz58s4O2m5a2L0qMa1SIh3xYmrIkddnAYlje9CldRdOo9KNMigBiKYA6KyackkSMUdWAUamqErmdhc55QN0PtA6fH6CKFzGXAKhguJfYVXKlHuMbgo7+Az6sq93RzyBNrymuqsX9zoGPuL01PBrjhwkbSAqwFoU8801zpH/CQ5BvZ/Jp2TY+OBn6ljIe7cHFN4iUZr36S40RaRg5Lbj7/j4ZMX+1X4AoIDfTEA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=none (sender ip is
 165.204.84.17) smtp.rcpttodomain=redhat.com smtp.mailfrom=amd.com;
 dmarc=permerror action=none header.from=amd.com; dkim=none (message not
 signed); arc=none
Received: from MN2PR12CA0007.namprd12.prod.outlook.com (2603:10b6:208:a8::20)
 by SN6PR12MB2622.namprd12.prod.outlook.com (2603:10b6:805:6f::11)
 with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2305.17; Tue, 1 Oct
 2019 16:17:29 +0000
Received: from CO1NAM03FT013.eop-NAM03.prod.protection.outlook.com
 (2a01:111:f400:7e48::207) by MN2PR12CA0007.outlook.office365.com
 (2603:10b6:208:a8::20) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2284.19 via Frontend
 Transport; Tue, 1 Oct 2019 16:17:29 +0000
Received-SPF: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
Received: from SATLEXCHOV02.amd.com (165.204.84.17) by
 CO1NAM03FT013.mail.protection.outlook.com (10.152.80.120) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id
 15.20.2305.15 via Frontend Transport; Tue, 1 Oct 2019 16:17:28 +0000
Received: from mlipski-pc.amd.com (10.180.168.240) by SATLEXCHOV02.amd.com
 (10.181.40.72) with Microsoft SMTP Server id 14.3.389.1; Tue, 1 Oct 2019
 11:17:26 -0500
From: <mikita.lipski@amd.com>
To: <amd-gfx@lists.freedesktop.org>
Subject: [PATCH 01/14] drm/amd/display: Add MST atomic routines
Date: Tue, 1 Oct 2019 12:17:08 -0400
Message-ID: <20191001161721.13793-2-mikita.lipski@amd.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20191001161721.13793-1-mikita.lipski@amd.com>
References: <20191001161721.13793-1-mikita.lipski@amd.com>
MIME-Version: 1.0
X-EOPAttributedMessage: 0
X-MS-Office365-Filtering-HT: Tenant
X-Forefront-Antispam-Report: CIP:165.204.84.17; IPV:NLI; CTRY:US; EFV:NLI;
 SFV:NSPM;
 SFS:(10009020)(4636009)(376002)(136003)(39860400002)(346002)(396003)(428003)(199004)(189003)(53416004)(2351001)(5660300002)(48376002)(4326008)(316002)(8936002)(50466002)(16586007)(478600001)(81166006)(81156014)(54906003)(50226002)(2876002)(476003)(11346002)(356004)(446003)(2906002)(126002)(486006)(2616005)(426003)(186003)(6666004)(76176011)(51416003)(336012)(70586007)(6916009)(47776003)(14444005)(305945005)(36756003)(70206006)(86362001)(26005)(1076003)(8676002)(7696005)(16060500001);
 DIR:OUT; SFP:1101; SCL:1; SRVR:SN6PR12MB2622; H:SATLEXCHOV02.amd.com; FPR:;
 SPF:None; LANG:en; PTR:InfoDomainNonexistent; A:1; MX:1; 
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: e99bcc69-1c2a-4b0e-efa3-08d7468adb09
X-MS-TrafficTypeDiagnostic: SN6PR12MB2622:
X-Microsoft-Antispam-PRVS: <SN6PR12MB2622168962151CD69660D85DE49D0@SN6PR12MB2622.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:1227;
X-Forefront-PRVS: 0177904E6B
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: Ze8njQEGyZKKS9DgfDPHjbQJihvbzudOfim44LkXHj/pu2Fc+bHZ/vf3BGRrl/3JN0Wy8v+XhN4dW0i+1+a/ttdvMeGPtct8+hQ0QE8atiVxQ676uFRtspcVAXqA9XhW4O8oDo9iSZi+vfeHLFdYVE+smfXcCfFcMdQGEoZg+z352v+OJUBv5kTNDCDul/2FgtDTqtWx98LRuEWwIHveds5Se9CLSbpbcBq7QeXgp4LyTqc9GRiIWwXByOmVhzwf5D9rjpkLTx4X9NIXGnOQ1vz94Wjgi5QFEjsN/jV+wDr2i+mFDnwGlbQP3+QYYaxd1Wza6vU1WIHhm43qJdqFNBfLQVvfgf2ZVh1oPUV8L8s2r9O/K4cQXSu6k7J0ZsYqxW5MNml0ISSZvymCme8dYumw4rphD8x1ThIe4Hd1Q6I=
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 01 Oct 2019 16:17:28.8545 (UTC)
X-MS-Exchange-CrossTenant-Network-Message-Id: e99bcc69-1c2a-4b0e-efa3-08d7468adb09
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-OriginalAttributedTenantConnectingIp: TenantId=3dd8961f-e488-4e60-8e11-a82d994e183d; Ip=[165.204.84.17];
 Helo=[SATLEXCHOV02.amd.com]
X-MS-Exchange-CrossTenant-FromEntityHeader: HybridOnPrem
X-MS-Exchange-Transport-CrossTenantHeadersStamped: SN6PR12MB2622
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=vaMfOZTD4+FHTnydunpCCEvtjmfnLYURPrXrogyVLhw=;
 b=uP90w8LqgEcacHo9r1pNPNQp5YlgQr3lbtR/PC3woQXnczLikty0J7X0SB7a7DAE9hga/vwWBQrPamcMAbGaZMCI9CToX4vj2clXvCejSnlgfEIG+XDwkWUCetyiR3LU5QGgpBno7Gusw6fhsdubRtzh19qU/J6/ak0GnvaJ+E0=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is
 165.204.84.17)
 smtp.mailfrom=amd.com; redhat.com; dkim=none (message not signed)
 header.d=none;redhat.com; dmarc=permerror action=none header.from=amd.com;
X-BeenThere: dri-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Direct Rendering Infrastructure - Development
 <dri-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/dri-devel>
List-Post: <mailto:dri-devel@lists.freedesktop.org>
List-Help: <mailto:dri-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/dri-devel>,
 <mailto:dri-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: dri-devel@lists.freedesktop.org, Jerry Zuo <Jerry.Zuo@amd.com>,
 Mikita Lipski <mikita.lipski@amd.com>,
 Nicholas Kazlauskas <nicholas.kazlauskas@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: dri-devel-bounces@lists.freedesktop.org
Sender: "dri-devel" <dri-devel-bounces@lists.freedesktop.org>

RnJvbTogTWlraXRhIExpcHNraSA8bWlraXRhLmxpcHNraUBhbWQuY29tPgoKLSBBZGRpbmcgZW5j
b2RlciBhdG9taWMgY2hlY2sgdG8gZmluZCB2Y3BpIHNsb3RzIGZvciBhIGNvbm5lY3RvcgotIFVz
aW5nIERSTSBoZWxwZXIgZnVuY3Rpb25zIHRvIGNhbGN1bGF0ZSBQQk4KLSBBZGRpbmcgY29ubmVj
dG9yIGF0b21pYyBjaGVjayB0byByZWxlYXNlIHZjcGkgc2xvdHMgaWYgY29ubmVjdG9yCmxvc2Vz
IENSVEMKLSBDYWxjdWxhdGUgIFBCTiBhbmQgVkNQSSBzbG90cyBvbmx5IG9uY2UgZHVyaW5nIGF0
b21pYwpjaGVjayBhbmQgc3RvcmUgdGhlbSBvbiBhbWRncHUgY29ubmVjdG9yIHRvIGVsaW1pbmF0
ZQpyZWR1bmRhbnQgY2FsY3VsYXRpb24KLSBDYWxsIGRybV9kcF9tc3RfYXRvbWljX2NoZWNrIHRv
IHZlcmlmeSB2YWxpZGl0eSBvZiBNU1QgdG9wb2xvZ3kKZHVyaW5nIHN0YXRlIGF0b21pYyBjaGVj
awoKdjI6IHNxdWFzaGVkIHByZXZpb3VzIDMgc2VwYXJhdGUgcGF0Y2hlcywgcmVtb3ZlZCBEU0Mg
UEJOIGNhbGN1bGF0aW9uLAphbmQgYWRkZWQgUEJOIGFuZCBWQ1BJIHNsb3RzIHByb3BlcnRpZXMg
dG8gYW1kZ3B1IGNvbm5lY3RvcgoKQ2M6IEplcnJ5IFp1byA8SmVycnkuWnVvQGFtZC5jb20+CkNj
OiBIYXJyeSBXZW50bGFuZCA8aGFycnkud2VudGxhbmRAYW1kLmNvbT4KQ2M6IE5pY2hvbGFzIEth
emxhdXNrYXMgPG5pY2hvbGFzLmthemxhdXNrYXNAYW1kLmNvbT4KQ2M6IEx5dWRlIFBhdWwgPGx5
dWRlQHJlZGhhdC5jb20+ClNpZ25lZC1vZmYtYnk6IE1pa2l0YSBMaXBza2kgPG1pa2l0YS5saXBz
a2lAYW1kLmNvbT4KLS0tCiAuLi4vZ3B1L2RybS9hbWQvZGlzcGxheS9hbWRncHVfZG0vYW1kZ3B1
X2RtLmMgfCA0MiArKysrKysrKysrKysrKysrKysrCiAuLi4vZ3B1L2RybS9hbWQvZGlzcGxheS9h
bWRncHVfZG0vYW1kZ3B1X2RtLmggfCAgNCArKwogLi4uL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9h
bWRncHVfZG1faGVscGVycy5jIHwgNDIgKystLS0tLS0tLS0tLS0tLS0tLQogLi4uL2Rpc3BsYXkv
YW1kZ3B1X2RtL2FtZGdwdV9kbV9tc3RfdHlwZXMuYyAgIHwgMzIgKysrKysrKysrKysrKysKIDQg
ZmlsZXMgY2hhbmdlZCwgODEgaW5zZXJ0aW9ucygrKSwgMzkgZGVsZXRpb25zKC0pCgpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG0uYyBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtLmMKaW5kZXgg
MjM5YjFhZTg2MDA3Li4zZmMxYWZjY2JiMzMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvZGlzcGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG0uYwpAQCAtNDU3Myw2ICs0NTczLDQxIEBAIHN0
YXRpYyBpbnQgZG1fZW5jb2Rlcl9oZWxwZXJfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fZW5jb2Rl
ciAqZW5jb2RlciwKIAkJCQkJICBzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJ
CQkJCSAgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCiB7CisJc3RydWN0
IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gY3J0Y19zdGF0ZS0+c3RhdGU7CisJc3RydWN0IGRy
bV9jb25uZWN0b3IgKmNvbm5lY3RvciA9IGNvbm5fc3RhdGUtPmNvbm5lY3RvcjsKKwlzdHJ1Y3Qg
YW1kZ3B1X2RtX2Nvbm5lY3RvciAqYWNvbm5lY3RvciA9IHRvX2FtZGdwdV9kbV9jb25uZWN0b3Io
Y29ubmVjdG9yKTsKKwlzdHJ1Y3QgZG1fY3J0Y19zdGF0ZSAqZG1fbmV3X2NydGNfc3RhdGUgPSB0
b19kbV9jcnRjX3N0YXRlKGNydGNfc3RhdGUpOworCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9t
b2RlICphZGp1c3RlZF9tb2RlID0gJmNydGNfc3RhdGUtPmFkanVzdGVkX21vZGU7CisJc3RydWN0
IGRybV9kcF9tc3RfdG9wb2xvZ3lfbWdyICptc3RfbWdyOworCXN0cnVjdCBkcm1fZHBfbXN0X3Bv
cnQgKm1zdF9wb3J0OworCWludCBjbG9jaywgYnBwID0gMDsKKworCWlmICghZG1fbmV3X2NydGNf
c3RhdGUpCisJCXJldHVybiAwOworCisJaWYgKCFhY29ubmVjdG9yLT5wb3J0IHx8ICFhY29ubmVj
dG9yLT5kY19zaW5rKQorCQlyZXR1cm4gMDsKKworCW1zdF9wb3J0ID0gYWNvbm5lY3Rvci0+cG9y
dDsKKwltc3RfbWdyID0gJmFjb25uZWN0b3ItPm1zdF9wb3J0LT5tc3RfbWdyOworCisJaWYgKCFj
cnRjX3N0YXRlLT5jb25uZWN0b3JzX2NoYW5nZWQgJiYgIWNydGNfc3RhdGUtPm1vZGVfY2hhbmdl
ZCkKKwkJcmV0dXJuIDA7CisKKwlpZighc3RhdGUtPmR1cGxpY2F0ZWQpIHsKKwkJYnBwID0gKHVp
bnQ4X3QpY29ubmVjdG9yLT5kaXNwbGF5X2luZm8uYnBjICogMzsKKwkJY2xvY2sgPSBhZGp1c3Rl
ZF9tb2RlLT5jbG9jazsKKwkJYWNvbm5lY3Rvci0+cGJuID0gZHJtX2RwX2NhbGNfcGJuX21vZGUo
Y2xvY2ssIGJwcCk7CisJfQorCWFjb25uZWN0b3ItPnZjcGlfc2xvdHMgPSBkcm1fZHBfYXRvbWlj
X2ZpbmRfdmNwaV9zbG90cyhzdGF0ZSwKKwkJCQkJCQkgICAgICAgbXN0X21nciwKKwkJCQkJCQkg
ICAgICAgbXN0X3BvcnQsCisJCQkJCQkJICAgICAgIGFjb25uZWN0b3ItPnBibik7CisKKwlpZiAo
YWNvbm5lY3Rvci0+dmNwaV9zbG90cyA8IDApIHsKKwkJRFJNX0RFQlVHX0FUT01JQygiZmFpbGVk
IGZpbmRpbmcgdmNwaSBzbG90czogJWRcbiIsIGFjb25uZWN0b3ItPnZjcGlfc2xvdHMpOworCQly
ZXR1cm4gYWNvbm5lY3Rvci0+dmNwaV9zbG90czsKKwl9CiAJcmV0dXJuIDA7CiB9CiAKQEAgLTUx
OTcsNiArNTIzMiw4IEBAIHZvaWQgYW1kZ3B1X2RtX2Nvbm5lY3Rvcl9pbml0X2hlbHBlcihzdHJ1
Y3QgYW1kZ3B1X2Rpc3BsYXlfbWFuYWdlciAqZG0sCiAJYWNvbm5lY3Rvci0+YmFzZS5kcG1zID0g
RFJNX01PREVfRFBNU19PRkY7CiAJYWNvbm5lY3Rvci0+aHBkLmhwZCA9IEFNREdQVV9IUERfTk9O
RTsgLyogbm90IHVzZWQgKi8KIAlhY29ubmVjdG9yLT5hdWRpb19pbnN0ID0gLTE7CisJYWNvbm5l
Y3Rvci0+dmNwaV9zbG90cyA9IDA7CisJYWNvbm5lY3Rvci0+cGJuID0gMDsKIAltdXRleF9pbml0
KCZhY29ubmVjdG9yLT5ocGRfbG9jayk7CiAKIAkvKgpAQCAtNzU5Miw2ICs3NjI5LDExIEBAIHN0
YXRpYyBpbnQgYW1kZ3B1X2RtX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAog
CWlmIChyZXQpCiAJCWdvdG8gZmFpbDsKIAorCS8qIFBlcmZvcm0gdmFsaWRhdGlvbiBvZiBNU1Qg
dG9wb2xvZ3kgaW4gdGhlIHN0YXRlKi8KKwlyZXQgPSBkcm1fZHBfbXN0X2F0b21pY19jaGVjayhz
dGF0ZSk7CisJaWYgKHJldCkKKwkJZ290byBmYWlsOworCiAJaWYgKHN0YXRlLT5sZWdhY3lfY3Vy
c29yX3VwZGF0ZSkgewogCQkvKgogCQkgKiBUaGlzIGlzIGEgZmFzdCBjdXJzb3IgdXBkYXRlIGNv
bWluZyBmcm9tIHRoZSBwbGFuZSB1cGRhdGUKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvZGlzcGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rp
c3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbS5oCmluZGV4IGM2ZmRlYmVlNzE4OS4uM2NlMTA0MzI0
MDk2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2Ft
ZGdwdV9kbS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9hbWRncHVfZG0vYW1k
Z3B1X2RtLmgKQEAgLTI4MCw2ICsyODAsMTAgQEAgc3RydWN0IGFtZGdwdV9kbV9jb25uZWN0b3Ig
ewogCXN0cnVjdCBhbWRncHVfZG1fY29ubmVjdG9yICptc3RfcG9ydDsKIAlzdHJ1Y3QgYW1kZ3B1
X2VuY29kZXIgKm1zdF9lbmNvZGVyOwogCisJLyogTVNUIHNwZWNpZmljICovCisJdWludDMyX3Qg
dmNwaV9zbG90czsKKwl1aW50MzJfdCBwYm47CisKIAkvKiBUT0RPIHNlZSBpZiB3ZSBjYW4gbWVy
Z2Ugd2l0aCBkZGNfYnVzIG9yIG1ha2UgYSBkbV9jb25uZWN0b3IgKi8KIAlzdHJ1Y3QgYW1kZ3B1
X2kyY19hZGFwdGVyICppMmM7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlz
cGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtX2hlbHBlcnMuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
ZGlzcGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtX2hlbHBlcnMuYwppbmRleCAxMWU1Nzg0YWE2MmEu
LjUyNTZhYmUzMmU5MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2Ft
ZGdwdV9kbS9hbWRncHVfZG1faGVscGVycy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlz
cGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtX2hlbHBlcnMuYwpAQCAtMTg0LDExICsxODQsNyBAQCBi
b29sIGRtX2hlbHBlcnNfZHBfbXN0X3dyaXRlX3BheWxvYWRfYWxsb2NhdGlvbl90YWJsZSgKIAlz
dHJ1Y3QgYW1kZ3B1X2RtX2Nvbm5lY3RvciAqYWNvbm5lY3RvcjsKIAlzdHJ1Y3QgZHJtX2RwX21z
dF90b3BvbG9neV9tZ3IgKm1zdF9tZ3I7CiAJc3RydWN0IGRybV9kcF9tc3RfcG9ydCAqbXN0X3Bv
cnQ7Ci0JaW50IHNsb3RzID0gMDsKIAlib29sIHJldDsKLQlpbnQgY2xvY2s7Ci0JaW50IGJwcCA9
IDA7Ci0JaW50IHBibiA9IDA7CiAKIAlhY29ubmVjdG9yID0gKHN0cnVjdCBhbWRncHVfZG1fY29u
bmVjdG9yICopc3RyZWFtLT5kbV9zdHJlYW1fY29udGV4dDsKIApAQCAtMjAzLDQyICsxOTksMTAg
QEAgYm9vbCBkbV9oZWxwZXJzX2RwX21zdF93cml0ZV9wYXlsb2FkX2FsbG9jYXRpb25fdGFibGUo
CiAJbXN0X3BvcnQgPSBhY29ubmVjdG9yLT5wb3J0OwogCiAJaWYgKGVuYWJsZSkgewotCQljbG9j
ayA9IHN0cmVhbS0+dGltaW5nLnBpeF9jbGtfMTAwaHogLyAxMDsKLQotCQlzd2l0Y2ggKHN0cmVh
bS0+dGltaW5nLmRpc3BsYXlfY29sb3JfZGVwdGgpIHsKLQotCQljYXNlIENPTE9SX0RFUFRIXzY2
NjoKLQkJCWJwcCA9IDY7Ci0JCQlicmVhazsKLQkJY2FzZSBDT0xPUl9ERVBUSF84ODg6Ci0JCQli
cHAgPSA4OwotCQkJYnJlYWs7Ci0JCWNhc2UgQ09MT1JfREVQVEhfMTAxMDEwOgotCQkJYnBwID0g
MTA7Ci0JCQlicmVhazsKLQkJY2FzZSBDT0xPUl9ERVBUSF8xMjEyMTI6Ci0JCQlicHAgPSAxMjsK
LQkJCWJyZWFrOwotCQljYXNlIENPTE9SX0RFUFRIXzE0MTQxNDoKLQkJCWJwcCA9IDE0OwotCQkJ
YnJlYWs7Ci0JCWNhc2UgQ09MT1JfREVQVEhfMTYxNjE2OgotCQkJYnBwID0gMTY7Ci0JCQlicmVh
azsKLQkJZGVmYXVsdDoKLQkJCUFTU0VSVChicHAgIT0gMCk7Ci0JCQlicmVhazsKLQkJfQotCi0J
CWJwcCA9IGJwcCAqIDM7Ci0KLQkJLyogVE9ETyBuZWVkIHRvIGtub3cgbGluayByYXRlICovCi0K
LQkJcGJuID0gZHJtX2RwX2NhbGNfcGJuX21vZGUoY2xvY2ssIGJwcCk7Ci0KLQkJc2xvdHMgPSBk
cm1fZHBfZmluZF92Y3BpX3Nsb3RzKG1zdF9tZ3IsIHBibik7Ci0JCXJldCA9IGRybV9kcF9tc3Rf
YWxsb2NhdGVfdmNwaShtc3RfbWdyLCBtc3RfcG9ydCwgcGJuLCBzbG90cyk7CiAKKwkJcmV0ID0g
ZHJtX2RwX21zdF9hbGxvY2F0ZV92Y3BpKG1zdF9tZ3IsIG1zdF9wb3J0LAorCQkJCQkgICAgICAg
YWNvbm5lY3Rvci0+cGJuLAorCQkJCQkgICAgICAgYWNvbm5lY3Rvci0+dmNwaV9zbG90cyk7CiAJ
CWlmICghcmV0KQogCQkJcmV0dXJuIGZhbHNlOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbV9tc3RfdHlwZXMuYyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvZGlzcGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtX21zdF90eXBlcy5jCmluZGV4
IDNhZjJiNDI5ZmYxYi4uN2YzY2UyOWJkMTRjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
YW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbV9tc3RfdHlwZXMuYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbV9tc3RfdHlwZXMuYwpAQCAt
MjUwLDEwICsyNTAsNDIgQEAgZG1fbXN0X2F0b21pY19iZXN0X2VuY29kZXIoc3RydWN0IGRybV9j
b25uZWN0b3IgKmNvbm5lY3RvciwKIAlyZXR1cm4gJnRvX2FtZGdwdV9kbV9jb25uZWN0b3IoY29u
bmVjdG9yKS0+bXN0X2VuY29kZXItPmJhc2U7CiB9CiAKK3N0YXRpYyBpbnQgZG1fZHBfbXN0X2F0
b21pY19jaGVjayhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAorCQkJCXN0cnVjdCBk
cm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKK3sKKwlzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAq
bmV3X2Nvbm5fc3RhdGUgPQorCQkJZHJtX2F0b21pY19nZXRfbmV3X2Nvbm5lY3Rvcl9zdGF0ZShz
dGF0ZSwgY29ubmVjdG9yKTsKKwlzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5f
c3RhdGUgPQorCQkJZHJtX2F0b21pY19nZXRfb2xkX2Nvbm5lY3Rvcl9zdGF0ZShzdGF0ZSwgY29u
bmVjdG9yKTsKKwlzdHJ1Y3QgYW1kZ3B1X2RtX2Nvbm5lY3RvciAqYWNvbm5lY3RvciA9IHRvX2Ft
ZGdwdV9kbV9jb25uZWN0b3IoY29ubmVjdG9yKTsKKwlzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKm5l
d19jcnRjX3N0YXRlOworCXN0cnVjdCBkcm1fZHBfbXN0X3RvcG9sb2d5X21nciAqbXN0X21ncjsK
KwlzdHJ1Y3QgZHJtX2RwX21zdF9wb3J0ICptc3RfcG9ydDsKKworCW1zdF9wb3J0ID0gYWNvbm5l
Y3Rvci0+cG9ydDsKKwltc3RfbWdyID0gJmFjb25uZWN0b3ItPm1zdF9wb3J0LT5tc3RfbWdyOwor
CisJaWYgKCFvbGRfY29ubl9zdGF0ZS0+Y3J0YykKKwkJcmV0dXJuIDA7CisKKwlpZiAobmV3X2Nv
bm5fc3RhdGUtPmNydGMpIHsKKwkJbmV3X2NydGNfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9vbGRf
Y3J0Y19zdGF0ZShzdGF0ZSwgbmV3X2Nvbm5fc3RhdGUtPmNydGMpOworCQlpZiAoIW5ld19jcnRj
X3N0YXRlIHx8CisJCSAgICAhZHJtX2F0b21pY19jcnRjX25lZWRzX21vZGVzZXQobmV3X2NydGNf
c3RhdGUpIHx8CisJCSAgICBuZXdfY3J0Y19zdGF0ZS0+ZW5hYmxlKQorCQkJcmV0dXJuIDA7CisJ
CX0KKworCXJldHVybiBkcm1fZHBfYXRvbWljX3JlbGVhc2VfdmNwaV9zbG90cyhzdGF0ZSwKKwkJ
CQkJCW1zdF9tZ3IsCisJCQkJCQltc3RfcG9ydCk7Cit9CisKIHN0YXRpYyBjb25zdCBzdHJ1Y3Qg
ZHJtX2Nvbm5lY3Rvcl9oZWxwZXJfZnVuY3MgZG1fZHBfbXN0X2Nvbm5lY3Rvcl9oZWxwZXJfZnVu
Y3MgPSB7CiAJLmdldF9tb2RlcyA9IGRtX2RwX21zdF9nZXRfbW9kZXMsCiAJLm1vZGVfdmFsaWQg
PSBhbWRncHVfZG1fY29ubmVjdG9yX21vZGVfdmFsaWQsCiAJLmF0b21pY19iZXN0X2VuY29kZXIg
PSBkbV9tc3RfYXRvbWljX2Jlc3RfZW5jb2RlciwKKwkuYXRvbWljX2NoZWNrID0gZG1fZHBfbXN0
X2F0b21pY19jaGVjaywKIH07CiAKIHN0YXRpYyB2b2lkIGFtZGdwdV9kbV9lbmNvZGVyX2Rlc3Ry
b3koc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyKQotLSAKMi4xNy4xCgpfX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpkcmktZGV2ZWwgbWFpbGluZyBsaXN0
CmRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3Rv
cC5vcmcvbWFpbG1hbi9saXN0aW5mby9kcmktZGV2ZWw=
